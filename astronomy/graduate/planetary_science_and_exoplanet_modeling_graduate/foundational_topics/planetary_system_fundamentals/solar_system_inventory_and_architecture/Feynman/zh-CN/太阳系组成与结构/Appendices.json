{
    "hands_on_practices": [
        {
            "introduction": "行星的形成始于微小星子的碰撞和并合。这个练习将带你从基本物理原理出发，推导引力聚焦效应，这是理解行星吸积速率的关键概念。通过运用能量和角动量守恒，你将量化一个天体的引力如何有效地增大了其碰撞截面。",
            "id": "4178316",
            "problem": "一个质量为 $M$、半径为 $R$ 的球形目标体位于一个近圆形的日心轨道上。一群小射弹从日心自由空间以相对于目标体为 $v_{\\infty}$ 的均匀渐近速度和各向同性的入射方向接近该目标体。将每次相遇视为射弹与目标体之间的两体、非相对论、点质量相互作用，忽略中心恒星、大气阻力、行星扁率以及任何耗散力的影响。使用牛顿引力、能量守恒和角动量守恒，推导入射弹将与目标体碰撞（即到达近心点 $r_{\\text{p}} \\leq R$）的最大碰撞参数 $b_{\\max}$。由此，证明碰撞截面可以写成 $\\sigma = \\pi R^{2}(1 + \\Theta)$ 的形式，并求出引力聚焦因子 $\\Theta$ 关于 $G$、$M$、$R$ 和 $v_{\\infty}$ 的显式解析表达式。然后，通过使用对 $v_{\\infty}$ 的主导阶依赖关系来量化小偏转状态，论证这种聚焦增强效应对高速撞击的有效域和局限性。最终答案必须是 $\\Theta$ 的单个闭式解析表达式，无需进行数值计算。",
            "solution": "该问题陈述被评估为具有科学依据、适定且客观。它描述了一个标准的两体引力散射问题，这是天体力学的基石之一。所有必要的参数和简化假设都已明确给出，从而可以得出一个唯一且有意义的解。因此，该问题被认为是有效的。\n\n求解过程是通过将能量守恒和角动量守恒原理应用于由目标体（质量为 $M$）和射弹（质量为 $m$）组成的两体系统。我们已知射弹从很远的距离以相对速度 $v_{\\infty}$ 和碰撞参数 $b$ 接近目标体。引力相互作用遵循牛顿万有引力定律。\n\n首先，我们应用能量守恒原理。射弹的总能量 $E$ 在其整个轨道上是恒定的。在距目标体无限远处（$r \\to \\infty$），引力势能为零，因此总能量完全是动能：\n$$E = \\frac{1}{2} m v_{\\infty}^2$$\n在轨道上的任何其他点，当射弹距离目标体中心为 $r$ 且速度为 $v$ 时，总能量是其动能和势能之和：\n$$E = \\frac{1}{2} m v^2 - \\frac{GMm}{r}$$\n令这两个守恒总能量的表达式相等，我们得到：\n$$\\frac{1}{2} m v_{\\infty}^2 = \\frac{1}{2} m v^2 - \\frac{GMm}{r}$$\n两边同除以射弹的质量 $m$，我们得到比能方程：\n$$\\frac{1}{2} v_{\\infty}^2 = \\frac{1}{2} v^2 - \\frac{GM}{r}$$\n\n接下来，我们应用角动量守恒原理。射弹相对于目标体的比角动量 $L$ 也是恒定的。在无限远处，角动量由碰撞参数 $b$ 和接近速度 $v_{\\infty}$ 定义：\n$$L = b v_{\\infty}$$\n最近接近点是近心点，距离为 $r_{\\text{p}}$。在该点，射弹的速度矢量 $\\vec{v}_{\\text{p}}$ 与其位置矢量 $\\vec{r}_{\\text{p}}$ 垂直。因此，在近心点的比角动量为：\n$$L = r_{\\text{p}} v_{\\text{p}}$$\n令这两个守恒比角动量的表达式相等，我们得到：\n$$b v_{\\infty} = r_{\\text{p}} v_{\\text{p}}$$\n\n现在我们可以找到碰撞参数 $b$ 和近心点距离 $r_{\\text{p}}$ 之间的关系。根据角动量守恒方程，我们将近心点速度表示为 $v_{\\text{p}} = \\frac{b v_{\\infty}}{r_{\\text{p}}}$。我们将此表达式代入在近心点（$r=r_{\\text{p}}$, $v=v_{\\text{p}}$）处求值的能量守恒方程中：\n$$\\frac{1}{2} v_{\\infty}^2 = \\frac{1}{2} v_{\\text{p}}^2 - \\frac{GM}{r_{\\text{p}}}$$\n$$\\frac{1}{2} v_{\\infty}^2 = \\frac{1}{2} \\left(\\frac{b v_{\\infty}}{r_{\\text{p}}}\\right)^2 - \\frac{GM}{r_{\\text{p}}}$$\n为了求解碰撞参数 $b$，我们将方程两边乘以 $2$ 并重新整理：\n$$v_{\\infty}^2 = \\frac{b^2 v_{\\infty}^2}{r_{\\text{p}}^2} - \\frac{2GM}{r_{\\text{p}}}$$\n$$v_{\\infty}^2 + \\frac{2GM}{r_{\\text{p}}} = \\frac{b^2 v_{\\infty}^2}{r_{\\text{p}}^2}$$\n两边乘以 $\\frac{r_{\\text{p}}^2}{v_{\\infty}^2}$ 以分离出 $b^2$：\n$$b^2 = r_{\\text{p}}^2 \\left(1 + \\frac{2GM}{r_{\\text{p}} v_{\\infty}^2}\\right)$$\n该方程将碰撞参数 $b$ 与最终的最近接近距离 $r_{\\text{p}}$ 联系起来。\n\n如果射弹的轨道与目标体相交，即近心点距离小于或等于目标体半径 $r_{\\text{p}} \\le R$，则会发生碰撞。发生碰撞的最大碰撞参数 $b_{\\max}$ 对应于掠射轨道，即射弹恰好接触目标体表面，此时 $r_{\\text{p}} = R$。在 $b^2$ 的方程中设 $r_{\\text{p}} = R$：\n$$b_{\\max}^2 = R^2 \\left(1 + \\frac{2GM}{R v_{\\infty}^2}\\right)$$\n\n碰撞截面 $\\sigma$ 是呈现给入射的均匀射弹流的有效面积。所有碰撞参数 $b \\le b_{\\max}$ 的射弹都将与目标体碰撞。这对应于一个半径为 $b_{\\max}$、垂直于初始速度矢量的圆形区域。因此，截面为：\n$$\\sigma = \\pi b_{\\max}^2$$\n代入我们得到的 $b_{\\max}^2$ 表达式：\n$$\\sigma = \\pi R^2 \\left(1 + \\frac{2GM}{R v_{\\infty}^2}\\right)$$\n\n问题陈述指出，截面可以写成 $\\sigma = \\pi R^2(1 + \\Theta)$ 的形式，其中 $\\pi R^2$ 是几何截面，$\\Theta$ 是引力聚焦因子。通过将我们推导出的 $\\sigma$ 表达式与此形式进行比较，我们可以确定 $\\Theta$：\n$$\\pi R^2(1 + \\Theta) = \\pi R^2 \\left(1 + \\frac{2GM}{R v_{\\infty}^2}\\right)$$\n$$1 + \\Theta = 1 + \\frac{2GM}{R v_{\\infty}^2}$$\n这就得到了引力聚焦因子的显式解析表达式：\n$$\\Theta = \\frac{2GM}{R v_{\\infty}^2}$$\n这个因子是无量纲的。它的物理意义可以解释为目标体表面逃逸速度的平方 $v_{\\text{esc}}^2 = \\frac{2GM}{R}$ 与射弹渐近接近速度的平方 $v_{\\infty}^2$ 之比。因此，$\\Theta = \\left(\\frac{v_{\\text{esc}}}{v_{\\infty}}\\right)^2$。\n\n最后，我们分析有效域和高速撞击极限。当 $\\Theta \\gtrsim 1$ 时，由引力引起的截面增强效应是显著的，这发生在 $v_{\\infty} \\lesssim v_{\\text{esc}}$ 的情况下。所推导的模型在两体、非相对论相互作用且无非引力作用的假设下是有效的。\n\n对于高速撞击，$v_{\\infty}$ 变得非常大。“小偏转状态”对应于 $v_{\\infty} \\gg v_{\\text{esc}}$ 的极限情况。在这种状态下，聚焦因子 $\\Theta = \\frac{2GM}{R v_{\\infty}^2}$ 变得远小于 $1$。对接近速度的主导阶依赖关系是 $\\Theta \\propto v_{\\infty}^{-2}$。当 $v_{\\infty} \\to \\infty$ 时，$\\Theta \\to 0$。碰撞截面于是接近其几何极限：\n$$\\lim_{v_{\\infty} \\to \\infty} \\sigma = \\lim_{v_{\\infty} \\to \\infty} \\left[ \\pi R^2(1 + \\Theta) \\right] = \\pi R^2$$\n这一结果量化了聚焦增强效应的局限性：对于足够快的射弹，引力对其轨道的影响可以忽略不计，目标体的有效尺寸就是其物理尺寸。小偏转状态由 $v_{\\infty} \\gg \\sqrt{2GM/R}$ 定义，此时引力弯曲对射弹路径而言是一个小扰动。\n\n所要求的最终答案是 $\\Theta$ 的显式表达式。",
            "answer": "$$\\boxed{\\frac{2GM}{R v_{\\infty}^{2}}}$$"
        },
        {
            "introduction": "太阳系中小天体的轨道记录了它们与巨行星相互作用的动态历史。本练习将引导你推导并应用蒂塞朗参数（Tisserand's parameter），这是一个在三体问题中近似守恒的量，常被用作区分不同彗星族群（如木星族彗星和哈雷型彗星）的“动力学指纹”。通过这个实践，你将学会如何利用一个理论工具来解释观测到的轨道分布。",
            "id": "4178361",
            "problem": "观测到一组小天体与木星有重复的近距离相互作用。假设太阳和木星构成圆型限制性三体问题，并且弱的、非破坏性的交会过程会保持一个与雅可比常数相关的近似不变量。仅使用日心运动的基本二体关系（比能和比角动量）和到共转坐标系的标准坐标系变换作为你的出发点。\n\n木星的日心半长轴为 $a_J = 5.204 \\ \\mathrm{AU}$。对于每个天体，在发现时测得的密切日心轨道根数是其半长轴 $a$（单位为AU）、偏心率 $e$ 和轨道倾角 $i$（单位为度）。在一个固定的观测窗口内，记录了最小的木心最近距离 $r_{\\min}$（表示为木星希尔半径 $R_H$ 的倍数）。这五个天体是：\n- 天体 A：$a = 3.5 \\ \\mathrm{AU}$，$e = 0.50$，$i = 10^\\circ$，$r_{\\min}/R_H = 0.60$。\n- 天体 B：$a = 16 \\ \\mathrm{AU}$，$e = 0.80$，$i = 60^\\circ$，$r_{\\min}/R_H = 1.80$。\n- 天体 C：$a = 4.8 \\ \\mathrm{AU}$，$e = 0.20$，$i = 2^\\circ$，$r_{\\min}/R_H = 0.80$。\n- 天体 D：$a = 30 \\ \\mathrm{AU}$，$e = 0.90$，$i = 165^\\circ$，$r_{\\min}/R_H = 3.00$。\n- 天体 E：$a = 5.5 \\ \\mathrm{AU}$，$e = 0.05$，$i = 4^\\circ$，$r_{\\min}/R_H = 0.40$。\n\n任务：\n1. 从共转坐标系中雅可比常数的守恒性、日心活力公式以及比角动量出发，推导出一个关于木星的无量纲、近似守恒的轨道根数组合（相对于木星的类蒂塞朗参数），记为 $T_J$，用 $a$、$e$、$i$ 和 $a_J$ 表示。除所述基本原理外，不得假定任何经验上的捷径。\n2. 使用给定的 $a_J$ 计算每个天体的 $T_J$。角度的三角函数均以度为单位计算。\n3. 采用以下动力学路径的操作分类方法：\n   - 类木星族彗星 (JFC-like): $2  T_J  3$ 且 $r_{\\min}/R_H  1$,\n   - 类哈雷型彗星 (HTC-like): $T_J  2$ 且 $r_{\\min}/R_H > 1$。\n   不满足这些组合标准之一的天体应被视为不明确，并从计数中排除。\n4. 报告五个天体中满足组合标准的类木星族彗星的比例，以小数形式表示，并四舍五入到四位有效数字。最终答案只报告这个比例（无单位）。",
            "solution": "用户提供的问题被评估为有效，因为它在天体力学方面有科学依据，问题适定、客观且内容完整。它提出了一个应用蒂塞朗参数概念的标准练习。\n\n### 第1部分：蒂塞朗参数（$T_J$）的推导\n\n我们从圆型限制性三体问题（CR3BP）的框架开始，其中太阳为主质量（$M_S$），木星为次质量（$M_J$）。一个质量可忽略的小天体是第三体。我们建立一个参考系，它以恒定的平均运动 $n$ 绕着太阳-木星质心与木星一同旋转。太阳和木星位于 $x$ 轴上。\n\n雅可比常数 $C_J$ 是该系统中的一个运动积分，其表达式为：\n$$C_J = 2U - v_{rot}^2$$\n其中 $v_{rot}$ 是小天体在共转坐标系中的速度，U 是有效势：\n$$U(x,y,z) = \\frac{1}{2}n^2(x^2+y^2) + \\frac{GM_S}{r_S} + \\frac{GM_J}{r_J}$$\n这里，$r_S$ 和 $r_J$ 分别是小天体到太阳和木星的距离，$G$ 是引力常数。\n\n惯性（日心）坐标系中的速度 $\\vec{v}_{in}$ 与共转坐标系中的速度 $\\vec{v}_{rot}$ 通过关系式 $\\vec{v}_{in} = \\vec{v}_{rot} + \\vec{\\omega} \\times \\vec{r}$ 相关联，其中 $\\vec{\\omega} = n\\hat{k}$ 是坐标系的角速度矢量。速度的平方为：\n$$v_{rot}^2 = |\\vec{v}_{in} - \\vec{\\omega} \\times \\vec{r}|^2 = v_{in}^2 - 2\\vec{v}_{in} \\cdot (\\vec{\\omega} \\times \\vec{r}) + (\\vec{\\omega} \\times \\vec{r})^2$$\n使用矢量恒等式 $\\vec{A} \\cdot (\\vec{B} \\times \\vec{C}) = \\vec{B} \\cdot (\\vec{C} \\times \\vec{A})$，中间项变为 $2\\vec{\\omega} \\cdot (\\vec{r} \\times \\vec{v}_{in}) = 2n\\hat{k} \\cdot \\vec{h} = 2nh_z$，其中 $\\vec{h} = \\vec{r} \\times \\vec{v}_{in}$ 是小天体在惯性系中的比角动量矢量，$h_z$ 是其沿旋转轴的分量。最后一项是 $(\\vec{\\omega} \\times \\vec{r})^2 = n^2(x^2+y^2)$。\n因此，$v_{rot}^2 = v_{in}^2 - 2nh_z + n^2(x^2+y^2)$。\n\n将 $v_{rot}^2$ 和 $U$ 代入 $C_J$ 的表达式：\n$$C_J = n^2(x^2+y^2) + \\frac{2GM_S}{r_S} + \\frac{2GM_J}{r_J} - \\left(v_{in}^2 - 2nh_z + n^2(x^2+y^2)\\right)$$\n$$C_J = \\frac{2GM_S}{r_S} + \\frac{2GM_J}{r_J} - v_{in}^2 + 2nh_z$$\n\n在二体近似（太阳+小天体）下，小天体的比轨道能由活力公式给出，即 $\\mathcal{E} = \\frac{v_{in}^2}{2} - \\frac{GM_S}{r_S} = -\\frac{GM_S}{2a}$，其中 $a$ 是日心半长轴。由此可得 $v_{in}^2 = \\frac{2GM_S}{r_S} - \\frac{GM_S}{a}$。\n\n将 $v_{in}^2$ 代入 $C_J$ 的表达式：\n$$C_J = \\frac{2GM_S}{r_S} + \\frac{2GM_J}{r_J} - \\left(\\frac{2GM_S}{r_S} - \\frac{GM_S}{a}\\right) + 2nh_z$$\n$$C_J = \\frac{GM_S}{a} + \\frac{2GM_J}{r_J} + 2nh_z$$\n\n蒂塞朗参数源于一个近似。$C_J$ 在整个交会过程中是守恒的。然而，我们可以在远离木星、不受扰动的日心轨道段上评估其形式，此时 $2GM_J/r_J$ 项可以忽略不计。这得出了一个沿开普勒路径近似守恒的量 $C'$：\n$$C' \\approx \\frac{GM_S}{a} + 2nh_z$$\n木星的平均运动为 $n \\approx \\sqrt{GM_S/a_J^3}$（假设 $M_J \\ll M_S$）。比角动量的大小为 $|\\vec{h}| = \\sqrt{GM_S a(1-e^2)}$，其中 $e$ 是偏心率。其 $z$ 分量是 $h_z = |\\vec{h}|\\cos(i) = \\sqrt{GM_S a(1-e^2)}\\cos(i)$，其中 $i$ 是相对于木星轨道平面的轨道倾角。\n\n代入 $n$ 和 $h_z$：\n$$C' \\approx \\frac{GM_S}{a} + 2\\left(\\sqrt{\\frac{GM_S}{a_J^3}}\\right)\\left(\\sqrt{GM_S a(1-e^2)}\\cos(i)\\right)$$\n$$C' \\approx \\frac{GM_S}{a} + 2\\frac{GM_S}{a_J^{3/2}}\\sqrt{a(1-e^2)}\\cos(i)$$\n为了创建一个无量纲参数，我们用一个特征量（通常是 $GM_S/a_J$）来归一化 $C'$。这就定义了相对于木星的蒂塞朗参数 $T_J$：\n$$T_J = \\frac{C'}{GM_S/a_J} = a_J \\left(\\frac{1}{a} + \\frac{2}{a_J^{3/2}}\\sqrt{a(1-e^2)}\\cos(i)\\right)$$\n$$T_J = \\frac{a_J}{a} + 2\\frac{\\sqrt{a(1-e^2)}}{a_J^{1/2}}\\cos(i)$$\n$$T_J = \\frac{a_J}{a} + 2\\sqrt{\\frac{a}{a_J}(1-e^2)}\\cos(i)$$\n这就是所要求的表达式。\n\n### 第2部分：计算每个天体的 $T_J$\n\n我们使用推导出的公式，并代入 $a_J = 5.204$。所有三角函数的角度均以度为单位。\n\n- **天体 A**：$a = 3.5$，$e = 0.50$，$i = 10^\\circ$\n  $T_{J,A} = \\frac{5.204}{3.5} + 2\\sqrt{\\frac{3.5}{5.204}(1-0.50^2)}\\cos(10^\\circ) \\approx 1.48686 + 2\\sqrt{0.67256 \\times 0.75} \\times 0.98481 \\approx 1.48686 + 1.39898 \\approx 2.8858$\n\n- **天体 B**：$a = 16$，$e = 0.80$，$i = 60^\\circ$\n  $T_{J,B} = \\frac{5.204}{16} + 2\\sqrt{\\frac{16}{5.204}(1-0.80^2)}\\cos(60^\\circ) \\approx 0.32525 + 2\\sqrt{3.07456 \\times 0.36} \\times 0.5 \\approx 0.32525 + 1.05207 \\approx 1.3773$\n\n- **天体 C**：$a = 4.8$，$e = 0.20$，$i = 2^\\circ$\n  $T_{J,C} = \\frac{5.204}{4.8} + 2\\sqrt{\\frac{4.8}{5.204}(1-0.20^2)}\\cos(2^\\circ) \\approx 1.08417 + 2\\sqrt{0.92237 \\times 0.96} \\times 0.99939 \\approx 1.08417 + 1.88085 \\approx 2.9650$\n\n- **天体 D**：$a = 30$，$e = 0.90$，$i = 165^\\circ$\n  $T_{J,D} = \\frac{5.204}{30} + 2\\sqrt{\\frac{30}{5.204}(1-0.90^2)}\\cos(165^\\circ) \\approx 0.17347 + 2\\sqrt{5.76480 \\times 0.19} \\times (-0.96593) \\approx 0.17347 - 2.02199 \\approx -1.8485$\n\n- **天体 E**：$a = 5.5$，$e = 0.05$，$i = 4^\\circ$\n  $T_{J,E} = \\frac{5.204}{5.5} + 2\\sqrt{\\frac{5.5}{5.204}(1-0.05^2)}\\cos(4^\\circ) \\approx 0.94618 + 2\\sqrt{1.05765 \\times 0.9975} \\times 0.99756 \\approx 0.94618 + 2.04929 \\approx 2.9955$\n\n### 第3部分：天体分类\n\n我们应用给定的标准：\n- 类木星族彗星 (JFC-like): $2  T_J  3$ 且 $r_{\\min}/R_H  1$。\n- 类哈雷型彗星 (HTC-like): $T_J  2$ 且 $r_{\\min}/R_H > 1$。\n\n- **天体 A**：$T_J \\approx 2.886$，$r_{\\min}/R_H = 0.60$。\n  $2  2.886  3$ (真) 且 $0.60  1$ (真)。 $\\implies$ **类木星族彗星**。\n\n- **天体 B**：$T_J \\approx 1.377$，$r_{\\min}/R_H = 1.80$。\n  $1.377  2$ (真) 且 $1.80 > 1$ (真)。 $\\implies$ **类哈雷型彗星**。\n\n- **天体 C**：$T_J \\approx 2.965$，$r_{\\min}/R_H = 0.80$。\n  $2  2.965  3$ (真) 且 $0.80  1$ (真)。 $\\implies$ **类木星族彗星**。\n\n- **天体 D**：$T_J \\approx -1.849$，$r_{\\min}/R_H = 3.00$。\n  $-1.849  2$ (真) 且 $3.00 > 1$ (真)。 $\\implies$ **类哈雷型彗星**。\n\n- **天体 E**：$T_J \\approx 2.995$，$r_{\\min}/R_H = 0.40$。\n  $2  2.995  3$ (真) 且 $0.40  1$ (真)。 $\\implies$ **类木星族彗星**。\n\n### 第4部分：最终计算\n\n在观测的五个天体中，有三个被归类为类木星族彗星（天体A、C和E）。天体总数为五个。类木星族彗星天体的比例为：\n$$\\text{比例} = \\frac{\\text{类木星族彗星数量}}{\\text{天体总数}} = \\frac{3}{5} = 0.6$$\n题目要求答案以小数形式表示，并四舍五入到四位有效数字，即 $0.6000$。",
            "answer": "$$\\boxed{0.6000}$$"
        },
        {
            "introduction": "我们无法直接探测行星的内部，但其外部引力场揭示了其内部质量分布的线索。这个高级计算练习让你扮演行星科学家的角色，通过构建一个简化的内部结构模型来反演木星的核心质量。你将学习如何将物理模型转化为代码，并将其预测的引力谐数（$J_{2}$ 和 $J_{4}$）与来自“朱诺号”（Juno）任务的真实观测约束进行拟合与比较，这是现代行星科学研究的核心技能。",
            "id": "4178347",
            "problem": "您的任务是使用一个简化的流体静力学内部模型来估计木星的核心质量，该模型能预测行星的偶次纬向引力谐波，然后将得到的拟合结果与 Juno 任务测量的引力场得出的约束条件进行比较。您的程序必须是一个完整的、可运行的程序，通过最小化模型预测的引力矩与观测值在一小组参数用例测试套件中的失配来进行估算。\n\n简化的物理设置如下。将木星建模为一个在缓慢、均匀自转下的双层球状天体。该行星有一个密度均匀的中心核心和一个密度均匀的外包层。设总质量为 $M$，赤道半径为 $R$，自转速率为 $\\Omega$。核心的质量为 $M_{\\mathrm{c}}$，密度为 $\\rho_{\\mathrm{c}}$，其核心半径 $r_{\\mathrm{c}}$ 由体积-质量关系 $M_{\\mathrm{c}} = \\frac{4 \\pi}{3} \\rho_{\\mathrm{c}} r_{\\mathrm{c}}^{3}$ 决定。外包层密度 $\\rho_{\\mathrm{e}}$ 是均匀的，并由质量守恒确定，即 $M - M_{\\mathrm{c}} = \\frac{4 \\pi}{3} \\rho_{\\mathrm{e}} \\left( R^{3} - r_{\\mathrm{c}}^{3} \\right)$，前提是 $r_{\\mathrm{c}}  R$。\n\n定义无量纲的旋转参数\n$$\nm \\equiv \\frac{\\Omega^{2} R^{3}}{G M},\n$$\n其中 $G$ 是牛顿引力常数。对于一个具有球对称密度 $\\rho(r)$ 的缓慢旋转的流体静力学行星，其流体二阶潮汐勒夫数 $k_{2}$ 可以使用 Darwin–Radau 关系来近似，该关系通过以下方式将转动惯量因子 $\\lambda \\equiv \\frac{C}{M R^{2}}$ 与 Radau 参数 $\\eta$ 的表面值联系起来：\n$$\n\\lambda = \\frac{2}{3} \\left( 1 - \\frac{2}{5} \\sqrt{1 + \\eta} \\right).\n$$\n反转此表达式可得\n$$\n\\sqrt{1 + \\eta} = \\frac{5}{2} \\left( 1 - \\frac{3}{2} \\lambda \\right), \\quad \\eta = \\left[ \\frac{5}{2} \\left( 1 - \\frac{3}{2} \\lambda \\right) \\right]^{2} - 1,\n$$\n并随后得到\n$$\nk_{2} = \\frac{3}{2} \\frac{1}{1 + \\eta}.\n$$\n对于慢速旋转，纬向谐波系数的主导项可以表示为\n$$\nJ_{2} \\approx \\frac{k_{2}}{3} m,\n$$\n并且，在本练习中，对四阶矩采用二阶标度关系\n$$\nJ_{4} \\approx -\\frac{k_{2}^{2}}{5} m^{2},\n$$\n这是一个常用的近似，它捕捉了在分层的流体静力学构型中，$J_{4}$ 与 $m^{2}$ 的标度关系以及对二阶响应的二次依赖性。\n\n在双层均匀密度模型中，总轴向转动惯量 $C$ 为\n$$\nC = C_{\\mathrm{c}} + C_{\\mathrm{e}},\n$$\n其中核心的贡献为 $C_{\\mathrm{c}} = \\frac{2}{5} M_{\\mathrm{c}} r_{\\mathrm{c}}^{2}$，均匀球壳外包层的贡献为\n$$\nC_{\\mathrm{e}} = \\frac{8 \\pi}{15} \\rho_{\\mathrm{e}} \\left( R^{5} - r_{\\mathrm{c}}^{5} \\right).\n$$\n转动惯量因子则为 $\\lambda = \\frac{C}{M R^{2}}$。使用 $\\lambda$，通过上面的 Darwin–Radau 反演计算 $k_{2}$，然后使用所提供的主导阶关系计算 $J_{2}$ 和 $J_{4}$。\n\n您的程序必须对下面测试套件中的每个测试用例，估计最佳拟合的核心质量 $M_{\\mathrm{c}}$（受物理可行性约束 $r_{\\mathrm{c}}  R$ 的限制），该质量使模型预测值与指定目标值之间的加权平方失配最小化：\n$$\n\\mathcal{E}(M_{\\mathrm{c}}) = \\left( \\frac{J_{2}(M_{\\mathrm{c}}) - J_{2}^{\\mathrm{obs}}}{\\sigma_{2}} \\right)^{2} + \\left( \\frac{J_{4}(M_{\\mathrm{c}}) - J_{4}^{\\mathrm{obs}}}{\\sigma_{4}} \\right)^{2}.\n$$\n量 $J_{2}^{\\mathrm{obs}}$ 和 $J_{4}^{\\mathrm{obs}}$ 是目标值，$\\sigma_{2}$ 和 $\\sigma_{4}$ 是失配的加权尺度。此外，您必须检查在最佳拟合 $M_{\\mathrm{c}}$ 处，模型预测的 $J_{2}$ 和 $J_{4}$ 是否落在代表 Juno 引力测量约束的指定允许范围内。所有物理量必须使用国际单位制（千克、米、秒），最终的核心质量必须以地球质量表示，地球质量记为 $M_{\\oplus}$。\n\n所有情况下使用的常量：\n- $G = 6.67430 \\times 10^{-11} \\ \\mathrm{m^{3} \\ kg^{-1} \\ s^{-2}}$,\n- $M = 1.89813 \\times 10^{27} \\ \\mathrm{kg}$ (木星质量),\n- $R = 7.1492 \\times 10^{7} \\ \\mathrm{m}$ (木星赤道半径),\n- $M_{\\oplus} = 5.97219 \\times 10^{24} \\ \\mathrm{kg}$.\n\n测试套件包含三个用例，用于探索模型的不同方面：\n1. 具有典型流体静力学假设的理想路径用例：\n   - 核心密度 $\\rho_{\\mathrm{c}} = 1.8 \\times 10^{4} \\ \\mathrm{kg \\ m^{-3}}$,\n   - 自转周期 $P = 9 \\ \\mathrm{h} \\ 55 \\ \\mathrm{min} \\ 29.71 \\ \\mathrm{s}$ (通过 $\\Omega = 2 \\pi / P$ 使用弧度每秒),\n   - 目标 $J_{2}^{\\mathrm{obs}} = 0.014696$, 允许范围 $[0.0143, \\ 0.0151]$,\n   - 目标 $J_{4}^{\\mathrm{obs}} = -5.87 \\times 10^{-4}$, 允许范围 $[-9.0 \\times 10^{-4}, \\ -3.0 \\times 10^{-4}]$,\n   - 使用失配尺度 $\\sigma_{2} = 1.0 \\times 10^{-4}$, $\\sigma_{4} = 1.0 \\times 10^{-4}$.\n2. 具有更密集核心和更严格边界的边界敏感性用例：\n   - 核心密度 $\\rho_{\\mathrm{c}} = 2.5 \\times 10^{4} \\ \\mathrm{kg \\ m^{-3}}$,\n   - 自转与用例1相同,\n   - 目标 $J_{2}^{\\mathrm{obs}} = 0.014696$, 允许范围 $[0.0145, \\ 0.0149]$,\n   - 目标 $J_{4}^{\\mathrm{obs}} = -5.87 \\times 10^{-4}$, 允许范围 $[-7.0 \\times 10^{-4}, \\ -5.0 \\times 10^{-4}]$,\n   - 使用失配尺度 $\\sigma_{2} = 5.0 \\times 10^{-5}$, $\\sigma_{4} = 5.0 \\times 10^{-5}$.\n3. 自转稍慢的边缘用例：\n   - 核心密度 $\\rho_{\\mathrm{c}} = 1.8 \\times 10^{4} \\ \\mathrm{kg \\ m^{-3}}$,\n   - 自转周期 $P = 10 \\ \\mathrm{h} \\ 0 \\ \\mathrm{min} \\ 0 \\ \\mathrm{s}$,\n   - 目标 $J_{2}^{\\mathrm{obs}} = 0.014696$, 允许范围 $[0.0143, \\ 0.0151]$,\n   - 目标 $J_{4}^{\\mathrm{obs}} = -5.87 \\times 10^{-4}$, 允许范围 $[-9.0 \\times 10^{-4}, \\ -3.0 \\times 10^{-4}]$,\n   - 使用失配尺度 $\\sigma_{2} = 1.0 \\times 10^{-4}$, $\\sigma_{4} = 1.0 \\times 10^{-4}$.\n\n算法要求：\n- 在 $[0, \\ 30] \\ M_{\\oplus}$ 范围内搜索 $M_{\\mathrm{c}}$，分辨率为 $0.05 \\ M_{\\oplus}$。\n- 对于每个候选 $M_{\\mathrm{c}}$，计算 $r_{\\mathrm{c}}$，确保 $r_{\\mathrm{c}}  R$，计算 $\\rho_{\\mathrm{e}}$、$\\lambda$，然后计算 $k_{2}$、$m$、$J_{2}$ 和 $J_{4}$。\n- 如果任何中间量不符合物理实际（例如，$r_{\\mathrm{c}} \\ge R$ 或 $\\sqrt{1 + \\eta} \\le 0$），则丢弃该候选值或为其分配一个大的失配值。\n- 找出使 $\\mathcal{E}(M_{\\mathrm{c}})$ 最小化的 $M_{\\mathrm{c}}$。\n- 报告最佳拟合的核心质量（以 $M_{\\oplus}$ 为单位，保留两位小数），以及一个布尔值，指示在最佳拟合质量下，$J_{2}$ 和 $J_{4}$ 是否都落在为该用例指定的允许范围内。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，并且本身也是一个形式为 $[\\text{best\\_core\\_mass\\_in\\_}M_{\\oplus}, \\ \\text{in\\_bounds\\_flag}]$ 的列表。例如：“[[12.34,True],[8.50,False],[5.75,True]]”。\n- 确保输出中的数值核心质量四舍五入到两位小数。",
            "solution": "基于木星引力谐波估算其核心质量的问题，是行星内部建模中一个提法明确且有科学依据的练习。它采用了既定的物理原理，尽管是在一个简化的双层背景下。验证过程证实了问题的完整性。\n\n### 步骤 1：提取已知条件\n\n**常量：**\n- 引力常数: $G = 6.67430 \\times 10^{-11} \\ \\mathrm{m^{3} \\ kg^{-1} \\ s^{-2}}$\n- 木星质量: $M = 1.89813 \\times 10^{27} \\ \\mathrm{kg}$\n- 木星赤道半径: $R = 7.1492 \\times 10^{7} \\ \\mathrm{m}$\n- 地球质量: $M_{\\oplus} = 5.97219 \\times 10^{24} \\ \\mathrm{kg}$\n\n**方程与定义：**\n- 旋转参数: $m \\equiv \\frac{\\Omega^{2} R^{3}}{G M}$\n- 核心质量-半径关系: $M_{\\mathrm{c}} = \\frac{4 \\pi}{3} \\rho_{\\mathrm{c}} r_{\\mathrm{c}}^{3}$\n- 由质量守恒得出的外包层密度: $M - M_{\\mathrm{c}} = \\frac{4 \\pi}{3} \\rho_{\\mathrm{e}} \\left( R^{3} - r_{\\mathrm{c}}^{3} \\right)$\n- 转动惯量因子: $\\lambda \\equiv \\frac{C}{M R^{2}}$\n- Darwin–Radau 关系反演: $\\sqrt{1 + \\eta} = \\frac{5}{2} \\left( 1 - \\frac{3}{2} \\lambda \\right)$\n- Radau 参数: $\\eta = \\left[ \\frac{5}{2} \\left( 1 - \\frac{3}{2} \\lambda \\right) \\right]^{2} - 1$\n- 潮汐勒夫数 $k_{2}$: $k_{2} = \\frac{3}{2} \\frac{1}{1 + \\eta}$\n- 纬向谐波近似: $J_{2} \\approx \\frac{k_{2}}{3} m$, $J_{4} \\approx -\\frac{k_{2}^{2}}{5} m^{2}$\n- 核心转动惯量: $C_{\\mathrm{c}} = \\frac{2}{5} M_{\\mathrm{c}} r_{\\mathrm{c}}^{2}$\n- 外包层转动惯量: $C_{\\mathrm{e}} = \\frac{8 \\pi}{15} \\rho_{\\mathrm{e}} \\left( R^{5} - r_{\\mathrm{c}}^{5} \\right)$\n- 总转动惯量: $C = C_{\\mathrm{c}} + C_{\\mathrm{e}}$\n- 待最小化的失配函数: $\\mathcal{E}(M_{\\mathrm{c}}) = \\left( \\frac{J_{2}(M_{\\mathrm{c}}) - J_{2}^{\\mathrm{obs}}}{\\sigma_{2}} \\right)^{2} + \\left( \\frac{J_{4}(M_{\\mathrm{c}}) - J_{4}^{\\mathrm{obs}}}{\\sigma_{4}} \\right)^{2}$\n\n**算法要求：**\n- $M_{\\mathrm{c}}$ 的搜索范围: $[0, \\ 30] \\ M_{\\oplus}$\n- $M_{\\mathrm{c}}$ 的搜索分辨率: $0.05 \\ M_{\\oplus}$\n- 物理可行性检查：$r_{\\mathrm{c}}  R$ 以及 Darwin-Radau 表达式的有效性（隐含 $\\lambda \\le 2/3$）。\n\n**测试套件：**\n- **用例 1：**\n  - $\\rho_{\\mathrm{c}} = 1.8 \\times 10^{4} \\ \\mathrm{kg \\ m^{-3}}$\n  - $P = 9 \\ \\mathrm{h} \\ 55 \\ \\mathrm{min} \\ 29.71 \\ \\mathrm{s}$\n  - $J_{2}^{\\mathrm{obs}} = 0.014696$, 范围 $[0.0143, \\ 0.0151]$\n  - $J_{4}^{\\mathrm{obs}} = -5.87 \\times 10^{-4}$, 范围 $[-9.0 \\times 10^{-4}, \\ -3.0 \\times 10^{-4}]$\n  - $\\sigma_{2} = 1.0 \\times 10^{-4}$, $\\sigma_{4} = 1.0 \\times 10^{-4}$\n- **用例 2：**\n  - $\\rho_{\\mathrm{c}} = 2.5 \\times 10^{4} \\ \\mathrm{kg \\ m^{-3}}$\n  - $P$ 与用例1相同\n  - $J_{2}^{\\mathrm{obs}} = 0.014696$, 范围 $[0.0145, \\ 0.0149]$\n  - $J_{4}^{\\mathrm{obs}} = -5.87 \\times 10^{-4}$, 范围 $[-7.0 \\times 10^{-4}, \\ -5.0 \\times 10^{-4}]$\n  - $\\sigma_{2} = 5.0 \\times 10^{-5}$, $\\sigma_{4} = 5.0 \\times 10^{-5}$\n- **用例 3：**\n  - $\\rho_{\\mathrm{c}} = 1.8 \\times 10^{4} \\ \\mathrm{kg \\ m^{-3}}$\n  - $P = 10 \\ \\mathrm{h} \\ 0 \\ \\mathrm{min} \\ 0 \\ \\mathrm{s}$\n  - $J_{2}^{\\mathrm{obs}} = 0.014696$, 范围 $[0.0143, \\ 0.0151]$\n  - $J_{4}^{\\mathrm{obs}} = -5.87 \\times 10^{-4}$, 范围 $[-9.0 \\times 10^{-4}, \\ -3.0 \\times 10^{-4}]$\n  - $\\sigma_{2} = 1.0 \\times 10^{-4}$, $\\sigma_{4} = 1.0 \\times 10^{-4}$\n\n**输出格式：**\n- 一个列表的列表，例如 `[[12.34,True],[8.50,False]]`。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n该问题具有科学依据，采用了一个简化但有效的物理模型（双层流体静力学体），这是行星科学入门中的标准模型。Darwin-Radau 关系是针对缓慢旋转流体的一个著名近似。$J_2$ 和 $J_4$ 的表达式是标准的主导阶近似。所有提供的常量都是准确的。该问题是适定的；它指定了一个明确的目标函数，在一个离散、定义明确的搜索空间上进行最小化。所有必要的参数和方程都已提供，使得问题自成体系且没有矛盾。物理约束（$r_{\\mathrm{c}}  R$ 和 Darwin-Radau 关系的隐含有效性）是物理上必要的，并且已经说明。该问题是客观的，需要一个完全基于所提供形式体系的定量解。没有迹象表明存在科学上的不健全、模糊性或其他缺陷。\n\n### 步骤 3：结论与行动\n\n该问题是**有效的**。将开发并实施一个解决方案。\n\n### 基于原理的解决方案设计\n\n该解决方案涉及在参数空间上进行系统性搜索，以找到最符合观测约束的模型。该算法的核心是一个函数，它对于给定的核心质量 $M_{\\mathrm{c}}$，计算预测的引力谐波 $J_2$ 和 $J_4$。该函数封装了双层模型的物理原理。然后，整体算法使用此函数，通过最小化一个类似卡方的误差度量来找到最优的 $M_{\\mathrmc}$。\n\n**1. 物理模型实现：**对于每个候选核心质量 $M_{\\mathrm{c}}$：\n   - 首先将以地球质量（$M_{\\oplus}$）为单位的核心质量转换为国际单位制（kg）。\n   - 核心半径 $r_{\\mathrm{c}}$ 根据其质量 $M_{\\mathrm{c}}$ 和给定的密度 $\\rho_{\\mathrm{c}}$，通过球体体积公式确定：\n     $$r_{\\mathrm{c}} = \\left( \\frac{3 M_{\\mathrm{c}}}{4 \\pi \\rho_{\\mathrm{c}}} \\right)^{1/3}$$\n     一个关键的物理约束是核心必须小于行星，即 $r_{\\mathrm{c}}  R$。如果不满足此条件，则该候选 $M_{\\mathrm{c}}$ 无效。\n   - 外包层密度 $\\rho_{\\mathrm{e}}$ 通过质量守恒找到。外包层质量为 $M_{\\mathrm{env}} = M - M_{\\mathrm{c}}$，其体积为 $V_{\\mathrm{env}} = \\frac{4\\pi}{3}(R^3 - r_{\\mathrm{c}}^3)$。因此：\n     $$\\rho_{\\mathrm{e}} = \\frac{M - M_{\\mathrm{c}}}{\\frac{4\\pi}{3}(R^3 - r_{\\mathrm{c}}^3)}$$\n   - 总轴向转动惯量 $C$ 是核心和外包层贡献的总和。核心是一个实心球体，$C_{\\mathrm{c}} = \\frac{2}{5} M_{\\mathrm{c}} r_{\\mathrm{c}}^2$。外包层是一个球壳，$C_{\\mathrm{e}} = \\frac{2}{5} M_{\\mathrm{env}} \\frac{R^5 - r_{\\mathrm{c}}^5}{R^3 - r_{\\mathrm{c}}^3} = \\frac{8\\pi}{15}\\rho_{\\mathrm{e}}(R^5 - r_{\\mathrm{c}}^5)$。总和得出 $C = C_{\\mathrm{c}} + C_{\\mathrm{e}}$。\n   - 无量纲转动惯量因子为 $\\lambda = \\frac{C}{M R^2}$。Darwin-Radau 关系在 $\\lambda \\le 2/3$ 时有效。这作为另一个物理检查。\n   - 使用 $\\lambda$，我们计算潮汐勒夫数 $k_2$。首先，我们通过反演的 Darwin-Radau 关系找到量 $\\sqrt{1+\\eta}$：\n     $$\\sqrt{1 + \\eta} = \\frac{5}{2} \\left( 1 - \\frac{3}{2} \\lambda \\right)$$\n     然后，$k_2$ 计算如下：\n     $$k_{2} = \\frac{3}{2} \\frac{1}{(1+\\eta)} = \\frac{3/2}{\\left[\\frac{5}{2} \\left( 1 - \\frac{3}{2} \\lambda \\right)\\right]^2}$$\n   - 无量纲旋转参数 $m$ 每个测试用例计算一次，因为它取决于木星的总质量 $M$、半径 $R$ 和自转速率 $\\Omega = 2\\pi/P$：\n     $$m = \\frac{\\Omega^{2} R^{3}}{G M}$$\n   - 最后，估计纬向引力谐波：\n     $$J_{2} = \\frac{k_{2}}{3} m \\quad \\text{和} \\quad J_{4} = -\\frac{k_{2}^{2}}{5} m^{2}$$\n\n**2. 通过网格搜索进行优化：**\n该问题指定了在 $[0, 30] \\ M_{\\oplus}$ 范围内搜索最优核心质量 $M_{\\mathrm{c}}$，步长为 $0.05 \\ M_{\\oplus}$。这定义了一个候选值的离散网格。对每个测试用例，算法按以下步骤进行：\n   - 将最小误差 $\\mathcal{E}_{\\mathrm{min}}$ 初始化为一个非常大的值（无穷大）。\n   - 遍历网格上的每个候选核心质量 $M_{\\mathrm{c}}$。\n   - 对于每个 $M_{\\mathrm{c}}$，执行上述的物理模型计算。如果违反了任何物理约束（例如，$r_c \\ge R$ 或 $\\lambda > 2/3$），则为此候选值分配一个无穷大的误差，并继续下一个。\n   - 否则，使用计算出的 $J_2(M_c)$、$J_4(M_c)$ 以及用例特定的目标值（$J_2^{\\mathrm{obs}}$, $J_4^{\\mathrm{obs}}$）和权重（$\\sigma_2$, $\\sigma_4$）计算误差度量 $\\mathcal{E}(M_{\\mathrm{c}})$。\n   - 如果 $\\mathcal{E}(M_{\\mathrm{c}})  \\mathcal{E}_{\\mathrm{min}}$，则更新 $\\mathcal{E}_{\\mathrm{min}} = \\mathcal{E}(M_{\\mathrm{c}})$ 并将当前的 $M_{\\mathrm{c}}$ 及其对应的 $J_2$ 和 $J_4$ 存储为迄今为止的最佳拟合值。\n\n**3. 最终评估：**\n在对给定测试用例的所有候选核心质量进行迭代后，算法将确定最佳拟合的核心质量 $M_{\\mathrm{c, best}}$（以 $M_{\\oplus}$ 为单位）。最后一步是检查与 $M_{\\mathrm{c, best}}$ 对应的 $J_2$ 和 $J_4$ 值是否落在指定的允许范围内。该用例的结果是一对值：$M_{\\mathrm{c, best}}$ 的数值（四舍五入到两位小数）和一个布尔标志，指示解是否在指定的观测范围内。对测试套件中的所有测试用例重复此过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Estimates Jupiter's core mass by minimizing the mismatch between a \n    two-layer model's predicted gravitational harmonics (J2, J4) and \n    observational targets.\n    \"\"\"\n    \n    # --- Constants ---\n    G = 6.67430e-11  # m^3 kg^-1 s^-2\n    M_JUPITER = 1.89813e27  # kg\n    R_JUPITER = 7.1492e7   # m\n    M_EARTH = 5.97219e24   # kg\n\n    # --- Test Suite ---\n    test_cases = [\n        {\n            \"id\": 1,\n            \"rho_c\": 1.8e4,  # kg m^-3\n            \"P\": 9 * 3600 + 55 * 60 + 29.71,  # s\n            \"j2_obs\": 0.014696,\n            \"j2_bounds\": [0.0143, 0.0151],\n            \"j4_obs\": -5.87e-4,\n            \"j4_bounds\": [-9.0e-4, -3.0e-4],\n            \"sigma2\": 1.0e-4,\n            \"sigma4\": 1.0e-4,\n        },\n        {\n            \"id\": 2,\n            \"rho_c\": 2.5e4,\n            \"P\": 9 * 3600 + 55 * 60 + 29.71,\n            \"j2_obs\": 0.014696,\n            \"j2_bounds\": [0.0145, 0.0149],\n            \"j4_obs\": -5.87e-4,\n            \"j4_bounds\": [-7.0e-4, -5.0e-4],\n            \"sigma2\": 5.0e-5,\n            \"sigma4\": 5.0e-5,\n        },\n        {\n            \"id\": 3,\n            \"rho_c\": 1.8e4,\n            \"P\": 10 * 3600 + 0 * 60 + 0,\n            \"j2_obs\": 0.014696,\n            \"j2_bounds\": [0.0143, 0.0151],\n            \"j4_obs\": -5.87e-4,\n            \"j4_bounds\": [-9.0e-4, -3.0e-4],\n            \"sigma2\": 1.0e-4,\n            \"sigma4\": 1.0e-4,\n        },\n    ]\n\n    # --- Search Parameters ---\n    mc_search_range_me = np.arange(0.0, 30.01, 0.05)\n\n    all_results = []\n\n    for case in test_cases:\n        min_error = float('inf')\n        best_fit_mc = None\n        best_fit_j2 = None\n        best_fit_j4 = None\n        \n        # --- Pre-calculate case-specific constants ---\n        omega = 2 * np.pi / case[\"P\"]\n        m_rot = (omega**2 * R_JUPITER**3) / (G * M_JUPITER)\n\n        for mc_me in mc_search_range_me:\n            mc_kg = mc_me * M_EARTH\n\n            # --- Physical Model Calculations ---\n            # 1. Core radius\n            if case[\"rho_c\"] == 0:\n                continue \n            rc = (3 * mc_kg / (4 * np.pi * case[\"rho_c\"]))**(1/3)\n            \n            if rc >= R_JUPITER:\n                continue\n\n            # 2. Envelope density\n            vol_env = (4 * np.pi / 3) * (R_JUPITER**3 - rc**3)\n            if vol_env == 0:\n                continue\n            rho_e = (M_JUPITER - mc_kg) / vol_env\n            if rho_e = 0:\n                continue\n\n            # 3. Moment of inertia factor (lambda)\n            C_c = (2/5) * mc_kg * rc**2\n            C_e = (8 * np.pi / 15) * rho_e * (R_JUPITER**5 - rc**5)\n            C_total = C_c + C_e\n            lambda_moi = C_total / (M_JUPITER * R_JUPITER**2)\n\n            if lambda_moi > 2/3:\n                continue\n\n            # 4. Love number k2 via Darwin-Radau\n            sqrt_1_plus_eta_val = (5/2) * (1 - (3/2) * lambda_moi)\n            if sqrt_1_plus_eta_val = 0:\n                continue\n            k2 = (3/2) / (sqrt_1_plus_eta_val**2)\n\n            # 5. Gravitational harmonics J2, J4\n            j2_model = (k2 / 3) * m_rot\n            j4_model = -(k2**2 / 5) * m_rot**2\n\n            # 6. Mismatch/Error\n            error = ((j2_model - case[\"j2_obs\"]) / case[\"sigma2\"])**2 + \\\n                    ((j4_model - case[\"j4_obs\"]) / case[\"sigma4\"])**2\n\n            if error  min_error:\n                min_error = error\n                best_fit_mc = mc_me\n                best_fit_j2 = j2_model\n                best_fit_j4 = j4_model\n\n        # --- Final Evaluation for the case ---\n        if best_fit_mc is not None:\n            j2_in_bounds = case[\"j2_bounds\"][0] = best_fit_j2 = case[\"j2_bounds\"][1]\n            j4_in_bounds = case[\"j4_bounds\"][0] = best_fit_j4 = case[\"j4_bounds\"][1]\n            in_bounds_flag = j2_in_bounds and j4_in_bounds\n            \n            formatted_mass = f\"{best_fit_mc:.2f}\"\n            result_pair = [float(formatted_mass), in_bounds_flag]\n            all_results.append(result_pair)\n\n    # --- Print Final Output ---\n    output_str = \",\".join(map(str, all_results))\n    # The required format is [[...],[...]], so the outer brackets are added here.\n    # The default str() for a list already uses brackets.\n    print(f\"[{output_str}]\")\n\nsolve()\n```"
        }
    ]
}