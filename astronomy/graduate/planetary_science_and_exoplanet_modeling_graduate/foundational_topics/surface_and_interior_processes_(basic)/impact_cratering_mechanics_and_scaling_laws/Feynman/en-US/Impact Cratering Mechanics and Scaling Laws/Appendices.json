{
    "hands_on_practices": [
        {
            "introduction": "Understanding the relationship between an impactor's properties and the resulting crater size is central to planetary science. When the underlying physics is too complex for a direct derivation, dimensional analysis provides a powerful framework for constructing scaling laws. This exercise challenges you to apply this fundamental technique to a hypothetical \"momentum-dominated\" cratering regime, honing your ability to deduce relationships between physical quantities and test the consequences of different physical assumptions. ",
            "id": "4164150",
            "problem": "Consider an impact cratering scenario in the gravity-dominated, momentum-controlled regime on a rocky exoplanet. Two projectiles with masses and impact speeds $\\left(m_{1},U_{1}\\right)$ and $\\left(m_{2},U_{2}\\right)$ strike the same homogeneous half-space target of bulk density $\\rho$ under the same local gravitational acceleration $g$. Assume the impacts produce equal linear momentum, so that $m_{1}U_{1}=m_{2}U_{2}$, but different kinetic energies, since $E=\\frac{1}{2}mU^{2}$ depends on $U$. In the momentum-dominated limit, suppose the transient crater radius $R_{t}$ can be represented by a dimensionally consistent scaling of the form\n$$\nR_{t}\\propto \\left(mU\\right)^{\\alpha}\\,\\rho^{-\\beta}\\,g^{-\\gamma},\n$$\nwhere $\\alpha$, $\\beta$, and $\\gamma$ are real exponents to be determined by dimensional analysis and the target properties $\\rho$ and $g$ are identical for both impacts. Using only dimensional consistency and the premise that gravity controls the excavation (strength effects are negligible), determine the exponents $\\alpha$, $\\beta$, and $\\gamma$ and then compute the ratio of the transient crater radii $R_{t,1}/R_{t,2}$ produced by the two impacts. Express your final answer as a dimensionless number. No rounding is required. Use the International System of Units (SI) throughout your reasoning.",
            "solution": "The problem is deemed valid as it is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution via dimensional analysis.\n\nThe first step is to determine the exponents $\\alpha$, $\\beta$, and $\\gamma$ in the given scaling law for the transient crater radius $R_t$:\n$$\nR_t \\propto (mU)^\\alpha \\, \\rho^{-\\beta} \\, g^{-\\gamma}\n$$\nThis is accomplished through dimensional analysis. Let $k$ be a dimensionless constant of proportionality. The equation is:\n$$\nR_t = k (mU)^\\alpha \\, \\rho^{-\\beta} \\, g^{-\\gamma}\n$$\nThe fundamental dimensions involved are Mass ($M$), Length ($L$), and Time ($T$). We express the dimensions of each quantity in the SI system:\n\\begin{itemize}\n    \\item Transient crater radius, $R_t$: $[R_t] = L$\n    \\item Impactor momentum, $mU$: $[mU] = M \\cdot L \\cdot T^{-1}$\n    \\item Target density, $\\rho$: $[\\rho] = M \\cdot L^{-3}$\n    \\item Gravitational acceleration, $g$: $[g] = L \\cdot T^{-2}$\n\\end{itemize}\nFor the equation to be dimensionally consistent, the dimensions on both sides must be equal.\n$$\n[R_t] = [mU]^\\alpha [\\rho]^{-\\beta} [g]^{-\\gamma}\n$$\nSubstituting the dimensions for each quantity:\n$$\nL^1 M^0 T^0 = (M L T^{-1})^\\alpha (M L^{-3})^{-\\beta} (L T^{-2})^{-\\gamma}\n$$\nWe distribute the exponents to each fundamental dimension:\n$$\nL^1 M^0 T^0 = (M^\\alpha L^\\alpha T^{-\\alpha}) (M^{-\\beta} L^{3\\beta}) (L^{-\\gamma} T^{2\\gamma})\n$$\nNext, we group the terms by the fundamental dimension:\n$$\nL^1 M^0 T^0 = M^{\\alpha - \\beta} L^{\\alpha + 3\\beta - \\gamma} T^{-\\alpha + 2\\gamma}\n$$\nEquating the exponents for each fundamental dimension ($M$, $L$, $T$) on both sides of the equation yields a system of three linear equations with three unknowns ($\\alpha, \\beta, \\gamma$):\n\\begin{enumerate}\n    \\item For Mass ($M$): $\\alpha - \\beta = 0$\n    \\item For Length ($L$): $\\alpha + 3\\beta - \\gamma = 1$\n    \\item For Time ($T$): $-\\alpha + 2\\gamma = 0$\n\\end{enumerate}\nWe solve this system of equations.\nFrom equation (1), we have $\\alpha = \\beta$.\nFrom equation (3), we have $\\alpha = 2\\gamma$. This also implies $\\gamma = \\frac{\\alpha}{2}$.\nNow, we substitute these relations into equation (2):\n$$\n\\alpha + 3(\\alpha) - \\left(\\frac{\\alpha}{2}\\right) = 1\n$$\n$$\n4\\alpha - \\frac{\\alpha}{2} = 1\n$$\nTo solve for $\\alpha$, we find a common denominator:\n$$\n\\frac{8\\alpha}{2} - \\frac{\\alpha}{2} = 1\n$$\n$$\n\\frac{7\\alpha}{2} = 1\n$$\n$$\n\\alpha = \\frac{2}{7}\n$$\nNow we can find $\\beta$ and $\\gamma$:\n$$\n\\beta = \\alpha = \\frac{2}{7}\n$$\n$$\n\\gamma = \\frac{\\alpha}{2} = \\frac{1}{2} \\left(\\frac{2}{7}\\right) = \\frac{1}{7}\n$$\nThus, the exponents are $\\alpha = \\frac{2}{7}$, $\\beta = \\frac{2}{7}$, and $\\gamma = \\frac{1}{7}$. The scaling law is:\n$$\nR_t \\propto (mU)^{2/7} \\, \\rho^{-2/7} \\, g^{-1/7}\n$$\nThe second step is to compute the ratio of the transient crater radii, $R_{t,1}/R_{t,2}$, for the two impacts. Let $k$ be the constant of proportionality.\nThe radius for the first impact is:\n$$\nR_{t,1} = k (m_1 U_1)^{2/7} \\rho^{-2/7} g^{-1/7}\n$$\nThe radius for the second impact is:\n$$\nR_{t,2} = k (m_2 U_2)^{2/7} \\rho^{-2/7} g^{-1/7}\n$$\nWe compute the ratio by dividing the expression for $R_{t,1}$ by the expression for $R_{t,2}$:\n$$\n\\frac{R_{t,1}}{R_{t,2}} = \\frac{k (m_1 U_1)^{2/7} \\rho^{-2/7} g^{-1/7}}{k (m_2 U_2)^{2/7} \\rho^{-2/7} g^{-1/7}}\n$$\nThe constant $k$ and the target properties $\\rho$ and $g$ are identical for both impacts and thus cancel out:\n$$\n\\frac{R_{t,1}}{R_{t,2}} = \\frac{(m_1 U_1)^{2/7}}{(m_2 U_2)^{2/7}} = \\left(\\frac{m_1 U_1}{m_2 U_2}\\right)^{2/7}\n$$\nThe problem states that the impacts produce equal linear momentum, i.e., $m_1 U_1 = m_2 U_2$. Therefore, the ratio of the momenta is equal to $1$:\n$$\n\\frac{m_1 U_1}{m_2 U_2} = 1\n$$\nSubstituting this into our expression for the ratio of the radii:\n$$\n\\frac{R_{t,1}}{R_{t,2}} = (1)^{2/7} = 1\n$$\nThe ratio of the transient crater radii is $1$.",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "An impact event does not begin at the surface; for any body with an atmosphere, the entry phase is a critical part of the process. This practice bridges analytical mechanics and computational modeling to quantify how atmospheric drag affects an incoming projectile. By deriving the speed reduction from first principles and implementing the model in code, you will gain hands-on experience in quantifying the \"filtering\" effect an atmosphere has on impactors of varying sizes, densities, and initial velocities. ",
            "id": "4164191",
            "problem": "A spherical projectile of radius $r$, material density $\\rho_{p}$, and constant drag coefficient $C_{D}$ enters a vertically stratified, isothermal planetary atmosphere from $z \\to \\infty$ with initial speed $U_{0}$. The atmospheric mass density varies with altitude as $\\rho_{a}(z) = \\rho_{a0} \\exp(-z/H)$, where $\\rho_{a0}$ is the surface atmospheric density and $H$ is the atmospheric scale height. Assume a straight, vertical trajectory, a stationary atmosphere, constant shape and cross-sectional area $A = \\pi r^{2}$, constant mass $m = \\tfrac{4}{3}\\pi r^{3}\\rho_{p}$, and neglect gravitational acceleration, lift, ablation, fragmentation, and planetary curvature.\n\nStarting from the fundamental laws and core definitions of mechanics (Newton’s second law of motion and the standard quadratic aerodynamic drag law), derive a physically consistent model for the speed evolution $v(t)$ during entry and use it to compute the absolute reduction in impact speed due to atmospheric drag, defined as $\\Delta U = U_{0} - U_{s}$, where $U_{s}$ is the speed at the surface ($z = 0$). Express all final numerical answers for $\\Delta U$ in meters per second (m/s) as floats.\n\nYour program must implement the derived model and evaluate $\\Delta U$ for the following test suite of parameter sets, each given as $(U_{0}, r, \\rho_{p}, C_{D}, H, \\rho_{a0})$ with units $(\\text{m/s}, \\text{m}, \\text{kg/m}^{3}, -, \\text{m}, \\text{kg/m}^{3})$:\n- Case $1$: $(20000, 5, 3000, 1.0, 8000, 1.225)$\n- Case $2$: $(20000, 5, 3000, 1.0, 8000, 0)$\n- Case $3$: $(20000, 0.05, 3000, 1.0, 8000, 1.225)$\n- Case $4$: $(20000, 10, 8000, 1.0, 8000, 1.225)$\n- Case $5$: $(20000, 5, 3000, 1.0, 2000, 1.225)$\n- Case $6$: $(70000, 5, 3000, 1.0, 8000, 1.225)$\n\nDesign for coverage:\n- Case $1$ is a general “happy path” Earth-like atmosphere and a stony impactor.\n- Case $2$ is the boundary condition of no atmosphere ($\\rho_{a0} = 0$), which should yield $\\Delta U = 0$.\n- Case $3$ is a small-radius body strongly affected by drag.\n- Case $4$ is a very dense, larger object weakly affected by drag.\n- Case $5$ tests a thin atmosphere with small scale height.\n- Case $6$ tests very high initial speed; note that the fractional reduction is speed-independent under the stated assumptions, but the absolute reduction scales with $U_{0}$.\n\nYour program should produce a single line of output containing the results for the six cases as a comma-separated list enclosed in square brackets, in the order of the cases above (e.g., $[result_{1},result_{2},result_{3},result_{4},result_{5},result_{6}]$). Each $result_{i}$ must be the float value of $\\Delta U$ in $\\text{m/s}$.",
            "solution": "The problem is assessed as valid as it is scientifically grounded in classical mechanics, well-posed with a complete set of initial conditions and parameters, and objectively stated. It represents a standard, albeit simplified, problem in atmospheric entry dynamics. We may proceed with the solution.\n\nThe solution begins with the application of Newton's second law of motion. For a projectile moving vertically downwards, the only force considered is aerodynamic drag, which opposes the motion. The equation of motion in the vertical direction ($z$) is:\n$$ m \\frac{d\\vec{v}}{dt} = \\vec{F}_{D} $$\nLet the positive $z$-axis point upwards from the surface of the planet, so the projectile starts at $z \\to \\infty$ and moves towards $z=0$. The velocity vector is $\\vec{v} = (0, 0, \\dot{z})$, where $\\dot{z} < 0$. We define the speed $v$ as the magnitude of the velocity, so $v = |\\dot{z}| = -\\dot{z}$. The acceleration component in the $z$-direction is $a_z = \\ddot{z} = \\frac{d}{dt}(-\\dot{z}) = -\\frac{dv}{dt}$.\n\nThe drag force $\\vec{F}_{D}$ acts in the positive $z$-direction (upwards), opposing motion. Its magnitude is given by the standard quadratic drag law:\n$$ F_{D} = \\frac{1}{2} \\rho_{a}(z) v^2 C_{D} A $$\nwhere $\\rho_{a}(z)$ is the atmospheric density at altitude $z$, $v$ is the speed, $C_{D}$ is the drag coefficient, and $A$ is the cross-sectional area.\n\nSubstituting these into Newton's second law for the $z$-component:\n$$ m a_z = F_{D} $$\n$$ m \\left(-\\frac{dv}{dt}\\right) = \\frac{1}{2} \\rho_{a}(z) v^2 C_{D} A $$\nThis differential equation relates the speed $v$ to both time $t$ and altitude $z$. To solve it, we change the independent variable from time $t$ to altitude $z$ using the chain rule:\n$$ \\frac{dv}{dt} = \\frac{dv}{dz} \\frac{dz}{dt} $$\nSince $v = -\\frac{dz}{dt}$, we have $\\frac{dz}{dt} = -v$. Substituting this into the chain rule expression gives:\n$$ \\frac{dv}{dt} = \\frac{dv}{dz}(-v) = -v\\frac{dv}{dz} $$\nNow, we substitute this expression for $\\frac{dv}{dt}$ back into the equation of motion:\n$$ m \\left(-(-v\\frac{dv}{dz})\\right) = \\frac{1}{2} \\rho_{a}(z) v^2 C_{D} A $$\n$$ mv\\frac{dv}{dz} = \\frac{1}{2} \\rho_{a}(z) v^2 C_{D} A $$\nAssuming the speed $v$ is non-zero during entry, we can divide by $v$:\n$$ m\\frac{dv}{dz} = \\frac{1}{2} \\rho_{a}(z) v C_{D} A $$\nThis is a first-order separable ordinary differential equation. We can rearrange it to separate the variables $v$ and $z$:\n$$ \\frac{dv}{v} = \\frac{C_{D} A}{2m} \\rho_{a}(z) dz $$\nThe problem provides the atmospheric density model $\\rho_{a}(z) = \\rho_{a0} \\exp(-z/H)$. Substituting this expression gives:\n$$ \\frac{dv}{v} = \\frac{C_{D} A \\rho_{a0}}{2m} e^{-z/H} dz $$\nWe now integrate this equation. The projectile enters the atmosphere from $z \\to \\infty$ with an initial speed $U_{0}$, and its speed is $v(z)$ at an arbitrary altitude $z$. The integration is performed from the initial state $(z=\\infty, v=U_{0})$ to the state $(z, v(z))$:\n$$ \\int_{U_{0}}^{v(z)} \\frac{dv'}{v'} = \\int_{\\infty}^{z} \\frac{C_{D} A \\rho_{a0}}{2m} e^{-z'/H} dz' $$\nThe left-hand side integrates to:\n$$ [\\ln(v')]_{U_{0}}^{v(z)} = \\ln(v(z)) - \\ln(U_{0}) = \\ln\\left(\\frac{v(z)}{U_{0}}\\right) $$\nThe right-hand side integral is:\n$$ \\int_{\\infty}^{z} \\frac{C_{D} A \\rho_{a0}}{2m} e^{-z'/H} dz' = \\frac{C_{D} A \\rho_{a0}}{2m} \\left[-H e^{-z'/H}\\right]_{\\infty}^{z} $$\n$$ = \\frac{C_{D} A \\rho_{a0}}{2m} \\left(-H e^{-z/H} - (-H e^{-\\infty/H})\\right) = -\\frac{C_{D} A \\rho_{a0} H}{2m} e^{-z/H} $$\nEquating the two sides, we get:\n$$ \\ln\\left(\\frac{v(z)}{U_{0}}\\right) = -\\frac{C_{D} A \\rho_{a0} H}{2m} e^{-z/H} $$\nExponentiating both sides yields the model for speed as a function of altitude:\n$$ v(z) = U_{0} \\exp\\left(-\\frac{C_{D} A \\rho_{a0} H}{2m} e^{-z/H}\\right) $$\nThe problem asks for the speed reduction at the surface, $\\Delta U = U_{0} - U_{s}$, where $U_{s}$ is the impact speed at $z=0$. We evaluate $v(z)$ at $z=0$:\n$$ U_{s} = v(0) = U_{0} \\exp\\left(-\\frac{C_{D} A \\rho_{a0} H}{2m} e^{0}\\right) = U_{0} \\exp\\left(-\\frac{C_{D} A \\rho_{a0} H}{2m}\\right) $$\nLet's substitute the given expressions for the projectile's mass $m = \\frac{4}{3}\\pi r^{3}\\rho_{p}$ and cross-sectional area $A = \\pi r^{2}$:\n$$ \\frac{A}{m} = \\frac{\\pi r^2}{\\frac{4}{3}\\pi r^{3}\\rho_{p}} = \\frac{3}{4r\\rho_{p}} $$\nThe argument of the exponential becomes:\n$$ \\frac{C_{D} A \\rho_{a0} H}{2m} = \\frac{C_{D} \\rho_{a0} H}{2} \\left(\\frac{3}{4r\\rho_{p}}\\right) = \\frac{3 C_{D} \\rho_{a0} H}{8 r \\rho_{p}} $$\nThis dimensionless parameter, let's call it $\\alpha$, governs the atmospheric braking effect.\n$$ \\alpha = \\frac{3 C_{D} \\rho_{a0} H}{8 r \\rho_{p}} $$\nThe surface impact speed is then:\n$$ U_{s} = U_{0} \\exp(-\\alpha) $$\nFinally, the absolute reduction in impact speed is:\n$$ \\Delta U = U_{0} - U_{s} = U_{0} - U_{0} \\exp(-\\alpha) = U_{0} \\left(1 - \\exp(-\\alpha)\\right) $$\nThis is the final expression used for computation.\n$$ \\Delta U = U_{0} \\left(1 - \\exp\\left(-\\frac{3 C_{D} \\rho_{a0} H}{8 r \\rho_{p}}\\right)\\right) $$\nThis model will be implemented to evaluate $\\Delta U$ for the provided test cases. For the case with no atmosphere, $\\rho_{a0} = 0$, which results in $\\alpha=0$ and thus $\\Delta U = U_{0}(1 - e^{0}) = 0$, as expected.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the absolute reduction in impact speed for a projectile entering a\n    stratified planetary atmosphere.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (U0, r, rho_p, C_D, H, rho_a0)\n    # Units: (m/s, m, kg/m^3, -, m, kg/m^3)\n    test_cases = [\n        (20000.0, 5.0, 3000.0, 1.0, 8000.0, 1.225),   # Case 1: General Earth-like\n        (20000.0, 5.0, 3000.0, 1.0, 8000.0, 0.0),     # Case 2: No atmosphere\n        (20000.0, 0.05, 3000.0, 1.0, 8000.0, 1.225),  # Case 3: Small radius projectile\n        (20000.0, 10.0, 8000.0, 1.0, 8000.0, 1.225),  # Case 4: Large, dense projectile\n        (20000.0, 5.0, 3000.0, 1.0, 2000.0, 1.225),   # Case 5: Thin atmosphere (small H)\n        (70000.0, 5.0, 3000.0, 1.0, 8000.0, 1.225),   # Case 6: High initial speed\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        U0, r, rho_p, C_D, H, rho_a0 = case\n\n        # The derived formula for speed reduction is:\n        # Delta_U = U0 * (1 - exp(-alpha))\n        # where alpha = (3 * C_D * rho_a0 * H) / (8 * r * rho_p)\n\n        # Handle the edge case of no atmosphere directly for robustness,\n        # although the formula works correctly.\n        if rho_a0 == 0.0:\n            delta_U = 0.0\n        else:\n            # The denominator cannot be zero based on problem constraints (r>0, rho_p>0)\n            denominator = 8.0 * r * rho_p\n            numerator = 3.0 * C_D * rho_a0 * H\n            \n            alpha = numerator / denominator\n            \n            delta_U = U0 * (1.0 - np.exp(-alpha))\n\n        results.append(delta_U)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The impact itself is just the beginning; the subsequent motion of excavated material sculpts the surrounding terrain and can reveal key properties of the planetary body. On rotating planets, the trajectories of ballistic ejecta are significantly perturbed by the Coriolis force, leading to observable asymmetries in the ejecta blanket. This advanced exercise provides hands-on practice in modeling motion in non-inertial frames by requiring the numerical integration of ejecta trajectories, demonstrating how large-scale surface patterns can be linked directly to fundamental planetary parameters like rotation rate and latitude. ",
            "id": "4164131",
            "problem": "Consider a point-source impact event on the surface of a rotating spherical body. Use a local tangent-plane approximation with orthonormal basis vectors $\\{\\hat{\\mathbf{e}}_E,\\hat{\\mathbf{e}}_N,\\hat{\\mathbf{e}}_U\\}$, representing east, north, and up, respectively. Let the planetary rotation rate be constant and equal to $\\Omega$ (in radians per second), and let the impact site be at geodetic latitude $\\phi$ (in radians). Assume a uniform, constant gravitational acceleration of magnitude $g$ (in meters per second squared) directed downward, i.e., $\\mathbf{g} = -g\\,\\hat{\\mathbf{e}}_U$. Neglect atmospheric drag, topography, curvature beyond the local tangent-plane approximation, and the centrifugal term by absorbing it into the effective gravity.\n\nEjecta are launched from a height $h_0$ above the local surface with initial speed $u$ (in meters per second), launch angle $\\alpha$ (in radians) above the local horizontal, and azimuth $\\psi$ (in radians) measured from east toward north. The initial velocity is\n$$\n\\mathbf{v}(0) = u\\cos\\alpha\\,\\cos\\psi\\,\\hat{\\mathbf{e}}_E + u\\cos\\alpha\\,\\sin\\psi\\,\\hat{\\mathbf{e}}_N + u\\sin\\alpha\\,\\hat{\\mathbf{e}}_U.\n$$\n\nIn the rotating frame of the body, the ejecta motion obeys Newton’s Second Law with Coriolis acceleration. The angular velocity vector decomposes in the local frame as\n$$\n\\boldsymbol{\\Omega} = \\Omega\\cos\\phi\\,\\hat{\\mathbf{e}}_N + \\Omega\\sin\\phi\\,\\hat{\\mathbf{e}}_U,\n$$\nand the equations of motion are\n$$\n\\frac{d\\mathbf{r}}{dt} = \\mathbf{v},\\quad\n\\frac{d\\mathbf{v}}{dt} = \\mathbf{g} - 2\\,\\boldsymbol{\\Omega}\\times\\mathbf{v}.\n$$\n\nDefine the landing time $t_f$ as the first time $t>0$ for which the vertical position returns to the surface, i.e., $z(t_f)=0$, where $\\mathbf{r}(t)=(x(t),y(t),z(t))$ in the local basis. Define the landing displacement vector in the tangent plane as $\\mathbf{d}=(x(t_f),y(t_f))$. Classify each ejecta ray as \"prograde\" if $x(t_f)>0$ (eastward half-plane) and \"retrograde\" if $x(t_f)<0$ (westward half-plane). Rays with $x(t_f)=0$ contribute zero to either class.\n\nDefine the azimuthal asymmetry metric\n$$\nA = \\frac{M_{\\text{prograde}} - M_{\\text{retrograde}}}{M_{\\text{total}}},\n$$\nwhere $M_{\\text{prograde}}$ and $M_{\\text{retrograde}}$ are the total deposited masses assigned equally per ray based on classification, and $M_{\\text{total}}$ is the sum of all ray masses. Assume equal mass per ray.\n\nYour task is to write a program that:\n- Integrates the above equations numerically for a set of ejecta rays with azimuths $\\psi$ uniformly partitioning $[0,2\\pi)$ and sampled at bin midpoints, i.e., $\\psi_k = \\frac{2\\pi}{N}\\left(k+\\frac{1}{2}\\right)$ for $k=0,1,\\dots,N-1$.\n- Detects the first surface crossing to obtain $\\mathbf{d}$ for each ray.\n- Computes the asymmetry metric $A$ for each parameter set in the test suite.\n\nUse the following constants and inputs for all tests unless otherwise specified:\n- Launch height $h_0=1\\,\\text{m}$.\n- Gravitational acceleration $g=9.81\\,\\text{m}\\,\\text{s}^{-2}$.\n- Launch speed $u=300\\,\\text{m}\\,\\text{s}^{-1}$.\n- Launch angle $\\alpha=\\pi/4\\,\\text{rad}$.\n- Number of rays $N=72$.\n\nAngles must be in radians. All outputs must be unitless decimal fractions. For numerical integration, ensure robust event detection at $z=0$ with $t>0$. Use scientifically plausible and self-consistent assumptions consistent with the given framework.\n\nTest suite (each case is a tuple $(\\Omega,\\phi)$ with $\\Omega$ in radians per second and $\\phi$ in radians):\n1. $(0.0,\\;0.0)$\n2. $(1.0\\times 10^{-4},\\;0.0)$\n3. $(5.0\\times 10^{-4},\\;\\pi/4)$\n4. $(1.0\\times 10^{-3},\\;\\pi/2)$\n5. $(7.0\\times 10^{-4},\\;-\\pi/6)$\n\nYour program should produce a single line of output containing the asymmetry values for the five cases, rounded to six decimal places, as a comma-separated list enclosed in square brackets (e.g., \"[a1,a2,a3,a4,a5]\").",
            "solution": "The user wants me to solve a physics problem about the motion of ejecta on a rotating body.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n\n- **Coordinate System**: Local tangent plane with orthonormal basis $\\{\\hat{\\mathbf{e}}_E,\\hat{\\mathbf{e}}_N,\\hat{\\mathbf{e}}_U\\}$.\n- **Planetary Parameters**: Constant rotation rate $\\Omega$ (rad/s), geodetic latitude $\\phi$ (rad).\n- **Physics Model**:\n    - Gravitational acceleration: $\\mathbf{g} = -g\\,\\hat{\\mathbf{e}}_U$, with $g=9.81\\,\\text{m}\\,\\text{s}^{-2}$.\n    - Equations of motion: $\\frac{d\\mathbf{r}}{dt} = \\mathbf{v}$, $\\frac{d\\mathbf{v}}{dt} = \\mathbf{g} - 2\\,\\boldsymbol{\\Omega}\\times\\mathbf{v}$.\n    - Angular velocity vector: $\\boldsymbol{\\Omega} = \\Omega\\cos\\phi\\,\\hat{\\mathbf{e}}_N + \\Omega\\sin\\phi\\,\\hat{\\mathbf{e}}_U$.\n    - Neglected effects: atmospheric drag, topography, non-local curvature, centrifugal term (absorbed into $\\mathbf{g}$).\n- **Ejecta Initial Conditions**:\n    - Initial height: $\\mathbf{r}(0) = (0, 0, h_0)$ with $h_0=1\\,\\text{m}$.\n    - Initial velocity: $\\mathbf{v}(0) = u\\cos\\alpha\\,\\cos\\psi\\,\\hat{\\mathbf{e}}_E + u\\cos\\alpha\\,\\sin\\psi\\,\\hat{\\mathbf{e}}_N + u\\sin\\alpha\\,\\hat{\\mathbf{e}}_U$.\n    - Initial speed: $u=300\\,\\text{m}\\,\\text{s}^{-1}$.\n    - Launch angle: $\\alpha=\\pi/4\\,\\text{rad}$.\n- **Task Definitions**:\n    - Azimuth sampling: $\\psi_k = \\frac{2\\pi}{N}\\left(k+\\frac{1}{2}\\right)$ for $k=0,1,\\dots,N-1$, with $N=72$.\n    - Landing time $t_f$: First time $t>0$ where $z(t_f)=0$.\n    - Landing displacement vector: $\\mathbf{d}=(x(t_f),y(t_f))$.\n    - Ray Classification: \"prograde\" if $x(t_f)>0$, \"retrograde\" if $x(t_f)<0$.\n    - Asymmetry Metric: $A = \\frac{M_{\\text{prograde}} - M_{\\text{retrograde}}}{M_{\\text{total}}}$, which simplifies to $A = \\frac{N_{\\text{prograde}} - N_{\\text{retrograde}}}{N}$ assuming equal mass per ray.\n- **Test Suite**:\n    1. $(\\Omega,\\phi) = (0.0,\\;0.0)$\n    2. $(\\Omega,\\phi) = (1.0\\times 10^{-4},\\;0.0)$\n    3. $(\\Omega,\\phi) = (5.0\\times 10^{-4},\\;\\pi/4)$\n    4. $(\\Omega,\\phi) = (1.0\\times 10^{-3},\\;\\pi/2)$\n    5. $(\\Omega,\\phi) = (7.0\\times 10^{-4},\\;-\\pi/6)$\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded**: The problem is a standard exercise in classical mechanics, specifically the dynamics of a projectile in a non-inertial (rotating) reference frame. The equations of motion including gravity and the Coriolis force are fundamentally sound and correctly stated.\n- **Well-Posed**: The problem is formulated as an initial value problem for a system of ordinary differential equations (ODEs). Given the well-defined initial conditions and the linear nature of the ODEs, a unique and stable solution exists for each ejecta ray. The aggregation of these solutions into the asymmetry metric is also well-defined.\n- **Objective**: The problem is stated using precise mathematical and physical terminology. All quantities and objectives are defined quantitatively, leaving no room for subjective interpretation.\n- **Completeness and Consistency**: All necessary constants ($h_0, g, u, \\alpha, N$), equations, and test parameters are provided. There are no contradictory constraints or missing pieces of information. The physical units are consistent.\n- **Feasibility**: The parameter values are physically realistic for planetary bodies. The task requires numerical integration, which is a standard and feasible computational method.\n- **Structure**: The problem is clearly structured and logically presented.\n- **Triviality**: While special cases (e.g., $\\Omega=0$ or $\\phi=\\pi/2$) have simpler analytical or semi-analytical solutions that can serve as checks, the general case requires numerical integration of a coupled system, making the problem non-trivial.\n\n**Step 3: Verdict and Action**\n\nThe problem is scientifically sound, well-posed, objective, complete, consistent, and non-trivial. It is therefore deemed **valid**. A solution will be provided.\n\n**Principle-Based Solution**\n\nThe problem requires us to determine the landing positions of multiple ejecta particles launched from a point on a rotating spherical body and classify them to compute an asymmetry metric. The motion is governed by Newton's second law in a rotating frame, which includes the Coriolis pseudo-force.\n\nFirst, we must explicitly write out the system of differential equations. The state of a particle at time $t$ is described by its position vector $\\mathbf{r}(t) = x(t)\\,\\hat{\\mathbf{e}}_E + y(t)\\,\\hat{\\mathbf{e}}_N + z(t)\\,\\hat{\\mathbf{e}}_U$ and its velocity vector $\\mathbf{v}(t) = v_x(t)\\,\\hat{\\mathbf{e}}_E + v_y(t)\\,\\hat{\\mathbf{e}}_N + v_z(t)\\,\\hat{\\mathbf{e}}_U$. The equations of motion are given by $\\frac{d\\mathbf{r}}{dt} = \\mathbf{v}$ and $\\frac{d\\mathbf{v}}{dt} = \\mathbf{g} - 2\\,\\boldsymbol{\\Omega}\\times\\mathbf{v}$.\n\nThe Coriolis term $\\boldsymbol{\\Omega}\\times\\mathbf{v}$ is computed as:\n$$\n\\boldsymbol{\\Omega} \\times \\mathbf{v} = \\begin{vmatrix} \\hat{\\mathbf{e}}_E & \\hat{\\mathbf{e}}_N & \\hat{\\mathbf{e}}_U \\\\ 0 & \\Omega\\cos\\phi & \\Omega\\sin\\phi \\\\ v_x & v_y & v_z \\end{vmatrix} = (\\Omega v_z \\cos\\phi - \\Omega v_y \\sin\\phi)\\,\\hat{\\mathbf{e}}_E + (\\Omega v_x \\sin\\phi)\\,\\hat{\\mathbf{e}}_N - (\\Omega v_x \\cos\\phi)\\,\\hat{\\mathbf{e}}_U\n$$\nThe acceleration vector $\\mathbf{a} = \\frac{d\\mathbf{v}}{dt}$ has components:\n$a_x = -2(\\Omega v_z \\cos\\phi - \\Omega v_y \\sin\\phi) = 2\\Omega(v_y \\sin\\phi - v_z \\cos\\phi)$\n$a_y = -2(\\Omega v_x \\sin\\phi)$\n$a_z = -g - 2(-\\Omega v_x \\cos\\phi) = -g + 2\\Omega v_x \\cos\\phi$\n\nThis gives us a system of six coupled, first-order linear ordinary differential equations for the state vector $\\mathbf{Y}(t) = [x, y, z, v_x, v_y, v_z]^T$:\n$$\n\\frac{d\\mathbf{Y}}{dt} =\n\\begin{pmatrix}\nv_x \\\\\nv_y \\\\\nv_z \\\\\n2\\Omega(v_y \\sin\\phi - v_z \\cos\\phi) \\\\\n-2\\Omega v_x \\sin\\phi \\\\\n-g + 2\\Omega v_x \\cos\\phi\n\\end{pmatrix}\n$$\nThe initial condition for each ray, indexed by $k \\in \\{0, 1, ..., N-1\\}$ with $N=72$, is determined by its launch azimuth $\\psi_k = \\frac{2\\pi}{N}(k+\\frac{1}{2})$:\n$\\mathbf{Y}(0) = [0, 0, h_0, u\\cos\\alpha\\cos\\psi_k, u\\cos\\alpha\\sin\\psi_k, u\\sin\\alpha]^T$.\nThe constants are $h_0=1\\,\\text{m}$, $u=300\\,\\text{m\\,s}^{-1}$, $\\alpha=\\pi/4\\,\\text{rad}$, and $g=9.81\\,\\text{m\\,s}^{-2}$.\n\nThis system does not have a simple closed-form solution for the general case (arbitrary $\\Omega, \\phi$). Therefore, we must employ numerical integration. The `scipy.integrate.solve_ivp` function is an appropriate tool for this task. It is a robust ODE solver that can handle such systems.\n\nA crucial part of the problem is to find the landing time $t_f$, defined as the first time $t>0$ at which the particle's altitude $z(t)$ returns to zero. `solve_ivp` has a built-in event detection mechanism. We define an event function that tracks the value of $z(t)$ (the third component of the state vector, $Y[2]$). We configure this event to be \"terminal\" (i.e., stop the integration) and to trigger only when the function $z(t)$ crosses zero in the negative direction (i.e., the particle is landing from above).\n\nThe overall algorithm for each test case $(\\Omega, \\phi)$ is as follows:\n1. Initialize a prograde count $N_{\\text{prograde}}=0$ and a retrograde count $N_{\\text{retrograde}}=0$.\n2. Generate the $N=72$ uniformly spaced launch azimuths $\\psi_k$.\n3. For each $\\psi_k$:\n    a. Construct the initial state vector $\\mathbf{Y}(0)$.\n    b. Numerically integrate the system of ODEs from $t=0$ until the event $z(t)=0$ is detected. A sufficiently large time span must be provided to ensure the event occurs.\n    c. From the integration result, extract the state vector at the event time $t_f$. The landing position in the east direction is $x(t_f)$.\n    d. Classify the ray: if $x(t_f) > 0$, increment $N_{\\text{prograde}}$; if $x(t_f) < 0$, increment $N_{\\text{retrograde}}$.\n4. After processing all $N$ rays, compute the asymmetry metric $A = (N_{\\text{prograde}} - N_{\\text{retrograde}}) / N$.\n\nThis procedure is repeated for each of the five test cases provided. For the special cases of $\\Omega=0$ (no rotation) and $\\phi=\\pi/2$ (pole), the landing pattern is expected to be symmetric with respect to the east-west axis, resulting in an asymmetry of $A=0$. These cases serve as valuable sanity checks for the numerical implementation. For general latitudes, the interplay of all Coriolis components leads to a net deflection and a non-zero asymmetry metric.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Computes the azimuthal asymmetry metric for ejecta trajectories on a rotating body.\n    \"\"\"\n    # Define constants\n    h0 = 1.0  # m\n    g = 9.81  # m/s^2\n    u = 300.0  # m/s\n    alpha = np.pi / 4  # rad\n    N = 72  # number of rays\n\n    # Test suite: (Omega in rad/s, phi in rad)\n    test_cases = [\n        (0.0, 0.0),\n        (1.0e-4, 0.0),\n        (5.0e-4, np.pi / 4),\n        (1.0e-3, np.pi / 2),\n        (7.0e-4, -np.pi / 6),\n    ]\n\n    results = []\n\n    def ode_system(t, y, Omega, phi, g_val):\n        \"\"\"\n        Defines the system of ODEs for the ejecta motion.\n        y = [x, y, z, vx, vy, vz]\n        \"\"\"\n        _, _, _, vx, vy, vz = y\n        \n        sin_phi = np.sin(phi)\n        cos_phi = np.cos(phi)\n\n        ax = 2 * Omega * (vy * sin_phi - vz * cos_phi)\n        ay = -2 * Omega * vx * sin_phi\n        az = -g_val + 2 * Omega * vx * cos_phi\n\n        return np.array([vx, vy, vz, ax, ay, az])\n\n    def event_z_zero(t, y, Omega, phi, g_val):\n        \"\"\"\n        Event function to detect when z(t) = 0.\n        \"\"\"\n        return y[2]\n\n    event_z_zero.terminal = True\n    event_z_zero.direction = -1\n\n    # Pre-calculate common initial velocity components\n    u_sin_alpha = u * np.sin(alpha)\n    u_cos_alpha = u * np.cos(alpha)\n\n    # Estimate max time of flight for integration span\n    t_flight_approx = (u_sin_alpha + np.sqrt(u_sin_alpha**2 + 2 * g * h0)) / g\n    t_span = [0, 2 * t_flight_approx]  # Use a safe upper bound\n\n    # Generate azimuth angles for rays\n    psis = (2 * np.pi / N) * (np.arange(N) + 0.5)\n\n    for Omega, phi in test_cases:\n        prograde_count = 0\n        retrograde_count = 0\n\n        for psi in psis:\n            # Initial conditions for the current ray\n            vx0 = u_cos_alpha * np.cos(psi)\n            vy0 = u_cos_alpha * np.sin(psi)\n            vz0 = u_sin_alpha\n            y0 = np.array([0.0, 0.0, h0, vx0, vy0, vz0])\n            \n            # Solve the ODE system\n            sol = solve_ivp(\n                ode_system,\n                t_span,\n                y0,\n                args=(Omega, phi, g),\n                events=event_z_zero,\n                dense_output=True,\n                method='RK45'\n            )\n            \n            # Check if event was found and classify the ray\n            if sol.t_events[0].size > 0:\n                # sol.y_events[0] has shape (n, n_events), we take the first state at the first event time\n                x_final = sol.y_events[0][0, 0]\n                if x_final > 0:\n                    prograde_count += 1\n                elif x_final  0:\n                    retrograde_count += 1\n        \n        # Calculate the asymmetry metric for the current test case\n        asymmetry = (prograde_count - retrograde_count) / N\n        results.append(asymmetry)\n\n    # Format the output as specified\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}