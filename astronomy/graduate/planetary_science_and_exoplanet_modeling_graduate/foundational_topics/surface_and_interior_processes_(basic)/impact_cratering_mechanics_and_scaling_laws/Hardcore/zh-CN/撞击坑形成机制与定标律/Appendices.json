{
    "hands_on_practices": [
        {
            "introduction": "标度律是撞击坑研究的基石，它使我们能够根据撞击体的性质来预测撞击坑的大小。本练习将引导你运用量纲分析这一强大工具，从第一性原理出发推导这些定律。通过这个实践 ，你将掌握一项核心技能，即理解控制撞击过程的关键物理变量之间的关系，并为后续更复杂的分析奠定基础。",
            "id": "4164150",
            "problem": "考虑在一个岩石系外行星上，在重力主导、动量控制的情况下发生的撞击坑形成情景。两个质量和撞击速度分别为 $\\left(m_{1},U_{1}\\right)$ 和 $\\left(m_{2},U_{2}\\right)$ 的投射物，在相同的局部引力加速度 $g$ 下，撞击了同一个体积密度为 $\\rho$ 的均匀半空间目标。假设两次撞击产生相等的线性动量，即 $m_{1}U_{1}=m_{2}U_{2}$，但动能不同，因为 $E=\\frac{1}{2}mU^{2}$ 取决于 $U$。在动量主导的极限下，假设瞬时坑半径 $R_{t}$ 可以用以下形式的量纲一致的比例关系表示\n$$\nR_{t}\\propto \\left(mU\\right)^{\\alpha}\\,\\rho^{-\\beta}\\,g^{-\\gamma},\n$$\n其中 $\\alpha$、$\\beta$ 和 $\\gamma$ 是待通过量纲分析确定的实数指数，且两次撞击的目标属性 $\\rho$ 和 $g$ 是相同的。仅使用量纲一致性以及重力控制挖掘（强度效应可忽略）的前提，确定指数 $\\alpha$、$\\beta$ 和 $\\gamma$，然后计算两次撞击产生的瞬时坑半径之比 $R_{t,1}/R_{t,2}$。将最终答案表示为一个无量纲数。无需四舍五入。在整个推理过程中使用国际单位制（SI）。",
            "solution": "该问题被认为是有效的，因为其科学基础扎实、提法明确、客观，并包含足够的信息以通过量纲分析得出唯一解。\n\n第一步是确定给定瞬时坑半径 $R_t$ 的比例关系定律中的指数 $\\alpha$、$\\beta$ 和 $\\gamma$：\n$$\nR_t \\propto (mU)^\\alpha \\, \\rho^{-\\beta} \\, g^{-\\gamma}\n$$\n这通过量纲分析来完成。设 $k$ 为一个无量纲的比例常数。方程为：\n$$\nR_t = k (mU)^\\alpha \\, \\rho^{-\\beta} \\, g^{-\\gamma}\n$$\n涉及的基本量纲是质量（$M$）、长度（$L$）和时间（$T$）。我们在国际单位制（SI）中表示每个物理量的量纲：\n\\begin{itemize}\n    \\item 瞬时坑半径，$R_t$: $[R_t] = L$\n    \\item 撞击体动量，$mU$: $[mU] = M \\cdot L \\cdot T^{-1}$\n    \\item 目标密度，$\\rho$: $[\\rho] = M \\cdot L^{-3}$\n    \\item 引力加速度，$g$: $[g] = L \\cdot T^{-2}$\n\\end{itemize}\n为了使方程在量纲上保持一致，等式两边的量纲必须相等。\n$$\n[R_t] = [mU]^\\alpha [\\rho]^{-\\beta} [g]^{-\\gamma}\n$$\n代入每个量的量纲：\n$$\nL^1 M^0 T^0 = (M L T^{-1})^\\alpha (M L^{-3})^{-\\beta} (L T^{-2})^{-\\gamma}\n$$\n我们将指数分配给每个基本量纲：\n$$\nL^1 M^0 T^0 = (M^\\alpha L^\\alpha T^{-\\alpha}) (M^{-\\beta} L^{3\\beta}) (L^{-\\gamma} T^{2\\gamma})\n$$\n接下来，我们按基本量纲对各项进行分组：\n$$\nL^1 M^0 T^0 = M^{\\alpha - \\beta} L^{\\alpha + 3\\beta - \\gamma} T^{-\\alpha + 2\\gamma}\n$$\n将等式两边每个基本量纲（$M$、$L$、$T$）的指数相等，得到一个包含三个未知数（$\\alpha, \\beta, \\gamma$）的三元线性方程组：\n\\begin{enumerate}\n    \\item 对于质量（$M$）：$\\alpha - \\beta = 0$\n    \\item 对于长度（$L$）：$\\alpha + 3\\beta - \\gamma = 1$\n    \\item 对于时间（$T$）：$-\\alpha + 2\\gamma = 0$\n\\end{enumerate}\n我们解这个方程组。\n从方程（1），我们得到 $\\alpha = \\beta$。\n从方程（3），我们得到 $\\alpha = 2\\gamma$。这也意味着 $\\gamma = \\frac{\\alpha}{2}$。\n现在，我们将这些关系代入方程（2）：\n$$\n\\alpha + 3(\\alpha) - \\left(\\frac{\\alpha}{2}\\right) = 1\n$$\n$$\n4\\alpha - \\frac{\\alpha}{2} = 1\n$$\n为了解出 $\\alpha$，我们通分：\n$$\n\\frac{8\\alpha}{2} - \\frac{\\alpha}{2} = 1\n$$\n$$\n\\frac{7\\alpha}{2} = 1\n$$\n$$\n\\alpha = \\frac{2}{7}\n$$\n现在我们可以求出 $\\beta$ 和 $\\gamma$：\n$$\n\\beta = \\alpha = \\frac{2}{7}\n$$\n$$\n\\gamma = \\frac{\\alpha}{2} = \\frac{1}{2} \\left(\\frac{2}{7}\\right) = \\frac{1}{7}\n$$\n因此，指数为 $\\alpha = \\frac{2}{7}$，$\\beta = \\frac{2}{7}$ 和 $\\gamma = \\frac{1}{7}$。比例关系定律为：\n$$\nR_t \\propto (mU)^{2/7} \\, \\rho^{-2/7} \\, g^{-1/7}\n$$\n第二步是计算两次撞击的瞬时坑半径之比 $R_{t,1}/R_{t,2}$。设 $k$ 为比例常数。\n第一次撞击的半径为：\n$$\nR_{t,1} = k (m_1 U_1)^{2/7} \\rho^{-2/7} g^{-1/7}\n$$\n第二次撞击的半径为：\n$$\nR_{t,2} = k (m_2 U_2)^{2/7} \\rho^{-2/7} g^{-1/7}\n$$\n我们通过将 $R_{t,1}$ 的表达式除以 $R_{t,2}$ 的表达式来计算该比率：\n$$\n\\frac{R_{t,1}}{R_{t,2}} = \\frac{k (m_1 U_1)^{2/7} \\rho^{-2/7} g^{-1/7}}{k (m_2 U_2)^{2/7} \\rho^{-2/7} g^{-1/7}}\n$$\n常数 $k$ 以及目标属性 $\\rho$ 和 $g$ 对两次撞击都是相同的，因此可以消去：\n$$\n\\frac{R_{t,1}}{R_{t,2}} = \\frac{(m_1 U_1)^{2/7}}{(m_2 U_2)^{2/7}} = \\left(\\frac{m_1 U_1}{m_2 U_2}\\right)^{2/7}\n$$\n问题陈述两次撞击产生相等的线性动量，即 $m_1 U_1 = m_2 U_2$。因此，动量之比等于 $1$：\n$$\n\\frac{m_1 U_1}{m_2 U_2} = 1\n$$\n将此代入我们关于半径之比的表达式中：\n$$\n\\frac{R_{t,1}}{R_{t,2}} = (1)^{2/7} = 1\n$$\n瞬时坑半径之比为 $1$。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "在研究了撞击坑的形成机制后，我们将目光转向其可观测的后果，例如溅射物的分布模式。本练习  将引入数值方法来解决一个实际问题：旋转行星上的科里奥利力如何导致溅射毯出现不对称性。这个动手编程练习将展示如何运用计算工具来探索那些难以通过解析方法解决的复杂动力学过程。",
            "id": "4164131",
            "problem": "考虑一个旋转球体表面的点源撞击事件。使用局部切平面近似，其标准正交基向量为 $\\{\\hat{\\mathbf{e}}_E,\\hat{\\mathbf{e}}_N,\\hat{\\mathbf{e}}_U\\}$，分别代表东、北和上。设行星自转速率为恒定的 $\\Omega$（单位为弧度/秒），撞击点位于大地纬度 $\\phi$（单位为弧度）。假设存在一个大小为 $g$（单位为米/秒^2）的均匀、恒定的重力加速度，方向向下，即 $\\mathbf{g} = -g\\,\\hat{\\mathbf{e}}_U$。忽略大气阻力、地形、超出局部切平面近似的曲率，以及通过并入有效重力来处理的离心项。\n\n抛射物从局部表面上方 $h_0$ 的高度发射，初速度大小为 $u$（单位为米/秒），发射角为相对于局部水平面的 $\\alpha$（单位为弧度），方位角为 $\\psi$（单位为弧度），从东向北测量。初始速度为\n$$\n\\mathbf{v}(0) = u\\cos\\alpha\\,\\cos\\psi\\,\\hat{\\mathbf{e}}_E + u\\cos\\alpha\\,\\sin\\psi\\,\\hat{\\mathbf{e}}_N + u\\sin\\alpha\\,\\hat{\\mathbf{e}}_U.\n$$\n\n在该天体的旋转坐标系中，抛射物的运动遵循包含科里奥利加速度的 Newton 第二定律。角速度矢量在局部坐标系中分解为\n$$\n\\boldsymbol{\\Omega} = \\Omega\\cos\\phi\\,\\hat{\\mathbf{e}}_N + \\Omega\\sin\\phi\\,\\hat{\\mathbf{e}}_U,\n$$\n运动方程为\n$$\n\\frac{d\\mathbf{r}}{dt} = \\mathbf{v},\\quad\n\\frac{d\\mathbf{v}}{dt} = \\mathbf{g} - 2\\,\\boldsymbol{\\Omega}\\times\\mathbf{v}.\n$$\n\n定义落地时间 $t_f$ 为垂直位置返回表面（即 $z(t_f)=0$）的第一个 $t>0$ 时刻，其中 $\\mathbf{r}(t)=(x(t),y(t),z(t))$ 是在局部基下的坐标。定义切平面内的落地位移矢量为 $\\mathbf{d}=(x(t_f),y(t_f))$。如果 $x(t_f)>0$（东向半平面），则将每个抛射物射线分类为“顺行”(prograde)；如果 $x(t_f)<0$（西向半平面），则分类为“逆行”(retrograde)。$x(t_f)=0$ 的射线对两类均无贡献。\n\n定义方位不对称性度量\n$$\nA = \\frac{M_{\\text{prograde}} - M_{\\text{retrograde}}}{M_{\\text{total}}},\n$$\n其中 $M_{\\text{prograde}}$ 和 $M_{\\text{retrograde}}$ 是根据分类为每条射线平均分配的总沉积质量，$M_{\\text{total}}$ 是所有射线的总质量。假设每条射线的质量相等。\n\n你的任务是编写一个程序，该程序：\n- 对于一组抛射物射线，其方位角 $\\psi$ 均匀划分区间 $[0,2\\pi)$ 并在各子区间中点采样，即 $\\psi_k = \\frac{2\\pi}{N}\\left(k+\\frac{1}{2}\\right)$，其中 $k=0,1,\\dots,N-1$。对这组射线的上述方程进行数值积分。\n- 检测首次穿过表面的事件，以获得每条射线的 $\\mathbf{d}$。\n- 对测试套件中的每组参数计算不对称性度量 $A$。\n\n除非另有说明，所有测试均使用以下常量和输入：\n- 发射高度 $h_0=1\\,\\text{m}$。\n- 重力加速度 $g=9.81\\,\\text{m}\\,\\text{s}^{-2}$。\n- 发射速度大小 $u=300\\,\\text{m}\\,\\text{s}^{-1}$。\n- 发射角 $\\alpha=\\pi/4\\,\\text{rad}$。\n- 射线数量 $N=72$。\n\n角度必须以弧度为单位。所有输出必须是无单位的小数。对于数值积分，请确保在 $z=0$ 且 $t>0$ 处进行稳健的事件检测。使用与给定框架一致、科学上合理且自洽的假设。\n\n测试套件（每个案例是一个元组 $(\\Omega,\\phi)$，其中 $\\Omega$ 的单位是弧度/秒，$\\phi$ 的单位是弧度）：\n1. $(0.0,\\;0.0)$\n2. $(1.0\\times 10^{-4},\\;0.0)$\n3. $(5.0\\times 10^{-4},\\;\\pi/4)$\n4. $(1.0\\times 10^{-3},\\;\\pi/2)$\n5. $(7.0\\times 10^{-4},\\;-\\pi/6)$\n\n你的程序应产生单行输出，其中包含五个案例的不对称性值，四舍五入到六位小数，并以逗号分隔的列表形式用方括号括起来（例如，“[a1,a2,a3,a4,a5]”）。",
            "solution": "用户希望我解决一个关于旋转体上抛射物运动的物理问题。\n\n**问题验证**\n\n**第1步：提取给定信息**\n\n- **坐标系**：局部切平面，标准正交基为 $\\{\\hat{\\mathbf{e}}_E,\\hat{\\mathbf{e}}_N,\\hat{\\mathbf{e}}_U\\}$。\n- **行星参数**：恒定自转速率 $\\Omega$ (rad/s)，大地纬度 $\\phi$ (rad)。\n- **物理模型**：\n    - 重力加速度：$\\mathbf{g} = -g\\,\\hat{\\mathbf{e}}_U$，其中 $g=9.81\\,\\text{m}\\,\\text{s}^{-2}$。\n    - 运动方程：$\\frac{d\\mathbf{r}}{dt} = \\mathbf{v}$，$\\frac{d\\mathbf{v}}{dt} = \\mathbf{g} - 2\\,\\boldsymbol{\\Omega}\\times\\mathbf{v}$。\n    - 角速度矢量：$\\boldsymbol{\\Omega} = \\Omega\\cos\\phi\\,\\hat{\\mathbf{e}}_N + \\Omega\\sin\\phi\\,\\hat{\\mathbf{e}}_U$。\n    - 忽略的效应：大气阻力、地形、非局部曲率、离心项（并入 $\\mathbf{g}$）。\n- **抛射物初始条件**：\n    - 初始高度：$\\mathbf{r}(0) = (0, 0, h_0)$，其中 $h_0=1\\,\\text{m}$。\n    - 初始速度：$\\mathbf{v}(0) = u\\cos\\alpha\\,\\cos\\psi\\,\\hat{\\mathbf{e}}_E + u\\cos\\alpha\\,\\sin\\psi\\,\\hat{\\mathbf{e}}_N + u\\sin\\alpha\\,\\hat{\\mathbf{e}}_U$。\n    - 初速度大小：$u=300\\,\\text{m}\\,\\text{s}^{-1}$。\n    - 发射角：$\\alpha=\\pi/4\\,\\text{rad}$。\n- **任务定义**：\n    - 方位角采样：$\\psi_k = \\frac{2\\pi}{N}\\left(k+\\frac{1}{2}\\right)$，其中 $k=0,1,\\dots,N-1$，$N=72$。\n    - 落地时间 $t_f$：第一个 $t>0$ 且 $z(t_f)=0$ 的时刻。\n    - 落地位移矢量：$\\mathbf{d}=(x(t_f),y(t_f))$。\n    - 射线分类：“顺行”(prograde) 如果 $x(t_f)>0$，“逆行”(retrograde) 如果 $x(t_f)<0$。\n    - 不对称性度量：$A = \\frac{M_{\\text{prograde}} - M_{\\text{retrograde}}}{M_{\\text{total}}}$，假设每条射线质量相等，则简化为 $A = \\frac{N_{\\text{prograde}} - N_{\\text{retrograde}}}{N}$。\n- **测试套件**：\n    1. $(\\Omega,\\phi) = (0.0,\\;0.0)$\n    2. $(\\Omega,\\phi) = (1.0\\times 10^{-4},\\;0.0)$\n    3. $(\\Omega,\\phi) = (5.0\\times 10^{-4},\\;\\pi/4)$\n    4. $(\\Omega,\\phi) = (1.0\\times 10^{-3},\\;\\pi/2)$\n    5. $(\\Omega,\\phi) = (7.0\\times 10^{-4},\\;-\\pi/6)$\n\n**第2步：使用提取的信息进行验证**\n\n- **科学依据**：该问题是经典力学中的一个标准练习，具体涉及非惯性（旋转）参考系中抛体的动力学。包含重力和科里奥利力的运动方程是基本正确的，且表述无误。\n- **良态问题**：该问题被表述为一个常微分方程组（ODE）的初值问题。鉴于明确的初始条件和ODE的线性性质，每个抛射物射线都存在唯一且稳定的解。将这些解汇总为不对称性度量的方法也定义明确。\n- **客观性**：该问题使用精确的数学和物理术语进行陈述。所有量和目标都进行了定量定义，没有主观解释的余地。\n- **完整性和一致性**：所有必需的常量（$h_0, g, u, \\alpha, N$）、方程和测试参数都已提供。没有矛盾的约束或缺失的信息。物理单位是一致的。\n- **可行性**：参数值对于行星体是物理上现实的。该任务需要数值积分，这是一种标准且可行的计算方法。\n- **结构**：问题结构清晰，逻辑呈现合理。\n- **简易性**：虽然特殊情况（例如 $\\Omega=0$ 或 $\\phi=\\pi/2$）有更简单的解析或半解析解，可以作为检验，但一般情况需要对耦合系统进行数值积分，使得问题不平凡。\n\n**第3步：结论与行动**\n\n该问题具有科学合理性、良态性、客观性、完整性、一致性且不平凡。因此，该问题被视为**有效**。将提供一个解决方案。\n\n**基于原理的解决方案**\n\n该问题要求我们确定从旋转球体上某点发射的多个抛射粒子的落地位置，并对其进行分类以计算不对称性度量。运动受旋转坐标系中的牛顿第二定律支配，其中包括科里奥利伪力。\n\n首先，我们必须明确写出微分方程组。粒子在时间 $t$ 的状态由其位置矢量 $\\mathbf{r}(t) = x(t)\\,\\hat{\\mathbf{e}}_E + y(t)\\,\\hat{\\mathbf{e}}_N + z(t)\\,\\hat{\\mathbf{e}}_U$ 和速度矢量 $\\mathbf{v}(t) = v_x(t)\\,\\hat{\\mathbf{e}}_E + v_y(t)\\,\\hat{\\mathbf{e}}_N + v_z(t)\\,\\hat{\\mathbf{e}}_U$ 描述。运动方程由 $\\frac{d\\mathbf{r}}{dt} = \\mathbf{v}$ 和 $\\frac{d\\mathbf{v}}{dt} = \\mathbf{g} - 2\\,\\boldsymbol{\\Omega}\\times\\mathbf{v}$ 给出。\n\n科里奥利项 $\\boldsymbol{\\Omega}\\times\\mathbf{v}$ 计算如下：\n$$\n\\boldsymbol{\\Omega} \\times \\mathbf{v} = \\begin{vmatrix} \\hat{\\mathbf{e}}_E  \\hat{\\mathbf{e}}_N  \\hat{\\mathbf{e}}_U \\\\ 0  \\Omega\\cos\\phi  \\Omega\\sin\\phi \\\\ v_x  v_y  v_z \\end{vmatrix} = (\\Omega v_z \\cos\\phi - \\Omega v_y \\sin\\phi)\\,\\hat{\\mathbf{e}}_E + (\\Omega v_x \\sin\\phi)\\,\\hat{\\mathbf{e}}_N - (\\Omega v_x \\cos\\phi)\\,\\hat{\\mathbf{e}}_U\n$$\n加速度矢量 $\\mathbf{a} = \\frac{d\\mathbf{v}}{dt}$ 的分量为：\n$a_x = -2(\\Omega v_z \\cos\\phi - \\Omega v_y \\sin\\phi) = 2\\Omega(v_y \\sin\\phi - v_z \\cos\\phi)$\n$a_y = -2(\\Omega v_x \\sin\\phi)$\n$a_z = -g - 2(-\\Omega v_x \\cos\\phi) = -g + 2\\Omega v_x \\cos\\phi$\n\n这给了我们一个关于状态矢量 $\\mathbf{Y}(t) = [x, y, z, v_x, v_y, v_z]^T$ 的六个耦合的一阶线性常微分方程组：\n$$\n\\frac{d\\mathbf{Y}}{dt} =\n\\begin{pmatrix}\nv_x \\\\\nv_y \\\\\nv_z \\\\\n2\\Omega(v_y \\sin\\phi - v_z \\cos\\phi) \\\\\n-2\\Omega v_x \\sin\\phi \\\\\n-g + 2\\Omega v_x \\cos\\phi\n\\end{pmatrix}\n$$\n对于由 $k \\in \\{0, 1, ..., N-1\\}$ 索引的每条射线（$N=72$），其初始条件由其发射方位角 $\\psi_k = \\frac{2\\pi}{N}(k+\\frac{1}{2})$ 确定：\n$\\mathbf{Y}(0) = [0, 0, h_0, u\\cos\\alpha\\cos\\psi_k, u\\cos\\alpha\\sin\\psi_k, u\\sin\\alpha]^T$。\n常量为 $h_0=1\\,\\text{m}$，$u=300\\,\\text{m\\,s}^{-1}$，$\\alpha=\\pi/4\\,\\text{rad}$ 和 $g=9.81\\,\\text{m\\,s}^{-2}$。\n\n在一般情况下（任意 $\\Omega, \\phi$），该系统没有简单的闭式解。因此，我们必须采用数值积分。`scipy.integrate.solve_ivp` 函数是完成此任务的合适工具。它是一个强大的ODE求解器，可以处理此类系统。\n\n问题的关键部分是找到落地时间 $t_f$，定义为粒子高度 $z(t)$ 返回零的第一个 $t>0$ 时刻。`solve_ivp` 具有内置的事件检测机制。我们定义一个事件函数来跟踪 $z(t)$ 的值（状态矢量的第三个分量 $Y[2]$）。我们将此事件配置为“终止”（即停止积分），并且仅当函数 $z(t)$ 向负方向穿过零时（即粒子从上方落地）触发。\n\n对于每个测试案例 $(\\Omega, \\phi)$ 的总体算法如下：\n1. 初始化顺行计数 $N_{\\text{prograde}}=0$ 和逆行计数 $N_{\\text{retrograde}}=0$。\n2. 生成 $N=72$ 个均匀间隔的发射方位角 $\\psi_k$。\n3. 对每个 $\\psi_k$：\n    a. 构建初始状态矢量 $\\mathbf{Y}(0)$。\n    b. 从 $t=0$ 开始对ODE系统进行数值积分，直到检测到事件 $z(t)=0$。必须提供足够大的时间跨度以确保事件发生。\n    c. 从积分结果中，提取事件时间 $t_f$ 时的状态矢量。东向的落地位置是 $x(t_f)$。\n    d. 对射线进行分类：如果 $x(t_f) > 0$，则 $N_{\\text{prograde}}$ 增加1；如果 $x(t_f) < 0$，则 $N_{\\text{retrograde}}$ 增加1。\n4. 处理完所有 $N$ 条射线后，计算不对称性度量 $A = (N_{\\text{prograde}} - N_{\\text{retrograde}}) / N$。\n\n对所提供的五个测试案例中的每一个重复此过程。对于 $\\Omega=0$（无旋转）和 $\\phi=\\pi/2$（极点）的特殊情况，预计落地模式相对于东西轴是对称的，导致不对称性为 $A=0$。这些情况可作为数值实现的重要健全性检查。对于一般纬度，所有科里奥利分量的相互作用导致净偏转和非零的不对称性度量。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Computes the azimuthal asymmetry metric for ejecta trajectories on a rotating body.\n    \"\"\"\n    # Define constants\n    h0 = 1.0  # m\n    g = 9.81  # m/s^2\n    u = 300.0  # m/s\n    alpha = np.pi / 4  # rad\n    N = 72  # number of rays\n\n    # Test suite: (Omega in rad/s, phi in rad)\n    test_cases = [\n        (0.0, 0.0),\n        (1.0e-4, 0.0),\n        (5.0e-4, np.pi / 4),\n        (1.0e-3, np.pi / 2),\n        (7.0e-4, -np.pi / 6),\n    ]\n\n    results = []\n\n    def ode_system(t, y, Omega, phi, g_val):\n        \"\"\"\n        Defines the system of ODEs for the ejecta motion.\n        y = [x, y, z, vx, vy, vz]\n        \"\"\"\n        _, _, _, vx, vy, vz = y\n        \n        sin_phi = np.sin(phi)\n        cos_phi = np.cos(phi)\n\n        ax = 2 * Omega * (vy * sin_phi - vz * cos_phi)\n        ay = -2 * Omega * vx * sin_phi\n        az = -g_val + 2 * Omega * vx * cos_phi\n\n        return np.array([vx, vy, vz, ax, ay, az])\n\n    def event_z_zero(t, y, Omega, phi, g_val):\n        \"\"\"\n        Event function to detect when z(t) = 0.\n        \"\"\"\n        return y[2]\n\n    event_z_zero.terminal = True\n    event_z_zero.direction = -1\n\n    # Pre-calculate common initial velocity components\n    u_sin_alpha = u * np.sin(alpha)\n    u_cos_alpha = u * np.cos(alpha)\n\n    # Estimate max time of flight for integration span\n    t_flight_approx = (u_sin_alpha + np.sqrt(u_sin_alpha**2 + 2 * g * h0)) / g\n    t_span = [0, 2 * t_flight_approx]  # Use a safe upper bound\n\n    # Generate azimuth angles for rays\n    psis = (2 * np.pi / N) * (np.arange(N) + 0.5)\n\n    for Omega, phi in test_cases:\n        prograde_count = 0\n        retrograde_count = 0\n\n        for psi in psis:\n            # Initial conditions for the current ray\n            vx0 = u_cos_alpha * np.cos(psi)\n            vy0 = u_cos_alpha * np.sin(psi)\n            vz0 = u_sin_alpha\n            y0 = np.array([0.0, 0.0, h0, vx0, vy0, vz0])\n            \n            # Solve the ODE system\n            sol = solve_ivp(\n                ode_system,\n                t_span,\n                y0,\n                args=(Omega, phi, g),\n                events=event_z_zero,\n                dense_output=True,\n                method='RK45'\n            )\n            \n            # Check if event was found and classify the ray\n            if sol.t_events[0].size > 0:\n                # sol.y_events[0] has shape (n, n_events), we take the first state at the first event time\n                x_final = sol.y_events[0][0, 0]\n                if x_final > 0:\n                    prograde_count += 1\n                elif x_final < 0:\n                    retrograde_count += 1\n        \n        # Calculate the asymmetry metric for the current test case\n        asymmetry = (prograde_count - retrograde_count) / N\n        results.append(asymmetry)\n\n    # Format the output as specified\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}