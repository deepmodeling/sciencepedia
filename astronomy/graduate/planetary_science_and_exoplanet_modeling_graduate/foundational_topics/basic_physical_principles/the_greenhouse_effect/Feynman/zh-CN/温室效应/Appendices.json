{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在建立一个关于温室效应的直观物理图像。通过构建一个简化的“单层大气”模型，我们可以运用基本的能量平衡原理，量化一个理想化的大气层如何提升行星的表面温度。这个思想实验虽然简单，但它揭示了温室效应的核心机制，并为我们理解更复杂的模型提供了概念基础。",
            "id": "1887175",
            "problem": "为了理解温室效应的基本物理原理，一位行星科学家为一颗类地系外行星建立了一个简化的“单层大气”模型。该模型考虑了两种情景。\n\n在**模型A**中，该行星没有大气层。它具有全球统一的反照率 $A$（入射辐射被反射回太空的比例），并且处于热平衡状态。其表面表现为理想黑体。\n\n在**模型B**中，同一颗行星被一层薄而均匀的大气层所覆盖。这个理想化的大气层对入射的高频恒星辐射完全透明，但对行星表面发出的低频热辐射则表现为理想黑体。大气层本身达到一个稳定、均匀的温度，并作为黑体向上辐射到太空，同时也向下辐射回地表。下方的行星表面仍然是理想黑体。\n\n假设行星在两种模型中都处于热平衡状态。该系统由以下常数表征：\n- 行星轨道处的恒星常数，$S_0 = 1361 \\text{ W/m}^2$。\n- 行星反照率，$A = 0.300$。\n- 斯特藩-玻尔兹曼常数，$\\sigma = 5.670 \\times 10^{-8} \\text{ W m}^{-2} \\text{K}^{-4}$。\n\n计算从模型A变为模型B时，行星表面温度的增加量。请用开尔文表示答案，并保留三位有效数字。",
            "solution": "我们使用全球辐射平衡和斯特藩-玻尔兹曼定律。一个半径为 $R$ 的球体截获的恒星功率为 $\\pi R^{2} S_{0}$，其表面积为 $4 \\pi R^{2}$，因此全球平均吸收的短波通量为 $(1-A) S_{0} / 4$。\n\n模型A（无大气层）：表面是一个处于平衡状态的黑体，因此吸收的短波辐射等于发出的长波辐射：\n$$\n\\sigma T_{A}^{4}=\\frac{(1-A) S_{0}}{4}\n$$\n因此，\n$$\nT_{A}=\\left(\\frac{(1-A) S_{0}}{4 \\sigma}\\right)^{1/4}.\n$$\n\n模型B（单层温室）：设 $T_{s}$ 为表面温度，$T_{a}$ 为大气温度。大气对短波透明，在长波范围内是理想黑体。它吸收所有来自表面的长波辐射 $\\sigma T_{s}^{4}$，并向上和向下分别发出 $\\sigma T_{a}^{4}$ 的辐射。\n\n- 大气能量平衡（仅考虑长波）：\n$$\n\\sigma T_{s}^{4}=2 \\sigma T_{a}^{4} \\;\\;\\Rightarrow\\;\\; T_{s}^{4}=2 T_{a}^{4}.\n$$\n- 大气层顶平衡：向太空发出的长波辐射等于吸收的短波辐射，\n$$\n\\sigma T_{a}^{4}=\\frac{(1-A) S_{0}}{4} \\;\\;\\Rightarrow\\;\\; T_{a}^{4}=\\frac{(1-A) S_{0}}{4 \\sigma}.\n$$\n结合以上各式，\n$$\nT_{s}^{4}=2\\,\\frac{(1-A) S_{0}}{4 \\sigma}=\\frac{(1-A) S_{0}}{2 \\sigma}\n\\;\\;\\Rightarrow\\;\\;\nT_{B}=\\left(\\frac{(1-A) S_{0}}{2 \\sigma}\\right)^{1/4}=2^{1/4} T_{A}.\n$$\n因此，从模型A到模型B的表面增温为\n$$\n\\Delta T=T_{B}-T_{A}=\\left(2^{1/4}-1\\right) T_{A}.\n$$\n\n现在使用 $S_{0}=1361$, $A=0.300$ 和 $\\sigma=5.670 \\times 10^{-8}$（全程使用国际单位制单位）进行数值计算。\n首先计算\n$$\n\\frac{(1-A) S_{0}}{4}=\\frac{0.700 \\times 1361}{4}=238.175,\n$$\n所以\n$$\nT_{A}=\\left(\\frac{238.175}{5.670 \\times 10^{-8}}\\right)^{1/4}\n=\\left(4.2008172 \\times 10^{9}\\right)^{1/4}\\approx 254.585 \\text{ K}.\n$$\n接着\n$$\n\\Delta T=\\left(2^{1/4}-1\\right) T_{A}\\approx 0.189207 \\times 254.585 \\approx 48.169 \\text{ K}.\n$$\n保留三位有效数字：\n$$\n\\Delta T \\approx 48.2 \\text{ K}.\n$$",
            "answer": "$$\\boxed{48.2}$$"
        },
        {
            "introduction": "在理解了温室效应的基本能量平衡之后，下一步是更精确地描述大气如何与辐射相互作用。本练习引入了“光学厚度”这一关键概念，它是衡量大气不透明度的物理量。你将学习如何从基本的大气参数（如压力和气体浓度）出发，推导出二氧化碳吸收带中心的光学厚度，并借此判断吸收线的饱和状态。",
            "id": "4050473",
            "problem": "考虑一个干燥的、平面平行的地球大气层，其垂直气压廓线为 $p(z) = p_{s} \\exp\\!\\left(-\\frac{z}{H}\\right)$，其中地表气压 $p_{s} = 1.013 \\times 10^{5}\\,\\mathrm{Pa}$，标高 $H = 7.5\\,\\mathrm{km}$。假设重力加速度为常数 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$。二氧化碳在整个气柱中具有均匀的摩尔分数 $x_{\\mathrm{CO_{2}}} = 4.15 \\times 10^{-4}$。干燥空气的平均分子质量为 $\\mu_{\\mathrm{air}} = 28.97\\,\\mathrm{g\\,mol^{-1}}$，二氧化碳的分子质量为 $\\mu_{\\mathrm{CO_{2}}} = 44.01\\,\\mathrm{g\\,mol^{-1}}$。在 $15\\,\\mathrm{\\mu m}$ 谱带线中心，将二氧化碳的单色质量吸收系数视为不随高度变化且等于 $\\kappa_{0} = 1.0 \\times 10^{3}\\,\\mathrm{m^{2}\\,kg^{-1}}$（定义为每单位质量的二氧化碳）。仅使用适用于辐射传输和大气动力学的基本定义和定律，推导从地表到大气层顶部的垂直积分线中心光学厚度的表达式，并对其进行数值计算。然后，仅根据计算出的线中心光学厚度的量级，判断线芯是否饱和。将线中心柱光学厚度的最终数值答案四舍五入到三位有效数字。在最终答案中，将光学厚度表示为无量纲数。",
            "solution": "问题是计算模型大气中二氧化碳的垂直积分线中心光学厚度，并判断该谱线是否饱和。\n\n首先，对问题陈述进行验证。\n\n**步骤 1：提取给定条件**\n-   垂直气压廓线：$p(z) = p_{s} \\exp\\!\\left(-\\frac{z}{H}\\right)$\n-   地表气压：$p_{s} = 1.013 \\times 10^{5}\\,\\mathrm{Pa}$\n-   标高：$H = 7.5\\,\\mathrm{km}$\n-   重力加速度：$g = 9.81\\,\\mathrm{m\\,s^{-2}}$\n-   二氧化碳摩尔分数：$x_{\\mathrm{CO_{2}}} = 4.15 \\times 10^{-4}$\n-   干燥空气的平均分子质量：$\\mu_{\\mathrm{air}} = 28.97\\,\\mathrm{g\\,mol^{-1}}$\n-   二氧化碳的分子质量：$\\mu_{\\mathrm{CO_{2}}} = 44.01\\,\\mathrm{g\\,mol^{-1}}$\n-   $\\text{CO}_2$ 的单色质量吸收系数：$\\kappa_{0} = 1.0 \\times 10^{3}\\,\\mathrm{m^{2}\\,kg^{-1}}$\n\n**步骤 2：使用提取的给定条件进行验证**\n该问题具有科学依据，运用了大气物理学、辐射传输和化学的基本原理。给定值对于地球大气是符合实际的（例如，地表气压约等于 $1$ atm， $415$ ppm 的 $\\text{CO}_2$ 摩尔分数是当前值，标高对应于物理上合理的大气温度）。该问题是适定的，提供了计算一个唯一的无量纲量所需的所有信息。语言客观、精确。诸如质量吸收系数为常数和摩尔分数均匀等假设，是入门级大气物理学问题中的标准简化。所有条件在内部都是一致的。例如，指数型气压廓线是等温大气中静力平衡和理想气体定律的直接结果，并且由此廓线推导出的气柱质量与单独使用静力平衡得到的结果一致。因此，该问题被认为是有效的。\n\n**步骤 3：求解推导**\n从地表（$z=0$）到大气层顶部（$z \\to \\infty$）的垂直光学厚度 $\\tau_0$ 定义为体积吸收系数 $\\alpha_0(z)$ 沿垂直路径的积分：\n$$\n\\tau_0 = \\int_0^{\\infty} \\alpha_0(z) \\, dz\n$$\n体积吸收系数是吸收气体质量吸收系数（$\\kappa_0$）与该气体密度（$\\rho_{\\mathrm{CO_2}}(z)$）的乘积。问题陈述 $\\kappa_0$ 不随高度变化。\n$$\n\\alpha_0(z) = \\kappa_0 \\rho_{\\mathrm{CO_2}}(z)\n$$\n将其代入光学厚度的积分中得到：\n$$\n\\tau_0 = \\int_0^{\\infty} \\kappa_0 \\rho_{\\mathrm{CO_2}}(z) \\, dz = \\kappa_0 \\int_0^{\\infty} \\rho_{\\mathrm{CO_2}}(z) \\, dz\n$$\n积分 $\\int_0^{\\infty} \\rho_{\\mathrm{CO_2}}(z) \\, dz$ 表示单位面积上二氧化碳的总柱质量，我们可以将其表示为 $M_{\\mathrm{CO_2, col}}$。\n\n为了求得 $M_{\\mathrm{CO_2, col}}$，我们首先将二氧化碳的密度 $\\rho_{\\mathrm{CO_2}}(z)$ 与空气的总密度 $\\rho_{\\mathrm{air}}(z)$ 联系起来。这通过 $\\text{CO}_2$ 的质量分数 $m_{\\mathrm{CO_2}}$ 来实现，由于给定的摩尔分数 $x_{\\mathrm{CO_2}}$ 是均匀的，因此质量分数也是常数。\n$$\n\\rho_{\\mathrm{CO_2}}(z) = m_{\\mathrm{CO_2}} \\, \\rho_{\\mathrm{air}}(z)\n$$\n质量分数通过各组分的分子质量与摩尔分数相关联。对于像 $\\text{CO}_2$ 这样的痕量气体，混合物的平均分子质量非常接近干燥空气的平均分子质量 $\\mu_{\\mathrm{air}}$。我们可以将质量分数近似为：\n$$\nm_{\\mathrm{CO_2}} = \\frac{\\text{mass of } \\mathrm{CO_2}}{\\text{total mass}} \\approx \\frac{x_{\\mathrm{CO_{2}}} \\mu_{\\mathrm{CO_{2}}}}{\\mu_{\\mathrm{air}}}\n$$\n这个近似非常精确，因为 $x_{\\mathrm{CO_{2}}} \\ll 1$。将此代入 $\\tau_0$ 的表达式中：\n$$\n\\tau_0 = \\kappa_0 \\int_0^{\\infty} \\left( x_{\\mathrm{CO_{2}}} \\frac{\\mu_{\\mathrm{CO_{2}}}}{\\mu_{\\mathrm{air}}} \\right) \\rho_{\\mathrm{air}}(z) \\, dz\n$$\n由于 $x_{\\mathrm{CO_{2}}}$、$\\mu_{\\mathrm{CO_{2}}}$ 和 $\\mu_{\\mathrm{air}}$ 是常数，它们可以移到积分符号外：\n$$\n\\tau_0 = \\kappa_0 x_{\\mathrm{CO_{2}}} \\frac{\\mu_{\\mathrm{CO_{2}}}}{\\mu_{\\mathrm{air}}} \\int_0^{\\infty} \\rho_{\\mathrm{air}}(z) \\, dz\n$$\n剩下的积分 $\\int_0^{\\infty} \\rho_{\\mathrm{air}}(z) \\, dz$ 是空气的总柱质量 $M_{\\mathrm{air, col}}$。这个量可以直接用地表气压 $p_s$ 和静力平衡方程来确定，静力平衡方程指出，气压随高度的变化是由上方空气的重量引起的：\n$$\n\\frac{dp}{dz} = - \\rho_{\\mathrm{air}}(z) g\n$$\n从地表（$z=0$, $p=p_s$）到大气层顶部（$z \\to \\infty$, $p \\to 0$）重新整理并积分：\n$$\n\\int_{p_s}^{0} dp = \\int_0^{\\infty} -g \\rho_{\\mathrm{air}}(z) \\, dz\n$$\n$$\n0 - p_s = -g \\int_0^{\\infty} \\rho_{\\mathrm{air}}(z) \\, dz\n$$\n$$\nM_{\\mathrm{air, col}} = \\int_0^{\\infty} \\rho_{\\mathrm{air}}(z) \\, dz = \\frac{p_s}{g}\n$$\n这个基本结果使我们能够仅依靠地表气压和重力来计算空气的总柱质量，而无需知道具体的密度或温度廓线。有关指数型气压廓线和标高的信息与此一致，但对于这一步来说并非绝对必要。\n\n将此结果代回 $\\tau_0$ 的表达式中，我们得到线中心光学厚度的最终解析表达式：\n$$\n\\tau_0 = \\kappa_0 x_{\\mathrm{CO_{2}}} \\frac{\\mu_{\\mathrm{CO_{2}}}}{\\mu_{\\mathrm{air}}} \\frac{p_s}{g}\n$$\n\n现在，我们对此表达式进行数值计算。所有值都必须使用国际单位制（SI）单位。\n- $\\kappa_0 = 1.0 \\times 10^{3}\\,\\mathrm{m^{2}\\,kg^{-1}}$\n- $x_{\\mathrm{CO_{2}}} = 4.15 \\times 10^{-4}$\n- $\\mu_{\\mathrm{CO_{2}}} = 44.01\\,\\mathrm{g\\,mol^{-1}} = 0.04401\\,\\mathrm{kg\\,mol^{-1}}$\n- $\\mu_{\\mathrm{air}} = 28.97\\,\\mathrm{g\\,mol^{-1}} = 0.02897\\,\\mathrm{kg\\,mol^{-1}}$\n- $p_s = 1.013 \\times 10^5\\,\\mathrm{Pa} = 1.013 \\times 10^5\\,\\mathrm{kg\\,m^{-1}\\,s^{-2}}$\n- $g = 9.81\\,\\mathrm{m\\,s^{-2}}$\n\n$$\n\\tau_0 = (1.0 \\times 10^{3}) \\times (4.15 \\times 10^{-4}) \\times \\frac{0.04401}{0.02897} \\times \\frac{1.013 \\times 10^5}{9.81}\n$$\n计算各项：\n$$\n\\frac{\\mu_{\\mathrm{CO_{2}}}}{\\mu_{\\mathrm{air}}} = \\frac{0.04401}{0.02897} \\approx 1.51916\n$$\n$$\n\\frac{p_s}{g} = \\frac{1.013 \\times 10^5}{9.81} \\approx 10326.198\\,\\mathrm{kg\\,m^{-2}}\n$$\n$$\n\\tau_0 = (1.0 \\times 10^{3}) \\times (4.15 \\times 10^{-4}) \\times (1.51916) \\times (10326.198)\n$$\n$$\n\\tau_0 \\approx 6509.43\n$$\n四舍五入到三位有效数字，线中心柱光学厚度为 $6.51 \\times 10^3$。\n\n问题的最后一部分是判断线芯是否饱和。如果一条吸收线的光学厚度显著大于 $1$，则认为它是饱和的，或称光学厚的。在这种情况下，$\\tau_0 \\approx 6.51 \\times 10^3 \\gg 1$。光学厚度的量级非常大。这表明，从低层大气发出的线中心频率的辐射在到达大气层顶部之前很久就几乎被完全吸收了。因此，线芯是绝对饱和的。",
            "answer": "$$\n\\boxed{6.51 \\times 10^{3}}\n$$"
        },
        {
            "introduction": "真实大气的辐射吸收在不同波长上表现出巨大差异，这种“非灰体”特性是气候建模中的一个核心挑战。本练习通过对比两种辐射传输模型——简化的“灰体近似”模型和更精确的“相关k分布”模型——来探讨这一问题。通过计算两种方法在估算逸出长波辐射（OLR）时的差异，你将深刻理解为何精确的光谱计算对于准确预测气候至关重要。",
            "id": "4182445",
            "problem": "您的任务是实现两种辐射传输模型，以计算潮湿大气的大气层顶出射长波辐射 (OLR)，然后量化与简化的相关 k 分布处理方法相比，灰体近似所引入的误差。温室效应将由热红外波段的水汽吸收来表示。计算必须以有物理基础的量和定律来表达，并遵循以下规范。\n\n从热红外辐射传输的平面平行、一维 Schwarzschild 方程和 Beer-Lambert 定律开始。令 $F_{\\uparrow}(\\nu, 0)$ 表示大气层顶波数为 $\\nu$ 的向上光谱通量。对于一个温度为 $T_{\\mathrm{atm}}$ 的等温大气层，其下方是温度为 $T_{\\mathrm{sfc}}$ 的表面，使用扩散率近似并设扩散因子 $D$ 为常数，大气层顶的向上光谱通量可近似为\n$$\nF_{\\uparrow}(\\nu, 0) \\approx \\pi B_{\\nu}(T_{\\mathrm{atm}})\\left(1 - e^{-D\\tau_{\\nu}}\\right) + \\pi B_{\\nu}(T_{\\mathrm{sfc}})e^{-D\\tau_{\\nu}},\n$$\n其中 $B_{\\nu}(T)$ 是 Planck 函数，$\\tau_{\\nu}$ 是从地表到太空的光谱光学厚度，而 $D$ 是一个为近似角度积分而选择的常数。在半球平均（扩散率）近似中，使用 $D = 1.66$。由于半球通量已通过扩散率近似对角度进行了积分，因此不需要角度单位。\n\n为避免对 $B_{\\nu}(T)$ 进行显式光谱积分，您应将长波光谱划分为两个宽波段，在感兴趣的温度下具有固定的分数 Planck 权重，并通过用 Stefan-Boltzmann 定律和分数权重替换 Planck 函数的积分来近似波段积分通量。将两个波段及其 Planck 权重分数定义如下：\n- 水汽窗区波段（约 $8$–$12\\,\\mu\\mathrm{m}$），分数为 $f_{\\mathrm{win}} = 0.3$。\n- 水汽强吸收波段（约 $5$–$8\\,\\mu\\mathrm{m}$ 加 $12$–$20\\,\\mu\\mathrm{m}$），分数为 $f_{\\mathrm{str}} = 0.7$。\n\n采用 Stefan-Boltzmann 常数 $\\sigma = 5.670374419\\times 10^{-8}\\,\\mathrm{W\\,m^{-2}\\,K^{-4}}$。那么，温度为 $T$ 的黑体的总长波通量为 $\\sigma T^{4}$，波段积分通量近似为分数权重乘以 $\\sigma T^{4}$。\n\n实现两种水汽吸收模型：\n1. 灰体近似：使用单一的、Planck 加权的平均吸收系数 $k_{\\mathrm{gray}}$ 来代表整个长波光谱。单色光学厚度被灰体光学厚度 $\\tau = k_{\\mathrm{gray}}\\,u$ 所取代，其中 $u$ 是垂直积分的水汽柱质量，单位为 $\\mathrm{kg\\,m^{-2}}$。灰体近似下的 OLR 为\n$$\nF_{\\mathrm{gray}} = \\sigma T_{\\mathrm{atm}}^{4}\\left(1 - e^{-D\\tau}\\right) + \\sigma T_{\\mathrm{sfc}}^{4}e^{-D\\tau}.\n$$\n\n2. 相关 k 分布近似：每个波段由吸收系数 $k(g)$ 的累积分布表示，在对应于 $g\\in[0,1]$ 等分区的四个正交点上离散化，权重为 $w_{j} = 0.25$（对于 $j\\in\\{1,2,3,4\\}$）。每个正交点的光学厚度为 $\\tau_{i,j} = k_{i,j}\\,u$，其中 $i$ 为波段，$j$ 为正交点。波段积分的 OLR 则是跨波段和正交点的加权和：\n$$\nF_{\\mathrm{ck}} = \\sum_{i \\in \\{\\mathrm{win}, \\mathrm{str}\\}} f_{i} \\sum_{j=1}^{4} w_{j}\\left[\\sigma T_{\\mathrm{atm}}^{4}\\left(1 - e^{-D\\tau_{i,j}}\\right) + \\sigma T_{\\mathrm{sfc}}^{4}e^{-D\\tau_{i,j}}\\right].\n$$\n\n使用以下预先制表的水汽相关 k 分布系数 $k_{i,j}$（单位为 $\\mathrm{m^{2}\\,kg^{-1}}$），这些系数旨在代表（似乎合理的）潮湿类地行星条件：\n- 窗区波段 $k_{\\mathrm{win},j}$: $\\{1\\times 10^{-4},\\,5\\times 10^{-4},\\,2\\times 10^{-3},\\,1\\times 10^{-2}\\}\\,\\mathrm{m^{2}\\,kg^{-1}}$。\n- 强吸收波段 $k_{\\mathrm{str},j}$: $\\{5\\times 10^{-2},\\,2\\times 10^{-1},\\,1,\\,5\\}\\,\\mathrm{m^{2}\\,kg^{-1}}$。\n\n将灰体吸收系数 $k_{\\mathrm{gray}}$ 定义为在波段和正交点上的 Planck 加权平均值：\n$$\nk_{\\mathrm{gray}} = \\sum_{i \\in \\{\\mathrm{win}, \\mathrm{str}\\}} f_{i} \\sum_{j=1}^{4} w_{j}\\,k_{i,j}.\n$$\n\n将带符号的 OLR 误差定义为\n$$\n\\Delta F = F_{\\mathrm{gray}} - F_{\\mathrm{ck}},\n$$\n单位为 $\\mathrm{W\\,m^{-2}}$。\n\n实现一个程序，对于每个测试用例，使用上述模型和参数计算 $\\Delta F$。所有温度以 $\\mathrm{K}$ 表示，水汽柱 $u$ 以 $\\mathrm{kg\\,m^{-2}}$ 表示，OLR 以 $\\mathrm{W\\,m^{-2}}$ 表示。您的程序必须将所有测试用例的 $\\Delta F$ 值以单行、逗号分隔的 Python 列表形式输出，每个元素都是一个单位为 $\\mathrm{W\\,m^{-2}}$ 的浮点数。\n\n测试套件（每个测试用例是一个三元组 $(T_{\\mathrm{sfc}}, T_{\\mathrm{atm}}, u)$）：\n- 用例 1（潮湿类地条件）：$(300\\,\\mathrm{K},\\,270\\,\\mathrm{K},\\,30\\,\\mathrm{kg\\,m^{-2}})$。\n- 用例 2（干燥大气）：$(290\\,\\mathrm{K},\\,260\\,\\mathrm{K},\\,2\\,\\mathrm{kg\\,m^{-2}})$。\n- 用例 3（非常潮湿、炎热的系外行星）：$(340\\,\\mathrm{K},\\,320\\,\\mathrm{K},\\,200\\,\\mathrm{kg\\,m^{-2}})$。\n- 用例 4（寒冷、潮湿）：$(250\\,\\mathrm{K},\\,230\\,\\mathrm{K},\\,30\\,\\mathrm{kg\\,m^{-2}})$。\n- 用例 5（光学薄极限）：$(300\\,\\mathrm{K},\\,270\\,\\mathrm{K},\\,0\\,\\mathrm{kg\\,m^{-2}})$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$\\left[\\text{result1},\\text{result2},\\text{result3}\\right]$），每个元素的单位为 $\\mathrm{W\\,m^{-2}}$。",
            "solution": "已对用户提供的问题陈述进行分析和验证。\n\n### 步骤1：提取给定条件\n- **Schwarzschild 方程近似**：对于温度为 $T_{\\mathrm{atm}}$ 的等温大气层及其下方温度为 $T_{\\mathrm{sfc}}$ 的表面，大气层顶的向上光谱通量 $F_{\\uparrow}(\\nu, 0)$ 由下式给出：\n$$\nF_{\\uparrow}(\\nu, 0) \\approx \\pi B_{\\nu}(T_{\\mathrm{atm}})\\left(1 - e^{-D\\tau_{\\nu}}\\right) + \\pi B_{\\nu}(T_{\\mathrm{sfc}})e^{-D\\tau_{\\nu}}\n$$\n其中 $B_{\\nu}(T)$ 是 Planck 函数，$\\tau_{\\nu}$ 是光谱光学厚度，$D$ 是扩散因子。\n- **扩散因子**：$D = 1.66$。\n- **Stefan-Boltzmann 常数**：$\\sigma = 5.670374419\\times 10^{-8}\\,\\mathrm{W\\,m^{-2}\\,K^{-4}}$。\n- **波段模型**：长波光谱被划分为两个具有分数 Planck 权重的波段：\n  - 窗区波段：$f_{\\mathrm{win}} = 0.3$。\n  - 强吸收波段：$f_{\\mathrm{str}} = 0.7$。\n- **灰体近似模型**：出射长波辐射 (OLR) 由下式给出：\n$$\nF_{\\mathrm{gray}} = \\sigma T_{\\mathrm{atm}}^{4}\\left(1 - e^{-D\\tau}\\right) + \\sigma T_{\\mathrm{sfc}}^{4}e^{-D\\tau}\n$$\n其中灰体光学厚度为 $\\tau = k_{\\mathrm{gray}}\\,u$，$u$ 是单位为 $\\mathrm{kg\\,m^{-2}}$ 的水汽柱质量。\n- **相关 k 分布近似模型**：OLR 是跨波段和正交点的加权和：\n$$\nF_{\\mathrm{ck}} = \\sum_{i \\in \\{\\mathrm{win}, \\mathrm{str}\\}} f_{i} \\sum_{j=1}^{4} w_{j}\\left[\\sigma T_{\\mathrm{atm}}^{4}\\left(1 - e^{-D\\tau_{i,j}}\\right) + \\sigma T_{\\mathrm{sfc}}^{4}e^{-D\\tau_{i,j}}\\right]\n$$\n其中正交权重 $w_{j} = 0.25$（对于 $j \\in \\{1,2,3,4\\}$），光学厚度为 $\\tau_{i,j} = k_{i,j}\\,u$。\n- **相关 k 分布系数（$k_{i,j}$，单位为 $\\mathrm{m^{2}\\,kg^{-1}}$）**：\n  - 窗区波段 ($k_{\\mathrm{win},j}$): $\\{1\\times 10^{-4},\\,5\\times 10^{-4},\\,2\\times 10^{-3},\\,1\\times 10^{-2}\\}$。\n  - 强吸收波段 ($k_{\\mathrm{str},j}$): $\\{5\\times 10^{-2},\\,2\\times 10^{-1},\\,1,\\,5\\}$。\n- **灰体吸收系数定义**：\n$$\nk_{\\mathrm{gray}} = \\sum_{i \\in \\{\\mathrm{win}, \\mathrm{str}\\}} f_{i} \\sum_{j=1}^{4} w_{j}\\,k_{i,j}\n$$\n- **误差定义**：带符号的 OLR 误差为 $\\Delta F = F_{\\mathrm{gray}} - F_{\\mathrm{ck}}$。\n- **测试套件**：一组五个测试用例 $(T_{\\mathrm{sfc}}, T_{\\mathrm{atm}}, u)$:\n  1. $(300\\,\\mathrm{K},\\,270\\,\\mathrm{K},\\,30\\,\\mathrm{kg\\,m^{-2}})$\n  2. $(290\\,\\mathrm{K},\\,260\\,\\mathrm{K},\\,2\\,\\mathrm{kg\\,m^{-2}})$\n  3. $(340\\,\\mathrm{K},\\,320\\,\\mathrm{K},\\,200\\,\\mathrm{kg\\,m^{-2}})$\n  4. $(250\\,\\mathrm{K},\\,230\\,\\mathrm{K},\\,30\\,\\mathrm{kg\\,m^{-2}})$\n  5. $(300\\,\\mathrm{K},\\,270\\,\\mathrm{K},\\,0\\,\\mathrm{kg\\,m^{-2}})$\n\n### 步骤2：使用提取的给定条件进行验证\n该问题具有科学依据，提法恰当且客观。它基于大气辐射传输的标准原理（尽管经过简化），包括 Schwarzschild 方程、Beer-Lambert 定律和通过 Stefan-Boltzmann 定律积分的 Planck 定律。使用灰体模型与相关 k 分布模型进行比较是大气科学中一个标准的教学和研究问题。所有必要的常数、方程和参数均已提供，确保了问题是自洽的，并且每个测试用例都存在唯一的解。语言正式而精确，没有主观性。对于所描述的场景，参数在物理上是合理的。\n\n### 步骤3：结论与行动\n问题有效。将制定并提出解决方案。\n\n### 求解推导与实现\n任务是计算两种辐射传输模型之间的误差 $\\Delta F$：一种是简化的灰体近似模型，另一种是更符合物理实际的两波段相关 k 分布模型。这个误差量化了在计算大气透过率之前对吸收系数进行光谱平均所引入的不准确性。\n\n两种模型计算的核心是向上通量的表达式，可以紧凑地写为：\n$$\nF = F_{\\mathrm{atm,BB}} (1 - \\mathcal{T}) + F_{\\mathrm{sfc,BB}} \\mathcal{T}\n$$\n其中 $F_{\\mathrm{sfc,BB}} = \\sigma T_{\\mathrm{sfc}}^4$ 和 $F_{\\mathrm{atm,BB}} = \\sigma T_{\\mathrm{atm}}^4$ 分别是来自地表和大气的黑体通量。项 $\\mathcal{T} = e^{-D\\tau}$ 表示大气的通量透过率，其中 $\\tau$ 是光学厚度。\n\n对于每个测试用例 $(T_{\\mathrm{sfc}}, T_{\\mathrm{atm}}, u)$，求解过程主要分三个步骤。\n\n**步骤1：计算灰体吸收系数 $k_{\\mathrm{gray}}$**\n首先，我们计算将在灰体模型中代表整个光谱的单一 Planck 加权平均吸收系数 $k_{\\mathrm{gray}}$。对于所有测试用例，这是一个恒定值。使用提供的定义和参数：\n$$\nk_{\\mathrm{gray}} = f_{\\mathrm{win}} \\sum_{j=1}^{4} w_{j}\\,k_{\\mathrm{win},j} + f_{\\mathrm{str}} \\sum_{j=1}^{4} w_{j}\\,k_{\\mathrm{str},j}\n$$\n给定所有 $j$ 的 $w_j=0.25$：\n$$\n\\sum_{j=1}^{4} w_{j}\\,k_{\\mathrm{win},j} = 0.25 \\times (10^{-4} + 5 \\times 10^{-4} + 2 \\times 10^{-3} + 10^{-2}) = 0.25 \\times 0.0126 = 0.00315 \\, \\mathrm{m^2\\,kg^{-1}}\n$$\n$$\n\\sum_{j=1}^{4} w_{j}\\,k_{\\mathrm{str},j} = 0.25 \\times (0.05 + 0.2 + 1 + 5) = 0.25 \\times 6.25 = 1.5625 \\, \\mathrm{m^2\\,kg^{-1}}\n$$\n将这些值代入 $k_{\\mathrm{gray}}$ 的方程，其中 $f_{\\mathrm{win}}=0.3$ 和 $f_{\\mathrm{str}}=0.7$：\n$$\nk_{\\mathrm{gray}} = (0.3 \\times 0.00315) + (0.7 \\times 1.5625) = 0.000945 + 1.09375 = 1.094695 \\, \\mathrm{m^2\\,kg^{-1}}\n$$\n\n**步骤2：计算灰体模型和相关 k 分布模型的 OLR**\n对于给定的 $(T_{\\mathrm{sfc}}, T_{\\mathrm{atm}}, u)$，我们计算两种模型的 OLR。\n\n**灰体模型 OLR, $F_{\\mathrm{gray}}$:**\n灰体光学厚度为 $\\tau = k_{\\mathrm{gray}} \\times u$。透过率为 $\\mathcal{T}_{\\mathrm{gray}} = e^{-D\\tau}$。则 OLR 为：\n$$\nF_{\\mathrm{gray}} = \\sigma T_{\\mathrm{atm}}^{4} (1 - e^{-D k_{\\mathrm{gray}} u}) + \\sigma T_{\\mathrm{sfc}}^{4} e^{-D k_{\\mathrm{gray}} u}\n$$\n\n**相关 k 分布模型 OLR, $F_{\\mathrm{ck}}$:**\n相关 k 分布模型承认透过率是吸收系数的非线性函数。它不是先平均 $k$ 值，而是为 $k$ 值的分布计算透过率，然后对得到的通量进行平均。总 OLR 是每个波段贡献的总和，而每个波段的贡献本身又是对正交点的加权和：\n$$\nF_{\\mathrm{ck}} = F_{\\mathrm{ck,win}} + F_{\\mathrm{ck,str}}\n$$\n其中每个波段 $i \\in \\{\\mathrm{win}, \\mathrm{str}\\}$ 的贡献为：\n$$\nF_{\\mathrm{ck},i} = f_i \\sum_{j=1}^{4} w_j \\left[ \\sigma T_{\\mathrm{atm}}^{4} (1 - e^{-D k_{i,j} u}) + \\sigma T_{\\mathrm{sfc}}^{4} e^{-D k_{i,j} u} \\right]\n$$\n此计算涉及遍历四个 $k_{\\mathrm{win},j}$ 系数和四个 $k_{\\mathrm{str},j}$ 系数，为每个系数计算通量，然后用适当的权重 $f_i$ 和 $w_j$ 求和。\n\n**步骤3：计算带符号误差 $\\Delta F$**\n最后，误差计算为两个模型输出之间的差值：\n$$\n\\Delta F = F_{\\mathrm{gray}} - F_{\\mathrm{ck}}\n$$\n对所有五个测试用例重复此过程。根据针对凸函数 $e^{-x}$ 的 Jensen 不等式，物理上的预期是当 $T_{\\mathrm{sfc}} \\geq T_{\\mathrm{atm}}$ 时 $\\Delta F \\leq 0$，因为灰体近似倾向于高估大气的辐射阻挡作用，从而与更真实的相关 k 分布方法相比，低估了 OLR。对于光学薄情况 ($u=0$)，两种模型都应收敛到表面辐射 $\\sigma T_{\\mathrm{sfc}}^4$，产生误差 $\\Delta F = 0$。\n\n最终答案中实现的算法精确地遵循了这些步骤。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the OLR error between a gray and a correlated-k radiative\n    transfer model for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (T_sfc [K], T_atm [K], u [kg/m^2])\n        (300.0, 270.0, 30.0),   # Case 1: humid Earth-like\n        (290.0, 260.0, 2.0),    # Case 2: dry atmosphere\n        (340.0, 320.0, 200.0),  # Case 3: very humid, hot exoplanet\n        (250.0, 230.0, 30.0),   # Case 4: cold, humid\n        (300.0, 270.0, 0.0),    # Case 5: optically thin limit\n    ]\n\n    # --- Model Constants and Parameters ---\n    SIGMA = 5.670374419e-8  # Stefan-Boltzmann constant (W m^-2 K^-4)\n    D = 1.66  # Diffusivity factor\n\n    # Band fractions\n    f_win = 0.3\n    f_str = 0.7\n\n    # Correlated-k quadrature weight\n    w = 0.25\n\n    # Correlated-k absorption coefficients (m^2 kg^-1)\n    k_win = np.array([1e-4, 5e-4, 2e-3, 1e-2])\n    k_str = np.array([5e-2, 2e-1, 1, 5])\n\n    # --- Pre-calculate Gray Absorption Coefficient (k_gray) ---\n    # This is constant across all test cases.\n    k_gray_win_contrib = f_win * np.sum(w * k_win)\n    k_gray_str_contrib = f_str * np.sum(w * k_str)\n    k_gray = k_gray_win_contrib + k_gray_str_contrib\n\n    results = []\n    for T_sfc, T_atm, u in test_cases:\n        # --- Pre-calculate Blackbody Fluxes for the current case ---\n        F_sfc_bb = SIGMA * T_sfc**4\n        F_atm_bb = SIGMA * T_atm**4\n\n        # --- 1. Gray Model OLR Calculation ---\n        tau_gray = k_gray * u\n        if D * tau_gray > 700: # Avoid overflow in np.exp for large optical depths\n            transmittance_gray = 0.0\n        else:\n            transmittance_gray = np.exp(-D * tau_gray)\n        \n        F_gray = F_atm_bb * (1 - transmittance_gray) + F_sfc_bb * transmittance_gray\n\n        # --- 2. Correlated-k Model OLR Calculation ---\n        F_ck = 0.0\n\n        # Contribution from the window band\n        for k_val in k_win:\n            tau_ij = k_val * u\n            if D * tau_ij > 700: # Avoid overflow\n                transmittance_ij = 0.0\n            else:\n                transmittance_ij = np.exp(-D * tau_ij)\n            \n            flux_ij = F_atm_bb * (1 - transmittance_ij) + F_sfc_bb * transmittance_ij\n            F_ck += f_win * w * flux_ij\n\n        # Contribution from the strong absorption band\n        for k_val in k_str:\n            tau_ij = k_val * u\n            if D * tau_ij > 700: # Avoid overflow\n                transmittance_ij = 0.0\n            else:\n                transmittance_ij = np.exp(-D * tau_ij)\n            \n            flux_ij = F_atm_bb * (1 - transmittance_ij) + F_sfc_bb * transmittance_ij\n            F_ck += f_str * w * flux_ij\n        \n        # --- 3. Compute Signed Error ---\n        delta_F = F_gray - F_ck\n        results.append(delta_F)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}