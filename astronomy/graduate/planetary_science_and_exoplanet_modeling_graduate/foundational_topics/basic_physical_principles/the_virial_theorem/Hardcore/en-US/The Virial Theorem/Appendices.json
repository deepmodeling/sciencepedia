{
    "hands_on_practices": [
        {
            "introduction": "The virial theorem provides a profound connection between the average kinetic and potential energies of a stable, self-gravitating system. This first practice builds your intuition from the ground up by tackling the classic two-body problem. By directly calculating the time-averaged energies for a Keplerian orbit without invoking the theorem itself, you will rigorously verify the famous result $2\\langle K \\rangle = -\\langle U \\rangle$ for an inverse-square force law, solidifying your understanding of its meaning in the context of orbital mechanics .",
            "id": "4185409",
            "problem": "Consider a test particle of mass $m$ moving under Newtonian gravity around a star of mass $M$ in a bound Keplerian ellipse with semi-major axis $a$ and eccentricity $e$, where $0  e  1$. Let the gravitational constant be $G$, and define the gravitational parameter $\\mu = G M$. The instantaneous orbital radius is $r(t)$, the true anomaly is $f(t)$, and the specific angular momentum (angular momentum per unit mass) is $h = |\\mathbf{r} \\times \\mathbf{v}|$, which is conserved. The instantaneous kinetic and potential energies are $K(t) = \\tfrac{1}{2} m v(t)^{2}$ and $U(t) = - \\mu m / r(t)$, respectively.\n\nStarting only from Newton’s law of gravitation, conservation of angular momentum, and standard properties of Newtonian two-body motion (including the polar equation of a Kepler ellipse $r(f) = p/(1 + e \\cos f)$ with $p = a(1 - e^{2})$ and the constant areal velocity $dA/dt = h/2$), do the following:\n\n- Show that $K(t)$ and $U(t)$ both oscillate in time for any $e \\neq 0$ by expressing $K$ and $U$ as functions of $f$ and using the fact that $r$ varies with $f$ over one orbital period.\n- Compute the time averages over one orbital period $T$,\n$$\\langle U \\rangle = \\frac{1}{T} \\int_{0}^{T} U(t)\\, dt, \\qquad \\langle K \\rangle = \\frac{1}{T} \\int_{0}^{T} K(t)\\, dt,$$\nwithout invoking any form of the virial theorem.\n- Using your results, evaluate the virial ratio\n$$R \\equiv \\frac{2 \\langle K \\rangle}{-\\langle U \\rangle}.$$\n\nExpress your final answer for $R$ as a pure number with no units. No numerical rounding is required; provide the exact value.",
            "solution": "The problem is rigorously validated as scientifically grounded, well-posed, objective, and complete. It is a standard problem in celestial mechanics that tests a student's ability to derive fundamental results from first principles without invoking high-level theorems.\n\nThe problem asks for three things: to demonstrate the oscillation of kinetic and potential energy, to compute their time averages over one orbit, and to evaluate the virial ratio.\n\nFirst, we demonstrate that the kinetic energy $K(t)$ and potential energy $U(t)$ oscillate for an elliptical orbit where the eccentricity $e$ satisfies $0  e  1$. The potential energy is given by $U(t) = - \\mu m / r(t)$, where $\\mu = GM$ and $r(t)$ is the instantaneous orbital radius. The radius is given as a function of the true anomaly $f$ by the polar equation for an ellipse:\n$$r(f) = \\frac{p}{1 + e \\cos f}$$\nwhere $p = a(1-e^2)$ is the semi-latus rectum. As the particle orbits, the true anomaly $f$ varies over a range of $2\\pi$. Since $e \\neq 0$, the term $e \\cos f$ varies, causing $r(f)$ to vary. The minimum radius (periapsis) is $r_{\\text{min}} = p/(1+e)$ at $f=0$, and the maximum radius (apoapsis) is $r_{\\text{max}} = p/(1-e)$ at $f=\\pi$. Since $r(t)$ is not constant, $U(t) = -\\mu m / r(t)$ is also not constant and oscillates between its minimum value $U_{\\text{min}} = -\\mu m / r_{\\text{min}}$ and its maximum value $U_{\\text{max}} = -\\mu m / r_{\\text{max}}$.\nThe total energy of the system, $E = K(t) + U(t)$, is conserved in a gravitational field. Therefore, the kinetic energy can be expressed as $K(t) = E - U(t)$. Since $E$ is a constant and $U(t)$ oscillates, $K(t)$ must also oscillate to maintain the constancy of their sum.\n\nNext, we compute the time averages $\\langle U \\rangle$ and $\\langle K \\rangle$. The time average of a quantity $Q(t)$ over one orbital period $T$ is defined as $\\langle Q \\rangle = \\frac{1}{T} \\int_0^T Q(t) dt$. A direct integration with respect to time is complicated. We can simplify the integral by changing the integration variable from time $t$ to the true anomaly $f$. The relation between $dt$ and $df$ is found from the conservation of angular momentum, which implies a constant areal velocity:\n$$\\frac{dA}{dt} = \\frac{h}{2}$$\nIn polar coordinates, the differential area element is $dA = \\frac{1}{2} r^2 df$. Equating the two expressions for $dA/dt$ gives $\\frac{1}{2} r^2 \\frac{df}{dt} = \\frac{h}{2}$, which implies $dt = \\frac{r^2}{h} df$.\n\nWe now compute the time average of the potential energy, $\\langle U \\rangle$:\n$$\\langle U \\rangle = \\frac{1}{T} \\int_0^T U(t) dt = \\frac{1}{T} \\int_0^{2\\pi} U(f) \\frac{r(f)^2}{h} df$$\nSubstituting $U(f) = -\\mu m / r(f)$:\n$$\\langle U \\rangle = \\frac{1}{T} \\int_0^{2\\pi} \\left(-\\frac{\\mu m}{r(f)}\\right) \\frac{r(f)^2}{h} df = -\\frac{\\mu m}{hT} \\int_0^{2\\pi} r(f) df$$\nThe integral we must evaluate is $\\int_0^{2\\pi} \\frac{p}{1+e \\cos f} df$. This is a standard definite integral, whose value is $\\frac{2\\pi}{\\sqrt{1-e^2}}$.\n$$\\int_0^{2\\pi} r(f) df = p \\int_0^{2\\pi} \\frac{1}{1+e \\cos f} df = p \\left( \\frac{2\\pi}{\\sqrt{1-e^2}} \\right)$$\nUsing the given relation $p=a(1-e^2)$, we get:\n$$\\int_0^{2\\pi} r(f) df = a(1-e^2) \\frac{2\\pi}{\\sqrt{1-e^2}} = 2\\pi a \\sqrt{1-e^2}$$\nNow we substitute this back into the expression for $\\langle U \\rangle$:\n$$\\langle U \\rangle = -\\frac{\\mu m}{hT} \\left( 2\\pi a \\sqrt{1-e^2} \\right)$$\nTo simplify this, we use two standard results from Keplerian mechanics. First, the specific angular momentum $h$ is related to the semi-major axis $a$ and eccentricity $e$ by $h^2 = \\mu p = \\mu a(1-e^2)$, so $h = \\sqrt{\\mu a(1-e^2)}$. Second, Kepler's Third Law states that the orbital period $T$ is given by $T^2 = \\frac{4\\pi^2}{\\mu} a^3$, so $T = 2\\pi \\sqrt{\\frac{a^3}{\\mu}}$.\nSubstituting for $h$ and $T$:\n$$\\langle U \\rangle = -\\frac{\\mu m}{\\left(\\sqrt{\\mu a(1-e^2)}\\right) \\left(2\\pi \\sqrt{a^3/\\mu}\\right)} \\left( 2\\pi a \\sqrt{1-e^2} \\right)$$\nThe terms $2\\pi$ and $\\sqrt{1-e^2}$ cancel out.\n$$\\langle U \\rangle = -\\frac{\\mu m a}{\\sqrt{\\mu a} \\sqrt{a^3/\\mu}} = -\\frac{\\mu m a}{\\sqrt{\\mu a \\cdot a^3/\\mu}} = -\\frac{\\mu m a}{\\sqrt{a^4}} = -\\frac{\\mu m a}{a^2}$$\n$$\\langle U \\rangle = -\\frac{\\mu m}{a}$$\nTo find $\\langle K \\rangle$, we use the conservation of total energy $E = K(t) + U(t)$. The time average of a constant is the constant itself, so $\\langle E \\rangle = E$. The average of a sum is the sum of averages, so $\\langle E \\rangle = \\langle K \\rangle + \\langle U \\rangle$. The total energy of a bound Keplerian orbit is a standard result, given by $E = -\\frac{\\mu m}{2a}$. Therefore:\n$$\\langle K \\rangle + \\langle U \\rangle = E = -\\frac{\\mu m}{2a}$$\nWe can now solve for $\\langle K \\rangle$:\n$$\\langle K \\rangle = E - \\langle U \\rangle = \\left(-\\frac{\\mu m}{2a}\\right) - \\left(-\\frac{\\mu m}{a}\\right) = -\\frac{\\mu m}{2a} + \\frac{\\mu m}{a}$$\n$$\\langle K \\rangle = \\frac{\\mu m}{2a}$$\nFinally, we evaluate the virial ratio $R$:\n$$R \\equiv \\frac{2 \\langle K \\rangle}{-\\langle U \\rangle}$$\nSubstituting our derived expressions for the time-averaged energies:\n$$R = \\frac{2 \\left(\\frac{\\mu m}{2a}\\right)}{-\\left(-\\frac{\\mu m}{a}\\right)} = \\frac{\\frac{\\mu m}{a}}{\\frac{\\mu m}{a}}$$\n$$R = 1$$\nThe derivation is complete and consistent with the problem constraints.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "Moving from a simple two-body system to a complex, self-gravitating fluid body, this practice explores the thermodynamic implications of the virial theorem. You will investigate how a planet's equation of state, characterized by the adiabatic index $\\gamma$, governs its thermal evolution during quasi-static contraction. This exercise reveals the theorem's power in explaining the Kelvin-Helmholtz mechanism, linking the microphysics of a planet's gaseous envelope to its observable luminosity and radius evolution .",
            "id": "4185394",
            "problem": "A self-gravitating, non-rotating exoplanet of mass $M$ and radius $R$ is pressure-supported by a single-phase gas whose thermodynamic behavior is well described by an ideal-gas Equation of State (EOS), with adiabatic index $\\gamma$ assumed constant during a quasi-static contraction. The body is in hydrostatic equilibrium at all times, with negligible magnetic fields and no bulk kinetic energy, and it radiates energy into space at a luminosity $L$ as it contracts. The internal energy density of the gas is $u$, the pressure is $P$, and the total internal energy is $U = \\int u \\, dV$. The total gravitational potential energy is $\\Omega$, defined in the conventional sense for a bound, self-gravitating object such that $\\Omega  0$. The EOS relates $P$ and $u$ as $P = (\\gamma - 1) u$, and the gravitational potential $\\Phi$ satisfies Newtonian gravity. \n\nUnder these conditions, the change in the total energy $E = U + \\Omega$ associated with a small, quasi-static contraction from initial radius $R_{\\mathrm{i}}$ to final radius $R_{\\mathrm{f}}$ is partially radiated and partially stored as increased internal energy. Starting only from Newton’s laws, hydrostatic equilibrium, and the ideal-gas EOS stated above, determine how the radiated fraction of the released gravitational binding energy depends on $\\gamma$, and infer the comparative rate of radius evolution between two otherwise identical exoplanets: one dominated by monatomic gas with $\\gamma = 5/3$ and the other dominated by molecular hydrogen with $\\gamma = 7/5$. Assume their luminosities $L$ are equal during the initial phase of contraction and any structural constants remain approximately fixed over the small interval.\n\nWhich option best captures both the correct expression for the radiated fraction and the correct qualitative implication for radius evolution?\n\nA. The radiated fraction is $f_{\\mathrm{rad}} = 1 - \\dfrac{1}{3(\\gamma - 1)}$. Hence $f_{\\mathrm{rad}} = 1/2$ for $\\gamma = 5/3$ and $f_{\\mathrm{rad}} = 1/6$ for $\\gamma = 7/5$. At fixed $L$, the $\\gamma = 7/5$ planet must contract faster than the $\\gamma = 5/3$ planet to supply the same luminosity, implying a more rapid initial radius shrinkage for the softer EOS.\n\nB. The radiated fraction is $f_{\\mathrm{rad}} = \\dfrac{1}{3(\\gamma - 1)}$. Hence $f_{\\mathrm{rad}} = 1/2$ for $\\gamma = 5/3$ and $f_{\\mathrm{rad}} = 5/6$ for $\\gamma = 7/5$. At fixed $L$, the $\\gamma = 7/5$ planet contracts more slowly than the $\\gamma = 5/3$ planet.\n\nC. The radiated fraction is $f_{\\mathrm{rad}} = \\dfrac{3\\gamma - 4}{3\\gamma}$. It follows that $f_{\\mathrm{rad}} \\rightarrow 0$ as $\\gamma \\rightarrow 4/3$, while $f_{\\mathrm{rad}}$ increases toward unity for larger $\\gamma$. At fixed $L$, the $\\gamma = 5/3$ planet contracts faster than the $\\gamma = 7/5$ planet.\n\nD. As the EOS softens, $f_{\\mathrm{rad}} \\rightarrow 1$ in the limit $\\gamma \\rightarrow 4/3$, so radiation-pressure dominated bodies radiate nearly all the released gravitational energy. At fixed $L$, this implies slower contraction for the softer EOS.\n\nE. The radiated fraction depends primarily on $M$ and $R$ and is independent of $\\gamma$. At fixed $L$, both planets contract at the same rate during the initial phase.",
            "solution": "The problem statement is a valid application of the virial theorem to the quasi-static contraction of a gaseous body. All provided information is scientifically grounded, well-posed, and objective. We may proceed with the solution.\n\nThe solution requires relating the energy radiated by the exoplanet to the change in its gravitational potential energy. This relationship is governed by the virial theorem and the first law of thermodynamics.\n\n1.  **Derivation of the Virial Theorem**\n\nFor a self-gravitating fluid sphere in hydrostatic equilibrium, the pressure gradient balances the gravitational force:\n$$ \\frac{dP}{dr} = -\\rho(r) \\frac{Gm(r)}{r^2} $$\nwhere $P(r)$ is the pressure, $\\rho(r)$ is the density, $m(r)$ is the mass enclosed within radius $r$, and $G$ is the gravitational constant.\n\nTo derive the virial theorem, we multiply this equation by $4\\pi r^3$ and integrate over the volume of the planet, from the center ($r=0$) to the surface ($r=R$):\n$$ \\int_0^R 4\\pi r^3 \\frac{dP}{dr} dr = -\\int_0^R 4\\pi r^3 \\rho(r) \\frac{Gm(r)}{r^2} dr $$\nThe left-hand side (LHS) can be integrated by parts, $\\int u \\, dv = uv - \\int v \\, du$. Let $u = 4\\pi r^3$ and $dv = dP$. Then $du = 12\\pi r^2 dr$ and $v = P$.\n$$ \\text{LHS} = [4\\pi r^3 P]_0^R - \\int_0^R P(r) (12\\pi r^2) dr $$\nThe boundary term $[4\\pi r^3 P]_0^R$ is zero, as $r=0$ at the lower limit and the pressure at the surface $P(R)$ is assumed to be zero for an isolated body. The integral becomes:\n$$ \\text{LHS} = -3 \\int_0^R P(r) (4\\pi r^2 dr) = -3 \\int_V P \\, dV $$\nThe right-hand side (RHS) of the original equation can be rewritten using $dm = 4\\pi r^2 \\rho dr$:\n$$ \\text{RHS} = -\\int_0^R \\frac{Gm(r)}{r} (4\\pi r^2 \\rho(r) dr) = \\int_0^M \\left(-\\frac{Gm}{r}\\right) dm $$\nThis is the definition of the total gravitational potential energy, $\\Omega$. Therefore, equating the LHS and RHS gives the pressure-form of the virial theorem:\n$$ -3 \\int_V P \\, dV = \\Omega $$\n\n2.  **Application of the Equation of State (EOS)**\n\nThe problem states the EOS relates pressure $P$ and internal energy density $u$ as $P = (\\gamma - 1) u$. We substitute this into the virial theorem. Assuming $\\gamma$ is constant throughout the body:\n$$ -3 \\int_V (\\gamma - 1) u \\, dV = \\Omega $$\n$$ -3(\\gamma - 1) \\int_V u \\, dV = \\Omega $$\nThe total internal energy is $U = \\int_V u \\, dV$. This yields the virial theorem for a polytropic gas sphere:\n$$ -3(\\gamma - 1) U = \\Omega \\quad \\text{or} \\quad U = -\\frac{\\Omega}{3(\\gamma - 1)} $$\nNote that since $\\Omega  0$ and for a stable configuration $\\gamma  4/3$, the internal energy $U$ is positive, as required.\n\n3.  **Energy Conservation during Contraction**\n\nThe total energy of the planet is $E = U + \\Omega$. During a quasi-static contraction, the total energy changes by $dE = dU + d\\Omega$. The energy radiated away, $dE_{\\mathrm{rad}}$, is equal to the decrease in the total energy of the planet: $dE_{\\mathrm{rad}} = -dE$.\n\nWe can express the change in total energy $dE$ in terms of the change in gravitational potential energy $d\\Omega$. Differentiating the virial relation $U = -\\frac{\\Omega}{3(\\gamma - 1)}$ gives:\n$$ dU = -\\frac{d\\Omega}{3(\\gamma - 1)} $$\nDuring contraction, the planet becomes more tightly bound, so its potential energy becomes more negative ($d\\Omega  0$). Consequently, the internal energy increases ($dU  0$), which means the planet heats up.\n\nNow, substitute $dU$ into the expression for $dE$:\n$$ dE = dU + d\\Omega = -\\frac{d\\Omega}{3(\\gamma - 1)} + d\\Omega = \\left(1 - \\frac{1}{3(\\gamma - 1)}\\right) d\\Omega $$\n$$ dE = \\left(\\frac{3(\\gamma - 1) - 1}{3(\\gamma - 1)}\\right) d\\Omega = \\left(\\frac{3\\gamma - 4}{3(\\gamma - 1)}\\right) d\\Omega $$\n\n4.  **Radiated Fraction of Released Gravitational Energy**\n\nThe \"released gravitational binding energy\" during contraction is $-d\\Omega  0$. The energy radiated is $dE_{\\mathrm{rad}} = -dE$. The problem asks for the radiated fraction of the released gravitational energy, which is:\n$$ f_{\\mathrm{rad}} = \\frac{dE_{\\mathrm{rad}}}{-d\\Omega} = \\frac{-dE}{-d\\Omega} = \\frac{dE}{d\\Omega} $$\nUsing our expression for $dE$ in terms of $d\\Omega$:\n$$ f_{\\mathrm{rad}} = \\frac{3\\gamma - 4}{3(\\gamma - 1)} $$\nThis can also be written as $f_{\\mathrm{rad}} = 1 - \\frac{1}{3(\\gamma-1)}$. The other fraction, $1 - f_{\\mathrm{rad}} = \\frac{1}{3(\\gamma-1)}$, represents the portion of the released gravitational energy that goes into increasing the internal thermal energy of the planet.\n\n5.  **Numerical Evaluation**\n\nWe now calculate $f_{\\mathrm{rad}}$ for the two given values of $\\gamma$:\n-   Monatomic gas: $\\gamma = 5/3$.\n    $$ f_{\\mathrm{rad}} = \\frac{3(5/3) - 4}{3(5/3 - 1)} = \\frac{5 - 4}{3(2/3)} = \\frac{1}{2} $$\n-   Molecular hydrogen gas: $\\gamma = 7/5$.\n    $$ f_{\\mathrm{rad}} = \\frac{3(7/5) - 4}{3(7/5 - 1)} = \\frac{21/5 - 20/5}{3(2/5)} = \\frac{1/5}{6/5} = \\frac{1}{6} $$\n\n6.  **Rate of Radius Evolution**\n\nThe luminosity $L$ is the rate of energy radiation: $L = \\frac{dE_{\\mathrm{rad}}}{dt} = - \\frac{dE}{dt}$.\nFrom the previous steps, $dE_{\\mathrm{rad}} = f_{\\mathrm{rad}} (-d\\Omega)$. Thus:\n$$ L = f_{\\mathrm{rad}} \\left(-\\frac{d\\Omega}{dt}\\right) $$\nThe gravitational potential energy is of the form $\\Omega = -k \\frac{GM^2}{R}$, where $k$ is a constant related to the internal mass distribution. Taking the time derivative:\n$$ \\frac{d\\Omega}{dt} = \\frac{d\\Omega}{dR} \\frac{dR}{dt} = \\left(k \\frac{GM^2}{R^2}\\right) \\frac{dR}{dt} $$\nSubstituting this into the luminosity equation:\n$$ L = -f_{\\mathrm{rad}} \\left(k \\frac{GM^2}{R^2}\\right) \\frac{dR}{dt} $$\nThe rate of radius shrinkage is $|\\frac{dR}{dt}| = -\\frac{dR}{dt}$. Solving for this rate:\n$$ \\left|\\frac{dR}{dt}\\right| = \\frac{L R^2}{f_{\\mathrm{rad}} k G M^2} $$\nFor two otherwise identical planets (same $M$, $R$, $k$) radiating at the same luminosity $L$, the rate of shrinkage is inversely proportional to the radiated fraction:\n$$ \\left|\\frac{dR}{dt}\\right| \\propto \\frac{1}{f_{\\mathrm{rad}}} $$\nComparing the two cases:\n-   Planet 1 ($\\gamma = 5/3$): $f_{\\mathrm{rad},1} = 1/2$.\n-   Planet 2 ($\\gamma = 7/5$): $f_{\\mathrm{rad},2} = 1/6$.\nSince $f_{\\mathrm{rad},2}  f_{\\mathrm{rad},1}$, the rate of shrinkage must be greater for Planet 2: $|\\frac{dR}{dt}|_2  |\\frac{dR}{dt}|_1$.\nThe planet with the smaller adiabatic index $\\gamma = 7/5$ (a \"softer\" EOS) radiates a smaller fraction of the released gravitational energy. To maintain the same luminosity, it must release gravitational energy at a higher rate, which means it must contract faster.\n\n**Option-by-Option Analysis**\n\nA. The radiated fraction is $f_{\\mathrm{rad}} = 1 - \\dfrac{1}{3(\\gamma - 1)}$. Hence $f_{\\mathrm{rad}} = 1/2$ for $\\gamma = 5/3$ and $f_{\\mathrm{rad}} = 1/6$ for $\\gamma = 7/5$. At fixed $L$, the $\\gamma = 7/5$ planet must contract faster than the $\\gamma = 5/3$ planet to supply the same luminosity, implying a more rapid initial radius shrinkage for the softer EOS.\n-   **Formula:** $f_{\\mathrm{rad}} = 1 - \\frac{1}{3(\\gamma - 1)} = \\frac{3\\gamma-4}{3(\\gamma - 1)}$. This matches our derivation.\n-   **Values:** $f_{\\mathrm{rad}}(5/3) = 1/2$ and $f_{\\mathrm{rad}}(7/5) = 1/6$. These match our calculations.\n-   **Implication:** The planet with the smaller $f_{\\mathrm{rad}}$ (i.e., $\\gamma=7/5$) must contract faster. This matches our conclusion.\n-   **Verdict:** **Correct**.\n\nB. The radiated fraction is $f_{\\mathrm{rad}} = \\dfrac{1}{3(\\gamma - 1)}$. Hence $f_{\\mathrm{rad}} = 1/2$ for $\\gamma = 5/3$ and $f_{\\mathrm{rad}} = 5/6$ for $\\gamma = 7/5$. At fixed $L$, the $\\gamma = 7/5$ planet contracts more slowly than the $\\gamma = 5/3$ planet.\n-   **Formula:** Incorrect. This formula represents the fraction of energy that increases internal heat, not the fraction radiated.\n-   **Values:** The value for $\\gamma=7/5$ is incorrect for the radiated fraction.\n-   **Implication:** The conclusion about contraction speed is opposite to what is correct.\n-   **Verdict:** **Incorrect**.\n\nC. The radiated fraction is $f_{\\mathrm{rad}} = \\dfrac{3\\gamma - 4}{3\\gamma}$. It follows that $f_{\\mathrm{rad}} \\rightarrow 0$ as $\\gamma \\rightarrow 4/3$, while $f_{\\mathrm{rad}}$ increases toward unity for larger $\\gamma$. At fixed $L$, the $\\gamma = 5/3$ planet contracts faster than the $\\gamma = 7/5$ planet.\n-   **Formula:** Incorrect. The denominator is $3\\gamma$ instead of the correct $3(\\gamma-1)$.\n-   **Implication:** The conclusion about contraction speed is opposite to what is correct.\n-   **Verdict:** **Incorrect**.\n\nD. As the EOS softens, $f_{\\mathrm{rad}} \\rightarrow 1$ in the limit $\\gamma \\rightarrow 4/3$, so radiation-pressure dominated bodies radiate nearly all the released gravitational energy. At fixed $L$, this implies slower contraction for the softer EOS.\n-   **Limit:** Incorrect. As the EOS softens towards the stability limit $\\gamma \\to 4/3$, our formula $f_{\\mathrm{rad}} = \\frac{3\\gamma - 4}{3(\\gamma - 1)}$ shows that $f_{\\mathrm{rad}} \\to 0$, not $1$. This means almost all released energy goes into internal heat, and very little is radiated.\n-   **Implication:** The conclusion about contraction speed is opposite to what is correct.\n-   **Verdict:** **Incorrect**.\n\nE. The radiated fraction depends primarily on $M$ and $R$ and is independent of $\\gamma$. At fixed $L$, both planets contract at the same rate during the initial phase.\n-   **Dependence:** Incorrect. Our derivation shows $f_{\\mathrm{rad}}$ is a function of $\\gamma$ only.\n-   **Implication:** The conclusion about contraction speed is a direct consequence of the incorrect first statement.\n-   **Verdict:** **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "In modern planetary science, analytical theory and computational modeling go hand-in-hand. This final practice bridges that gap by tasking you with designing a numerical diagnostic based on the virial theorem for a hydrodynamic simulation. By implementing the terms of the theorem in code and using them to analyze the state of a simulated protoplanet, you will gain practical experience in how this fundamental principle is used to validate simulations and diagnose non-equilibrium dynamics in complex astrophysical systems .",
            "id": "4185355",
            "problem": "You are tasked with designing a spherically symmetric simulation diagnostic for a self-gravitating, compressible fluid modeled under Newtonian gravity. The diagnostic should evaluate the global quantity $D = 2K + W + 3 \\int P\\, dV$ at a given timestep and return a normalized measure of deviation from equilibrium. The diagnostic is based on the virial theorem and will be implemented for a one-dimensional radial grid representing a sphere of radius $R$ and total mass $M$. Your program must compute $K$, $W$, and $\\int P\\, dV$ from first principles using discrete numerical integration over spherical shells.\n\nFundamental base to use:\n- Newtonian gravity: gravitational constant $G$.\n- Kinematics and hydrodynamics definitions.\n- Spherical symmetry and shell volumes.\n\nDefinitions to implement:\n- Use a uniform-density sphere with density $\\rho = \\dfrac{3M}{4\\pi R^3}$.\n- Discretize the radius into $N$ spherical shells of thickness $\\Delta r = R/N$ with shell centers at $r_i = \\left(i - \\dfrac{1}{2}\\right)\\Delta r$ for $i \\in \\{1,\\dots,N\\}$. The shell volume is $V_i = 4\\pi r_i^2 \\Delta r$.\n- The radial velocity field is uniform $u(r) = u_0$ (in $\\mathrm{m/s}$).\n- The hydrostatic pressure profile for a uniform-density sphere with an imposed surface pressure $P_s$ at $r=R$ is given by $P(r) = P_s + \\dfrac{2\\pi}{3} G \\rho^2 \\left(R^2 - r^2\\right)$ (in $\\mathrm{Pa}$). This follows from radial hydrostatic balance $dP/dr = -\\rho\\, G M(r)/r^2$ with $M(r) = \\dfrac{4\\pi}{3}\\rho r^3$ inside the sphere and $P(R) = P_s$.\n- The gravitational potential inside a uniform-density sphere is $\\Phi(r) = -2\\pi G \\rho \\left(R^2 - \\dfrac{r^2}{3}\\right)$ (in $\\mathrm{J/kg}$), chosen to match the exterior potential at the surface.\n- Kinetic energy is computed as $K = \\sum_{i=1}^N \\dfrac{1}{2}\\,\\rho\\, u_0^2\\, V_i$ (in $\\mathrm{J}$).\n- Gravitational potential energy is computed as $W = \\dfrac{1}{2} \\sum_{i=1}^N \\rho\\, \\Phi(r_i)\\, V_i$ (in $\\mathrm{J}$).\n- The pressure-volume integral is computed as $\\int P\\, dV \\approx \\sum_{i=1}^N P(r_i)\\, V_i$ (in $\\mathrm{J}$).\n- The diagnostic is $D = 2K + W + 3\\int P\\, dV$ (in $\\mathrm{J}$).\n- Report the normalized deviation $\\epsilon = \\dfrac{D}{|W|}$ as a dimensionless float per test case. This normalization makes deviations comparable across cases.\n\nAll computations must be performed in the International System of Units (SI): mass in $\\mathrm{kg}$, length in $\\mathrm{m}$, time in $\\mathrm{s}$, pressure in $\\mathrm{Pa}$, energy in $\\mathrm{J}$. The angles used in any intermediate calculation are radial and do not require an angle unit. Your program should output three normalized deviations $\\epsilon$ corresponding to the three test cases below. Express each result as a decimal rounded to six digits after the decimal point.\n\nTest suite (use $G = 6.67430 \\times 10^{-11}\\ \\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$):\n- Case A (near equilibrium without surface pressure): $M = 3.0 \\times 10^{24}\\ \\mathrm{kg}$, $R = 1.0 \\times 10^{6}\\ \\mathrm{m}$, $N = 800$, $u_0 = 0\\ \\mathrm{m/s}$, $P_s = 0\\ \\mathrm{Pa}$.\n- Case B (departing from equilibrium by bulk expansion): same $M$, $R$, $N$, but $u_0 = 100\\ \\mathrm{m/s}$, $P_s = 0\\ \\mathrm{Pa}$.\n- Case C (hydrostatic with finite surface pressure): same $M$, $R$, $N$, but $u_0 = 0\\ \\mathrm{m/s}$, $P_s = 1.0 \\times 10^{11}\\ \\mathrm{Pa}$.\n\nAlgorithmic requirements:\n- Construct the radial grid and compute $r_i$ and $V_i$.\n- Compute $\\rho$ from $M$ and $R$.\n- Evaluate $u(r_i)$, $P(r_i)$, and $\\Phi(r_i)$ using the formulas provided.\n- Compute $K$, $W$, and $\\int P\\, dV$ using discrete sums.\n- Compute $D$ and $\\epsilon$.\n- Round each $\\epsilon$ to six digits after the decimal point.\n- Aggregate the three results in the required format.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, e.g., \"[xA,xB,xC]\", where $xA$, $xB$, and $xC$ are the three rounded decimals for cases A, B, and C, respectively (no spaces).\n\nNote: In exact hydrostatic equilibrium with $u_0 = 0$ and $P_s = 0$, one expects $W + 3\\int P\\, dV = 0$ and hence $D \\approx 0$. With nonzero $P_s$, the equilibrium relation includes a surface term, so $D \\approx 3 P_s V$, where $V = \\dfrac{4\\pi}{3} R^3$. Deviations from zero (after normalization by $|W|$) indicate non-equilibrium or the presence of a non-vanishing surface term.",
            "solution": "The problem presented is a valid and well-posed exercise in computational physics, specifically relating to the dynamics of self-gravitating fluids. It requires the numerical evaluation of the terms in the scalar virial theorem for a simplified, spherically symmetric model of a celestial body. The model assumes a uniform density sphere, which allows for analytical expressions for the pressure and gravitational potential profiles, forming the basis for a discrete numerical verification. The problem is scientifically grounded, internally consistent, and requires the application of fundamental principles of mechanics and gravitation.\n\nThe solution proceeds by discretizing the spherical body into a series of concentric shells and evaluating the physical quantities for each shell. These are then summed to approximate the total kinetic energy $K$, the total gravitational potential energy $W$, and the integrated pressure-volume term $\\int P\\,dV$.\n\nThe virial theorem, in its general form, relates the time evolution of a system's moment of inertia to its kinetic and potential energies. For a self-gravitating fluid sphere with an external pressure $P_s$ at its surface (radius $R$), the scalar virial theorem can be expressed as:\n$$\n\\frac{1}{2}\\frac{d^2I}{dt^2} = 2K + W + 3\\int_V P\\,dV - 4\\pi R^3 P_s\n$$\nwhere $I$ is the moment of inertia, $K$ is the total kinetic energy, and $W$ is the gravitational potential energy. The diagnostic quantity $D = 2K + W + 3\\int P\\,dV$ proposed in the problem is thus a measure of the system's tendency to expand or contract, accounting for the surface pressure term. A state of hydrostatic equilibrium ($K=0$, $\\frac{d^2I}{dt^2}=0$) implies $W + 3\\int P\\,dV - 4\\pi R^3 P_s = 0$, or $D = 4\\pi R^3 P_s = 3V P_s$, where $V$ is the total volume. The normalized deviation $\\epsilon = D/|W|$ provides a dimensionless measure of how far the system is from this equilibrium state.\n\nThe step-by-step numerical implementation is as follows:\n\n1.  **System Parameters**: For each test case, the mass $M$, radius $R$, number of shells $N$, uniform radial velocity $u_0$, and surface pressure $P_s$ are defined. The gravitational constant is $G = 6.67430 \\times 10^{-11}\\ \\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$.\n\n2.  **Derived Constants**: The uniform mass density $\\rho$ is calculated from the total mass $M$ and radius $R$:\n    $$\n    \\rho = \\frac{M}{V_{total}} = \\frac{3M}{4\\pi R^3}\n    $$\n    The thickness of each spherical shell, $\\Delta r$, is determined by dividing the total radius $R$ by the number of shells $N$:\n    $$\n    \\Delta r = \\frac{R}{N}\n    $$\n\n3.  **Discretization Grid**: The continuous sphere is approximated by $N$ discrete spherical shells. The center of each shell $i$ (for $i \\in \\{1, \\dots, N\\}$) is located at a radius $r_i$. Using a midpoint rule for numerical integration, the representative radius for the $i$-th shell is:\n    $$\n    r_i = \\left(i - \\frac{1}{2}\\right)\\Delta r\n    $$\n    The volume of each shell, $V_i$, is approximated as the surface area at its center radius multiplied by its thickness:\n    $$\n    V_i = 4\\pi r_i^2 \\Delta r\n    $$\n\n4.  **Evaluation of Physical Quantities**: The following terms are computed for each shell based on the provided analytical models:\n    *   **Kinetic Energy ($K$)**: The model assumes a uniform radial velocity field $u(r) = u_0$. The total kinetic energy is the sum of the kinetic energies of all shells.\n        $$\n        K = \\sum_{i=1}^{N} \\frac{1}{2} (\\rho V_i) u_0^2 = \\frac{1}{2}\\rho u_0^2 \\sum_{i=1}^{N} V_i\n        $$\n    *   **Gravitational Potential Energy ($W$)**: The gravitational potential $\\Phi(r)$ inside a uniform sphere is given by $\\Phi(r) = -2\\pi G \\rho \\left(R^2 - \\frac{r^2}{3}\\right)$. The total potential energy is calculated by summing the contributions from each shell, using the definition $W = \\frac{1}{2}\\int \\rho \\Phi \\,dV$.\n        $$\n        W = \\frac{1}{2} \\sum_{i=1}^{N} \\rho \\Phi(r_i) V_i\n        $$\n        The factor of $\\frac{1}{2}$ prevents the double-counting of interaction energies between mass elements.\n    *   **Pressure-Volume Integral ($\\int P\\,dV$)**: The pressure profile $P(r)$ for a uniform sphere in hydrostatic equilibrium with a surface pressure $P_s$ is $P(r) = P_s + \\frac{2\\pi}{3} G \\rho^2 \\left(R^2 - r^2\\right)$. The volume integral of pressure is approximated by the sum:\n        $$\n        \\int P\\,dV \\approx \\sum_{i=1}^{N} P(r_i) V_i\n        $$\n\n5.  **Diagnostic Calculation**: The diagnostic quantity $D$ is computed by combining the above terms as specified.\n    $$\n    D = 2K + W + 3\\int P\\,dV\n    $$\n\n6.  **Normalized Deviation ($\\epsilon$)**: To provide a comparable measure of disequilibrium across different physical scenarios, $D$ is normalized by the magnitude of the gravitational potential energy $|W|$.\n    $$\n    \\epsilon = \\frac{D}{|W|}\n    $$\n\nFinally, this procedure is applied to each of the three test cases, and the resulting values of $\\epsilon$ are rounded to six decimal places for the final output. The implementation uses numerical arrays to efficiently perform the summations over the $N$ shells.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes a diagnostic quantity based on the virial theorem for a\n    spherically symmetric, self-gravitating fluid model.\n    \"\"\"\n    # Define the gravitational constant in SI units.\n    G = 6.67430e-11  # m^3 kg^-1 s^-2\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (M, R, N, u0, Ps)\n    test_cases = [\n        # Case A: near equilibrium, no surface pressure\n        (3.0e24, 1.0e6, 800, 0.0, 0.0),\n        # Case B: expanding, no surface pressure\n        (3.0e24, 1.0e6, 800, 100.0, 0.0),\n        # Case C: hydrostatic with finite surface pressure\n        (3.0e24, 1.0e6, 800, 0.0, 1.0e11),\n    ]\n\n    results = []\n    for M, R, N, u0, Ps in test_cases:\n        # M: total mass (kg)\n        # R: total radius (m)\n        # N: number of shells\n        # u0: uniform radial velocity (m/s)\n        # Ps: surface pressure (Pa)\n\n        # Calculate derived quantities\n        rho = (3.0 * M) / (4.0 * np.pi * R**3)  # Density (kg/m^3)\n        dr = R / N  # Shell thickness (m)\n\n        # Construct the radial grid for shell centers\n        # i represents shell indices from 1 to N\n        # We use numpy's arange to create an array of radii for vectorized calculations\n        i = np.arange(1, N + 1)\n        r = (i - 0.5) * dr  # Radii of shell centers (m)\n        \n        # Calculate shell volumes\n        V = 4.0 * np.pi * r**2 * dr  # Shell volumes (m^3)\n\n        # --- Compute energy and pressure terms ---\n\n        # 1. Kinetic Energy (K)\n        # K = sum(1/2 * dm_i * u0^2) = sum(1/2 * rho * V_i * u0^2)\n        # Since u0 and rho are constant, we can simplify:\n        K = 0.5 * rho * u0**2 * np.sum(V)\n\n        # 2. Gravitational Potential Energy (W)\n        # Potential at radius r: Phi(r) = -2*pi*G*rho*(R^2 - r^2/3)\n        # W = 1/2 * sum(rho * Phi(r_i) * V_i)\n        phi_r = -2.0 * np.pi * G * rho * (R**2 - r**2 / 3.0)\n        W = 0.5 * np.sum(rho * phi_r * V)\n\n        # 3. Pressure-Volume Integral (P_int)\n        # Pressure at radius r: P(r) = Ps + (2*pi/3)*G*rho^2*(R^2 - r^2)\n        # P_int = sum(P(r_i) * V_i)\n        P_r = Ps + (2.0 * np.pi / 3.0) * G * rho**2 * (R**2 - r**2)\n        P_int = np.sum(P_r * V)\n\n        # --- Compute the diagnostics ---\n\n        # Diagnostic quantity D\n        D = 2.0 * K + W + 3.0 * P_int\n\n        # Normalized deviation epsilon\n        epsilon = D / np.abs(W)\n\n        # Round the result to six decimal places as required\n        results.append(round(epsilon, 6))\n\n    # Final print statement in the exact required format.\n    # The format is a comma-separated list of results in square brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}