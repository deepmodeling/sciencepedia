## 引言
维里定理是理论物理学，特别是天体物理学和行星科学中的一块基石。它以一种极为优雅的方式，将一个稳定束缚系统的长期平均动能与其内部相互作用的势能联系起来，为我们理解天体的结构、稳定性和演化提供了一个深刻的见解。然而，面对行星系统、星系乃至[分子云](@entry_id:160702)这样复杂的[多体系统](@entry_id:144006)，我们如何超越瞬时快照，从宏观上把握其长期的能量平衡和动力学状态？这正是维里定理旨在解决的核心问题。

本文旨在系统性地剖析[维里定理](@entry_id:146441)。在“原理与机制”一章中，我们将从[牛顿力学](@entry_id:162125)的第一性原理出发，严格推导标量[维里定理](@entry_id:146441)，并阐明其成立的物理条件。随后，我们将探讨其在[引力](@entry_id:189550)等关键势场下的具体形式，并将其推广至描述流体天体的连续介质形式和分析非球形结构的张量形式。接着，在“应用与跨学科联系”一章中，我们将展示该定理如何作为强大的分析工具，应用于判断[恒星形成](@entry_id:159940)的[引力坍缩](@entry_id:161275)、解释行星的演化路径、分析天体的[动力学稳定性](@entry_id:150175)，并探讨其在宇宙学和分子动力学等领域的交叉应用。最后，“动手实践”部分将通过一系列引导性问题，帮助读者将理论知识转化为解决实际问题的能力。通过这三个章节，读者将全面掌握维里定理的理论精髓与实践价值。

## 原理与机制

本章深入探讨维里定理的力学基础、数学推导及其在[行星科学](@entry_id:158926)中的多样化应用。我们将从最基本的经典[多粒子系统](@entry_id:192694)出发，推导出标量维里定理，阐明其成立所需的核心条件。随后，我们会将此定理应用于不同类型的势能函数，特别是引力势和[谐振子势](@entry_id:750179)，这两种势在[行星科学](@entry_id:158926)建模中至关重要。我们还将澄清[维里定理](@entry_id:146441)与统计力学中[能量均分定理](@entry_id:136972)等概念的根本区别。最后，本章内容将扩展至更高级的主题，包括定理在连续介质（如[行星大气](@entry_id:148668)和内部）中的形式，以及描述非球形天体结构所必需的[张量维里定理](@entry_id:159872)。

### 标量[维里定理](@entry_id:146441)的推导

维里定理的根基深植于牛顿力学。为了揭示其核心机制，我们首先考虑一个由 $N$ 个点状粒子组成的[孤立系统](@entry_id:159201)，其中每个粒子的质量为 $m_i$，位置矢量为 $\mathbf{r}_i$，动量为 $\mathbf{p}_i = m_i \mathbf{v}_i$。

我们构造一个称为 **经典维里 (classical virial)** 的标量 $G$（有时也称为拉格朗日维里），其定义为：
$$
G = \sum_{i=1}^{N} \mathbf{p}_i \cdot \mathbf{r}_i
$$
这个量的巧妙之处在于它的时间导数能够将系统的总动能与作用在粒子上的力联系起来。利用[微分](@entry_id:158422)的[乘法法则](@entry_id:144424)，我们对 $G$ 求时间导数：
$$
\frac{dG}{dt} = \frac{d}{dt} \sum_{i=1}^{N} (\mathbf{p}_i \cdot \mathbf{r}_i) = \sum_{i=1}^{N} \left( \frac{d\mathbf{p}_i}{dt} \cdot \mathbf{r}_i + \mathbf{p}_i \cdot \frac{d\mathbf{r}_i}{dt} \right)
$$
根据牛顿第二定律，$\frac{d\mathbf{p}_i}{dt} = \mathbf{F}_i$，其中 $\mathbf{F}_i$ 是作用在粒子 $i$ 上的总力。同时，根据速度的定义，$\frac{d\mathbf{r}_i}{dt} = \mathbf{v}_i$。代入这些关系，我们得到：
$$
\frac{dG}{dt} = \sum_{i=1}^{N} \mathbf{F}_i \cdot \mathbf{r}_i + \sum_{i=1}^{N} \mathbf{p}_i \cdot \mathbf{v}_i
$$
方程右边的第二项可以与系统的总动能 $T$ 联系起来。单个粒子的动能为 $T_i = \frac{1}{2} m_i v_i^2 = \frac{\mathbf{p}_i^2}{2m_i}$。注意到 $\mathbf{p}_i \cdot \mathbf{v}_i = (m_i \mathbf{v}_i) \cdot \mathbf{v}_i = m_i v_i^2 = 2T_i$。因此，对所有粒子求和得到 $\sum_{i=1}^{N} \mathbf{p}_i \cdot \mathbf{v}_i = 2T$，其中 $T$ 是系统的总动能。

于是，$G$ 的时间导数变为：
$$
\frac{dG}{dt} = 2T + \sum_{i=1}^{N} \mathbf{F}_i \cdot \mathbf{r}_i
$$
这个方程被称为 **瞬时维里定理 (instantaneous virial theorem)**。它是一个在任何时刻都精确成立的力学恒等式。方程右边的第二项 $\sum \mathbf{F}_i \cdot \mathbf{r}_i$ 被称为 **力的维里 (virial of the forces)**。

#### 时间平均与边界条件

瞬时关系虽然精确，但在分析天文系统（如行星系统或星团）的长期行为时，我们更关心的是其[时间平均](@entry_id:267915)性质。我们对瞬时维里定理两边取长时间平均，记为 $\langle \cdot \rangle$：
$$
\left\langle \frac{dG}{dt} \right\rangle = \left\langle 2T + \sum_{i=1}^{N} \mathbf{F}_i \cdot \mathbf{r}_i \right\rangle = 2\langle T \rangle + \left\langle \sum_{i=1}^{N} \mathbf{F}_i \cdot \mathbf{r}_i \right\rangle
$$
根据[时间平均](@entry_id:267915)的定义，$\langle \frac{dG}{dt} \rangle = \lim_{\tau \to \infty} \frac{1}{\tau} \int_0^\tau \frac{dG}{dt} dt$。由[微积分基本定理](@entry_id:201377)，这个积分等于 $\frac{G(\tau) - G(0)}{\tau}$。因此，
$$
\left\langle \frac{dG}{dt} \right\rangle = \lim_{\tau \to \infty} \frac{G(\tau) - G(0)}{\tau}
$$
这个边界项是否为零，是维里定理能否从瞬时形式简化为时间平均形式的关键。

一个使该边界项为零的充分条件是 **$G(t)$ 是有界的**。如果一个系统的所有粒子的运动都被限制在相空间的一个有限区域内——即它们的位置和动量在所有时间内都保持有限——那么 $G(t) = \sum \mathbf{p}_i \cdot \mathbf{r}_i$ 作为这些有界量的乘[积之和](@entry_id:266697)，其自身也必定是有界的。如果 $|G(t)| \le M$ 对于某个有限常数 $M$ 成立，那么 $\lim_{\tau \to \infty} \frac{|G(\tau) - G(0)|}{\tau} \le \lim_{\tau \to \infty} \frac{2M}{\tau} = 0$。因此，对于任何 **束缚系统 (bound system)**，边界项的长时间平均为零  。

这种束缚条件在天体物理学中至关重要。例如，一个稳定的行星系统，其行星既不会逃逸到无穷远，也不会坠入中心恒星，其轨道运动就是有界的。相反，如果运动是无界的，边界项可能不为零。一个简单的反例是一个以恒定动量 $\mathbf{p}_0$ 运动的[自由粒子](@entry_id:148748)。其位置为 $\mathbf{r}(t) = \mathbf{r}_0 + (\mathbf{p}_0/m)t$，维里 $G(t) = \mathbf{r}(t) \cdot \mathbf{p}_0 = \mathbf{r}_0 \cdot \mathbf{p}_0 + (p_0^2/m)t$ 随时间线性增长。此时，$\langle dG/dt \rangle = p_0^2/m \neq 0$ 。

还有一个微妙之处在于[质心运动](@entry_id:1122200)。即使系统内部是束缚的（例如，一个稳定的分子），但如果整个系统作为一个整体在空间中平移，其位置矢量 $\mathbf{r}_i$ 也会随时间[线性增长](@entry_id:157553)。可以证明，$G(t)$ 可以分解为[质心运动](@entry_id:1122200)[部分和](@entry_id:162077)相对于[质心](@entry_id:138352)的内部运动部分。只有当系统[总动量](@entry_id:173071)为零（即[质心](@entry_id:138352)静止），或者我们在[质心参考系](@entry_id:158134)中定义维里时，$G(t)$ 才不会因为整体平移而变得无界 。

综上所述，对于一个在[质心参考系](@entry_id:158134)中运动的、稳定的、束缚的系统，我们有 $\langle dG/dt \rangle = 0$。这样，[维里定理](@entry_id:146441)就呈现出其最常用和最强大的形式——**[时间平均](@entry_id:267915)标量维里定理 (time-averaged scalar virial theorem)**：
$$
2\langle T \rangle + \left\langle \sum_{i=1}^{N} \mathbf{F}_i \cdot \mathbf{r}_i \right\rangle = 0
$$
这个结果深刻地揭示了系统长期动态平衡的本质：时间平均的总动能与力的维里之间存在着精确的制衡关系 。

### 均质势下的应用

[维里定理](@entry_id:146441)的威力在处理 **均质[势函数](@entry_id:176105) (homogeneous potential function)** 时表现得淋漓尽致。一个[势函数](@entry_id:176105) $V(\mathbf{r}_1, \dots, \mathbf{r}_N)$ 如果满足 $V(\lambda\mathbf{r}_1, \dots, \lambda\mathbf{r}_N) = \lambda^k V(\mathbf{r}_1, \dots, \mathbf{r}_N)$，则称其为 $k$ 次均质函数。对于由这种保守势产生的力 $\mathbf{F}_i = -\nabla_{\mathbf{r}_i} V$，力的维里可以通过欧拉均质函数定理简化：
$$
\sum_{i=1}^{N} \mathbf{F}_i \cdot \mathbf{r}_i = \sum_{i=1}^{N} (-\nabla_{\mathbf{r}_i} V) \cdot \mathbf{r}_i = -k V
$$
在这种情况下，维里定理变为一个关于[平均动能](@entry_id:146353) $\langle T \rangle$ 和平均势能 $\langle V \rangle$ 的简洁关系：
$$
2\langle T \rangle - k\langle V \rangle = 0 \quad \text{或} \quad 2\langle T \rangle = k\langle V \rangle
$$
这为我们提供了洞察系统[能量分配](@entry_id:1124472)的强大工具。[行星科学](@entry_id:158926)中的两个核心例子是[引力势](@entry_id:160378)和[谐振子势](@entry_id:750179)  。

#### [引力](@entry_id:189550)系统（$k=-1$）

[牛顿引力](@entry_id:159796)势 $V(r) = -GMm/r$ 是 $r^{-1}$ 形式，因此它是 $k=-1$ 次的均质函数。对于一个受[引力](@entry_id:189550)束缚的系统（例如，行星绕恒星公转，或一个[自引力](@entry_id:271015)气体云），维里定理给出：
$$
2\langle T \rangle = (-1)\langle V \rangle \quad \implies \quad 2\langle T \rangle = -\langle V \rangle
$$
这个关系对任何束缚的[开普勒轨道](@entry_id:1126892)都成立，无论其[偏心率](@entry_id:266900)如何 。它揭示了[引力束缚系统](@entry_id:159344)的一些基本特性。系统的总能量 $E = T+V$ 在时间平均意义上满足：
$$
\langle E \rangle = \langle T \rangle + \langle V \rangle = \langle T \rangle + (-2\langle T \rangle) = -\langle T \rangle
$$
或者
$$
\langle E \rangle = \langle T \rangle + \langle V \rangle = \left(-\frac{1}{2}\langle V \rangle\right) + \langle V \rangle = \frac{1}{2}\langle V \rangle
$$
由于对于束缚系统，总能量 $E$ 必须为负（相对于无穷远处能量为零），我们立即推断出 $\langle V \rangle$ 必须为负，而 $\langle T \rangle$ 必须为正，这与我们的物理直觉相符。这个简单的关系是估算星团、星系乃至行星系统总质量的基础。如果能测定系统成员的速度弥散（从而估算 $\langle T \rangle$），就能通过维里定理估算其总势能，进而推断出系统的总质量。

#### [谐振子](@entry_id:155622)系统（$k=2$）

另一个重要例子是[谐振子势](@entry_id:750179) $V(r) = \frac{1}{2} k_s r^2$，它是 $k=2$ 次的均质函数（这里 $k_s$ 是劲度系数，不要与次数 $k$ 混淆）。这种势常用于描述物体在稳定平衡点附近的微小振动，例如行星内部的声波振荡模式。对于[谐振子](@entry_id:155622)系统，维里定理给出：
$$
2\langle T \rangle = 2\langle V \rangle \quad \implies \quad \langle T \rangle = \langle V \rangle
$$
这意味着在[谐振子](@entry_id:155622)系统中，[平均动能](@entry_id:146353)总是等于平均势能。系统的总能量为 $\langle E \rangle = \langle T \rangle + \langle V \rangle = 2\langle T \rangle = 2\langle V \rangle$。由于 $T$ 和 $V$ 都是正定的，总能量也为正。

### 概念辨析：维里定理与统计力学

深刻理解维里定理的应用范围，必须将其与统计力学中的概念（如[热平衡](@entry_id:157986)和能量均分）区分开来。这是一个常见的混淆点。

- **[维里定理](@entry_id:146441)是力学定理，而非统计力学定理**。如上所述，它的推导仅依赖于[牛顿运动定律](@entry_id:163846)和系统的束缚性/稳定性。它适用于单个稳定轨道，也适用于由许多粒子组成的、处于稳定（或统计平稳）状态但远未[达到热平衡](@entry_id:1132996)的系统。它不要求系统存在一个明确的温度，也不需要粒子间通过碰撞等机制交换能量 。

- **[能量均分定理](@entry_id:136972)是统计力学定理**。它指出，对于一个处于[热力学平衡](@entry_id:141660)态（温度为 $T_{eq}$）的系统，其[哈密顿量](@entry_id:144286)中每个二次型自由度（如 $\frac{1}{2}mv_x^2$ 或 $\frac{1}{2}kx^2$）的平均能量都等于 $\frac{1}{2}k_B T_{eq}$（其中 $k_B$ 是玻尔兹曼常数）。它的成立依赖于系统遍历相空间所有可及[微观态](@entry_id:147392)（[遍历性假设](@entry_id:147104)），并且需要有效的能量交换机制来建立和维持[热平衡](@entry_id:157986)。

一个典型的例子是碰撞稀少的太阳系外碎片盘。盘中粒子在[引力](@entry_id:189550)作用下可以达到一种 **[维里平衡](@entry_id:1133814) (virial equilibrium)** 状态，满足 $2\langle T \rangle + \langle V \rangle = 0$。然而，由于粒子间碰撞极其罕见，不同质量的粒子无法通过碰撞有效地交换能量来趋向共同的温度。因此，该系统虽然是[维里化](@entry_id:161222)的，但通常不满足[能量均分定理](@entry_id:136972)。维里定理因此成为研究这类碰撞[稀疏系统](@entry_id:168473)（如行星环、碎片盘、星系）动力学的核心工具，因为它不依赖于热动平衡这一严苛条件 。

### 动力学诊断工具：[维里比](@entry_id:176110)

在[行星形成](@entry_id:1129732)等动态过程中，系统很少处于完美的[平衡态](@entry_id:270364)。瞬时[维里定理](@entry_id:146441)为我们提供了一个强大的诊断工具，用于判断一个[自引力系统](@entry_id:155831)是处于收缩、膨胀还是接近平衡。为此，我们定义一个无量纲的 **瞬时[维里比](@entry_id:176110) (instantaneous virial ratio)** $Q(t)$：
$$
Q(t) = \frac{2K(t)}{|U(t)|}
$$
其中 $K(t)$ 是瞬时总动能（包括热能、[湍流](@entry_id:151300)能和宏观运动能），$U(t)$ 是瞬时总[引力势能](@entry_id:269038)（对于束缚系统 $U(t)  0$）。

这个比值的物理意义可以通过另一个形式的瞬时[维里定理](@entry_id:146441)来理解，该定理与系统的 **标量转动惯量** $I = \sum m_i r_i^2$ 联系在一起。$I$ 的二阶时间导数满足：
$$
\frac{1}{2}\frac{d^2I}{dt^2} = 2K(t) + U(t)
$$
由于 $|U(t)| = -U(t)$，我们可以将上式改写为 $2K(t) - |U(t)|$。因此：
$$
\frac{1}{2}\frac{d^2I}{dt^2} = |U(t)| \left( \frac{2K(t)}{|U(t)|} - 1 \right) = |U(t)|(Q(t) - 1)
$$
$\frac{d^2I}{dt^2}$ 的正负号反映了系统整体尺寸变化的加速度。因此，$Q(t)$ 的值直接指示了系统的动力学状态 ：

-   **$Q(t) \approx 1$**：此时 $\frac{d^2I}{dt^2} \approx 0$。动能的支撑作用恰好与[引力](@entry_id:189550)的束缚作用相平衡。系统处于或接近 **[维里平衡](@entry_id:1133814)** 状态。
-   **$Q(t)  1$**：此时 $\frac{d^2I}{dt^2}  0$。[引力](@entry_id:189550)占据主导，动能不足以支撑整个结构。系统处于 **亚维里 (sub-virial)** 状态，并将经历加速 **收缩或坍缩**。
-   **$Q(t)  1$**：此时 $\frac{d^2I}{dt^2}  0$。动能过剩，超过了[引力](@entry_id:189550)的束缚。系统处于 **超维里 (super-virial)** 状态，并将经历加速 **膨胀**。

此外，[维里比](@entry_id:176110)还能判断系统是否被[引力](@entry_id:189550)束缚。一个系统的总能量 $E = K+U = K-|U|$。要使系统束缚，必须有 $E  0$，即 $K  |U|$。用 $Q$ 表示 $K = \frac{Q|U|}{2}$，束缚条件变为 $\frac{Q|U|}{2}  |U|$，即 $Q  2$。因此，一个系统只有在 $Q  2$ 时才是[引力](@entry_id:189550)束缚的。如果 $Q \ge 2$，系统的总能量为非负，它将会解体。

### [维里定理](@entry_id:146441)在连续介质中的推广

对于行[星等](@entry_id:161778)流体天体，我们需要将[维里定理](@entry_id:146441)从离散粒子推广到连续介质。此时，压力[梯度力](@entry_id:166847)成为一种重要的[内力](@entry_id:167605)。通过对流体动量方程进行与之前类似的操作，可以推导出包含压力项的维里定理。对于一个半径为 $R$、被均匀外部压力 $P_s$ 包围的球形、[自引力](@entry_id:271015)气体云，其平衡时的[维里定理](@entry_id:146441)为：
$$
2T_{kin} + U_G + 3\int_V P \,dV - 4\pi R^3 P_s = 0
$$
这里 $T_{kin}$ 是流体的总宏观与微观动能（热能），$U_G$ 是总[引力势能](@entry_id:269038)，$\int_V P \,dV$ 是对整个体积的压力积分。方程中的压力贡献分为两部分 ：

1.  **内部压力项** $3\int_V P \,dV$：这一项来源于对整个体积的内部压力梯度的积分，代表了内部[热压力](@entry_id:202761)提供的向外的支撑作用。系数 3 源于空间的三维性（$\nabla \cdot \mathbf{r} = 3$），与气体的状态方程无关。

2.  **表面压力项** $-4\pi R^3 P_s$：这一项来源于作用在天体表面的外部压强，代表了周围环境对天体的压缩和束缚作用。它来自于对边界的[曲面积分](@entry_id:144805)，对于任意形状的天体，其推广形式为 $-3P_s V_{total}$。

这个更完整的形式对于研究[行星大气](@entry_id:148668)的稳定性和[行星内部](@entry_id:1129737)结构至关重要，它量化了热压力和外部边界条件如何与[引力](@entry_id:189550)共同决定天体的平衡结构。

### [张量维里定理](@entry_id:159872)

标量维里定理描述的是系统整体的能量平衡。然而，对于非球形或旋转的天体，我们需要一个更强大的工具来描述其形状和[内部流动](@entry_id:155636)的约束。这就是 **[张量维里定理](@entry_id:159872) (tensor virial theorem)**。

通过将维里 $G$ 推广为张量形式，并沿用类似的推导，可以得到一个 $3 \times 3$ 的张量方程。对于一个处于稳定状态的[孤立系统](@entry_id:159201)，该方程为：
$$
2T_{ij} + \mathcal{W}_{ij} + \Pi_{ij} = 0
$$
其中 $T_{ij} = \frac{1}{2}\int \rho v_i v_j dV$ 是 **动能张量**，$ \mathcal{W}_{ij}$ 是 **[引力势能](@entry_id:269038)张量**，$\Pi_{ij} = \delta_{ij} \int P dV$ 是 **[各向同性压力](@entry_id:269937)张量**。

- **对角[线元](@entry_id:196833)素 (Trace)**：将这个张量方程的对角[线元](@entry_id:196833)素相加（即取迹），我们会发现 $T_{ii}$ 的和变回总动能的两倍，$ \mathcal{W}_{ii}$ 的和变回总引力势能，$\Pi_{ii}$ 的和变回 $3\int P dV$。这样一来，张量方程的迹精确地还原为我们之前讨论的标量[维里定理](@entry_id:146441)。这意味着标量定理蕴含在张量定理之中 。

- **非对角[线元](@entry_id:196833)素**：张量定理的真正威力在于其非对角线元素。在一个天体的[主轴](@entry_id:172691)坐标系中，根据定义，[惯性张量](@entry_id:148659)和[引力势能](@entry_id:269038)张量都是对角的。在这种情况下，非对角线方程简化为 $2T_{ij}=0$（对于 $i \neq j$）。这意味着 $\int \rho v_i v_j dV = 0$。这个条件要求系统内部不能存在[稳态](@entry_id:139253)的大尺度[剪切流](@entry_id:266817)或[湍流](@entry_id:151300)，否则这些流动产生的雷诺胁强（[动量通量](@entry_id:199796)）将无法被平衡，导致天体变形。因此，非对角线方程为稳定、旋转或非球形天体的允许内部结构和流动状态提供了极其严格的动力学约束 。

总之，维里定理从一个简单的力学恒等式出发，发展成为行星科学和天体物理学中分析[系统稳定性](@entry_id:273248)、动力学演化和内部结构的核心理论工具。