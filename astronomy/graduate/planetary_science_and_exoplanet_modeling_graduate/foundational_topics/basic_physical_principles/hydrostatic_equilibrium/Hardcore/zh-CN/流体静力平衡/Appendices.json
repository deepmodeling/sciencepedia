{
    "hands_on_practices": [
        {
            "introduction": "本章的实践练习旨在通过一系列从易到难的计算，加深您对静流平衡在行星结构建模中应用的理解。我们从一个最基础的模型开始：一个密度均匀的球体。通过从第一性原理出发，为这个理想化的行星推导其内部压力分布，您将掌握求解静流平衡问题的核心分析方法，并直观地理解引力、密度和压力之间的基本关系。",
            "id": "4163753",
            "problem": "考虑一个不旋转的、球对称的系外行星内部模型，其中体密度是均匀的，对于 $0 \\le r \\le R$，$\\rho$ 为一个常数。假设牛顿引力，其中球体内半径 $r$ 处的局部引力加速度由其内部包含的质量 $M(r)$ 决定，关系式为 $g(r) = G M(r) / r^{2}$，并且包含的质量遵循标准的质量连续性关系 $\\mathrm{d}M/\\mathrm{d}r = 4 \\pi r^{2} \\rho$，且 $M(0) = 0$。行星内部处于静水力学平衡状态，其中压力 $P(r)$ 满足径向力平衡方程 $\\mathrm{d}P/\\mathrm{d}r = - \\rho \\, g(r)$。施加物理上真实的边界条件，即表面压力为零，$P(R) = 0$。推导在 $0 \\le r \\le R$ 范围内压力分布 $P(r)$ 的闭合形式解析表达式，用 $G$、$\\rho$、$R$ 和 $r$ 表示。请以单个显式符号表达式（不含积分）的形式给出最终结果；不要进行任何数值计算。",
            "solution": "问题陈述已经过验证，被认为是科学上合理的、适定的和客观的。它提供了一套完整且一致的方程和边界条件，用于在一个简化的行星内部模型中推导压力分布。该问题是静水力学平衡中的一个标准练习，没有任何使其无效的缺陷。\n\n目标是推导一个密度均匀（为 $\\rho$）、半径为 $R$ 的自引力球体内部的压力分布表达式 $P(r)$。推导过程分为三个主要步骤：首先，确定半径 $r$ 内包含的质量 $M(r)$；其次，求出引力加速度 $g(r)$；第三，积分静水力学平衡方程以求得 $P(r)$。\n\n第一步是求出半径 $r$ ($0 \\le r \\le R$) 内包含的质量 $M(r)$。问题给出了质量连续性关系：\n$$ \\frac{\\mathrm{d}M}{\\mathrm{d}r} = 4 \\pi r^{2} \\rho $$\n这个常微分方程可以通过从中心（$r=0$ 且 $M=0$）到任意半径 $r$ 的直接积分来求解。由于密度 $\\rho$ 是一个给定的常数：\n$$ M(r) = \\int_{0}^{r} \\frac{\\mathrm{d}M}{\\mathrm{d}r'} \\, \\mathrm{d}r' = \\int_{0}^{r} 4 \\pi (r')^{2} \\rho \\, \\mathrm{d}r' $$\n$$ M(r) = 4 \\pi \\rho \\int_{0}^{r} (r')^{2} \\, \\mathrm{d}r' = 4 \\pi \\rho \\left[ \\frac{(r')^{3}}{3} \\right]_{0}^{r} $$\n$$ M(r) = \\frac{4}{3} \\pi \\rho r^{3} $$\n这个结果证实了所包含的质量就是半径为 $r$ 的球体体积乘以常数密度 $\\rho$。\n\n第二步是确定半径 $r$ 处的局部引力加速度 $g(r)$。问题指出，这遵循适用于所包含质量的牛顿引力：\n$$ g(r) = \\frac{G M(r)}{r^{2}} $$\n代入上面推导出的 $M(r)$ 表达式，得到：\n$$ g(r) = \\frac{G}{r^{2}} \\left( \\frac{4}{3} \\pi \\rho r^{3} \\right) = \\frac{4}{3} \\pi G \\rho r $$\n这表明，在均匀球体内部，引力加速度随离中心距离的增加而线性增加。\n\n第三步也是最后一步是求解压力分布 $P(r)$。该行星处于静水力学平衡状态，满足方程：\n$$ \\frac{\\mathrm{d}P}{\\mathrm{d}r} = - \\rho \\, g(r) $$\n负号表示压力必须向中心方向增加，以抵消向内的引力。代入 $g(r)$ 的表达式：\n$$ \\frac{\\mathrm{d}P}{\\mathrm{d}r} = - \\rho \\left( \\frac{4}{3} \\pi G \\rho r \\right) = - \\frac{4}{3} \\pi G \\rho^{2} r $$\n为了求出 $P(r)$，我们将此方程对 $r$ 进行积分：\n$$ P(r) = \\int \\left( - \\frac{4}{3} \\pi G \\rho^{2} r \\right) \\mathrm{d}r = - \\frac{4}{3} \\pi G \\rho^{2} \\int r \\, \\mathrm{d}r $$\n$$ P(r) = - \\frac{4}{3} \\pi G \\rho^{2} \\frac{r^{2}}{2} + C = - \\frac{2}{3} \\pi G \\rho^{2} r^{2} + C $$\n其中 $C$ 是积分常数。为了确定 $C$，我们应用边界条件，即行星表面（$r=R$）的压力为零，即 $P(R) = 0$。\n$$ P(R) = - \\frac{2}{3} \\pi G \\rho^{2} R^{2} + C = 0 $$\n解出 $C$，我们得到：\n$$ C = \\frac{2}{3} \\pi G \\rho^{2} R^{2} $$\n将 $C$ 的值代回 $P(r)$ 的通解表达式中：\n$$ P(r) = - \\frac{2}{3} \\pi G \\rho^{2} r^{2} + \\frac{2}{3} \\pi G \\rho^{2} R^{2} $$\n提出公因子，得到压力分布的最终闭合形式解析表达式：\n$$ P(r) = \\frac{2}{3} \\pi G \\rho^{2} (R^{2} - r^{2}) $$\n该表达式给出了在系外行星模型中，对于 $0 \\le r \\le R$ 范围内任意半径 $r$ 处的压力，以给定的物理常数和参数表示。",
            "answer": "$$\\boxed{\\frac{2}{3} \\pi G \\rho^{2} (R^{2} - r^{2})}$$"
        },
        {
            "introduction": "在掌握了均匀密度模型后，我们向更真实的情景迈进，考虑一个密度从中心向外递减的行星模型。现实世界中的行星由于压缩和成分分异，其密度并非恒定。本练习引入了一个更复杂的密度剖面函数，要求您将静流平衡的基本原理应用于非均匀介质，从而锻炼处理更贴近实际模型的数学和物理能力。",
            "id": "4163734",
            "problem": "一个具有球对称内部结构且外部大气压可忽略不计的系外行星，被建模为一个处于流体静力学平衡状态的静态、各向同性流体。其密度随半径变化的函数关系为 $\\rho(r) = \\rho_{c}\\left[1 - \\left(\\frac{r}{R}\\right)^{\\alpha}\\right]$（$0 \\le r \\le R$），其中中心密度 $\\rho_{c} > 0$，行星半径 $R > 0$，参数 $\\alpha > 0$。在 $r = R$ 之外，密度为零。仅从基本定律——Newton 引力定律和局部力平衡——出发，推导出行星内部的引力加速度 $g(r)$ 以及对应的压强 $P(r)$ 的流体静力学平衡方程。然后，在边界条件 $P(R) = 0$ 下，通过积分求得压强分布 $P(r)$，并验证 $P(r)$ 的物理合理性（在 $r = 0$ 处为有限值，在 $0 \\le r < R$ 内为正值，并且随 $r$ 严格递减）。最后，给出无量纲中心压强\n$$\n\\frac{P(0)}{G \\rho_{c}^{2} R^{2}}\n$$\n作为 $\\alpha$ 函数的闭合形式表达式。将最终答案表示为单一的精确解析表达式，无需进行数值计算。最终表达式中不要包含单位，也不要四舍五入。",
            "solution": "本题要求在给定特定密度分布的情况下，确定一个处于流体静力学平衡状态的球对称系外行星的压强分布和中心压强。解答需要从基本原理出发。\n\n**步骤1：问题验证**\n\n给定条件如下：\n- 球对称、静态、各向同性的流体处于流体静力学平衡状态。\n- 密度分布：$\\rho(r) = \\rho_{c}\\left[1 - \\left(\\frac{r}{R}\\right)^{\\alpha}\\right]$，$0 \\le r \\le R$。\n- 当 $r > R$ 时，$\\rho(r) = 0$。\n- 中心密度 $\\rho_{c} > 0$，半径 $R > 0$，参数 $\\alpha > 0$。\n- 边界条件：表面压强为零，$P(R) = 0$。\n- 任务是推导引力加速度 $g(r)$、流体静力学平衡方程、压强分布 $P(r)$，验证其物理合理性，并求出无量纲中心压强 $\\frac{P(0)}{G \\rho_{c}^{2} R^{2}}$。\n\n该问题在科学上基于牛顿引力和流体力学。这是一个定义明确的问题，具有充分的信息和清晰的目标。语言精确客观。对于 $\\alpha > 0$，该密度模型是一个有效的物理理想化模型。该问题不违反任何无效性标准。因此，该问题是有效的，我们开始求解。\n\n**步骤2：引力加速度 $g(r)$ 的推导**\n\n根据球对称质量分布的 Newton 引力定律（Gauss 引力定律的一个推论），行星内部半径 $r$ 处的引力加速度 $g(r)$ 仅取决于该半径内包含的质量 $M(r)$。\n$$\ng(r) = \\frac{G M(r)}{r^2}\n$$\n包含的质量 $M(r)$ 通过对半径为 $r$ 的球体体积内的密度 $\\rho(r')$ 进行积分得到。\n$$\nM(r) = \\int_0^r \\rho(r') 4 \\pi (r')^2 dr'\n$$\n代入给定的密度分布 $\\rho(r') = \\rho_{c}\\left[1 - \\left(\\frac{r'}{R}\\right)^{\\alpha}\\right]$：\n$$\nM(r) = \\int_0^r \\rho_{c}\\left[1 - \\left(\\frac{r'}{R}\\right)^{\\alpha}\\right] 4 \\pi (r')^2 dr'\n$$\n$$\nM(r) = 4 \\pi \\rho_c \\int_0^r \\left( (r')^2 - \\frac{(r')^{2+\\alpha}}{R^{\\alpha}} \\right) dr'\n$$\n进行积分：\n$$\nM(r) = 4 \\pi \\rho_c \\left[ \\frac{(r')^3}{3} - \\frac{(r')^{3+\\alpha}}{(3+\\alpha)R^{\\alpha}} \\right]_0^r\n$$\n$$\nM(r) = 4 \\pi \\rho_c \\left( \\frac{r^3}{3} - \\frac{r^{3+\\alpha}}{(3+\\alpha)R^{\\alpha}} \\right)\n$$\n现在，我们将 $M(r)$ 的表达式代入 $g(r)$ 的方程中：\n$$\ng(r) = \\frac{G}{r^2} \\left[ 4 \\pi \\rho_c \\left( \\frac{r^3}{3} - \\frac{r^{3+\\alpha}}{(3+\\alpha)R^{\\alpha}} \\right) \\right]\n$$\n$$\ng(r) = 4 \\pi G \\rho_c \\left( \\frac{r}{3} - \\frac{r^{1+\\alpha}}{(3+\\alpha)R^{\\alpha}} \\right)\n$$\n这就是行星内部引力加速度随半径变化的函数。\n\n**步骤3：流体静力学平衡方程和压强分布 $P(r)$**\n\n对于引力场中的静态流体，流体静力学平衡条件要求作用在流体元上的向上压强梯度力与向下的引力相平衡。对于位于半径 $r$ 处、面积为 $A$、厚度为 $dr$ 的微小流体元，该力平衡可表示为：\n$$\n(P(r) - P(r+dr))A - g(r) dm = 0\n$$\n其中 $dm = \\rho(r) A dr$ 是流体元的质量。使用导数的定义 $P(r+dr) - P(r) \\approx \\frac{dP}{dr}dr$，我们得到流体静力学平衡方程：\n$$\n\\frac{dP}{dr} = -g(r) \\rho(r)\n$$\n为求得压强分布 $P(r)$，我们将此方程从半径 $r$ 积分到行星表面 $R$。\n$$\n\\int_{P(r)}^{P(R)} dP' = - \\int_r^R g(r') \\rho(r') dr'\n$$\n给定边界条件 $P(R) = 0$，方程变为：\n$$\n0 - P(r) = - \\int_r^R g(r') \\rho(r') dr' \\quad \\implies \\quad P(r) = \\int_r^R g(r') \\rho(r') dr'\n$$\n我们现在代入 $g(r')$ 和 $\\rho(r')$ 的表达式。\n$$\ng(r')\\rho(r') = 4 \\pi G \\rho_c \\left( \\frac{r'}{3} - \\frac{(r')^{1+\\alpha}}{(3+\\alpha)R^{\\alpha}} \\right) \\times \\rho_c \\left( 1 - \\frac{(r')^{\\alpha}}{R^{\\alpha}} \\right)\n$$\n$$\ng(r')\\rho(r') = 4 \\pi G \\rho_c^2 \\left[ \\frac{r'}{3} - \\frac{(r')^{1+\\alpha}}{3R^{\\alpha}} - \\frac{(r')^{1+\\alpha}}{(3+\\alpha)R^{\\alpha}} + \\frac{(r')^{1+2\\alpha}}{(3+\\alpha)R^{2\\alpha}} \\right]\n$$\n合并中间项：$\\frac{1}{3} + \\frac{1}{3+\\alpha} = \\frac{3+\\alpha+3}{3(3+\\alpha)} = \\frac{6+\\alpha}{3(3+\\alpha)}$。\n$$\ng(r')\\rho(r') = 4 \\pi G \\rho_c^2 \\left[ \\frac{r'}{3} - \\frac{6+\\alpha}{3(3+\\alpha)} \\frac{(r')^{1+\\alpha}}{R^{\\alpha}} + \\frac{1}{3+\\alpha} \\frac{(r')^{1+2\\alpha}}{R^{2\\alpha}} \\right]\n$$\n现在我们对该乘积从 $r$ 到 $R$ 进行积分以求得 $P(r)$。对于最终结果，我们关心的是中心压强 $P(0)$，因此我们将积分下限设为 $0$，上限设为 $R$。\n$$\nP(0) = \\int_0^R g(r') \\rho(r') dr'\n$$\n$$\nP(0) = 4 \\pi G \\rho_c^2 \\int_0^R \\left[ \\frac{r'}{3} - \\frac{6+\\alpha}{3(3+\\alpha)R^{\\alpha}} (r')^{1+\\alpha} + \\frac{1}{(3+\\alpha)R^{2\\alpha}} (r')^{1+2\\alpha} \\right] dr'\n$$\n逐项计算积分：\n$$\n\\int_0^R \\frac{r'}{3} dr' = \\left[ \\frac{(r')^2}{6} \\right]_0^R = \\frac{R^2}{6}\n$$\n$$\n\\int_0^R - \\frac{6+\\alpha}{3(3+\\alpha)R^{\\alpha}} (r')^{1+\\alpha} dr' = - \\frac{6+\\alpha}{3(3+\\alpha)R^{\\alpha}} \\left[ \\frac{(r')^{2+\\alpha}}{2+\\alpha} \\right]_0^R = - \\frac{6+\\alpha}{3(3+\\alpha)(2+\\alpha)} \\frac{R^{2+\\alpha}}{R^{\\alpha}} = - \\frac{R^2(6+\\alpha)}{3(2+\\alpha)(3+\\alpha)}\n$$\n$$\n\\int_0^R \\frac{1}{(3+\\alpha)R^{2\\alpha}} (r')^{1+2\\alpha} dr' = \\frac{1}{(3+\\alpha)R^{2\\alpha}} \\left[ \\frac{(r')^{2+2\\alpha}}{2+2\\alpha} \\right]_0^R = \\frac{1}{(3+\\alpha)2(1+\\alpha)} \\frac{R^{2+2\\alpha}}{R^{2\\alpha}} = \\frac{R^2}{2(1+\\alpha)(3+\\alpha)}\n$$\n将这些结果相加，我们得到 $P(0)$：\n$$\nP(0) = 4 \\pi G \\rho_c^2 \\left[ \\frac{R^2}{6} - \\frac{R^2(6+\\alpha)}{3(2+\\alpha)(3+\\alpha)} + \\frac{R^2}{2(1+\\alpha)(3+\\alpha)} \\right]\n$$\n\n**步骤4：$P(r)$ 的物理合理性**\n\n- **在 $r=0$ 处为有限值**：我们得到的 $P(0)$ 表达式是一个有限值，因为对于 $\\alpha > 0$，所有项都是良定义的。\n- **随 $r$ 严格递减**：压强梯度为 $\\frac{dP}{dr} = -g(r)\\rho(r)$。对于 $0 < r < R$：\n  - $\\rho(r) = \\rho_c(1 - (r/R)^\\alpha) > 0$，因为 $r/R < 1$ 且 $\\alpha > 0$。\n  - $g(r) = 4 \\pi G \\rho_c \\frac{r}{3} \\left( 1 - \\frac{3}{3+\\alpha} (\\frac{r}{R})^\\alpha \\right)$。因为 $\\alpha > 0$，我们有 $3+\\alpha > 3$，所以 $\\frac{3}{3+\\alpha} < 1$。并且，$(r/R)^\\alpha < 1$。因此，项 $\\frac{3}{3+\\alpha} (\\frac{r}{R})^\\alpha < 1$，这保证了对于 $r \\in (0, R]$，$g(r) > 0$。\n  - 由于对于 $0 < r < R$，$g(r) > 0$ 且 $\\rho(r) > 0$，它们的乘积为正，因此 $\\frac{dP}{dr} < 0$。所以，$P(r)$ 是 $r$ 的一个严格递减函数。\n- **在 $0 \\le r < R$ 内为正值**：由于 $P(r)$ 在 $[0, R)$ 上是严格递减的，并且 $P(R)=0$，那么对于区间 $[0, R)$ 内的所有 $r$，必有 $P(r) > P(R)=0$。\n该压强分布是物理上合理的。\n\n**步骤5：无量纲中心压强**\n\n从 $P(0)$ 的表达式中，我们可以求出所需的无量纲量：\n$$\n\\frac{P(0)}{G \\rho_{c}^{2} R^{2}} = 4 \\pi \\left[ \\frac{1}{6} - \\frac{6+\\alpha}{3(2+\\alpha)(3+\\alpha)} + \\frac{1}{2(1+\\alpha)(3+\\alpha)} \\right]\n$$\n为了简化方括号中的表达式，我们找到一个公分母，即 $6(1+\\alpha)(2+\\alpha)(3+\\alpha)$。\n$$\n\\frac{P(0)}{G \\rho_{c}^{2} R^{2}} = 4 \\pi \\left[ \\frac{(1+\\alpha)(2+\\alpha)(3+\\alpha) - 2(1+\\alpha)(6+\\alpha) + 3(2+\\alpha)}{6(1+\\alpha)(2+\\alpha)(3+\\alpha)} \\right]\n$$\n现在，我们展开分子中的各项：\n- $(1+\\alpha)(2+\\alpha)(3+\\alpha) = (\\alpha^2+3\\alpha+2)(3+\\alpha) = \\alpha^3+3\\alpha^2+3\\alpha^2+9\\alpha+2\\alpha+6 = \\alpha^3+6\\alpha^2+11\\alpha+6$。\n- $-2(1+\\alpha)(6+\\alpha) = -2(\\alpha^2+7\\alpha+6) = -2\\alpha^2-14\\alpha-12$。\n- $3(2+\\alpha) = 6+3\\alpha$。\n将分子各项相加：\n$$\n(\\alpha^3+6\\alpha^2+11\\alpha+6) + (-2\\alpha^2-14\\alpha-12) + (6+3\\alpha) = \\alpha^3 + (6-2)\\alpha^2 + (11-14+3)\\alpha + (6-12+6)\n$$\n$$\n= \\alpha^3 + 4\\alpha^2 + 0\\alpha + 0 = \\alpha^2(\\alpha+4)\n$$\n将此结果代回无量纲压强的表达式中：\n$$\n\\frac{P(0)}{G \\rho_{c}^{2} R^{2}} = 4 \\pi \\left( \\frac{\\alpha^2(\\alpha+4)}{6(1+\\alpha)(2+\\alpha)(3+\\alpha)} \\right)\n$$\n简化数值前因子 $4/6 = 2/3$：\n$$\n\\frac{P(0)}{G \\rho_{c}^{2} R^{2}} = \\frac{2\\pi}{3} \\frac{\\alpha^2(\\alpha+4)}{(1+\\alpha)(2+\\alpha)(3+\\alpha)}\n$$\n这就是最终的闭合形式表达式。",
            "answer": "$$\n\\boxed{\\frac{2\\pi}{3} \\frac{\\alpha^2(\\alpha+4)}{(\\alpha+1)(\\alpha+2)(\\alpha+3)}}\n$$"
        },
        {
            "introduction": "虽然解析解对于理解物理概念至关重要，但现代行星科学严重依赖数值计算来处理无法解析求解的复杂状态方程。本练习将引导您进入数值建模的世界，通过求解描述多方球模型的莱恩-埃姆登方程（Lane-Emden equation）。您将通过编写代码来数值求解这个经典的微分方程，从而将物理参数（如多方常数 $K$ 和中心密度 $\\rho_c$）与行星的宏观属性（如半径 $R$）联系起来，这是行星内部结构建模的一项关键技能。",
            "id": "4163806",
            "problem": "考虑一个自引力的、球对称的流体球，其多方物态方程为 $P = K \\rho^{1 + 1/n}$，其中 $P$ 是压强，$\\rho$ 是质量密度，$K$ 是多方常数，$n$ 是多方指数。假设牛顿引力和静流体平衡，其中力平衡由 $dP/dr = -\\rho G M(r) / r^2$ 决定，质量连续性由 $dM/dr = 4 \\pi r^2 \\rho$ 决定，其中 $G$ 为引力常数，$M(r)$ 为半径 $r$ 内包含的质量。在本问题中，我们将专门研究指数 $n=1$ 的情况，这与静流体平衡下的行星科学和系外行星内部建模相关。\n\n从给定的基本定律和定义出发，为指数 $n=1$ 的多方体推导无量纲常微分方程 (ODE)，即莱恩-埃姆登方程。通过变换 $\\rho(r) = \\rho_c \\theta(\\xi)^n$ 和 $r = a \\xi$ 定义无量纲函数 $\\theta(\\xi)$ 和相似长度尺度 $a$，其中 $\\rho_c$ 是中心密度。应用中心的正则性条件 $\\theta(0) = 1$ 和 $d\\theta/d\\xi \\big|_{\\xi=0} = 0$，并使用在 $\\xi=0$ 附近的级数展开来初始化数值积分。\n\n您必须实现一个数值求解器来：\n- 从一个小的正值 $\\xi$ 开始，向外积分 $n=1$ 的莱恩-埃姆登 ODE，直到 $\\theta(\\xi)$ 的第一个零点 $\\xi_1$。\n- 使用推导出的连接相似长度 $a$与物理参数 $(K, \\rho_c)$ 和常数的关系式，计算物理半径 $R = a \\xi_1$。\n\n所有量必须以国际单位制 (SI) 处理。使用 $G = 6.67430 \\times 10^{-11} \\, \\mathrm{m^3 \\, kg^{-1} \\, s^{-2}}$。对于 $n=1$，$K$ 的国际单位制单位是 $\\mathrm{m^5 \\, kg^{-1} \\, s^{-2}}$，$\\rho_c$ 的国际单位制单位是 $\\mathrm{kg \\, m^{-3}}$。最终半径 $R$ 以米表示，并四舍五入到三位有效数字。\n\n测试集：\n- 情况 1：$(K, \\rho_c) = (10^3, 10^3)$。\n- 情况 2：$(K, \\rho_c) = (10^5, 5 \\times 10^3)$。\n- 情况 3：$(K, \\rho_c) = (10^7, 2 \\times 10^3)$。\n- 情况 4：$(K, \\rho_c) = (10^3, 3 \\times 10^2)$。\n\n您的程序必须：\n- 通过对 $n=1$ 的莱恩-埃姆登 ODE 进行积分，并使用指定的中心正则性条件和在 $\\xi=0$ 附近的级数展开起点，来数值确定 $\\xi_1$。\n- 为每个测试用例计算 $R$，并以米为单位，将结果作为浮点数（四舍五入到三位有效数字）返回。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4]$），其中每个 $r_i$ 是相应测试用例的半径，以米为单位，四舍五入到三位有效数字。",
            "solution": "对问题陈述的有效性进行评估。\n\n### 步骤 1：提取已知条件\n- **物态方程**：多方，$P = K \\rho^{1 + 1/n}$。\n- **特殊情况**：多方指数 $n=1$。\n- **控制方程**：\n    - 静流体平衡：$dP/dr = -\\rho G M(r) / r^2$。\n    - 质量连续性：$dM/dr = 4 \\pi r^2 \\rho$。\n- **定义**：\n    - $P$：压强\n    - $\\rho$：质量密度\n    - $K$：多方常数\n    - $n$：多方指数\n    - $r$：径向坐标\n    - $G$：引力常数\n    - $M(r)$：半径 $r$ 内包含的质量。\n- **无量纲变换**：\n    - $\\rho(r) = \\rho_c \\theta(\\xi)^n$\n    - $r = a \\xi$\n    - $\\rho_c$：中心密度。\n    - $\\theta(\\xi)$：无量纲函数。\n    - $a$：相似长度尺度。\n- **边界条件**：\n    - 中心正则性：$\\theta(0) = 1$ 和 $d\\theta/d\\xi \\big|_{\\xi=0} = 0$。\n- **常数**：\n    - 引力常数：$G = 6.67430 \\times 10^{-11} \\, \\mathrm{m^3 \\, kg^{-1} \\, s^{-2}}$。\n- **任务要求**：\n    1. 为 $n=1$ 推导莱恩-埃姆登 ODE。\n    2. 从一个小的正值 $\\xi$（用级数展开初始化）开始对 ODE 进行数值积分，以找到第一个零点 $\\xi_1$。\n    3. 为给定的测试用例计算物理半径 $R = a \\xi_1$。\n    4. 以米为单位表示 $R$，并四舍五入到三位有效数字。\n- **测试集**：\n    - 情况 1：$(K, \\rho_c) = (10^3 \\, \\mathrm{m^5 \\, kg^{-1} \\, s^{-2}}, 10^3 \\, \\mathrm{kg \\, m^{-3}})$。\n    - 情况 2：$(K, \\rho_c) = (10^5 \\, \\mathrm{m^5 \\, kg^{-1} \\, s^{-2}}, 5 \\times 10^3 \\, \\mathrm{kg \\, m^{-3}})$。\n    - 情况 3：$(K, \\rho_c) = (10^7 \\, \\mathrm{m^5 \\, kg^{-1} \\, s^{-2}}, 2 \\times 10^3 \\, \\mathrm{kg \\, m^{-3}})$。\n    - 情况 4：$(K, \\rho_c) = (10^3 \\, \\mathrm{m^5 \\, kg^{-1} \\, s^{-2}}, 3 \\times 10^2 \\, \\mathrm{kg \\, m^{-3}})$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于自引力多方流体的标准牛顿模型，这是恒星结构和行星内部建模的基石。所涉及的方程和概念是天体物理学的基础。问题有效。\n- **适定性**：该问题提供了一整套方程、边界条件和常数，以确定指定对象结构的唯一解。任务定义明确。问题有效。\n- **客观性**：语言精确且定量。所有术语均为领域内的标准术语。问题有效。\n\n该问题没有表现出任何缺陷，例如科学上的不合理性、信息缺失或歧义。它是理论天体物理学中一个标准的可解问题。\n\n### 步骤 3：结论与行动\n问题是**有效的**。开始解答。\n\n### 莱恩-埃姆登方程的推导\n分析从球对称和静流体平衡假设下的恒星结构基本方程开始。静流体平衡方程是\n$$ \\frac{dP}{dr} = -\\frac{G M(r) \\rho(r)}{r^2} $$\n质量连续性方程是\n$$ \\frac{dM(r)}{dr} = 4 \\pi r^2 \\rho(r) $$\n为了获得一个单一的二阶微分方程，我们首先对静流体平衡方程进行重排然后求导：\n$$ \\frac{r^2}{\\rho} \\frac{dP}{dr} = -G M(r) $$\n$$ \\frac{d}{dr}\\left(\\frac{r^2}{\\rho} \\frac{dP}{dr}\\right) = -G \\frac{dM}{dr} $$\n将质量连续性方程代入右侧，得到一个关联压强和密度的组合方程：\n$$ \\frac{d}{dr}\\left(\\frac{r^2}{\\rho} \\frac{dP}{dr}\\right) = -G (4 \\pi r^2 \\rho) $$\n两边除以 $r^2$ 得到结构方程，它等价于引力势的泊松方程：\n$$ \\frac{1}{r^2}\\frac{d}{dr}\\left(\\frac{r^2}{\\rho} \\frac{dP}{dr}\\right) = -4 \\pi G \\rho $$\n接下来，我们引入多方物态方程 $P = K\\rho^{1+1/n}$。压强梯度为\n$$ \\frac{dP}{dr} = K\\left(1+\\frac{1}{n}\\right)\\rho^{1/n}\\frac{d\\rho}{dr} $$\n将此代入结构方程：\n$$ \\frac{1}{r^2}\\frac{d}{dr}\\left(\\frac{r^2}{\\rho} \\cdot K\\left(1+\\frac{1}{n}\\right)\\rho^{1/n}\\frac{d\\rho}{dr}\\right) = -4 \\pi G \\rho $$\n$$ \\frac{K(n+1)}{n}\\frac{1}{r^2}\\frac{d}{dr}\\left(r^2 \\rho^{(1/n) - 1}\\frac{d\\rho}{dr}\\right) = -4 \\pi G \\rho $$\n现在，我们引入无量纲变量 $\\rho(r) = \\rho_c \\theta(\\xi)^n$ 和 $r = a \\xi$，其中 $\\rho_c$ 是中心密度，$a$ 是一个特征长度尺度。导数变换如下：\n$$ \\frac{d\\rho}{dr} = \\frac{d\\rho}{d\\theta}\\frac{d\\theta}{d\\xi}\\frac{d\\xi}{dr} = (\\rho_c n \\theta^{n-1})\\left(\\frac{d\\theta}{d\\xi}\\right)\\left(\\frac{1}{a}\\right) $$\n将这些代入方程得到：\n$$ \\frac{K(n+1)}{n}\\frac{1}{a^2 \\xi^2}\\frac{d}{a d\\xi}\\left( (a\\xi)^2 (\\rho_c \\theta^n)^{(1-n)/n} \\frac{\\rho_c n \\theta^{n-1}}{a}\\frac{d\\theta}{d\\xi} \\right) = -4 \\pi G \\rho_c\\theta^n $$\n化简后，表达式变为：\n$$ \\left[\\frac{(n+1)K \\rho_c^{(1/n)-1}}{4 \\pi G a^2}\\right] \\frac{1}{\\xi^2}\\frac{d}{d\\xi}\\left(\\xi^2\\frac{d\\theta}{d\\xi}\\right) = - \\theta^n $$\n选择长度尺度 $a$ 使括号中的项等于 1：\n$$ a^2 = \\frac{(n+1)K \\rho_c^{(1-n)/n}}{4 \\pi G} \\implies a = \\left[\\frac{(n+1)K}{4\\pi G}\\right]^{1/2}\\rho_c^{(1-n)/(2n)} $$\n通过这种选择，我们得到了通用的莱恩-埃姆登方程：\n$$ \\frac{1}{\\xi^2}\\frac{d}{d\\xi}\\left(\\xi^2\\frac{d\\theta}{d\\xi}\\right) + \\theta^n = 0 $$\n对于 $n=1$ 的特殊情况，长度尺度 $a$ 的方程显著简化，因为涉及 $\\rho_c$ 的项消失了：\n$$ a = \\left[\\frac{(1+1)K}{4\\pi G}\\right]^{1/2}\\rho_c^{(1-1)/2} = \\sqrt{\\frac{2K}{4\\pi G}} = \\sqrt{\\frac{K}{2\\pi G}} $$\n$n=1$ 的莱恩-埃姆登方程为：\n$$ \\frac{1}{\\xi^2}\\frac{d}{d\\xi}\\left(\\xi^2\\frac{d\\theta}{d\\xi}\\right) + \\theta = 0 $$\n也可以写成 $\\xi^2\\theta'' + 2\\xi\\theta' + \\xi^2\\theta = 0$。\n\n### 数值解策略\n$n=1$ 的莱恩-埃姆登方程是一个二阶常微分方程。这个特殊情况有一个众所周知的解析解 $\\theta(\\xi) = \\frac{\\sin(\\xi)}{\\xi}$，它满足边界条件 $\\theta(0)=1$ 和 $\\theta'(0)=0$。第一个零点 $\\xi_1$ 是密度和压强变为零的地方，对应于 $\\sin(\\xi)$ 的第一个非平凡根，即 $\\xi_1=\\pi$。物理半径为 $R=a\\xi_1$。\n\n尽管存在解析解，但问题要求数值解。为了进行数值求解，我们首先将二阶 ODE 转换为一个由两个一阶 ODE 组成的方程组。设 $y_0 = \\theta$ 和 $y_1 = \\theta' = d\\theta/d\\xi$。该方程组为：\n$$ \\frac{dy_0}{d\\xi} = y_1 $$\n$$ \\frac{dy_1}{d\\xi} = -\\frac{2}{\\xi}y_1 - y_0 $$\n由于 $1/\\xi$ 项的存在，在 $\\xi=0$ 处有一个奇点。我们不能从 $\\xi=0$ 开始积分。因此，我们使用 $\\theta(\\xi)$ 在 $\\xi=0$ 附近的级数展开，以在一个小的、非零的 $\\xi_{start}$ 处找到初始值。通用级数解的形式为 $\\theta(\\xi) = \\sum_{k=0}^{\\infty} c_k \\xi^k$。应用边界条件，发现 $n=1$ 情况的级数为：\n$$ \\theta(\\xi) = 1 - \\frac{1}{6}\\xi^2 + \\frac{1}{120}\\xi^4 - \\dots $$\n其导数为：\n$$ \\theta'(\\xi) = -\\frac{1}{3}\\xi + \\frac{1}{30}\\xi^3 - \\dots $$\n我们使用这些截断级数在小的 $\\xi_{start} \\ll 1$ 处设置初始条件：\n$$ y_0(\\xi_{start}) \\approx 1 - \\frac{\\xi_{start}^2}{6} $$\n$$ y_1(\\xi_{start}) \\approx -\\frac{\\xi_{start}}{3} $$\n有了这些初始值，我们可以使用数值积分器（例如龙格-库塔方法，如 `scipy.integrate.solve_ivp` 中实现的）从 $\\xi_{start}$ 向外求解该系统。使用事件查找功能来精确定位第一个根 $\\xi_1$，即 $y_0(\\xi) = \\theta(\\xi)$ 穿过零的点。\n\n### 最终计算\n算法如下：\n1.  使用指定的初始条件数值求解 $n=1$ 的莱恩-埃姆登 ODE 系统以找到 $\\xi_1$。此数值积分的结果应非常接近解析值 $\\pi$。\n2.  对于测试集中的每一对 $(K, \\rho_c)$，计算特征长度尺度 $a = \\sqrt{K/(2\\pi G)}$。请注意，对于 $n=1$，$a$ 与中心密度 $\\rho_c$ 无关。\n3.  使用 $R = a \\xi_1$ 计算球体的物理半径。\n4.  将每种情况下 $R$ 的最终值四舍五入到三位有效数字。\n\n该实现将执行这些步骤以生成所需的输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Derives and solves the n=1 Lane-Emden equation to determine the radius of a \n    polytropic fluid sphere.\n    \"\"\"\n\n    # Define the gravitational constant in SI units.\n    G = 6.67430e-11  # m^3 kg^-1 s^-2\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (K, rho_c).\n    # K is in m^5 kg^-1 s^-2, rho_c is in kg m^-3.\n    test_cases = [\n        (1.0e3, 1.0e3),\n        (1.0e5, 5.0e3),\n        (1.0e7, 2.0e3),\n        (1.0e3, 3.0e2),\n    ]\n\n    def round_to_sf(x, sf):\n        \"\"\"\n        Rounds a number to a specified number of significant figures.\n        \"\"\"\n        if x == 0:\n            return 0.0\n        # Use string formatting to control significant figures reliably.\n        # {sf-1} is used because the format specifier is for digits after the decimal point\n        # in scientific notation (e.g., '1.23e+04' has 3 sig figs, specified by '.2e').\n        return float(f'{x:.{sf-1}e}')\n\n    def get_xi1_n1():\n        \"\"\"\n        Numerically solves the n=1 Lane-Emden equation to find the first zero, xi_1.\n        The ODE is theta'' + (2/xi)*theta' + theta = 0.\n        Let y = [theta, theta'], then the system is:\n        y[0]' = y[1]\n        y[1]' = -(2/xi)*y[1] - y[0]\n        \"\"\"\n        \n        def lane_emden_ode_system(xi, y):\n            \"\"\"Defines the system of first-order ODEs.\"\"\"\n            # y[0] = theta, y[1] = d(theta)/d(xi)\n            y0, y1 = y\n            # This check is for robustness; the solver should not call at xi=0\n            # due to the integration start point xi_start > 0.\n            if xi == 0:\n                return [0.0, 0.0]\n            \n            # The system of ODEs\n            dy0_dxi = y1\n            dy1_dxi = -2.0 / xi * y1 - y0\n            return [dy0_dxi, dy1_dxi]\n\n        # An event function to find the first root of theta(xi).\n        def root_event(xi, y):\n            # The event occurs when y[0] (theta) is zero.\n            return y[0]\n        \n        # Stop integration when the root is found.\n        root_event.terminal = True\n        # Find root only when the function is decreasing.\n        root_event.direction = -1\n\n        # To avoid the singularity at xi=0, start integration at a small xi_start.\n        xi_start = 1.0e-8\n\n        # Use the series expansion for theta(xi) near xi=0 for initial conditions:\n        # theta(xi) approx 1 - xi^2/6\n        # theta'(xi) approx -xi/3\n        theta_start = 1.0 - xi_start**2 / 6.0\n        dtheta_dxi_start = -xi_start / 3.0\n        y_start = [theta_start, dtheta_dxi_start]\n\n        # Integration interval. We know the analytical solution is pi ~ 3.14,\n        # so integrating to 4.0 is safe.\n        xi_span = [xi_start, 4.0]\n\n        # Use solve_ivp for high-precision integration.\n        sol = solve_ivp(\n            lane_emden_ode_system,\n            xi_span,\n            y_start,\n            events=root_event,\n            dense_output=True,\n            rtol=1e-12,  # Set strict tolerances for accuracy\n            atol=1e-12\n        )\n\n        # The first zero xi_1 is stored in the event times.\n        if sol.status == 1 and len(sol.t_events[0]) > 0:\n            return sol.t_events[0][0]\n        else:\n            # Fallback to the known analytical solution if the solver fails.\n            # This case should not be reached with the current setup.\n            return np.pi\n\n    # For the n=1 case, xi_1 is a constant, so we calculate it only once.\n    # The numerical result will be extremely close to np.pi.\n    xi_1 = get_xi1_n1()\n\n    results = []\n    for K, rho_c in test_cases:\n        # Calculate the characteristic length scale 'a' for n=1.\n        # Note that 'a' is independent of rho_c for n=1.\n        a = np.sqrt(K / (2.0 * np.pi * G))\n\n        # Calculate the physical radius R = a * xi_1.\n        R = a * xi_1\n\n        # Round the result to three significant figures as required.\n        R_rounded = round_to_sf(R, 3)\n        results.append(R_rounded)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}