{
    "hands_on_practices": [
        {
            "introduction": "Building a model of a planet's interior from first principles is a foundational skill in planetary science. While the assumption of uniform density is instructive, real objects exhibit density stratification. This exercise  challenges you to derive the pressure profile for a more realistic case with a radially-dependent density, providing a deeper insight into how pressure and density are related within a self-gravitating body.",
            "id": "4163734",
            "problem": "An exoplanet with spherically symmetric interior structure and negligible external atmospheric pressure is modeled as a static, isotropic fluid in hydrostatic equilibrium. Its density is prescribed as a function of radius by $\\rho(r) = \\rho_{c}\\left[1 - \\left(\\frac{r}{R}\\right)^{\\alpha}\\right]$ for $0 \\le r \\le R$, with central density $\\rho_{c} > 0$, planetary radius $R > 0$, and parameter $\\alpha > 0$. Outside $r = R$ the density is zero. Starting only from fundamental laws—Newton's law of gravitation and local force balance—derive the gravitational acceleration $g(r)$ inside the planet and the corresponding hydrostatic balance equation for the pressure $P(r)$. Then, integrate to obtain the pressure profile $P(r)$ subject to the boundary condition $P(R) = 0$, and verify that $P(r)$ is physically plausible (finite at $r = 0$, positive for $0 \\le r < R$, and strictly decreasing with $r$). Finally, report the closed-form expression of the dimensionless central pressure\n$$\n\\frac{P(0)}{G \\rho_{c}^{2} R^{2}}\n$$\nas a function of $\\alpha$. Express the final answer as a single exact analytic expression with no numerical evaluation. Do not include units in your final expression, and do not round.",
            "solution": "The problem is to determine the pressure profile and central pressure of a spherically symmetric exoplanet in hydrostatic equilibrium, given a specific density profile. The solution requires starting from fundamental principles.\n\n**Step 1: Problem Validation**\n\nThe givens are:\n- Spherically symmetric, static, isotropic fluid in hydrostatic equilibrium.\n- Density profile: $\\rho(r) = \\rho_{c}\\left[1 - \\left(\\frac{r}{R}\\right)^{\\alpha}\\right]$ for $0 \\le r \\le R$.\n- $\\rho(r) = 0$ for $r > R$.\n- Central density $\\rho_{c} > 0$, radius $R > 0$, parameter $\\alpha > 0$.\n- Boundary condition: Pressure at the surface is zero, $P(R) = 0$.\n- The task is to derive the gravitational acceleration $g(r)$, the hydrostatic balance equation, the pressure profile $P(r)$, verify its physical plausibility, and find the dimensionless central pressure $\\frac{P(0)}{G \\rho_{c}^{2} R^{2}}$.\n\nThe problem is scientifically grounded in Newtonian gravity and fluid mechanics. It is well-posed, with sufficient information and a clear objective. The language is precise and objective. The density model is a valid physical idealization for $\\alpha > 0$. The problem does not violate any of the invalidity criteria. Therefore, the problem is valid, and we proceed with the solution.\n\n**Step 2: Derivation of Gravitational Acceleration $g(r)$**\n\nAccording to Newton's law of gravitation for a spherically symmetric mass distribution (a consequence of Gauss's law for gravity), the gravitational acceleration $g(r)$ at a radius $r$ inside the planet depends only on the mass enclosed within that radius, $M(r)$.\n$$\ng(r) = \\frac{G M(r)}{r^2}\n$$\nThe enclosed mass $M(r)$ is found by integrating the density $\\rho(r')$ over the volume of a sphere of radius $r$.\n$$\nM(r) = \\int_0^r \\rho(r') 4 \\pi (r')^2 dr'\n$$\nSubstituting the given density profile, $\\rho(r') = \\rho_{c}\\left[1 - \\left(\\frac{r'}{R}\\right)^{\\alpha}\\right]$:\n$$\nM(r) = \\int_0^r \\rho_{c}\\left[1 - \\left(\\frac{r'}{R}\\right)^{\\alpha}\\right] 4 \\pi (r')^2 dr'\n$$\n$$\nM(r) = 4 \\pi \\rho_c \\int_0^r \\left( (r')^2 - \\frac{(r')^{2+\\alpha}}{R^{\\alpha}} \\right) dr'\n$$\nPerforming the integration:\n$$\nM(r) = 4 \\pi \\rho_c \\left[ \\frac{(r')^3}{3} - \\frac{(r')^{3+\\alpha}}{(3+\\alpha)R^{\\alpha}} \\right]_0^r\n$$\n$$\nM(r) = 4 \\pi \\rho_c \\left( \\frac{r^3}{3} - \\frac{r^{3+\\alpha}}{(3+\\alpha)R^{\\alpha}} \\right)\n$$\nNow, we substitute this expression for $M(r)$ into the equation for $g(r)$:\n$$\ng(r) = \\frac{G}{r^2} \\left[ 4 \\pi \\rho_c \\left( \\frac{r^3}{3} - \\frac{r^{3+\\alpha}}{(3+\\alpha)R^{\\alpha}} \\right) \\right]\n$$\n$$\ng(r) = 4 \\pi G \\rho_c \\left( \\frac{r}{3} - \\frac{r^{1+\\alpha}}{(3+\\alpha)R^{\\alpha}} \\right)\n$$\nThis is the gravitational acceleration as a function of radius inside the planet.\n\n**Step 3: Hydrostatic Balance Equation and Pressure Profile $P(r)$**\n\nFor a static fluid in a gravitational field, the condition of hydrostatic equilibrium requires that the upward pressure gradient force on a fluid element balances the downward gravitational force. For a small fluid element of area $A$ and thickness $dr$ at radius $r$, this force balance is expressed as:\n$$\n(P(r) - P(r+dr))A - g(r) dm = 0\n$$\nwhere $dm = \\rho(r) A dr$ is the mass of the element. Using the definition of the derivative, $P(r+dr) - P(r) \\approx \\frac{dP}{dr}dr$, we obtain the hydrostatic balance equation:\n$$\n\\frac{dP}{dr} = -g(r) \\rho(r)\n$$\nTo find the pressure profile $P(r)$, we integrate this equation from a radius $r$ to the surface of the planet at $R$.\n$$\n\\int_{P(r)}^{P(R)} dP' = - \\int_r^R g(r') \\rho(r') dr'\n$$\nGiven the boundary condition $P(R) = 0$, this becomes:\n$$\n0 - P(r) = - \\int_r^R g(r') \\rho(r') dr' \\quad \\implies \\quad P(r) = \\int_r^R g(r') \\rho(r') dr'\n$$\nWe now substitute the expressions for $g(r')$ and $\\rho(r')$.\n$$\ng(r')\\rho(r') = 4 \\pi G \\rho_c \\left( \\frac{r'}{3} - \\frac{(r')^{1+\\alpha}}{(3+\\alpha)R^{\\alpha}} \\right) \\times \\rho_c \\left( 1 - \\frac{(r')^{\\alpha}}{R^{\\alpha}} \\right)\n$$\n$$\ng(r')\\rho(r') = 4 \\pi G \\rho_c^2 \\left[ \\frac{r'}{3} - \\frac{(r')^{1+\\alpha}}{3R^{\\alpha}} - \\frac{(r')^{1+\\alpha}}{(3+\\alpha)R^{\\alpha}} + \\frac{(r')^{1+2\\alpha}}{(3+\\alpha)R^{2\\alpha}} \\right]\n$$\nCombine the middle terms: $\\frac{1}{3} + \\frac{1}{3+\\alpha} = \\frac{3+\\alpha+3}{3(3+\\alpha)} = \\frac{6+\\alpha}{3(3+\\alpha)}$.\n$$\ng(r')\\rho(r') = 4 \\pi G \\rho_c^2 \\left[ \\frac{r'}{3} - \\frac{6+\\alpha}{3(3+\\alpha)} \\frac{(r')^{1+\\alpha}}{R^{\\alpha}} + \\frac{1}{3+\\alpha} \\frac{(r')^{1+2\\alpha}}{R^{2\\alpha}} \\right]\n$$\nNow we integrate this product from $r$ to $R$ to find $P(r)$. For the final result, we are interested in the central pressure $P(0)$, so we set the lower integration limit to $0$ and the upper limit to $R$.\n$$\nP(0) = \\int_0^R g(r') \\rho(r') dr'\n$$\n$$\nP(0) = 4 \\pi G \\rho_c^2 \\int_0^R \\left[ \\frac{r'}{3} - \\frac{6+\\alpha}{3(3+\\alpha)R^{\\alpha}} (r')^{1+\\alpha} + \\frac{1}{(3+\\alpha)R^{2\\alpha}} (r')^{1+2\\alpha} \\right] dr'\n$$\nEvaluating the integral term by term:\n$$\n\\int_0^R \\frac{r'}{3} dr' = \\left[ \\frac{(r')^2}{6} \\right]_0^R = \\frac{R^2}{6}\n$$\n$$\n\\int_0^R - \\frac{6+\\alpha}{3(3+\\alpha)R^{\\alpha}} (r')^{1+\\alpha} dr' = - \\frac{6+\\alpha}{3(3+\\alpha)R^{\\alpha}} \\left[ \\frac{(r')^{2+\\alpha}}{2+\\alpha} \\right]_0^R = - \\frac{6+\\alpha}{3(3+\\alpha)(2+\\alpha)} \\frac{R^{2+\\alpha}}{R^{\\alpha}} = - \\frac{R^2(6+\\alpha)}{3(2+\\alpha)(3+\\alpha)}\n$$\n$$\n\\int_0^R \\frac{1}{(3+\\alpha)R^{2\\alpha}} (r')^{1+2\\alpha} dr' = \\frac{1}{(3+\\alpha)R^{2\\alpha}} \\left[ \\frac{(r')^{2+2\\alpha}}{2+2\\alpha} \\right]_0^R = \\frac{1}{(3+\\alpha)2(1+\\alpha)} \\frac{R^{2+2\\alpha}}{R^{2\\alpha}} = \\frac{R^2}{2(1+\\alpha)(3+\\alpha)}\n$$\nSumming these results, we get $P(0)$:\n$$\nP(0) = 4 \\pi G \\rho_c^2 \\left[ \\frac{R^2}{6} - \\frac{R^2(6+\\alpha)}{3(2+\\alpha)(3+\\alpha)} + \\frac{R^2}{2(1+\\alpha)(3+\\alpha)} \\right]\n$$\n\n**Step 4: Physical Plausibility of $P(r)$**\n\n- **Finite at $r=0$**: Our expression for $P(0)$ is a finite value, as all terms are well-defined for $\\alpha > 0$.\n- **Strictly decreasing with $r$**: The pressure gradient is $\\frac{dP}{dr} = -g(r)\\rho(r)$. For $0 < r < R$:\n  - $\\rho(r) = \\rho_c(1 - (r/R)^\\alpha) > 0$ since $r/R < 1$ and $\\alpha > 0$.\n  - $g(r) = 4 \\pi G \\rho_c \\frac{r}{3} \\left( 1 - \\frac{3}{3+\\alpha} (\\frac{r}{R})^\\alpha \\right)$. Since $\\alpha > 0$, we have $3+\\alpha > 3$, so $\\frac{3}{3+\\alpha} < 1$. Also, $(r/R)^\\alpha < 1$. Thus, the term $\\frac{3}{3+\\alpha} (\\frac{r}{R})^\\alpha < 1$, which ensures $g(r) > 0$ for $r \\in (0, R]$.\n  - Since $g(r) > 0$ and $\\rho(r) > 0$ for $0 < r < R$, their product is positive, and $\\frac{dP}{dr} < 0$. Therefore, $P(r)$ is a strictly decreasing function of $r$.\n- **Positive for $0 \\le r < R$**: Since $P(r)$ is strictly decreasing on $[0, R)$ and $P(R)=0$, it must be that $P(r) > P(R)=0$ for all $r$ in the interval $[0, R)$.\nThe pressure profile is physically plausible.\n\n**Step 5: Dimensionless Central Pressure**\n\nFrom the expression for $P(0)$, we can find the required dimensionless quantity:\n$$\n\\frac{P(0)}{G \\rho_{c}^{2} R^{2}} = 4 \\pi \\left[ \\frac{1}{6} - \\frac{6+\\alpha}{3(2+\\alpha)(3+\\alpha)} + \\frac{1}{2(1+\\alpha)(3+\\alpha)} \\right]\n$$\nTo simplify the expression in the brackets, we find a common denominator, which is $6(1+\\alpha)(2+\\alpha)(3+\\alpha)$.\n$$\n\\frac{P(0)}{G \\rho_{c}^{2} R^{2}} = 4 \\pi \\left[ \\frac{(1+\\alpha)(2+\\alpha)(3+\\alpha) - 2(1+\\alpha)(6+\\alpha) + 3(2+\\alpha)}{6(1+\\alpha)(2+\\alpha)(3+\\alpha)} \\right]\n$$\nNow, we expand the terms in the numerator:\n- $(1+\\alpha)(2+\\alpha)(3+\\alpha) = (\\alpha^2+3\\alpha+2)(3+\\alpha) = \\alpha^3+3\\alpha^2+3\\alpha^2+9\\alpha+2\\alpha+6 = \\alpha^3+6\\alpha^2+11\\alpha+6$.\n- $-2(1+\\alpha)(6+\\alpha) = -2(\\alpha^2+7\\alpha+6) = -2\\alpha^2-14\\alpha-12$.\n- $3(2+\\alpha) = 6+3\\alpha$.\nSumming the numerator terms:\n$$\n(\\alpha^3+6\\alpha^2+11\\alpha+6) + (-2\\alpha^2-14\\alpha-12) + (6+3\\alpha) = \\alpha^3 + (6-2)\\alpha^2 + (11-14+3)\\alpha + (6-12+6)\n$$\n$$\n= \\alpha^3 + 4\\alpha^2 + 0\\alpha + 0 = \\alpha^2(\\alpha+4)\n$$\nSubstituting this back into the expression for the dimensionless pressure:\n$$\n\\frac{P(0)}{G \\rho_{c}^{2} R^{2}} = 4 \\pi \\left( \\frac{\\alpha^2(\\alpha+4)}{6(1+\\alpha)(2+\\alpha)(3+\\alpha)} \\right)\n$$\nSimplifying the numerical prefactor $4/6 = 2/3$:\n$$\n\\frac{P(0)}{G \\rho_{c}^{2} R^{2}} = \\frac{2\\pi}{3} \\frac{\\alpha^2(\\alpha+4)}{(1+\\alpha)(2+\\alpha)(3+\\alpha)}\n$$\nThis is the final closed-form expression.",
            "answer": "$$\n\\boxed{\\frac{2\\pi}{3} \\frac{\\alpha^2(\\alpha+4)}{(\\alpha+1)(\\alpha+2)(\\alpha+3)}}\n$$"
        },
        {
            "introduction": "Hydrostatic equilibrium is an approximation, and a crucial skill for a modeler is to know when it applies. In dynamically active environments like the atmospheres of hot Jupiters, vertical fluid motions can be vigorous. This practice  requires you to use scale analysis to quantify the departure from hydrostatic balance, determining whether the vertical acceleration is truly negligible compared to gravity in such an extreme setting.",
            "id": "4163749",
            "problem": "A hydrogen-dominated hot Jupiter atmosphere is driven by strong day–night stellar irradiation contrasts, producing supersonic horizontal winds and vigorous but comparatively modest vertical motions. Consider the vertical momentum balance for a compressible fluid under gravity. Begin from Newton’s second law applied to a fluid parcel and write the vertical component of the momentum equation. By non-dimensionalizing this equation with characteristic scales for velocity, space, and time, identify the regime in which vertical force balance reduces to hydrostatic equilibrium and define a nondimensional parameter that quantifies departures from hydrostatic balance as the ratio of the material vertical acceleration to gravity. Do not assume any specialized “primitive equation” form a priori; build from Newton’s second law.\n\nYou are then given a representative, strongly forced General Circulation Model (GCM) snapshot for a canonical hot Jupiter at the $0.1$ bar level. Over a characteristic day–night horizontal scale, the flow exhibits the following scales:\n- Characteristic zonal speed $U = 3.0 \\times 10^{3} \\text{ m s}^{-1}$.\n- Characteristic meridional speed $V = 1.0 \\times 10^{3} \\text{ m s}^{-1}$.\n- Root-mean-square vertical speed $W = 50 \\text{ m s}^{-1}$.\n- Horizontal length scale (day–night contrast scale) $L_h = 1.5 \\times 10^{8} \\text{ m}$.\n- Vertical scale height $H = 5.0 \\times 10^{5} \\text{ m}$.\n- Temporal variability timescale at this level $\\tau = 6.0 \\times 10^{3} \\text{ s}$.\n- Gravitational acceleration $g = 12 \\text{ m s}^{-2}$.\n\nAssume that the vertical Coriolis term and viscous terms are negligible in the instantaneous vertical momentum balance at this level. Using a scale analysis for the material derivative of the vertical velocity $w$, estimate\n$$\\left|\\frac{D w}{D t}\\right| \\approx \\left|\\frac{\\partial w}{\\partial t}\\right| + \\left|u \\frac{\\partial w}{\\partial x}\\right| + \\left|v \\frac{\\partial w}{\\partial y}\\right| + \\left|w \\frac{\\partial w}{\\partial z}\\right|,$$\nwith the replacements $\\left|\\frac{\\partial w}{\\partial t}\\right| \\sim \\frac{W}{\\tau}$, $\\left|\\frac{\\partial w}{\\partial x}\\right| \\sim \\frac{W}{L_{h}}$, $\\left|\\frac{\\partial w}{\\partial y}\\right| \\sim \\frac{W}{L_{h}}$, and $\\left|\\frac{\\partial w}{\\partial z}\\right| \\sim \\frac{W}{H}$, evaluated using the characteristic speeds $U$, $V$, and $W$ above.\n\nFinally, evaluate the nondimensional parameter $\\epsilon$ defined as the ratio of the magnitude of the material vertical acceleration to gravitational acceleration, and report its numerical value for this snapshot:\n$$\\epsilon \\equiv \\frac{\\left|D w / D t\\right|}{g}.$$\nExpress your final $\\epsilon$ as a pure number (unitless) and round your answer to four significant figures.",
            "solution": "The problem asks for two main tasks: first, to derive the vertical momentum equation from first principles and define a nondimensional parameter quantifying departures from hydrostatic equilibrium; second, to calculate the value of this parameter for a specific hot Jupiter atmosphere model.\n\nThe problem is validated as scientifically grounded, well-posed, and objective. It is based on the fundamental principles of fluid dynamics applied to planetary atmospheres, a standard practice in the field. All necessary data and definitions are provided, and the constraints are consistent and physically plausible for the context of a hot Jupiter.\n\nFirst, we derive the vertical momentum equation. We consider a small, fixed-mass fluid parcel of volume $\\delta V$ and density $\\rho$. According to Newton's second law, the net force on the parcel equals its mass times its acceleration. The acceleration of the fluid parcel is given by the material derivative of the velocity vector, $\\frac{D\\vec{v}}{Dt}$. The mass of the parcel is $m = \\rho \\delta V$.\n\nWe focus on the vertical component ($z$-direction) of the motion. The forces acting on the fluid parcel in the vertical direction are the pressure gradient force and the gravitational force. Let the parcel have a horizontal cross-sectional area $\\delta A$ and a vertical thickness $\\delta z$, so $\\delta V = \\delta A \\delta z$. The pressure on the bottom surface at height $z$ is $P(z)$ and on the top surface at $z+\\delta z$ is $P(z+\\delta z)$. The net pressure force in the vertical direction is $F_{P,z} = P(z) \\delta A - P(z+\\delta z) \\delta A = -[P(z+\\delta z) - P(z)] \\delta A$. For an infinitesimally small parcel, this is approximately $F_{P,z} \\approx -\\frac{\\partial P}{\\partial z} \\delta z \\delta A = -\\frac{\\partial P}{\\partial z} \\delta V$.\n\nThe gravitational force is $F_{g,z} = -mg = -(\\rho \\delta V) g$, where $g$ is the acceleration due to gravity, defined as positive, and the negative sign indicates the force is directed downward (in the negative $z$ direction).\n\nThe problem states that vertical Coriolis and viscous terms are negligible. Therefore, the sum of vertical forces is $\\sum F_z = F_{P,z} + F_{g,z} = (-\\frac{\\partial P}{\\partial z} - \\rho g)\\delta V$.\n\nThe vertical component of Newton's second law for the fluid parcel is $m \\frac{Dw}{Dt} = \\sum F_z$, where $w$ is the vertical component of the velocity vector $\\vec{v}$. Substituting the expressions for mass and force:\n$$(\\rho \\delta V) \\frac{Dw}{Dt} = \\left(-\\frac{\\partial P}{\\partial z} - \\rho g\\right) \\delta V$$\nDividing by the mass density $\\rho$ and the volume $\\delta V$ yields the vertical momentum equation:\n$$\\frac{Dw}{Dt} = -\\frac{1}{\\rho}\\frac{\\partial P}{\\partial z} - g$$\n\nHydrostatic equilibrium is the state in which there is no vertical acceleration, $\\frac{Dw}{Dt} = 0$. In this case, the vertical momentum equation reduces to a balance between the pressure gradient force and gravity:\n$$-\\frac{1}{\\rho}\\frac{\\partial P}{\\partial z} - g = 0 \\quad \\implies \\quad \\frac{\\partial P}{\\partial z} = -\\rho g$$\nThe regime in which this balance holds is when the material vertical acceleration, $\\frac{Dw}{Dt}$, is negligible compared to the gravitational acceleration, $g$. A nondimensional parameter that quantifies the departure from hydrostatic balance can be defined as the ratio of the magnitude of the material vertical acceleration to the magnitude of the gravitational acceleration. This parameter, which we denote by $\\epsilon$, is precisely what the problem asks for:\n$$\\epsilon \\equiv \\frac{|Dw/Dt|}{g}$$\nThe condition for the validity of the hydrostatic approximation is $\\epsilon \\ll 1$.\n\nNext, we evaluate $\\epsilon$ for the given hot Jupiter model. The material derivative of the vertical velocity $w$ is given by:\n$$\\frac{Dw}{Dt} = \\frac{\\partial w}{\\partial t} + u \\frac{\\partial w}{\\partial x} + v \\frac{\\partial w}{\\partial y} + w \\frac{\\partial w}{\\partial z}$$\nThe problem provides an approximation for its magnitude based on scale analysis:\n$$\\left|\\frac{Dw}{Dt}\\right| \\approx \\left|\\frac{\\partial w}{\\partial t}\\right| + \\left|u \\frac{\\partial w}{\\partial x}\\right| + \\left|v \\frac{\\partial w}{\\partial y}\\right| + \\left|w \\frac{\\partial w}{\\partial z}\\right|$$\nWe use the characteristic scales provided to estimate each term:\n$|\\frac{\\partial w}{\\partial t}| \\sim \\frac{W}{\\tau}$, $|u \\frac{\\partial w}{\\partial x}| \\sim U \\frac{W}{L_h}$, $|v \\frac{\\partial w}{\\partial y}| \\sim V \\frac{W}{L_h}$, and $|w \\frac{\\partial w}{\\partial z}| \\sim W \\frac{W}{H}$.\n\nThe given characteristic scales are:\n- $U = 3.0 \\times 10^{3} \\text{ m s}^{-1}$\n- $V = 1.0 \\times 10^{3} \\text{ m s}^{-1}$\n- $W = 50 \\text{ m s}^{-1}$\n- $L_h = 1.5 \\times 10^{8} \\text{ m}$\n- $H = 5.0 \\times 10^{5} \\text{ m}$\n- $\\tau = 6.0 \\times 10^{3} \\text{ s}$\n- $g = 12 \\text{ m s}^{-2}$\n\nWe now compute the magnitude of each term in the material derivative:\n1. Temporal derivative term: $\\frac{W}{\\tau} = \\frac{50}{6.0 \\times 10^{3}} = \\frac{5}{600} = \\frac{1}{120} \\text{ m s}^{-2} \\approx 0.008333... \\text{ m s}^{-2}$.\n2. Zonal advection term: $U \\frac{W}{L_h} = (3.0 \\times 10^{3}) \\frac{50}{1.5 \\times 10^{8}} = \\frac{1.5 \\times 10^{5}}{1.5 \\times 10^{8}} = 1.0 \\times 10^{-3} \\text{ m s}^{-2}$.\n3. Meridional advection term: $V \\frac{W}{L_h} = (1.0 \\times 10^{3}) \\frac{50}{1.5 \\times 10^{8}} = \\frac{5.0 \\times 10^{4}}{1.5 \\times 10^{8}} = \\frac{1}{3} \\times 10^{-3} \\text{ m s}^{-2} \\approx 0.000333... \\text{ m s}^{-2}$.\n4. Vertical advection term: $\\frac{W^2}{H} = \\frac{(50)^2}{5.0 \\times 10^{5}} = \\frac{2500}{5.0 \\times 10^{5}} = \\frac{2.5 \\times 10^{3}}{5.0 \\times 10^{5}} = 0.5 \\times 10^{-2} = 5.0 \\times 10^{-3} \\text{ m s}^{-2}$.\n\nSumming these terms gives the total estimated magnitude of the material acceleration:\n$$\\left|\\frac{Dw}{Dt}\\right| \\approx \\frac{1}{120} + 1.0 \\times 10^{-3} + \\frac{1}{3} \\times 10^{-3} + 5.0 \\times 10^{-3} \\text{ m s}^{-2}$$\n$$ \\left|\\frac{Dw}{Dt}\\right| \\approx 0.008333... + 0.001 + 0.000333... + 0.005 = 0.014666... \\text{ m s}^{-2} $$\nUsing fractions for precision:\n$$ \\left|\\frac{Dw}{Dt}\\right| \\approx \\frac{1}{120} + \\frac{1}{1000} + \\frac{1}{3000} + \\frac{1}{200} = \\frac{25}{3000} + \\frac{3}{3000} + \\frac{1}{3000} + \\frac{15}{3000} = \\frac{44}{3000} \\text{ m s}^{-2}$$\n\nFinally, we compute the nondimensional parameter $\\epsilon$:\n$$\\epsilon = \\frac{|Dw/Dt|}{g} \\approx \\frac{44/3000}{12} = \\frac{44}{3000 \\times 12} = \\frac{44}{36000} = \\frac{11}{9000}$$\nConverting this fraction to a decimal:\n$$\\epsilon \\approx 0.0012222...$$\nThe problem requires the answer rounded to four significant figures. The first four significant figures are $1$, $2$, $2$, and $2$. The fifth significant figure is $2$, so we round down.\n$$\\epsilon \\approx 0.001222$$\nThis small value of $\\epsilon$ indicates that, even in this dynamically active environment with supersonic horizontal winds, the vertical momentum balance is very close to hydrostatic equilibrium.",
            "answer": "$$\\boxed{0.001222}$$"
        },
        {
            "introduction": "While analytical solutions are invaluable for building intuition, most realistic planetary models rely on numerical methods. This exercise  bridges theory and practice by tasking you with the numerical solution of the Lane-Emden equation for an $n=1$ polytrope, a classic model for self-gravitating spheres. You will implement a solver to determine the object's physical size, gaining hands-on experience with the computational techniques at the heart of modern planetary modeling.",
            "id": "4163806",
            "problem": "Consider a self-gravitating, spherically symmetric fluid sphere with a polytropic equation of state $P = K \\rho^{1 + 1/n}$, where $P$ is pressure, $\\rho$ is mass density, $K$ is the polytropic constant, and $n$ is the polytropic index. Assume Newtonian gravity and hydrostatic equilibrium, where force balance is governed by $dP/dr = -\\rho G M(r) / r^2$ and mass continuity is governed by $dM/dr = 4 \\pi r^2 \\rho$, with $G$ as the gravitational constant and $M(r)$ as the mass enclosed within radius $r$. In this problem, specialize to the index $n=1$ case relevant to planetary science and exoplanet interior modeling under hydrostatic equilibrium.\n\nStarting from the stated fundamental laws and definitions, derive the dimensionless ordinary differential equation (ODE) known as the Lane-Emden equation for the index $n=1$ polytrope. Define the dimensionless function $\\theta(\\xi)$ and similarity length scale $a$ through the transformations $\\rho(r) = \\rho_c \\theta(\\xi)^n$ and $r = a \\xi$, where $\\rho_c$ is the central density. Apply the regularity conditions at the center, $\\theta(0) = 1$ and $d\\theta/d\\xi \\big|_{\\xi=0} = 0$, and use a series expansion near $\\xi=0$ to initialize the numerical integration.\n\nYou must implement a numerical solver to:\n- Integrate the $n=1$ Lane-Emden ODE from a small positive $\\xi$ outward to the first zero $\\xi_1$ of $\\theta(\\xi)$.\n- Use the derived relation connecting the similarity length $a$ to the physical parameters $(K, \\rho_c)$ and constants to compute the physical radius $R = a \\xi_1$.\n\nAll quantities must be handled in International System of Units (SI). Use $G = 6.67430 \\times 10^{-11}$ in $\\mathrm{m^3 \\, kg^{-1} \\, s^{-2}}$. For $n=1$, $K$ has SI units $\\mathrm{m^5 \\, kg^{-1} \\, s^{-2}}$, and $\\rho_c$ has SI units $\\mathrm{kg \\, m^{-3}}$. Express the final radius $R$ in meters, rounded to three significant figures.\n\nTest suite:\n- Case $1$: $(K, \\rho_c) = (10^3, 10^3)$.\n- Case $2$: $(K, \\rho_c) = (10^5, 5 \\times 10^3)$.\n- Case $3$: $(K, \\rho_c) = (10^7, 2 \\times 10^3)$.\n- Case $4$: $(K, \\rho_c) = (10^3, 3 \\times 10^2)$.\n\nYour program must:\n- Numerically determine $\\xi_1$ by integrating the $n=1$ Lane-Emden ODE with the specified central regularity conditions and a series expansion start near $\\xi=0$.\n- Compute $R$ for each test case and return the results as floats (rounded to three significant figures) in meters.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4]$), where each $r_i$ is the radius for the corresponding test case in meters, rounded to three significant figures.",
            "solution": "The problem statement is evaluated for validity.\n\n### Step 1: Extract Givens\n- **Equation of State**: Polytropic, $P = K \\rho^{1 + 1/n}$.\n- **Special Case**: Polytropic index $n=1$.\n- **Governing Equations**:\n    - Hydrostatic equilibrium: $dP/dr = -\\rho G M(r) / r^2$.\n    - Mass continuity: $dM/dr = 4 \\pi r^2 \\rho$.\n- **Definitions**:\n    - $P$: Pressure\n    - $\\rho$: Mass density\n    - $K$: Polytropic constant\n    - $n$: Polytropic index\n    - $r$: Radial coordinate\n    - $G$: Gravitational constant\n    - $M(r)$: Mass enclosed within radius $r$.\n- **Dimensionless Transformations**:\n    - $\\rho(r) = \\rho_c \\theta(\\xi)^n$\n    - $r = a \\xi$\n    - $\\rho_c$: Central density.\n    - $\\theta(\\xi)$: Dimensionless function.\n    - $a$: Similarity length scale.\n- **Boundary Conditions**:\n    - Central regularity: $\\theta(0) = 1$ and $d\\theta/d\\xi \\big|_{\\xi=0} = 0$.\n- **Constants**:\n    - Gravitational constant: $G = 6.67430 \\times 10^{-11} \\, \\mathrm{m^3 \\, kg^{-1} \\, s^{-2}}$.\n- **Task Requirements**:\n    1. Derive the Lane-Emden ODE for $n=1$.\n    2. Numerically integrate the ODE from a small positive $\\xi$ (initialized with a series expansion) to find the first zero, $\\xi_1$.\n    3. Compute the physical radius $R = a \\xi_1$ for given test cases.\n    4. Express $R$ in meters, rounded to three significant figures.\n- **Test Suite**:\n    - Case 1: $(K, \\rho_c) = (10^3 \\, \\mathrm{m^5 \\, kg^{-1} \\, s^{-2}}, 10^3 \\, \\mathrm{kg \\, m^{-3}})$.\n    - Case 2: $(K, \\rho_c) = (10^5 \\, \\mathrm{m^5 \\, kg^{-1} \\, s^{-2}}, 5 \\times 10^3 \\, \\mathrm{kg \\, m^{-3}})$.\n    - Case 3: $(K, \\rho_c) = (10^7 \\, \\mathrm{m^5 \\, kg^{-1} \\, s^{-2}}, 2 \\times 10^3 \\, \\mathrm{kg \\, m^{-3}})$.\n    - Case 4: $(K, \\rho_c) = (10^3 \\, \\mathrm{m^5 \\, kg^{-1} \\, s^{-2}}, 3 \\times 10^2 \\, \\mathrm{kg \\, m^{-3}})$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the standard Newtonian model of a self-gravitating polytropic fluid, a cornerstone of stellar structure and planetary interior modeling. The equations and concepts are fundamental to astrophysics. The problem is valid.\n- **Well-Posed**: The problem provides a complete set of equations, boundary conditions, and constants to determine a unique solution for the structure of the specified object. The task is clearly defined. The problem is valid.\n- **Objective**: The language is precise and quantitative. All terms are standard within the field. The problem is valid.\n\nThe problem does not exhibit any flaws such as scientific unsoundness, missing information, or ambiguity. It is a standard, solvable problem in theoretical astrophysics.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. Proceeding to the solution.\n\n### Derivation of the Lane-Emden Equation\nThe analysis begins with the fundamental equations of stellar structure under the assumption of spherical symmetry and hydrostatic equilibrium. The equation of hydrostatic equilibrium is\n$$ \\frac{dP}{dr} = -\\frac{G M(r) \\rho(r)}{r^2} $$\nand the equation of mass continuity is\n$$ \\frac{dM(r)}{dr} = 4 \\pi r^2 \\rho(r) $$\nTo obtain a single second-order differential equation, we first differentiate the hydrostatic equilibrium equation after rearranging it:\n$$ \\frac{r^2}{\\rho} \\frac{dP}{dr} = -G M(r) $$\n$$ \\frac{d}{dr}\\left(\\frac{r^2}{\\rho} \\frac{dP}{dr}\\right) = -G \\frac{dM}{dr} $$\nSubstituting the mass continuity equation into the right-hand side yields a combined equation relating pressure and density:\n$$ \\frac{d}{dr}\\left(\\frac{r^2}{\\rho} \\frac{dP}{dr}\\right) = -G (4 \\pi r^2 \\rho) $$\nDividing by $r^2$ gives the structure equation, which is equivalent to Poisson's equation for the gravitational potential:\n$$ \\frac{1}{r^2}\\frac{d}{dr}\\left(\\frac{r^2}{\\rho} \\frac{dP}{dr}\\right) = -4 \\pi G \\rho $$\nNext, we introduce the polytropic equation of state, $P = K\\rho^{1+1/n}$. The pressure gradient is\n$$ \\frac{dP}{dr} = K\\left(1+\\frac{1}{n}\\right)\\rho^{1/n}\\frac{d\\rho}{dr} $$\nSubstituting this into the structure equation:\n$$ \\frac{1}{r^2}\\frac{d}{dr}\\left(\\frac{r^2}{\\rho} \\cdot K\\left(1+\\frac{1}{n}\\right)\\rho^{1/n}\\frac{d\\rho}{dr}\\right) = -4 \\pi G \\rho $$\n$$ \\frac{K(n+1)}{n}\\frac{1}{r^2}\\frac{d}{dr}\\left(r^2 \\rho^{(1/n) - 1}\\frac{d\\rho}{dr}\\right) = -4 \\pi G \\rho $$\nNow, we introduce the dimensionless variables $\\rho(r) = \\rho_c \\theta(\\xi)^n$ and $r = a \\xi$, where $\\rho_c$ is the central density and $a$ is a characteristic length scale. The derivatives transform as:\n$$ \\frac{d\\rho}{dr} = \\frac{d\\rho}{d\\theta}\\frac{d\\theta}{d\\xi}\\frac{d\\xi}{dr} = (\\rho_c n \\theta^{n-1})\\left(\\frac{d\\theta}{d\\xi}\\right)\\left(\\frac{1}{a}\\right) $$\nSubstituting these into the equation gives:\n$$ \\frac{K(n+1)}{n}\\frac{1}{a^2 \\xi^2}\\frac{d}{a d\\xi}\\left( (a\\xi)^2 (\\rho_c \\theta^n)^{(1-n)/n} \\frac{\\rho_c n \\theta^{n-1}}{a}\\frac{d\\theta}{d\\xi} \\right) = -4 \\pi G \\rho_c\\theta^n $$\nAfter simplification, the expression becomes:\n$$ \\left[\\frac{(n+1)K \\rho_c^{(1/n)-1}}{4 \\pi G a^2}\\right] \\frac{1}{\\xi^2}\\frac{d}{d\\xi}\\left(\\xi^2\\frac{d\\theta}{d\\xi}\\right) = - \\theta^n $$\nThe length scale $a$ is chosen to make the term in brackets equal to $1$:\n$$ a^2 = \\frac{(n+1)K \\rho_c^{(1-n)/n}}{4 \\pi G} \\implies a = \\left[\\frac{(n+1)K}{4\\pi G}\\right]^{1/2}\\rho_c^{(1-n)/(2n)} $$\nWith this choice, we arrive at the general Lane-Emden equation:\n$$ \\frac{1}{\\xi^2}\\frac{d}{d\\xi}\\left(\\xi^2\\frac{d\\theta}{d\\xi}\\right) + \\theta^n = 0 $$\nFor the specific case $n=1$, the equation for the length scale $a$ simplifies significantly, as the term involving $\\rho_c$ vanishes:\n$$ a = \\left[\\frac{(1+1)K}{4\\pi G}\\right]^{1/2}\\rho_c^{(1-1)/2} = \\sqrt{\\frac{2K}{4\\pi G}} = \\sqrt{\\frac{K}{2\\pi G}} $$\nThe Lane-Emden equation for $n=1$ is:\n$$ \\frac{1}{\\xi^2}\\frac{d}{d\\xi}\\left(\\xi^2\\frac{d\\theta}{d\\xi}\\right) + \\theta = 0 $$\nwhich can also be written as $\\xi^2\\theta'' + 2\\xi\\theta' + \\xi^2\\theta = 0$.\n\n### Numerical Solution Strategy\nThe Lane-Emden equation for $n=1$ is a second-order ordinary differential equation. This specific case has a well-known analytical solution, $\\theta(\\xi) = \\frac{\\sin(\\xi)}{\\xi}$, which satisfies the boundary conditions $\\theta(0)=1$ and $\\theta'(0)=0$. The first zero, $\\xi_1$, where the density and pressure become zero, corresponds to the first non-trivial root of $\\sin(\\xi)$, which is $\\xi_1=\\pi$. The physical radius is $R=a\\xi_1$.\n\nAlthough an analytical solution exists, the problem requires a numerical solution. To proceed numerically, we first convert the second-order ODE into a system of two first-order ODEs. Let $y_0 = \\theta$ and $y_1 = \\theta' = d\\theta/d\\xi$. The system is:\n$$ \\frac{dy_0}{d\\xi} = y_1 $$\n$$ \\frac{dy_1}{d\\xi} = -\\frac{2}{\\xi}y_1 - y_0 $$\nA singularity exists at $\\xi=0$ due to the $1/\\xi$ term. We cannot start the integration at $\\xi=0$. Instead, we use a series expansion for $\\theta(\\xi)$ around $\\xi=0$ to find initial values at a small, non-zero $\\xi_{start}$. The general series solution is of the form $\\theta(\\xi) = \\sum_{k=0}^{\\infty} c_k \\xi^k$. Applying the boundary conditions, the series for the $n=1$ case is found to be:\n$$ \\theta(\\xi) = 1 - \\frac{1}{6}\\xi^2 + \\frac{1}{120}\\xi^4 - \\dots $$\nThe derivative is:\n$$ \\theta'(\\xi) = -\\frac{1}{3}\\xi + \\frac{1}{30}\\xi^3 - \\dots $$\nWe use these truncated series to set initial conditions at a small $\\xi_{start} \\ll 1$:\n$$ y_0(\\xi_{start}) \\approx 1 - \\frac{\\xi_{start}^2}{6} $$\n$$ y_1(\\xi_{start}) \\approx -\\frac{\\xi_{start}}{3} $$\nWith these initial values, we can use a numerical integrator (such as a Runge-Kutta method, as implemented in `scipy.integrate.solve_ivp`) to solve the system from $\\xi_{start}$ outwards. An event-finding capability is used to precisely locate the first root $\\xi_1$ where $y_0(\\xi) = \\theta(\\xi)$ crosses zero.\n\n### Final Calculation\nThe algorithm is as follows:\n1.  Numerically solve the $n=1$ Lane-Emden ODE system with the specified initial conditions to find $\\xi_1$. The result of this numerical integration should be extremely close to the analytical value, $\\pi$.\n2.  For each pair of $(K, \\rho_c)$ from the test suite, calculate the characteristic length scale $a = \\sqrt{K/(2\\pi G)}$. Notice that for $n=1$, $a$ is independent of the central density $\\rho_c$.\n3.  Compute the physical radius of the sphere using $R = a \\xi_1$.\n4.  Round the final value of $R$ for each case to three significant figures.\n\nThe implementation will carry out these steps to produce the required output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Derives and solves the n=1 Lane-Emden equation to determine the radius of a \n    polytropic fluid sphere.\n    \"\"\"\n\n    # Define the gravitational constant in SI units.\n    G = 6.67430e-11  # m^3 kg^-1 s^-2\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (K, rho_c).\n    # K is in m^5 kg^-1 s^-2, rho_c is in kg m^-3.\n    test_cases = [\n        (1.0e3, 1.0e3),\n        (1.0e5, 5.0e3),\n        (1.0e7, 2.0e3),\n        (1.0e3, 3.0e2),\n    ]\n\n    def round_to_sf(x, sf):\n        \"\"\"\n        Rounds a number to a specified number of significant figures.\n        \"\"\"\n        if x == 0:\n            return 0.0\n        # Use string formatting to control significant figures reliably.\n        # {sf-1} is used because the format specifier is for digits after the decimal point\n        # in scientific notation (e.g., '1.23e+04' has 3 sig figs, specified by '.2e').\n        return float(f'{x:.{sf-1}e}')\n\n    def get_xi1_n1():\n        \"\"\"\n        Numerically solves the n=1 Lane-Emden equation to find the first zero, xi_1.\n        The ODE is theta'' + (2/xi)*theta' + theta = 0.\n        Let y = [theta, theta'], then the system is:\n        y[0]' = y[1]\n        y[1]' = -(2/xi)*y[1] - y[0]\n        \"\"\"\n        \n        def lane_emden_ode_system(xi, y):\n            \"\"\"Defines the system of first-order ODEs.\"\"\"\n            # y[0] = theta, y[1] = d(theta)/d(xi)\n            y0, y1 = y\n            # This check is for robustness; the solver should not call at xi=0\n            # due to the integration start point xi_start > 0.\n            if xi == 0:\n                return [0.0, 0.0]\n            \n            # The system of ODEs\n            dy0_dxi = y1\n            dy1_dxi = -2.0 / xi * y1 - y0\n            return [dy0_dxi, dy1_dxi]\n\n        # An event function to find the first root of theta(xi).\n        def root_event(xi, y):\n            # The event occurs when y[0] (theta) is zero.\n            return y[0]\n        \n        # Stop integration when the root is found.\n        root_event.terminal = True\n        # Find root only when the function is decreasing.\n        root_event.direction = -1\n\n        # To avoid the singularity at xi=0, start integration at a small xi_start.\n        xi_start = 1.0e-8\n\n        # Use the series expansion for theta(xi) near xi=0 for initial conditions:\n        # theta(xi) approx 1 - xi^2/6\n        # theta'(xi) approx -xi/3\n        theta_start = 1.0 - xi_start**2 / 6.0\n        dtheta_dxi_start = -xi_start / 3.0\n        y_start = [theta_start, dtheta_dxi_start]\n\n        # Integration interval. We know the analytical solution is pi ~ 3.14,\n        # so integrating to 4.0 is safe.\n        xi_span = [xi_start, 4.0]\n\n        # Use solve_ivp for high-precision integration.\n        sol = solve_ivp(\n            lane_emden_ode_system,\n            xi_span,\n            y_start,\n            events=root_event,\n            dense_output=True,\n            rtol=1e-12,  # Set strict tolerances for accuracy\n            atol=1e-12\n        )\n\n        # The first zero xi_1 is stored in the event times.\n        if sol.status == 1 and len(sol.t_events[0]) > 0:\n            return sol.t_events[0][0]\n        else:\n            # Fallback to the known analytical solution if the solver fails.\n            # This case should not be reached with the current setup.\n            return np.pi\n\n    # For the n=1 case, xi_1 is a constant, so we calculate it only once.\n    # The numerical result will be extremely close to np.pi.\n    xi_1 = get_xi1_n1()\n\n    results = []\n    for K, rho_c in test_cases:\n        # Calculate the characteristic length scale 'a' for n=1.\n        # Note that 'a' is independent of rho_c for n=1.\n        a = np.sqrt(K / (2.0 * np.pi * G))\n\n        # Calculate the physical radius R = a * xi_1.\n        R = a * xi_1\n\n        # Round the result to three significant figures as required.\n        R_rounded = round_to_sf(R, 3)\n        results.append(R_rounded)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}