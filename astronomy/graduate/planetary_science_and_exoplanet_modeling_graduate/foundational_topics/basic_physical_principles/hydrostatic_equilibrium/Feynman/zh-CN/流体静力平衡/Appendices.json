{
    "hands_on_practices": [
        {
            "introduction": "理论学习的最佳起点往往是最简洁的模型。本练习将引导你推导一个均匀密度球体内部的压力分布，这是理解行星内部结构的经典入门问题。通过直接对静力平衡方程进行积分，你将获得一个解析解，它清晰地揭示了压力如何随深度增加以支撑上覆物质的重量，并与行星的总质量和半径建立起直接联系。",
            "id": "4163753",
            "problem": "考虑一个非旋转、球对称的系外行星内部模型，其体密度是均匀的，对于 $0 \\le r \\le R$，$ \\rho $ 等于一个常数。假设牛顿引力，其中球体内半径 $r$ 处的局部引力加速度由其包裹的质量 $M(r)$ 通过 $g(r) = G M(r) / r^{2}$ 决定，并且包裹质量遵循标准的质量连续性关系 $\\mathrm{d}M/\\mathrm{d}r = 4 \\pi r^{2} \\rho$，且 $M(0) = 0$。行星内部处于静流体平衡状态，其中压力 $P(r)$ 满足径向力平衡方程 $\\mathrm{d}P/\\mathrm{d}r = - \\rho \\, g(r)$。施加物理上现实的边界条件，即表面压力为零，$P(R) = 0$。推导在 $0 \\le r \\le R$ 范围内，压力分布 $P(r)$ 关于 $G$, $\\rho$, $R$ 和 $r$ 的闭式解析表达式。以单一显式表达式（不含积分）给出您的最终结果，以符号形式表示；不要进行任何数值计算。",
            "solution": "问题陈述已经过验证，被认为是科学上合理、适定且客观的。它提供了一套完整且一致的方程和边界条件，用于在一个简化的行星内部模型中推导压力分布。该问题是静流体平衡中的一个标准练习，没有任何使其无效的缺陷。\n\n目标是推导一个密度均匀为 $\\rho$、半径为 $R$ 的自引力球体内部的压力分布表达式 $P(r)$。推导过程分为三个主要步骤：首先，确定包裹的质量 $M(r)$；其次，求出引力加速度 $g(r)$；第三，积分静流体平衡方程以求得 $P(r)$。\n\n第一步是求出半径 $r$（其中 $0 \\le r \\le R$）内包裹的质量 $M(r)$。问题给出了质量连续性关系：\n$$ \\frac{\\mathrm{d}M}{\\mathrm{d}r} = 4 \\pi r^{2} \\rho $$\n这个常微分方程可以通过从中心（$r=0$ 且 $M=0$）到任意半径 $r$ 的直接积分来求解。由于密度 $\\rho$ 是一个给定的常数：\n$$ M(r) = \\int_{0}^{r} \\frac{\\mathrm{d}M}{\\mathrm{d}r'} \\, \\mathrm{d}r' = \\int_{0}^{r} 4 \\pi (r')^{2} \\rho \\, \\mathrm{d}r' $$\n$$ M(r) = 4 \\pi \\rho \\int_{0}^{r} (r')^{2} \\, \\mathrm{d}r' = 4 \\pi \\rho \\left[ \\frac{(r')^{3}}{3} \\right]_{0}^{r} $$\n$$ M(r) = \\frac{4}{3} \\pi \\rho r^{3} $$\n这个结果证实了包裹的质量就是半径为 $r$ 的球体体积乘以恒定密度 $\\rho$。\n\n第二步是确定半径 $r$ 处的局部引力加速度 $g(r)$。问题指出，这遵循包裹质量的牛顿引力定律：\n$$ g(r) = \\frac{G M(r)}{r^{2}} $$\n代入上面推导出的 $M(r)$ 表达式，得到：\n$$ g(r) = \\frac{G}{r^{2}} \\left( \\frac{4}{3} \\pi \\rho r^{3} \\right) = \\frac{4}{3} \\pi G \\rho r $$\n这表明，在一个均匀球体内部，引力加速度随离中心距离的增加而线性增加。\n\n第三步也是最后一步，是求解压力分布 $P(r)$。行星处于静流体平衡状态，满足以下方程：\n$$ \\frac{\\mathrm{d}P}{\\mathrm{d}r} = - \\rho \\, g(r) $$\n负号表示压力必须向中心增加，以抵消向内的引力。代入 $g(r)$ 的表达式：\n$$ \\frac{\\mathrm{d}P}{\\mathrm{d}r} = - \\rho \\left( \\frac{4}{3} \\pi G \\rho r \\right) = - \\frac{4}{3} \\pi G \\rho^{2} r $$\n为了求得 $P(r)$，我们对该方程关于 $r$ 进行积分：\n$$ P(r) = \\int \\left( - \\frac{4}{3} \\pi G \\rho^{2} r \\right) \\mathrm{d}r = - \\frac{4}{3} \\pi G \\rho^{2} \\int r \\, \\mathrm{d}r $$\n$$ P(r) = - \\frac{4}{3} \\pi G \\rho^{2} \\frac{r^{2}}{2} + C = - \\frac{2}{3} \\pi G \\rho^{2} r^{2} + C $$\n其中 $C$ 是积分常数。为了确定 $C$，我们应用边界条件，即行星表面（$r=R$）的压力为零，即 $P(R) = 0$。\n$$ P(R) = - \\frac{2}{3} \\pi G \\rho^{2} R^{2} + C = 0 $$\n求解 $C$，我们得到：\n$$ C = \\frac{2}{3} \\pi G \\rho^{2} R^{2} $$\n将 $C$ 的这个值代回 $P(r)$ 的通解表达式中：\n$$ P(r) = - \\frac{2}{3} \\pi G \\rho^{2} r^{2} + \\frac{2}{3} \\pi G \\rho^{2} R^{2} $$\n提取公因式，得到压力分布的最终闭式解析表达式：\n$$ P(r) = \\frac{2}{3} \\pi G \\rho^{2} (R^{2} - r^{2}) $$\n该表达式给出了系外行星模型中任意半径 $r$ 处的压力（对于 $0 \\le r \\le R$），用给定的物理常数和参数表示。",
            "answer": "$$\\boxed{\\frac{2}{3} \\pi G \\rho^{2} (R^{2} - r^{2})}$$"
        },
        {
            "introduction": "虽然均匀密度模型极具启发性，但真实行星的密度是随压力变化的。本练习引入了更符合物理现实的多方模型，其压力和密度通过幂律关系（即 $P = K\\rho^{1+1/n}$）联系在一起，这引出了著名的莱恩-埃姆登方程。你将通过编写数值求解器，解决 $n=1$ 情形下的该方程，从而将抽象的理论结构方程与行星半径等可观测物理量联系起来，这是连接理论与计算建模的关键一步。",
            "id": "4163806",
            "problem": "考虑一个自引力、球对称的流体球，其状态方程为多方方程 $P = K \\rho^{1 + 1/n}$，其中 $P$ 是压力，$\\rho$ 是质量密度，$K$ 是多方常数，$n$ 是多方指数。假设牛顿引力和流体静力学平衡，其中力平衡由 $dP/dr = -\\rho G M(r) / r^2$ 决定，质量连续性由 $dM/dr = 4 \\pi r^2 \\rho$ 决定，$G$ 是引力常数，$M(r)$ 是半径 $r$ 内包含的质量。在本问题中，我们专门研究指数 $n=1$ 的情况，这与行星科学和系外行星在流体静力学平衡下的内部建模相关。\n\n从所述基本定律和定义出发，推导指数 $n=1$ 多方球的无量纲常微分方程（ODE），即著名的 Lane-Emden 方程。通过变换 $\\rho(r) = \\rho_c \\theta(\\xi)^n$ 和 $r = a \\xi$ 定义无量纲函数 $\\theta(\\xi)$ 和相似长度尺度 $a$，其中 $\\rho_c$ 是中心密度。应用中心的正则性条件 $\\theta(0) = 1$ 和 $\\left.\\frac{d\\theta}{d\\xi}\\right|_{\\xi=0} = 0$，并使用在 $\\xi=0$ 附近的级数展开来初始化数值积分。\n\n你必须实现一个数值求解器来：\n- 从一个小的正值 $\\xi$ 向外积分 $n=1$ 的 Lane-Emden 常微分方程，直到 $\\theta(\\xi)$ 的第一个零点 $\\xi_1$。\n- 使用推导出的连接相似长度 $a$与物理参数 $(K, \\rho_c)$ 和常数的关系式，计算物理半径 $R = a \\xi_1$。\n\n所有量必须使用国际单位制（SI）处理。使用 $G = 6.67430 \\times 10^{-11} \\, \\mathrm{m^3 \\, kg^{-1} \\, s^{-2}}$。对于 $n=1$，$K$ 的国际单位制单位是 $\\mathrm{m^5 \\, kg^{-1} \\, s^{-2}}$，$\\rho_c$ 的国际单位制单位是 $\\mathrm{kg \\, m^{-3}}$。最终半径 $R$ 以米为单位表示，并四舍五入到三位有效数字。\n\n测试套件：\n- 案例 1：$(K, \\rho_c) = (10^3, 10^3)$。\n- 案例 2：$(K, \\rho_c) = (10^5, 5 \\times 10^3)$。\n- 案例 3：$(K, \\rho_c) = (10^7, 2 \\times 10^3)$。\n- 案例 4：$(K, \\rho_c) = (10^3, 3 \\times 10^2)$。\n\n你的程序必须：\n- 通过积分 $n=1$ 的 Lane-Emden 常微分方程，使用指定的中心正则性条件和在 $\\xi=0$ 附近的级数展开起点，数值确定 $\\xi_1$。\n- 对每个测试案例计算 $R$，并以浮点数形式返回结果（四舍五入到三位有效数字），单位为米。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3,r_4]$），其中每个 $r_i$ 是相应测试案例的半径，单位为米，四舍五入到三位有效数字。",
            "solution": "评估问题陈述的有效性。\n\n### 第 1 步：提取已知条件\n- **状态方程**：多方方程，$P = K \\rho^{1 + 1/n}$。\n- **特殊情况**：多方指数 $n=1$。\n- **控制方程**：\n    - 流体静力学平衡：$dP/dr = -\\rho G M(r) / r^2$。\n    - 质量连续性：$dM/dr = 4 \\pi r^2 \\rho$。\n- **定义**：\n    - $P$：压力\n    - $\\rho$：质量密度\n    - $K$：多方常数\n    - $n$：多方指数\n    - $r$：径向坐标\n    - $G$：引力常数\n    - $M(r)$：半径 $r$ 内包含的质量。\n- **无量纲变换**：\n    - $\\rho(r) = \\rho_c \\theta(\\xi)^n$\n    - $r = a \\xi$\n    - $\\rho_c$：中心密度。\n    - $\\theta(\\xi)$：无量纲函数。\n    - $a$：相似长度尺度。\n- **边界条件**：\n    - 中心正则性：$\\theta(0) = 1$ 和 $d\\theta/d\\xi \\big|_{\\xi=0} = 0$。\n- **常数**：\n    - 引力常数：$G = 6.67430 \\times 10^{-11} \\, \\mathrm{m^3 \\, kg^{-1} \\, s^{-2}}$。\n- **任务要求**：\n    1. 推导 $n=1$ 的 Lane-Emden 常微分方程。\n    2. 从一个小的正值 $\\xi$（用级数展开初始化）开始数值积分该常微分方程，以找到第一个零点 $\\xi_1$。\n    3. 对给定的测试案例计算物理半径 $R = a \\xi_1$。\n    4. 将 $R$ 以米为单位表示，并四舍五入到三位有效数字。\n- **测试套件**：\n    - 案例 1：$(K, \\rho_c) = (10^3 \\, \\mathrm{m^5 \\, kg^{-1} \\, s^{-2}}, 10^3 \\, \\mathrm{kg \\, m^{-3}})$。\n    - 案例 2：$(K, \\rho_c) = (10^5 \\, \\mathrm{m^5 \\, kg^{-1} \\, s^{-2}}, 5 \\times 10^3 \\, \\mathrm{kg \\, m^{-3}})$。\n    - 案例 3：$(K, \\rho_c) = (10^7 \\, \\mathrm{m^5 \\, kg^{-1} \\, s^{-2}}, 2 \\times 10^3 \\, \\mathrm{kg \\, m^{-3}})$。\n    - 案例 4：$(K, \\rho_c) = (10^3 \\, \\mathrm{m^5 \\, kg^{-1} \\, s^{-2}}, 3 \\times 10^2 \\, \\mathrm{kg \\, m^{-3}})$。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题基于自引力多方流体的标准牛顿模型，这是恒星结构和行星内部建模的基石。所涉及的方程和概念是天体物理学的基础。该问题有效。\n- **适定性**：该问题提供了一整套方程、边界条件和常数，足以确定指定物体结构的唯一解。任务定义明确。该问题有效。\n- **客观性**：语言精确且定量。所有术语均为该领域的标准术语。该问题有效。\n\n该问题没有任何科学上不健全、信息缺失或含糊不清等缺陷。这是一个理论天体物理学中标准的、可解的问题。\n\n### 第 3 步：结论与行动\n问题是**有效的**。开始求解。\n\n### Lane-Emden 方程的推导\n分析从球对称和流体静力学平衡假设下的恒星结构基本方程开始。流体静力学平衡方程为\n$$ \\frac{dP}{dr} = -\\frac{G M(r) \\rho(r)}{r^2} $$\n质量连续性方程为\n$$ \\frac{dM(r)}{dr} = 4 \\pi r^2 \\rho(r) $$\n为了得到一个二阶微分方程，我们首先整理流体静力学平衡方程，然后对其求导：\n$$ \\frac{r^2}{\\rho} \\frac{dP}{dr} = -G M(r) $$\n$$ \\frac{d}{dr}\\left(\\frac{r^2}{\\rho} \\frac{dP}{dr}\\right) = -G \\frac{dM}{dr} $$\n将质量连续性方程代入右侧，得到一个联系压力和密度的组合方程：\n$$ \\frac{d}{dr}\\left(\\frac{r^2}{\\rho} \\frac{dP}{dr}\\right) = -G (4 \\pi r^2 \\rho) $$\n两边除以 $r^2$ 得到结构方程，它等价于引力势的泊松方程：\n$$ \\frac{1}{r^2}\\frac{d}{dr}\\left(\\frac{r^2}{\\rho} \\frac{dP}{dr}\\right) = -4 \\pi G \\rho $$\n接下来，我们引入多方状态方程 $P = K\\rho^{1+1/n}$。压力梯度为\n$$ \\frac{dP}{dr} = K\\left(1+\\frac{1}{n}\\right)\\rho^{1/n}\\frac{d\\rho}{dr} $$\n将其代入结构方程：\n$$ \\frac{1}{r^2}\\frac{d}{dr}\\left(\\frac{r^2}{\\rho} \\cdot K\\left(1+\\frac{1}{n}\\right)\\rho^{1/n}\\frac{d\\rho}{dr}\\right) = -4 \\pi G \\rho $$\n$$ \\frac{K(n+1)}{n}\\frac{1}{r^2}\\frac{d}{dr}\\left(r^2 \\rho^{(1/n) - 1}\\frac{d\\rho}{dr}\\right) = -4 \\pi G \\rho $$\n现在，我们引入无量纲变量 $\\rho(r) = \\rho_c \\theta(\\xi)^n$ 和 $r = a \\xi$，其中 $\\rho_c$ 是中心密度，$a$ 是特征长度尺度。导数变换如下：\n$$ \\frac{d\\rho}{dr} = \\frac{d\\rho}{d\\theta}\\frac{d\\theta}{d\\xi}\\frac{d\\xi}{dr} = (\\rho_c n \\theta^{n-1})\\left(\\frac{d\\theta}{d\\xi}\\right)\\left(\\frac{1}{a}\\right) $$\n将这些代入方程得到：\n$$ \\frac{K(n+1)}{n}\\frac{1}{a^2 \\xi^2}\\frac{d}{a d\\xi}\\left( (a\\xi)^2 (\\rho_c \\theta^n)^{(1-n)/n} \\frac{\\rho_c n \\theta^{n-1}}{a}\\frac{d\\theta}{d\\xi} \\right) = -4 \\pi G \\rho_c\\theta^n $$\n简化后，表达式变为：\n$$ \\left[\\frac{(n+1)K \\rho_c^{(1/n)-1}}{4 \\pi G a^2}\\right] \\frac{1}{\\xi^2}\\frac{d}{d\\xi}\\left(\\xi^2\\frac{d\\theta}{d\\xi}\\right) = - \\theta^n $$\n选择长度尺度 $a$ 使方括号中的项等于 1：\n$$ a^2 = \\frac{(n+1)K \\rho_c^{(1-n)/n}}{4 \\pi G} \\implies a = \\left[\\frac{(n+1)K}{4\\pi G}\\right]^{1/2}\\rho_c^{(1-n)/(2n)} $$\n通过这个选择，我们得到了一般的 Lane-Emden 方程：\n$$ \\frac{1}{\\xi^2}\\frac{d}{d\\xi}\\left(\\xi^2\\frac{d\\theta}{d\\xi}\\right) + \\theta^n = 0 $$\n对于 $n=1$ 的特殊情况，长度尺度 $a$ 的方程显著简化，因为涉及 $\\rho_c$ 的项消失了：\n$$ a = \\left[\\frac{(1+1)K}{4\\pi G}\\right]^{1/2}\\rho_c^{(1-1)/2} = \\sqrt{\\frac{2K}{4\\pi G}} = \\sqrt{\\frac{K}{2\\pi G}} $$\n对于 $n=1$ 的 Lane-Emden 方程是：\n$$ \\frac{1}{\\xi^2}\\frac{d}{d\\xi}\\left(\\xi^2\\frac{d\\theta}{d\\xi}\\right) + \\theta = 0 $$\n也可以写成 $\\xi^2\\theta'' + 2\\xi\\theta' + \\xi^2\\theta = 0$。\n\n### 数值解法策略\n$n=1$ 的 Lane-Emden 方程是一个二阶常微分方程。这个特殊情况有一个著名的解析解 $\\theta(\\xi) = \\frac{\\sin(\\xi)}{\\xi}$，它满足边界条件 $\\theta(0)=1$ 和 $\\theta'(0)=0$。第一个零点 $\\xi_1$ 是密度和压力变为零的地方，对应于 $\\sin(\\xi)$ 的第一个非平凡根，即 $\\xi_1=\\pi$。物理半径为 $R=a\\xi_1$。\n\n虽然存在解析解，但问题要求数值解。为了进行数值求解，我们首先将二阶常微分方程转换为一个由两个一阶常微分方程组成的系统。设 $y_0 = \\theta$ 和 $y_1 = \\theta' = d\\theta/d\\xi$。该系统为：\n$$ \\frac{dy_0}{d\\xi} = y_1 $$\n$$ \\frac{dy_1}{d\\xi} = -\\frac{2}{\\xi}y_1 - y_0 $$\n由于 $1/\\xi$ 项的存在，在 $\\xi=0$ 处存在一个奇点。我们不能从 $\\xi=0$ 开始积分。取而代之的是，我们使用 $\\theta(\\xi)$ 在 $\\xi=0$ 附近的级数展开，以在一个小的、非零的 $\\xi_{start}$ 处找到初始值。一般级数解的形式为 $\\theta(\\xi) = \\sum_{k=0}^{\\infty} c_k \\xi^k$。应用边界条件，对于 $n=1$ 的情况，级数解被发现为：\n$$ \\theta(\\xi) = 1 - \\frac{1}{6}\\xi^2 + \\frac{1}{120}\\xi^4 - \\dots $$\n其导数为：\n$$ \\theta'(\\xi) = -\\frac{1}{3}\\xi + \\frac{1}{30}\\xi^3 - \\dots $$\n我们使用这些截断的级数来设置在一个小的 $\\xi_{start} \\ll 1$ 处的初始条件：\n$$ y_0(\\xi_{start}) \\approx 1 - \\frac{\\xi_{start}^2}{6} $$\n$$ y_1(\\xi_{start}) \\approx -\\frac{\\xi_{start}}{3} $$\n利用这些初始值，我们可以使用数值积分器（例如 `scipy.integrate.solve_ivp` 中实现的 Runge-Kutta 方法）从 $\\xi_{start}$ 向外求解该系统。使用事件查找功能来精确定位第一个根 $\\xi_1$，即 $y_0(\\xi) = \\theta(\\xi)$ 穿过零的点。\n\n### 最终计算\n算法如下：\n1.  使用指定的初始条件数值求解 $n=1$ 的 Lane-Emden 常微分方程系统以找到 $\\xi_1$。此数值积分的结果应非常接近解析值 $\\pi$。\n2.  对于测试套件中的每一对 $(K, \\rho_c)$，计算特征长度尺度 $a = \\sqrt{K/(2\\pi G)}$。注意，对于 $n=1$，$a$ 与中心密度 $\\rho_c$ 无关。\n3.  使用 $R = a \\xi_1$ 计算球体的物理半径。\n4.  将每种情况下 $R$ 的最终值四舍五入到三位有效数字。\n\n实现将执行这些步骤以生成所需的输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Derives and solves the n=1 Lane-Emden equation to determine the radius of a \n    polytropic fluid sphere.\n    \"\"\"\n\n    # Define the gravitational constant in SI units.\n    G = 6.67430e-11  # m^3 kg^-1 s^-2\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (K, rho_c).\n    # K is in m^5 kg^-1 s^-2, rho_c is in kg m^-3.\n    test_cases = [\n        (1.0e3, 1.0e3),\n        (1.0e5, 5.0e3),\n        (1.0e7, 2.0e3),\n        (1.0e3, 3.0e2),\n    ]\n\n    def round_to_sf(x, sf):\n        \"\"\"\n        Rounds a number to a specified number of significant figures.\n        \"\"\"\n        if x == 0:\n            return 0.0\n        # Use string formatting to control significant figures reliably.\n        # {sf-1} is used because the format specifier is for digits after the decimal point\n        # in scientific notation (e.g., '1.23e+04' has 3 sig figs, specified by '.2e').\n        return float(f'{x:.{sf-1}e}')\n\n    def get_xi1_n1():\n        \"\"\"\n        Numerically solves the n=1 Lane-Emden equation to find the first zero, xi_1.\n        The ODE is theta'' + (2/xi)*theta' + theta = 0.\n        Let y = [theta, theta'], then the system is:\n        y[0]' = y[1]\n        y[1]' = -(2/xi)*y[1] - y[0]\n        \"\"\"\n        \n        def lane_emden_ode_system(xi, y):\n            \"\"\"Defines the system of first-order ODEs.\"\"\"\n            # y[0] = theta, y[1] = d(theta)/d(xi)\n            y0, y1 = y\n            # This check is for robustness; the solver should not call at xi=0\n            # due to the integration start point xi_start > 0.\n            if xi == 0:\n                return [0.0, 0.0]\n            \n            # The system of ODEs\n            dy0_dxi = y1\n            dy1_dxi = -2.0 / xi * y1 - y0\n            return [dy0_dxi, dy1_dxi]\n\n        # An event function to find the first root of theta(xi).\n        def root_event(xi, y):\n            # The event occurs when y[0] (theta) is zero.\n            return y[0]\n        \n        # Stop integration when the root is found.\n        root_event.terminal = True\n        # Find root only when the function is decreasing.\n        root_event.direction = -1\n\n        # To avoid the singularity at xi=0, start integration at a small xi_start.\n        xi_start = 1.0e-8\n\n        # Use the series expansion for theta(xi) near xi=0 for initial conditions:\n        # theta(xi) approx 1 - xi^2/6\n        # theta'(xi) approx -xi/3\n        theta_start = 1.0 - xi_start**2 / 6.0\n        dtheta_dxi_start = -xi_start / 3.0\n        y_start = [theta_start, dtheta_dxi_start]\n\n        # Integration interval. We know the analytical solution is pi ~ 3.14,\n        # so integrating to 4.0 is safe.\n        xi_span = [xi_start, 4.0]\n\n        # Use solve_ivp for high-precision integration.\n        sol = solve_ivp(\n            lane_emden_ode_system,\n            xi_span,\n            y_start,\n            events=root_event,\n            dense_output=True,\n            rtol=1e-12,  # Set strict tolerances for accuracy\n            atol=1e-12\n        )\n\n        # The first zero xi_1 is stored in the event times.\n        if sol.status == 1 and len(sol.t_events[0]) > 0:\n            return sol.t_events[0][0]\n        else:\n            # Fallback to the known analytical solution if the solver fails.\n            # This case should not be reached with the current setup.\n            return np.pi\n\n    # For the n=1 case, xi_1 is a constant, so we calculate it only once.\n    # The numerical result will be extremely close to np.pi.\n    xi_1 = get_xi1_n1()\n\n    results = []\n    for K, rho_c in test_cases:\n        # Calculate the characteristic length scale 'a' for n=1.\n        # Note that 'a' is independent of rho_c for n=1.\n        a = np.sqrt(K / (2.0 * np.pi * G))\n\n        # Calculate the physical radius R = a * xi_1.\n        R = a * xi_1\n\n        # Round the result to three significant figures as required.\n        R_rounded = round_to_sf(R, 3)\n        results.append(R_rounded)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在行星科学中，认识到一个模型的适用边界与应用模型本身同样重要。静力平衡是一个描述流体静止状态的理想化假设，但在像热木星这样的大气剧烈运动的动态系统中，其有效性必须经过检验。本练习要求你运用量级分析这一核心物理工具，评估垂直方向上的流体加速度与引力的相对重要性，从而量化对静力平衡的偏离，这对于解释复杂的环流模型和观测数据至关重要。",
            "id": "4163749",
            "problem": "一个以氢为主的热木星大气层受到强烈的昼夜恒星辐射差异驱动，产生超音速的水平风和剧烈但相对温和的垂直运动。考虑重力作用下可压缩流体的垂直动量平衡。从应用于流体微元的牛顿第二定律出发，写出动量方程的垂直分量。通过用速度、空间和时间的特征尺度对此方程进行无量纲化，确定垂直力平衡简化为静力平衡的条件，并定义一个无量纲参数，该参数通过物质垂直加速度与重力的比值来量化与静力平衡的偏差。不要先验地假设任何专门的“原始方程”形式；从牛顿第二定律构建。\n\n然后，给你一个典型的热木星在 $0.1$ 巴气压层上一个有代表性的、强迫的全球环流模型（GCM）快照。在一个特征性的昼夜水平尺度上，该流场表现出以下尺度：\n- 特征纬向风速 $U = 3.0 \\times 10^{3} \\, \\text{m s}^{-1}$。\n- 特征经向风速 $V = 1.0 \\times 10^{3} \\, \\text{m s}^{-1}$。\n- 均方根垂直速度 $W = 50 \\, \\text{m s}^{-1}$。\n- 水平长度尺度（昼夜差异尺度） $L_{h} = 1.5 \\times 10^{8} \\, \\text{m}$。\n- 垂直标高 $H = 5.0 \\times 10^{5} \\, \\text{m}$。\n- 该层上的时间变化时间尺度 $\\tau = 6.0 \\times 10^{3} \\, \\text{s}$。\n- 重力加速度 $g = 12 \\, \\text{m s}^{-2}$。\n\n假设在该层上，瞬时垂直动量平衡中的垂直科里奥利项和粘性项可以忽略不计。使用对垂直速度 $w$ 的物质导数的尺度分析，估计\n$$\\left|\\frac{D w}{D t}\\right| \\approx \\left|\\frac{\\partial w}{\\partial t}\\right| + \\left|u \\frac{\\partial w}{\\partial x}\\right| + \\left|v \\frac{\\partial w}{\\partial y}\\right| + \\left|w \\frac{\\partial w}{\\partial z}\\right|,$$\n使用替换 $\\left|\\frac{\\partial w}{\\partial t}\\right| \\sim \\frac{W}{\\tau}$，$\\left|\\frac{\\partial w}{\\partial x}\\right| \\sim \\frac{W}{L_{h}}$，$\\left|\\frac{\\partial w}{\\partial y}\\right| \\sim \\frac{W}{L_{h}}$，以及 $\\left|\\frac{\\partial w}{\\partial z}\\right| \\sim \\frac{W}{H}$，并利用上述特征速度 $U$、$V$ 和 $W$ 进行评估。\n\n最后，评估定义为物质垂直加速度大小与重力加速度大小之比的无量纲参数 $\\epsilon$，并报告此快照的数值：\n$$\\epsilon \\equiv \\frac{\\left|D w / D t\\right|}{g}。$$\n将最终的 $\\epsilon$ 表示为一个纯数（无单位），并将答案四舍五入到四位有效数字。",
            "solution": "问题要求完成两个主要任务：首先，从第一性原理推导垂直动量方程，并定义一个量化与静力平衡偏差的无量纲参数；其次，为一个特定的热木星大气模型计算该参数的值。\n\n该问题被验证为具有科学依据、问题明确且客观。它基于应用于行星大气层的流体动力学基本原理，这是该领域的标准做法。所有必要的数据和定义都已提供，并且在热木星的背景下，这些约束条件是一致且物理上合理的。\n\n首先，我们推导垂直动量方程。我们考虑一个体积为 $\\delta V$、密度为 $\\rho$ 的小质量固定流体微元。根据牛顿第二定律，作用在微元上的合力等于其质量乘以加速度。流体微元的加速度由速度矢量的物质导数 $\\frac{D\\vec{v}}{Dt}$ 给出。微元的质量为 $m = \\rho \\delta V$。\n\n我们关注运动的垂直分量（$z$方向）。作用在流体微元上垂直方向的力是气压梯度力和引力。设微元具有水平截面积 $\\delta A$ 和垂直厚度 $\\delta z$，因此 $\\delta V = \\delta A \\delta z$。在高度 $z$ 处的底面压力为 $P(z)$，在 $z+\\delta z$ 处的顶面压力为 $P(z+\\delta z)$。垂直方向上的净压力为 $F_{P,z} = P(z) \\delta A - P(z+\\delta z) \\delta A = -[P(z+\\delta z) - P(z)] \\delta A$。对于一个无穷小的微元，这近似为 $F_{P,z} \\approx -\\frac{\\partial P}{\\partial z} \\delta z \\delta A = -\\frac{\\partial P}{\\partial z} \\delta V$。\n\n引力为 $F_{g,z} = -mg = -(\\rho \\delta V) g$，其中 $g$ 是重力加速度，定义为正值，负号表示力朝下（在负 $z$ 方向）。\n\n问题指出，垂直科里奥利项和粘性项可以忽略不计。因此，垂直方向的合力为 $\\sum F_z = F_{P,z} + F_{g,z} = (-\\frac{\\partial P}{\\partial z} - \\rho g)\\delta V$。\n\n流体微元的牛顿第二定律的垂直分量为 $m \\frac{Dw}{Dt} = \\sum F_z$，其中 $w$ 是速度矢量 $\\vec{v}$ 的垂直分量。代入质量和力的表达式：\n$$(\\rho \\delta V) \\frac{Dw}{Dt} = \\left(-\\frac{\\partial P}{\\partial z} - \\rho g\\right) \\delta V$$\n两边除以质量密度 $\\rho$ 和体积 $\\delta V$ 得到垂直动量方程：\n$$\\frac{Dw}{Dt} = -\\frac{1}{\\rho}\\frac{\\partial P}{\\partial z} - g$$\n\n静力平衡是没有垂直加速度的状态，即 $\\frac{Dw}{Dt} = 0$。在这种情况下，垂直动量方程简化为气压梯度力与重力之间的平衡：\n$$-\\frac{1}{\\rho}\\frac{\\partial P}{\\partial z} - g = 0 \\quad \\implies \\quad \\frac{\\partial P}{\\partial z} = -\\rho g$$\n这种平衡成立的条件是，当物质垂直加速度 $\\frac{Dw}{Dt}$ 与重力加速度 $g$ 相比可以忽略不计时。一个量化与静力平衡偏差的无量纲参数可以定义为物质垂直加速度的大小与重力加速度的大小之比。这个参数，我们用 $\\epsilon$ 表示，正是问题所要求的：\n$$\\epsilon \\equiv \\frac{|Dw/Dt|}{g}$$\n静力平衡近似有效的条件是 $\\epsilon \\ll 1$。\n\n接下来，我们为给定的热木星模型评估 $\\epsilon$。垂直速度 $w$ 的物质导数由下式给出：\n$$\\frac{Dw}{Dt} = \\frac{\\partial w}{\\partial t} + u \\frac{\\partial w}{\\partial x} + v \\frac{\\partial w}{\\partial y} + w \\frac{\\partial w}{\\partial z}$$\n问题基于尺度分析为其大小提供了一个近似值：\n$$\\left|\\frac{Dw}{Dt}\\right| \\approx \\left|\\frac{\\partial w}{\\partial t}\\right| + \\left|u \\frac{\\partial w}{\\partial x}\\right| + \\left|v \\frac{\\partial w}{\\partial y}\\right| + \\left|w \\frac{\\partial w}{\\partial z}\\right|$$\n我们使用提供的特征尺度来估计每一项：\n$|\\frac{\\partial w}{\\partial t}| \\sim \\frac{W}{\\tau}$, $|u \\frac{\\partial w}{\\partial x}| \\sim U \\frac{W}{L_h}$, $|v \\frac{\\partial w}{\\partial y}| \\sim V \\frac{W}{L_h}$，以及 $|w \\frac{\\partial w}{\\partial z}| \\sim W \\frac{W}{H}$。\n\n给定的特征尺度为：\n- $U = 3.0 \\times 10^{3} \\text{ m s}^{-1}$\n- $V = 1.0 \\times 10^{3} \\text{ m s}^{-1}$\n- $W = 50 \\text{ m s}^{-1}$\n- $L_h = 1.5 \\times 10^{8} \\text{ m}$\n- $H = 5.0 \\times 10^{5} \\text{ m}$\n- $\\tau = 6.0 \\times 10^{3} \\text{ s}$\n- $g = 12 \\text{ m s}^{-2}$\n\n我们现在计算物质导数中每一项的大小：\n1. 时间导数项： $\\frac{W}{\\tau} = \\frac{50}{6.0 \\times 10^{3}} = \\frac{5}{600} = \\frac{1}{120} \\text{ m s}^{-2} \\approx 0.008333... \\text{ m s}^{-2}$。\n2. 纬向平流项： $U \\frac{W}{L_h} = (3.0 \\times 10^{3}) \\frac{50}{1.5 \\times 10^{8}} = \\frac{1.5 \\times 10^{5}}{1.5 \\times 10^{8}} = 1.0 \\times 10^{-3} \\text{ m s}^{-2}$。\n3. 经向平流项： $V \\frac{W}{L_h} = (1.0 \\times 10^{3}) \\frac{50}{1.5 \\times 10^{8}} = \\frac{5.0 \\times 10^{4}}{1.5 \\times 10^{8}} = \\frac{1}{3} \\times 10^{-3} \\text{ m s}^{-2} \\approx 0.000333... \\text{ m s}^{-2}$。\n4. 垂直平流项： $\\frac{W^2}{H} = \\frac{(50)^2}{5.0 \\times 10^{5}} = \\frac{2500}{5.0 \\times 10^{5}} = \\frac{2.5 \\times 10^{3}}{5.0 \\times 10^{5}} = 0.5 \\times 10^{-2} = 5.0 \\times 10^{-3} \\text{ m s}^{-2}$。\n\n将这些项相加，得到物质加速度的总估计大小：\n$$\\left|\\frac{Dw}{Dt}\\right| \\approx \\frac{1}{120} + 1.0 \\times 10^{-3} + \\frac{1}{3} \\times 10^{-3} + 5.0 \\times 10^{-3} \\text{ m s}^{-2}$$\n$$ \\left|\\frac{Dw}{Dt}\\right| \\approx 0.008333... + 0.001 + 0.000333... + 0.005 = 0.014666... \\text{ m s}^{-2} $$\n使用分数以确保精度：\n$$ \\left|\\frac{Dw}{Dt}\\right| \\approx \\frac{1}{120} + \\frac{1}{1000} + \\frac{1}{3000} + \\frac{1}{200} = \\frac{25}{3000} + \\frac{3}{3000} + \\frac{1}{3000} + \\frac{15}{3000} = \\frac{44}{3000} \\text{ m s}^{-2}$$\n\n最后，我们计算无量纲参数 $\\epsilon$：\n$$\\epsilon = \\frac{|Dw/Dt|}{g} \\approx \\frac{44/3000}{12} = \\frac{44}{3000 \\times 12} = \\frac{44}{36000} = \\frac{11}{9000}$$\n将此分数转换为小数：\n$$\\epsilon \\approx 0.0012222...$$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $1$、$2$、$2$ 和 $2$。第五位有效数字是 $2$，所以我们向下舍入。\n$$\\epsilon \\approx 0.001222$$\n这个很小的 $\\epsilon$ 值表明，即使在这样一个具有超音速水平风的动态活跃环境中，垂直动量平衡也非常接近静力平衡。",
            "answer": "$$\\boxed{0.001222}$$"
        }
    ]
}