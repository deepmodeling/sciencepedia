{
    "hands_on_practices": [
        {
            "introduction": "To understand a planet's climate, we begin with the most fundamental concept: its global energy balance. This first practice challenges you to derive the planetary equilibrium temperature from first principles, balancing the incoming energy from a star with the outgoing thermal radiation from the planet. By constructing this foundational model, you will gain a clear understanding of the key parameters—stellar flux, albedo, and emissivity—and the critical physical and geometric assumptions required for this simple yet powerful approximation .",
            "id": "4171371",
            "problem": "An exoplanet of radius $R$ orbits a star such that the time-averaged stellar irradiance incident at the top of the planet’s atmosphere is $S$. The planet reflects a fraction $A$ of the incident radiation at all wavelengths of the stellar spectrum (its Bond albedo), and absorbs the remainder. In the thermal infrared, the planet behaves as a greybody with bolometric emissivity $\\epsilon$ that is independent of wavelength across its thermal emission band. Assume negligible internal heat sources and sinks, and that the horizontal redistribution of heat is sufficiently rapid compared to radiative timescales so that the planet emits uniformly across its entire surface with a single temperature $T$ in a steady state.\n\nStarting only from conservation of energy and the Stefan–Boltzmann law for thermal emission, derive a closed-form analytic expression for the planet’s global radiative-equilibrium temperature $T$ in terms of $S$, $A$, $\\epsilon$, and the Stefan–Boltzmann constant $\\sigma$. Then, articulate the minimal set of physical and geometrical assumptions under which this expression is valid, including the origin of any geometric factors that appear due to averaging over incidence and emission.\n\nProvide your final expression for $T$ in closed form. No numerical evaluation is required. If you introduce any intermediate symbols, clearly define them in words. Do not cite or use any pre-derived planetary equilibrium-temperature formulas; the derivation should proceed from first principles as stated. Express your final answer as a single simplified analytic expression; no units are required in the final expression.",
            "solution": "The problem statement is deemed valid as it is scientifically grounded, well-posed, and objective. It provides a self-contained description of a standard physical model in planetary science, free from contradictions or ambiguities.\n\nThe derivation for the planet's global radiative-equilibrium temperature, $T$, proceeds from the fundamental principle of conservation of energy. For a planet in a thermal steady state with negligible internal heat sources, the power absorbed from its host star, $P_{\\text{absorbed}}$, must be equal to the thermal power it emits to space, $P_{\\text{emitted}}$.\n$$P_{\\text{absorbed}} = P_{\\text{emitted}}$$\n\nFirst, we formulate an expression for the absorbed power, $P_{\\text{absorbed}}$. The star provides a time-averaged irradiance $S$, which is the power per unit area incident on a surface perpendicular to the incoming radiation at the planet's orbital distance. The planet, being a sphere of radius $R$, intercepts this radiation over its geometric cross-section, which is a disk of area $A_{\\text{cross}} = \\pi R^2$. The total power incident on the planet is therefore the product of the irradiance and this intercept area.\n$$P_{\\text{incident}} = S \\cdot A_{\\text{cross}} = S \\pi R^2$$\nThe problem states that a fraction $A$ of this incident radiation is reflected back to space, where $A$ is the Bond albedo. The remaining fraction, $(1 - A)$, is absorbed by the planet. Thus, the total absorbed power is:\n$$P_{\\text{absorbed}} = (1 - A) P_{\\text{incident}} = (1 - A) S \\pi R^2$$\n\nNext, we formulate an expression for the emitted power, $P_{\\text{emitted}}$. The problem assumes that heat is redistributed efficiently across the planet, resulting in a single, uniform surface temperature $T$. The planet radiates this heat away into space from its entire spherical surface. The surface area of a sphere of radius $R$ is $A_{\\text{surface}} = 4 \\pi R^2$. According to the Stefan–Boltzmann law, the power radiated per unit area from a perfect blackbody is $\\sigma T^4$, where $\\sigma$ is the Stefan–Boltzmann constant. This planet is described as a greybody with a bolometric emissivity $\\epsilon$, which modifies the blackbody emission by this factor. Therefore, the power emitted per unit area by the planet is $\\epsilon \\sigma T^4$. The total power emitted over the entire surface is the product of this flux and the total surface area.\n$$P_{\\text{emitted}} = (\\epsilon \\sigma T^4) \\cdot A_{\\text{surface}} = \\epsilon \\sigma T^4 (4 \\pi R^2)$$\n\nNow, we apply the principle of energy conservation by equating the absorbed and emitted power.\n$$(1 - A) S \\pi R^2 = \\epsilon \\sigma T^4 (4 \\pi R^2)$$\nThe term $\\pi R^2$ appears on both sides of the equation and can be canceled. This demonstrates that, under the assumptions of this model, the equilibrium temperature is independent of the planet's size.\n$$(1 - A) S = 4 \\epsilon \\sigma T^4$$\n\nFinally, we solve for the temperature $T$ by isolating it.\n$$T^4 = \\frac{(1 - A) S}{4 \\epsilon \\sigma}$$\nTaking the fourth root of both sides gives the closed-form expression for the planet's radiative-equilibrium temperature.\n$$T = \\left( \\frac{(1 - A) S}{4 \\epsilon \\sigma} \\right)^{1/4}$$\n\nThe minimal set of physical and geometrical assumptions underpinning this expression is as follows:\n$1$. **Radiative Equilibrium:** The planet is in a steady state where the energy budget is balanced, meaning the absorbed solar power equals the emitted thermal power. This results in a constant global-mean temperature.\n$2$. **No Internal Heat Flux:** The model assumes that any contribution from internal heat sources (such as radioactive decay or primordial heat of formation) to the surface energy budget is negligible compared to the absorbed stellar energy.\n$3$. **Point-Source Star and Parallel Rays:** The star is assumed to be sufficiently distant that the incoming radiation can be treated as a set of parallel rays with uniform irradiance $S$.\n$4$. **Geometric Absorption and Emission:** The planet absorbs energy over its circular cross-sectional area ($\\pi R^2$), as this is the area it presents to the parallel incoming radiation. It emits energy over its entire spherical surface area ($4 \\pi R^2$). The ratio of these two areas, $\\frac{A_{\\text{surface}}}{A_{\\text{cross}}} = \\frac{4 \\pi R^2}{\\pi R^2} = 4$, gives rise to the geometric factor of $4$ in the denominator of the temperature expression. This factor represents the dilution of the absorbed energy over the full emitting surface.\n$5$. **Uniform Isothermal Surface:** The planet is assumed to have a single, uniform temperature $T$ across its entire surface and emits as an isotropic radiator. This implies a mechanism for perfect and rapid heat redistribution from the day side to the night side and from the equator to the poles, such as a thick, dynamic atmosphere or a global ocean.\n$6$. **Wavelength-Independent Optical Properties:** The Bond albedo $A$ is treated as a single constant representing the fraction of reflected power averaged over the entire stellar spectrum. Similarly, the emissivity $\\epsilon$ is a constant representing the emission efficiency averaged over the planet's thermal (infrared) emission spectrum. In this model, these parameters are independent of wavelength, temperature, or location on the planet. The term $\\epsilon  1$ implicitly accounts for any greenhouse effect, as it describes a reduced efficiency of radiative cooling to space compared to a perfect blackbody.",
            "answer": "$$\\boxed{T = \\left( \\frac{S(1-A)}{4\\epsilon\\sigma} \\right)^{1/4}}$$"
        },
        {
            "introduction": "Real planetary climates are not static; they involve complex feedback loops that can lead to dramatic shifts in global conditions. This exercise introduces this complexity by incorporating a temperature-dependent albedo, a simple but powerful representation of the ice-albedo feedback where temperature changes alter a planet's reflectivity. You will discover how such feedbacks can create multiple possible equilibrium climate states and learn to assess their stability, a cornerstone of climate dynamics and the study of planetary habitability .",
            "id": "4171354",
            "problem": "Consider a zero-dimensional (0D) planetary energy balance model for an exoplanet receiving stellar irradiance that is uniformly distributed over the globe. The absorbed shortwave flux is determined by a temperature-dependent Bond albedo $A(T)$, and the outgoing longwave radiation is represented by a commonly used linear parameterization. The model is described by the temporal evolution of the globally averaged surface temperature $T$ through conservation of energy:\nthe rate of change of the planet’s internal energy equals the net radiative flux into the system. Assume that the absorbed shortwave flux is $F_{\\mathrm{in}}(T) = (1 - A(T))\\,S/4$, where $S$ is the stellar constant, and the outgoing longwave radiation is $F_{\\mathrm{out}}(T) = F_{0} + \\lambda\\,T$, where $F_{0}$ and $\\lambda$ are constants obtained from a linearization of the radiative transfer around a reference state. This linearization is standard in zero-dimensional Energy Balance Models (EBMs) and is widely used to represent the effective emission of Outgoing Longwave Radiation (OLR). The temperature-dependent albedo captures ice-albedo and cloud feedbacks with a smooth cubic dependence about a reference temperature $T_{r}$:\n$$\nA(T) = A_{0} + a_{1}\\,(T - T_{r}) + a_{3}\\,(T - T_{r})^{3}.\n$$\nYou are given the following parameters (all are scientifically plausible for an Earth-like exoplanet):\n- Stellar constant $S = 1.361 \\times 10^{3}\\ \\mathrm{W\\,m^{-2}}$,\n- Reference temperature $T_{r} = 273\\ \\mathrm{K}$,\n- Albedo parameters $A_{0} = 0.30$, $a_{1} = -1.0 \\times 10^{-2}\\ \\mathrm{K^{-1}}$, $a_{3} = 1.0 \\times 10^{-5}\\ \\mathrm{K^{-3}}$,\n- OLR slope $\\lambda = 0.50\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$,\n- OLR intercept $F_{0} = 101.675\\ \\mathrm{W\\,m^{-2}}$.\n\nTasks:\n1. Starting from conservation of energy, derive the net flux $F_{\\mathrm{net}}(T)$ and the equilibrium condition for $T$.\n2. By introducing the temperature offset $\\theta = T - T_{r}$, reduce the equilibrium condition to an explicit algebraic equation in $\\theta$ with constant coefficients, and solve it analytically to obtain all equilibrium solutions for $T$.\n3. Assess the linear stability of each equilibrium by analyzing the sign of $\\mathrm{d}F_{\\mathrm{net}}/\\mathrm{d}T$ at the equilibrium temperatures, and classify each equilibrium as linearly stable or unstable.\n\nReport the three equilibrium temperatures in Kelvin, rounded to four significant figures. Express the final temperatures in K. Do not include units inside the final boxed answer.",
            "solution": "The problem statement is first validated against the required criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Model Equation**: The rate of change of the planet’s internal energy is equal to the net radiative flux, $F_{\\mathrm{net}}(T)$.\n- **Absorbed Shortwave Flux**: $F_{\\mathrm{in}}(T) = (1 - A(T))\\,S/4$.\n- **Outgoing Longwave Radiation (OLR)**: $F_{\\mathrm{out}}(T) = F_{0} + \\lambda\\,T$.\n- **Temperature-Dependent Albedo**: $A(T) = A_{0} + a_{1}\\,(T - T_{r}) + a_{3}\\,(T - T_{r})^{3}$.\n- **Stellar Constant**: $S = 1.361 \\times 10^{3}\\ \\mathrm{W\\,m^{-2}}$.\n- **Reference Temperature**: $T_{r} = 273\\ \\mathrm{K}$.\n- **Albedo Parameters**: \n    - $A_{0} = 0.30$\n    - $a_{1} = -1.0 \\times 10^{-2}\\ \\mathrm{K^{-1}}$\n    - $a_{3} = 1.0 \\times 10^{-5}\\ \\mathrm{K^{-3}}$\n- **OLR Parameters**:\n    - $\\lambda = 0.50\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$\n    - $F_{0} = 101.675\\ \\mathrm{W\\,m^{-2}}$\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem describes a zero-dimensional energy balance model (EBM), a fundamental tool in climate science. The parameterization of outgoing longwave radiation as a linear function of temperature and the cubic dependence of albedo on temperature are standard approximations used to model radiative feedbacks (like the Stefan-Boltzmann law) and ice-albedo feedbacks, respectively. The provided parameter values are stated to be, and appear to be, plausible for an Earth-like planet. The model is firmly rooted in the principle of conservation of energy.\n- **Well-Posed**: The problem is well-posed. It provides all necessary functional forms and parameter values to establish a single governing equation for the equilibrium temperature. The tasks requested—deriving the equilibrium equation, solving it, and performing a linear stability analysis—are standard mathematical procedures for analyzing such a dynamical system.\n- **Objective**: The problem is stated in precise, objective, and quantitative terms without subjective or ambiguous language.\n- **Completeness and Consistency**: The problem is self-contained. All variables are defined, and all required constants are provided. The units are consistent throughout (e.g., flux in $\\mathrm{W\\,m^{-2}}$, temperature in $\\mathrm{K}$, and parameters with corresponding units).\n\n**Step 3: Verdict and Action**\nThe problem is scientifically sound, well-posed, and complete. It is therefore deemed **valid**. A full solution will be provided.\n\n### Solution\n\n**Task 1: Net Flux and Equilibrium Condition**\n\nThe net radiative flux into the planet, $F_{\\mathrm{net}}(T)$, is the difference between the absorbed shortwave (incoming) flux, $F_{\\mathrm{in}}(T)$, and the outgoing longwave radiation, $F_{\\mathrm{out}}(T)$.\n$$F_{\\mathrm{net}}(T) = F_{\\mathrm{in}}(T) - F_{\\mathrm{out}}(T)$$\nSubstituting the given expressions for $F_{\\mathrm{in}}$ and $F_{\\mathrm{out}}$:\n$$F_{\\mathrm{net}}(T) = \\frac{S}{4}(1 - A(T)) - (F_{0} + \\lambda T)$$\nThe conservation of energy for the 0D model is given by $C \\frac{\\mathrm{d}T}{\\mathrm{d}t} = F_{\\mathrm{net}}(T)$, where $C$ is the heat capacity of the system. An equilibrium state is defined by a constant temperature, meaning $\\frac{\\mathrm{d}T}{\\mathrm{d}t} = 0$. This requires the net flux to be zero.\nThe equilibrium condition is therefore:\n$$F_{\\mathrm{net}}(T) = 0$$\nwhich translates to:\n$$\\frac{S}{4}(1 - A(T)) = F_{0} + \\lambda T$$\n\n**Task 2: Algebraic Solution for Equilibrium Temperatures**\n\nTo solve the equilibrium equation, we first substitute the expression for the albedo, $A(T)$, into the equation:\n$$\\frac{S}{4}\\left(1 - \\left[A_{0} + a_{1}(T - T_{r}) + a_{3}(T - T_{r})^{3}\\right]\\right) = F_{0} + \\lambda T$$\nWe introduce the temperature offset $\\theta = T - T_{r}$, which implies $T = \\theta + T_{r}$. Substituting this into the equation simplifies the albedo term:\n$$\\frac{S}{4}(1 - A_{0} - a_{1}\\theta - a_{3}\\theta^{3}) = F_{0} + \\lambda(\\theta + T_{r})$$\nThis is a cubic equation in $\\theta$. We rearrange the terms to the standard polynomial form, $c_{3}\\theta^{3} + c_{2}\\theta^{2} + c_{1}\\theta + c_{0} = 0$.\n$$(1 - A_{0})\\frac{S}{4} - \\frac{S}{4}a_{1}\\theta - \\frac{S}{4}a_{3}\\theta^{3} = F_{0} + \\lambda T_{r} + \\lambda\\theta$$\nCollecting terms with the same powers of $\\theta$:\n$$\\left(\\frac{S}{4}a_{3}\\right)\\theta^{3} + \\left(\\frac{S}{4}a_{1} + \\lambda\\right)\\theta + \\left(F_{0} + \\lambda T_{r} - (1 - A_{0})\\frac{S}{4}\\right) = 0$$\nThe coefficients are:\n- $c_{3} = \\frac{S}{4}a_{3}$\n- $c_{2} = 0$\n- $c_{1} = \\frac{S}{4}a_{1} + \\lambda$\n- $c_{0} = F_{0} + \\lambda T_{r} - (1 - A_{0})\\frac{S}{4}$\n\nNow, we substitute the given numerical values. First, we calculate $S/4$:\n$$ \\frac{S}{4} = \\frac{1.361 \\times 10^{3}}{4} = 340.25\\ \\mathrm{W\\,m^{-2}} $$\nCalculating the coefficients:\n$$c_{3} = (340.25)(1.0 \\times 10^{-5}) = 0.0034025$$\n$$c_{1} = (340.25)(-1.0 \\times 10^{-2}) + 0.50 = -3.4025 + 0.50 = -2.9025$$\n$$c_{0} = 101.675 + (0.50)(273) - (1 - 0.30)(340.25) = 101.675 + 136.5 - (0.7)(340.25)$$\n$$c_{0} = 238.175 - 238.175 = 0$$\nThe fortuitous result $c_{0}=0$ greatly simplifies the cubic equation to:\n$$c_{3}\\theta^{3} + c_{1}\\theta = 0$$\n$$0.0034025\\,\\theta^{3} - 2.9025\\,\\theta = 0$$\nWe can factor out $\\theta$:\n$$\\theta(0.0034025\\,\\theta^{2} - 2.9025) = 0$$\nThis equation has three real roots for $\\theta$:\n1. $\\theta_{1} = 0$\n2. $0.0034025\\,\\theta^{2} - 2.9025 = 0 \\implies \\theta^{2} = \\frac{2.9025}{0.0034025} \\approx 853.0485$\n   $\\theta = \\pm\\sqrt{853.0485} \\approx \\pm 29.207$\n   So, $\\theta_{2} \\approx 29.207$ and $\\theta_{3} \\approx -29.207$.\n\nWe convert these temperature offsets back to absolute temperatures $T = \\theta + T_{r} = \\theta + 273$:\n- $T_{1} = \\theta_{1} + 273 = 0 + 273 = 273\\ \\mathrm{K}$\n- $T_{2} = \\theta_{2} + 273 \\approx 29.207 + 273 = 302.207\\ \\mathrm{K}$\n- $T_{3} = \\theta_{3} + 273 \\approx -29.207 + 273 = 243.793\\ \\mathrm{K}$\n\n**Task 3: Linear Stability Analysis**\n\nThe linear stability of an equilibrium point $T_{eq}$ is determined by the sign of the derivative of the net flux, $\\frac{\\mathrm{d}F_{\\mathrm{net}}}{\\mathrm{d}T}$, evaluated at $T_{eq}$.\n- If $\\frac{\\mathrm{d}F_{\\mathrm{net}}}{\\mathrm{d}T}  0$, a positive temperature perturbation ($T  T_{eq}$) leads to a negative net flux ($F_{\\mathrm{net}}  0$), causing cooling back towards equilibrium. A negative perturbation leads to a positive net flux, causing warming. The equilibrium is therefore **linearly stable**.\n- If $\\frac{\\mathrm{d}F_{\\mathrm{net}}}{\\mathrm{d}T}  0$, any small perturbation is amplified, and the equilibrium is **linearly unstable**.\n\nWe first compute the derivative of $F_{\\mathrm{net}}(T)$:\n$$F_{\\mathrm{net}}(T) = \\frac{S}{4}(1 - A(T)) - F_{0} - \\lambda T$$\n$$\\frac{\\mathrm{d}F_{\\mathrm{net}}}{\\mathrm{d}T} = -\\frac{S}{4}\\frac{\\mathrm{d}A}{\\mathrm{d}T} - \\lambda$$\nThe derivative of the albedo is:\n$$\\frac{\\mathrm{d}A}{\\mathrm{d}T} = \\frac{\\mathrm{d}}{\\mathrm{d}T}\\left[A_{0} + a_{1}(T - T_{r}) + a_{3}(T - T_{r})^{3}\\right] = a_{1} + 3a_{3}(T-T_{r})^{2} = a_{1} + 3a_{3}\\theta^{2}$$\nSubstituting this into the expression for $\\frac{\\mathrm{d}F_{\\mathrm{net}}}{\\mathrm{d}T}$:\n$$\\frac{\\mathrm{d}F_{\\mathrm{net}}}{\\mathrm{d}T} = -\\frac{S}{4}(a_{1} + 3a_{3}\\theta^{2}) - \\lambda = -\\frac{S}{4}a_{1} - \\lambda - 3\\frac{S}{4}a_{3}\\theta^{2}$$\nUsing the definitions of our coefficients, $c_{1} = \\frac{S}{4}a_{1} + \\lambda$ and $c_{3} = \\frac{S}{4}a_{3}$, we can write this more compactly:\n$$\\frac{\\mathrm{d}F_{\\mathrm{net}}}{\\mathrm{d}T} = -( \\frac{S}{4}a_{1} + \\lambda ) - 3(\\frac{S}{4}a_{3})\\theta^{2} = -c_{1} - 3c_{3}\\theta^{2}$$\nNow we evaluate this derivative at each of the three equilibria:\n\n- **Equilibrium 1 ($T_{1} = 273\\ \\mathrm{K}$, $\\theta_{1}=0$):**\n$$\\left.\\frac{\\mathrm{d}F_{\\mathrm{net}}}{\\mathrm{d}T}\\right|_{T_{1}} = -c_{1} - 3c_{3}(0)^{2} = -c_{1} = -(-2.9025) = 2.9025$$\nSince $\\frac{\\mathrm{d}F_{\\mathrm{net}}}{\\mathrm{d}T}  0$, the equilibrium $T_{1}$ is **unstable**.\n\n- **Equilibria 2 and 3 ($T_{2} \\approx 302.2\\ \\mathrm{K}$ and $T_{3} \\approx 243.8\\ \\mathrm{K}$):**\nFor these two equilibria, $\\theta^{2} = -\\frac{c_{1}}{c_{3}}$. Substituting this into the derivative expression:\n$$\\left.\\frac{\\mathrm{d}F_{\\mathrm{net}}}{\\mathrm{d}T}\\right|_{T_{2}, T_{3}} = -c_{1} - 3c_{3}\\left(-\\frac{c_{1}}{c_{3}}\\right) = -c_{1} + 3c_{1} = 2c_{1}$$\n$$2c_{1} = 2(-2.9025) = -5.805$$\nSince $\\frac{\\mathrm{d}F_{\\mathrm{net}}}{\\mathrm{d}T}  0$, both equilibria $T_{2}$ and $T_{3}$ are **linearly stable**.\n\nThe three equilibrium temperatures, rounded to four significant figures, are:\n- The `warm` stable state: $T_{2} = 302.2\\ \\mathrm{K}$\n- The `cold` stable state (snowball): $T_{3} = 243.8\\ \\mathrm{K}$\n- The intermediate unstable state: $T_{1} = 273.0\\ \\mathrm{K}$\n\nArranging them in ascending order: $243.8\\ \\mathrm{K}$, $273.0\\ \\mathrm{K}$, $302.2\\ \\mathrm{K}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n243.8  273.0  302.2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The interaction between starlight and a planet is a spectrally dependent process; materials absorb and reflect light differently at different wavelengths. This computational practice moves from simplified grey models to a more physically realistic approach, asking you to numerically integrate the effects of atmospheric absorption bands and surface reflectivity across the stellar spectrum. By calculating the total energy absorbed by planets orbiting different star types, you will develop practical skills in radiative transfer modeling and gain intuition for how a star's spectral energy distribution co-evolves with a planet's atmosphere and surface to determine its climate .",
            "id": "4171309",
            "problem": "You are tasked with computing the absorbed shortwave fraction for a planet with a one-layer, purely absorbing atmosphere and a spectrally reflective surface, when illuminated by three types of main-sequence stars: G dwarf, K dwarf, and M dwarf. The absorbed shortwave fraction is defined as the ratio of the spectrally integrated absorbed shortwave flux (atmosphere plus surface) to the spectrally integrated incident stellar shortwave flux at the top of the atmosphere. The calculation must be based on first principles and standard physical laws.\n\nBegin from the following foundational base:\n\n- Blackbody radiation: the spectral radiance per unit wavelength is given by Planck’s law,\n$$\nB_{\\lambda}(T) = \\frac{2 h c^2}{\\lambda^5} \\left(\\exp\\!\\left(\\frac{h c}{\\lambda k_{\\mathrm{B}} T}\\right) - 1\\right)^{-1},\n$$\nwhere $h$ is Planck’s constant, $c$ is the speed of light, $k_{\\mathrm{B}}$ is Boltzmann’s constant, $T$ is the stellar effective temperature, and $\\lambda$ is the wavelength in meters.\n- Beer–Lambert law for absorption: along a direct path, the spectral transmittance $T(\\lambda)$ is $T(\\lambda) = \\exp\\!\\left(-\\tau(\\lambda)\\right)$, where $\\tau(\\lambda)$ is the spectral optical depth. Spectral atmospheric absorptivity is then $A(\\lambda) = 1 - T(\\lambda) = 1 - \\exp\\!\\left(-\\tau(\\lambda)\\right)$.\n- Energy conservation for the shortwave budget without atmospheric scattering: for each wavelength, a fraction $A(\\lambda)$ is absorbed in the atmosphere, and the transmitted fraction $1 - A(\\lambda)$ reaches the surface, where the spectral surface albedo $\\alpha(\\lambda)$ reflects a fraction $\\alpha(\\lambda)$ and absorbs $1 - \\alpha(\\lambda)$. The absorbed shortwave fraction per wavelength is the sum of atmospheric absorption and surface absorption of transmitted radiation.\n\nModel the atmosphere as a mixture of ozone ($\\mathrm{O_3}$), water vapor ($\\mathrm{H_2O}$), and carbon dioxide ($\\mathrm{CO_2}$), with spectral optical depth parameterized as a sum of Gaussian absorption bands in wavelength measured in micrometers, scaled by dimensionless composition parameters $c_{\\mathrm{O_3}}$, $c_{\\mathrm{H_2O}}$, and $c_{\\mathrm{CO_2}}$:\n$$\n\\tau(\\lambda_{\\mu m}) = c_{\\mathrm{O_3}} \\left(6\\,G(\\lambda_{\\mu m};\\,0.255,\\,0.04) + 1.0\\,G(\\lambda_{\\mu m};\\,0.60,\\,0.10)\\right) + c_{\\mathrm{H_2O}}\\left(1.2\\,G(\\lambda_{\\mu m};\\,0.94,\\,0.04) + 1.6\\,G(\\lambda_{\\mu m};\\,1.40,\\,0.06) + 1.8\\,G(\\lambda_{\\mu m};\\,1.90,\\,0.08)\\right) + c_{\\mathrm{CO_2}}\\left(1.0\\,G(\\lambda_{\\mu m};\\,1.60,\\,0.05) + 1.2\\,G(\\lambda_{\\mu m};\\,2.00,\\,0.07)\\right),\n$$\nwhere $G(\\lambda_{\\mu m};\\,\\lambda_0,\\,\\sigma) = \\exp\\!\\left(-\\frac{(\\lambda_{\\mu m} - \\lambda_0)^2}{2 \\sigma^2}\\right)$ is the normalized Gaussian band shape, $\\lambda_{\\mu m}$ is wavelength in micrometers, $\\lambda_0$ is the band center in micrometers, and $\\sigma$ is the band width in micrometers. The atmospheric absorptivity is $A(\\lambda_{\\mu m}) = 1 - \\exp\\!\\left(-\\tau(\\lambda_{\\mu m})\\right)$.\n\nModel the surface spectral albedo $\\alpha(\\lambda_{\\mu m})$ as follows (with $\\lambda_{\\mu m}$ in micrometers), clipped to physically plausible bounds:\n\n- Ocean-like surface:\n$$\n\\alpha_{\\mathrm{ocean}}(\\lambda_{\\mu m}) = \\operatorname{clip}\\left(0.06 + 0.02\\,(\\lambda_{\\mu m} - 0.5),\\,0.03,\\,0.12\\right).\n$$\n- Snow/ice surface:\n$$\n\\alpha_{\\mathrm{ice}}(\\lambda_{\\mu m}) = \\operatorname{clip}\\left(0.85 - 0.30\\,(\\lambda_{\\mu m} - 0.5),\\,0.40,\\,0.90\\right).\n$$\n- Desert/regolith surface:\n$$\n\\alpha_{\\mathrm{desert}}(\\lambda_{\\mu m}) = \\operatorname{clip}\\left(0.30 + 0.05\\,(\\lambda_{\\mu m} - 0.5),\\,0.25,\\,0.45\\right).\n$$\n\nAssume the stellar spectral flux at the top of atmosphere is proportional to blackbody spectral radiance $B_{\\lambda}(T)$ for the given stellar effective temperature $T$, and normalize by the spectral integral over the shortwave domain. Use the shortwave wavelength domain from $0.2\\,\\mu \\mathrm{m}$ to $2.5\\,\\mu \\mathrm{m}$ inclusive. The absorbed shortwave fraction $\\phi$ is defined as\n$$\n\\phi = \\frac{\\int_{\\lambda_{\\min}}^{\\lambda_{\\max}} F_{\\star}(\\lambda)\\,\\left(A(\\lambda) + \\left(1 - A(\\lambda)\\right)\\left(1 - \\alpha(\\lambda)\\right)\\right)\\,\\mathrm{d}\\lambda}{\\int_{\\lambda_{\\min}}^{\\lambda_{\\max}} F_{\\star}(\\lambda)\\,\\mathrm{d}\\lambda},\n$$\nwhere $F_{\\star}(\\lambda)$ is proportional to $B_{\\lambda}(T)$, with $\\lambda$ expressed in meters in the integrals; the surface and atmospheric functions depending on $\\lambda$ in micrometers must be evaluated consistently by conversion.\n\nYour task is to implement a program that computes $\\phi$ for the following test suite, where the output must be dimensionless decimals:\n\n- Test case $1$: G dwarf with $T = 5778\\,\\mathrm{K}$, Earth-like atmosphere $c_{\\mathrm{O_3}} = 1.0$, $c_{\\mathrm{H_2O}} = 1.0$, $c_{\\mathrm{CO_2}} = 1.0$, ocean-like surface.\n- Test case $2$: G dwarf with $T = 5778\\,\\mathrm{K}$, Earth-like atmosphere $c_{\\mathrm{O_3}} = 1.0$, $c_{\\mathrm{H_2O}} = 1.0$, $c_{\\mathrm{CO_2}} = 1.0$, snow/ice surface.\n- Test case $3$: K dwarf with $T = 4800\\,\\mathrm{K}$, dry carbon dioxide dominated atmosphere $c_{\\mathrm{O_3}} = 0.1$, $c_{\\mathrm{H_2O}} = 0.2$, $c_{\\mathrm{CO_2}} = 5.0$, desert/regolith surface.\n- Test case $4$: M dwarf with $T = 3000\\,\\mathrm{K}$, water-rich atmosphere $c_{\\mathrm{O_3}} = 0.2$, $c_{\\mathrm{H_2O}} = 3.0$, $c_{\\mathrm{CO_2}} = 1.0$, ocean-like surface.\n- Test case $5$ (boundary condition): G dwarf with $T = 5778\\,\\mathrm{K}$, no atmosphere $c_{\\mathrm{O_3}} = 0.0$, $c_{\\mathrm{H_2O}} = 0.0$, $c_{\\mathrm{CO_2}} = 0.0$, snow/ice surface.\n- Test case $6$ (edge case): M dwarf with $T = 3000\\,\\mathrm{K}$, highly opaque atmosphere $c_{\\mathrm{O_3}} = 10.0$, $c_{\\mathrm{H_2O}} = 10.0$, $c_{\\mathrm{CO_2}} = 10.0$, ocean-like surface.\n\nImplementation requirements:\n\n- Numerically integrate over the wavelength domain from $0.2\\,\\mu \\mathrm{m}$ to $2.5\\,\\mu \\mathrm{m}$ using a sufficiently fine grid such that results are numerically stable. Convert micrometers to meters where needed.\n- Use the given physical constants $h$, $c$, and $k_{\\mathrm{B}}$ with appropriate values in SI units.\n- Express the final outputs as dimensionless decimals. No physical units are required in the output.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\left[\\mathrm{result}_1,\\mathrm{result}_2,\\ldots\\right]$), in the same order as the test cases listed above.\n\nDesign considerations:\n\n- The solution must be strictly derived from the stated foundational base and must avoid introducing any unstated shortcut models or formulas.\n- Ensure scientific realism by keeping parameter choices and spectral features plausible, and by adhering to the specified domain and conversion between micrometers and meters.",
            "solution": "The problem is valid. It is a well-posed, scientifically grounded exercise in computational planetary science that requires the application of fundamental principles of radiative transfer. All necessary equations, parameters, and boundary conditions are provided, and the problem is free of contradictions or ambiguities.\n\nThe objective is to compute the spectrally integrated absorbed shortwave fraction, denoted by $\\phi$, for a planet with a single-layer, purely absorbing atmosphere and a spectrally dependent surface albedo, illuminated by various stellar types. The absorbed shortwave fraction is the ratio of the total shortwave energy absorbed by the planet-atmosphere system to the total incident shortwave energy at the top of the atmosphere.\n\nThe governing equation for the absorbed shortwave fraction $\\phi$ is given as:\n$$\n\\phi = \\frac{\\int_{\\lambda_{\\min}}^{\\lambda_{\\max}} F_{\\star}(\\lambda)\\,\\left(A(\\lambda) + \\left(1 - A(\\lambda)\\right)\\left(1 - \\alpha(\\lambda)\\right)\\right)\\,\\mathrm{d}\\lambda}{\\int_{\\lambda_{\\min}}^{\\lambda_{\\max}} F_{\\star}(\\lambda)\\,\\mathrm{d}\\lambda}\n$$\nHere, the integration is performed over the shortwave wavelength domain from $\\lambda_{\\min} = 0.2\\,\\mu\\mathrm{m}$ to $\\lambda_{\\max} = 2.5\\,\\mu\\mathrm{m}$. The term $A(\\lambda) + (1 - A(\\lambda))(1 - \\alpha(\\lambda))$ represents the fraction of incident flux at a specific wavelength $\\lambda$ that is absorbed by the system, which is the sum of a fraction $A(\\lambda)$ absorbed by the atmosphere and a fraction $(1 - A(\\lambda))(1 - \\alpha(\\lambda))$ transmitted through the atmosphere and absorbed by the surface.\n\nThe calculation proceeds by defining and implementing the models for each component of the integrand.\n\n1.  **Stellar Spectral Flux, $F_{\\star}(\\lambda)$**: The problem states that the incident stellar flux at the top of the atmosphere, $F_{\\star}(\\lambda)$, is proportional to the spectral radiance of a blackbody at the star's effective temperature $T$. The spectral radiance is given by Planck's law:\n    $$\n    B_{\\lambda}(T) = \\frac{2 h c^2}{\\lambda^5} \\left(\\exp\\!\\left(\\frac{h c}{\\lambda k_{\\mathrm{B}} T}\\right) - 1\\right)^{-1}\n    $$\n    where $h$ is Planck's constant, $c$ is the speed of light, and $k_{\\mathrm{B}}$ is Boltzmann's constant. Since $F_{\\star}(\\lambda) \\propto B_{\\lambda}(T)$, the proportionality constant cancels out in the ratio for $\\phi$, so we can set $F_{\\star}(\\lambda) = B_{\\lambda}(T)$ for the purpose of this calculation. The wavelength $\\lambda$ in this formula must be in SI units (meters).\n\n2.  **Atmospheric Absorptivity, $A(\\lambda)$**: The spectral absorptivity of the atmosphere is derived from the Beer-Lambert law. It depends on the spectral optical depth, $\\tau(\\lambda)$. The atmospheric transmittance is $T(\\lambda) = \\exp(-\\tau(\\lambda))$, and the absorptivity is $A(\\lambda) = 1 - T(\\lambda) = 1 - \\exp(-\\tau(\\lambda))$. The optical depth is modeled as a sum of Gaussian absorption bands for ozone ($\\mathrm{O_3}$), water vapor ($\\mathrm{H_2O}$), and carbon dioxide ($\\mathrm{CO_2}$), scaled by dimensionless composition parameters $c_{\\mathrm{O_3}}$, $c_{\\mathrm{H_2O}}$, and $c_{\\mathrm{CO_2}}$. The functional form for $\\tau$, with wavelength $\\lambda_{\\mu m}$ in micrometers, is:\n    $$\n    \\tau(\\lambda_{\\mu m}) = c_{\\mathrm{O_3}} \\left(6\\,G(\\lambda_{\\mu m};\\,0.255,\\,0.04) + 1.0\\,G(\\lambda_{\\mu m};\\,0.60,\\,0.10)\\right) + c_{\\mathrm{H_2O}}\\left(1.2\\,G(\\lambda_{\\mu m};\\,0.94,\\,0.04) + 1.6\\,G(\\lambda_{\\mu m};\\,1.40,\\,0.06) + 1.8\\,G(\\lambda_{\\mu m};\\,1.90,\\,0.08)\\right) + c_{\\mathrm{CO_2}}\\left(1.0\\,G(\\lambda_{\\mu m};\\,1.60,\\,0.05) + 1.2\\,G(\\lambda_{\\mu m};\\,2.00,\\,0.07)\\right)\n    $$\n    where the normalized Gaussian band shape is $G(\\lambda_{\\mu m};\\,\\lambda_0,\\,\\sigma) = \\exp\\!\\left(-\\frac{(\\lambda_{\\mu m} - \\lambda_0)^2}{2 \\sigma^2}\\right)$.\n\n3.  **Surface Spectral Albedo, $\\alpha(\\lambda)$**: The surface albedo is modeled for three distinct surface types. The models are linear functions of wavelength $\\lambda_{\\mu m}$ in micrometers, with the results clipped to physically realistic bounds.\n    -   Ocean-like: $\\alpha_{\\mathrm{ocean}}(\\lambda_{\\mu m}) = \\operatorname{clip}\\left(0.06 + 0.02\\,(\\lambda_{\\mu m} - 0.5),\\,0.03,\\,0.12\\right)$\n    -   Snow/ice: $\\alpha_{\\mathrm{ice}}(\\lambda_{\\mu m}) = \\operatorname{clip}\\left(0.85 - 0.30\\,(\\lambda_{\\mu m} - 0.5),\\,0.40,\\,0.90\\right)$\n    -   Desert/regolith: $\\alpha_{\\mathrm{desert}}(\\lambda_{\\mu m}) = \\operatorname{clip}\\left(0.30 + 0.05\\,(\\lambda_{\\mu m} - 0.5),\\,0.25,\\,0.45\\right)$\n\nThe overall calculation is performed numerically. The wavelength domain from $0.2\\,\\mu\\mathrm{m}$ to $2.5\\,\\mu\\mathrm{m}$ is discretized into a fine grid of points. At each wavelength point $\\lambda$, the corresponding value in micrometers, $\\lambda_{\\mu m} = \\lambda \\times 10^6$, is used to evaluate the absorptivity $A(\\lambda_{\\mu m})$ and albedo $\\alpha(\\lambda_{\\mu m})$. These values, along with the Planck function value $B_{\\lambda}(T)$, are used to compute the integrands for the numerator and denominator of the expression for $\\phi$. The integrals are then computed using the trapezoidal rule, which approximates the area under the curve by summing the areas of trapezoids formed by adjacent points on the grid.\n\nThis numerical procedure is executed for each of the six test cases, by substituting the specified stellar temperature $T$, atmospheric composition parameters ($c_{\\mathrm{O_3}}, c_{\\mathrm{H_2O}}, c_{\\mathrm{CO_2}}$), and surface type model. The final absorbed shortwave fraction $\\phi$ for each case is the ratio of the calculated numerator integral to the denominator integral.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.constants import h, c, k as k_B\n\ndef solve():\n    \"\"\"\n    Computes the absorbed shortwave fraction for a planet with a one-layer,\n    purely absorbing atmosphere and a spectrally reflective surface.\n    \"\"\"\n\n    # Define integration parameters\n    lambda_min_um = 0.2\n    lambda_max_um = 2.5\n    num_points = 5000  # A sufficiently fine grid for numerical stability\n    \n    # Wavelength grid in micrometers and meters\n    lambda_um = np.linspace(lambda_min_um, lambda_max_um, num_points)\n    lambda_m = lambda_um * 1e-6\n\n    # --- Model Functions ---\n\n    def planck_law(lam_m, T):\n        \"\"\"\n        Calculates Planck's law for blackbody radiation.\n        lam_m: Wavelength in meters.\n        T: Temperature in Kelvin.\n        \"\"\"\n        # Argument for the exponential function\n        arg = (h * c) / (lam_m * k_B * T)\n        # Handle potential overflow for very small wavelengths, although not expected in this range\n        # For large arg, exp(arg) - inf, but the lam^5 term dominates, B-0.\n        # np.exp handles large arguments gracefully up to a point.\n        denominator = lam_m**5 * (np.exp(arg) - 1.0)\n        # Avoid division by zero if denominator is zero\n        # This is unlikely with floating point numbers but good practice.\n        return np.divide((2.0 * h * c**2), denominator, out=np.zeros_like(denominator), where=denominator!=0)\n\n    def gaussian(lam_um, lam0, sigma):\n        \"\"\"\n        Calculates the normalized Gaussian band shape.\n        lam_um: Wavelength in micrometers.\n        lam0: Band center in micrometers.\n        sigma: Band width in micrometers.\n        \"\"\"\n        return np.exp(-((lam_um - lam0)**2) / (2.0 * sigma**2))\n\n    def optical_depth(lam_um, c_o3, c_h2o, c_co2):\n        \"\"\"\n        Calculates the spectral optical depth of the atmosphere.\n        lam_um: Wavelength in micrometers.\n        c_*: Dimensionless composition parameters.\n        \"\"\"\n        tau_o3 = c_o3 * (6.0 * gaussian(lam_um, 0.255, 0.04) + 1.0 * gaussian(lam_um, 0.60, 0.10))\n        tau_h2o = c_h2o * (1.2 * gaussian(lam_um, 0.94, 0.04) + 1.6 * gaussian(lam_um, 1.40, 0.06) + 1.8 * gaussian(lam_um, 1.90, 0.08))\n        tau_co2 = c_co2 * (1.0 * gaussian(lam_um, 1.60, 0.05) + 1.2 * gaussian(lam_um, 2.00, 0.07))\n        return tau_o3 + tau_h2o + tau_co2\n\n    def absorptivity(lam_um, c_o3, c_h2o, c_co2):\n        \"\"\"\n        Calculates the spectral absorptivity of the atmosphere.\n        \"\"\"\n        tau = optical_depth(lam_um, c_o3, c_h2o, c_co2)\n        return 1.0 - np.exp(-tau)\n\n    def albedo_ocean(lam_um):\n        \"\"\"Calculates the spectral albedo for an ocean-like surface.\"\"\"\n        return np.clip(0.06 + 0.02 * (lam_um - 0.5), 0.03, 0.12)\n\n    def albedo_snow(lam_um):\n        \"\"\"Calculates the spectral albedo for a snow/ice surface.\"\"\"\n        return np.clip(0.85 - 0.30 * (lam_um - 0.5), 0.40, 0.90)\n\n    def albedo_desert(lam_um):\n        \"\"\"Calculates the spectral albedo for a desert/regolith surface.\"\"\"\n        return np.clip(0.30 + 0.05 * (lam_um - 0.5), 0.25, 0.45)\n\n    albedo_funcs = {\n        'ocean-like': albedo_ocean,\n        'snow/ice': albedo_snow,\n        'desert/regolith': albedo_desert\n    }\n    \n    # --- Test Case Definitions ---\n    test_cases = [\n        {'T': 5778, 'c_o3': 1.0, 'c_h2o': 1.0, 'c_co2': 1.0, 'surface': 'ocean-like'},\n        {'T': 5778, 'c_o3': 1.0, 'c_h2o': 1.0, 'c_co2': 1.0, 'surface': 'snow/ice'},\n        {'T': 4800, 'c_o3': 0.1, 'c_h2o': 0.2, 'c_co2': 5.0, 'surface': 'desert/regolith'},\n        {'T': 3000, 'c_o3': 0.2, 'c_h2o': 3.0, 'c_co2': 1.0, 'surface': 'ocean-like'},\n        {'T': 5778, 'c_o3': 0.0, 'c_h2o': 0.0, 'c_co2': 0.0, 'surface': 'snow/ice'},\n        {'T': 3000, 'c_o3': 10.0, 'c_h2o': 10.0, 'c_co2': 10.0, 'surface': 'ocean-like'}\n    ]\n\n    results = []\n    for case in test_cases:\n        # 1. Stellar Flux Spectrum (proportional to Planck function)\n        stellar_flux = planck_law(lambda_m, case['T'])\n        \n        # 2. Atmospheric Absorptivity A(lambda)\n        A_lambda = absorptivity(lambda_um, case['c_o3'], case['c_h2o'], case['c_co2'])\n        \n        # 3. Surface Albedo alpha(lambda)\n        alpha_lambda_func = albedo_funcs[case['surface']]\n        alpha_lambda = alpha_lambda_func(lambda_um)\n        \n        # 4. Total absorbed fraction per wavelength\n        total_abs_lambda = A_lambda + (1.0 - A_lambda) * (1.0 - alpha_lambda)\n        \n        # 5. Define integrands for numerator and denominator of phi\n        numerator_integrand = stellar_flux * total_abs_lambda\n        denominator_integrand = stellar_flux\n        \n        # 6. Numerically integrate using the trapezoidal rule\n        numerator = np.trapz(numerator_integrand, x=lambda_m)\n        denominator = np.trapz(denominator_integrand, x=lambda_m)\n        \n        # 7. Compute the absorbed shortwave fraction phi\n        phi = numerator / denominator if denominator != 0.0 else 0.0\n        results.append(phi)\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}