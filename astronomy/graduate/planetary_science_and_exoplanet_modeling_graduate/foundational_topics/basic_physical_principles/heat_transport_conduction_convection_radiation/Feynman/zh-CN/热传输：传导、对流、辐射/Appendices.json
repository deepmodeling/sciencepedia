{
    "hands_on_practices": [
        {
            "introduction": "了解行星的长期热演化是行星科学的核心。这个练习通过一个理想化的模型来探讨这个基本问题，即一个均匀的球体如何随时间传导冷却。通过求解热传导方程 ，您将练习关键的数学物理方法，并推导出决定行星冷却速率的“特征时间尺度”，这是理解任何岩石行星或卫星热史的基石。",
            "id": "4163049",
            "problem": "考虑一个球对称、均匀的系外行星内部，其被理想化为一个半径为 $R$、质量密度恒为 $\\rho$、定压比热恒为 $c_{p}$、热导率恒为 $k$ 的实心球。在时间 $t=0$ 时，内部温度在空间上是均匀的，为 $T_{0}$。对于 $t0$，由于与主星和周围环境的快速辐射平衡，位于 $r=R$ 的表面温度突然被固定在一个恒定值 $T_{s}$。忽略内部热源、相变和任何流体运动，因此热量仅通过传导传输。假设材料属性是各向同性的，并且不随温度变化。在中心 $r=0$ 处施加正则性条件。\n\n从能量守恒和傅里叶热传导定律出发，推导温度场 $T(r,t)$ 的控制偏微分方程（PDE），并使用分离变量法和本征函数展开法，在边界条件 $T(R,t)=T_{s}$（对于所有 $t0$）和初始条件 $T(r,0)=T_{0}$ 下，求解瞬态冷却问题。定义热扩散率 $\\alpha$ 为 $\\alpha = k/(\\rho c_{p})$。\n\n从您的解中，确定衰减最慢的径向本征模，并求出其振幅衰减率。利用此结果，将最低阶模的 e-折叠时间尺度 $\\tau_{1}$ 定义为该模的振幅减小 $\\exp(-1)$ 倍所需的时间。请以 $R$ 和 $\\alpha$ 的闭式解析表达式给出 $\\tau_{1}$。请以秒为单位表示 $\\tau_{1}$ 的最终答案。无需进行数值计算。",
            "solution": "该问题要求推导和求解实心球的瞬态热传导方程，并从该解中确定衰减最慢的热模的冷却时间尺度。\n\n验证步骤如下：\n\n**第1步：提取已知条件**\n- 几何：半径为 $R$ 的实心球。\n- 材料属性：恒定质量密度 $\\rho$，恒定定压比热 $c_{p}$，恒定热导率 $k$。热扩散率定义为 $\\alpha = k/(\\rho c_{p})$。属性是各向同性的且不依赖于温度。\n- 初始条件：在时间 $t=0$ 时，温度是均匀的，$T(r,0) = T_0$。\n- 边界条件：对于时间 $t0$，表面温度固定为 $T(R,t) = T_s$。在中心 $r=0$ 处施加正则性条件。\n- 物理模型：热量仅通过传导传输。没有内部热源、相变或流体运动。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题是傅里叶热传导定律在简单几何中的经典应用。控制方程是热方程，是热物理学的基本原理。该模型是一个标准的、科学上合理的理想化模型，被用于包括行星科学在内的许多领域。\n- **良态问题：** 这是一个良态的初边值问题。它指定了一个偏微分方程(PDE)、一个定义域（$0 \\le r \\le R$, $t \\ge 0$）、整个定义域的初始条件以及在所有后续时间里空间边界（$r=0$ 和 $r=R$）上的边界条件。\n- **客观性：** 问题以精确的数学和物理术语陈述，没有任何主观或模棱两可的语言。\n- **完整性和一致性：** 问题提供了推导和求解PDE所需的所有必要参数（$R, \\rho, c_p, k, T_0, T_s$）和条件。没有矛盾之处。\n- **现实性：** 这些假设（均匀性、恒定属性）是简化处理，但它们并未使问题在物理上变得不可能或不合理。它可以作为行星冷却的一个有效的一阶模型。\n\n**第3步：结论和行动**\n问题是有效的。我们继续进行求解。\n\n**控制偏微分方程的推导**\n基于能量守恒的热传输一般方程为 $\\rho c_{p} \\frac{\\partial T}{\\partial t} = -\\nabla \\cdot \\vec{q} + Q$，其中 $\\vec{q}$ 是热通量矢量，$Q$ 是单位体积热生成率。问题陈述 $Q=0$。傅里叶传导定律指出 $\\vec{q} = -k \\nabla T$。将此代入能量守恒方程得到热方程：\n$$ \\rho c_{p} \\frac{\\partial T}{\\partial t} = \\nabla \\cdot (k \\nabla T) $$\n鉴于 $k$ 是常数，这简化为 $\\frac{\\partial T}{\\partial t} = \\frac{k}{\\rho c_{p}} \\nabla^2 T$。使用热扩散率的定义 $\\alpha = k/(\\rho c_{p})$，我们得到：\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\nabla^2 T $$\n对于球对称系统，温度 $T$ 仅取决于径向坐标 $r$ 和时间 $t$，因此 $T=T(r,t)$。球坐标系中的拉普拉斯算子 $\\nabla^2$ 简化为：\n$$ \\nabla^2 T = \\frac{1}{r^2} \\frac{\\partial}{\\partial r} \\left( r^2 \\frac{\\partial T}{\\partial r} \\right) $$\n因此，$T(r,t)$ 的控制偏微分方程为：\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{1}{r^2} \\frac{\\partial}{\\partial r} \\left( r^2 \\frac{\\partial T}{\\partial r} \\right) $$\n\n**偏微分方程的求解**\n表面边界条件 $T(R,t) = T_s$ 是非齐次的。我们定义一个新的温度变量 $\\Theta(r,t) = T(r,t) - T_s$ 以使边界条件齐次化。稳态解是 $T_{ss}(r)=T_s$。变量 $\\Theta(r,t)$ 代表了与最终稳态的瞬态偏差。\n$\\Theta$ 的偏微分方程与 $T$ 的相同：\n$$ \\frac{\\partial \\Theta}{\\partial t} = \\alpha \\frac{1}{r^2} \\frac{\\partial}{\\partial r} \\left( r^2 \\frac{\\partial \\Theta}{\\partial r} \\right) $$\n$\\Theta(r,t)$ 的边界条件和初始条件是：\n- 在 $r=R$ 处的边界条件：$\\Theta(R,t) = T(R,t) - T_s = T_s - T_s = 0$。\n- 在 $r=0$ 处的正则性条件：$T(r,t)$ 是有限的，因此 $\\Theta(r,t)$ 在 $r=0$ 处也必须是有限的。\n- 在 $t=0$ 时的初始条件：$\\Theta(r,0) = T(r,0) - T_s = T_0 - T_s$。\n\n为了简化空间算子，我们引入另一个代换：$u(r,t) = r \\Theta(r,t)$。$u(r,t)$ 的偏微分方程变为一维热方程：\n$$ \\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial r^2} $$\n$u(r,t)$ 的边界条件和初始条件是：\n- 在 $r=0$ 处：由于 $\\Theta(0,t)$ 必须是有限的，所以 $u(0,t) = 0 \\cdot \\Theta(0,t) = 0$。\n- 在 $r=R$ 处：$u(R,t) = R \\cdot \\Theta(R,t) = R \\cdot 0 = 0$。\n- 在 $t=0$ 处：$u(r,0) = r \\Theta(r,0) = r(T_0 - T_s)$。\n\n我们使用分离变量法求解 $u(r,t)$，令 $u(r,t) = \\mathcal{R}(r)\\mathcal{T}(t)$。代入PDE得到：\n$$ \\frac{1}{\\alpha \\mathcal{T}} \\frac{d\\mathcal{T}}{dt} = \\frac{1}{\\mathcal{R}} \\frac{d^2\\mathcal{R}}{dr^2} = -\\lambda^2 $$\n其中 $-\\lambda^2$ 是分离常数。时间相关的方程是 $\\frac{d\\mathcal{T}}{dt} = -\\alpha \\lambda^2 \\mathcal{T}$，其解为 $\\mathcal{T}(t) = \\exp(-\\alpha \\lambda^2 t)$。\n空间相关的方程是 $\\frac{d^2\\mathcal{R}}{dr^2} + \\lambda^2 \\mathcal{R} = 0$，其通解为 $\\mathcal{R}(r) = A \\sin(\\lambda r) + B \\cos(\\lambda r)$。\n对 $\\mathcal{R}(r)$ 应用边界条件：\n- $\\mathcal{R}(0)=0 \\implies A\\sin(0) + B\\cos(0) = B = 0$。所以，$\\mathcal{R}(r) = A \\sin(\\lambda r)$。\n- $\\mathcal{R}(R)=0 \\implies A\\sin(\\lambda R) = 0$。对于非平凡解（$A \\ne 0$），我们必须有 $\\sin(\\lambda R) = 0$。这给出了本征值 $\\lambda_n = \\frac{n\\pi}{R}$，其中整数 $n=1, 2, 3, \\ldots$。\n\n$u(r,t)$ 的通解是所有可能模的叠加：\n$$ u(r,t) = \\sum_{n=1}^{\\infty} C_n \\sin\\left(\\frac{n\\pi r}{R}\\right) \\exp\\left(-\\alpha \\left(\\frac{n\\pi}{R}\\right)^2 t\\right) $$\n系数 $C_n$ 由初始条件 $u(r,0) = r(T_0 - T_s)$ 和正弦函数的正交性确定：\n$$ C_n = \\frac{2}{R} \\int_0^R u(r,0) \\sin\\left(\\frac{n\\pi r}{R}\\right) dr = \\frac{2(T_0 - T_s)}{R} \\int_0^R r \\sin\\left(\\frac{n\\pi r}{R}\\right) dr $$\n该积分可以使用分部积分法计算：\n$$ \\int_0^R r \\sin\\left(\\frac{n\\pi r}{R}\\right) dr = \\left[-\\frac{Rr}{n\\pi}\\cos\\left(\\frac{n\\pi r}{R}\\right) + \\left(\\frac{R}{n\\pi}\\right)^2 \\sin\\left(\\frac{n\\pi r}{R}\\right)\\right]_0^R = -\\frac{R^2}{n\\pi}\\cos(n\\pi) = -\\frac{R^2}{n\\pi}(-1)^n = \\frac{R^2}{n\\pi}(-1)^{n+1} $$\n将此代回 $C_n$ 的表达式中：\n$$ C_n = \\frac{2(T_0 - T_s)}{R} \\left(\\frac{R^2}{n\\pi}(-1)^{n+1}\\right) = \\frac{2R(T_0 - T_s)}{n\\pi}(-1)^{n+1} $$\n$u(r,t)$ 的完整解是：\n$$ u(r,t) = \\sum_{n=1}^{\\infty} \\frac{2R(T_0 - T_s)}{n\\pi}(-1)^{n+1} \\sin\\left(\\frac{n\\pi r}{R}\\right) \\exp\\left(-\\alpha \\left(\\frac{n\\pi}{R}\\right)^2 t\\right) $$\n最后，我们转换回原始温度变量 $T(r,t) = T_s + \\Theta(r,t) = T_s + u(r,t)/r$：\n$$ T(r,t) = T_s + \\frac{2R(T_0 - T_s)}{r\\pi} \\sum_{n=1}^{\\infty} \\frac{(-1)^{n+1}}{n} \\sin\\left(\\frac{n\\pi r}{R}\\right) \\exp\\left(-\\alpha \\left(\\frac{n\\pi}{R}\\right)^2 t\\right) $$\n\n**e-折叠时间尺度的确定**\n该解是一系列本征模的无穷级数。每个模 $n$ 的时间演化由指数项 $\\exp\\left(-\\alpha \\left(\\frac{n\\pi}{R}\\right)^2 t\\right)$ 控制。因此，模 $n$ 的振幅衰减率为 $\\gamma_n = \\alpha \\left(\\frac{n\\pi}{R}\\right)^2$。\n衰减最慢的模是衰减率最小的模。这发生在 $n$ 取最小值时，即 $n=1$。这是基模或最低阶模。\n衰减最慢的模的振幅衰减率为：\n$$ \\gamma_1 = \\alpha \\left(\\frac{\\pi}{R}\\right)^2 = \\frac{\\alpha \\pi^2}{R^2} $$\ne-折叠时间尺度 $\\tau_1$ 定义为该模的振幅减小到 $\\exp(-1)$ 倍时所需的时间。这是衰减率的倒数。\n$$ \\exp(-\\gamma_1 \\tau_1) = \\exp(-1) \\implies \\gamma_1 \\tau_1 = 1 $$\n因此，e-折叠时间尺度为：\n$$ \\tau_1 = \\frac{1}{\\gamma_1} = \\frac{R^2}{\\alpha \\pi^2} $$\n此表达式以给定参数 $R$ 和 $\\alpha$ 的形式给出了时间尺度。如果 $R$ 的单位是米，$\\alpha$ 的单位是 $\\text{m}^2/\\text{s}$，那么 $\\tau_1$ 的单位将是秒。",
            "answer": "$$ \\boxed{\\frac{R^2}{\\alpha \\pi^2}} $$"
        },
        {
            "introduction": "行星模型的好坏通常取决于其表面如何与外部环境（如大气层和恒星辐射）相互作用，而这种作用在数学上由边界条件来描述。这个练习将探讨一个关键问题：我们应该如何为不同类型的行星表面选择合适的边界条件？通过对比高热惯性的海洋和低热惯性的表岩屑 ，您将学会使用尺度分析来判断狄利克雷（Dirichlet）或诺伊曼（Neumann）边界条件是否适用，从而培养建立实际模型的物理直觉。",
            "id": "4163077",
            "problem": "考虑一颗系外行星，其表面有两种截然不同的类型：低纬度地区是高热导率、充分混合的海洋，高纬度地区是低热导率、多孔的风化层。在每种基质内部，近地表的热传输主要由热传导主导（在海洋情况下，通过湍流混合得到增强），并通过与大气的对流以及向太空的辐射与外部强迫相互作用。假设存在周期为 $\\tau$、振幅为 $F_1$ 的周期性恒星强迫，并设表面的净外部通量为 $F_{\\star}(t) = \\bar{F} + F_1 \\cos(2\\pi t/\\tau)$。表面也发射热辐射，可用斯忒藩-玻尔兹曼定律 $F_{\\mathrm{rad}} = \\varepsilon \\sigma T^4$ 近似，其中 $\\varepsilon$ 是发射率，$\\sigma$ 是斯忒藩-玻尔兹曼常数。\n\n在每种基质内部，温度演化遵循热方程\n$$\n\\rho c \\,\\frac{\\partial T}{\\partial t} = k\\,\\frac{\\partial^2 T}{\\partial z^2},\n$$\n其中 $T$ 是温度，$z$ 是深度（向下为正），$k$ 是热导率，$\\rho$ 是密度，$c$ 是比热容。相关的传导热通量由傅里叶定律给出，\n$$\nq_z = -\\,k\\,\\frac{\\partial T}{\\partial z}.\n$$\n\n海洋可被视为一个厚度为 $H_o$ 的均匀混合层，其有效湍流扩散率为 $\\alpha_{\\mathrm{eff},o}$，相对于分子传导，这极大地增强了垂直热传输。风化层被视为一个半无限半空间，其分子热扩散率为 $\\alpha_r = k_r/(\\rho_r c_r)$。\n\n对于海洋混合层，设 $H_o = 50\\,\\mathrm{m}$，$\\alpha_{\\mathrm{eff},o} = 0.05\\,\\mathrm{m^2/s}$。对于风化层，取 $k_r = 0.10\\,\\mathrm{W/(m\\,K)}$，$\\rho_r = 1500\\,\\mathrm{kg/m^3}$，$c_r = 800\\,\\mathrm{J/(kg\\,K)}$，因此 $\\alpha_r = k_r/(\\rho_r c_r)$。考虑周期为 $\\tau = 86400\\,\\mathrm{s}$ 的日循环强迫。\n\n从热方程和傅里叶定律出发，使用标度分析估算与周期性热信号穿透每种基质相关的扩散长度 $d \\sim \\sqrt{\\alpha \\tau}$。利用表面的 $q_z(0,t) = F_{\\star}(t) - \\varepsilon \\sigma T(0,t)^4$ 来解释外部通量的作用，并确定对于每种情况，在日循环时间尺度上，哪种在 $z=0$ 处的边界条件能更好地代表地下热传导问题的上边界：\n\n- 狄利克雷边界条件（固定温度）：$T(0,t) = T_b$（时间上近似恒定）。\n- 诺伊曼边界条件（固定通量）：$-\\,k\\,\\partial T/\\partial z\\big|_{z=0} = q_b(t)$（外部施加的通量）。\n\n选择与给定参数和时间尺度所隐含的物理机制最匹配的选项。\n\nA. 海洋：狄利克雷；风化层：诺伊曼。\n\nB. 海洋：诺伊曼；风化层：狄利克雷。\n\nC. 海洋：狄利克雷；风化层：狄利克雷。\n\nD. 海洋：诺伊曼；风化层：诺伊曼。\n\nE. 两对组合都不充分；两个表面都严格需要一个罗宾（混合）边界条件，在日循环时间尺度上不能近似为狄利克雷或诺伊曼条件。",
            "solution": "该问题要求确定两种不同的行星表面类型——海洋和风化层——在日循环热强迫作用下，其表面（$z=0$）最合适的理想化边界条件（狄利克雷或诺伊曼）。这一选择取决于每种基质的热响应，而热响应可以基于所提供的物理参数，通过标度分析来进行分析。\n\n基本的物理原理是，表面温度对周期性能量通量的响应由近地表物质的热惯量决定。\n- **狄利克雷边界条件**（$T(0,t) = T_b$，固定温度）是一个很好的近似，适用于表面与一个具有非常大有效热容的蓄热库耦合的情况。巨大的热质量吸收了周期性的能量输入，而其温度变化可以忽略不计。\n- **诺伊曼边界条件**（$-\\,k\\,\\partial T/\\partial z\\big|_{z=0} = q_b(t)$，固定通量）是一个很好的近似，适用于表面热惯量非常小的情况。在这种情况下，表面不能有效地储存或传导走入射的热通量。因此，表面温度必须大幅波动以将能量重新辐射出去，并且温度的演化是由施加的通量驱动的。\n\n周期性热信号穿透基质的深度由热扩散长度 $d$ 表征，其由标度关系式 $d \\sim \\sqrt{\\alpha \\tau}$ 给出，其中 $\\alpha$ 是热扩散率，$\\tau$ 是强迫周期。\n\n让我们使用给定的参数分别分析每种情况。\n\n**1. 风化层分析**\n\n风化层被视为一个具有以下属性的半无限半空间：\n- 热导率：$k_r = 0.10\\,\\mathrm{W/(m\\,K)}$\n- 密度：$\\rho_r = 1500\\,\\mathrm{kg/m^3}$\n- 比热容：$c_r = 800\\,\\mathrm{J/(kg\\,K)}$\n- 强迫周期（日循环）：$\\tau = 86400\\,\\mathrm{s}$\n\n首先，我们计算风化层的热扩散率 $\\alpha_r$：\n$$\n\\alpha_r = \\frac{k_r}{\\rho_r c_r} = \\frac{0.10\\,\\mathrm{W/(m\\,K)}}{(1500\\,\\mathrm{kg/m^3}) \\times (800\\,\\mathrm{J/(kg\\,K)})} = \\frac{0.10}{1.2 \\times 10^6} \\,\\mathrm{m^2/s} \\approx 8.33 \\times 10^{-8}\\,\\mathrm{m^2/s}\n$$\n接下来，我们计算日循环周期的热扩散长度 $d_r$：\n$$\nd_r = \\sqrt{\\alpha_r \\tau} = \\sqrt{(8.33 \\times 10^{-8}\\,\\mathrm{m^2/s}) \\times (86400\\,\\mathrm{s})} \\approx \\sqrt{0.0072\\,\\mathrm{m^2}} \\approx 0.085\\,\\mathrm{m}\n$$\n日循环热波仅穿透风化层约 $8.5\\,\\mathrm{cm}$。这是一个非常浅的层。这意味着在日循环时间尺度上，只有很少质量的物质参与热过程。其有效热容低，因此热惯量也低。低热惯量的表面不能有效地将热量传输到其内部。为了维持表面能量平衡（其中 $q_z(0,t) = F_{\\star}(t) - \\varepsilon \\sigma T(0,t)^4$），表面温度 $T(0,t)$ 必须显著变化，以调整出射的辐射通量来匹配入射太阳通量的变化。因此，地下热传导问题是由其边界上一个外部施加的通量所驱动的。这种物理情况最适合用**诺伊曼边界条件**来表示。\n\n**2. 海洋分析**\n\n海洋被建模为一个具有以下属性的充分混合层：\n- 混合层厚度：$H_o = 50\\,\\mathrm{m}$\n- 有效湍流扩散率：$\\alpha_{\\mathrm{eff},o} = 0.05\\,\\mathrm{m^2/s}$\n- 强迫周期（日循环）：$\\tau = 86400\\,\\mathrm{s}$\n\n我们计算海洋的热扩散长度 $d_o$：\n$$\nd_o = \\sqrt{\\alpha_{\\mathrm{eff},o} \\tau} = \\sqrt{(0.05\\,\\mathrm{m^2/s}) \\times (86400\\,\\mathrm{s})} = \\sqrt{4320\\,\\mathrm{m^2}} \\approx 65.7\\,\\mathrm{m}\n$$\n现在，我们将扩散长度 $d_o$ 与混合层深度 $H_o$进行比较：\n$$\nd_o \\approx 65.7\\,\\mathrm{m}  H_o = 50\\,\\mathrm{m}\n$$\n由于扩散长度大于混合层深度，热信号在日循环周期内穿透了整个层。高有效扩散率确保了热量在整个 $50\\,\\mathrm{m}$ 的水柱中迅速混合。这意味着整个混合层作为一个单一的、巨大的热库。这个热库单位面积的总热容是巨大的。对于典型的水属性（$\\rho_o \\approx 1000\\,\\mathrm{kg/m^3}$，$c_o \\approx 4200\\,\\mathrm{J/(kg\\,K)}$），单位面积的热容为 $(\\rho_o c_o) H_o \\approx (4.2 \\times 10^6\\,\\mathrm{J/(m^3 K)}) \\times (50\\,\\mathrm{m}) = 2.1 \\times 10^8\\,\\mathrm{J/(m^2 K)}$。这个巨大的热质量强烈抵抗温度变化。作为对周期性恒星强迫的响应，海洋表面温度的波动将非常小。一个温度近似保持恒定的边界最适合用**狄利克雷边界条件**来表示。\n\n**结论**\n\n- 在日循环时间尺度上，**海洋**具有非常高的有效热惯量，导致其表面温度几乎恒定。这对应于**狄利克雷**边界条件。\n- 在日循环时间尺度上，**风化层**具有非常低的有效热惯量，导致其表面温度在外部能量通量的驱动下大幅波动。这对应于**诺伊曼**边界条件。\n\n因此，合适的边界条件对是 海洋：狄利克雷；风化层：诺伊曼。\n\n**选项评估**\n\n- **A. 海洋：狄利克雷；风化层：诺伊曼。** 这与我们的推导相符。海洋的高热质量（由于深层、快速的混合）使其温度稳定。风化层的低热惯量迫使其温度跟随施加的通量。**正确**。\n\n- **B. 海洋：诺伊曼；风化层：狄利克雷。** 这与我们的发现相反。它将意味着一个低惯量的海洋和一个高惯量的风化层，这与给定参数所决定的物理学原理相反。**错误**。\n\n- **C. 海洋：狄利克雷；风化层：狄利克雷。** 虽然狄利克雷条件适用于海洋，但它不适用于风化层。风化层表面温度预计在一天内会有显著变化。**错误**。\n\n- **D. 海洋：诺伊曼；风化层：诺伊曼。** 虽然诺伊曼条件适用于风化层，但它不适用于海洋。在这个时间尺度上，海洋的温度是稳定的，而不是由通量驱动的。**错误**。\n\n- **E. 两对组合都不充分；两个表面都严格需要一个罗宾（混合）边界条件，在日循环时间尺度上不能近似为狄利克雷或诺伊曼条件。** 完整的物理边界条件确实是罗宾条件的一个非线性变体。然而，问题要求的是在由参数定义的物理机制下的*最佳近似*。海洋（非常大的有效热容）和风化层（非常小的热惯量）的参数将系统推向极限情况，在这些情况下，狄利克雷和诺伊曼条件分别成为非常好的近似。因此，声称这些更简单的条件不足以代表主导的物理行为是错误的。**错误**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在行星科学的前沿研究中，我们常常需要将传导、对流和辐射等多种热传输机制结合在一个统一的模型中。本练习将引导您构建一个包含所有这些过程的综合性地表能量平衡模型，并特别关注升华（一种相变过程）所消耗的潜热。通过编写代码来求解这个复杂的非线性系统 ，您将亲身体验如何量化不同物理过程对行星表面温度的影响，这是连接理论知识与计算研究的关键一步。",
            "id": "4163092",
            "problem": "考虑一颗具有以氮气为主的大气的类地系外行星上的裸露冰面。假设在日照日最大值附近的固定地方时，表面达到一个准稳态温度，记为$T_s$，使得大气与表面交界面处的净能量输入等于净能量输出。其主导原理是应用于表面控制体的能量守恒。通量平衡表示为吸收的辐射等于发射的辐射、湍流感热通量、升华潜热通量以及向地下的传导热通量之和。目标是通过包含一个潜热通量项 $L_v E$ 来量化升华对平衡表面温度的影响，其中 $L_v$ 是挥发物的升华潜热，$E$ 是根据质量传输系数估算的质量通量。\n\n将推导基于以下经过充分检验的事实和定义：\n- Stefan–Boltzmann 定律：发射率$\\varepsilon$的表面的热辐射为$\\varepsilon \\sigma T_s^4$，其中$\\sigma$是 Stefan–Boltzmann 常数。\n- 近地表层湍流传输的整体空气动力学公式：感热通量为$H = \\rho c_p C_H U (T_s - T_a)$，升华质量通量为$E = \\rho C_E U (q_s(T_s) - q_a)$，其中$\\rho$是空气密度，$c_p$是空气的定压比热，$C_H$和$C_E$是传输系数，$U$是风速，$T_a$是气温，$q_s(T_s)$是表面温度下的饱和比湿，$q_a$是环境比湿。\n- 关于冰上水饱和水汽压的 Clausius–Clapeyron 关系：$e_s(T) = e_0 \\exp\\!\\left(\\dfrac{L_v}{R_v}\\left(\\dfrac{1}{T_0} - \\dfrac{1}{T}\\right)\\right)$，其中$e_0$和$T_0$是参考常数，$R_v$是水蒸气的气体常数，$L_v$是升华潜热。\n- 干空气和水蒸气二元混合物的比湿：$q = \\dfrac{\\varepsilon_m e}{p - (1 - \\varepsilon_m)e}$，其中$e$是水蒸气的分压，$p$是总气压，$\\varepsilon_m = M_v/M_d$是水蒸气与干空气的分子质量比（对于类氮气的干空气，取$\\varepsilon_m \\approx 0.622$）。\n- 根据理想气体定律计算的空气密度：$\\rho = \\dfrac{p}{R_d T_a}$，其中$R_d$是干空气的气体常数。\n\n假设表面吸收的净短波辐射为$(1 - \\alpha) S_\\downarrow$，其中$\\alpha$是反照率，$S_\\downarrow$是到达表面的向下短波通量。设$L_\\downarrow$为来自天空的向下长波通量。向地下的传导热通量建模为$G = \\dfrac{k_g}{d_g} (T_s - T_g)$，其中$k_g$是有效导热系数，$d_g$是有效传导路径长度，$T_g$是代表日传导深度的地下温度。稳态能量平衡为\n$$\n(1 - \\alpha) S_\\downarrow + L_\\downarrow - \\varepsilon \\sigma T_s^4 - \\rho c_p C_H U (T_s - T_a) - L_v E - \\frac{k_g}{d_g} (T_s - T_g) = 0,\n$$\n其中\n$$\nE = \\max\\!\\left(0,\\, \\rho C_E U \\left(q_s(T_s) - q_a\\right)\\right),\n\\quad\nq_s(T_s) = \\frac{\\varepsilon_m e_s(T_s)}{p - (1 - \\varepsilon_m)e_s(T_s)},\n\\quad\nq_a = r_H \\, q_s(T_a),\n$$\n其中$r_H$是表示为小数的环境相对湿度。算子$\\max(\\cdot)$强制在空气相对于表面过饱和时将$E$取为零，从而只量化升华的冷却效应。\n\n您的程序必须为每个指定的测试案例，通过求解关于$T_s$的非线性稳态能量平衡来计算两个平衡表面温度：\n- $T_s^{(\\mathrm{LE}=0)}$：不包括潜热通量，即设置$E = 0$。\n- $T_s^{(\\mathrm{LE}0)}$：包括如上定义的潜热通量$L_v E$。\n\n然后，为每个测试案例，报告由升华引起的温度降低，即非负差值\n$$\n\\Delta T \\equiv T_s^{(\\mathrm{LE}=0)} - T_s^{(\\mathrm{LE}0)} \\quad \\text{in} \\quad \\mathrm{K}.\n$$\n使用物理上实际的求根方法来求解$T_s$的能量平衡方程。\n\n所有测试案例中使用的常数：\n- 水冰的升华潜热: $L_v = 2.834\\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}$。\n- 参考饱和常数: $e_0 = 611\\,\\mathrm{Pa}$ 和 $T_0 = 273.16\\,\\mathrm{K}$。\n- 气体常数: $R_v = 461\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$R_d = 287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$。\n- Stefan–Boltzmann 常数: $\\sigma = 5.670374419\\times 10^{-8}\\,\\mathrm{W\\,m^{-2}\\,K^{-4}}$。\n- 空气的定压比热: $c_p = 1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$。\n- 分子质量比: $\\varepsilon_m = 0.622$。\n\n测试套件参数集（每行为一个独立案例）：\n- 案例1（一般情况，中等风速和干燥空气）：\n  $\\alpha = 0.30$, $S_\\downarrow = 300\\,\\mathrm{W\\,m^{-2}}$, $L_\\downarrow = 150\\,\\mathrm{W\\,m^{-2}}$, $\\varepsilon = 0.95$, $U = 5\\,\\mathrm{m\\,s^{-1}}$, $C_H = 0.003$, $C_E = 0.003$, $p = 5.0\\times 10^{4}\\,\\mathrm{Pa}$, $T_a = 250\\,\\mathrm{K}$, $r_H = 0.20$, $k_g = 0.20\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $d_g = 0.20\\,\\mathrm{m}$, $T_g = 240\\,\\mathrm{K}$。\n- 案例2（边界情况，无风导致升华可忽略不计）：\n  与案例1相同，除了$U = 0\\,\\mathrm{m\\,s^{-1}}$。\n- 案例3（边缘情况，潮湿空气）：\n  与案例1相同，除了$r_H = 0.90$。\n- 案例4（低日照和高反照率）：\n  $\\alpha = 0.60$, $S_\\downarrow = 100\\,\\mathrm{W\\,m^{-2}}$, $L_\\downarrow = 120\\,\\mathrm{W\\,m^{-2}}$, $\\varepsilon = 0.95$, $U = 5\\,\\mathrm{m\\,s^{-1}}$, $C_H = 0.003$, $C_E = 0.003$, $p = 5.0\\times 10^{4}\\,\\mathrm{Pa}$, $T_a = 245\\,\\mathrm{K}$, $r_H = 0.30$, $k_g = 0.20\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $d_g = 0.20\\,\\mathrm{m}$, $T_g = 235\\,\\mathrm{K}$。\n\n计算要求：\n- 对于每个案例，在温度区间$[T_{\\min}, T_{\\max}]$（其中$T_{\\min} = 150\\,\\mathrm{K}$，$T_{\\max} = 350\\,\\mathrm{K}$）上，使用一个稳健的区间求根器求解有和没有潜热通量时的$T_s$稳态能量平衡。\n- 以浮点数形式报告每个案例的$\\Delta T$（单位为$\\mathrm{K}$）。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如$[x_1,x_2,x_3,x_4]$，其中每个$x_i$是案例$i$的$\\Delta T$值（单位为$\\mathrm{K}$）。不应打印任何额外文本。",
            "solution": "该问题要求通过求解表面能量平衡方程，计算系外行星上裸露冰面的平衡表面温度$T_s$。该方程代表能量守恒原理，即在稳态下，进出表面的所有能量通量之和为零。我们被要求在两种条件下计算$T_s$：一种不包括升华潜热通量，另一种包括升华潜热通量。这两种温度之差$\\Delta T$量化了升华的冷却效应。\n\n主导的稳态能量平衡方程如下：\n$$\nF(T_s) = (1 - \\alpha) S_\\downarrow + L_\\downarrow - \\varepsilon \\sigma T_s^4 - H(T_s) - L_v E(T_s) - G(T_s) = 0\n$$\n其中各项依次代表：吸收的短波辐射、入射长波辐射、发射的长波辐射、湍流感热通量、潜热通量以及向地下的传导热通量。\n\n让我们将每一项作为未知表面温度$T_s$的函数进行分析：\n1.  **辐射通量**：\n    -   **入射辐射**：吸收的短波通量$(1 - \\alpha) S_\\downarrow$和向下的长波通量$L_\\downarrow$与$T_s$无关。它们构成了表面的净能量输入。\n    -   **出射辐射**：发射的热辐射$\\varepsilon \\sigma T_s^4$由 Stefan-Boltzmann 定律决定，并且是$T_s$的一个强递增函数。\n\n2.  **湍流通量**：这些通量模拟了通过地表层湍流与大气的能量交换。\n    -   **感热通量 ($H$)**：这是由表面和空气之间的温差引起的热量传递。它由整体空气动力学公式给出：\n        $$\n        H(T_s) = \\rho c_p C_H U (T_s - T_a)\n        $$\n        该项是$T_s$的线性函数。空气密度$\\rho$使用理想气体定律，在给定的气温$T_a$和气压$p$下为干空气计算得出：\n        $$\n        \\rho = \\frac{p}{R_d T_a}\n        $$\n\n    -   **潜热通量 ($L_v E$)**：这代表了冰变为水蒸气（升华）的相变所消耗的能量。该通量是升华潜热$L_v$与水蒸气质量通量$E$的乘积。\n        $$\n        E(T_s) = \\max\\!\\left(0,\\, \\rho C_E U \\left(q_s(T_s) - q_a\\right)\\right)\n        $$\n        该公式通过表面的饱和比湿$q_s(T_s)$非线性地依赖于$T_s$。项$q_a$是上方空气中的环境比湿，在给定案例中被视为常数。$\\max(0, \\dots)$函数确保我们只考虑升华（离开表面的质量通量）而不考虑凝华。\n        比湿计算如下：\n        -   在给定温度$T$下的饱和比湿$q_s(T)$，由饱和水汽压$e_s(T)$导出：\n            $$\n            q_s(T) = \\frac{\\varepsilon_m e_s(T)}{p - (1 - \\varepsilon_m) e_s(T)}\n            $$\n        -   冰上的饱和水汽压$e_s(T)$由 Clausius–Clapeyron 关系给出：\n            $$\n            e_s(T) = e_0 \\exp\\!\\left(\\frac{L_v}{R_v}\\left(\\frac{1}{T_0} - \\frac{1}{T}\\right)\\right)\n            $$\n            这显示了对温度的强指数依赖性。\n        -   环境比湿$q_a$由环境气温$T_a$和相对湿度$r_H$确定：\n            $$\n            q_a = r_H \\, q_s(T_a)\n            $$\n            其中$q_s(T_a)$是使用$q_s(T)$和$e_s(T)$在$T=T_a$处求值的公式计算得出的。\n\n3.  **地热通量 ($G$)**：向地下的传导热通量建模为：\n    $$\n    G(T_s) = \\frac{k_g}{d_g} (T_s - T_g)\n    $$\n    该项是$T_s$的线性函数，表示向一个固定温度为$T_g$的层的热传导。\n\n总能量平衡函数$F(T_s)$是$T_s$的连续函数。对于$T_s  0$，所有出射通量项（$\\varepsilon \\sigma T_s^4$、$H(T_s)$、$L_vE(T_s)$和$G(T_s)$）都是$T_s$的单调非递减函数。因此，函数$F(T_s)$是单调递减的。此性质确保如果$F(T_s)=0$的解存在，则该解是唯一的。问题提供了一个搜索区间$[150\\,\\mathrm{K}, 350\\,\\mathrm{K}]$，在该区间内保证存在一个根，因为通量平衡在低温时为正，在高温时为负。\n\n求解过程需要在这个非线性方程中，针对两种情景求解$T_s$：\n1.  **无潜热 ($T_s^{(\\mathrm{LE}=0)}$)**：将潜热通量项$L_v E(T_s)$设为零。需要求解的方程是：\n    $$\n    F_{\\mathrm{LE}=0}(T_s) = (1 - \\alpha) S_\\downarrow + L_\\downarrow - \\varepsilon \\sigma T_s^4 - H(T_s) - G(T_s) = 0\n    $$\n2.  **有潜热 ($T_s^{(\\mathrm{LE}0)}$)**：求解完整的能量平衡方程：\n    $$\n    F_{\\mathrm{LE}0}(T_s) = (1 - \\alpha) S_\\downarrow + L_\\downarrow - \\varepsilon \\sigma T_s^4 - H(T_s) - L_v E(T_s) - G(T_s) = 0\n    $$\n\n由于这些是非线性超越方程，必须使用数值求根算法。鉴于函数的单调性和指定的搜索区间，一个稳健的区间法（如 Brent's method）是极好的选择。\n\n对于每个测试案例，我们执行以下步骤：\n1.  为案例分配所有物理参数和常数。\n2.  预先计算不依赖于$T_s$的量：空气密度$\\rho$和环境比湿$q_a$。\n3.  定义两个能量平衡函数，$F_{\\mathrm{LE}=0}(T_s)$和$F_{\\mathrm{LE}0}(T_s)$。\n4.  使用数值求根器（具体为`scipy.optimize.brentq`）在区间$[150\\,\\mathrm{K}, 350\\,\\mathrm{K}]$内求解$F_{\\mathrm{LE}=0}(T_s)=0$以得到$T_s^{(\\mathrm{LE}=0)}$。\n5.  类似地，在同一区间内求解$F_{\\mathrm{LE}0}(T_s)=0$以得到$T_s^{(\\mathrm{LE}0)}$。\n6.  计算温度降低量$\\Delta T = T_s^{(\\mathrm{LE}=0)} - T_s^{(\\mathrm{LE}0)}$。该值预计为非负数，因为包含升华会引入一个额外的能量汇，从而冷却表面。\n\n此过程将对所提供的所有四个测试案例重复进行。使用的常数是：$L_v = 2.834 \\times 10^6\\,\\mathrm{J\\,kg^{-1}}$，$e_0 = 611\\,\\mathrm{Pa}$，$T_0 = 273.16\\,\\mathrm{K}$，$R_v = 461\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$R_d = 287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$\\sigma = 5.670374419 \\times 10^{-8}\\,\\mathrm{W\\,m^{-2}\\,K^{-4}}$，$c_p = 1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，以及$\\varepsilon_m = 0.622$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the surface temperature reduction due to sublimation for a set of test cases.\n    \"\"\"\n\n    # --- Physical Constants ---\n    L_v = 2.834e6  # Latent heat of sublimation for water ice (J/kg)\n    e0 = 611.0     # Reference saturation pressure (Pa)\n    T0 = 273.16    # Reference saturation temperature (K)\n    R_v = 461.0    # Gas constant for water vapor (J/kg/K)\n    R_d = 287.0    # Gas constant for dry air (J/kg/K)\n    sigma = 5.670374419e-8 # Stefan-Boltzmann constant (W/m^2/K^4)\n    c_p = 1004.0   # Specific heat of air at constant pressure (J/kg/K)\n    eps_m = 0.622  # Ratio of molecular masses of water vapor to dry air\n\n    # --- Test Case Parameters ---\n    test_cases = [\n        # Case 1: general, moderate wind and dry air\n        {'name': 'Case 1', 'alpha': 0.30, 'S_down': 300.0, 'L_down': 150.0, 'epsilon': 0.95,\n         'U': 5.0, 'C_H': 0.003, 'C_E': 0.003, 'p': 5.0e4, 'T_a': 250.0, 'r_H': 0.20,\n         'k_g': 0.20, 'd_g': 0.20, 'T_g': 240.0},\n        # Case 2: boundary, no wind\n        {'name': 'Case 2', 'alpha': 0.30, 'S_down': 300.0, 'L_down': 150.0, 'epsilon': 0.95,\n         'U': 0.0, 'C_H': 0.003, 'C_E': 0.003, 'p': 5.0e4, 'T_a': 250.0, 'r_H': 0.20,\n         'k_g': 0.20, 'd_g': 0.20, 'T_g': 240.0},\n        # Case 3: edge, humid air\n        {'name': 'Case 3', 'alpha': 0.30, 'S_down': 300.0, 'L_down': 150.0, 'epsilon': 0.95,\n         'U': 5.0, 'C_H': 0.003, 'C_E': 0.003, 'p': 5.0e4, 'T_a': 250.0, 'r_H': 0.90,\n         'k_g': 0.20, 'd_g': 0.20, 'T_g': 240.0},\n        # Case 4: low insolation and high albedo\n        {'name': 'Case 4', 'alpha': 0.60, 'S_down': 100.0, 'L_down': 120.0, 'epsilon': 0.95,\n         'U': 5.0, 'C_H': 0.003, 'C_E': 0.003, 'p': 5.0e4, 'T_a': 245.0, 'r_H': 0.30,\n         'k_g': 0.20, 'd_g': 0.20, 'T_g': 235.0}\n    ]\n\n    results = []\n    \n    T_min, T_max = 150.0, 350.0 # Search interval for root finding\n\n    def get_es(T):\n        \"\"\"Calculates saturation vapor pressure over ice (Pa) via Clausius-Clapeyron.\"\"\"\n        return e0 * np.exp((L_v / R_v) * ((1.0 / T0) - (1.0 / T)))\n\n    def get_qs(T, p):\n        \"\"\"Calculates saturation specific humidity (kg/kg).\"\"\"\n        es_T = get_es(T)\n        return (eps_m * es_T) / (p - (1.0 - eps_m) * es_T)\n\n    def energy_balance(Ts, params, include_LE):\n        \"\"\"\n        Defines the surface energy balance function F(Ts) = 0.\n        F(Ts) = Net Radiation - Sensible Heat - Latent Heat - Ground Heat\n        \"\"\"\n        # Unpack parameters\n        alpha = params['alpha']\n        S_down = params['S_down']\n        L_down = params['L_down']\n        epsilon = params['epsilon']\n        U = params['U']\n        C_H = params['C_H']\n        C_E = params['C_E']\n        p = params['p']\n        T_a = params['T_a']\n        k_g = params['k_g']\n        d_g = params['d_g']\n        T_g = params['T_g']\n        rho = params['rho']\n        q_a = params['q_a']\n\n        # --- Calculate flux components ---\n        \n        # Radiative fluxes\n        net_rad_in = (1.0 - alpha) * S_down + L_down\n        rad_out = epsilon * sigma * Ts**4\n\n        # Sensible heat flux\n        H = rho * c_p * C_H * U * (Ts - T_a)\n\n        # Latent heat flux\n        LE = 0.0\n        if include_LE:\n            # Saturation specific humidity at the surface\n            qs_Ts = get_qs(Ts, p)\n            # Mass flux\n            E = rho * C_E * U * (qs_Ts - q_a)\n            E = max(0.0, E) # Only sublimation is considered\n            LE = L_v * E\n\n        # Ground heat flux\n        G = (k_g / d_g) * (Ts - T_g)\n        \n        return net_rad_in - rad_out - H - LE - G\n\n\n    for case in test_cases:\n        \n        # --- Pre-calculate constant parameters for the case ---\n        # Air density\n        case['rho'] = case['p'] / (R_d * case['T_a'])\n        # Ambient specific humidity\n        qs_Ta = get_qs(case['T_a'], case['p'])\n        case['q_a'] = case['r_H'] * qs_Ta\n\n        # --- Solve for Ts with LE=0 ---\n        # The lambda function captures the current 'case' and sets include_LE to False\n        f_no_le = lambda Ts: energy_balance(Ts, case, include_LE=False)\n        Ts_no_le = brentq(f_no_le, T_min, T_max)\n\n        # --- Solve for Ts with LE>0 ---\n        # The lambda function captures the current 'case' and sets include_LE to True\n        f_with_le = lambda Ts: energy_balance(Ts, case, include_LE=True)\n        Ts_with_le = brentq(f_with_le, T_min, T_max)\n\n        # --- Calculate and store the temperature difference ---\n        delta_T = Ts_no_le - Ts_with_le\n        results.append(delta_T)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.7f}' for r in results)}]\")\n\nsolve()\n\n```"
        }
    ]
}