{
    "hands_on_practices": [
        {
            "introduction": "我们对系外行星的表征始于理解其大气的基本构成。行星大气的化学成分，特别是其金属丰度（metallicity），是揭示其形成和演化历史的关键线索。本练习将通过第一性原理，引导您深入探究金属丰度如何影响热木星的垂直大气结构。通过推导和计算，您将量化金属丰度的变化如何改变大气的平均分子量和不透明度，并最终影响到决定光谱特征尺度的标高 (scale height) 和温度梯度 ()。这项实践旨在强化您对大气成分与物理结构之间耦合关系的理解。",
            "id": "4155302",
            "problem": "一颗潮汐锁定的热木星拥有一个稳定分层的平行平面大气。大气气体充分混合，并处于局部热力学平衡状态。假设垂直方向的力平衡由静流体平衡决定，气体遵循理想气体定律，红外波段的辐射能量输运可以用辐射扩散近似来描述。大气最初由分子氢、氦和一种代表性的重分子组成，其质量分数分别为 $X_{\\mathrm{H_2}} = 0.73$、$Y_{\\mathrm{He}} = 0.25$ 和 $Z_{0} = 0.02$。为了计算平均分子量，取 $\\mu_{\\mathrm{H_2}} = 2$、$\\mu_{\\mathrm{He}} = 4$，并用水分子近似重元素组分，其 $\\mu_{\\mathrm{Z}} = 18$。行星的重力 $g$、穿过大气的净向上辐射通量 $F$ 以及用于比较局部性质的参考压强 $p_{\\ast}$ 都是固定的，不会改变。\n\n假设大气金属丰度相对于其初始值增加了 $10$ 倍，即 $Z_{1} = 10 Z_{0}$，而氦的质量分数保持在 $Y_{\\mathrm{He}} = 0.25$ 不变。氢的质量分数会进行调整，以满足 $X_{\\mathrm{H_2}} + Y_{\\mathrm{He}} + Z = 1$。假设罗斯兰平均不透明度与金属丰度成线性关系，因此不透明度之比为 $\\kappa_{1}/\\kappa_{0} = Z_{1}/Z_{0}$。同时假设，在领头阶上，参考压强 $p_{\\ast}$ 处的局地温度不受此金属丰度增加的影响，因此在 $p_{\\ast}$ 处的比较可以将 $T$ 视为固定值。\n\n从所述的物理基础出发，推导压强标高和对数温度梯度如何依赖于平均分子量和不透明度。然后，针对所述的金属丰度变化，计算在同一参考压强 $p_{\\ast}$ 下评估的组合变化因子\n$$\nC \\equiv \\left(\\frac{H_{1}}{H_{0}}\\right)\\left(\\frac{\\left.\\frac{dT}{d\\ln p}\\right|_{1}}{\\left.\\frac{dT}{d\\ln p}\\right|_{0}}\\right)\n$$\n，其中 $H$ 是压强标高，$dT/d\\ln p$ 是辐射扩散中对数温度梯度的大小。将 $C$ 的最终值四舍五入到四位有效数字，并以无量纲数的形式表示。",
            "solution": "这个问题要求分析大气成分的变化如何影响热木星大气的结构。我们需要推导压强标高 $H$ 和对数温度梯度 $dT/d\\ln p$ 对平均分子量 $\\mu$ 和不透明度 $\\kappa$ 的依赖关系。然后，我们必须计算在指定的大气金属丰度增加情况下的组合变化因子 $C$。\n\n首先，我们推导压强标高 $H$ 的表达式。静流体平衡的假设为垂直力平衡提供了控制方程：\n$$\n\\frac{dp}{dz} = -\\rho g\n$$\n其中 $p$ 是压强，$z$ 是垂直坐标，$\\rho$ 是气体密度，$g$ 是重力加速度。题目还指出，气体遵循理想气体定律，该定律关联了压强、密度和温度：\n$$\np = \\frac{\\rho k_B T}{\\mu m_u}\n$$\n这里，$k_B$ 是玻尔兹曼常数，$T$ 是温度，$\\mu$ 是气体的平均分子量（以原子质量单位计），$m_u$ 是原子质量单位。我们可以重新排列理想气体定律，将密度表示为 $\\rho = \\frac{p \\mu m_u}{k_B T}$。将此代入静流体平衡方程，得到：\n$$\n\\frac{dp}{dz} = - \\frac{p \\mu m_u g}{k_B T}\n$$\n压强标高 $H$ 定义为压强变化一个因子 $e$ 的特征垂直距离，即 $p(z) \\propto \\exp(-z/H)$。对 $z$ 求导，得到 $\\frac{1}{p}\\frac{dp}{dz} = -\\frac{1}{H}$。通过将其与整理后的静流体方程 $\\frac{1}{p}\\frac{dp}{dz} = -\\frac{\\mu m_u g}{k_B T}$ 进行比较，我们确定标高为：\n$$\nH = \\frac{k_B T}{\\mu m_u g}\n$$\n此表达式表明，对于固定的温度 $T$ 和重力 $g$，压强标高与平均分子量成反比，$H \\propto \\frac{1}{\\mu}$。它与不透明度 $\\kappa$ 没有直接的依赖关系。\n\n接下来，我们推导对数温度梯度 $dT/d\\ln p$ 的表达式。题目指明辐射能量输运可以用辐射扩散近似来描述。净向上辐射通量 $F$ 与温度梯度相关，关系式为：\n$$\nF = -\\frac{16 \\sigma T^3}{3 \\kappa \\rho} \\frac{dT}{dz}\n$$\n其中 $\\sigma$ 是斯特藩-玻尔兹曼常数，$\\kappa$ 是罗斯兰平均不透明度。为了用 $\\ln p$ 表示梯度，我们使用链式法则：$\\frac{dT}{dz} = \\frac{dT}{d\\ln p} \\frac{d\\ln p}{dz}$。根据我们之前的推导，$\\frac{d\\ln p}{dz} = -\\frac{1}{H}$。因此，$\\frac{dT}{dz} = -\\frac{1}{H} \\frac{dT}{d\\ln p}$。将此代入通量方程：\n$$\nF = -\\frac{16 \\sigma T^3}{3 \\kappa \\rho} \\left(-\\frac{1}{H} \\frac{dT}{d\\ln p}\\right) = \\frac{16 \\sigma T^3}{3 \\kappa \\rho H} \\frac{dT}{d\\ln p}\n$$\n求解对数温度梯度，得到：\n$$\n\\frac{dT}{d\\ln p} = \\frac{3 \\kappa \\rho H F}{16 \\sigma T^3}\n$$\n为了明确物理依赖关系，我们将 $\\rho$ 和 $H$ 的表达式代入此方程：\n$$\n\\frac{dT}{d\\ln p} = \\frac{3 \\kappa F}{16 \\sigma T^3} \\left(\\frac{p \\mu m_u}{k_B T}\\right) \\left(\\frac{k_B T}{\\mu m_u g}\\right) = \\frac{3 \\kappa p F}{16 \\sigma T^3 g}\n$$\n在固定的参考压强 $p_{\\ast}$ 处，温度 $T$ 也被视为固定值，并且已知 $F$ 和 $g$ 是常数，此表达式表明对数温度梯度与不透明度成正比，$\\frac{dT}{d\\ln p} \\propto \\kappa$。它与平均分子量 $\\mu$ 没有直接的依赖关系。\n\n现在，我们可以进行数值计算。平均分子量 $\\mu$ 使用公式 $\\frac{1}{\\mu} = \\sum_i \\frac{X_i}{\\mu_i}$ 计算，其中 $X_i$ 是物种 $i$ 的质量分数，$\\mu_i$ 是其摩尔质量。\n\n对于初始状态（状态 0）：\n$X_{\\mathrm{H_2}, 0} = 0.73$，$Y_{\\mathrm{He}} = 0.25$，$Z_{0} = 0.02$。摩尔质量为 $\\mu_{\\mathrm{H_2}} = 2$，$\\mu_{\\mathrm{He}} = 4$，以及 $\\mu_{\\mathrm{Z}} = 18$。\n$$\n\\frac{1}{\\mu_0} = \\frac{0.73}{2} + \\frac{0.25}{4} + \\frac{0.02}{18} = 0.365 + 0.0625 + \\frac{1}{900} = \\frac{1543}{3600}\n$$\n\n对于最终状态（状态 1）：\n金属丰度为 $Z_{1} = 10 Z_{0} = 10 \\times 0.02 = 0.20$。\n氦的质量分数保持不变，$Y_{\\mathrm{He}} = 0.25$。\n氢的质量分数变为 $X_{\\mathrm{H_2}, 1} = 1 - Y_{\\mathrm{He}} - Z_{1} = 1 - 0.25 - 0.20 = 0.55$。\n$$\n\\frac{1}{\\mu_1} = \\frac{0.55}{2} + \\frac{0.25}{4} + \\frac{0.20}{18} = 0.275 + 0.0625 + \\frac{1}{90} = \\frac{251}{720}\n$$\n\n我们必须计算因子 $C \\equiv \\left(\\frac{H_{1}}{H_{0}}\\right)\\left(\\frac{\\left.\\frac{dT}{d\\ln p}\\right|_{1}}{\\left.\\frac{dT}{d\\ln p}\\right|_{0}}\\right)$。\n压强标高之比为：\n$$\n\\frac{H_1}{H_0} = \\frac{k_B T/(\\mu_1 m_u g)}{k_B T/(\\mu_0 m_u g)} = \\frac{\\mu_0}{\\mu_1} = \\frac{1/\\mu_1}{1/\\mu_0}\n$$\n对数温度梯度之比为：\n$$\n\\frac{\\left.\\frac{dT}{d\\ln p}\\right|_{1}}{\\left.\\frac{dT}{d\\ln p}\\right|_{0}} = \\frac{3 \\kappa_1 p_{\\ast} F / (16 \\sigma T^3 g)}{3 \\kappa_0 p_{\\ast} F / (16 \\sigma T^3 g)} = \\frac{\\kappa_1}{\\kappa_0}\n$$\n题目说明 $\\kappa_{1}/\\kappa_{0} = Z_{1}/Z_{0} = 10$。\n将这些比值代入 $C$ 的表达式：\n$$\nC = \\left(\\frac{1/\\mu_1}{1/\\mu_0}\\right) \\left(\\frac{\\kappa_1}{\\kappa_0}\\right) = \\left(\\frac{251/720}{1543/3600}\\right) \\times 10\n$$\n$$\nC = \\left(\\frac{251}{720} \\times \\frac{3600}{1543}\\right) \\times 10 = \\left(\\frac{251 \\times 5}{1543}\\right) \\times 10 = \\frac{1255}{1543} \\times 10\n$$\n$$\nC = \\frac{12550}{1543} \\approx 8.13350615...\n$$\n四舍五入到四位有效数字，最终值为 $8.134$。",
            "answer": "$$\\boxed{8.134}$$"
        },
        {
            "introduction": "在了解了大气的基本垂直结构后，下一步是探究我们如何通过观测来探测它。透射光谱和发射光谱是我们研究系外行星大气的两种主要遥感技术，但这两种技术所探测的大气区域和物理过程有所不同。本练习将挑战您从物理原理出发，分别为这两种观测几何定义“光球层”压力，并分析云层——一种普遍存在的大气现象——如何以不同的方式影响这两种观测结果 ()。通过解决这个问题，您将能更深刻地理解如何解读和对比不同观测模式下的光谱数据，这是系外行星大气表征的核心技能。",
            "id": "4155273",
            "problem": "一个潮汐锁定的热木星被建模为垂直等温的流体静力学平衡大气，其向日面温度 $T = 1600\\ \\mathrm{K}$，平均分子量 $\\mu = 2.3$（以原子质量单位计），行星半径 $R_{p} = 1.2$ 木星半径（取木星半径为 $7.1492 \\times 10^{7}\\ \\mathrm{m}$），表面重力 $g = 16.0\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$。氢原子的质量为 $m_{H} = 1.673 \\times 10^{-27}\\ \\mathrm{kg}$，玻尔兹曼常数为 $k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J}\\ \\mathrm{K}^{-1}$。假设存在一种充分混合的气体，其单位质量的气体不透明度与波长相关，适用于在两个波长 $\\lambda_{1} = 1\\ \\mu \\mathrm{m}$ 和 $\\lambda_{2} = 5\\ \\mu \\mathrm{m}$ 下的发射和透射几何构型。发射气体不透明度为 $\\kappa_{\\mathrm{gas,em}}(\\lambda_{1}) = 0.05\\ \\mathrm{m}^{2}\\ \\mathrm{kg}^{-1}$ 和 $\\kappa_{\\mathrm{gas,em}}(\\lambda_{2}) = 0.02\\ \\mathrm{m}^{2}\\ \\mathrm{kg}^{-1}$。透射气体不透明度（消光）为 $\\kappa_{\\mathrm{gas,tr}}(\\lambda_{1}) = 0.08\\ \\mathrm{m}^{2}\\ \\mathrm{kg}^{-1}$ 和 $\\kappa_{\\mathrm{gas,tr}}(\\lambda_{2}) = 0.03\\ \\mathrm{m}^{2}\\ \\mathrm{kg}^{-1}$。大气中还包含云层，其质量不透明度遵循幂律 $\\kappa_{\\mathrm{cl}}(\\lambda) = \\kappa_{0} \\left(\\frac{\\lambda}{\\lambda_{0}}\\right)^{-\\alpha}$，其中在 $\\lambda_{0} = 1\\ \\mu \\mathrm{m}$ 时 $\\kappa_{0} = 0.20\\ \\mathrm{m}^{2}\\ \\mathrm{kg}^{-1}$，且 $\\alpha = 2$。假设在每种几何构型中，总不透明度是对应的气体不透明度和云层不透明度之和，即发射时为 $\\kappa_{\\mathrm{em}}(\\lambda) = \\kappa_{\\mathrm{gas,em}}(\\lambda) + \\kappa_{\\mathrm{cl}}(\\lambda)$，透射时为 $\\kappa_{\\mathrm{tr}}(\\lambda) = \\kappa_{\\mathrm{gas,tr}}(\\lambda) + \\kappa_{\\mathrm{cl}}(\\lambda)$。\n\n仅使用基本原理，按以下步骤进行：\n\n1. 从流体静力学平衡方程 $dP/dz = -\\rho g$ 和光学深度的定义 $d\\tau = \\kappa \\rho\\, dz$ 出发，推导在平行平面等温大气中，当质量不透明度 $\\kappa_{\\mathrm{em}}(\\lambda)$ 为常数时，垂直光学深度达到 $2/3$ 处的发射光球层压力 $P_{\\mathrm{em}}(\\lambda)$ 的表达式。\n\n2. 对于透射几何构型，对等温流体静力学平衡大气中沿切线高度处直弦的斜向光学深度进行建模。利用行星临边的局部抛物线近似，推导斜向光学深度作为切线压力的函数，并说明如何根据斜向光学深度等于 $1$ 的标准来定义透射光球层压力 $P_{\\mathrm{tr}}(\\lambda)$。\n\n3. 使用给定参数，数值计算大气标高 $H = \\frac{k_{B} T}{\\mu m_{H} g}$ 和几何因子 $\\sqrt{\\frac{2\\pi R_{p}}{H}}$。\n\n4. 使用以上结果，利用总不透明度计算 $P_{\\mathrm{em}}(\\lambda_{1})$、$P_{\\mathrm{em}}(\\lambda_{2})$、$P_{\\mathrm{tr}}(\\lambda_{1})$ 和 $P_{\\mathrm{tr}}(\\lambda_{2})$。然后计算无量纲比值\n$$\n\\mathcal{R} \\equiv \\frac{P_{\\mathrm{em}}(\\lambda_{2})/P_{\\mathrm{em}}(\\lambda_{1})}{P_{\\mathrm{tr}}(\\lambda_{2})/P_{\\mathrm{tr}}(\\lambda_{1})}.\n$$\n\n将 $\\mathcal{R}$ 的最终结果表示为一个四舍五入到四位有效数字的无量纲数。最终答案中不要提供任何解释性文字。",
            "solution": "该问题要求推导在发射和透射几何构型中光球层压力的表达式，数值计算关键的大气参数，并计算一个特定的无量纲比值 $\\mathcal{R}$。验证过程确认了该问题在科学上是合理的、提法是明确的，并且包含了所有必要信息。我们按照提供的结构化步骤进行求解。\n\n**1. 发射光球层压力 $P_{\\mathrm{em}}(\\lambda)$ 的推导**\n\n我们从平行平面大气在恒定重力 $g$ 下的流体静力学平衡方程开始：\n$$ \\frac{dP}{dz} = -\\rho g $$\n其中 $P$ 是压力，$\\rho$ 是密度，$z$ 是垂直坐标。大气被假定为理想气体，因此其状态方程为：\n$$ P = \\frac{\\rho k_B T}{\\bar{m}} $$\n其中 $k_B$ 是玻尔兹曼常数，$T$ 是温度（假设为等温），$\\bar{m}$ 是平均分子质量，由 $\\bar{m} = \\mu m_{H}$ 给出。我们可以用压力表示密度：\n$$ \\rho = \\frac{P \\bar{m}}{k_B T} $$\n将该密度表达式代入流体静力学平衡方程，得到：\n$$ \\frac{dP}{dz} = -P \\frac{g \\bar{m}}{k_B T} $$\n我们定义大气标高 $H$ 为 $H = \\frac{k_B T}{g \\bar{m}}$。方程变为：\n$$ \\frac{dP}{P} = -\\frac{1}{H} dz $$\n垂直光学深度 $\\tau$ 是从大气层顶部向下定义的。其微分形式为 $d\\tau = -\\kappa \\rho dz$，其中 $\\kappa$ 是质量不透明度。我们寻求在某一压力 $P$ 处，从大气层顶部（$P=0$）积分得到的光学深度达到某个特定值。我们可以使用流体静力学平衡方程 $dz = -dP/(\\rho g)$ 来关联 $d\\tau$ 和 $dP$：\n$$ d\\tau = -\\kappa \\rho \\left( -\\frac{dP}{\\rho g} \\right) = \\frac{\\kappa}{g} dP $$\n从大气层顶部（$P'=0$，$\\tau'=0$）积分到一个压力为 $P$、光学深度为 $\\tau(P)$ 的层面：\n$$ \\int_0^{\\tau(P)} d\\tau' = \\int_0^P \\frac{\\kappa_{\\mathrm{em}}(\\lambda)}{g} dP' $$\n假设 $\\kappa_{\\mathrm{em}}(\\lambda)$ 和 $g$ 不随压力变化，积分为：\n$$ \\tau(P) = \\frac{\\kappa_{\\mathrm{em}}(\\lambda) P}{g} $$\n发射光球层被定义为从太空看去垂直光学深度为 $\\tau_{\\mathrm{em}} = 2/3$ 的层面。该层面上的压力为 $P_{\\mathrm{em}}(\\lambda)$：\n$$ \\frac{2}{3} = \\frac{\\kappa_{\\mathrm{em}}(\\lambda) P_{\\mathrm{em}}(\\lambda)}{g} $$\n解出 $P_{\\mathrm{em}}(\\lambda)$，得到所需的表达式：\n$$ P_{\\mathrm{em}}(\\lambda) = \\frac{2g}{3\\kappa_{\\mathrm{em}}(\\lambda)} $$\n\n**2. 透射光球层压力 $P_{\\mathrm{tr}}(\\lambda)$ 的推导**\n\n在透射几何构型中，我们考虑沿一条射线（弦）的斜向光学深度 $\\tau_{\\mathrm{tr,slant}}$，该射线与半径为 $r_0 = R_p + z_0$、压力为 $P_0$ 的层面相切。斜向光学深度由沿路径 $s$ 的积分给出：\n$$ \\tau_{\\mathrm{tr,slant}} = \\int_{\\text{path}} \\kappa_{\\mathrm{tr}}(\\lambda) \\rho(s) ds $$\n设 $x$ 为沿路径的坐标，切点处 $x=0$。根据勾股定理，点 $x$ 处的径向距离 $r$ 为 $r(x) = \\sqrt{r_0^2 + x^2}$。对于薄大气层，我们对切点高度 $z_0$ 之上的高度 $z_x$ 使用局部抛物线近似：\n$$ r(x) = r_0\\sqrt{1+\\frac{x^2}{r_0^2}} \\approx r_0\\left(1 + \\frac{x^2}{2r_0^2}\\right) = r_0 + \\frac{x^2}{2r_0} $$\n高度差为 $z(x)-z_0 = r(x)-r_0 \\approx \\frac{x^2}{2r_0}$。对于穿过高层大气的路径，近似 $r_0 \\approx R_p$，得到 $z(x)-z_0 \\approx \\frac{x^2}{2R_p}$。\n在等温大气中，密度剖面为 $\\rho(z) = \\rho_0 \\exp(-(z-z_0)/H)$，其中 $\\rho_0$ 是切点处的密度。沿路径的密度为：\n$$ \\rho(x) \\approx \\rho_0 \\exp\\left(-\\frac{x^2}{2R_p H}\\right) $$\n斜向光学深度积分变为（近似 $ds \\approx dx$）：\n$$ \\tau_{\\mathrm{tr,slant}}(P_0) = \\int_{-\\infty}^{\\infty} \\kappa_{\\mathrm{tr}}(\\lambda) \\rho_0 \\exp\\left(-\\frac{x^2}{2R_p H}\\right) dx $$\n这是一个标准的高斯积分，形式为 $\\int_{-\\infty}^{\\infty} e^{-ax^2}dx = \\sqrt{\\pi/a}$，其中 $a = 1/(2R_p H)$。\n$$ \\tau_{\\mathrm{tr,slant}}(P_0) = \\kappa_{\\mathrm{tr}}(\\lambda) \\rho_0 \\sqrt{2\\pi R_p H} $$\n我们使用 $\\rho_0 = P_0/(gH)$ 将切点密度 $\\rho_0$ 与切线压力 $P_0$ 联系起来：\n$$ \\tau_{\\mathrm{tr,slant}}(P_0) = \\kappa_{\\mathrm{tr}}(\\lambda) \\frac{P_0}{gH} \\sqrt{2\\pi R_p H} = \\frac{\\kappa_{\\mathrm{tr}}(\\lambda) P_0}{g} \\sqrt{\\frac{2\\pi R_p}{H}} $$\n透射光球层由斜向光学深度为1（$\\tau_{\\mathrm{tr,slant}} = 1$）的标准定义。该层面上的压力为 $P_{\\mathrm{tr}}(\\lambda)$：\n$$ 1 = \\frac{\\kappa_{\\mathrm{tr}}(\\lambda) P_{\\mathrm{tr}}(\\lambda)}{g} \\sqrt{\\frac{2\\pi R_p}{H}} $$\n解出 $P_{\\mathrm{tr}}(\\lambda)$，得到：\n$$ P_{\\mathrm{tr}}(\\lambda) = \\frac{g}{\\kappa_{\\mathrm{tr}}(\\lambda) \\sqrt{\\frac{2\\pi R_p}{H}}} $$\n\n**3. 大气参数的数值计算**\n给定参数：\n$T = 1600\\ \\mathrm{K}$，$\\mu = 2.3$，$R_{p} = 1.2 \\times (7.1492 \\times 10^{7}\\ \\mathrm{m}) = 8.57904 \\times 10^{7}\\ \\mathrm{m}$，$g = 16.0\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$，$m_{H} = 1.673 \\times 10^{-27}\\ \\mathrm{kg}$，以及 $k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J}\\ \\mathrm{K}^{-1}$。\n\n平均分子质量为 $\\bar{m} = \\mu m_{H} = 2.3 \\times 1.673 \\times 10^{-27}\\ \\mathrm{kg} = 3.8479 \\times 10^{-27}\\ \\mathrm{kg}$。\n大气标高 $H$ 为：\n$$ H = \\frac{k_{B} T}{\\bar{m} g} = \\frac{(1.380649 \\times 10^{-23}\\ \\mathrm{J}\\ \\mathrm{K}^{-1})(1600\\ \\mathrm{K})}{(3.8479 \\times 10^{-27}\\ \\mathrm{kg})(16.0\\ \\mathrm{m}\\ \\mathrm{s}^{-2})} \\approx 3.588 \\times 10^5\\ \\mathrm{m} $$\n几何因子 $\\sqrt{\\frac{2\\pi R_{p}}{H}}$ 为：\n$$ \\sqrt{\\frac{2\\pi R_{p}}{H}} = \\sqrt{\\frac{2\\pi (8.57904 \\times 10^{7}\\ \\mathrm{m})}{3.58826 \\times 10^5\\ \\mathrm{m}}} \\approx \\sqrt{1502.08} \\approx 38.76 $$\n\n**4. 比值 $\\mathcal{R}$ 的计算**\n首先，我们计算总不透明度。云层不透明度为 $\\kappa_{\\mathrm{cl}}(\\lambda) = \\kappa_{0} (\\lambda/\\lambda_{0})^{-\\alpha} = 0.20 (\\lambda / 1\\ \\mu\\mathrm{m})^{-2}\\ \\mathrm{m}^2\\mathrm{kg}^{-1}$。\n在 $\\lambda_1 = 1\\ \\mu\\mathrm{m}$ 处：$\\kappa_{\\mathrm{cl}}(\\lambda_1) = 0.20 \\times (1)^{-2} = 0.20\\ \\mathrm{m}^2\\mathrm{kg}^{-1}$。\n在 $\\lambda_2 = 5\\ \\mu\\mathrm{m}$ 处：$\\kappa_{\\mathrm{cl}}(\\lambda_2) = 0.20 \\times (5)^{-2} = 0.20/25 = 0.008\\ \\mathrm{m}^2\\mathrm{kg}^{-1}$。\n\n总发射不透明度：\n$\\kappa_{\\mathrm{em}}(\\lambda_1) = \\kappa_{\\mathrm{gas,em}}(\\lambda_1) + \\kappa_{\\mathrm{cl}}(\\lambda_1) = 0.05 + 0.20 = 0.25\\ \\mathrm{m}^2\\mathrm{kg}^{-1}$。\n$\\kappa_{\\mathrm{em}}(\\lambda_2) = \\kappa_{\\mathrm{gas,em}}(\\lambda_2) + \\kappa_{\\mathrm{cl}}(\\lambda_2) = 0.02 + 0.008 = 0.028\\ \\mathrm{m}^2\\mathrm{kg}^{-1}$。\n\n总透射不透明度：\n$\\kappa_{\\mathrm{tr}}(\\lambda_1) = \\kappa_{\\mathrm{gas,tr}}(\\lambda_1) + \\kappa_{\\mathrm{cl}}(\\lambda_1) = 0.08 + 0.20 = 0.28\\ \\mathrm{m}^2\\mathrm{kg}^{-1}$。\n$\\kappa_{\\mathrm{tr}}(\\lambda_2) = \\kappa_{\\mathrm{gas,tr}}(\\lambda_2) + \\kappa_{\\mathrm{cl}}(\\lambda_2) = 0.03 + 0.008 = 0.038\\ \\mathrm{m}^2\\mathrm{kg}^{-1}$。\n\n无量纲比值 $\\mathcal{R}$ 定义为：\n$$ \\mathcal{R} \\equiv \\frac{P_{\\mathrm{em}}(\\lambda_{2})/P_{\\mathrm{em}}(\\lambda_{1})}{P_{\\mathrm{tr}}(\\lambda_{2})/P_{\\mathrm{tr}}(\\lambda_{1})} $$\n让我们代入压力的表达式：\n发射压力之比为：\n$$ \\frac{P_{\\mathrm{em}}(\\lambda_{2})}{P_{\\mathrm{em}}(\\lambda_{1})} = \\frac{2g / (3\\kappa_{\\mathrm{em}}(\\lambda_2))}{2g / (3\\kappa_{\\mathrm{em}}(\\lambda_1))} = \\frac{\\kappa_{\\mathrm{em}}(\\lambda_1)}{\\kappa_{\\mathrm{em}}(\\lambda_2)} $$\n透射压力之比为：\n$$ \\frac{P_{\\mathrm{tr}}(\\lambda_{2})}{P_{\\mathrm{tr}}(\\lambda_{1})} = \\frac{g / (\\kappa_{\\mathrm{tr}}(\\lambda_2) \\sqrt{2\\pi R_p/H})}{g / (\\kappa_{\\mathrm{tr}}(\\lambda_1) \\sqrt{2\\pi R_p/H})} = \\frac{\\kappa_{\\mathrm{tr}}(\\lambda_1)}{\\kappa_{\\mathrm{tr}}(\\lambda_2)} $$\n因此，比值 $\\mathcal{R}$ 简化为不透明度比值的比值：\n$$ \\mathcal{R} = \\frac{\\kappa_{\\mathrm{em}}(\\lambda_1)/\\kappa_{\\mathrm{em}}(\\lambda_2)}{\\kappa_{\\mathrm{tr}}(\\lambda_1)/\\kappa_{\\mathrm{tr}}(\\lambda_2)} = \\frac{\\kappa_{\\mathrm{em}}(\\lambda_1)\\kappa_{\\mathrm{tr}}(\\lambda_2)}{\\kappa_{\\mathrm{em}}(\\lambda_2)\\kappa_{\\mathrm{tr}}(\\lambda_1)} $$\n代入不透明度的数值：\n$$ \\mathcal{R} = \\frac{(0.25\\ \\mathrm{m}^2\\mathrm{kg}^{-1})(0.038\\ \\mathrm{m}^2\\mathrm{kg}^{-1})}{(0.028\\ \\mathrm{m}^2\\mathrm{kg}^{-1})(0.28\\ \\mathrm{m}^2\\mathrm{kg}^{-1})} = \\frac{0.0095}{0.00784} \\approx 1.21173469... $$\n四舍五入到四位有效数字，我们得到 $\\mathcal{R} = 1.212$。",
            "answer": "$$\\boxed{1.212}$$"
        },
        {
            "introduction": "热木星并非静态天体，其全球气候受到强烈大气环流的塑造。这个动手建模练习将带领您构建一个简化的一维动力学模型，以理解驱动热木星全球温度分布的基本物理平衡：平流（风的热量输运）与辐射冷却之间的相互作用。通过推导控制方程并求解，您将能够直接连接风速和辐射时标等物理参数与一个关键的可观测特征——行星热点偏移，该偏移体现在其热相位曲线中 ()。这项实践将您的视角从静态的垂直结构扩展到动态的全球环流，揭示了大气动力学在塑造我们所观测到的行星特征中的核心作用。",
            "id": "4155266",
            "problem": "你需要为一个潮汐锁定的热木星建立一个一维赤道浅水概念模型，以预测其经度温度模式，并与相位曲线偏移和振幅等关键可观测数据进行比较。目标是利用守恒原理和辐射弛豫假设，推导、实现并评估一个物理上一致的模型，然后根据建模的温度场计算可观测的量。\n\n将使用的基本基础和假设：\n- 该行星被潮汐锁定，因此星下点固定在经度 $\\lambda = 0$ 处。\n- 考虑一个单一的、动态活跃的浅层来代表光球层，该层由浅水（SW）框架描述。使用质量和动量守恒概念来论证温度的稳态纬向平流平衡与辐射弛豫（牛顿冷却）之间的关系。\n- 假设存在一个沿赤道均匀的纬向风速 $u$（若 $u  0$ 则为东风，若 $u  0$ 则为西风）。\n- 向平衡温度模式 $T_{\\mathrm{eq}}(\\lambda)$ 的辐射弛豫由一个辐射时间尺度 $\\tau_{\\mathrm{rad}}$ 来表征。\n- 在赤道上使用正弦形的昼夜平衡强迫，$T_{\\mathrm{eq}}(\\lambda) = T_0 + A \\cos \\lambda$，其中 $T_0$ 是平均温度，$A$ 是赤道上的昼夜平衡振幅；这是与昼侧（$\\lambda \\approx 0$）固定恒星加热相一致的标准理想化处理。\n- 对于稳态下的赤道经向温度 $T(\\lambda)$，通过使用弧长坐标 $s = R \\lambda$（其中 $R$ 是行星半径）平衡纬向平流与辐射弛豫，推导出其控制常微分方程。你必须获得一个与 $\\lambda$ 的 $2\\pi$ 周期域一致的周期解。\n- 为了与观测结果进行比较，通过在 $T_0$ 附近对热辐射进行线性化，并使用一个与视角 $x \\in [-\\pi/2,\\pi/2]$ 的 $\\cos x$ 成正比的简单一维可见权重核，对可见半球上的经向亮度进行积分，从而近似热辐射相位曲线。具体来说，将轨道相位角 $\\psi$（以弧度为单位）处的观测通量定义为\n$$\nF(\\psi) \\propto \\int_{-\\pi/2}^{\\pi/2} T(\\psi + x)\\,\\cos x\\,dx,\n$$\n这对应于侧视几何结构和经度上的朗伯式条带权重。这里 $\\psi = 0$ 对应于次食（恒星-行星-观测者对齐，且昼侧面向观测者）。\n\n推导和实现要求：\n1. 从浅水框架中的质量和动量守恒出发，论证一个稳态一维赤道平衡，其中温度的纬向平流与牛顿冷却相抗衡，并推导出关于 $T(\\lambda)$ 的线性一阶常微分方程（以经度 $\\lambda$ 为变量）。\n2. 在给定 $T_{\\mathrm{eq}}(\\lambda) = T_0 + A \\cos \\lambda$ 和 $\\lambda \\in [-\\pi,\\pi]$ 上的周期性边界条件的情况下，求解此微分方程以得到 $T(\\lambda)$。\n3. 使用推导出的 $T(\\lambda)$，计算上述定义的 $F(\\psi)$，并将其表示为一个恒定基线和一个具有相位偏移的单一余弦一次谐波的形式。定义可观测的相位曲线偏移角 $\\varphi$（以弧度为单位），使得 $F(\\psi)$ 可以写成 $F(\\psi) = F_0 + \\mathcal{R}\\cos(\\psi - \\varphi)$，其中 $F_0$ 是平均通量，$\\mathcal{R}$ 是谐波振幅。\n4. 为了在不同情况间进行比较，报告以度为单位的相位曲线偏移和作为相对于平均通量的无量纲分数形式的振幅，即为每个测试用例输出 $\\varphi_{\\mathrm{deg}}$ 和 $\\mathcal{R}/F_0$。\n\n单位和输出要求：\n- 方程中出现的角度 $\\lambda$ 和 $\\psi$ 必须以弧度处理。最终报告的偏移必须以度为单位。\n- 温度 $T_0$ 和 $A$ 的单位是开尔文。分数振幅 $\\mathcal{R}/F_0$ 是无量纲的，必须以小数形式输出（而非百分比）。\n- 最终程序必须生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，顺序为 $[\\varphi_{\\mathrm{deg}}^{(1)},\\mathcal{R}/F_0^{(1)},\\varphi_{\\mathrm{deg}}^{(2)},\\mathcal{R}/F_0^{(2)},\\dots]$，对应下面定义的完整测试套件。\n\n测试套件：\n为以下参数集计算输出，这些参数集测试了典型情况、辐射主导、平流主导、边界情况以及符号反转情况：\n- 情况1（典型的热木星）：$R = 9.4\\times 10^7\\,\\mathrm{m}$，$u = 2.0\\times 10^3\\,\\mathrm{m/s}$，$\\tau_{\\mathrm{rad}} = 1.5\\times 10^5\\,\\mathrm{s}$，$T_0 = 1600\\,\\mathrm{K}$，$A = 600\\,\\mathrm{K}$。\n- 情况2（辐射主导，小偏移）：$R = 9.4\\times 10^7\\,\\mathrm{m}$，$u = 2.0\\times 10^2\\,\\mathrm{m/s}$，$\\tau_{\\mathrm{rad}} = 5.0\\times 10^4\\,\\mathrm{s}$，$T_0 = 1400\\,\\mathrm{K}$，$A = 400\\,\\mathrm{K}$。\n- 情况3（平流主导，大偏移）：$R = 9.4\\times 10^7\\,\\mathrm{m}$，$u = 5.0\\times 10^3\\,\\mathrm{m/s}$，$\\tau_{\\mathrm{rad}} = 2.0\\times 10^5\\,\\mathrm{s}$，$T_0 = 1800\\,\\mathrm{K}$，$A = 300\\,\\mathrm{K}$。\n- 情况4（边界情况，无平流）：$R = 9.4\\times 10^7\\,\\mathrm{m}$，$u = 0\\,\\mathrm{m/s}$，$\\tau_{\\mathrm{rad}} = 1.0\\times 10^4\\,\\mathrm{s}$，$T_0 = 1500\\,\\mathrm{K}$，$A = 500\\,\\mathrm{K}$。\n- 情况5（西向急流）：$R = 9.4\\times 10^7\\,\\mathrm{m}$，$u = -1.0\\times 10^3\\,\\mathrm{m/s}$，$\\tau_{\\mathrm{rad}} = 1.0\\times 10^5\\,\\mathrm{s}$，$T_0 = 1700\\,\\mathrm{K}$，$A = 500\\,\\mathrm{K}$。\n\n你的程序必须实现推导出的公式来计算每个情况下的 $\\varphi_{\\mathrm{deg}}$ 和 $\\mathcal{R}/F_0$，一致地处理 $u=0$ 的边界情况，并按上述确切顺序打印最终的单行方括号列表。最终代码必须完全自包含，除了嵌入在程序中的测试套件外，不需要任何输入。",
            "solution": "该问题被评估为有效。它在科学上基于行星大气动力学的既定原理，问题设定清晰，具有明确的数学结构，可导向唯一解，并且完全客观。设置是完整的、一致的，并使用了物理上合理的参数。我们继续进行推导和求解。\n\n### 第一部分：控制常微分方程（ODE）的推导\n\n我们的任务是在纬向平流和辐射弛豫的影响下，对一颗潮汐锁定的热木星的赤道温度 $T(\\lambda)$ 进行建模。基本原理是稳态下流体微元的热能守恒。\n\n对于一个以速度 $\\mathbf{v}$ 移动的流体微元，其温度变化率由物质导数给出：\n$$\n\\frac{DT}{dt} = \\frac{\\partial T}{\\partial t} + \\mathbf{v} \\cdot \\nabla T\n$$\n在这个模型中，我们假设为稳态，因此时间偏导数 $\\frac{\\partial T}{\\partial t} = 0$。流动是纯纬向的（沿赤道），速度均匀为 $u$，所以 $\\mathbf{v} = u \\mathbf{\\hat{\\lambda}}$，其中 $\\mathbf{\\hat{\\lambda}}$ 是经度方向的单位向量。在球坐标系中，沿赤道的梯度算子简化为 $\\nabla = \\frac{1}{R} \\frac{d}{d\\lambda} \\mathbf{\\hat{\\lambda}}$，其中 $R$ 是行星半径，$\\lambda$ 是以弧度为单位的经度。\n\n因此，代表流体微元移动到新位置而引起的温度变化的平流项为：\n$$\n\\mathbf{v} \\cdot \\nabla T = u \\left( \\frac{1}{R} \\frac{dT}{d\\lambda} \\right) = \\frac{u}{R} \\frac{dT}{d\\lambda}\n$$\n\n这种平流变化与辐射弛豫相平衡，辐射弛豫被建模为牛顿冷却。这个过程在特征辐射时间尺度 $\\tau_{\\mathrm{rad}}$ 内，将局部温度 $T(\\lambda)$ 推向辐射平衡温度 $T_{\\mathrm{eq}}(\\lambda)$。由辐射引起的温度变化率为：\n$$\n\\left(\\frac{dT}{dt}\\right)_{\\mathrm{rad}} = -\\frac{T(\\lambda) - T_{\\mathrm{eq}}(\\lambda)}{\\tau_{\\mathrm{rad}}}\n$$\n\n在稳态下，平流冷却/加热必须与辐射加热/冷却相平衡：\n$$\n\\frac{DT}{dt} = \\frac{u}{R} \\frac{dT}{d\\lambda} = -\\frac{T(\\lambda) - T_{\\mathrm{eq}}(\\lambda)}{\\tau_{\\mathrm{rad}}}\n$$\n\n整理该方程，得到关于 $T(\\lambda)$ 的控制性线性一阶常微分方程：\n$$\n\\frac{u \\tau_{\\mathrm{rad}}}{R} \\frac{dT}{d\\lambda} + T(\\lambda) = T_{\\mathrm{eq}}(\\lambda)\n$$\n我们定义一个无量纲参数 $\\alpha$，它代表了绕行星周长的平流输运时间尺度与辐射时间尺度的比值。一个更直接的解释是辐射时间与跨越一个弧度的平流时间之比，即 $\\tau_{\\mathrm{rad}} / (R/u)$。\n$$\n\\alpha = \\frac{u \\tau_{\\mathrm{rad}}}{R}\n$$\n于是，该常微分方程可以更紧凑地写为：\n$$\n\\alpha \\frac{dT}{d\\lambda} + T(\\lambda) = T_{\\mathrm{eq}}(\\lambda)\n$$\n\n### 第二部分：常微分方程的求解\n\n辐射平衡强迫被给定为经度的正弦函数：\n$$\nT_{\\mathrm{eq}}(\\lambda) = T_0 + A \\cos \\lambda\n$$\n其中 $T_0$ 是平均平衡温度，$A$ 是昼夜温差的振幅。将此代入常微分方程：\n$$\n\\alpha \\frac{dT}{d\\lambda} + T(\\lambda) = T_0 + A \\cos \\lambda\n$$\n我们在定义域 $\\lambda \\in [-\\pi, \\pi]$ 上寻求一个周期解。鉴于方程的线性和正弦强迫，我们可以假设一个形式如下的解：\n$$\nT(\\lambda) = T_{\\text{mean}} + C \\cos \\lambda + D \\sin \\lambda\n$$\n其导数为 $\\frac{dT}{d\\lambda} = -C \\sin \\lambda + D \\cos \\lambda$。将解及其导数代入常微分方程：\n$$\n\\alpha(-C \\sin \\lambda + D \\cos \\lambda) + (T_{\\text{mean}} + C \\cos \\lambda + D \\sin \\lambda) = T_0 + A \\cos \\lambda\n$$\n我们根据各项对 $\\lambda$ 的函数依赖性来合并同类项：\n$$\nT_{\\text{mean}} + (C + \\alpha D)\\cos \\lambda + (D - \\alpha C)\\sin \\lambda = T_0 + A \\cos \\lambda\n$$\n为使此等式对所有 $\\lambda$ 成立，常数项、$\\cos \\lambda$ 项和 $\\sin \\lambda$ 项的系数必须在两边匹配：\n1. 常数项： $T_{\\text{mean}} = T_0$\n2. $\\sin \\lambda$ 项： $D - \\alpha C = 0 \\implies D = \\alpha C$\n3. $\\cos \\lambda$ 项： $C + \\alpha D = A$\n\n将 $D = \\alpha C$ 代入第三个方程：\n$$\nC + \\alpha(\\alpha C) = A \\implies C(1 + \\alpha^2) = A \\implies C = \\frac{A}{1+\\alpha^2}\n$$\n因此：\n$$\nD = \\frac{\\alpha A}{1+\\alpha^2}\n$$\n温度分布的完整解为：\n$$\nT(\\lambda) = T_0 + \\left(\\frac{A}{1+\\alpha^2}\\right) \\cos \\lambda + \\left(\\frac{\\alpha A}{1+\\alpha^2}\\right) \\sin \\lambda\n$$\n该解表示一个正弦温度模式，其峰值（“热点”）相对于星下点（$\\lambda=0$）在经度上发生了偏移。东向偏移对应于 $\\alpha  0$（东风）。\n\n### 第三部分：可观测量推导\n\n在轨道相位角 $\\psi$ 处的观测通量 $F(\\psi)$ 由可见半球上的温度积分给出，并由一个 $\\cos x$ 核加权：\n$$\nF(\\psi) \\propto \\int_{-\\pi/2}^{\\pi/2} T(\\psi + x)\\,\\cos x\\,dx\n$$\n我们代入 $T(\\lambda)$ 的解，其中 $\\lambda = \\psi+x$：\n$$\nT(\\psi+x) = T_0 + C \\cos(\\psi+x) + D \\sin(\\psi+x)\n$$\n积分变为：\n$$\nF(\\psi) \\propto \\int_{-\\pi/2}^{\\pi/2} [T_0 + C(\\cos\\psi\\cos x - \\sin\\psi\\sin x) + D(\\sin\\psi\\cos x + \\cos\\psi\\sin x)] \\cos x \\,dx\n$$\n我们逐项计算积分，使用标准定积分：\n- $\\int_{-\\pi/2}^{\\pi/2} \\cos x \\,dx = [\\sin x]_{-\\pi/2}^{\\pi/2} = 2$\n- $\\int_{-\\pi/2}^{\\pi/2} \\cos^2 x \\,dx = [\\frac{x}{2} + \\frac{\\sin(2x)}{4}]_{-\\pi/2}^{\\pi/2} = \\frac{\\pi}{2}$\n- $\\int_{-\\pi/2}^{\\pi/2} \\sin x \\cos x \\,dx = [\\frac{\\sin^2 x}{2}]_{-\\pi/2}^{\\pi/2} = 0$\n\n应用这些结果：\n$$\nF(\\psi) \\propto 2T_0 + \\frac{\\pi}{2}(C \\cos\\psi + D \\sin\\psi)\n$$\n我们希望将其表示为 $F(\\psi) = F_0 + \\mathcal{R}\\cos(\\psi - \\varphi)$ 的形式。\n设比例常数为 $k$。则 $F(\\psi) = k [2T_0 + \\frac{\\pi}{2}(C \\cos\\psi + D \\sin\\psi)]$。\n平均通量为 $F_0 = 2kT_0$。\n变化部分为 $\\mathcal{R}\\cos(\\psi-\\varphi) = k\\frac{\\pi}{2}(C \\cos\\psi + D \\sin\\psi)$。\n为了找到 $\\varphi$ 和振幅，我们将 $C\\cos\\psi + D\\sin\\psi$重写为 $\\sqrt{C^2+D^2}\\cos(\\psi - \\arctan(D/C))$。\n因此，相位曲线偏移 $\\varphi$ 为：\n$$\n\\varphi = \\arctan\\left(\\frac{D}{C}\\right) = \\arctan\\left(\\frac{\\alpha A/(1+\\alpha^2)}{A/(1+\\alpha^2)}\\right) = \\arctan(\\alpha)\n$$\n变化部分的振幅为 $\\mathcal{R} = k\\frac{\\pi}{2}\\sqrt{C^2+D^2}$。\n分数振幅 $\\mathcal{R}/F_0$ 与未知常数 $k$ 无关：\n$$\n\\frac{\\mathcal{R}}{F_0} = \\frac{k\\frac{\\pi}{2}\\sqrt{C^2+D^2}}{2kT_0} = \\frac{\\pi}{4T_0}\\sqrt{C^2+D^2}\n$$\n我们计算 $\\sqrt{C^2+D^2}$：\n$$\n\\sqrt{C^2+D^2} = \\sqrt{\\left(\\frac{A}{1+\\alpha^2}\\right)^2 + \\left(\\frac{\\alpha A}{1+\\alpha^2}\\right)^2} = \\sqrt{\\frac{A^2(1+\\alpha^2)}{(1+\\alpha^2)^2}} = \\frac{A}{\\sqrt{1+\\alpha^2}}\n$$\n将此代入分数振幅表达式，得到最终结果：\n$$\n\\frac{\\mathcal{R}}{F_0} = \\frac{\\pi A}{4 T_0 \\sqrt{1+\\alpha^2}}\n$$\n\n### 实现用公式总结\n\n对于每个具有参数 $(R, u, \\tau_{\\mathrm{rad}}, T_0, A)$ 的测试用例：\n1. 计算无量纲平流参数：\n    $$\n    \\alpha = \\frac{u \\tau_{\\mathrm{rad}}}{R}\n    $$\n2. 计算相位曲线偏移 $\\varphi$（以弧度为单位）并转换为度：\n    $$\n    \\varphi_{\\mathrm{deg}} = \\arctan(\\alpha) \\times \\frac{180}{\\pi}\n    $$\n3. 计算无量纲分数振幅：\n    $$\n    \\frac{\\mathcal{R}}{F_0} = \\frac{\\pi A}{4 T_0 \\sqrt{1+\\alpha^2}}\n    $$\n这些公式对于所有实数值 $u$ 都是稳健的，包括 $u=0$（此时 $\\alpha=0$）和 $u0$（此时 $\\alpha0$）。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the phase curve offset and fractional amplitude for a simplified\n    1D model of a hot Jupiter's atmosphere.\n    \"\"\"\n    test_cases = [\n        # Case 1 (typical hot Jupiter)\n        # R (m), u (m/s), tau_rad (s), T0 (K), A (K)\n        (9.4e7, 2.0e3, 1.5e5, 1600.0, 600.0),\n        # Case 2 (radiative-dominated, small offset)\n        (9.4e7, 2.0e2, 5.0e4, 1400.0, 400.0),\n        # Case 3 (advective-dominated, large offset)\n        (9.4e7, 5.0e3, 2.0e5, 1800.0, 300.0),\n        # Case 4 (boundary, no advection)\n        (9.4e7, 0.0, 1.0e4, 1500.0, 500.0),\n        # Case 5 (westward jet)\n        (9.4e7, -1.0e3, 1.0e5, 1700.0, 500.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        R, u, tau_rad, T0, A = case\n\n        # 1. Calculate the non-dimensional advection parameter alpha.\n        # This parameter is the ratio of the radiative timescale to the\n        # advective timescale over one radian of the planet's circumference.\n        # It is well-defined even for u = 0.\n        alpha = (u * tau_rad) / R\n\n        # 2. Calculate the phase curve offset phi in degrees.\n        # The offset is the arctangent of alpha. A positive alpha (eastward wind)\n        # gives a positive (eastward) phase offset.\n        # We use np.rad2deg for conversion from radians to degrees.\n        phi_rad = np.arctan(alpha)\n        phi_deg = np.rad2deg(phi_rad)\n\n        # 3. Calculate the dimensionless fractional amplitude R/F0.\n        # This is derived from integrating the temperature profile over the\n        # visible hemisphere.\n        amplitude_denominator = np.sqrt(1 + alpha**2)\n        frac_amp = (np.pi * A) / (4 * T0 * amplitude_denominator)\n\n        results.extend([phi_deg, frac_amp])\n\n    # Format the results into a single comma-separated string enclosed in brackets.\n    # The map(str, ...) converts each numerical result to its string representation.\n    # \",\".join(...) concatenates them with commas.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}