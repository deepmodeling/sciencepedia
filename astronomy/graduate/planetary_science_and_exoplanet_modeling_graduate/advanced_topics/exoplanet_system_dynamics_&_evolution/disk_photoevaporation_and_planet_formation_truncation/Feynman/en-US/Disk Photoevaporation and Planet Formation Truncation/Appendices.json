{
    "hands_on_practices": [
        {
            "introduction": "Photoevaporation is driven by gas thermal energy overcoming stellar gravity. This foundational exercise guides you through deriving the characteristic gravitational radius, $r_{\\mathrm{g}}$, where the escape criterion is marginally met. Mastering this calculation is the essential first step for quantifying the region from which a thermally-driven disk wind can be launched .",
            "id": "4158615",
            "problem": "A young solar-type star of mass $M_{\\star}$ is surrounded by a protoplanetary disk whose upper layers are heated by Extreme Ultraviolet (EUV) radiation to a nearly isothermal temperature $T$. Consider the thermally driven escape of gas along open streamlines: a parcel of gas launched from cylindrical radius $r$ can escape to infinity if its available thermal energy per unit mass is sufficient to overcome the star’s gravitational binding per unit mass. Starting from Newtonian gravity and the ideal-gas isothermal sound speed, derive the characteristic radius $r_{\\mathrm{g}}$ at which the escape criterion is marginal, in terms of $G$, $M_{\\star}$, $k_{B}$, $T$, $\\mu$, and $m_{H}$. Then, evaluate this radius for the following parameters: stellar mass $M_{\\star} = 1.2 \\, M_{\\odot}$, temperature $T = 1.0 \\times 10^{4} \\, \\mathrm{K}$, mean molecular weight $\\mu = 0.67$, gravitational constant $G = 6.67430 \\times 10^{-11} \\, \\mathrm{m^{3} \\, kg^{-1} \\, s^{-2}}$, Boltzmann constant $k_{B} = 1.380649 \\times 10^{-23} \\, \\mathrm{J \\, K^{-1}}$, hydrogen atomic mass $m_{H} = 1.6735575 \\times 10^{-27} \\, \\mathrm{kg}$, solar mass $M_{\\odot} = 1.98847 \\times 10^{30} \\, \\mathrm{kg}$, and astronomical unit $\\mathrm{au} = 1.495978707 \\times 10^{11} \\, \\mathrm{m}$. Express the final result for $r_{\\mathrm{g}}$ in astronomical units, and round your answer to three significant figures.",
            "solution": "The problem requires the derivation and evaluation of the characteristic radius $r_{\\mathrm{g}}$ for thermally driven gas escape from a protoplanetary disk. This radius, often called the gravitational radius or Parker radius, is defined as the location where the escape criterion is marginal.\n\nFirst, we must formalize the escape criterion as presented. A gas parcel can escape the star's gravitational pull if its specific thermal energy (thermal energy per unit mass) is at least equal to the specific gravitational binding energy (gravitational potential energy per unit mass). The marginal case occurs when these two quantities are equal.\n\nLet's define the specific gravitational binding energy, $E_{\\mathrm{grav}}$. The gravitational potential energy $U$ of a mass $m$ at a distance $r$ from a central star of mass $M_{\\star}$ is given by Newton's law of universal gravitation:\n$$U = - \\frac{G M_{\\star} m}{r}$$\nThe specific gravitational binding energy is the energy required per unit mass to overcome this potential, which is the magnitude of the potential energy per unit mass:\n$$E_{\\mathrm{grav}} = \\frac{|U|}{m} = \\frac{G M_{\\star}}{r}$$\n\nNext, we define the specific thermal energy, $E_{\\mathrm{th}}$. The problem specifies that the disk's upper layers are at a nearly isothermal temperature $T$ and that we should start from the ideal-gas isothermal sound speed, $c_s$. The isothermal sound speed squared is given by:\n$$c_s^2 = \\frac{P}{\\rho}$$\nwhere $P$ is the pressure and $\\rho$ is the density of the gas. For an ideal gas, the equation of state is $P = nk_{B}T$, where $n$ is the number density of particles and $k_B$ is the Boltzmann constant. The mass density $\\rho$ is related to the number density $n$ by $\\rho = n m_p$, where $m_p$ is the mean mass per gas particle. The mean particle mass is given in terms of the mean molecular weight $\\mu$ and the mass of a hydrogen atom $m_H$ as $m_p = \\mu m_H$.\n\nSubstituting these relations into the expression for the sound speed squared, we get:\n$$c_s^2 = \\frac{n k_{B} T}{n \\mu m_H} = \\frac{k_{B} T}{\\mu m_H}$$\nThe quantity $c_s^2$ represents the characteristic specific thermal energy of the gas, having units of energy per unit mass ($\\mathrm{J/kg}$ or $\\mathrm{m^2/s^2}$). Thus, we set $E_{\\mathrm{th}} = c_s^2$.\n\nThe characteristic radius $r_{\\mathrm{g}}$ is the radius at which the escape criterion is marginal, so we set $E_{\\mathrm{grav}} = E_{\\mathrm{th}}$ at $r = r_{\\mathrm{g}}$:\n$$\\frac{G M_{\\star}}{r_{\\mathrm{g}}} = \\frac{k_{B} T}{\\mu m_H}$$\nSolving for $r_{\\mathrm{g}}$, we obtain the symbolic expression:\n$$r_{\\mathrm{g}} = \\frac{G M_{\\star} \\mu m_{H}}{k_{B} T}$$\n\nNow, we must evaluate this expression using the provided numerical values.\nThe given values are:\nStellar mass: $M_{\\star} = 1.2 \\, M_{\\odot} = 1.2 \\times (1.98847 \\times 10^{30} \\, \\mathrm{kg}) = 2.386164 \\times 10^{30} \\, \\mathrm{kg}$\nTemperature: $T = 1.0 \\times 10^{4} \\, \\mathrm{K}$\nMean molecular weight: $\\mu = 0.67$\nGravitational constant: $G = 6.67430 \\times 10^{-11} \\, \\mathrm{m^{3} \\, kg^{-1} \\, s^{-2}}$\nBoltzmann constant: $k_{B} = 1.380649 \\times 10^{-23} \\, \\mathrm{J \\, K^{-1}}$\nHydrogen atomic mass: $m_{H} = 1.6735575 \\times 10^{-27} \\, \\mathrm{kg}$\nSolar mass: $M_{\\odot} = 1.98847 \\times 10^{30} \\, \\mathrm{kg}$\nAstronomical unit: $\\mathrm{au} = 1.495978707 \\times 10^{11} \\, \\mathrm{m}$\n\nFirst, we calculate the numerator, $G M_{\\star} \\mu m_{H}$:\nNumerator $\\approx (6.67430 \\times 10^{-11}) \\times (2.386164 \\times 10^{30}) \\times (0.67) \\times (1.6735575 \\times 10^{-27})$\nNumerator $\\approx 1.78570 \\times 10^{-7}$\n\nNext, we calculate the denominator, $k_{B} T$:\nDenominator $= (1.380649 \\times 10^{-23}) \\times (1.0 \\times 10^{4})$\nDenominator $= 1.380649 \\times 10^{-19} \\, \\mathrm{J}$\n\nNow, we compute $r_{\\mathrm{g}}$ in meters:\n$$r_{\\mathrm{g}} = \\frac{1.78570 \\times 10^{-7}}{1.380649 \\times 10^{-19}} \\approx 1.29339 \\times 10^{12} \\, \\mathrm{m}$$\n\nFinally, we convert the result to astronomical units ($\\mathrm{au}$) and round to three significant figures as requested.\n$$r_{\\mathrm{g}} \\, (\\mathrm{au}) = \\frac{r_{\\mathrm{g}} \\, (\\mathrm{m})}{\\mathrm{au} \\, (\\mathrm{m/au})} = \\frac{1.29339 \\times 10^{12} \\, \\mathrm{m}}{1.495978707 \\times 10^{11} \\, \\mathrm{m/au}}$$\n$$r_{\\mathrm{g}} \\, (\\mathrm{au}) \\approx 8.64577$$\nRounding to three significant figures, we get $8.65 \\, \\mathrm{au}$.",
            "answer": "$$\\boxed{8.65}$$"
        },
        {
            "introduction": "While a simple energy balance can define a characteristic scale for mass loss , the actual gas temperature is set by a complex interplay of physical processes. This problem challenges you to build a more sophisticated model where the temperature is determined by thermal balance between radiative heating and cooling. You will then connect this thermodynamic state to the hydrodynamic sonic point condition to derive the planet formation truncation radius, revealing how disk physics dictates the final homes of giant planets .",
            "id": "4158610",
            "problem": "Consider a protoplanetary disk atmosphere around a star of mass $M_*$ irradiated by Extreme Ultraviolet (EUV) radiation. Assume the EUV luminosity is $L_{\\mathrm{EUV}}$ and that a fraction $\\eta$ of the incident EUV energy flux is converted into gas heating in the disk atmosphere. Treat the base of the atmosphere at cylindrical radius $r$ as optically thin to EUV photons for the purpose of determining the local energy deposition rate, and approximate the heating rate per unit volume by\n$$\n\\Gamma(r) = \\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi r^{2}}\\,n(r),\n$$\nwhere $n(r)$ is the local number density at the base of the atmosphere. Assume that radiative cooling is dominated by collisional line cooling represented by a power-law cooling function\n$$\n\\Lambda(T) = \\Lambda_{0}\\,T^{\\alpha},\n$$\nso that the cooling rate per unit volume is\n$$\n\\mathcal{C}(r) = \\Lambda_{0}\\,T(r)^{\\alpha}\\,n(r)^{2}.\n$$\nAssume thermal balance in the atmosphere base, i.e., $\\Gamma(r) = \\mathcal{C}(r)$, and adopt a power-law radial density profile\n$$\nn(r) = n_{0}\\left(\\frac{r}{r_{0}}\\right)^{-p},\n$$\nwith constants $n_{0}>0$, $r_{0}>0$, and $p>0$. Treat the outflow launching from the atmosphere as steady and locally isothermal, with sound speed $c_{s}(r)$ determined by the ideal gas relation $c_{s}^{2}(r) = k_{B}T(r)/(\\mu m_{p})$, where $k_{B}$ is Boltzmann’s constant, $m_{p}$ is the proton mass, and $\\mu$ is the mean molecular weight in proton-mass units. Neglect magnetic forces and viscosity in the wind, and model the vertical/radial outflow near launch as a spherically divergent, steady, isothermal hydrodynamic wind under the stellar gravitational potential.\n\nDefine the planet formation truncation radius $r_{\\mathrm{tr}}$ to be the radius at which the isothermal hydrodynamic outflow reaches its sonic point, marking the onset of unbound thermal escape that removes disk gas efficiently and halts giant planet core growth exterior to $r_{\\mathrm{tr}}$. Using the fundamental laws of steady hydrodynamics and the above thermal balance, derive a closed-form analytic expression for $r_{\\mathrm{tr}}$ in terms of the parameters $\\{G, M_{*}, \\mu, m_{p}, k_{B}, \\eta, L_{\\mathrm{EUV}}, \\Lambda_{0}, \\alpha, n_{0}, r_{0}, p\\}$, assuming $\\alpha + p - 2 \\neq 0$.\n\nYour final answer must be a single closed-form analytic expression. No numerical approximation is required.",
            "solution": "The problem asks for the derivation of the planet formation truncation radius, $r_{\\mathrm{tr}}$, in a protoplanetary disk subject to photoevaporative winds driven by stellar EUV radiation. The truncation radius is defined as the sonic point of the outflow. The derivation proceeds in three main steps: first, determining the temperature profile of the disk atmosphere from thermal balance; second, establishing the relationship between temperature and the isothermal sound speed; and third, applying the sonic point condition for a steady, isothermal, spherically-divergent wind to solve for the radius.\n\nFirst, we determine the radial temperature profile, $T(r)$. The problem states that the disk atmosphere is in thermal balance, where the heating rate per unit volume, $\\Gamma(r)$, equals the cooling rate per unit volume, $\\mathcal{C}(r)$.\n$$\n\\Gamma(r) = \\mathcal{C}(r)\n$$\nThe given expressions for these rates are:\n$$\n\\Gamma(r) = \\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi r^{2}}\\,n(r)\n$$\n$$\n\\mathcal{C}(r) = \\Lambda_{0}\\,T(r)^{\\alpha}\\,n(r)^{2}\n$$\nEquating these gives:\n$$\n\\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi r^{2}}\\,n(r) = \\Lambda_{0}\\,T(r)^{\\alpha}\\,n(r)^{2}\n$$\nSince the number density $n(r)$ is non-zero for any finite radius $r$, we can divide both sides by $n(r)$:\n$$\n\\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi r^{2}} = \\Lambda_{0}\\,T(r)^{\\alpha}\\,n(r)\n$$\nThe problem provides a power-law density profile:\n$$\nn(r) = n_{0}\\left(\\frac{r}{r_{0}}\\right)^{-p}\n$$\nSubstituting this expression for $n(r)$ into the thermal balance equation yields:\n$$\n\\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi r^{2}} = \\Lambda_{0}\\,T(r)^{\\alpha}\\,n_{0}\\left(\\frac{r}{r_{0}}\\right)^{-p}\n$$\nWe now solve for $T(r)^{\\alpha}$:\n$$\nT(r)^{\\alpha} = \\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi \\Lambda_{0} n_{0}} \\frac{1}{r^{2}} \\left(\\frac{r}{r_{0}}\\right)^{p} = \\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}} r^{p-2}\n$$\nTaking the $1/\\alpha$ power of both sides gives the temperature profile:\n$$\nT(r) = \\left(\\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}}\\right)^{1/\\alpha} r^{(p-2)/\\alpha}\n$$\nSecond, we relate this temperature to the isothermal sound speed, $c_s(r)$. The problem specifies the ideal gas relation:\n$$\nc_{s}^{2}(r) = \\frac{k_{B}T(r)}{\\mu m_{p}}\n$$\nSubstituting the derived expression for $T(r)$:\n$$\nc_{s}^{2}(r) = \\frac{k_{B}}{\\mu m_{p}} \\left(\\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}}\\right)^{1/\\alpha} r^{(p-2)/\\alpha}\n$$\nThis expression can be written more compactly as $c_{s}^{2}(r) = C r^{(p-2)/\\alpha}$, where $C$ is a constant comprising all the terms in the coefficient.\n\nThird, we find the truncation radius, $r_{\\mathrm{tr}}$, which is defined as the sonic point of the outflow. The problem specifies that the outflow is to be modeled as a steady, spherically divergent, isothermal hydrodynamic wind. This corresponds to the Parker wind model. For an isothermal wind launched from a radius $r$ with sound speed $c_s(r)$, the sonic point occurs at a radius $r_s$ given by:\n$$\nr_s = \\frac{GM_{*}}{2c_{s}^{2}(r)}\n$$\nThe truncation radius $r_{\\mathrm{tr}}$ is the specific radius in the disk where the gas is launched into a wind whose sonic point is located at that same radius. This self-consistency condition is expressed as:\n$$\nr_{\\mathrm{tr}} = \\frac{GM_{*}}{2c_{s}^{2}(r_{\\mathrm{tr}})}\n$$\nWe now substitute our derived expression for $c_{s}^{2}(r)$ evaluated at $r = r_{\\mathrm{tr}}$:\n$$\nr_{\\mathrm{tr}} = \\frac{GM_{*}}{2 \\left[ \\frac{k_{B}}{\\mu m_{p}} \\left(\\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}}\\right)^{1/\\alpha} r_{\\mathrm{tr}}^{(p-2)/\\alpha} \\right]}\n$$\nTo solve for $r_{\\mathrm{tr}}$, we rearrange the equation to gather all terms involving $r_{\\mathrm{tr}}$ on one side:\n$$\nr_{\\mathrm{tr}} \\cdot r_{\\mathrm{tr}}^{(p-2)/\\alpha} = \\frac{GM_{*}}{2} \\left[ \\frac{k_{B}}{\\mu m_{p}} \\left(\\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}}\\right)^{1/\\alpha} \\right]^{-1}\n$$\nCombining the powers of $r_{\\mathrm{tr}}$:\n$$\nr_{\\mathrm{tr}}^{1 + (p-2)/\\alpha} = r_{\\mathrm{tr}}^{(\\alpha + p - 2)/\\alpha} = \\frac{GM_{*}\\mu m_{p}}{2 k_{B}} \\left(\\frac{\\eta\\,L_{\\mathrm{EUV}}}{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}}\\right)^{-1/\\alpha}\n$$\n$$\nr_{\\mathrm{tr}}^{(\\alpha + p - 2)/\\alpha} = \\frac{GM_{*}\\mu m_{p}}{2 k_{B}} \\left(\\frac{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}}{\\eta\\,L_{\\mathrm{EUV}}}\\right)^{1/\\alpha}\n$$\nTo isolate $r_{\\mathrm{tr}}$, we raise both sides to the power of $\\alpha/(\\alpha + p - 2)$. The problem states that $\\alpha + p - 2 \\neq 0$, ensuring this exponent is well-defined.\n$$\nr_{\\mathrm{tr}} = \\left[ \\frac{GM_{*}\\mu m_{p}}{2 k_{B}} \\left(\\frac{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}}{\\eta\\,L_{\\mathrm{EUV}}}\\right)^{1/\\alpha} \\right]^{\\alpha/(\\alpha + p - 2)}\n$$\nThis expression can be simplified by distributing the exponent:\n$$\nr_{\\mathrm{tr}} = \\left(\\frac{GM_{*}\\mu m_{p}}{2 k_{B}}\\right)^{\\alpha/(\\alpha + p - 2)} \\left[ \\left(\\frac{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}}{\\eta\\,L_{\\mathrm{EUV}}}\\right)^{1/\\alpha} \\right]^{\\alpha/(\\alpha + p - 2)}\n$$\n$$\nr_{\\mathrm{tr}} = \\left(\\frac{GM_{*}\\mu m_{p}}{2 k_{B}}\\right)^{\\alpha/(\\alpha + p - 2)} \\left(\\frac{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}}{\\eta\\,L_{\\mathrm{EUV}}}\\right)^{1/(\\alpha + p - 2)}\n$$\nFor a more elegant final form, we can leverage the property $a^x b^y = (a^{x/y} b)^{y}$ and combine the terms under a single exponent:\n$$\nr_{\\mathrm{tr}} = \\left[ \\left(\\frac{GM_{*}\\mu m_{p}}{2 k_{B}}\\right)^{\\alpha} \\left(\\frac{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}}{\\eta\\,L_{\\mathrm{EUV}}}\\right) \\right]^{1/(\\alpha + p - 2)}\n$$\nThis is the final closed-form analytic expression for the planet formation truncation radius $r_{\\mathrm{tr}}$ in terms of the given parameters.",
            "answer": "$$\n\\boxed{\\left[ \\left( \\frac{G M_{*} \\mu m_{p}}{2 k_{B}} \\right)^{\\alpha} \\left( \\frac{4\\pi \\Lambda_{0} n_{0} r_{0}^{p}}{\\eta L_{\\mathrm{EUV}}} \\right) \\right]^{1/(\\alpha + p - 2)}}\n$$"
        },
        {
            "introduction": "Ultimately, theoretical models must be tested against what we can observe. This practice bridges theory and observation by connecting the physics of mass loss, built upon concepts like the gravitational radius  and hydrodynamic outflow , to an observational tracer—line luminosity. You will develop a computational tool to infer the disk mass-loss rate, $\\dot{M}$, and depletion timescale from this observable, a core skill in modern exoplanet modeling .",
            "id": "4158612",
            "problem": "Construct a program that, given observationally inferred line luminosities and a simple isothermal photoevaporative disk-wind model, computes the total disk mass-loss rate and the corresponding disk depletion (planet formation truncation) timescale. The model must be derived from first principles appropriate to disk photoevaporation in planetary system formation and exoplanet modeling.\n\nAssume an irradiated, isothermal, thermally driven wind from a circumstellar disk around a star of mass $M_\\star$ with gas temperature $T$. Let the isothermal sound speed be $c_s$, which for an ideal gas is given by $c_s = \\sqrt{k_B T / (\\mu_{\\mathrm{snd}} m_H)}$, where $k_B$ is Boltzmann’s constant, $m_H$ is the hydrogen mass, and $\\mu_{\\mathrm{snd}}$ is the mean molecular weight appropriate for the sound speed. Let the gravitational constant be $G$. Define the gravitational radius $R_g$ for the disk wind by equating the isothermal sound speed to the escape parameter as $R_g = GM_\\star / (2 c_s^2)$.\n\nAssume the disk supports a warm, emitting surface layer that extends from radius $R_g$ to an outer radius $R_{\\mathrm{out}}$, with vertical scale height $H(r) = c_s / \\Omega_K(r)$, where $\\Omega_K(r) = \\sqrt{GM_\\star / r^3}$. Let the base number density at the warm layer be parameterized as $n(r) = n_0 \\left( r / R_g \\right)^{-p}$ for $r \\in [R_g, R_{\\mathrm{out}}]$, where $n_0$ is an unknown normalization and $p$ is a given power-law index. Let the ionization fraction be $x_e$, such that the electron number density is $n_e(r) = x_e n(r)$. The mass density is $\\rho(r) = \\mu_{\\mathrm{gas}} m_H n(r)$, where $\\mu_{\\mathrm{gas}}$ is the mean molecular weight appropriate for mass density, and the density at the sonic point is $\\rho_s(r) = \\phi \\, \\rho(r)$ with $0 < \\phi \\leq 1$.\n\nAssume the observed line luminosity $L_{\\mathrm{line}}$ is related to the emission measure by $L_{\\mathrm{line}} = \\epsilon \\int n_e^2 \\, dV$, where $\\epsilon$ is an effective radiative coefficient for the chosen line (constant in the model), and the emitting volume in the warm layer is $dV = 2 \\times (2 \\pi r \\, dr) \\times H(r)$ (accounting for both disk surfaces). Further assume the wind becomes sonic at the warm layer surface such that the mass flux is $F_M(r) = \\rho_s(r) c_s$, and the total mass-loss rate from both disk surfaces is $\\dot{M} = \\int 2 \\times (2 \\pi r \\, dr) \\, F_M(r)$ integrated from $R_g$ to $R_{\\mathrm{out}}$.\n\nStarting exclusively from the above definitions and laws of mass conservation and ideal-gas thermodynamics, derive a method to infer $n_0$ from $L_{\\mathrm{line}}$ and then compute the total mass-loss rate $\\dot{M}$ and the truncation timescale $t_{\\mathrm{trunc}} = M_{\\mathrm{disk}} / \\dot{M}$, where $M_{\\mathrm{disk}}$ is the total disk mass. For the integrals over $r$, you must handle the general case $p \\neq 2$ and the special logarithmic case $p = 2$ for the mass-loss integral, and similarly handle the general case $(7/2 - 2p) \\neq 0$ and the special logarithmic case $(7/2 - 2p) = 0$ for the emission measure integral. The program must implement these cases without numerical singularities.\n\nYour program must compute the results for the following test suite of parameter sets, and must produce a single line of output containing the results as a comma-separated list of lists with no spaces, where each inner list has two floats corresponding to $[\\dot{M}, t_{\\mathrm{trunc}}]$. The mass-loss rate must be expressed in $\\mathrm{kg/s}$ and the truncation timescale must be expressed in $\\mathrm{Myr}$, both rounded to three significant figures.\n\nConstants to be used (in the International System of Units (SI)):\n- $G = 6.67430 \\times 10^{-11} \\, \\mathrm{m^3 \\, kg^{-1} \\, s^{-2}}$\n- $k_B = 1.380649 \\times 10^{-23} \\, \\mathrm{J/K}$\n- $m_H = 1.6735575 \\times 10^{-27} \\, \\mathrm{kg}$\n- $M_\\odot = 1.98847 \\times 10^{30} \\, \\mathrm{kg}$\n- $1 \\ \\mathrm{AU} = 1.495978707 \\times 10^{11} \\, \\mathrm{m}$\n- $1 \\ \\mathrm{Myr} = 10^6 \\ \\mathrm{yr} = 3.15576 \\times 10^{13} \\, \\mathrm{s}$\n\nTest suite (all parameters in SI units unless otherwise noted):\n- Case 1 (general “happy path”): $M_\\star = 1.0 \\, M_\\odot$, $T = 10000 \\ \\mathrm{K}$, $\\mu_{\\mathrm{snd}} = 0.62$, $\\mu_{\\mathrm{gas}} = 1.35$, $x_e = 0.7$, $\\phi = 0.5$, $p = 2.1$, $R_{\\mathrm{out}} = 50 \\ \\mathrm{AU}$, $L_{\\mathrm{line}} = 1.0 \\times 10^{24} \\ \\mathrm{W}$, $\\epsilon = 1.0 \\times 10^{-27} \\ \\mathrm{W \\, m^3}$, $M_{\\mathrm{disk}} = 0.05 \\, M_\\odot$.\n- Case 2 (mass-loss integral logarithmic edge): $M_\\star = 0.8 \\, M_\\odot$, $T = 8000 \\ \\mathrm{K}$, $\\mu_{\\mathrm{snd}} = 0.62$, $\\mu_{\\mathrm{gas}} = 1.35$, $x_e = 0.2$, $\\phi = 0.6$, $p = 2.0$, $R_{\\mathrm{out}} = 100 \\ \\mathrm{AU}$, $L_{\\mathrm{line}} = 5.0 \\times 10^{23} \\ \\mathrm{W}$, $\\epsilon = 2.0 \\times 10^{-27} \\ \\mathrm{W \\, m^3}$, $M_{\\mathrm{disk}} = 0.01 \\, M_\\odot$.\n- Case 3 (emission measure integral logarithmic edge): $M_\\star = 1.5 \\, M_\\odot$, $T = 12000 \\ \\mathrm{K}$, $\\mu_{\\mathrm{snd}} = 0.62$, $\\mu_{\\mathrm{gas}} = 1.35$, $x_e = 0.9$, $\\phi = 0.5$, $p = 1.75$, $R_{\\mathrm{out}} = 30 \\ \\mathrm{AU}$, $L_{\\mathrm{line}} = 2.0 \\times 10^{24} \\ \\mathrm{W}$, $\\epsilon = 1.0 \\times 10^{-27} \\ \\mathrm{W \\, m^3}$, $M_{\\mathrm{disk}} = 0.10 \\, M_\\odot$.\n\nFinal output format specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a two-element list for each case, in the exact format: `[[\\dot{M}_1,t_1],[\\dot{M}_2,t_2],[\\dot{M}_3,t_3]]`. There must be no spaces anywhere in the output line. Each $\\dot{M}_i$ must be in $\\mathrm{kg/s}$, and each $t_i$ must be in $\\mathrm{Myr}$, both rounded to three significant figures.",
            "solution": "The objective of this problem is to construct a computational model to determine the total disk mass-loss rate, $\\dot{M}$, and the subsequent disk depletion timescale, $t_{\\mathrm{trunc}}$, based on an observed spectral line luminosity, $L_{\\mathrm{line}}$. The model is a simplified, isothermal, thermally driven wind from a circumstellar disk. The derivation will proceed from the first principles and definitions provided.\n\nFirst, we establish the fundamental physical parameters of the model. The isothermal sound speed, $c_s$, is given by\n$$c_s = \\sqrt{\\frac{k_B T}{\\mu_{\\mathrm{snd}} m_H}}$$\nwhere $T$ is the gas temperature, $k_B$ is the Boltzmann constant, $m_H$ is the mass of a hydrogen atom, and $\\mu_{\\mathrm{snd}}$ is the mean molecular weight for sound speed calculations.\n\nThe gravitational radius, $R_g$, defines the inner edge of the photoevaporative wind and is the radius where the thermal energy becomes comparable to the gravitational potential energy. It is defined as\n$$R_g = \\frac{GM_\\star}{2 c_s^2}$$\nwhere $G$ is the gravitational constant and $M_\\star$ is the mass of the central star.\n\nThe derivation is structured in three main steps:\n1.  Relate the observable, $L_{\\mathrm{line}}$, to the unknown base number density normalization, $n_0$.\n2.  Express the desired mass-loss rate, $\\dot{M}$, as a function of $n_0$.\n3.  Combine these results to find $\\dot{M}$ purely in terms of known quantities, and subsequently find $t_{\\mathrm{trunc}}$.\n\n**Step 1: Derivation of Line Luminosity $L_{\\mathrm{line}}$**\n\nThe line luminosity is given by the integral of the emissivity over the emitting volume $V$:\n$$L_{\\mathrm{line}} = \\int_V \\epsilon n_e^2 \\, dV$$\nwhere $\\epsilon$ is the effective radiative coefficient and $n_e$ is the electron number density. The electron density is related to the total gas number density, $n(r)$, by the ionization fraction $x_e$: $n_e(r) = x_e n(r)$. The gas density follows a power-law distribution with radius $r$:\n$$n(r) = n_0 \\left( \\frac{r}{R_g} \\right)^{-p}$$\nwhere $n_0$ is the normalization constant we need to determine.\n\nThe differential emitting volume element, $dV$, for a thin layer on both surfaces of the disk is given by $dV = 2 \\times (2\\pi r \\, dr) \\times H(r)$, where $H(r)$ is the vertical scale height of the emitting layer. The scale height is defined as $H(r) = c_s / \\Omega_K(r)$, with the Keplerian angular velocity $\\Omega_K(r) = \\sqrt{GM_\\star / r^3}$. This gives:\n$$H(r) = \\frac{c_s}{\\sqrt{GM_\\star / r^3}} = c_s (GM_\\star)^{-1/2} r^{3/2}$$\nSo the volume element is $dV = 4\\pi c_s (GM_\\star)^{-1/2} r^{5/2} dr$.\n\nSubstituting these expressions into the luminosity equation and integrating from the inner radius $R_g$ to the outer radius $R_{\\mathrm{out}}$:\n$$L_{\\mathrm{line}} = \\int_{R_g}^{R_{\\mathrm{out}}} \\epsilon \\left( x_e n_0 \\left( \\frac{r}{R_g} \\right)^{-p} \\right)^2 \\left( 4\\pi c_s (GM_\\star)^{-1/2} r^{5/2} \\right) dr$$\nWe can separate the constants from the integral:\n$$L_{\\mathrm{line}} = 4\\pi \\epsilon x_e^2 n_0^2 R_g^{2p} c_s (GM_\\star)^{-1/2} \\int_{R_g}^{R_{\\mathrm{out}}} r^{-2p} r^{5/2} dr$$\n$$L_{\\mathrm{line}} = 4\\pi \\epsilon x_e^2 n_0^2 R_g^{2p} c_s (GM_\\star)^{-1/2} \\int_{R_g}^{R_{\\mathrm{out}}} r^{5/2 - 2p} dr$$\n\nLet's define the luminosity integral $I_L = \\int_{R_g}^{R_{\\mathrm{out}}} r^{5/2 - 2p} dr$. This integral has two cases depending on the power-law index $p$.\n- For the general case where $5/2 - 2p \\neq -1$ (i.e., $p \\neq 1.75$):\n$$I_L = \\left[ \\frac{r^{5/2 - 2p + 1}}{5/2 - 2p + 1} \\right]_{R_g}^{R_{\\mathrm{out}}} = \\frac{R_{\\mathrm{out}}^{7/2 - 2p} - R_g^{7/2 - 2p}}{7/2 - 2p}$$\n- For the special logarithmic case where $p = 1.75$:\n$$I_L = \\int_{R_g}^{R_{\\mathrm{out}}} r^{-1} dr = \\left[ \\ln(r) \\right]_{R_g}^{R_{\\mathrm{out}}} = \\ln\\left(\\frac{R_{\\mathrm{out}}}{R_g}\\right)$$\nThus, $L_{\\mathrm{line}}$ can be written as $L_{\\mathrm{line}} = K_L n_0^2$, where $K_L = 4\\pi \\epsilon x_e^2 R_g^{2p} c_s (GM_\\star)^{-1/2} I_L$.\n\n**Step 2: Derivation of Mass-Loss Rate $\\dot{M}$**\n\nThe total mass-loss rate $\\dot{M}$ is the integral of the mass flux $F_M(r)$ over the wind-launching area on both disk surfaces:\n$$\\dot{M} = \\int_{R_g}^{R_{\\mathrm{out}}} F_M(r) \\cdot (2 \\times 2\\pi r \\, dr)$$\nThe mass flux at the sonic surface is $F_M(r) = \\rho_s(r) c_s$, where the density at the sonic point is $\\rho_s(r) = \\phi \\rho(r)$. The mass density $\\rho(r)$ is given by $\\rho(r) = \\mu_{\\mathrm{gas}} m_H n(r)$, where $\\mu_{\\mathrm{gas}}$ is the mean molecular weight of the gas. Substituting these relations:\n$$\\dot{M} = \\int_{R_g}^{R_{\\mathrm{out}}} \\left( \\phi (\\mu_{\\mathrm{gas}} m_H n_0 (r/R_g)^{-p}) c_s \\right) 4\\pi r dr$$\nAgain, we separate the constants from the integral:\n$$\\dot{M} = 4\\pi \\phi \\mu_{\\mathrm{gas}} m_H c_s n_0 R_g^p \\int_{R_g}^{R_{\\mathrm{out}}} r^{-p} r^1 dr$$\n$$\\dot{M} = 4\\pi \\phi \\mu_{\\mathrm{gas}} m_H c_s n_0 R_g^p \\int_{R_g}^{R_{\\mathrm{out}}} r^{1-p} dr$$\n\nLet's define the mass-loss integral $I_M = \\int_{R_g}^{R_{\\mathrm{out}}} r^{1-p} dr$. This integral also has two cases.\n- For the general case where $1-p \\neq -1$ (i.e., $p \\neq 2$):\n$$I_M = \\left[ \\frac{r^{1-p+1}}{1-p+1} \\right]_{R_g}^{R_{\\mathrm{out}}} = \\frac{R_{\\mathrm{out}}^{2-p} - R_g^{2-p}}{2-p}$$\n- For the special logarithmic case where $p = 2$:\n$$I_M = \\int_{R_g}^{R_{\\mathrm{out}}} r^{-1} dr = \\left[ \\ln(r) \\right]_{R_g}^{R_{\\mathrm{out}}} = \\ln\\left(\\frac{R_{\\mathrm{out}}}{R_g}\\right)$$\nThus, $\\dot{M}$ can be written as $\\dot{M} = K_M n_0$, where $K_M = 4\\pi \\phi \\mu_{\\mathrm{gas}} m_H c_s R_g^p I_M$.\n\n**Step 3: Final Expression for $\\dot{M}$ and $t_{\\mathrm{trunc}}$**\n\nWe have two equations relating our unknowns and knowns:\n1.  $L_{\\mathrm{line}} = K_L n_0^2$\n2.  $\\dot{M} = K_M n_0$\n\nFrom equation (1), we can solve for $n_0$: $n_0 = \\sqrt{L_{\\mathrm{line}}/K_L}$. Substituting this into equation (2):\n$$\\dot{M} = K_M \\sqrt{\\frac{L_{\\mathrm{line}}}{K_L}} = \\frac{K_M}{\\sqrt{K_L}} \\sqrt{L_{\\mathrm{line}}}$$\nNow, we substitute the full expressions for $K_M$ and $\\sqrt{K_L}$:\n$$K_M = 4\\pi \\phi \\mu_{\\mathrm{gas}} m_H c_s R_g^p I_M$$\n$$\\sqrt{K_L} = \\sqrt{4\\pi \\epsilon x_e^2 R_g^{2p} c_s (GM_\\star)^{-1/2} I_L} = 2\\sqrt{\\pi} \\sqrt{\\epsilon} x_e R_g^p \\sqrt{c_s} (GM_\\star)^{-1/4} \\sqrt{I_L}$$\nDividing $K_M$ by $\\sqrt{K_L}$ gives:\n$$\\frac{K_M}{\\sqrt{K_L}} = \\frac{4\\pi \\phi \\mu_{\\mathrm{gas}} m_H c_s R_g^p I_M}{2\\sqrt{\\pi} \\sqrt{\\epsilon} x_e R_g^p \\sqrt{c_s} (GM_\\star)^{-1/4} \\sqrt{I_L}} = \\frac{2\\sqrt{\\pi} \\phi \\mu_{\\mathrm{gas}} m_H c_s^{1/2} (GM_\\star)^{1/4} I_M}{\\sqrt{\\epsilon} x_e \\sqrt{I_L}}$$\nThe final expression for the mass-loss rate is:\n$$\\dot{M} = \\left( \\frac{2\\sqrt{\\pi} \\phi \\mu_{\\mathrm{gas}} m_H}{\\sqrt{\\epsilon} x_e} \\right) \\sqrt{c_s} (GM_\\star)^{1/4} \\sqrt{L_{\\mathrm{line}}} \\left( \\frac{I_M}{\\sqrt{I_L}} \\right)$$\n\nFinally, the disk depletion (truncation) timescale, $t_{\\mathrm{trunc}}$, is calculated by dividing the total disk mass, $M_{\\mathrm{disk}}$, by the mass-loss rate:\n$$t_{\\mathrm{trunc}} = \\frac{M_{\\mathrm{disk}}}{\\dot{M}}$$\n\nThe computational procedure is to:\n1.  Calculate $c_s$ and $R_g$ from the input parameters.\n2.  Calculate the integral terms $I_L$ and $I_M$, correctly handling the special cases for $p=1.75$ and $p=2.0$.\n3.  Use the final expression above to compute $\\dot{M}$ in SI units ($\\mathrm{kg/s}$).\n4.  Compute $t_{\\mathrm{trunc}}$ in seconds and convert to megayears ($\\mathrm{Myr}$).\n5.  Round the final results to three significant figures as required.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes disk mass-loss rate and depletion timescale based on a photoevaporative wind model.\n    \"\"\"\n\n    # Physical constants in SI units\n    G = 6.674e-11  # Gravitational constant (m^3 kg^-1 s^-2)\n    k_B = 1.380649e-23  # Boltzmann's constant (J/K)\n    m_H = 1.6735575e-27  # Hydrogen mass (kg)\n    M_sol = 1.98847e30  # Solar mass (kg)\n    AU = 1.495978707e11  # Astronomical unit (m)\n    MYR_in_s = 3.15576e13  # Seconds in a Megayear\n\n    test_cases = [\n        {\n            \"M_star_msol\": 1.0, \"T\": 10000.0, \"mu_snd\": 0.62, \"mu_gas\": 1.35, \"x_e\": 0.7,\n            \"phi\": 0.5, \"p\": 2.1, \"R_out_au\": 50.0, \"L_line\": 1.0e24, \"epsilon\": 1.0e-27,\n            \"M_disk_msol\": 0.05\n        },\n        {\n            \"M_star_msol\": 0.8, \"T\": 8000.0, \"mu_snd\": 0.62, \"mu_gas\": 1.35, \"x_e\": 0.2,\n            \"phi\": 0.6, \"p\": 2.0, \"R_out_au\": 100.0, \"L_line\": 5.0e23, \"epsilon\": 2.0e-27,\n            \"M_disk_msol\": 0.01\n        },\n        {\n            \"M_star_msol\": 1.5, \"T\": 12000.0, \"mu_snd\": 0.62, \"mu_gas\": 1.35, \"x_e\": 0.9,\n            \"phi\": 0.5, \"p\": 1.75, \"R_out_au\": 30.0, \"L_line\": 2.0e24, \"epsilon\": 1.0e-27,\n            \"M_disk_msol\": 0.10\n        }\n    ]\n\n    results = []\n\n    # Function to round to a specified number of significant figures\n    def round_to_sf(value, sf):\n        if value == 0:\n            return 0.0\n        # Use format specifier for scientific notation to control significant figures\n        return float(f'{value:.{sf-1}e}')\n\n    for params in test_cases:\n        # Unpack parameters and convert to SI units\n        M_star = params[\"M_star_msol\"] * M_sol\n        T = params[\"T\"]\n        mu_snd = params[\"mu_snd\"]\n        mu_gas = params[\"mu_gas\"]\n        x_e = params[\"x_e\"]\n        phi = params[\"phi\"]\n        p = params[\"p\"]\n        R_out = params[\"R_out_au\"] * AU\n        L_line = params[\"L_line\"]\n        epsilon = params[\"epsilon\"]\n        M_disk = params[\"M_disk_msol\"] * M_sol\n\n        # Step 1: Calculate intermediate physical quantities\n        c_s = np.sqrt(k_B * T / (mu_snd * m_H))\n        R_g = G * M_star / (2 * c_s**2)\n\n        # Step 2: Calculate the integral terms I_L and I_M with special case handling\n        # Luminosity integral I_L\n        if np.isclose(p, 1.75):  # Special case: p = 7/4\n            I_L = np.log(R_out / R_g)\n        else:\n            exponent_L = 7.0/2.0 - 2.0*p\n            I_L = (R_out**exponent_L - R_g**exponent_L) / exponent_L\n\n        # Mass-loss integral I_M\n        if np.isclose(p, 2.0):  # Special case: p = 2\n            I_M = np.log(R_out / R_g)\n        else:\n            exponent_M = 2.0 - p\n            I_M = (R_out**exponent_M - R_g**exponent_M) / exponent_M\n\n        # Step 3: Calculate the total mass-loss rate M_dot\n        prefactor = (2 * np.sqrt(np.pi) * phi * mu_gas * m_H) / (np.sqrt(epsilon) * x_e)\n        dynamics_term = np.sqrt(c_s) * (G * M_star)**0.25\n        luminosity_term = np.sqrt(L_line)\n        integral_ratio = I_M / np.sqrt(I_L)\n\n        M_dot = prefactor * dynamics_term * luminosity_term * integral_ratio\n\n        # Step 4: Calculate the truncation timescale\n        t_trunc_s = M_disk / M_dot\n        t_trunc_myr = t_trunc_s / MYR_in_s\n\n        # Step 5: Round results to three significant figures\n        M_dot_rounded = round_to_sf(M_dot, 3)\n        t_trunc_rounded = round_to_sf(t_trunc_myr, 3)\n\n        results.append([M_dot_rounded, t_trunc_rounded])\n\n    # Format the final output string as specified\n    output_str = \"[\" + \",\".join([f\"[{mdot},{tt}]\" for mdot, tt in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}