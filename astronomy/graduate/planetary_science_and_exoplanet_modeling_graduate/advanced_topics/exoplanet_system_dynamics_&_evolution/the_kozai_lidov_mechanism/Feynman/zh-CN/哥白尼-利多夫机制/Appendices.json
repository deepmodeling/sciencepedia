{
    "hands_on_practices": [
        {
            "introduction": "这项实践提供了古在-李道夫动力学中的一个基础练习。通过应用双重平均、四极矩阶长期演化系统中的守恒量，你将推导出初始为圆形的内层轨道所能达到的最大偏心率。这项计算是理解古在-李道夫机制如何改变轨道结构的基石 。",
            "id": "4177196",
            "problem": "考虑一个分级三体系统，它由一颗质量为 $M_{\\star}$ 的中心恒星、一颗质量为 $m_{1}$ 且在半长轴为 $a_{1}$ 的初始圆形轨道上运行的内侧行星，以及一颗质量为 $m_{2}$ 且在半长轴为 $a_{2}$ 的宽阔圆形轨道上运行的外侧伴星组成。在 $t=0$ 时，内侧轨道和外侧轨道之间的互倾角为 $i_{0}$。假设该系统是动态分级的 ($a_{1} \\ll a_{2}$)，外侧轨道严格为圆形，且短程力（广义相对论 (GR)、潮汐效应、旋转扁率）可忽略不计。在牛顿点质量引力的双重平均、四极矩阶的长期近似框架下进行分析，并将内侧行星相对于外侧轨道的角动量视为测试粒子极限。\n\n给定以下具体值：\n- $M_{\\star} = 1.0\\,M_{\\odot}$，\n- $m_{1} = 10\\,M_{\\oplus}$，\n- $m_{2} = 1.0\\,M_{\\mathrm{Jup}}$，\n- $a_{1} = 0.7\\,\\mathrm{AU}$，\n- $a_{2} = 30\\,\\mathrm{AU}$，\n- $e_{1}(0) = 0$，\n- $e_{2} = 0$，\n- $i_{0} = 60^{\\circ}$（角度以度为单位表示），\n\n从牛顿万有引力定律、轨道角动量的定义以及双重平均四极矩微扰函数出发，推导长期Kozai-Lidov (KL) 动力学中的守恒量，并利用它们在给定上述初始条件下，确定内侧轨道在KL循环期间所能达到的最大偏心率 $e_{1,\\max}$。将最终答案表示为一个无量纲数，并四舍五入到四位有效数字。在任何出现角度的地方，都请注明所使用的角度单位。",
            "solution": "问题要求解一个分级三体系统中，经历Kozai-Lidov (KL) 振荡的内侧行星所能达到的最大偏心率 $e_{1,\\max}$。这个问题在长期天体力学框架内提法恰当且有科学依据。\n\n出发点是三体系统（$M_{\\star}$，$m_{1}$，$m_{2}$）中的引力相互作用。内侧行星（$m_{1}$）相对于中心恒星（$M_{\\star}$）的运动方程包含一个由外侧伴星（$m_{2}$）引起的微扰项。这种微扰的势，称为微扰函数 $R$，可以按轨道半径之比展开为Legendre多项式级数。对于 $a_{1} \\ll a_{2}$ 的分级系统，我们可以在四极矩阶（与 $(r_{1}/r_{2})^{2}$ 成正比的项）截断此展开。\n\n通过对内侧和外侧轨道的平近点角（轨道相位）对微扰函数进行平均来研究长期演化。这个双重平均势 $\\langle R \\rangle$，或等效的长期哈密顿量 $\\mathcal{H}_{\\mathrm{sec}} = -\\langle R \\rangle$，决定了轨道根数的长期演化，但半长轴除外，它在此近似下保持不变。\n\n对于处在圆形轨道上的外侧伴星（$e_{2}=0$），且内侧行星处于测试粒子极限（$m_{1} \\to 0$）的情况下，双重平均、四极矩阶的长期哈密顿量取决于内侧轨道的偏心率 $e_{1}$、相对于外侧轨道平面的倾角 $i$ 以及近心点幅角 $\\omega_{1}$。该哈密顿量的一个标准形式是：\n$$ \\mathcal{H}_{\\mathrm{sec}} = C \\left[ (2+3e_{1}^{2})(1-3\\cos^{2}i) - 15e_{1}^{2}\\sin^{2}i \\cos(2\\omega_{1}) \\right] $$\n其中 $C$ 是一个取决于质量和半长轴（$M_{\\star}$，$m_{2}$，$a_{1}$，$a_{2}$）的常数。由于我们关心的是形状（$e_1$）和方向（$i, \\omega_1$）的演化，因此 $C$ 的精确值对于求解最大偏心率不是必需的。\n\n由此哈密顿量描述的长期动力学有两个关键的守恒量：\n\n1.  **长期哈密顿量本身**：由于 $\\mathcal{H}_{\\mathrm{sec}}$ 不显式地依赖于时间，其值在整个演化过程中是守恒的。\n    $$ (2+3e_{1}^{2})(1-3\\cos^{2}i) - 15e_{1}^{2}\\sin^{2}i \\cos(2\\omega_{1}) = \\mathrm{constant} $$\n\n2.  **Kozai-Lidov 积分**：哈密顿量与升交点黄经 $\\Omega_{1}$ 无关。在典则轨道根数（Delaunay 变量）中，与 $\\Omega_{1}$ 共轭的作用量是 $H_1 = \\sqrt{G(M_{\\star}+m_1)a_1(1-e_1^2)}\\cos i$。由于 $a_1$ 是常数，其他项是物理常数，这意味着 $\\sqrt{1-e_1^2}\\cos i$ 是守恒的。习惯上使用该量的平方：\n    $$ C_{KL} = (1-e_{1}^{2})\\cos^{2}i = \\mathrm{constant} $$\n\n我们可以从 $t=0$ 时的初始条件来确定这些常数的值：\n-   内侧轨道的初始偏心率：$e_{1}(0) = 0$。\n-   初始互倾角：$i(0) = i_{0} = 60^{\\circ}$。\n\nKozai-Lidov 积分的初始值为：\n$$ C_{KL} = (1 - e_{1}(0)^{2})\\cos^{2}(i_{0}) = (1-0^{2})\\cos^{2}(60^{\\circ}) = (\\frac{1}{2})^{2} = \\frac{1}{4} $$\n因此，对于所有时间 $t$，我们有：\n$$ (1-e_{1}(t)^{2})\\cos^{2}(i(t)) = \\frac{1}{4} $$\n\n守恒的哈密顿量的值在 $t=0$ 处计算。注意，当 $e_{1}(0)=0$ 时，包含 $\\cos(2\\omega_{1})$ 的项为零。\n$$ \\mathcal{H}_{\\mathrm{sec}}(0) = C \\left[ (2+3 \\cdot 0^{2})(1-3\\cos^{2}(60^{\\circ})) - 15 \\cdot 0^{2} \\sin^{2}(60^{\\circ}) \\cos(2\\omega_{1}(0)) \\right] $$\n$$ \\mathcal{H}_{\\mathrm{sec}}(0) = C \\left[ 2(1-3(\\frac{1}{2})^{2}) \\right] = C \\left[ 2(1-\\frac{3}{4}) \\right] = C \\left[ 2(\\frac{1}{4}) \\right] = \\frac{C}{2} $$\n两边除以 $C$，无量纲哈密顿量的守恒值为 $1/2$。\n\n最大偏心率 $e_{1,\\max}$ 在KL循环的转折点达到。对于从 $e_1=0$ 和初始倾角 $i_0$ 大于临界角 $i_c = \\arccos(\\sqrt{3/5}) \\approx 39.2^{\\circ}$ 开始的系统，近心点幅角 $\\omega_1$ 会在 $90^{\\circ}$ 或 $270^{\\circ}$ 附近天平动。当 $\\omega_1 = 90^{\\circ}$ 或 $270^{\\circ}$ 时，偏心率达到最大，此时 $\\cos(2\\omega_{1}) = \\cos(\\pi) = -1$。\n\n设 $e_{1,\\max}$ 为最大偏心率，$i_{\\min}$ 为对应的倾角。此时，两个守恒定律必须成立：\n1.  $(1-e_{1,\\max}^{2})\\cos^{2}(i_{\\min}) = C_{KL} = \\frac{1}{4}$\n2.  $(2+3e_{1,\\max}^{2})(1-3\\cos^{2}i_{\\min}) - 15e_{1,\\max}^{2}\\sin^{2}i_{\\min} \\cos(\\pi) = \\frac{1}{2}$\n\n从方程(1)中，我们可以用 $e_{1,\\max}$ 表示 $\\cos^{2}(i_{\\min})$ 和 $\\sin^{2}(i_{\\min})$：\n$$ \\cos^{2}(i_{\\min}) = \\frac{1}{4(1-e_{1,\\max}^{2})} $$\n$$ \\sin^{2}(i_{\\min}) = 1 - \\cos^{2}(i_{\\min}) = 1 - \\frac{1}{4(1-e_{1,\\max}^{2})} = \\frac{4-4e_{1,\\max}^{2}-1}{4(1-e_{1,\\max}^{2})} = \\frac{3-4e_{1,\\max}^{2}}{4(1-e_{1,\\max}^{2})} $$\n\n现在，将这些表达式代入方程(2)，并记住 $\\cos(2\\omega_1) = -1$：\n$$ (2+3e_{1,\\max}^{2})(1-3\\cos^{2}i_{\\min}) + 15e_{1,\\max}^{2}\\sin^{2}i_{\\min} = \\frac{1}{2} $$\n$$ (2+3e_{1,\\max}^{2})\\left(1 - \\frac{3}{4(1-e_{1,\\max}^{2})}\\right) + 15e_{1,\\max}^{2}\\left(\\frac{3-4e_{1,\\max}^{2}}{4(1-e_{1,\\max}^{2})}\\right) = \\frac{1}{2} $$\n为简化起见，令 $x = e_{1,\\max}^{2}$。\n$$ (2+3x)\\left(\\frac{4(1-x)-3}{4(1-x)}\\right) + 15x\\left(\\frac{3-4x}{4(1-x)}\\right) = \\frac{1}{2} $$\n$$ (2+3x)\\left(\\frac{1-4x}{4(1-x)}\\right) + \\frac{15x(3-4x)}{4(1-x)} = \\frac{1}{2} $$\n整个方程乘以 $4(1-x)$：\n$$ (2+3x)(1-4x) + 15x(3-4x) = 2(1-x) $$\n展开各项：\n$$ (2 - 8x + 3x - 12x^{2}) + (45x - 60x^{2}) = 2 - 2x $$\n$$ 2 - 5x - 12x^{2} + 45x - 60x^{2} = 2 - 2x $$\n$$ 2 + 40x - 72x^{2} = 2 - 2x $$\n两边减去 $2$ 并重新整理：\n$$ 42x - 72x^{2} = 0 $$\n$$ 6x(7 - 12x) = 0 $$\n这个方程给出两个可能的解：$x=0$ 或 $x=7/12$。解 $x=e_{1,\\max}^{2}=0$ 对应于初始状态（即最小偏心率）。另一个解必定对应于最大偏心率。\n$$ e_{1,\\max}^{2} = \\frac{7}{12} $$\n取平方根以求得最大偏心率：\n$$ e_{1,\\max} = \\sqrt{\\frac{7}{12}} $$\n问题要求一个四舍五入到四位有效数字的数值答案。\n$$ e_{1,\\max} = \\sqrt{\\frac{7}{12}} \\approx \\sqrt{0.583333...} \\approx 0.76376261... $$\n四舍五入到四位有效数字，我们得到 $0.7638$。提供的其他参数（$M_{\\star}$，$m_{1}$，$m_{2}$，$a_{1}$，$a_{2}$）证实了该系统是分级的，并且测试粒子近似是有效的，但它们只影响振荡的时间尺度，而不影响此处确定的偏心率变化的幅度。",
            "answer": "$$\\boxed{0.7638}$$"
        },
        {
            "introduction": "在理解了古在-李道夫振荡的振幅之后，这项练习将焦点转向其特征时间尺度。你将运用物理标度律论证和开普勒第三定律，来确定古在-李道夫周期与遥远扰动天体轨道周期之间的关系。这项实践  对于建立长期演化动力学中固有的时间尺度巨大分离的直观理解至关重要。",
            "id": "1918587",
            "problem": "考虑一个分层三星系统。该系统由一个引力束缚的“内双星”和一个遥远的“外伴星”组成，内双星由两颗质量分别为 $m_1$ 和 $m_2$ 的恒星构成，外伴星的质量为 $m_3$。内双星中的两颗恒星以周期 $P_{in}$ 和半长轴 $a_{in}$ 绕着它们的共同质心运行。外伴星以周期 $P_{out}$ 和半长轴 $a_{out}$ 绕着内双星的质心运行。该系统是分层的，意味着 $a_{out} \\gg a_{in}$。\n\n外伴星的轨道相对于内双星的轨道平面是倾斜的。这种构型会导致长期的引力摄动，其中外伴星对内双星施加潮汐力矩。这导致内双星的轨道在其倾角和离心率上经历缓慢的周期性振荡。这种现象被称为 Kozai-Lidov (KL) 机制，它在一个特征时间尺度 $T_{KL}$ 上演化。\n\n假设时间尺度 $T_{KL}$ 与外伴星的周期遵循幂律关系，由 $T_{KL} \\propto P_{out}^{\\alpha}$ 给出，请确定指数 $\\alpha$ 的值。你的分析应基于物理标度论证和开普勒第三定律。将所有三颗恒星的质量（$m_1, m_2, m_3$）和内双星的周期（$P_{in}$）视为固定常数。",
            "solution": "我们寻求 Kozai-Lidov 时间尺度与外轨道周期的标度关系，同时保持 $m_{1}$、$m_{2}$、$m_{3}$ 和 $P_{in}$ 固定。KL 振荡是由外伴星的四极潮汐势驱动的，它引起内双星轨道根数的长期进动。在四极阶，摄动的无量纲强度标度为\n$$\n\\epsilon \\sim \\frac{m_{3}}{M_{tot}}\\left(\\frac{a_{in}}{a_{out}}\\right)^{3},\n$$\n其中 $M_{tot}=m_{1}+m_{2}+m_{3}$。内轨道根数的特征长期 (KL) 演化率的量级为\n$$\n\\dot{\\omega}_{\\mathrm{sec}} \\sim \\epsilon\\,n_{in},\n$$\n其中 $n_{in}=2\\pi/P_{in}$ 是内轨道的平运动。因此，KL 时间尺度由长期演化率的倒数决定：\n$$\nT_{KL} \\sim \\frac{1}{\\epsilon\\,n_{in}}.\n$$\n为了用周期表示半长轴之比，我们对内轨道和外轨道使用开普勒第三定律：\n$$\nn_{in}^{2}a_{in}^{3}=G M_{in},\\qquad n_{out}^{2}a_{out}^{3}=G M_{tot},\n$$\n其中 $M_{in}=m_{1}+m_{2}$ 且 $n_{out}=2\\pi/P_{out}$。求解该比值可得\n$$\n\\left(\\frac{a_{in}}{a_{out}}\\right)^{3}=\\frac{n_{out}^{2}}{n_{in}^{2}}\\frac{M_{in}}{M_{tot}}.\n$$\n代入 $\\epsilon\\,n_{in}$ 中可得\n$$\n\\epsilon\\,n_{in}=\\frac{m_{3}}{M_{tot}}\\left(\\frac{n_{out}^{2}}{n_{in}^{2}}\\frac{M_{in}}{M_{tot}}\\right)n_{in}\n=\\frac{m_{3}M_{in}}{M_{tot}^{2}}\\frac{n_{out}^{2}}{n_{in}}.\n$$\n因此，\n$$\nT_{KL}\\sim \\frac{1}{\\epsilon\\,n_{in}}\\propto \\frac{n_{in}}{n_{out}^{2}}.\n$$\n用周期替换平运动，$n_{in}=2\\pi/P_{in}$ 和 $n_{out}=2\\pi/P_{out}$，可得\n$$\n\\frac{n_{in}}{n_{out}^{2}}=\\frac{2\\pi/P_{in}}{(2\\pi)^{2}/P_{out}^{2}}=\\frac{P_{out}^{2}}{2\\pi\\,P_{in}}.\n$$\n因此，在 $P_{in}$ 和质量固定的情况下，KL 时间尺度的标度关系为\n$$\nT_{KL}\\propto P_{out}^{2}.\n$$\n这对应于关系式 $T_{KL}\\propto P_{out}^{\\alpha}$ 中的指数 $\\alpha=2$。任何对外轨道离心率的依赖关系，例如标准表达式中存在的因子 $(1-e_{out}^{2})^{3/2}$，都与 $P_{out}$ 无关，因此不影响该指数。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "最后一项实践通过引入统计视角，将理论动力学与天体物理应用联系起来。你将在最大偏心率推导的基础上，为一个轨道随机取向的系统群体计算达到极端偏心率的概率。这个问题  演示了如何将基础的长期演化理论与对整个天体系统群体的可观测预测联系起来，这是现代天体物理学中的一项常见任务。",
            "id": "4182895",
            "problem": "考虑一个牛顿引力下的层级三体系统：一个质量为 $M$ 的中心恒星，一个质量可忽略、在半长轴为 $a_{\\mathrm{in}}$ 的初始圆形轨道上运行的内侧行星，以及一个质量为 $m_{\\mathrm{out}}$、在半长轴为 $a_{\\mathrm{out}}$ 的圆形轨道上运行的遥远外层伴星，且满足 $a_{\\mathrm{out}} \\gg a_{\\mathrm{in}}$。内侧轨道具有偏心率 $e$、相对于外层轨道的固定平面的轨道倾角 $i$ 以及近心点辐角 $\\omega$。在长期演化的双重平均四极矩近似下，当关于初始互倾角 $i_0$ 的某些条件得到满足时，该系统会展现出 Kozai-Lidov (KL) 机制，导致轨道倾角和偏心率之间发生周期性交换。\n\n从基本的牛顿动力学和双重平均四极矩层级的长期理论出发，利用轴对称平均势固有的守恒定律，推导当内侧轨道初始为圆形 ($e_0 = 0$) 时发生 KL 振荡所需的初始互倾角 $i_0$ 的条件。然后，推导当 $\\omega$ 达到适当的极值时，在 KL 振荡期间达到的最大偏心率 $e_{\\max}(i_0)$ 的表达式。\n\n为了模拟内侧轨道相对于外层轨道平面的随机朝向，假设初始互倾角 $i_0$ 从定义在 $i \\in [0,\\pi]$ 上的参数化概率密度函数 $f(i;\\alpha)$ 中抽取，其定义为\n$$\nf(i;\\alpha) = C(\\alpha)\\,\\sin i\\,\\bigl(1 + \\alpha \\cos^2 i\\bigr),\n$$\n其中 $\\alpha$ 是一个满足 $\\alpha \\ge -1$ 的实参数（以确保非负性），$C(\\alpha)$ 是一个归一化常数，其选择使得 $\\int_{0}^{\\pi} f(i;\\alpha)\\,di = 1$。角度必须以弧度处理。对于给定的偏心率阈值 $e_{\\mathrm{thr}} \\in [0,1]$，令 $P(\\alpha, e_{\\mathrm{thr}})$ 表示一个具有密度 $f(i;\\alpha)$ 的随机朝向系统满足 $e_{\\max}(i_0) \\ge e_{\\mathrm{thr}}$ 的概率。\n\n你的任务是：\n- 从第一性原理出发，推导在四极矩、双重平均近似以及外层轨道为圆形的条件下，当 $e_0=0$ 时发生 KL 振荡所需的 $i_0$ 条件，以及 $e_{\\max}(i_0)$ 的公式。\n- 根据这些推导，通过在满足 $e_{\\max}(i_0) \\ge e_{\\mathrm{thr}}$ 的倾角集合上对 $f(i;\\alpha)$ 进行积分，用 $\\alpha$ 和 $e_{\\mathrm{thr}}$ 表示 $P(\\alpha, e_{\\mathrm{thr}})$。\n\n实现一个程序，为以下每个测试用例计算 $P(\\alpha, e_{\\mathrm{thr}})$，并将结果输出为四舍五入到六位小数的十进制数：\n1. $\\alpha = 0$, $e_{\\mathrm{thr}} = 0.0$。\n2. $\\alpha = 0$, $e_{\\mathrm{thr}} = 0.5$。\n3. $\\alpha = 0$, $e_{\\mathrm{thr}} = 0.99$。\n4. $\\alpha = -1$, $e_{\\mathrm{thr}} = 0.0$。\n5. $\\alpha = 5$, $e_{\\mathrm{thr}} = 0.5$。\n6. $\\alpha = 0$, $e_{\\mathrm{thr}} = 1.0$。\n\n你的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表（例如，“[result1,result2,result3,result4,result5,result6]”）。每个结果必须是四舍五入到六位小数的浮点数。输出中不出现物理单位，因为概率是无量纲的。",
            "solution": "问题陈述经过了仔细验证，被确定为是合理的、适定的，并且在天体力学的既定框架内具有科学依据。它提出了一个基于 Kozai-Lidov 机制的双重平均四极矩近似的形式化、可解问题。因此，我们可以进行完整的求解。\n\n该解答分三部分推导：首先，我们确定平均化系统的守恒量，并推导出最大偏心率 $e_{\\max}$ 的表达式；其次，根据此表达式，我们推断出发生 Kozai-Lidov (KL) 振荡的条件；第三，我们通过在适当的倾角范围内对给定的概率密度函数进行积分，来计算概率 $P(\\alpha, e_{\\mathrm{thr}})$。\n\n### Kozai-Lidov 积分和最大偏心率的推导\n\n该问题考虑了一个在牛顿引力下的层级三体系统，并在长期（轨道平均）近似下进行分析。外层伴星的轨道是圆形的，并定义了一个固定的参考平面。由于外层天体所施加的时间平均势具有轴对称性，内侧轨道的比角动量矢量在垂直于外层轨道平面方向上的分量是一个守恒量。\n\n内侧轨道的比角动量 $\\vec{L}_{\\mathrm{in}}$ 的大小由下式给出：\n$$\n|\\vec{L}_{\\mathrm{in}}| = \\sqrt{G(M+m_{\\mathrm{in}})a_{\\mathrm{in}}(1-e^2)}\n$$\n其中 $G$ 是引力常数，$M$ 是恒星质量，$m_{\\mathrm{in}}$ 是内侧行星的质量，$a_{\\mathrm{in}}$ 是其半长轴，$e$ 是其偏心率。由于行星质量可忽略不计（$m_{\\mathrm{in}} \\approx 0$），该式简化为 $|\\vec{L}_{\\mathrm{in}}| = \\sqrt{GM a_{\\mathrm{in}}(1-e^2)}$。\n\n$\\vec{L}_{\\mathrm{in}}$ 沿对称轴（垂直于外层轨道平面）的分量，记为 $L_z$，是：\n$$\nL_z = |\\vec{L}_{\\mathrm{in}}| \\cos i = \\sqrt{GM a_{\\mathrm{in}}(1-e^2)} \\cos i\n$$\n其中 $i$ 是内、外轨道平面之间的互倾角。在长期近似中，半长轴 $a_{\\mathrm{in}}$ 也是一个运动常数。因此，量 $(1-e^2)\\cos^2 i$ 必须守恒。这就给出了基本的 Kozai-Lidov 运动积分 $\\Theta$：\n$$\n\\Theta = (1-e^2)\\cos^2 i = \\text{constant}\n$$\n对于一个初始为圆形（$e_0 = 0$）且初始倾角为 $i_0$ 的内侧轨道，这个常数的值是固定的：\n$$\n\\Theta = (1-0^2)\\cos^2 i_0 = \\cos^2 i_0\n$$\n因此，在系统的整个长期演化过程中，偏心率和倾角必须满足：\n$$\n(1-e^2)\\cos^2 i = \\cos^2 i_0\n$$\nKL 振荡的特征——大的偏心率变化，与近心点辐角 $\\omega$ 的平动相关。当轨道倾角 $i$ 达到极值时，偏心率 $e$ 达到其最大值 $e_{\\max}$。这种情况发生在 $\\omega = \\pi/2$ 或 $\\omega = 3\\pi/2$ 时。在这些点，近心点辐角的长期时间导数 $d\\omega/dt$ 瞬时为零。在四极矩近似下，$\\omega=\\pi/2$（或 $3\\pi/2$）时 $d\\omega/dt = 0$ 的条件导致了倾角的一个特定值，我们记为 $i_{\\min}$：\n$$\n5\\cos^2 i_{\\min} - 3 = 0 \\implies \\cos^2 i_{\\min} = \\frac{3}{5}\n$$\n将此代入最大偏心率点（$e=e_{\\max}$, $i=i_{\\min}$）的守恒定律中：\n$$\n(1-e_{\\max}^2)\\cos^2 i_{\\min} = \\cos^2 i_0\n$$\n$$\n(1-e_{\\max}^2) \\left(\\frac{3}{5}\\right) = \\cos^2 i_0\n$$\n求解 $e_{\\max}^2$ 可得：\n$$\n1-e_{\\max}^2 = \\frac{5}{3}\\cos^2 i_0 \\implies e_{\\max}^2 = 1 - \\frac{5}{3}\\cos^2 i_0\n$$\n因此，最大偏心率为：\n$$\ne_{\\max}(i_0) = \\sqrt{1 - \\frac{5}{3}\\cos^2 i_0}\n$$\n仅当平方根下的项为非负时，此表达式才会为 $e_{\\max}$ 生成一个实数、非负的值。这直接导出了对于初始圆形轨道发生 KL 振荡的条件：\n$$\n1 - \\frac{5}{3}\\cos^2 i_0 \\ge 0 \\implies \\cos^2 i_0 \\le \\frac{3}{5}\n$$\n如果此条件不满足（即，如果 $|\\cos i_0| > \\sqrt{3/5}$），近心点辐角会循环，偏心率仅经历小幅振荡。在此机制下，最大偏心率实际上为零，$e_{\\max}=0$。临界倾角为 $i_{crit} = \\arccos(\\sqrt{3/5}) \\approx 39.2^\\circ$ 和 $\\pi - i_{crit} \\approx 140.8^\\circ$。\n\n### 概率 $P(\\alpha, e_{\\mathrm{thr}})$ 的推导\n\n我们得到初始倾角 $i_0$ 在区间 $i_0 \\in [0, \\pi]$ 上的概率密度函数 (PDF)：\n$$\nf(i;\\alpha) = C(\\alpha)\\,\\sin i\\,\\bigl(1 + \\alpha \\cos^2 i\\bigr)\n$$\n首先，我们通过要求 $\\int_{0}^{\\pi} f(i;\\alpha)\\,di = 1$ 来找到归一化常数 $C(\\alpha)$。我们进行换元，令 $u = \\cos i$，得到 $du = -\\sin i\\,di$。积分限从 $i \\in [0, \\pi]$ 变为 $u \\in [1, -1]$。\n$$\n\\int_{0}^{\\pi} \\sin i\\,\\bigl(1 + \\alpha \\cos^2 i\\bigr) \\,di = \\int_{1}^{-1} (1+\\alpha u^2)(-du) = \\int_{-1}^{1} (1+\\alpha u^2)\\,du\n$$\n$$\n= \\left[ u + \\frac{\\alpha}{3}u^3 \\right]_{-1}^{1} = \\left(1 + \\frac{\\alpha}{3}\\right) - \\left(-1 - \\frac{\\alpha}{3}\\right) = 2 + \\frac{2\\alpha}{3} = \\frac{2(3+\\alpha)}{3}\n$$\n归一化常数是该值的倒数：\n$$\nC(\\alpha) = \\frac{3}{2(3+\\alpha)}\n$$\n接下来，我们确定使最大偏心率达到或超过给定阈值 $e_{\\max}(i_0) \\ge e_{\\mathrm{thr}}$ 的倾角集合。\n$$\n\\sqrt{1 - \\frac{5}{3}\\cos^2 i_0} \\ge e_{\\mathrm{thr}}\n$$\n由于对于 $e_{\\mathrm{thr}} \\in [0, 1]$，不等式两边都是非负的，我们可以对其进行平方：\n$$\n1 - \\frac{5}{3}\\cos^2 i_0 \\ge e_{\\mathrm{thr}}^2 \\implies 1 - e_{\\mathrm{thr}}^2 \\ge \\frac{5}{3}\\cos^2 i_0 \\implies \\cos^2 i_0 \\le \\frac{3}{5}(1-e_{\\mathrm{thr}}^2)\n$$\n我们定义一个临界值 $z_{crit} = \\sqrt{\\frac{3}{5}(1-e_{\\mathrm{thr}}^2)}$。条件变为 $|\\cos i_0| \\le z_{crit}$。这对应于倾角范围 $i_0 \\in [\\arccos(z_{crit}), \\pi - \\arccos(z_{crit})]$。\n\n概率 $P(\\alpha, e_{\\mathrm{thr}})$ 是在此范围内对 PDF 的积分：\n$$\nP(\\alpha, e_{\\mathrm{thr}}) = \\int_{\\arccos(z_{crit})}^{\\pi-\\arccos(z_{crit})} C(\\alpha)\\,\\sin i\\,\\bigl(1 + \\alpha \\cos^2 i\\bigr)\\,di\n$$\n使用同样的代换 $u=\\cos i$，$u$ 的积分限变为 $[\\cos(\\arccos(z_{crit})), \\cos(\\pi-\\arccos(z_{crit}))] = [z_{crit}, -z_{crit}]$。\n$$\nP(\\alpha, e_{\\mathrm{thr}}) = C(\\alpha) \\int_{z_{crit}}^{-z_{crit}} (1+\\alpha u^2)(-du) = C(\\alpha) \\int_{-z_{crit}}^{z_{crit}} (1+\\alpha u^2)\\,du\n$$\n$$\n= C(\\alpha) \\left[ u + \\frac{\\alpha}{3}u^3 \\right]_{-z_{crit}}^{z_{crit}} = C(\\alpha) \\left( 2z_{crit} + \\frac{2\\alpha}{3}z_{crit}^3 \\right) = 2C(\\alpha)z_{crit}\\left(1 + \\frac{\\alpha}{3}z_{crit}^2\\right)\n$$\n代入 $C(\\alpha)$、$z_{crit}$ 和 $z_{crit}^2$ 的表达式：\n$$\nP(\\alpha, e_{\\mathrm{thr}}) = 2\\left(\\frac{3}{2(3+\\alpha)}\\right) \\sqrt{\\frac{3}{5}(1-e_{\\mathrm{thr}}^2)} \\left(1 + \\frac{\\alpha}{3}\\frac{3}{5}(1-e_{\\mathrm{thr}}^2)\\right)\n$$\n$$\nP(\\alpha, e_{\\mathrm{thr}}) = \\frac{3}{3+\\alpha} \\sqrt{\\frac{3}{5}(1-e_{\\mathrm{thr}}^2)} \\left(1 + \\frac{\\alpha}{5}(1-e_{\\mathrm{thr}}^2)\\right)\n$$\n这就是所求概率的最终解析表达式。它对于 $e_{\\mathrm{thr}} \\in [0, 1)$ 有效。对于 $e_{\\mathrm{thr}} \\ge 1$，我们有 $1-e_{\\mathrm{thr}}^2 \\le 0$，这使得 $z_{crit}=0$（或为虚数），因此 $P(\\alpha, e_{\\mathrm{thr}}) = 0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the probability P(alpha, e_thr) that a system with initial\n    inclination drawn from a given PDF will exceed a threshold eccentricity\n    due to Kozai-Lidov oscillations.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (alpha, e_thr)\n        (0.0, 0.0),\n        (0.0, 0.5),\n        (0.0, 0.99),\n        (-1.0, 0.0),\n        (5.0, 0.5),\n        (0.0, 1.0)\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha, e_thr = case\n\n        # The probability is zero if the threshold eccentricity is 1 or greater,\n        # as reaching e=1 requires a set of initial conditions of measure zero.\n        if e_thr >= 1.0:\n            prob = 0.0\n        else:\n            # The analytical formula derived from first principles is:\n            # P(alpha, e_thr) = (3 / (3 + alpha)) * z_crit * (1 + (alpha / 5) * (1 - e_thr^2))\n            # where z_crit = sqrt((3/5) * (1 - e_thr^2))\n\n            e_thr_sq = e_thr**2\n            one_minus_e_thr_sq = 1.0 - e_thr_sq\n            \n            # The term (3/5)*(1-e_thr^2) appears in z_crit and z_crit^2\n            z_crit_sq_val = (3.0 / 5.0) * one_minus_e_thr_sq\n            z_crit_val = np.sqrt(z_crit_sq_val)\n\n            term1 = 3.0 / (3.0 + alpha)\n            term2 = 1.0 + (alpha / 5.0) * one_minus_e_thr_sq\n            \n            prob = term1 * z_crit_val * term2\n\n        results.append(prob)\n\n    # Format the output as a comma-separated list of floats rounded to\n    # six decimal places, enclosed in square brackets.\n    # The format specifier ensures trailing zeros, e.g., 0.0 -> 0.000000\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}