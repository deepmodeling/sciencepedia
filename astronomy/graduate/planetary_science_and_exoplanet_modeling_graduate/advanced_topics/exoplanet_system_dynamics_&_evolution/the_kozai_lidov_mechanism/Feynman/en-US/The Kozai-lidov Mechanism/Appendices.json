{
    "hands_on_practices": [
        {
            "introduction": "Mastering the Kozai-Lidov mechanism begins with a firm grasp of its underlying conserved quantities. This exercise provides a direct application of the theory by tasking you with calculating the maximum eccentricity an inner planet can reach in a hierarchical triple system. By applying the conservation of the secular Hamiltonian and the Kozai-Lidov integral, $\\Theta = (1-e^2)\\cos^2 i$, you will solidify your understanding of how these principles govern the dramatic orbital transformations characteristic of this phenomenon .",
            "id": "4177196",
            "problem": "Consider a hierarchical triple consisting of a central star of mass $M_{\\star}$, an inner planet of mass $m_{1}$ on an initially circular orbit of semi-major axis $a_{1}$, and an outer companion of mass $m_{2}$ on a wide, circular orbit of semi-major axis $a_{2}$. The mutual inclination between the inner and outer orbits at $t=0$ is $i_{0}$. Assume that the system is dynamically hierarchical ($a_{1} \\ll a_{2}$), the outer orbit is exactly circular, and short-range forces (General Relativity (GR), tidal effects, rotational flattening) are negligible. Work within the double-averaged, quadrupole-order secular approximation of Newtonian point-mass gravity, and treat the inner planet in the test-particle limit relative to the outer orbit’s angular momentum.\n\nGiven the following specific values:\n- $M_{\\star} = 1.0\\,M_{\\odot}$,\n- $m_{1} = 10\\,M_{\\oplus}$,\n- $m_{2} = 1.0\\,M_{\\mathrm{Jup}}$,\n- $a_{1} = 0.7\\,\\mathrm{AU}$,\n- $a_{2} = 30\\,\\mathrm{AU}$,\n- $e_{1}(0) = 0$,\n- $e_{2} = 0$,\n- $i_{0} = 60^{\\circ}$ (angles expressed in degrees),\n\nStarting from Newton’s law of gravitation and the definitions of orbital angular momentum and the double-averaged quadrupole disturbing function, derive the conserved quantities of the secular Kozai-Lidov (KL) dynamics and use them to determine the maximum eccentricity $e_{1,\\max}$ that the inner orbit can reach during KL cycles, given the above initial conditions. Express the final answer as a dimensionless number and round your answer to four significant figures. State the angle unit used wherever an angle appears.",
            "solution": "The problem asks for the maximum eccentricity, $e_{1,\\max}$, achieved by an inner planet in a hierarchical triple system undergoing Kozai-Lidov (KL) oscillations. The problem is well-posed and scientifically grounded within the framework of secular celestial mechanics.\n\nThe starting point is the gravitational interaction in a three-body system ($M_{\\star}$, $m_{1}$, $m_{2}$). The equation of motion for the inner planet ($m_{1}$) relative to the central star ($M_{\\star}$) includes a perturbing term due to the outer companion ($m_{2}$). The potential for this perturbation, known as the disturbing function $R$, can be expanded in a series of Legendre polynomials of the ratio of the orbital radii. For a hierarchical system where $a_{1} \\ll a_{2}$, we can truncate this expansion at the quadrupole order (the term proportional to $(r_{1}/r_{2})^{2}$).\n\nThe secular evolution is studied by averaging the disturbing function over the mean anomalies (orbital phases) of both the inner and outer orbits. This double-averaged potential, $\\langle R \\rangle$, or equivalently the secular Hamiltonian $\\mathcal{H}_{\\mathrm{sec}} = -\\langle R \\rangle$, governs the long-term evolution of the orbital elements, except for the semi-major axes, which remain constant in this approximation.\n\nFor an outer companion on a circular orbit ($e_{2}=0$), and in the test-particle limit for the inner planet ($m_{1} \\to 0$), the double-averaged, quadrupole-order secular Hamiltonian depends on the inner orbit's eccentricity $e_{1}$, inclination $i$ relative to the outer orbit's plane, and argument of pericenter $\\omega_{1}$. A standard form of this Hamiltonian is:\n$$ \\mathcal{H}_{\\mathrm{sec}} = C \\left[ (2+3e_{1}^{2})(1-3\\cos^{2}i) - 15e_{1}^{2}\\sin^{2}i \\cos(2\\omega_{1}) \\right] $$\nwhere $C$ is a constant depending on the masses and semi-major axes ($M_{\\star}$, $m_{2}$, $a_{1}$, $a_{2}$). Since we are interested in the evolution of shape ($e_1$) and orientation ($i, \\omega_1$), the exact value of $C$ is not necessary for finding the maximum eccentricity.\n\nThe secular dynamics described by this Hamiltonian has two key conserved quantities:\n\n1.  **The Secular Hamiltonian itself**: Since $\\mathcal{H}_{\\mathrm{sec}}$ does not explicitly depend on time, its value is conserved throughout the evolution.\n    $$ (2+3e_{1}^{2})(1-3\\cos^{2}i) - 15e_{1}^{2}\\sin^{2}i \\cos(2\\omega_{1}) = \\mathrm{constant} $$\n\n2.  **The Kozai-Lidov Integral**: The Hamiltonian is independent of the longitude of the ascending node, $\\Omega_{1}$. In canonical orbital elements (Delaunay variables), the action conjugate to $\\Omega_{1}$ is $H_1 = \\sqrt{G(M_{\\star}+m_1)a_1(1-e_1^2)}\\cos i$. Since $a_1$ is constant and other terms are physical constants, this implies the conservation of $\\sqrt{1-e_1^2}\\cos i$. It is conventional to use the square of this quantity:\n    $$ C_{KL} = (1-e_{1}^{2})\\cos^{2}i = \\mathrm{constant} $$\n\nWe can determine the values of these constants from the initial conditions at $t=0$:\n-   Initial eccentricity of the inner orbit: $e_{1}(0) = 0$.\n-   Initial mutual inclination: $i(0) = i_{0} = 60^{\\circ}$.\n\nThe initial value of the Kozai-Lidov integral is:\n$$ C_{KL} = (1 - e_{1}(0)^{2})\\cos^{2}(i_{0}) = (1-0^{2})\\cos^{2}(60^{\\circ}) = (\\frac{1}{2})^{2} = \\frac{1}{4} $$\nSo, for all time $t$, we have:\n$$ (1-e_{1}(t)^{2})\\cos^{2}(i(t)) = \\frac{1}{4} $$\n\nThe value of the conserved Hamiltonian is evaluated at $t=0$. Note that when $e_{1}(0)=0$, the term with $\\cos(2\\omega_{1})$ vanishes.\n$$ \\mathcal{H}_{\\mathrm{sec}}(0) = C \\left[ (2+3 \\cdot 0^{2})(1-3\\cos^{2}(60^{\\circ})) - 15 \\cdot 0^{2} \\sin^{2}(60^{\\circ}) \\cos(2\\omega_{1}(0)) \\right] $$\n$$ \\mathcal{H}_{\\mathrm{sec}}(0) = C \\left[ 2(1-3(\\frac{1}{2})^{2}) \\right] = C \\left[ 2(1-\\frac{3}{4}) \\right] = C \\left[ 2(\\frac{1}{4}) \\right] = \\frac{C}{2} $$\nDividing by $C$, the conserved value of the dimensionless Hamiltonian is $1/2$.\n\nThe maximum eccentricity, $e_{1,\\max}$, is reached at the turning points of the KL cycle. For systems that start with $e_1=0$ and an initial inclination $i_0$ greater than the critical angle $i_c = \\arccos(\\sqrt{3/5}) \\approx 39.2^{\\circ}$, the argument of pericenter $\\omega_1$ librates around $90^{\\circ}$ or $270^{\\circ}$. The eccentricity is maximized when $\\omega_1 = 90^{\\circ}$ or $270^{\\circ}$, which makes $\\cos(2\\omega_{1}) = \\cos(\\pi) = -1$.\n\nLet $e_{1,\\max}$ be the maximum eccentricity and $i_{\\min}$ be the corresponding inclination. At this point, the two conservation laws must hold:\n1.  $(1-e_{1,\\max}^{2})\\cos^{2}(i_{\\min}) = C_{KL} = \\frac{1}{4}$\n2.  $(2+3e_{1,\\max}^{2})(1-3\\cos^{2}i_{\\min}) - 15e_{1,\\max}^{2}\\sin^{2}i_{\\min} \\cos(\\pi) = \\frac{1}{2}$\n\nFrom equation (1), we can express $\\cos^{2}(i_{\\min})$ and $\\sin^{2}(i_{\\min})$ in terms of $e_{1,\\max}$:\n$$ \\cos^{2}(i_{\\min}) = \\frac{1}{4(1-e_{1,\\max}^{2})} $$\n$$ \\sin^{2}(i_{\\min}) = 1 - \\cos^{2}(i_{\\min}) = 1 - \\frac{1}{4(1-e_{1,\\max}^{2})} = \\frac{4-4e_{1,\\max}^{2}-1}{4(1-e_{1,\\max}^{2})} = \\frac{3-4e_{1,\\max}^{2}}{4(1-e_{1,\\max}^{2})} $$\n\nNow, substitute these into equation (2), remembering that $\\cos(2\\omega_1) = -1$:\n$$ (2+3e_{1,\\max}^{2})(1-3\\cos^{2}i_{\\min}) + 15e_{1,\\max}^{2}\\sin^{2}i_{\\min} = \\frac{1}{2} $$\n$$ (2+3e_{1,\\max}^{2})\\left(1 - \\frac{3}{4(1-e_{1,\\max}^{2})}\\right) + 15e_{1,\\max}^{2}\\left(\\frac{3-4e_{1,\\max}^{2}}{4(1-e_{1,\\max}^{2})}\\right) = \\frac{1}{2} $$\nLet $x = e_{1,\\max}^{2}$ for simplicity.\n$$ (2+3x)\\left(\\frac{4(1-x)-3}{4(1-x)}\\right) + 15x\\left(\\frac{3-4x}{4(1-x)}\\right) = \\frac{1}{2} $$\n$$ (2+3x)\\left(\\frac{1-4x}{4(1-x)}\\right) + \\frac{15x(3-4x)}{4(1-x)} = \\frac{1}{2} $$\nMultiply the entire equation by $4(1-x)$:\n$$ (2+3x)(1-4x) + 15x(3-4x) = 2(1-x) $$\nExpand the terms:\n$$ (2 - 8x + 3x - 12x^{2}) + (45x - 60x^{2}) = 2 - 2x $$\n$$ 2 - 5x - 12x^{2} + 45x - 60x^{2} = 2 - 2x $$\n$$ 2 + 40x - 72x^{2} = 2 - 2x $$\nSubtract $2$ from both sides and rearrange:\n$$ 42x - 72x^{2} = 0 $$\n$$ 6x(7 - 12x) = 0 $$\nThis equation gives two possible solutions: $x=0$ or $x=7/12$. The solution $x=e_{1,\\max}^{2}=0$ corresponds to the initial state (which is the minimum eccentricity). The other solution must correspond to the maximum eccentricity.\n$$ e_{1,\\max}^{2} = \\frac{7}{12} $$\nTaking the square root to find the maximum eccentricity:\n$$ e_{1,\\max} = \\sqrt{\\frac{7}{12}} $$\nThe problem asks for a numerical answer rounded to four significant figures.\n$$ e_{1,\\max} = \\sqrt{\\frac{7}{12}} \\approx \\sqrt{0.583333...} \\approx 0.76376261... $$\nRounding to four significant figures, we get $0.7638$. The other parameters provided ($M_{\\star}$, $m_{1}$, $m_{2}$, $a_{1}$, $a_{2}$) confirm that the system is hierarchical and the test-particle approximation is valid, but they only affect the timescale of the oscillations, not the amplitude of the eccentricity variation determined here.",
            "answer": "$$\\boxed{0.7638}$$"
        },
        {
            "introduction": "Beyond calculating the exact evolution of a single system, it is crucial for a physicist to develop an intuition for the timescales involved in a given process. This practice challenges you to move from detailed dynamics to physical scaling arguments. By combining Kepler's Third Law with the fundamental dependencies of the quadrupole gravitational potential, you will determine how the characteristic period of Kozai-Lidov oscillations scales with the properties of the perturbing outer body .",
            "id": "1918587",
            "problem": "Consider a hierarchical triple star system. This system consists of a gravitationally bound 'inner binary' composed of two stars with masses $m_1$ and $m_2$, and a distant 'outer companion' star of mass $m_3$. The inner binary stars orbit their common center of mass with a period $P_{in}$ and a semi-major axis $a_{in}$. The outer companion orbits the center of mass of the inner binary with a period $P_{out}$ and a semi-major axis $a_{out}$. The system is hierarchical, meaning $a_{out} \\gg a_{in}$.\n\nThe orbit of the outer companion is inclined with respect to the orbital plane of the inner binary. This configuration leads to a long-term gravitational perturbation where the outer companion exerts a tidal torque on the inner binary. This causes the inner binary's orbit to undergo slow, periodic oscillations in its inclination and eccentricity. This phenomenon is known as the Kozai-Lidov (KL) mechanism, and it evolves over a characteristic timescale $T_{KL}$.\n\nAssuming that the timescale $T_{KL}$ follows a power-law relationship with the outer companion's period, given by $T_{KL} \\propto P_{out}^{\\alpha}$, determine the value of the exponent $\\alpha$. Your analysis should be based on physical scaling arguments and Kepler's Third Law. Treat the masses of all three stars ($m_1, m_2, m_3$) and the period of the inner binary ($P_{in}$) as fixed constants.",
            "solution": "We seek the scaling of the Kozai-Lidov timescale with the outer orbital period, keeping $m_{1}$, $m_{2}$, $m_{3}$ and $P_{in}$ fixed. The KL oscillations are driven by the quadrupole tidal potential of the outer companion, which induces a secular precession of the inner binary’s orbital elements. The dimensionless strength of the perturbation at quadrupole order scales as\n$$\n\\epsilon \\sim \\frac{m_{3}}{M_{tot}}\\left(\\frac{a_{in}}{a_{out}}\\right)^{3},\n$$\nwhere $M_{tot}=m_{1}+m_{2}+m_{3}$. The characteristic secular (KL) evolution rate of the inner orbit’s elements is then of order\n$$\n\\dot{\\omega}_{\\mathrm{sec}} \\sim \\epsilon\\,n_{in},\n$$\nwhere $n_{in}=2\\pi/P_{in}$ is the inner mean motion. Therefore the KL timescale is set by the inverse secular rate:\n$$\nT_{KL} \\sim \\frac{1}{\\epsilon\\,n_{in}}.\n$$\nTo express the semi-major axis ratio in terms of periods, we use Kepler’s third law for the inner and outer orbits:\n$$\nn_{in}^{2}a_{in}^{3}=G M_{in},\\qquad n_{out}^{2}a_{out}^{3}=G M_{tot},\n$$\nwith $M_{in}=m_{1}+m_{2}$ and $n_{out}=2\\pi/P_{out}$. Solving for the ratio gives\n$$\n\\left(\\frac{a_{in}}{a_{out}}\\right)^{3}=\\frac{n_{out}^{2}}{n_{in}^{2}}\\frac{M_{in}}{M_{tot}}.\n$$\nSubstituting into $\\epsilon\\,n_{in}$ yields\n$$\n\\epsilon\\,n_{in}=\\frac{m_{3}}{M_{tot}}\\left(\\frac{n_{out}^{2}}{n_{in}^{2}}\\frac{M_{in}}{M_{tot}}\\right)n_{in}\n=\\frac{m_{3}M_{in}}{M_{tot}^{2}}\\frac{n_{out}^{2}}{n_{in}}.\n$$\nTherefore,\n$$\nT_{KL}\\sim \\frac{1}{\\epsilon\\,n_{in}}\\propto \\frac{n_{in}}{n_{out}^{2}}.\n$$\nReplacing mean motions by periods, $n_{in}=2\\pi/P_{in}$ and $n_{out}=2\\pi/P_{out}$, gives\n$$\n\\frac{n_{in}}{n_{out}^{2}}=\\frac{2\\pi/P_{in}}{(2\\pi)^{2}/P_{out}^{2}}=\\frac{P_{out}^{2}}{2\\pi\\,P_{in}}.\n$$\nHence, with $P_{in}$ and the masses fixed, the KL timescale scales as\n$$\nT_{KL}\\propto P_{out}^{2}.\n$$\nThis corresponds to an exponent $\\alpha=2$ in the relation $T_{KL}\\propto P_{out}^{\\alpha}$. Any dependence on outer eccentricity, such as a factor $(1-e_{out}^{2})^{3/2}$ present in the standard expression, is independent of $P_{out}$ and thus does not affect the exponent.",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "The principles of the Kozai-Lidov mechanism find powerful application in statistical studies of astrophysical populations, such as exoplanetary systems or stellar binaries. This advanced exercise bridges dynamics with probability theory, challenging you to evaluate the likelihood of extreme eccentricity excitation for an ensemble of systems with randomly distributed orbital orientations. By deriving the probability of exceeding an eccentricity threshold, you will engage in a task that mirrors the methods used to connect theoretical models with observational data .",
            "id": "4182895",
            "problem": "Consider a hierarchical triple system in Newtonian gravity: a central star of mass $M$, an inner planet of negligible mass on an initially circular orbit with semi-major axis $a_{\\mathrm{in}}$, and a distant outer companion of mass $m_{\\mathrm{out}}$ on a circular orbit with semi-major axis $a_{\\mathrm{out}}$ satisfying $a_{\\mathrm{out}} \\gg a_{\\mathrm{in}}$. The inner orbit has eccentricity $e$, inclination $i$ relative to the fixed plane of the outer orbit, and argument of pericenter $\\omega$. Under the doubly averaged quadrupole approximation for secular evolution, the system exhibits the Kozai-Lidov (KL) mechanism when certain conditions on the initial mutual inclination $i_0$ are met, leading to periodic exchange between inclination and eccentricity.\n\nStarting from fundamental Newtonian dynamics and the doubly averaged quadrupole-level secular theory, use the conservation laws inherent to the axisymmetric averaged potential to derive the condition on the initial mutual inclination $i_0$ under which KL oscillations occur for an initially circular inner orbit ($e_0 = 0$). Then derive the expression for the maximum eccentricity $e_{\\max}(i_0)$ attained during KL oscillations when $\\omega$ reaches the appropriate extremal value.\n\nTo model random orientations of the inner orbit relative to the outer orbit plane, assume that the initial mutual inclination $i_0$ is drawn from a parametric probability density function $f(i;\\alpha)$ on $i \\in [0,\\pi]$ defined by\n$$\nf(i;\\alpha) = C(\\alpha)\\,\\sin i\\,\\bigl(1 + \\alpha \\cos^2 i\\bigr),\n$$\nwhere $\\alpha$ is a real parameter satisfying $\\alpha \\ge -1$ (to ensure nonnegativity), and $C(\\alpha)$ is a normalization constant chosen so that $\\int_{0}^{\\pi} f(i;\\alpha)\\,di = 1$. Angles must be treated in radians. For a given eccentricity threshold $e_{\\mathrm{thr}} \\in [0,1]$, let $P(\\alpha, e_{\\mathrm{thr}})$ denote the probability that a randomly oriented system with density $f(i;\\alpha)$ has $e_{\\max}(i_0) \\ge e_{\\mathrm{thr}}$.\n\nYour task is to:\n- Derive from first principles the condition on $i_0$ for KL oscillations to occur for $e_0=0$, and the formula for $e_{\\max}(i_0)$ under the quadrupole, doubly averaged approximation with a circular outer orbit.\n- From these derivations, express $P(\\alpha, e_{\\mathrm{thr}})$ in terms of $\\alpha$ and $e_{\\mathrm{thr}}$ by integrating $f(i;\\alpha)$ over the set of inclinations that satisfy $e_{\\max}(i_0) \\ge e_{\\mathrm{thr}}$.\n\nImplement a program that computes $P(\\alpha, e_{\\mathrm{thr}})$ for each of the following test cases and outputs the results as decimal numbers rounded to six decimal places:\n1. $\\alpha = 0$, $e_{\\mathrm{thr}} = 0.0$.\n2. $\\alpha = 0$, $e_{\\mathrm{thr}} = 0.5$.\n3. $\\alpha = 0$, $e_{\\mathrm{thr}} = 0.99$.\n4. $\\alpha = -1$, $e_{\\mathrm{thr}} = 0.0$.\n5. $\\alpha = 5$, $e_{\\mathrm{thr}} = 0.5$.\n6. $\\alpha = 0$, $e_{\\mathrm{thr}} = 1.0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5,result6]\"). Each result must be a float rounded to six decimal places. No physical units appear in the output because probabilities are dimensionless.",
            "solution": "The problem statement has been meticulously validated and is determined to be sound, well-posed, and scientifically grounded within the established framework of celestial mechanics. It presents a formal, solvable problem based on the doubly averaged quadrupole approximation of the Kozai-Lidov mechanism. We may therefore proceed with a complete solution.\n\n### Derivation of the Kozai-Lidov Integral and Maximum Eccentricity\n\nThe problem considers a hierarchical three-body system under Newtonian gravity, analyzed in the secular (orbit-averaged) approximation. The outer companion's orbit is circular and defines a fixed reference plane. Due to the axial symmetry of the time-averaged potential exerted by the outer body, the component of the inner orbit's specific angular momentum vector perpendicular to the outer orbit's plane is a conserved quantity.\n\nThe specific angular momentum of the inner orbit, $\\vec{L}_{\\mathrm{in}}$, has a magnitude given by:\n$$\n|\\vec{L}_{\\mathrm{in}}| = \\sqrt{G(M+m_{\\mathrm{in}})a_{\\mathrm{in}}(1-e^2)}\n$$\nwhere $G$ is the gravitational constant, $M$ is the stellar mass, $m_{\\mathrm{in}}$ is the inner planet's mass, $a_{\\mathrm{in}}$ is its semi-major axis, and $e$ is its eccentricity. As the planet's mass is negligible ($m_{\\mathrm{in}} \\approx 0$), this simplifies to $|\\vec{L}_{\\mathrm{in}}| = \\sqrt{GM a_{\\mathrm{in}}(1-e^2)}$.\n\nThe component of $\\vec{L}_{\\mathrm{in}}$ along the axis of symmetry (perpendicular to the outer orbit's plane), denoted $L_z$, is:\n$$\nL_z = |\\vec{L}_{\\mathrm{in}}| \\cos i = \\sqrt{GM a_{\\mathrm{in}}(1-e^2)} \\cos i\n$$\nwhere $i$ is the mutual inclination between the inner and outer orbital planes. In the secular approximation, the semi-major axis $a_{\\mathrm{in}}$ is also a constant of motion. Consequently, the quantity $(1-e^2)\\cos^2 i$ must be conserved. This gives us the foundational Kozai-Lidov integral of motion, $\\Theta$:\n$$\n\\Theta = (1-e^2)\\cos^2 i = \\text{constant}\n$$\nFor an inner orbit that is initially circular ($e_0 = 0$) with an initial inclination $i_0$, the value of this constant is fixed:\n$$\n\\Theta = (1-0^2)\\cos^2 i_0 = \\cos^2 i_0\n$$\nThus, throughout the secular evolution of the system, the eccentricity and inclination must satisfy:\n$$\n(1-e^2)\\cos^2 i = \\cos^2 i_0\n$$\nLarge eccentricity variations, characteristic of KL oscillations, are associated with the libration of the argument of pericenter, $\\omega$. The eccentricity $e$ reaches its maximum value, $e_{\\max}$, when the orbit's inclination $i$ reaches an extremum. This occurs when $\\omega = \\pi/2$ or $\\omega = 3\\pi/2$. At these points, the secular time derivative of the argument of pericenter, $d\\omega/dt$, is momentarily zero. The condition $d\\omega/dt = 0$ at $\\omega=\\pi/2$ (or $3\\pi/2$) under the quadrupole approximation leads to a specific value for the inclination, which we denote $i_{\\min}$:\n$$\n5\\cos^2 i_{\\min} - 3 = 0 \\implies \\cos^2 i_{\\min} = \\frac{3}{5}\n$$\nSubstituting this into the conservation law at the point of maximum eccentricity ($e=e_{\\max}$, $i=i_{\\min}$):\n$$\n(1-e_{\\max}^2)\\cos^2 i_{\\min} = \\cos^2 i_0\n$$\n$$\n(1-e_{\\max}^2) \\left(\\frac{3}{5}\\right) = \\cos^2 i_0\n$$\nSolving for $e_{\\max}^2$ yields:\n$$\n1-e_{\\max}^2 = \\frac{5}{3}\\cos^2 i_0 \\implies e_{\\max}^2 = 1 - \\frac{5}{3}\\cos^2 i_0\n$$\nThe maximum eccentricity is therefore:\n$$\ne_{\\max}(i_0) = \\sqrt{1 - \\frac{5}{3}\\cos^2 i_0}\n$$\nThis expression yields a real, non-negative value for $e_{\\max}$ only if the term under the square root is non-negative. This leads directly to the condition for KL oscillations to occur for an initially circular orbit:\n$$\n1 - \\frac{5}{3}\\cos^2 i_0 \\ge 0 \\implies \\cos^2 i_0 \\le \\frac{3}{5}\n$$\nIf this condition is not met (i.e., if $|\\cos i_0| > \\sqrt{3/5}$), the argument of pericenter circulates, and the eccentricity undergoes only small oscillations. In this regime, the maximum eccentricity is effectively zero, $e_{\\max}=0$. The critical inclinations are $i_{crit} = \\arccos(\\sqrt{3/5}) \\approx 39.2^\\circ$ and $\\pi - i_{crit} \\approx 140.8^\\circ$.\n\n### Derivation of the Probability $P(\\alpha, e_{\\mathrm{thr}})$\n\nWe are given the probability density function (PDF) for the initial inclination $i_0$ on the interval $i_0 \\in [0, \\pi]$:\n$$\nf(i;\\alpha) = C(\\alpha)\\,\\sin i\\,\\bigl(1 + \\alpha \\cos^2 i\\bigr)\n$$\nFirst, we find the normalization constant $C(\\alpha)$ by requiring $\\int_{0}^{\\pi} f(i;\\alpha)\\,di = 1$. We perform a change of variables with $u = \\cos i$, which gives $du = -\\sin i\\,di$. The integration limits change from $i \\in [0, \\pi]$ to $u \\in [1, -1]$.\n$$\n\\int_{0}^{\\pi} \\sin i\\,\\bigl(1 + \\alpha \\cos^2 i\\bigr) \\,di = \\int_{1}^{-1} (1+\\alpha u^2)(-du) = \\int_{-1}^{1} (1+\\alpha u^2)\\,du\n$$\n$$\n= \\left[ u + \\frac{\\alpha}{3}u^3 \\right]_{-1}^{1} = \\left(1 + \\frac{\\alpha}{3}\\right) - \\left(-1 - \\frac{\\alpha}{3}\\right) = 2 + \\frac{2\\alpha}{3} = \\frac{2(3+\\alpha)}{3}\n$$\nThe normalization constant is the reciprocal of this value:\n$$\nC(\\alpha) = \\frac{3}{2(3+\\alpha)}\n$$\nNext, we determine the set of inclinations for which the maximum eccentricity meets or exceeds a given threshold, $e_{\\max}(i_0) \\ge e_{\\mathrm{thr}}$.\n$$\n\\sqrt{1 - \\frac{5}{3}\\cos^2 i_0} \\ge e_{\\mathrm{thr}}\n$$\nSince both sides are non-negative for $e_{\\mathrm{thr}} \\in [0, 1]$, we can square them:\n$$\n1 - \\frac{5}{3}\\cos^2 i_0 \\ge e_{\\mathrm{thr}}^2 \\implies 1 - e_{\\mathrm{thr}}^2 \\ge \\frac{5}{3}\\cos^2 i_0 \\implies \\cos^2 i_0 \\le \\frac{3}{5}(1-e_{\\mathrm{thr}}^2)\n$$\nLet us define a critical value $z_{crit} = \\sqrt{\\frac{3}{5}(1-e_{\\mathrm{thr}}^2)}$. The condition becomes $|\\cos i_0| \\le z_{crit}$. This corresponds to an inclination range of $i_0 \\in [\\arccos(z_{crit}), \\pi - \\arccos(z_{crit})]$.\n\nThe probability $P(\\alpha, e_{\\mathrm{thr}})$ is the integral of the PDF over this range:\n$$\nP(\\alpha, e_{\\mathrm{thr}}) = \\int_{\\arccos(z_{crit})}^{\\pi-\\arccos(z_{crit})} C(\\alpha)\\,\\sin i\\,\\bigl(1 + \\alpha \\cos^2 i\\bigr)\\,di\n$$\nUsing the same substitution $u=\\cos i$, the integration limits for $u$ become $[\\cos(\\arccos(z_{crit})), \\cos(\\pi-\\arccos(z_{crit}))] = [z_{crit}, -z_{crit}]$.\n$$\nP(\\alpha, e_{\\mathrm{thr}}) = C(\\alpha) \\int_{z_{crit}}^{-z_{crit}} (1+\\alpha u^2)(-du) = C(\\alpha) \\int_{-z_{crit}}^{z_{crit}} (1+\\alpha u^2)\\,du\n$$\n$$\n= C(\\alpha) \\left[ u + \\frac{\\alpha}{3}u^3 \\right]_{-z_{crit}}^{z_{crit}} = C(\\alpha) \\left( 2z_{crit} + \\frac{2\\alpha}{3}z_{crit}^3 \\right) = 2C(\\alpha)z_{crit}\\left(1 + \\frac{\\alpha}{3}z_{crit}^2\\right)\n$$\nSubstituting the expressions for $C(\\alpha)$, $z_{crit}$, and $z_{crit}^2$:\n$$\nP(\\alpha, e_{\\mathrm{thr}}) = 2\\left(\\frac{3}{2(3+\\alpha)}\\right) \\sqrt{\\frac{3}{5}(1-e_{\\mathrm{thr}}^2)} \\left(1 + \\frac{\\alpha}{3}\\frac{3}{5}(1-e_{\\mathrm{thr}}^2)\\right)\n$$\n$$\nP(\\alpha, e_{\\mathrm{thr}}) = \\frac{3}{3+\\alpha} \\sqrt{\\frac{3}{5}(1-e_{\\mathrm{thr}}^2)} \\left(1 + \\frac{\\alpha}{5}(1-e_{\\mathrm{thr}}^2)\\right)\n$$\nThis is the final analytical expression for the desired probability. It is valid for $e_{\\mathrm{thr}} \\in [0, 1)$. For $e_{\\mathrm{thr}} \\ge 1$, we have $1-e_{\\mathrm{thr}}^2 \\le 0$, which makes $z_{crit}=0$ (or imaginary), and thus $P(\\alpha, e_{\\mathrm{thr}}) = 0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the probability P(alpha, e_thr) that a system with initial\n    inclination drawn from a given PDF will exceed a threshold eccentricity\n    due to Kozai-Lidov oscillations.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (alpha, e_thr)\n        (0.0, 0.0),\n        (0.0, 0.5),\n        (0.0, 0.99),\n        (-1.0, 0.0),\n        (5.0, 0.5),\n        (0.0, 1.0)\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha, e_thr = case\n\n        # The probability is zero if the threshold eccentricity is 1 or greater,\n        # as reaching e=1 requires a set of initial conditions of measure zero.\n        if e_thr >= 1.0:\n            prob = 0.0\n        else:\n            # The analytical formula derived from first principles is:\n            # P(alpha, e_thr) = (3 / (3 + alpha)) * z_crit * (1 + (alpha / 3) * z_crit^2)\n            # where z_crit^2 = (3/5) * (1 - e_thr^2)\n\n            e_thr_sq = e_thr**2\n            one_minus_e_thr_sq = 1.0 - e_thr_sq\n            \n            # The term (3/5)*(1-e_thr^2) appears in z_crit and z_crit^2\n            z_crit_sq_val = (3.0 / 5.0) * one_minus_e_thr_sq\n            z_crit_val = np.sqrt(z_crit_sq_val)\n\n            term1 = 3.0 / (3.0 + alpha)\n            term2 = 1.0 + (alpha / 5.0) * one_minus_e_thr_sq\n            \n            prob = term1 * z_crit_val * term2\n\n        results.append(prob)\n\n    # Format the output as a comma-separated list of floats rounded to\n    # six decimal places, enclosed in square brackets.\n    # The format specifier ensures trailing zeros, e.g., 0.0 -> 0.000000\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}