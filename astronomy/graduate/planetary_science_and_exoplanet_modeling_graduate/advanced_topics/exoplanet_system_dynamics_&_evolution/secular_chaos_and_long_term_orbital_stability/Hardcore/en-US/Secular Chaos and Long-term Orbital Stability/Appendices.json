{
    "hands_on_practices": [
        {
            "introduction": "To understand long-term orbital stability, we must first master the fundamentals of secular interactions. This practice grounds your understanding by guiding you through a first-principles calculation of the apsidal and nodal precession rates for a planet under the influence of a perturber . By starting from the orbit-averaged disturbing function and applying Lagrange's planetary equations, you will directly compute the fundamental frequencies that govern the slow dance of planetary orbits, providing a concrete foundation for the more complex dynamics of secular chaos.",
            "id": "4177250",
            "problem": "Consider a star of mass $M_{\\star}$ orbited by two planets with masses $m_{1}$ and $m_{2}$ and semi-major axes $a_{1}$ and $a_{2}$, where $a_{1} < a_{2}$. Assume both planets have low eccentricities ($e_{1}, e_{2} \\ll 1$) and low inclinations ($i_{1}, i_{2} \\ll 1$) relative to a fixed reference plane. Work in the regime of Newtonian gravity and use the secular, orbit-averaged disturbing function truncated at second order in eccentricities and inclinations and at leading nontrivial order in the mass ratios $m_{j}/M_{\\star}$ and the semi-major axis ratio $\\alpha \\equiv a_{1}/a_{2}$. Starting from the Lagrange planetary equations and the secularly averaged disturbing function (respecting the D’Alembert characteristics), derive the leading-order expressions for the apsidal and nodal precession rates of the inner planet, $\\dot{\\varpi}_{1}$ and $\\dot{\\Omega}_{1}$, and evaluate them.\n\nUse the following system parameters:\n- $M_{\\star} = 1.0\\,M_{\\odot}$,\n- $m_{1} = 3.0\\,M_{\\oplus}$, $m_{2} = 5.0\\,M_{\\oplus}$,\n- $a_{1} = 0.7\\,\\mathrm{AU}$, $a_{2} = 1.4\\,\\mathrm{AU}$.\n\nTreat the inner planet as a test particle for the purpose of computing its precession rates (i.e., neglect feedback on the outer planet to leading order). For the necessary Laplace coefficient, truncate $b_{3/2}^{(1)}(\\alpha)$ at order $\\alpha^{5}$ in its small-$\\alpha$ series. Compute the mean motion of the inner planet $n_{1}$ from first principles. Then, by explicitly evaluating the truncated series for $b_{3/2}^{(1)}(\\alpha)$ at the given $\\alpha$, compute the numerical values of the secular apsidal and nodal precession rates of the inner planet.\n\nScientific constants to use:\n- Gravitational constant $G = 6.67430 \\times 10^{-11}\\,\\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$,\n- Astronomical Unit $\\mathrm{AU} = 1.495978707 \\times 10^{11}\\,\\mathrm{m}$,\n- Solar mass $M_{\\odot} = 1.9885 \\times 10^{30}\\,\\mathrm{kg}$,\n- Earth mass $M_{\\oplus} = 5.9722 \\times 10^{24}\\,\\mathrm{kg}$.\n\nIn addition to the calculation, assess which coupling terms in the linearized secular theory dominate the precession of $\\varpi_{1}$ and $\\Omega_{1}$ at leading order, and justify your conclusion based on the structure of the averaged disturbing function.\n\nReport the final numerical pair $\\left(\\dot{\\varpi}_{1},\\,\\dot{\\Omega}_{1}\\right)$ in radians per second, and round your answer to four significant figures. Express the final pair as a single row matrix using the $\\mathrm{pmatrix}$ environment as described in the answer formatting rules.",
            "solution": "The long-term evolution of a planet's orbital orientation is governed by secular perturbations from other bodies in the system. The rates of change of the longitude of periapsis, $\\varpi$, and the longitude of the ascending node, $\\Omega$, can be derived from the orbit-averaged disturbing function, $\\langle R \\rangle$, using Lagrange's planetary equations. For an inner planet (planet $1$) perturbed by an outer planet (planet $2$) with low eccentricities and inclinations, the Lagrange equations for the precession rates are (to leading order in $e$ and $i$):\n$$ \\dot{\\varpi}_{1} = \\frac{1}{n_{1} a_{1}^{2} e_{1}} \\frac{\\partial \\langle R_{1} \\rangle}{\\partial e_{1}} $$\n$$ \\dot{\\Omega}_{1} = \\frac{1}{n_{1} a_{1}^{2} i_{1}} \\frac{\\partial \\langle R_{1} \\rangle}{\\partial i_{1}} $$\nwhere $n_{1}$ is the mean motion of planet $1$ and $\\langle R_{1} \\rangle$ is the disturbing function due to planet $2$ acting on planet $1$, averaged over both planets' orbits.\n\nThe secular disturbing function, truncated to second order in eccentricities and inclinations, contains terms proportional to $e_1^2$, $e_1 e_2 \\cos(\\varpi_1 - \\varpi_2)$, $i_1^2$, and $i_1 i_2 \\cos(\\Omega_1 - \\Omega_2)$. The leading-order, or \"diagonal,\" precession rates are derived from the terms proportional to $e_1^2$ and $i_1^2$, which represent the torque exerted by the averaged orbit of planet 2 on planet 1. This corresponds to the test particle approximation. Using the standard formulation derived from a Hamiltonian framework (as in Murray & Dermott, *Solar System Dynamics*), the leading-order apsidal and nodal precession rates are given by:\n$$ \\dot{\\varpi}_{1} = \\frac{n_{1}}{4} \\frac{m_{2}}{M_{\\star}} \\alpha b_{3/2}^{(1)}(\\alpha) $$\n$$ \\dot{\\Omega}_{1} = -\\frac{n_{1}}{4} \\frac{m_{2}}{M_{\\star}} \\alpha b_{3/2}^{(1)}(\\alpha) $$\nHere, $\\alpha = a_{1}/a_{2}$ and $b_{s}^{(j)}(\\alpha)$ are the Laplace coefficients. The relationship $\\dot{\\Omega}_{1} = -\\dot{\\varpi}_{1}$ is a hallmark of secular theory at this order of approximation. The dominant terms causing this precession are the diagonal terms in the secular Hamiltonian proportional to $e_{1}^{2}$ and $i_{1}^{2}$.\n\nNow, we compute the numerical values.\n1.  **System Parameters in SI units**:\n    - $M_{\\star} = 1.0 \\times (1.9885 \\times 10^{30}\\,\\mathrm{kg}) = 1.9885 \\times 10^{30}\\,\\mathrm{kg}$\n    - $m_{2} = 5.0 \\times (5.9722 \\times 10^{24}\\,\\mathrm{kg}) = 2.9861 \\times 10^{25}\\,\\mathrm{kg}$\n    - $a_{1} = 0.7 \\times (1.495978707 \\times 10^{11}\\,\\mathrm{m}) = 1.0471851 \\times 10^{11}\\,\\mathrm{m}$\n    - $G = 6.67430 \\times 10^{-11}\\,\\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$\n\n2.  **Semi-major axis ratio**:\n    - $\\alpha = a_{1}/a_{2} = 0.7/1.4 = 0.5$\n\n3.  **Laplace coefficient**: The series for $b_{3/2}^{(1)}(\\alpha)$ for small $\\alpha$ is truncated at $\\mathcal{O}(\\alpha^5)$.\n    $$ b_{3/2}^{(1)}(\\alpha) \\approx 3\\alpha + \\frac{45}{8}\\alpha^3 + \\frac{1575}{64}\\alpha^5 $$\n    Substituting $\\alpha = 0.5 = 1/2$:\n    $$ b_{3/2}^{(1)}(0.5) \\approx 3\\left(\\frac{1}{2}\\right) + \\frac{45}{8}\\left(\\frac{1}{2}\\right)^3 + \\frac{1575}{64}\\left(\\frac{1}{2}\\right)^5 $$\n    $$ b_{3/2}^{(1)}(0.5) \\approx \\frac{3}{2} + \\frac{45}{64} + \\frac{1575}{2048} = \\frac{3072 + 1440 + 1575}{2048} = \\frac{6087}{2048} \\approx 2.97216796875 $$\n\n4.  **Mean motion $n_{1}$**: We compute $n_{1}$ using $M_{\\star}$ alone, consistent with the leading-order approximation in the mass ratio $m_{2}/M_{\\star}$.\n    $$ n_{1} = \\sqrt{\\frac{G M_{\\star}}{a_{1}^{3}}} = \\sqrt{\\frac{(6.67430 \\times 10^{-11})(1.9885 \\times 10^{30})}{(1.0471851 \\times 10^{11})^{3}}} $$\n    $$ n_{1} = \\sqrt{\\frac{1.3271708 \\times 10^{20}}{1.148281 \\times 10^{33}}} = \\sqrt{1.1557835 \\times 10^{-13}}\\,\\mathrm{s^{-1}} $$\n    $$ n_{1} \\approx 3.3996816 \\times 10^{-7}\\,\\mathrm{rad\\,s^{-1}} $$\n\n5.  **Precession rates calculation**:\n    - Mass ratio: $\\frac{m_{2}}{M_{\\star}} = \\frac{2.9861 \\times 10^{25}}{1.9885 \\times 10^{30}} \\approx 1.501684 \\times 10^{-5}$\n    - Apsidal precession rate $\\dot{\\varpi}_{1}$:\n    $$ \\dot{\\varpi}_{1} = \\frac{n_{1}}{4} \\frac{m_{2}}{M_{\\star}} \\alpha b_{3/2}^{(1)}(\\alpha) $$\n    $$ \\dot{\\varpi}_{1} \\approx \\frac{3.3996816 \\times 10^{-7}}{4} (1.501684 \\times 10^{-5})(0.5)(2.972168) $$\n    $$ \\dot{\\varpi}_{1} \\approx (8.499204 \\times 10^{-8}) (1.501684 \\times 10^{-5}) (1.486084) $$\n    $$ \\dot{\\varpi}_{1} \\approx 1.89593 \\times 10^{-12}\\,\\mathrm{rad\\,s^{-1}} $$\n    - Nodal precession rate $\\dot{\\Omega}_{1}$:\n    $$ \\dot{\\Omega}_{1} = -\\dot{\\varpi}_{1} \\approx -1.89593 \\times 10^{-12}\\,\\mathrm{rad\\,s^{-1}} $$\n\nRounding the results to four significant figures, we get:\n$$ \\dot{\\varpi}_{1} \\approx 1.896 \\times 10^{-12}\\,\\mathrm{rad\\,s^{-1}} $$\n$$ \\dot{\\Omega}_{1} \\approx -1.896 \\times 10^{-12}\\,\\mathrm{rad\\,s^{-1}} $$\n\nThe final answer is the pair $(\\dot{\\varpi}_{1}, \\dot{\\Omega}_{1})$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1.896 \\times 10^{-12} & -1.896 \\times 10^{-12} \\end{pmatrix} } $$"
        },
        {
            "introduction": "While individual precession rates are foundational, chaos arises from the interaction between multiple modes of the system. This exercise challenges you to identify the \"seeds of chaos\" by finding the conditions for secular resonance, where the natural precession frequencies of two planets become degenerate . By deriving the critical spacing at which this occurs, you will learn how the architecture of a planetary system dictates its stability, revealing the precise configurations where weak nonlinearities can be amplified into large-scale chaotic motion.",
            "id": "4177185",
            "problem": "Consider a coplanar three-planet system orbiting a star of mass $M_{\\star}$. The planets have masses $m_{1}$, $m_{2}$, and $m_{3}$, and their semimajor axes are in a geometric progression $a_{1}=a$, $a_{2}=s\\,a$, and $a_{3}=s^{2}a$ with spacing ratio $s>1$. All eccentricities are small and the dynamics are dominated by Newtonian gravity.\n\nWork in the linear, planar secular approximation (Laplace–Lagrange secular theory) at leading order in eccentricities and leading order in the semimajor axis ratios $\\alpha_{12}=a_{1}/a_{2}=1/s$ and $\\alpha_{23}=a_{2}/a_{3}=1/s$. Assume that direct coupling between the inner and outer planets ($1$ and $3$) can be neglected at this order. Use the leading nontrivial terms in the small-$\\alpha$ expansions of the relevant Laplace coefficients. Treat the off-diagonal couplings as higher order when identifying the locations of secular eigenfrequency degeneracies, but do not invoke any shortcut formulas that bypass a first-principles derivation from the disturbing function.\n\nTasks:\n- Starting from Newtonian gravity and the expansion of the disturbing function to second order in eccentricities, set up the linear secular system and obtain the diagonal elements of the precession matrix in terms of $n_{i}$, $m_{j}/M_{\\star}$, and the Laplace coefficients. Then use the small-$\\alpha$ expansions to obtain leading-order expressions for the diagonal secular eigenfrequencies $g_{1}$, $g_{2}$, and $g_{3}$ in terms of $m_{1}$, $m_{2}$, $m_{3}$, $M_{\\star}$, $a$, and $s$.\n- Using these leading-order expressions, equate $g_{1}$ and $g_{2}$ to obtain the critical spacing ratio $s_{\\mathrm{crit}}$ at which the two low-order apsidal secular eigenfrequencies become degenerate. This crossing signals the locus where, in the presence of weak nonlinearities and three degrees of freedom, secular resonance overlap and thus secular chaos can first arise.\n- Provide your final result for $s_{\\mathrm{crit}}$ as a single closed-form analytic expression in terms of $m_{1}$, $m_{2}$, and $m_{3}$ only. No numerical evaluation is required.\n\nExpress your final answer as a closed-form expression with no units. If you choose to simplify radicals or powers, do so exactly; do not approximate.",
            "solution": "To find the critical spacing ratio $s_{\\mathrm{crit}}$ for secular resonance, we analyze the system within the framework of linear, planar Laplace-Lagrange secular theory.\n\nThe secular evolution of the eccentricity vectors, described by the complex variables $z_j = e_j \\exp(i\\varpi_j)$, is governed by the linear system:\n$$ \\frac{dz_j}{dt} = i \\sum_{k=1}^{3} A_{jk} z_k $$\nThe matrix $A$ contains the secular precession frequencies. Its eigenvalues are the secular eigenfrequencies, $g_j$. We can approximate these eigenfrequencies by the diagonal elements of the precession matrix, $g_j \\approx A_{jj}$, which is a valid approximation when off-diagonal elements are of a higher order in the expansion parameter $\\alpha=1/s$.\n\nThe diagonal elements $A_{jj}$ represent the precession rate of planet $j$ due to the orbit-averaged gravitational potential of all other planets in the system. The contribution to the precession rate of planet $j$ from planet $k$ is given by:\n- For an outer perturber $k$ on an inner planet $j$ ($a_j < a_k$):\n$$ A_{j \\leftarrow k} = \\frac{n_j}{4} \\frac{m_k}{M_{\\star}} \\alpha_{jk} b_{3/2}^{(1)}(\\alpha_{jk}) $$\n- For an inner perturber $k$ on an outer planet $j$ ($a_j > a_k$):\n$$ A_{j \\leftarrow k} = \\frac{n_j}{4} \\frac{m_k}{M_{\\star}} \\alpha_{kj} b_{3/2}^{(1)}(\\alpha_{kj}) $$\nHere, $n_j = \\sqrt{G M_{\\star} / a_j^3}$ is the mean motion of planet $j$ and $\\alpha_{jk} = a_j/a_k < 1$.\n\nThe system is defined by $a_1=a$, $a_2=sa$, $a_3=s^2a$, with adjacent semimajor axis ratios $\\alpha_{12} = \\alpha_{23} = 1/s$. The mean motions are related by $n_2 = n_1 s^{-3/2}$ and $n_3 = n_1 s^{-3}$. Neglecting the direct 1-3 coupling, the total diagonal precession rates are:\n- For planet 1 (perturbed by 2): $A_{11} = A_{1 \\leftarrow 2}$\n- For planet 2 (perturbed by 1 and 3): $A_{22} = A_{2 \\leftarrow 1} + A_{2 \\leftarrow 3}$\n- For planet 3 (perturbed by 2): $A_{33} = A_{3 \\leftarrow 2}$\n\nUsing the leading nontrivial term in the small-$\\alpha$ expansion, $b_{3/2}^{(1)}(\\alpha) \\approx 3\\alpha$, we substitute $\\alpha=1/s$ to find the eigenfrequencies. Let $n_a = \\sqrt{GM_\\star/a^3} = n_1$.\n$$ g_1 \\approx A_{11} \\approx \\frac{n_1}{4} \\frac{m_2}{M_{\\star}} \\frac{1}{s} \\left(\\frac{3}{s}\\right) = \\frac{3 n_a}{4s^2} \\frac{m_2}{M_{\\star}} $$\n$$ g_2 \\approx A_{22} \\approx \\frac{n_2}{4s} \\left(\\frac{3}{s}\\right) \\frac{m_1+m_3}{M_{\\star}} = \\frac{3 n_a s^{-3/2}}{4s^2} \\frac{m_1+m_3}{M_{\\star}} = \\frac{3 n_a}{4s^{7/2}} \\frac{m_1+m_3}{M_{\\star}} $$\n\nA secular resonance crossing occurs when two eigenfrequencies are degenerate. We set $g_1 = g_2$ to find the critical spacing ratio $s_{\\mathrm{crit}}$:\n$$ \\frac{3 n_a}{4s_{\\mathrm{crit}}^2} \\frac{m_2}{M_{\\star}} = \\frac{3 n_a}{4s_{\\mathrm{crit}}^{7/2}} \\frac{m_1+m_3}{M_{\\star}} $$\nCanceling common factors yields:\n$$ \\frac{m_2}{s_{\\mathrm{crit}}^2} = \\frac{m_1+m_3}{s_{\\mathrm{crit}}^{7/2}} $$\nSolving for $s_{\\mathrm{crit}}$:\n$$ s_{\\mathrm{crit}}^{7/2 - 2} = s_{\\mathrm{crit}}^{3/2} = \\frac{m_1+m_3}{m_2} $$\nRaising both sides to the power of $2/3$ gives the final expression:\n$$ s_{\\mathrm{crit}} = \\left( \\frac{m_1+m_3}{m_2} \\right)^{2/3} $$",
            "answer": "$$\\boxed{\\left( \\frac{m_1+m_3}{m_2} \\right)^{2/3}}$$"
        },
        {
            "introduction": "Planetary systems are not static; they evolve over billion-year timescales due to processes like disk migration. This computational practice explores the dynamic consequences of such evolution by modeling a system as it is driven across a secular resonance . You will apply the powerful Landau-Zener formula, borrowed from quantum mechanics, to quantify the outcome of the resonance crossing and use a modern chaos criterion to assess whether the event triggers instability. This exercise bridges the gap between linear theory and nonlinear dynamics, providing a practical tool for diagnosing the stability of evolving planetary systems.",
            "id": "4177214",
            "problem": "Consider a pair of coupled secular eccentricity modes described in the linearized Laplace–Lagrange framework for two planets. Let the complex eccentricity vector be $z(t) = (z_1(t), z_2(t))^{\\mathsf{T}}$, and let the secular evolution be governed by\n$$\n\\frac{d}{dt} z(t) = i\\,A(t)\\,z(t),\n$$\nwhere $A(t)$ is a real, symmetric $2\\times 2$ matrix that varies slowly in time because of a slow change of the semimajor axes $a_i(t)$. Near a single isolated $g$-resonance crossing between two modes, after moving to a rotating frame that removes the common precession rate, one can reduce $A(t)$ to the standard near-resonant form\n$$\nA(t) \\approx \\begin{pmatrix}\n\\Delta(t)/2 & C \\\\\nC & -\\Delta(t)/2\n\\end{pmatrix},\n$$\nwhere $\\Delta(t) = g_1(t) - g_2(t)$ is the detuning and $C$ is a constant coupling coefficient. Assume a linear resonance sweep $\\Delta(t) = \\alpha\\,t$ with $\\alpha > 0$, which corresponds to a monotonic slow migration of $a_i(t)$ that carries the system through the resonance at $t=0$. At $t\\to -\\infty$ the system is prepared in the diabatic basis $z(-\\infty) = (E_0,\\,0)^{\\mathsf{T}}$, where $E_0$ is the initial eccentricity amplitude of the first mode.\n\nYour tasks are:\n\n1. Starting from the fundamental linear system above and using only well-tested principles for slowly varying linear coupled oscillators, derive the fraction of amplitude that remains in the initial diabatic mode after the resonance crossing as $t\\to +\\infty$. Express your answer in terms of the sweep rate $\\alpha$ and coupling $C$. Then express the post-crossing amplitudes $e_1^+ = |z_1(+\\infty)|$ and $e_2^+ = |z_2(+\\infty)|$ in terms of the initial amplitude $E_0$ and the derived fraction.\n\n2. To evaluate whether the resonance crossing can induce secular chaos in the broader multi-mode system, adopt the following physically motivated and widely used resonance overlap criterion (Chirikov-style). Let $\\Delta g_{\\mathrm{nn}}$ be the separation to the nearest other secular frequency (not involved in the crossing), and let $W_{\\mathrm{nn}}$ be the effective half-width of that neighboring resonance. Let the nonlinear self-precession shift of the relevant mode scale as $\\delta\\omega \\approx \\beta\\,e^2$ (with coefficient $\\beta$), where $e$ is a characteristic eccentricity amplitude after crossing. Define a local effective width for the present resonance by $W_{\\mathrm{loc}} \\equiv 2C$. Declare the system as chaotic if\n$$\n\\delta\\omega + W_{\\mathrm{loc}} + W_{\\mathrm{nn}} \\ge \\Delta g_{\\mathrm{nn}}.\n$$\nFor concreteness, take $e \\equiv \\max(e_1^+, e_2^+)$.\n\n3. Implement a program that, for each test case in the suite provided below, computes: the post-crossing stay fraction in the initial diabatic mode, the post-crossing amplitudes $e_1^+$ and $e_2^+$, and a boolean flag indicating whether the above inequality is satisfied. All frequencies and couplings must be treated in units of $\\mathrm{rad}\\,\\mathrm{yr}^{-1}$, all sweep rates in $\\mathrm{rad}\\,\\mathrm{yr}^{-2}$, and time in $\\mathrm{yr}$. Eccentricities are dimensionless. The boolean should be reported as the programming-language boolean literal. No angles are required.\n\nTest suite (each tuple is $(C, \\alpha, E_0, \\beta, \\Delta g_{\\mathrm{nn}}, W_{\\mathrm{nn}})$):\n- Case A: $C = 5\\times 10^{-6}\\,\\mathrm{yr}^{-1}$, $\\alpha = 1\\times 10^{-11}\\,\\mathrm{yr}^{-2}$, $E_0 = 2\\times 10^{-2}$, $\\beta = 3\\times 10^{-3}\\,\\mathrm{yr}^{-1}$, $\\Delta g_{\\mathrm{nn}} = 2.5\\times 10^{-5}\\,\\mathrm{yr}^{-1}$, $W_{\\mathrm{nn}} = 5\\times 10^{-6}\\,\\mathrm{yr}^{-1}$.\n- Case B: $C = 8\\times 10^{-6}\\,\\mathrm{yr}^{-1}$, $\\alpha = 5\\times 10^{-12}\\,\\mathrm{yr}^{-2}$, $E_0 = 5\\times 10^{-2}$, $\\beta = 1\\times 10^{-2}\\,\\mathrm{yr}^{-1}$, $\\Delta g_{\\mathrm{nn}} = 3.5\\times 10^{-5}\\,\\mathrm{yr}^{-1}$, $W_{\\mathrm{nn}} = 5\\times 10^{-6}\\,\\mathrm{yr}^{-1}$.\n- Case C: $C = 5\\times 10^{-6}\\,\\mathrm{yr}^{-1}$, $\\alpha = 1\\times 10^{-8}\\,\\mathrm{yr}^{-2}$, $E_0 = 3\\times 10^{-2}$, $\\beta = 1\\times 10^{-3}\\,\\mathrm{yr}^{-1}$, $\\Delta g_{\\mathrm{nn}} = 3\\times 10^{-5}\\,\\mathrm{yr}^{-1}$, $W_{\\mathrm{nn}} = 5\\times 10^{-6}\\,\\mathrm{yr}^{-1}$.\n- Case D: $C = 6\\times 10^{-6}\\,\\mathrm{yr}^{-1}$, $\\alpha = 8\\times 10^{-12}\\,\\mathrm{yr}^{-2}$, $E_0 = 4\\times 10^{-2}$, $\\beta = 7\\times 10^{-3}\\,\\mathrm{yr}^{-1}$, $\\Delta g_{\\mathrm{nn}} = 2.62\\times 10^{-5}\\,\\mathrm{yr}^{-1}$, $W_{\\mathrm{nn}} = 3\\times 10^{-6}\\,\\mathrm{yr}^{-1}$.\n\nRequired final output format:\nYour program should produce a single line of output containing a list of per-case results, each itself a list of four entries in the order $\\big[$stay-fraction, $e_1^+$, $e_2^+$, chaos-flag$\\big]$. The overall output must be a single list enclosing all cases, for example $[[\\ldots],[\\ldots],[\\ldots],[\\ldots]]$. The stay-fraction and amplitudes must be real numbers, and the chaos-flag must be a boolean literal. No additional text should be printed.",
            "solution": "The solution involves two main steps: first, deriving the post-crossing amplitudes using the Landau-Zener formula, and second, applying the provided chaos criterion.\n\n**1. Post-Crossing Amplitudes via Landau-Zener Theory**\n\nThe governing system of equations is mathematically equivalent to the Landau-Zener problem in quantum mechanics. For a system starting in one diabatic state that sweeps through a resonance, the fraction of the initial power (squared amplitude) that remains in the same diabatic state after the crossing is given by the Landau-Zener probability:\n$$\nf_{\\text{stay}} = P_{\\text{LZ}} = \\exp\\left( - \\frac{2\\pi C^2}{\\alpha} \\right)\n$$\nHere, $C$ is the coupling coefficient and $\\alpha$ is the sweep rate of the frequency detuning.\n\nSince the total squared amplitude is conserved during the evolution ($|z_1(t)|^2 + |z_2(t)|^2 = E_0^2$), the post-crossing amplitudes $e_1^+ = |z_1(+\\infty)|$ and $e_2^+ = |z_2(+\\infty)|$ are:\n$$\n(e_1^+)^2 = E_0^2 f_{\\text{stay}} \\implies e_1^+ = E_0 \\sqrt{f_{\\text{stay}}}\n$$\n$$\n(e_2^+)^2 = E_0^2 (1 - f_{\\text{stay}}) \\implies e_2^+ = E_0 \\sqrt{1 - f_{\\text{stay}}}\n$$\n\n**2. Application of the Chaos Criterion**\n\nThe problem provides a Chirikov-style resonance overlap criterion to assess chaos:\n$$\n\\delta\\omega + W_{\\mathrm{loc}} + W_{\\mathrm{nn}} \\ge \\Delta g_{\\mathrm{nn}}\n$$\nWe compute the terms on the left-hand side for each test case:\n- The characteristic eccentricity is $e = \\max(e_1^+, e_2^+)$.\n- The nonlinear frequency shift is $\\delta\\omega = \\beta e^2$.\n- The local resonance width is $W_{\\mathrm{loc}} = 2C$.\n\nThe boolean chaos flag is determined by evaluating the inequality $(\\beta e^2 + 2C + W_{\\mathrm{nn}}) \\ge \\Delta g_{\\mathrm{nn}}$ with the computed values and given parameters.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the secular resonance crossing problem for a suite of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (C, alpha, E0, beta, delta_g_nn, W_nn).\n    # Units: C (rad/yr), alpha (rad/yr^2), E0 (dimless), beta (rad/yr),\n    # delta_g_nn (rad/yr), W_nn (rad/yr).\n    test_cases = [\n        # Case A\n        (5e-6, 1e-11, 2e-2, 3e-3, 2.5e-5, 5e-6),\n        # Case B\n        (8e-6, 5e-12, 5e-2, 1e-2, 3.5e-5, 5e-6),\n        # Case C\n        (5e-6, 1e-8, 3e-2, 1e-3, 3e-5, 5e-6),\n        # Case D\n        (6e-6, 8e-12, 4e-2, 7e-3, 2.62e-5, 3e-6),\n    ]\n\n    results = []\n    for case in test_cases:\n        C, alpha, E0, beta, delta_g_nn, W_nn = case\n\n        # Part 1: Calculate post-crossing amplitudes using Landau-Zener theory.\n\n        # The fraction of squared amplitude remaining in the initial diabatic mode is\n        # given by the Landau-Zener non-adiabatic transition probability.\n        # f_stay = P_LZ = exp(-2 * pi * C^2 / alpha)\n        exponent = -2.0 * np.pi * (C**2) / alpha\n        f_stay = np.exp(exponent)\n\n        # The total squared amplitude |z1|^2 + |z2|^2 is conserved and equals E0^2.\n        # e1_plus = |z1(+\\infty)|, e2_plus = |z2(+\\infty)|\n        # (e1_plus)^2 = E0^2 * f_stay\n        # (e2_plus)^2 = E0^2 * (1 - f_stay)\n        e1_plus = E0 * np.sqrt(f_stay)\n        e2_plus = E0 * np.sqrt(1.0 - f_stay)\n\n        # Part 2: Apply the resonance overlap criterion for chaos.\n        # Criterion: delta_omega + W_loc + W_nn >= delta_g_nn\n\n        # Local resonance width\n        W_loc = 2.0 * C\n\n        # Characteristic eccentricity for nonlinear frequency shift\n        e_char = max(e1_plus, e2_plus)\n\n        # Nonlinear frequency shift\n        delta_omega = beta * e_char**2\n\n        # Evaluate the inequality\n        is_chaotic = (delta_omega + W_loc + W_nn) >= delta_g_nn\n\n        # Store the results for this case\n        results.append([f_stay, e1_plus, e2_plus, is_chaotic])\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, e.g., [[...], [...], ...].\n    # To achieve this, we convert each inner list to its string representation.\n    formatted_results = [f\"[{res[0]},{res[1]},{res[2]},{str(res[3]).lower()}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}