{
    "hands_on_practices": [
        {
            "introduction": "Population synthesis models are constructed upon the foundational physics of planet-forming environments. The evolution of the protoplanetary gas disk is a primary driver, governed by the viscous transport of angular momentum, which sets the timescale for gas dispersal. In this exercise (), you will perform a first-principles calculation of the viscous timescale, $t_{\\nu}$, a critical parameter that dictates the lifetime of the disk and thus the window of opportunity for giant planet formation. This practice connects fundamental disk properties like the turbulence parameter $\\alpha$, temperature $T$, and metallicity $Z$ to a key evolutionary timescale.",
            "id": "4172848",
            "problem": "Consider a population synthesis model of planet-forming protoplanetary disks in which angular momentum transport is described by the Shakura–Sunyaev parameterization with kinematic viscosity $\\nu = \\alpha c_{s} H$. Assume a geometrically thin, vertically isothermal, Keplerian disk around a star of mass $ M_{\\star} $, with vertical hydrostatic equilibrium $ H = c_{s}/\\Omega_{K} $ and Keplerian angular frequency $ \\Omega_{K} = \\sqrt{ G M_{\\star} / R^{3} } $. The sound speed is $ c_{s} = \\sqrt{ k_{B} T / (\\mu m_{p}) } $, where $ \\mu $ is the mean molecular weight and $ m_{p} $ is the proton mass.\n\nAdopt an irradiation-dominated, optically thick midplane temperature profile in which dust opacity sets the optical depth. Let the monochromatic dust opacity scale linearly with bulk metallicity $ Z $, so that the vertical optical depth $ \\tau \\propto \\kappa \\Sigma \\propto Z $ at fixed surface density $ \\Sigma $. Using the classical optically thick relation $ T_{\\mathrm{mid}}^{4} \\propto \\tau\\, T_{\\mathrm{eff}}^{4} $ together with $ T_{\\mathrm{eff}}(R) \\propto R^{-1/2} $ for a flared, passively irradiated disk, take the fiducial midplane temperature profile\n$$\nT(R,Z) = T_{0}\\left( \\frac{Z}{Z_{\\odot}} \\right)^{1/4} \\left( \\frac{R}{R_{0}} \\right)^{-1/2},\n$$\nwith $ T_{0} = 280\\,\\mathrm{K} $ at $ R_{0} = 1\\,\\mathrm{AU} $ for a solar-mass star. Use $ \\alpha = 10^{-3} $, $ \\mu = 2.34 $, and $ M_{\\star} = M_{\\odot} $.\n\nStarting from the definitions above and fundamental relations, derive an explicit analytic expression for the viscous diffusion timescale at radius $ R $,\n$$\nt_{\\nu}(R,Z) \\equiv \\frac{R^{2}}{\\nu},\n$$\nsimplified to a single closed-form expression evaluated at $ R = 10\\,\\mathrm{AU} $ as a function of $ Z $ normalized to $ Z_{\\odot} $. Use $ G = 6.67430 \\times 10^{-11}\\,\\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}} $, $ k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}} $, $ m_{p} = 1.6726219 \\times 10^{-27}\\,\\mathrm{kg} $, $ M_{\\odot} = 1.98847 \\times 10^{30}\\,\\mathrm{kg} $, $ 1\\,\\mathrm{AU} = 1.495978707 \\times 10^{11}\\,\\mathrm{m} $, and $ 1\\,\\mathrm{yr} = 3.15576 \\times 10^{7}\\,\\mathrm{s} $. Express the final timescale in years and round the multiplicative prefactor to three significant figures. In addition, your derivation must make clear how $ t_{\\nu} $ scales with $ Z $ through $ c_{s} $ and the opacity-informed temperature profile.",
            "solution": "The problem asks for the derivation of the viscous diffusion timescale, $t_{\\nu}$, in a protoplanetary disk, and its evaluation at a specific radius as a function of metallicity. The derivation proceeds by combining the fundamental definitions provided.\n\nThe viscous diffusion timescale at a radius $R$ is defined as:\n$$\nt_{\\nu} \\equiv \\frac{R^{2}}{\\nu}\n$$\nwhere $\\nu$ is the kinematic viscosity.\n\nThe problem specifies the Shakura–Sunyaev parameterization for viscosity, $\\nu = \\alpha c_{s} H$, where $\\alpha$ is a dimensionless parameter, $c_s$ is the local sound speed, and $H$ is the vertical pressure scale height of the disk.\n\nFor a disk in vertical hydrostatic equilibrium, the scale height is related to the sound speed and the Keplerian angular frequency, $\\Omega_K$, by $H = c_{s}/\\Omega_{K}$. Substituting this into the expression for $\\nu$ yields:\n$$\n\\nu = \\alpha c_{s} \\left(\\frac{c_{s}}{\\Omega_{K}}\\right) = \\frac{\\alpha c_{s}^{2}}{\\Omega_{K}}\n$$\nSubstituting this expression for $\\nu$ back into the definition of the viscous timescale gives:\n$$\nt_{\\nu} = \\frac{R^{2}}{\\left(\\frac{\\alpha c_{s}^{2}}{\\Omega_{K}}\\right)} = \\frac{R^{2} \\Omega_{K}}{\\alpha c_{s}^{2}}\n$$\nThis expression shows that the viscous timescale is inversely proportional to the viscosity, which in turn is proportional to the square of the sound speed, $c_s^2$.\n\nNext, we substitute the expressions for the Keplerian angular frequency, $\\Omega_{K} = \\sqrt{G M_{\\star} / R^{3}}$, and the sound speed, $c_{s} = \\sqrt{k_{B} T / (\\mu m_{p})}$, which implies $c_{s}^{2} = k_{B} T / (\\mu m_{p})$. Here, $G$ is the gravitational constant, $M_{\\star}$ is the stellar mass, $k_B$ is the Boltzmann constant, $T$ is the midplane temperature, $\\mu$ is the mean molecular weight, and $m_p$ is the proton mass.\n\nThe substitution yields:\n$$\nt_{\\nu} = \\frac{R^{2} \\sqrt{G M_{\\star} / R^{3}}}{\\alpha \\left( \\frac{k_{B} T}{\\mu m_{p}} \\right)} = \\frac{R^{2} (G M_{\\star})^{1/2} R^{-3/2}}{\\alpha k_{B} T / (\\mu m_{p})}\n$$\nSimplifying the powers of $R$ and rearranging gives the timescale as a function of radius $R$ and temperature $T$:\n$$\nt_{\\nu}(R,T) = \\frac{(G M_{\\star})^{1/2} R^{1/2} \\mu m_{p}}{\\alpha k_{B} T}\n$$\nThe problem provides a specific temperature profile that depends on both radius $R$ and metallicity $Z$:\n$$\nT(R,Z) = T_{0}\\left( \\frac{Z}{Z_{\\odot}} \\right)^{1/4} \\left( \\frac{R}{R_{0}} \\right)^{-1/2}\n$$\nThis temperature profile is physically motivated. The dependence $T \\propto Z^{1/4}$ arises from the radiative transfer in an optically thick medium, where the midplane temperature $T_{\\mathrm{mid}}$ is related to the effective temperature $T_{\\mathrm{eff}}$ and vertical optical depth $\\tau$ by $T_{\\mathrm{mid}}^{4} \\propto \\tau T_{\\mathrm{eff}}^{4}$. With dust opacity being the dominant source, and assuming it scales linearly with metallicity, we have $\\tau \\propto Z$, leading to $T_{\\mathrm{mid}} \\propto Z^{1/4}$.\n\nSubstituting this temperature profile into our expression for $t_{\\nu}$:\n$$\nt_{\\nu}(R,Z) = \\frac{(G M_{\\star})^{1/2} R^{1/2} \\mu m_{p}}{\\alpha k_{B} \\left[ T_{0}\\left( \\frac{Z}{Z_{\\odot}} \\right)^{1/4} \\left( \\frac{R}{R_{0}} \\right)^{-1/2} \\right]}\n$$\nWe can now separate the variables and constants. The scaling with metallicity $Z$ is made explicit:\n$$\nt_{\\nu} \\propto \\frac{1}{T} \\propto \\frac{1}{(Z/Z_{\\odot})^{1/4}} = \\left(\\frac{Z}{Z_{\\odot}}\\right)^{-1/4}\n$$\nA higher metallicity leads to a hotter disk, a higher viscosity, and thus a shorter viscous timescale.\n\nTo find the radial dependence, we group the terms involving $R$:\n$$\n\\frac{R^{1/2}}{\\left( \\frac{R}{R_{0}} \\right)^{-1/2}} = \\frac{R^{1/2}}{R^{-1/2} R_{0}^{1/2}} = R^{(1/2 - (-1/2))} R_{0}^{-1/2} = \\frac{R}{R_{0}^{1/2}}\n$$\nThe full analytical expression for the viscous timescale is therefore:\n$$\nt_{\\nu}(R,Z) = \\frac{(G M_{\\star})^{1/2} \\mu m_{p}}{\\alpha k_{B} T_{0} R_{0}^{1/2}} \\cdot R \\cdot \\left( \\frac{Z}{Z_{\\odot}} \\right)^{-1/4}\n$$\nThis shows that for the given temperature profile, the viscous timescale scales linearly with radius, $t_{\\nu} \\propto R$.\n\nTo obtain the final expression, we evaluate the constant prefactor using the provided values, all in SI units:\n$M_{\\star} = M_{\\odot} = 1.98847 \\times 10^{30}\\,\\mathrm{kg}$\n$G = 6.67430 \\times 10^{-11}\\,\\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$\n$\\mu = 2.34$\n$m_{p} = 1.6726219 \\times 10^{-27}\\,\\mathrm{kg}$\n$\\alpha = 10^{-3}$\n$k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$\n$T_{0} = 280\\,\\mathrm{K}$\n$R_{0} = 1\\,\\mathrm{AU} = 1.495978707 \\times 10^{11}\\,\\mathrm{m}$\n\nThe prefactor is $C = \\frac{(G M_{\\star})^{1/2} \\mu m_{p}}{\\alpha k_{B} T_{0} R_{0}^{1/2}}$.\nNumerator: $(G M_{\\star})^{1/2} \\mu m_{p} \\approx (1.32712 \\times 10^{20})^{1/2} \\cdot (2.34) \\cdot (1.67262 \\times 10^{-27}) \\approx 1.4263 \\times 10^{-16}\\,\\mathrm{kg\\,m^{1.5}\\,s^{-1}}$.\nDenominator: $\\alpha k_{B} T_{0} R_{0}^{1/2} \\approx (10^{-3}) \\cdot (1.38065 \\times 10^{-23}) \\cdot (280) \\cdot (1.49598 \\times 10^{11})^{1/2} \\approx 1.4942 \\times 10^{-18}\\,\\mathrm{kg\\,m^{2.5}\\,s^{-2}}$.\n$C \\approx \\frac{1.4263 \\times 10^{-16}}{1.4942 \\times 10^{-18}} \\approx 95.455\\,\\mathrm{s\\,m^{-1}}$.\n\nSo, $t_{\\nu}(R,Z) \\approx 95.455 \\cdot R \\cdot \\left( \\frac{Z}{Z_{\\odot}} \\right)^{-1/4}$, with $R$ in meters and $t_{\\nu}$ in seconds.\n\nThe problem requires evaluation at $R = 10\\,\\mathrm{AU}$:\n$R = 10 \\times 1.495978707 \\times 10^{11}\\,\\mathrm{m} = 1.495978707 \\times 10^{12}\\,\\mathrm{m}$.\n$$\nt_{\\nu}(10\\,\\mathrm{AU}, Z) \\approx (95.455\\,\\mathrm{s\\,m^{-1}}) \\cdot (1.495978707 \\times 10^{12}\\,\\mathrm{m}) \\cdot \\left( \\frac{Z}{Z_{\\odot}} \\right)^{-1/4}\n$$\n$$\nt_{\\nu}(10\\,\\mathrm{AU}, Z) \\approx 1.4279 \\times 10^{14}\\,\\mathrm{s} \\cdot \\left( \\frac{Z}{Z_{\\odot}} \\right)^{-1/4}\n$$\nTo express this in years, we use the conversion $1\\,\\mathrm{yr} = 3.15576 \\times 10^{7}\\,\\mathrm{s}$:\n$$\nt_{\\nu, \\mathrm{yr}} \\approx \\frac{1.4279 \\times 10^{14}}{3.15576 \\times 10^{7}} \\, \\mathrm{yr} \\cdot \\left( \\frac{Z}{Z_{\\odot}} \\right)^{-1/4}\n$$\n$$\nt_{\\nu, \\mathrm{yr}} \\approx 4.5247 \\times 10^{6} \\, \\mathrm{yr} \\cdot \\left( \\frac{Z}{Z_{\\odot}} \\right)^{-1/4}\n$$\nRounding the multiplicative prefactor to three significant figures gives $4.52 \\times 10^{6}$.\nThe final expression for the viscous timescale at $R=10\\,\\mathrm{AU}$ in years is:\n$$\nt_{\\nu}(10\\,\\mathrm{AU}, Z) = 4.52 \\times 10^{6} \\left( \\frac{Z}{Z_{\\odot}} \\right)^{-1/4} \\text{ years}\n$$",
            "answer": "$$\n\\boxed{4.52 \\times 10^{6} \\left(\\frac{Z}{Z_{\\odot}}\\right)^{-1/4}}\n$$"
        },
        {
            "introduction": "Building on the properties of the disk, we now turn to how its evolution shapes the planets within it. A key goal of synthesis models is to predict planetary composition, which is heavily influenced by accretion history relative to volatile condensation fronts like the water snowline. This exercise () models a dynamic scenario where the snowline, $r_{\\mathrm{snow}}(t)$, moves inward as the disk cools. You will calculate the final volatile-rich mass fraction of a planetary core by integrating its accretion over time, demonstrating the \"synthesis\" approach of tracking a planet's properties through its formation history.",
            "id": "4172891",
            "problem": "Consider a passively and viscously heated protoplanetary disk whose midplane temperature follows a separable power-law in radius and time, consistent with radiative equilibrium and declining accretional heating. Let the midplane temperature be $T(r,t) = T_{0} \\left(\\frac{t}{t_{0}}\\right)^{-\\alpha} \\left(\\frac{r}{r_{0}}\\right)^{-q}$, where $r$ is the distance from the star, $t$ is time, $T_{0}$ is the reference temperature at radius $r_{0}$ and time $t_{0}$, and $\\alpha$ and $q$ are positive constants. The water snowline $r_{\\mathrm{snow}}(t)$ is defined implicitly by the condition $T\\!\\left(r_{\\mathrm{snow}}(t), t\\right) = T_{\\mathrm{freeze}}$, where $T_{\\mathrm{freeze}}$ is the water ice sublimation temperature.\n\nA planetary core on a fixed circular orbit at radius $r_{p}$ accretes solids over an accretion epoch $t \\in [t_{1}, t_{2}]$. The instantaneous solid accretion weighting is $W(t) = W_{0} \\exp\\!\\left(-\\frac{t}{\\tau}\\right)$, modeling the decline in solid supply due to radial drift and coagulation, with $W_{0}$ a normalization constant and $\\tau$ a decay timescale. Assume that, at any time $t$, solids accreted at $r_{p}$ are volatile-rich if and only if $r_{p}  r_{\\mathrm{snow}}(t)$, and volatile-poor otherwise. Define the volatile-origin fraction of the accreted solid mass by\n$$\nF_{\\mathrm{out}} = \\frac{\\displaystyle \\int_{t_{1}}^{t_{2}} W(t)\\, H\\!\\big(r_{p} - r_{\\mathrm{snow}}(t)\\big)\\, dt}{\\displaystyle \\int_{t_{1}}^{t_{2}} W(t)\\, dt},\n$$\nwhere $H(x)$ is the Heaviside step function. Use the following parameters, chosen to be representative of early viscously dominated disks: $T_{0} = 240\\,\\mathrm{K}$, $T_{\\mathrm{freeze}} = 170\\,\\mathrm{K}$, $r_{0} = 1\\,\\mathrm{Astronomical\\ Unit\\ (AU)}$, $t_{0} = 0.5\\,\\mathrm{megayear\\ (Myr)}$, $\\alpha = 1$, $q = \\frac{1}{2}$, $r_{p} = 2\\,\\mathrm{AU}$, $t_{1} = 0.3\\,\\mathrm{Myr}$, $t_{2} = 1.8\\,\\mathrm{Myr}$, and $\\tau = 0.6\\,\\mathrm{Myr}$.\n\nStarting from the provided temperature law and definition of the snowline, derive an explicit analytical expression for $r_{\\mathrm{snow}}(t)$, the crossing time $t_{\\times}$ satisfying $r_{\\mathrm{snow}}(t_{\\times}) = r_{p}$, and the resulting expression for $F_{\\mathrm{out}}$. Then evaluate $F_{\\mathrm{out}}$ numerically for the given parameters. Round your final numerical answer to four significant figures and express it as a decimal fraction with no units.",
            "solution": "The problem is well-posed, scientifically grounded, and provides all necessary information for a unique solution. We proceed with the derivation as requested.\n\nFirst, we derive the analytical expression for the water snowline radius, $r_{\\mathrm{snow}}(t)$. The snowline is defined by the condition $T(r_{\\mathrm{snow}}(t), t) = T_{\\mathrm{freeze}}$. Substituting the given temperature profile, we have:\n$$\nT_{0} \\left(\\frac{t}{t_{0}}\\right)^{-\\alpha} \\left(\\frac{r_{\\mathrm{snow}}(t)}{r_{0}}\\right)^{-q} = T_{\\mathrm{freeze}}\n$$\nWe solve this equation for $r_{\\mathrm{snow}}(t)$. First, we isolate the term containing the radius:\n$$\n\\left(\\frac{r_{\\mathrm{snow}}(t)}{r_{0}}\\right)^{-q} = \\frac{T_{\\mathrm{freeze}}}{T_{0}} \\left(\\frac{t}{t_{0}}\\right)^{\\alpha}\n$$\nNext, we raise both sides to the power of $-\\frac{1}{q}$:\n$$\n\\frac{r_{\\mathrm{snow}}(t)}{r_{0}} = \\left( \\frac{T_{\\mathrm{freeze}}}{T_{0}} \\left(\\frac{t}{t_{0}}\\right)^{\\alpha} \\right)^{-\\frac{1}{q}} = \\left(\\frac{T_{0}}{T_{\\mathrm{freeze}}}\\right)^{\\frac{1}{q}} \\left(\\frac{t}{t_{0}}\\right)^{-\\frac{\\alpha}{q}}\n$$\nThus, the explicit analytical expression for the snowline radius as a function of time is:\n$$\nr_{\\mathrm{snow}}(t) = r_{0} \\left(\\frac{T_{0}}{T_{\\mathrm{freeze}}}\\right)^{\\frac{1}{q}} \\left(\\frac{t}{t_{0}}\\right)^{-\\frac{\\alpha}{q}}\n$$\n\nSecond, we determine the crossing time $t_{\\times}$, which is the time when the snowline radius is equal to the planet's orbital radius, $r_p$. This is defined by the condition $r_{\\mathrm{snow}}(t_{\\times}) = r_{p}$. Using the expression for $r_{\\mathrm{snow}}(t)$ derived above:\n$$\nr_{0} \\left(\\frac{T_{0}}{T_{\\mathrm{freeze}}}\\right)^{\\frac{1}{q}} \\left(\\frac{t_{\\times}}{t_{0}}\\right)^{-\\frac{\\alpha}{q}} = r_{p}\n$$\nWe solve for $t_{\\times}$. We start by isolating the term containing $t_{\\times}$:\n$$\n\\left(\\frac{t_{\\times}}{t_{0}}\\right)^{-\\frac{\\alpha}{q}} = \\frac{r_{p}}{r_{0}} \\left(\\frac{T_{0}}{T_{\\mathrm{freeze}}}\\right)^{-\\frac{1}{q}}\n$$\nNow, we raise both sides to the power of $-\\frac{q}{\\alpha}$:\n$$\n\\frac{t_{\\times}}{t_{0}} = \\left(\\frac{r_{p}}{r_{0}}\\right)^{-\\frac{q}{\\alpha}} \\left(\\frac{T_{0}}{T_{\\mathrm{freeze}}}\\right)^{\\frac{1}{\\alpha}}\n$$\nThe explicit analytical expression for the crossing time is therefore:\n$$\nt_{\\times} = t_{0} \\left(\\frac{r_{p}}{r_{0}}\\right)^{-\\frac{q}{\\alpha}} \\left(\\frac{T_{0}}{T_{\\mathrm{freeze}}}\\right)^{\\frac{1}{\\alpha}}\n$$\n\nThird, we derive the expression for the volatile-origin fraction, $F_{\\mathrm{out}}$. The formula is given by:\n$$\nF_{\\mathrm{out}} = \\frac{\\displaystyle \\int_{t_{1}}^{t_{2}} W(t)\\, H\\!\\big(r_{p} - r_{\\mathrm{snow}}(t)\\big)\\, dt}{\\displaystyle \\int_{t_{1}}^{t_{2}} W(t)\\, dt}\n$$\nThe Heaviside step function $H(x)$ is $1$ for $x > 0$ and $0$ for $x \\le 0$. The argument of the Heaviside function is $r_{p} - r_{\\mathrm{snow}}(t)$. Thus, $H(r_{p} - r_{\\mathrm{snow}}(t)) = 1$ if and only if $r_{p}  r_{\\mathrm{snow}}(t)$.\nSince $\\alpha  0$ and $q  0$, the exponent $-\\frac{\\alpha}{q}$ in the expression for $r_{\\mathrm{snow}}(t)$ is negative, which means $r_{\\mathrm{snow}}(t)$ is a monotonically decreasing function of time $t$. The disk cools and the snowline moves inward.\nThe time $t_{\\times}$ is when $r_{p} = r_{\\mathrm{snow}}(t_{\\times})$. Therefore, for $t  t_{\\times}$, we have $r_{\\mathrm{snow}}(t)  r_{\\mathrm{snow}}(t_{\\times}) = r_{p}$, so $r_{p}  r_{\\mathrm{snow}}(t)$. Conversely, for $t  t_{\\times}$, we have $r_{\\mathrm{snow}}(t)  r_p$.\nThis means the Heaviside function evaluates to $1$ for $t  t_{\\times}$ and $0$ for $t  t_{\\times}$, within the integration interval $[t_1, t_2]$.\n\nThe numerator of $F_{\\mathrm{out}}$ is the integral for the mass accreted from beyond the snowline. This integral is non-zero only for times $t$ in $[t_1, t_2]$ where $t  t_{\\times}$. The integration range for the numerator is therefore from $\\max(t_{1}, t_{\\times})$ to $t_{2}$. The denominator is the total mass accreted, integrated from $t_{1}$ to $t_{2}$.\nWe must first evaluate $t_{\\times}$ to compare it with $t_1$ and $t_2$. Using the given parameters: $t_{0} = 0.5\\,\\mathrm{Myr}$, $r_{p} = 2\\,\\mathrm{AU}$, $r_{0} = 1\\,\\mathrm{AU}$, $T_{0} = 240\\,\\mathrm{K}$, $T_{\\mathrm{freeze}} = 170\\,\\mathrm{K}$, $\\alpha = 1$, and $q = \\frac{1}{2}$.\n$$\nt_{\\times} = (0.5\\,\\mathrm{Myr}) \\left(\\frac{2\\,\\mathrm{AU}}{1\\,\\mathrm{AU}}\\right)^{-\\frac{1/2}{1}} \\left(\\frac{240\\,\\mathrm{K}}{170\\,\\mathrm{K}}\\right)^{\\frac{1}{1}} = 0.5 \\times (2)^{-\\frac{1}{2}} \\times \\frac{24}{17} = \\frac{0.5 \\times 24}{17\\sqrt{2}} = \\frac{12}{17\\sqrt{2}}\\,\\mathrm{Myr}\n$$\nNumerically, $t_{\\times} \\approx 0.4991\\,\\mathrm{Myr}$. The accretion epoch is given by $t_1 = 0.3\\,\\mathrm{Myr}$ and $t_2 = 1.8\\,\\mathrm{Myr}$. Since $t_1  t_{\\times}  t_2$, the planet accretes volatile-poor material from $t_1$ to $t_{\\times}$ and volatile-rich material from $t_{\\times}$ to $t_2$.\nThe numerator integral becomes $\\int_{t_{\\times}}^{t_{2}} W(t) \\, dt$. So, $F_{\\mathrm{out}}$ is:\n$$\nF_{\\mathrm{out}} = \\frac{\\displaystyle \\int_{t_{\\times}}^{t_{2}} W(t) \\, dt}{\\displaystyle \\int_{t_{1}}^{t_{2}} W(t) \\, dt}\n$$\nSubstituting $W(t) = W_0 \\exp(-t/\\tau)$:\n$$\n\\int W(t) \\, dt = \\int W_{0} \\exp(-t/\\tau) \\, dt = -W_{0} \\tau \\exp(-t/\\tau) + C\n$$\nThe numerator is:\n$$\n\\int_{t_{\\times}}^{t_{2}} W_{0} \\exp(-t/\\tau) \\, dt = \\left[-W_{0} \\tau \\exp(-t/\\tau)\\right]_{t_{\\times}}^{t_{2}} = W_{0} \\tau \\left(\\exp(-t_{\\times}/\\tau) - \\exp(-t_{2}/\\tau)\\right)\n$$\nThe denominator is:\n$$\n\\int_{t_{1}}^{t_{2}} W_{0} \\exp(-t/\\tau) \\, dt = \\left[-W_{0} \\tau \\exp(-t/\\tau)\\right]_{t_{1}}^{t_{2}} = W_{0} \\tau \\left(\\exp(-t_{1}/\\tau) - \\exp(-t_{2}/\\tau)\\right)\n$$\nThe ratio $F_{\\mathrm{out}}$ simplifies by canceling the $W_{0}\\tau$ terms:\n$$\nF_{\\mathrm{out}} = \\frac{\\exp(-t_{\\times}/\\tau) - \\exp(-t_{2}/\\tau)}{\\exp(-t_{1}/\\tau) - \\exp(-t_{2}/\\tau)}\n$$\nThis is the final analytical expression for $F_{\\mathrm{out}}$.\n\nFinally, we evaluate $F_{\\mathrm{out}}$ numerically. The parameters are:\n$t_{1} = 0.3\\,\\mathrm{Myr}$\n$t_{2} = 1.8\\,\\mathrm{Myr}$\n$\\tau = 0.6\\,\\mathrm{Myr}$\n$t_{\\times} = \\frac{12}{17\\sqrt{2}}\\,\\mathrm{Myr}$\nWe calculate the dimensionless ratios for the exponents:\n$t_{1}/\\tau = \\frac{0.3}{0.6} = 0.5$\n$t_{2}/\\tau = \\frac{1.8}{0.6} = 3.0$\n$t_{\\times}/\\tau = \\frac{12/(17\\sqrt{2})}{0.6} = \\frac{20}{17\\sqrt{2}} = \\frac{10\\sqrt{2}}{17} \\approx 0.8319105$\nSubstituting these into the expression for $F_{\\mathrm{out}}$:\n$$\nF_{\\mathrm{out}} = \\frac{\\exp\\left(-\\frac{10\\sqrt{2}}{17}\\right) - \\exp(-3)}{\\exp(-0.5) - \\exp(-3)}\n$$\nUsing a calculator:\n$\\exp(-0.5) \\approx 0.60653066$\n$\\exp(-3) \\approx 0.04978707$\n$\\exp\\left(-\\frac{10\\sqrt{2}}{17}\\right) \\approx \\exp(-0.8319105) \\approx 0.43521268$\n$$\nF_{\\mathrm{out}} = \\frac{0.43521268 - 0.04978707}{0.60653066 - 0.04978707} = \\frac{0.38542561}{0.55674359} \\approx 0.692298\n$$\nRounding to four significant figures, the result is $0.6923$.",
            "answer": "$$\n\\boxed{0.6923}\n$$"
        },
        {
            "introduction": "The physical prescriptions for processes like planet migration must ultimately be translated into numerical algorithms within a population synthesis code. The accuracy of these algorithms is paramount to the reliability of the model's predictions. This final practice () introduces the essential skill of code verification by tasking you with benchmarking a numerical torque calculation. By implementing a finite-difference scheme to estimate disk gradients and comparing the resulting torque $\\Gamma_{\\mathrm{num}}$ to the known analytic solution $\\Gamma_{\\mathrm{true}}$, you will gain hands-on experience in quantifying numerical error and assessing the fidelity of a core model component.",
            "id": "4172881",
            "problem": "You are tasked with designing and implementing a numerical benchmark for planetary migration torque calculations used in population synthesis models of planet formation. The target is to compare finite-difference estimates of the required disk profile gradients against analytic torque predictions in the unsaturated adiabatic limit of the Paardekooper et al. formula. The program must produce a single line of output aggregating the errors from a prescribed test suite.\n\nStarting point and scope:\n- Consider a low-mass planet embedded in a two-dimensional, barotropic, vertically isothermal protoplanetary disk, where the total torque can be decomposed into a differential Lindblad torque and a corotation torque. Normalize the torque by the characteristic scaling so that the output is dimensionless.\n- Assume the unsaturated regime (no viscous or thermal saturation) and a softened two-dimensional treatment consistent with a softening-to-scale-height ratio that fixes the canonical coefficients used in community-standard formulations of the Paardekooper et al. analytic torque. Do not include any tapering, cut-offs, or saturation functions. Use an adiabatic equation of state with adiabatic index $\\gamma_{\\mathrm{ad}}$.\n\nDisk model and gradients:\n- The surface density and temperature follow power-law radial profiles,\n  $$\n  \\Sigma(r) = \\Sigma_0 \\left( \\frac{r}{r_0} \\right)^{-\\alpha_{\\mathrm{true}}}, \\quad\n  T(r) = T_0 \\left( \\frac{r}{r_0} \\right)^{-\\beta_{\\mathrm{true}}}.\n  $$\n  Here $ \\Sigma_0 $, $ T_0 $, and $ r_0 $ are positive constants, and $ \\alpha_{\\mathrm{true}} $ and $ \\beta_{\\mathrm{true}} $ are the true logarithmic slopes.\n- Define the logarithmic gradients at a planet location $ r_p $ by\n  $$\n  \\alpha = - \\frac{\\mathrm{d} \\ln \\Sigma}{\\mathrm{d} \\ln r}, \\quad\n  \\beta = - \\frac{\\mathrm{d} \\ln T}{\\mathrm{d} \\ln r}.\n  $$\n  These are to be estimated numerically from sampled profiles using finite differences.\n\nFinite-difference estimation:\n- Construct a uniform grid of $ r $ values over $ [r_{\\min}, r_{\\max}] $ with $ N $ points.\n- For a chosen $ r_p $ located at or near a grid point, compute the derivatives $ \\mathrm{d}\\Sigma/\\mathrm{d}r $ and $ \\mathrm{d}T/\\mathrm{d}r $ at the grid point closest to $ r_p $ by:\n  - Using a second-order centered difference for interior points,\n    $$\n    \\left.\\frac{\\mathrm{d}y}{\\mathrm{d}r}\\right|_{i} \\approx \\frac{y_{i+1} - y_{i-1}}{r_{i+1} - r_{i-1}},\n    $$\n    where $ y $ stands for $ \\Sigma $ or $ T $.\n  - Using a first-order one-sided difference at either boundary,\n    $$\n    \\left.\\frac{\\mathrm{d}y}{\\mathrm{d}r}\\right|_{0} \\approx \\frac{y_{1} - y_{0}}{r_{1} - r_{0}}, \\quad\n    \\left.\\frac{\\mathrm{d}y}{\\mathrm{d}r}\\right|_{N-1} \\approx \\frac{y_{N-1} - y_{N-2}}{r_{N-1} - r_{N-2}}.\n    $$\n- Convert to logarithmic slopes using\n  $$\n  \\alpha_{\\mathrm{num}} = - \\frac{r_i}{\\Sigma_i} \\left.\\frac{\\mathrm{d}\\Sigma}{\\mathrm{d}r}\\right|_{i}, \\quad\n  \\beta_{\\mathrm{num}} = - \\frac{r_i}{T_i} \\left.\\frac{\\mathrm{d}T}{\\mathrm{d}r}\\right|_{i}.\n  $$\n\nTorque evaluation and benchmark:\n- Compute the dimensionless total torque $ \\Gamma_{\\mathrm{num}} $ using the Paardekooper-type analytic functional dependence on $ \\alpha $ and $ \\beta $ evaluated with $ \\alpha_{\\mathrm{num}} $ and $ \\beta_{\\mathrm{num}} $ in the unsaturated adiabatic limit with fixed canonical coefficients. Independently compute the analytic reference $ \\Gamma_{\\mathrm{true}} $ using the same functional dependence evaluated with the exact $ \\alpha_{\\mathrm{true}} $ and $ \\beta_{\\mathrm{true}} $. The torque normalization should eliminate all physical units; therefore, the outputs are unitless reals.\n- For each test case, return the absolute error\n  $$\n  \\varepsilon = \\left| \\Gamma_{\\mathrm{num}} - \\Gamma_{\\mathrm{true}} \\right|.\n  $$\n\nTest suite:\nImplement the following five test cases. For each case, construct the grid, build $ \\Sigma(r) $ and $ T(r) $ using the given slopes, locate the grid point nearest $ r_p $, compute $ \\varepsilon $, and report it.\n\n- Case 1 (interior, moderate resolution, happy path):\n  - $ r_{\\min} = 0.5 $, $ r_{\\max} = 2.5 $, $ N = 201 $, $ r_p = 1.0 $.\n  - $ \\alpha_{\\mathrm{true}} = 1.0 $, $ \\beta_{\\mathrm{true}} = 0.5 $, $ \\gamma_{\\mathrm{ad}} = 1.4 $.\n  - Use any positive constants for $ \\Sigma_0 $, $ T_0 $, and $ r_0 $; take $ r_0 = 1.0 $.\n\n- Case 2 (interior, high resolution refinement):\n  - $ r_{\\min} = 0.5 $, $ r_{\\max} = 2.5 $, $ N = 2001 $, $ r_p = 1.0 $.\n  - $ \\alpha_{\\mathrm{true}} = 1.0 $, $ \\beta_{\\mathrm{true}} = 0.5 $, $ \\gamma_{\\mathrm{ad}} = 1.4 $.\n\n- Case 3 (planet at inner boundary, one-sided gradient):\n  - $ r_{\\min} = 0.5 $, $ r_{\\max} = 2.5 $, $ N = 101 $, $ r_p = 0.5 $.\n  - $ \\alpha_{\\mathrm{true}} = 1.0 $, $ \\beta_{\\mathrm{true}} = 0.5 $, $ \\gamma_{\\mathrm{ad}} = 1.4 $.\n\n- Case 4 (steeper gradients and different adiabatic index):\n  - $ r_{\\min} = 0.3 $, $ r_{\\max} = 3.0 $, $ N = 401 $, $ r_p = 2.0 $.\n  - $ \\alpha_{\\mathrm{true}} = 1.5 $, $ \\beta_{\\mathrm{true}} = 1.0 $, $ \\gamma_{\\mathrm{ad}} = 1.67 $.\n\n- Case 5 (flat profiles):\n  - $ r_{\\min} = 0.5 $, $ r_{\\max} = 2.5 $, $ N = 301 $, $ r_p = 1.5 $.\n  - $ \\alpha_{\\mathrm{true}} = 0.0 $, $ \\beta_{\\mathrm{true}} = 0.0 $, $ \\gamma_{\\mathrm{ad}} = 1.4 $.\n\nFinal output format:\n- Your program should produce a single line of output containing the five errors as a comma-separated list enclosed in square brackets, in the same order as the cases above, for example, \"[e1,e2,e3,e4,e5]\".\n- All outputs are unitless real numbers. Angles are not used. Percentages are not used.\n\nImportant: The final answer must be a complete, runnable program that constructs the five cases, computes finite-difference gradients, evaluates the torques as specified, and prints the single-line result exactly in the format above. No user input or external files are allowed.",
            "solution": "The problem statement has been rigorously validated and is determined to be a valid, well-posed, and scientifically grounded exercise in numerical methods as applied to planetary astrophysics. It requests the implementation of a benchmark to compare numerically estimated disk-profile gradients with analytically derived migration torques, which is a standard verification procedure in the field of planet formation modeling. All givens are physically and mathematically consistent.\n\nThe core task is to compute the absolute error $\\varepsilon = |\\Gamma_{\\mathrm{num}} - \\Gamma_{\\mathrm{true}}|$ between two evaluations of the planet migration torque. The \"true\" torque, $\\Gamma_{\\mathrm{true}}$, is calculated using the analytically known power-law indices of the disk's surface density and temperature profiles. The \"numerical\" torque, $\\Gamma_{\\mathrm{num}}$, is calculated using the same indices but estimated numerically from sampled disk profiles via a finite-difference scheme.\n\nFirst, we establish the analytical model for the disk and the torque. The disk surface density $\\Sigma(r)$ and temperature $T(r)$ are given as power-law functions of the radial coordinate $r$:\n$$\n\\Sigma(r) = \\Sigma_0 \\left( \\frac{r}{r_0} \\right)^{-\\alpha_{\\mathrm{true}}}, \\quad\nT(r) = T_0 \\left( \\frac{r}{r_0} \\right)^{-\\beta_{\\mathrm{true}}}\n$$\nwhere $\\Sigma_0$, $T_0$, and $r_0$ are normalization constants, which we can set to $1$ without loss of generality. The logarithmic gradients are defined as $\\alpha = -\\mathrm{d}\\ln\\Sigma/\\mathrm{d}\\ln r$ and $\\beta = -\\mathrm{d}\\ln T/\\mathrm{d}\\ln r$. For the given power-law profiles, these evaluate precisely to $\\alpha_{\\mathrm{true}}$ and $\\beta_{\\mathrm{true}}$.\n\nThe problem specifies using the Paardekooper et al. formula for the total dimensionless torque in the unsaturated, adiabatic limit. This torque, $\\Gamma$, is a function of the local gradients $\\alpha$ and $\\beta$, and the adiabatic index $\\gamma_{\\mathrm{ad}}$. The total torque is the sum of the Lindblad torque, $\\Gamma_L$, and the corotation torque, $\\Gamma_c$. Using the canonical coefficients from the literature, the dimensionless functional form is:\n$$\n\\Gamma(\\alpha, \\beta, \\gamma_{\\mathrm{ad}}) = \\Gamma_L + \\Gamma_c\n$$\n$$\n\\Gamma_L = -(2.5 + 1.7\\beta - 0.1\\alpha)\n$$\n$$\n\\Gamma_c = 1.1(1.5 - \\alpha) + \\frac{7.9}{\\gamma_{\\mathrm{ad}}}(\\beta - (\\gamma_{\\mathrm{ad}}-1)\\alpha)\n$$\nCombining and simplifying these terms, we obtain the single function for the total dimensionless torque:\n$$\n\\Gamma(\\alpha, \\beta, \\gamma_{\\mathrm{ad}}) = -0.85 + \\alpha \\left( -8.9 + \\frac{7.9}{\\gamma_{\\mathrm{ad}}} \\right) + \\beta \\left( -1.7 + \\frac{7.9}{\\gamma_{\\mathrm{ad}}} \\right)\n$$\nThe reference torque, $\\Gamma_{\\mathrm{true}}$, is computed by substituting the given $\\alpha_{\\mathrm{true}}$ and $\\beta_{\\mathrm{true}}$ into this equation:\n$$\n\\Gamma_{\\mathrm{true}} = \\Gamma(\\alpha_{\\mathrm{true}}, \\beta_{\\mathrm{true}}, \\gamma_{\\mathrm{ad}})\n$$\n\nNext, we establish the numerical procedure. For each test case, we construct a uniform radial grid of $N$ points from $r_{\\min}$ to $r_{\\max}$. The grid spacing is $\\Delta r = (r_{\\max} - r_{\\min}) / (N-1)$. We then evaluate the functions $\\Sigma(r)$ and $T(r)$ at each grid point $r_i$ to generate discrete profiles, $\\Sigma_i$ and $T_i$.\n\nThe planet is located at a radius $r_p$. We identify the grid point $r_k$ that is closest to $r_p$. At this grid point, we estimate the physical derivatives $\\mathrm{d}\\Sigma/\\mathrm{d}r$ and $\\mathrm{d}T/\\mathrm{d}r$ using finite differences.\n- If the point $r_k$ is an interior point of the grid (i.e., its index $k$ is not $0$ or $N-1$), we use a second-order centered difference:\n  $$\n  \\left.\\frac{\\mathrm{d}y}{\\mathrm{d}r}\\right|_{k} \\approx \\frac{y_{k+1} - y_{k-1}}{r_{k+1} - r_{k-1}} = \\frac{y_{k+1} - y_{k-1}}{2\\Delta r}\n  $$\n- If $r_k$ is at the inner boundary ($k=0$), we use a first-order forward difference:\n  $$\n  \\left.\\frac{\\mathrm{d}y}{\\mathrm{d}r}\\right|_{0} \\approx \\frac{y_{1} - y_{0}}{r_{1} - r_{0}} = \\frac{y_{1} - y_{0}}{\\Delta r}\n  $$\n- If $r_k$ is at the outer boundary ($k=N-1$), we use a first-order backward difference:\n  $$\n  \\left.\\frac{\\mathrm{d}y}{\\mathrm{d}r}\\right|_{N-1} \\approx \\frac{y_{N-1} - y_{N-2}}{r_{N-1} - r_{N-2}} = \\frac{y_{N-1} - y_{N-2}}{\\Delta r}\n  $$\nwhere $y$ represents either $\\Sigma$ or $T$.\n\nThese physical derivatives are then converted into the numerical estimates of the logarithmic gradients, $\\alpha_{\\mathrm{num}}$ and $\\beta_{\\mathrm{num}}$, at the grid point $r_k$:\n$$\n\\alpha_{\\mathrm{num}} = - \\frac{r_k}{\\Sigma_k} \\left.\\frac{\\mathrm{d}\\Sigma}{\\mathrm{d}r}\\right|_{k}, \\quad\n\\beta_{\\mathrm{num}} = - \\frac{r_k}{T_k} \\left.\\frac{\\mathrm{d}T}{\\mathrm{d}r}\\right|_{k}\n$$\nWith these numerically determined gradients, we compute the numerical torque:\n$$\n\\Gamma_{\\mathrm{num}} = \\Gamma(\\alpha_{\\mathrm{num}}, \\beta_{\\mathrm{num}}, \\gamma_{\\mathrm{ad}})\n$$\nFinally, for each test case, we calculate the absolute error $\\varepsilon = |\\Gamma_{\\mathrm{num}} - \\Gamma_{\\mathrm{true}}|$. This procedure is applied to all five specified test cases, and the resulting errors are aggregated into a single list for output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the benchmark for planetary migration torque calculations.\n    It iterates through a suite of test cases, computes the error between\n    the analytically and numerically derived torques, and prints the results.\n    \"\"\"\n\n    # Test cases as defined in the problem statement.\n    # Each case is a dictionary of parameters.\n    test_cases = [\n        # Case 1: interior, moderate resolution, happy path\n        {\n            \"r_min\": 0.5, \"r_max\": 2.5, \"N\": 201, \"r_p\": 1.0,\n            \"alpha_true\": 1.0, \"beta_true\": 0.5, \"gamma_ad\": 1.4\n        },\n        # Case 2: interior, high resolution refinement\n        {\n            \"r_min\": 0.5, \"r_max\": 2.5, \"N\": 2001, \"r_p\": 1.0,\n            \"alpha_true\": 1.0, \"beta_true\": 0.5, \"gamma_ad\": 1.4\n        },\n        # Case 3: planet at inner boundary, one-sided gradient\n        {\n            \"r_min\": 0.5, \"r_max\": 2.5, \"N\": 101, \"r_p\": 0.5,\n            \"alpha_true\": 1.0, \"beta_true\": 0.5, \"gamma_ad\": 1.4\n        },\n        # Case 4: steeper gradients and different adiabatic index\n        {\n            \"r_min\": 0.3, \"r_max\": 3.0, \"N\": 401, \"r_p\": 2.0,\n            \"alpha_true\": 1.5, \"beta_true\": 1.0, \"gamma_ad\": 1.67\n        },\n        # Case 5: flat profiles\n        {\n            \"r_min\": 0.5, \"r_max\": 2.5, \"N\": 301, \"r_p\": 1.5,\n            \"alpha_true\": 0.0, \"beta_true\": 0.0, \"gamma_ad\": 1.4\n        },\n    ]\n\n    results = []\n    for params in test_cases:\n        error = calculate_torque_error(**params)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_torque_error(r_min, r_max, N, r_p, alpha_true, beta_true, gamma_ad):\n    \"\"\"\n    Computes the absolute error between analytical and numerical migration torques for a single case.\n    \"\"\"\n    \n    def total_torque(alpha, beta, gamma_ad):\n        \"\"\"\n        Calculates the dimensionless total torque using the unsaturated adiabatic Paardekooper et al. formula.\n        \n        Args:\n            alpha (float): Logarithmic gradient of surface density.\n            beta (float): Logarithmic gradient of temperature.\n            gamma_ad (float): Adiabatic index.\n            \n        Returns:\n            float: The dimensionless total torque.\n        \"\"\"\n        # Combine Lindblad and corotation torques into a single expression.\n        # Gamma = -0.85 + alpha*(-8.9 + 7.9/gamma_ad) + beta*(-1.7 + 7.9/gamma_ad)\n        \n        common_term = 7.9 / gamma_ad\n        torque = -0.85 + alpha * (-8.9 + common_term) + beta * (-1.7 + common_term)\n        return torque\n\n    # Set normalization constants (their values do not affect the logarithmic gradients).\n    sigma_0 = 1.0\n    t_0 = 1.0\n    r_0 = 1.0\n\n    # 1. Generate grid and disk profiles\n    r_grid = np.linspace(r_min, r_max, N)\n    sigma_grid = sigma_0 * (r_grid / r_0)**(-alpha_true)\n    temp_grid = t_0 * (r_grid / r_0)**(-beta_true)\n    \n    # 2. Find the grid point closest to the planet's location r_p\n    idx_p = np.argmin(np.abs(r_grid - r_p))\n    r_at_p = r_grid[idx_p]\n    \n    # 3. Compute derivatives using finite differences\n    delta_r = (r_max - r_min) / (N - 1)\n    \n    if idx_p == 0:  # Forward difference at the inner boundary\n        dSigma_dr = (sigma_grid[1] - sigma_grid[0]) / delta_r\n        dT_dr = (temp_grid[1] - temp_grid[0]) / delta_r\n    elif idx_p == N - 1:  # Backward difference at the outer boundary\n        dSigma_dr = (sigma_grid[N - 1] - sigma_grid[N - 2]) / delta_r\n        dT_dr = (temp_grid[N - 1] - temp_grid[N - 2]) / delta_r\n    else:  # Centered difference for interior points\n        dSigma_dr = (sigma_grid[idx_p + 1] - sigma_grid[idx_p - 1]) / (2 * delta_r)\n        dT_dr = (temp_grid[idx_p + 1] - temp_grid[idx_p - 1]) / (2 * delta_r)\n        \n    # 4. Convert derivatives to numerical logarithmic gradients\n    sigma_at_p = sigma_grid[idx_p]\n    temp_at_p = temp_grid[idx_p]\n\n    # Handle a potential division by zero for constant profiles, though derivatives will be zero.\n    alpha_num = - (r_at_p / sigma_at_p) * dSigma_dr if sigma_at_p != 0 else 0.0\n    beta_num = - (r_at_p / temp_at_p) * dT_dr if temp_at_p != 0 else 0.0\n\n    # 5. Calculate torques and the absolute error\n    gamma_true = total_torque(alpha_true, beta_true, gamma_ad)\n    gamma_num = total_torque(alpha_num, beta_num, gamma_ad)\n    \n    error = abs(gamma_num - gamma_true)\n    \n    return error\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}