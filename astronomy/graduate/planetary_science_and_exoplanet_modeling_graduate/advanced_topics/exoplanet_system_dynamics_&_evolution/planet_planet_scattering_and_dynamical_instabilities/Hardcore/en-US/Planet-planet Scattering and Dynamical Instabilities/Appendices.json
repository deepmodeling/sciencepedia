{
    "hands_on_practices": [
        {
            "introduction": "The long-term stability of a planetary system is exquisitely sensitive to the spacing between its planets' orbits. Decades of numerical simulations have revealed a powerful empirical relationship: the time until a system goes unstable, $t_{\\mathrm{inst}}$, grows exponentially with the planets' separation measured in mutual Hill radii, $\\Delta$. This practice allows you to directly engage with this foundational concept by fitting the sensitivity parameter $\\beta$ from simulated data, providing a tangible sense of how dramatically stability timescales change with small adjustments in orbital spacing .",
            "id": "4169857",
            "problem": "You are asked to formalize and estimate the sensitivity of dynamical instability times in compact, equal-mass, equally spaced planetary systems to their initial spacing. Start from fundamental principles of classical mechanics and celestial dynamics and construct a quantitative inference procedure that links the time to first close gravitational encounter to the normalized spacing between adjacent planets.\n\nUse the following foundations:\n\n- Newton’s law of gravitation: the acceleration of a planet of mass $m$ due to a star of mass $M_\\star$ at distance $r$ is governed by $G M_\\star / r^2$, where $G$ is the gravitational constant and $r$ is the separation.\n- The Mutual Hill Radius (MHR) for two adjacent equal-mass planets of mass $m$ orbiting a star of mass $M_\\star$ at semi-major axes $a_i$ and $a_{i+1}$ is defined as\n$$\nR_{\\mathrm{H,m}} \\equiv \\left(\\frac{m_i + m_{i+1}}{3 M_\\star}\\right)^{1/3} \\cdot \\frac{a_i + a_{i+1}}{2}.\n$$\nFor equal masses $m_i = m_{i+1} = m$, this simplifies to\n$$\nR_{\\mathrm{H,m}} = \\left(\\frac{2m}{3 M_\\star}\\right)^{1/3} \\cdot \\frac{a_i + a_{i+1}}{2}.\n$$\n- Define the dimensionless spacing in units of the Mutual Hill Radius as\n$$\n\\Delta \\equiv \\frac{a_{i+1} - a_i}{R_{\\mathrm{H,m}}}.\n$$\n\nAssume there exists a widely reported empirical relation connecting the instability time $t_{\\mathrm{inst}}$ to the spacing $\\Delta$ for equal-mass, equally spaced planets. Transform this relation into a linear model by an appropriate variable transformation, and then estimate, for each dataset, the parameter controlling the sensitivity of the instability time to $\\Delta$. Interpret this parameter within the context of the linear model, and compute it via a least-squares fit.\n\nInstability time $t_{\\mathrm{inst}}$ is defined here as the time to the first close encounter between any adjacent pair of planets, measured in units of the inner planet’s orbital period, so $t_{\\mathrm{inst}}$ is a dimensionless quantity. All angles, if any, are irrelevant for this problem. Use the natural logarithm function. All results should be expressed as dimensionless floats.\n\nFor the test suite below, use the following datasets. Each dataset corresponds to a fixed equal planet mass ratio $m/M_\\star$, and either directly provides a list of $\\Delta$ values and corresponding $t_{\\mathrm{inst}}$ values, or provides fractional spacing values from which you must first compute $\\Delta$ using the Mutual Hill Radius definition. When fractional spacing is provided, assume adjacent planets follow a geometric progression $a_{i+1} = a_i (1 + \\epsilon)$, so that $a_{i+1} - a_i = \\epsilon a_i$, and use the exact average $\\frac{a_i + a_{i+1}}{2} = a_i \\left(1 + \\frac{\\epsilon}{2}\\right)$ in the Mutual Hill Radius formula. For equal masses, this yields\n$$\n\\Delta(\\epsilon, m/M_\\star) = \\frac{\\epsilon}{\\left(\\frac{2 m}{3 M_\\star}\\right)^{1/3} \\left(1 + \\frac{\\epsilon}{2}\\right)}.\n$$\n\nDatasets to use:\n\n- Dataset $1$: mass ratio $m/M_\\star = 1\\times 10^{-5}$. Direct spacing and instability times:\n  - $\\Delta$ values: $[3.2, 3.6, 4.0, 4.4, 4.8]$.\n  - $t_{\\mathrm{inst}}$ values (in inner orbital periods): $[1200, 6000, 25000, 120000, 500000]$.\n\n- Dataset $2$: mass ratio $m/M_\\star = 3\\times 10^{-5}$. Direct spacing and instability times:\n  - $\\Delta$ values: $[2.8, 3.0, 3.2, 3.4]$.\n  - $t_{\\mathrm{inst}}$ values (in inner orbital periods): $[80, 220, 700, 2200]$.\n\n- Dataset $3$: mass ratio $m/M_\\star = 5\\times 10^{-5}$. Direct spacing and instability times:\n  - $\\Delta$ values: $[3.6, 4.0, 4.4, 4.8]$.\n  - $t_{\\mathrm{inst}}$ values (in inner orbital periods): $[600, 3000, 15000, 75000]$.\n\n- Dataset $4$: mass ratio $m/M_\\star = 2\\times 10^{-5}$. Fractional spacing values $\\epsilon$ and instability times:\n  - $\\epsilon$ values: $[0.06, 0.08, 0.10, 0.12]$.\n  - $t_{\\mathrm{inst}}$ values (in inner orbital periods): $[200, 1000, 5000, 25000]$.\n  Use the formula above to convert each $\\epsilon$ to $\\Delta$ for this dataset before fitting.\n\nTask requirements:\n\n- For each dataset, construct the linear model implied by the variable transformation of the empirical relation and use ordinary least squares to estimate the sensitivity parameter.\n- The least-squares solution must be computed analytically from first principles, without relying on any black-box fitting utilities. Use the natural logarithm of $t_{\\mathrm{inst}}$ as needed for the transformation, and treat $\\Delta$ (or its conversion from $\\epsilon$) as the independent variable.\n- Numerical stability: if any $t_{\\mathrm{inst}}$ is non-positive, it must be discarded; however, the provided datasets are all strictly positive.\n- Output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list should contain the four estimated sensitivity parameters, in the order of datasets $1$ through $4$, each rounded to three decimal places, for example, $[x_1,x_2,x_3,x_4]$ where each $x_i$ is a float.\n\nYour final output must be a single line: a list with four floats corresponding to the four datasets, dimensionless, rounded to three decimal places, as specified above.",
            "solution": "We start from Newton’s law of gravitation, which governs the motion of planets around a star. In multi-planet systems, long-term stability is influenced by the proximity of planets measured in units of the Mutual Hill Radius (MHR). For equal-mass, adjacent planets with masses $m$ orbiting a star of mass $M_\\star$, the Mutual Hill Radius is\n$$\nR_{\\mathrm{H,m}} = \\left(\\frac{2m}{3 M_\\star}\\right)^{1/3} \\cdot \\frac{a_i + a_{i+1}}{2}.\n$$\nThe dimensionless spacing in units of MHR is\n$$\n\\Delta = \\frac{a_{i+1} - a_i}{R_{\\mathrm{H,m}}}.\n$$\n\nWhen adjacent planets are arranged in a geometric progression $a_{i+1} = a_i (1 + \\epsilon)$ with equal mass $m$, the separation is $a_{i+1} - a_i = \\epsilon a_i$, and the average semi-major axis is $\\frac{a_i + a_{i+1}}{2} = a_i \\left(1 + \\frac{\\epsilon}{2}\\right)$. Substituting into the MHR spacing definition yields\n$$\n\\Delta(\\epsilon, m/M_\\star) = \\frac{\\epsilon a_i}{\\left(\\frac{2m}{3 M_\\star}\\right)^{1/3} \\cdot a_i \\left(1 + \\frac{\\epsilon}{2}\\right)} = \\frac{\\epsilon}{\\left(\\frac{2 m}{3 M_\\star}\\right)^{1/3} \\left(1 + \\frac{\\epsilon}{2}\\right)}.\n$$\nThus, for a given $\\epsilon$ and $m/M_\\star$, $\\Delta$ is constant across adjacent pairs in a geometric progression.\n\nEmpirical studies of equal-mass, equally spaced planetary systems widely report that the instability time grows rapidly with normalized spacing. Let us posit the standard exponential form:\n$$\nt_{\\mathrm{inst}} \\sim t_0 \\exp(\\beta \\Delta),\n$$\nwhere $t_0$ is a characteristic time scale and $\\beta$ is a sensitivity parameter capturing how sharply the instability time increases with spacing $\\Delta$. This scaling can be motivated by the exponential suppression of chaotic diffusion in systems with enhanced separations, though its precise microscopic derivation involves complex non-linear dynamics beyond the scope of this exercise. Our goal here is to estimate $\\beta$ for the provided datasets.\n\nTo transform this into a linear estimation problem, take the natural logarithm of both sides:\n$$\n\\ln t_{\\mathrm{inst}} = \\ln t_0 + \\beta \\Delta.\n$$\nDefine $y \\equiv \\ln t_{\\mathrm{inst}}$ and $x \\equiv \\Delta$. The model becomes a simple linear relation $y = c + \\beta x$, where $c = \\ln t_0$ is the intercept and $\\beta$ is the slope.\n\nWe estimate $\\beta$ via ordinary least squares (OLS), which minimizes the sum of squared residuals $\\sum_i (y_i - c - \\beta x_i)^2$. The OLS solution for the slope is\n$$\n\\beta = \\frac{\\sum_i (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_i (x_i - \\bar{x})^2},\n$$\nwhere $\\bar{x}$ and $\\bar{y}$ are sample means of $x_i$ and $y_i$, respectively. The intercept is\n$$\nc = \\bar{y} - \\beta \\bar{x},\n$$\nand the characteristic time scale can be recovered as $t_0 = \\exp(c)$. However, the task requires only $\\beta$ for each dataset.\n\nAlgorithmic steps for each dataset:\n\n1. Read $m/M_\\star$.\n2. If the dataset provides $\\Delta$ values directly, set $x_i = \\Delta_i$. If it provides fractional spacing values $\\epsilon_i$, convert each to $\\Delta_i$ using\n   $$\n   \\Delta_i = \\frac{\\epsilon_i}{\\left(\\frac{2 m}{3 M_\\star}\\right)^{1/3} \\left(1 + \\frac{\\epsilon_i}{2}\\right)}.\n   $$\n3. Read $t_{\\mathrm{inst},i}$ values; ensure all are strictly positive. Compute $y_i = \\ln(t_{\\mathrm{inst},i})$.\n4. Compute $\\bar{x}$, $\\bar{y}$, and then the OLS slope $\\beta$ using the formula above.\n5. Round the resulting $\\beta$ to three decimal places for output consistency.\n\nScientific realism and plausibility: The datasets use instability times measured in units of the inner planet’s orbital period (dimensionless) and spacings $\\Delta$ in mutual Hill radii (dimensionless). Given equal masses and equal normalized spacings, the exponential sensitivity of $t_{\\mathrm{inst}}$ to $\\Delta$ is consistent with established numerical experiments in planet-planet scattering with dynamical instabilities. Larger $m/M_\\star$ generally reduce $t_{\\mathrm{inst}}$ at fixed $\\Delta$ and can alter the empirical slope $\\beta$, which we estimate here from the provided simulated datasets.\n\nThe program will process the four datasets in the given order and print a single line with a list of the four estimated $\\beta$ values, each rounded to three decimals, formatted as $[x_1,x_2,x_3,x_4]$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef ols_slope(x, y):\n    \"\"\"\n    Compute the ordinary least squares slope for y = c + beta * x.\n    Assumes x and y are 1D numpy arrays of equal length with length = 2.\n    \"\"\"\n    x_mean = np.mean(x)\n    y_mean = np.mean(y)\n    # Covariance and variance\n    cov_xy = np.sum((x - x_mean) * (y - y_mean))\n    var_x = np.sum((x - x_mean) ** 2)\n    # Protect against zero variance in x\n    if var_x == 0.0:\n        return np.nan\n    beta = cov_xy / var_x\n    return beta\n\ndef delta_from_epsilon(epsilon_array, mass_ratio):\n    \"\"\"\n    Convert fractional spacings epsilon to Delta using the mutual Hill radius\n    definition for equal masses with geometric progression a_{i+1} = a_i (1 + epsilon).\n    Delta = epsilon / [ ((2m)/(3M_star))^(1/3) * (1 + epsilon/2) ].\n    \"\"\"\n    k = ((2.0 * mass_ratio) / 3.0) ** (1.0 / 3.0)\n    eps = np.array(epsilon_array, dtype=float)\n    delta = eps / (k * (1.0 + eps / 2.0))\n    return delta\n\ndef fit_beta_from_delta(delta_array, t_inst_array):\n    \"\"\"\n    Given arrays of Delta and t_inst (positive), fit beta via ln-transform OLS.\n    \"\"\"\n    delta = np.array(delta_array, dtype=float)\n    t_inst = np.array(t_inst_array, dtype=float)\n    # Filter strictly positive times\n    mask = t_inst  0.0\n    delta = delta[mask]\n    t_inst = t_inst[mask]\n    # Need at least two points to fit\n    if delta.size  2:\n        return np.nan\n    y = np.log(t_inst)\n    beta = ols_slope(delta, y)\n    return beta\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a dict with keys:\n    # - 'type': 'direct' or 'epsilon'\n    # - 'mass_ratio': m/M_star\n    # - 'delta' or 'epsilon': list of spacings\n    # - 't_inst': list of instability times in inner orbital periods\n    test_cases = [\n        {\n            \"type\": \"direct\",\n            \"mass_ratio\": 1e-5,\n            \"delta\": [3.2, 3.6, 4.0, 4.4, 4.8],\n            \"t_inst\": [1200, 6000, 25000, 120000, 500000],\n        },\n        {\n            \"type\": \"direct\",\n            \"mass_ratio\": 3e-5,\n            \"delta\": [2.8, 3.0, 3.2, 3.4],\n            \"t_inst\": [80, 220, 700, 2200],\n        },\n        {\n            \"type\": \"direct\",\n            \"mass_ratio\": 5e-5,\n            \"delta\": [3.6, 4.0, 4.4, 4.8],\n            \"t_inst\": [600, 3000, 15000, 75000],\n        },\n        {\n            \"type\": \"epsilon\",\n            \"mass_ratio\": 2e-5,\n            \"epsilon\": [0.06, 0.08, 0.10, 0.12],\n            \"t_inst\": [200, 1000, 5000, 25000],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        mass_ratio = case[\"mass_ratio\"]\n        if case[\"type\"] == \"direct\":\n            delta = case[\"delta\"]\n            t_inst = case[\"t_inst\"]\n            beta = fit_beta_from_delta(delta, t_inst)\n        elif case[\"type\"] == \"epsilon\":\n            epsilon = case[\"epsilon\"]\n            t_inst = case[\"t_inst\"]\n            delta = delta_from_epsilon(epsilon, mass_ratio)\n            beta = fit_beta_from_delta(delta, t_inst)\n        else:\n            beta = np.nan\n        # Round to three decimals as required\n        if np.isnan(beta):\n            results.append(\"nan\")\n        else:\n            results.append(f\"{beta:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Once a planetary system becomes unstable and orbits begin to cross, what is the ultimate fate of the planets? The system's evolution is then governed by a series of chaotic close encounters that typically end in one of two ways: a physical collision or the ejection of a planet from the system entirely. This exercise guides you through a first-principles derivation to understand how the competition between these outcomes scales with orbital distance, revealing why collisions are favored in the inner regions of planetary systems while ejections become more prevalent in the outer parts .",
            "id": "4169856",
            "problem": "Consider two equal-mass planets of mass $M_p$ and physical radius $R_p$ orbiting a star of mass $M_*$ on initially nearly circular, coplanar orbits with semi-major axis $a$. The planets undergo dynamical instability and repeated close encounters, during which either a physical collision (merger) can occur or one planet can be ejected from the system. Assume Newtonian gravity, point-mass stars and planets except for the finite planetary radii $R_p$, and that the relative speed at infinity for planet-planet hyperbolic encounters is comparable to a characteristic speed set by the local dynamics. Let the mutual Hill radius be defined in the usual way for two equal-mass planets, and assume that the distribution of encounter impact parameters is approximately uniform over the area of the mutual Hill sphere. Treat the per-encounter probability of ejection conditioned on entering the strong-scattering regime as independent of $a$ when expressed in Hill units, and neglect tidal dissipation, gas drag, and additional bodies. Using only first principles and well-tested facts (Newton’s laws, Keplerian orbital scalings, the mutual Hill radius definition, and classical gravitational focusing in two-body hyperbolic encounters), determine how the ratio of the probability of collision to the probability of ejection, $P_{\\mathrm{coll}}/P_{\\mathrm{ej}}$, scales with $a$. Which option best captures both the scaling and the physical interpretation of how finite planetary radii and physical collisions reduce the ejection probability at small $a$ compared to large $a$ where collisions are rarer?\n\nA. $P_{\\mathrm{coll}}/P_{\\mathrm{ej}}$ scales approximately as $\\left(\\dfrac{R_p}{a}\\right)^2$ multiplied by a gravitational focusing factor that grows linearly with $a$, namely\n$$\\frac{P_{\\mathrm{coll}}}{P_{\\mathrm{ej}}}\\ \\propto\\ \\left(\\frac{R_c}{R_H}\\right)^2\\left[1+\\frac{v_{\\mathrm{esc}}^2}{v_H^2}\\right]\\ =\\ \\left(\\frac{R_c}{a\\left(\\dfrac{2M_p}{3M_*}\\right)^{1/3}}\\right)^2\\left[1+\\left(\\frac{3}{2}\\right)^{2/3}\\frac{2a\\,M_p^{1/3}}{R_c\\,M_*^{1/3}}\\right],$$\nwith $R_c\\approx 2R_p$, $R_H=a\\left(\\dfrac{2M_p}{3M_*}\\right)^{1/3}$, $v_{\\mathrm{esc}}^2=\\dfrac{2GM_p}{R_c}$, and $v_H^2=\\dfrac{GM_*}{a}\\left(\\dfrac{2M_p}{3M_*}\\right)^{2/3}$. Therefore, $P_{\\mathrm{coll}}/P_{\\mathrm{ej}}$ decreases with increasing $a$ roughly as $a^{-2}$ at small $a$ and as $a^{-1}$ when gravitational focusing dominates, implying that collisions are relatively common at small $a$ and suppress ejections, whereas at large $a$ collisions are rarer and ejections are more probable.\n\nB. $P_{\\mathrm{coll}}/P_{\\mathrm{ej}}$ is independent of $a$ because encounter dynamics are scale-free in Hill units, so finite planetary radii do not alter the outcome statistics across different $a$.\n\nC. $P_{\\mathrm{coll}}/P_{\\mathrm{ej}}$ increases with $a$ since gravitational focusing strengthens at large $a$, making collisions increasingly more likely than ejections as $a$ grows.\n\nD. $P_{\\mathrm{coll}}/P_{\\mathrm{ej}}$ decreases exponentially with $a$ due to Keplerian shear exponentially suppressing small impact parameters at larger $a$, which overwhelms any gravitational focusing effects.",
            "solution": "The user wants me to solve and analyze a problem about planetary dynamics.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n-   **Planets:** Two equal-mass planets, mass $M_p$, physical radius $R_p$.\n-   **Star:** Mass $M_*$.\n-   **Initial Orbits:** Nearly circular, coplanar, with semi-major axis $a$.\n-   **Dynamics:** Dynamical instability leads to repeated close encounters.\n-   **Outcomes:** Physical collision (merger) or one planet is ejected.\n-   **Assumptions:**\n    1.  Newtonian gravity.\n    2.  Star and planets are point masses, except for the finite planetary radius $R_p$ used for collision calculations.\n    3.  The relative speed at infinity for planet-planet hyperbolic encounters, $v_\\infty$, is comparable to a characteristic speed set by the local dynamics.\n    4.  The mutual Hill radius, $R_H$, is defined in the usual way for two equal-mass planets.\n    5.  The distribution of encounter impact parameters is approximately uniform over the area of the mutual Hill sphere.\n    6.  The per-encounter probability of ejection, $P_{\\mathrm{ej}}$, conditioned on entering the strong-scattering regime, is independent of $a$ when expressed in Hill units.\n    7.  Tidal dissipation, gas drag, and additional bodies are neglected.\n-   **Question:** Determine how the ratio of the probability of collision to the probability of ejection, $P_{\\mathrm{coll}}/P_{\\mathrm{ej}}$, scales with $a$. The options also require an assessment of the physical interpretation.\n\n**Step 2: Validate Using Extracted Givens**\n\n-   **Scientifically Grounded:** The problem is firmly rooted in celestial mechanics and planetary science, specifically the study of dynamical instabilities in planetary systems. The concepts employed (Hill radius, gravitational focusing, collision vs. ejection) are standard in this field. The scenario described is a widely studied model for the late stages of planet formation and architectural evolution of exoplanetary systems.\n-   **Well-Posed:** The problem is well-posed. It asks for a scaling relationship, which can be derived from the given physical principles and assumptions. The assumptions, while simplifications of reality, are standard in theoretical treatments and are sufficient to define a solvable model leading to a unique scaling law.\n-   **Objective:** The problem is stated using precise, objective, and quantitative language. It relies on physical laws and definitions, not subjective claims.\n-   **Flaw Checklist:**\n    1.  **Scientific/Factual Unsoundness:** None. The problem is based on standard Newtonian physics.\n    2.  **Non-Formalizable/Irrelevant:** None. The problem is a classic, formalizable problem in its specified field.\n    3.  **Incomplete/Contradictory Setup:** The assumptions are clearly stated and form a self-consistent, albeit simplified, model. Key assumptions like the constancy of $P_{\\mathrm{ej}}$ and the nature of $v_\\infty$ are provided, making the problem tractable.\n    4.  **Unrealistic/Infeasible:** The model is a simplification but represents a physically plausible and important scenario in planet formation theory.\n    5.  **Ill-Posed/Poorly Structured:** None. A unique scaling law can be derived.\n    6.  **Pseudo-Profound, Trivial, or Tautological:** None. The derivation requires combining multiple physical concepts and is a non-trivial exercise.\n    7.  **Outside Scientific Verifiability:** None. The results of such models are routinely compared with N-body simulations.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is valid. It is a well-formulated problem in theoretical astrophysics. I will proceed with the derivation and solution.\n\n### Derivation of the Scaling Relationship\n\nThe quantity to be determined is the ratio of probabilities $P_{\\mathrm{coll}}/P_{\\mathrm{ej}}$. The problem states that the per-encounter probability of ejection, $P_{\\mathrm{ej}}$, is a constant independent of the semi-major axis $a$. Therefore, the scaling of the ratio is determined entirely by the scaling of the per-encounter collision probability, $P_{\\mathrm{coll}}$.\n$$\n\\frac{P_{\\mathrm{coll}}}{P_{\\mathrm{ej}}} \\propto P_{\\mathrm{coll}}\n$$\nThe problem specifies that the distribution of encounter impact parameters is uniform over the cross-sectional area of the mutual Hill sphere. This implies that the probability of a collision during an encounter is the ratio of the collision cross-section, $\\sigma_{\\mathrm{coll}}$, to the encounter cross-section, which we take as the area of the mutual Hill sphere, $\\sigma_{\\mathrm{int}} = \\pi R_H^2$.\n$$\nP_{\\mathrm{coll}} = \\frac{\\sigma_{\\mathrm{coll}}}{\\sigma_{\\mathrm{int}}} = \\frac{\\sigma_{\\mathrm{coll}}}{\\pi R_H^2}\n$$\nThe collision cross-section for two bodies interacting via gravity is enhanced by gravitational focusing. For a physical collision to occur between two planets of radius $R_p$, their centers must approach within a distance of $R_c = 2 R_p$. The cross-section is given by the well-known formula:\n$$\n\\sigma_{\\mathrm{coll}} = \\pi R_c^2 \\left(1 + \\frac{v_{\\mathrm{esc, rel}}^2}{v_{\\infty}^2}\\right)\n$$\nwhere $v_\\infty$ is the relative velocity of the planets at large separation (infinity), and $v_{\\mathrm{esc, rel}}$ is the escape velocity at the contact distance $R_c$. In a two-body encounter between masses $M_1$ and $M_2$, the relevant term in the cross-section formula that defines the escape velocity is derived from conservation of energy and angular momentum, yielding a term $2G(M_1+M_2)/(R_c v_\\infty^2)$. A common convention, which is consistent with the derivation of the formula, defines an escape velocity $v_{\\mathrm{esc}}$ such that the focusing term is $1 + v_{\\mathrm{esc}}^2/v_\\infty^2$. For the encounter between two planets of mass $M_p$, the escape velocity from one planet felt by the other at a distance $R_c$ is $v_{\\mathrm{esc}}^2 = 2GM_p/R_c$. The full two-body derivation shows that the term in the parenthesis is more accurately $1 + 2G(M_p+M_p)/(R_c v_\\infty^2) = 1 + 4GM_p/(R_c v_\\infty^2)$. However, Option A uses $v_{\\mathrm{esc}}^2=2GM_p/R_c$, suggesting we should use the convention from the Öpik-Safronov collision probability theory, where the escape velocity is defined relative to the target body. Let's proceed with the form given in option A. Let's define $v_{\\mathrm{esc}}^2 = 2GM_p/R_c$. The gravitational focusing cross-section for a two-body encounter is derived from the impact parameter $b$ that leads to a minimum approach distance $r_{min} = R_c$. This is $b^2 = R_c^2(1 + 2GM_p/(R_c v_\\infty^2))$. So $\\sigma_{coll} = \\pi b^2 = \\pi R_c^2(1 + \\frac{v_{esc}^2}{v_\\infty^2})$. The form is correct.\n\nThe problem states that $v_\\infty$ is comparable to a characteristic local speed. For planets on nearly circular orbits, this speed is the Hill velocity, $v_H$, which is the orbital speed at the edge of the Hill sphere. Let's set $v_\\infty \\approx v_H$.\nThe mutual Hill radius for two equal-mass planets $M_p$ orbiting a star $M_*$ at distance $a$ is:\n$$\nR_H = a \\left(\\frac{2M_p}{3M_*}\\right)^{1/3}\n$$\nThe Hill velocity is $v_H = R_H \\Omega$, where $\\Omega = \\sqrt{GM_*/a^3}$ is the Keplerian orbital frequency.\n$$\nv_H^2 = R_H^2 \\Omega^2 = \\left[a \\left(\\frac{2M_p}{3M_*}\\right)^{1/3}\\right]^2 \\left(\\frac{GM_*}{a^3}\\right) = a^2 \\left(\\frac{2M_p}{3M_*}\\right)^{2/3} \\frac{GM_*}{a^3} = \\frac{GM_*}{a} \\left(\\frac{2M_p}{3M_*}\\right)^{2/3}\n$$\nNow we can express $P_{\\mathrm{coll}}$ in terms of these quantities:\n$$\nP_{\\mathrm{coll}} = \\frac{\\pi R_c^2 \\left(1 + \\frac{v_{\\mathrm{esc}}^2}{v_H^2}\\right)}{\\pi R_H^2} = \\left(\\frac{R_c}{R_H}\\right)^2 \\left(1 + \\frac{v_{\\mathrm{esc}}^2}{v_H^2}\\right)\n$$\nTo find the scaling with $a$, we examine the dependencies of each term:\n-   $R_c = 2R_p$ is a constant, independent of $a$.\n-   $R_H \\propto a$. Thus, $(R_c/R_H)^2 \\propto a^{-2}$.\n-   $v_{\\mathrm{esc}}^2 = 2GM_p/R_c$ is a constant, independent of $a$.\n-   $v_H^2 \\propto a^{-1}$. Thus, $v_{\\mathrm{esc}}^2/v_H^2 \\propto 1/a^{-1} = a$.\n\nSubstituting these scalings into the expression for $P_{\\mathrm{coll}}$:\n$$\n\\frac{P_{\\mathrm{coll}}}{P_{\\mathrm{ej}}} \\propto P_{\\mathrm{coll}} \\propto a^{-2} (1 + C \\cdot a) = C \\cdot a^{-1} + a^{-2}\n$$\nwhere $C$ is a constant combining all factors independent of $a$.\n\nLet's analyze the behavior of this function in two limits:\n1.  **Small $a$ limit ($a \\to 0$):** The term $a^{-2}$ grows much faster than $a^{-1}$. Therefore, the $a^{-2}$ term dominates. This corresponds to the regime of weak gravitational focusing, where the encounter velocity $v_H \\propto a^{-1/2}$ is high, so the planets' trajectories are not strongly deflected. The collision probability is dominated by the geometric cross-section.\n    $$ \\frac{P_{\\mathrm{coll}}}{P_{\\mathrm{ej}}} \\propto a^{-2} \\quad (\\text{for small } a) $$\n2.  **Large $a$ limit ($a \\to \\infty$):** The term $a^{-1}$ decays more slowly than $a^{-2}$. Therefore, the $a^{-1}$ term dominates. This corresponds to the regime of strong gravitational focusing, where the encounter velocity $v_H$ is low, and gravity has ample time to pull the planets together.\n    $$ \\frac{P_{\\mathrm{coll}}}{P_{\\mathrm{ej}}} \\propto a^{-1} \\quad (\\text{for large } a) $$\nOverall, the function $f(a) = C \\cdot a^{-1} + a^{-2}$ is a monotonically decreasing function for $a  0$. This means that the ratio of collision to ejection probability is highest at small $a$ and decreases as $a$ increases. This indicates that collisions are a more probable outcome relative to ejections in tightly-packed inner planetary systems, while ejections become relatively more dominant in wide-orbit outer systems.\n\n### Option-by-Option Analysis\n\n**A. $P_{\\mathrm{coll}}/P_{\\mathrm{ej}}$ scales approximately as $\\left(\\dfrac{R_p}{a}\\right)^2$ multiplied by a gravitational focusing factor that grows linearly with $a$, namely... Therefore, $P_{\\mathrm{coll}}/P_{\\mathrm{ej}}$ decreases with increasing $a$ roughly as $a^{-2}$ at small $a$ and as $a^{-1}$ when gravitational focusing dominates, implying that collisions are relatively common at small $a$ and suppress ejections, whereas at large $a$ collisions are rarer and ejections are more probable.**\n\n-   **Mathematical Formula:** The provided formula, $\\frac{P_{\\mathrm{coll}}}{P_{\\mathrm{ej}}}\\ \\propto\\ \\left(\\frac{R_c}{R_H}\\right)^2\\left[1+\\frac{v_{\\mathrm{esc}}^2}{v_H^2}\\right]$, and its expansion in terms of fundamental parameters, matches our derivation precisely. The definitions of $R_c$, $R_H$, $v_{\\mathrm{esc}}$, and $v_H$ are all standard and consistent.\n-   **Scaling Analysis:** The statement that the ratio scales as $a^{-2}$ at small $a$ and as $a^{-1}$ when gravitational focusing dominates (i.e., at large $a$) is perfectly consistent with our analysis of the derived function $C a^{-1} + a^{-2}$.\n-   **Physical Interpretation:** The interpretation that collisions are relatively more common at small $a$ and that ejections become the more probable outcome (relative to collisions) at large $a$ is a direct and correct consequence of the derived scaling relationship. The causal link that collisions \"suppress ejections\" is also physically sound, as the two outcomes are mutually exclusive for any given encounter.\n\n**Verdict: Correct.**\n\n**B. $P_{\\mathrm{coll}}/P_{\\mathrm{ej}}$ is independent of $a$ because encounter dynamics are scale-free in Hill units, so finite planetary radii do not alter the outcome statistics across different $a$.**\n\n-   **Analysis:** This statement is incorrect. The process of physical collision introduces a fixed physical length scale, the planetary radius $R_p$ (and thus the collision radius $R_c = 2R_p$). This scale does not change with $a$. In contrast, the Hill radius $R_H$ does scale with $a$ ($R_H \\propto a$). The ratio $R_c/R_H$, which is a dimensionless parameter governing the geometric collision probability, is therefore a function of $a$ ($R_c/R_H \\propto a^{-1}$). Because of this, the overall problem cannot be scale-free. The premise of the argument is flawed.\n\n**Verdict: Incorrect.**\n\n**C. $P_{\\mathrm{coll}}/P_{\\mathrm{ej}}$ increases with $a$ since gravitational focusing strengthens at large $a$, making collisions increasingly more likely than ejections as $a$ grows.**\n\n-   **Analysis:** While it is true that gravitational focusing becomes stronger at larger $a$ (because $v_H$ decreases), the conclusion is incorrect. The overall ratio $P_{\\mathrm{coll}}/P_{\\mathrm{ej}}$ is proportional to $P_{\\mathrm{coll}} \\propto (\\sigma_{\\mathrm{coll}}) / (\\pi R_H^2)$. The growth of the encounter area, $\\pi R_H^2 \\propto a^2$, is faster than the growth of the gravitationally focused collision cross-section, $\\sigma_{\\mathrm{coll}} \\propto a$ (in the focusing-dominated regime). As a result, the probability ratio is a decreasing function of $a$, not an increasing one.\n\n**Verdict: Incorrect.**\n\n**D. $P_{\\mathrm{coll}}/P_{\\mathrm{ej}}$ decreases exponentially with $a$ due to Keplerian shear exponentially suppressing small impact parameters at larger $a$, which overwhelms any gravitational focusing effects.**\n\n-   **Analysis:** The derived scaling relationship is a power law, not an exponential one. The physics of Keplerian shear is what gives rise to the characteristic encounter velocity being the Hill velocity $v_H$. Its effects are thus already incorporated in the power-law model and lead to a power-law scaling. There is no basis within the standard framework of two-body scattering to expect an exponential suppression of small impact parameters or an exponential scaling for the probability ratio.\n\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Theories of dynamical instability are not just abstract models; they make concrete predictions about the observable properties of exoplanet populations. One of the key \"scars\" of a past scattering event is the excitation of high orbital eccentricities. This final practice puts you in the role of an exoplanet scientist, tasking you with testing this hypothesis by analyzing mock datasets to search for the predicted correlation between tight orbital packing and dynamically \"hot\" eccentric orbits .",
            "id": "4169797",
            "problem": "You are given sets of planetary pairs from exoplanet systems. For each pair, the host star mass, planet masses, semi-major axes, and eccentricities are specified. Your task is to compute the normalized separation in mutual Hill radii, denoted by $\\Delta$, for each pair and to test, at the dataset level, whether systems with $\\Delta \\le 10$ exhibit higher eccentricities consistent with past scattering compared to systems with $\\Delta  10$. The test must be performed using a statistically sound, distribution-free method.\n\nFoundational base:\n- Use Newtonian gravity and the Hill sphere concept to derive the mutual Hill radius. For two planets with masses $m_1$ and $m_2$ orbiting a star of mass $M_\\star$, at semi-major axes $a_1$ and $a_2$ (with $a_2  a_1$), the mutual Hill radius $R_{\\mathrm{H}}$ is given by\n$$\nR_{\\mathrm{H}} = \\frac{a_1+a_2}{2} \\left(\\frac{m_1 + m_2}{3 M_\\star}\\right)^{1/3}.\n$$\n- The normalized separation is\n$$\n\\Delta = \\frac{a_2 - a_1}{R_{\\mathrm{H}}}.\n$$\n- The pair-level eccentricity metric $e_{\\mathrm{pair}}$ is defined as the larger of the two eccentricities: $e_{\\mathrm{pair}} = \\max(e_1, e_2)$.\n\nStatistical test:\n- Partition the planet pairs into two groups: $\\mathcal{G}_{\\mathrm{small}} = \\{ \\text{pairs} : \\Delta \\le 10 \\}$ and $\\mathcal{G}_{\\mathrm{large}} = \\{ \\text{pairs} : \\Delta  10 \\}$.\n- Use the one-sided Mann–Whitney U (MWU) test to test whether the distribution of $e_{\\mathrm{pair}}$ in $\\mathcal{G}_{\\mathrm{small}}$ tends to be larger than that in $\\mathcal{G}_{\\mathrm{large}}$. Report a boolean per dataset: return $\\mathrm{True}$ if both the MWU $p$-value is smaller than $0.05$ and the mean of $e_{\\mathrm{pair}}$ in $\\mathcal{G}_{\\mathrm{small}}$ is greater than the mean in $\\mathcal{G}_{\\mathrm{large}}$; otherwise return $\\mathrm{False}$. If either group is empty, return $\\mathrm{False}$.\n\nUnits:\n- $M_\\star$ must be in Solar masses.\n- $m_1$ and $m_2$ must be in Earth masses.\n- $a_1$ and $a_2$ must be in astronomical units (AU).\n- Eccentricities $e_1$ and $e_2$ are dimensionless numbers.\n- There are no angles in this problem.\n\nImplementation requirements:\n- Convert planet masses from Earth masses to Solar masses using $1\\,M_{\\oplus} = 3.003\\times 10^{-6}\\,M_{\\odot}$ before evaluating $R_{\\mathrm{H}}$.\n- For each dataset, compute all $\\Delta$ and $e_{\\mathrm{pair}}$ values, perform the MWU test, and generate the boolean output as specified.\n\nTest suite:\n- Dataset 1 (mixture, expected to show higher eccentricities in $\\mathcal{G}_{\\mathrm{small}}$):\n  - $(M_\\star, m_1, m_2, a_1, a_2, e_1, e_2) = (1.0, 300.0, 200.0, 0.9, 1.3, 0.15, 0.20)$\n  - $(1.0, 100.0, 80.0, 0.5, 0.62, 0.12, 0.15)$\n  - $(1.0, 5.0, 5.0, 0.3, 0.6, 0.03, 0.02)$\n  - $(1.0, 10.0, 12.0, 1.0, 2.5, 0.04, 0.05)$\n  - $(1.0, 260.0, 300.0, 5.0, 5.3, 0.35, 0.30)$\n  - $(1.0, 20.0, 30.0, 0.9, 1.8, 0.06, 0.08)$\n- Dataset 2 (boundary-included $\\Delta \\approx 10$, expected not to show higher eccentricities in $\\mathcal{G}_{\\mathrm{small}}$):\n  - $(1.0, 5.0, 5.0, 0.8925, 1.1075, 0.02, 0.03)$\n  - $(1.0, 5.0, 10.0, 0.5, 0.7, 0.10, 0.09)$\n  - $(1.0, 20.0, 20.0, 1.0, 1.18, 0.04, 0.04)$\n  - $(1.0, 10.0, 10.0, 0.2, 0.45, 0.08, 0.10)$\n  - $(1.0, 30.0, 40.0, 3.0, 3.25, 0.05, 0.07)$\n- Dataset 3 (varying host mass, expected to show higher eccentricities in $\\mathcal{G}_{\\mathrm{small}}$):\n  - $(0.8, 300.0, 200.0, 1.0, 1.3, 0.25, 0.22)$\n  - $(0.8, 260.0, 300.0, 5.0, 5.3, 0.35, 0.30)$\n  - $(0.8, 100.0, 80.0, 0.5, 0.62, 0.15, 0.12)$\n  - $(0.8, 10.0, 10.0, 0.2, 0.45, 0.03, 0.04)$\n  - $(0.8, 20.0, 30.0, 0.9, 1.8, 0.06, 0.07)$\n- Dataset 4 (edge case: all pairs have $\\Delta  10$, so $\\mathcal{G}_{\\mathrm{small}}$ is empty; must return $\\mathrm{False}$):\n  - $(1.0, 5.0, 6.0, 0.3, 0.9, 0.12, 0.08)$\n  - $(1.2, 8.0, 7.0, 1.5, 3.0, 0.14, 0.10)$\n  - $(0.9, 4.0, 5.0, 0.1, 0.3, 0.05, 0.07)$\n\nFinal output format:\n- Your program should produce a single line of output containing the boolean results for the four datasets as a comma-separated list enclosed in square brackets, for example, $[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{False}]$. The output values are pure booleans and have no units.",
            "solution": "The problem statement has been critically validated and is deemed to be self-contained, scientifically grounded, and well-posed. All data, formulas, and procedures are provided, allowing for a unique and verifiable solution. We shall proceed with the analysis.\n\nThe objective is to determine, for several datasets of exoplanet pairs, whether systems with small orbital separations exhibit statistically significant higher eccentricities, a potential signature of past dynamical scattering events. This involves calculating the normalized separation $\\Delta$ in mutual Hill radii and a pair-wise eccentricity metric $e_{\\mathrm{pair}}$, followed by a statistical comparison between two groups of systems.\n\nThe methodology is as follows:\n\n1.  For each planetary pair $(M_\\star, m_1, m_2, a_1, a_2, e_1, e_2)$, we first compute the pair-level eccentricity metric, $e_{\\mathrm{pair}}$, which is defined as the maximum of the two planetary eccentricities:\n    $$e_{\\mathrm{pair}} = \\max(e_1, e_2)$$\n\n2.  Next, we calculate the normalized separation $\\Delta$. This requires the mutual Hill radius, $R_{\\mathrm{H}}$. The planet masses, given in Earth masses ($M_{\\oplus}$), must be converted to Solar masses ($M_{\\odot}$) using the provided relation: $1\\,M_{\\oplus} = 3.003 \\times 10^{-6}\\,M_{\\odot}$. Let the masses in Solar units be $M_{1, \\odot}$ and $M_{2, \\odot}$.\n    The mutual Hill radius is then:\n    $$R_{\\mathrm{H}} = \\frac{a_1+a_2}{2} \\left(\\frac{M_{1, \\odot} + M_{2, \\odot}}{3 M_\\star}\\right)^{1/3}$$\n\n3.  With $R_{\\mathrm{H}}$, the normalized separation $\\Delta$ is calculated as:\n    $$\\Delta = \\frac{a_2 - a_1}{R_{\\mathrm{H}}}$$\n\n4.  Based on the value of $\\Delta$, each pair is assigned to one of two groups:\n    -   $\\mathcal{G}_{\\mathrm{small}} = \\{ \\text{pairs} : \\Delta \\le 10 \\}$\n    -   $\\mathcal{G}_{\\mathrm{large}} = \\{ \\text{pairs} : \\Delta  10 \\}$\n    The set of $e_{\\mathrm{pair}}$ values corresponding to these groups will be denoted as $E_{\\mathrm{small}}$ and $E_{\\mathrm{large}}$, respectively.\n\n5.  The core of the analysis is a statistical test. The problem specifies a boolean output for each dataset based on a two-part condition. A result of $\\mathrm{True}$ is returned if and only if both of the following conditions are met:\n    -   The arithmetic mean of the eccentricities in the small-separation group is strictly greater than that of the large-separation group: $\\mathrm{mean}(E_{\\mathrm{small}})  \\mathrm{mean}(E_{\\mathrm{large}})$.\n    -   A one-sided Mann-Whitney U (MWU) test, which tests the alternative hypothesis that the distribution of $E_{\\mathrm{small}}$ is stochastically larger than that of $E_{\\mathrm{large}}$, yields a $p$-value strictly less than $0.05$.\n\n6.  As a boundary condition, if either $\\mathcal{G}_{\\mathrm{small}}$ or $\\mathcal{G}_{\\mathrm{large}}$ is empty for a given dataset, the result for that dataset is immediately $\\mathrm{False}$.\n\nLet us perform a detailed analysis for Dataset 1 to illustrate the procedure. The dataset consists of 6 planetary pairs.\n\n-   Pair 1: $(1.0, 300.0, 200.0, 0.9, 1.3, 0.15, 0.20)$\n    $m_1 + m_2 = 500.0\\,M_\\oplus = 1.5015 \\times 10^{-3}\\,M_\\odot$.\n    $R_{\\mathrm{H}} = \\frac{0.9+1.3}{2} (\\frac{1.5015 \\times 10^{-3}}{3 \\times 1.0})^{1/3} \\approx 0.0873\\,\\text{AU}$.\n    $\\Delta = \\frac{1.3-0.9}{0.0873} \\approx 4.58$. Since $\\Delta \\le 10$, this pair belongs to $\\mathcal{G}_{\\mathrm{small}}$.\n    $e_{\\mathrm{pair}} = \\max(0.15, 0.20) = 0.20$.\n\n-   Pair 5: $(1.0, 260.0, 300.0, 5.0, 5.3, 0.35, 0.30)$\n    $m_1 + m_2 = 560.0\\,M_\\oplus = 1.68168 \\times 10^{-3}\\,M_\\odot$.\n    $R_{\\mathrm{H}} = \\frac{5.0+5.3}{2} (\\frac{1.68168 \\times 10^{-3}}{3 \\times 1.0})^{1/3} \\approx 0.3040\\,\\text{AU}$.\n    $\\Delta = \\frac{5.3-5.0}{0.3040} \\approx 0.99$. Since $\\Delta \\le 10$, this pair belongs to $\\mathcal{G}_{\\mathrm{small}}$.\n    $e_{\\mathrm{pair}} = \\max(0.35, 0.30) = 0.35$.\n\nApplying this procedure to all pairs in Dataset 1 yields the following partition:\n-   $E_{\\mathrm{small}} = \\{0.20, 0.15, 0.35\\}$ from pairs with $\\Delta \\approx \\{4.58, 3.71, 0.99\\}$.\n-   $E_{\\mathrm{large}} = \\{0.03, 0.05, 0.08\\}$ from pairs with $\\Delta \\approx \\{30.71, 30.62, 19.10\\}$.\n\nNow, we apply the decision criteria:\n-   $\\mathrm{mean}(E_{\\mathrm{small}}) = (0.20+0.15+0.35)/3 \\approx 0.233$.\n-   $\\mathrm{mean}(E_{\\mathrm{large}}) = (0.03+0.05+0.08)/3 \\approx 0.053$.\nThe condition $\\mathrm{mean}(E_{\\mathrm{small}})  \\mathrm{mean}(E_{\\mathrm{large}})$ is satisfied.\n\n-   Next, we perform the one-sided Mann-Whitney U test on $E_{\\mathrm{small}}$ and $E_{\\mathrm{large}}$. For these two samples of size $n_1=3$ and $n_2=3$, the data are perfectly separated by rank, which represents the most extreme possible outcome. The number of ways to arrange the 6 combined samples is $\\binom{6}{3} = 20$. The observed extreme case occurs only once. Therefore, the exact one-tailed $p$-value for this most-extreme outcome is $p = 1/20 = 0.05$.\n\nThe decision rule requires the $p$-value to be strictly smaller than $0.05$. Since our calculated $p$-value is $0.05$, the condition $p  0.05$ is not met. Consequently, the result for Dataset 1 is $\\mathrm{False}$.\n\nA crucial insight here is that for certain small sample sizes, it is mathematically impossible to achieve a $p$-value less than the conventional significance level of $\\alpha = 0.05$. For sample sizes $(3, 3)$, the minimum possible $p$-value is $0.05$. For Dataset 3, with sample sizes $(3, 2)$, the minimum possible $p$-value is $1/\\binom{5}{2} = 0.1$. In these cases, the null hypothesis can never be rejected at the specified significance level, regardless of how separated the data are. This lack of statistical power is a direct consequence of the small number of data points.\n\nThe final boolean results for all datasets are derived by strict adherence to the specified procedure.\n-   **Dataset 1:** Result is $\\mathrm{False}$ ($p=0.05$, not $ 0.05$).\n-   **Dataset 2:** Result is $\\mathrm{False}$ (mean condition fails: $0.047 \\ngtr 0.1$).\n-   **Dataset 3:** Result is $\\mathrm{False}$ ($p=0.1$, not $ 0.05$).\n-   **Dataset 4:** Result is $\\mathrm{False}$ ($\\mathcal{G}_{\\mathrm{small}}$ is empty).\n\nTherefore, based on a rigorous application of the stated rules, none of the datasets meet the criteria for a $\\mathrm{True}$ outcome.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import mannwhitneyu\n\ndef solve():\n    \"\"\"\n    Main function to process datasets and print results.\n    \"\"\"\n    \n    # Conversion constant from Earth mass to Solar mass.\n    M_EARTH_TO_SOLAR = 3.003e-6\n\n    # Test suite of four datasets.\n    # Each tuple represents a planetary pair:\n    # (M_star, m1, m2, a1, a2, e1, e2)\n    # M_star in Solar masses, m1/m2 in Earth masses, a1/a2 in AU.\n    test_suite = [\n        # Dataset 1\n        [\n            (1.0, 300.0, 200.0, 0.9, 1.3, 0.15, 0.20),\n            (1.0, 100.0, 80.0, 0.5, 0.62, 0.12, 0.15),\n            (1.0, 5.0, 5.0, 0.3, 0.6, 0.03, 0.02),\n            (1.0, 10.0, 12.0, 1.0, 2.5, 0.04, 0.05),\n            (1.0, 260.0, 300.0, 5.0, 5.3, 0.35, 0.30),\n            (1.0, 20.0, 30.0, 0.9, 1.8, 0.06, 0.08),\n        ],\n        # Dataset 2\n        [\n            (1.0, 5.0, 5.0, 0.8925, 1.1075, 0.02, 0.03),\n            (1.0, 5.0, 10.0, 0.5, 0.7, 0.10, 0.09),\n            (1.0, 20.0, 20.0, 1.0, 1.18, 0.04, 0.04),\n            (1.0, 10.0, 10.0, 0.2, 0.45, 0.08, 0.10),\n            (1.0, 30.0, 40.0, 3.0, 3.25, 0.05, 0.07),\n        ],\n        # Dataset 3\n        [\n            (0.8, 300.0, 200.0, 1.0, 1.3, 0.25, 0.22),\n            (0.8, 260.0, 300.0, 5.0, 5.3, 0.35, 0.30),\n            (0.8, 100.0, 80.0, 0.5, 0.62, 0.15, 0.12),\n            (0.8, 10.0, 10.0, 0.2, 0.45, 0.03, 0.04),\n            (0.8, 20.0, 30.0, 0.9, 1.8, 0.06, 0.07),\n        ],\n        # Dataset 4\n        [\n            (1.0, 5.0, 6.0, 0.3, 0.9, 0.12, 0.08),\n            (1.2, 8.0, 7.0, 1.5, 3.0, 0.14, 0.10),\n            (0.9, 4.0, 5.0, 0.1, 0.3, 0.05, 0.07),\n        ],\n    ]\n\n    def process_dataset(dataset):\n        \"\"\"\n        Processes a single dataset of planetary pairs.\n        \"\"\"\n        e_pair_small = []\n        e_pair_large = []\n\n        for pair in dataset:\n            m_star, m1_earth, m2_earth, a1, a2, e1, e2 = pair\n\n            # Convert planet masses to Solar masses\n            m1_solar = m1_earth * M_EARTH_TO_SOLAR\n            m2_solar = m2_earth * M_EARTH_TO_SOLAR\n            \n            # Calculate mutual Hill radius\n            mass_ratio_term = (m1_solar + m2_solar) / (3 * m_star)\n            r_hill = ((a1 + a2) / 2) * (mass_ratio_term**(1/3))\n\n            # Calculate normalized separation, avoiding division by zero\n            if r_hill == 0:\n                # This case shouldn't happen with given data but is good practice\n                delta = float('inf')\n            else:\n                delta = (a2 - a1) / r_hill\n            \n            # Calculate pair-level eccentricity\n            e_pair = max(e1, e2)\n\n            # Partition the pair into groups based on delta\n            if delta = 10:\n                e_pair_small.append(e_pair)\n            else:\n                e_pair_large.append(e_pair)\n        \n        # If either group is empty, the result is False\n        if not e_pair_small or not e_pair_large:\n            return False\n\n        # Convert lists to numpy arrays for mean calculation\n        e_small_np = np.array(e_pair_small)\n        e_large_np = np.array(e_pair_large)\n\n        # Check if the mean of the small group is greater than the large group\n        mean_condition = np.mean(e_small_np)  np.mean(e_large_np)\n        \n        # Perform one-sided Mann-Whitney U test\n        # alternative='greater' tests if x is stochastically larger than y\n        try:\n            _, p_value = mannwhitneyu(e_small_np, e_large_np, alternative='greater')\n        except ValueError:\n            # This can happen if all values in one sample are the same,\n            # though not the case with the given test data.\n            return False\n\n        # The p-value must be strictly less than 0.05\n        p_value_condition = p_value  0.05\n\n        # Return True only if both conditions are met\n        return mean_condition and p_value_condition\n\n    results = [process_dataset(ds) for ds in test_suite]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}