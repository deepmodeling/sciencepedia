{
    "hands_on_practices": [
        {
            "introduction": "角动量输运是星周盘和环行星盘物理学中的核心问题，它决定了气体如何向内吸积并设定了盘的整体演化。虽然湍流被认为是主要的输运机制，并通常用Shakura-Sunyaev参数 $\\alpha$ 来量化，但其物理来源在盘的许多区域仍不确定。本练习将引导您通过编码实践，探索立式剪切不稳定性（Vertical Shear Instability, VSI）——一种在盘的冷外部区域中产生湍流的有力机制，并学习如何根据基本物理原理评估其活动性及所产生的湍流强度。",
            "id": "4155716",
            "problem": "您正在为一个环行星盘中垂直剪切不稳定性（vertical shear instability）的运行条件进行建模，并且希望从第一性原理出发，在给定的热力学和动力学条件下，判断线性不稳定性是否可能发生，然后估算其湍流水平，以 Shakura–Sunyaev 应力参数来表示。您必须实现一个程序，对一组测试用例进行评估，判断垂直剪切不稳定性是否能够运行，如果可以，则估算其诱发的 Shakura–Sunyaev 参数。该程序必须基于以下有物理动机且广泛使用的要素来做出判断，不得使用任何未经证实的简化方法：\n\n- 理想气体关系式以及开普勒盘中轨道动力学的定义：声速 $c_s$、开普勒速度 $v_K$、开普勒角频率 $\\Omega$ 以及盘的标高比 $h$，定义为 $h = H/R = c_s/v_K$。\n- 径向温度梯度通过 $q \\equiv d \\ln T / d \\ln R$ 定义了斜压驱动，该值可由 $dT/dR$ 计算得出，即 $q = (R/T)\\,(dT/dR)$。\n- 垂直浮力的去稳化受冷却限制，其弛豫时间尺度为 $\\tau_{\\mathrm{cool}}$，该时间尺度通过一个线性不透明度敏感性模型依赖于尘埃含量：$\\tau_{\\mathrm{cool}} = \\tau_0\\,(1 + A f_d)$，其中 $f_d$ 是中平面的尘气质量比，$\\tau_0$ 是零尘埃时的基准冷却时间，而 $A$ 是一个固定的不透明度敏感性因子。\n- 不稳定性运行的一个必要线性判据，表示为一个无量纲不等式 $\\Omega\\,\\tau_{\\mathrm{cool}}  \\beta_{\\mathrm{crit}}$，其中临界阈值 $\\beta_{\\mathrm{crit}}$ 仅通过 $\\beta_{\\mathrm{crit}} = h/|q|$ 依赖于局域热力学。这表明，更强的温度梯度和更“蓬松”的盘更容易引发垂直剪切，而较慢的冷却会抑制它。如果 $|q| = 0$，则不允许该不稳定性发生。\n\n如果不等式不满足，则认为不稳定性无法运行，湍流应力参数必须设为零。如果不等式满足，您必须估算最快的线性增长率，然后使用以下基于物理的标度关系估算饱和应力参数：\n\n- 最快线性增长率模型为 $\\sigma = c_g\\,|q|\\,h\\,\\Omega\\,\\sqrt{1 - (\\Omega\\,\\tau_{\\mathrm{cool}})/\\beta_{\\mathrm{crit}}}$，该模型在冷却迅速时恢复为 $\\sigma \\propto |q|\\,h\\,\\Omega$，并在阈值处连续消失。正常数 $c_g$ 是一个增长效率因子，其值在下文指定。\n- 基于 $\\alpha \\sim (l/H)\\,(v_t/c_s)$ 的 Shakura–Sunyaev 参数 $\\alpha$ 的混合长闭合，其中湍流速度 $v_t \\sim \\chi\\,(\\sigma/\\Omega)\\,c_s$，外部湍流尺度 $l \\sim H/(2\\pi)$，给出估算值 $\\alpha = (\\chi/(2\\pi))\\,(\\sigma/\\Omega)$。无量纲常数 $\\chi$ 是一个饱和效率参数，其值在下文指定。\n\n使用以下常数和参数：\n- 引力常数 $G = 6.6743 \\times 10^{-11}\\ \\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$。\n- 玻尔兹曼常数 $k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$。\n- 氢原子质量单位 $m_H = 1.6735575 \\times 10^{-27}\\ \\mathrm{kg}$。\n- 平均分子量 $\\mu = 2.34$（无量纲）。\n- 绝热指数 $\\gamma = 1.4$（无量纲），在需要时使用。\n- 不透明度敏感性因子 $A = 20$（无量纲）。\n- 增长效率因子 $c_g = 0.5$（无量纲）。\n- 饱和效率因子 $\\chi = 0.5$（无量纲）。\n\n对于每个测试用例，输入为行星质量 $M_p$（单位 $\\mathrm{kg}$），轨道半径 $R$（单位 $\\mathrm{m}$），局域温度 $T$（单位 $\\mathrm{K}$），径向温度梯度 $dT/dR$（单位 $\\mathrm{K\\,m^{-1}}$），尘气比 $f_d$（无量纲），以及基准冷却时间 $\\tau_0$（单位 $\\mathrm{s}$）。根据这些输入，计算：\n- $q = (R/T)\\,(dT/dR)$（无量纲）。\n- $c_s = \\sqrt{k_B T / (\\mu m_H)}$（单位 $\\mathrm{m\\,s^{-1}}$）。\n- $v_K = \\sqrt{G M_p / R}$（单位 $\\mathrm{m\\,s^{-1}}$）。\n- $\\Omega = v_K / R$（单位 $\\mathrm{s^{-1}}$）。\n- $h = c_s / v_K$（无量纲）。\n- $\\tau_{\\mathrm{cool}} = \\tau_0\\,(1 + A f_d)$（单位 $\\mathrm{s}$）。\n- $\\beta_{\\mathrm{crit}} = h/|q|$（无量纲），如果 $|q|  0$；如果 $|q|=0$，则不允许不稳定性发生。\n- 不稳定性检查：如果 $\\Omega\\,\\tau_{\\mathrm{cool}}  \\beta_{\\mathrm{crit}}$，则为活跃；否则为不活跃。\n- 如果活跃，则 $\\sigma = c_g\\,|q|\\,h\\,\\Omega\\,\\sqrt{1 - (\\Omega\\,\\tau_{\\mathrm{cool}})/\\beta_{\\mathrm{crit}}}$（单位 $\\mathrm{s^{-1}}$）且 $\\alpha = (\\chi/(2\\pi))\\,(\\sigma/\\Omega)$（无量纲）。如果不活跃，则 $\\alpha = 0$。\n\n您的程序必须为以下测试套件计算一个结果列表。对于每个测试用例，输出一个包含两个元素的列表：\n- 一个布尔值，指示不稳定性是否活跃（活跃为 True，否则为 False）。\n- $\\alpha$ 的值，四舍五入到六位有效数字（无量纲）。\n\n需要实现的测试套件是：\n- 案例 1：$M_p = 1.898 \\times 10^{27}\\ \\mathrm{kg}$，$R = 2.1 \\times 10^{9}\\ \\mathrm{m}$，$T = 200\\ \\mathrm{K}$，$dT/dR = -1.0 \\times 10^{-7}\\ \\mathrm{K\\,m^{-1}}$，$f_d = 0.01$，$\\tau_0 = 1.0 \\times 10^{4}\\ \\mathrm{s}$。\n- 案例 2（接近阈值的冷却）：$M_p = 1.898 \\times 10^{27}\\ \\mathrm{kg}$，$R = 2.1 \\times 10^{9}\\ \\mathrm{m}$，$T = 200\\ \\mathrm{K}$，$dT/dR = -1.0 \\times 10^{-7}\\ \\mathrm{K\\,m^{-1}}$，$f_d = 0.0$，$\\tau_0 = 2.92 \\times 10^{4}\\ \\mathrm{s}$。\n- 案例 3（无斜压驱动）：$M_p = 1.898 \\times 10^{27}\\ \\mathrm{kg}$，$R = 2.1 \\times 10^{9}\\ \\mathrm{m}$，$T = 200\\ \\mathrm{K}$，$dT/dR = 0.0\\ \\mathrm{K\\,m^{-1}}$，$f_d = 0.10$，$\\tau_0 = 1.0 \\times 10^{4}\\ \\mathrm{s}$。\n- 案例 4（外盘，更强的 $|q|$）：$M_p = 1.898 \\times 10^{27}\\ \\mathrm{kg}$，$R = 4.2 \\times 10^{9}\\ \\mathrm{m}$，$T = 120\\ \\mathrm{K}$，$dT/dR = -5.0 \\times 10^{-8}\\ \\mathrm{K\\,m^{-1}}$，$f_d = 0.02$，$\\tau_0 = 1.0 \\times 10^{4}\\ \\mathrm{s}$。\n- 案例 5（高尘埃含量，长冷却时间）：$M_p = 1.898 \\times 10^{27}\\ \\mathrm{kg}$，$R = 2.1 \\times 10^{9}\\ \\mathrm{m}$，$T = 200\\ \\mathrm{K}$，$dT/dR = -1.0 \\times 10^{-7}\\ \\mathrm{K\\,m^{-1}}$，$f_d = 5.0$，$\\tau_0 = 1.0 \\times 10^{4}\\ \\mathrm{s}$。\n- 案例 6（较低质量行星，更容易满足的判据）：$M_p = 3.796 \\times 10^{26}\\ \\mathrm{kg}$，$R = 2.1 \\times 10^{9}\\ \\mathrm{m}$，$T = 200\\ \\mathrm{K}$，$dT/dR = -1.0 \\times 10^{-7}\\ \\mathrm{K\\,m^{-1}}$，$f_d = 0.10$，$\\tau_0 = 1.0 \\times 10^{4}\\ \\mathrm{s}$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素本身都是 [active_boolean,alpha_value] 形式的双元素列表。例如：“[[True,0.001234],[False,0.0],...]”。$\\alpha$ 值必须四舍五入到六位有效数字，并表示为十进制浮点数（无量纲）。",
            "solution": "该问题要求评估环行星盘中垂直剪切不稳定性（VSI）的条件，并估算由此产生的湍流应力，该应力由 Shakura–Sunyaev 参数 $\\alpha$ 量化。该解决方案遵循一个确定性的计算序列，该序列基于一个简化的盘热力学和动力学物理模型。\n\n分析始于根据每个测试用例给定的输入参数计算基本的局域盘属性：行星质量 $M_p$、轨道半径 $R$、局域温度 $T$、径向温度梯度 $dT/dR$、尘气比 $f_d$ 和基准冷却时间 $\\tau_0$。\n\n首先，我们确定气体的热力学和运动学状态。等温声速 $c_s$ 由局域温度和气体成分决定。对于理想气体，其计算公式为：\n$$c_s = \\sqrt{\\frac{k_B T}{\\mu m_H}}$$\n其中 $k_B$ 是玻尔兹曼常数，$\\mu$ 是平均分子量，$m_H$ 是氢原子的质量。\n\n动力学由中心行星的引力主导。距离质量为 $M_p$ 的行星半径为 $R$ 处的开普勒轨道速度 $v_K$ 为：\n$$v_K = \\sqrt{\\frac{G M_p}{R}}$$\n其中 $G$ 是引力常数。相应的开普勒角频率 $\\Omega$ 为：\n$$\\Omega = \\frac{v_K}{R} = \\sqrt{\\frac{G M_p}{R^3}}$$\n\n盘的一个关键结构参数是其垂直厚度相对于其半径的比值，称为盘的标高比 $h$。它被定义为气体压力标高 $H$ 与半径 $R$ 的比值，这等同于声速与开普勒速度的比值：\n$$h = \\frac{H}{R} = \\frac{c_s}{v_K}$$\n\nVSI 的驱动力是源于径向温度梯度的斜压性。这由无量纲参数 $q$ 量化：\n$$q \\equiv \\frac{d \\ln T}{d \\ln R} = \\frac{R}{T} \\frac{dT}{dR}$$\n$q$ 的负值表示温度随半径减小，这是天体物理盘中的常见情况，并且是该不稳定性所必需的。如果 $q=0$，则没有斜压驱动项，不稳定性无法运行，导致 $\\alpha=0$。\n\nVSI 是一种热不稳定性，其运行取决于气体能否有效冷却。热弛豫时间，即冷却时间 $\\tau_{\\mathrm{cool}}$，必须足够短。问题提供了一个模型，其中由于不透明度的增加，冷却时间随尘气比 $f_d$ 的增加而增加：\n$$\\tau_{\\mathrm{cool}} = \\tau_0 (1 + A f_d)$$\n其中 $\\tau_0$ 是无尘气体中的基准冷却时间，A 是不透明度敏感性因子。\n\nVSI 的线性稳定性判据以一个不等式给出，该不等式涉及无量纲冷却时间 $\\Omega \\tau_{\\mathrm{cool}}$ 和一个临界阈值 $\\beta_{\\mathrm{crit}}$。只有当冷却足够快时，即无量纲冷却时间低于临界阈值时，不稳定性才能增长：\n$$\\Omega \\tau_{\\mathrm{cool}}  \\beta_{\\mathrm{crit}}$$\n临界阈值 $\\beta_{\\mathrm{crit}}$ 本身取决于盘的局域热力学性质。具有更强斜压性（更大的 $|q|$）和更大相对厚度（更大的 $h$）的盘更容易受到不稳定性的影响，这由以下关系捕获：\n$$\\beta_{\\mathrm{crit}} = \\frac{h}{|q|}$$\n这在 $|q|  0$ 时有效。\n\n如果不满足不稳定性判据，则盘是稳定的，湍流应力参数为 $\\alpha = 0$。如果满足判据，则不稳定性是活跃的。然后使用提供的模型估算最快的线性增长率 $\\sigma$：\n$$\\sigma = c_g |q| h \\Omega \\sqrt{1 - \\frac{\\Omega \\tau_{\\mathrm{cool}}}{\\beta_{\\mathrm{crit}}}}$$\n这里，$c_g$ 是一个增长效率因子。该公式正确地表明，在非常短的冷却时间（$\\tau_{\\mathrm{cool}} \\to 0$）下增长率最大，并且当冷却时间接近临界值（$\\Omega \\tau_{\\mathrm{cool}} \\to \\beta_{\\mathrm{crit}}$）时消失。\n\n最后，使用混合长闭合来估算饱和湍流应力，由 Shakura–Sunyaev 参数 $\\alpha$ 表示。这将应力与湍流速度和湍流的特征长度尺度联系起来。提供的标度关系为：\n$$\\alpha = \\frac{\\chi}{2\\pi} \\frac{\\sigma}{\\Omega}$$\n其中 $\\chi$ 是一个饱和效率参数。该估算将不稳定性的线性增长率与最终的湍流非线性饱和状态联系起来。\n\n每个测试用例的计算过程如下：\n1. 根据输入参数和物理常数计算 $q$、$c_s$、$v_K$、$\\Omega$、$h$ 和 $\\tau_{\\mathrm{cool}}$。\n2. 检查 $|q|$ 是否等于 0。如果是，则不稳定性不活跃，$\\alpha = 0.0$。\n3. 如果 $|q|  0$，计算 $\\beta_{\\mathrm{crit}} = h/|q|$。\n4. 评估不稳定性判据：$\\Omega \\tau_{\\mathrm{cool}}  \\beta_{\\mathrm{crit}}$。\n5. 如果不满足判据，则不稳定性不活跃，$\\alpha = 0.0$。\n6. 如果满足判据，则不稳定性活跃。使用相应公式计算增长率 $\\sigma$，然后计算应力参数 $\\alpha$。\n7. $\\alpha$ 的最终值四舍五入到六位有效数字。\n8. 该案例的输出是一个列表，包含一个表示活跃状态的布尔值和计算出的 $\\alpha$ 值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Evaluates the conditions for vertical shear instability in a circumplanetary disk\n    and estimates the Shakura-Sunyaev stress parameter alpha for a suite of test cases.\n    \"\"\"\n\n    # Physical and model constants\n    G = 6.6743e-11        # Gravitational constant (m^3 kg^-1 s^-2)\n    KB = 1.380649e-23       # Boltzmann constant (J K^-1)\n    MH = 1.6735575e-27      # Atomic mass unit of hydrogen (kg)\n    MU = 2.34               # Mean molecular weight\n    A = 20.0                # Opacity sensitivity factor\n    C_G = 0.5               # Growth efficiency factor\n    CHI = 0.5               # Saturation efficiency factor\n\n    # Test cases\n    test_cases = [\n        # Case 1: Standard case\n        (1.898e27, 2.1e9, 200, -1.0e-7, 0.01, 1.0e4),\n        # Case 2: Near-threshold cooling\n        (1.898e27, 2.1e9, 200, -1.0e-7, 0.0, 2.92e4),\n        # Case 3: No baroclinic driver\n        (1.898e27, 2.1e9, 200, 0.0, 0.10, 1.0e4),\n        # Case 4: Outer disk, stronger |q|\n        (1.898e27, 4.2e9, 120, -5.0e-8, 0.02, 1.0e4),\n        # Case 5: High dust, long cooling\n        (1.898e27, 2.1e9, 200, -1.0e-7, 5.0, 1.0e4),\n        # Case 6: Lower-mass planet\n        (3.796e26, 2.1e9, 200, -1.0e-7, 0.10, 1.0e4),\n    ]\n\n    results = []\n\n    def round_to_sf(x, sf):\n        \"\"\"Rounds a number x to a specified number of significant figures sf.\"\"\"\n        if x == 0:\n            return 0.0\n        # Calculate the number of decimal places needed for rounding\n        # np.floor(np.log10(np.abs(x))) gives the order of magnitude\n        # e.g. for 123 it is 2, for 0.0123 it is -2\n        round_to_dp = sf - 1 - int(np.floor(np.log10(np.abs(x))))\n        return np.round(x, round_to_dp)\n\n    for case in test_cases:\n        m_p, r, t, dt_dr, f_d, tau_0 = case\n\n        # Calculate intermediate parameters\n        q = (r / t) * dt_dr\n        abs_q = np.abs(q)\n\n        # If no baroclinic driver, instability is disallowed\n        if abs_q == 0:\n            is_active = False\n            alpha = 0.0\n            results.append([is_active, alpha])\n            continue\n\n        c_s = np.sqrt(KB * t / (MU * MH))\n        v_k = np.sqrt(G * m_p / r)\n        omega = v_k / r\n        h = c_s / v_k\n        tau_cool = tau_0 * (1.0 + A * f_d)\n        \n        # Calculate instability threshold\n        beta_crit = h / abs_q\n        \n        # Check instability criterion\n        is_active = (omega * tau_cool)  beta_crit\n\n        if is_active:\n            # Calculate growth rate sigma\n            sqrt_term = np.sqrt(1.0 - (omega * tau_cool) / beta_crit)\n            sigma = C_G * abs_q * h * omega * sqrt_term\n            \n            # Calculate alpha\n            alpha_raw = (CHI / (2.0 * np.pi)) * (sigma / omega)\n            alpha = round_to_sf(alpha_raw, 6)\n        else:\n            alpha = 0.0\n            \n        results.append([is_active, alpha])\n\n    # Format the final output string exactly as required, with no spaces\n    output_str = str(results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "在气体盘中形成卫星的第一步是将微米级的尘埃颗粒聚集成千米大小的星子。这个过程面临着巨大的障碍，但“流不稳定性”（Streaming Instability, SI）提供了一个有力的解决方案，它能够将尘埃颗粒在局部区域集中到足以引发引力坍缩的密度。本练习将指导您建立一个环行星盘的尘埃-气体动力学模型，并应用天体物理学中广泛使用的判据，通过编程来确定流不稳定性在盘中何处能够被触发，从而为卫星的诞生定位“育婴室”。",
            "id": "4155782",
            "problem": "要求您设计并实现一个完整、可运行的程序，以评估流体不稳定性在环行星盘（CPD）中的触发位置，并为多个测试案例返回满足触发条件的半径集合。您的解决方案必须基于基本定义和经过充分检验的物理关系，并且必须明确说明并一致地使用单位。输出必须是包含所有测试案例结果的单行文本，按如下指定的方式聚合。\n\n物理设置为一个几何薄的环行星盘，围绕一颗质量为 $M_p$ 的行星进行开普勒旋转。假设盘在垂直方向上是等温的，并处于流体静力学平衡状态，应用以下基本原理：\n\n- 牛顿引力，引力常数为 $G$，开普勒角频率为 $\\Omega_K(r) = \\sqrt{G M_p / r^3}$，开普勒轨道速度为 $v_K(r) = r \\, \\Omega_K(r)$。\n- 理想气体，等温声速为 $c_s(r) = \\sqrt{k_B T(r) / (\\mu m_p)}$，其中 $k_B$ 是玻尔兹曼常数，$m_p$ 是质子质量，$\\mu$ 是平均分子量。\n- 垂直流体静力学平衡产生高斯垂直密度分布，其标高为 $H(r) = c_s(r) / \\Omega_K(r)$，中平面气体密度为 $\\rho_{g,0}(r) = \\Sigma_g(r) / \\left( \\sqrt{2 \\pi} \\, H(r) \\right)$，其中 $\\Sigma_g(r)$ 是气体表面密度。\n- 对于处于 Epstein 阻力区的小固体，其停止时间为 $t_s(r,s) = \\dfrac{\\rho_s s}{\\rho_{g,0}(r) \\, v_{\\mathrm{th}}(r)}$，其中 $s$ 是颗粒半径，$\\rho_s$ 是固体的内部密度，平均热速度为 $v_{\\mathrm{th}}(r) = \\sqrt{\\dfrac{8}{\\pi}} \\, c_s(r)$。斯托克斯数（Stokes number）为 $St(r,s) = \\Omega_K(r) \\, t_s(r,s)$。\n- 在稳态下，垂直湍流扩散由 Shakura–Sunyaev 湍流扩散系数参数 $\\alpha$ 参数化，尘埃标高为 $H_d(r) = H(r) \\, \\sqrt{\\dfrac{\\alpha}{\\alpha + St(r,s)}}$，中平面尘埃与气体密度比为 $\\epsilon_{\\mathrm{mid}}(r) = \\dfrac{\\rho_{d,0}(r)}{\\rho_{g,0}(r)} = \\dfrac{\\Sigma_d(r)}{\\Sigma_g(r)} \\, \\dfrac{H(r)}{H_d(r)}$，其中 $\\Sigma_d(r)$ 是尘埃表面密度。将局部金属丰度定义为 $Z(r) \\equiv \\Sigma_d(r)/\\Sigma_g(r)$。\n\n采用在原行星盘和环行星盘中触发流体不稳定性的广泛使用的阈值：\n\n- 空气动力学耦合必须在一个有利的窗口内：$St_{\\min} \\le St(r,s) \\le St_{\\max}$，其中 $St_{\\min} = 10^{-2}$ 且 $St_{\\max} = 1$。\n- 中平面的尘埃富集必须足够：$\\epsilon_{\\mathrm{mid}}(r) \\ge 1$。\n\n在这些假设下，按以下步骤进行：\n\n- 使用参数化的环行星盘结构：\n  - 气体表面密度分布 $\\Sigma_g(r) = \\Sigma_0 \\left( \\dfrac{r}{r_0} \\right)^{-p}$。\n  - 温度分布 $T(r) = T_0 \\left( \\dfrac{r}{r_0} \\right)^{-q}$。\n- 尘埃表面密度由基准金属丰度和一个环状增强结构参数化：\n  - $\\Sigma_d(r) = Z_0 \\, \\Sigma_g(r) \\left[ 1 + A \\, \\exp \\left( - \\dfrac{(r - r_{\\mathrm{ring}})^2}{2 w^2} \\right) \\right]$,\n  其中 $A$ 是无量纲振幅，$r_{\\mathrm{ring}}$ 是环中心半径，$w$ 是环宽度。\n\n您的程序必须：\n\n- 使用以下常数 $G = 6.67430 \\times 10^{-11} \\ \\mathrm{m^3 \\, kg^{-1} \\, s^{-2}}$，$k_B = 1.380649 \\times 10^{-23} \\ \\mathrm{J \\, K^{-1}}$，$m_p = 1.67262192369 \\times 10^{-27} \\ \\mathrm{kg}$。\n- 使用以下行星和单位常数 $M_J = 1.898 \\times 10^{27} \\ \\mathrm{kg}$ 和 $R_J = 7.1492 \\times 10^{7} \\ \\mathrm{m}$，并设置 $M_p = M_J$。\n- 使用平均分子量 $\\mu = 2.34$ 和固体密度 $\\rho_s = 1500 \\ \\mathrm{kg \\, m^{-3}}$。\n- 使用环行星盘参数 $r_0 = 10 R_J$，$\\Sigma_0 = 2 \\times 10^{4} \\ \\mathrm{kg \\, m^{-2}}$，$T_0 = 400 \\ \\mathrm{K}$，$p = 1$ 和 $q = 0.5$。\n- 在一个从 $r_{\\min} = 5 R_J$ 到 $r_{\\max} = 100 R_J$ 的均匀径向网格上进行评估，网格点数为 $N = 50$。\n- 如前所述，一致地应用 Epstein 区的公式。\n- 在 $St_{\\min} \\le St(r,s) \\le St_{\\max}$ 和 $\\epsilon_{\\mathrm{mid}}(r) \\ge 1$ 两个条件同时满足的地方触发流体不稳定性。\n\n测试套件：\n\n计算满足以下四种情况下触发条件的半径 $r$ 集合（单位为米）。在所有情况下，使用上述共享参数以及指定的气体和温度分布。对于每种情况，颗粒大小 $s$、湍流参数 $\\alpha$、基准金属丰度 $Z_0$ 以及环参数 $(A, r_{\\mathrm{ring}}, w)$ 如下所列：\n\n- 情况 1：$s = 0.5 \\ \\mathrm{m}$，$\\alpha = 5 \\times 10^{-4}$，$Z_0 = 0.03$，$A = 1.0$，$r_{\\mathrm{ring}} = 50 R_J$，$w = 5 R_J$。\n- 情况 2：$s = 0.01 \\ \\mathrm{m}$，$\\alpha = 10^{-3}$，$Z_0 = 0.05$，$A = 0.0$，$r_{\\mathrm{ring}}$ 任意，$w$ 任意。\n- 情况 3：$s = 1.0 \\ \\mathrm{m}$，$\\alpha = 10^{-3}$，$Z_0 = 0.04$，$A = 0.0$，$r_{\\mathrm{ring}}$ 任意，$w$ 任意。\n- 情况 4：$s = 0.3 \\ \\mathrm{m}$，$\\alpha = 5 \\times 10^{-4}$，$Z_0 = 0.04$，$A = 0.0$，$r_{\\mathrm{ring}}$ 任意，$w$ 任意。\n\n要求的最终输出格式：\n\n- 对于每种情况，生成网格上所有满足触发条件的半径列表。每个列表必须包含以米为单位并四舍五入到最近 $10^{6} \\ \\mathrm{m}$ 的半径值。\n- 将四个列表聚合成单行，格式必须完全如下：一个由逗号分隔的四个案例列表的列表，用方括号括起来，例如 $\\left[ [r_{1,1}, r_{1,2}, \\dots], [ \\dots ], [ \\dots ], [ \\dots ] \\right]$，不含任何额外文本。\n- 如果在给定情况下没有半径满足条件，则为该情况输出一个空列表 $[ \\ ]$。\n\n本问题不涉及角度。所有物理量必须以国际单位制（SI）基本单位表示。最终打印的半径必须以米为单位，并按规定四舍五入到最近的 $10^{6} \\ \\mathrm{m}$。\n\n您的程序必须根据所述的基本定义实现物理模型，并计算所有四种情况的结果。程序不得要求用户输入，并且必须以严格要求的格式打印单行输出。答案是浮点数或整数（四舍五入后的半径）的列表，使其可以直接测试。",
            "solution": "我们从环行星盘（CPD）开普勒旋转的基本物理学出发。引力常数为 $G$，行星质量为 $M_p$，因此在柱坐标半径 $r$ 处的开普勒角频率为 $\\Omega_K(r) = \\sqrt{\\dfrac{G M_p}{r^3}}$。开普勒速度为 $v_K(r) = r \\, \\Omega_K(r)$。在理想气体假设下，等温声速为 $c_s(r) = \\sqrt{\\dfrac{k_B T(r)}{\\mu m_p}}$，其中 $k_B$ 是玻尔兹曼常数，$m_p$ 是质子质量，$\\mu$ 是平均分子量（无量纲）。在垂直流体静力学平衡中，$z$ 方向的密度呈高斯分布，标高为 $H(r) = \\dfrac{c_s(r)}{\\Omega_K(r)}$，中平面气体密度为 $\\rho_{g,0}(r) = \\dfrac{\\Sigma_g(r)}{\\sqrt{2\\pi} \\, H(r)}$。\n\n我们将气体表面密度和温度参数化为幂律形式：$\\Sigma_g(r) = \\Sigma_0 \\left( \\dfrac{r}{r_0} \\right)^{-p}$ 和 $T(r) = T_0 \\left( \\dfrac{r}{r_0} \\right)^{-q}$，其中 $\\Sigma_0$、$T_0$、$p$、$q$ 和 $r_0$ 是给定常数。\n\n对于 Epstein 区的小固体颗粒，停止时间由与相对速度和气体分子平均热速度成正比的阻力导出。热速度为 $v_{\\mathrm{th}}(r) = \\sqrt{\\dfrac{8}{\\pi}} \\, c_s(r)$。停止时间为\n$t_s(r,s) = \\dfrac{\\rho_s s}{\\rho_{g,0}(r) \\, v_{\\mathrm{th}}(r)}$，\n其中 $\\rho_s$ 是固体的内部密度，$s$ 是其半径。无量纲的斯托克斯数是轨道频率和停止时间的乘积：\n$St(r,s) = \\Omega_K(r) \\, t_s(r,s)$。\n\n接下来，我们将中平面尘埃富集与盘的湍流联系起来。在由 Shakura–Sunyaev 参数 $\\alpha$ 表征的湍流扩散稳态下，尘埃标高为 $H_d(r) = H(r) \\, \\sqrt{\\dfrac{\\alpha}{\\alpha + St(r,s)}}$。中平面尘埃与气体密度之比等于表面密度之比乘以标高之比（对于高斯垂直分布）：\n$\\epsilon_{\\mathrm{mid}}(r) = \\dfrac{\\rho_{d,0}(r)}{\\rho_{g,0}(r)} = \\dfrac{\\Sigma_d(r)}{\\sqrt{2\\pi} \\, H_d(r)} \\Big/ \\dfrac{\\Sigma_g(r)}{\\sqrt{2\\pi} \\, H(r)} = \\dfrac{\\Sigma_d(r)}{\\Sigma_g(r)} \\, \\dfrac{H(r)}{H_d(r)} = Z(r) \\, \\sqrt{1 + \\dfrac{St(r,s)}{\\alpha}}$，\n其中我们使用了 $H/H_d = \\sqrt{\\dfrac{\\alpha + St}{\\alpha}} = \\sqrt{1 + \\dfrac{St}{\\alpha}}$，并且 $Z(r) = \\Sigma_d(r)/\\Sigma_g(r)$ 是局部金属丰度。\n\n触发流体不稳定性所需的广泛使用的必要条件包括：\n- 空气动力学耦合在一个有利的频带内，通常为 $St_{\\min} \\le St(r,s) \\le St_{\\max}$，其中 $St_{\\min} = 10^{-2}$ 且 $St_{\\max} = 1$。\n- 足够大的中平面尘埃与气体密度比，$\\epsilon_{\\mathrm{mid}}(r) \\ge 1$。\n\n给定一个包含增强环的尘埃参数化金属丰度分布\n$\\Sigma_d(r) = Z_0 \\, \\Sigma_g(r) \\, \\left[ 1 + A \\, \\exp \\left( - \\dfrac{(r - r_{\\mathrm{ring}})^2}{2w^2} \\right) \\right]$,\n我们得到 $Z(r) = Z_0 \\, \\left[ 1 + A \\, \\exp \\left( - \\dfrac{(r - r_{\\mathrm{ring}})^2}{2w^2} \\right) \\right]$。\n\n算法流程：\n1. 以国际单位制（SI）定义常数：$G$、$k_B$、$m_p$、$M_J$、$R_J$，并采用 $M_p = M_J$、平均分子量 $\\mu$ 和固体密度 $\\rho_s$。\n2. 构建径向网格，包含 $N$ 个点，均匀分布在从 $r_{\\min}$ 到 $r_{\\max}$ 的区间内。\n3. 对于每个半径 $r$：\n   - 计算 $T(r)$ 和 $c_s(r)$。\n   - 计算 $\\Omega_K(r)$ 和 $H(r)$。\n   - 计算 $\\Sigma_g(r)$ 和 $\\rho_{g,0}(r)$。\n   - 计算 $v_{\\mathrm{th}}(r)$，然后是 $t_s(r,s)$ 和 $St(r,s)$。\n   - 根据尘埃参数化计算 $Z(r)$，然后计算 $\\epsilon_{\\mathrm{mid}}(r) = Z(r) \\, \\sqrt{1 + \\dfrac{St(r,s)}{\\alpha}}$。\n4. 应用流体不稳定性判据 $St_{\\min} \\le St \\le St_{\\max}$ 和 $\\epsilon_{\\mathrm{mid}} \\ge 1$。收集所有同时满足这两个条件的半径 $r$。\n5. 将每个选定的半径四舍五入到最近的 $10^{6} \\ \\mathrm{m}$。\n6. 对每个测试案例及其参数重复以上步骤。以单行聚合格式返回四个列表。\n\n值得注意的是，通过将 $\\rho_{g,0}(r) = \\dfrac{\\Sigma_g(r)}{\\sqrt{2\\pi}H(r)}$ 和 $v_{\\mathrm{th}} \\propto c_s$ 代入 $t_s$ 的表达式，可以发现 $St(r,s) = \\Omega_K \\, \\dfrac{\\rho_s s}{\\rho_{g,0} v_{\\mathrm{th}}} \\propto \\dfrac{\\rho_s s}{\\Sigma_g(r)}$。这表明，在垂直等温盘的 Epstein 区内，$St$ 主要取决于 $s$ 和 $\\Sigma_g(r)$，而不显式地依赖于 $T(r)$，这加强了物理直觉，并为实现提供了一致性检验。\n\n我们现在将此算法应用于四个指定的案例，共享的环行星盘参数为 $r_0 = 10 R_J$，$\\Sigma_0 = 2 \\times 10^{4} \\ \\mathrm{kg \\, m^{-2}}$，$T_0 = 400 \\ \\mathrm{K}$，$p = 1$，$q = 0.5$，$M_p = M_J$，径向边界为 $r_{\\min} = 5 R_J$，$r_{\\max} = 100 R_J$，$N = 50$。案例参数为：\n- 情况 1：$s = 0.5 \\ \\mathrm{m}$，$\\alpha = 5 \\times 10^{-4}$，$Z_0 = 0.03$，$A = 1.0$，$r_{\\mathrm{ring}} = 50 R_J$，$w = 5 R_J$。\n- 情况 2：$s = 0.01 \\ \\mathrm{m}$，$\\alpha = 10^{-3}$，$Z_0 = 0.05$，$A = 0.0$。\n- 情况 3：$s = 1.0 \\ \\mathrm{m}$，$\\alpha = 10^{-3}$，$Z_0 = 0.04$，$A = 0.0$。\n- 情况 4：$s = 0.3 \\ \\mathrm{m}$，$\\alpha = 5 \\times 10^{-4}$，$Z_0 = 0.04$，$A = 0.0$。\n\n最终程序计算并打印出每个案例的以米为单位的四舍五入后的半径列表，聚合成单行以便直接评估。单位严格采用国际单位制（SI），半径以米为单位报告，并四舍五入到最近的 $10^{6} \\ \\mathrm{m}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef cpd_streaming_instability_radii(\n    s, alpha, Z0, A, r_ring, w,\n    Mp, mu, rho_s,\n    Sigma0, T0, p, q, r0,\n    r_min, r_max, N,\n    G, kB, mp, RJ\n):\n    # Radial grid\n    r = np.linspace(r_min, r_max, N)  # meters\n\n    # Gas and temperature profiles\n    Sigma_g = Sigma0 * (r / r0) ** (-p)  # kg/m^2\n    T = T0 * (r / r0) ** (-q)            # K\n\n    # Sound speed and Keplerian frequency\n    cs = np.sqrt(kB * T / (mu * mp))     # m/s\n    OmegaK = np.sqrt(G * Mp / r**3)      # 1/s\n    H = cs / OmegaK                      # m\n\n    # Midplane gas density\n    rho_g0 = Sigma_g / (np.sqrt(2.0 * np.pi) * H)  # kg/m^3\n\n    # Thermal speed\n    v_th = np.sqrt(8.0 / np.pi) * cs     # m/s\n\n    # Epstein stopping time and Stokes number\n    ts = (rho_s * s) / (rho_g0 * v_th)   # s\n    St = OmegaK * ts                     # dimensionless\n\n    # Local metallicity Z(r)\n    if A != 0.0 and r_ring is not None and w is not None:\n        bump = 1.0 + A * np.exp(- (r - r_ring)**2 / (2.0 * w**2))\n    else:\n        bump = 1.0\n    Z = Z0 * bump  # dimensionless\n\n    # Dust scale height and midplane dust-to-gas ratio\n    # H_d = H * sqrt(alpha / (alpha + St)) -> epsilon_mid = Z * (H / H_d) = Z * sqrt(1 + St/alpha)\n    eps_mid = Z * np.sqrt(1.0 + St / alpha)\n\n    # Streaming instability criteria\n    St_min = 1e-2\n    St_max = 1.0\n\n    mask = (St >= St_min)  (St = St_max)  (eps_mid >= 1.0)\n\n    # Select radii that satisfy, rounded to nearest 1e6 m\n    r_sel = r[mask]\n    # Round to nearest 1e6 m\n    r_round = np.rint(r_sel / 1e6) * 1e6\n\n    # Convert to integers for clean output\n    radii_list = [int(x) for x in r_round.tolist()]\n\n    return radii_list\n\ndef solve():\n    # Constants (SI)\n    G = 6.67430e-11           # m^3 kg^-1 s^-2\n    kB = 1.380649e-23         # J K^-1\n    mp = 1.67262192369e-27    # kg\n\n    # Planet and units\n    MJ = 1.898e27             # kg\n    RJ = 7.1492e7             # m\n    Mp = MJ\n\n    # Disk and material parameters (shared)\n    mu = 2.34                 # mean molecular weight\n    rho_s = 1500.0            # kg/m^3 (solids)\n    r0 = 10.0 * RJ            # m\n    Sigma0 = 2.0e4            # kg/m^2 at r0\n    T0 = 400.0                # K at r0\n    p = 1.0\n    q = 0.5\n\n    # Radial grid\n    r_min = 5.0 * RJ\n    r_max = 100.0 * RJ\n    N = 50\n\n    # Test cases: (s, alpha, Z0, A, r_ring, w)\n    cases = [\n        # Case 1\n        (0.5, 5e-4, 0.03, 1.0, 50.0 * RJ, 5.0 * RJ),\n        # Case 2\n        (0.01, 1e-3, 0.05, 0.0, None, None),\n        # Case 3\n        (1.0, 1e-3, 0.04, 0.0, None, None),\n        # Case 4\n        (0.3, 5e-4, 0.04, 0.0, None, None),\n    ]\n\n    results = []\n    for s, alpha, Z0, A, r_ring, w in cases:\n        radii = cpd_streaming_instability_radii(\n            s=s, alpha=alpha, Z0=Z0, A=A, r_ring=r_ring, w=w,\n            Mp=Mp, mu=mu, rho_s=rho_s,\n            Sigma0=Sigma0, T0=T0, p=p, q=q, r0=r0,\n            r_min=r_min, r_max=r_max, N=N,\n            G=G, kB=kB, mp=mp, RJ=RJ\n        )\n        results.append(radii)\n\n    # Final print statement in the exact required format.\n    # Print as a single line JSON-like list of lists without extra spaces.\n    # Convert lists to string with commas and brackets.\n    # Ensure no extra spaces: use join operations.\n    def list_to_str(lst):\n        return \"[\" + \",\".join(str(x) for x in lst) + \"]\"\n\n    print(\"[\" + \",\".join(list_to_str(r) for r in results) + \"]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "环行星盘的整体结构和质量分布是其物质输入、内部输运和质量损失之间达到动态平衡的结果。理解这种平衡对于预测卫星系统的最终质量和位置至关重要。本练习综合了前面探讨的概念，要求您构建一个稳态环行星盘的一维模型，该模型不仅考虑了由粘滞输运（其效率由 $\\alpha$ 参数决定）驱动的向内吸积，还明确包含了一个代表卫星形成的质量汇，从而将局部物理过程与盘的全局演化联系起来。",
            "id": "4155767",
            "problem": "设计并实现一个完整的、可运行的程序，用于模拟一个一维、轴对称、稳态的环行星盘（CPD, Circumplanetary Disk）。该盘在外边界有质量流入，并通过吸积到行星以及在有限环带内分布的卫星形成过程消耗质量。该模型必须从基本原理推导得出：即质量守恒和带有有效粘性的角动量输运。程序必须通过应用稳态质量平衡和标准的粘性输运闭合关系，计算表面密度剖面作为半径的函数。所有数学实体必须使用 LaTeX 表示。\n\n假设盘是几何薄盘、开普勒盘且在垂直方向上是等温的。令 $R$ 表示从行星中心出发的柱坐标半径。令 $R_{\\rm in}$ 和 $R_{\\rm out}$ 分别表示内外边界。令 $R_{\\rm out}$ 处的向内质量流入率为 $\\dot{M}_{\\rm in}$ (单位 $\\mathrm{kg\\,s^{-1}}$)。令卫星形成在一个环带 $[R_1,R_2]$ 内作为一个分布的汇，其单位面积上的表面汇分布是均匀的，总汇率为 $\\dot{M}_s$ (单位 $\\mathrm{kg\\,s^{-1}}$)。到行星上的吸积率为 $\\dot{M}_p$ (单位 $\\mathrm{kg\\,s^{-1}}$)，在稳态下等于 $R_{\\rm in}$ 处的净向内质量通量。盘的运动粘性由一个 $\\alpha$ 模型描述：\n$$\n\\nu(R) = \\alpha \\frac{c_s^2(R)}{\\Omega_K(R)},\n$$\n其中 $\\alpha$ 是无量纲参数，$c_s(R)$ 是等温声速，$\\Omega_K(R)$ 是开普勒角频率。取\n$$\nc_s(R) = \\sqrt{\\frac{k_{\\rm B}\\,T(R)}{\\mu m_{\\rm H}}}, \\quad \\Omega_K(R) = \\sqrt{\\frac{G M_{\\rm pl}}{R^3}},\n$$\n其中 $k_{\\rm B}$ 是 Boltzmann 常数，$m_{\\rm H}$ 是氢原子质量，$\\mu$ 是平均分子量，$G$ 是引力常数，$M_{\\rm pl}$ 是行星质量。温度剖面规定为幂律形式：\n$$\nT(R) = T_0 \\left(\\frac{R}{R_0}\\right)^{-q}.\n$$\n\n基本原理与推导要求：\n- 从柱对称稳态连续性方程开始，\n$$\n\\frac{1}{R}\\frac{d}{dR}\\big(R\\,\\Sigma\\,v_R\\big) = S(R),\n$$\n其中 $\\Sigma(R)$ 是表面密度（单位 $\\mathrm{kg\\,m^{-2}}$），$v_R(R)$ 是径向速度（对于向内流动为负），$S(R)$ 是每单位面积的净源项（单位 $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$）。将向内质量通量定义为正值：\n$$\n\\dot{M}(R) \\equiv -2\\pi R\\,\\Sigma(R)\\,v_R(R).\n$$\n对连续性方程积分，以获得 $\\dot{M}(R)$ 与分布汇的关系。然后，利用稳态流入和可忽略外部力矩条件下的薄粘性盘中的角动量输运，推导出经过充分检验的、将局部向内质量通量与粘性和表面密度联系起来的闭合关系，并用它来表示 $\\Sigma(R)$ 与 $\\dot{M}(R)$ 和 $\\nu(R)$ 的关系。\n\n实现要求：\n- 将卫星形成汇模拟为在 $[R_1,R_2]$ 上均匀分布，通过选择一个归一化分布函数 $g(R)$，使得\n$$\n\\int_{R_1}^{R_2} 2\\pi R\\,g(R)\\,dR = 1, \\quad g(R) = \\frac{1}{\\pi\\left(R_2^2-R_1^2\\right)} \\ \\text{for}\\ R\\in[R_1,R_2], \\ \\text{and} \\ g(R)=0 \\ \\text{otherwise}.\n$$\n令 $S(R) = -\\dot{M}_s\\,g(R)$，从而总汇率等于 $\\dot{M}_s$。\n- 从连续性方程得到\n$$\n\\frac{d\\dot{M}}{dR} = -2\\pi R\\,S(R),\n$$\n并从 $R$ 积分到 $R_{\\rm out}$ 以获得 $\\dot{M}(R)$ 与 $\\dot{M}_{\\rm in}$ 和分布汇的关系。对于均匀环形汇，这将得到位于半径 $R$ 外部的汇所占比例的分段表达式：\n$$\nf(R) \\equiv \\int_{R}^{R_{\\rm out}} 2\\pi r\\,g(r)\\,dr =\n\\begin{cases}\n1,  R \\le R_1 \\\\[6pt]\n\\dfrac{R_2^2 - R^2}{R_2^2 - R_1^2},  R_1  R  R_2 \\\\[10pt]\n0,  R \\ge R_2\n\\end{cases}\n$$\n以及\n$$\n\\dot{M}(R) = \\dot{M}_{\\rm in} - \\dot{M}_s\\,f(R).\n$$\n- 使用标准的稳态薄盘角动量输运关系来闭合该系统，并计算表面密度剖面：\n$$\n\\Sigma(R) = \\frac{\\dot{M}(R)}{3\\pi\\,\\nu(R)}.\n$$\n- 计算 $\\dot{M}_p = \\dot{M}(R_{\\rm in})$ 并验证稳态质量平衡 $\\dot{M}_{\\rm in} = \\dot{M}_p + \\dot{M}_s$ 在指定的数值公差内成立。\n\n使用的物理常数：\n- $G = 6.6743\\times 10^{-11}\\ \\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$\n- $k_{\\rm B} = 1.380649\\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$\n- $m_{\\rm H} = 1.6735575\\times 10^{-27}\\ \\mathrm{kg}$\n- $\\mu = 2.34$\n- $R_{\\rm J} = 7.1492\\times 10^7\\ \\mathrm{m}$ (木星半径)\n\n单位和输出：\n- 半径必须以米为单位处理。温度以开尔文为单位。质量速率以 $\\mathrm{kg\\,s^{-1}}$ 为单位。表面密度必须以 $\\mathrm{kg\\,m^{-2}}$ 为单位报告。\n- 对每个测试用例，计算在一组指定半径处的 $\\Sigma(R)$，并以 $\\mathrm{kg\\,m^{-2}}$ 为单位报告这些值，每个值四舍五入到三位有效数字。同时报告一个布尔值，指示质量平衡 $\\dot{M}_{\\rm in} = \\dot{M}_p + \\dot{M}_s$ 是否在相对公差 $10^{-10}$ 内成立。\n\n测试套件：\n- 使用以下四个测试用例，每个用例由 $(R_{\\rm in}, R_{\\rm out}, \\dot{M}_{\\rm in}, \\dot{M}_s, R_1, R_2, \\alpha, T_0, R_0, q, M_{\\rm pl}, \\{R_i\\})$ 定义，其中 $\\{R_i\\}$ 是计算 $\\Sigma$ 的半径集合。\n\n1. 正常流程的CPD：\n    - $R_{\\rm in} = 2\\,R_{\\rm J}$, $R_{\\rm out} = 200\\,R_{\\rm J}$\n    - $\\dot{M}_{\\rm in} = 1.0\\times 10^{14}\\ \\mathrm{kg\\,s^{-1}}$, $\\dot{M}_s = 3.0\\times 10^{13}\\ \\mathrm{kg\\,s^{-1}}$\n    - $R_1 = 20\\,R_{\\rm J}$, $R_2 = 40\\,R_{\\rm J}$\n    - $\\alpha = 1.0\\times 10^{-3}$\n    - $T_0 = 200\\ \\mathrm{K}$, $R_0 = 20\\,R_{\\rm J}$, $q = 0.5$\n    - $M_{\\rm pl} = 1.898\\times 10^{27}\\ \\mathrm{kg}$\n    - $\\{R_i\\} = \\{5\\,R_{\\rm J}, 20\\,R_{\\rm J}, 50\\,R_{\\rm J}, 100\\,R_{\\rm J}\\}$\n\n2. 无卫星汇：\n    - $R_{\\rm in} = 2\\,R_{\\rm J}$, $R_{\\rm out} = 200\\,R_{\\rm J}$\n    - $\\dot{M}_{\\rm in} = 2.0\\times 10^{13}\\ \\mathrm{kg\\,s^{-1}}$, $\\dot{M}_s = 0$\n    - $R_1 = 20\\,R_{\\rm J}$, $R_2 = 40\\,R_{\\rm J}$ (当 $\\dot{M}_s=0$ 时无关紧要)\n    - $\\alpha = 5.0\\times 10^{-3}$\n    - $T_0 = 300\\ \\mathrm{K}$, $R_0 = 20\\,R_{\\rm J}$, $q = 0.5$\n    - $M_{\\rm pl} = 1.898\\times 10^{27}\\ \\mathrm{kg}$\n    - $\\{R_i\\} = \\{5\\,R_{\\rm J}, 20\\,R_{\\rm J}, 50\\,R_{\\rm J}, 100\\,R_{\\rm J}\\}$\n\n3. 强内汇环：\n    - $R_{\\rm in} = 2\\,R_{\\rm J}$, $R_{\\rm out} = 100\\,R_{\\rm J}$\n    - $\\dot{M}_{\\rm in} = 8.0\\times 10^{13}\\ \\mathrm{kg\\,s^{-1}}$, $\\dot{M}_s = 7.5\\times 10^{13}\\ \\mathrm{kg\\,s^{-1}}$\n    - $R_1 = 5\\,R_{\\rm J}$, $R_2 = 10\\,R_{\\rm J}$\n    - $\\alpha = 1.0\\times 10^{-3}$\n    - $T_0 = 150\\ \\mathrm{K}$, $R_0 = 20\\,R_{\\rm J}$, $q = 0.6$\n    - $M_{\\rm pl} = 1.898\\times 10^{27}\\ \\mathrm{kg}$\n    - $\\{R_i\\} = \\{3\\,R_{\\rm J}, 6\\,R_{\\rm J}, 12\\,R_{\\rm J}, 30\\,R_{\\rm J}\\}$\n\n4. 低粘性、宽汇环：\n    - $R_{\\rm in} = 2\\,R_{\\rm J}$, $R_{\\rm out} = 200\\,R_{\\rm J}$\n    - $\\dot{M}_{\\rm in} = 5.0\\times 10^{12}\\ \\mathrm{kg\\,s^{-1}}$, $\\dot{M}_s = 2.0\\times 10^{12}\\ \\mathrm{kg\\,s^{-1}}$\n    - $R_1 = 50\\,R_{\\rm J}$, $R_2 = 150\\,R_{\\rm J}$\n    - $\\alpha = 1.0\\times 10^{-4}$\n    - $T_0 = 120\\ \\mathrm{K}$, $R_0 = 50\\,R_{\\rm J}$, $q = 1.0$\n    - $M_{\\rm pl} = 1.898\\times 10^{27}\\ \\mathrm{kg}$\n    - $\\{R_i\\} = \\{10\\,R_{\\rm J}, 60\\,R_{\\rm J}, 120\\,R_{\\rm J}, 180\\,R_{\\rm J}\\}$\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表。每个元素对应一个测试用例，其本身是一个形式为 $[\\,[\\Sigma(R_1),\\Sigma(R_2),\\ldots],\\,\\mathrm{boolean}\\,]$ 的列表，其中内部列表包含以 $\\mathrm{kg\\,m^{-2}}$ 为单位、四舍五入到三位有效数字的表面密度，布尔值指示 $\\dot{M}_{\\rm in} = \\dot{M}_p + \\dot{M}_s$ 是否在相对公差 $10^{-10}$ 内成立。例如：$[[[1.23\\mathrm{e}5,4.56\\mathrm{e}4,7.89\\mathrm{e}3],\\mathrm{True}],\\ldots]$。",
            "solution": "目标是计算一个一维、轴对称环行星盘（CPD）的稳态表面密度剖面 $\\Sigma(R)$。该盘在其外边界有指定的质量流入，并在一个指定的径向区域内因吸积到中心行星和形成卫星而损失质量。该模型基于粘性盘中质量和角动量守恒的基本原理。\n\n首先，我们从质量守恒方程（也称为连续性方程）开始。对于柱坐标系 $(R, \\phi, z)$ 中的稳态（$\\partial/\\partial t = 0$）、轴对称（$\\partial/\\partial\\phi = 0$）盘，经过垂直方向积分后，连续性方程由下式给出：\n$$\n\\frac{1}{R}\\frac{d}{dR}\\left(R\\,\\Sigma(R)\\,v_R(R)\\right) = S(R)\n$$\n其中 $\\Sigma(R)$ 是表面质量密度，单位为 $\\mathrm{kg\\,m^{-2}}$；$v_R(R)$ 是垂直方向平均的径向速度，单位为 $\\mathrm{m\\,s^{-1}}$（对于向内流动为负）；$S(R)$ 是每单位面积的净质量源或汇项，单位为 $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$。\n\n为方便起见，我们将给定半径 $R$ 处的净向内质量通量（吸积率）定义为正值：\n$$\n\\dot{M}(R) \\equiv -2\\pi R\\,\\Sigma(R)\\,v_R(R)\n$$\n单位为 $\\mathrm{kg\\,s^{-1}}$。将 $\\dot{M}(R)$ 对 $R$ 求导可得：\n$$\n\\frac{d\\dot{M}}{dR} = -2\\pi\\frac{d}{dR}\\left(R\\,\\Sigma\\,v_R\\right)\n$$\n将连续性方程代入此表达式，我们得到质量通量变化与局部源/汇项之间的关系：\n$$\n\\frac{d\\dot{M}}{dR} = -2\\pi R\\,S(R)\n$$\n问题指定了一个汇项 $S(R)$，代表在半径 $R_1$ 和 $R_2$ 之间的环带中形成卫星，总汇率为 $\\dot{M}_s$。因此源项为 $S(R) = -\\dot{M}_s g(R)$，其中 $g(R)$ 是一个归一化的分布函数。对于在环 $[R_1, R_2]$ 上每单位面积均匀的汇，$g(R)$ 在此区间内为常数，在其他地方为零。归一化条件 $\\int_{R_1}^{R_2} 2\\pi R\\,g(R)\\,dR = 1$ 给出：\n$$\ng(R) = \\frac{1}{\\pi\\left(R_2^2-R_1^2\\right)} \\quad \\text{for} \\quad R \\in [R_1, R_2]\n$$\n为了找到质量通量剖面 $\\dot{M}(R)$，我们将 $\\frac{d\\dot{M}}{dR}$ 从任意半径 $R$ 积分到盘的外边界 $R_{\\rm out}$：\n$$\n\\int_R^{R_{\\rm out}} \\frac{d\\dot{M}}{dr} dr = \\dot{M}(R_{\\rm out}) - \\dot{M}(R)\n$$\n这必须等于在相同区间上对汇项的积分：\n$$\n\\dot{M}(R_{\\rm out}) - \\dot{M}(R) = \\int_R^{R_{\\rm out}} -2\\pi r S(r) dr = \\int_R^{R_{\\rm out}} 2\\pi r \\dot{M}_s g(r) dr = \\dot{M}_s \\int_R^{R_{\\rm out}} 2\\pi r g(r) dr\n$$\n我们将外边界的质量流入率定义为 $\\dot{M}_{\\rm in} \\equiv \\dot{M}(R_{\\rm out})$，并将位于 $R$ 外部的汇的积分比例定义为 $f(R) \\equiv \\int_R^{R_{\\rm out}} 2\\pi r g(r) dr$。质量通量剖面则为：\n$$\n\\dot{M}(R) = \\dot{M}_{\\rm in} - \\dot{M}_s f(R)\n$$\n函数 $f(R)$ 是分段的，取决于 $R$ 相对于汇区域 $[R_1, R_2]$ 的位置。计算 $f(R)$ 的积分得出：\n$$\nf(R) =\n\\begin{cases}\n1,  R \\le R_1 \\\\\n\\dfrac{R_2^2 - R^2}{R_2^2 - R_1^2},  R_1  R  R_2 \\\\\n0,  R \\ge R_2\n\\end{cases}\n$$\n接下来，我们引用薄、粘性、开普勒盘中的角动量输运理论。在稳态下，净粘性力矩必须与角动量的平流相平衡。在边界力矩可忽略的简化条件下（在远离盘内缘处有效），局部向内质量通量通过标准闭合关系与表面密度 $\\Sigma(R)$ 和运动粘性 $\\nu(R)$ 相关联：\n$$\n\\dot{M}(R) = 3\\pi \\nu(R) \\Sigma(R)\n$$\n这使我们能够解出表面密度：\n$$\n\\Sigma(R) = \\frac{\\dot{M}(R)}{3\\pi \\nu(R)}\n$$\n运动粘性 $\\nu(R)$ 使用 alpha 模型进行建模：\n$$\n\\nu(R) = \\alpha \\frac{c_s^2(R)}{\\Omega_K(R)}\n$$\n其中 $\\alpha$ 是一个无量纲参数，$c_s(R)$ 是局部声速，$\\Omega_K(R)$ 是开普勒角频率。它们由以下公式给出：\n$$\nc_s(R) = \\sqrt{\\frac{k_{\\rm B} T(R)}{\\mu m_{\\rm H}}} \\quad \\text{and} \\quad \\Omega_K(R) = \\sqrt{\\frac{G M_{\\rm pl}}{R^3}}\n$$\n此处，$k_{\\rm B}$ 是 Boltzmann 常数，$T(R)$ 是盘的温度，$\\mu$ 是平均分子量，$m_{\\rm H}$ 是氢原子质量，$G$ 是引力常数，$M_{\\rm pl}$ 是行星的质量。温度剖面以幂律形式给出：\n$$\nT(R) = T_0 \\left(\\frac{R}{R_0}\\right)^{-q}\n$$\n将这些表达式代入 $\\nu(R)$ 的公式，我们得到一个关于半径的显式函数：\n$$\n\\nu(R) = \\alpha \\left( \\frac{k_{\\rm B} T_0}{\\mu m_{\\rm H}} \\left(\\frac{R}{R_0}\\right)^{-q} \\right) \\left( \\frac{G M_{\\rm pl}}{R^3} \\right)^{-1/2} = \\alpha \\frac{k_{\\rm B} T_0}{\\mu m_{\\rm H}} \\frac{R_0^q}{\\sqrt{G M_{\\rm pl}}} R^{3/2 - q}\n$$\n结合所有这些元素，我们得到表面密度剖面的最终表达式：\n$$\n\\Sigma(R) = \\frac{\\dot{M}_{\\rm in} - \\dot{M}_s f(R)}{3\\pi \\nu(R)}\n$$\n到行星上的吸积率 $\\dot{M}_p$ 是在盘内边界 $R_{\\rm in}$ 处计算的质量通量：\n$$\n\\dot{M}_p = \\dot{M}(R_{\\rm in}) = \\dot{M}_{\\rm in} - \\dot{M}_s f(R_{\\rm in})\n$$\n由于所有测试用例的结构都满足 $R_{\\rm in} \\le R_1$，我们有 $f(R_{\\rm in}) = 1$。这导致 $\\dot{M}_p = \\dot{M}_{\\rm in} - \\dot{M}_s$，从而证实了总质量平衡方程 $\\dot{M}_{\\rm in} = \\dot{M}_p + \\dot{M}_s$。数值实现将在指定的浮点公差范围内验证此恒等式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the surface density profile of a circumplanetary disk for multiple test cases.\n    \"\"\"\n    # Physical constants in SI units\n    G = 6.6743e-11  # m^3 kg^-1 s^-2\n    K_B = 1.380649e-23  # J K^-1\n    M_H = 1.6735575e-27  # kg\n    MU = 2.34\n    R_J = 7.1492e7  # meters, radius of Jupiter\n\n    def round_to_3_sf(x):\n        \"\"\"Rounds a number to three significant figures.\"\"\"\n        if x == 0:\n            return 0.0\n        return float(f'{x:.2e}')\n\n    def process_case(params):\n        \"\"\"\n        Processes a single test case to compute surface densities and verify mass balance.\n        \"\"\"\n        R_in_Rj, R_out_Rj, M_in, M_s, R1_Rj, R2_Rj, alpha, T0, R0_Rj, q, M_pl, R_i_Rj = params\n\n        # Convert radii from R_J to meters\n        R_in = R_in_Rj * R_J\n        R_out = R_out_Rj * R_J\n        R1 = R1_Rj * R_J\n        R2 = R2_Rj * R_J\n        R0 = R0_Rj * R_J\n        R_i = [r * R_J for r in R_i_Rj]\n\n        # Function for the integrated sink fraction f(R)\n        def f_sink(R):\n            if R = R1:\n                return 1.0\n            elif R1  R  R2:\n                # Handle the case R1=R2 to avoid division by zero\n                if R1 == R2:\n                    return 0.0\n                return (R2**2 - R**2) / (R2**2 - R1**2)\n            else:  # R >= R2\n                return 0.0\n\n        # Function for mass flux M_dot(R)\n        def M_dot(R):\n            return M_in - M_s * f_sink(R)\n\n        # Function for kinematic viscosity nu(R)\n        def nu(R):\n            T_R = T0 * (R / R0)**(-q)\n            cs2_R = K_B * T_R / (MU * M_H)\n            Omega_K_R = np.sqrt(G * M_pl / R**3)\n            return alpha * cs2_R / Omega_K_R\n\n        # Function for surface density Sigma(R)\n        def Sigma(R):\n            current_nu = nu(R)\n            if current_nu == 0:\n                return np.inf\n            return M_dot(R) / (3 * np.pi * current_nu)\n\n        # Compute surface density at specified radii\n        sigma_values = [round_to_3_sf(Sigma(r)) for r in R_i]\n\n        # Verify mass balance\n        M_p = M_dot(R_in)\n        # Check if M_in is non-zero to avoid division by zero in relative tolerance check\n        if M_in != 0:\n            mass_balance_holds = np.isclose(M_in, M_p + M_s, rtol=1e-10)\n        else: # If M_in is zero, M_p + M_s should also be zero\n            mass_balance_holds = np.isclose(M_p + M_s, 0, atol=1e-12) # Use absolute tol for zero case\n\n        return sigma_values, bool(mass_balance_holds)\n    \n    # Define the test cases from the problem statement\n    test_cases = [\n        # Case 1: Happy path CPD\n        (2.0, 200.0, 1.0e14, 3.0e13, 20.0, 40.0, 1.0e-3, 200.0, 20.0, 0.5, 1.898e27, [5.0, 20.0, 50.0, 100.0]),\n        # Case 2: No satellite sink\n        (2.0, 200.0, 2.0e13, 0.0, 20.0, 40.0, 5.0e-3, 300.0, 20.0, 0.5, 1.898e27, [5.0, 20.0, 50.0, 100.0]),\n        # Case 3: Strong inner sink ring\n        (2.0, 100.0, 8.0e13, 7.5e13, 5.0, 10.0, 1.0e-3, 150.0, 20.0, 0.6, 1.898e27, [3.0, 6.0, 12.0, 30.0]),\n        # Case 4: Low viscosity, wide sink ring\n        (2.0, 200.0, 5.0e12, 2.0e12, 50.0, 150.0, 1.0e-4, 120.0, 50.0, 1.0, 1.898e27, [10.0, 60.0, 120.0, 180.0])\n    ]\n\n    results_str_list = []\n    for case in test_cases:\n        sigma_vals, balance_ok = process_case(case)\n        # Format sigma values to avoid spaces\n        sigma_str = '[' + ','.join(map(str, sigma_vals)) + ']'\n        # Format the whole result for this case\n        case_result_str = '[' + sigma_str + ',' + str(balance_ok).lower() + ']'\n        results_str_list.append(case_result_str)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results_str_list)}]\")\n\n\nsolve()\n```"
        }
    ]
}