{
    "hands_on_practices": [
        {
            "introduction": "为了理解行星宏大的迁移过程，我们必须首先剖析其根本驱动力：巨行星与单个星子的引力相遇。本练习将引导您从第一性原理出发，推导出行星轨道因此产生的变化。通过应用守恒定律，您将揭示出驱动尼斯模型等理论中行星向内和向外迁移的核心物理机制。",
            "id": "4183654",
            "problem": "在巨行星迁移的尼斯模型（Nice model）及相关的后期重轰炸期（Late Heavy Bombardment）背景下，考虑一个由牛顿引力支配的简化的太阳-行星-星子系统。一个质量为 $M_{p}$ 的巨行星最初以半长轴为 $a$ 的近圆形日心轨道绕着质量为 $M_{\\odot}$ 的太阳运行。一个质量为 $m$ 的单个星子最初在星子盘中，以半长轴为 $a_{d}$ 的近圆形日心轨道运动。与行星的一次近距离引力相遇将该星子抛射到一条临界束缚（抛物线）的日心逃逸轨道上，使其相遇后的日心轨道能量为 $E=0$。假设 $m \\ll M_{p}$，忽略太阳的反冲，并将相遇视为相对于轨道时间尺度是瞬时的。\n\n使用经过充分检验的双体轨道能量关系式 $E=-G M_{\\odot} \\mu/(2a)$（适用于质量为 $\\mu$ 的天体绕太阳运行的情况），并调用行星-星子子系统的总日心角动量守恒，推导出行星半长轴变化量 $\\Delta a$ 的符号及其闭合形式的大小，该变化是由这一次抛射事件引起的。假设在 $m/M_{p}$ 的主导阶上，行星的偏心率变化可以忽略不计，因此其角动量在相遇前后可以写为 $L_{p} \\approx M_{p}\\sqrt{G M_{\\odot} a}$，并且抛射是顺行的，因此星子的日心角动量增加。\n\n请用 $m$、$M_{p}$、$a$ 和 $a_{d}$ 表示 $\\Delta a$，给出一个简化的解析表达式作为最终结果。不需要进行数值计算，最终表达式中不应包含单位。",
            "solution": "用户要求我解决一个来自行星科学领域的物理问题。\n\n**1. 问题验证**\n\n首先，我将验证问题陈述。\n\n**步骤 1：提取已知条件**\n-   系统：牛顿引力作用下的太阳-行星-星子系统。\n-   行星质量：$M_{p}$。\n-   太阳质量：$M_{\\odot}$。\n-   行星初始轨道：近圆形日心轨道，半长轴为 $a$。\n-   星子质量：$m$。\n-   星子初始轨道：近圆形日心轨道，半长轴为 $a_{d}$。\n-   相互作用：一次近距离引力相遇抛射了星子。\n-   星子最终状态：临界束缚（抛物线）的日心逃逸轨道。\n-   星子最终日心轨道能量：$E=0$。\n-   质量等级：$m \\ll M_{p}$。\n-   简化：忽略太阳反冲；相遇是瞬时的。\n-   能量公式：双体轨道能量为 $E=-G M_{\\odot} \\mu/(2a)$。\n-   守恒定律：需要调用行星-星子子系统的总日心角动量守恒。\n-   近似：行星的偏心率变化可忽略，因此其角动量为 $L_{p} \\approx M_{p}\\sqrt{G M_{\\odot} a}$。\n-   抛射条件：抛射是顺行的，意味着星子的日心角动量增加。\n-   目标：用 $m$、$M_{p}$、$a$ 和 $a_{d}$ 推导出行星半长轴变化量 $\\Delta a$ 的符号和大小。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题基于天体力学的基本原理（牛顿引力、轨道能量、角动量），并描述了类似尼斯模型等行星迁移理论中的一个典型过程。所有概念都是天体物理学中的标准概念。\n-   **适定性：** 该问题提供了足够的初始条件、守恒定律和简化假设，以确定 $\\Delta a$ 的唯一解。诸如瞬时相遇和行星偏心率变化可忽略等假设，是该主题入门级处理中的标准做法，使得问题可解。\n-   **客观性：** 问题陈述使用了精确、正式的语言，没有任何主观或模棱两可的术语。\n\n**步骤 3：结论与行动**\n该问题科学上合理、适定、客观且内部一致。这是一个有效的问题。我现在将进行求解。\n\n**2. 解题推导**\n\n问题要求我们找出因星子被引力抛射而导致的行星半长轴变化量 $\\Delta a$。我们将使用指定的行星-星子系统的角动量守恒。\n\n令初始状态（相遇前）用下标 $i$ 表示，最终状态（相遇后）用下标 $f$ 表示。\n\n行星在半长轴为 $a$ 的近圆形轨道上的日心角动量由 $L_{p} \\approx M_{p}\\sqrt{G M_{\\odot} a}$ 给出。\n行星的初始角动量为 $L_{p, i} = M_{p}\\sqrt{G M_{\\odot} a}$。相遇后，其半长轴为 $a_{f} = a + \\Delta a$。其最终角动量为 $L_{p, f} = M_{p}\\sqrt{G M_{\\odot} (a + \\Delta a)}$。\n行星角动量的变化量 $\\Delta L_{p} = L_{p, f} - L_{p, i}$，可以通过对微小变化 $\\Delta a$ 进行线性化来求得：\n$$ \\Delta L_{p} \\approx \\frac{dL_{p}}{da} \\Delta a = \\frac{d}{da} \\left( M_{p}\\sqrt{G M_{\\odot} a} \\right) \\Delta a = M_{p}\\sqrt{G M_{\\odot}} \\left( \\frac{1}{2} a^{-1/2} \\right) \\Delta a $$\n$$ \\Delta L_{p} = \\frac{M_{p}\\sqrt{G M_{\\odot}}}{2\\sqrt{a}} \\Delta a $$\n\n星子最初在半长轴为 $a_{d}$ 的近圆形轨道上运动。其初始角动量为 $L_{m, i} = m\\sqrt{G M_{\\odot} a_{d}}$。\n\n问题陈述，在相遇过程中，行星-星子子系统的总日心角动量是守恒的。\n$$ L_{p, i} + L_{m, i} = L_{p, f} + L_{m, f} $$\n这意味着行星角动量的变化量等于星子角动量变化量的负值：\n$$ \\Delta L_{p} = L_{p, f} - L_{p, i} = -(L_{m, f} - L_{m, i}) = -\\Delta L_{m} $$\n\n为了继续，我们必须确定星子的最终角动量 $L_{m, f}$。星子被抛射到一条抛物线轨道上（$E=0$，偏心率 $e=1$）。这次相遇可以在圆形限制性三体问题的框架内进行分析，在该框架下，蒂塞朗参数（Tisserand parameter）是近似守恒的。对于一个半长轴为 $a_m$、偏心率为 $e_m$、倾角为 $i_m$ 的小天体，其相对于行星（半长轴为 $a_p$）的蒂塞朗参数 $T$ 为：\n$$ T = \\frac{a_{p}}{a_{m}} + 2\\sqrt{\\frac{a_{m}}{a_{p}}(1-e_{m}^2)} \\cos(i_{m}) $$\n我们假设轨道是共面的（$i_{m}=0, \\cos(i_{m})=1$），且行星的轨道固定在 $a_p=a$。\n\n最初，星子有 $a_{m, i} = a_{d}$ 和 $e_{m, i} \\approx 0$。初始的蒂塞朗参数为：\n$$ T_{i} = \\frac{a}{a_{d}} + 2\\sqrt{\\frac{a_{d}}{a}(1-0^2)} = \\frac{a}{a_{d}} + 2\\sqrt{\\frac{a_{d}}{a}} $$\n\n最终，星子在一条抛物线轨道上，因此其日心能量为 $E_{m,f} = 0$。由于 $E_{m,f} = -G M_{\\odot} m / (2 a_{m,f})$，这意味着 $1/a_{m,f} = 0$。比角动量为 $h_m = L_m/m = \\sqrt{G M_{\\odot} a_m (1-e_m^2)}$。我们可以将蒂塞朗参数重写为：\n$$ T = \\frac{a}{a_{m}} + \\frac{2 h_m}{\\sqrt{G M_{\\odot} a}} = \\frac{a}{a_{m}} + \\frac{2 L_m}{m \\sqrt{G M_{\\odot} a}} $$\n对于最终状态，当 $1/a_{m,f} = 0$ 时，蒂塞朗参数变为：\n$$ T_{f} = 0 + \\frac{2 L_{m, f}}{m\\sqrt{G M_{\\odot} a}} $$\n\n根据蒂塞朗参数守恒，$T_{i} \\approx T_{f}$：\n$$ \\frac{a}{a_{d}} + 2\\sqrt{\\frac{a_{d}}{a}} = \\frac{2 L_{m, f}}{m\\sqrt{G M_{\\odot} a}} $$\n我们可以解出星子的最终角动量 $L_{m, f}$：\n$$ L_{m, f} = \\frac{m\\sqrt{G M_{\\odot} a}}{2} \\left( \\frac{a}{a_{d}} + 2\\sqrt{\\frac{a_{d}}{a}} \\right) = m\\sqrt{G M_{\\odot}} \\left( \\frac{a^{3/2}}{2a_{d}} + \\sqrt{a_{d}} \\right) $$\n\n现在我们可以计算星子角动量的变化量 $\\Delta L_{m}$：\n$$ \\Delta L_{m} = L_{m, f} - L_{m, i} = m\\sqrt{G M_{\\odot}} \\left( \\frac{a^{3/2}}{2a_{d}} + \\sqrt{a_{d}} \\right) - m\\sqrt{G M_{\\odot} a_{d}} $$\n$$ \\Delta L_{m} = m\\sqrt{G M_{\\odot}} \\frac{a^{3/2}}{2a_{d}} $$\n问题陈述抛射是顺行的，意味着 $\\Delta L_m > 0$。我们的结果是正的，与此条件一致。\n\n根据角动量守恒，$\\Delta L_{p} = -\\Delta L_{m}$：\n$$ \\Delta L_{p} = -m\\sqrt{G M_{\\odot}} \\frac{a^{3/2}}{2a_{d}} $$\n\n最后，我们将我们得到的两个关于 $\\Delta L_{p}$ 的表达式相等，以求解 $\\Delta a$：\n$$ \\frac{M_{p}\\sqrt{G M_{\\odot}}}{2\\sqrt{a}} \\Delta a = -m\\sqrt{G M_{\\odot}} \\frac{a^{3/2}}{2a_{d}} $$\n我们消去两边的公因子 $\\sqrt{G M_{\\odot}}/2$：\n$$ \\frac{M_{p}}{\\sqrt{a}} \\Delta a = -m \\frac{a^{3/2}}{a_{d}} $$\n解出 $\\Delta a$：\n$$ \\Delta a = -\\frac{m}{M_{p}} \\frac{a^{3/2} \\sqrt{a}}{a_{d}} = -\\frac{m}{M_{p}} \\frac{a^2}{a_{d}} $$\n\n结果表明，行星半长轴的变化是负的，意味着行星向内迁移。这是预期的结果：为了抛射一个星子（给予它能量和角动量），行星必须损失能量和角动量，导致其轨道收缩。变化的大小与质量比 $m/M_{p}$ 以及几何因子 $a^2/a_{d}$ 成正比。",
            "answer": "$$ \\boxed{-\\frac{m a^2}{M_{p} a_{d}}} $$"
        },
        {
            "introduction": "在掌握了单个散射事件的物理原理后，我们现在将视角放大到整个系统层面。本练习要求您构建并实现一个简化的尼斯“玩具模型”，以探索大量散射事件的集体效应如何依赖于不确定的初始条件，例如星子盘的质量和位置。通过这项练习，您将获得计算建模和灵敏度分析的实践经验，这是检验复杂天体物理理论的关键技能。",
            "id": "4183489",
            "problem": "考虑一个基于尼斯模型（Nice model）的简化第一性原理敏感性分析，该模型用于解释晚期重轰炸期（LHB）的起源。尼斯模型假定，当一个初始紧凑构型的太阳系巨行星系统与一个其内缘位于海王星轨道之外的星子盘相互作用时，它们在星子散射的驱动下经历了轨道迁移。此处的任务是推导、实现并分析一个简易但有物理基础的模型，该模型用于描绘改变星子盘内缘位置和星子盘质量如何影响太阳系基本观测特征能否被再现。\n\n使用以下基本依据：\n\n- 用于束缚开普勒运动的牛顿二体轨道动力学，其中轨道周期通过开普勒第三定律与半长轴相关：对于一个半长轴为 $a$、围绕质量为 $M_\\odot$ 的太阳运行的行星，其轨道周期满足 $P \\propto a^{3/2}$。因此，周期比满足 $P_S / P_J = (a_S / a_J)^{3/2}$。\n\n- 引力散射事件中的角动量和能量守恒，意味着在与海王星外盘相互作用时，木星会净向内迁移，而土星会净向外迁移。这是由于木星抛出星子的相对效率较高，而土星则倾向于重新分布星子。\n\n- 一个供给受限的相互作用图像：迁移的幅度以及不稳定性发生的时间尺度，取决于海王星能以多快的速度将星子从盘的内缘搅动并输送到散射区域，而这种作用随着海王星与盘内缘之间径向距离的增加而减弱。\n\n您的程序必须：\n\n1. 基于上述基础，推导由外部星子盘引起的木星和土星迁移的符号和定性标度关系。为迁移幅度和撞击通量代理，证明采用与海王星初始半长轴和盘内缘之间间隙距离相关的指数衰减耦合是合理的。明确陈述你所采用的数学形式，并定义所有使用的常数。\n\n2. 对下面指定的每个测试用例，在盘内缘位置 $r_{\\mathrm{in}}$（以天文单位计）和盘质量 $M_d$（以地球质量 $M_\\oplus$ 计）上实现网格搜索。对每个网格点，计算：\n   - 木星和土星的半长轴净偏移量 $\\Delta a_J$ 和 $\\Delta a_S$，并评估最终周期比 $P_S / P_J$。\n   - 不稳定性时间尺度 $t_{\\mathrm{inst}}$（以十亿年计）。\n   - 内太阳系撞击通量代理 $F_{\\mathrm{imp}}$（以地球质量 $M_\\oplus$ 计）。\n\n3. 将一个网格点分类为“再现观测特征”，当且仅当以下所有条件同时成立：\n   - 木星-土星 $2{:}1$ 平均运动共振（MMR）被穿越：$P_S / P_J$ 从一个低于 $2$ 的初始值增加到等于或高于 $2$ 的最终值，其中在每个状态下 $P_S / P_J = (a_S / a_J)^{3/2}$。\n   - 不稳定性发生时间在LHB窗口期内：$t_{\\mathrm{inst}} \\in [0.3, 1.0]$ 十亿年。\n   - 内太阳系生存代理指标显示轰炸水平可接受地低：$F_{\\mathrm{imp}} \\leq F_{\\mathrm{thr}}$。\n\n4. 对每个测试用例，输出：\n   - 再现观测特征的网格点所占的比例（以浮点数表示）。\n   - 在再现特征的点中，$r_{\\mathrm{in}}$ 的最小值和最大值（以天文单位计），如果没有点再现特征，则两者均为 $-1.0$。\n   - 在再现特征的点中，$M_d$ 的最小值和最大值（以地球质量计），如果没有点再现特征，则两者均为 $-1.0$。\n\n使用以下数值设置和常数进行评估；所有下述命名的量在您的推导和实现中必须严格按照规定处理：\n\n- 巨行星初始半长轴：$a_{J,0} = 5.4\\,\\mathrm{AU}$， $a_{S,0} = 7.0\\,\\mathrm{AU}$， $a_{N,0} = 20.0\\,\\mathrm{AU}$。\n- 指数耦合尺度：$L_d = 6.0\\,\\mathrm{AU}$ 用于迁移，$L_i = 4.0\\,\\mathrm{AU}$ 用于撞击通量。\n- 迁移幅度常数（符号和数值必须经过论证）：$k_J = 0.03\\,\\mathrm{AU}\\,M_\\oplus^{-1}$， $k_S = 0.06\\,\\mathrm{AU}\\,M_\\oplus^{-1}$。\n- 不稳定性时间尺度常数：$\\tau_0 = 3.0\\,\\mathrm{Gyr}\\,M_\\oplus\\,\\mathrm{AU}^{-1}$。\n- 内太阳系通量代理常数：$\\beta = 0.02\\,M_\\oplus$。\n- 撞击通量阈值：$F_{\\mathrm{thr}} = 0.5\\,M_\\oplus$。\n\n对每个网格点，令间隙为 $g = r_{\\mathrm{in}} - a_{N,0}$ 并在评估中强制 $g > 0$；$g \\leq 0$ 的网格点必须计为非再现点。\n\n测试套件规范（每个测试定义一个具有均匀步长的矩形网格）：\n\n- 测试 $1$ （理想路径覆盖）：$r_{\\mathrm{in}} \\in [22, 26]\\,\\mathrm{AU}$，步长 $1\\,\\mathrm{AU}$；$M_d \\in [25, 45]\\,M_\\oplus$，步长 $5\\,M_\\oplus$。\n- 测试 $2$ （低质量近边缘边界）：$r_{\\mathrm{in}} \\in [20, 22]\\,\\mathrm{AU}$，步长 $1\\,\\mathrm{AU}$；$M_d \\in [2, 8]\\,M_\\oplus$，步长 $1\\,M_\\oplus$。\n- 测试 $3$ （高质量、短时间尺度边缘）：$r_{\\mathrm{in}} \\in [21, 23]\\,\\mathrm{AU}$，步长 $1\\,\\mathrm{AU}$；$M_d \\in [50, 70]\\,M_\\oplus$，步长 $10\\,M_\\oplus$。\n- 测试 $4$ （远内缘、弱耦合）：$r_{\\mathrm{in}} \\in [28, 32]\\,\\mathrm{AU}$，步长 $1\\,\\mathrm{AU}$；$M_d \\in [40, 60]\\,M_\\oplus$，步长 $10\\,M_\\oplus$。\n\n角度单位未使用。距离必须以天文单位处理，质量以地球质量处理，时间以十亿年处理。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试的结果必须是一个五元列表，顺序为 $[\\text{比例}, \\min r_{\\mathrm{in}}, \\max r_{\\mathrm{in}}, \\min M_d, \\max M_d]$。例如，输出格式为 $[[0.32,22.0,26.0,30.0,45.0],[...],[...],[...]]$，不打印任何额外文本。",
            "solution": "问题陈述已经过严格验证，被认为是具有科学依据、良定、客观且内部一致的。它提出了一个受尼斯模型启发的、关于行星迁移和晚期重轰炸期（LHB）的简化但有物理动机的简易模型，提供了所有必要的参数和清晰的定量评估标准。该问题可按所述方式求解。我们现在着手进行模型的推导及实现。\n\n解决方案包含三个阶段：首先，基于所提供的原理推导物理模型的数学形式；其次，概述使用此模型进行网格搜索的计算算法；第三，实现此算法以解决具体的测试用例。\n\n**1. 物理模型的推导**\n\n该问题要求构建一个模型，用于描述木星和土星半长轴的变化量（$\\Delta a_J$, $\\Delta a_S$）、不稳定性时间尺度（$t_{\\mathrm{inst}}$）以及内太阳系撞击物通量（$F_{\\mathrm{imp}}$），并将它们表示为星子盘内缘（$r_{\\mathrm{in}}$）和质量（$M_d$）的函数。\n\n**1.1. 迁移幅度（$\\Delta a_J$ 和 $\\Delta a_S$）**\n\n物理基础是巨行星与外部星子盘之间的引力散射。\n- **符号的论证**：问题指出木星经历净向内迁移，而土星经历净向外迁移。这是基于尼斯模型的模拟得出的一个已知结果。木星作为质量最大的行星，在将星子从太阳系完全引力抛出方面非常高效。为了抛出一个星子（给予其达到逃逸速度的能量），木星必须损失轨道能量，导致其半长轴收缩。因此，$\\Delta a_J$ 必须为负。土星质量较小，倾向于将星子向内散射，随后这些星子由木星处理。根据角动量和能量守恒，在与星子的相互作用中，土星获得了一个“踢力”，增加了其轨道能量，导致它向外迁移。因此，$\\Delta a_S$ 必须为正。我们因此为木星的迁移常数赋予负号，为土星的迁移常数赋予正号。\n- **标度关系**：半长轴的总变化量与被散射星子的总质量成正比，而后者又与星子盘的总质量 $M_d$ 成正比。\n- **耦合**：相互作用受到海王星从盘内缘扰动星子能力的供给限制。随着海王星初始轨道（$a_{N,0}$）与盘内缘（$r_{\\mathrm{in}}$）之间的间隙 $g = r_{\\mathrm{in}} - a_{N,0}$ 增大，这种耦合会减弱。对于这种减弱效应，指数衰减是一种物理上合理的参数化形式。\n综合以上各点，我们将半长轴的变化定义为：\n$$ \\Delta a_J = -k_J M_d \\exp\\left(-\\frac{g}{L_d}\\right) $$\n$$ \\Delta a_S = +k_S M_d \\exp\\left(-\\frac{g}{L_d}\\right) $$\n其中 $k_J = 0.03\\,\\mathrm{AU}\\,M_\\oplus^{-1}$ 和 $k_S = 0.06\\,\\mathrm{AU}\\,M_\\oplus^{-1}$ 是给定的幅度常数，$M_d$ 是盘质量，$g = r_{\\mathrm{in}} - a_{N,0}$ 是间隙距离，$L_d = 6.0\\,\\mathrm{AU}$ 是迁移耦合的特征长度尺度。那么最终的半长轴为：\n$$ a_{J,f} = a_{J,0} + \\Delta a_J $$\n$$ a_{S,f} = a_{S,0} + \\Delta a_S $$\n初始值为 $a_{J,0} = 5.4\\,\\mathrm{AU}$ 和 $a_{S,0} = 7.0\\,\\mathrm{AU}$。\n\n**1.2. 不稳定性时间尺度（$t_{\\mathrm{inst}}$）**\n\n不稳定性时间尺度是行星系统变得不稳定所需的时间，这是由迁移触发的。这个时间尺度与星子被散射的速率成反比。一个更重的盘（$M_d$）提供更多物质进行散射，从而加速迁移并缩短时间尺度（$t_{\\mathrm{inst}} \\propto 1/M_d$）。一个更大的间隙（$g$）会削弱相互作用，减缓星子的输送速度，从而增加时间尺度（$t_{\\mathrm{inst}} \\propto g$）。问题提供了一个常数 $\\tau_0 = 3.0\\,\\mathrm{Gyr}\\,M_\\oplus\\,\\mathrm{AU}^{-1}$。对该常数的量纲分析证实了与这些物理论证相符的最简单模型：\n$$ t_{\\mathrm{inst}} = \\tau_0 \\frac{g}{M_d} $$\n单位为 $(\\mathrm{Gyr}\\,M_\\oplus\\,\\mathrm{AU}^{-1}) \\cdot (\\mathrm{AU}) / (M_\\oplus) = \\mathrm{Gyr}$，这是正确的。\n\n**1.3. 撞击通量代理（$F_{\\mathrm{imp}}$）**\n\n撞击通量代理 $F_{\\mathrm{imp}}$ 代表了从星子盘中被散射到内太阳系成为撞击物的星子总质量。\n- **标度关系**：这个质量必须与盘中可用的总质量 $M_d$ 成正比。\n- **耦合**：将星子散射到穿越内太阳系轨道的效率也取决于间隙距离 $g$。与迁移一样，当盘被移得更远时，这种效率预计会下降。问题在此处也指定了一个指数耦合模型，但可能具有不同的长度尺度，$L_i = 4.0\\,\\mathrm{AU}$。\n问题提供了一个常数 $\\beta = 0.02$。根据上下文，$F_{\\mathrm{imp}}$ 的单位应为 $M_\\oplus$，因此 $\\beta$ 是一个无量纲分数，代表在理想耦合（$g=0$）下成为撞击物的盘质量部分。采用的形式是：\n$$ F_{\\mathrm{imp}} = \\beta M_d \\exp\\left(-\\frac{g}{L_i}\\right) $$\n这个模型正确地捕捉了撞击物质量随盘质量的增加而增加，并随间隙的增大而减小的特点。\n\n**2. 评估标准与算法**\n\n对于给定网格中的每个点 $(r_{\\mathrm{in}}, M_d)$，我们评估三个条件，以将其分类为“再现观测特征”。\n\n- **条件1：木星-土星 2:1 平均运动共振穿越**：轨道周期比 $P_S/P_J$ 必须从低于 $2$ 穿过到 $2$。根据开普勒第三定律，$P \\propto a^{3/2}$，所以 $P_S/P_J = (a_S/a_J)^{3/2}$。\n初始比率为 $(a_{S,0}/a_{J,0})^{3/2} = (7.0/5.4)^{3/2} \\approx 1.47$，小于 $2$。因此，该条件简化为检查最终比率是否等于或大于 $2$：\n$$ \\left(\\frac{a_{S,f}}{a_{J,f}}\\right)^{3/2} \\geq 2 $$\n\n- **条件2：LHB窗口期**：不稳定性时间尺度必须落在晚期重轰炸期的标准窗口内，即太阳系形成后的 $0.3$ 到 $1.0$ 十亿年之间。\n$$ 0.3\\,\\mathrm{Gyr} \\leq t_{\\mathrm{inst}} \\leq 1.0\\,\\mathrm{Gyr} $$\n\n- **条件3：撞击通量限制**：撞击物的总质量不得超过阈值 $F_{\\mathrm{thr}} = 0.5\\,M_\\oplus$，以确保类地行星的存活。\n$$ F_{\\mathrm{imp}} \\leq 0.5\\,M_\\oplus $$\n\n一个网格点是成功的，当且仅当所有三个条件都满足，并且间隙 $g = r_{\\mathrm{in}} - a_{N,0}$ 必须为正（$g>0$）。\n\n算法是网格搜索：\n1. 对于每个测试用例，定义 $r_{\\mathrm{in}}$ 和 $M_d$ 值的网格。\n2. 初始化一个总点数计数器和一个用于存储成功 $(r_{\\mathrm{in}}, M_d)$ 对的列表。\n3. 遍历网格中的每个 $(r_{\\mathrm{in}}, M_d)$ 对。\n4. 计算 $g = r_{\\mathrm{in}} - a_{N,0}$。如果 $g \\leq 0$，则该点失败。继续下一个点。\n5. 计算 $\\Delta a_J$、$\\Delta a_S$、$a_{J,f}$ 和 $a_{S,f}$。\n6. 计算最终周期比、$t_{\\mathrm{inst}}$ 和 $F_{\\mathrm{imp}}$。\n7. 评估三个成功条件。\n8. 如果所有条件都满足，则存储 $(r_{\\mathrm{in}}, M_d)$ 对。\n9. 遍历完网格后，计算成功点的比例。\n10. 从成功对列表中确定 $r_{\\mathrm{in}}$ 和 $M_d$ 的最小值和最大值。如果没有成功点，则所有四个值均报告为 $-1.0$。\n11. 将所有测试用例的结果整理成指定的输出格式。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Nice model sensitivity analysis problem by performing a grid search\n    over disk inner edge (r_in) and disk mass (M_d) to find parameter\n    combinations that reproduce key Solar System features.\n    \"\"\"\n\n    # --- Numerical Setup and Constants ---\n    # Initial semi-major axes (AU)\n    a_J0 = 5.4\n    a_S0 = 7.0\n    a_N0 = 20.0\n\n    # Exponential coupling scales (AU)\n    L_d = 6.0  # for migration\n    L_i = 4.0  # for impact flux\n\n    # Migration amplitude constants (AU/M_earth)\n    k_J = 0.03\n    k_S = 0.06\n\n    # Instability timescale constant (Gyr * M_earth / AU)\n    tau_0 = 3.0\n\n    # Inner Solar System flux proxy constant (dimensionless fraction)\n    beta = 0.02\n    \n    # Impact flux threshold (M_earth)\n    F_thr = 0.5\n    \n    # --- Test Suite Specification ---\n    # Each tuple defines a test case: (r_in_params, M_d_params)\n    # where params are (start, stop, step)\n    test_cases = [\n        # Test 1\n        ((22, 26, 1), (25, 45, 5)),\n        # Test 2\n        ((20, 22, 1), (2, 8, 1)),\n        # Test 3\n        ((21, 23, 1), (50, 70, 10)),\n        # Test 4\n        ((28, 32, 1), (40, 60, 10)),\n    ]\n\n    # --- Initial State Calculation ---\n    # The condition is that the MMR is CROSSED from below 2.\n    # We can pre-calculate the initial period ratio to confirm it's  2.\n    p_ratio_initial = (a_S0 / a_J0)**1.5\n    # This value is ~1.47, so the initial condition is always met.\n\n    final_results = []\n\n    for r_in_params, M_d_params in test_cases:\n        r_in_start, r_in_stop, r_in_step = r_in_params\n        M_d_start, M_d_stop, M_d_step = M_d_params\n        \n        # Generate grid points. Add a small epsilon to stop to ensure inclusion\n        # for integer steps, or use `stop + step`.\n        r_in_grid = np.arange(r_in_start, r_in_stop + r_in_step, r_in_step)\n        M_d_grid = np.arange(M_d_start, M_d_stop + M_d_step, M_d_step)\n\n        total_points = 0\n        reproducing_points = []\n\n        for r_in in r_in_grid:\n            for M_d in M_d_grid:\n                total_points += 1\n\n                # Calculate gap and enforce g > 0\n                g = r_in - a_N0\n                if g = 0:\n                    continue\n\n                # 1. Calculate migration\n                exp_coupling_d = np.exp(-g / L_d)\n                delta_a_J = -k_J * M_d * exp_coupling_d\n                delta_a_S = k_S * M_d * exp_coupling_d\n                \n                a_J_f = a_J0 + delta_a_J\n                a_S_f = a_S0 + delta_a_S\n\n                # 2. Compute observables\n                # Ensure a_J_f > 0 to avoid division by zero\n                if a_J_f = 0:\n                    continue\n\n                p_ratio_final = (a_S_f / a_J_f)**1.5\n                t_inst = tau_0 * g / M_d\n                \n                exp_coupling_i = np.exp(-g / L_i)\n                F_imp = beta * M_d * exp_coupling_i\n\n                # 3. Check conditions\n                # Condition 1: 2:1 MMR crossing\n                cond1_mmr = p_ratio_final >= 2.0\n                \n                # Condition 2: LHB timescale window\n                cond2_time = 0.3 = t_inst = 1.0\n                \n                # Condition 3: Impact flux survival\n                cond3_flux = F_imp = F_thr\n                \n                if cond1_mmr and cond2_time and cond3_flux:\n                    reproducing_points.append((r_in, M_d))\n\n        # 4. Aggregate results for the test case\n        if not reproducing_points:\n            fraction = 0.0\n            min_rin, max_rin = -1.0, -1.0\n            min_Md, max_Md = -1.0, -1.0\n        else:\n            fraction = len(reproducing_points) / total_points\n            \n            successful_rins = [p[0] for p in reproducing_points]\n            successful_Mds = [p[1] for p in reproducing_points]\n            \n            min_rin = float(min(successful_rins))\n            max_rin = float(max(successful_rins))\n            min_Md = float(min(successful_Mds))\n            max_Md = float(max(successful_Mds))\n\n        final_results.append([fraction, min_rin, max_rin, min_Md, max_Md])\n        \n    # Final print statement in the exact required format without spaces\n    results_str_list = []\n    for res_list in final_results:\n        # Convert all numbers to string for joining\n        # The output spec shows floats e.g. 22.0, so we ensure they are floats\n        # to get the .0 in the string representation.\n        str_items = [str(float(item)) for item in res_list]\n        str_items[0] = str(res_list[0]) # keep fraction as is\n        results_str_list.append(f\"[{','.join(str_items)}]\")\n        \n    output_str = f\"[{','.join(results_str_list)}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "任何科学模型的最终检验标准在于其是否能与观测数据相契合。这最后一个练习将带您从理论和模拟转向统计分析，要求您评估月球撞击数据中支持“后期重轰炸期”的证据。通过推导和计算似然比，您将学会如何定量地比较尼斯模型的关键预测——也即后期重轰炸假说——与一个更简单的稳态模型。",
            "id": "4183603",
            "problem": "巨行星迁移的尼斯模型 (Nice model) 的一个核心预测是，在时间 $t \\approx 3.9$ 十亿年 (giga-annum, Ga) 附近，内太阳系的撞击通量会出现一个短暂的峰值，从而产生了晚期重轰炸 (Late Heavy Bombardment, LHB)。假设在时长为 $T = t_2 - t_1 = 0.60$ Ga 的区间 $[t_1, t_2] = [4.25, 3.65]$ Ga 内，汇编了一个包含 $N$ 个均匀采样的月球撞击熔融年龄的目录。其中，$k$ 个年龄落在宽度为 $w = 0.10$ Ga 的假设 LHB 窗口 $[3.85, 3.95]$ Ga 内，其余的 $N - k$ 个年龄落在该窗口之外，即时长为 $o = T - w = 0.50$ Ga 的补集内。数据集为 $N = 22$ 和 $k = 11$。\n\n模型 $M_0$ (稳态) 假设在 $[t_1, t_2]$ 上存在一个速率恒为 $\\lambda_0$ 的齐次泊松点过程。模型 $M_1$ (瞬时 LHB) 假设存在一个分段恒定的泊松速率 $\\lambda(t)$，使得在 LHB 窗口内 $\\lambda(t) = \\lambda_H$，窗口外 $\\lambda(t) = \\lambda_L$，其中增强因子 $f$ 定义为 $\\lambda_H = f \\lambda_L$。在本练习中，取 $f = 6$，这与尼斯模型的一些校准中所预测的撞击物投送的短暂增加相一致。\n\n从速率为 $\\lambda(t)$ 的泊松点过程的定义出发，并仅使用点过程似然的第一性原理（不相交区间中的计数是独立的泊松分布，其均值等于时间积分速率，并以总计数 $N$ 为条件），推导出似然比\n$$\nK \\equiv \\frac{\\mathcal{L}(M_1)}{\\mathcal{L}(M_0)}\n$$\n即在 LHB 窗口内观测到 $k$ 个年龄，在窗口外观测到 $N-k$ 个年龄的似然比，给定指定的 $T$、$w$、$o$、$N$、$k$ 和 $f$。将 $K$ 的最终答案表示为一个无量纲实数，并将答案保留三位有效数字。",
            "solution": "问题要求计算关于月球撞击年龄的两个竞争模型的似然比 $K \\equiv \\mathcal{L}(M_1)/\\mathcal{L}(M_0)$，条件是观测到的总撞击数。我们将从第一性原理出发，为每个模型推导条件似然，然后计算它们的比值。\n\n在区间 $[t_a, t_b]$ 上，一个速率随时间变化 $\\lambda(t)$ 的非齐次泊松点过程具有这样的性质：在任何子区间 $[t_c, t_d] \\subseteq [t_a, t_b]$ 内的事件数 $n$ 服从泊松分布，其均值为 $\\mu = \\int_{t_c}^{t_d} \\lambda(\\tau) d\\tau$。观测到 $n$ 个事件的概率由下式给出：\n$$\nP(n; \\mu) = \\frac{\\mu^n e^{-\\mu}}{n!}\n$$\n此外，在不相交的时间区间内，事件的计数在统计上是独立的。\n\n问题描述了在两个不相交区间内的观测结果：一个是时长为 $w = 0.10$ Ga 的晚期重轰炸 (LHB) 窗口，另一个是其在总时间跨度内的补集，时长为 $o = 0.50$ Ga。总观测时长为 $T = w + o = 0.60$ Ga。数据包括在 LHB 窗口内观测到的 $k = 11$ 次撞击，以及在补集内观测到的 $N-k = 22 - 11 = 11$ 次撞击，总计 $N=22$ 次撞击。\n\n分析将以总撞击数 $N$ 为条件进行。对于一个速率为 $\\lambda(t)$ 的通用模型，设 $\\mu_w = \\int_{\\text{LHB 窗口}} \\lambda(t) dt$ 为窗口内的期望撞击数，$\\mu_o = \\int_{\\text{补集}} \\lambda(t) dt$ 为补集内的期望撞击数。总期望撞击数为 $\\mu_N = \\mu_w + \\mu_o$。\n\n在窗口内观测到 $k$ 次撞击和在补集内观测到 $N-k$ 次撞击的联合概率是两个独立泊松概率的乘积：\n$$\nP(\\text{$k$ 在窗口内, $N-k$ 在补集内}) = P(k; \\mu_w) \\times P(N-k; \\mu_o) = \\frac{\\mu_w^k e^{-\\mu_w}}{k!} \\frac{\\mu_o^{N-k} e^{-\\mu_o}}{(N-k)!}\n$$\n在整个时长 $T$ 内观测到总共 $N$ 次撞击的概率是：\n$$\nP(\\text{总数为 } N) = P(N; \\mu_N) = \\frac{\\mu_N^N e^{-\\mu_N}}{N!} = \\frac{(\\mu_w + \\mu_o)^N e^{-(\\mu_w + \\mu_o)}}{N!}\n$$\n在总共有 $N$ 次撞击的条件下，观测到窗口内有 $k$ 次撞击的条件似然是这些概率的比值：\n$$\n\\mathcal{L} \\equiv P(\\text{$k$ 在窗口内 } | \\text{ 总数为 } N) = \\frac{P(\\text{$k$ 在窗口内, $N-k$ 在补集内})}{P(\\text{总数为 } N)}\n$$\n$$\n\\mathcal{L} = \\frac{\\frac{\\mu_w^k e^{-\\mu_w}}{k!} \\frac{\\mu_o^{N-k} e^{-\\mu_o}}{(N-k)!}}{\\frac{(\\mu_w + \\mu_o)^N e^{-(\\mu_w + \\mu_o)}}{N!}} = \\frac{N!}{k!(N-k)!} \\frac{\\mu_w^k \\mu_o^{N-k}}{(\\mu_w + \\mu_o)^N}\n$$\n这是二项分布 $\\text{Binom}(N, p)$ 的概率质量函数，其中“成功”（一次撞击落在窗口内）的概率是 $p = \\frac{\\mu_w}{\\mu_w + \\mu_o}$。\n$$\n\\mathcal{L} = \\binom{N}{k} p^k (1-p)^{N-k}\n$$\n我们现在将这个通用公式应用于我们的两个特定模型，$M_0$ 和 $M_1$。\n\n**模型 $M_0$ (稳态)**\n该模型假设撞击速率恒为 $\\lambda(t) = \\lambda_0$。\nLHB 窗口内的期望撞击数为 $\\mu_{0,w} = \\int_{\\text{LHB 窗口}} \\lambda_0 dt = \\lambda_0 w$。\n补集内的期望撞击数为 $\\mu_{0,o} = \\int_{\\text{补集}} \\lambda_0 dt = \\lambda_0 o$。\n模型 $M_0$ 的“成功”概率为：\n$$\np_0 = \\frac{\\mu_{0,w}}{\\mu_{0,w} + \\mu_{0,o}} = \\frac{\\lambda_0 w}{\\lambda_0 w + \\lambda_0 o} = \\frac{w}{w+o} = \\frac{w}{T}\n$$\n因此，模型 $M_0$ 的条件似然为：\n$$\n\\mathcal{L}(M_0) = \\binom{N}{k} p_0^k (1-p_0)^{N-k} = \\binom{N}{k} \\left(\\frac{w}{T}\\right)^k \\left(\\frac{o}{T}\\right)^{N-k}\n$$\n\n**模型 $M_1$ (瞬时 LHB)**\n该模型假设一个分段恒定的速率：窗口内为 $\\lambda_H$，补集内为 $\\lambda_L$，且 $\\lambda_H = f \\lambda_L$。给定的增强因子为 $f=6$。\nLHB 窗口内的期望撞击数为 $\\mu_{1,w} = \\int_{\\text{LHB 窗口}} \\lambda_H dt = \\lambda_H w = f \\lambda_L w$。\n补集内的期望撞击数为 $\\mu_{1,o} = \\int_{\\text{补集}} \\lambda_L dt = \\lambda_L o$。\n模型 $M_1$ 的“成功”概率为：\n$$\np_1 = \\frac{\\mu_{1,w}}{\\mu_{1,w} + \\mu_{1,o}} = \\frac{f \\lambda_L w}{f \\lambda_L w + \\lambda_L o} = \\frac{fw}{fw+o}\n$$\n模型 $M_1$ 的条件似然为：\n$$\n\\mathcal{L}(M_1) = \\binom{N}{k} p_1^k (1-p_1)^{N-k} = \\binom{N}{k} \\left(\\frac{fw}{fw+o}\\right)^k \\left(\\frac{o}{fw+o}\\right)^{N-k}\n$$\n\n**似然比 $K$**\n我们现在可以计算所求的似然比 $K = \\mathcal{L}(M_1)/\\mathcal{L}(M_0)$。\n$$\nK = \\frac{\\binom{N}{k} \\left(\\frac{fw}{fw+o}\\right)^k \\left(\\frac{o}{fw+o}\\right)^{N-k}}{\\binom{N}{k} \\left(\\frac{w}{T}\\right)^k \\left(\\frac{o}{T}\\right)^{N-k}}\n$$\n二项式系数 $\\binom{N}{k}$ 消去。重新整理各项：\n$$\nK = \\frac{(fw)^k o^{N-k}}{(fw+o)^N} \\times \\frac{T^N}{w^k o^{N-k}}\n$$\n$w^k$ 和 $o^{N-k}$ 项也消去：\n$$\nK = \\frac{f^k}{(fw+o)^N} \\times T^N = f^k \\left(\\frac{T}{fw+o}\\right)^N\n$$\n代入 $T = w+o$：\n$$\nK = f^k \\left(\\frac{w+o}{fw+o}\\right)^N\n$$\n这是似然比的最终符号表达式。\n\n**数值计算**\n给定以下数值：\n$N = 22$\n$k = 11$\n$f = 6$\n$w = 0.10$ Ga\n$o = 0.50$ Ga\n$T = w+o = 0.60$ Ga\n\n将这些值代入 $K$ 的表达式中：\n$$\nK = 6^{11} \\left(\\frac{0.10 + 0.50}{6 \\times 0.10 + 0.50}\\right)^{22}\n$$\n$$\nK = 6^{11} \\left(\\frac{0.60}{0.60 + 0.50}\\right)^{22}\n$$\n$$\nK = 6^{11} \\left(\\frac{0.60}{1.10}\\right)^{22} = 6^{11} \\left(\\frac{6}{11}\\right)^{22}\n$$\n我们现在计算其数值：\n$6^{11} = 362,797,056$\n$\\left(\\frac{6}{11}\\right) \\approx 0.545454...$\n$\\left(\\frac{6}{11}\\right)^{22} \\approx 1.6166410 \\times 10^{-6}$\n$$\nK \\approx 362,797,056 \\times (1.6166410 \\times 10^{-6}) \\approx 586.538\n$$\n保留三位有效数字，我们得到 $587$。\n$K$ 的值很大，表明在 LHB 模型 ($M_1$) 下观测到这些数据的可能性，远大于在稳态模型 ($M_0$) 下的可能性，这为撞击通量存在一个短暂峰值的观点提供了强有力的证据。",
            "answer": "$$\\boxed{587}$$"
        }
    ]
}