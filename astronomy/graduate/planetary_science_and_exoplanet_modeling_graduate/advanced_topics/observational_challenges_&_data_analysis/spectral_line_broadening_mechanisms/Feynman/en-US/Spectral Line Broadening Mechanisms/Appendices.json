{
    "hands_on_practices": [
        {
            "introduction": "Understanding the observed shape of a spectral line begins with its fundamental components. This first exercise  guides you through a foundational calculation, contrasting the intrinsic width of a spectral line due to quantum mechanics (natural broadening) with the broadening caused by the thermal motion of atoms in a hot atmosphere (Doppler broadening). By computing and comparing these widths for a typical hot Jupiter scenario, you will gain a crucial intuition for which mechanism dominates and sets the scale for the observable line core.",
            "id": "4178782",
            "problem": "A hot Jupiter exoplanet atmosphere exhibits a prominent carbon monoxide (CO) rovibrational transition centered at wavenumber $\\sigma_{0} = 2000\\ \\mathrm{cm}^{-1}$. The upper-to-lower spontaneous emission probability (Einstein coefficient) of this transition is $A_{ul} = 1.0 \\times 10^{7}\\ \\mathrm{s}^{-1}$. Assume the absence of pure dephasing and that collisions are negligible, so the only homogeneous broadening mechanism is natural (radiative) broadening.\n\nUsing fundamental definitions of lifetime and coherence, compute the natural half width at half maximum $\\gamma$ and the full width at half maximum $2\\gamma$ in both Hertz (Hz) and inverse centimeters ($\\mathrm{cm}^{-1}$). Then, using the Maxwell–Boltzmann distribution for the line-of-sight velocity component and the nonrelativistic Doppler shift, assess the magnitude of these natural widths relative to the thermal Doppler full width at half maximum at temperature $T = 1000\\ \\mathrm{K}$ for CO of mass $m = 28\\ \\mathrm{u}$, at the given line center. Express all widths in Hertz (Hz) and inverse centimeters ($\\mathrm{cm}^{-1}$). Round your final numerical answers for $\\gamma$ and $2\\gamma$ to four significant figures.\n\nUse the following constants as needed: Boltzmann constant $k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K}^{-1}$, atomic mass unit $1\\ \\mathrm{u} = 1.66053906660 \\times 10^{-27}\\ \\mathrm{kg}$, speed of light $c = 2.99792458 \\times 10^{8}\\ \\mathrm{m\\,s}^{-1} = 2.99792458 \\times 10^{10}\\ \\mathrm{cm\\,s}^{-1}$, and $\\pi = 3.141592653589793$.",
            "solution": "The problem asks for the calculation of the natural broadening widths (half width at half maximum, $\\gamma$, and full width at half maximum, $2\\gamma$) and an assessment of their magnitude relative to the thermal Doppler broadening width for a specific rovibrational transition of carbon monoxide ($CO$).\n\n### Part 1: Natural Broadening\n\nNatural broadening, also known as radiative broadening, is a homogeneous broadening mechanism that arises from the finite lifetime of an excited quantum state due to spontaneous emission. The Heisenberg uncertainty principle dictates a relationship between the lifetime of a state, $\\tau$, and the uncertainty in its energy, $\\Delta E$, given by $\\Delta E \\cdot \\tau \\approx \\hbar$. The full width at half maximum (FWHM) of the resulting Lorentzian spectral line profile, when expressed in energy units, is $\\Gamma_E = \\Delta E = \\hbar/\\tau$.\n\nThe lifetime of the upper state, $\\tau_{ul}$, is the reciprocal of the total spontaneous emission rate from that state. In this problem, we consider a single transition with an Einstein coefficient for spontaneous emission $A_{ul}$. Thus, the lifetime is $\\tau_{ul} = 1/A_{ul}$.\n\nThe FWHM, expressed in units of angular frequency ($\\mathrm{rad\\,s}^{-1}$), is given by:\n$$\n\\Delta\\omega = \\frac{1}{\\tau_{ul}} = A_{ul}\n$$\nThe problem requests the widths in ordinary frequency, $\\nu$, measured in Hertz ($Hz$), and in wavenumber, $\\sigma$, measured in inverse centimeters ($cm^{-1}$). The relationship between angular frequency and ordinary frequency is $\\omega = 2\\pi\\nu$. Therefore, the FWHM in Hertz is:\n$$\n2\\gamma_{\\nu} = \\Delta\\nu = \\frac{\\Delta\\omega}{2\\pi} = \\frac{A_{ul}}{2\\pi}\n$$\nThe half width at half maximum (HWHM) in Hertz is:\n$$\n\\gamma_{\\nu} = \\frac{2\\gamma_{\\nu}}{2} = \\frac{A_{ul}}{4\\pi}\n$$\nUsing the given value $A_{ul} = 1.0 \\times 10^{7}\\ \\mathrm{s}^{-1}$:\n$$\n2\\gamma_{\\nu} = \\frac{1.0 \\times 10^{7}\\ \\mathrm{s}^{-1}}{2\\pi} \\approx 1.591549 \\times 10^{6}\\ \\mathrm{Hz}\n$$\n$$\n\\gamma_{\\nu} = \\frac{1.0 \\times 10^{7}\\ \\mathrm{s}^{-1}}{4\\pi} \\approx 7.957747 \\times 10^{5}\\ \\mathrm{Hz}\n$$\nRounding to four significant figures as required:\n$2\\gamma_{\\nu} \\approx 1.592 \\times 10^{6}\\ \\mathrm{Hz}$\n$\\gamma_{\\nu} \\approx 7.958 \\times 10^{5}\\ \\mathrm{Hz}$\n\nTo convert from frequency ($\\nu$) to wavenumber ($\\sigma$), we use the relation $\\nu = c\\sigma$, where $c$ is the speed of light. The widths in wavenumber are therefore $\\Delta\\sigma = \\Delta\\nu / c$. We must use $c$ in units of $\\mathrm{cm\\,s}^{-1}$ to obtain a result in $\\mathrm{cm}^{-1}$, i.e., $c = 2.99792458 \\times 10^{10}\\ \\mathrm{cm\\,s}^{-1}$.\n\nThe FWHM in $\\mathrm{cm}^{-1}$ is:\n$$\n2\\gamma_{\\sigma} = \\frac{2\\gamma_{\\nu}}{c} = \\frac{A_{ul}}{2\\pi c} \\approx \\frac{1.591549 \\times 10^{6}\\ \\mathrm{s}^{-1}}{2.99792458 \\times 10^{10}\\ \\mathrm{cm\\,s}^{-1}} \\approx 5.30884 \\times 10^{-5}\\ \\mathrm{cm}^{-1}\n$$\nThe HWHM in $\\mathrm{cm}^{-1}$ is:\n$$\n\\gamma_{\\sigma} = \\frac{\\gamma_{\\nu}}{c} = \\frac{A_{ul}}{4\\pi c} \\approx \\frac{7.957747 \\times 10^{5}\\ \\mathrm{s}^{-1}}{2.99792458 \\times 10^{10}\\ \\mathrm{cm\\,s}^{-1}} \\approx 2.65442 \\times 10^{-5}\\ \\mathrm{cm}^{-1}\n$$\nRounding to four significant figures:\n$2\\gamma_{\\sigma} \\approx 5.309 \\times 10^{-5}\\ \\mathrm{cm}^{-1}$\n$\\gamma_{\\sigma} \\approx 2.654 \\times 10^{-5}\\ \\mathrm{cm}^{-1}$\n\n### Part 2: Thermal Doppler Broadening\n\nThermal Doppler broadening is an inhomogeneous broadening mechanism caused by the thermal motion of the emitting or absorbing molecules. The random motion of molecules relative to the observer leads to a distribution of Doppler shifts, resulting in a broadened spectral line with a Gaussian profile.\n\nThe FWHM of the Doppler-broadened line profile in frequency units is given by:\n$$\n\\Delta\\nu_D = 2\\nu_0 \\sqrt{\\frac{2 k_B T \\ln(2)}{mc^2}}\n$$\nwhere $\\nu_0$ is the line center frequency, $k_B$ is the Boltzmann constant, $T$ is the temperature, $m$ is the mass of the molecule, and $c$ is the speed of light. Alternatively, in wavenumber units:\n$$\n\\Delta\\sigma_D = 2\\sigma_0 \\sqrt{\\frac{2 k_B T \\ln(2)}{mc^2}}\n$$\nWe are given:\n-   Line center wavenumber $\\sigma_0 = 2000\\ \\mathrm{cm}^{-1}$\n-   Temperature $T = 1000\\ \\mathrm{K}$\n-   Mass of $CO$, $m = 28\\ \\mathrm{u}$\n\nFirst, we convert the mass to SI units:\n$$\nm = 28\\ \\mathrm{u} \\times (1.66053906660 \\times 10^{-27}\\ \\mathrm{kg/u}) = 4.649509386 \\times 10^{-26}\\ \\mathrm{kg}\n$$\nNow, we calculate the term under the square root using SI units:\n-   $k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K}^{-1}$\n-   $c = 2.99792458 \\times 10^{8}\\ \\mathrm{m\\,s}^{-1}$\n-   $2k_B T = 2 \\times (1.380649 \\times 10^{-23}) \\times 1000 = 2.761298 \\times 10^{-20}\\ \\mathrm{J}$\n-   $mc^2 = (4.649509386 \\times 10^{-26}) \\times (2.99792458 \\times 10^{8})^2 \\approx 4.178864 \\times 10^{-9}\\ \\mathrm{J}$\n-   $\\ln(2) \\approx 0.693147$\n$$\n\\sqrt{\\frac{2 k_B T \\ln(2)}{mc^2}} = \\sqrt{\\frac{(2.761298 \\times 10^{-20}) \\times 0.693147}{4.178864 \\times 10^{-9}}} \\approx 2.14020 \\times 10^{-6}\n$$\nNow we can compute the Doppler FWHM in $\\mathrm{cm}^{-1}$:\n$$\n\\Delta\\sigma_D = 2 \\times (2000\\ \\mathrm{cm}^{-1}) \\times (2.14020 \\times 10^{-6}) \\approx 0.0085608\\ \\mathrm{cm}^{-1}\n$$\nAnd in Hertz:\n$$\n\\Delta\\nu_D = \\Delta\\sigma_D \\times c = (0.0085608\\ \\mathrm{cm}^{-1}) \\times (2.99792458 \\times 10^{10}\\ \\mathrm{cm\\,s}^{-1}) \\approx 2.56648 \\times 10^{8}\\ \\mathrm{Hz}\n$$\n\n### Part 3: Assessment and Comparison\n\nWe now compare the magnitudes of the natural and Doppler FWHMs.\n\nNatural FWHM:\n-   $2\\gamma_{\\nu} \\approx 1.592 \\times 10^{6}\\ \\mathrm{Hz}$\n-   $2\\gamma_{\\sigma} \\approx 5.309 \\times 10^{-5}\\ \\mathrm{cm}^{-1}$\n\nDoppler FWHM:\n-   $\\Delta\\nu_D \\approx 2.566 \\times 10^{8}\\ \\mathrm{Hz}$\n-   $\\Delta\\sigma_D \\approx 8.561 \\times 10^{-3}\\ \\mathrm{cm}^{-1}$\n\nTo assess their relative magnitudes, we can take their ratio:\n$$\n\\frac{\\Delta\\nu_D}{2\\gamma_{\\nu}} \\approx \\frac{2.566 \\times 10^{8}}{1.592 \\times 10^{6}} \\approx 161\n$$\n$$\n\\frac{\\Delta\\sigma_D}{2\\gamma_{\\sigma}} \\approx \\frac{8.561 \\times 10^{-3}}{5.309 \\times 10^{-5}} \\approx 161\n$$\nThe assessment is clear: the thermal Doppler FWHM is approximately $161$ times larger than the natural FWHM. Under these conditions of a high-temperature atmosphere and in the infrared spectral region, Doppler broadening is the dominant broadening mechanism. The overall spectral line shape, which is a convolution of the Lorentzian (natural) and Gaussian (Doppler) profiles, known as a Voigt profile, will be overwhelmingly dominated by the Gaussian component.\n\nThe final requested answers are the natural widths, rounded to four significant figures.\n-   $\\gamma_{\\nu} = 7.958 \\times 10^{5}\\ \\mathrm{Hz}$\n-   $2\\gamma_{\\nu} = 1.592 \\times 10^{6}\\ \\mathrm{Hz}$\n-   $\\gamma_{\\sigma} = 2.654 \\times 10^{-5}\\ \\mathrm{cm}^{-1}$\n-   $2\\gamma_{\\sigma} = 5.309 \\times 10^{-5}\\ \\mathrm{cm}^{-1}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 7.958 \\times 10^{5} & 1.592 \\times 10^{6} & 2.654 \\times 10^{-5} & 5.309 \\times 10^{-5} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While understanding individual broadening mechanisms is essential, their combined effect determines the final line shape. This practice  introduces the dimensionless damping parameter, $a$, a cornerstone concept in radiative transfer that quantifies the relative importance of Lorentzian and Gaussian broadening. Calculating this parameter for a water vapor line will allow you to assess the line's character and understand when the Lorentzian wings become a significant feature in the overall Voigt profile.",
            "id": "4178729",
            "problem": "A transmission spectrum of a hot Jupiter reveals strong water vapor absorption in the near-infrared. Consider a single rovibrational transition of water vapor with line center frequency $\\nu_{0}$ and Einstein spontaneous emission coefficient $A_{ul}$. Assume the gas is in Local Thermodynamic Equilibrium (LTE) and that velocity distributions are Maxwellian. Neglect collisional and inhomogeneous broadening so that the Lorentzian half-width at half-maximum (HWHM) arises purely from the finite radiative lifetime. The line profile in radiative transfer is often represented by a Voigt function, which depends on the dimensionless damping parameter $a$, defined here as $a = \\gamma / \\Delta \\nu_{D}$, where $\\gamma$ is the Lorentzian HWHM in frequency units and $\\Delta \\nu_{D}$ is the Doppler width parameter associated with thermal motions.\n\nStarting from fundamental definitions for radiative decay and thermal Doppler shifts, derive $\\gamma$ from $A_{ul}$ and $\\Delta \\nu_{D}$ from $\\nu_{0}$, temperature $T$, and molecular mass $m$, and then evaluate $a$. Use the following parameters representative of hot Jupiter conditions:\n- $A_{ul} = 20 \\ \\mathrm{s}^{-1}$,\n- $\\nu_{0} = 2.1413747 \\times 10^{14} \\ \\mathrm{Hz}$,\n- $T = 1800 \\ \\mathrm{K}$,\n- $m = 3.0 \\times 10^{-26} \\ \\mathrm{kg}$,\n- $k_{B} = 1.380649 \\times 10^{-23} \\ \\mathrm{J \\, K^{-1}}$,\n- $c = 2.99792458 \\times 10^{8} \\ \\mathrm{m \\, s^{-1}}$.\n\nRound your final numerical value of $a$ to three significant figures and express it as a dimensionless number. Based on your computed $a$, state whether natural broadening significantly affects the Voigt core or the wings under these hot Jupiter conditions.",
            "solution": "The problem requires the derivation and calculation of the dimensionless Voigt damping parameter, $a$, and an interpretation of its value in the context of spectral line broadening mechanisms in a hot Jupiter atmosphere.\n\nThe dimensionless damping parameter $a$ is defined as the ratio of the Lorentzian half-width at half-maximum (HWHM), $\\gamma$, to the Doppler width parameter, $\\Delta \\nu_{D}$:\n$$a = \\frac{\\gamma}{\\Delta \\nu_{D}}$$\n\nFirst, we must derive the expressions for $\\gamma$ and $\\Delta \\nu_{D}$ from the fundamental principles and parameters given.\n\nThe problem states that the Lorentzian broadening arises purely from the finite radiative lifetime (natural broadening), neglecting collisional effects. The natural line shape of a transition is a Lorentzian, whose width is determined by the lifetime of the excited state. The total decay rate from an upper energy level $u$, denoted $\\Gamma_{u}$, is the sum of the Einstein spontaneous emission coefficients $A_{ul'}$ for all possible downward transitions to lower levels $l'$. In this simplified problem, we consider only a single transition with coefficient $A_{ul}$, so the total decay rate is $\\Gamma_{u} = A_{ul}$. The lifetime of the upper state is $\\tau_u = 1/\\Gamma_{u} = 1/A_{ul}$.\n\nThe relationship between the lifetime and the energy uncertainty of the state is given by the Heisenberg uncertainty principle, $\\Delta E \\cdot \\tau_u \\approx \\hbar$, where $\\hbar = h/(2\\pi)$. The energy spread $\\Delta E$ corresponds to a frequency spread $\\Delta \\nu$ of the emitted photon, where $\\Delta E = h \\Delta \\nu$. Substituting these gives $h \\Delta \\nu \\cdot \\frac{1}{A_{ul}} \\approx \\frac{h}{2\\pi}$, which leads to $\\Delta \\nu \\approx \\frac{A_{ul}}{2\\pi}$. This frequency spread $\\Delta \\nu$ represents the Full Width at Half-Maximum (FWHM) of the Lorentzian power spectrum. The problem asks for the HWHM, denoted $\\gamma$.\n$$\\gamma = \\frac{\\text{FWHM}}{2} = \\frac{1}{2} \\left( \\frac{A_{ul}}{2\\pi} \\right) = \\frac{A_{ul}}{4\\pi}$$\n\nNext, we derive the Doppler width parameter $\\Delta \\nu_{D}$. This arises from the thermal motion of the absorbing molecules. For a gas in Local Thermodynamic Equilibrium (LTE), the velocity components follow a Maxwell-Boltzmann distribution. The line-of-sight velocity component, $v_r$, has a Gaussian probability distribution. The first-order Doppler shift in frequency is given by $\\Delta \\nu = \\nu - \\nu_0 = \\nu_0 \\frac{v_r}{c}$. The resulting spectral line profile is Gaussian, which can be written as:\n$$\\phi(\\nu) \\propto \\exp\\left( - \\frac{(\\nu - \\nu_0)^2}{(\\Delta\\nu_D)^2} \\right)$$\nThe parameter $\\Delta\\nu_D$ is the Doppler width, defined as the frequency shift at which the profile intensity drops to $1/e$ of its central value. To relate this to the physical parameters, we consider the one-dimensional Maxwellian distribution of velocities, where the most probable speed is $v_p = \\sqrt{2 k_B T / m}$. The Doppler width $\\Delta\\nu_D$ corresponds to the frequency shift caused by an atom moving at this most probable speed along the line of sight.\n$$\\Delta \\nu_{D} = \\nu_0 \\frac{v_p}{c} = \\nu_0 \\frac{1}{c} \\sqrt{\\frac{2 k_B T}{m}} = \\nu_0 \\sqrt{\\frac{2 k_B T}{mc^2}}$$\n\nNow we can write the full expression for the damping parameter $a$:\n$$a = \\frac{\\gamma}{\\Delta \\nu_{D}} = \\frac{A_{ul} / (4\\pi)}{\\nu_0 \\sqrt{\\frac{2 k_B T}{mc^2}}} = \\frac{A_{ul}}{4\\pi \\nu_0} \\sqrt{\\frac{mc^2}{2 k_B T}}$$\n\nWe are given the following values:\n-   $A_{ul} = 20 \\ \\mathrm{s}^{-1}$\n-   $\\nu_{0} = 2.1413747 \\times 10^{14} \\ \\mathrm{Hz}$\n-   $T = 1800 \\ \\mathrm{K}$\n-   $m = 3.0 \\times 10^{-26} \\ \\mathrm{kg}$\n-   $k_{B} = 1.380649 \\times 10^{-23} \\ \\mathrm{J \\, K^{-1}}$\n-   $c = 2.99792458 \\times 10^{8} \\ \\mathrm{m \\, s^{-1}}$\n\nWe substitute these values into the expression for $a$:\n$$a = \\frac{20}{4\\pi (2.1413747 \\times 10^{14})} \\sqrt{\\frac{(3.0 \\times 10^{-26})(2.99792458 \\times 10^{8})^2}{2 (1.380649 \\times 10^{-23})(1800)}}$$\nFirst, we compute the term inside the square root:\n$$\\frac{mc^2}{2 k_B T} = \\frac{(3.0 \\times 10^{-26} \\ \\mathrm{kg}) (2.99792458 \\times 10^{8} \\ \\mathrm{m \\, s^{-1}})^2}{2 (1.380649 \\times 10^{-23} \\ \\mathrm{J \\, K^{-1}}) (1800 \\ \\mathrm{K})} \\approx \\frac{2.6962655 \\times 10^{-9} \\ \\mathrm{J}}{4.9703364 \\times 10^{-20} \\ \\mathrm{J}} \\approx 5.424781 \\times 10^{10}$$\nNow, we take the square root:\n$$\\sqrt{5.424781 \\times 10^{10}} \\approx 2.329116 \\times 10^{5}$$\nNext, we compute the pre-factor:\n$$\\frac{A_{ul}}{4\\pi \\nu_0} = \\frac{20 \\ \\mathrm{s}^{-1}}{4\\pi (2.1413747 \\times 10^{14} \\ \\mathrm{Hz})} \\approx \\frac{20}{2.691060 \\times 10^{15}} \\ \\mathrm{s} \\approx 7.43200 \\times 10^{-15} \\ \\mathrm{s}$$\nFinally, we multiply the two results:\n$$a \\approx (7.43200 \\times 10^{-15}) \\times (2.329116 \\times 10^{5}) \\approx 1.73095 \\times 10^{-9}$$\nRounding to three significant figures, the value of the damping parameter is $1.73 \\times 10^{-9}$.\n\nBased on this computed value of $a$, we can assess the relative importance of natural and thermal broadening. The Voigt profile is a convolution of a Lorentzian (from natural broadening) and a Gaussian (from thermal Doppler broadening). The parameter $a$ quantifies the ratio of their characteristic widths. Since $a \\approx 1.73 \\times 10^{-9} \\ll 1$, the Doppler width is many orders of magnitude larger than the natural Lorentzian width ($\\Delta\\nu_D \\gg \\gamma$). Consequently, the shape of the line core is overwhelmingly dominated by thermal Doppler broadening and is well-approximated by a Gaussian profile. Natural broadening, therefore, does not significantly affect the Voigt core. However, the wings of any spectral line are ultimately determined by the Lorentzian component, because the Gaussian profile falls off much more rapidly away from the line center ($\\exp[-x^2]$) than the Lorentzian profile ($1/x^2$). Thus, natural broadening, as the source of the Lorentzian profile in this case, dictates the shape of the line profile in the far wings, an effect that is crucial for analyzing saturated absorption lines in radiative transfer.",
            "answer": "$$\\boxed{1.73 \\times 10^{-9}}$$"
        },
        {
            "introduction": "In many dense atmospheric layers, collisions between molecules are the dominant source of Lorentzian broadening, often dwarfing natural broadening. This advanced practice  moves into this realistic regime, challenging you to compute the Full Width at Half Maximum (FWHM) of a Voigt profile where both thermal and collisional effects are significant. You will compare a widely used analytical approximation with a numerically exact result, simulating a common task for atmospheric modelers who must balance computational speed and accuracy.",
            "id": "4178788",
            "problem": "You are modeling spectral lines in a hydrogen-poor exoplanet atmosphere, where both thermal (Doppler) and collisional (Lorentz/pressure) broadening are important. For a single isolated transition at line-center frequency $\\nu_0$, assume the macroscopic velocity field is negligible and that the line profile is the convolution of a thermal Gaussian and a collisional Lorentzian (a Voigt profile).\n\nStarting from foundational principles and well-tested facts, use the following base definitions:\n\n- Maxwell–Boltzmann thermal motion in one dimension gives a Gaussian velocity distribution with variance $\\sigma_v^2 = k_{\\mathrm{B}} T / m$, where $k_{\\mathrm{B}}$ is the Boltzmann constant, $T$ is temperature, and $m$ is the molecular mass. Mapping velocity to frequency by $\\nu = \\nu_0 (1 + v/c)$ for $|v| \\ll c$ yields a Gaussian frequency distribution with standard deviation $\\sigma = (\\nu_0/c)\\,\\sigma_v$. The Doppler characteristic width frequently used in radiative transfer is the one-over-$e$ half-width, $\\Delta \\nu_D = \\sqrt{2}\\,\\sigma = (\\nu_0/c)\\,\\sqrt{2 k_{\\mathrm{B}} T / m}$.\n- Collisional broadening is modeled by a Lorentzian with half width at half maximum (HWHM) $\\gamma(T,p) = \\gamma_{\\mathrm{ref}} \\left(\\dfrac{p}{p_{\\mathrm{ref}}}\\right) \\left(\\dfrac{T_{\\mathrm{ref}}}{T}\\right)^{n}$, where $\\gamma_{\\mathrm{ref}}$ is the reference HWHM at reference pressure $p_{\\mathrm{ref}}$ and temperature $T_{\\mathrm{ref}}$, and $n$ is the temperature exponent.\n\nThe Voigt profile is defined as the convolution of the above Gaussian and Lorentzian in frequency space. The exact full width at half maximum (FWHM) of the Voigt profile is not available in elementary closed form; it must be computed numerically by evaluating the Voigt function and locating the half-maximum crossings. A widely used semi-empirical approximation combines the Lorentz FWHM and the Gaussian width into an explicit estimate of the Voigt FWHM. Implement that semi-empirical approximation and compare it to the exact numerical FWHM obtained from the convolution definition.\n\nConstants to use:\n- Line-center frequency: $\\nu_0 = 3.0 \\times 10^{14}\\,\\mathrm{Hz}$.\n- Molecular mass: $m = 28\\,\\mathrm{u}$ with $1\\,\\mathrm{u} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$.\n- Speed of light: $c = 2.99792458 \\times 10^{8}\\,\\mathrm{m\\,s^{-1}}$.\n- Boltzmann constant: $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$.\n- Pressure-broadening reference HWHM: $\\gamma_{\\mathrm{ref}} = 3.0 \\times 10^{9}\\,\\mathrm{Hz}$ at $T_{\\mathrm{ref}} = 296\\,\\mathrm{K}$ and $p_{\\mathrm{ref}} = 1\\,\\mathrm{bar}$.\n- Temperature exponent: $n = 0.7$.\n\nDefinitions and required unit conventions:\n- Temperatures $T$ are in $\\mathrm{K}$.\n- Pressures $p$ are in $\\mathrm{bar}$.\n- All widths (HWHM, FWHM) and frequencies must be expressed in $\\mathrm{Hz}$.\n- Angles are not used in this problem.\n- Any ratio you report must be a pure decimal number with no unit.\n\nTasks:\n1. For each test case below, compute the Doppler one-over-$e$ half-width $\\Delta \\nu_D$ and the Lorentz HWHM $\\gamma(T,p)$ using the base definitions above.\n2. Implement a semi-empirical approximation for the Voigt FWHM (the Whiting approximation) that depends only on the Lorentz FWHM and the Gaussian width parameters defined above, without using any closed-form formula for the exact Voigt FWHM.\n3. Compute the exact Voigt FWHM numerically by evaluating the Voigt profile obtained from convolving the Gaussian (with standard deviation $\\sigma = \\Delta \\nu_D/\\sqrt{2}$) and the Lorentzian (with HWHM $\\gamma$), and then locating the full width at half maximum by root-finding on the profile relative to its peak.\n4. For each test case, compute the relative error of the approximation with respect to the exact result, defined as $(\\mathrm{FWHM}_{\\mathrm{approx}} - \\mathrm{FWHM}_{\\mathrm{exact}})/\\mathrm{FWHM}_{\\mathrm{exact}}$, reported as a decimal number (no percent sign).\n\nTest suite (each item is $(T, p)$):\n- Case A (Doppler-dominated): $(T = 300\\,\\mathrm{K},\\ p = 0.001\\,\\mathrm{bar})$.\n- Case B (Lorentz-dominated): $(T = 300\\,\\mathrm{K},\\ p = 1.0\\,\\mathrm{bar})$.\n- Case C (Intermediate): $(T = 1000\\,\\mathrm{K},\\ p = 0.1\\,\\mathrm{bar})$.\n- Case D (Boundary, collisionless limit): $(T = 500\\,\\mathrm{K},\\ p = 0.0\\,\\mathrm{bar})$.\n- Case E (High pressure, low temperature): $(T = 150\\,\\mathrm{K},\\ p = 5.0\\,\\mathrm{bar})$.\n\nNumerical requirements:\n- Express all computed widths in $\\mathrm{Hz}$ internally.\n- Your numerical evaluation of the Voigt profile must be sufficiently resolved that the FWHM is accurate to within $10^{-4}$ relative for all cases in the test suite.\n- Use robust bracketing and root-finding to locate the half-maximum points.\n\nFinal output format:\n- Your program should produce a single line of output containing the relative errors for the five test cases as a comma-separated list enclosed in square brackets, for example $\\texttt{[e_A,e_B,e_C,e_D,e_E]}$. Each entry should be a decimal floating-point number in standard notation. Do not print any other text.\n\nNote: All computations must be performed in $\\mathrm{Hz}$, and the final results must be unitless decimal numbers (ratios).",
            "solution": "The solution proceeds by first defining the line broadening mechanisms, then detailing the implementation of both an approximate and a numerically exact method for calculating the Voigt profile's Full Width at Half Maximum (FWHM), and finally computing the relative error between these two methods for each test case.\n\n**1. Foundational Quantities: Doppler and Collisional Widths**\n\nThe total line shape is a Voigt profile, resulting from the convolution of a Gaussian profile due to thermal motion and a Lorentzian profile due to collisional interactions.\n\n**Thermal (Doppler) Broadening:**\nThe random thermal motion of molecules along the line of sight leads to Doppler shifts, creating a Gaussian line profile. The characteristic width is given as the one-over-$e$ half-width, $\\Delta\\nu_D$, which is calculated from first principles:\n$$\n\\Delta\\nu_D = \\frac{\\nu_0}{c} \\sqrt{\\frac{2 k_{\\mathrm{B}} T}{m}}\n$$\nwhere $\\nu_0$ is the line-center frequency, $c$ is the speed of light, $k_{\\mathrm{B}}$ is the Boltzmann constant, $T$ is the temperature, and $m$ is the molecular mass.\nThe corresponding Gaussian profile is $G(\\nu) \\propto \\exp(-(\\nu-\\nu_0)^2/\\Delta\\nu_D^2)$. The standard deviation of this Gaussian distribution is $\\sigma = \\Delta\\nu_D / \\sqrt{2}$. The Full Width at Half Maximum of the Gaussian component, $FWHM_G$, is related to $\\Delta\\nu_D$ by:\n$$\nFWHM_G = 2\\sqrt{2\\ln(2)}\\,\\sigma = 2\\sqrt{\\ln 2}\\,\\Delta\\nu_D \\approx 1.6651\\,\\Delta\\nu_D\n$$\n\n**Collisional (Pressure) Broadening:**\nIntermolecular collisions interrupt the emission/absorption process, leading to a Lorentzian line profile. The model for the Lorentzian Half Width at Half Maximum (HWHM), $\\gamma$, is given by a pressure and temperature-dependent relation:\n$$\n\\gamma(T,p) = \\gamma_{\\mathrm{ref}} \\left(\\frac{p}{p_{\\mathrm{ref}}}\\right) \\left(\\frac{T_{\\mathrm{ref}}}{T}\\right)^{n}\n$$\nwhere ($\\gamma_{\\mathrm{ref}}$, $p_{\\mathrm{ref}}$, $T_{\\mathrm{ref}}$) are reference values and $n$ is the temperature-dependence exponent. The FWHM of the Lorentzian component, $FWHM_L$, is simply twice the HWHM:\n$$\nFWHM_L = 2\\gamma\n$$\n\n**2. Semi-Empirical Approximation for the Voigt FWHM**\n\nThe FWHM of the Voigt profile, $FWHM_V$, cannot be expressed in a simple closed form. However, several accurate semi-empirical approximations exist. The Whiting (1968) approximation is a widely used and accurate formula that combines the Gaussian and Lorentzian FWHMs:\n$$\nFWHM_{approx} = 0.5346\\,FWHM_L + \\sqrt{0.2166\\,FWHM_L^2 + FWHM_G^2}\n$$\nThis formula provides an estimate of the Voigt FWHM directly from the component widths, $FWHM_G$ and $FWHM_L$, and will be used as the specified approximation.\n\n**3. Numerical Computation of the Exact Voigt FWHM**\n\nThe \"exact\" FWHM is determined by numerically analyzing the Voigt profile itself. The process involves three main steps:\n\n**Step 3.1: Voigt Profile Evaluation**\nThe Voigt profile $V(x; \\sigma, \\gamma)$ is the convolution of a Gaussian with standard deviation $\\sigma$ and a Lorentzian with HWHM $\\gamma$, where $x=\\nu-\\nu_0$ is the frequency offset from the line center. Direct computation of the convolution integral is inefficient. A standard, high-precision method relies on its relation to the complex error function (Faddeeva function). The `scipy.special.voigt_profile` function provides an optimized implementation for this, which we use for accurate evaluation. The inputs are the Gaussian standard deviation $\\sigma = \\Delta\\nu_D/\\sqrt{2}$ and the Lorentzian HWHM $\\gamma$.\n\n**Step 3.2: Finding the Half-Maximum Points**\nThe Voigt profile is symmetric and peaks at $x=0$. The peak value is $V_{max} = V(0; \\sigma, \\gamma)$. The FWHM is defined as $2x_{1/2}$, where $x_{1/2}$ is the positive offset at which the profile's value is half its maximum:\n$$\nV(x_{1/2}; \\sigma, \\gamma) = \\frac{1}{2} V_{max}\n$$\nTo find $x_{1/2}$, we must find the root of the function $f(x) = V(x; \\sigma, \\gamma) - V_{max}/2 = 0$.\n\n**Step 3.3: Numerical Root-Finding**\nA robust numerical root-finding algorithm is required. The `scipy.optimize.brentq` algorithm is ideal for this task. It requires the root to be bracketed, i.e., finding an interval $[a, b]$ where $f(a)$ and $f(b)$ have opposite signs. Since $f(0) = V_{max}/2 > 0$ and $f(x) \\to -V_{max}/2$ as $x \\to \\infty$, a root is guaranteed to exist for $x > 0$. A suitable search bracket can be established starting from a small positive value and extending to a value several times the characteristic widths, ensuring the function becomes negative. Once $x_{1/2}$ is found with high precision, the exact FWHM is $FWHM_{exact} = 2x_{1/2}$.\n\nA special case is the collisionless limit ($p=0$), where $\\gamma=0$. The profile is purely Gaussian, and the FWHM is exactly $FWHM_G$. The Whiting approximation also correctly reduces to $FWHM_G$ in this limit, so the relative error is analytically zero.\n\n**4. Relative Error Calculation**\n\nFor each test case, after computing $FWHM_{approx}$ and $FWHM_{exact}$, the relative error is calculated as requested:\n$$\n\\text{Error}_{\\text{rel}} = \\frac{FWHM_{approx} - FWHM_{exact}}{FWHM_{exact}}\n$$\n\nThe provided Python code implements this entire procedure, iterating through each $(T,p)$ test case to compute the final list of relative errors.",
            "answer": "```python\n# -*- coding: utf-8 -*-\n#\n# This program calculates the relative error of the Whiting approximation for the\n# Voigt profile FWHM compared to a numerically exact value for several atmospheric\n# conditions, as specified in the problem statement.\n#\n\nimport numpy as np\nfrom scipy.special import voigt_profile\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the spectral line broadening problem for a set of test cases.\n    \"\"\"\n    # Physical and reference constants as per the problem statement\n    NU0 = 3.0e14  # Line-center frequency in Hz\n    M_U = 28.0  # Molecular mass in atomic mass units (u)\n    U_IN_KG = 1.66053906660e-27  # kg per u\n    M = M_U * U_IN_KG  # Molecular mass in kg\n    C = 2.99792458e8  # Speed of light in m/s\n    KB = 1.380649e-23  # Boltzmann constant in J/K\n    GAMMA_REF = 3.0e9  # Reference Lorentzian HWHM in Hz\n    T_REF = 296.0  # Reference temperature in K\n    P_REF = 1.0  # Reference pressure in bar\n    N = 0.7  # Temperature exponent for collisional broadening\n\n    # Test suite: each tuple is (Temperature in K, Pressure in bar)\n    test_cases = [\n        (300.0, 0.001),   # Case A: Doppler-dominated\n        (300.0, 1.0),     # Case B: Lorentz-dominated\n        (1000.0, 0.1),    # Case C: Intermediate\n        (500.0, 0.0),     # Case D: Boundary, collisionless limit (pure Gaussian)\n        (150.0, 5.0),     # Case E: High pressure, low temperature\n    ]\n\n    results = []\n\n    for T, p in test_cases:\n        # Task 1: Compute Doppler and Lorentz widths\n        \n        # Doppler one-over-e half-width (delta_nu_d)\n        # Avoids T=0K issues, though not in test set\n        if T > 0:\n            delta_nu_d = (NU0 / C) * np.sqrt(2 * KB * T / M)\n        else:\n            delta_nu_d = 0.0\n\n        # Lorentzian Half Width at Half Maximum (gamma)\n        if p > 0.0 and T > 0.0:\n            gamma = GAMMA_REF * (p / P_REF) * (T_REF / T)**N\n        else:\n            gamma = 0.0\n\n        # Calculate the FWHM for the pure Gaussian and Lorentzian profiles\n        fwhm_g = 2 * np.sqrt(np.log(2)) * delta_nu_d\n        fwhm_l = 2 * gamma\n\n        # Task 2: Implement the Whiting semi-empirical approximation for Voigt FWHM\n        fwhm_approx = 0.5346 * fwhm_l + np.sqrt(0.2166 * fwhm_l**2 + fwhm_g**2)\n\n        # Task 3: Compute the exact Voigt FWHM numerically\n        if delta_nu_d == 0.0 and gamma == 0.0:\n             # Trivial case, not in test suite, but completes the logic\n             fwhm_exact = 0.0\n        elif gamma == 0.0: \n            # Pure Gaussian case (collisionless limit)\n            fwhm_exact = fwhm_g\n        elif delta_nu_d == 0.0: \n            # Pure Lorentzian case (zero temperature limit)\n            fwhm_exact = fwhm_l\n        else:\n            # General Voigt profile case, requires numerical root-finding\n            sigma = delta_nu_d / np.sqrt(2.0)\n            \n            # The peak value of the Voigt profile is at the line center (x=0)\n            v_peak = voigt_profile(0, sigma, gamma)\n            \n            # Define a function whose root is the half-width at half-maximum\n            def half_max_func(x):\n                return voigt_profile(x, sigma, gamma) - v_peak / 2.0\n\n            # Bracket the root. The HWHM must be positive.\n            # A good initial guess for the upper bound is derived from the approximation.\n            hwhm_approx_val = fwhm_approx / 2.0\n            bracket_a = 1e-6 * hwhm_approx_val  # Start close to zero\n            bracket_b = 5.0 * hwhm_approx_val   # A safe, large upper bound\n            \n            # Ensure the function changes sign over the bracket, expand if necessary\n            while half_max_func(bracket_b) > 0:\n                bracket_b *= 2.0\n            \n            # Use Brent's method for robust and accurate root finding\n            # High precision tolerance to satisfy problem requirements\n            hwhm_exact_val = brentq(half_max_func, bracket_a, bracket_b, xtol=1e-15, rtol=1e-15)\n            \n            fwhm_exact = 2 * hwhm_exact_val\n            \n        # Task 4: Compute relative error of the approximation\n        if fwhm_exact == 0.0:\n           # This case should only occur if T=0 and p=0. Error is 0 if fwhm_approx is also 0.\n           relative_error = 0.0 if fwhm_approx == 0.0 else np.inf\n        else:\n           relative_error = (fwhm_approx - fwhm_exact) / fwhm_exact\n           \n        results.append(relative_error)\n\n    # Print the final results in the specified single-line format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}