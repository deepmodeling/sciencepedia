{
    "hands_on_practices": [
        {
            "introduction": "任何谱线都因海森堡不确定性原理而具有固有的宽度，这被称为自然展宽。在天体物理等离子体中，这种效应与粒子热运动引起的多普勒展宽并存。本练习  对这两种基本效应进行了基础性的定量比较，使您能够确定在类似热木星大气的典型环境中，哪种机制主导了谱线形状，从而建立关键的物理直觉。",
            "id": "4178782",
            "problem": "一颗热木星系外行星的大气层中，观测到一个显著的一氧化碳 (CO) 振转跃迁，其中心波数为 $\\sigma_{0} = 2000\\ \\mathrm{cm}^{-1}$。该跃迁的高能级到低能级的自发辐射概率（爱因斯坦系数）为 $A_{ul} = 1.0 \\times 10^{7}\\ \\mathrm{s}^{-1}$。假设不存在纯退相干，且碰撞可以忽略不计，因此唯一的均匀展宽机制是自然（辐射）展宽。\n\n使用寿命和相干性的基本定义，计算自然半峰半宽 $\\gamma$ 和自然半峰全宽 $2\\gamma$，单位分别用赫兹 (Hz) 和反厘米 ($\\mathrm{cm}^{-1}$) 表示。然后，使用视线速度分量的麦克斯韦-玻尔兹曼分布和非相对论性多普勒频移，评估在给定谱线中心、温度 $T = 1000\\ \\mathrm{K}$ 时，质量为 $m = 28\\ \\mathrm{u}$ 的 CO 的这些自然宽度相对于热多普勒半峰全宽的大小。所有宽度均以赫兹 (Hz) 和反厘米 ($\\mathrm{cm}^{-1}$) 表示。将 $\\gamma$ 和 $2\\gamma$ 的最终数值答案四舍五入至四位有效数字。\n\n根据需要使用以下常数：玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K}^{-1}$，原子质量单位 $1\\ \\mathrm{u} = 1.66053906660 \\times 10^{-27}\\ \\mathrm{kg}$，光速 $c = 2.99792458 \\times 10^{8}\\ \\mathrm{m\\,s}^{-1} = 2.99792458 \\times 10^{10}\\ \\mathrm{cm\\,s}^{-1}$，以及 $\\pi = 3.141592653589793$。",
            "solution": "该问题经验证具有科学依据、良定、客观且完整。所有必需的物理常数和参数均已提供，所描述的情景——研究热木星大气中一氧化碳的谱线展宽机制——是天体物理学和行星科学中的一个标准且现实的问题。关于自然展宽和多普勒展宽的基础物理学原理是基本的，并且被正确地引用。因此，我们可以开始求解。\n\n该问题要求计算一氧化碳 (CO) 特定振转跃迁的自然展宽宽度（半峰半宽 $\\gamma$ 和半峰全宽 $2\\gamma$），并评估其相对于热多普勒展宽宽度的大小。\n\n### 第 1 部分：自然展宽\n\n自然展宽，也称为辐射展宽，是一种均匀展宽机制，它源于受激量子态因自发辐射而具有的有限寿命。海森堡不确定性原理 (Heisenberg uncertainty principle) 确定了态的寿命 $\\tau$ 与其能量不确定度 $\\Delta E$ 之间的关系，即 $\\Delta E \\cdot \\tau \\approx \\hbar$。由此产生的洛伦兹 (Lorentzian) 谱线轮廓的半峰全宽 (FWHM)，当用能量单位表示时，为 $\\Gamma_E = \\Delta E = \\hbar/\\tau$。\n\n高能态的寿命 $\\tau_{ul}$ 是该能态总自发辐射率的倒数。在本问题中，我们考虑一个具有自发辐射爱因斯坦系数 $A_{ul}$ 的单次跃迁。因此，寿命为 $\\tau_{ul} = 1/A_{ul}$。\n\n以角频率（$\\mathrm{rad\\,s}^{-1}$）为单位表示的 FWHM 由下式给出：\n$$\n\\Delta\\omega = \\frac{1}{\\tau_{ul}} = A_{ul}\n$$\n问题要求以普通频率 $\\nu$（单位为赫兹，$Hz$）和波数 $\\sigma$（单位为反厘米，$cm^{-1}$）表示宽度。角频率和普通频率之间的关系是 $\\omega = 2\\pi\\nu$。因此，以赫兹为单位的 FWHM 为：\n$$\n2\\gamma_{\\nu} = \\Delta\\nu = \\frac{\\Delta\\omega}{2\\pi} = \\frac{A_{ul}}{2\\pi}\n$$\n以赫兹为单位的半峰半宽 (HWHM) 为：\n$$\n\\gamma_{\\nu} = \\frac{2\\gamma_{\\nu}}{2} = \\frac{A_{ul}}{4\\pi}\n$$\n使用给定值 $A_{ul} = 1.0 \\times 10^{7}\\ \\mathrm{s}^{-1}$：\n$$\n2\\gamma_{\\nu} = \\frac{1.0 \\times 10^{7}\\ \\mathrm{s}^{-1}}{2\\pi} \\approx 1.591549 \\times 10^{6}\\ \\mathrm{Hz}\n$$\n$$\n\\gamma_{\\nu} = \\frac{1.0 \\times 10^{7}\\ \\mathrm{s}^{-1}}{4\\pi} \\approx 7.957747 \\times 10^{5}\\ \\mathrm{Hz}\n$$\n按要求四舍五入至四位有效数字：\n$2\\gamma_{\\nu} \\approx 1.592 \\times 10^{6}\\ \\mathrm{Hz}$\n$\\gamma_{\\nu} \\approx 7.958 \\times 10^{5}\\ \\mathrm{Hz}$\n\n为了从频率 ($\\nu$) 转换为波数 ($\\sigma$)，我们使用关系式 $\\nu = c\\sigma$，其中 $c$ 是光速。因此，以波数表示的宽度为 $\\Delta\\sigma = \\Delta\\nu / c$。我们必须使用单位为 $\\mathrm{cm\\,s}^{-1}$ 的 $c$ 来得到以 $\\mathrm{cm}^{-1}$ 为单位的结果，即 $c = 2.99792458 \\times 10^{10}\\ \\mathrm{cm\\,s}^{-1}$。\n\n以 $\\mathrm{cm}^{-1}$ 为单位的 FWHM 为：\n$$\n2\\gamma_{\\sigma} = \\frac{2\\gamma_{\\nu}}{c} = \\frac{A_{ul}}{2\\pi c} \\approx \\frac{1.591549 \\times 10^{6}\\ \\mathrm{s}^{-1}}{2.99792458 \\times 10^{10}\\ \\mathrm{cm\\,s}^{-1}} \\approx 5.30884 \\times 10^{-5}\\ \\mathrm{cm}^{-1}\n$$\n以 $\\mathrm{cm}^{-1}$ 为单位的 HWHM 为：\n$$\n\\gamma_{\\sigma} = \\frac{\\gamma_{\\nu}}{c} = \\frac{A_{ul}}{4\\pi c} \\approx \\frac{7.957747 \\times 10^{5}\\ \\mathrm{s}^{-1}}{2.99792458 \\times 10^{10}\\ \\mathrm{cm\\,s}^{-1}} \\approx 2.65442 \\times 10^{-5}\\ \\mathrm{cm}^{-1}\n$$\n四舍五入至四位有效数字：\n$2\\gamma_{\\sigma} \\approx 5.309 \\times 10^{-5}\\ \\mathrm{cm}^{-1}$\n$\\gamma_{\\sigma} \\approx 2.654 \\times 10^{-5}\\ \\mathrm{cm}^{-1}$\n\n### 第 2 部分：热多普勒展宽\n\n热多普勒展宽是一种非均匀展宽机制，由发射或吸收分子的热运动引起。分子相对于观测者的随机运动导致了多普勒频移的分布，从而使谱线展宽，形成高斯 (Gaussian) 轮廓。\n\n以频率单位表示的多普勒展宽谱线轮廓的半峰全宽（FWHM），此处记为 $FWHM_\\nu$，由下式给出：\n$$FWHM_\\nu = 2\\nu_0 \\sqrt{\\frac{2 k_B T \\ln(2)}{mc^2}}$$\n其中 $\\nu_0$ 是谱线中心频率，$k_B$ 是玻尔兹曼常数，$T$ 是温度，$m$ 是分子质量，$c$ 是光速。或者，以波数单位表示，记为 $FWHM_\\sigma$：\n$$FWHM_\\sigma = 2\\sigma_0 \\sqrt{\\frac{2 k_B T \\ln(2)}{mc^2}}$$\n给定条件：\n-   谱线中心波数 $\\sigma_0 = 2000\\ \\mathrm{cm}^{-1}$\n-   温度 $T = 1000\\ \\mathrm{K}$\n-   CO 质量 $m = 28\\ \\mathrm{u}$\n\n首先，我们将质量转换为国际单位制 (SI) 单位：\n$$\nm = 28\\ \\mathrm{u} \\times (1.66053906660 \\times 10^{-27}\\ \\mathrm{kg/u}) = 4.649509386 \\times 10^{-26}\\ \\mathrm{kg}\n$$\n现在，我们使用 SI 单位计算平方根下的项：\n-   $k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K}^{-1}$\n-   $c = 2.99792458 \\times 10^{8}\\ \\mathrm{m\\,s}^{-1}$\n-   $2k_B T = 2 \\times (1.380649 \\times 10^{-23}) \\times 1000 = 2.761298 \\times 10^{-20}\\ \\mathrm{J}$\n-   $mc^2 = (4.649509386 \\times 10^{-26}) \\times (2.99792458 \\times 10^{8})^2 \\approx 4.178864 \\times 10^{-9}\\ \\mathrm{J}$\n-   $\\ln(2) \\approx 0.693147$\n$$\n\\sqrt{\\frac{2 k_B T \\ln(2)}{mc^2}} = \\sqrt{\\frac{(2.761298 \\times 10^{-20}) \\times 0.693147}{4.178864 \\times 10^{-9}}} \\approx 2.14020 \\times 10^{-6}\n$$\n现在我们可以计算以 $\\mathrm{cm}^{-1}$ 为单位的多普勒 FWHM：\n$$\nFWHM_\\sigma = 2 \\times (2000\\ \\mathrm{cm}^{-1}) \\times (2.14020 \\times 10^{-6}) \\approx 0.0085608\\ \\mathrm{cm}^{-1}\n$$\n以及以赫兹为单位：\n$$\nFWHM_\\nu = FWHM_\\sigma \\times c = (0.0085608\\ \\mathrm{cm}^{-1}) \\times (2.99792458 \\times 10^{10}\\ \\mathrm{cm\\,s}^{-1}) \\approx 2.56648 \\times 10^{8}\\ \\mathrm{Hz}\n$$\n\n### 第 3 部分：评估与比较\n\n我们现在比较自然展宽和多普勒展宽 FWHM 的大小。\n\n自然展宽 FWHM：\n-   $2\\gamma_{\\nu} \\approx 1.592 \\times 10^{6}\\ \\mathrm{Hz}$\n-   $2\\gamma_{\\sigma} \\approx 5.309 \\times 10^{-5}\\ \\mathrm{cm}^{-1}$\n\n多普勒展宽 FWHM：\n-   $FWHM_\\nu \\approx 2.566 \\times 10^{8}\\ \\mathrm{Hz}$\n-   $FWHM_\\sigma \\approx 8.561 \\times 10^{-3}\\ \\mathrm{cm}^{-1}$\n\n为评估它们的相对大小，我们可以计算它们的比率：\n$$\n\\frac{FWHM_\\nu}{2\\gamma_{\\nu}} \\approx \\frac{2.566 \\times 10^{8}}{1.592 \\times 10^{6}} \\approx 161\n$$\n$$\n\\frac{FWHM_\\sigma}{2\\gamma_{\\sigma}} \\approx \\frac{8.561 \\times 10^{-3}}{5.309 \\times 10^{-5}} \\approx 161\n$$\n评估结果很明确：热多普勒 FWHM 大约是自然 FWHM 的 $161$ 倍。在高温大气和红外光谱区的这些条件下，多普勒展宽是主导的展宽机制。总的谱线形状是洛伦兹轮廓（自然展宽）和高斯轮廓（多普勒展宽）的卷积，称为福伊特轮廓 (Voigt profile)，它将绝大部分由高斯分量主导。\n\n最终要求的答案是自然宽度，四舍五入至四位有效数字。\n-   $\\gamma_{\\nu} = 7.958 \\times 10^{5}\\ \\mathrm{Hz}$\n-   $2\\gamma_{\\nu} = 1.592 \\times 10^{6}\\ \\mathrm{Hz}$\n-   $\\gamma_{\\sigma} = 2.654 \\times 10^{-5}\\ \\mathrm{cm}^{-1}$\n-   $2\\gamma_{\\sigma} = 5.309 \\times 10^{-5}\\ \\mathrm{cm}^{-1}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 7.958 \\times 10^{5} & 1.592 \\times 10^{6} & 2.654 \\times 10^{-5} & 5.309 \\times 10^{-5} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在现实中，谱线轮廓很少是纯粹的高斯分布或洛伦兹分布；它们是两者的卷积，即福伊特轮廓 (Voigt profile)。福伊特轮廓的特性可以由无量纲阻尼参数 $a$ 优雅地描述。本练习  专注于计算这一关键参数，以评估洛伦兹展宽的相对重要性，这对于理解是谱线核心还是遥远的谱线翼部携带了关于大气性质的最多信息至关重要。",
            "id": "4178729",
            "problem": "一颗热木星的透射光谱揭示了在近红外波段有强的水蒸气吸收。考虑水蒸气的一次转振跃迁，其线心频率为 $\\nu_{0}$，爱因斯坦自发辐射系数为 $A_{ul}$。假设气体处于局域热动平衡 (LTE) 状态，且速度分布是麦克斯韦分布。忽略碰撞展宽和非均匀展宽，因此洛伦兹半峰半宽 (HWHM) 完全源于有限的辐射寿命。在辐射转移中，线型通常用福伊特函数表示，该函数依赖于无量纲阻尼参数 $a$。这里定义 $a = \\gamma / \\Delta \\nu_{D}$，其中 $\\gamma$ 是以频率为单位的洛伦兹半峰半宽，$\\Delta \\nu_{D}$ 是与热运动相关的多普勒宽度参数。\n\n从辐射衰变和热多普勒频移的基本定义出发，从 $A_{ul}$ 推导出 $\\gamma$，从 $\\nu_{0}$、温度 $T$ 和分子质量 $m$ 推导出 $\\Delta \\nu_{D}$，然后计算 $a$ 的值。使用以下代表热木星条件的参数：\n- $A_{ul} = 20 \\ \\mathrm{s}^{-1}$，\n- $\\nu_{0} = 2.1413747 \\times 10^{14} \\ \\mathrm{Hz}$，\n- $T = 1800 \\ \\mathrm{K}$，\n- $m = 3.0 \\times 10^{-26} \\ \\mathrm{kg}$，\n- $k_{B} = 1.380649 \\times 10^{-23} \\ \\mathrm{J \\, K^{-1}}$，\n- $c = 2.99792458 \\times 10^{8} \\ \\mathrm{m \\, s^{-1}}$。\n\n将 $a$ 的最终数值结果四舍五入到三位有效数字，并表示为一个无量纲数。根据你计算出的 $a$ 值，说明在这些热木星条件下，自然展宽是显著影响福伊特线心还是线翼。",
            "solution": "该问题要求推导和计算无量纲福伊特阻尼参数 $a$，并在热木星大气中谱线展宽机制的背景下解释其值的意义。该问题具有科学依据，是良定的，并包含了获得唯一解所需的所有信息。\n\n无量纲阻尼参数 $a$ 定义为洛伦兹半峰半宽 (HWHM) $\\gamma$ 与多普勒宽度参数 $\\Delta \\nu_{D}$ 的比值：\n$$a = \\frac{\\gamma}{\\Delta \\nu_{D}}$$\n\n首先，我们必须根据给定的基本原理和参数推导出 $\\gamma$ 和 $\\Delta \\nu_{D}$ 的表达式。\n\n问题指出，洛伦兹展宽完全源于有限的辐射寿命（自然展宽），忽略了碰撞效应。一次跃迁的自然线型是洛伦兹型的，其宽度由激发态的寿命决定。从高能级 $u$ 的总衰变率，记为 $\\Gamma_{u}$，是所有可能到低能级 $l'$ 的向下跃迁的爱因斯坦自发辐射系数 $A_{ul'}$ 的总和。在这个简化问题中，我们只考虑一次跃迁，其系数为 $A_{ul}$，因此总衰变率是 $\\Gamma_{u} = A_{ul}$。高能级的寿命为 $\\tau_u = 1/\\Gamma_{u} = 1/A_{ul}$。\n\n态的寿命和能量不确定性之间的关系由海森堡不确定性原理给出，即 $\\Delta E \\cdot \\tau_u \\approx \\hbar$，其中 $\\hbar = h/(2\\pi)$。能量展宽 $\\Delta E$ 对应于发射光子的频率展宽 $\\Delta \\nu$，其中 $\\Delta E = h \\Delta \\nu$。代入这些关系得到 $h \\Delta \\nu \\cdot \\frac{1}{A_{ul}} \\approx \\frac{h}{2\\pi}$，这导致 $\\Delta \\nu \\approx \\frac{A_{ul}}{2\\pi}$。这个频率展宽 $\\Delta \\nu$ 代表了洛伦兹功率谱的半高全宽 (FWHM)。问题要求的是半峰半宽 (HWHM)，记为 $\\gamma$。\n$$\\gamma = \\frac{\\text{FWHM}}{2} = \\frac{1}{2} \\left( \\frac{A_{ul}}{2\\pi} \\right) = \\frac{A_{ul}}{4\\pi}$$\n\n接下来，我们推导多普勒宽度参数 $\\Delta \\nu_{D}$。它源于吸收分子的热运动。对于处于局域热动平衡 (LTE) 的气体，其速度分量遵循麦克斯韦-玻尔兹曼分布。视线速度分量 $v_r$ 具有高斯概率分布。频率的一阶多普勒频移由 $\\Delta \\nu = \\nu - \\nu_0 = \\nu_0 \\frac{v_r}{c}$ 给出。由此产生的谱线线型是高斯型的，可以写成：\n$$\\phi(\\nu) \\propto \\exp\\left( - \\frac{(\\nu - \\nu_0)^2}{(\\Delta\\nu_D)^2} \\right)$$\n参数 $\\Delta\\nu_D$ 是多普勒宽度，定义为线型强度下降到其中心值的 $1/e$ 时的频移。为了将其与物理参数联系起来，我们考虑一维麦克斯韦速度分布，其中最概然速率为 $v_p = \\sqrt{2 k_B T / m}$。多普勒宽度 $\\Delta\\nu_D$ 对应于原子以该最概然速率沿视线方向运动所引起的频移。\n$$\\Delta \\nu_{D} = \\nu_0 \\frac{v_p}{c} = \\nu_0 \\frac{1}{c} \\sqrt{\\frac{2 k_B T}{m}} = \\nu_0 \\sqrt{\\frac{2 k_B T}{mc^2}}$$\n\n现在我们可以写出阻尼参数 $a$ 的完整表达式：\n$$a = \\frac{\\gamma}{\\Delta \\nu_{D}} = \\frac{A_{ul} / (4\\pi)}{\\nu_0 \\sqrt{\\frac{2 k_B T}{mc^2}}} = \\frac{A_{ul}}{4\\pi \\nu_0} \\sqrt{\\frac{mc^2}{2 k_B T}}$$\n\n我们已知以下数值：\n-   $A_{ul} = 20 \\ \\mathrm{s}^{-1}$\n-   $\\nu_{0} = 2.1413747 \\times 10^{14} \\ \\mathrm{Hz}$\n-   $T = 1800 \\ \\mathrm{K}$\n-   $m = 3.0 \\times 10^{-26} \\ \\mathrm{kg}$\n-   $k_{B} = 1.380649 \\times 10^{-23} \\ \\mathrm{J \\, K^{-1}}$\n-   $c = 2.99792458 \\times 10^{8} \\ \\mathrm{m \\, s^{-1}}$\n\n我们将这些数值代入 $a$ 的表达式中：\n$$a = \\frac{20}{4\\pi (2.1413747 \\times 10^{14})} \\sqrt{\\frac{(3.0 \\times 10^{-26})(2.99792458 \\times 10^{8})^2}{2 (1.380649 \\times 10^{-23})(1800)}}$$\n首先，我们计算平方根内的项：\n$$\\frac{mc^2}{2 k_B T} = \\frac{(3.0 \\times 10^{-26} \\ \\mathrm{kg}) (2.99792458 \\times 10^{8} \\ \\mathrm{m \\, s^{-1}})^2}{2 (1.380649 \\times 10^{-23} \\ \\mathrm{J \\, K^{-1}}) (1800 \\ \\mathrm{K})} \\approx \\frac{2.6962655 \\times 10^{-9} \\ \\mathrm{J}}{4.9703364 \\times 10^{-20} \\ \\mathrm{J}} \\approx 5.424781 \\times 10^{10}$$\n现在，我们取平方根：\n$$\\sqrt{5.424781 \\times 10^{10}} \\approx 2.329116 \\times 10^{5}$$\n接下来，我们计算前置因子：\n$$\\frac{A_{ul}}{4\\pi \\nu_0} = \\frac{20 \\ \\mathrm{s}^{-1}}{4\\pi (2.1413747 \\times 10^{14} \\ \\mathrm{Hz})} \\approx \\frac{20}{2.691060 \\times 10^{15}} \\ \\mathrm{s} \\approx 7.43200 \\times 10^{-15} \\ \\mathrm{s}$$\n最后，我们将两个结果相乘：\n$$a \\approx (7.43200 \\times 10^{-15}) \\times (2.329116 \\times 10^{5}) \\approx 1.73095 \\times 10^{-9}$$\n四舍五入到三位有效数字，阻尼参数的值为 $1.73 \\times 10^{-9}$。\n\n基于这个计算出的 $a$ 值，我们可以评估自然展宽和热展宽的相对重要性。福伊特线型是洛伦兹线型（来自自然展宽）和高斯线型（来自热多普勒展宽）的卷积。参数 $a$ 量化了它们特征宽度的比率。由于 $a \\approx 1.73 \\times 10^{-9} \\ll 1$，多普勒宽度比自然洛伦兹宽度大许多个数量级 ($\\Delta\\nu_D \\gg \\gamma$)。因此，线心的形状完全由热多普勒展宽主导，并且可以很好地用高斯线型来近似。因此，自然展宽对福伊特线心没有显著影响。然而，任何谱线的线翼最终都由洛伦兹分量决定，因为高斯线型（$\\exp[-x^2]$）在远离线心处的衰减速度远快于洛伦兹线型（$1/x^2$）。因此，作为本例中洛伦兹线型来源的自然展宽，决定了远翼处的线型形状，这一效应对于分析辐射转移中的饱和吸收线至关重要。",
            "answer": "$$\\boxed{1.73 \\times 10^{-9}}$$"
        },
        {
            "introduction": "进入实际的大气建模后，碰撞展宽（或压力展宽）成为主要的洛伦兹效应，其影响通常远超自然展宽。由于福伊特轮廓的宽度缺乏简单的解析解，模型依赖于数值方法或近似公式。这项高级练习  要求您通过编程实现并检验一种常用的近似方法，并将其与数值精确解进行比较，从而直接体验尖端系外行星表征研究所固有的计算技术与权衡。",
            "id": "4178788",
            "problem": "您正在对贫氢系外行星大气中的谱线进行建模，其中热（多普勒）展宽和碰撞（洛伦兹/压力）展宽都很重要。\n\n对于线心频率为 $\\nu_0$ 的单个孤立跃迁，假设宏观速度场可以忽略不计，并且线型是热高斯分布和碰撞洛伦兹分布的卷积（即福伊特线型）。\n\n从基本原理和经过充分检验的事实出发，使用以下基本定义：\n\n- 一维麦克斯韦-玻尔兹曼热运动产生高斯速度分布，其方差为 $\\sigma_v^2 = k_{\\mathrm{B}} T / m$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是温度，$m$ 是分子质量。对于 $|v| \\ll c$ 的情况，通过 $\\nu = \\nu_0 (1 + v/c)$ 将速度映射到频率，会产生一个标准差为 $\\sigma = (\\nu_0/c)\\,\\sigma_v$ 的高斯频率分布。辐射转移中常用的多普勒特征宽度是 $1/e$ 半宽，即 $\\Delta \\nu_D = \\sqrt{2}\\,\\sigma = (\\nu_0/c)\\,\\sqrt{2 k_{\\mathrm{B}} T / m}$。\n- 碰撞展宽由洛伦兹线型建模，其半峰半宽（HWHM）为 $\\gamma(T,p) = \\gamma_{\\mathrm{ref}} \\left(\\dfrac{p}{p_{\\mathrm{ref}}}\\right) \\left(\\dfrac{T_{\\mathrm{ref}}}{T}\\right)^{n}$，其中 $\\gamma_{\\mathrm{ref}}$ 是在参考压力 $p_{\\mathrm{ref}}$ 和参考温度 $T_{\\mathrm{ref}}$ 下的参考HWHM，$n$ 是温度指数。\n\n福伊特线型定义为频率空间中上述高斯函数和洛伦兹函数的卷积。福伊特线型的精确半峰全宽（FWHM）没有初等闭合形式的解；它必须通过评估福伊特函数并定位半峰值交叉点来进行数值计算。一个广泛使用的半经验近似将洛伦兹FWHM和高斯宽度结合起来，给出了福伊特FWHM的显式估计。请实现该半经验近似，并将其与从卷积定义中获得的精确数值FWHM进行比较。\n\n使用的常数：\n- 线心频率：$\\nu_0 = 3.0 \\times 10^{14}\\,\\mathrm{Hz}$。\n- 分子质量：$m = 28\\,\\mathrm{u}$，其中 $1\\,\\mathrm{u} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$。\n- 光速：$c = 2.99792458 \\times 10^{8}\\,\\mathrm{m\\,s^{-1}}$。\n- 玻尔兹曼常数：$k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$。\n- 压力展宽参考HWHM：$\\gamma_{\\mathrm{ref}} = 3.0 \\times 10^{9}\\,\\mathrm{Hz}$，在 $T_{\\mathrm{ref}} = 296\\,\\mathrm{K}$ 和 $p_{\\mathrm{ref}} = 1\\,\\mathrm{bar}$ 时。\n- 温度指数：$n = 0.7$。\n\n定义和要求的单位约定：\n- 温度 $T$ 以 $\\mathrm{K}$ 为单位。\n- 压力 $p$ 以 $\\mathrm{bar}$ 为单位。\n- 所有宽度（HWHM, FWHM）和频率必须以 $\\mathrm{Hz}$ 表示。\n- 本问题不使用角度。\n- 您报告的任何比率都必须是无单位的纯小数。\n\n任务：\n1. 对于下方的每个测试用例，使用上述基本定义计算多普勒 $1/e$ 半宽 $\\Delta \\nu_D$ 和洛伦兹HWHM $\\gamma(T,p)$。\n2. 实现一个福伊特FWHM的半经验近似（Whiting近似），该近似仅依赖于上述定义的洛伦兹FWHM和高斯宽度参数，而不使用任何用于精确福伊特FWHM的闭合形式公式。\n3. 通过计算由高斯函数（标准差为 $\\sigma = \\Delta \\nu_D/\\sqrt{2}$）和洛伦兹函数（HWHM为 $\\gamma$）卷积得到的福伊特线型，然后通过对相对于峰值的线型进行求根来定位半峰全宽，从而数值计算精确的福伊特FWHM。\n4. 对于每个测试用例，计算近似值相对于精确结果的相对误差，定义为 $(\\mathrm{FWHM}_{\\mathrm{approx}} - \\mathrm{FWHM}_{\\mathrm{exact}})/\\mathrm{FWHM}_{\\mathrm{exact}}$，并以小数形式报告（不带百分号）。\n\n测试套件（每个项目为 $(T, p)$）：\n- 情况A（多普勒主导）：$(T = 300\\,\\mathrm{K},\\ p = 0.001\\,\\mathrm{bar})$。\n- 情况B（洛伦兹主导）：$(T = 300\\,\\mathrm{K},\\ p = 1.0\\,\\mathrm{bar})$。\n- 情况C（中间情况）：$(T = 1000\\,\\mathrm{K},\\ p = 0.1\\,\\mathrm{bar})$。\n- 情况D（边界，无碰撞极限）：$(T = 500\\,\\mathrm{K},\\ p = 0.0\\,\\mathrm{bar})$。\n- 情况E（高压，低温）：$(T = 150\\,\\mathrm{K},\\ p = 5.0\\,\\mathrm{bar})$。\n\n数值要求：\n- 在内部以 $\\mathrm{Hz}$ 表示所有计算出的宽度。\n- 您对福伊特线型的数值评估必须具有足够的分辨率，以确保对于测试套件中的所有情况，FWHM的相对精度在 $10^{-4}$ 以内。\n- 使用稳健的区间划分和求根方法来定位半峰值点。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含五个测试用例的相对误差，格式为方括号内以逗号分隔的列表，例如 $\\texttt{[e_A,e_B,e_C,e_D,e_E]}$。每个条目都应是标准表示法的小数浮点数。请勿打印任何其他文本。\n\n注意：所有计算必须以 $\\mathrm{Hz}$ 为单位进行，最终结果必须是无单位的小数（比率）。",
            "solution": "问题陈述已经过验证，被认为是具有科学依据、适定且客观的。它提出了天体物理光谱学中的一个标准问题，可以使用已建立的物理原理和数值方法来解决。\n\n解决方案首先定义谱线展宽机制，然后详细说明计算福伊特线型半峰全宽（FWHM）的近似方法和数值精确方法的实现，最后为每个测试用例计算这两种方法之间的相对误差。\n\n**1. 基本量：多普勒宽度和碰撞宽度**\n\n总线型是一个福伊特线型，它是由热运动引起的高斯线型和由碰撞相互作用引起的洛伦兹线型的卷积产生的。\n\n**热（多普勒）展宽：**\n分子沿视线方向的随机热运动导致多普勒频移，从而产生高斯线型。其特征宽度由 $1/e$ 半宽 $\\Delta\\nu_D$ 给出，该宽度可从第一性原理计算：\n$$\n\\Delta\\nu_D = \\frac{\\nu_0}{c} \\sqrt{\\frac{2 k_{\\mathrm{B}} T}{m}}\n$$\n其中 $\\nu_0$ 是线心频率，$c$ 是光速，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是温度，$m$ 是分子质量。\n相应的高斯线型为 $G(\\nu) \\propto \\exp(-(\\nu-\\nu_0)^2/\\Delta\\nu_D^2)$。此高斯分布的标准差为 $\\sigma = \\Delta\\nu_D / \\sqrt{2}$。高斯分量的半峰全宽 $FWHM_G$ 与 $\\Delta\\nu_D$ 的关系如下：\n$$\nFWHM_G = 2\\sqrt{2\\ln(2)}\\,\\sigma = 2\\sqrt{\\ln 2}\\,\\Delta\\nu_D \\approx 1.6651\\,\\Delta\\nu_D\n$$\n\n**碰撞（压力）展宽：**\n分子间碰撞会中断发射/吸收过程，从而导致洛伦兹线型。洛伦兹半峰半宽（HWHM）$\\gamma$ 的模型由一个依赖于压力和温度的关系式给出：\n$$\n\\gamma(T,p) = \\gamma_{\\mathrm{ref}} \\left(\\frac{p}{p_{\\mathrm{ref}}}\\right) \\left(\\frac{T_{\\mathrm{ref}}}{T}\\right)^{n}\n$$\n其中 ($\\gamma_{\\mathrm{ref}}$, $p_{\\mathrm{ref}}$, $T_{\\mathrm{ref}}$) 是参考值，$n$ 是温度依赖指数。洛伦兹分量的FWHM，$FWHM_L$，就是HWHM的两倍：\n$$\nFWHM_L = 2\\gamma\n$$\n\n**2. 福伊特 FWHM的半经验近似**\n\n福伊特线型的FWHM，$FWHM_V$，不能用简单的闭合形式表示。然而，存在几种精确的半经验近似。Whiting（1968）近似是一个广泛使用且精确的公式，它结合了高斯和洛伦兹的FWHM：\n$$\nFWHM_{approx} = 0.5346\\,FWHM_L + \\sqrt{0.2166\\,FWHM_L^2 + FWHM_G^2}\n$$\n该公式直接根据分量宽度 $FWHM_G$ 和 $FWHM_L$ 提供了福伊特 FWHM的估计值，并将用作指定的近似方法。\n\n**3. 精确福伊特 FWHM的数值计算**\n\n“精确”FWHM是通过对福伊特线型本身进行数值分析来确定的。该过程包括三个主要步骤：\n\n**步骤3.1：福伊特线型评估**\n福伊特线型 $V(x; \\sigma, \\gamma)$ 是标准差为 $\\sigma$ 的高斯函数和HWHM为 $\\gamma$ 的洛伦兹函数的卷积，其中 $x=\\nu-\\nu_0$ 是与线心的频率偏移。直接计算卷积积分效率低下。一种标准的高精度方法依赖于它与复误差函数（Faddeeva函数）的关系。`scipy.special.voigt_profile` 函数为此提供了一个优化的实现，我们用它来进行精确评估。输入是高斯标准差 $\\sigma = \\Delta\\nu_D/\\sqrt{2}$ 和洛伦兹HWHM $\\gamma$。\n\n**步骤3.2：寻找半峰值点**\n福伊特线型是对称的，并在 $x=0$ 处达到峰值。峰值为 $V_{max} = V(0; \\sigma, \\gamma)$。FWHM定义为 $2x_{1/2}$，其中 $x_{1/2}$ 是线型值为其最大值一半时的正偏移量：\n$$\nV(x_{1/2}; \\sigma, \\gamma) = \\frac{1}{2} V_{max}\n$$\n为了找到 $x_{1/2}$，我们必须找到函数 $f(x) = V(x; \\sigma, \\gamma) - V_{max}/2 = 0$ 的根。\n\n**步骤3.3：数值求根**\n需要一个稳健的数值求根算法。`scipy.optimize.brentq` 算法是此任务的理想选择。它要求根被置于一个区间内，即找到一个区间 $[a, b]$，使得 $f(a)$ 和 $f(b)$ 符号相反。由于 $f(0) = V_{max}/2 > 0$ 并且当 $x \\to \\infty$ 时 $f(x) \\to -V_{max}/2$，因此可以保证在 $x > 0$ 的范围内存在一个根。可以从一个小的正值开始，并扩展到特征宽度的几倍，从而建立一个合适的搜索区间，以确保函数值变为负数。一旦高精度地找到 $x_{1/2}$，精确的FWHM就是 $FWHM_{exact} = 2x_{1/2}$。\n\n一个特殊情况是无碰撞极限（$p=0$），此时 $\\gamma=0$。线型是纯高斯分布，FWHM恰好是 $FWHM_G$。Whiting近似在此极限下也正确地简化为 $FWHM_G$，因此相对误差在解析上为零。\n\n**4. 相对误差计算**\n\n对于每个测试用例，在计算出 $FWHM_{approx}$ 和 $FWHM_{exact}$ 后，按要求计算相对误差：\n$$\n\\text{Error}_{\\text{rel}} = \\frac{FWHM_{approx} - FWHM_{exact}}{FWHM_{exact}}\n$$\n\n提供的Python代码实现了这整个过程，通过遍历每个 $(T,p)$ 测试用例来计算最终的相对误差列表。",
            "answer": "```python\n# -*- coding: utf-8 -*-\n#\n# This program calculates the relative error of the Whiting approximation for the\n# Voigt profile FWHM compared to a numerically exact value for several atmospheric\n# conditions, as specified in the problem statement.\n#\n\nimport numpy as np\nfrom scipy.special import voigt_profile\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the spectral line broadening problem for a set of test cases.\n    \"\"\"\n    # Physical and reference constants as per the problem statement\n    NU0 = 3.0e14  # Line-center frequency in Hz\n    M_U = 28.0  # Molecular mass in atomic mass units (u)\n    U_IN_KG = 1.66053906660e-27  # kg per u\n    M = M_U * U_IN_KG  # Molecular mass in kg\n    C = 2.99792458e8  # Speed of light in m/s\n    KB = 1.380649e-23  # Boltzmann constant in J/K\n    GAMMA_REF = 3.0e9  # Reference Lorentzian HWHM in Hz\n    T_REF = 296.0  # Reference temperature in K\n    P_REF = 1.0  # Reference pressure in bar\n    N = 0.7  # Temperature exponent for collisional broadening\n\n    # Test suite: each tuple is (Temperature in K, Pressure in bar)\n    test_cases = [\n        (300.0, 0.001),   # Case A: Doppler-dominated\n        (300.0, 1.0),     # Case B: Lorentz-dominated\n        (1000.0, 0.1),    # Case C: Intermediate\n        (500.0, 0.0),     # Case D: Boundary, collisionless limit (pure Gaussian)\n        (150.0, 5.0),     # Case E: High pressure, low temperature\n    ]\n\n    results = []\n\n    for T, p in test_cases:\n        # Task 1: Compute Doppler and Lorentz widths\n        \n        # Doppler one-over-e half-width (delta_nu_d)\n        # Avoids T=0K issues, though not in test set\n        if T > 0:\n            delta_nu_d = (NU0 / C) * np.sqrt(2 * KB * T / M)\n        else:\n            delta_nu_d = 0.0\n\n        # Lorentzian Half Width at Half Maximum (gamma)\n        if p > 0.0 and T > 0.0:\n            gamma = GAMMA_REF * (p / P_REF) * (T_REF / T)**N\n        else:\n            gamma = 0.0\n\n        # Calculate the FWHM for the pure Gaussian and Lorentzian profiles\n        fwhm_g = 2 * np.sqrt(np.log(2)) * delta_nu_d\n        fwhm_l = 2 * gamma\n\n        # Task 2: Implement the Whiting semi-empirical approximation for Voigt FWHM\n        fwhm_approx = 0.5346 * fwhm_l + np.sqrt(0.2166 * fwhm_l**2 + fwhm_g**2)\n\n        # Task 3: Compute the exact Voigt FWHM numerically\n        if delta_nu_d == 0.0 and gamma == 0.0:\n             # Trivial case, not in test suite, but completes the logic\n             fwhm_exact = 0.0\n        elif gamma == 0.0: \n            # Pure Gaussian case (collisionless limit)\n            fwhm_exact = fwhm_g\n        elif delta_nu_d == 0.0: \n            # Pure Lorentzian case (zero temperature limit)\n            fwhm_exact = fwhm_l\n        else:\n            # General Voigt profile case, requires numerical root-finding\n            sigma = delta_nu_d / np.sqrt(2.0)\n            \n            # The peak value of the Voigt profile is at the line center (x=0)\n            v_peak = voigt_profile(0, sigma, gamma)\n            \n            # Define a function whose root is the half-width at half-maximum\n            def half_max_func(x):\n                return voigt_profile(x, sigma, gamma) - v_peak / 2.0\n\n            # Bracket the root. The HWHM must be positive.\n            # A good initial guess for the upper bound is derived from the approximation.\n            hwhm_approx_val = fwhm_approx / 2.0\n            bracket_a = 1e-6 * hwhm_approx_val  # Start close to zero\n            bracket_b = 5.0 * hwhm_approx_val   # A safe, large upper bound\n            \n            # Ensure the function changes sign over the bracket, expand if necessary\n            while half_max_func(bracket_b) > 0:\n                bracket_b *= 2.0\n            \n            # Use Brent's method for robust and accurate root finding\n            # High precision tolerance to satisfy problem requirements\n            hwhm_exact_val = brentq(half_max_func, bracket_a, bracket_b, xtol=1e-15, rtol=1e-15)\n            \n            fwhm_exact = 2 * hwhm_exact_val\n            \n        # Task 4: Compute relative error of the approximation\n        if fwhm_exact == 0.0:\n           # This case should only occur if T=0 and p=0. Error is 0 if fwhm_approx is also 0.\n           relative_error = 0.0 if fwhm_approx == 0.0 else np.inf\n        else:\n           relative_error = (fwhm_approx - fwhm_exact) / fwhm_exact\n           \n        results.append(relative_error)\n\n    # Print the final results in the specified single-line format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}