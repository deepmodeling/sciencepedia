{
    "hands_on_practices": [
        {
            "introduction": "系外行星的发生率通常被建模为一个连续的密度函数，以便描述其在行星半径和轨道周期等参数空间中的分布。然而，模型的具体形式和参数值取决于我们选择使用的坐标（例如，线性标度的半径 $R$ 还是对数标度的 $\\ln R$）。本练习将指导你运用微积分中的变量替换法则（即使用雅可比行列式），在两种常用的发生率密度表示法之间进行转换，这是正确解读和比较不同文献中统计结果的一项关键技能。 ",
            "id": "4160221",
            "problem": "考虑一个围绕类太阳恒星的系外行星族群出现率密度，该密度由行星半径 $R$ 和轨道周期 $P$ 描述。设该出现率按线性分箱由一个可分离幂律建模\n$$\\frac{d^{2}N}{dR\\,dP} = \\lambda \\left(\\frac{R}{R_{0}}\\right)^{\\alpha} \\left(\\frac{P}{P_{0}}\\right)^{\\beta},$$\n其中，$N$ 是在一定 $R$ 和 $P$ 范围内的每颗恒星的期望行星数，$\\lambda$ 是一个归一化常数，单位为“每颗恒星每个单位半径每个单位周期内的行星数”，$(\\alpha,\\beta)$ 是相对于参考点 $R_{0}$ 和 $P_{0}$ 的无量纲斜率。观测星表通常对这些变量的对数进行分箱。定义对数分箱出现率密度为\n$$\\frac{d^{2}N}{d\\ln R\\,d\\ln P}.$$\n仅从变量变换下的微分定义以及在重参数化下期望计数 $d^{2}N$ 守恒出发，推导两种密度之间的映射，并在对数分箱参数化中，得到参数三元组 $(\\lambda,\\alpha,\\beta)$ 到 $(\\tilde{\\lambda},\\tilde{\\alpha},\\tilde{\\beta})$ 的相应变换\n$$\\frac{d^{2}N}{d\\ln R\\,d\\ln P} = \\tilde{\\lambda} \\left(\\frac{R}{R_{0}}\\right)^{\\tilde{\\alpha}} \\left(\\frac{P}{P_{0}}\\right)^{\\tilde{\\beta}}.$$\n假设对 $\\ln R$ 和 $\\ln P$ 中分箱计数的最大后验概率 (MAP) 拟合被错误地使用线性分箱参数化报告，其参数值如下：$R_{0} = 2\\,R_{\\oplus}$，$P_{0} = 10\\,\\mathrm{days}$，$\\lambda = 4.00 \\times 10^{-4}$ 每颗恒星每个 $R_{\\oplus}$ 每天的行星数，$\\alpha = -1.30$ 以及 $\\beta = 0.70$。使用您推导出的映射，计算与对数分箱一致的修正后的 $(\\tilde{\\lambda},\\tilde{\\alpha},\\tilde{\\beta})$。将 $\\tilde{\\lambda}$ 以“每颗恒星的行星数”为单位表示。将您的 $\\tilde{\\lambda}$ 值四舍五入到四位有效数字。最终答案必须以单行矩阵 $\\left(\\tilde{\\lambda},\\,\\tilde{\\alpha},\\,\\tilde{\\beta}\\right)$ 的形式给出。",
            "solution": "该问题要求推导系外行星出现率密度的两种不同参数化之间的变换关系，然后使用此变换进行数值计算。\n\n首先，对问题陈述进行验证。\n\n**第一步：提取已知条件**\n- 线性分箱出现率密度：$\\frac{d^{2}N}{dR\\,dP} = \\lambda \\left(\\frac{R}{R_{0}}\\right)^{\\alpha} \\left(\\frac{P}{P_{0}}\\right)^{\\beta}$。\n- $N$：每颗恒星的期望行星数。\n- $R$：行星半径。\n- $P$：轨道周期。\n- $\\lambda$：归一化常数。\n- $\\alpha, \\beta$：无量纲斜率。\n- $R_{0}, P_{0}$：参考点。\n- 对数分箱出现率密度：$\\frac{d^{2}N}{d\\ln R\\,d\\ln P}$。\n- 对数分箱参数化：$\\frac{d^{2}N}{d\\ln R\\,d\\ln P} = \\tilde{\\lambda} \\left(\\frac{R}{R_{0}}\\right)^{\\tilde{\\alpha}} \\left(\\frac{P}{P_{0}}\\right)^{\\tilde{\\beta}}$。\n- 来自错误拟合的参数值：$R_{0} = 2\\,R_{\\oplus}$，$P_{0} = 10\\,\\mathrm{days}$，$\\lambda = 4.00 \\times 10^{-4}$ 每颗恒星每个 $R_{\\oplus}$ 每天的行星数，$\\alpha = -1.30$ 以及 $\\beta = 0.70$。\n- 任务是推导从 $(\\lambda,\\alpha,\\beta)$ 到 $(\\tilde{\\lambda},\\tilde{\\alpha},\\tilde{\\beta})$ 的映射并计算修正后的值。\n\n**第二步：使用提取的已知条件进行验证**\n- 该问题具有**科学依据**。使用幂律模型描述系外行星出现率是行星科学中的标准做法，尤其是在分析像Kepler这样的凌日巡天数据时。\n- 该问题是**适定的**。在变量变换下微分概率密度之间的转换是一个标准的数学过程，受变换的雅可比行列式控制。执行此推导及后续计算所需的所有信息均已提供。\n- 该问题是**客观的**。它以精确的数学和物理术语陈述，没有任何主观或模糊的语言。\n- 该问题不存在科学上不健全、不完整、矛盾或不可行等任何缺陷。模型和参数值与科学文献中的一致。\n\n**第三步：结论与行动**\n该问题有效。将提供完整解答。\n\n关联这两个密度函数的核心原理是，在参数空间的无穷小区域内，无论使用何种坐标系，行星数量 $d^{2}N$ 都是守恒的。这意味着在元 $dR\\,dP$ 内的行星数量必须与在相应元 $d\\ln R\\,d\\ln P$ 内的行星数量相同。\n在数学上，这种不变性表示为：\n$$d^{2}N = \\frac{d^{2}N}{dR\\,dP} dR\\,dP = \\frac{d^{2}N}{d\\ln R\\,d\\ln P} d\\ln R\\,d\\ln P$$\n为了找到两种密度之间的关系，我们必须关联微分面积元 $dR\\,dP$ 和 $d\\ln R\\,d\\ln P$。\n我们定义对数变量 $u = \\ln R$ 和 $v = \\ln P$。其微分为：\n$$du = d(\\ln R) = \\frac{1}{R} dR \\implies dR = R\\,du = R\\,d\\ln R$$\n$$dv = d(\\ln P) = \\frac{1}{P} dP \\implies dP = P\\,dv = P\\,d\\ln P$$\n因此，线性坐标中的微分面积元可以用对数坐标表示：\n$$dR\\,dP = (R\\,d\\ln R)(P\\,d\\ln P) = RP\\,d\\ln R\\,d\\ln P$$\n$RP$ 项是从 $(\\ln R, \\ln P)$ 到 $(R, P)$ 变换的雅可比行列式。\n现在，我们将此代入不变性方程：\n$$\\frac{d^{2}N}{dR\\,dP} (RP\\,d\\ln R\\,d\\ln P) = \\frac{d^{2}N}{d\\ln R\\,d\\ln P} (d\\ln R\\,d\\ln P)$$\n两边同除以非零的微分元 $d\\ln R\\,d\\ln P$，我们得到密度的变换法则：\n$$\\frac{d^{2}N}{d\\ln R\\,d\\ln P} = \\left(\\frac{d^{2}N}{dR\\,dP}\\right) R P$$\n现在，我们将给定的每种密度的幂律形式代入此方程。\n左边是：\n$$\\tilde{\\lambda} \\left(\\frac{R}{R_{0}}\\right)^{\\tilde{\\alpha}} \\left(\\frac{P}{P_{0}}\\right)^{\\tilde{\\beta}}$$\n右边是：\n$$\\left( \\lambda \\left(\\frac{R}{R_{0}}\\right)^{\\alpha} \\left(\\frac{P}{P_{0}}\\right)^{\\beta} \\right) R P$$\n为了比较这两种形式，我们必须将右边的因子 $R$ 和 $P$ 用参考点值 $R_{0}$ 和 $P_{0}$ 来表示：\n$$R = R_{0} \\left(\\frac{R}{R_{0}}\\right)^{1}$$\n$$P = P_{0} \\left(\\frac{P}{P_{0}}\\right)^{1}$$\n将这些代入右边的表达式得到：\n$$RHS = \\lambda \\left(\\frac{R}{R_{0}}\\right)^{\\alpha} \\left(\\frac{P}{P_{0}}\\right)^{\\beta} \\left(R_{0} \\left(\\frac{R}{R_{0}}\\right)^{1}\\right) \\left(P_{0} \\left(\\frac{P}{P_{0}}\\right)^{1}\\right)$$\n我们可以将常数项和幂律项组合在一起：\n$$RHS = (\\lambda R_{0} P_{0}) \\left(\\frac{R}{R_{0}}\\right)^{\\alpha} \\left(\\frac{R}{R_{0}}\\right)^{1} \\left(\\frac{P}{P_{0}}\\right)^{\\beta} \\left(\\frac{P}{P_{0}}\\right)^{1}$$\n$$RHS = (\\lambda R_{0} P_{0}) \\left(\\frac{R}{R_{0}}\\right)^{\\alpha+1} \\left(\\frac{P}{P_{0}}\\right)^{\\beta+1}$$\n通过将变换后的右边与左边相等，\n$$\\tilde{\\lambda} \\left(\\frac{R}{R_{0}}\\right)^{\\tilde{\\alpha}} \\left(\\frac{P}{P_{0}}\\right)^{\\tilde{\\beta}} = (\\lambda R_{0} P_{0}) \\left(\\frac{R}{R_{0}}\\right)^{\\alpha+1} \\left(\\frac{P}{P_{0}}\\right)^{\\beta+1}$$\n我们可以通过比较相应项的系数和指数来确定参数的变换。这得出了以下映射：\n$$\\tilde{\\lambda} = \\lambda R_{0} P_{0}$$\n$$\\tilde{\\alpha} = \\alpha + 1$$\n$$\\tilde{\\beta} = \\beta + 1$$\n这样就完成了变换的推导。\n\n接下来，我们使用错误拟合提供的参数计算修正后的数值 $(\\tilde{\\lambda}, \\tilde{\\alpha}, \\tilde{\\beta})$：\n$R_{0} = 2\\,R_{\\oplus}$\n$P_{0} = 10\\,\\mathrm{days}$\n$\\lambda = 4.00 \\times 10^{-4}$ 每颗恒星每个 $R_{\\oplus}$ 每天的行星数\n$\\alpha = -1.30$\n$\\beta = 0.70$\n\n我们计算新的斜率 $\\tilde{\\alpha}$ 和 $\\tilde{\\beta}$：\n$$\\tilde{\\alpha} = \\alpha + 1 = -1.30 + 1.00 = -0.30$$\n$$\\tilde{\\beta} = \\beta + 1 = 0.70 + 1.00 = 1.70$$\n\n接下来，我们计算新的归一化常数 $\\tilde{\\lambda}$。我们必须注意单位。\n$$\\tilde{\\lambda} = \\lambda R_{0} P_{0} = (4.00 \\times 10^{-4} \\text{ star}^{-1} R_{\\oplus}^{-1} \\text{day}^{-1}) \\times (2 \\, R_{\\oplus}) \\times (10 \\, \\text{days})$$\n$$\\tilde{\\lambda} = (4.00 \\times 10^{-4}) \\times 2 \\times 10 \\text{ star}^{-1}$$\n$$\\tilde{\\lambda} = 8.00 \\times 10^{-3} \\text{ planets per star}$$\n问题要求将 $\\tilde{\\lambda}$ 的值四舍五入到四位有效数字。\n$$\\tilde{\\lambda} = 0.008000$$\n或者用科学记数法表示为 $8.000 \\times 10^{-3}$。\n\n与对数分箱一致的修正后的参数三元组 $(\\tilde{\\lambda}, \\tilde{\\alpha}, \\tilde{\\beta})$ 是 $(8.000 \\times 10^{-3}, -0.30, 1.70)$。$\\tilde{\\lambda}$ 的单位是“每颗恒星的行星数”，这对于一个关于无量纲对数变量的密度函数的归一化常数是符合预期的。\n\n最终答案以行矩阵格式呈现。",
            "answer": "$$\\boxed{\\begin{pmatrix} 8.000 \\times 10^{-3}  -0.30  1.70 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在天文学巡天中，没有探测到信号（即“零结果”）本身就是一种重要的数据，尤其是在搜寻稀有天体时。本练习将向你展示如何结合泊松分布（用于描述稀有事件的发生）和贝叶斯推断，将“零探测”结果转化为对行星发生率 $f$ 的一个有统计意义的定量上限。掌握这一方法对于研究参数空间中行星稀疏区域的族群特征至关重要。 ",
            "id": "4160194",
            "problem": "一项对 $N=500$ 颗类日恒星的凌星巡天报告，在行星半径 $R_{\\mathrm{p}} \\in [1.0,1.5]\\,R_{\\oplus}$ 和轨道周期 $P \\in [30,70]\\,\\mathrm{days}$ 定义的区间内，没有验证到任何行星探测。对于每颗目标恒星 $i$，巡天团队通过注入-恢复实验计算了该区间的综合探测完备性 $C_{i}$，其中 $C_{i}$ 是指，如果恒星 $i$ 周围存在一颗行星，那么从该区间内随机抽取的一颗行星能够被探测和验证的概率，该概率已对区间内的周期-半径分布进行了边缘化。团队报告了总完备性之和为 $S=\\sum_{i=1}^{N} C_{i}=100$。\n\n假设该区间内行星的潜在总体在恒星间的分布遵循 Poisson 点过程，并且探测流程以每个目标的探测概率 $C_{i}$ 对此过程进行独立削减（Poisson 削减）。令 $f$ 表示发生率，定义为该区间内每颗恒星的平均行星数（因此 $f$ 可以超过 $1$）。采用 $f \\ge 0$ 的均匀先验，利用 Poisson 过程的性质和目标间的独立性，推导在未探测到任何行星的结果下 $f$ 的后验分布，并由此计算 $f$ 的等尾 $95$ 百分位置信上限。请将最终答案表示为小数，并四舍五入到四位有效数字。",
            "solution": "问题要求在凌星巡天未探测到任何结果的情况下，计算系外行星发生率 $f$ 的 $95\\%$ 置信上限。我们将使用贝叶斯推断来解决这个问题。\n\n首先，我们建立观测到的行星数量的统计模型。令 $f$ 为在指定的行星半径和轨道周期区间内，每颗恒星的平均行星数。问题指出，行星的潜在总体遵循 Poisson 点过程。因此，对于单颗恒星 $i$，该区间内的行星数量 $n_i$ 是一个从均值为 $f$ 的 Poisson 分布中抽取的随机变量：\n$$ n_i \\sim \\mathrm{Poisson}(f) $$\n探测到一颗给定的行星是概率性的。对于恒星 $i$ 的综合探测完备性 $C_i$ 表示如果存在行星，它被探测到的概率。在恒星 $i$ 周围，假定有 $n_i$ 颗行星，则探测到的行星数量 $k_i$ 遵循二项分布：\n$$ k_i | n_i \\sim \\mathrm{Binomial}(n_i, C_i) $$\n在这种情况下，一个服从 Poisson 分布的量经过一个二项选择过程（削减），其结果是一个新的服从 Poisson 分布的量。恒星 $i$ 周围探测到的行星数量 $k_i$ 的边际分布是一个均值为 $f C_i$ 的 Poisson 分布：\n$$ k_i \\sim \\mathrm{Poisson}(f C_i) $$\n在整个 $N$ 颗恒星的巡天中，探测到的总行星数 $K$ 是独立随机变量 $k_i$ 的和：\n$$ K = \\sum_{i=1}^{N} k_i $$\n独立 Poisson 随机变量之和也是一个 Poisson 随机变量，其均值等于各个均值之和。因此，$K$ 的分布是：\n$$ K \\sim \\mathrm{Poisson}\\left(\\sum_{i=1}^{N} f C_i\\right) $$\n我们可以将常数发生率 $f$ 提取出来：\n$$ K \\sim \\mathrm{Poisson}\\left(f \\sum_{i=1}^{N} C_i\\right) $$\n令 $S = \\sum_{i=1}^{N} C_i$ 为总完备性之和。问题给出 $S=100$。那么总探测数的模型是：\n$$ K \\sim \\mathrm{Poisson}(fS) $$\n提供的数据是没有验证到任何行星探测，因此我们的观测结果是 $K=0$。\n\n我们应用贝叶斯定理来求解在给定数据 $K=0$ 和模型参数 $S$ 的情况下，$f$ 的后验概率分布。后验概率 $p(f | K, S)$ 正比于似然函数 $\\mathcal{L}(K | f, S)$ 与先验概率 $p(f)$ 的乘积：\n$$ p(f | K=0, S) \\propto \\mathcal{L}(K=0 | f, S) \\cdot p(f) $$\n似然函数是从均值为 $\\lambda = fS$ 的 Poisson 分布中观测到 $K=0$ 的概率：\n$$ \\mathcal{L}(K=0 | f, S) = P(K=0 | \\lambda=fS) = \\frac{(fS)^0 \\exp(-fS)}{0!} = \\exp(-fS) $$\n问题指定了在 $f \\ge 0$ 上 $f$ 的均匀先验，可以写作：\n$$ p(f) \\propto 1, \\quad \\text{for } f \\ge 0 $$\n结合似然函数和先验，我们得到 $f$ 的未归一化后验分布：\n$$ p(f | K=0, S) \\propto \\exp(-fS), \\quad \\text{for } f \\ge 0 $$\n这是指数分布的函数形式。为了找到归一化常数，我们需要概率密度函数（PDF）在其定义域上的积分为 $1$：\n$$ \\int_{0}^{\\infty} A \\exp(-fS) \\, df = 1 $$\n其中 $A$ 是归一化常数。\n$$ A \\left[ -\\frac{1}{S} \\exp(-fS) \\right]_{0}^{\\infty} = A \\left( 0 - \\left(-\\frac{\\exp(0)}{S}\\right) \\right) = \\frac{A}{S} = 1 $$\n这意味着 $A=S$。因此，归一化后的后验 PDF 是：\n$$ p(f | K=0, S) = S \\exp(-fS), \\quad \\text{for } f \\ge 0 $$\n这是一个速率参数为 $S$ 的指数分布的 PDF。\n\n$f$ 的 $95\\%$ 置信上限，记为 $f_{95}$，是这样一个值，使得累积概率到该点为止为 $0.95$。这可以通过将后验 PDF 从 $0$ 积分到 $f_{95}$ 来求得：\n$$ P(f \\le f_{95} | K=0, S) = \\int_{0}^{f_{95}} S \\exp(-f'S) \\, df' = 0.95 $$\n该积分对应于指数分布的累积分布函数（CDF）：\n$$ \\left[ -\\exp(-f'S) \\right]_{0}^{f_{95}} = 1 - \\exp(-f_{95}S) $$\n令其等于 $0.95$：\n$$ 1 - \\exp(-f_{95}S) = 0.95 $$\n求解 $f_{95}$：\n$$ \\exp(-f_{95}S) = 1 - 0.95 = 0.05 $$\n$$ -f_{95}S = \\ln(0.05) $$\n$$ f_{95} = -\\frac{\\ln(0.05)}{S} $$\n问题给出了值 $S=100$。将此值代入 $f_{95}$ 的表达式中：\n$$ f_{95} = -\\frac{\\ln(0.05)}{100} $$\n我们可以计算其数值：\n$$ \\ln(0.05) \\approx -2.99573227 $$\n$$ f_{95} \\approx -\\frac{-2.99573227}{100} \\approx 0.0299573227 $$\n问题要求最终答案四舍五入到四位有效数字。$0.0299573227$ 的前四位有效数字是 $2, 9, 9, 5$。随后的数字是 $7$，这意味着我们必须对最后一位有效数字进行向上取整：\n$$ f_{95} \\approx 0.02996 $$",
            "answer": "$$\\boxed{0.02996}$$"
        }
    ]
}