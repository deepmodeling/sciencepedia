{
    "hands_on_practices": [
        {
            "introduction": "高斯过程（GP）核函数的设计并非随意的数学构造，它们往往可以从描述潜在物理过程的模型中导出。随机驱动的简谐振子（SHO）模型是描述恒星自转等准周期现象的强大工具。本练习将通过分析其背后的微分方程，建立起物理模型与GP核函数定性行为之间的桥梁，从而理解如何构建具有物理意义的恒星活动模型。",
            "id": "4160728",
            "problem": "一颗拥有系外行星的恒星，由于光球层星斑的演化，会表现出旋转调制的光度变化。这些信号可以建模为一个高斯过程（GP），其协方差结构由一个随机驱动的阻尼简谐振子（SHO）导出。设潜过程 $s(t)$ 服从线性随机微分方程\n$$\n\\frac{d^{2} s}{dt^{2}} + \\frac{\\omega_{0}}{Q}\\,\\frac{d s}{dt} + \\omega_{0}^{2}\\,s = \\xi(t),\n$$\n其中 $\\omega_{0}$ 是恒星旋转的角频率，$Q$ 是无量纲的品质因数，$\\xi(t)$ 是均值为零且具有恒定谱功率的高斯白噪声。在高斯过程建模中用于描述恒星活动的 SHO 核，其定性形式由上述方程的齐次解确定。具体而言，当齐次解具有共轭复数根时，该核是准周期的（呈指数衰减的振荡）；当齐次解具有不同的实数根时，该核是非振荡的（衰减指数项之和）。\n\n从这个方程出发，仅使用常系数线性常微分方程的基本性质，推导出品质因数 $Q$ 产生适用于星斑调制信号的欠阻尼准周期行为的条件，并将其与过阻尼情况进行对比。然后，确定区分这两种情况的临界值 $Q_{c}$。将您的最终答案表示为 $Q_{c}$ 的单个精确值，不带单位。无需四舍五入。",
            "solution": "问题陈述经评估有效。它在科学上基于常微分方程理论及其在天体物理建模中的应用，特别是使用高斯过程来模拟恒星活动。该问题提法恰当、客观、自洽，且没有内部矛盾或歧义。它要求基于给定微分方程的数学性质，推导出一个物理参数所满足的条件，这是物理学和工程学中一个标准且可解的任务。\n\n问题的核心在于分析所提供的随机微分方程的齐次形式。二阶常系数线性齐次常微分方程的解的行为完全由其特征方程的根决定。\n\n给定的随机微分方程是：\n$$\n\\frac{d^{2} s}{dt^{2}} + \\frac{\\omega_{0}}{Q}\\,\\frac{d s}{dt} + \\omega_{0}^{2}\\,s = \\xi(t)\n$$\n系统的定性行为，也即决定高斯过程核的形式，是由该方程的齐次部分确定的，可通过将驱动项 $\\xi(t)$ 置为零得到：\n$$\n\\frac{d^{2} s}{dt^{2}} + \\frac{\\omega_{0}}{Q}\\,\\frac{d s}{dt} + \\omega_{0}^{2}\\,s = 0\n$$\n为了求解，我们假设一个形式为 $s(t) = \\exp(\\lambda t)$ 的试探解。将其代入齐次微分方程得到：\n$$\n\\lambda^{2}\\exp(\\lambda t) + \\frac{\\omega_{0}}{Q}\\,\\lambda\\exp(\\lambda t) + \\omega_{0}^{2}\\exp(\\lambda t) = 0\n$$\n由于对于所有有限的 $t$，$\\exp(\\lambda t)$ 都不为零，我们可以将其约去，得到特征（或辅助）方程：\n$$\n\\lambda^{2} + \\left(\\frac{\\omega_{0}}{Q}\\right)\\lambda + \\omega_{0}^{2} = 0\n$$\n这是一个关于 $\\lambda$ 的二次方程，形式为 $a\\lambda^2 + b\\lambda + c = 0$，系数分别为 $a=1$，$b=\\frac{\\omega_{0}}{Q}$ 和 $c=\\omega_{0}^{2}$。方程的根可以通过二次公式求得：\n$$\n\\lambda = \\frac{-b \\pm \\sqrt{b^{2} - 4ac}}{2a} = \\frac{-\\frac{\\omega_{0}}{Q} \\pm \\sqrt{\\left(\\frac{\\omega_{0}}{Q}\\right)^{2} - 4(1)(\\omega_{0}^{2})}}{2}\n$$\n简化根的表达式：\n$$\n\\lambda = \\frac{-\\frac{\\omega_{0}}{Q} \\pm \\sqrt{\\frac{\\omega_{0}^{2}}{Q^{2}} - 4\\omega_{0}^{2}}}{2} = \\frac{-\\frac{\\omega_{0}}{Q} \\pm \\sqrt{\\omega_{0}^{2}\\left(\\frac{1}{Q^{2}} - 4\\right)}}{2}\n$$\n由于旋转角频率 $\\omega_{0}$ 是一个物理量，我们可以假设 $\\omega_{0} > 0$。这使得我们可以将 $\\omega_0$ 从平方根中提取出来：\n$$\n\\lambda = -\\frac{\\omega_{0}}{2Q} \\pm \\frac{\\omega_{0}}{2}\\sqrt{\\frac{1}{Q^{2}} - 4}\n$$\n根的性质，也即系统的行为，取决于判别式 $\\Delta = b^2 - 4ac$ 的符号，在此即为平方根内的项：$\\frac{1}{Q^{2}} - 4$。\n\n1.  **欠阻尼，准周期情况：** 问题陈述指出这对应于共轭复数根。当判别式为负时出现这种情况。\n    $$\n    \\frac{1}{Q^{2}} - 4  0\n    $$\n    $$\n    \\frac{1}{Q^{2}}  4\n    $$\n    品质因数 $Q$ 是一个正的无量纲量，因此我们可以写出：\n    $$\n    1  4Q^2 \\implies Q^2 > \\frac{1}{4}\n    $$\n    取正平方根（因为 $Q>0$）得到欠阻尼、准周期行为的条件：\n    $$\n    Q > \\frac{1}{2}\n    $$\n    在这种情况下，解 $s(t)$ 是一个振幅呈指数衰减的正弦振荡，这适用于模拟随时间演变的旋转调制星斑信号。\n\n2.  **过阻尼，非振荡情况：** 问题陈述指出这对应于不同的实数根。当判别式为正时出现这种情况。\n    $$\n    \\frac{1}{Q^{2}} - 4 > 0\n    $$\n    $$\n    \\frac{1}{Q^{2}} > 4\n    $$\n    $$\n    1 > 4Q^2 \\implies Q^2  \\frac{1}{4}\n    $$\n    同样，由于 $Q>0$，这给出了过阻尼行为的条件：\n    $$\n    0  Q  \\frac{1}{2}\n    $$\n    在这种情况下，解是两个衰减指数项之和，没有振荡。\n\n3.  **临界阻尼情况：** 振荡和非振荡情况之间的过渡发生在判别式恰好为零时。这对应于一个单一的重实根，并定义了品质因数的临界值 $Q_{c}$。\n    $$\n    \\frac{1}{Q_{c}^{2}} - 4 = 0\n    $$\n    $$\n    \\frac{1}{Q_{c}^{2}} = 4\n    $$\n    $$\n    Q_{c}^{2} = \\frac{1}{4}\n    $$\n    由于 $Q_{c}$ 必须为正，临界值为：\n    $$\n    Q_{c} = \\frac{1}{2}\n    $$\n这个临界值 $Q_{c} = \\frac{1}{2}$ 标志着边界。当 $Q > Q_{c}$ 时，系统是欠阻尼的，表现出准周期振荡。当 $Q  Q_{c}$ 时，系统是过阻尼的，表现出非振荡衰减。问题要求的就是这个特定的临界值。",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "在选择了一个合适的核函数后，下一步是通过拟合观测数据来确定其最优参数，即超参数。基于梯度的优化算法是完成此任务最高效的方法，而计算核函数及其对数边际似然函数相对于超参数的梯度是这一过程的核心。本练习将带领您动手推导这些关键的导数，这对于任何希望在实践中实现或深入理解GP模型拟合的人来说都是一项基本功。",
            "id": "4160755",
            "problem": "在系外行星径向速度和光度时间序列中，一种常见的恒星活动建模方法是使用高斯过程（GP；Gaussian Process）和一个准周期性协方差核，该核函数编码了旋转调制和有限的活动区寿命。考虑一个高斯过程，其在两个观测时间 $t$ 和 $t'$ 之间的协方差由下式给出：\n$$\nk(t,t') \\;=\\; \\sigma^{2} \\,\\exp\\!\\left(-\\frac{(t-t')^{2}}{2\\lambda^{2}} \\;-\\; \\Gamma^{2}\\,\\sin^{2}\\!\\left(\\frac{\\pi (t-t')}{P_{\\mathrm{rot}}}\\right)\\right),\n$$\n其中 $\\sigma$ 是协方差振幅，$\\lambda$ 是活动区的演化时间尺度，$\\Gamma$ 控制旋转调制的谐波复杂性，而 $P_{\\mathrm{rot}}$ 是恒星的自转周期。设 $\\Delta \\equiv t - t'$ 并为方便起见定义 $a \\equiv \\pi \\Delta / P_{\\mathrm{rot}}$。\n\n从微积分的基本原理和上述协方差核的定义出发，推导关于每个超参数 $\\theta \\in \\{\\sigma,\\lambda,\\Gamma,P_{\\mathrm{rot}}\\}$ 的一阶导数 $\\partial k/\\partial \\theta$ 和二阶导数 $\\partial^{2}k/\\partial \\theta^{2}$ 的闭式解析表达式。在系外行星建模工作流中，需要这些导数来实现基于梯度的高斯过程对数边际似然的超参数优化。\n\n将您的最终结果表示为一个单行矩阵，按以下顺序包含八个条目：\n$$\n\\left(\\frac{\\partial k}{\\partial \\sigma},\\;\\frac{\\partial k}{\\partial \\lambda},\\;\\frac{\\partial k}{\\partial \\Gamma},\\;\\frac{\\partial k}{\\partial P_{\\mathrm{rot}}},\\;\\frac{\\partial^{2}k}{\\partial \\sigma^{2}},\\;\\frac{\\partial^{2}k}{\\partial \\lambda^{2}},\\;\\frac{\\partial^{2}k}{\\partial \\Gamma^{2}},\\;\\frac{\\partial^{2}k}{\\partial P_{\\mathrm{rot}}^{2}}\\right).\n$$\n不需要数值近似；请提供精确的解析表达式。最终表达式中不要包含任何单位。",
            "solution": "问题陈述是有效的。它提出了一个定义明确的数学问题，其基础是天体物理学中时间序列分析的既定实践，特别是使用高斯过程来模拟恒星活动。所有变量和函数都已明确指定，问题是自洽的。任务是推导给定协方差核关于其超参数的一阶和二阶偏导数。\n\n令协方差核表示为 $k$。它是时间差 $\\Delta \\equiv t-t'$ 和一组超参数 $\\theta \\in \\{\\sigma, \\lambda, \\Gamma, P_{\\mathrm{rot}}\\}$ 的函数。该核由下式给出：\n$$\nk \\;=\\; \\sigma^{2} \\exp\\left(-\\frac{\\Delta^{2}}{2\\lambda^{2}} - \\Gamma^{2}\\sin^{2}\\left(\\frac{\\pi \\Delta}{P_{\\mathrm{rot}}}\\right)\\right)\n$$\n为简化符号，我们定义指数的参数、时间差和正弦函数的参数如下：\n$$\nE \\equiv -\\frac{\\Delta^{2}}{2\\lambda^{2}} - \\Gamma^{2}\\sin^{2}(a)\n$$\n$$\n\\Delta \\equiv t-t'\n$$\n$$\na \\equiv \\frac{\\pi \\Delta}{P_{\\mathrm{rot}}}\n$$\n于是，核可以写成 $k = \\sigma^{2} \\exp(E)$。我们现在将应用微分法则，推导关于每个超参数所需的偏导数。\n\n对于一个只出现在指数 $E$ 中的通用超参数 $\\theta$（即 $\\theta \\in \\{\\lambda, \\Gamma, P_{\\mathrm{rot}}\\}$），$k$ 的一阶和二阶导数遵循从链式法则推导出的通用模式：\n$$\n\\frac{\\partial k}{\\partial \\theta} = \\sigma^{2} \\exp(E) \\frac{\\partial E}{\\partial \\theta} = k \\frac{\\partial E}{\\partial \\theta}\n$$\n$$\n\\frac{\\partial^{2} k}{\\partial \\theta^{2}} = \\frac{\\partial}{\\partial \\theta} \\left(k \\frac{\\partial E}{\\partial \\theta}\\right) = \\frac{\\partial k}{\\partial \\theta} \\frac{\\partial E}{\\partial \\theta} + k \\frac{\\partial^{2} E}{\\partial \\theta^{2}} = \\left(k \\frac{\\partial E}{\\partial \\theta}\\right)\\frac{\\partial E}{\\partial \\theta} + k \\frac{\\partial^{2} E}{\\partial \\theta^{2}} = k \\left[ \\left(\\frac{\\partial E}{\\partial \\theta}\\right)^{2} + \\frac{\\partial^{2} E}{\\partial \\theta^{2}} \\right]\n$$\n超参数 $\\sigma$ 是一个特殊情况，因为它是一个前置因子。\n\n### 关于 $\\sigma$ 的导数\n指数 $E$ 不依赖于 $\\sigma$。其导数很简单：\n$$\n\\frac{\\partial k}{\\partial \\sigma} = \\frac{\\partial}{\\partial \\sigma} \\left(\\sigma^{2} \\exp(E)\\right) = 2\\sigma \\exp(E) = \\frac{2k}{\\sigma}\n$$\n$$\n\\frac{\\partial^{2} k}{\\partial \\sigma^{2}} = \\frac{\\partial}{\\partial \\sigma} \\left(2\\sigma \\exp(E)\\right) = 2 \\exp(E) = \\frac{2k}{\\sigma^{2}}\n$$\n\n### 关于 $\\lambda$ 的导数\n指数 $E$ 通过项 $-\\frac{\\Delta^2}{2\\lambda^2}$ 依赖于 $\\lambda$。$E$ 关于 $\\lambda$ 的一阶和二阶导数是：\n$$\n\\frac{\\partial E}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda} \\left(-\\frac{\\Delta^{2}}{2}\\lambda^{-2}\\right) = -\\frac{\\Delta^{2}}{2}(-2\\lambda^{-3}) = \\frac{\\Delta^{2}}{\\lambda^{3}}\n$$\n$$\n\\frac{\\partial^{2} E}{\\partial \\lambda^{2}} = \\frac{\\partial}{\\partial \\lambda} \\left(\\Delta^{2}\\lambda^{-3}\\right) = \\Delta^{2}(-3\\lambda^{-4}) = -\\frac{3\\Delta^{2}}{\\lambda^{4}}\n$$\n使用通用公式，$k$ 的导数是：\n$$\n\\frac{\\partial k}{\\partial \\lambda} = k \\frac{\\partial E}{\\partial \\lambda} = k \\frac{\\Delta^{2}}{\\lambda^{3}}\n$$\n$$\n\\frac{\\partial^{2} k}{\\partial \\lambda^{2}} = k \\left[ \\left(\\frac{\\Delta^{2}}{\\lambda^{3}}\\right)^{2} - \\frac{3\\Delta^{2}}{\\lambda^{4}} \\right] = k \\left( \\frac{\\Delta^{4}}{\\lambda^{6}} - \\frac{3\\Delta^{2}}{\\lambda^{4}} \\right)\n$$\n\n### 关于 $\\Gamma$ 的导数\n指数 $E$ 通过项 $-\\Gamma^{2}\\sin^{2}(a)$ 依赖于 $\\Gamma$。$E$ 的导数是：\n$$\n\\frac{\\partial E}{\\partial \\Gamma} = \\frac{\\partial}{\\partial \\Gamma} \\left(-\\Gamma^{2}\\sin^{2}(a)\\right) = -2\\Gamma\\sin^{2}(a)\n$$\n$$\n\\frac{\\partial^{2} E}{\\partial \\Gamma^{2}} = \\frac{\\partial}{\\partial \\Gamma} \\left(-2\\Gamma\\sin^{2}(a)\\right) = -2\\sin^{2}(a)\n$$\n那么 $k$ 的导数是：\n$$\n\\frac{\\partial k}{\\partial \\Gamma} = k \\frac{\\partial E}{\\partial \\Gamma} = -2k\\Gamma\\sin^{2}(a)\n$$\n$$\n\\frac{\\partial^{2} k}{\\partial \\Gamma^{2}} = k \\left[ (-2\\Gamma\\sin^{2}(a))^{2} - 2\\sin^{2}(a) \\right] = k \\left( 4\\Gamma^{2}\\sin^{4}(a) - 2\\sin^{2}(a) \\right) = 2k\\sin^{2}(a) \\left( 2\\Gamma^{2}\\sin^{2}(a) - 1 \\right)\n$$\n\n### 关于 $P_{\\mathrm{rot}}$ 的导数\n指数 $E$ 通过 $a = \\frac{\\pi \\Delta}{P_{\\mathrm{rot}}}$ 依赖于 $P_{\\mathrm{rot}}$。我们使用链式法则。首先，我们求 $a$ 关于 $P_{\\mathrm{rot}}$ 的导数：\n$$\n\\frac{\\partial a}{\\partial P_{\\mathrm{rot}}} = \\frac{\\partial}{\\partial P_{\\mathrm{rot}}} \\left(\\pi \\Delta P_{\\mathrm{rot}}^{-1}\\right) = -\\pi \\Delta P_{\\mathrm{rot}}^{-2} = -\\frac{a}{P_{\\mathrm{rot}}}\n$$\n$$\n\\frac{\\partial^{2} a}{\\partial P_{\\mathrm{rot}}^{2}} = \\frac{\\partial}{\\partial P_{\\mathrm{rot}}} \\left(-\\pi \\Delta P_{\\mathrm{rot}}^{-2}\\right) = 2\\pi \\Delta P_{\\mathrm{rot}}^{-3} = \\frac{2a}{P_{\\mathrm{rot}}^{2}}\n$$\n接下来，我们求 $E$ 关于 $a$ 的导数：\n$$\n\\frac{\\partial E}{\\partial a} = \\frac{\\partial}{\\partial a} \\left(-\\Gamma^{2}\\sin^{2}(a)\\right) = -\\Gamma^{2}(2\\sin(a)\\cos(a)) = -\\Gamma^{2}\\sin(2a)\n$$\n$$\n\\frac{\\partial^{2} E}{\\partial a^{2}} = \\frac{\\partial}{\\partial a} \\left(-\\Gamma^{2}\\sin(2a)\\right) = -2\\Gamma^{2}\\cos(2a)\n$$\n现在，我们使用链式法则求 $E$ 关于 $P_{\\mathrm{rot}}$ 的导数：\n$$\n\\frac{\\partial E}{\\partial P_{\\mathrm{rot}}} = \\frac{\\partial E}{\\partial a} \\frac{\\partial a}{\\partial P_{\\mathrm{rot}}} = (-\\Gamma^{2}\\sin(2a))\\left(-\\frac{a}{P_{\\mathrm{rot}}}\\right) = \\frac{a\\Gamma^{2}}{P_{\\mathrm{rot}}}\\sin(2a)\n$$\n$$\n\\frac{\\partial^{2} E}{\\partial P_{\\mathrm{rot}}^{2}} = \\frac{\\partial^{2} E}{\\partial a^{2}}\\left(\\frac{\\partial a}{\\partial P_{\\mathrm{rot}}}\\right)^{2} + \\frac{\\partial E}{\\partial a}\\frac{\\partial^{2} a}{\\partial P_{\\mathrm{rot}}^{2}} = (-2\\Gamma^{2}\\cos(2a))\\left(-\\frac{a}{P_{\\mathrm{rot}}}\\right)^{2} + (-\\Gamma^{2}\\sin(2a))\\left(\\frac{2a}{P_{\\mathrm{rot}}^{2}}\\right) = -\\frac{2a^{2}\\Gamma^{2}}{P_{\\mathrm{rot}}^{2}}\\cos(2a) - \\frac{2a\\Gamma^{2}}{P_{\\mathrm{rot}}^{2}}\\sin(2a)\n$$\n最后，我们计算 $k$ 关于 $P_{\\mathrm{rot}}$ 的导数：\n$$\n\\frac{\\partial k}{\\partial P_{\\mathrm{rot}}} = k \\frac{\\partial E}{\\partial P_{\\mathrm{rot}}} = k \\frac{a\\Gamma^{2}}{P_{\\mathrm{rot}}}\\sin(2a)\n$$\n$$\n\\frac{\\partial^{2} k}{\\partial P_{\\mathrm{rot}}^{2}} = k \\left[ \\left(\\frac{\\partial E}{\\partial P_{\\mathrm{rot}}}\\right)^{2} + \\frac{\\partial^{2} E}{\\partial P_{\\mathrm{rot}}^{2}} \\right] = k \\left[ \\left(\\frac{a\\Gamma^{2}}{P_{\\mathrm{rot}}}\\sin(2a)\\right)^{2} - \\frac{2a^{2}\\Gamma^{2}}{P_{\\mathrm{rot}}^{2}}\\cos(2a) - \\frac{2a\\Gamma^{2}}{P_{\\mathrm{rot}}^{2}}\\sin(2a) \\right]\n$$\n$$\n\\frac{\\partial^{2} k}{\\partial P_{\\mathrm{rot}}^{2}} = k\\left[ \\frac{a^{2}\\Gamma^{4}}{P_{\\mathrm{rot}}^{2}}\\sin^{2}(2a) - \\frac{2a\\Gamma^{2}}{P_{\\mathrm{rot}}^{2}}\\sin(2a) - \\frac{2a^{2}\\Gamma^{2}}{P_{\\mathrm{rot}}^{2}}\\cos(2a) \\right]\n$$\n这个表达式可以因式分解以求简洁：\n$$\n\\frac{\\partial^{2} k}{\\partial P_{\\mathrm{rot}}^{2}} = \\frac{ka\\Gamma^{2}}{P_{\\mathrm{rot}}^{2}} \\left[ a\\Gamma^{2}\\sin^{2}(2a) - 2\\sin(2a) - 2a\\cos(2a) \\right]\n$$\n我们现在已经推导出了所有八个所需的偏导数。我们将它们组合成指定的矩阵格式作为最终答案。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2k}{\\sigma}  k\\frac{\\Delta^{2}}{\\lambda^{3}}  -2k\\Gamma\\sin^{2}(a)  k\\frac{a\\Gamma^{2}}{P_{\\mathrm{rot}}}\\sin(2a)  \\frac{2k}{\\sigma^{2}}  k\\left(\\frac{\\Delta^{4}}{\\lambda^{6}} - \\frac{3\\Delta^{2}}{\\lambda^{4}}\\right)  2k\\sin^{2}(a)\\left(2\\Gamma^{2}\\sin^{2}(a) - 1\\right)  \\frac{ka\\Gamma^{2}}{P_{\\mathrm{rot}}^{2}}\\left(a\\Gamma^{2}\\sin^{2}(2a) - 2\\sin(2a) - 2a\\cos(2a)\\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "高斯过程模型的一大核心优势是在未观测点进行预测的能力，这在处理存在观测间断的天文数据时尤其有用。本练习将展示如何从第一性原理出发，推导在给定含噪声的观测数据条件下，对数据缺失部分进行“插值”的预测方程。掌握这一技能不仅对于完整地可视化潜在的恒星信号至关重要，也是进行严谨科学数据分析的关键一步。",
            "id": "4160699",
            "problem": "一颗具有旋转调制磁活动的恒星在其径向速度 (RV) 时间序列中产生准周期性变化，这使得系外行星的推断变得复杂。假设您有在时间点 $t_{o} = (t_{o,1}, \\dots, t_{o,N_{o}})$ 采集的 $N_{o}$ 个观测到的RV测量值 $y_{o} \\in \\mathbb{R}^{N_{o}}$，以及 $N_{m}$ 个未观测的时间点 $t_{m} = (t_{m,1}, \\dots, t_{m,N_{m}})$，这些时间点落在由天文台停机时间造成的间隙内。测量噪声是独立同分布的，其已知方差为 $\\sigma_{n}^{2}$。用一个零均值高斯过程 (GP) 先验来模拟恒星活动信号 $f(t)$，即一个均值函数为 $0$、协方差函数为代表旋转活动区的准周期函数的高斯过程 (GP)：\n$$\nk_{\\mathrm{QP}}(t, t') = A^{2} \\exp\\!\\left(-\\frac{(t - t')^{2}}{2\\lambda^{2}} - \\frac{\\sin^{2}\\!\\big(\\pi (t - t') / P\\big)}{2w^{2}}\\right),\n$$\n其中 $A  0$ 是振幅，$\\lambda  0$ 是活动区的演化时间尺度，$P  0$ 是恒星自转周期，$w  0$ 控制周期性分量的相干性。设 $K_{oo} \\in \\mathbb{R}^{N_{o} \\times N_{o}}$、$K_{mm} \\in \\mathbb{R}^{N_{m} \\times N_{m}}$ 和 $K_{mo} \\in \\mathbb{R}^{N_{m} \\times N_{o}}$ 分别是通过在 $(t_{o}, t_{o})$、$(t_{m}, t_{m})$ 和 $(t_{m}, t_{o})$ 上评估 $k_{\\mathrm{QP}}$ 所形成的协方差矩阵。\n\n从高斯过程先验的定义和在有限函数值集合上构建多元正态分布的标准方法出发，推导在给定带噪声的观测值 $y_{o}$ 的条件下，潜在活动值 $f_{m} = \\big(f(t_{m,1}), \\dots, f(t_{m,N_{m}})\\big)^{\\top}$ 的条件分布。解释每一步，包括测量噪声的引入、在 $(f_{m}, y_{o})$ 上联合高斯分布的形成，以及为获得 $f_{m}$ 的后验预测分布而进行的条件化。\n\n然后，在同一框架内，提出一种科学合理的方法，为可视化目的填补未观测到的片段，该方法不会对系外行星信号的参数推断产生偏差，并论证该方法为何能避免重复计算数据或改变用于推断的似然函数。\n\n提供条件均值向量 $\\mu_{m} = \\mathbb{E}[f_{m} \\mid y_{o}]$ 关于 $K_{oo}$、$K_{mo}$ 和 $\\sigma_{n}^{2}$ 的闭式解析表达式。您的最终答案必须是单一的解析表达式。不需要也不允许进行数值近似。",
            "solution": "该问题要求在一个高斯过程 (GP) 框架内，根据一组带噪声的观测值 $y_o$ 推导出一组未观测的恒星活动值 $f_m$ 的后验预测分布。此外，还必须提出并论证一种科学合理的方法，用于为可视化目的填补这些未观测值。\n\n让我们首先将模型形式化。恒星活动信号 $f(t)$ 被建模为一个零均值高斯过程，记作 $f(t) \\sim \\mathcal{GP}(0, k_{\\mathrm{QP}}(t, t'))$。这意味着任何有限的函数值集合都服从联合高斯分布。我们关心的是在观测时间点 $t_o$ 的潜在函数值，我们用向量 $f_o \\in \\mathbb{R}^{N_o}$ 表示，以及在未观测时间点 $t_m$ 的潜在函数值，用向量 $f_m \\in \\mathbb{R}^{N_m}$ 表示。\n\n根据高斯过程的定义，潜在函数值 $(f_o, f_m)$ 的联合分布是一个多元正态分布，其均值为零，块协方差矩阵由核函数 $k_{\\mathrm{QP}}$ 构建：\n$$\n\\begin{pmatrix} f_o \\\\ f_m \\end{pmatrix} \\sim \\mathcal{N} \\! \\left( \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} K_{oo}  K_{om} \\\\ K_{mo}  K_{mm} \\end{pmatrix} \\right)\n$$\n在这里，协方差矩阵由其元素定义：$(K_{oo})_{ij} = k_{\\mathrm{QP}}(t_{o,i}, t_{o,j})$，$(K_{mm})_{ij} = k_{\\mathrm{QP}}(t_{m,i}, t_{m,j})$，以及 $(K_{mo})_{ij} = k_{\\mathrm{QP}}(t_{m,i}, t_{o,j})$。矩阵 $K_{om}$ 是 $K_{mo}$ 的转置，即 $K_{om} = K_{mo}^{\\top}$。\n\n观测值 $y_o$ 并不是对 $f_o$ 的直接测量；它们受到方差为 $\\sigma_n^2$ 的独立同分布高斯噪声的污染。测量模型为：\n$$\ny_o = f_o + \\epsilon\n$$\n其中 $\\epsilon \\sim \\mathcal{N}(0, \\sigma_n^2 I_{N_o})$，$I_{N_o}$ 是 $N_o \\times N_o$ 的单位矩阵。假设噪声 $\\epsilon$ 与恒星活动信号 $f(t)$ 相互独立。\n\n为了找到条件分布 $p(f_m | y_o)$，我们首先需要 $(f_m, y_o)$ 的联合分布。这是一个多元正态分布，因为 $f_m$ 和 $y_o$ 都是高斯随机变量的线性组合。这个联合分布的均值为零：\n$$\n\\mathbb{E} \\begin{pmatrix} f_m \\\\ y_o \\end{pmatrix} = \\begin{pmatrix} \\mathbb{E}[f_m] \\\\ \\mathbb{E}[y_o] \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\mathbb{E}[f_o + \\epsilon] \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\mathbb{E}[f_o] + \\mathbb{E}[\\epsilon] \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n联合分布的协方差矩阵需要计算三个块分量：\n1. $f_m$ 的自协方差：\n    $$\n    \\text{Cov}(f_m, f_m) = \\mathbb{E}[f_m f_m^{\\top}] - \\mathbb{E}[f_m]\\mathbb{E}[f_m]^{\\top} = K_{mm}\n    $$\n2. $y_o$ 的自协方差：\n    $$\n    \\text{Cov}(y_o, y_o) = \\mathbb{E}[y_o y_o^{\\top}] = \\mathbb{E}[(f_o + \\epsilon)(f_o + \\epsilon)^{\\top}] = \\mathbb{E}[f_o f_o^{\\top} + f_o \\epsilon^{\\top} + \\epsilon f_o^{\\top} + \\epsilon \\epsilon^{\\top}]\n    $$\n    由于 $f_o$ 和 $\\epsilon$ 的独立性，交叉项的期望为零，即 $\\mathbb{E}[f_o \\epsilon^{\\top}] = \\mathbb{E}[f_o]\\mathbb{E}[\\epsilon]^{\\top} = 0$。这可将表达式简化为：\n    $$\n    \\text{Cov}(y_o, y_o) = \\mathbb{E}[f_o f_o^{\\top}] + \\mathbb{E}[\\epsilon \\epsilon^{\\top}] = K_{oo} + \\sigma_n^2 I_{N_o}\n    $$\n3. $f_m$ 和 $y_o$ 之间的互协方差：\n    $$\n    \\text{Cov}(f_m, y_o) = \\mathbb{E}[f_m y_o^{\\top}] = \\mathbb{E}[f_m (f_o + \\epsilon)^{\\top}] = \\mathbb{E}[f_m f_o^{\\top}] + \\mathbb{E}[f_m \\epsilon^{\\top}]\n    $$\n    同样，由于独立性，$\\mathbb{E}[f_m \\epsilon^{\\top}] = 0$，剩下：\n    $$\n    \\text{Cov}(f_m, y_o) = \\mathbb{E}[f_m f_o^{\\top}] = K_{mo}\n    $$\n    相应的转置是 $\\text{Cov}(y_o, f_m) = \\text{Cov}(f_m, y_o)^{\\top} = K_{mo}^{\\top}$。\n\n综合这些结果，$(f_m, y_o)$ 的联合分布是：\n$$\n\\begin{pmatrix} f_m \\\\ y_o \\end{pmatrix} \\sim \\mathcal{N} \\! \\left( \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} K_{mm}  K_{mo} \\\\ K_{mo}^{\\top}  K_{oo} + \\sigma_n^2 I_{N_o} \\end{pmatrix} \\right)\n$$\n现在我们可以使用对多元正态分布进行条件化的标准法则。对于一个通用的分块高斯向量 $(x_1, x_2)$，其均值为 $(\\mu_1, \\mu_2)$，协方差矩阵为 $\\begin{pmatrix} \\Sigma_{11}  \\Sigma_{12} \\\\ \\Sigma_{21}  \\Sigma_{22} \\end{pmatrix}$，给定 $x_2=a$ 时 $x_1$ 的条件分布是高斯分布，$p(x_1 | x_2=a) = \\mathcal{N}(\\mu_{1|2}, \\Sigma_{1|2})$，其中：\n$$\n\\mu_{1|2} = \\mu_1 + \\Sigma_{12} \\Sigma_{22}^{-1} (a - \\mu_2)\n$$\n$$\n\\Sigma_{1|2} = \\Sigma_{11} - \\Sigma_{12} \\Sigma_{22}^{-1} \\Sigma_{21}\n$$\n通过将 $x_1 \\equiv f_m$、$x_2 \\equiv y_o$、$\\mu_1 = 0$、$\\mu_2 = 0$、$\\Sigma_{11} = K_{mm}$、$\\Sigma_{12} = K_{mo}$、$\\Sigma_{21} = K_{mo}^{\\top}$ 和 $\\Sigma_{22} = K_{oo} + \\sigma_n^2 I_{N_o}$ 对应起来，我们得到给定观测值 $y_o$ 时 $f_m$ 的条件分布。条件均值 $\\mu_m = \\mathbb{E}[f_m | y_o]$ 为：\n$$\n\\mu_m = 0 + K_{mo} (K_{oo} + \\sigma_n^2 I_{N_o})^{-1} (y_o - 0) = K_{mo} (K_{oo} + \\sigma_n^2 I_{N_o})^{-1} y_o\n$$\n条件协方差为：\n$$\n\\text{Cov}(f_m | y_o) = K_{mm} - K_{mo} (K_{oo} + \\sigma_n^2 I_{N_o})^{-1} K_{mo}^{\\top}\n$$\n问题要求提供条件均值向量 $\\mu_m$ 的闭式表达式，我们已经推导出来了。\n\n对于问题的第二部分，我们提出一种为可视化目的填补未观测片段的策略。正确的策略是使用上面推导出的后验预测分布。具体来说，应当：\n1.  首先，推断 GP 超参数（$A$, $\\lambda$, $P$, $w$），以及任何存在的系外行星模型的参数。此推断步骤通过最大化*观测数据* $y_o$ 的边际对数似然来执行。边际似然通过对潜在函数 $f_o$ 进行积分（边缘化）得到，并由高斯分布 $y_o \\sim \\mathcal{N}(0, K_{oo} + \\sigma_n^2 I_{N_o})$ 的概率密度给出。因此，对数似然函数是：\n    $$\n    \\log p(y_o | A, \\lambda, P, w, \\sigma_n^2) = -\\frac{1}{2} y_o^{\\top} (K_{oo} + \\sigma_n^2 I_{N_o})^{-1} y_o - \\frac{1}{2} \\log \\det(K_{oo} + \\sigma_n^2 I_{N_o}) - \\frac{N_o}{2} \\log(2\\pi)\n    $$\n    （为简单起见，我们假设系外行星信号已被考虑在内，例如通过联合建模，这不改变这里的核心逻辑。）\n2.  在获得最优（例如，最大似然或最大后验）超参数 $\\hat{\\theta} = (\\hat{A}, \\hat{\\lambda}, \\hat{P}, \\hat{w})$ 后，将这些值固定下来，并用它们来构建协方差矩阵 $K_{oo}$、$K_{mm}$ 和 $K_{mo}$。\n3.  然后通过绘制后验预测均值 $\\mu_m = \\mathbb{E}[f_m | y_o, \\hat{\\theta}]$ 作为最可能的信号来填补未观测的片段。可选地，可以从后验协方差矩阵 $\\text{Cov}(f_m | y_o, \\hat{\\theta})$ 的对角线元素构建可信区间，以可视化填补的不确定性。\n\n此策略在科学上是合理的，并且由于以下原因避免了对推断产生偏差：\n-   **不改变似然函数**：填补是一个*后处理*步骤。参数推断完全基于观测数据 $y_o$ 的似然函数 $p(y_o | \\theta)$。填补值 $f_m$ 不被用作数据，因此不会进入似然函数。\n-   **不重复计算数据**：填补值是已经拟合了观测数据的模型的预测值。它们是推断的结果，而不是推断的输入。将它们用于可视化仅仅是检查已拟合模型对未观测时段的预测情况的一种方式。这不构成将数据反馈回模型，那将是重复计算的一个实例。\n\n此过程正确地将模型拟合过程（使用 $y_o$ 进行参数推断）与预测过程（在给定已拟合模型和 $y_o$ 的情况下计算期望信号 $f_m$）分开，确保了可视化不会破坏模型任何分量（包括系外行星信号）的参数估计的统计完整性。\n\n最后要求的表达式是条件均值向量。将单位矩阵表示为 $I$，即为：\n$$\n\\mu_m = K_{mo} (K_{oo} + \\sigma_n^2 I)^{-1} y_o\n$$",
            "answer": "$$\n\\boxed{K_{mo} (K_{oo} + \\sigma_{n}^{2} I)^{-1} y_{o}}\n$$"
        }
    ]
}