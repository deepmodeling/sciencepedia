{
    "hands_on_practices": [
        {
            "introduction": "This exercise serves as a fundamental check on our theoretical framework. We will derive the primary oblateness term of a rotating fluid body, the zonal harmonic coefficient $J_2$, in two distinct ways: first from its geometry, and second from the theory of hydrostatic equilibrium using the fluid Love number $k_2$. By demonstrating that these two approaches yield an identical result for a Maclaurin spheroid , you will solidify your understanding of how rotation, shape, and gravitational potential are self-consistently linked.",
            "id": "4162509",
            "problem": "Consider a homogeneous Maclaurin spheroid of equatorial semi-axis $a$, polar semi-axis $c$, and small eccentricity $e$ defined by $e^{2} = 1 - c^{2}/a^{2}$. The body is in hydrostatic equilibrium under its own Newtonian gravity and uniform rotation at angular speed $\\omega$. Let $M$ be the total mass, $\\rho$ the uniform density, and $G$ the gravitational constant. The external gravitational potential can be represented in spherical harmonics with dimensionless zonal coefficients $J_{2n}$, where $J_{2}$ is the second zonal harmonic. Define the dimensionless rotational parameter $q = \\omega^{2} a^{3}/(G M)$.\n\nUsing only fundamental definitions from Newtonian gravity (multipole expansion of the external potential, principal moments of inertia of a homogeneous ellipsoid, and hydrostatic response characterized by the degree-$2$ potential Love number $k_{2}$ for an incompressible homogeneous fluid), and working consistently to leading nontrivial order in the small parameter $e$, do the following:\n\n- Derive the leading-order expression for $J_{2}$ as a function of $e$ for the homogeneous Maclaurin spheroid.\n- Using the fluid Love-number framework and the small-$e$ Maclaurin spheroid relation between $\\omega$ and $e$, obtain the leading-order prediction for $J_{2}$ in terms of $e$, and compute the ratio of the two results.\n\nProvide your final answer as two closed-form analytic expressions: the leading-order $J_{2}(e)$ and the ratio $J_{2,\\text{Maclaurin}}/J_{2,\\text{Love}}$. No numerical evaluation or rounding is required. Both quantities are dimensionless; do not include any units in your final expressions.",
            "solution": "The problem asks for two distinct derivations of the leading-order expression for the second-degree zonal harmonic coefficient, $J_2$, of a homogeneous Maclaurin spheroid with small eccentricity $e$. The first derivation is based on the spheroid's geometry and mass distribution (moments of inertia). The second is based on the theory of hydrostatic equilibrium using the fluid Love number $k_2$. Finally, the ratio of the two results is required.\n\n**Part 1: Derivation of $J_2$ from Moments of Inertia**\n\nThe external gravitational potential, $V$, of an axisymmetric body can be expressed as a multipole expansion in spherical harmonics. To second degree, it is given by:\n$$\nV(r, \\theta) = -\\frac{GM}{r} \\left( 1 - J_2 \\left(\\frac{a}{r}\\right)^2 P_2(\\cos\\theta) + \\dots \\right)\n$$\nwhere $M$ is the mass, $G$ is the gravitational constant, $a$ is the equatorial radius, $r$ is the radial distance, $\\theta$ is the colatitude, and $P_2(x) = \\frac{1}{2}(3x^2 - 1)$ is the second-degree Legendre polynomial. The dimensionless coefficient $J_2$ is related to the principal moments of inertia of the body. For a body with rotational symmetry about the z-axis, this relation is:\n$$\nJ_2 = \\frac{C - A}{Ma^2}\n$$\nHere, $C$ is the moment of inertia about the polar axis (z-axis), and $A$ is the moment of inertia about any equatorial axis (e.g., the x-axis).\n\nFor a homogeneous ellipsoid of revolution (a spheroid) with uniform density $\\rho$, equatorial semi-axis $a$, and polar semi-axis $c$, the principal moments of inertia are given by:\n$$\nC = \\frac{2}{5} M a^2\n$$\n$$\nA = \\frac{1}{5} M (a^2 + c^2)\n$$\nThe difference between the principal moments of inertia is:\n$$\nC - A = \\frac{2}{5} M a^2 - \\frac{1}{5} M (a^2 + c^2) = \\frac{1}{5} M (2a^2 - a^2 - c^2) = \\frac{1}{5} M (a^2 - c^2)\n$$\nSubstituting this into the expression for $J_2$:\n$$\nJ_2 = \\frac{\\frac{1}{5} M (a^2 - c^2)}{M a^2} = \\frac{1}{5} \\frac{a^2 - c^2}{a^2} = \\frac{1}{5} \\left(1 - \\frac{c^2}{a^2}\\right)\n$$\nThe problem defines the eccentricity $e$ such that $e^2 = 1 - c^2/a^2$. Therefore, the expression for $J_2$ for a homogeneous Maclaurin spheroid is:\n$$\nJ_{2,\\text{Maclaurin}} = \\frac{1}{5} e^2\n$$\nThis expression is exact and thus also represents the leading non-trivial order in the small parameter $e$.\n\n**Part 2: Derivation of $J_2$ using the Fluid Love Number Framework**\n\nThe Love number framework describes a body's response to a deforming potential. For a body rotating with angular velocity $\\omega$, the centrifugal potential $V_c$ acts as a deforming potential.\n$$\nV_c = -\\frac{1}{2} \\omega^2 r^2 \\sin^2\\theta = -\\frac{1}{3} \\omega^2 r^2 (1 - P_2(\\cos\\theta)) = -\\frac{1}{3}\\omega^2 r^2 + \\frac{1}{3}\\omega^2 r^2 P_2(\\cos\\theta)\n$$\nThe $P_2$ component of this potential, $\\Phi_2 = \\frac{1}{3}\\omega^2 r^2 P_2(\\cos\\theta)$, causes the degree-$2$ deformation. The body's response to this potential generates an additional gravitational potential, $\\Delta V_2$. The potential Love number $k_2$ is defined by the relation $\\Delta V_2 = k_2 \\Phi_2$ evaluated at the body's surface.\n\nFrom the multipole expansion, the additional potential due to the $J_2$ term is $\\Delta V_2 = \\frac{GMa^2}{r^3} J_2 P_2(\\cos\\theta)$. At the surface ($r=a$), we have:\n$$\n\\Delta V_2(a) = \\frac{GM}{a} J_2 P_2(\\cos\\theta)\n$$\nThe deforming potential at the surface is:\n$$\n\\Phi_2(a) = \\frac{1}{3} \\omega^2 a^2 P_2(\\cos\\theta)\n$$\nApplying the definition of $k_2$:\n$$\n\\frac{GM}{a} J_2 P_2(\\cos\\theta) = k_2 \\left( \\frac{1}{3} \\omega^2 a^2 P_2(\\cos\\theta) \\right)\n$$\nSolving for $J_2$:\n$$\nJ_2 = \\frac{k_2 \\omega^2 a^3}{3GM}\n$$\nUsing the definition of the dimensionless rotation parameter $q = \\omega^2 a^3 / (GM)$, we get:\n$$\nJ_2 = \\frac{1}{3} k_2 q\n$$\nFor a homogeneous, incompressible fluid body in hydrostatic equilibrium, the theoretical value of the degree-$2$ potential Love number is $k_2 = 3/2$. Substituting this value:\n$$\nJ_{2,\\text{Love}} = \\frac{1}{3} \\left(\\frac{3}{2}\\right) q = \\frac{1}{2} q\n$$\nTo express $J_2$ in terms of $e$, we need the relationship between $q$ and $e$ for a Maclaurin spheroid in hydrostatic equilibrium, valid for small $e$. The exact equilibrium condition is given by:\n$$\n\\frac{\\omega^2}{2\\pi G \\rho} = \\frac{\\sqrt{1-e^2}}{e^3} (3-2e^2) \\arcsin(e) - \\frac{3(1-e^2)}{e^2}\n$$\nWe expand this for small $e$, using $\\arcsin(e) = e + e^3/6 + O(e^5)$ and $\\sqrt{1-e^2} = 1 - e^2/2 + O(e^4)$. The expansion to the first non-vanishing term yields:\n$\\frac{\\omega^2}{2\\pi G \\rho} \\approx \\frac{4}{15}e^2$.\nSo, to leading order:\n$$\n\\omega^2 \\approx \\frac{8\\pi G \\rho}{15} e^2\n$$\nNow we express $q$ in terms of $\\omega^2$. The mass is $M = \\rho V = \\rho \\frac{4}{3}\\pi a^2 c = \\rho \\frac{4}{3}\\pi a^3 \\sqrt{1-e^2}$. For small $e$, $M \\approx \\rho \\frac{4}{3}\\pi a^3$.\n$$\nq = \\frac{\\omega^2 a^3}{GM} \\approx \\frac{\\omega^2 a^3}{G(\\rho \\frac{4}{3}\\pi a^3)} = \\frac{3\\omega^2}{4\\pi G \\rho}\n$$\nSubstituting our expression for $\\omega^2$:\n$$\nq \\approx \\frac{3}{4\\pi G \\rho} \\left( \\frac{8\\pi G \\rho}{15} e^2 \\right) = \\frac{24}{60} e^2 = \\frac{2}{5} e^2\n$$\nFinally, we substitute this relation for $q$ into our expression for $J_{2,\\text{Love}}$:\n$$\nJ_{2,\\text{Love}} = \\frac{1}{2} q \\approx \\frac{1}{2} \\left( \\frac{2}{5} e^2 \\right) = \\frac{1}{5} e^2\n$$\nThis is the leading-order prediction from the fluid Love number framework.\n\n**Part 3: Ratio of the Two Results**\n\nThe first method yielded $J_{2,\\text{Maclaurin}} = \\frac{1}{5}e^2$. The second method yielded the same leading-order result, $J_{2,\\text{Love}} \\approx \\frac{1}{5}e^2$. The ratio is therefore:\n$$\n\\frac{J_{2,\\text{Maclaurin}}}{J_{2,\\text{Love}}} = \\frac{\\frac{1}{5}e^2}{\\frac{1}{5}e^2} = 1\n$$\nThe identity of the two results is expected, as they are two different but consistent formalisms for describing the same physical object: a homogeneous fluid body in hydrostatic equilibrium.\n\nThe two requested quantities are the leading-order expression for $J_2(e)$ and the ratio.\n$J_2(e) = \\frac{1}{5}e^2$.\nRatio = $1$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{5}e^{2}  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Celestial bodies are not homogeneous, and their internal structure is a primary target of geophysical investigation. This practice takes the crucial step of modeling this complexity by asking you to derive the degree-2 potential Love number $k_2$ for a differentiated, two-layer fluid planet. Working through this problem  will reveal how a planet's global tidal response becomes sensitive to the density contrast and relative size of its core, illustrating the foundational principle of using gravity field measurements to invert for interior properties.",
            "id": "4162488",
            "problem": "Consider a spherically symmetric, self-gravitating, two-layer incompressible fluid planet of total radius $R$, with an inner core of radius $r_c$ and density $\\rho_c$, overlain by a mantle of density $\\rho_m$. The planet is perturbed by a weak, static, degree-$2$ external potential $U_e(r,\\theta)=U_0\\,r^2\\,P_2(\\cos\\theta)$, where $P_2(\\cos\\theta)$ is the Legendre polynomial of degree $2$ and $U_0$ is a constant amplitude. Work in the linear regime of small deformations, assume hydrostatic equilibrium, and neglect rotation. The background (spherically symmetric) gravitational potential satisfies Newtonian gravity with gravitational constant $G$.\n\nStarting from first principles of Newtonian gravitation and hydrostatic equilibrium, and using:\n- that the perturbing self-gravitational potential due to a small, degree-$2$ radial displacement $\\xi(a)\\,P_2(\\cos\\theta)$ of a density interface located at radius $a$ between densities $\\rho_{\\mathrm{in}}$ (inside) and $\\rho_{\\mathrm{out}}$ (outside) is harmonic in regions free of mass and must be continuous across the interface, and\n- that the jump in the radial derivative of the perturbing potential across the displaced interface equals $-4\\pi G$ times the effective surface mass density produced by the displacement, i.e., $-4\\pi G\\,\\Delta\\rho\\,\\xi(a)\\,P_2(\\cos\\theta)$ with $\\Delta\\rho=\\rho_{\\mathrm{out}}-\\rho_{\\mathrm{in}}$,\n- together with hydrostatic traction (pressure) continuity at each interface, which requires that each interface is an equipotential surface of the total potential to first order,\n\nderive an explicit, closed-form expression for the hydrostatic degree-$2$ potential Love number $k_2$, defined by $k_2=\\delta\\Phi(R)/U_e(R)$, where $\\delta\\Phi(R)$ is the self-gravitational potential perturbation evaluated at the planet’s surface $r=R$ due to the tidal deformation. Express your final answer in terms of the dimensionless core radius ratio $\\alpha=r_c/R$, the densities $\\rho_c$ and $\\rho_m$, and fundamental constants as needed. Your final expression must be a single closed-form algebraic expression; do not provide a numerical value. The Love number $k_2$ is dimensionless, so no unit specification is required.",
            "solution": "This problem requires deriving the degree-2 potential Love number, $k_2$, for a two-layer, incompressible, non-rotating fluid planet in hydrostatic equilibrium. The derivation involves defining the gravitational potential perturbation in each region and applying boundary conditions at the interfaces.\n\n### 1. Potential Perturbations\n\nThe total potential is $\\Phi_{\\text{total}} = \\Phi_0(r) + U_e(r, \\theta) + \\delta\\Phi(r, \\theta)$, where $\\Phi_0$ is the unperturbed potential, $U_e$ is the external tidal potential, and $\\delta\\Phi$ is the induced potential from the deformation. All degree-2 potential perturbations, $\\delta\\Phi$, satisfy Laplace's equation in the mass-free regions (core, mantle, exterior). Their radial parts, $\\delta\\phi(r)$, have the general form:\n- Core ($0 \\le r \\le r_c$): $\\delta\\phi_{\\text{core}}(r) = C_1 r^2$\n- Mantle ($r_c \\le r \\le R$): $\\delta\\phi_{\\text{mantle}}(r) = C_2 r^2 + C_3 r^{-3}$\n- Exterior ($r \\ge R$): $\\delta\\phi_{\\text{ext}}(r) = C_4 r^{-3}$\n\n### 2. Boundary Conditions for Potential\n\nLet the radial displacements of the core-mantle boundary (CMB) and surface be $\\xi_c$ and $\\xi_R$, respectively. The potential must be continuous, and its radial derivative must have a specific jump condition at each interface.\n\n**At the CMB ($r=r_c$):**\n1. Continuity of potential: $\\delta\\phi_{\\text{core}}(r_c) = \\delta\\phi_{\\text{mantle}}(r_c) \\implies C_1 r_c^2 = C_2 r_c^2 + C_3 r_c^{-3}$\n2. Jump in radial derivative: $\\left[\\frac{d\\delta\\phi}{dr}\\right]_{r_c} = 4\\pi G (\\rho_c - \\rho_m) \\xi_c$. Combining with continuity gives: $5C_3 = 4\\pi G (\\rho_m - \\rho_c) r_c^4 \\xi_c \\quad (A)$\n\n**At the surface ($r=R$):**\n3. Continuity of potential: $\\delta\\phi_{\\text{mantle}}(R) = \\delta\\phi_{\\text{ext}}(R) \\implies C_2 R^2 + C_3 R^{-3} = C_4 R^{-3}$, so $C_4 = C_2 R^5 + C_3$.\n4. Jump in radial derivative: $\\left[\\frac{d\\delta\\phi}{dr}\\right]_{R} = 4\\pi G \\rho_m \\xi_R$. Combining with continuity gives: $-5C_2 R = 4\\pi G \\rho_m \\xi_R \\quad (B)$\n\n### 3. Hydrostatic Equilibrium\n\nFor a fluid in hydrostatic equilibrium, each deformed interface must be an equipotential surface. This means the sum of all perturbing potentials at the interface must be balanced by the work done to displace the surface against the background gravity, $g_0(r)$.\n$$g_0(a)\\xi(a) + u_e(a) + \\delta\\phi(a) = 0 \\implies \\xi(a) = -\\frac{u_e(a) + \\delta\\phi(a)}{g_0(a)}$$\nwhere $u_e(r) = U_0 r^2$ is the radial part of the tidal potential. The background gravity at each interface is $g_0(r_c) = \\frac{4\\pi G}{3}r_c\\rho_c$ and $g_0(R) = \\frac{4\\pi G R}{3}\\bar{\\rho}$, where $\\bar{\\rho} = \\rho_c(r_c/R)^3 + \\rho_m(1-(r_c/R)^3)$ is the mean planetary density.\n\n### 4. Solving the System\n\nWe substitute the expressions for $\\xi_c$ and $\\xi_R$ into equations (A) and (B):\n- From (A): $5C_3 = 4\\pi G (\\rho_m - \\rho_c) r_c^4 \\left(-\\frac{U_0 r_c^2 + \\delta\\phi_{\\text{core}}(r_c)}{\\frac{4\\pi G}{3}r_c\\rho_c}\\right) \\implies C_3 (2\\rho_c + 3\\rho_m) = 3(\\rho_c - \\rho_m)r_c^5(U_0+C_2) \\quad (I)$\n- From (B): $-5C_2 R = 4\\pi G \\rho_m \\left(-\\frac{U_0 R^2 + \\delta\\phi_{\\text{ext}}(R)}{\\frac{4\\pi G R}{3}\\bar{\\rho}}\\right) \\implies C_2 (5\\bar{\\rho} - 3\\rho_m) = 3\\rho_m(U_0+C_3 R^{-5}) \\quad (II)$\n\nEquations (I) and (II) form a $2 \\times 2$ linear system for $C_2$ and $C_3$. We want to find the Love number $k_2$, defined by $\\delta\\Phi(R) = k_2 U_e(R)$. In terms of radial functions, $k_2 = \\delta\\phi_{\\text{ext}}(R) / u_e(R) = C_4 R^{-3} / (U_0 R^2) = C_4/(U_0R^5)$. Since $C_4 = C_2 R^5 + C_3$, we have $k_2 = C_2/U_0 + C_3/(U_0R^5)$.\n\nSolving the system (I) and (II) for the ratios $\\hat{C}_2 = C_2/U_0$ and $\\hat{C}_3 = C_3/U_0$ and adding them to find $k_2$ yields the final expression. Let $\\alpha=r_c/R$. The mean density is $\\bar{\\rho} = \\rho_m + (\\rho_c-\\rho_m)\\alpha^3$. The resulting solution for $k_2$ is:\n$$k_2 = \\frac{3\\rho_m(2\\rho_c + 3\\rho_m) + (9\\rho_m+15\\bar{\\rho})(\\rho_c-\\rho_m)\\alpha^5}{(2\\rho_c+3\\rho_m)(2\\rho_m + 5(\\rho_c-\\rho_m)\\alpha^3) - 9\\rho_m(\\rho_c-\\rho_m)\\alpha^5}$$\nSubstituting the expression for $\\bar{\\rho}$ gives the final answer in terms of the required parameters.\n\n**Check:** For a homogeneous body, $\\rho_c = \\rho_m = \\rho$. All terms with $(\\rho_c-\\rho_m)$ vanish. The numerator becomes $3\\rho(2\\rho+3\\rho) = 15\\rho^2$. The denominator becomes $(2\\rho+3\\rho)(2\\rho) = 10\\rho^2$. Thus, $k_2 = 15\\rho^2 / 10\\rho^2 = 3/2$, the correct value for a uniform fluid body.",
            "answer": "$$\\boxed{\\frac{3\\rho_m(2\\rho_c + 3\\rho_m) + \\left[9\\rho_m + 15\\left(\\rho_c \\alpha^3 + \\rho_m(1 - \\alpha^3)\\right)\\right](\\rho_c - \\rho_m)\\alpha^5}{(2\\rho_c + 3\\rho_m)\\left[2\\rho_m + 5(\\rho_c - \\rho_m)\\alpha^3\\right] - 9\\rho_m(\\rho_c - \\rho_m)\\alpha^5}}$$"
        },
        {
            "introduction": "While analytical solutions for simple, layered models provide crucial physical intuition, modeling realistic planets requires tackling complex radial variations in density and elastic properties with numerical methods. This culminating practice guides you through the formulation of the governing elastic-gravitational equations into a system of first-order ordinary differential equations suitable for numerical integration . This exercise bridges the gap between idealized theory and the computational framework essential for modern research in planetary interior modeling.",
            "id": "4162504",
            "problem": "You are modeling the degree-$2$ static tidal response of a spherically symmetric, self-gravitating, linearly elastic exoplanet. Your goal is to start from first principles to formulate the elastic-gravitational normal-mode equations, to specify boundary conditions that enforce physical and numerical well-posedness, and to produce a working program that computes an approximate dimensionless degree-$2$ tidal Love number $k_2$ for a provided test suite.\n\nFoundational basis to use:\n- Newtonian gravity: $\\,\\nabla^2 \\delta \\Phi = 4\\pi G \\,\\delta \\rho$ and $\\,\\mathbf{g}(r) = -\\nabla \\Phi(r)\\,$ with $\\,G\\,$ the gravitational constant and $\\,\\Phi(r)\\,$ the gravitational potential.\n- Linear elasticity for an isotropic solid: $\\,\\boldsymbol{\\sigma} = \\lambda \\,(\\nabla \\cdot \\boldsymbol{\\xi})\\,\\mathbf{I} + 2\\mu\\,\\boldsymbol{\\epsilon}\\,$, where $\\,\\boldsymbol{\\xi}(r,\\theta,\\phi)\\,$ is the displacement, $\\,\\boldsymbol{\\epsilon} = \\tfrac{1}{2}(\\nabla \\boldsymbol{\\xi} + \\nabla \\boldsymbol{\\xi}^{\\mathsf{T}})\\,$ is the strain tensor, $\\,\\lambda(r)\\,$ and $\\,\\mu(r)\\,$ are the Lamé parameters, and $\\,\\mathbf{I}\\,$ is the identity tensor.\n- Static mechanical equilibrium under a tide: $\\,\\nabla \\cdot \\boldsymbol{\\sigma} + \\rho \\,\\nabla(\\delta \\Phi + \\Phi^{\\mathrm{tidal}}) = \\mathbf{0}\\,$, where $\\,\\rho(r)\\,$ is density, $\\,\\delta \\Phi\\,$ is the self-gravitational perturbation, and $\\,\\Phi^{\\mathrm{tidal}}\\,$ is an external degree-$2$ tide-generating potential.\n\nDefinitions and translations from seismic velocities:\n- The prescribed radial profiles are $\\,V_s(r)\\,$ and $\\,V_p(r)\\,$. For an isotropic medium, use $\\,\\mu(r) = \\rho(r)\\,V_s(r)^2\\,$ and $\\,\\lambda(r) = \\rho(r)\\,\\big(V_p(r)^2 - 2V_s(r)^2\\big)\\,$.\n\nYour tasks:\n1. Derive the first-order ordinary differential equation system (the elastic-gravitational normal-mode equations in the static limit) for the degree-$2$ spheroidal response in a spherically symmetric body. Use a separation of variables in spherical harmonics with degree $\\,\\ell=2\\,$ and express the displacement field as $\\,\\boldsymbol{\\xi}(r,\\theta,\\phi) = U(r)\\,Y_{2m}(\\theta,\\phi)\\,\\hat{\\mathbf{r}} + V(r)\\,\\nabla_{\\!\\!s}Y_{2m}(\\theta,\\phi)\\,$, where $\\,\\nabla_{\\!\\!s}\\,$ denotes the surface gradient on the sphere. Identify a minimal state vector $\\,\\mathbf{y}(r)\\,$ that collects the radial functions and reduce the governing equations to a first-order system $\\,\\dfrac{d\\mathbf{y}}{dr} = \\mathbf{A}(r)\\,\\mathbf{y} + \\mathbf{b}(r)\\,$, with $\\,\\mathbf{A}(r)\\,$ and $\\,\\mathbf{b}(r)\\,$ expressed in terms of $\\,\\lambda(r)\\,$, $\\,\\mu(r)\\,$, $\\,\\rho(r)\\,$, $\\,G\\,$, and degree $\\,\\ell=2\\,$. Do not use any ad hoc formulas; construct the reduction from the above foundational equations.\n2. Specify physically and numerically appropriate boundary conditions:\n   - At $\\,r=0\\,$: regularity of all fields, ensuring finite displacements and stresses and the correct leading-order behavior for $\\,\\ell=2\\,$.\n   - At any internal interface $\\,r=r_i\\,$ with discontinuities in $\\,\\rho, \\lambda, \\mu\\,$: continuity of $\\,U(r)\\,$ and $\\,V(r)\\,$, continuity of the radial traction $\\,\\sigma_{rr}\\,$ and the shear traction $\\,\\sigma_{r\\perp}\\,$, and continuity of $\\,\\delta \\Phi\\,$ with the jump condition for its radial derivative consistent with mass conservation under displacement.\n   - At the free surface $\\,r=R\\,$: traction-free boundary conditions $\\,\\sigma_{rr}(R) = 0\\,$ and $\\,\\sigma_{r\\perp}(R) = 0\\,$, and gravitational matching conditions for $\\,\\delta \\Phi\\,$ and its derivative with the exterior solution for $\\,\\ell=2\\,$ including the contribution from the surface mass redistribution proportional to $\\,\\rho(R)\\,U(R)\\,$.\n3. Implement a program that, for the provided test suite, computes a dimensionless approximation to $\\,k_2\\,$ using the homogeneous incompressible-sphere approximation derived from your elastic-gravitational formulation. In this approximation, you may treat the body as if it had a single effective shear modulus $\\,\\mu_{\\mathrm{eff}}\\,$ and mean density $\\,\\bar{\\rho}\\,$. You must:\n   - Compute $\\,\\bar{\\rho}\\,$ from $\\,\\rho(r)\\,$ by volume integration.\n   - Compute the surface gravity $\\,g = GM/R^2\\,$ from the integrated mass $\\,M\\,$.\n   - Compute $\\,\\mu_{\\mathrm{eff}}\\,$ by a physically motivated volume average of $\\,\\mu(r) = \\rho(r)\\,V_s(r)^2\\,$.\n   - Use these to evaluate the approximation to $\\,k_2\\,$ in consistent units.\n4. Express the outputs as dimensionless floating-point numbers. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\").\n\nUnits and inputs:\n- Use the International System of Units (SI): $\\,r\\,$ and $\\,R\\,$ in meters, $\\,\\rho\\,$ in kilograms per cubic meter, $\\,V_s\\,$ and $\\,V_p\\,$ in meters per second, $\\,G\\,$ in cubic meters per kilogram per second squared, and $\\,k_2\\,$ dimensionless.\n- Angles do not appear in the computation to be performed by the code; spherical-harmonic separation is conceptual and analytical.\n- The program must be self-contained and must not read external files or accept user input.\n\nTest suite:\nEach test case is a tuple where the first element is the outer radius $\\,R\\,$, the second element is a description of the radial profiles given as lists of layers $(r_{\\mathrm{top}}, \\rho, V_s, V_p)$ providing piecewise-constant profiles up to $\\,R\\,$, and the third element is the gravitational constant $\\,G\\,$.\n\nProvide the following four test cases:\n- Case A (edge case: hydrostatic fluid body): $\\,R = 3.0\\times 10^6\\,\\mathrm{m}\\,$. Single layer up to $\\,R\\,$ with $\\,\\rho = 4000\\,\\mathrm{kg\\,m^{-3}}\\,$, $\\,V_s = 0\\,\\mathrm{m\\,s^{-1}}\\,$, $\\,V_p = 5000\\,\\mathrm{m\\,s^{-1}}\\,$. $\\,G = 6.67430\\times 10^{-11}\\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}\\,$.\n- Case B (homogeneous elastic Earth-like): $\\,R = 6.371\\times 10^6\\,\\mathrm{m}\\,$. Single layer with $\\,\\rho = 5510\\,\\mathrm{kg\\,m^{-3}}\\,$, $\\,V_s = 4500\\,\\mathrm{m\\,s^{-1}}\\,$, $\\,V_p = 8000\\,\\mathrm{m\\,s^{-1}}\\,$. Same $\\,G\\,$.\n- Case C (small rocky planet): $\\,R = 2.0\\times 10^6\\,\\mathrm{m}\\,$. Single layer with $\\,\\rho = 3500\\,\\mathrm{kg\\,m^{-3}}\\,$, $\\,V_s = 3000\\,\\mathrm{m\\,s^{-1}}\\,$, $\\,V_p = 6000\\,\\mathrm{m\\,s^{-1}}\\,$. Same $\\,G\\,$.\n- Case D (very rigid super-Earth): $\\,R = 1.0\\times 10^7\\,\\mathrm{m}\\,$. Single layer with $\\,\\rho = 7000\\,\\mathrm{kg\\,m^{-3}}\\,$, $\\,V_s = 8000\\,\\mathrm{m\\,s^{-1}}\\,$, $\\,V_p = 14000\\,\\mathrm{m\\,s^{-1}}\\,$. Same $\\,G\\,$.\n\nAnswer specification:\n- For each case, your program must output a single floating-point number representing the dimensionless approximate degree-$2$ tidal Love number $\\,k_2\\,$ computed as described above.\n- Your program should produce a single line of output containing the four results as a comma-separated list enclosed in square brackets, in the order [Case A, Case B, Case C, Case D].",
            "solution": "This solution outlines the theoretical framework for modeling the static tidal response of an elastic planet and provides the specific approximation used to solve the problem numerically.\n\n### 1. Derivation of the Elastic-Gravitational ODE System\n\nThe derivation starts from the foundational equations of static mechanical equilibrium, Poisson's equation for gravity, and linear elasticity. By performing a separation of variables in spherical coordinates, the displacement, stress, and gravitational potential fields are expanded in terms of scalar radial functions and degree $\\ell=2$ spherical harmonics. A standard state vector $\\mathbf{y}(r)$ is defined to represent the radial functions of displacement, traction, and potential variables:\n$$\n\\mathbf{y}(r) = [U(r), T_{rr}(r), V(r), T_{r\\perp}(r), P(r), \\dot{P}(r) - 4\\pi G \\rho U(r)]^\\mathsf{T}\n$$\nwhere $U$ and $V$ are the radial and tangential displacement functions, $T_{rr}$ and $T_{r\\perp}$ are the normal and shear traction functions, $P$ is the potential perturbation function, and $\\dot{f} \\equiv df/dr$.\n\nAfter a standard but lengthy algebraic reduction, these foundational equations can be cast into a system of six first-order ordinary differential equations (ODEs), $\\frac{d\\mathbf{y}}{dr} = \\mathbf{A}(r)\\mathbf{y}$, suitable for numerical integration. This system describes the elastic-gravitational deformation throughout the planet's interior.\n\n### 2. Boundary Conditions\n\nTo solve the ODE system, boundary conditions must be imposed at the center and surface of the planet.\n1.  **Center ($r=0$)**: Physical regularity requires all fields to be finite. For degree $\\ell=2$, this imposes three constraints on the solution, ensuring that displacements and stresses vanish appropriately at the origin.\n2.  **Internal Interfaces ($r=r_i$)**: At any radius with a discontinuity in material properties ($\\rho, \\lambda, \\mu$), the state vector $\\mathbf{y}(r)$ must be continuous. This guarantees that displacement, traction, gravitational potential, and gravitational flux are conserved across the boundary.\n3.  **Free Surface ($r=R$)**:\n    *   **Traction-free**: The planet's surface is not subject to external mechanical forces, so the normal and shear tractions must be zero: $T_{rr}(R) = 0$ and $T_{r\\perp}(R) = 0$.\n    *   **Gravitational Matching**: The internal gravitational potential and its gradient must match the external solution, which includes the imposed tidal potential and the planet's induced response. This yields a third condition relating the potential-related state variables to the amplitude of the tidal potential, which ultimately allows for the calculation of the Love number $k_2$.\n\n### 3. Homogeneous Incompressible Sphere Approximation for $k_2$\n\nThe problem requires implementing a simplified analytical model rather than a full numerical integration. The classical result for the degree-2 tidal Love number $k_2$ for a homogeneous, incompressible elastic sphere is:\n$$ k_2 = \\frac{3/2}{1 + \\tilde{\\mu}} $$\nwhere $\\tilde{\\mu}$ is the dimensionless rigidity, defined as:\n$$ \\tilde{\\mu} = \\frac{19 \\mu}{2 \\rho g R} $$\nHere, $\\mu$ is the shear modulus, $\\rho$ is the density, $R$ is the planet's radius, and $g$ is the surface gravitational acceleration.\n\nThe program calculates the parameters for this model using volume-averaged properties from the input test cases. Since all test cases consist of a single homogeneous layer, these averages are trivial.\n*   **Mean Density ($\\bar{\\rho}$)**: This is the constant density of the single layer, $\\rho_c$.\n*   **Surface Gravity ($g$)**: This is calculated from the total mass $M = \\bar{\\rho} (\\frac{4}{3}\\pi R^3)$:\n    $$ g = \\frac{GM}{R^2} = \\frac{4}{3}\\pi G \\bar{\\rho} R $$\n*   **Effective Shear Modulus ($\\mu_{\\mathrm{eff}}$)**: For a single layer, this is simply $\\mu_{\\mathrm{eff}} = \\rho_c V_s^2$.\n\nSubstituting these into the formula for $\\tilde{\\mu}$ gives the expression used in the code. A crucial check is the fluid case (Case A), where $V_s=0$. This implies $\\mu_{\\mathrm{eff}}=0$ and $\\tilde{\\mu}=0$, which correctly yields $k_2 = 1.5$, the known value for a homogeneous fluid body.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the approximate degree-2 tidal Love number k2 for a set of\n    exoplanet test cases using the homogeneous incompressible-sphere model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (R, [(r_top, rho, Vs, Vp)], G)\n    # Since all cases are single-layer models, the layer list contains one tuple.\n    test_cases = [\n        # Case A (edge case: hydrostatic fluid body)\n        (3.0e6, [(3.0e6, 4000.0, 0.0, 5000.0)], 6.67430e-11),\n        # Case B (homogeneous elastic Earth-like)\n        (6.371e6, [(6.371e6, 5510.0, 4500.0, 8000.0)], 6.67430e-11),\n        # Case C (small rocky planet)\n        (2.0e6, [(2.0e6, 3500.0, 3000.0, 6000.0)], 6.67430e-11),\n        # Case D (very rigid super-Earth)\n        (1.0e7, [(1.0e7, 7000.0, 8000.0, 14000.0)], 6.67430e-11),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        R, layer_data, G = case\n        \n        # The problem provides piecewise-constant profiles.\n        # For all given test cases, the planet consists of a single homogeneous layer.\n        # Thus, mean density and effective shear modulus do not require integration.\n        # r_top, rho, Vs, Vp are constants throughout the body.\n        \n        # Extract properties for the single layer\n        r_top, rho, Vs, Vp = layer_data[0]\n\n        # Calculate effective parameters for the homogeneous model\n        \n        # 1. Mean density (bar_rho): For a single layer, it is the layer density.\n        bar_rho = rho\n        \n        # 2. Effective shear modulus (mu_eff): mu = rho * Vs^2\n        #    For a single layer, this is constant.\n        mu_eff = bar_rho * Vs**2\n        \n        # Handle the fluid case (Vs = 0)\n        if mu_eff == 0.0:\n            # For a fluid body, mu = 0, so dimensionless rigidity tilde_mu = 0.\n            # k2 = (3/2) / (1 + 0) = 1.5\n            k2 = 1.5\n            results.append(k2)\n            continue\n\n        # 3. Surface gravity (g): g = GM/R^2 = G * (4/3 * pi * R^3 * bar_rho) / R^2\n        g = (4.0 / 3.0) * np.pi * G * bar_rho * R\n        \n        # Calculate the dimensionless rigidity (tilde_mu)\n        # tilde_mu = (19 * mu_eff) / (2 * bar_rho * g * R)\n        tilde_mu = (19.0 * mu_eff) / (2.0 * bar_rho * g * R)\n        \n        # Calculate the degree-2 tidal Love number (k2) for an incompressible body\n        # k2 = (3/2) / (1 + tilde_mu)\n        k2 = 1.5 / (1.0 + tilde_mu)\n        \n        results.append(k2)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}