{
    "hands_on_practices": [
        {
            "introduction": "行星磁场能够在数十亿年的时间里持续存在，这提出了一个根本性的问题，因为若非如此，它们会因电阻而衰减。这项练习  直接探讨了这个问题，要求你计算磁扩散时间尺度，它代表了在没有流体运动的情况下，导电核心中磁场的自然寿命。通过对像水星这样的行星进行计算，你将对为何需要一个活跃的发电机机制来维持行星磁场有一个定量的理解。",
            "id": "4171009",
            "problem": "行星核中的导电流体根据磁流体动力学（MHD）感应方程演化其磁场，该方程包含一个平流项和一个以磁扩散率为特征的电阻（扩散）项。将水星的流体外核视为一个厚度为 $L$ 的球壳，其中大尺度磁场梯度的量级为 $L^{-1}$。从磁感应方程出发，使用量纲分析，推导壳层中磁场纯电阻演化的特征时间尺度。然后使用以下物理上合理的参数计算水星的这个时间尺度：电导率 $\\sigma = 1.0 \\times 10^{6}$ S m$^{-1}$，自由空间磁导率 $\\mu_{0} = 4 \\pi \\times 10^{-7}$ H m$^{-1}$，以及壳层厚度 $L = 5.0 \\times 10^{5}$ m。作为背景信息，十年尺度的长期变化对应的时间尺度约为10年，但你的最终输出应仅为扩散时间尺度。使用 $1$ 年 $= 3.154 \\times 10^{7}$ s 和 $1$ kyr $= 10^{3}$ 年。将最终数值答案四舍五入到三位有效数字，并以千年（kyr）为单位表示。",
            "solution": "该问题是有效的。其科学基础是磁流体动力学（MHD）的原理，问题提法恰当，数据充分且一致，并且表述客观。因此，我们可以开始解题。\n\n在运动的导电流体中，磁场 $\\mathbf{B}$ 的演化由MHD感应方程描述：\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{u} \\times \\mathbf{B}) + \\eta \\nabla^2 \\mathbf{B}\n$$\n这里，$\\mathbf{u}$ 是流体速度，$t$ 是时间，$\\eta$ 是磁扩散率。右边的第一项 $\\nabla \\times (\\mathbf{u} \\times \\mathbf{B})$ 表示流体流动对磁力线的平流和拉伸作用（发电机效应）。第二项 $\\eta \\nabla^2 \\mathbf{B}$ 表示由有限电阻引起的磁场耗散（电阻项或扩散项）。\n\n磁扩散率 $\\eta$ 定义为：\n$$\n\\eta = \\frac{1}{\\mu_0 \\sigma}\n$$\n其中 $\\mu_0$ 是自由空间磁导率，$\\sigma$ 是流体的电导率。\n\n问题要求的是*纯电阻演化*的特征时间尺度。这对应于流体静止的场景，即 $\\mathbf{u} = \\mathbf{0}$。在这种情况下，平流项消失，感应方程简化为磁扩散方程：\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = \\eta \\nabla^2 \\mathbf{B}\n$$\n为了找到特征时间尺度，我们对此方程进行量纲分析。令 $\\tau_d$ 为磁场发生显著变化的特征时间尺度，$L$ 为磁场变化的特征长度尺度，$B$ 为磁场的特征大小。\n\n我们可以用这些特征量的比率来近似偏导数。左侧（LHS）的时间导数的量级为：\n$$\n\\left| \\frac{\\partial \\mathbf{B}}{\\partial t} \\right| \\sim \\frac{B}{\\tau_d}\n$$\n拉普拉斯算子 $\\nabla^2$ 涉及二阶空间导数。由于问题陈述磁场梯度的量级为 $L^{-1}$，我们可以推断拉普拉斯算子的量级为 $L^{-2}$。因此，右侧（RHS）的扩散项的量级为：\n$$\n|\\eta \\nabla^2 \\mathbf{B}| \\sim \\eta \\frac{B}{L^2}\n$$\n为了使方程在量纲上保持一致，左侧和右侧的量级必须是相同的数量级：\n$$\n\\frac{B}{\\tau_d} \\sim \\eta \\frac{B}{L^2}\n$$\n求解时间尺度 $\\tau_d$，我们发现：\n$$\n\\tau_d \\sim \\frac{L^2}{\\eta}\n$$\n这就是特征磁扩散（或电阻）时间尺度。代入 $\\eta$ 的表达式，我们得到用给定物理参数表示的公式：\n$$\n\\tau_d = \\mu_0 \\sigma L^2\n$$\n现在，我们使用提供的数据计算水星核的数值：\n- 电导率, $\\sigma = 1.0 \\times 10^{6} \\, \\text{S m}^{-1}$\n- 自由空间磁导率, $\\mu_{0} = 4\\pi \\times 10^{-7} \\, \\text{H m}^{-1}$\n- 壳层厚度（特征长度尺度）, $L = 5.0 \\times 10^{5} \\, \\text{m}$\n\n将这些值代入 $\\tau_d$ 的表达式中：\n$$\n\\tau_d = (4\\pi \\times 10^{-7} \\, \\text{H m}^{-1}) (1.0 \\times 10^{6} \\, \\text{S m}^{-1}) (5.0 \\times 10^{5} \\, \\text{m})^2\n$$\n首先，我们计算常数与长度尺度平方的乘积：\n$$\n\\tau_d = (4\\pi \\times 10^{-1} \\, \\text{H} \\cdot \\text{S} \\cdot \\text{m}^{-2}) (2.5 \\times 10^{11} \\, \\text{m}^2)\n$$\n亨利（H）和西门子（S）的单位关系为 $\\text{H} \\cdot \\text{S} = (\\frac{\\text{V} \\cdot \\text{s}}{\\text{A}}) \\cdot (\\frac{\\text{A}}{\\text{V}}) = \\text{s}$。单位正确地解析为秒。\n$$\n\\tau_d = (4\\pi \\times 10^{-1}) (2.5 \\times 10^{11}) \\, \\text{s} = 10\\pi \\times 10^{10} \\, \\text{s} = \\pi \\times 10^{11} \\, \\text{s}\n$$\n使用数值 $\\pi \\approx 3.14159265$，我们得到：\n$$\n\\tau_d \\approx 3.14159265 \\times 10^{11} \\, \\text{s}\n$$\n问题要求最终答案以千年（kyr）为单位。我们使用给定的转换因子：\n- $1$ 年 $= 3.154 \\times 10^7$ s\n- $1$ 千年 $= 10^3$ 年 $= 1000$ 年\n\n首先，我们将秒转换为年：\n$$\n\\tau_d (\\text{以年为单位}) = \\frac{\\pi \\times 10^{11} \\, \\text{s}}{3.154 \\times 10^7 \\, \\text{s/year}} \\approx 9960.6615 \\, \\text{年}\n$$\n接下来，我们将年转换为千年：\n$$\n\\tau_d (\\text{以千年为单位}) = \\frac{9960.6615 \\, \\text{年}}{1000 \\, \\text{年/kyr}} \\approx 9.9606615 \\, \\text{kyr}\n$$\n最后，我们按照要求将结果四舍五入到三位有效数字：\n$$\n\\tau_d \\approx 9.96 \\, \\text{kyr}\n$$",
            "answer": "$$\n\\boxed{9.96}\n$$"
        },
        {
            "introduction": "一旦我们认识到发电机的必要性，下一步就是理解它是如何实际运作的。这项实践  深入发电机理论的核心，引导你构建一个运动学发电机模型，这是一种经典方法，其中流体速度场是预先设定的。你将构建并求解一个数值特征值问题，以确定磁场的增长率，从而直接检验给定的流场是否能维持一个发电机，并为这些系统的计算建模提供基础经验。",
            "id": "4170982",
            "problem": "您的任务是在球形导电行星中，为轴对称平均场模型构建并求解一个运动学发电机本征值问题。从磁流体动力学（MHD, Magnetohydrodynamics）的感应方程出发，假设运动学状态（即流场是预先给定的，没有洛伦兹力的反馈），并使用球对称的平均场来描述由 $\\alpha$ 效应表示的电动势（EMF, Electromotive Force）。目标是确定磁场增长率 $\\sigma$ 并评估几个测试案例中发电机是否能够自持。\n\n基本原理：\n- 运动学状态下的磁感应方程为 $\\partial \\mathbf{B}/\\partial t = \\nabla \\times (\\mathbf{u} \\times \\mathbf{B}) + \\eta \\nabla^2 \\mathbf{B}$，其中 $\\mathbf{B}$ 是磁场，$\\mathbf{u}$ 是预设的速度场，$\\eta$ 是磁扩散率。\n- 在各向同性、均匀、螺旋湍流的平均场理论中，湍流电动势可以表示为 $\\nabla \\times (\\alpha \\mathbf{B})$，其中 $\\alpha$ 效应为标量 $\\alpha(r)$，从而得到 $\\partial \\mathbf{B}/\\partial t = \\nabla \\times (\\alpha \\mathbf{B}) + \\eta \\nabla^2 \\mathbf{B}$。\n- 在球坐标系下使用轴对称的极向-环向分解，并对球谐函数进行分离（阶数为 $l$），从而得到关于极向标量 $S(r)$ 和环向标量 $G(r)$ 的耦合径向方程。\n\n您的任务：\n1. 从感应方程和轴对称的极向-环向分解出发，为类偶极模（$l \\in \\{1,2\\}$）构建耦合的一维径向本征值问题：\n   - 寻求形如 $\\mathbf{B}(\\mathbf{r},t) = \\Re\\{\\mathbf{b}(\\mathbf{r}) e^{\\sigma t}\\}$ 的模态解，这会得到本征问题 $\\sigma \\mathbf{b} = \\nabla \\times (\\alpha \\mathbf{b}) + \\eta \\nabla^2 \\mathbf{b}$。\n   - 使用轴对称场的标准矢量球谐函数表示，推导出在 $r \\in (0,R)$（其中 $R$ 是球体半径）内有效的耦合径向方程：\n     $$\\sigma S(r) = \\eta\\left(\\frac{d^2 S}{dr^2} - \\frac{l(l+1)}{r^2} S\\right) + \\alpha(r) G(r),$$\n     $$\\sigma G(r) = \\eta\\left(\\frac{d^2 G}{dr^2} - \\frac{l(l+1)}{r^2} G\\right) + \\alpha(r) \\frac{l(l+1)}{r^2} S(r),$$\n   - 对具有绝缘外部的完整导电球体施加物理上正确的边界条件：\n     - 内部在 $r=0$ 处的正则性条件：$S(r) \\sim r^{l+1}$ 和 $G(r) \\sim r^{l}$，这导致 Robin 型条件 $S'(0) - \\frac{l+1}{r} S(0) = 0$ 和 $G'(0) - \\frac{l}{r} G(0) = 0$。\n     - 外部在 $r=R$ 处的绝缘边界条件：$G(R) = 0$ 以及极向场与外部势场连续，给出 $S'(R) + \\frac{l+1}{R} S(R) = 0$。\n2. 对方程进行无量纲化，使用 $r \\mapsto \\hat{r} = r/R$, $t \\mapsto \\hat{t} = t \\eta / R^2$ 和 $\\alpha \\mapsto \\hat{\\alpha}(\\hat{r}) = \\alpha(r) R / \\eta$，因此本征值变为 $\\hat{\\sigma} = \\sigma R^2 / \\eta$。在这种无量纲形式下，\n   $$\\hat{\\sigma} S(\\hat{r}) = \\left(\\frac{d^2 S}{d \\hat{r}^2} - \\frac{l(l+1)}{\\hat{r}^2} S\\right) + \\hat{\\alpha}(\\hat{r}) G(\\hat{r}),$$\n   $$\\hat{\\sigma} G(\\hat{r}) = \\left(\\frac{d^2 G}{d \\hat{r}^2} - \\frac{l(l+1)}{\\hat{r}^2} G\\right) + \\hat{\\alpha}(\\hat{r}) \\frac{l(l+1)}{\\hat{r}^2} S(\\hat{r}),$$\n   其边界条件在 $\\hat{r}=0$ 和 $\\hat{r}=1$ 处如上所述，但 $R$ 被替换为 $1$。\n3. 在均匀的径向网格 $\\hat{r} \\in [\\hat{r}_{\\min},1]$ 上离散化无量纲问题，其中 $\\hat{r}_{\\min} > 0$ 是一个小数以避免在 $\\hat{r}=0$ 处的奇点，对内部点使用二阶中心有限差分，对边界导数条件使用二阶单边有限差分。使用 $\\hat{\\alpha}(\\hat{r}) = \\hat{\\alpha}_0 \\sin(\\pi \\hat{r})$ 以保持边界处的正则性。\n4. 将离散化后的问题组装成一个广义矩阵本征值问题 $\\mathbf{L}\\mathbf{x} = \\hat{\\sigma}\\, \\mathbf{M}\\mathbf{x}$，其中 $\\mathbf{x}$ 是网格上离散化的 $S$ 和 $G$ 的堆叠向量。通过用有限差分边界算子替换 $\\mathbf{L}$ 中的相应行，并将 $\\mathbf{M}$ 中的相应行设置为零来实现边界条件，这样边界约束就不依赖于 $\\hat{\\sigma}$。\n5. 数值求解该广义本征值问题，选取具有最大实部的本征值 $\\hat{\\sigma}_{\\max}$，并将其转换为有量纲的增长率 $\\sigma_{\\max} = \\hat{\\sigma}_{\\max} \\eta / R^2$（单位为 $\\mathrm{s^{-1}}$）。将发电机是否可自持定义为一个布尔值，如果 $\\sigma_{\\max} > 0$ 则为真，否则为假。\n\n物理和数值单位：\n- 所有最终增长率 $\\sigma_{\\max}$ 以 $\\mathrm{s^{-1}}$ 为单位表示。\n- 不涉及角度；不需要角度单位。\n- 不涉及百分比。\n\n测试套件：\n使用以下四个测试用例，每个用例指定为 $(l,\\ \\hat{\\alpha}_0,\\ R,\\ \\eta,\\ N)$，其中 $N$ 为网格点数，在 $\\hat{r} \\in [\\hat{r}_{\\min},1]$ 上均匀分布：\n- 用例 1 (顺利通过路径): $(1,\\ 20,\\ 2.0\\times 10^{6},\\ 1.0,\\ 200)$。\n- 用例 2 (更强的 $\\alpha$): $(1,\\ 40,\\ 2.0\\times 10^{6},\\ 1.0,\\ 200)$。\n- 用例 3 (扩散控制): $(1,\\ 0,\\ 2.0\\times 10^{6},\\ 1.0,\\ 200)$。\n- 用例 4 (更高阶): $(2,\\ 40,\\ 2.0\\times 10^{6},\\ 1.0,\\ 160)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。对于每个测试用例，输出有量纲的增长率（单位为 $\\mathrm{s^{-1}}$），紧随其后的是表示是否可自持的布尔值。因此，最终输出按四个测试用例的顺序包含八个条目：\n$[\\sigma_{\\max,1},\\ \\text{viable}_1,\\ \\sigma_{\\max,2},\\ \\text{viable}_2,\\ \\sigma_{\\max,3},\\ \\text{viable}_3,\\ \\sigma_{\\max,4},\\ \\text{viable}_4]$.",
            "solution": "用户提供了一个问题，要求为一个球形导电体构建并数值求解一个运动学发电机本征值问题。验证和求解过程如下。\n\n### 第 1 步：提取给定条件\n- **控制方程（平均场运动学发电机）：** $\\partial \\mathbf{B}/\\partial t = \\nabla \\times (\\alpha \\mathbf{B}) + \\eta \\nabla^2 \\mathbf{B}$，其中 $\\mathbf{B}$ 是磁场，$\\alpha(r)$ 是标量 $\\alpha$ 效应，$\\eta$ 是磁扩散率。\n- **本征问题构建：** 寻求模态解 $\\mathbf{B}(\\mathbf{r},t) = \\Re\\{\\mathbf{b}(\\mathbf{r}) e^{\\sigma t}\\}$ 导出本征值问题 $\\sigma \\mathbf{b} = \\nabla \\times (\\alpha \\mathbf{b}) + \\eta \\nabla^2 \\mathbf{b}$，其中本征值为 $\\sigma$。\n- **轴对称分解：** 对于给定的球谐函数阶数 $l$，场被分解为由标量 $S(r)$ 和 $G(r)$ 分别描述的极向和环向分量。\n- **耦合的径向方程（有量纲）：** 对于 $r \\in (0,R)$：\n  $$ \\sigma S(r) = \\eta\\left(\\frac{d^2 S}{dr^2} - \\frac{l(l+1)}{r^2} S\\right) + \\alpha(r) G(r) $$\n  $$ \\sigma G(r) = \\eta\\left(\\frac{d^2 G}{dr^2} - \\frac{l(l+1)}{r^2} G\\right) + \\alpha(r) \\frac{l(l+1)}{r^2} S(r) $$\n- **边界条件（有量纲）：**\n  - 内部正则性 ($r \\to 0$): $S'(r) - \\frac{l+1}{r} S(r) = 0$ 和 $G'(r) - \\frac{l}{r} G(r) = 0$。\n  - 外部绝缘边界 ($r=R$): $G(R) = 0$ 和 $S'(R) + \\frac{l+1}{R} S(R) = 0$。\n- **无量纲化：** 使用缩放因子 $r = \\hat{r}R$, $t = \\hat{t} R^2 / \\eta$, $\\alpha = \\hat{\\alpha} \\eta / R$, 以及 $\\sigma = \\hat{\\sigma} \\eta / R^2$，对于 $\\hat{r} \\in (0,1)$ 的无量纲方程为：\n  $$ \\hat{\\sigma} S(\\hat{r}) = \\left(\\frac{d^2 S}{d \\hat{r}^2} - \\frac{l(l+1)}{\\hat{r}^2} S\\right) + \\hat{\\alpha}(\\hat{r}) G(\\hat{r}) $$\n  $$ \\hat{\\sigma} G(\\hat{r}) = \\left(\\frac{d^2 G}{d \\hat{r}^2} - \\frac{l(l+1)}{\\hat{r}^2} G\\right) + \\hat{\\alpha}(\\hat{r}) \\frac{l(l+1)}{\\hat{r}^2} S(\\hat{r}) $$\n- **数值方法：**\n  - 在 $\\hat{r} \\in [\\hat{r}_{\\min}, 1]$ 的均匀网格上使用 $N$ 个点进行离散化，避免 $\\hat{r}=0$ 处的奇点。\n  - 对内部点使用二阶中心有限差分。\n  - 对边界条件使用二阶单边有限差分。\n  - alpha 效应剖面指定为 $\\hat{\\alpha}(\\hat{r}) = \\hat{\\alpha}_0 \\sin(\\pi \\hat{r})$。\n- **矩阵问题：** 组装成广义本征值问题 $\\mathbf{L}\\mathbf{x} = \\hat{\\sigma}\\, \\mathbf{M}\\mathbf{x}$，其中 $\\mathbf{x}$ 是离散化的 $S$ 和 $G$ 值的拼接向量。边界条件取代了边界节点处的微分方程。\n- **求解任务：** 对于每个测试用例，找到具有最大实部的本征值 $\\hat{\\sigma}_{\\max}$，将其转换为有量纲的增长率 $\\sigma_{\\max} = \\hat{\\sigma}_{\\max} \\eta / R^2$，并确定发电机是否可自持 ($\\sigma_{\\max} > 0$)。\n- **测试用例：**\n  1. $(l, \\hat{\\alpha}_0, R, \\eta, N) = (1, 20, 2.0\\times 10^{6}, 1.0, 200)$\n  2. $(l, \\hat{\\alpha}_0, R, \\eta, N) = (1, 40, 2.0\\times 10^{6}, 1.0, 200)$\n  3. $(l, \\hat{\\alpha}_0, R, \\eta, N) = (1, 0, 2.0\\times 10^{6}, 1.0, 200)$\n  4. $(l, \\hat{\\alpha}_0, R, \\eta, N) = (2, 40, 2.0\\times 10^{6}, 1.0, 160)$\n\n### 第 2 步：使用提取的给定条件进行验证\n- **科学基础：** 该问题牢固地植根于磁流体动力学和行星发电机理论。运动学平均场模型、$\\alpha^2$ 发电机机制、极向-环向分解以及指定的边界条件都是该领域中标准且成熟的形式化方法。\n- **适定性：** 该问题是一个具有齐次边界条件的常微分方程组的适定线性本征值问题。预计它将具有离散的本征谱，从而可以唯一地确定最大增长率。\n- **客观性：** 问题使用精确的数学语言和客观、可验证的参数进行陈述。不存在主观性或模糊性。\n- **缺陷分析：**\n  - 该问题在科学上是合理的，在数学上是一致的。\n  - 它可以被形式化为一个可解的数值问题。\n  - 提供了所有必要的数据和条件。关于网格起点 $\\hat{r}_{\\min}$ 的一个微小模糊之处可以通过一个标准的数值选择来解决：在 $[h, 1]$ 上定义一个网格，其中 $h$ 是网格间距，从而避免了 $\\hat{r}=0$ 处的坐标奇点。\n  - 物理参数对于行星科学应用是现实的。\n  - 问题结构清晰，能够导向唯一的解。\n  - 该问题并非微不足道，需要正确实现微分方程的数值方法。\n\n### 第 3 步：结论与行动\n该问题被判定为 **有效**。将按照指定的方法构建一个解决方案。\n\n### 解决方案\n\n任务的核心是将无量纲化的径向发电机方程离散化，并求解得到的矩阵本征值问题。\n\n**1. 离散化**\n我们在无量纲半径 $\\hat{r}$ 上定义一个包含 $N$ 个点的均匀径向网格。为避免 $\\hat{r}=0$ 处的奇点，网格点设置为 $\\hat{r}_i = (i+1)h$，其中 $i \\in \\{0, 1, \\dots, N-1\\}$，网格间距 $h=1/N$。该网格覆盖区间 $[h, 1]$。未知函数 $S(\\hat{r})$ 和 $G(\\hat{r})$ 由它们在这些网格点上的值 $S_i = S(\\hat{r}_i)$ 和 $G_i = G(\\hat{r}_i)$ 表示。\n\n状态向量 $\\mathbf{x}$ 通过拼接离散化的标量形成：\n$$ \\mathbf{x} = [S_0, S_1, \\dots, S_{N-1}, G_0, G_1, \\dots, G_{N-1}]^T $$\n这是一个大小为 $2N$ 的向量。\n\n**2. 有限差分算子**\n我们使用二阶有限差分近似来计算导数。\n对于内部点 $\\hat{r}_i$ ($1 \\le i \\le N-2$)：\n二阶导数由中心差分公式近似：\n$$ \\frac{d^2 f}{d\\hat{r}^2} \\bigg|_{\\hat{r}_i} \\approx \\frac{f_{i+1} - 2f_i + f_{i-1}}{h^2} $$\n对于边界条件，我们需要一阶导数的单边近似：\n- 在内边界 $\\hat{r}_0$ 处：$f'(\\hat{r}_0) \\approx \\frac{-3f_0 + 4f_1 - f_2}{2h}$ (二阶向前差分)。\n- 在外边界 $\\hat{r}_{N-1}$ 处：$f'(\\hat{r}_{N-1}) \\approx \\frac{3f_{N-1} - 4f_{N-2} + f_{N-3}}{2h}$ (二阶向后差分)。\n\n**3. 矩阵组装**\n离散化的系统被构建成广义本征值问题 $\\mathbf{L}\\mathbf{x} = \\hat{\\sigma}\\mathbf{M}\\mathbf{x}$。矩阵 $\\mathbf{L}$ 和 $\\mathbf{M}$ 的大小为 $2N \\times 2N$。\n\n- **矩阵 M：** 该矩阵分离出与本征值 $\\hat{\\sigma}$ 成比例的项。无量纲方程显示 $\\hat{\\sigma}$ 乘以 $S$ 和 $G$。对于微分方程成立的内部点，$\\mathbf{M}$ 的相应对角线元素为 $1$。对于边界点，方程被与 $\\hat{\\sigma}$无关的代数约束取代，因此 $\\mathbf{M}$ 的相应行为零。因此，$M_{i,i} = 1$ 对于 $i \\in \\{1,\\dots,N-2\\}$，$M_{N+i,N+i}=1$ 对于 $i \\in \\{1,\\dots,N-2\\}$，所有其他元素为零。\n\n- **矩阵 L：** 该矩阵表示空间微分算子和耦合项。\n  - **内部行 ($1 \\le i \\le N-2$)：**\n    - 第 $i$ 行对应于 $\\hat{r}_i$ 处的 $S$ 方程：\n      $$ L_{i,i-1} = \\frac{1}{h^2}, \\quad L_{i,i} = -\\frac{2}{h^2} - \\frac{l(l+1)}{\\hat{r}_i^2}, \\quad L_{i,i+1} = \\frac{1}{h^2}, \\quad L_{i,N+i} = \\hat{\\alpha}(\\hat{r}_i) $$\n    - 第 $(N+i)$ 行对应于 $\\hat{r}_i$ 处的 $G$ 方程：\n      $$ L_{N+i,N+i-1} = \\frac{1}{h^2}, \\quad L_{N+i,N+i} = -\\frac{2}{h^2} - \\frac{l(l+1)}{\\hat{r}_i^2}, \\quad L_{N+i,N+i+1} = \\frac{1}{h^2}, \\quad L_{N+i,i} = \\hat{\\alpha}(\\hat{r}_i)\\frac{l(l+1)}{\\hat{r}_i^2} $$\n  - **边界行：**\n    - **第 0 行 (S 的内边界条件)：** $S'(\\hat{r}_0) - \\frac{l+1}{\\hat{r}_0}S_0 = 0$ 被离散化为：\n      $$ \\left(-\\frac{3}{2h} - \\frac{l+1}{\\hat{r}_0}\\right)S_0 + \\left(\\frac{4}{2h}\\right)S_1 - \\left(\\frac{1}{2h}\\right)S_2 = 0 $$\n      这设置了系数 $L_{0,0}, L_{0,1}, L_{0,2}$。\n    - **第 N 行 (G 的内边界条件)：** $G'(\\hat{r}_0) - \\frac{l}{\\hat{r}_0}G_0=0$ 被离散化为：\n      $$ \\left(-\\frac{3}{2h} - \\frac{l}{\\hat{r}_0}\\right)G_0 + \\left(\\frac{4}{2h}\\right)G_1 - \\left(\\frac{1}{2h}\\right)G_2 = 0 $$\n      这设置了系数 $L_{N,N}, L_{N,N+1}, L_{N,N+2}$。\n    - **第 2N-1 行 (G 的外边界条件)：** $G(\\hat{r}_{N-1})=0$ 是一个简单的 Dirichlet 条件：\n      $$ G_{N-1} = 0 \\implies L_{2N-1, 2N-1} = 1 $$\n    - **第 N-1 行 (S 的外边界条件)：** $S'(\\hat{r}_{N-1}) + (l+1)S_{N-1}=0$ 被离散化为：\n      $$ \\left(\\frac{1}{2h}\\right)S_{N-3} - \\left(\\frac{4}{2h}\\right)S_{N-2} + \\left(\\frac{3}{2h} + l+1\\right)S_{N-1} = 0 $$\n      这设置了系数 $L_{N-1,N-3}, L_{N-1,N-2}, L_{N-1,N-1}$。\n\n**4. 求解与后处理**\n使用 `scipy.linalg.eig(L, M)` 求解广义本征值问题。由于矩阵 $\\mathbf{M}$ 是奇异的，求解器可能会产生无限大的本征值，这些本征值是非物理的，必须被过滤掉。在有限的本征值中，我们识别出具有最大实部的那个，即 $\\hat{\\sigma}_{\\max} = \\max(\\Re\\{\\hat{\\sigma}\\})$。然后将这个无量纲增长率转换为其有量纲形式：\n$$ \\sigma_{\\max} = \\hat{\\sigma}_{\\max} \\frac{\\eta}{R^2} $$\n如果发电机具有增长模式，即 $\\sigma_{\\max} > 0$，则认为它是可自持的。对每个测试用例评估此条件。$\\hat{\\alpha}_0=0$ 的情况作为一个验证检查，因为它代表纯磁扩散，必须只导致衰减模式 ($\\sigma_{\\max}  0$)。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Main function to run the dynamo simulation for all test cases.\n    \"\"\"\n\n    def solve_dynamo(l, alpha0, R, eta, N):\n        \"\"\"\n        Solves the kinematic dynamo eigenvalue problem for a given set of parameters.\n\n        Args:\n            l (int): Spherical harmonic degree.\n            alpha0 (float): Nondimensional amplitude of the alpha-effect.\n            R (float): Radius of the sphere in meters.\n            eta (float): Magnetic diffusivity in m^2/s.\n            N (int): Number of grid points.\n\n        Returns:\n            tuple: A tuple containing the maximum dimensional growth rate (sigma_max, in s^-1)\n                   and a boolean indicating dynamo viability.\n        \"\"\"\n        # 1. Grid and Parameter Setup (Nondimensional)\n        # Grid points r_i = (i+1)h for i=0..N-1. This spans [h, 1].\n        h = 1.0 / N\n        r_hat = (np.arange(N) + 1.0) * h\n\n        # Alpha-effect profile\n        alpha_hat = alpha0 * np.sin(np.pi * r_hat)\n\n        # 2. Matrix Assembly\n        dim = 2 * N\n        L = np.zeros((dim, dim), dtype=np.float64)\n        M = np.zeros((dim, dim), dtype=np.float64)\n\n        # Populate matrices for the interior points (i = 1 to N-2)\n        for i in range(1, N - 1):\n            r_i_sq = r_hat[i]**2\n            laplacian_diag_term = -2.0 / h**2 - l * (l + 1) / r_i_sq\n            \n            # Equation for S(r): row i\n            M[i, i] = 1.0\n            L[i, i - 1] = 1.0 / h**2\n            L[i, i] = laplacian_diag_term\n            L[i, i + 1] = 1.0 / h**2\n            L[i, N + i] = alpha_hat[i]\n            \n            # Equation for G(r): row N+i\n            M[N + i, N + i] = 1.0\n            L[N + i, N + i - 1] = 1.0 / h**2\n            L[N + i, N + i] = laplacian_diag_term\n            L[N + i, N + i + 1] = 1.0 / h**2\n            L[N + i, i] = alpha_hat[i] * l * (l + 1) / r_i_sq\n\n        # 3. Boundary Conditions\n        # Note: Rows of M corresponding to BCs remain zero.\n\n        # Inner BC at r_hat[0] = h (using 2nd order one-sided differences)\n        # S: S' - (l+1)/r * S = 0\n        L[0, 0] = -1.5 / h - (l + 1) / r_hat[0]\n        L[0, 1] = 2.0 / h\n        L[0, 2] = -0.5 / h\n\n        # G: G' - l/r * G = 0\n        L[N, N + 0] = -1.5 / h - l / r_hat[0]\n        L[N, N + 1] = 2.0 / h\n        L[N, N + 2] = -0.5 / h\n        \n        # Outer BC at r_hat[N-1] = 1 (using 2nd order one-sided differences)\n        # G: G_{N-1} = 0\n        L[2 * N - 1, 2 * N - 1] = 1.0\n\n        # S: S' + (l+1) * S = 0\n        L[N - 1, N - 1] = 1.5 / h + (l + 1)\n        L[N - 1, N - 2] = -2.0 / h\n        L[N - 1, N - 3] = 0.5 / h\n        \n        # 4. Solve the Generalized Eigenvalue Problem\n        # L x = sigma_hat * M x\n        # Use try-except to handle potential numerical errors with singular M\n        try:\n            eigenvalues, _ = linalg.eig(L, M)\n        except np.linalg.LinAlgError:\n            # This can happen if the problem is ill-conditioned, but unlikely here.\n            # A more robust solver might be needed in such cases.\n            return np.nan, False\n        \n        # Filter out non-finite eigenvalues (inf) which result from the singular M matrix\n        finite_eigs = eigenvalues[np.isfinite(eigenvalues)]\n        \n        if finite_eigs.size == 0:\n            # This indicates a severe numerical issue.\n            return np.nan, False\n\n        # Find the eigenvalue with the largest real part\n        sigma_hat_max_real = np.max(finite_eigs.real)\n        \n        # 5. Convert to Dimensional Growth Rate and Determine Viability\n        sigma_max = sigma_hat_max_real * eta / (R**2)\n        viable = sigma_max > 0\n        \n        return sigma_max, viable\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1, 20.0, 2.0e6, 1.0, 200),\n        (1, 40.0, 2.0e6, 1.0, 200),\n        (1, 0.0, 2.0e6, 1.0, 200),\n        (2, 40.0, 2.0e6, 1.0, 160),\n    ]\n\n    results = []\n    for case in test_cases:\n        l, alpha0, R, eta, N = case\n        sigma_max, viable = solve_dynamo(l, alpha0, R, eta, N)\n        # Format the numbers and booleans as strings for the final output\n        results.append(f\"{sigma_max:.6e}\")\n        results.append(str(viable))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "真实的行星发电机并非简单、稳定的系统；它们表现出复杂的、随时间变化的行为，最显著的是地质记录中记载的戏剧性极性反转。这项高级实践  介绍了一种强大的方法来模拟此类现象，它将复杂的磁流体动力学（MHD）方程简化为偶极子场振幅的随机微分方程。通过应用首次穿越时间理论，你将推导并计算反转之间的平均间隔，从而在抽象的发电机模型与可观测的古地磁数据之间建立起切实的联系。",
            "id": "4171043",
            "problem": "您将建立并分析一个用于全球磁场反转的降阶模型，该模型基于平均场 alpha–Omega (α–Ω) 发电机。分析重点是反转之间的平均间隔，并与古地磁基准进行验证。从磁流体动力学感应方程和平均场分解出发，推导出一个一维随机振幅方程，该方程能够捕捉超临界分岔附近的大尺度轴向偶极子动力学。然后，利用成熟的过阻尼朗之万动力学首达时理论，推导并实现一个公式，用于计算两个稳定极性状态之间由噪声驱动的跃迁（反转）的平均时间。最终的数值结果必须以百万年（Myr）为单位计算和报告，四舍五入到三位小数，并与提供的古地磁目标进行比较。\n\n从以下基础出发。\n\n1. 磁场 $\\mathbf{B}$ 的磁流体动力学感应方程，其中速度场为 $\\mathbf{U}$，磁扩散率为 $\\eta$：\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{U} \\times \\mathbf{B}) + \\eta \\nabla^2 \\mathbf{B}.\n$$\n\n2. 具有雷诺平均和尺度分离的平均场分解，引入湍流电动势 $\\boldsymbol{\\mathcal{E}}$：\n$$\n\\frac{\\partial \\langle \\mathbf{B} \\rangle}{\\partial t} = \\nabla \\times \\left(\\langle \\mathbf{U} \\rangle \\times \\langle \\mathbf{B} \\rangle + \\boldsymbol{\\mathcal{E}} \\right) + \\eta \\nabla^2 \\langle \\mathbf{B} \\rangle, \\quad \\boldsymbol{\\mathcal{E}} \\approx \\alpha \\langle \\mathbf{B} \\rangle - \\beta_t \\nabla \\times \\langle \\mathbf{B} \\rangle,\n$$\n其中 $\\alpha$ 是代表 α 效应（螺旋相关性）的伪标量，$\\beta_t$ 是湍流磁扩散率。在 α–Ω 发电机中，大尺度剪切 $\\Omega$ 耦合了极向和环向场分量。\n\n3. 在发电机效应起始点附近，轴向偶极子振幅 $A(t)$ 的动力学可以通过一个具有三次饱和的超临界叉式分岔的范式来捕捉，该范式受到代表 $\\alpha$ 和流场变化的涨落影响。这启发我们建立一个带加性高斯白噪声（强度为 $\\sigma$）的一维随机微分方程（SDE）：\n$$\n\\mathrm{d}A = \\left(\\mu A - \\beta A^3\\right)\\,\\mathrm{d}t + \\sigma\\, \\mathrm{d}W_t,\n$$\n其中 $\\mu  0$ 衡量净超临界度（与结合了 $\\alpha$ 和 $\\Omega$ 效应的无量纲发电机数成正比），$\\beta  0$ 是一个非线性饱和系数，而 $W_t$ 是一个维纳过程。\n\n您的任务如下。\n\na) 仅使用上述基本原理，论证为什么该随机振幅方程可以写成双势阱 $V(A)$ 中的过阻尼朗之万动力学形式，并确定 $V(A)$（可相差一个加性常数）。请仔细说明 SDE 与势梯度流之间的对应关系。\n\nb) 使用经典首达时理论处理光滑双势阱中的过阻尼朗之万运动，从第一性原理出发，推导出一个关于符号反转（两个稳定极小值之间的跃迁）平均时间的解析表达式。该表达式应以 $\\mu$、$\\beta$ 和 $\\sigma$ 表示，并包含一个指定的基础时间尺度 $t_0$，用于将无量纲时间转换为以百万年（Myr）为单位的物理时间。您必须假设系统处于存在两个稳定平衡点且被一个鞍点隔开的区域。您的推导必须明确势垒高度以及在极小值点和鞍点处的相关曲率。\n\nc) 实现一个完整且可运行的程序，使用您推导的表达式计算下面每个参数集的平均反转间隔（以 Myr 为单位）。为与古地磁记录进行验证，计算模型预测与给定的目标平均反转间隔之间的绝对差，并报告该差值是否小于或等于给定的容差。\n\n实现要求。\n\n- 必须使用在 (b) 部分推导的解析表达式；不要进行直接的随机模拟。\n- 如果参数不能产生双稳态双势阱（例如，如果 $\\mu \\le 0$ 或 $\\beta \\le 0$），则预测的平均值返回浮点类型的“非数值”（Not-a-Number），并在比较中报告为“不在容差范围内”。\n- 所有最终报告的时间值都必须以 Myr 为单位，并四舍五入到三位小数。\n- 程序必须是确定性的，并且不需要任何输入。\n\n测试套件。\n\n计算以下三种情况的结果，每种情况都由 $(\\mu,\\beta,\\sigma,t_0)$ 以及古地磁目标平均值和绝对容差指定，所有时间单位均为 Myr。\n\n- 情况 1 (中等噪声，频繁反转)：$\\mu = 30.0$, $\\beta = 1.0$, $\\sigma = 20.2$, $t_0 = 1.0$, 目标值 $= 0.45$, 容差 $= 0.10$。\n- 情况 2 (较弱驱动，中等频率反转)：$\\mu = 15.0$, $\\beta = 1.0$, $\\sigma = 10.0$, $t_0 = 1.0$, 目标值 $= 0.90$, 容差 $= 0.15$。\n- 情况 3 (强稳定，罕见反转)：$\\mu = 10.0$, $\\beta = 1.0$, $\\sigma = 3.0$, $t_0 = 1.0$, 目标值 $= 100.0$, 容差 $= 30.0$。\n\n最终输出格式。\n\n您的程序应生成单行输出，其中包含所有结果，形式为一个用方括号括起来的逗号分隔列表。对于每种情况，按顺序输出一个三元组，包括：\n- 预测的平均反转间隔（以 Myr 为单位，四舍五入到三位小数），\n- 与目标的绝对差（以 Myr 为单位，四舍五入到三位小数），\n- 一个布尔值，表示绝对差是否小于或等于容差。\n\n因此，输出列表包含按顺序展开的 3 个元组，总共产生 9 个条目，例如 $[x_1,\\Delta_1,b_1,x_2,\\Delta_2,b_2,x_3,\\Delta_3,b_3]$，其中每个 $x_i$ 和 $\\Delta_i$ 是四舍五入到三位小数的浮点数，每个 $b_i$ 是一个布尔值。",
            "solution": "该问题陈述经评估具有科学依据，定义明确，客观且完整。这是理论行星物理学中的一个有效问题。\n\n**a) 双势阱的识别**\n\n给定的轴向偶极子振幅 $A(t)$ 的随机微分方程 (SDE) 是：\n$$\n\\mathrm{d}A = \\left(\\mu A - \\beta A^3\\right)\\,\\mathrm{d}t + \\sigma\\, \\mathrm{d}W_t\n$$\n这个方程是过阻尼朗之万方程的一个典型例子，它描述了一个粒子在势 $V(A)$ 中受到确定性力 $F(A)$ 和随机力项作用下的运动。其一般形式为：\n$$\n\\mathrm{d}A = F(A)\\,\\mathrm{d}t + \\sigma\\, \\mathrm{d}W_t\n$$\n在梯度系统中，确定性力由势导出，即 $F(A) = -\\frac{\\mathrm{d}V}{\\mathrm{d}A}$。\n\n通过比较这两个方程，我们确定确定性力分量为：\n$$\nF(A) = \\mu A - \\beta A^3\n$$\n为了找到势 $V(A)$，我们必须对力的负值进行关于 $A$ 的积分：\n$$\nV(A) = - \\int F(A) \\, \\mathrm{d}A = - \\int \\left(\\mu A - \\beta A^3\\right) \\, \\mathrm{d}A\n$$\n执行积分得到：\n$$\nV(A) = -\\left(\\frac{1}{2}\\mu A^2 - \\frac{1}{4}\\beta A^4\\right) + C_0\n$$\n其中 $C_0$ 是一个任意的积分常数。不失一般性，我们可以设 $C_0 = 0$，因为它只在垂直方向上移动势，而不影响动力学。因此，势为：\n$$\nV(A) = \\frac{1}{4}\\beta A^4 - \\frac{1}{2}\\mu A^2\n$$\n为了证明这代表一个双势阱，我们必须通过将其一阶导数（力）设为零来找到其极值点：\n$$\n\\frac{\\mathrm{d}V}{\\mathrm{d}A} = \\beta A^3 - \\mu A = A(\\beta A^2 - \\mu) = 0\n$$\n问题指明系统处于超临界分岔附近，这意味着 $\\mu  0$，并且存在非线性饱和，这意味着 $\\beta  0$。在这些条件下，不动点（极值点）为：\n$$\nA_0 = 0 \\quad \\text{and} \\quad A_{\\pm} = \\pm\\sqrt{\\frac{\\mu}{\\beta}}\n$$\n为了确定这些点的稳定性，我们检查势的二阶导数 $V''(A)$：\n$$\nV''(A) = \\frac{\\mathrm{d}^2V}{\\mathrm{d}A^2} = 3\\beta A^2 - \\mu\n$$\n在 $A = A_0 = 0$ 处，曲率为 $V''(0) = -\\mu$。由于 $\\mu  0$，该值为负，表明 $A_0 = 0$ 是一个局部极大值。这对应于确定性动力学的一个不稳定不动点。\n\n在 $A = A_{\\pm} = \\pm\\sqrt{\\mu/\\beta}$ 处，曲率为：\n$$\nV''\\left(\\pm\\sqrt{\\frac{\\mu}{\\beta}}\\right) = 3\\beta\\left(\\frac{\\mu}{\\beta}\\right) - \\mu = 3\\mu - \\mu = 2\\mu\n$$\n由于 $\\mu  0$，该值为正，表明 $A_{\\pm}$ 是局部极小值。这对应于确定性动力学的两个稳定不动点，代表两个稳定的磁极性状态。\n\n两个极小值（$A_{\\pm}$）被一个极大值（$A_0$）隔开的存在，证实了对于 $\\mu  0$ 和 $\\beta  0$，$V(A)$ 是一个双势阱。磁场反转是这两个势阱之间由噪声驱动的跃迁。\n\n**b) 平均反转间隔的推导**\n\n在噪声驱动下，粒子从一个势阱越过势垒逃逸的平均时间由克莱默斯逃逸率理论描述。在过阻尼极限下，对于由 $\\mathrm{d}A = -\\frac{\\mathrm{d}V}{\\mathrm{d}A}\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_t$ 描述的系统，从一个极小值 $A_{min}$ 越过一个鞍点 $A_{saddle}$ 逃逸的平均首达时（MFPT）$\\tau$ 由阿伦尼乌斯型公式给出：\n$$\n\\tau = \\frac{2\\pi}{\\sqrt{|V''(A_{saddle})| V''(A_{min})}} \\exp\\left(\\frac{2\\,\\Delta V}{\\sigma^2}\\right)\n$$\n这里，$\\Delta V = V(A_{saddle}) - V(A_{min})$ 是势垒的高度。一些文献用扩散系数 $D=\\sigma^2/2$ 来定义 SDE，在这种情况下，指数的参数是 $\\Delta V/D$。\n\n从 (a) 部分，我们拥有所有必要的组成部分：\n1.  稳定极小值位于 $A_{min} = \\pm\\sqrt{\\mu/\\beta}$。由于对称性，我们可以选择正根进行计算：$A_{min} = \\sqrt{\\mu/\\beta}$。\n2.  鞍点位于 $A_{saddle} = 0$。\n3.  这些点的势值为：\n    $$\n    V(A_{saddle}) = V(0) = 0\n    $$\n    $$\n    V(A_{min}) = V\\left(\\sqrt{\\frac{\\mu}{\\beta}}\\right) = \\frac{1}{4}\\beta\\left(\\frac{\\mu}{\\beta}\\right)^2 - \\frac{1}{2}\\mu\\left(\\frac{\\mu}{\\beta}\\right) = \\frac{\\mu^2}{4\\beta} - \\frac{\\mu^2}{2\\beta} = -\\frac{\\mu^2}{4\\beta}\n    $$\n4.  因此，势垒高度 $\\Delta V$ 为：\n    $$\n    \\Delta V = V(A_{saddle}) - V(A_{min}) = 0 - \\left(-\\frac{\\mu^2}{4\\beta}\\right) = \\frac{\\mu^2}{4\\beta}\n    $$\n5.  这些点上的曲率（二阶导数）为：\n    $$\n    V''(A_{min}) = V''\\left(\\sqrt{\\frac{\\mu}{\\beta}}\\right) = 2\\mu\n    $$\n    $$\n    V''(A_{saddle}) = V''(0) = -\\mu \\implies |V''(A_{saddle})| = \\mu\n    $$\n\n现在，我们将这些量代入 MFPT 公式：\n$$\n\\tau = \\frac{2\\pi}{\\sqrt{(\\mu)(2\\mu)}} \\exp\\left(\\frac{2(\\mu^2/4\\beta)}{\\sigma^2}\\right)\n$$\n$$\n\\tau = \\frac{2\\pi}{\\sqrt{2\\mu^2}} \\exp\\left(\\frac{\\mu^2}{2\\beta\\sigma^2}\\right)\n$$\n$$\n\\tau = \\frac{2\\pi}{\\mu\\sqrt{2}} \\exp\\left(\\frac{\\mu^2}{2\\beta\\sigma^2}\\right) = \\frac{\\pi\\sqrt{2}}{\\mu} \\exp\\left(\\frac{\\mu^2}{2\\beta\\sigma^2}\\right)\n$$\n这个表达式给出了以无量纲时间单位表示的平均反转间隔 $\\tau$。为了将其转换为以百万年（Myr）为单位的物理时间 $T$，我们乘以所提供的基础时间尺度 $t_0$（单位为 Myr）：\n$$\nT = t_0 \\cdot \\tau = t_0 \\frac{\\pi\\sqrt{2}}{\\mu} \\exp\\left(\\frac{\\mu^2}{2\\beta\\sigma^2}\\right)\n$$\n这是最终要实现的解析表达式。\n\n**c) 实现**\n\n推导出的平均反转间隔 $T$ 的公式将在一个 Python 程序中实现。该程序将首先验证每个测试用例的参数，以确保 $\\mu  0$ 和 $\\beta  0$，因为双势阱结构依赖于这些条件。如果不满足这些条件，结果将按要求为非数值（NaN）。否则，程序将计算 $T$，计算与古地磁目标的绝对差，并评估容差条件。结果将按指定要求四舍五入并格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the mean magnetic field reversal interval for a stochastic dynamo model\n    and validates it against paleomagnetic targets.\n    \"\"\"\n    # Test cases: (mu, beta, sigma, t0, target_mean_myr, tolerance_myr)\n    test_cases = [\n        # Case 1 (moderate noise, frequent reversals)\n        (30.0, 1.0, 20.2, 1.0, 0.45, 0.10),\n        # Case 2 (weaker driving, intermediate reversals)\n        (15.0, 1.0, 10.0, 1.0, 0.90, 0.15),\n        # Case 3 (strongly stable, rare reversals)\n        (10.0, 1.0, 3.0, 1.0, 100.0, 30.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        mu, beta, sigma, t0, target, tolerance = case\n\n        # Validate parameters: mu and beta must be positive for a bistable double-well potential.\n        if mu = 0 or beta = 0:\n            predicted_mean = float('nan')\n            abs_diff = float('nan')\n            is_within_tolerance = False\n        else:\n            # Calculate the mean reversal interval T using the derived analytical formula:\n            # T = t0 * (pi * sqrt(2) / mu) * exp(mu^2 / (2 * beta * sigma^2))\n            \n            try:\n                prefactor = (np.pi * np.sqrt(2)) / mu\n                exponent = (mu**2) / (2 * beta * sigma**2)\n                \n                # Check for overflow in exp, though unlikely with given parameters.\n                if exponent > np.log(np.finfo(float).max):\n                     predicted_mean_raw = float('inf')\n                else:\n                     predicted_mean_raw = t0 * prefactor * np.exp(exponent)\n\n                # Round the final results to three decimal places.\n                predicted_mean = round(predicted_mean_raw, 3)\n                \n                # Calculate absolute difference and check against tolerance.\n                abs_diff_raw = abs(predicted_mean_raw - target)\n                abs_diff = round(abs_diff_raw, 3)\n                is_within_tolerance = (abs_diff_raw = tolerance)\n\n            except (ValueError, ZeroDivisionError):\n                # Catch potential math errors, e.g., if sigma is zero.\n                predicted_mean = float('nan')\n                abs_diff = float('nan')\n                is_within_tolerance = False\n        \n        results.extend([predicted_mean, abs_diff, is_within_tolerance])\n\n    # Format the final output string as a comma-separated list in brackets.\n    # The str() conversion for booleans produces 'True'/'False' as required.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}