{
    "hands_on_practices": [
        {
            "introduction": "碰撞诱导吸收（CIA）的强度从根本上取决于分子碰撞的频率。本练习将定量地探讨这一关系，阐明在双体碰撞近似下CIA不透明度与数密度平方（$n^2$）成正比的基本原理。进而，本练习将引入更高密度下变得重要的多体效应概念，解释其如何导致偏离这种简单的标度关系，这对于理解CIA如何随行星大气中的压力（即海拔高度）变化至关重要。",
            "id": "4156762",
            "problem": "一颗以氢为主的大气层的系外行星表现出碰撞诱导吸收（Collision-Induced Absorption, CIA）。考虑波数为 $\\tilde{\\nu} = 1000\\ \\mathrm{cm}^{-1}$、温度为 $T = 1000\\ \\mathrm{K}$ 的一个窄光谱区间，在该区间内，CIA响应可以很好地用吸收系数的密度维里展开来描述。设某个参考高度上的数密度为 $n_{0} = 1.0 \\times 10^{26}\\ \\mathrm{m}^{-3}$，并假设大气被压缩，使得数密度加倍至 $2 n_{0}$。在此区间内，吸收系数可以展开为数密度的幂级数，其中主要贡献来自双体碰撞，下一级修正是多体（饱和或屏蔽）效应。在 $(\\tilde{\\nu}, T)$ 处，相应的第二和第三密度维里系数分别为 $B_{2} = 3.00 \\times 10^{-52}\\ \\mathrm{m}^{5}$ 和 $B_{3} = -7.50 \\times 10^{-79}\\ \\mathrm{m}^{8}$。\n\n从均匀介质中吸收的基本定义和适用于稠密气体的维里展开出发，推导当截断至 $n$ 的三阶项时，CIA吸收系数 $\\alpha(\\tilde{\\nu}, T, n)$ 如何随数密度 $n$ 变化。根据这种密度标度关系，在以下两种模型假设下，确定不透明度的乘法变化，该变化定义为比率 $\\alpha(2 n_{0}) / \\alpha(n_{0})$：\n\n- 双体碰撞近似（通过将三阶项设为零来忽略多体以及饱和或屏蔽效应）。\n- 包含由给定的负值 $B_{3}$ 表征的主要多体修正。\n\n将两个比率以无量纲数的形式给出，并将您的答案四舍五入至四位有效数字。最终比率中不包含单位。在您的推导中解释，在什么条件下双体近似会产生四倍的增加，以及为什么在本例中饱和或屏蔽效应会减弱这种标度关系。",
            "solution": "该问题要求推导碰撞诱导吸收（CIA）系数 $\\alpha$ 的密度标度关系，并计算在两种不同的物理近似下，该系数在两个不同数密度 $n_{0}$ 和 $2n_{0}$ 处的比值。\n\n提供的基本关系是吸收系数 $\\alpha$ 作为数密度 $n$ 的函数在给定波数 $\\tilde{\\nu}$ 和温度 $T$ 下的维里展开。对于稠密气体，该关系式为：\n$$\n\\alpha(\\tilde{\\nu}, T, n) = B_{2}(\\tilde{\\nu}, T) n^{2} + B_{3}(\\tilde{\\nu}, T) n^{3} + \\mathcal{O}(n^{4})\n$$\n其中 $B_{2}$ 是第二密度维里系数，解释了双体碰撞；$B_{3}$ 是第三密度维里系数，解释了三体相互作用（多体效应）。对于吸收必须通过碰撞发生的气体，与 $n^{2}$ 成正比的项是主要贡献，氢为主的大气层中的CIA就是这种情况（像 $\\mathrm{H}_{2}$ 这样的同核双原子分子没有永久偶极矩，因此没有单分子的转动-振动光谱）。为简洁起见，由于 $\\tilde{\\nu}$ 和 $T$ 是固定的，我们将写作 $\\alpha(n)$。题目指定将级数截断至三阶项，因此我们使用：\n$$\n\\alpha(n) \\approx B_{2} n^{2} + B_{3} n^{3}\n$$\n在 $\\tilde{\\nu} = 1000\\ \\mathrm{cm}^{-1}$ 和 $T = 1000\\ \\mathrm{K}$ 下给定的值为：\n-   参考数密度：$n_{0} = 1.0 \\times 10^{26}\\ \\mathrm{m}^{-3}$\n-   第二维里系数：$B_{2} = 3.00 \\times 10^{-52}\\ \\mathrm{m}^{5}$\n-   第三维里系数：$B_{3} = -7.50 \\times 10^{-79}\\ \\mathrm{m}^{8}$\n\n我们被要求在两种情况下计算不透明度的乘法变化，即比率 $\\alpha(2n_{0}) / \\alpha(n_{0})$。\n\n**情况1：双体碰撞近似**\n\n在此近似中，我们忽略多体效应，这意味着我们将第三维里系数 $B_{3}$ 及所有更高阶的系数设为零。吸收系数（我们记作 $\\alpha_{\\mathrm{bin}}(n)$）仅依赖于双体碰撞：\n$$\n\\alpha_{\\mathrm{bin}}(n) = B_{2} n^{2}\n$$\n在参考密度 $n_{0}$ 处的吸收系数为 $\\alpha_{\\mathrm{bin}}(n_{0}) = B_{2} n_{0}^{2}$。\n当密度加倍至 $2n_{0}$ 时，新的吸收系数为 $\\alpha_{\\mathrm{bin}}(2n_{0}) = B_{2} (2n_{0})^{2} = 4 B_{2} n_{0}^{2}$。\n\n然后计算比率为：\n$$\n\\frac{\\alpha_{\\mathrm{bin}}(2n_{0})}{\\alpha_{\\mathrm{bin}}(n_{0})} = \\frac{4 B_{2} n_{0}^{2}}{B_{2} n_{0}^{2}} = 4\n$$\n在双体碰撞近似下，数密度加倍会使吸收系数精确增加 4 倍。按要求表示为四位有效数字，此比率为 $4.000$。\n\n这种 $n^{2}$ 依赖关系的物理原因是吸收过程需要两个粒子之间的碰撞。在单一物种的气体中，此类碰撞的速率与粒子对的数量成正比，对于体积 $V$ 而言，其标度关系为 $\\binom{n V}{2} \\propto (nV)^{2}$。因此，碰撞的速率密度与 $n^{2}$ 成标度关系。将数密度加倍会使双体碰撞的速率增加四倍，从而使吸收增加四倍。\n\n**情况2：包含主要的多体修正**\n\n在这种情况下，我们使用截断至三阶项并包含非零 $B_{3}$ 的模型：\n$$\n\\alpha(n) = B_{2} n^{2} + B_{3} n^{3}\n$$\n在参考密度 $n_{0}$ 处的吸收系数为：\n$$\n\\alpha(n_{0}) = B_{2} n_{0}^{2} + B_{3} n_{0}^{3}\n$$\n在加倍的密度 $2n_{0}$ 处，吸收系数为：\n$$\n\\alpha(2n_{0}) = B_{2} (2n_{0})^{2} + B_{3} (2n_{0})^{3} = 4 B_{2} n_{0}^{2} + 8 B_{3} n_{0}^{3}\n$$\n吸收系数的比率为：\n$$\n\\frac{\\alpha(2n_{0})}{\\alpha(n_{0})} = \\frac{4 B_{2} n_{0}^{2} + 8 B_{3} n_{0}^{3}}{B_{2} n_{0}^{2} + B_{3} n_{0}^{3}}\n$$\n我们可以从分子和分母中提出 $n_{0}^{2}$：\n$$\n\\frac{\\alpha(2n_{0})}{\\alpha(n_{0})} = \\frac{n_{0}^{2} (4 B_{2} + 8 B_{3} n_{0})}{n_{0}^{2} (B_{2} + B_{3} n_{0})} = \\frac{4 B_{2} + 8 B_{3} n_{0}}{B_{2} + B_{3} n_{0}}\n$$\n现在我们代入给定的数值：\n$n_{0} = 1.0 \\times 10^{26}\\ \\mathrm{m}^{-3}$\n$B_{2} = 3.00 \\times 10^{-52}\\ \\mathrm{m}^{5}$\n$B_{3} = -7.50 \\times 10^{-79}\\ \\mathrm{m}^{8}$\n\n首先，我们计算 $B_{3} n_{0}$ 项：\n$$\nB_{3} n_{0} = (-7.50 \\times 10^{-79}\\ \\mathrm{m}^{8}) \\times (1.0 \\times 10^{26}\\ \\mathrm{m}^{-3}) = -7.50 \\times 10^{-53}\\ \\mathrm{m}^{5}\n$$\n现在，我们计算比率的分子和分母。\n分子：\n$$\n4 B_{2} + 8 B_{3} n_{0} = 4(3.00 \\times 10^{-52}) + 8(-7.50 \\times 10^{-53}) = 12.00 \\times 10^{-52} - 60.0 \\times 10^{-53} = 12.00 \\times 10^{-52} - 6.00 \\times 10^{-52} = 6.00 \\times 10^{-52}\\ \\mathrm{m}^{5}\n$$\n分母：\n$$\nB_{2} + B_{3} n_{0} = 3.00 \\times 10^{-52} + (-7.50 \\times 10^{-53}) = 3.00 \\times 10^{-52} - 0.75 \\times 10^{-52} = 2.25 \\times 10^{-52}\\ \\mathrm{m}^{5}\n$$\n比率为：\n$$\n\\frac{\\alpha(2n_{0})}{\\alpha(n_{0})} = \\frac{6.00 \\times 10^{-52}}{2.25 \\times 10^{-52}} = \\frac{6.00}{2.25} = \\frac{8}{3}\n$$\n作为小数，这是 $2.6666...$。四舍五入到四位有效数字得到 $2.667$。\n\n包含 $B_{3}$ 项会使标度因子减小到4以下，其原因在于 $B_3$ 的负号。负的 $B_{3}$ 代表了“饱和”或“屏蔽”效应。$B_{3}n^{3}$ 项模拟了第三个粒子对双体碰撞的影响。负值意味着在碰撞对附近存在第三个粒子会干扰诱导偶极矩，从而相对于简单的独立双体碰撞之和所预期的吸收量有所减少。随着密度增加，三体相遇的概率（与 $n^{3}$ 成标度关系）比双体相遇的概率（与 $n^{2}$ 成标度关系）增长得更快。因此，在更高密度下，这种负的高阶修正变得更为显著，导致总吸收的增长速度慢于 $n^{2}$。这抑制了不透明度的整体增加，导致乘法因子小于理想双体碰撞情况下的值 $4$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 4.000  2.667 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在探讨了吸收的“强度”之后，本练习将焦点转移到吸收的“形状”。通过本练习，你将在微观的分子碰撞世界与宏观的CIA光谱形态之间建立联系。通过对碰撞持续时间进行建模，你将推导出CIA特征的典型宽度如何与大气温度相关联，从而为CIA为何产生平滑的连续谱而非尖锐的谱线提供物理依据。",
            "id": "4156753",
            "problem": "考虑一个稠密的、以氢为主的系外行星大气层，其中的碰撞诱导吸收（CIA）源于双体碰撞过程中的瞬时偶极子。假设感应偶极矩自相关函数可以建模为指数衰减，$C(t)=C(0)\\exp(-t/\\tau)$，其中 $\\tau$ 是由平均碰撞间隔时间决定的相关时间。当指数衰减模型适用时，作为线性频率 $\\nu$（单位为赫兹）的函数的谱线形状与 $C(t)$ 的傅里叶变换成正比，并呈现洛伦兹线型。\n\n从气体动理论和时间相关光谱学的第一性原理出发，完成以下任务：\n\n1. 从指数自相关函数 $C(t)$ 出发，推导洛伦兹谱线形状，并确定半峰全宽（FWHM），记为 $\\Delta \\nu_{\\mathrm{FWHM}}$，用相关时间 $\\tau$ 和线性频率 $\\nu$（单位为赫兹）表示。给出 $\\Delta \\nu_{\\mathrm{FWHM}}(\\tau)$ 的表达式。\n\n2. 使用气体动理论，将相关时间估算为平均碰撞间隔时间，$\\tau \\approx 1/(n\\,\\sigma\\,\\bar{v}_{\\mathrm{rel}})$，其中 $n$ 是数密度，$\\sigma$ 是有效碰撞截面，$\\bar{v}_{\\mathrm{rel}}$ 是在温度 $T$ 下从麦克斯韦-玻尔兹曼分布中抽取的两个质量为 $m$ 的相同分子的平均相对速率。用 $k_{B}$、$T$ 和 $m$ 推导 $\\bar{v}_{\\mathrm{rel}}$，然后用 $n$、$\\sigma$、$k_{B}$、$T$ 和 $m$ 表示 $\\tau$。\n\n3. 结合你的结果，得到CIA谱线宽度 $\\Delta \\nu_{\\mathrm{FWHM}}(T)$ 作为 $n$、$\\sigma$、$k_{B}$、$T$ 和 $m$ 的函数的闭合形式解析表达式。明确指出并论证其温度依赖性，以及 $\\bar{v}\\propto \\sqrt{T}$ 如何影响该宽度。\n\n你的最终答案 $\\Delta \\nu_{\\mathrm{FWHM}}(T)$ 需以赫兹（Hz）为单位表示。题目未提供数值；请给出一个单一的闭合形式解析表达式。无需进行四舍五入。",
            "solution": "**第1部分：洛伦兹谱线形状和FWHM的推导**\n\n我们记为 $I(\\omega)$ 的谱线形状与偶极矩自相关函数 $C(t)$ 的傅里叶变换成正比。问题陈述了当 $t \\geq 0$ 时，$C(t) = C(0)\\exp(-t/\\tau)$。物理上的自相关函数必须是时间的偶函数，即 $C(t) = C(-t)$，因此我们将其建模为 $C(t) = C(0)\\exp(-|t|/\\tau)$。谱线形状由关于角频率 $\\omega = 2\\pi\\nu$ 的傅里叶变换给出：\n$$I(\\omega) \\propto \\int_{-\\infty}^{\\infty} C(t) e^{-i\\omega t} dt$$\n代入 $C(t)$ 的表达式：\n$$I(\\omega) \\propto \\int_{-\\infty}^{\\infty} C(0)\\exp(-|t|/\\tau) e^{-i\\omega t} dt$$\n由于 $C(0)$ 是一个常数，我们可以将其吸收到比例常数中。我们将积分分成两部分：\n$$I(\\omega) \\propto \\int_{-\\infty}^{0} \\exp(t/\\tau) e^{-i\\omega t} dt + \\int_{0}^{\\infty} \\exp(-t/\\tau) e^{-i\\omega t} dt$$\n$$I(\\omega) \\propto \\int_{0}^{\\infty} \\exp(-t(1/\\tau + i\\omega)) dt + \\int_{0}^{\\infty} \\exp(-t(1/\\tau - i\\omega)) dt$$\n计算这些标准指数积分得到：\n$$I(\\omega) \\propto \\left[ \\frac{1}{1/\\tau + i\\omega} \\right] + \\left[ \\frac{1}{1/\\tau - i\\omega} \\right]$$\n$$I(\\omega) \\propto \\frac{(1/\\tau - i\\omega) + (1/\\tau + i\\omega)}{(1/\\tau + i\\omega)(1/\\tau - i\\omega)} = \\frac{2/\\tau}{(1/\\tau)^2 + \\omega^2} = \\frac{2\\tau}{1 + (\\omega\\tau)^2}$$\n这是以 $\\omega=0$ 为中心的特征洛伦兹线型。最大强度出现在 $\\omega=0$ 处，此时 $I_{max} \\propto 2\\tau$。半峰全宽（FWHM）是强度为其最大值一半（$I_{max}/2$）处的线型宽度。这发生在角频率 $\\omega_{1/2}$ 满足以下条件时：\n$$1 + (\\omega_{1/2}\\tau)^2 = 2$$\n$$(\\omega_{1/2}\\tau)^2 = 1 \\implies \\omega_{1/2} = \\pm \\frac{1}{\\tau}$$\n角频率的全宽度为 $\\Delta\\omega_{\\mathrm{FWHM}} = \\omega_{1/2} - (-\\omega_{1/2}) = 2/\\tau$。问题要求的是线性频率 $\\nu$ 下的FWHM，其中 $\\omega = 2\\pi\\nu$。宽度之间的关系是 $\\Delta\\omega = 2\\pi\\Delta\\nu$。因此：\n$$2\\pi\\Delta\\nu_{\\mathrm{FWHM}} = \\frac{2}{\\tau}$$\n$$\\Delta\\nu_{\\mathrm{FWHM}} = \\frac{1}{\\pi\\tau}$$\n\n**第2部分：相关时间 $\\tau$ 的推导**\n\n相关时间 $\\tau$ 被给出为平均碰撞间隔时间，$\\tau \\approx 1/(n\\,\\sigma\\,\\bar{v}_{\\mathrm{rel}})$。为了求出 $\\tau$，我们必须首先推导在温度 $T$ 下两个质量为 $m$ 的相同分子的平均相对速率 $\\bar{v}_{\\mathrm{rel}}$。\n\n在热平衡状态下，气体中质量为 $M$ 的粒子的速度分布是麦克斯韦-玻尔兹曼分布。两个粒子之间相对速度矢量 $\\mathbf{v}_{\\mathrm{rel}} = \\mathbf{v}_1 - \\mathbf{v}_2$ 的分布也是麦克斯韦分布。这个新分布的质量参数是该双粒子系统的约化质量 $\\mu$。对于两个质量为 $m$ 的相同粒子，约化质量为：\n$$\\mu = \\frac{m \\cdot m}{m+m} = \\frac{m^2}{2m} = \\frac{m}{2}$$\n质量为 $M$ 的粒子的麦克斯韦-玻尔兹曼速率分布为 $f(v) = 4\\pi \\left(\\frac{M}{2\\pi k_B T}\\right)^{3/2} v^2 \\exp\\left(-\\frac{M v^2}{2 k_B T}\\right)$。平均速率由著名的结果给出：\n$$\\bar{v} = \\sqrt{\\frac{8 k_B T}{\\pi M}}$$\n为了求出平均相对速率 $\\bar{v}_{\\mathrm{rel}}$，我们使用此公式，并用约化质量 $\\mu = m/2$ 代替 $M$：\n$$\\bar{v}_{\\mathrm{rel}} = \\sqrt{\\frac{8 k_B T}{\\pi \\mu}} = \\sqrt{\\frac{8 k_B T}{\\pi (m/2)}} = \\sqrt{\\frac{16 k_B T}{\\pi m}} = 4\\sqrt{\\frac{k_B T}{\\pi m}}$$\n现在，我们可以用给定的参数表示相关时间 $\\tau$：\n$$\\tau = \\frac{1}{n\\,\\sigma\\,\\bar{v}_{\\mathrm{rel}}} = \\frac{1}{n\\,\\sigma\\,\\left(4\\sqrt{\\frac{k_B T}{\\pi m}}\\right)}$$\n\n**第3部分：$\\Delta \\nu_{\\mathrm{FWHM}}(T)$ 的最终表达式和温度依赖性**\n\n我们结合第1部分和第2部分的结果。我们有 $\\Delta\\nu_{\\mathrm{FWHM}} = 1/(\\pi\\tau)$ 和 $\\tau$ 的表达式。将后者代入前者：\n$$\\Delta\\nu_{\\mathrm{FWHM}}(T) = \\frac{1}{\\pi} \\left( n\\,\\sigma\\,\\bar{v}_{\\mathrm{rel}} \\right) = \\frac{1}{\\pi} \\left( n\\,\\sigma \\cdot 4\\sqrt{\\frac{k_B T}{\\pi m}} \\right)$$\n整理各项，得到谱线宽度的最终闭合形式表达式：\n$$\\Delta\\nu_{\\mathrm{FWHM}}(T) = \\frac{4 n\\,\\sigma}{\\pi} \\sqrt{\\frac{k_B T}{\\pi m}}$$\n\n谱线宽度的温度依赖性由该表达式明确给出。宽度 $\\Delta\\nu_{\\mathrm{FWHM}}$ 与绝对温度 $T$ 的平方根成正比：\n$$\\Delta\\nu_{\\mathrm{FWHM}} \\propto \\sqrt{T}$$\n这种依赖性源于一个清晰的物理推理链。温度 $T$ 的升高导致分子平均动能的增加。这会导致更大的平均相对速率，$\\bar{v}_{\\mathrm{rel}} \\propto \\sqrt{T}$。运动更快的分子碰撞更频繁，这减少了平均碰撞间隔时间，即相关时间，$\\tau \\propto 1/\\bar{v}_{\\mathrm{rel}} \\propto 1/\\sqrt{T}$。根据傅里叶分析的原理（或者更物理地说，时间-能量不确定性原理），时域中持续时间较短的事件对应于频域中更宽的特征。因此，谱线宽度 $\\Delta\\nu_{\\mathrm{FWHM}}$ 与相关时间成反比，$\\Delta\\nu_{\\mathrm{FWHM}} \\propto 1/\\tau$。结合这些比例关系，我们发现谱线宽度随温度的增加而增加，即 $\\Delta\\nu_{\\mathrm{FWHM}} \\propto 1/\\tau \\propto \\bar{v}_{\\mathrm{rel}} \\propto \\sqrt{T}$。",
            "answer": "$$\\boxed{\\frac{4 n\\,\\sigma}{\\pi} \\sqrt{\\frac{k_B T}{\\pi m}}}$$"
        },
        {
            "introduction": "最后的这项综合练习，将密度、组分和温度依赖性的概念融会贯通，并将其应用于系外行星科学的前沿实践中。你将构建一个简化的反演模型，观察行星透射光谱中CIA的独特信号如何被用来约束其大气的基本组成，特别是氢氦比。这个计算练习不仅展示了CIA的诊断能力，还介绍了用于量化测量不确定性的统计学方法。",
            "id": "4156715",
            "problem": "一位开发人员的任务是为稠密大气中的碰撞诱导吸收（Collision-Induced Absorption, CIA）构建一个参数反演练习，以约束凌日系外行星中的氢和氦混合比，并量化信息含量与噪声的关系。目标是实现一个自洽的程序，该程序在一个物理上合理、简化的框架下合成透射光谱，使用 CIA 特征反演氢分子混合比，并计算反演参数的费雪信息。\n\n该练习必须从以下基本原则开始：\n- 等温大气中的静力学平衡意味着指数形式的数密度剖面，其数密度 $n(z)$ 由 $n(z) = n_0 \\exp\\left(-\\frac{z}{H}\\right)$ 给出，其中 $H$ 是标高。\n- 理想气体定律通过 $p = n k_{\\mathrm{B}} T$ 将压力 $p$、数密度 $n$ 和温度 $T$ 联系起来，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数。\n- 标高 $H$ 由 $H = \\frac{k_{\\mathrm{B}} T}{\\mu m_{\\mathrm{u}} g}$ 给出，其中 $\\mu$ 是以原子质量单位表示的平均分子量，$m_{\\mathrm{u}}$ 是原子质量单位，$g$ 是重力加速度。\n- CIA 是一种双体吸收过程：在波长 $\\lambda$ 处，单位长度的局部吸收系数为 $\\alpha(\\lambda, z) = \\sum_{i,j} S_{ij}(\\lambda, T) n_i(z) n_j(z)$，其中 $S_{ij}(\\lambda, T)$ 是双体吸收系数，$n_i$ 是物种 $i$ 的数密度。\n- 在撞击参数 $b$ 处的斜向光学深度 $\\tau(\\lambda, b)$ 是 $\\alpha(\\lambda, z)$ 沿着穿过大气的射线路径的线积分。对于等温指数大气和双体吸收，在对切点附近的高斯路径长度因子进行积分后，切点高度 $z$ 处的切向光学深度遵循 $\\tau(\\lambda, z) \\propto S_{\\mathrm{eff}}(\\lambda, T) n_0^2 \\exp\\left(-\\frac{2z}{H}\\right)$。\n- 有效凌日半径 $R_{\\mathrm{eff}}(\\lambda)$ 由切向光学深度达到1的高度近似，从而产生对 CIA 强度的对数依赖关系。任何与几何和参考密度相关的常数都被吸收到一个滋扰偏移半径 $R_0$ 中。\n\n需使用的建模假设：\n- 大气是分子氢和氦的双组分混合物，氢分子混合比为 $x_{\\mathrm{H_2}}$，氦混合比为 $x_{\\mathrm{He}} = 1 - x_{\\mathrm{H_2}}$。\n- 平均分子量为 $\\mu(x_{\\mathrm{H_2}}) = x_{\\mathrm{H_2}} \\cdot 2 + (1 - x_{\\mathrm{H_2}}) \\cdot 4 = 4 - 2 x_{\\mathrm{H_2}}$。\n- 有效 CIA 强度由 $S_{\\mathrm{eff}}(\\lambda, T, x_{\\mathrm{H_2}}) = x_{\\mathrm{H_2}}^2 S_{22}(\\lambda, T) + 2 x_{\\mathrm{H_2}} (1 - x_{\\mathrm{H_2}}) S_{2\\mathrm{He}}(\\lambda, T)$ 建模，为简化起见，忽略氦-氦 CIA。\n- 透射谱模型采用 $R_{\\mathrm{model}}(\\lambda; x_{\\mathrm{H_2}}, R_0, T, g) = R_0 + \\frac{H(x_{\\mathrm{H_2}}, T, g)}{2} \\ln S_{\\mathrm{eff}}(\\lambda, T, x_{\\mathrm{H_2}})$ 的形式，其合理性基于 $\\tau(\\lambda, z) \\sim 1$ 准则和 CIA 的二次密度依赖性。滋扰参数 $R_0$ 吸收了与几何和参考密度相关的常数。\n\n程序必须实现以下步骤：\n1. 在从 $1.2\\,\\mu\\mathrm{m}$ 到 $2.5\\,\\mu\\mathrm{m}$ 的近红外区间内均匀定义波长样本 $\\lambda$。\n2. 定义参数化的、随温度变化的 CIA 函数 $S_{22}(\\lambda, T)$ 和 $S_{2\\mathrm{He}}(\\lambda, T)$，这些函数为正且随 $\\lambda$ 平滑变化：\n   - $S_{22}(\\lambda, T) = A_{22}(T) \\left[ \\left(\\frac{\\lambda}{2.1}\\right)^{-1.1} + 0.5 \\exp\\left( - \\left(\\frac{\\lambda - 2.1}{0.25}\\right)^2 \\right) \\right]$,\n   - $S_{2\\mathrm{He}}(\\lambda, T) = A_{2\\mathrm{He}}(T) \\left[ \\left(\\frac{\\lambda}{2.3}\\right)^{-0.9} + 0.3 \\exp\\left( - \\left(\\frac{\\lambda - 2.3}{0.3}\\right)^2 \\right) \\right]$,\n   - $A_{22}(T) = a_0 \\left(\\frac{T}{T_0}\\right)^{0.3}$, $A_{2\\mathrm{He}}(T) = 0.6\\,A_{22}(T)$，其中 $a_0 = 10^{-4}$ 且 $T_0 = 1000$ 开尔文。在这一简化框架中，这些振幅是无量纲的，并确保了 $\\ln S_{\\mathrm{eff}}(\\lambda)$ 的实际动态范围。\n3. 使用每个测试用例的真实参数从模型中合成一个无噪声的透射谱 $R_{\\mathrm{true}}(\\lambda)$。\n4. 在高斯噪声模型下实现最大似然反演，每个波长的标准差为 $\\sigma_R$（单位：米）。似然函数为 $\\mathcal{L} \\propto \\exp\\left( -\\frac{1}{2} \\sum_i \\left( \\frac{R_{\\mathrm{model}}(\\lambda_i; x_{\\mathrm{H_2}}, R_0) - R_{\\mathrm{true}}(\\lambda_i)}{\\sigma_R} \\right)^2 \\right)$，这简化为对 $x_{\\mathrm{H_2}}$ 和 $R_0$ 的加权非线性最小二乘拟合。\n5. 通过费雪信息矩阵 $F$ 量化参数 $\\theta = [x_{\\mathrm{H_2}}, R_0]$ 在最佳拟合点的信息含量：\n   - $F_{mn} = \\sum_i \\frac{1}{\\sigma_R^2} \\left( \\frac{\\partial R_{\\mathrm{model}}(\\lambda_i)}{\\partial \\theta_m} \\right) \\left( \\frac{\\partial R_{\\mathrm{model}}(\\lambda_i)}{\\partial \\theta_n} \\right)$。\n   - 使用解析导数 $\\frac{\\partial R_{\\mathrm{model}}}{\\partial R_0} = 1$ 和 $\\frac{\\partial R_{\\mathrm{model}}}{\\partial x_{\\mathrm{H_2}}} = \\frac{1}{2} \\frac{\\partial H}{\\partial x_{\\mathrm{H_2}}} \\ln S_{\\mathrm{eff}} + \\frac{H}{2} \\frac{1}{S_{\\mathrm{eff}}} \\frac{\\partial S_{\\mathrm{eff}}}{\\partial x_{\\mathrm{H_2}}}$，其中 $\\frac{\\partial H}{\\partial x_{\\mathrm{H_2}}} = \\frac{k_{\\mathrm{B}} T}{m_{\\mathrm{u}} g} \\cdot \\frac{2}{\\mu^2}$ 以及 $\\frac{\\partial S_{\\mathrm{eff}}}{\\partial x_{\\mathrm{H_2}}} = 2 x_{\\mathrm{H_2}} S_{22} + 2(1 - 2 x_{\\mathrm{H_2}}) S_{2\\mathrm{He}}$。\n6. 计算 $x_{\\mathrm{H_2}}$ 方差的克拉默-拉奥下界为 $\\sigma_{x}^2 = \\left(F^{-1}\\right)_{xx}$，并报告单西格玛不确定度 $\\sigma_x = \\sqrt{\\left(F^{-1}\\right)_{xx}}$。\n\n需使用的物理常数和单位：\n- $k_{\\mathrm{B}} = 1.380\\,649 \\times 10^{-23}$ 焦耳/开尔文，\n- $m_{\\mathrm{u}} = 1.660\\,539\\,066\\,60 \\times 10^{-27}$ 千克，\n- 所有半径 $R$ 必须以米为单位计算和处理，\n- 在参数化公式中，波长 $\\lambda$ 的单位是微米，\n- 温度 $T$ 的单位是开尔文，重力加速度 $g$ 的单位是米/秒平方。\n\n测试套件规范：\n- 使用在 $1.2$ 到 $2.5$ 微米之间均匀分布的 $40$ 个波长样本。\n- 所有情况下的重力加速度：$g = 10.0$ 米/秒平方。\n- 提供四个测试用例以在不同机制下检验算法：\n  1. 情况 1：$T = 1000.0$ 开尔文，$x_{\\mathrm{H_2,true}} = 0.85$，$R_{0,\\mathrm{true}} = 7.0 \\times 10^7$ 米，$\\sigma_R = 5.0 \\times 10^3$ 米。\n  2. 情况 2：$T = 800.0$ 开尔文，$x_{\\mathrm{H_2,true}} = 0.20$，$R_{0,\\mathrm{true}} = 6.5 \\times 10^7$ 米，$\\sigma_R = 8.0 \\times 10^3$ 米。\n  3. 情况 3：$T = 1200.0$ 开尔文，$x_{\\mathrm{H_2,true}} = 0.70$，$R_{0,\\mathrm{true}} = 7.5 \\times 10^7$ 米，$\\sigma_R = 2.0 \\times 10^4$ 米。\n  4. 情况 4：$T = 900.0$ 开尔文，$x_{\\mathrm{H_2,true}} = 0.97$，$R_{0,\\mathrm{true}} = 6.8 \\times 10^7$ 米，$\\sigma_R = 6.0 \\times 10^3$ 米。\n\n程序输出规范：\n- 对于每个测试用例，计算并返回 $x_{\\mathrm{H_2}}$ 的最大似然估计值和单西格玛不确定度 $\\sigma_x$，形式为一个双元素列表 $[x_{\\mathrm{est}}, \\sigma_x]$。\n- 您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔的结果列表，每个元素对应一个测试用例，并且本身是一个包含两个浮点数的列表，例如：$[[x_1,\\sigma_{x,1}],[x_2,\\sigma_{x,2}],\\dots]$。",
            "solution": "### 求解推导\n\n本问题的目标是计算氢混合比的最大似然估计值 $x_{\\mathrm{est}}$ 及其在四个不同测试用例下的单西格玛不确定度 $\\sigma_x$。求解过程通过实现指定的物理模型和费雪信息形式体系来进行。\n\n**1. 算法框架**\n问题的核心是计算费雪信息矩阵 $F$，并从其逆矩阵中求出参数不确定度。用于反演的参数是 $\\theta = [x_{\\mathrm{H_2}}, R_0]$。\n每个测试用例的处理过程如下：\na. 确定最佳拟合参数。由于合成数据是无噪声的，最大似然估计值就是真实值：$x_{\\mathrm{est}} = x_{\\mathrm{H_2,true}}$ 和 $R_{0,\\mathrm{est}} = R_{0,\\mathrm{true}}$。\nb. 在这些最佳拟合参数下，在 $40$ 个指定波长中的每一个波长处，计算模型的偏导数 $\\frac{\\partial R_{\\mathrm{model}}}{\\partial x_{\\mathrm{H_2}}}$ 和 $\\frac{\\partial R_{\\mathrm{model}}}{\\partial R_0}$。\nc. 使用其定义构建 $2 \\times 2$ 的费雪矩阵 $F$。\nd. 对 F 求逆得到协方差矩阵 $C = F^{-1}$。\ne. $x_{\\mathrm{H_2}}$ 的单西格玛不确定度是 $\\sigma_x = \\sqrt{C_{00}}$，其中 $C_{00}$ 是协方差矩阵的第一个对角元素。\n\n**2. 模型与导数实现**\n在真实参数值 $(x_{\\mathrm{H_2,true}}, R_{0,\\mathrm{true}}, T, g)$ 处计算导数的过程如下：\n\n- **波长**：定义一个包含 $N=40$ 个点的网格：$\\lambda_i \\in [1.2, 2.5]\\,\\mu\\mathrm{m}$。\n- **CIA 系数**：对于给定的温度 $T$，首先计算振幅 $A_{22}(T) = a_0 (T/T_0)^{0.3}$ 和 $A_{2\\mathrm{He}}(T) = 0.6 A_{22}(T)$。然后，使用它们指定的函数形式计算与波长相关的系数 $S_{22}(\\lambda_i, T)$ 和 $S_{2\\mathrm{He}}(\\lambda_i, T)$。\n\n- **关于参数的导数**：参数向量为 $\\theta = [x_{\\mathrm{H_2}}, R_0]^T$。模型关于这些参数的雅可比矩阵是一个大小为 $N \\times 2$ 的矩阵 $J$，其中 $J_{i,m} = \\frac{\\partial R_{\\mathrm{model}}(\\lambda_i)}{\\partial \\theta_m}$。\n    - **关于 $R_0$ 的导数**：导数 $\\frac{\\partial R_{\\mathrm{model}}}{\\partial R_0}$ 简单地为 $1$。$J$ 的第二列是一个全为1的数组。\n    - **关于 $x_{\\mathrm{H_2}}$ 的导数**：这是通过链式法则构成的复杂项：$\\frac{\\partial R_{\\mathrm{model}}}{\\partial x_{\\mathrm{H_2}}} = \\frac{1}{2} \\frac{\\partial H}{\\partial x_{\\mathrm{H_2}}} \\ln S_{\\mathrm{eff}} + \\frac{H}{2} \\frac{1}{S_{\\mathrm{eff}}} \\frac{\\partial S_{\\mathrm{eff}}}{\\partial x_{\\mathrm{H_2}}}$。\n        - 首先，计算在 $x_{\\mathrm{H_2}} = x_{\\mathrm{H_2,true}}$ 处的中间量：平均分子量 $\\mu$、标高 $H$、有效 CIA 强度 $S_{\\mathrm{eff}}$。\n        - 然后，计算这些量的导数：$\\frac{\\partial H}{\\partial x_{\\mathrm{H_2}}}$ 和 $\\frac{\\partial S_{\\mathrm{eff}}}{\\partial x_{\\mathrm{H_2}}}$。\n        - 最后，将这些组合起来形成雅可比矩阵 $J$ 的第一列。\n\n**3. 费雪矩阵与不确定度计算**\n- 费雪矩阵 $F$ 由 $F = \\frac{1}{\\sigma_R^2} J^T J$ 给出。\n- 协方差矩阵 $C$ 是费雪矩阵的逆矩阵，$C = F^{-1}$。\n- $x_{\\mathrm{H_2}}$ 估计的方差是元素 $C_{00}$。\n- 所需的单西格玛不确定度是 $\\sigma_x = \\sqrt{C_{00}}$。\n\n对问题中指定的四个测试用例中的每一个重复此过程，产生四对 $[x_{\\mathrm{est}}, \\sigma_x]$。最终输出将是这些对的列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the estimated hydrogen mixing ratio and its uncertainty\n    for several test cases based on a simplified model of collision-induced\n    absorption in an exoplanet atmosphere.\n    \"\"\"\n    # Define physical constants as specified in the problem\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    M_U = 1.66053906660e-27  # Atomic mass unit in kg\n\n    # Define model constants\n    A0 = 1e-4\n    T0 = 1000.0\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (T, x_h2_true, R0_true, sigma_R)\n    # T in Kelvin, R0_true in meters, sigma_R in meters. x_h2_true is dimensionless.\n    test_cases = [\n        (1000.0, 0.85, 7.0e7, 5.0e3),\n        (800.0, 0.20, 6.5e7, 8.0e3),\n        (1200.0, 0.70, 7.5e7, 2.0e4),\n        (900.0, 0.97, 6.8e7, 6.0e3),\n    ]\n\n    # Global parameters for all test cases\n    g = 10.0  # Gravitational acceleration in m/s^2\n    num_wavelengths = 40\n    wavelengths = np.linspace(1.2, 2.5, num_wavelengths)  # in micrometers\n\n    results = []\n\n    for case in test_cases:\n        T, x_h2_true, R0_true, sigma_R = case\n\n        # Step 1: \"Retrieval\" of Maximum-Likelihood Estimate\n        # Since the synthetic data is noiseless and generated from the model,\n        # the best-fit parameters are the true parameters.\n        x_est = x_h2_true\n        \n        # --- Fisher Information Matrix Calculation ---\n        # The Fisher matrix is evaluated at the best-fit (true) parameters.\n        \n        # Calculate temperature-dependent CIA amplitudes\n        A22_T = A0 * (T / T0)**0.3\n        A2He_T = 0.6 * A22_T\n        \n        # Calculate wavelength-dependent CIA coefficients S_22 and S_2He\n        S22 = A22_T * ((wavelengths / 2.1)**-1.1 + 0.5 * np.exp(-((wavelengths - 2.1) / 0.25)**2))\n        S2He = A2He_T * ((wavelengths / 2.3)**-0.9 + 0.3 * np.exp(-((wavelengths - 2.3) / 0.3)**2))\n\n        # Calculate model derivatives w.r.t. parameters [x_h2, R0]\n        # Intermediate quantities at the true parameters\n        mu = 4.0 - 2.0 * x_h2_true\n        H = (K_B * T) / (mu * M_U * g)\n        S_eff = x_h2_true**2 * S22 + 2.0 * x_h2_true * (1.0 - x_h2_true) * S2He\n\n        # Derivatives of intermediate quantities\n        dH_dx = (K_B * T) / (M_U * g) * (2.0 / mu**2)\n        dS_eff_dx = 2.0 * x_h2_true * S22 + 2.0 * (1.0 - 2.0 * x_h2_true) * S2He\n        \n        # Derivative of the model R_model w.r.t. x_h2\n        dR_dx = 0.5 * dH_dx * np.log(S_eff) + 0.5 * H / S_eff * dS_eff_dx\n        \n        # Derivative of the model R_model w.r.t. R0\n        dR_dR0 = np.ones_like(wavelengths)\n        \n        # Construct the Jacobian matrix J (shape: num_wavelengths x 2)\n        # Column 0: dR/dx_h2, Column 1: dR/dR0\n        J = np.vstack((dR_dx, dR_dR0)).T\n        \n        # Construct the Fisher Information Matrix F = (1/sigma^2) * J^T * J\n        F = (1.0 / sigma_R**2) * (J.T @ J)\n        \n        # Invert the Fisher matrix to get the covariance matrix C\n        try:\n            C = np.linalg.inv(F)\n            # The variance of x_h2 is the top-left element of the covariance matrix\n            var_x = C[0, 0]\n            # The 1-sigma uncertainty is the square root of the variance\n            sigma_x = np.sqrt(var_x)\n        except np.linalg.LinAlgError:\n            # This case should not occur with the given well-behaved model\n            sigma_x = float('inf')\n\n        results.append([x_est, sigma_x])\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list is used.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}