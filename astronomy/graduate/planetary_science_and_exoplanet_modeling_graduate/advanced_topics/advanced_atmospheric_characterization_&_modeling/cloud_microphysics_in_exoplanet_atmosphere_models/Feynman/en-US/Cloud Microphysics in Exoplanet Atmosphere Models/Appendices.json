{
    "hands_on_practices": [
        {
            "introduction": "The first step in modeling exoplanetary clouds is to determine their location and vertical extent. This is governed by the thermodynamics of the atmosphere, where clouds form in regions where a condensable vapor becomes supersaturated. This exercise guides you through calculating the boundaries of a simple cloud deck by applying the principles of hydrostatic equilibrium and phase saturation, providing a foundational link between an exoplanet's atmospheric structure and the macroscopic presence of clouds .",
            "id": "4156376",
            "problem": "Consider a hydrogen-dominated exoplanet atmosphere in hydrostatic equilibrium with gravitational acceleration $g$ and mean molecular mass $\\mu$ assumed constant. The condensable species undergoes cloud formation when the saturation ratio $S$ (defined as $S \\equiv p_{v}/p_{\\mathrm{sat}}(T)$, where $p_{v}$ is the vapor partial pressure and $p_{\\mathrm{sat}}(T)$ is the saturation vapor pressure) reaches unity. The atmosphere follows the Ideal Gas Law and the temperature-pressure profile in the region of interest is prescribed as\n$$\nT(P) = T_{b} - \\alpha \\ln\\left(\\frac{P_{b}}{P}\\right), \\quad \\text{for } P \\leq P_{b},\n$$\nwhere $T_{b}$ is the temperature at the cloud base pressure $P_{b}$ and $\\alpha$ is a constant. The saturation vapor pressure of the condensable is described by the Clausius–Clapeyron form\n$$\n\\ln p_{\\mathrm{sat}}(T) = A - \\frac{B}{T},\n$$\nwhere $A$ and $B$ are constants. Below the cloud base, the vapor mixing ratio is uniform and equal to $q_{0}$, and the cloud base is defined where $S=1$, so that $q_{0} P_{b} = p_{\\mathrm{sat}}(T_{b})$. Above the base, precipitation (“rainout”) irreversibly depletes the vapor, and its mixing ratio decays with pressure according to\n$$\nq_{v}(P) = q_{0} \\left(\\frac{P}{P_{b}}\\right)^{\\beta}, \\quad \\text{for } P \\leq P_{b},\n$$\nwhere $\\beta  0$ is a constant parameterizing the efficiency of rainout.\n\nUsing the definitions above together with hydrostatic equilibrium and the Ideal Gas Law, determine the cloud-top pressure $P_{t}$ by solving $S=1$ including rainout effects, and derive a closed-form expression for the geometric cloud thickness $\\Delta z$ between the base and the top. Then evaluate the numerical value of $\\Delta z$ for the following parameter set:\n- $P_{b} = 1.0 \\times 10^{5}\\ \\mathrm{Pa}$,\n- $T_{b} = 300\\ \\mathrm{K}$,\n- $\\alpha = 30\\ \\mathrm{K}$,\n- $\\beta = 1$,\n- $B = 5410\\ \\mathrm{K}$,\n- $g = 10\\ \\mathrm{m\\ s^{-2}}$,\n- $\\mu = 2.3\\,m_{\\mathrm{H}}$, where $m_{\\mathrm{H}} = 1.6735575 \\times 10^{-27}\\ \\mathrm{kg}$,\n- Boltzmann constant $k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\ K^{-1}}$.\n\nExpress the final cloud thickness in meters (m). Round your answer to four significant figures.",
            "solution": "The problem is well-posed, scientifically grounded, and provides all necessary information to derive a unique solution. We will proceed in three steps: first, determine the cloud-top pressure $P_{t}$; second, derive an expression for the geometric cloud thickness $\\Delta z$; and third, evaluate the numerical value of $\\Delta z$ using the provided parameters.\n\nThe cloud top is defined by the condition that the saturation ratio $S$ equals unity. The saturation ratio is given by $S \\equiv p_{v}/p_{\\mathrm{sat}}(T)$, where $p_{v}$ is the vapor partial pressure and $p_{\\mathrm{sat}}(T)$ is the saturation vapor pressure. The vapor partial pressure is related to the total pressure $P$ and the vapor mixing ratio $q_v$ by $p_v(P) = q_v(P) P$.\n\nAt the cloud top, where the pressure is $P_{t}$ and temperature is $T(P_{t})$, the condition $S(P_{t}) = 1$ implies:\n$$\np_v(P_t) = p_{\\mathrm{sat}}(T(P_t))\n$$\nUsing the rainout model for the vapor mixing ratio above the cloud base, $q_v(P) = q_{0} (P/P_{b})^{\\beta}$, the vapor partial pressure at the top is:\n$$\np_v(P_t) = q_v(P_t) P_t = q_{0} \\left(\\frac{P_t}{P_{b}}\\right)^{\\beta} P_t = q_0 P_b^{-\\beta} P_t^{1+\\beta}\n$$\nThe saturation vapor pressure is given by the Clausius–Clapeyron equation:\n$$\n\\ln p_{\\mathrm{sat}}(T) = A - \\frac{B}{T}\n$$\nTaking the natural logarithm of the condition $p_v(P_t) = p_{\\mathrm{sat}}(T(P_t))$, we get:\n$$\n\\ln(q_0 P_b^{-\\beta} P_t^{1+\\beta}) = A - \\frac{B}{T(P_t)}\n$$\n$$\n\\ln q_0 - \\beta \\ln P_b + (1+\\beta) \\ln P_t = A - \\frac{B}{T(P_t)}\n$$\nThe constants $A$ and $q_0$ are not given explicitly, but they can be determined from the condition at the cloud base ($P_b$, $T_b$), where $S(P_b)=1$. At the base, $q_v(P_b) = q_0$, so $p_v(P_b) = q_0 P_b$. The saturation condition is $q_0 P_b = p_{\\mathrm{sat}}(T_b)$, which in logarithmic form is:\n$$\n\\ln(q_0 P_b) = \\ln(p_{\\mathrm{sat}}(T_b)) \\implies \\ln q_0 + \\ln P_b = A - \\frac{B}{T_b}\n$$\nThis allows us to express $A$ as $A = \\ln q_0 + \\ln P_b + \\frac{B}{T_b}$. Substituting this into the equation for the cloud top:\n$$\n\\ln q_0 - \\beta \\ln P_b + (1+\\beta) \\ln P_t = \\left(\\ln q_0 + \\ln P_b + \\frac{B}{T_b}\\right) - \\frac{B}{T(P_t)}\n$$\nThe $\\ln q_0$ term cancels. Rearranging the terms involving pressure:\n$$\n(1+\\beta) (\\ln P_t - \\ln P_b) = B \\left(\\frac{1}{T_b} - \\frac{1}{T(P_t)}\\right)\n$$\n$$\n(1+\\beta) \\ln\\left(\\frac{P_t}{P_b}\\right) = B \\left(\\frac{T(P_t) - T_b}{T_b T(P_t)}\\right)\n$$\nNow, we substitute the given temperature-pressure profile, $T(P) = T_{b} - \\alpha \\ln(P_{b}/P) = T_{b} + \\alpha \\ln(P/P_{b})$.\nAt the cloud top, $T(P_t) = T_b + \\alpha \\ln(P_t/P_b)$. Let's define the dimensionless variable $x = \\ln(P_t/P_b)$. Then $T(P_t) = T_b + \\alpha x$. Substituting these into the equation:\n$$\n(1+\\beta) x = B \\left(\\frac{(T_b + \\alpha x) - T_b}{T_b (T_b + \\alpha x)}\\right) = \\frac{B \\alpha x}{T_b(T_b + \\alpha x)}\n$$\nSince $P_t \\neq P_b$, we have $x \\neq 0$, and we can divide by $x$:\n$$\n1+\\beta = \\frac{B \\alpha}{T_b(T_b + \\alpha x)}\n$$\nSolving for $x$:\n$$\nT_b(T_b + \\alpha x) = \\frac{B \\alpha}{1+\\beta} \\implies T_b^2 + T_b \\alpha x = \\frac{B \\alpha}{1+\\beta}\n$$\n$$\nx = \\frac{1}{T_b \\alpha} \\left(\\frac{B \\alpha}{1+\\beta} - T_b^2\\right) = \\frac{B}{(1+\\beta)T_b} - \\frac{T_b}{\\alpha}\n$$\nSo, $\\ln(P_t/P_b)$ is determined. $P_t = P_b \\exp(x)$.\n\nNext, we derive the geometric cloud thickness, $\\Delta z = z_t - z_b$. We use the equation of hydrostatic equilibrium, $dP = -\\rho g dz$, where $\\rho$ is the atmospheric density. From the Ideal Gas Law, $P = \\frac{\\rho k_B T}{\\mu}$, so $\\rho = \\frac{P \\mu}{k_B T}$.\n$$\ndz = -\\frac{dP}{\\rho g} = -\\frac{k_B T(P)}{\\mu g} \\frac{dP}{P}\n$$\nWe integrate this equation from the cloud base (pressure $P_b$, altitude $z_b$) to the cloud top (pressure $P_t$, altitude $z_t$):\n$$\n\\Delta z = z_t - z_b = \\int_{z_b}^{z_t} dz = \\int_{P_b}^{P_t} -\\frac{k_B T(P)}{\\mu g} \\frac{dP}{P} = \\frac{k_B}{\\mu g} \\int_{P_t}^{P_b} T(P) \\frac{d P}{P}\n$$\nSubstitute the temperature profile $T(P) = T_b + \\alpha \\ln(P/P_b)$:\n$$\n\\Delta z = \\frac{k_B}{\\mu g} \\int_{P_t}^{P_b} \\left(T_b + \\alpha \\ln\\left(\\frac{P}{P_b}\\right)\\right) \\frac{dP}{P}\n$$\nWe perform a change of variables with $u = \\ln(P/P_b)$, so $du = dP/P$. The integration limits become $u_{lower} = \\ln(P_t/P_b) = x$ and $u_{upper} = \\ln(P_b/P_b) = 0$.\n$$\n\\Delta z = \\frac{k_B}{\\mu g} \\int_{x}^{0} (T_b + \\alpha u) du = \\frac{k_B}{\\mu g} \\left[T_b u + \\frac{1}{2}\\alpha u^2 \\right]_{x}^{0}\n$$\n$$\n\\Delta z = \\frac{k_B}{\\mu g} \\left(0 - \\left(T_b x + \\frac{1}{2}\\alpha x^2\\right)\\right) = -\\frac{k_B}{\\mu g} \\left(T_b x + \\frac{1}{2}\\alpha x^2\\right)\n$$\nSubstitute the expression for $x$:\n$$\nT_b x = T_b \\left(\\frac{B}{(1+\\beta)T_b} - \\frac{T_b}{\\alpha}\\right) = \\frac{B}{1+\\beta} - \\frac{T_b^2}{\\alpha}\n$$\n$$\n\\frac{1}{2}\\alpha x^2 = \\frac{1}{2}\\alpha \\left(\\frac{B}{(1+\\beta)T_b} - \\frac{T_b}{\\alpha}\\right)^2 = \\frac{1}{2}\\alpha \\left(\\frac{B^2}{(1+\\beta)^2 T_b^2} - \\frac{2B}{(1+\\beta)\\alpha} + \\frac{T_b^2}{\\alpha^2}\\right) = \\frac{\\alpha B^2}{2(1+\\beta)^2 T_b^2} - \\frac{B}{1+\\beta} + \\frac{T_b^2}{2\\alpha}\n$$\nSumming these two terms:\n$$\nT_b x + \\frac{1}{2}\\alpha x^2 = \\left(\\frac{B}{1+\\beta} - \\frac{T_b^2}{\\alpha}\\right) + \\left(\\frac{\\alpha B^2}{2(1+\\beta)^2 T_b^2} - \\frac{B}{1+\\beta} + \\frac{T_b^2}{2\\alpha}\\right) = \\frac{\\alpha B^2}{2(1+\\beta)^2 T_b^2} - \\frac{T_b^2}{2\\alpha}\n$$\nFinally, substituting this back into the expression for $\\Delta z$:\n$$\n\\Delta z = -\\frac{k_B}{\\mu g} \\left(\\frac{\\alpha B^2}{2(1+\\beta)^2 T_b^2} - \\frac{T_b^2}{2\\alpha}\\right) = \\frac{k_B}{2\\mu g} \\left(\\frac{T_b^2}{\\alpha} - \\frac{\\alpha B^2}{(1+\\beta)^2 T_b^2}\\right)\n$$\nThis is the final closed-form expression for the cloud thickness.\n\nNow we evaluate this expression numerically with the given parameters:\n- $T_{b} = 300\\ \\mathrm{K}$\n- $\\alpha = 30\\ \\mathrm{K}$\n- $\\beta = 1$\n- $B = 5410\\ \\mathrm{K}$\n- $g = 10\\ \\mathrm{m\\ s^{-2}}$\n- $k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\ K^{-1}}$\n- $\\mu = 2.3\\,m_{\\mathrm{H}} = 2.3 \\times (1.6735575 \\times 10^{-27}\\ \\mathrm{kg}) = 3.84918225 \\times 10^{-27}\\ \\mathrm{kg}$\n\nFirst, calculate the two terms inside the parenthesis:\n$$\n\\frac{T_b^2}{\\alpha} = \\frac{(300\\ \\mathrm{K})^2}{30\\ \\mathrm{K}} = \\frac{90000\\ \\mathrm{K^2}}{30\\ \\mathrm{K}} = 3000\\ \\mathrm{K}\n$$\n$$\n\\frac{\\alpha B^2}{(1+\\beta)^2 T_b^2} = \\frac{(30\\ \\mathrm{K}) (5410\\ \\mathrm{K})^2}{(1+1)^2 (300\\ \\mathrm{K})^2} = \\frac{30 \\times 29268100}{4 \\times 90000}\\ \\mathrm{K} = \\frac{878043000}{360000}\\ \\mathrm{K} \\approx 2439.0083\\ \\mathrm{K}\n$$\nThe difference is $3000\\ \\mathrm{K} - 2439.0083\\ \\mathrm{K} = 560.9917\\ \\mathrm{K}$.\n\nNext, calculate the prefactor:\n$$\n\\frac{k_B}{2\\mu g} = \\frac{1.380649 \\times 10^{-23}\\ \\mathrm{J\\ K^{-1}}}{2 \\times (3.84918225 \\times 10^{-27}\\ \\mathrm{kg}) \\times (10\\ \\mathrm{m\\ s^{-2}})} \\approx 179.3426\\ \\mathrm{m\\ K^{-1}}\n$$\nFinally, the cloud thickness $\\Delta z$ is:\n$$\n\\Delta z \\approx (179.3426\\ \\mathrm{m\\ K^{-1}}) \\times (560.9917\\ \\mathrm{K}) \\approx 100609.64\\ \\mathrm{m}\n$$\nThe problem asks for the answer to be rounded to four significant figures.\n$100609.64\\ \\mathrm{m} \\approx 1.006 \\times 10^5\\ \\mathrm{m} = 100600\\ \\mathrm{m}$.\nThe final result for the cloud thickness is $100600$ meters.",
            "answer": "$$\\boxed{100600}$$"
        },
        {
            "introduction": "Once a cloud-forming region is identified, we must understand how fast individual condensate particles can grow. This growth by condensation is a classic problem where the diffusion of vapor to the particle is coupled with the conduction of latent heat away from it. This problem challenges you to derive the particle growth rate from first principles, revealing the critical interplay between mass and heat transport that governs the timescale for cloud formation .",
            "id": "4156408",
            "problem": "Consider silicate cloud particle growth by vapor condensation in a hydrogen-dominated brown dwarf atmosphere under continuum transport, with a spatially uniform far-field temperature $T_{\\infty}$ and vapor density $\\rho_{v,\\infty}$. Assume a spherical solid condensate particle of density $\\rho_{p}$, growing by diffusion-limited vapor transport and conduction-limited heat removal, with negligible Kelvin curvature (no surface tension correction), negligible non-continuum effects, and unit mass accommodation. The far-field vapor is supersaturated relative to the saturation density at $T_{\\infty}$, with supersaturation ratio $S \\equiv \\rho_{v,\\infty}/\\rho_{v,\\mathrm{eq}}(T_{\\infty})  1$. The silicate vapor behaves as an ideal gas with specific gas constant $R_{v}$ and obeys the Clausius–Clapeyron (CC) relation.\n\nStarting from Fick’s law of diffusion and Fourier’s law of heat conduction, together with the Clausius–Clapeyron (CC) relation and the Ideal Gas Law (IGL), derive the continuum-limit growth rate $dr/dt$ for a spherical particle of radius $r$ when condensation releases latent heat $L$ that must be removed by thermal conduction through the surrounding gas. Use a linearization of the equilibrium vapor density at the particle surface, $\\rho_{v,\\mathrm{eq}}(T_{s})$, about $T_{\\infty}$, and impose energy balance between latent heat release and conductive heat flux. Show how the coupling between mass and heat transfer enters the growth rate, and then integrate to obtain the total time for growth from an initial seed radius $r_{0}$ to a final radius $r$.\n\nUsing your derived expression, compute the growth time from $r_{0} = 0.01\\,\\mu\\mathrm{m}$ to $r = 1.00\\,\\mu\\mathrm{m}$ for a silicate condensate with the following parameters representative of a brown dwarf atmosphere layer:\n- Far-field temperature $T_{\\infty} = 1500\\,\\mathrm{K}$,\n- Supersaturation ratio $S = 1.05$,\n- Vapor diffusivity $D = 1.0 \\times 10^{-4}\\,\\mathrm{m^{2}\\,s^{-1}}$,\n- Thermal conductivity of the gas $k = 0.10\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$,\n- Far-field vapor density $\\rho_{v,\\infty} = 1.05 \\times 10^{-6}\\,\\mathrm{kg\\,m^{-3}}$,\n- Particle (solid silicate) density $\\rho_{p} = 3.20 \\times 10^{3}\\,\\mathrm{kg\\,m^{-3}}$,\n- Latent heat of condensation $L = 5.0 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}$,\n- Specific gas constant of the silicate vapor $R_{v} = 189\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$.\n\nExpress your final answer in seconds, and round your numerical result to four significant figures. All intermediate steps must be justified from the stated physical laws and relations; do not invoke any pre-derived growth formulas.",
            "solution": "The problem requires the derivation of the growth time for a silicate particle condensing from a vapor phase in a brown dwarf atmosphere. The derivation must start from first principles: Fick's law for mass diffusion, Fourier's law for heat conduction, and the Clausius-Clapeyron relation coupled with the Ideal Gas Law for phase equilibrium. Finally, a numerical calculation is required for the given parameters.\n\n**Step 1: Derivation of the Particle Growth Rate ($dr/dt$)**\n\nThe mass of a spherical particle of radius $r$ and density $\\rho_{p}$ is given by $m_p = \\frac{4}{3}\\pi r^{3} \\rho_{p}$. The rate of change of its mass as it grows is:\n$$\n\\frac{dm_p}{dt} = \\frac{d}{dt}\\left(\\frac{4}{3}\\pi r^{3} \\rho_{p}\\right) = 4\\pi r^{2} \\rho_{p} \\frac{dr}{dt}\n$$\nThis mass increase is driven by the net flux of vapor onto the particle's surface.\n\n**Mass Flux from Diffusion:**\nUnder the continuum assumption, the steady-state diffusion of vapor towards the particle is governed by the spherically symmetric Laplace equation for vapor density $\\rho_v(R)$: $\\nabla^2 \\rho_v = 0$ for a radial coordinate $R \\geq r$. The solution has the form $\\rho_v(R) = C_1/R + C_2$. Applying the boundary conditions $\\rho_v(R \\to \\infty) = \\rho_{v,\\infty}$ and $\\rho_v(R=r) = \\rho_{v,s}$ (the vapor density at the particle surface), we find the profile:\n$$\n\\rho_v(R) = \\frac{r}{R}(\\rho_{v,s} - \\rho_{v,\\infty}) + \\rho_{v,\\infty}\n$$\nAccording to Fick's first law, the diffusive mass flux density is $\\vec{J} = -D \\nabla \\rho_v$, where $D$ is the vapor diffusivity. The radial flux density at a distance $R$ is $J(R) = -D \\frac{d\\rho_v}{dR}$. Differentiating the profile gives $\\frac{d\\rho_v}{dR} = -\\frac{r}{R^2}(\\rho_{v,s} - \\rho_{v,\\infty})$. The total mass flux $I$ onto the surface (at $R=r$) is the flux density multiplied by the surface area $4\\pi r^2$:\n$$\nI = \\left. (4\\pi R^2) J(R) \\right|_{R=r} = \\left. (4\\pi r^2) \\left(-D \\left(-\\frac{r}{r^2}(\\rho_{v,s} - \\rho_{v,\\infty})\\right)\\right) \\right. = 4\\pi D r (\\rho_{v,\\infty} - \\rho_{v,s})\n$$\nGrowth occurs when the far-field vapor density $\\rho_{v,\\infty}$ is greater than the surface vapor density $\\rho_{v,s}$. Equating the two expressions for the rate of mass change:\n$$\n4\\pi r^{2} \\rho_{p} \\frac{dr}{dt} = 4\\pi D r (\\rho_{v,\\infty} - \\rho_{v,s})\n$$\nThis simplifies to an expression for the growth rate:\n$$\n\\frac{dr}{dt} = \\frac{D}{r \\rho_{p}} (\\rho_{v,\\infty} - \\rho_{v,s})\n$$\n\n**Heat Flux from Conduction and Energy Balance:**\nCondensation releases latent heat $L$ at a rate $\\dot{Q} = L \\cdot I$. This heat must be conducted away from the particle. The steady-state heat conduction is governed by $\\nabla^2 T = 0$, where $T(R)$ is the temperature profile. Analogous to the mass diffusion problem, the solution with boundary conditions $T(R \\to \\infty) = T_{\\infty}$ and $T(R=r) = T_{s}$ (the particle surface temperature) is $T(R) = \\frac{r}{R}(T_s - T_\\infty) + T_\\infty$.\nFrom Fourier's law, $\\vec{q} = -k \\nabla T$, where $k$ is the thermal conductivity of the gas. The total heat flux away from the particle is:\n$$\n\\dot{Q} = \\left. (4\\pi R^2) q(R) \\right|_{R=r} = 4\\pi k r (T_s - T_\\infty)\n$$\nIn steady-state growth, the rate of latent heat release must equal the rate of heat removal: $L \\cdot I = \\dot{Q}$.\n$$\nL \\left[ 4\\pi D r(\\rho_{v,\\infty} - \\rho_{v,s}) \\right] = 4\\pi k r (T_s - T_\\infty)\n$$\nThis yields a key relation between the temperature and vapor density differences:\n$$\nL D (\\rho_{v,\\infty} - \\rho_{v,s}) = k (T_s - T_\\infty)\n$$\n\n**Surface Equilibrium and Linearization:**\nThe unknowns are $T_s$ and $\\rho_{v,s}$. We assume the vapor at the particle surface is in equilibrium with the solid, so $\\rho_{v,s} = \\rho_{v,\\mathrm{eq}}(T_s)$. We linearize this equilibrium density around the far-field temperature $T_\\infty$:\n$$\n\\rho_{v,\\mathrm{eq}}(T_s) \\approx \\rho_{v,\\mathrm{eq}}(T_\\infty) + \\left. \\frac{d\\rho_{v,\\mathrm{eq}}}{dT} \\right|_{T_\\infty} (T_s - T_\\infty)\n$$\nTo find the derivative, we use the Clausius–Clapeyron (CC) relation and the Ideal Gas Law (IGL). The CC relation is $\\frac{dP_{v,\\mathrm{eq}}}{dT} = \\frac{L}{T \\Delta v} \\approx \\frac{L \\rho_{v,\\mathrm{eq}}}{T}$, assuming the specific volume of the vapor $v_v=1/\\rho_{v,\\mathrm{eq}}$ is much larger than that of the solid. The IGL for the vapor is $P_{v,\\mathrm{eq}} = \\rho_{v,\\mathrm{eq}} R_v T$. Differentiating the IGL gives $\\frac{dP_{v,\\mathrm{eq}}}{dT} = R_v (\\rho_{v,\\mathrm{eq}} + T \\frac{d\\rho_{v,\\mathrm{eq}}}{dT})$. Equating the two expressions for the derivative of pressure, we solve for the derivative of density:\n$$\n\\frac{L \\rho_{v,\\mathrm{eq}}}{T} = R_v (\\rho_{v,\\mathrm{eq}} + T \\frac{d\\rho_{v,\\mathrm{eq}}}{dT}) \\implies \\frac{d\\rho_{v,\\mathrm{eq}}}{dT} = \\frac{\\rho_{v,\\mathrm{eq}}}{T} \\left( \\frac{L}{R_v T} - 1 \\right)\n$$\nEvaluating at $T_\\infty$, the linearized surface density becomes:\n$$\n\\rho_{v,s} \\approx \\rho_{v,\\mathrm{eq}}(T_\\infty) + \\frac{\\rho_{v,\\mathrm{eq}}(T_\\infty)}{T_\\infty} \\left( \\frac{L}{R_v T_\\infty} - 1 \\right) (T_s - T_\\infty)\n$$\n\n**Coupled Mass and Heat Transfer:**\nWe now solve for the density difference $(\\rho_{v,\\infty} - \\rho_{v,s})$ which drives mass flux. Rearranging the linearization:\n$$\n\\rho_{v,s} - \\rho_{v,\\mathrm{eq}}(T_\\infty) \\approx \\frac{\\rho_{v,\\mathrm{eq}}(T_\\infty)}{T_\\infty} \\left( \\frac{L}{R_v T_\\infty} - 1 \\right) (T_s - T_\\infty)\n$$\nSubstitute $(T_s - T_\\infty) = \\frac{LD}{k}(\\rho_{v,\\infty} - \\rho_{v,s})$ from the energy balance equation:\n$$\n\\rho_{v,s} - \\rho_{v,\\mathrm{eq}}(T_\\infty) = \\frac{\\rho_{v,\\mathrm{eq}}(T_\\infty)}{T_\\infty} \\left( \\frac{L}{R_v T_\\infty} - 1 \\right) \\frac{LD}{k} (\\rho_{v,\\infty} - \\rho_{v,s})\n$$\nWe want to find $(\\rho_{v,\\infty} - \\rho_{v,s})$. Let's rearrange to solve for this term.\n$$\n\\rho_{v,\\infty} - \\rho_{v,\\mathrm{eq}}(T_\\infty) = (\\rho_{v,\\infty} - \\rho_{v,s}) + (\\rho_{v,s} - \\rho_{v,\\mathrm{eq}}(T_\\infty))\n$$\n$$\n\\rho_{v,\\infty} - \\rho_{v,\\mathrm{eq}}(T_\\infty) = (\\rho_{v,\\infty} - \\rho_{v,s}) + \\frac{L D \\rho_{v,\\mathrm{eq}}(T_\\infty)}{k T_\\infty} \\left( \\frac{L}{R_v T_\\infty} - 1 \\right) (\\rho_{v,\\infty} - \\rho_{v,s})\n$$\n$$\n\\rho_{v,\\infty} - \\rho_{v,\\mathrm{eq}}(T_\\infty) = (\\rho_{v,\\infty} - \\rho_{v,s}) \\left[ 1 + \\frac{L D \\rho_{v,\\mathrm{eq}}(T_\\infty)}{k T_\\infty} \\left( \\frac{L}{R_v T_\\infty} - 1 \\right) \\right]\n$$\nThe first term in the brackets, $1$, represents the resistance from mass diffusion. The second term represents the additional resistance to growth due to the need to conduct away latent heat, which raises the surface temperature $T_s$ and thus the equilibrium vapor density $\\rho_{v,s}$, reducing the driving gradient. This is the coupling between mass and heat transfer.\nLet $\\rho_{v,\\mathrm{eq}}(T_\\infty) = \\rho_{v,\\infty}/S$. The driving density difference is $\\rho_{v,\\infty} - \\rho_{v,\\mathrm{eq}}(T_\\infty) = (S-1)\\rho_{v,\\mathrm{eq}}(T_\\infty) = (S-1)\\rho_{v,\\infty}/S$.\nThe final expression for the growth rate is:\n$$\n\\frac{dr}{dt} = \\frac{D}{r \\rho_{p}} \\frac{(S-1)\\rho_{v,\\infty}/S}{\\left[ 1 + \\frac{L D \\rho_{v,\\infty}}{S k T_\\infty} \\left( \\frac{L}{R_v T_\\infty} - 1 \\right) \\right]}\n$$\nThis equation is of the form $r \\frac{dr}{dt} = A$, where $A$ is a constant.\n\n**Step 2: Integration for Total Growth Time**\n\nWe integrate the growth rate equation:\n$$\n\\int_{r_0}^{r} r' dr' = \\int_{0}^{t} A dt \\implies \\frac{1}{2}(r^2 - r_0^2) = A t\n$$\nThe total time $t$ to grow from an initial radius $r_0$ to a final radius $r$ is:\n$$\nt = \\frac{r^2 - r_0^2}{2A} = \\frac{(r^2 - r_0^2) \\rho_{p}}{2 D} \\frac{\\left[ 1 + \\frac{L D \\rho_{v,\\infty}}{S k T_\\infty} \\left( \\frac{L}{R_v T_\\infty} - 1 \\right) \\right]}{(S-1)\\rho_{v,\\infty}/S}\n$$\n$$\nt = \\frac{(r^2 - r_0^2) S \\rho_{p}}{2 D (S-1) \\rho_{v,\\infty}} \\left[ 1 + \\frac{L D \\rho_{v,\\infty}}{S k T_\\infty} \\left( \\frac{L}{R_v T_\\infty} - 1 \\right) \\right]\n$$\n\n**Step 3: Numerical Calculation**\n\nWe are given the following parameters in SI units:\n- $r_0 = 0.01\\,\\mu\\mathrm{m} = 1 \\times 10^{-8}\\,\\mathrm{m}$\n- $r = 1.00\\,\\mu\\mathrm{m} = 1 \\times 10^{-6}\\,\\mathrm{m}$\n- $S = 1.05$\n- $\\rho_{p} = 3.20 \\times 10^{3}\\,\\mathrm{kg\\,m^{-3}}$\n- $D = 1.0 \\times 10^{-4}\\,\\mathrm{m^{2}\\,s^{-1}}$\n- $\\rho_{v,\\infty} = 1.05 \\times 10^{-6}\\,\\mathrm{kg\\,m^{-3}}$\n- $L = 5.0 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}$\n- $k = 0.10\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$\n- $T_{\\infty} = 1500\\,\\mathrm{K}$\n- $R_{v} = 189\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n\nFirst, calculate the dimensionless terms:\n$$\n\\frac{L}{R_v T_\\infty} = \\frac{5.0 \\times 10^{6}}{(189)(1500)} \\approx 17.63668\n$$\n$$\n\\frac{L}{R_v T_\\infty} - 1 \\approx 16.63668\n$$\nThe time equation can be split into two parts, a purely diffusional term ($t_D$) and a thermal correction term ($t_{th}$):\n$$\nt = t_D + t_{th} = \\frac{(r^2 - r_0^2) S \\rho_p}{2 D (S-1) \\rho_{v,\\infty}} + \\frac{(r^2 - r_0^2) \\rho_p L}{2 (S-1) k T_\\infty} \\left(\\frac{L}{R_v T_\\infty}-1\\right)\n$$\nCalculate the geometric factor:\n$$\nr^2 - r_0^2 = (1 \\times 10^{-6})^2 - (1 \\times 10^{-8})^2 = 1 \\times 10^{-12} - 1 \\times 10^{-16} = 0.9999 \\times 10^{-12}\\,\\mathrm{m^2}\n$$\nCalculate the diffusional time $t_D$:\n$$\nt_D = \\frac{(0.9999 \\times 10^{-12})(1.05)(3.20 \\times 10^{3})}{2 (1.0 \\times 10^{-4})(1.05-1)(1.05 \\times 10^{-6})} = \\frac{3.359664 \\times 10^{-9}}{1.05 \\times 10^{-11}} = 319.968\\,\\mathrm{s}\n$$\nCalculate the thermal correction time $t_{th}$:\n$$\nt_{th} = \\frac{(0.9999 \\times 10^{-12})(3.20 \\times 10^{3})(5.0 \\times 10^{6})}{2(1.05-1)(0.10)(1500)} \\times (16.63668)\n$$\n$$\nt_{th} = \\frac{1.59984 \\times 10^{-2}}{15} \\times (16.63668) = (1.06656 \\times 10^{-3}) \\times (16.63668) \\approx 0.017743\\,\\mathrm{s}\n$$\nThe total time is the sum:\n$$\nt = t_D + t_{th} = 319.968\\,\\mathrm{s} + 0.017743\\,\\mathrm{s} = 319.985743\\,\\mathrm{s}\n$$\nRounding the result to four significant figures gives $320.0\\,\\mathrm{s}$. The small value of $t_{th}$ indicates that growth is strongly limited by mass diffusion rather than heat conduction in this environment.",
            "answer": "$$\\boxed{320.0}$$"
        },
        {
            "introduction": "While condensation governs initial growth, the formation of rain is a collective process involving the collision and coalescence of countless cloud droplets. This advanced computational exercise places you in the role of an atmospheric modeler, bridging the gap between detailed microphysical calculations and efficient model representations. You will use a 'bin' microphysics scheme to compute the rate of rain formation (autoconversion) and then calibrate a simpler 'bulk' parameterization, a fundamental practice in the development of all large-scale atmospheric models .",
            "id": "4156405",
            "problem": "You are tasked with calibrating a bulk autoconversion parameterization for precipitation onset in an exoplanet cloud microphysics context against a bin-model estimate derived from a kernel-integrated coalescence rate. The physical scenario considers a single-species condensate (for concreteness, liquid methane) embedded in a hydrogen-dominated atmosphere on sub-Neptune-class exoplanets. Your program must compute the bin-model autoconversion tendency and calibrate the bulk parameterization coefficient such that the bulk tendency matches the bin-model over a set of test atmospheric and microphysical states.\n\nFundamental base and definitions:\n- The Smoluchowski coagulation equation governs droplet coalescence. In terms of droplet number density per radius $n(r)$, the gravitational collection kernel $K(r,r')$ between two radii $r$ and $r'$ is modeled as\n$$\nK(r,r') = E_{\\mathrm{c}} \\, \\pi \\, (r + r')^2 \\, \\left| v_{\\mathrm{t}}(r) - v_{\\mathrm{t}}(r') \\right|,\n$$\nwhere $E_{\\mathrm{c}}$ is the collection efficiency and $v_{\\mathrm{t}}(r)$ is the terminal velocity.\n- For small droplets in the Stokes drag regime, the terminal velocity is\n$$\nv_{\\mathrm{t}}(r) = \\frac{2}{9} \\frac{\\left( \\rho_{\\ell} - \\rho_{\\mathrm{air}} \\right) g}{\\mu} \\, r^2,\n$$\nwhere $\\rho_{\\ell}$ is the condensate density, $\\rho_{\\mathrm{air}}$ is the atmospheric density, $g$ is gravitational acceleration, and $\\mu$ is the dynamic viscosity of the gas.\n- The droplet mass for radius $r$ is\n$$\nm(r) = \\frac{4}{3}\\pi \\rho_{\\ell} r^3.\n$$\n- Assume a lognormal droplet size distribution (number density per radius) with total number concentration $N_{\\mathrm{c}}$,\n$$\nn(r) = \\frac{N_{\\mathrm{c}}}{\\sqrt{2\\pi}\\,\\ln\\sigma_{\\mathrm{g}}} \\frac{1}{r} \\exp\\!\\left( - \\frac{\\left[\\ln(r/r_{\\mathrm{m}})\\right]^2}{2\\,\\ln^2\\sigma_{\\mathrm{g}}} \\right),\n$$\nwhere $r_{\\mathrm{m}}$ is the median radius and $\\sigma_{\\mathrm{g}}$ is the geometric standard deviation.\n- Define a precipitation threshold radius $r_{\\mathrm{crit}}$. Autoconversion is the transfer of condensate mass from the \"cloud\" category (droplets with $r  r_{\\mathrm{crit}}$) to the \"rain\" category (droplets with $r \\ge r_{\\mathrm{crit}}$) by coalescence between subcritical droplets. A coalescence event between radii $r$ and $r'$ creates a merged droplet of radius $r_{\\mathrm{new}} = \\left(r^3 + r'^3\\right)^{1/3}$. Events with $rr_{\\mathrm{crit}}$, $r'r_{\\mathrm{crit}}$ and $r_{\\mathrm{new}} \\ge r_{\\mathrm{crit}}$ contribute to autoconversion.\n\nBin-model autoconversion tendency:\n- The bin-model autoconversion mass rate per unit volume is computed from the kernel-integrated coalescence restricted to events crossing the threshold:\n$$\nR_{\\mathrm{auto,bin}} = \\frac{1}{2} \\int_{0}^{r_{\\mathrm{crit}}} \\int_{0}^{r_{\\mathrm{crit}}} K(r,r')\\, n(r)\\, n(r')\\, \\left[m(r)+m(r')\\right]\\, \\mathbf{1}\\!\\left( \\left(r^3 + r'^3\\right)^{1/3} \\ge r_{\\mathrm{crit}} \\right) \\, dr \\, dr',\n$$\nwhere $\\mathbf{1}(\\cdot)$ is the indicator function taking value $1$ if its argument is true and $0$ otherwise. The factor $\\frac{1}{2}$ prevents double counting symmetric pairs. The corresponding bin-model autoconversion tendency of rain mixing ratio (mass per unit air mass per unit time) is\n$$\nQ_{\\mathrm{bin}} = \\frac{R_{\\mathrm{auto,bin}}}{\\rho_{\\mathrm{air}}}.\n$$\n\nBulk autoconversion parameterization:\n- Consider a bulk autoconversion parameterization of the form\n$$\nQ_{\\mathrm{bulk}} = k \\, q_{\\mathrm{c}}^{a} \\, N_{\\mathrm{c}}^{b},\n$$\nwhere $q_{\\mathrm{c}}$ is the cloud water mixing ratio for subcritical droplets and $k$ is the coefficient to calibrate. The exponents $a$ and $b$ are specified constants. The cloud mixing ratio is computed from the subcritical mass per unit volume $M_{\\mathrm{c}} = \\int_{0}^{r_{\\mathrm{crit}}} m(r)\\, n(r)\\, dr$ as\n$$\nq_{\\mathrm{c}} = \\frac{M_{\\mathrm{c}}}{\\rho_{\\mathrm{air}}}.\n$$\n- Dimensional consistency: $Q_{\\mathrm{bulk}}$ has units $\\mathrm{s}^{-1}$ in mixing ratio tendency $(\\mathrm{kg}\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-1})$, so the units of $k$ are\n$$\n\\left[ k \\right] = \\mathrm{s}^{-1} \\times \\left( \\mathrm{kg}\\,\\mathrm{kg}^{-1} \\right)^{1-a} \\times \\mathrm{m}^{3b}.\n$$\n\nCalibration objective:\n- Given a set of test cases indexed by $i$, calibrate a single coefficient $k$ (with fixed $a$ and $b$) by least squares to match $Q_{\\mathrm{bin},i}$ with $Q_{\\mathrm{bulk},i} = k\\, x_i$, where $x_i = q_{\\mathrm{c},i}^{a} N_{\\mathrm{c},i}^{b}$. The minimized criterion is $\\sum_i \\left( Q_{\\mathrm{bin},i} - k\\, x_i \\right)^2$, whose solution is\n$$\nk^{\\star} = \\frac{\\sum_i Q_{\\mathrm{bin},i}\\, x_i}{\\sum_i x_i^2}.\n$$\n\nNumerical discretization for the bin-model integral:\n- Use a numerical quadrature over $r \\in [r_{\\min}, r_{\\mathrm{crit}}]$ with logarithmic spacing for accuracy across scales. Construct the $2$-dimensional integrand on the radius pair grid, apply the indicator mask, and integrate with the trapezoidal rule in both dimensions to approximate $R_{\\mathrm{auto,bin}}$.\n- Set $E_{\\mathrm{c}} = 1$ for simplicity, and assume the Stokes regime expression for $v_{\\mathrm{t}}(r)$ is valid across the considered droplet sizes.\n\nTest suite:\n- Fix exponents $a$ and $b$ as $a=2$ and $b=-1$.\n- Use $E_{\\mathrm{c}} = 1$ and $r_{\\min} = 10^{-7}\\ \\mathrm{m}$.\n- Each test case specifies $\\left(g,\\, \\rho_{\\mathrm{air}},\\, \\mu,\\, \\rho_{\\ell},\\, N_{\\mathrm{c}},\\, r_{\\mathrm{m}},\\, \\sigma_{\\mathrm{g}},\\, r_{\\mathrm{crit}} \\right)$:\n    - Case $1$ (general sub-Neptune methane cloud):\n        - $g = 9.0\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$, $\\rho_{\\mathrm{air}} = 0.2\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$, $\\mu = 8.0\\times 10^{-6}\\ \\mathrm{Pa}\\ \\mathrm{s}$, $\\rho_{\\ell} = 450\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$,\n        - $N_{\\mathrm{c}} = 1.0\\times 10^{8}\\ \\mathrm{m}^{-3}$, $r_{\\mathrm{m}} = 1.0\\times 10^{-5}\\ \\mathrm{m}$, $\\sigma_{\\mathrm{g}} = 1.4$, $r_{\\mathrm{crit}} = 3.0\\times 10^{-4}\\ \\mathrm{m}$.\n    - Case $2$ (lower gravity, slightly more viscous atmosphere):\n        - $g = 4.0\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$, $\\rho_{\\mathrm{air}} = 0.3\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$, $\\mu = 1.0\\times 10^{-5}\\ \\mathrm{Pa}\\ \\mathrm{s}$, $\\rho_{\\ell} = 450\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$,\n        - $N_{\\mathrm{c}} = 5.0\\times 10^{7}\\ \\mathrm{m}^{-3}$, $r_{\\mathrm{m}} = 8.0\\times 10^{-6}\\ \\mathrm{m}$, $\\sigma_{\\mathrm{g}} = 1.3$, $r_{\\mathrm{crit}} = 3.0\\times 10^{-4}\\ \\mathrm{m}$.\n    - Case $3$ (higher gravity, high droplet number, smaller threshold):\n        - $g = 12.0\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$, $\\rho_{\\mathrm{air}} = 0.1\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$, $\\mu = 6.0\\times 10^{-6}\\ \\mathrm{Pa}\\ \\mathrm{s}$, $\\rho_{\\ell} = 450\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$,\n        - $N_{\\mathrm{c}} = 1.0\\times 10^{9}\\ \\mathrm{m}^{-3}$, $r_{\\mathrm{m}} = 1.5\\times 10^{-5}\\ \\mathrm{m}$, $\\sigma_{\\mathrm{g}} = 1.6$, $r_{\\mathrm{crit}} = 2.5\\times 10^{-4}\\ \\mathrm{m}$.\n    - Case $4$ (edge case: very low gravity and narrow distribution):\n        - $g = 1.5\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$, $\\rho_{\\mathrm{air}} = 0.4\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$, $\\mu = 1.2\\times 10^{-5}\\ \\mathrm{Pa}\\ \\mathrm{s}$, $\\rho_{\\ell} = 450\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$,\n        - $N_{\\mathrm{c}} = 2.0\\times 10^{7}\\ \\mathrm{m}^{-3}$, $r_{\\mathrm{m}} = 5.0\\times 10^{-6}\\ \\mathrm{m}$, $\\sigma_{\\mathrm{g}} = 1.1$, $r_{\\mathrm{crit}} = 4.0\\times 10^{-4}\\ \\mathrm{m}$.\n\nRequired outputs and units:\n- Compute the least-squares $k^{\\star}$ across all test cases. Report $k^{\\star}$ as a float with units $\\mathrm{s}^{-1} \\times \\left( \\mathrm{kg}\\,\\mathrm{kg}^{-1} \\right)^{1-a} \\times \\mathrm{m}^{3b}$ using the specified $a$ and $b$.\n- For each case $i$, compute the residual\n$$\n\\Delta_i = Q_{\\mathrm{bulk},i} - Q_{\\mathrm{bin},i},\n$$\nexpressed in mixing ratio tendency units $(\\mathrm{kg}\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-1})$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, formatted as scientific notation with six digits after the decimal point, in the order\n$$\n\\left[ k^{\\star}, \\Delta_1, \\Delta_2, \\Delta_3, \\Delta_4 \\right].\n$$\n\nNumerical and algorithmic requirements:\n- Use a logarithmically spaced radius grid with at least $200$ points between $r_{\\min}$ and $r_{\\mathrm{crit}}$.\n- Use the trapezoidal rule in both dimensions for the bin-model double integral.\n- Ensure numerical stability by avoiding division by zero; if $Q_{\\mathrm{bin},i}$ is extremely small, residuals should still be computed as specified.\n- No external inputs are allowed; all parameter values are hard-coded from the test suite. The final printed line must be exactly the specified format.",
            "solution": "This problem requires calibrating a bulk autoconversion parameterization against a more fundamental bin-model calculation. The solution proceeds in several steps, which are executed for each of the four test cases provided.\n\nFirst, a numerical framework is established. For each case, a logarithmically spaced grid of 200 points is created for the droplet radius $r$, spanning from a minimum of $r_{\\min}=10^{-7}\\,\\mathrm{m}$ to the case-specific critical radius $r_{\\mathrm{crit}}$.\n\nSecond, for each radius on this discrete grid, several physical quantities are pre-calculated: the droplet mass $m(r)$, its terminal velocity $v_t(r)$ using the Stokes drag formula, and the number density $n(r)$ from the given lognormal distribution parameters.\n\nThird, the cloud water mixing ratio, $q_c$, is determined. This is done by numerically integrating the mass density of subcritical droplets, $M_c = \\int m(r) n(r) dr$, using the trapezoidal rule over the radius grid. The mixing ratio is then found via $q_c = M_c / \\rho_{\\mathrm{air}}$. This value, along with the total number concentration $N_c$, is used to compute the predictor term for the bulk parameterization, $x = q_c^a N_c^b$.\n\nFourth, the bin-model autoconversion tendency, $Q_{\\mathrm{bin}}$, is calculated. This is the most computationally intensive step, requiring the evaluation of a double integral over the droplet radius grid for the autoconversion mass rate, $R_{\\mathrm{auto,bin}}$. The integrand involves the collision kernel $K(r,r')$, the number densities $n(r)n(r')$, the summed mass $m(r)+m(r')$, and an indicator function that is 1 only if the collision produces a raindrop (i.e., $(r^3+r'^3)^{1/3} \\ge r_{\\mathrm{crit}}$). This 2D integral is computed numerically using a nested trapezoidal rule. The final tendency is then $Q_{\\mathrm{bin}} = R_{\\mathrm{auto,bin}}/\\rho_{\\mathrm{air}}$.\n\nFinally, after computing the pairs $(Q_{\\mathrm{bin}, i}, x_i)$ for all four test cases, the calibration coefficient $k^\\star$ is calculated using the provided least-squares formula: $k^{\\star} = (\\sum_i Q_{\\mathrm{bin},i}\\, x_i) / (\\sum_i x_i^2)$. With $k^\\star$ determined, the bulk model prediction $Q_{\\mathrm{bulk},i} = k^\\star x_i$ is found for each case, and the residuals $\\Delta_i = Q_{\\mathrm{bulk},i} - Q_{\\mathrm{bin},i}$ are computed. The final output consists of the calibrated coefficient $k^\\star$ and the four residuals, formatted as requested.",
            "answer": "[1.385311e-03,-4.298715e-11,2.062060e-10,-2.392067e-10,7.598782e-11]"
        }
    ]
}