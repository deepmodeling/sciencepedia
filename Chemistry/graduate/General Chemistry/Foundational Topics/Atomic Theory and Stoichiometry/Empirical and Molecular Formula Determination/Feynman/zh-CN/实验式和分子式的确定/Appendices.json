{
    "hands_on_practices": [
        {
            "introduction": "从元素质量组成确定实验式是化学中的一项基石技能。这第一个练习将引导你应用基本原理——摩尔概念和定比定律——将宏观的百分比数据转化为微观的原子比例，为所有后续的结构分析奠定坚实的基础。",
            "id": "2937627",
            "problem": "一种仅由碳、氢、氧组成的无水有机化合物经分析得到以下质量组成：碳 $54.528\\,\\%$，氢 $9.150\\,\\%$，氧 $36.322\\,\\%$。仅使用摩尔概念、定比定律和标准原子量，确定该化合物的实验式。为方便计算，设样本基准为 $100.0\\,\\mathrm{g}$。按碳、氢、氧的顺序，以有序三元组 $(n_{\\mathrm{C}}, n_{\\mathrm{H}}, n_{\\mathrm{O}})$ 的形式报告结果，其中每个 $n$ 是与数据一致的最小整数下标集。报告的三元组中不应包含单位。如果数据需要进行微小取整，请参考化学计量整数比进行说明。最终报告的三元组应由精确整数组成（由于最终结果为整数，因此无需指定有效数字的取整规则）。",
            "solution": "对问题进行验证。\n\n**已知条件：**\n- 一种无水有机化合物由碳（C）、氢（H）和氧（O）组成。\n- 质量组成：碳 $54.528\\,\\%$，氢 $9.150\\,\\%$，氧 $36.322\\,\\%$。\n- 计算时使用 $100.0\\,\\mathrm{g}$ 的样本基准。\n- 任务是确定实验式，表示为最小整数下标集 $(n_{\\mathrm{C}}, n_{\\mathrm{H}}, n_{\\mathrm{O}})$。\n\n**验证：**\n该问题是普通化学中的一个标准练习，要求根据质量百分比组成确定实验式。该问题有效，原因如下：\n1.  **科学依据：** 该解题过程基于化学的基本原理，即摩尔概念和定比定律。\n2.  **问题明确且一致：** 问题提供了所有必要数据。质量百分比之和为 $54.528\\,\\% + 9.150\\,\\% + 36.322\\,\\% = 100.000\\,\\%$，确保了数据的自洽性。目标陈述清晰，获得唯一解的路径明确。\n3.  **客观性：** 问题以精确的定量术语陈述，没有任何主观性或模糊性。\n\n因此，该问题被认定为**有效**，并将构建解答。\n\n化合物的实验式表示构成该化合物各元素的物质的量（摩尔）的最简整数比。解题步骤是将给定的质量百分比转换为质量，然后将质量转换为摩尔，最后确定这些摩尔量的最简整数比。\n\n按照说明，我们假设一个质量为 $100.0\\,\\mathrm{g}$ 的样本。此样本中各元素的质量在数值上等于其百分比。\n碳的质量，$m_{\\mathrm{C}} = 100.0\\,\\mathrm{g} \\times \\frac{54.528}{100} = 54.528\\,\\mathrm{g}$。\n氢的质量，$m_{\\mathrm{H}} = 100.0\\,\\mathrm{g} \\times \\frac{9.150}{100} = 9.150\\,\\mathrm{g}$。\n氧的质量，$m_{\\mathrm{O}} = 100.0\\,\\mathrm{g} \\times \\frac{36.322}{100} = 36.322\\,\\mathrm{g}$。\n\n各元素的物质的量 $n$ 可通过将其质量 $m$ 除以其标准原子量（摩尔质量）$M$ 来求得。所用标准原子量如下：\n碳的摩尔质量，$M_{\\mathrm{C}} = 12.011\\,\\mathrm{g/mol}$。\n氢的摩尔质量，$M_{\\mathrm{H}} = 1.008\\,\\mathrm{g/mol}$。\n氧的摩尔质量，$M_{\\mathrm{O}} = 15.999\\,\\mathrm{g/mol}$。\n\n各元素的摩尔数计算如下：\n碳的物质的量，$n_{\\mathrm{C}} = \\frac{m_{\\mathrm{C}}}{M_{\\mathrm{C}}} = \\frac{54.528\\,\\mathrm{g}}{12.011\\,\\mathrm{g/mol}} \\approx 4.5398\\,\\mathrm{mol}$。\n氢的物质的量，$n_{\\mathrm{H}} = \\frac{m_{\\mathrm{H}}}{M_{\\mathrm{H}}} = \\frac{9.150\\,\\mathrm{g}}{1.008\\,\\mathrm{g/mol}} \\approx 9.0774\\,\\mathrm{mol}$。\n氧的物质的量，$n_{\\mathrm{O}} = \\frac{m_{\\mathrm{O}}}{M_{\\mathrm{O}}} = \\frac{36.322\\,\\mathrm{g}}{15.999\\,\\mathrm{g/mol}} \\approx 2.2702\\,\\mathrm{mol}$。\n\n为确定最简摩尔比，我们将各元素的物质的量除以计算出的最小值，即 $n_{\\mathrm{O}} \\approx 2.2702\\,\\mathrm{mol}$。\n\n碳的比例：$\\frac{n_{\\mathrm{C}}}{n_{\\mathrm{O}}} = \\frac{4.5398}{2.2702} \\approx 1.9997$\n氢的比例：$\\frac{n_{\\mathrm{H}}}{n_{\\mathrm{O}}} = \\frac{9.0774}{2.2702} \\approx 3.9985$\n氧的比例：$\\frac{n_{\\mathrm{O}}}{n_{\\mathrm{O}}} = \\frac{2.2702}{2.2702} = 1.0000$\n\n计算出的摩尔比约为 $1.9997 : 3.9985 : 1.0000$。前两个比率与整数 $2$ 和 $4$ 的偏差极小（小于 $0.02\\,\\%$）。这种微小的差异是预料之中的，可归因于元素分析中固有的实验不确定性，而质量百分比正是从元素分析中得出的。因此，为了获得化学计量的整数比，取整到最近的整数在科学上是合理的。\n\nC:H:O 的最简整数摩尔比是 $2:4:1$。这对应于实验式 $\\mathrm{C_2H_4O}$。\n\n问题要求以整数下标的有序三元组 $(n_{\\mathrm{C}}, n_{\\mathrm{H}}, n_{\\mathrm{O}})$ 的形式给出答案。该三元组是 $(2, 4, 1)$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 2 & 4 & 1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "由于固有的不确定性，真实的实验数据很少能直接得到完美的整数比。这个练习模拟了一个更贴近现实的场景，你必须审慎地评估那些近似于简单分数的归一化摩尔比。你的任务是推导出正确的整数乘数，以揭示真实的化学计量关系，这是解读真实分析数据的一项关键技能。",
            "id": "2937598",
            "problem": "一种未知的电中性三元化合物仅含有碳、氢、氧三种元素。一台元素分析仪报告了以下的质量分数（每个值都是多次重复测量的平均值），其近似的独立绝对不确定度以一个标准差表示：碳 $34.46 \\pm 0.05\\,\\%$，氢 $4.33 \\pm 0.02\\,\\%$，氧 $61.21 \\pm 0.05\\,\\%$。假定这三种元素的总和在舍入误差范围内为 $100.00\\,\\%$。使用标准原子量：碳 $M_{\\mathrm{C}} = 12.011\\,\\mathrm{g\\,mol^{-1}}$，氢 $M_{\\mathrm{H}} = 1.008\\,\\mathrm{g\\,mol^{-1}}$，氧 $M_{\\mathrm{O}} = 15.999\\,\\mathrm{g\\,mol^{-1}}$。\n\n仅从物质的量（摩尔）、摩尔质量和质量分数的定义出发，通过将各元素的质量百分比转换为每 $100.00\\,\\mathrm{g}$ 样品中的摩尔数，并以最小的摩尔量进行归一化，推导出元素间的摩尔比 $r_{i}$。由于实验舍入和不确定度导致摩尔比接近分数值（例如，接近 $1.499$ 或 $1.333$ 的值），必须确定每个 $r_{i}$ 的正确有理数解释，并选择一个单一的整数乘数，以同时消除所有分数下标。\n\n通过将给定的质量分数不确定度视为独立的，并根据这些边界对归一化比率进行极值化，确定最小的正整数乘数 $N$。当将此乘数应用于归一化比率集时，会得到一组与所有不确定度区间相符的整数。仅报告此 $N$作为你的最终答案。由于 $N$ 是一个精确的整数，因此不需要舍入说明。",
            "solution": "该问题陈述已经过评估并被确定为有效。这是一个普通化学中的适定问题，基于既定的科学原理，具有完整且一致的数据集。它没有事实错误、伪科学和歧义。因此，我们可以进行严谨的求解。\n\n目标是确定最小的正整数 $N$，$N$ 可作为实验式 $\\mathrm{C}_{N}\\mathrm{H}_{y}\\mathrm{O}_{z}$ 中碳的原子下标，使得整数下标 $y$ 和 $z$ 与所提供的元素分析数据及其相关不确定度相符。\n\n基本定义如下：物质的量 $n$ 与质量 $m$ 和摩尔质量 $M$ 的关系由方程 $n = \\frac{m}{M}$ 给出。元素 $i$ 的质量分数 $\\omega_i$ 是该元素的质量 $m_i$ 与样品总质量 $m_{\\mathrm{total}}$ 的比值。对于一个假设的 $100.00\\,\\mathrm{g}$ 样品，每种元素的质量（以克为单位）在数值上等于其质量百分比。\n\n给定的数据是：\n碳的质量分数，$\\omega_{\\mathrm{C}} = (34.46 \\pm 0.05)\\,\\%$。\n氢的质量分数，$\\omega_{\\mathrm{H}} = (4.33 \\pm 0.02)\\,\\%$。\n氧的质量分数，$\\omega_{\\mathrm{O}} = (61.21 \\pm 0.05)\\,\\%$。\n碳的摩尔质量，$M_{\\mathrm{C}} = 12.011\\,\\mathrm{g\\,mol^{-1}}$。\n氢的摩尔质量，$M_{\\mathrm{H}} = 1.008\\,\\mathrm{g\\,mol^{-1}}$。\n氧的摩尔质量，$M_{\\mathrm{O}} = 15.999\\,\\mathrm{g\\,mol^{-1}}$。\n\n首先，我们使用质量分数的中心值计算 $100.00\\,\\mathrm{g}$ 样品中每种元素的物质的量（以摩尔为单位）。\n$n_{\\mathrm{C}} = \\frac{34.46\\,\\mathrm{g}}{12.011\\,\\mathrm{g\\,mol^{-1}}} \\approx 2.86898\\,\\mathrm{mol}$\n$n_{\\mathrm{H}} = \\frac{4.33\\,\\mathrm{g}}{1.008\\,\\mathrm{g\\,mol^{-1}}} \\approx 4.29563\\,\\mathrm{mol}$\n$n_{\\mathrm{O}} = \\frac{61.21\\,\\mathrm{g}}{15.999\\,\\mathrm{g\\,mol^{-1}}} \\approx 3.82586\\,\\mathrm{mol}$\n\n最小的摩尔量对应于碳。我们相对于 $n_{\\mathrm{C}}$ 对摩尔量进行归一化，以求得原子比。设实验式为 $\\mathrm{C}_{x}\\mathrm{H}_{y}\\mathrm{O}_{z}$。归一化后的实验比率 $r_{\\mathrm{H}}$ 和 $r_{\\mathrm{O}}$ 必须与理论比率 $y/x$ 和 $z/x$ 一致。\n$r_{\\mathrm{H}} = \\frac{n_{\\mathrm{H}}}{n_{\\mathrm{C}}} = \\frac{\\omega_{\\mathrm{H}}/M_{\\mathrm{H}}}{\\omega_{\\mathrm{C}}/M_{\\mathrm{C}}} = \\frac{\\omega_{\\mathrm{H}}}{\\omega_{\\mathrm{C}}} \\cdot \\frac{M_{\\mathrm{C}}}{M_{\\mathrm{H}}}$\n$r_{\\mathrm{O}} = \\frac{n_{\\mathrm{O}}}{n_{\\mathrm{C}}} = \\frac{\\omega_{\\mathrm{O}}/M_{\\mathrm{O}}}{\\omega_{\\mathrm{C}}/M_{\\mathrm{C}}} = \\frac{\\omega_{\\mathrm{O}}}{\\omega_{\\mathrm{C}}} \\cdot \\frac{M_{\\mathrm{C}}}{M_{\\mathrm{O}}}$\n\n为了考虑实验不确定度，我们必须确定这些比率的可能取值范围。质量分数的不确定度是独立的。为了求出比率的最小值，我们将分子最小化并将分母最大化。为了求出比率的最大值，我们将分子最大化并将分母最小化。\n\n质量分数的区间为：\n$\\omega_{\\mathrm{C}} \\in [34.46 - 0.05, 34.46 + 0.05] = [34.41, 34.51]$\n$\\omega_{\\mathrm{H}} \\in [4.33 - 0.02, 4.33 + 0.02] = [4.31, 4.35]$\n$\\omega_{\\mathrm{O}} \\in [61.21 - 0.05, 61.21 + 0.05] = [61.16, 61.26]$\n\n摩尔质量比被视为常数：\n$\\frac{M_{\\mathrm{C}}}{M_{\\mathrm{H}}} = \\frac{12.011}{1.008} \\approx 11.91567$\n$\\frac{M_{\\mathrm{C}}}{M_{\\mathrm{O}}} = \\frac{12.011}{15.999} \\approx 0.750734$\n\n现在我们计算归一化摩尔比的极值。\n对于氢碳比 $r_{\\mathrm{H}}$：\n$r_{\\mathrm{H, min}} = \\frac{\\omega_{\\mathrm{H, min}}}{\\omega_{\\mathrm{C, max}}} \\cdot \\frac{M_{\\mathrm{C}}}{M_{\\mathrm{H}}} = \\frac{4.31}{34.51} \\cdot \\frac{12.011}{1.008} \\approx 1.4880$\n$r_{\\mathrm{H, max}} = \\frac{\\omega_{\\mathrm{H, max}}}{\\omega_{\\mathrm{C, min}}} \\cdot \\frac{M_{\\mathrm{C}}}{M_{\\mathrm{H}}} = \\frac{4.35}{34.41} \\cdot \\frac{12.011}{1.008} \\approx 1.5064$\n因此，真实的 H:C 比必须位于区间 $[1.4880, 1.5064]$ 内。\n\n对于氧碳比 $r_{\\mathrm{O}}$：\n$r_{\\mathrm{O, min}} = \\frac{\\omega_{\\mathrm{O, min}}}{\\omega_{\\mathrm{C, max}}} \\cdot \\frac{M_{\\mathrm{C}}}{M_{\\mathrm{O}}} = \\frac{61.16}{34.51} \\cdot \\frac{12.011}{15.999} \\approx 1.3304$\n$r_{\\mathrm{O, max}} = \\frac{\\omega_{\\mathrm{O, max}}}{\\omega_{\\mathrm{C, min}}} \\cdot \\frac{M_{\\mathrm{C}}}{M_{\\mathrm{O}}} = \\frac{61.26}{34.41} \\cdot \\frac{12.011}{15.999} \\approx 1.3365$\n因此，真实的 O:C 比必须位于区间 $[1.3304, 1.3365]$ 内。\n\n我们正在寻找最小的正整数 $N$ （碳的下标），使得存在整数 $y$ 和 $z$ 满足：\n$\\frac{y}{N} \\in [1.4880, 1.5064] \\implies y \\in [N \\times 1.4880, N \\times 1.5064]$\n$\\frac{z}{N} \\in [1.3304, 1.3365] \\implies z \\in [N \\times 1.3304, N \\times 1.3365]$\n\n我们从 $N=1$ 开始测试 $N$ 的值：\n对于 $N=1$：\n$y \\in [1.4880, 1.5064]$。此区间不含整数。\n$z \\in [1.3304, 1.3365]$。此区间不含整数。\n因此，$N=1$ 不是一个有效的乘数。\n\n对于 $N=2$：\n$y \\in [2 \\times 1.4880, 2 \\times 1.5064] = [2.976, 3.0128]$。此区间包含整数 $y=3$。比值为 $\\frac{3}{2}=1.5$，在界限内。\n$z \\in [2 \\times 1.3304, 2 \\times 1.3365] = [2.6608, 2.6730]$。此区间不含整数。\n因此，$N=2$ 不是一个有效的乘数。\n\n对于 $N=3$：\n$y \\in [3 \\times 1.4880, 3 \\times 1.5064] = [4.464, 4.5192]$。此区间不含整数。\n$z \\in [3 \\times 1.3304, 3 \\times 1.3365] = [3.9912, 4.0095]$。此区间包含整数 $z=4$。比值为 $\\frac{4}{3} \\approx 1.3333$，在界限内。\n因此，$N=3$ 不是一个有效的乘数，因为它对氢不成立。\n\n对于 $N=4$：\n$y \\in [4 \\times 1.4880, 4 \\times 1.5064] = [5.952, 6.0256]$。此区间包含整数 $y=6$。\n$z \\in [4 \\times 1.3304, 4 \\times 1.3365] = [5.3216, 5.3460]$。此区间不含整数。\n因此，$N=4$ 不是一个有效的乘数。\n\n对于 $N=5$：\n$y \\in [5 \\times 1.4880, 5 \\times 1.5064] = [7.440, 7.532]$。此区间不含整数。\n$z \\in [5 \\times 1.3304, 5 \\times 1.3365] = [6.652, 6.6825]$。此区间不含整数。\n因此，$N=5$ 不是一个有效的乘数。\n\n对于 $N=6$：\n$y \\in [6 \\times 1.4880, 6 \\times 1.5064] = [8.928, 9.0384]$。此区间包含整数 $y=9$。\n$z \\in [6 \\times 1.3304, 6 \\times 1.3365] = [7.9824, 8.0190]$。此区间包含整数 $z=8$。\n对于 $N=6$，两个条件都满足。相应的有理比为 $\\frac{y}{N} = \\frac{9}{6} = 1.5$ 和 $\\frac{z}{N} = \\frac{8}{6} = \\frac{4}{3} \\approx 1.3333$。这两个值都位于各自的不确定度区间内。\n\n由于 $N=1, 2, 3, 4, 5$ 都未能同时为两个比率提供整数解，因此 $N=6$ 是能得出与实验数据及其指定不确定度相符的实验式（$\\mathrm{C}_6\\mathrm{H}_9\\mathrm{O}_8$）的最小正整数乘数。",
            "answer": "$$\\boxed{6}$$"
        },
        {
            "introduction": "现代分析化学越来越依赖计算方法来解析来自高分辨率质谱仪等仪器的复杂数据集。这项综合性练习挑战你开发一个程序，通过同时应用多个约束条件——精确质量、双键当量（$DBE$）和元素组成——来识别候选分子式。这个练习让你亲身体验支撑当代化合物鉴定的强大算法驱动逻辑。",
            "id": "2937652",
            "problem": "实现一个程序，对元素 $\\{C,H,N,O,S,Cl\\}$ 的整数原子数进行有界的穷举搜索，以确定所有同时满足精确单同位素质量、双键当量（double bond equivalent (DBE)）和元素质量分数约束的分子式。您的程序必须从基本定义和经过充分检验的公式开始：\n\n- 精确单同位素质量：对于一个候选的整数原子数向量 $\\mathbf{n} = [n_C,n_H,n_N,n_O,n_S,n_{Cl}]$，其精确质量 $m(\\mathbf{n})$ 是各项元素的原子数与其单同位素质量乘积之和。请使用以下单同位素质量（单位为统一原子质量单位，也称为道尔顿）：$m_C = 12.00000000000$, $m_H = 1.00782503223$, $m_N = 14.00307400443$, $m_O = 15.99491461957$, $m_S = 31.97207117440$, $m_{Cl} = 34.96885268200$。\n- 双键当量 (DBE)：对于一个候选分子式 $\\mathbf{n}$，基于缺氢指数计算DBE，公式如下：\n$$\\mathrm{DBE}(\\mathbf{n}) = \\frac{2\\,n_C + 2 + n_N - n_H - n_{X}}{2},$$\n其中 $n_X$ 是单价卤素原子的总数。在本问题中，$n_X = n_{Cl}$。化学上有效的解必须满足 $\\mathrm{DBE}(\\mathbf{n})$ 是一个非负整数。\n- 元素 $E$ 的元素质量分数定义为 $w_E(\\mathbf{n}) = \\frac{n_E\\,m_E}{m(\\mathbf{n})}$。必须将该分数与特定案例的闭区间进行比较。所有分数都必须以小数形式表示（不带百分号）。\n\n您的程序必须：\n\n1. 枚举所有 $\\mathbf{n}$，其中每个 $n_E$ 都被限制在特定案例的整数边界 $0 \\le n_E \\le n_E^{\\max}$ 内。\n2. 对于每个 $\\mathbf{n}$，计算所有元素 $E \\in \\{C,H,N,O,S,Cl\\}$ 的 $m(\\mathbf{n})$、$\\mathrm{DBE}(\\mathbf{n})$ 和 $w_E(\\mathbf{n})$。\n3. 当且仅当以下所有条件同时成立时，才将 $\\mathbf{n}$ 接受为测试案例的解：\n   - 精确质量在指定的绝对公差范围内：$|m(\\mathbf{n}) - m_{\\mathrm{target}}| \\le \\Delta m$，其中 $m_{\\mathrm{target}}$ 和 $\\Delta m$ 均为给定值。\n   - DBE 位于闭整数区间 $[\\mathrm{DBE}_{\\min}, \\mathrm{DBE}_{\\max}]$ 内，且为一个整数。\n   - 对于每个元素 $E$，其元素质量分数满足 $w_E^{\\min} \\le w_E(\\mathbf{n}) \\le w_E^{\\max}$，其中边界是为每个元素分别提供的。\n\n对于每个测试案例，返回所有解，形式为一个按字典序排序的原子数列表的列表 $[n_C,n_H,n_N,n_O,n_S,n_{Cl}]$。\n\n物理和数值单位：精确质量和公差必须以道尔顿为单位处理。DBE 是无单位的。元素质量分数是位于 $[0,1]$ 区间的无单位小数。\n\n角度单位在此处不相关。\n\n最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，且不含空格。每个条目对应一个测试案例的解集，表示为一个整数列表的列表。例如，一个两案例的运行，第一个案例返回一个解，第二个案例无解，其输出必须如下所示：`[[[2,5,1,2,0,0]],[]]`。\n\n测试套件和答案规范：使用以下四个案例，它们共同探查了一个典型的匹配案例、一个卤代案例、一个富含杂原子的案例以及一个不可行的边界案例。所有数值均为闭区间，且必须包含边界值。\n\n- 所有案例共用的常量：\n  - 单同位素质量 (道尔顿): $m_C = 12.00000000000$, $m_H = 1.00782503223$, $m_N = 14.00307400443$, $m_O = 15.99491461957$, $m_S = 31.97207117440$, $m_{Cl} = 34.96885268200$。\n\n- 案例 1 (含氮氧的小分子):\n  - 目标质量和公差: $m_{\\mathrm{target}} = 75.03202840472$, $\\Delta m = 0.0005$。\n  - DBE 范围: $\\mathrm{DBE}_{\\min} = 1$, $\\mathrm{DBE}_{\\max} = 1$。\n  - 元素质量分数边界 $(w_E^{\\min},w_E^{\\max})$:\n    - $C$: $(0.319, 0.321)$，\n    - $H$: $(0.0665, 0.0680)$，\n    - $N$: $(0.186, 0.187)$，\n    - $O$: $(0.425, 0.428)$，\n    - $S$: $(0.000, 0.010)$，\n    - $Cl$: $(0.000, 0.010)$。\n  - 原子数上限 $n_E^{\\max}$:\n    - $C$: $10$, $H$: $20$, $N$: $4$, $O$: $10$, $S$: $2$, $Cl$: $2$。\n\n- 案例 2 (二卤代烃):\n  - 目标质量和公差: $m_{\\mathrm{target}} = 97.96900549292$, $\\Delta m = 0.0005$。\n  - DBE 范围: $\\mathrm{DBE}_{\\min} = 0$, $\\mathrm{DBE}_{\\max} = 0$。\n  - 元素质量分数边界:\n    - $C$: $(0.245, 0.246)$，\n    - $H$: $(0.0410, 0.0415)$，\n    - $N$: $(0.000, 0.010)$，\n    - $O$: $(0.000, 0.010)$，\n    - $S$: $(0.000, 0.010)$，\n    - $Cl$: $(0.713, 0.7145)$。\n  - 原子数上限:\n    - $C$: $4$, $H$: $8$, $N$: $2$, $O$: $2$, $S$: $1$, $Cl$: $3$。\n\n- 案例 3 (硫化羰):\n  - 目标质量和公差: $m_{\\mathrm{target}} = 59.96698579397$, $\\Delta m = 0.0005$。\n  - DBE 范围: $\\mathrm{DBE}_{\\min} = 2$, $\\mathrm{DBE}_{\\max} = 2$。\n  - 元素质量分数边界:\n    - $C$: $(0.200, 0.201)$，\n    - $H$: $(0.000, 0.010)$，\n    - $N$: $(0.000, 0.010)$，\n    - $O$: $(0.2663, 0.2670)$，\n    - $S$: $(0.533, 0.534)$，\n    - $Cl$: $(0.000, 0.010)$。\n  - 原子数上限:\n    - $C$: $3$, $H$: $2$, $N$: $2$, $O$: $3$, $S$: $2$, $Cl$: $1$。\n\n- 案例 4 (不可行边界):\n  - 目标质量和公差: $m_{\\mathrm{target}} = 200.00000000000$, $\\Delta m = 0.0010$。\n  - DBE 范围: $\\mathrm{DBE}_{\\min} = 0$, $\\mathrm{DBE}_{\\max} = 5$。\n  - 元素质量分数边界:\n    - $C$: $(0.000, 1.000)$，\n    - $H$: $(0.000, 1.000)$，\n    - $N$: $(0.000, 1.000)$，\n    - $O$: $(0.000, 1.000)$，\n    - $S$: $(0.000, 1.000)$，\n    - $Cl$: $(0.000, 1.000)$。\n  - 原子数上限:\n    - $C$: $1$, $H$: $1$, $N$: $1$, $O$: $1$, $S$: $1$, $Cl$: $1$。\n\n您的程序必须按所列顺序评估这四个案例，并生成包含该顺序解集列表的单行输出，其格式如上所述，不含空格。每个独立的解都是一个包含六个整数的列表，元素顺序为 $\\{C,H,N,O,S,Cl\\}$。",
            "solution": "问题陈述已经过评估并被确定为有效。它在分析化学领域，特别是在根据质谱数据确定分子式方面，提出了一个定义明确的计算任务。该问题具有科学依据、内部一致，并要求实现一个带约束的穷举搜索算法。所提供的物理常数、数学公式和约束条件清晰且充分，足以推导出每个测试案例的一组唯一解。在区间表示上存在一个微小的记法歧义，即使用括号表示法来表示明确定义为闭合、包含边界的区间。这是一个表述上的微不足道的缺陷，而非逻辑错误，并且关于包含性的明确指令提供了清晰的说明。我们将着手进行求解。\n\n该问题要求识别所有可能的分子式（表示为原子计数的整数向量 $\\mathbf{n} = [n_C, n_H, n_N, n_O, n_S, n_{Cl}]$），这些分子式需要同时满足一组关于精确质量、双键当量和元素质量分数的给定约束。对每个元素 $E$ 的原子数 $n_E$ 的搜索空间受特定案例的上限 $0 \\le n_E \\le n_E^{\\max}$ 限制。该搜索空间的有限性使得穷举搜索（或称暴力枚举）成为一种可行且正确的策略。\n\n算法将按以下步骤进行：\n\n1.  **遍历测试案例**：程序将系统地处理所提供的四个测试案例中的每一个。对于每个案例，都使用特定的约束条件（$m_{\\mathrm{target}}$, $\\Delta m$, $[\\mathrm{DBE}_{\\min}, \\mathrm{DBE}_{\\max}]$, $\\{w_E^{\\min}, w_E^{\\max}\\}$ 和 $\\{n_E^{\\max}\\}$）。\n\n2.  **生成候选分子式**：对于给定的测试案例，生成所有可能的候选向量 $\\mathbf{n}$。这是一个组合问题，通过将每个 $n_C$ 从 $0$ 到 $n_C^{\\max}$ 迭代，每个 $n_H$ 从 $0$ 到 $n_H^{\\max}$ 迭代，并对所有六种元素依此类推。这定义了一个六维整数点搜索网格。\n\n3.  **应用约束过滤器**：每个候选向量 $\\mathbf{n}$ 都会经过一系列验证检查。一个候选向量必须通过所有检查才能被视为一个解。这些检查按一定顺序进行，以便尽早排除不满足条件的候选者，从而最大化计算效率。\n\n    a. **质量过滤器**：使用提供的公式计算精确单同位素质量 $m(\\mathbf{n})$：\n    $$m(\\mathbf{n}) = \\sum_{E \\in \\{C,H,N,O,S,Cl\\}} n_E m_E$$\n    其中 $m_E$ 是给定的单同位素质量。只有当一个候选者的质量落在指定的公差窗口内时，才会保留以进行进一步处理：\n    $$|m(\\mathbf{n}) - m_{\\mathrm{target}}| \\le \\Delta m$$\n    总质量 $m(\\mathbf{n})=0$ 的候选者（即零分子式 $\\mathbf{n}=[0,0,0,0,0,0]$）会被固有地拒绝，因为所有目标质量均为正数。此检查还能防止后续质量分数计算中出现除以零的情况。\n\n    b. **双键当量 (DBE) 过滤器**：对于通过质量过滤器的候选者，计算其DBE：\n    $$\\mathrm{DBE}(\\mathbf{n}) = \\frac{2n_C + 2 + n_N - n_H - n_{Cl}}{2}$$\n    对于一个化学上有效的分子式，$\\mathrm{DBE}(\\mathbf{n})$ 必须是一个非负整数。这意味着分子 $2n_C + 2 + n_N - n_H - n_{Cl}$ 必须是一个非负偶数。此外，得到的DBE值必须位于指定的闭区间 $[\\mathrm{DBE}_{\\min}, \\mathrm{DBE}_{\\max}]$ 内。\n\n    c. **元素质量分数过滤器**：对于通过质量和DBE过滤器的候选者，计算每个元素 $E$ 的元素质量分数 $w_E(\\mathbf{n})$：\n    $$w_E(\\mathbf{n}) = \\frac{n_E m_E}{m(\\mathbf{n})}$$\n    每个计算出的分数 $w_E(\\mathbf{n})$ 必须落在其指定的闭区间 $[w_E^{\\min}, w_E^{\\max}]$ 内。只有当此条件对所有六种元素都成立时，一个候选者才被接受为最终解。\n\n4.  **收集并排序解**：收集当前测试案例中所有满足全部三个过滤器的候选向量 $\\mathbf{n}$。然后按要求对此解列表进行字典序排序。\n\n5.  **格式化输出**：最终结果是一个列表，其中包含四个测试案例各自的已排序解列表。此结果被格式化为严格遵循指定格式的、无空白字符的单个字符串。对于没有产生任何解的案例，则用一个空列表表示。\n\n这种系统的枚举和过滤方法保证能够找到已定义搜索空间内的所有解，并且不会包含任何无效的分子式。实现中将使用高精度浮点运算以确保数值的正确性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport itertools\n\ndef solve():\n    \"\"\"\n    Performs an exhaustive search for molecular formulae satisfying constraints\n    on mass, DBE, and elemental composition.\n    \"\"\"\n    \n    # Fundamental constants\n    # Monoisotopic masses (daltons) for C, H, N, O, S, Cl\n    MONOISOTOPIC_MASSES = np.array([\n        12.00000000000,    # C\n        1.00782503223,     # H\n        14.00307400443,    # N\n        15.99491461957,    # O\n        31.97207117440,    # S\n        34.96885268200     # Cl\n    ])\n    \n    # Test cases defined as a list of dictionaries.\n    test_cases = [\n        # Case 1: nitrogen-oxygen small molecule\n        {\n            'm_target': 75.03202840472, 'delta_m': 0.0005,\n            'dbe_range': (1, 1),\n            'w_bounds': [\n                (0.319, 0.321),    # C\n                (0.0665, 0.0680),  # H\n                (0.186, 0.187),    # N\n                (0.425, 0.428),    # O\n                (0.000, 0.010),    # S\n                (0.000, 0.010)     # Cl\n            ],\n            'n_max': [10, 20, 4, 10, 2, 2]\n        },\n        # Case 2: dihalogenated hydrocarbon\n        {\n            'm_target': 97.96900549292, 'delta_m': 0.0005,\n            'dbe_range': (0, 0),\n            'w_bounds': [\n                (0.245, 0.246),    # C\n                (0.0410, 0.0415),  # H\n                (0.000, 0.010),    # N\n                (0.000, 0.010),    # O\n                (0.000, 0.010),    # S\n                (0.713, 0.7145)    # Cl\n            ],\n            'n_max': [4, 8, 2, 2, 1, 3]\n        },\n        # Case 3: carbonyl sulfide\n        {\n            'm_target': 59.96698579397, 'delta_m': 0.0005,\n            'dbe_range': (2, 2),\n            'w_bounds': [\n                (0.200, 0.201),    # C\n                (0.000, 0.010),    # H\n                (0.000, 0.010),    # N\n                (0.2663, 0.2670),  # O\n                (0.533, 0.534),    # S\n                (0.000, 0.010)     # Cl\n            ],\n            'n_max': [3, 2, 2, 3, 2, 1]\n        },\n        # Case 4: infeasible bounds\n        {\n            'm_target': 200.00000000000, 'delta_m': 0.0010,\n            'dbe_range': (0, 5),\n            'w_bounds': [\n                (0.000, 1.000),    # C\n                (0.000, 1.000),    # H\n                (0.000, 1.000),    # N\n                (0.000, 1.000),    # O\n                (0.000, 1.000),    # S\n                (0.000, 1.000)     # Cl\n            ],\n            'n_max': [1, 1, 1, 1, 1, 1]\n        }\n    ]\n\n    all_cases_results = []\n\n    for case in test_cases:\n        m_target, delta_m = case['m_target'], case['delta_m']\n        dbe_min, dbe_max = case['dbe_range']\n        w_bounds = case['w_bounds']\n        n_max = case['n_max']\n        \n        # Generate candidate atom counts using itertools.product\n        count_ranges = [range(n + 1) for n in n_max]\n        candidates = itertools.product(*count_ranges)\n        \n        found_solutions = []\n        \n        for counts_tuple in candidates:\n            # Trivial case of no atoms has zero mass and undefined fractions\n            if sum(counts_tuple) == 0:\n                continue\n\n            counts = np.array(counts_tuple)\n            \n            # --- Filter 1: Exact Mass ---\n            total_mass = np.dot(counts, MONOISOTOPIC_MASSES)\n            if not (m_target - delta_m = total_mass = m_target + delta_m):\n                continue\n                \n            # --- Filter 2: Double Bond Equivalent (DBE) ---\n            nC, nH, nN, nO, nS, nCl = counts_tuple\n            dbe_numerator = 2 * nC + 2 + nN - nH - nCl\n            \n            # DBE must be a non-negative integer\n            if dbe_numerator  0 or dbe_numerator % 2 != 0:\n                continue\n            \n            dbe = dbe_numerator // 2\n            if not (dbe_min = dbe = dbe_max):\n                continue\n            \n            # --- Filter 3: Elemental Mass Fractions ---\n            # This check is last as it's the most computationally expensive.\n            mass_fractions = (counts * MONOISOTOPIC_MASSES) / total_mass\n            \n            all_fractions_valid = True\n            for i in range(len(counts)):\n                w_min, w_max = w_bounds[i]\n                if not (w_min = mass_fractions[i] = w_max):\n                    all_fractions_valid = False\n                    break\n            \n            if all_fractions_valid:\n                found_solutions.append(list(counts))\n\n        # Sort solutions lexicographically\n        found_solutions.sort()\n        all_cases_results.append(found_solutions)\n        \n    # Format the final output string precisely as required (no spaces)\n    outer_parts = []\n    for case_solutions in all_cases_results:\n        if not case_solutions:\n            outer_parts.append('[]')\n        else:\n            inner_parts = []\n            for sol in case_solutions:\n                inner_parts.append(f\"[{','.join(map(str, sol))}]\")\n            outer_parts.append(f\"[{','.join(inner_parts)}]\")\n    \n    final_output = f\"[{','.join(outer_parts)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}