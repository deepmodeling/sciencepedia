{
    "hands_on_practices": [
        {
            "introduction": "熵作为一个状态函数，其绝对值是如何确定的？本实践将基于热力学第三定律，通过一个具体的计算任务来回答这个问题。你将学习如何利用实验测得的热容数据和相变焓，通过积分和求和来计算一个物质在特定温度下的标准摩尔熵，从而将抽象的熵概念与宏观可测的物理量紧密联系起来。",
            "id": "2938089",
            "problem": "一种假设的分子物质，记为 Q，在标准大气压下，被观察到从绝对零度到室温经历了一系列平衡态。假设热力学第三定律完全适用于 Q，即，在绝对零度时其摩尔熵为零，不存在残余构型熵，且所有相变均在其平衡温度下可逆地发生。请仅使用基本定义和源于可逆变换的成熟关系式来确定在 $298\\ \\mathrm{K}$ 时的绝对摩尔熵。\n\n在 $1\\ \\mathrm{bar}$ 压力下，所测得的 Q 的恒压摩尔热容 $C_p(T)$ 在指定温度区间内可由以下表达式可靠地表示：\n-对于低温固态多晶型物 $\\alpha$，在 $0 \\le T  100\\ \\mathrm{K}$ 区间内：$C_{p,\\alpha,s}(T) = \\alpha_s T^{3}$，其中 $\\alpha_s = 1.00 \\times 10^{-5}\\ \\mathrm{J\\ mol^{-1}\\ K^{-4}}$。\n- 在 $T = 100\\ \\mathrm{K}$ 时，发生一级固-固相变 $\\alpha \\to \\beta$，其摩尔相变焓为 $\\Delta H_{\\alpha\\to\\beta} = 320\\ \\mathrm{J\\ mol^{-1}}$。\n- 对于高温固态多晶型物 $\\beta$，在 $100 \\le T  250\\ \\mathrm{K}$ 区间内：$C_{p,\\beta,s}(T) = a_s + b_s T$，其中 $a_s = 12.0\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$ 且 $b_s = 0.0300\\ \\mathrm{J\\ mol^{-1}\\ K^{-2}}$。\n- 在 $T = 250\\ \\mathrm{K}$ 时，Q 发生可逆熔化，其摩尔熔化焓为 $\\Delta H_{\\mathrm{fus}} = 6.20 \\times 10^{3}\\ \\mathrm{J\\ mol^{-1}}$。\n- 对于液相，在 $250 \\le T \\le 298\\ \\mathrm{K}$ 区间内：$C_{p,l}(T) = c_l + d_l T$，其中 $c_l = 28.0\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$ 且 $d_l = 0.0200\\ \\mathrm{J\\ mol^{-1}\\ K^{-2}}$。\n\n所有数据均以国际单位制（SI）给出。请将 $C_p(T)$ 在指定范围内视为平滑且准确的，忽略任何磁性或有序化反常，并假设每一步均沿平衡路径进行。计算 Q 在 $298\\ \\mathrm{K}$ 时的绝对摩尔熵。\n\n将您的最终答案四舍五入至四位有效数字，并以 $\\mathrm{J\\ mol^{-1}\\ K^{-1}}$ 为单位表示。",
            "solution": "该问题要求计算物质 Q 在温度为 $298\\ \\mathrm{K}$ 时的绝对摩尔熵。计算基于热力学第三定律，该定律假定理想晶体物质在绝对零度时的熵为零，即 $S_m(0) = 0$。在有限温度 $T$ 下的绝对熵则通过对从 $0\\ \\mathrm{K}$到 $T$ 的熵变进行积分来求得。\n\n对于恒压过程，可逆温度变化引起的摩尔熵的微小变化量 $dS_m$ 由 $dS_m = \\frac{C_p(T)}{T} dT$ 给出，其中 $C_p(T)$ 是恒压摩尔热容。对于在恒定温度 $T_{tr}$ 下发生的可逆相变，摩尔熵变为 $\\Delta S_{tr} = \\frac{\\Delta H_{tr}}{T_{tr}}$，其中 $\\Delta H_{tr}$ 是摩尔相变焓。\n\n在 $298\\ \\mathrm{K}$ 下的总绝对摩尔熵 $S_m(298\\ \\mathrm{K})$ 是从 $S_m(0) = 0$ 开始，将物质加热通过其各个相的熵贡献与每次相变时的熵变之和。从 $0\\ \\mathrm{K}$到 $298\\ \\mathrm{K}$ 的路径如下：\n1. 将固态多晶型物 $\\alpha$ 从 $0\\ \\mathrm{K}$ 加热到 $100\\ \\mathrm{K}$。\n2. 在 $100\\ \\mathrm{K}$ 时的固-固相变 $\\alpha \\to \\beta$。\n3. 将固态多晶型物 $\\beta$ 从 $100\\ \\mathrm{K}$ 加热到 $250\\ \\mathrm{K}$。\n4. 在 $250\\ \\mathrm{K}$ 时的固-液相变（熔化）。\n5. 将液相从 $250\\ \\mathrm{K}$ 加热到 $298\\ \\mathrm{K}$。\n\n总熵是这五个步骤的熵变之和：\n$$S_m(298\\ \\mathrm{K}) = \\Delta S_1 + \\Delta S_2 + \\Delta S_3 + \\Delta S_4 + \\Delta S_5$$\n\n每一项的计算如下：\n\n步骤 1：将固相 $\\alpha$ 从 $T = 0\\ \\mathrm{K}$ 加热到 $T = 100\\ \\mathrm{K}$ 的熵变。\n热容由 $C_{p,\\alpha,s}(T) = \\alpha_s T^{3}$ 给出，其中 $\\alpha_s = 1.00 \\times 10^{-5}\\ \\mathrm{J\\ mol^{-1}\\ K^{-4}}$。\n$$\\Delta S_1 = \\int_{0}^{100} \\frac{C_{p,\\alpha,s}(T)}{T} dT = \\int_{0}^{100} \\frac{\\alpha_s T^{3}}{T} dT = \\int_{0}^{100} \\alpha_s T^{2} dT$$\n$$\\Delta S_1 = \\alpha_s \\left[ \\frac{T^3}{3} \\right]_{0}^{100} = (1.00 \\times 10^{-5})\\frac{(100)^3 - 0^3}{3} = \\frac{1.00 \\times 10^{-5} \\times 10^6}{3} = \\frac{10}{3}\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$$\n$$\\Delta S_1 \\approx 3.3333\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$$\n\n步骤 2：在 $T_{tr} = 100\\ \\mathrm{K}$ 时固-固相变 $\\alpha \\to \\beta$ 的熵变。\n相变焓为 $\\Delta H_{\\alpha\\to\\beta} = 320\\ \\mathrm{J\\ mol^{-1}}$。\n$$\\Delta S_2 = \\frac{\\Delta H_{\\alpha\\to\\beta}}{T_{tr}} = \\frac{320}{100} = 3.20\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$$\n\n步骤 3：将固相 $\\beta$ 从 $T = 100\\ \\mathrm{K}$ 加热到 $T = 250\\ \\mathrm{K}$ 的熵变。\n热容为 $C_{p,\\beta,s}(T) = a_s + b_s T$，其中 $a_s = 12.0\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$ 且 $b_s = 0.0300\\ \\mathrm{J\\ mol^{-1}\\ K^{-2}}$。\n$$\\Delta S_3 = \\int_{100}^{250} \\frac{C_{p,\\beta,s}(T)}{T} dT = \\int_{100}^{250} \\frac{a_s + b_s T}{T} dT = \\int_{100}^{250} \\left( \\frac{a_s}{T} + b_s \\right) dT$$\n$$\\Delta S_3 = [a_s \\ln(T) + b_s T]_{100}^{250} = a_s \\ln\\left(\\frac{250}{100}\\right) + b_s(250 - 100)$$\n$$\\Delta S_3 = 12.0 \\ln(2.5) + (0.0300)(150) = 12.0 \\times 0.91629 + 4.5 = 10.9955 + 4.5 = 15.4955\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$$\n\n步骤 4：在 $T_{fus} = 250\\ \\mathrm{K}$ 时熔化的熵变。\n熔化焓为 $\\Delta H_{\\mathrm{fus}} = 6.20 \\times 10^{3}\\ \\mathrm{J\\ mol^{-1}}$。\n$$\\Delta S_4 = \\frac{\\Delta H_{\\mathrm{fus}}}{T_{fus}} = \\frac{6.20 \\times 10^{3}}{250} = 24.8\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$$\n\n步骤 5：将液相从 $T = 250\\ \\mathrm{K}$ 加热到 $T = 298\\ \\mathrm{K}$ 的熵变。\n热容为 $C_{p,l}(T) = c_l + d_l T$，其中 $c_l = 28.0\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$ 且 $d_l = 0.0200\\ \\mathrm{J\\ mol^{-1}\\ K^{-2}}$。\n$$\\Delta S_5 = \\int_{250}^{298} \\frac{C_{p,l}(T)}{T} dT = \\int_{250}^{298} \\frac{c_l + d_l T}{T} dT = \\int_{250}^{298} \\left( \\frac{c_l}{T} + d_l \\right) dT$$\n$$\\Delta S_5 = [c_l \\ln(T) + d_l T]_{250}^{298} = c_l \\ln\\left(\\frac{298}{250}\\right) + d_l(298 - 250)$$\n$$\\Delta S_5 = 28.0 \\ln(1.192) + (0.0200)(48) = 28.0 \\times 0.17565 + 0.96 = 4.9182 + 0.96 = 5.8782\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$$\n\n在 $298\\ \\mathrm{K}$ 时的总绝对摩尔熵：\n将各部分贡献相加：\n$$S_m(298\\ \\mathrm{K}) = \\Delta S_1 + \\Delta S_2 + \\Delta S_3 + \\Delta S_4 + \\Delta S_5$$\n$$S_m(298\\ \\mathrm{K}) = (3.3333 + 3.20 + 15.4955 + 24.8 + 5.8782)\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$$\n$$S_m(298\\ \\mathrm{K}) = 52.707\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$$\n\n根据题目要求，将最终答案四舍五入至四位有效数字，得到 $52.71\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$。",
            "answer": "$$\\boxed{52.71}$$"
        },
        {
            "introduction": "当不同组分相遇时，熵会如何变化？本练习将我们的讨论从单一组分体系扩展到多组分混合物，探讨理想气体混合这一经典的自发过程。通过从第一性原理出发推导混合熵 $\\Delta S_{\\text{mix}}$ 的表达式，你将亲身体验热力学第二定律的实际应用，并深入理解区分粒子与不可区分粒子在统计意义上的根本差异，即吉布斯佯谬。",
            "id": "2680115",
            "problem": "两种理想气体，组分 $A$ 和 $B$，被包含在一个带有绝热壁的刚性容器中。一块薄的、不可渗透的隔板将容器分成两个体积分别为 $V_{A}^{0}$ 和 $V_{B}^{0}$ 的隔间。每个隔间只含有一种组分，其物质的量分别为 $n_{A} = 1.20$ 摩尔和 $n_{B} = 2.80$ 摩尔。最初，两个隔间都处于相同的温度 $T$ 和压力 $P$ 下，并且每个隔间在其自身的体积 $V_{i}^{0}$、温度 $T$ 和压力 $P$下都满足理想气体关系。隔板被刺穿并移除，系统被允许达到内部平衡。从基本原理出发，即形式为 $\\Delta S = \\int \\delta q_{\\mathrm{rev}}/T$ 的热力学第二定律和理想气体的定义特性，推导系统混合熵变 $\\Delta S_{\\mathrm{mix}}$ 的表达式，然后计算给定物质的量下的数值。在同一框架内，解释当两种气体在微观上相同时（相同组分）推导过程会有什么变化，并说明其对 $\\Delta S_{\\mathrm{mix}}$ 的影响。将最终数值答案四舍五入到四位有效数字。以焦耳每开尔文为单位表示最终的熵变。",
            "solution": "问题要求推导两种理想气体的混合熵，进行后续的数值计算，并对气体相同的情况进行概念分析。推导必须源于基本原理。\n\n对于经历可逆过程的封闭系统，其基本热力学关系由热力学第一和第二定律联合给出：\n$$dU = \\delta q_{\\mathrm{rev}} - \\delta w_{\\mathrm{rev}} = TdS - PdV$$\n由此，状态变化引起的熵变 $dS$可以表示为：\n$$dS = \\frac{dU}{T} + \\frac{PdV}{T}$$\n对于理想气体，内能 $U$ 仅是温度的函数，因此 $dU = C_V dT$，其中 $C_V$ 是定容热容。理想气体状态方程为 $PV = nRT$。\n\n所描述的过程是在一个刚性的绝热容器内，移除两种理想气体 $A$ 和 $B$ 之间的隔板。这是一个不可逆过程。\n1. 容器是刚性的，所以不对外界做功：$w = 0$。\n2. 容器壁是绝热的，所以不与外界交换热量：$q = 0$。\n根据热力学第一定律，整个系统的内能变化为 $\\Delta U = q + w = 0$。\n总内能是两种气体内能之和，即 $U = U_A + U_B$。由于气体是理想的，$U_A$ 和 $U_B$ 仅取决于它们各自的温度。混合前的总内能为 $U_{\\mathrm{initial}} = U_A(T) + U_B(T)$。混合后的总内能为 $U_{\\mathrm{final}}$。由于 $\\Delta U = 0$，我们有 $U_{\\mathrm{final}} = U_{\\mathrm{initial}}$。对于理想气体，这意味着最终的平衡温度必须与初始温度相同，即 $T$。因此，混合过程是等温的。\n\n为了计算这个不可逆过程的熵变，我们必须设计一个连接相同初始状态和最终状态的可逆路径。初始状态为气体 $A$ 在体积 $V_{A}^{0}$ 中，气体 $B$ 在体积 $V_{B}^{0}$ 中，两者都处于温度 $T$。最终状态为气体 $A$ 和 $B$ 的混合物，每种气体都占据了总体积 $V_{\\mathrm{total}} = V_{A}^{0} + V_{B}^{0}$，温度为 $T$。\n\n一个合适的可逆路径是独立处理每种气体的膨胀。我们可以想象气体 $A$ 从其初始体积 $V_{A}^{0}$ 等温可逆地膨胀到最终体积 $V_{\\mathrm{total}}$。同时，气体 $B$ 从其初始体积 $V_{B}^{0}$ 等温可逆地膨胀到最终体积 $V_{\\mathrm{total}}$。总熵变 $\\Delta S_{\\mathrm{mix}}$ 是每种气体熵变 $\\Delta S_A$ 和 $\\Delta S_B$ 的和。\n$$\\Delta S_{\\mathrm{mix}} = \\Delta S_A + \\Delta S_B$$\n对于涉及理想气体的等温过程，$dT=0$，因此 $dU = C_V dT = 0$。$dS$ 的表达式简化为：\n$$dS = \\frac{P}{T}dV$$\n使用理想气体定律 $P/T = nR/V$，我们有：\n$$dS = nR \\frac{dV}{V}$$\n在恒定温度下，从初始体积 $V_i$ 积分到最终体积 $V_f$，得到等温膨胀的熵变：\n$$\\Delta S = \\int_{V_i}^{V_f} nR \\frac{dV}{V} = nR \\ln\\left(\\frac{V_f}{V_i}\\right)$$\n我们将此结果应用于气体 $A$ 和气体 $B$。\n对于气体 $A$：$\\Delta S_A = n_A R \\ln\\left(\\frac{V_{\\mathrm{total}}}{V_A^0}\\right)$。\n对于气体 $B$：$\\Delta S_B = n_B R \\ln\\left(\\frac{V_{\\mathrm{total}}}{V_B^0}\\right)$。\n\n问题陈述，最初两个隔间处于相同的温度 $T$ 和压力 $P$。使用理想气体定律：\n$V_{A}^{0} = \\frac{n_A R T}{P}$ 且 $V_{B}^{0} = \\frac{n_B R T}{P}$。\n总体积为 $V_{\\mathrm{total}} = V_{A}^{0} + V_{B}^{0} = \\frac{(n_A + n_B)RT}{P}$。\n\n体积比可以用摩尔分数表示。设 $n_{\\mathrm{total}} = n_A+n_B$。摩尔分数为 $x_A = n_A/n_{\\mathrm{total}}$ 和 $x_B = n_B/n_{\\mathrm{total}}$。\n$$\\frac{V_{\\mathrm{total}}}{V_A^0} = \\frac{(n_A + n_B)RT/P}{n_A RT/P} = \\frac{n_A + n_B}{n_A} = \\frac{1}{x_A}$$\n$$\\frac{V_{\\mathrm{total}}}{V_B^0} = \\frac{(n_A + n_B)RT/P}{n_B RT/P} = \\frac{n_A + n_B}{n_B} = \\frac{1}{x_B}$$\n将这些比率代入 $\\Delta S_A$ 和 $\\Delta S_B$ 的表达式中：\n$\\Delta S_A = n_A R \\ln(1/x_A) = -n_A R \\ln(x_A)$。\n$\\Delta S_B = n_B R \\ln(1/x_B) = -n_B R \\ln(x_B)$。\n\n总混合熵是其和：\n$$\\Delta S_{\\mathrm{mix}} = \\Delta S_A + \\Delta S_B = -n_A R \\ln(x_A) - n_B R \\ln(x_B)$$\n这个表达式可以用总摩尔数 $n_{\\mathrm{total}}$ 来书写：\n$$\\Delta S_{\\mathrm{mix}} = -(n_{\\mathrm{total}} x_A) R \\ln(x_A) - (n_{\\mathrm{total}} x_B) R \\ln(x_B) = -n_{\\mathrm{total}} R (x_A \\ln(x_A) + x_B \\ln(x_B))$$\n由于摩尔分数 $x_i$ 总是小于 1，其对数为负，这确保了 $\\Delta S_{\\mathrm{mix}}$ 为正，与自发过程的热力学第二定律一致。\n\n现在，我们计算给定物质的量下的数值。\n已知：$n_A = 1.20$ 摩尔 和 $n_B = 2.80$ 摩尔。\n总摩尔数为 $n_{\\mathrm{total}} = n_A + n_B = 1.20 + 2.80 = 4.00$ 摩尔。\n摩尔分数为：\n$x_A = \\frac{n_A}{n_{\\mathrm{total}}} = \\frac{1.20}{4.00} = 0.300$。\n$x_B = \\frac{n_B}{n_{\\mathrm{total}}} = \\frac{2.80}{4.00} = 0.700$。\n普适气体常数为 $R \\approx 8.3145 \\text{ J mol}^{-1} \\text{K}^{-1}$。\n将这些值代入推导出的 $\\Delta S_{\\mathrm{mix}}$ 表达式中：\n$$\\Delta S_{\\mathrm{mix}} = -(4.00 \\text{ mol}) \\times (8.3145 \\text{ J mol}^{-1} \\text{K}^{-1}) \\times [0.300 \\ln(0.300) + 0.700 \\ln(0.700)]$$\n$$\\Delta S_{\\mathrm{mix}} = -33.258 \\text{ J K}^{-1} \\times [0.300 \\times (-1.20397) + 0.700 \\times (-0.35667)]$$\n$$\\Delta S_{\\mathrm{mix}} = -33.258 \\text{ J K}^{-1} \\times [-0.36119 - 0.24967]$$\n$$\\Delta S_{\\mathrm{mix}} = -33.258 \\text{ J K}^{-1} \\times [-0.61086]$$\n$$\\Delta S_{\\mathrm{mix}} \\approx 20.3163 \\text{ J K}^{-1}$$\n按要求四舍五入到四位有效数字：\n$$\\Delta S_{\\mathrm{mix}} = 20.32 \\text{ J K}^{-1}$$\n\n最后，我们考虑两种气体在微观上相同的情况。\n在这种情况下，我们混合的是两种相同气体的样本，它们最初处于相同的温度 $T$ 和压力 $P$。\n初始状态为 $n_A$ 摩尔的气体在体积 $V_A^0$ 中，以及 $n_B$ 摩尔的相同气体在体积 $V_B^0$ 中。由于 $T$ 和 $P$ 相同，两个隔间中的摩尔体积 $V_m = V/n = RT/P$ 也相同。\n移除隔板后的最终状态是 $n_{\\mathrm{total}} = n_A+n_B$ 摩尔的气体在体积 $V_{\\mathrm{total}} = V_A^0+V_B^0$ 中。最终的摩尔体积是 $V_{\\mathrm{total}}/n_{\\mathrm{total}} = (V_A^0+V_B^0)/(n_A+n_B)$。由于 $V_A^0 = n_A V_m$ 和 $V_B^0 = n_B V_m$，最终的摩尔体积是 $(n_A V_m + n_B V_m)/(n_A+n_B) = V_m$。\n最终温度是 $T$，最终压力是 $P_{\\mathrm{final}} = n_{\\mathrm{total}}RT/V_{\\mathrm{total}} = n_{\\mathrm{total}}R T / (n_{\\mathrm{total}}V_m) = RT/V_m = P$。\n因此，最终的宏观状态（由 $T$、$P$ 和摩尔体积 $V_m$ 定义）与初始的宏观状态相同。在相同的 $T$ 和 $P$ 下，移除两种相同气体之间的隔板不会引起系统热力学状态的任何变化。\n\n针对可区分气体的推导在这里是无效的，因为它假定可以根据粒子的来源（隔间 $A$ 或 $B$）来识别它们。对于相同的、不可区分的粒子，这种区分是无意义的。我们不能说来自隔间 $A$ 的气体“膨胀”充满了整个体积，因为它与隔间 $B$ 中已存在的气体是不可区分的。“混合”的概念不适用。\n由于熵是状态函数，且系统的初始和最终宏观状态相同，所以熵变必须为零。\n因此，对 $\\Delta S_{\\mathrm{mix}}$ 的影响是：\n$$\\Delta S_{\\mathrm{mix}} = 0$$\n这个结果被称为吉布斯佯谬。这种看似的不连续性（即当两种气体变得越来越相似时，混合熵并不会逐渐趋于零）由量子力学解决，量子力学假定同种粒子是根本上不可区分的。在经典热力学中，这被作为一个公设：在这些条件下，对于相同气体，$\\Delta S_{\\mathrm{mix}} = 0$。",
            "answer": "$$\\boxed{20.32}$$"
        },
        {
            "introduction": "理论物理学如何在实验数据中得到验证？本练习将带你进入非平衡热力学的研究前沿，这是一个连接理论、实验和计算的综合性实践。你将设计一个方法，利用真实的通量-力测量数据来估计唯象系数矩阵 $\\mathbf{L}$，并验证昂萨格倒易关系和熵产生率非负性这两个热力学第二定律在近平衡态下的核心推论。",
            "id": "2938122",
            "problem": "给定来自流体混合物中耦合输运过程的多个稳态、近平衡实验的数据。每个实验提供一个热力学力矢量和相应的测量通量矢量。在线性不可逆区域，对于一个具有 $m$ 个耦合过程的系统，$m$ 维通量矢量 $\\mathbf{J}$ 和 $m$ 维力矢量 $\\mathbf{X}$ 满足线性关系 $\\mathbf{J} = \\mathbf{L}\\,\\mathbf{X}$，其中 $\\mathbf{L} \\in \\mathbb{R}^{m \\times m}$ 是未知的唯象矩阵。单位体积的熵产生率为 $\\sigma = \\mathbf{J}^{\\mathsf{T}} \\mathbf{X}$。热力学第二定律要求在线性区域内，对于所有容许的 $\\mathbf{X}$，都有 $\\sigma \\ge 0$。根据微观可逆性，Onsager 倒易关系意味着 $\\mathbf{L}$ 是对称的，而对于所有 $\\mathbf{X}$ 都有 $\\sigma \\ge 0$ 则意味着 $\\mathbf{L}$ 是半正定的。\n\n您的任务是设计一种方法，在给定一组测量数据 $\\{ (\\mathbf{X}_k, \\mathbf{J}_k) \\}_{k=1}^N$ 的情况下，通过最小化残差平方和 $\\sum_{k=1}^N \\lVert \\mathbf{J}_k - \\mathbf{L} \\mathbf{X}_k \\rVert_2^2$ 来估计线性模型 $\\mathbf{J}_k \\approx \\mathbf{L} \\mathbf{X}_k$ 中的 $\\mathbf{L}$。使用估计出的 $\\widehat{\\mathbf{L}}$ 生成其对称部分 $\\widehat{\\mathbf{L}}_{\\mathrm{sym}} = \\tfrac{1}{2}(\\widehat{\\mathbf{L}} + \\widehat{\\mathbf{L}}^{\\mathsf{T}})$，然后通过两种方式验证热力学第二定律：\n\n1. 通过检查 $\\widehat{\\mathbf{L}}_{\\mathrm{sym}}$ 的所有特征值在固定的数值公差 $\\tau = 10^{-9}$ 内是否为非负，来验证其为半正定矩阵。\n2. 对于给定的力 $\\{\\mathbf{X}_k\\}$，计算 $\\sigma_k = \\mathbf{X}_k^{\\mathsf{T}} \\widehat{\\mathbf{L}}_{\\mathrm{sym}} \\mathbf{X}_k$ 并验证每个 $\\sigma_k \\ge -\\tau$。\n\n对于每个数据集，输出一个布尔值，当且仅当两项验证均成功时为 $true$，否则为 $false$。\n\n输入数据集是内嵌且固定的。对于每个数据集，定义一个 $N \\times m$ 矩阵 $\\mathbf{X}$（其行为 $\\mathbf{X}_k^{\\mathsf{T}}$）和一个 $N \\times m$ 矩阵 $\\mathbf{J}$（其行为 $\\mathbf{J}_k^{\\mathsf{T}}$）。使用以下四个数据集（测试套件），涵盖一个理想路径情况、一个包含零力实验和共线性的边界情况、一个含噪声的情况以及一个违规情况：\n\n- 数据集 A（理想路径, $m = 2$, $N = 4$）:\n  - 力 $\\mathbf{X}$:\n    - 第 $1$ 行: $[\\,1.0,\\,-0.5\\,]$\n    - 第 $2$ 行: $[\\,0.2,\\,0.8\\,]$\n    - 第 $3$ 行: $[\\,-1.5,\\,0.7\\,]$\n    - 第 $4$ 行: $[\\,0.0,\\,1.2\\,]$\n  - 通量 $\\mathbf{J}$:\n    - 第 $1$ 行: $[\\,1.85,\\,-0.2\\,]$\n    - 第 $2$ 行: $[\\,0.64,\\,0.86\\,]$\n    - 第 $3$ 行: $[\\,-2.79,\\,0.25\\,]$\n    - 第 $4$ 行: $[\\,0.36,\\,1.2\\,]$\n\n- 数据集 B（边界情况, $m = 3$, $N = 6$）:\n  - 力 $\\mathbf{X}$:\n    - 第 $1$ 行: $[\\,0.0,\\,0.0,\\,0.0\\,]$\n    - 第 $2$ 行: $[\\,1.0,\\,2.0,\\,-1.0\\,]$\n    - 第 $3$ 行: $[\\,0.5,\\,1.0,\\,-0.5\\,]$\n    - 第 $4$ 行: $[\\,0.0,\\,1.0,\\,1.0\\,]$\n    - 第 $5$ 行: $[\\,1.0,\\,0.0,\\,1.0\\,]$\n    - 第 $6$ 行: $[\\,1.0,\\,1.0,\\,0.0\\,]$\n  - 通量 $\\mathbf{J}$:\n    - 第 $1$ 行: $[\\,0.0,\\,0.0,\\,0.0\\,]$\n    - 第 $2$ 行: $[\\,1.5,\\,2.05,\\,-0.5\\,]$\n    - 第 $3$ 行: $[\\,0.75,\\,1.025,\\,-0.25\\,]$\n    - 第 $4$ 行: $[\\,0.3,\\,1.05,\\,0.85\\,]$\n    - 第 $5$ 行: $[\\,1.7,\\,0.15,\\,1.0\\,]$\n    - 第 $6$ 行: $[\\,1.6,\\,1.1,\\,0.25\\,]$\n\n- 数据集 C（含噪声, $m = 2$, $N = 5$）:\n  - 力 $\\mathbf{X}$:\n    - 第 $1$ 行: $[\\,0.3,\\,-0.7\\,]$\n    - 第 $2$ 行: $[\\,-1.1,\\,0.5\\,]$\n    - 第 $3$ 行: $[\\,0.0,\\,-0.9\\,]$\n    - 第 $4$ 行: $[\\,1.5,\\,1.2\\,]$\n    - 第 $5$ 行: $[\\,-0.4,\\,0.2\\,]$\n  - 通量 $\\mathbf{J}$:\n    - 第 $1$ 行: $[\\,0.02001,\\,-0.72002\\,]$\n    - 第 $2$ 行: $[\\,-0.900015,\\,0.16001\\,]$\n    - 第 $3$ 行: $[\\, -0.35998,\\,-1.08001\\,]$\n    - 第 $4$ 行: $[\\,1.97999,\\,2.040015\\,]$\n    - 第 $5$ 行: $[\\,-0.32,\\,0.07999\\,]$\n\n- 数据集 D（违规情况, $m = 2$, $N = 3$）:\n  - 力 $\\mathbf{X}$:\n    - 第 $1$ 行: $[\\,1.0,\\,0.0\\,]$\n    - 第 $2$ 行: $[\\,0.0,\\,1.0\\,]$\n    - 第 $3$ 行: $[\\,1.0,\\,-1.0\\,]$\n  - 通量 $\\mathbf{J}$:\n    - 第 $1$ 行: $[\\,0.5,\\,1.0\\,]$\n    - 第 $2$ 行: $[\\,1.0,\\,0.2\\,]$\n    - 第 $3$ 行: $[\\,-0.5,\\,0.8\\,]$\n\n实现要求：\n\n- 使用上述基于原理的方法，通过最小化关于 $\\mathbf{L}$ 的残差平方和来估计 $\\widehat{\\mathbf{L}}$，然后通过对称化得到 $\\widehat{\\mathbf{L}}_{\\mathrm{sym}}$ 来强制施加倒易关系，并在公差 $\\tau = 10^{-9}$ 内验证其半正定性和 $\\sigma_k$ 的非负性。\n- 对于每个数据集，返回一个布尔值，当且仅当估计的 $\\widehat{\\mathbf{L}}_{\\mathrm{sym}}$ 是半正定的，并且所有计算出的 $\\sigma_k$ 在公差范围内为非负时，该值为 $true$。\n- 您的程序的最终输出必须是单行文本，其中包含按 A、B、C、D 顺序排列的四个数据集的结果，形式为方括号内以逗号分隔的列表，例如 $[\\,\\text{true},\\text{false},\\text{true},\\text{true}\\,]$。请使用 Python 的布尔字面量，即输出必须是 $[\\,\\text{True},\\text{False},\\dots\\,]$ 的形式。\n- 您的程序必须是自包含的，且不得读取任何输入。布尔输出不需要单位。",
            "solution": "所提出的问题是一个在将非平衡热力学和线性代数应用于实验数据方面有效且适定的练习。它在科学上植根于线性不可逆热力学的原理，即线性的通量-力关系以及热力学第二定律与 Onsager 倒易关系相结合的推论。指令清晰，数据已提供，目标明确。我们将着手进行形式化的求解。\n\n在近平衡的线性区域内，耦合输运过程的基本模型由热力学通量 $\\mathbf{J}$ 和力 $\\mathbf{X}$ 之间的线性关系给出：\n$$ \\mathbf{J} = \\mathbf{L} \\mathbf{X} $$\n其中 $\\mathbf{J}, \\mathbf{X} \\in \\mathbb{R}^m$ 是 $m$ 维列矢量，$\\mathbf{L} \\in \\mathbb{R}^{m \\times m}$ 是唯象系数矩阵。\n\n我们得到一组 $N$ 个实验测量值 $\\{(\\mathbf{X}_k, \\mathbf{J}_k)\\}_{k=1}^N$。我们的首要任务是从这些数据中估计矩阵 $\\mathbf{L}$。这是一个经典的多变量线性回归问题。我们可以将数据整理成两个矩阵：一个 $N \\times m$ 的力矩阵 $\\mathbf{X}_{\\text{data}}$，其中第 $k$ 行为 $\\mathbf{X}_k^{\\mathsf{T}}$；以及一个 $N \\times m$ 的通量矩阵 $\\mathbf{J}_{\\text{data}}$，其中第 $k$ 行为 $\\mathbf{J}_k^{\\mathsf{T}}$。方程组可以写成：\n$$ \\mathbf{J}_{\\text{data}} = \\mathbf{X}_{\\text{data}} \\mathbf{L}^{\\mathsf{T}} $$\n我们寻求使残差平方和最小化的矩阵 $\\widehat{\\mathbf{L}}$，这等同于最小化残差矩阵的弗罗贝尼乌斯范数的平方：\n$$ S(\\mathbf{L}) = \\sum_{k=1}^N \\lVert \\mathbf{J}_k - \\mathbf{L} \\mathbf{X}_k \\rVert_2^2 = \\lVert \\mathbf{J}_{\\text{data}} - \\mathbf{X}_{\\text{data}} \\mathbf{L}^{\\mathsf{T}} \\rVert_F^2 $$\n这个线性最小二乘问题的解（我们记为 $\\widehat{\\mathbf{L}}^{\\mathsf{T}}$）通过求解正规方程组得到。一种稳健的数值方法是使用诸如 QR 分解之类的方法，这在标准数值库中已有实现。我们在系统 $\\mathbf{X}_{\\text{data}} \\widehat{\\mathbf{L}}^{\\mathsf{T}} \\approx \\mathbf{J}_{\\text{data}}$ 中求解 $\\widehat{\\mathbf{L}}^{\\mathsf{T}}$。将结果转置即可得到估计的唯象矩阵 $\\widehat{\\mathbf{L}}$。\n\n微观可逆性原理意味着 Onsager 倒易关系，该关系指出唯象矩阵 $\\mathbf{L}$ 必须是对称的，即 $\\mathbf{L} = \\mathbf{L}^{\\mathsf{T}}$。由于实验噪声，最小二乘估计 $\\widehat{\\mathbf{L}}$ 可能不是完全对称的。规定的步骤是通过取估计的对称部分来强制施加这一物理约束：\n$$ \\widehat{\\mathbf{L}}_{\\mathrm{sym}} = \\frac{1}{2}(\\widehat{\\mathbf{L}} + \\widehat{\\mathbf{L}}^{\\mathsf{T}}) $$\n这个矩阵 $\\widehat{\\mathbf{L}}_{\\mathrm{sym}}$ 是我们对真实唯象矩阵的最终估计。\n\n热力学第二定律要求单位体积的熵产生率 $\\sigma$ 必须为非负。在线性区域，$\\sigma$ 由下式给出：\n$$ \\sigma = \\mathbf{J}^{\\mathsf{T}} \\mathbf{X} = (\\mathbf{L}\\mathbf{X})^{\\mathsf{T}}\\mathbf{X} = \\mathbf{X}^{\\mathsf{T}}\\mathbf{L}^{\\mathsf{T}}\\mathbf{X} $$\n当 $\\mathbf{L}$ 是对称的时，该式变为 $\\sigma = \\mathbf{X}^{\\mathsf{T}}\\mathbf{L}\\mathbf{X}$。对所有可能的力 $\\mathbf{X}$，$\\sigma \\ge 0$ 的条件意味着对称矩阵 $\\mathbf{L}$ 必须是半正定的。\n\n我们必须通过两种方式对我们估计的矩阵 $\\widehat{\\mathbf{L}}_{\\mathrm{sym}}$ 验证此条件：\n\n1.  一个矩阵是半正定的，当且仅当其所有特征值均为非负。我们计算 $\\widehat{\\mathbf{L}}_{\\mathrm{sym}}$ 的特征值 $\\lambda_i$，并验证对于所有的 $i$ 都有 $\\lambda_i \\ge -\\tau$，其中 $\\tau = 10^{-9}$ 是指定的数值公差。\n\n2.  我们使用估计的矩阵为每个具体实验计算熵产生率：$\\sigma_k = \\mathbf{X}_k^{\\mathsf{T}} \\widehat{\\mathbf{L}}_{\\mathrm{sym}} \\mathbf{X}_k$。然后我们验证对于所有的 $k = 1, \\dots, N$ 都有 $\\sigma_k \\ge -\\tau$。\n\n对于每个数据集，最终结果为 `True` 当且仅当两个验证条件都满足。否则，结果为 `False`。现在将此过程应用于所提供的四个数据集中的每一个。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to process all datasets and print the final results.\n    \"\"\"\n\n    # --- Dataset Definitions ---\n\n    # Dataset A (happy path, m=2, N=4)\n    X_A = np.array([\n        [1.0, -0.5],\n        [0.2, 0.8],\n        [-1.5, 0.7],\n        [0.0, 1.2]\n    ])\n    J_A = np.array([\n        [1.85, -0.2],\n        [0.64, 0.86],\n        [-2.79, 0.25],\n        [0.36, 1.2]\n    ])\n\n    # Dataset B (boundary, m=3, N=6)\n    X_B = np.array([\n        [0.0, 0.0, 0.0],\n        [1.0, 2.0, -1.0],\n        [0.5, 1.0, -0.5],\n        [0.0, 1.0, 1.0],\n        [1.0, 0.0, 1.0],\n        [1.0, 1.0, 0.0]\n    ])\n    J_B = np.array([\n        [0.0, 0.0, 0.0],\n        [1.5, 2.05, -0.5],\n        [0.75, 1.025, -0.25],\n        [0.3, 1.05, 0.85],\n        [1.7, 0.15, 1.0],\n        [1.6, 1.1, 0.25]\n    ])\n\n    # Dataset C (noisy, m=2, N=5)\n    X_C = np.array([\n        [0.3, -0.7],\n        [-1.1, 0.5],\n        [0.0, -0.9],\n        [1.5, 1.2],\n        [-0.4, 0.2]\n    ])\n    J_C = np.array([\n        [0.02001, -0.72002],\n        [-0.900015, 0.16001],\n        [-0.35998, -1.08001],\n        [1.97999, 2.040015],\n        [-0.32, 0.07999]\n    ])\n\n    # Dataset D (violation, m=2, N=3)\n    X_D = np.array([\n        [1.0, 0.0],\n        [0.0, 1.0],\n        [1.0, -1.0]\n    ])\n    J_D = np.array([\n        [0.5, 1.0],\n        [1.0, 0.2],\n        [-0.5, 0.8]\n    ])\n\n    test_cases = [\n        (X_A, J_A),\n        (X_B, J_B),\n        (X_C, J_C),\n        (X_D, J_D)\n    ]\n    \n    tolerance = 1e-9\n    results = []\n\n    for X_data, J_data in test_cases:\n        result = verify_second_law(X_data, J_data, tolerance)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef verify_second_law(X, J, tau):\n    \"\"\"\n    Estimates the phenomenological matrix and verifies the Second Law.\n\n    Args:\n        X (np.ndarray): The N x m matrix of thermodynamic forces.\n        J (np.ndarray): The N x m matrix of thermodynamic fluxes.\n        tau (float): The numerical tolerance for checks.\n\n    Returns:\n        bool: True if both verification conditions are met, False otherwise.\n    \"\"\"\n    # Step 1: Estimate L by solving the least-squares problem J = X @ L_T\n    # np.linalg.lstsq solves for x in a @ x = b. Here, a=X, b=J, x=L_T\n    L_T, _, _, _ = np.linalg.lstsq(X, J, rcond=None)\n    L_hat = L_T.T\n\n    # Step 2: Enforce Onsager reciprocity by symmetrizing L_hat\n    L_sym = 0.5 * (L_hat + L_hat.T)\n\n    # Step 3a: Verify positive semidefiniteness of L_sym\n    # A real symmetric matrix is positive semidefinite iff all its eigenvalues are non-negative.\n    # We use eigvalsh for hermitian (or real symmetric) matrices.\n    eigenvalues = np.linalg.eigvalsh(L_sym)\n    is_positive_semidefinite = np.all(eigenvalues >= -tau)\n\n    # Step 3b: Verify non-negative entropy production for each experiment.\n    # sigma_k = X_k^T @ L_sym @ X_k\n    # This can be computed for all k efficiently.\n    # (X @ L_sym) * X gives element-wise product. Sum along axis 1.\n    sigmas = np.sum((X @ L_sym) * X, axis=1)\n    is_sigma_non_negative = np.all(sigmas >= -tau)\n\n    # The final result is true if and only if both conditions are met.\n    return is_positive_semidefinite and is_sigma_non_negative\n\nsolve()\n```"
        }
    ]
}