{
    "hands_on_practices": [
        {
            "introduction": "将热力学第一定律应用于完整的热力学循环是理解能量守恒的基石。这个练习旨在强化状态函数（如内能 $U$）和路径函数（如功 $w$ 和热 $q$）之间的关键区别。通过为一个理想气体系统的简单矩形循环显式地计算这些量，您将具体地理解能量在循环过程中的守恒与转化，并验证内能作为状态函数其循环积分为零的特性。",
            "id": "2959099",
            "problem": "一份 $n = 1.000$ $\\mathrm{mol}$ 的单原子理想气体样品在压力-体积平面上经历一个由两个等压过程和两个等容过程组成的顺时针矩形循环。矩形的四个顶点由数对 $(p,V)$ 定义，其中 $p_{\\mathrm{low}} = 125.0$ $\\mathrm{kPa}$，$p_{\\mathrm{high}} = 275.0$ $\\mathrm{kPa}$，$V_{\\mathrm{low}} = 9.00$ $\\mathrm{L}$ 以及 $V_{\\mathrm{high}} = 15.00$ $\\mathrm{L}$。循环过程如下：\n- 状态 $\\mathrm{A}$: $(p_{\\mathrm{high}}, V_{\\mathrm{low}})$。\n- $\\mathrm{A} \\to \\mathrm{B}$: 在 $p_{\\mathrm{high}}$ 下从 $V_{\\mathrm{low}}$ 到 $V_{\\mathrm{high}}$ 的等压膨胀。\n- $\\mathrm{B} \\to \\mathrm{C}$: 在 $V_{\\mathrm{high}}$ 下从 $p_{\\mathrm{high}}$ 到 $p_{\\mathrm{low}}$ 的等容降压。\n- $\\mathrm{C} \\to \\mathrm{D}$: 在 $p_{\\mathrm{low}}$ 下从 $V_{\\mathrm{high}}$ 到 $V_{\\mathrm{low}}$ 的等压压缩。\n- $\\mathrm{D} \\to \\mathrm{A}$: 在 $V_{\\mathrm{low}}$ 下从 $p_{\\mathrm{low}}$ 到 $p_{\\mathrm{high}}$ 的等容升压。\n\n假设与约定：\n- 过程是准静态（可逆）的，因此在每个阶段中，系统压力都等于外部压力。\n- 气体在所有点都保持理想状态，并遵循 $pV = nRT$，其中 $R = 8.314462618$ $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 对于单原子理想气体，定容摩尔热容与温度无关，等于 $C_{V,\\mathrm{m}} = \\tfrac{3}{2}R$。\n- 压力-体积功的非确切微分定义为 $\\delta w = -p\\,dV$（环境对系统做功为正）。热量的非确切微分定义为 $\\delta q$（系统吸热为正）。\n- 热力学第一定律采用 $dU = \\delta q + \\delta w$ 的形式。\n\n任务：\n- 计算循环功 $\\oint \\delta w$。\n- 计算循环热 $\\oint \\delta q$。\n- 通过与所述原理一致的显式计算，验证整个循环中内能的总变化为零，即 $\\Delta U_{\\mathrm{cycle}} = 0$。\n\n所有能量以 $\\mathrm{J}$ 为单位表示。将最终数值答案四舍五入至三位有效数字。最终答案必须是单个对象，并按顺序包含 $\\oint \\delta w$、$\\oint \\delta q$ 和 $\\Delta U_{\\mathrm{cycle}}$ 的值。",
            "solution": "问题陈述已经过评估，被认为是有效的。这是一个在经典热力学中提法恰当、内容完备且科学合理的问题。所有必需的参数和定义均已提供，不存在矛盾或歧义。我们将继续进行解答。\n\n问题要求计算一个完整循环中气体所做的总功 $w_{\\mathrm{cycle}} = \\oint \\delta w$、气体吸收的总热量 $q_{\\mathrm{cycle}} = \\oint \\delta q$ 以及内能的总变化 $\\Delta U_{\\mathrm{cycle}}$。热力学第一定律 $dU = \\delta q + \\delta w$ 支配着能量转换。\n\n首先，我们必须将所有给定物理量用国际单位制（SI）表示。\n压力：\n$p_{\\mathrm{low}} = 125.0\\,\\mathrm{kPa} = 1.250 \\times 10^5\\,\\mathrm{Pa}$\n$p_{\\mathrm{high}} = 275.0\\,\\mathrm{kPa} = 2.750 \\times 10^5\\,\\mathrm{Pa}$\n体积：\n$V_{\\mathrm{low}} = 9.00\\,\\mathrm{L} = 9.00 \\times 10^{-3}\\,\\mathrm{m^3}$\n$V_{\\mathrm{high}} = 15.00\\,\\mathrm{L} = 1.500 \\times 10^{-2}\\,\\mathrm{m^3}$\n\n该循环由四个准静态过程组成：$\\mathrm{A} \\to \\mathrm{B}$、$\\mathrm{B} \\to \\mathrm{C}$、$\\mathrm{C} \\to \\mathrm{D}$ 和 $\\mathrm{D} \\to \\mathrm{A}$。\n\n任务 1：计算循环功 $\\oint \\delta w = w_{\\mathrm{cycle}}$。\n总功是循环中每个过程所做功的总和：\n$$w_{\\mathrm{cycle}} = w_{AB} + w_{BC} + w_{CD} + w_{DA}$$\n功由积分 $w = \\int -p\\,dV$ 定义。\n\n过程 $\\mathrm{A} \\to \\mathrm{B}$（在 $p = p_{\\mathrm{high}}$ 下的等压膨胀）：\n$w_{AB} = \\int_{V_{\\mathrm{low}}}^{V_{\\mathrm{high}}} -p_{\\mathrm{high}}\\,dV = -p_{\\mathrm{high}}(V_{\\mathrm{high}} - V_{\\mathrm{low}})$\n\n过程 $\\mathrm{B} \\to \\mathrm{C}$（在 $V = V_{\\mathrm{high}}$ 下的等容冷却）：\n由于体积恒定，$dV = 0$，因此所做的功为零。\n$w_{BC} = \\int -p\\,dV = 0$\n\n过程 $\\mathrm{C} \\to \\mathrm{D}$（在 $p = p_{\\mathrm{low}}$ 下的等压压缩）：\n$w_{CD} = \\int_{V_{\\mathrm{high}}}^{V_{\\mathrm{low}}} -p_{\\mathrm{low}}\\,dV = -p_{\\mathrm{low}}(V_{\\mathrm{low}} - V_{\\mathrm{high}}) = p_{\\mathrm{low}}(V_{\\mathrm{high}} - V_{\\mathrm{low}})$\n\n过程 $\\mathrm{D} \\to \\mathrm{A}$（在 $V = V_{\\mathrm{low}}$ 下的等容加热）：\n由于体积恒定，$dV = 0$，因此所做的功为零。\n$w_{DA} = \\int -p\\,dV = 0$\n\n循环的总功是这些贡献的总和：\n$w_{\\mathrm{cycle}} = -p_{\\mathrm{high}}(V_{\\mathrm{high}} - V_{\\mathrm{low}}) + 0 + p_{\\mathrm{low}}(V_{\\mathrm{high}} - V_{\\mathrm{low}}) + 0$\n$$w_{\\mathrm{cycle}} = -(p_{\\mathrm{high}} - p_{\\mathrm{low}})(V_{\\mathrm{high}} - V_{\\mathrm{low}})$$\n这个结果是 $p-V$ 平面中矩形路径所包围面积的负值。循环的顺时针方向导致系统对外做净功，因此系统获得的功为负。\n\n现在，我们代入数值：\n$\\Delta p = p_{\\mathrm{high}} - p_{\\mathrm{low}} = (2.750 - 1.250) \\times 10^5\\,\\mathrm{Pa} = 1.500 \\times 10^5\\,\\mathrm{Pa}$\n$\\Delta V = V_{\\mathrm{high}} - V_{\\mathrm{low}} = (15.00 - 9.00) \\times 10^{-3}\\,\\mathrm{m^3} = 6.00 \\times 10^{-3}\\,\\mathrm{m^3}$\n$w_{\\mathrm{cycle}} = -(1.500 \\times 10^5\\,\\mathrm{Pa}) \\times (6.00 \\times 10^{-3}\\,\\mathrm{m^3}) = -900.0\\,\\mathrm{J}$\n有效数字的位数受限于 $\\Delta V$ 的值，它有三位有效数字。因此，我们将结果四舍五入到三位有效数字。\n$w_{\\mathrm{cycle}} = -9.00 \\times 10^2\\,\\mathrm{J}$\n\n任务 2：验证 $\\Delta U_{\\mathrm{cycle}} = 0$。\n内能 $U$ 是一个状态函数，意味着其变化仅取决于初态和末态。对于任何闭合循环，初态和末态相同，因此内能的净变化必须为零，$\\Delta U_{\\mathrm{cycle}} = 0$。问题要求进行显式验证。\n\n对于单原子理想气体，内能的变化由 $\\Delta U = n C_{V,\\mathrm{m}} \\Delta T$ 给出，其中 $C_{V,\\mathrm{m}} = \\frac{3}{2}R$。使用理想气体定律 $pV = nRT$，我们可以写出 $\\Delta U = \\frac{3}{2} nR \\Delta T = \\frac{3}{2} \\Delta(nRT) = \\frac{3}{2}\\Delta(pV)$。\n循环的总变化是：\n$\\Delta U_{\\mathrm{cycle}} = \\Delta U_{AB} + \\Delta U_{BC} + \\Delta U_{CD} + \\Delta U_{DA}$\n\n$\\Delta U_{AB} = \\frac{3}{2}(p_B V_B - p_A V_A) = \\frac{3}{2}(p_{\\mathrm{high}}V_{\\mathrm{high}} - p_{\\mathrm{high}}V_{\\mathrm{low}}) = \\frac{3}{2}p_{\\mathrm{high}}(V_{\\mathrm{high}} - V_{\\mathrm{low}})$\n$\\Delta U_{BC} = \\frac{3}{2}(p_C V_C - p_B V_B) = \\frac{3}{2}(p_{\\mathrm{low}}V_{\\mathrm{high}} - p_{\\mathrm{high}}V_{\\mathrm{high}}) = \\frac{3}{2}V_{\\mathrm{high}}(p_{\\mathrm{low}} - p_{\\mathrm{high}})$\n$\\Delta U_{CD} = \\frac{3}{2}(p_D V_D - p_C V_C) = \\frac{3}{2}(p_{\\mathrm{low}}V_{\\mathrm{low}} - p_{\\mathrm{low}}V_{\\mathrm{high}}) = \\frac{3}{2}p_{\\mathrm{low}}(V_{\\mathrm{low}} - V_{\\mathrm{high}})$\n$\\Delta U_{DA} = \\frac{3}{2}(p_A V_A - p_D V_D) = \\frac{3}{2}(p_{\\mathrm{high}}V_{\\mathrm{low}} - p_{\\mathrm{low}}V_{\\mathrm{low}}) = \\frac{3}{2}V_{\\mathrm{low}}(p_{\\mathrm{high}} - p_{\\mathrm{low}})$\n\n将这些项进行代数求和：\n$\\Delta U_{\\mathrm{cycle}} = \\frac{3}{2} [ (p_{\\mathrm{high}}V_{\\mathrm{high}} - p_{\\mathrm{high}}V_{\\mathrm{low}}) + (p_{\\mathrm{low}}V_{\\mathrm{high}} - p_{\\mathrm{high}}V_{\\mathrm{high}}) + (p_{\\mathrm{low}}V_{\\mathrm{low}} - p_{\\mathrm{low}}V_{\\mathrm{high}}) + (p_{\\mathrm{high}}V_{\\mathrm{low}} - p_{\\mathrm{low}}V_{\\mathrm{low}}) ]$\n重新排列后，所有项都抵消了：\n$\\Delta U_{\\mathrm{cycle}} = \\frac{3}{2} [ (p_{\\mathrm{high}}V_{\\mathrm{high}} - p_{\\mathrm{high}}V_{\\mathrm{high}}) + (-p_{\\mathrm{high}}V_{\\mathrm{low}} + p_{\\mathrm{high}}V_{\\mathrm{low}}) + (p_{\\mathrm{low}}V_{\\mathrm{high}} - p_{\\mathrm{low}}V_{\\mathrm{high}}) + (p_{\\mathrm{low}}V_{\\mathrm{low}} - p_{\\mathrm{low}}V_{\\mathrm{low}}) ] = \\frac{3}{2}[0] = 0$\n\n数值上：\n$\\Delta U_{AB} = \\frac{3}{2}(2.750 \\times 10^5)(6.00 \\times 10^{-3}) = 2475\\,\\mathrm{J}$\n$\\Delta U_{BC} = \\frac{3}{2}(1.500 \\times 10^{-2})(-1.500 \\times 10^5) = -3375\\,\\mathrm{J}$\n$\\Delta U_{CD} = \\frac{3}{2}(1.250 \\times 10^5)(-6.00 \\times 10^{-3}) = -1125\\,\\mathrm{J}$\n$\\Delta U_{DA} = \\frac{3}{2}(9.00 \\times 10^{-3})(1.500 \\times 10^5) = 2025\\,\\mathrm{J}$\n$\\Delta U_{\\mathrm{cycle}} = 2475 - 3375 - 1125 + 2025 = 0\\,\\mathrm{J}$。\n显式计算证实了 $\\Delta U_{\\mathrm{cycle}} = 0$。\n\n任务 3：计算循环热 $\\oint \\delta q = q_{\\mathrm{cycle}}$。\n根据热力学第一定律，对于一个完整循环：\n$$\\Delta U_{\\mathrm{cycle}} = q_{\\mathrm{cycle}} + w_{\\mathrm{cycle}}$$\n由于我们已经确定 $\\Delta U_{\\mathrm{cycle}} = 0$，因此必然有：\n$$q_{\\mathrm{cycle}} = -w_{\\mathrm{cycle}}$$\n因此，使用任务 1 的结果：\n$q_{\\mathrm{cycle}} = -(-900.0\\,\\mathrm{J}) = 900.0\\,\\mathrm{J}$\n四舍五入到三位有效数字，我们得到：\n$q_{\\mathrm{cycle}} = 9.00 \\times 10^2\\,\\mathrm{J}$\n\n三个所求量的最终值为 $\\oint \\delta w = -9.00 \\times 10^2\\,\\mathrm{J}$，$\\oint \\delta q = 9.00 \\times 10^2\\,\\mathrm{J}$ 以及 $\\Delta U_{\\mathrm{cycle}} = 0\\,\\mathrm{J}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} -9.00 \\times 10^2 & 9.00 \\times 10^2 & 0 \\end{pmatrix}}$$"
        },
        {
            "introduction": "虽然理想气体模型在教学中非常有用，但真实系统由于分子间作用力而表现出非理想行为。本练习将挑战“理想气体内能仅取决于温度”的简化假设，通过探索范德华气体的等温膨胀过程来揭示真实气体行为的复杂性。通过推导内能的变化量，您将看到分子间的吸引力（由范德华参数 $a$ 表示）如何使内能即使在恒温下也依赖于体积，从而更深刻地理解非理想性的物理本质。",
            "id": "2959157",
            "problem": "一个封闭的单相系统包含 $n$ 摩尔气体，该气体在所有相关状态下均遵循范德华状态方程，其参数 $a$ 和 $b$ 不依赖于温度。气体在温度 $T$ 下经历一次可逆等温膨胀，体积从初始的 $V_1$ 变为最终的 $V_2$，且 $V_2 > V_1$。忽略宏观动能和势能的变化。请仅从封闭系统的热力学第一定律和标准热力学恒等式出发，推导沿此等温路径内能变化 $\\Delta U$ 的精确表达式。你的推导过程必须明确指出是哪些非理想性特征对 $\\Delta U$ 产生了贡献。\n\n请以单个解析表达式的形式报告最终结果，该表达式应由 $a$、$n$、$V_1$ 和 $V_2$ 表示。使用国际单位制（SI），其中 $a$ 的单位为 $\\mathrm{Pa \\cdot m^6 \\cdot mol^{-2}}$，体积单位为 $\\mathrm{m^3}$，能量单位为 $\\mathrm{J}$。无需代入数值或进行舍入。请将最终答案表示为封闭形式的解析表达式。",
            "solution": "本题要求从热力学第一定律和标准热力学恒等式出发，推导范德华气体在可逆等温膨胀过程中的内能变化量 $\\Delta U$。\n\n对于经历可逆过程的封闭系统，热力学第一定律指出，内能的微分变化量 $dU$ 是系统吸收的热量 $dQ_{\\text{rev}}$ 与外界对系统做的功 $dW_{\\text{rev}}$ 之和。其微分形式为 $dU = dQ_{\\text{rev}} + dW_{\\text{rev}}$。对于一个可逆过程，我们有 $dQ_{\\text{rev}} = T dS$ 和 $dW_{\\text{rev}} = -P dV$。这导出了内能的基本方程：\n$$ dU = T dS - P dV $$\n内能 $U$ 是一个状态函数。因此，我们可以用任意两个独立的状态变量来表示其全微分。对于本问题，选择温度 $T$ 和体积 $V$ 作为变量最为方便。$U(T, V)$ 的全微分为：\n$$ dU = \\left(\\frac{\\partial U}{\\partial T}\\right)_V dT + \\left(\\frac{\\partial U}{\\partial V}\\right)_T dV $$\n所考虑的过程是等温过程，这意味着温度 $T$ 恒定，因此其微分 $dT$ 为零。内能变化的表达式简化为：\n$$ dU_T = \\left(\\frac{\\partial U}{\\partial V}\\right)_T dV $$\n偏导数 $\\left(\\frac{\\partial U}{\\partial V}\\right)_T$ 被称为内压强，它量化了在恒定温度下物质内能随体积变化的程度。为得到该项的表达式，我们回到基本方程 $dU = T dS - P dV$。在保持 $T$ 恒定的条件下，两边同除以 $dV$ 可得：\n$$ \\left(\\frac{\\partial U}{\\partial V}\\right)_T = T \\left(\\frac{\\partial S}{\\partial V}\\right)_T - P $$\n该表达式包含一个熵的偏导数，使用不便。我们可以用一个麦克斯韦关系式来替换它。麦克斯韦关系式源于基本热力学势是状态函数这一事实，这意味着它们的混合二阶偏导数相等。相关的关系式来自亥姆霍兹自由能 $A = U - TS$。其微分为 $dA = dU - T dS - S dT = (T dS - P dV) - T dS - S dT = -S dT - P dV$。从 $A(T, V)$ 的混合偏导数相等 $\\frac{\\partial^2 A}{\\partial V \\partial T} = \\frac{\\partial^2 A}{\\partial T \\partial V}$ 可推导出：\n$$ \\left(\\frac{\\partial (-S)}{\\partial V}\\right)_T = \\left(\\frac{\\partial (-P)}{\\partial T}\\right)_V \\implies \\left(\\frac{\\partial S}{\\partial V}\\right)_T = \\left(\\frac{\\partial P}{\\partial T}\\right)_V $$\n将此麦克斯韦关系式代入内压强的方程中，得到一个关键的热力学状态方程：\n$$ \\left(\\frac{\\partial U}{\\partial V}\\right)_T = T \\left(\\frac{\\partial P}{\\partial T}\\right)_V - P $$\n这个方程是普适的，适用于任何流体。现在我们将其应用于范德华气体的具体情况。范德华状态方程为：\n$$ \\left(P + \\frac{an^2}{V^2}\\right)(V - nb) = nRT $$\n为了使用我们的热力学状态方程，我们必须首先求出 $\\left(\\frac{\\partial P}{\\partial T}\\right)_V$。我们重新整理范德华方程，将压强 $P$ 表示为 $T$ 和 $V$ 的函数：\n$$ P(T,V) = \\frac{nRT}{V - nb} - \\frac{an^2}{V^2} $$\n现在，我们在 $V$ 和 $n$ 恒定的条件下，对 $P$ 求关于 $T$ 的偏导数：\n$$ \\left(\\frac{\\partial P}{\\partial T}\\right)_V = \\frac{\\partial}{\\partial T} \\left( \\frac{nRT}{V - nb} - \\frac{an^2}{V^2} \\right) = \\frac{nR}{V - nb} $$\n描述分子间引力的项 $\\frac{an^2}{V^2}$ 不依赖于温度，因此其对 $T$ 的导数为零。\n接下来，将 $\\left(\\frac{\\partial P}{\\partial T}\\right)_V$ 的此结果代入内压强的表达式中：\n$$ \\left(\\frac{\\partial U}{\\partial V}\\right)_T = T \\left( \\frac{nR}{V - nb} \\right) - P $$\n现在，我们将范德华压强 $P$ 的完整表达式代回此方程：\n$$ \\left(\\frac{\\partial U}{\\partial V}\\right)_T = \\frac{nRT}{V - nb} - \\left( \\frac{nRT}{V - nb} - \\frac{an^2}{V^2} \\right) $$\n与压强的动能部分相关的项相互抵消，得到一个非常简洁的结果：\n$$ \\left(\\frac{\\partial U}{\\partial V}\\right)_T = \\frac{an^2}{V^2} $$\n这个结果明确揭示了导致内能具有体积依赖性的非理想性特征。范德华气体的内压强不为零，这完全是由于代表分子间引力强度的参数 $a$ 的存在。对于理想气体，$a=0$，因此 $\\left(\\frac{\\partial U}{\\partial V}\\right)_T = 0$，意味着其内能仅依赖于温度。对于范德华气体，扩大体积需要做功来克服这些引力将分子拉开，这会增加它们的势能，从而增加系统的总内能。代表排除体积的参数 $b$ 对内压强没有贡献。\n\n为求出从初始体积 $V_1$ 膨胀到最终体积 $V_2$ 的指定等温过程中总的内能变化 $\\Delta U$，我们必须沿该路径对 $dU_T$ 进行积分：\n$$ \\Delta U = \\int_{U(T,V_1)}^{U(T,V_2)} dU = \\int_{V_1}^{V_2} \\left(\\frac{\\partial U}{\\partial V}\\right)_T dV $$\n代入我们推导出的内压强表达式：\n$$ \\Delta U = \\int_{V_1}^{V_2} \\frac{an^2}{V^2} dV $$\n参数 $a$ 和 $n$ 是常数，因此可以将它们移到积分符号外面：\n$$ \\Delta U = an^2 \\int_{V_1}^{V_2} V^{-2} dV $$\n执行定积分可得：\n$$ \\Delta U = an^2 \\left[ -\\frac{1}{V} \\right]_{V_1}^{V_2} = an^2 \\left( \\left(-\\frac{1}{V_2}\\right) - \\left(-\\frac{1}{V_1}\\right) \\right) $$\n这可以简化为内能变化的最终解析表达式：\n$$ \\Delta U = an^2 \\left( \\frac{1}{V_1} - \\frac{1}{V_2} \\right) $$\n由于题目指定了是膨胀过程，$V_2 > V_1$，因此 $\\frac{1}{V_1} > \\frac{1}{V_2}$。所以，项 $\\left( \\frac{1}{V_1} - \\frac{1}{V_2} \\right)$ 为正值，且 $\\Delta U > 0$。这证实了在范德华气体的等温膨胀过程中内能增加，与需要能量来克服分子间引力的物理解释相一致。",
            "answer": "$$ \\boxed{an^{2} \\left( \\frac{1}{V_1} - \\frac{1}{V_2} \\right)} $$"
        },
        {
            "introduction": "现代材料科学在很大程度上依赖于计算方法，以从第一性原理预测热力学性质。这个问题将量子统计力学与经典热力学联系起来，为您提供一个模拟晶体固体的热力学行为的实践机会。通过分析给定的声子数据，您将构建内能 $U(V,T)$ 并计算热压，从而将微观的振动特性与宏观的热力学可观测量直接联系起来，这是当代研究中一项至关重要的技能。",
            "id": "2529333",
            "problem": "您将获得一个合成的但科学上一致的数据集，该数据集模拟了晶体固体在几个不同体积下的第一性原理声子计算结果。您的任务是利用基本的热力学和统计力学，构建作为体积和温度函数的振动内能，记为 $U(V,T)$，并由此在准谐振近似下确定状态方程中的热压贡献。您的最终输出必须由一个完整、可运行的程序产生。\n\n使用的基本原理：\n- 热力学第一定律：$dU = \\delta Q - \\delta W$，伴随可逆的 $p\\,dV$ 功，以及压力作为广义力的定义 $p = -\\left(\\partial F/\\partial V\\right)_{T}$，其中 $F$ 是亥姆霍兹自由能。\n- 量子谐振子的统计力学：正则配分函数、平衡平均值以及声子的玻色–爱因斯坦占据数。\n- 准谐振近似 (QHA)：振动频率依赖于体积 $V$，但不显式地依赖于温度 $T$。\n\n数据集：\n- 体积，单位为立方埃/分子式单位：$V_{1} = 15.00$，$V_{2} = 15.75$，$V_{3} = 16.50$。\n- 对于每个体积 $V_{k}$，您将得到一组 6 个声子模频率（单位为太赫兹），它们代表了一个包含 $N=2$ 个原子的原胞的 $3N$ 个简正模（每个所列模式的简并度=1）。模式的标识（排序）在不同体积间是一致的。\n  - 在 $V_{1}$ 处：$\\{11.0,\\,9.0,\\,7.0,\\,5.0,\\,3.5,\\,2.0\\}$。\n  - 在 $V_{2}$ 处：$\\{10.3,\\,8.5,\\,6.6,\\,4.7,\\,3.3,\\,1.9\\}$。\n  - 在 $V_{3}$ 处：$\\{9.8,\\,8.0,\\,6.2,\\,4.4,\\,3.1,\\,1.8\\}$。\n\n使用的常数和单位：\n- 约化普朗克常数 $\\hbar = 1.054\\,571\\,817\\times 10^{-34}\\ \\mathrm{J\\cdot s}$。\n- 玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380\\,649\\times 10^{-23}\\ \\mathrm{J/K}$。\n- 电子伏特到焦耳转换：$1\\ \\mathrm{eV} = 1.602\\,176\\,634\\times 10^{-19}\\ \\mathrm{J}$。\n- 频率转换：如果 $\\nu$ 的单位是太赫兹，则角频率为 $\\omega = 2\\pi\\,\\nu\\times 10^{12}\\ \\mathrm{rad/s}$。\n- 体积转换：$1\\ \\text{\\AA}^{3} = 10^{-30}\\ \\mathrm{m}^{3}$。\n\n您必须从基本原理出发，实现的热力学构建：\n1. 对于每个角频率为 $\\omega(V)$ 的简正模，必须从平衡统计力学中获得其量子谐振子内能 $U_{\\text{mode}}(V,T)$。定义零温极限 $U_{\\text{mode}}(V,0)$ 以计算纯热学部分 $U_{\\text{mode,th}}(V,T) = U_{\\text{mode}}(V,T) - U_{\\text{mode}}(V,0)$。\n2. 使用压力是亥姆霍兹自由能在恒温下对体积的导数的定义，以及频率的准谐振体积依赖性，来表达振动压力。将热压贡献定义为 $P_{\\text{th}}(V,T) = P_{\\text{vib}}(V,T) - P_{\\text{vib}}(V,0)$，从而根据定义使得 $P_{\\text{th}}(V,0)=0$。\n3. 使用 $V_{1}$ 和 $V_{3}$ 处的数据，通过频率对数相对于体积对数的中心有限差分斜率来估计每个模式 $i$ 的模式分辨 Grüneisen 参数：\n   $$\\gamma_{i} \\equiv -\\frac{\\partial \\ln \\omega_{i}}{\\partial \\ln V}\\approx -\\frac{\\ln \\omega_{i}(V_{3}) - \\ln \\omega_{i}(V_{1})}{\\ln V_{3} - \\ln V_{1}}.$$\n   在所提供的体积范围内，将这些 $\\gamma_{i}$ 作为与体积无关的常数，用于在列表体积处评估 $P_{\\text{th}}(V,T)$。\n4. 对于给定的 $V$ 和 $T$，内能 $U(V,T)$ 是在相同 $V$ 下所有列出模式的能量之和。\n5. 热压 $P_{\\text{th}}(V,T)$ 必须根据适当的热力学关系以帕斯卡为单位进行评估，然后以吉帕斯卡为单位报告。\n\n编程任务：\n- 实现一个程序，该程序：\n  - 完全按照上面给出的数据集使用（不进行插值；仅在 $V\\in\\{V_{1},V_{2},V_{3}\\}$ 处进行评估）。\n  - 针对每个测试用例，计算 $U(V,T)$（单位为电子伏特/分子式单位）和 $P_{\\text{th}}(V,T)$（单位为吉帕斯卡）。\n  - 将每个报告的数字四舍五入到 6 位小数。\n\n测试套件：\n- 用例 1：$V=15.75\\ \\text{\\AA}^{3}$, $T=0\\ \\mathrm{K}$。\n- 用例 2：$V=15.75\\ \\text{\\AA}^{3}$, $T=300\\ \\mathrm{K}$。\n- 用例 3：$V=16.50\\ \\text{\\AA}^{3}$, $T=1000\\ \\mathrm{K}$。\n- 用例 4：$V=15.00\\ \\text{\\AA}^{3}$, $T=10\\ \\mathrm{K}$。\n\n答案规范：\n- 对于每个测试用例，按此顺序输出两个浮点数：$U(V,T)$（单位为 $\\mathrm{eV}$）和 $P_{\\text{th}}(V,T)$（单位为 $\\mathrm{GPa}$），每个数都四舍五入到 6 位小数。\n- 将所有用例的结果按照上述测试套件的顺序汇总到一个扁平列表中，并打印一行，其中包含该列表，形式为用方括号括起来的逗号分隔列表，例如 $[u_{1},p_{1},u_{2},p_{2},u_{3},p_{3},u_{4},p_{4}]$。\n- 角度不会出现；温度必须以开尔文处理；在代入热力学表达式时，体积必须以立方米处理；频率在使用前必须转换为角频率，单位为弧度/秒。\n\n科学真实性要求：\n- 将每个列出的模式视为一个独立的谐振子。\n- 在所有步骤中确保单位一致。\n- 不要引入任何无法从所述基本原理推导出的公式；而应在您的解决方案中实现您从中推导出的关系。",
            "solution": "问题要求基于给定的一组在几个不同体积下的声子频率，计算晶体固体的总振动内能 $U(V,T)$ 和热压 $P_{\\text{th}}(V,T)$。解决方案将在准谐振近似 (QHA) 下，根据统计力学和热力学的基本原理构建。\n\n**1. 理论基础**\n\n晶体固体的振动状态可以建模为一组独立的量子谐振子 (QHO)，每个谐振子对应一个具有角频率 $\\omega$ 的简正模（声子）。在 QHA 中，这些频率依赖于体积，但不显式地依赖于温度，即 $\\omega_i = \\omega_i(V)$。\n\n**1.1. 振动内能 $U(V,T)$**\n\n一个角频率为 $\\omega$ 的单个 QHO 的能级为 $E_n = \\hbar\\omega(n + 1/2)$，其中 $n=0, 1, 2, \\dots$。单个模式的正则配分函数为：\n$$ Z_{\\text{mode}} = \\sum_{n=0}^{\\infty} e^{-E_n / (k_B T)} = e^{-\\hbar\\omega / (2k_B T)} \\sum_{n=0}^{\\infty} \\left(e^{-\\hbar\\omega / (k_B T)}\\right)^n = \\frac{e^{-\\hbar\\omega / (2k_B T)}}{1 - e^{-\\hbar\\omega / (k_B T)}} $$\n此模式的平均内能 $U_{\\text{mode}}$ 可通过标准统计力学关系 $U = -\\partial(\\ln Z)/\\partial\\beta$ 求得，其中 $\\beta = 1/(k_B T)$：\n$$ U_{\\text{mode}}(V,T) = -\\frac{\\partial}{\\partial\\beta} \\ln Z_{\\text{mode}} = \\frac{\\hbar\\omega(V)}{2} + \\frac{\\hbar\\omega(V)}{e^{\\hbar\\omega(V)/(k_B T)} - 1} $$\n该表达式由两部分组成：与温度无关的零点能 (ZPE) $U_{\\text{mode}}(V,0) = \\frac{1}{2}\\hbar\\omega(V)$，以及一个代表热激发的与温度相关的项。量 $n_B(\\omega, T) = (e^{\\hbar\\omega/(k_B T)} - 1)^{-1}$ 是玻色–爱因斯坦分布，或模式中声子的平均占据数。\n\n固体每个分子式单位的总内能 $U(V,T)$ 是所有 $3N$ 个模式的能量之和（其中 $N$ 是每个分子式单位的原子数）：\n$$ U(V,T) = \\sum_{i=1}^{3N} U_{\\text{mode}, i}(V,T) = \\sum_{i=1}^{3N} \\left[ \\frac{\\hbar\\omega_i(V)}{2} + \\frac{\\hbar\\omega_i(V)}{e^{\\hbar\\omega_i(V)/(k_B T)} - 1} \\right] $$\n在本问题中，我们得到了一个包含 $N=2$ 个原子的原胞的 6 个模式，因此求和是针对这 6 个模式。这就是为 $U(V,T)$ 要实现的公式。\n\n**1.2. 热压 $P_{\\text{th}}(V,T)$**\n\n压力是亥姆霍兹自由能 $F$ 对体积的热力学导数：$P = -(\\partial F/\\partial V)_T$。单个模式的自由能为 $F_{\\text{mode}} = -k_B T \\ln Z_{\\text{mode}}$：\n$$ F_{\\text{mode}}(V,T) = \\frac{\\hbar\\omega(V)}{2} + k_B T \\ln\\left(1 - e^{-\\hbar\\omega(V)/(k_B T)}\\right) $$\n总自由能为 $F(V,T) = \\sum_i F_{\\text{mode},i}(V,T)$。振动压力则为：\n$$ P_{\\text{vib}}(V,T) = -\\left(\\frac{\\partial F(V,T)}{\\partial V}\\right)_T = -\\sum_i \\frac{\\partial F_{\\text{mode},i}}{\\partial \\omega_i} \\frac{d\\omega_i}{dV} $$\n可以证明 $\\partial F_{\\text{mode},i}/\\partial \\omega_i = U_{\\text{mode},i}/\\omega_i$。为了处理频率的体积导数，我们引入无量纲的模式 Grüneisen 参数 $\\gamma_i$：\n$$ \\gamma_i(V) \\equiv -\\frac{d\\ln\\omega_i}{d\\ln V} = -\\frac{V}{\\omega_i(V)}\\frac{d\\omega_i(V)}{dV} $$\n这使我们可以写出 $\\frac{d\\omega_i}{dV} = -\\frac{\\gamma_i \\omega_i}{V}$。将此代入压力表达式可得：\n$$ P_{\\text{vib}}(V,T) = \\sum_i \\frac{\\gamma_i(V)}{V} U_{\\text{mode},i}(V,T) $$\n问题要求计算热压 $P_{\\text{th}}(V,T)$，即相对于 $T=0\\ \\mathrm{K}$ 时的压力变化。\n$$ P_{\\text{th}}(V,T) = P_{\\text{vib}}(V,T) - P_{\\text{vib}}(V,0) $$\n$$ P_{\\text{th}}(V,T) = \\sum_i \\frac{\\gamma_i(V)}{V} \\left[ U_{\\text{mode},i}(V,T) - U_{\\text{mode},i}(V,0) \\right] $$\n方括号中的项是内能的纯热学部分，$U_{\\text{mode,th},i}(V,T) = \\hbar\\omega_i(V)/(e^{\\hbar\\omega_i(V)/(k_B T)} - 1)$。因此，热压的最终表达式为：\n$$ P_{\\text{th}}(V,T) = \\frac{1}{V} \\sum_{i=1}^{3N} \\gamma_i(V) \\left( \\frac{\\hbar\\omega_i(V)}{e^{\\hbar\\omega_i(V)/(k_B T)} - 1} \\right) $$\n根据定义，$P_{\\text{th}}(V,0) = 0$。\n\n**2. 计算实现**\n\n计算过程如下：\n\n首先，使用提供的有限差分公式以及体积 $V_1 = 15.00\\ \\text{\\AA}^3$ 和 $V_3 = 16.50\\ \\text{\\AA}^3$ 处的数据，来估计模式 Grüneisen 参数 $\\gamma_i$，并假设其在体积范围内为常数。由于 $\\omega_i$ 与频率 $\\nu_i$ 成正比，我们可以直接在公式中使用 $\\nu_i$：\n$$ \\gamma_{i} \\approx -\\frac{\\ln \\nu_{i}(V_{3}) - \\ln \\nu_{i}(V_{1})}{\\ln V_{3} - \\ln V_{1}} $$\n对 6 个模式中的每一个都执行一次此计算。\n\n其次，对于由一对 $(V, T)$ 指定的每个测试用例，我们检索相应的声子频率列表 $\\nu_i(V)$。\n\n第三，我们计算总内能 $U(V,T)$。对于 6 个模式中的每一个，我们使用 $\\omega_i = 2\\pi\\nu_i \\times 10^{12}$ 将其频率 $\\nu_i$（单位 THz）转换为角频率 $\\omega_i$（单位 rad/s）。然后，我们应用推导出的 $U(V,T)$ 公式，对所有模式的贡献求和。对于 $T=0\\ \\mathrm{K}$，热学项为零，而 $U(V,0)$ 仅是零点能之和。所有计算均使用国际单位制（J、K、m$^3$）进行，最终结果从焦耳转换为电子伏特 (eV)。\n\n第四，我们计算热压 $P_{\\text{th}}(V,T)$。对于 $T=0\\ \\mathrm{K}$，根据定义热压为 0。对于 $T > 0\\ \\mathrm{K}$，我们使用 $P_{\\text{th}}(V,T)$ 的公式，对所有模式的贡献求和。体积 $V$ 必须从 $\\text{\\AA}^3$ 转换为 $\\text{m}^3$。计算得出以帕斯卡 (Pa) 为单位的压力，然后将其转换为吉帕斯卡 (GPa)。\n\n最后，根据要求将计算出的 $U(V,T)$ 和 $P_{\\text{th}}(V,T)$ 值四舍五入到 6 位小数。所有常数和单位转换均按照问题陈述中的规定精确处理。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating vibrational internal energy and thermal pressure\n    for a crystalline solid based on provided phonon frequency data.\n    \"\"\"\n    # Define constants in SI units as specified\n    HBAR = 1.054571817e-34  # J*s\n    KB = 1.380649e-23      # J/K\n    EV_TO_J = 1.602176634e-19 # J/eV\n    A3_TO_M3 = 1e-30        # m^3/A^3\n    THZ_TO_RAD_S = 2 * np.pi * 1e12 # rad/s / THz\n\n    # Define the dataset from the problem statement\n    # Volumes in cubic angstrom per formula unit\n    V1, V2, V3 = 15.00, 15.75, 16.50\n    # Phonon frequencies in terahertz for each volume\n    FREQS = {\n        V1: np.array([11.0, 9.0, 7.0, 5.0, 3.5, 2.0]),\n        V2: np.array([10.3, 8.5, 6.6, 4.7, 3.3, 1.9]),\n        V3: np.array([9.8, 8.0, 6.2, 4.4, 3.1, 1.8]),\n    }\n\n    def calculate_gruneisen_parameters(v1, v3, freqs_v1, freqs_v3):\n        \"\"\"\n        Calculates mode Gruneisen parameters using a centered finite-difference formula.\n        The parameters are assumed to be volume-independent.\n        \"\"\"\n        log_v_ratio = np.log(v3 / v1)\n        log_freq_ratio = np.log(freqs_v3 / freqs_v1)\n        return -log_freq_ratio / log_v_ratio\n\n    def calculate_properties(V_A3, T_K, freqs_thz, gammas):\n        \"\"\"\n        Computes total internal energy U(V,T) in eV and thermal pressure P_th(V,T) in GPa.\n        \n        Args:\n            V_A3 (float): Volume in cubic angstroms.\n            T_K (float): Temperature in Kelvin.\n            freqs_thz (np.ndarray): Array of phonon frequencies in THz.\n            gammas (np.ndarray): Array of mode Gruneisen parameters.\n        \n        Returns:\n            tuple: (U in eV, P_th in GPa), rounded to 6 decimal places.\n        \"\"\"\n        # Use a small tolerance for floating point comparison with zero\n        is_zero_temp = T_K  1e-9\n\n        # Convert inputs to SI units\n        V_m3 = V_A3 * A3_TO_M3\n        omegas_rad_s = freqs_thz * THZ_TO_RAD_S\n\n        # --- Calculate total internal energy U(V,T) ---\n        # U = U_zpe + U_thermal\n        zpe_per_mode_j = 0.5 * HBAR * omegas_rad_s\n        total_zpe_j = np.sum(zpe_per_mode_j)\n\n        if is_zero_temp:\n            total_thermal_energy_j = 0.0\n        else:\n            exp_arg = (HBAR * omegas_rad_s) / (KB * T_K)\n            # Use np.expm1 for better numerical stability when exp_arg is small\n            # Use np.divide with a 'where' clause to handle potential division by zero\n            # if any exp_arg were to become zero (not the case here, but good practice).\n            thermal_energy_per_mode_j = np.divide(\n                HBAR * omegas_rad_s, np.expm1(exp_arg),\n                out=np.zeros_like(omegas_rad_s),\n                where=(np.expm1(exp_arg) != 0)\n            )\n            total_thermal_energy_j = np.sum(thermal_energy_per_mode_j)\n        \n        total_energy_j = total_zpe_j + total_thermal_energy_j\n        total_energy_ev = total_energy_j / EV_TO_J\n\n        # --- Calculate thermal pressure P_th(V,T) ---\n        # P_th = (1/V) * sum(gamma_i * U_thermal_i)\n        if is_zero_temp:\n            thermal_pressure_gpa = 0.0\n        else:\n            exp_arg = (HBAR * omegas_rad_s) / (KB * T_K)\n            thermal_energy_per_mode_j = np.divide(\n                HBAR * omegas_rad_s, np.expm1(exp_arg),\n                out=np.zeros_like(omegas_rad_s),\n                where=(np.expm1(exp_arg) != 0)\n            )\n            pressure_sum_j = np.sum(gammas * thermal_energy_per_mode_j)\n            thermal_pressure_pa = pressure_sum_j / V_m3\n            thermal_pressure_gpa = thermal_pressure_pa / 1e9\n\n        return round(total_energy_ev, 6), round(thermal_pressure_gpa, 6)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (15.75, 0.0),    # Case 1\n        (15.75, 300.0),  # Case 2\n        (16.50, 1000.0), # Case 3\n        (15.00, 10.0),   # Case 4\n    ]\n\n    # Pre-calculate the volume-independent Gruneisen parameters\n    gammas = calculate_gruneisen_parameters(V1, V3, FREQS[V1], FREQS[V3])\n    \n    results = []\n    for V_case, T_case in test_cases:\n        # Select the appropriate frequency set for the volume\n        freqs_case = FREQS[V_case]\n        # Calculate properties for the test case\n        u_val, p_val = calculate_properties(V_case, T_case, freqs_case, gammas)\n        results.append(u_val)\n        results.append(p_val)\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}