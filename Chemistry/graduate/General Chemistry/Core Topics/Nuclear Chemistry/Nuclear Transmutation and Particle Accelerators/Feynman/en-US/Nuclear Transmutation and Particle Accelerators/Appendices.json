{
    "hands_on_practices": [
        {
            "introduction": "Before a nuclear transmutation can be induced, the accelerated projectile must travel into the target material, continuously losing energy to the atomic electrons along its path. This first practice focuses on modeling this primary interaction to determine how far the particle penetrates. You will apply the celebrated Bethe formula for electronic stopping power, $S(E)$, and use numerical integration to compute the Continuous Slowing Down Approximation (CSDA) range. This exercise provides a foundational tool for designing experiments, selecting target thicknesses, and understanding the energy profile of the beam within the material .",
            "id": "2948349",
            "problem": "A proton pencil beam of kinetic energy $E_0$ traversing a homogeneous aluminum target loses energy to the target’s electrons according to the stopping-power concept. For a charged particle of charge $z e$ and speed $v$, the mean electronic mass stopping power $S_m(E)$ (energy loss per areal density) is modeled at nonrelativistic to moderately relativistic energies by the Bethe formula, which follows from binary Coulomb collisions with target electrons constrained by kinematics and the Born approximation. You will compute the projected continuous slowing down approximation (CSDA) range $R$ in aluminum by numerically integrating $1/S(E)$ from first principles and compare the result to semi-empirical expectations inspired by Stopping and Range of Ions in Matter (SRIM).\n\nFundamental base and given data:\n- The aluminum material parameters are atomic number $Z = 13$, molar mass $A = 26.9815385\\,\\mathrm{g/mol}$, bulk density $\\rho = 2.70\\,\\mathrm{g/cm^3}$, and mean excitation energy $I = 166\\,\\mathrm{eV} = 1.66\\times 10^{-4}\\,\\mathrm{MeV}$.\n- The Bethe mass stopping power for heavy charged particles (here, protons, $z=1$) in the electronic stopping regime is\n$$\nS_m(E) = K \\frac{z^2 Z}{A} \\frac{1}{\\beta^2} \\left[ \\frac{1}{2}\\ln\\!\\left(\\frac{2 m_e c^2 \\beta^2 \\gamma^2\\, T_{\\max}}{I^2}\\right) - \\beta^2 - \\frac{\\delta}{2} \\right],\n$$\nwhere $K = 0.307075\\,\\mathrm{MeV\\,cm^2/g}$, $m_e c^2 = 0.51099895\\,\\mathrm{MeV}$, $m_p c^2 = 938.2720813\\,\\mathrm{MeV}$, $z=1$, $\\gamma = 1 + E/(m_p c^2)$, $\\beta^2 = 1 - 1/\\gamma^2$, and the maximum kinetic energy transferable to an electron in one collision is\n$$\nT_{\\max} = \\frac{2 m_e c^2 \\beta^2 \\gamma^2}{1 + 2\\gamma (m_e/m_p) + (m_e/m_p)^2}.\n$$\nAt the energies of interest in this task, the density effect correction may be neglected, so set $\\delta = 0$. Nuclear stopping and radiative processes are negligible for the specified energies and material.\n- The CSDA areal range $R_m$ (in $\\mathrm{g/cm^2}$) satisfies\n$$\nR_m(E_0) = \\int_0^{E_0} \\frac{dE}{S_m(E)}.\n$$\nThe projected path length $R$ (in $\\mathrm{cm}$) is $R(E_0) = R_m(E_0)/\\rho$.\n\nLow-energy patching for physical realism and numerical stability:\n- The Bethe model deteriorates at low energies where the projectile’s effective charge and charge-exchange processes alter $S_m(E)$. To maintain scientific realism, use a matched low-energy surrogate for $E  E_{\\mathrm{patch}}$ with $E_{\\mathrm{patch}} = 0.1\\,\\mathrm{MeV}$. Impose continuity in value at $E_{\\mathrm{patch}}$ by defining\n$$\nS_m^{\\mathrm{low}}(E) = S_m(E_{\\mathrm{patch}})\\,\\left(\\frac{E}{E_{\\mathrm{patch}}}\\right)^{1/2}, \\quad 0 \\le E \\le E_{\\mathrm{patch}}.\n$$\n- With this surrogate, the low-energy contribution to the areal range has the closed form\n$$\nR_m^{\\mathrm{low}}(E_0) =\n\\begin{cases}\n\\displaystyle \\frac{2 \\sqrt{E_{\\mathrm{patch}}\\, E_0}}{S_m(E_{\\mathrm{patch}})},  0 \\le E_0 \\le E_{\\mathrm{patch}},\\\n$$8pt]\n\\displaystyle \\frac{2 E_{\\mathrm{patch}}}{S_m(E_{\\mathrm{patch}})},  E_0 > E_{\\mathrm{patch}}.\n\\end{cases}\n$$\n- For $E_0 > E_{\\mathrm{patch}}$, compute the remaining areal range by numerically integrating\n$$\nR_m^{\\mathrm{Bethe}}(E_0) = \\int_{E_{\\mathrm{patch}}}^{E_0} \\frac{dE}{S_m(E)},\n$$\nand set $R_m(E_0) = R_m^{\\mathrm{low}}(E_0) + R_m^{\\mathrm{Bethe}}(E_0)$.\n\nNumerical requirements:\n- Implement a robust numerical quadrature for the integral over $E \\in [E_{\\mathrm{patch}}, E_0]$ using a sufficiently fine partition to control discretization error over the energy range of interest.\n- Use only the constants and relationships stated above as the physical model base. No external data files or network access are allowed.\n\nUnit and formatting requirements:\n- Convert the final projected ranges to millimeters and express each value in $\\mathrm{mm}$ rounded to three significant figures.\n- Angles are not used in this task.\n- Percentages, if any, must be represented as decimals.\n\nTest suite and SRIM-based expectations:\n- Evaluate your algorithm for the following incident proton energies (in $\\mathrm{MeV}$): $E_0 \\in \\{1.0,\\;3.0,\\;10.0,\\;20.0\\}$.\n- For comparison, use the following SRIM-inspired CSDA areal range expectations for protons in aluminum at the same energies (in $\\mathrm{g/cm^2}$), which reflect semi-empirical trends in this energy regime:\n$$\nR_m^{\\mathrm{SRIM}}(1.0) = 6.5\\times 10^{-3},\\quad\nR_m^{\\mathrm{SRIM}}(3.0) = 1.8\\times 10^{-2},\\quad\nR_m^{\\mathrm{SRIM}}(10.0) = 1.4\\times 10^{-1},\\quad\nR_m^{\\mathrm{SRIM}}(20.0) = 3.3\\times 10^{-1}.\n$$\n- For each energy, also compute a boolean that is true if the relative deviation\n$$\n\\left| R_m(E_0) - R_m^{\\mathrm{SRIM}}(E_0) \\right| / R_m^{\\mathrm{SRIM}}(E_0)\n$$\nis less than or equal to $0.35$, and false otherwise.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The first element must be a list of the four projected ranges in $\\mathrm{mm}$ (ordered by increasing $E_0$ and each rounded to three significant figures). The second element must be a list of the four booleans (ordered by the same $E_0$ values) indicating agreement with the SRIM-inspired expectations within the specified relative tolerance. The final output must therefore look like a single-line string representation of a list of two lists, namely something of the form [[...],[...]].",
            "solution": "The problem statement is subjected to validation and is found to be valid. It is scientifically grounded in the principles of particle physics, specifically the interaction of charged particles with matter. The problem is well-posed, providing a complete set of constants, physical laws, and a clear computational objective. All parameters are specified, and the required calculations, including numerical integration, are well-defined. Therefore, a solution is warranted.\n\nThe core of this problem is to compute the projected range of a proton in an aluminum target. This is achieved by integrating the reciprocal of the proton's stopping power with respect to its kinetic energy, under the Continuous Slowing Down Approximation (CSDA). The stopping power, which is the mean energy loss per unit path length, is modeled by the Bethe formula.\n\nThe procedure is as follows:\n\n1.  **Physical Model Setup**: We begin by defining the physical system. All provided constants and material parameters for aluminum ($Z=13$, $A=26.9815385\\,\\mathrm{g/mol}$, $\\rho=2.70\\,\\mathrm{g/cm^3}$, $I=1.66\\times 10^{-4}\\,\\mathrm{MeV}$) and the proton ($z=1$, $m_p c^2 = 938.2720813\\,\\mathrm{MeV}$) are established in consistent units. The fundamental constants $K = 0.307075\\,\\mathrm{MeV\\,cm^2/g}$ and $m_e c^2 = 0.51099895\\,\\mathrm{MeV}$ are also defined.\n\n2.  **Stopping Power Function**: A function is implemented to calculate the mass stopping power, $S_m(E)$, for a given proton kinetic energy $E$. This function strictly adheres to the provided Bethe formula:\n    $$\n    S_m(E) = K \\frac{z^2 Z}{A} \\frac{1}{\\beta^2} \\left[ \\frac{1}{2}\\ln\\!\\left(\\frac{2 m_e c^2 \\beta^2 \\gamma^2\\, T_{\\max}}{I^2}\\right) - \\beta^2 \\right]\n    $$\n    Here, the density effect $\\delta$ is taken as $0$. The relativistic terms, Lorentz factor $\\gamma = 1 + E/(m_p c^2)$ and squared velocity $\\beta^2 = 1 - 1/\\gamma^2$, are calculated first. Subsequently, the maximum kinetic energy transferable to a target electron in a single collision, $T_{\\max}$, is computed using its full relativistic expression:\n    $$\n    T_{\\max} = \\frac{2 m_e c^2 \\beta^2 \\gamma^2}{1 + 2\\gamma (m_e/m_p) + (m_e/m_p)^2}\n    $$\n    The term $A$ in the $Z/A$ factor is treated as the dimensionless mass number, numerically equal to the provided molar mass value. This interpretation ensures dimensional consistency, as the constant $K$ is given in units of $\\mathrm{MeV\\,cm^2/g}$.\n\n3.  **Low-Energy Treatment**: The Bethe formula is known to be inaccurate at low energies. The problem specifies a patching scheme to address this. For energies below a threshold $E_{\\mathrm{patch}} = 0.1\\,\\mathrm{MeV}$, the stopping power is approximated by a surrogate function $S_m^{\\mathrm{low}}(E)$. For any initial energy $E_0 > E_{\\mathrm{patch}}$, the contribution to the total range from the energy interval $[0, E_{\\mathrm{patch}}]$ is given by the analytical expression:\n    $$\n    R_m^{\\mathrm{low}} = \\frac{2 E_{\\mathrm{patch}}}{S_m(E_{\\mathrm{patch}})}\n    $$\n    This value is computed once and used for all test cases, as all specified initial energies exceed $E_{\\mathrm{patch}}$.\n\n4.  **Numerical Integration**: The remaining portion of the areal range, from $E_{\\mathrm{patch}}$ to the initial energy $E_0$, is calculated by numerically integrating the reciprocal of the Bethe stopping power function:\n    $$\n    R_m^{\\mathrm{Bethe}}(E_0) = \\int_{E_{\\mathrm{patch}}}^{E_0} \\frac{dE}{S_m(E)}\n    $$\n    This definite integral is computed using a robust adaptive quadrature routine, specifically `scipy.integrate.quad`, which ensures accuracy over the integration domain.\n\n5.  **Total Range and Comparison**: For each initial energy $E_0$ in the set $\\{1.0, 3.0, 10.0, 20.0\\}\\,\\mathrm{MeV}$, the total areal range is the sum of the low-energy and high-energy contributions: $R_m(E_0) = R_m^{\\mathrm{low}} + R_m^{\\mathrm{Bethe}}(E_0)$. This areal range, in units of $\\mathrm{g/cm^2}$, is then converted into a linear projected range $R(E_0)$ in millimeters:\n    $$\n    R(E_0)\\,\\mathrm{[mm]} = \\frac{R_m(E_0)\\,\\mathrm{[g/cm^2]}}{\\rho\\,\\mathrm{[g/cm^3]}} \\times 10\\,\\mathrm{[mm/cm]}\n    $$\n    The final range value is formatted to three significant figures. Subsequently, the calculated areal range $R_m(E_0)$ is compared against the provided semi-empirical SRIM-based value, $R_m^{\\mathrm{SRIM}}(E_0)$. A boolean result is determined by checking if the relative deviation falls within the specified tolerance of $35\\%$:\n    $$\n    \\left| \\frac{R_m(E_0) - R_m^{\\mathrm{SRIM}}(E_0)}{R_m^{\\mathrm{SRIM}}(E_0)} \\right| \\le 0.35\n    $$\n    The large tolerance acknowledges the inherent approximations in the provided Bethe model compared to more refined empirical models.\n\n6.  **Final Output**: The calculated ranges (in mm) and the boolean comparison results are collected into two separate lists. These lists are then formatted into a single output string as specified by the problem, representing a list of two lists.",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the proton range in aluminum using the Bethe formula and a low-energy patch,\n    and compares the results to SRIM-based expectations.\n    \"\"\"\n    # Fundamental constants and material parameters\n    K = 0.307075  # MeV cm^2/g\n    Z = 13.0  # Atomic number of Aluminum\n    A = 26.9815385  # Molar mass of Al; used as dimensionless mass number in formula\n    rho = 2.70  # Density of Aluminum in g/cm^3\n    I_MeV = 1.66e-4  # Mean excitation energy of Al in MeV\n    mec2 = 0.51099895  # Electron rest mass energy in MeV\n    mpc2 = 938.2720813  # Proton rest mass energy in MeV\n    z = 1.0  # Proton charge number\n    E_patch = 0.1  # Patching energy in MeV\n    delta = 0.0 # Density effect correction\n\n    # Test suite and SRIM expectations\n    test_energies_MeV = [1.0, 3.0, 10.0, 20.0]\n    r_srim_g_cm2 = {\n        1.0: 6.5e-3,\n        3.0: 1.8e-2,\n        10.0: 1.4e-1,\n        20.0: 3.3e-1\n    }\n\n    def s_m(E: float) - float:\n        \"\"\"\n        Calculates the mass stopping power S_m(E) in MeV cm^2/g using the Bethe formula.\n        \"\"\"\n        if E = 0:\n            return np.inf\n        \n        gamma = 1.0 + E / mpc2\n        beta2 = 1.0 - 1.0 / (gamma**2)\n        \n        if beta2 = 0:\n            return np.inf\n\n        me_over_mp = mec2 / mpc2\n        \n        # Maximum kinetic energy transfer T_max\n        T_max_num_term = 2.0 * mec2 * beta2 * gamma**2\n        T_max_den = 1.0 + 2.0 * gamma * me_over_mp + me_over_mp**2\n        T_max = T_max_num_term / T_max_den\n\n        # Logarithm argument in the Bethe formula\n        log_arg = T_max_num_term * T_max / (I_MeV**2)\n        if log_arg = 0:\n              return np.inf\n              \n        # Bracketed term in the Bethe formula\n        bracket_term = 0.5 * np.log(log_arg) - beta2 - delta / 2.0\n        \n        # Full mass stopping power formula\n        stopping_power = K * (z**2 * Z / A) * (1.0 / beta2) * bracket_term\n        return stopping_power\n\n    # Calculate the fixed low-energy contribution to the range\n    s_m_at_patch = s_m(E_patch)\n    r_m_low_contribution = (2.0 * E_patch) / s_m_at_patch\n\n    # Define the integrand for the high-energy part of the range calculation\n    def integrand(E: float) - float:\n        return 1.0 / s_m(E)\n\n    # Lists to store the results\n    ranges_mm = []\n    booleans = []\n\n    # Main calculation loop for each initial energy\n    for E0 in test_energies_MeV:\n        # Numerically integrate to find the high-energy part of the areal range\n        r_m_bethe, _ = integrate.quad(integrand, E_patch, E0)\n\n        # Total areal range (g/cm^2)\n        r_m_total = r_m_low_contribution + r_m_bethe\n\n        # Convert to projected linear range (cm), then to mm\n        r_cm = r_m_total / rho\n        r_mm = r_cm * 10.0\n        \n        # Format to three significant figures and store\n        ranges_mm.append(f\"{r_mm:.3g}\")\n\n        # Compare with SRIM-based expectation\n        r_m_srim = r_srim_g_cm2[E0]\n        relative_deviation = abs(r_m_total - r_m_srim) / r_m_srim\n        agrees = relative_deviation = 0.35\n        booleans.append(agrees)\n\n    # Format the final output string as per requirements\n    ranges_str = \",\".join(ranges_mm)\n    booleans_str = \",\".join(str(b).lower() for b in booleans)\n    print(f\"[[{ranges_str}],[{booleans_str}]]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The measurement of a reaction cross section, $\\sigma$, which quantifies the intrinsic probability of a nuclear transmutation, is a cornerstone of experimental nuclear science. This practice bridges the gap between macroscopic experimental observables—such as beam current, target areal density, and the measured rate of product formation—and this fundamental microscopic property. You will not only deduce the cross section from first principles but also, critically, perform an error propagation analysis to quantify the uncertainty in your result, a vital skill for any experimentalist .",
            "id": "2948326",
            "problem": "A thin self-supporting target of stable nuclide is irradiated by a monoenergetic proton beam from a cyclotron to induce a nuclear transmutation. In the thin-target limit and neglecting attenuation, each incident projectile has a reaction probability equal to the product of the target’s areal number density and the microscopic reaction cross section. The accelerator current is measured with a Faraday cup. A steady-state online gamma spectrometer indicates a constant formation rate of the reaction product.\n\nGiven:\n- Measured product formation rate (assume negligible uncertainty compared to other sources): $R = 1.20 \\times 10^{5}\\ \\text{s}^{-1}$.\n- Beam current (standard uncertainty dominated by calibration): $I = 0.800\\ \\mu\\text{A}$ with a standard relative uncertainty of $2.0 \\times 10^{-2}$.\n- Target areal number density (measured by Rutherford Backscattering Spectrometry (RBS)): $n_{t} = 5.00 \\times 10^{17}\\ \\text{atoms}\\ \\text{cm}^{-2}$ with a standard relative uncertainty of $4.0 \\times 10^{-2}$.\n- Projectile charge magnitude: $q = e = 1.602\\,176\\,634 \\times 10^{-19}\\ \\text{C}$.\n- Definition: $1\\ \\text{barn} = 10^{-24}\\ \\text{cm}^{2}$ and $1\\ \\text{millibarn} = 10^{-3}\\ \\text{barn}$.\n\nAssumptions:\n- Thin-target approximation applies and beam attenuation in the target is negligible.\n- The only non-negligible uncertainties are from $I$ and $n_{t}$.\n- The uncertainties in $I$ and $n_{t}$ are uncorrelated and sufficiently small for first-order (linear) uncertainty propagation.\n\nTask:\nStarting from fundamental definitions relating reaction rate, beam current, projectile charge, and areal number density, derive the expression for the deduced microscopic cross section $\\sigma$ and its standard uncertainty due to $I$ and $n_{t}$ using standard first-order error propagation. Then calculate the numerical value of the standard uncertainty of $\\sigma$ and express it in millibarns. Round your final result to three significant figures and report it in millibarns as specified (do not include units inside the final boxed answer).",
            "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n**Step 1: Extract Givens**\n- Product formation rate: $R = 1.20 \\times 10^{5}\\ \\text{s}^{-1}$.\n- Beam current: $I = 0.800\\ \\mu\\text{A}$.\n- Standard relative uncertainty in current: $\\frac{u(I)}{I} = 2.0 \\times 10^{-2}$.\n- Target areal number density: $n_{t} = 5.00 \\times 10^{17}\\ \\text{atoms}\\ \\text{cm}^{-2}$.\n- Standard relative uncertainty in areal density: $\\frac{u(n_{t})}{n_{t}} = 4.0 \\times 10^{-2}$.\n- Projectile charge magnitude (elementary charge): $q = e = 1.602\\,176\\,634 \\times 10^{-19}\\ \\text{C}$.\n- Definitions: $1\\ \\text{barn} = 10^{-24}\\ \\text{cm}^{2}$, $1\\ \\text{millibarn} = 10^{-3}\\ \\text{barn}$.\n- Assumptions: Thin-target approximation; negligible beam attenuation; only uncertainties in $I$ and $n_{t}$ are non-negligible; uncertainties are uncorrelated and small, permitting first-order propagation.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, describing a standard nuclear reaction experiment. The relationship between reaction rate, flux, target density, and cross section is fundamental to nuclear physics. The parameters and experimental setup (cyclotron, Faraday cup, RBS, gamma spectrometer) are realistic. The problem is well-posed, providing all necessary information and clear assumptions to derive a unique solution for the cross section and its uncertainty. The language is objective and quantitative. The problem is therefore deemed valid.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be provided.\n\n**Derivation and Calculation**\nThe rate of nuclear reactions, $R$, in the thin-target limit is given by the product of the incident projectile flux, $\\Phi_{p}$, the number of target nuclei per unit area, $n_{t}$, and the microscopic reaction cross section, $\\sigma$.\n$$R = \\Phi_{p} n_{t} \\sigma$$\nThe projectile flux, $\\Phi_{p}$, is the number of projectiles incident on the target per unit time. This is related to the beam current, $I$, which is the total charge per unit time, and the charge of a single projectile, $q$.\n$$\\Phi_{p} = \\frac{I}{q}$$\nSubstituting the expression for flux into the rate equation gives:\n$$R = \\left(\\frac{I}{q}\\right) n_{t} \\sigma$$\nFrom this fundamental relationship, we solve for the microscopic cross section, $\\sigma$:\n$$\\sigma = \\frac{R q}{I n_{t}}$$\nTo determine the standard uncertainty of $\\sigma$, denoted $u(\\sigma)$, we use the formula for first-order propagation of uncorrelated uncertainties. For a function $\\sigma(I, n_{t})$, the square of its uncertainty is given by:\n$$u^{2}(\\sigma) \\approx \\left(\\frac{\\partial \\sigma}{\\partial I}\\right)^{2} u^{2}(I) + \\left(\\frac{\\partial \\sigma}{\\partial n_{t}}\\right)^{2} u^{2}(n_{t})$$\nThe required partial derivatives are:\n$$\\frac{\\partial \\sigma}{\\partial I} = \\frac{\\partial}{\\partial I} \\left(\\frac{R q}{I n_{t}}\\right) = -\\frac{R q}{I^{2} n_{t}} = -\\frac{1}{I} \\left(\\frac{R q}{I n_{t}}\\right) = -\\frac{\\sigma}{I}$$\n$$\\frac{\\partial \\sigma}{\\partial n_{t}} = \\frac{\\partial}{\\partial n_{t}} \\left(\\frac{R q}{I n_{t}}\\right) = -\\frac{R q}{I n_{t}^{2}} = -\\frac{1}{n_{t}} \\left(\\frac{R q}{I n_{t}}\\right) = -\\frac{\\sigma}{n_{t}}$$\nSubstituting these into the uncertainty propagation formula yields:\n$$u^{2}(\\sigma) \\approx \\left(-\\frac{\\sigma}{I}\\right)^{2} u^{2}(I) + \\left(-\\frac{\\sigma}{n_{t}}\\right)^{2} u^{2}(n_{t}) = \\sigma^{2} \\left(\\frac{u(I)}{I}\\right)^{2} + \\sigma^{2} \\left(\\frac{u(n_{t})}{n_{t}}\\right)^{2}$$\nDividing by $\\sigma^{2}$ gives the expression for the relative uncertainty squared:\n$$\\left(\\frac{u(\\sigma)}{\\sigma}\\right)^{2} \\approx \\left(\\frac{u(I)}{I}\\right)^{2} + \\left(\\frac{u(n_{t})}{n_{t}}\\right)^{2}$$\nThe task is to find the absolute standard uncertainty, $u(\\sigma)$. First, we calculate the value of $\\sigma$ using the provided data.\nThe current is $I = 0.800\\ \\mu\\text{A} = 0.800 \\times 10^{-6}\\ \\text{A} = 0.800 \\times 10^{-6}\\ \\text{C}\\ \\text{s}^{-1}$.\n$$\n\\sigma = \\frac{(1.20 \\times 10^{5}\\ \\text{s}^{-1})(1.602\\,176\\,634 \\times 10^{-19}\\ \\text{C})}{(0.800 \\times 10^{-6}\\ \\text{C}\\ \\text{s}^{-1})(5.00 \\times 10^{17}\\ \\text{atoms}\\ \\text{cm}^{-2})}\n$$\n$$\n\\sigma = \\frac{1.92261196 \\times 10^{-14}}{4.00 \\times 10^{11}}\\ \\text{cm}^{2} = 0.480653 \\times 10^{-25}\\ \\text{cm}^{2} = 4.80653 \\times 10^{-26}\\ \\text{cm}^{2}\n$$\nNow, we calculate the relative uncertainty squared using the given values:\n$$\\left(\\frac{u(\\sigma)}{\\sigma}\\right)^{2} = (2.0 \\times 10^{-2})^{2} + (4.0 \\times 10^{-2})^{2} = 4.0 \\times 10^{-4} + 16.0 \\times 10^{-4} = 20.0 \\times 10^{-4} = 2.0 \\times 10^{-3}$$\nThe absolute uncertainty $u(\\sigma)$ is then:\n$$u(\\sigma) = \\sigma \\sqrt{2.0 \\times 10^{-3}} = (4.80653 \\times 10^{-26}\\ \\text{cm}^{2}) \\sqrt{2.0 \\times 10^{-3}}$$\n$$u(\\sigma) \\approx (4.80653 \\times 10^{-26}\\ \\text{cm}^{2}) (0.04472136) \\approx 2.1498 \\times 10^{-27}\\ \\text{cm}^{2}$$\nThe problem requires the answer in millibarns ($\\text{mb}$). We use the given conversions:\n$$1\\ \\text{millibarn} = 10^{-3}\\ \\text{barn} = 10^{-3} \\times (10^{-24}\\ \\text{cm}^{2}) = 10^{-27}\\ \\text{cm}^{2}$$\nTherefore, the conversion factor is $1\\ \\text{mb} = 10^{-27}\\ \\text{cm}^{2}$.\n$$u(\\sigma) = \\frac{2.1498 \\times 10^{-27}\\ \\text{cm}^{2}}{10^{-27}\\ \\text{cm}^{2}/\\text{mb}} \\approx 2.1498\\ \\text{mb}$$\nRounding the result to three significant figures, we obtain:\n$$u(\\sigma) = 2.15\\ \\text{mb}$$\nThis is the standard uncertainty of the calculated cross section.",
            "answer": "$$\\boxed{2.15}$$"
        },
        {
            "introduction": "While simple models often assume targets are \"thin\" and beam fluxes are low, many realistic experiments operate outside these limits. This advanced practice challenges you to build a comprehensive model for a \"thick\" target, accounting for two critical effects: the attenuation of the beam as it penetrates the material (self-shielding) and the depletion of target nuclei during a long, high-intensity irradiation (burnup). By deriving and implementing a model that includes these phenomena, you will learn to quantify the systematic bias introduced by oversimplified assumptions and gain insight into the complexities of high-yield activation experiments .",
            "id": "2948320",
            "problem": "A monoenergetic, collimated charged-particle beam of constant fluence rate impinges on a plane-parallel target of area and thickness. The beam interacts with target nuclei to produce a radioactive product via a single activation channel, and the beam is attenuated through the target by non-productive interactions in the bulk matrix (self-shielding). You will derive and implement a thick-target activation model that includes both depth-dependent self-shielding and time-dependent burnup (depletion) of the target nuclei, then use it to quantify how neglecting these effects biases the microscopic cross section deduced by a naive thin-target analysis.\n\nBase your derivation only on the following fundamental laws and core definitions:\n- The Beer–Lambert attenuation law for a monoenergetic beam in a slab: if the macroscopic attenuation coefficient is denoted by $\\Sigma_{\\mathrm{m}}$ (in $\\mathrm{cm}^{-1}$), then the depth-dependent fluence rate is $\\phi(x) = \\phi_{0}\\,e^{-\\Sigma_{\\mathrm{m}} x}$ for depth $x \\in [0,L]$.\n- First-order reaction kinetics for transmutation and radioactive decay: at depth $x$ and time $t$, with target number density $N_{\\mathrm{T}}(x,t)$ (in $\\mathrm{cm}^{-3}$), microscopic activation cross section $\\sigma_{\\mathrm{a}}$ (in $\\mathrm{cm}^{2}$), and decay constant $\\lambda$ (in $\\mathrm{s}^{-1}$), the local reaction rate density is $R(x,t) = \\phi(x)\\,\\sigma_{\\mathrm{a}}\\,N_{\\mathrm{T}}(x,t)$. The coupled ordinary differential equations (ODEs) are $dN_{\\mathrm{T}}/dt = -R(x,t)$ and $dN_{\\mathrm{P}}/dt = R(x,t) - \\lambda N_{\\mathrm{P}}(x,t)$, where $N_{\\mathrm{P}}(x,t)$ is the product number density (in $\\mathrm{cm}^{-3}$).\n- Radioactive decay during waiting and counting: if $N_{\\mathrm{P}}(x,T_{\\mathrm{irr}})$ are the product atoms at end of irradiation time $T_{\\mathrm{irr}}$, then the net counts recorded in a subsequent counting interval of duration $\\Delta t_{\\mathrm{c}}$ starting after a wait time $t_{\\mathrm{w}}$ is $C = f_{\\mathrm{det}} \\int_{t_{\\mathrm{w}}}^{t_{\\mathrm{w}}+\\Delta t_{\\mathrm{c}}} \\lambda \\left[\\int_{V} N_{\\mathrm{P}}(x,T_{\\mathrm{irr}})\\,dV\\right] e^{-\\lambda (t - T_{\\mathrm{irr}})} dt$, where $f_{\\mathrm{det}}$ is the product of full-energy peak detection efficiency and emission probability (dimensionless), and $V$ is the target volume.\n\nTask:\n- From these bases, derive expressions sufficient to compute the measured counts $C$ for a finite-thickness slab target with area $A$ (in $\\mathrm{cm}^{2}$) and thickness $L$ (in $\\mathrm{cm}$), allowing $N_{\\mathrm{T}}$ to deplete by burnup and allowing $\\phi(x)$ to attenuate by self-shielding through $\\Sigma_{\\mathrm{m}}$. You may assume that $\\Sigma_{\\mathrm{m}}$ is independent of $t$ and is not altered by burnup, and that $\\sigma_{\\mathrm{a}}$ is independent of $x$ and $t$.\n- Consider a naive thin-target analysis that ignores both burnup and self-shielding. In that analysis, one assumes a uniform fluence rate $\\phi_{0}$ through the target, no depletion of $N_{\\mathrm{T}}$, and the textbook build-up under constant production and decay during irradiation. Under these assumptions, the thin-target model predicts that a measured $C$ corresponds to a deduced cross section $\\sigma_{\\mathrm{ded}}$ given by an algebraic inversion of the thin-target activation build-up and decay expression.\n- Define the bias due to neglecting self-shielding and burnup as the dimensionless ratio $r = \\sigma_{\\mathrm{ded}} / \\sigma_{\\mathrm{true}}$, where $\\sigma_{\\mathrm{true}}$ is the actual microscopic cross section used by Nature in the irradiation (the one appearing in the reaction rate). Your program must compute $r$ for each test case below.\n\nImplementation requirements:\n- Implement the depth integration over $x \\in [0,L]$ to obtain the total number of product atoms at the end of irradiation, $N_{\\mathrm{P,tot}}(T_{\\mathrm{irr}}) = \\int_{V} N_{\\mathrm{P}}(x,T_{\\mathrm{irr}})\\,dV = A \\int_{0}^{L} N_{\\mathrm{P}}(x,T_{\\mathrm{irr}})\\,dx$. You may perform this integral numerically.\n- Use the exact time dependence implied by the ODEs and by exponential decay during waiting and counting. Do not linearize in $t$ or $x$.\n- Units and constants:\n  - Use $\\mathrm{cm}$, $\\mathrm{s}$, and $\\mathrm{barn}$ consistently. One barn equals $10^{-24}\\,\\mathrm{cm}^{2}$. Express all cross sections in barns in the input parameters, but convert internally to $\\mathrm{cm}^{2}$ for computation.\n  - The fluence rate $\\phi_{0}$ must be in $\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}$, number densities in $\\mathrm{cm}^{-3}$, areas in $\\mathrm{cm}^{2}$, lengths in $\\mathrm{cm}$, and times in $\\mathrm{s}$.\n  - If a half-life $T_{1/2}$ is provided, convert to a decay constant by $\\lambda = \\ln(2) / T_{1/2}$.\n- Output specification:\n  - For each test case, output the ratio $r$ as a floating-point number (unitless).\n  - Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered to correspond to the test cases below, for example, [$r_1, r_2, r_3$].\n\nTest suite:\nFor all cases, take the detection factor $f_{\\mathrm{det}} = $ $0.12$ (dimensionless), waiting time $t_{\\mathrm{w}} = $ $1800\\,\\mathrm{s}$, counting time $\\Delta t_{\\mathrm{c}} = $ $1200\\,\\mathrm{s}$, target area $A = $ $1.0\\,\\mathrm{cm}^{2}$, and initial target number density $N_{\\mathrm{T0}} = $ $5.0 \\times 10^{22}\\,\\mathrm{cm}^{-3}$.\n\n- Case A (happy path; negligible self-shielding and burnup):\n  - Beam fluence rate $\\phi_{0} = $ $1.0 \\times 10^{12}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}$,\n  - Microscopic cross section $\\sigma_{\\mathrm{a}} = $ $0.20\\,\\mathrm{barn}$,\n  - Macroscopic matrix attenuation $\\Sigma_{\\mathrm{m}} = $ $0.020\\,\\mathrm{cm}^{-1}$,\n  - Target thickness $L = $ $0.020\\,\\mathrm{cm}$,\n  - Irradiation time $T_{\\mathrm{irr}} = $ $3600\\,\\mathrm{s}$,\n  - Product half-life $T_{1/2} = $ $6.0\\,\\mathrm{h}$.\n\n- Case B (stronger self-shielding; negligible burnup):\n  - Beam fluence rate $\\phi_{0} = $ $1.0 \\times 10^{12}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}$,\n  - Microscopic cross section $\\sigma_{\\mathrm{a}} = $ $0.20\\,\\mathrm{barn}$,\n  - Macroscopic matrix attenuation $\\Sigma_{\\mathrm{m}} = $ $2.00\\,\\mathrm{cm}^{-1}$,\n  - Target thickness $L = $ $0.50\\,\\mathrm{cm}$,\n  - Irradiation time $T_{\\mathrm{irr}} = $ $3600\\,\\mathrm{s}$,\n  - Product half-life $T_{1/2} = $ $6.0\\,\\mathrm{h}$.\n\n- Case C (mild self-shielding; significant burnup relative to decay):\n  - Beam fluence rate $\\phi_{0} = $ $5.0 \\times 10^{14}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}$,\n  - Microscopic cross section $\\sigma_{\\mathrm{a}} = $ $800\\,\\mathrm{barn}$,\n  - Macroscopic matrix attenuation $\\Sigma_{\\mathrm{m}} = $ $0.10\\,\\mathrm{cm}^{-1}$,\n  - Target thickness $L = $ $0.10\\,\\mathrm{cm}$,\n  - Irradiation time $T_{\\mathrm{irr}} = $ $1.0 \\times 10^{6}\\,\\mathrm{s}$,\n  - Product half-life $T_{1/2} = $ $30.0\\,\\mathrm{d}$.\n\nAnswer format and unit:\n- The required final output is a single line in the format [$r_{\\text{A}}, r_{\\text{B}}, r_{\\text{C}}$], where each $r$ is the deduced-to-true microscopic cross section ratio (unitless). Each $r$ must be printed as a decimal number (not a fraction and not a percentage).\n\nScientific realism constraints:\n- Assume monoenergetic projectiles and energy-independent $\\sigma_{\\mathrm{a}}$ across the slab.\n- Assume no scattering back into the beam, no secondary production channels, and no target geometry effects beyond one-dimensional depth dependence.\n- Ensure numerical integration accuracy is sufficient to resolve cases where attenuation or burnup is strong.",
            "solution": "The problem requires the derivation and implementation of a model for thick-target activation, accounting for both beam attenuation (self-shielding) and target nucleus depletion (burnup). The goal is to quantify the bias introduced by a naive thin-target analysis, which neglects these effects. The bias is defined as the ratio of the deduced cross section, $\\sigma_{\\mathrm{ded}}$, to the true cross section, $\\sigma_{\\mathrm{true}}$ (denoted as $\\sigma_{\\mathrm{a}}$ in the problem statement).\n\nFirst, the validation of the problem statement is performed.\n\n**Step 1: Extract Givens**\n\n- **Fundamental Laws  Definitions:**\n  - Beer-Lambert Law: Fluence rate at depth $x$ is $\\phi(x) = \\phi_{0}\\,e^{-\\Sigma_{\\mathrm{m}} x}$ for $x \\in [0,L]$, with macroscopic attenuation coefficient $\\Sigma_{\\mathrm{m}}$ ($\\mathrm{cm}^{-1}$).\n  - First-Order Kinetics:\n    - Local reaction rate density: $R(x,t) = \\phi(x)\\,\\sigma_{\\mathrm{a}}\\,N_{\\mathrm{T}}(x,t)$.\n    - Target depletion ODE: $dN_{\\mathrm{T}}/dt = -R(x,t)$.\n    - Product formation ODE: $dN_{\\mathrm{P}}/dt = R(x,t) - \\lambda N_{\\mathrm{P}}(x,t)$.\n    - Variables: target number density $N_{\\mathrm{T}}(x,t)$ ($\\mathrm{cm}^{-3}$), product number density $N_{\\mathrm{P}}(x,t)$ ($\\mathrm{cm}^{-3}$), microscopic activation cross section $\\sigma_{\\mathrm{a}}$ ($\\mathrm{cm}^{2}$), decay constant $\\lambda$ ($\\mathrm{s}^{-1}$).\n  - Radioactive Decay and Counting: Net counts $C = f_{\\mathrm{det}} \\int_{t_{\\mathrm{w}}}^{t_{\\mathrm{w}}+\\Delta t_{\\mathrm{c}}} \\lambda \\left[\\int_{V} N_{\\mathrm{P}}(x,T_{\\mathrm{irr}})\\,dV\\right] e^{-\\lambda (t - T_{\\mathrm{irr}})} dt$.\n    - Constants: detection factor $f_{\\mathrm{det}}$, irradiation time $T_{\\mathrm{irr}}$, wait time $t_{\\mathrm{w}}$, counting time $\\Delta t_{\\mathrm{c}}$, target volume $V$.\n- **Assumptions:**\n  - $\\Sigma_{\\mathrm{m}}$ is independent of time and not altered by burnup.\n  - $\\sigma_{\\mathrm{a}}$ is independent of depth $x$ and time $t$.\n- **Task:**\n  - Derive expressions to compute measured counts $C$ for a slab target of area $A$ and thickness $L$.\n  - Define bias $r = \\sigma_{\\mathrm{ded}} / \\sigma_{\\mathrm{true}}$. $\\sigma_{\\mathrm{ded}}$ is from inverting a naive thin-target model.\n  - Implement numerical integration for the depth dependence.\n- **Constants and Units:**\n  - $1\\,\\mathrm{barn} = 10^{-24}\\,\\mathrm{cm}^{2}$.\n  - $\\lambda = \\ln(2) / T_{1/2}$.\n- **Shared Parameters for Test Suite:**\n  - $f_{\\mathrm{det}} = 0.12$\n  - $t_{\\mathrm{w}} = 1800\\,\\mathrm{s}$\n  - $\\Delta t_{\\mathrm{c}} = 1200\\,\\mathrm{s}$\n  - $A = 1.0\\,\\mathrm{cm}^{2}$\n  - Initial target number density $N_{\\mathrm{T0}} = 5.0 \\times 10^{22}\\,\\mathrm{cm}^{-3}$\n- **Test Cases:** Specific values for $\\phi_{0}$, $\\sigma_{\\mathrm{a}}$, $\\Sigma_{\\mathrm{m}}$, $L$, $T_{\\mathrm{irr}}$, and $T_{1/2}$ are given for Case A, B, and C.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is evaluated against the specified criteria:\n- **Scientifically Grounded:** The problem is based on the fundamental principles of nuclear reaction kinetics (first-order rate equations) and particle transport (Beer-Lambert law). These are standard and well-established models in physics. The assumptions, such as a monoenergetic beam and energy-independent cross sections, are common and acceptable simplifications for creating a tractable model.\n- **Well-Posed:** The problem is clearly defined. It provides all necessary governing equations, initial conditions ($N_{\\mathrm{T}}(x,0) = N_{\\mathrm{T0}}$, $N_{\\mathrm{P}}(x,0) = 0$), and parameters to calculate the 'true' outcome. It also precisely defines the 'naive' model and the method for calculating the deduced cross section and the final bias ratio. A unique solution for the ratio $r$ exists for each parameter set.\n- **Objective:** The problem is stated in precise, objective, and quantitative terms. There is no subjective or ambiguous language.\n\nThe problem does not exhibit any of the listed flaws (Scientific Unsoundness, Non-Formalizable, Incomplete Setup, Unrealistic Conditions, etc.). The provided parameters are within physically plausible ranges for nuclear activation experiments.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A full, reasoned solution will be provided.\n\n**Derivation of the Model**\n\nThe derivation proceeds in three main parts: the full 'true' model, the simplified 'naive' model, and the calculation of the bias ratio.\n\n**1. The 'True' Model with Self-Shielding and Burnup**\n\nWe begin by solving the coupled differential equations at a fixed depth $x$. The fluence rate is $\\phi(x) = \\phi_0 e^{-\\Sigma_{\\mathrm{m}} x}$.\n\nFirst, we solve for the target number density $N_{\\mathrm{T}}(x,t)$:\n$$\n\\frac{dN_{\\mathrm{T}}}{dt} = -R(x,t) = -\\phi(x) \\sigma_{\\mathrm{a}} N_{\\mathrm{T}}(x,t) = -(\\phi_0 \\sigma_{\\mathrm{a}} e^{-\\Sigma_{\\mathrm{m}} x}) N_{\\mathrm{T}}(x,t)\n$$\nThis is a first-order separable ordinary differential equation. We define a depth-dependent burnup rate constant, $\\Lambda_{\\mathrm{b}}(x) = \\phi_0 \\sigma_{\\mathrm{a}} e^{-\\Sigma_{\\mathrm{m}} x}$. The equation becomes $dN_{\\mathrm{T}}/dt = -\\Lambda_{\\mathrm{b}}(x) N_{\\mathrm{T}}$. With the initial condition $N_{\\mathrm{T}}(x,0) = N_{\\mathrm{T0}}$, the solution is:\n$$\nN_{\\mathrm{T}}(x,t) = N_{\\mathrm{T0}} e^{-\\Lambda_{\\mathrm{b}}(x) t} = N_{\\mathrm{T0}} \\exp\\left(-\\phi_0 \\sigma_{\\mathrm{a}} e^{-\\Sigma_{\\mathrm{m}} x} t\\right)\n$$\nNext, we solve for the product number density $N_{\\mathrm{P}}(x,t)$. The governing equation is:\n$$\n\\frac{dN_{\\mathrm{P}}}{dt} + \\lambda N_{\\mathrm{P}}(x,t) = R(x,t) = \\phi(x) \\sigma_{\\mathrm{a}} N_{\\mathrm{T}}(x,t) = \\Lambda_{\\mathrm{b}}(x) N_{\\mathrm{T0}} e^{-\\Lambda_{\\mathrm{b}}(x) t}\n$$\nThis is a first-order linear ordinary differential equation. We solve it using an integrating factor $e^{\\lambda t}$, subject to the initial condition $N_{\\mathrm{P}}(x,0) = 0$.\n$$\n\\frac{d}{dt}\\left(N_{\\mathrm{P}}(x,t) e^{\\lambda t}\\right) = \\Lambda_{\\mathrm{b}}(x) N_{\\mathrm{T0}} e^{-\\Lambda_{\\mathrm{b}}(x) t} e^{\\lambda t} = \\Lambda_{\\mathrm{b}}(x) N_{\\mathrm{T0}} e^{(\\lambda - \\Lambda_{\\mathrm{b}}(x)) t}\n$$\nIntegrating from $0$ to $t$, we obtain:\n$$\nN_{\\mathrm{P}}(x,t) e^{\\lambda t} = \\Lambda_{\\mathrm{b}}(x) N_{\\mathrm{T0}} \\int_0^t e^{(\\lambda - \\Lambda_{\\mathrm{b}}(x)) \\tau} d\\tau\n$$\nFor the general case where $\\lambda \\neq \\Lambda_{\\mathrm{b}}(x)$:\n$$\nN_{\\mathrm{P}}(x,t) = \\frac{\\Lambda_{\\mathrm{b}}(x) N_{\\mathrm{T0}}}{\\lambda - \\Lambda_{\\mathrm{b}}(x)} \\left(e^{-\\Lambda_{\\mathrm{b}}(x) t} - e^{-\\lambda t}\\right)\n$$\nIn the special case where $\\lambda = \\Lambda_{\\mathrm{b}}(x)$, the integrand becomes a constant, and the solution is $N_{\\mathrm{P}}(x,t) = \\Lambda_{\\mathrm{b}}(x) N_{\\mathrm{T0}} t e^{-\\lambda t}$.\n\nAt the end of irradiation, $t=T_{\\mathrm{irr}}$, the local product density is $N_{\\mathrm{P}}(x, T_{\\mathrm{irr}})$. The total number of product atoms, $N_{\\mathrm{P,tot}}(T_{\\mathrm{irr}})$, is obtained by integrating over the target volume $V = A \\cdot L$:\n$$\nN_{\\mathrm{P,tot}}(T_{\\mathrm{irr}}) = \\int_V N_{\\mathrm{P}}(x, T_{\\mathrm{irr}}) dV = A \\int_0^L N_{\\mathrm{P}}(x, T_{\\mathrm{irr}}) dx\n$$\nThis integral involving $N_{\\mathrm{P}}(x, T_{\\mathrm{irr}})$ is to be computed numerically.\n\nThe number of counts, $C_{\\mathrm{true}}$, is found by integrating the decay rate over the counting period:\n$$\nC_{\\mathrm{true}} = f_{\\mathrm{det}} N_{\\mathrm{P,tot}}(T_{\\mathrm{irr}}) \\int_{T_{\\mathrm{irr}}+t_{\\mathrm{w}}}^{T_{\\mathrm{irr}}+t_{\\mathrm{w}}+\\Delta t_{\\mathrm{c}}} \\lambda e^{-\\lambda(t - T_{\\mathrm{irr}})} dt = f_{\\mathrm{det}} N_{\\mathrm{P,tot}}(T_{\\mathrm{irr}}) e^{-\\lambda t_{\\mathrm{w}}} (1 - e^{-\\lambda \\Delta t_{\\mathrm{c}}})\n$$\n\n**2. The 'Naive' Thin-Target Model**\n\nThis model makes two simplifying assumptions: no self-shielding ($\\phi(x) = \\phi_0$) and no target burnup ($N_{\\mathrm{T}}(x,t) = N_{\\mathrm{T0}}$). The production rate is constant throughout the target: $R_{\\mathrm{naive}} = \\phi_0 \\sigma_{\\mathrm{a}} N_{\\mathrm{T0}}$.\nThe ODE for product formation becomes: $dN_{\\mathrm{P}}/dt = R_{\\mathrm{naive}} - \\lambda N_{\\mathrm{P}}$.\nThe solution for the product density at time $T_{\\mathrm{irr}}$ is:\n$$\nN_{\\mathrm{P,naive}}(T_{\\mathrm{irr}}) = \\frac{\\phi_0 \\sigma_{\\mathrm{a}} N_{\\mathrm{T0}}}{\\lambda} (1 - e^{-\\lambda T_{\\mathrm{irr}}})\n$$\nThe total number of product atoms is $N_{\\mathrm{P,tot,naive}} = N_{\\mathrm{P,naive}} \\cdot V = N_{\\mathrm{P,naive}} \\cdot (A L)$. The corresponding counts, $C_{\\mathrm{naive}}$, are given by:\n$$\nC_{\\mathrm{naive}}(\\sigma_{\\mathrm{a}}) = f_{\\mathrm{det}} \\left( \\frac{\\phi_0 \\sigma_{\\mathrm{a}} N_{\\mathrm{T0}} A L}{\\lambda} (1 - e^{-\\lambda T_{\\mathrm{irr}}}) \\right) e^{-\\lambda t_{\\mathrm{w}}} (1 - e^{-\\lambda \\Delta t_{\\mathrm{c}}})\n$$\n\n**3. Bias Ratio Calculation**\n\nTo find the deduced cross section, $\\sigma_{\\mathrm{ded}}$, we equate the measured counts from the true model, $C_{\\mathrm{true}}$, with the prediction from the naive model, $C_{\\mathrm{naive}}(\\sigma_{\\mathrm{ded}})$:\n$$\nC_{\\mathrm{true}} = C_{\\mathrm{naive}}(\\sigma_{\\mathrm{ded}})\n$$\n$$\nf_{\\mathrm{det}} N_{\\mathrm{P,tot}}(T_{\\mathrm{irr}}) e^{-\\lambda t_{\\mathrm{w}}} (1 - e^{-\\lambda \\Delta t_{\\mathrm{c}}}) = f_{\\mathrm{det}} \\left( \\frac{\\phi_0 \\sigma_{\\mathrm{ded}} N_{\\mathrm{T0}} A L}{\\lambda} (1 - e^{-\\lambda T_{\\mathrm{irr}}}) \\right) e^{-\\lambda t_{\\mathrm{w}}} (1 - e^{-\\lambda \\Delta t_{\\mathrm{c}}})\n$$\nThe terms for detection and decay cancel, leaving:\n$$\nN_{\\mathrm{P,tot}}(T_{\\mathrm{irr}}) = \\frac{\\phi_0 \\sigma_{\\mathrm{ded}} N_{\\mathrm{T0}} A L}{\\lambda} (1 - e^{-\\lambda T_{\\mathrm{irr}}})\n$$\nSolving for $\\sigma_{\\mathrm{ded}}$:\n$$\n\\sigma_{\\mathrm{ded}} = \\frac{N_{\\mathrm{P,tot}}(T_{\\mathrm{irr}}) \\lambda}{\\phi_0 N_{\\mathrm{T0}} A L (1 - e^{-\\lambda T_{\\mathrm{irr}}})}\n$$\nSubstituting $N_{\\mathrm{P,tot}}(T_{\\mathrm{irr}}) = A \\int_0^L N_{\\mathrm{P}}(x, T_{\\mathrm{irr}}) dx$:\n$$\n\\sigma_{\\mathrm{ded}} = \\frac{(A \\int_0^L N_{\\mathrm{P}}(x, T_{\\mathrm{irr}}) dx) \\lambda}{\\phi_0 N_{\\mathrm{T0}} A L (1 - e^{-\\lambda T_{\\mathrm{irr}}})} = \\frac{\\lambda \\int_0^L N_{\\mathrm{P}}(x, T_{\\mathrm{irr}}) dx}{\\phi_0 N_{\\mathrm{T0}} L (1 - e^{-\\lambda T_{\\mathrm{irr}}})}\n$$\nThe bias ratio is $r = \\sigma_{\\mathrm{ded}} / \\sigma_{\\mathrm{true}}$, where $\\sigma_{\\mathrm{true}} = \\sigma_{\\mathrm{a}}$.\n$$\nr = \\frac{1}{\\sigma_{\\mathrm{a}}} \\left( \\frac{\\lambda \\int_0^L N_{\\mathrm{P}}(x, T_{\\mathrm{irr}}) dx}{\\phi_0 N_{\\mathrm{T0}} L (1 - e^{-\\lambda T_{\\mathrm{irr}}})} \\right)\n$$\nThis is the final expression to be implemented. The integral will be evaluated using numerical methods, with the integrand $N_{\\mathrm{P}}(x, T_{\\mathrm{irr}})$ being the solution derived in part 1.",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the thick-target activation problem for three test cases.\n    \"\"\"\n\n    # --- Constants ---\n    BARN_TO_CM2 = 1e-24\n    \n    # --- Shared Parameters ---\n    # These are not needed for the ratio r calculation, as they cancel out,\n    # but are included for completeness.\n    # f_det = 0.12\n    # t_w_s = 1800.0\n    # dt_c_s = 1200.0\n    # A_cm2 = 1.0\n    N_T0_per_cm3 = 5.0e22\n\n    # --- Test Cases ---\n    test_cases = [\n        # Case A (happy path; negligible self-shielding and burnup)\n        {\n            \"phi0\": 1.0e12,           # cm^-2 s^-1\n            \"sigma_a_barn\": 0.20,     # barn\n            \"Sigma_m\": 0.020,         # cm^-1\n            \"L_cm\": 0.020,            # cm\n            \"T_irr_s\": 3600.0,        # s\n            \"T_half_s\": 6.0 * 3600.0, # s (6 hours)\n        },\n        # Case B (stronger self-shielding; negligible burnup)\n        {\n            \"phi0\": 1.0e12,           # cm^-2 s^-1\n            \"sigma_a_barn\": 0.20,     # barn\n            \"Sigma_m\": 2.00,          # cm^-1\n            \"L_cm\": 0.50,             # cm\n            \"T_irr_s\": 3600.0,        # s\n            \"T_half_s\": 6.0 * 3600.0, # s (6 hours)\n        },\n        # Case C (mild self-shielding; significant burnup relative to decay)\n        {\n            \"phi0\": 5.0e14,           # cm^-2 s^-1\n            \"sigma_a_barn\": 800.0,    # barn\n            \"Sigma_m\": 0.10,          # cm^-1\n            \"L_cm\": 0.10,             # cm\n            \"T_irr_s\": 1.0e6,         # s\n            \"T_half_s\": 30.0 * 24 * 3600.0, # s (30 days)\n        },\n    ]\n\n    def calculate_bias_ratio(params, N_T0):\n        \"\"\"\n        Calculates the bias ratio r = sigma_ded / sigma_true.\n        \"\"\"\n        # Unpack parameters\n        phi0 = params[\"phi0\"]\n        sigma_a_barn = params[\"sigma_a_barn\"]\n        Sigma_m = params[\"Sigma_m\"]\n        L_cm = params[\"L_cm\"]\n        T_irr_s = params[\"T_irr_s\"]\n        T_half_s = params[\"T_half_s\"]\n\n        # Convert units\n        sigma_a_cm2 = sigma_a_barn * BARN_TO_CM2\n        lambda_decay = np.log(2) / T_half_s\n\n        def integrand_Np(x, phi0, sigma_a, Sigma_m, T_irr, lambda_d, N_T0):\n            \"\"\"\n            Calculates N_P(x, T_irr), the product atom density at depth x.\n            This is the integrand for the spatial integration.\n            \"\"\"\n            lambda_burnup = phi0 * sigma_a * np.exp(-Sigma_m * x)\n\n            if np.isclose(lambda_burnup, lambda_d):\n                # Handle the special case where burnup rate equals decay constant\n                return lambda_d * N_T0 * T_irr * np.exp(-lambda_d * T_irr)\n            else:\n                # General case\n                term1 = lambda_burnup * N_T0 / (lambda_d - lambda_burnup)\n                term2 = np.exp(-lambda_burnup * T_irr) - np.exp(-lambda_d * T_irr)\n                return term1 * term2\n\n        # Perform numerical integration to get Integral[N_P(x, T_irr) dx] from 0 to L\n        integral_val, _ = integrate.quad(\n            integrand_Np,\n            0,\n            L_cm,\n            args=(phi0, sigma_a_cm2, Sigma_m, T_irr_s, lambda_decay, N_T0)\n        )\n\n        # Calculate the deduced cross section using the naive model's inverted formula\n        # sigma_ded = (lambda * Integral[N_p dx]) / (phi0 * N_T0 * L * (1 - exp[-lambda*T_irr]))\n        \n        # Use np.expm1 for better numerical precision if lambda*T_irr is small\n        # 1 - exp(-x) = -expm1(-x)\n        denominator_naive = phi0 * N_T0 * L_cm * (-np.expm1(-lambda_decay * T_irr_s))\n        \n        # Avoid division by zero if denominator is zero (e.g., if T_irr is zero)\n        if denominator_naive == 0:\n            # In the limit T_irr - 0, the denominator grows as T_irr, and the\n            # numerator also grows as T_irr, leading to a finite limit.\n            # Simplified: Np(x,T) ~ lambda_b(x)*N_T0*T, integral ~ T, denom ~ T.\n            # The ratio r approaches a value related to self-shielding only.\n            # The limit of the naive term (1-exp(-lambda*T_irr)) / lambda is T_irr.\n            sigma_ded_cm2_num = integral_val\n            sigma_ded_cm2_den = phi0 * N_T0 * L_cm * T_irr_s\n            if sigma_ded_cm2_den == 0:\n                return 1.0 # Trivial case T_irr=0 means no production, r=1\n            sigma_ded_cm2 = sigma_ded_cm2_num / sigma_ded_cm2_den\n        else:\n            sigma_ded_cm2 = (integral_val * lambda_decay) / denominator_naive\n\n        # Calculate the bias ratio\n        r = sigma_ded_cm2 / sigma_a_cm2\n        return r\n\n    results = []\n    for case in test_cases:\n        r = calculate_bias_ratio(case, N_T0_per_cm3)\n        results.append(r)\n\n    # Format the output as specified\n    print(f\"[{','.join(f'{res:.8f}' for res in results)}]\")\n\nsolve()\n\n```"
        }
    ]
}