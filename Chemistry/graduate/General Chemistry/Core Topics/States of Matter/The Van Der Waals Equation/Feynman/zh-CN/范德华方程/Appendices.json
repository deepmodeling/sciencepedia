{
    "hands_on_practices": [
        {
            "introduction": "理想气体定律在许多条件下为我们提供了有用的近似，但在高压和低（摩尔）体积下，分子间的作用力和分子自身的体积变得不可忽略。本练习将引导你应用范德华方程——一个对理想气体行为的经典修正——来解决一个实际的化学工程问题。通过计算在特定压力下达到给定体积所需的目标温度，你将亲身体验如何使用这个更精确的模型来预测真实气体的行为。",
            "id": "2026294",
            "problem": "一位材料科学家正准备在高压条件下合成一种新化合物。合成在一个密封的、容积固定的刚性钢制反应釜中进行，其内部容积为 $1.00 \\text{ L}$。为确保惰性气氛，先将反应釜抽成真空，然后充入 $2.50 \\text{ moles}$ 的氩气。实验方案要求，在引入反应物之前，氩气压力必须精确达到 $100.0 \\text{ atm}$。假设氩气为范德华气体，请计算为达到此目标压力，反应釜必须加热到的温度。\n\n在您的计算中使用以下常数：\n- 氩气的范德华常数$a$：$a = 1.345 \\frac{\\text{L}^2 \\cdot \\text{atm}}{\\text{mol}^2}$\n- 氩气的范德华常数$b$：$b = 0.03219 \\frac{\\text{L}}{\\text{mol}}$\n- 普适气体常数：$R = 0.08206 \\frac{\\text{L} \\cdot \\text{atm}}{\\text{mol} \\cdot \\text{K}}$\n\n最终答案的温度以开尔文为单位，并四舍五入至三位有效数字。",
            "solution": "给定一个容积固定的刚性反应釜，其中含有被视为范德华气体的氩气。对于固定物质量的气体，范德华状态方程为\n$$\n\\left[P + a\\left(\\frac{n}{V}\\right)^{2}\\right]\\left(V - nb\\right) = nRT.\n$$\n题目要求我们求出达到指定压力$P$所需的温度$T$，因此我们对方程进行代数求解得到$T$：\n$$\nT = \\frac{\\left[P + a\\left(\\frac{n}{V}\\right)^{2}\\right]\\left(V - nb\\right)}{nR}.\n$$\n代入给定数值 $P = 100.0\\,\\text{atm}$，$V = 1.00\\,\\text{L}$，$n = 2.50\\,\\text{mol}$，$a = 1.345\\,\\text{L}^{2}\\,\\text{atm}\\,\\text{mol}^{-2}$，$b = 0.03219\\,\\text{L}\\,\\text{mol}^{-1}$ 和 $R = 0.08206\\,\\text{L}\\,\\text{atm}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$。\n\n首先计算修正项：\n$$\n\\frac{n}{V} = \\frac{2.50}{1.00} = 2.50,\\quad \\left(\\frac{n}{V}\\right)^{2} = 6.25,\n$$\n$$\na\\left(\\frac{n}{V}\\right)^{2} = 1.345 \\times 6.25 = 8.40625\\ \\text{atm},\n$$\n$$\nP + a\\left(\\frac{n}{V}\\right)^{2} = 100.0 + 8.40625 = 108.40625\\ \\text{atm}.\n$$\n接下来，计算协体积修正：\n$$\nnb = 2.50 \\times 0.03219 = 0.080475\\ \\text{L},\\quad V - nb = 1.00 - 0.080475 = 0.919525\\ \\text{L}.\n$$\n构建温度表达式的分子和分母：\n$$\n\\left[P + a\\left(\\frac{n}{V}\\right)^{2}\\right]\\left(V - nb\\right) = 108.40625 \\times 0.919525 = 99.68225703125\\ \\text{L}\\cdot\\text{atm},\n$$\n$$\nnR = 2.50 \\times 0.08206 = 0.20515\\ \\text{L}\\cdot\\text{atm}\\,\\text{K}^{-1}.\n$$\n因此，\n$$\nT = \\frac{99.68225703125}{0.20515}\\ \\text{K} \\approx 485.899\\ \\text{K}.\n$$\n四舍五入至三位有效数字，所需温度为 $486\\ \\text{K}$。",
            "answer": "$$\\boxed{486}$$"
        },
        {
            "introduction": "范德华方程的强大之处不仅在于其对特定气体行为的修正，更在于它能够捕捉到相变的本质，例如气-液临界点。在这个临界点上，物质的液相和气相变得无法区分。本练习将带你深入探索范德华模型的数学结构，通过推导临界压缩因子$Z_c$，你将发现一个惊人的结果：尽管参数$a$和$b$因物质而异，但$Z_c$对于所有遵循范德华方程的气体来说是一个通用常数。",
            "id": "2026264",
            "problem": "范德华状态方程是理想气体定律的一个修正，它考虑了气体分子的非零体积以及它们之间的吸引力。其表达式为：\n$$ \\left(P + \\frac{a}{V_m^2}\\right)(V_m - b) = RT $$\n此处，$P$是压力，$V_m$是摩尔体积，$T$是绝对温度，$R$是普适气体常数。参数$a$和$b$是特定物质的常数，其中$a$用于校正分子间引力的影响，$b$用于校正有限分子体积的影响。\n\n对于任何物质，都存在一个由临界温度（$T_c$）、临界压力（$P_c$）和临界摩尔体积（$V_{m,c}$）定义的唯一“临界点”。在高于临界点的温度和压力下，液相和气相之间的区别消失，物质以一种被称为超临界流体的状态存在。在数学上，临界点对应于$P-V$等温线上的拐点。\n\n任何状态方程的一个关键预测是临界点处的压缩因子$Z = \\frac{PV_m}{RT}$的值。对于范德华模型，这个值$Z_c = \\frac{P_c V_{m,c}}{R T_c}$被预测为一个普适常数，与具体物质无关（即，与$a$和$b$无关）。\n\n请计算由范德华方程预测的临界压缩因子$Z_c$的这个普适值。将你的答案表示为一个精确的分数。",
            "solution": "从范德华方程开始，将其写成压力$P$是$V_{m}$和$T$的函数的形式：\n$$\nP=\\frac{R T}{V_{m}-b}-\\frac{a}{V_{m}^{2}}.\n$$\n在临界点，$P$–$V_{m}$等温线有一个拐点，因此\n$$\n\\left(\\frac{\\partial P}{\\partial V_{m}}\\right)_{T}=0,\\qquad \\left(\\frac{\\partial^{2} P}{\\partial V_{m}^{2}}\\right)_{T}=0\n$$\n在$V_{m}=V_{m,c}$和$T=T_{c}$处求值。计算导数：\n$$\n\\left(\\frac{\\partial P}{\\partial V_{m}}\\right)_{T}=-\\frac{R T}{\\left(V_{m}-b\\right)^{2}}+\\frac{2 a}{V_{m}^{3}},\n$$\n$$\n\\left(\\frac{\\partial^{2} P}{\\partial V_{m}^{2}}\\right)_{T}=\\frac{2 R T}{\\left(V_{m}-b\\right)^{3}}-\\frac{6 a}{V_{m}^{4}}.\n$$\n在临界点将它们设为零，得到\n$$\n\\frac{R T_{c}}{\\left(V_{m,c}-b\\right)^{2}}=\\frac{2 a}{V_{m,c}^{3}},\\qquad \\frac{R T_{c}}{\\left(V_{m,c}-b\\right)^{3}}=\\frac{3 a}{V_{m,c}^{4}}.\n$$\n用第二个方程除以第一个方程来消去$R T_{c}$：\n$$\n\\frac{1}{V_{m,c}-b}\\cdot \\frac{1}{1}=\\frac{3}{2}\\cdot \\frac{1}{V_{m,c}},\n$$\n化简得到\n$$\n2 V_{m,c}=3\\left(V_{m,c}-b\\right)\\quad \\Rightarrow \\quad V_{m,c}=3 b.\n$$\n将$V_{m,c}=3 b$代回一阶导数条件中以求得$T_{c}$。由\n$$\n\\frac{R T_{c}}{(3 b-b)^{2}}=\\frac{2 a}{(3 b)^{3}},\n$$\n我们得到\n$$\n\\frac{R T_{c}}{4 b^{2}}=\\frac{2 a}{27 b^{3}}\\quad \\Rightarrow \\quad R T_{c}=\\frac{8 a}{27 b}\\quad \\Rightarrow \\quad T_{c}=\\frac{8 a}{27 b R}.\n$$\n在$V_{m,c}=3 b$和$T_{c}$下，从状态方程计算$P_{c}$：\n$$\nP_{c}=\\frac{R T_{c}}{3 b-b}-\\frac{a}{(3 b)^{2}}=\\frac{R T_{c}}{2 b}-\\frac{a}{9 b^{2}}.\n$$\n使用$R T_{c}=\\frac{8 a}{27 b}$给出\n$$\nP_{c}=\\frac{1}{2 b}\\cdot \\frac{8 a}{27 b}-\\frac{a}{9 b^{2}}=\\frac{4 a}{27 b^{2}}-\\frac{3 a}{27 b^{2}}=\\frac{a}{27 b^{2}}.\n$$\n临界压缩因子为\n$$\nZ_{c}=\\frac{P_{c} V_{m,c}}{R T_{c}}=\\frac{\\left(\\frac{a}{27 b^{2}}\\right)\\left(3 b\\right)}{\\frac{8 a}{27 b}}=\\frac{\\frac{a}{9 b}}{\\frac{8 a}{27 b}}=\\frac{27}{72}=\\frac{3}{8}.\n$$\n因此，对于范德华模型，$Z_c$是一个与$a$和$b$无关的普适常数，其值为$\\frac{3}{8}$。",
            "answer": "$$\\boxed{\\frac{3}{8}}$$"
        },
        {
            "introduction": "这个高级练习将理论推导与计算实践相结合，代表了对范德华模型及其热力学基础的终极考验。你不仅需要从亥姆霍兹自由能出发推导出状态方程和临界参数，还需设计并实现一个鲁棒的数值求解器，能够区分并舍弃非物理的、力学不稳定的解。这项任务将使你掌握在现代科学研究中应用非理想气体模型所必需的理论深度和计算技能。",
            "id": "2961955",
            "problem": "要求您实现一个鲁棒的数值求解器，对于给定的温度$T$和压力$P$，计算遵循范德华模型的流体的摩尔体积$v$，同时避免与力学不稳定状态相关的伪根。该求解器必须基于区间法和二分法，以确保确定性和鲁棒性。\n\n从以下基本基础开始。考虑$N$摩尔范德华流体的亥姆霍兹自由能（HFE），\n$$\nA(T,V,N) = N R T\\left[\\ln\\left(\\frac{\\rho\\,\\Lambda^3}{1 - \\rho b}\\right) - 1\\right] - a\\,\\frac{N^2}{V},\n$$\n其中$R$是普适气体常数，$\\rho = N/V$是摩尔密度，$\\Lambda$是热德布罗意波长（它将在任何可测量的状态方程中被消去），$a$和$b$是流体的特征摩尔参数。使用压力在恒温和恒定粒子数下是亥姆霍兹自由能的负导数的定义，\n$$\nP(T,V,N) = -\\left(\\frac{\\partial A}{\\partial V}\\right)_{T,N},\n$$\n推导出压力作为温度和摩尔体积$v = V/N$的函数。然后，根据等温斜率的符号表达力学稳定性判据，\n$$\n\\left(\\frac{\\partial P}{\\partial v}\\right)_T,\n$$\n并解释它如何排除不稳定分支上的非物理根。最后，推导临界点作为以下方程组的联立解的条件：\n$$\n\\left(\\frac{\\partial P}{\\partial v}\\right)_{T} = 0,\n\\qquad\n\\left(\\frac{\\partial^2 P}{\\partial v^2}\\right)_{T} = 0,\n$$\n并用$a$、$b$和普适气体常数$R$表示临界摩尔体积$v_{\\mathrm{c}}$、临界温度$T_{\\mathrm{c}}$和临界压力$P_{\\mathrm{c}}$。\n\n算法要求：\n- 定义残差函数$f(v;T,P) = P_{\\mathrm{model}}(T,v) - P$，其中$P_{\\mathrm{model}}(T,v)$是上面推导出的压力。物理上允许的定义域是$v > b$。\n- 实现一个区间法加二分法的求解器，该求解器：\n  - 扫描$v \\in (b, v_{\\max}]$上的一个几何间隔网格，其中一个足够大的$v_{\\max}$根据理想气体估计值$v_{\\text{ig}} = R T / P$自适应确定。\n  - 识别$f(v;T,P)$的所有符号变化，以获得根的不相交区间。\n  - 对每个区间应用二分法，以高精度公差计算定义域$v > b$内的所有实根。\n  - 通过力学稳定性条件$\\left(\\frac{\\partial P}{\\partial v}\\right)_T \\le 0$过滤根，以拒绝非物理的不稳定根（其满足$\\left(\\frac{\\partial P}{\\partial v}\\right)_T > 0$）。将$\\left(\\frac{\\partial P}{\\partial v}\\right)_T = 0$的临界情况视为可接受的。\n  - 返回最大的稳定根，以保持在类气体分支上，该分支在低压下与理想气体极限连续。\n- 如果在给定输入的定义域$v > b$内不存在稳定根，则返回一个非数值（NaN）。\n\n物理和数值单位：\n- 始终使用国际单位制（SI）。\n- 普适气体常数为$R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 对于二氧化碳，使用$a = 0.3592\\,\\mathrm{Pa\\,m^6\\,mol^{-2}}$和$b = 4.267\\times 10^{-5}\\,\\mathrm{m^3\\,mol^{-1}}$。\n- 所有输出必须是摩尔体积$v$，单位为$\\mathrm{m^3\\,mol^{-1}}$，并四舍五入到八位有效数字。\n\n测试套件：\n实现您的程序以评估以下四个二氧化碳的测试用例，每个用例由SI单位的$(T,P)$指定。使用您自己推导的表达式定义的临界参数：\n- 用例 A（高于临界温度的单根）：$T = 1.2\\,T_{\\mathrm{c}}$，$P = 0.8\\,P_{\\mathrm{c}}$。\n- 用例 B（低于临界温度的三实根区域；返回类气体根）：$T = 0.9\\,T_{\\mathrm{c}}$，$P = 0.7\\,P_{\\mathrm{c}}$。\n- 用例 C（临界点；三重根）：$T = T_{\\mathrm{c}}$，$P = P_{\\mathrm{c}}$。\n- 用例 D（中等压力下的近理想气体区域）：$T = 350\\,\\mathrm{K}$，$P = 1.0\\times 10^{5}\\,\\mathrm{Pa}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个结果，以逗号分隔的列表形式，并用方括号括起来，顺序为 A, B, C, D。例如，打印的行必须如下所示：\n[resA,resB,resC,resD]\n其中每个条目都是一个浮点数，等于以$\\mathrm{m^3\\,mol^{-1}}$为单位的摩尔体积，并四舍五入到八位有效数字。",
            "solution": "所提出的问题具有科学依据，论述清晰且客观。它基于热力学的既定原理和真实流体的范德华模型。目标明确，所有必要的参数和常数均已提供，并且所需的算法方法已足够详细，可以得到唯一且可验证的解。因此，该问题被认为是有效的，下面提供了完整的解决方案。\n\n解决方案分两个阶段进行。首先，根据问题陈述中的规定，从基本原理推导出必要的理论框架。其次，设计并实现一个符合规定要求的数值算法。\n\n**1. 理论推导**\n\n**1.1. 范德华状态方程的推导**\n\n起点是在温度$T$、体积$V$中$N$个粒子的亥姆霍兹自由能$A$：\n$$\nA(T,V,N) = N R T\\left[\\ln\\left(\\frac{\\rho\\,\\Lambda^3}{1 - \\rho b}\\right) - 1\\right] - a\\,\\frac{N^2}{V}\n$$\n这里，$\\rho = N/V$是摩尔密度，$R$是普适气体常数，而$\\Lambda$是一个与温度相关的项。参数$a$和$b$是流体的特征摩尔参数，分别代表分子间吸引力和排除体积。为$a$（$\\mathrm{Pa\\,m^6\\,mol^{-2}}$）和$b$（$\\mathrm{m^3\\,mol^{-1}}$）提供的单位表明这些是摩尔量，与问题陈述一致。\n\n压力$P$是通过其热力学定义，即$A$在恒定$T$和$N$下对$V$的负偏导数得到的：\n$$\nP(T,V,N) = -\\left(\\frac{\\partial A}{\\partial V}\\right)_{T,N}\n$$\n我们计算导数。首先重写对数项的参数：$\\frac{\\rho\\Lambda^3}{1-\\rho b} = \\frac{(N/V)\\Lambda^3}{1-(N/V)b} = \\frac{N\\Lambda^3}{V-Nb}$。\n因此，$A = NRT[\\ln(N\\Lambda^3) - \\ln(V-Nb) - 1] - aN^2/V$。\n$$\n\\left(\\frac{\\partial A}{\\partial V}\\right)_{T,N} = \\frac{\\partial}{\\partial V}\\left(N R T\\left[\\ln(N\\Lambda^3) - \\ln(V - N b) - 1\\right] - a\\,\\frac{N^2}{V}\\right)\n$$\n项$\\ln(N\\Lambda^3)$和$-1$相对于$V$是常数，因此它们的导数为零。其余项的导数是：\n$$\n\\frac{\\partial}{\\partial V} \\left( -N R T \\ln(V - N b) \\right) = -N R T \\frac{1}{V - N b}\n$$\n$$\n\\frac{\\partial}{\\partial V} \\left( -a\\,\\frac{N^2}{V} \\right) = -a N^2 \\left( -V^{-2} \\right) = a \\frac{N^2}{V^2}\n$$\n结合这些结果：\n$$\n\\left(\\frac{\\partial A}{\\partial V}\\right)_{T,N} = -\\frac{N R T}{V - N b} + a \\frac{N^2}{V^2}\n$$\n应用压力的定义，我们得到：\n$$\nP = -\\left(-\\frac{N R T}{V - N b} + a \\frac{N^2}{V^2}\\right) = \\frac{N R T}{V - N b} - a \\frac{N^2}{V^2}\n$$\n为了用摩尔体积$v = V/N$来表示这个方程，我们将方程重排为：\n$$\nP = \\frac{R T}{V/N - b} - a \\frac{N^2}{(vN)^2} \\implies P = \\frac{R T}{v - b} - \\frac{a}{v^2}\n$$\n这简化为我们所熟知的范德华状态方程的强度形式：\n$$\nP(T,v) = \\frac{R T}{v - b} - \\frac{a}{v^2}\n$$\n这就是要在求解器中使用的模型压力$P_{\\mathrm{model}}(T,v)$。摩尔体积的物理定义域是$v > b$，因为体积不能小于分子的排除体积。\n\n**1.2. 力学稳定性判据**\n\n为了使一个系统处于力学稳定平衡状态，在恒定温度下，其压力不能随着体积的增加而增加。膨胀时压力增加会导致失控过程，这是非物理的。因此，稳定性判据是：\n$$\n\\left(\\frac{\\partial P}{\\partial V}\\right)_{T,N} \\le 0\n$$\n由于对于固定的摩尔数$N$，摩尔体积$v=V/N$与$V$成正比，因此该条件等价于：\n$$\n\\left(\\frac{\\partial P}{\\partial v}\\right)_T \\le 0\n$$\n等号成立的情况对应于临界稳定性（旋节线分解点和临界点）。对于范德华模型，该导数为：\n$$\n\\left(\\frac{\\partial P}{\\partial v}\\right)_T = \\frac{\\partial}{\\partial v}\\left(\\frac{R T}{v - b} - \\frac{a}{v^2}\\right) = -\\frac{R T}{(v - b)^2} + \\frac{2a}{v^3}\n$$\n在临界温度以下，范德华等温线表现出一个$(\\partial P / \\partial v)_T > 0$的区域。任何落在该区域内的状态方程的根$v$都是物理上虚假的，必须被舍弃。\n\n**1.3. 临界点参数的推导**\n\n临界点$(T_c, P_c, v_c)$是相图上的一个唯一点，在该点上液相和气相变得不可区分。在数学上，它是临界等温线上的一个拐点，该点的一阶导数为零且二阶导数也为零。这由以下联立条件表示：\n$$\n\\left(\\frac{\\partial P}{\\partial v}\\right)_{T} = 0 \\quad \\text{and} \\quad \\left(\\frac{\\partial^2 P}{\\partial v^2}\\right)_{T} = 0\n$$\n根据在临界点$(T_c, v_c)$的第一个条件：\n$$\n-\\frac{R T_c}{(v_c - b)^2} + \\frac{2a}{v_c^3} = 0 \\implies R T_c = \\frac{2a(v_c-b)^2}{v_c^3} \\quad (1)\n$$\n二阶导数是：\n$$\n\\left(\\frac{\\partial^2 P}{\\partial v^2}\\right)_{T} = \\frac{\\partial}{\\partial v}\\left(-\\frac{R T}{(v - b)^2} + \\frac{2a}{v^3}\\right) = \\frac{2 R T}{(v - b)^3} - \\frac{6a}{v^4}\n$$\n在临界点应用第二个条件：\n$$\n\\frac{2 R T_c}{(v_c - b)^3} - \\frac{6a}{v_c^4} = 0 \\implies R T_c = \\frac{3a(v_c-b)^3}{v_c^4} \\quad (2)\n$$\n为了求出$v_c$，我们令$R T_c$的两个表达式相等：\n$$\n\\frac{2a(v_c-b)^2}{v_c^3} = \\frac{3a(v_c-b)^3}{v_c^4}\n$$\n假设$a \\ne 0$且$v_c \\ne b$，我们可以通过除以$a(v_c-b)^2$并乘以$v_c^4$来简化：\n$$\n2v_c = 3(v_c-b) \\implies 2v_c = 3v_c - 3b \\implies v_c = 3b\n$$\n为了求出$T_c$，我们将$v_c=3b$代回方程（1）：\n$$\nR T_c = \\frac{2a(3b-b)^2}{(3b)^3} = \\frac{2a(2b)^2}{27b^3} = \\frac{2a(4b^2)}{27b^3} = \\frac{8a}{27b} \\implies T_c = \\frac{8a}{27Rb}\n$$\n最后，为了求出$P_c$，我们将$v_c$和$T_c$代入范德华方程本身：\n$$\nP_c = \\frac{R T_c}{v_c - b} - \\frac{a}{v_c^2} = \\frac{R(8a/27Rb)}{3b - b} - \\frac{a}{(3b)^2} = \\frac{8a/27b}{2b} - \\frac{a}{9b^2} = \\frac{8a}{54b^2} - \\frac{a}{9b^2} = \\frac{4a}{27b^2} - \\frac{3a}{27b^2}\n$$\n$$\nP_c = \\frac{a}{27b^2}\n$$\n\n**2. 算法设计**\n\n该数值求解器用于为给定的温度$T$和压力$P$求解摩尔体积$v$。它必须返回最大的稳定根，对应于类气体相。\n\n1.  **残差函数**：该问题是求解函数$f(v;T,P)$的求根问题：\n    $$\n    f(v; T, P) = P_{\\mathrm{model}}(T,v) - P = \\left(\\frac{R T}{v - b} - \\frac{a}{v^2}\\right) - P\n    $$\n    在定义域$v > b$内，$f(v)=0$的根是可能的摩尔体积。\n\n2.  **区间法**：为了找到所有实根，我们首先将它们置于区间内。\n    *   为$v$建立一个搜索范围$(b, v_{\\max}]$。下界比$b$大无穷小。上界$v_{\\max}$被自适应地选择为理想气体摩尔体积$v_{\\text{ig}} = RT/P$的一个较大倍数。$v_{\\max} = 50\\, v_{\\text{ig}}$的值足以确保所有物理相关的根都被包含在内。\n    *   在此范围内创建一个精细间隔的几何网格点，例如，使用`numpy.geomspace`。\n    *   在每个网格点上评估残差函数$f(v)$。\n    *   在两个连续的网格点$v_i$和$v_{i+1}$之间，$f(v)$的符号变化表示在区间$[v_i, v_{i+1}]$中存在一个根。所有这些区间都被识别为根的区间。\n    *   该方法是鲁棒的，并且也能识别出临界点的三重根，因为三次函数$v^3 P - (Pb+RT)v^2+av-ab=0$（等价于$f(v)=0$）在三重根处穿过坐标轴。\n\n3.  **二分法**：对于找到的每个区间$[v_{\\text{low}}, v_{\\text{high}}]$，应用二分法以高精度找到根。该区间被反复对半分割，并保留包含根的那一半（通过中点处$f(v)$的符号来识别）。这个迭代过程一直持续到区间宽度小于指定的公差（$\\approx 10^{-15} \\mathrm{m^3/mol}$）为止。\n\n4.  **根的过滤**：每个找到的根$v_{\\text{root}}$都需要根据力学稳定性判据进行验证。\n    *   在$v = v_{\\text{root}}$处计算导数$(\\partial P / \\partial v)_T$。\n    *   如果$(\\partial P / \\partial v)_T \\le 0$（在小的数值公差范围内），则该根被认为是物理稳定的并被保留。\n    *   如果$(\\partial P / \\partial v)_T > 0$，则该根对应于一个不稳定状态，并被丢弃。\n\n5.  **最终选择**：过滤后，如果稳定根的集合为空，函数返回一个非数值（NaN）。否则，它返回稳定根集合中的最大值。这种选择确保了在液态和气态都可能是稳定解的条件下，求解器返回的是与低压下理想气体极限连续的类气体根。\n\n**3. 应用于二氧化碳测试用例**\n\n使用给定的二氧化碳常数：\n$a = 0.3592\\,\\mathrm{Pa\\,m^6\\,mol^{-2}}$\n$b = 4.267\\times 10^{-5}\\,\\mathrm{m^3\\,mol^{-1}}$\n$R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n\n临界点参数计算如下：\n$v_c = 3b = 1.2801 \\times 10^{-4}\\,\\mathrm{m^3\\,mol^{-1}}$\n$T_c = \\frac{8a}{27Rb} = 299.91\\,\\mathrm{K}$\n$P_c = \\frac{a}{27b^2} = 7.3082 \\times 10^{6}\\,\\mathrm{Pa}$\n\n将求解器应用于四个测试用例：\n*   **用例 A**：$T = 1.2\\,T_{\\mathrm{c}}, P = 0.8\\,P_{\\mathrm{c}}$。超临界温度。预计有一个单一的稳定根。\n*   **用例 B**：$T = 0.9\\,T_{\\mathrm{c}}, P = 0.7\\,P_{\\mathrm{c}}$。亚临界区域。预计有三个实根：一个稳定的类液体根，一个不稳定的根，和一个稳定的类气体根。求解器将返回最大的稳定（类气体）根。\n*   **用例 C**：$T = T_{\\mathrm{c}}, P = P_{\\mathrm{c}}$。临界点。预计在$v_c$处有一个三重根，该根是临界稳定的，将被返回。\n*   **用例 D**：$T = 350\\,\\mathrm{K}, P = 1.0\\times 10^{5}\\,\\mathrm{Pa}$。超临界温度和低压，接近理想气体条件。预计在$v_{\\text{ig}} = RT/P$附近有一个单一的稳定根。",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves for the molar volume of a van der Waals fluid for given test cases.\n    \"\"\"\n\n    # --- Constants and Fluid Properties ---\n    # Universal gas constant in SI units (J mol^-1 K^-1)\n    R_GAS = 8.314462618\n    # Van der Waals parameters for carbon dioxide in SI units\n    # a: Pa m^6 mol^-2\n    A_CO2 = 0.3592\n    # b: m^3 mol^-1\n    B_CO2 = 4.267e-5\n\n    # --- Helper function for rounding to significant figures ---\n    def round_to_sf(num, sf):\n        \"\"\"Rounds a number to a specified number of significant figures.\"\"\"\n        if num == 0 or not np.isfinite(num):\n            return num\n        # Calculate the rounding position\n        power = -math.floor(math.log10(abs(num))) + (sf - 1)\n        factor = 10**power\n        return round(num * factor) / factor\n\n    # --- Core Solver Implementation ---\n    def solve_vdw_case(T, P, a, b):\n        \"\"\"\n        Calculates the largest stable molar volume for a van der Waals fluid.\n        \n        Args:\n            T (float): Temperature in Kelvin.\n            P (float): Pressure in Pascals.\n            a (float): Van der Waals parameter 'a'.\n            b (float): Van der Waals parameter 'b'.\n\n        Returns:\n            float: The largest stable molar volume in m^3/mol, or NaN if no stable root exists.\n        \"\"\"\n\n        # --- Model-specific functions ---\n        def p_vdw(v):\n            \"\"\"Van der Waals pressure as a function of molar volume.\"\"\"\n            if v <= b:\n                return np.inf\n            return (R_GAS * T) / (v - b) - a / v**2\n\n        def residual(v):\n            \"\"\"Residual function for root finding: P_vdw(v) - P = 0.\"\"\"\n            return p_vdw(v) - P\n\n        def dp_dv(v):\n            \"\"\"Derivative of pressure with respect to volume (for stability check).\"\"\"\n            if v <= b:\n                return np.nan\n            return -(R_GAS * T) / (v - b)**2 + (2 * a) / v**3\n\n        # 1. Bracketing Stage\n        # Set up a wide, geometrically spaced grid to find root brackets.\n        v_ig = R_GAS * T / P  # Ideal gas volume as a scale reference\n        v_min_search = b * (1.0 + 1e-9) # Start search just above b\n        v_max_search = v_ig * 50.0      # Generous upper bound\n        \n        # In case pressure is very high, ensure v_max is >> v_min\n        if v_max_search < 10 * v_min_search:\n            v_max_search = 10 * v_min_search\n\n        num_grid_points = 20000\n        v_grid = np.geomspace(v_min_search, v_max_search, num_grid_points)\n        f_grid = np.array([residual(v) for v in v_grid])\n\n        brackets = []\n        for i in range(num_grid_points - 1):\n            if np.sign(f_grid[i]) != np.sign(f_grid[i+1]):\n                brackets.append((v_grid[i], v_grid[i+1]))\n\n        # 2. Bisection Stage\n        roots = []\n        tolerance = 1e-15\n        max_iter = 100\n        for v_low, v_high in brackets:\n            f_low = residual(v_low)\n            for _ in range(max_iter):\n                v_mid = (v_low + v_high) / 2.0\n                if (v_high - v_low) < tolerance:\n                    break\n                f_mid = residual(v_mid)\n                if np.sign(f_mid) == np.sign(f_low):\n                    v_low = v_mid\n                    f_low = f_mid\n                else:\n                    v_high = v_mid\n            roots.append((v_low + v_high) / 2.0)\n\n        if not roots:\n             # Handle rare cases where grid misses a touch-point root (e.g., critical point)\n             min_abs_f_idx = np.argmin(np.abs(f_grid))\n             if np.abs(f_grid[min_abs_f_idx]) < 1e-9: # If minimum is very close to zero\n                 roots.append(v_grid[min_abs_f_idx])\n                 \n        # 3. Filtering Stage\n        stable_roots = []\n        # Use rounding to identify unique roots found through different brackets/methods\n        unique_roots = sorted(list(set(np.round(r, 12) for r in roots)))\n        for r in unique_roots:\n            stability_check = dp_dv(r)\n            # Stability criterion: dP/dv <= 0 ( allowing for small float inaccuracies)\n            if stability_check <= 1e-9:\n                stable_roots.append(r)\n\n        # 4. Selection Stage\n        if not stable_roots:\n            return np.nan\n        else:\n            # Per problem, return the largest stable root (gas-like branch)\n            return max(stable_roots)\n    \n    # --- Main Execution Logic ---\n    # Calculate critical properties for CO2\n    Tc = (8 * A_CO2) / (27 * R_GAS * B_CO2)\n    Pc = A_CO2 / (27 * B_CO2**2)\n    \n    # Define test cases from the problem statement\n    test_cases = [\n        # (T, P) pairs in SI units (K, Pa)\n        (1.2 * Tc, 0.8 * Pc),  # Case A: Supercritical\n        (0.9 * Tc, 0.7 * Pc),  # Case B: Subcritical, three roots\n        (Tc, Pc),              # Case C: Critical point\n        (350.0, 1.0e5),        # Case D: Near-ideal gas\n    ]\n\n    results = []\n    for T, P in test_cases:\n        v_molar = solve_vdw_case(T, P, A_CO2, B_CO2)\n        # Round the final result to 8 significant figures\n        v_rounded = round_to_sf(v_molar, 8)\n        results.append(v_rounded)\n\n    # Format the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}