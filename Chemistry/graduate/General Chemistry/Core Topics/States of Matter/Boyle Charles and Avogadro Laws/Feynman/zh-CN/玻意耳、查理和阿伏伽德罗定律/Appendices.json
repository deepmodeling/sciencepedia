{
    "hands_on_practices": [
        {
            "introduction": "像波义耳定律这样的基本气体定律，本质上是大量粒子集体运动所涌现出的宏观性质。这项实践提供了一个独特的机会，让你通过构建一个分子动力学（MD）模拟来创建一个虚拟实验室，从第一性原理“发现”这一定律。你将通过计算粒子对器壁的微观动量传递来定义和测量宏观压力，从而验证其与体积的依赖关系 。",
            "id": "2924199",
            "problem": "编写一个完整、可运行的程序，构建一个最小化的分子动力学（MD）模拟，仅使用第一性原理和机械可测量的量，来检验无相互作用的单原子气体的机械压力与体积的逆相关性。您的程序必须实现一个三维立方体容器，其具有理想的镜面反射壁，用于约束 $N$ 个质量为 $m$ 的相同点粒子，粒子间无相互作用力。使用约化单位制，使得 $m = 1$，玻尔兹曼常数 $k_\\mathrm{B} = 1$，目标动理学温度 $T = 1$。在立方体中均匀初始化粒子位置，并从麦克斯韦-玻尔兹曼（MB）分布中初始化粒子速度，然后移除任何质心漂移，并重新标度速度以精确达到目标动理学温度。通过在镜面反射之间的自由流动，以固定的时间步长 $\\Delta t$ 演化系统。仅从传递到壁面的时间平均动量通量计算机械压力。\n\n您必须在计算中实现和使用的基本原理：\n- 压力的力学定义为传递到壁面的时间平均法向动量通量：对于每次粒子-壁面碰撞，粒子的法向动量变化为 $|\\Delta p_n| = 2 m |v_n|$，其中 $v_n$ 是粒子反射前瞬间垂直于壁面的速度分量。在总模拟时间 $\\mathcal{T}$ 内传递到所有壁面的总法向冲量为 $\\sum \\limits_{\\text{collisions}} |\\Delta p_n|$。压力是总冲量除以总壁面面积与时间的乘积。\n- 根据能量均分定理，在 $d$ 维空间中，单原子理想气体的动理学温度为 $T = \\dfrac{m}{d N k_\\mathrm{B}} \\sum \\limits_{i=1}^{N} \\lVert \\mathbf{v}_i \\rVert^2$，该值瞬时计算；使用其在轨迹上的时间平均值来获得 $T_{\\mathrm{avg}}$。\n- 使用 $d = 3$。对于边长为 $L$ 的立方体容器，体积为 $V = L^3$，总壁面面积为 $A_\\mathrm{tot} = 6 L^2$。\n\n算法要求：\n- 使用自由流动：位置更新为 $\\mathbf{r}_i \\leftarrow \\mathbf{r}_i + \\mathbf{v}_i \\, \\Delta t$。如果某个坐标分量超出了区间 $[0, L]$，则在该面上执行镜面反射，并记录该事件对应的法向冲量 $2 m |v_n|$。假设 $\\Delta t$ 足够小，以至于在单次更新中没有坐标会经历一次以上的反射。\n- 累加传递到所有壁面的总冲量 $I$ 和累积动能以计算 $T_{\\mathrm{avg}}$。\n- 机械压力必须计算为 $p = \\dfrac{I}{A_\\mathrm{tot} \\, \\mathcal{T}}$。\n- 对于每个测试案例，报告可压缩因子（无量纲），其定义为 $Z = \\dfrac{p V}{N k_\\mathrm{B} T_{\\mathrm{avg}}}$。\n\n数值细节与单位：\n- 完全使用约化单位进行计算，其中 $m = 1$，$k_\\mathrm{B} = 1$，且 $T$ 是无量纲的。无需进行物理单位转换。不使用角度。\n- 使用 $\\Delta t = 0.005$ 并将总模拟时间设置为 $\\mathcal{T} = \\mathcal{T}_0 \\, (L / L_\\mathrm{ref})$，其中 $\\mathcal{T}_0 = 60$ 和 $L_\\mathrm{ref} = 10$，以大致均衡不同 $L$ 值下的壁面碰撞事件数。\n- 每个测试使用固定的随机种子以确保可复现性。\n\n测试套件：\n- 案例 $1$（正常路径）：$(N, L, \\Delta t, \\mathcal{T}_0, L_\\mathrm{ref}, \\text{seed}) = (128, 6, 0.005, 60, 10, 123)$。\n- 案例 $2$（中等体积）：$(N, L, \\Delta t, \\mathcal{T}_0, L_\\mathrm{ref}, \\text{seed}) = (128, 10, 0.005, 60, 10, 456)$。\n- 案例 $3$（大体积，低碰撞边界情况）：$(N, L, \\Delta t, \\mathcal{T}_0, L_\\mathrm{ref}, \\text{seed}) = (128, 14, 0.005, 60, 10, 789)$。\n\n输出规格：\n- 对于每个测试案例，使用时间平均温度 $T_{\\mathrm{avg}}$ 和从记录的冲量中获得的机械压力来计算如上定义的 $Z$。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个 $Z$ 值四舍五入到六位小数（例如，$[1.002300,0.998000,1.003100]$）。",
            "solution": "问题陈述是有效的。它描述了一个明确定义的统计力学计算练习：在一个立方体容器中模拟三维无相互作用的单原子气体，这对应于微正则（NVE）系综。其目标是通过从边界动量交换的第一性原理计算压力，从而数值验证理想气体定律，对于该定律，可压缩因子 $Z$ 应为1。\n\n该模拟建立在两个基本定义之上。首先，机械压力 $p$ 是施加在容器壁上的单位面积上的时间平均法向力。这个力源于粒子在碰撞过程中的动量变化。对于总模拟时间 $\\mathcal{T}$ 和总壁面面积 $A_{\\text{tot}}$，压力由传递到壁面的总冲量 $I$ 除以面积与时间的乘积给出：\n$$p = \\frac{I}{A_{\\text{tot}} \\mathcal{T}}$$\n总冲量是所有碰撞中动量变化的总和。对于每次镜面反射，垂直于壁面的动量分量 $p_n = m v_n$ 会反向，导致粒子的动量变化为 $-2 m v_n$。根据牛顿第三定律，传递给壁面的冲量为 $|\\Delta p_n| = 2 m |v_n|$。因此，在模拟过程中累积的总冲量为：\n$$I = \\sum_{\\text{collisions}} 2 m |v_n|$$\n其次，动理学温度 $T$ 是通过能量均分定理来定义的。对于一个在 $d$ 维空间中的 $N$ 个单原子粒子系统，平均动能与温度的关系为 $\\langle E_k \\rangle = \\frac{d}{2} N k_B T$。在本问题中，$d=3$。瞬时动理学温度由粒子速度 $\\mathbf{v}_i$ 计算得出：\n$$T_{\\text{inst}} = \\frac{2 E_k}{3 N k_B} = \\frac{m}{3 N k_B} \\sum_{i=1}^{N} \\lVert \\mathbf{v}_i \\rVert^2$$\n该模拟计算轨迹上的时间平均温度 $T_{\\text{avg}} = \\langle T_{\\text{inst}} \\rangle$，这提供了一个统计上稳健的估计。\n\n计算过程实现如下。\n\n**系统初始化：**\n1.  为每个测试案例设定随机数生成器的种子以保证可复现性。\n2.  粒子位置 $\\mathbf{r}_i$（对于 $i=1, \\dots, N$）从立方体域 $[0, L]^3$ 内的均匀分布中抽取。\n3.  粒子速度 $\\mathbf{v}_i$ 从目标温度 $T$ 的麦克斯韦-玻尔兹曼分布中抽取。这是通过从均值为 $0$、方差为 $\\sigma^2 = k_B T / m$ 的高斯（正态）分布中采样每个速度分量来实现的。\n4.  为了确保系统没有净平动，计算质心速度 $\\mathbf{v}_{\\text{CM}} = \\frac{1}{N} \\sum_{i=1}^{N} \\mathbf{v}_i$，并从每个粒子的速度中减去：$\\mathbf{v}_i \\leftarrow \\mathbf{v}_i - \\mathbf{v}_{\\text{CM}}$。\n5.  对速度进行重新标度以精确匹配目标温度 $T$。从速度计算出标度前的初始动理学温度 $T_{\\text{initial}}$。所需的标度因子为 $\\lambda = \\sqrt{T / T_{\\text{initial}}}$。然后更新所有速度：$\\mathbf{v}_i \\leftarrow \\lambda \\mathbf{v}_i$。\n\n**系统演化：**\n系统演化的总步数为 $N_{\\text{steps}} = \\text{round}(\\mathcal{T} / \\Delta t)$，其中 $\\Delta t$ 是固定的时间步长，$\\mathcal{T}$ 是目标总模拟时间。在每一步中：\n1.  **自由流动：** 所有粒子位置根据其当前速度，使用一阶欧拉积分器进行更新：$\\mathbf{r}_i(t + \\Delta t) = \\mathbf{r}_i(t) + \\mathbf{v}_i(t) \\Delta t$。\n2.  **壁面反射：** 检查每个位置分量 $r_{i,j}$（对于粒子 $i$ 和笛卡尔维度 $j \\in \\{x, y, z\\}$）是否超出边界 $[0, L]$。为提高效率，使用向量化操作。\n    *   对于 $r_{i,j}  0$ 的粒子，发生了与在 $0$ 处的壁面的反射。对于每个此类事件，将冲量 $2 m |v_{i,j}|$ 添加到运行总和中。相应的速度分量反向，$v_{i,j} \\leftarrow -v_{i,j}$，并更新位置以反映其在盒子内的新路径，$r_{i,j} \\leftarrow -r_{i,j}$。\n    *   对于 $r_{i,j}  L$ 的粒子，发生了与在 $L$ 处的壁面的反射。将冲量 $2 m |v_{i,j}|$ 添加到总和中。相应的速度分量反向，$v_{i,j} \\leftarrow -v_{i,j}$，并将位置反射回盒子内，$r_{i,j} \\leftarrow 2L - r_{i,j}$。\n    如问题所述，此过程假设 $\\Delta t$ 足够小，可以防止每个粒子在每个维度上于单一步骤内发生多次反射。\n3.  **数据累积：** 在壁面相互作用处理完毕后，计算瞬时总动能 $E_k(t+\\Delta t) = \\frac{1}{2} m \\sum_i \\lVert \\mathbf{v}_i(t+\\Delta t) \\rVert^2$，并将其添加到运行总和中以便后续求平均。\n\n**最终计算：**\n在实际总时间 $\\mathcal{T}_{\\text{actual}} = N_{\\text{steps}} \\Delta t$ 的模拟完成后：\n1.  平均温度由瞬时动能之和计算得出：$T_{\\text{avg}} = \\frac{1}{N_{\\text{steps}}} \\sum_{k=1}^{N_{\\text{steps}}} T_{\\text{inst},k} = \\frac{2}{3 N k_B N_{\\text{steps}}} \\sum_{k=1}^{N_{\\text{steps}}} E_{k,k}$。\n2.  压力使用累积的总冲量 $I$ 计算：$p = \\frac{I}{A_{\\text{tot}} \\mathcal{T}_{\\text{actual}}}$，其中总壁面面积为 $A_{\\text{tot}} = 6L^2$。\n3.  然后计算并报告无量纲量——可压缩因子 $Z$。当体积为 $V=L^3$ 时，它由下式给出：\n$$Z = \\frac{p V}{N k_B T_{\\text{avg}}}$$\n对于理想气体，理论值为 $Z=1$。此模拟的数值结果应接近该值，偏差源于有限尺寸效应和有限时间统计涨落。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(N, L, dt, T0, L_ref, seed):\n    \"\"\"\n    Runs a minimal MD simulation for a non-interacting monatomic gas.\n\n    Args:\n        N (int): Number of particles.\n        L (float): Side length of the cubic container.\n        dt (float): Time step.\n        T0 (float): Base simulation time.\n        L_ref (float): Reference length for scaling simulation time.\n        seed (int): Random seed for reproducibility.\n\n    Returns:\n        float: The calculated compressibility factor Z.\n    \"\"\"\n    # Use reduced units as specified\n    m = 1.0\n    k_B = 1.0\n    T_target = 1.0\n\n    # Initialize random number generator\n    rng = np.random.default_rng(seed)\n\n    # 1. Initialize positions and velocities\n    # Positions are uniform in the box [0, L]^3\n    r = rng.uniform(0.0, L, size=(N, 3))\n\n    # Velocities from Maxwell-Boltzmann distribution at T_target\n    # This corresponds to a normal distribution with scale = sqrt(k_B * T / m)\n    v_scale = np.sqrt(k_B * T_target / m)\n    v = rng.normal(loc=0.0, scale=v_scale, size=(N, 3))\n\n    # 2. Remove center-of-mass drift\n    v -= np.mean(v, axis=0)\n\n    # 3. Rescale velocities to match target temperature exactly\n    current_ke = 0.5 * m * np.sum(v**2)\n    current_temp = (2.0 * current_ke) / (3.0 * N * k_B)\n    \n    # Avoid division by zero if initial temperature is zero\n    if current_temp > 0:\n        rescale_factor = np.sqrt(T_target / current_temp)\n        v *= rescale_factor\n\n    # 4. Simulation setup\n    T_total_target = T0 * (L / L_ref)\n    num_steps = int(round(T_total_target / dt))\n    T_actual = num_steps * dt\n\n    total_impulse = 0.0\n    total_ke_sum = 0.0\n\n    # 5. Main simulation loop\n    for _ in range(num_steps):\n        # Free streaming\n        r += v * dt\n\n        # Specular wall reflections and impulse calculation\n        # Particles hitting walls at coordinate 0\n        hit_lower = r  0.0\n        # Impulse is calculated with velocity component mag before reflection\n        total_impulse += np.sum(2.0 * m * np.abs(v[hit_lower]))\n        v[hit_lower] *= -1.0 # Reflect velocity\n        r[hit_lower] *= -1.0 # Reflect position\n\n        # Particles hitting walls at coordinate L\n        hit_upper = r > L\n        total_impulse += np.sum(2.0 * m * np.abs(v[hit_upper]))\n        v[hit_upper] *= -1.0 # Reflect velocity\n        r[hit_upper] = 2.0 * L - r[hit_upper] # Reflect position\n\n        # Accumulate kinetic energy for temperature averaging\n        # This is done *after* velocities are updated by wall collisions\n        current_ke_step = 0.5 * m * np.sum(v**2)\n        total_ke_sum += current_ke_step\n\n    # 6. Post-simulation calculations\n    # Average temperature\n    avg_ke = total_ke_sum / num_steps\n    T_avg = (2.0 * avg_ke) / (3.0 * N * k_B)\n\n    # Mechanical pressure\n    A_total = 6.0 * L**2\n    # Ensure T_actual is not zero to prevent division by zero\n    if T_actual > 0:\n        p = total_impulse / (A_total * T_actual)\n    else:\n        p = 0.0\n\n    # Compressibility factor Z\n    V = L**3\n    # Ensure N, k_B, T_avg product is not zero\n    if N * k_B * T_avg > 0:\n        Z = (p * V) / (N * k_B * T_avg)\n    else:\n        Z = 0.0\n\n    return Z\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (128, 6, 0.005, 60, 10, 123),\n        (128, 10, 0.005, 60, 10, 456),\n        (128, 14, 0.005, 60, 10, 789),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, L, dt, T0, L_ref, seed = case\n        z_factor = run_simulation(N, L, dt, T0, L_ref, seed)\n        results.append(z_factor)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "虽然理想气体定律是理解气体行为的强大基石，但真实气体因分子自身的体积和相互作用力而表现出偏差。本练习将带领你从理想模型走向更贴近现实的范德华方程。通过推导一个无量纲的“查理因子”，你将能够量化分析真实气体在恒定压力下的热膨胀行为如何偏离查理定律所预测的简单正比关系，从而深入理解分子间作用力的具体影响 。",
            "id": "2924152",
            "problem": "范德华状态方程是一种常用于描述真实气体行为的热力学模型，它修正了理想气体定律，以考虑有限的分子大小和分子间引力。考虑一个系统，其中包含 $n$ 摩尔的单组分气体，该气体遵循范德华方程，参数为 $a$ 和 $b$：\n$$(p + a \\, n^{2}/V^{2})(V - n b) = n R T,$$\n其中，$p$ 是外部压力，$V$ 是体积，$T$ 是绝对温度，$R$ 是普适气体常数。在整个过程中，将 $p$ 和 $n$ 视为固定值。\n\n从第一性原理出发，并以上述状态方程为起点，执行以下操作：\n\n- 在 $p$ 和 $n$ 固定的情况下，对 $T$ 使用隐式微分，以获得 $(\\partial V/\\partial T)_{p}$ 的闭合形式解。\n- 为了评估与查理定律的偏差，在理想气体极限下，该定律意味着在 $p$ 和 $n$ 固定的情况下 $V \\propto T$，定义无量纲的查理因子\n$$C(T,p) \\equiv T \\left(\\frac{\\partial \\ln V}{\\partial T}\\right)_{p}。$$\n使用范德华方程消去 $T$，并将您的结果用 $p$、$a$、$b$ 和在范德华方程的物理根 $V(T,p)$ 处计算的无量纲堆积分数 $y \\equiv n b / V$ 来表示。在理想气体极限（$a \\to 0$ 且 $b \\to 0$，等价于 $y \\to 0$）下，查理定律要求 $C \\to 1$。请证明您的表达式可以回到此极限。\n\n你的最终答案必须是 $C(T,p)$ 的一个以 $p$、$a$、$b$ 和 $y$ 表示的单一闭合形式符号表达式。将答案表示为一个无量纲的解析表达式。不需要进行数值计算。",
            "solution": "所提出的问题是热力学和微分学中的一个标准且适定的练习。它在科学上基于真实气体的范德华模型，没有矛盾或歧义，并包含了解决该问题所需的所有信息。在该模型的背景下，其前提在物理上是合理的，目标是明确的。因此，该问题被认为是有效的，并将提供一个严谨的解答。\n\n起点是 $n$ 摩尔气体的范德华状态方程：\n$$ \\left(p + \\frac{a n^{2}}{V^{2}}\\right)(V - n b) = n R T $$\n这里，$p$ 是压力，$V$ 是体积，$T$ 是绝对温度，$R$ 是普适气体常数。参数 $a$ 和 $b$ 分别说明了分子间引力和有限的分子体积。已知压力 $p$ 和摩尔数 $n$ 保持不变。\n\n我们的第一个目标是求出偏导数 $(\\partial V/\\partial T)_{p}$，它表示在恒定压力下体积随温度的变化。为此，我们对整个方程关于 $T$ 进行隐式微分，将 $V$ 视为 $T$ 的函数。\n\n使用乘法法则对左侧（LHS）关于 $T$ 进行微分，得到：\n$$ \\frac{\\partial}{\\partial T} \\left[ \\left(p + \\frac{a n^{2}}{V^{2}}\\right)(V - n b) \\right] = \\left(\\frac{\\partial}{\\partial T} \\left(p + \\frac{a n^{2}}{V^{2}}\\right)\\right) (V - n b) + \\left(p + \\frac{a n^{2}}{V^{2}}\\right) \\left(\\frac{\\partial}{\\partial T}(V - n b)\\right) $$\n由于 $p$、$n$、$a$ 和 $b$ 是常数，而 $V$ 依赖于 $T$，我们应用链式法则：\n$$ \\frac{\\partial}{\\partial T} \\left(p + a n^{2} V^{-2}\\right) = -2 a n^{2} V^{-3} \\left(\\frac{\\partial V}{\\partial T}\\right)_{p} $$\n$$ \\frac{\\partial}{\\partial T}(V - n b) = \\left(\\frac{\\partial V}{\\partial T}\\right)_{p} $$\n将这些代回到 LHS 的微分表达式中：\n$$ \\text{LHS}' = \\left(-2 a n^{2} V^{-3} \\left(\\frac{\\partial V}{\\partial T}\\right)_{p}\\right)(V - n b) + \\left(p + \\frac{a n^{2}}{V^{2}}\\right) \\left(\\frac{\\partial V}{\\partial T}\\right)_{p} $$\n$$ \\text{LHS}' = \\left(\\frac{\\partial V}{\\partial T}\\right)_{p} \\left[ p + \\frac{a n^{2}}{V^{2}} - \\frac{2 a n^{2}(V - n b)}{V^{3}} \\right] $$\n$$ \\text{LHS}' = \\left(\\frac{\\partial V}{\\partial T}\\right)_{p} \\left[ p + \\frac{a n^{2}}{V^{2}} - \\frac{2 a n^{2}}{V^{2}} + \\frac{2 a n^{3} b}{V^{3}} \\right] = \\left(\\frac{\\partial V}{\\partial T}\\right)_{p} \\left[ p - \\frac{a n^{2}}{V^{2}} + \\frac{2 a n^{3} b}{V^{3}} \\right] $$\n范德华方程的右侧（RHS）关于 $T$ 的微分很简单：\n$$ \\frac{\\partial}{\\partial T}(n R T) = n R $$\n令微分后的 LHS 和 RHS 相等，我们得到：\n$$ \\left(\\frac{\\partial V}{\\partial T}\\right)_{p} \\left[ p - \\frac{a n^{2}}{V^{2}} + \\frac{2 a n^{3} b}{V^{3}} \\right] = n R $$\n解出偏导数，得到：\n$$ \\left(\\frac{\\partial V}{\\partial T}\\right)_{p} = \\frac{n R}{p - \\frac{a n^{2}}{V^{2}} + \\frac{2 a n^{3} b}{V^{3}}} $$\n这是第一个要求的结果。接下来，我们计算无量纲的查理因子 $C(T,p)$，其定义为：\n$$ C(T,p) \\equiv T \\left(\\frac{\\partial \\ln V}{\\partial T}\\right)_{p} $$\n使用恒等式 $(\\partial \\ln V / \\partial T)_{p} = (1/V)(\\partial V / \\partial T)_{p}$，我们有：\n$$ C(T,p) = \\frac{T}{V} \\left(\\frac{\\partial V}{\\partial T}\\right)_{p} = \\frac{T}{V} \\left( \\frac{n R}{p - \\frac{a n^{2}}{V^{2}} + \\frac{2 a n^{3} b}{V^{3}}} \\right) = \\frac{n R T}{V\\left(p - \\frac{a n^{2}}{V^{2}} + \\frac{2 a n^{3} b}{V^{3}}\\right)} $$\n为了消去 $T$ 并用指定的变量重写此式，我们从原始范德华方程 $n R T = (p + \\frac{a n^{2}}{V^{2}})(V - n b)$ 中代入 $nRT$：\n$$ C(T,p) = \\frac{\\left(p + \\frac{a n^{2}}{V^{2}}\\right)(V - n b)}{V\\left(p - \\frac{a n^{2}}{V^{2}} + \\frac{2 a n^{3} b}{V^{3}}\\right)} $$\n我们可以通过将分子中的项 $(V - nb)$ 除以 $V$ 来简化此式：\n$$ C(T,p) = \\frac{\\left(p + \\frac{a n^{2}}{V^{2}}\\right)\\left(1 - \\frac{n b}{V}\\right)}{p - \\frac{a n^{2}}{V^{2}} + \\frac{2 a n^{3} b}{V^{3}}} $$\n现在，我们引入无量纲堆积分数 $y \\equiv n b / V$。根据这个定义，我们推导出以下关系：\n$$ \\frac{n}{V} = \\frac{y}{b} \\implies \\frac{n^{2}}{V^{2}} = \\frac{y^{2}}{b^{2}} \\quad \\text{和} \\quad \\frac{n^{3}b}{V^{3}} = b \\left(\\frac{n}{V}\\right)^{3} = b \\left(\\frac{y}{b}\\right)^{3} = \\frac{y^{3}}{b^{2}} $$\n将这些代入 $C(T,p)$ 的表达式中：\n$$ C(T,p) = \\frac{\\left(p + a \\frac{y^{2}}{b^{2}}\\right)(1 - y)}{p - a \\frac{y^{2}}{b^{2}} + 2 a \\frac{y^{3}}{b^{2}}} $$\n这个表达式是用所需的变量 $p$、$a$、$b$ 和 $y$ 表示的。为了以更紧凑的形式呈现它，我们可以通过分子和分母同乘以 $b^2$ 来消去分数 $1/b^2$：\n$$ C(T,p) = \\frac{b^{2}\\left(p + a \\frac{y^{2}}{b^{2}}\\right)(1 - y)}{b^{2}\\left(p - a \\frac{y^{2}}{b^{2}} + 2 a \\frac{y^{3}}{b^{2}}\\right)} = \\frac{(p b^{2} + a y^{2})(1 - y)}{p b^{2} - a y^{2} + 2 a y^{3}} $$\n进一步因式分解分母，我们得到最终的闭合形式表达式：\n$$ C(T,p) = \\frac{(p b^{2} + a y^{2})(1 - y)}{p b^{2} - a y^{2}(1 - 2y)} $$\n最后，我们必须验证这个结果在理想气体极限下能够回到查理定律。理想气体极限对应于参数 $a \\to 0$ 和 $b \\to 0$。当 $b \\to 0$ 时，堆积分数 $y = nb/V$ 也趋近于 $0$。对我们的 $C$ 的表达式取极限：\n$$ \\lim_{a\\to 0, y\\to 0} C(T,p) = \\lim_{a\\to 0, y\\to 0} \\frac{(p b^{2} + a y^{2})(1 - y)}{p b^{2} - a y^{2}(1 - 2y)} $$\n由于 $y \\to 0$，项 $(1-y) \\to 1$ 且 $(1-2y) \\to 1$。包含 $a$ 的项消失。$p$ 的表达式必须保持有限，并且由于 $b$ 也在项 $pb^2$ 中，我们必须考虑乘以 $b^2$ 之前的初始形式：\n$$ \\lim_{a\\to 0, y\\to 0} C(T,p) = \\lim_{a\\to 0, y\\to 0} \\frac{\\left(p + a \\frac{y^{2}}{b^{2}}\\right)(1 - y)}{p - a \\frac{y^{2}}{b^{2}} + 2 a \\frac{y^{3}}{b^{2}}} = \\frac{(p + 0)(1-0)}{p - 0 + 0} = \\frac{p}{p} = 1 $$\n这个极限 $C=1$ 对应于理想气体的结果。对于理想气体，$pV = nRT$，所以在 $p$ 和 $n$ 恒定时，$V = (nR/p)T$，这意味着 $V \\propto T$。那么 $(\\partial \\ln V / \\partial T)_p = (\\partial (\\ln T + \\text{const})/\\partial T)_p = 1/T$。查理因子变为 $C = T(1/T) = 1$。因此，我们的推导是一致的。\n以所要求的变量表示的查理因子的最终符号表达式如上所述。",
            "answer": "$$\n\\boxed{\\frac{(p b^{2} + a y^{2})(1 - y)}{p b^{2} - a y^{2}(1 - 2y)}}\n$$"
        },
        {
            "introduction": "本练习旨在连接抽象理论模型与实验现实，展示理想气体定律作为严格物理极限的意义。你将处理一组关于真实气体等温压缩率 $\\kappa_T$ 的假设性实验数据，并运用数据分析和外推法等关键技能。通过这个过程，你将亲手验证理想气体行为是如何作为真实气体在低压下的极限而呈现的，从而深刻体会物理定律如何从经验观察中提炼和确证 。",
            "id": "2924179",
            "problem": "一个固定温度 $T$ 下的真实气体样品具有其等温压缩率 $\\kappa_{T}(p)$ 的特性，其定义为 $\\kappa_{T} \\equiv -\\frac{1}{V}\\left(\\frac{\\partial V}{\\partial p}\\right)_{T}$，并作为压力 $p$ 的函数进行测量。对于理想气体，其体积遵循理想气体定律，而 $\\kappa_{T}(p)$ 的低压极限具有该定律所蕴含的特征形式。在有限压力 $p$ 下，会出现真实气体的偏差，但在足够低的压力 $p$ 下，可以将乘积 $y(p)\\equiv p\\,\\kappa_{T}(p)$ 近似为其在 $p=0$ 附近关于 $p$ 的一阶泰勒展开。\n\n给定以下在恒定温度 $T$ 下对某单组分气体进行的 $\\kappa_{T}(p)$ 测量数据，其中压力 $p$ 的单位为兆帕 (MPa)，压缩率 $\\kappa_{T}$ 的单位为 $\\text{MPa}^{-1}$，单倍标准差不确定度 $\\sigma_{\\kappa}(p)$ 的单位为 $\\text{MPa}^{-1}$：\n- $p = 0.2$ MPa, $\\kappa_{T} = 5.03$ $\\text{MPa}^{-1}$, $\\sigma_{\\kappa} = 0.010$ $\\text{MPa}^{-1}$\n- $p = 0.5$ MPa, $\\kappa_{T} = 2.02$ $\\text{MPa}^{-1}$, $\\sigma_{\\kappa} = 0.004$ $\\text{MPa}^{-1}$\n- $p = 1.0$ MPa, $\\kappa_{T} = 1.022$ $\\text{MPa}^{-1}$, $\\sigma_{\\kappa} = 0.002$ $\\text{MPa}^{-1}$\n- $p = 2.0$ MPa, $\\kappa_{T} = 0.5195$ $\\text{MPa}^{-1}$, $\\sigma_{\\kappa} = 0.0010$ $\\text{MPa}^{-1}$\n- $p = 3.0$ MPa, $\\kappa_{T} = 0.3540$ $\\text{MPa}^{-1}$, $\\sigma_{\\kappa} = 0.000667$ $\\text{MPa}^{-1}$\n- $p = 4.0$ MPa, $\\kappa_{T} = 0.26975$ $\\text{MPa}^{-1}$, $\\sigma_{\\kappa} = 0.000500$ $\\text{MPa}^{-1}$\n- $p = 5.0$ MPa, $\\kappa_{T} = 0.21960$ $\\text{MPa}^{-1}$, $\\sigma_{\\kappa} = 0.000400$ $\\text{MPa}^{-1}$\n\n任务：\n1. 仅从 $\\kappa_{T}$ 的定义和理想气体定律出发，推导 $y(p)\\equiv p\\,\\kappa_{T}(p)$ 在低压极限下的理想气体预测值。\n2. 将测得的 $\\kappa_{T}(p)$ 数据转换为 $y(p) = p\\,\\kappa_{T}(p)$ 的测量值，并传递不确定度以获得 $\\sigma_{y}(p)$。\n3. 假设在这些压力下 $y(p)$ 可以很好地用关于 $p$ 的一阶多项式 $y(p) \\approx y_{0}+c\\,p$ 来近似，执行适合所传递不确定度的最小二乘法拟合，以点估计的形式估算 $y_{0} = \\lim_{p\\to 0} y(p)$。简要说明你的不确定度处理方法。\n4. 仅报告 $y_{0}$ 的点估计值，四舍五入至四位有效数字。最终答案以无单位的纯数表示。\n\n将最终报告值四舍五入至四位有效数字，并以纯数（无量纲）表示。最终答案中不要报告任何不确定度，但你的解答过程必须明确讨论如何传递不确定度以得出该点估计值。",
            "solution": "首先将对所述问题的科学合理性和逻辑一致性进行验证。\n\n**问题验证**\n\n步骤1：提取已知条件。\n- 等温压缩率的定义：$\\kappa_{T} \\equiv -\\frac{1}{V}\\left(\\frac{\\partial V}{\\partial p}\\right)_{T}$。\n- 待分析函数的定义：$y(p)\\equiv p\\,\\kappa_{T}(p)$。\n- 低压近似：$y(p) \\approx y_{0}+c\\,p$。\n- 在恒定温度 $T$ 下的气体实验数据：一组共7个数据点，包括压力 $p$、等温压缩率 $\\kappa_T$ 及其标准不确定度 $\\sigma_{\\kappa}$。这些点为 $(p, \\kappa_T, \\sigma_{\\kappa})$：\n  - $(0.2 \\, \\text{MPa}, 5.03 \\, \\text{MPa}^{-1}, 0.010 \\, \\text{MPa}^{-1})$\n  - $(0.5 \\, \\text{MPa}, 2.02 \\, \\text{MPa}^{-1}, 0.004 \\, \\text{MPa}^{-1})$\n  - $(1.0 \\, \\text{MPa}, 1.022 \\, \\text{MPa}^{-1}, 0.002 \\, \\text{MPa}^{-1})$\n  - $(2.0 \\, \\text{MPa}, 0.5195 \\, \\text{MPa}^{-1}, 0.0010 \\, \\text{MPa}^{-1})$\n  - $(3.0 \\, \\text{MPa}, 0.3540 \\, \\text{MPa}^{-1}, 0.000667 \\, \\text{MPa}^{-1})$\n  - $(4.0 \\, \\text{MPa}, 0.26975 \\, \\text{MPa}^{-1}, 0.000500 \\, \\text{MPa}^{-1})$\n  - $(5.0 \\, \\text{MPa}, 0.21960 \\, \\text{MPa}^{-1}, 0.000400 \\, \\text{MPa}^{-1})$\n- 任务：\n  1. 推导 $y(p)$ 的理想气体低压极限。\n  2. 根据所提供的数据计算 $y(p)$ 及其不确定度 $\\sigma_y(p)$。\n  3. 对模型 $y(p) \\approx y_{0}+c\\,p$ 进行最小二乘法拟合以估计 $y_0$。\n  4. 报告四舍五入至四位有效数字的 $y_0$ 点估计值。\n\n步骤2：已知条件的验证。\n该问题在科学上是合理的。它基于热力学的基本原理和实验数据的统计分析。等温压缩率的定义是标准的。使用理想气体定律作为极限情况以及使用泰勒展开描述低压下真实气体行为是物理化学中的正确且标准的操作。所提供的数据在物理上是合理的；压缩率随压力增加而减小。问题陈述清晰，提供了进行多步分析所需的所有必要信息和明确指令，从而可以得出一个唯一的、有意义的答案。语言客观、明确。该问题不违反任何无效标准。\n\n步骤3：结论。\n问题有效。将提供解答。\n\n**解答**\n\n解答过程将通过执行问题陈述中定义的四个任务来进行。\n\n任务1：$y(p)$ 的理想气体极限\n对于温度为 $T$、压力为 $p$ 的 $n$ 摩尔气体，其理想气体定律为 $pV=nRT$，其中 $R$ 是理想气体常数。体积 $V$ 可以表示为压力的函数：\n$$V(p) = \\frac{nRT}{p}$$\n由于样品组分 ($n$) 和温度 ($T$) 是恒定的，我们可以求出在恒定 $T$ 下 $V$ 对 $p$ 的偏导数：\n$$\\left(\\frac{\\partial V}{\\partial p}\\right)_{T} = \\frac{\\partial}{\\partial p}\\left(\\frac{nRT}{p}\\right) = -nRT \\frac{1}{p^2}$$\n注意到 $nRT=pV$，我们可以将其代入导数表达式中：\n$$\\left(\\frac{\\partial V}{\\partial p}\\right)_{T} = -\\frac{pV}{p^2} = -\\frac{V}{p}$$\n现在，我们将此结果代入等温压缩率的定义 $\\kappa_{T} \\equiv -\\frac{1}{V}\\left(\\frac{\\partial V}{\\partial p}\\right)_{T}$ 中：\n$$\\kappa_{T}^{\\text{ideal}} = -\\frac{1}{V}\\left(-\\frac{V}{p}\\right) = \\frac{1}{p}$$\n最后，我们计算理想气体的量 $y(p)$：\n$$y^{\\text{ideal}}(p) = p\\,\\kappa_{T}^{\\text{ideal}}(p) = p \\left(\\frac{1}{p}\\right) = 1$$\n对于理想气体，量 $y(p)$ 是一个常数，在所有压力下都等于 $1$。因此，其低压极限也为 $1$：\n$$\\lim_{p\\to 0} y^{\\text{ideal}}(p) = 1$$\n这个无量纲值可作为截距 $y_0$ 的理论基准。\n\n任务2：数据转换和不确定度传递\n我们得到了在不同压力 $p$ 下的 $(\\kappa_T, \\sigma_{\\kappa})$ 测量值。我们必须计算 $y(p) = p\\,\\kappa_T(p)$ 及其对应的不确定度 $\\sigma_y(p)$。压力 $p$ 被视为一个不确定度可忽略的自变量。$y$ 的不确定度通过标准误差传递公式计算：\n$$\\sigma_{y}^{2} = \\left(\\frac{\\partial y}{\\partial \\kappa_T}\\right)^2 \\sigma_{\\kappa}^2$$\n由于 $y = p\\,\\kappa_T$，其偏导数为 $\\frac{\\partial y}{\\partial \\kappa_T} = p$。因此，不确定度为：\n$$\\sigma_{y} = \\sqrt{p^2 \\sigma_{\\kappa}^2} = p\\,\\sigma_{\\kappa}$$\n由于压力 $p$ 为正，我们取正根。现在我们为每个数据点 $(p_i, \\kappa_{T,i}, \\sigma_{\\kappa,i})$ 计算 $y_i$ 和 $\\sigma_{y,i}$：\n- $p_1=0.2$: $y_1 = 0.2 \\times 5.03 = 1.006$; $\\sigma_{y,1} = 0.2 \\times 0.010 = 0.002$\n- $p_2=0.5$: $y_2 = 0.5 \\times 2.02 = 1.010$; $\\sigma_{y,2} = 0.5 \\times 0.004 = 0.002$\n- $p_3=1.0$: $y_3 = 1.0 \\times 1.022 = 1.022$; $\\sigma_{y,3} = 1.0 \\times 0.002 = 0.002$\n- $p_4=2.0$: $y_4 = 2.0 \\times 0.5195 = 1.039$; $\\sigma_{y,4} = 2.0 \\times 0.0010 = 0.002$\n- $p_5=3.0$: $y_5 = 3.0 \\times 0.3540 = 1.062$; $\\sigma_{y,5} = 3.0 \\times 0.000667 = 0.002001$\n- $p_6=4.0$: $y_6 = 4.0 \\times 0.26975 = 1.079$; $\\sigma_{y,6} = 4.0 \\times 0.000500 = 0.002$\n- $p_7=5.0$: $y_7 = 5.0 \\times 0.21960 = 1.098$; $\\sigma_{y,7} = 5.0 \\times 0.000400 = 0.002$\n\n传递后的不确定度 $\\sigma_{y,i}$ 在非常高的精度下是恒定的，等于 $0.002$。\n\n任务3：最小二乘法拟合\n我们要将转换后的数据 $(p_i, y_i)$ 拟合到线性模型 $y(p)=y_0+cp$ 中，其中 $y_0$ 是截距， $c$ 是斜率。目标是找到 $y_0$ 的最佳点估计。这种拟合的通用方法是加权最小二乘法 (WLS)，该方法最小化加权残差平方和 $\\chi^2 = \\sum_i w_i (y_i - (y_0+cp_i))^2$，其中权重为 $w_i = 1/\\sigma_{y,i}^2$。\n然而，正如在任务2中确定的，所有数据点的不确定度 $\\sigma_{y,i}$ 都是恒定的。这意味着权重 $w_i$ 也是恒定的。在这种情况下，最小化加权最小二乘法的 $\\chi^2$ 等同于最小化未加权残差平方和 $\\sum_i (y_i - (y_0+cp_i))^2$。因此，该过程从加权最小二乘法 (WLS) 简化为普通最小二乘法 (OLS)。\n\n对于一组 $N$ 个数据点 $(p_i, y_i)$，截距 $y_0$ 和斜率 $c$ 的标准普通最小二乘法 (OLS) 公式为：\n$$y_0 = \\frac{(\\sum y_i)(\\sum p_i^2) - (\\sum p_i)(\\sum p_i y_i)}{N \\sum p_i^2 - (\\sum p_i)^2}$$\n$$c = \\frac{N \\sum p_i y_i - (\\sum p_i)(\\sum y_i)}{N \\sum p_i^2 - (\\sum p_i)^2}$$\n我们只需要 $y_0$ 的值。数据点数量为 $N=7$。我们根据数据 $(p_i, y_i)$ 计算必要的总和：\n- $\\sum_{i=1}^{7} p_i = 0.2 + 0.5 + 1.0 + 2.0 + 3.0 + 4.0 + 5.0 = 15.7$\n- $\\sum_{i=1}^{7} y_i = 1.006 + 1.010 + 1.022 + 1.039 + 1.062 + 1.079 + 1.098 = 7.316$\n- $\\sum_{i=1}^{7} p_i^2 = 0.2^2 + 0.5^2 + 1.0^2 + 2.0^2 + 3.0^2 + 4.0^2 + 5.0^2 = 0.04 + 0.25 + 1 + 4 + 9 + 16 + 25 = 55.29$\n- $\\sum_{i=1}^{7} p_i y_i = (0.2)(1.006) + (0.5)(1.010) + (1.0)(1.022) + (2.0)(1.039) + (3.0)(1.062) + (4.0)(1.079) + (5.0)(1.098) = 0.2012 + 0.505 + 1.022 + 2.078 + 3.186 + 4.316 + 5.49 = 16.7982$\n\n现在，我们将这些总和代入截距 $y_0$ 的公式中。\n分母为：\n$$D = N \\sum p_i^2 - (\\sum p_i)^2 = 7 \\times 55.29 - (15.7)^2 = 387.03 - 246.49 = 140.54$$\n分子为：\n$$N_{y_0} = (\\sum y_i)(\\sum p_i^2) - (\\sum p_i)(\\sum p_i y_i) = (7.316)(55.29) - (15.7)(16.7982) = 404.50284 - 263.73174 = 140.7711$$\n截距 $y_0$ 的估计值为：\n$$y_0 = \\frac{N_{y_0}}{D} = \\frac{140.7711}{140.54} \\approx 1.0016444$$\n\n任务4：最终答案报告\n问题要求将 $y_0$ 的点估计值四舍五入至四位有效数字。\n$$y_0 \\approx 1.0016444$$\n将此值四舍五入至四位有效数字，得到 $1.002$。",
            "answer": "$$\\boxed{1.002}$$"
        }
    ]
}