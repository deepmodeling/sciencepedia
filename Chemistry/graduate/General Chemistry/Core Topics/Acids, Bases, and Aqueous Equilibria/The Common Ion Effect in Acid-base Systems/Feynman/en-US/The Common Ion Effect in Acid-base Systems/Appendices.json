{
    "hands_on_practices": [
        {
            "introduction": "Moving beyond the approximations of the Henderson-Hasselbalch equation is a critical step in mastering chemical equilibrium. This first practice challenges you to calculate the pH of a common ammonia buffer by building the model from first principles . By systematically applying mass conservation, charge neutrality, and the coupled equilibria for both the weak base and water autoprotolysis ($K_w$), you will derive the exact governing equation and appreciate the conditions under which common simplifications are justified.",
            "id": "2958738",
            "problem": "An aqueous solution at $25^{\\circ}\\mathrm{C}$ contains ammonia $\\mathrm{NH_3}$ and ammonium chloride $\\mathrm{NH_4Cl}$ at analytical concentrations $0.20\\,\\mathrm{M}$ and $0.10\\,\\mathrm{M}$, respectively. Treat the solution as ideally dilute (activity coefficients equal to $1$). The base dissociation constant of ammonia is $K_{b} = 1.8 \\times 10^{-5}$ at $25^{\\circ}\\mathrm{C}$. The water autoprotolysis constant is $K_{w} = 1.0 \\times 10^{-14}$ at $25^{\\circ}\\mathrm{C}$.\n\nStarting only from fundamental statements of mass conservation, charge neutrality, and the definitions of equilibrium constants, formulate and solve the coupled non-linear equilibrium problem for the $\\mathrm{NH_4^+}/\\mathrm{NH_3}$ and water equilibria. Do not assume the autoprotolysis of water is negligible; include it explicitly through $K_{w}$. Compute the solution hydrogen ion concentration and report the pH. Round your final pH to four significant figures. Express the final answer as pH (unitless).",
            "solution": "The problem is well-posed and scientifically sound, conforming to the fundamental principles of chemical equilibrium. All necessary data are provided, and the constraints are consistent. It is a valid problem.\n\nThe aqueous solution contains the following species: $\\mathrm{NH_3}$, $\\mathrm{NH_4^+}$, $\\mathrm{Cl^-}$, $\\mathrm{H^+}$ (equivalent to $\\mathrm{H_3O^+}$), and $\\mathrm{OH^-}$. The solvent is water, $\\mathrm{H_2O}$.\n\nThe system is governed by two simultaneous equilibria:\n$1$. The base dissociation of ammonia:\n$$\\mathrm{NH_3} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{NH_4^+} + \\mathrm{OH^-}$$\nwith the equilibrium constant $K_b = \\frac{[\\mathrm{NH_4^+}][\\mathrm{OH^-}]}{[\\mathrm{NH_3}]} = 1.8 \\times 10^{-5}$.\n\n$2$. The autoprotolysis of water:\n$$\\mathrm{H_2O} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{OH^-}$$\nwith the equilibrium constant $K_w = [\\mathrm{H^+}][\\mathrm{OH^-}] = 1.0 \\times 10^{-14}$.\n\nFor rigor, it is convenient to work with the acid dissociation of the ammonium ion, $\\mathrm{NH_4^+} \\rightleftharpoons \\mathrm{NH_3} + \\mathrm{H^+}$, whose constant $K_a$ is related to $K_b$ and $K_w$ by the expression $K_a K_b = K_w$.\n$$K_a = \\frac{[\\mathrm{NH_3}][\\mathrm{H^+}]}{[\\mathrm{NH_4^+}]} = \\frac{K_w}{K_b} = \\frac{1.0 \\times 10^{-14}}{1.8 \\times 10^{-5}}$$\n$$K_a = \\frac{5}{9} \\times 10^{-9} \\approx 5.556 \\times 10^{-10}$$\n\nTo determine the equilibrium concentrations, we formulate a system of equations based on fundamental conservation laws.\n\nFirst, the mass balance equations.\nAmmonium chloride, $\\mathrm{NH_4Cl}$, is a strong electrolyte and dissociates completely. The chloride ion, $\\mathrm{Cl^-}$, is a spectator ion, and its concentration is fixed by the initial analytical concentration of $\\mathrm{NH_4Cl}$:\n$$[\\mathrm{Cl^-}] = C_{\\mathrm{NH_4Cl}} = 0.10\\,\\mathrm{M}$$\nThe total concentration of species containing nitrogen (the \"ammonia family\") is conserved. It is the sum of the analytical concentrations of the ammonia and ammonium chloride added to the solution:\n$$C_{T} = [\\mathrm{NH_3}] + [\\mathrm{NH_4^+}] = C_{\\mathrm{NH_3}} + C_{\\mathrm{NH_4Cl}} = 0.20\\,\\mathrm{M} + 0.10\\,\\mathrm{M} = 0.30\\,\\mathrm{M}$$\n\nSecond, the charge balance equation (principle of electroneutrality). The total positive charge concentration must equal the total negative charge concentration:\n$$[\\mathrm{NH_4^+}] + [\\mathrm{H^+}] = [\\mathrm{Cl^-}] + [\\mathrm{OH^-}]$$\n\nWe have a system of five independent equations for the five unknown concentrations ($[\\mathrm{NH_3}]$, $[\\mathrm{NH_4^+}]$, $[\\mathrm{H^+}]$, $[\\mathrm{OH^-}]$, $[\\mathrm{Cl^-}]$):\n$1$. $K_a = \\frac{[\\mathrm{NH_3}][\\mathrm{H^+}]}{[\\mathrm{NH_4^+}]}$\n$2$. $K_w = [\\mathrm{H^+}][\\mathrm{OH^-}]$\n$3$. $[\\mathrm{Cl^-}] = C_{\\mathrm{NH_4Cl}}$\n$4$. $[\\mathrm{NH_3}] + [\\mathrm{NH_4^+}] = C_{T}$\n$5$. $[\\mathrm{NH_4^+}] + [\\mathrm{H^+}] = [\\mathrm{Cl^-}] + [\\mathrm{OH^-}]$\n\nTo solve this system, we express all unknown concentrations in terms of a single master variable, which we choose to be $h=[\\mathrm{H^+}]$.\n\nFrom the $K_a$ definition and the total nitrogen mass balance, we express $[\\mathrm{NH_3}]$ and $[\\mathrm{NH_4^+}]$ as fractions of $C_T$:\nFrom $K_a = \\frac{(C_T - [\\mathrm{NH_4^+}]) h}{[\\mathrm{NH_4^+}]}$, we solve for $[\\mathrm{NH_4^+}]$:\n$$[\\mathrm{NH_4^+}] = C_T \\frac{h}{K_a + h}$$\nAnd for $[\\mathrm{NH_3}]$:\n$$[\\mathrm{NH_3}] = C_T - [\\mathrm{NH_4^+}] = C_T \\left(1 - \\frac{h}{K_a + h}\\right) = C_T \\frac{K_a}{K_a + h}$$\n\nFrom the water autoprotolysis constant, we have:\n$$[\\mathrm{OH^-}] = \\frac{K_w}{h}$$\n\nNow, we substitute these expressions, along with $[\\mathrm{Cl^-}] = C_{\\mathrm{NH_4Cl}}$, into the charge balance equation:\n$$C_T \\frac{h}{K_a + h} + h = C_{\\mathrm{NH_4Cl}} + \\frac{K_w}{h}$$\nThis is the exact equation for $h = [\\mathrm{H^+}]$. To solve it, we rearrange it into a polynomial form. Multiply all terms by $h(K_a + h)$:\n$$C_T h^2 + h^2(K_a + h) = C_{\\mathrm{NH_4Cl}} h(K_a + h) + K_w(K_a + h)$$\n$$C_T h^2 + K_a h^2 + h^3 = C_{\\mathrm{NH_4Cl}} K_a h + C_{\\mathrm{NH_4Cl}} h^2 + K_w K_a + K_w h$$\nGrouping terms by powers of $h$:\n$$h^3 + (C_T + K_a - C_{\\mathrm{NH_4Cl}}) h^2 - (C_{\\mathrm{NH_4Cl}} K_a + K_w) h - K_w K_a = 0$$\nSubstitute $C_T = C_{\\mathrm{NH_3}} + C_{\\mathrm{NH_4Cl}}$ into the coefficient of the $h^2$ term:\n$$h^3 + (C_{\\mathrm{NH_3}} + K_a) h^2 - (C_{\\mathrm{NH_4Cl}} K_a + K_w) h - K_w K_a = 0$$\nThis is the exact cubic polynomial for the hydrogen ion concentration $h$.\n\nWhile this cubic equation can be solved numerically, a highly accurate analytical solution can be obtained by analyzing the magnitudes of the terms. For this buffer system, we expect the pH to be near $\\mathrm{p}K_a \\approx 9.26$, so $h$ will be a small number (on the order of $10^{-10}\\,\\mathrm{M}$).\nLet us examine the coefficients, using $C_{\\mathrm{NH_3}} = 0.20$, $C_{\\mathrm{NH_4Cl}} = 0.10$, $K_a = \\frac{5}{9} \\times 10^{-9}$, and $K_w = 1.0 \\times 10^{-14}$.\nThe coefficient of $h^2$ is $C_{\\mathrm{NH_3}} + K_a \\approx 0.20$.\nThe coefficient of $h$ is $-(C_{\\mathrm{NH_4Cl}} K_a + K_w) \\approx -(0.10 \\times 5.56 \\times 10^{-10}) = -5.56 \\times 10^{-11}$.\nThe constant term is $-K_w K_a \\approx -5.56 \\times 10^{-24}$.\nThe $h^3$ and the constant term are many orders of magnitude smaller than the $h^2$ and $h$ terms. For example, if $h \\approx 10^{-10}$, then $h^3 \\approx 10^{-30}$ and the constant term is $\\approx -5.56 \\times 10^{-24}$. The $h^2$ term is $\\approx 0.2 \\times 10^{-20}$ and the $h$ term is $\\approx -5.56 \\times 10^{-11} \\times 10^{-10} = -5.56 \\times 10^{-21}$.\nNeglecting the $h^3$ and $-K_w K_a$ terms provides an excellent approximation. The cubic equation simplifies to a linear equation in $h$:\n$$(C_{\\mathrm{NH_3}} + K_a) h^2 - (C_{\\mathrm{NH_4Cl}} K_a + K_w) h \\approx 0$$\nSince $h \\neq 0$, we can divide by $h$:\n$$(C_{\\mathrm{NH_3}} + K_a) h \\approx C_{\\mathrm{NH_4Cl}} K_a + K_w$$\n$$h \\approx \\frac{C_{\\mathrm{NH_4Cl}} K_a + K_w}{C_{\\mathrm{NH_3}} + K_a}$$\nThis approximation is equivalent to simplifying the charge balance equation to $[\\mathrm{NH_4^+}] \\approx [\\mathrm{Cl^-}] + [\\mathrm{OH^-}]$ (i.e., $[\\mathrm{H^+}]$ is negligible) but retaining all other species correctly.\n\nNow, we compute the numerical value for $h$:\n$$h = \\frac{(0.10) \\left(\\frac{5}{9} \\times 10^{-9}\\right) + (1.0 \\times 10^{-14})}{0.20 + \\left(\\frac{5}{9} \\times 10^{-9}\\right)}$$\n$$h = \\frac{5.5555... \\times 10^{-11} + 1.0 \\times 10^{-14}}{0.20000000055...}$$\n$$h = \\frac{5.556555... \\times 10^{-11}}{0.20000000055...} \\approx 2.778277... \\times 10^{-10}\\,\\mathrm{M}$$\nFinally, we compute the pH:\n$$\\mathrm{pH} = -\\log_{10}(h) = -\\log_{10}(2.778277... \\times 10^{-10})$$\n$$\\mathrm{pH} \\approx 9.55622...$$\nRounding the result to four significant figures as requested:\n$$\\mathrm{pH} = 9.556$$\nThis result confirms that the solution is basic and the concentration of $\\mathrm{H^+}$ is indeed very small, validating the approximations made to simplify the cubic equation.",
            "answer": "$$\\boxed{9.556}$$"
        },
        {
            "introduction": "Real-world buffers often involve polyprotic species, adding a layer of complexity to equilibrium calculations. This exercise  extends the rigorous, principles-based approach to the biochemically significant phosphate buffer system. You will derive the exact governing equation for the hydrogen ion concentration, $[\\text{H}^+]$, by carefully constructing the charge and mass balance equations for this more complex environment, reinforcing the universal applicability of these fundamental laws.",
            "id": "2958765",
            "problem": "A buffer is prepared at temperature $25\\,^{\\circ}\\mathrm{C}$ using the conjugate acid-base pair dihydrogen phosphate $\\mathrm{H_2PO_4^-}$ and hydrogen phosphate $\\mathrm{HPO_4^{2-}}$. Initially, $1.000\\,\\mathrm{L}$ of solution contains a total formal phosphate concentration of $0.0500\\,\\mathrm{mol\\,L^{-1}}$ split equally between $\\mathrm{NaH_2PO_4}$ and $\\mathrm{Na_2HPO_4}$, so that the formal concentrations are $0.0250\\,\\mathrm{mol\\,L^{-1}}$ for $\\mathrm{H_2PO_4^-}$ and $0.0250\\,\\mathrm{mol\\,L^{-1}}$ for $\\mathrm{HPO_4^{2-}}$. Solid $\\mathrm{Na_2HPO_4}$ is then added in the amount of $0.01000\\,\\mathrm{mol}$ and dissolves without changing the volume appreciably.\n\nAssume ideal-solution behavior (activity coefficients equal to $1$). Model the phosphate system at this pH using only the second dissociation equilibrium\n$$\\mathrm{H_2PO_4^- \\rightleftharpoons H^+ + HPO_4^{2-}},$$\nwith thermodynamic acidity constant $K_{a2}$ at $25\\,^{\\circ}\\mathrm{C}$ given by $K_{a2} = 6.17 \\times 10^{-8}$. Neglect contributions from $\\mathrm{H_3PO_4}$ and $\\mathrm{PO_4^{3-}}$. The ionic product of water is $K_{w} = 1.000 \\times 10^{-14}$.\n\nStarting from the fundamental relations of chemical equilibrium, mass conservation for phosphate, and charge balance, derive the governing equation for the hydrogen ion concentration $[\\mathrm{H^+}]$ in the final solution and evaluate the pH numerically. Round your pH to four significant figures. Report the pH as a unitless number.",
            "solution": "The problem statement has been validated and is deemed a well-posed, scientifically sound problem in the domain of chemical equilibrium. We shall now proceed with a rigorous derivation and solution.\n\nThe task is to determine the final pH of a buffer solution after the addition of a conjugate base. We must derive the governing equation for the hydrogen ion concentration, $[\\mathrm{H^+}]$, from fundamental principles.\n\nFirst, we determine the final formal concentrations of the conjugate acid-base pair. The initial solution has a volume of $V = 1.000\\,\\mathrm{L}$. The initial formal concentrations are $[\\mathrm{H_2PO_4^-}]_{formal, i} = 0.0250\\,\\mathrm{mol\\,L^{-1}}$ and $[\\mathrm{HPO_4^{2-}}]_{formal, i} = 0.0250\\,\\mathrm{mol\\,L^{-1}}$. Solid $\\mathrm{Na_2HPO_4}$ is added in the amount of $n_{add} = 0.01000\\,\\mathrm{mol}$. As the volume is constant, this increases the formal concentration of the hydrogen phosphate by $\\Delta C = \\frac{n_{add}}{V} = \\frac{0.01000\\,\\mathrm{mol}}{1.000\\,\\mathrm{L}} = 0.01000\\,\\mathrm{mol\\,L^{-1}}$.\n\nThe final formal concentrations, which we denote as $C_A$ for the acid component ($\\mathrm{H_2PO_4^-}$) and $C_B$ for the base component ($\\mathrm{HPO_4^{2-}}$), are:\n$$ C_A = [\\mathrm{H_2PO_4^-}]_{formal} = 0.0250\\,\\mathrm{mol\\,L^{-1}} $$\n$$ C_B = [\\mathrm{HPO_4^{2-}}]_{formal} = 0.0250\\,\\mathrm{mol\\,L^{-1}} + 0.01000\\,\\mathrm{mol\\,L^{-1}} = 0.0350\\,\\mathrm{mol\\,L^{-1}} $$\n\nThe species present in the solution are $\\mathrm{H_2O}$, $\\mathrm{H^+}$, $\\mathrm{OH^-}$, $\\mathrm{Na^+}$, $\\mathrm{H_2PO_4^-}$, and $\\mathrm{HPO_4^{2-}}$. The species $\\mathrm{H_3PO_4}$ and $\\mathrm{PO_4^{3-}}$ are neglected as per the problem statement.\n\nThe system is governed by three fundamental relations: two equilibrium conditions, a mass balance condition, and a charge balance condition.\n\n1.  Equilibrium Relations:\nThe dissociation of the weak acid $\\mathrm{H_2PO_4^-}$ and the autoionization of water are the relevant equilibria:\n$$ \\mathrm{H_2PO_4^- \\rightleftharpoons H^+ + HPO_4^{2-}} \\quad \\implies \\quad K_{a2} = \\frac{[\\mathrm{H^+}][\\mathrm{HPO_4^{2-}}]}{[\\mathrm{H_2PO_4^-}]} = 6.17 \\times 10^{-8} $$\n$$ \\mathrm{H_2O \\rightleftharpoons H^+ + OH^-} \\quad \\implies \\quad K_{w} = [\\mathrm{H^+}][\\mathrm{OH^-}] = 1.000 \\times 10^{-14} $$\n\n2.  Mass Balance for Phosphate:\nThe total concentration of phosphate species in all forms must equal the sum of the formal concentrations of the phosphate salts added.\n$$ [\\mathrm{H_2PO_4^-}] + [\\mathrm{HPO_4^{2-}}] = C_A + C_B = 0.0250 + 0.0350 = 0.0600\\,\\mathrm{mol\\,L^{-1}} $$\n\n3.  Charge Balance (Electroneutrality):\nThe total positive charge concentration must equal the total negative charge concentration. The sodium ion concentration, $[\\mathrm{Na^+}]$, is fixed by the formal concentrations of the salts $\\mathrm{NaH_2PO_4}$ and $\\mathrm{Na_2HPO_4}$. For each mole of $\\mathrm{H_2PO_4^-}$ from $\\mathrm{NaH_2PO_4}$, there is one mole of $\\mathrm{Na^+}$. For each mole of $\\mathrm{HPO_4^{2-}}$ from $\\mathrm{Na_2HPO_4}$, there are two moles of $\\mathrm{Na^+}$.\n$$ [\\mathrm{Na^+}] = C_A + 2C_B = 0.0250 + 2(0.0350) = 0.0250 + 0.0700 = 0.0950\\,\\mathrm{mol\\,L^{-1}} $$\nThe charge balance equation is:\n$$ [\\mathrm{Na^+}] + [\\mathrm{H^+}] = [\\mathrm{OH^-}] + [\\mathrm{H_2PO_4^-}] + 2[\\mathrm{HPO_4^{2-}}] $$\n\nTo derive the governing equation for $[\\mathrm{H^+}]$, we combine these relations. Substitute the expression for $[\\mathrm{Na^+}]$ into the charge balance equation:\n$$ (C_A + 2C_B) + [\\mathrm{H^+}] = [\\mathrm{OH^-}] + [\\mathrm{H_2PO_4^-}] + 2[\\mathrm{HPO_4^{2-}}] $$\nFrom the mass balance, we can express $[\\mathrm{H_2PO_4^-}]$ as $[\\mathrm{H_2PO_4^-}] = (C_A + C_B) - [\\mathrm{HPO_4^{2-}}]$. Substituting this into the previous equation yields:\n$$ (C_A + 2C_B) + [\\mathrm{H^+}] = [\\mathrm{OH^-}] + \\left( (C_A + C_B) - [\\mathrm{HPO_4^{2-}}] \\right) + 2[\\mathrm{HPO_4^{2-}}] $$\nSimplifying this expression by collecting terms:\n$$ C_A + 2C_B + [\\mathrm{H^+}] = [\\mathrm{OH^-}] + C_A + C_B + [\\mathrm{HPO_4^{2-}}] $$\n$$ C_B + [\\mathrm{H^+}] - [\\mathrm{OH^-}] = [\\mathrm{HPO_4^{2-}}] $$\nThis powerful relation connects the formal concentration of the base to the equilibrium concentrations of species involved in proton transfer. Now, we express $[\\mathrm{OH^-}]$ and $[\\mathrm{HPO_4^{2-}}]$ as functions of $[\\mathrm{H^+}]$.\nFrom the water autoionization, we have $[\\mathrm{OH^-}] = \\frac{K_w}{[\\mathrm{H^+}]}$.\nFrom the mass balance and the $K_{a2}$ expression, we can derive an expression for $[\\mathrm{HPO_4^{2-}}]$:\n$$ [\\mathrm{H_2PO_4^-}] = \\frac{[\\mathrm{H^+}][\\mathrm{HPO_4^{2-}}]}{K_{a2}} $$\n$$ \\frac{[\\mathrm{H^+}][\\mathrm{HPO_4^{2-}}]}{K_{a2}} + [\\mathrm{HPO_4^{2-}}] = C_A + C_B $$\n$$ [\\mathrm{HPO_4^{2-}}] \\left( \\frac{[\\mathrm{H^+}]}{K_{a2}} + 1 \\right) = C_A + C_B $$\n$$ [\\mathrm{HPO_4^{2-}}] = \\frac{K_{a2}(C_A + C_B)}{[\\mathrm{H^+}] + K_{a2}} $$\nSubstituting these expressions for $[\\mathrm{OH^-}]$ and $[\\mathrm{HPO_4^{2-}}]$ into our derived relation $C_B + [\\mathrm{H^+}] - [\\mathrm{OH^-}] = [\\mathrm{HPO_4^{2-}}]$ gives the final governing equation for $[\\mathrm{H^+}]$:\n$$ C_B + [\\mathrm{H^+}] - \\frac{K_w}{[\\mathrm{H^+}]} = \\frac{K_{a2}(C_A + C_B)}{[\\mathrm{H^+}] + K_{a2}} $$\nThis equation is exact under the stated assumptions. It is a cubic polynomial in $[\\mathrm{H^+}]$.\n\nTo evaluate the pH, we must solve this equation for $[\\mathrm{H^+}]$. Let $x = [\\mathrm{H^+}]$.\n$$ 0.0350 + x - \\frac{1.000 \\times 10^{-14}}{x} = \\frac{(6.17 \\times 10^{-8})(0.0600)}{x + 6.17 \\times 10^{-8}} $$\nAn excellent initial approximation for $x$ can be found from the Henderson-Hasselbalch equation, which assumes $[\\mathrm{H^+}] \\ll C_A, C_B$ and $[\\mathrm{OH^-}] \\ll C_A, C_B$: $[\\mathrm{H^+}] \\approx K_{a2} \\frac{C_A}{C_B} = (6.17 \\times 10^{-8}) \\frac{0.0250}{0.0350} \\approx 4.407 \\times 10^{-8}\\,\\mathrm{M}$.\nWe can use this value as a starting point for an iterative solution of the more accurate equation:\n$$ x = K_{a2} \\frac{C_A - x + K_w/x}{C_B + x - K_w/x} $$\nStarting with $x_0 = 4.40714 \\times 10^{-8}$, the iteration converges rapidly.\nLet's compute the correction term $x - K_w/x$:\n$x_0 - K_w/x_0 = 4.40714 \\times 10^{-8} - \\frac{1.000 \\times 10^{-14}}{4.40714 \\times 10^{-8}} = 4.40714 \\times 10^{-8} - 2.26901 \\times 10^{-7} = -1.82829 \\times 10^{-7}$.\nThe next iteration gives:\n$$ x_1 = (6.17 \\times 10^{-8}) \\frac{0.0250 - (-1.82829 \\times 10^{-7})}{0.0350 + (-1.82829 \\times 10^{-7})} = (6.17 \\times 10^{-8}) \\frac{0.025000183}{0.034999817} \\approx 4.40719 \\times 10^{-8} $$\nThe value has converged. The equilibrium hydrogen ion concentration is $[\\mathrm{H^+}] = 4.40719 \\times 10^{-8}\\,\\mathrm{mol\\,L^{-1}}$.\n\nFinally, we calculate the pH:\n$$ \\mathrm{pH} = -\\log_{10}([\\mathrm{H^+}]) = -\\log_{10}(4.40719 \\times 10^{-8}) \\approx 7.355845 $$\nThe problem requires the pH to be rounded to four significant figures.\n$$ \\mathrm{pH} \\approx 7.356 $$",
            "answer": "$$\\boxed{7.356}$$"
        },
        {
            "introduction": "A deep understanding of equilibrium models is most powerful when used to interpret experimental data. This practice bridges theory and experimental reality by tasking you with an inverse problem: estimating the acid dissociation constant, $K_a$, from simulated titration data . By implementing a nonlinear least-squares fit and quantifying the result's uncertainty, you will practice a vital skill for modern chemical research—transforming measurements into fundamental physical constants.",
            "id": "2958712",
            "problem": "A monoprotic weak acid solution at temperature $25\\,^{\\circ}\\mathrm{C}$ is prepared with a fixed analytical acid concentration and then titrated by adding known analytical amounts of its sodium salt that supplies the conjugate base (common ion). Assume ideal behavior (activity coefficients equal to $1$) and pure water autodissociation with ionic product $K_{\\mathrm{w}} = 1.0\\times 10^{-14}$. The acid dissociation reaction is $\\mathrm{HA} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{A^-}$ with an unknown thermodynamic acid dissociation constant $K_{\\mathrm{a}}$ to be estimated.\n\nFundamental base to use:\n- Mass balance for the acid family: the total concentration of all species carrying the acid’s atom balance is the sum of the analytical acid and the added conjugate base. If $C_{\\mathrm{HA}}$ is the analytical concentration of the weak acid initially present and $C_{\\mathrm{salt}}$ is the analytical concentration of the added sodium salt of the conjugate base, then the total acid-family concentration is $C_{\\mathrm{T}} = C_{\\mathrm{HA}} + C_{\\mathrm{salt}}$, and the species satisfy $[\\mathrm{HA}] + [\\mathrm{A^-}] = C_{\\mathrm{T}}$.\n- Charge balance (electroneutrality): the sum of positive charges equals the sum of negative charges, including contributions from $\\mathrm{H^+}$, $\\mathrm{OH^-}$, the conjugate base $\\mathrm{A^-}$, and the sodium counterion from the salt addition.\n- Law of mass action for dissociation: $K_{\\mathrm{a}} = \\dfrac{[\\mathrm{H^+}][\\mathrm{A^-}]}{[\\mathrm{HA}]}$.\n- Water autodissociation: $K_{\\mathrm{w}} = [\\mathrm{H^+}][\\mathrm{OH^-}]$.\n\nMeasured data consist of $N$ pairs $\\{(C_{\\mathrm{salt},i}, \\mathrm{pH}_i^{\\mathrm{(meas)}})\\}_{i=1}^N$ for fixed $C_{\\mathrm{HA}}$, where each $\\mathrm{pH}_i^{\\mathrm{(meas)}}$ is obtained by adding independent, identically distributed zero-mean Gaussian noise (in $\\mathrm{pH}$ units) with known standard deviation to the true model $\\mathrm{pH}_i^{\\mathrm{(true)}} = -\\log_{10}([\\mathrm{H^+}]_i)$ predicted by the above principles for the given $K_{\\mathrm{a}}$, $C_{\\mathrm{HA}}$, and $C_{\\mathrm{salt},i}$.\n\nTask:\n1) Starting only from the fundamental laws and definitions stated above, build a forward model that, for any given $K_{\\mathrm{a}}$, $C_{\\mathrm{HA}}$, $C_{\\mathrm{salt}}$, and $K_{\\mathrm{w}}$, computes the physically valid positive root for $[\\mathrm{H^+}]$ and returns $\\mathrm{pH} = -\\log_{10}([\\mathrm{H^+}])$.\n2) Given noisy $\\mathrm{pH}$ data generated from known ground-truth parameters, estimate $K_{\\mathrm{a}}$ by minimizing the nonlinear least squares objective\n$$\nS(K_{\\mathrm{a}}) = \\sum_{i=1}^N \\left(\\mathrm{pH}_i^{\\mathrm{(meas)}} - \\mathrm{pH}_i^{\\mathrm{(model)}}(K_{\\mathrm{a}})\\right)^2,\n$$\nsubject to $K_{\\mathrm{a}} > 0$. Use a parametrization that guarantees positivity and a bounded one-dimensional search domain.\n3) Using the Fisher information approach for independent, identically distributed Gaussian errors in $\\mathrm{pH}$ with variance $\\sigma^2$, compute the Fisher information for the single parameter in the logarithmic parameterization $\\theta = \\ln K_{\\mathrm{a}}$:\n$$\n\\mathcal{I}(\\theta) = \\frac{1}{\\sigma^2}\\sum_{i=1}^N \\left(\\frac{\\partial \\mathrm{pH}_i^{\\mathrm{(model)}}}{\\partial \\theta}\\right)^2,\n$$\nevaluate it at the estimator $\\hat{\\theta}$, and report the corresponding approximate $95\\%$ confidence interval for $K_{\\mathrm{a}}$ obtained by transforming the normal approximation for $\\theta$ back to the original scale. Use a numerically stable method to compute $\\frac{\\partial \\mathrm{pH}_i^{\\mathrm{(model)}}}{\\partial \\theta}$.\n4) For each test case, output a list of three floating-point numbers in scientific notation: the estimated $K_{\\mathrm{a}}$, the lower bound of the approximate $95\\%$ confidence interval for $K_{\\mathrm{a}}$, and the upper bound of the approximate $95\\%$ confidence interval for $K_{\\mathrm{a}}$, in that order.\n\nData generation protocol (must be followed exactly to ensure testability):\n- Use $K_{\\mathrm{w}} = 1.0\\times 10^{-14}$ and a fixed random seed of $2025$ for all cases.\n- Generate the noisy $\\mathrm{pH}$ measurements by adding independent Gaussian noise with zero mean and specified standard deviation $\\sigma_{\\mathrm{pH}}$ (in $\\mathrm{pH}$ units) to the noise-free model $\\mathrm{pH}$.\n- For each test case, compute the “true” $\\mathrm{pH}$ values using the ground-truth $K_{\\mathrm{a}}^{(\\mathrm{true})}$, the specified $C_{\\mathrm{HA}}$, and the list of $C_{\\mathrm{salt}}$ values, then add noise.\n\nTest suite to implement:\n- Case A (happy path): $K_{\\mathrm{a}}^{(\\mathrm{true})} = 1.8\\times 10^{-5}$, $C_{\\mathrm{HA}} = 1.0\\times 10^{-2}$, $C_{\\mathrm{salt}} \\in \\{0.0, 1.0\\times 10^{-3}, 3.0\\times 10^{-3}, 1.0\\times 10^{-2}, 3.0\\times 10^{-2}\\}$, $\\sigma_{\\mathrm{pH}} = 2.0\\times 10^{-3}$.\n- Case B (very weak acid regime, water important): $K_{\\mathrm{a}}^{(\\mathrm{true})} = 1.0\\times 10^{-8}$, $C_{\\mathrm{HA}} = 1.0\\times 10^{-3}$, $C_{\\mathrm{salt}} \\in \\{0.0, 3.0\\times 10^{-4}, 1.0\\times 10^{-3}, 3.0\\times 10^{-3}\\}$, $\\sigma_{\\mathrm{pH}} = 2.0\\times 10^{-3}$.\n- Case C (strong common ion loading): $K_{\\mathrm{a}}^{(\\mathrm{true})} = 1.0\\times 10^{-6}$, $C_{\\mathrm{HA}} = 5.0\\times 10^{-3}$, $C_{\\mathrm{salt}} \\in \\{0.0, 5.0\\times 10^{-2}, 1.0\\times 10^{-1}, 2.0\\times 10^{-1}\\}$, $\\sigma_{\\mathrm{pH}} = 2.0\\times 10^{-3}$.\n\nComputation and reporting details:\n- Use $N$ equal to the number of listed $C_{\\mathrm{salt}}$ values for each case.\n- For the least-squares fit, parametrize by $\\theta = \\ln K_{\\mathrm{a}}$ and search in the bounded interval $\\theta \\in [\\ln(10^{-12}), \\ln(1)]$.\n- Estimate $\\sigma^2$ by the unbiased residual variance $\\hat{\\sigma}^2 = \\dfrac{\\mathrm{RSS}}{N - 1}$, where $\\mathrm{RSS}$ is the residual sum of squares at the minimizer and there is one fitted parameter.\n- Compute the Fisher information in $\\theta$, $\\mathcal{I}(\\hat{\\theta})$, using a numerically stable central-difference approximation for the sensitivity $\\dfrac{\\partial \\mathrm{pH}_i^{\\mathrm{(model)}}}{\\partial \\theta}$ with a small step in $\\theta$.\n- Construct an approximate $95\\%$ confidence interval for $K_{\\mathrm{a}}$ by first obtaining the normal-based interval for $\\theta$,\n$$\n\\hat{\\theta} \\pm 1.96 \\sqrt{\\mathcal{I}(\\hat{\\theta})^{-1}},\n$$\nand then mapping its endpoints back to $K_{\\mathrm{a}}$ via the exponential function.\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sub-list of three values in scientific notation with exactly six significant figures, in the order $[K_{\\mathrm{a}}^{(\\mathrm{est})}, K_{\\mathrm{a}}^{(\\mathrm{lo95})}, K_{\\mathrm{a}}^{(\\mathrm{hi95})}]$. For example: [[1.234567e-05,1.111111e-05,1.358024e-05],[...],[...]].",
            "solution": "The problem presented is a comprehensive exercise in chemical equilibrium modeling, parameter estimation, and statistical uncertainty quantification. It is scientifically sound, well-posed, and requires a rigorous application of fundamental principles. We shall proceed with the derivation and solution.\n\nThe solution is structured into three parts:\n1.  Derivation of the forward model to calculate the hydrogen ion concentration $[\\mathrm{H^+}]$ and, subsequently, the $\\mathrm{pH}$.\n2.  Formulation of the inverse problem for estimating the acid dissociation constant $K_{\\mathrm{a}}$ via nonlinear least squares.\n3.  Development of the statistical framework for determining the confidence interval for the estimated $K_{\\mathrm{a}}$ using the Fisher information matrix.\n\nFirst, we must construct the forward model, which predicts the $\\mathrm{pH}$ for a given set of parameters $\\{K_{\\mathrm{a}}, C_{\\mathrm{HA}}, C_{\\mathrm{salt}}, K_{\\mathrm{w}}\\}$. We begin with the four fundamental equilibrium relationships provided:\n1.  Mass balance for the acid/base conjugate pair: $[\\mathrm{HA}] + [\\mathrm{A^-}] = C_{\\mathrm{T}}$, where $C_{\\mathrm{T}} = C_{\\mathrm{HA}} + C_{\\mathrm{salt}}$.\n2.  Charge balance (electroneutrality): $[\\mathrm{Na^+}] + [\\mathrm{H^+}] = [\\mathrm{A^-}] + [\\mathrm{OH^-}]$. Since the sodium salt is the source of the common ion $\\mathrm{A^-}$ and the counter-ion $\\mathrm{Na^+}$, we have $[\\mathrm{Na^+}] = C_{\\mathrm{salt}}$.\n3.  Acid dissociation equilibrium: $K_{\\mathrm{a}} = \\dfrac{[\\mathrm{H^+}][\\mathrm{A^-}]}{[\\mathrm{HA}]}$.\n4.  Water autodissociation equilibrium: $K_{\\mathrm{w}} = [\\mathrm{H^+}][\\mathrm{OH^-}]$.\n\nLet us denote the hydrogen ion concentration as $h \\equiv [\\mathrm{H^+}]$. Our objective is to derive a single equation for $h$. From the water autodissociation equilibrium (4), we express the hydroxide concentration as $[\\mathrm{OH^-}] = K_{\\mathrm{w}}/h$. Substituting this and $[\\mathrm{Na^+}] = C_{\\mathrm{salt}}$ into the charge balance equation (2) allows us to express the conjugate base concentration $[\\mathrm{A^-}]$ in terms of $h$:\n$$\nC_{\\mathrm{salt}} + h = [\\mathrm{A^-}] + \\frac{K_{\\mathrm{w}}}{h} \\implies [\\mathrm{A^-}] = C_{\\mathrm{salt}} + h - \\frac{K_{\\mathrm{w}}}{h}\n$$\nNext, we use the acid dissociation (3) and mass balance (1) relations to find an alternative expression for $[\\mathrm{A^-}]$. From (3), we have $[\\mathrm{HA}] = \\frac{h[\\mathrm{A^-}]}{K_{\\mathrm{a}}}$. Substituting this into (1):\n$$\n\\frac{h[\\mathrm{A^-}]}{K_{\\mathrm{a}}} + [\\mathrm{A^-}] = C_{\\mathrm{T}} \\implies [\\mathrm{A^-}]\\left(\\frac{h}{K_{\\mathrm{a}}}+1\\right) = C_{\\mathrm{T}} \\implies [\\mathrm{A^-}] = C_{\\mathrm{T}}\\left(\\frac{K_{\\mathrm{a}}}{h+K_{\\mathrm{a}}}\\right)\n$$\nEquating the two expressions for $[\\mathrm{A^-}]$ yields the governing equation for $h$:\n$$\nC_{\\mathrm{salt}} + h - \\frac{K_{\\mathrm{w}}}{h} = (C_{\\mathrm{HA}} + C_{\\mathrm{salt}})\\left(\\frac{K_{\\mathrm{a}}}{h+K_{\\mathrm{a}}}\\right)\n$$\nTo solve for $h$, we rearrange this into a polynomial form by multiplying all terms by $h(h+K_{\\mathrm{a}})$:\n$$\n(C_{\\mathrm{salt}} + h)h(h+K_{\\mathrm{a}}) - K_{\\mathrm{w}}(h+K_{\\mathrm{a}}) = (C_{\\mathrm{HA}} + C_{\\mathrm{salt}})K_{\\mathrm{a}}h\n$$\nExpanding and collecting terms of the powers of $h$:\n$$\nh^3 + (K_{\\mathrm{a}} + C_{\\mathrm{salt}})h^2 - (K_{\\mathrm{a}}C_{\\mathrm{HA}} + K_{\\mathrm{w}})h - K_{\\mathrm{a}}K_{\\mathrm{w}} = 0\n$$\nThis is a cubic equation in $h=[\\mathrm{H^+}]$. For any physically realistic set of positive parameters $\\{K_{\\mathrm{a}}, C_{\\mathrm{HA}}, C_{\\mathrm{salt}}, K_{\\mathrm{w}}\\}$, this polynomial has exactly one positive real root. This can be confirmed by Descartes' rule of signs on the coefficients $(1, K_{\\mathrm{a}}+C_{\\mathrm{salt}}, -(K_{\\mathrm{a}}C_{\\mathrm{HA}}+K_{\\mathrm{w}}), -K_{\\mathrm{a}}K_{\\mathrm{w}})$, which have the sign pattern $(+, +, -, -)$, indicating a single sign change and thus a single positive root. This unique positive root is the physically valid concentration $[\\mathrm{H^+}]$. The forward model is completed by calculating $\\mathrm{pH} = -\\log_{10}(h)$.\n\nSecond, we address the inverse problem of estimating $K_{\\mathrm{a}}$. We are given $N$ data pairs $\\{(C_{\\mathrm{salt},i}, \\mathrm{pH}_i^{\\mathrm{(meas)}})\\}_{i=1}^N$. The estimation is performed by minimizing the sum of squared residuals (RSS) between the measured $\\mathrm{pH}$ and the model-predicted $\\mathrm{pH}$:\n$$\nS(K_{\\mathrm{a}}) = \\sum_{i=1}^N \\left(\\mathrm{pH}_i^{\\mathrm{(meas)}} - \\mathrm{pH}_i^{\\mathrm{(model)}}(K_{\\mathrm{a}}, C_{\\mathrm{HA}}, C_{\\mathrm{salt},i})\\right)^2\n$$\nTo enforce the physical constraint $K_{\\mathrm{a}} > 0$ and to improve the numerical stability of the optimization, we perform a change of variables to $\\theta = \\ln K_{\\mathrm{a}}$, so that $K_{\\mathrm{a}} = e^{\\theta}$. The optimization problem becomes finding $\\hat{\\theta}$ that minimizes:\n$$\nS(\\theta) = \\sum_{i=1}^N \\left(\\mathrm{pH}_i^{\\mathrm{(meas)}} - \\mathrm{pH}_i^{\\mathrm{(model)}}(e^{\\theta}, C_{\\mathrmHA}, C_{\\mathrm{salt},i})\\right)^2\n$$\nThis is a one-dimensional optimization problem over the specified bounded domain $\\theta \\in [\\ln(10^{-12}), \\ln(1)]$, which can be efficiently solved using numerical methods such as Brent's method. The estimate for $K_{\\mathrm{a}}$ is then $\\hat{K}_{\\mathrm{a}} = e^{\\hat{\\theta}}$.\n\nThird, we construct the confidence interval for the estimate $\\hat{K}_{\\mathrm{a}}$. For independent and identically distributed Gaussian errors in the measured variable ($\\mathrm{pH}$), the variance of the parameter estimator $\\hat{\\theta}$ can be approximated using the Cramer-Rao lower bound, which is the inverse of the Fisher information, $\\mathcal{I}(\\theta)$. The Fisher information for a single parameter $\\theta$ is given by:\n$$\n\\mathcal{I}(\\theta) = \\frac{1}{\\sigma^2}\\sum_{i=1}^N \\left(\\frac{\\partial \\mathrm{pH}_i^{\\mathrm{(model)}}}{\\partial \\theta}\\right)^2\n$$\nHere, $\\sigma^2$ is the variance of the measurement noise in $\\mathrm{pH}$ units. Since $\\sigma^2$ is unknown, it is estimated from the residuals of the fit: $\\hat{\\sigma}^2 = \\frac{\\mathrm{RSS}_{\\min}}{N-p}$, where $\\mathrm{RSS}_{\\min} = S(\\hat{\\theta})$ is the minimum residual sum of squares and $p=1$ is the number of fitted parameters. The sensitivity derivatives $\\frac{\\partial \\mathrm{pH}}{\\partial \\theta}$ are computed numerically at the optimal value $\\hat{\\theta}$ using a symmetric central difference formula for stability:\n$$\n\\frac{\\partial \\mathrm{pH}_i^{\\mathrm{(model)}}}{\\partial \\theta} \\approx \\frac{\\mathrm{pH}_i^{\\mathrm{(model)}}(e^{\\hat{\\theta}+\\delta}) - \\mathrm{pH}_i^{\\mathrm{(model)}}(e^{\\hat{\\theta}-\\delta})}{2\\delta}\n$$\nfor a small step size $\\delta$. The Fisher information is then evaluated at the estimate: \n$$\\mathcal{I}(\\hat{\\theta}) = \\frac{1}{\\hat{\\sigma}^2}\\sum_{i=1}^N \\left(\\frac{\\partial \\mathrm{pH}_i}{\\partial \\theta}\\right)^2_{\\theta=\\hat{\\theta}}$$\nThe standard error of the estimator $\\hat{\\theta}$ is $\\mathrm{se}(\\hat{\\theta}) = \\sqrt{\\mathcal{I}(\\hat{\\theta})^{-1}}$. An approximate $95\\%$ confidence interval for $\\theta$ is then:\n$$[\\theta_{\\mathrm{lo}}, \\theta_{\\mathrm{hi}}] = [\\hat{\\theta} - 1.96 \\cdot \\mathrm{se}(\\hat{\\theta}), \\hat{\\theta} + 1.96 \\cdot \\mathrm{se}(\\hat{\\theta})]$$\nBy transforming the endpoints of this interval back to the original parameter space, we obtain the $95\\%$ confidence interval for $K_{\\mathrm{a}}$:\n$$\n[K_{\\mathrm{a},\\mathrm{lo95}}, K_{\\mathrm{a},\\mathrm{hi95}}] = [e^{\\theta_{\\mathrm{lo}}}, e^{\\theta_{\\mathrm{hi}}}]\n$$\nThis completes the theoretical framework. The implementation will follow these steps precisely for each test case.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It generates data, estimates Ka, computes confidence intervals,\n    and prints the formatted results.\n    \"\"\"\n    K_w = 1.0e-14\n    random_seed = 2025\n\n    test_cases = [\n        { # Case A\n            \"Ka_true\": 1.8e-5, \"C_HA\": 1.0e-2,\n            \"C_salt_list\": [0.0, 1.0e-3, 3.0e-3, 1.0e-2, 3.0e-2],\n            \"sigma_pH\": 2.0e-3\n        },\n        { # Case B\n            \"Ka_true\": 1.0e-8, \"C_HA\": 1.0e-3,\n            \"C_salt_list\": [0.0, 3.0e-4, 1.0e-3, 3.0e-3],\n            \"sigma_pH\": 2.0e-3\n        },\n        { # Case C\n            \"Ka_true\": 1.0e-6, \"C_HA\": 5.0e-3,\n            \"C_salt_list\": [0.0, 5.0e-2, 1.0e-1, 2.0e-1],\n            \"sigma_pH\": 2.0e-3\n        },\n    ]\n\n    all_results = []\n    for case in test_cases:\n        Ka_est, Ka_lo, Ka_hi = solve_case(\n            Ka_true=case[\"Ka_true\"],\n            C_HA=case[\"C_HA\"],\n            C_salt_list=np.array(case[\"C_salt_list\"]),\n            sigma_pH=case[\"sigma_pH\"],\n            K_w=K_w,\n            seed=random_seed\n        )\n        all_results.append([f\"{Ka_est:.6e}\", f\"{Ka_lo:.6e}\", f\"{Ka_hi:.6e}\"])\n\n    # Format output as a list of lists\n    formatted_output = \",\".join([f\"[{','.join(res)}]\" for res in all_results])\n    print(f\"[{formatted_output}]\")\n\n\ndef forward_model(Ka, C_HA, C_salt, K_w):\n    \"\"\"\n    Computes the pH for given system parameters by solving the cubic equation for [H+].\n    \"\"\"\n    if Ka <= 0:\n        return np.nan\n\n    # Coefficients of the cubic equation: h^3 + a2*h^2 + a1*h + a0 = 0\n    a2 = Ka + C_salt\n    a1 = -(Ka * C_HA + K_w)\n    a0 = -(Ka * K_w)\n    coeffs = [1, a2, a1, a0]\n\n    roots = np.roots(coeffs)\n    \n    # Find the unique positive real root\n    positive_real_roots = roots[(np.isreal(roots)) & (roots > 0)].real\n    if len(positive_real_roots) != 1:\n        # Fallback for numerical instability, though not expected here\n        return np.nan\n        \n    h_plus = positive_real_roots[0]\n    return -np.log10(h_plus)\n\n\ndef solve_case(Ka_true, C_HA, C_salt_list, sigma_pH, K_w, seed):\n    \"\"\"\n    Solves a single test case: data generation, optimization, and CI calculation.\n    \"\"\"\n    rng = np.random.default_rng(seed)\n    N = len(C_salt_list)\n\n    # 1. Data Generation\n    pH_true = np.array([forward_model(Ka_true, C_HA, cs, K_w) for cs in C_salt_list])\n    noise = rng.normal(0, sigma_pH, size=N)\n    pH_measured = pH_true + noise\n\n    # 2. Parameter Estimation (Nonlinear Least Squares)\n    def objective_function(theta):\n        Ka = np.exp(theta)\n        pH_model = np.array([forward_model(Ka, C_HA, cs, K_w) for cs in C_salt_list])\n        if np.isnan(pH_model).any():\n            return np.inf  # Penalize invalid Ka values\n        return np.sum((pH_measured - pH_model)**2)\n\n    # Bounded 1D optimization for theta = ln(Ka)\n    bounds = (np.log(1e-12), np.log(1))\n    result = minimize_scalar(objective_function, bounds=bounds, method='bounded')\n\n    theta_hat = result.x\n    Ka_hat = np.exp(theta_hat)\n    rss_min = result.fun\n\n    # 3. Confidence Interval Calculation\n    # Estimate noise variance\n    sigma2_hat = rss_min / (N - 1)\n    \n    # Calculate sensitivities (dpH/dtheta) using central differences\n    delta = 1e-7 # Small step for numerical derivative\n    \n    Ka_upper = np.exp(theta_hat + delta)\n    Ka_lower = np.exp(theta_hat - delta)\n    \n    ph_upper = np.array([forward_model(Ka_upper, C_HA, cs, K_w) for cs in C_salt_list])\n    ph_lower = np.array([forward_model(Ka_lower, C_HA, cs, K_w) for cs in C_salt_list])\n\n    dpH_dtheta = (ph_upper - ph_lower) / (2 * delta)\n\n    # Calculate Fisher Information\n    fisher_info = np.sum(dpH_dtheta**2) / sigma2_hat\n\n    # 95% CI for theta\n    se_theta = np.sqrt(1 / fisher_info)\n    z_score = 1.96 # For 95% CI\n    theta_lo = theta_hat - z_score * se_theta\n    theta_hi = theta_hat + z_score * se_theta\n\n    # Transform CI back to Ka scale\n    Ka_lo95 = np.exp(theta_lo)\n    Ka_hi95 = np.exp(theta_hi)\n\n    return Ka_hat, Ka_lo95, Ka_hi95\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}