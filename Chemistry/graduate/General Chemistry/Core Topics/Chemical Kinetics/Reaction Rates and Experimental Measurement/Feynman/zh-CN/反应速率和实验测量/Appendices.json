{
    "hands_on_practices": [
        {
            "introduction": "在实验化学动力学中，我们测量的通常是在离散时间点上的浓度，而非反应速率的连续函数。然而，速率定律的核心是瞬时速率，即浓度随时间变化的导数。本练习旨在弥合这一差距，指导您如何使用数值方法从一系列含噪声的浓度数据中估算特定时刻的瞬时速率。\n\n更重要的是，本练习引入了一个至关重要的数据验证步骤：化学计量一致性检验。对于一个化学反应，不同物种的消耗和生成速率通过化学计量系数相互关联。通过比较由不同物种数据计算出的归一化速率，并运用 $\\chi^2$ 统计检验，我们可以定量评估实验数据是否在测量不确定度的范围内自洽，这是任何后续动力学建模前的基本功。",
            "id": "2954379",
            "problem": "一个单相、充分混合、等温、等容的间歇反应遵循化学计量关系 $A + 2B \\to 3C$。在一个无副反应、体积恒定的密闭容器中，对于反应物 $i$，反应速率 $r(t)$ 由基本化学计量速率恒等式 $r(t) = -\\frac{1}{\\nu_{i}} \\frac{d C_{i}}{d t}$ 定义，其中 $\\nu_{A} = 1$ 和 $\\nu_{B} = 2$。在时间 $t^{\\ast} = 250\\,\\mathrm{s}$ 时，对于物质 $A$ 和 $B$，在三个等间隔的时间点 $t = 240\\,\\mathrm{s}$，$t = 250\\,\\mathrm{s}$ 和 $t = 260\\,\\mathrm{s}$，有可用的浓度-时间测量值。测得的浓度为：\n- 对于物质 $A$：$C_{A}(240\\,\\mathrm{s}) = 0.07620\\,\\mathrm{mol\\,L^{-1}}$，$C_{A}(250\\,\\mathrm{s}) = 0.07400\\,\\mathrm{mol\\,L^{-1}}$，$C_{A}(260\\,\\mathrm{s}) = 0.07190\\,\\mathrm{mol\\,L^{-1}}$。\n- 对于物质 $B$：$C_{B}(240\\,\\mathrm{s}) = 0.25720\\,\\mathrm{mol\\,L^{-1}}$，$C_{B}(250\\,\\mathrm{s}) = 0.25290\\,\\mathrm{mol\\,L^{-1}}$，$C_{B}(260\\,\\mathrm{s}) = 0.24850\\,\\mathrm{mol\\,L^{-1}}$。\n\n每个浓度测量值都有一个独立的、呈正态分布的标准不确定度：对于 $A$，$\\sigma_{C_A} = 4.00 \\times 10^{-4}\\,\\mathrm{mol\\,L^{-1}}$；对于 $B$，$\\sigma_{C_B} = 6.00 \\times 10^{-4}\\,\\mathrm{mol\\,L^{-1}}$。相对于浓度的不确定度，时间的不确定度可以忽略不计。\n\n在 $t^{\\ast} = 250\\,\\mathrm{s}$ 时，仅使用上述基本定义，按以下步骤进行：\n1. 对每种物质，通过对其最近的三个数据点拟合一个关于时间的局部二次模型，并计算在 $t^{\\ast}$ 处的斜率，来估计瞬时导数 $\\left.\\frac{d C_{A}}{d t}\\right|_{t^{\\ast}}$ 和 $\\left.\\frac{d C_{B}}{d t}\\right|_{t^{\\ast}}$ 及其标准不确定度。在所述的独立性假设下，论证从浓度的不确定度到导数的不确定度的传播。\n2. 建立在 $t^{\\ast}$ 时的两个化学计量归一化速率估计值，$r_{A} \\equiv -\\left.\\frac{d C_{A}}{d t}\\right|_{t^{\\ast}}$ 和 $r_{B} \\equiv -\\frac{1}{2}\\left.\\frac{d C_{B}}{d t}\\right|_{t^{\\ast}}$，并给出它们的标准不确定度。\n3. 在化学计量一致性假设 ($r_{A} = r_{B} = r(t^{\\ast})$) 下，计算共同速率的反方差加权估计量 $\\hat{r}$ 和 Pearson 卡方统计量 $\\chi^{2} = \\sum_{i \\in \\{A,B\\}} \\frac{(r_{i} - \\hat{r})^{2}}{\\sigma_{r_{i}}^{2}}$。报告自由度为 $\\nu = 2 - 1$ 的约化卡方 $\\chi^{2}_{\\nu} \\equiv \\chi^{2}/\\nu$。\n\n在 $t^{\\ast}$ 时的约化卡方 $\\chi^{2}_{\\nu}$ 的数值是多少？将您的答案四舍五入至三位有效数字。最终答案应为一个无单位的纯数。",
            "solution": "首先验证问题的科学合理性、一致性和完整性。\n问题陈述提供了：\n- 化学计量关系：$A + 2B \\to 3C$。\n- 速率定义：对于反应物，$r(t) = -\\frac{1}{\\nu_{i}} \\frac{d C_{i}}{d t}$，并给出了 $\\nu_{A} = 1$ 和 $\\nu_{B} = 2$ 的值。此定义符合标准化学动力学。\n- 在 $t = \\{240, 250, 260\\}\\,\\mathrm{s}$ 时的数据点，这些点围绕 $t^{\\ast} = 250\\,\\mathrm{s}$ 对称分布，步长为 $h = 10\\,\\mathrm{s}$。\n- 在这些时间点上物质 $A$ 和 $B$ 的浓度数据。\n- 浓度测量的标准不确定度：$\\sigma_{C_A} = 4.00 \\times 10^{-4}\\,\\mathrm{mol\\,L^{-1}}$ 和 $\\sigma_{C_B} = 6.00 \\times 10^{-4}\\,\\mathrm{mol\\,L^{-1}}$，以及所有测量都是独立的关键条件。\n该问题是适定的，在其所探索的子领域内有科学依据，并包含足够的信息以得到唯一解。因此，该问题被认为是有效的。\n\n解决方案按要求分为三个部分进行。\n\n第1部分：导数及其不确定度的估计。\n\n要在给定三个点 $(t_0-h, f_{-1}), (t_0, f_0), (t_0+h, f_1)$ 的情况下估计函数 $f(t)$ 在点 $t_0$ 的导数，我们可以拟合一个唯一的二次多项式 $P(t)$ 穿过这些点。该多项式在 $t_0$ 处的导数即为估计值。插值多项式的 Lagrange 形式提供了一种直接求得该导数的方法。更简单地说，设在平移的时间坐标 $\\tau = t - t_0$ 下，多项式为 $P(\\tau) = a\\tau^2 + b\\tau + c$。其导数为 $P'(\\tau) = 2a\\tau + b$。在 $\\tau=0$ 时（即在 $t=t_0$ 时），导数为 $b$。通过代入数据点 $(\\tau, f) = (-h, f_{-1}), (0, f_0), (h, f_1)$，我们求解 $b$。\n$f_1 = ah^2 + bh + c$\n$f_{-1} = ah^2 - bh + c$\n第一个方程减去第二个方程得到 $f_1 - f_{-1} = 2bh$，从而得出 $b = \\frac{f_1 - f_{-1}}{2h}$。这是一阶导数的中心差分公式。\n\n将此公式应用于物质 $A$，在 $t^{\\ast} = 250\\,\\mathrm{s}$ 且 $h=10\\,\\mathrm{s}$ 时：\n$$ \\left.\\frac{d C_{A}}{d t}\\right|_{t^{\\ast}} = \\frac{C_{A}(260\\,\\mathrm{s}) - C_{A}(240\\,\\mathrm{s})}{2h} = \\frac{0.07190 - 0.07620}{2 \\times 10} = \\frac{-0.00430}{20} = -2.15 \\times 10^{-4}\\,\\mathrm{mol\\,L^{-1}\\,s^{-1}} $$\n对于物质 $B$：\n$$ \\left.\\frac{d C_{B}}{d t}\\right|_{t^{\\ast}} = \\frac{C_{B}(260\\,\\mathrm{s}) - C_{B}(240\\,\\mathrm{s})}{2h} = \\frac{0.24850 - 0.25720}{2 \\times 10} = \\frac{-0.00870}{20} = -4.35 \\times 10^{-4}\\,\\mathrm{mol\\,L^{-1}\\,s^{-1}} $$\n为了论证不确定度的传播，设导数估计量为 $D = \\frac{C_1 - C_{-1}}{2h}$。鉴于浓度测量值 $C_1$ 和 $C_{-1}$ 是具有相同标准不确定度 $\\sigma_C$ 的独立随机变量， $D$ 的方差，记为 $\\sigma_D^2$，可使用不确定度传播公式求得：\n$$ \\sigma_D^2 = \\left(\\frac{\\partial D}{\\partial C_1}\\right)^2 \\sigma_{C}^2 + \\left(\\frac{\\partial D}{\\partial C_{-1}}\\right)^2 \\sigma_{C}^2 $$\n偏导数分别为 $\\frac{\\partial D}{\\partial C_1} = \\frac{1}{2h}$ 和 $\\frac{\\partial D}{\\partial C_{-1}} = -\\frac{1}{2h}$。\n$$ \\sigma_D^2 = \\left(\\frac{1}{2h}\\right)^2 \\sigma_{C}^2 + \\left(-\\frac{1}{2h}\\right)^2 \\sigma_{C}^2 = \\frac{\\sigma_C^2}{4h^2} + \\frac{\\sigma_C^2}{4h^2} = \\frac{2\\sigma_C^2}{4h^2} = \\frac{\\sigma_C^2}{2h^2} $$\n因此，标准不确定度为 $\\sigma_D = \\frac{\\sigma_C}{\\sqrt{2}h}$。\n\n对于 $C_A$ 的导数，方差为：\n$$ \\sigma_{dC_A/dt}^2 = \\frac{\\sigma_{C_A}^2}{2h^2} = \\frac{(4.00 \\times 10^{-4})^2}{2 \\times (10)^2} = \\frac{1.6 \\times 10^{-7}}{200} = 8.0 \\times 10^{-10}\\,\\mathrm{(mol\\,L^{-1}\\,s^{-1})^2} $$\n对于 $C_B$ 的导数，方差为：\n$$ \\sigma_{dC_B/dt}^2 = \\frac{\\sigma_{C_B}^2}{2h^2} = \\frac{(6.00 \\times 10^{-4})^2}{2 \\times (10)^2} = \\frac{3.6 \\times 10^{-7}}{200} = 1.8 \\times 10^{-9}\\,\\mathrm{(mol\\,L^{-1}\\,s^{-1})^2} = 18 \\times 10^{-10}\\,\\mathrm{(mol\\,L^{-1}\\,s^{-1})^2} $$\n\n第2部分：化学计量归一化速率估计值的形成。\n\n基于物质 $A$ 的速率估计值为 $r_A \\equiv -\\frac{d C_A}{dt}$。\n$$ r_A = -(-2.15 \\times 10^{-4}) = 2.15 \\times 10^{-4}\\,\\mathrm{mol\\,L^{-1}\\,s^{-1}} $$\n其方差为 $\\sigma_{r_A}^2 = (-1)^2 \\sigma_{dC_A/dt}^2 = 8.0 \\times 10^{-10}\\,\\mathrm{(mol\\,L^{-1}\\,s^{-1})^2}$。\n\n基于物质 $B$ 的速率估计值为 $r_B \\equiv -\\frac{1}{2}\\frac{d C_B}{dt}$。\n$$ r_B = -\\frac{1}{2}(-4.35 \\times 10^{-4}) = 2.175 \\times 10^{-4}\\,\\mathrm{mol\\,L^{-1}\\,s^{-1}} $$\n其方差为 $\\sigma_{r_B}^2 = (-\\frac{1}{2})^2 \\sigma_{dC_B/dt}^2 = \\frac{1}{4} (18 \\times 10^{-10}) = 4.5 \\times 10^{-10}\\,\\mathrm{(mol\\,L^{-1}\\,s^{-1})^2}$。\n\n第3部分：加权平均和卡方分析。\n\n在化学计量一致性假设下，$r_A$ 和 $r_B$ 是对同一真实速率 $r(t^{\\ast})$ 的两次独立测量。这个共同速率的最佳估计是反方差加权平均值 $\\hat{r}$：\n$$ \\hat{r} = \\frac{\\frac{r_A}{\\sigma_{r_A}^2} + \\frac{r_B}{\\sigma_{r_B}^2}}{\\frac{1}{\\sigma_{r_A}^2} + \\frac{1}{\\sigma_{r_B}^2}} = \\frac{\\frac{2.15 \\times 10^{-4}}{8.0 \\times 10^{-10}} + \\frac{2.175 \\times 10^{-4}}{4.5 \\times 10^{-10}}}{\\frac{1}{8.0 \\times 10^{-10}} + \\frac{1}{4.5 \\times 10^{-10}}} $$\n$$ \\hat{r} = \\frac{(2.15/8.0) + (2.175/4.5)}{(1/8.0) + (1/4.5)} \\times 10^{-4} = \\frac{0.26875 + 0.48333...}{0.125 + 0.22222...} \\times 10^{-4} = \\frac{0.7520833...}{0.347222...} \\times 10^{-4} \\approx 2.166 \\times 10^{-4}\\,\\mathrm{mol\\,L^{-1}\\,s^{-1}} $$\n精确计算： $\\hat{r} = \\frac{r_A w_A + r_B w_B}{w_A + w_B}$，权重为 $w_A=1/8, w_B=1/4.5=2/9$（暂时忽略公因子）。$w_A+w_B = 1/8+2/9 = 25/72$。$r_A w_A + r_B w_B = (2.15/8 + 2.175\\cdot 2/9) \\times 10^{-4} = (\\frac{19.35+34.8}{72}) \\times 10^{-4} = \\frac{54.15}{72} \\times 10^{-4}$。所以，$\\hat{r} = \\frac{54.15}{25}\\times 10^{-4} = 2.166 \\times 10^{-4}$。\n\nPearson 卡方统计量的计算如下：\n$$ \\chi^2 = \\sum_{i \\in \\{A,B\\}} \\frac{(r_i - \\hat{r})^2}{\\sigma_{r_i}^2} $$\n对于两次测量，这可以简化为 $\\chi^2 = \\frac{(r_A - r_B)^2}{\\sigma_{r_A}^2 + \\sigma_{r_B}^2}$。\n速率差为 $r_A - r_B = (2.15 - 2.175) \\times 10^{-4} = -0.025 \\times 10^{-4}\\,\\mathrm{mol\\,L^{-1}\\,s^{-1}}$。\n方差之和为 $\\sigma_{r_A}^2 + \\sigma_{r_B}^2 = (8.0 + 4.5) \\times 10^{-10} = 12.5 \\times 10^{-10}\\,\\mathrm{(mol\\,L^{-1}\\,s^{-1})^2}$。\n$$ \\chi^2 = \\frac{(-0.025 \\times 10^{-4})^2}{12.5 \\times 10^{-10}} = \\frac{6.25 \\times 10^{-12}}{1.25 \\times 10^{-9}} = 5 \\times 10^{-3} = 0.005 $$\n自由度为 $\\nu = N - P = 2 - 1 = 1$，其中 $N=2$ 是数据点（$r_A$，$r_B$）的数量，$P=1$ 是从这些数据点估计出的参数（$\\hat{r}$）的数量。\n\n约化卡方 $\\chi^2_\\nu$ 为：\n$$ \\chi^2_\\nu = \\frac{\\chi^2}{\\nu} = \\frac{0.005}{1} = 0.005 $$\n四舍五入到三位有效数字，结果为 $0.00500$。\n用科学记数法表示，即为 $5.00 \\times 10^{-3}$。\n约化卡方值接近1表示测量值之间的观测离散程度与其估计的不确定度相符。如此处所得，远小于1的值表明测量值之间的一致性显著好于其不确定度所预期的水平，这可能意味着不确定度被高估了。\n最终所需的值是约化卡方的数值。\n\n$\\chi^2_\\nu = 0.00500$。",
            "answer": "$$\\boxed{5.00 \\times 10^{-3}}$$"
        },
        {
            "introduction": "确定了反应的速率常数后，我们必须确保这些动力学参数在物理上是自洽的，并且不违反热力学的基本定律。本练习探讨了动力学和热力学之间一个深刻的联系——细致平衡原理，该原理要求在平衡状态下，任何基元反应的正向速率都必须等于其逆向速率。\n\n对于一个可逆反应，这意味着正向和逆向活化能垒的高度并非完全独立，它们的高度差必须等于反应的整体标准吉布斯自由能变 $\\Delta G^\\circ$。通过这项实践，您将学会如何检验一组实验测得的活化参数是否与已知的热力学数据相符，并学习如何基于热力学约束来修正动力学模型，确保其物理真实性。",
            "id": "2954346",
            "problem": "在 $T = 298.15\\ \\mathrm{K}$ 的稀溶液中，一个可逆异构化反应 $\\mathrm{A} \\rightleftharpoons \\mathrm{B}$ 在此温度下具有一个精确表征的标准吉布斯自由能变 $\\Delta G^\\circ = -12.60\\ \\mathrm{kJ\\ mol^{-1}}$ (标准态为 $1\\ \\mathrm{mol\\ L^{-1}}$)。根据随温度变化的速率测量结果，通过过渡态理论(TST)对一个提出的单步反应机理进行分析，在 $T = 298.15\\ \\mathrm{K}$ 时得到以下活化参数：\n- 正向反应 $\\mathrm{A} \\to \\mathrm{B}$: $\\Delta H_f^{\\ddagger} = 54.00\\ \\mathrm{kJ\\ mol^{-1}}$，$\\Delta S_f^{\\ddagger} = -45.00\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$；\n- 逆向反应 $\\mathrm{B} \\to \\mathrm{A}$: $\\Delta H_r^{\\ddagger} = 37.00\\ \\mathrm{kJ\\ mol^{-1}}$，$\\Delta S_r^{\\ddagger} = -80.00\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$。\n\n假设两个反应方向具有相同且不随温度变化的透射系数 $\\kappa = 1$，TST适用，标准态相同，并且没有活度系数效应。仅使用平衡常数和速率常数之间的基本关系，首先评估在 $T = 298.15\\ \\mathrm{K}$ 时，这些活化参数是否与给定的 $\\Delta G^\\circ$ 在热力学上一致。然后，在 $T = 298.15\\ \\mathrm{K}$ 时施加细致平衡条件，同时保持 $\\Delta H_r^{\\ddagger}$ 固定在其给定值，确定 $\\Delta S_r^{\\ddagger}$ 的唯一校正值，以满足热力学一致性。\n\n将最终结果四舍五入至四位有效数字，并以 $\\mathrm{J\\ mol^{-1}\\ K^{-1}}$ 为单位表示。你的最终答案必须是一个实数。",
            "solution": "此问题的分析基于平衡状态下的细致平衡基本原理。对于基元可逆反应 $\\mathrm{A} \\rightleftharpoons \\mathrm{B}$，平衡常数 $K_c$ 是正向速率常数 $k_f$ 与逆向速率常数 $k_r$ 的比值：\n$$K_c = \\frac{k_f}{k_r}$$\n根据热力学，反应的标准吉布斯自由能变 $\\Delta G^\\circ$ 与平衡常数的关系如下：\n$$\\Delta G^\\circ = -RT \\ln K_c$$\n其中 $R$ 是气体常数，$T$ 是绝对温度。\n\n根据过渡态理论(TST)，对于溶液中的一级反应，速率常数 $k$ 由 Eyring 方程给出：\n$$k = \\kappa \\frac{k_B T}{h} \\exp\\left(-\\frac{\\Delta G^\\ddagger}{RT}\\right)$$\n此处，$\\kappa$ 是透射系数，$k_B$ 是玻尔兹曼常数，$h$ 是普朗克常数，$\\Delta G^\\ddagger$ 是活化吉布斯自由能。活化吉布斯自由能通过以下关系与活化焓 $\\Delta H^\\ddagger$ 和活化熵 $\\Delta S^\\ddagger$ 相关联：\n$$\\Delta G^\\ddagger = \\Delta H^\\ddagger - T\\Delta S^\\ddagger$$\n将 Eyring 方程应用于正向和逆向反应，我们得到：\n$$k_f = \\kappa_f \\frac{k_B T}{h} \\exp\\left(-\\frac{\\Delta G_f^\\ddagger}{RT}\\right)$$\n$$k_r = \\kappa_r \\frac{k_B T}{h} \\exp\\left(-\\frac{\\Delta G_r^\\ddagger}{RT}\\right)$$\n将这些代入 $\\Delta G^\\circ$ 的表达式中：\n$$\\Delta G^\\circ = -RT \\ln\\left(\\frac{k_f}{k_r}\\right) = -RT \\ln\\left(\\frac{\\kappa_f \\exp(-\\Delta G_f^\\ddagger/RT)}{\\kappa_r \\exp(-\\Delta G_r^\\ddagger/RT)}\\right)$$\n鉴于两个方向的透射系数相同 ($\\kappa_f = \\kappa_r = \\kappa$)，表达式简化为：\n$$\\Delta G^\\circ = -RT \\left[ \\ln\\left(\\exp\\left(-\\frac{\\Delta G_f^\\ddagger}{RT}\\right)\\right) - \\ln\\left(\\exp\\left(-\\frac{\\Delta G_r^\\ddagger}{RT}\\right)\\right) \\right]$$\n$$\\Delta G^\\circ = -RT \\left[ -\\frac{\\Delta G_f^\\ddagger}{RT} + \\frac{\\Delta G_r^\\ddagger}{RT} \\right] = \\Delta G_f^\\ddagger - \\Delta G_r^\\ddagger$$\n最后这个方程 $\\Delta G^\\circ = \\Delta G_f^\\ddagger - \\Delta G_r^\\ddagger$ 建立了总反应热力学与正向和逆向步骤的活化参数之间的直接联系。这是热力学一致性的核心条件。\n\n首先，我们评估所提供的实验活化参数的一致性。给定数据如下：\n$T = 298.15\\ \\mathrm{K}$\n$\\Delta G^\\circ = -12.60\\ \\mathrm{kJ\\ mol^{-1}} = -12600\\ \\mathrm{J\\ mol^{-1}}$\n对于正向反应 ($\\mathrm{A} \\to \\mathrm{B}$):\n$\\Delta H_f^{\\ddagger} = 54.00\\ \\mathrm{kJ\\ mol^{-1}} = 54000\\ \\mathrm{J\\ mol^{-1}}$\n$\\Delta S_f^{\\ddagger} = -45.00\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$\n对于逆向反应 ($\\mathrm{B} \\to \\mathrm{A}$):\n$\\Delta H_r^{\\ddagger} = 37.00\\ \\mathrm{kJ\\ mol^{-1}} = 37000\\ \\mathrm{J\\ mol^{-1}}$\n$\\Delta S_r^{\\ddagger} = -80.00\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$\n\n我们使用所提供的数据计算正向和逆向反应的活化吉布斯自由能：\n$$\\Delta G_f^\\ddagger = \\Delta H_f^\\ddagger - T\\Delta S_f^\\ddagger = 54000\\ \\mathrm{J\\ mol^{-1}} - (298.15\\ \\mathrm{K})(-45.00\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}})$$\n$$\\Delta G_f^\\ddagger = 54000\\ \\mathrm{J\\ mol^{-1}} + 13416.75\\ \\mathrm{J\\ mol^{-1}} = 67416.75\\ \\mathrm{J\\ mol^{-1}}$$\n\n$$\\Delta G_r^\\ddagger = \\Delta H_r^\\ddagger - T\\Delta S_r^\\ddagger = 37000\\ \\mathrm{J\\ mol^{-1}} - (298.15\\ \\mathrm{K})(-80.00\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}})$$\n$$\\Delta G_r^\\ddagger = 37000\\ \\mathrm{J\\ mol^{-1}} + 23852\\ \\mathrm{J\\ mol^{-1}} = 60852\\ \\mathrm{J\\ mol^{-1}}$$\n\n现在我们计算这些动力学参数所隐含的反应标准吉布斯自由能变：\n$$\\Delta G_{\\text{calc}}^\\circ = \\Delta G_f^\\ddagger - \\Delta G_r^\\ddagger = 67416.75\\ \\mathrm{J\\ mol^{-1}} - 60852\\ \\mathrm{J\\ mol^{-1}} = 6564.75\\ \\mathrm{J\\ mol^{-1}}$$\n我们将此计算值与热力学测量值 $\\Delta G^\\circ = -12600\\ \\mathrm{J\\ mol^{-1}}$ 进行比较。由于 $6564.75\\ \\mathrm{J\\ mol^{-1}} \\neq -12600\\ \\mathrm{J\\ mol^{-1}}$，所提供的活化参数与已知的平衡数据在热力学上是不一致的。\n\n接下来，我们必须校正 $\\Delta S_r^{\\ddagger}$ 的值以强制实现一致性，同时保持所有其他指定参数不变。必须满足的条件是：\n$$\\Delta G^\\circ = (\\Delta H_f^\\ddagger - T\\Delta S_f^\\ddagger) - (\\Delta H_r^\\ddagger - T\\Delta S_{r,corr}^{\\ddagger})$$\n其中 $\\Delta S_{r,corr}^{\\ddagger}$ 是我们寻求的校正值。我们重排此方程以求解 $\\Delta S_{r,corr}^{\\ddagger}$：\n$$\\Delta G^\\circ = \\Delta H_f^\\ddagger - T\\Delta S_f^\\ddagger - \\Delta H_r^\\ddagger + T\\Delta S_{r,corr}^{\\ddagger}$$\n$$T\\Delta S_{r,corr}^{\\ddagger} = \\Delta G^\\circ - \\Delta H_f^\\ddagger + T\\Delta S_f^\\ddagger + \\Delta H_r^\\ddagger$$\n$$\\Delta S_{r,corr}^{\\ddagger} = \\frac{\\Delta G^\\circ - (\\Delta H_f^\\ddagger - \\Delta H_r^\\ddagger) + T\\Delta S_f^\\ddagger}{T}$$\n代入数值：\n$$\\Delta S_{r,corr}^{\\ddagger} = \\frac{-12600\\ \\mathrm{J\\ mol^{-1}} - (54000 - 37000)\\ \\mathrm{J\\ mol^{-1}} + (298.15\\ \\mathrm{K})(-45.00\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}})}{298.15\\ \\mathrm{K}}$$\n$$\\Delta S_{r,corr}^{\\ddagger} = \\frac{-12600 - 17000 - 13416.75}{298.15}\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$$\n$$\\Delta S_{r,corr}^{\\ddagger} = \\frac{-43016.75}{298.15}\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$$\n$$\\Delta S_{r,corr}^{\\ddagger} = -144.27608... \\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$$\n按要求将结果四舍五入至四位有效数字，得到：\n$$\\Delta S_{r,corr}^{\\ddagger} = -144.3\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$$\n这个逆向活化熵的值可以确保动力学模型与宏观热力学平衡常数相一致。",
            "answer": "$$\\boxed{-144.3}$$"
        },
        {
            "introduction": "在前述练习关注于局部速率估算和理论一致性检验之后，本实践将带您进入现代动力学数据分析的核心：将一个完整的动力学模型拟合到整个实验数据集。我们将以生物化学中无处不在的 Michaelis-Menten 方程为例，通过加权非线性最小二乘法从初始速率数据中提取关键参数，如米氏常数 $K_M$ 和最大反应速率 $V_{max}$。\n\n本练习的价值远不止于参数估计。您将学习如何量化拟合参数的不确定性并评估它们之间的相关性，这对于严谨地报告和解释结果至关重要。通过分析不同数据分布（覆盖宽范围、饱和区主导、低浓度区）的案例，您将深刻体会到实验设计如何直接影响参数识别的可靠性，这是从“会算”到“会设计实验”的关键一步。",
            "id": "2954370",
            "problem": "给定来自三个独立实验的初始速率数据，这些实验旨在探究均相溶液中的酶饱和动力学。实验在受控的温度和压力下进行，且产物抑制可忽略不计。假设早期速率能被米氏-门顿定律很好地描述。米氏-门顿定律是化学动力学中一个经过充分检验的模型，它通过以下公式将初始速率 $v$ 与底物浓度 $[S]$ 联系起来：\n$$\nv([S];K_M,V_\\text{max}) \\;=\\; \\frac{V_\\text{max}\\,[S]}{K_M + [S]}\\,,\n$$\n其中，$K_M$ 是米氏常数（单位为 $\\mathrm{mol\\,L^{-1}}$），$V_\\text{max}$ 是最大速率（单位为 $\\mathrm{mol\\,L^{-1}\\,s^{-1}}$）。每个测量速率 $v_i$ 都附有一个估计的标准差 $\\sigma_i$，它反映了测量不确定性，并可用于统计有效的加权。您必须从上述速率定律出发，通过加权非线性回归来估计 $K_M$ 和 $V_\\text{max}$，然后量化参数的不确定性和相关性。\n\n您的推导和实现的基本依据：\n- 初始速率的定义 $v \\equiv \\frac{d[P]}{dt}\\big|_{t\\to 0}$，其中 $[P]$ 是产物浓度。\n- 上文给出的米氏-门顿公式。\n- 权重为 $w_i = 1/\\sigma_i^2$ 的加权非线性最小二乘法旨在最小化以下目标函数：\n$$\n\\chi^2(K_M,V_\\text{max}) \\;=\\; \\sum_{i=1}^{N} \\frac{\\left(v_i - \\frac{V_\\text{max}[S]_i}{K_M + [S]_i}\\right)^2}{\\sigma_i^2}\\,,\n$$\n其假设是测量误差是独立的、服从正态分布，并且具有已知的标准差 $\\sigma_i$。\n- 在最优点附近，参数协方差矩阵 $\\mathbf{C}$ 可通过残差关于参数的雅可比矩阵 $\\mathbf{J}$ 计算得出，即 $\\mathbf{C} \\approx \\left(\\mathbf{J}^\\mathsf{T}\\mathbf{W}\\mathbf{J}\\right)^{-1}$，其中 $\\mathbf{W}=\\mathrm{diag}(1/\\sigma_i^2)$ 是权重矩阵。对于每个参数，在置信水平 $1-\\alpha$ 下的近似双侧置信区间由 $\\hat{\\theta} \\pm t_{1-\\alpha/2,\\nu}\\, \\mathrm{SE}(\\hat{\\theta})$ 给出，其中 $\\nu = N - p$ 是自由度，$p$ 是参数数量，$t_{1-\\alpha/2,\\nu}$ 是学生t分布的临界值，而 $\\mathrm{SE}(\\hat{\\theta})=\\sqrt{\\mathrm{Var}(\\hat{\\theta})}$。\n- $K_M$ 和 $V_\\text{max}$ 之间的参数相关系数由协方差矩阵计算得出：\n$$\n\\rho \\;=\\; \\frac{C_{12}}{\\sqrt{C_{11}\\,C_{22}}}\\,.\n$$\n\n任务：\n- 对于下方的每个测试用例，将米氏-门顿模型与数据 $\\{([S]_i, v_i, \\sigma_i)\\}_{i=1}^{N}$ 进行加权非线性最小二乘拟合。在权重计算中使用 $\\sigma_i$作为绝对标准差。\n- 报告拟合得到的 $K_M$ 和 $V_\\text{max}$、参数相关系数 $\\rho$，以及使用协方差矩阵和自由度为 $\\nu=N-2$ 的学生t分布计算出的 $K_M$ 和 $V_\\text{max}$ 的双侧 $95\\%$ 置信区间。\n- 将 $K_M$ 以 $\\mathrm{mol\\,L^{-1}}$ 为单位表示，将 $V_\\text{max}$ 以 $\\mathrm{mol\\,L^{-1}\\,s^{-1}}$ 为单位表示。\n- 将报告的每个浮点数结果四舍五入至 $6$ 位有效数字。\n\n测试套件（所有 $[S]_i$ 的单位为 $\\mathrm{mol\\,L^{-1}}$，所有 $v_i$ 和 $\\sigma_i$ 的单位为 $\\mathrm{mol\\,L^{-1}\\,s^{-1}}$）：\n\n- 用例A（$[S]$ 覆盖范围广）：\n  - $[S]$: [5.0e-6, 1.0e-5, 5.0e-5, 1.0e-4, 2.5e-4, 5.0e-4, 1.0e-3, 2.0e-3]\n  - $v$: [2.60e-8, 4.70e-8, 2.08e-7, 3.509e-7, 6.130e-7, 8.088e-7, 9.687e-7, 1.068e-6]\n  - $\\sigma$: [3.0e-9, 3.0e-9, 1.0e-8, 1.5e-8, 2.0e-8, 2.0e-8, 2.0e-8, 2.0e-8]\n\n- 用例B（饱和主导，对 $K_M$ 的可辨识性构成挑战）：\n  - $[S]$: [1.0e-4, 2.0e-4, 4.0e-4, 8.0e-4, 1.6e-3, 3.2e-3]\n  - $v$: [4.07e-7, 5.283e-7, 6.480e-7, 7.131e-7, 7.459e-7, 7.8176e-7]\n  - $\\sigma$: [1.5e-8, 1.5e-8, 1.5e-8, 1.5e-8, 1.5e-8, 1.5e-8]\n\n- 用例C（极低 $[S]$ 的边界行为及中等饱和）：\n  - $[S]$: [1.0e-8, 5.0e-8, 1.0e-7, 5.0e-7, 1.0e-6, 5.0e-6, 1.0e-5]\n  - $v$: [6.008e-10, 2.940e-9, 5.932e-9, 2.747e-8, 4.96e-8, 1.508e-7, 1.995e-7]\n  - $\\sigma$: [5.0e-11, 8.0e-11, 1.0e-10, 5.0e-10, 8.0e-10, 2.0e-9, 3.0e-9]\n\n您的程序必须：\n- 对每个用例，使用上述米氏-门顿模型实现加权非线性最小二乘拟合。\n- 计算参数协方差矩阵、参数相关系数 $\\rho$ 以及使用自由度为 $\\nu=N-2$ 的学生t分布计算双侧 $95\\%$ 置信区间。\n- 生成单行输出，其中包含汇总了三个用例结果的列表的列表：\n  - 对于每个用例，报告列表 $[K_M, V_\\text{max}, \\rho, K_M^\\text{low}, K_M^\\text{high}, V_\\text{max}^\\text{low}, V_\\text{max}^\\text{high}]$，其中上标“low”和“high”表示双侧 $95\\%$ 置信区间的端点。\n  - 每个浮点数都必须四舍五入到 $6$ 位有效数字。\n- 最后一行必须采用'[[caseA_values_in_order],[caseB_values_in_order],[caseC_values_in_order]]'的精确格式，只包含数值条目，行本身不含任何单位；根据输入数据的构造，所有 $K_M$ 的单位均为 $\\mathrm{mol\\,L^{-1}}$，所有 $V_\\text{max}$ 的单位均为 $\\mathrm{mol\\,L^{-1}\\,s^{-1}}$。",
            "solution": "问题陈述已经过验证，被认为是有效的。它提出了一个化学动力学中的标准且适定的问题，具体来说，是从实验数据中估计米氏-门顿模型的参数。为解决该问题所指定的方法——加权非线性最小二乘法以及随后基于参数协方差矩阵的统计分析——对于此任务是标准且合适的。\n\n该解决方案基于以下既定的数据分析和统计推断原则进行。\n\n将初始反应速率 $v$ 与底物浓度 $[S]$ 相关联的模型是米氏-门顿方程：\n$$\nv([S]; K_M, V_\\text{max}) = \\frac{V_\\text{max}\\,[S]}{K_M + [S]}\n$$\n需要从实验数据 $\\{([S]_i, v_i, \\sigma_i)\\}_{i=1}^{N}$ 中估计的参数是米氏常数 $K_M$ 和最大速率 $V_\\text{max}$。设参数向量为 $\\boldsymbol{\\theta} = [K_M, V_\\text{max}]^\\mathsf{T}$。\n\n估计是通过加权非线性最小二乘法进行的。这涉及找到使卡方目标函数最小化的参数值 $\\hat{\\boldsymbol{\\theta}}$：\n$$\n\\chi^2(\\boldsymbol{\\theta}) = \\sum_{i=1}^{N} \\left(\\frac{v_i - v([S]_i; \\boldsymbol{\\theta})}{\\sigma_i}\\right)^2 = \\sum_{i=1}^{N} w_i \\left(v_i - v([S]_i; \\boldsymbol{\\theta})\\right)^2\n$$\n权重 $w_i = 1/\\sigma_i^2$ 由所提供的测量标准差 $\\sigma_i$ 确定，这正确地优先考虑了测量不确定性较小的数据点。最小化此非线性目标函数需要一个迭代数值算法。在 `scipy.optimize.curve_fit` 库函数中实现的 Levenberg-Marquardt 算法是解决此类问题的鲁棒且广泛使用的选择。为了有效收敛，有必要为参数提供合理的初始猜测值，这可以通过目视检查或对数据进行简单分析得出（例如，用观察到的最大速率近似 $V_\\text{max}$，并找到产生该速率一半时的 $[S]$ 来近似 $K_M$）。\n\n在确定最优参数 $\\hat{\\boldsymbol{\\theta}}$ 后，进行统计分析以量化其不确定性和相关性。假设模型能很好地代表数据，并且测量误差是独立的、服从正态分布，那么参数协方差矩阵 $\\mathbf{C}$ 可以从模型函数的雅可比矩阵中近似得到。雅可比矩阵 $\\mathbf{J}$ 包含模型函数相对于每个参数的偏导数，这些偏导数在每个数据点 $[S]_i$ 和最优参数值 $\\hat{\\boldsymbol{\\theta}}$ 处计算：\n$$\nJ_{ik} = \\frac{\\partial v([S]_i; \\boldsymbol{\\theta})}{\\partial \\theta_k} \\bigg|_{\\boldsymbol{\\theta}=\\hat{\\boldsymbol{\\theta}}}\n$$\n米氏-门顿模型相对于 $\\theta_1 = K_M$ 和 $\\theta_2 = V_\\text{max}$ 的偏导数是：\n$$\n\\frac{\\partial v}{\\partial K_M} = -\\frac{V_\\text{max}\\,[S]}{(K_M + [S])^2}\n$$\n$$\n\\frac{\\partial v}{\\partial V_\\text{max}} = \\frac{[S]}{K_M + [S]}\n$$\n协方差矩阵则由以下公式给出：\n$$\n\\mathbf{C} \\approx \\left(\\mathbf{J}^\\mathsf{T}\\mathbf{W}\\mathbf{J}\\right)^{-1}\n$$\n其中 $\\mathbf{W}$ 是由权重 $w_i$ 构成的对角矩阵。`scipy.optimize.curve_fit` 函数在设置 `absolute_sigma=True` 时，会直接返回此协方差矩阵。\n\n从协方差矩阵 $\\mathbf{C} = \\begin{pmatrix} C_{11} & C_{12} \\\\ C_{21} & C_{22} \\end{pmatrix}$ 中，可以导出几个关键的统计量：\n1.  **标准误差**：参数的标准误差是 $\\mathbf{C}$ 对角元素的平方根。\n    $$\n    \\mathrm{SE}(\\hat{K}_M) = \\sqrt{C_{11}}, \\quad \\mathrm{SE}(\\hat{V}_\\text{max}) = \\sqrt{C_{22}}\n    $$\n2.  **相关系数**：估计参数 $\\hat{K}_M$ 和 $\\hat{V}_\\text{max}$ 之间的相关性计算如下：\n    $$\n    \\rho = \\frac{C_{12}}{\\sqrt{C_{11}C_{22}}}\n    $$\n    接近 $+1$ 或 $-1$ 的 $\\rho$ 值表示强相关性，这可能对参数的可辨识性构成挑战。\n3.  **置信区间**：在置信水平为 $1-\\alpha$ (此处为 $95\\%$，即 $\\alpha=0.05$) 的双侧置信区间是使用学生t分布构建的。自由度为 $\\nu = N - p$，其中 $N$ 是数据点的数量，$p$ 是参数的数量（此处 $p=2$）。参数 $\\hat{\\theta}_k$ 的区间为：\n    $$\n    \\hat{\\theta}_k \\pm t_{1-\\alpha/2, \\nu} \\cdot \\mathrm{SE}(\\hat{\\theta}_k)\n    $$\n    其中 $t_{1-\\alpha/2, \\nu}$ 是t分布的临界值。\n\n该实现将处理所提供的三个测试用例。对于每个用例，它将执行拟合，计算协方差矩阵，并导出所需的统计量。为了满足指定的输出格式要求，实现了一个将所有浮点结果四舍五入到 $6$ 位有效数字的例程。然后，按照要求将最终结果汇总到一个列表的列表中。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\nfrom scipy.stats import t\nimport math\n\ndef round_sig(x, sig=6):\n    \"\"\"\n    Rounds a number to a specified number of significant figures.\n    \"\"\"\n    if x == 0 or not np.isfinite(x):\n        return x\n    return round(x, sig - int(math.floor(math.log10(abs(x)))) - 1)\n\ndef solve():\n    \"\"\"\n    Performs weighted non-linear regression on Michaelis-Menten data for three test cases,\n    computes parameter uncertainties and correlations, and formats the output.\n    \"\"\"\n    \n    # Michaelis-Menten model function\n    def mm_model(S, Km, Vmax):\n        return Vmax * S / (Km + S)\n\n    # Test suite data\n    test_cases = [\n        # Case A: Broad coverage of [S]\n        {\n            'S': np.array([5.0e-6, 1.0e-5, 5.0e-5, 1.0e-4, 2.5e-4, 5.0e-4, 1.0e-3, 2.0e-3]),\n            'v': np.array([2.60e-8, 4.70e-8, 2.08e-7, 3.509e-7, 6.130e-7, 8.088e-7, 9.687e-7, 1.068e-6]),\n            'sigma': np.array([3.0e-9, 3.0e-9, 1.0e-8, 1.5e-8, 2.0e-8, 2.0e-8, 2.0e-8, 2.0e-8])\n        },\n        # Case B: Saturation-dominated\n        {\n            'S': np.array([1.0e-4, 2.0e-4, 4.0e-4, 8.0e-4, 1.6e-3, 3.2e-3]),\n            'v': np.array([4.07e-7, 5.283e-7, 6.480e-7, 7.131e-7, 7.459e-7, 7.8176e-7]),\n            'sigma': np.array([1.5e-8, 1.5e-8, 1.5e-8, 1.5e-8, 1.5e-8, 1.5e-8])\n        },\n        # Case C: Low [S] boundary behavior\n        {\n            'S': np.array([1.0e-8, 5.0e-8, 1.0e-7, 5.0e-7, 1.0e-6, 5.0e-6, 1.0e-5]),\n            'v': np.array([6.008e-10, 2.940e-9, 5.932e-9, 2.747e-8, 4.96e-8, 1.508e-7, 1.995e-7]),\n            'sigma': np.array([5.0e-11, 8.0e-11, 1.0e-10, 5.0e-10, 8.0e-10, 2.0e-9, 3.0e-9])\n        }\n    ]\n\n    all_results = []\n\n    for case_data in test_cases:\n        S = case_data['S']\n        v = case_data['v']\n        sigma = case_data['sigma']\n        \n        # Initial guess for parameters (p0)\n        Vmax_guess = np.max(v)\n        # np.interp requires x-coordinates (v) to be increasing.\n        # Since v is monotonic with S, this should be fine.\n        idx = np.argsort(v)\n        try:\n            Km_guess = np.interp(Vmax_guess / 2.0, v[idx], S[idx])\n        except:\n            # Fallback for degenerate cases\n            Km_guess = np.median(S)\n        \n        p0 = [Km_guess, Vmax_guess]\n        \n        # Perform weighted non-linear least-squares fit\n        popt, pcov = curve_fit(mm_model, S, v, sigma=sigma, p0=p0, absolute_sigma=True, maxfev=10000)\n        \n        Km_fit, Vmax_fit = popt\n        \n        # Calculate standard errors\n        perr = np.sqrt(np.diag(pcov))\n        Km_se, Vmax_se = perr\n        \n        # Calculate correlation coefficient\n        # corr = cov(X,Y) / (std(X)*std(Y))\n        corr = pcov[0, 1] / (Km_se * Vmax_se)\n        \n        # Calculate 95% confidence intervals using Student's t-distribution\n        N = len(S)\n        p = len(popt)\n        dof = N - p\n        alpha = 0.05\n        t_val = t.ppf(1.0 - alpha / 2.0, df=dof)\n        \n        Km_ci_low = Km_fit - t_val * Km_se\n        Km_ci_high = Km_fit + t_val * Km_se\n        \n        Vmax_ci_low = Vmax_fit - t_val * Vmax_se\n        Vmax_ci_high = Vmax_fit + t_val * Vmax_se\n        \n        # Collect and round results to 6 significant figures\n        case_results_raw = [Km_fit, Vmax_fit, corr, Km_ci_low, Km_ci_high, Vmax_ci_low, Vmax_ci_high]\n        case_results_rounded = [round_sig(val, 6) for val in case_results_raw]\n        \n        all_results.append(case_results_rounded)\n\n    # Format the final output string exactly as required\n    outer_parts = [f\"[{','.join(map(str, r))}]\" for r in all_results]\n    final_output = f\"[{','.join(outer_parts)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}