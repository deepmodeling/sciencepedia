{
    "hands_on_practices": [
        {
            "introduction": "Our exploration of the particle in a box model begins by examining how a quantum system responds to an instantaneous change in its boundary conditions. This practice  delves into the \"sudden approximation,\" a cornerstone of time-dependent quantum mechanics. By calculating the probability of finding the particle in a new eigenstate after the box's size is abruptly doubled, you will apply the principles of state projection and superposition, gaining a deeper intuition for the dynamic nature of quantum states.",
            "id": "356867",
            "problem": "A particle of mass $m$ is initially in the ground state of a one-dimensional infinite potential well of width $L$. The potential is described by $V(x) = 0$ for $0 < x < L$ and $V(x) = \\infty$ otherwise. The normalized energy eigenstates for this potential are given by $\\psi_n(x) = \\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi x}{L}\\right)$, where $n=1, 2, 3, \\ldots$.\n\nAt time $t=0$, the potential is altered instantaneously by moving the right wall of the well from $x=L$ to $x=2L$. The new potential is $V'(x) = 0$ for $0 < x < 2L$ and $V'(x) = \\infty$ otherwise. The normalized energy eigenstates for this new, wider well are $\\phi_{n'}(x) = \\sqrt{\\frac{2}{2L}}\\sin\\left(\\frac{n'\\pi x}{2L}\\right)$, where $n' = 1, 2, 3, \\ldots$.\n\nAccording to the sudden approximation, the wavefunction of the particle immediately after the expansion is identical to its state before the expansion. This state can be expressed as a superposition of the new energy eigenstates of the wider well. Derive an expression for the probability of finding the particle in the second excited state ($n'=3$) of the new well.",
            "solution": "We have initial and final eigenstates on $[0,L]$ and $[0,2L]$ respectively:\n$$\\psi_1(x)=\\sqrt{\\frac{2}{L}}\\sin\\!\\Bigl(\\frac{\\pi x}{L}\\Bigr),\\qquad\n\\phi_{n'}(x)=\\sqrt{\\frac{2}{2L}}\\sin\\!\\Bigl(\\frac{n'\\pi x}{2L}\\Bigr)=\\frac{1}{\\sqrt{L}}\\sin\\!\\Bigl(\\frac{n'\\pi x}{2L}\\Bigr).$$\nBy the sudden approximation, the expansion coefficient is\n$$c_{n'}=\\int_0^{2L}\\phi_{n'}(x)\\,\\psi_1(x)\\,dx\n=\\frac{\\sqrt{2}}{L}\\int_0^L\\sin\\!\\Bigl(\\frac{n'\\pi x}{2L}\\Bigr)\\sin\\!\\Bigl(\\frac{\\pi x}{L}\\Bigr)\\,dx.$$\nUsing the identity\n$$\\int_0^L\\sin(Ax)\\sin(Bx)\\,dx\n=\\frac{1}{2}\\Bigl[\\frac{\\sin((A-B)L)}{A-B}-\\frac{\\sin((A+B)L)}{A+B}\\Bigr],$$\nwith $A=\\frac{n'\\pi}{2L},\\;B=\\frac{\\pi}{L}$, for $n'=3$ we get\n$$A-B=\\frac{\\pi}{2L},\\quad A+B=\\frac{5\\pi}{2L},\\quad\n\\sin\\bigl((A-B)L\\bigr)=\\sin\\!\\Bigl(\\frac{\\pi}{2}\\Bigr)=1,\\quad\n\\sin\\bigl((A+B)L\\bigr)=\\sin\\!\\Bigl(\\frac{5\\pi}{2}\\Bigr)=1.$$\nHence\n$$\\int_0^L\\sin\\!\\Bigl(\\frac{3\\pi x}{2L}\\Bigr)\\sin\\!\\Bigl(\\frac{\\pi x}{L}\\Bigr)\\,dx\n=\\frac{1}{2}\\Bigl[\\frac{1}{\\frac{\\pi}{2L}}-\\frac{1}{\\frac{5\\pi}{2L}}\\Bigr]\n=\\frac{4L}{5\\pi}$$\nand\n$$c_3=\\frac{\\sqrt{2}}{L}\\,\\frac{4L}{5\\pi}=\\frac{4\\sqrt2}{5\\pi}.$$\nThe probability of finding the particle in $n'=3$ is\n$$P_{3}=|c_3|^2=\\frac{32}{25\\pi^2}.$$",
            "answer": "$$\\boxed{\\frac{32}{25\\pi^2}}$$"
        },
        {
            "introduction": "Next, we advance from a one-dimensional system to a three-dimensional cubic box, where the symmetry of the potential leads to degenerate energy levels. This exercise  applies first-order degenerate perturbation theory to determine how a weak external potential lifts the degeneracy of the first excited state. This practice is crucial for understanding how subtle asymmetries and external fields influence the energy spectrum of real-world quantum systems, such as atoms in electric or magnetic fields.",
            "id": "357028",
            "problem": "A particle of mass $m$ is confined to a three-dimensional cubic box with side length $L$. The potential energy $V(x,y,z)$ is zero inside the box ($0 < x, y, z < L$) and infinite outside. The unperturbed stationary states are described by the wavefunctions\n$$\n\\psi_{n_x, n_y, n_z}^{(0)}(x, y, z) = \\left(\\frac{2}{L}\\right)^{3/2} \\sin\\left(\\frac{n_x \\pi x}{L}\\right) \\sin\\left(\\frac{n_y \\pi y}{L}\\right) \\sin\\left(\\frac{n_z \\pi z}{L}\\right)\n$$\nwith corresponding energies\n$$\nE_{n_x, n_y, n_z}^{(0)} = \\frac{\\pi^2 \\hbar^2}{2mL^2} (n_x^2 + n_y^2 + n_z^2)\n$$\nwhere $n_x, n_y, n_z$ are positive integers.\n\nThe first excited energy level of this system is three-fold degenerate. The system is now subjected to a weak perturbation described by the potential $V' = \\epsilon z^2$, where $\\epsilon$ is a small constant with appropriate units.\n\nUsing first-order degenerate perturbation theory, derive an expression for the magnitude of the energy splitting, $\\Delta E$, of the first excited state. This splitting is defined as the absolute difference between the highest and lowest corrected energy eigenvalues resulting from the perturbation.",
            "solution": "We use first-order degenerate perturbation theory in the subspace spanned by $|1,1,2\\rangle, |1,2,1\\rangle, |2,1,1\\rangle$, with perturbation $V'=\\epsilon z^2$.  The matrix elements are\n$$W_{ij}=\\epsilon\\int\\psi_i^*(x,y,z)\\,z^2\\,\\psi_j(x,y,z)\\,dV\n=\\epsilon\\,\\delta_{n_{x,i},n_{x,j}}\\;\\delta_{n_{y,i},n_{y,j}}\\;\n\\int_0^L\\bigl|\\psi_{n_{z,i}}(z)\\bigr|^2z^2\\,dz.$$\nSince in the first-excited manifold no two distinct states share both $n_x,n_y$, the off diagonal $W_{ij}$ vanish.  Thus the corrected energies are \n$$E_{n_x,n_y,n_z}=E^{(0)}+\\epsilon\\int|\\psi_{n_z}(z)|^2z^2dz.$$ \nDefine\n$$I_n=\\int_0^Lz^2\\sin^2\\!\\bigl(\\tfrac{n\\pi z}{L}\\bigr)\\,dz\n=\\frac12\\int_0^Lz^2\\,dz-\\frac12\\int_0^Lz^2\\cos\\!\\bigl(\\tfrac{2n\\pi z}{L}\\bigr)\\,dz.$$\nCompute\n$$\\int_0^Lz^2dz=\\frac{L^3}{3},\\quad\n\\int_0^Lz^2\\cos(\\alpha z)dz\n=\\frac{2L}{\\alpha^2},\\quad \\alpha=\\frac{2n\\pi}{L}.$$\nHence\n$$I_n=\\frac{L^3}{6}-\\frac{L^3}{4n^2\\pi^2}\n=L^3\\Bigl(\\frac16-\\frac1{4n^2\\pi^2}\\Bigr).$$\nSince $\\psi_{n_z}(z)^2=(2/L)\\sin^2(n_z\\pi z/L)$,\n$$W_{n_z}=\\epsilon\\frac{2}{L}I_{n_z}\n=\\epsilon L^2\\Bigl(\\frac13-\\frac1{2n_z^2\\pi^2}\\Bigr).$$\nIn the first-excited triplet $n_z=1$ for two states and $n_z=2$ for one.  Hence the splitting is\n$$\\Delta E=\\bigl|W_2-W_1\\bigr|\n=\\epsilon L^2\\Bigl|\\frac13-\\frac1{8\\pi^2}-\\Bigl(\\frac13-\\frac1{2\\pi^2}\\Bigr)\\Bigr|\n=\\frac{3\\epsilon L^2}{8\\pi^2}.$$",
            "answer": "$$\\boxed{\\frac{3\\epsilon L^2}{8\\pi^2}}$$"
        },
        {
            "introduction": "While analytical solutions provide immense insight, most real-world quantum mechanical problems are intractable and require computational methods. This final hands-on practice  guides you through the process of numerically solving the Schrödinger equation for the particle in a box using the finite difference method. By implementing the algorithm and analyzing the convergence of your numerical solution towards the exact analytical result, you will gain practical experience in computational physics and a critical appreciation for the relationship between theoretical models and their numerical approximations.",
            "id": "2960274",
            "problem": "Implement a program that models the one-dimensional infinite potential well (also known as the particle-in-a-box) on the interval $[0,L]$ by discretizing the time-independent Schrödinger equation using a second-order central finite difference approximation of the second derivative with Dirichlet boundary conditions at $x=0$ and $x=L$. From first principles, start from the time-independent Schrödinger equation and the definition of the infinite potential well. Construct the discrete Hamiltonian operator, compute its eigenvalues for a sequence of grid spacings, and compare the computed energy level $E_n$ with the exact continuous solution derived from the underlying differential equation. Quantitatively analyze the discretization error as a function of grid spacing and estimate the convergence rate exponent.\n\nRequirements:\n- Physical model:\n  - The time-independent Schrödinger equation on $[0,L]$ for a particle of mass $m$ in an infinite potential well is to be used as the fundamental starting point. The boundary conditions are $\\psi(0)=0$ and $\\psi(L)=0$.\n  - The continuous energy levels $E_n$ used for reference must be obtained by solving this boundary value problem from first principles, not by invoking any unmotivated shortcut formulas in your reasoning. Your program may use the resulting analytical expression once you have established it in your derivation.\n- Discretization:\n  - Use a uniform grid of $M$ interior points with spacing $h=L/(M+1)$.\n  - Apply the standard second-order central finite difference approximation for the second derivative on the interior points and enforce the Dirichlet boundary conditions implicitly by omitting the boundary nodes from the unknown vector.\n  - Construct the discrete Hamiltonian matrix $H$ corresponding to the kinetic energy operator on the interior nodes.\n- Numerical computation:\n  - For each specified set of parameters, compute the $n$-th discrete energy $E_n^{(h)}$ as the $n$-th eigenvalue (in ascending order) of the discrete Hamiltonian $H$.\n  - Compute the absolute error $|E_n^{(h)}-E_n|$ where $E_n$ is the exact continuous energy for the same $n$, $L$, and $m$.\n  - For each test case, vary the grid spacing $h$ over a list of values by changing $M$, and estimate the exponent $p$ in the empirical relation $|E_n^{(h)}-E_n|\\approx C\\,h^p$ via a least-squares fit of $\\log |E_n^{(h)}-E_n|$ versus $\\log h$. Report the fitted slope $p$.\n- Units:\n  - All calculations must be performed in the International System of Units (SI). Use $L$ in meters, $m$ in kilograms, and energies in joules.\n  - Use the reduced Planck constant value $\\hbar = 1.054571817\\times 10^{-34}\\ \\mathrm{J\\cdot s}$ and the electron mass $m_e=9.1093837015\\times 10^{-31}\\ \\mathrm{kg}$.\n  - When $L$ is specified in nanometers in the test suite, convert using $1\\ \\mathrm{nm}=1.0\\times 10^{-9}\\ \\mathrm{m}$.\n- Output:\n  - Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, e.g., $[r_1,r_2,r_3]$, where each $r_i$ is the fitted slope $p$ for test case $i$, rounded to three decimal places.\n\nTest suite:\n- Use the following cases, each specified as a tuple $\\left(L_{\\mathrm{nm}}, n, [M_1,M_2,M_3,M_4]\\right)$ where $L_{\\mathrm{nm}}$ is in nanometers and must be converted to meters in the computation:\n  - Case $1$: $\\left(1.0,\\,1,\\,[20,\\,40,\\,80,\\,160]\\right)$.\n  - Case $2$: $\\left(0.5,\\,5,\\,[50,\\,100,\\,200,\\,400]\\right)$.\n  - Case $3$: $\\left(2.0,\\,1,\\,[3,\\,6,\\,12,\\,24]\\right)$.\n- For all cases, use $m=m_e$.\n- Final output format:\n  - A single line with the list $[r_1,r_2,r_3]$ of the three fitted slopes, each rounded to three decimal places, with no additional text.",
            "solution": "The problem statement is evaluated and determined to be valid. It presents a standard, well-posed problem in computational quantum mechanics that is scientifically sound, self-contained, and objective. It is free of contradictions or ambiguities. I will therefore proceed with a full derivation and solution.\n\nThe task is to numerically solve the one-dimensional time-independent Schrödinger equation for a particle in an infinite potential well, analyze the discretization error, and determine the empirical order of convergence of the numerical method.\n\n**1. Analytical Solution of the Continuous Problem**\n\nThe first principle is the time-independent Schrödinger equation for a particle of mass $m$ in a potential $V(x)$:\n$$\n\\hat{H}\\psi(x) = \\left[-\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2} + V(x)\\right]\\psi(x) = E\\psi(x)\n$$\nFor an infinite potential well of length $L$, the potential $V(x)$ is defined on the domain $[0, L]$ as:\n$$\nV(x) = \\begin{cases} 0 & \\text{if } 0 < x < L \\\\ \\infty & \\text{otherwise} \\end{cases}\n$$\nThe infinite potential at the boundaries implies that the particle cannot exist outside the interval $(0, L)$. The continuity of the wavefunction $\\psi(x)$ therefore imposes the Dirichlet boundary conditions:\n$$\n\\psi(0) = 0 \\quad \\text{and} \\quad \\psi(L) = 0\n$$\nInside the well, where $V(x)=0$, the Schrödinger equation simplifies to:\n$$\n-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi(x)}{dx^2} = E\\psi(x)\n$$\nThis equation is rearranged into the form of a classical simple harmonic oscillator equation:\n$$\n\\frac{d^2\\psi(x)}{dx^2} + k^2\\psi(x) = 0, \\quad \\text{where } k = \\frac{\\sqrt{2mE}}{\\hbar}\n$$\nThe general solution to this second-order ordinary differential equation is:\n$$\n\\psi(x) = A\\sin(kx) + B\\cos(kx)\n$$\nApplying the first boundary condition, $\\psi(0) = 0$:\n$$\n\\psi(0) = A\\sin(0) + B\\cos(0) = B = 0\n$$\nThus, the solution must be of the form $\\psi(x) = A\\sin(kx)$. Applying the second boundary condition, $\\psi(L) = 0$:\n$$\n\\psi(L) = A\\sin(kL) = 0\n$$\nA non-trivial solution requires $A \\neq 0$, which implies that $\\sin(kL)$ must be zero. This condition is met when $kL$ is an integer multiple of $\\pi$:\n$$\nkL = n\\pi, \\quad \\text{for } n = 1, 2, 3, \\ldots\n$$\nThe quantum number $n$ must be a positive integer, as $n=0$ would lead to $k=0$ and a trivial wavefunction $\\psi(x)=0$. This quantizes the wave number $k_n = \\frac{n\\pi}{L}$. Substituting this into the definition of $k$:\n$$\n\\left(\\frac{n\\pi}{L}\\right)^2 = \\frac{2mE_n}{\\hbar^2}\n$$\nSolving for the energy $E_n$ gives the exact, quantized energy levels for the particle in a one-dimensional infinite potential well:\n$$\nE_n = \\frac{n^2\\pi^2\\hbar^2}{2mL^2}\n$$\nThis analytical expression for $E_n$ will serve as the exact reference against which the numerical results are compared.\n\n**2. Discretization of the Schrödinger Equation**\n\nTo solve the problem numerically, we discretize the spatial domain $[0, L]$ into a uniform grid. We define $M$ interior points, such that the total number of points is $M+2$. The grid spacing is $h = \\frac{L}{M+1}$, and the grid points are $x_i = i \\cdot h$ for $i=0, 1, \\dots, M+1$. The wavefunction at these discrete points is denoted $\\psi_i = \\psi(x_i)$. The boundary conditions are explicitly $\\psi_0=0$ and $\\psi_{M+1}=0$.\n\nThe second derivative operator, $\\frac{d^2}{dx^2}$, is approximated using a second-order central finite difference scheme at each interior point $x_i$:\n$$\n\\left.\\frac{d^2\\psi}{dx^2}\\right|_{x=x_i} \\approx \\frac{\\psi(x_i+h) - 2\\psi(x_i) + \\psi(x_i-h)}{h^2} = \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{h^2}\n$$\nSubstituting this approximation into the Schrödinger equation for an interior point $i$ (where $i=1, \\dots, M$):\n$$\n-\\frac{\\hbar^2}{2m} \\left( \\frac{\\psi_{i-1} - 2\\psi_i + \\psi_{i+1}}{h^2} \\right) = E^{(h)}\\psi_i\n$$\nHere, $E^{(h)}$ denotes the numerical approximation of the energy eigenvalue, which depends on the grid spacing $h$. Rearranging this expression, we get:\n$$\n\\left(-\\frac{\\hbar^2}{2mh^2}\\right)\\psi_{i-1} + \\left(\\frac{\\hbar^2}{mh^2}\\right)\\psi_i + \\left(-\\frac{\\hbar^2}{2mh^2}\\right)\\psi_{i+1} = E^{(h)}\\psi_i\n$$\nThis represents a system of $M$ coupled linear equations for the unknown values $\\psi_1, \\dots, \\psi_M$.\n\n**3. The Discrete Hamiltonian Matrix**\n\nThe system of equations from the discretization can be cast into a matrix eigenvalue problem, $\\mathbf{H}\\vec{\\psi} = E^{(h)}\\vec{\\psi}$. The vector $\\vec{\\psi}$ is $(\\psi_1, \\psi_2, \\dots, \\psi_M)^T$, and $\\mathbf{H}$ is the $M \\times M$ matrix representation of the Hamiltonian operator, known as the discrete Hamiltonian.\n\nLet us define the kinetic energy scaling factor $T = \\frac{\\hbar^2}{2mh^2}$. The equation for each node $i$ becomes:\n$$\n-T\\psi_{i-1} + 2T\\psi_i - T\\psi_{i+1} = E^{(h)}\\psi_i\n$$\nUsing the boundary conditions $\\psi_0 = 0$ and $\\psi_{M+1}=0$, the system for $i=1, \\dots, M$ gives rise to a symmetric tridiagonal matrix $\\mathbf{H}$:\n$$\n\\mathbf{H} = \\begin{pmatrix}\n2T & -T & 0 & \\cdots & 0 \\\\\n-T & 2T & -T & \\cdots & 0 \\\\\n0 & -T & 2T & \\ddots & \\vdots \\\\\n\\vdots & \\vdots & \\ddots & \\ddots & -T \\\\\n0 & 0 & \\cdots & -T & 2T\n\\end{pmatrix}\n$$\nThe eigenvalues of this matrix $\\mathbf{H}$ correspond to the discrete energy levels $E_n^{(h)}$. The $n$-th eigenvalue (sorted in ascending order) is the numerical approximation for the $n$-th energy level, $E_n$.\n\n**4. Convergence Analysis**\n\nThe central difference scheme has a truncation error of order $O(h^2)$. For self-adjoint eigenvalue problems like this, the error in the eigenvalues is predicted to exhibit the same order of convergence. Thus, we expect the absolute error between the numerical and exact energies to scale with the grid spacing $h$ as:\n$$\n|E_n^{(h)} - E_n| \\approx C h^p\n$$\nwhere $p$ is the convergence rate exponent, which we expect to be $2$. To find $p$ empirically, we take the natural logarithm of the error equation:\n$$\n\\ln\\left(|E_n^{(h)} - E_n|\\right) \\approx \\ln(C) + p \\ln(h)\n$$\nThis reveals a linear relationship between $\\ln(\\text{error})$ and $\\ln(h)$. By computing the error for a sequence of decreasing grid spacings $h$ (corresponding to increasing $M$) and performing a linear least-squares fit on the $(\\ln(h), \\ln(\\text{error}))$ data, the slope of the resulting line provides an estimate for $p$. This procedure is implemented in the provided code to satisfy the problem requirements.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D particle-in-a-box problem numerically and analyzes convergence.\n    \"\"\"\n    # Define physical constants in SI units\n    HBAR = 1.054571817e-34  # Reduced Planck constant in J*s\n    M_E = 9.1093837015e-31   # Electron mass in kg\n    NM_TO_M = 1.0e-9         # Nanometer to meter conversion factor\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (L_nm, n, [M_1, M_2, M_3, M_4])\n    test_cases = [\n        (1.0, 1, [20, 40, 80, 160]),\n        (0.5, 5, [50, 100, 200, 400]),\n        (2.0, 1, [3, 6, 12, 24]),\n    ]\n\n    results = []\n    \n    # Process each test case\n    for case in test_cases:\n        L_nm, n, M_list = case\n        \n        # Set parameters for the current case\n        L = L_nm * NM_TO_M  # Convert box length to meters\n        m = M_E             # Set mass to electron mass\n\n        # Calculate the exact analytical energy for level n\n        E_n_exact = (n**2 * np.pi**2 * HBAR**2) / (2 * m * L**2)\n\n        log_h_vals = []\n        log_error_vals = []\n\n        # Iterate over the specified numbers of interior grid points (M)\n        for M in M_list:\n            # Calculate grid spacing h\n            h = L / (M + 1)\n\n            # Construct the discrete Hamiltonian matrix H\n            # T is the kinetic energy scaling factor: hbar^2 / (2*m*h^2)\n            T = HBAR**2 / (2 * m * h**2)\n            \n            # The matrix H has 2T on the main diagonal and -T on the adjacent diagonals\n            main_diag = np.full(M, 2 * T)\n            off_diag = np.full(M - 1, -T)\n            H = np.diag(main_diag) + np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)\n\n            # Compute eigenvalues of the symmetric matrix H.\n            # np.linalg.eigh is efficient and returns sorted eigenvalues.\n            eigenvalues = np.linalg.eigh(H)[0]\n            \n            # The numerical energy E_n is the n-th eigenvalue (0-indexed)\n            E_n_h = eigenvalues[n - 1]\n\n            # Calculate the absolute error and store its logarithm\n            error = np.abs(E_n_h - E_n_exact)\n            log_error_vals.append(np.log(error))\n            \n            # Store the logarithm of the grid spacing\n            log_h_vals.append(np.log(h))\n\n        # Perform a linear least-squares fit on the log-log data.\n        # log(error) = p * log(h) + log(C)\n        # np.polyfit with degree 1 returns the slope (p) and intercept (log(C)).\n        p, _ = np.polyfit(log_h_vals, log_error_vals, 1)\n        results.append(p)\n\n    # Format the results to three decimal places as required.\n    rounded_results = [round(r, 3) for r in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, rounded_results))}]\")\n\nsolve()\n```"
        }
    ]
}