{
    "hands_on_practices": [
        {
            "introduction": "振荡反应的核心在于正反馈（自催化）和负反馈（抑制）之间的精妙竞争。本练习  将带你深入 BZ 反应的心脏，通过分析俄勒冈模型（Oregonator）中的一个关键步骤，来精确确定抑制剂（溴离子）的浓度阈值。通过对自催化中间体浓度趋近于零时的速率方程进行稳定性分析，你将亲手揭示控制反应“开启”或“关闭”的化学开关的奥秘，从而对振荡的根本机制建立起深刻的直觉。",
            "id": "2949141",
            "problem": "在Belousov–Zhabotinsky反应（BZ反应）的最小Field–Noyes Oregonator模型描述中，考虑在抑制剂溴离子 $Y \\equiv [\\text{Br}^-]$ 存在的情况下，自催化中间体亚溴酸($\\text{HBrO}_2$)，记作$X \\equiv [\\text{HBrO}_2]$的动力学。假设酸度恒定，且溴酸盐 $A \\equiv [\\text{BrO}_3^-]$ 因大量过剩而保持有效恒定。以质量作用定律为基本依据，对$X$变化率的三个主要贡献进行建模，如下所示：\n\n- 自催化产生：$HBrO_{2} + BrO_{3}^{-} + H^{+} \\to 2\\,HBrO_{2}$，速率为$k_{a}\\,A\\,X$。\n- 抑制性消除：$HBrO_{2} + Br^{-} + H^{+} \\to \\text{产物}$，速率为$k_{i}\\,X\\,Y$。\n- 终止：$2\\,HBrO_{2} \\to \\text{产物}$，速率为$2\\,k_{t}\\,X^{2}$。\n\n此处，$k_{a}$、$k_{i}$和$k_{t}$是正速率常数，$A$、$X$和$Y$是浓度。在这些假设下，$X$的净变化率为\n$$\n\\frac{dX}{dt} \\;=\\; k_{a}\\,A\\,X \\;-\\; k_{i}\\,X\\,Y \\;-\\; 2\\,k_{t}\\,X^{2}.\n$$\n将“溴离子阈值”$[Br^{-}]_{\\text{crit}}$定义为能使$X$的无穷小扰动不因自催化而增长（即自催化刚好被抑制）的最小抑制剂浓度。仅使用上述模型和质量作用定律，通过在$X \\to 0^{+}$的极限下对$\\frac{dX}{dt}$施加适当条件并求解$Y$，确定$[Br^{-}]_{\\text{crit}}$的显式闭式表达式。\n\n以$k_{a}$、$k_{i}$和$A$的解析表达式表示最终结果。以摩尔浓度报告$[Br^{-}]_{\\text{crit}}$。无需数值近似或四舍五入。",
            "solution": "该问题陈述经评估有效。这是一个在化学动力学领域有科学依据、定义明确且客观的问题，具体涉及Belousov-Zhabotinsky反应简化模型的稳定性分析。\n\n自催化中间体$X \\equiv [\\text{HBrO}_2]$的浓度变化率由以下微分方程给出：\n$$\n\\frac{dX}{dt} = k_{a} A X - k_{i} X Y - 2 k_{t} X^{2}\n$$\n此处，$Y \\equiv [\\text{Br}^-]$是抑制剂的浓度，$A \\equiv [\\text{BrO}_3^-]$是大量过剩的反应物浓度，实际上是一个恒定参数。各项分别对应自催化产生($k_{a} A X$)、抑制性消除($k_{i} X Y$)和自我终止($-2 k_{t} X^{2}$)。所有速率常数$k_{a}$、$k_{i}$和$k_{t}$均为正值。\n\n目标是确定“溴离子阈值”，记作$[Br^{-}]_{\\text{crit}}$。这被定义为能使$X$中的无穷小扰动不增长的最小抑制剂浓度$Y$。这是一个关于系统在极低$X$浓度下的稳定性问题，具体来说是平凡稳态$X = 0$的稳定性。\n\n$X$中的无穷小扰动意味着我们在$X=0$的邻域内分析该系统，即在$X \\to 0^{+}$的极限下。这种扰动“不增长”的条件意味着，如果我们从一个非常小的正浓度$X$开始，其浓度将不会增加。在数学上，这转化为净变化率$\\frac{dX}{dt}$对于$X \\to 0^{+}$必须小于或等于零的条件。\n$$\n\\frac{dX}{dt} \\le 0 \\quad \\text{对于 } X \\to 0^{+}\n$$\n为了分析小$X$时$\\frac{dX}{dt}$的行为，我们可以从速率方程中提出因子$X$：\n$$\n\\frac{dX}{dt} = X (k_{a} A - k_{i} Y - 2 k_{t} X)\n$$\n由于我们考虑的是一个微小但为正的浓度$X$（即$X > 0$），$\\frac{dX}{dt}$的符号由括号中项的符号决定：\n$$\n(k_{a} A - k_{i} Y - 2 k_{t} X)\n$$\n为了使不增长条件$\\frac{dX}{dt} \\le 0$在$X > 0$时成立，我们必须有：\n$$\nk_{a} A - k_{i} Y - 2 k_{t} X \\le 0\n$$\n问题指明分析应针对*无穷小*扰动，这对应于$X$从正方向趋近于零的极限（$X \\to 0^{+}$）。在此极限下，$2 k_{t} X$项消失。因此，支配原点稳定性的不等式变为：\n$$\nk_{a} A - k_{i} Y \\le 0\n$$\n这个不等式定义了抑制剂浓度$Y$所需满足的条件，以确保在$X$的量小到可以忽略时，自催化被抑制。对$Y$进行整理，我们得到：\n$$\nk_{i} Y \\ge k_{a} A\n$$\n由于$k_{i}$是一个正速率常数，我们可以用它来除不等式两边而不改变不等号的方向：\n$$\nY \\ge \\frac{k_{a} A}{k_{i}}\n$$\n这一结果表明，对于任何大于或等于$\\frac{k_{a} A}{k_{i}}$的溴离子浓度$Y$，在$X=0$附近，自催化过程都被抑制。问题要求的是“溴离子阈值”$[Br^{-}]_{\\text{crit}}$，即发生这种抑制的*最小*抑制剂浓度。这对应于不等式的边界情况，此时系统处于增长与衰减之间的临界点。我们通过将不等式设为等式来找到这个阈值：\n$$\nY_{\\text{crit}} = \\frac{k_{a} A}{k_{i}}\n$$\n回顾定义$Y \\equiv [\\text{Br}^-]$，溴离子阈值的最终表达式为：\n$$\n[Br^{-}]_{\\text{crit}} = \\frac{k_{a} A}{k_{i}}\n$$\n该表达式代表了溴离子的临界浓度，在该浓度下，在$\\text{HBrO}_2$浓度为零的极限情况下，$\\text{HBrO}_2$的自催化产生速率与其被溴离子消除的速率完全平衡。低于此阈值，自催化占主导地位，$X$的微小扰动将会增长。高于此阈值，抑制作用占主导地位，微小扰动将会衰减。",
            "answer": "$$\n\\boxed{\\frac{k_{a} A}{k_{i}}}\n$$"
        },
        {
            "introduction": "真实的化学反应网络，如 FKN 机理，通常涉及许多寿命极短、反应活性极高的自由基中间体。为了构建可处理的数学模型（如俄勒冈模型），化学家们广泛使用准稳态近似（QSSA）来简化机理。本练习  要求你对这一关键近似的有效性进行定量检验。你将通过计算一个关键自由基中间体在伪一级反应条件下的寿命，并将其与整个 BZ 反应的宏观振荡周期进行比较，从而亲身体验如何通过数量级的比较来判断模型简化的合理性，这是化学动力学研究中一项至关重要的实践技能。",
            "id": "2949235",
            "problem": "在铈催化的Belousov-Zhabotinsky (BZ)反应中，Field-Kőrös-Noyes (FKN)机理包含快速的自由基中间体，这些中间体通常通过准稳态近似 (QSSA) 被消去。考虑将二氧化溴自由基 $\\mathrm{BrO_2\\cdot}$ 作为代表性的自由基中间体。在酸性水溶液条件下，两个得到实验充分支持的自由基消耗途径占主导地位：\n- $\\mathrm{BrO_2\\cdot} + \\mathrm{Br^{-}} \\rightarrow \\text{产物}$，其二级速率常数为 $k_{\\mathrm{Br}} = 1.0 \\times 10^{9}\\ \\mathrm{M^{-1}\\ s^{-1}}$，\n- $\\mathrm{BrO_2\\cdot} + \\mathrm{Ce^{3+}} \\rightarrow \\text{产物}$，其二级速率常数为 $k_{\\mathrm{Ce}} = 5.0 \\times 10^{7}\\ \\mathrm{M^{-1}\\ s^{-1}}$。\n\n在 $\\left[\\mathrm{BrO_2\\cdot}\\right]$ 发生微小扰动后的自由基弛豫期间，清除剂的浓度在自由基的时间尺度上实际上是恒定的。设一次振荡中的最小溴离子浓度为 $\\left[\\mathrm{Br^{-}}\\right]_{\\min} = 1.0 \\times 10^{-4}\\ \\mathrm{M}$，铈(III)浓度为 $\\left[\\mathrm{Ce^{3+}}\\right] = 1.0 \\times 10^{-3}\\ \\mathrm{M}$。在这些条件下，宏观BZ反应的振荡周期为 $T_{\\mathrm{osc}} = 60\\ \\mathrm{s}$。\n\n仅从质量作用定律和一级衰减动力学出发，推导在相对于 $\\mathrm{Br^{-}}$ 和 $\\mathrm{Ce^{3+}}$ 的准一级条件下，$\\mathrm{BrO_2\\cdot}$ 的有效寿命 $\\tau_{\\mathrm{rad}}$ 的表达式。然后计算无量纲比率 $\\varepsilon = \\tau_{\\mathrm{rad}}/T_{\\mathrm{osc}}$。将 $\\varepsilon$ 的最终答案表示为一个四舍五入到三位有效数字的纯数。",
            "solution": "合适的出发点是将质量作用定律应用于基元自由基消耗步骤。令 $\\left[R\\right] \\equiv \\left[\\mathrm{BrO_2\\cdot}\\right]$，$\\left[B\\right] \\equiv \\left[\\mathrm{Br^{-}}\\right]$，以及 $\\left[C\\right] \\equiv \\left[\\mathrm{Ce^{3+}}\\right]$。两个主要的消耗反应是：\n- $R + B \\xrightarrow{k_{\\mathrm{Br}}} \\text{产物}$，\n- $R + C \\xrightarrow{k_{\\mathrm{Ce}}} \\text{产物}$。\n\n在 $\\left[B\\right]$ 和 $\\left[C\\right]$ 的浓度于 $\\left[R\\right]$ 的微小扰动衰减期间近似恒定的条件下，$\\left[R\\right]$ 的变化率为\n$$\n\\frac{d\\left[R\\right]}{dt} = -k_{\\mathrm{Br}} \\left[B\\right]\\left[R\\right] - k_{\\mathrm{Ce}} \\left[C\\right]\\left[R\\right].\n$$\n这可以写成具有一个有效准一级速率常数 $k_{\\mathrm{eff}}$ 的一级衰减：\n$$\n\\frac{d\\left[R\\right]}{dt} = -k_{\\mathrm{eff}} \\left[R\\right], \\quad \\text{其中} \\quad k_{\\mathrm{eff}} = k_{\\mathrm{Br}}\\left[B\\right] + k_{\\mathrm{Ce}}\\left[C\\right].\n$$\n这个线性微分方程的解是一个指数衰减，\n$$\n\\left[R\\right](t) = \\left[R\\right](0)\\,\\exp\\!\\left(-k_{\\mathrm{eff}} t\\right),\n$$\n所以自由基的特征寿命 $\\tau_{\\mathrm{rad}}$ 是 $k_{\\mathrm{eff}}$ 的倒数：\n$$\n\\tau_{\\mathrm{rad}} = \\frac{1}{k_{\\mathrm{eff}}} = \\frac{1}{k_{\\mathrm{Br}}\\left[B\\right] + k_{\\mathrm{Ce}}\\left[C\\right]}.\n$$\n代入给定值：\n- $k_{\\mathrm{Br}} = 1.0 \\times 10^{9}\\ \\mathrm{M^{-1}\\ s^{-1}}$,\n- $\\left[B\\right] = \\left[\\mathrm{Br^{-}}\\right]_{\\min} = 1.0 \\times 10^{-4}\\ \\mathrm{M}$,\n- $k_{\\mathrm{Ce}} = 5.0 \\times 10^{7}\\ \\mathrm{M^{-1}\\ s^{-1}}$,\n- $\\left[C\\right] = \\left[\\mathrm{Ce^{3+}}\\right] = 1.0 \\times 10^{-3}\\ \\mathrm{M}$.\n\n计算 $k_{\\mathrm{eff}}$：\n$$\nk_{\\mathrm{eff}} = \\left(1.0 \\times 10^{9}\\right)\\left(1.0 \\times 10^{-4}\\right) + \\left(5.0 \\times 10^{7}\\right)\\left(1.0 \\times 10^{-3}\\right) \\ \\mathrm{s^{-1}} = \\left(1.0 \\times 10^{5} + 5.0 \\times 10^{4}\\right)\\ \\mathrm{s^{-1}} = 1.5 \\times 10^{5}\\ \\mathrm{s^{-1}}.\n$$\n因此，\n$$\n\\tau_{\\mathrm{rad}} = \\frac{1}{1.5 \\times 10^{5}\\ \\mathrm{s^{-1}}} = 6.666\\ldots \\times 10^{-6}\\ \\mathrm{s}.\n$$\n使用振荡周期 $T_{\\mathrm{osc}} = 60\\ \\mathrm{s}$ 构建无量纲比率：\n$$\n\\varepsilon = \\frac{\\tau_{\\mathrm{rad}}}{T_{\\mathrm{osc}}} = \\frac{6.666\\ldots \\times 10^{-6}\\ \\mathrm{s}}{60\\ \\mathrm{s}} = 1.111\\ldots \\times 10^{-7}.\n$$\n四舍五入到三位有效数字，结果是\n$$\n\\varepsilon = 1.11 \\times 10^{-7}.\n$$\n这个极小的比率定量地支持了在BZ振荡的时间尺度上对 $\\mathrm{BrO_2\\cdot}$ 使用准稳态近似（QSSA）进行消去的有效性，因为自由基的弛豫速度比宏观振荡周期快许多个数量级。",
            "answer": "$$\\boxed{1.11 \\times 10^{-7}}$$"
        },
        {
            "introduction": "BZ 反应最引人注目的特征莫过于其在空间中形成的各种奇妙图案，如行波和螺旋波。这些复杂的时空结构源于局部化学反应与物质扩散过程的相互作用。本练习  提供了一个通过计算模拟来探索这些现象的完整蓝图，将理论知识转化为可操作的“计算实验”。你将基于反应-扩散方程构建一个光敏 BZ 介质模型，并学习如何利用外部控制（如结构光照）来“书写”和“擦除”化学波，从而深入理解简单规则如何涌现出复杂的宏观行为。",
            "id": "2949245",
            "problem": "设计并实现一个完整、可运行的程序，该程序形式化一个协议，使用空间结构化光照在光敏 Belousov-Zhabotinsky (BZ) 反应中写入和擦除空间化学图案，并使用反应-扩散模型预测由此产生的波前。您的实现必须从质量守恒和反应-扩散输运的基本定律出发，为光敏 BZ 介质构建一个双变量最小模型。该程序必须在一个具有周期性边界的二维方形域上模拟动力学，并为一小组测试写入和擦除的光照协议计算指定的量化指标。\n\n该物理系统是一个可激发介质，包含一种激活剂和一种抑制剂，其行为受反应动力学（源自简化为双变量最小形式的 Field-Körös-Noyes 机制）和扩散的支配。光照提供了一个局部的溴化物源，从而光抑制激发。使用无量纲的变量和参数，因此不需要进行物理单位转换；所有结果均以纯数形式报告。假设二维域为方形，其边长由整数网格表示。\n\n您的程序必须执行以下操作。\n\n- 通过两个标量场来表示化学状态：激活剂 $u(x,y,t)$ 和抑制剂/催化剂 $v(x,y,t)$。这两个场在反应项和扩散项的作用下演化。反应项源自与光敏 BZ 反应的 Oregonator 简化相符的质量作用动力学，扩散项为 $\\nabla^2 u$ 和 $\\nabla^2 v$，其扩散系数为常数。光照由一个非负标量场 $\\phi(x,y,t)$ 表示，它会增加有效的局部溴化物源，从而抑制激发。\n- 使用大小为 $N \\times N$ 的方形网格，其中 $N = 64$，空间步长 $\\Delta x = 1$，并采用周期性边界条件。使用显式时间步进格式，时间步长 $\\Delta t = 0.02$。\n- 使用以下无量纲动力学和输运参数，这些参数使介质在低光照下处于可激发状态，在高光照下处于不可激发状态：$\\varepsilon = 0.20$, $f = 1.40$, $q = 0.002$, $D_u = 0.20$, 以及 $D_v = 0.10$。\n- 将场初始化为与存在光照 $\\phi$ 时的动力学一致的空间均匀稳态，然后通过将一个小圆盘内的 $u$ 值设为高值来叠加一个局域的“种子”激发，以触发波的发射。在施加种子之前，您可以通过设置 $u = q$ 和 $v = q$ 来近似该均匀稳态。\n- 实现以下三种光照协议（即测试套件）。在每种情况下，种子都是一个以域中心 $(x\\_0,y\\_0) = (N/2,N/2)$ 为中心、半径为 $r\\_0 = 3$ 的圆盘，圆盘内部的初始激活剂值为 $u = 0.90$，其他地方的值保持不变。所有情况都使用相同的 $\\Delta t$ 和 $\\Delta x$。总模拟步数和光照图案因具体情况而异，详见下文。\n\n测试套件：\n\n- 情况 A（写入受限条带引导波并估算轴向波前速度）：\n  - 光照图案：一个宽度为 $w = 6$ 个网格点、以 $x = N/2$ 为中心的垂直“暗”条带，其中 $\\phi = \\phi\\_{\\mathrm{dark}} = 0.005$；该条带嵌入在 $\\phi = \\phi\\_{\\mathrm{bright}} = 0.070$ 的“亮”背景中。\n  - 总模拟步数：$T\\_{\\mathrm{A}} = 400$。\n  - 指标：按如下方式估算沿条带中线列 $x = N/2$ 的轴向波前速度。设波前阈值为 $\\theta\\_u = 0.30$。对于每个时间 $t\\_k = k \\,\\Delta t$，其中 $k \\in \\{k\\_1,\\dots,k\\_2\\}$，$t\\_{1} = 2.00$，$t\\_{2} = 8.00$（因此 $k\\_1 = 100$，$k\\_2 = 400$），计算中心列上满足 $u(N/2,y,t\\_k) > \\theta\\_u$ 的任意行 $y$ 与中线行 $y\\_0 = N/2$ 之间的最大轴向距离。在指定时间区间内，对该最大距离与时间进行最小二乘线性拟合，并报告拟合的斜率作为速度（一个浮点数）。\n- 情况 B（通过全局增亮进行擦除并报告淬灭成功与否）：\n  - 光照图案：在时间 $t < t\\_{\\mathrm{switch}}$ 时，采用均匀“暗”光照 $\\phi = \\phi\\_{\\mathrm{dark}} = 0.005$；在时间 $t \\ge t\\_{\\mathrm{switch}}$ 时，采用均匀“亮”光照 $\\phi = \\phi\\_{\\mathrm{erase}} = 0.080$。其中 $t\\_{\\mathrm{switch}} = 4.00$。\n  - 总模拟步数：$T\\_{\\mathrm{B}} = 600$。\n  - 指标：在最终时刻，计算激活剂场的空间平均值 $\\overline{u}$，并报告一个布尔值，指示 $\\overline{u} < \\theta\\_{\\mathrm{erase}}$ 是否成立。其中 $\\theta\\_{\\mathrm{erase}} = 0.10$。\n- 情况 C（边界情况：均匀明亮，无传播）：\n  - 光照图案：在所有时间，均采用均匀的“亮”光照 $\\phi = \\phi\\_{\\mathrm{bright}} = 0.080$。\n  - 总模拟步数：$T\\_{\\mathrm{C}} = 200$。\n  - 指标：在最终时刻，统计满足 $u > \\theta\\_u$ 的网格点数量，并将此计数报告为整数。\n\n计算要求和检查：\n\n- 对拉普拉斯算子使用五点差分格式，并采用周期性边界。确保显式时间步长满足标准扩散稳定性判据 $\\Delta t < \\Delta x^2/(4 \\max\\{D_u,D_v\\})$；给定的数值满足此界限。\n- 所有变量和参数均为无量纲；因此不需要物理单位转换或单位报告。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 [情况 A 的速度（浮点数），情况 B 的布尔值，情况 C 的整数]。例如，一个有效的输出格式是 $[\\text{float},\\text{boolean},\\text{integer}]$，无空格。\n\n您的实现必须是一个完整、独立、无需外部输入的程序。它必须为三种情况构建光照场，模拟动力学，计算三个指标，并以精确指定的格式打印汇总结果。",
            "solution": "该问题要求设计并实现一个在二维域上对光敏 Belousov-Zhabotinsky (BZ) 反应进行的数值模拟。这个问题在科学上是适定的，为完整的解决方案提供了所有必要的参数和规范。任务的核心是求解一个反应-扩散偏微分方程组 (PDEs)，并为三种不同的光照协议计算指定的指标。\n\n**1. 数学模型**\n\n系统由两个状态变量描述：激活剂浓度 $u(x,y,t)$ 和抑制剂浓度 $v(x,y,t)$。它们的演化由一个双变量 Oregonator 模型控制，该模型是完整的 Field-Körös-Noyes (FKN) 机制的简化版本，并经过修改以包含光敏性。控制偏微分方程组为：\n$$\n\\frac{\\partial u}{\\partial t} = \\frac{1}{\\varepsilon} \\left( u(1-u) - fv \\frac{u-q}{u+q} \\right) + D_u \\nabla^2 u\n$$\n$$\n\\frac{\\partial v}{\\partial t} = u - v + \\phi(x,y,t) + D_v \\nabla^2 v\n$$\n此处，$u$是激活剂（类似于$\\mathrm{HBrO_2}$），$v$是抑制剂（与氧化态催化剂 $\\mathrm{ferriin}$ 相关）。参数 $\\varepsilon$、$f$ 和 $q$ 是决定局部动力学的动力学常数。$D_u \\nabla^2 u$ 和 $D_v \\nabla^2 v$ 项代表菲克扩散，其扩散系数 $D_u$ 和 $D_v$ 为常数。标量场 $\\phi(x,y,t)$ 代表在空间和时间上结构化的光照，它通过光化学反应生成溴离子（一种抑制剂），因此在抑制剂方程中充当源项，并抑制波的激发。所有变量和参数均为无量纲。\n\n给定的参数为：\n- 动力学参数：$\\varepsilon = 0.20$, $f = 1.40$, $q = 0.002$。\n- 扩散系数：$D_u = 0.20$, $D_v = 0.10$。\n\n**2. 数值离散化**\n\n连续的偏微分方程组在一个方形网格上进行离散化，并随时间进行积分。\n\n- **空间离散化**：连续域被一个 $N \\times N$ 的网格替代，其中 $N = 64$，空间步长 $\\Delta x = 1$。拉普拉斯算子 $\\nabla^2$ 使用二阶五点有限差分格式进行近似：\n$$\n(\\nabla^2 \\psi)_{i,j} \\approx \\frac{\\psi_{i,j+1} + \\psi_{i,j-1} + \\psi_{i+1,j} + \\psi_{i-1,j} - 4\\psi_{i,j}}{(\\Delta x)^2}\n$$\n其中 $\\psi$ 可以是 $u$ 或 $v$，$ (i,j) $ 是网格索引。应用周期性边界条件，意味着索引按模 $N$ 处理。\n\n- **时间离散化**：使用显式前向欧拉法进行时间积分，时间步长为 $\\Delta t = 0.02$。时间步 $k+1$ 处的状态变量由其在时间步 $k$ 处的值计算如下：\n$$\nu^{k+1}_{i,j} = u^k_{i,j} + \\Delta t \\left[ \\frac{1}{\\varepsilon} \\left( u^k_{i,j}(1-u^k_{i,j}) - fv^k_{i,j} \\frac{u^k_{i,j}-q}{u^k_{i,j}+q} \\right) + D_u (\\nabla^2 u)^k_{i,j} \\right]\n$$\n$$\nv^{k+1}_{i,j} = v^k_{i,j} + \\Delta t \\left[ u^k_{i,j} - v^k_{i,j} + \\phi^k_{i,j} + D_v (\\nabla^2 v)^k_{i,j} \\right]\n$$\n所选的时间步长 $\\Delta t = 0.02$ 满足扩散部分的 Courant-Friedrichs-Lewy (CFL) 稳定性条件 $\\Delta t < (\\Delta x)^2 / (4 \\max\\{D_u, D_v\\})$，因为 $0.02 < 1^2 / (4 \\times 0.20) = 1.25$。\n\n**3. 测试用例的实现**\n\n对于所有情况，模拟都从一个近似的均匀稳态 $u=q$ 和 $v=q$ 开始。然后通过施加一个种子来引发一个波：在一个半径为 $r_0=3$ 的中心圆盘内，将激活剂设置为 $u=0.90$。\n\n- **情况 A：写入并测量速度**\n  - **光照**：将一个宽度为 $w=6$ 的低光照（$\\phi_{\\mathrm{dark}} = 0.005$）垂直通道“写入”到一个高强度抑制性光照（$\\phi_{\\mathrm{bright}} = 0.070$）的背景中。\n  - **模拟**：系统演化 $T_A = 400$ 步（每步 $\\Delta t=0.02$）。\n  - **指标**：估算沿通道中线 ($x=N/2$) 的波前轴向速度。对于从 $k_1=100$ ($t=2.0$) 到 $k_2=400$ ($t=8.0$) 的每个时间步 $k$，我们找到沿 $y$ 轴从域中心到一个满足 $u > \\theta_u=0.30$ 的点的最大距离。对这些距离与时间进行最小二乘线性拟合，得到的直线斜率即为波速。\n\n- **情况 B：擦除并测试淬灭效果**\n  - **光照**：域开始时采用均匀的低光照（$\\phi_{\\mathrm{dark}} = 0.005$），使波能从种子处向外传播。在时间 $t_{\\mathrm{switch}} = 4.0$（步数 $k=200$）时，光照全局切换为高的“擦除”值（$\\phi_{\\mathrm{erase}} = 0.080$）。\n  - **模拟**：系统总共演化 $T_B = 600$ 步。\n  - **指标**：在最终时刻评估淬灭是否成功。如果激活剂的空间平均值 $\\overline{u}$ 低于阈值 $\\theta_{\\mathrm{erase}} = 0.10$，则淬灭成功（返回 `True`），否则失败（返回 `False`）。\n\n- **情况 C：边界情况（无传播）**\n  - **光照**：在整个模拟过程中，对域施加均匀的高光照（$\\phi_{\\mathrm{bright}} = 0.080$）。预计此光照水平会抑制从初始种子引发的任何波传播。\n  - **模拟**：系统演化 $T_C = 200$ 步。\n  - **指标**：在最终时刻，我们统计激活剂浓度 $u$ 仍高于阈值 $\\theta_u = 0.30$ 的网格点数量。这个数量衡量了初始激发被淬灭的程度。\n\n该实现将此逻辑封装到一个单一程序中，该程序运行所有三种情况，并以指定格式报告计算出的指标。实现的核心是用于反应-扩散系统的数值求解器，然后在每个测试用例的特定条件下应用该求解器。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates a photosensitive Belousov-Zhabotinsky (BZ) reaction\n    under three different illumination protocols and computes specified metrics.\n    \"\"\"\n    \n    # --- Global Parameters ---\n    N = 64\n    DX = 1.0\n    DT = 0.02\n    \n    # Kinetic and transport parameters\n    EPS = 0.20\n    F = 1.40\n    Q = 0.002\n    DU = 0.20\n    DV = 0.10\n\n    # Initial condition parameters\n    R0 = 3\n    U_SEED = 0.90\n    CENTER_X, CENTER_Y = N // 2, N // 2\n\n    # --- Helper Functions ---\n\n    def get_initial_state():\n        \"\"\"Initializes the activator (u) and inhibitor (v) fields.\"\"\"\n        u = np.full((N, N), Q, dtype=np.float64)\n        v = np.full((N, N), Q, dtype=np.float64)\n        \n        y_coords, x_coords = np.mgrid[0:N, 0:N]\n        dist_sq = (x_coords - CENTER_X)**2 + (y_coords - CENTER_Y)**2\n        seed_mask = dist_sq < R0**2\n        u[seed_mask] = U_SEED\n        \n        return u, v\n\n    def compute_laplacian(field):\n        \"\"\"Computes the 2D Laplacian with periodic boundary conditions.\"\"\"\n        return (np.roll(field, 1, axis=0) + np.roll(field, -1, axis=0) +\n                np.roll(field, 1, axis=1) + np.roll(field, -1, axis=1) - 4 * field) / (DX**2)\n\n    def integration_step(u, v, phi):\n        \"\"\"Performs one forward Euler step.\"\"\"\n        lap_u = compute_laplacian(u)\n        lap_v = compute_laplacian(v)\n\n        reaction_u = (1 / EPS) * (u * (1 - u) - F * v * (u - Q) / (u + Q))\n        reaction_v = u - v\n\n        u_new = u + DT * (reaction_u + DU * lap_u)\n        v_new = v + DT * (reaction_v + phi + DV * lap_v)\n        \n        return u_new, v_new\n\n    # --- Test Case Implementations ---\n\n    def run_case_a():\n        \"\"\"Case A: Write a confined stripe-guided wave and estimate axial front speed.\"\"\"\n        \n        # Parameters\n        T_STEPS = 400\n        PHI_DARK = 0.005\n        PHI_BRIGHT = 0.070\n        W = 6.0\n        THETA_U = 0.30\n        K1 = int(2.00 / DT)\n        K2 = int(8.00 / DT)\n        \n        # Setup illumination field\n        _, x_coords = np.mgrid[0:N, 0:N]\n        phi = np.full((N, N), PHI_BRIGHT, dtype=np.float64)\n        stripe_mask = np.abs(x_coords - CENTER_X) < W / 2\n        phi[stripe_mask] = PHI_DARK\n\n        # Setup simulation\n        u, v = get_initial_state()\n        times, distances = [], []\n\n        # Run simulation\n        for k in range(1, T_STEPS + 1):\n            u, v = integration_step(u, v, phi)\n            \n            if k >= K1 and k <= K2:\n                center_col_u = u[:, CENTER_X]\n                above_threshold_rows = np.where(center_col_u > THETA_U)[0]\n                \n                if above_threshold_rows.size > 0:\n                    max_dist = np.max(np.abs(above_threshold_rows - CENTER_Y)) * DX\n                else:\n                    max_dist = 0.0\n                \n                times.append(k * DT)\n                distances.append(max_dist)\n        \n        # Calculate metric\n        if not times or len(times) < 2:\n            return 0.0\n\n        p = np.polyfit(times, distances, 1)\n        speed = p[0]\n        \n        return float(speed)\n\n    def run_case_b():\n        \"\"\"Case B: Erase by global brightening and report quenching success.\"\"\"\n\n        # Parameters\n        T_STEPS = 600\n        T_SWITCH = 4.00\n        K_SWITCH = int(T_SWITCH / DT)\n        PHI_DARK = 0.005\n        PHI_ERASE = 0.080\n        THETA_ERASE = 0.10\n\n        # Setup simulation\n        u, v = get_initial_state()\n\n        # Run simulation\n        for k in range(1, T_STEPS + 1):\n            if k * DT < T_SWITCH:\n                phi_val = PHI_DARK\n            else:\n                phi_val = PHI_ERASE\n            phi = np.full((N, N), phi_val, dtype=np.float64)\n            u, v = integration_step(u, v, phi)\n        \n        # Calculate metric\n        mean_u = np.mean(u)\n        \n        return bool(mean_u < THETA_ERASE)\n\n    def run_case_c():\n        \"\"\"Case C: Uniformly bright, no propagation.\"\"\"\n        \n        # Parameters\n        T_STEPS = 200\n        PHI_BRIGHT = 0.080\n        THETA_U = 0.30\n        \n        # Setup illumination\n        phi = np.full((N, N), PHI_BRIGHT, dtype=np.float64)\n\n        # Setup simulation\n        u, v = get_initial_state()\n\n        # Run simulation\n        for _ in range(T_STEPS):\n            u, v = integration_step(u, v, phi)\n            \n        # Calculate metric\n        count = np.sum(u > THETA_U)\n        \n        return int(count)\n\n    # --- Main Execution ---\n    results = [\n        run_case_a(),\n        run_case_b(),\n        run_case_c()\n    ]\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\n\nsolve()\n\n```"
        }
    ]
}