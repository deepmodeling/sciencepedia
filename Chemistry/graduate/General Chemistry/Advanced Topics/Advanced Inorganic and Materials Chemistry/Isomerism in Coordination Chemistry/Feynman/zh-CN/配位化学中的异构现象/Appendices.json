{
    "hands_on_practices": [
        {
            "introduction": "掌握配位化学的第一步是系统地识别和计数所有可能的异构体。这个练习将挑战你的空间推理能力，通过在一个八面体配合物 $[\\mathrm{M}(\\mathrm{AA})_{2}\\mathrm{X}\\mathrm{Y}]$ 中确定几何异构体和光学异构体，来深化你对配位几何和手性起源的理解。",
            "id": "2942826",
            "problem": "一个八面体金属配合物 $[\\mathrm{M}(\\mathrm{AA})_{2}\\mathrm{X}\\mathrm{Y}]$ 包含两个相同的二齿螯合配体 $\\mathrm{AA}$（假设 $\\mathrm{AA}$ 是一个具有等效配位原子的对称二齿螯合物，例如乙二胺，并且每个 $\\mathrm{AA}$ 必须占据两个相邻的，即顺式的，配位点）和两个不同的单齿配体 $\\mathrm{X}$ 和 $\\mathrm{Y}$。仅使用几何异构（配体在空间中相对排布不同，且不发生化学键断裂就不能相互转化）和旋光异构（互为镜像但不能重合的形式；手性要求分子没有任何瑕对称元素，如镜像面、反演中心或瑕旋转轴）的核心定义，以及一个公认的结构限制，即在八面体场中单个二齿螯合物必须占据两个相邻的位置（从不占据反式位置），分析八面体几何构型所允许的所有不同空间排布。\n\n从第一性原理出发推导：\n- 不同几何异构体的数量（计算顺式/反式异构体，以及任何通过保持配体身份不变的正常旋转无法相互转化的不等价顺式排布），以及\n- 每种几何异构体是否具有手性（即，它是否以一对不能重合的镜像体形式存在）。\n\n令 $S$ 表示立体异构体的总数（对映异构体分开计数），令 $C$ 表示手性立体异构体的数量（即对映异构体对的成员）。以有序对 $(S,C)$ 的形式报告你的结果。将最终的有序对表示为一个行矩阵，并且不包含单位。无需四舍五入。",
            "solution": "问题陈述是配位化学领域一个提法恰当的问题，具体涉及立体异构现象。它有科学依据、客观，并提供了从第一性原理推导出唯一答案所需的所有信息。该问题是有效的。\n\n该配合物的形式为 $[\\mathrm{M}(\\mathrm{AA})_{2}\\mathrm{X}\\mathrm{Y}]$，其配位几何构型为八面体。$\\mathrm{M}$ 是中心金属原子。$\\mathrm{AA}$ 是一个在两个相邻（顺式）位置上发生螯合的对称二齿配体。$\\mathrm{X}$ 和 $\\mathrm{Y}$ 是不同的单齿配体。我们必须确定立体异构体的总数 $S$ 和手性立体异构体的数量 $C$。\n\n一个八面体配合物有六个配位点。我们可以用数字 $1$ 到 $6$ 来标记这些位点。设位点 $1$ 为顶点（$+z$ 轴），位点 $6$ 为底点（$-z$ 轴），位点 $2, 3, 4, 5$ 为赤道位置（例如，分别为 $+x, +y, -x, -y$ 轴）。成对的反式（相对）位置是 $(1, 6)$、$(2, 4)$ 和 $(3, 5)$。所有其他相邻对都是顺式的。\n\n根据单齿配体 $\\mathrm{X}$ 和 $\\mathrm{Y}$ 的相对位置，分析可以分为两种情况。\n\n情况1：配体 $\\mathrm{X}$ 和 $\\mathrm{Y}$ 相互处于反式位置。\n不失一般性，我们将配体 $\\mathrm{X}$ 置于位点 $1$，配体 $\\mathrm{Y}$ 置于位点 $6$。剩下的四个赤道位点 $\\{2, 3, 4, 5\\}$ 必须被两个二齿配体 $(\\mathrm{AA})_{2}$ 占据。由于每个 $\\mathrm{AA}$ 配体必须占据两个顺式位置，因此在四个共面位点上安排两个此类配体的唯一方法是让一个配体占据位点 $(2, 3)$，另一个占据位点 $(4, 5)$。（另一种选择，$(3,4)$ 和 $(5,2)$，通过旋转是等同的）。这为反式情况定义了一个单一的几何异构体。\n\n现在，我们必须确定这种异构体是否具有手性。如果一个分子拥有瑕旋转轴（$S_n$），包括反演中心（$S_2 = i$）或对称面（$S_1 = \\sigma$），那么它就是非手性的。我们来考察这种反式异构体的对称性：$\\mathrm{X}$ 在位点 $1$，$\\mathrm{Y}$ 在位点 $6$，一个 $\\mathrm{AA}$ 配体在 $(2,3)$，第二个 $\\mathrm{AA}$ 在 $(4,5)$。\n考虑一个包含中心原子 $\\mathrm{M}$、配体 $\\mathrm{X}$ 和 $\\mathrm{Y}$ 并平分两个螯合环的对称面。该平面穿过位点 $1$ 和 $6$。在赤道平面中，它平分角 $\\angle 2\\mathrm{M}5$ 和角 $\\angle 3\\mathrm{M}4$。该平面将位点 $2$ 反射到位点 $5$，将位点 $3$ 反射到位点 $4$。\n连接位点 $(2,3)$ 的第一个螯合环被反射为位点 $(5,4)$ 之间的连接。这恰好是第二个螯合环的位置。\n连接位点 $(4,5)$ 的第二个螯合环被反射为位点 $(3,2)$ 之间的连接。这对应于第一个螯合环。\n配体 $\\mathrm{X}$ 和 $\\mathrm{Y}$ 位于该平面上，并被反射到自身。\n由于整个分子通过此反射操作变换为其自身，因此该平面是一个对称面（$\\sigma$）。镜像面的存在使分子成为非手性的。\n因此，对于反式排布，存在 $1$ 种几何异构体，且它是非手性的。\n此情况下的立体异构体数量：$1$。\n此情况下的手性立体异构体数量：$0$。\n\n情况2：配体 $\\mathrm{X}$ 和 $\\mathrm{Y}$ 相互处于顺式位置。\n不失一般性，设配体 $\\mathrm{X}$ 在位点 $1$，配体 $\\mathrm{Y}$ 在位点 $2$。剩下的四个位点 $\\{3, 4, 5, 6\\}$ 必须被两个二齿配体 $(\\mathrm{AA})_{2}$ 占据。我们必须从这个集合中找出不相交的顺式位点对。\n从 $\\{3, 4, 5, 6\\}$ 中可用的顺式对有：$(3,4)$、$(3,6)$、$(4,5)$、$(4,6)$ 和 $(5,6)$。对 $(3,5)$ 是反式的。\n我们需要从此列表中选择两个不相交的对。\n可能性 A：我们选择对 $(3,4)$。剩下的位点是 $\\{5,6\\}$，它们是顺式的。所以，一种排布螯合物的方式是 AA 在 $(3,4)$ 且 AA 在 $(5,6)$。\n可能性 B：我们选择对 $(3,6)$。剩下的位点是 $\\{4,5\\}$，它们是顺式的。所以，第二种方式是 AA 在 $(3,6)$ 且 AA 在 $(4,5)$。\n让我们检查其他起点。如果我们从 $(4,5)$ 开始，剩下的是 $\\{3,6\\}$，得到可能性 B。如果我们从 $(4,6)$ 开始，剩下的是 $\\{3,5\\}$，这是一个反式对，所以这不是一个有效的排布。如果我们从 $(5,6)$ 开始，剩下的是 $\\{3,4\\}$，得到可能性 A。\n因此，当 X 和 Y 处于顺式位置时，恰好有两种不同的方式来排布两个 AA 配体。这代表了两种不同的几何异构体。\n\n顺式异构体-A：$\\mathrm{X}(1), \\mathrm{Y}(2), \\mathrm{AA}_1(3,4), \\mathrm{AA}_2(5,6)$。\n顺式异构体-B：$\\mathrm{X}(1), \\mathrm{Y}(2), \\mathrm{AA}_1(3,6), \\mathrm{AA}_2(4,5)$。\n这两种异构体不能通过旋转相互转化，因为螯合环的连接方式不同。例如，在顺式异构体-A中，位点 $3$ 的原子与位点 $4$ 的原子螯合，而在顺式异构体-B中，它与位点 $6$ 的原子螯合。\n\n接下来，我们评估这两种几何异构体的手性。\n一个配合物要具有手性，它必须不具有任何 $S_n$ 轴。由于 $\\mathrm{X}$ 和 $\\mathrm{Y}$ 的独特性质以及螯合物的复杂排布，顺式-A和顺式-B两种排布都是高度不对称的。\n让我们分析顺式异构体-A：$\\mathrm{X}(1), \\mathrm{Y}(2), \\mathrm{AA}_1(3,4), \\mathrm{AA}_2(5,6)$。\n没有反演中心（例如，位点 $1$ 的 $\\mathrm{X}$ 与位点 $6$ 的一个 $\\mathrm{A}$ 原子处于反式位置；位点 $2$ 的 $\\mathrm{Y}$ 与位点 $4$ 的一个 $\\mathrm{A}$ 原子处于反式位置）。没有旋转对称轴。没有镜像面。例如，包含 $(1,6,3,5)$ 的平面不是镜像面，因为它会将 $\\mathrm{Y}(2)$ 反射到位点 $4$，而该位点被一个 $\\mathrm{A}$ 原子占据。\n没有任何 $S_n$ 轴意味着点群是 $C_1$。因此，顺式异构体-A是手性的，并且必须以一对不能重合的镜像体（对映异构体）的形式存在。\n\n同样，对于顺式异构体-B：$\\mathrm{X}(1), \\mathrm{Y}(2), \\mathrm{AA}_1(3,6), \\mathrm{AA}_2(4,5)$。\n这种排布也缺乏任何反演中心、旋转轴或镜像面。它属于 $C_1$ 点群，因此是手性的。它也以一个对映异构体对的形式存在。\n这两种几何异构体顺式-A和顺式-B互为非对映异构体。每一种都具有手性，存在一对对映异构体。\n\n总结来说，对于顺式情况：存在 $2$ 种几何异构体，且两者都具有手性。\n此情况下的立体异构体数量：$2$ (来自顺式-A对) $+ 2$ (来自顺式-B对) $= 4$。\n此情况下的手性立体异构体数量：$4$。\n\n总数：\n立体异构体的总数 $S$ 是两种情况的立体异构体数量之和。\n$S = 1$ (来自反式非手性异构体) $+ 4$ (来自顺式手性对) $= 5$。\n手性立体异构体的总数 $C$ 是那些以对映异构体对形式存在的异构体。\n$C = 0$ (来自反式非手性异构体) $+ 4$ (来自顺式手性对) $= 4$。\n\n结果为有序对 $(S, C)$。\n$(S, C) = (5, 4)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5 & 4\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "异构体的概念不仅仅是理论上的，它与可测量的化学性质直接相关。本练习将引导你运用 Alfred Werner 的经典分析方法，通过简单的沉淀反应数据来区分水合异构体，从而深刻体会内界配体与外界抗衡离子在化学行为上的根本差异。",
            "id": "2942859",
            "problem": "硝酸银水溶液只能检测到外界的氯阴离子，因为在低温、快速的条件下，银离子与自由氯离子形成微溶的固体氯化银，而不会引发配体取代反应。考虑通式为 $\\left[\\mathrm{CrCl}_{x}\\left(\\mathrm{H}_{2}\\mathrm{O}\\right)_{6-x}\\right]\\mathrm{Cl}_{3-x}$ 的一类Werner型水合铬(III)异构体，其中$\\mathrm{Cr}$是铬(III)，$\\mathrm{Cl}^{-}$是氯离子，$\\mathrm{H}_{2}\\mathrm{O}$是水。在冰浴中与过量 $\\mathrm{Ag}^{+}$ 立即反应沉淀的条件下，每个化学式单元中只有外界的 $\\left(3-x\\right)$ 个氯阴离子以 $1{:}1$ 的化学计量关系沉淀为 $\\mathrm{AgCl}$。\n\n从氧化态、配位层、电荷平衡和沉淀化学计量关系等基本定义出发，推导每摩尔配合物沉淀的 $\\mathrm{AgCl}$ 摩尔数，该摩尔数是 $x \\in \\{0,1,2,3\\}$ 的函数。然后，使用以下实验数据来确定一个未知异构体的 $x$ 值。\n\n一位化学家对同一种水合异构体盐进行了两次氯离子沉淀实验：\n\n- 在 $0\\,^{\\circ}\\mathrm{C}$ 下立即沉淀，从一份样品中得到干燥的 $\\mathrm{AgCl}$ 质量为 $m_{1}=0.9568\\ \\mathrm{g}$。\n- 从同样大小的一份样品中，在（通过与过量 $\\mathrm{AgNO}_{3}$ 长时间回流）氯离子完全释放后进行完全沉淀，得到干燥的 $\\mathrm{AgCl}$ 质量为 $m_{2}=1.4352\\ \\mathrm{g}$。\n\n假设 $\\mathrm{Ag}^{+}$ 与自由 $\\mathrm{Cl}^{-}$ 之间为理想的 $1{:}1$ 化学计量关系，共沉淀可忽略不计，并且两份样品含有相同摩尔数的配合物。你可以假设在两个实验中 $\\mathrm{AgCl}$ 的摩尔质量相同，因此摩尔比等于质量比。请以 $x$ 的整数值作为最终答案。无需进行舍入，因为根据给定的数据可以精确确定其值。最终答案请勿包含单位。",
            "solution": "问题陈述具有科学依据且表述清晰，可以进行严谨的定量分析。我们直接开始推导。\n\n该系列水合铬(III)异构体的通式为 $\\left[\\mathrm{CrCl}_{x}\\left(\\mathrm{H}_{2}\\mathrm{O}\\right)_{6-x}\\right]\\mathrm{Cl}_{3-x}$。我们必须首先理解由基本化学原理决定的结构和化学计量关系。\n\n$1$. 中心金属离子是处于 $+3$ 氧化态的铬，记作 $\\mathrm{Cr}^{3+}$。\n$2$. 配位层（也称内界），用方括号括起，包含中心离子及其直接键合的配体。配位数为 $6$，由总共六个配体满足：$x$ 个氯离子（$\\mathrm{Cl}^{-}$）和 $(6-x)$ 个水分子（$\\mathrm{H}_{2}\\mathrm{O}$）。\n$3$. 配位配合物的电荷是其各组成部分电荷的总和。氯配体的电荷为 $-1$，水配体为中性（$0$）。因此，配合物阳离子的电荷为：\n$$ \\text{Charge}_{\\text{complex}} = (\\text{charge of } \\mathrm{Cr}) + x \\times (\\text{charge of } \\mathrm{Cl}^{-}) + (6-x) \\times (\\text{charge of } \\mathrm{H}_{2}\\mathrm{O}) $$\n$$ \\text{Charge}_{\\text{complex}} = (+3) + x(-1) + (6-x)(0) = 3 - x $$\n所以，内界是一个阳离子，其化学式为 $\\left[\\mathrm{CrCl}_{x}\\left(\\mathrm{H}_{2}\\mathrm{O}\\right)_{6-x}\\right]^{(3-x)+}$。\n\n$4$. 整个化合物是电中性的。配合物阳离子的正电荷必须由等量的反离子（即外界的氯阴离子）所带的负电荷来平衡。要平衡 $+(3-x)$ 的电荷，必须有 $(3-x)$ 个外界氯阴离子。这证实了所给通式的有效性。\n\n该问题描述了两个实验。设 $n_{\\text{complex}}$ 为每份相同样品中所用异构体的摩尔数。\n\n实验 1：在 $0\\,^{\\circ}\\mathrm{C}$ 下与过量的硝酸银（$\\mathrm{AgNO}_{3}$）水溶液立即反应沉淀。\n在这些条件下，只有自由的、处于外界的氯离子能与银离子（$\\mathrm{Ag}^{+}$）反应，形成沉淀物氯化银（$\\mathrm{AgCl}$）。\n外界氯离子的摩尔数为：\n$$ n_{\\mathrm{Cl, outer}} = n_{\\text{complex}} \\times (3-x) $$\n沉淀反应为 $\\mathrm{Ag}^{+} + \\mathrm{Cl}^{-} \\rightarrow \\mathrm{AgCl}(s)$，该反应按 $1{:}1$ 的摩尔比进行。因此，生成的 $\\mathrm{AgCl}$ 摩尔数 $n_{1}$ 等于外界氯离子的摩尔数。\n$$ n_{1} = n_{\\mathrm{Cl, outer}} = n_{\\text{complex}} \\times (3-x) $$\n此沉淀的质量为 $m_{1} = n_{1} \\times M_{\\mathrm{AgCl}}$，其中 $M_{\\mathrm{AgCl}}$ 是 $\\mathrm{AgCl}$ 的摩尔质量。\n$$ m_{1} = n_{\\text{complex}} \\times (3-x) \\times M_{\\mathrm{AgCl}} $$\n\n实验 2：在所有氯离子完全释放后进行完全沉淀。\n在这种情况下，化合物中所有的氯离子——包括 $x$ 个内界配体和 $(3-x)$ 个外界反离子——均可用于沉淀。每个化学式单元中的氯离子总数为 $x + (3-x) = 3$。\n样品中氯离子的总摩尔数为：\n$$ n_{\\mathrm{Cl, total}} = n_{\\text{complex}} \\times 3 $$\n生成的 $\\mathrm{AgCl}$ 摩尔数 $n_{2}$ 等于氯离子的总摩尔数。\n$$ n_{2} = n_{\\mathrm{Cl, total}} = n_{\\text{complex}} \\times 3 $$\n第二次沉淀的质量为 $m_{2} = n_{2} \\times M_{\\mathrm{AgCl}}$。\n$$ m_{2} = n_{\\text{complex}} \\times 3 \\times M_{\\mathrm{AgCl}} $$\n\n为了确定 $x$ 的值，我们构建两个质量 $m_{1}$ 和 $m_{2}$ 的比值。这种方法的优点在于可以消去未知量 $n_{\\text{complex}}$ 和 $M_{\\mathrm{AgCl}}$。\n$$ \\frac{m_{1}}{m_{2}} = \\frac{n_{\\text{complex}} \\times (3-x) \\times M_{\\mathrm{AgCl}}}{n_{\\text{complex}} \\times 3 \\times M_{\\mathrm{AgCl}}} $$\n消去公因子 $n_{\\text{complex}}$ 和 $M_{\\mathrm{AgCl}}$，我们得到质量比与 $x$ 之间的直接关系：\n$$ \\frac{m_{1}}{m_{2}} = \\frac{3-x}{3} $$\n实验数据给出的质量为 $m_{1} = 0.9568\\ \\mathrm{g}$ 和 $m_{2} = 1.4352\\ \\mathrm{g}$。我们将这些值代入方程。\n$$ \\frac{0.9568}{1.4352} = \\frac{3-x}{3} $$\n我们计算质量的比值：\n$$ \\frac{0.9568}{1.4352} = \\frac{2}{3} $$\n计算结果是精确的，这表明该问题是基于整数关系构建的。\n现在我们将理论比值与实验比值相等：\n$$ \\frac{2}{3} = \\frac{3-x}{3} $$\n两边同乘以 $3$ 得：\n$$ 2 = 3-x $$\n解出 $x$ 可得：\n$$ x = 3 - 2 = 1 $$\n$x$ 的值为 $1$。整数 $x$ 必须属于集合 $\\{0, 1, 2, 3\\}$，事实也确实如此。这对应于化学式为 $\\left[\\mathrm{CrCl}\\left(\\mathrm{H}_{2}\\mathrm{O}\\right)_{5}\\right]\\mathrm{Cl}_{2}$ 的配合物异构体。该异构体有 $1$ 个内界氯配体和 $2$ 个外界氯反离子，这与观测到的质量比 $\\frac{m_{1}}{m_{2}} = \\frac{3-1}{3} = \\frac{2}{3}$ 相符。\n每摩尔配合物沉淀的 $\\mathrm{AgCl}$ 摩尔数是 $x$ 的函数，为 $(3-x)$。当 $x=0$ 时，为 $3$；当 $x=1$ 时，为 $2$；当 $x=2$ 时，为 $1$；当 $x=3$ 时，为 $0$。我们的实验结果对应于立即沉淀时每摩尔配合物生成 $2$ 摩尔 $\\mathrm{AgCl}$ 的情况。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "在现代化学研究中，计算化学是预测和解释异构体相对稳定性的关键工具。这个实践练习将让你扮演计算化学家的角色，设计一个简化的密度泛函理论 (DFT) 流程，来量化硝基 (nitro) 和亚硝酸根 (nitrito) 连锁异构体之间的能量差异，体验如何结合理论计算与模型验证来解决复杂的化学问题。",
            "id": "2942837",
            "problem": "要求您将一个用于排列钴(III)配合物 $\\left[\\mathrm{Co}(\\mathrm{NH_3})_5\\mathrm{NO}_2\\right]^{2+}$ 键合异构体（特别是硝基（N-键合）和亚硝酸根（O-键合）形式）的原则性方案，形式化为一个确定性程序。该方案是一个简化的、受密度泛函理论(DFT)启发的元方案（meta-protocol），它整合了多方法电子能量、隐式溶剂校正和振动频率验证。需要预测的核心量是亚硝酸根和硝基异构体之间的相对吉布斯自由能差，\n$$\n\\Delta G_{\\mathrm{nitrito - nitro}} = G(\\mathrm{nitrito}) - G(\\mathrm{nitro}) \\quad \\text{in } \\mathrm{kJ\\,mol^{-1}},\n$$\n其符号约定为：正的 $\\Delta G$ 表示硝基异构体在热力学上更优，负的 $\\Delta G$ 表示亚硝酸根异构体更优。您的任务是实现以下基于核心定义和广泛使用的建模步骤的方案。\n\n需要实现的基础和建模规则：\n- 从以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位的各方法气相相对电子能量 $\\Delta E_m^{\\mathrm{gas}}$ 开始，其中对于方法 $m$，\n$$\n\\Delta E_m^{\\mathrm{gas}} = E_m^{\\mathrm{gas}}(\\mathrm{nitrito}) - E_m^{\\mathrm{gas}}(\\mathrm{nitro}).\n$$\n- 通过将方法预测的标记振动频率与实验目标标记进行比较，来整合振动频率验证。对于每种方法 $m$，提供一个频率标度因子 $s_m$，预测的频率 $\\nu_{m,k}^{\\mathrm{pred}}$ 通过以下方式进行标度：\n$$\n\\nu_{m,k}^{\\mathrm{scaled}} = s_m \\,\\nu_{m,k}^{\\mathrm{pred}},\n$$\n然后再进行比较。聚合两种异构体标记的偏差。设 $\\{\\nu_{k}^{\\mathrm{exp},\\,\\mathrm{nitro}}\\}$ 和 $\\{\\nu_{k}^{\\mathrm{exp},\\,\\mathrm{nitrito}}\\}$ 为实验标记，$\\{\\nu_{m,k}^{\\mathrm{pred},\\,\\mathrm{nitro}}\\}$ 和 $\\{\\nu_{m,k}^{\\mathrm{pred},\\,\\mathrm{nitrito}}\\}$ 为相应的方法预测值。将方法 $m$ 的均方根偏差 (RMSD) 定义为\n$$\nd_m = \\sqrt{\\frac{1}{K_{\\mathrm{tot}}}\\left(\\sum_{k}\\left(\\nu_{m,k}^{\\mathrm{scaled},\\,\\mathrm{nitro}} - \\nu_{k}^{\\mathrm{exp},\\,\\mathrm{nitro}}\\right)^2 + \\sum_{k}\\left(\\nu_{m,k}^{\\mathrm{scaled},\\,\\mathrm{nitrito}} - \\nu_{k}^{\\mathrm{exp},\\,\\mathrm{nitrito}}\\right)^2\\right)},\n$$\n其中 $K_{\\mathrm{tot}}$ 是两种异构体的标记频率总数，所有频率单位均为 $\\mathrm{cm^{-1}}$。\n- 使用指数核将 $d_m$ 转换为一个非负的频率可信度权重\n$$\nw_m = \\exp(-\\alpha\\, d_m),\n$$\n其中 $\\alpha$ 是一个以 $\\mathrm{(cm^{-1})^{-1}}$ 为单位的正值常量。将经过振动验证的方法系综气相相对电子能量计算为加权归一化平均值\n$$\n\\Delta E^{\\mathrm{gas}}_{\\mathrm{ens}} = \\frac{\\sum_m w_m \\,\\Delta E_m^{\\mathrm{gas}}}{\\sum_m w_m}.\n$$\n- 加上提供的微分隐式溶剂校正（对于所选溶剂模型，每个测试案例一个值）和提供的在 $T = 298.15\\,\\mathrm{K}$ 下的微分热校正，以获得最终预测的相对吉布斯自由能差：\n$$\n\\Delta G_{\\mathrm{nitrito - nitro}} = \\Delta E^{\\mathrm{gas}}_{\\mathrm{ens}} + \\Delta\\Delta G_{\\mathrm{solv}} + \\Delta\\Delta G_{\\mathrm{therm}},\n$$\n其中 $\\Delta\\Delta G_{\\mathrm{solv}} = G_{\\mathrm{solv}}(\\mathrm{nitrito}) - G_{\\mathrm{solv}}(\\mathrm{nitro})$ 且 $\\Delta\\Delta G_{\\mathrm{therm}} = G_{\\mathrm{therm}}(\\mathrm{nitrito}) - G_{\\mathrm{therm}}(\\mathrm{nitro})$，所有能量单位均为 $\\mathrm{kJ\\,mol^{-1}}$。\n- 决策规则（胜者代码）：使用一个以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位的公差 $\\tau$，根据 $\\Delta G_{\\mathrm{nitrito - nitro}}$ 的符号和大小，以整数代码报告更优的异构体：\n    - 如果 $\\Delta G_{\\mathrm{nitrito - nitro}} > \\tau$，返回代码 $0$（硝基异构体更优）。\n    - 如果 $\\Delta G_{\\mathrm{nitrito - nitro}} < -\\tau$，返回代码 $1$（亚硝酸根异构体更优）。\n    - 如果 $\\left|\\Delta G_{\\mathrm{nitrito - nitro}}\\right| \\le \\tau$，返回代码 $2$（在公差范围内近简并）。\n\n所有能量必须以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位处理，所有频率以 $\\mathrm{cm^{-1}}$ 为单位处理，温度固定在 $T = 298.15\\,\\mathrm{K}$。此问题不涉及角度。\n\n需要实现的测试套件和参数：\n- 所有案例通用的全局输入：\n    - 方法和频率标度因子：$\\{(\\text{B3LYP}, s_{\\mathrm{B3LYP}}), (\\text{PBE0}, s_{\\mathrm{PBE0}}), (\\text{M06-L}, s_{\\mathrm{M06-L}})\\}$，其中 $s_{\\mathrm{B3LYP}} = 0.97$，$s_{\\mathrm{PBE0}} = 0.98$，$s_{\\mathrm{M06-L}} = 0.96$。\n    - 实验标记频率：\n        - 硝基：$\\nu^{\\mathrm{exp},\\,\\mathrm{nitro}} = [1460, 1315]$，单位 $\\mathrm{cm^{-1}}$。\n        - 亚硝酸根：$\\nu^{\\mathrm{exp},\\,\\mathrm{nitrito}} = [1465, 1020]$，单位 $\\mathrm{cm^{-1}}$。\n    - 各方法预测的标记频率（未标度，单位 $\\mathrm{cm^{-1}}$）：\n        - B3LYP：硝基 $[1510, 1350]$，亚硝酸根 $[1508, 1045]$。\n        - PBE0：硝基 $[1492, 1344]$，亚硝酸根 $[1498, 1030]$。\n        - M06-L：硝基 $[1520, 1360]$，亚硝酸根 $[1515, 1050]$。\n    - 指数权重因子：$\\alpha = 0.01\\,\\mathrm{(cm^{-1})^{-1}}$。\n    - 决策公差：$\\tau = 0.05\\,\\mathrm{kJ\\,mol^{-1}}$。\n- 提供四个测试案例，每个案例由各方法的气相相对电子能量向量 $\\Delta E_m^{\\mathrm{gas}}$（单位 $\\mathrm{kJ\\,mol^{-1}}$）、微分隐式溶剂校正 $\\Delta\\Delta G_{\\mathrm{solv}}$（单位 $\\mathrm{kJ\\,mol^{-1}}$）和微分热校正 $\\Delta\\Delta G_{\\mathrm{therm}}$（单位 $\\mathrm{kJ\\,mol^{-1}}$）指定：\n    1. 案例 A（类水溶剂，“理想路径”）：$\\Delta E^{\\mathrm{gas}} = [6.5,\\, 7.8,\\, 4.1]$，$\\Delta\\Delta G_{\\mathrm{solv}} = 3.2$，$\\Delta\\Delta G_{\\mathrm{therm}} = 0.3$。\n    2. 案例 B（类乙腈溶剂，气相略微偏好亚硝酸根异构体，但溶剂使硝基异构体稳定）：$\\Delta E^{\\mathrm{gas}} = [-1.5,\\, -0.8,\\, -2.1]$，$\\Delta\\Delta G_{\\mathrm{solv}} = 4.9$，$\\Delta\\Delta G_{\\mathrm{therm}} = 0.2$。\n    3. 案例 C（气相近简并，校正可忽略，边界条件）：$\\Delta E^{\\mathrm{gas}} = [0.2,\\, -0.1,\\, 0.0]$，$\\Delta\\Delta G_{\\mathrm{solv}} = 0.0$，$\\Delta\\Delta G_{\\mathrm{therm}} = 0.0$。\n    4. 案例 D（气相强烈偏好亚硝酸根异构体，溶剂效应弱）：$\\Delta E^{\\mathrm{gas}} = [-8.2,\\, -6.4,\\, -7.1]$，$\\Delta\\Delta G_{\\mathrm{solv}} = 1.0$，$\\Delta\\Delta G_{\\mathrm{therm}} = -0.2$。\n\n编程任务：\n- 为每个测试案例精确实现上述方案。\n- 对于每个案例，计算 $\\Delta G_{\\mathrm{nitrito - nitro}}$（单位 $\\mathrm{kJ\\,mol^{-1}}$，四舍五入到三位小数）以及定义的胜者代码。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试案例贡献一个形式为 $[\\Delta G, \\text{winner\\_code}]$ 的双元素列表。例如，四个案例的有效输出格式为\n\"[[-1.234,1],[5.678,0],[0.012,2],[...]]\"。",
            "solution": "首先，将对问题陈述进行严格的验证过程。\n\n### 步骤 1：提取给定信息\n提供了以下量、定义和数据：\n- 目标量是亚硝酸根和硝基异构体之间的相对吉布斯自由能差：$\\Delta G_{\\mathrm{nitrito - nitro}} = G(\\mathrm{nitrito}) - G(\\mathrm{nitro})$，单位为 $\\mathrm{kJ\\,mol^{-1}}$。\n- 方法 $m$ 的气相相对电子能量：$\\Delta E_m^{\\mathrm{gas}} = E_m^{\\mathrm{gas}}(\\mathrm{nitrito}) - E_m^{\\mathrm{gas}}(\\mathrm{nitro})$，单位为 $\\mathrm{kJ\\,mol^{-1}}$。\n- 标度振动频率的公式：$\\nu_{m,k}^{\\mathrm{scaled}} = s_m \\,\\nu_{m,k}^{\\mathrm{pred}}$。\n- 方法 $m$ 频率的均方根偏差 (RMSD) 公式：\n$$\nd_m = \\sqrt{\\frac{1}{K_{\\mathrm{tot}}}\\left(\\sum_{k}\\left(\\nu_{m,k}^{\\mathrm{scaled},\\,\\mathrm{nitro}} - \\nu_{k}^{\\mathrm{exp},\\,\\mathrm{nitro}}\\right)^2 + \\sum_{k}\\left(\\nu_{m,k}^{\\mathrm{scaled},\\,\\mathrm{nitrito}} - \\nu_{k}^{\\mathrm{exp},\\,\\mathrm{nitrito}}\\right)^2\\right)}\n$$\n- 方法 $m$ 的频率可信度权重公式：$w_m = \\exp(-\\alpha\\, d_m)$。\n- 系综平均气相相对电子能量的公式：\n$$\n\\Delta E^{\\mathrm{gas}}_{\\mathrm{ens}} = \\frac{\\sum_m w_m \\,\\Delta E_m^{\\mathrm{gas}}}{\\sum_m w_m}\n$$\n- 最终预测的相对吉布斯自由能差的公式：\n$$\n\\Delta G_{\\mathrm{nitrito - nitro}} = \\Delta E^{\\mathrm{gas}}_{\\mathrm{ens}} + \\Delta\\Delta G_{\\mathrm{solv}} + \\Delta\\Delta G_{\\mathrm{therm}}\n$$\n其中 $\\Delta\\Delta G_{\\mathrm{solv}} = G_{\\mathrm{solv}}(\\mathrm{nitrito}) - G_{\\mathrm{solv}}(\\mathrm{nitro})$ 且 $\\Delta\\Delta G_{\\mathrm{therm}} = G_{\\mathrm{therm}}(\\mathrm{nitrito}) - G_{\\mathrm{therm}}(\\mathrm{nitro})$。\n- 基于公差 $\\tau$ 的胜者代码决策规则：\n    - 如果 $\\Delta G_{\\mathrm{nitrito - nitro}} > \\tau$，返回代码 $0$。\n    - 如果 $\\Delta G_{\\mathrm{nitrito - nitro}} < -\\tau$，返回代码 $1$。\n    - 如果 $|\\Delta G_{\\mathrm{nitrito - nitro}}| \\le \\tau$，返回代码 $2$。\n- 全局参数：\n    - 方法和标度因子 $\\{(\\text{B3LYP}, 0.97), (\\text{PBE0}, 0.98), (\\text{M06-L}, 0.96)\\}$。\n    - 实验标记频率，单位 $\\mathrm{cm^{-1}}$：$\\nu^{\\mathrm{exp},\\,\\mathrm{nitro}} = [1460, 1315]$，$\\nu^{\\mathrm{exp},\\,\\mathrm{nitrito}} = [1465, 1020]$。\n    - 预测的标记频率，单位 $\\mathrm{cm^{-1}}$：\n        - B3LYP：硝基 $[1510, 1350]$，亚硝酸根 $[1508, 1045]$。\n        - PBE0：硝基 $[1492, 1344]$，亚硝酸根 $[1498, 1030]$。\n        - M06-L：硝基 $[1520, 1360]$，亚硝酸根 $[1515, 1050]$。\n    - 指数权重因子：$\\alpha = 0.01\\,\\mathrm{(cm^{-1})^{-1}}$。\n    - 决策公差：$\\tau = 0.05\\,\\mathrm{kJ\\,mol^{-1}}$。\n    - 温度：$T = 298.15\\,\\mathrm{K}$。\n- 测试案例数据（所有能量单位为 $\\mathrm{kJ\\,mol^{-1}}$）：\n    1. 案例 A：$\\Delta E^{\\mathrm{gas}} = [6.5, 7.8, 4.1]$，$\\Delta\\Delta G_{\\mathrm{solv}} = 3.2$，$\\Delta\\Delta G_{\\mathrm{therm}} = 0.3$。\n    2. 案例 B：$\\Delta E^{\\mathrm{gas}} = [-1.5, -0.8, -2.1]$，$\\Delta\\Delta G_{\\mathrm{solv}} = 4.9$，$\\Delta\\Delta G_{\\mathrm{therm}} = 0.2$。\n    3. 案例 C：$\\Delta E^{\\mathrm{gas}} = [0.2, -0.1, 0.0]$，$\\Delta\\Delta G_{\\mathrm{solv}} = 0.0$，$\\Delta\\Delta G_{\\mathrm{therm}} = 0.0$。\n    4. 案例 D：$\\Delta E^{\\mathrm{gas}} = [-8.2, -6.4, -7.1]$，$\\Delta\\Delta G_{\\mathrm{solv}} = 1.0$，$\\Delta\\Delta G_{\\mathrm{therm}} = -0.2$。\n\n### 步骤 2：使用提取的给定信息进行验证\n对问题陈述的有效性进行审查。\n- **科学依据**：所描述的方案是计算量子化学现代实践的一个简化但概念上合理的表述。使用密度泛函理论(DFT)方法、频率标度因子、隐式溶剂模型和吉布斯自由能的热校正，是研究化学体系的标准方法。基于计算的自由能差对异构体进行排序是这类方法的主要应用之一。该问题具有科学依据。\n- **良构性**：该问题提供了一个具有完整输入集的确定性算法。每一步都是一个明确定义的数学运算，导致每个测试案例都有唯一的解。该结构保证了结果的存在性和唯一性。\n- **客观性**：语言是精确和定量的。所有定义都以数学公式给出。没有主观或基于意见的陈述。\n- **完整性与一致性**：所有需要的数据和参数（$\\Delta E_m^{\\mathrm{gas}}$、频率、标度因子、$\\alpha$、$\\tau$ 等）都已提供。没有缺失值或相互矛盾的约束。整个问题描述中的单位是一致的。\n- **可行性**：能量和频率的数值对于配位配合物和DFT计算是现实的。该方案在计算上易于实现。\n\n### 步骤 3：结论与行动\n该问题被认定为是**有效的**。它是一个自洽、科学合理且良构的计算任务。我将继续进行完整解答。\n\n### 解题方案\n通过系统地、一步一步地执行指定的方案来构建解决方案。\n\n**第 1 部分：计算特定于方法的权重**\n权重 $w_m$ 仅依赖于全局参数，因此只需计算一次。标记频率的总数是 $K_{\\mathrm{tot}} = 2 + 2 = 4$。\n\n对于每种方法 $m \\in \\{\\text{B3LYP}, \\text{PBE0}, \\text{M06-L}\\}$：\n1.  计算标度后的预测频率 $\\nu_{m,k}^{\\mathrm{scaled}} = s_m \\nu_{m,k}^{\\mathrm{pred}}$。\n2.  计算所有 $K_{\\mathrm{tot}}$ 个标记的平方误差和 (SSE)。\n3.  计算 RMSD $d_m = \\sqrt{\\mathrm{SSE} / K_{\\mathrm{tot}}}$。\n4.  计算权重 $w_m = \\exp(-\\alpha d_m)$，其中 $\\alpha = 0.01\\,\\mathrm{(cm^{-1})}^{-1}$。\n\n- **方法：B3LYP** ($s_m=0.97$)\n  - $\\nu^{\\mathrm{scaled},\\,\\mathrm{nitro}} = [0.97 \\times 1510, 0.97 \\times 1350] = [1464.7, 1309.5]$\n  - $\\nu^{\\mathrm{scaled},\\,\\mathrm{nitrito}} = [0.97 \\times 1508, 0.97 \\times 1045] = [1462.76, 1013.65]$\n  - $\\mathrm{SSE}_{\\mathrm{B3LYP}} = (1464.7-1460)^2 + (1309.5-1315)^2 + (1462.76-1465)^2 + (1013.65-1020)^2 \\approx 97.68$\n  - $d_{\\mathrm{B3LYP}} = \\sqrt{97.68 / 4} \\approx 4.9417\\,\\mathrm{cm^{-1}}$\n  - $w_{\\mathrm{B3LYP}} = \\exp(-0.01 \\times 4.9417) \\approx 0.95178$\n\n- **方法：PBE0** ($s_m=0.98$)\n  - $\\nu^{\\mathrm{scaled},\\,\\mathrm{nitro}} = [0.98 \\times 1492, 0.98 \\times 1344] = [1462.16, 1317.12]$\n  - $\\nu^{\\mathrm{scaled},\\,\\mathrm{nitrito}} = [0.98 \\times 1498, 0.98 \\times 1030] = [1468.04, 1009.4]$\n  - $\\mathrm{SSE}_{\\mathrm{PBE0}} = (1462.16-1460)^2 + (1317.12-1315)^2 + (1468.04-1465)^2 + (1009.4-1020)^2 \\approx 130.76$\n  - $d_{\\mathrm{PBE0}} = \\sqrt{130.76 / 4} \\approx 5.7175\\,\\mathrm{cm^{-1}}$\n  - $w_{\\mathrm{PBE0}} = \\exp(-0.01 \\times 5.7175) \\approx 0.94442$\n\n- **方法：M06-L** ($s_m=0.96$)\n  - $\\nu^{\\mathrm{scaled},\\,\\mathrm{nitro}} = [0.96 \\times 1520, 0.96 \\times 1360] = [1459.2, 1305.6]$\n  - $\\nu^{\\mathrm{scaled},\\,\\mathrm{nitrito}} = [0.96 \\times 1515, 0.96 \\times 1050] = [1454.4, 1008.0]$\n  - $\\mathrm{SSE}_{\\mathrm{M06-L}} = (1459.2-1460)^2 + (1305.6-1315)^2 + (1454.4-1465)^2 + (1008.0-1020)^2 = 345.36$\n  - $d_{\\mathrm{M06-L}} = \\sqrt{345.36 / 4} \\approx 9.2920\\,\\mathrm{cm^{-1}}$\n  - $w_{\\mathrm{M06-L}} = \\exp(-0.01 \\times 9.2920) \\approx 0.91127$\n\n权重之和为 $\\sum_m w_m = 0.95178 + 0.94442 + 0.91127 \\approx 2.80747$。\n\n**第 2 部分：处理测试案例**\n对于每个案例，我们计算最终的 $\\Delta G_{\\mathrm{nitrito - nitro}}$ 并确定胜者代码。\n\n- **案例 A**:\n  - $\\Delta E^{\\mathrm{gas}} = [6.5, 7.8, 4.1]\\, \\mathrm{kJ\\,mol^{-1}}$\n  - $\\sum_m w_m \\Delta E_m^{\\mathrm{gas}} = (0.95178 \\times 6.5) + (0.94442 \\times 7.8) + (0.91127 \\times 4.1) \\approx 17.2893\\, \\mathrm{kJ\\,mol^{-1}}$\n  - $\\Delta E^{\\mathrm{gas}}_{\\mathrm{ens}} = 17.2893 / 2.80747 \\approx 6.158\\, \\mathrm{kJ\\,mol^{-1}}$\n  - $\\Delta G = 6.158 + \\Delta\\Delta G_{\\mathrm{solv}} + \\Delta\\Delta G_{\\mathrm{therm}} = 6.158 + 3.2 + 0.3 = 9.658\\, \\mathrm{kJ\\,mol^{-1}}$\n  - 由于 $9.658 > \\tau=0.05$，胜者代码为 $0$。\n\n- **案例 B**:\n  - $\\Delta E^{\\mathrm{gas}} = [-1.5, -0.8, -2.1]\\, \\mathrm{kJ\\,mol^{-1}}$\n  - $\\sum_m w_m \\Delta E_m^{\\mathrm{gas}} = (0.95178 \\times -1.5) + (0.94442 \\times -0.8) + (0.91127 \\times -2.1) \\approx -4.0969\\, \\mathrm{kJ\\,mol^{-1}}$\n  - $\\Delta E^{\\mathrm{gas}}_{\\mathrm{ens}} = -4.0969 / 2.80747 \\approx -1.459\\, \\mathrm{kJ\\,mol^{-1}}$\n  - $\\Delta G = -1.459 + 4.9 + 0.2 = 3.641\\, \\mathrm{kJ\\,mol^{-1}}$\n  - 由于 $3.641 > \\tau=0.05$，胜者代码为 $0$。\n\n- **案例 C**:\n  - $\\Delta E^{\\mathrm{gas}} = [0.2, -0.1, 0.0]\\, \\mathrm{kJ\\,mol^{-1}}$\n  - $\\sum_m w_m \\Delta E_m^{\\mathrm{gas}} = (0.95178 \\times 0.2) + (0.94442 \\times -0.1) + (0.91127 \\times 0.0) \\approx 0.0959\\, \\mathrm{kJ\\,mol^{-1}}$\n  - $\\Delta E^{\\mathrm{gas}}_{\\mathrm{ens}} = 0.0959 / 2.80747 \\approx 0.034\\, \\mathrm{kJ\\,mol^{-1}}$\n  - $\\Delta G = 0.034 + 0.0 + 0.0 = 0.034\\, \\mathrm{kJ\\,mol^{-1}}$\n  - 由于 $|0.034| \\le \\tau=0.05$，胜者代码为 $2$。\n\n- **案例 D**:\n  - $\\Delta E^{\\mathrm{gas}} = [-8.2, -6.4, -7.1]\\, \\mathrm{kJ\\,mol^{-1}}$\n  - $\\sum_m w_m \\Delta E_m^{\\mathrm{gas}} = (0.95178 \\times -8.2) + (0.94442 \\times -6.4) + (0.91127 \\times -7.1) \\approx -20.3189\\, \\mathrm{kJ\\,mol^{-1}}$\n  - $\\Delta E^{\\mathrm{gas}}_{\\mathrm{ens}} = -20.3189 / 2.80747 \\approx -7.238\\, \\mathrm{kJ\\,mol^{-1}}$\n  - $\\Delta G = -7.238 + 1.0 - 0.2 = -6.438\\, \\mathrm{kJ\\,mol^{-1}}$\n  - 由于 $-6.438 < -\\tau=-0.05$，胜者代码为 $1$。\n\n将每个案例的计算结果整理起来，以生成最终输出。该过程是确定性和客观的，基于所提供的方案。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a DFT meta-protocol to rank linkage isomers of [Co(NH3)5NO2]2+.\n    \"\"\"\n    # =========================================================================\n    # Part 1: Define Global Parameters and Compute Method Weights\n    # =========================================================================\n\n    # Methods and their frequency scaling factors\n    scaling_factors = {'B3LYP': 0.97, 'PBE0': 0.98, 'M06-L': 0.96}\n    methods = list(scaling_factors.keys())\n\n    # Experimental marker frequencies in cm^-1\n    exp_freqs = {\n        'nitro': np.array([1460, 1315]),\n        'nitrito': np.array([1465, 1020])\n    }\n    k_total = len(exp_freqs['nitro']) + len(exp_freqs['nitrito'])\n\n    # Predicted (unscaled) marker frequencies in cm^-1 by method\n    pred_freqs = {\n        'B3LYP': {\n            'nitro': np.array([1510, 1350]),\n            'nitrito': np.array([1508, 1045])\n        },\n        'PBE0': {\n            'nitro': np.array([1492, 1344]),\n            'nitrito': np.array([1498, 1030])\n        },\n        'M06-L': {\n            'nitro': np.array([1520, 1360]),\n            'nitrito': np.array([1515, 1050])\n        }\n    }\n\n    # Exponential weight factor and decision tolerance\n    alpha = 0.01  # (cm^-1)^-1\n    tau = 0.05    # kJ/mol\n\n    # Compute RMSD (d_m) and weights (w_m) for each method\n    weights = {}\n    for m in methods:\n        s_m = scaling_factors[m]\n        \n        # Scale predicted frequencies\n        scaled_nitro = s_m * pred_freqs[m]['nitro']\n        scaled_nitrito = s_m * pred_freqs[m]['nitrito']\n        \n        # Calculate sum of squared errors (SSE)\n        sse_nitro = np.sum((scaled_nitro - exp_freqs['nitro'])**2)\n        sse_nitrito = np.sum((scaled_nitrito - exp_freqs['nitrito'])**2)\n        sse_total = sse_nitro + sse_nitrito\n        \n        # Calculate RMSD\n        d_m = np.sqrt(sse_total / k_total)\n        \n        # Calculate weight\n        w_m = np.exp(-alpha * d_m)\n        weights[m] = w_m\n\n    # Convert weights to a numpy array in the correct order for dot product\n    w_array = np.array([weights[m] for m in methods])\n    sum_weights = np.sum(w_array)\n\n    # =========================================================================\n    # Part 2: Process Test Cases\n    # =========================================================================\n    \n    # Test cases: (delta_E_gas_per_method, delta_delta_G_solv, delta_delta_G_therm)\n    # delta_E_gas is ordered corresponding to the 'methods' list: [B3LYP, PBE0, M06-L]\n    test_cases = [\n        (np.array([6.5, 7.8, 4.1]), 3.2, 0.3),    # Case A\n        (np.array([-1.5, -0.8, -2.1]), 4.9, 0.2), # Case B\n        (np.array([0.2, -0.1, 0.0]), 0.0, 0.0),   # Case C\n        (np.array([-8.2, -6.4, -7.1]), 1.0, -0.2)  # Case D\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        delta_E_gas_vec, delta_delta_G_solv, delta_delta_G_therm = case\n        \n        # Calculate the vibrationally validated, method-ensemble gas-phase relative electronic energy\n        # Delta_E_ens_gas = (sum_m w_m * Delta_E_m_gas) / (sum_m w_m)\n        delta_E_ens_gas = np.dot(w_array, delta_E_gas_vec) / sum_weights\n        \n        # Calculate the final predicted relative Gibbs free energy difference\n        delta_G = delta_E_ens_gas + delta_delta_G_solv + delta_delta_G_therm\n        \n        # Apply the decision rule to get the winner code\n        if delta_G > tau:\n            winner_code = 0\n        elif delta_G < -tau:\n            winner_code = 1\n        else:\n            winner_code = 2\n            \n        # Store results, rounding delta_G to three decimal places\n        all_results.append([round(delta_G, 3), winner_code])\n\n    # =========================================================================\n    # Part 3: Format and Print the Final Output\n    # =========================================================================\n\n    # Format the output string as specified: \"[[...],[...],...]\"\n    result_strings = []\n    for res in all_results:\n        # Custom formatting to avoid spaces inside the inner lists\n        result_strings.append(f\"[{res[0]},{res[1]}]\")\n        \n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}