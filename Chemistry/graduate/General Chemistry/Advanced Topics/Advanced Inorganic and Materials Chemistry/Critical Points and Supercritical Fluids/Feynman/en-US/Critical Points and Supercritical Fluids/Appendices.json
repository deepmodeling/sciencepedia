{
    "hands_on_practices": [
        {
            "introduction": "To build a robust understanding of the critical point, we begin with a foundational exercise derived from first principles. This practice involves using the van der Waals equation of state, a simple yet insightful model, to derive expressions for the critical constants ($T_c$, $P_c$, $V_c$). By applying the mathematical conditions for an inflection point on a pressure-volume isotherm, you will determine the universal critical compressibility factor, $Z_c$, predicted by this model, providing a crucial link between microscopic interactions and macroscopic critical behavior .",
            "id": "2931983",
            "problem": "A single-component fluid is modeled by the van der Waals (vdW) equation of state for one mole,\n$$(P + \\frac{a}{V_m^{2}})(V_m - b) = R T,$$\nwhere $P$ is pressure, $T$ is temperature, $V_m$ is the molar volume, $R$ is the gas constant, and $a$ and $b$ are fluid-specific parameters. The critical point of a fluid is defined as the point on the isotherm where the inflection conditions hold, namely $ \\left(\\frac{\\partial P}{\\partial V_m}\\right)_{T} = 0 $ and $ \\left(\\frac{\\partial^{2} P}{\\partial V_m^{2}}\\right)_{T} = 0 $. Starting from these definitions and the van der Waals equation of state, derive the critical compressibility factor $Z_c = \\frac{P_c V_c}{R T_c}$ for a vdW fluid in terms of universal numerical constants. Then, take a representative experimental critical compressibility factor for a simple real fluid to be $0.289$ and quantify the deviation between the vdW prediction and this experimental value by computing\n$$\\Delta = Z_c^{\\mathrm{(vdW)}} - 0.289.$$\nReport the single numerical value of $\\Delta$ as a pure number rounded to four significant figures. No units are required for the final reported value.",
            "solution": "The problem as stated is valid. It is a standard derivation in physical chemistry and is scientifically grounded, well-posed, and objective. We will proceed with the solution.\n\nThe problem requires the derivation of the critical compressibility factor, $Z_c$, from the van der Waals (vdW) equation of state and then to quantify its deviation from a given experimental value.\n\nThe van der Waals equation for one mole of a fluid is given as:\n$$ \\left(P + \\frac{a}{V_m^{2}}\\right)(V_m - b) = R T $$\nHere, $P$ is the pressure, $V_m$ is the molar volume, $T$ is the temperature, $R$ is the universal gas constant, and $a$ and $b$ are substance-specific constants.\n\nTo find the critical point, we must first express $P$ as a function of $V_m$ and $T$:\n$$ P(V_m, T) = \\frac{R T}{V_m - b} - \\frac{a}{V_m^{2}} $$\nThe critical point is an inflection point on the critical isotherm, defined by the conditions where the first and second partial derivatives of pressure with respect to molar volume at constant temperature are both zero:\n$$ \\left(\\frac{\\partial P}{\\partial V_m}\\right)_{T} = 0 \\quad \\text{and} \\quad \\left(\\frac{\\partial^{2} P}{\\partial V_m^{2}}\\right)_{T} = 0 $$\nFirst, we compute the first derivative:\n$$ \\left(\\frac{\\partial P}{\\partial V_m}\\right)_{T} = \\frac{\\partial}{\\partial V_m} \\left( \\frac{R T}{V_m - b} - \\frac{a}{V_m^{2}} \\right) = -\\frac{R T}{(V_m - b)^{2}} + \\frac{2a}{V_m^{3}} $$\nNext, we compute the second derivative:\n$$ \\left(\\frac{\\partial^{2} P}{\\partial V_m^{2}}\\right)_{T} = \\frac{\\partial}{\\partial V_m} \\left( -\\frac{R T}{(V_m - b)^{2}} + \\frac{2a}{V_m^{3}} \\right) = \\frac{2 R T}{(V_m - b)^{3}} - \\frac{6a}{V_m^{4}} $$\nAt the critical point $(P_c, V_c, T_c)$, these derivatives are zero. This gives us a system of two equations:\n$$ -\\frac{R T_c}{(V_c - b)^{2}} + \\frac{2a}{V_c^{3}} = 0 \\implies \\frac{R T_c}{(V_c - b)^{2}} = \\frac{2a}{V_c^{3}} \\quad (1) $$\n$$ \\frac{2 R T_c}{(V_c - b)^{3}} - \\frac{6a}{V_c^{4}} = 0 \\implies \\frac{2 R T_c}{(V_c - b)^{3}} = \\frac{6a}{V_c^{4}} \\quad (2) $$\nTo solve for the critical constants, we can divide equation $(2)$ by equation $(1)$:\n$$ \\frac{2 R T_c / (V_c - b)^{3}}{R T_c / (V_c - b)^{2}} = \\frac{6a / V_c^{4}}{2a / V_c^{3}} $$\n$$ \\frac{2}{V_c - b} = \\frac{3}{V_c} $$\nSolving for the critical molar volume, $V_c$:\n$$ 2 V_c = 3 (V_c - b) \\implies 2 V_c = 3 V_c - 3b \\implies V_c = 3b $$\nNow, we substitute this expression for $V_c$ back into equation $(1)$ to find the critical temperature, $T_c$:\n$$ \\frac{R T_c}{(3b - b)^{2}} = \\frac{2a}{(3b)^{3}} \\implies \\frac{R T_c}{(2b)^{2}} = \\frac{2a}{27b^{3}} \\implies \\frac{R T_c}{4b^{2}} = \\frac{2a}{27b^{3}} $$\n$$ T_c = \\frac{8a}{27b^{3}} \\frac{b^{2}}{R} = \\frac{8a}{27Rb} $$\nWith $V_c$ and $T_c$ known, we substitute them into the vdW equation of state to find the critical pressure, $P_c$:\n$$ P_c = \\frac{R T_c}{V_c - b} - \\frac{a}{V_c^{2}} = \\frac{R}{3b - b}\\left(\\frac{8a}{27Rb}\\right) - \\frac{a}{(3b)^{2}} $$\n$$ P_c = \\frac{1}{2b}\\left(\\frac{8a}{27b}\\right) - \\frac{a}{9b^{2}} = \\frac{8a}{54b^{2}} - \\frac{a}{9b^{2}} = \\frac{4a}{27b^{2}} - \\frac{3a}{27b^{2}} = \\frac{a}{27b^{2}} $$\nWe have now derived the critical constants in terms of the vdW parameters:\n$$ V_c = 3b, \\quad T_c = \\frac{8a}{27Rb}, \\quad P_c = \\frac{a}{27b^{2}} $$\nThe critical compressibility factor, $Z_c$, is defined as $Z_c = \\frac{P_c V_c}{R T_c}$. Substituting our derived expressions:\n$$ Z_c^{\\mathrm{(vdW)}} = \\frac{\\left(\\frac{a}{27b^{2}}\\right)(3b)}{R\\left(\\frac{8a}{27Rb}\\right)} = \\frac{\\frac{3ab}{27b^{2}}}{\\frac{8aR}{27Rb}} = \\frac{\\frac{a}{9b}}{\\frac{8a}{27b}} $$\nThe parameters $a$ and $b$ cancel, yielding a universal constant for all vdW fluids:\n$$ Z_c^{\\mathrm{(vdW)}} = \\frac{1}{9} \\times \\frac{27}{8} = \\frac{3}{8} $$\nAs a decimal, this value is $Z_c^{\\mathrm{(vdW)}} = 0.375$.\nThe problem requires computing the deviation $\\Delta$ from an experimental value of $0.289$:\n$$ \\Delta = Z_c^{\\mathrm{(vdW)}} - 0.289 $$\n$$ \\Delta = 0.375 - 0.289 = 0.086 $$\nThe final value must be reported rounded to four significant figures. The number $0.086$ has two significant figures. To express this with four significant figures of precision, we add trailing zeros.\n$$ \\Delta = 0.08600 $$",
            "answer": "$$\n\\boxed{0.08600}\n$$"
        },
        {
            "introduction": "Transitioning from pure theory to practical application, we now focus on one of the most significant uses of supercritical fluids: as tunable solvents. This exercise guides you through modeling experimental solubility data using the Chrastil correlation, a widely used semi-empirical model that links solubility $S$ to solvent density $\\rho$ and temperature $T$. You will employ linear regression to fit the model parameters, and, just as importantly, assess their statistical uncertainty, honing essential skills for any researcher working with experimental data in this field .",
            "id": "2931990",
            "problem": "You are given the Chrastil correlation for solubility in supercritical carbon dioxide ($\\text{scCO}_2$) expressed as a linear model in transformed variables. The correlation states that the natural logarithm of the solubility $S$ (in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$) of a solute in $\\text{scCO}_2$ at temperature $T$ (in $\\mathrm{K}$) and solvent density $\\rho$ (in $\\mathrm{kg}\\,\\mathrm{m}^{-3}$) obeys\n$$\n\\ln S = k \\ln \\rho + \\frac{a}{T} + b,\n$$\nwhere $k$, $a$, and $b$ are parameters to be estimated from data. Use the following well-tested base: transform the variables to obtain a linear regression problem of the form $y = X \\boldsymbol{\\beta} + \\boldsymbol{\\varepsilon}$ with $y = \\ln S$, $X = [\\ln \\rho,\\; 1/T,\\; 1]$, and $\\boldsymbol{\\beta} = [k,\\; a,\\; b]^{\\top}$. Assume that the residual vector $\\boldsymbol{\\varepsilon}$ is mean-zero with constant variance. Estimate the parameters by ordinary least squares and assess parameter uncertainty via the covariance matrix of the estimator in the transformed variables.\n\nYour task is to write a program that does the following for each test dataset:\n- Constructs the design matrix $X$ with columns $x_1 = \\ln \\rho$, $x_2 = 1/T$, and $x_3 = 1$.\n- Constructs the response vector $y = \\ln S$.\n- Computes the ordinary least squares estimator $\\widehat{\\boldsymbol{\\beta}} = (X^{\\top} X)^{-1} X^{\\top} y$.\n- Computes the residual sum of squares $\\mathrm{RSS} = \\|y - X \\widehat{\\boldsymbol{\\beta}}\\|_2^2$ and the unbiased residual variance $s^2 = \\mathrm{RSS}/(n-p)$, where $n$ is the number of data points and $p=3$ is the number of parameters.\n- Computes the parameter covariance matrix $\\mathrm{Cov}(\\widehat{\\boldsymbol{\\beta}}) = s^2 (X^{\\top} X)^{-1}$ and the parameter standard errors as the square roots of the diagonal elements.\n- Returns, for each dataset, a list $[\\widehat{k}, \\widehat{a}, \\widehat{b}, \\mathrm{SE}(\\widehat{k}), \\mathrm{SE}(\\widehat{a}), \\mathrm{SE}(\\widehat{b})]$ rounded to six decimal places.\n\nAll logarithms must be natural logarithms. All inputs must be strictly positive where logarithms are taken. Units must be as specified: $T$ in $\\mathrm{K}$, $\\rho$ in $\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $S$ in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$. No angle units are used. No percentages are used.\n\nTest suite:\n- Test set $1$ (varied $T$ and $\\rho$, typical operating window; happy path):\n  - Data triplets $(T,\\rho,S)$:\n    - $(308,\\;800,\\;0.760)$\n    - $(313,\\;750,\\;0.619)$\n    - $(318,\\;700,\\;0.569)$\n    - $(323,\\;650,\\;0.451)$\n    - $(328,\\;600,\\;0.408)$\n    - $(333,\\;550,\\;0.313)$\n- Test set $2$ (broad density variation with limited temperature variation; identifiability of $a$ and $b$ under mild collinearity):\n  - Data triplets $(T,\\rho,S)$:\n    - $(318,\\;900,\\;3.642)$\n    - $(318,\\;800,\\;2.519)$\n    - $(318,\\;700,\\;1.648)$\n    - $(318,\\;600,\\;1.114)$\n    - $(318,\\;500,\\;0.710)$\n    - $(313,\\;750,\\;2.038)$\n    - $(323,\\;650,\\;1.461)$\n    - $(323,\\;550,\\;0.991)$\n- Test set $3$ (near-collinearity between $\\ln \\rho$ and $1/T$; uncertainty inflation edge case):\n  - Data triplets $(T,\\rho,S)$:\n    - $(310,\\;780,\\;0.857)$\n    - $(315,\\;760,\\;0.756)$\n    - $(320,\\;740,\\;0.816)$\n    - $(325,\\;720,\\;0.739)$\n    - $(330,\\;700,\\;0.789)$\n- Test set $4$ (wider operating window including lower density; sensitivity to leverage):\n  - Data triplets $(T,\\rho,S)$:\n    - $(308,\\;900,\\;5.626)$\n    - $(318,\\;800,\\;4.944)$\n    - $(328,\\;700,\\;3.629)$\n    - $(338,\\;600,\\;2.922)$\n    - $(348,\\;500,\\;1.843)$\n    - $(358,\\;400,\\;1.260)$\n\nFinal output format:\n- Your program should produce a single line of output containing the results for the four test sets as a comma-separated list of lists, each inner list containing $6$ floats $[\\widehat{k}, \\widehat{a}, \\widehat{b}, \\mathrm{SE}(\\widehat{k}), \\mathrm{SE}(\\widehat{a}), \\mathrm{SE}(\\widehat{b})]$, all rounded to six decimal places, with no spaces, enclosed in square brackets. For example: \n  - $[[x_{11},x_{12},\\dots,x_{16}],[x_{21},\\dots,x_{26}],[x_{31},\\dots,x_{36}],[x_{41},\\dots,x_{46}]]$.",
            "solution": "The problem presented is valid. It is a well-posed, scientifically grounded task that requires the application of standard statistical methods, specifically ordinary least squares (OLS) linear regression, to a known physical chemistry model, the Chrastil equation. All necessary data and mathematical formulations are provided, and the problem is free of ambiguity or contradiction.\n\nThe objective is to estimate the parameters of the Chrastil correlation for the solubility of a solute in supercritical carbon dioxide. The model is given by:\n$$\n\\ln S = k \\ln \\rho + \\frac{a}{T} + b\n$$\nwhere $S$ is the solubility in $\\mathrm{mol}\\,\\mathrm{m}^{-3}$, $\\rho$ is the solvent density in $\\mathrm{kg}\\,\\mathrm{m}^{-3}$, and $T$ is the temperature in $\\mathrm{K}$. The parameters to be estimated are $k$, $a$, and $b$.\n\nThis equation is linear in its parameters, which allows us to formulate it as a standard linear regression problem of the form $y = X \\boldsymbol{\\beta} + \\boldsymbol{\\varepsilon}$. We begin by defining the response variable and the predictors based on the transformations of the observed data $(T_i, \\rho_i, S_i)$ for $i=1, \\dots, n$, where $n$ is the number of data points.\n\nThe response vector $y$ is an $n \\times 1$ column vector whose elements are the natural logarithm of the solubilities:\n$$\ny = \\begin{bmatrix} \\ln S_1 \\\\ \\ln S_2 \\\\ \\vdots \\\\ \\ln S_n \\end{bmatrix}\n$$\nThe design matrix $X$ is an $n \\times p$ matrix, where $p=3$ is the number of parameters. The columns of $X$ correspond to the predictors. The first column is the natural logarithm of the density, the second is the reciprocal of the temperature, and the third is a constant term (intercept).\n$$\nX = \\begin{bmatrix} \\ln \\rho_1 & 1/T_1 & 1 \\\\ \\ln \\rho_2 & 1/T_2 & 1 \\\\ \\vdots & \\vdots & \\vdots \\\\ \\ln \\rho_n & 1/T_n & 1 \\end{bmatrix}\n$$\nThe parameter vector $\\boldsymbol{\\beta}$ is a $p \\times 1$ column vector containing the unknown parameters:\n$$\n\\boldsymbol{\\beta} = \\begin{bmatrix} k \\\\ a \\\\ b \\end{bmatrix}\n$$\nThe ordinary least squares (OLS) method finds the estimator $\\widehat{\\boldsymbol{\\beta}}$ that minimizes the residual sum of squares, $\\mathrm{RSS} = \\|y - X \\boldsymbol{\\beta}\\|_2^2$. The analytical solution for this minimization problem is given by the normal equations, which yield the estimator:\n$$\n\\widehat{\\boldsymbol{\\beta}} = (X^{\\top} X)^{-1} X^{\\top} y\n$$\nThis calculation requires that the matrix $X^{\\top} X$ be invertible, which is true if and only if the columns of $X$ are linearly independent. The given test cases, including one designed to test near-collinearity, satisfy this condition, as $n > p$ and no perfect linear dependency exists among the predictors.\n\nOnce the parameter estimates $\\widehat{\\boldsymbol{\\beta}} = [\\widehat{k}, \\widehat{a}, \\widehat{b}]^{\\top}$ are computed, we must assess their uncertainty. The first step is to compute the residuals, $e = y - X \\widehat{\\boldsymbol{\\beta}}$, and the residual sum of squares:\n$$\n\\mathrm{RSS} = e^{\\top}e = \\sum_{i=1}^{n} (y_i - \\widehat{y}_i)^2\n$$\nFrom the RSS, we calculate the unbiased estimator of the residual variance, $\\sigma^2$, denoted by $s^2$:\n$$\ns^2 = \\frac{\\mathrm{RSS}}{n-p}\n$$\nThe denominator $n-p$ represents the degrees of freedom of the residuals.\n\nThe covariance matrix of the parameter estimator $\\widehat{\\boldsymbol{\\beta}}$ is then given by:\n$$\n\\mathrm{Cov}(\\widehat{\\boldsymbol{\\beta}}) = s^2 (X^{\\top} X)^{-1}\n$$\nThe diagonal elements of this matrix are the variances of the individual parameter estimates, $\\mathrm{Var}(\\widehat{\\beta}_j)$. The standard error (SE) of each parameter estimate is the square root of its variance:\n$$\n\\mathrm{SE}(\\widehat{\\beta}_j) = \\sqrt{\\mathrm{Var}(\\widehat{\\beta}_j)} = \\sqrt{[\\mathrm{Cov}(\\widehat{\\boldsymbol{\\beta}})]_{jj}}\n$$\nThe programmatic solution proceeds by implementing these matrix calculations for each of the four provided test datasets. For each dataset:\n1.  The raw data $(T_i, \\rho_i, S_i)$ are transformed to construct the vector $y$ and the matrix $X$.\n2.  The matrix products $X^{\\top}X$ and $X^{\\top}y$ are computed.\n3.  The inverse $(X^{\\top}X)^{-1}$ is calculated.\n4.  The parameter vector $\\widehat{\\boldsymbol{\\beta}}$ is found by multiplying $(X^{\\top}X)^{-1}$ by $X^{\\top}y$.\n5.  The RSS, $s^2$, and $\\mathrm{Cov}(\\widehat{\\boldsymbol{\\beta}})$ are computed in sequence.\n6.  The standard errors are extracted as the square roots of the diagonal elements of $\\mathrm{Cov}(\\widehat{\\boldsymbol{\\beta}})$.\n7.  The final results, consisting of the three parameter estimates and their corresponding three standard errors, are collected and rounded to six decimal places as required.\nThis entire procedure is numerically implemented using the `numpy` library, which is well-suited for efficient matrix algebra.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Chrastil correlation parameter estimation problem for multiple test sets.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test set 1\n        [\n            (308, 800, 0.760),\n            (313, 750, 0.619),\n            (318, 700, 0.569),\n            (323, 650, 0.451),\n            (328, 600, 0.408),\n            (333, 550, 0.313)\n        ],\n        # Test set 2\n        [\n            (318, 900, 3.642),\n            (318, 800, 2.519),\n            (318, 700, 1.648),\n            (318, 600, 1.114),\n            (318, 500, 0.710),\n            (313, 750, 2.038),\n            (323, 650, 1.461),\n            (323, 550, 0.991)\n        ],\n        # Test set 3\n        [\n            (310, 780, 0.857),\n            (315, 760, 0.756),\n            (320, 740, 0.816),\n            (325, 720, 0.739),\n            (330, 700, 0.789)\n        ],\n        # Test set 4\n        [\n            (308, 900, 5.626),\n            (318, 800, 4.944),\n            (328, 700, 3.629),\n            (338, 600, 2.922),\n            (348, 500, 1.843),\n            (358, 400, 1.260)\n        ]\n    ]\n\n    all_results = []\n    for case_data in test_cases:\n        result = _calculate_ols_params(case_data)\n        all_results.append(result)\n\n    # Format the final output string as specified in the problem.\n    # The str() representation of a list of lists is very close to the target format.\n    # We just need to remove spaces.\n    final_output_string = str(all_results).replace(' ', '')\n    print(final_output_string)\n\ndef _calculate_ols_params(data):\n    \"\"\"\n    Performs ordinary least squares regression for a single dataset.\n    \n    Args:\n        data (list of tuples): A list of (T, rho, S) data points.\n    \n    Returns:\n        list: A list of 6 floats [k, a, b, SE(k), SE(a), SE(b)] rounded to 6 decimal places.\n    \"\"\"\n    # Unpack data into numpy arrays\n    T, rho, S = np.array(data).T\n    \n    n = len(data)  # Number of data points\n    p = 3          # Number of parameters (k, a, b)\n\n    # 1. Construct the response vector y = ln(S)\n    y = np.log(S)\n\n    # 2. Construct the design matrix X = [ln(rho), 1/T, 1]\n    X = np.c_[np.log(rho), 1/T, np.ones(n)]\n\n    # 3. Compute the OLS estimator beta_hat = (X^T X)^-1 X^T y\n    try:\n        XTX = X.T @ X\n        XTX_inv = np.linalg.inv(XTX)\n        XTy = X.T @ y\n        beta_hat = XTX_inv @ XTy\n    except np.linalg.LinAlgError:\n        # This would happen if X^T X is singular (perfect collinearity)\n        # The problem statement guarantees this won't happen for the given test cases.\n        return [np.nan] * 6\n\n    # 4. Compute residuals and related statistics\n    # Predicted values\n    y_hat = X @ beta_hat\n    # Residuals\n    residuals = y - y_hat\n    # Residual Sum of Squares (RSS)\n    rss = residuals.T @ residuals\n    # Unbiased residual variance (s^2)\n    s_squared = rss / (n - p)\n\n    # 5. Compute the parameter covariance matrix and standard errors\n    # Covariance matrix of beta_hat\n    cov_beta = s_squared * XTX_inv\n    # Standard errors are the square roots of the diagonal elements\n    se_beta = np.sqrt(np.diag(cov_beta))\n\n    # 6. Assemble the results\n    k_hat, a_hat, b_hat = beta_hat\n    se_k, se_a, se_b = se_beta\n    \n    # Create a list of the 6 required values, rounded to 6 decimal places\n    results = [\n        round(k_hat, 6),\n        round(a_hat, 6),\n        round(b_hat, 6),\n        round(se_k, 6),\n        round(se_a, 6),\n        round(se_b, 6)\n    ]\n    \n    return results\n\nsolve()\n```"
        },
        {
            "introduction": "Our final practice is a capstone design problem that integrates multiple thermodynamic concepts to simulate a real-world engineering challenge. The goal is to determine the optimal pressure for a supercritical extraction process by enforcing the fundamental condition of phase equilibrium: the equality of solute fugacity in the solid and fluid phases, $f_i^{\\text{solid}} = f_i^{\\text{fluid}}$. This task requires you to construct a comprehensive model combining correlations for vapor pressure, solvent density, and fugacity coefficients, and then solve the resulting nonlinear equation numerically, showcasing how theoretical principles directly inform process design .",
            "id": "2931981",
            "problem": "A solid solute is extracted into a dense supercritical solvent. At phase equilibrium, the fugacity of the solute in the supercritical fluid equals the fugacity of the pure solid. The goal is to compute the extraction pressure at a specified temperature for a given target solute mole fraction in the fluid phase by enforcing the equilibrium condition $f_i^\\mathrm{fluid}=f_i^\\mathrm{solid}$ through fundamental definitions and empirically calibrated relationships.\n\nFundamental base:\n- Fugacity equality at equilibrium: $f_i^\\mathrm{fluid}=f_i^\\mathrm{solid}$.\n- For a very dilute solute in a dense fluid, the solute fugacity in the fluid is approximated by $f_i^\\mathrm{fluid}=y_i\\,\\phi_i(T,\\rho)\\,P$, where $y_i$ is the solute mole fraction in the fluid, $\\phi_i(T,\\rho)$ is the solute fugacity coefficient at infinite dilution as a function of temperature $T$ and solvent density $\\rho$, and $P$ is the total pressure.\n- For a pure solid, the fugacity is approximated by $f_i^\\mathrm{solid}=p_i^\\mathrm{sub}(T)\\,\\exp\\!\\left(\\frac{v_i^\\mathrm{s}}{R\\,T}\\left(P-P_\\mathrm{ref}\\right)\\right)$, which is the sublimation vapor pressure corrected by the Poynting factor. Here $p_i^\\mathrm{sub}(T)$ is the solute sublimation vapor pressure, $v_i^\\mathrm{s}$ is the solute molar volume in the solid phase, $R$ is the universal gas constant, and $P_\\mathrm{ref}$ is a reference pressure taken as $P_\\mathrm{ref}=0$.\n\nUse the following scientifically plausible and self-consistent models and parameters:\n- Sublimation vapor pressure of the solute is described by a Clausius–Clapeyron relation, $\\ln p_i^\\mathrm{sub}(T)=A-\\frac{B}{T}$, with $A=23.0$ and $B=6000.0$, yielding $p_i^\\mathrm{sub}$ in $\\mathrm{Pa}$ when temperature $T$ is in $\\mathrm{K}$.\n- The solvent density isotherms above the critical temperature are given empirically by a quadratic form in pressure on each isotherm, with linear interpolation across temperature:\n  $$\\rho(P,T)=a(T)+b(T)\\,P+c(T)\\,P^2,$$\n  where $\\rho$ is in $\\mathrm{mol\\,L^{-1}}$ and $P$ is in $\\mathrm{MPa}$. The coefficients are specified at three temperatures and must be linearly interpolated in $T$:\n  - At $T=308.0\\,\\mathrm{K}$: $(a,b,c)=(3.0,\\,0.80,\\,-0.005)$,\n  - At $T=328.0\\,\\mathrm{K}$: $(a,b,c)=(2.0,\\,0.45,\\,-0.003)$,\n  - At $T=348.0\\,\\mathrm{K}$: $(a,b,c)=(1.5,\\,0.30,\\,-0.002)$.\n- The solute fugacity coefficient at infinite dilution is correlated against temperature and solvent density by\n  $$\\ln \\phi_i(T,\\rho)=k_0+\\frac{k_T}{T}+k_\\rho\\,\\rho,$$\n  with constants $k_0=-1.0$, $k_T=-500.0\\,\\mathrm{K}$, and $k_\\rho=-0.03\\,\\mathrm{L\\,mol^{-1}}$. The density $\\rho$ is in $\\mathrm{mol\\,L^{-1}}$ and temperature $T$ is in $\\mathrm{K}$.\n- Use the solid molar volume $v_i^\\mathrm{s}=4.0\\times 10^{-5}\\,\\mathrm{m^3\\,mol^{-1}}$, the universal gas constant $R=8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$, and the critical pressure of the solvent $P_c=7.3773\\,\\mathrm{MPa}$.\n- Only supercritical conditions are admissible. Therefore, the extraction pressure solution must satisfy $P\\ge P_\\text{min}$ with $P_\\text{min}=7.5\\,\\mathrm{MPa}$. If no solution exists for $P$ in the closed interval $[P_\\text{min},P_\\text{max}]$ with $P_\\text{max}=60.0\\,\\mathrm{MPa}$, return a sentinel value of $-1.0$.\n\nYour program must, for each test case, set up the equality $y_i\\,\\phi_i(T,\\rho(P,T))\\,P=p_i^\\mathrm{sub}(T)\\,\\exp\\!\\left(\\frac{v_i^\\mathrm{s}\\,P\\,10^6}{R\\,T}\\right)$, where $P$ is in $\\mathrm{MPa}$ on the left-hand side but must be converted to $\\mathrm{Pa}$ on the right-hand side inside the exponential via the factor $10^6$, because the Poynting factor uses pressure in $\\mathrm{Pa}$. Solve for $P$ numerically within $[P_\\text{min},P_\\text{max}]$. Use a robust bracketing method that only declares success when the residual changes sign in the bracket. If the sign does not change, report $-1.0$ for that case.\n\nAngle units are not used. All physical quantities must be handled in coherent units as specified. Express the final extraction pressure for each case in $\\mathrm{MPa}$, rounded to three decimals. If no supercritical solution exists, return exactly $-1.0$ (not rounded).\n\nTest suite (temperature $T$ in $\\mathrm{K}$, target solute mole fraction $y_i$ dimensionless):\n- Case $1$: $\\left(T,y_i\\right)=\\left(318.0,\\,1.0\\times 10^{-4}\\right)$.\n- Case $2$: $\\left(T,y_i\\right)=\\left(338.0,\\,1.7\\times 10^{-4}\\right)$.\n- Case $3$: $\\left(T,y_i\\right)=\\left(308.5,\\,6.0\\times 10^{-5}\\right)$.\n- Case $4$ (edge case intended to have no solution in the admissible supercritical range): $\\left(T,y_i\\right)=\\left(348.0,\\,2.0\\times 10^{-5}\\right)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4\\right]$), where each entry is either a float in $\\mathrm{MPa}$ rounded to three decimals or the sentinel $-1.0$.",
            "solution": "The equilibrium condition is imposed by the definition of fugacity for phase equilibrium, which is a fundamental thermodynamic requirement. For a solute $i$ that partitions between a solid phase and a supercritical fluid solvent, equilibrium implies $f_i^\\mathrm{fluid}=f_i^\\mathrm{solid}$.\n\nFor the fluid fugacity at infinite dilution, the well-tested approximation $f_i^\\mathrm{fluid}=y_i\\,\\phi_i\\,P$ is used, where $y_i$ is the solute mole fraction in the dense fluid, $\\phi_i$ is the fugacity coefficient capturing nonideality, and $P$ is pressure. For the solid fugacity, the Poynting correction accounts for the effect of pressure on the chemical potential of the solid relative to its sublimation pressure reference state, yielding $f_i^\\mathrm{solid}=p_i^\\mathrm{sub}(T)\\,\\exp\\!\\left(\\frac{v_i^\\mathrm{s}}{R\\,T}\\int_{P_\\mathrm{ref}}^{P} \\mathrm{d}P'\\right)$. With $P_\\mathrm{ref}=0$ and assuming $v_i^\\mathrm{s}$ is pressure-independent over the relevant range, this integrates to $f_i^\\mathrm{solid}=p_i^\\mathrm{sub}(T)\\,\\exp\\!\\left(\\frac{v_i^\\mathrm{s}\\,P}{R\\,T}\\right)$, noting that the pressure must be in the same units as those in $R$ to maintain dimensional consistency.\n\nTo close the problem, three auxiliary, physically motivated relations are introduced:\n- The sublimation vapor pressure is represented by the Clausius–Clapeyron form $\\ln p_i^\\mathrm{sub}(T)=A-\\frac{B}{T}$ with constants $A$ and $B$ provided; this returns $p_i^\\mathrm{sub}$ in $\\mathrm{Pa}$ for $T$ in $\\mathrm{K}$.\n- The solvent density on an isotherm above the critical temperature is correlated as $\\rho(P,T)=a(T)+b(T)\\,P+c(T)\\,P^2$, with $P$ in $\\mathrm{MPa}$ and $\\rho$ in $\\mathrm{mol\\,L^{-1}}$. The temperature dependence of the coefficients is handled by linear interpolation between calibrated values at $T=308.0\\,\\mathrm{K}$, $T=328.0\\,\\mathrm{K}$, and $T=348.0\\,\\mathrm{K}$, which is a standard approach when smoothly varying empirical parameters between tabulated states.\n- The solute fugacity coefficient at infinite dilution is modeled by $\\ln \\phi_i(T,\\rho)=k_0+\\frac{k_T}{T}+k_\\rho\\,\\rho$, with constants $k_0$, $k_T$, and $k_\\rho$ provided. This captures the observed decrease in $\\phi_i$ with increasing density due to enhanced solvent–solute interactions, while also allowing for temperature dependence.\n\nThe unknown in the equilibrium equation is the pressure $P$. Define the residual function\n$$\nF(P;T,y_i)=y_i\\,\\phi_i\\!\\left(T,\\rho(P,T)\\right)\\,P_\\mathrm{Pa}-p_i^\\mathrm{sub}(T)\\,\\exp\\!\\left(\\frac{v_i^\\mathrm{s}\\,P_\\mathrm{Pa}}{R\\,T}\\right),\n$$\nwhere $P_\\mathrm{Pa}=P\\times 10^6$ converts $P$ from $\\mathrm{MPa}$ to $\\mathrm{Pa}$ so that both terms use coherent SI units in the exponential and in the fluid-side product $y_i\\,\\phi_i\\,P$. The problem of finding the extraction pressure reduces to a one-dimensional root-finding task: find $P$ in the admissible supercritical interval $[P_\\text{min},P_\\text{max}]$ such that $F(P;T,y_i)=0$.\n\nA robust numerical approach is to use a bracketing method, such as bisection, which requires a sign change of $F$ over the interval. The algorithm is as follows:\n- For each test case $\\left(T,y_i\\right)$, compute $F(P_\\text{min})$ and $F(P_\\text{max})$.\n- If $F(P_\\text{min})\\cdot F(P_\\text{max})>0$, then no root exists in the interval and the physically admissible supercritical solution does not exist under these constraints; report the sentinel $-1.0$.\n- Otherwise, iterate bisection on $[P_\\text{min},P_\\text{max}]$ until the interval is sufficiently small or the residual is sufficiently close to zero, and return the midpoint as the extraction pressure. The returned value is then rounded to three decimals in $\\mathrm{MPa}$, as required.\n\nParameter values used:\n- $A=23.0$ and $B=6000.0$ for the Clausius–Clapeyron relation.\n- $v_i^\\mathrm{s}=4.0\\times 10^{-5}\\,\\mathrm{m^3\\,mol^{-1}}$.\n- $R=8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n- $\\left(a,b,c\\right)$ at $T=308.0\\,\\mathrm{K}$ equals $\\left(3.0,\\,0.80,\\,-0.005\\right)$, at $T=328.0\\,\\mathrm{K}$ equals $\\left(2.0,\\,0.45,\\,-0.003\\right)$, and at $T=348.0\\,\\mathrm{K}$ equals $\\left(1.5,\\,0.30,\\,-0.002\\right)$; linear interpolation supplies $\\left(a(T),b(T),c(T)\\right)$ for intermediate $T$.\n- $k_0=-1.0$, $k_T=-500.0\\,\\mathrm{K}$, and $k_\\rho=-0.03\\,\\mathrm{L\\,mol^{-1}}$.\n- $P_\\text{min}=7.5\\,\\mathrm{MPa}$ and $P_\\text{max}=60.0\\,\\mathrm{MPa}$.\n\nThe algorithm directly enforces the equality $f_i^\\mathrm{fluid}=f_i^\\mathrm{solid}$ from first principles, while using physically plausible, interpolated density isotherms and an empirically motivated infinite-dilution fugacity coefficient. The Poynting correction is applied consistently with the chosen solid molar volume and absolute units. The test suite includes three cases expected to have a unique solution in the supercritical region and one edge case designed to have no solution in the admissible interval, thus testing both the happy path and the sentinel behavior. The final program aggregates results in the specified single-line list format, with each successful extraction pressure expressed in $\\mathrm{MPa}$ rounded to three decimals.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport math\n\n# Constants\nR = 8.314462618  # J/mol/K\nv_s = 4.0e-5     # m^3/mol\nPc_MPa = 7.3773  # MPa\nPmin = 7.5       # MPa (enforce supercritical)\nPmax = 60.0      # MPa\n\n# Sublimation vapor pressure parameters (Clausius–Clapeyron), returns Pa\nA_sub = 23.0\nB_sub = 6000.0\n\n# Fugacity coefficient correlation parameters: ln(phi) = k0 + kT/T + k_rho * rho\nk0 = -1.0\nkT = -500.0\nk_rho = -0.03  # per (mol/L)\n\n# Density isotherm coefficients at T nodes (T in K): rho(P,T)=a(T)+b(T)P+c(T)P^2 with P in MPa, rho in mol/L\nisotherm_data = [\n    (308.0, (3.0, 0.80, -0.005)),\n    (328.0, (2.0, 0.45, -0.003)),\n    (348.0, (1.5, 0.30, -0.002)),\n]\n\ndef p_sub_pa(T):\n    # p_sub in Pa\n    return math.exp(A_sub - B_sub / T)\n\ndef interp_coeffs(T):\n    # Linear interpolation of (a,b,c) over T using two nearest nodes\n    # Extrapolate linearly if outside provided range.\n    # Sort by temperature\n    data = sorted(isotherm_data, key=lambda x: x[0])\n    if T <= data[0][0]:\n        return data[0][1]\n    if T >= data[-1][0]:\n        return data[-1][1]\n    # Find interval\n    for i in range(len(data) - 1):\n        T0, (a0, b0, c0) = data[i]\n        T1, (a1, b1, c1) = data[i + 1]\n        if T0 <= T <= T1:\n            f = (T - T0) / (T1 - T0)\n            a = a0 + f * (a1 - a0)\n            b = b0 + f * (b1 - b0)\n            c = c0 + f * (c1 - c0)\n            return (a, b, c)\n    # Fallback (should not reach here)\n    return data[-1][1]\n\ndef rho_mol_per_L(P_MPa, T):\n    a, b, c = interp_coeffs(T)\n    return a + b * P_MPa + c * (P_MPa ** 2)\n\ndef phi_infinite_dilution(T, rho_mol_L):\n    ln_phi = k0 + (kT / T) + k_rho * rho_mol_L\n    # Ensure numerical stability\n    return math.exp(ln_phi)\n\ndef residual(P_MPa, T, y):\n    # Convert P to Pa where needed\n    P_Pa = P_MPa * 1.0e6\n    rho = rho_mol_per_L(P_MPa, T)\n    phi = phi_infinite_dilution(T, rho)\n    f_fluid = y * phi * P_Pa\n    f_solid = p_sub_pa(T) * math.exp((v_s * P_Pa) / (R * T))\n    return f_fluid - f_solid\n\ndef find_pressure(T, y, P_lo=Pmin, P_hi=Pmax, tol=1e-9, max_iter=200):\n    f_lo = residual(P_lo, T, y)\n    f_hi = residual(P_hi, T, y)\n    if math.isnan(f_lo) or math.isnan(f_hi):\n        return -1.0\n    # If no sign change, declare no solution in bracket\n    if f_lo == 0.0:\n        return P_lo\n    if f_hi == 0.0:\n        return P_hi\n    if f_lo * f_hi > 0.0:\n        return -1.0\n    # Bisection\n    a = P_lo\n    b = P_hi\n    fa = f_lo\n    fb = f_hi\n    for _ in range(max_iter):\n        m = 0.5 * (a + b)\n        fm = residual(m, T, y)\n        # Check convergence either by residual or interval\n        if abs(fm) < 1e-6:\n            return m\n        if (b - a) < tol:\n            return m\n        # Update bracket\n        if fa * fm <= 0.0:\n            b = m\n            fb = fm\n        else:\n            a = m\n            fa = fm\n    return 0.5 * (a + b)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (T in K, y dimensionless)\n    test_cases = [\n        (318.0, 1.0e-4),\n        (338.0, 1.7e-4),\n        (308.5, 6.0e-5),\n        (348.0, 2.0e-5),\n    ]\n\n    results_str = []\n    for T, y in test_cases:\n        P = find_pressure(T, y, P_lo=Pmin, P_hi=Pmax)\n        if P < 0.0:\n            results_str.append(str(-1.0))\n        else:\n            results_str.append(f\"{P:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}