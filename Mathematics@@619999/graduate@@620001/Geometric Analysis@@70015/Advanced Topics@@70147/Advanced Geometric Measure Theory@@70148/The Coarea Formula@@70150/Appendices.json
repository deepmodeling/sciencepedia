{"hands_on_practices": [{"introduction": "This first exercise serves as a concrete verification of the coarea formula in a familiar setting. By explicitly calculating an integral in two different ways—first as a standard double integral and then using the coarea principle of slicing—you will see how the formula generalizes the fundamental concept of iterated integration from calculus. This practice [@problem_id:1449836] is designed to build intuition and confirm that the powerful coarea formula rests on a solid and verifiable foundation.", "problem": "Let $T$ be the triangular region in the $xy$-plane with vertices at $(0,0)$, $(1,0)$, and $(0,1)$.\nConsider two quantities, $I_1$ and $I_2$, defined as follows:\n\n1.  The first quantity, $I_1$, is the double integral of the function $g(x,y) = x$ over the region $T$:\n    $$I_1 = \\iint_T x \\,dA$$\n    where $dA$ is the element of area in the $xy$-plane.\n\n2.  The second quantity, $I_2$, is defined through an iterated integration process. For any real number $t$ in the interval $[0,1]$, let $L_t$ be the horizontal line segment formed by the intersection of the region $T$ with the line $y=t$. The quantity $I_2$ is then given by the integral:\n    $$I_2 = \\int_0^1 \\left( \\int_{L_t} x \\,ds \\right) dt$$\n    where the inner integral is a line integral of the function $g(x,y)=x$ along the segment $L_t$, and $ds$ is the element of arc length.\n\nCalculate the values of $I_1$ and $I_2$. Express your answer as a $1 \\times 2$ row matrix of the form $\\begin{pmatrix} I_1  I_2 \\end{pmatrix}$.", "solution": "The triangular region $T$ is given by $\\{(x,y): x \\geq 0, y \\geq 0, x + y \\leq 1\\}$. For $I_{1}$, we write the double integral with $y$ ranging from $0$ to $1 - x$ and $x$ from $0$ to $1$:\n$$\nI_{1} = \\iint_{T} x \\, dA = \\int_{0}^{1} \\int_{0}^{1 - x} x \\, dy \\, dx.\n$$\nEvaluating the inner integral,\n$$\n\\int_{0}^{1 - x} x \\, dy = x(1 - x).\n$$\nThus,\n$$\nI_{1} = \\int_{0}^{1} \\left(x - x^{2}\\right) dx = \\left[\\frac{x^{2}}{2} - \\frac{x^{3}}{3}\\right]_{0}^{1} = \\frac{1}{2} - \\frac{1}{3} = \\frac{1}{6}.\n$$\n\nFor $I_{2}$, for a fixed $t \\in [0,1]$, the horizontal segment $L_{t}$ is $\\{(x,t): 0 \\leq x \\leq 1 - t\\}$. Parameterize $L_{t}$ by $\\mathbf{r}(x) = (x,t)$ with $x \\in [0, 1 - t]$. Then $d\\mathbf{r}/dx = (1,0)$, so $ds = |\\mathbf{r}'(x)| dx = dx$. The inner line integral is\n$$\n\\int_{L_{t}} x \\, ds = \\int_{0}^{1 - t} x \\, dx = \\frac{(1 - t)^{2}}{2}.\n$$\nTherefore,\n$$\nI_{2} = \\int_{0}^{1} \\frac{(1 - t)^{2}}{2} \\, dt = \\frac{1}{2} \\int_{0}^{1} \\left(1 - 2t + t^{2}\\right) dt = \\frac{1}{2} \\left[t - t^{2} + \\frac{t^{3}}{3}\\right]_{0}^{1} = \\frac{1}{2} \\cdot \\frac{1}{3} = \\frac{1}{6}.\n$$\n\nHence,\n$$\nI_{1} = \\frac{1}{6}, \\quad I_{2} = \\frac{1}{6}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{6}  \\frac{1}{6} \\end{pmatrix}}$$", "id": "1449836"}, {"introduction": "Moving beyond simple verification, this problem demonstrates the coarea formula's utility as a powerful computational tool for non-trivial integrals. You will apply the formula to an integrand that is precisely the magnitude of a function's gradient, a scenario where the formula is particularly effective. This exercise [@problem_id:1449839] requires a careful analysis of the level set geometry for a non-monotonic function, providing insight into how the formula elegantly handles cases where level sets are disconnected.", "problem": "Consider the two-dimensional domain $D = [-2, 2] \\times [-2, 2]$. Let a function $g: D \\to \\mathbb{R}$ be defined by $g(x, y) = x^3 - 3x$.\n\nYour task is to compute the value of the integral\n$$I = \\int_D |3x^2 - 3| \\, dx \\, dy$$\nby applying the coarea formula with the level sets of the function $g(x,y)$.\n\nProvide the exact numerical value of the integral $I$.", "solution": "We are given $D=[-2,2]\\times[-2,2]$ and $g(x,y)=x^{3}-3x$. The integrand satisfies\n$$\n|3x^{2}-3|=\\left|\\frac{\\partial g}{\\partial x}\\right|=\\left|\\nabla g(x,y)\\right|,\n$$\nsince $\\frac{\\partial g}{\\partial y}=0$. By the coarea formula in two dimensions,\n$$\n\\int_{D}|\\nabla g|\\,dx\\,dy=\\int_{\\mathbb{R}}\\mathcal{H}^{1}\\!\\left(D\\cap g^{-1}(t)\\right)\\,dt,\n$$\nwhere $\\mathcal{H}^{1}$ denotes one-dimensional Hausdorff measure (length).\n\nWe therefore compute the length of the level sets $D\\cap g^{-1}(t)$ for $t\\in\\mathbb{R}$. Because $g$ depends only on $x$, the level set $g(x,y)=t$ within $D$ consists of vertical segments at those $x\\in[-2,2]$ solving\n$$\nx^{3}-3x=t,\n$$\nwith $y\\in[-2,2]$. Let $h(x)=x^{3}-3x$. On $[-2,2]$, $h'(x)=3x^{2}-3$, so $h$ is strictly increasing on $[-2,-1]$, strictly decreasing on $[-1,1]$, and strictly increasing on $[1,2]$. The endpoint values are\n$$\nh(-2)=-2,\\quad h(-1)=2,\\quad h(1)=-2,\\quad h(2)=2,\n$$\nso the range of $h$ on $[-2,2]$ is $[-2,2]$.\n\nHence:\n- For $t\\in(-2,2)$, the equation $x^{3}-3x=t$ has exactly three distinct solutions in $[-2,2]$, one in each of the intervals $[-2,-1]$, $[-1,1]$, and $[1,2]$. Therefore, $D\\cap g^{-1}(t)$ is the union of three vertical segments, each of length $4$ (since $y\\in[-2,2]$), so\n$$\n\\mathcal{H}^{1}\\!\\left(D\\cap g^{-1}(t)\\right)=3\\times 4=12.\n$$\n- For $t=\\pm 2$, there are two distinct $x$ values in $[-2,2]$ (with one double root), producing two vertical segments of length $4$, hence $\\mathcal{H}^{1}=8$. These isolated values do not affect the integral.\n- For $t\\notin[-2,2]$, there are no solutions in $[-2,2]$, so the length is $0$.\n\nTherefore, by the coarea formula,\n$$\nI=\\int_{D}|3x^{2}-3|\\,dx\\,dy=\\int_{\\mathbb{R}}\\mathcal{H}^{1}\\!\\left(D\\cap g^{-1}(t)\\right)\\,dt=\\int_{-2}^{2}12\\,dt=12\\cdot 4=48.\n$$", "answer": "$$\\boxed{48}$$", "id": "1449839"}, {"introduction": "This final practice explores the coarea formula in its natural and most powerful context: for Lipschitz functions in $n$ dimensions, which may not be smooth everywhere. The chosen function, $f(x) = \\|x\\|$, is a cornerstone example in geometric analysis, being non-differentiable at the origin yet perfectly suited for the coarea formula. This advanced problem [@problem_id:3034561] illuminates the formula's deep connection to geometric measure theory, Rademacher's theorem, and the fundamental relationship between the volume of an $n$-ball and the surface area of its bounding sphere.", "problem": "Let $n \\geq 2$ and let $R0$. Consider the function $f:\\mathbb{R}^{n}\\to\\mathbb{R}$ defined by $f(x)=\\|x\\|$, where $\\|\\cdot\\|$ denotes the Euclidean norm. \n\n(a) Verify that $f$ is Lipschitz but not of class $C^{1}$, and explain why the gradient $\\nabla f$ exists almost everywhere (almost everywhere (a.e.)) in $\\mathbb{R}^{n}$. Identify $\\nabla f(x)$ explicitly for $x\\neq 0$, and determine $|\\nabla f(x)|$ for $x\\neq 0$.\n\n(b) Describe, at a conceptual level and without quoting any pre-stated formula, how slicing $\\mathbb{R}^{n}$ into level sets of $f$ introduces a weighting by $|\\nabla f|$ when one rewrites an $n$-dimensional integral as an integral over the family of level sets $\\{f=t\\}$ endowed with the $(n-1)$-dimensional Hausdorff measure $\\mathcal{H}^{n-1}$. Your explanation should justify why the density $|\\nabla f|$ naturally appears, even though $f$ fails to be of class $C^{1}$ at a set of measure zero.\n\n(c) Using the perspective from part (b), evaluate the integral\n$$\nJ(R,n)\\;=\\;\\int_{B_{R}(0)} |\\nabla f(x)|\\,\\mathrm{d}x,\n$$\nwhere $B_{R}(0)=\\{x\\in\\mathbb{R}^{n}:\\|x\\|\\le R\\}$. Express your final answer in a closed form in terms of $n$, $R$, $\\pi$, and the Gamma function $\\Gamma(\\cdot)$. Your final answer must be a single analytic expression. Do not provide any numerical approximation.", "solution": "(a) We analyze the function $f(x) = \\|x\\|$ for $x \\in \\mathbb{R}^n$, where $n \\geq 2$.\n\nFirst, we verify that $f$ is Lipschitz continuous. For any $x, y \\in \\mathbb{R}^n$, the reverse triangle inequality for the Euclidean norm states that $|\\|x\\| - \\|y\\|| \\le \\|x-y\\|$. In terms of our function $f$, this is $|f(x) - f(y)| \\le 1 \\cdot \\|x-y\\|$. This is the definition of Lipschitz continuity with a Lipschitz constant $L=1$.\n\nNext, we show that $f$ is not of class $C^1(\\mathbb{R}^n)$. A function is of class $C^1$ if it is differentiable everywhere and its derivative is continuous. We will show that $f$ is not differentiable at $x=0$. The derivative of $f$ at a point $x_0$, if it exists, is a linear map $Df(x_0)$ such that $\\lim_{h\\to 0} \\frac{\\|f(x_0+h) - f(x_0) - Df(x_0)(h)\\|}{\\|h\\|} = 0$. At $x_0=0$, we have $f(0)=0$. If the derivative existed, it would have to be the zero map, since the directional derivative in any direction $v$ would be $\\lim_{t\\to 0} \\frac{\\|tv\\| - 0}{t} = \\|v\\|\\lim_{t\\to 0} \\frac{|t|}{t}$, which does not exist. More formally, consider the path $h_t = tv$ for a unit vector $v \\in \\mathbb{R}^n$.\nThe directional derivative at $0$ in the direction $v$ is:\n$$\n\\lim_{t \\to 0^+} \\frac{f(0+tv)-f(0)}{t} = \\lim_{t \\to 0^+} \\frac{\\|tv\\|}{t} = \\lim_{t \\to 0^+} \\frac{t\\|v\\|}{t} = \\|v\\|=1.\n$$\nHowever, approaching from the negative side:\n$$\n\\lim_{t \\to 0^-} \\frac{f(0+tv)-f(0)}{t} = \\lim_{t \\to 0^-} \\frac{\\|tv\\|}{t} = \\lim_{t \\to 0^-} \\frac{|t|\\|v\\|}{t} = \\lim_{t \\to 0^-} \\frac{-t\\|v\\|}{t} = -\\|v\\|=-1.\n$$\nSince the directional derivatives depend on the direction of approach (and even for a fixed direction, the limit from left and right differ), the function is not differentiable at $x=0$. Since it is not differentiable at a point, it cannot be of class $C^1(\\mathbb{R}^n)$.\n\nThe gradient $\\nabla f$ exists almost everywhere (a.e.) due to Rademacher's theorem, which states that any Lipschitz function from $\\mathbb{R}^n$ to $\\mathbb{R}^m$ is differentiable almost everywhere with respect to the Lebesgue measure. As we have shown $f$ is Lipschitz, it is differentiable a.e. The only point of non-differentiability is $x=0$, which is a set of Lebesgue measure zero in $\\mathbb{R}^n$ for $n \\ge 1$.\n\nFor any $x \\neq 0$, the function $f(x) = (\\sum_{i=1}^n x_i^2)^{1/2}$ is a composition of smooth functions, so we can compute its gradient using the chain rule. The partial derivative with respect to $x_j$ is:\n$$\n\\frac{\\partial f}{\\partial x_j} = \\frac{\\partial}{\\partial x_j} \\left(\\sum_{i=1}^n x_i^2\\right)^{1/2} = \\frac{1}{2} \\left(\\sum_{i=1}^n x_i^2\\right)^{-1/2} (2x_j) = \\frac{x_j}{\\left(\\sum_{i=1}^n x_i^2\\right)^{1/2}} = \\frac{x_j}{\\|x\\|}.\n$$\nThe gradient vector $\\nabla f(x)$ is therefore:\n$$\n\\nabla f(x) = \\left( \\frac{x_1}{\\|x\\|}, \\frac{x_2}{\\|x\\|}, \\dots, \\frac{x_n}{\\|x\\|} \\right) = \\frac{x}{\\|x\\|}.\n$$\nThis is the unit vector in the direction of $x$.\n\nThe magnitude of the gradient for $x \\neq 0$ is the norm of this vector:\n$$\n|\\nabla f(x)| = \\left\\| \\frac{x}{\\|x\\|} \\right\\| = \\frac{1}{\\|x\\|} \\|x\\| = 1.\n$$\n\n(b) The coarea formula provides a way to disintegrate an integral over an $n$-dimensional domain into an iterated integral, where one integrates first over the $(n-1)$-dimensional level sets of a function and then integrates the results over the values of the function. For a function $f:\\mathbb{R}^n \\to \\mathbb{R}$, its level sets are the surfaces $\\{x \\in \\mathbb{R}^n | f(x) = t\\}$ for constants $t$.\n\nConceptually, the appearance of the density $|\\nabla f|$ arises from the geometric change of variables. Consider a small volume element $\\mathrm{d}\\mathcal{L}^n(x)$ in $\\mathbb{R}^n$. We wish to express this volume element in a coordinate system adapted to the level sets of $f$. This new system can be thought of as having one coordinate representing the level set value, $t=f(x)$, and $n-1$ coordinates parametrizing the position on that level set. The volume element can be locally decomposed into the product of a surface area element $\\mathrm{d}\\mathcal{H}^{n-1}$ on the level set and an infinitesimal thickness $dh$ perpendicular to the level set. So, $\\mathrm{d}\\mathcal{L}^n(x) \\approx \\mathrm{d}\\mathcal{H}^{n-1} \\cdot dh$.\n\nThe thickness $dh$ is the perpendicular distance one must travel to get from the level set $\\{f=t\\}$ to $\\{f=t+dt\\}$. The gradient $\\nabla f(x)$ points in the direction of the fastest increase of $f$, which is perpendicular to the level set at $x$. The magnitude of the gradient, $|\\nabla f(x)|$, represents this rate of increase. By first-order approximation, the change in $f$, $df$, is related to the displacement $dh$ in the normal direction by $df \\approx |\\nabla f(x)| dh$. For an infinitesimal change $\\mathrm{d}t$, the required normal displacement is $dh \\approx \\frac{\\mathrm{d}t}{|\\nabla f(x)|}$.\n\nSubstituting this back into the volume decomposition, we get $\\mathrm{d}\\mathcal{L}^n(x) \\approx \\mathrm{d}\\mathcal{H}^{n-1} \\frac{\\mathrm{d}t}{|\\nabla f(x)|}$. This leads to the coarea formula in one of its forms:\n$$\n\\int_{\\mathbb{R}^n} g(x) \\,\\mathrm{d}\\mathcal{L}^n(x) = \\int_{-\\infty}^{\\infty} \\left( \\int_{f^{-1}(t)} \\frac{g(x)}{|\\nabla f(x)|} \\,\\mathrm{d}\\mathcal{H}^{n-1}(x) \\right) \\mathrm{d}t.\n$$\nThe problem statement refers to a weighting by $|\\nabla f|$ when rewriting an $n$-dimensional integral. This points to the more common statement of the coarea formula:\n$$\n\\int_{\\mathbb{R}^n} g(x) |\\nabla f(x)| \\,\\mathrm{d}\\mathcal{L}^n(x) = \\int_{-\\infty}^{\\infty} \\left( \\int_{f^{-1}(t)} g(x) \\,\\mathrm{d}\\mathcal{H}^{n-1}(x) \\right) \\mathrm{d}t.\n$$\nThis form arises directly from the previous one by moving $|\\nabla f(x)|$ to the left side. The factor $|\\nabla f(x)|$ is the Jacobian factor that accounts for the geometric distortion when changing from Cartesian coordinates to level set coordinates. It measures how \"densely packed\" the level surfaces are; where $|\\nabla f|$ is large, the level surfaces are close together, and a smaller volume in space corresponds to a given range of $t$-values.\n\nThe fact that $f(x)=\\|x\\|$ is not $C^1$ at $x=0$ does not invalidate this reasoning. The coarea formula holds for Lipschitz functions like $f$. The derivative $\\nabla f$ exists almost everywhere, and the set $\\{0\\}$ where it is undefined is a set of Lebesgue measure zero. Integrals over sets of measure zero are zero, so such points do not contribute to the value of the integral on the left-hand side. The geometric argument holds for almost every point in the domain.\n\n(c) We are asked to evaluate the integral $J(R,n) = \\int_{B_R(0)} |\\nabla f(x)|\\,\\mathrm{d}x$, where $f(x)=\\|x\\|$ and $B_R(0)=\\{x\\in\\mathbb{R}^{n}:\\|x\\|\\le R\\}$.\n\nWe apply the coarea formula:\n$$\n\\int_{\\Omega} g(x) |\\nabla f(x)| \\,\\mathrm{d}\\mathcal{L}^n(x) = \\int_{-\\infty}^{\\infty} \\left( \\int_{f^{-1}(t) \\cap \\Omega} g(x) \\,\\mathrm{d}\\mathcal{H}^{n-1}(x) \\right) \\mathrm{d}t.\n$$\nIn our specific case, the domain is $\\Omega=B_R(0)$, the function is $f(x)=\\|x\\|$, and we take the integrand function to be $g(x)=1$. The integral becomes:\n$$\nJ(R,n) = \\int_{B_R(0)} 1 \\cdot |\\nabla \\|x\\|| \\,\\mathrm{d}\\mathcal{L}^n(x).\n$$\nThe range of values for $f(x)=\\|x\\|$ over the domain $B_R(0)$ is $[0, R]$. Thus, the outer integral over $t$ will be from $0$ to $R$. For any $t \\in [0, R]$, the level set is $f^{-1}(t)=\\{x \\in \\mathbb{R}^n : \\|x\\|=t\\}$, which is the $(n-1)$-dimensional sphere of radius $t$, denoted $S_t^{n-1}$. The intersection with the domain is $f^{-1}(t) \\cap B_R(0) = S_t^{n-1}$ for $t \\in (0, R]$ and $\\{0\\}$ for $t=0$.\n\nApplying the formula:\n$$\nJ(R,n) = \\int_{0}^{R} \\left( \\int_{S_t^{n-1}} 1 \\,\\mathrm{d}\\mathcal{H}^{n-1}(x) \\right) \\mathrm{d}t.\n$$\nThe inner integral is the $(n-1)$-dimensional Hausdorff measure (i.e., the surface area) of the sphere $S_t^{n-1}$. The surface area of an $(n-1)$-dimensional sphere of radius $r$ is given by the formula $A_{n-1}(r) = \\frac{2\\pi^{n/2}}{\\Gamma(n/2)}r^{n-1}$.\nFor our sphere $S_t^{n-1}$, the radius is $t$, so its surface area is:\n$$\n\\mathcal{H}^{n-1}(S_t^{n-1}) = \\frac{2\\pi^{n/2}}{\\Gamma(n/2)}t^{n-1}.\n$$\nSubstituting this into the outer integral, we get:\n$$\nJ(R,n) = \\int_{0}^{R} \\frac{2\\pi^{n/2}}{\\Gamma(n/2)}t^{n-1} \\mathrm{d}t.\n$$\nThe constant factor can be taken outside the integral:\n$$\nJ(R,n) = \\frac{2\\pi^{n/2}}{\\Gamma(n/2)} \\int_{0}^{R} t^{n-1} \\mathrm{d}t.\n$$\nWe evaluate the elementary integral:\n$$\n\\int_{0}^{R} t^{n-1} \\mathrm{d}t = \\left[ \\frac{t^n}{n} \\right]_0^R = \\frac{R^n}{n} - 0 = \\frac{R^n}{n}.\n$$\nFinally, we obtain the expression for $J(R,n)$:\n$$\nJ(R,n) = \\frac{2\\pi^{n/2}}{\\Gamma(n/2)} \\cdot \\frac{R^n}{n} = \\frac{2\\pi^{n/2}R^n}{n\\Gamma(n/2)}.\n$$\nThis result is consistent. From part (a), we know $|\\nabla f(x)|=1$ for almost every $x$. Thus, the integral $J(R,n)$ should be equal to the Lebesgue measure of the domain of integration, $B_R(0)$.\n$$\nJ(R,n) = \\int_{B_R(0)} 1 \\,\\mathrm{d}\\mathcal{L}^n(x) = \\mathcal{L}^n(B_R(0)).\n$$\nThe expression we derived, $\\frac{2\\pi^{n/2}R^n}{n\\Gamma(n/2)}$, is indeed the well-known formula for the volume of an $n$-dimensional ball of radius $R$. This can be seen by using the identity $\\Gamma(z+1)=z\\Gamma(z)$, which gives $n\\Gamma(n/2) = 2 \\cdot \\frac{n}{2}\\Gamma(\\frac{n}{2}) = 2\\Gamma(\\frac{n}{2}+1)$.\nSo, $J(R,n) = \\frac{2\\pi^{n/2}R^n}{2\\Gamma(n/2+1)} = \\frac{\\pi^{n/2}R^n}{\\Gamma(n/2+1)}$, which is the standard representation of the volume of the $n$-ball.", "answer": "$$\n\\boxed{\\frac{2\\pi^{n/2}R^n}{n\\Gamma(\\frac{n}{2})}}\n$$", "id": "3034561"}]}