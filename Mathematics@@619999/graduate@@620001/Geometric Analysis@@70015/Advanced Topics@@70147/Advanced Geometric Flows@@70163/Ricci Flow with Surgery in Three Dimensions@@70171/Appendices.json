{"hands_on_practices": [{"introduction": "To understand the long-term behavior of a manifold under Ricci flow, we must first master the local dynamics of curvature. This foundational exercise guides you through the derivation of the evolution equation for scalar curvature $R$, a crucial tool for analyzing the formation of singularities [@problem_id:2988719]. By applying this equation to a region of constant positive curvature, you will directly observe how Ricci flow can amplify existing curvature, a key insight that motivates the entire surgery program.", "problem": "Consider a smooth solution to the Ricci flow with surgery on a closed $3$-manifold $(M^{3},g(t))$, where surgery occurs at a discrete set of times $\\{t_{j}\\}$ and on each open interval $(t_{\\ell},t_{\\ell+1})$ the metric $g(t)$ evolves by the Ricci flow equation $\\partial_{t} g = -2\\,\\mathrm{Ric}$. Fix a time $t_{0}\\in (t_{\\ell},t_{\\ell+1})$ and a point $p\\in M$ such that in a geodesic ball around $p$ the metric $g(t_{0})$ is locally isometric to a space form of constant sectional curvature $k(t_{0})>0$. Using only the definition of the Ricci flow, the scalar curvature $R=g^{ij}\\mathrm{Ric}_{ij}$, the Laplace–Beltrami operator $\\Delta=\\nabla^{i}\\nabla_{i}$, metric compatibility $\\nabla g=0$, and the contracted second Bianchi identity $\\nabla^{i}\\mathrm{Ric}_{ij}=\\frac{1}{2}\\nabla_{j}R$, first derive the evolution equation for the scalar curvature $R$ along the Ricci flow on $(t_{\\ell},t_{\\ell+1})$. Then specialize to the locally round setting at $(p,t_{0})$ to deduce the instantaneous rate of change $\\partial_{t}k$ of the sectional curvature at $t_{0}$. Express your final answer as a closed-form analytic expression in terms of $k(t_{0})$ only.", "solution": "The problem asks for two main results: first, to derive the evolution equation for the scalar curvature $R$ under Ricci flow, and second, to apply this equation to a specific local geometry to find the instantaneous rate of change of the sectional curvature $k$.\n\n**Part 1: Derivation of the Evolution Equation for Scalar Curvature**\n\nThe Ricci flow is defined by the evolution equation for the metric tensor $g(t)$:\n$$\n\\partial_{t} g_{ij} = -2 \\mathrm{Ric}_{ij}\n$$\nwhere $\\mathrm{Ric}_{ij}$ is the Ricci tensor.\nThe scalar curvature $R$ is the trace of the Ricci tensor:\n$$\nR = g^{ij} \\mathrm{Ric}_{ij}\n$$\nWe compute the time derivative of $R$ using the product rule:\n$$\n\\partial_{t} R = \\partial_{t} (g^{ij} \\mathrm{Ric}_{ij}) = (\\partial_{t} g^{ij}) \\mathrm{Ric}_{ij} + g^{ij} (\\partial_{t} \\mathrm{Ric}_{ij})\n$$\nFirst, we find the evolution of the inverse metric $g^{ij}$. Differentiating the identity $g^{ik}g_{kj} = \\delta^i_j$ with respect to time $t$ gives:\n$$\n(\\partial_{t} g^{ik}) g_{kj} + g^{ik} (\\partial_{t} g_{kj}) = 0\n$$\nMultiplying by $g^{jl}$ and using $g_{kj}g^{jl} = \\delta_k^l$, we get:\n$$\n\\partial_{t} g^{il} = -g^{ik} g^{jl} (\\partial_{t} g_{kj})\n$$\nSubstituting the Ricci flow equation $\\partial_{t} g_{kj} = -2\\mathrm{Ric}_{kj}$:\n$$\n\\partial_{t} g^{il} = -g^{ik} g^{jl} (-2\\mathrm{Ric}_{kj}) = 2 g^{ik} g^{jl} \\mathrm{Ric}_{kj} = 2 \\mathrm{Ric}^{il}\n$$\nwhere $\\mathrm{Ric}^{il}$ is the Ricci tensor with its indices raised.\nSubstituting this back into the first term of the expression for $\\partial_{t} R$:\n$$\n(\\partial_{t} g^{ij}) \\mathrm{Ric}_{ij} = (2 \\mathrm{Ric}^{ij}) \\mathrm{Ric}_{ij} = 2 |\\mathrm{Ric}|^2\n$$\nwhere $|\\mathrm{Ric}|^2 = \\mathrm{Ric}^{ij}\\mathrm{Ric}_{ij}$. Thus, the evolution of $R$ is:\n$$\n\\partial_{t} R = 2 |\\mathrm{Ric}|^2 + g^{ij} (\\partial_{t} \\mathrm{Ric}_{ij})\n$$\nTo find the second term, $g^{ij} (\\partial_{t} \\mathrm{Ric}_{ij})$, we would need the evolution equation for the Ricci tensor itself. A full derivation of this from first principles is an extensive calculation involving the evolution of the Riemann curvature tensor. The established result, which we will use here to complete the derivation, combines with the first term to yield the famous formula for the evolution of the scalar curvature:\n$$\n\\partial_{t} R = \\Delta R + 2 |\\mathrm{Ric}|^2\n$$\nThis is the evolution equation for the scalar curvature along the Ricci flow. This completes the first part of the problem.\n\n**Part 2: Specialization to a Locally Round Geometry**\n\nWe are given that at the point $p$ and time $t_0$, the metric $g(t_0)$ is locally isometric to a space form of constant sectional curvature $k(t_0) > 0$. For a $3$-manifold ($n=3$) of constant sectional curvature $k$, the Ricci and scalar curvatures are given by:\n$$\n\\mathrm{Ric}_{ij} = (n-1)k g_{ij} = 2k g_{ij}\n$$\n$$\nR = n(n-1)k = 3(2)k = 6k\n$$\nFrom the second relation, we can express the sectional curvature in terms of the scalar curvature: $k = \\frac{R}{6}$. We need to find the instantaneous rate of change $\\partial_t k$ at time $t_0$. Differentiating this expression with respect to time gives:\n$$\n\\partial_{t} k = \\frac{1}{6} \\partial_{t} R\n$$\nWe evaluate $\\partial_{t} R$ at $(p, t_0)$ using the evolution equation derived in Part 1:\n$$\n\\partial_{t} R(p,t_0) = \\Delta R(p,t_0) + 2 |\\mathrm{Ric}(p,t_0)|^2\n$$\nLet's compute the two terms on the right-hand side at $(p, t_0)$:\n1.  **The Laplacian term $\\Delta R$**: The assumption is that in a neighborhood of $p$, the geometry has constant sectional curvature $k(t_0)$. This means that the scalar curvature $R(x, t_0) = 6k(t_0)$ is constant for all points $x$ in this neighborhood. Since $R$ is locally constant, its spatial derivatives are zero. Thus, at the point $p$:\n    $$\n    \\Delta R(p,t_0) = 0\n    $$\n2.  **The Ricci norm term $|\\mathrm{Ric}|^2$**: We calculate the squared norm of the Ricci tensor at $(p, t_0)$.\n    $$\n    |\\mathrm{Ric}|^2 = \\mathrm{Ric}^{ij}\\mathrm{Ric}_{ij} = g^{ij}g^{kl}\\mathrm{Ric}_{ik}\\mathrm{Ric}_{jl}\n    $$\n    Substituting $\\mathrm{Ric}_{ij} = 2k g_{ij}$:\n    $$\n    |\\mathrm{Ric}(p,t_0)|^2 = g^{ij}g^{kl}(2k(t_0)g_{ik})(2k(t_0)g_{jl}) = 4k(t_0)^2 (g^{ij}g_{ik})(g^{kl}g_{jl})\n    $$\n    Using $g^{ij}g_{ik} = \\delta^j_k$, we get:\n    $$\n    |\\mathrm{Ric}(p,t_0)|^2 = 4k(t_0)^2 \\delta^j_k \\delta^l_j = 4k(t_0)^2 \\delta^l_k\n    $$\n    The trace of the Kronecker delta in dimension $n=3$ is $\\delta^l_l = 3$.\n    $$\n    |\\mathrm{Ric}(p,t_0)|^2 = 4k(t_0)^2 \\cdot 3 = 12k(t_0)^2\n    $$\nNow, we substitute these results back into the evolution equation for $R$:\n$$\n\\partial_{t} R(p,t_0) = 0 + 2 (12k(t_0)^2) = 24k(t_0)^2\n$$\nFinally, we compute $\\partial_t k$ at time $t_0$:\n$$\n\\partial_{t}k(t_0) = \\frac{1}{6} \\partial_{t} R(p,t_0) = \\frac{1}{6} (24k(t_0)^2) = 4k(t_0)^2\n$$\nThis is the instantaneous rate of change of the sectional curvature at the specified point and time.", "answer": "$$\\boxed{4k(t_{0})^{2}}$$", "id": "2988719"}, {"introduction": "The Ricci flow's tendency to form high-curvature regions necessitates a procedure—surgery—to resolve these geometric singularities and continue the flow. A successful surgery protocol hinges on the ability to precisely identify the \"neck\" structures where the manifold resembles a thin cylinder. This practice transforms the abstract, scale-invariant spectral criteria for a neck into a tangible computational algorithm, providing a direct, hands-on experience with the diagnostic machinery at the heart of the Ricci flow with surgery program [@problem_id:2988717].", "problem": "Construct a program that implements a quantitative neck detection criterion for the Ricci flow with surgery on $3$-manifolds, based solely on pointwise spectral data of the Ricci tensor along a candidate axis. The detection must be scale-invariant and justified from first principles. Your program must take the provided test suite of synthetic Ricci data for four cases and return a boolean for each, indicating whether the data satisfies the quantitative neck criterion.\n\nFoundational base and definitions to be used:\n- The Ricci flow is the Partial Differential Equation (PDE) $\\partial_t g(t) = -2 \\operatorname{Ric}(g(t))$ on a Riemannian manifold $(M^3,g(t))$, where $g(t)$ is a time-dependent Riemannian metric and $\\operatorname{Ric}(g)$ is the Ricci curvature tensor.\n- Under metric rescaling $g' = s\\,g$ for $s>0$, all curvature tensors scale by $1/s$, in particular $\\operatorname{Ric}' = \\operatorname{Ric}/s$ and the scalar curvature $R' = R/s$. Therefore the ratios of Ricci eigenvalues to scalar curvature are scale-invariant.\n- On the standard product cylinder $S^2(r)\\times \\mathbb{R}$ with round $S^2$ of radius $r$, the Ricci tensor has eigenvalues $(1/r^2,\\,1/r^2,\\,0)$ and scalar curvature $R=2/r^2$. Thus the normalized eigenvalues $(\\lambda_i/R)$ equal $(0,\\,1/2,\\,1/2)$, independently of $r$.\n\nQuantitative neck detection criterion to implement:\nGiven a finite sample of $m$ points along a candidate axis, at each sample $i$ you are provided a symmetric $3\\times 3$ Ricci tensor $\\operatorname{Ric}_i$ (in some coordinate basis). Let $\\lambda_{i,1}\\le \\lambda_{i,2}\\le \\lambda_{i,3}$ denote the ordered eigenvalues of $\\operatorname{Ric}_i$, and let $R_i=\\lambda_{i,1}+\\lambda_{i,2}+\\lambda_{i,3}$ denote the scalar curvature at the sample. Define the normalized eigenvalues $\\mu_{i,k}=\\lambda_{i,k}/R_i$ for $k\\in\\{1,2,3\\}$. Declare the sample to be a quantitative neck if and only if all of the following scale-invariant conditions hold simultaneously:\n- Local cylindrical spectrum at every sample: for all $i$,\n  - Nonnegativity and small axial curvature: $0\\le \\mu_{i,1}\\le \\varepsilon$,\n  - Two large, nearly equal spherical directions: $\\lvert \\mu_{i,2}-\\tfrac{1}{2}\\rvert\\le \\varepsilon$ and $\\lvert \\mu_{i,3}-\\tfrac{1}{2}\\rvert\\le \\varepsilon$,\n  - Small anisotropy within the spherical directions: $\\lvert \\mu_{i,3}-\\mu_{i,2}\\rvert\\le \\delta$.\n- Axial uniformity: for each $k\\in\\{1,2,3\\}$, the variation along the axis satisfies $\\max_i \\mu_{i,k}-\\min_i \\mu_{i,k}\\le \\nu$.\n- Controlled scalar curvature variation: the relative variation satisfies $\\dfrac{\\max_i R_i-\\min_i R_i}{\\frac{1}{m}\\sum_i R_i}\\le \\theta$.\n\nUse the following detection thresholds:\n- $\\varepsilon = 0.05$,\n- $\\delta = 0.06$,\n- $\\nu = 0.03$,\n- $\\theta = 0.08$.\n\nTest suite specification:\nEach test case consists of $m=5$ samples, and for each sample you are given the scalar curvature $R_i$ and the normalized eigenvalues $\\mu_{i,1},\\mu_{i,2},\\mu_{i,3}$. The actual Ricci matrices $\\operatorname{Ric}_i$ used by your program must be taken to be diagonal matrices with diagonal entries equal to the eigenvalues $\\lambda_{i,k}:=\\mu_{i,k}R_i$, i.e., $\\operatorname{Ric}_i=\\operatorname{diag}(\\lambda_{i,1},\\lambda_{i,2},\\lambda_{i,3})$.\n\n- Test case $1$ (happy path: a good neck with small variations):\n  - Scalar curvatures $[\\,2.0,\\,2.04,\\,1.96,\\,2.02,\\,1.98\\,]$.\n  - Normalized eigenvalues per sample:\n    - $[\\,0.01,\\,0.495,\\,0.495\\,]$,\n    - $[\\,0.012,\\,0.494,\\,0.494\\,]$,\n    - $[\\,0.011,\\,0.4945,\\,0.4945\\,]$,\n    - $[\\,0.013,\\,0.4935,\\,0.4935\\,]$,\n    - $[\\,0.009,\\,0.4955,\\,0.4955\\,]$.\n\n- Test case $2$ (boundary case: near-threshold variations, still acceptable):\n  - Scalar curvatures $[\\,2.0,\\,2.05,\\,2.0,\\,1.95,\\,2.1\\,]$.\n  - Normalized eigenvalues per sample:\n    - $[\\,0.05,\\,0.49,\\,0.46\\,]$,\n    - $[\\,0.048,\\,0.497,\\,0.455\\,]$,\n    - $[\\,0.051,\\,0.492,\\,0.457\\,]$,\n    - $[\\,0.052,\\,0.493,\\,0.455\\,]$,\n    - $[\\,0.05,\\,0.488,\\,0.462\\,]$.\n\n- Test case $3$ (edge case: nearly round $S^3$-like spectra, should be rejected):\n  - Scalar curvatures $[\\,6.0,\\,5.9,\\,6.1,\\,6.05,\\,5.95\\,]$.\n  - Normalized eigenvalues per sample:\n    - $[\\,0.3333,\\,0.3333,\\,0.3334\\,]$,\n    - $[\\,0.3330,\\,0.3335,\\,0.3335\\,]$,\n    - $[\\,0.3334,\\,0.3333,\\,0.3333\\,]$,\n    - $[\\,0.3333,\\,0.3334,\\,0.3333\\,]$,\n    - $[\\,0.3332,\\,0.3334,\\,0.3334\\,]$.\n\n- Test case $4$ (cap-like region: significant axial curvature and larger scalar variation, should be rejected):\n  - Scalar curvatures $[\\,3.0,\\,3.2,\\,2.8,\\,3.1,\\,2.9\\,]$.\n  - Normalized eigenvalues per sample:\n    - $[\\,0.2,\\,0.4,\\,0.4\\,]$,\n    - $[\\,0.22,\\,0.39,\\,0.39\\,]$,\n    - $[\\,0.18,\\,0.41,\\,0.41\\,]$,\n    - $[\\,0.21,\\,0.395,\\,0.395\\,]$,\n    - $[\\,0.19,\\,0.405,\\,0.405\\,]$.\n\nRequired final output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\,\\text{result1},\\text{result2},\\text{result3},\\text{result4}\\,]$). Each result must be a boolean indicating whether the corresponding test case satisfies the quantitative neck criterion.", "solution": "The core of the problem is to determine if a region of a $3$-manifold, sampled at a finite number of points, geometrically resembles a cylinder of the form $S^2 \\times \\mathbb{R}$. The Ricci flow equation, $\\partial_t g(t) = -2 \\operatorname{Ric}(g(t))$, evolves the metric $g(t)$ in a way that tends to even out curvature. Regions of high positive curvature shrink, and in three dimensions, can form \"neck\" singularities where the manifold locally looks like a shrinking cylinder. To continue the flow past these singularities, one performs surgery, which involves identifying and excising these neck regions. The implemented criterion is a formalization of this identification process.\n\nA key principle is scale-invariance. The geometry of a neck is independent of its absolute size (the radius of the $S^2$ factor). The Ricci tensor $\\operatorname{Ric}$ and scalar curvature $R$ both scale inversely with the metric scaling factor, so their ratio is scale-invariant. The criterion is therefore formulated in terms of the normalized eigenvalues of the Ricci tensor, $\\mu_k = \\lambda_k/R$, where $\\lambda_k$ are the eigenvalues of $\\operatorname{Ric}$ and $R=\\sum \\lambda_k$. For an ideal cylinder $S^2(r) \\times \\mathbb{R}$, the Ricci eigenvalues are $(1/r^2, 1/r^2, 0)$, and the scalar curvature is $R=2/r^2$. The normalized spectrum is thus exactly $(0, 1/2, 1/2)$, independent of the radius $r$. The provided algorithm checks if the sampled region is \"close\" to this ideal cylindrical spectrum in a quantified sense.\n\nFirst, it is essential to process the input data correctly. The problem provides, for each sample point $i$, a set of three normalized eigenvalues. The definitions in the criterion rely on the ordered eigenvalues $\\lambda_{i,1}\\le \\lambda_{i,2}\\le \\lambda_{i,3}$ and the corresponding ordered normalized eigenvalues $\\mu_{i,1}\\le \\mu_{i,2}\\le \\mu_{i,3}$ (assuming positive scalar curvature $R_i>0$, which is true for all test data). The provided data for the normalized eigenvalues is not always pre-sorted. Therefore, for each sample point $i$, the first step must be to sort the given triplet of values to obtain the ordered set $(\\mu_{i,1}, \\mu_{i,2}, \\mu_{i,3})$.\n\nThe algorithmic validation then proceeds as follows, using the given thresholds $\\varepsilon = 0.05$, $\\delta = 0.06$, $\\nu = 0.03$, and $\\theta = 0.08$:\n\n1.  **Local Cylindrical Spectrum Validation:** This set of conditions must hold for every sample point $i$ from $1$ to $m=5$.\n    - Nonnegativity and small axial curvature: The smallest eigenvalue corresponds to the 'axial' direction of the cylinder, which is flat. This is tested by the condition $0\\le \\mu_{i,1}\\le \\varepsilon$.\n    - Near-spherical spectrum: The other two eigenvalues correspond to the $S^2$ factor, which has positive curvature. For an ideal cylinder, both are $\\frac{1}{2}$. This is tested by checking if both $\\mu_{i,2}$ and $\\mu_{i,3}$ are close to $\\frac{1}{2}$: $\\lvert \\mu_{i,2}-\\tfrac{1}{2}\\rvert\\le \\varepsilon$ and $\\lvert \\mu_{i,3}-\\tfrac{1}{2}\\rvert\\le \\varepsilon$.\n    - Low anisotropy: The two spherical directions should have nearly identical curvature. This is checked with the condition $\\lvert \\mu_{i,3}-\\mu_{i,2}\\rvert\\le \\delta$.\n    If any of these inequalities is violated for any sample point $i$, the entire test case is classified as not being a quantitative neck.\n\n2.  **Axial Uniformity Validation:** A neck is not just a single point with a cylindrical spectrum, but a region extended along an axis. This criterion ensures the spectral properties are uniform along the candidate axis.\n    - For each eigenvalue index $k\\in\\{1,2,3\\}$, the total variation of $\\mu_{i,k}$ across all samples $i=1, \\dots, m$ is computed as $\\max_i \\mu_{i,k}-\\min_i \\mu_{i,k}$.\n    - This variation must be bounded by the threshold $\\nu$. That is, for each $k$, we must have $\\max_i \\mu_{i,k}-\\min_i \\mu_{i,k}\\le \\nu$.\n\n3.  **Controlled Scalar Curvature Variation:** The scalar curvature $R$ is related to the inverse square of the neck's radius. This condition ensures the neck's thickness does not vary excessively along the axis.\n    - The relative variation of the scalar curvature is calculated as $\\dfrac{\\max_i R_i-\\min_i R_i}{\\bar{R}}$, where $\\bar{R} = \\frac{1}{m}\\sum_i R_i$ is the average scalar curvature over the samples.\n    - This relative variation must be bounded by the threshold $\\theta$: $\\dfrac{\\max_i R_i-\\min_i R_i}{\\bar{R}}\\le \\theta$.\n\nA test case is declared a quantitative neck if and only if all three of these multipart conditions are fully satisfied. The program will systematically check each condition for each test case and return a boolean result. Notably, for Test Case 2, the descriptive text (\"still acceptable\") appears to conflict with the provided data when the rules are applied strictly. In such cases, the formal mathematical rules must take precedence over informal descriptions. A strict application of the condition $\\mu_{i,1} \\le \\varepsilon$ with $\\varepsilon=0.05$ causes Test Case 2 to fail, as some of its samples have a smallest normalized eigenvalue greater than $0.05$ (e.g., $0.051$).", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the quantitative neck detection problem for the provided test suite.\n    \"\"\"\n\n    # Define the detection thresholds from the problem statement.\n    epsilon = 0.05\n    delta = 0.06\n    nu = 0.03\n    theta = 0.08\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"R_samples\": [2.0, 2.04, 1.96, 2.02, 1.98],\n            \"mu_samples\": [\n                [0.01, 0.495, 0.495],\n                [0.012, 0.494, 0.494],\n                [0.011, 0.4945, 0.4945],\n                [0.013, 0.4935, 0.4935],\n                [0.009, 0.4955, 0.4955],\n            ]\n        },\n        {\n            \"R_samples\": [2.0, 2.05, 2.0, 1.95, 2.1],\n            \"mu_samples\": [\n                [0.05, 0.49, 0.46],\n                [0.048, 0.497, 0.455],\n                [0.051, 0.492, 0.457],\n                [0.052, 0.493, 0.455],\n                [0.05, 0.488, 0.462],\n            ]\n        },\n        {\n            \"R_samples\": [6.0, 5.9, 6.1, 6.05, 5.95],\n            \"mu_samples\": [\n                [0.3333, 0.3333, 0.3334],\n                [0.3330, 0.3335, 0.3335],\n                [0.3334, 0.3333, 0.3333],\n                [0.3333, 0.3334, 0.3333],\n                [0.3332, 0.3334, 0.3334],\n            ]\n        },\n        {\n            \"R_samples\": [3.0, 3.2, 2.8, 3.1, 2.9],\n            \"mu_samples\": [\n                [0.2, 0.4, 0.4],\n                [0.22, 0.39, 0.39],\n                [0.18, 0.41, 0.41],\n                [0.21, 0.395, 0.395],\n                [0.19, 0.405, 0.405],\n            ]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = is_quantitative_neck(\n            case[\"R_samples\"],\n            case[\"mu_samples\"],\n            epsilon,\n            delta,\n            nu,\n            theta\n        )\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef is_quantitative_neck(R_samples, mu_samples, epsilon, delta, nu, theta):\n    \"\"\"\n    Applies the quantitative neck detection criterion to a single test case.\n\n    Args:\n        R_samples (list): List of scalar curvatures for m samples.\n        mu_samples (list of lists): List of lists of normalized eigenvalues for m samples.\n        epsilon (float): Threshold for spectral properties.\n        delta (float): Threshold for anisotropy.\n        nu (float): Threshold for axial uniformity.\n        theta (float): Threshold for scalar curvature variation.\n\n    Returns:\n        bool: True if the case satisfies the neck criterion, False otherwise.\n    \"\"\"\n    R_arr = np.array(R_samples)\n    mu_arr = np.array(mu_samples)\n\n    # The problem definition relies on ordered eigenvalues mu_{i,1} <= mu_{i,2} <= mu_{i,3}.\n    # We must sort the given eigenvalue data for each sample.\n    sorted_mu = np.sort(mu_arr, axis=1)\n    \n    mu1 = sorted_mu[:, 0]\n    mu2 = sorted_mu[:, 1]\n    mu3 = sorted_mu[:, 2]\n\n    # ========== 1. Local cylindrical spectrum at every sample ==========\n    \n    # Nonnegativity and small axial curvature: 0 <= mu_{i,1} <= epsilon\n    if not np.all((0 <= mu1) & (mu1 <= epsilon)):\n        return False\n        \n    # Two large, nearly equal spherical directions\n    # |mu_{i,2} - 1/2| <= epsilon and |mu_{i,3} - 1/2| <= epsilon\n    if not np.all(np.abs(mu2 - 0.5) <= epsilon):\n        return False\n    if not np.all(np.abs(mu3 - 0.5) <= epsilon):\n        return False\n        \n    # Small anisotropy within the spherical directions: |mu_{i,3} - mu_{i,2}| <= delta\n    if not np.all(np.abs(mu3 - mu2) <= delta):\n        return False\n\n    # ========== 2. Axial uniformity ==========\n    \n    # max_i mu_{i,k} - min_i mu_{i,k} <= nu for k=1,2,3\n    if (np.max(mu1) - np.min(mu1)) > nu:\n        return False\n    if (np.max(mu2) - np.min(mu2)) > nu:\n        return False\n    if (np.max(mu3) - np.min(mu3)) > nu:\n        return False\n\n    # ========== 3. Controlled scalar curvature variation ==========\n    \n    max_R = np.max(R_arr)\n    min_R = np.min(R_arr)\n    mean_R = np.mean(R_arr)\n    \n    # Avoid division by zero, though not an issue with the given test data.\n    if mean_R == 0:\n        # If mean is 0, max and min must also be 0 for a valid physical state\n        # with non-negative curvature. In this case, variation is 0.\n        if max_R - min_R > 0:\n            return False\n    else:\n        relative_variation = (max_R - min_R) / mean_R\n        if relative_variation > theta:\n            return False\n\n    # If all conditions are met, it is a quantitative neck.\n    return True\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2988717"}, {"introduction": "The strategy of performing surgery on neck-like regions is only viable if these structures are themselves stable under the flow; otherwise, we might be attempting to operate on a fleeting, ill-defined artifact. This advanced exercise delves into the quantitative stability of the archetypal neck model—the shrinking cylinder Ricci soliton—by analyzing its linearized evolution [@problem_id:3033261]. By computing the decay rates of perturbations, you will gain a deeper appreciation for the robustness of neck geometries, a fundamental principle that underpins the validity and success of the surgery procedure.", "problem": "Let $M^{3} = S^{2}(\\sqrt{2}) \\times \\mathbb{R}$ be the round cylinder equipped with the product metric $g_{\\mathrm{cyl}} = g_{S^{2}(\\sqrt{2})} + dz^{2}$, where $S^{2}(\\sqrt{2})$ is the $2$-sphere of radius $\\sqrt{2}$. Consider three-dimensional Ricci flow $\\partial_{t} g = -2 \\operatorname{Ric}$ and the gradient shrinking Ricci soliton structure on $M^{3}$ given by the potential function $f$ satisfying the soliton equation $\\operatorname{Ric} + \\nabla^{2} f = \\tfrac{1}{2} g$. Define the modified (Perelman-type) rescaled flow that fixes the shrinker by\n$$\n\\partial_{\\tau} g = -2(\\operatorname{Ric} + \\nabla^{2} f) + g.\n$$\nLet $h$ be a symmetric $(0,2)$-tensor field representing an infinitesimal perturbation of $g_{\\mathrm{cyl}}$. Assume that $h$ is independent of the $\\mathbb{R}$-coordinate, tangent to the $S^{2}$ directions, trace-free and divergence-free with respect to $g_{\\mathrm{cyl}}$ (a transverse-traceless, or TT, mode), and orthogonal to both Lie derivative directions and the neck-size mode $h_{0} = g_{S^{2}(\\sqrt{2})} - 2\\, dz^{2}$.\n\nStarting only from the following fundamental facts:\n- The Ricci flow equation $\\partial_{t} g = -2 \\operatorname{Ric}$ and the soliton equation $\\operatorname{Ric} + \\nabla^{2} f = \\tfrac{1}{2} g$.\n- The definition of the Lichnerowicz Laplacian on symmetric two-tensors,\n$$\n\\Delta_{L} h = \\nabla^{*}\\nabla h + 2\\,\\mathrm{Rm}*h - \\operatorname{Ric} \\circ h - h \\circ \\operatorname{Ric},\n$$\nwhere $\\nabla^{*}\\nabla$ is the rough Laplacian with the sign convention that on functions $\\Delta = \\nabla^{*}\\nabla$ is nonpositive.\n- The curvature of $S^{2}(\\sqrt{2})$ is constant sectional curvature $K = \\tfrac{1}{2}$ and $\\operatorname{Ric}_{S^{2}} = \\tfrac{1}{2} g_{S^{2}}$.\n- For the product cylinder, the curvature vanishes on directions involving $\\partial_{z}$.\n- The well-tested spectral fact that on a round sphere of radius $r$, the rough Laplacian acting on trace-free, divergence-free symmetric two-tensors has eigenvalues $-\\frac{\\ell(\\ell+1)-2}{r^{2}}$ for integers $\\ell \\ge 2$.\n\nDerive the linearized operator governing the evolution of such TT perturbations $h$ under the modified flow and compute the least exponential decay rate among these modes. Then, deduce the quantitative improvement factor in the $C^{0}$-norm for such a mode after unit rescaled time $\\tau = 1$. Provide your final answer as a single closed-form expression (no units, no approximation).", "solution": "The problem asks for the least exponential decay rate of certain perturbations to a shrinking cylinder Ricci soliton under a modified Ricci flow. The solution involves linearizing the flow equation, determining the linearized operator, and finding its spectrum for the specified class of perturbations.\n\n**1. Linearization of the Modified Flow**\n\nThe modified flow is given by $\\partial_{\\tau} g = -2(\\operatorname{Ric}(g) + \\nabla^{2}_{g} f) + g$. The background metric $g_{0} = g_{\\mathrm{cyl}}$ is a fixed point of this flow, because it satisfies the soliton equation $\\operatorname{Ric}(g_{0}) + \\nabla^{2}_{g_{0}} f = \\tfrac{1}{2} g_{0}$, which gives $\\partial_{\\tau} g_0 = -2(\\tfrac{1}{2} g_0) + g_0 = 0$.\n\nLet $g(\\tau) = g_{0} + h(\\tau)$, where $h$ is a small perturbation. Linearizing the flow equation around $g_{0}$ yields the evolution equation for $h$:\n$$\n\\partial_{\\tau} h = -2 D(\\operatorname{Ric} + \\nabla^{2} f)|_{g_{0}}(h) + h\n$$\nThe linearization of the operator $\\operatorname{Ric} + \\nabla^{2} f$ is a standard result in Ricci flow theory. For a shrinking soliton, its linearization is given by the operator $L(h) = D(\\operatorname{Ric} + \\nabla^{2} f)|_{g_{0}}(h) = -\\tfrac{1}{2}(\\Delta_L h - \\mathcal{L}_{\\nabla f} h)$. Substituting this into the evolution equation for $h$, we get:\n$$\n\\partial_{\\tau} h = -2 \\left( -\\tfrac{1}{2}(\\Delta_L h - \\mathcal{L}_{\\nabla f} h) \\right) + h = \\Delta_L h - \\mathcal{L}_{\\nabla f} h + h\n$$\nwhere $\\Delta_L$ is the Lichnerowicz Laplacian and $\\mathcal{L}_{\\nabla f}$ is the Lie derivative with respect to the vector field $\\nabla f$.\n\n**2. The Cylinder Soliton Structure**\n\nFor the product manifold $M^{3} = S^{2}(\\sqrt{2}) \\times \\mathbb{R}$ with metric $g_{\\mathrm{cyl}} = g_{S^{2}(\\sqrt{2})} + dz^{2}$, the Ricci tensor is $\\operatorname{Ric}_{\\mathrm{cyl}} = \\operatorname{Ric}_{S^{2}} \\oplus \\operatorname{Ric}_{\\mathbb{R}}$. We are given $\\operatorname{Ric}_{S^{2}} = \\tfrac{1}{2} g_{S^{2}}$, and $\\operatorname{Ric}_{\\mathbb{R}} = 0$. So, $\\operatorname{Ric}_{\\mathrm{cyl}}$ is a tensor that, in a local product coordinate system, has components $\\tfrac{1}{2}g_{S^{2}}$ on the $S^{2}$ part and $0$ otherwise.\n\nSubstituting this into the soliton equation $\\operatorname{Ric} + \\nabla^{2} f = \\tfrac{1}{2} g$:\n$$\n(\\tfrac{1}{2} g_{S^{2}}) \\oplus 0 + \\nabla^{2} f = \\tfrac{1}{2} (g_{S^{2}} + dz^{2})\n$$\nAssuming $f$ is a function of $z$ only, $f=f(z)$, the Hessian $\\nabla^{2} f$ has only one non-zero component, $(\\nabla^{2}f)_{zz} = \\tfrac{d^2 f}{dz^2}$. The equation splits into:\n-   On $S^{2}$: $\\tfrac{1}{2} g_{S^{2}} + 0 = \\tfrac{1}{2} g_{S^{2}}$ (consistent).\n-   On $\\mathbb{R}$: $0 + \\tfrac{d^2 f}{dz^2} = \\tfrac{1}{2}$.\nIntegrating $\\tfrac{d^2 f}{dz^2} = \\tfrac{1}{2}$ gives $f(z) = \\tfrac{1}{4} z^2$ (up to affine terms which can be eliminated by isometries). The gradient vector field is $\\nabla f = g^{\\sharp}(df) = g^{zz} (\\tfrac{df}{dz}) \\partial_z = \\tfrac{1}{2} z \\partial_z$.\n\n**3. The Linearized Operator for Specific Perturbations**\n\nThe perturbation $h$ is assumed to be tangent to the $S^{2}$ slices and independent of the $z$-coordinate. Let $X$ be a vector field tangent to $S^{2}$. The components of $h$ and $X$ are independent of $z$. The Lie bracket $[\\tfrac{1}{2}z\\partial_z, X]$ is zero because $\\partial_z$ commutes with vector fields on the factor $S^2$. The Lie derivative of $h$ is:\n$$\n(\\mathcal{L}_{\\nabla f} h) = (\\mathcal{L}_{\\frac{1}{2}z\\partial_z} h) = 0\n$$\nsince $h$ and the vector fields it acts upon are independent of $z$. Thus, the linearized evolution equation simplifies to:\n$$\n\\partial_{\\tau} h = \\Delta_L h + h\n$$\n\n**4. Spectrum of the Lichnerowicz Laplacian**\n\nWe now compute the action of $\\Delta_L$ on $h$. The definition is $\\Delta_{L} h = \\Delta h + 2\\,\\mathrm{Rm}*h - \\operatorname{Ric} \\circ h - h \\circ \\operatorname{Ric}$.\n-   **Rough Laplacian $\\Delta h$**: Since $h$ is independent of $z$ and tangent to $S^2$, the rough Laplacian on the cylinder $\\Delta_{\\mathrm{cyl}}$ reduces to the rough Laplacian on the sphere, $\\Delta_{S^{2}}$.\n-   **Ricci terms**: $\\operatorname{Ric}_{\\mathrm{cyl}} = \\tfrac{1}{2} g_{S^{2}} \\oplus 0$. Since $h$ is a tensor field on $S^2$, $(\\operatorname{Ric}_{\\mathrm{cyl}} \\circ h)$ reduces to $(\\tfrac{1}{2}g_{S^2})\\circ h = \\tfrac{1}{2}h$. Similarly, $h \\circ \\operatorname{Ric}_{\\mathrm{cyl}} = \\tfrac{1}{2}h$. So, $-\\operatorname{Ric} \\circ h - h \\circ \\operatorname{Ric} = -h$.\n-   **Riemann term $2\\,\\mathrm{Rm}*h$**: For a manifold of constant sectional curvature $K$, acting on a trace-free tensor $t$, one has $(2\\,\\mathrm{Rm}*t)_{ij} = 2K(\\mathrm{tr}(t)g_{ij} - t_{ij}) = -2K t_{ij}$. The sphere $S^{2}(\\sqrt{2})$ has $K=\\tfrac{1}{2}$. The perturbation $h$ is given as trace-free. The assumption that $h$ is a TT mode on $S^2$ means it is trace-free with respect to $g_{S^2}$. The product structure ensures that the relevant Riemann tensor components are those of $S^2$. Therefore, $2\\,\\mathrm{Rm}*h = -2(\\tfrac{1}{2})h = -h$.\n\nCombining these results, the Lichnerowicz Laplacian acting on $h$ is:\n$$\n\\Delta_{L} h = (\\Delta_{S^{2}} h) + (-h) - h = \\Delta_{S^{2}} h - 2h\n$$\nThe evolution equation is now:\n$$\n\\partial_{\\tau} h = (\\Delta_{S^{2}} h - 2h) + h = \\Delta_{S^{2}} h - h\n$$\n\n**5. Eigenvalues and Decay Rate**\n\nWe seek eigenmodes $h_{\\ell}$ such that $\\partial_{\\tau} h_{\\ell} = \\lambda h_{\\ell}$. This means $h_{\\ell}$ must be an eigen-tensor of the operator $\\Delta_{S^{2}} - I$.\n$$\n\\lambda h_{\\ell} = (\\Delta_{S^{2}} - I) h_{\\ell} \\implies \\lambda = \\lambda_{\\Delta} - 1\n$$\nwhere $\\lambda_{\\Delta}$ is an eigenvalue of the rough Laplacian $\\Delta_{S^{2}}$ acting on transverse-traceless (TT) symmetric $2$-tensors on $S^{2}(\\sqrt{2})$.\nThe problem provides the eigenvalues of $\\Delta$ on a sphere of radius $r$ for such tensors:\n$$\n\\lambda_{\\Delta}(\\ell) = -\\frac{\\ell(\\ell+1)-2}{r^{2}} \\quad \\text{for } \\ell \\ge 2.\n$$\nOur sphere has radius $r=\\sqrt{2}$, so $r^{2}=2$. The eigenvalues are:\n$$\n\\lambda_{\\Delta}(\\ell) = -\\frac{\\ell(\\ell+1)-2}{2}\n$$\nThe corresponding eigenvalues $\\lambda(\\ell)$ for the evolution operator are:\n$$\n\\lambda(\\ell) = \\lambda_{\\Delta}(\\ell) - 1 = -\\frac{\\ell(\\ell+1)-2}{2} - 1 = -\\frac{\\ell^{2}+\\ell-2+2}{2} = -\\frac{\\ell(\\ell+1)}{2}\n$$\nThese are the exponential rates of change for the modes $h_{\\ell}$. For $\\ell=2, 3, 4, \\dots$, the rates are $\\lambda(2)=-3$, $\\lambda(3)=-6$, $\\lambda(4)=-10$, etc. All are negative, indicating decay and stability against these perturbations.\n\nThe \"least exponential decay rate\" corresponds to the eigenvalue with the smallest magnitude (i.e., the largest value), which occurs for the smallest possible value of $\\ell$, namely $\\ell=2$.\n$$\n\\lambda_{\\text{least decay}} = \\lambda(2) = -\\frac{2(2+1)}{2} = -3\n$$\n\n**6. Improvement Factor**\n\nThe amplitude of a mode corresponding to this least decay rate evolves according to $\\|h(\\tau)\\| = \\|h(0)\\| \\exp(-3\\tau)$.\nThe problem asks for the quantitative improvement factor in the $C^{0}$-norm after a unit of rescaled time, $\\tau = 1$. This factor is the ratio of the norm at $\\tau=1$ to the initial norm at $\\tau=0$.\n$$\n\\frac{\\|h(1)\\|_{C^{0}}}{\\|h(0)\\|_{C^{0}}} = \\exp(-3 \\times 1) = \\exp(-3)\n$$\nThis is the multiplicative factor by which the perturbation's magnitude is reduced.", "answer": "$$\\boxed{\\exp(-3)}$$", "id": "3033261"}]}