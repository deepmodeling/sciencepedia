{"hands_on_practices": [{"introduction": "This practice connects the classical theory of Pell's equations to the geometric framework of Dirichlet's Unit Theorem. By explicitly computing the fundamental unit for the real quadratic field $\\mathbb{Q}(\\sqrt{13})$, you will bridge the algebraic solution of a Diophantine equation to its corresponding role as a generator of the unit lattice. This exercise provides a foundational, hands-on calculation of the regulator in a rank-one setting, making the abstract definitions tangible and illustrating the interplay between algebra and geometry. [@problem_id:3014824]", "problem": "Let $K=\\mathbb{Q}(\\sqrt{13})$ and let $\\mathcal{O}_{K}$ be its ring of integers. Consider the two real embeddings $\\sigma_{1},\\sigma_{2}:K\\hookrightarrow \\mathbb{R}$ given by $\\sigma_{1}(\\sqrt{13})=\\sqrt{13}$ and $\\sigma_{2}(\\sqrt{13})=-\\sqrt{13}$. Let $\\ell:\\mathcal{O}_{K}^{\\times}\\to\\mathbb{R}^{2}$ be the logarithmic embedding defined by $\\ell(u)=\\big(\\ln|\\sigma_{1}(u)|,\\ln|\\sigma_{2}(u)|\\big)$. Using only the definition of the norm, the product formula, and the structure theorem for the unit group given by the Dirichlet unit theorem, do the following:\n\n1. Determine a fundamental unit $\\varepsilon\\in\\mathcal{O}_{K}^{\\times}$ with $\\varepsilon>1$ under the embedding $\\sigma_{1}$ by solving the appropriate Pell-type norm equation arising from the condition $|N_{K/\\mathbb{Q}}(\\varepsilon)|=1$.\n\n2. Form the column vector $v=\\ell(\\varepsilon)\\in\\mathbb{R}^{2}$ and construct the Gram matrix $G$ of the rank-$1$ unit lattice in the hyperplane $\\{(x_{1},x_{2})\\in\\mathbb{R}^{2}:x_{1}+x_{2}=0\\}$ with respect to the standard Euclidean inner product, that is, $G=\\big(\\langle v,v\\rangle\\big)$.\n\n3. Compute $\\det(G)$ in closed form and, using the determinant characterization of the regulator via any $r\\times r$ minor of the logarithm matrix (with $r$ the unit rank), verify the identity $\\det(G)=\\sum \\text{(all }r\\times r\\text{ minors)}^{2}$ in this setting to reconcile your Gram-matrix computation with the regulator obtained from a determinant of a square submatrix. Conclude the exact value of the regulator $R_{K}$.\n\nGive your final answer as a single exact expression for $R_{K}$, in terms of the natural logarithm. Do not approximate; no rounding is required.", "solution": "The user wants me to solve a problem in algebraic number theory. I will first validate the problem statement.\n\n### Step 1: Extract Givens\n-   The number field is $K = \\mathbb{Q}(\\sqrt{13})$.\n-   $\\mathcal{O}_{K}$ is the ring of integers of $K$.\n-   The real embeddings are $\\sigma_{1}, \\sigma_{2}: K \\hookrightarrow \\mathbb{R}$, defined by $\\sigma_{1}(\\sqrt{13}) = \\sqrt{13}$ and $\\sigma_{2}(\\sqrt{13}) = -\\sqrt{13}$.\n-   The logarithmic embedding is $\\ell: \\mathcal{O}_{K}^{\\times} \\to \\mathbb{R}^{2}$ defined by $\\ell(u) = \\big(\\ln|\\sigma_{1}(u)|, \\ln|\\sigma_{2}(u)|\\big)$.\n-   The unit rank is $r=1$ (since $r_1=2, r_2=0$, $r=r_1+r_2-1=1$).\n-   The problem requires a three-part solution:\n    1.  Find the fundamental unit $\\varepsilon > 1$ by solving a Pell-type equation.\n    2.  Construct the Gram matrix $G$ of the lattice basis vector $v = \\ell(\\varepsilon)$.\n    3.  Compute $\\det(G)$, verify an identity relating it to minors of the logarithm matrix, and conclude the value of the regulator $R_K$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria:\n-   **Scientifically Grounded:** The problem deals with standard, well-established concepts in algebraic number theory, including quadratic number fields, rings of integers, embeddings, Dirichlet's unit theorem, and the regulator. All definitions and relationships are standard. The problem is scientifically sound.\n-   **Well-Posed:** The problem is structured with a clear set of tasks leading to a unique, well-defined result. For a given real quadratic field, the fundamental unit and regulator are unique quantities. The steps are logical and self-contained.\n-   **Objective:** The language is formal, precise, and mathematical, free from any subjective or ambiguous terminology.\n\nThe problem does not exhibit any of the invalidity flaws. It is a standard exercise in computational algebraic number theory.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will proceed with a full solution.\n\n### Part 1: Determination of the Fundamental Unit\n\nThe number field is $K = \\mathbb{Q}(\\sqrt{d})$ with $d=13$. Since $13 \\equiv 1 \\pmod{4}$, the ring of integers is $\\mathcal{O}_{K} = \\mathbb{Z}\\left[\\frac{1+\\sqrt{13}}{2}\\right]$. An arbitrary element $\\alpha \\in \\mathcal{O}_{K}$ can be written as $\\alpha = \\frac{a+b\\sqrt{13}}{2}$ for integers $a, b \\in \\mathbb{Z}$ such that $a \\equiv b \\pmod{2}$.\n\nThe norm of such an element is given by $N_{K/\\mathbb{Q}}(\\alpha) = \\frac{a^2 - 13b^2}{4}$. An element $\\alpha$ is a unit in $\\mathcal{O}_{K}^{\\times}$ if and only if its norm is $\\pm 1$. This leads to the Pell-type equation:\n$$a^2 - 13b^2 = \\pm 4$$\nWe seek the fundamental unit $\\varepsilon > 1$. This corresponds to finding the smallest positive integer solution $(a, b)$ to this equation. We test values for $b \\ge 1$.\n\nFor $b=1$:\n$a^2 - 13(1)^2 = a^2 - 13 = \\pm 4$.\n-   Case 1: $a^2 - 13 = 4 \\implies a^2 = 17$. No integer solution for $a$.\n-   Case 2: $a^2 - 13 = -4 \\implies a^2 = 9 \\implies a = 3$ (we seek $a>0$).\n\nWe have found the solution $(a,b) = (3,1)$. We must check the condition $a \\equiv b \\pmod{2}$. $3 \\equiv 1 \\pmod{2}$ is true, since $3-1=2$ is an even integer.\nThus, the element corresponding to this solution is $\\varepsilon = \\frac{3+\\sqrt{13}}{2}$.\n\nUnder the embedding $\\sigma_{1}$, we have $\\sigma_{1}(\\varepsilon) = \\frac{3+\\sqrt{13}}{2}$. Since $3 < \\sqrt{13} < 4$, we have $\\frac{3+3}{2} < \\sigma_{1}(\\varepsilon) < \\frac{3+4}{2}$, so $3 < \\sigma_{1}(\\varepsilon) < 3.5$. This value is greater than $1$.\nBecause we found the smallest positive integer solution $(a,b)$ for the Pell-type equation, $\\varepsilon = \\frac{3+\\sqrt{13}}{2}$ is the fundamental unit of $K$ satisfying $\\varepsilon>1$.\n\nThe norm of this unit is $N(\\varepsilon) = \\frac{3^2 - 13(1^2)}{4} = \\frac{9-13}{4} = -1$.\n\n### Part 2: Construction of the Gram Matrix\n\nThe logarithmic embedding of the fundamental unit $\\varepsilon$ is the vector $v = \\ell(\\varepsilon) \\in \\mathbb{R}^2$.\n$$v = \\big(\\ln|\\sigma_{1}(\\varepsilon)|, \\ln|\\sigma_{2}(\\varepsilon)|\\big)$$\nThe embeddings of $\\varepsilon$ are:\n-   $\\sigma_{1}(\\varepsilon) = \\frac{3+\\sqrt{13}}{2} > 0$\n-   $\\sigma_{2}(\\varepsilon) = \\frac{3-\\sqrt{13}}{2} < 0$\n\nThus, the components of $v$ are:\n-   $\\ln|\\sigma_{1}(\\varepsilon)| = \\ln\\left(\\frac{3+\\sqrt{13}}{2}\\right)$\n-   $\\ln|\\sigma_{2}(\\varepsilon)| = \\ln\\left|\\frac{3-\\sqrt{13}}{2}\\right| = \\ln\\left(\\frac{\\sqrt{13}-3}{2}\\right)$\n\nNote that $\\left(\\frac{3+\\sqrt{13}}{2}\\right) \\left(\\frac{\\sqrt{13}-3}{2}\\right) = \\frac{13-9}{4} = 1$. This implies that $\\ln\\left(\\frac{\\sqrt{13}-3}{2}\\right) = -\\ln\\left(\\frac{3+\\sqrt{13}}{2}\\right)$.\nLet $x = \\ln\\left(\\frac{3+\\sqrt{13}}{2}\\right)$. Then the vector is $v = (x, -x)$.\n\nThe rank of the unit group is $r=1$, so the lattice of units (modulo roots of unity) is generated by the single vector $v$. The Gram matrix $G$ is a $1 \\times 1$ matrix whose entry is the inner product of the basis vector with itself.\n$$G = \\big(\\langle v, v\\rangle\\big)$$\nUsing the standard Euclidean inner product on $\\mathbb{R}^2$:\n$$\\langle v, v\\rangle = (x)^2 + (-x)^2 = 2x^2 = 2\\left[\\ln\\left(\\frac{3+\\sqrt{13}}{2}\\right)\\right]^2$$\nSo, the Gram matrix is:\n$$G = \\left(2\\left[\\ln\\left(\\frac{3+\\sqrt{13}}{2}\\right)\\right]^2\\right)$$\n\n### Part 3: Regulator Calculation and Identity Verification\n\nThe determinant of the $1 \\times 1$ matrix $G$ is simply its entry:\n$$\\det(G) = 2\\left[\\ln\\left(\\frac{3+\\sqrt{13}}{2}\\right)\\right]^2$$\n\nThe problem asks to verify the identity $\\det(G) = \\sum (\\text{all } r \\times r \\text{ minors})^2$.\nThe unit rank is $r=1$. The logarithm matrix is the $r \\times (r_1+r_2) = 1 \\times 2$ matrix whose single row is $v^T$:\n$$L = \\begin{pmatrix} \\ln|\\sigma_{1}(\\varepsilon)| & \\ln|\\sigma_{2}(\\varepsilon)| \\end{pmatrix} = \\begin{pmatrix} x & -x \\end{pmatrix}$$\nThe $r \\times r = 1 \\times 1$ minors of $L$ are its entries:\n-   Minor 1: $m_1 = x = \\ln\\left(\\frac{3+\\sqrt{13}}{2}\\right)$\n-   Minor 2: $m_2 = -x = -\\ln\\left(\\frac{3+\\sqrt{13}}{2}\\right)$\n\nThe sum of the squares of these minors is:\n$$\\sum (\\text{minors})^2 = m_1^2 + m_2^2 = (x)^2 + (-x)^2 = 2x^2 = 2\\left[\\ln\\left(\\frac{3+\\sqrt{13}}{2}\\right)\\right]^2$$\nThis is equal to $\\det(G)$, so the identity is verified. This identity is a special case of the Cauchy-Binet formula, as $\\det(G) = \\det(L L^T)$.\n\nFinally, we conclude the value of the regulator $R_K$. There are two common, equivalent definitions.\n1.  The regulator is the absolute value of the determinant of any $r \\times r$ minor of the logarithm matrix $L$. For $r=1$, we can choose the first minor:\n    $$R_K = |m_1| = \\left|\\ln\\left(\\frac{3+\\sqrt{13}}{2}\\right)\\right|$$\n    Since $\\frac{3+\\sqrt{13}}{2} > 1$, its natural logarithm is positive. So, $R_K = \\ln\\left(\\frac{3+\\sqrt{13}}{2}\\right)$.\n\n2.  The regulator is the volume of the fundamental domain of the lattice $\\ell(\\mathcal{O}_K^\\times)$ in the trace-zero hyperplane $H = \\{(x_1, x_2) \\in \\mathbb{R}^2 : x_1+x_2=0\\}$. The squared volume is given by the formula $R_K^2 = \\frac{1}{r_1+r_2}\\det(G)$.\n    With $r_1+r_2=2$ and our calculated $\\det(G)$:\n    $$R_K^2 = \\frac{1}{2} \\det(G) = \\frac{1}{2} \\left(2\\left[\\ln\\left(\\frac{3+\\sqrt{13}}{2}\\right)\\right]^2\\right) = \\left[\\ln\\left(\\frac{3+\\sqrt{13}}{2}\\right)\\right]^2$$\n    Taking the positive square root (as regulators are positive by convention):\n    $$R_K = \\ln\\left(\\frac{3+\\sqrt{13}}{2}\\right)$$\nBoth definitions yield the same result, confirming the value of the regulator.", "answer": "$$\\boxed{\\ln\\left(\\frac{3+\\sqrt{13}}{2}\\right)}$$", "id": "3014824"}, {"introduction": "Once a unit is found, a critical next step is to determine if it is a fundamental unit or merely a power of one. This exercise develops a practical criterion for answering this question by relating the algebraic structure of the unit group to analytic quantities like the logarithmic embedding and the Weil height. Applying this test to a specific unit in $\\mathbb{Q}(\\sqrt{2})$ will solidify your understanding of the discrete nature of the unit lattice and the role of its generators. [@problem_id:3014806]", "problem": "Let $K = \\mathbb{Q}(\\sqrt{2})$ and let $\\sigma_{1}, \\sigma_{2} : K \\hookrightarrow \\mathbb{R}$ denote the two real embeddings given by $\\sigma_{1}(\\sqrt{2}) = \\sqrt{2}$ and $\\sigma_{2}(\\sqrt{2}) = -\\sqrt{2}$. For $\\alpha \\in K^{\\times}$, write $\\ell(\\alpha) = \\left(\\ln|\\sigma_{1}(\\alpha)|, \\ln|\\sigma_{2}(\\alpha)|\\right) \\in \\mathbb{R}^{2}$. Recall the product formula that for any unit $u \\in \\mathcal{O}_{K}^{\\times}$, one has $\\ln|\\sigma_{1}(u)| + \\ln|\\sigma_{2}(u)| = 0$. Let $\\epsilon \\in \\mathcal{O}_{K}^{\\times}$ be a generator of the free part of the unit group of $K$, so that every unit $u \\in \\mathcal{O}_{K}^{\\times}$ can be written as $u = \\zeta \\epsilon^{m}$ for some root of unity $\\zeta$ and integer $m$. Define the absolute logarithmic Weil height (ALWH) $h(\\alpha)$ of an algebraic number $\\alpha$ by\n$$\nh(\\alpha) = \\frac{1}{[K : \\mathbb{Q}]} \\sum_{v} n_{v} \\ln\\left(\\max\\{1, |\\alpha|_{v}\\}\\right),\n$$\nwhere the sum runs over all places $v$ of $K$, $n_{v}$ is the local degree at $v$, and $|\\cdot|_{v}$ is the $v$-adic absolute value.\n\nStarting from these definitions and facts, derive a criterion—expressed in terms of the embedding vector $\\ell(u)$ and the height $h(u)$—to decide whether a unit $u \\in \\mathcal{O}_{K}^{\\times}$ is a proper power in $\\mathcal{O}_{K}^{\\times}$, and to recover the exponent $m$ when $u = \\pm \\epsilon^{m}$. Then apply your criterion to the explicit unit $u = 7 + 5\\sqrt{2}$ in $K = \\mathbb{Q}(\\sqrt{2})$, taking $\\epsilon = 1 + \\sqrt{2}$ as a chosen generator of the free part of $\\mathcal{O}_{K}^{\\times}$. Determine the integer $m$ such that $u = \\pm \\epsilon^{m}$. Your final answer must be this integer $m$. No rounding is required.", "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- Field: $K = \\mathbb{Q}(\\sqrt{2})$.\n- Embeddings: $\\sigma_{1}, \\sigma_{2} : K \\hookrightarrow \\mathbb{R}$ defined by $\\sigma_{1}(\\sqrt{2}) = \\sqrt{2}$ and $\\sigma_{2}(\\sqrt{2}) = -\\sqrt{2}$.\n- Logarithmic embedding: For $\\alpha \\in K^{\\times}$, $\\ell(\\alpha) = \\left(\\ln|\\sigma_{1}(\\alpha)|, \\ln|\\sigma_{2}(\\alpha)|\\right) \\in \\mathbb{R}^{2}$.\n- Product formula for units: For any unit $u \\in \\mathcal{O}_{K}^{\\times}$, $\\ln|\\sigma_{1}(u)| + \\ln|\\sigma_{2}(u)| = 0$.\n- Unit group structure: Every unit $u \\in \\mathcal{O}_{K}^{\\times}$ can be written as $u = \\zeta \\epsilon^{m}$ for a root of unity $\\zeta$ and an integer $m$, where $\\epsilon$ is a generator of the free part of $\\mathcal{O}_{K}^{\\times}$.\n- Absolute Logarithmic Weil Height (ALWH): $h(\\alpha) = \\frac{1}{[K : \\mathbb{Q}]} \\sum_{v} n_{v} \\ln\\left(\\max\\{1, |\\alpha|_{v}\\}\\right)$.\n- Specific unit: $u = 7 + 5\\sqrt{2}$.\n- Specific generator: $\\epsilon = 1 + \\sqrt{2}$.\n- Task: Derive a criterion for a unit to be a proper power using $\\ell(u)$ and $h(u)$, and apply it to find the integer $m$ such that $u = \\pm \\epsilon^{m}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is set within the established framework of algebraic number theory. The field $K=\\mathbb{Q}(\\sqrt{2})$, its unit group structure, the definition of the Weil height, and the logarithmic embedding are all standard and well-defined concepts. The problem is self-contained, providing all necessary definitions and data. The objective is clear and formalizable. The values given for the unit $u$ and the generator $\\epsilon$ are valid elements of the ring of integers $\\mathcal{O}_{K} = \\mathbb{Z}[\\sqrt{2}]$. The problem is scientifically grounded, well-posed, and objective.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Derivation of the Criterion\n\nLet $K = \\mathbb{Q}(\\sqrt{2})$. The ring of integers is $\\mathcal{O}_K = \\mathbb{Z}[\\sqrt{2}]$. The only roots of unity in $K$ are $\\zeta \\in \\{-1, 1\\}$. By Dirichlet's Unit Theorem, the group of units $\\mathcal{O}_{K}^{\\times}$ is of the form $\\mathcal{O}_{K}^{\\times} = \\{ \\pm \\epsilon^{m} \\mid m \\in \\mathbb{Z} \\}$, where $\\epsilon$ is a fundamental unit (a generator of the free part of the group).\n\nLet $u \\in \\mathcal{O}_{K}^{\\times}$. Then $u$ can be written as $u = \\pm\\epsilon^m$ for a unique integer $m$. We are tasked with relating $m$ to the logarithmic embedding $\\ell(u)$ and the height $h(u)$.\n\nThe logarithmic embedding is $\\ell(u) = (\\ln|\\sigma_1(u)|, \\ln|\\sigma_2(u)|)$.\nSince $u = \\pm\\epsilon^m$, for each embedding $\\sigma_i$ ($i \\in \\{1, 2\\}$), we have:\n$|\\sigma_i(u)| = |\\sigma_i(\\pm \\epsilon^m)| = |\\sigma_i(\\epsilon^m)| = |\\sigma_i(\\epsilon)|^m$.\nTaking the natural logarithm of both sides gives:\n$\\ln|\\sigma_i(u)| = m \\ln|\\sigma_i(\\epsilon)|$.\nThis holds for $i=1$ and $i=2$. In vector form, this is expressed as:\n$\\ell(u) = m \\ell(\\epsilon)$.\nSince $\\epsilon$ is a fundamental unit, it is not a root of unity, so $\\ell(\\epsilon) \\neq (0,0)$. Thus, we can recover $m$ as the ratio of the corresponding components of the vectors $\\ell(u)$ and $\\ell(\\epsilon)$:\n$m = \\frac{\\ln|\\sigma_1(u)|}{\\ln|\\sigma_1(\\epsilon)|} = \\frac{\\ln|\\sigma_2(u)|}{\\ln|\\sigma_2(\\epsilon)|}$.\n\nA unit $u$ is a proper power in $\\mathcal{O}_{K}^{\\times}$ if there exists a unit $v \\in \\mathcal{O}_{K}^{\\times}$ and an integer $k > 1$ such that $u = v^k$. If we write $v = \\pm\\epsilon^j$, then $u = (\\pm\\epsilon^j)^k$, which implies $u = \\pm\\epsilon^{jk}$. Comparing with $u=\\pm\\epsilon^m$, we get $m=jk$. This means $k$ must be a divisor of $m$. Therefore, $u$ is a proper power if and only if the integer $m$ obtained from the ratio above has a divisor $k>1$, which is equivalent to $|m|>1$.\nThe criterion based on the embedding vector is: A unit $u$ is a proper power if and only if the ratio $\\frac{\\ln|\\sigma_1(u)|}{\\ln|\\sigma_1(\\epsilon)|}$ is an integer $m$ with $|m| > 1$.\n\nNow, we connect this to the Absolute Logarithmic Weil Height $h(u)$. The degree of the extension is $[K:\\mathbb{Q}]=2$. For a unit $u$, the $v$-adic absolute value $|u|_v$ is $1$ for all finite places $v$ (corresponding to prime ideals of $\\mathcal{O}_K$). Thus, the sum for the height only receives contributions from the two infinite (real) places, for which the local degree $n_v$ is $1$:\n$h(u) = \\frac{1}{2} \\left( \\ln(\\max\\{1, |\\sigma_1(u)|\\}) + \\ln(\\max\\{1, |\\sigma_2(u)|\\}) \\right)$.\nThe product formula for units states $|N(u)|=|\\sigma_1(u)\\sigma_2(u)|=1$, which implies $|\\sigma_2(u)| = 1/|\\sigma_1(u)|$.\nLet's choose the generator $\\epsilon$ such that $|\\sigma_1(\\epsilon)| > 1$. Then $|\\sigma_2(\\epsilon)| < 1$.\nIf $m > 0$, then $|\\sigma_1(u)| = |\\sigma_1(\\epsilon)|^m > 1$ and $|\\sigma_2(u)| < 1$. The height becomes:\n$h(u) = \\frac{1}{2} \\left( \\ln|\\sigma_1(u)| + \\ln(1) \\right) = \\frac{1}{2} \\ln|\\sigma_1(u)|$.\nIf $m < 0$, say $m = -k$ for $k>0$, then $|\\sigma_1(u)| = |\\sigma_1(\\epsilon)|^{-k} < 1$ and $|\\sigma_2(u)| > 1$. The height becomes:\n$h(u) = \\frac{1}{2} \\left( \\ln(1) + \\ln|\\sigma_2(u)| \\right) = \\frac{1}{2} \\ln|\\sigma_2(u)| = \\frac{1}{2} \\ln\\left(\\frac{1}{|\\sigma_1(u)|}\\right) = -\\frac{1}{2} \\ln|\\sigma_1(u)|$.\nIf $m=0$, $u=\\pm 1$, $|\\sigma_1(u)|=1$, so $h(u)=0$.\nThese cases can be combined into a single expression:\n$h(u) = \\frac{1}{2} |\\ln|\\sigma_1(u)||$.\nApplying this to $u$ and $\\epsilon$:\n$h(u) = \\frac{1}{2} |\\ln|\\sigma_1(u)|| = \\frac{1}{2} |m \\ln|\\sigma_1(\\epsilon)|| = |m| \\cdot \\left(\\frac{1}{2} |\\ln|\\sigma_1(\\epsilon)||\\right) = |m|h(\\epsilon)$.\nThis gives a relationship between the heights: $|m| = \\frac{h(u)}{h(\\epsilon)}$.\nThe criterion based on height is: A unit $u$ is a proper power if and only if the ratio $h(u)/h(\\epsilon)$ is an integer greater than $1$.\nThe exponent $m$ is then recovered by finding its magnitude $|m| = h(u)/h(\\epsilon)$ and its sign. The sign of $m$ is the same as the sign of $\\ln|\\sigma_1(u)|$, assuming $\\epsilon$ is chosen so that $\\ln|\\sigma_1(\\epsilon)| > 0$. Thus, $m = \\text{sgn}(\\ln|\\sigma_1(u)|) \\frac{h(u)}{h(\\epsilon)}$.\n\n### Application to the Specific Unit\n\nWe are given the unit $u = 7 + 5\\sqrt{2}$ and the fundamental unit $\\epsilon = 1 + \\sqrt{2}$.\nFirst, we verify that $u$ is a unit in $\\mathcal{O}_K = \\mathbb{Z}[\\sqrt{2}]$ by computing its norm:\n$N(u) = N(7 + 5\\sqrt{2}) = 7^2 - 2 \\cdot (5)^2 = 49 - 2 \\cdot 25 = 49 - 50 = -1$.\nSince the norm is $\\pm 1$, $u$ is indeed a unit.\n\nWe apply the first derived criterion to find $m$:\n$m = \\frac{\\ln|\\sigma_1(u)|}{\\ln|\\sigma_1(\\epsilon)|}$.\nThe embedding $\\sigma_1$ is the identity on $K$, so $\\sigma_1(u) = u$ and $\\sigma_1(\\epsilon)=\\epsilon$.\n$\\sigma_1(u) = 7 + 5\\sqrt{2}$. Since $7 > 0$ and $5\\sqrt{2} > 0$, this value is positive.\n$\\sigma_1(\\epsilon) = 1 + \\sqrt{2}$. This value is also positive.\nThus, $|\\sigma_1(u)| = 7 + 5\\sqrt{2}$ and $|\\sigma_1(\\epsilon)| = 1 + \\sqrt{2}$.\nThe exponent $m$ is given by:\n$m = \\frac{\\ln(7 + 5\\sqrt{2})}{\\ln(1 + \\sqrt{2})}$.\nTo evaluate this expression, we test if $7 + 5\\sqrt{2}$ is an integer power of $1+\\sqrt{2}$. We compute the first few powers of $\\epsilon$:\n$\\epsilon^1 = 1 + \\sqrt{2}$.\n$\\epsilon^2 = (1 + \\sqrt{2})^2 = 1^2 + 2(1)(\\sqrt{2}) + (\\sqrt{2})^2 = 1 + 2\\sqrt{2} + 2 = 3 + 2\\sqrt{2}$.\n$\\epsilon^3 = \\epsilon^2 \\cdot \\epsilon = (3 + 2\\sqrt{2})(1 + \\sqrt{2}) = 3(1) + 3\\sqrt{2} + 2\\sqrt{2}(1) + 2\\sqrt{2}(\\sqrt{2}) = 3 + 5\\sqrt{2} + 4 = 7 + 5\\sqrt{2}$.\nWe have found that $u = \\epsilon^3$.\nThis confirms that $u$ is a proper power (a cube).\nSubstituting this into the expression for $m$:\n$m = \\frac{\\ln(\\epsilon^3)}{\\ln(\\epsilon)} = \\frac{3 \\ln(\\epsilon)}{\\ln(\\epsilon)} = 3$.\nThe integer $m$ such that $u = \\pm \\epsilon^m$ is $3$. Since $u = \\epsilon^3$, the sign is positive. The criterion confirms that $u$ is a proper power, as $|m| = 3 > 1$. The recovered exponent is $m=3$.", "answer": "$$\\boxed{3}$$", "id": "3014806"}, {"introduction": "Let's now move to a more complex scenario involving a number field with a higher-rank unit group, which necessitates a computational approach. This practice guides you through estimating the regulator for a quartic field with both real and complex embeddings, where the unit rank is two. By working with several candidate units, you will not only apply the regulator formula but also learn to numerically verify the crucial property of multiplicative independence, which is equivalent to linear independence in the logarithmic space. [@problem_id:3014835]", "problem": "Consider the quartic number field $K = \\mathbb{Q}(\\theta)$ where $\\theta$ is a real root of the monic polynomial $f(x) = x^4 - x - 1 \\in \\mathbb{Z}[x]$. The goal is to compute explicit independent units and estimate the regulator numerically by first principles. Your program must implement and use the following foundational definitions and facts:\n\n1. The algebraic number field $K = \\mathbb{Q}(\\theta)$ has field embeddings into $\\mathbb{C}$ given by sending $\\theta$ to each complex root of $f(x)$. The roots are written as $\\alpha_1, \\alpha_2 \\in \\mathbb{R}$ and $\\alpha_3, \\overline{\\alpha_3} \\in \\mathbb{C} \\setminus \\mathbb{R}$. The signature of $K$ is $(r_1, r_2) = (2, 1)$, where $r_1$ is the number of real embeddings and $r_2$ is the number of pairs of complex embeddings.\n\n2. For any algebraic integer $u \\in \\mathcal{O}_K$, the (absolute) field norm is defined by $|N_{K/\\mathbb{Q}}(u)| = \\prod_{i=1}^{r_1} |\\sigma_i(u)| \\cdot \\prod_{j=1}^{r_2} |\\tau_j(u)|^2$, where $\\sigma_i$ are real embeddings and $\\tau_j$ are complex embeddings (one from each conjugate pair). An element $u \\in \\mathcal{O}_K$ is a unit if and only if $|N_{K/\\mathbb{Q}}(u)| = 1$.\n\n3. If $\\theta$ has monic minimal polynomial $f(x) = x^n + a_{n-1} x^{n-1} + \\cdots + a_0 \\in \\mathbb{Z}[x]$, then $N_{K/\\mathbb{Q}}(\\theta) = (-1)^n a_0$. More generally, for any integer $m \\in \\mathbb{Z}$, $N_{K/\\mathbb{Q}}(\\theta - m) = (-1)^n f(m)$. These follow from the definition of field norm via the product of conjugates.\n\n4. By the Dirichlet Unit Theorem (DUT), the unit group $\\mathcal{O}_K^\\times$ is finitely generated, with rank $r_1 + r_2 - 1 = 2$. Its logarithmic embedding $L: \\mathcal{O}_K^\\times \\to \\mathbb{R}^{r_1 + r_2}$ is given by\n$$\nL(u) = \\left( \\log |\\sigma_1(u)|, \\log |\\sigma_2(u)|, 2 \\log |\\tau_1(u)| \\right),\n$$\nand the image lies in the hyperplane $H = \\{ x \\in \\mathbb{R}^{r_1 + r_2} : x_1 + x_2 + x_3 = 0 \\}$ by the product formula. The regulator $R_K$ is the covolume (Euclidean volume) of the lattice $L(\\mathcal{O}_K^\\times)$ in $H$. If $\\varepsilon_1, \\varepsilon_2$ are multiplicatively independent units, then with $v_i = L(\\varepsilon_i)$, the regulator equals the Euclidean area of the parallelogram spanned by $v_1$ and $v_2$, namely\n$$\nR_K = \\sqrt{ \\det \\begin{pmatrix} \\langle v_1, v_1 \\rangle & \\langle v_1, v_2 \\rangle \\\\ \\langle v_2, v_1 \\rangle & \\langle v_2, v_2 \\rangle \\end{pmatrix} }.\n$$\n\nTask requirements:\n- Use the above principles to identify two explicit independent units in $\\mathcal{O}_K$. Using the norm identities in item 3, argue from first principles why these candidates are units. Then numerically compute their logarithmic embeddings and estimate the regulator via the Gram determinant formula in item 4.\n- Represent an element $u \\in \\mathbb{Z}[\\theta]$ as $u = a_0 + a_1 \\theta + a_2 \\theta^2 + a_3 \\theta^3$ with $a_i \\in \\mathbb{Z}$, and evaluate its embeddings by substituting the complex roots of $f$ into this polynomial in $\\theta$.\n- Do all numerical computations in angle-free form; no angle units are involved.\n\nTest suite:\nImplement the following four test cases to stress different facets of the computation.\n\n1. Norm verification for candidate units: Choose the explicit candidates $\\varepsilon_1 = \\theta$, $\\varepsilon_2 = \\theta - 1$, and $\\varepsilon_3 = \\theta + 1$. Using the definition in item 2, verify numerically that $|N_{K/\\mathbb{Q}}(\\varepsilon_i)| \\approx 1$ for $i = 1,2,3$. Return a single boolean that is true if and only if all three checks pass.\n\n2. Regulator estimate from the basis $(\\varepsilon_1, \\varepsilon_2)$: Compute $R_1$ using the Gram determinant formula in item 4 applied to $v_1 = L(\\varepsilon_1)$ and $v_2 = L(\\varepsilon_2)$. Return this value as a float.\n\n3. Regulator estimate from the alternative basis $(\\varepsilon_1, \\varepsilon_3)$: Compute $R_2$ analogously using $v_1 = L(\\varepsilon_1)$ and $v_3 = L(\\varepsilon_3)$. Return this value as a float. For a correct computation, $R_1$ and $R_2$ should be numerically close, since changing a unit basis by an integral unimodular transformation preserves covolume.\n\n4. Rank verification: Form the matrix with columns $v_1 = L(\\varepsilon_1)$, $v_2 = L(\\varepsilon_2)$, $v_3 = L(\\varepsilon_3)$ in $\\mathbb{R}^3$, and compute its numerical column rank (using a threshold of $10^{-10}$ on singular values). Return the rank as an integer. A correct computation should yield $2$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order of the four test cases, namely\n[$b$, $R_1$, $R_2$, $r$],\nwhere $b$ is a boolean, $R_1$ and $R_2$ are floats, and $r$ is an integer. No other text should be printed. There are no physical units involved in this computation.", "solution": "The problem statement is critically reviewed and found to be valid. It is a well-posed problem in computational algebraic number theory, grounded in established definitions and theorems such as the field norm, embeddings, and Dirichlet's Unit Theorem. The provided data and definitions are self-contained, consistent, and scientifically sound. The task is to perform a series of numerical computations related to units in the quartic field $K = \\mathbb{Q}(\\theta)$ defined by the polynomial $f(x) = x^4 - x - 1$.\n\nThe solution proceeds systematically as follows. First, we determine the embeddings of $K$ by finding the roots of $f(x)$. Then, we evaluate the candidate units at these roots to compute their norms and logarithmic embeddings. Finally, we use these values to compute the regulators and matrix rank as specified in the test cases.\n\n1.  **Field Embeddings**\n    The number field is $K = \\mathbb{Q}(\\theta)$, where $\\theta$ is a root of the irreducible polynomial $f(x) = x^4 - x - 1$. The embeddings of $K$ into $\\mathbb{C}$ are determined by the roots of $f(x)$. We find these roots numerically. The polynomial coefficients are $(1, 0, 0, -1, -1)$. The roots are:\n    - Two real roots. We denote the positive one by $\\alpha_1$ and the negative one by $\\alpha_2$.\n      $$ \\alpha_1 \\approx 1.2207440846 $$\n      $$ \\alpha_2 \\approx -0.7244919590 $$\n    - A pair of complex conjugate roots. We choose the one with a positive imaginary part, denoted by $\\alpha_3$.\n      $$ \\alpha_3 \\approx -0.2481260628 + 1.0339912260 i $$\n    The signature of the field is $(r_1, r_2) = (2, 1)$, with $r_1=2$ real embeddings ($\\sigma_1, \\sigma_2$) and $r_2=1$ pair of complex embeddings ($\\tau_1, \\overline{\\tau_1}$). These are given by mapping $\\theta$ to the corresponding roots: $\\sigma_1(\\theta) = \\alpha_1$, $\\sigma_2(\\theta) = \\alpha_2$, and $\\tau_1(\\theta) = \\alpha_3$. For any element $u = P(\\theta) \\in K$ where $P$ is a polynomial with rational coefficients, its embeddings are $\\sigma_i(u) = P(\\alpha_i)$ and $\\tau_j(u) = P(\\alpha_j)$.\n\n2.  **Candidate Units and First Principles Verification**\n    The problem proposes three candidate units in the ring of integers $\\mathcal{O}_K$: $\\varepsilon_1 = \\theta$, $\\varepsilon_2 = \\theta - 1$, and $\\varepsilon_3 = \\theta + 1$. An algebraic integer is a unit if and only if its norm has an absolute value of $1$. Using the provided identity $N_{K/\\mathbb{Q}}(\\theta-m) = (-1)^n f(m)$ with $n=4$:\n    - For $\\varepsilon_1 = \\theta$, we take $m=0$. The constant term of $f(x)$ is $a_0 = -1$. The norm is $N_{K/\\mathbb{Q}}(\\theta) = (-1)^4 a_0 = -1$. Thus, $|N(\\varepsilon_1)| = 1$.\n    - For $\\varepsilon_2 = \\theta - 1$, we take $m=1$. The norm is $N_{K/\\mathbb{Q}}(\\theta-1) = (-1)^4 f(1) = 1^4 - 1 - 1 = -1$. Thus, $|N(\\varepsilon_2)| = 1$.\n    - For $\\varepsilon_3 = \\theta + 1$, we take $m=-1$. The norm is $N_{K/\\mathbb{Q}}(\\theta+1) = (-1)^4 f(-1) = (-1)^4 - (-1) - 1 = 1$. Thus, $|N(\\varepsilon_3)| = 1$.\n    All three candidates are indeed units in $\\mathcal{O}_K$.\n\n3.  **Test Case 1: Numerical Norm Verification**\n    We verify the norms numerically using the definition $|N_{K/\\mathbb{Q}}(u)| = |\\sigma_1(u)| \\cdot |\\sigma_2(u)| \\cdot |\\tau_1(u)|^2$.\n    - For $\\varepsilon_1 = \\theta$: $|N(\\varepsilon_1)| = |\\alpha_1| \\cdot |\\alpha_2| \\cdot |\\alpha_3|^2 \\approx (1.2207)(0.7245)(1.1307) \\approx 1.00000000$.\n    - For $\\varepsilon_2 = \\theta-1$: $|N(\\varepsilon_2)| = |\\alpha_1-1| \\cdot |\\alpha_2-1| \\cdot |\\alpha_3-1|^2 \\approx (0.2207)(1.7245)(2.6270) \\approx 1.00000000$.\n    - For $\\varepsilon_3 = \\theta+1$: $|N(\\varepsilon_3)| = |\\alpha_1+1| \\cdot |\\alpha_2+1| \\cdot |\\alpha_3+1|^2 \\approx (2.2207)(0.2755)(1.6345) \\approx 1.00000000$.\n    All three norms are numerically equal to $1$ within a tolerance of $10^{-8}$. The test case thus returns `True`.\n\n4.  **Test Cases 2 & 3: Regulator Estimation**\n    By Dirichlet's Unit Theorem, the rank of the unit group is $r_1+r_2-1 = 2+1-1=2$. The logarithmic embedding of a unit $u$ is $L(u) = (\\log|\\sigma_1(u)|, \\log|\\sigma_2(u)|, 2\\log|\\tau_1(u)|)$. We compute the log vectors $v_1=L(\\varepsilon_1)$, $v_2=L(\\varepsilon_2)$, and $v_3=L(\\varepsilon_3)$.\n    $$ v_1 \\approx (0.19946, -0.32225, 0.12279) $$\n    $$ v_2 \\approx (-1.51069, 0.54496, 0.96573) $$\n    $$ v_3 \\approx (0.79785, -1.28902, 0.49117) $$\n    We must note a crucial relationship: from the minimal polynomial, $\\theta^4 = \\theta + 1$. This means $\\varepsilon_3 = \\varepsilon_1^4$. Consequently, their logarithmic embeddings are linearly dependent: $L(\\varepsilon_3) = L(\\varepsilon_1^4) = 4 L(\\varepsilon_1)$, so $v_3 = 4v_1$. The pair $(\\varepsilon_1, \\varepsilon_3)$ is multiplicatively dependent and does not form a basis for a rank-$2$ lattice.\n\n    The regulator for a pair of units $(\\eta_1, \\eta_2)$ with log vectors $(w_1, w_2)$ is the area of the parallelogram they span, given by the Gram determinant formula: $R = \\sqrt{\\det(\\mathbf{G})} = \\sqrt{\\langle w_1, w_1\\rangle\\langle w_2, w_2\\rangle - \\langle w_1, w_2\\rangle^2}$.\n\n    - **Test Case 2: Basis $(\\varepsilon_1, \\varepsilon_2)$**: The units $\\varepsilon_1$ and $\\varepsilon_2$ are independent. We compute $R_1$ using $v_1$ and $v_2$:\n      $$ R_1 = \\sqrt{\\langle v_1, v_1\\rangle\\langle v_2, v_2\\rangle - \\langle v_1, v_2\\rangle^2} \\approx 0.65538 $$\n      This value is an estimate for the regulator of the subgroup generated by $\\varepsilon_1$ and $\\varepsilon_2$. It may be an integer multiple of the true regulator $R_K$.\n\n    - **Test Case 3: \"Basis\" $(\\varepsilon_1, \\varepsilon_3)$**: The vectors $v_1$ and $v_3=4v_1$ are collinear. The parallelogram they span is degenerate and has zero area. The Gram determinant is therefore zero:\n      $$ \\det(\\mathbf{G}) = \\langle v_1, v_1\\rangle\\langle 4v_1, 4v_1\\rangle - \\langle v_1, 4v_1\\rangle^2 = \\langle v_1, v_1\\rangle (16\\langle v_1, v_1\\rangle) - (4\\langle v_1, v_1\\rangle)^2 = 16(\\langle v_1, v_1\\rangle)^2 - 16(\\langle v_1, v_1\\rangle)^2 = 0 $$\n      Thus, $R_2 = \\sqrt{0} = 0$. The problem's mention of $R_1$ and $R_2$ being \"numerically close\" is a subtle test of understanding, highlighting that the chosen pair for $R_2$ does not form a basis.\n\n5.  **Test Case 4: Rank Verification**\n    We form the $3 \\times 3$ matrix $M = [v_1, v_2, v_3]$. Since $v_3=4v_1$, the columns of this matrix are linearly dependent. The rank of the matrix is the dimension of the space spanned by its columns. As $v_1$ and $v_2$ are linearly independent, but $v_3$ is a multiple of $v_1$, the set $\\{v_1, v_2, v_3\\}$ spans a $2$-dimensional space. The rank of $M$ is $2$. This is confirmed numerically by computing the singular value decomposition of $M$ and counting the number of singular values greater than a threshold of $10^{-10}$.\n\nThe final results for the four test cases are assembled from these calculations.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes numerical properties of units in the number field K = Q(theta)\n    where theta is a root of f(x) = x^4 - x - 1.\n    \"\"\"\n    \n    # 1. Find the roots of f(x) = x^4 - x - 1 = 0.\n    # The embeddings are determined by these roots.\n    coeffs = [1, 0, 0, -1, -1]\n    roots = np.roots(coeffs)\n    \n    # Separate the roots into real and complex.\n    # Establish a canonical ordering for reproducibility.\n    real_roots_list = sorted([r.real for r in roots if np.isclose(r.imag, 0)])\n    alpha1 = real_roots_list[1]  # Positive real root\n    alpha2 = real_roots_list[0]  # Negative real root\n    \n    # Choose the complex root with positive imaginary part.\n    alpha3 = next(r for r in roots if r.imag > 0)\n    \n    # Define the evaluated units u at the roots.\n    # u1 = theta\n    sigma1_u1, sigma2_u1, tau1_u1 = alpha1, alpha2, alpha3\n    # u2 = theta - 1\n    sigma1_u2, sigma2_u2, tau1_u2 = alpha1 - 1, alpha2 - 1, alpha3 - 1\n    # u3 = theta + 1\n    sigma1_u3, sigma2_u3, tau1_u3 = alpha1 + 1, alpha2 + 1, alpha3 + 1\n    \n    # --- Test Case 1: Norm verification ---\n    # |N(u)| = |sigma_1(u)| * |sigma_2(u)| * |tau_1(u)|^2\n    norm1 = abs(sigma1_u1) * abs(sigma2_u1) * abs(tau1_u1)**2\n    norm2 = abs(sigma1_u2) * abs(sigma2_u2) * abs(tau1_u2)**2\n    norm3 = abs(sigma1_u3) * abs(sigma2_u3) * abs(tau1_u3)**2\n    \n    norm_tol = 1e-8\n    norm_check_passed = (np.isclose(norm1, 1.0, atol=norm_tol) and\n                         np.isclose(norm2, 1.0, atol=norm_tol) and\n                         np.isclose(norm3, 1.0, atol=norm_tol))\n    \n    # --- Logarithmic embeddings ---\n    # L(u) = (log|sigma_1(u)|, log|sigma_2(u)|, 2*log|tau_1(u)|)\n    def get_log_vector(s1, s2, t1):\n        return np.array([np.log(abs(s1)), np.log(abs(s2)), 2 * np.log(abs(t1))])\n        \n    v1 = get_log_vector(sigma1_u1, sigma2_u1, tau1_u1)\n    v2 = get_log_vector(sigma1_u2, sigma2_u2, tau1_u2)\n    v3 = get_log_vector(sigma1_u3, sigma2_u3, tau1_u3)\n    \n    # --- Test Case 2: Regulator R1 from (e1, e2) ---\n    # Regulator R = sqrt(det(Gram(v_i, v_j))) = sqrt(||v_i||^2 ||v_j||^2 - (v_i . v_j)^2)\n    gram_det_12 = np.dot(v1, v1) * np.dot(v2, v2) - np.dot(v1, v2)**2\n    # Ensure argument to sqrt is non-negative to handle floating point inaccuracies.\n    R1 = np.sqrt(max(0, gram_det_12))\n    \n    # --- Test Case 3: Regulator R2 from (e1, e3) ---\n    # Since e3 = e1^4, their log vectors v1 and v3 are linearly dependent (v3 = 4*v1).\n    # The Gram determinant must be zero.\n    gram_det_13 = np.dot(v1, v1) * np.dot(v3, v3) - np.dot(v1, v3)**2\n    R2 = np.sqrt(max(0, gram_det_13))\n    \n    # --- Test Case 4: Rank verification ---\n    # The rank of the matrix [v1, v2, v3] should be 2, as v3 is a multiple of v1.\n    matrix = np.column_stack([v1, v2, v3])\n    singular_values = np.linalg.svd(matrix, compute_uv=False)\n    rank_tol = 1e-10\n    rank = np.sum(singular_values > rank_tol)\n    \n    # --- Final output ---\n    # The problem asks for the boolean directly, not its string representation 'True'/'False'.\n    # Python's default f-string formatting handles this correctly.\n    results = [norm_check_passed, R1, R2, rank]\n    print(f\"[{results[0]},{results[1]},{results[2]},{results[3]}]\")\n\nsolve()\n\n```", "id": "3014835"}]}