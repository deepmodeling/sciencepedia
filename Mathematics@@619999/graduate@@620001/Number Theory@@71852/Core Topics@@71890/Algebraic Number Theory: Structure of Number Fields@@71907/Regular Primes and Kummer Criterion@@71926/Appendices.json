{"hands_on_practices": [{"introduction": "The power of Kummer's approach lies in its ability to split the complex structure of the ideal class group into simpler, one-dimensional pieces. This decomposition is achieved using a special set of elements in the group algebra called orthogonal idempotents. This exercise guides you through the foundational algebraic manipulations to verify the key properties of these idempotents, revealing the \"engine\" that drives the eigenspace decomposition central to the theory of regular primes. [@problem_id:3022712]", "problem": "Let $p$ be an odd prime and let $K=\\mathbb{Q}(\\zeta_{p})$ be the $p$-th cyclotomic field with Galois group $G=\\operatorname{Gal}(K/\\mathbb{Q})\\cong (\\mathbb{Z}/p\\mathbb{Z})^{\\times}$. For each $a\\in (\\mathbb{Z}/p\\mathbb{Z})^{\\times}$, let $\\sigma_{a}\\in G$ be the unique automorphism satisfying $\\sigma_{a}(\\zeta_{p})=\\zeta_{p}^{a}$. Let $\\omega:(\\mathbb{Z}/p\\mathbb{Z})^{\\times}\\to \\mu_{p-1}\\subset \\mathbb{Q}(\\mu_{p-1})^{\\times}$ be the Teichmüller character, and consider the group algebra $\\mathbb{Q}(\\mu_{p-1})[G]$. For $k\\in\\{0,1,\\dots,p-2\\}$ define\n$$\ne_{k} \\;=\\; \\frac{1}{p-1}\\sum_{a\\in(\\mathbb{Z}/p\\mathbb{Z})^{\\times}} \\omega(a)^{-k}\\,\\sigma_{a}\\;\\in\\;\\mathbb{Q}(\\mu_{p-1})[G].\n$$\nStarting from the definitions of the cyclotomic Galois group action, the Teichmüller character, and the group algebra, carry out the following steps:\n\n1. Compute the product $e_{k}\\sigma_{b}$ in $\\mathbb{Q}(\\mu_{p-1})[G]$ for an arbitrary $b\\in(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$.\n\n2. Using the result of part 1 as the only algebraic input beyond the definitions, verify that $e_{k}e_{\\ell}=0$ for $k\\neq \\ell$ and that $e_{k}^{2}=e_{k}$.\n\n3. Briefly explain why the family $\\{e_{k}\\}_{k=0}^{p-2}$ provides the simultaneous eigenspace decomposition for the $G$-action on any $\\mathbb{Q}(\\mu_{p-1})[G]$-module, and indicate how this decomposition underlies the splitting of the ideal class group of $K$ into $\\omega^{k}$-eigenspaces that appear in Kummer’s criterion for regular primes.\n\nProvide your final answer as the ordered triple $\\bigl(e_{k}\\sigma_{b},\\,e_{k}e_{\\ell}\\text{ for }k\\neq \\ell,\\,e_{k}^{2}\\bigr)$ written as a single row using the $\\mathrm{pmatrix}$ format. No numerical approximation is required, and no units are involved. Your final answer must be a single symbolic expression as specified.", "solution": "The problem statement has been validated and is deemed valid. It is a standard, well-posed problem in algebraic number theory. All definitions are standard and the tasks are clear and logically structured.\n\nThe problem asks for three computations and one explanation related to the orthogonal idempotents of the group algebra of a cyclotomic field's Galois group.\n\nLet $p$ be an odd prime, $G = \\operatorname{Gal}(\\mathbb{Q}(\\zeta_{p})/\\mathbb{Q}) \\cong (\\mathbb{Z}/p\\mathbb{Z})^{\\times}$. The elements of $G$ are denoted $\\sigma_a$ for $a \\in (\\mathbb{Z}/p\\mathbb{Z})^{\\times}$, satisfying $\\sigma_a(\\zeta_p) = \\zeta_p^a$. The map $a \\mapsto \\sigma_a$ is a group isomorphism, so $\\sigma_a \\sigma_b = \\sigma_{ab}$. The Teichmüller character $\\omega: (\\mathbb{Z}/p\\mathbb{Z})^{\\times} \\to \\mathbb{Q}(\\mu_{p-1})^{\\times}$ is a group homomorphism. The idempotents are defined as\n$$e_{k} = \\frac{1}{p-1}\\sum_{a\\in(\\mathbb{Z}/p\\mathbb{Z})^{\\times}} \\omega(a)^{-k}\\,\\sigma_{a}$$\nfor $k \\in \\{0, 1, \\dots, p-2\\}$.\n\n1. Computation of $e_{k}\\sigma_{b}$\n\nWe compute the product of the element $e_k$ and a group element $\\sigma_b$ in the group algebra $\\mathbb{Q}(\\mu_{p-1})[G]$. By definition of $e_k$ and using the distributive property of the algebra:\n$$e_{k}\\sigma_{b} = \\left( \\frac{1}{p-1}\\sum_{a\\in(\\mathbb{Z}/p\\mathbb{Z})^{\\times}} \\omega(a)^{-k}\\,\\sigma_{a} \\right) \\sigma_{b} = \\frac{1}{p-1}\\sum_{a\\in(\\mathbb{Z}/p\\mathbb{Z})^{\\times}} \\omega(a)^{-k}\\,(\\sigma_{a}\\sigma_{b})$$\nUsing the group law $\\sigma_{a}\\sigma_{b} = \\sigma_{ab}$, we have:\n$$e_{k}\\sigma_{b} = \\frac{1}{p-1}\\sum_{a\\in(\\mathbb{Z}/p\\mathbb{Z})^{\\times}} \\omega(a)^{-k}\\,\\sigma_{ab}$$\nWe perform a change of variables in the summation. Let $c = ab$. Since $b$ is a fixed element of the group $(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$, as $a$ runs through all elements of the group, so does $c$. From $c = ab$, we have $a = cb^{-1}$. Substituting this into the sum:\n$$e_{k}\\sigma_{b} = \\frac{1}{p-1}\\sum_{c\\in(\\mathbb{Z}/p\\mathbb{Z})^{\\times}} \\omega(cb^{-1})^{-k}\\,\\sigma_{c}$$\nSince $\\omega$ is a group homomorphism, $\\omega(cb^{-1}) = \\omega(c)\\omega(b^{-1})$. Also, for any character, $\\omega(b^{-1}) = \\omega(b)^{-1}$. Thus, $\\omega(cb^{-1})^{-k} = (\\omega(c)\\omega(b)^{-1})^{-k} = \\omega(c)^{-k}(\\omega(b)^{-1})^{-k} = \\omega(c)^{-k}\\omega(b)^{k}$. The term $\\omega(b)^k$ is a scalar in $\\mathbb{Q}(\\mu_{p-1})$ and does not depend on the summation variable $c$, so it can be factored out of the sum:\n$$e_{k}\\sigma_{b} = \\frac{1}{p-1}\\sum_{c\\in(\\mathbb{Z}/p\\mathbb{Z})^{\\times}} \\omega(c)^{-k}\\omega(b)^{k}\\,\\sigma_{c} = \\omega(b)^{k} \\left( \\frac{1}{p-1}\\sum_{c\\in(\\mathbb{Z}/p\\mathbb{Z})^{\\times}} \\omega(c)^{-k}\\,\\sigma_{c} \\right)$$\nThe expression in the parentheses is the definition of $e_k$. Therefore, we obtain the result:\n$$e_{k}\\sigma_{b} = \\omega(b)^{k}e_{k}$$\n\n2. Verification of the idempotent and orthogonality properties\n\nWe are to use the result from part $1$ as the sole algebraic input. We compute the product $e_k e_\\ell$.\n$$e_{k}e_{\\ell} = e_{k} \\left( \\frac{1}{p-1}\\sum_{b\\in(\\mathbb{Z}/p\\mathbb{Z})^{\\times}} \\omega(b)^{-\\ell}\\,\\sigma_{b} \\right)$$\nUsing the linearity of the algebra action, we can move $e_k$ inside the summation:\n$$e_{k}e_{\\ell} = \\frac{1}{p-1}\\sum_{b\\in(\\mathbb{Z}/p\\mathbb{Z})^{\\times}} \\omega(b)^{-\\ell}\\,(e_{k}\\sigma_{b})$$\nNow, we substitute the result from part $1$, $e_k\\sigma_b = \\omega(b)^k e_k$:\n$$e_{k}e_{\\ell} = \\frac{1}{p-1}\\sum_{b\\in(\\mathbb{Z}/p\\mathbb{Z})^{\\times}} \\omega(b)^{-\\ell}\\,(\\omega(b)^{k}e_{k})$$\nThe scalars $\\omega(b)^{-\\ell}$ and $\\omega(b)^k$ commute with the algebra element $e_k$. We can combine the powers of $\\omega(b)$ and factor out $e_k$ from the summation:\n$$e_{k}e_{\\ell} = \\left( \\frac{1}{p-1}\\sum_{b\\in(\\mathbb{Z}/p\\mathbb{Z})^{\\times}} \\omega(b)^{k-\\ell} \\right) e_{k}$$\nThe evaluation of this expression depends on the sum of character values. Let $\\chi = \\omega^{k-\\ell}$. The sum is $\\sum_{b \\in (\\mathbb{Z}/p\\mathbb{Z})^{\\times}} \\chi(b)$. The orthogonality relations for characters of a finite abelian group state that this sum is equal to the order of the group if $\\chi$ is the trivial character, and $0$ otherwise.\n\nThe characters $\\omega^j$ for $j \\in \\{0, 1, \\dots, p-2\\}$ are all distinct. The trivial character is $\\omega^0$. Thus, $\\chi = \\omega^{k-\\ell}$ is trivial if and only if $k-\\ell$ is a multiple of $p-1$. Given $k, \\ell \\in \\{0, 1, \\dots, p-2\\}$, the difference satisfies $-(p-2) \\le k-\\ell \\le p-2$. The only multiple of $p-1$ in this range is $0$. Hence, $\\omega^{k-\\ell}$ is trivial if and only if $k=\\ell$.\n\nCase $k \\neq \\ell$: In this case, $k-\\ell \\neq 0$, so $\\omega^{k-\\ell}$ is a non-trivial character. The orthogonality relation gives:\n$$\\sum_{b\\in(\\mathbb{Z}/p\\mathbb{Z})^{\\times}} \\omega(b)^{k-\\ell} = 0$$\nTherefore, for $k \\neq \\ell$,\n$$e_{k}e_{\\ell} = \\left( \\frac{1}{p-1} \\cdot 0 \\right) e_{k} = 0$$\nThis verifies the orthogonality property $e_k e_\\ell = 0$ for $k \\ne \\ell$.\n\nCase $k = \\ell$: In this case, $k-\\ell = 0$, so $\\omega^{k-\\ell} = \\omega^0$ is the trivial character, meaning $\\omega(b)^0 = 1$ for all $b$. The sum becomes:\n$$\\sum_{b\\in(\\mathbb{Z}/p\\mathbb{Z})^{\\times}} \\omega(b)^{0} = \\sum_{b\\in(\\mathbb{Z}/p\\mathbb{Z})^{\\times}} 1 = |(\\mathbb{Z}/p\\mathbb{Z})^{\\times}| = p-1$$\nTherefore, for $k=\\ell$,\n$$e_{k}e_{k} = e_{k}^2 = \\left( \\frac{1}{p-1} \\cdot (p-1) \\right) e_{k} = 1 \\cdot e_{k} = e_{k}$$\nThis verifies the idempotent property $e_k^2=e_k$.\n\n3. Explanation of significance for module decomposition and Kummer's criterion\n\nThe elements $\\{e_{k}\\}_{k=0}^{p-2}$ form a complete set of mutually orthogonal idempotents in the group algebra $\\mathbb{Q}(\\mu_{p-1})[G]$. This means $e_k e_\\ell = \\delta_{k\\ell} e_k$, where $\\delta_{k\\ell}$ is the Kronecker delta, and their sum is the multiplicative identity of the algebra, $\\sum_{k=0}^{p-2} e_k = \\sigma_1$. As such, they act as projection operators. For any $\\mathbb{Q}(\\mu_{p-1})[G]$-module $M$, we can write $M$ as a direct sum of subspaces $M_k = e_k M$:\n$$M = \\left(\\sum_{k=0}^{p-2} e_k\\right) M = \\bigoplus_{k=0}^{p-2} e_k M = \\bigoplus_{k=0}^{p-2} M_k$$\nTo understand the action of $G$ on these subspaces, let $x \\in M_k$. Then $x = e_k x$. Since the group $G$ is abelian, its elements commute with any element of the group algebra $\\mathbb{Q}(\\mu_{p-1})[G]$, so in particular $\\sigma_b e_k = e_k \\sigma_b$. The action of $\\sigma_b \\in G$ on $x$ is given by $\\sigma_b(x) = \\sigma_b(e_k x) = (\\sigma_b e_k) x = (e_k \\sigma_b) x$. Using the result from part 1, this becomes $(\\omega(b)^k e_k) x = \\omega(b)^k (e_k x) = \\omega(b)^k x$. This demonstrates that every element in the subspace $M_k$ is a simultaneous eigenvector for the action of the entire group $G$, where each $\\sigma_b \\in G$ acts as multiplication by the scalar $\\omega(b)^k$. The subspace $M_k$ is thus called the $\\omega^k$-eigenspace of $M$. The family $\\{e_k\\}$ provides the explicit mechanism for decomposing any such $G$-module into its character eigenspaces.\n\nThis decomposition is central to the study of the ideal class group of $K=\\mathbb{Q}(\\zeta_p)$, which is a $\\mathbb{Z}[G]$-module. By considering the $p$-part of the class group, $A$, and extending scalars to a suitable ring containing $p$-adic integers and roots of unity (like $\\mathbb{Z}_p[\\mu_{p-1}]$), one can apply these idempotents to decompose $A$ into its $\\omega^k$-eigenspaces, $A_k = e_k A$. Kummer's criterion states that a prime $p$ is regular if and only if $p$ does not divide the numerators of the Bernoulli numbers $B_2, B_4, \\dots, B_{p-3}$. The Herbrand-Ribet theorem refines this by relating individual Bernoulli numbers to specific eigenspaces of the class group: for an even index $k \\in \\{2, \\dots, p-3\\}$, the eigenspace $A_{p-k}$ is non-trivial if and only if $p$ divides the numerator of $B_k$. The eigenspace decomposition provided by the idempotents $\\{e_k\\}$ is the fundamental algebraic tool that makes this precise connection possible, splitting the study of the entire class group into the study of its individual, more manageable, eigenspace components.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\omega(b)^{k} e_{k} & 0 & e_{k} \\end{pmatrix}}\n$$", "id": "3022712"}, {"introduction": "With the algebraic machinery of idempotents in place, we can now apply Kummer's criterion in a concrete setting. This practice challenges you to perform a direct, manual test for the regularity of the prime $p=23$. By computing the relevant Bernoulli numbers modulo $23$ from their fundamental recurrence relation, you will gain a tangible understanding of how the abstract criterion connects to explicit arithmetic calculations. [@problem_id:3022717]", "problem": "Let $p=23$. A rational number $B_{k}$ is the $k$-th Bernoulli number, defined by the exponential generating function\n$$\n\\frac{t}{\\exp(t)-1} \\;=\\; \\sum_{n=0}^{\\infty} B_{n}\\,\\frac{t^{n}}{n!}.\n$$\nA prime $p$ is regular if and only if $p$ does not divide the numerator of $B_{k}$ for any even integer $k$ with $2\\leq k\\leq p-3$ (this is Kummer's criterion). By the von Staudt–Clausen theorem, for each even $k$ with $2\\leq k\\leq p-3$, the denominator of $B_{k}$ is the product of primes $q$ with $q-1\\mid k$, so in particular it is not divisible by $p$ when $k\\leq p-3$ and $p-1\\nmid k$. Consequently, the residue class $B_{k}\\bmod p$ is well defined by reducing its numerator and multiplying by the inverse of its denominator modulo $p$.\n\nUsing only these foundational facts, compute $B_{k}\\bmod 23$ for all even $k$ with $2\\leq k\\leq 20$, and use these computations together with Kummer's criterion to determine the irregular index $i(23)$, defined as the number of even integers $k$ with $2\\leq k\\leq 20$ such that $23$ divides the numerator of $B_{k}$. Express your final answer as a single integer.", "solution": "The problem asks for the irregular index of the prime $p=23$, denoted $i(23)$. This index is defined as the number of even integers $k$ in the range $2 \\le k \\le p-3$ such that $p$ divides the numerator of the $k$-th Bernoulli number $B_k$. For $p=23$, the range is $2 \\le k \\le 20$.\n\nFirst, we validate the problem statement.\nThe problem provides standard definitions from number theory: the generating function for Bernoulli numbers, Kummer's criterion for regular primes, and a consequence of the von Staudt–Clausen theorem regarding the $p$-integrality of $B_k$ for $k \\le p-3$. All definitions and provided statements are factually correct and scientifically grounded. The task is to compute a well-defined integer quantity, $i(23)$, based on these principles. The problem is self-contained, well-posed, objective, and requires a non-trivial, verifiable computation. It is therefore a valid problem.\n\nThe core of the task is to determine whether $B_k \\equiv 0 \\pmod{23}$ for each even $k$ from $2$ to $20$.\nWe use the foundational recurrence relation for Bernoulli numbers, which is derived directly from their defining generating function $\\frac{t}{\\exp(t)-1} = \\sum_{n=0}^{\\infty} B_n \\frac{t^n}{n!}$. Multiplying by $\\exp(t)-1$ gives $t = (\\exp(t)-1)\\sum_{n=0}^{\\infty} B_n \\frac{t^n}{n!}$. By comparing the coefficients of powers of $t$ on both sides, we obtain the recurrence relation:\n$\\sum_{j=0}^{m-1} \\binom{m}{j} B_j = 0$ for $m \\ge 2$.\nWe use this relation to compute the values of $B_k \\pmod{23}$.\n\nThe first few Bernoulli numbers are $B_0=1$ and $B_1=-1/2$. For any odd integer $k \\ge 3$, $B_k=0$.\nAll computations are performed modulo $23$.\n$B_0 \\equiv 1 \\pmod{23}$.\n$B_1 = -1/2$. To find $2^{-1} \\pmod{23}$, we solve $2x \\equiv 1 \\pmod{23}$. Since $2 \\cdot 12=24 \\equiv 1 \\pmod{23}$, we have $2^{-1} \\equiv 12 \\pmod{23}$. Thus, $B_1 \\equiv -12 \\equiv 11 \\pmod{23}$.\n\nWe compute $B_k$ for even $k \\ge 2$ by isolating the highest-index term in the recurrence relation. For an even integer $k$, we use the recurrence with $m=k+1$:\n$\\sum_{j=0}^{k} \\binom{k+1}{j} B_j = 0$.\nSince $B_j=0$ for odd $j \\ge 3$, this simplifies to:\n$\\binom{k+1}{k} B_k = - \\left( \\binom{k+1}{0}B_0 + \\binom{k+1}{1}B_1 + \\sum_{j=2, \\text{even}}^{k-2} \\binom{k+1}{j}B_j \\right)$.\n$(k+1) B_k \\equiv - \\left( B_0 + (k+1)B_1 + \\sum_{j=2, \\text{even}}^{k-2} \\binom{k+1}{j}B_j \\right) \\pmod{23}$.\n\nFor $k=2$: Use $m=3$. $\\binom{3}{0}B_0 + \\binom{3}{1}B_1 + \\binom{3}{2}B_2 = 0$.\n$1 \\cdot 1 + 3 \\cdot 11 + 3 \\cdot B_2 \\equiv 0 \\pmod{23}$.\n$1 + 33 + 3B_2 \\equiv 0 \\implies 1 + 10 + 3B_2 \\equiv 0 \\implies 3B_2 \\equiv -11 \\equiv 12 \\pmod{23}$.\nWe need $3^{-1} \\pmod{23}$. $3 \\cdot 8 = 24 \\equiv 1$, so $3^{-1} \\equiv 8$.\n$B_2 \\equiv 12 \\cdot 8 = 96 \\equiv 4 \\pmod{23}$.\n\nFor $k=4$: Use $m=5$. $\\binom{5}{0}B_0 + \\binom{5}{1}B_1 + \\binom{5}{2}B_2 + \\binom{5}{4}B_4 = 0$ (since $B_3=0$).\n$1 \\cdot 1 + 5 \\cdot 11 + 10 \\cdot 4 + 5 B_4 \\equiv 0 \\pmod{23}$.\n$1 + 55 + 40 + 5B_4 \\equiv 0 \\implies 1+9+17+5B_4 \\equiv 0 \\implies 27+5B_4 \\equiv 0 \\implies 4+5B_4 \\equiv 0 \\pmod{23}$.\n$5B_4 \\equiv -4 \\equiv 19 \\pmod{23}$.\nWe need $5^{-1} \\pmod{23}$. $5 \\cdot 14 = 70 \\equiv 1$, so $5^{-1} \\equiv 14$.\n$B_4 \\equiv 19 \\cdot 14 = 266 = 11 \\cdot 23 + 13 \\equiv 13 \\pmod{23}$.\n\nThe remaining computations proceed in the same manner. While tedious, they are straightforward. We list the complete set of results.\n$B_2 \\equiv 4 \\pmod{23}$\n$B_4 \\equiv 13 \\pmod{23}$\n$B_6 \\equiv 17 \\pmod{23}$\n$B_8 \\equiv 13 \\pmod{23}$\n$B_{10} \\equiv 6 \\pmod{23}$\n$B_{12} \\equiv 10 \\pmod{23}$\n$B_{14} \\equiv 5 \\pmod{23}$\n$B_{16} \\equiv 10 \\pmod{23}$\n$B_{18} \\equiv 9 \\pmod{23}$\n$B_{20} \\equiv 15 \\pmod{23}$\n\nNone of these values are congruent to $0$ modulo $23$. This implies that for $p=23$, the numerator of $B_k$ is not divisible by $23$ for any even integer $k$ in the range $2 \\le k \\le 20$.\n\nAccording to Kummer's criterion, a prime $p$ is regular if it does not divide the numerator of any $B_k$ for even $k$ with $2 \\le k \\le p-3$. Our computations show that $p=23$ satisfies this condition. Therefore, $23$ is a regular prime.\n\nThe irregular index, $i(p)$, is the number of even integers $k \\in [2, p-3]$ for which $p$ divides the numerator of $B_k$. Since our computations have shown that there are no such values of $k$ for $p=23$, the irregular index $i(23)$ is $0$.", "answer": "$$\\boxed{0}$$", "id": "3022717"}, {"introduction": "While manual computations are insightful, they quickly become impractical for larger primes. This final practice invites you to bridge theory with modern computational methods by designing and implementing an algorithm to test for regularity. By translating the recurrence for Bernoulli numbers and Kummer's criterion into code, you can efficiently check a range of primes, including discovering the first irregular prime, $p=37$, for yourself. [@problem_id:3022718]", "problem": "Let $p$ be a prime number and let $\\{B_n\\}_{n\\ge 0}$ denote the Bernoulli numbers defined by the exponential generating function $$\\frac{x}{e^x - 1} = \\sum_{n=0}^{\\infty} B_n \\frac{x^n}{n!}.$$ A prime $p$ is called regular if it does not divide the class number of the $p$th cyclotomic field $\\mathbb{Q}(\\zeta_p)$, where $\\zeta_p$ is a primitive $p$th root of unity. Kummer’s criterion states that a prime $p$ is regular if and only if $p$ does not divide the numerator of $B_k$ for any even integer $k$ with $2 \\le k \\le p-3$. The von Staudt-Clausen theorem asserts that the denominator of $B_{2m}$ is the product of primes $q$ such that $(q-1)$ divides $2m$, and in particular, for $2 \\le k \\le p-3$ even, the denominator of $B_k$ is not divisible by $p$.\n\nYour task is to derive from first principles an algorithmic computation to test regularity of a given prime $p$ by tabulating the residues $B_k \\bmod p$ for even $k$ with $2 \\le k \\le p-3$ and deciding whether all such residues are nonzero. The derivation must begin from the defining generating function above and proceed to an exact rational recurrence for $B_n$, avoiding any unproven shortcuts. Then, use the von Staudt-Clausen theorem to justify that reduction modulo $p$ via the modular inverse of the denominator is valid in the specified range, and use Kummer’s criterion to justify correctness of the regularity test.\n\nProgram requirements:\n- Implement an exact computation of Bernoulli numbers $B_n$ as rational numbers for $0 \\le n \\le N$, using only integer and rational arithmetic derived from the generating function definition. You must derive and use a recurrence relation for $B_n$ that follows directly from the generating function.\n- For each prime $p$ in the test suite, compute the list of residues $$\\bigl[B_2 \\bmod p, B_4 \\bmod p, \\dots, B_{p-3} \\bmod p\\bigr],$$ where reduction modulo $p$ is performed by multiplying the numerator of $B_k$ by the modular inverse of its denominator modulo $p$.\n- Decide regularity of $p$ as a boolean value based on whether all computed residues are nonzero, in light of Kummer’s criterion.\n- Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each result should be a list containing three elements: the prime $p$, the list of residues for even $k$ in the specified range, and a boolean indicating regularity. For example, the overall format is $$\\bigl[\\,[p,\\,[r_2,r_4,\\dots],\\,\\text{is\\_regular}],\\;[\\dots],\\;\\dots\\,\\bigr],$$ printed as a single line with no spaces.\n\nTest suite:\n- Include the primes $p \\in \\{\\,3,\\,5,\\,7,\\,13,\\,37,\\,59,\\,67\\,\\}$.\n- Coverage design:\n  - $p=3$: boundary case where the set of even $k$ with $2 \\le k \\le p-3$ is empty, so regularity holds vacuously.\n  - $p=5,\\,7,\\,13$: regular primes with small ranges to validate the computation pipeline.\n  - $p=37$: the smallest irregular prime, expected to have at least one zero residue in the specified range.\n  - $p=59,\\,67$: additional irregular primes to exercise larger Bernoulli indices and confirm robustness.\n- Output type specification: for each prime $p$, output a list $[p,\\,[\\text{integer residues}],\\,\\text{boolean}]$. The final output is a single list aggregating these per-prime results into one line in the format described above. No physical units or angle units are involved. Percentages are not used; all outputs are integers and booleans.", "solution": "The problem of determining the regularity of a prime number $p$ is a significant task in algebraic number theory. This solution will derive and implement an algorithm to test for regularity based on Kummer's criterion, using an exact computation of Bernoulli numbers.\n\n### Step 1: Derivation of a Recurrence Relation for Bernoulli Numbers\n\nThe Bernoulli numbers, $\\{B_n\\}_{n\\ge 0}$, are defined by their exponential generating function:\n$$\n\\frac{x}{e^x - 1} = \\sum_{n=0}^{\\infty} B_n \\frac{x^n}{n!}\n$$\nTo derive a recurrence relation, we manipulate this equation. Multiplying both sides by $(e^x-1)$, we get:\n$$\nx = (e^x - 1) \\left( \\sum_{n=0}^{\\infty} B_n \\frac{x^n}{n!} \\right)\n$$\nWe express $e^x - 1$ as its Taylor series expansion around $x=0$:\n$$\ne^x - 1 = \\sum_{k=1}^{\\infty} \\frac{x^k}{k!}\n$$\nSubstituting this into the equation yields:\n$$\nx = \\left( \\sum_{k=1}^{\\infty} \\frac{x^k}{k!} \\right) \\left( \\sum_{n=0}^{\\infty} B_n \\frac{x^n}{n!} \\right)\n$$\nThis is a Cauchy product of two power series. The coefficient of $x^m/m!$ on the left side is $1$ for $m=1$ and $0$ otherwise. On the right, the coefficient of $x^m/m!$ is given by the convolution $\\sum_{n=0}^m \\binom{m}{n} a_n B_{m-n}$, where the sequence $\\{a_n\\}$ corresponds to $e^x-1$, so $a_0=0$ and $a_n=1$ for $n \\ge 1$.\n\nFor $m=1$: $1 = \\binom{1}{0} a_0 B_1 + \\binom{1}{1} a_1 B_0 = 1 \\cdot 1 \\cdot B_0 = B_0$. Thus, $B_0=1$.\n\nFor $m \\ge 2$, the coefficient is $0$:\n$$\n0 = \\sum_{n=0}^{m} \\binom{m}{n} a_n B_{m-n} = \\binom{m}{0} a_0 B_m + \\sum_{n=1}^{m} \\binom{m}{n} a_n B_{m-n}\n$$\nSince $a_0=0$ and $a_n=1$ for $n \\ge 1$, this becomes:\n$$\n0 = \\sum_{n=1}^{m} \\binom{m}{n} B_{m-n}\n$$\nChanging the index of summation to $j = m-n$:\n$$\n\\sum_{j=0}^{m-1} \\binom{m}{m-j} B_j = \\sum_{j=0}^{m-1} \\binom{m}{j} B_j = 0 \\quad \\text{for } m \\ge 2.\n$$\nThis is the desired recurrence relation. We can use it to compute $B_k$ for $k \\ge 1$ given the preceding values. To compute $B_{m-1}$, we rewrite the relation for index $m$:\n$$\n\\sum_{n=0}^{m-1} \\binom{m}{n} B_n = \\binom{m}{m-1}B_{m-1} + \\sum_{n=0}^{m-2} \\binom{m}{n} B_n = 0\n$$\nSolving for $B_{m-1}$:\n$$\nm B_{m-1} = - \\sum_{n=0}^{m-2} \\binom{m}{n} B_n\n$$\nLet's set $k = m-1$. For $k \\ge 1$:\n$$\n(k+1) B_k = - \\sum_{n=0}^{k-1} \\binom{k+1}{n} B_n \\implies B_k = -\\frac{1}{k+1} \\sum_{n=0}^{k-1} \\binom{k+1}{n} B_n\n$$\nStarting with $B_0=1$, this relation allows the successive computation of all Bernoulli numbers as exact rational numbers.\n\n### Step 2: Justification of the Modulo $p$ Reduction\n\nThe problem requires computing residues $B_k \\bmod p$ for even integers $k$ in the range $2 \\le k \\le p-3$. A Bernoulli number $B_k$ is a rational number, which we can write in reduced form as $N_k/D_k$. The residue modulo $p$ is well-defined as $N_k \\cdot (D_k^{-1} \\bmod p) \\pmod p$ if and only if the denominator $D_k$ is not divisible by $p$, i.e., $\\gcd(D_k, p)=1$.\n\nThe von Staudt-Clausen theorem provides the necessary justification. It states that for an even index $2m > 0$, the denominator of $B_{2m}$ is given by the product of all prime numbers $q$ for which $(q-1)$ divides $2m$.\n$$\nD_{2m} = \\prod_{(q-1) | 2m, \\text{ q is prime}} q\n$$\nWe are interested in $B_k$ for even $k$ in the range $2 \\le k \\le p-3$. For $p$ to be a factor of the denominator $D_k$, it must be a prime $q$ such that $(q-1)$ divides $k$. In our case, this would mean $(p-1)$ must divide $k$.\n\nHowever, the specified range for $k$ is $2 \\le k \\le p-3$. This implies $k  p-1$. Since $k$ is positive, it is impossible for $(p-1)$ to divide $k$. Therefore, $p$ cannot be a factor in the denominator of $B_k$ for any $k$ in the specified range.\n\nThis confirms that $D_k \\not\\equiv 0 \\pmod p$, so the modular inverse $D_k^{-1} \\pmod p$ exists and is unique. The computation of $B_k \\bmod p$ is thus a valid operation.\n\n### Step 3: Justification of the Regularity Test\n\nKummer's criterion establishes the connection between regular primes and Bernoulli numbers. It states that an odd prime $p$ is regular if and only if $p$ does not divide the numerators of the Bernoulli numbers $B_2, B_4, \\dots, B_{p-3}$.\n\nLet $B_k = N_k/D_k$. The condition \"$p$ does not divide the numerator $N_k$\" is equivalent to $N_k \\not\\equiv 0 \\pmod p$.\nAs established in Step 2, $D_k \\not\\equiv 0 \\pmod p$. The residue of $B_k$ modulo $p$ is $B_k \\pmod p \\equiv N_k \\cdot (D_k^{-1}) \\pmod p$.\nThus, $B_k \\equiv 0 \\pmod p$ if and only if $N_k \\equiv 0 \\pmod p$, because $D_k^{-1} \\pmod p$ is non-zero.\n\nSo, Kummer's criterion can be restated as: an odd prime $p$ is regular if and only if $B_k \\not\\equiv 0 \\pmod p$ for all even integers $k$ in the range $2 \\le k \\le p-3$.\n\nThe algorithm is therefore:\n1. For a given prime $p$, compute $B_k$ for all even $k$ where $2 \\le k \\le p-3$.\n2. For each such $B_k$, calculate its residue modulo $p$.\n3. If all these residues are non-zero, the prime $p$ is regular.\n4. If at least one residue is zero, the prime $p$ is irregular.\n\nFor boundary cases like $p=3$, the range for $k$ is $2 \\le k \\le 0$, which is an empty set. The condition is therefore vacuously satisfied, and $p=3$ is regular. For $p=5$, we only check $B_2$. For $p=7$, we check $B_2, B_4$. And so on.\n\nThis completes the derivation and justification of the computational procedure. The implementation will follow this logic.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport math\nimport fractions\n\ndef compute_bernoulli(n_max):\n    \"\"\"\n    Computes Bernoulli numbers B_0, B_1, ..., n_max using the derived recurrence.\n    Returns a list of fractions.Fraction objects.\n    \"\"\"\n    B = [fractions.Fraction(1)]  # B_0 = 1\n    if n_max == 0:\n        return B\n    # B_1 = -1/2\n    B.append(fractions.Fraction(-1, 2))\n    \n    for k in range(2, n_max + 1):\n        if k % 2 == 1 and k > 1:\n            B.append(fractions.Fraction(0))\n            continue\n        \n        # B_k = -1/(k+1) * sum_{n=0}^{k-1} C(k+1, n) * B_n\n        s = fractions.Fraction(0)\n        for n in range(k):\n            comb = fractions.Fraction(math.comb(k + 1, n))\n            s += comb * B[n]\n        B.append(-s / (k + 1))\n    return B\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite of primes.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [3, 5, 7, 13, 37, 59, 67]\n\n    # Pre-compute all Bernoulli numbers needed for the largest prime.\n    max_p = max(test_cases) if test_cases else 0\n    # The max index k is p-3.\n    max_k = max(0, max_p - 3)\n    bernoulli_numbers = compute_bernoulli(max_k)\n\n    results = []\n    for p in test_cases:\n        # The range of even k is 2 = k = p-3\n        k_max = p - 3\n        \n        # Handle the boundary case p=3, where the set of k is empty.\n        if k_max  2:\n            is_regular = True\n            residues = []\n            results.append([p, residues, is_regular])\n            continue\n            \n        residues = []\n        is_regular = True\n        \n        # Iterate over even k from 2 to p-3\n        for k in range(2, k_max + 1, 2):\n            bk = bernoulli_numbers[k]\n            \n            # Since k = p-3, p-1 does not divide k, so p does not divide\n            # the denominator of B_k by Von Staudt-Clausen theorem.\n            # Thus, the modular inverse of the denominator exists.\n            num = bk.numerator\n            den = bk.denominator\n            \n            # Compute modular inverse using Fermat's Little Theorem: a^(p-2) mod p for prime p\n            # Python's pow(a, -1, m) available since 3.8 handles this efficiently.\n            den_inv = pow(den, -1, p)\n            \n            residue = (num * den_inv) % p\n            residues.append(residue)\n            \n            # Check for irregularity condition from Kummer's criterion\n            if residue == 0:\n                is_regular = False\n        \n        results.append([p, residues, is_regular])\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists, with no spaces.\n    # str(results) produces '[...]', and we remove spaces.\n    final_output_str = str(results).replace(\" \", \"\").replace(\"True\", \"true\").replace(\"False\", \"false\")\n    print(final_output_str)\n\nsolve()\n```", "id": "3022718"}]}