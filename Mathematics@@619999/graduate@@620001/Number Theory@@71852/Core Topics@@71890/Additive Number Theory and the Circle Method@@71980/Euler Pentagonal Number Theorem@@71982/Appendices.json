{"hands_on_practices": [{"introduction": "This first practice delves into the combinatorial heart of the Euler Pentagonal Number Theorem. Instead of treating the theorem as a given formula, you will reconstruct its elegant proof by building Franklin's sign-reversing involution on the set of partitions into distinct parts. This powerful technique provides a beautiful explanation for why the product expansion $\\prod_{n=1}^{\\infty} (1 - q^n)$ is so sparse, revealing that non-zero coefficients only appear for exponents that are generalized pentagonal numbers [@problem_id:3013526].", "problem": "Let $q$ be an indeterminate and consider the infinite product generating function (GF) $$F(q) = \\prod_{n=1}^{\\infty} \\left(1 - q^{n}\\right),$$ viewed as a formal power series (FPS) in $q$. A generalized pentagonal number is any integer of the form $$\\frac{k(3k-1)}{2} \\quad \\text{or} \\quad \\frac{k(3k+1)}{2}$$ for $k \\in \\mathbb{Z}_{>0}$, together with $0$.\n\nStarting from the formal expansion of $F(q)$ and the combinatorial interpretation of its coefficients as alternating sums over partitions into distinct parts, do the following:\n\n1. Express the coefficient $[q^{m}]F(q)$ purely in terms of partitions of $m$ into distinct parts and their cardinalities. Construct a sign-reversing involution on the set of partitions of $m$ into distinct parts (excluding any exceptional configurations you identify), and rigorously justify that this involution pairs all non-exceptional partitions so that their contributions cancel in $[q^{m}]F(q)$.\n\n2. Deduce from your involution that $[q^{m}]F(q)$ is nonzero only when $m$ is a generalized pentagonal number, and that the nonzero coefficients follow an alternating sign pattern occurring in pairs.\n\n3. List the first $20$ generalized pentagonal numbers in increasing order, and for each of these $20$ exponents indicate the sign of the corresponding coefficient in $F(q)$ you have justified in Part $2$.\n\n4. Using your established pattern, determine the exact integer value of the coefficient $[q^{155}]F(q)$.\n\nYour final answer must be a single integer. No rounding is required.", "solution": "The problem asks for a complete analysis of the coefficients of the infinite product $F(q) = \\prod_{n=1}^{\\infty} (1 - q^{n})$, culminating in the calculation of a specific coefficient, $[q^{155}]F(q)$. This requires a combinatorial proof of Euler's pentagonal number theorem.\n\nFirst, we interpret the coefficient $[q^m]F(q)$ for a given integer $m \\ge 0$. The function $F(q)$ is formally expanded as:\n$$ F(q) = (1-q^1)(1-q^2)(1-q^3)\\cdots $$\nA term $q^m$ in the expansion is formed by selecting a finite number of terms of the form $-q^{\\lambda_i}$ from the factors $(1-q^{\\lambda_i})$ and multiplying them together, such that the exponents sum to $m$. Specifically, a term $(-1)^k q^{\\lambda_1} q^{\\lambda_2} \\cdots q^{\\lambda_k}$ is produced if we choose the terms $-q^{\\lambda_i}$ from the corresponding factors, where $\\lambda_1, \\lambda_2, \\ldots, \\lambda_k$ are distinct positive integers that sum to $m$. This set of integers $\\{\\lambda_1, \\ldots, \\lambda_k\\}$ defines a partition of $m$ into $k$ distinct parts.\n\nThe coefficient of $q^m$, denoted $[q^m]F(q)$, is the sum of $(-1)^k$ over all partitions of $m$ into $k$ distinct parts. Let $\\mathcal{D}(m)$ be the set of all partitions of $m$ into distinct parts, and for a partition $\\lambda \\in \\mathcal{D}(m)$, let $k(\\lambda)$ be the number of parts in $\\lambda$. Then,\n$$ [q^m]F(q) = \\sum_{\\lambda \\in \\mathcal{D}(m)} (-1)^{k(\\lambda)} $$\nLet $p_e(m)$ be the number of partitions of $m$ into an even number of distinct parts, and $p_o(m)$ be the number of partitions of $m$ into an odd number of distinct parts. The coefficient can then be written as $[q^m]F(q) = p_e(m) - p_o(m)$.\n\n### Part 1: The Sign-Reversing Involution\n\nTo evaluate this sum, we construct a sign-reversing involution on the set $\\mathcal{D}(m)$, following the method of Franklin. An involution is a map $\\phi: \\mathcal{D}(m) \\to \\mathcal{D}(m)$ such that $\\phi(\\phi(\\lambda)) = \\lambda$ for all $\\lambda \\in \\mathcal{D}(m)$. It is sign-reversing if, for any $\\lambda$ that is not a fixed point (i.e., $\\phi(\\lambda) \\neq \\lambda$), the parity of the number of parts of $\\phi(\\lambda)$ is different from that of $\\lambda$. That is, $(-1)^{k(\\phi(\\lambda))} = -(-1)^{k(\\lambda)}$. Consequently, the contributions of $\\lambda$ and $\\phi(\\lambda)$ to the sum cancel each other out. The total sum is then simply the sum of contributions from the fixed points of the involution.\n\nLet $\\lambda = (\\lambda_1, \\lambda_2, \\ldots, \\lambda_k)$ be a partition of $m$ into $k$ distinct parts, ordered such that $\\lambda_1 > \\lambda_2 > \\cdots > \\lambda_k > 0$. We define two geometric properties of its Ferrers diagram:\n1.  The smallest part, $s(\\lambda) = \\lambda_k$.\n2.  The length of the \"run\" at the top, $r(\\lambda)$, which is the largest integer $j$ such that $\\lambda_i = \\lambda_1 - i + 1$ for all $i \\in \\{1, 2, \\ldots, j\\}$.\n\nThe involution $\\phi$ is defined as follows:\n- **Case 1: $s(\\lambda) \\le r(\\lambda)$**. We define $\\phi(\\lambda)$ by removing the smallest part, $\\lambda_k = s(\\lambda)$, and adding $1$ to each of the first $s(\\lambda)$ largest parts. The new partition, $\\lambda'$, has parts $(\\lambda_1+1, \\ldots, \\lambda_{s(\\lambda)}+1, \\lambda_{s(\\lambda)+1}, \\ldots, \\lambda_{k-1})$. The number of parts becomes $k-1$.\n- **Case 2: $s(\\lambda) > r(\\lambda)$**. We define $\\phi(\\lambda)$ by taking the top run of length $r(\\lambda)$, reducing each of the first $r(\\lambda)$ parts by $1$, and forming a new smallest part of size $r(\\lambda)$. The new partition, $\\lambda'$, has parts $(\\lambda_1-1, \\ldots, \\lambda_{r(\\lambda)}-1, \\lambda_{r(\\lambda)+1}, \\ldots, \\lambda_k, r(\\lambda))$. The number of parts becomes $k+1$.\n\nThis map is well-defined and reverses the parity of the number of parts, except for certain \"exceptional\" configurations where the operation is invalid. These are the fixed points of the involution.\n\n- **Justification of Involution:** If we start with a partition $\\lambda$ in Case 1, an application of the map yields $\\lambda'$ with $k-1$ parts. For $\\lambda'$, the new smallest part is $s(\\lambda') \\ge \\lambda_{k-1} > \\lambda_k = s(\\lambda)$, and the new top run is $r(\\lambda')=s(\\lambda)$. Thus $s(\\lambda') > r(\\lambda')$, so $\\lambda'$ is in Case 2. Applying the Case 2 operation to $\\lambda'$ reverses the initial transformation, returning $\\lambda$. A similar argument shows that applying the map to a partition in Case 2 yields a partition in Case 1, and applying it again returns the original partition. Thus, $\\phi$ is an involution on the set of non-exceptional partitions.\n\n- **Exceptional Configurations (Fixed Points):** The transformation fails if it produces an invalid partition (i.e., one with non-distinct parts).\n1.  **Failure in Case 1 ($s \\le r$):** This transformation fails if we are in Case 1 and the partition consists of $k$ parts forming a consecutive run, with the smallest part being $s(\\lambda)=k$. This implies $r(\\lambda) \\ge s(\\lambda)=k$. Since $r(\\lambda)$ cannot be larger than $k$, we have $r(\\lambda)=k$. The parts are $(2k-1, 2k-2, \\ldots, k)$. For this partition, attempting to move the smallest part $s=k$ would make the new $k$-th part equal to the original $(k-1)$-th part. Thus, it is a fixed point. The sum is $m = \\sum_{j=0}^{k-1}(k+j) = k^2 + \\frac{k(k-1)}{2} = \\frac{k(3k-1)}{2}$. For such a partition, the number of parts is $k$, so its contribution to $[q^m]F(q)$ is $(-1)^k$.\n\n2.  **Failure in Case 2 ($s > r$):** This transformation fails if it results in an invalid partition. This happens when $r=k$ and $s=k+1$. In this case, the partition consists of $k$ consecutive integers, from $\\lambda_1$ down to $\\lambda_k=s=k+1$. Thus the parts are $(2k, 2k-1, \\ldots, k+1)$. For such a partition, we are in Case 2 since $s=k+1 > r=k$. Applying the operation would mean decreasing the $k$ parts by 1 to get $(2k-1, \\ldots, k)$ and adding a new part of size $r=k$. The new set of parts would be $\\{2k-1, \\ldots, k+1, k, k\\}$, which is invalid due to the repeated part $k$. Therefore, this partition is a fixed point. The sum of its parts is $m = \\sum_{j=0}^{k-1}(k+1+j) = k(k+1) + \\frac{k(k-1)}{2} = \\frac{k(3k+1)}{2}$. The number of parts is $k$, so its contribution is $(-1)^k$.\n\n### Part 2: Deduction of the Theorem\n\nThe involution $\\phi$ pairs up every non-exceptional partition of $m$ into distinct parts with another such partition having a number of parts of opposite parity. Their contributions to $[q^m]F(q)$ cancel out. Therefore, $[q^m]F(q)$ is zero unless $m$ has an exceptional partition, i.e., $m$ is a generalized pentagonal number.\n\n- If $m = \\frac{k(3k-1)}{2}$ for some $k \\in \\mathbb{Z}_{>0}$, there is exactly one unpaired partition with $k$ parts. The coefficient is $[q^m]F(q) = (-1)^k$.\n- If $m = \\frac{k(3k+1)}{2}$ for some $k \\in \\mathbb{Z}_{>0}$, there is exactly one unpaired partition with $k$ parts. The coefficient is $[q^m]F(q) = (-1)^k$.\n- If $m=0$, the only partition is the empty partition, with $k=0$ parts. $p_e(0)=1, p_o(0)=0$. So $[q^0]F(q)=1$. This corresponds to the case $k=0$, as $\\frac{0(3(0)-1)}{2}=0$ and $(-1)^0=1$.\n- For all other integers $m$, $[q^m]F(q) = 0$.\n\nCombining these results gives Euler's pentagonal number theorem:\n$$ \\prod_{n=1}^{\\infty} (1 - q^{n}) = 1 + \\sum_{k=1}^{\\infty} (-1)^k \\left( q^{\\frac{k(3k-1)}{2}} + q^{\\frac{k(3k+1)}{2}} \\right) $$\nThe nonzero coefficients follow an alternating sign pattern determined by $(-1)^k$. For each positive integer $k$, there are two pentagonal numbers, $\\frac{k(3k-1)}{2}$ and $\\frac{k(3k+1)}{2}$. The corresponding coefficients in the series for $F(q)$ are both equal to $(-1)^k$. So for $k=1$ the signs are negative, for $k=2$ they are positive, for $k=3$ negative, and so on, occurring in pairs.\n\n### Part 3: First 20 Generalized Pentagonal Numbers and Signs\n\nWe generate the numbers $m_k^{-} = \\frac{k(3k-1)}{2}$ and $m_k^{+} = \\frac{k(3k+1)}{2}$ for $k \\ge 0$. The sign of the coefficient is $(-1)^k$.\n\n- $k=0$: $m=0$. Sign: $(+)$.\n- $k=1$: $m_1^{-}=1$, $m_1^{+}=2$. Sign: $(-)$.\n- $k=2$: $m_2^{-}=5$, $m_2^{+}=7$. Sign: $(+)$.\n- $k=3$: $m_3^{-}=12$, $m_3^{+}=15$. Sign: $(-)$.\n- $k=4$: $m_4^{-}=22$, $m_4^{+}=26$. Sign: $(+)$.\n- $k=5$: $m_5^{-}=35$, $m_5^{+}=40$. Sign: $(-)$.\n- $k=6$: $m_6^{-}=51$, $m_6^{+}=57$. Sign: $(+)$.\n- $k=7$: $m_7^{-}=70$, $m_7^{+}=77$. Sign: $(-)$.\n- $k=8$: $m_8^{-}=92$, $m_8^{+}=100$. Sign: $(+)$.\n- $k=9$: $m_9^{-}=117$, $m_9^{+}=126$. Sign: $(-)$.\n- $k=10$: $m_{10}^{-}=145$, $m_{10}^{+}=155$. Sign: $(+)$.\n\nListing the first $20$ generalized pentagonal numbers in increasing order and their signs:\n1.  $m=0$: sign $(+)$\n2.  $m=1$: sign $(-)$\n3.  $m=2$: sign $(-)$\n4.  $m=5$: sign $(+)$\n5.  $m=7$: sign $(+)$\n6.  $m=12$: sign $(-)$\n7.  $m=15$: sign $(-)$\n8.  $m=22$: sign $(+)$\n9.  $m=26$: sign $(+)$\n10. $m=35$: sign $(-)$\n11. $m=40$: sign $(-)$\n12. $m=51$: sign $(+)$\n13. $m=57$: sign $(+)$\n14. $m=70$: sign $(-)$\n15. $m=77$: sign $(-)$\n16. $m=92$: sign $(+)$\n17. $m=100$: sign $(+)$\n18. $m=117$: sign $(-)$\n19. $m=126$: sign $(-)$\n20. $m=145$: sign $(+)$\n\n### Part 4: The Coefficient of $q^{155}$\n\nTo find $[q^{155}]F(q)$, we must first determine if $155$ is a generalized pentagonal number. We test the two formulas:\n1.  $\\frac{k(3k-1)}{2} = 155 \\implies 3k^2 - k = 310 \\implies 3k^2 - k - 310 = 0$. Using the quadratic formula, $k = \\frac{1 \\pm \\sqrt{1 - 4(3)(-310)}}{6} = \\frac{1 \\pm \\sqrt{1+3720}}{6} = \\frac{1 \\pm \\sqrt{3721}}{6}$. Since $\\sqrt{3721}=61$, we have $k = \\frac{1 \\pm 61}{6}$. This gives $k = \\frac{62}{6}$ (not an integer) or $k = \\frac{-60}{6}=-10$. A positive integer solution for $k$ does not exist in this case.\n\n2.  $\\frac{k(3k+1)}{2} = 155 \\implies 3k^2 + k = 310 \\implies 3k^2 + k - 310 = 0$. Using the quadratic formula, $k = \\frac{-1 \\pm \\sqrt{1 - 4(3)(-310)}}{6} = \\frac{-1 \\pm \\sqrt{1+3720}}{6} = \\frac{-1 \\pm 61}{6}$. This gives $k = \\frac{60}{6}=10$ or $k = \\frac{-62}{6}$ (not an integer).\n\nWe find that $155$ is a generalized pentagonal number corresponding to $k=10$ in the form $\\frac{k(3k+1)}{2}$.\nAccording to the theorem derived above, the coefficient is $(-1)^k$.\nFor $k=10$, the coefficient is $(-1)^{10} = 1$.\n\nTherefore, the exact integer value of the coefficient $[q^{155}]F(q)$ is $1$.", "answer": "$$\n\\boxed{1}\n$$", "id": "3013526"}, {"introduction": "Having explored the theoretical proof, this exercise grounds your understanding in concrete calculation and helps you master its application. By directly enumerating partitions of small integers $n$, you will compute the first few coefficients of the series $\\prod_{n=1}^{\\infty} (1 - q^n)$ from scratch. This hands-on verification will solidify your grasp of the theorem's specific sign pattern and exponent families, sharpening your ability to identify and correct common misconceptions [@problem_id:3013508].", "problem": "Let $q$ be an indeterminate, and consider the formal product $G(q) = \\prod_{m \\geq 1} \\left(1 - q^{m}\\right)$. This product is the signed generating function for partitions into distinct parts, in the sense that when $G(q)$ is expanded as a formal power series, the coefficient of $q^{n}$ is the difference between the number of partitions of $n$ into an even number of distinct parts and the number of partitions of $n$ into an odd number of distinct parts. Starting only from this product definition and the interpretation just stated, determine the correct list of the first nonzero terms of $G(q)$ up to and including degree $15$, and use explicit small-degree calculations to correct common misconceptions such as confusing the exponent families $k(3k-1)/2$ and $k(3k+1)/2$, or mis-assigning the sign pattern of consecutive terms. Which option is correct?\n\nA. $G(q) = 1 - q - q^{2} + q^{5} + q^{7} - q^{12} - q^{15} + O\\!\\left(q^{16}\\right)$\n\nB. $G(q) = 1 - q - q^{3} + q^{4} + q^{8} - q^{9} - q^{13} + O\\!\\left(q^{14}\\right)$\n\nC. $G(q) = 1 - q + q^{2} - q^{5} + q^{7} - q^{12} + q^{15} + O\\!\\left(q^{16}\\right)$\n\nD. $G(q) = 1 - q - q^{2} + q^{4} + q^{7} - q^{10} - q^{13} + O\\!\\left(q^{14}\\right)$", "solution": "The problem statement is evaluated to be **valid**. It is mathematically and scientifically sound, well-posed, and objective. It poses a verifiable question about a standard result in number theory, Euler's pentagonal number theorem, founded on the formal expansion of the Euler function $G(q) = \\prod_{m \\geq 1} (1 - q^m)$. The problem directs a solution based on first principles—direct calculation and combinatorial interpretation—which is a legitimate and feasible approach.\n\nThe problem asks for the expansion of the formal product $G(q) = \\prod_{m \\geq 1} (1 - q^m)$ up to degree $15$. The coefficient of $q^n$ in the expansion of $G(q)$ is given by the difference between the number of partitions of $n$ into an even number of distinct parts, denoted $d_e(n)$, and the number of partitions of $n$ into an odd number of distinct parts, denoted $d_o(n)$. Let this coefficient be $c_n = d_e(n) - d_o(n)$. We will compute $c_n$ for small values of $n$ by explicitly listing the partitions.\n\nFor $n=0$: The only partition is the empty partition, which has $0$ parts. Since $0$ is an even number, $d_e(0) = 1$ and $d_o(0) = 0$. Thus, $c_0 = 1$.\n\nFor $n=1$: The only partition into distinct parts is $(1)$. It has $1$ part (odd).\n$d_e(1) = 0$, $d_o(1) = 1$. So, $c_1 = 0 - 1 = -1$.\n\nFor $n=2$: The only partition into distinct parts is $(2)$. It has $1$ part (odd).\n$d_e(2) = 0$, $d_o(2) = 1$. So, $c_2 = 0 - 1 = -1$.\n\nFor $n=3$: The partitions into distinct parts are $(3)$ and $(2,1)$.\n$(3)$ has $1$ part (odd). $(2,1)$ has $2$ parts (even).\n$d_e(3) = 1$, $d_o(3) = 1$. So, $c_3 = 1 - 1 = 0$.\n\nFor $n=4$: The partitions into distinct parts are $(4)$ and $(3,1)$.\n$(4)$ has $1$ part (odd). $(3,1)$ has $2$ parts (even).\n$d_e(4) = 1$, $d_o(4) = 1$. So, $c_4 = 1 - 1 = 0$.\n\nFor $n=5$: The partitions into distinct parts are $(5)$, $(4,1)$, and $(3,2)$.\n$(5)$ has $1$ part (odd). $(4,1)$ has $2$ parts (even). $(3,2)$ has $2$ parts (even).\n$d_e(5) = 2$, $d_o(5) = 1$. So, $c_5 = 2 - 1 = 1$.\n\nFor $n=6$: The partitions into distinct parts are $(6)$, $(5,1)$, $(4,2)$, and $(3,2,1)$.\n$(6)$ has $1$ part (odd). $(5,1)$ has $2$ parts (even). $(4,2)$ has $2$ parts (even). $(3,2,1)$ has $3$ parts (odd).\n$d_e(6) = 2$, $d_o(6) = 2$. So, $c_6 = 2 - 2 = 0$.\n\nFor $n=7$: The partitions into distinct parts are $(7)$, $(6,1)$, $(5,2)$, $(4,3)$, and $(4,2,1)$.\n$(7)$ has $1$ part (odd). $(6,1)$, $(5,2)$, $(4,3)$ each have $2$ parts (even). $(4,2,1)$ has $3$ parts (odd).\n$d_e(7) = 3$, $d_o(7) = 2$. So, $c_7 = 3 - 2 = 1$.\n\nSo far, the series is $G(q) = 1 - q - q^2 + q^5 + q^7 + \\dots$.\n\nThese calculations exemplify Franklin's bijection, a combinatorial proof which shows that for most integers $n$, $d_e(n) = d_o(n)$, and thus $c_n=0$. The bijection fails only when $n$ is a generalized pentagonal number, which are integers of the form $n = \\frac{j(3j-1)}{2}$ for any non-zero integer $j$. In these cases, $c_n = (-1)^j$.\n\nLet's identify the generalized pentagonal numbers up to $15$:\nFor $j=1$: $n = \\frac{1(3(1)-1)}{2} = \\frac{2}{2} = 1$. The coefficient is $c_1 = (-1)^1 = -1$.\nFor $j=-1$: $n = \\frac{-1(3(-1)-1)}{2} = \\frac{-1(-4)}{2} = 2$. The coefficient is $c_2 = (-1)^{-1} = -1$.\nFor $j=2$: $n = \\frac{2(3(2)-1)}{2} = \\frac{2(5)}{2} = 5$. The coefficient is $c_5 = (-1)^2 = 1$.\nFor $j=-2$: $n = \\frac{-2(3(-2)-1)}{2} = \\frac{-2(-7)}{2} = 7$. The coefficient is $c_7 = (-1)^{-2} = 1$.\nFor $j=3$: $n = \\frac{3(3(3)-1)}{2} = \\frac{3(8)}{2} = 12$. The coefficient is $c_{12} = (-1)^3 = -1$.\nFor $j=-3$: $n = \\frac{-3(3(-3)-1)}{2} = \\frac{-3(-10)}{2} = 15$. The coefficient is $c_{15} = (-1)^{-3} = -1$.\nFor $j=4$: $n = \\frac{4(3(4)-1)}{2} = \\frac{4(11)}{2} = 22$. This is beyond the required degree.\n\nAll other integers $n \\le 15$ that are not in this list ($3, 4, 6, 8, 9, 10, 11, 13, 14$) are not generalized pentagonal numbers, and therefore their corresponding coefficients are $0$. This is consistent with our explicit calculations for $n=3, 4, 6$. The problem asks to address common misconceptions. The two families of exponents, arising from positive and negative $j$, are $\\frac{k(3k-1)}{2}$ ($1, 5, 12, \\dots$) and $\\frac{k(3k+1)}{2}$ ($2, 7, 15, \\dots$) for $k \\ge 1$. A common error is to miss one of these families. Another error is to mis-assign the signs. The sign is $(-1)^j$, which leads to a pattern of two negatives, two positives, two negatives, and so on: $(-1, -1, +1, +1, -1, -1, \\dots)$.\n\nAssembling the terms up to degree $15$, we have:\n$G(q) = c_0 + c_1 q + c_2 q^2 + \\dots + c_{15} q^{15} + O(q^{16})$\n$G(q) = 1 + (-1)q + (-1)q^2 + (0)q^3 + (0)q^4 + (1)q^5 + (0)q^6 + (1)q^7 + (0)q^8 + (0)q^9 + (0)q^{10} + (0)q^{11} + (-1)q^{12} + (0)q^{13} + (0)q^{14} + (-1)q^{15} + O(q^{16})$\n$G(q) = 1 - q - q^2 + q^5 + q^7 - q^{12} - q^{15} + O(q^{16})$\n\nNow, we evaluate each of the given options.\n\nA. $G(q) = 1 - q - q^{2} + q^{5} + q^{7} - q^{12} - q^{15} + O\\!\\left(q^{16}\\right)$\nThis expression matches our derived series term by term, including the exponents ($1, 2, 5, 7, 12, 15$) and their corresponding signs ($-, - , +, +, -, -$). The order of magnitude of the remainder term $O(q^{16})$ is correct as the next nonzero term is for $n=22$.\n**Verdict: Correct.**\n\nB. $G(q) = 1 - q - q^{3} + q^{4} + q^{8} - q^{9} - q^{13} + O\\!\\left(q^{14}\\right)$\nThis expression contains incorrect exponents. For example, it lists a nonzero coefficient for $q^3$, whereas our calculation shows $c_3=0$. It also lists nonzero coefficients for $q^4, q^8, q^9, q^{13}$, all of which should be zero. It omits the term $-q^2$.\n**Verdict: Incorrect.**\n\nC. $G(q) = 1 - q + q^{2} - q^{5} + q^{7} - q^{12} + q^{15} + O\\!\\left(q^{16}\\right)$\nThis expression has the correct exponents but incorrect signs for several terms. The coefficient of $q^2$ should be $-1$, not $+1$. The coefficient of $q^5$ should be $+1$, not $-1$. The coefficient of $q^{15}$ should be $-1$, not $+1$. These errors reflect a misunderstanding of how the signs $(-1)^j$ are determined.\n**Verdict: Incorrect.**\n\nD. $G(q) = 1 - q - q^{2} + q^{4} + q^{7} - q^{10} - q^{13} + O\\!\\left(q^{14}\\right)$\nThis expression contains incorrect exponents. It lists nonzero coefficients for $q^4, q^{10}, q^{13}$, which should all be zero. It omits the correct term $+q^5$.\n**Verdict: Incorrect.**\n\nBased on the derivations from first principles as requested, only option A is correct.", "answer": "$$\\boxed{A}$$", "id": "3013508"}, {"introduction": "The Euler Pentagonal Number Theorem is more than just a striking identity; it is a fundamental tool for computation in number theory. This practice challenges you to derive and implement the famous recurrence relation for the partition function $p(n)$, which is a direct consequence of the theorem. Analyzing the resulting algorithm will demonstrate how this identity allows for the efficient calculation of $p(n)$ for all $n \\le N$ in $O(N^{3/2})$ time, a dramatic improvement over naive approaches [@problem_id:3013550].", "problem": "You are to design, justify, and implement an algorithm that computes the integer partition function values $p(n)$ for all integers $n$ with $0 \\le n \\le N$ using a recurrence derived from Euler’s pentagonal number theorem. The goal is to achieve total time complexity $O(N^{3/2})$ in the sense of Big-Oh (Big-O) notation, by bounding the number of terms needed per $n$ via constraints on the integers $k$ for which the generalized pentagonal numbers $P_k$ satisfy $P_k \\le n$. Your derivation must start from first principles that are standard in number theory: the definition of the partition function $p(n)$, the multiplicative generating function for partitions, and expansions of infinite products. You must not assume or quote the recurrence itself but derive it from these principles, identify the relevant sign pattern, and prove the bound on the number of contributing indices $k$ as a function of $n$. Explicitly, you may use the definition of generalized pentagonal numbers $P_k$ given by $P_k = \\frac{k(3k-1)}{2}$ for positive $k$ and $P_{-k} = \\frac{k(3k+1)}{2}$ for positive $k$, and you should show how these enter the recurrence and the complexity analysis.\n\nAlgorithmic requirements:\n- Compute $p(n)$ for all $n$ with $0 \\le n \\le N$ using integer arithmetic, with the convention $p(0) = 1$ and $p(n) = 0$ for $n < 0$.\n- Use only additions and subtractions of previously computed $p(\\cdot)$ values indexed by offsets that are generalized pentagonal numbers not exceeding the current $n$.\n- Justify rigorously that for each $n$, the number of contributing terms is $O(\\sqrt{n})$, so that the total computation across all $n \\le N$ is $O\\!\\left(\\sum_{n=0}^{N} \\sqrt{n}\\right) = O(N^{3/2})$.\n- State and use the correct sign pattern that alternates in pairs according to the generalized pentagonal indices.\n\nTest suite:\n- Your program must compute and output the arrays $\\{p(0),p(1),\\dots,p(N)\\}$ for each $N$ in the following set: $\\{0,1,10,50,100,200\\}$.\n- Edge and boundary coverage are required: the case $N=0$ tests the base case $p(0)$, the case $N=1$ tests minimal nontrivial behavior, and larger cases test typical and stress conditions.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is itself a comma-separated list of integers enclosed in square brackets corresponding to one test case. For example, the output must look like $[[\\dots],[\\dots],\\dots]$.\n- There are no physical units or angles in this problem; all outputs are integers.", "solution": "The user-provided problem is assessed to be valid. It is a well-posed problem in computational number theory that is scientifically grounded, objective, and contains all necessary information for its resolution. The task is to compute the values of the integer partition function, $p(n)$, up to a given limit $N$, based on a recurrence derived from first principles, and to analyze the computational complexity of this method.\n\n### Derivation of the Recurrence Relation for $p(n)$\n\nThe solution is developed in four stages: establishing the generating function for $p(n)$, introducing Euler's pentagonal number theorem, deriving the recurrence by combining these two results, and finally, analyzing the computational complexity of the resulting algorithm.\n\n#### 1. The Generating Function for the Partition Function\n\nThe integer partition function, $p(n)$, counts the number of ways a non-negative integer $n$ can be written as a sum of positive integers, where the order of the summands does not matter. By convention, $p(0) = 1$ (the empty sum is the only partition of $0$) and we define $p(n) = 0$ for $n < 0$.\n\nThe generating function for the sequence $\\{p(n)\\}_{n=0}^\\infty$ is defined as the formal power series $P(x) = \\sum_{n=0}^{\\infty} p(n)x^n$. This function has a remarkable representation as an infinite product, discovered by Euler:\n$$\nP(x) = \\prod_{k=1}^{\\infty} \\frac{1}{1-x^k}\n$$\nTo understand this identity, we expand each factor in the product as a geometric series:\n$$\n\\frac{1}{1-x^k} = 1 + x^k + x^{2k} + x^{3k} + \\dots = \\sum_{j=0}^{\\infty} (x^k)^j\n$$\nThis series represents the ways to form a sum using only the integer $k$. The term $(x^k)^j$ corresponds to using the part $k$ exactly $j$ times, contributing $j \\cdot k$ to the total sum.\n\nExpanding the full product $P(x) = (1+x+x^2+\\dots)(1+x^2+x^4+\\dots)(1+x^3+x^6+\\dots)\\dots$ and collecting terms with the same power of $x$ gives the coefficient of $x^n$. A term $x^n$ is formed by picking one term $x^{j_1 \\cdot 1}$ from the first factor, $x^{j_2 \\cdot 2}$ from the second, and so on, such that their product is $x^n$. This requires the exponents to sum to $n$:\n$$\nj_1 \\cdot 1 + j_2 \\cdot 2 + j_3 \\cdot 3 + \\dots = n\n$$\nThis is precisely the definition of a partition of $n$, where the integer $1$ appears $j_1$ times, $2$ appears $j_2$ times, and so on. The coefficient of $x^n$ in the expanded product is therefore the total number of ways to form such a sum, which is $p(n)$.\n\n#### 2. Euler's Pentagonal Number Theorem\n\nEuler's pentagonal number theorem provides an expression for the reciprocal of the generating function $P(x)$:\n$$\n\\frac{1}{P(x)} = \\prod_{k=1}^{\\infty} (1-x^k)\n$$\nThe theorem states that this infinite product is equal to a sparse power series whose exponents are the generalized pentagonal numbers. The generalized pentagonal numbers, $P_k$, are given by the formula $P_k = \\frac{k(3k-1)}{2}$ for any integer $k \\in \\mathbb{Z}$.\n- For positive $k \\in \\{1, 2, 3, \\dots\\}$, we have $P_k = \\frac{k(3k-1)}{2}$, yielding the sequence $1, 5, 12, 22, \\dots$.\n- For negative $k'=-k$ where $k \\in \\{1, 2, 3, \\dots\\}$, we have $P_{-k} = \\frac{-k(3(-k)-1)}{2} = \\frac{k(3k+1)}{2}$, yielding the sequence $2, 7, 15, 26, \\dots$.\n- For $k=0$, $P_0 = 0$.\n\nEuler's theorem is stated as:\n$$\n\\prod_{k=1}^{\\infty} (1-x^k) = \\sum_{k=-\\infty}^{\\infty} (-1)^k x^{P_k}\n$$\nThis can be expanded as:\n$$\n\\sum_{k=-\\infty}^{\\infty} (-1)^k x^{\\frac{k(3k-1)}{2}} = 1 - x - x^2 + x^5 + x^7 - x^{12} - x^{15} + \\dots\n$$\nThe sign of the term $x^{P_k}$ is determined by $(-1)^k$. Note that the sign associated with the pair of pentagonal numbers $(P_k, P_{-k})$ for $k>0$ is the same, $(-1)^k$.\n\n#### 3. Derivation of the Recurrence\n\nWe now combine the two results. From the generating function identity, we have $P(x) \\left( \\prod_{k=1}^{\\infty} (1-x^k) \\right) = 1$. Substituting the series expansions for both factors yields:\n$$\n\\left( \\sum_{n=0}^{\\infty} p(n)x^n \\right) \\left( \\sum_{k=-\\infty}^{\\infty} (-1)^k x^{P_k} \\right) = 1\n$$\nThis equation states that the product of the two series is the constant $1$. This means the coefficient of $x^n$ in the product on the left-hand side must be $1$ for $n=0$ and $0$ for all $n \\ge 1$.\n\nThe coefficient of $x^n$ in the Cauchy product of two series $\\sum a_i x^i$ and $\\sum b_j x^j$ is $\\sum_k a_k b_{n-k}$. Applying this here, the coefficient of $x^n$ is:\n$$\n\\sum_{k=-\\infty}^{\\infty} p(n - P_k) \\cdot (-1)^k\n$$\n- For $n=0$: The only non-zero term is for $k=0$, since $P_k > 0$ for $k \\ne 0$ and $p(m)=0$ for $m<0$. This gives $p(0-P_0)(-1)^0 = p(0) \\cdot 1 = p(0)$. Equating to the coefficient of $x^0$ on the right side ($1$), we get $p(0)=1$, which is consistent with the standard definition.\n- For $n \\ge 1$: The coefficient is $0$.\n$$\n\\sum_{k=-\\infty}^{\\infty} (-1)^k p(n - P_k) = 0\n$$\nWe can isolate the $k=0$ term, which is $p(n-P_0) = p(n)$:\n$$\np(n) + \\sum_{k \\in \\mathbb{Z}, k \\neq 0} (-1)^k p(n - P_k) = 0\n$$\nSolving for $p(n)$:\n$$\np(n) = - \\sum_{k \\in \\mathbb{Z}, k \\neq 0} (-1)^k p(n - P_k) = \\sum_{k \\in \\mathbb{Z}, k \\neq 0} (-1)^{k+1} p(n - P_k)\n$$\nWe can split the sum over non-zero integers $k$ into a sum over positive $k$ and negative $k$:\n$$\np(n) = \\sum_{k=1}^{\\infty} (-1)^{k+1} p(n - P_k) + \\sum_{k=1}^{\\infty} (-1)^{-k+1} p(n - P_{-k})\n$$\nSince $(-1)^{-k+1} = (-1)^{-k-1} = (-1)^{k+1}$, we can combine the terms:\n$$\np(n) = \\sum_{k=1}^{\\infty} (-1)^{k+1} \\left[ p(n - P_k) + p(n - P_{-k}) \\right]\n$$\nThis is the desired recurrence relation. For any given $n$, the sum is finite because $p(m)=0$ for $m<0$, so we only need to sum over $k$ for which $P_k \\le n$ or $P_{-k} \\le n$. Explicitly, the recurrence is:\n$p(n) = p(n-1) + p(n-2) - p(n-5) - p(n-7) + p(n-12) + p(n-15) - \\dots$\nThe sign for the pair of terms corresponding to index $k$ is $(-1)^{k+1}$.\n\n#### 4. Complexity Analysis\n\nThe algorithm to compute $p(n)$ for $0 \\le n \\le N$ involves a dynamic programming approach. We compute $p(1), p(2), \\dots, p(N)$ in sequence, storing each value. To compute $p(n)$, we use the recurrence relation derived above. The amount of work to compute $p(n)$ is proportional to the number of terms in the sum.\n\nThe terms in the sum are non-zero only for $k \\ge 1$ such that $n - P_k \\ge 0$ or $n - P_{-k} \\ge 0$. Since $P_{-k} > P_k$ for $k>0$, the loop can terminate once $P_k > n$. We need to find the number of values of $k$ that satisfy this condition.\nThe formula for pentagonal numbers is $P_k = \\frac{k(3k-1)}{2}$. For large $k$, this is dominated by the quadratic term: $P_k \\approx \\frac{3k^2}{2}$.\nThe condition $P_k \\le n$ implies $\\frac{3k^2}{2} \\lessapprox n$, which gives $k^2 \\lessapprox \\frac{2n}{3}$, so $k \\lessapprox \\sqrt{\\frac{2n}{3}}$.\nThe number of positive indices $k$ to check is therefore proportional to $\\sqrt{n}$, which means the number of terms in the recurrence for $p(n)$ is $O(\\sqrt{n})$.\n\nTo compute all values up to $N$, we perform this calculation for each $n$ from $1$ to $N$. The total number of arithmetic operations is the sum of the work for each $n$:\n$$\n\\text{Total Operations} = \\sum_{n=1}^{N} O(\\sqrt{n})\n$$\nThis sum can be approximated by the integral of $\\sqrt{x}$:\n$$\n\\sum_{n=1}^{N} \\sqrt{n} \\approx \\int_{1}^{N} x^{1/2} dx = \\left[ \\frac{2}{3}x^{3/2} \\right]_{1}^{N} = \\frac{2}{3}(N^{3/2} - 1)\n$$\nThus, the total time complexity of the algorithm is $O(N^{3/2})$, as required. The use of arbitrary-precision integers means the cost of individual additions grows with the size of $p(n)$, which is $\\log(p(n))$. Since $p(n) \\sim e^{\\pi\\sqrt{2n/3}}$, $\\log(p(n)) \\sim O(\\sqrt{n})$. A more precise complexity analysis would include this factor, leading to $O(N^{3/2} \\cdot \\sqrt{N}) = O(N^2)$. However, in the context of Big-O complexity focusing on the number of arithmetic operations, $O(N^{3/2})$ is the standard and accepted answer.\n\n### Algorithmic Summary\n\nThe algorithm proceeds as follows:\n1.  Initialize an array `p_values` of size $N+1$ to store the partition numbers. Set `p_values[0] = 1`.\n2.  Iterate $n$ from $1$ to $N$.\n3.  For each $n$, calculate $p(n)$ using the recurrence. Initialize a temporary sum to $0$.\n4.  Iterate with an index $k$ starting from $1$. In each step, calculate the two pentagonal numbers $P_k = \\frac{k(3k-1)}{2}$ and $P_{-k} = \\frac{k(3k+1)}{2}$.\n5.  Determine the sign, which is $+1$ if $k$ is odd and $-1$ if $k$ is even.\n6.  If $n - P_k \\ge 0$, add/subtract the term `sign * p_values[n - P_k]` to the sum. If $n - P_k < 0$, break the inner loop over $k$, as all subsequent pentagonal numbers will be larger.\n7.  If $n - P_{-k} \\ge 0$, add/subtract the term `sign * p_values[n - P_{-k}]` to the sum.\n8.  Store the final sum in `p_values[n]`.\n9.  After the outer loop finishes, `p_values` contains $\\{p(0), p(1), \\dots, p(N)\\}$.\n\nThis procedure correctly and efficiently implements the derived recurrence.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of computing partition function values p(n) for various N.\n    \"\"\"\n    test_cases = [0, 1, 10, 50, 100, 200]\n    all_results = []\n\n    for N in test_cases:\n        result = compute_partitions(N)\n        all_results.append(result)\n\n    # Format the final output string exactly as specified.\n    # e.g., [[0,1],[0,1,2,3]] -> \"[[0,1],[0,1,2,3]]\"\n    result_strs = []\n    for res_list in all_results:\n        s = '[' + ','.join(map(str, res_list)) + ']'\n        result_strs.append(s)\n    \n    final_output = f\"[{','.join(result_strs)}]\"\n    print(final_output)\n\ndef compute_partitions(N):\n    \"\"\"\n    Computes p(n) for 0 <= n <= N using a recurrence derived from Euler's\n    pentagonal number theorem.\n    The time complexity is O(N^(3/2)).\n\n    Args:\n        N (int): The maximum integer for which to compute the partition function.\n\n    Returns:\n        list: A list of integers [p(0), p(1), ..., p(N)].\n    \"\"\"\n    if N < 0:\n        return []\n    \n    # Use a NumPy array with dtype=object to store Python's arbitrary-precision\n    # integers. This prevents overflow, which would occur with standard fixed-size\n    # integer types for larger N (though np.int64 is sufficient for N <= 200).\n    partitions = np.zeros(N + 1, dtype=object)\n    \n    # Base case: p(0) = 1 (partition of 0 is the empty set)\n    partitions[0] = 1\n\n    # Iterate from n = 1 to N to compute p(n)\n    for n in range(1, N + 1):\n        # Initialize p(n) to 0\n        current_p_n = 0\n        k = 1\n        \n        while True:\n            # Determine the sign for the pair of terms associated with index k.\n            # Sign is (-1)^(k+1) or (-1)^(k-1).\n            # This is +1 for k=1, -1 for k=2, +1 for k=3, etc.\n            sign = 1 if (k - 1) % 2 == 0 else -1\n\n            # First generalized pentagonal number for index k\n            # P_k = k(3k-1)/2\n            pentagonal_1 = (k * (3 * k - 1)) // 2\n\n            if n - pentagonal_1 >= 0:\n                current_p_n += sign * partitions[n - pentagonal_1]\n            else:\n                # If n < P_k, then n will also be less than all subsequent\n                # pentagonal numbers (P_{k+1}, P_{-k}, etc.), so we can stop.\n                break\n\n            # Second generalized pentagonal number for index k\n            # P_{-k} = k(3k+1)/2\n            pentagonal_2 = (k * (3 * k + 1)) // 2\n\n            if n - pentagonal_2 >= 0:\n                current_p_n += sign * partitions[n - pentagonal_2]\n            \n            k += 1\n\n        partitions[n] = current_p_n\n        \n    return list(partitions)\n\n# Execute the solution\nsolve()\n\n```", "id": "3013550"}]}