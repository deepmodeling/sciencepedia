{"hands_on_practices": [{"introduction": "To build intuition for the Pólya-Vinogradov inequality, we begin with a direct, hands-on calculation. This exercise asks you to compute the character sum for a specific quadratic character, find its maximum value, and compare this concrete result to the theoretical upper bound. By working through this example, you will gain a tangible sense of the scale and behavior of character sums, grounding the abstract theorem in numerical reality.", "problem": "Let $q=13$ and let $\\chi:\\mathbb{Z}\\to\\{-1,0,1\\}$ be the quadratic Dirichlet character modulo $13$ defined by the Legendre symbol $\\chi(n)=\\left(\\frac{n}{13}\\right)$. For each integer $x\\ge 0$, define the character sum $S(x)=\\sum_{1\\le n\\le x}\\chi(n)$, where an empty sum is taken to be $0$. Starting from the definition of the Legendre symbol and the periodicity properties of Dirichlet characters, determine $S(x)$ explicitly for all integers $x\\ge 0$ and identify the global maximum $M=\\max_{x\\ge 0}|S(x)|$. To quantify the comparison with the Pólya-Vinogradov inequality, form the normalized magnitude $R=\\dfrac{M}{\\sqrt{13}\\,\\ln 13}$.\n\nProvide the exact value of $R$ as a single closed-form expression. Do not round your answer.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- The modulus is $q=13$.\n- The character $\\chi: \\mathbb{Z} \\to \\{-1, 0, 1\\}$ is the quadratic Dirichlet character modulo $13$, defined by the Legendre symbol $\\chi(n) = \\left(\\frac{n}{13}\\right)$.\n- The character sum is defined as $S(x) = \\sum_{1 \\le n \\le x} \\chi(n)$ for any integer $x \\ge 0$, with an empty sum ($x=0$) being $0$.\n- The maximum absolute value of the character sum is $M = \\max_{x \\ge 0} |S(x)|$.\n- The normalized magnitude to be computed is $R = \\frac{M}{\\sqrt{13} \\ln 13}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the required criteria.\n- **Scientifically Grounded**: The problem is rooted in analytic number theory, dealing with standard objects: Dirichlet characters, Legendre symbols, and character sums. The Pólya-Vinogradov inequality, mentioned for context, is a fundamental theorem in this field. The calculations required are standard exercises in the subject. The problem is factually and scientifically sound.\n- **Well-Posed**: The definitions of $\\chi$ and $S(x)$ are precise. The quantity $M$ is well-defined because, as will be shown, $S(x)$ is a periodic function, so its maximum exists and can be found by examining a finite number of values. The final quantity $R$ is a simple algebraic combination of well-defined terms. A unique and meaningful solution exists.\n- **Objective**: The problem is stated in clear, unambiguous mathematical language, free from any subjective or opinion-based content.\n- **Completeness and Consistency**: The problem provides all necessary information to solve it. The given definitions and constraints are self-consistent.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid** as it is scientifically grounded, well-posed, objective, and self-contained. The solution process may proceed.\n\n### Solution\nThe objective is to find the exact value of $R = \\frac{M}{\\sqrt{13} \\ln 13}$. This requires the determination of $M = \\max_{x \\ge 0} |S(x)|$, which in turn requires the explicit computation of the character sum $S(x)$.\n\nFirst, we must evaluate the character $\\chi(n) = \\left(\\frac{n}{13}\\right)$ for a full cycle. The modulus $q=13$ is a prime number. The value of the Legendre symbol $\\left(\\frac{n}{13}\\right)$ is $1$ if $n$ is a quadratic residue modulo $13$, $-1$ if $n$ is a quadratic non-residue modulo $13$, and $0$ if $n$ is a multiple of $13$.\n\nThe quadratic residues modulo $13$ are the integers congruent to a perfect square that is not divisible by $13$. We compute the non-zero squares modulo $13$:\n$1^2 \\equiv 1 \\pmod{13}$\n$2^2 \\equiv 4 \\pmod{13}$\n$3^2 \\equiv 9 \\pmod{13}$\n$4^2 = 16 \\equiv 3 \\pmod{13}$\n$5^2 = 25 \\equiv 12 \\pmod{13}$\n$6^2 = 36 \\equiv 10 \\pmod{13}$\nThe squares of $7, \\dots, 12$ produce the same set, as $(13-k)^2 \\equiv (-k)^2 \\equiv k^2 \\pmod{13}$.\nThe set of quadratic residues (QR) is $\\{1, 3, 4, 9, 10, 12\\}$.\nFor these values of $n$, $\\chi(n)=1$.\n\nThe set of quadratic non-residues (QNR) consists of the remaining integers in the range $[1, 12]$: $\\{2, 5, 6, 7, 8, 11\\}$.\nFor these values of $n$, $\\chi(n)=-1$.\n\nFor any integer $n$ that is a multiple of $13$, $\\chi(n)=0$.\n\nThe sequence of values of $\\chi(n)$ for $n=1, 2, \\dots, 13$ is:\n$\\chi(1) = 1$\n$\\chi(2) = -1$\n$\\chi(3) = 1$\n$\\chi(4) = 1$\n$\\chi(5) = -1$\n$\\chi(6) = -1$\n$\\chi(7) = -1$\n$\\chi(8) = -1$\n$\\chi(9) = 1$\n$\\chi(10) = 1$\n$\\chi(11) = -1$\n$\\chi(12) = 1$\n$\\chi(13) = 0$\n\nNext, we evaluate the character sum $S(x) = \\sum_{1 \\le n \\le x} \\chi(n)$. Since $\\chi$ is a non-principal Dirichlet character, the sum over a full period is zero: $\\sum_{n=1}^{13} \\chi(n) = 0$. This implies that the function $S(x)$ is periodic with period $13$, i.e., $S(x+13) = S(x)$. This is because $S(x+13) = \\sum_{n=1}^{x+13} \\chi(n) = S(x) + \\sum_{n=x+1}^{x+13} \\chi(n)$. The sum $\\sum_{n=x+1}^{x+13} \\chi(n)$ is a sum over a complete set of residues modulo $13$, which is zero. Therefore, to find $M = \\max_{x \\ge 0} |S(x)|$, we only need to compute $S(x)$ for $x \\in \\{0, 1, \\dots, 12\\}$.\n\nWe compute the partial sums $S(x)$ for $x=0, 1, \\dots, 13$:\n$S(0) = 0$\n$S(1) = \\chi(1) = 1$\n$S(2) = S(1) + \\chi(2) = 1 + (-1) = 0$\n$S(3) = S(2) + \\chi(3) = 0 + 1 = 1$\n$S(4) = S(3) + \\chi(4) = 1 + 1 = 2$\n$S(5) = S(4) + \\chi(5) = 2 + (-1) = 1$\n$S(6) = S(5) + \\chi(6) = 1 + (-1) = 0$\n$S(7) = S(6) + \\chi(7) = 0 + (-1) = -1$\n$S(8) = S(7) + \\chi(8) = -1 + (-1) = -2$\n$S(9) = S(8) + \\chi(9) = -2 + 1 = -1$\n$S(10) = S(9) + \\chi(10) = -1 + 1 = 0$\n$S(11) = S(10) + \\chi(11) = 0 + (-1) = -1$\n$S(12) = S(11) + \\chi(12) = -1 + 1 = 0$\n$S(13) = S(12) + \\chi(13) = 0 + 0 = 0$\n\nThe set of values taken by $S(x)$ for $x \\in \\{0, 1, \\dots, 12\\}$ is $\\{0, 1, 0, 1, 2, 1, 0, -1, -2, -1, 0, -1, 0\\}$.\nTo find $M$, we take the absolute values of these sums: $\\{|0|, |1|, |0|, |1|, |2|, |1|, |0|, |-1|, |-2|, |-1|, |0|, |-1|, |0|\\}$, which is the set $\\{0, 1, 2\\}$.\nThe maximum value in this set is $2$.\nThus, the global maximum is $M = \\max_{x \\ge 0} |S(x)| = 2$.\n\nFinally, we compute the normalized magnitude $R$:\n$R = \\frac{M}{\\sqrt{13} \\ln 13}$\nSubstituting the value $M=2$, we obtain:\n$R = \\frac{2}{\\sqrt{13} \\ln 13}$\n\nThis is the exact, closed-form expression for $R$.", "answer": "$$\n\\boxed{\\frac{2}{\\sqrt{13} \\ln 13}}\n$$", "id": "3028891"}, {"introduction": "Having seen an example, we now delve into the theoretical underpinnings of the inequality. This practice guides you through a first-principles derivation of a bound on character sums using Fourier analysis on the group $\\mathbb{Z}/q\\mathbb{Z}$. Completing this derivation will illuminate why such a bound exists and, crucially, why it is independent of the starting point of the sum, revealing the power of Fourier methods in number theory.", "problem": "Let $q$ be an odd prime and let $\\chi$ be a primitive nonprincipal Dirichlet character modulo $q$ (for example, the Legendre symbol modulo $q$). For integers $M$ and $N$ with $1 \\leq N \\leq q$, define the partial character sum\n$$\nS(M,N) \\;=\\; \\sum_{n=M+1}^{M+N} \\chi(n).\n$$\nUsing only the following foundational inputs:\n- the orthogonality of additive characters modulo $q$, namely that for $a \\in \\mathbb{Z}$,\n$$\n\\frac{1}{q}\\sum_{k=0}^{q-1} \\exp\\!\\left(\\frac{2\\pi i k a}{q}\\right) \\;=\\; \\begin{cases} 1, & a \\equiv 0 \\pmod{q}, \\\\ 0, & a \\not\\equiv 0 \\pmod{q}, \\end{cases}\n$$\n- the discrete Fourier expansion on $\\mathbb{Z}/q\\mathbb{Z}$,\n- and the Gauss sum identity for primitive characters,\n$$\n\\tau(\\chi) \\;=\\; \\sum_{n \\bmod q} \\chi(n) \\exp\\!\\left(\\frac{2\\pi i n}{q}\\right), \\qquad \\big|\\tau(\\chi)\\big| \\;=\\; \\sqrt{q},\n$$\nderive from first principles an explicit bound $B(N,q)$ that satisfies\n$$\n|S(M,N)| \\;\\leq\\; B(N,q),\n$$\nand depends only on $N$ and $q$ (and $\\chi$ through $q$), but not on $M$. Your derivation should make clear why the dependence on $M$ disappears.\n\nThen, specialize to $q=5$ with $\\chi$ the quadratic Dirichlet character modulo $5$, and $N=2$. Compute the exact value of your explicit bound $B(2,5)$.\n\nProvide as your final answer the exact value of $B(2,5)$.", "solution": "The problem requires the derivation of an explicit bound for the partial character sum $S(M,N) = \\sum_{n=M+1}^{M+N} \\chi(n)$, where $\\chi$ is a primitive nonprincipal Dirichlet character modulo an odd prime $q$. The bound, denoted $B(N,q)$, must be independent of the starting point $M$ of the sum. The derivation must be based on a specified set of foundational inputs.\n\nThe core strategy is to express the character $\\chi(n)$ using its discrete Fourier expansion on $\\mathbb{Z}/q\\mathbb{Z}$. The toolset of discrete Fourier analysis is grounded in the provided orthogonality relation for additive characters. For any function $f: \\mathbb{Z}/q\\mathbb{Z} \\to \\mathbb{C}$, its Fourier expansion is $f(n) = \\sum_{k=0}^{q-1} \\hat{f}(k) \\exp\\left(\\frac{2\\pi i nk}{q}\\right)$, where the Fourier coefficients are given by $\\hat{f}(k) = \\frac{1}{q} \\sum_{m=0}^{q-1} f(m) \\exp\\left(\\frac{-2\\pi i mk}{q}\\right)$. The validity of this representation is a direct consequence of the orthogonality relation.\n\nLet's determine the Fourier coefficients $\\hat{\\chi}(k)$ for the character $\\chi$. By definition,\n$$\n\\hat{\\chi}(k) \\;=\\; \\frac{1}{q} \\sum_{n=0}^{q-1} \\chi(n) \\exp\\left(\\frac{-2\\pi i nk}{q}\\right).\n$$\nThe sum on the right is a generalized Gauss sum. Let's relate it to the given Gauss sum $\\tau(\\chi) = \\sum_{n \\bmod q} \\chi(n) \\exp\\left(\\frac{2\\pi i n}{q}\\right)$. Let $\\tau(\\chi, a) = \\sum_{n \\bmod q} \\chi(n) \\exp\\left(\\frac{2\\pi i na}{q}\\right)$.\nFor $k \\not\\equiv 0 \\pmod q$, since $q$ is prime, $k$ has a multiplicative inverse $k^{-1} \\pmod q$. We can substitute $n=mk^{-1}$ in the sum for $\\tau(\\chi,k)$:\n$$\n\\tau(\\chi, k) \\;=\\; \\sum_{m \\bmod q} \\chi(mk^{-1}) \\exp\\left(\\frac{2\\pi i mk^{-1}k}{q}\\right) \\;=\\; \\chi(k^{-1}) \\sum_{m \\bmod q} \\chi(m) \\exp\\left(\\frac{2\\pi i m}{q}\\right) \\;=\\; \\bar{\\chi}(k) \\tau(\\chi).\n$$\nFor $k \\equiv 0 \\pmod q$, we have $\\tau(\\chi, 0) = \\sum_{n \\bmod q} \\chi(n) = 0$ since $\\chi$ is a nonprincipal character. Also, $\\bar{\\chi}(0)=0$, so the identity $\\tau(\\chi, k) = \\bar{\\chi}(k) \\tau(\\chi)$ holds for all $k \\in \\mathbb{Z}/q\\mathbb{Z}$.\nThe Fourier coefficient $\\hat{\\chi}(k)$ is then\n$$\n\\hat{\\chi}(k) \\;=\\; \\frac{1}{q} \\tau(\\chi, -k) \\;=\\; \\frac{\\bar{\\chi}(-k)\\tau(\\chi)}{q}.\n$$\nNow, we can write the Fourier expansion for $\\chi(n)$:\n$$\n\\chi(n) \\;=\\; \\sum_{k=0}^{q-1} \\hat{\\chi}(k) \\exp\\left(\\frac{2\\pi i nk}{q}\\right) \\;=\\; \\sum_{k=0}^{q-1} \\frac{\\bar{\\chi}(-k)\\tau(\\chi)}{q} \\exp\\left(\\frac{2\\pi i nk}{q}\\right).\n$$\nSince $\\chi(0)=0$, the $k=0$ term is zero. Thus, we sum from $k=1$ to $q-1$:\n$$\n\\chi(n) \\;=\\; \\frac{\\tau(\\chi)}{q} \\sum_{k=1}^{q-1} \\bar{\\chi}(-k) \\exp\\left(\\frac{2\\pi i nk}{q}\\right).\n$$\nSubstituting this expansion into the definition of $S(M,N)$:\n$$\nS(M,N) \\;=\\; \\sum_{n=M+1}^{M+N} \\left( \\frac{\\tau(\\chi)}{q} \\sum_{k=1}^{q-1} \\bar{\\chi}(-k) \\exp\\left(\\frac{2\\pi i nk}{q}\\right) \\right).\n$$\nWe can interchange the order of summation, as both sums are finite:\n$$\nS(M,N) \\;=\\; \\frac{\\tau(\\chi)}{q} \\sum_{k=1}^{q-1} \\bar{\\chi}(-k) \\left( \\sum_{n=M+1}^{M+N} \\exp\\left(\\frac{2\\pi i nk}{q}\\right) \\right).\n$$\nTo find a bound, we take the absolute value and apply the triangle inequality:\n$$\n|S(M,N)| \\;\\leq\\; \\left| \\frac{\\tau(\\chi)}{q} \\right| \\sum_{k=1}^{q-1} \\left| \\bar{\\chi}(-k) \\right| \\left| \\sum_{n=M+1}^{M+N} \\exp\\left(\\frac{2\\pi i nk}{q}\\right) \\right|.\n$$\nUsing the provided identity $|\\tau(\\chi)| = \\sqrt{q}$ and the fact that $|\\bar{\\chi}(-k)|=1$ for $k \\in \\{1, \\dots, q-1\\}$:\n$$\n|S(M,N)| \\;\\leq\\; \\frac{\\sqrt{q}}{q} \\sum_{k=1}^{q-1} \\left| \\sum_{n=M+1}^{M+N} \\exp\\left(\\frac{2\\pi i nk}{q}\\right) \\right|.\n$$\nThe inner sum is a geometric series. Let's analyze its magnitude.\n$$\n\\sum_{n=M+1}^{M+N} \\exp\\left(\\frac{2\\pi i nk}{q}\\right) \\;=\\; \\sum_{j=0}^{N-1} \\exp\\left(\\frac{2\\pi i (M+1+j)k}{q}\\right) \\;=\\; \\exp\\left(\\frac{2\\pi i (M+1)k}{q}\\right) \\sum_{j=0}^{N-1} \\left(\\exp\\left(\\frac{2\\pi i k}{q}\\right)\\right)^j.\n$$\nSince $1 \\leq k \\leq q-1$, the common ratio $\\exp(2\\pi i k/q) \\neq 1$. The sum evaluates to:\n$$\n\\exp\\left(\\frac{2\\pi i (M+1)k}{q}\\right) \\frac{\\exp\\left(\\frac{2\\pi i Nk}{q}\\right) - 1}{\\exp\\left(\\frac{2\\pi i k}{q}\\right) - 1}.\n$$\nThe dependence on $M$ is entirely contained in the leading factor $\\exp\\left(\\frac{2\\pi i (M+1)k}{q}\\right)$. When we take the absolute value, this factor's contribution is $|\\exp\\left(\\frac{2\\pi i (M+1)k}{q}\\right)| = 1$. This is why the resulting bound is independent of $M$.\nThe magnitude of the sum is:\n$$\n\\left| \\frac{\\exp\\left(\\frac{2\\pi i Nk}{q}\\right) - 1}{\\exp\\left(\\frac{2\\pi i k}{q}\\right) - 1} \\right| \\;=\\; \\frac{|\\exp(2\\pi i Nk/q) - 1|}{|\\exp(2\\pi i k/q) - 1|}.\n$$\nUsing the identity $|\\exp(i\\theta) - 1| = |(\\cos\\theta-1) + i\\sin\\theta| = \\sqrt{(\\cos\\theta-1)^2+\\sin^2\\theta} = \\sqrt{2-2\\cos\\theta} = \\sqrt{4\\sin^2(\\theta/2)} = 2|\\sin(\\theta/2)|$, we get:\n$$\n\\frac{2|\\sin(\\pi Nk/q)|}{2|\\sin(\\pi k/q)|} \\;=\\; \\frac{|\\sin(\\pi Nk/q)|}{|\\sin(\\pi k/q)|}.\n$$\nSubstituting this back into our inequality for $|S(M,N)|$:\n$$\n|S(M,N)| \\;\\leq\\; \\frac{1}{\\sqrt{q}} \\sum_{k=1}^{q-1} \\frac{|\\sin(\\pi N k / q)|}{|\\sin(\\pi k / q)|}.\n$$\nThis gives the explicit bound $B(N,q)$ which depends only on $N$ and $q$:\n$$\nB(N,q) \\;=\\; \\frac{1}{\\sqrt{q}} \\sum_{k=1}^{q-1} \\frac{|\\sin(\\pi N k / q)|}{|\\sin(\\pi k / q)|}.\n$$\nNow, we specialize to the case $q=5$ and $N=2$. The character $\\chi$ is the quadratic character modulo $5$. The bound is:\n$$\nB(2,5) \\;=\\; \\frac{1}{\\sqrt{5}} \\sum_{k=1}^{4} \\frac{|\\sin(2\\pi k/5)|}{|\\sin(\\pi k/5)|}.\n$$\nUsing the double-angle identity $\\sin(2\\theta)=2\\sin\\theta\\cos\\theta$, the term in the sum simplifies. For $k \\in \\{1,2,3,4\\}$, $\\sin(\\pi k/5) > 0$.\n$$\n\\frac{|\\sin(2\\pi k/5)|}{|\\sin(\\pi k/5)|} \\;=\\; \\frac{|2\\sin(\\pi k/5)\\cos(\\pi k/5)|}{\\sin(\\pi k/5)} \\;=\\; 2|\\cos(\\pi k/5)|.\n$$\nSo the bound becomes:\n$$\nB(2,5) \\;=\\; \\frac{1}{\\sqrt{5}} \\sum_{k=1}^{4} 2|\\cos(\\pi k/5)| \\;=\\; \\frac{2}{\\sqrt{5}} \\Big( |\\cos(\\pi/5)| + |\\cos(2\\pi/5)| + |\\cos(3\\pi/5)| + |\\cos(4\\pi/5)| \\Big).\n$$\nThe angles $\\pi/5$ and $2\\pi/5$ are in the first quadrant, so their cosines are positive. The angles $3\\pi/5$ and $4\\pi/5$ are in the second quadrant, their cosines are negative. Thus:\n$|\\cos(3\\pi/5)| = -\\cos(3\\pi/5) = \\cos(\\pi-3\\pi/5) = \\cos(2\\pi/5)$.\n$|\\cos(4\\pi/5)| = -\\cos(4\\pi/5) = \\cos(\\pi-4\\pi/5) = \\cos(\\pi/5)$.\nThe sum is:\n$$\n\\sum_{k=1}^{4} |\\cos(\\pi k/5)| \\;=\\; \\cos(\\pi/5) + \\cos(2\\pi/5) + \\cos(2\\pi/5) + \\cos(\\pi/5) \\;=\\; 2\\big(\\cos(\\pi/5) + \\cos(2\\pi/5)\\big).\n$$\nThe exact values for these cosines are known from the geometry of the regular pentagon:\n$$\n\\cos(\\pi/5) \\;=\\; \\cos(36^\\circ) \\;=\\; \\frac{1+\\sqrt{5}}{4}\n$$\n$$\n\\cos(2\\pi/5) \\;=\\; \\cos(72^\\circ) \\;=\\; \\frac{\\sqrt{5}-1}{4}\n$$\nTheir sum is:\n$$\n\\cos(\\pi/5) + \\cos(2\\pi/5) \\;=\\; \\frac{1+\\sqrt{5}}{4} + \\frac{\\sqrt{5}-1}{4} \\;=\\; \\frac{2\\sqrt{5}}{4} \\;=\\; \\frac{\\sqrt{5}}{2}.\n$$\nSubstituting this value back into the expression for $B(2,5)$:\n$$\nB(2,5) \\;=\\; \\frac{2}{\\sqrt{5}} \\cdot 2 \\left( \\frac{\\sqrt{5}}{2} \\right) \\;=\\; \\frac{4\\sqrt{5}}{2\\sqrt{5}} \\;=\\; 2.\n$$\nThus, the value of the explicit bound for $q=5$ and $N=2$ is $2$.", "answer": "$$\\boxed{2}$$", "id": "3028925"}, {"introduction": "The standard Pólya-Vinogradov inequality provides a bound in terms of the modulus $q$. However, a crucial refinement states that the true 'complexity' of a character $\\chi$ is governed by its conductor, $q_{\\chi}$. This computational exercise demonstrates this principle numerically by constructing a character where the modulus is much larger than the conductor. By comparing the character sum's magnitude to bounds scaled by both $q$ and $q_{\\chi}$, you will see clear evidence of the conductor's fundamental role.", "problem": "You will numerically demonstrate, using explicit Dirichlet characters, that the essential parameter controlling the size of character sums in the Pólya–Vinogradov inequality is the conductor $q_{\\chi}$ rather than the modulus $q$. The goal is to provide an example where $q$ is large but $q_{\\chi}$ is small, and to quantify how normalizing by either $\\sqrt{q_{\\chi}}\\log q_{\\chi}$ or by $\\sqrt{q}\\log q$ leads to dramatically different scales.\n\nFoundational base to be used:\n- Definition of a Dirichlet character modulo $q$: a function $\\chi : \\mathbb{Z} \\to \\mathbb{C}$ that is periodic modulo $q$, completely multiplicative, and satisfies $\\chi(n) = 0$ whenever $\\gcd(n,q) \\neq 1$.\n- Primitive character modulo $q_{\\chi}$: a Dirichlet character that cannot be induced from any proper divisor of $q_{\\chi}$.\n- Conductor $q_{\\chi}$ of an imprimitive character $\\chi$ modulo $q$: the minimal positive integer $q_{\\chi}$ such that $\\chi$ is induced from a primitive character modulo $q_{\\chi}$.\n- Induction of a character: given a primitive character $\\chi^{\\ast}$ modulo $q_{\\chi}$ and a modulus $q$ with $q_{\\chi} \\mid q$, define the imprimitive character $\\chi$ modulo $q$ by $\\chi(n) = \\chi^{\\ast}(n)$ if $\\gcd(n,q) = 1$, and $\\chi(n) = 0$ otherwise.\n- Quadratic character modulo an odd prime $p$: for $n \\in \\mathbb{Z}$, the Legendre symbol $\\left(\\frac{n}{p}\\right)$ equals $0$ if $p \\mid n$, equals $1$ if $n$ is a quadratic residue modulo $p$, and equals $-1$ otherwise; it is a primitive Dirichlet character modulo $p$.\n\nTask specification:\n1. For each given test case $(q_{\\chi}, q, N_{\\max})$, construct the imprimitive Dirichlet character $\\chi$ modulo $q$ by induction from the primitive quadratic character modulo $q_{\\chi}$ (which is an odd prime). Concretely, take $\\chi^{\\ast}(n) = \\left(\\frac{n}{q_{\\chi}}\\right)$ and define $\\chi(n)$ modulo $q$ by\n   - $\\chi(n) = \\chi^{\\ast}(n)$ if $\\gcd(n,q) = 1$,\n   - $\\chi(n) = 0$ if $\\gcd(n,q) \\neq 1$.\n2. For each test case, compute the cumulative sums\n   $$S(N) = \\sum_{n=1}^{N} \\chi(n) \\quad \\text{for} \\quad 1 \\leq N \\leq N_{\\max},$$\n   and the maximal initial-segment sum magnitude\n   $$S_{\\max} = \\max_{1 \\leq N \\leq N_{\\max}} \\left|S(N)\\right|.$$\n3. For each test case, compute two normalized quantities using the natural logarithm:\n   - The conductor-scaled value\n     $$R_{\\mathrm{cond}} = \\frac{S_{\\max}}{\\sqrt{q_{\\chi}} \\,\\log(q_{\\chi})}.$$\n   - The modulus-scaled value\n     $$R_{\\mathrm{mod}} = \\frac{S_{\\max}}{\\sqrt{q} \\,\\log(q)}.$$\n   These two numbers are intended to illustrate how the scaling with $q_{\\chi}$ captures the essential behavior while scaling with $q$ can be misleading when $q$ is large but $q_{\\chi}$ is small.\n\nImplementation details:\n- Use Euler’s criterion to compute the quadratic character modulo $q_{\\chi}$: for $n$ not divisible by $q_{\\chi}$,\n  $$\\left(\\frac{n}{q_{\\chi}}\\right) \\equiv n^{\\frac{q_{\\chi}-1}{2}} \\pmod{q_{\\chi}},$$\n  mapping the residue $1$ to $1$ and the residue $q_{\\chi}-1$ to $-1$, and setting the value to $0$ when $q_{\\chi} \\mid n$.\n- Use the natural logarithm for $\\log(\\cdot)$.\n- When computing $\\chi(n)$ modulo $q$, enforce $\\chi(n) = 0$ if $\\gcd(n,q) \\neq 1$, and otherwise take the Legendre value modulo $q_{\\chi}$.\n\nTest suite:\n- Case $1$: $(q_{\\chi}, q, N_{\\max}) = (\\,13,\\, 13 \\cdot 99991,\\, 200000\\,)$\n- Case $2$: $(q_{\\chi}, q, N_{\\max}) = (\\,13,\\, 13,\\, 200000\\,)$\n- Case $3$: $(q_{\\chi}, q, N_{\\max}) = (\\,101,\\, 101 \\cdot 99991,\\, 200000\\,)$\n\nRequired final output format:\n- Your program should produce a single line of output containing the results for the three test cases as a comma-separated list enclosed in square brackets, where each item is itself a two-element list $[R_{\\mathrm{cond}}, R_{\\mathrm{mod}}]$ with both entries printed as decimal floats. For example:\n  $$\\texttt{[[r1\\_cond,r1\\_mod],[r2\\_cond,r2\\_mod],[r3\\_cond,r3\\_mod]]}$$\nNo angles or physical units are involved, and all logarithms must be natural logarithms.", "solution": "The problem statement is valid. It is scientifically grounded in the theory of Dirichlet characters and the Pólya-Vinogradov inequality, is well-posed, objective, and computationally feasible.\n\nThe core principle to be demonstrated is that for a Dirichlet character $\\chi$ modulo $q$ that is induced from a primitive character $\\chi^{\\ast}$ modulo $q_{\\chi}$, the magnitude of the character sum $\\sum \\chi(n)$ is governed by its conductor $q_{\\chi}$, not the modulus $q$. The Pólya-Vinogradov inequality provides a classical bound on character sums. For a non-principal character $\\chi$ modulo $q$, it states that there exists a constant $C$ such that\n$$\n\\max_{N \\geq 1} \\left| \\sum_{n=1}^{N} \\chi(n) \\right| \\leq C \\sqrt{q} \\log q.\n$$\nHowever, if $\\chi$ is an imprimitive character induced by a primitive character $\\chi^{\\ast}$ modulo its conductor $q_{\\chi} < q$, a much sharper bound holds, where the dependency is on $q_{\\chi}$ instead of $q$:\n$$\n\\max_{N \\geq 1} \\left| \\sum_{n=1}^{N} \\chi(n) \\right| = \\mathcal{O}(\\sqrt{q_{\\chi}} \\log q_{\\chi}).\n$$\nThis numerical task is designed to explicitly illustrate this principle. We are given test cases where the modulus $q$ is significantly larger than the conductor $q_{\\chi}$. By comparing the maximal character sum magnitude, $S_{\\max}$, scaled by $\\sqrt{q_{\\chi}}\\log q_{\\chi}$ versus $\\sqrt{q}\\log q$, we can quantify this effect.\n\nThe procedure is as follows:\n$1$. Construct the character $\\chi$. For each test case, we are given a conductor $q_{\\chi}$ which is an odd prime, a modulus $q$ which is a multiple of $q_{\\chi}$, and an upper limit for the sum $N_{\\max}$. The primitive character $\\chi^{\\ast}$ modulo $q_{\\chi}$ is the Legendre symbol, $\\chi^{\\ast}(n) = \\left(\\frac{n}{q_{\\chi}}\\right)$. The character $\\chi$ modulo $q$ is then induced from $\\chi^{\\ast}$:\n$$\n\\chi(n) = \\begin{cases} \\chi^{\\ast}(n) & \\text{if } \\gcd(n,q) = 1 \\\\ 0 & \\text{if } \\gcd(n,q) \\neq 1 \\end{cases}\n$$\n\n$2$. Compute the maximal sum magnitude $S_{\\max}$. We iterate through integers $n$ from $1$ to $N_{\\max}$. In each step, we first evaluate $\\chi(n)$. A key part of this is testing the condition $\\gcd(n,q)=1$. If this condition holds, we compute the Legendre symbol $\\left(\\frac{n}{q_{\\chi}}\\right)$ using Euler's criterion:\n$$\n\\left(\\frac{n}{q_{\\chi}}\\right) \\equiv n^{(q_{\\chi}-1)/2} \\pmod{q_{\\chi}}.\n$$\nThe result of the modular exponentiation is $1$ or $q_{\\chi}-1$ (since $\\gcd(n,q_{\\chi})=1$). We map these residues to the values $1$ and $-1$ respectively. If $\\gcd(n,q) \\neq 1$, $\\chi(n)$ is simply $0$. We then update the cumulative sum $S(N) = \\sum_{n=1}^{N} \\chi(n)$ and keep track of the maximum magnitude observed, $S_{\\max} = \\max_{1 \\leq N \\leq N_{\\max}} |S(N)|$.\n\n$3$. Normalize $S_{\\max}$. After computing $S_{\\max}$, we calculate two normalized quantities:\n   - The conductor-scaled value, $R_{\\mathrm{cond}} = \\frac{S_{\\max}}{\\sqrt{q_{\\chi}} \\log(q_{\\chi})}$.\n   - The modulus-scaled value, $R_{\\mathrm{mod}} = \\frac{S_{\\max}}{\\sqrt{q} \\log(q)}$.\n\nThe expected result is that for a fixed conductor $q_{\\chi}$, the value of $R_{\\mathrm{cond}}$ will be of a comparable magnitude regardless of how large $q$ is. In contrast, $R_{\\mathrm{mod}}$ will become significantly smaller when $q$ is much larger than $q_{\\chi}$, because the denominator $\\sqrt{q}\\log q$ incorrectly suggests a much larger scale for the character sum than is actually present. The test cases are chosen to make this distinction clear: one case where $q = q_{\\chi}$, establishing a baseline, and other cases where $q \\gg q_{\\chi}$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef calculate_metrics(q_chi: int, q: int, N_max: int):\n    \"\"\"\n    Calculates the maximal character sum and normalized quantities for a given character.\n\n    Args:\n        q_chi: The conductor of the primitive character (an odd prime).\n        q: The modulus of the induced character.\n        N_max: The maximum length of the initial-segment sum.\n\n    Returns:\n        A list containing [R_cond, R_mod].\n    \"\"\"\n    current_sum = 0.0\n    max_sum_magnitude = 0.0\n\n    # Pre-calculate the exponent for Euler's criterion to find the Legendre symbol.\n    exponent = (q_chi - 1) // 2\n\n    # Iterate from n = 1 to N_max to compute cumulative sums.\n    for n in range(1, N_max + 1):\n        chi_n = 0.0\n        \n        # The character chi(n) is non-zero only if gcd(n, q) = 1.\n        if math.gcd(n, q) == 1:\n            # If gcd(n, q) == 1, then gcd(n, q_chi) == 1 since q_chi divides q.\n            # We can use Euler's criterion to compute the Legendre symbol (n/q_chi).\n            legendre = pow(n, exponent, q_chi)\n            \n            if legendre == 1:\n                chi_n = 1.0\n            else:\n                # For a prime modulus, if the result is not 1, it must be -1 (mod q_chi),\n                # which corresponds to the residue q_chi - 1.\n                chi_n = -1.0\n        \n        current_sum += chi_n\n        \n        # Update the maximum magnitude of the sum found so far.\n        current_sum_abs = abs(current_sum)\n        if current_sum_abs > max_sum_magnitude:\n            max_sum_magnitude = current_sum_abs\n\n    S_max = max_sum_magnitude\n\n    # Compute the conductor-scaled value using natural logarithm.\n    R_cond = S_max / (np.sqrt(q_chi) * np.log(q_chi))\n    \n    # Compute the modulus-scaled value using natural logarithm.\n    R_mod = S_max / (np.sqrt(q) * np.log(q))\n    \n    return [R_cond, R_mod]\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (q_chi, q, N_max)\n        (13, 13 * 99991, 200000),\n        (13, 13, 200000),\n        (101, 101 * 99991, 200000)\n    ]\n\n    results = []\n    for q_chi, q, N_max in test_cases:\n        result = calculate_metrics(q_chi, q, N_max)\n        results.append(result)\n\n    # Format the final output string as per the requirement:\n    # [[r1_cond,r1_mod],[r2_cond,r2_mod],[r3_cond,r3_mod]]\n    result_str_parts = []\n    for res_pair in results:\n        result_str_parts.append(f\"[{res_pair[0]},{res_pair[1]}]\")\n    \n    final_str = f\"[{','.join(result_str_parts)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_str)\n\nsolve()\n```", "id": "3028932"}]}