{"hands_on_practices": [{"introduction": "Understanding the distinction between primitive and induced characters is fundamental to the study of Dirichlet characters and their $L$-functions. This first exercise provides a concrete, hands-on opportunity to work directly with these definitions. By constructing characters modulo $12$ from primitive characters of its prime-power factors, you will gain a practical grasp of induction and use the definition of the conductor to verify the origins of these new characters [@problem_id:3020218].", "id": "3020218", "problem": "Let $N$ be a positive integer and let a Dirichlet character modulo $N$ be a completely multiplicative function $\\chi:\\mathbb{Z}\\to\\mathbb{C}$ that is periodic with period $N$ and satisfies $\\chi(n)=0$ if and only if $\\gcd(n,N)\\neq 1$. A Dirichlet character is called primitive if it does not factor through any proper divisor of its modulus; more precisely, the conductor of a Dirichlet character $\\chi$ modulo $N$ is the minimal positive integer $f$ such that $f\\mid N$ and the restriction of $\\chi$ to $(\\mathbb{Z}/N\\mathbb{Z})^{\\times}$ factors through $(\\mathbb{Z}/f\\mathbb{Z})^{\\times}$, in which case $\\chi$ arises from a primitive character modulo $f$ via composition with the natural projection $(\\mathbb{Z}/N\\mathbb{Z})^{\\times}\\to(\\mathbb{Z}/f\\mathbb{Z})^{\\times}$. The orthogonality relations for characters state that for characters $\\chi$ and $\\psi$ modulo $N$,\n$$\n\\sum_{a\\in(\\mathbb{Z}/N\\mathbb{Z})^{\\times}}\\chi(a)\\,\\overline{\\psi(a)}=\n\\begin{cases}\n\\varphi(N) & \\text{if }\\chi=\\psi,\\\\\n0 & \\text{if }\\chi\\neq \\psi,\n\\end{cases}\n$$\nwhere $\\varphi$ is Euler’s totient function.\n\nConstruct explicit primitive Dirichlet characters modulo $3$ and modulo $4$, and then construct explicit imprimitive Dirichlet characters modulo $12$ that are induced from the primitive characters modulo $3$ and modulo $4$, respectively. Using only the fundamental definitions above, the Chinese Remainder Theorem for the ring isomorphism $(\\mathbb{Z}/12\\mathbb{Z})\\cong(\\mathbb{Z}/3\\mathbb{Z})\\times(\\mathbb{Z}/4\\mathbb{Z})$ and the orthogonality relations for characters, compute the conductors of these imprimitive characters modulo $12$. Express your final answer as a row matrix containing the two conductors.", "solution": "The user wants me to solve a problem in number theory related to Dirichlet characters.\n\nHere's my plan:\n1.  **Validate the problem statement:** I need to check if the problem is well-defined, scientifically sound, and complete.\n    *   **Step 1: Extract Givens:** I will list all the definitions and conditions provided in the problem.\n        *   $N$: a positive integer.\n        *   Dirichlet character $\\chi \\pmod N$: a completely multiplicative function $\\chi:\\mathbb{Z}\\to\\mathbb{C}$, periodic with period $N$, and $\\chi(n)=0$ iff $\\gcd(n,N)\\neq 1$.\n        *   Primitive character: a character whose conductor is its modulus.\n        *   Conductor of $\\chi \\pmod N$: minimal $f \\mid N$ such that $\\chi$ factors through $(\\mathbb{Z}/f\\mathbb{Z})^{\\times}$. In this case, $\\chi$ is induced by a primitive character modulo $f$. The problem clarifies this means \"via composition with the natural projection $(\\mathbb{Z}/N\\mathbb{Z})^{\\times}\\to(\\mathbb{Z}/f\\mathbb{Z})^{\\times}$\".\n        *   Orthogonality relations: $\\sum_{a\\in(\\mathbb{Z}/N\\mathbb{Z})^{\\times}}\\chi(a)\\,\\overline{\\psi(a)}= \\varphi(N)$ if $\\chi=\\psi$, and $0$ otherwise.\n        *   Task 1: Construct explicit primitive Dirichlet characters modulo $3$ and modulo $4$.\n        *   Task 2: Construct explicit imprimitive Dirichlet characters modulo $12$ induced from the characters from Task 1.\n        *   Task 3: Compute the conductors of these imprimitive characters modulo $12$.\n        *   Tools allowed: Fundamental definitions, Chinese Remainder Theorem for $(\\mathbb{Z}/12\\mathbb{Z})\\cong(\\mathbb{Z}/3\\mathbb{Z})\\times(\\mathbb{Z}/4\\mathbb{Z})$, and orthogonality relations.\n        *   Final answer format: Row matrix of the two conductors.\n\n    *   **Step 2: Validate Using Extracted Givens:**\n        *   **Scientifically Grounded:** The problem deals with standard concepts in analytic number theory (Dirichlet characters, conductors, orthogonality). All definitions are standard and correct.\n        *   **Well-Posed:** The problem asks for specific constructions and computations. The objects (characters, conductors) are well-defined in mathematics. The instructions are clear. A unique solution should exist for the specific tasks.\n        *   **Objective:** The language is formal and mathematical. No subjective claims.\n        *   **Flaw Check:**\n            1.  **Scientific/Factual Unsoundness:** None. The definitions and theorems mentioned are standard.\n            2.  **Non-Formalizable/Irrelevant:** The problem is highly formalizable and directly related to the topic of characters and conductors.\n            3.  **Incomplete/Contradictory Setup:** The problem provides all necessary definitions and constraints. The use of CRT is appropriate for modulus $12=3 \\times 4$.\n            4.  **Unrealistic/Infeasible:** Not applicable to a pure math problem.\n            5.  **Ill-Posed/Poorly Structured:** The problem is well-structured and leads to a definite answer.\n            6.  **Pseudo-Profound/Trivial:** The problem requires a good understanding of the definitions and their application. It's a standard but non-trivial exercise.\n            7.  **Outside Scientific Verifiability:** The results can be verified by standard number theory methods.\n\n    *   **Step 3: Verdict and Action:** The problem is **valid**. I will proceed to solve it.\n\n2.  **Solve the problem:**\n    *   **Part 1: Construct primitive characters mod 3 and mod 4.**\n        *   **Modulo 3:** The group $(\\mathbb{Z}/3\\mathbb{Z})^\\times = \\{[1]_3, [2]_3\\}$ is cyclic of order $\\varphi(3)=2$. There are two characters, homomorphisms from this group to $\\mathbb{C}^\\times$.\n            *   The trivial character $\\chi_{0,3}$ sends all elements to $1$. Its conductor is $1$.\n            *   The non-trivial character, which we denote $\\chi_3$, is determined by $\\chi_3(2)=-1$ (and $\\chi_3(1)=1$). To be a primitive character modulo $3$, its conductor must be $3$. The only proper divisor of $3$ is $1$. A character has conductor $1$ if and only if it is the trivial character. Since $\\chi_3$ is non-trivial, it does not have conductor $1$. Thus, its conductor must be $3$, and it is primitive. We define $\\chi_3: \\mathbb{Z} \\to \\mathbb{C}$ as:\n                $$ \\chi_3(n) = \\begin{cases} 1 & \\text{if } n \\equiv 1 \\pmod 3 \\\\ -1 & \\text{if } n \\equiv 2 \\pmod 3 \\\\ 0 & \\text{if } \\gcd(n,3) \\neq 1 \\end{cases} $$\n\n        *   **Modulo 4:** The group $(\\mathbb{Z}/4\\mathbb{Z})^\\times = \\{[1]_4, [3]_4\\}$ is cyclic of order $\\varphi(4)=2$.\n            *   The trivial character $\\chi_{0,4}$ has conductor $1$.\n            *   The non-trivial character, denoted $\\chi_4$, is determined by $\\chi_4(3)=-1$ (and $\\chi_4(1)=1$). To be primitive modulo $4$, its conductor must be $4$. The proper divisors of $4$ are $1$ and $2$.\n                *   Its conductor is not $1$ as it is non-trivial.\n                *   Could the conductor be $2$? The conductor is $2$ if the character factors through $(\\mathbb{Z}/2\\mathbb{Z})^\\times$. The kernel of the projection $\\pi: (\\mathbb{Z}/4\\mathbb{Z})^\\times \\to (\\mathbb{Z}/2\\mathbb{Z})^\\times$ is the set $\\{a \\in (\\mathbb{Z}/4\\mathbb{Z})^\\times \\mid a \\equiv 1 \\pmod 2\\}$. This is the entire group $(\\mathbb{Z}/4\\mathbb{Z})^\\times = \\{1,3\\}$. For the character to factor through $(\\mathbb{Z}/2\\mathbb{Z})^\\times$, it must be trivial on this kernel. But $\\chi_4(3)=-1$, so it is not trivial.\n                *   Therefore, the conductor is not $1$ or $2$. It must be $4$. So, $\\chi_4$ is primitive. We define $\\chi_4: \\mathbb{Z} \\to \\mathbb{C}$ as:\n                $$ \\chi_4(n) = \\begin{cases} 1 & \\text{if } n \\equiv 1 \\pmod 4 \\\\ -1 & \\text{if } n \\equiv 3 \\pmod 4 \\\\ 0 & \\text{if } \\gcd(n,4) \\neq 1 \\end{cases} $$\n\n    *   **Part 2: Construct imprimitive characters modulo 12.**\n        A character $\\chi$ modulo $N$ is induced by a primitive character $\\psi$ modulo $f$ (where $f|N$) if for any $a \\in (\\mathbb{Z}/N\\mathbb{Z})^\\times$, $\\chi(a) = \\psi(a \\pmod f)$.\n        *   **First Character $\\Psi_1$:** Induced by the primitive character $\\chi_3$ modulo $3$.\n            For $a \\in (\\mathbb{Z}/12\\mathbb{Z})^\\times = \\{1, 5, 7, 11\\}$, the values of $\\Psi_1$ are:\n            $\\Psi_1(1) = \\chi_3(1 \\pmod 3) = \\chi_3(1) = 1$.\n            $\\Psi_1(5) = \\chi_3(5 \\pmod 3) = \\chi_3(2) = -1$.\n            $\\Psi_1(7) = \\chi_3(7 \\pmod 3) = \\chi_3(1) = 1$.\n            $\\Psi_1(11) = \\chi_3(11 \\pmod 3) = \\chi_3(2) = -1$.\n            We extend $\\Psi_1$ to all integers by setting $\\Psi_1(n)=0$ if $\\gcd(n,12)\\neq 1$. $\\Psi_1$ is imprimitive as it is induced from a character of a smaller modulus ($3 < 12$).\n\n        *   **Second Character $\\Psi_2$:** Induced by the primitive character $\\chi_4$ modulo $4$.\n            For $a \\in (\\mathbb{Z}/12\\mathbb{Z})^\\times = \\{1, 5, 7, 11\\}$, the values of $\\Psi_2$ are:\n            $\\Psi_2(1) = \\chi_4(1 \\pmod 4) = \\chi_4(1) = 1$.\n            $\\Psi_2(5) = \\chi_4(5 \\pmod 4) = \\chi_4(1) = 1$.\n            $\\Psi_2(7) = \\chi_4(7 \\pmod 4) = \\chi_4(3) = -1$.\n            $\\Psi_2(11) = \\chi_4(11 \\pmod 4) = \\chi_4(3) = -1$.\n            We extend $\\Psi_2$ to all integers by setting $\\Psi_2(n)=0$ if $\\gcd(n,12)\\neq 1$. $\\Psi_2$ is imprimitive ($4 < 12$).\n\n    *   **Part 3: Compute the conductors.**\n        The conductor of a character $\\xi$ modulo $N$ is the smallest positive integer $f$ dividing $N$ such that $\\xi$ is induced by a primitive character modulo $f$. This is equivalent to finding the smallest $d|N$ for which $\\xi$ is induced by *some* character modulo $d$. A character $\\xi$ modulo $N$ is induced by a character $\\psi$ modulo $d$ if and only if they are equal on $(\\mathbb{Z}/N\\mathbb{Z})^\\times$, where the values of $\\psi$ are computed via the projection $(\\mathbb{Z}/N\\mathbb{Z})^\\times \\to (\\mathbb{Z}/d\\mathbb{Z})^\\times$. We use orthogonality to test for equality of characters.\n\n        *   **Conductor of $\\Psi_1$:**\n            By construction, $\\Psi_1$ is induced from the character $\\chi_3$ modulo $3$. To verify this using orthogonality, we denote the character induced from $\\chi_3$ as $\\chi_3'$. We test if $\\Psi_1 = \\chi_3'$ by computing $\\sum_{a \\in (\\mathbb{Z}/12\\mathbb{Z})^\\times} \\Psi_1(a) \\overline{\\chi_3'(a)}$.\n            The values are $\\Psi_1(a) = \\chi_3'(a)$ for $a \\in \\{1, 5, 7, 11\\}$.\n            The sum is $\\Psi_1(1)\\overline{\\chi_3'(1)} + \\Psi_1(5)\\overline{\\chi_3'(5)} + \\Psi_1(7)\\overline{\\chi_3'(7)} + \\Psi_1(11)\\overline{\\chi_3'(11)}$\n            $= (1)(\\overline{1}) + (-1)(\\overline{-1}) + (1)(\\overline{1}) + (-1)(\\overline{-1}) = 1+1+1+1 = 4$.\n            Since the sum is $4 = \\varphi(12)$, by the orthogonality relations, $\\Psi_1 = \\chi_3'$.\n            So, $\\Psi_1$ is induced from a character modulo $3$.\n            We must check if it can be induced from a character of a smaller modulus, i.e., $d=1$ or $d=2$. Divisors of $12$ are $1, 2, 3, 4, 6, 12$.\n            A character induced from modulus $d=1$ must be the principal character $\\Psi_0$, with $\\Psi_0(a)=1$ for all $a \\in (\\mathbb{Z}/12\\mathbb{Z})^\\times$. Since $\\Psi_1(5)=-1$, $\\Psi_1$ is not the principal character.\n            The group $(\\mathbb{Z}/2\\mathbb{Z})^\\times = \\{1\\}$ has only the trivial character. Any character induced from modulus $d=2$ is also the principal character modulo $12$.\n            Thus, the smallest modulus $d$ is $3$. Since $\\Psi_1$ is induced by $\\chi_3$, which is a primitive character modulo $3$, the conductor of $\\Psi_1$ is $3$.\n\n        *   **Conductor of $\\Psi_2$:**\n            By construction, $\\Psi_2$ is induced from the character $\\chi_4$ modulo $4$. We denote this induced character by $\\chi_4'$. We can verify $\\Psi_2 = \\chi_4'$ using orthogonality:\n            $\\sum_{a \\in (\\mathbb{Z}/12\\mathbb{Z})^\\times} \\Psi_2(a) \\overline{\\chi_4'(a)} = (1)(\\overline{1}) + (1)(\\overline{1}) + (-1)(\\overline{-1}) + (-1)(\\overline{-1}) = 1+1+1+1=4=\\varphi(12)$.\n            So, $\\Psi_2$ is induced from a character modulo $4$.\n            We check smaller moduli $d=1, 2, 3$.\n            As before, if $d=1$ or $d=2$, the induced character is principal, which $\\Psi_2$ is not ($\\Psi_2(7)=-1$).\n            Could $\\Psi_2$ be induced by a character modulo $3$? The characters modulo $3$ are the trivial one $\\chi_{0,3}$ (which induces the principal character) and the primitive one $\\chi_3$. We test if $\\Psi_2$ is equal to $\\chi_3'$, the character induced by $\\chi_3$. We use orthogonality:\n            $\\sum_{a \\in (\\mathbb{Z}/12\\mathbb{Z})^\\times} \\Psi_2(a) \\overline{\\chi_3'(a)} = \\Psi_2(1)\\overline{\\chi_3'(1)} + \\Psi_2(5)\\overline{\\chi_3'(5)} + \\Psi_2(7)\\overline{\\chi_3'(7)} + \\Psi_2(11)\\overline{\\chi_3'(11)}$\n            $= (1)(\\overline{1}) + (1)(\\overline{-1}) + (-1)(\\overline{1}) + (-1)(\\overline{-1}) = 1 - 1 - 1 + 1 = 0$.\n            Since the sum is $0$, $\\Psi_2 \\neq \\chi_3'$ by orthogonality.\n            Therefore, $\\Psi_2$ is not induced from any character modulo $3$.\n            The smallest modulus from which $\\Psi_2$ is induced is $d=4$. The character it is induced from, $\\chi_4$, is primitive. Therefore, the conductor of $\\Psi_2$ is $4$.\n\nThe computed conductors for the two imprimitive characters are $3$ and $4$, respectively. The final answer should be expressed as a row matrix.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3 & 4\n\\end{pmatrix}\n}\n$$"}, {"introduction": "While the conductor provides a formal definition for primitivity, other powerful tools can reveal a character's nature. This practice introduces the Gauss sum, $\\\\tau(\\\\chi)$, an object of central importance in number theory that links multiplicative and additive characters. You will discover a remarkable property: the absolute value of the Gauss sum provides a simple and elegant test for whether a character is primitive, connecting an algebraic property to an analytic one [@problem_id:3020219].", "id": "3020219", "problem": "Let $q \\in \\{3,4,5\\}$. A Dirichlet character modulo $q$ is a completely multiplicative function $\\chi:\\mathbb{Z}\\to\\mathbb{C}$ that is periodic with period $q$, satisfies $\\chi(n)=0$ if $\\gcd(n,q)\\neq 1$ (where $\\gcd$ denotes Greatest Common Divisor), and satisfies $\\chi(n)\\neq 0$ if and only if $n$ is invertible modulo $q$. The Gauss sum of a Dirichlet character $\\chi$ modulo $q$ is defined by\n$$\n\\tau(\\chi)=\\sum_{n=1}^{q} \\chi(n)\\,\\exp\\!\\left(\\frac{2\\pi i\\, n}{q}\\right).\n$$\nStarting from the definitions and orthogonality relations for Dirichlet characters and additive characters, compute the Gauss sums $\\tau(\\chi)$ for all Dirichlet characters modulo $3$, $4$, and $5$. Then, using first principles about conductors and induction of characters, identify which of these characters are primitive. Finally, let\n$$\nS \\;=\\; \\sum_{q\\in\\{3,4,5\\}} \\;\\sum_{\\chi \\ (\\mathrm{mod}\\ q)} \\big|\\tau(\\chi)\\big|,\n$$\nand report $S$ as a single exact expression. No rounding is required, and you must provide the exact value for $S$.", "solution": "The problem requires the calculation of Gauss sums for all Dirichlet characters modulo $q \\in \\{3, 4, 5\\}$, the identification of primitive characters among them, and finally the computation of the sum $S = \\sum_{q\\in\\{3,4,5\\}} \\sum_{\\chi \\pmod q} |\\tau(\\chi)|$. We will proceed by analyzing each modulus $q$ separately.\n\nA general property for the Gauss sum of the principal character $\\chi_0$ modulo $q > 1$ is that $\\tau(\\chi_0) = \\sum_{n=1, \\gcd(n,q)=1}^{q} \\exp(\\frac{2\\pi i n}{q})$, which is equal to the Möbius function $\\mu(q)$.\n\nA character $\\chi$ modulo $q$ is called primitive if it is not induced by a character $\\psi$ modulo a proper divisor $d$ of $q$ (i.e., $d|q$ and $d < q$). A character $\\chi$ is induced by $\\psi$ if $\\chi(n) = \\psi(n)$ for all $n$ such that $\\gcd(n,q)=1$. The conductor of $\\chi$ is the smallest such $d$. A character is primitive if its conductor is $q$. For a primitive character $\\chi$ modulo $q$, it is a fundamental theorem that $|\\tau(\\chi)| = \\sqrt{q}$. Any non-principal character modulo a prime $p$ is primitive.\n\nLet $\\zeta_q = \\exp(2\\pi i/q)$. The Gauss sum is $\\tau(\\chi) = \\sum_{n=1}^q \\chi(n) \\zeta_q^n$.\n\n**Case 1: Modulo $q=3$**\nThe group of units is $(\\mathbb{Z}/3\\mathbb{Z})^\\times = \\{1, 2\\}$, which is cyclic of order $\\phi(3)=2$ and generated by $2$. There are two Dirichlet characters modulo $3$.\n\n1.  The principal character $\\chi_{3,0}$:\n    $\\chi_{3,0}(1)=1$, $\\chi_{3,0}(2)=1$, $\\chi_{3,0}(3)=0$.\n    This character is induced by the trivial character modulo $1$, so its conductor is $1$. It is not primitive.\n    The Gauss sum is $\\tau(\\chi_{3,0}) = \\sum_{n=1}^3 \\chi_{3,0}(n) \\zeta_3^n = \\zeta_3^1 + \\zeta_3^2 = -1$. This matches the general formula $\\tau(\\chi_{3,0}) = \\mu(3) = -1$.\n    The magnitude is $|\\tau(\\chi_{3,0})| = |-1| = 1$.\n\n2.  The non-principal character $\\chi_{3,1}$:\n    This character is determined by $\\chi_{3,1}(2)=-1$. So, $\\chi_{3,1}(1)=1$, $\\chi_{3,1}(2)=-1$, $\\chi_{3,1}(3)=0$.\n    Since $3$ is prime, this non-principal character is primitive. Its conductor is $3$.\n    The Gauss sum is $\\tau(\\chi_{3,1}) = \\sum_{n=1}^3 \\chi_{3,1}(n) \\zeta_3^n = \\zeta_3^1 - \\zeta_3^2$.\n    Since $\\zeta_3 = -\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}$ and $\\zeta_3^2 = -\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}$, we have $\\tau(\\chi_{3,1}) = (-\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}) - (-\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}) = i\\sqrt{3}$.\n    The magnitude is $|\\tau(\\chi_{3,1})| = |i\\sqrt{3}| = \\sqrt{3}$. This matches the property $|\\tau(\\chi)| = \\sqrt{q}$ for primitive characters.\n\nThe sum of magnitudes for $q=3$ is $1 + \\sqrt{3}$.\n\n**Case 2: Modulo $q=4$**\nThe group of units is $(\\mathbb{Z}/4\\mathbb{Z})^\\times = \\{1, 3\\}$, which is cyclic of order $\\phi(4)=2$ and generated by $3$. There are two Dirichlet characters modulo $4$.\n\n1.  The principal character $\\chi_{4,0}$:\n    $\\chi_{4,0}(1)=1$, $\\chi_{4,0}(3)=1$, and $\\chi_{4,0}(n)=0$ for even $n$.\n    This character is induced by the trivial character modulo $1$. Its conductor is $1$. It is not primitive.\n    The Gauss sum is $\\tau(\\chi_{4,0}) = \\sum_{n=1}^4 \\chi_{4,0}(n) \\zeta_4^n = \\zeta_4^1 + \\zeta_4^3 = i + (-i) = 0$. This matches the general formula $\\tau(\\chi_{4,0}) = \\mu(4) = 0$.\n    The magnitude is $|\\tau(\\chi_{4,0})| = 0$.\n\n2.  The non-principal character $\\chi_{4,1}$:\n    This character is determined by $\\chi_{4,1}(3)=-1$. So, $\\chi_{4,1}(1)=1$, $\\chi_{4,1}(3)=-1$, and $\\chi_{4,1}(n)=0$ for even $n$.\n    To determine if it is primitive, we check divisors of $4$, which are $1$ and $2$. It's not induced from modulus $1$ (which gives $\\chi_{4,0}$). The only character mod $2$ is the trivial one, $\\psi(n)=1$ for odd $n$. If $\\chi_{4,1}$ were induced from $\\psi$, we would need $\\chi_{4,1}(n) = \\psi(n)$ for odd $n$. But $\\chi_{4,1}(3)=-1$ while $\\psi(3)=\\psi(1)=1$. So $\\chi_{4,1}$ is not induced from a character mod $2$. Thus, its conductor is $4$, and it is primitive.\n    The Gauss sum is $\\tau(\\chi_{4,1}) = \\sum_{n=1}^4 \\chi_{4,1}(n) \\zeta_4^n = \\zeta_4^1 - \\zeta_4^3 = i - (-i) = 2i$.\n    The magnitude is $|\\tau(\\chi_{4,1})| = |2i| = 2$. This matches the property $|\\tau(\\chi)| = \\sqrt{q} = \\sqrt{4} = 2$ for primitive characters.\n\nThe sum of magnitudes for $q=4$ is $0 + 2 = 2$.\n\n**Case 3: Modulo $q=5$**\nThe group of units $(\\mathbb{Z}/5\\mathbb{Z})^\\times = \\{1, 2, 3, 4\\}$ is cyclic of order $\\phi(5)=4$. A generator is $2$. There are four Dirichlet characters modulo $5$.\n\n1.  The principal character $\\chi_{5,0}$:\n    $\\chi_{5,0}(n)=1$ for $\\gcd(n,5)=1$, and $\\chi_{5,0}(n)=0$ otherwise.\n    This character is induced by the trivial character modulo $1$. Conductor is $1$. It is not primitive.\n    The Gauss sum is $\\tau(\\chi_{5,0}) = \\sum_{n=1}^4 \\zeta_5^n = -1$. This matches $\\mu(5)=-1$.\n    The magnitude is $|\\tau(\\chi_{5,0})| = |-1| = 1$.\n\n2.  The three non-principal characters $\\chi_{5,1}, \\chi_{5,2}, \\chi_{5,3}$:\n    Since $5$ is prime, any non-principal character is primitive. Their conductors are $5$. We can therefore use the property $|\\tau(\\chi)|=\\sqrt{5}$ for all of them.\n    Explicitly, these characters are determined by the value on the generator $g=2$, which must be a $4$-th root of unity.\n    - $\\chi_{5,1}(2)=i$: Values are $(1, i, -i, -1)$ for $n=(1, 2, 3, 4)$.\n    - $\\chi_{5,2}(2)=-1$: Values are $(1, -1, -1, 1)$ for $n=(1, 2, 3, 4)$. This is the Legendre symbol $(\\frac{n}{5})$.\n    - $\\chi_{5,3}(2)=-i$: Values are $(1, -i, i, -1)$ for $n=(1, 2, 3, 4)$.\n    For each of these three primitive characters, the magnitude of the Gauss sum is $|\\tau(\\chi)| = \\sqrt{5}$.\n    We can verify a case. For $\\chi_{5,2}(n) = (\\frac{n}{5})$, the Gauss sum is $\\tau(\\chi_{5,2})=\\sum_{n=1}^4 (\\frac{n}{5})\\zeta_5^n = \\zeta_5 + \\zeta_5^4 - \\zeta_5^2 - \\zeta_5^3$. Using $\\zeta_5+\\zeta_5^4 = 2\\cos(2\\pi/5) = (\\sqrt{5}-1)/2$ and $\\zeta_5^2+\\zeta_5^3 = 2\\cos(4\\pi/5) = (-\\sqrt{5}-1)/2$, we get $\\tau(\\chi_{5,2}) = (\\zeta_5+\\zeta_5^4)-(\\zeta_5^2+\\zeta_5^3) = \\frac{\\sqrt{5}-1}{2} - \\frac{-\\sqrt{5}-1}{2} = \\sqrt{5}$. This confirms $|\\tau(\\chi_{5,2})|=\\sqrt{5}$.\n\nThe sum of magnitudes for $q=5$ is $|\\tau(\\chi_{5,0})| + |\\tau(\\chi_{5,1})| + |\\tau(\\chi_{5,2})| + |\\tau(\\chi_{5,3})| = 1 + \\sqrt{5} + \\sqrt{5} + \\sqrt{5} = 1 + 3\\sqrt{5}$.\n\n**Final Calculation**\nThe total sum $S$ is the sum of the sums for each modulus:\n$$\nS = \\sum_{q\\in\\{3,4,5\\}} \\sum_{\\chi \\pmod q} |\\tau(\\chi)| = (1+\\sqrt{3}) + (2) + (1+3\\sqrt{5})\n$$\n$$\nS = 1 + \\sqrt{3} + 2 + 1 + 3\\sqrt{5} = 4 + \\sqrt{3} + 3\\sqrt{5}\n$$\nThe requested value is $S$.\n\nSummary of Characters and Primitivity:\n-   $q=3$: $\\chi_{3,0}$ (conductor $1$, non-primitive), $\\chi_{3,1}$ (conductor $3$, primitive).\n-   $q=4$: $\\chi_{4,0}$ (conductor $1$, non-primitive), $\\chi_{4,1}$ (conductor $4$, primitive).\n-   $q=5$: $\\chi_{5,0}$ (conductor $1$, non-primitive), $\\chi_{5,1}, \\chi_{5,2}, \\chi_{5,3}$ (all conductor $5$, primitive).\n\nSummary of Gauss Sums:\n-   $q=3$: $\\tau(\\chi_{3,0})=-1$, $\\tau(\\chi_{3,1})=i\\sqrt{3}$.\n-   $q=4$: $\\tau(\\chi_{4,0})=0$, $\\tau(\\chi_{4,1})=2i$.\n-   $q=5$: $\\tau(\\chi_{5,0})=-1$, $\\tau(\\chi_{5,1})=-\\frac{\\sqrt{10-2\\sqrt{5}}}{2} + i\\frac{\\sqrt{10+2\\sqrt{5}}}{2}$, $\\tau(\\chi_{5,2})=\\sqrt{5}$, $\\tau(\\chi_{5,3})=-\\frac{\\sqrt{10-2\\sqrt{5}}}{2} - i\\frac{\\sqrt{10+2\\sqrt{5}}}{2}$. Magnitudes are $1, \\sqrt{5}, \\sqrt{5}, \\sqrt{5}$ respectively.\nThe solution does not require the explicit complex values for all Gauss sums, only their magnitudes, which were determined using the primitivity property.\nThe final sum is $S = 4 + \\sqrt{3} + 3\\sqrt{5}$.", "answer": "$$\n\\boxed{4 + \\sqrt{3} + 3\\sqrt{5}}\n$$"}, {"introduction": "After exploring specific examples, the next step is to generalize our understanding to entire families of moduli. This exercise delves into the rich structure of characters modulo prime powers $p^k$, a critical building block for understanding characters of any modulus. By analyzing the group of units through its $p$-adic filtration, you will derive a precise formula for a character's conductor and determine a necessary and sufficient condition for it to be primitive, revealing the beautiful interplay between algebra and character theory [@problem_id:3020204].", "id": "3020204", "problem": "Let $p$ be an odd prime and let $k \\geq 2$ be an integer. Consider Dirichlet characters modulo $p^{k}$, viewed as group homomorphisms from $(\\mathbb{Z}/p^{k}\\mathbb{Z})^{\\times}$ to $\\mathbb{C}^{\\times}$, extended by the value $0$ on integers not coprime to $p$. Recall the standard structure theorem for the unit group $(\\mathbb{Z}/p^{k}\\mathbb{Z})^{\\times}$: it decomposes as a direct product $(\\mathbb{Z}/p^{k}\\mathbb{Z})^{\\times} \\simeq \\mu_{p-1} \\times U_{1}$, where $\\mu_{p-1}$ denotes the cyclic group of $(p-1)$-st roots of unity in $(\\mathbb{Z}/p^{k}\\mathbb{Z})^{\\times}$, and $U_{1} := 1 + p\\mathbb{Z}/p^{k}\\mathbb{Z}$ denotes the group of principal units, which is cyclic of order $p^{k-1}$ and admits the decreasing $p$-adic filtration $U_{1} \\supset U_{2} \\supset \\cdots \\supset U_{k} = \\{1\\}$, where $U_{i} := 1 + p^{i}\\mathbb{Z}/p^{k}\\mathbb{Z}$ and $|U_{i}/U_{i+1}| = p$ for $1 \\leq i \\leq k-1$.\n\nFix a Dirichlet character $\\chi$ modulo $p^{k}$. Let the restriction of $\\chi$ to $\\mu_{p-1}$ be the character $\\omega^{a}$ for some integer $a$ with $0 \\leq a \\leq p-2$, where $\\omega$ denotes the Teichmüller character generating the character group of $\\mu_{p-1}$. Let $u := 1+p \\in U_{1}$ and suppose that $\\chi(u)$ has exact order $p^{s}$ for some integer $s$ with $0 \\leq s \\leq k-1$. Using only the core definitions of Dirichlet character, conductor, and the $p$-adic filtration of units on $(\\mathbb{Z}/p^{k}\\mathbb{Z})^{\\times}$, do the following:\n\n1. Derive an explicit expression for the conductor $\\operatorname{cond}(\\chi)$ of $\\chi$ as a function of $p$, $a$, $s$, and $k$, by determining the minimal $m$ such that $\\chi$ factors through $(\\mathbb{Z}/p^{m}\\mathbb{Z})^{\\times}$, equivalently the minimal $m$ such that $\\chi$ is trivial on $U_{m}$.\n\n2. Express, in terms of the $p$-adic filtration $\\{U_{i}\\}$, a necessary and sufficient condition on $s$ (and any dependence on $a$) for $\\chi$ to be primitive modulo $p^{k}$, i.e., to have $\\operatorname{cond}(\\chi) = p^{k}$.\n\n3. Determine the total number of primitive Dirichlet characters modulo $p^{k}$ and give your final answer as a single closed-form analytic expression in $p$ and $k$.\n\nYour final answer must be a single closed-form analytic expression. No rounding is required.", "solution": "The problem asks for an analysis of Dirichlet characters $\\chi$ modulo $p^k$, where $p$ is an odd prime and $k \\geq 2$ is an integer. The character $\\chi$ is determined by two parameters: an integer $a$ with $0 \\leq a \\leq p-2$ defining its restriction to the subgroup $\\mu_{p-1}$, and an integer $s$ with $0 \\leq s \\leq k-1$ related to its restriction to the subgroup of principal units $U_1$. Specifically, $\\chi(1+p)$ is a root of unity of exact order $p^s$.\n\nThe group of units $(\\mathbb{Z}/p^k\\mathbb{Z})^\\times$ decomposes as an internal direct product $(\\mathbb{Z}/p^k\\mathbb{Z})^\\times \\cong \\mu_{p-1} \\times U_1$, where $\\mu_{p-1}$ is the cyclic group of order $p-1$ consisting of the $(p-1)$-th roots of unity, and $U_1 = 1+p\\mathbb{Z}/p^k\\mathbb{Z}$ is the cyclic group of principal units of order $p^{k-1}$. Since $p$ is an odd prime, $U_1$ is generated by the element $u=1+p$. The character $\\chi$ is uniquely determined by its values on the generators of $\\mu_{p-1}$ and $U_1$. The data provided specifies $\\chi$'s behavior on these components.\n\nThe conductor of $\\chi$, denoted $\\operatorname{cond}(\\chi)$, is the smallest integer $d>0$ such that $\\chi$ is induced by a character modulo $d$. For a character modulo $p^k$, the conductor must be of the form $p^m$ for some $0 \\leq m \\leq k$. A character $\\chi$ modulo $p^k$ has a conductor $p^m$ if and only if $m$ is the minimal integer such that $\\chi$ is trivial on the kernel of the natural projection $(\\mathbb{Z}/p^k\\mathbb{Z})^\\times \\to (\\mathbb{Z}/p^m\\mathbb{Z})^\\times$. This kernel is precisely the subgroup $U_m = 1 + p^m\\mathbb{Z}/p^k\\mathbb{Z}$. To handle the case of the principal character, whose conductor is $1=p^0$, we can define $U_0 := (\\mathbb{Z}/p^k\\mathbb{Z})^\\times$. Thus, the conductor of $\\chi$ is $p^m$, where $m$ is the smallest integer in $\\{0, 1, \\dots, k\\}$ such that $\\chi$ is trivial on $U_m$.\n\n### 1. Derivation of the conductor $\\operatorname{cond}(\\chi)$\n\nWe determine the minimal $m$ described above based on the parameters $a$ and $s$.\n\nCase 1: The principal character.\nThe character $\\chi$ is the principal character if and only if it is trivial on the entire group $(\\mathbb{Z}/p^k\\mathbb{Z})^\\times$. This requires its restrictions to both $\\mu_{p-1}$ and $U_1$ to be trivial.\nThe restriction $\\chi|_{\\mu_{p-1}}$ is trivial if and only if $a=0$.\nThe restriction $\\chi|_{U_1}$ is trivial if and only if $\\chi(1+p)=1$, since $1+p$ generates $U_1$. The order of $\\chi(1+p)$ is $p^s$, so $\\chi(1+p)=1$ if and only if $p^s=1$, which means $s=0$.\nThus, $\\chi$ is the principal character if and only if $(a,s) = (0,0)$.\nIn this case, $\\chi$ is trivial on $U_0 = (\\mathbb{Z}/p^k\\mathbb{Z})^\\times$. The minimal such $m$ is $0$.\nSo, if $a=0$ and $s=0$, the conductor is $p^0=1$.\n\nCase 2: The character is non-trivial, but its restriction to $U_1$ is trivial.\nThis corresponds to $s=0$ but $a \\neq 0$. Since $s=0$, $\\chi$ is trivial on $U_1$. Since $a \\neq 0$, $\\chi$ is not the principal character, so it is not trivial on $U_0 = (\\mathbb{Z}/p^k\\mathbb{Z})^\\times$. The smallest integer $m$ for which $\\chi$ is trivial on $U_m$ is therefore $m=1$.\nSo, if $a \\neq 0$ and $s=0$, the conductor is $p^1=p$. This is consistent with $\\chi$ being a non-trivial character of $(\\mathbb{Z}/p\\mathbb{Z})^\\times$ lifted to $(\\mathbb{Z}/p^k\\mathbb{Z})^\\times$.\n\nCase 3: The character's restriction to $U_1$ is non-trivial.\nThis corresponds to $s \\geq 1$. This implies $\\chi$ is not trivial on $U_1$, so the conductor exponent $m$ must be greater than $1$. We seek the minimal $m$ such that $\\chi$ is trivial on $U_m$.\nThe group $U_m$ is a subgroup of $U_1$. Since $U_1$ is cyclic of order $p^{k-1}$ generated by $1+p$, its subgroups are also cyclic. The subgroup $U_m$ has order $|U_m|=|1+p^m\\mathbb{Z}/p^k\\mathbb{Z}| = p^{k-m}$. It is the unique subgroup of $U_1$ of this order. A generator for this subgroup is $(1+p)^{p^{k-1 - (k-m)}} = (1+p)^{p^{m-1}}$.\nFor $\\chi$ to be trivial on $U_m$, it must be trivial on its generator. So, we require:\n$$ \\chi\\left((1+p)^{p^{m-1}}\\right) = 1 $$\nUsing the homomorphism property of $\\chi$:\n$$ \\left(\\chi(1+p)\\right)^{p^{m-1}} = 1 $$\nWe are given that $\\chi(1+p)$ has exact order $p^s$. Therefore, the condition becomes that $p^{m-1}$ must be a multiple of $p^s$. This is equivalent to the inequality $m-1 \\geq s$, or $m \\geq s+1$.\nSince we seek the minimal integer $m$, we must have $m=s+1$. This holds for any $s \\geq 1$.\nSo, if $s \\geq 1$, the conductor is $p^{s+1}$. Note that if $s \\geq 1$, we have $m = s+1 \\geq 2$. This conductor is greater than $p$, so it correctly subsumes any requirement from the $a \\neq 0$ case.\n\nCombining these results, the conductor of $\\chi$ is $p^m$, where $m$ is given by:\n$$ m = \\begin{cases} 0 & \\text{if } a=0 \\text{ and } s=0 \\\\ 1 & \\text{if } a\\neq 0 \\text{ and } s=0 \\\\ s+1 & \\text{if } s \\geq 1 \\end{cases} $$\nThe expression for the conductor is therefore $\\operatorname{cond}(\\chi) = p^m$.\n\n### 2. Condition for $\\chi$ to be primitive\n\nA character $\\chi$ modulo $p^k$ is primitive if its conductor is exactly $p^k$. Using the results from part 1, this means we require the conductor exponent $m$ to be equal to $k$.\nLet's examine the cases:\n- If $(a,s) = (0,0)$, then $m=0$. Since $k \\geq 2$, $m \\neq k$.\n- If $a \\neq 0$ and $s=0$, then $m=1$. Since $k \\geq 2$, $m \\neq k$.\n- If $s \\geq 1$, then $m=s+1$. For $\\chi$ to be primitive, we need $m=k$, which implies $s+1=k$, or $s=k-1$.\n\nThe condition $k \\geq 2$ ensures that if $s=k-1$, then $s \\geq 1$, so we are correctly in this case. The condition is independent of the parameter $a$, which can be any integer in $\\{0, 1, \\dots, p-2\\}$.\nThe necessary and sufficient condition for $\\chi$ to be primitive is $s=k-1$.\nIn terms of the $p$-adic filtration, the conductor of $\\chi$ is $p^k$ if and only if $\\chi$ is trivial on $U_k=\\{1\\}$, which is always true, but is not trivial on any $U_m$ for $m<k$. This is equivalent to $\\chi$ being non-trivial on $U_{k-1}$. Our condition $s=k-1$ means that the order of $\\chi(1+p)$ is $p^{k-1}$. The generator of $U_{k-1}$ is $(1+p)^{p^{k-2}}$.\n$$ \\chi((1+p)^{p^{k-2}}) = (\\chi(1+p))^{p^{k-2}} $$\nThis value is not equal to $1$ if and only if the order of $\\chi(1+p)$, which is $p^s$, does not divide $p^{k-2}$. This means $s > k-2$, so $s \\geq k-1$. As we are given $s \\leq k-1$, the only possibility is $s=k-1$. This confirms the condition.\n\n### 3. Total number of primitive Dirichlet characters modulo $p^k$\n\nWe need to count the number of characters $\\chi$ modulo $p^k$ that are primitive. From part 2, this is equivalent to counting the number of characters for which $s=k-1$.\n\nA character $\\chi$ on $(\\mathbb{Z}/p^k\\mathbb{Z})^\\times \\cong \\mu_{p-1} \\times U_1$ is uniquely determined by its restrictions to $\\mu_{p-1}$ and $U_1$. Let $\\chi_1 = \\chi|_{\\mu_{p-1}}$ and $\\chi_2 = \\chi|_{U_1}$.\nThe group of characters $\\widehat{\\mu_{p-1}}$ is cyclic of order $p-1$. The choice of $\\chi_1$ is specified by the parameter $a \\in \\{0, 1, \\dots, p-2\\}$, giving $p-1$ possible choices for $\\chi_1$.\nThe group of characters $\\widehat{U_1}$ is cyclic of order $p^{k-1}$. The choice of $\\chi_2$ is specified by its value on the generator $u=1+p$. The value $\\chi_2(u)$ must be a $p^{k-1}$-th root of unity. The parameter $s$ gives the exponent of the order of $\\chi(u)=\\chi_2(u)$.\nThe condition for $\\chi$ to be primitive is $s=k-1$. This means the order of $\\chi_2(1+p)$ must be exactly $p^{k-1}$. In other words, $\\chi_2(1+p)$ must be a primitive $p^{k-1}$-th root of unity.\nThe number of primitive $n$-th roots of unity is given by Euler's totient function, $\\phi(n)$. Thus, the number of choices for $\\chi_2(1+p)$ is $\\phi(p^{k-1})$.\nThe formula for Euler's function at a prime power is $\\phi(p^j) = p^j - p^{j-1}$.\nSo, the number of choices for $\\chi_2$ that satisfy the primitivity condition is:\n$$ \\phi(p^{k-1}) = p^{k-1} - p^{k-2} = p^{k-2}(p-1) $$\nThe total number of primitive characters is the product of the number of independent choices for $\\chi_1$ and $\\chi_2$.\nNumber of choices for $a$ (determining $\\chi_1$): $p-1$.\nNumber of choices for $\\chi_2$ (such that $s=k-1$): $\\phi(p^{k-1}) = p^{k-2}(p-1)$.\nTotal number of primitive characters = $(p-1) \\times (p^{k-2}(p-1)) = p^{k-2}(p-1)^2$.\n\nThis result can be verified by the standard formula for the number of primitive characters modulo $p^k$, which is $\\phi(p^k) - \\phi(p^{k-1})$ for $k \\ge 1$.\nFor $k \\ge 2$:\n$$ \\phi(p^k) - \\phi(p^{k-1}) = (p^k - p^{k-1}) - (p^{k-1} - p^{k-2}) $$\n$$ = p^{k-1}(p-1) - p^{k-2}(p-1) $$\n$$ = (p-1)(p^{k-1} - p^{k-2}) $$\n$$ = (p-1)p^{k-2}(p-1) = p^{k-2}(p-1)^2 $$\nThis confirms our derived result.", "answer": "$$ \\boxed{p^{k-2}(p-1)^2} $$"}]}