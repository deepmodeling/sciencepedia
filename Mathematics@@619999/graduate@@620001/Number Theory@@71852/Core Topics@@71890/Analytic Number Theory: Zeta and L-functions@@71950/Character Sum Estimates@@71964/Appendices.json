{"hands_on_practices": [{"introduction": "Before mastering the powerful general inequalities that bound character sums, it is essential to build intuition from the ground up. This exercise involves the direct computation of character sums for several small moduli, solidifying the abstract definitions and providing a tangible sense of the \"square-root cancellation\" phenomenon. By completing the calculations in [@problem_id:3009715], you can gain a first-hand appreciation for the scale and sharpness of these famous estimates.", "id": "3009715", "problem": "Let $q$ be a positive integer with $2 \\leq q \\leq 8$. A Dirichlet character modulo $q$ is a function $\\chi : \\mathbb{Z} \\to \\mathbb{C}$ that is completely multiplicative, is periodic with period $q$, and satisfies $\\chi(n) = 0$ if $\\gcd(n,q) > 1$, while its restriction to the group of units modulo $q$, denoted $(\\mathbb{Z}/q\\mathbb{Z})^{\\times}$, is a group homomorphism into the complex unit circle. The principal character $\\chi_{0}$ modulo $q$ is the character defined by $\\chi_{0}(n) = 1$ for $\\gcd(n,q) = 1$ and $\\chi_{0}(n) = 0$ otherwise. For a given character $\\chi$ modulo $q$, define the partial sum\n$$\nS_{\\chi}(x) \\;=\\; \\sum_{n \\leq x} \\chi(n).\n$$\nIn this problem, restrict attention to nonprincipal characters modulo $q$. Starting only from these definitions and standard properties of finite abelian groups, do the following:\n- Establish that for any nonprincipal Dirichlet character modulo $q$, the sum over one complete period satisfies $\\sum_{n=1}^{q} \\chi(n) = 0$, and deduce that the supremum over real $x \\geq 0$ of $|S_{\\chi}(x)|$ is attained by a partial sum inside a single period of length $q$.\n- For each modulus $q \\in \\{3,4,5,6,7,8\\}$, enumerate all nonprincipal characters modulo $q$ and compute, for each such $\\chi$, the exact sequence $\\{\\chi(1), \\chi(2), \\dots, \\chi(q)\\}$ and all partial sums $\\sum_{n=1}^{t} \\chi(n)$ for $t \\in \\{0,1,\\dots,q\\}$. From these, determine the exact value of $\\sup_{x \\geq 0} |S_{\\chi}(x)|$ for each $\\chi$.\n- Define the extremal quantity\n$$\nM \\;=\\; \\max_{\\substack{q \\in \\{3,4,5,6,7,8\\} \\\\ \\chi \\bmod q \\text{ nonprincipal}}} \\;\\sup_{x \\geq 0} |S_{\\chi}(x)|.\n$$\nCompute the exact value of $M$.\n- Briefly compare the computed values with widely used general bounds for character sums that are known from analytic number theory (for example, the Pólya–Vinogradov inequality), and comment on whether the small-modulus computations suggest sharpness of the general order of magnitude.\n\nProvide the final result as the exact value of $M$ with no rounding.", "solution": "The posed problem is a well-defined exercise in elementary analytic number theory. It is scientifically sound, self-contained, and all terms used are standard in the field. The problem is valid and can be solved as stated.\n\nThe first step is to establish the theoretical properties of the character sum $S_{\\chi}(x) = \\sum_{n \\leq x} \\chi(n)$ for a nonprincipal Dirichlet character $\\chi$ modulo $q$.\n\nFirst, we prove that the sum of a nonprincipal character $\\chi$ over a complete period is zero. Let $S = \\sum_{n=1}^{q} \\chi(n)$. Since $\\chi$ is a nonprincipal character, there exists an integer $a$ such that $\\gcd(a, q) = 1$ and $\\chi(a) \\neq 1$. We multiply the sum $S$ by $\\chi(a)$:\n$$\n\\chi(a) S = \\chi(a) \\sum_{n=1}^{q} \\chi(n) = \\sum_{n=1}^{q} \\chi(a)\\chi(n)\n$$\nBy complete multiplicativity, $\\chi(a)\\chi(n) = \\chi(an)$. Thus,\n$$\n\\chi(a) S = \\sum_{n=1}^{q} \\chi(an)\n$$\nAs $n$ runs through a complete set of residues modulo $q$, and since $\\gcd(a,q)=1$, the product $an$ also runs through a complete set of residues modulo $q$. Therefore, the sum on the right-hand side is simply a rearrangement of the terms in the original sum $S$.\n$$\n\\sum_{n=1}^{q} \\chi(an) = \\sum_{m=1}^{q} \\chi(m) = S\n$$\nThis leads to the equation $\\chi(a) S = S$, or $(\\chi(a) - 1)S = 0$. Since we chose $a$ such that $\\chi(a) \\neq 1$, the factor $(\\chi(a) - 1)$ is non-zero. Consequently, we must have $S = 0$. So, $\\sum_{n=1}^{q} \\chi(n) = 0$.\n\nNext, we use this result to bound the partial sums $S_{\\chi}(x)$. Let $x$ be any non-negative real number, and let $N = \\lfloor x \\rfloor$ be the integer part of $x$. Then $S_{\\chi}(x) = S_{\\chi}(N) = \\sum_{n=1}^{N} \\chi(n)$. We can write $N$ as $N = kq + t$, where $k = \\lfloor N/q \\rfloor$ is a non-negative integer and $t \\in \\{0, 1, \\dots, q-1\\}$. The sum can be split as:\n$$\nS_{\\chi}(N) = \\sum_{n=1}^{kq+t} \\chi(n) = \\left( \\sum_{j=0}^{k-1} \\sum_{m=1}^{q} \\chi(jq+m) \\right) + \\sum_{m=1}^{t} \\chi(kq+m)\n$$\nBy the $q$-periodicity of $\\chi$, we have $\\chi(jq+m) = \\chi(m)$. Applying this, the sum becomes:\n$$\nS_{\\chi}(N) = \\sum_{j=0}^{k-1} \\left( \\sum_{m=1}^{q} \\chi(m) \\right) + \\sum_{m=1}^{t} \\chi(m)\n$$\nSince $\\sum_{m=1}^{q} \\chi(m) = 0$, the first term vanishes:\n$$\nS_{\\chi}(N) = k \\cdot 0 + \\sum_{m=1}^{t} \\chi(m) = \\sum_{m=1}^{t} \\chi(m) = S_{\\chi}(t)\n$$\nThis shows that the value of any partial sum $S_{\\chi}(x)$ is equal to a partial sum $S_{\\chi}(t)$ where $t = \\lfloor x \\rfloor \\pmod q$. The set of all possible values of $S_{\\chi}(x)$ is therefore $\\{S_{\\chi}(0), S_{\\chi}(1), \\dots, S_{\\chi}(q-1)\\}$. We also note $S_{\\chi}(0)=0$ and $S_{\\chi}(q)=0$. Therefore, the supremum of the absolute value of the sum is given by the maximum over the first period:\n$$\n\\sup_{x \\geq 0} |S_{\\chi}(x)| = \\max_{0 \\leq t < q} \\left| \\sum_{n=1}^{t} \\chi(n) \\right|\n$$\n\nNow we perform the explicit computations for each modulus $q \\in \\{3,4,5,6,7,8\\}$.\n\nFor $q=3$: The group $(\\mathbb{Z}/3\\mathbb{Z})^{\\times} = \\{1, 2\\}$ is cyclic of order $2$. There is one nonprincipal character $\\chi$, determined by $\\chi(2)=-1$.\nThe values are $\\{\\chi(1), \\chi(2), \\chi(3)\\} = \\{1, -1, 0\\}$.\nThe partial sums $S_{\\chi}(t) = \\sum_{n=1}^t \\chi(n)$ for $t \\in \\{0,1,2,3\\}$ are:\n$S_{\\chi}(0)=0$, $S_{\\chi}(1)=1$, $S_{\\chi}(2)=1-1=0$, $S_{\\chi}(3)=0$.\nThe maximum absolute value is $\\sup_{x \\geq 0} |S_{\\chi}(x)| = 1$.\n\nFor $q=4$: The group $(\\mathbb{Z}/4\\mathbb{Z})^{\\times} = \\{1, 3\\}$ is cyclic of order $2$. There is one nonprincipal character $\\chi$, determined by $\\chi(3)=-1$.\nThe values are $\\{\\chi(1), \\chi(2), \\chi(3), \\chi(4)\\} = \\{1, 0, -1, 0\\}$.\nThe partial sums for $t \\in \\{0,1,2,3,4\\}$ are:\n$S_{\\chi}(0)=0$, $S_{\\chi}(1)=1$, $S_{\\chi}(2)=1+0=1$, $S_{\\chi}(3)=1+0-1=0$, $S_{\\chi}(4)=0$.\nThe maximum absolute value is $\\sup_{x \\geq 0} |S_{\\chi}(x)| = 1$.\n\nFor $q=5$: The group $(\\mathbb{Z}/5\\mathbb{Z})^{\\times} = \\{1, 2, 3, 4\\}$ is cyclic of order $4$, with generator $2$. The characters are determined by $\\chi(2) = \\omega$, where $\\omega^4=1$. The nonprincipal characters correspond to $\\omega \\in \\{i, -1, -i\\}$.\nCase 1: $\\chi_1(2)=i$. The values are $\\{\\chi_1(1), \\dots, \\chi_1(5)\\} = \\{1, i, -i, -1, 0\\}$.\nThe partial sums are: $S_{\\chi_1}(0)=0$, $S_{\\chi_1}(1)=1$, $S_{\\chi_1}(2)=1+i$, $S_{\\chi_1}(3)=1+i-i=1$, $S_{\\chi_1}(4)=1-1=0$, $S_{\\chi_1}(5)=0$.\nThe absolute values are $\\{0, 1, |1+i|=\\sqrt{2}, 1, 0, 0\\}$. The maximum is $\\sqrt{2}$. For $\\chi_3 = \\overline{\\chi_1}$ (with $\\chi_3(2)=-i$), the absolute values of the sums are identical, so the maximum is also $\\sqrt{2}$.\nCase 2: $\\chi_2(2)=-1$. The values are $\\{1, -1, -1, 1, 0\\}$.\nThe partial sums are: $S_{\\chi_2}(0)=0$, $S_{\\chi_2}(1)=1$, $S_{\\chi_2}(2)=1-1=0$, $S_{\\chi_2}(3)=0-1=-1$, $S_{\\chi_2}(4)=-1+1=0$, $S_{\\chi_2}(5)=0$.\nThe absolute values are $\\{0, 1, 0, 1, 0, 0\\}$. The maximum is $1$.\nThe maximum over all nonprincipal characters modulo $5$ is $\\sqrt{2}$.\n\nFor $q=6$: The group $(\\mathbb{Z}/6\\mathbb{Z})^{\\times} = \\{1, 5\\}$ is cyclic of order $2$. There is one nonprincipal character $\\chi$, determined by $\\chi(5)=-1$.\nThe values are $\\{\\chi(1), \\dots, \\chi(6)\\} = \\{1, 0, 0, 0, -1, 0\\}$.\nThe partial sums are: $S_{\\chi}(0)=0$, $S_{\\chi}(1)=1$, $S_{\\chi}(2)=1$, $S_{\\chi}(3)=1$, $S_{\\chi}(4)=1$, $S_{\\chi}(5)=1-1=0$, $S_{\\chi}(6)=0$.\nThe maximum absolute value is $1$.\n\nFor $q=7$: The group $(\\mathbb{Z}/7\\mathbb{Z})^{\\times}$ is cyclic of order $6$, with generator $3$. Characters are determined by $\\chi(3)=\\omega$ where $\\omega^6=1$. There are $5$ nonprincipal characters. Let $\\omega_6 = e^{i\\pi/3}$. We check the cases $\\omega = \\omega_6^k$ for $k=1,2,3$. Characters for $k=4,5$ are conjugates of $k=2,1$ and yield the same maximums.\nThe indices base $3$ are: $\\text{ind}_3(1)=0$, $\\text{ind}_3(2)=2$, $\\text{ind}_3(3)=1$, $\\text{ind}_3(4)=4$, $\\text{ind}_3(5)=5$, $\\text{ind}_3(6)=3$.\nCase 1: $\\chi_1(3)=\\omega_6 = e^{i\\pi/3}$. The values are $\\{\\chi_1(n)\\}_{n=1}^7 = \\{1, \\omega_6^2, \\omega_6, \\omega_6^4, \\omega_6^5, \\omega_6^3, 0\\}$.\nThe partial sums are: $S_{\\chi_1}(0)=0, S_{\\chi_1}(1)=1, S_{\\chi_1}(2)=1+\\omega_6^2=\\omega_6, S_{\\chi_1}(3)=\\omega_6+\\omega_6=2\\omega_6, S_{\\chi_1}(4)=2\\omega_6+\\omega_6^4=\\omega_6, S_{\\chi_1}(5)=\\omega_6+\\omega_6^5=1, S_{\\chi_1}(6)=1+\\omega_6^3=0, S_{\\chi_1}(7)=0$.\nThe absolute values are $\\{0, 1, |\\omega_6|=1, |2\\omega_6|=2, |\\omega_6|=1, 1, 0, 0\\}$. The maximum is $2$.\nCase 2: $\\chi_2(3)=\\omega_6^2 = e^{i2\\pi/3}$. The values are $\\{1, \\omega_6^4, \\omega_6^2, \\omega_6^8=\\omega_6^2, \\omega_6^{10}=\\omega_6^4, \\omega_6^6=1, 0\\}$.\nThe partial sums give a maximum absolute value of $1$.\nCase 3: $\\chi_3(3)=\\omega_6^3 = -1$. This is the Legendre symbol $(\\frac{n}{7})$. The values are $\\{1, 1, -1, 1, -1, -1, 0\\}$.\nThe partial sums are: $S_{\\chi_3}(0)=0, S_{\\chi_3}(1)=1, S_{\\chi_3}(2)=2, S_{\\chi_3}(3)=1, S_{\\chi_3}(4)=2, S_{\\chi_3}(5)=1, S_{\\chi_3}(6)=0, S_{\\chi_3}(7)=0$.\nThe maximum absolute value is $2$.\nThe maximum over all nonprincipal characters modulo $7$ is $2$.\n\nFor $q=8$: The group $(\\mathbb{Z}/8\\mathbb{Z})^{\\times} = \\{1, 3, 5, 7\\}$ is a Klein four-group ($C_2 \\times C_2$). Characters are determined by their values on generators $3$ and $5$, say $\\chi(3)=\\epsilon_1, \\chi(5)=\\epsilon_2$ where $\\epsilon_1, \\epsilon_2 \\in \\{1, -1\\}$. This gives $3$ nonprincipal characters.\nCase 1: $\\chi_1(3)=-1, \\chi_1(5)=1$. The values are $\\{\\chi_1(n)\\}_{n=1}^8 = \\{1, 0, -1, 0, 1, 0, -1, 0\\}$.\nThe partial sums are $\\{0, 1, 1, 0, 0, 1, 1, 0, 0\\}$. The maximum absolute value is $1$.\nCase 2: $\\chi_2(3)=1, \\chi_2(5)=-1$. The values are $\\{1, 0, 1, 0, -1, 0, -1, 0\\}$.\nThe partial sums are $\\{0, 1, 1, 2, 2, 1, 1, 0, 0\\}$. The maximum absolute value is $2$.\nCase 3: $\\chi_3(3)=-1, \\chi_3(5)=-1$. The values are $\\{1, 0, -1, 0, -1, 0, 1, 0\\}$.\nThe partial sums are $\\{0, 1, 1, 0, 0, -1, -1, 0, 0\\}$. The maximum absolute value is $1$.\nThe maximum over all nonprincipal characters modulo $8$ is $2$.\n\nSummary of maximums:\nFor $q=3$: max $|S|=1$.\nFor $q=4$: max $|S|=1$.\nFor $q=5$: max $|S|=\\sqrt{2}$.\nFor $q=6$: max $|S|=1$.\nFor $q=7$: max $|S|=2$.\nFor $q=8$: max $|S|=2$.\n\nThe extremal quantity $M$ is the maximum of these values:\n$$\nM = \\max\\{1, 1, \\sqrt{2}, 1, 2, 2\\} = 2\n$$\n\nFinally, we compare these results with general bounds such as the Pólya–Vinogradov inequality, which states $|S_{\\chi}(x)| \\le C \\sqrt{q} \\log q$ for some constant $C$. For our values:\n- $q=3$: $2 > 1$.\n- $q=4$: $2 > 1$.\n- $q=5$: $\\sqrt{2} \\approx 1.414 < \\sqrt{5}\\log 5 \\approx 3.60$.\n- $q=7$: $2 < \\sqrt{7}\\log 7 \\approx 5.15$.\n- $q=8$: $2 < \\sqrt{8}\\log 8 \\approx 5.88$.\nThe bound holds in all cases. The phrase \"suggest sharpness\" concerns the order of magnitude. The computed maximums are $1, 1, \\sqrt{2}, 1, 2, 2$. The term $\\sqrt{q}$ grows as approximately $1.73, 2, 2.24, 2.45, 2.65, 2.83$. The observed values grow much more slowly than the $\\sqrt{q}\\log q$ bound. For instance, the ratio of the computed maximum to $\\sqrt{q}$ is $1/\\sqrt{3} \\approx 0.58$ for $q=3$, $\\sqrt{2}/\\sqrt{5} \\approx 0.63$ for $q=5$, $2/\\sqrt{7} \\approx 0.76$ for $q=7$, and $2/\\sqrt{8} \\approx 0.71$ for $q=8$. This ratio is not growing like $\\log q$.\nThese computations for small $q$ do not suggest that the order of magnitude $O(\\sqrt{q}\\log q)$ is sharp. In fact, they are more consistent with the conjectural bound of $O(\\sqrt{q} \\log \\log q)$ or even a simpler $O(\\sqrt{q})$ bound, as the logarithmic term does not appear to manifest for these small moduli. The $\\log q$ factor in the Pólya-Vinogradov inequality is widely believed to be an artifact of the proof methods, and not representative of the true maximal size of character sums.", "answer": "$$\n\\boxed{2}\n$$"}, {"introduction": "When moving from prime to composite moduli, the theory of Dirichlet characters gains an important layer of complexity: the notion of primitivity. The exercise [@problem_id:3009656] guides you through the process of classifying characters for the composite modulus $q=9$ and identifying which are \"primitive\"—meaning they do not arise from a smaller modulus. This distinction is fundamental, as the deepest aspects of the theory, including connections to L-functions and the Generalized Riemann Hypothesis, are built upon primitive characters.", "id": "3009656", "problem": "Let $q=9$. A Dirichlet character modulo $q$ is a completely multiplicative function $\\chi:\\mathbb{Z}\\to\\mathbb{C}$ that is periodic with period $q$ and satisfies $\\chi(n)=0$ if and only if $\\gcd(n,q)\\neq 1$. Such a character is called primitive if its conductor equals $q$, equivalently, if it is not induced from any proper divisor of $q$.\n\nUsing only the definitions above and the standard structure of $(\\mathbb{Z}/q\\mathbb{Z})^{\\times}$, do the following for modulus $q=9$:\n1. Enumerate all Dirichlet characters modulo $9$ by explicitly specifying their values on the reduced residue system modulo $9$.\n2. Determine, from first principles, which among these characters are primitive by analyzing whether they factor through reduction modulo $3$.\n3. For each primitive character $\\chi$ modulo $9$, define the partial sums $S_{\\chi}(N)=\\sum_{n=1}^{N}\\chi(n)$ and compute $S_{\\chi}(N)$ for all $N$ with $1\\leq N\\leq 9$.\n4. Using periodicity and your computed values, identify the worst-case growth among primitive characters by evaluating\n$$\nM \\;=\\; \\max_{\\substack{\\chi\\ \\text{primitive mod}\\ 9}}\\ \\max_{1\\leq N\\leq 9}\\ \\bigl|S_{\\chi}(N)\\bigr|.\n$$\n\nGive your final answer as the exact value of $M$. Do not approximate or round.", "solution": "The user wants to solve a multi-part problem concerning Dirichlet characters modulo $q=9$. The solution will proceed by addressing each of the four parts in sequence.\n\n### Part 1: Enumerate all Dirichlet characters modulo 9\n\nA Dirichlet character modulo $q$ is a character of the group of units $(\\mathbb{Z}/q\\mathbb{Z})^{\\times}$. For $q=9$, this group is $(\\mathbb{Z}/9\\mathbb{Z})^{\\times}$, which consists of integers coprime to $9$. The elements are $\\{1, 2, 4, 5, 7, 8\\}$. The order of this group is given by Euler's totient function, $\\phi(9) = 9(1 - \\frac{1}{3}) = 6$.\n\nTo determine the structure of this group, we find a generator. Let's examine the powers of $2$ modulo $9$:\n$2^1 \\equiv 2 \\pmod{9}$\n$2^2 \\equiv 4 \\pmod{9}$\n$2^3 \\equiv 8 \\pmod{9}$\n$2^4 \\equiv 16 \\equiv 7 \\pmod{9}$\n$2^5 \\equiv 14 \\equiv 5 \\pmod{9}$\n$2^6 \\equiv 10 \\equiv 1 \\pmod{9}$\nSince the powers of $2$ generate all $6$ elements, the group $(\\mathbb{Z}/9\\mathbb{Z})^{\\times}$ is cyclic of order $6$, with generator $g=2$.\n\nThe characters of a cyclic group of order $6$ are determined by their value on the generator, which must be a $6$-th root of unity. Let $\\omega = \\exp(\\frac{2\\pi i}{6}) = \\exp(\\frac{\\pi i}{3}) = \\frac{1}{2} + i\\frac{\\sqrt{3}}{2}$. There are $6$ characters, which we denote by $\\chi_k$ for $k \\in \\{0, 1, 2, 3, 4, 5\\}$, defined by their action on the generator: $\\chi_k(2) = \\omega^k$.\nFor any $n \\in (\\mathbb{Z}/9\\mathbb{Z})^{\\times}$, we can write $n \\equiv 2^j \\pmod{9}$ for a unique $j \\in \\{0, 1, 2, 3, 4, 5\\}$. Then, by complete multiplicativity, $\\chi_k(n) = \\chi_k(2^j) = (\\chi_k(2))^j = \\omega^{kj}$.\nThe values for all characters on the reduced residue system are presented in the following table. For any integer $n$ not coprime to $9$ (i.e., $n \\in \\{3, 6, 9\\}$ within the first period), $\\chi_k(n) = 0$ for all $k$.\n\n| $n$ ($=2^j \\pmod 9$) | $\\chi_0$ ($k=0$) | $\\chi_1$ ($k=1$) | $\\chi_2$ ($k=2$) | $\\chi_3$ ($k=3$) | $\\chi_4$ ($k=4$) | $\\chi_5$ ($k=5$) |\n|---|---|---|---|---|---|---|\n| $1$ ($j=0$) | $1$ | $1$ | $1$ | $1$ | $1$ | $1$ |\n| $2$ ($j=1$) | $1$ | $\\omega$ | $\\omega^2$ | $\\omega^3=-1$ | $\\omega^4$ | $\\omega^5$ |\n| $4$ ($j=2$) | $1$ | $\\omega^2$ | $\\omega^4$ | $\\omega^6=1$ | $\\omega^8=\\omega^2$ | $\\omega^{10}=\\omega^4$ |\n| $5$ ($j=5$) | $1$ | $\\omega^5$ | $\\omega^{10}=\\omega^4$ | $\\omega^{15}=-1$| $\\omega^{20}=\\omega^2$ | $\\omega^{25}=\\omega$ |\n| $7$ ($j=4$) | $1$ | $\\omega^4$ | $\\omega^8=\\omega^2$ | $\\omega^{12}=1$ | $\\omega^{16}=\\omega^4$ | $\\omega^{20}=\\omega^2$ |\n| $8$ ($j=3$) | $1$ | $\\omega^3=-1$ | $\\omega^6=1$ | $\\omega^9=-1$ | $\\omega^{12}=1$ | $\\omega^{15}=-1$ |\n\n### Part 2: Determine which characters are primitive\n\nA character $\\chi$ modulo $q$ is primitive if its conductor is $q$. It is imprimitive if it is induced from a character modulo a proper divisor $d$ of $q$. For $q=9$, the proper divisors are $d=1$ and $d=3$.\nA character $\\chi$ is induced from modulus $d$ if its value $\\chi(n)$ for $\\gcd(n,q)=1$ depends only on the residue class of $n$ modulo $d$. This is equivalent to checking if $\\chi(a)=1$ for all integers $a$ satisfying $a \\equiv 1 \\pmod d$ and $\\gcd(a,q)=1$.\n\nFor $d=1$: The condition is $a \\equiv 1 \\pmod 1$, which is always true. We check if $\\chi(a)=1$ for all $a$ with $\\gcd(a,9)=1$. This is only true for the principal character $\\chi_0$. Thus, $\\chi_0$ is imprimitive (its conductor is $1$).\n\nFor $d=3$: We check if a character $\\chi$ has $\\chi(a)=1$ for all $a$ satisfying $a \\equiv 1 \\pmod 3$ and $\\gcd(a,9)=1$. The integers $a \\in (\\mathbb{Z}/9\\mathbb{Z})^{\\times}$ such that $a \\equiv 1 \\pmod 3$ are $a=4$ and $a=7$. A character $\\chi_k$ is imprimitive if $\\chi_k(4)=1$ and $\\chi_k(7)=1$.\nFrom the table, $\\chi_k(4) = \\omega^{2k}$ and $\\chi_k(7) = \\omega^{4k}$.\n- $\\chi_k(4)=1 \\implies \\omega^{2k}=1 \\implies 2k$ is a multiple of $6 \\implies k$ is a multiple of $3$. So $k=0$ or $k=3$.\n- $\\chi_k(7)=1 \\implies \\omega^{4k}=1 \\implies 4k$ is a multiple of $6 \\implies 2k$ is a multiple of $3 \\implies k$ is a multiple of $3$. So $k=0$ or $k=3$.\nBoth conditions are met for $k=0$ and $k=3$. Thus, $\\chi_0$ and $\\chi_3$ are imprimitive. $\\chi_3$ is induced by the non-principal character modulo $3$, and its conductor is $3$.\n\nThe remaining characters, $\\chi_1, \\chi_2, \\chi_4, \\chi_5$, are not induced from any proper divisor and are therefore primitive.\n\n### Part 3: Compute partial sums $S_{\\chi}(N)$ for primitive characters\n\nWe need to compute $S_{\\chi}(N)=\\sum_{n=1}^{N}\\chi(n)$ for primitive characters $\\chi$ and $1\\leq N\\leq 9$. The primitive characters are $\\chi_1, \\chi_2, \\chi_4, \\chi_5$.\nNote that $\\chi_5 = \\overline{\\chi_1}$ and $\\chi_4 = \\overline{\\chi_2}$. This implies $|S_{\\chi_5}(N)|=|S_{\\chi_1}(N)|$ and $|S_{\\chi_4}(N)|=|S_{\\chi_2}(N)|$. We only need to perform the calculations for $\\chi_1$ and $\\chi_2$.\n\n**Calculations for $\\chi_1$**:\nThe values $\\chi_1(n)$ for $n=1, ..., 9$ are: $1, \\omega, 0, \\omega^2, \\omega^5, 0, \\omega^4, -1, 0$.\n- $S_{\\chi_1}(1) = 1$\n- $S_{\\chi_1}(2) = 1 + \\omega = \\frac{3}{2} + i\\frac{\\sqrt{3}}{2}$\n- $S_{\\chi_1}(3) = S_{\\chi_1}(2) = \\frac{3}{2} + i\\frac{\\sqrt{3}}{2}$\n- $S_{\\chi_1}(4) = (1+\\omega) + \\omega^2 = 1+\\omega+\\omega^2 = 1+i\\sqrt{3}$\n- $S_{\\chi_1}(5) = (1+\\omega+\\omega^2) + \\omega^5 = (1+i\\sqrt{3}) + (\\frac{1}{2}-i\\frac{\\sqrt{3}}{2}) = \\frac{3}{2}+i\\frac{\\sqrt{3}}{2}$\n- $S_{\\chi_1}(6) = S_{\\chi_1}(5)$\n- $S_{\\chi_1}(7) = (\\frac{3}{2}+i\\frac{\\sqrt{3}}{2}) + \\omega^4 = (\\frac{3}{2}+i\\frac{\\sqrt{3}}{2}) + (-\\frac{1}{2}-i\\frac{\\sqrt{3}}{2}) = 1$\n- $S_{\\chi_1}(8) = 1 + \\chi_1(8) = 1 - 1 = 0$\n- $S_{\\chi_1}(9) = 0 + \\chi_1(9) = 0$\n\nThe moduli $|S_{\\chi_1}(N)|$ are:\n- $|S_{\\chi_1}(1)| = 1$\n- $|S_{\\chi_1}(2)| = \\sqrt{(\\frac{3}{2})^2 + (\\frac{\\sqrt{3}}{2})^2} = \\sqrt{\\frac{9}{4}+\\frac{3}{4}} = \\sqrt{3}$\n- $|S_{\\chi_1}(4)| = \\sqrt{1^2 + (\\sqrt{3})^2} = \\sqrt{4} = 2$\n- $|S_{\\chi_1}(5)| = \\sqrt{3}$\n- $|S_{\\chi_1}(7)| = 1$\n- The other values are either repetitions or $0$. The maximum value is $2$.\n\n**Calculations for $\\chi_2$**:\nThe values $\\chi_2(n)$ for $n=1, ..., 9$ are: $1, \\omega^2, 0, \\omega^4, \\omega^4, 0, \\omega^2, 1, 0$.\n- $S_{\\chi_2}(1) = 1$\n- $S_{\\chi_2}(2) = 1 + \\omega^2 = \\frac{1}{2} + i\\frac{\\sqrt{3}}{2}$\n- $S_{\\chi_2}(3) = S_{\\chi_2}(2)$\n- $S_{\\chi_2}(4) = (1+\\omega^2) + \\omega^4 = 0$\n- $S_{\\chi_2}(5) = 0 + \\omega^4 = -\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}$\n- $S_{\\chi_2}(6) = S_{\\chi_2}(5)$\n- $S_{\\chi_2}(7) = \\omega^4 + \\omega^2 = -1$\n- $S_{\\chi_2}(8) = -1 + 1 = 0$\n- $S_{\\chi_2}(9) = 0$\n\nThe moduli $|S_{\\chi_2}(N)|$ are:\n- $|S_{\\chi_2}(1)| = 1$\n- $|S_{\\chi_2}(2)| = \\sqrt{(\\frac{1}{2})^2 + (\\frac{\\sqrt{3}}{2})^2} = \\sqrt{\\frac{1}{4}+\\frac{3}{4}} = 1$\n- $|S_{\\chi_2}(4)| = 0$\n- $|S_{\\chi_2}(5)| = 1$\n- $|S_{\\chi_2}(7)| = 1$\nThe other values are repetitions or $0$. The maximum value is $1$.\n\n### Part 4: Evaluate M\n\nThe problem defines $M = \\max_{\\chi\\ \\text{primitive mod}\\ 9}\\ \\max_{1\\leq N\\leq 9}\\ \\bigl|S_{\\chi}(N)\\bigr|$. We need to find the maximum of the values computed in Part 3 over all primitive characters.\n- $\\max_{1\\leq N\\leq 9} |S_{\\chi_1}(N)| = 2$\n- $\\max_{1\\leq N\\leq 9} |S_{\\chi_2}(N)| = 1$\n- $\\max_{1\\leq N\\leq 9} |S_{\\chi_4}(N)| = \\max_{1\\leq N\\leq 9} |S_{\\chi_2}(N)| = 1$\n- $\\max_{1\\leq N\\leq 9} |S_{\\chi_5}(N)| = \\max_{1\\leq N\\leq 9} |S_{\\chi_1}(N)| = 2$\n\nThe maximum over all primitive characters is $M = \\max\\{2, 1, 1, 2\\} = 2$.", "answer": "$$\n\\boxed{2}\n$$"}, {"introduction": "The celebrated Pólya-Vinogradov inequality guarantees significant cancellation in character sums over intervals of consecutive integers. But does similar cancellation occur for sums over other structured sets? This exercise [@problem_id:3009661] explores this boundary by constructing a sum over a multiplicative progression, revealing a surprising lack of cancellation and leading to a sum much larger than the Pólya-Vinogradov bound would suggest, thereby clarifying the precise context in which the inequality applies.", "id": "3009661", "problem": "Let $q$ be an odd prime and let $G = (\\mathbb{Z}/q\\mathbb{Z})^{\\times}$ denote the multiplicative group modulo $q$, which is cyclic of order $q-1$. Fix a generator $g$ of $G$. Define a Dirichlet character $\\chi$ modulo $q$ by specifying its value on $g$ as $\\chi(g) = \\exp\\!\\big(2\\pi i/(q-1)\\big)$ and extending multiplicatively on $G$, with $\\chi(0)=0$. This $\\chi$ is primitive and has exact order $q-1$. For an integer $K$ with $1 \\leq K \\leq \\left\\lfloor \\frac{q-1}{2} \\right\\rfloor$, consider the multiplicative progression $n_{k} \\equiv g^{k} \\pmod{q}$ for $1 \\leq k \\leq K$ and the associated partial sum\n$$\nS_{K} \\;=\\; \\sum_{k=1}^{K} \\chi(n_{k}).\n$$\nStarting only from the definitions of Dirichlet characters and the cyclic structure of $G$, derive an exact closed-form expression for the real-valued magnitude $|S_{K}|$ in terms of $q$ and $K$, using only foundational facts such as the sum of a finite geometric series and basic trigonometric identities. Explain briefly why the chosen progression exhibits phase clustering of $\\chi(n_{k})$ and why the resulting size of $|S_{K}|$ does not contradict upper bounds for character sums over consecutive integers, such as the Pólya–Vinogradov inequality. Your final answer should be the exact closed-form expression for $|S_{K}|$ as a function of $q$ and $K$. No rounding is required.", "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in the principles of number theory, well-posed with sufficient and consistent information, and objectively formulated.\n\nThe problem asks for an exact closed-form expression for the magnitude of the partial character sum $S_K = \\sum_{k=1}^{K} \\chi(n_k)$, where $n_k \\equiv g^k \\pmod{q}$.\n\nFirst, we express the terms of the sum using the definition of the Dirichlet character $\\chi$. The character $\\chi$ is defined on the generator $g$ of $G = (\\mathbb{Z}/q\\mathbb{Z})^{\\times}$ as $\\chi(g) = \\exp(2\\pi i / (q-1))$. Since $\\chi$ is a multiplicative homomorphism, its value on an element $n_k = g^k$ is given by:\n$$\n\\chi(n_k) = \\chi(g^k) = (\\chi(g))^k\n$$\nLet us denote the complex number $r = \\chi(g) = \\exp(2\\pi i / (q-1))$. The sum $S_K$ can now be written as:\n$$\nS_K = \\sum_{k=1}^{K} r^k\n$$\nThis is a finite geometric series with first term $r$, common ratio $r$, and $K$ terms. Since $q$ is an odd prime, $q \\ge 3$, which implies $q-1 \\ge 2$. Therefore, the common ratio $r = \\exp(2\\pi i / (q-1))$ is a root of unity but is not equal to $1$. The sum of this geometric series is given by the standard formula:\n$$\nS_K = r \\frac{1 - r^K}{1 - r}\n$$\nWe are asked to find the real-valued magnitude $|S_K|$. Using the properties of the modulus of complex numbers, we have:\n$$\n|S_K| = \\left| r \\frac{1 - r^K}{1 - r} \\right| = |r| \\frac{|1 - r^K|}{|1 - r|}\n$$\nThe modulus of $r$ is $|r| = |\\exp(2\\pi i / (q-1))| = 1$. Thus, the expression for the magnitude simplifies to:\n$$\n|S_K| = \\frac{|1 - r^K|}{|1 - r|}\n$$\nTo evaluate this, we use the identity for the magnitude of a difference of two complex numbers on the unit circle. For any real $\\theta$, a useful identity is $|1 - e^{i\\theta}| = 2|\\sin(\\theta/2)|$. This can be derived as follows:\n$$\n|1 - e^{i\\theta}| = |e^{i\\theta/2}(e^{-i\\theta/2} - e^{i\\theta/2})| = |e^{i\\theta/2}| \\cdot | -2i \\sin(\\theta/2) | = (1) \\cdot |-2i| \\cdot |\\sin(\\theta/2)| = 2|\\sin(\\theta/2)|\n$$\nWe apply this identity to the numerator and the denominator of our expression for $|S_K|$.\n\nFor the denominator $|1-r|$, we have $r = \\exp(2\\pi i / (q-1))$, so $\\theta = \\frac{2\\pi}{q-1}$.\n$$\n|1 - r| = 2\\left|\\sin\\left(\\frac{1}{2} \\cdot \\frac{2\\pi}{q-1}\\right)\\right| = 2\\left|\\sin\\left(\\frac{\\pi}{q-1}\\right)\\right|\n$$\nSince $q \\ge 3$, we have $q-1 \\ge 2$, so $0 < \\frac{\\pi}{q-1} \\le \\frac{\\pi}{2}$. In this interval, the sine function is positive. Therefore, the absolute value is not needed:\n$$\n|1 - r| = 2\\sin\\left(\\frac{\\pi}{q-1}\\right)\n$$\nFor the numerator $|1-r^K|$, we have $r^K = (\\exp(2\\pi i / (q-1)))^K = \\exp(2\\pi i K / (q-1))$. Here, $\\theta = \\frac{2\\pi K}{q-1}$.\n$$\n|1 - r^K| = 2\\left|\\sin\\left(\\frac{1}{2} \\cdot \\frac{2\\pi K}{q-1}\\right)\\right| = 2\\left|\\sin\\left(\\frac{\\pi K}{q-1}\\right)\\right|\n$$\nThe problem specifies that $1 \\le K \\le \\lfloor \\frac{q-1}{2} \\rfloor$. This implies $0 < \\frac{\\pi K}{q-1} \\le \\frac{\\pi}{q-1} \\lfloor \\frac{q-1}{2} \\rfloor \\le \\frac{\\pi}{q-1} \\frac{q-1}{2} = \\frac{\\pi}{2}$. In the interval $(0, \\pi/2]$, the sine function is also positive. So, we can remove the absolute value here as well:\n$$\n|1 - r^K| = 2\\sin\\left(\\frac{\\pi K}{q-1}\\right)\n$$\nSubstituting these results back into the expression for $|S_K|$ yields the final closed-form expression:\n$$\n|S_K| = \\frac{2\\sin\\left(\\frac{\\pi K}{q-1}\\right)}{2\\sin\\left(\\frac{\\pi}{q-1}\\right)} = \\frac{\\sin\\left(\\frac{\\pi K}{q-1}\\right)}{\\sin\\left(\\frac{\\pi}{q-1}\\right)}\n$$\nThis expression gives the exact magnitude of the sum $S_K$ as a function of $q$ and $K$.\n\nNext, we explain the conceptual aspects requested.\n\nThe reason this progression exhibits \"phase clustering\" is that the terms being summed, $\\chi(n_k) = \\exp(2\\pi i k / (q-1))$ for $k=1, 2, \\dots, K$, are not randomly distributed on the unit circle in the complex plane. Their arguments (phases) form a short arithmetic progression: $\\frac{2\\pi}{q-1}, \\frac{4\\pi}{q-1}, \\dots, \\frac{2\\pi K}{q-1}$. Given the constraint $1 \\le K \\le \\lfloor \\frac{q-1}{2} \\rfloor$, all these arguments lie in the interval $(0, \\pi]$. This means all the complex numbers $\\chi(n_k)$ lie in the upper half-plane (including the point $-1$ if $K=(q-1)/2$). When these vectors are added, their imaginary parts are all non-negative, and their real parts vary over a limited range. This leads to constructive interference, preventing the large-scale cancellation that would occur if the phases were pseudo-randomly distributed around the full circle. The sum is therefore exceptionally large.\n\nThis result does not contradict the Pólya–Vinogradov inequality. The Pólya–Vinogradov inequality provides an upper bound of the form $|\\sum_{n=M+1}^{M+N} \\chi(n)| \\ll \\sqrt{q} \\ln q$ for any non-principal character $\\chi$ modulo $q$. The crucial difference is the set over which the sum is taken. The Pólya–Vinogradov inequality applies to sums over consecutive integers (an arithmetic progression of differences $1$), which form an interval. In contrast, the sum $S_K$ is over a multiplicative progression $\\{g^1, g^2, \\dots, g^K\\} \\pmod{q}$. This is a very sparse and structured subset of residues modulo $q$. For large $q$, the magnitude of $S_K$ can be of order $O(q)$. For instance, if $K$ is close to $(q-1)/4$, then $|S_K| \\approx \\sin(\\pi/4)/\\sin(\\pi/(q-1)) \\approx \\frac{1}{\\sqrt{2}} / (\\pi/(q-1)) = \\frac{q-1}{\\pi\\sqrt{2}}$, which is linear in $q$. This is much larger than the $\\sqrt{q}\\ln q$ bound. The Pólya–Vinogradov inequality does not apply to this type of structured sum, so there is no contradiction. The large value of $|S_K|$ is a classic example demonstrating that character sums over specific structured sets can behave very differently from sums over intervals.", "answer": "$$\\boxed{\\frac{\\sin\\left(\\frac{\\pi K}{q-1}\\right)}{\\sin\\left(\\frac{\\pi}{q-1}\\right)}}$$"}]}