{"hands_on_practices": [{"introduction": "To fully understand a modular curve, we must first grasp its underlying topological space, including the \"points at infinity\" known as cusps, which are essential for its compactification. This practice [@problem_id:3018127] guides you through the fundamental process of classifying and counting the cusps of the modular curve $X_0(N)$. By working through the relationship between the congruence subgroup $\\Gamma_0(N)$ and the rational projective line $\\mathbb{P}^1(\\mathbb{Q})$, you will develop a concrete computational command of these essential geometric features and their properties, such as their widths.", "problem": "Let $N$ be a positive integer and let $\\Gamma_{0}(N)$ denote the congruence subgroup of the Special Linear group of degree two over the integers ($\\mathrm{SL}_2(\\mathbb{Z})$) consisting of all matrices $\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$ with $c \\equiv 0 \\pmod{N}$. The modular curve $X_{0}(N)$ has cusps corresponding to the set of $\\Gamma_{0}(N)$-orbits in the rational projective line $\\mathbb{P}^{1}(\\mathbb{Q})$ under the usual fractional linear action. The width of a cusp $\\kappa$ is defined as the minimal positive integer $w$ such that, after conjugating by any matrix $\\sigma \\in \\mathrm{SL}_2(\\mathbb{Z})$ with $\\sigma \\cdot \\infty = \\kappa$, the translation matrix $T^{w} = \\begin{pmatrix} 1 & w \\\\ 0 & 1 \\end{pmatrix}$ lies in $\\sigma^{-1} \\Gamma_{0}(N) \\sigma$.\n\nStarting from the fundamental definitions above and the interpretation of cusps as elements of the double coset space $\\Gamma_{0}(N) \\backslash \\mathbb{P}^{1}(\\mathbb{Q})$, derive a classification of the cusps of $X_{0}(N)$ and a formula for their widths. Then, for the specific level $N = 60$, compute the total number of cusps and the multiset of their widths. Express the final answer as a single row matrix whose first entry is the total number of cusps and whose remaining entries are the widths of all cusps written in nondecreasing order. Provide exact integers; no rounding is required.", "solution": "The problem asks for a derivation of the classification and widths of cusps for the modular curve $X_{0}(N)$, followed by a specific calculation for the case $N = 60$.\n\n### Part 1: General Theory of Cusps for $\\Gamma_0(N)$\n\n**1. Classification of Cusps**\n\nThe cusps of the modular curve $X_{0}(N)$ are the equivalence classes of the rational projective line $\\mathbb{P}^{1}(\\mathbb{Q}) = \\mathbb{Q} \\cup \\{\\infty\\}$ under the action of the congruence subgroup $\\Gamma_{0}(N)$. The action is by fractional linear transformations.\n\nAny element of $\\mathbb{P}^{1}(\\mathbb{Q})$ can be written as a fraction $\\frac{a}{c}$ in lowest terms, i.e., with $\\gcd(a,c)=1$. The point at infinity, $\\infty$, is identified with $\\frac{1}{0}$.\n\nLet $\\kappa_{1} = \\frac{a_{1}}{c_{1}}$ and $\\kappa_{2} = \\frac{a_{2}}{c_{2}}$ be two cusps, with $\\gcd(a_{1},c_{1})=1$ and $\\gcd(a_{2},c_{2})=1$. They are $\\Gamma_{0}(N)$-equivalent if there exists a matrix $\\gamma = \\begin{pmatrix} \\alpha & \\beta \\\\ \\delta_N & \\epsilon \\end{pmatrix} \\in \\Gamma_{0}(N)$ such that $\\gamma(\\kappa_{1}) = \\kappa_{2}$. The condition for being in $\\Gamma_{0}(N)$ is $\\delta_N \\equiv 0 \\pmod{N}$.\n\nThe action gives:\n$$ \\frac{a_{2}}{c_{2}} = \\frac{\\alpha a_{1} + \\beta c_{1}}{\\delta_N a_{1} + \\epsilon c_{1}} $$\nSince the fraction $\\frac{a_{2}}{c_{2}}$ is in lowest terms, the denominator $c_{2}$ must be a divisor of $\\delta_N a_{1} + \\epsilon c_{1}$. Thus, up to a sign, we can write $c_{2} = \\delta_N a_{1} + \\epsilon c_{1}$.\n\nLet's analyze the quantity $\\gcd(c, N)$ for a cusp representative $\\frac{a}{c}$. For two equivalent cusps, we have:\n$$ \\gcd(c_{2}, N) = \\gcd(\\delta_N a_{1} + \\epsilon c_{1}, N) = \\gcd(\\epsilon c_{1}, N) $$\nSince $\\alpha\\epsilon - \\beta\\delta_N = 1$, we have $\\gcd(\\epsilon, \\delta_N)=1$, which implies $\\gcd(\\epsilon, N) = 1$. Therefore:\n$$ \\gcd(c_{2}, N) = \\gcd(c_{1}, N) $$\nThis shows that $d = \\gcd(c, N)$ is an invariant of the $\\Gamma_{0}(N)$-orbit of any cusp $\\frac{a}{c}$. This means that cusps with different values of $\\gcd(c,N)$ belong to distinct equivalence classes.\n\nThe standard classification, which can be derived from this observation, states that the cusps of $X_{0}(N)$ are in one-to-one correspondence with pairs $(d, u)$ where $d$ is a positive divisor of $N$, and $u$ is an integer defined modulo $\\gcd(d, N/d)$ such that $\\gcd(u,d)=1$. A representative fraction for such a cusp is $\\frac{u}{d}$.\n\nFor each positive divisor $d$ of $N$, the number of distinct cusps associated with it is given by the number of choices for $u$. The number of integers $u$ such that $1 \\le u \\le \\gcd(d, N/d)$ and $\\gcd(u, \\gcd(d,N/d))=1$ (which implies $\\gcd(u,d)=1$) is $\\phi(\\gcd(d, N/d))$, where $\\phi$ is Euler's totient function.\n\nThe total number of cusps for $X_{0}(N)$ is the sum over all positive divisors of $N$:\n$$ \\text{Number of cusps} = \\sum_{d|N, d>0} \\phi(\\gcd(d, N/d)) $$\n\n**2. Width of Cusps**\n\nThe width $w$ of a cusp $\\kappa$ is the minimal positive integer such that the translation matrix $T^{w} = \\begin{pmatrix} 1 & w \\\\ 0 & 1 \\end{pmatrix}$ lies in the group $\\sigma^{-1} \\Gamma_{0}(N) \\sigma$, where $\\sigma \\in \\mathrm{SL}_2(\\mathbb{Z})$ is any matrix that maps $\\infty$ to $\\kappa$. This is equivalent to finding the smallest $w>0$ such that $\\sigma T^w \\sigma^{-1} \\in \\Gamma_0(N)$.\n\nLet the cusp be represented by $\\kappa = \\frac{a}{c}$ with $\\gcd(a,c)=1$. We can choose a matrix $\\sigma \\in \\mathrm{SL}_2(\\mathbb{Z})$ such that $\\sigma(\\infty) = \\frac{a}{c}$. By the property of $\\mathrm{SL}_2(\\mathbb{Z})$, there exist integers $b, d'$ such that $ad' - bc = 1$. So we can take $\\sigma = \\begin{pmatrix} a & b \\\\ c & d' \\end{pmatrix}$. Note that the bottom-left entry of $\\sigma$ is $c$.\n\nLet's compute the matrix product $\\sigma T^w \\sigma^{-1}$:\n$$ \\sigma T^w \\sigma^{-1} = \\begin{pmatrix} a & b \\\\ c & d' \\end{pmatrix} \\begin{pmatrix} 1 & w \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} d' & -b \\\\ -c & a \\end{pmatrix} $$\n$$ = \\begin{pmatrix} a & aw+b \\\\ c & cw+d' \\end{pmatrix} \\begin{pmatrix} d' & -b \\\\ -c & a \\end{pmatrix} = \\begin{pmatrix} a d' - c(aw+b) & -ab + a(aw+b) \\\\ c d' - c(cw+d') & -cb + a(cw+d') \\end{pmatrix} $$\nUsing $ad' - bc = 1$:\n$$ = \\begin{pmatrix} (ad'-bc) - acw & a^2 w \\\\ -c^2 w & (ad'-bc) + acw \\end{pmatrix} = \\begin{pmatrix} 1 - acw & a^2 w \\\\ -c^2 w & 1 + acw \\end{pmatrix} $$\nFor this matrix to be in $\\Gamma_{0}(N)$, its bottom-left entry must be congruent to $0 \\pmod{N}$.\n$$ -c^2 w \\equiv 0 \\pmod{N} \\quad \\text{or} \\quad c^2 w \\equiv 0 \\pmod{N} $$\nWe seek the smallest positive integer $w$ satisfying this congruence. This is given by:\n$$ w = \\frac{\\operatorname{lcm}(c^2, N)}{c^2} = \\frac{c^2 N}{c^2 \\gcd(c^2, N)} = \\frac{N}{\\gcd(c^2, N)} $$\nThis formula gives the width of the cusp represented by $\\frac{a}{c}$. As shown earlier, $\\gcd(c^2,N)$ is an invariant of the $\\Gamma_0(N)$-orbit, so the width is well-defined.\nFor a cusp class corresponding to a divisor $d$ of $N$, we can use the representative $\\frac{1}{d}$ (since $\\gcd(1,d)=1$). In this case, $c=d$, and the width is:\n$$ w_d = \\frac{N}{\\gcd(d^2, N)} $$\n\n### Part 2: Application to $N = 60$\n\nWe apply the derived formulas to the specific case $N = 60 = 2^2 \\cdot 3 \\cdot 5$.\n\nThe positive divisors of $60$ are $1, 2, 3, 4, 5, 6, 10, 12, 15, 20, 30, 60$. There are $12$ divisors in total. For each divisor $d$, we will compute the number of associated cusps, $\\phi(\\gcd(d, 60/d))$, and their common width, $w_d = 60/\\gcd(d^2, 60)$.\n\n- $d=1$:\n  - Number of cusps: $\\phi(\\gcd(1, 60)) = \\phi(1) = 1$.\n  - Width: $w_1 = 60/\\gcd(1^2, 60) = 60/1 = 60$.\n- $d=2$:\n  - Number of cusps: $\\phi(\\gcd(2, 30)) = \\phi(2) = 1$.\n  - Width: $w_2 = 60/\\gcd(2^2, 60) = 60/\\gcd(4, 60) = 60/4 = 15$.\n- $d=3$:\n  - Number of cusps: $\\phi(\\gcd(3, 20)) = \\phi(1) = 1$.\n  - Width: $w_3 = 60/\\gcd(3^2, 60) = 60/\\gcd(9, 60) = 60/3 = 20$.\n- $d=4$:\n  - Number of cusps: $\\phi(\\gcd(4, 15)) = \\phi(1) = 1$.\n  - Width: $w_4 = 60/\\gcd(4^2, 60) = 60/\\gcd(16, 60) = 60/4 = 15$.\n- $d=5$:\n  - Number of cusps: $\\phi(\\gcd(5, 12)) = \\phi(1) = 1$.\n  - Width: $w_5 = 60/\\gcd(5^2, 60) = 60/\\gcd(25, 60) = 60/5 = 12$.\n- $d=6$:\n  - Number of cusps: $\\phi(\\gcd(6, 10)) = \\phi(2) = 1$.\n  - Width: $w_6 = 60/\\gcd(6^2, 60) = 60/\\gcd(36, 60) = 60/12 = 5$.\n- $d=10$:\n  - Number of cusps: $\\phi(\\gcd(10, 6)) = \\phi(2) = 1$.\n  - Width: $w_{10} = 60/\\gcd(10^2, 60) = 60/\\gcd(100, 60) = 60/20 = 3$.\n- $d=12$:\n  - Number of cusps: $\\phi(\\gcd(12, 5)) = \\phi(1) = 1$.\n  - Width: $w_{12} = 60/\\gcd(12^2, 60) = 60/\\gcd(144, 60) = 60/12 = 5$.\n- $d=15$:\n  - Number of cusps: $\\phi(\\gcd(15, 4)) = \\phi(1) = 1$.\n  - Width: $w_{15} = 60/\\gcd(15^2, 60) = 60/\\gcd(225, 60) = 60/15 = 4$.\n- $d=20$:\n  - Number of cusps: $\\phi(\\gcd(20, 3)) = \\phi(1) = 1$.\n  - Width: $w_{20} = 60/\\gcd(20^2, 60) = 60/\\gcd(400, 60) = 60/20 = 3$.\n- $d=30$:\n  - Number of cusps: $\\phi(\\gcd(30, 2)) = \\phi(2) = 1$.\n  - Width: $w_{30} = 60/\\gcd(30^2, 60) = 60/\\gcd(900, 60) = 60/60 = 1$.\n- $d=60$:\n  - Number of cusps: $\\phi(\\gcd(60, 1)) = \\phi(1) = 1$.\n  - Width: $w_{60} = 60/\\gcd(60^2, 60) = 60/60 = 1$.\n\n**Summary for N=60:**\n\nThe total number of cusps is the sum of the number of cusps for each divisor class: $1 \\times 12 = 12$.\n\nThe multiset of widths is obtained by collecting all the calculated widths:\n$\\{60, 15, 20, 15, 12, 5, 3, 5, 4, 3, 1, 1\\}$.\n\nArranging these widths in nondecreasing order, we get:\n$\\{1, 1, 3, 3, 4, 5, 5, 12, 15, 15, 20, 60\\}$.\n\nThe final answer is a row matrix whose first entry is the total number of cusps ($12$), and the remaining entries are the sorted widths.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n12 & 1 & 1 & 3 & 3 & 4 & 5 & 5 & 12 & 15 & 15 & 20 & 60\n\\end{pmatrix}\n}\n$$", "id": "3018127"}, {"introduction": "Having explored the static geometry of modular curves, we now turn to the dynamic correspondences that act upon them: the Hecke operators. This exercise [@problem_id:3018113] illuminates the geometric nature of the Hecke correspondence $T_p$ by viewing it as a relationship between elliptic curves connected by isogenies of degree $p$. By calculating the degrees of the natural projection maps from first principles, you will uncover why the integer $p+1$ plays such a pivotal role in the theory of modular forms and their associated arithmetic structures.", "problem": "Let $N \\geq 1$ be an integer and let $p$ be a prime with $p \\nmid N$. Consider the complex modular curve $X_{0}(N)$, viewed as the coarse moduli space parameterizing isomorphism classes of pairs $(E,C)$, where $E$ is an elliptic curve over $\\mathbb{C}$ and $C \\subset E$ is a cyclic subgroup of order $N$. Define the Hecke correspondence $T_{p}$ on $X_{0}(N)$ by the moduli problem that assigns to a point $(E,C)$ the set of isogenies $\\phi \\colon E \\to E'$ of degree $p$ such that $\\phi(C)$ is a cyclic subgroup of $E'$ of order $N$. Equivalently, $T_{p}$ can be described as the set of triples $(E,C,G)$, where $G \\subset E$ is a cyclic subgroup of order $p$, together with the induced pair $(E/G,(C+G)/G)$ on the quotient elliptic curve $E/G$, noting that $p \\nmid N$ ensures $C \\cap G = \\{0\\}$ and that the image $(C+G)/G$ in $E/G$ is cyclic of order $N$. The correspondence $T_{p}$ comes equipped with two finite morphisms (the projection maps)\n- $p_{1} \\colon T_{p} \\to X_{0}(N)$ sending $(E,C,G)$ to $(E,C)$, and\n- $p_{2} \\colon T_{p} \\to X_{0}(N)$ sending $(E,C,G)$ to $(E/G,(C+G)/G)$.\n\nStarting from the modular interpretation of $X_{0}(N)$ and the Hecke correspondence $T_{p}$, and using only foundational facts such as the structure of the $p$-torsion subgroup $E[p]$ of an elliptic curve and the existence of dual isogenies, derive from first principles a computation of the degrees of the finite maps $p_{1}$ and $p_{2}$ when $p \\nmid N$, and justify why these degrees coincide. Express your final answer as a single exact symbolic expression in terms of $p$; no rounding is required.", "solution": "The problem asks for the computation of the degrees of the two projection maps, $p_{1}$ and $p_{2}$, associated with the Hecke correspondence $T_{p}$ on the modular curve $X_{0}(N)$, for a prime $p$ not dividing $N$. We are to derive this from first principles and justify why the degrees coincide.\n\nLet $f: X \\to Y$ be a finite surjective morphism of algebraic curves over $\\mathbb{C}$. The degree of $f$, denoted $\\deg(f)$, is the number of points in the fiber $f^{-1}(y)$ for a generic point $y \\in Y$. The maps $p_{1}$ and $p_{2}$ are finite morphisms, so we can compute their degrees by counting the elements in a generic fiber.\n\nFirst, we compute the degree of $p_{1} \\colon T_{p} \\to X_{0}(N)$. The map $p_{1}$ is defined by sending the isomorphism class of a triple $(E,C,G)$ to the isomorphism class of the pair $(E,C)$. To find the degree of $p_{1}$, we must determine the size of the fiber $p_{1}^{-1}(x)$ for a generic point $x \\in X_{0}(N)$.\n\nLet $x = [(E,C)]$ be the isomorphism class of a pair where $E$ is an elliptic curve over $\\mathbb{C}$ and $C$ is a cyclic subgroup of order $N$. A point in the fiber $p_{1}^{-1}(x)$ is an isomorphism class of a triple $(E',C',G')$ such that $[(E',C')] = x$. We can choose a representative $(E,C)$ for the class $x$. The fiber then consists of isomorphism classes of triples of the form $(E,C,G)$, where $G$ is a cyclic subgroup of $E$ of order $p$. For a generic elliptic curve $E$, its automorphism group is just $\\{\\pm 1\\}$, and these automorphisms preserve any subgroup $G$. Thus, counting the number of non-isomorphic triples essentially reduces to counting the number of distinct subgroups $G$.\n\nThe task is therefore to count the number of distinct cyclic subgroups of order $p$ in the elliptic curve $E$. These subgroups are generated by elements of order $p$. The set of points of order dividing $p$ on $E$ is the $p$-torsion subgroup, denoted $E[p]$. For an elliptic curve over the complex numbers $\\mathbb{C}$ (or any field of characteristic not $p$), the $p$-torsion subgroup is an abelian group isomorphic to $(\\mathbb{Z}/p\\mathbb{Z}) \\times (\\mathbb{Z}/p\\mathbb{Z})$.\n$$E[p] \\cong (\\mathbb{Z}/p\\mathbb{Z})^{2}$$\nThis group has $p^{2}$ elements. It can be viewed as a two-dimensional vector space over the finite field $\\mathbb{F}_{p}$. A cyclic subgroup of order $p$ is a one-dimensional subspace of this vector space.\n\nThe number of non-zero vectors in $E[p]$ is $p^{2}-1$. Each one-dimensional subspace is generated by any of its non-zero vectors. Since a one-dimensional subspace over $\\mathbb{F}_{p}$ contains $p$ elements, it has $p-1$ non-zero elements (generators). Therefore, the number of distinct cyclic subgroups of order $p$ is the number of non-zero elements divided by the number of generators per subgroup:\n$$ \\text{Number of subgroups } G = \\frac{p^{2}-1}{p-1} = p+1 $$\nFor a generic point $[(E,C)]$, there are exactly $p+1$ distinct cyclic subgroups $G_i$ of order $p$ in $E$, leading to $p+1$ distinct points $[(E,C,G_i)]$ in the fiber of $p_1$. Thus, the degree of $p_{1}$ is $p+1$.\n$$ \\deg(p_{1}) = p+1 $$\n\nNext, we compute the degree of $p_{2} \\colon T_{p} \\to X_{0}(N)$. The map $p_{2}$ is defined by sending the isomorphism class of a triple $(E,C,G)$ to the isomorphism class of the pair $(E/G, (C+G)/G)$. To find the degree of $p_{2}$, we determine the size of the fiber $p_{2}^{-1}(y)$ for a generic point $y \\in X_{0}(N)$.\n\nLet $y = [(E',C')]$ be the isomorphism class of a pair where $E'$ is an elliptic curve and $C'$ is a cyclic subgroup of order $N$. A point in the fiber $p_{2}^{-1}(y)$ corresponds to an isomorphism class of a triple $(E,C,G)$ such that $[(E/G, (C+G)/G)] = y$. This means there is an isomorphism of pairs $i: (E/G, (C+G)/G) \\to (E', C')$.\nLet $\\pi:E \\to E/G$ be the canonical projection isogeny, which has degree $p$. The composition $\\phi = i \\circ \\pi: E \\to E'$ is an isogeny of degree $p$. The condition $(C+G)/G$ maps to $C'$ means that $\\phi(C)=C'$.\nSo, a point in the fiber over $[(E',C')]$ corresponds to a pair $(E,C)$ and a degree-$p$ isogeny $\\phi:E \\to E'$ such that $\\phi(C)=C'$. The problem is to count how many such pairs $(E,C)$ (up to isomorphism) give rise to the same $(E',C')$.\n\nWe can use the theory of dual isogenies. For any isogeny $\\phi: E \\to E'$ of degree $p$, there exists a unique dual isogeny $\\hat{\\phi}: E' \\to E$ also of degree $p$. The existence of such a $\\phi$ is therefore equivalent to the existence of its dual $\\hat{\\phi}$. The isogeny $\\hat{\\phi}:E' \\to E$ is determined (up to composing with an automorphism of $E$) by its kernel, $\\ker(\\hat{\\phi})$, which must be a cyclic subgroup of $E'$ of order $p$. As established before, there are $p+1$ such subgroups in $E'$.\n\nLet us fix the generic pair $(E',C')$ and enumerate the points in the fiber of $p_2$ over $[(E',C')]$. Each point corresponds to a choice of a cyclic subgroup $K \\subset E'$ of order $p$.\n1.  For each of the $p+1$ cyclic subgroups $K \\subset E'$ of order $p$, let $\\psi_K: E' \\to E'/K$ be the quotient isogeny.\n2.  Define the elliptic curve $E_K := E'/K$. For generic $E'$, different choices of $K$ lead to non-isomorphic elliptic curves $E_K$.\n3.  Let $\\phi_K = \\hat{\\psi}_K: E_K \\to E'$ be the dual isogeny to $\\psi_K$. This is an isogeny of degree $p$.\n4.  The kernel of $\\phi_K$, let's call it $G_K$, is a cyclic subgroup of $E_K$ of order $p$. By construction, $(E_K)/G_K \\cong E'$.\n5.  We need to find a subgroup $C_K \\subset E_K$ such that $\\phi_K(C_K) = C'$. Since the degree of $\\phi_K$ is $p$ and $p \\nmid N$, the isogeny $\\phi_K$ acts as an isomorphism on subgroups of order $N$. Thus, there exists a unique cyclic subgroup $C_K \\subset E_K$ of order $N$ given by $C_K = \\phi_K^{-1}(C')$.\n6.  With these definitions, the triple $(E_K, C_K, G_K)$ maps under $p_2$ to $[(E_K/G_K, (C_K+G_K)/G_K)]$. The isogeny $\\phi_K$ provides the isomorphism $E_K/G_K \\cong E'$. Under this isomorphism, the subgroup $(C_K+G_K)/G_K \\cong \\phi_K(C_K)$ is mapped to $C'$. Thus, we have constructed a point in the fiber of $p_2$.\n\nThis construction establishes a one-to-one correspondence between the cyclic subgroups $K$ of order $p$ in $E'$ and the points in the fiber of $p_2$ over $[(E',C')]$. Since there are $p+1$ such subgroups, the size of the fiber is $p+1$.\n$$ \\deg(p_{2}) = p+1 $$\n\nThe degrees of the finite maps $p_1$ and $p_2$ coincide because their computation, from first principles, reduces to the same combinatorial problem: counting the number of cyclic subgroups of order $p$ within an elliptic curve. The degree of $p_1$ is the number of such subgroups in the source curve $E$. The degree of $p_2$, through the lens of dual isogenies, is the number of such subgroups in the target curve $E'$. In both cases, the structure of the $p$-torsion group $E[p] \\cong (\\mathbb{Z}/p\\mathbb{Z})^2$ dictates that this number is $p+1$.\n\nThe degrees are equal: $\\deg(p_1) = \\deg(p_2) = p+1$. The final answer is this value.", "answer": "$$\\boxed{p+1}$$", "id": "3018113"}, {"introduction": "The true power of modular curves and Hecke correspondences lies in their ability to forge connections between seemingly disparate areas of mathematics. This advanced practice [@problem_id:3018138] demonstrates this synthesis by exploring the structure of the Jacobian variety $J_0(N)$, showing how the Hecke algebra dissects it into fundamental building blocks: the abelian varieties $A_f$ associated with newforms. By applying foundational theorems to determine the endomorphism algebra of $A_f$, you will directly engage with the mechanisms that link analytic modular forms to the rich arithmetic of abelian varieties, a cornerstone of modern number theory.", "problem": "Let $N$ be a positive integer and let $f$ be a normalized weight $2$ newform on $X_0(N)$ with trivial nebentypus. Suppose the Fourier coefficients of $f$ generate the real quadratic Hecke field $K=\\mathbb{Q}(\\sqrt{5})$. Assume that $f$ has no Complex Multiplication (CM) and no nontrivial inner twists. Let $J_0(N)$ denote the Jacobian of the modular curve $X_0(N)$ and let $\\mathbb{T}$ denote the full Hecke algebra acting on $J_0(N)$. Let $A_f$ be the $f$-isotypic abelian subvariety of $J_0(N)$ associated to $f$ via the Eichler–Shimura construction.\n\nStarting from fundamental facts about the Hecke action on $J_0(N)$, the Eichler–Shimura construction, multiplicity one for Hecke eigenforms, and the classification of endomorphism algebras of simple abelian varieties up to isogeny, perform the following:\n\n- Derive the isogeny decomposition structure of $A_f$ over $\\mathbb{Q}$, i.e., determine whether $A_f$ is $\\mathbb{Q}$-simple or isogenous to a power $B^m$ of a lower-dimensional simple abelian variety $B$.\n- Determine the $\\mathbb{Q}$-algebra $\\mathrm{End}^0(A_f)=\\mathrm{End}_{\\mathbb{Q}}(A_f)\\otimes_{\\mathbb{Z}}\\mathbb{Q}$.\n\nConclude by computing the dimension $\\dim_{\\mathbb{Q}}\\mathrm{End}^0(A_f)$. Give your final answer as a single integer. No rounding is required.", "solution": "The user wants me to solve a problem in number theory, specifically related to modular forms and abelian varieties.\n\nHere's my plan:\n1.  **Validate the problem statement.** I need to check if the problem is well-posed, scientifically grounded, and fits all the criteria.\n    *   **Step 1: Extract Givens.** I will list all the definitions and assumptions provided in the problem.\n    *   **Step 2: Validate.** I will check for any flaws. The problem seems to be a standard setup in the theory of modular forms and Shimura varieties. It's highly technical but appears to be self-contained and consistent. The concepts are all standard in algebraic number theory and arithmetic geometry.\n        *   $N$: a positive integer.\n        *   $f$: a normalized weight $2$ newform on $X_0(N)$.\n        *   Nebentypus of $f$: trivial.\n        *   $a_n(f)$: Fourier coefficients of $f$.\n        *   $K_f = \\mathbb{Q}(\\{a_n(f)\\})$: the Hecke field of $f$. It is given that $K_f = K = \\mathbb{Q}(\\sqrt{5})$, which is a real quadratic field.\n        *   CM: $f$ does not have Complex Multiplication.\n        *   Inner twists: $f$ has no nontrivial inner twists.\n        *   $J_0(N)$: Jacobian of the modular curve $X_0(N)$.\n        *   $\\mathbb{T}$: full Hecke algebra acting on $J_0(N)$.\n        *   $A_f$: the $f$-isotypic abelian subvariety of $J_0(N)$ associated to $f$.\n    *   **Validation Check:**\n        *   **Scientifically Grounded:** Yes, these are all standard objects and concepts in the Langlands program, specifically the theory of modular forms.\n        *   **Well-Posed:** Yes, the question asks for the isogeny structure of $A_f$ and the endomorphism algebra $\\mathrm{End}^0(A_f)$. These are well-defined mathematical objects. The assumptions (no CM, no inner twists, specific Hecke field) are crucial and standard.\n        *   **Objective:** Yes, the language is precise and mathematical.\n        *   **Completeness:** The problem provides enough information to determine the structure of $A_f$ and its endomorphism algebra based on established theorems.\n        *   **No other flaws detected.** The problem is a standard, albeit advanced, exercise in the field.\n\n2.  **Solve the problem.** If the problem is valid, I will proceed with the solution.\n    *   **Step 1: Understand $A_f$.**\n        *   The Hecke algebra $\\mathbb{T}$ acts on $J_0(N)$.\n        *   The newform $f$ is an eigenform for all Hecke operators $T_n$ with $(n, N)=1$ and the Atkin-Lehner involutions $w_d$ for $d|N$.\n        *   The eigenvalues are the Fourier coefficients $a_n(f)$.\n        *   This gives a ring homomorphism $\\phi_f: \\mathbb{T} \\to \\mathbb{C}$ defined by $T_n \\mapsto a_n(f)$.\n        *   By the work of Shimura, the field generated by the eigenvalues, $K_f = \\mathbb{Q}(\\{a_n(f)\\}_{n\\ge 1})$, is a finite extension of $\\mathbb{Q}$. Here, we are given $K_f = \\mathbb{Q}(\\sqrt{5})$.\n        *   The abelian variety $A_f$ is defined as the image of $J_0(N)$ under the projector associated with the Galois orbit of $f$. Let $S_2(\\Gamma_0(N))$ be the space of cusp forms of weight $2$. A newform $f$ gives rise to a homomorphism $\\theta_f: \\mathbb{T} \\to \\mathbb{C}$ sending $T_n$ to $a_n(f)$. The Hecke field is $K_f = \\mathbb{Q}(a_n(f) : n \\in \\mathbb{N})$. The Galois conjugates of $f$, say $f_1, \\dots, f_d$ where $d = [K_f:\\mathbb{Q}]$, correspond to the Galois conjugates of the homomorphism $\\theta_f$.\n        *   The algebra $\\mathbb{T}_f = \\mathbb{T} / \\mathrm{Ann}_{\\mathbb{T}}(A_f)$ acts on $A_f$. By Shimura, $\\mathbb{T}_f \\otimes_{\\mathbb{Z}} \\mathbb{Q}$ is isomorphic to the Hecke field $K_f$. So, $K_f$ acts on $A_f$.\n        *   The dimension of the abelian variety $A_f$ is given by the degree of the Hecke field, $[K_f : \\mathbb{Q}]$. In this case, $K_f = \\mathbb{Q}(\\sqrt{5})$, so $\\dim(A_f) = [ \\mathbb{Q}(\\sqrt{5}) : \\mathbb{Q} ] = 2$.\n\n    *   **Step 2: Decompose $A_f$ over $\\mathbb{Q}$.**\n        *   The question is whether $A_f$ is a simple abelian variety over $\\mathbb{Q}$ or if it is isogenous to a product of simpler ones.\n        *   $A_f$ is an abelian variety of \"GL2-type\" with real multiplication by $K_f$.\n        *   The endomorphism algebra $\\mathrm{End}^0(A_f) = \\mathrm{End}_{\\mathbb{Q}}(A_f) \\otimes_{\\mathbb{Z}} \\mathbb{Q}$ contains $K_f$ as a subalgebra.\n        *   The center of $\\mathrm{End}^0(A_f)$ is a field, let's call it $Z$.\n        *   The structure of $A_f$ depends on whether it has \"extra\" endomorphisms beyond those coming from the Hecke algebra.\n        *   Ribet's Theorem (1980s) on endomorphisms of modular abelian varieties is the key here. It relates the endomorphism algebra of $A_f$ to inner twists.\n        *   An \"inner twist\" of $f$ is a newform $g$ such that for some character $\\chi$, the Fourier coefficients satisfy $a_p(g) = \\chi(p) a_p(f)$ for all primes $p$ not dividing the level of $f$ and the conductor of $\\chi$. A nontrivial inner twist is one where $\\chi$ is not the trivial character.\n        *   The condition \"no nontrivial inner twists\" is crucial.\n        *   Ribet proved that $\\mathrm{End}^0(A_f)$ is precisely the Hecke field $K_f$ if and only if $f$ has no nontrivial inner twists.\n        *   So, under the given assumptions, we have $\\mathrm{End}^0(A_f) = K_f = \\mathbb{Q}(\\sqrt{5})$.\n\n    *   **Step 3: Analyze simplicity of $A_f$.**\n        *   We have $\\mathrm{End}^0(A_f) = \\mathbb{Q}(\\sqrt{5})$, which is a field.\n        *   The endomorphism algebra of a simple abelian variety over a field $k$ is a division algebra.\n        *   Conversely, if the endomorphism algebra $\\mathrm{End}^0_k(A)$ of an abelian variety $A$ over $k$ is a field, is $A$ simple over $k$?\n        *   Let's check. Suppose $A$ is not simple over $k=\\mathbb{Q}$. Then $A$ is isogenous over $\\mathbb{Q}$ to a product $B_1 \\times \\dots \\times B_r$ of simple abelian varieties $B_i$ over $\\mathbb{Q}$.\n        *   Then $\\mathrm{End}^0(A) \\cong \\bigoplus_{i,j} \\mathrm{Hom}^0(B_i, B_j)$.\n        *   If the $B_i$ are not isogenous to each other, $\\mathrm{Hom}^0(B_i, B_j) = 0$ for $i \\neq j$, so $\\mathrm{End}^0(A) \\cong \\prod_i \\mathrm{End}^0(B_i)$. This is a product of algebras, which is not a field unless $r=1$.\n        *   If the $B_i$ are all isogenous to a single simple abelian variety $B$, so $A \\sim B^m$, then $\\mathrm{End}^0(A) \\cong M_m(\\mathrm{End}^0(B))$. This is a matrix algebra over the division algebra $D = \\mathrm{End}^0(B)$. This is a field if and only if $m=1$ and $D$ is a field.\n        *   So, since $\\mathrm{End}^0(A_f) = \\mathbb{Q}(\\sqrt{5})$ is a field, it must be that $A_f$ is isogenous over $\\mathbb{Q}$ to a single simple abelian variety $B$ (i.e., $m=1$), and its endomorphism algebra is $\\mathrm{End}^0(B) = \\mathbb{Q}(\\sqrt{5})$.\n        *   Therefore, $A_f$ is a simple abelian variety over $\\mathbb{Q}$.\n\n    *   **Step 4: Analyze CM (Complex Multiplication).**\n        *   The problem states that $f$ has no CM.\n        *   A newform $f$ has CM by an imaginary quadratic field $M$ if there is a nontrivial Hecke character $\\psi$ of $M$ such that $f$ is the base change lift of $\\psi$. In this case, the Hecke field $K_f$ is a subfield of the Hilbert class field of $M$.\n        *   The condition \"no CM\" is important for the structure of the endomorphism algebra over $\\overline{\\mathbb{Q}}$. Over $\\mathbb{Q}$, we've already used the \"no inner twists\" condition.\n        *   For an abelian variety $A$, CM means $\\mathrm{End}^0(A)$ is \"large\". Specifically, if $A$ has dimension $g$, it has CM if its endomorphism algebra contains a field of degree $2g$ over $\\mathbb{Q}$.\n        *   Here, $\\dim(A_f) = 2$. If $A_f$ had CM, $\\mathrm{End}_{\\overline{\\mathbb{Q}}}^0(A_f)$ would contain a field of degree $2 \\times 2 = 4$ over $\\mathbb{Q}$.\n        *   Ribet's theorem says $\\mathrm{End}_{\\mathbb{Q}}^0(A_f) = K_f$ when there are no inner twists. Let's think about $\\mathrm{End}_{\\overline{\\mathbb{Q}}}^0(A_f)$.\n        *   If $f$ has CM by an imaginary quadratic field $M$, then $\\mathrm{End}_{\\mathbb{Q}}^0(A_f)$ is a compositum of $K_f$ and $M$. But this is only if $K_f$ is not a cyclotomic field. Our $K_f = \\mathbb{Q}(\\sqrt{5})$ is the maximal real subfield of $\\mathbb{Q}(\\zeta_5)$.\n        *   The condition of no CM for $f$ implies that $A_f$ does not have CM in the usual sense. This means that $\\mathrm{End}^0(A_f)$ is not \"too large\".\n        *   Let's check the classification of endomorphism algebras of simple abelian varieties. Let $A$ be a simple abelian variety of dimension $g$ over a number field $k$. Let $D = \\mathrm{End}_k^0(A)$. $D$ is a finite-dimensional division algebra over $\\mathbb{Q}$. Let $K$ be the center of $D$. $K$ is a number field. Let $e = [K:\\mathbb{Q}]$ and $d^2 = [D:K]$. Then Albert's classification applies. A key invariant is $2g/[D:\\mathbb{Q}] = 2g/(ed^2)$.\n        *   In our case, $A = A_f$, $k = \\mathbb{Q}$, $g = \\dim(A_f) = [K_f:\\mathbb{Q}] = 2$.\n        *   We found $\\mathrm{End}^0(A_f) = K_f = \\mathbb{Q}(\\sqrt{5})$.\n        *   So $D = \\mathbb{Q}(\\sqrt{5})$. This is a field, so it is its own center. $K = Z(D) = \\mathbb{Q}(\\sqrt{5})$.\n        *   This means $e = [K:\\mathbb{Q}] = [\\mathbb{Q}(\\sqrt{5}):\\mathbb{Q}] = 2$.\n        *   Since $D=K$ is a field, it is a division algebra of dimension $1$ over itself. So $d^2=1$, which means $d=1$.\n        *   The classification of endomorphism algebras of abelian varieties (by Albert, extended by Shimura) involves looking at the type of the positive involution on $D$ induced by the Rosati involution.\n        *   Since $K_f = \\mathbb{Q}(\\sqrt{5})$ is a totally real field, the Rosati involution on $D=K_f$ must be the identity. This corresponds to Albert's Type I.\n        *   For Type I, $D$ is a totally real field or a totally indefinite quaternion algebra over a totally real field. Here $D=K_f$ is a totally real field.\n        *   The relevant constraint is $e | g$. Here $e = [\\mathbb{Q}(\\sqrt{5}):\\mathbb{Q}]=2$ and $g = \\dim(A_f) = 2$. This condition $2|2$ is satisfied.\n\n    *   **Summary of derivation:**\n        1.  **Dimension of $A_f$**: The dimension of the abelian variety $A_f$ associated with a newform $f$ is the degree of its Hecke field over $\\mathbb{Q}$.\n            $\\dim(A_f) = [K_f : \\mathbb{Q}] = [\\mathbb{Q}(\\sqrt{5}) : \\mathbb{Q}] = 2$.\n        2.  **Endomorphism Algebra $\\mathrm{End}^0(A_f)$**: A fundamental result of Ribet states that for a newform $f$ without complex multiplication, the $\\mathbb{Q}$-endomorphism algebra $\\mathrm{End}^0(A_f)$ is a quaternion algebra over a certain subfield of $K_f$. It is exactly $K_f$ if and only if $f$ has no nontrivial inner twists.\n            The problem states that $f$ has no nontrivial inner twists.\n            Therefore, $\\mathrm{End}^0(A_f) = K_f = \\mathbb{Q}(\\sqrt{5})$.\n        3.  **Isogeny decomposition of $A_f$**: An abelian variety $A$ is simple over a field $k$ if and only if its endomorphism algebra $\\mathrm{End}^0_k(A)$ is a division algebra. If $A \\sim B^m$ for a simple $B$, then $\\mathrm{End}^0_k(A) \\cong M_m(\\mathrm{End}^0_k(B))$.\n            We found $\\mathrm{End}^0(A_f) = \\mathbb{Q}(\\sqrt{5})$, which is a field. A field is a division algebra.\n            For $\\mathrm{End}^0(A_f)$ to be a field, we must have $m=1$ and $\\mathrm{End}^0(B)$ must be a field.\n            Thus, $A_f$ is a simple abelian variety over $\\mathbb{Q}$. It is not isogenous to a power of a lower-dimensional variety. (The only lower dimensional simple abelian varieties over $\\mathbb{Q}$ are elliptic curves, dimension 1).\n        4.  **Dimension of the Endomorphism Algebra**: The problem asks for $\\dim_{\\mathbb{Q}}\\mathrm{End}^0(A_f)$.\n            Since $\\mathrm{End}^0(A_f) = \\mathbb{Q}(\\sqrt{5})$, we need to find the dimension of $\\mathbb{Q}(\\sqrt{5})$ as a vector space over $\\mathbb{Q}$.\n            The basis of $\\mathbb{Q}(\\sqrt{5})$ over $\\mathbb{Q}$ is $\\{1, \\sqrt{5}\\}$.\n            Therefore, $\\dim_{\\mathbb{Q}}(\\mathbb{Q}(\\sqrt{5})) = 2$.\n\n    *   **Double-check the reasoning.**\n        *   The argument primarily relies on Ribet's theorem on the endomorphisms of modular abelian varieties. The theorem states: Let $f \\in S_2(\\Gamma_1(N))$ be a newform without CM. Then $\\mathrm{End}_{\\mathbb{Q}}(A_f) \\otimes \\mathbb{Q}$ is the centralizer in $\\mathrm{End}_{\\mathbb{Q}}(J_1(N)) \\otimes \\mathbb{Q}$ of the Hecke field $K_f$. This endomorphism algebra is a central simple algebra over a subfield $F$ of $K_f$. The algebra is $K_f$ itself if and only if $f$ has no inner twists.\n        *   Our form $f$ is on $\\Gamma_0(N)$ with trivial nebentypus, so it's a special case of $\\Gamma_1(N)$.\n        *   We are given no CM and no nontrivial inner twists.\n        *   So the theorem applies directly: $\\mathrm{End}^0(A_f) = K_f = \\mathbb{Q}(\\sqrt{5})$.\n        *   The deduction about simplicity is correct: if $\\mathrm{End}^0(A)$ is a field, $A$ must be simple.\n        *   The dimension of the endomorphism algebra is then $\\dim_{\\mathbb{Q}}(K_f) = [K_f:\\mathbb{Q}]$.\n        *   The problem gives $K_f = \\mathbb{Q}(\\sqrt{5})$, so the dimension is $[\\mathbb{Q}(\\sqrt{5}):\\mathbb{Q}] = 2$.\n        *   The no-CM condition is also important. If $f$ had CM by an imaginary quadratic field $M$, then $A_f$ would acquire extra endomorphisms over a larger field, but over $\\mathbb{Q}$, the endomorphism algebra can be larger too. Specifically, if $f$ has CM by $M$, then $\\mathrm{End}^0(A_f)$ contains $K_f \\cdot M$, which is a field of degree $2[K_f:\\mathbb{Q}]$ over $\\mathbb{Q}$. This would change the answer. So the \"no CM\" condition is not redundant. For example, if we had CM, $\\mathrm{End}^0(A_f)$ would be a CM-field of degree 4. The problem is set up to apply Ribet's theorem in its most direct form.\n\nThe reasoning is solid, direct, and relies on foundational results that the problem statement implicitly invokes (\"Starting from fundamental facts...\"). The provided information is exactly tailored to lead to this conclusion. The problem is well-posed and not trivial, but standard for someone familiar with the area. I will now write the solution as requested.\n## VALIDATION OF THE PROBLEM STATEMENT\n\n### Step 1: Extract Givens\n- $N$ is a positive integer.\n- $f$ is a normalized weight $2$ newform on $X_0(N)$.\n- The nebentypus of $f$ is trivial.\n- The Fourier coefficients of $f$ generate the Hecke field $K_f = \\mathbb{Q}(\\sqrt{5})$.\n- $f$ has no Complex Multiplication (CM).\n- $f$ has no nontrivial inner twists.\n- $J_0(N)$ is the Jacobian of the modular curve $X_0(N)$.\n- $\\mathbb{T}$ is the full Hecke algebra acting on $J_0(N)$.\n- $A_f$ is the $f$-isotypic abelian subvariety of $J_0(N)$ associated to $f$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific or Factual Unsoundness**: The problem is based on established, core concepts in the theory of modular forms and abelian varieties, such as newforms, Hecke algebras, Jacobians of modular curves, and the Eichler-Shimura construction. The Hecke field $\\mathbb{Q}(\\sqrt{5})$ is a valid real quadratic field. All premises are factually sound within the context of modern number theory.\n2.  **Non-Formalizable or Irrelevant**: The problem is highly formal and directly related to the topic of modular curves and Hecke correspondences.\n3.  **Incomplete or Contradictory Setup**: The problem provides a complete set of conditions necessary to determine the structure of the endomorphism algebra of $A_f$. The conditions \"no CM\" and \"no nontrivial inner twists\" are standard and crucial hypotheses in the relevant theorems. There are no contradictions.\n4.  **Unrealistic or Infeasible**: The existence of such a newform $f$ is known. For example, the modular curve $X_0(11)$ is an elliptic curve, and its associated newform has Hecke field $\\mathbb{Q}$. There are examples with real quadratic Hecke fields, such as for certain levels $N$. The conditions are mathematically realistic.\n5.  **Ill-Posed or Poorly Structured**: The problem is well-posed. It asks for the determination of mathematical structures ($A_f$'s isogeny class and its endomorphism algebra) that are well-defined. The question leads to a unique answer based on the given information and established theorems.\n6.  **Pseudo-Profound, Trivial, or Tautological**: The problem requires knowledge of deep theorems by Shimura and Ribet. It is not trivial. While the provided conditions make the application of these theorems direct, this is characteristic of a well-formulated problem designed to test understanding of the theory, rather than a flaw.\n7.  **Outside Scientific Verifiability**: The claims are entirely within the realm of mathematics and are verifiable.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is scientifically grounded, well-posed, and all terms are standard in the specified field. I will proceed to provide a complete, reasoned solution.", "answer": "$$\\boxed{2}$$", "id": "3018138"}]}