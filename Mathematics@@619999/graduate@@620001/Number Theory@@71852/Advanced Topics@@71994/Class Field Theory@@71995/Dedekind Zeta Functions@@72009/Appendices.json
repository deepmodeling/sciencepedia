{"hands_on_practices": [{"introduction": "The Dedekind zeta function $\\zeta_K(s)$ is fundamentally an object built from local information, encoded in its Euler product over the prime ideals of the number field $K$. This first exercise provides essential practice in constructing these local factors from the ground up. By analyzing how rational primes decompose in a given number field, you will directly compute the corresponding terms in the Euler product, a core skill for understanding the structure of $\\zeta_K(s)$ [@problem_id:3010964].", "problem": "Let $K = \\mathbb{Q}(\\alpha)$ be the cubic number field defined by adjoining a root $\\alpha$ of the irreducible polynomial $f(x) = x^{3} - x^{2} - 2 x + 1 \\in \\mathbb{Z}[x]$. Using foundational facts about discriminants, embeddings, and prime ideal factorization via reduction modulo primes, determine the following invariants of $K$ from first principles:\n\n1. The absolute discriminant $d_{K}$ of $K$.\n2. The signature $(r_{1}, r_{2})$ of $K$, where $r_{1}$ is the number of real embeddings and $r_{2}$ is the number of pairs of complex embeddings.\n3. For each rational prime $p \\in \\{2,3,5,7,11,13\\}$, the Euler factor $E_{p}(s)$ of the Dedekind zeta function $\\zeta_{K}(s)$ at $p$, defined by $E_{p}(s) = \\prod_{\\mathfrak{p} \\mid p} \\left(1 - N\\mathfrak{p}^{-s}\\right)^{-1}$, by factoring $f(x)$ modulo $p$ and deducing the splitting type and residue degrees.\n\nReport your final answer as a single row matrix containing, in order, the values of $d_{K}$, $r_{1}$, $r_{2}$, and the six Euler factors $E_{p}(s)$ for $p \\in \\{2,3,5,7,11,13\\}$ as explicit rational functions in $p^{-s}$. No numerical approximation is required, and no units are involved.", "solution": "The problem asks for several invariants of the cubic number field $K = \\mathbb{Q}(\\alpha)$ defined by the irreducible polynomial $f(x) = x^{3} - x^{2} - 2 x + 1$.\n\nFirst, we validate the problem statement. The polynomial $f(x)$ is claimed to be irreducible over $\\mathbb{Q}$. By the Rational Root Theorem, any potential rational root must be a divisor of the constant term $1$, so the candidates are $\\pm 1$. We evaluate $f(1) = 1^{3} - 1^{2} - 2(1) + 1 = -1 \\neq 0$ and $f(-1) = (-1)^{3} - (-1)^{2} - 2(-1) + 1 = -1 - 1 + 2 + 1 = 1 \\neq 0$. Since $f(x)$ has no rational roots and is of degree $3$, it is irreducible over $\\mathbb{Q}$. The problem is well-posed and grounded in standard algebraic number theory.\n\nWe proceed to determine the requested invariants.\n\n**1. The signature $(r_1, r_2)$ of $K$**\n\nThe signature $(r_1, r_2)$ consists of the number of real embeddings $r_1$ and the number of pairs of complex conjugate embeddings $r_2$. The number $r_1$ is equal to the number of real roots of the minimal polynomial $f(x)$. We analyze the function $f(x)$ on the real line. We evaluate it at several integer points:\n$f(-2) = (-2)^3 - (-2)^2 - 2(-2) + 1 = -8 - 4 + 4 + 1 = -7$.\n$f(-1) = (-1)^3 - (-1)^2 - 2(-1) + 1 = -1 - 1 + 2 + 1 = 1$.\n$f(0) = 0^3 - 0^2 - 2(0) + 1 = 1$.\n$f(1) = 1^3 - 1^2 - 2(1) + 1 = -1$.\n$f(2) = 2^3 - 2^2 - 2(2) + 1 = 8 - 4 - 4 + 1 = 1$.\n\nBy the Intermediate Value Theorem, since $f(-2) < 0$ and $f(-1) > 0$, there is a root in the interval $(-2, -1)$.\nSince $f(0) > 0$ and $f(1) < 0$, there is a root in the interval $(0, 1)$.\nSince $f(1) < 0$ and $f(2) > 0$, there is a root in the interval $(1, 2)$.\n\nAs a cubic polynomial can have at most $3$ real roots, we have found all of them. Thus, there are $r_1 = 3$ real embeddings.\nThe degree of the extension is $n = [K:\\mathbb{Q}] = 3$. The signature must satisfy $n = r_1 + 2r_2$.\nSubstituting the values, we have $3 = 3 + 2r_2$, which implies $2r_2 = 0$, so $r_2 = 0$.\nThe signature of $K$ is $(r_1, r_2) = (3, 0)$. This indicates that $K$ is a totally real field.\n\n**2. The absolute discriminant $d_K$ of $K$**\n\nFirst, we compute the discriminant of the polynomial $f(x) = x^3 - x^2 - 2x + 1$. For a general cubic $x^3 + ax^2 + bx + c$, the discriminant is given by the formula $\\Delta = a^2b^2 - 4b^3 - 4a^3c - 27c^2 + 18abc$.\nFor $f(x)$, we have $a=-1$, $b=-2$, and $c=1$.\n$\\text{disc}(f) = (-1)^2(-2)^2 - 4(-2)^3 - 4(-1)^3(1) - 27(1)^2 + 18(-1)(-2)(1)$\n$= (1)(4) - 4(-8) - 4(-1)(1) - 27 + 36$\n$= 4 + 32 + 4 - 27 + 36 = 76 - 27 = 49 = 7^2$.\n\nThe discriminant of the polynomial, $\\text{disc}(f)$, is related to the absolute discriminant of the field, $d_K$, by the formula $\\text{disc}(f) = [\\mathcal{O}_K : \\mathbb{Z}[\\alpha]]^2 d_K$, where $\\mathcal{O}_K$ is the ring of integers of $K$.\n$49 = [\\mathcal{O}_K : \\mathbb{Z}[\\alpha]]^2 d_K$.\nThis implies that $d_K$ must be a divisor of $49$. Since $K \\neq \\mathbb{Q}$, we must have $|d_K| > 1$. The sign of the discriminant is given by $(-1)^{r_2}$. Since $r_2=0$, $d_K > 0$. The positive divisors of $49$ are $1, 7, 49$. Thus, $d_K$ could be $7$ or $49$.\nBy Stickelberger's theorem, the discriminant of a number field must be congruent to $0$ or $1$ modulo $4$.\n$7 \\equiv 3 \\pmod 4$, so $d_K \\neq 7$.\n$49 \\equiv 1 \\pmod 4$, which is a valid possibility.\nTherefore, the only possibility is $d_K=49$.\nThis implies that $[\\mathcal{O}_K : \\mathbb{Z}[\\alpha]]^2 = 1$, so the index is $1$. This means the order $\\mathbb{Z}[\\alpha]$ is the maximal order, so $\\mathcal{O}_K = \\mathbb{Z}[\\alpha]$.\n\n**3. Euler factors $E_p(s)$ for $p \\in \\{2,3,5,7,11,13\\}$**\n\nSince $\\mathcal{O}_K = \\mathbb{Z}[\\alpha]$, we can use the Dedekind-Kummer theorem to determine the factorization of a prime ideal $(p)$ by factoring the polynomial $f(x)$ modulo $p$. If $f(x) \\equiv \\prod_{i=1}^{k} g_i(x)^{e_i} \\pmod p$ is the factorization into distinct irreducible polynomials $g_i(x)$ over $\\mathbb{F}_p$ with degrees $f_i = \\deg(g_i)$, then $(p) = \\prod_{i=1}^{k} \\mathfrak{p}_i^{e_i}$ where $\\mathfrak{p}_i$ are prime ideals with norm $N(\\mathfrak{p}_i) = p^{f_i}$. The Euler factor is then $E_p(s) = \\prod_{i=1}^{k} (1 - N(\\mathfrak{p}_i)^{-s})^{-1} = \\prod_{i=1}^{k} (1 - p^{-f_i s})^{-1}$.\n\n- **Case $p=2$**: $f(x) \\equiv x^3 - x^2 - 2x + 1 \\equiv x^3 + x^2 + 1 \\pmod 2$.\nTesting for roots in $\\mathbb{F}_2$: $f(0) \\equiv 1$, $f(1) \\equiv 1+1+1=1$. No roots, so $f(x)$ is irreducible modulo $2$.\nThis corresponds to one irreducible factor of degree $f_1=3$. The ideal $(2)$ is inert.\n$E_2(s) = (1 - 2^{-3s})^{-1}$.\n\n- **Case $p=3$**: $f(x) \\equiv x^3 - x^2 - 2x + 1 \\equiv x^3 - x^2 + x + 1 \\pmod 3$.\nTesting for roots in $\\mathbb{F}_3$: $f(0) \\equiv 1$, $f(1) \\equiv 1-1+1+1=2$, $f(2) \\equiv 8-4+2+1=7 \\equiv 1$. No roots, so $f(x)$ is irreducible modulo $3$.\nThis corresponds to one irreducible factor of degree $f_1=3$. The ideal $(3)$ is inert.\n$E_3(s) = (1 - 3^{-3s})^{-1}$.\n\n- **Case $p=5$**: $f(x) \\equiv x^3 - x^2 - 2x + 1 \\pmod 5$.\nTesting for roots in $\\mathbb{F}_5$: $f(0) \\equiv 1, f(1) \\equiv -1, f(2) \\equiv 1, f(3) \\equiv 3, f(4) \\equiv 1$. No roots, so $f(x)$ is irreducible modulo $5$.\nThis corresponds to one irreducible factor of degree $f_1=3$. The ideal $(5)$ is inert.\n$E_5(s) = (1 - 5^{-3s})^{-1}$.\n\n- **Case $p=7$**: $f(x) \\equiv x^3 - x^2 - 2x + 1 \\pmod 7$. As $d_K=49$, we expect $p=7$ to ramify.\nLet's find roots: $f(5) = 125 - 25 - 10 + 1 = 91 = 13 \\times 7 \\equiv 0 \\pmod 7$. So $(x-5)$ is a factor.\n$f(x) = x^3-x^2-2x+1 \\equiv x^3+6x^2+5x+1 \\pmod 7$.\nDivision by $(x-5) \\equiv x+2$: $(x^3+6x^2+5x+1) = (x+2)(x^2+4x+4)=(x+2)(x+2)^2=(x+2)^3$.\nSo $f(x) \\equiv (x-5)^3 \\pmod 7$.\nThis corresponds to one factor with degree $f_1=1$ and exponent $e_1=3$. The ideal $(7)$ is totally ramified: $(7)=\\mathfrak{p}^3$. The norm of $\\mathfrak{p}$ is $7^1=7$.\n$E_7(s) = (1 - 7^{-s})^{-1}$.\n\n- **Case $p=11$**: $f(x) \\equiv x^3 - x^2 - 2x + 1 \\pmod{11}$.\nA systematic check for roots in $\\mathbb{F}_{11}$ shows that there are none: $f(0)=1, f(1)=10, f(2)=1, f(3)=2, f(4)=8, f(5)=3, f(6)=4, f(7)=4, f(8)=6, f(9)=4, f(10)=1$.\nSo $f(x)$ is irreducible modulo $11$. This corresponds to one irreducible factor of degree $f_1=3$. The ideal $(11)$ is inert.\n$E_{11}(s) = (1 - 11^{-3s})^{-1}$.\n\n- **Case $p=13$**: $f(x) \\equiv x^3 - x^2 - 2x + 1 \\pmod{13}$.\nTesting for roots in $\\mathbb{F}_{13}$: $f(3) = 27 - 9 - 6 + 1 = 13 \\equiv 0 \\pmod{13}$. So $(x-3)$ is a factor.\nPolynomial division: $(x^3 - x^2 - 2x + 1) = (x-3)(x^2 + 2x + 4) \\pmod{13}$.\nThe quadratic factor $q(x) = x^2+2x+4$ has discriminant $\\Delta = 2^2 - 4(1)(4) = -12 \\equiv 1 \\pmod{13}$.\nSince the discriminant is a square ($1=1^2$), $q(x)$ factors into two distinct linear terms.\nThe roots are $x = \\frac{-2 \\pm \\sqrt{1}}{2} = \\frac{-2 \\pm 1}{2}$. The multiplicative inverse of $2$ in $\\mathbb{F}_{13}$ is $7$.\n$x_1 = (-1)(7) = -7 \\equiv 6 \\pmod{13}$.\n$x_2 = (-3)(7) = -21 \\equiv 5 \\pmod{13}$.\nSo $f(x) \\equiv (x-3)(x-5)(x-6) \\pmod{13}$.\n$f(x)$ splits completely into three distinct linear factors. This means the ideal $(13)$ splits as $(13) = \\mathfrak{p}_1 \\mathfrak{p}_2 \\mathfrak{p}_3$, where each $\\mathfrak{p}_i$ has norm $13^1=13$.\n$E_{13}(s) = (1 - 13^{-s})^{-1}(1 - 13^{-s})^{-1}(1 - 13^{-s})^{-1} = (1 - 13^{-s})^{-3}$.\n\nThe final results are collected into a single matrix.\n$d_K = 49$\n$(r_1, r_2) = (3, 0)$\n$E_2(s) = (1 - 2^{-3s})^{-1}$\n$E_3(s) = (1 - 3^{-3s})^{-1}$\n$E_5(s) = (1 - 5^{-3s})^{-1}$\n$E_7(s) = (1 - 7^{-s})^{-1}$\n$E_{11}(s) = (1 - 11^{-3s})^{-1}$\n$E_{13}(s) = (1 - 13^{-s})^{-3}$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n49 & 3 & 0 & \\left(1-2^{-3s}\\right)^{-1} & \\left(1-3^{-3s}\\right)^{-1} & \\left(1-5^{-3s}\\right)^{-1} & \\left(1-7^{-s}\\right)^{-1} & \\left(1-11^{-3s}\\right)^{-1} & \\left(1-13^{-s}\\right)^{-3}\n\\end{pmatrix}\n}\n$$", "id": "3010964"}, {"introduction": "One of the most profound results in algebraic number theory is the Analytic Class Number Formula, which reveals a deep connection between the analytic behavior of $\\zeta_K(s)$ at the special value $s=1$ and the fundamental algebraic invariants of the field $K$. This practice problem invites you to verify this formula for two cornerstone examples: the Gaussian integers $\\mathbb{Q}(i)$ and the Eisenstein integers $\\mathbb{Q}(\\sqrt{-3})$. You will compute the residue of $\\zeta_K(s)$ using both analytic methods and the algebraic formula, witnessing the beautiful consistency of the theory [@problem_id:3010984].", "problem": "Let $K_{1}=\\mathbb{Q}(i)$ and $K_{2}=\\mathbb{Q}(\\sqrt{-3})$. Denote by $w_{K}$ the number of roots of unity in the number field $K$, by $\\zeta_{K}(s)$ the Dedekind zeta function of $K$, and by $d_{K}$ the discriminant of $K$. \n\n(a) Determine $w_{K_{1}}$ and $w_{K_{2}}$ from first principles, using only the definition of a root of unity and the structure of quadratic imaginary fields.\n\n(b) Using only foundational facts about quadratic fields and Dirichlet characters, express the residue \n$$\\lim_{s\\to 1}(s-1)\\,\\zeta_{K}(s)$$ \nfor $K\\in\\{K_{1},K_{2}\\}$ in terms of a Dirichlet $L$-series $L(s,\\chi_{d})$ attached to a quadratic character $\\chi_{d}$ of conductor equal to the (fundamental) discriminant $d$ of $K$, and evaluate $L(1,\\chi_{d})$ in closed form by a direct series computation.\n\n(c) Compute $d_{K_{1}}$ and $d_{K_{2}}$, recall that both $K_{1}$ and $K_{2}$ have class number $h_{K}=1$ and unit rank $0$ (so the regulator is by convention $R_{K}=1$), and verify the consistency of the analytic class number formula for the residue at $s=1$ in these two cases.\n\nReport your final answer as the row matrix \n$$\\big[w_{K_{1}},\\,w_{K_{2}},\\,\\lim_{s\\to 1}(s-1)\\zeta_{K_{1}}(s),\\,\\lim_{s\\to 1}(s-1)\\zeta_{K_{2}}(s)\\big].$$\nNo numerical rounding is required; give exact closed forms.", "solution": "The problem statement is well-posed, scientifically grounded, objective, and internally consistent, containing all necessary information for a unique solution. It is a standard problem in algebraic number theory. I will proceed with the solution.\n\nThe problem is addressed in three parts as requested.\n\n(a) Determination of $w_{K_{1}}$ and $w_{K_{2}}$\n\nA root of unity in a number field $K$ is an algebraic integer $\\zeta \\in \\mathcal{O}_K$ such that $\\zeta^n=1$ for some positive integer $n$. This is equivalent to requiring that the complex norm of $\\zeta$ is $1$, i.e., $|\\zeta|=1$. Since the field norm $N_K(\\alpha)$ for an algebraic integer $\\alpha \\in \\mathcal{O}_K$ is a rational integer, and for an imaginary quadratic field $K = \\mathbb{Q}(\\sqrt{-d})$ with $d>0$, the norm of an element $z \\in K$ is $N(z) = |z|^2$, a root of unity must have field norm $N(\\zeta)=|\\zeta|^2=1$.\n\nFor $K_{1} = \\mathbb{Q}(i)$, the ring of integers is the Gaussian integers, $\\mathcal{O}_{K_{1}} = \\mathbb{Z}[i]$. An element is of the form $z = a+bi$ where $a,b \\in \\mathbb{Z}$. The norm is $N(z) = a^2+b^2$. We seek integer solutions to $a^2+b^2=1$.\nIf $|a| \\ge 2$ or $|b| \\ge 2$, then $a^2+b^2 \\ge 4$, so no solution exists. We only need to check $a,b \\in \\{-1, 0, 1\\}$.\nThe integer solutions $(a,b)$ are $(1,0)$, $(-1,0)$, $(0,1)$, and $(0,-1)$. These correspond to the elements $1$, $-1$, $i$, and $-i$. These are the four roots of unity in $K_{1}$.\nTherefore, $w_{K_{1}} = 4$.\n\nFor $K_{2} = \\mathbb{Q}(\\sqrt{-3})$, the ring of integers is the Eisenstein integers, $\\mathcal{O}_{K_{2}} = \\mathbb{Z}[\\omega]$ where $\\omega = \\frac{1+\\sqrt{-3}}{2}$. An element is of the form $z = a+b\\omega$ where $a,b \\in \\mathbb{Z}$. The norm is $N(z) = N(a+b\\frac{1+\\sqrt{-3}}{2}) = N((a+\\frac{b}{2}) + i\\frac{b\\sqrt{3}}{2}) = (a+\\frac{b}{2})^2 + (\\frac{b\\sqrt{3}}{2})^2 = a^2+ab+\\frac{b^2}{4}+\\frac{3b^2}{4} = a^2+ab+b^2$.\nWe seek integer solutions to $a^2+ab+b^2=1$.\nIf $a=0$, $b^2=1 \\Rightarrow b = \\pm 1$. This gives two solutions $(0,1)$ and $(0,-1)$, corresponding to $z=\\omega$ and $z=-\\omega$.\nIf $b=0$, $a^2=1 \\Rightarrow a = \\pm 1$. This gives two solutions $(1,0)$ and $(-1,0)$, corresponding to $z=1$ and $z=-1$.\nIf $a,b \\neq 0$:\nIf $a$ and $b$ have the same sign, say $a,b > 0$, then $a^2+ab+b^2 \\ge 1+1+1=3$. No solution.\nIf $a$ and $b$ have opposite signs, say $a>0, b<0$. Let $b'=-b>0$. The equation is $a^2-ab'+(b')^2=1$. We can view this as a quadratic in $a$: $a^2 - ab' + ((b')^2-1) = 0$. For an integer solution $a$ to exist, the discriminant must be a perfect square: $\\Delta = (b')^2 - 4((b')^2-1) = 4-3(b')^2 = k^2$ for some integer $k \\ge 0$. Since $b'$ is a positive integer, $(b')^2 \\ge 1$, so $4-3(b')^2 \\le 1$. The only possibility is $(b')^2=1$, which implies $b'=1$. Then $\\Delta = 4-3=1=1^2$.\nFor $b'=1$ (i.e., $b=-1$), the solutions for $a$ are $a = \\frac{b' \\pm \\sqrt{\\Delta}}{2} = \\frac{1 \\pm 1}{2}$, giving $a=1$ or $a=0$. The case $a=0$ is already handled. The case $a=1$ gives the solution $(a,b)=(1, -1)$.\nBy symmetry, if $b>0, a<0$, we get the solution $(a,b)=(-1,1)$.\nThe integer solutions $(a,b)$ are $(1,0)$, $(-1,0)$, $(0,1)$, $(0,-1)$, $(1,-1)$, and $(-1,1)$.\nThese correspond to the elements:\n$1$, $-1$, $\\omega = \\frac{1+\\sqrt{-3}}{2}$, $-\\omega = \\frac{-1-\\sqrt{-3}}{2}$, $1-\\omega = \\frac{1-\\sqrt{-3}}{2}$, and $-1+\\omega = \\frac{-1+\\sqrt{-3}}{2}$.\nThese are the six sixth roots of unity. Therefore, $w_{K_{2}} = 6$.\n\n(b) Residue Computation using Dirichlet L-series\n\nFor a quadratic number field $K$ with discriminant $d_K$, the Dedekind zeta function factors as $\\zeta_K(s) = \\zeta_{\\mathbb{Q}}(s)L(s, \\chi_{d_K})$, where $\\zeta_{\\mathbb{Q}}(s)$ is the Riemann zeta function and $\\chi_{d_K}$ is the quadratic Dirichlet character associated with $K$. The character is given by the Kronecker symbol $\\chi_{d_K}(n) = (\\frac{d_K}{n})$.\nThe Riemann zeta function has a simple pole at $s=1$ with residue $1$, i.e., $\\lim_{s\\to 1} (s-1)\\zeta_{\\mathbb{Q}}(s)=1$. The L-series $L(s, \\chi_{d_K})$ is analytic for $\\Re(s)>0$ when $\\chi_{d_K}$ is a non-principal character, which is the case for quadratic fields.\nTherefore, the residue of $\\zeta_K(s)$ at $s=1$ is:\n$$ \\lim_{s\\to 1} (s-1)\\zeta_K(s) = \\left(\\lim_{s\\to 1}(s-1)\\zeta_{\\mathbb{Q}}(s)\\right) \\left(\\lim_{s\\to 1} L(s, \\chi_{d_K})\\right) = 1 \\cdot L(1, \\chi_{d_K}) $$\nFor $K_1 = \\mathbb{Q}(i) = \\mathbb{Q}(\\sqrt{-1})$, we have $-1 \\equiv 3 \\pmod{4}$, so the discriminant is $d_{K_1} = 4(-1) = -4$. The associated character $\\chi_{-4}$ is a character modulo $4$. It is nontrivial and given by $\\chi_{-4}(n)=1$ if $n \\equiv 1 \\pmod{4}$, $\\chi_{-4}(n)=-1$ if $n \\equiv 3 \\pmod{4}$, and $\\chi_{-4}(n)=0$ if $\\gcd(n,4) \\ne 1$.\nThe L-series is:\n$$ L(1, \\chi_{-4}) = \\sum_{n=1}^\\infty \\frac{\\chi_{-4}(n)}{n} = \\frac{1}{1} - \\frac{1}{3} + \\frac{1}{5} - \\frac{1}{7} + \\dots $$\nThis is the well-known Gregory-Leibniz series. It is the Taylor series for $\\arctan(x) = \\sum_{k=0}^\\infty \\frac{(-1)^k x^{2k+1}}{2k+1}$ evaluated at $x=1$.\n$$ L(1, \\chi_{-4}) = \\arctan(1) = \\frac{\\pi}{4} $$\nThus, $\\lim_{s\\to 1}(s-1)\\zeta_{K_1}(s) = \\frac{\\pi}{4}$.\n\nFor $K_2 = \\mathbb{Q}(\\sqrt{-3})$, we have $-3 \\equiv 1 \\pmod{4}$, so the discriminant is $d_{K_2} = -3$. The associated character $\\chi_{-3}$ is a character modulo $3$. It is given by the Legendre symbol $(\\frac{n}{3})$, so $\\chi_{-3}(1)=1$, $\\chi_{-3}(2)=-1$, and $\\chi_{-3}(3)=0$.\nThe L-series is:\n$$ L(1, \\chi_{-3}) = \\sum_{n=1}^\\infty \\frac{\\chi_{-3}(n)}{n} = \\frac{1}{1} - \\frac{1}{2} + \\frac{1}{4} - \\frac{1}{5} + \\dots $$\nTo evaluate this series, we can consider the power series $f(x) = \\sum_{n=1}^\\infty \\frac{\\chi_{-3}(n)}{n} x^n$ for $|x|<1$ and evaluate the limit as $x \\to 1^-$.\nThe derivative is $f'(x) = \\sum_{n=1}^\\infty \\chi_{-3}(n) x^{n-1} = 1 - x + x^3 - x^4 + \\dots = (1-x) + x^3(1-x) + x^6(1-x) + \\dots = (1-x)(1+x^3+x^6+\\dots) = (1-x)\\frac{1}{1-x^3} = \\frac{1-x}{(1-x)(1+x+x^2)} = \\frac{1}{1+x+x^2}$.\nThen $L(1, \\chi_{-3}) = f(1) = \\int_0^1 \\frac{1}{1+t+t^2} dt$. We complete the square in the denominator: $1+t+t^2 = (t+\\frac{1}{2})^2 + \\frac{3}{4}$.\n$$ \\int_0^1 \\frac{dt}{(t+\\frac{1}{2})^2 + (\\frac{\\sqrt{3}}{2})^2} = \\left[\\frac{1}{\\sqrt{3}/2} \\arctan\\left(\\frac{t+1/2}{\\sqrt{3}/2}\\right)\\right]_0^1 = \\frac{2}{\\sqrt{3}}\\left[\\arctan\\left(\\frac{2t+1}{\\sqrt{3}}\\right)\\right]_0^1 $$\n$$ = \\frac{2}{\\sqrt{3}} \\left(\\arctan\\left(\\frac{3}{\\sqrt{3}}\\right) - \\arctan\\left(\\frac{1}{\\sqrt{3}}\\right)\\right) = \\frac{2}{\\sqrt{3}}(\\arctan(\\sqrt{3}) - \\arctan(1/\\sqrt{3})) $$\n$$ = \\frac{2}{\\sqrt{3}}\\left(\\frac{\\pi}{3} - \\frac{\\pi}{6}\\right) = \\frac{2}{\\sqrt{3}}\\left(\\frac{\\pi}{6}\\right) = \\frac{\\pi}{3\\sqrt{3}} $$\nThus, $\\lim_{s\\to 1}(s-1)\\zeta_{K_2}(s) = \\frac{\\pi}{3\\sqrt{3}}$.\n\n(c) Verification with the Analytic Class Number Formula\n\nThe analytic class number formula for a number field $K$ states:\n$$ \\lim_{s\\to 1}(s-1)\\zeta_K(s) = \\frac{2^{r_1}(2\\pi)^{r_2}h_K R_K}{w_K \\sqrt{|d_K|}} $$\nwhere $r_1$ is the number of real embeddings, $r_2$ is the number of pairs of complex conjugate embeddings, $h_K$ is the class number, $R_K$ is the regulator, $w_K$ is the number of roots of unity, and $d_K$ is the discriminant.\n\nFor $K_1 = \\mathbb{Q}(i)$, it is an imaginary quadratic field, so $r_1=0$ and $r_2=1$.\nThe discriminant is $d_{K_1}=-4$, so $|d_{K_1}|=4$.\nFrom part (a), $w_{K_1}=4$.\nWe are given that $h_{K_1}=1$ and the unit rank is $r_1+r_2-1=0$, so by convention $R_{K_1}=1$.\nPlugging these into the formula:\n$$ \\lim_{s\\to 1}(s-1)\\zeta_{K_1}(s) = \\frac{2^0(2\\pi)^1 \\cdot 1 \\cdot 1}{4 \\cdot \\sqrt{4}} = \\frac{2\\pi}{4 \\cdot 2} = \\frac{2\\pi}{8} = \\frac{\\pi}{4} $$\nThis result is consistent with the value derived in part (b).\n\nFor $K_2 = \\mathbb{Q}(\\sqrt{-3})$, it is also an imaginary quadratic field, so $r_1=0$ and $r_2=1$.\nThe discriminant is $d_{K_2}=-3$, so $|d_{K_2}|=3$.\nFrom part (a), $w_{K_2}=6$.\nWe are given that $h_{K_2}=1$ and the unit rank is $0$, so $R_{K_2}=1$.\nPlugging these into the formula:\n$$ \\lim_{s\\to 1}(s-1)\\zeta_{K_2}(s) = \\frac{2^0(2\\pi)^1 \\cdot 1 \\cdot 1}{6 \\cdot \\sqrt{3}} = \\frac{2\\pi}{6\\sqrt{3}} = \\frac{\\pi}{3\\sqrt{3}} $$\nThis result is also consistent with the value derived in part (b).\n\nThe computation of the discriminants, $d_{K_1}=-4$ and $d_{K_2}=-3$, is confirmed, and the consistency of the analytic class number formula is verified in both cases.\n\nThe final answer requires the row matrix $[w_{K_{1}}, w_{K_{2}}, \\lim_{s\\to 1}(s-1)\\zeta_{K_{1}}(s), \\lim_{s\\to 1}(s-1)\\zeta_{K_{2}}(s)]$.\nThe values are $w_{K_1}=4$, $w_{K_2}=6$, $\\lim_{s\\to 1}(s-1)\\zeta_{K_1}(s) = \\frac{\\pi}{4}$, and $\\lim_{s\\to 1}(s-1)\\zeta_{K_2}(s) = \\frac{\\pi}{3\\sqrt{3}}$.\nThe requested matrix is $[4, 6, \\frac{\\pi}{4}, \\frac{\\pi}{3\\sqrt{3}}]$.", "answer": "$$ \\boxed{ \\begin{pmatrix} 4 & 6 & \\frac{\\pi}{4} & \\frac{\\pi}{3\\sqrt{3}} \\end{pmatrix} } $$", "id": "3010984"}, {"introduction": "The abstract theory of zeta functions has powerful, concrete consequences for counting arithmetic objects. A key application is the Prime Ideal Theorem, which states that the number of ideals with norm up to $x$, denoted $A_K(x)$, is asymptotically proportional to $x$. This final exercise makes this theoretical prediction tangible by asking you to design and implement a program to compute $A_K(x)$ for the Gaussian integers and compare it to the asymptotic behavior predicted by the residue of $\\zeta_{\\mathbb{Q}(i)}(s)$ [@problem_id:3010986].", "problem": "Consider a number field $K$ and its Dedekind zeta function $\\zeta_K(s)$ defined for complex variable $s$ with $\\operatorname{Re}(s) > 1$ by the Dirichlet series\n$$\n\\zeta_K(s) \\;=\\; \\sum_{\\mathfrak{a} \\subset \\mathcal{O}_K \\setminus \\{0\\}} \\frac{1}{N\\mathfrak{a}^{s}} \\;=\\; \\sum_{n=1}^{\\infty} \\frac{a_K(n)}{n^{s}},\n$$\nwhere $\\mathcal{O}_K$ denotes the ring of integers of $K$, $N\\mathfrak{a}$ is the absolute norm of the ideal $\\mathfrak{a}$, and $a_K(n)$ is the number of nonzero integral ideals of norm $n$. Define the summatory counting function\n$$\nA_K(x) \\;=\\; \\sum_{n \\le x} a_K(n),\n$$\nwhich counts the number of nonzero integral ideals of $\\mathcal{O}_K$ with norm at most $x$. The analytic class number formula gives the residue at $s=1$,\n$$\n\\operatorname{Res}_{s=1}\\zeta_K(s) \\;=\\; \\frac{2^{r_1}(2\\pi)^{r_2} h_K R_K}{w_K \\sqrt{|d_K|}},\n$$\nwhere $r_1$ is the number of real embeddings, $r_2$ is the number of pairs of complex embeddings, $h_K$ is the class number, $R_K$ is the regulator, $w_K$ is the number of roots of unity in $K$, and $d_K$ is the discriminant of $K$. Classical Tauberian theory implies that the main term of $A_K(x)$ is given by the residue times $x$.\n\nYour task is to design and implement a program that, starting from these core definitions, derives a computable expression for $A_K(x)$ in terms of arithmetic functions and then evaluates it numerically for the small imaginary quadratic field $K=\\mathbb{Q}(i)$ with ring of integers $\\mathbb{Z}[i]$. For this field, determine the residue constant $c_K = \\operatorname{Res}_{s=1}\\zeta_K(s)$ via the analytic class number formula, and compare $A_K(x)$ to the main term $c_K x$.\n\nThe program must:\n- Use the field $K=\\mathbb{Q}(i)$, whose discriminant satisfies $d_K = -4$, and whose invariants $(r_1,r_2,h_K,R_K,w_K)$ should be determined from first principles within the solution design and used numerically in the code.\n- Derive an explicit, finite, computable formula for $A_K(x)$ based on the Dirichlet series coefficients $a_K(n)$ arising from $\\zeta_K(s)$, using only the fundamental properties of $\\zeta_K(s)$, Euler products, and standard arithmetic functions. The derivation must start from the definitions above, not from pre-stated shortcut identities.\n- Compute $A_K(x)$ numerically for the test suite values of $x$ given below.\n- Compute the comparison ratios\n$$\nR(x) \\;=\\; \\frac{A_K(x)}{c_K x},\n$$\nwhich indicate how close $A_K(x)$ is to the main term $c_K x$.\n\nTest suite:\n- $x=1$ (boundary case),\n- $x=2$ (small case distinguishing even and odd behavior),\n- $x=25$ (square threshold),\n- $x=100$ (moderate case),\n- $x=1000$ (larger case),\n- $x=10000$ (stress case that remains computationally feasible).\n\nFinal output format:\n- Your program should produce a single line of output containing the values of $R(x)$ for the test suite in the order above, as a comma-separated list enclosed in square brackets (for example, $[r_1,r_2,r_3,r_4,r_5,r_6]$).\n- The values must be in floating-point form with standard decimal notation. No physical units are involved, so none are required.", "solution": "The problem requires an analysis of the ideal counting function $A_K(x)$ for the Gaussian number field $K=\\mathbb{Q}(i)$, building from first principles. This involves three main stages: first, determining the residue of the Dedekind zeta function $\\zeta_K(s)$ at $s=1$ using the analytic class number formula; second, deriving a computable expression for the coefficients $a_K(n)$ of the Dirichlet series for $\\zeta_K(s)$; and third, implementing a numerical algorithm to compute $A_K(x)$ and compare it to its asymptotic approximation.\n\nThe field in question is $K = \\mathbb{Q}(i)$, the field of Gaussian rationals. Its ring of integers is $\\mathcal{O}_K = \\mathbb{Z}[i]$, the Gaussian integers. The given problem statement is self-contained, scientifically sound, and well-posed. All definitions and tasks are standard within algebraic number theory. We proceed with the solution.\n\n**Part 1: Determination of the Residue Constant $c_K$**\n\nThe main term in the asymptotic expansion of $A_K(x)$ is given by $c_K x$, where $c_K = \\operatorname{Res}_{s=1}\\zeta_K(s)$. The analytic class number formula provides an expression for this residue in terms of field invariants:\n$$\nc_K = \\frac{2^{r_1}(2\\pi)^{r_2} h_K R_K}{w_K \\sqrt{|d_K|}}\n$$\nWe must determine the invariants $(r_1, r_2, h_K, R_K, w_K, d_K)$ for $K=\\mathbb{Q}(i)$ from fundamental definitions.\n\n1.  **Degree and Embeddings ($r_1, r_2$)**: The field extension $K/\\mathbb{Q}$ is generated by $i$, the root of the minimal polynomial $t^2+1=0$. The degree of the extension is $[K:\\mathbb{Q}]=2$. The roots of the minimal polynomial are $\\pm i$, both of which are complex. Consequently, there are no real embeddings ($r_1=0$) and one pair of complex conjugate embeddings ($r_2=1$). The degree test $n = r_1+2r_2$ is satisfied, as $2 = 0+2(1)$.\n\n2.  **Discriminant ($d_K$)**: The ring of integers $\\mathcal{O}_K = \\mathbb{Z}[i]$ has an integral basis $\\{1, i\\}$. The discriminant is defined as the square of the determinant of the matrix whose entries are the traces of the products of basis elements. The trace of an element $a+bi \\in K$ is $\\operatorname{Tr}(a+bi) = (a+bi) + (a-bi) = 2a$.\n    - $\\operatorname{Tr}(1 \\cdot 1) = \\operatorname{Tr}(1) = 2$.\n    - $\\operatorname{Tr}(1 \\cdot i) = \\operatorname{Tr}(i) = 0$.\n    - $\\operatorname{Tr}(i \\cdot i) = \\operatorname{Tr}(-1) = -2$.\n    The discriminant is thus $d_K = \\det \\begin{pmatrix} 2 & 0 \\\\ 0 & -2 \\end{pmatrix} = -4$. The absolute value is $|d_K|=4$.\n\n3.  **Roots of Unity ($w_K$)**: The roots of unity in $K$ are the elements of $\\mathcal{O}_K = \\mathbb{Z}[i]$ that are also units. The units of $\\mathbb{Z}[i]$ are the elements $a+bi$ whose norm $N(a+bi) = a^2+b^2$ is equal to $1$. The integer solutions to $a^2+b^2=1$ are $(a,b) \\in \\{(\\pm 1, 0), (0, \\pm 1)\\}$. These correspond to the four elements $\\{1, -1, i, -i\\}$. Thus, the number of roots of unity is $w_K=4$.\n\n4.  **Class Number ($h_K$)**: The class number $h_K$ is the order of the ideal class group of $K$. The ring $\\mathbb{Z}[i]$ is a Euclidean domain with respect to the norm function $N(a+bi) = a^2+b^2$. Every Euclidean domain is a principal ideal domain (PID). In a PID, every ideal is principal, which implies the ideal class group is trivial. Therefore, the class number is $h_K=1$.\n\n5.  **Regulator ($R_K$)**: The regulator is a measure of the \"size\" of the unit group. By Dirichlet's Unit Theorem, the rank of the group of units is $r = r_1+r_2-1$. For $K=\\mathbb{Q}(i)$, the rank is $0+1-1=0$. This means the only units are the roots of unity. In the case of a zero-rank unit group (which occurs for $\\mathbb{Q}$ and imaginary quadratic fields), the regulator is defined by convention to be $R_K=1$.\n\nSubstituting these invariants into the formula for the residue:\n$$\nc_K = \\frac{2^{0}(2\\pi)^{1} \\cdot 1 \\cdot 1}{4 \\cdot \\sqrt{4}} = \\frac{2\\pi}{4 \\cdot 2} = \\frac{2\\pi}{8} = \\frac{\\pi}{4}\n$$\nThe asymptotic approximation for the number of ideals is therefore $A_K(x) \\sim \\frac{\\pi}{4}x$.\n\n**Part 2: Derivation of the Ideal Counting Function $a_K(n)$**\n\nTo compute $A_K(x) = \\sum_{n \\le x} a_K(n)$, we need an explicit formula for the coefficients $a_K(n)$, which are defined by $\\zeta_K(s) = \\sum_{n=1}^\\infty a_K(n)n^{-s}$. We start with the Euler product representation of $\\zeta_K(s)$:\n$$\n\\zeta_K(s) = \\prod_{\\mathfrak{p} \\subset \\mathcal{O}_K} \\left(1 - \\frac{1}{N\\mathfrak{p}^s}\\right)^{-1}\n$$\nwhere the product is over all non-zero prime ideals $\\mathfrak{p}$ of $\\mathcal{O}_K = \\mathbb{Z}[i]$. The structure of these prime ideals is determined by the behavior of rational primes $p \\in \\mathbb{Z}$ when extended to $\\mathbb{Z}[i]$. This behavior depends on the Legendre symbol $(\\frac{d_K}{p}) = (\\frac{-4}{p}) = (\\frac{-1}{p})$.\n\n1.  **Ramified Prime ($p=2$)**: A prime $p$ ramifies if it divides the discriminant $d_K=-4$. This occurs only for $p=2$. In $\\mathbb{Z}[i]$, we have the factorization $2 = -i(1+i)^2$. The ideal factorization is $(2) = (1+i)^2$. There is a single prime ideal $\\mathfrak{p}_2 = (1+i)$ lying over $2$. Its norm is $N(\\mathfrak{p}_2) = N_{\\mathbb{Q}(i)/\\mathbb{Q}}(1+i) = 1^2+1^2=2$. The corresponding Euler factor is $(1 - 2^{-s})^{-1}$.\n\n2.  **Split Primes ($p \\equiv 1 \\pmod 4$)**: A prime $p$ splits if $(\\frac{-1}{p})=1$, which holds for $p \\equiv 1 \\pmod 4$. Such a prime splits into a product of two distinct prime ideals, $(p) = \\mathfrak{p}\\overline{\\mathfrak{p}}$. Both ideals have norm $p$. For example, $(5)=(2+i)(2-i)$. The Euler factors for such a prime contribute $(1-p^{-s})^{-1}(1-p^{-s})^{-1} = (1-p^{-s})^{-2}$.\n\n3.  **Inert Primes ($p \\equiv 3 \\pmod 4$)**: A prime $p$ remains inert if $(\\frac{-1}{p})=-1$, which holds for $p \\equiv 3 \\pmod 4$. The ideal $(p)$ is itself a prime ideal in $\\mathbb{Z}[i]$. Its norm is $N((p)) = |N_{\\mathbb{Q}(i)/\\mathbb{Q}}(p)| = p^2$. The corresponding Euler factor is $(1 - (p^2)^{-s})^{-1} = (1 - p^{-2s})^{-1}$.\n\nCombining these cases, we can write the Euler product for $\\zeta_K(s)$ as:\n$$\n\\zeta_K(s) = (1 - 2^{-s})^{-1} \\prod_{p \\equiv 1 \\pmod 4} (1-p^{-s})^{-2} \\prod_{p \\equiv 3 \\pmod 4} (1-p^{-2s})^{-1}\n$$\nWe now relate this to known L-functions. The Riemann zeta function is $\\zeta(s) = \\prod_p (1-p^{-s})^{-1}$. Let $\\chi_1$ be the unique non-principal Dirichlet character modulo $4$, defined by $\\chi_1(n) = 1$ if $n \\equiv 1 \\pmod 4$, $\\chi_1(n) = -1$ if $n \\equiv 3 \\pmod 4$, and $\\chi_1(n) = 0$ if $n$ is even. The associated Dirichlet L-function is $L(s, \\chi_1) = \\prod_p (1 - \\chi_1(p)p^{-s})^{-1}$.\nConsider the product $\\zeta(s) L(s, \\chi_1)$:\n$$\n\\zeta(s)L(s,\\chi_1) = \\prod_{p} \\left( (1-p^{-s})^{-1} (1-\\chi_1(p)p^{-s})^{-1} \\right)\n$$\n-   For $p=2$, $\\chi_1(2)=0$, the factor is $(1-2^{-s})^{-1}$.\n-   For $p \\equiv 1 \\pmod 4$, $\\chi_1(p)=1$, the factor is $(1-p^{-s})^{-1}(1-p^{-s})^{-1}=(1-p^{-s})^{-2}$.\n-   For $p \\equiv 3 \\pmod 4$, $\\chi_1(p)=-1$, the factor is $(1-p^{-s})^{-1}(1+p^{-s})^{-1}=(1-p^{-2s})^{-1}$.\n\nThis product matches the Euler product for $\\zeta_K(s)$ term by term. We have thus established the fundamental identity $\\zeta_K(s) = \\zeta(s) L(s, \\chi_1)$.\n\nThe coefficients of a product of two Dirichlet series are given by the Dirichlet convolution of their respective coefficients. Let $u(n)=1$ be the coefficient function for $\\zeta(s)$ and $\\chi_1(n)$ be the coefficient function for $L(s, \\chi_1)$. Then, the coefficient $a_K(n)$ for $\\zeta_K(s)$ is given by the convolution:\n$$\na_K(n) = (u * \\chi_1)(n) = \\sum_{d|n} u(n/d)\\chi_1(d) = \\sum_{d|n} \\chi_1(d)\n$$\nThis provides an explicit, computable formula for $a_K(n)$: it is the sum of $\\chi_1(d)$ over all positive divisors $d$ of $n$.\n\n**Part 3: Algorithmic Design and Numerical Evaluation**\n\nThe task is to compute $A_K(x) = \\sum_{n=1}^{\\lfloor x \\rfloor} a_K(n)$ and the ratio $R(x) = A_K(x) / (c_K x)$ for several values of $x$. A direct computation of $A_K(x)$ by iterating $n$ up to $x$ and finding all divisors of each $n$ would be inefficient. A superior method is to compute all values of $a_K(n)$ up to the maximum required value of $x$, denoted $x_{max}$, using a sieve-like approach.\n\n1.  **Sieve for $a_K(n)$**: We initialize an array for $a_K(n)$ values, say `a_K_vals`, of size $x_{max}+1$ to all zeros. We then iterate through each integer $d$ from $1$ to $x_{max}$. For each $d$, we compute $\\chi_1(d)$. If $\\chi_1(d)$ is non-zero, we add its value ($\\pm 1$) to `a_K_vals[n]` for all multiples $n$ of $d$ up to $x_{max}$. This correctly accumulates the sum $\\sum_{d|n} \\chi_1(d)$ for each $n$.\n\n2.  **Cumulative Sum for $A_K(x)$**: Once the array `a_K_vals` is populated, the values of the summatory function $A_K(x)$ can be efficiently computed by taking the cumulative sum of `a_K_vals`. We create an array `A_K_vals` where `A_K_vals[x]` stores $\\sum_{n=1}^x a_K(n)$.\n\n3.  **Calculation of Ratios**: With the values of $A_K(x)$ pre-computed for all integers up to $x_{max}$, we can directly look up $A_K(x)$ for each value in the test suite $\\{1, 2, 25, 100, 1000, 10000\\}$. The constant $c_K = \\pi/4$ is computed. The ratio $R(x) = A_K(x) / (c_K x)$ is then calculated for each test case.\n\nThis algorithm computes the required quantities efficiently and accurately, based on the derived formula for $a_K(n)$. The implementation will follow this design.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of computing the ideal counting function for the Gaussian\n    integers and comparing it to its asymptotic main term.\n    \"\"\"\n    test_cases = [1, 2, 25, 100, 1000, 10000]\n    x_max = max(test_cases)\n\n    # Part 1: Determine the residue constant c_K for K = Q(i).\n    # As derived in the solution, the invariants for K = Q(i) are:\n    # r1=0, r2=1, h_K=1, R_K=1, w_K=4, d_K=-4.\n    # The residue is c_K = (2^r1 * (2*pi)^r2 * h_K * R_K) / (w_K * sqrt(|d_K|))\n    # c_K = (2^0 * (2*pi)^1 * 1 * 1) / (4 * sqrt(4)) = (2*pi) / 8 = pi / 4.\n    c_K = np.pi / 4\n\n    # Part 2: Derive and implement the formula for a_K(n).\n    # As derived, a_K(n) = sum_{d|n} chi_1(d), where chi_1 is the\n    # non-principal Dirichlet character modulo 4.\n\n    def chi_1(d):\n        \"\"\"Computes the Dirichlet character chi_1(d) modulo 4.\"\"\"\n        if d % 2 == 0:\n            return 0\n        if d % 4 == 1:\n            return 1\n        # This covers the d % 4 == 3 case\n        return -1\n\n    # Part 3: Algorithmic implementation.\n    # Use a sieve method to compute a_K(n) for n from 1 to x_max.\n    # a_K_vals[n] will store the value of a_K(n). Index 0 is unused.\n    a_K_vals = np.zeros(x_max + 1, dtype=np.int32)\n\n    for d in range(1, x_max + 1):\n        chi_d = chi_1(d)\n        if chi_d == 0:\n            continue\n        # Add chi_d to a_K(n) for all multiples n of d.\n        for n in range(d, x_max + 1, d):\n            a_K_vals[n] += chi_d\n\n    # Compute the cumulative sum A_K(x) = sum_{n=x} a_K(n).\n    # A_K_vals[x] will store the value of A_K(x).\n    # np.cumsum computes the cumulative sum. If a_K_vals[0]=0,\n    # then A_K_vals[x] = sum(a_K_vals[0...x]) = sum(a_K_vals[1...x]).\n    A_K_vals = np.cumsum(a_K_vals)\n\n    # Compute the comparison ratios R(x) = A_K(x) / (c_K * x).\n    results = []\n    for x in test_cases:\n        # A_K(x) is stored at index x of our cumulative sum array.\n        A_K_x = A_K_vals[x]\n        \n        # Asymptotic main term approximation\n        main_term = c_K * x\n        \n        # Ratio\n        ratio = A_K_x / main_term\n        results.append(ratio)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3010986"}]}