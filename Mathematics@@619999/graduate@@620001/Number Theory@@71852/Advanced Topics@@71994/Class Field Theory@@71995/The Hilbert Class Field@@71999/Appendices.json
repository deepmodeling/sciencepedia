{"hands_on_practices": [{"introduction": "The journey into class field theory often begins with understanding its predictions for the simplest non-trivial cases. This exercise provides a foundational, hands-on opportunity to compute the degree of the Hilbert class field for an imaginary quadratic field, $K = \\mathbb{Q}(\\sqrt{-15})$. By working through the calculation of the class number $h_K$, which class field theory equates with the degree $[H_K:K]$, you will apply core techniques such as using Minkowski's bound to identify ideal class generators and testing whether ideals are principal through norm computations [@problem_id:3026825]. This is a fundamental skill for anyone studying algebraic number theory.", "problem": "Let $K = \\mathbb{Q}(\\sqrt{-15})$ and let $\\mathcal{O}_{K}$ denote the ring of integers of $K$. The Hilbert class field (HCF) of $K$, denoted $H_{K}$, is the maximal unramified abelian extension of $K$. Using only fundamental facts and definitions from algebraic number theory, including the definition of the class group, the identification $\\operatorname{Gal}(H_{K}/K) \\cong \\operatorname{Cl}_{K}$, the notion of discriminant and ring of integers of quadratic fields, Minkowski’s bound for quadratic fields, and the basic splitting law for rational primes in quadratic extensions, determine the degree $[H_{K}:K]$.\n\nYour reasoning should include:\n- Identification of the discriminant $D_{K}$ and a convenient $\\mathbb{Z}$-basis for $\\mathcal{O}_{K}$.\n- Application of Minkowski’s bound specialized to imaginary quadratic fields to bound the norms needed to represent ideal classes.\n- Determination of the splitting behavior of the rational prime $2$ in $K$.\n- A norm calculation in $\\mathcal{O}_{K}$ to decide whether any ideal of norm $2$ can be principal.\n\nExpress your final answer as a single integer.", "solution": "The problem asks for the degree of the Hilbert class field extension $[H_{K}:K]$ for the number field $K = \\mathbb{Q}(\\sqrt{-15})$.\nAccording to the fundamental theorem of class field theory, the Galois group of the Hilbert class field extension is isomorphic to the ideal class group of the field $K$. This is given in the problem statement as $\\operatorname{Gal}(H_{K}/K) \\cong \\operatorname{Cl}_{K}$.\nThe degree of the extension is therefore equal to the order of the Galois group, which in turn is equal to the order of the class group, known as the class number $h_{K}$.\n$$[H_{K}:K] = |\\operatorname{Gal}(H_{K}/K)| = |\\operatorname{Cl}_{K}| = h_{K}$$\nOur task is to compute the class number $h_{K}$ for $K = \\mathbb{Q}(\\sqrt{-15})$.\n\nFirst, we identify the discriminant $D_{K}$ and the ring of integers $\\mathcal{O}_{K}$ of the quadratic field $K = \\mathbb{Q}(\\sqrt{d})$ with $d = -15$. Since $d$ is square-free and $d = -15 \\equiv 1 \\pmod 4$, the discriminant is $D_{K} = d = -15$. The ring of integers $\\mathcal{O}_{K}$ is given by $\\mathcal{O}_{K} = \\mathbb{Z}[\\frac{1+\\sqrt{-15}}{2}]$, and a $\\mathbb{Z}$-basis for $\\mathcal{O}_{K}$ is $\\{1, \\frac{1+\\sqrt{-15}}{2}\\}$.\n\nNext, we apply Minkowski's bound to determine the set of prime ideals that are needed to generate the class group. For an imaginary quadratic field, the Minkowski bound $M_{K}$ states that every ideal class in $\\operatorname{Cl}_{K}$ contains an integral ideal $\\mathfrak{a}$ with norm $N(\\mathfrak{a}) \\leq M_{K}$, where\n$$M_{K} = \\frac{2}{\\pi}\\sqrt{|D_{K}|}$$\nSubstituting the value of the discriminant $D_{K} = -15$:\n$$M_{K} = \\frac{2}{\\pi}\\sqrt{|-15|} = \\frac{2\\sqrt{15}}{\\pi}$$\nTo estimate this value, we use the approximations $\\sqrt{15} \\approx 3.87$ and $\\pi \\approx 3.14$:\n$$M_{K} \\approx \\frac{2 \\times 3.87}{3.14} = \\frac{7.74}{3.14} \\approx 2.46$$\nSince $M_{K} < 3$, every ideal class is represented by an integral ideal with a norm of either $1$ or $2$. Ideals of norm $1$ are trivial (the ring $\\mathcal{O}_{K}$ itself), representing the identity class. Thus, the class group $\\operatorname{Cl}_{K}$ is generated by the classes of prime ideals with norm $2$. Prime ideals with norm $2$ must lie over the rational prime $p=2$.\n\nWe now determine the splitting behavior of the rational prime $p=2$ in $\\mathcal{O}_{K}$. For an odd prime $p$ not dividing the discriminant, its splitting is determined by the Legendre symbol $(\\frac{D_K}{p})$. For $p=2$, the splitting behavior depends on the discriminant modulo $8$. As $D_K = -15 = 1 - 16 \\equiv 1 \\pmod 8$, the prime $(2)$ splits into two distinct prime ideals in $\\mathcal{O}_{K}$. Let's denote these prime ideals by $\\mathfrak{p}_{2}$ and $\\mathfrak{p}_{2}'$.\n$$(2) = \\mathfrak{p}_{2} \\mathfrak{p}_{2}'$$\nThe norms of these ideals are $N(\\mathfrak{p}_{2}) = N(\\mathfrak{p}_{2}') = 2$.\nSince $(2)$ is principal, in the class group, we have $[\\mathfrak{p}_{2}][\\mathfrak{p}_{2}'] = [(2)] = [1]$, where $[1]$ is the identity class. This implies that $[\\mathfrak{p}_{2}'] = [\\mathfrak{p}_{2}]^{-1}$. The class group $\\operatorname{Cl}_{K}$ is thus generated by the class of a single prime ideal, for instance, $[\\mathfrak{p}_{2}]$.\n\nTo find the order of the class group, we must find the order of the element $[\\mathfrak{p}_{2}]$. This begins by determining if $\\mathfrak{p}_{2}$ is a principal ideal. An ideal is principal if it is generated by a single element. If $\\mathfrak{p}_{2} = (\\alpha)$ for some $\\alpha \\in \\mathcal{O}_{K}$, then its norm must be $N(\\mathfrak{p}_{2}) = |N_{K/\\mathbb{Q}}(\\alpha)| = 2$.\nAn arbitrary element $\\alpha \\in \\mathcal{O}_{K}$ can be written as $\\alpha = \\frac{x+y\\sqrt{-15}}{2}$ where $x, y \\in \\mathbb{Z}$ and $x \\equiv y \\pmod 2$. The norm of such an element is:\n$$N(\\alpha) = \\left(\\frac{x+y\\sqrt{-15}}{2}\\right)\\left(\\frac{x-y\\sqrt{-15}}{2}\\right) = \\frac{x^2 + 15y^2}{4}$$\nWe search for integer solutions $(x, y)$ to the equation $N(\\alpha) = 2$:\n$$\\frac{x^2 + 15y^2}{4} = 2 \\implies x^2 + 15y^2 = 8$$\nWe examine possible integer values for $y$:\n- If $y = 0$, then $x^2 = 8$, which has no integer solution for $x$.\n- If $|y| = 1$, then $x^2 + 15 = 8$, which implies $x^2 = -7$, having no real solution for $x$.\n- If $|y| \\geq 2$, then $15y^2 \\geq 15(4) = 60 > 8$, so there are no solutions.\nThe equation $x^2 + 15y^2 = 8$ has no integer solutions. Therefore, there is no element $\\alpha \\in \\mathcal{O}_{K}$ with norm $2$. This means that the ideal $\\mathfrak{p}_{2}$ is not principal.\nConsequently, its class $[\\mathfrak{p}_{2}]$ is not the identity element in $\\operatorname{Cl}_{K}$, which implies $h_{K} > 1$.\n\nThe order of the element $[\\mathfrak{p}_{2}]$ is the smallest positive integer $n$ such that $\\mathfrak{p}_{2}^n$ is a principal ideal. Let's check for $n=2$. We need to determine if $\\mathfrak{p}_{2}^2$ is a principal ideal. If it is, say $\\mathfrak{p}_{2}^2 = (\\beta)$, then we must have $N((\\beta)) = N(\\mathfrak{p}_{2}^2) = (N(\\mathfrak{p}_{2}))^2 = 2^2 = 4$. So we search for an element in $\\mathcal{O}_{K}$ with norm $4$.\nThis requires solving the Diophantine equation:\n$$\\frac{x^2 + 15y^2}{4} = 4 \\implies x^2 + 15y^2 = 16$$\nwith $x, y \\in \\mathbb{Z}$ and $x \\equiv y \\pmod 2$.\n- If $y=0$, then $x^2=16 \\implies x=\\pm 4$. The pair $(4, 0)$ satisfies $4 \\equiv 0 \\pmod 2$. This corresponds to the element $\\alpha = \\frac{4+0\\sqrt{-15}}{2} = 2$. The principal ideal $(2)$ has norm $4$, but we know $(2) = \\mathfrak{p}_2 \\mathfrak{p}_2'$, which is not $\\mathfrak{p}_2^2$ since $\\mathfrak{p}_2 \\ne \\mathfrak{p}_2'$.\n- If $|y|=1$, then $x^2+15 = 16 \\implies x^2=1 \\implies x=\\pm 1$. The pairs $(1, 1)$, $(1, -1)$, $(-1, 1)$, $(-1, -1)$ all satisfy the congruence $x \\equiv y \\pmod 2$. For instance, $(x, y)=(1, 1)$ gives the element $\\beta = \\frac{1+\\sqrt{-15}}{2} \\in \\mathcal{O}_{K}$, which has norm $4$.\n- If $|y| \\ge 2$, $15y^2 \\ge 60 > 16$.\n\nWe found an element $\\beta = \\frac{1+\\sqrt{-15}}{2}$ that generates a principal ideal $(\\beta)$ of norm $4$. Let's determine the prime factorization of this ideal. One of the prime ideals over $2$ is $\\mathfrak{p}_{2} = (2, \\frac{1+\\sqrt{-15}}{2})$. Since $\\beta = \\frac{1+\\sqrt{-15}}{2}$ is one of the generators of $\\mathfrak{p}_{2}$, the principal ideal $(\\beta)$ is contained within $\\mathfrak{p}_{2}$. This implies that $\\mathfrak{p}_{2}$ divides $(\\beta)$.\nBy unique factorization of ideals, $(\\beta) = \\mathfrak{p}_{2} \\mathfrak{q}$ for some ideal $\\mathfrak{q}$. Taking norms, $N((\\beta)) = N(\\mathfrak{p}_{2}) N(\\mathfrak{q})$, so $4 = 2 \\cdot N(\\mathfrak{q})$, which implies $N(\\mathfrak{q})=2$. The only ideals of norm $2$ are $\\mathfrak{p}_2$ and $\\mathfrak{p}_2'$.\nSo, we have two possibilities: $(\\beta) = \\mathfrak{p}_{2}^2$ or $(\\beta) = \\mathfrak{p}_{2}\\mathfrak{p}_{2}' = (2)$.\nThe ideal $(\\beta) = (\\frac{1+\\sqrt{-15}}{2})$ cannot be equal to the ideal $(2)$, because the element $2$ cannot be written as a multiple of $\\beta$ by an element in $\\mathcal{O}_{K}$. Indeed, if $2 = \\beta \\cdot \\gamma$ for some $\\gamma \\in \\mathcal{O}_K$, then $\\gamma = \\frac{2}{\\beta} = \\frac{2}{(1+\\sqrt{-15})/2} = \\frac{4}{1+\\sqrt{-15}} = \\frac{4(1-\\sqrt{-15})}{16} = \\frac{1-\\sqrt{-15}}{4}$. This element $\\gamma$ is not in $\\mathcal{O}_{K}$ because its minimal polynomial is $x^2 - \\frac{1}{2}x + 1 = 0$, which does not have integer coefficients.\nTherefore, the equality $(\\beta) = (2)$ is false.\n\nThe only remaining possibility is $(\\beta) = \\mathfrak{p}_{2}^2$. This shows that $\\mathfrak{p}_{2}^2$ is a principal ideal.\nIn the class group $\\operatorname{Cl}_{K}$, this means $[\\mathfrak{p}_{2}]^2 = [1]$. Since we already established that $[\\mathfrak{p}_{2}] \\neq [1]$, the order of the element $[\\mathfrak{p}_{2}]$ is exactly $2$.\nAs the class group $\\operatorname{Cl}_{K}$ is generated by $[\\mathfrak{p}_{2}]$, its order is $h_{K} = 2$.\n\nFinally, the degree of the Hilbert class field extension is $[H_{K}:K] = h_{K} = 2$.", "answer": "$$\\boxed{2}$$", "id": "3026825"}, {"introduction": "After mastering the techniques for quadratic fields, it is natural to ask how these principles generalize. This problem challenges you to compute the class number for a non-quadratic field, the cubic field $K = \\mathbf{Q}(\\theta)$ defined by the polynomial $x^3 - x - 1$. You will see that the method, grounded in the geometry of numbers and Minkowski's bound, is robust enough to handle fields of higher degree and different signatures [@problem_id:3026794]. Working through this example will deepen your appreciation for the power and generality of these tools and reveal the interesting case where a field can be its own Hilbert class field.", "problem": "Let $K$ be the nonquadratic number field $K = \\mathbf{Q}(\\theta)$ where $\\theta$ is a root of the irreducible polynomial $f(x) = x^{3} - x - 1 \\in \\mathbf{Z}[x]$. Work from fundamental definitions and well-tested facts in algebraic number theory: the ring of integers, discriminants, embeddings and signatures, ideal norms, and Minkowski’s geometry-of-numbers bound for ideal classes. Determine the exact value of the extension degree $[H_{K} : K]$, where $H_{K}$ denotes the Hilbert class field (HCF) of $K$, defined as the maximal unramified abelian extension of $K$. Your answer must be a single integer. No rounding is required.", "solution": "The problem asks for the determination of the extension degree $[H_{K} : K]$, where $H_{K}$ is the Hilbert class field of the number field $K = \\mathbf{Q}(\\theta)$ with $\\theta$ being a root of the polynomial $f(x) = x^{3} - x - 1$.\n\nAccording to a fundamental result of class field theory, the Galois group of the Hilbert class field extension is isomorphic to the ideal class group of the base field. Specifically, the Artin map provides an isomorphism $\\text{Gal}(H_{K}/K) \\cong \\text{Cl}(K)$. The degree of the extension is therefore equal to the order of the Galois group, which in turn is equal to the order of the ideal class group, known as the class number $h_{K}$.\n$$[H_{K} : K] = |\\text{Gal}(H_{K}/K)| = |\\text{Cl}(K)| = h_{K}$$\nOur task is thus reduced to calculating the class number $h_{K}$ for the number field $K = \\mathbf{Q}(\\theta)$.\n\nFirst, we establish the basic properties of the number field $K$. The polynomial is $f(x) = x^{3} - x - 1$. It is a polynomial with integer coefficients, $\\mathbf{Z}[x]$. To check for irreducibility over $\\mathbf{Q}$, we use the rational root theorem. Any rational root must be an integer dividing the constant term $-1$, so the only possible rational roots are $\\pm 1$. We evaluate the polynomial at these points:\n$f(1) = 1^{3} - 1 - 1 = -1 \\neq 0$\n$f(-1) = (-1)^{3} - (-1) - 1 = -1 + 1 - 1 = -1 \\neq 0$\nSince there are no rational roots, the cubic polynomial $f(x)$ is irreducible over $\\mathbf{Q}$. The degree of the field extension $K/\\mathbf{Q}$ is the degree of the minimal polynomial, so $n = [K:\\mathbf{Q}] = 3$.\n\nNext, we determine the signature of the field $K$, which is the pair $(r_{1}, r_{2})$, where $r_{1}$ is the number of real embeddings and $2r_{2}$ is the number of complex embeddings. The number of real embeddings is equal to the number of real roots of the minimal polynomial $f(x)$. We can analyze the real roots using calculus. The derivative of $f(x)$ is $f'(x) = 3x^{2} - 1$. The critical points are where $f'(x) = 0$, which gives $x = \\pm \\frac{1}{\\sqrt{3}}$. We evaluate $f(x)$ at these critical points:\n$f\\left(\\frac{1}{\\sqrt{3}}\\right) = \\left(\\frac{1}{\\sqrt{3}}\\right)^{3} - \\frac{1}{\\sqrt{3}} - 1 = \\frac{1}{3\\sqrt{3}} - \\frac{1}{\\sqrt{3}} - 1 = -\\frac{2}{3\\sqrt{3}} - 1 < 0$\n$f\\left(-\\frac{1}{\\sqrt{3}}\\right) = \\left(-\\frac{1}{\\sqrt{3}}\\right)^{3} - \\left(-\\frac{1}{\\sqrt{3}}\\right) - 1 = -\\frac{1}{3\\sqrt{3}} + \\frac{1}{\\sqrt{3}} - 1 = \\frac{2}{3\\sqrt{3}} - 1$. Since $4 < 27$, we have $2 < 3\\sqrt{3}$, which implies $\\frac{2}{3\\sqrt{3}} < 1$. Thus, $f\\left(-\\frac{1}{\\sqrt{3}}\\right)$ is also negative.\nBoth the local maximum and local minimum values of $f(x)$ are negative. As $x \\to \\infty$, $f(x) \\to \\infty$, and as $x \\to -\\infty$, $f(x) \\to -\\infty$. This profile implies that the graph of $f(x)$ crosses the x-axis exactly once. Therefore, $f(x)$ has one real root and a pair of complex conjugate roots. This gives $r_{1} = 1$ real embedding and $2r_{2} = 2$ complex embeddings, so $r_{2} = 1$. The signature is $(1, 1)$, and we verify that $n = r_{1} + 2r_{2} = 1 + 2(1) = 3$.\n\nNow we calculate the discriminant of the number field, $d_{K}$. The discriminant of a cubic polynomial of the form $x^{3} + px + q$ is given by the formula $\\Delta = -4p^{3} - 27q^{2}$. For $f(x) = x^{3} - x - 1$, we have $p = -1$ and $q = -1$. The discriminant of the polynomial is:\n$\\Delta_{f} = -4(-1)^{3} - 27(-1)^{2} = -4(-1) - 27(1) = 4 - 27 = -23$.\nThe discriminant of the field $d_{K}$ is related to the discriminant of the polynomial by the formula $\\Delta_{f} = [\\mathcal{O}_{K} : \\mathbf{Z}[\\theta]]^{2} d_{K}$, where $\\mathcal{O}_{K}$ is the ring of integers of $K$. Since $-23$ is a prime number, it is square-free. This implies that the index $[\\mathcal{O}_{K} : \\mathbf{Z}[\\theta]]^{2}$ must be $1$, so $[\\mathcal{O}_{K} : \\mathbf{Z}[\\theta]] = 1$. This means that $\\mathcal{O}_{K} = \\mathbf{Z}[\\theta]$, and the discriminant of the field is equal to the discriminant of the polynomial: $d_{K} = -23$.\n\nTo find the class number $h_{K}$, we use the Minkowski bound. Every ideal class in $\\text{Cl}(K)$ contains an integral ideal $\\mathfrak{a}$ with norm $N(\\mathfrak{a})$ satisfying:\n$N(\\mathfrak{a}) \\leq M_{K} = \\left(\\frac{4}{\\pi}\\right)^{r_{2}} \\frac{n!}{n^{n}} |d_{K}|^{1/2}$.\nSubstituting the values we found: $n=3$, $r_{2}=1$, and $d_{K}=-23$.\n$M_{K} = \\left(\\frac{4}{\\pi}\\right)^{1} \\frac{3!}{3^{3}} |-23|^{1/2} = \\frac{4}{\\pi} \\frac{6}{27} \\sqrt{23} = \\frac{4}{\\pi} \\frac{2}{9} \\sqrt{23} = \\frac{8\\sqrt{23}}{9\\pi}$.\nWe need to determine if this bound is less than $2$. We can approximate the value:\n$\\sqrt{23} \\approx 4.796$ and $\\pi \\approx 3.1416$.\n$M_{K} \\approx \\frac{8 \\times 4.796}{9 \\times 3.1416} = \\frac{38.368}{28.2744} \\approx 1.357$.\nSince $M_{K} < 2$, this means that every ideal class must contain an integral ideal $\\mathfrak{a}$ with norm $N(\\mathfrak{a}) < 2$. The only possible integer value for the norm is $N(\\mathfrak{a}) = 1$.\nThe only integral ideal with norm $1$ is the ring of integers $\\mathcal{O}_{K}$ itself, which is the principal ideal $(1)$.\nThis implies that every ideal class in $\\text{Cl}(K)$ is the principal ideal class. Therefore, the ideal class group is trivial, $\\text{Cl}(K) = \\{[\\mathcal{O}_{K}]\\}$. The order of the class group, the class number, is $h_{K} = 1$.\n\nFinally, we can determine the degree of the Hilbert class field extension:\n$[H_{K} : K] = h_{K} = 1$.\nThis indicates that the Hilbert class field of $K$ is $K$ itself, meaning $K$ admits no non-trivial unramified abelian extensions.", "answer": "$$\\boxed{1}$$", "id": "3026794"}, {"introduction": "The relationship between the Hilbert class field and the ideal class group has profound computational consequences. This practice moves from manual calculation to algorithmic thinking by asking you to develop a program that determines when a rational prime splits completely in a Hilbert class field [@problem_id:3026789]. This exercise beautifully illustrates the deep theorem connecting the abstract condition of an ideal being principal to the concrete problem of representing a prime number by a specific binary quadratic form. Implementing this yourself provides a tangible understanding of how abstract theory translates into a powerful computational tool.", "problem": "You are given negative fundamental discriminants $D$ and rational primes $p$. Let $K = \\mathbb{Q}(\\sqrt{D})$ be an imaginary quadratic field with discriminant $D$, and let $H_K$ denote its Hilbert class field. Use only the following foundational facts and definitions to design your algorithm.\n\n1. Definition of the Hilbert class field: $H_K$ is the maximal unramified abelian extension of $K$.\n2. Artin reciprocity for the Hilbert class field: For a prime ideal $\\mathfrak{p}$ of $\\mathcal{O}_K$ lying over a rational prime $p \\nmid D$, $\\mathfrak{p}$ splits completely in $H_K$ if and only if the ideal class of $\\mathfrak{p}$ is trivial in the class group $\\mathrm{Cl}(\\mathcal{O}_K)$, that is, if and only if $\\mathfrak{p}$ is principal.\n3. Binary quadratic forms and principal ideals in imaginary quadratic fields: For an imaginary quadratic field $K$ of discriminant $D<0$, the ideal classes correspond to equivalence classes of positive definite primitive binary quadratic forms of discriminant $D$. The principal class corresponds to the principal form\n   - If $D \\equiv 0 \\pmod{4}$: $f(x,y) = x^2 + \\left(-\\frac{D}{4}\\right) y^2$.\n   - If $D \\equiv 1 \\pmod{4}$: $f(x,y) = x^2 + x y + \\left(\\frac{1-D}{4}\\right) y^2$.\n   A rational prime $p \\nmid D$ splits completely in $H_K$ if and only if $p$ splits in $K$ and is represented by the principal form of discriminant $D$, that is, there exist integers $x,y$ such that $f(x,y) = p$.\n4. Splitting in $K$: For any odd prime $p \\nmid D$, $p$ splits in $K$ if and only if the Kronecker symbol $\\left(\\frac{D}{p}\\right) = 1$. For $p=2$, the Kronecker symbol $\\left(\\frac{D}{2}\\right)$ should be used.\n\nTask. Write a complete, runnable program that, for each given pair $(D,p)$, determines whether $p$ splits completely in $H_K$. Your program must implement the following logic without relying on precomputed class groups or tables:\n- If $p \\mid D$, output $\\mathrm{False}$ (since $p$ ramifies in $K$ and cannot split completely in $H_K$).\n- Compute the Kronecker symbol $\\left(\\frac{D}{p}\\right)$. If this is not $1$, output $\\mathrm{False}$.\n- Construct the principal form $f(x,y)$ according to $D \\bmod 4$ as above. Decide whether there exist integers $x,y$ such that $f(x,y)=p$. You must implement a mathematically justified bounded search using the positivity of the principal form. In particular, let $f(x,y) = x^2 + b x y + c y^2$ with $b \\in \\{0,1\\}$ and $c \\in \\mathbb{Z}_{>0}$. Since $f$ is positive definite, for any solution one must have $c y^2 \\le p$, yielding a bound $|y| \\le \\left\\lfloor \\sqrt{\\frac{p}{c}} \\right\\rfloor$. For each such integer $y$, determine whether there exists an integer $x$ satisfying $f(x,y)=p$ by solving the quadratic equation in $x$ and checking the discriminant and integrality conditions.\n\nTest suite. Your program must compute the results for the following input pairs $(D,p)$, in this exact order:\n- $(-4,5)$\n- $(-4,3)$\n- $(-20,29)$\n- $(-20,3)$\n- $(-20,5)$\n- $(-15,19)$\n- $(-15,11)$\n\nAnswer specification and final output format:\n- For each test case, the output must be a boolean $\\mathrm{True}$ or $\\mathrm{False}$ indicating whether $p$ splits completely in $H_K$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $\\mathtt{[True,False,True]}$.", "solution": "The problem asks for an algorithm to determine whether a given rational prime $p$ splits completely in the Hilbert class field $H_K$ of an imaginary quadratic field $K = \\mathbb{Q}(\\sqrt{D})$, for a given negative fundamental discriminant $D$. The solution must be constructed based on a specific set of provided number-theoretic principles.\n\nThe core theoretical result, as outlined in the problem statement, is a consequence of Artin reciprocity for the Hilbert class field. It states that a rational prime $p$ that does not divide the discriminant $D$ (i.e., $p \\nmid D$) splits completely in $H_K$ if and only if two conditions are met:\n1. The prime $p$ splits in the base field $K = \\mathbb{Q}(\\sqrt{D})$.\n2. The prime ideals $\\mathfrak{p}$ of the ring of integers $\\mathcal{O}_K$ lying over $p$ are principal ideals.\n\nThese two conditions can be translated into computationally verifiable criteria involving quadratic forms and the Kronecker symbol. The algorithm is designed as a direct implementation of these criteria.\n\nFirst, we consider the case where the prime $p$ ramifies in $K$. This occurs if and only if $p$ divides the discriminant $D$. An unramified extension, by definition, is one in which no prime ramifies. Since $H_K$ is the maximal *unramified* abelian extension of $K$, any prime that ramifies in $K$ cannot possibly split completely in $H_K$. Therefore, if $p \\mid D$, the condition is not met, and the algorithm returns `False`.\n\nSecond, for a prime $p$ that does not ramify ($p \\nmid D$), we test if it splits in $K$. A prime $p$ splits in the quadratic field $\\mathbb{Q}(\\sqrt{D})$ if and only if the Kronecker symbol $\\left(\\frac{D}{p}\\right) = 1$. If $\\left(\\frac{D}{p}\\right) = -1$, $p$ is inert in $K$, and if $\\left(\\frac{D}{p}\\right) = 0$, $p$ ramifies (a case already handled). If $p$ does not split in $K$, it cannot split completely in any extension of $K$, including $H_K$. Thus, if $\\left(\\frac{D}{p}\\right) \\neq 1$, the algorithm returns `False`. The computation of the Kronecker symbol is handled as follows:\n- If $p=2$, we use the definition $\\left(\\frac{D}{2}\\right) = 1$ if $D \\equiv 1, 7 \\pmod{8}$ and $\\left(\\frac{D}{2}\\right) = -1$ if $D \\equiv 3, 5 \\pmod{8}$. Since $D$ is a fundamental discriminant, $D$ is odd, which implies $D \\equiv 1 \\pmod{4}$. Thus, $D$ is either $1$ or $5 \\pmod{8}$. The condition simplifies to returning $1$ if $D \\equiv 1 \\pmod{8}$ and $-1$ if $D \\equiv 5 \\pmod{8}$.\n- If $p$ is an odd prime, the Kronecker symbol $\\left(\\frac{D}{p}\\right)$ is the Legendre symbol, which can be efficiently computed using Euler's criterion: $\\left(\\frac{D}{p}\\right) \\equiv D^{(p-1)/2} \\pmod{p}$. The result is $1$ if the power is $1 \\pmod p$ and $-1$ if the power is $p-1 \\pmod p$.\n\nThird, if $p$ splits in $K$, we check the principal ideal condition. For imaginary quadratic fields, the theory of binary quadratic forms provides an equivalent criterion: the prime ideals over $p$ are principal if and only if $p$ can be represented by the *principal form* of discriminant $D$. The principal form $f(x,y)$ is a specific positive definite binary quadratic form determined by $D \\pmod{4}$:\n- If $D \\equiv 0 \\pmod{4}$, the principal form is $f(x,y) = x^2 + \\left(-\\frac{D}{4}\\right)y^2$.\n- If $D \\equiv 1 \\pmod{4}$, the principal form is $f(x,y) = x^2 + xy + \\left(\\frac{1-D}{4}\\right)y^2$.\n\nLet the form be generally written as $f(x,y) = ax^2 + bxy + cy^2$, where $a=1$. Our task reduces to determining if the Diophantine equation $f(x,y) = p$ has integer solutions for $x$ and $y$. Since $D < 0$, the form is positive definite, meaning $f(x,y) > 0$ for any non-zero integer pair $(x,y)$. This property allows for a bounded search. For the equation $x^2 + bxy + cy^2 = p$ to hold, we must have $cy^2 \\le p$, which implies $|y| \\le \\sqrt{p/c}$. This provides an upper bound for the magnitude of $y$, so we only need to test integer values of $y$ in the range $0 \\le y \\le \\lfloor\\sqrt{p/c}\\rfloor$.\n\nFor each such integer $y$, we rearrange the equation into a quadratic equation for $x$:\n$$x^2 + (by)x + (cy^2 - p) = 0$$\nFor an integer solution for $x$ to exist, the discriminant of this quadratic equation, $\\Delta_x$, must be a non-negative perfect square. The discriminant is:\n$$\\Delta_x = (by)^2 - 4(1)(cy^2 - p) = (b^2 - 4c)y^2 + 4p$$\nThe term $b^2 - 4c$ is, by definition, the discriminant $D$ of the form (since $a=1$). Thus:\n$$\\Delta_x = Dy^2 + 4p$$\nThe algorithm proceeds by iterating through the valid range of $y$. For each $y$, it calculates $v = Dy^2 + 4p$. If $v$ is a non-negative perfect square, say $v = k^2$ for some integer $k \\ge 0$, then the potential solutions for $x$ are given by $x = \\frac{-by \\pm k}{2}$. For $x$ to be an integer, the numerator $(-by \\pm k)$ must be an even number. As the parity of $-by+k$ and $-by-k$ is the same, we only need to check one. If an integer solution $(x,y)$ is found at any point in this search, $p$ is represented by the principal form, and the algorithm returns `True`.\n\nIf the search over all possible values of $y$ completes without finding any integer solution $(x,y)$, it means $p$ is not represented by the principal form. In this case, the prime ideals over $p$ are not principal, and the algorithm returns `False`.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef kronecker_symbol(a, p):\n    \"\"\"\n    Computes the Kronecker symbol (a/p) where p is a prime.\n    \"\"\"\n    # The problem logic handles the p|D case separately, so we could assume a % p != 0.\n    # However, for robustness, we handle it.\n    if a % p == 0:\n        return 0\n\n    if p == 2:\n        # Since a % p != 0, a must be odd.\n        # D is a fundamental discriminant, so if odd, D must be 1 (mod 4).\n        # Therefore, D mod 8 is either 1 or 5.\n        a_mod_8 = a % 8\n        if a_mod_8 == 1 or a_mod_8 == 7:\n            return 1\n        # a_mod_8 == 3 or a_mod_8 == 5\n        return -1\n\n    # For an odd prime p, the Kronecker symbol is the Legendre symbol.\n    # We use Euler's criterion: a^((p-1)/2) mod p.\n    legendre = pow(a, (p - 1) // 2, p)\n    if legendre == p - 1:\n        return -1\n    else:\n        # Since a is not a multiple of p, the result must be 1.\n        return 1\n\ndef check_split_in_H_K(D, p):\n    \"\"\"\n    Determines if prime p splits completely in the Hilbert class field of Q(sqrt(D)).\n\n    Args:\n        D (int): A negative fundamental discriminant.\n        p (int): A rational prime.\n\n    Returns:\n        bool: True if p splits completely, False otherwise.\n    \"\"\"\n    # Step 1: Handle ramification. If p divides D, p ramifies in K.\n    # An unramified extension like H_K cannot have a prime split completely\n    # if it ramifies in the base field.\n    if D % p == 0:\n        return False\n\n    # Step 2: Check if p splits in K. This is true iff the Kronecker symbol (D/p) is 1.\n    if kronecker_symbol(D, p) != 1:\n        return False\n\n    # Step 3: If p splits in K, check if it's represented by the principal form.\n    # Construct the principal form f(x,y) = x^2 + bxy + cy^2.\n    if D % 4 == 0:\n        b = 0\n        c = -D // 4\n    elif D % 4 == 1:\n        b = 1\n        c = (1 - D) // 4\n    else:\n        # Fundamental discriminants are always 0 or 1 mod 4.\n        # This case should not be reached with valid inputs.\n        raise ValueError(\"Invalid discriminant D: must be 0 or 1 mod 4.\")\n\n    # Step 4: Perform a bounded search for integer solutions to f(x,y) = p.\n    # The form is positive definite, so cy^2 <= p, which implies |y| <= sqrt(p/c).\n    # We only need to search non-negative y.\n    y_max = int(np.sqrt(p / c))\n\n    for y in range(y_max + 1):\n        # We need to solve x^2 + (b*y)*x + (c*y^2 - p) = 0 for an integer x.\n        # The discriminant of this quadratic in x is Delta_x = D*y^2 + 4p.\n        delta_x = D * y**2 + 4 * p\n\n        if delta_x < 0:\n            continue\n        \n        # For x to be an integer, Delta_x must be a perfect square.\n        sqrt_delta_x = int(np.sqrt(delta_x))\n        if sqrt_delta_x**2 != delta_x:\n            continue\n        \n        # If it's a perfect square (k^2), solutions for x are x = (-by +/- k) / 2.\n        # Check if x is an integer. This is true if (-b*y + k) is even.\n        numerator = -b * y + sqrt_delta_x\n        if numerator % 2 == 0:\n            # An integer solution for x exists. Thus, p is represented.\n            return True\n        \n        # The two potential solutions for x have the same parity check,\n        # so checking one numerator is sufficient.\n        \n    # If the loop finishes without finding a solution, p is not represented.\n    return False\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        (-4, 5),\n        (-4, 3),\n        (-20, 29),\n        (-20, 3),\n        (-20, 5),\n        (-15, 19),\n        (-15, 11),\n    ]\n\n    results = []\n    for D, p in test_cases:\n        result = check_split_in_H_K(D, p)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # str(True) -> 'True', str(False) -> 'False'\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3026789"}]}