{"hands_on_practices": [{"introduction": "The Hilbert symbol is fundamentally a test for the existence of non-trivial solutions to a specific quadratic equation in a local field. This first exercise takes you back to this core definition, a principle that underpins its many applications. You will determine the value of several Hilbert symbols in $\\mathbb{Q}_5$ by directly investigating the solvability of the associated quadratic form, $ax^2 + by^2 = z^2$, using foundational tools like reduction modulo $5$ and Hensel's Lemma. This practice is invaluable for building a deep, intuitive understanding of what the Hilbert symbol truly represents [@problem_id:3026930].", "problem": "Let $p$ be an odd prime and let $\\mathbb{Q}_p$ be the field of $p$-adic numbers. For $a,b \\in \\mathbb{Q}_p^{\\times}$, the Hilbert symbol $(a,b)_p \\in \\{\\pm 1\\}$ is defined by $(a,b)_p = 1$ if the homogeneous quadratic equation $a x^2 + b y^2 = z^2$ has a nontrivial solution $(x,y,z) \\in \\mathbb{Q}_p^3 \\setminus \\{(0,0,0)\\}$ and $(a,b)_p = -1$ otherwise. Work over $\\mathbb{Q}_5$ and compute the three Hilbert symbols $(2,5)_5$, $(2,3)_5$, and $(5,5)_5$ using only the definition above, basic properties of the $5$-adic valuation, reduction modulo $5$, and lifting by Hensel’s lemma when applicable. Then, compare your results to the heuristic expectations coming from the Legendre symbol over $\\mathbb{F}_5$, namely quadratic residue considerations for $(\\frac{2}{5})$ and $(\\frac{-1}{5})$. Your final reported answer must be the triple of values in the order $((2,5)_5,(2,3)_5,(5,5)_5)$ written as a single row matrix. No rounding is required.", "solution": "The validity of the problem statement is confirmed. The problem is well-posed, scientifically grounded in the field of number theory, and contains all necessary information for a unique solution.\n\nThe Hilbert symbol $(a,b)_p$ for $a,b \\in \\mathbb{Q}_p^\\times$ is defined to be $1$ if the equation $ax^2 + by^2 = z^2$ has a non-trivial solution $(x,y,z) \\in \\mathbb{Q}_p^3 \\setminus \\{(0,0,0)\\}$, and $-1$ otherwise. We can seek a \"primitive\" solution in $\\mathbb{Z}_p^3$, which is a solution $(x,y,z) \\in \\mathbb{Z}_p^3$ where not all of $x,y,z$ are divisible by $p$. The existence of a non-trivial solution in $\\mathbb{Q}_p$ is equivalent to the existence of a primitive solution in $\\mathbb{Z}_p$. We work in $\\mathbb{Q}_5$, so $p=5$.\n\n1.  **Computation of $(2,5)_5$**\n    We analyze the equation $2x^2 + 5y^2 = z^2$ for a primitive solution $(x,y,z) \\in \\mathbb{Z}_5^3$.\n    Reducing the equation modulo $5$, we get:\n    $$2x^2 + 5y^2 \\equiv z^2 \\pmod{5}$$\n    $$2x^2 \\equiv z^2 \\pmod{5}$$\n    The quadratic residues modulo $5$ are $\\{1^2, 2^2, 3^2, 4^2, 0^2\\} \\pmod{5}$, which are $\\{1, 4, 9\\equiv4, 16\\equiv1, 0\\}$, i.e., $\\{0, 1, 4\\}$.\n    If $x$ is a unit in $\\mathbb{Z}_5$, its 5-adic valuation $v_5(x)$ is $0$, so $x \\not\\equiv 0 \\pmod{5}$. In this case, $x^2 \\equiv 1$ or $4 \\pmod{5}$.\n    - If $x^2 \\equiv 1 \\pmod{5}$, then $2x^2 \\equiv 2 \\pmod{5}$.\n    - If $x^2 \\equiv 4 \\pmod{5}$, then $2x^2 \\equiv 8 \\equiv 3 \\pmod{5}$.\n    In either case, $2x^2$ is congruent to $2$ or $3$ modulo $5$. The expression $z^2$ must be congruent to $0, 1,$ or $4$ modulo $5$. There is no value that satisfies $2x^2 \\equiv z^2 \\pmod{5}$ if $x \\not\\equiv 0 \\pmod{5}$.\n    Therefore, any solution must have $x \\equiv 0 \\pmod{5}$.\n    If $x \\equiv 0 \\pmod{5}$, the equation $2x^2 \\equiv z^2 \\pmod{5}$ becomes $0 \\equiv z^2 \\pmod{5}$, which implies $z \\equiv 0 \\pmod{5}$.\n    So, for any potential primitive solution $(x,y,z)$, we must have $v_5(x) \\ge 1$ and $v_5(z) \\ge 1$. Let $x=5x_1$ and $z=5z_1$ for some $x_1, z_1 \\in \\mathbb{Z}_5$.\n    Substituting these into the original equation:\n    $$2(5x_1)^2 + 5y^2 = (5z_1)^2$$\n    $$50x_1^2 + 5y^2 = 25z_1^2$$\n    Dividing by $5$:\n    $$10x_1^2 + y^2 = 5z_1^2$$\n    Reducing this new equation modulo $5$:\n    $$10x_1^2 + y^2 \\equiv 5z_1^2 \\pmod{5}$$\n    $$y^2 \\equiv 0 \\pmod{5}$$\n    This implies $y \\equiv 0 \\pmod{5}$, so $v_5(y) \\ge 1$.\n    We have shown that if $(x,y,z)$ is a solution in $\\mathbb{Z}_5^3$, then $x,y,z$ must all be divisible by $5$. This contradicts the assumption that $(x,y,z)$ is a primitive solution. This argument, by infinite descent, shows that the only solution in $\\mathbb{Z}_5^3$ is the trivial solution $(0,0,0)$.\n    Thus, there is no non-trivial solution in $\\mathbb{Q}_5^3$.\n    $$(2,5)_5 = -1$$\n\n2.  **Computation of $(2,3)_5$**\n    We analyze the equation $2x^2 + 3y^2 = z^2$. Both $2$ and $3$ are units in $\\mathbb{Z}_5$. We look for a non-trivial solution. Let's try to find a solution with $z=1$. The equation becomes $2x^2 + 3y^2 = 1$.\n    Let's first find a solution modulo $5$: $2x^2 + 3y^2 \\equiv 1 \\pmod{5}$.\n    By trial, we can set $y_0 = 1$. The equation becomes $2x^2 + 3 \\equiv 1 \\pmod{5}$, which simplifies to $2x^2 \\equiv -2 \\equiv 3 \\pmod{5}$. The squares modulo $5$ are $0, 1, 4$. $2(0)^2=0$, $2(1)^2=2$, $2(2)^2=8\\equiv3$, $2(3)^2=18\\equiv3$, $2(4)^2=32\\equiv2$. So we can take $x_0=2$.\n    Thus, $(x_0, y_0) = (2,1)$ is a solution to $2x^2 + 3y^2 \\equiv 1 \\pmod{5}$.\n    We now use Hensel's Lemma to lift this to a solution in $\\mathbb{Z}_5$. Let's fix $y=1$ and solve for $x$ in the equation $2x^2 + 3(1)^2 - 1^2 = 0$.\n    Let $f(x) = 2x^2 + 2$. We have a root $x_0 = 2$ modulo $5$, since $f(2) = 2(2^2) + 2 = 10 \\equiv 0 \\pmod{5}$.\n    The derivative is $f'(x) = 4x$. At $x_0=2$, we have $f'(2) = 4(2) = 8 \\equiv 3 \\not\\equiv 0 \\pmod{5}$.\n    We check the condition for Hensel's Lemma: $|f(x_0)|_5 < |f'(x_0)|_5^2$.\n    $|f(2)|_5 = |10|_5 = |2 \\cdot 5|_5 = 5^{-1}$.\n    $|f'(2)|_5 = |8|_5 = 1$.\n    The condition is $5^{-1} < 1^2$, which is true.\n    Hensel's Lemma guarantees the existence of a unique root $\\alpha \\in \\mathbb{Z}_5$ such that $f(\\alpha) = 0$ and $\\alpha \\equiv 2 \\pmod{5}$.\n    This means there exists an $\\alpha \\in \\mathbb{Z}_5$ such that $2\\alpha^2 + 2 = 0$, which is equivalent to $2\\alpha^2 + 3(1)^2 = 1^2$.\n    Thus, $(\\alpha, 1, 1)$ is a non-trivial solution in $\\mathbb{Z}_5^3$ to the equation $2x^2 + 3y^2 = z^2$.\n    $$(2,3)_5 = 1$$\n\n3.  **Computation of $(5,5)_5$**\n    We analyze the equation $5x^2 + 5y^2 = z^2$.\n    We can simplify this equation by noting that if $-1$ is a square in $\\mathbb{Q}_5$, say $\\alpha^2=-1$, then we can set $y=1, z=0$. The equation becomes $5x^2+5(1)^2=0$, which implies $5x^2=-5$, so $x^2=-1$. A solution for $x$ would be $\\alpha$. Then $(\\alpha, 1, 0)$ would be a non-trivial solution.\n    We check if $-1$ is a square in $\\mathbb{Q}_5$. For an odd prime $p$, a unit $u \\in \\mathbb{Z}_p^\\times$ is a square in $\\mathbb{Q}_p$ if and only if the Legendre symbol $(\\frac{u \\pmod p}{p})$ is $1$.\n    For $p=5$, we check $\\left(\\frac{-1}{5}\\right)$. From number theory, $\\left(\\frac{-1}{p}\\right) = (-1)^{(p-1)/2}$.\n    For $p=5$, this is $\\left(\\frac{-1}{5}\\right) = (-1)^{(5-1)/2} = (-1)^2 = 1$.\n    Since $-1$ is a quadratic residue modulo $5$ (e.g., $2^2=4 \\equiv -1 \\pmod 5$), by Hensel's lemma there exists $\\alpha \\in \\mathbb{Z}_5$ such that $\\alpha^2 = -1$.\n    Then setting $(x,y,z) = (\\alpha, 1, 0)$, we get $5\\alpha^2 + 5(1)^2 = 5(-1) + 5 = 0 = 0^2$. This is a valid non-trivial solution in $\\mathbb{Q}_5^3$.\n    Alternatively, and more directly, one can search for an integer solution. Consider $(x,y) = (1,2)$:\n    $$5(1)^2 + 5(2)^2 = 5 + 5(4) = 25$$\n    We need this to be equal to $z^2$. Setting $z^2=25$ gives $z=5$.\n    Thus, $(x,y,z) = (1,2,5)$ is a non-trivial solution in $\\mathbb{Z}^3$. Since $\\mathbb{Z} \\subset \\mathbb{Q}_5$, this is a non-trivial solution in $\\mathbb{Q}_5^3$.\n    $$(5,5)_5 = 1$$\n\n**Comparison with Heuristic Expectations from Legendre Symbols**\n\n- For $(2,5)_5 = -1$: The equation modulo $5$ is $2x^2 \\equiv z^2 \\pmod{5}$. A non-trivial solution requires $x,z \\not\\equiv 0 \\pmod 5$. This would imply $2 \\equiv (z/x)^2 \\pmod 5$, which would mean $2$ is a quadratic residue modulo $5$. However, the Legendre symbol $\\left(\\frac{2}{5}\\right) = -1$. The unsolvability of the congruence for non-zero $x,z$ is a strong indicator of the Hilbert symbol being $-1$.\n\n- For $(2,3)_5 = 1$: Since $2,3$ are units in $\\mathbb{Z}_5$, a common heuristic is to check if $-3/2$ is a square in $\\mathbb{Q}_5$. This is equivalent to checking if its reduction modulo $5$ is a quadratic residue. $-3/2 \\equiv (-3)(3) = -9 \\equiv 1 \\pmod 5$. The Legendre symbol $\\left(\\frac{1}{5}\\right) = 1$. This correctly predicts that $(2,3)_5=1$.\n\n- For $(5,5)_5 = 1$: A similar heuristic suggests checking if $-5/5 = -1$ is a square in $\\mathbb{Q}_5$. As calculated before, $\\left(\\frac{-1}{5}\\right) = 1$, so $-1$ is a square in $\\mathbb{Q}_5$. This heuristic correctly predicts that $(5,5)_5=1$.\n\n**Final Answer**\nThe three Hilbert symbols are $(2,5)_5 = -1$, $(2,3)_5 = 1$, and $(5,5)_5 = 1$. The final reported answer is the triple of these values.", "answer": "$$\\boxed{\\begin{pmatrix} -1 & 1 & 1 \\end{pmatrix}}$$", "id": "3026930"}, {"introduction": "While the Hilbert symbol is defined locally, its true power is revealed through its global properties. The cornerstone is the Hilbert Reciprocity Law, which states that for any two non-zero rational numbers $a$ and $b$, the product of their Hilbert symbols $(a,b)_v$ over all places $v$ of $\\mathbb{Q}$ is equal to $1$. In this exercise, you will verify this profound theorem for a concrete example by calculating the symbol at every relevant place and confirming that their product is indeed unity. This practice reinforces the computational formulas for different completions and showcases the beautiful interplay between local and global properties in number theory [@problem_id:3026947].", "problem": "Let $a=13$ and $b=5$ viewed as elements of $\\mathbb{Q}^{\\times}$. For each place $v$ of $\\mathbb{Q}$, define the Hilbert symbol $(a,b)_{v}$ over the local field $\\mathbb{Q}_{v}$ by the rule that $(a,b)_{v}=1$ if the quadratic form $a x^{2}+b y^{2}-z^{2}$ represents $0$ nontrivially over $\\mathbb{Q}_{v}$ (that is, there exist $x,y,z \\in \\mathbb{Q}_{v}$ not all zero such that $a x^{2}+b y^{2}=z^{2}$), and $(a,b)_{v}=-1$ otherwise. Starting from this definition and basic facts about valuations and quadratic residues, compute $(a,b)_{v}$ for all places $v$ of $\\mathbb{Q}$ and then the product $\\prod_{v}(a,b)_{v}$. Your final answer must be the value of the product $\\prod_{v}(a,b)_{v}$ as a single exact number. No rounding is required, and no physical units are involved.", "solution": "The problem is first subjected to validation.\n\n### Step 1: Extract Givens\n-   $a = 13 \\in \\mathbb{Q}^{\\times}$\n-   $b = 5 \\in \\mathbb{Q}^{\\times}$\n-   $v$ denotes a place of $\\mathbb{Q}$.\n-   $\\mathbb{Q}_{v}$ is the completion of $\\mathbb{Q}$ at the place $v$.\n-   The Hilbert symbol $(a,b)_{v}$ is defined as follows:\n    -   $(a,b)_{v} = 1$ if there exist $x, y, z \\in \\mathbb{Q}_{v}$, not all zero, such that $a x^{2} + b y^{2} = z^{2}$. This is equivalent to saying the quadratic form $a x^{2} + b y^{2} - z^{2}$ nontrivially represents $0$ over $\\mathbb{Q}_{v}$.\n    -   $(a,b)_{v} = -1$ otherwise.\n-   The task is to compute $(a,b)_{v}$ for all places $v$ of $\\mathbb{Q}$ and then compute the product $\\prod_{v}(a,b)_{v}$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded:** The problem is a standard exercise in algebraic number theory. The definition of the Hilbert symbol, the concept of places of $\\mathbb{Q}$, and the properties of quadratic forms over local fields are all well-established mathematical concepts. The problem is scientifically and factually sound.\n-   **Well-Posed:** All necessary data ($a=13$, $b=5$) and definitions are provided. The objective is clear and unambiguous. A unique solution exists.\n-   **Objective:** The problem is stated using precise, formal mathematical language, with no subjective or vague terms.\n\n### Step 3: Verdict and Action\nThe problem is **valid** as it is mathematically sound, well-posed, and objective. There are no contradictions, missing information, or violations of scientific principles. The solution process may proceed.\n\nWe are asked to compute the Hilbert symbol $(a,b)_{v}$ for $a=13$ and $b=5$ for all places $v$ of the rational numbers $\\mathbb{Q}$, and then to compute their product. The places of $\\mathbb{Q}$ consist of the infinite place $v=\\infty$ (corresponding to the completion $\\mathbb{Q}_{\\infty} = \\mathbb{R}$) and the finite places $v=p$ for every prime number $p$ (corresponding to the completions $\\mathbb{Q}_{p}$).\n\n**1. The Infinite Place ($v = \\infty$)**\nWe compute $(13, 5)_{\\infty}$. The field is the set of real numbers, $\\mathbb{R}$. The equation is $13x^{2} + 5y^{2} = z^{2}$. Since $a=13$ and $b=5$ are both positive, we can easily find a non-trivial real solution. For instance, if we take $x=1$ and $y=0$, we get $13 = z^{2}$, which has a solution $z=\\sqrt{13} \\in \\mathbb{R}$. Thus, $(x, y, z) = (1, 0, \\sqrt{13})$ is a non-trivial solution in $\\mathbb{R}^{3}$. According to the definition, this means $(13, 5)_{\\infty} = 1$. In general, for $a, b \\in \\mathbb{R}^{\\times}$, $(a,b)_{\\infty} = -1$ if and only if both $a < 0$ and $b < 0$. Since $13 > 0$ and $5 > 0$, the symbol is $1$.\n\n**2. The Finite Places ($v = p$)**\nWe now compute $(13, 5)_{p}$ for all prime numbers $p$. A fundamental property of the Hilbert symbol is that for any non-zero rational numbers $a$ and $b$, the symbol $(a,b)_{p} = 1$ for all but a finite number of primes $p$. Specifically, $(a,b)_{p}$ can be different from $1$ only for $p=\\infty$ and for the finite primes $p$ that divide $2ab$. In our case, $a=13$ and $b=5$, so $2ab = 2 \\cdot 13 \\cdot 5 = 130$. The primes we must check are $p=2$, $p=5$, and $p=13$. For all other primes $p$, we have $(13, 5)_{p} = 1$.\n\n**Case $p=2$:**\nWe compute $(13, 5)_{2}$. We use the standard formula for the Hilbert symbol over $\\mathbb{Q}_{2}$. For $a, b \\in \\mathbb{Z}_{2}^{\\times}$ (i.e., odd integers), the formula is $(a,b)_{2} = (-1)^{\\epsilon(a)\\epsilon(b)}$, where $\\epsilon(x) = \\frac{x-1}{2}$.\nHere, $a=13$ and $b=5$.\n$\\epsilon(13) = \\frac{13-1}{2} = 6$.\n$\\epsilon(5) = \\frac{5-1}{2} = 2$.\nSo, $(13, 5)_{2} = (-1)^{6 \\cdot 2} = (-1)^{12} = 1$.\n\n**Case $p=5$:**\nWe compute $(13, 5)_{5}$. A general formula for the Hilbert symbol $(a,b)_{p}$ for an odd prime $p$ is given by\n$$ (a,b)_{p} = (-1)^{\\alpha\\beta\\frac{p-1}{2}} \\left(\\frac{u}{p}\\right)^{\\beta} \\left(\\frac{v}{p}\\right)^{\\alpha} $$\nwhere $a = p^{\\alpha}u$, $b = p^{\\beta}v$ with $u, v$ being $p$-adic units, and $(\\frac{\\cdot}{p})$ is the Legendre symbol.\nFor $a=13$ and $b=5$ and $p=5$:\n$a = 13 = 5^{0} \\cdot 13$, so $\\alpha = 0$ and $u=13$.\n$b = 5 = 5^{1} \\cdot 1$, so $\\beta = 1$ and $v=1$.\nPlugging these into the formula:\n$$ (13, 5)_{5} = (-1)^{0 \\cdot 1 \\cdot \\frac{5-1}{2}} \\left(\\frac{13}{5}\\right)^{1} \\left(\\frac{1}{5}\\right)^{0} = \\left(\\frac{13}{5}\\right) $$\nThe Legendre symbol is computed as $\\left(\\frac{13}{5}\\right) = \\left(\\frac{13 \\pmod 5}{5}\\right) = \\left(\\frac{3}{5}\\right)$.\nThe quadratic residues modulo $5$ are $1^{2} \\equiv 1$ and $2^{2} \\equiv 4$. Since $3$ is not a quadratic residue modulo $5$, we have $\\left(\\frac{3}{5}\\right) = -1$.\nTherefore, $(13, 5)_{5} = -1$.\n\n**Case $p=13$:**\nWe compute $(13, 5)_{13}$. We use the same formula as for $p=5$.\nFor $a=13$ and $b=5$ and $p=13$:\n$a = 13 = 13^{1} \\cdot 1$, so $\\alpha = 1$ and $u=1$.\n$b = 5 = 13^{0} \\cdot 5$, so $\\beta = 0$ and $v=5$.\nPlugging these into the formula:\n$$ (13, 5)_{13} = (-1)^{1 \\cdot 0 \\cdot \\frac{13-1}{2}} \\left(\\frac{1}{13}\\right)^{0} \\left(\\frac{5}{13}\\right)^{1} = \\left(\\frac{5}{13}\\right) $$\nTo compute the Legendre symbol $\\left(\\frac{5}{13}\\right)$, we can use the Law of Quadratic Reciprocity:\n$$ \\left(\\frac{5}{13}\\right) = \\left(\\frac{13}{5}\\right) (-1)^{\\frac{5-1}{2} \\frac{13-1}{2}} = \\left(\\frac{3}{5}\\right) (-1)^{2 \\cdot 6} = \\left(\\frac{3}{5}\\right) $$\nAs computed before, $\\left(\\frac{3}{5}\\right) = -1$.\nTherefore, $(13, 5)_{13} = -1$.\n\n**Summary of Hilbert Symbols:**\n-   $(13, 5)_{\\infty} = 1$\n-   $(13, 5)_{2} = 1$\n-   $(13, 5)_{5} = -1$\n-   $(13, 5)_{13} = -1$\n-   For all other primes $p \\notin \\{2, 5, 13\\}$, $(13, 5)_{p} = 1$.\n\n**Product over all places:**\nThe final step is to compute the product of these values over all places $v$ of $\\mathbb{Q}$.\n$$ \\prod_{v} (13, 5)_{v} = (13, 5)_{\\infty} \\cdot \\prod_{p \\text{ prime}} (13, 5)_{p} $$\n$$ \\prod_{v} (13, 5)_{v} = (13, 5)_{\\infty} \\cdot (13, 5)_{2} \\cdot (13, 5)_{5} \\cdot (13, 5)_{13} \\cdot \\prod_{p \\notin \\{2,5,13\\}} (13, 5)_{p} $$\nSubstituting the computed values:\n$$ \\prod_{v} (13, 5)_{v} = 1 \\cdot 1 \\cdot (-1) \\cdot (-1) \\cdot \\prod_{p \\notin \\{2,5,13\\}} 1 $$\n$$ \\prod_{v} (13, 5)_{v} = 1 \\cdot 1 \\cdot 1 = 1 $$\nThe result is $1$. This is an instance of the Hilbert Reciprocity Law, which states that for any $a,b \\in \\mathbb{Q}^{\\times}$, the product of all Hilbert symbols $(a,b)_{v}$ over all places $v$ of $\\mathbb{Q}$ is always equal to $1$.", "answer": "$$\n\\boxed{1}\n$$", "id": "3026947"}, {"introduction": "A true mastery of a mathematical concept often involves the ability to generalize its computation into a systematic procedure. This capstone exercise asks you to translate the theory of the Hilbert symbol into a practical, working algorithm. You will develop a program that computes $(a,b)_p$ for arbitrary rational numbers $a,b$ and any prime $p$, correctly distinguishing between the rules for odd primes and the more intricate case of $p=2$. This task will solidify your computational fluency and provide a tangible tool for further exploration [@problem_id:3026921].", "problem": "Design and implement a complete, runnable program that computes the Hilbert symbol $(a,b)_p \\in \\{\\pm 1\\}$ for given pairs $(a,b) \\in \\mathbb{Q}_p^\\times \\times \\mathbb{Q}_p^\\times$ and a prime $p$, using only the following fundamental tools as the algorithmic basis: the $p$-adic valuation, reduction modulo $p$ (or modulo $8$ when $p=2$), and Hensel lifting to reduce to unit computations. Your program must use exact rational arithmetic and must not rely on floating-point approximations.\n\nThe foundational base you may assume in your reasoning and design is limited to:\n- The definition of the $p$-adic valuation $v_p$ on $\\mathbb{Q}^\\times$ and its basic properties (multiplicativity and the decomposition $x=p^{v_p(x)}u$ with a unit $u \\in \\mathbb{Z}_p^\\times$).\n- The definition of the Legendre symbol $\\left(\\frac{u}{p}\\right)$ for odd primes $p$ and units $u \\in \\mathbb{Z}_p^\\times$, and Euler’s criterion $u^{(p-1)/2} \\equiv \\left(\\frac{u}{p}\\right) \\pmod p$.\n- Hensel’s lemma for lifting solutions from residue fields to $\\mathbb{Z}_p$ (conceptual use to justify reduction to unit computations; you must not hard-code any target formulas as a shortcut).\n- The multiplicativity and bilinearity of the Hilbert symbol $(\\cdot,\\cdot)_p$ over $\\mathbb{Q}_p^\\times / (\\mathbb{Q}_p^\\times)^2$.\n\nYour algorithm must proceed from first principles as follows:\n1. Given $a,b \\in \\mathbb{Q}^\\times$ and a prime $p$, compute the valuations $v_p(a)$ and $v_p(b)$, and write $a=p^\\alpha u$ and $b=p^\\beta v$ with units $u,v \\in \\mathbb{Z}_p^\\times$.\n2. Reduce the computation of $(a,b)_p$ to unit computations using bilinearity modulo squares and the fact that the symbol depends only on $a,b$ modulo squares in $\\mathbb{Q}_p^\\times$.\n3. For odd $p$, reduce unit information to residue classes modulo $p$ via Hensel lifting and the Legendre symbol, combining it with the parity information from $v_p(a), v_p(b)$.\n4. For $p=2$, reduce unit information to residue classes modulo $8$ via Hensel lifting and use the standard unit invariants modulo $8$ that control the Hilbert symbol on $\\mathbb{Q}_2^\\times$.\n\nYour program must implement the above steps algorithmically, without using any external black-box for Hilbert symbols.\n\nTest Suite:\nCompute $(a,b)_p$ for each of the following test cases. Each rational is given as an exact fraction $a=\\frac{m}{n}$, $b=\\frac{r}{s}$ with integers $m,n,r,s \\neq 0$.\n\n- Case $1$: $p=3$, $a=\\frac{3}{1}$, $b=\\frac{3}{1}$.\n- Case $2$: $p=5$, $a=\\frac{5}{1}$, $b=\\frac{5}{1}$.\n- Case $3$: $p=7$, $a=\\frac{2}{1}$, $b=\\frac{7}{1}$.\n- Case $4$: $p=7$, $a=\\frac{3}{1}$, $b=\\frac{7}{1}$.\n- Case $5$: $p=3$, $a=\\frac{2}{1}$, $b=\\frac{2}{1}$.\n- Case $6$: $p=2$, $a=\\frac{-1}{1}$, $b=\\frac{-1}{1}$.\n- Case $7$: $p=2$, $a=\\frac{2}{1}$, $b=\\frac{2}{1}$.\n- Case $8$: $p=2$, $a=\\frac{-1}{1}$, $b=\\frac{2}{1}$.\n- Case $9$: $p=2$, $a=\\frac{3}{1}$, $b=\\frac{3}{1}$.\n- Case $10$: $p=5$, $a=\\frac{1}{5}$, $b=\\frac{5}{1}$.\n- Case $11$: $p=3$, $a=\\frac{2}{3}$, $b=\\frac{6}{1}$.\n- Case $12$: $p=2$, $a=\\frac{3}{5}$, $b=\\frac{7}{9}$.\n\nAnswer specification:\n- For each case, the output must be the integer $+1$ or $-1$ representing $(a,b)_p$.\n- Your program should produce a single line of output containing the results, in order, as a comma-separated list enclosed in square brackets, for example $[1,-1,1]$.\n\nNo physical units are involved. All angle units and percentages are irrelevant. The final output must be exactly one line with the specified list format. The program must be self-contained and require no input.", "solution": "The problem of computing the Hilbert symbol $(a,b)_p$ for $a,b \\in \\mathbb{Q}^\\times$ and a prime $p$ is a fundamental task in number theory. The Hilbert symbol is defined as\n$$\n(a,b)_p = \\begin{cases}\n    1 & \\text{if the equation } z^2 = ax^2 + by^2 \\text{ has a non-trivial solution in } \\mathbb{Q}_p \\\\\n    -1 & \\text{otherwise}\n\\end{cases}\n$$\nOur algorithmic approach is based on the properties of the symbol as specified, avoiding direct use of this definition. The core of the method is to use the bilinearity of the Hilbert symbol and reduce the computation to simpler cases involving $p$-adic units and the prime $p$ itself.\n\nFirst, for any $x \\in \\mathbb{Q}^\\times$, we can uniquely write it in the form $x = p^{v_p(x)} u$, where $v_p(x)$ is the $p$-adic valuation of $x$ and $u \\in \\mathbb{Z}_p^\\times$ is a $p$-adic unit (a rational number whose numerator and denominator are not divisible by $p$). Let $a = p^{\\alpha} u$ and $b = p^{\\beta} v$, where $\\alpha = v_p(a)$, $\\beta = v_p(b)$, and $u, v$ are $p$-adic units.\n\nUsing the bilinearity and symmetry of the Hilbert symbol, we can expand $(a,b)_p$:\n$$\n(a,b)_p = (p^\\alpha u, p^\\beta v)_p = (p^\\alpha, p^\\beta v)_p (u, p^\\beta v)_p\n$$\n$$\n= (p^\\alpha, p^\\beta)_p (p^\\alpha, v)_p (u, p^\\beta)_p (u, v)_p\n$$\n$$\n= (p,p)_p^{\\alpha\\beta} (p,v)_p^{\\alpha} (u,p)_p^{\\beta} (u,v)_p\n$$\nSince the Hilbert symbol takes values in $\\{\\pm 1\\}$, all exponents can be considered modulo $2$. The computation then breaks down into evaluating the constituent symbols, which depends on whether $p$ is an odd prime or $p=2$.\n\n**Case 1: $p$ is an odd prime**\n\nFor an odd prime $p$, the values of the constituent symbols are given by standard formulas, whose justification relies on Hensel's lemma allowing us to lift solutions from the residue field $\\mathbb{F}_p$ to $\\mathbb{Z}_p$.\n\n1.  For any two $p$-adic units $u, v \\in \\mathbb{Z}_p^\\times$, $(u,v)_p = 1$. This is because the quadratic form $z^2 - \\bar{u}x^2 - \\bar{v}y^2$ has a non-trivial zero in $\\mathbb{F}_p$ (by Chevalley-Warning theorem), which can be lifted to a non-trivial solution in $\\mathbb{Z}_p$.\n\n2.  For a unit $u \\in \\mathbb{Z}_p^\\times$, $(p,u)_p = \\left(\\frac{u}{p}\\right)$, where $\\left(\\frac{\\cdot}{p}\\right)$ is the Legendre symbol. The value depends only on the residue class of $u$ modulo $p$, denoted $\\bar{u}$. Euler's criterion states $\\left(\\frac{\\bar{u}}{p}\\right) \\equiv \\bar{u}^{(p-1)/2} \\pmod p$.\n\n3.  The symbol $(p,p)_p$ can be related to another known symbol. We have the identity $(c, -c)_p = 1$ for any $c \\in \\mathbb{Q}_p^\\times$. Thus $(p, -p)_p = 1$. By bilinearity, $(p,p)_p (p,-1)_p = 1$, which implies $(p,p)_p = (p,-1)_p$. Using the previous rule, $(p,-1)_p = \\left(\\frac{-1}{p}\\right)$. It is a standard result that $\\left(\\frac{-1}{p}\\right) = (-1)^{(p-1)/2}$.\n\nCombining these results, the formula for an odd prime $p$ becomes:\n$$\n(a,b)_p = \\left(\\left(\\frac{-1}{p}\\right)\\right)^{\\alpha\\beta} \\left(\\left(\\frac{v}{p}\\right)\\right)^{\\alpha} \\left(\\left(\\frac{u}{p}\\right)\\right)^{\\beta} (1)\n$$\nwhere all exponents are effectively modulo $2$. Writing this with exponents in the argument of $(-1)$:\n$$\n(a,b)_p = (-1)^{\\alpha\\beta \\frac{p-1}{2}} \\left(\\frac{\\bar{u}}{p}\\right)^{\\beta} \\left(\\frac{\\bar{v}}{p}\\right)^{\\alpha}\n$$\nThe residues $\\bar{u}$ and $\\bar{v}$ of the rational units $u=u_n/u_d$ and $v=v_n/v_d$ are computed modulo $p$ as $\\bar{u} \\equiv u_n (u_d^{p-2}) \\pmod p$ and similarly for $v$.\n\n**Case 2: $p=2$**\n\nThe field $\\mathbb{Q}_2$ requires a separate treatment, as Hensel's lemma requires lifting from residue rings $\\mathbb{Z}/2^k\\mathbb{Z}$ for $k>1$. The symbols depend on the residue classes of the units modulo $4$ or $8$.\n\n1.  For units $u, v \\in \\mathbb{Z}_2^\\times$: $(u,v)_2 = (-1)^{\\frac{u-1}{2}\\frac{v-1}{2}}$. This value is determined by the residue classes of $u, v$ modulo $4$. We define $\\epsilon(x) = \\frac{x-1}{2} \\pmod 2$. Then $(u,v)_2 = (-1)^{\\epsilon(u)\\epsilon(v)}$.\n\n2.  For a unit $u \\in \\mathbb{Z}_2^\\times$: $(2,u)_2 = (-1)^{\\frac{u^2-1}{8}}$. This value is determined by the residue class of $u$ modulo $8$. We define $\\omega(x) = \\frac{x^2-1}{8} \\pmod 2$. Then $(2,u)_2 = (-1)^{\\omega(u)}$.\n\n3.  The symbol $(2,2)_2 = 1$. This is because the equation $z^2 = 2x^2 + 2y^2$ has an integer solution $(x,y,z)=(1,1,2)$, which is also a solution in $\\mathbb{Q}_2$.\n\nCombining these for $a=2^\\alpha u$ and $b=2^\\beta v$:\n$$\n(a,b)_2 = (2,2)_2^{\\alpha\\beta} (2,v)_2^{\\alpha} (2,u)_2^{\\beta} (u,v)_2\n$$\n$$\n= (1)^{\\alpha\\beta} ((-1)^{\\omega(v)})^{\\alpha} ((-1)^{\\omega(u)})^{\\beta} ((-1)^{\\epsilon(u)\\epsilon(v)})\n$$\nThis gives the final formula for $p=2$:\n$$\n(a,b)_2 = (-1)^{\\alpha \\cdot \\omega(v) + \\beta \\cdot \\omega(u) + \\epsilon(u)\\epsilon(v)}\n$$\nFor a rational unit $x=x_n/x_d$, its residue class modulo $k \\in \\{4,8\\}$ is given by $x_n \\cdot x_d^{-1} \\pmod k$. Since $x_d$ is odd, its inverse modulo $4$ or $8$ is $x_d$ itself, as $d^2 \\equiv 1 \\pmod 8$ for any odd integer $d$. Thus, $x \\equiv x_n x_d \\pmod k$.\n\nThe implementation will follow these formulas, using exact rational arithmetic to correctly determine the valuations and unit parts.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import special\nfrom fractions import Fraction\n\ndef v_p_int(n, p):\n    \"\"\"Computes the p-adic valuation of an integer n.\"\"\"\n    if n == 0:\n        # According to the problem, inputs are in Q_p^x, so numerators and\n        # denominators of the original fractions are non-zero.\n        # This case won't be hit with valid inputs.\n        return float('inf')\n    \n    n_abs = abs(n)\n    if n_abs == 1:\n        return 0\n    \n    count = 0\n    while n_abs > 0 and n_abs % p == 0:\n        count += 1\n        n_abs //= p\n    return count\n\ndef v_p(frac, p):\n    \"\"\"Computes the p-adic valuation of a rational number.\"\"\"\n    if frac == 0:\n        return float('inf')\n    return v_p_int(frac.numerator, p) - v_p_int(frac.denominator, p)\n\ndef legendre_symbol(a, p):\n    \"\"\"Computes the Legendre symbol (a/p) using Euler's criterion.\"\"\"\n    if a % p == 0:\n        return 0\n    ls = pow(a, (p - 1) // 2, p)\n    if ls == p - 1:\n        return -1\n    return 1\n\ndef hilbert_symbol(a_frac, b_frac, p):\n    \"\"\"Computes the Hilbert symbol (a,b)_p.\"\"\"\n    alpha = v_p(a_frac, p)\n    beta = v_p(b_frac, p)\n\n    u = a_frac / Fraction(p)**alpha\n    v = b_frac / Fraction(p)**beta\n\n    if p != 2:\n        # Case p is an odd prime\n        u_mod_p = (u.numerator * pow(u.denominator, p - 2, p)) % p\n        v_mod_p = (v.numerator * pow(v.denominator, p - 2, p)) % p\n\n        term1 = pow(-1, (alpha * beta * (p - 1) // 2))\n        term2 = pow(legendre_symbol(u_mod_p, p), beta)\n        term3 = pow(legendre_symbol(v_mod_p, p), alpha)\n        \n        return int(term1 * term2 * term3)\n    else: # p == 2\n        \n        # Helper to get residue mod k for a 2-adic unit rational\n        def get_residue(frac, k):\n            # for a 2-adic unit x = n/d, x mod k is (n * d_inv) mod k.\n            # for k=4 or 8, d_inv is d itself since d^2=1 mod 8 for odd d.\n            return (frac.numerator * frac.denominator) % k\n        \n        u_mod4 = get_residue(u, 4)\n        v_mod4 = get_residue(v, 4)\n        u_mod8 = get_residue(u, 8)\n        v_mod8 = get_residue(v, 8)\n\n        # epsilon(x) = (x-1)/2 mod 2\n        eps_u = ((u_mod4 - 1) // 2) % 2\n        eps_v = ((v_mod4 - 1) // 2) % 2\n        \n        # omega(x) = (x^2-1)/8 mod 2\n        om_u = ((u_mod8**2 - 1) // 8) % 2\n        om_v = ((v_mod8**2 - 1) // 8) % 2\n        \n        exponent = (alpha * om_v + beta * om_u + eps_u * eps_v) % 2\n        \n        return 1 if exponent == 0 else -1\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    test_cases = [\n        # (p, a_num, a_den, b_num, b_den)\n        (3, 3, 1, 3, 1),      # Case 1\n        (5, 5, 1, 5, 1),      # Case 2\n        (7, 2, 1, 7, 1),      # Case 3\n        (7, 3, 1, 7, 1),      # Case 4\n        (3, 2, 1, 2, 1),      # Case 5\n        (2, -1, 1, -1, 1),    # Case 6\n        (2, 2, 1, 2, 1),      # Case 7\n        (2, -1, 1, 2, 1),     # Case 8\n        (2, 3, 1, 3, 1),      # Case 9\n        (5, 1, 5, 5, 1),      # Case 10\n        (3, 2, 3, 6, 1),      # Case 11\n        (2, 3, 5, 7, 9),      # Case 12\n    ]\n\n    results = []\n    for p, a_num, a_den, b_num, b_den in test_cases:\n        a = Fraction(a_num, a_den)\n        b = Fraction(b_num, b_den)\n        result = hilbert_symbol(a, b, p)\n        results.append(str(result))\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```", "id": "3026921"}]}