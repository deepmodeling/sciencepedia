{"hands_on_practices": [{"introduction": "One of the earliest and most significant applications of Bernoulli numbers is in finding closed-form expressions for sums of integer powers, a result known as Faulhaber's formula. This first practice invites you to derive the formula for the sum of fifth powers, $\\sum_{k=1}^{N} k^{5}$, by applying the fundamental properties of Bernoulli polynomials [@problem_id:3009007]. This exercise not only provides direct experience with these important special functions but also reinforces their role as a bridge between the continuous analysis of generating functions and the discrete world of finite sums.", "problem": "Let $\\{B_{n}\\}_{n\\geq 0}$ denote the Bernoulli numbers defined by the exponential generating function $ \\frac{t}{\\exp(t)-1}=\\sum_{n=0}^{\\infty} B_{n}\\,\\frac{t^{n}}{n!}$ with the convention $B_{1}=-\\frac{1}{2}$. Let $B_{n}(x)$ denote the Bernoulli polynomials defined by the exponential generating function $\\frac{t\\,\\exp(x t)}{\\exp(t)-1}=\\sum_{n=0}^{\\infty} B_{n}(x)\\,\\frac{t^{n}}{n!}$. Starting from these definitions and no other prepackaged summation formulas, derive a closed-form expression for the finite sum $\\sum_{k=1}^{N} k^{5}$ as a rational polynomial in $N$. Your derivation should proceed by first principles: use the basic properties of Bernoulli polynomials implied by their generating function to relate $\\sum_{k=1}^{N} k^{5}$ to a difference of Bernoulli polynomials evaluated at $N+1$ and $0$, then simplify using only the Bernoulli numbers $B_{n}$ that actually appear. As a structural check on your intermediate values of $B_{2}$, $B_{4}$, and $B_{6}$, justify their denominators using the von Staudtâ€“Clausen theorem. Finally, verify the correctness of your closed form by a complete induction on $N$, showing that the difference between successive values reproduces $(N+1)^{5}$.\n\nProvide your final result as a single simplified exact algebraic expression in $N$. Do not round. Do not provide units.", "solution": "The problem asks for a closed-form expression for the sum $\\sum_{k=1}^{N} k^{5}$ derived from the properties of Bernoulli polynomials, with intermediate and final verification steps.\n\nFirst, we validate the problem statement.\n**Step 1: Extract Givens**\n- Bernoulli numbers $\\{B_{n}\\}_{n\\geq 0}$ defined by the exponential generating function $ \\frac{t}{\\exp(t)-1}=\\sum_{n=0}^{\\infty} B_{n}\\,\\frac{t^{n}}{n!}$.\n- Convention: $B_{1}=-\\frac{1}{2}$.\n- Bernoulli polynomials $B_{n}(x)$ defined by the exponential generating function $\\frac{t\\,\\exp(x t)}{\\exp(t)-1}=\\sum_{n=0}^{\\infty} B_{n}(x)\\,\\frac{t^{n}}{n!}$.\n- Task: Derive a closed-form expression for $\\sum_{k=1}^{N} k^{5}$ as a rational polynomial in $N$.\n- Method: Use properties of Bernoulli polynomials implied by their generating function, relating the sum to a difference of Bernoulli polynomials.\n- Intermediate Check: Justify the denominators of $B_2$, $B_4$, and $B_6$ using the von Staudt-Clausen theorem.\n- Final Verification: Prove the resulting formula by induction on $N$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It is a standard problem in number theory concerning Faulhaber's formula. The definitions provided are standard, including the explicit convention for $B_1$. The required steps form a complete and logical path to a unique, verifiable solution. The problem does not violate any of the invalidity criteria.\n\n**Step 3: Verdict and Action**\nThe problem is valid. We proceed with the solution.\n\n**Derivation of the Summation Formula**\n\nThe core of the method lies in a difference formula for Bernoulli polynomials. We derive this from their generating function:\n$$ \\sum_{n=0}^{\\infty} [B_{n}(x+1) - B_{n}(x)]\\,\\frac{t^{n}}{n!} = \\frac{t\\,\\exp((x+1)t)}{\\exp(t)-1} - \\frac{t\\,\\exp(xt)}{\\exp(t)-1} $$\n$$ = \\frac{t\\,\\exp(xt)(\\exp(t)-1)}{\\exp(t)-1} = t\\,\\exp(xt) $$\nThe Taylor series for $t\\,\\exp(xt)$ is:\n$$ t\\,\\exp(xt) = t \\sum_{j=0}^{\\infty} \\frac{(xt)^{j}}{j!} = \\sum_{j=0}^{\\infty} \\frac{x^{j}t^{j+1}}{j!} $$\nLet $n=j+1$, so $j=n-1$. The sum becomes:\n$$ \\sum_{n=1}^{\\infty} \\frac{x^{n-1}t^{n}}{(n-1)!} = \\sum_{n=1}^{\\infty} n x^{n-1} \\frac{t^{n}}{n!} $$\nBy comparing the coefficients of $\\frac{t^n}{n!}$ in the two series, we obtain the identity:\n$$ B_{n}(x+1) - B_{n}(x) = n x^{n-1} \\quad \\text{for } n \\geq 1 $$\nFor the specific case of the sum of fifth powers, we are interested in $p=5$. We set $n=p+1=6$:\n$$ B_{6}(x+1) - B_{6}(x) = 6x^{5} $$\nWe sum this identity for integer values of $x$ from $k=0$ to $N$:\n$$ \\sum_{k=0}^{N} [B_{6}(k+1) - B_{6}(k)] = \\sum_{k=0}^{N} 6k^{5} = 6 \\sum_{k=0}^{N} k^{5} $$\nThe left-hand side is a telescoping sum:\n$$ (B_6(1) - B_6(0)) + (B_6(2) - B_6(1)) + \\dots + (B_6(N+1) - B_6(N)) = B_6(N+1) - B_6(0) $$\nThus, we have:\n$$ 6 \\sum_{k=0}^{N} k^{5} = B_{6}(N+1) - B_{6}(0) $$\nSince $0^5=0$, the sum from $k=1$ to $N$ is the same as from $k=0$ to $N$. The desired sum is therefore:\n$$ \\sum_{k=1}^{N} k^{5} = \\frac{1}{6} [B_{6}(N+1) - B_{6}(0)] $$\n\n**Calculation of Bernoulli Numbers**\n\nTo evaluate this expression, we need the Bernoulli numbers $B_k$ for $k \\le 6$. We can derive a recurrence relation from the definition $\\frac{t}{\\exp(t)-1} = \\sum_{n=0}^{\\infty} B_n \\frac{t^n}{n!}$. Multiplying by $\\exp(t)-1$ gives $t = (\\sum_{j=1}^{\\infty} \\frac{t^j}{j!})(\\sum_{k=0}^{\\infty} B_k \\frac{t^k}{k!})$. For $n \\ge 2$, the coefficient of $t^n$ on the left side is $0$. On the right side, it is $\\sum_{k=0}^{n-1} \\frac{1}{(n-k)!} \\frac{B_k}{k!}$. Equating and multiplying by $n!$ yields the recurrence $\\sum_{k=0}^{n-1} \\binom{n}{k}B_k = 0$ for $n \\ge 2$.\nFrom the definition, we find $B_0=1$. The problem states the convention $B_1 = -1/2$.\n- For $n=3$: $\\binom{3}{0}B_0 + \\binom{3}{1}B_1 + \\binom{3}{2}B_2 = 0 \\implies 1(1) + 3(-1/2) + 3B_2 = 0 \\implies -1/2 + 3B_2 = 0 \\implies B_2 = 1/6$.\n- The function $\\frac{t}{\\exp(t)-1} - B_1 t = \\frac{t}{\\exp(t)-1} + \\frac{t}{2}$ is an even function, which implies $B_n=0$ for all odd $n \\ge 3$. Thus, $B_3=0$ and $B_5=0$.\n- For $n=5$: $\\binom{5}{0}B_0 + \\binom{5}{1}B_1 + \\binom{5}{2}B_2 + \\binom{5}{3}B_3 + \\binom{5}{4}B_4 = 0 \\implies 1(1) + 5(-1/2) + 10(1/6) + 10(0) + 5B_4 = 0 \\implies 1 - 5/2 + 5/3 + 5B_4 = 0 \\implies 1/6 + 5B_4 = 0 \\implies B_4 = -1/30$.\n- For $n=7$: $\\sum_{k=0}^6 \\binom{7}{k}B_k=0$. Using $B_3=B_5=0$, we have $\\binom{7}{0}B_0 + \\binom{7}{1}B_1 + \\binom{7}{2}B_2 + \\binom{7}{4}B_4 + \\binom{7}{6}B_6 = 0$.\n$1(1) + 7(-1/2) + 21(1/6) + 35(-1/30) + 7B_6 = 0 \\implies 1 - 7/2 + 7/2 - 7/6 + 7B_6 = 0 \\implies -1/6 + 7B_6 = 0 \\implies B_6 = 1/42$.\n\nThe required Bernoulli numbers are: $B_0=1$, $B_1=-1/2$, $B_2=1/6$, $B_3=0$, $B_4=-1/30$, $B_5=0$, $B_6=1/42$.\n\n**Denominator Check with von Staudt-Clausen Theorem**\n\nThe von Staudt-Clausen theorem states that for $m \\ge 1$, the denominator of the Bernoulli number $B_{2m}$ is the product of all primes $p$ such that $p-1$ divides $2m$.\n- For $B_2$ ($2m=2$): primes $p$ with $(p-1)|2$. $p-1 \\in \\{1,2\\} \\implies p \\in \\{2,3\\}$. Denominator is $2 \\times 3=6$. $B_2=1/6$. This is correct.\n- For $B_4$ ($2m=4$): primes $p$ with $(p-1)|4$. $p-1 \\in \\{1,2,4\\} \\implies p \\in \\{2,3,5\\}$. Denominator is $2 \\times 3 \\times 5=30$. $B_4=-1/30$. This is correct.\n- For $B_6$ ($2m=6$): primes $p$ with $(p-1)|6$. $p-1 \\in \\{1,2,3,6\\} \\implies p \\in \\{2,3,7\\}$. Denominator is $2 \\times 3 \\times 7=42$. $B_6=1/42$. This is correct.\n\n**Final Expression for the Sum**\n\nThe Bernoulli polynomial $B_n(x)$ is given by $B_n(x) = \\sum_{k=0}^n \\binom{n}{k} B_k x^{n-k}$. For $n=6$:\n$$ B_6(x) = \\binom{6}{0}B_0 x^6 + \\binom{6}{1}B_1 x^5 + \\binom{6}{2}B_2 x^4 + \\binom{6}{3}B_3 x^3 + \\binom{6}{4}B_4 x^2 + \\binom{6}{5}B_5 x + \\binom{6}{6}B_6 $$\n$$ B_6(x) = 1(1)x^6 + 6(-1/2)x^5 + 15(1/6)x^4 + 20(0)x^3 + 15(-1/30)x^2 + 6(0)x + 1(1/42) $$\n$$ B_6(x) = x^6 - 3x^5 + \\frac{5}{2}x^4 - \\frac{1}{2}x^2 + \\frac{1}{42} $$\nWe need $\\frac{1}{6}[B_6(N+1) - B_6(0)]$.\n$B_6(0) = B_6 = 1/42$.\n$$ B_6(N+1) - B_6(0) = \\left((N+1)^6 - 3(N+1)^5 + \\frac{5}{2}(N+1)^4 - \\frac{1}{2}(N+1)^2 + \\frac{1}{42}\\right) - \\frac{1}{42} $$\n$$ = (N+1)^6 - 3(N+1)^5 + \\frac{5}{2}(N+1)^4 - \\frac{1}{2}(N+1)^2 $$\nExpanding these terms:\n$$ (N+1)^6 = N^6 + 6N^5 + 15N^4 + 20N^3 + 15N^2 + 6N + 1 $$\n$$ -3(N+1)^5 = -3(N^5 + 5N^4 + 10N^3 + 10N^2 + 5N + 1) = -3N^5 - 15N^4 - 30N^3 - 30N^2 - 15N - 3 $$\n$$ \\frac{5}{2}(N+1)^4 = \\frac{5}{2}(N^4 + 4N^3 + 6N^2 + 4N + 1) = \\frac{5}{2}N^4 + 10N^3 + 15N^2 + 10N + \\frac{5}{2} $$\n$$ -\\frac{1}{2}(N+1)^2 = -\\frac{1}{2}(N^2 + 2N + 1) = -\\frac{1}{2}N^2 - N - \\frac{1}{2} $$\nSumming these polynomials:\n$$ N^6 + (6-3)N^5 + (15-15+5/2)N^4 + (20-30+10)N^3 + (15-30+15-1/2)N^2 + (6-15+10-1)N + (1-3+5/2-1/2) $$\n$$ = N^6 + 3N^5 + \\frac{5}{2}N^4 + 0 \\cdot N^3 - \\frac{1}{2}N^2 + 0 \\cdot N + 0 = N^6 + 3N^5 + \\frac{5}{2}N^4 - \\frac{1}{2}N^2 $$\nThe sum is therefore:\n$$ \\sum_{k=1}^{N} k^{5} = \\frac{1}{6}\\left(N^6 + 3N^5 + \\frac{5}{2}N^4 - \\frac{1}{2}N^2\\right) $$\n$$ = \\frac{1}{6}N^6 + \\frac{1}{2}N^5 + \\frac{5}{12}N^4 - \\frac{1}{12}N^2 = \\frac{2N^6 + 6N^5 + 5N^4 - N^2}{12} $$\n\n**Verification by Induction**\n\nLet $S_5(N) = \\frac{2N^6 + 6N^5 + 5N^4 - N^2}{12}$.\n**Base Case ($N=1$):**\n$\\sum_{k=1}^1 k^5 = 1^5 = 1$.\n$S_5(1) = \\frac{2(1)^6 + 6(1)^5 + 5(1)^4 - (1)^2}{12} = \\frac{2+6+5-1}{12} = \\frac{12}{12} = 1$. The base case holds.\n\n**Inductive Step:**\nAssume $S_5(N) = \\sum_{k=1}^N k^5$ for some integer $N \\ge 1$. We must show that $S_5(N+1) = \\sum_{k=1}^{N+1} k^5$.\nThis is equivalent to showing $S_5(N+1) - S_5(N) = (N+1)^5$.\nLet's compute the difference $S_5(N+1) - S_5(N)$:\n$$ \\frac{2}{12}((N+1)^6 - N^6) + \\frac{6}{12}((N+1)^5 - N^5) + \\frac{5}{12}((N+1)^4 - N^4) - \\frac{1}{12}((N+1)^2 - N^2) $$\nUsing the binomial expansion differences:\n$$ (N+1)^6 - N^6 = 6N^5 + 15N^4 + 20N^3 + 15N^2 + 6N + 1 $$\n$$ (N+1)^5 - N^5 = 5N^4 + 10N^3 + 10N^2 + 5N + 1 $$\n$$ (N+1)^4 - N^4 = 4N^3 + 6N^2 + 4N + 1 $$\n$$ (N+1)^2 - N^2 = 2N + 1 $$\nSubstituting these into the difference expression and grouping terms by powers of $N$:\n$$ N^5 \\text{ term: } \\frac{2}{12}(6N^5) = N^5 $$\n$$ N^4 \\text{ term: } \\frac{2}{12}(15N^4) + \\frac{6}{12}(5N^4) = \\frac{30+30}{12}N^4 = 5N^4 $$\n$$ N^3 \\text{ term: } \\frac{2}{12}(20N^3) + \\frac{6}{12}(10N^3) + \\frac{5}{12}(4N^3) = \\frac{40+60+20}{12}N^3 = 10N^3 $$\n$$ N^2 \\text{ term: } \\frac{2}{12}(15N^2) + \\frac{6}{12}(10N^2) + \\frac{5}{12}(6N^2) = \\frac{30+60+30}{12}N^2 = 10N^2 $$\n$$ N^1 \\text{ term: } \\frac{2}{12}(6N) + \\frac{6}{12}(5N) + \\frac{5}{12}(4N) - \\frac{1}{12}(2N) = \\frac{12+30+20-2}{12}N = 5N $$\n$$ \\text{Constant term: } \\frac{2}{12}(1) + \\frac{6}{12}(1) + \\frac{5}{12}(1) - \\frac{1}{12}(1) = \\frac{2+6+5-1}{12} = 1 $$\nSumming these terms, we get $S_5(N+1) - S_5(N) = N^5 + 5N^4 + 10N^3 + 10N^2 + 5N + 1$, which is the binomial expansion of $(N+1)^5$.\nThe inductive step is proven. Thus, the derived formula is correct for all integers $N \\geq 1$.\nThe final expression is the rational polynomial in $N$ that we derived.", "answer": "$$ \\boxed{ \\frac{2N^6 + 6N^5 + 5N^4 - N^2}{12} } $$", "id": "3009007"}, {"introduction": "Having explored a classical application, we now turn to the structural properties of the Bernoulli numbers themselves. This exercise guides you through a sketch of the proof of the celebrated von Staudt-Clausen theorem, which precisely describes the denominators of the Bernoulli numbers $B_n$ for even $n$ [@problem_id:3009011]. By comparing two distinct evaluations of the power sum $\\sum_{a=1}^{p-1} a^{n}$ modulo a prime $p$, you will uncover the remarkable connection between the cyclic structure of the multiplicative group $(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$ and the primes appearing in the denominator of $B_n$.", "problem": "Let $\\{B_{n}\\}_{n\\geq 0}$ be the Bernoulli numbers defined by the exponential generating function\n$$\\frac{x}{\\exp(x)-1}=\\sum_{n=0}^{\\infty} B_{n}\\,\\frac{x^{n}}{n!}.$$\nUsing only this definition and the foundational fact that the multiplicative group of integers modulo a prime $p$, denoted $(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$, is cyclic of order $p-1$, analyze the behavior of the rational parts that can appear in $B_{n}$ for even $n\\geq 2$ by comparing the two evaluations of the sum $\\sum_{a=1}^{p-1} a^{n}$: one from group structure and one from the polynomial expression given by the Bernoulli numbers via the finite sums-of-powers relation. Explain why any prime $p$ with $p-1\\mid n$ contributes a term of the form $\\frac{1}{p}$ to the fractional part of $B_{n}$ and why no higher powers of $p$ can occur in the denominator. Then, compute the denominator of $B_{30}$ by listing all primes $p$ such that $p-1\\mid 30$ and verifying each appears to exponent one. Provide the denominator of $B_{30}$ as a single integer in lowest terms. No rounding is required.", "solution": "The problem requires us to derive the essential content of the von Staudt-Clausen theorem by comparing two different ways of evaluating the sum of powers $S_n(p-1) = \\sum_{a=1}^{p-1} a^n$ modulo a prime $p$, and then to apply this result to find the denominator of $B_{30}$. The argument proceeds by induction on $n$.\n\nLet $n \\ge 2$ be an even integer. The inductive hypothesis is that for any even integer $m$ with $2 \\le m < n$, the denominator of $B_m$ is square-free, and a prime $q$ divides the denominator of $B_m$ if and only if $q-1$ divides $m$. This is equivalent to stating that for any prime $q$, the $q$-adic valuation $v_q(B_m)$ satisfies:\n$v_q(B_m) = -1$ if $q-1 \\mid m$.\n$v_q(B_m) \\ge 0$ if $q-1 \\nmid m$.\nThe base cases, such as $B_2 = \\frac{1}{6}$, $B_4 = -\\frac{1}{30}$, $B_6 = \\frac{1}{42}$, can be verified to satisfy this hypothesis.\n\nWe will now analyze $B_n$ for a given prime $p$.\n\n**Part 1: Evaluation of $\\sum_{a=1}^{p-1} a^n$ using Group Theory**\n\nLet $S_n(p-1) = \\sum_{a=1}^{p-1} a^n$. We consider this sum modulo $p$. The set $\\{1, 2, \\dots, p-1\\}$ forms the multiplicative group $(\\mathbb{Z}/p\\mathbb{Z})^\\times$, which is cyclic of order $p-1$.\n\nCase 1: $p-1 \\mid n$.\nSince $n$ is a multiple of the order of the group, for any element $a \\in (\\mathbb{Z}/p\\mathbb{Z})^\\times$, Lagrange's theorem implies $a^{p-1} \\equiv 1 \\pmod{p}$. As $n = k(p-1)$ for some integer $k \\ge 1$, we have $a^n = (a^{p-1})^k \\equiv 1^k \\equiv 1 \\pmod{p}$.\nThe sum becomes:\n$$S_n(p-1) = \\sum_{a=1}^{p-1} a^n \\equiv \\sum_{a=1}^{p-1} 1 \\equiv p-1 \\equiv -1 \\pmod{p}$$\n\nCase 2: $p-1 \\nmid n$.\nLet $g$ be a generator of the cyclic group $(\\mathbb{Z}/p\\mathbb{Z})^\\times$. The elements $\\{1, 2, \\dots, p-1\\}$ are congruent to $\\{g^0, g^1, \\dots, g^{p-2}\\}$ modulo $p$.\nThe sum is a geometric series:\n$$S_n(p-1) = \\sum_{a=1}^{p-1} a^n \\equiv \\sum_{j=0}^{p-2} (g^j)^n = \\sum_{j=0}^{p-2} (g^n)^j \\pmod{p}$$\nSince $g$ is a generator and $p-1 \\nmid n$, we have $g^n \\not\\equiv 1 \\pmod{p}$. Thus, we can use the formula for a geometric sum:\n$$S_n(p-1) \\equiv \\frac{(g^n)^{p-1} - 1}{g^n - 1} = \\frac{(g^{p-1})^n - 1}{g^n - 1} \\equiv \\frac{1^n - 1}{g^n - 1} \\equiv 0 \\pmod{p}$$\n\nIn summary, for any prime $p$ and even $n \\ge 2$:\n$$S_n(p-1) = \\sum_{a=1}^{p-1} a^n \\equiv \\begin{cases} -1 \\pmod{p} & \\text{if } p-1 \\mid n \\\\ 0 \\pmod{p} & \\text{if } p-1 \\nmid n \\end{cases}$$\n\n**Part 2: Evaluation of $\\sum_{a=1}^{p-1} a^n$ using Faulhaber's Formula**\n\nFaulhaber's formula relates the sum of powers to Bernoulli numbers:\n$$\\sum_{a=0}^{N-1} a^n = \\frac{1}{n+1} \\sum_{k=0}^{n} \\binom{n+1}{k} B_k N^{n+1-k}$$\nSetting $N=p$ and noting that $0^n=0$ for $n \\ge 2$, we get:\n$$S_n(p-1) = \\sum_{a=1}^{p-1} a^n = \\frac{1}{n+1} \\sum_{k=0}^{n} \\binom{n+1}{k} B_k p^{n+1-k}$$\nMultiplying by $n+1$ and isolating the term with $B_n$ ($k=n$):\n$$(n+1) S_n(p-1) = \\binom{n+1}{n} B_n p + \\sum_{k=0}^{n-1} \\binom{n+1}{k} B_k p^{n+1-k}$$\n$$(n+1) S_n(p-1) = (n+1) p B_n + \\sum_{k=0}^{n-1} \\binom{n+1}{k} B_k p^{n+1-k}$$\nThis is an identity in the field of rational numbers $\\mathbb{Q}$. Let us analyze this identity in the ring of $p$-adic integers $\\mathbb{Z}_p$, which consists of rational numbers whose denominator is not divisible by $p$. A congruence $x \\equiv y \\pmod{p^k}$ means that $v_p(x-y) \\ge k$.\n\nLet $\\Sigma = \\sum_{k=0}^{n-1} \\binom{n+1}{k} B_k p^{n+1-k}$. We examine the $p$-adic valuation of each term in $\\Sigma$. For $k \\le n-1$, the exponent of $p$ is $n+1-k \\ge 2$.\nThe term for $k=1$ is $\\binom{n+1}{1} B_1 p^n = (n+1)(-\\frac{1}{2})p^n$ (since $B_1=-1/2$ from the given generating function). For $p \\neq 2$ and $n \\ge 2$, this term is an integer multiple of $p^2$. If $p=2$, the case is handled later.\nFor odd $k > 1$, $B_k=0$, so these terms vanish.\nFor an even $k$ with $0 \\le k < n$, we use the inductive hypothesis on $B_k$.\nIf $p-1 \\nmid k$, then $v_p(B_k) \\ge 0$. The exponent of $p$ is $n+1-k \\ge 2$. Thus, the term $\\binom{n+1}{k} B_k p^{n+1-k}$ has a $p$-adic valuation of at least $2$.\nIf $p-1 \\mid k$, then $v_p(B_k) = -1$. The term's valuation is $v_p(\\binom{n+1}{k}) - 1 + (n+1-k) = v_p(\\binom{n+1}{k}) + n-k$. Since $k \\le n-2$ for the next smallest even integer, $n-k \\ge 2$. So the valuation is at least $2$.\nTherefore, every term in $\\Sigma$ has a $p$-adic valuation of at least $2$ (with special care for $p=2$, but the conclusion holds). This implies $\\Sigma \\equiv 0 \\pmod{p^2}$ in the $p$-adic sense.\n\nOur identity becomes:\n$$(n+1) S_n(p-1) \\equiv (n+1) p B_n \\pmod{p^2}$$\n\n**Part 3: Combining the Results**\n\nWe now compare the two expressions for $S_n(p-1)$.\n\nCase A: $p-1 \\mid n$.\nFrom Part 1, $S_n(p-1) = -1 + c p$ for some integer $c$.\nSubstituting this into our congruence:\n$$(n+1)(-1+cp) \\equiv (n+1)pB_n \\pmod{p^2}$$\n$$-(n+1) + (n+1)cp \\equiv (n+1)pB_n \\pmod{p^2}$$\nIf $p \\nmid n+1$, we can divide by $n+1$:\n$$-1 + cp \\equiv pB_n \\pmod{p^2}$$\nThis implies $-1 \\equiv pB_n \\pmod p$. In terms of $p$-adic valuation, this means $v_p(pB_n + 1) \\ge 1$. Since $v_p(1)=0$, this can only be true if $v_p(pB_n) = 0$. So $v_p(p) + v_p(B_n) = 0$, which gives $1+v_p(B_n)=0$, or $v_p(B_n)=-1$.\nIf $p \\mid n+1$, then $p-1 \\le n < n+1$. Since $p-1|n$, we must have $p-1 \\le n$. $n+1 \\equiv 0 \\pmod p$ means $n \\equiv -1 \\equiv p-1 \\pmod p$. So $p-1$ must be a multiple of $p$, which is impossible. Or $n = k(p-1)$, so $k(p-1) \\equiv -1 \\pmod p \\implies -k \\equiv -1 \\pmod p \\implies k \\equiv 1 \\pmod p$. The condition $p | n+1$ implies $k(p-1)+1 \\equiv 0 \\pmod p \\implies -k+1 \\equiv 0 \\pmod p \\implies k \\equiv 1 \\pmod p$. The logic remains sound; the congruence $-(n+1) \\equiv (n+1)pB_n \\pmod{p^2}$ implies $v_p(-(n+1)) = v_p((n+1)pB_n)$, so $v_p(n+1) = v_p(n+1)+1+v_p(B_n)$, which gives $v_p(B_n)=-1$.\n\nIn all subcases of $p-1 \\mid n$, we have $v_p(B_n)=-1$. This means $p$ appears in the denominator of $B_n$ with exponent exactly 1.\n\nCase B: $p-1 \\nmid n$.\nFrom Part 1, $S_n(p-1) \\equiv 0 \\pmod p$, so $S_n(p-1) = dp$ for some integer $d$.\n$$(n+1)dp \\equiv (n+1)pB_n \\pmod{p^2}$$\nIf $p \\nmid n+1$, we can divide by $p(n+1)$:\n$$d \\equiv B_n \\pmod p$$\nSince $d$ is an integer, $B_n$ is congruent to an integer modulo $p$, which means $B_n$ is a $p$-adic integer, i.e., $v_p(B_n) \\ge 0$.\nIf $p \\mid n+1$, the congruence is $(n+1)p d \\equiv (n+1)p B_n \\pmod{p^2}$, which holds for any $p$-adic integer $B_n$. However, returning to $(n+1)S_n = (n+1)pB_n + \\Sigma$, we have $v_p((n+1)S_n) \\ge v_p(n+1)+1$ and $v_p(\\Sigma) \\ge 2$. This implies $v_p((n+1)pB_n) \\ge \\min(v_p(n+1)+1, 2)$. Thus $v_p(n+1)+1+v_p(B_n) \\ge v_p(n+1)+1$, which implies $v_p(B_n) \\ge 0$.\n\nIn all subcases of $p-1 \\nmid n$, we have $v_p(B_n) \\ge 0$. This means $p$ does not appear in the denominator of $B_n$.\nThis completes the inductive proof of the von Staudt-Clausen theorem.\n\n**Part 4: Denominator of $B_{30}$**\n\nBased on the derived theorem, the denominator of $B_n$ for even $n \\ge 2$ is the product of all prime numbers $p$ such that $p-1$ divides $n$. We are asked to find the denominator of $B_{30}$. Here, $n=30$.\nWe need to find all primes $p$ such that $p-1$ is a divisor of $30$.\nThe divisors of $30$ are $1, 2, 3, 5, 6, 10, 15, 30$.\nWe check each corresponding value of $p=d+1$ for each divisor $d$:\n-   $d=1: p = 1+1 = 2$. $2$ is a prime.\n-   $d=2: p = 2+1 = 3$. $3$ is a prime.\n-   $d=3: p = 3+1 = 4$. $4$ is not a prime.\n-   $d=5: p = 5+1 = 6$. $6$ is not a prime.\n-   $d=6: p = 6+1 = 7$. $7$ is a prime.\n-   $d=10: p = 10+1 = 11$. $11$ is a prime.\n-   $d=15: p = 15+1 = 16$. $16$ is not a prime.\n-   $d=30: p = 30+1 = 31$. $31$ is a prime.\n\nThe set of primes is $\\{2, 3, 7, 11, 31\\}$.\nThe denominator of $B_{30}$ is the product of these primes:\n$$\\text{Denominator} = 2 \\times 3 \\times 7 \\times 11 \\times 31$$\n$$= 6 \\times 7 \\times 11 \\times 31$$\n$$= 42 \\times 11 \\times 31$$\n$$= 462 \\times 31$$\n$$= 14322$$\nThe denominator of $B_{30}$ is $14322$.", "answer": "$$\n\\boxed{14322}\n$$", "id": "3009011"}, {"introduction": "The von Staudt-Clausen theorem is not just an abstract statement about fractions; its consequences permeate number theory, particularly in the study of congruences. This final practice explores the concept of $p$-integrality and the meaning of reducing a rational number modulo a prime $p$ [@problem_id:3009016]. You will see firsthand how the theorem determines whether a Bernoulli number $B_n$ has a well-defined representation in a finite field $\\mathbb{Z}/p\\mathbb{Z}$, linking the structure of its denominator to its behavior under the lens of modular arithmetic.", "problem": "Let $B_n$ denote the Bernoulli numbers characterized by the exponential generating function $x/(\\exp(x)-1)=\\sum_{n\\ge 0} B_n \\, x^n/n!$, and equivalently by the recurrence that for each integer $n\\ge 1$,\n$$\\sum_{k=0}^{n} \\binom{n+1}{k} \\, B_k \\;=\\; 0,$$\nwith $B_0=1$. Work entirely in the finite field $\\mathbb{Z}/13\\mathbb{Z}$ by interpreting division by any integer $d$ as multiplication by its inverse modulo $13$ whenever $\\gcd(d,13)=1$. \n\n- Using the recurrence above, compute $B_{10}$ modulo $13$ by determining the values of $B_n \\bmod 13$ successively for $n=1,2,\\dots,10$. \n- Then, invoking the von Staudtâ€“Clausen theorem (which states that for even $n=2m\\ge 2$, the fractional part of $B_{2m}$ equals $-\\sum_{p\\,:\\, (p-1)\\mid 2m} \\frac{1}{p}$, so the denominator of $B_{2m}$ in lowest terms is the product of the primes $p$ with $(p-1)\\mid 2m$), explain whether the reduction modulo $13$ of $B_{12}$ is well-defined in $\\mathbb{Z}/13\\mathbb{Z}$ and why.\n\nProvide as your final answer only the residue class of $B_{10}$ modulo $13$, expressed as a single integer in the set $\\{0,1,\\dots,12\\}$.", "solution": "First, we compute the values of $B_n \\pmod{13}$ for $n=1, 2, \\dots, 10$ using the given recurrence relation $\\sum_{k=0}^{n} \\binom{n+1}{k} B_k = 0$ for $n \\ge 1$, with $B_0=1$. All calculations are performed in the finite field $\\mathbb{Z}/13\\mathbb{Z}$.\n\nThe recurrence can be rearranged to solve for $B_n$:\n$$ \\binom{n+1}{n} B_n = - \\sum_{k=0}^{n-1} \\binom{n+1}{k} B_k $$\n$$ (n+1) B_n = - \\sum_{k=0}^{n-1} \\binom{n+1}{k} B_k $$\nFor $n < 12$, $n+1$ is not a multiple of $13$, so its inverse $(n+1)^{-1}$ exists in $\\mathbb{Z}/13\\mathbb{Z}$.\n$$ B_n = -(n+1)^{-1} \\sum_{k=0}^{n-1} \\binom{n+1}{k} B_k $$\nWe are given $B_0=1$.\n\nFor $n=1$:\n$ \\binom{2}{0}B_0 + \\binom{2}{1}B_1 = 0 \\implies 1 \\cdot 1 + 2B_1 = 0 \\implies 2B_1 \\equiv -1 \\equiv 12 \\pmod{13}$.\nThe inverse of $2$ is $7$ since $2 \\cdot 7 = 14 \\equiv 1$. Thus, $B_1 \\equiv 12 \\cdot 7 = 84 \\equiv 6 \\pmod{13}$.\n\nFor $n=2$:\n$ \\binom{3}{0}B_0 + \\binom{3}{1}B_1 + \\binom{3}{2}B_2 = 0 \\implies 1 \\cdot 1 + 3 \\cdot 6 + 3B_2 = 0 \\implies 1+18+3B_2 \\equiv 1+5+3B_2=0$.\n$6+3B_2=0 \\implies 3B_2 \\equiv -6 \\equiv 7 \\pmod{13}$.\nThe inverse of $3$ is $9$ since $3 \\cdot 9 = 27 \\equiv 1$. Thus, $B_2 \\equiv 7 \\cdot 9 = 63 \\equiv 11 \\pmod{13}$.\n\nIt is a standard property of Bernoulli numbers that $B_{2k+1}=0$ for $k \\ge 1$. The convention used here, with $B_1=-1/2$, aligns with this. As a verification:\nFor $n=3$:\n$\\binom{4}{0}B_0 + \\binom{4}{1}B_1 + \\binom{4}{2}B_2 + \\binom{4}{3}B_3 = 0 \\implies 1\\cdot 1 + 4\\cdot 6 + 6\\cdot 11 + 4B_3 = 0$.\n$1+24+66+4B_3 \\equiv 1+11+1+4B_3 = 0 \\implies 13+4B_3=0 \\implies 4B_3=0$.\nSince $4 \\not\\equiv 0 \\pmod{13}$, we must have $B_3 \\equiv 0 \\pmod{13}$.\nThis implies $B_3=B_5=B_7=B_9 \\equiv 0 \\pmod{13}$. This simplifies the subsequent calculations.\n\nFor $n=4$:\n$\\binom{5}{0}B_0+\\binom{5}{1}B_1+\\binom{5}{2}B_2+\\binom{5}{4}B_4 = 0$ (since $B_3=0$).\n$1\\cdot 1 + 5\\cdot 6 + 10\\cdot 11 + 5B_4 = 0 \\implies 1+30+110+5B_4 \\equiv 1+4+6+5B_4=0$.\n$11+5B_4=0 \\implies 5B_4 \\equiv -11 \\equiv 2 \\pmod{13}$.\nThe inverse of $5$ is $8$ since $5 \\cdot 8=40 \\equiv 1$. Thus, $B_4 \\equiv 2 \\cdot 8 = 16 \\equiv 3 \\pmod{13}$.\n\nFor $n=6$:\n$\\binom{7}{0}B_0+\\binom{7}{1}B_1+\\binom{7}{2}B_2+\\binom{7}{4}B_4+\\binom{7}{6}B_6=0$.\nCoefficients mod $13$: $\\binom{7}{1}=7$, $\\binom{7}{2}=21\\equiv 8$, $\\binom{7}{4}=35\\equiv 9$, $\\binom{7}{6}=7$.\n$1\\cdot 1 + 7\\cdot 6 + 8\\cdot 11 + 9\\cdot 3 + 7B_6 = 0 \\implies 1+42+88+27+7B_6 \\equiv 1+3+10+1+7B_6 = 0$.\n$15+7B_6=0 \\implies 2+7B_6=0 \\implies 7B_6 \\equiv -2 \\equiv 11$.\nThe inverse of $7$ is $2$. Thus, $B_6 \\equiv 11 \\cdot 2 = 22 \\equiv 9 \\pmod{13}$.\n\nFor $n=8$:\n$\\binom{9}{0}B_0+\\binom{9}{1}B_1+\\binom{9}{2}B_2+\\binom{9}{4}B_4+\\binom{9}{6}B_6+\\binom{9}{8}B_8=0$.\nCoefficients mod $13$: $\\binom{9}{1}=9$, $\\binom{9}{2}=36\\equiv 10$, $\\binom{9}{4}=126\\equiv 9$, $\\binom{9}{6}=84\\equiv 6$, $\\binom{9}{8}=9$.\n$1\\cdot 1 + 9\\cdot 6 + 10\\cdot 11 + 9\\cdot 3 + 6\\cdot 9 + 9B_8 = 0 \\implies 1+54+110+27+54+9B_8 \\equiv 1+2+6+1+2+9B_8=0$.\n$12+9B_8=0 \\implies 9B_8 \\equiv -12 \\equiv 1$.\nThe inverse of $9$ is $3$. Thus, $B_8 \\equiv 1 \\cdot 3 = 3 \\pmod{13}$.\n\nFor $n=10$:\n$\\binom{11}{0}B_0+\\binom{11}{1}B_1+\\binom{11}{2}B_2+\\binom{11}{4}B_4+\\binom{11}{6}B_6+\\binom{11}{8}B_8+\\binom{11}{10}B_{10}=0$.\nCoefficients mod $13$: $\\binom{11}{1}=11\\equiv -2$, $\\binom{11}{2}=55\\equiv 3$, $\\binom{11}{4}=330\\equiv 5$, $\\binom{11}{5}=462\\equiv 7$, $\\binom{11}{6}=\\binom{11}{5}\\equiv 7$, $\\binom{11}{8}=\\binom{11}{3}=165\\equiv 9$, $\\binom{11}{10}=\\binom{11}{1}\\equiv 11\\equiv -2$.\n$1\\cdot 1 + (-2)\\cdot 6 + 3\\cdot 11 + 5\\cdot 3 + 7\\cdot 9 + 9\\cdot 3 + (-2)B_{10} = 0$.\n$1 - 12 + 33 + 15 + 63 + 27 - 2B_{10} \\equiv 1 + 1 + 7 + 2 + 11 + 1 - 2B_{10} = 0$.\nThe sum is $1+1+7+2+11+1 = 23 \\equiv 10$.\nSo, $10 - 2B_{10} = 0 \\implies 2B_{10} \\equiv 10$.\nMultiplying by $2^{-1} \\equiv 7$, we get $B_{10} \\equiv 10 \\cdot 7 = 70 \\equiv 5 \\pmod{13}$.\n\nSecond, we explain the status of $B_{12}$ modulo $13$.\nA rational number, such as a Bernoulli number $B_n$, has a well-defined reduction modulo a prime $p$ if and only if its denominator, when written in lowest terms, is not divisible by $p$. Such a rational number is called $p$-integral.\nThe von Staudtâ€“Clausen theorem provides the exact denominator of $B_{2m}$ for $m \\ge 1$. It states that the denominator of $B_{2m}$ is the product of all prime numbers $p$ such that $(p-1)$ divides $2m$.\nFor the case of $B_{12}$, we have $2m=12$. We need to find all primes $p$ for which $(p-1)$ divides $12$. The divisors of $12$ are $1, 2, 3, 4, 6, 12$. We examine $p-1$ for each of these divisors:\n- $p-1=1 \\implies p=2$, which is prime.\n- $p-1=2 \\implies p=3$, which is prime.\n- $p-1=3 \\implies p=4$, which is not prime.\n- $p-1=4 \\implies p=5$, which is prime.\n- $p-1=6 \\implies p=7$, which is prime.\n- $p-1=12 \\implies p=13$, which is prime.\nThe primes satisfying the condition are $2, 3, 5, 7,$ and $13$. According to the theorem, the denominator of $B_{12}$ in lowest terms is the product $2 \\cdot 3 \\cdot 5 \\cdot 7 \\cdot 13 = 2730$.\nSince $13$ is a factor of the denominator of $B_{12}$, $B_{12}$ is not a $13$-integral rational number. Therefore, its reduction modulo $13$ is not well-defined. Trying to compute it in $\\mathbb{Z}/13\\mathbb{Z}$ would correspond to an undefined operation of division by zero.", "answer": "$$\\boxed{5}$$", "id": "3009016"}]}