{"hands_on_practices": [{"introduction": "The theory of complex multiplication establishes a profound connection between the ideal class groups of imaginary quadratic fields and the isomorphism classes of certain elliptic curves. This practice serves as a foundational exercise, grounding the abstract theory in concrete computation. By systematically enumerating reduced binary quadratic forms, you will compute the class number $h(D)$ for several fundamental discriminants [@problem_id:3010294], directly revealing the number of distinct CM elliptic curves for these cases and illustrating one of the first major theorems of the subject.", "problem": "Let $D<0$ be a negative fundamental discriminant and let $\\mathcal{O}_{D}$ denote the imaginary quadratic order of discriminant $D$ in the imaginary quadratic field $\\mathbb{Q}(\\sqrt{D})$. The ideal class group $\\mathrm{Cl}(\\mathcal{O}_{D})$ can be identified with the group of equivalence classes of primitive, positive definite, binary quadratic forms $f(x,y)=ax^{2}+bxy+cy^{2}$ of discriminant $D=b^{2}-4ac$ under the action of $\\mathrm{SL}_{2}(\\mathbb{Z})$, with composition given by Gauss composition. A form is called reduced if it satisfies the standard reduction inequalities for positive definite forms, namely $|b|\\leq a\\leq c$ and, in the cases $|b|=a$ or $a=c$, that $b\\geq 0$.\n\nStarting from these foundational definitions, determine the class groups $\\mathrm{Cl}(\\mathcal{O}_{D})$ for $D=-3$, $D=-4$, $D=-7$, and $D=-8$ by explicitly listing all reduced primitive positive definite binary quadratic forms of the corresponding discriminant and using Gauss’s correspondence to infer the group structure. Then, using the identification of $\\mathrm{Cl}(\\mathcal{O}_{D})$ with the set of isomorphism classes of complex tori with Complex Multiplication (CM) by $\\mathcal{O}_{D}$ (equivalently, the isomorphism classes of elliptic curves over $\\mathbb{C}$ whose endomorphism ring is $\\mathcal{O}_{D}$), explain why the sizes you obtain equal the number of distinct $j$-invariants arising from CM by $\\mathcal{O}_{D}$.\n\nYour final answer must be the row vector $\\big(h(-3),\\,h(-4),\\,h(-7),\\,h(-8)\\big)$, where $h(D)=|\\mathrm{Cl}(\\mathcal{O}_{D})|$ denotes the class number. No rounding is required.", "solution": "The problem as stated is valid. All provided definitions and statements are standard and correct within the context of algebraic number theory and the theory of complex multiplication. The problem is self-contained, consistent, and well-posed. We may proceed with the solution.\n\nThe problem asks for two parts: first, to compute the class number $h(D) = |\\mathrm{Cl}(\\mathcal{O}_{D})|$ for the fundamental discriminants $D = -3, -4, -7, -8$ by finding all reduced primitive positive definite binary quadratic forms; second, to explain the connection between this number and the number of distinct $j$-invariants of elliptic curves with complex multiplication (CM) by the order $\\mathcal{O}_{D}$.\n\nA binary quadratic form $f(x,y) = ax^2 + bxy + cy^2$ has discriminant $D = b^2 - 4ac$. For $D < 0$, the form is positive definite if $a > 0$. Such a form is called primitive if $\\gcd(a, b, c) = 1$. The set of equivalence classes of such forms under the action of $\\mathrm{SL}_{2}(\\mathbb{Z})$ forms a finite abelian group, a concrete realization of the ideal class group $\\mathrm{Cl}(\\mathcal{O}_D)$. Every class contains exactly one reduced form, which satisfies the conditions:\n$1.$ $|b| \\leq a \\leq c$\n$2.$ If $|b| = a$ or $a = c$, then $b \\geq 0$.\n\nFrom the discriminant equation $D = b^2 - 4ac$ and the reduction conditions, we can derive bounds on the coefficients. Since $a \\leq c$, we have $4a^2 \\leq 4ac = b^2 - D$. As $|b| \\leq a$, we have $b^2 \\leq a^2$. Combining these gives $4a^2 \\leq a^2 - D$, which simplifies to $3a^2 \\leq -D = |D|$. This yields an upper bound for the coefficient $a$:\n$$a \\leq \\sqrt{\\frac{|D|}{3}}$$\nSince $a$ must be a positive integer, this inequality makes the search for reduced forms finite. Furthermore, for a fundamental discriminant $D$, the coefficient $b$ must have the same parity as $D$, i.e., $b \\equiv D \\pmod{2}$.\n\nWe now enumerate the reduced forms for each given discriminant.\n\n**Case 1: $D = -3$**\nThis is a fundamental discriminant. We search for integer triples $(a, b, c)$ satisfying the conditions.\n- The bound on $a$ is $a \\leq \\sqrt{\\frac{|-3|}{3}} = \\sqrt{1} = 1$. Since $a>0$, we must have $a=1$.\n- The condition $|b| \\leq a$ implies $|b| \\leq 1$.\n- The discriminant $D=-3$ is odd, so $b$ must be odd. This leaves $b=1$ and $b=-1$.\n- For $b=1$: We calculate $c = \\frac{b^2 - D}{4a} = \\frac{1^2 - (-3)}{4(1)} = \\frac{4}{4} = 1$. The form is $(1, 1, 1)$.\n  - We check the reduction conditions: $|1| \\leq 1 \\leq 1$ is true. Since $a=c=1$, we must have $b \\geq 0$. $b=1$ satisfies this.\n  - The form is primitive as $\\gcd(1,1,1)=1$.\n  - Thus, $x^2 + xy + y^2$ is a reduced primitive form.\n- For $b=-1$: The form would be $(1,-1,1)$. Here, $a=c=1$, which requires $b \\geq 0$. This is not satisfied, so this form is not reduced.\nWe have found exactly one reduced form. Therefore, the class number is $h(-3) = 1$.\n\n**Case 2: $D = -4$**\nThis is a fundamental discriminant.\n- The bound on $a$ is $a \\leq \\sqrt{\\frac{|-4|}{3}} \\approx 1.15$. We must have $a=1$.\n- The condition $|b| \\leq a$ implies $|b| \\leq 1$.\n- The discriminant $D=-4$ is even, so $b$ must be even. This leaves only $b=0$.\n- For $b=0$: We calculate $c = \\frac{b^2 - D}{4a} = \\frac{0^2 - (-4)}{4(1)} = \\frac{4}{4} = 1$. The form is $(1, 0, 1)$.\n  - We check the reduction conditions: $|0| \\leq 1 \\leq 1$ is true. Since $a=c=1$, we must have $b \\geq 0$. $b=0$ satisfies this.\n  - The form is primitive as $\\gcd(1,0,1)=1$.\n  - Thus, $x^2 + y^2$ is a reduced primitive form.\nWe have found exactly one reduced form. Therefore, the class number is $h(-4) = 1$.\n\n**Case 3: $D = -7$**\nThis is a fundamental discriminant.\n- The bound on $a$ is $a \\leq \\sqrt{\\frac{|-7|}{3}} \\approx 1.52$. We must have $a=1$.\n- The condition $|b| \\leq a$ implies $|b| \\leq 1$.\n- The discriminant $D=-7$ is odd, so $b$ must be odd. This leaves $b=1$ and $b=-1$.\n- For $b=1$: We calculate $c = \\frac{b^2 - D}{4a} = \\frac{1^2 - (-7)}{4(1)} = \\frac{8}{4} = 2$. The form is $(1, 1, 2)$.\n  - We check the reduction conditions: $|1| \\leq 1 \\leq 2$ is true. Since $|b|=a=1$, we must have $b \\geq 0$. $b=1$ satisfies this.\n  - The form is primitive as $\\gcd(1,1,2)=1$.\n  - Thus, $x^2 + xy + 2y^2$ is a reduced primitive form.\n- For $b=-1$: The form is $(1,-1,2)$. Here $|b|=a=1$, which requires $b \\geq 0$. This is not satisfied.\nWe have found exactly one reduced form. Therefore, the class number is $h(-7) = 1$.\n\n**Case 4: $D = -8$**\nThis is a fundamental discriminant.\n- The bound on $a$ is $a \\leq \\sqrt{\\frac{|-8|}{3}} \\approx 1.63$. We must have $a=1$.\n- The condition $|b| \\leq a$ implies $|b| \\leq 1$.\n- The discriminant $D=-8$ is even, so $b$ must be even. This leaves only $b=0$.\n- For $b=0$: We calculate $c = \\frac{b^2 - D}{4a} = \\frac{0^2 - (-8)}{4(1)} = \\frac{8}{4} = 2$. The form is $(1, 0, 2)$.\n  - We check the reduction conditions: $|0| \\leq 1 \\leq 2$ is true. The boundary cases $|b|=a$ and $a=c$ do not apply.\n  - The form is primitive as $\\gcd(1,0,2)=1$.\n  - Thus, $x^2 + 2y^2$ is a reduced primitive form.\nWe have found exactly one reduced form. Therefore, the class number is $h(-8) = 1$.\n\nIn all four cases, the class number is $1$.\n\n**Connection to Complex Multiplication and $j$-invariants**\n\nThe theory of complex multiplication provides a profound link between the class groups of imaginary quadratic orders and the arithmetic of elliptic curves.\n\n$1$. An elliptic curve $E$ over the complex numbers $\\mathbb{C}$ is isomorphic to a complex torus $\\mathbb{C}/\\Lambda$ for some lattice $\\Lambda$. Any such lattice is homothetic to one of the form $\\Lambda_{\\tau} = \\mathbb{Z} + \\mathbb{Z}\\tau$ for a unique $\\tau$ in the fundamental domain of $\\mathrm{SL}_2(\\mathbb{Z})$ acting on the upper half-plane $\\mathbb{H}$. The isomorphism class of $E$ is uniquely determined by its $j$-invariant, $j(E) = j(\\tau)$.\n\n$2$. An elliptic curve $E$ is said to have Complex Multiplication (CM) by an order $\\mathcal{O}$ in an imaginary quadratic field if its endomorphism ring $\\mathrm{End}(E)$ is isomorphic to $\\mathcal{O}$. For a generic curve, $\\mathrm{End}(E) \\cong \\mathbb{Z}$.\n\n$3$. A key result of CM theory is that an elliptic curve $E \\cong \\mathbb{C}/(\\mathbb{Z} + \\mathbb{Z}\\tau)$ has CM by an order $\\mathcal{O}_D$ if and only if $\\tau$ is an element of the imaginary quadratic field $K = \\mathbb{Q}(\\sqrt{D})$.\n\n$4$. The set of isomorphism classes of elliptic curves with CM by a specific order $\\mathcal{O}_D$ is not arbitrary. There is a canonical bijection between the ideal class group $\\mathrm{Cl}(\\mathcal{O}_D)$ and the set of isomorphism classes of elliptic curves with CM by $\\mathcal{O}_D$. An ideal class $[\\mathfrak{a}] \\in \\mathrm{Cl}(\\mathcal{O}_D)$ corresponds to the isomorphism class of the elliptic curve $\\mathbb{C}/\\mathfrak{a}$. Two such curves $\\mathbb{C}/\\mathfrak{a}$ and $\\mathbb{C}/\\mathfrak{b}$ are isomorphic if and only if the ideals $\\mathfrak{a}$ and $\\mathfrak{b}$ are in the same ideal class.\n\n$5$. Combining these facts, the number of distinct isomorphism classes of elliptic curves with CM by $\\mathcal{O}_D$ is equal to the order of the class group, $h(D) = |\\mathrm{Cl}(\\mathcal{O}_D)|$. Since isomorphism classes over $\\mathbb{C}$ are in one-to-one correspondence with their $j$-invariants, it follows that the number of distinct $j$-invariants of elliptic curves with CM by $\\mathcal{O}_D$ is precisely $h(D)$.\n\nIn our examples, we found $h(-3) = 1$, $h(-4) = 1$, $h(-7) = 1$, and $h(-8) = 1$. This implies that for each of the corresponding orders $\\mathcal{O}_{-3}$, $\\mathcal{O}_{-4}$, $\\mathcal{O}_{-7}$, and $\\mathcal{O}_{-8}$, there is exactly one isomorphism class of elliptic curves with CM by that order, and thus a single, unique $j$-invariant. For instance:\n- For $D=-3$, the order is $\\mathcal{O}_{-3}=\\mathbb{Z}[\\frac{1+\\sqrt{-3}}{2}]$. The corresponding $j$-invariant is $j(\\frac{1+\\sqrt{-3}}{2}) = 0$.\n- For $D=-4$, the order is $\\mathcal{O}_{-4}=\\mathbb{Z}[\\sqrt{-1}]$. The corresponding $j$-invariant is $j(i) = 1728$.\nThe number of distinct $j$-invariants arising from CM by $\\mathcal{O}_D$ is $h(D)$, which we computed by counting reduced quadratic forms. This provides a direct bridge between these two enumerations.\n\nThe final answer is the row vector of the computed class numbers.\n$h(-3)=1$\n$h(-4)=1$\n$h(-7)=1$\n$h(-8)=1$\nSo the vector is $(1, 1, 1, 1)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 1 & 1 & 1\n\\end{pmatrix}\n}\n$$", "id": "3010294"}, {"introduction": "While the previous exercise focused on counting CM elliptic curves, this practice turns to identifying them via their most important invariant: the $j$-invariant. For CM elliptic curves corresponding to the highly symmetric Gaussian and Eisenstein integer lattices, the $j$-invariants take on special, and surprisingly simple, integer values. This exercise [@problem_id:3010320] guides you through a first-principles derivation of these famous singular moduli, $j(i)$ and $j(\\zeta_{3})$, by leveraging the rotational symmetries of their underlying lattices.", "problem": "Let $\\tau$ be an element of the complex upper half-plane, and let $E_{\\tau} = \\mathbb{C}/(\\mathbb{Z} + \\tau \\mathbb{Z})$ be the corresponding complex elliptic curve. Using the Weierstrass $\\wp$-function and the associated invariants, the absolute invariant $j(\\tau)$ is defined from the lattice invariants of $E_{\\tau}$ and is invariant under the action of $\\mathrm{SL}_{2}(\\mathbb{Z})$. Starting from the definitions of the lattice invariants and the absolute invariant (and without assuming special values), use the rotational symmetries of the lattices for $\\tau = i$ and $\\tau = \\zeta_{3}$ (a primitive cube root of unity) to compute $j(i)$ and $j(\\zeta_{3})$. Then, identify explicit short Weierstrass models over $\\mathbb{C}$ of elliptic curves having these $j$-invariants, and justify that your models realize the required invariants by relating them to the corresponding lattices and symmetries.\n\nYour final numerical answer should be the ordered pair $\\big(j(i), j(\\zeta_{3})\\big)$, presented as a row vector. No rounding is required.", "solution": "The problem asks for the computation of the $j$-invariants $j(i)$ and $j(\\zeta_3)$ and for the identification of corresponding elliptic curve models. We begin by recalling the fundamental definitions.\n\nFor $\\tau$ in the complex upper half-plane $\\mathbb{H}$, the corresponding lattice is $\\Lambda_{\\tau} = \\mathbb{Z} + \\tau\\mathbb{Z}$. The Weierstrass invariants, or Eisenstein series, associated with a lattice $\\Lambda$ are given by:\n$$g_2(\\Lambda) = 60 \\sum_{\\omega \\in \\Lambda \\setminus \\{0\\}} \\frac{1}{\\omega^4}$$\n$$g_3(\\Lambda) = 140 \\sum_{\\omega \\in \\Lambda \\setminus \\{0\\}} \\frac{1}{\\omega^6}$$\nThese invariants depend on the choice of lattice. The absolute invariant, or $j$-invariant, is defined in terms of $g_2$ and $g_3$:\n$$j(\\Lambda) = 1728 \\frac{g_2(\\Lambda)^3}{g_2(\\Lambda)^3 - 27 g_3(\\Lambda)^2}$$\nThe denominator is the discriminant of the lattice, $\\Delta(\\Lambda) = g_2(\\Lambda)^3 - 27 g_3(\\Lambda)^2$, which is non-zero for any lattice $\\Lambda$. We denote $g_2(\\Lambda_\\tau)$ as $g_2(\\tau)$, and likewise for $g_3$ and $j$.\n\nA crucial property of the invariants is their homogeneity. For any non-zero complex number $c \\in \\mathbb{C}^*$, the invariants of the scaled lattice $c\\Lambda$ are related to those of $\\Lambda$ by:\n$$g_2(c\\Lambda) = c^{-4} g_2(\\Lambda)$$\n$$g_3(c\\Lambda) = c^{-6} g_3(\\Lambda)$$\n\nAn elliptic curve $E_{\\Lambda} = \\mathbb{C}/\\Lambda$ is said to have complex multiplication (CM) if its endomorphism ring is strictly larger than $\\mathbb{Z}$. This occurs precisely when the lattice $\\Lambda$ possesses a rotational symmetry, i.e., there exists a non-integer $\\alpha \\in \\mathbb{C}$ such that $\\alpha\\Lambda \\subseteq \\Lambda$. The cases $\\tau=i$ and $\\tau=\\zeta_3$ are the canonical examples.\n\n**Computation of $j(i)$**\n\nLet $\\tau = i$. The corresponding lattice is $\\Lambda_i = \\mathbb{Z} + i\\mathbb{Z} = \\mathbb{Z}[i]$, the ring of Gaussian integers. This lattice is invariant under multiplication by $i$, since $i\\Lambda_i = i(\\mathbb{Z} + i\\mathbb{Z}) = i\\mathbb{Z} + i^2\\mathbb{Z} = i\\mathbb{Z} - \\mathbb{Z} = \\mathbb{Z} + i\\mathbb{Z} = \\Lambda_i$. The lattice exhibits a rotational symmetry of order $4$.\n\nWe apply the homogeneity property with the lattice $\\Lambda_i$ and the scaling factor $c=i$:\n$$g_2(i) = g_2(\\Lambda_i) = g_2(i\\Lambda_i) = i^{-4} g_2(\\Lambda_i) = 1 \\cdot g_2(\\Lambda_i) = g_2(i)$$\nThis relation is a tautology and provides no information about $g_2(i)$.\n$$g_3(i) = g_3(\\Lambda_i) = g_3(i\\Lambda_i) = i^{-6} g_3(\\Lambda_i) = (i^2)^3 g_3(\\Lambda_i) = (-1)^3 g_3(\\Lambda_i) = -g_3(i)$$\nThe relation $g_3(i) = -g_3(i)$ implies $2g_3(i)=0$, so $g_3(i)=0$.\n\nNow we can compute the $j$-invariant $j(i)$:\n$$j(i) = 1728 \\frac{g_2(i)^3}{g_2(i)^3 - 27 g_3(i)^2} = 1728 \\frac{g_2(i)^3}{g_2(i)^3 - 27 (0)^2} = 1728 \\frac{g_2(i)^3}{g_2(i)^3}$$\nSince $\\tau = i$ is in the upper half-plane, the discriminant $\\Delta(i) = g_2(i)^3 - 27g_3(i)^2 = g_2(i)^3$ is non-zero. This implies $g_2(i) \\neq 0$. Therefore, we can cancel the terms $g_2(i)^3$, yielding:\n$$j(i) = 1728$$\n\n**Computation of $j(\\zeta_3)$**\n\nLet $\\tau = \\zeta_3 = e^{2\\pi i/3} = -\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}$, a primitive cube root of unity satisfying $\\zeta_3^2+\\zeta_3+1=0$ and $\\zeta_3^3=1$. The lattice is $\\Lambda_{\\zeta_3} = \\mathbb{Z} + \\zeta_3\\mathbb{Z} = \\mathbb{Z}[\\zeta_3]$, the ring of Eisenstein integers. This lattice is invariant under multiplication by $\\zeta_3$:\n$\\zeta_3 \\Lambda_{\\zeta_3} = \\zeta_3(\\mathbb{Z} + \\zeta_3\\mathbb{Z}) = \\zeta_3\\mathbb{Z} + \\zeta_3^2\\mathbb{Z} = \\zeta_3\\mathbb{Z} + (-1-\\zeta_3)\\mathbb{Z} = \\mathbb{Z} + \\zeta_3\\mathbb{Z} = \\Lambda_{\\zeta_3}$. The lattice has a rotational symmetry of order $3$ (or $6$ if we include negation).\n\nWe apply the homogeneity property with $\\Lambda_{\\zeta_3}$ and $c=\\zeta_3$:\n$$g_2(\\zeta_3) = g_2(\\Lambda_{\\zeta_3}) = g_2(\\zeta_3\\Lambda_{\\zeta_3}) = (\\zeta_3)^{-4} g_2(\\Lambda_{\\zeta_3}) = \\zeta_3^2 g_2(\\Lambda_{\\zeta_3})$$\nThe relation $g_2(\\zeta_3) = \\zeta_3^2 g_2(\\zeta_3)$ can be rewritten as $(1-\\zeta_3^2)g_2(\\zeta_3) = 0$. Since $\\zeta_3^2 \\neq 1$, we must have $g_2(\\zeta_3) = 0$.\n$$g_3(\\zeta_3) = g_3(\\Lambda_{\\zeta_3}) = g_3(\\zeta_3\\Lambda_{\\zeta_3}) = (\\zeta_3)^{-6} g_3(\\Lambda_{\\zeta_3}) = (\\zeta_3^3)^{-2} g_3(\\Lambda_{\\zeta_3}) = 1^{-2}g_3(\\Lambda_{\\zeta_3}) = g_3(\\zeta_3)$$\nThis relation is a tautology.\n\nNow we compute the $j$-invariant $j(\\zeta_3)$:\n$$j(\\zeta_3) = 1728 \\frac{g_2(\\zeta_3)^3}{g_2(\\zeta_3)^3 - 27 g_3(\\zeta_3)^2} = 1728 \\frac{0^3}{0^3 - 27 g_3(\\zeta_3)^2} = 1728 \\frac{0}{-27 g_3(\\zeta_3)^2}$$\nSince $\\tau = \\zeta_3$ is in the upper half-plane, the discriminant $\\Delta(\\zeta_3) = g_2(\\zeta_3)^3 - 27g_3(\\zeta_3)^2 = -27g_3(\\zeta_3)^2$ is non-zero. This implies $g_3(\\zeta_3) \\neq 0$. Therefore, the expression evaluates to:\n$$j(\\zeta_3) = 0$$\n\n**Weierstrass Models**\n\nA short Weierstrass equation over $\\mathbb{C}$ is of the form $y^2 = x^3 + Ax + B$. Its $j$-invariant is given by the formula $j = 1728 \\frac{4A^3}{4A^3 + 27B^2}$.\n\nFor $j(i) = 1728$:\nWe seek coefficients $A, B$ such that $1728 = 1728 \\frac{4A^3}{4A^3 + 27B^2}$. This simplifies to $1 = \\frac{4A^3}{4A^3 + 27B^2}$, which implies $4A^3 = 4A^3 + 27B^2$, so $27B^2 = 0$, meaning $B=0$. For the curve to be non-singular (i.e., for the $j$-invariant to be well-defined), $4A^3+27B^2 \\neq 0$, which requires $A \\neq 0$. The simplest choice is $A=1$.\nThus, an explicit model is the elliptic curve $E_i: y^2 = x^3 + x$.\nThis model is justified by its connection to the lattice symmetry. The curve corresponding to the lattice $\\Lambda_i$ has $g_3(i)=0$. Our chosen model with $B=0$ is isomorphic to any curve defined by a lattice where $g_3=0$. The endomorphism ring of this curve is $\\mathbb{Z}[i]$, corresponding to the lattice symmetry. The non-trivial automorphism is multiplication by $i$, which acts on the curve coordinates as an automorphism of order $4$: $[i]: (x,y) \\mapsto (-x, iy)$. We can verify this: $(iy)^2 = (-x)^3 + (-x) \\implies -y^2 = -x^3 - x \\implies y^2 = x^3+x$.\n\nFor $j(\\zeta_3) = 0$:\nWe seek coefficients $A, B$ such that $0 = 1728 \\frac{4A^3}{4A^3 + 27B^2}$. This implies $4A^3 = 0$, so $A=0$. For non-singularity, $4A^3+27B^2 \\neq 0$, which requires $B \\neq 0$. The simplest choice is $B=1$.\nThus, an explicit model is the elliptic curve $E_{\\zeta_3}: y^2 = x^3 + 1$.\nThis model is justified by its connection to the lattice symmetry. The curve corresponding to the lattice $\\Lambda_{\\zeta_3}$ has $g_2(\\zeta_3)=0$. Our model with $A=0$ is isomorphic to any curve from a lattice where $g_2=0$. The endomorphism ring is $\\mathbb{Z}[\\zeta_3]$. The non-trivial automorphism is multiplication by $\\zeta_3$, which acts on the curve coordinates as an automorphism of order $3$: $[\\zeta_3]: (x,y) \\mapsto (\\zeta_3 x, y)$. We verify this: $y^2 = (\\zeta_3 x)^3 + 1 \\implies y^2 = \\zeta_3^3 x^3 + 1 \\implies y^2 = x^3 + 1$.\n\nThe final answer is the ordered pair $(j(i), j(\\zeta_3))$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1728 & 0\n\\end{pmatrix}\n}\n$$", "id": "3010320"}, {"introduction": "Complex multiplication theory provides a powerful framework for understanding the structure of isogenies, particularly over finite fields where they form a \"volcano\" structure. This exercise offers a hands-on exploration of these dynamics, asking you to construct an explicit isogeny for the reduction of a CM curve and determine its codomain [@problem_id:3010318]. By analyzing the kernel's properties in relation to the endomorphism ring, you will classify the isogeny as horizontal, descending, or ascending, making the abstract theory of CM isogeny volcanoes tangible.", "problem": "Let $K = \\mathbb{Q}(i)$ and let $\\mathcal{O}_{K} = \\mathbb{Z}[i]$ denote its ring of integers, which has discriminant $\\Delta_{K} = -4$. Consider the complex multiplication (CM) elliptic curve $E_{0}/\\mathbb{Q}$ with $j$-invariant $j(E_{0})=1728$, given by the short Weierstrass model $E_{0}: y^{2} = x^{3} + x$. Let $p = 5$, which is a prime of good reduction for $E_{0}$, and consider the reduction $E/\\mathbb{F}_{5}$ of $E_{0}$ modulo $p$, which is the elliptic curve $E: y^{2} = x^{3} + x$ over the finite field $\\mathbb{F}_{5}$. Let $\\ell = 2$.\n\nStarting from the foundational definitions of elliptic curves, isogenies, and complex multiplication, and using only well-tested general formulas (such as Vélu’s formulas for constructing isogenies from kernels) as tools, complete the following tasks:\n\n1. Construct explicitly a cyclic subgroup $G \\subset E(\\overline{\\mathbb{F}}_{5})$ of order $\\ell = 2$ to serve as the kernel of a degree-$\\ell$ isogeny $\\varphi: E \\to E'$, and verify that $G$ is rational over $\\mathbb{F}_{5}$.\n\n2. Using Vélu’s formulas, compute an explicit rational map for the degree-$2$ isogeny $\\varphi: E \\to E' = E/G$ over $\\mathbb{F}_{5}$ and determine a short Weierstrass model for the codomain curve $E'$.\n\n3. Using the theory of CM isogeny volcanoes for ordinary reductions, classify the $\\ell$-edge corresponding to $\\varphi$ as ascending, horizontal, or descending. Your classification must be justified from first principles of the complex multiplication setting: discuss the splitting or ramification behavior of $\\ell$ in $K$, the conductor of the endomorphism ring $\\operatorname{End}(E)$, and how these determine the nature of the $\\ell$-isogeny edge in the volcano.\n\n4. Finally, report the value of the $j$-invariant $j(E')$ of the codomain curve as your final answer. Give your final answer in exact form (no rounding required).", "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the theory of complex multiplication of elliptic curves, well-posed, and objective. It contains sufficient information for a unique solution path, is free of contradictions, and represents a standard problem in computational and theoretical number theory.\n\nThe solution proceeds by addressing the four tasks in sequence.\n\n### Part 1: Construction and Verification of the Kernel Subgroup $G$\n\nThe problem asks for the construction of a cyclic subgroup $G \\subset E(\\overline{\\mathbb{F}}_{5})$ of order $\\ell=2$. The curve is $E: y^{2} = x^{3} + x$ over $\\mathbb{F}_{5}$.\nThe points of order $2$ on $E$ are the points $P=(x,y)$ such that $2P=\\mathcal{O}$ and $P \\neq \\mathcal{O}$. These are the points with $y$-coordinate $y=0$. The $x$-coordinates are the roots of the polynomial $x^{3}+x=0$ in $\\mathbb{F}_{5}$.\n$$x^{3}+x = x(x^{2}+1) = 0$$\nThe roots are found by setting each factor to zero:\n1.  $x=0$.\n2.  $x^{2}+1=0 \\implies x^{2}=-1 \\equiv 4 \\pmod 5$. The solutions are $x = \\pm \\sqrt{4}$, which are $x=2$ and $x=-2 \\equiv 3 \\pmod 5$.\n\nThe three points of order $2$ are $P_{1}=(0,0)$, $P_{2}=(2,0)$, and $P_{3}=(3,0)$. A cyclic subgroup of order $2$ is of the form $G = \\{\\mathcal{O}, P\\}$, where $P$ is a point of order $2$. We choose $P=P_{1}=(0,0)$, so our kernel is $G = \\{\\mathcal{O}, (0,0)\\}$.\n\nTo verify that $G$ is rational over $\\mathbb{F}_{5}$, we must show that $G$ is invariant under the action of the Galois group $\\operatorname{Gal}(\\overline{\\mathbb{F}}_{5}/\\mathbb{F}_{5})$. This group is generated by the absolute Frobenius automorphism $\\pi_{5}: (x, y) \\mapsto (x^{5}, y^{5})$. A subgroup is rational if all its points are defined over $\\mathbb{F}_{5}$. The point $(0,0)$ has coordinates in the prime field $\\mathbb{F}_{5}$, so it is an $\\mathbb{F}_{5}$-rational point. The point at infinity $\\mathcal{O}$ is also rational over $\\mathbb{F}_{5}$. Thus, the subgroup $G = \\{\\mathcal{O}, (0,0)\\}$ is a rational subgroup, as it is a subset of $E(\\mathbb{F}_{5})$.\n\n### Part 2: Computation of the Isogeny and Codomain Curve\n\nWe use Vélu's formulas to compute the degree-$2$ isogeny $\\varphi: E \\to E' = E/G$ with kernel $G = \\{\\mathcal{O}, Q_{0}\\}$, where $Q_{0}=(x_{0},y_{0}) = (0,0)$. The initial curve is $E: y^{2}=x^{3}+Ax+B$ with $A=1$ and $B=0$ over $\\mathbb{F}_{5}$.\n\nFor a kernel generated by a point of order $2$, $Q_{0}=(x_{0},0)$, the isogeny map $\\varphi: (x,y) \\mapsto (X,Y)$ is given by:\n$$X = x + \\frac{3x_{0}^{2}+A}{x-x_{0}}$$\n$$Y = y\\left(1 - \\frac{3x_{0}^{2}+A}{(x-x_{0})^{2}}\\right)$$\nSubstituting $x_{0}=0$ and $A=1$ (all calculations are in $\\mathbb{F}_{5}$):\n$$X = x + \\frac{3(0)^{2}+1}{x-0} = x + \\frac{1}{x}$$\n$$Y = y\\left(1 - \\frac{3(0)^{2}+1}{(x-0)^{2}}\\right) = y\\left(1 - \\frac{1}{x^{2}}\\right)$$\nThe explicit rational map for $\\varphi$ is $\\varphi(x,y) = \\left(x+\\frac{1}{x}, y\\left(1-\\frac{1}{x^{2}}\\right)\\right)$.\n\nTo find the equation of the codomain curve $E'$, we express $Y^{2}$ in terms of $X$.\n$$Y^{2} = y^{2}\\left(1-\\frac{1}{x^{2}}\\right)^{2} = (x^{3}+x)\\left(\\frac{x^{2}-1}{x^{2}}\\right)^{2} = x(x^{2}+1)\\frac{(x^{2}-1)^{2}}{x^{4}} = \\frac{(x^{2}+1)(x^{2}-1)^{2}}{x^{3}}$$\nWe relate this to $X = x + \\frac{1}{x} = \\frac{x^{2}+1}{x}$.\nA known formula for the codomain of an isogeny with kernel generated by $(x_0, 0)$ from $y^2 = x^3+Ax+B$ is $Y^2 = X^3 + A'X + B'$ where $A' = A-5(3x_0^2+A)$ and $B' = B-7(x_0(3x_0^2+A))$. Working over $\\mathbb{F}_5$, the terms with factor $5$ and $7 \\equiv 2$ become $0$ and $2$.\nLet's use the explicit coefficients from Vélu's formulas. Let $t_0=3x_0^2+A=1$ and $u_0=2(x_0^3+Ax_0+B)=0$. Let $t=\\sum t_Q = t_0 = 1$ and $w = \\sum (u_Q+x_Q t_Q)=u_0+x_0 t_0=0$.\nThe coefficients of $E'$ are $A' = A - 5t$ and $B' = B - 7w$. In $\\mathbb{F}_{5}$:\n$$A' = A - 5t = 1 - 0 \\cdot 1 = 1$$\n$$B' = B - 7w = 0 - 2 \\cdot 0 = 0$$\nThus, the codomain curve is $E': y^{2} = x^{3}+x$. This is isomorphic to the original curve $E$.\n\n### Part 3: Classification of the Isogeny Edge\n\nThe classification of an $\\ell$-isogeny edge in a CM isogeny volcano (ascending, horizontal, or descending) depends on the endomorphism rings of the domain and codomain curves.\n\nFirst, we establish the endomorphism ring of $E/\\mathbb{F}_{5}$. The curve $E_{0}/\\mathbb{Q}$ has CM by the maximal order $\\mathcal{O}_{K} = \\mathbb{Z}[i]$ in $K=\\mathbb{Q}(i)$. The discriminant of $K$ is $\\Delta_{K}=-4$. The reduction prime is $p=5$. To determine if the reduction is ordinary or supersingular, we check if $p$ splits, is inert, or ramifies in $K$. This is determined by the Legendre symbol $(\\frac{\\Delta_{K}}{p})$:\n$$\\left(\\frac{-4}{5}\\right) = \\left(\\frac{-1}{5}\\right)\\left(\\frac{4}{5}\\right) = (-1)^{\\frac{5-1}{2}} \\cdot \\left(\\frac{2^2}{5}\\right) = (-1)^{2} \\cdot 1 = 1$$\nSince the symbol is $1$, the prime $p=5$ splits in $K$. By the theory of complex multiplication, this implies that the reduction $E/\\mathbb{F}_{5}$ is ordinary and its endomorphism ring is the maximal order $\\mathcal{O}_{K}$. Thus, $\\operatorname{End}(E) \\cong \\mathbb{Z}[i]$. Curves with endomorphism ring being the maximal order lie on the \"crater\" of the isogeny volcano (level $0$).\n\nNext, we analyze the isogeny prime $\\ell=2$. In the ring $\\mathbb{Z}[i]$, the prime $2$ ramifies, since $2 = -i(1+i)^{2}$, where $1+i$ is a prime element of norm $2$. The ideal factorization is $(2) = (1+i)^{2}$. The theory of isogeny volcanoes states that for a ramified prime $\\ell$, there is one horizontal $\\ell$-isogeny and $\\ell$ descending $\\ell$-isogenies (to an isomorphic codomain) from any curve on the crater.\n\nAn isogeny is horizontal if its kernel is an $\\mathcal{O}_{K}$-submodule. It is descending if its kernel is not an $\\mathcal{O}_{K}$-submodule. We must test if our kernel $G=\\{\\mathcal{O}, (0,0)\\}$ is an $\\mathcal{O}_{K}$-submodule.\nThe ring $\\mathcal{O}_{K}=\\mathbb{Z}[i]$ is generated by $i$ as a $\\mathbb{Z}$-algebra. So we only need to check if $G$ is stable under the action of the endomorphism $[i]$.\nThe CM endomorphism $[i]$ on $E_{0}: y^{2}=x^{3}+x$ over $\\mathbb{C}$ is given by $[i](x,y)=(-x,iy)$. Over $\\mathbb{F}_{5}$, we need a value $\\gamma$ such that $\\gamma^{2}=-1 \\pmod 5$. We can choose $\\gamma=2$, since $2^{2}=4 \\equiv -1$. So, the action of $[i]$ on $E/\\mathbb{F}_{5}$ is $[i](x,y) = (-x, 2y)$.\nLet's apply this to the non-identity element $(0,0) \\in G$:\n$$[i](0,0) = (-0, 2 \\cdot 0) = (0,0)$$\nSince $[i](0,0) \\in G$, and trivially $[1](0,0)=(0,0) \\in G$, $G$ is closed under the action of any element of $\\operatorname{End}(E) = \\mathbb{Z}[i]$. Thus, $G$ is an $\\mathcal{O}_{K}$-submodule.\n\nBecause its kernel is an $\\mathcal{O}_{K}$-submodule, the isogeny $\\varphi:E \\to E/G$ is a **horizontal** isogeny. This theoretical conclusion is consistent with our computational result in Part 2, where we found that the codomain curve $E'$ is isomorphic to the domain curve $E$, as is always the case for horizontal isogenies.\n\n### Part 4: The $j$-invariant of the Codomain Curve\n\nIn Part 2, we determined that the codomain curve $E'$ over $\\mathbb{F}_{5}$ has the Weierstrass model $y^{2}=x^{3}+x$. The $j$-invariant of a curve $y^{2}=x^{3}+Ax+B$ is given by the formula $j = 1728 \\frac{4A^{3}}{4A^{3}+27B^{2}}$.\nFor $E'$, we have $A=1$ and $B=0$. The $j$-invariant is:\n$$j(E') = 1728 \\frac{4(1)^{3}}{4(1)^{3}+27(0)^{2}} = 1728$$\nThis is the characteristic zero value of the $j$-invariant for this isomorphism class of elliptic curves. The isogeny $\\varphi$ is horizontal, which means $j(E') = j(E)$. The curve $E$ is the reduction modulo $5$ of $E_0/\\mathbb{Q}$, which was given to have $j(E_0)=1728$. The value of the $j$-invariant in $\\mathbb{F}_5$ is $1728 \\equiv 3 \\pmod 5$. As the problem asks for the value of the $j$-invariant in exact form and relates objects over $\\mathbb{Q}$ and $\\mathbb{F}_p$, the integral value from which the finite field value is derived is the most complete answer.", "answer": "$$\\boxed{1728}$$", "id": "3010318"}]}