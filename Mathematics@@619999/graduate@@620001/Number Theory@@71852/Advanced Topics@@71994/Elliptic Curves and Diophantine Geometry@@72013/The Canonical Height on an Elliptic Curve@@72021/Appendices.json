{"hands_on_practices": [{"introduction": "The power of the Néron-Tate canonical height lies in its decomposition into a sum of local contributions, $\\lambda_v(P)$, at each place $v$ of the number field. This hands-on practice begins with the most fundamental case: calculating the local height at a prime $p$ where the elliptic curve has good reduction [@problem_id:3025332]. This exercise demonstrates the direct relationship between a point's $p$-adic 'size' and its local height, providing a concrete calculation that is a building block for understanding the entire height function.", "problem": "Let $p$ be an odd prime, and consider the elliptic curve $E$ over the field of $p$-adic numbers $\\mathbb{Q}_{p}$ given by the integral short Weierstrass equation\n$$\ny^{2} = x^{3} - x\n$$.\nLet $v_{p}(\\cdot)$ denote the $p$-adic valuation on $\\mathbb{Q}_{p}$ normalized so that $v_{p}(p)=1$, and let $|\\cdot|_{p}$ denote the associated $p$-adic absolute value defined by $|z|_{p} = p^{-v_{p}(z)}$. The discriminant of $E$ is $\\Delta_{E}=64$, so $E$ has good reduction at every odd prime $p$.\n\nLet $P \\in E(\\mathbb{Q}_{p})$ be a point whose coordinates satisfy $v_{p}(x(P))=-2$ and $v_{p}(y(P))=-3$. (These valuations are consistent with the curve equation, since $y(P)^{2}=x(P)\\bigl(x(P)^{2}-1\\bigr)$ and for $v_{p}(x(P))<0$ one has $v_{p}\\bigl(x(P)^{2}-1\\bigr)=2\\,v_{p}\\bigl(x(P)\\bigr)$, hence $v_{p}\\bigl(y(P)\\bigr)=\\tfrac{3}{2}\\,v_{p}\\bigl(x(P)\\bigr)=-3$.)\n\nLet $\\lambda_{p}(P)$ denote the local Néron height of $P$ at $p$ associated to the canonical height on $E$, in the standard normalization where the global canonical height decomposes as a sum of local contributions over all places and the nonarchimedean contributions use the absolute value $|\\cdot|_{p}$ defined above.\n\nStarting from the fundamental properties of the Néron local height at a place of good reduction and the behavior of the formal group parameter at the origin, compute the explicit value of $\\lambda_{p}(P)$ in closed form as a function of $p$.\n\nYour final answer must be a single closed-form symbolic expression. Use the natural logarithm and do not round or approximate.", "solution": "The problem asks for the computation of the Néron local height $\\lambda_{p}(P)$ for a specific point $P$ on the elliptic curve $E$ given by $y^{2} = x^{3} - x$ over $\\mathbb{Q}_{p}$.\n\nFirst, we verify the reduction type of the curve at the prime $p$. The discriminant of an elliptic curve $y^2 = x^3+Ax+B$ is $\\Delta = -16(4A^3+27B^2)$. For the given curve $E$, we have $A=-1$ and $B=0$, so its discriminant is $\\Delta_E = -16(4(-1)^3) = 64$. Since $p$ is an odd prime, its $p$-adic valuation is $v_p(\\Delta_E) = v_p(64) = v_p(2^6) = 0$. A zero valuation of the discriminant means the curve has good reduction at $p$. The given equation is therefore a minimal Weierstrass equation at $p$.\n\nThe canonical height $\\hat{h}(P)$ decomposes into a sum of local contributions, $\\hat{h}(P) = \\sum_v \\lambda_v(P)$. For a prime $p$ where the curve has good reduction and is given by a minimal model, the local height $\\lambda_p(P)$ is given by the formula:\n$$\n\\lambda_{p}(P) = \\frac{1}{2} \\ln \\max\\{1, |x(P)|_{p}\\}\n$$\nThis formula is applicable here.\n\nWe are given that the point $P$ has coordinates satisfying $v_{p}(x(P)) = -2$. The $p$-adic absolute value is defined as $|z|_{p} = p^{-v_{p}(z)}$. Applying this to the $x$-coordinate of $P$:\n$$\n|x(P)|_{p} = p^{-v_{p}(x(P))} = p^{-(-2)} = p^{2}\n$$\nSince $p$ is an odd prime, we have $p \\ge 3$, which implies $p^{2} \\ge 9$. Thus, $|x(P)|_{p} > 1$.\nTherefore, $\\max\\{1, |x(P)|_{p}\\} = |x(P)|_{p} = p^{2}$.\n\nSubstituting this into the formula for the local height:\n$$\n\\lambda_{p}(P) = \\frac{1}{2} \\ln(p^{2})\n$$\nUsing the property of logarithms $\\ln(a^{b}) = b \\ln(a)$, we get:\n$$\n\\lambda_{p}(P) = \\frac{1}{2} (2 \\ln p) = \\ln p\n$$\nThe final value is $\\ln p$.", "answer": "$$\n\\boxed{\\ln(p)}\n$$", "id": "3025332"}, {"introduction": "Having mastered the good reduction case, we now turn to the more intricate scenario of bad reduction. At a prime of split multiplicative reduction, the local structure of the elliptic curve is described by Tate's theory of $p$-adic uniformization [@problem_id:3025324]. This practice requires applying the specialized formula for the local height in this context, which connects the height to the valuations of the Tate parameter $q$ and the point's uniformizing parameter $u$ via the second Bernoulli polynomial.", "problem": "Let $E/\\mathbb{Q}$ be an elliptic curve with split multiplicative reduction at the rational prime $p=11$. Suppose the local uniformization at $p$ is given by a Tate curve with parameter $q \\in \\mathbb{Q}_{11}$ such that $v_{11}(q)=7$, where $v_{11}$ denotes the $11$-adic valuation normalized by $v_{11}(11)=1$. Let $P \\in E(\\mathbb{Q})$ correspond, under the Tate uniformization $E_q(\\mathbb{Q}_{11}) \\cong \\mathbb{Q}_{11}^{\\times}/q^{\\mathbb{Z}}$, to a parameter $u(P) \\in \\mathbb{Q}_{11}^{\\times}$ with $v_{11}(u(P))=-3$.\n\nUsing the decomposition of the Néron–Tate canonical height $\\hat{h}(P)$ into a sum of local heights and the Tate uniformization at a split multiplicative place, compute the $11$-adic local contribution $\\lambda_{11}(P)$ to $\\hat{h}(P)$ by expressing it in terms of the second Bernoulli polynomial $B_{2}(t)=t^{2}-t+\\frac{1}{6}$ and the valuation data $v_{11}(q)$, $v_{11}(u(P))$. Your final answer must be a single closed-form expression involving $\\ln(11)$, with no rounding.", "solution": "The problem asks for the $11$-adic local contribution, $\\lambda_{11}(P)$, to the Néron–Tate canonical height $\\hat{h}(P)$ of a rational point $P$ on an elliptic curve $E/\\mathbb{Q}$.\n\nFirst, we recall the fundamental structure of the Néron-Tate canonical height. For a point $P \\in E(\\mathbb{Q})$, its canonical height $\\hat{h}(P)$ is given by a sum of local contributions (local heights or Néron functions) $\\lambda_v(P)$ over all places $v$ of $\\mathbb{Q}$:\n$$\n\\hat{h}(P) = \\sum_{v} \\lambda_v(P) = \\lambda_{\\infty}(P) + \\sum_{p \\text{ prime}} \\lambda_p(P)\n$$\n\nThe problem specifies that the elliptic curve $E$ has split multiplicative reduction at the prime $p=11$. At such a place, the group of $\\mathbb{Q}_{11}$-points of the curve is isomorphic to the quotient of the multiplicative group of the local field $\\mathbb{Q}_{11}$ by a cyclic subgroup generated by the Tate parameter $q$. This is the Tate uniformization:\n$$\nE(\\mathbb{Q}_{11}) \\cong \\mathbb{Q}_{11}^{\\times} / q^{\\mathbb{Z}}\n$$\nHere, $q \\in \\mathbb{Q}_{11}$ is an element with $11$-adic valuation $v_{11}(q) > 0$. We are given $v_{11}(q)=7$. A point $P \\in E(\\mathbb{Q}) \\subset E(\\mathbb{Q}_{11})$ corresponds to an element $u(P) \\in \\mathbb{Q}_{11}^{\\times}$ defined up to multiplication by integer powers of $q$. We are given that $v_{11}(u(P)) = -3$.\n\nThe computation of the local height $\\lambda_{11}(P)$ relies on an explicit formula derived from this uniformization. A standard formula for the local height at a place $v$ of split multiplicative reduction, denoted here by the prime $p$, relates $\\lambda_p(P)$ to the valuations of $q$ and $u(P)$ via the second Bernoulli polynomial, $B_2(t) = t^2-t+\\frac{1}{6}$. The formula, as given in standard texts such as Hindry and Silverman's \"Diophantine Geometry,\" is:\n$$\n\\lambda_p(P) = \\frac{1}{2} v_p(q) \\ln(p) \\cdot B_2\\left( \\left\\{ \\frac{v_p(u(P))}{v_p(q)} \\right\\} \\right)\n$$\nwhere $\\{x\\} = x - \\lfloor x \\rfloor$ denotes the fractional part of a real number $x$.\n\nIt is important to note that the decomposition of the global height into local components is not unique. Different normalizations of the local heights exist in the literature. The formula above is one common choice. However, the canonical height $\\hat{h}(P)$ has the property that $\\hat{h}(O)=0$, where $O$ is the identity point of the curve. A canonical decomposition is typically chosen to reflect this at the local level as much as possible, for instance by requiring $\\lambda_p(O)=0$ for all finite primes $p$.\n\nLet's evaluate the height of the identity point $O$ using the given formula. The point $O$ corresponds to the identity element in $\\mathbb{Q}_{11}^{\\times}/q^{\\mathbb{Z}}$, which can be represented by $u(O)=1$. Thus, $v_{11}(u(O))=v_{11}(1)=0$. The argument of the Bernoulli polynomial becomes $\\{\\frac{0}{7}\\} = 0$.\n$$\n\\lambda_{11}(O) = \\frac{1}{2} v_{11}(q) \\ln(11) \\cdot B_2(0)\n$$\nSince $B_2(0) = 0^2-0+\\frac{1}{6} = \\frac{1}{6}$, we find\n$$\n\\lambda_{11}(O) = \\frac{1}{2} \\cdot 7 \\cdot \\ln(11) \\cdot \\frac{1}{6} = \\frac{7}{12}\\ln(11)\n$$\nThis is non-zero. The term \"the local contribution\" often implies a unique, canonical choice. The most natural choice is one normalized to be zero at the identity. We will therefore compute the normalized local height, $\\lambda_{11}^{\\text{norm}}(P) = \\lambda_{11}(P) - \\lambda_{11}(O)$, assuming this is the quantity intended by the problem statement.\n$$\n\\lambda_{11}^{\\text{norm}}(P) = \\frac{1}{2} v_{11}(q) \\ln(11) \\left( B_2\\left( \\left\\{ \\frac{v_{11}(u(P))}{v_{11}(q)} \\right\\} \\right) - B_2(0) \\right)\n$$\nNow we apply the data given in the problem:\n- $p=11$\n- $v_{11}(q) = 7$\n- $v_{11}(u(P)) = -3$\n\nFirst, we compute the argument for the Bernoulli polynomial for the point $P$:\n$$\n\\frac{v_{11}(u(P))}{v_{11}(q)} = \\frac{-3}{7}\n$$\nThe fractional part is:\n$$\n\\left\\{ \\frac{-3}{7} \\right\\} = \\frac{-3}{7} - \\left\\lfloor \\frac{-3}{7} \\right\\rfloor = \\frac{-3}{7} - (-1) = \\frac{4}{7}\n$$\nNext, we evaluate $B_2$ at this value:\n$$\nB_2\\left(\\frac{4}{7}\\right) = \\left(\\frac{4}{7}\\right)^2 - \\frac{4}{7} + \\frac{1}{6} = \\frac{16}{49} - \\frac{4}{7} + \\frac{1}{6}\n$$\nTo sum these fractions, we use the common denominator $49 \\times 6 = 294$:\n$$\nB_2\\left(\\frac{4}{7}\\right) = \\frac{16 \\cdot 6}{294} - \\frac{4 \\cdot 42}{294} + \\frac{49}{294} = \\frac{96 - 168 + 49}{294} = \\frac{-23}{294}\n$$\nNow we can compute the normalized local height:\n$$\n\\lambda_{11}^{\\text{norm}}(P) = \\frac{1}{2} \\cdot 7 \\cdot \\ln(11) \\left( -\\frac{23}{294} - \\frac{1}{6} \\right)\n$$\nWe convert $\\frac{1}{6}$ to a fraction with denominator $294$: $\\frac{1}{6} = \\frac{49}{294}$.\n$$\n\\lambda_{11}^{\\text{norm}}(P) = \\frac{7}{2} \\ln(11) \\left( -\\frac{23}{294} - \\frac{49}{294} \\right) = \\frac{7}{2} \\ln(11) \\left( -\\frac{72}{294} \\right)\n$$\nWe simplify the expression:\n$$\n\\lambda_{11}^{\\text{norm}}(P) = -\\frac{7 \\cdot 72}{2 \\cdot 294} \\ln(11)\n$$\nSince $294 = 6 \\times 49 = 6 \\times 7^2$, we can simplify:\n$$\n\\lambda_{11}^{\\text{norm}}(P) = -\\frac{7 \\cdot 72}{2 \\cdot 6 \\cdot 49} \\ln(11) = -\\frac{72}{2 \\cdot 6 \\cdot 7} \\ln(11) = -\\frac{72}{84} \\ln(11)\n$$\nFinally, we reduce the fraction $\\frac{72}{84}$ by dividing the numerator and denominator by their greatest common divisor, which is $12$:\n$$\n\\frac{72}{84} = \\frac{6 \\times 12}{7 \\times 12} = \\frac{6}{7}\n$$\nThus, the normalized local contribution is:\n$$\n\\lambda_{11}(P) = -\\frac{6}{7} \\ln(11)\n$$\nThis is our final answer, a closed-form expression as required.", "answer": "$$\\boxed{-\\frac{6}{7}\\ln(11)}$$", "id": "3025324"}, {"introduction": "The previous practices focused on computing individual local heights. Our final challenge is to synthesize this knowledge into a complete and rigorous algorithm for computing the global canonical height $\\hat{h}(P)$ to a specified precision [@problem_id:3025329]. This exercise moves beyond individual formulas to the strategic level of computational number theory, requiring you to determine which local heights are non-zero and how to manage approximation errors from different sources to guarantee a correct final result.", "problem": "Let $E/\\mathbb{Q}$ be an elliptic curve given by a global minimal Weierstrass equation with discriminant $\\Delta \\in \\mathbb{Z}$, and let $P \\in E(\\mathbb{Q})$ be a non-torsion point. Consider the canonical height function on $E(\\mathbb{Q})$, characterized as a positive definite quadratic form on the Mordell–Weil group up to torsion and compatible with the duplication map. One seeks to approximate this height by aggregating contributions from completions of $\\mathbb{Q}$, with rigorous control of truncation error at each place, so that a target accuracy $\\varepsilon > 0$ is guaranteed.\n\nWhich option gives a correct and fully rigorous algorithmic strategy, including the choice of truncation parameters and finite place selection, to compute the height to within a prescribed error tolerance $\\varepsilon$? Assume standard normalizations of absolute values at all places.\n\nA. Choose the finite set $S$ of places to be all archimedean places together with primes dividing $\\Delta$. For $v \\notin S$ set the local contribution to zero by fiat, because good reduction ensures vanishing. For $v \\in S$, use any convergent local series and truncate each at a common integer $N$ large enough so that geometric tail bounds at one representative place are within $\\varepsilon$, then reuse $N$ for all places. Summation over $S$ yields the desired approximation.\n\nB. Choose the finite set $S$ of places consisting of the unique archimedean place $\\infty$ together with all primes $p$ such that either $E$ has bad reduction at $p$ (i.e., $p \\mid \\Delta$) or the $x$–coordinate of $P$ is not $p$–integral (i.e., $|x(P)|_p > 1$). For $p \\in S$ with good reduction and $|x(P)|_p \\le 1$, the local contribution is exactly zero; for $p \\in S$ with good reduction and $|x(P)|_p > 1$, compute the local contribution exactly from the $p$–adic valuation of the denominator of $x(P)$, so no truncation error arises. For $p \\in S$ with multiplicative reduction, pass to the Tate uniformization with parameter $q_p$ satisfying $|q_p|_p < 1$, express the local contribution as a $q_p$–power series with coefficients bounded uniformly in terms of the reduction type, and choose a truncation index $N_p$ so that the geometric tail bound $\\sum_{n > N_p} C_p \\, |q_p|_p^{\\,n} \\le \\varepsilon_p$ holds for a chosen local budget $\\varepsilon_p > 0$. For $p \\in S$ with additive reduction, work in the formal group over $\\mathbb{Z}_p$ after a suitable scaling to the minimal model; use the formal group power series in the local parameter to express the local contribution as a rapidly decaying series whose tail is bounded by a computable function of the radius of convergence, and pick $N_p$ so that the tail is $\\le \\varepsilon_p$. At $\\infty$, use complex uniformization $E(\\mathbb{C}) \\cong \\mathbb{C}/\\Lambda$; write $x(P) = \\wp(z)$ for an elliptic logarithm $z \\in \\mathbb{C}$, express the local contribution through a convergent $q$–series in $q = e^{2\\pi i \\tau}$ with $\\Im(\\tau) > 0$, and choose a truncation index $N_\\infty$ so that the tail bound $\\sum_{n > N_\\infty} C_\\infty |q|^{\\,n} \\le \\varepsilon_\\infty$ holds. Allocate local tolerances so that $\\sum_{v \\in S} \\varepsilon_v \\le \\varepsilon$, and set $\\varepsilon_v = 0$ for finite good places where the local contribution is computed exactly. The resulting sum over $S$ gives an approximation with total error at most $\\varepsilon$.\n\nC. Compute only the archimedean contribution using complex uniformization and ignore all finite places since the global minimal model forces vanishing there. Use a single truncation index $N$ determined solely by $\\Im(\\tau)$, the imaginary part of the period ratio, and conclude the approximation error is less than $\\varepsilon$ because the archimedean tails dominate.\n\nD. Use the limit characterization via the duplication map by computing $h([2^N]P)$ for a large integer $N$ and returning $4^{-N} h([2^N]P)$ as the approximation. Because of quadraticity, the error is bounded by $4^{-N}$ times the naive height, so no local analysis or place-by-place truncation is necessary. Choose $N$ so that $4^{-N} h([2^N]P) \\le \\varepsilon$ and stop.\n\nSelect the correct option(s).", "solution": "The problem statement asks for a correct and fully rigorous algorithmic strategy to compute the canonical height of a rational point on an elliptic curve to a specified precision $\\varepsilon > 0$.\n\nFirst, a validation of the problem statement is in order.\n\n**Step 1: Extract Givens**\n- $E/\\mathbb{Q}$ is an elliptic curve given by a global minimal Weierstrass equation.\n- The discriminant is $\\Delta \\in \\mathbb{Z}$.\n- $P \\in E(\\mathbb{Q})$ is a non-torsion point.\n- The canonical height function, denoted here as $\\hat{h}$, is defined on $E(\\mathbb{Q})$.\n- $\\hat{h}$ is characterized as a positive definite quadratic form on $E(\\mathbb{Q})/\\text{torsion}$ and satisfies $\\hat{h}([2]P) = 4\\hat{h}(P)$.\n- The computational task is to approximate $\\hat{h}(P)$ with an error less than a given $\\varepsilon > 0$.\n- The method involves a sum of contributions from completions of $\\mathbb{Q}$ (local heights).\n- The algorithm must have rigorous control of truncation errors.\n- Standard normalizations of absolute values $| \\cdot |_v$ at all places $v$ of $\\mathbb{Q}$ are assumed.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is firmly rooted in the arithmetic of elliptic curves, a major topic in number theory. The concept of the canonical height (or Néron-Tate height), its decomposition into a sum of local Néron height functions ($\\hat{\\lambda}_v$), and the methods for computing these local contributions (Tate's algorithm for $p$-adic places, complex uniformization for the archimedean place) are all standard and well-established mathematical results. The givens are consistent with the theory developed by Néron, Tate, and Silverman.\n- **Well-Posed:** The problem asks to identify a correct algorithm from a list of options. As computational number theory provides such algorithms, the problem is well-posed. A correct and rigorous method exists, so a solution can be identified.\n- **Objective:** The problem is stated in precise, technical mathematical language, free from any ambiguity, subjectivity, or non-scientific claims.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. It describes a standard, albeit complex, problem in computational number theory. We may proceed to the solution.\n\nThe canonical height $\\hat{h}(P)$ of a point $P \\in E(\\mathbb{Q})$ is given by the sum of local height contributions over all places $v$ of $\\mathbb{Q}$:\n$$ \\hat{h}(P) = \\sum_{v \\in M_{\\mathbb{Q}}} \\hat{\\lambda}_v(P) $$\nwhere $M_{\\mathbb{Q}} = \\{\\infty\\} \\cup \\{\\text{prime numbers } p\\}$, and $\\hat{\\lambda}_v$ is the Néron local height function at the place $v$. The normalization is chosen such that the sum gives the canonical height.\n\nA key property of local heights is that $\\hat{\\lambda}_p(P) = 0$ for almost all primes $p$. The sum is therefore finite. The set of places $S$ where $\\hat{\\lambda}_v(P)$ may be non-zero is precisely:\n$1$. The archimedean place $v = \\infty$.\n$2$. Finite places $p$ where $E$ has bad reduction (i.e., $p \\mid \\Delta$).\n$3$. Finite places $p$ where $E$ has good reduction but the point $P$ is not $p$-integral. For a point $P=(x,y)$ in a minimal Weierstrass model, this means the denominator of the $x$-coordinate is divisible by $p$, or equivalently, $|x(P)|_p > 1$.\n\nAn algorithm to compute $\\hat{h}(P)$ must therefore identify this set $S$ and compute or approximate each $\\hat{\\lambda}_v(P)$ for $v \\in S$. The total error must be controlled by distributing a total error budget $\\varepsilon$ among the places where approximation is necessary.\n\nNow we evaluate each option.\n\n**A. Choose the finite set $S$ of places to be all archimedean places together with primes dividing $\\Delta$. For $v \\notin S$ set the local contribution to zero by fiat, because good reduction ensures vanishing. For $v \\in S$, use any convergent local series and truncate each at a common integer $N$ large enough so that geometric tail bounds at one representative place are within $\\varepsilon$, then reuse $N$ for all places. Summation over $S$ yields the desired approximation.**\n\nThis option contains several errors.\nFirst, the set $S$ is incorrectly defined. It omits primes $p$ where $E$ has good reduction but $P$ is not $p$-integral (i.e., $|x(P)|_p > 1$). At such primes, the local height is non-zero. The formula for a prime $p$ of good reduction is $\\hat{\\lambda}_p(P) = \\frac{1}{2} \\ln \\max(0, -v_p(x(P))) \\ln p = \\frac{1}{2} \\ln |x(P)|_p$. This is non-zero if $|x(P)|_p > 1$. The claim that \"good reduction ensures vanishing\" is false.\nSecond, the truncation strategy is not rigorous. The convergence rates of the series for local heights at different places (e.g., the archimedean place, a $p$-adic place of multiplicative reduction, another $p'$-adic place of additive reduction) are completely different. They depend on local parameters like $q = e^{2\\pi i \\tau}$ at infinity or Tate's parameter $q_p$ at a multiplicative prime $p$. Using a common truncation index $N$ is inefficient and incorrect. A rigorous approach requires calculating a specific truncation index $N_v$ for each place $v$ based on a local error budget $\\varepsilon_v$.\n\nVerdict: **Incorrect**.\n\n**B. Choose the finite set $S$ of places consisting of the unique archimedean place $\\infty$ together with all primes $p$ such that either $E$ has bad reduction at $p$ (i.e., $p \\mid \\Delta$) or the $x$–coordinate of $P$ is not $p$–integral (i.e., $|x(P)|_p > 1$). For $p \\in S$ with good reduction and $|x(P)|_p \\le 1$, the local contribution is exactly zero; for $p \\in S$ with good reduction and $|x(P)|_p > 1$, compute the local contribution exactly from the $p$–adic valuation of the denominator of $x(P)$, so no truncation error arises. For $p \\in S$ with multiplicative reduction, pass to the Tate uniformization with parameter $q_p$ satisfying $|q_p|_p < 1$, express the local contribution as a $q_p$–power series with coefficients bounded uniformly in terms of the reduction type, and choose a truncation index $N_p$ so that the geometric tail bound $\\sum_{n > N_p} C_p \\, |q_p|_p^{\\,n} \\le \\varepsilon_p$ holds for a chosen local budget $\\varepsilon_p > 0$. For $p \\in S$ with additive reduction, work in the formal group over $\\mathbb{Z}_p$ after a suitable scaling to the minimal model; use the formal group power series in the local parameter to express the local contribution as a rapidly decaying series whose tail is bounded by a computable function of the radius of convergence, and pick $N_p$ so that the tail is $\\le \\varepsilon_p$. At $\\infty$, use complex uniformization $E(\\mathbb{C}) \\cong \\mathbb{C}/\\Lambda$; write $x(P) = \\wp(z)$ for an elliptic logarithm $z \\in \\mathbb{C}$, express the local contribution through a convergent $q$–series in $q = e^{2\\pi i \\tau}$ with $\\Im(\\tau) > 0$, and choose a truncation index $N_\\infty$ so that the tail bound $\\sum_{n > N_\\infty} C_\\infty |q|^{\\,n} \\le \\varepsilon_\\infty$ holds. Allocate local tolerances so that $\\sum_{v \\in S} \\varepsilon_v \\le \\varepsilon$, and set $\\varepsilon_v = 0$ for finite good places where the local contribution is computed exactly. The resulting sum over $S$ gives an approximation with total error at most $\\varepsilon$.**\n\nThis option provides a detailed and accurate description of the standard, rigorous algorithm for computing the canonical height.\n- The set $S$ of places with potentially non-zero contributions is correctly identified.\n- It correctly states that for a prime $p$ of good reduction, the local height is either $0$ (if $|x(P)|_p \\le 1$) or given by an exact formula $\\frac{1}{2}\\ln|x(P)|_p$ (if $|x(P)|_p > 1$), requiring no approximation.\n- It correctly describes the distinct, standard procedures for the three cases that require series approximation: multiplicative reduction (via Tate's $p$-adic uniformization), additive reduction (via the formal group), and the archimedean place (via complex uniformization and $q$-series).\n- Crucially, it describes the correct error control strategy: distributing the total error budget $\\varepsilon$ into local budgets $\\varepsilon_v$ and choosing place-specific truncation indices $N_v$ to meet these local budgets. This ensures the total error is bounded by $\\varepsilon$.\n\nVerdict: **Correct**.\n\n**C. Compute only the archimedean contribution using complex uniformization and ignore all finite places since the global minimal model forces vanishing there. Use a single truncation index $N$ determined solely by $\\Im(\\tau)$, the imaginary part of the period ratio, and conclude the approximation error is less than $\\varepsilon$ because the archimedean tails dominate.**\n\nThis option is fundamentally flawed. Having a global minimal Weierstrass equation does not force the finite local height contributions to vanish. As explained for option A, $\\hat{\\lambda}_p(P)$ can be non-zero at any prime $p$ dividing the discriminant $\\Delta$ or the denominator of $x(P)$. These non-archimedean contributions are an essential part of the global height $\\hat{h}(P)$, not an error term. There is no theoretical basis for the claim that they can be ignored or are dominated by archimedean \"tails\". The magnitude of the sum of finite local heights can be comparable to, or even larger than, the archimedean contribution.\n\nVerdict: **Incorrect**.\n\n**D. Use the limit characterization via the duplication map by computing $h([2^N]P)$ for a large integer $N$ and returning $4^{-N} h([2^N]P)$ as the approximation. Because of quadraticity, the error is bounded by $4^{-N}$ times the naive height, so no local analysis or place-by-place truncation is necessary. Choose $N$ so that $4^{-N} h([2^N]P) \\le \\varepsilon$ and stop.**\n\nThis option refers to the fundamental definition of the canonical height as the limit $\\hat{h}(P) = \\lim_{N\\to\\infty} 4^{-N}h([2^N]P)$, where $h$ is the naive logarithmic height, $h(P) = \\ln \\max(|a|,|b|)$ for $x(P)=a/b$. While this limit converges, the option's description of error control is not rigorous.\nThe error of the approximation is $E_N = |\\hat{h}(P) - 4^{-N}h([2^N]P)|$. While it is true that $E_N = O(4^{-N})$, a rigorous algorithm requires a computable bound on the implied constant. This constant depends on local properties of the elliptic curve $E$, specifically at the places of bad reduction. Determining this constant requires the same kind of local analysis the option claims to avoid. Therefore, the statement \"no local analysis... is necessary\" is false for a *rigorous* implementation.\nFurthermore, the proposed stopping condition, $4^{-N} h([2^N]P) \\le \\varepsilon$, is incorrect. This condition bounds the *value* of the approximation, not the *error* in the approximation. The correct goal is to ensure $E_N \\le \\varepsilon$. A point with a very small height might satisfy the proposed condition for a small $N$ where the error $E_N$ is still large.\n\nVerdict: **Incorrect**.\n\nIn conclusion, only option B outlines a complete and mathematically sound algorithm for the rigorous computation of the canonical height to a prescribed precision.", "answer": "$$\\boxed{B}$$", "id": "3025329"}]}