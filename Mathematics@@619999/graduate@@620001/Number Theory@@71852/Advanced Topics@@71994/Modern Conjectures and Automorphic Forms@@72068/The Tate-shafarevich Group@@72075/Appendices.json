{"hands_on_practices": [{"introduction": "The Tate-Shafarevich group $\\Sha(E/\\mathbb{Q})$ is fundamentally defined as the group of principal homogeneous spaces for an elliptic curve $E$ which are locally soluble everywhere but have no global, rational points. This exercise [@problem_id:3029554] makes this abstract definition concrete by guiding you through a computational investigation of this \"local-to-global\" principle. You will implement algorithms to test for the existence of real, $p$-adic, and rational points on genus one curves, developing a practical understanding of how to identify candidates for non-trivial elements of $\\Sha$.", "problem": "Let $E/\\mathbb{Q}$ be an elliptic curve, and let the Tate-Shafarevich group (often denoted by the Cyrillic letter $\\Sha$) be the group of isomorphism classes of principal homogeneous spaces under $E$ that are locally trivial over all completions of $\\mathbb{Q}$. A principal homogeneous space $C$ for $E$ is a smooth, projective, geometrically integral curve over $\\mathbb{Q}$ with a simply transitive action of $E$ defined over $\\mathbb{Q}$. By definition, an element $[C] \\in \\Sha(E/\\mathbb{Q})$ is represented by a curve $C$ that has a point over every completion $\\mathbb{Q}_v$ of $\\mathbb{Q}$ (that is, $C(\\mathbb{Q}_v) \\neq \\emptyset$ for all places $v$), but has no rational point over $\\mathbb{Q}$.\n\nThis problem asks you to experimentally and numerically study local solubility and rational solubility for a small family of genus one curves that arise naturally in descent computations:\n- Diagonal cubic torsors of the form $a x^3 + b y^3 + c z^3 = 0$, which are smooth plane cubics when $a,b,c \\in \\mathbb{Z}$ are nonzero and suitably chosen, and\n- Binary quartic torsors of the form $u^2 = d x^4 + e x^2 + f$, which are smooth projective genus one curves when the quartic on the right-hand side has distinct roots over $\\overline{\\mathbb{Q}}$.\n\nYour program must implement the following principle-based experimental procedure:\n1. Base definitions and criteria:\n   - Local fields and local points: For a place $v$ of $\\mathbb{Q}$, a curve $C$ is locally soluble at $v$ if $C(\\mathbb{Q}_v) \\neq \\emptyset$, where $\\mathbb{Q}_\\infty = \\mathbb{R}$ and for a prime $p$, $\\mathbb{Q}_p$ is the field of $p$-adic numbers.\n   - Local solubility via congruences: A necessary condition for $C(\\mathbb{Q}_p) \\neq \\emptyset$ is the existence of solutions modulo $p^n$ for all $n$, and a sufficient condition is the existence of a nonsingular solution modulo $p$, which lifts to a solution over $\\mathbb{Q}_p$ by Hensel’s lemma. In numerical experiments, testing solutions modulo $p$ and $p^2$ at a finite set of primes provides strong evidence for local solubility.\n   - Real solubility: For diagonal cubic $a x^3 + b y^3 + c z^3 = 0$, exhibit real solutions by sign cancellation using the odd power property of cubes when at least two coefficients are nonzero. For binary quartics $u^2 = d x^4 + e x^2 + f$, analyze the real polynomial $g(x) = d x^4 + e x^2 + f$. If $d > 0$, then $g(x) \\to +\\infty$ as $|x| \\to \\infty$, so $g$ attains arbitrarily large positive values and $C(\\mathbb{R}) \\neq \\emptyset$. If $d  0$, then $g$ attains a finite supremum; compute the supremum by critical points of $g(x)$ using $g'(x) = 4 d x^3 + 2 e x$. If $\\sup_{x \\in \\mathbb{R}} g(x)  0$, then $C(\\mathbb{R}) = \\emptyset$.\n   - Rational solubility: A rational point on $a x^3 + b y^3 + c z^3 = 0$ corresponds to a nontrivial integer solution $(x,y,z) \\in \\mathbb{Z}^3 \\setminus \\{(0,0,0)\\}$ up to scaling, and for $u^2 = d x^4 + e x^2 + f$ corresponds to integer $(x,u)$ solving $u^2 = d x^4 + e x^2 + f$.\n\n2. Algorithmic tasks for each input curve $C$:\n   - Real place test: Implement a criterion for $C(\\mathbb{R}) \\neq \\emptyset$ as above. If $C(\\mathbb{R}) = \\emptyset$, then $C$ is not locally soluble everywhere; classify this case immediately as not in $\\Sha$.\n   - Finite place tests: For each prime $p$ in a specified finite set, test the existence of solutions modulo $p$ and modulo $p^2$.\n     - For $a x^3 + b y^3 + c z^3 = 0$ modulo $p^n$, search for solutions by enumerating $x,y$ to form the set of residues $a x^3 + b y^3 \\pmod{p^n}$ and check membership of $-c z^3$ in this set for some $z$. Record any solution and check nonsingularity at modulo $p$ by verifying the gradient $$(3 a x^2, 3 b y^2, 3 c z^2) \\not\\equiv (0,0,0) \\pmod{p}.$$ If a nonsingular solution modulo $p$ exists, local solubility over $\\mathbb{Q}_p$ follows; otherwise, in practice also accept the existence of solutions modulo $p^2$ as evidence supporting local solubility.\n     - For $u^2 = d x^4 + e x^2 + f$ modulo $p^n$, enumerate $x$ and check whether $d x^4 + e x^2 + f$ is a square modulo $p^n$. For nonsingularity modulo $p$, verify $$(2 u, - (4 d x^3 + 2 e x)) \\not\\equiv (0,0) \\pmod{p}.$$ As above, accept solutions modulo $p^2$ as experimental evidence of local solubility.\n   - Rational search: Perform a bounded exhaustive search for small integer solutions:\n     - For diagonal cubics, search $(x,y,z)$ with $|x|,|y|,|z| \\leq B$ for some bound $B$ (exclude $(0,0,0)$) and check $a x^3 + b y^3 + c z^3 = 0$.\n     - For quartics, search $(x,u)$ with $|x|,|u| \\leq B$ and check $u^2 = d x^4 + e x^2 + f$.\n     - If such a solution is found, record rational solubility.\n\n3. Classification rule:\n   - Output $0$ if local solubility fails at any tested place (including the real place).\n   - Output $1$ if a rational point is found (within the given bound), which certifies global solubility.\n   - Output $2$ if the curve is locally soluble at all tested places but no rational point is found within the given bound. This outcome identifies the curve as an experimental “candidate” element of $\\Sha$, recognizing that this is only numerical evidence and not a proof.\n\nYou must implement this for the following test suite, which is designed to exercise different behaviors:\n- Test case 1 (diagonal cubic, easy rational point): $a=1$, $b=1$, $c=-1$; search bound $B=60$; primes $\\{2,3,5,7,11\\}$.\n- Test case 2 (diagonal cubic, classical locally soluble torsor): $a=3$, $b=4$, $c=5$ (Selmer’s cubic); search bound $B=120$; primes $\\{2,3,5,7,11\\}$.\n- Test case 3 (binary quartic, real obstruction): $d=-1$, $e=0$, $f=-1$; search bound $B=80$; primes $\\{2,3,5,7,11\\}$.\n- Test case 4 (binary quartic, obvious rational point): $d=1$, $e=-5$, $f=4$; search bound $B=80$; primes $\\{2,3,5,7,11\\}$.\n\nFinal output specification:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[result1,result2,result3,result4]\"). Each result must be an integer in $\\{0,1,2\\}$ following the classification rule above. No physical units or angle units apply, and all numerical values are dimensionless.", "solution": "The problem requires an experimental procedure to classify genus one curves of two specific forms—diagonal cubics and binary quartics—based on their solubility properties over the real numbers, p-adic numbers, and rational numbers. The classification serves as a numerical analogue for determining whether a curve represents a trivial element, a non-trivial element of the Tate-Shafarevich group ($\\Sha$), or is obstructed from being in $\\Sha$ due to local insolubility.\n\nA curve $C$ represents an element of $\\Sha(E/\\mathbb{Q})$ if it has points in every completion $\\mathbb{Q}_v$ (i.e., it is *locally soluble*), but has no points in $\\mathbb{Q}$ (i.e., it is not *globally soluble*). Our task is to implement an algorithm that tests these properties for a given set of curves and returns a classification:\n- $0$: The curve is not locally soluble at some tested place (real or p-adic).\n- $1$: The curve is globally soluble (a rational point is found).\n- $2$: The curve appears to be locally soluble at all tested places, but no rational point is found within a specified search bound. This identifies experimental candidates for non-trivial elements of $\\Sha$.\n\nThe algorithm is implemented by creating distinct procedures for the two types of curves provided.\n\n### Diagonal Cubic: $ax^3 + by^3 + cz^3 = 0$\n\n1.  **Real Solubility Test ($C(\\mathbb{R}) \\neq \\emptyset$)**: For non-zero integer coefficients $a$, $b$, and $c$, the equation $ax^3 + by^3 + cz^3 = 0$ always possesses a non-trivial real solution. This is because the function $f(t) = t^3$ is surjective from $\\mathbb{R}$ to $\\mathbb{R}$. For instance, one can fix non-zero real values for $y$ and $z$, say $y_0$ and $z_0$, and solve for $x$ via $x = \\sqrt[3]{(-by_0^3 - cz_0^3)/a}$, which is always a well-defined real number. Therefore, these curves are always soluble over $\\mathbb{R}$.\n\n2.  **p-adic Solubility Test ($C(\\mathbb{Q}_p) \\neq \\emptyset$)**: For each prime $p$ in the given set, we test for local solubility. By Hensel's Lemma, the existence of a *non-singular* solution modulo $p$ guarantees a solution in $\\mathbb{Q}_p$. A point $(x_0, y_0, z_0)$ is non-singular modulo $p$ if the gradient vector, $(\\frac{\\partial F}{\\partial x}, \\frac{\\partial F}{\\partial y}, \\frac{\\partial F}{\\partial z}) = (3ax^2, 3by^2, 3cz^2)$, is not congruent to $(0,0,0) \\pmod{p}$ at that point. If all solutions modulo $p$ are singular (which occurs systematically for primes $p$ dividing $3abc$), we take the existence of any non-trivial solution modulo $p^2$ as strong numerical evidence for solubility in $\\mathbb{Q}_p$. The search for modular solutions is optimized by iterating through $x$ and $y$ and using a hash map to find a corresponding $z$.\n\n3.  **Rational Solubility Test ($C(\\mathbb{Q}) \\neq \\emptyset$)**: We perform a bounded search for a non-trivial integer solution $(x,y,z) \\in \\mathbb{Z}^3 \\setminus \\{(0,0,0)\\}$ satisfying $ax^3 + by^3 + cz^3 = 0$ with $|x|, |y|, |z| \\leq B$. The search is implemented by iterating over integer values of $x$ and $y$ within the bound $[-B, B]$ and then calculating the required value of $cz^3 = -(ax^3+by^3)$. If this value is divisible by $c$ and the result is a perfect cube $z^3$ where $|z| \\leq B$, a rational point has been found.\n\n### Binary Quartic: $u^2 = dx^4 + ex^2 + f$\n\n1.  **Real Solubility Test ($C(\\mathbb{R}) \\neq \\emptyset$)**: A real solution exists if and only if the polynomial $g(x) = dx^4 + ex^2 + f$ is non-negative for some $x \\in \\mathbb{R}$.\n    - If $d > 0$, $g(x) \\to +\\infty$ as $|x| \\to \\infty$, guaranteeing that $g(x)$ takes non-negative values. The curve is soluble over $\\mathbb{R}$.\n    - If $d  0$, $g(x) \\to -\\infty$ as $|x| \\to \\infty$. A real solution exists only if the global maximum of $g(x)$ is non-negative. We find the maximum by checking the critical points, where $g'(x) = 4dx^3 + 2ex = 0$. This occurs at $x=0$ and potentially at $x = \\pm\\sqrt{-e/(2d)}$ if $-e/(2d) > 0$. If $\\sup_{x \\in \\mathbb{R}} g(x)  0$, the curve is not soluble over $\\mathbb{R}$.\n\n2.  **p-adic Solubility Test ($C(\\mathbb{Q}_p) \\neq \\emptyset$)**: The principle is the same as for cubics. A solution $(u_0, x_0)$ modulo $p$ is non-singular if the gradient vector $(\\frac{\\partial F}{\\partial u}, \\frac{\\partial F}{\\partial x}) = (2u, -(4dx^3 + 2ex))$ is not $(0,0) \\pmod{p}$ at that point. We search for such a point. If only singular solutions are found, we check for any solution modulo $p^2$. The search involves iterating through $x \\pmod{p^n}$ and checking if $dx^4+ex^2+f$ is a quadratic residue modulo $p^n$.\n\n3.  **Rational Solubility Test ($C(\\mathbb{Q}) \\neq \\emptyset$)**: We search for integer solutions $(x, u)$ within the bound $B$. Since $x$ appears with even powers, we only need to search for $x \\in [0, B]$. For each $x$, we compute $v = dx^4 + ex^2 + f$. If $v \\geq 0$ and is a perfect square, say $v=u^2$, with $|u| \\leq B$, a rational point has been found.\n\nBy combining these tests according to the specified classification rule, we can analyze each curve in the test suite.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef get_cbrt_if_int(n):\n    \"\"\"\n    Returns the integer cube root of n if it exists, otherwise None.\n    \"\"\"\n    if n == 0:\n        return 0\n    # np.cbrt handles signs correctly.\n    root = np.cbrt(n)\n    # Check if the root is an integer within a small tolerance for float inaccuracies.\n    i_root = int(round(root))\n    if i_root**3 == n:\n        return i_root\n    return None\n\ndef classify_cubic(a, b, c, B, primes):\n    \"\"\"\n    Classifies a diagonal cubic curve.\n    Returns 0 (local obstruction), 1 (rational point found), or 2 (candidate).\n    \"\"\"\n    # Step 1: Real Place Test\n    # For a*x^3 + b*y^3 + c*z^3 = 0, with a,b,c non-zero, a non-trivial\n    # real solution always exists. So, this test always passes.\n\n    # Step 2: Finite Place (p-adic) Tests\n    for p in primes:\n        is_locally_soluble_at_p = False\n        \n        # Test for a non-singular solution modulo p\n        cz3_map = { (c * pow(z, 3, p)) % p: z for z in range(p - 1, -1, -1) }\n        found_nonsingular_sol = False\n        for x in range(p):\n            for y in range(p):\n                target = (-a * pow(x, 3, p) - b * pow(y, 3, p)) % p\n                if target in cz3_map:\n                    z = cz3_map[target]\n                    if x != 0 or y != 0 or z != 0:\n                        # Gradient is (3ax^2, 3by^2, 3cz^2)\n                        grad_x = (3 * a * pow(x, 2, p)) % p\n                        grad_y = (3 * b * pow(y, 2, p)) % p\n                        grad_z = (3 * c * pow(z, 2, p)) % p\n                        if grad_x != 0 or grad_y != 0 or grad_z != 0:\n                            is_locally_soluble_at_p = True\n                            found_nonsingular_sol = True\n                            break\n            if found_nonsingular_sol:\n                break\n        \n        if not is_locally_soluble_at_p:\n            # If no non-singular solution mod p, test for any non-trivial solution mod p^2\n            M = p * p\n            cz3_map_p2 = { (c * pow(z, 3, M)) % M: z for z in range(M - 1, -1, -1) }\n            for x in range(M):\n                target = (-a * pow(x, 3, M) - b * pow(y, 3, M)) % M\n                if target in cz3_map_p2:\n                    z = cz3_map_p2[target]\n                    if x != 0 or y != 0 or z != 0:\n                        is_locally_soluble_at_p = True\n                        break\n\n        if not is_locally_soluble_at_p:\n            return 0 # Fails local solubility test at p\n\n    # Step 3: Rational Point Search\n    for x in range(-B, B + 1):\n        for y in range(-B, B + 1):\n            target_val = -a * x**3 - b * y**3\n            if c != 0 and target_val % c == 0:\n                z3_cand = target_val // c\n                z = get_cbrt_if_int(z3_cand)\n                if z is not None and abs(z) = B:\n                    if x != 0 or y != 0 or z != 0:\n                        return 1 # Found a rational point\n\n    return 2 # Locally soluble, no rational point found\n\ndef classify_quartic(d, e, f, B, primes):\n    \"\"\"\n    Classifies a binary quartic curve.\n    Returns 0 (local obstruction), 1 (rational point found), or 2 (candidate).\n    \"\"\"\n    # Step 1: Real Place Test\n    # Let g(x) = d*x^4 + e*x^2 + f.\n    if d > 0:\n        pass # g(x) -> +inf as |x| -> inf, so real solution exists.\n    else: # d = 0\n        if d == 0: # Not in test suite but handle for completeness\n            if e = 0 and f  0: return 0\n        else: # d  0\n            # g(x) -> -inf. Check supremum. g'(x) = 2x(2dx^2 + e).\n            max_g = float(f) # Value at x=0\n            if -e / (2 * d) > 0:\n                x_sq_crit = -e / (2 * d)\n                g_crit = d * x_sq_crit**2 + e * x_sq_crit + f\n                max_g = max(max_g, g_crit)\n            if max_g  0:\n                return 0 # No real solution\n    \n    # Step 2: Finite Place (p-adic) Tests\n    for p in primes:\n        is_locally_soluble_at_p = False\n\n        # Test for a non-singular solution modulo p\n        mod_sqrt_map = {pow(u, 2, p): u for u in range(p)}\n        found_nonsingular_sol = False\n        for x in range(p):\n            rhs = (d * pow(x, 4, p) + e * pow(x, 2, p) + f) % p\n            if rhs in mod_sqrt_map:\n                u = mod_sqrt_map[rhs]\n                # Gradient is (2u, -(4dx^3+2ex))\n                # Check point (u, x)\n                grad_x = (- (4 * d * pow(x, 3, p) + 2 * e * x)) % p\n                if (2 * u) % p != 0 or grad_x != 0:\n                    is_locally_soluble_at_p = True\n                    found_nonsingular_sol = True\n                    break\n                # Check point (-u, x) if first was singular (must be u=0)\n                if u == 0 and grad_x != 0: # This case is covered above but makes logic clear\n                    is_locally_soluble_at_p = True\n                    found_nonsingular_sol = True\n                    break\n\n        if not found_nonsingular_sol:\n            # Test for any solution mod p^2\n            M = p * p\n            squares_p2 = {pow(i, 2, M) for i in range(M)}\n            for x in range(M):\n                rhs = (d * pow(x, 4, M) + e * pow(x, 2, M) + f) % M\n                if rhs in squares_p2:\n                    is_locally_soluble_at_p = True\n                    break\n        \n        if not is_locally_soluble_at_p:\n            return 0 # Fails local solubility test at p\n\n    # Step 3: Rational Point Search\n    for x in range(B + 1):\n        val = d * x**4 + e * x**2 + f\n        if val >= 0:\n            # Use floating point sqrt and check if it's an integer\n            u_cand = np.sqrt(val)\n            if u_cand == int(u_cand):\n                u = int(u_cand)\n                if u = B:\n                    return 1 # Found a rational point\n\n    return 2 # Locally soluble, no rational point found\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis on the test suite.\n    \"\"\"\n    test_cases = [\n        {'type': 'cubic', 'a': 1, 'b': 1, 'c': -1, 'B': 60, 'primes': [2, 3, 5, 7, 11]},\n        {'type': 'cubic', 'a': 3, 'b': 4, 'c': 5, 'B': 120, 'primes': [2, 3, 5, 7, 11]},\n        {'type': 'quartic', 'd': -1, 'e': 0, 'f': -1, 'B': 80, 'primes': [2, 3, 5, 7, 11]},\n        {'type': 'quartic', 'd': 1, 'e': -5, 'f': 4, 'B': 80, 'primes': [2, 3, 5, 7, 11]},\n    ]\n\n    results = []\n    for case in test_cases:\n        if case['type'] == 'cubic':\n            result = classify_cubic(case['a'], case['b'], case['c'], case['B'], case['primes'])\n        else: # quartic\n            result = classify_quartic(case['d'], case['e'], case['f'], case['B'], case['primes'])\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3029554"}, {"introduction": "While computational searches can identify individual obstructions to the Hasse principle, number theory seeks algebraic methods to understand the structure of $\\Sha$ as a group. The method of descent provides a powerful tool for calculating the $n$-torsion subgroup, $\\Sha(E/\\mathbb{Q})[n]$. This detailed exercise [@problem_id:3029553] guides you through the core mechanics of a 2-descent, connecting the fundamental exact sequence of arithmetic to the dimensions of local cohomology groups and the concept of maximal isotropic subspaces from Tate duality.", "problem": "Let $E/\\mathbb{Q}$ be an elliptic curve which has full rational $2$-torsion, $E[2](\\mathbb{Q}) \\cong (\\mathbb{Z}/2\\mathbb{Z})^{2}$, and Mordell–Weil rank $r(E/\\mathbb{Q}) = 1$. For a place $v$ of $\\mathbb{Q}$, let $K_{v} = \\mathbb{Q}_{v}$ denote the corresponding local field. Consider the short exact sequence of group schemes over $\\mathbb{Q}$,\n$$\n0 \\longrightarrow E[2] \\longrightarrow E \\xrightarrow{[2]} E \\longrightarrow 0,\n$$\nand its associated long exact sequence in Galois cohomology over $\\mathbb{Q}$ and over each local field $K_{v}$. The Kummer maps attach to each place $v$ a homomorphism\n$$\n\\delta_{v} \\colon E(K_{v})/2E(K_{v}) \\longrightarrow H^{1}(K_{v}, E[2]),\n$$\nand the global Kummer map\n$$\n\\delta \\colon E(\\mathbb{Q})/2E(\\mathbb{Q}) \\longrightarrow H^{1}(\\mathbb{Q}, E[2]).\n$$\nBy local Tate duality, there is a perfect, alternating pairing\n$$\n\\langle\\cdot,\\cdot\\rangle_{v} \\colon H^{1}(K_{v}, E[2]) \\times H^{1}(K_{v}, E[2]) \\longrightarrow \\mathbb{Q}/\\mathbb{Z},\n$$\ncompatible with the Weil pairing $E[2] \\times E[2] \\to \\mu_{2}$. The $2$-Selmer group $\\operatorname{Sel}^{(2)}(E/\\mathbb{Q})$ is the subgroup of $H^{1}(\\mathbb{Q}, E[2])$ consisting of classes whose local images lie in the local Kummer images $\\operatorname{im}(\\delta_{v}) \\subseteq H^{1}(K_{v}, E[2])$ for all places $v$. The Tate–Shafarevich group $\\Sha(E/\\mathbb{Q})$ is defined as the kernel of the localization map $H^{1}(\\mathbb{Q}, E) \\to \\prod_{v} H^{1}(K_{v}, E)$.\n\nTasks:\n1. Using that $E[2]$ is a trivial $\\operatorname{Gal}(\\overline{\\mathbb{Q}}/\\mathbb{Q})$-module of rank $2$ over $\\mathbb{F}_{2}$ for this curve, deduce that $H^{1}(K_{v}, E[2]) \\cong H^{1}(K_{v}, \\mathbb{Z}/2\\mathbb{Z})^{\\oplus 2}$ for every place $v$, and compute the $\\mathbb{F}_{2}$-dimensions of $H^{1}(\\mathbb{Q}_{2}, E[2])$, $H^{1}(\\mathbb{Q}_{3}, E[2])$, and $H^{1}(\\mathbb{R}, E[2])$.\n2. Using local Tate duality and the compatibility of the Kummer map with the local pairing, argue that for each place $v$, the subspace $\\operatorname{im}(\\delta_{v}) \\subseteq H^{1}(K_{v}, E[2])$ is maximal isotropic. Deduce from this the $\\mathbb{F}_{2}$-dimensions of $\\operatorname{im}(\\delta_{2})$, $\\operatorname{im}(\\delta_{3})$, and $\\operatorname{im}(\\delta_{\\infty})$.\n3. From the Kummer sequence and the definitions of the $2$-Selmer group and the Tate–Shafarevich group, derive an exact sequence relating $E(\\mathbb{Q})/2E(\\mathbb{Q})$, $\\operatorname{Sel}^{(2)}(E/\\mathbb{Q})$, and $\\Sha(E/\\mathbb{Q})[2]$.\n4. Assume that a $2$-descent computation for this curve yields $\\dim_{\\mathbb{F}_{2}}\\big(\\operatorname{Sel}^{(2)}(E/\\mathbb{Q})\\big) = 5$. Using your exact sequence from Task 3 and the given rank and torsion information for $E(\\mathbb{Q})$, compute the number $\\dim_{\\mathbb{F}_{2}}\\big(\\Sha(E/\\mathbb{Q})[2]\\big)$.\n\nYour final answer must be this single $\\mathbb{F}_{2}$-dimension as a number.", "solution": "The problem asks for the computation of the $\\mathbb{F}_{2}$-dimension of the $2$-torsion of the Tate–Shafarevich group, $\\Sha(E/\\mathbb{Q})[2]$, for an elliptic curve $E/\\mathbb{Q}$ with certain specified properties. The solution proceeds by following the four specified tasks.\n\n### Task 1: Dimensions of Local Cohomology Groups\n\nThe problem states that the elliptic curve $E$ has full rational $2$-torsion, meaning $E[2](\\mathbb{Q}) = E[2](\\overline{\\mathbb{Q}})$. This implies that the Galois group $\\operatorname{Gal}(\\overline{\\mathbb{Q}}/\\mathbb{Q})$ acts trivially on $E[2]$. As an abelian group, $E[2] \\cong (\\mathbb{Z}/2\\mathbb{Z})^{2}$. Thus, as an $\\mathbb{F}_{2}$-vector space, $E[2]$ has dimension $2$.\n\nSince the global Galois group acts trivially, so does any of its subgroups, including the decomposition groups $\\operatorname{Gal}(\\overline{K_{v}}/K_{v})$ for any place $v$ of $\\mathbb{Q}$. Therefore, for each local field $K_{v} = \\mathbb{Q}_{v}$, $E[2]$ is a trivial $\\operatorname{Gal}(\\overline{K_{v}}/K_{v})$-module. The first cohomology group is then:\n$$\nH^{1}(K_{v}, E[2]) \\cong H^{1}(K_{v}, (\\mathbb{Z}/2\\mathbb{Z})^{2}) \\cong H^{1}(K_{v}, \\mathbb{Z}/2\\mathbb{Z}) \\oplus H^{1}(K_{v}, \\mathbb{Z}/2\\mathbb{Z})\n$$\nThe group $H^{1}(K_{v}, \\mathbb{Z}/2\\mathbb{Z}) \\cong H^{1}(K_{v}, \\mu_{2})$ classifies quadratic extensions of $K_{v}$. By Kummer theory, this group is isomorphic to $K_{v}^{\\times}/(K_{v}^{\\times})^{2}$. We need to compute the $\\mathbb{F}_{2}$-dimension of this group for $v=2, 3, \\infty$. The dimension is $\\log_{2}(|K_{v}^{\\times}/(K_{v}^{\\times})^{2}|)$.\n\n-   For $v = \\infty$, $K_{\\infty} = \\mathbb{R}$. The group of square classes is $\\mathbb{R}^{\\times}/(\\mathbb{R}^{\\times})^{2} \\cong \\{ \\pm 1 \\}$, which has order $2$.\n    Thus, $\\dim_{\\mathbb{F}_{2}} H^{1}(\\mathbb{R}, \\mathbb{Z}/2\\mathbb{Z}) = 1$.\n    The dimension of the full cohomology group is $\\dim_{\\mathbb{F}_{2}} H^{1}(\\mathbb{R}, E[2]) = 2 \\times 1 = 2$.\n\n-   For $v = 3$, $K_{3} = \\mathbb{Q}_{3}$. For a non-archimedean local field $\\mathbb{Q}_{p}$ with $p$ an odd prime, the group of square classes $\\mathbb{Q}_{p}^{\\times}/(\\mathbb{Q}_{p}^{\\times})^{2}$ has order $4$.\n    Thus, $\\dim_{\\mathbb{F}_{2}} H^{1}(\\mathbb{Q}_{3}, \\mathbb{Z}/2\\mathbb{Z}) = 2$.\n    The dimension of the full cohomology group is $\\dim_{\\mathbb{F}_{2}} H^{1}(\\mathbb{Q}_{3}, E[2]) = 2 \\times 2 = 4$.\n\n-   For $v = 2$, $K_{2} = \\mathbb{Q}_{2}$. The group of square classes $\\mathbb{Q}_{2}^{\\times}/(\\mathbb{Q}_{2}^{\\times})^{2}$ has order $8$.\n    Thus, $\\dim_{\\mathbb{F}_{2}} H^{1}(\\mathbb{Q}_{2}, \\mathbb{Z}/2\\mathbb{Z}) = 3$.\n    The dimension of the full cohomology group is $\\dim_{\\mathbb{F}_{2}} H^{1}(\\mathbb{Q}_{2}, E[2]) = 2 \\times 3 = 6$.\n\nIn summary: $\\dim_{\\mathbb{F}_{2}} H^{1}(\\mathbb{Q}_{2}, E[2]) = 6$, $\\dim_{\\mathbb{F}_{2}} H^{1}(\\mathbb{Q}_{3}, E[2]) = 4$, and $\\dim_{\\mathbb{F}_{2}} H^{1}(\\mathbb{R}, E[2]) = 2$.\n\n### Task 2: Dimensions of Local Kummer Images\n\nLocal Tate duality provides a perfect, alternating pairing (the Cassels-Tate pairing) on the $\\mathbb{F}_{2}$-vector space $V_{v} = H^{1}(K_{v}, E[2])$. A subspace $W \\subseteq V_{v}$ is isotropic if $W \\subseteq W^{\\perp}$, where $W^{\\perp}$ is the orthogonal complement with respect to the pairing. A subspace is maximal isotropic if $W = W^{\\perp}$. For a finite-dimensional vector space $V_{v}$ of dimension $n$ with a non-degenerate alternating form, any maximal isotropic subspace has dimension $n/2$.\n\nA fundamental result of the theory of elliptic curves over local fields states that the image of the local Kummer map, $\\operatorname{im}(\\delta_{v}) \\subseteq H^{1}(K_{v}, E[2])$, is a maximal isotropic subspace with respect to this pairing. This follows from the compatibility of the local Kummer sequence and the Poitou-Tate duality sequence. Specifically, the image of $\\delta_{v}$ can be identified with the kernel of the map $H^{1}(K_v, E[2]) \\to H^{1}(K_v, E)$, and standard duality theorems show this kernel to be its own annihilator.\n\nTherefore, the dimension of $\\operatorname{im}(\\delta_{v})$ is half the dimension of the ambient space $H^{1}(K_{v}, E[2])$. Using the results from Task 1:\n-   $\\dim_{\\mathbb{F}_{2}}(\\operatorname{im}(\\delta_{2})) = \\frac{1}{2}\\dim_{\\mathbb{F}_{2}} H^{1}(\\mathbb{Q}_{2}, E[2]) = \\frac{6}{2} = 3$.\n-   $\\dim_{\\mathbb{F}_{2}}(\\operatorname{im}(\\delta_{3})) = \\frac{1}{2}\\dim_{\\mathbb{F}_{2}} H^{1}(\\mathbb{Q}_{3}, E[2]) = \\frac{4}{2} = 2$.\n-   $\\dim_{\\mathbb{F}_{2}}(\\operatorname{im}(\\delta_{\\infty})) = \\frac{1}{2}\\dim_{\\mathbb{F}_{2}} H^{1}(\\mathbb{R}, E[2]) = \\frac{2}{2} = 1$.\n\n### Task 3: The Fundamental Exact Sequence\n\nThe short exact sequence of $\\operatorname{Gal}(\\overline{\\mathbb{Q}}/\\mathbb{Q})$-modules $0 \\to E[2] \\to E(\\overline{\\mathbb{Q}}) \\xrightarrow{[2]} E(\\overline{\\mathbb{Q}}) \\to 0$ gives rise to a long exact sequence in Galois cohomology. A segment of this sequence provides the global Kummer sequence:\n$$\n0 \\longrightarrow E(\\mathbb{Q})/2E(\\mathbb{Q}) \\xrightarrow{\\delta} H^{1}(\\mathbb{Q}, E[2]) \\xrightarrow{\\alpha} H^{1}(\\mathbb{Q}, E)[2] \\longrightarrow 0\n$$\nHere, $H^{1}(\\mathbb{Q}, E)[2]$ denotes the $2$-torsion subgroup of $H^{1}(\\mathbb{Q}, E)$. The Selmer group $\\operatorname{Sel}^{(2)}(E/\\mathbb{Q})$ is the subgroup of $c \\in H^{1}(\\mathbb{Q}, E[2])$ whose local restriction $\\operatorname{res}_{v}(c)$ lies in $\\operatorname{im}(\\delta_{v})$ for all places $v$. From the local Kummer sequence, $\\operatorname{im}(\\delta_{v}) = \\ker(H^{1}(K_{v}, E[2]) \\to H^{1}(K_{v}, E))$. Thus, an element $c \\in H^{1}(\\mathbb{Q}, E[2])$ is in $\\operatorname{Sel}^{(2)}(E/\\mathbb{Q})$ if and only if for all $v$, its image in $H^{1}(K_{v}, E)$, which is $\\operatorname{res}_{v}(\\alpha(c))$, is zero.\n\nThis means that the image of $\\operatorname{Sel}^{(2)}(E/\\mathbb{Q})$ under the map $\\alpha$ consists of elements in $H^{1}(\\mathbb{Q}, E)$ that are locally trivial everywhere. By definition, this is the Tate–Shafarevich group $\\Sha(E/\\mathbb{Q})$. Since the image of $\\alpha$ is contained in $H^{1}(\\mathbb{Q}, E)[2]$, the map $\\alpha$ restricts to a homomorphism $\\alpha': \\operatorname{Sel}^{(2)}(E/\\mathbb{Q}) \\to \\Sha(E/\\mathbb{Q})[2]$.\n\nThe kernel of this restricted map $\\alpha'$ is the same as the kernel of the original map $\\alpha$, which by the exactness of the Kummer sequence is $\\operatorname{im}(\\delta) \\cong E(\\mathbb{Q})/2E(\\mathbb{Q})$.\nThe map $\\alpha'$ is surjective, which is a standard result in the theory. An element of $\\Sha(E/\\mathbb{Q})[2]$ lifts to an element of $H^1(\\mathbb{Q}, E[2])$ which can be shown to satisfy the Selmer conditions.\nThis yields the fundamental short exact sequence:\n$$\n0 \\longrightarrow E(\\mathbb{Q})/2E(\\mathbb{Q}) \\longrightarrow \\operatorname{Sel}^{(2)}(E/\\mathbb{Q}) \\longrightarrow \\Sha(E/\\mathbb{Q})[2] \\longrightarrow 0\n$$\nAs these are all vector spaces over $\\mathbb{F}_{2}$, their dimensions are related by:\n$$\n\\dim_{\\mathbb{F}_{2}}(\\operatorname{Sel}^{(2)}(E/\\mathbb{Q})) = \\dim_{\\mathbb{F}_{2}}(E(\\mathbb{Q})/2E(\\mathbb{Q})) + \\dim_{\\mathbb{F}_{2}}(\\Sha(E/\\mathbb{Q})[2])\n$$\n\n### Task 4: Final Computation\n\nFrom Task 3, we have the formula:\n$$\n\\dim_{\\mathbb{F}_{2}}(\\Sha(E/\\mathbb{Q})[2]) = \\dim_{\\mathbb{F}_{2}}(\\operatorname{Sel}^{(2)}(E/\\mathbb{Q})) - \\dim_{\\mathbb{F}_{2}}(E(\\mathbb{Q})/2E(\\mathbb{Q}))\n$$\nThe problem states that a $2$-descent computation yields $\\dim_{\\mathbb{F}_{2}}(\\operatorname{Sel}^{(2)}(E/\\mathbb{Q})) = 5$. We need to compute the dimension of the $2$-Selmer group of the Mordell-Weil group, $E(\\mathbb{Q})/2E(\\mathbb{Q})$.\n\nThe Mordell-Weil theorem states that $E(\\mathbb{Q}) \\cong \\mathbb{Z}^{r} \\oplus E(\\mathbb{Q})_{\\text{tors}}$, where $r$ is the rank and $E(\\mathbb{Q})_{\\text{tors}}$ is the finite torsion subgroup.\nWe are given the rank $r = r(E/\\mathbb{Q}) = 1$.\nWe are also given that the curve has full rational $2$-torsion, $E[2](\\mathbb{Q}) \\cong (\\mathbb{Z}/2\\mathbb{Z})^{2}$. This is the $2$-torsion subgroup of $E(\\mathbb{Q})$.\n\nThe dimension of $E(\\mathbb{Q})/2E(\\mathbb{Q})$ as an $\\mathbb{F}_{2}$-vector space is given by the formula $\\dim_{\\mathbb{F}_{2}}(E(\\mathbb{Q})/2E(\\mathbb{Q})) = r + \\dim_{\\mathbb{F}_{2}}(E(\\mathbb{Q})[2])$.\nWith $r=1$ and $\\dim_{\\mathbb{F}_{2}}(E(\\mathbb{Q})[2]) = 2$, this gives $1+2=3$.\n\nFinally, we substitute the dimensions into our equation:\n$$\n\\dim_{\\mathbb{F}_{2}}(\\Sha(E/\\mathbb{Q})[2]) = 5 - 3 = 2\n$$\nThe $\\mathbb{F}_{2}$-dimension of the $2$-torsion of the Tate–Shafarevich group is $2$.", "answer": "$$\\boxed{2}$$", "id": "3029553"}, {"introduction": "The full importance of the Tate-Shafarevich group is captured by the Birch and Swinnerton-Dyer (BSD) conjecture, one of the most profound statements in modern number theory. The conjecture predicts a deep relationship between the analytic behavior of an elliptic curve's $L$-function and its core arithmetic invariants, including the order of $\\Sha$. This practice [@problem_id:3029564] provides a direct application of this principle, where you will use the (proven) BSD formula for a specific elliptic curve to compute the exact order of its Tate-Shafarevich group.", "problem": "Let $E/\\mathbb{Q}$ be the elliptic curve given by the short Weierstrass equation $y^{2}=x^{3}-x$. The curve $E$ has Complex Multiplication (CM) by the Gaussian integers $\\mathbb{Z}[i]$ and good reduction outside the prime $p=2$; in particular, for primes $p \\equiv 3 \\pmod{4}$ it has supersingular reduction. Denote by $\\Sha(E/\\mathbb{Q})$ the Tate–Shafarevich group of $E$ over $\\mathbb{Q}$, defined as the kernel of the localization map from the first Galois cohomology group $H^{1}(\\mathbb{Q},E)$ to the product $\\prod_{v} H^{1}(\\mathbb{Q}_{v},E)$ over all places $v$ of $\\mathbb{Q}$. Let $\\Omega_{E}$ be the real Néron period, $\\prod_{p} c_{p}$ the product of Tamagawa numbers over all finite primes, and let $E(\\mathbb{Q})_{\\mathrm{tors}}$ denote the torsion subgroup of $E(\\mathbb{Q})$.\n\nYou are given the following facts, each of which is standard for this CM curve and can be verified independently from the definitions and the theory of minimal models and reduction:\n- The Mordell–Weil rank of $E(\\mathbb{Q})$ is $0$, so the regulator is $1$.\n- The torsion subgroup has order $\\#E(\\mathbb{Q})_{\\mathrm{tors}}=4$.\n- The only bad prime is $p=2$, and the product of Tamagawa numbers satisfies $\\prod_{p} c_{p}=2$.\n- The analytic $L$-function satisfies $L(E,1)=\\dfrac{\\Omega_{E}}{8}$.\n\nAssume the rank-zero case of the Birch–Swinnerton-Dyer (BSD) theorem for CM elliptic curves over $\\mathbb{Q}$, which is known in this setting, so that the leading term $L(E,1)$ agrees with the algebraic expression involving $\\Omega_{E}$, $\\prod_{p}c_{p}$, $\\#E(\\mathbb{Q})_{\\mathrm{tors}}$, and $\\#\\Sha(E/\\mathbb{Q})$.\n\nCompute the exact value of $\\#\\Sha(E/\\mathbb{Q})$. Give your answer as a single integer (no units, no rounding).", "solution": "The problem requires the computation of the order of the Tate-Shafarevich group, denoted as $\\#\\Sha(E/\\mathbb{Q})$, for the elliptic curve $E$ given by the equation $y^2 = x^3 - x$. The solution relies on applying the Birch and Swinnerton-Dyer (BSD) conjecture, which is stated to be a known theorem for this specific curve.\n\nThe general form of the BSD conjecture relates the leading term of the Hasse-Weil $L$-function $L(E,s)$ at the point $s=1$ to several algebraic invariants of the curve. The full statement is:\n$$ \\lim_{s \\to 1} \\frac{L(E,s)}{(s-1)^{r}} = \\frac{\\Omega_{E} \\cdot \\mathrm{Reg}_{E/\\mathbb{Q}} \\cdot \\prod_{p} c_{p} \\cdot \\#\\Sha(E/\\mathbb{Q})}{(\\#E(\\mathbb{Q})_{\\mathrm{tors}})^{2}} $$\nwhere:\n- $r$ is the rank of the Mordell-Weil group $E(\\mathbb{Q})$.\n- $L(E,s)$ is the Hasse-Weil $L$-function of $E$.\n- $\\Omega_{E}$ is the real Néron period of $E$.\n- $\\mathrm{Reg}_{E/\\mathbb{Q}}$ is the regulator of $E(\\mathbb{Q})$.\n- $\\prod_{p} c_{p}$ is the product of the Tamagawa numbers $c_p$ over all finite primes $p$.\n- $\\#\\Sha(E/\\mathbb{Q})$ is the order of the Tate-Shafarevich group of $E$ over $\\mathbb{Q}$.\n- $\\#E(\\mathbb{Q})_{\\mathrm{tors}}$ is the order of the torsion subgroup of $E(\\mathbb{Q})$.\n\nThe problem provides specific values for each of these quantities for the curve $y^2 = x^3 - x$. We are given that the rank of $E(\\mathbb{Q})$ is $r=0$. When the rank is zero, the Mordell-Weil group $E(\\mathbb{Q})$ is finite, consisting only of torsion points. In this case, the BSD formula simplifies considerably.\n\nFor $r=0$, the limit on the left-hand side becomes the value of the $L$-function at $s=1$:\n$$ \\lim_{s \\to 1} \\frac{L(E,s)}{(s-1)^{0}} = L(E,1) $$\nAlso, for a group of rank $r=0$, the regulator is defined to be $\\mathrm{Reg}_{E/\\mathbb{Q}} = 1$.\n\nSubstituting these into the general BSD formula, we obtain the specialized version for a rank-zero curve:\n$$ L(E,1) = \\frac{\\Omega_{E} \\cdot 1 \\cdot \\prod_{p} c_{p} \\cdot \\#\\Sha(E/\\mathbb{Q})}{(\\#E(\\mathbb{Q})_{\\mathrm{tors}})^{2}} $$\n\nWe are given the following values in the problem statement:\n- The Mordell-Weil rank is $r=0$.\n- The order of the torsion subgroup is $\\#E(\\mathbb{Q})_{\\mathrm{tors}} = 4$.\n- The product of Tamagawa numbers is $\\prod_{p} c_{p} = 2$.\n- The analytic $L$-function value is $L(E,1) = \\frac{\\Omega_{E}}{8}$.\n\nWe can now substitute these known values into the rank-zero BSD formula to solve for $\\#\\Sha(E/\\mathbb{Q})$:\n$$ \\frac{\\Omega_{E}}{8} = \\frac{\\Omega_{E} \\cdot 2 \\cdot \\#\\Sha(E/\\mathbb{Q})}{4^{2}} $$\n\nThe real period $\\Omega_{E}$ is a positive real number, specifically $\\Omega_E = \\int_1^\\infty \\frac{dx}{\\sqrt{x^3-x}}$, so it can be canceled from both sides of the equation.\n$$ \\frac{1}{8} = \\frac{2 \\cdot \\#\\Sha(E/\\mathbb{Q})}{16} $$\n\nSimplifying the fraction on the right-hand side:\n$$ \\frac{1}{8} = \\frac{\\#\\Sha(E/\\mathbb{Q})}{8} $$\n\nMultiplying both sides by $8$ gives the order of the Tate-Shafarevich group:\n$$ \\#\\Sha(E/\\mathbb{Q}) = 1 $$\n\nThus, the Tate-Shafarevich group for this elliptic curve is trivial.", "answer": "$$\\boxed{1}$$", "id": "3029564"}]}