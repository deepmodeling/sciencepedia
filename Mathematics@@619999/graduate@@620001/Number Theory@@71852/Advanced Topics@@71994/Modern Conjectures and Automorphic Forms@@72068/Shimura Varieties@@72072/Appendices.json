{"hands_on_practices": [{"introduction": "The geometric foundation of many Shimura varieties is a special type of complex manifold known as a Hermitian symmetric domain. This exercise guides you through a foundational construction, showing how the Siegel upper half-space $\\mathfrak{H}_g$ arises naturally as the symmetric space for the symplectic group $\\operatorname{Sp}_{2g}(\\mathbb{R})$. By understanding this construction from first principles, you will gain a concrete grasp of the geometric stage upon which the arithmetic theory of Siegel modular forms is built [@problem_id:3023609].", "problem": "Let $G = \\operatorname{Sp}_{2g}(\\mathbb{R})$ denote the real symplectic group of rank $g$, defined as the subgroup of $\\operatorname{GL}_{2g}(\\mathbb{R})$ that preserves the standard symplectic form represented by the matrix $J_0 = \\begin{pmatrix} 0 & I_g \\\\ -I_g & 0 \\end{pmatrix}$, so $G = \\{ M \\in \\operatorname{GL}_{2g}(\\mathbb{R}) \\mid M^{\\mathsf{t}} J_0 M = J_0 \\}$. Consider the associated Riemannian symmetric space $X = G/K$ of non-compact type, where $K \\simeq U(g)$ is a maximal compact subgroup. Using only foundational definitions from Lie groups, symplectic linear algebra, and Hermitian symmetric domains, identify $X$ explicitly as a classical domain in complex matrices and derive its complex-analytic structure from first principles. Then, compute the complex dimension of $X$ as a function of $g$.\n\nYou must proceed by:\n- Starting from the definition of the symplectic group and of an $\\omega$-compatible complex structure on $\\mathbb{R}^{2g}$, where $\\omega$ is the standard symplectic form.\n- Constructing the Hermitian symmetric domain naturally associated to $G$, by identifying $X$ with a domain of complex symmetric $g \\times g$ matrices subject to a positivity condition derived from the symplectic form and an $\\omega$-compatible metric.\n- Explaining why this identification is $G$-equivariant and why $K$ is the stabilizer of a canonical base point, thereby justifying $X \\simeq G/K$.\n- Computing the complex dimension of this domain using basic linear-algebraic counting.\n\nExpress your final answer as a single closed-form expression in terms of $g$. Report only the complex dimension, with no units. No rounding is required.", "solution": "The problem asks to identify the Riemannian symmetric space $X = G/K$, where $G = \\operatorname{Sp}_{2g}(\\mathbb{R})$ and $K \\simeq U(g)$ is a maximal compact subgroup, as a classical complex domain and to compute its complex dimension. The space $X$ is a Hermitian symmetric domain, and we will identify it with the Siegel upper half-space $\\mathfrak{H}_g$.\n\nLet $G = \\operatorname{Sp}_{2g}(\\mathbb{R})$ be the group of $2g \\times 2g$ real matrices $M$ that preserve the standard symplectic form $\\omega$ on $V=\\mathbb{R}^{2g}$. The form $\\omega$ is defined by $\\omega(v,w) = v^{\\mathsf{t}} J_0 w$ for $v, w \\in V$, where $J_0 = \\begin{pmatrix} 0 & I_g \\\\ -I_g & 0 \\end{pmatrix}$. The condition for a matrix $M \\in \\operatorname{GL}_{2g}(\\mathbb{R})$ to be in $G$ is $M^{\\mathsf{t}} J_0 M = J_0$.\n\nWe will demonstrate that the symmetric space $G/K$ can be realized as the Siegel upper half-space $\\mathfrak{H}_g$, defined as:\n$$ \\mathfrak{H}_g = \\{ Z \\in M_g(\\mathbb{C}) \\mid Z = Z^{\\mathsf{t}}, \\operatorname{Im}(Z) > 0 \\} $$\nHere, $M_g(\\mathbb{C})$ is the space of $g \\times g$ complex matrices, $Z^{\\mathsf{t}}$ denotes the transpose of $Z$, and $\\operatorname{Im}(Z) > 0$ means that the imaginary part of $Z$, which is a real symmetric matrix, is positive-definite.\n\nThe identification is achieved by defining a group action of $G$ on $\\mathfrak{H}_g$ and showing that it is transitive with the stabilizer of a point being isomorphic to $U(g)$.\n\nLet $M = \\begin{pmatrix} A & B \\\\ C & D \\end{pmatrix} \\in G$, where $A, B, C, D$ are $g \\times g$ real matrices. The action of $M$ on a point $Z \\in \\mathfrak{H}_g$ is given by a fractional linear transformation:\n$$ M \\cdot Z = (AZ+B)(CZ+D)^{-1} $$\nFor this action to be well-defined, $CZ+D$ must be invertible for any $Z \\in \\mathfrak{H}_g$. We must verify that $M \\cdot Z$ is also in $\\mathfrak{H}_g$.\n\nFirst, we establish the properties of the block matrices of $M \\in \\operatorname{Sp}_{2g}(\\mathbb{R})$. The condition $M^{\\mathsf{t}} J_0 M = J_0$ translates to:\n$$ \\begin{pmatrix} A^{\\mathsf{t}} & C^{\\mathsf{t}} \\\\ B^{\\mathsf{t}} & D^{\\mathsf{t}} \\end{pmatrix} \\begin{pmatrix} 0 & I_g \\\\ -I_g & 0 \\end{pmatrix} \\begin{pmatrix} A & B \\\\ C & D \\end{pmatrix} = \\begin{pmatrix} -C^{\\mathsf{t}}A+A^{\\mathsf{t}}C & -C^{\\mathsf{t}}B+A^{\\mathsf{t}}D \\\\ -D^{\\mathsf{t}}A+B^{\\mathsf{t}}C & -D^{\\mathsf{t}}B+B^{\\mathsf{t}}D \\end{pmatrix} = \\begin{pmatrix} 0 & I_g \\\\ -I_g & 0 \\end{pmatrix} $$\nThis yields the relations:\n1. $A^{\\mathsf{t}}C = C^{\\mathsf{t}}A$\n2. $B^{\\mathsf{t}}D = D^{\\mathsf{t}}B$\n3. $A^{\\mathsf{t}}D - C^{\\mathsf{t}}B = I_g$\n\nLet $Z' = M \\cdot Z$. We verify the two conditions for $Z' \\in \\mathfrak{H}_g$:\n(i) Symmetry of $Z'$: We must show $(Z')^{\\mathsf{t}} = Z'$.\n$$ (Z')^{\\mathsf{t}} = ((CZ+D)^{-1})^{\\mathsf{t}} (AZ+B)^{\\mathsf{t}} = ((CZ+D)^{\\mathsf{t}})^{-1} (Z^{\\mathsf{t}}A^{\\mathsf{t}}+B^{\\mathsf{t}}) $$\nSince $Z = Z^{\\mathsf{t}}$, we have $(Z')^{\\mathsf{t}} = (ZC^{\\mathsf{t}}+D^{\\mathsf{t}})^{-1} (ZA^{\\mathsf{t}}+B^{\\mathsf{t}})$.\nWe check if $(Z')^{\\mathsf{t}} = Z'$ by verifying if $(ZC^{\\mathsf{t}}+D^{\\mathsf{t}})Z' = ZA^{\\mathsf{t}}+B^{\\mathsf{t}}$.\n$$ (ZC^{\\mathsf{t}}+D^{\\mathsf{t}})(AZ+B)(CZ+D)^{-1} = ZA^{\\mathsf{t}}+B^{\\mathsf{t}} $$\nThis is equivalent to showing $(ZC^{\\mathsf{t}}+D^{\\mathsf{t}})(AZ+B)=(ZA^{\\mathsf{t}}+B^{\\mathsf{t}})(CZ+D)$.\nLHS: $ZC^{\\mathsf{t}}AZ + ZC^{\\mathsf{t}}B + D^{\\mathsf{t}}AZ + D^{\\mathsf{t}}B$. Using $C^{\\mathsf{t}}A=A^{\\mathsf{t}}C$, this is $ZA^{\\mathsf{t}}CZ + ZC^{\\mathsf{t}}B + D^{\\mathsf{t}}AZ + D^{\\mathsf{t}}B$.\nRHS: $ZA^{\\mathsf{t}}CZ + ZA^{\\mathsf{t}}D + B^{\\mathsf{t}}CZ + B^{\\mathsf{t}}D$. Using $B^{\\mathsf{t}}D=D^{\\mathsf{t}}B$, this is $ZA^{\\mathsf{t}}CZ + ZA^{\\mathsf{t}}D + B^{\\mathsf{t}}CZ + D^{\\mathsf{t}}B$.\nEquating the two expressions, we need to show $ZC^{\\mathsf{t}}B + D^{\\mathsf{t}}AZ = ZA^{\\mathsf{t}}D + B^{\\mathsf{t}}CZ$.\nThis can be rewritten as $Z(C^{\\mathsf{t}}B-A^{\\mathsf{t}}D) = (B^{\\mathsf{t}}C - D^{\\mathsf{t}}A)Z$.\nFrom relation (3), $A^{\\mathsf{t}}D-C^{\\mathsf{t}}B=I_g$. Transposing it gives $D^{\\mathsf{t}}A-B^{\\mathsf{t}}C=I_g$.\nSubstituting these into the equality requirement gives $Z(-I_g)=(-I_g)Z$, which is true. Thus, $Z'$ is symmetric.\n\n(ii) Positivity of $\\operatorname{Im}(Z')$: Let $Z=X+iY$ where $X,Y$ are real matrices and $Y>0$. To show that $\\operatorname{Im}(Z') > 0$, we use the identity for this action:\n$$ \\operatorname{Im}(Z') = ((CZ+D)^\\dagger)^{-1} \\operatorname{Im}(Z) (CZ+D)^{-1} $$\nHere, $(CZ+D)^\\dagger$ denotes the conjugate transpose of the matrix $CZ+D$. Let $Q = (CZ+D)^{-1}$. Then the identity reads $\\operatorname{Im}(Z') = Q^\\dagger \\operatorname{Im}(Z) Q$. Since $\\operatorname{Im}(Z)=Y$ is positive-definite, for any non-zero vector $v \\in \\mathbb{C}^g$, the vector $u=Qv$ is also non-zero. The quadratic form is $v^\\dagger \\operatorname{Im}(Z') v = v^\\dagger (Q^\\dagger Y Q) v = (Qv)^\\dagger Y (Qv) = u^\\dagger Y u > 0$ because $Y$ is positive-definite. Thus, $\\operatorname{Im}(Z')$ is positive-definite, and the action is well-defined.\n\nNext, we show the action is transitive. We show that for any $Z=X+iY \\in \\mathfrak{H}_g$, there exists an $M \\in G$ such that $M \\cdot iI_g = Z$.\nSince $Y$ is a real, symmetric, positive-definite matrix, there exists an $S \\in \\operatorname{GL}_g(\\mathbb{R})$ such that $Y=SS^{\\mathsf{t}}$.\nConsider a matrix $M_1 = \\begin{pmatrix} S & 0 \\\\ 0 & S^{-\\mathsf{t}} \\end{pmatrix}$. We check that $M_1 \\in G$. $A=S, B=0, C=0, D=S^{-\\mathsf{t}}$. Conditions $A^{\\mathsf{t}}C=C^{\\mathsf{t}}A$ and $B^{\\mathsf{t}}D=D^{\\mathsf{t}}B$ are trivially satisfied. $A^{\\mathsf{t}}D-C^{\\mathsf{t}}B = S^{\\mathsf{t}}S^{-\\mathsf{t}} - 0 = I_g$. So $M_1 \\in G$.\n$M_1 \\cdot iI_g = (S(iI_g)+0)(0\\cdot(iI_g)+S^{-\\mathsf{t}})^{-1} = iS(S^{-\\mathsf{t}})^{-1} = iSS^{\\mathsf{t}} = iY$.\nNow consider a matrix $M_2 = \\begin{pmatrix} I_g & X \\\\ 0 & I_g \\end{pmatrix}$. Here $A=I_g, B=X, C=0, D=I_g$. $X=X^{\\mathsf{t}}$.\n$A^{\\mathsf{t}}C=0, B^{\\mathsf{t}}D=X^{\\mathsf{t}}=X, D^{\\mathsf{t}}B=X$, so $B^{\\mathsf{t}}D=D^{\\mathsf{t}}B$ is satisfied. $A^{\\mathsf{t}}D-C^{\\mathsf{t}}B = I_g I_g - 0 = I_g$. So $M_2 \\in G$.\n$M_2 \\cdot (iY) = (I_g(iY)+X)(0 \\cdot(iY)+I_g)^{-1} = X+iY = Z$.\nThe composition $M = M_2 M_1 = \\begin{pmatrix} I_g & X \\\\ 0 & I_g \\end{pmatrix} \\begin{pmatrix} S & 0 \\\\ 0 & S^{-\\mathsf{t}} \\end{pmatrix} = \\begin{pmatrix} S & XS^{-\\mathsf{t}} \\\\ 0 & S^{-\\mathsf{t}} \\end{pmatrix} \\in G$ maps $iI_g$ to $Z$. Thus, the action is transitive.\n\nFinally, we compute the stabilizer $K$ of a base point, which we choose as $Z_0=iI_g$.\n$M \\cdot iI_g = iI_g \\implies (A(iI_g)+B)(C(iI_g)+D)^{-1} = iI_g$.\n$iA+B = i(iC+D) = -C+iD$.\nEquating the real and imaginary parts (since $A,B,C,D$ are real matrices):\n$B = -C$ and $A = D$.\nSo the stabilizer consists of matrices of the form $M = \\begin{pmatrix} A & -C \\\\ C & A \\end{pmatrix}$.\nSubstituting these into the symplectic conditions:\n1. $A^{\\mathsf{t}}C = C^{\\mathsf{t}}A$.\n3. $A^{\\mathsf{t}}A - C^{\\mathsf{t}}(-C) = I_g \\implies A^{\\mathsf{t}}A+C^{\\mathsf{t}}C=I_g$.\nConsider the complex matrix $U = A+iC \\in M_g(\\mathbb{C})$. Let us compute $U^{\\dagger}U$:\n$U^{\\dagger}U = (A+iC)^{\\dagger}(A+iC) = (A^{\\mathsf{t}}-iC^{\\mathsf{t}})(A+iC) = A^{\\mathsf{t}}A+C^{\\mathsf{t}}C + i(A^{\\mathsf{t}}C - C^{\\mathsf{t}}A)$.\nUsing the conditions derived, this becomes $I_g + i(0) = I_g$.\nThus, $U$ is a unitary matrix, $U \\in U(g)$. The mapping $M \\mapsto A+iC$ defines an isomorphism between the stabilizer subgroup $K$ and the unitary group $U(g)$.\n\nWe have shown that $\\mathfrak{H}_g$ is a homogeneous space for $G=\\operatorname{Sp}_{2g}(\\mathbb{R})$ and that $\\mathfrak{H}_g \\simeq G/K$ where $K \\simeq U(g)$. This establishes the identification of the symmetric space $X$ with the Siegel upper half-space $\\mathfrak{H}_g$. The complex structure on $\\mathfrak{H}_g$ arises from it being an open subset of the space of $g \\times g$ complex symmetric matrices.\n\nTo find the complex dimension of $X = \\mathfrak{H}_g$, we need to find the dimension of the space of $g \\times g$ complex symmetric matrices. A symmetric matrix $Z = (Z_{ij})$ is determined by its entries on and above the main diagonal, i.e., $Z_{ij}$ with $i \\le j$.\n- The number of diagonal entries ($i=j$) is $g$.\n- The number of strictly upper-triangular entries ($i<j$) is $\\binom{g}{2} = \\frac{g(g-1)}{2}$.\nEach of these entries is an independent complex number. The total number of independent complex parameters is the sum:\n$$ \\dim_{\\mathbb{C}}(X) = g + \\frac{g(g-1)}{2} = \\frac{2g + g^2 - g}{2} = \\frac{g^2+g}{2} = \\frac{g(g+1)}{2} $$\nThe condition $\\operatorname{Im}(Z)>0$ defines an open set, so it does not change the local dimension of the manifold.", "answer": "$$\\boxed{\\frac{g(g+1)}{2}}$$", "id": "3023609"}, {"introduction": "Shimura varieties are typically formed by taking quotients of symmetric domains by arithmetic groups, which often results in spaces with singularities known as orbifolds. This practice uses the classical modular curve to make these concepts concrete, investigating how the presence of finite-order elements in an arithmetic group leads to cone points on the quotient space. By analyzing the modular groups $\\operatorname{SL}_{2}(\\mathbb{Z})$ and $\\Gamma_{0}(2)$, you will learn to identify these singularities and compute key topological invariants like the orbifold Euler characteristic [@problem_id:3023662].", "problem": "Let $G = \\operatorname{GL}_{2}$ over $\\mathbb{Q}$, and let $X$ be the upper half-plane $\\mathfrak{H}$ viewed as the $G(\\mathbb{R})$-Hermitian symmetric domain associated to the Shimura datum $(G, X)$ for modular curves. An open compact level $K_{f} \\subset G(\\mathbb{A}_{f})$ determines an arithmetic subgroup $\\Gamma \\subset \\operatorname{SL}_{2}(\\mathbb{Z})$ (via intersection with $G(\\mathbb{Q})$ and the connected component at infinity) and thus a quotient orbifold $[\\overline{\\Gamma} \\backslash \\mathfrak{H}]$, where $\\overline{\\Gamma}$ denotes the image of $\\Gamma$ in the Projective Special Linear group (PSL) $\\operatorname{PSL}_{2}(\\mathbb{R})$. A level is called neat if for every $\\gamma \\in \\Gamma$, the subgroup of $\\mathbb{C}^{\\times}$ generated by the eigenvalues of $\\gamma$ is torsion-free.\n\n(a) Construct explicit examples of non-neat levels by choosing $K_{f}$ so that $\\Gamma = \\operatorname{SL}_{2}(\\mathbb{Z})$ and $\\Gamma = \\Gamma_{0}(2) := \\left\\{\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix} \\in \\operatorname{SL}_{2}(\\mathbb{Z}) : c \\equiv 0 \\pmod{2} \\right\\}$, and prove non-neatness by exhibiting elements of finite order in these groups and identifying their eigenvalues.\n\n(b) For $\\overline{\\Gamma} = \\operatorname{PSL}_{2}(\\mathbb{Z})$, analyze the orbifold structure of $[\\overline{\\Gamma} \\backslash \\mathfrak{H}]$ by determining the orders of the nontrivial stabilizers and the number of cusp ends. Justify the existence and order of the cone points using explicit elements of $\\overline{\\Gamma}$ and their fixed points in $\\mathfrak{H}$.\n\n(c) Using the hyperbolic Gauss–Bonnet theorem for orbifolds of constant curvature $-1$, and the fact that hyperbolic area scales by index for finite-index subgroups of $\\operatorname{PSL}_{2}(\\mathbb{Z})$, compute the orbifold Euler characteristics $\\chi^{\\mathrm{orb}}\\!\\left([\\operatorname{PSL}_{2}(\\mathbb{Z}) \\backslash \\mathfrak{H}]\\right)$ and $\\chi^{\\mathrm{orb}}\\!\\left([\\overline{\\Gamma_{0}(2)} \\backslash \\mathfrak{H}]\\right)$, where $\\overline{\\Gamma_{0}(2)}$ denotes the image of $\\Gamma_{0}(2)$ in $\\operatorname{PSL}_{2}(\\mathbb{Z})$. Then give the exact value of the sum\n$$\n\\chi^{\\mathrm{orb}}\\!\\left([\\operatorname{PSL}_{2}(\\mathbb{Z}) \\backslash \\mathfrak{H}]\\right) \\;+\\; \\chi^{\\mathrm{orb}}\\!\\left([\\overline{\\Gamma_{0}(2)} \\backslash \\mathfrak{H}]\\right).\n$$\nExpress your final answer as a single exact rational number. No rounding is required.", "solution": "(a) Proof of Non-Neatness\n\nA level is defined as non-neat if the corresponding arithmetic group $\\Gamma$ contains an element $\\gamma$ such that the subgroup of $\\mathbb{C}^{\\times}$ generated by the eigenvalues of $\\gamma$ is not torsion-free. This occurs if at least one eigenvalue is a root of unity other than $1$.\n\nFor any matrix $\\gamma \\in \\operatorname{SL}_{2}(\\mathbb{Z})$, its characteristic polynomial is $x^2 - \\operatorname{tr}(\\gamma)x + \\det(\\gamma) = 0$. Since $\\det(\\gamma)=1$, the polynomial is $x^2 - \\operatorname{tr}(\\gamma)x + 1 = 0$. The eigenvalues are $\\lambda_{1,2} = \\frac{\\operatorname{tr}(\\gamma) \\pm \\sqrt{\\operatorname{tr}(\\gamma)^2 - 4}}{2}$.\nFor the eigenvalues to be roots of unity, they must lie on the unit circle in the complex plane (with the exception of $\\pm 1$). This requires the discriminant to be negative, i.e., $\\operatorname{tr}(\\gamma)^2 - 4 < 0$, which implies $|\\operatorname{tr}(\\gamma)| < 2$. Since $\\operatorname{tr}(\\gamma)$ must be an integer, the possible values for non-trivial roots of unity are $\\operatorname{tr}(\\gamma) \\in \\{-1, 0, 1\\}$. Such elements are called elliptic elements. Finding such an element in $\\Gamma$ is sufficient to prove non-neatness.\n\nCase 1: $\\Gamma = \\operatorname{SL}_{2}(\\mathbb{Z})$\nConsider the element $S = \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix}$. This matrix is in $\\operatorname{SL}_{2}(\\mathbb{Z})$ as its entries are integers and its determinant is $(0)(0) - (-1)(1) = 1$. The trace is $\\operatorname{tr}(S) = 0$.\nThe eigenvalues satisfy the equation $\\lambda^2 + 1 = 0$, which gives $\\lambda = \\pm i$. These are primitive $4$-th roots of unity. The subgroup of $\\mathbb{C}^{\\times}$ generated by $i$ is $\\{1, i, -1, -i\\}$, which is a finite group of order $4$ (and thus not torsion-free). Therefore, the level corresponding to $\\Gamma = \\operatorname{SL}_{2}(\\mathbb{Z})$ is not neat.\n\nCase 2: $\\Gamma = \\Gamma_{0}(2) := \\left\\{\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix} \\in \\operatorname{SL}_{2}(\\mathbb{Z}) : c \\equiv 0 \\pmod{2} \\right\\}$\nWe must find an elliptic element within this subgroup. The element $S$ from the previous case is not in $\\Gamma_{0}(2)$ because its $(2,1)$-entry is $1 \\not\\equiv 0 \\pmod{2}$.\nLet's search for an element $\\gamma \\in \\Gamma_{0}(2)$ with trace $0$. Let $\\gamma = \\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$. We require $a+d=0$, $ad-bc=1$, and $c \\equiv 0 \\pmod{2}$.\nSubstituting $d=-a$ into the determinant condition gives $-a^2-bc=1$. Let's test $c=2$. The condition becomes $-a^2 - 2b = 1$, or $a^2+1 = -2b$. For this equation to have integer solutions for $a$ and $b$, $a^2+1$ must be an even integer. This occurs if $a$ is odd. Let $a=1$. Then $1^2+1 = 2 = -2b$, which gives $b=-1$. With $a=1$, we have $d=-a=-1$.\nThis gives the matrix $\\gamma = \\begin{pmatrix} 1 & -1 \\\\ 2 & -1 \\end{pmatrix}$.\nThis matrix is in $\\Gamma_{0}(2)$ because its entries are integers, $\\det(\\gamma) = (1)(-1) - (-1)(2) = 1$, and its $(2,1)$-entry is $2 \\equiv 0 \\pmod{2}$.\nThe trace is $\\operatorname{tr}(\\gamma) = 1+(-1)=0$. As before, the eigenvalues are $\\pm i$, which are $4$-th roots of unity. The existence of this element proves that the level corresponding to $\\Gamma_{0}(2)$ is not neat.\n\n(b) Orbifold Structure of $[\\operatorname{PSL}_{2}(\\mathbb{Z}) \\backslash \\mathfrak{H}]$\n\nThe orbifold $[\\overline{\\Gamma} \\backslash \\mathfrak{H}]$ for $\\overline{\\Gamma} = \\operatorname{PSL}_{2}(\\mathbb{Z})$ is the modular curve $X(1)$. Its structure is determined by the genus of the corresponding compact Riemann surface, the cusps, and the elliptic points (cone points).\n\nNontrivial stabilizers (cone points): The stabilizer of a point $z \\in \\mathfrak{H}$ under the action of $\\operatorname{PSL}_{2}(\\mathbb{Z})$ is nontrivial if and only if $z$ is an elliptic fixed point. This corresponds to elements $\\bar{\\gamma} \\in \\operatorname{PSL}_{2}(\\mathbb{Z})$ of finite order. These arise from elliptic elements $\\gamma \\in \\operatorname{SL}_{2}(\\mathbb{Z})$, which have $|\\operatorname{tr}(\\gamma)| \\in \\{0, 1\\}$.\n-   If $\\operatorname{tr}(\\gamma) = 0$, then $\\gamma^2 = -I$. In $\\operatorname{PSL}_{2}(\\mathbb{Z})$, the image $\\bar{\\gamma}$ has order $2$. An example is $S = \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix}$, which fixes the point $z=i$ in $\\mathfrak{H}$ (since $S(i) = -1/i = i$). All points with a stabilizer of order $2$ are in the $\\operatorname{PSL}_{2}(\\mathbb{Z})$-orbit of $i$. Thus, there is one cone point of order $2$.\n-   If $\\operatorname{tr}(\\gamma) = \\pm 1$, then $\\gamma^3 = \\mp I$. In $\\operatorname{PSL}_{2}(\\mathbb{Z})$, the image $\\bar{\\gamma}$ has order $3$. An example with trace $1$ is $ST = \\begin{pmatrix} 0 & -1 \\\\ 1 & 1 \\end{pmatrix}$. Its fixed point in $\\mathfrak{H}$ is $z=e^{i2\\pi/3} = \\frac{-1+i\\sqrt{3}}{2}$. All points with a stabilizer of order $3$ are in the $\\operatorname{PSL}_{2}(\\mathbb{Z})$-orbit of $e^{i2\\pi/3}$. Thus, there is one cone point of order $3$.\n\nCusps: Cusps are the orbits of $\\mathbb{Q} \\cup \\{\\infty\\}$ under the group action. The group $\\operatorname{SL}_{2}(\\mathbb{Z})$ acts transitively on the set $\\mathbb{Q} \\cup \\{\\infty\\}$. Therefore, there is only one cusp for $\\operatorname{PSL}_{2}(\\mathbb{Z})$, which can be represented by the point at infinity, $\\infty$.\n\nIn summary, the orbifold $[\\operatorname{PSL}_{2}(\\mathbb{Z}) \\backslash \\mathfrak{H}]$ topologically corresponds to a sphere (genus $0$) with one point removed (the cusp) and two cone points of orders $2$ and $3$.\n\n(c) Orbifold Euler Characteristics\n\nThe orbifold Euler characteristic $\\chi^{\\mathrm{orb}}(\\Gamma \\backslash \\mathfrak{H})$ is related to the hyperbolic area of a fundamental domain $\\mathcal{F}_{\\Gamma}$ by the Gauss-Bonnet theorem for orbifolds:\n$\\chi^{\\mathrm{orb}}(\\Gamma \\backslash \\mathfrak{H}) = \\frac{\\operatorname{Area}(\\mathcal{F}_{\\Gamma})}{-2\\pi}$.\n\nFor $\\Gamma = \\operatorname{PSL}_{2}(\\mathbb{Z})$:\nThe area of the standard fundamental domain for $\\operatorname{PSL}_{2}(\\mathbb{Z})$ is a well-known result: $\\operatorname{Area}(\\mathcal{F}_{\\operatorname{PSL}_{2}(\\mathbb{Z})}) = \\pi/3$.\nTherefore, the orbifold Euler characteristic is:\n$$ \\chi^{\\mathrm{orb}}\\!\\left([\\operatorname{PSL}_{2}(\\mathbb{Z}) \\backslash \\mathfrak{H}]\\right) = \\frac{\\pi/3}{-2\\pi} = -\\frac{1}{6} $$\n\nFor $\\Gamma = \\overline{\\Gamma_{0}(2)}$:\nThe problem states that hyperbolic area scales by the index of the subgroup. We first compute the index $[\\operatorname{PSL}_{2}(\\mathbb{Z}) : \\overline{\\Gamma_{0}(2)}]$. This index is equal to $[\\operatorname{SL}_{2}(\\mathbb{Z}) : \\Gamma_{0}(2)]$.\nConsider the group homomorphism $\\phi: \\operatorname{SL}_{2}(\\mathbb{Z}) \\to \\operatorname{SL}_{2}(\\mathbb{Z}/2\\mathbb{Z})$ given by reduction of coefficients modulo $2$. This map is surjective, and $\\operatorname{SL}_{2}(\\mathbb{Z}/2\\mathbb{Z})$ is isomorphic to the symmetric group $S_3$, so its order is $6$.\nThe group $\\Gamma_{0}(2)$ is the preimage under $\\phi$ of the subgroup of matrices in $\\operatorname{SL}_{2}(\\mathbb{Z}/2\\mathbb{Z})$ of the form $\\begin{pmatrix} a' & b' \\\\ 0 & d' \\end{pmatrix}$. The condition $a'd' - b'(0) = 1 \\pmod{2}$ implies $a'd'=1$, so $a'=d'=1$. The entry $b'$ can be $0$ or $1$. Thus, the image of $\\Gamma_0(2)$ is the subgroup $\\left\\{ \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}, \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix} \\right\\} \\subset \\operatorname{SL}_{2}(\\mathbb{Z}/2\\mathbb{Z})$, which has order $2$.\nBy the correspondence theorem, the index is:\n$$ [\\operatorname{SL}_{2}(\\mathbb{Z}) : \\Gamma_{0}(2)] = \\frac{|\\operatorname{SL}_{2}(\\mathbb{Z}/2\\mathbb{Z})|}{|\\phi(\\Gamma_{0}(2))|} = \\frac{6}{2} = 3 $$\nThe area for $\\overline{\\Gamma_{0}(2)}$ is:\n$$ \\operatorname{Area}(\\mathcal{F}_{\\overline{\\Gamma_{0}(2)}}) = [\\operatorname{PSL}_{2}(\\mathbb{Z}) : \\overline{\\Gamma_{0}(2)}] \\times \\operatorname{Area}(\\mathcal{F}_{\\operatorname{PSL}_{2}(\\mathbb{Z})}) = 3 \\times \\frac{\\pi}{3} = \\pi $$\nThe corresponding orbifold Euler characteristic is:\n$$ \\chi^{\\mathrm{orb}}\\!\\left([\\overline{\\Gamma_{0}(2)} \\backslash \\mathfrak{H}]\\right) = \\frac{\\operatorname{Area}(\\mathcal{F}_{\\overline{\\Gamma_{0}(2)}})}{-2\\pi} = \\frac{\\pi}{-2\\pi} = -\\frac{1}{2} $$\n\nFinal Summation:\nThe problem asks for the sum of the two orbifold Euler characteristics:\n$$ \\chi^{\\mathrm{orb}}\\!\\left([\\operatorname{PSL}_{2}(\\mathbb{Z}) \\backslash \\mathfrak{H}]\\right) \\;+\\; \\chi^{\\mathrm{orb}}\\!\\left([\\overline{\\Gamma_{0}(2)} \\backslash \\mathfrak{H}]\\right) = -\\frac{1}{6} + \\left(-\\frac{1}{2}\\right) = -\\frac{1}{6} - \\frac{3}{6} = -\\frac{4}{6} = -\\frac{2}{3} $$\nThe final answer is the exact rational number $-\\frac{2}{3}$.", "answer": "$$\\boxed{-\\frac{2}{3}}$$", "id": "3023662"}, {"introduction": "The profound arithmetic significance of Shimura varieties is largely revealed through the action of Hecke operators. While their classical definition can seem ad-hoc, the modern adelic framework provides a unified and conceptual origin for all Hecke operators. This exercise serves as a crucial bridge between these two perspectives, guiding you to derive the familiar formula for the Hecke operator $T_{p}$ on a modular curve directly from its abstract definition as a double coset operator [@problem_id:3023633].", "problem": "Let $N \\geq 1$ be an integer and let $p$ be a prime such that $p \\nmid N$. Consider the modular curve $Y_{0}(N)$, which can be realized as a connected component of the Shimura variety associated to the General Linear Group (GL2) and the upper half-plane. Concretely, its complex points can be identified with the quotient $Y_{0}(N)(\\mathbb{C}) \\simeq \\Gamma_{0}(N) \\backslash \\mathfrak{H}$, where $\\Gamma_{0}(N) \\subset \\operatorname{SL}_{2}(\\mathbb{Z})$ is the congruence subgroup consisting of matrices with lower-left entry divisible by $N$, and $\\mathfrak{H}$ is the upper half-plane.\n\nLet $G = \\operatorname{GL}_{2}$ over $\\mathbb{Q}$, and write $\\mathbb{A}_{\\mathbb{Q}}$ for the adele ring of $\\mathbb{Q}$. Let $K_{0}(N) \\subset G(\\mathbb{A}_{\\mathbb{Q},f})$ be the standard compact open subgroup defined by\n$$\nK_{0}(N) = \\left\\{ k \\in \\operatorname{GL}_{2}(\\widehat{\\mathbb{Z}}) \\;\\middle|\\; k \\bmod N \\text{ is upper triangular} \\right\\},\n$$\nwhere $\\widehat{\\mathbb{Z}}$ is the profinite completion of $\\mathbb{Z}$.\n\nDefine the unnormalized Hecke operator $T_{p}$ associated with the double coset $K_{0}(N)\\alpha K_{0}(N)$, where $\\alpha = \\operatorname{diag}(p,1) \\in G(\\mathbb{A}_{\\mathbb{Q},f})$, by its action on right $K_{0}(N)$-invariant functions $\\Phi$ on $G(\\mathbb{Q}) \\backslash G(\\mathbb{A}_{\\mathbb{Q}})$:\n$$\n(T_{p}\\Phi)(g) = \\sum_{x \\in K_{0}(N) \\backslash K_{0}(N)\\alpha K_{0}(N)} \\Phi(gx).\n$$\n\nVia the identification $G(\\mathbb{Q}) \\backslash G(\\mathbb{A}_{\\mathbb{Q}}) / K_{0}(N) K_{\\infty} \\simeq \\Gamma_{0}(N) \\backslash \\mathfrak{H}$, where $K_{\\infty} = \\operatorname{SO}(2)$ is the Special Orthogonal Group at infinity, this operator descends to an operator on functions $f \\colon Y_{0}(N)(\\mathbb{C}) \\to \\mathbb{C}$. Starting from the core definitions above and the adelic double coset description, derive an explicit expression for $(T_{p}f)(z)$ in terms of the values of $f$ at points in $\\mathfrak{H}$ related to $z$ by fractional linear transformations arising from a set of representatives for $K_{0}(N)\\alpha K_{0}(N)$.\n\nYour final answer must be a single closed-form analytic expression for $(T_{p}f)(z)$ that is valid for all $z \\in \\mathfrak{H}$ and all functions $f$ on $Y_{0}(N)(\\mathbb{C})$ as above.", "solution": "The problem asks for the derivation of the explicit formula for the unnormalized Hecke operator $T_p$ acting on functions on the modular curve $Y_0(N)(\\mathbb{C})$, starting from its adelic definition.\n\nThe problem statement provides the following definitions:\n- The modular curve is given by $Y_0(N)(\\mathbb{C}) \\simeq \\Gamma_0(N)\\backslash\\mathfrak{H}$.\n- The adelic description of the modular curve is as a connected component of the Shimura variety $Sh_{K_0(N)}(G) = G(\\mathbb{Q})\\backslash G(\\mathbb{A}_{\\mathbb{Q}})/K_0(N)K_\\infty$, where $G=\\mathrm{GL}_2$ over $\\mathbb{Q}$.\n- The compact open subgroup is $K_0(N) = \\{k \\in \\mathrm{GL}_2(\\widehat{\\mathbb{Z}}) \\mid k \\pmod N \\text{ is upper triangular}\\}$.\n- The Hecke operator $T_p$ is associated with the double coset $K_0(N)\\alpha K_0(N)$ where $\\alpha = \\mathrm{diag}(p,1) \\in G(\\mathbb{A}_{\\mathbb{Q},f})$.\n- The action on a right $K_0(N)$-invariant function $\\Phi$ on $G(\\mathbb{Q})\\backslash G(\\mathbb{A}_{\\mathbb{Q}})$ is given by\n$$ (T_p\\Phi)(g) = \\sum_{x \\in K_0(N)\\backslash K_0(N)\\alpha K_0(N)} \\Phi(gx) $$\n\nA function $f: Y_0(N)(\\mathbb{C}) \\to \\mathbb{C}$ can be lifted to a function on the upper half-plane $\\mathfrak{H}$, which is invariant under the action of the congruence subgroup $\\Gamma_0(N)$. This function on $\\mathfrak{H}$ can then be lifted to a function $\\Phi_f$ on $G(\\mathbb{A}_{\\mathbb{Q}})$ which is left-invariant under $G(\\mathbb{Q})$ and right-invariant under $K_0(N)K_\\infty$. The action of the Hecke operator on $f$ is obtained by applying the adelic operator $T_p$ to $\\Phi_f$ and then evaluating the result at a point corresponding to $z \\in \\mathfrak{H}$.\n\nThe core of the derivation consists of two main steps:\n1. Decomposing the adelic double coset $K_0(N)\\alpha K_0(N)$ into a disjoint union of right cosets.\n2. Translating the sum over these adelic cosets into an action on the variable $z \\in \\mathfrak{H}$.\n\n### Step 1: Double Coset Decomposition\n\nWe need to find a set of representatives for the right cosets in $K_0(N) \\backslash K_0(N)\\alpha K_0(N)$.\nThe element $\\alpha = (\\alpha_q)_q \\in G(\\mathbb{A}_{\\mathbb{Q},f})$ has $\\alpha_q = \\mathrm{Id}$ for all primes $q \\neq p$, and $\\alpha_p = \\begin{pmatrix} p & 0 \\\\ 0 & 1 \\end{pmatrix}$.\nThe subgroup $K_0(N) = \\prod_q K_q$ has components $K_q \\subset \\mathrm{GL}_2(\\mathbb{Z}_q)$.\nSince $p \\nmid N$, the component of $K_0(N)$ at the prime $p$ is $K_p = \\mathrm{GL}_2(\\mathbb{Z}_p)$.\nFor any prime $q \\neq p$, $\\alpha_q = \\mathrm{Id}$, so the $q$-th component of the double coset is $K_q \\mathrm{Id} K_q = K_q$.\nTherefore, the double coset decomposition is determined entirely by the component at prime $p$:\n$$ K_0(N)\\alpha K_0(N) = \\left( \\prod_{q \\neq p} K_q \\right) \\times \\left( \\mathrm{GL}_2(\\mathbb{Z}_p) \\begin{pmatrix} p & 0 \\\\ 0 & 1 \\end{pmatrix} \\mathrm{GL}_2(\\mathbb{Z}_p) \\right) $$\nThe set $\\mathrm{GL}_2(\\mathbb{Z}_p) \\begin{pmatrix} p & 0 \\\\ 0 & 1 \\end{pmatrix} \\mathrm{GL}_2(\\mathbb{Z}_p)$ consists of all matrices in $M_2(\\mathbb{Z}_p)$ whose determinant is $p$ times a unit in $\\mathbb{Z}_p$.\nWe need to decompose this set into right cosets modulo $\\mathrm{GL}_2(\\mathbb{Z}_p)$. This is a classical result. The cosets are in bijection with the sublattices of index $p$ in $\\mathbb{Z}_p^2$. There are $p+1$ such sublattices, leading to $p+1$ cosets. A set of representatives is given by:\n$$ \\alpha_p = \\begin{pmatrix} p & 0 \\\\ 0 & 1 \\end{pmatrix} \\quad \\text{and} \\quad \\alpha_j = \\begin{pmatrix} 1 & j \\\\ 0 & p \\end{pmatrix} \\quad \\text{for } j=0, 1, \\ldots, p-1. $$\nLet $x_p$ and $x_j$ be the finite adeles which are equal to $\\alpha_p$ and $\\alpha_j$ at the prime $p$, respectively, and are the identity matrix at all other primes $q \\neq p$. Then the adelic double coset decomposes as:\n$$ K_0(N)\\alpha K_0(N) = \\left( \\bigsqcup_{j=0}^{p-1} x_j K_0(N) \\right) \\sqcup x_p K_0(N). $$\n\n### Step 2: From Adelic Action to Action on $\\mathfrak{H}$\n\nA crucial result connecting the adelic and classical pictures states that, under the condition $p \\nmid N$, the adelic coset representatives can be replaced by rational matrices. Specifically, the set of cosets $K_0(N) \\backslash K_0(N)\\alpha K_0(N)$ is in bijection with the set of classical cosets $\\Gamma_0(N) \\backslash \\Delta_p$, where $\\Delta_p = \\{ \\delta \\in M_2(\\mathbb{Z}) \\mid \\det(\\delta) = p \\}$.\nThe representatives for $\\Gamma_0(N) \\backslash \\Delta_p$ (since $p \\nmid N$) are the same as for $\\mathrm{SL}_2(\\mathbb{Z}) \\backslash \\Delta_p$, which are precisely the integer matrices corresponding to our local representatives at $p$:\n$$ \\gamma_p = \\begin{pmatrix} p & 0 \\\\ 0 & 1 \\end{pmatrix} \\in M_2(\\mathbb{Z}), \\quad \\gamma_j = \\begin{pmatrix} 1 & j \\\\ 0 & p \\end{pmatrix} \\in M_2(\\mathbb{Z}) \\quad \\text{for } j=0, 1, \\ldots, p-1. $$\nThe action of the Hecke operator $T_p$ on a function $f$ on $Y_0(N)(\\mathbb{C})$ is given by summing the values of $f$ at the points obtained by applying these matrix transformations to the variable $z \\in \\mathfrak{H}$.\nThe adelic sum $(T_p\\Phi)(g) = \\sum_i \\Phi(gx_i)$ translates to the classical sum $(T_p f)(z) = \\sum_i f(\\gamma_i z)$.\n\nLet us compute the action of each fractional linear transformation $\\gamma_i$ on $z \\in \\mathfrak{H}$.\nFor $\\gamma_j = \\begin{pmatrix} 1 & j \\\\ 0 & p \\end{pmatrix}$, the action is:\n$$ \\gamma_j(z) = \\frac{1 \\cdot z + j}{0 \\cdot z + p} = \\frac{z+j}{p} $$\nFor $\\gamma_p = \\begin{pmatrix} p & 0 \\\\ 0 & 1 \\end{pmatrix}$, the action is:\n$$ \\gamma_p(z) = \\frac{p \\cdot z + 0}{0 \\cdot z + 1} = pz $$\nCombining these results, the action of the unnormalized Hecke operator $T_p$ on a function $f: Y_0(N)(\\mathbb{C}) \\to \\mathbb{C}$ is given by the sum of the function evaluated at these transformed points:\n$$ (T_p f)(z) = f(\\gamma_p z) + \\sum_{j=0}^{p-1} f(\\gamma_j z) $$\nSubstituting the expressions for the transformations, we obtain the final explicit formula:\n$$ (T_p f)(z) = f(pz) + \\sum_{j=0}^{p-1} f\\left(\\frac{z+j}{p}\\right) $$\nThis is the classical formula for the (unnormalized) $p$-th Hecke operator acting on modular functions of level $N$, derived from the modern adelic framework as requested by the problem.", "answer": "$$\\boxed{f(pz) + \\sum_{j=0}^{p-1} f\\left(\\frac{z+j}{p}\\right)}$$", "id": "3023633"}]}