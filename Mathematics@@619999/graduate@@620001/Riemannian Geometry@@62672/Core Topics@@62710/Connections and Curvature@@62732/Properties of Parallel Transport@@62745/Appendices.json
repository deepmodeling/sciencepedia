{"hands_on_practices": [{"introduction": "Mastering the mechanics of parallel transport begins with concrete calculations. This exercise [@problem_id:2986898] provides a foundational test of your skills by asking you to compute transport along a circle in the flat Euclidean plane, using polar coordinates. The non-zero Christoffel symbols in this system will require you to solve the full parallel transport equations, yielding a crucial insight into how coordinate system choices can obscure the underlying flat geometry of a space.", "problem": "Consider the punctured plane $\\mathbb{R}^{2}\\setminus\\{0\\}$ equipped with the Riemannian metric in polar coordinates $(r,\\theta)$ given by $g=dr^{2}+r^{2}\\,d\\theta^{2}$. Let $\\gamma:[0,2\\pi]\\to \\mathbb{R}^{2}\\setminus\\{0\\}$ be the circle at fixed radius $r_{0}>0$ parametrized by $\\gamma(\\theta)=(r_{0},\\theta)$. Using the defining properties of the Levi-Civita connection (metric compatibility and torsion-free), compute the parallel transport of a tangent vector $V(0)\\in T_{\\gamma(0)}(\\mathbb{R}^{2}\\setminus\\{0\\})$ along $\\gamma$ by deriving and solving the parallel transport equations for the components of $V(\\theta)$ in the coordinate basis $\\{\\partial_{r},\\partial_{\\theta}\\}$, and then express the holonomy at the base point $\\gamma(0)$ as an element of the special orthogonal group in dimension two, denoted $\\mathrm{SO}(2)$. From this, determine the holonomy angle acquired after a full loop $\\theta:0\\to 2\\pi$, defined as the unique angle in $[0,2\\pi)$ whose rotation represents the holonomy element. Express the holonomy angle in radians. Provide only the holonomy angle as your final answer. No rounding is required.", "solution": "The user wants me to solve a problem in Riemannian geometry. I will first validate the problem statement.\n\n### Step 1: Extract Givens\n- Manifold: Punctured plane $\\mathbb{R}^{2}\\setminus\\{0\\}$.\n- Coordinates: Polar coordinates $(r,\\theta)$.\n- Riemannian metric: $g = dr^{2} + r^{2}\\,d\\theta^{2}$.\n- Curve: A circle $\\gamma:[0,2\\pi]\\to \\mathbb{R}^{2}\\setminus\\{0\\}$ at a fixed radius $r_{0}>0$, parametrized by $\\gamma(\\theta)=(r_{0},\\theta)$.\n- Task:\n    1. Compute the parallel transport of a tangent vector $V(0)\\in T_{\\gamma(0)}(\\mathbb{R}^{2}\\setminus\\{0\\})$ along $\\gamma$.\n    2. The computation must be done by deriving and solving the parallel transport equations for the components of the vector field $V(\\theta)$ in the coordinate basis $\\{\\partial_{r},\\partial_{\\theta}\\}$.\n    3. The derivation must use the defining properties of the Levi-Civita connection (metric compatibility and torsion-free).\n    4. Express the holonomy at the base point $\\gamma(0)$ as an element of the special orthogonal group $\\mathrm{SO}(2)$.\n    5. Determine the holonomy angle in $[0,2\\pi)$ corresponding to this holonomy element.\n    6. The final answer should be the holonomy angle in radians.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is set within the standard framework of Riemannian geometry. The metric $g=dr^{2}+r^{2}\\,d\\theta^{2}$ is the standard Euclidean metric on $\\mathbb{R}^2$ expressed in polar coordinates. The manifold, the curve, the Levi-Civita connection, parallel transport, and holonomy are all well-defined mathematical concepts. The problem is based on established principles.\n- **Well-Posed**: The problem is clearly stated and provides all necessary information to compute a unique solution. The task to derive the Christoffel symbols and solve the transport equations is specific and leads to a determinable result.\n- **Objective**: The problem is stated in precise, objective mathematical language.\n- **Completeness and Consistency**: The problem is self-contained. The metric and the path are fully specified. There are no contradictions. While the punctured plane is not simply connected, which can lead to non-trivial holonomy, the flatness of the metric (zero Riemann curvature) makes this a canonical example. The problem is not underspecified or overconstrained.\n- **Structure and Feasibility**: The problem is structured as a standard exercise in differential geometry. The required calculations (Christoffel symbols, solving a system of ODEs) are feasible and standard.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a standard, well-posed problem in differential geometry that tests the understanding of parallel transport in a non-Cartesian coordinate system. I will now proceed with the solution.\n\n### Solution Derivation\n\nThe problem requires us to compute the holonomy angle for a vector parallel transported along a circle in the punctured plane, endowed with the flat Euclidean metric. We work in polar coordinates $(x^1, x^2) = (r, \\theta)$.\n\nFirst, we identify the components of the metric tensor $g$. From the expression $g = dr^{2} + r^{2}\\,d\\theta^{2}$, we have:\n$$\ng_{ij} = \\begin{pmatrix} g_{rr} & g_{r\\theta} \\\\ g_{\\theta r} & g_{\\theta\\theta} \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & r^2 \\end{pmatrix}\n$$\nThe inverse metric tensor is:\n$$\ng^{ij} = \\begin{pmatrix} 1 & 0 \\\\ 0 & r^{-2} \\end{pmatrix}\n$$\n\nNext, we compute the Christoffel symbols of the second kind, $\\Gamma^k_{ij}$, for the Levi-Civita connection using the formula:\n$$\n\\Gamma^k_{ij} = \\frac{1}{2} g^{kl} \\left( \\frac{\\partial g_{jl}}{\\partial x^i} + \\frac{\\partial g_{il}}{\\partial x^j} - \\frac{\\partial g_{ij}}{\\partial x^l} \\right)\n$$\nThe only non-zero partial derivative of the metric components with respect to the coordinates is:\n$$\n\\frac{\\partial g_{\\theta\\theta}}{\\partial r} = \\frac{\\partial (r^2)}{\\partial r} = 2r\n$$\nAll other derivatives, such as $\\frac{\\partial g_{rr}}{\\partial r}$, $\\frac{\\partial g_{rr}}{\\partial \\theta}$, and $\\frac{\\partial g_{\\theta\\theta}}{\\partial \\theta}$, are zero.\n\nWe now compute the non-zero Christoffel symbols:\n$$\n\\Gamma^r_{\\theta\\theta} = \\frac{1}{2} g^{rr} \\left( \\frac{\\partial g_{\\theta r}}{\\partial \\theta} + \\frac{\\partial g_{\\theta r}}{\\partial \\theta} - \\frac{\\partial g_{\\theta\\theta}}{\\partial r} \\right) = \\frac{1}{2} (1) (0 + 0 - 2r) = -r\n$$\n$$\n\\Gamma^\\theta_{r\\theta} = \\Gamma^\\theta_{\\theta r} = \\frac{1}{2} g^{\\theta\\theta} \\left( \\frac{\\partial g_{\\theta\\theta}}{\\partial r} + \\frac{\\partial g_{r\\theta}}{\\partial \\theta} - \\frac{\\partial g_{r\\theta}}{\\partial\\theta} \\right) = \\frac{1}{2} (r^{-2}) (2r) = \\frac{1}{r}\n$$\nAll other Christoffel symbols $\\Gamma^k_{ij}$ are zero.\n\nThe vector field to be parallel transported along the curve $\\gamma$ is $V(\\theta) = V^r(\\theta) \\partial_r + V^\\theta(\\theta) \\partial_\\theta$. The parallel transport equation is $\\nabla_{\\dot{\\gamma}}V = 0$. The curve is given by $\\gamma(\\theta) = (r_0, \\theta)$, so $r(\\theta) = r_0$ and $\\theta(\\theta) = \\theta$. The tangent vector to the curve is $\\dot{\\gamma} = \\frac{dr}{d\\theta}\\partial_r + \\frac{d\\theta}{d\\theta}\\partial_\\theta = 0 \\cdot \\partial_r + 1 \\cdot \\partial_\\theta = \\partial_\\theta$.\n\nThe component form of the parallel transport equation is:\n$$\n\\frac{d V^k}{d\\theta} + \\Gamma^k_{ij} \\frac{dx^i}{d\\theta} V^j = 0\n$$\nwhere the parameter is $\\theta$, and the coordinates along the curve are $x^1=r=r_0$ and $x^2=\\theta$. The derivatives are $\\frac{dx^1}{d\\theta} = \\frac{dr}{d\\theta} = 0$ and $\\frac{dx^2}{d\\theta} = \\frac{d\\theta}{d\\theta} = 1$.\n\nFor $k=r$:\n$$\n\\frac{dV^r}{d\\theta} + \\sum_{i,j} \\Gamma^r_{ij} \\frac{dx^i}{d\\theta} V^j = 0\n$$\nThe only non-zero term in the sum is for $i=j=\\theta$:\n$$\n\\frac{dV^r}{d\\theta} + \\Gamma^r_{\\theta\\theta} \\frac{d\\theta}{d\\theta} V^\\theta = 0 \\implies \\frac{dV^r}{d\\theta} + (-r_0)(1)V^\\theta = 0 \\implies \\frac{dV^r}{d\\theta} = r_0 V^\\theta\n$$\n\nFor $k=\\theta$:\n$$\n\\frac{dV^\\theta}{d\\theta} + \\sum_{i,j} \\Gamma^\\theta_{ij} \\frac{dx^i}{d\\theta} V^j = 0\n$$\nThe only non-zero term is for $i=\\theta, j=r$:\n$$\n\\frac{dV^\\theta}{d\\theta} + \\Gamma^\\theta_{\\theta r} \\frac{d\\theta}{d\\theta} V^r = 0 \\implies \\frac{dV^\\theta}{d\\theta} + \\left(\\frac{1}{r_0}\\right)(1)V^r = 0 \\implies \\frac{dV^\\theta}{d\\theta} = -\\frac{1}{r_0} V^r\n$$\n\nWe have the following system of linear ordinary differential equations:\n$$\n\\begin{cases} \\frac{dV^r}{d\\theta} = r_0 V^\\theta \\\\ \\frac{dV^\\theta}{d\\theta} = -\\frac{1}{r_0} V^r \\end{cases}\n$$\nTo solve this system, we differentiate the first equation with respect to $\\theta$:\n$$\n\\frac{d^2 V^r}{d\\theta^2} = r_0 \\frac{dV^\\theta}{d\\theta}\n$$\nSubstituting the second equation into this gives:\n$$\n\\frac{d^2 V^r}{d\\theta^2} = r_0 \\left(-\\frac{1}{r_0} V^r\\right) = -V^r\n$$\nThis leads to the homogeneous second-order ODE:\n$$\n\\frac{d^2 V^r}{d\\theta^2} + V^r = 0\n$$\nThe general solution for $V^r(\\theta)$ is:\n$$\nV^r(\\theta) = A \\cos(\\theta) + B \\sin(\\theta)\n$$\nWe find $V^\\theta(\\theta)$ using the first ODE:\n$$\nV^\\theta(\\theta) = \\frac{1}{r_0} \\frac{dV^r}{d\\theta} = \\frac{1}{r_0} (-A \\sin(\\theta) + B \\cos(\\theta))\n$$\nThe constants $A$ and $B$ are determined by the initial conditions at $\\theta=0$. Let the initial vector be $V(0) = V^r(0)\\partial_r + V^\\theta(0)\\partial_\\theta$.\nAt $\\theta=0$:\n$$\nV^r(0) = A \\cos(0) + B \\sin(0) = A\n$$\n$$\nV^\\theta(0) = \\frac{1}{r_0}(-A \\sin(0) + B \\cos(0)) = \\frac{B}{r_0} \\implies B=r_0 V^\\theta(0)\n$$\nSubstituting $A$ and $B$ back, the solution for the components is:\n$$\nV^r(\\theta) = V^r(0) \\cos(\\theta) + r_0 V^\\theta(0) \\sin(\\theta)\n$$\n$$\nV^\\theta(\\theta) = -\\frac{V^r(0)}{r_0} \\sin(\\theta) + V^\\theta(0) \\cos(\\theta)\n$$\n\nThe holonomy transformation is the linear map that takes the initial vector $V(0)$ to the final vector $V(2\\pi)$ after parallel transport around the loop. We evaluate the components at $\\theta=2\\pi$:\n$$\nV^r(2\\pi) = V^r(0) \\cos(2\\pi) + r_0 V^\\theta(0) \\sin(2\\pi) = V^r(0) \\cdot 1 + r_0 V^\\theta(0) \\cdot 0 = V^r(0)\n$$\n$$\nV^\\theta(2\\pi) = -\\frac{V^r(0)}{r_0} \\sin(2\\pi) + V^\\theta(0) \\cos(2\\pi) = -\\frac{V^r(0)}{r_0} \\cdot 0 + V^\\theta(0) \\cdot 1 = V^\\theta(0)\n$$\nThe components of the vector at the end of the loop are identical to the initial components. The initial vector is $V(0) = V^r(0)\\partial_r|_{\\gamma(0)} + V^\\theta(0)\\partial_\\theta|_{\\gamma(0)}$. The final vector is $V(2\\pi) = V^r(2\\pi)\\partial_r|_{\\gamma(2\\pi)} + V^\\theta(2\\pi)\\partial_\\theta|_{\\gamma(2\\pi)}$.\nThe base point is $\\gamma(0) = (r_0, 0)$ and $\\gamma(2\\pi) = (r_0, 2\\pi)$. In the punctured plane, these correspond to the same point $(x,y)=(r_0,0)$. The coordinate basis vectors $\\partial_r$ and $\\partial_\\theta$ depend on $\\theta$ through their expression in a fixed Cartesian basis, but this dependence is $2\\pi$-periodic. Hence, $\\partial_r|_{\\gamma(0)} = \\partial_r|_{\\gamma(2\\pi)}$ and $\\partial_\\theta|_{\\gamma(0)} = \\partial_\\theta|_{\\gamma(2\\pi)}$.\nSince both the components and the basis vectors are the same at the beginning and the end of the loop, the final vector is identical to the initial vector: $V(2\\pi) = V(0)$.\n\nThe holonomy transformation is therefore the identity map on the tangent space $T_{\\gamma(0)}(\\mathbb{R}^2\\setminus\\{0\\})$. To express this as an element of $\\mathrm{SO}(2)$, we consider its matrix representation in any orthonormal basis of the tangent space. In any such basis, the identity map is represented by the identity matrix:\n$$\n\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\nThis matrix is an element of $\\mathrm{SO}(2)$ and corresponds to a rotation by an angle $\\phi$. The general form of a rotation matrix in $\\mathrm{SO}(2)$ is $\\begin{pmatrix} \\cos\\phi & -\\sin\\phi \\\\ \\sin\\phi & \\cos\\phi \\end{pmatrix}$. For the identity matrix, we have $\\cos\\phi=1$ and $\\sin\\phi=0$, which implies that the angle $\\phi$ is $0$ (within the range $[0, 2\\pi)$).\n\nTherefore, the holonomy angle acquired after a full loop is $0$ radians. This result is expected for a flat manifold, as the non-zero Christoffel symbols in polar coordinates merely account for the rotation of the coordinate basis itself, such that the parallel-transported vector remains constant in a fixed global frame.", "answer": "$$\n\\boxed{0}\n$$", "id": "2986898"}, {"introduction": "While analytical solutions are powerful, most problems in geometry require numerical methods for paths on curved manifolds. This practice [@problem_id:2986923] challenges you to implement a parallel transport algorithm for the 2-sphere, a classic example of a curved space. By translating the abstract transport equations into code and verifying core theoretical properties like linearity and reversibility, you will develop a practical and robust understanding of how these concepts function in applied settings.", "problem": "Consider the $2$-sphere $S^2$ equipped with its standard Riemannian metric in spherical coordinates $(\\theta,\\phi)$, where $\\theta \\in (0,\\pi)$ and $\\phi \\in (-\\pi,\\pi]$. The metric tensor in these coordinates is $g_{ij} = \\mathrm{diag}(1,\\sin^2 \\theta)$. The Levi-Civita connection is metric-compatible and torsion-free, and in these coordinates its Christoffel symbols satisfy $\\Gamma^{\\theta}_{\\phi\\phi} = -\\sin \\theta \\cos \\theta$, $\\Gamma^{\\phi}_{\\theta\\phi} = \\Gamma^{\\phi}_{\\phi\\theta} = \\cot \\theta$, with all other $\\Gamma^i_{jk}$ equal to $0$. Let $c:[s,t]\\to S^2$ be a smooth curve with coordinate expression $c(\\tau)=(\\theta(\\tau),\\phi(\\tau))$. A tangent vector $V(\\tau)$ along $c$ is said to be parallel if its covariant derivative along $c$ vanishes, i.e., $\\nabla_{\\dot{c}(\\tau)} V(\\tau)=0$. In coordinates, this condition corresponds to the ordinary differential equation (ODE)\n$$\n\\frac{dV^i}{d\\tau}(\\tau) + \\Gamma^i_{jk}\\big(c(\\tau)\\big)\\,\\frac{dx^j}{d\\tau}(\\tau)\\,V^k(\\tau) = 0,\\quad i\\in\\{\\theta,\\phi\\},\n$$\nwhere repeated indices are summed and $x^j$ are the coordinate functions. A parallel orthonormal frame $(E_1(\\tau),E_2(\\tau))$ along $c$ is obtained by solving the same ODE for each basis vector, starting from an orthonormal basis at $\\tau=s$. For the $2$-sphere with the given metric, an orthonormal basis at a point $(\\theta,\\phi)$ is given by $E_1=(1,0)$ and $E_2=\\big(0,1/\\sin \\theta\\big)$ in the coordinate basis.\n\nYour task is to implement a numerical parallel transport algorithm by integrating the coordinate ODE for vectors and for a parallel frame initialized at $\\tau=s$. Use the following test suite to validate different properties of parallel transport. All angles must be expressed in radians.\n\nImplement the following four test curves and initial data, and for each produce a single real-valued result as specified. In all cases, use the coordinate interval $\\tau\\in[s,t]$ with the stated $s$ and $t$, and integrate the ODEs to compute parallel transport.\n\n- Test A (equator, vanishing Christoffel symbols along the path):\n  Curve: $\\theta(\\tau)=\\pi/2$, $\\phi(\\tau)=\\tau$, with $s=0$ and $t=1.25$.\n  Initial vector components at $\\tau=s$: $V^\\theta(s)=0.3$, $V^\\phi(s)=0.4$.\n  Required result: the Euclidean $2$-norm of the difference between the numerically transported final vector components $(V^\\theta(t),V^\\phi(t))$ and the initial components $(V^\\theta(s),V^\\phi(s))$.\n\n- Test B (meridian, analytic comparison):\n  Curve: $\\theta(\\tau)=\\theta_0+\\tau$, $\\phi(\\tau)=\\phi_0$, with $s=0$, $t=\\theta_1-\\theta_0$, $\\theta_0=0.7$, $\\theta_1=1.4$, and $\\phi_0=0.3$.\n  Initial vector components at $\\tau=s$: $V^\\theta(s)=0.1$, $V^\\phi(s)=0.8$.\n  Analytic prediction for the transported components at $\\tau=t$: $V^\\theta(t)=V^\\theta(s)$ and $V^\\phi(t)=V^\\phi(s)\\,\\dfrac{\\sin \\theta_0}{\\sin \\theta_1}$.\n  Required result: the Euclidean $2$-norm of the difference between the numerically transported final vector and this analytic prediction.\n\n- Test C (general mid-latitude path, reversibility of parallel transport):\n  Curve: $\\theta(\\tau)=0.4\\pi+0.2\\sin \\tau$, $\\phi(\\tau)=0.1+1.3\\,\\tau+0.2\\sin(2\\tau)$, with $s=0$ and $t=1.0$.\n  Initial vector components at $\\tau=s$: $V^\\theta(s)=0.5$, $V^\\phi(s)=-0.3$.\n  Required result: the Euclidean $2$-norm of the difference between the initial components $(V^\\theta(s),V^\\phi(s))$ and the components obtained by transporting forward to $\\tau=t$ and then transporting back along the same curve from $\\tau=t$ to $\\tau=s$.\n\n- Test D (near-pole path, comparison of frame-based and direct transport):\n  Curve: $\\theta(\\tau)=0.2+0.1\\,\\tau$, $\\phi(\\tau)=2\\,\\tau+0.1\\sin(3\\tau)$, with $s=0$ and $t=0.6$.\n  Initial vector components at $\\tau=s$: $V^\\theta(s)=0.7$, $V^\\phi(s)=0.9$.\n  Construct a parallel orthonormal frame initialized at $\\tau=s$ using $E_1=(1,0)$ and $E_2=\\big(0,1/\\sin \\theta(s)\\big)$, propagate the frame, and reconstruct the transported vector at $\\tau=t$ by keeping the frame coefficients constant. Compare this frame-based transported vector to the one obtained by directly integrating the coordinate ODE for $V(\\tau)$.\n  Required result: the Euclidean $2$-norm of the difference between the frame-based and direct transported final vectors.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_A,r_B,r_C,r_D]$), where each entry is a floating-point number computed in the manner described above. Angle units must be radians. No other output is permitted.", "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in the principles of Riemannian geometry, specifically concerning the parallel transport of vectors on a curved manifold. The problem is well-posed, providing a complete and consistent set of definitions, equations, and initial conditions for a series of numerical tests. The specified manifold ($2$-sphere), metric, connection, and test cases are standard and allow for rigorous verification of a numerical implementation.\n\nThe core of the problem is to solve the system of ordinary differential equations (ODEs) for parallel transport. A vector field $V(\\tau)$ with components $V^i(\\tau)$ is parallel along a curve $c(\\tau)$ with coordinates $x^j(\\tau)$ if its covariant derivative along the curve's tangent vector $\\dot{c}(\\tau)$ is zero. This condition is expressed in coordinates as:\n$$\n\\frac{d V^i}{d \\tau} + \\Gamma^i_{jk}(c(\\tau)) \\frac{d x^j}{d \\tau} V^k(\\tau) = 0\n$$\nwhere $\\Gamma^i_{jk}$ are the Christoffel symbols of the Levi-Civita connection. For the $2$-sphere $S^2$ in spherical coordinates $x^1 = \\theta$ and $x^2 = \\phi$, the non-zero Christoffel symbols are given as $\\Gamma^{\\theta}_{\\phi\\phi} = -\\sin\\theta\\cos\\theta$ and $\\Gamma^{\\phi}_{\\theta\\phi} = \\Gamma^{\\phi}_{\\phi\\theta} = \\cot\\theta$.\n\nLet the vector components be $V = (V^\\theta, V^\\phi)$ and the curve velocity be $(\\dot{\\theta}, \\dot{\\phi})$. Expanding the parallel transport equation for each component $i \\in \\{\\theta, \\phi\\}$ gives the system of ODEs:\nFor $i=\\theta$:\n$$\n\\frac{d V^\\theta}{d \\tau} = - \\Gamma^\\theta_{jk} \\dot{x}^j V^k = - \\Gamma^\\theta_{\\phi\\phi} \\dot{\\phi} V^\\phi = -(-\\sin\\theta\\cos\\theta) \\dot{\\phi} V^\\phi = \\sin\\theta\\cos\\theta \\dot{\\phi} V^\\phi\n$$\nFor $i=\\phi$:\n$$\n\\frac{d V^\\phi}{d \\tau} = - \\Gamma^\\phi_{jk} \\dot{x}^j V^k = - (\\Gamma^\\phi_{\\theta\\phi} \\dot{\\theta} V^\\phi + \\Gamma^\\phi_{\\phi\\theta} \\dot{\\phi} V^\\theta) = -(\\cot\\theta \\dot{\\theta} V^\\phi + \\cot\\theta \\dot{\\phi} V^\\theta) = -\\cot\\theta (\\dot{\\theta} V^\\phi + \\dot{\\phi} V^\\theta)\n$$\nThis system is a first-order linear ODE initial value problem, which can be solved numerically using standard methods. We will employ a high-precision adaptive step-size integrator, such as the one provided by `scipy.integrate.solve_ivp`, to compute the evolution of the vector components $V^\\theta(\\tau)$ and $V^\\phi(\\tau)$. The four tests validate different fundamental properties of parallel transport.\n\nTest A: This test involves transport along the equator, $\\theta(\\tau) = \\pi/2$, which is a geodesic. Along this curve, $\\cos(\\pi/2) = 0$ and $\\cot(\\pi/2)=0$, causing all relevant Christoffel symbols to vanish. The ODE system simplifies to $\\frac{d V^\\theta}{d \\tau} = 0$ and $\\frac{d V^\\phi}{d \\tau} = 0$. Consequently, the vector components must remain constant. The numerical test verifies this by checking that the final vector at $\\tau=1.25$ is identical to the initial vector at $\\tau=0$, up to numerical error.\n\nTest B: This test involves transport along a meridian, $\\phi(\\tau) = \\phi_0$, which is also a geodesic. Since $\\dot{\\phi}=0$, the ODE for $V^\\theta$ becomes $\\frac{d V^\\theta}{d \\tau} = 0$, so $V^\\theta$ is constant. The ODE for $V^\\phi$ becomes $\\frac{d V^\\phi}{d \\tau} = -\\cot\\theta(\\tau) \\dot{\\theta}(\\tau) V^\\phi$. With $\\theta(\\tau) = \\theta_0 + \\tau$ and $\\dot{\\theta}=1$, this is a separable ODE with the known analytic solution $V^\\phi(t) = V^\\phi(s)(\\sin\\theta_0/\\sin\\theta_1)$. This test validates the numerical solver against an exact solution.\n\nTest C: This test verifies the reversibility property of parallel transport. The Levi-Civita connection is a metric connection, which implies that parallel transport is an isometry between tangent spaces. Transporting a vector forward along a curve from a point $p$ to a point $q$ and then transporting it backward along the same curve from $q$ to $p$ must recover the original vector. This is tested by numerically integrating from $\\tau=0$ to $\\tau=1.0$ and then integrating back from $\\tau=1.0$ to $\\tau=0$.\n\nTest D: This test verifies the linearity of the parallel transport operator, $\\mathcal{P}$. The operator is linear, meaning $\\mathcal{P}(aU+bW) = a\\mathcal{P}(U) + b\\mathcal{P}(W)$. This property allows one to transport any vector by transporting a basis for the tangent space. We initialize an orthonormal frame $(E_1(s), E_2(s))$ at $\\tau=s$, decompose the initial vector $V(s)$ in this frame as $V(s) = a_1 E_1(s) + a_2 E_2(s)$, and then transport the basis vectors to obtain the frame $(E_1(t), E_2(t))$ at $\\tau=t$. The transported vector is then reconstructed as $V(t) = a_1 E_1(t) + a_2 E_2(t)$. This frame-based result is compared to the vector obtained by directly transporting $V(s)$. The two results must agree, up to numerical error. The coefficients $a_1$ and $a_2$ are found by solving the linear system $V(s) = a_1 E_1(s) + a_2 E_2(s)$. For the given basis $E_1(s)=(1,0)$ and $E_2(s)=(0, 1/\\sin\\theta(s))$, the solution is $a_1=V^\\theta(s)$ and $a_2=V^\\phi(s)\\sin\\theta(s)$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef dV_dtau_func(tau, V_components, curve, curve_dot):\n    \"\"\"\n    Computes the time derivative of vector components for parallel transport.\n    \n    This function represents the right-hand side of the parallel transport ODE:\n    dV^i/dtau = -Gamma^i_jk * dx^j/dtau * V^k\n    \n    Args:\n        tau (float): The curve parameter (time).\n        V_components (np.ndarray): A 1D array [V_theta, V_phi].\n        curve (callable): A function tau -> [theta(tau), phi(tau)].\n        curve_dot (callable): A function tau -> [dtheta/dtau, dphi/dtau].\n    \n    Returns:\n        list: The derivatives [dV_theta/dtau, dV_phi/dtau].\n    \"\"\"\n    V_theta, V_phi = V_components\n    theta, _ = curve(tau)\n    dtheta_dtau, dphi_dtau = curve_dot(tau)\n\n    # Avoid division by zero at poles, though problem constraints prevent this.\n    if theta <= 0 or theta >= np.pi:\n        return [0.0, 0.0]\n\n    sin_theta = np.sin(theta)\n    cos_theta = np.cos(theta)\n    cot_theta = cos_theta / sin_theta\n    \n    # ODE for V^theta\n    dV_theta_dtau = sin_theta * cos_theta * dphi_dtau * V_phi\n    \n    # ODE for V^phi\n    dV_phi_dtau = -cot_theta * (dtheta_dtau * V_phi + dphi_dtau * V_theta)\n    \n    return [dV_theta_dtau, dV_phi_dtau]\n\ndef parallel_transport_solver(curve, curve_dot, t_span, V_initial):\n    \"\"\"\n    Numerically solves the parallel transport ODE for a given vector.\n    \n    Args:\n        curve (callable): Function defining the curve c(tau).\n        curve_dot (callable): Function defining the curve's derivative c'(tau).\n        t_span (tuple): The integration interval (start, end).\n        V_initial (np.ndarray): The initial vector components.\n    \n    Returns:\n        np.ndarray: The components of the transported vector at the end of the interval.\n    \"\"\"\n    sol = solve_ivp(\n        fun=dV_dtau_func,\n        t_span=t_span,\n        y0=V_initial,\n        args=(curve, curve_dot),\n        method='DOP853',\n        dense_output=True,\n        rtol=1e-12,\n        atol=1e-12\n    )\n    return sol.y[:, -1]\n\ndef solve():\n    \"\"\"\n    Runs the four test cases for parallel transport and prints the results.\n    \"\"\"\n    results = []\n    \n    # Test A: Equator path\n    s_A, t_A = 0.0, 1.25\n    curve_A = lambda tau: np.array([np.pi / 2, tau])\n    curve_dot_A = lambda tau: np.array([0.0, 1.0])\n    V_initial_A = np.array([0.3, 0.4])\n    V_final_A = parallel_transport_solver(curve_A, curve_dot_A, (s_A, t_A), V_initial_A)\n    result_A = np.linalg.norm(V_final_A - V_initial_A)\n    results.append(result_A)\n\n    # Test B: Meridian path\n    theta_0, theta_1, phi_0 = 0.7, 1.4, 0.3\n    s_B, t_B = 0.0, theta_1 - theta_0\n    curve_B = lambda tau: np.array([theta_0 + tau, phi_0])\n    curve_dot_B = lambda tau: np.array([1.0, 0.0])\n    V_initial_B = np.array([0.1, 0.8])\n    V_final_B_num = parallel_transport_solver(curve_B, curve_dot_B, (s_B, t_B), V_initial_B)\n    V_final_B_analytic = np.array([\n        V_initial_B[0],\n        V_initial_B[1] * np.sin(theta_0) / np.sin(theta_1)\n    ])\n    result_B = np.linalg.norm(V_final_B_num - V_final_B_analytic)\n    results.append(result_B)\n\n    # Test C: Reversibility\n    s_C, t_C = 0.0, 1.0\n    curve_C = lambda tau: np.array([0.4 * np.pi + 0.2 * np.sin(tau), 0.1 + 1.3 * tau + 0.2 * np.sin(2 * tau)])\n    curve_dot_C = lambda tau: np.array([0.2 * np.cos(tau), 1.3 + 0.4 * np.cos(2 * tau)])\n    V_initial_C = np.array([0.5, -0.3])\n    V_at_t_C = parallel_transport_solver(curve_C, curve_dot_C, (s_C, t_C), V_initial_C)\n    V_back_at_s_C = parallel_transport_solver(curve_C, curve_dot_C, (t_C, s_C), V_at_t_C)\n    result_C = np.linalg.norm(V_back_at_s_C - V_initial_C)\n    results.append(result_C)\n\n    # Test D: Frame-based vs. direct transport\n    s_D, t_D = 0.0, 0.6\n    curve_D = lambda tau: np.array([0.2 + 0.1 * tau, 2 * tau + 0.1 * np.sin(3 * tau)])\n    curve_dot_D = lambda tau: np.array([0.1, 2.0 + 0.3 * np.cos(3 * tau)])\n    V_initial_D = np.array([0.7, 0.9])\n    \n    # Direct transport of the vector\n    V_final_direct = parallel_transport_solver(curve_D, curve_dot_D, (s_D, t_D), V_initial_D)\n\n    # Frame-based transport\n    theta_s = curve_D(s_D)[0]\n    E1_s = np.array([1.0, 0.0])\n    E2_s = np.array([0.0, 1.0 / np.sin(theta_s)])\n    \n    E1_t = parallel_transport_solver(curve_D, curve_dot_D, (s_D, t_D), E1_s)\n    E2_t = parallel_transport_solver(curve_D, curve_dot_D, (s_D, t_D), E2_s)\n    \n    # Decompose V_initial in the initial frame and reconstruct at the end\n    a1 = V_initial_D[0]\n    a2 = V_initial_D[1] * np.sin(theta_s)\n    \n    V_final_frame = a1 * E1_t + a2 * E2_t\n    \n    result_D = np.linalg.norm(V_final_direct - V_final_frame)\n    results.append(result_D)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2986923"}, {"introduction": "A deeper understanding of a mathematical object often comes from studying how it changes under perturbation. This advanced exercise [@problem_id:2986896] moves from calculating transport with a fixed connection to deriving how the parallel transport operator itself varies as the connection is altered. By deriving this fundamental variational formula from first principles, you will gain a powerful tool used in the study of Jacobi fields, geodesic deviation, and the index form, which are central to advanced geometric analysis.", "problem": "Let $(M,g)$ be a smooth Riemannian manifold with Levi-Civita connection $\\nabla$. Let $\\nabla'$ be another linear connection on the tangent bundle $TM$ such that, for any smooth vector fields $X,Y$, the difference is given by a tensor $A \\in T^{\\ast}M \\otimes \\mathrm{End}(TM)$ via $$(\\nabla' - \\nabla)_{X} Y \\;=\\; A(X)Y.$$ Fix a smooth curve $\\gamma : [0,t] \\to M$ with velocity $\\dot{\\gamma}$ and initial point $\\gamma(0) \\in M$. For each $\\varepsilon \\in \\mathbb{R}$, define a one-parameter family of connections $$\\nabla^{\\varepsilon} \\;=\\; \\nabla + \\varepsilon A.$$ Let $P^{\\varepsilon}_{t\\leftarrow s} : T_{\\gamma(s)}M \\to T_{\\gamma(t)}M$ denote the parallel transport along $\\gamma$ from $s$ to $t$ associated to $\\nabla^{\\varepsilon}$, and write $P^{0}_{t\\leftarrow s}$ for the parallel transport associated to $\\nabla$.\n\nUsing only the defining property of parallel transport as the solution of a first-order Ordinary Differential Equation (ODE) along $\\gamma$, derive an explicit closed-form analytic expression for the first-order variation operator $$\\Delta P_{t} \\;=\\; \\left.\\frac{d}{d\\varepsilon}\\right|_{\\varepsilon=0} P^{\\varepsilon}_{t\\leftarrow 0} : T_{\\gamma(0)}M \\to T_{\\gamma(t)}M$$ in terms of $A(\\dot{\\gamma})$ and the base transport $P^{0}_{t\\leftarrow s}$. Your answer must be a single expression written as an integral along $\\gamma$ and should be exact (no approximation or rounding). Do not state or use any pre-derived variation formulas; begin from the ODE definition of parallel transport and basic properties of linear integral equations.", "solution": "The problem requires the derivation of the first-order variation of the parallel transport operator. We begin from the fundamental definition of parallel transport as the solution to a first-order ordinary differential equation (ODE).\n\nLet $v_0 \\in T_{\\gamma(0)}M$ be an arbitrary initial vector. For each $\\varepsilon \\in \\mathbb{R}$, let $V^\\varepsilon(s)$ be the vector field along the curve $\\gamma$ obtained by parallel transporting $v_0$ with respect to the connection $\\nabla^\\varepsilon$. By definition, $V^\\varepsilon(s) = P^{\\varepsilon}_{s \\leftarrow 0} v_0$. The vector field $V^\\varepsilon(s)$ is the unique solution to the following initial value problem:\n$$\n\\begin{cases}\n\\nabla^{\\varepsilon}_{\\dot{\\gamma}(s)} V^\\varepsilon(s) = 0 & \\text{for } s \\in [0,t] \\\\\nV^\\varepsilon(0) = v_0\n\\end{cases}\n$$\nThe connection $\\nabla^\\varepsilon$ is defined as $\\nabla^\\varepsilon = \\nabla + \\varepsilon A$, where $\\nabla = \\nabla^0$ is the Levi-Civita connection. Substituting this into the ODE gives:\n$$\n\\nabla_{\\dot{\\gamma}(s)} V^\\varepsilon(s) + \\varepsilon A(\\dot{\\gamma}(s)) V^\\varepsilon(s) = 0\n$$\nThis is an equation for the one-parameter family of vector fields $V^\\varepsilon(s)$. We are interested in its first-order variation at $\\varepsilon=0$. Let us define the variation vector field $\\dot{V}(s)$ as:\n$$\n\\dot{V}(s) = \\left.\\frac{d}{d\\varepsilon}\\right|_{\\varepsilon=0} V^\\varepsilon(s)\n$$\nAssuming that $V^\\varepsilon(s)$ is a smooth function of $\\varepsilon$, we can differentiate the ODE with respect to $\\varepsilon$. The covariant derivative $\\nabla_{\\dot{\\gamma}(s)}$ acts as a linear differential operator with respect to the parameter $s$, and its coefficients do not depend on $\\varepsilon$. Thus, we can interchange the order of differentiation:\n$$\n\\frac{d}{d\\varepsilon} \\left( \\nabla_{\\dot{\\gamma}(s)} V^\\varepsilon(s) \\right) = \\nabla_{\\dot{\\gamma}(s)} \\left(\\frac{d}{d\\varepsilon} V^\\varepsilon(s) \\right)\n$$\nApplying the product rule to the second term of the ODE, we get:\n$$\n\\frac{d}{d\\varepsilon} \\left( \\varepsilon A(\\dot{\\gamma}(s)) V^\\varepsilon(s) \\right) = A(\\dot{\\gamma}(s)) V^\\varepsilon(s) + \\varepsilon A(\\dot{\\gamma}(s)) \\frac{d}{d\\varepsilon}V^\\varepsilon(s)\n$$\nDifferentiating the entire ODE with respect to $\\varepsilon$ yields:\n$$\n\\nabla_{\\dot{\\gamma}(s)} \\left(\\frac{d}{d\\varepsilon} V^\\varepsilon(s) \\right) + A(\\dot{\\gamma}(s)) V^\\varepsilon(s) + \\varepsilon A(\\dot{\\gamma}(s)) \\frac{d}{d\\varepsilon}V^\\varepsilon(s) = 0\n$$\nNow, we set $\\varepsilon=0$. Let $V^0(s) = V^\\varepsilon(s)|_{\\varepsilon=0} = P^0_{s \\leftarrow 0} v_0$ be the vector field parallel-transported using the base connection $\\nabla$. At $\\varepsilon=0$, the equation simplifies to an ODE for the variation field $\\dot{V}(s)$:\n$$\n\\nabla_{\\dot{\\gamma}(s)} \\dot{V}(s) + A(\\dot{\\gamma}(s)) V^0(s) = 0\n$$\nThis is a non-homogeneous linear first-order ODE for $\\dot{V}(s)$ along $\\gamma$:\n$$\n\\nabla_{\\dot{\\gamma}(s)} \\dot{V}(s) = -A(\\dot{\\gamma}(s)) V^0(s)\n$$\nTo solve this ODE, we need the initial condition for $\\dot{V}(s)$ at $s=0$. The initial condition for $V^\\varepsilon(s)$ is $V^\\varepsilon(0) = v_0$, which is independent of $\\varepsilon$. Therefore,\n$$\n\\dot{V}(0) = \\left.\\frac{d}{d\\varepsilon}\\right|_{\\varepsilon=0} V^\\varepsilon(0) = \\left.\\frac{d}{d\\varepsilon}\\right|_{\\varepsilon=0} v_0 = 0\n$$\nWe must now solve the initial value problem:\n$$\n\\begin{cases}\n\\nabla_{\\dot{\\gamma}(s)} \\dot{V}(s) = -A(\\dot{\\gamma}(s)) V^0(s) \\\\\n\\dot{V}(0) = 0\n\\end{cases}\n$$\nThis type of equation can be solved using a method analogous to the variation of parameters, encapsulated by Duhamel's principle. For a general non-homogeneous equation $\\nabla_{\\dot{\\gamma}(s)} X(s) = F(s)$ with initial condition $X(0)$, the solution is given by:\n$$\nX(t) = P^0_{t \\leftarrow 0} X(0) + \\int_0^t P^0_{t \\leftarrow s} F(s) ds\n$$\nwhere $P^0_{t \\leftarrow s}$ is the parallel transport operator for the homogeneous equation (i.e., for $\\nabla$). In our case, the vector field is $\\dot{V}(s)$, the forcing term is $F(s) = -A(\\dot{\\gamma}(s)) V^0(s)$, and the initial condition is $\\dot{V}(0)=0$. Substituting these into the general solution gives:\n$$\n\\dot{V}(t) = P^0_{t \\leftarrow 0} (0) + \\int_0^t P^0_{t \\leftarrow s} \\left( -A(\\dot{\\gamma}(s)) V^0(s) \\right) ds\n$$\n$$\n\\dot{V}(t) = - \\int_0^t P^0_{t \\leftarrow s} A(\\dot{\\gamma}(s)) V^0(s) ds\n$$\nNow, we substitute the expression for $V^0(s)$, which is the parallel transport of the initial vector $v_0$ with respect to $\\nabla$: $V^0(s) = P^0_{s \\leftarrow 0} v_0$. This yields:\n$$\n\\dot{V}(t) = - \\int_0^t P^0_{t \\leftarrow s} A(\\dot{\\gamma}(s)) (P^0_{s \\leftarrow 0} v_0) ds\n$$\nThe operator we seek is $\\Delta P_t = \\left.\\frac{d}{d\\varepsilon}\\right|_{\\varepsilon=0} P^{\\varepsilon}_{t\\leftarrow 0}$. By its definition, it acts on the initial vector $v_0$ as follows:\n$$\n(\\Delta P_t) v_0 = \\left( \\left.\\frac{d}{d\\varepsilon}\\right|_{\\varepsilon=0} P^{\\varepsilon}_{t\\leftarrow 0} \\right) v_0 = \\left.\\frac{d}{d\\varepsilon}\\right|_{\\varepsilon=0} (P^{\\varepsilon}_{t\\leftarrow 0} v_0) = \\left.\\frac{d}{d\\varepsilon}\\right|_{\\varepsilon=0} V^\\varepsilon(t) = \\dot{V}(t)\n$$\nTherefore, we have:\n$$\n(\\Delta P_t) v_0 = - \\int_0^t P^0_{t \\leftarrow s} A(\\dot{\\gamma}(s)) P^0_{s \\leftarrow 0} v_0 ds\n$$\nThis equation can be rewritten as:\n$$\n(\\Delta P_t) v_0 = \\left( - \\int_0^t P^0_{t \\leftarrow s} A(\\dot{\\gamma}(s)) P^0_{s \\leftarrow 0} ds \\right) v_0\n$$\nSince this equality holds for any arbitrary initial vector $v_0 \\in T_{\\gamma(0)}M$, we can equate the operators themselves. The integral defines a linear map from $T_{\\gamma(0)}M$ to $T_{\\gamma(t)}M$. The integrand for each $s \\in [0,t]$ is a composition of linear maps: $P^0_{s \\leftarrow 0}: T_{\\gamma(0)}M \\to T_{\\gamma(s)}M$, followed by $A(\\dot{\\gamma}(s)): T_{\\gamma(s)}M \\to T_{\\gamma(s)}M$, and finally $P^0_{t \\leftarrow s}: T_{\\gamma(s)}M \\to T_{\\gamma(t)}M$. The resulting expression for the first-order variation operator is:\n$$\n\\Delta P_{t} = - \\int_0^t P^0_{t \\leftarrow s} A(\\dot{\\gamma}(s)) P^0_{s \\leftarrow 0} ds\n$$\nThis is the required explicit closed-form analytic expression, derived from first principles as requested.", "answer": "$$\n\\boxed{- \\int_0^t P^0_{t \\leftarrow s} A(\\dot{\\gamma}(s)) P^0_{s \\leftarrow 0} ds}\n$$", "id": "2986896"}]}