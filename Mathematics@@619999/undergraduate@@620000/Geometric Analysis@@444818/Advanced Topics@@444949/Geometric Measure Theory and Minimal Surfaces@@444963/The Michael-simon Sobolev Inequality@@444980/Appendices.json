{"hands_on_practices": [{"introduction": "Before diving into complex calculations, we can understand the structure of the Michael-Simon Sobolev inequality using a powerful reasoning tool: dimensional analysis. This practice uses scaling arguments to reveal the fundamental relationship between the exponents in the inequality, demonstrating how the formula respects the geometric nature of the underlying space. By ensuring the inequality remains consistent under dilations, you will derive the precise form of the critical Sobolev exponent. [@problem_id:3072468]", "problem": "Let $M^{m}$ be a smooth, compact, boundaryless hypersurface immersed in $\\mathbb{R}^{m+1}$ with induced Riemannian metric and mean curvature $H$. Let $u \\in C^{1}(M)$ and $p \\in [1,m)$ be fixed. A version of the Michael–Simon Sobolev inequality asserts that there exists a constant $C = C(m,p)$ such that an inequality of the schematic form\n$$\n\\|u\\|_{L^{q}(M)} \\leq C \\left( \\|\\nabla_{M} u\\|_{L^{p}(M)} + \\|H u\\|_{L^{p}(M)} \\right)\n$$\nholds for a suitable exponent $q$ depending on $m$ and $p$. Using only scaling considerations based on the induced geometry of hypersurfaces in $\\mathbb{R}^{m+1}$ and the requirement that such an inequality be consistent under Euclidean dilations, determine the value of $q$ in terms of $m$ and $p$ for which such a bound can be dimensionally consistent when $p \\in [1,m)$. Then, specialize your expression to the case $m = 3$ and $p = 2$, and compute the numerical value of $q$. Provide only the value of $q$ as your final answer. No rounding is required.", "solution": "The problem requires determining the exponent $q$ in the Michael–Simon Sobolev inequality by ensuring the inequality is dimensionally consistent under Euclidean dilations. The given inequality relates norms of a function $u \\in C^{1}(M)$ on a smooth, compact, boundaryless hypersurface $M^{m} \\subset \\mathbb{R}^{m+1}$:\n$$\n\\|u\\|_{L^{q}(M)} \\leq C \\left( \\|\\nabla_{M} u\\|_{L^{p}(M)} + \\|H u\\|_{L^{p}(M)} \\right)\n$$\nwhere $p \\in [1,m)$, $H$ is the mean curvature of $M$, and $C$ is a constant depending only on $m$ and $p$.\n\nWe consider a uniform scaling (dilation) of the ambient Euclidean space $\\mathbb{R}^{m+1}$ by a factor $\\lambda > 0$. An arbitrary point $x \\in \\mathbb{R}^{m+1}$ is mapped to $\\tilde{x} = \\lambda x$. This transformation maps the hypersurface $M$ to a new hypersurface $\\tilde{M} = \\{ \\lambda x \\mid x \\in M \\}$. We must determine how each term in the inequality transforms under this scaling.\n\nLet $g$ be the induced Riemannian metric on $M$. The dilation maps tangent vectors $v \\in T_x M$ to $\\lambda v \\in T_{\\lambda x} \\tilde{M}$. The induced metric $\\tilde{g}$ on $\\tilde{M}$ is related to $g$ by $\\tilde{g}_{\\lambda x}(\\lambda v, \\lambda w) = \\langle \\lambda v, \\lambda w \\rangle = \\lambda^{2} \\langle v, w \\rangle = \\lambda^{2} g_x(v, w)$. Thus, the metric tensor scales as $\\tilde{g} = \\lambda^{2} g$.\n\nThe $m$-dimensional volume element $d\\tilde{V}$ on $\\tilde{M}$ scales according to the determinant of the metric. In local coordinates, $d\\tilde{V} = \\sqrt{\\det(\\tilde{g})} \\, d\\text{coords} = \\sqrt{\\det(\\lambda^{2} g)} \\, d\\text{coords} = \\lambda^{m} \\sqrt{\\det(g)} \\, d\\text{coords} = \\lambda^{m} dV$. So, we have the scaling relation $d\\tilde{V} = \\lambda^{m} dV$.\n\nThe function $u$ on $M$ corresponds to a function $\\tilde{u}$ on $\\tilde{M}$ defined by the scalar-invariant condition $\\tilde{u}(\\tilde{x}) = u(x)$, where $\\tilde{x} = \\lambda x$.\n\nThe gradient operator $\\nabla_{M}$ scales with inverse length. The squared norm of the gradient is $|\\nabla_{M} u|^{2}_{g} = g^{ij} (\\partial_i u)(\\partial_j u)$. Under scaling, the inverse metric transforms as $\\tilde{g}^{ij} = \\lambda^{-2} g^{ij}$. The partial derivatives of $\\tilde{u}$ with respect to the same local coordinate system are unchanged, i.e., $\\partial_i \\tilde{u} = \\partial_i u$. Therefore, $|\\nabla_{\\tilde{M}} \\tilde{u}|^{2}_{\\tilde{g}} = \\tilde{g}^{ij} (\\partial_i \\tilde{u})(\\partial_j \\tilde{u}) = \\lambda^{-2} g^{ij} (\\partial_i u)(\\partial_j u) = \\lambda^{-2} |\\nabla_{M} u|^{2}_{g}$. Taking the square root, we get $|\\nabla_{\\tilde{M}} \\tilde{u}|_{\\tilde{g}} = \\lambda^{-1} |\\nabla_{M} u|_{g}$.\n\nThe mean curvature $H$ is a sum of the principal curvatures, which have the dimension of inverse length. Under a dilation by $\\lambda$, a sphere of radius $R$ becomes a sphere of radius $\\lambda R$, and its curvature changes from $1/R$ to $1/(\\lambda R)$. Thus, curvatures scale with inverse length. The mean curvature of $\\tilde{M}$ at $\\tilde{x}$ is related to the mean curvature of $M$ at $x$ by $\\tilde{H} = \\lambda^{-1} H$.\n\nNow we analyze the scaling of each $L^{p}$ norm in the inequality.\nThe left-hand side (LHS) is $\\|u\\|_{L^{q}(M)}$. For the scaled surface $\\tilde{M}$, this term becomes:\n$$\n\\|\\tilde{u}\\|_{L^{q}(\\tilde{M})} = \\left( \\int_{\\tilde{M}} |\\tilde{u}|^{q} \\, d\\tilde{V} \\right)^{1/q} = \\left( \\int_{M} |u|^{q} \\, (\\lambda^{m} dV) \\right)^{1/q} = \\lambda^{m/q} \\left( \\int_{M} |u|^{q} \\, dV \\right)^{1/q} = \\lambda^{m/q} \\|u\\|_{L^{q}(M)}\n$$\n\nThe terms on the right-hand side (RHS) are $\\|\\nabla_{M} u\\|_{L^{p}(M)}$ and $\\|H u\\|_{L^{p}(M)}$. For the scaled surface $\\tilde{M}$, the first term becomes:\n$$\n\\|\\nabla_{\\tilde{M}} \\tilde{u}\\|_{L^{p}(\\tilde{M})} = \\left( \\int_{\\tilde{M}} |\\nabla_{\\tilde{M}} \\tilde{u}|^{p} \\, d\\tilde{V} \\right)^{1/p} = \\left( \\int_{M} (\\lambda^{-1} |\\nabla_{M} u|)^{p} \\, (\\lambda^{m} dV) \\right)^{1/p} = \\left( \\lambda^{m-p} \\int_{M} |\\nabla_{M} u|^{p} \\, dV \\right)^{1/p} = \\lambda^{\\frac{m-p}{p}} \\|\\nabla_{M} u\\|_{L^{p}(M)}\n$$\nThe second term on the RHS scales similarly:\n$$\n\\|\\tilde{H} \\tilde{u}\\|_{L^{p}(\\tilde{M})} = \\left( \\int_{\\tilde{M}} |\\tilde{H} \\tilde{u}|^{p} \\, d\\tilde{V} \\right)^{1/p} = \\left( \\int_{M} |(\\lambda^{-1} H) u|^{p} \\, (\\lambda^{m} dV) \\right)^{1/p} = \\left( \\lambda^{m-p} \\int_{M} |H u|^{p} \\, dV \\right)^{1/p} = \\lambda^{\\frac{m-p}{p}} \\|H u\\|_{L^{p}(M)}\n$$\nNote that both terms on the RHS have the same scaling factor, $\\lambda^{\\frac{m}{p} - 1}$.\n\nThe inequality applied to the scaled surface $\\tilde{M}$ is:\n$$\n\\|\\tilde{u}\\|_{L^{q}(\\tilde{M})} \\leq C \\left( \\|\\nabla_{\\tilde{M}} \\tilde{u}\\|_{L^{p}(\\tilde{M})} + \\|\\tilde{H} \\tilde{u}\\|_{L^{p}(\\tilde{M})} \\right)\n$$\nSubstituting the scaling behaviors, we get:\n$$\n\\lambda^{m/q} \\|u\\|_{L^{q}(M)} \\leq C \\left( \\lambda^{\\frac{m}{p} - 1} \\|\\nabla_{M} u\\|_{L^{p}(M)} + \\lambda^{\\frac{m}{p} - 1} \\|H u\\|_{L^{p}(M)} \\right)\n$$\n$$\n\\lambda^{m/q} \\|u\\|_{L^{q}(M)} \\leq C \\lambda^{\\frac{m}{p} - 1} \\left( \\|\\nabla_{M} u\\|_{L^{p}(M)} + \\|H u\\|_{L^{p}(M)} \\right)\n$$\nFor this inequality to be consistent for all $\\lambda > 0$, the scaling factors on both sides must be identical. The constant $C$ is independent of $\\lambda$. Therefore, we must equate the exponents of $\\lambda$:\n$$\n\\frac{m}{q} = \\frac{m}{p} - 1\n$$\nThis equation relates the exponents $q$, $p$, and the dimension $m$. We can solve for $q$. First, we can rewrite the equation in a more familiar form by dividing by $m$:\n$$\n\\frac{1}{q} = \\frac{1}{p} - \\frac{1}{m}\n$$\nThis is the characteristic relation for the Sobolev conjugate exponent. Solving for $q$:\n$$\n\\frac{1}{q} = \\frac{m-p}{mp} \\implies q = \\frac{mp}{m-p}\n$$\nThe problem specifies that $p \\in [1, m)$, which ensures that the denominator $m-p$ is positive and non-zero, so $q$ is well-defined and positive.\n\nThe final step is to calculate the numerical value of $q$ for the specific case where the dimension of the hypersurface is $m=3$ and the exponent is $p=2$. We verify the condition $p \\in [1,m)$: $2 \\in [1,3)$, which is true.\nSubstituting these values into our derived expression for $q$:\n$$\nq = \\frac{3 \\times 2}{3 - 2} = \\frac{6}{1} = 6\n$$\nThus, for a $3$-dimensional hypersurface in $\\mathbb{R}^{4}$, the corresponding Sobolev exponent is $q=6$.", "answer": "$$\n\\boxed{6}\n$$", "id": "3072468"}, {"introduction": "To truly grasp an inequality, it is invaluable to compute all of its components in a specific, tangible setting. This exercise moves from abstract theory to a concrete pencil-and-paper calculation on a flat disk in $\\mathbb{R}^2$, a scenario where the mean curvature term vanishes but a boundary term appears. You will evaluate the gradient and boundary integrals for a family of test functions, providing a hands-on feel for the quantities involved and exploring the concept of sharpness. [@problem_id:3072416]", "problem": "Let $D_{R} \\subset \\mathbb{R}^{2}$ denote the open disk of radius $R>0$ centered at the origin. Consider radial test functions $u_{\\alpha}:D_{R}\\to\\mathbb{R}$ parameterized by $\\alpha \\in [0,1]$ defined by\n$$\nu_{\\alpha}(x) \\;=\\; u_{\\alpha}(r) \\;=\\;\n\\begin{cases}\n1, & 0 \\le r \\le \\dfrac{R}{2},\\\\[6pt]\n1 + m\\!\\left(r-\\dfrac{R}{2}\\right), & \\dfrac{R}{2} < r \\le R,\n\\end{cases}\n\\quad\\text{with}\\quad m \\;=\\; \\dfrac{2(\\alpha - 1)}{R},\n$$\nso that $u_{\\alpha}(R)=\\alpha$. Define the ratio functional\n$$\n\\mathcal{Q}(\\alpha) \\;=\\; \\dfrac{\\left(\\displaystyle\\int_{D_{R}} |u_{\\alpha}|^{2} \\, dx\\right)^{1/2}}{\\displaystyle\\int_{D_{R}} |\\nabla u_{\\alpha}| \\, dx \\;+\\; \\int_{\\partial D_{R}} |u_{\\alpha}| \\, d\\sigma}.\n$$\nStarting only from the definitions of polar coordinates in $\\mathbb{R}^{2}$, the expression of the gradient for radial functions, and the standard area and arc-length elements, compute an explicit closed-form expression for $\\displaystyle\\sup_{\\alpha\\in[0,1]} \\mathcal{Q}(\\alpha)$ in terms of $\\pi$ only. Provide the exact value; no rounding is required.", "solution": "The problem is valid as it is mathematically well-posed, self-contained, and grounded in standard principles of calculus and analysis. It asks for the supremum of a ratio of integrals for a given one-parameter family of functions, which is a standard extremum problem.\n\nThe problem asks for the computation of $\\displaystyle\\sup_{\\alpha\\in[0,1]} \\mathcal{Q}(\\alpha)$, where the functional $\\mathcal{Q}(\\alpha)$ is defined as\n$$\n\\mathcal{Q}(\\alpha) = \\dfrac{\\left(\\displaystyle\\int_{D_{R}} |u_{\\alpha}|^{2} \\, dx\\right)^{1/2}}{\\displaystyle\\int_{D_{R}} |\\nabla u_{\\alpha}| \\, dx \\;+\\; \\int_{\\partial D_{R}} |u_{\\alpha}| \\, d\\sigma}.\n$$\nThe function $u_\\alpha$ is defined radially on the disk $D_R \\subset \\mathbb{R}^2$ of radius $R>0$. It is convenient to work in polar coordinates $(r, \\theta)$, where $x = (r\\cos\\theta, r\\sin\\theta)$. The area element is $dx = r\\,dr\\,d\\theta$ for $0 \\le r \\le R$ and $0 \\le \\theta < 2\\pi$. The arc-length element on the boundary $\\partial D_R$ (where $r=R$) is $d\\sigma = R\\,d\\theta$.\n\nFor a radial function $u(r)$, the gradient is $\\nabla u = u'(r)\\hat{r}$, where $\\hat{r}$ is the unit radial vector. Thus, its magnitude is $|\\nabla u(x)| = |u'(r)|$.\n\nLet's compute the three integrals that constitute $\\mathcal{Q}(\\alpha)$.\n\nFirst, we compute the numerator term, $N(\\alpha) = \\left(\\displaystyle\\int_{D_R} |u_\\alpha|^2 \\, dx\\right)^{1/2}$. Since $u_\\alpha$ is non-negative for $\\alpha \\in [0,1]$, we have $|u_\\alpha|=u_\\alpha$.\n$$\nN(\\alpha)^2 = \\int_{D_R} u_\\alpha^2 \\, dx = \\int_0^{2\\pi} \\int_0^R u_\\alpha(r)^2 r \\, dr \\, d\\theta = 2\\pi \\int_0^R u_\\alpha(r)^2 r \\, dr.\n$$\nWe split the radial integral based on the definition of $u_\\alpha(r)$:\n$$\n\\int_0^R u_\\alpha(r)^2 r \\, dr = \\int_0^{R/2} 1^2 \\cdot r \\, dr + \\int_{R/2}^R \\left[1 + m\\left(r-\\frac{R}{2}\\right)\\right]^2 r \\, dr,\n$$\nwhere $m = \\frac{2(\\alpha-1)}{R}$.\nThe first integral is $\\int_0^{R/2} r \\, dr = \\left[\\frac{r^2}{2}\\right]_0^{R/2} = \\frac{R^2}{8}$.\nThe second integral is tedious to compute directly. Let's evaluate it by substituting $mR = 2(\\alpha-1)$. A careful calculation yields:\n$$\n\\int_{R/2}^R \\left[1 + m\\left(r-\\frac{R}{2}\\right)\\right]^2 r \\, dr = R^2\\left(\\frac{3}{8} + \\frac{5}{12}(\\alpha-1) + \\frac{7}{48}(\\alpha-1)^2\\right).\n$$\nCombining the two parts:\n$$\n\\int_0^R u_\\alpha(r)^2 r \\, dr = \\frac{R^2}{8} + R^2\\left(\\frac{3}{8} + \\frac{5}{12}(\\alpha-1) + \\frac{7}{48}(\\alpha-1)^2\\right) = R^2\\left(\\frac{1}{2} + \\frac{5}{12}(\\alpha-1) + \\frac{7}{48}(\\alpha-1)^2\\right).\n$$\nExpanding in terms of $\\alpha$:\n$R^2\\left(\\frac{1}{2} + \\frac{5\\alpha-5}{12} + \\frac{7(\\alpha^2-2\\alpha+1)}{48}\\right) = R^2 \\frac{24 + 20\\alpha - 20 + 7\\alpha^2 - 14\\alpha + 7}{48} = R^2 \\frac{7\\alpha^2 + 6\\alpha + 11}{48}$.\n\nThus, $N(\\alpha)^2 = 2\\pi \\left(R^2 \\frac{7\\alpha^2 + 6\\alpha + 11}{48}\\right) = \\pi R^2 \\frac{7\\alpha^2 + 6\\alpha + 11}{24}$.\nThe numerator is $N(\\alpha) = R \\sqrt{\\pi} \\sqrt{\\frac{7\\alpha^2 + 6\\alpha + 11}{24}}$.\n\nNext, we compute the first term in the denominator, $D_1(\\alpha) = \\displaystyle\\int_{D_R} |\\nabla u_\\alpha| \\, dx$.\nThe derivative $u_\\alpha'(r)$ is $0$ for $0 < r < R/2$ and $u_\\alpha'(r) = m = \\frac{2(\\alpha-1)}{R}$ for $R/2 < r < R$.\nSince $\\alpha \\in [0,1]$, $m \\le 0$, so $|m| = -m = \\frac{2(1-\\alpha)}{R}$.\nThe integral is non-zero only over the annulus $A = \\{x \\in \\mathbb{R}^2 : R/2 < |x| < R\\}$.\n$$\nD_1(\\alpha) = \\int_A |m| \\, dx = |m| \\cdot \\text{Area}(A) = \\frac{2(1-\\alpha)}{R} \\cdot \\left(\\pi R^2 - \\pi\\left(\\frac{R}{2}\\right)^2\\right) = \\frac{2(1-\\alpha)}{R} \\cdot \\frac{3\\pi R^2}{4} = \\frac{3\\pi R}{2}(1-\\alpha).\n$$\n\nFinally, we compute the second term in the denominator, $D_2(\\alpha) = \\displaystyle\\int_{\\partial D_R} |u_\\alpha| \\, d\\sigma$.\nOn the boundary $\\partial D_R$, we have $r=R$, so $u_\\alpha(R)=\\alpha$. Since $\\alpha \\in [0,1]$, $|u_\\alpha(R)| = \\alpha$.\n$$\nD_2(\\alpha) = \\int_{\\partial D_R} \\alpha \\, d\\sigma = \\alpha \\cdot \\text{Length}(\\partial D_R) = \\alpha (2\\pi R) = 2\\pi R \\alpha.\n$$\n\nNow, we assemble the functional $\\mathcal{Q}(\\alpha)$. The denominator is:\n$D_1(\\alpha) + D_2(\\alpha) = \\frac{3\\pi R}{2}(1-\\alpha) + 2\\pi R \\alpha = \\pi R \\left(\\frac{3}{2} - \\frac{3}{2}\\alpha + 2\\alpha\\right) = \\pi R \\left(\\frac{3}{2} + \\frac{1}{2}\\alpha\\right) = \\frac{\\pi R}{2}(3+\\alpha)$.\nThe ratio is:\n$$\n\\mathcal{Q}(\\alpha) = \\frac{R \\sqrt{\\pi} \\sqrt{\\frac{7\\alpha^2 + 6\\alpha + 11}{24}}}{\\frac{\\pi R}{2}(3+\\alpha)} = \\frac{2}{\\sqrt{\\pi}\\sqrt{24}} \\frac{\\sqrt{7\\alpha^2 + 6\\alpha + 11}}{3+\\alpha}.\n$$\nUsing $\\sqrt{24} = 2\\sqrt{6}$, we simplify the constant factor:\n$$\n\\mathcal{Q}(\\alpha) = \\frac{2}{\\sqrt{\\pi}(2\\sqrt{6})} \\frac{\\sqrt{7\\alpha^2 + 6\\alpha + 11}}{3+\\alpha} = \\frac{1}{\\sqrt{6\\pi}} \\frac{\\sqrt{7\\alpha^2 + 6\\alpha + 11}}{3+\\alpha}.\n$$\nAs expected, $\\mathcal{Q}(\\alpha)$ is independent of the radius $R$.\n\nTo find the supremum of $\\mathcal{Q}(\\alpha)$ for $\\alpha \\in [0,1]$, we can find the supremum of its square, since $\\mathcal{Q}(\\alpha) > 0$. Let $g(\\alpha) = (\\mathcal{Q}(\\alpha)\\sqrt{6\\pi})^2$.\n$$\ng(\\alpha) = \\frac{7\\alpha^2 + 6\\alpha + 11}{(3+\\alpha)^2}.\n$$\nWe find the critical points by computing the derivative $g'(\\alpha)$:\n$$\ng'(\\alpha) = \\frac{(14\\alpha+6)(3+\\alpha)^2 - (7\\alpha^2+6\\alpha+11) \\cdot 2(3+\\alpha)}{(3+\\alpha)^4} = \\frac{(14\\alpha+6)(3+\\alpha) - 2(7\\alpha^2+6\\alpha+11)}{(3+\\alpha)^3}.\n$$\nThe numerator simplifies to:\n$(14\\alpha^2 + 42\\alpha + 6\\alpha + 18) - (14\\alpha^2 + 12\\alpha + 22) = 14\\alpha^2 + 48\\alpha + 18 - 14\\alpha^2 - 12\\alpha - 22 = 36\\alpha-4$.\nSo, $g'(\\alpha) = \\frac{36\\alpha - 4}{(3+\\alpha)^3}$.\nSetting $g'(\\alpha) = 0$ gives $36\\alpha-4=0$, which yields $\\alpha = \\frac{4}{36} = \\frac{1}{9}$. This critical point lies in the interval $[0,1]$.\nThe sign of $g'(\\alpha)$ is determined by $36\\alpha-4$. For $\\alpha < 1/9$, $g'(\\alpha)<0$, and for $\\alpha > 1/9$, $g'(\\alpha)>0$. This indicates that $\\alpha=1/9$ is a local minimum.\n\nBy the Extreme Value Theorem, the maximum value of the continuous function $g(\\alpha)$ on the closed interval $[0,1]$ must occur at one of the endpoints, $\\alpha=0$ or $\\alpha=1$.\nWe evaluate $g(\\alpha)$ at these endpoints:\nFor $\\alpha=0$: $g(0) = \\frac{11}{3^2} = \\frac{11}{9}$.\nFor $\\alpha=1$: $g(1) = \\frac{7+6+11}{(3+1)^2} = \\frac{24}{16} = \\frac{3}{2}$.\nComparing the two values, $\\frac{3}{2} = 1.5$ and $\\frac{11}{9} \\approx 1.22$. The maximum value of $g(\\alpha)$ on $[0,1]$ is $g(1) = \\frac{3}{2}$.\n\nThe supremum of $\\mathcal{Q}(\\alpha)$ is therefore $\\mathcal{Q}(1)$.\n$$\n\\sup_{\\alpha\\in[0,1]} \\mathcal{Q}(\\alpha) = \\mathcal{Q}(1) = \\frac{1}{\\sqrt{6\\pi}} \\sqrt{g(1)} = \\frac{1}{\\sqrt{6\\pi}} \\sqrt{\\frac{3}{2}}.\n$$\nSimplifying this expression:\n$$\n\\frac{1}{\\sqrt{6\\pi}} \\frac{\\sqrt{3}}{\\sqrt{2}} = \\frac{\\sqrt{3}}{\\sqrt{12\\pi}} = \\frac{\\sqrt{3}}{\\sqrt{4 \\cdot 3 \\cdot \\pi}} = \\frac{\\sqrt{3}}{2\\sqrt{3}\\sqrt{\\pi}} = \\frac{1}{2\\sqrt{\\pi}}.\n$$\nThis is the required explicit closed-form expression.", "answer": "$$\n\\boxed{\\frac{1}{2\\sqrt{\\pi}}}\n$$", "id": "3072416"}, {"introduction": "While analytical calculations are insightful, they are often impractical for complex geometries. This practice bridges the gap between theory and application by guiding you through the process of creating a numerical simulation. You will translate the abstract differential geometric formulas for the metric, surface gradient, and mean curvature into a concrete computational algorithm, allowing you to estimate the terms of the Michael-Simon Sobolev inequality on a curved surface where pen-and-paper methods would fail. [@problem_id:3072467]", "problem": "You will implement a numerical estimator for the absolute mean curvature and the core integrals appearing in the geometric-analytic inequality commonly known as the Michael–Simon Sobolev inequality on a two-dimensional surface embedded in three-dimensional Euclidean space. Work with a simple trigonometric graph in three-dimensional Euclidean space, use a smooth compactly supported test function, and assemble the relevant integral quantities that appear on each side of the inequality. All angles must be treated in radians. No physical units are involved.\n\nConsider the graph surface embedded in three-dimensional Euclidean space given by the parametrization\n$$\nX(x,y) = \\big(x,\\, y,\\, f(x,y)\\big), \\quad f(x,y) = A \\sin(k x)\\sin(\\ell y),\n$$\nfor parameters $A \\in \\mathbb{R}$, $k \\in \\mathbb{R}$, and $\\ell \\in \\mathbb{R}$. Let the parameter domain be the open square\n$$\nD = \\{(x,y) \\in \\mathbb{R}^2 : |x| < L,\\ |y| < L\\},\n$$\nwith $L > 0$. Define a smooth compactly supported bump function $\\varphi : \\mathbb{R} \\to \\mathbb{R}$ by\n$$\n\\varphi(t) =\n\\begin{cases}\n\\exp\\left(-\\dfrac{1}{1-(t/L)^2}\\right), & \\text{if } |t| < L,\\\\\n0, & \\text{if } |t| \\ge L,\n\\end{cases}\n$$\nand set\n$$\nu(x,y) = \\varphi(x)\\,\\varphi(y).\n$$\nThe derivative of $\\varphi$ for $|t|<L$ is given by\n$$\n\\varphi'(t) = -\\dfrac{2t}{L^2\\left(1-(t/L)^2\\right)^2}\\,\\varphi(t),\n$$\nand $\\varphi'(t)=0$ for $|t| \\ge L$.\n\nUse the following fundamental definitions to construct the required numerical quantities:\n\n- The first fundamental form (metric) on the surface is given by the symmetric matrix\n$$\nG(x,y) = \\begin{pmatrix}\n\\langle X_x, X_x \\rangle & \\langle X_x, X_y \\rangle\\\\\n\\langle X_y, X_y \\rangle\n\\end{pmatrix},\n$$\nwith area element\n$$\n\\mathrm{d}\\mu = \\sqrt{\\det G(x,y)}\\,\\mathrm{d}x\\,\\mathrm{d}y.\n$$\n\n- For a scalar function $u$ on the surface pulled back to the parameters, the norm of the surface gradient is\n$$\n\\lVert \\nabla_M u \\rVert = \\sqrt{ \\begin{pmatrix} u_x & u_y \\end{pmatrix} G(x,y)^{-1} \\begin{pmatrix} u_x\\\\ u_y \\end{pmatrix} }.\n$$\n\n- For a graph surface $z=f(x,y)$, the scalar mean curvature is given by\n$$\nH(x,y) = \\operatorname{div}\\left( \\frac{\\nabla f}{\\sqrt{1+\\lVert \\nabla f \\rVert^2}} \\right),\n$$\nand you must numerically use its absolute value $|H(x,y)|$ in the integrals below.\n\nLet $m=2$ be the dimension of the surface. For the exponent $p^\\ast = \\dfrac{m}{m-1}$, we have $p^\\ast=2$. The core integral quantities to compute are:\n- The left side quantity\n$$\n\\mathrm{LHS} = \\left( \\int_{M} |u|^{2}\\,\\mathrm{d}\\mu \\right)^{1/2}.\n$$\n- The right side integrand pieces\n$$\nI_{\\nabla} = \\int_{M} \\lVert \\nabla_M u \\rVert\\,\\mathrm{d}\\mu,\n\\quad\nI_{H} = \\int_{M} |H|\\,|u|\\,\\mathrm{d}\\mu.\n$$\nFor numerical comparison independent of any inequality constant, define\n$$\nR = \\frac{\\mathrm{LHS}}{I_{\\nabla} + I_{H}}.\n$$\n\nYour task is to:\n- Approximate the integrals using a uniform tensor-product grid on $D$, excluding the boundary to avoid evaluating where $\\varphi$ is identically zero but derivatives become undefined by direct substitution in intermediate formulas. Use a simple rectangle rule with constant spacings $\\Delta x$ and $\\Delta y$ to approximate the integrals as Riemann sums.\n- Compute and report the following five quantities for each test case:\n  - $\\int_{M} |u|^{2}\\,\\mathrm{d}\\mu$,\n  - $\\int_{M} \\lVert \\nabla_M u \\rVert\\,\\mathrm{d}\\mu$,\n  - $\\int_{M} |H|\\,|u|\\,\\mathrm{d}\\mu$,\n  - $\\mathrm{LHS}$,\n  - $R$.\n- Round each reported number to exactly $6$ decimal places.\n\nTest suite. Use the following test parameter sets, with all angles in radians:\n- Test $1$: $L=1.0$, $A=0.2$, $k=2\\pi$, $\\ell=\\pi$, grid size $N=301$ points in each coordinate direction strictly inside $(-L,L)$.\n- Test $2$: $L=1.0$, $A=0.0$, $k=0.0$, $\\ell=0.0$, grid size $N=301$.\n- Test $3$: $L=1.0$, $A=0.5$, $k=4\\pi$, $\\ell=3\\pi$, grid size $N=301$.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list of three lists, one per test, each inner list containing the five rounded floats in the order specified above, for example:\n$$\n\\text{[ [v_{11},v_{12},v_{13},v_{14},v_{15}], [v_{21},v_{22},v_{23},v_{24},v_{25}], [v_{31},v_{32},v_{33},v_{34},v_{35}] ]}.\n$$", "solution": "The problem is valid. It presents a well-defined task in numerical geometric analysis, grounded in standard principles of differential geometry. All required formulas, parameters, and numerical methods are specified, and the problem is self-contained and mathematically consistent.\n\nThe objective is to compute five numerical quantities related to the Michael-Simon Sobolev inequality on a specified two-dimensional surface embedded in three-dimensional space, for three distinct sets of parameters. The quantities are derived from three core integrals, which we will approximate using a Riemann sum on a uniform grid.\n\nFirst, we establish the necessary mathematical formulas for the computation.\n\nThe surface is the graph of the function $z = f(x,y)$, given by the parametrization $X(x,y) = (x, y, f(x,y))$ where\n$$\nf(x,y) = A \\sin(k x)\\sin(\\ell y).\n$$\nThe first and second partial derivatives of $f$ are required for the metric and curvature calculations:\n$$\n\\begin{aligned}\nf_x &= \\frac{\\partial f}{\\partial x} = Ak \\cos(kx)\\sin(\\ell y), \\\\\nf_y &= \\frac{\\partial f}{\\partial y} = A\\ell \\sin(kx)\\cos(\\ell y), \\\\\nf_{xx} &= \\frac{\\partial^2 f}{\\partial x^2} = -Ak^2 \\sin(kx)\\sin(\\ell y), \\\\\nf_{yy} &= \\frac{\\partial^2 f}{\\partial y^2} = -A\\ell^2 \\sin(kx)\\sin(\\ell y), \\\\\nf_{xy} &= \\frac{\\partial^2 f}{\\partial x \\partial y} = Ak\\ell \\cos(kx)\\cos(\\ell y).\n\\end{aligned}\n$$\nThe first fundamental form (metric tensor) $G$ for a graph surface is given by\n$$\nG(x,y) = \\begin{pmatrix} 1+f_x^2 & f_x f_y \\\\ f_x f_y & 1+f_y^2 \\end{pmatrix}.\n$$\nThe surface area element $\\mathrm{d}\\mu$ is related to the standard Lebesgue measure $\\mathrm{d}x\\mathrm{d}y$ by\n$$\n\\mathrm{d}\\mu = \\sqrt{\\det G}\\,\\mathrm{d}x\\mathrm{d}y = \\sqrt{(1+f_x^2)(1+f_y^2) - (f_x f_y)^2}\\,\\mathrm{d}x\\mathrm{d}y = \\sqrt{1+f_x^2+f_y^2}\\,\\mathrm{d}x\\mathrm{d}y.\n$$\nThe scalar mean curvature $H$ for a graph surface is given by the formula\n$$\nH = \\frac{(1+f_y^2)f_{xx} - 2f_x f_y f_{xy} + (1+f_x^2)f_{yy}}{(1+f_x^2+f_y^2)^{3/2}}.\n$$\nThe test function is $u(x,y) = \\varphi(x)\\varphi(y)$, where $\\varphi(t)$ is a standard smooth bump function. Its partial derivatives are\n$$\nu_x = \\varphi'(x)\\varphi(y) \\quad \\text{and} \\quad u_y = \\varphi(x)\\varphi'(y).\n$$\nThe derivatives $\\varphi'(t)$ are given by the problem statement. The norm of the surface gradient $\\nabla_M u$ is calculated using the inverse metric $G^{-1}$:\n$$\n\\lVert \\nabla_M u \\rVert^2 = \\begin{pmatrix} u_x & u_y \\end{pmatrix} G^{-1} \\begin{pmatrix} u_x \\\\ u_y \\end{pmatrix} = \\frac{1}{\\det G} \\left( (1+f_y^2)u_x^2 - 2f_x f_y u_x u_y + (1+f_x^2)u_y^2 \\right).\n$$\nThis can be rewritten as $\\lVert \\nabla_M u \\rVert^2 = \\frac{u_x^2+u_y^2+(f_y u_x - f_x u_y)^2}{1+f_x^2+f_y^2}$, which is manifestly non-negative.\n\nNext, we define the numerical approximation scheme. The integrals are over the manifold $M$, which is the graph of $f$ over the domain $D = (-L,L) \\times (-L,L)$. We approximate these integrals using a Riemann sum over a discrete grid. We construct a uniform tensor-product grid of $N \\times N$ points $(x_i, y_j)$ strictly inside $D$. The grid spacing is $\\Delta x = \\Delta y = \\frac{2L}{N+1}$. The grid points are given by\n$$\nx_i = -L + i \\cdot \\Delta x, \\quad y_j = -L + j \\cdot \\Delta y, \\quad \\text{for } i, j \\in \\{1, 2, \\dots, N\\}.\n$$\nAn integral of a function $I(x,y)$ over the surface is approximated as:\n$$\n\\int_M I \\, \\mathrm{d}\\mu = \\int_D I(x,y) \\sqrt{1+f_x^2+f_y^2} \\, \\mathrm{d}x\\mathrm{d}y \\approx \\sum_{i=1}^N \\sum_{j=1}^N I(x_i, y_j) \\sqrt{1+f_x(x_i,y_j)^2+f_y(x_i,y_j)^2} \\, \\Delta x \\Delta y.\n$$\n\nThe overall algorithm is as follows:\n1.  For each test case, specified by parameters $(L, A, k, \\ell, N)$, initialize the integral accumulators to zero.\n2.  Set up the $N \\times N$ numerical grid using `meshgrid` to create 2D arrays `xx` and `yy` for the coordinates.\n3.  Calculate the partial derivatives $f_x, f_y, f_{xx}, f_{yy}, f_{xy}$ as 2D arrays evaluated on the grid.\n4.  Calculate the test function $u = \\varphi(x)\\varphi(y)$ and its partial derivatives $u_x, u_y$ as 2D arrays on the grid. This involves first defining helper functions for $\\varphi(t)$ and $\\varphi'(t)$ that operate on numpy arrays.\n5.  Compute the geometric quantities as 2D arrays on the grid:\n    -   The area element scaling factor $\\sqrt{\\det G} = \\sqrt{1+f_x^2+f_y^2}$.\n    -   The absolute mean curvature $|H|$.\n    -   The norm of the surface gradient $\\lVert \\nabla_M u \\rVert$.\n6.  Assemble the three integrand arrays:\n    -   $I_1 = u^2 \\sqrt{\\det G}$\n    -   $I_2 = \\lVert \\nabla_M u \\rVert \\sqrt{\\det G}$\n    -   $I_3 = |H| u \\sqrt{\\det G}$ (note that $u(x,y) \\ge 0$, so $|u|=u$).\n7.  Compute the three integrals by summing each integrand array over all grid points and multiplying by the area of a grid cell, $\\Delta A = \\Delta x \\Delta y$.\n    -   $\\int_M |u|^2 \\mathrm{d}\\mu \\approx (\\sum I_1) \\Delta A$\n    -   $I_\\nabla = \\int_M \\lVert \\nabla_M u \\rVert \\mathrm{d}\\mu \\approx (\\sum I_2) \\Delta A$\n    -   $I_H = \\int_M |H| |u| \\mathrm{d}\\mu \\approx (\\sum I_3) \\Delta A$\n8.  Calculate the final derived quantities:\n    -   $\\mathrm{LHS} = \\left(\\int_M |u|^2 \\mathrm{d}\\mu\\right)^{1/2}$\n    -   $R = \\mathrm{LHS} / (I_\\nabla + I_H)$\n9.  Round the five required values to $6$ decimal places and collect them for final output. This process is repeated for each of the three test cases. For Test Case 2 ($A=k=\\ell=0$), the surface is flat ($f=0$), so $H=0$ and $\\mathrm{d}\\mu = \\mathrm{d}x\\mathrm{d}y$, simplifying the calculations to standard 2D Euclidean integrals, providing a useful check on the implementation.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes numerical estimates for integrals related to the\n    Michael-Simon Sobolev inequality for three test cases.\n    \"\"\"\n    \n    test_cases = [\n        # (L, A, k, l, N)\n        (1.0, 0.2, 2 * np.pi, np.pi, 301),\n        (1.0, 0.0, 0.0, 0.0, 301),\n        (1.0, 0.5, 4 * np.pi, 3 * np.pi, 301),\n    ]\n\n    all_results = []\n\n    def phi(t, L_val):\n        \"\"\"Computes the bump function phi(t).\"\"\"\n        t_scaled_sq = (t / L_val)**2\n        # Use a mask to handle the domain |t| < L\n        mask = t_scaled_sq < 1.0\n        result = np.zeros_like(t, dtype=np.float64)\n        valid_t_scaled_sq = t_scaled_sq[mask]\n        result[mask] = np.exp(-1.0 / (1.0 - valid_t_scaled_sq))\n        return result\n\n    def phi_prime(t, L_val, phi_t_val):\n        \"\"\"Computes the derivative of the bump function, phi'(t).\"\"\"\n        t_scaled_sq = (t / L_val)**2\n        mask = t_scaled_sq < 1.0\n        result = np.zeros_like(t, dtype=np.float64)\n        if not np.any(mask):\n            return result\n        \n        valid_t = t[mask]\n        valid_phi_t = phi_t_val[mask]\n        valid_t_scaled_sq = t_scaled_sq[mask]\n        \n        denominator = L_val**2 * (1.0 - valid_t_scaled_sq)**2\n        result[mask] = -2.0 * valid_t * valid_phi_t / denominator\n        return result\n\n    for L, A, k, l, N in test_cases:\n        # 1. Grid setup\n        dx = 2 * L / (N + 1)\n        dy = 2 * L / (N + 1)\n        x_1d = np.linspace(-L + dx, L - dx, N)\n        y_1d = np.linspace(-L + dy, L - dy, N)\n        xx, yy = np.meshgrid(x_1d, y_1d, indexing='xy')\n\n        # 2. Surface function f and its derivatives\n        sin_kx = np.sin(k * xx)\n        cos_kx = np.cos(k * xx)\n        sin_ly = np.sin(l * yy)\n        cos_ly = np.cos(l * yy)\n\n        fx = A * k * cos_kx * sin_ly\n        fy = A * l * sin_kx * cos_ly\n        fxx = -A * k**2 * sin_kx * sin_ly\n        fyy = -A * l**2 * sin_kx * sin_ly\n        fxy = A * k * l * cos_kx * cos_ly\n\n        # 3. Test function u and its derivatives\n        phi_on_x = phi(xx, L)\n        phi_on_y = phi(yy, L)\n        phi_prime_on_x = phi_prime(xx, L, phi_on_x)\n        phi_prime_on_y = phi_prime(yy, L, phi_on_y)\n        \n        u = phi_on_x * phi_on_y\n        ux = phi_prime_on_x * phi_on_y\n        uy = phi_on_x * phi_prime_on_y\n        \n        # 4. Geometric quantities\n        det_G_sqrt = np.sqrt(1.0 + fx**2 + fy**2)\n\n        H_num = (1.0 + fy**2) * fxx - 2.0 * fx * fy * fxy + (1.0 + fx**2) * fyy\n        H_den = (1.0 + fx**2 + fy**2)**1.5\n        H = H_num / H_den\n\n        grad_u_norm_sq_num = ux**2 * (1.0 + fy**2) - 2.0 * ux * uy * fx * fy + uy**2 * (1.0 + fx**2)\n        grad_u_norm_sq_den = 1.0 + fx**2 + fy**2\n        # Ensure argument to sqrt is non-negative\n        safe_arg = np.maximum(0, grad_u_norm_sq_num / grad_u_norm_sq_den)\n        norm_grad_M_u = np.sqrt(safe_arg)\n\n        # 5. Integrands\n        integrand1 = u**2 * det_G_sqrt\n        integrand2 = norm_grad_M_u * det_G_sqrt\n        integrand3 = np.abs(H) * u * det_G_sqrt\n\n        # 6. Summation for Riemann integral approximation\n        delta_area = dx * dy\n        \n        int_u_sq = np.sum(integrand1) * delta_area\n        int_grad_u = np.sum(integrand2) * delta_area\n        int_H_u = np.sum(integrand3) * delta_area\n\n        # 7. Final quantities\n        lhs = np.sqrt(int_u_sq)\n        denominator_R = int_grad_u + int_H_u\n        \n        if np.isclose(denominator_R, 0):\n            r_val = np.nan # Or inf, but should not happen in these cases.\n        else:\n            r_val = lhs / denominator_R\n        \n        results_for_case = [\n            round(int_u_sq, 6),\n            round(int_grad_u, 6),\n            round(int_H_u, 6),\n            round(lhs, 6),\n            round(r_val, 6)\n        ]\n        all_results.append(results_for_case)\n    \n    # Final print statement in the exact required format.\n    # Convert to string and remove spaces to match the required dense format.\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "3072467"}]}