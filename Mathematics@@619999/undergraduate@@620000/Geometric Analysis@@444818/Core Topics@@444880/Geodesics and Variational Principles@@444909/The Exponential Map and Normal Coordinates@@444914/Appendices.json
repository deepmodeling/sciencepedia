{"hands_on_practices": [{"introduction": "The round sphere is the archetypal example of a positively curved Riemannian manifold, making it the perfect setting to first explore the exponential map. This exercise invites you to connect the abstract definitions of geodesics, injectivity radius, and cut locus to the concrete geometry of the sphere. By calculating these fundamental quantities, you will gain a tangible understanding of how the exponential map wraps the flat tangent space onto the curved sphere and where this mapping ceases to be unique or distance-minimizing [@problem_id:3069007].", "problem": "Let $S^{n}_{R} \\subset \\mathbb{R}^{n+1}$ denote the round $n$-sphere of radius $R0$ endowed with the Riemannian metric induced by the standard Euclidean inner product on $\\mathbb{R}^{n+1}$. Fix a point $p \\in S^{n}_{R}$ and consider the exponential map $\\exp_{p} : T_{p} S^{n}_{R} \\to S^{n}_{R}$ defined by sending a tangent vector $v \\in T_{p} S^{n}_{R}$ to the endpoint at time $t=1$ of the unique geodesic $\\gamma_{v}$ with initial conditions $\\gamma_{v}(0) = p$ and $\\dot{\\gamma}_{v}(0) = v$. Work from the following bases: the definition of the exponential map, the notion of geodesic distance and minimizing geodesics, and the well-tested fact that geodesics on $S^{n}_{R}$ are the great circles obtained by intersecting $S^{n}_{R}$ with $2$-planes through the origin.\n\nUsing these bases, determine the largest radius $\\rho0$ such that the restriction of $\\exp_{p}$ to the open ball $B(0,\\rho) \\subset T_{p} S^{n}_{R}$ is a diffeomorphism onto its image; this $\\rho$ is the injectivity radius at $p$. In addition, identify the cut locus of $p$, defined as the set of endpoints of geodesics starting at $p$ beyond which geodesics cease to be globally minimizing or cease to be unique as minimizing curves from $p$. Express the injectivity radius symbolically in terms of $R$, and express the cut locus point symbolically using the identification $S^{n}_{R} \\subset \\mathbb{R}^{n+1}$.\n\nYour final answer must be a single row matrix with two entries using the $\\pmatrix$ environment, with the first entry equal to the injectivity radius and the second entry equal to the symbolic representation of the cut locus point. No rounding is required.", "solution": "The problem is valid as it is a well-posed, scientifically grounded question in Riemannian geometry. It is based on standard definitions and established facts concerning the geometry of the sphere. The data provided is complete, consistent, and free of ambiguity.\n\nLet $S^{n}_{R}$ be the $n$-sphere of radius $R  0$ in $\\mathbb{R}^{n+1}$, centered at the origin. The metric on $S^{n}_{R}$ is the one induced by the standard Euclidean inner product on $\\mathbb{R}^{n+1}$. Let $p \\in S^{n}_{R}$ be a point on the sphere. A tangent vector $v \\in T_{p} S^{n}_{R}$ can be identified with a vector in $\\mathbb{R}^{n+1}$ that is orthogonal to the position vector of $p$. The norm of $v$, denoted $\\|v\\|$, is its Euclidean length.\n\nAccording to the problem statement, geodesics on $S^{n}_{R}$ are great circles. A geodesic $\\gamma_{v}(t)$ starting at $p$ with initial velocity $v \\in T_{p}S^{n}_{R}$ traces a path along the unique great circle determined by the plane containing the origin, $p$, and $p+v$. The speed of this geodesic is constant and equal to $\\|v\\|$.\n\nLet us parameterize such a geodesic by arc length. We can define an orthonormal pair of vectors $\\{ \\frac{p}{R}, \\frac{v}{\\|v\\|} \\}$ in the plane of the great circle. Note that as a vector in $\\mathbb{R}^{n+1}$, $p$ is orthogonal to any $v \\in T_pS^n_R$. The position vector of a point at an arc length distance $s$ from $p$ along the great circle in the direction of $v$ is given by\n$$ \\gamma(s) = p \\cos\\left(\\frac{s}{R}\\right) + \\left(R \\frac{v}{\\|v\\|}\\right) \\sin\\left(\\frac{s}{R}\\right) $$\nThis parameterization traces the great circle at unit speed. A geodesic $\\gamma_v(t)$ with initial velocity $\\dot{\\gamma}_v(0) = v$ has speed $\\|v\\|$, so the arc length traversed at time $t$ is $s = \\|v\\|t$. Substituting this into the arc length parameterization gives the time-dependent geodesic:\n$$ \\gamma_{v}(t) = p \\cos\\left(\\frac{\\|v\\|t}{R}\\right) + \\left(R \\frac{v}{\\|v\\|}\\right) \\sin\\left(\\frac{\\|v\\|t}{R}\\right) $$\nThe exponential map $\\exp_{p}: T_{p}S^{n}_{R} \\to S^{n}_{R}$ is defined by evaluating this geodesic at $t=1$:\n$$ \\exp_{p}(v) = \\gamma_{v}(1) = p \\cos\\left(\\frac{\\|v\\|}{R}\\right) + \\left(R \\frac{v}{\\|v\\|}\\right) \\sin\\left(\\frac{\\|v\\|}{R}\\right) $$\nThis expression maps a vector $v$ in the tangent space at $p$ to a point on the sphere. The distance from the origin in $T_pS^n_R$, $\\|v\\|$, corresponds to the geodesic distance from $p$ on the sphere. The direction of $v$ determines the initial direction of the geodesic.\n\nWe first seek the injectivity radius $\\rho$ at $p$. This is the largest radius $\\rho  0$ for which the map $\\exp_{p}$ is injective on the open ball $B(0,\\rho) \\subset T_pS^n_R$. Let's examine when $\\exp_{p}(v_1) = \\exp_{p}(v_2)$ for $v_1 \\neq v_2$.\nThe map $\\exp_p$ \"wraps\" the tangent plane around the sphere. A potential failure of injectivity occurs when multiple geodesics starting at $p$ reconverge at a single point. On a sphere, all geodesics (great circles) passing through $p$ reconverge at the antipodal point, which is $-p$ in $\\mathbb{R}^{n+1}$.\n\nLet's find the vectors $v \\in T_pS^n_R$ that are mapped to the antipodal point $-p$:\n$$ \\exp_{p}(v) = -p $$\n$$ p \\cos\\left(\\frac{\\|v\\|}{R}\\right) + \\left(R \\frac{v}{\\|v\\|}\\right) \\sin\\left(\\frac{\\|v\\|}{R}\\right) = -p $$\nSince the vectors $p$ and $v$ (and thus $v/\\|v\\|$) are orthogonal, this equation can only be satisfied if the term with $\\sin(\\cdot)$ vanishes and the coefficient of $p$ is $-1$. This requires:\n1. $\\sin\\left(\\frac{\\|v\\|}{R}\\right) = 0$, which implies $\\frac{\\|v\\|}{R} = k\\pi$ for some integer $k$.\n2. $\\cos\\left(\\frac{\\|v\\|}{R}\\right) = -1$, which implies $\\frac{\\|v\\|}{R} = (2m+1)\\pi$ for some integer $m$.\nBoth conditions are satisfied if $\\frac{\\|v\\|}{R}$ is an odd integer multiple of $\\pi$. The smallest positive value for $\\|v\\|$ occurs when $\\frac{\\|v\\|}{R} = \\pi$, so $\\|v\\| = \\pi R$.\n\nThis means that all vectors $v \\in T_pS^n_R$ that lie on the sphere of radius $\\pi R$ are mapped to the single point $-p$. Consequently, for any $\\epsilon  0$, the open ball $B(0, \\pi R + \\epsilon)$ contains distinct vectors that are mapped to the same point, so $\\exp_p$ is not injective on this ball. The map is, however, injective on the open ball $B(0, \\pi R)$. On this ball, any two distinct vectors $v_1, v_2$ have lengths less than $\\pi R$. The corresponding geodesics travel a distance less than the distance to the antipodal point, and thus their endpoints $\\exp_p(v_1)$ and $\\exp_p(v_2)$ are distinct. Therefore, the largest radius for which the map is a diffeomorphism onto its image is $\\pi R$. The injectivity radius is $\\rho = \\pi R$.\n\nNext, we identify the cut locus of $p$. The cut locus is the set of points where geodesics from $p$ cease to be uniquely minimizing or cease to be globally minimizing at all.\nA geodesic segment is minimizing if its length is the shortest distance between its endpoints. On $S^n_R$, the geodesic distance between two points $q_1, q_2$ is given by $d(q_1, q_2) = R \\arccos\\left(\\frac{q_1 \\cdot q_2}{R^2}\\right)$. The maximum possible geodesic distance between any two points on the sphere is $\\pi R$, the distance between a point and its antipode.\n\nConsider a geodesic $\\gamma$ starting at $p$.\n- If its length $L$ is less than $\\pi R$, it is the unique shortest path between its endpoints.\n- If its length is exactly $L = \\pi R$, its endpoint is the antipodal point $-p$. This path is a minimizing geodesic. However, it is not uniquely minimizing. Any great circle through $p$ also passes through $-p$, providing an infinite number of minimizing geodesics of length $\\pi R$ from $p$ to $-p$. Therefore, $-p$ is in the cut locus of $p$.\n- If its length is $L  \\pi R$, say $L = \\pi R + \\delta$ with $\\delta  0$, the geodesic is no longer minimizing. Its endpoint $q = \\gamma(\\pi R + \\delta)$ can be reached from $p$ via a shorter path along the same great circle in the opposite direction, with length $2\\pi R - L = \\pi R - \\delta  L$.\n\nEvery geodesic starting from $p$ reaches its first cut point at a distance of $\\pi R$, and this cut point is invariably the antipodal point $-p$. Thus, the cut locus of $p$ is the singleton set containing the antipodal point, $\\{-p\\}$. The problem asks for the cut locus point, which, in the vector representation of $S^n_R \\subset \\mathbb{R}^{n+1}$, is $-p$.\n\nTo summarize, the injectivity radius is the distance from $p$ to its first conjugate point, which for the sphere is the antipodal point at distance $\\pi R$. The cut locus of $p$ is precisely this antipodal point.\n\nThe injectivity radius is $\\pi R$. The cut locus consists of the single point $-p$.", "answer": "$$\\boxed{\\begin{pmatrix} \\pi R  -p \\end{pmatrix}}$$", "id": "3069007"}, {"introduction": "In contrast to the sphere, the cylinder is a simple example of a flat manifold ($R=0$) that is not simply connected. This practice explores how the global topology of a manifold, rather than its local curvature, determines the structure of its cut locus. By \"unrolling\" the cylinder into its universal cover (the plane), you can clearly visualize how multiple geodesics can connect two points, allowing you to precisely identify the cut locus and compute the injectivity radius [@problem_id:3068982].", "problem": "Let $M = S^{1} \\times \\mathbb{R}$ be the round cylinder of radius $a>0$ endowed with the product Riemannian metric $g = a^{2}\\,d\\theta^{2} + dz^{2}$, where $\\theta \\in S^{1}$ and $z \\in \\mathbb{R}$. For a fixed point $p = (\\theta_{0}, z_{0}) \\in M$, consider the exponential map $\\exp_{p} : T_{p}M \\to M$ defined by sending a tangent vector $v \\in T_{p}M$ to the point reached at time $t=1$ along the unique geodesic starting at $p$ with initial velocity $v$. The Riemannian distance $d(\\cdot,\\cdot)$ on $M$ is the infimum of lengths of piecewise smooth curves connecting two points, computed with respect to $g$. The injectivity radius at $p$, denoted $\\operatorname{inj}(p)$, is the supremum of all $r>0$ such that the restriction of $\\exp_{p}$ to the open ball $B_{r}(0) \\subset T_{p}M$ is a diffeomorphism onto its image; equivalently, it is the distance from $p$ to its cut locus.\n\nStarting from these definitions and the fundamental fact that geodesics locally minimize length, determine the set of cut points of $p$ and show that it is the opposite ruling $\\{\\theta = \\theta_{0} + \\pi\\}$ (with all $z \\in \\mathbb{R}$). Then compute $\\operatorname{inj}(p)$ as an explicit expression in terms of $a$. Provide only the final expression for $\\operatorname{inj}(p)$; no rounding is required.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard exercise in Riemannian geometry, providing all necessary definitions and data without internal contradictions. The task is to analyze the geodesics on a round cylinder to determine the cut locus of a point and compute the corresponding injectivity radius. All terms are standard and the setup is a classic example in the subject. Therefore, the problem is valid and I will proceed with a full solution.\n\nThe manifold is $M = S^{1} \\times \\mathbb{R}$, representing a cylinder of radius $a>0$. The circle $S^1$ is parametrized by an angle $\\theta$, and the real line $\\mathbb{R}$ by a coordinate $z$. The Riemannian metric is given as $g = a^{2}\\,d\\theta^{2} + dz^{2}$. We are asked to analyze the geometry from a fixed point $p = (\\theta_{0}, z_{0})$.\n\nFirst, we determine the geodesics on $M$. Geodesics are curves $\\gamma(t) = (\\theta(t), z(t))$ that locally minimize length, and they are critical points of the energy functional $E(\\gamma) = \\frac{1}{2} \\int g(\\dot{\\gamma}(t), \\dot{\\gamma}(t)) dt$. For the given metric, the integrand is $L(\\theta, z, \\dot{\\theta}, \\dot{z}) = \\frac{1}{2}(a^2\\dot{\\theta}^2 + \\dot{z}^2)$. The Euler-Lagrange equations are:\n$$ \\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{\\theta}}\\right) - \\frac{\\partial L}{\\partial \\theta} = 0 \\implies \\frac{d}{dt}(a^2\\dot{\\theta}) = 0 $$\n$$ \\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{z}}\\right) - \\frac{\\partial L}{\\partial z} = 0 \\implies \\frac{d}{dt}(\\dot{z}) = 0 $$\nSince the Lagrangian $L$ is independent of $\\theta$ and $z$, the equations simplify greatly. Integrating them yields $a^2\\dot{\\theta}(t) = c_1$ and $\\dot{z}(t) = c_2$ for some constants $c_1, c_2$. This implies $\\ddot{\\theta}(t) = 0$ and $\\ddot{z}(t) = 0$. A further integration gives the general form of a geodesic:\n$$ \\theta(t) = \\omega t + \\theta_{start} $$\n$$ z(t) = v_z t + z_{start} $$\nThese are helices on the cylinder. For a geodesic starting at $p = (\\theta_0, z_0)$ with initial velocity $v = v^\\theta \\frac{\\partial}{\\partial \\theta}|_p + v^z \\frac{\\partial}{\\partial z}|_p \\in T_pM$, the initial conditions are $(\\theta(0), z(0)) = (\\theta_0, z_0)$ and $(\\dot{\\theta}(0), \\dot{z}(0)) = (v^\\theta, v^z)$. This sets $\\omega = v^\\theta$ and $v_z = v^z$. The unique geodesic $\\gamma_v(t)$ is thus:\n$$ \\gamma_v(t) = (\\theta_0 + v^\\theta t, z_0 + v^z t) $$\n\nThe cut locus of a point $p$ is defined as the set of points $q$ for which there exist at least two distinct minimizing geodesics from $p$ to $q$, or which are the first conjugate point to $p$ along a geodesic. The given metric $g$ is flat (its Riemann curvature tensor is zero), which can be seen by observing that the metric coefficients are constant in the $(\\theta, z)$ coordinate system. A consequence of zero curvature is the absence of conjugate points. Therefore, the cut locus of $p$ is determined solely by the meeting of multiple minimizing geodesics.\n\nTo find the distances and identify multiple minimizing paths, we can \"unroll\" the cylinder. The universal cover of $M = S^1 \\times \\mathbb{R}$ is $\\tilde{M} = \\mathbb{R} \\times \\mathbb{R} = \\mathbb{R}^2$. Let the coordinates on $\\tilde{M}$ be $(\\tilde{\\theta}, z)$. The projection map $\\pi: \\tilde{M} \\to M$ is given by $\\pi(\\tilde{\\theta}, z) = (\\tilde{\\theta} \\pmod{2\\pi}, z)$. The metric on $\\tilde{M}$ induced by $g$ is $d\\tilde{s}^2 = a^2 d\\tilde{\\theta}^2 + dz^2$. This is a rescaling of the standard Euclidean metric on $\\mathbb{R}^2$. Geodesics on $M$ are the projections of straight lines in $(\\tilde{M}, d\\tilde{s}^2)$.\n\nLet $p = (\\theta_0, z_0) \\in M$. We lift it to a point $\\tilde{p} = (\\theta_0, z_0) \\in \\tilde{M}$. A point $q = (\\theta_q, z_q) \\in M$ has infinitely many preimages in $\\tilde{M}$, given by $\\tilde{q}_k = (\\theta_q + 2\\pi k, z_q)$ for all integers $k \\in \\mathbb{Z}$. The distance $d(p, q)$ on the cylinder is the minimum of the distances between $\\tilde{p}$ and the points $\\tilde{q}_k$ in the covering space. The squared distance between $\\tilde{p}$ and $\\tilde{q}_k$ is:\n$$ d(\\tilde{p}, \\tilde{q}_k)^2 = a^2((\\theta_q + 2\\pi k) - \\theta_0)^2 + (z_q - z_0)^2 = a^2(\\Delta\\theta + 2\\pi k)^2 + (\\Delta z)^2 $$\nwhere $\\Delta\\theta = \\theta_q - \\theta_0$ and $\\Delta z = z_q - z_0$. The Riemannian distance is $d(p,q) = \\min_{k \\in \\mathbb{Z}} \\sqrt{a^2(\\Delta\\theta + 2\\pi k)^2 + (\\Delta z)^2}$.\n\nTo find the minimum, we must minimize $|\\Delta\\theta + 2\\pi k|$ over $k \\in \\mathbb{Z}$. For any given $\\Delta\\theta$, there is a unique integer $k_0$ such that $\\Delta\\theta + 2\\pi k_0 \\in (-\\pi, \\pi]$.\n- If $\\Delta\\theta + 2\\pi k_0 \\in (-\\pi, \\pi)$, the minimum is unique, corresponding to a single minimizing geodesic.\n- If $\\Delta\\theta + 2\\pi k_0 = \\pi$, then $k = k_0$ gives $(\\Delta\\theta + 2\\pi k_0)^2 = \\pi^2$, and $k = k_0-1$ gives $(\\Delta\\theta + 2\\pi(k_0-1))^2 = (\\pi - 2\\pi)^2 = (-\\pi)^2 = \\pi^2$. In this case, there are two choices of $k$ that yield the same minimal distance. These correspond to two distinct minimizing geodesics from $p$ to $q$ (one winding \"clockwise\" and the other \"counter-clockwise\" around the cylinder).\n\nThe condition $\\Delta\\theta + 2\\pi k_0 = \\pi$ is equivalent to $\\theta_q - \\theta_0 = \\pi \\pmod{2\\pi}$. The set of points $q=(\\theta_q, z_q)$ satisfying this condition is $\\{ (\\theta, z) \\in M \\mid \\theta = \\theta_0 + \\pi, z \\in \\mathbb{R} \\}$. This is precisely the opposite ruling of the cylinder relative to the generator passing through $p$. This is the cut locus of $p$, denoted $C(p)$.\n\nThe injectivity radius at $p$, $\\operatorname{inj}(p)$, is the distance from $p$ to its cut locus.\n$$ \\operatorname{inj}(p) = d(p, C(p)) = \\inf_{q \\in C(p)} d(p,q) $$\nFor any point $q = (\\theta_0+\\pi, z)$ in the cut locus $C(p)$, its distance from $p=(\\theta_0, z_0)$ is:\n$$ d(p,q) = \\sqrt{a^2\\pi^2 + (z-z_0)^2} $$\nTo find the injectivity radius, we must find the infimum of this distance as $q$ varies over the entire cut locus, which means as $z$ varies over $\\mathbb{R}$.\n$$ \\operatorname{inj}(p) = \\inf_{z \\in \\mathbb{R}} \\sqrt{a^2\\pi^2 + (z-z_0)^2} $$\nThe term $(z-z_0)^2$ is always non-negative, and its minimum value is $0$, achieved at $z = z_0$. Therefore, the infimum of the distance is:\n$$ \\operatorname{inj}(p) = \\sqrt{a^2\\pi^2 + 0} = \\sqrt{a^2\\pi^2} = a\\pi $$\nThe injectivity radius is $a\\pi$. This value is independent of the point $p$, as expected from the homogeneity of the cylinder.", "answer": "$$\\boxed{a\\pi}$$", "id": "3068982"}, {"introduction": "After exploring the exponential map on specific manifolds, we now turn to a fundamental property of the coordinate systems it generates. Normal coordinates are designed to make the metric at a point as \"Euclidean\" as possible, where $g_{ij}(p) = \\delta_{ij}$ and all first derivatives of the metric vanish. This exercise probes deeper, asking how two different sets of normal coordinates at the same point relate to one another, revealing that the transition is fundamentally a rotation (or reflection) at the origin when the bases are orthonormal [@problem_id:3068966].", "problem": "Let $(M,g)$ be a smooth Riemannian manifold of dimension $n$, and let $p \\in M$. Let $\\{e_{1},\\dots,e_{n}\\}$ and $\\{\\tilde{e}_{1},\\dots,\\tilde{e}_{n}\\}$ be two ordered bases of the tangent space $T_{p}M$. For each basis, define a normal coordinate chart at $p$ by using the exponential map at $p$, as follows: for $x=(x^{1},\\dots,x^{n}) \\in \\mathbb{R}^{n}$ sufficiently small, set\n$$\n\\varphi^{-1}(x) \\;=\\; \\exp_{p}\\!\\left(\\sum_{i=1}^{n} x^{i} e_{i}\\right), \n\\qquad \n\\tilde{\\varphi}^{-1}(y) \\;=\\; \\exp_{p}\\!\\left(\\sum_{i=1}^{n} y^{i} \\tilde{e}_{i}\\right),\n$$\nso that $\\varphi(p)=0$ and $\\tilde{\\varphi}(p)=0$. Consider the transition map $\\Phi=\\tilde{\\varphi}\\circ \\varphi^{-1}$ between these two normal coordinate charts, defined on a neighborhood of $0 \\in \\mathbb{R}^{n}$.\n\nStarting only from the definitions of the exponential map and normal coordinates, and basic properties of geodesics and the Riemannian metric, compute the Jacobian matrix $D\\Phi_{0}$ of the transition map at the origin. Express your result as an $n\\times n$ matrix whose entries are given explicitly in terms of the metric $g$ at $p$ and the two bases $\\{e_{i}\\}$ and $\\{\\tilde{e}_{i}\\}$. Then, assuming that both $\\{e_{i}\\}$ and $\\{\\tilde{e}_{i}\\}$ are orthonormal with respect to $g$ at $p$, show that this Jacobian matrix lies in the orthogonal group $O(n)$.\n\nYour final answer should be the single closed-form analytic expression for the Jacobian matrix $D\\Phi_{0}$ as a function of $g$, $\\{e_{i}\\}$, and $\\{\\tilde{e}_{i}\\}$. Do not provide any inequalities or equations as your final answer beyond this explicit matrix expression.", "solution": "The problem statement has been validated and is deemed valid. It is a well-posed problem within the established framework of Riemannian geometry. All terms are standard and the premises are scientifically sound.\n\nLet $(M,g)$ be a smooth $n$-dimensional Riemannian manifold, $p \\in M$, and let $\\{e_{1}, \\dots, e_{n}\\}$ and $\\{\\tilde{e}_{1}, \\dots, \\tilde{e}_{n}\\}$ be two ordered bases for the tangent space $T_{p}M$.\nThe two normal coordinate charts, $\\varphi$ and $\\tilde{\\varphi}$, are defined in a neighborhood of $p$ via the exponential map $\\exp_{p}: T_p M \\to M$. The coordinate systems are given by the inverse maps:\n$$ \\varphi^{-1}(x) = \\exp_{p}\\left(\\sum_{i=1}^{n} x^{i} e_{i}\\right) \\quad \\text{for } x=(x^1, \\dots, x^n) \\in \\mathbb{R}^n $$\n$$ \\tilde{\\varphi}^{-1}(y) = \\exp_{p}\\left(\\sum_{j=1}^{n} y^{j} \\tilde{e}_{j}\\right) \\quad \\text{for } y=(y^1, \\dots, y^n) \\in \\mathbb{R}^n $$\nBoth are defined for $x$ and $y$ in a small neighborhood of the origin $0 \\in \\mathbb{R}^n$. The transition map is $\\Phi = \\tilde{\\varphi} \\circ \\varphi^{-1}$, which maps a neighborhood of $0 \\in \\mathbb{R}^n$ to another.\n\nLet $q \\in M$ be a point near $p$. In the first coordinate system, $q = \\varphi^{-1}(x)$ for some $x \\in \\mathbb{R}^n$. In the second, $q = \\tilde{\\varphi}^{-1}(y)$ for some $y \\in \\mathbb{R}^n$. The transition map is given by $y = \\Phi(x)$. Thus, for any such point $q$, we have:\n$$ \\exp_{p}\\left(\\sum_{i=1}^{n} x^{i} e_{i}\\right) = \\exp_{p}\\left(\\sum_{j=1}^{n} y^{j} \\tilde{e}_{j}\\right) $$\nThe exponential map $\\exp_{p}$ is a local diffeomorphism from a neighborhood of the zero vector in $T_{p}M$ to a neighborhood of $p$ in $M$. This means that for sufficiently small tangent vectors, $\\exp_p$ is invertible. Let $U \\subseteq T_p M$ be a neighborhood of $0$ on which $\\exp_p$ is a diffeomorphism. Then for tangent vectors $\\sum x^i e_i \\in U$ and $\\sum y^j \\tilde{e}_j \\in U$, the above equality implies:\n$$ \\sum_{i=1}^{n} x^{i} e_{i} = \\sum_{j=1}^{n} y^{j} \\tilde{e}_{j} $$\nThis is an equality of vectors in the tangent space $T_{p}M$. The vector on the left has components $(x^1, \\dots, x^n)$ with respect to the basis $\\{e_i\\}$. The vector on the right has components $(y^1, \\dots, y^n)$ with respect to the basis $\\{\\tilde{e}_j\\}$.\n\nTo find the relationship between the components $y^j$ and $x^i$, we express the basis vectors $\\{e_i\\}$ in terms of the basis $\\{\\tilde{e}_j\\}$. Let $A$ be the change of basis matrix whose entries $A^j_i$ are defined by:\n$$ e_i = \\sum_{j=1}^{n} A^j_i \\tilde{e}_j $$\nSubstituting this into the vector equality:\n$$ \\sum_{i=1}^{n} x^{i} \\left( \\sum_{j=1}^{n} A^j_i \\tilde{e}_j \\right) = \\sum_{j=1}^{n} y^{j} \\tilde{e}_{j} $$\nBy rearranging the order of summation on the left-hand side, we get:\n$$ \\sum_{j=1}^{n} \\left( \\sum_{i=1}^{n} A^j_i x^i \\right) \\tilde{e}_j = \\sum_{j=1}^{n} y^{j} \\tilde{e}_{j} $$\nSince $\\{\\tilde{e}_j\\}$ is a basis for $T_pM$, the components must be equal. For each $j \\in \\{1, \\dots, n\\}$:\n$$ y^j = \\sum_{i=1}^{n} A^j_i x^i $$\nThis is the component form of the transition map $\\Phi$. In matrix notation, if $x$ and $y$ are column vectors, $y = Ax$.\nThe map $\\Phi: \\mathbb{R}^n \\to \\mathbb{R}^n$ is a linear transformation. The Jacobian matrix of a linear map $x \\mapsto Ax$ is the matrix $A$ itself, at every point in the domain. Therefore, the Jacobian at the origin is $D\\Phi_0 = A$.\n\nThe next step is to find an explicit expression for the entries $A^j_i$ in terms of the metric $g$ at $p$ and the two bases. Starting from the definition $e_i = \\sum_{k=1}^{n} A^k_i \\tilde{e}_k$, we take the inner product (using the metric $g$ at $p$, denoted $g_p$) with a basis vector $\\tilde{e}_j$:\n$$ g_p(e_i, \\tilde{e}_j) = g_p\\left(\\sum_{k=1}^{n} A^k_i \\tilde{e}_k, \\tilde{e}_j\\right) $$\nBy the bilinearity of the metric:\n$$ g_p(e_i, \\tilde{e}_j) = \\sum_{k=1}^{n} A^k_i g_p(\\tilde{e}_k, \\tilde{e}_j) $$\nLet's define the Gram matrix of the basis $\\{\\tilde{e}_j\\}$ as $\\tilde{G}$, with entries $(\\tilde{G})_{kj} = g_p(\\tilde{e}_k, \\tilde{e}_j)$. The equation can be written for a fixed $i$ as a system of linear equations for the coefficients $A^k_i$. Let $c_i$ be the $i$-th column of matrix $A$ (so $(c_i)_k = A^k_i$) and $b_i$ be a column vector with entries $(b_i)_j = g_p(e_i, \\tilde{e}_j)$. The equation system is $\\tilde{G}^T c_i = b_i$. Since the metric tensor is symmetric, $g_p(\\tilde{e}_k, \\tilde{e}_j) = g_p(\\tilde{e}_j, \\tilde{e}_k)$, the matrix $\\tilde{G}$ is symmetric, so $\\tilde{G}^T = \\tilde{G}$. Thus, $\\tilde{G} c_i = b_i$.\nSince $\\{\\tilde{e}_j\\}$ is a basis, $\\tilde{G}$ is invertible. Let $\\tilde{G}^{-1}$ be its inverse, with entries denoted $g^{jk}$. Solving for $c_i$: $c_i = \\tilde{G}^{-1} b_i$.\nIn terms of components, this is:\n$$ A^j_i = (c_i)_j = \\sum_{k=1}^{n} (\\tilde{G}^{-1})^{jk} (b_i)_k = \\sum_{k=1}^{n} g^{jk} g_p(e_i, \\tilde{e}_k) $$\nNote that the standard notational convention is that $(g^{jk})$ are the components of the inverse of the matrix with components $(g_{jk})$. Here, we have defined $g_{jk} = g_p(\\tilde{e}_j, \\tilde{e}_k)$. The $j$ index is the row index and $i$ is the column index for the Jacobian matrix $D\\Phi_0 = A$.\n\nThus, the Jacobian matrix $D\\Phi_0$ is the matrix $A$ whose entry in the $j$-th row and $i$-th column is given by $(A)^j_i = \\sum_{k=1}^{n} g^{jk} g_p(e_i, \\tilde{e}_k)$.\n\nNow, we consider the case where both bases $\\{e_i\\}$ and $\\{\\tilde{e}_j\\}$ are orthonormal with respect to $g_p$.\nThe orthonormality of $\\{\\tilde{e}_j\\}$ means $g_p(\\tilde{e}_j, \\tilde{e}_k) = \\delta_{jk}$. The Gram matrix $\\tilde{G}$ is the identity matrix $I_n$. Its inverse $\\tilde{G}^{-1}$ is also the identity matrix, so $g^{jk} = \\delta^{jk}$.\nSubstituting this into our expression for $A^j_i$:\n$$ A^j_i = \\sum_{k=1}^{n} \\delta^{jk} g_p(e_i, \\tilde{e}_k) = g_p(e_i, \\tilde{e}_j) $$\nTo show that the matrix $A=D\\Phi_0$ is in the orthogonal group $O(n)$, we must show that $A^T A = I_n$.\nThe entries of the transpose matrix $A^T$ are $(A^T)_{ij} = A^j_i = g_p(e_i, \\tilde{e}_j)$.\nLet's compute the entry in the $i$-th row and $k$-th column of the product $A^T A$:\n$$ (A^T A)_{ik} = \\sum_{j=1}^n (A^T)_{ij} A_{jk} $$\nNote that $A_{jk}$ is our notation for $A^j_k$. So, $A_{jk} = g_p(e_k, \\tilde{e}_j)$.\n$$ (A^T A)_{ik} = \\sum_{j=1}^n g_p(e_i, \\tilde{e}_j) g_p(e_k, \\tilde{e}_j) $$\nWe are given that the basis $\\{e_i\\}$ is also orthonormal, meaning $g_p(e_i, e_k) = \\delta_{ik}$. Let's expand the vector $e_i$ in the orthonormal basis $\\{\\tilde{e}_j\\}$. The Fourier coefficients are given by the inner products:\n$$ e_i = \\sum_{j=1}^n g_p(e_i, \\tilde{e}_j) \\tilde{e}_j $$\nNow we compute $g_p(e_i, e_k)$ using this expansion:\n$$ g_p(e_i, e_k) = g_p\\left( \\sum_{j=1}^n g_p(e_i, \\tilde{e}_j) \\tilde{e}_j, e_k \\right) $$\nUsing the linearity of $g_p$ in the first argument:\n$$ g_p(e_i, e_k) = \\sum_{j=1}^n g_p(e_i, \\tilde{e}_j) g_p(\\tilde{e}_j, e_k) $$\nBy the symmetry of the metric, $g_p(\\tilde{e}_j, e_k) = g_p(e_k, \\tilde{e}_j)$.\n$$ g_p(e_i, e_k) = \\sum_{j=1}^n g_p(e_i, \\tilde{e}_j) g_p(e_k, \\tilde{e}_j) $$\nThis is Parseval's identity for the vector $e_k$ with respect to the orthonormal basis $\\{\\tilde{e}_j\\}$, applied to the inner product with $e_i$.\nComparing this result with our expression for $(A^T A)_{ik}$, we see they are identical. Since $\\{e_i\\}$ is an orthonormal basis, $g_p(e_i, e_k) = \\delta_{ik}$.\nTherefore, $(A^T A)_{ik} = \\delta_{ik}$. This means $A^T A = I_n$, which proves that $A = D\\Phi_0$ is an orthogonal matrix.\n\nThe question asks for the single closed-form expression for the Jacobian matrix $D\\Phi_0$ in the general case. This is the matrix $A$ defined by its components $A^j_i$.", "answer": "$$ \\boxed{ \\left(D\\Phi_0\\right)^j_i = \\sum_{k=1}^n g^{jk} g_p(e_i, \\tilde{e}_k) } $$", "id": "3068966"}]}