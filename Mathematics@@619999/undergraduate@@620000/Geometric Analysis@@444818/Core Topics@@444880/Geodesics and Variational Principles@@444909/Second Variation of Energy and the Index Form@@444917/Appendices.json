{"hands_on_practices": [{"introduction": "To appreciate the role of curvature in shaping geometry, it is essential to first understand the baseline case where curvature is absent. This exercise explores Jacobi fields along geodesics in Euclidean space $\\mathbb{R}^n$ [@problem_id:3061442]. By deriving and solving the simplified Jacobi equation in this flat setting, you will directly verify the fundamental principle that straight lines in Euclidean space do not refocus, meaning there are no conjugate points.", "problem": "Let $\\mathbb{R}^{n}$ be equipped with its standard Euclidean metric. Consider a unit-speed geodesic $\\gamma:[0,1]\\to\\mathbb{R}^{n}$ with $\\gamma(t)=x_{0}+tv$, where $x_{0}\\in\\mathbb{R}^{n}$ and $v\\in\\mathbb{R}^{n}$ with $\\|v\\|=1$. A vector field $J$ along $\\gamma$ is called a Jacobi field if it arises as the variational vector field of a smooth variation through geodesics of $\\gamma$. Using only the fundamental definitions that in Euclidean space the Levi-Civita connection is the standard directional derivative and the Riemann curvature tensor vanishes, derive the Jacobi equation along $\\gamma$, solve it in full generality, and then impose the boundary conditions $J(0)=0$ and $J(1)=0$. Use these results to justify the absence of conjugate points to $\\gamma(0)$ along $\\gamma$ on $(0,1]$ by the characterization of conjugate points in terms of nontrivial Jacobi fields with two zeros. Finally, report the dimension of the $\\mathbb{R}$-vector space of Jacobi fields along $\\gamma$ that satisfy $J(0)=0$ and $J(1)=0$. Your final answer must be this single number.", "solution": "The problem is first subjected to validation.\n\n### Step 1: Extract Givens\n-   The space is $\\mathbb{R}^{n}$ with its standard Euclidean metric.\n-   The curve is a unit-speed geodesic $\\gamma:[0,1]\\to\\mathbb{R}^{n}$ given by $\\gamma(t)=x_{0}+tv$, where $x_{0}\\in\\mathbb{R}^{n}$ and $v\\in\\mathbb{R}^{n}$ with $\\|v\\|=1$.\n-   The Levi-Civita connection $\\nabla$ is the standard directional derivative.\n-   The Riemann curvature tensor $R$ is zero, i.e., $R=0$.\n-   A Jacobi field $J$ along $\\gamma$ is defined as the variational vector field of a smooth variation of $\\gamma$ through geodesics.\n-   Boundary conditions to be imposed are $J(0)=0$ and $J(1)=0$.\n-   The tasks are:\n    1.  Derive the Jacobi equation along $\\gamma$.\n    2.  Solve the equation in full generality.\n    3.  Impose the given boundary conditions.\n    4.  Use the result to justify the absence of conjugate points to $\\gamma(0)$ along $\\gamma$ on the interval $(0,1]$.\n    5.  Report the dimension of the $\\mathbb{R}$-vector space of Jacobi fields along $\\gamma$ satisfying $J(0)=0$ and $J(1)=0$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it deals with fundamental concepts of Riemannian geometry (geodesics, Jacobi fields, curvature) in the well-understood context of Euclidean space. The given information is standard and factually correct (e.g., the flatness of $\\mathbb{R}^n$). The problem is well-posed, with a clear sequence of tasks leading to a unique and meaningful numerical answer. The language is objective and precise. The problem is self-contained and internally consistent. It is a canonical example within the topic of the second variation of energy and the index form, for which Jacobi fields are the central object of study. Therefore, the problem is deemed valid.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Solution Derivation\n\nThe analysis proceeds by deriving and solving the Jacobi equation under the specified conditions.\n\n1.  **Derivation of the Jacobi Equation**\n    The general form of the Jacobi equation for a vector field $J(t)$ along a geodesic $\\gamma(t)$ is\n    $$\n    \\nabla_t^2 J(t) + R(J(t), \\dot{\\gamma}(t))\\dot{\\gamma}(t) = 0\n    $$\n    where $\\nabla_t$ denotes the covariant derivative along $\\gamma$ (i.e., $\\nabla_{\\dot{\\gamma}}$), and $R$ is the Riemann curvature tensor.\n\n    In $\\mathbb{R}^n$ equipped with the standard Euclidean metric, the geometric structures simplify considerably.\n    First, the problem states that the Riemann curvature tensor is zero. This is a fundamental property of flat spaces like $\\mathbb{R}^n$. Consequently, the curvature term in the Jacobi equation vanishes:\n    $$\n    R(J(t), \\dot{\\gamma}(t))\\dot{\\gamma}(t) = 0\n    $$\n    Second, the Levi-Civita connection $\\nabla$ in Euclidean space is simply the standard directional derivative of vector fields. For a vector field $J(t)$ defined along a curve $\\gamma(t)$, the covariant derivative $\\nabla_t J(t)$ is the ordinary component-wise derivative of $J$ with respect to the parameter $t$.\n    $$\n    \\nabla_t J(t) = J'(t) = \\frac{dJ(t)}{dt}\n    $$\n    The second covariant derivative is therefore the second ordinary derivative:\n    $$\n    \\nabla_t^2 J(t) = \\nabla_t (\\nabla_t J(t)) = \\nabla_t (J'(t)) = J''(t) = \\frac{d^2J(t)}{dt^2}\n    $$\n    Substituting these simplifications into the general Jacobi equation, we obtain the specific form for Euclidean space:\n    $$\n    J''(t) + 0 = 0 \\quad \\implies \\quad J''(t) = 0\n    $$\n\n2.  **General Solution of the Jacobi Equation**\n    We need to solve the second-order vector ordinary differential equation $J''(t) = 0$, where $J(t)$ is a vector-valued function in $\\mathbb{R}^n$. We can integrate this equation twice with respect to $t$.\n    Integrating once gives:\n    $$\n    J'(t) = A\n    $$\n    where $A$ is a constant vector in $\\mathbb{R}^n$.\n    Integrating a second time gives:\n    $$\n    J(t) = At + B\n    $$\n    where $B$ is another constant vector in $\\mathbb{R}^n$. Thus, any Jacobi field along a geodesic in $\\mathbb{R}^n$ must be a linear function of the parameter $t$. The vectors $A$ and $B$ are determined by initial conditions. Any such linear field is a Jacobi field, which can be seen by considering the variation of geodesics $c_s(t) = \\gamma(t) + s(At+B)$.\n\n3.  **Imposition of Boundary Conditions**\n    The problem asks for Jacobi fields that satisfy the boundary conditions $J(0)=0$ and $J(1)=0$. We apply these to the general solution $J(t) = At + B$.\n    Applying the first condition, $J(0)=0$:\n    $$\n    J(0) = A \\cdot 0 + B = B\n    $$\n    So, we must have $B=0$. The Jacobi field is now of the form $J(t) = At$.\n    Applying the second condition, $J(1)=0$:\n    $$\n    J(1) = A \\cdot 1 = A\n    $$\n    So, we must have $A=0$.\n    Since both constant vectors $A$ and $B$ must be the zero vector, the only Jacobi field that satisfies $J(0)=0$ and $J(1)=0$ is the trivial Jacobi field, $J(t) = 0$ for all $t \\in [0,1]$.\n\n4.  **Absence of Conjugate Points**\n    A point $\\gamma(t_1)$ for $t_10$ is defined as being conjugate to $\\gamma(0)$ along the geodesic $\\gamma$ if there exists a non-trivial Jacobi field $J(t)$ (i.e., $J(t)$ is not identically zero) along $\\gamma$ such that $J(0)=0$ and $J(t_1)=0$.\n    Let's check this condition for any $t_1 \\in (0,1]$. We require a non-trivial solution to $J(t)=At+B$ with $J(0)=0$ and $J(t_1)=0$.\n    The condition $J(0)=0$ implies $B=0$, so $J(t)=At$.\n    The condition $J(t_1)=0$ implies $At_1=0$. Since $t_1  0$, we can divide by $t_1$ to find $A=0$.\n    Thus, $A=0$ and $B=0$, which means $J(t)=0$ for all $t$. This is the trivial Jacobi field.\n    Since no non-trivial Jacobi field exists that vanishes at both $t=0$ and $t=t_1$ for any $t_10$, we conclude that there are no points conjugate to $\\gamma(0)$ along $\\gamma$. This is a characteristic feature of flat manifolds.\n\n5.  **Dimension of the Solution Space**\n    The final task is to determine the dimension of the $\\mathbb{R}$-vector space of Jacobi fields along $\\gamma$ that satisfy $J(0)=0$ and $J(1)=0$. As demonstrated in part 3, the only solution under these boundary conditions is the zero vector field, $J(t)=0$ for all $t \\in [0,1]$.\n    The set of all such solutions is $\\{0\\}$, the trivial vector space containing only the zero element.\n    By definition, the dimension of the trivial vector space $\\{0\\}$ is $0$.", "answer": "$$\\boxed{0}$$", "id": "3061442"}, {"introduction": "Having established the behavior of geodesics in flat space, we now introduce curvature and examine its consequences. This practice invites you to compute the second variation of length for a geodesic on the unit sphere $S^2$, a classic example of a space with constant positive curvature [@problem_id:3061460]. This calculation will make the abstract index form concrete, demonstrating how positive curvature tends to make nearby geodesics converge and can lead to instability for paths that are sufficiently long.", "problem": "Let $S^{2}$ denote the unit $2$-sphere equipped with its standard round Riemannian metric of constant Gaussian curvature $K=1$. Consider a unit-speed great circle geodesic $\\gamma:[0,L]\\to S^{2}$ with fixed endpoints, and a smooth variation $\\alpha(t,s)$ through curves with fixed endpoints, so that the associated variation vector field along $\\gamma$ is $V(s)=\\left.\\partial_{t}\\alpha(t,s)\\right|_{t=0}$. Assume the variation is normal, meaning $V(s)$ is everywhere orthogonal to the unit tangent $T(s)=\\gamma'(s)$, and $V(0)=V(L)=0$. Let $N(s)$ be the unit normal field along $\\gamma$ obtained by parallel transport of a unit vector orthogonal to $T(0)$, so that $D_{s}N(s)=0$, where $D_{s}$ denotes the covariant derivative along $\\gamma$. Define the normal variation by $V(s)=f(s)\\,N(s)$ with $f(s)=\\sin\\!\\left(\\frac{\\pi s}{L}\\right)$.\n\nStarting from the definition of the length functional $L(t)=\\int_{0}^{L}\\left|\\partial_{s}\\alpha(t,s)\\right|\\,ds$, the vanishing of the first variation for fixed endpoints, and the curvature identity on a $2$-dimensional Riemannian manifold that relates the Riemann Curvature Tensor to the Gaussian curvature, derive the second variation of length at $t=0$ in terms of an integral involving $f$, $f'$, and $K$. Then, using $K=1$ on $S^{2}$ and the given $f$, compute the exact value of the second variation of length $\\delta^{2}L(0)$ as a closed-form expression in the parameter $L$.\n\nYour final answer must be a single analytic expression in $L$. No numerical approximation is required, and no units are to be provided.", "solution": "The problem asks for the derivation and computation of the second variation of length for a specific variation of a great circle geodesic on the unit $2$-sphere, $S^2$.\n\nLet $\\alpha(t,s)$ be a smooth variation of a unit-speed geodesic $\\gamma(s) = \\alpha(0,s)$ for $s \\in [0,L]$. The variation has fixed endpoints, $\\alpha(t,0)=\\gamma(0)$ and $\\alpha(t,L)=\\gamma(L)$. The length of the curve $\\alpha_t(s) = \\alpha(t,s)$ is given by the functional\n$$L(t) = \\int_{0}^{L} |\\partial_s \\alpha(t,s)| \\, ds = \\int_{0}^{L} \\sqrt{g(\\partial_s \\alpha, \\partial_s \\alpha)} \\, ds$$\nwhere $g$ is the Riemannian metric tensor.\n\nThe first variation of length is the derivative of $L(t)$ with respect to $t$. Let $V = \\partial_t \\alpha$ be the variation vector field and $T_\\alpha = \\partial_s \\alpha$ be the tangent vector field to the curves $\\alpha_t$.\n$$L'(t) = \\frac{d}{dt} \\int_{0}^{L} \\sqrt{g(T_\\alpha, T_\\alpha)} \\, ds = \\int_{0}^{L} \\frac{g(\\nabla_{\\partial_t} T_\\alpha, T_\\alpha)}{\\sqrt{g(T_\\alpha, T_\\alpha)}} \\, ds$$\nUsing the symmetry of the connection ($\\nabla_{\\partial_t} \\partial_s \\alpha = \\nabla_{\\partial_s} \\partial_t \\alpha$), we have $\\nabla_{\\partial_t} T_\\alpha = \\nabla_{\\partial_s} V$.\nAt $t=0$, we have $\\alpha(0,s) = \\gamma(s)$. Since $\\gamma$ is a unit-speed geodesic, its tangent vector $T = \\gamma'$ has unit length, $|T|=1$, and its covariant derivative along $\\gamma$ is zero, $D_s T = \\nabla_{\\partial_s} T = 0$.\nEvaluating $L'(t)$ at $t=0$, with $V(s) = \\partial_t \\alpha(0,s)$ and $|T|=1$:\n$$L'(0) = \\int_{0}^{L} g(D_s V, T) \\, ds$$\nIntegrating by parts gives:\n$$L'(0) = [g(V,T)]_0^L - \\int_{0}^{L} g(V, D_s T) \\, ds$$\nSince the endpoints are fixed, $V(0)=0$ and $V(L)=0$. As $\\gamma$ is a geodesic, $D_s T = 0$. Thus, $L'(0) = 0$, confirming that a geodesic is a critical point of the length functional.\n\nThe second variation of length is $L''(0)$. We differentiate $L'(t)$ and evaluate at $t=0$:\n$$L''(t) = \\frac{d}{dt} \\int_{0}^{L} \\frac{g(\\nabla_{\\partial_s} V, T_\\alpha)}{|T_\\alpha|} \\, ds$$\nEvaluating at $t=0$ where $|T_\\alpha|=1$ requires careful application of the product and chain rules. The standard result for the second variation of length for a variation field $V$ along a geodesic $\\gamma$ is given by the index form:\n$$L''(0) = \\int_{0}^{L} \\left( |D_s V|^2 - g(R(T,V)V, T) - (g(D_s V, T))^2 \\right) ds$$\nwhere $R$ is the Riemann curvature tensor.\n\nThe problem specifies a normal variation, meaning $V(s)$ is everywhere orthogonal to the tangent vector $T(s)$, so $g(V,T)=0$. Differentiating this orthogonality condition along $\\gamma$ yields:\n$$0 = D_s(g(V,T)) = g(D_s V, T) + g(V, D_s T)$$\nSince $D_s T=0$ for a geodesic, we must have $g(D_s V, T)=0$. This implies that the term $(g(D_s V, T))^2$ in the second variation formula is zero. The formula simplifies for a normal variation to:\n$$L''(0) = \\int_{0}^{L} \\left( |D_s V|^2 - g(R(T,V)V, T) \\right) ds$$\n\nFor a $2$-dimensional Riemannian manifold, the Riemann curvature tensor is completely determined by the Gaussian curvature $K$ via the identity:\n$$R(X,Y)Z = K(g(Y,Z)X - g(X,Z)Y)$$\nApplying this to our integrand:\n$$g(R(T,V)V,T) = g(K(g(V,V)T - g(T,V)V), T)$$\nUsing the bilinearity of $g$ and the facts that $g(V,T)=0$ and $g(T,T)=|T|^2=1$:\n$$g(R(T,V)V,T) = K \\left( g(V,V) g(T,T) - g(T,V) g(V,T) \\right) = K(|V|^2 \\cdot 1 - 0 \\cdot 0) = K|V|^2$$\nSubstituting this back into the formula for $L''(0)$, we obtain the second variation for a normal variation on a surface:\n$$L''(0) = \\int_{0}^{L} \\left( |D_s V|^2 - K|V|^2 \\right) ds$$\n\nThe problem defines the specific normal variation $V(s) = f(s)N(s)$, where $f(s)=\\sin\\!\\left(\\frac{\\pi s}{L}\\right)$ and $N(s)$ is a parallel unit normal field along $\\gamma$, i.e., $|N(s)|=1$, $g(N,T)=0$, and $D_s N=0$.\nWe compute the terms in the integrand:\n$|V|^2 = g(f(s)N(s), f(s)N(s)) = (f(s))^2 g(N,N) = (f(s))^2 |N|^2 = (f(s))^2$.\n$D_s V = D_s(f(s)N(s)) = (D_s f)N + f(s)D_s N$. Since $f$ is a scalar function, its covariant derivative is its ordinary derivative, $D_s f = f'(s)$. As $D_s N=0$, we have:\n$D_s V = f'(s)N(s)$.\n$|D_s V|^2 = g(f'(s)N(s), f'(s)N(s)) = (f'(s))^2 g(N,N) = (f'(s))^2$.\n\nSubstituting these expressions into the formula for $L''(0)$ gives the desired integral in terms of $f$, $f'$, and $K$:\n$$L''(0) = \\int_{0}^{L} \\left( (f'(s))^2 - K(f(s))^2 \\right) ds$$\n\nNow, we compute the value for the given $f(s)$ and $K=1$ on the sphere $S^2$.\nWe have $f(s) = \\sin\\!\\left(\\frac{\\pi s}{L}\\right)$, so $f'(s) = \\frac{\\pi}{L}\\cos\\!\\left(\\frac{\\pi s}{L}\\right)$.\nThe second variation, denoted $\\delta^2 L(0)$, is:\n$$\\delta^2 L(0) = \\int_{0}^{L} \\left( \\left(\\frac{\\pi}{L}\\cos\\!\\left(\\frac{\\pi s}{L}\\right)\\right)^2 - (1) \\cdot \\left(\\sin\\!\\left(\\frac{\\pi s}{L}\\right)\\right)^2 \\right) ds$$\n$$\\delta^2 L(0) = \\frac{\\pi^2}{L^2} \\int_{0}^{L} \\cos^2\\!\\left(\\frac{\\pi s}{L}\\right) ds - \\int_{0}^{L} \\sin^2\\!\\left(\\frac{\\pi s}{L}\\right) ds$$\nWe use the standard trigonometric identities $\\cos^2(\\theta) = \\frac{1+\\cos(2\\theta)}{2}$ and $\\sin^2(\\theta) = \\frac{1-\\cos(2\\theta)}{2}$.\n\nFor the first integral:\n$$ \\int_{0}^{L} \\cos^2\\!\\left(\\frac{\\pi s}{L}\\right) ds = \\int_{0}^{L} \\frac{1}{2}\\left(1 + \\cos\\!\\left(\\frac{2\\pi s}{L}\\right)\\right) ds = \\frac{1}{2}\\left[s + \\frac{L}{2\\pi}\\sin\\!\\left(\\frac{2\\pi s}{L}\\right)\\right]_0^L = \\frac{1}{2}(L+0 - (0+0)) = \\frac{L}{2} $$\nFor the second integral:\n$$ \\int_{0}^{L} \\sin^2\\!\\left(\\frac{\\pi s}{L}\\right) ds = \\int_{0}^{L} \\frac{1}{2}\\left(1 - \\cos\\!\\left(\\frac{2\\pi s}{L}\\right)\\right) ds = \\frac{1}{2}\\left[s - \\frac{L}{2\\pi}\\sin\\!\\left(\\frac{2\\pi s}{L}\\right)\\right]_0^L = \\frac{1}{2}(L-0 - (0-0)) = \\frac{L}{2} $$\nSubstituting these results back into the expression for $\\delta^2 L(0)$:\n$$\\delta^2 L(0) = \\frac{\\pi^2}{L^2}\\left(\\frac{L}{2}\\right) - \\frac{L}{2} = \\frac{\\pi^2}{2L} - \\frac{L}{2} = \\frac{\\pi^2 - L^2}{2L}$$\nThis is the final closed-form expression for the second variation of length.", "answer": "$$\\boxed{\\frac{\\pi^2 - L^2}{2L}}$$", "id": "3061460"}, {"introduction": "Analytical computations, while powerful, are often limited to highly symmetric spaces. This final practice bridges theory and computation by guiding you to implement a numerical method to approximate the index form [@problem_id:3061431]. By discretizing the problem, you will build a tool to analyze the stability of geodesics for more complex curvature profiles, developing an essential skill for modern geometric analysis and its applications.", "problem": "Let $(M,g)$ be a smooth Riemannian manifold and let $\\gamma:[0,L]\\to M$ be a unit-speed geodesic with fixed endpoints, so $\\gamma(0)$ and $\\gamma(L)$ are fixed. Consider a variation $\\gamma_s$ with variation vector field $V$ along $\\gamma$, normal to $\\gamma'$, and assume $V(0)=V(L)=0$. Start from the definition of the energy $E(\\gamma)=\\tfrac{1}{2}\\int_0^L \\langle \\gamma'(t),\\gamma'(t)\\rangle\\,dt$ and the fact that a geodesic is a critical point of $E$ under fixed endpoints, together with the general expression of the second variation of the energy, and derive the quadratic form (called the index form) that the second variation induces on normal variation fields. In dimension two, choose a parallel unit normal field $N$ along $\\gamma$ (so that $\\nabla_{\\gamma'} N=0$), represent any normal variation as $V(t)=f(t) N(t)$ with scalar amplitude $f:[0,L]\\to \\mathbb{R}$ satisfying $f(0)=f(L)=0$, and express the index form as a one-dimensional quadratic functional of $f$ and the sectional curvature $K(t)$ of the plane spanned by $\\gamma'(t)$ and $N(t)$ along $\\gamma$.\n\nThen, implement a numerical method to approximate this quadratic functional using finite differences on a uniform grid. Let $t_i=i h$ for $i=0,\\dots,N$ with $h=L/N$, and discretize the Dirichlet boundary condition $f(0)=f(L)=0$. Use a consistent discrete approximation in which the term involving the derivative of $f$ is approximated by a discrete Dirichlet energy and the curvature term is approximated by a composite trapezoidal rule. Your program must compute this numerical approximation for the test suite below and compare each case against an analytical value obtained by explicitly integrating the corresponding scalar expressions.\n\nYour implementation must follow these specifications:\n- Use a uniform grid with $N=20000$ subintervals on $[0,L]$ for all test cases.\n- For the derivative term, approximate $\\int_0^L (f'(t))^2\\,dt$ by $\\sum_{i=0}^{N-1} \\frac{(f_{i+1}-f_i)^2}{h}$ where $f_i=f(t_i)$.\n- For the curvature term, approximate $\\int_0^L K(t)\\,f(t)^2\\,dt$ by $h\\sum_{i=0}^N w_i\\,K(t_i)\\,f(t_i)^2$ with trapezoidal weights $w_0=w_N=\\tfrac{1}{2}$ and $w_i=1$ for $1\\le i\\le N-1$.\n\nTest suite. In all cases use $L=1$ and the indicated functions $f$ and $K$:\n- Case A (baseline, zero curvature): $f(t)=\\sin(\\pi t)$, $K(t)=0$. Compute the numerical value and compare with the analytical value obtained by integrating the corresponding scalar expression exactly.\n- Case B (constant positive curvature): $f(t)=\\sin(\\pi t)$, $K(t)=1$.\n- Case C (oscillatory curvature): $f(t)=\\sin(\\pi t)$, $K(t)=k_0+k_1\\cos(2\\pi t)$ with $k_0=0.5$ and $k_1=0.2$.\n- Case D (negative curvature and higher mode): $f(t)=\\sin(2\\pi t)$, $K(t)=-1$.\n\nFor each case, compute:\n- The numerical value using the finite-difference method described above.\n- An analytical value by evaluating the relevant integrals exactly in closed form.\n\nYour program must output a single line containing the absolute errors between the numerical and analytical values for the four cases, as a comma-separated list enclosed in square brackets, in the order [Case A error, Case B error, Case C error, Case D error]. The outputs are dimensionless real numbers. No angles, physical units, or percentages are involved.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[eA,eB,eC,eD]\").", "solution": "The problem asks for two main tasks. First, to derive the index form for a geodesic, specializing to a two-dimensional manifold. Second, to implement a specific numerical method to approximate this form for a given set of test cases and compare the results with their exact analytical values.\n\nThe problem is validated as scientifically sound, well-posed, and an unambiguous exercise in Riemannian geometry and numerical analysis. We may proceed with the solution.\n\n### Part 1: Derivation of the Index Form\n\nLet $(M,g)$ be a Riemannian manifold. The energy of a smooth curve $\\alpha:[a,b] \\to M$ is given by the functional:\n$$\nE(\\alpha) = \\frac{1}{2}\\int_a^b \\langle \\alpha'(t), \\alpha'(t) \\rangle_g \\, dt\n$$\nwhere $\\langle \\cdot, \\cdot \\rangle_g$ is the Riemannian metric and $\\alpha'(t)$ is the tangent vector to the curve.\n\nConsider a unit-speed geodesic $\\gamma:[0,L] \\to M$. Let $\\gamma_s(t)$ be a smooth one-parameter variation of $\\gamma$, where $s \\in (-\\epsilon, \\epsilon)$ and for each $s$, $\\gamma_s$ is a curve from $\\gamma(0)$ to $\\gamma(L)$. This means $\\gamma_0(t) = \\gamma(t)$, and the endpoints are fixed, so $\\gamma_s(0)=\\gamma(0)$ and $\\gamma_s(L)=\\gamma(L)$ for all $s$. The variation vector field is defined along $\\gamma$ as $V(t) = \\frac{\\partial \\gamma_s}{\\partial s}\\big|_{s=0}$. The fixed endpoint condition implies $V(0) = 0$ and $V(L) = 0$.\n\nThe first variation of energy is the derivative of $E(\\gamma_s)$ with respect to $s$ at $s=0$:\n$$\n\\frac{d}{ds} E(\\gamma_s) \\bigg|_{s=0} = \\frac{d}{ds} \\left( \\frac{1}{2}\\int_0^L \\langle \\frac{\\partial \\gamma_s}{\\partial t}, \\frac{\\partial \\gamma_s}{\\partial t} \\rangle \\, dt \\right) \\bigg|_{s=0}\n$$\nCarrying out the differentiation and using the symmetry of the connection, we get:\n$$\n\\frac{d}{ds} E(\\gamma_s) \\bigg|_{s=0} = \\int_0^L \\langle \\nabla_s \\frac{\\partial \\gamma_s}{\\partial t}, \\frac{\\partial \\gamma_s}{\\partial t} \\rangle \\bigg|_{s=0} \\, dt = \\int_0^L \\langle \\nabla_t V, \\gamma' \\rangle \\, dt\n$$\nIntegrating by parts and using $V(0)=V(L)=0$, this becomes:\n$$\n\\int_0^L \\langle \\nabla_t V, \\gamma' \\rangle \\, dt = \\left[ \\langle V, \\gamma' \\rangle \\right]_0^L - \\int_0^L \\langle V, \\nabla_t \\gamma' \\rangle \\, dt = - \\int_0^L \\langle V, \\nabla_{\\gamma'} \\gamma' \\rangle \\, dt\n$$\nSince $\\gamma$ is a geodesic, its acceleration is zero: $\\nabla_{\\gamma'} \\gamma' = 0$. Thus, the first variation of energy is zero, confirming that geodesics are critical points of the energy functional.\n\nThe second variation of energy, also known as the index form $I(V,V)$, is the second derivative of $E(\\gamma_s)$ at $s=0$. The general formula for the second variation along a geodesic $\\gamma$ for a variation field $V$ is:\n$$\nI(V,V) = \\frac{d^2}{ds^2} E(\\gamma_s) \\bigg|_{s=0} = \\int_0^L \\left( \\langle \\nabla_{\\gamma'} V, \\nabla_{\\gamma'} V \\rangle - \\langle R(V, \\gamma')\\gamma', V \\rangle \\right) dt\n$$\nwhere $\\nabla_{\\gamma'}$ is the covariant derivative along $\\gamma$, and $R(X,Y)Z = \\nabla_X \\nabla_Y Z - \\nabla_Y \\nabla_X Z - \\nabla_{[X,Y]} Z$ is the Riemann curvature tensor. This formula is valid for any variation field $V$ with $V(0)=V(L)=0$. As stipulated, we consider only variation fields $V$ that are normal to the geodesic, i.e., $\\langle V(t), \\gamma'(t) \\rangle = 0$ for all $t$.\n\n### Part 2: Specialization to a 2-Dimensional Manifold\n\nIn a 2-dimensional manifold, for any point on $\\gamma$, the tangent space $T_{\\gamma(t)}M$ is 2-dimensional. The tangent vector $\\gamma'(t)$ spans a 1-dimensional subspace. Since $\\gamma$ is unit-speed, $\\{\\gamma'(t)\\}$ can be extended to an orthonormal basis of $T_{\\gamma(t)}M$. The orthogonal complement to $\\gamma'(t)$ is a 1-dimensional subspace.\n\nWe can choose a unit vector field $N(t)$ along $\\gamma$ such that $\\langle N(t), N(t) \\rangle = 1$, $\\langle N(t), \\gamma'(t) \\rangle = 0$, and $N(t)$ is parallel-transported along $\\gamma$. The condition of parallel transport means $\\nabla_{\\gamma'} N = 0$.\n\nAny normal vector field $V(t)$ can be written as $V(t) = f(t)N(t)$ for some scalar function $f: [0,L] \\to \\mathbb{R}$. The boundary conditions $V(0)=V(L)=0$ imply $f(0)=f(L)=0$.\n\nLet's substitute $V(t) = f(t)N(t)$ into the index form $I(V,V)$:\n1.  **First term:** $\\langle \\nabla_{\\gamma'} V, \\nabla_{\\gamma'} V \\rangle$.\n    Using the product rule for covariant derivatives:\n    $$\n    \\nabla_{\\gamma'} V = \\nabla_{\\gamma'} (f(t)N(t)) = \\frac{df}{dt} N(t) + f(t) \\nabla_{\\gamma'} N(t)\n    $$\n    Since $N$ is parallel along $\\gamma$, $\\nabla_{\\gamma'} N = 0$. So, $\\nabla_{\\gamma'} V = f'(t)N(t)$.\n    The first term in the integrand becomes:\n    $$\n    \\langle \\nabla_{\\gamma'} V, \\nabla_{\\gamma'} V \\rangle = \\langle f'(t)N(t), f'(t)N(t) \\rangle = (f'(t))^2 \\langle N(t), N(t) \\rangle = (f'(t))^2\n    $$\n2.  **Second term:** $-\\langle R(V, \\gamma')\\gamma', V \\rangle$.\n    Substituting $V(t) = f(t)N(t)$:\n    $$\n    -\\langle R(f(t)N(t), \\gamma'(t))\\gamma'(t), f(t)N(t) \\rangle = -f(t)^2 \\langle R(N(t), \\gamma'(t))\\gamma'(t), N(t) \\rangle\n    $$\n    The sectional curvature $K(P)$ of a 2-plane $P$ spanned by orthonormal vectors $X, Y$ is defined as $K(P) = \\langle R(X,Y)Y, X \\rangle$. Along our geodesic, $\\{\\gamma'(t), N(t)\\}$ is an orthonormal basis for the tangent plane at each point. Let $K(t)$ be the sectional curvature of the plane spanned by $\\gamma'(t)$ and $N(t)$. By definition and symmetries of the curvature tensor:\n    $$\n    K(t) = K(\\gamma'(t), N(t)) = \\langle R(\\gamma'(t), N(t))N(t), \\gamma'(t) \\rangle = \\langle R(N(t), \\gamma'(t))\\gamma'(t), N(t) \\rangle\n    $$\n    Thus, the second term in the integrand is $-f(t)^2 K(t)$.\n\nCombining both terms, the index form for the variation $V=fN$ is a quadratic functional of the scalar function $f$:\n$$\nI(f) = \\int_0^L \\left( (f'(t))^2 - K(t) f(t)^2 \\right) dt\n$$\nThis is the required one-dimensional quadratic functional.\n\n### Part 3: Numerical Approximation\n\nWe are asked to approximate the functional $I(f)$ using a specific finite difference scheme on a uniform grid $t_i = i h$ for $i=0, \\dots, N$, with step size $h=L/N$. The function values on the grid are $f_i = f(t_i)$. The boundary conditions are $f(0)=f_0=0$ and $f(L)=f_N=0$.\n\nThe functional consists of two parts:\n1.  **Derivative term:** $I_1 = \\int_0^L (f'(t))^2 \\, dt$. This is approximated by the discrete Dirichlet energy:\n    $$\n    \\int_0^L (f'(t))^2 \\, dt \\approx \\sum_{i=0}^{N-1} \\frac{(f_{i+1}-f_i)^2}{h}\n    $$\n    This formula arises from approximating $f'(t)$ on each subinterval $[t_i, t_{i+1}]$ by the forward difference $\\frac{f_{i+1}-f_i}{h}$, assuming it's constant, and integrating its square over the interval of length $h$.\n2.  **Curvature term:** $I_2 = \\int_0^L K(t)f(t)^2 \\, dt$. This is approximated using the composite trapezoidal rule:\n    $$\n    \\int_0^L g(t) \\, dt \\approx h \\left( \\frac{1}{2}g(t_0) + \\sum_{i=1}^{N-1} g(t_i) + \\frac{1}{2}g(t_N) \\right)\n    $$\n    Letting $g(t) = K(t)f(t)^2$, the approximation is:\n    $$\n    \\int_0^L K(t)f(t)^2 \\, dt \\approx h \\sum_{i=0}^N w_i K(t_i) f(t_i)^2\n    $$\n    where the weights are $w_0 = w_N = 1/2$ and $w_i=1$ for $i=1, \\dots, N-1$.\n\nThe full numerical approximation of the index form is $I_{\\text{numeric}} = I_1 - I_2$.\n\n### Part 4: Analytical Solutions for Test Cases\n\nWe are given $L=1$. The analytical value is $I_{\\text{analytic}} = \\int_0^1 ((f'(t))^2 - K(t)f(t)^2) dt$.\n\n- **Case A:** $f(t)=\\sin(\\pi t)$, $K(t)=0$.\n  $f'(t) = \\pi \\cos(\\pi t)$.\n  $I_A = \\int_0^1 (\\pi \\cos(\\pi t))^2 \\, dt = \\pi^2 \\int_0^1 \\cos^2(\\pi t) \\, dt = \\pi^2 \\int_0^1 \\frac{1+\\cos(2\\pi t)}{2} \\, dt = \\frac{\\pi^2}{2} \\left[t + \\frac{\\sin(2\\pi t)}{2\\pi}\\right]_0^1 = \\frac{\\pi^2}{2}$.\n\n- **Case B:** $f(t)=\\sin(\\pi t)$, $K(t)=1$.\n  $I_B = \\int_0^1 \\left( (\\pi \\cos(\\pi t))^2 - (1) \\sin^2(\\pi t) \\right) dt$.\n  We know $\\int_0^1 \\pi^2 \\cos^2(\\pi t) \\, dt = \\frac{\\pi^2}{2}$.\n  $\\int_0^1 \\sin^2(\\pi t) \\, dt = \\int_0^1 \\frac{1-\\cos(2\\pi t)}{2} \\, dt = \\frac{1}{2} \\left[t - \\frac{\\sin(2\\pi t)}{2\\pi}\\right]_0^1 = \\frac{1}{2}$.\n  $I_B = \\frac{\\pi^2}{2} - \\frac{1}{2} = \\frac{\\pi^2 - 1}{2}$.\n\n- **Case C:** $f(t)=\\sin(\\pi t)$, $K(t)=k_0+k_1\\cos(2\\pi t)$ with $k_0=0.5, k_1=0.2$.\n  $I_C = \\int_0^1 (\\pi \\cos(\\pi t))^2 \\, dt - \\int_0^1 (k_0+k_1\\cos(2\\pi t))\\sin^2(\\pi t) \\, dt$.\n  The second integral is $k_0 \\int_0^1 \\sin^2(\\pi t) \\, dt + k_1 \\int_0^1 \\cos(2\\pi t)\\sin^2(\\pi t) \\, dt$.\n  The first part is $k_0(\\frac{1}{2})$. For the second, using $\\sin^2(\\pi t) = \\frac{1-\\cos(2\\pi t)}{2}$:\n  $k_1 \\int_0^1 \\cos(2\\pi t) \\frac{1-\\cos(2\\pi t)}{2} \\, dt = \\frac{k_1}{2} \\left( \\int_0^1 \\cos(2\\pi t) dt - \\int_0^1 \\cos^2(2\\pi t) dt \\right)$.\n  $\\int_0^1 \\cos(2\\pi t) dt = 0$ and $\\int_0^1 \\cos^2(2\\pi t) dt = 1/2$. So the term is $\\frac{k_1}{2}(0 - \\frac{1}{2}) = -\\frac{k_1}{4}$.\n  The total second integral is $\\frac{k_0}{2} - \\frac{k_1}{4}$.\n  $I_C = \\frac{\\pi^2}{2} - \\left(\\frac{k_0}{2} - \\frac{k_1}{4}\\right) = \\frac{\\pi^2}{2} - \\left(\\frac{0.5}{2} - \\frac{0.2}{4}\\right) = \\frac{\\pi^2}{2} - (0.25 - 0.05) = \\frac{\\pi^2}{2} - 0.2$.\n\n- **Case D:** $f(t)=\\sin(2\\pi t)$, $K(t)=-1$.\n  $f'(t) = 2\\pi \\cos(2\\pi t)$.\n  $I_D = \\int_0^1 \\left( (2\\pi \\cos(2\\pi t))^2 - (-1)\\sin^2(2\\pi t) \\right) dt = \\int_0^1 \\left( 4\\pi^2 \\cos^2(2\\pi t) + \\sin^2(2\\pi t) \\right) dt$.\n  $\\int_0^1 \\cos^2(2\\pi t) \\, dt = 1/2$ and $\\int_0^1 \\sin^2(2\\pi t) \\, dt = 1/2$.\n  $I_D = 4\\pi^2(\\frac{1}{2}) + \\frac{1}{2} = 2\\pi^2 + \\frac{1}{2}$.\n\nThe final step is to implement the numerical scheme, compute the values for each case, and find the absolute error against these analytical results.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares numerical and analytical values of the index form\n    for four test cases.\n    \"\"\"\n    \n    # Global parameters for the numerical method\n    N = 20000\n    L = 1.0\n    h = L / N\n    \n    # Create the time grid\n    t = np.linspace(0, L, N + 1)\n    \n    # Test cases from the problem statement\n    k0 = 0.5\n    k1 = 0.2\n    \n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"f_func\": lambda t: np.sin(np.pi * t),\n            \"K_func\": lambda t: 0.0,\n            \"analytical_val\": np.pi**2 / 2.0\n        },\n        {\n            \"name\": \"Case B\",\n            \"f_func\": lambda t: np.sin(np.pi * t),\n            \"K_func\": lambda t: 1.0,\n            \"analytical_val\": (np.pi**2 - 1.0) / 2.0\n        },\n        {\n            \"name\": \"Case C\",\n            \"f_func\": lambda t: np.sin(np.pi * t),\n            \"K_func\": lambda t: k0 + k1 * np.cos(2 * np.pi * t),\n            \"analytical_val\": np.pi**2 / 2.0 - (k0 / 2.0 - k1 / 4.0)\n        },\n        {\n            \"name\": \"Case D\",\n            \"f_func\": lambda t: np.sin(2 * np.pi * t),\n            \"K_func\": lambda t: -1.0,\n            \"analytical_val\": 2 * np.pi**2 + 0.5\n        }\n    ]\n    \n    results = []\n    \n    for case in test_cases:\n        # Discretize the functions f(t) and K(t)\n        f_vals = case[\"f_func\"](t)\n        K_vals = case[\"K_func\"](t)\n        \n        # --- Numerical Calculation ---\n        \n        # 1. Approximate the derivative term: integral of (f'(t))^2 dt\n        # Using the specified formula: sum((f_{i+1}-f_i)^2 / h)\n        # np.diff(f_vals) computes f_{i+1}-f_i for i=0,...,N-1\n        term1 = np.sum(np.diff(f_vals)**2) / h\n        \n        # 2. Approximate the curvature term: integral of K(t)f(t)^2 dt\n        # Using the composite trapezoidal rule.\n        integrand = K_vals * f_vals**2\n        \n        # Define trapezoidal weights\n        weights = np.ones(N + 1)\n        weights[0] = 0.5\n        weights[-1] = 0.5\n        \n        term2 = h * np.sum(weights * integrand)\n        \n        # Combine terms to get the numerical value of the index form\n        numerical_val = term1 - term2\n        \n        # --- Error Calculation ---\n        analytical_val = case[\"analytical_val\"]\n        error = abs(numerical_val - analytical_val)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3061431"}]}