{"hands_on_practices": [{"introduction": "In a Generalized Linear Model (GLM), the link function forms the crucial bridge between the linear predictor, $\\eta$, which can take any real value, and the expected value of our response, $\\mu$. The nature of the response variable dictates the possible range of $\\mu$. This exercise challenges you to think critically about the mathematical properties a function must satisfy to be a valid link function, using a hypothetical but illustrative example to highlight why not just any function will do [@problem_id:1930962].", "problem": "In the framework of Generalized Linear Models (GLMs), the relationship between the expected value of a response variable, $\\mu = E[Y]$, and a linear predictor, $\\eta = \\mathbf{x}^T\\beta$, is established through a link function, $g$. The core equation is $g(\\mu) = \\eta$. For this model to be well-defined, the link function must map the space of possible values for the mean $\\mu$ to the space of possible values for the linear predictor $\\eta$.\n\nConsider a response variable $Y$ that follows a Bernoulli distribution, where $Y$ can take values $0$ or $1$. The mean of this variable, $\\mu = P(Y=1)$, is therefore restricted to the open interval $(0,1)$. The linear predictor $\\eta$, being a linear combination of explanatory variables, can theoretically take any value on the real line, i.e., $\\eta \\in (-\\infty, \\infty)$.\n\nAn analyst proposes using the function $g(\\mu) = \\mu^2$ as a link function for this Bernoulli GLM. Which of the following statements identifies the fundamental reason why this function is not suitable for this purpose?\n\nA. The function $g(\\mu) = \\mu^2$ is not the canonical link function for the Bernoulli distribution.\nB. The function $g(\\mu) = \\mu^2$ is not one-to-one over the entire real line.\nC. The range of the function $g(\\mu)$ for $\\mu \\in (0,1)$ does not cover the set of all real numbers.\nD. The inverse of the link function, $g^{-1}(\\eta)$, does not exist.\nE. The second derivative of the link function, $g''(\\mu)$, is not zero.", "solution": "In a generalized linear model, the link function $g$ must map the mean parameter space to the linear predictor space and be invertible so that, for any $\\eta \\in (-\\infty,\\infty)$, the inverse $g^{-1}(\\eta)$ yields a valid mean $\\mu$ in the allowable range. For a Bernoulli response, the mean satisfies $\\mu \\in (0,1)$, so a valid link must satisfy\n$$\ng:(0,1)\\to(-\\infty,\\infty)\n$$\nand be one-to-one with an inverse\n$$\ng^{-1}:(-\\infty,\\infty)\\to(0,1).\n$$\n\nConsider $g(\\mu)=\\mu^{2}$. For $\\mu \\in (0,1)$, we have $0<\\mu^{2}<1$, hence\n$$\ng\\big((0,1)\\big)=(0,1).\n$$\nTherefore, the range of $g$ over the admissible domain of $\\mu$ is $(0,1)$, which does not cover $(-\\infty,\\infty)$. Consequently, for any $\\eta \\notin (0,1)$, there is no $\\mu \\in (0,1)$ such that $g(\\mu)=\\eta$, and the inverse $g^{-1}(\\eta)=\\sqrt{\\eta}$ cannot be defined for all $\\eta \\in (-\\infty,\\infty)$. This violates the requirement that the link map be surjective onto the linear predictor space.\n\nEvaluating the options:\n- A is not fundamental; non-canonical links can still be valid.\n- B is irrelevant to the required domain; on $(0,1)$, $g$ is one-to-one.\n- C correctly identifies that $g\\big((0,1)\\big)\\neq(-\\infty,\\infty)$, which is the essential failure.\n- D is false as stated; an inverse exists but only on the restricted range $(0,1)$, not on $(-\\infty,\\infty)$.\n- E is irrelevant to link validity.\n\nThus, the fundamental reason is the range mismatch described in C.", "answer": "$$\\boxed{C}$$", "id": "1930962"}, {"introduction": "While many functions can serve as valid links, some are used far more frequently due to their statistical properties and interpretability. This practice explores three workhorses of binary data modeling: the logit, probit, and complementary log-log links. By calculating the derivative $\\frac{d\\mu}{d\\eta}$, you will gain insight into how a model's predicted probability responds to changes in the linear predictor, revealing subtle but important differences in their behavior [@problem_id:1930929].", "problem": "In the framework of a Generalized Linear Model (GLM) for binary data, the link function, $g(\\mu)$, relates the expected value of the response variable, $\\mu = E[Y]$, to the linear predictor, $\\eta$. The linear predictor is a linear combination of explanatory variables. This relationship is given by $\\eta = g(\\mu)$, where $0 < \\mu < 1$. The quantity $\\frac{d\\mu}{d\\eta}$ represents the sensitivity of the mean response to a small change in the linear predictor.\n\nConsider the following three commonly used link functions:\n1.  **Logit**: $\\eta = \\ln\\left(\\frac{\\mu}{1-\\mu}\\right)$\n2.  **Probit**: $\\eta = \\Phi^{-1}(\\mu)$, where $\\Phi^{-1}$ is the quantile function (the inverse of the Cumulative Distribution Function) of the standard normal distribution. The probability density function of the standard normal distribution is $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{z^{2}}{2}\\right)$.\n3.  **Complementary log-log (cloglog)**: $\\eta = \\ln(-\\ln(1-\\mu))$\n\nCalculate the numerical value of the derivative $\\frac{d\\mu}{d\\eta}$ for each of these three models, evaluated at the point where the mean response is $\\mu = 0.5$.\n\nPresent your three results as a single collection of numbers, corresponding to the logit, probit, and cloglog models, in that specific order. Round each numerical value to four significant figures.", "solution": "We seek $d\\mu/d\\eta$ for each link at $\\mu=0.5$. In a GLM, with link $\\eta=g(\\mu)$, the inverse link is $\\mu=g^{-1}(\\eta)$ and the derivative satisfies\n$$\n\\frac{d\\mu}{d\\eta}=\\frac{1}{g'(\\mu)}.\n$$\n\nLogit link: $g(\\mu)=\\ln\\!\\left(\\frac{\\mu}{1-\\mu}\\right)$. Differentiate:\n$$\ng'(\\mu)=\\frac{d}{d\\mu}\\left[\\ln(\\mu)-\\ln(1-\\mu)\\right]=\\frac{1}{\\mu}+\\frac{1}{1-\\mu}=\\frac{1}{\\mu(1-\\mu)}.\n$$\nHence,\n$$\n\\frac{d\\mu}{d\\eta}=\\mu(1-\\mu).\n$$\nAt $\\mu=0.5$, $\\frac{d\\mu}{d\\eta}=0.5\\times 0.5=0.25$.\n\nProbit link: $g(\\mu)=\\Phi^{-1}(\\mu)$. Using the derivative of the inverse function,\n$$\ng'(\\mu)=\\frac{1}{\\Phi'\\!\\left(\\Phi^{-1}(\\mu)\\right)}=\\frac{1}{\\phi\\!\\left(\\Phi^{-1}(\\mu)\\right)}.\n$$\nThus,\n$$\n\\frac{d\\mu}{d\\eta}=\\phi\\!\\left(\\Phi^{-1}(\\mu)\\right).\n$$\nAt $\\mu=0.5$, $\\eta=\\Phi^{-1}(0.5)=0$, and $\\phi(0)=\\frac{1}{\\sqrt{2\\pi}}$. Numerically, $\\frac{1}{\\sqrt{2\\pi}}\\approx 0.3989$ to four significant figures.\n\nComplementary log-log link: $g(\\mu)=\\ln\\!\\big(-\\ln(1-\\mu)\\big)$. Differentiate using the chain rule:\n$$\ng'(\\mu)=\\frac{1}{-\\ln(1-\\mu)}\\cdot\\frac{d}{d\\mu}\\big[-\\ln(1-\\mu)\\big]=\\frac{1}{-\\ln(1-\\mu)}\\cdot\\frac{1}{1-\\mu}=\\frac{1}{(1-\\mu)\\big(-\\ln(1-\\mu)\\big)}.\n$$\nTherefore,\n$$\n\\frac{d\\mu}{d\\eta}=(1-\\mu)\\big(-\\ln(1-\\mu)\\big).\n$$\nAt $\\mu=0.5$, this is $(1-0.5)\\big(-\\ln(0.5)\\big)=0.5\\ln 2\\approx 0.3466$ to four significant figures.\n\nCollecting the results in the order logit, probit, cloglog and rounding to four significant figures gives $0.2500$, $0.3989$, $0.3466$.", "answer": "$$\\boxed{\\begin{pmatrix}0.2500 & 0.3989 & 0.3466\\end{pmatrix}}$$", "id": "1930929"}, {"introduction": "Once a model is specified and fit, a fundamental question arises: how well does it actually describe the data? For GLMs, deviance provides a powerful measure of the goodness-of-fit, generalizing the concept of residual sum of squares from linear regression. In this problem, you will calculate the deviance for a simple Poisson regression model, providing a concrete application of how we quantify the discrepancy between the fitted model and a 'perfect' or saturated model [@problem_id:1930961].", "problem": "An operations analyst at a large e-commerce company is monitoring the number of server crashes per hour. Over a three-hour period, the observed number of crashes are $y_1=2$, $y_2=5$, and $y_3=8$. The analyst wants to fit a simple statistical model to this data. The model assumes that the number of crashes per hour, $Y_i$, follows a Poisson distribution with a constant mean $\\mu$, i.e., $Y_i \\sim \\text{Poisson}(\\mu)$. The log-likelihood for a single Poisson observation $y$ with mean $\\mu$ is given by $\\ell(\\mu; y) = y \\ln(\\mu) - \\mu - \\ln(y!)$.\n\nThe analyst fits the model and finds the maximum likelihood estimate for the mean to be $\\hat{\\mu} = 5$. To assess the model's fit, the analyst decides to calculate the deviance. The deviance is defined as $D = 2(\\ell_{\\text{sat}} - \\ell_{\\text{fit}})$, where $\\ell_{\\text{fit}}$ is the log-likelihood of the fitted model evaluated at the maximum likelihood estimates, and $\\ell_{\\text{sat}}$ is the log-likelihood of the saturated model. In a saturated model, the fitted value for each observation is the observation itself (i.e., the parameter estimate for the $i$-th observation is $\\hat{\\mu}_i=y_i$), achieving a perfect fit.\n\nCalculate the value of the deviance for the analyst's model. Note that for any calculation involving an observation $y_i=0$, the term $y_i \\ln(y_i)$ should be treated as 0. Report your answer rounded to four significant figures.", "solution": "For a Poisson observation $y$ with mean $\\mu$, the log-likelihood is $\\ell(\\mu;y)=y\\ln(\\mu)-\\mu-\\ln(y!)$. For three independent observations $y_{1}=2$, $y_{2}=5$, $y_{3}=8$ and a fitted constant mean $\\hat{\\mu}=5$, the fitted-model log-likelihood is\n$$\n\\ell_{\\text{fit}}=\\sum_{i=1}^{3}\\left[y_{i}\\ln(5)-5-\\ln(y_{i}!)\\right].\n$$\nThe saturated-model log-likelihood, with $\\hat{\\mu}_{i}=y_{i}$, is\n$$\n\\ell_{\\text{sat}}=\\sum_{i=1}^{3}\\left[y_{i}\\ln(y_{i})-y_{i}-\\ln(y_{i}!)\\right].\n$$\nTherefore, the deviance\n$$\nD=2\\left(\\ell_{\\text{sat}}-\\ell_{\\text{fit}}\\right)=2\\sum_{i=1}^{3}\\left[y_{i}\\ln\\!\\left(\\frac{y_{i}}{5}\\right)-(y_{i}-5)\\right].\n$$\nSubstituting $y_{1}=2$, $y_{2}=5$, $y_{3}=8$ gives\n$$\nD=2\\Big(2\\ln\\!\\left(\\frac{2}{5}\\right)-(2-5)+5\\ln\\!\\left(\\frac{5}{5}\\right)-(5-5)+8\\ln\\!\\left(\\frac{8}{5}\\right)-(8-5)\\Big).\n$$\nThis simplifies to\n$$\nD=2\\left(2\\ln\\!\\left(\\frac{2}{5}\\right)+8\\ln\\!\\left(\\frac{8}{5}\\right)\\right),\n$$\nsince $5\\ln(1)=0$ and the constants $+3$ and $-3$ cancel. Numerically,\n$$\n\\ln\\!\\left(\\frac{2}{5}\\right)\\approx -0.916290731874,\\qquad \\ln\\!\\left(\\frac{8}{5}\\right)\\approx 0.470003629246,\n$$\nso\n$$\nD\\approx 2\\left[2(-0.916290731874)+8(0.470003629246)\\right]\\approx 3.854895140435\\ldots\n$$\nRounded to four significant figures, $D\\approx 3.855$. None of the $y_{i}$ are zero, so no special handling of $y_{i}\\ln(y_{i})$ is required.", "answer": "$$\\boxed{3.855}$$", "id": "1930961"}]}