{"hands_on_practices": [{"introduction": "The Sequential Probability Ratio Test (SPRT) operates on a simple, yet powerful, principle: collect evidence piece by piece until you have enough to make a confident decision. This first exercise allows you to experience this sequential process firsthand. By tracking the likelihood ratio $\\Lambda_n$ after each observation in a hypothetical quality control scenario, you will determine the exact sequence of outcomes that leads to a decision, solidifying your understanding of the test's core mechanics. [@problem_id:1954406]", "problem": "In a quality control process for a new type of semiconductor, components are tested sequentially. Each component is either defective or non-defective. The manufacturing process can be in one of two states. In the 'normal' state, the probability of producing a defective component is $p_0 = 1/3$. In the 'degraded' state, this probability is $p_1 = 2/3$.\n\nTo monitor the process, a statistician employs a Sequential Probability Ratio Test (SPRT). Let the outcome of the $i$-th test be $X_i$, where $X_i=1$ if the component is defective and $X_i=0$ if it is non-defective. The test is based on the following hypotheses:\n- Null Hypothesis, $H_0$: The process is in the 'normal' state ($p = p_0 = 1/3$).\n- Alternative Hypothesis, $H_1$: The process is in the 'degraded' state ($p = p_1 = 2/3$).\n\nThe test proceeds by calculating the likelihood ratio $\\Lambda_n$ after $n$ observations. The decision rule is to stop and accept $H_1$ if $\\Lambda_n \\ge A$, stop and accept $H_0$ if $\\Lambda_n \\le B$, and continue testing if $B < \\Lambda_n < A$. The constants $A$ and $B$ are chosen to control error rates and are given by their natural logarithms as $\\ln A = \\ln(4)$ and $\\ln B = -\\ln(4)$.\n\nDetermine the specific sequence of two observations, $(X_1, X_2)$, that results in the test being terminated with the decision to accept the alternative hypothesis $H_1$. The answer should be a sequence of two numbers (0 or 1).", "solution": "Under the hypotheses $H_{0}: p=p_{0}=\\frac{1}{3}$ and $H_{1}: p=p_{1}=\\frac{2}{3}$, the Sequential Probability Ratio Test uses the likelihood ratio after $n$ observations,\n$$\n\\Lambda_{n}=\\prod_{i=1}^{n}\\frac{p_{1}^{X_{i}}(1-p_{1})^{1-X_{i}}}{p_{0}^{X_{i}}(1-p_{0})^{1-X_{i}}}.\n$$\nLet $S_{n}=\\sum_{i=1}^{n}X_{i}$. Then\n$$\n\\Lambda_{n}=\\left(\\frac{p_{1}}{p_{0}}\\right)^{S_{n}}\\left(\\frac{1-p_{1}}{1-p_{0}}\\right)^{n-S_{n}}.\n$$\nSubstituting $p_{0}=\\frac{1}{3}$ and $p_{1}=\\frac{2}{3}$ gives\n$$\n\\frac{p_{1}}{p_{0}}=\\frac{\\frac{2}{3}}{\\frac{1}{3}}=2,\\qquad \\frac{1-p_{1}}{1-p_{0}}=\\frac{\\frac{1}{3}}{\\frac{2}{3}}=\\frac{1}{2},\n$$\nhence\n$$\n\\Lambda_{n}=2^{S_{n}}\\left(\\frac{1}{2}\\right)^{n-S_{n}}=2^{2S_{n}-n}.\n$$\nThe decision thresholds satisfy $\\ln A=\\ln(4)$ and $\\ln B=-\\ln(4)$, so $A=\\exp(\\ln(4))=4$ and $B=\\exp(-\\ln(4))=\\frac{1}{4}$. The stopping rules are: accept $H_{1}$ if $\\Lambda_{n}\\geq 4$, accept $H_{0}$ if $\\Lambda_{n}\\leq \\frac{1}{4}$, and continue otherwise.\n\nFor $n=1$, $S_{1}\\in\\{0,1\\}$:\n- If $X_{1}=1$, then $\\Lambda_{1}=2^{2\\cdot 1-1}=2<4$.\n- If $X_{1}=0$, then $\\Lambda_{1}=2^{2\\cdot 0-1}=\\frac{1}{2}>\\frac{1}{4}$.\nThus no decision is made after one observation.\n\nFor $n=2$, enumerate all sequences and compute $S_{2}$ and $\\Lambda_{2}=2^{2S_{2}-2}$:\n- $(0,0)$: $S_{2}=0$, $\\Lambda_{2}=2^{-2}=\\frac{1}{4}\\leq \\frac{1}{4}$, so accept $H_{0}$.\n- $(1,0)$ or $(0,1)$: $S_{2}=1$, $\\Lambda_{2}=2^{0}=1$, which lies strictly between $\\frac{1}{4}$ and $4$, so continue.\n- $(1,1)$: $S_{2}=2$, $\\Lambda_{2}=2^{2}=4\\geq 4$, so accept $H_{1}$.\n\nTherefore, the unique two-observation sequence that terminates the test with acceptance of $H_{1}$ is $(1,1)$.", "answer": "$$\\boxed{\\begin{pmatrix}1 & 1\\end{pmatrix}}$$", "id": "1954406"}, {"introduction": "While the SPRT often involves multiple observations, certain situations allow for an immediate conclusion when an observation is exceptionally informative. This practice problem explores such a scenario, using a uniform distribution to model component lifetimes. You will see how a single data point can be entirely inconsistent with one hypothesis, causing the likelihood ratio to become infinite and leading to an instant, decisive rejection of the null hypothesis. [@problem_id:1954394]", "problem": "A quality control engineer is evaluating a new manufacturing process for a specialized electronic component. The lifetime of a component, measured in thousands of hours, is known to follow a uniform distribution on the interval $(0, \\theta)$, denoted as $U(0, \\theta)$. The standard process produces components where the parameter $\\theta$ is known to be $\\theta_0 = 1$. A new, potentially improved process is being tested, which is claimed to produce components where the parameter is $\\theta_1 = 2$.\n\nThe engineer employs a Sequential Probability Ratio Test (SPRT) to decide between the two competing hypotheses:\n- Null Hypothesis $H_0: \\theta = \\theta_0 = 1$\n- Alternative Hypothesis $H_1: \\theta = \\theta_1 = 2$\n\nThe test is designed with a desired maximum Type I error probability of $\\alpha = 0.05$ and a maximum Type II error probability of $\\beta = 0.10$. The SPRT procedure involves collecting lifetime data from components sequentially. After the $n$-th observation, the likelihood ratio $\\lambda_n$ is computed and compared against two thresholds, $A$ and $B$. The decision rule is:\n- If $\\lambda_n \\ge A$, stop sampling and reject $H_0$.\n- If $\\lambda_n \\le B$, stop sampling and accept $H_0$.\n- If $B < \\lambda_n < A$, continue sampling.\n\nThe thresholds are approximated using the formulas $A \\approx (1-\\beta)/\\alpha$ and $B \\approx \\beta/(1-\\alpha)$.\n\nDuring the test, the very first component selected from the new process is observed to have a lifetime of $x_1 = 1.3$ thousand hours. Which of the following statements correctly describes the immediate outcome and reasoning based on this single observation?\n\nA. Continue testing, because a single data point is insufficient to make a decision.\n\nB. Accept $H_0$, because the observed value is relatively close to the mean under $H_0$.\n\nC. Reject $H_0$, because the likelihood of this observation under $H_0$ is zero, making the likelihood ratio infinite.\n\nD. Continue testing, because the likelihood ratio for this observation falls between the decision thresholds $A$ and $B$.\n\nE. Reject $H_0$, because the likelihood ratio is negative, which is below the lower threshold $B$.", "solution": "The lifetime model under parameter $\\theta$ is $X \\sim U(0,\\theta)$ with density\n$$\nf(x \\mid \\theta) = \\begin{cases}\n\\frac{1}{\\theta}, & 0 < x < \\theta,\\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\nThe hypotheses are $H_{0}:\\theta=\\theta_{0}=1$ and $H_{1}:\\theta=\\theta_{1}=2$. Thus the densities under $H_{0}$ and $H_{1}$ are\n$$\nf_{0}(x)=\\begin{cases}\n1, & 0<x<1,\\\\\n0, & \\text{otherwise},\n\\end{cases}\n\\qquad\nf_{1}(x)=\\begin{cases}\n\\frac{1}{2}, & 0<x<2,\\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\nThe likelihood ratio after the first observation $x_{1}$ is\n$$\n\\lambda_{1}=\\frac{f_{1}(x_{1})}{f_{0}(x_{1})}.\n$$\nFor the observed $x_{1}=1.3$, we have $1.3 \\notin (0,1)$ and $1.3 \\in (0,2)$, hence\n$$\nf_{0}(1.3)=0, \\qquad f_{1}(1.3)=\\frac{1}{2},\n$$\nwhich gives\n$$\n\\lambda_{1}=\\frac{\\frac{1}{2}}{0}=+\\infty.\n$$\nThe SPRT thresholds are approximated by\n$$\nA \\approx \\frac{1-\\beta}{\\alpha}=\\frac{1-\\frac{1}{10}}{\\frac{1}{20}}=18, \\qquad\nB \\approx \\frac{\\beta}{1-\\alpha}=\\frac{\\frac{1}{10}}{1-\\frac{1}{20}}=\\frac{2}{19}.\n$$\nSince $\\lambda_{1}=+\\infty \\ge A$, the test stops immediately and rejects $H_{0}$. Therefore, the correct statement is that $H_{0}$ is rejected because the likelihood under $H_{0}$ is zero while it is positive under $H_{1}$, making the likelihood ratio infinite. Statements asserting continuation are incorrect, and a likelihood ratio cannot be negative.", "answer": "$$\\boxed{C}$$", "id": "1954394"}, {"introduction": "A key advantage of the SPRT is its efficiency, often requiring fewer observations on average than fixed-sample tests to reach a conclusion with the same error probabilities, $\\alpha$ and $\\beta$. This exercise moves from executing the test to analyzing its performance. Using Wald's seminal approximations for the decision boundaries and the Average Sample Number (ASN), you will estimate how many samples are needed, on average, to complete the test, providing a quantitative grasp of the SPRT's renowned efficiency. [@problem_id:1954399]", "problem": "A medical device company is testing a new biosensor designed to detect a specific biomarker. The company employs a Sequential Probability Ratio Test (SPRT) to decide between two hypotheses for a sample measurement $X$:\n- The null hypothesis, $H_0$: The biomarker is absent.\n- The alternative hypothesis, $H_1$: The biomarker is present.\n\nThe test is designed with a desired Type I error probability (false positive rate) of $\\alpha = 0.1$ and a Type II error probability (false negative rate) of $\\beta = 0.1$. For each sample tested, a random variable $Z$ is calculated, which is the logarithm of the likelihood ratio. Based on historical data from similar sensors, it is known that if the biomarker is indeed present ($H_1$ is true), the expected value of this log-likelihood ratio for a single sample is $E_{H_1}[Z] = 0.5$.\n\nUsing Wald's approximations for the stopping boundaries and the expected sample size, calculate the expected number of samples required to reach a decision, assuming that the biomarker is truly present in the material being tested. Express your answer as a closed-form analytic expression.", "solution": "We consider the Sequential Probability Ratio Test (SPRT) with log-likelihood ratio increments $Z_{i}$ per sample and cumulative log-likelihood $S_{n}=\\sum_{i=1}^{n}Z_{i}$. Wald’s approximations set the decision boundaries in the log domain as an upper boundary $b$ and a lower boundary $a$:\n$$\nb=\\ln\\left(\\frac{1-\\beta}{\\alpha}\\right),\\qquad a=\\ln\\left(\\frac{\\beta}{1-\\alpha}\\right),\n$$\nwhere crossing $S_{n}\\geq b$ leads to accepting $H_{1}$ and crossing $S_{n}\\leq a$ leads to accepting $H_{0}$.\n\nUnder $H_{1}$, the probability of accepting $H_{1}$ is approximately $1-\\beta$, and of accepting $H_{0}$ is approximately $\\beta$. Ignoring the overshoot, the expected terminal value of the log-likelihood under $H_{1}$ is\n$$\nE_{H_{1}}[S_{N}]\\approx (1-\\beta)b+\\beta a.\n$$\nBy Wald’s identity, for i.i.d. increments with finite mean, $E_{H_{1}}[S_{N}]=E_{H_{1}}[Z]\\cdot E_{H_{1}}[N]$. Therefore, the expected sample size under $H_{1}$ is approximated by\n$$\nE_{H_{1}}[N]\\approx \\frac{(1-\\beta)b+\\beta a}{E_{H_{1}}[Z]}.\n$$\n\nWith $\\alpha=\\beta=\\frac{1}{10}$, we compute the boundaries:\n$$\nb=\\ln\\!\\left(\\frac{1-\\frac{1}{10}}{\\frac{1}{10}}\\right)=\\ln\\!\\left(\\frac{\\frac{9}{10}}{\\frac{1}{10}}\\right)=\\ln(9),\\qquad\na=\\ln\\!\\left(\\frac{\\frac{1}{10}}{1-\\frac{1}{10}}\\right)=\\ln\\!\\left(\\frac{\\frac{1}{10}}{\\frac{9}{10}}\\right)=\\ln\\!\\left(\\frac{1}{9}\\right)=-\\ln(9).\n$$\nHence,\n$$\n(1-\\beta)b+\\beta a=\\left(1-\\frac{1}{10}\\right)\\ln(9)+\\frac{1}{10}\\left[-\\ln(9)\\right]\n=\\left(\\frac{9}{10}-\\frac{1}{10}\\right)\\ln(9)=\\frac{4}{5}\\ln(9).\n$$\nUsing $E_{H_{1}}[Z]=\\frac{1}{2}$,\n$$\nE_{H_{1}}[N]\\approx \\frac{\\frac{4}{5}\\ln(9)}{\\frac{1}{2}}=\\frac{8}{5}\\ln(9)=\\frac{16}{5}\\ln(3).\n$$\nThis is the closed-form analytic expression for the expected number of samples when the biomarker is truly present under Wald’s approximations.", "answer": "$$\\boxed{\\frac{8}{5}\\ln(9)}$$", "id": "1954399"}]}