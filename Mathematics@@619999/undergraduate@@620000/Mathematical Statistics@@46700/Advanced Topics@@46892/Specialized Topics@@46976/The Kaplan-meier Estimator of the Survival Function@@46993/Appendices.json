{"hands_on_practices": [{"introduction": "The journey from raw data to meaningful statistical insight begins with careful organization. Before we can apply the Kaplan-Meier formula, we must first process our observations into a structured format. This exercise guides you through the essential preliminary step of any survival analysis: transforming a list of individual subject data points into an analysis-ready table that tracks the number of subjects at risk ($n_j$), the number of events ($d_j$), and the number censored ($c_j$) at each distinct event time [@problem_id:1961488]. Mastering this foundational skill is crucial for ensuring the accuracy of your survival estimates.", "problem": "A clinical trial is conducted to evaluate the efficacy of a new drug, \"Neurostabil,\" in preventing the recurrence of a neurological symptom. Fifteen subjects participate in the study, which is planned for a duration of 12 months. For each subject, the data is recorded as a pair `(time, status)`, where `time` is the number of months until either the symptom recurs (an event) or the subject is censored, and `status` is an indicator variable (1 for an event, 0 for censored). A subject is censored if they drop out of the study or if the study ends before they experience an event.\n\nThe data for the 15 subjects are as follows:\n(3, 1), (5, 1), (12, 0), (7, 1), (4, 0), (9, 1), (7, 1), (10, 0), (11, 1), (12, 0), (3, 1), (7, 1), (8, 0), (5, 0), (9, 1)\n\nTo prepare for a Kaplan-Meier survival analysis, you are asked to summarize this data. Let $t_1 < t_2 < \\dots < t_k$ be the sequence of unique, ordered event times. For each distinct event time $t_j$ (where $j=1, \\dots, k$), we define the following quantities:\n- $n_j$: The number of subjects at risk just prior to time $t_j$. A subject is considered at risk if they have not yet had an event or been censored before time $t_j$.\n- $d_j$: The number of subjects who experience an event at time $t_j$.\n- $c_j$: The number of subjects who are censored in the time interval $[t_{j-1}, t_j)$, where $t_0 = 0$.\n\nDetermine the sequence of triples $(n_j, d_j, c_j)$ for all distinct event times. Present your answer as a matrix where the $j$-th row contains the triple for the $j$-th event time.", "solution": "We have a total of 15 subjects. Let the distinct ordered event times be $t_{1}<t_{2}<\\dots<t_{k}$. From the data, the times with events (status equal to 1) are $3,5,7,9,11$. Sorting and counting multiplicities gives:\n- $t_{1}=3$ with $d_{1}=2$ events,\n- $t_{2}=5$ with $d_{2}=1$ event,\n- $t_{3}=7$ with $d_{3}=3$ events,\n- $t_{4}=9$ with $d_{4}=2$ events,\n- $t_{5}=11$ with $d_{5}=1$ event.\nThus $k=5$ and $(d_{1},d_{2},d_{3},d_{4},d_{5})=(2,1,3,2,1)$.\n\nCensoring times (status equal to 0) are $4,5,8,10,12,12$. By definition, for each $j$, $c_{j}$ counts the number censored in the interval $[t_{j-1},t_{j})$, where $t_{0}=0$. Therefore:\n- $c_{1}$ counts censoring in $[0,3)$: none, so $c_{1}=0$.\n- $c_{2}$ counts censoring in $[3,5)$: time $4$ only, so $c_{2}=1$.\n- $c_{3}$ counts censoring in $[5,7)$: time $5$ only, so $c_{3}=1$.\n- $c_{4}$ counts censoring in $[7,9)$: time $8$ only, so $c_{4}=1$.\n- $c_{5}$ counts censoring in $[9,11)$: time $10$ only, so $c_{5}=1$.\nCensorings at time $12$ lie in $[11,\\infty)$ and thus do not contribute to any $c_{j}$ for $j=1,\\dots,5$.\n\nBy definition, $n_{j}$ is the number at risk just prior to $t_{j}$. Using $n=15$ and the recursive update that removes events at $t_{j-1}$ and censorings in $[t_{j-1},t_{j})$, we have:\n$$\nn_{1}=n-c_{1}=15-0=15,\n$$\nand for $j\\geq 2$,\n$$\nn_{j}=n_{j-1}-d_{j-1}-c_{j}.\n$$\nCompute successively:\n- $n_{2}=n_{1}-d_{1}-c_{2}=15-2-1=12$,\n- $n_{3}=n_{2}-d_{2}-c_{3}=12-1-1=10$,\n- $n_{4}=n_{3}-d_{3}-c_{4}=10-3-1=6$,\n- $n_{5}=n_{4}-d_{4}-c_{5}=6-2-1=3$.\n\nCollecting $(n_{j},d_{j},c_{j})$ for $j=1,\\dots,5$ in the order of event times $t_{j}=(3,5,7,9,11)$ yields the matrix with rows\n$(15,2,0)$, $(12,1,1)$, $(10,3,1)$, $(6,2,1)$, $(3,1,1)$.", "answer": "$$\\boxed{\\begin{pmatrix}\n15 & 2 & 0 \\\\\n12 & 1 & 1 \\\\\n10 & 3 & 1 \\\\\n6 & 2 & 1 \\\\\n3 & 1 & 1\n\\end{pmatrix}}$$", "id": "1961488"}, {"introduction": "With our data properly organized, we can now proceed to the core of the Kaplan-Meier method: the calculation of the survival function, $\\hat{S}(t)$. This practice problem focuses on the step-by-step application of the product-limit formula, demonstrating how the survival probability is updated at each event time. By working through a concrete example [@problem_id:1961438], you will build a solid understanding of the mechanics behind this powerful non-parametric estimator and see how information from both events and censored observations is used to construct the survival curve.", "problem": "A materials science research group is testing the durability of a new type of biodegradable electronic component. A total of 8 components are subjected to an accelerated aging test. An \"event\" is defined as the component failing. Due to limitations in the testing apparatus, some tests are stopped before the component fails; these are considered \"censored\" observations. The study recorded the following data, where each pair represents (time in hours, status), with status '1' indicating a failure and status '0' indicating the observation was censored at that time:\n\n(15, 1), (25, 1), (40, 1), (30, 0), (50, 1), (35, 0), (55, 0), (20, 1)\n\nCalculate the Kaplan-Meier estimate of the survival function, $\\hat{S}(t)$, evaluated at the exact time of the second observed failure event in the study. Express your answer as a decimal rounded to three significant figures.", "solution": "The problem asks for the Kaplan-Meier estimate of the survival function, $\\hat{S}(t)$, at a specific time. The Kaplan-Meier estimator is a non-parametric statistic used to estimate the survival function from lifetime data, which may be censored. The formula for the estimator is the product-limit formula:\n$$ \\hat{S}(t) = \\prod_{i: t_i \\le t} \\left( 1 - \\frac{d_i}{n_i} \\right) $$\nwhere $t_i$ are the distinct times at which an event (failure) occurs, $d_i$ is the number of events at time $t_i$, and $n_i$ is the number of individuals at risk (i.e., components still under observation and not having failed) just prior to time $t_i$.\n\nFirst, we must organize the data chronologically. The dataset consists of 8 components with their event/censoring times: (15, 1), (25, 1), (40, 1), (30, 0), (50, 1), (35, 0), (55, 0), (20, 1). Sorting these by time gives:\n\n1.  Time 15: Failure (Event)\n2.  Time 20: Failure (Event)\n3.  Time 25: Failure (Event)\n4.  Time 30: Censored\n5.  Time 35: Censored\n6.  Time 40: Failure (Event)\n7.  Time 50: Failure (Event)\n8.  Time 55: Censored\n\nThe problem asks for the estimate $\\hat{S}(t)$ at the time of the *second observed failure event*. From the ordered list, the first failure event occurs at $t=15$ hours, and the second failure event occurs at $t=20$ hours. Therefore, we need to calculate $\\hat{S}(20)$.\n\nThe calculation involves taking a product over all distinct event times up to and including $t=20$. The relevant event times are $t_1 = 15$ and $t_2 = 20$.\n\nAt the beginning of the study, at $t=0$, all 8 components are at risk.\n\n**Step 1: Calculate the survival factor for the first event at $t_1 = 15$.**\n- The number of components at risk just before $t=15$ is $n_1 = 8$.\n- The number of failures at $t=15$ is $d_1 = 1$.\n- The survival probability estimate just after this event is calculated. The factor for this step is $\\left(1 - \\frac{d_1}{n_1}\\right) = \\left(1 - \\frac{1}{8}\\right) = \\frac{7}{8}$.\n- The Kaplan-Meier estimate for any time $t$ in the interval $[15, 20)$ is $\\hat{S}(t) = \\frac{7}{8}$.\n\n**Step 2: Calculate the survival factor for the second event at $t_2 = 20$.**\n- To find the number of components at risk just before $t=20$, we start with the number at risk before the previous event ($n_1=8$) and subtract all individuals who had an event or were censored between that time and the current time. One component failed at $t=15$. No components were censored between $t=15$ and $t=20$.\n- So, the number of components at risk just before $t=20$ is $n_2 = 8 - 1 = 7$.\n- The number of failures at $t=20$ is $d_2 = 1$.\n- The factor for this step is $\\left(1 - \\frac{d_2}{n_2}\\right) = \\left(1 - \\frac{1}{7}\\right) = \\frac{6}{7}$.\n\n**Step 3: Combine the factors to find $\\hat{S}(20)$.**\nThe value of the Kaplan-Meier estimator at $t=20$ is the product of all survival factors for events occurring at or before this time.\n$$ \\hat{S}(20) = \\prod_{i: t_i \\le 20} \\left( 1 - \\frac{d_i}{n_i} \\right) = \\left(1 - \\frac{d_1}{n_1}\\right) \\times \\left(1 - \\frac{d_2}{n_2}\\right) $$\n$$ \\hat{S}(20) = \\left(\\frac{7}{8}\\right) \\times \\left(\\frac{6}{7}\\right) $$\nThe '7' terms cancel out:\n$$ \\hat{S}(20) = \\frac{6}{8} = \\frac{3}{4} $$\nAs a decimal, this is $0.75$.\n\nThe problem requires the answer to be rounded to three significant figures. To express $0.75$ with three significant figures, we add a trailing zero.\n\nTherefore, the Kaplan-Meier estimate is $0.750$.", "answer": "$$\\boxed{0.750}$$", "id": "1961438"}, {"introduction": "A key aspect of interpreting a Kaplan-Meier curve is understanding its behavior at the tail, which represents the long-term survival estimate. The final value of $\\hat{S}(t)$ is not always intuitive and depends critically on the status of the last observation in the study. This problem explores a definitive scenario where the last subject at risk experiences an event [@problem_id:1961480], leading to a specific and important conclusion about the limiting survival probability. This practice will deepen your understanding of how the estimator behaves under different data conditions and what it implies for long-term prognosis.", "problem": "In a materials science laboratory, an experiment is conducted to study the fatigue life of a new composite material. Fifteen identical samples of this material are subjected to a continuous, high-frequency stress test. The time to fracture for each sample is recorded. Due to experimental constraints, some tests are terminated before the sample fractures; these are considered censored observations.\n\nThe dataset consists of 15 observations, recorded as (time, status) pairs, where time is in hours and status is a binary indicator: 1 for a fracture event and 0 for a censored observation. The collected data are as follows:\n\n(50, 1), (65, 0), (70, 1), (82, 0), (90, 1), (95, 0), (105, 0), (110, 1), (112, 1), (118, 0), (120, 1), (125, 0), (130, 1), (140, 0), (150, 1).\n\nYour task is to compute the Kaplan-Meier estimate of the survival function, $\\hat{S}(t)$, for this material. Based on your calculation, determine the limiting value of the survival function as time becomes very large.\n\nProvide the value of $\\lim_{t \\to \\infty} \\hat{S}(t)$ as a single numerical value.", "solution": "The Kaplan-Meier estimator is defined by\n$$\n\\hat{S}(t)=\\prod_{t_{i}\\leq t}\\left(1-\\frac{d_{i}}{n_{i}}\\right),\n$$\nwhere $t_{i}$ are the ordered distinct event times, $d_{i}$ is the number of failures at $t_{i}$, and $n_{i}$ is the number at risk just prior to $t_{i}$.\n\nOrder the data and separate event and censoring times. Event times are $50,70,90,110,112,120,130,150$ (eight events). Censoring times are $65,82,95,105,118,125,140$ (seven censored). Start with $n=15$ at risk.\n\nTrack the risk set and events chronologically:\n- At $t=50$ (event): $n_{1}=15$, $d_{1}=1$; remaining at risk after = $14$.\n- $t=65$ (censor): remaining at risk after = $13$.\n- At $t=70$ (event): $n_{2}=13$, $d_{2}=1$; remaining at risk after = $12$.\n- $t=82$ (censor): remaining at risk after = $11$.\n- At $t=90$ (event): $n_{3}=11$, $d_{3}=1$; remaining at risk after = $10$.\n- $t=95$ (censor): remaining at risk after = $9$.\n- $t=105$ (censor): remaining at risk after = $8$.\n- At $t=110$ (event): $n_{4}=8$, $d_{4}=1$; remaining at risk after = $7$.\n- At $t=112$ (event): $n_{5}=7$, $d_{5}=1$; remaining at risk after = $6$.\n- $t=118$ (censor): remaining at risk after = $5$.\n- At $t=120$ (event): $n_{6}=5$, $d_{6}=1$; remaining at risk after = $4$.\n- $t=125$ (censor): remaining at risk after = $3$.\n- At $t=130$ (event): $n_{7}=3$, $d_{7}=1$; remaining at risk after = $2$.\n- $t=140$ (censor): remaining at risk after = $1$.\n- At $t=150$ (event): $n_{8}=1$, $d_{8}=1$; remaining at risk after = $0$.\n\nTherefore the product for $t\\geq 150$ includes the factors\n$$\n\\left(1-\\frac{1}{15}\\right)\\left(1-\\frac{1}{13}\\right)\\left(1-\\frac{1}{11}\\right)\\left(1-\\frac{1}{8}\\right)\\left(1-\\frac{1}{7}\\right)\\left(1-\\frac{1}{5}\\right)\\left(1-\\frac{1}{3}\\right)\\left(1-\\frac{1}{1}\\right).\n$$\nThe last factor equals zero because at $t=150$ there is a single subject at risk who fails, so $1-1/1=0$. Hence for all $t\\geq 150$,\n$$\n\\hat{S}(t)=0,\n$$\nand thus\n$$\n\\lim_{t\\to\\infty}\\hat{S}(t)=0.\n$$", "answer": "$$\\boxed{0}$$", "id": "1961480"}]}