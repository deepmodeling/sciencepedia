{"hands_on_practices": [{"introduction": "Our first practice problem dives into a classic scenario from reliability engineering: modeling component lifetime. We'll explore a situation where the event of interest, an LED failure, \"competes\" with a separate censoring event, a safety shutdown. This exercise [@problem_id:1902740] is fundamental for understanding how to handle right-censored data where the censoring time is itself random, and it will guide you through deriving one of the most important estimators in survival analysis.", "problem": "A materials science laboratory is conducting a reliability study on a new generation of high-power Light Emitting Diodes (LEDs). The lifetime $T$ of an LED, defined as the time until it fails, is modeled as a random variable following an exponential distribution with an unknown, constant failure rate parameter $\\lambda > 0$.\n\nFor each LED under test, there is a critical safety protocol. The test for a specific unit is immediately terminated if its internal operating temperature crosses a predefined safety threshold. This censoring event is caused by random factors such as microscopic imperfections or fluctuations in the cooling system. The time $C$ at which a unit's test is terminated due to this temperature limit is also modeled as a random variable. Based on historical data from similar components, $C$ is assumed to follow an exponential distribution with a rate parameter $\\mu > 0$. The lifetime $T$ and the censoring time $C$ are assumed to be independent random variables.\n\nAn experiment is conducted on a batch of $N$ identical LEDs. For each LED $i$ (where $i=1, 2, \\ldots, N$), the experiment records the observed time $y_i$ and a status indicator $\\delta_i$. The time $y_i$ is the time of failure or the time of censoring, whichever comes first. The indicator is $\\delta_i=1$ if the $i$-th LED failed, and $\\delta_i=0$ if the test was stopped due to the temperature safety protocol.\n\nDerive the Maximum Likelihood Estimator (MLE) for the failure rate, denoted as $\\hat{\\lambda}$. Express your final result as a closed-form analytic expression in terms of the following summary statistics from the observed data: the total number of observed failures, $D = \\sum_{i=1}^{N} \\delta_i$, and the sum of all observed times (total time on test), $Y = \\sum_{i=1}^{N} y_i$.", "solution": "Let $T\\sim\\text{Exp}(\\lambda)$ and $C\\sim\\text{Exp}(\\mu)$ be independent. Then $f_{T}(t)=\\lambda\\exp(-\\lambda t)$, $S_{T}(t)=\\exp(-\\lambda t)$, $f_{C}(c)=\\mu\\exp(-\\mu c)$, and $S_{C}(c)=\\exp(-\\mu c)$ for $t,c\\ge 0$.\n\nFor observation $i$, we record $y_{i}=\\min(T_{i},C_{i})$ and $\\delta_{i}=\\mathbf{1}\\{T_{i}<C_{i}\\}$. The contribution to the likelihood is\n- if $\\delta_{i}=1$: $f_{T}(y_{i})S_{C}(y_{i})=\\lambda\\exp(-\\lambda y_{i})\\exp(-\\mu y_{i})=\\lambda\\exp(-( \\lambda+\\mu )y_{i})$,\n- if $\\delta_{i}=0$: $f_{C}(y_{i})S_{T}(y_{i})=\\mu\\exp(-\\mu y_{i})\\exp(-\\lambda y_{i})=\\mu\\exp(-( \\lambda+\\mu )y_{i})$.\n\nHence, for each $i$,\n$$\nL_{i}(\\lambda,\\mu)=\\left[\\lambda^{\\delta_{i}}\\mu^{1-\\delta_{i}}\\right]\\exp\\!\\left(-(\\lambda+\\mu)y_{i}\\right).\n$$\nOver all $N$ units, with $D=\\sum_{i=1}^{N}\\delta_{i}$ and $Y=\\sum_{i=1}^{N}y_{i}$, the full likelihood is\n$$\nL(\\lambda,\\mu)=\\prod_{i=1}^{N}L_{i}(\\lambda,\\mu)=\\lambda^{D}\\mu^{N-D}\\exp\\!\\left(-(\\lambda+\\mu)Y\\right).\n$$\nThe log-likelihood is\n$$\n\\ell(\\lambda,\\mu)=D\\ln\\lambda+(N-D)\\ln\\mu-(\\lambda+\\mu)Y.\n$$\nTo find the MLE of $\\lambda$, differentiate with respect to $\\lambda$ and set to zero:\n$$\n\\frac{\\partial\\ell}{\\partial\\lambda}=\\frac{D}{\\lambda}-Y=0\\quad\\Longrightarrow\\quad \\hat{\\lambda}=\\frac{D}{Y}.\n$$\nThe second derivative is $\\frac{\\partial^{2}\\ell}{\\partial\\lambda^{2}}=-\\frac{D}{\\lambda^{2}}<0$ for $D>0$, confirming a maximum. If $D=0$, $\\ell(\\lambda,\\mu)$ is decreasing in $\\lambda$ so the supremum occurs at the boundary $\\lambda=0$, which is consistent with the continuous extension $\\hat{\\lambda}=D/Y$.", "answer": "$$\\boxed{\\frac{D}{Y}}$$", "id": "1902740"}, {"introduction": "Next, we turn our attention from events that take too long to observe to those that are too small to measure precisely, a common issue in environmental science and chemistry. This problem [@problem_id:1902766] introduces left-censoring through the scenario of a pollutant sensor with a lower detection limit. You will learn to construct the likelihood for this type of data and use mathematical approximation techniques to derive a practical and insightful estimator when an exact solution is intractable.", "problem": "A water quality monitoring station uses a sensor to measure the concentration of a certain chemical pollutant. The concentration, $C$, in any given water sample is assumed to follow an exponential distribution with an unknown rate parameter $\\lambda > 0$. The probability density function (PDF) for the concentration is $f(c; \\lambda) = \\lambda \\exp(-\\lambda c)$ for $c \\ge 0$.\n\nThe sensor has a lower detection limit of $L$. If a sample's true concentration $C$ is less than $L$, the sensor only records that the measurement is below the limit. If the concentration is $C \\ge L$, the sensor records the exact value.\n\nA total of $N$ water samples are analyzed. It is observed that $N_c$ of the samples have concentrations below the detection limit. The remaining $N_u = N - N_c$ samples yield specific measured concentrations $c_1, c_2, \\ldots, c_{N_u}$, and the sum of these measured values is denoted by $S = \\sum_{i=1}^{N_u} c_i$.\n\nThe Maximum Likelihood Estimate (MLE) for $\\lambda$, denoted $\\hat{\\lambda}$, is the value that maximizes the probability of observing this data set. The exact equation for $\\hat{\\lambda}$ is transcendental, meaning it cannot be solved with elementary functions. However, a useful approximation can be found in the regime where $L$ is small. Find an expression for $\\hat{\\lambda}$ that is accurate to the first order in $L$. Express your answer as a single closed-form analytic expression in terms of $N, N_c, L$, and $S$.", "solution": "Let $C$ be exponentially distributed with rate $\\lambda>0$ and PDF $f(c;\\lambda)=\\lambda \\exp(-\\lambda c)$ for $c\\ge 0$. With a left-censoring limit $L$, the likelihood for $N$ samples with $N_{c}$ censored ($C<L$) and $N_{u}=N-N_{c}$ uncensored exact values $c_{1},\\ldots,c_{N_{u}}$ (sum $S=\\sum_{i=1}^{N_{u}} c_{i}$) is\n$$\n\\mathcal{L}(\\lambda)=\\left[1-\\exp(-\\lambda L)\\right]^{N_{c}}\\prod_{i=1}^{N_{u}}\\lambda \\exp(-\\lambda c_{i}).\n$$\nThe log-likelihood is\n$$\n\\ell(\\lambda)=N_{c}\\ln\\!\\left(1-\\exp(-\\lambda L)\\right)+N_{u}\\ln \\lambda-\\lambda S.\n$$\nDifferentiate and set to zero for the MLE:\n$$\n\\frac{\\mathrm{d}\\ell}{\\mathrm{d}\\lambda}=N_{c}\\frac{L\\exp(-\\lambda L)}{1-\\exp(-\\lambda L)}+\\frac{N_{u}}{\\lambda}-S=0.\n$$\nFor small $L$, expand to first order in $L$. Write $y=\\lambda L$ and use $\\exp(-y)=1-y+\\frac{y^{2}}{2}+O(y^{3})$ and $1-\\exp(-y)=y-\\frac{y^{2}}{2}+O(y^{3})$. Then\n$$\n\\frac{L\\exp(-\\lambda L)}{1-\\exp(-\\lambda L)}= \\frac{L(1-y+\\frac{y^{2}}{2}+O(y^{3}))}{y(1-\\frac{y}{2}+O(y^{2}))}\n= \\frac{1}{\\lambda}\\left(1-\\frac{y}{2}+O(y^{2})\\right)\n= \\frac{1}{\\lambda}-\\frac{L}{2}+O(L^{2}).\n$$\nSubstitute this into the score equation and keep only first-order terms in $L$:\n$$\nN_{c}\\left(\\frac{1}{\\lambda}-\\frac{L}{2}\\right)+\\frac{N_{u}}{\\lambda}-S=0\n\\quad\\Longrightarrow\\quad\n\\frac{N_{c}+N_{u}}{\\lambda}-\\frac{N_{c}L}{2}-S=0.\n$$\nSince $N_{c}+N_{u}=N$, solve for $\\lambda$ to obtain the first-order approximation:\n$$\n\\hat{\\lambda}\\approx \\frac{N}{S+\\frac{N_{c}L}{2}}.\n$$\nThis reduces to the usual $\\hat{\\lambda}=N/S$ when $L=0$ or $N_{c}=0$, as expected.", "answer": "$$\\boxed{\\frac{N}{S+\\frac{N_{c}L}{2}}}$$", "id": "1902766"}, {"introduction": "To demonstrate the true versatility of these concepts, our final problem moves from the time domain to the spatial domain. We will analyze a dataset of impact craters, where the finite size of the survey area can lead to incomplete observationsâ€”a form of geometric censoring. This practice [@problem_id:1902761] will challenge you to apply principles of probability and geometry to quantify the impact of observational boundaries, a crucial skill in fields from astronomy to ecology.", "problem": "An autonomous rover is mapping a region on Mars to study the size distribution of small impact craters. The rover surveys a square region of the surface, measuring $L \\times L$. Craters are modeled as circles. The analysis software builds a catalog of all craters whose centers fall within this square region.\n\nThe location of crater centers is assumed to be uniformly random across the Martian surface. The radii, $R$, of the craters under investigation are modeled by a uniform distribution on the interval $[R_{min}, R_{max}]$.\n\nA crater is considered *fully observed* if its entire circumference is within the $L \\times L$ square. If any part of the crater extends beyond the square's boundary, it is flagged as *censored*. We are interested in the statistical effect of this censoring.\n\nAssume for a detected crater (one whose center is in the survey square), its center coordinates $(X, Y)$ are independent and uniformly distributed in $[0, L] \\times [0, L]$. The crater's radius $R$ is independent of its location.\n\nGiven the following parameters:\n- Survey square side length: $L = 50.0$ meters\n- Minimum crater radius: $R_{min} = 5.00$ meters\n- Maximum crater radius: $R_{max} = 30.0$ meters\n\nCalculate the probability that a randomly selected crater from the catalog (i.e., a crater with its center inside the square) is censored. Round your final answer to three significant figures.", "solution": "Let the survey square be $[0,L] \\times [0,L]$. A crater of radius $r$ is fully observed if and only if its center $(X,Y)$ lies in $[r, L-r] \\times [r, L-r]$. Given $R=r \\leq L/2$, since $X$ and $Y$ are independent and uniform on $[0,L]$, the probability of being fully observed is\n$$\nP(\\text{full} \\mid R=r) = \\left(\\frac{L-2r}{L}\\right)^{2}.\n$$\nIf $r > L/2$, then $[r,L-r]$ is empty and $P(\\text{full} \\mid R=r)=0$, so the crater is certainly censored.\n\nWith $R$ uniform on $[R_{\\min}, R_{\\max}]$ and independent of location, the unconditional probability of being fully observed is\n$$\nP(\\text{full}) = \\frac{1}{R_{\\max} - R_{\\min}} \\int_{R_{\\min}}^{\\min(R_{\\max},\\, L/2)} \\left(\\frac{L-2r}{L}\\right)^{2} \\, dr,\n$$\nand the probability of being censored is\n$$\nP(\\text{censored}) = 1 - P(\\text{full}).\n$$\n\nSubstitute the given values $L=50$, $R_{\\min}=5$, $R_{\\max}=30$, noting that $\\min(R_{\\max}, L/2) = 25$:\n$$\nP(\\text{full}) = \\frac{1}{30-5} \\cdot \\frac{1}{50^{2}} \\int_{5}^{25} (50 - 2r)^{2} \\, dr.\n$$\nExpand and integrate:\n$$\n(50 - 2r)^{2} = 2500 - 200r + 4r^{2},\n$$\n$$\n\\int (50 - 2r)^{2} \\, dr = \\int (2500 - 200r + 4r^{2}) \\, dr = 2500 r - 100 r^{2} + \\frac{4}{3} r^{3}.\n$$\nEvaluate from $r=5$ to $r=25$:\n$$\n\\left[2500 r - 100 r^{2} + \\frac{4}{3} r^{3}\\right]_{5}^{25} = \\left(2500 \\cdot 25 - 100 \\cdot 25^{2} + \\frac{4}{3} \\cdot 25^{3}\\right) - \\left(2500 \\cdot 5 - 100 \\cdot 5^{2} + \\frac{4}{3} \\cdot 5^{3}\\right).\n$$\nCompute termwise using differences:\n$$\n= 2500(25-5) - 100(25^{2} - 5^{2}) + \\frac{4}{3}(25^{3} - 5^{3})\n= 2500 \\cdot 20 - 100 \\cdot 600 + \\frac{4}{3} \\cdot 15500\n= 50000 - 60000 + \\frac{62000}{3}\n= \\frac{32000}{3}.\n$$\nHence\n$$\nP(\\text{full}) = \\frac{1}{25} \\cdot \\frac{1}{2500} \\cdot \\frac{32000}{3} = \\frac{64}{375},\n$$\nand therefore\n$$\nP(\\text{censored}) = 1 - \\frac{64}{375} = \\frac{311}{375} \\approx 0.829333\\ldots\n$$\nRounding to three significant figures gives $0.829$.", "answer": "$$\\boxed{0.829}$$", "id": "1902761"}]}