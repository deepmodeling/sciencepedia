{"hands_on_practices": [{"introduction": "The Sequential Probability Ratio Test (SPRT) offers a dynamic way to make decisions, collecting data just until you have enough evidence to choose between two competing hypotheses. This first exercise [@problem_id:1954198] places you in the role of a quality assurance engineer testing a new random number generator. Here, you will practice the core mechanic of the SPRT: calculating the cumulative likelihood ratio from a stream of data and using Wald's decision boundaries to determine in real-time whether to accept a hypothesis, reject it, or continue collecting more information.", "problem": "A software engineer is developing a new Pseudo-Random Number Generator (PRNG) designed to output single digits from 0 to 9. An initial quality assurance test is set up to verify its uniformity. The test focuses on a specific digit, '7', which is suspected to have a bug causing it to appear more frequently than expected under a uniform distribution.\n\nA Sequential Probability Ratio Test (SPRT) is employed to decide between two hypotheses:\n- The null hypothesis, $H_0$: The PRNG is uniform, and the probability of generating a '7' is $p_0 = 0.1$.\n- The alternative hypothesis, $H_1$: The bug is present, and the probability of generating a '7' is elevated to $p_1 = 0.2$.\n\nThe test is designed with a Type I error probability (rejecting $H_0$ when it is true) of $\\alpha = 0.05$ and a Type II error probability (failing to reject $H_0$ when $H_1$ is true) of $\\beta = 0.10$.\n\nAfter running the PRNG to generate 40 digits, the digit '7' has appeared 7 times. Based on this observation, what is the conclusion of the SPRT at this stage?\n\nA. Accept the null hypothesis $H_0$.\n\nB. Reject the null hypothesis $H_0$.\n\nC. Continue sampling.\n\nD. Both hypotheses are equally probable.\n\nE. The test parameters are invalid for this scenario.", "solution": "We model each output as a Bernoulli trial $X_{i}$ indicating whether the digit is $7$ ($X_{i}=1$) or not ($X_{i}=0$), with success probability $p$. We test $H_{0}: p=p_{0}=0.1$ versus $H_{1}: p=p_{1}=0.2$ using the Sequential Probability Ratio Test (SPRT).\n\nFor $n$ observations with $x$ successes, the likelihood under $p$ (ignoring the order of outcomes) is $L(p)\\propto p^{x}(1-p)^{n-x}$. The likelihood ratio is\n$$\n\\Lambda_{n}=\\frac{L(p_{1})}{L(p_{0})}=\\left(\\frac{p_{1}}{p_{0}}\\right)^{x}\\left(\\frac{1-p_{1}}{1-p_{0}}\\right)^{n-x}.\n$$\nThe SPRT uses thresholds\n$$\nA=\\frac{1-\\beta}{\\alpha},\\qquad B=\\frac{\\beta}{1-\\alpha},\n$$\nwith decision rule: if $\\Lambda_{n}\\geq A$, reject $H_{0}$; if $\\Lambda_{n}\\leq B$, accept $H_{0}$; otherwise, continue sampling.\n\nHere, $\\alpha=0.05$, $\\beta=0.10$, $p_{0}=0.1$, $p_{1}=0.2$, $n=40$, and $x=7$. Thus\n$$\nA=\\frac{1-0.10}{0.05}=18,\\qquad B=\\frac{0.10}{1-0.05}=\\frac{2}{19}.\n$$\nCompute the likelihood ratio:\n$$\n\\Lambda_{40}=\\left(\\frac{0.2}{0.1}\\right)^{7}\\left(\\frac{1-0.2}{1-0.1}\\right)^{33}=2^{7}\\left(\\frac{8}{9}\\right)^{33}.\n$$\nEquivalently, in logarithms,\n$$\n\\ln \\Lambda_{40}=7\\ln 2+33\\ln\\!\\left(\\frac{8}{9}\\right)=7\\ln 2+33\\left(3\\ln 2-2\\ln 3\\right)=106\\ln 2-66\\ln 3.\n$$\nNumerically,\n$$\n\\ln \\Lambda_{40}\\approx 0.965190,\\quad \\text{so}\\quad \\Lambda_{40}\\approx \\exp(0.965190)\\approx 2.625.\n$$\nCompare with thresholds: $B=\\frac{2}{19}\\approx 0.105263$ and $A=18$. Since $B<\\Lambda_{40}<A$, the SPRT decision at this stage is to continue sampling.\n\nTherefore, the correct choice is C.", "answer": "$$\\boxed{C}$$", "id": "1954198"}, {"introduction": "A key advantage of sequential analysis is its efficiency, often requiring fewer observations on average than fixed-sample-size tests to reach a conclusion. To quantify this, we use the Average Sample Number (ASN). This practice [@problem_id:1954190] challenges you to calculate the expected number of microchips to be tested in a manufacturing scenario, applying Wald's powerful approximation for the ASN. This skill is crucial for planning experiments and understanding the practical benefits of an SPRT design.", "problem": "A semiconductor manufacturer is evaluating a new fabrication process designed to reduce the proportion of defective microchips. The historical defect rate with the old process is $p_0 = 0.10$. The new process is considered a significant improvement if it can achieve a defect rate of $p_1 = 0.05$.\n\nTo make a decision between the null hypothesis $H_0: p = p_0$ and the alternative hypothesis $H_1: p = p_1$, the quality control team employs a Sequential Probability Ratio Test (SPRT). The test is designed with a Type I error probability of $\\alpha = 0.05$ (incorrectly concluding the new process is an improvement) and a Type II error probability of $\\beta = 0.10$ (incorrectly failing to detect the improvement when it occurs).\n\nEach microchip test is an independent Bernoulli trial, where '1' denotes a defective chip and '0' denotes a functional one. Assuming the true defect rate of the new process is, in fact, still $p_0 = 0.10$, calculate the approximate Average Sample Number (ASN), which is the expected number of microchips that need to be tested to reach a decision.\n\nRound your final answer to three significant figures.", "solution": "We test $H_{0}: p=p_{0}$ versus $H_{1}: p=p_{1}$ with an SPRT. For independent Bernoulli($p$) observations $X_{i}\\in\\{0,1\\}$, the log-likelihood ratio increment for one observation is\n$$\nY=\\ln\\Lambda_{1}=X\\ln\\!\\left(\\frac{p_{1}}{p_{0}}\\right)+(1-X)\\ln\\!\\left(\\frac{1-p_{1}}{1-p_{0}}\\right).\n$$\nUnder $H_{0}$, its expectation is\n$$\n\\mu_{0}=E_{0}[Y]=p_{0}\\ln\\!\\left(\\frac{p_{1}}{p_{0}}\\right)+(1-p_{0})\\ln\\!\\left(\\frac{1-p_{1}}{1-p_{0}}\\right).\n$$\nWith Type I and II errors $\\alpha$ and $\\beta$, the SPRT likelihood ratio boundaries are $A=\\frac{1-\\beta}{\\alpha}$ and $B=\\frac{\\beta}{1-\\alpha}$, so $a=\\ln A$ and $b=\\ln B$. Wald’s approximation to the Average Sample Number under $H_{0}$ is\n$$\nE_{0}[N]\\approx \\frac{\\alpha\\,a+(1-\\alpha)\\,b}{\\mu_{0}}.\n$$\nSubstitute $p_{0}=0.10$, $p_{1}=0.05$, $\\alpha=0.05$, $\\beta=0.10$. Compute\n$$\na=\\ln\\!\\left(\\frac{1-\\beta}{\\alpha}\\right)=\\ln(18),\\quad b=\\ln\\!\\left(\\frac{\\beta}{1-\\alpha}\\right)=\\ln\\!\\left(\\frac{0.10}{0.95}\\right),\n$$\n$$\n\\mu_{0}=0.10\\ln\\!\\left(\\frac{0.05}{0.10}\\right)+0.90\\ln\\!\\left(\\frac{0.95}{0.90}\\right)=0.10\\ln\\!\\left(\\frac{1}{2}\\right)+0.90\\ln\\!\\left(\\frac{19}{18}\\right).\n$$\nNumerically,\n$$\na=\\ln(18)\\approx 2.890371758,\\quad b=\\ln\\!\\left(\\frac{0.10}{0.95}\\right)\\approx -2.251291799,\n$$\n$$\n\\mu_{0}\\approx 0.10(-0.693147181)+0.90(0.054067221)\\approx -0.020654219.\n$$\nTherefore,\n$$\nE_{0}[N]\\approx \\frac{0.05\\cdot 2.890371758+0.95\\cdot(-2.251291799)}{-0.020654219}\\approx \\frac{-1.994208621}{-0.020654219}\\approx 96.6,\n$$\nrounded to three significant figures.", "answer": "$$\\boxed{96.6}$$", "id": "1954190"}, {"introduction": "Sequential methods extend beyond hypothesis testing into the realm of precise estimation. This problem [@problem_id:1954192] introduces Stein's two-stage sampling procedure, a classic and elegant solution to a common challenge: constructing a confidence interval with a prespecified fixed width when the population variance is unknown. By working through this materials science scenario, you will learn how to design an adaptive experiment that guarantees a desired level of precision, a task that is impossible with a single fixed-sample approach.", "problem": "A materials engineering team is developing a new lightweight composite material for aerospace applications. A critical parameter for certification is the material's ultimate compressive strength. From prior experience with similar materials, the team models the compressive strength of any given sample, $X_i$, as a random variable following a normal distribution, $N(\\mu, \\sigma^2)$, where both the mean strength $\\mu$ and the variance $\\sigma^2$ are unknown.\n\nThe team's goal is to estimate the mean compressive strength $\\mu$ by constructing a confidence interval of a prespecified fixed width. Specifically, they require a 95% confidence interval for $\\mu$ that has a total width of no more than $2d = 10$ MPa. Since the population variance $\\sigma^2$ is unknown, a fixed-sample-size experiment cannot guarantee this precision.\n\nTo overcome this, the team adopts a Stein's two-stage sampling procedure:\n1.  A pilot batch of $n_0 = 20$ samples is produced and tested to obtain an initial estimate of the variance, $S_{20}^2$.\n2.  This pilot variance estimate is used to determine the total number of samples, $N$, required to achieve the desired confidence interval width.\n3.  If $N > n_0$, an additional $N - n_0$ samples are tested.\n4.  The final confidence interval for $\\mu$ is computed using all $N$ samples.\n\nThe rule for determining the total sample size $N$ is based on the pilot study results. You are given that the critical value from the t-distribution with 19 degrees of freedom corresponding to a 95% confidence level is $t_{19, 0.025} = 2.093$.\n\nCalculate the approximate expected total sample size, $E[N]$, required by this procedure. For this calculation, assume that the true (but unknown to the engineers) standard deviation of the material's compressive strength is $\\sigma = 25$ MPa.\n\nRound your final answer to four significant figures.", "solution": "We model $X_{i} \\sim N(\\mu,\\sigma^{2})$ with both $\\mu$ and $\\sigma^{2}$ unknown. For a two-sided confidence interval for $\\mu$ based on $N$ observations, the half-width is\n$$\nh_{N} \\equiv t_{N-1,\\,1-\\alpha/2}\\,\\frac{S_{N}}{\\sqrt{N}},\n$$\nand the required total width constraint $2h_{N} \\leq 2d$ is equivalent to $h_{N} \\leq d$. In Stein’s two-stage procedure with pilot size $n_{0}$, a common rule sets the total sample size as\n$$\nN \\;=\\; \\max\\!\\left\\{\\,n_{0},\\; \\left\\lceil \\frac{t_{n_{0}-1,\\,1-\\alpha/2}^{2}\\,S_{n_{0}}^{2}}{d^{2}} \\right\\rceil \\right\\},\n$$\nso that the pilot estimate $S_{n_{0}}^{2}$ and $t_{n_{0}-1,\\,1-\\alpha/2}$ determine $N$. Here $n_{0}=20$, $\\alpha=0.05$, and we are given $t_{19,\\,0.025}=2.093$. The target half-width is $d=\\frac{10}{2}=5$ MPa.\n\nTo compute the approximate expected total sample size $E[N]$, we use that, under the true standard deviation $\\sigma$, the pilot variance satisfies\n$$\n\\frac{(n_{0}-1)S_{n_{0}}^{2}}{\\sigma^{2}} \\sim \\chi^{2}_{n_{0}-1} \\quad \\Rightarrow \\quad E[S_{n_{0}}^{2}] = \\sigma^{2}.\n$$\nApproximating the expectation by replacing $S_{n_{0}}^{2}$ with its mean $\\sigma^{2}$ and ignoring the ceiling for the expectation, we obtain\n$$\nE[N] \\approx \\max\\!\\left\\{\\,n_{0},\\; \\frac{t_{n_{0}-1,\\,1-\\alpha/2}^{2}\\,\\sigma^{2}}{d^{2}} \\right\\}.\n$$\nWith $\\sigma=25$ MPa, $n_{0}=20$, $d=5$ MPa, and $t_{19,\\,0.025}=2.093$,\n$$\n\\frac{t_{19,\\,0.025}^{2}\\,\\sigma^{2}}{d^{2}}\n= \\frac{(2.093)^{2}\\,(25)^{2}}{(5)^{2}}\n= (2.093)^{2}\\times \\frac{625}{25}\n= (2.093)^{2}\\times 25.\n$$\nCompute the square:\n$$\n(2.093)^{2} = 4.380649,\n$$\nhence\n$$\n(2.093)^{2}\\times 25 = 4.380649 \\times 25 = 109.516225.\n$$\nSince $109.516225 > n_{0}=20$, the maximum is attained by this value, so\n$$\nE[N] \\approx 109.516225.\n$$\nRounding to four significant figures gives $109.5$.", "answer": "$$\\boxed{109.5}$$", "id": "1954192"}]}