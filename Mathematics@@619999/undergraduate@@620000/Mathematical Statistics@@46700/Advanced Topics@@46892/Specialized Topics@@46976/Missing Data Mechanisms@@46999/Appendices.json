{"hands_on_practices": [{"introduction": "Correctly identifying the mechanism behind missing data is the first critical step in any sound statistical analysis. This exercise provides foundational practice by asking you to apply the core definitions of Missing Completely at Random (MCAR), Missing at Random (MAR), and Missing Not at Random (MNAR) to a set of distinct, practical scenarios. By working through these examples [@problem_id:1936102], you will build a strong intuition for distinguishing between these crucial classifications.", "problem": "A team of data scientists is analyzing data from a new health application designed to monitor nightly sleep quality. The primary variable of interest, which we will call `SleepScore`, is a continuous value from 0 (very poor) to 100 (excellent). However, they notice that for a significant number of nights, the `SleepScore` value is missing. They are tasked with identifying the likely missing data mechanism for three distinct situations they've identified from user reports and internal logs.\n\nThe three primary mechanisms for missing data are:\n-   **Missing Completely At Random (MCAR):** The probability that a value is missing is unrelated to any observed or unobserved variables.\n-   **Missing At Random (MAR):** The probability that a value is missing depends only on other observed variables, but not on the unobserved value of the variable itself.\n-   **Missing Not At Random (MNAR):** The probability that a value is missing depends on the unobserved value of the variable itself.\n\nBelow are the three scenarios the team is investigating.\n\n**Scenario 1:** For one week, a software bug caused the application to fail to transmit its data to the central server if the phone's battery level, which is recorded, was below 20% at the end of the sleep session. After analyzing the complete data, the team found no correlation between the phone's end-of-night battery level and the user's actual `SleepScore`.\n\n**Scenario 2:** The app uses a sensitive microphone to detect snoring and breathing patterns. In a rare \"data-overload\" error, the app crashes and fails to save any `SleepScore` data if it detects extremely loud and persistent snoring throughout the night. The intensity of snoring is a primary component used to calculate the `SleepScore`.\n\n**Scenario 3:** A random sample of user records was permanently deleted from the database due to a server hardware malfunction that affected arbitrary sectors of a hard drive.\n\nIdentify the correct missing data mechanism for each scenario.\n\nA. Scenario 1: MAR, Scenario 2: MNAR, Scenario 3: MCAR\n\nB. Scenario 1: MCAR, Scenario 2: MNAR, Scenario 3: MAR\n\nC. Scenario 1: MAR, Scenario 2: MCAR, Scenario 3: MNAR\n\nD. Scenario 1: MNAR, Scenario 2: MAR, Scenario 3: MCAR\n\nE. Scenario 1: MCAR, Scenario 2: MAR, Scenario 3: MNAR", "solution": "Let $Y$ denote the unobserved true variable of interest ($\\text{SleepScore}$), let $X$ denote observed covariates (e.g., the phoneâ€™s battery level), and let $R$ be the missingness indicator with $R=1$ if $Y$ is observed and $R=0$ if $Y$ is missing. The standard definitions are:\n$$\n\\text{MCAR: } P(R=0 \\mid Y,X)=P(R=0), \\quad\n\\text{MAR: } P(R=0 \\mid Y,X)=P(R=0 \\mid X), \\quad\n\\text{MNAR: } P(R=0 \\mid Y,X) \\text{ depends on } Y \\text{ given } X.\n$$\n\nScenario 1: The transmission fails when the observed battery level $B$ is below a threshold. Thus the missingness depends on an observed variable $B$, not on $Y$, so\n$$\nP(R=0 \\mid Y,B)=P(R=0 \\mid B),\n$$\nwhich is MAR. The note that $B$ is uncorrelated with $Y$ does not convert the mechanism to MCAR, because MCAR requires $P(R=0 \\mid Y,X)$ to be constant and here it varies with $B$.\n\nScenario 2: The app crashes under extremely loud and persistent snoring, which is a primary component in computing $Y$. Hence, even after conditioning on any observed $X$, the probability of missingness depends on the (unobserved) value of $Y$. Formally,\n$$\nP(R=0 \\mid Y,X) \\text{ varies with } Y,\n$$\nso the mechanism is MNAR.\n\nScenario 3: A random sample of records was deleted due to arbitrary hardware sector failure. This implies the deletion is independent of both $Y$ and $X$:\n$$\nP(R=0 \\mid Y,X)=P(R=0),\n$$\nwhich is MCAR.\n\nTherefore, the correct identification is: Scenario 1 is MAR, Scenario 2 is MNAR, Scenario 3 is MCAR, which corresponds to option A.", "answer": "$$\\boxed{A}$$", "id": "1936102"}, {"introduction": "The Missing Not at Random (MNAR) mechanism presents a significant challenge because the probability of missingness depends on the very data that is unobserved, often leading to biased results if not handled carefully. This practice problem [@problem_id:1936087] explores a classic MNAR case involving survey non-response in a political poll. Identifying such patterns is a vital skill for ensuring the validity of conclusions drawn from data collected from human subjects.", "problem": "A political research firm is conducting a national survey to gauge public opinion on a new, highly polarizing tax reform bill. They ask respondents to rate their level of support for the bill on an integer scale from 1 (Strongly Oppose) to 10 (Strongly Support). Let $Y_i$ be the true level of support for the $i$-th individual in the survey sample.\n\nAfter collecting the data, the analysts notice a peculiar pattern. They have strong evidence to believe that individuals with very strong opinions (i.e., those whose true support level $Y_i$ is 1, 2, 9, or 10) are more reticent to share their views and are therefore significantly more likely to refuse to answer this specific question, resulting in missing data for $Y_i$. In contrast, individuals with moderate opinions are more willing to respond.\n\nThe analysts are trying to classify this pattern of missing data according to standard statistical terminology to decide on an appropriate imputation strategy. The main three mechanisms are:\n-   **Missing Completely At Random (MCAR)**: The probability of a value being missing is unrelated to both the observed data and the unobserved data.\n-   **Missing At Random (MAR)**: The probability of a value being missing depends only on other observed variables in the dataset, but not on the missing value itself (after conditioning on the observed variables).\n-   **Missing Not At Random (MNAR)**: The probability of a value being missing depends on the value of the variable that is missing.\n\nBased on the scenario described, which of the following best describes the mechanism for the missing data on the \"level of support\" variable?\n\nA. Missing Completely At Random (MCAR)\n\nB. Missing At Random (MAR)\n\nC. Missing Not At Random (MNAR)\n\nD. Non-response Bias", "solution": "Let $Y_i$ denote the true support level and let $R_i$ be the missingness indicator, with $R_i=1$ if $Y_i$ is observed and $R_i=0$ if $Y_i$ is missing. Let $X_i$ denote other observed covariates in the dataset (if any).\n\nBy the scenario, individuals with $Y_i \\in \\{1,2,9,10\\}$ have a higher probability of nonresponse, so\n$$\n\\Pr(R_i=0 \\mid Y_i=y) \\text{ is larger for } y \\in \\{1,2,9,10\\} \\text{ than for moderate } y.\n$$\nThus, the missingness mechanism depends directly on the value of $Y_i$.\n\nThe MCAR condition requires that\n$$\nR_i \\perp (Y_i,X_i) \\quad \\text{or equivalently} \\quad \\Pr(R_i=0 \\mid Y_i,X_i)=\\Pr(R_i=0),\n$$\nwhich is violated because $\\Pr(R_i=0 \\mid Y_i)$ varies with $Y_i$.\n\nThe MAR condition requires that\n$$\nR_i \\perp Y_i \\mid X_i \\quad \\text{or equivalently} \\quad \\Pr(R_i=0 \\mid Y_i,X_i)=\\Pr(R_i=0 \\mid X_i),\n$$\nwhich is also violated because even after conditioning on $X_i$, the probability of missingness depends on $Y_i$ itself.\n\nTherefore, the missingness is MNAR, characterized by\n$$\n\\Pr(R_i=0 \\mid Y_i,X_i) \\text{ depends on } Y_i.\n$$\nOption D refers to a consequence (bias due to nonresponse) rather than a formal missing-data mechanism. The mechanism that best describes this pattern is MNAR.", "answer": "$$\\boxed{C}$$", "id": "1936087"}, {"introduction": "Moving from intuitive classification to formal analysis is key to mastering statistical concepts. This advanced exercise challenges you to investigate the precise mathematical conditions under which the Missing At Random (MAR) assumption holds within a more complex model that includes unobserved latent variables. By analyzing this scenario [@problem_id:1936118], you will deepen your understanding of the rigorous definition of MAR and how it applies in sophisticated modeling situations where the cause of missingness is not immediately obvious.", "problem": "In a clinical study designed to test a new drug, researchers encounter patient dropouts, leading to missing outcome data. They propose a statistical model to understand this phenomenon. For each patient, the model includes:\n- An outcome variable $Y$, representing the patient's response to the drug.\n- A binary covariate $X \\in \\{0, 1\\}$, indicating which of two clinics the patient belongs to.\n- An unobserved binary latent class $Z \\in \\{0, 1\\}$, representing an intrinsic patient type (e.g., genetic predisposition to respond well or poorly to the drug).\n- A response indicator $R \\in \\{0, 1\\}$, where $R=1$ if the outcome $Y$ is observed, and $R=0$ if the patient drops out and $Y$ is missing.\n\nThe model is defined by the following set of assumptions:\n1.  The latent class $Z$ follows a Bernoulli distribution, $P(Z=1) = \\pi_z$, with $0 < \\pi_z < 1$.\n2.  The clinic covariate $X$ follows a Bernoulli distribution, $P(X=1) = \\pi_x$, with $0 < \\pi_x < 1$. The variables $X$ and $Z$ are statistically independent.\n3.  The patient's outcome $Y$, conditional on their latent class $Z=z$, follows a normal distribution with mean $\\mu_z$ and a constant variance $\\sigma^2 > 0$. The outcome $Y$ is assumed to be conditionally independent of the clinic $X$ given the latent class $Z$.\n4.  The probability of observing the outcome $Y$ (i.e., $R=1$) depends on both the clinic $X$ and the latent class $Z$ through the logistic regression model:\n    $$ \\ln\\left(\\frac{P(R=1 | X=x, Z=z)}{1 - P(R=1 | X=x, Z=z)}\\right) = \\beta_0 + \\beta_x x + \\beta_z z $$\n    where $\\beta_0, \\beta_x, \\beta_z$ are finite real-valued parameters. The response $R$ is conditionally independent of the outcome $Y$ given $X$ and $Z$.\n\nIn the analysis of missing data, a key concept is whether the data are Missing At Random (MAR). The MAR assumption holds if the probability of a value being missing depends only on the observed information. In the context of this problem, the missing data mechanism is MAR if and only if the conditional probability of response $P(R=1 | Y, X)$ does not depend on the value of the (potentially missing) outcome $Y$.\n\nWhich of the following conditions on the model parameters is both necessary and sufficient for the missing data mechanism to be Missing at Random (MAR)?\n\nA. $\\beta_x = 0$\n\nB. $\\beta_z = 0$\n\nC. $\\mu_0 = \\mu_1$\n\nD. $\\beta_x = 0$ or $\\mu_0 = \\mu_1$\n\nE. $\\beta_z = 0$ or $\\mu_0 = \\mu_1$\n\nF. $\\beta_x = 0$ and $\\mu_0 = \\mu_1$\n\nG. $\\beta_z = 0$ and $\\mu_0 = \\mu_1$\n\nH. The mechanism is always Missing Not at Random (MNAR) as long as $\\beta_z \\neq 0$.", "solution": "We require the Missing At Random (MAR) condition: $P(R=1 \\mid Y=y, X=x)$ must not depend on $y$ for any $x$.\n\nBy the law of total probability over the latent class $Z$ and the stated conditional independences,\n$$\nP(R=1 \\mid Y=y, X=x)\n=\\sum_{z \\in \\{0,1\\}} P(R=1 \\mid X=x, Z=z)\\,P(Z=z \\mid Y=y, X=x).\n$$\nFrom the model, $R \\perp Y \\mid (X,Z)$ and $P(R=1 \\mid X=x, Z=z)=\\{1+\\exp[-(\\beta_{0}+\\beta_{x}x+\\beta_{z}z)]\\}^{-1}$. Also, using $X \\perp Z$ and $Y \\perp X \\mid Z$, we have\n$$\nP(Z=z \\mid Y=y, X=x)=P(Z=z \\mid Y=y).\n$$\nDefine $s(t)=\\{1+\\exp(-t)\\}^{-1}$, and let $p_{0}(x)=s(\\beta_{0}+\\beta_{x}x)$ and $p_{1}(x)=s(\\beta_{0}+\\beta_{x}x+\\beta_{z})$. Then\n$$\nP(R=1 \\mid Y=y, X=x)=p_{0}(x)\\,[1-P(Z=1 \\mid Y=y)] + p_{1}(x)\\,P(Z=1 \\mid Y=y)\n= p_{0}(x) + \\{p_{1}(x)-p_{0}(x)\\} P(Z=1 \\mid Y=y).\n$$\nHence $P(R=1 \\mid Y=y, X=x)$ is independent of $y$ if and only if either $p_{1}(x)=p_{0}(x)$ for all $x$ or $P(Z=1 \\mid Y=y)$ is constant in $y$.\n\nFirst case (response does not depend on $Z$): $p_{1}(x)=p_{0}(x)$ for all $x$ holds if and only if $\\beta_{z}=0$, because $s(\\cdot)$ is strictly increasing.\n\nSecond case (outcome carries no information about $Z$): $P(Z=1 \\mid Y=y)$ is constant in $y$ if and only if $Y \\perp Z$, which under the model with $Y \\mid Z=z \\sim \\mathcal{N}(\\mu_{z},\\sigma^{2})$ occurs if and only if $\\mu_{0}=\\mu_{1}$. To see that otherwise $P(Z=1 \\mid Y=y)$ depends on $y$, compute the posterior log-odds:\n$$\n\\ln\\frac{P(Z=1 \\mid Y=y)}{P(Z=0 \\mid Y=y)}\n=\\ln\\frac{\\pi_{z}}{1-\\pi_{z}} + \\ln f_{1}(y) - \\ln f_{0}(y),\n$$\nwhere $f_{z}(y)$ is the $\\mathcal{N}(\\mu_{z},\\sigma^{2})$ density. Using\n$$\n\\ln f_{z}(y) = -\\frac{1}{2}\\ln(2\\pi\\sigma^{2}) - \\frac{(y-\\mu_{z})^{2}}{2\\sigma^{2}},\n$$\nwe obtain\n$$\n\\ln\\frac{P(Z=1 \\mid Y=y)}{P(Z=0 \\mid Y=y)} = \\ln\\frac{\\pi_{z}}{1-\\pi_{z}} + \\frac{-(y-\\mu_{1})^{2} + (y-\\mu_{0})^{2}}{2\\sigma^{2}}\n= \\ln\\frac{\\pi_{z}}{1-\\pi_{z}} + \\frac{\\mu_{1}-\\mu_{0}}{\\sigma^{2}}\\,y + \\text{const},\n$$\nwhose slope in $y$ is $(\\mu_{1}-\\mu_{0})/\\sigma^{2}$. This slope is zero if and only if $\\mu_{1}=\\mu_{0}$, in which case $P(Z=1 \\mid Y=y)$ is constant; otherwise it varies with $y$.\n\nTherefore, $P(R=1 \\mid Y=y, X=x)$ is independent of $y$ if and only if $\\beta_{z}=0$ or $\\mu_{0}=\\mu_{1}$. No restriction on $\\beta_{x}$ is needed because $X$ is observed and its effect does not induce $y$-dependence in $P(R=1 \\mid Y=y, X=x)$.\n\nConsequently, among the options, the necessary and sufficient condition is $\\beta_{z}=0$ or $\\mu_{0}=\\mu_{1}$.", "answer": "$$\\boxed{E}$$", "id": "1936118"}]}