{"hands_on_practices": [{"introduction": "The cornerstone of Bayesian hypothesis testing is the Bayes factor, which quantifies how strongly the observed data support one hypothesis over another. This exercise provides a foundational understanding by tasking you with finding the precise \"point of indifference\" for a measurement from a normal distribution. By determining the observation value that provides equal support for two competing hypotheses, you will gain a strong intuition for how the Bayes factor measures evidence [@problem_id:1899165].", "problem": "A statistician is analyzing a measurement process and has two competing theories about a certain physical parameter $\\theta$. These theories are formulated as two simple hypotheses:\n- The null hypothesis, $H_0: \\theta = 1$.\n- The alternative hypothesis, $H_1: \\theta = 2$.\n\nTo decide between these hypotheses, a single measurement $x$ is taken. It is known from the nature of the measurement device that the observation $x$ follows a normal distribution with mean $\\theta$ and a variance of $\\sigma^2 = 1$. That is, the probability density function of observing a value $x$ given the parameter $\\theta$ is:\n$$p(x|\\theta) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(x - \\theta)^2}{2}\\right)$$\n\nIn Bayesian hypothesis testing, the evidence from the data is quantified by the Bayes factor, $B_{10}$, which is the ratio of the likelihood of the data under the alternative hypothesis to the likelihood of the data under the null hypothesis:\n$$B_{10} = \\frac{p(x|H_1)}{p(x|H_0)}$$\n\nA Bayes factor of $B_{10} = 1$ indicates that the observed data provides no evidence to prefer one hypothesis over the other.\n\nDetermine the exact numerical value of the observation $x$ that would result in a Bayes factor of exactly 1, thus providing equal support for both $H_0$ and $H_1$.", "solution": "We are given two simple hypotheses for the normal model with variance $\\sigma^{2}=1$:\n$H_{0}: \\theta=1$ and $H_{1}: \\theta=2$, with density\n$$\np(x \\mid \\theta)=\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{(x-\\theta)^{2}}{2}\\right).\n$$\nThe Bayes factor in favor of $H_{1}$ over $H_{0}$ is\n$$\nB_{10}=\\frac{p(x \\mid H_{1})}{p(x \\mid H_{0})}\n=\\frac{\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{(x-2)^{2}}{2}\\right)}{\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{(x-1)^{2}}{2}\\right)}\n=\\exp\\left(-\\frac{(x-2)^{2}-(x-1)^{2}}{2}\\right).\n$$\nTo have equal support, set $B_{10}=1$. Taking natural logarithms gives\n$$\n\\ln B_{10}=0 \\quad \\Longrightarrow \\quad -\\frac{(x-2)^{2}-(x-1)^{2}}{2}=0,\n$$\nhence\n$$\n(x-2)^{2}-(x-1)^{2}=0.\n$$\nExpand both squares:\n$$\n(x-2)^{2}=x^{2}-4x+4, \\qquad (x-1)^{2}=x^{2}-2x+1.\n$$\nSubtract:\n$$\n(x^{2}-4x+4)-(x^{2}-2x+1)=-2x+3=0.\n$$\nSolve for $x$:\n$$\n-2x+3=0 \\quad \\Longrightarrow \\quad x=\\frac{3}{2}.\n$$\nTherefore, $x=\\frac{3}{2}$ yields a Bayes factor of exactly $1$, providing equal support for $H_{0}$ and $H_{1}$.", "answer": "$$\\boxed{\\frac{3}{2}}$$", "id": "1899165"}, {"introduction": "Once we understand how to calculate the Bayes factor, the next logical step is to use it to make a decision. This practice explores the concept of a decision threshold by examining count data from a Poisson distribution. You will determine the smallest number of observed events required for the evidence to favor an alternative theory, illustrating how the Bayes factor, $B_{10}$, acts as a practical tool for favoring one hypothesis when $B_{10} \\gt 1$ [@problem_id:1899169].", "problem": "An astrophysicist is studying a specific region of the sky for high-energy neutrino events. Two competing theories are proposed to explain the observations.\n\n- The first theory, the null hypothesis ($H_0$), suggests that the events are just background noise, with an expected rate of $\\lambda_0 = 1$ event per day.\n- The second theory, the alternative hypothesis ($H_1$), posits the existence of a persistent but weak astrophysical source, leading to an expected rate of $\\lambda_1 = 4$ events per day.\n\nThe number of events observed in a single day, denoted by the random variable $X$, is assumed to follow a Poisson distribution with a mean rate of $\\lambda$. Thus, the probability mass function is given by $P(X=x|\\lambda) = \\frac{\\lambda^x \\exp(-\\lambda)}{x!}$ for $x = 0, 1, 2, \\dots$.\n\nInitially, the astrophysicist considers both theories to be equally plausible, assigning them equal prior probabilities: $P(H_0) = P(H_1) = 0.5$.\n\nTo decide which theory is better supported by the data, the astrophysicist calculates the Bayes factor, $B_{10}$, which is the ratio of the likelihood of the observed data under $H_1$ to the likelihood under $H_0$. The alternative hypothesis $H_1$ is favored over the null hypothesis $H_0$ if $B_{10} > 1$.\n\nWhat is the smallest non-negative integer value of the observed count $X$ that would cause the astrophysicist to favor the alternative hypothesis $H_1$?", "solution": "Under either hypothesis $H_{i}$ with Poisson rate $\\lambda_{i}$, the likelihood for observing $X=x$ is $P(X=x|\\lambda_{i})=\\frac{\\lambda_{i}^{x}\\exp(-\\lambda_{i})}{x!}$. The Bayes factor in favor of $H_{1}$ over $H_{0}$ for an observation $X=x$ is\n$$\nB_{10}(x)=\\frac{P(X=x|\\lambda_{1})}{P(X=x|\\lambda_{0})}\n=\\frac{\\lambda_{1}^{x}\\exp(-\\lambda_{1})/x!}{\\lambda_{0}^{x}\\exp(-\\lambda_{0})/x!}\n=\\left(\\frac{\\lambda_{1}}{\\lambda_{0}}\\right)^{x}\\exp\\!\\bigl(-(\\lambda_{1}-\\lambda_{0})\\bigr).\n$$\nWith $\\lambda_{1}=4$ and $\\lambda_{0}=1$,\n$$\nB_{10}(x)=4^{x}\\exp(-3).\n$$\nThe decision rule is to favor $H_{1}$ if $B_{10}(x)>1$. Thus we solve\n$$\n4^{x}\\exp(-3)>1 \\iff \\ln\\!\\bigl(4^{x}\\exp(-3)\\bigr)>0 \\iff x\\ln 4 - 3>0 \\iff x>\\frac{3}{\\ln 4}.\n$$\nWe now determine the smallest non-negative integer $x$ satisfying this strict inequality. We show that $\\frac{3}{\\ln 4}$ lies strictly between $2$ and $3$:\n- Since $\\exp(1)=\\sum_{k=0}^{\\infty}\\frac{1}{k!}<1+1+\\sum_{k=2}^{\\infty}\\frac{1}{2^{k-1}}=3<4$, the monotonicity of $\\exp$ implies $\\ln 4>1$. Hence $\\frac{3}{\\ln 4}<3$.\n- Using the Taylor series lower bound for $\\exp(3)$,\n$$\n\\exp(3)>\\sum_{k=0}^{4}\\frac{3^{k}}{k!}=1+3+\\frac{9}{2}+\\frac{27}{6}+\\frac{81}{24}=16+\\frac{3}{8}>16,\n$$\nso $\\exp\\!\\left(\\frac{3}{2}\\right)=\\sqrt{\\exp(3)}>4$, which implies $\\ln 4<\\frac{3}{2}$. Hence $\\frac{3}{\\ln 4}>2$.\n\nTherefore $2<\\frac{3}{\\ln 4}<3$, and the smallest integer $x$ satisfying $x>\\frac{3}{\\ln 4}$ is $x=3$.", "answer": "$$\\boxed{3}$$", "id": "1899169"}, {"introduction": "The ultimate goal of Bayesian inference is to update our beliefs in light of new evidence. This final practice brings together all the key components: prior beliefs, data, and posterior beliefs. You will calculate the minimum amount of evidence—in this case, a series of consecutive successes in Bernoulli trials—needed to shift an initial 50/50 belief to a posterior probability that surpasses a 0.95 confidence threshold, demonstrating the full power of the Bayesian updating process [@problem_id:1899173].", "problem": "A materials science lab is developing a new alloy designed to be resistant to a specific type of stress fracture. The existing standard alloy fails under a specific stress test with a probability of $0.6$, meaning it succeeds with a probability of $0.4$. The new alloy is theorized to be superior, with an expected success probability of $0.6$. However, due to the complexities of the manufacturing process, it's also possible that the new alloy is no better than the old one.\n\nBefore committing to expensive large-scale production, the research team holds an initial belief that there is a 50% chance the new alloy's true success probability is $0.6$ and a 50% chance its true success probability is merely $0.4$. They decide to conduct a series of preliminary stress tests on samples of the new alloy.\n\nWhat is the minimum number of consecutive successful tests (i.e., tests where the alloy does not fracture) that the team must observe to update their belief, such that the probability they assign to the alloy's true success rate being $0.6$ is greater than $0.95$?", "solution": "Let $H_{1}$ denote that the true success probability is $0.6$ and $H_{0}$ denote that it is $0.4$. The priors are $P(H_{1})=P(H_{0})=\\frac{1}{2}$. For $n$ independent tests with all successes observed, the likelihoods are\n$$\nP(\\text{data}\\mid H_{1})=(0.6)^{n},\\qquad P(\\text{data}\\mid H_{0})=(0.4)^{n}.\n$$\nBy Bayes’ theorem, the posterior for $H_{1}$ given $n$ successes is\n$$\nP(H_{1}\\mid \\text{data})=\\frac{P(\\text{data}\\mid H_{1})P(H_{1})}{P(\\text{data}\\mid H_{1})P(H_{1})+P(\\text{data}\\mid H_{0})P(H_{0})}\n=\\frac{(0.6)^{n}}{(0.6)^{n}+(0.4)^{n}}\n=\\frac{1}{1+\\left(\\frac{0.4}{0.6}\\right)^{n}}\n=\\frac{1}{1+\\left(\\frac{2}{3}\\right)^{n}}.\n$$\nWe require $P(H_{1}\\mid \\text{data})>0.95$, so\n$$\n\\frac{1}{1+\\left(\\frac{2}{3}\\right)^{n}}> \\frac{19}{20}\n\\;\\;\\Longleftrightarrow\\;\\;\n1+\\left(\\frac{2}{3}\\right)^{n}<\\frac{20}{19}\n\\;\\;\\Longleftrightarrow\\;\\;\n\\left(\\frac{2}{3}\\right)^{n}<\\frac{1}{19}.\n$$\nTaking natural logarithms (noting $\\ln\\!\\left(\\frac{2}{3}\\right)<0$) gives\n$$\nn>\\frac{\\ln\\!\\left(\\frac{1}{19}\\right)}{\\ln\\!\\left(\\frac{2}{3}\\right)}=\\frac{\\ln(19)}{\\ln\\!\\left(\\frac{3}{2}\\right)}.\n$$\nTo find the minimal integer $n$, check $n=7$ and $n=8$ exactly:\n$$\n\\left(\\frac{2}{3}\\right)^{7}=\\frac{128}{2187}\\quad\\text{and}\\quad 19\\cdot 128=2432>2187\\;\\Rightarrow\\;\\left(\\frac{2}{3}\\right)^{7}>\\frac{1}{19},\n$$\nso $P(H_{1}\\mid \\text{data})<\\frac{19}{20}=0.95$ for $n=7$. Next,\n$$\n\\left(\\frac{2}{3}\\right)^{8}=\\frac{256}{6561}\\quad\\text{and}\\quad 19\\cdot 256=4864<6561\\;\\Rightarrow\\;\\left(\\frac{2}{3}\\right)^{8}<\\frac{1}{19},\n$$\nso $P(H_{1}\\mid \\text{data})>\\frac{19}{20}=0.95$ for $n=8$. Therefore, the minimum number of consecutive successes required is $8$.", "answer": "$$\\boxed{8}$$", "id": "1899173"}]}