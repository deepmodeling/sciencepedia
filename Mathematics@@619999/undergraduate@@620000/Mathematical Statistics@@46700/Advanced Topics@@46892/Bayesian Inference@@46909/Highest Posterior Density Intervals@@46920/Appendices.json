{"hands_on_practices": [{"introduction": "To truly master the concept of a Highest Posterior Density Interval (HPDI), we must move beyond a simple verbal definition and understand its precise mathematical properties. For any unimodal posterior distribution, the HPDI is defined by two key conditions. This exercise challenges you to articulate these conditions, reinforcing the fundamental principles that make the HPDI the shortest possible interval for a given posterior probability [@problem_id:1921049].", "problem": "A Bayesian statistical analysis is performed to estimate an unknown population proportion, represented by the parameter $p$, where $0  p  1$. After collecting and analyzing data, the resulting posterior distribution for $p$ is identified as a Beta distribution with parameters $\\alpha=3$ and $\\beta=9$.\n\nRecall that the probability density function (PDF) for a parameter $\\theta$ following a Beta distribution with shape parameters $\\alpha$ and $\\beta$, denoted $\\text{Beta}(\\alpha, \\beta)$, is given by:\n$$f(\\theta | \\alpha, \\beta) = \\frac{\\theta^{\\alpha-1}(1-\\theta)^{\\beta-1}}{B(\\alpha, \\beta)}$$\nfor $0  \\theta  1$. Here, $B(\\alpha, \\beta)$ is the Beta function, which serves as a normalizing constant.\n\nWe want to find the 95% Highest Posterior Density Interval (HPDI) for the parameter $p$. A 95% HPDI is defined as the interval $[L, U]$ which contains 95% of the posterior probability mass and has the shortest possible length. For a unimodal posterior distribution like the one given, this implies a specific relationship between the posterior density at the lower bound $L$ and the upper bound $U$.\n\nWhich of the following pairs of equations correctly and completely defines the endpoints $L$ and $U$ for the 95% HPDI of the posterior distribution $\\text{Beta}(3, 9)$?\n\nA. $\\int_L^U p^2 (1-p)^8 \\, dp = 0.95$ and $U - L = 0.95$\n\nB. $\\int_L^U \\frac{p^2 (1-p)^8}{B(3,9)} \\, dp = 0.95$ and $L^2 (1-L)^8 = U^2 (1-U)^8$\n\nC. $\\int_0^L \\frac{p^2 (1-p)^8}{B(3,9)} \\, dp = 0.025$ and $\\int_U^1 \\frac{p^2 (1-p)^8}{B(3,9)} \\, dp = 0.025$\n\nD. $\\int_L^U p^2 (1-p)^8 \\, dp = 0.95$ and $L = 0.025$\n\nE. $\\int_L^U \\frac{p^2 (1-p)^8}{B(3,9)} \\, dp = 0.95$ and $L=U$", "solution": "The posterior density for $p$ under $\\text{Beta}(3,9)$ is\n$$\nf(p)=\\frac{p^{2}(1-p)^{8}}{B(3,9)}, \\quad 0p1.\n$$\nA $0.95$ Highest Posterior Density Interval (HPDI) for a unimodal posterior is defined as the interval $[L,U]$ that:\n1) Contains probability mass $0.95$, which requires\n$$\n\\int_{L}^{U} f(p)\\,dp=\\int_{L}^{U} \\frac{p^{2}(1-p)^{8}}{B(3,9)}\\,dp=0.95,\n$$\nbecause the integral of the normalized density over the interval must equal the desired posterior probability.\n2) Has endpoints at equal posterior density (constant-density threshold defining the HPDI), which requires\n$$\nf(L)=f(U) \\quad \\Longleftrightarrow \\quad \\frac{L^{2}(1-L)^{8}}{B(3,9)}=\\frac{U^{2}(1-U)^{8}}{B(3,9)} \\quad \\Longleftrightarrow \\quad L^{2}(1-L)^{8}=U^{2}(1-U)^{8}.\n$$\nThese two equations together uniquely define $L$ and $U$ for the $0.95$ HPDI. This corresponds exactly to option B. Options A and D incorrectly omit the normalizing constant in the probability condition (and include incorrect additional constraints), option C gives equal-tailed rather than highest-density conditions, and option E is degenerate.", "answer": "$$\\boxed{B}$$", "id": "1921049"}, {"introduction": "In modern Bayesian analysis, we often work with posterior distributions that are too complex to describe with a simple formula. Instead, we generate a large set of samples from the distribution using methods like Markov Chain Monte Carlo (MCMC). This next practice shifts our focus from theory to computation, asking you to devise an algorithm to estimate an HPDI from a set of posterior samples, a crucial skill for any practicing data scientist [@problem_id:1921054].", "problem": "A researcher is using Bayesian inference to study a parameter $\\theta$, which represents the average effectiveness of a new learning algorithm. After running a Markov Chain Monte Carlo (MCMC) simulation, she obtains a large number of samples, $\\{\\theta_1, \\theta_2, \\dots, \\theta_N\\}$, drawn from the posterior distribution of $\\theta$. For her analysis, she needs to compute the 95% Highest Posterior Density Interval (HPDI). The HPDI is defined as the shortest possible interval that contains 95% of the posterior probability mass.\n\nGiven that she has the set of $N$ posterior samples, which of the following algorithms correctly estimates the 95% HPDI?\n\nA.\n1. Sort the samples in ascending order to get $\\{\\theta_{(1)}, \\theta_{(2)}, \\dots, \\theta_{(N)}\\}$.\n2. Let $k = \\lceil 0.95 \\times N \\rceil$.\n3. Consider all intervals of the form $[\\theta_{(i)}, \\theta_{(i+k-1)}]$ for $i=1, \\dots, N-k+1$.\n4. Choose the interval for which the width, $\\theta_{(i+k-1)} - \\theta_{(i)}$, is minimized.\n\nB.\n1. Sort the samples in ascending order to get $\\{\\theta_{(1)}, \\theta_{(2)}, \\dots, \\theta_{(N)}\\}$.\n2. Calculate the lower bound index $l = \\lfloor 0.025 \\times N \\rfloor$ and the upper bound index $u = \\lceil 0.975 \\times N \\rceil$.\n3. The interval is given by $[\\theta_{(l)}, \\theta_{(u)}]$.\n\nC.\n1. Calculate the sample mean $\\bar{\\theta} = \\frac{1}{N} \\sum_{i=1}^N \\theta_i$ and the sample standard deviation $s = \\sqrt{\\frac{1}{N-1} \\sum_{i=1}^N (\\theta_i - \\bar{\\theta})^2}$.\n2. The interval is given by $[\\bar{\\theta} - 1.96 s, \\bar{\\theta} + 1.96 s]$.\n\nD.\n1. Sort the samples and find the median, $\\theta_{\\text{median}} = \\theta_{(\\lceil N/2 \\rceil)}$.\n2. Find the smallest value $w$ such that the interval $[\\theta_{\\text{median}} - w, \\theta_{\\text{median}} + w]$ contains exactly 95% of the samples.\n\nE.\n1. Estimate the mode (the value with the highest frequency) of the samples, $\\theta_{\\text{mode}}$.\n2. Find the smallest value $w$ such that the interval $[\\theta_{\\text{mode}} - w, \\theta_{\\text{mode}} + w]$ contains exactly 95% of the samples.", "solution": "We are given posterior samples $\\{\\theta_{1},\\dots,\\theta_{N}\\}$ from the posterior distribution of $\\theta$. The $0.95$ Highest Posterior Density Interval (HPDI) is, by definition, the interval of minimal width that contains posterior probability mass $0.95$. For a continuous unimodal posterior density $p(\\theta\\mid\\text{data})$, the HPDI can be characterized as\n$$\nI^{\\ast}=\\arg\\min_{I:\\ \\int_{I} p(\\theta\\mid\\text{data})\\,d\\theta=0.95}\\ \\text{length}(I),\n$$\nand the HPDI consists of all points where the density exceeds a threshold chosen so that the mass inside equals $0.95$. With posterior samples, we approximate this by finding the shortest interval that contains a fraction $0.95$ of the samples.\n\nTo implement this from samples, proceed as follows.\n\n1. Sort the samples to obtain order statistics $\\{\\theta_{(1)},\\dots,\\theta_{(N)}\\}$.\n\n2. Let $k=\\lceil 0.95 N\\rceil$. Any interval that contains at least $0.95$ of the posterior mass should, under the empirical distribution of the samples, contain at least $k$ samples. Among all such empirical intervals, the shortest candidate intervals are precisely those whose endpoints are adjacent order statistics spanning exactly $k$ samples, i.e., intervals of the form $[\\theta_{(i)},\\theta_{(i+k-1)}]$ for $i=1,\\dots,N-k+1$.\n\n3. For each $i$, compute the width\n$$\nw_{i}=\\theta_{(i+k-1)}-\\theta_{(i)}.\n$$\nSelect the interval with minimal $w_{i}$. This interval is the empirical shortest interval containing at least $0.95$ of the samples, which is the standard sample-based estimator of the $0.95$ HPDI.\n\nThis procedure is exactly Algorithm A.\n\nNow we verify why the other options do not generally produce the HPDI.\n\n- Option B constructs the equal-tailed interval using empirical quantiles at $0.025$ and $0.975$. This yields a central or equal-tailed credible interval, which is not guaranteed to be the shortest interval covering probability $0.95$ when the posterior is asymmetric or multimodal. Therefore it is not, in general, the HPDI.\n\n- Option C uses $\\bar{\\theta}\\pm 1.96\\,s$, which assumes approximate normality and constructs a symmetric interval centered at the mean. This is a normal-approximation credible interval, not the HPDI in general, especially for non-normal or skewed posteriors.\n\n- Option D centers the interval at the median and enforces symmetry. The HPDI need not be symmetric nor centered at the median; enforcing symmetry can produce a wider interval than necessary, so this is not the general HPDI.\n\n- Option E centers the interval at the mode and enforces symmetry. While the HPDI often includes the mode for unimodal posteriors, it is not necessarily symmetric unless the posterior itself is symmetric. Enforcing symmetry can again make the interval suboptimal in width, so this is not the general HPDI.\n\nTherefore, only Algorithm A correctly estimates the $0.95$ HPDI from posterior samples in general.", "answer": "$$\\boxed{A}$$", "id": "1921054"}, {"introduction": "A statistical result is only as good as the model that produced it, and a critical part of a statistician's job is to ensure that their models respect known physical realities. This final practice presents a scenario where a calculated HPDI for a physical constant, $\\lambda$, includes values that are impossible in the real world. Your task is to diagnose the fundamental error, a valuable lesson in the importance of model validation and the role of prior distributions in encoding essential background knowledge [@problem_id:1921065].", "problem": "A physics student is analyzing data from an experiment designed to measure the decay constant, $\\lambda$, of a newly discovered radioactive isotope. From first principles, the decay constant must be a strictly positive value, i.e., $\\lambda > 0$. The student employs a Bayesian statistical approach to analyze the measurements. After computing the posterior distribution for $\\lambda$ based on the experimental data and a chosen prior, the student reports that the 95% Highest Posterior Density Interval (HPDI) for the decay constant is $[-0.23, 4.81]$.\n\nWithout any information about the student's data, likelihood function, or specific computational methods, which of the following statements best identifies the fundamental error demonstrated by this result?\n\nA. The interval is far too wide. For a 95% interval, one would expect a much smaller range for a precisely measured physical constant.\nB. The student likely confused the HPDI with a symmetric quantile-based interval. An HPDI is defined as the narrowest possible interval and is often asymmetric for skewed posterior distributions.\nC. The interval contains values that are physically impossible for a decay constant. This indicates a critical flaw in the formulation of the Bayesian model itself, most likely an inappropriate choice of prior distribution.\nD. This result is plausible. By definition, a 95% interval means there is a 5% probability that the true value of $\\lambda$ lies outside the interval, so an unusual-looking range can occur by chance.", "solution": "We begin with the physical constraint for the decay constant: by first principles, the decay rate must satisfy $\\lambda0$. In a Bayesian analysis, this constraint must be enforced through the model, typically via the prior support.\n\nLet the prior density be $p(\\lambda)$ and the likelihood for data $y$ be $p(y \\mid \\lambda)$. The posterior is given by Bayes’ rule:\n$$\np(\\lambda \\mid y) = \\frac{p(y \\mid \\lambda)\\,p(\\lambda)}{\\int p(y \\mid \\lambda')\\,p(\\lambda')\\,d\\lambda'} \\propto p(y \\mid \\lambda)\\,p(\\lambda).\n$$\nThe support of the posterior is contained within the intersection of the supports of the prior and the likelihood. In particular, if the prior encodes the physical constraint by setting $p(\\lambda)=0$ for $\\lambda \\leq 0$, then for any data $y$,\n$$\np(\\lambda \\mid y) = 0 \\quad \\text{for all } \\lambda \\leq 0.\n$$\nA $0.95$ Highest Posterior Density Interval (HPDI) is defined as a set\n$$\nI_{0.95} = \\{\\lambda : p(\\lambda \\mid y) \\geq c\\}\n$$\nfor some threshold $c$ chosen such that\n$$\n\\int_{I_{0.95}} p(\\lambda \\mid y)\\,d\\lambda = 0.95,\n$$\nand it is, by construction, a subset of the support of the posterior. Therefore, if the posterior assigns zero probability to $\\lambda \\leq 0$, then any valid HPDI must satisfy\n$$\nI_{0.95} \\subset (0,\\infty).\n$$\nThe reported HPDI $[-0.23,4.81]$ includes negative values, which implies that the computed posterior assigns nonzero probability to $\\lambda \\leq 0$. This is incompatible with the known physical constraint $\\lambda0$ if the model were correctly specified. Hence, the fundamental error is that the Bayesian model failed to enforce the physical support constraint, most plausibly due to an inappropriate prior (e.g., one with support on the real line) or an equivalent modeling oversight.\n\nEvaluating the options:\n- A is not justified without information on data precision; width alone does not identify a fundamental error.\n- B is a misunderstanding of the core issue; even a symmetric quantile interval should not include values outside the posterior support if the model is properly constrained.\n- C correctly identifies that the interval contains physically impossible values, signaling a flaw in the Bayesian model specification, most likely the prior not restricting $\\lambda$ to be positive.\n- D misapplies the interpretation of a $0.95$ posterior interval; the issue is not chance but violation of known support.\n\nTherefore, the best choice is C.", "answer": "$$\\boxed{C}$$", "id": "1921065"}]}