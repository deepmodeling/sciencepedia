{"hands_on_practices": [{"introduction": "The foundation of the Kolmogorov-Smirnov two-sample test lies in comparing the empirical cumulative distribution functions (ECDFs) of two datasets. This first exercise provides direct, hands-on practice in computing the test statistic, $D_{n,m}$, which is the maximum vertical distance between these two functions. Mastering this calculation is the essential first step to understanding how the KS test quantifies the difference between two sample distributions. [@problem_id:1928076]", "problem": "A coffee shop manager is analyzing customer waiting times for two different ordering systems. System A is the traditional counter service, and System B is a new self-service kiosk. To compare the distributions of waiting times, the manager collects two small, independent random samples of waiting times, recorded in minutes.\n\nThe sample from System A, with $n=4$ customers, is $S_A = \\{3.5, 5.1, 2.8, 4.3\\}$.\nThe sample from System B, with $m=5$ customers, is $S_B = \\{4.8, 3.9, 5.5, 6.0, 4.1\\}$.\n\nThe manager decides to use the two-sample Kolmogorov-Smirnov (KS) test to assess if the two samples come from the same underlying distribution. The test statistic, denoted as $D_{n,m}$, is defined as the maximum absolute difference between the Empirical Distribution Functions (EDFs) of the two samples.\n\nThe EDF for a sample $X = \\{x_1, \\dots, x_k\\}$ of size $k$ is given by $F_k(t) = \\frac{1}{k} \\times (\\text{number of observations in } X \\text{ less than or equal to } t)$.\nThe KS statistic is then $D_{n,m} = \\sup_{t} |F_n(t) - G_m(t)|$, where $F_n(t)$ is the EDF for sample $S_A$ and $G_m(t)$ is the EDF for sample $S_B$.\n\nCalculate the value of the KS test statistic $D_{4,5}$ for the given data. Express your answer as an exact fraction in simplest form.", "solution": "We are given two independent samples, $S_A$ with size $n=4$ and $S_B$ with size $m=5$. The empirical distribution functions (EDFs) are defined by\n$$\nF_{n}(t)=\\frac{1}{n}\\times\\left(\\text{number of observations in }S_{A}\\text{ with }x\\leq t\\right),\\quad\nG_{m}(t)=\\frac{1}{m}\\times\\left(\\text{number of observations in }S_{B}\\text{ with }y\\leq t\\right).\n$$\nThe two-sample Kolmogorov-Smirnov statistic is\n$$\nD_{n,m}=\\sup_{t}\\left|F_{n}(t)-G_{m}(t)\\right|.\n$$\nSince EDFs are right-continuous step functions with jumps at sample points, the supremum occurs at points $t$ in the combined set of sample values (and equivalently on intervals immediately before those jumps). Therefore, it suffices to evaluate $\\left|F_{n}(t)-G_{m}(t)\\right|$ at the sorted combined sample values and, if desired, just before these points.\n\nSort the samples:\n- $S_A=\\{2.8, 3.5, 4.3, 5.1\\}$\n- $S_B=\\{3.9, 4.1, 4.8, 5.5, 6.0\\}$\nThe combined sorted unique values are\n$$\nt\\in\\{2.8, 3.5, 3.9, 4.1, 4.3, 4.8, 5.1, 5.5, 6.0\\}.\n$$\n\nCompute $F_{4}(t)$ and $G_{5}(t)$ and their absolute differences at each $t$:\n- At $t=2.8$: $F_{4}(2.8)=\\frac{1}{4}$, $G_{5}(2.8)=0$, difference $=\\frac{1}{4}$.\n- At $t=3.5$: $F_{4}(3.5)=\\frac{2}{4}=\\frac{1}{2}$, $G_{5}(3.5)=0$, difference $=\\frac{1}{2}$.\n- At $t=3.9$: $F_{4}(3.9)=\\frac{1}{2}$, $G_{5}(3.9)=\\frac{1}{5}$, difference $=\\left|\\frac{1}{2}-\\frac{1}{5}\\right|=\\frac{3}{10}$.\n- At $t=4.1$: $F_{4}(4.1)=\\frac{1}{2}$, $G_{5}(4.1)=\\frac{2}{5}$, difference $=\\left|\\frac{1}{2}-\\frac{2}{5}\\right|=\\frac{1}{10}$.\n- At $t=4.3$: $F_{4}(4.3)=\\frac{3}{4}$, $G_{5}(4.3)=\\frac{2}{5}$, difference $=\\left|\\frac{3}{4}-\\frac{2}{5}\\right|=\\frac{7}{20}$.\n- At $t=4.8$: $F_{4}(4.8)=\\frac{3}{4}$, $G_{5}(4.8)=\\frac{3}{5}$, difference $=\\left|\\frac{3}{4}-\\frac{3}{5}\\right|=\\frac{3}{20}$.\n- At $t=5.1$: $F_{4}(5.1)=1$, $G_{5}(5.1)=\\frac{3}{5}$, difference $=\\left|1-\\frac{3}{5}\\right|=\\frac{2}{5}$.\n- At $t=5.5$: $F_{4}(5.5)=1$, $G_{5}(5.5)=\\frac{4}{5}$, difference $=\\left|1-\\frac{4}{5}\\right|=\\frac{1}{5}$.\n- At $t=6.0$: $F_{4}(6.0)=1$, $G_{5}(6.0)=1$, difference $=0$.\n\nTo ensure the supremum over all $t$, also note the values just before each jump are the left limits of these right-continuous steps. The largest such value occurs on the interval just before $t=3.9$, where $F_{4}=\\frac{1}{2}$ and $G_{5}=0$, giving difference $\\frac{1}{2}$, which matches the maximum found at $t=3.5$.\n\nTherefore, the Kolmogorov-Smirnov statistic is\n$$\nD_{4,5}=\\frac{1}{2}.\n$$", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1928076"}, {"introduction": "After learning to calculate the KS statistic, the next crucial skill is interpretation. This conceptual problem explores an extreme but highly informative scenario: what does it mean when the KS statistic, $D_{n,m}$, is exactly zero? By analyzing this special case, you will gain a more precise understanding of what the ECDF represents and what a perfect match between two sample distributions mathematically implies. [@problem_id:1928083]", "problem": "In the field of non-parametric statistics, the two-sample Kolmogorov-Smirnov (K-S) test is used to determine if two independent samples are drawn from the same underlying distribution. The test is based on the K-S statistic, $D_{n,m}$, which is defined as the maximum absolute difference between the empirical cumulative distribution functions (ECDFs) of the two samples.\n\nLet sample $X = \\{x_1, x_2, \\dots, x_n\\}$ have $n$ observations, and sample $Y = \\{y_1, y_2, \\dots, y_m\\}$ have $m$ observations. Their respective ECDFs are denoted by $F_n(t)$ and $G_m(t)$. The K-S statistic is given by:\n$$D_{n,m} = \\sup_{t} |F_n(t) - G_m(t)|$$\nwhere $\\sup_t$ is the supremum over all possible values of $t$.\n\nSuppose after collecting two samples, a statistician calculates the K-S statistic and finds that its value is exactly zero, i.e., $D_{n,m} = 0$. Which of the following is the most specific and mathematically necessary conclusion that can be drawn about the relationship between the samples $X$ and $Y$?\n\nA. The two samples must be identical, meaning they are the same multiset of values.\n\nB. The two samples must have the same mean and the same median.\n\nC. The two samples must have been drawn from the same underlying continuous probability distribution.\n\nD. The set of unique values is identical in both samples, and the proportion (relative frequency) of each unique value is identical in both samples.\n\nE. The sizes of the two samples must be equal (i.e., $n=m$).", "solution": "By definition, the empirical cumulative distribution functions (ECDFs) of samples $X=\\{x_1,\\dots,x_n\\}$ and $Y=\\{y_1,\\dots,y_m\\}$ are\n$$\nF_n(t)=\\frac{1}{n}\\sum_{i=1}^{n}\\mathbf{1}\\{x_i\\le t\\},\\qquad\nG_m(t)=\\frac{1}{m}\\sum_{j=1}^{m}\\mathbf{1}\\{y_j\\le t\\}.\n$$\nThe two-sample Kolmogorov-Smirnov statistic is\n$$\nD_{n,m}=\\sup_{t}|F_n(t)-G_m(t)|.\n$$\nIf $D_{n,m}=0$, then $\\sup_{t}|F_n(t)-G_m(t)|=0$. Since $|F_n(t)-G_m(t)|\\ge 0$ for all $t$, the supremum being zero implies $|F_n(t)-G_m(t)|=0$ for every $t$, hence\n$$\nF_n(t)=G_m(t)\\quad\\text{for all }t\\in\\mathbb{R}.\n$$\n\nAn ECDF is a right-continuous step function with jumps at the observed sample values. Let $S$ denote the set of all values $v$ at which either sample places mass. For any $v\\in S$, denote by $k_{X}(v)$ the count of occurrences of $v$ in $X$ and by $k_{Y}(v)$ the count in $Y$. The size of the jump of $F_n$ at $v$ is\n$$\n\\Delta F_n(v)=\\lim_{t\\downarrow v}F_n(t)-\\lim_{t\\uparrow v}F_n(t)=\\frac{k_{X}(v)}{n},\n$$\nand similarly the jump of $G_m$ at $v$ is $\\Delta G_m(v)=\\frac{k_{Y}(v)}{m}$. Equality $F_n\\equiv G_m$ as functions implies that:\n- they have jumps at exactly the same locations (otherwise the functions would differ in a neighborhood of a point), so the set of unique values present in $X$ equals that in $Y$;\n- the jump sizes at each such location must be equal, hence for every $v$,\n$$\n\\frac{k_{X}(v)}{n}=\\frac{k_{Y}(v)}{m}.\n$$\nEquivalently, the relative frequency of each unique value $v$ is identical across the two samples. This is precisely the statement that the empirical measures coincide:\n$$\n\\frac{1}{n}\\sum_{i=1}^{n}\\delta_{x_i}=\\frac{1}{m}\\sum_{j=1}^{m}\\delta_{y_j}.\n$$\n\nWe now assess the options:\n\n- A is not necessary: equality of ECDFs requires equality of relative frequencies, not of raw counts. For instance, one can have $k_{X}(v)=1$ and $k_{Y}(v)=2$ for some $v$ provided $\\frac{1}{n}=\\frac{2}{m}$; thus the multisets need not be identical.\n- B is true but not the most specific: equal ECDFs imply equal empirical means and medians, but this is strictly weaker than identifying the entire empirical distribution.\n- C is not necessary: $D_{n,m}=0$ only asserts equality of the empirical distributions realized in the samples, not that the underlying generating distributions are the same, and certainly not that they are continuous.\n- D matches exactly the necessary and sufficient condition derived above: the sets of unique values and their relative frequencies coincide.\n- E is not necessary: as noted, it is possible that $n\\ne m$ while $\\frac{k_{X}(v)}{n}=\\frac{k_{Y}(v)}{m}$ holds for all $v$.\n\nTherefore, the most specific and mathematically necessary conclusion is D.", "answer": "$$\\boxed{D}$$", "id": "1928083"}, {"introduction": "To fully grasp the scale and sensitivity of the KS test, we must understand its theoretical boundaries. This exercise challenges you to determine the maximum possible value of the normalized KS statistic, $S_{n,m}$, for any two samples of a given size. This thought experiment will deepen your intuition for what constitutes a maximal difference between samples and illustrates the normalization used to make the statistic's distribution independent of the underlying population distribution for hypothesis testing. [@problem_id:1928079]", "problem": "In statistical analysis, the two-sample Kolmogorov-Smirnov (K-S) test is a non-parametric test used to determine if two independent samples are drawn from the same underlying continuous distribution. The test quantifies a distance between the empirical distribution functions of the two samples.\n\nAn empirical distribution function (EDF) for a sample of $k$ observations $\\{z_1, z_2, \\dots, z_k\\}$ is defined as $E_k(x) = \\frac{1}{k} \\sum_{i=1}^{k} \\mathbf{1}\\{z_i \\le x\\}$, where $\\mathbf{1}\\{\\cdot\\}$ is the indicator function which is 1 if its argument is true and 0 otherwise.\n\nLet's consider two independent samples: sample $X$ with $n$ observations $\\{X_1, X_2, \\dots, X_n\\}$ and sample $Y$ with $m$ observations $\\{Y_1, Y_2, \\dots, Y_m\\}$. Let their respective EDFs be $F_n(x)$ and $G_m(x)$. We define a normalized K-S statistic, $S_{n,m}$, as:\n$$S_{n,m} = \\sqrt{\\frac{nm}{n+m}} \\sup_{x} |F_n(x) - G_m(x)|$$\n\nGiven fixed, positive integer sample sizes $n$ and $m$, what is the maximum possible value that the statistic $S_{n,m}$ can attain over all possible pairs of samples $X$ and $Y$? Express your answer as a closed-form analytic expression in terms of $n$ and $m$.", "solution": "We seek the maximum possible value of the statistic\n$$\nS_{n,m}=\\sqrt{\\frac{nm}{n+m}}\\sup_{x}\\left|F_{n}(x)-G_{m}(x)\\right|\n$$\nover all possible samples of fixed sizes $n$ and $m$. Define\n$$\nD_{n,m}\\equiv \\sup_{x}\\left|F_{n}(x)-G_{m}(x)\\right|.\n$$\nBy definition of empirical distribution functions, for every $x$,\n$$\n0\\leq F_{n}(x)\\leq 1,\\quad 0\\leq G_{m}(x)\\leq 1,\n$$\nhence\n$$\n\\left|F_{n}(x)-G_{m}(x)\\right|\\leq 1\\quad\\text{for all }x,\n$$\nwhich implies\n$$\nD_{n,m}\\leq 1.\n$$\nTo show this upper bound is attainable, construct samples that are completely separated. For example, take $X_i=0$ for all $i\\in\\{1,\\dots,n\\}$ and $Y_j=1$ for all $j\\in\\{1,\\dots,m\\}$. Then for any $x$ with $0\\leq x1$,\n$$\nF_{n}(x)=\\frac{1}{n}\\sum_{i=1}^{n}\\mathbf{1}\\{0\\leq x\\}=1,\\qquad G_{m}(x)=\\frac{1}{m}\\sum_{j=1}^{m}\\mathbf{1}\\{1\\leq x\\}=0,\n$$\nso $\\left|F_{n}(x)-G_{m}(x)\\right|=1$ and thus $D_{n,m}=1$. Therefore, the maximum possible value of $D_{n,m}$ over all pairs of samples is $1$.\n\nSubstituting this into the definition of $S_{n,m}$ yields that the maximum of $S_{n,m}$ is\n$$\n\\sqrt{\\frac{nm}{n+m}}\\cdot 1=\\sqrt{\\frac{nm}{n+m}}.\n$$\nThis is a closed-form expression in terms of $n$ and $m$.", "answer": "$$\\boxed{\\sqrt{\\frac{nm}{n+m}}}$$", "id": "1928079"}]}