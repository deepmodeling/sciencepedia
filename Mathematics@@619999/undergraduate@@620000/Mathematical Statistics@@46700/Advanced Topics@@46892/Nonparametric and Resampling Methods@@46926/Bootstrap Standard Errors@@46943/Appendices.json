{"hands_on_practices": [{"introduction": "Let's begin with the most common application of the bootstrap: estimating the standard error of the sample mean. This hands-on exercise [@problem_id:1902064] walks you through the core mechanics of resampling from a small dataset to quantify the uncertainty in your estimate. This process of creating new samples from an existing one to understand statistical variability is a foundational skill in modern data analysis.", "problem": "An environmental scientist is assessing the concentration of a specific pollutant, \"Compound X\", in a river. A small sample of five water measurements is collected, yielding the following concentrations in Parts Per Million (PPM):\n$$ S = \\{10.2, 11.5, 9.8, 12.1, 10.9\\} $$\nTo estimate the variability of the sample mean concentration, a bootstrap procedure is employed. From the original sample $S$, four bootstrap samples, each of size five, are generated by sampling with replacement. The resulting bootstrap samples are:\n- Bootstrap Sample 1: $\\{10.2, 12.1, 9.8, 10.2, 11.5\\}$\n- Bootstrap Sample 2: $\\{11.5, 11.5, 10.9, 9.8, 12.1\\}$\n- Bootstrap Sample 3: $\\{9.8, 12.1, 12.1, 10.9, 10.2\\}$\n- Bootstrap Sample 4: $\\{10.9, 10.2, 9.8, 11.5, 10.9\\}$\n\nBased on these four bootstrap samples, calculate the bootstrap standard error of the sample mean. Express your final answer in PPM, rounded to three significant figures.", "solution": "The bootstrap standard error of the sample mean is the standard deviation of the bootstrap means. For bootstrap replicates $b=1,\\dots,B$ with $B=4$, let $\\bar{x}^{*(b)}$ be the mean of bootstrap sample $b$, and let $\\bar{\\bar{x}}^{*}=\\frac{1}{B}\\sum_{b=1}^{B}\\bar{x}^{*(b)}$ be the average of the bootstrap means. The bootstrap standard error is\n$$\n\\operatorname{SE}_{\\text{boot}}=\\sqrt{\\frac{1}{B-1}\\sum_{b=1}^{B}\\left(\\bar{x}^{*(b)}-\\bar{\\bar{x}}^{*}\\right)^{2}}.\n$$\nCompute the bootstrap means:\n- Bootstrap 1: sum $=10.2+12.1+9.8+10.2+11.5=53.8$, so $\\bar{x}^{*(1)}=\\frac{53.8}{5}=10.76$.\n- Bootstrap 2: sum $=11.5+11.5+10.9+9.8+12.1=55.8$, so $\\bar{x}^{*(2)}=\\frac{55.8}{5}=11.16$.\n- Bootstrap 3: sum $=9.8+12.1+12.1+10.9+10.2=55.1$, so $\\bar{x}^{*(3)}=\\frac{55.1}{5}=11.02$.\n- Bootstrap 4: sum $=10.9+10.2+9.8+11.5+10.9=53.3$, so $\\bar{x}^{*(4)}=\\frac{53.3}{5}=10.66$.\n\nAverage of bootstrap means:\n$$\n\\bar{\\bar{x}}^{*}=\\frac{10.76+11.16+11.02+10.66}{4}=10.9.\n$$\nCompute squared deviations:\n$$\n(10.76-10.9)^{2}=0.0196,\\quad (11.16-10.9)^{2}=0.0676,\\quad (11.02-10.9)^{2}=0.0144,\\quad (10.66-10.9)^{2}=0.0576,\n$$\nso\n$$\n\\sum_{b=1}^{4}\\left(\\bar{x}^{*(b)}-\\bar{\\bar{x}}^{*}\\right)^{2}=0.0196+0.0676+0.0144+0.0576=0.1592.\n$$\nThus,\n$$\n\\operatorname{SE}_{\\text{boot}}=\\sqrt{\\frac{0.1592}{4-1}}=\\sqrt{0.053066\\overline{6}}\\approx 0.230362\\ldots\n$$\nRounded to three significant figures, the bootstrap standard error is $0.230$ in PPM.", "answer": "$$\\boxed{0.230}$$", "id": "1902064"}, {"introduction": "One of the great strengths of the bootstrap is its ability to estimate uncertainty for statistics that lack simple analytical formulas. This problem [@problem_id:1902091] moves beyond the mean to the interquartile range (IQR), a robust measure of spread. By working through this example, you will see how the bootstrap's empirical approach can be applied to virtually any sample statistic, making it an incredibly versatile tool.", "problem": "A data analyst is studying the volatility of house prices in a small neighborhood. They have collected a small random sample of 5 recent sale prices. The prices, in thousands of dollars, are:\n\n$$ S = \\{420, 650, 350, 400, 500\\} $$\n\nThe analyst is interested in the sampling variability of the Interquartile Range (IQR), which is a robust measure of statistical dispersion. To estimate this variability from the single sample $S$, the analyst uses the bootstrap method. They generate $B=4$ bootstrap samples by resampling with replacement from the original sample $S$. The four bootstrap samples are:\n\n- Bootstrap Sample 1: $\\{350, 350, 420, 500, 500\\}$\n- Bootstrap Sample 2: $\\{650, 400, 500, 400, 650\\}$\n- Bootstrap Sample 3: $\\{420, 500, 350, 420, 400\\}$\n- Bootstrap Sample 4: $\\{350, 650, 650, 420, 500\\}$\n\nFor the purpose of this problem, the first quartile (Q1) and third quartile (Q3) for any sample of size $n=5$ are defined as follows: after sorting the data in ascending order, Q1 is the second value in the sorted list, and Q3 is the fourth value. The IQR is then defined as $Q3 - Q1$.\n\nUsing the four provided bootstrap samples, calculate the bootstrap standard error of the sample IQR. Express your final answer in thousands of dollars, rounded to four significant figures.", "solution": "The interquartile range (IQR) for a sample of size $n=5$ with the given quartile rule is $Q3 - Q1$, where after sorting the values in ascending order, $Q1$ is the second value and $Q3$ is the fourth value.\n\nCompute the IQR for each bootstrap sample (values are in thousands of dollars):\n- Bootstrap 1: sorted $\\{350,350,420,500,500\\}$ gives $Q1=350$, $Q3=500$, so $\\operatorname{IQR}_{1}=500-350=150$.\n- Bootstrap 2: sorted $\\{400,400,500,650,650\\}$ gives $Q1=400$, $Q3=650$, so $\\operatorname{IQR}_{2}=650-400=250$.\n- Bootstrap 3: sorted $\\{350,400,420,420,500\\}$ gives $Q1=400$, $Q3=420$, so $\\operatorname{IQR}_{3}=420-400=20$.\n- Bootstrap 4: sorted $\\{350,420,500,650,650\\}$ gives $Q1=420$, $Q3=650$, so $\\operatorname{IQR}_{4}=650-420=230$.\n\nLet $B=4$ and denote the bootstrap IQRs by $\\hat{\\theta}^{*1},\\ldots,\\hat{\\theta}^{*4}$. The bootstrap standard error is the sample standard deviation of the bootstrap replicates:\n$$\n\\widehat{\\operatorname{se}}_{\\text{boot}}=\\left(\\frac{1}{B-1}\\sum_{b=1}^{B}\\left(\\hat{\\theta}^{*b}-\\bar{\\hat{\\theta}}^{*}\\right)^{2}\\right)^{\\frac{1}{2}},\n$$\nwhere\n$$\n\\bar{\\hat{\\theta}}^{*}=\\frac{1}{B}\\sum_{b=1}^{B}\\hat{\\theta}^{*b}.\n$$\n\nHere,\n$$\n\\hat{\\theta}^{*1}=150,\\quad \\hat{\\theta}^{*2}=250,\\quad \\hat{\\theta}^{*3}=20,\\quad \\hat{\\theta}^{*4}=230,\n$$\nso\n$$\n\\bar{\\hat{\\theta}}^{*}=\\frac{150+250+20+230}{4}=162.5.\n$$\nCompute the sum of squared deviations:\n$$\n\\sum_{b=1}^{4}\\left(\\hat{\\theta}^{*b}-\\bar{\\hat{\\theta}}^{*}\\right)^{2}=(150-162.5)^{2}+(250-162.5)^{2}+(20-162.5)^{2}+(230-162.5)^{2}.\n$$\nEvaluate each term:\n$$\n(150-162.5)^{2}=156.25,\\quad (250-162.5)^{2}=7656.25,\\quad (20-162.5)^{2}=20306.25,\\quad (230-162.5)^{2}=4556.25.\n$$\nThus,\n$$\n\\sum_{b=1}^{4}\\left(\\hat{\\theta}^{*b}-\\bar{\\hat{\\theta}}^{*}\\right)^{2}=156.25+7656.25+20306.25+4556.25=32675.\n$$\nTherefore,\n$$\n\\widehat{\\operatorname{se}}_{\\text{boot}}=\\left(\\frac{32675}{4-1}\\right)^{\\frac{1}{2}}=\\left(\\frac{32675}{3}\\right)^{\\frac{1}{2}}\\approx 104.363148\\ldots\n$$\nRounding to four significant figures gives $104.4$ (in thousands of dollars).", "answer": "$$\\boxed{104.4}$$", "id": "1902091"}, {"introduction": "Bootstrap methods are not limited to single summary statistics; they are also powerful tools in machine learning and regression analysis. In this final practice [@problem_id:1902043], you will apply the bootstrap concept in the context of a multiple linear regression model. This exercise demonstrates how to estimate the standard error of a new prediction, a crucial step in assessing a model's reliability and predictive uncertainty.", "problem": "A data scientist is analyzing a dataset using a multiple linear regression model of the form $Y_i = \\beta_0 + \\beta_1 X_{i1} + \\beta_2 X_{i2} + \\epsilon_i$, where the errors $\\epsilon_i$ are assumed to be independent and identically distributed with a mean of zero. After fitting the model to a sample of data using ordinary least squares (OLS), the scientist wants to estimate the uncertainty of a prediction for a new set of predictor values.\n\nThe new observation vector for which a prediction is desired is given by $\\mathbf{x}_{\\text{new}}$, corresponding to values $X_1 = 4$ and $X_2 = 2$. To estimate the standard error of the prediction $\\hat{y}_{\\text{new}}$, the scientist employs a residual bootstrap procedure. In this procedure, one generates a large number of bootstrap samples of the response variable, refits the regression model for each sample, and calculates a new prediction each time.\n\nThe scientist performed this procedure with $B=6$ bootstrap replications. The six resulting predictions for the new observation vector $\\mathbf{x}_{\\text{new}}$ are provided below:\n$$ \\{ 21.6, 20.3, 22.1, 20.6, 21.1, 20.9 \\} $$\nUsing this set of bootstrap predictions, calculate the bootstrap estimate of the standard error for the prediction $\\hat{y}_{\\text{new}}$. Round your final answer to four significant figures.", "solution": "We want the bootstrap estimate of the standard error of the prediction at $\\mathbf{x}_{\\text{new}}$. Using the $B$ bootstrap predictions $\\{\\hat{y}_{\\text{new}}^{*(b)}: b=1,\\dots,B\\}$, the standard bootstrap estimate of the standard error is the sample standard deviation:\n$$\n\\widehat{\\operatorname{SE}}_{\\text{boot}}(\\hat{y}_{\\text{new}})=\\left[\\frac{1}{B-1}\\sum_{b=1}^{B}\\left(\\hat{y}_{\\text{new}}^{*(b)}-\\bar{\\hat{y}}_{\\text{new}}^{*}\\right)^{2}\\right]^{\\frac{1}{2}},\n$$\nwhere $\\bar{\\hat{y}}_{\\text{new}}^{*}=\\frac{1}{B}\\sum_{b=1}^{B}\\hat{y}_{\\text{new}}^{*(b)}$.\n\nGiven $B=6$ and the bootstrap predictions $\\{21.6, 20.3, 22.1, 20.6, 21.1, 20.9\\}$, compute the mean:\n$$\n\\bar{\\hat{y}}_{\\text{new}}^{*}=\\frac{21.6+20.3+22.1+20.6+21.1+20.9}{6}=\\frac{126.6}{6}=21.1.\n$$\nCompute deviations and their squares:\n$$\n\\{0.5,-0.8,1.0,-0.5,0.0,-0.2\\}\\quad\\Rightarrow\\quad\\{0.25,0.64,1.00,0.25,0.00,0.04\\}.\n$$\nSum of squared deviations:\n$$\n\\sum_{b=1}^{6}\\left(\\hat{y}_{\\text{new}}^{*(b)}-\\bar{\\hat{y}}_{\\text{new}}^{*}\\right)^{2}=2.18.\n$$\nSample variance:\n$$\ns^{2}=\\frac{2.18}{6-1}=0.436.\n$$\nTherefore, the bootstrap standard error is\n$$\n\\widehat{\\operatorname{SE}}_{\\text{boot}}(\\hat{y}_{\\text{new}})=\\sqrt{0.436}\\approx 0.6603,\n$$\nrounded to four significant figures.", "answer": "$$\\boxed{0.6603}$$", "id": "1902043"}]}