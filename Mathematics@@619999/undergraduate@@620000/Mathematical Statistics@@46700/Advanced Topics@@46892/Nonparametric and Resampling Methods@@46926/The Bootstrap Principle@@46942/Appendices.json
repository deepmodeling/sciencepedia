{"hands_on_practices": [{"introduction": "One of the most powerful and common applications of the bootstrap principle is to construct confidence intervals for a parameter of interest. This technique is especially valuable because it does not require us to make strong assumptions about the underlying distribution of our data. This first practice [@problem_id:1959396] walks you through the final and most crucial step of this process: interpreting the distribution of bootstrap statistics to construct a percentile confidence interval for a population proportion, $p$.", "problem": "A quality control engineer at a semiconductor fabrication plant is tasked with assessing the reliability of a new type of processor. A random sample of $n=200$ processors is drawn from a large production batch and subjected to an aggressive stress test. In this sample, $x=24$ processors fail the test. The engineer wants to construct a confidence interval for the true, unknown proportion, $p$, of processors in the entire batch that would fail this test.\n\nTo accomplish this, the engineer uses a computational method. First, a large number of 'bootstrap samples' are generated. Each bootstrap sample is of size $n=200$, and is created by drawing processors *with replacement* from the original sample of 200. For each bootstrap sample, the proportion of failed processors, let's call it $\\hat{p}^*$, is calculated. This process is repeated $B = 2000$ times, yielding 2000 bootstrap proportions: $\\hat{p}^*_1, \\hat{p}^*_2, \\dots, \\hat{p}^*_{2000}$.\n\nThese 2000 proportions are then sorted in ascending order, denoted $\\hat{p}^*_{(1)} \\le \\hat{p}^*_{(2)} \\le \\dots \\le \\hat{p}^*_{(2000)}$. The engineer records the values near the key percentiles needed to construct a 95% confidence interval. The recorded values from the sorted list are:\n- 49th value: $\\hat{p}^*_{(49)} = 0.075$\n- 50th value: $\\hat{p}^*_{(50)} = 0.080$\n- 51st value: $\\hat{p}^*_{(51)} = 0.080$\n- ...\n- 1949th value: $\\hat{p}^*_{(1949)} = 0.160$\n- 1950th value: $\\hat{p}^*_{(1950)} = 0.165$\n- 1951st value: $\\hat{p}^*_{(1951)} = 0.165$\n\nUsing this information, determine the 95% percentile bootstrap confidence interval for the true failure proportion $p$. Provide the lower and upper bounds of the interval. Round your final answers to three significant figures.", "solution": "The goal is to construct a 95% confidence interval for the true proportion of defective processors, $p$, using the bootstrap percentile method.\n\nFirst, let's note the observed sample proportion, $\\hat{p}$, from the initial data.\n$$\n\\hat{p} = \\frac{x}{n} = \\frac{24}{200} = 0.12\n$$\n\nThe problem describes the procedure for the bootstrap percentile method. To construct a $(1-\\alpha) \\times 100\\%$ confidence interval, we need to find the lower and upper bounds from the sorted distribution of bootstrap statistics. The lower bound is the $(\\alpha/2)$ quantile and the upper bound is the $(1-\\alpha/2)$ quantile of the bootstrap distribution.\n\nFor a 95% confidence interval, we have $1-\\alpha = 0.95$, which implies $\\alpha = 0.05$.\n\nThe lower bound of the confidence interval corresponds to the quantile at $\\alpha/2$:\n$$\n\\frac{\\alpha}{2} = \\frac{0.05}{2} = 0.025\n$$\n\nThe upper bound of the confidence interval corresponds to the quantile at $1 - \\alpha/2$:\n$$\n1 - \\frac{\\alpha}{2} = 1 - 0.025 = 0.975\n$$\n\nWe have $B = 2000$ bootstrap samples, which have been used to calculate 2000 bootstrap proportions, $\\hat{p}^*$. These are sorted in ascending order to create the ordered statistics $\\hat{p}^*_{(1)}, \\hat{p}^*_{(2)}, \\dots, \\hat{p}^*_{(2000)}$.\n\nTo find the value corresponding to the 0.025 quantile, we find the index in the sorted list:\n$$\n\\text{Lower bound index} = B \\times \\frac{\\alpha}{2} = 2000 \\times 0.025 = 50\n$$\nSo, the lower bound of our confidence interval is the 50th value in the sorted list, $\\hat{p}^*_{(50)}$.\n\nTo find the value corresponding to the 0.975 quantile, we find the index in the sorted list:\n$$\n\\text{Upper bound index} = B \\times \\left(1 - \\frac{\\alpha}{2}\\right) = 2000 \\times 0.975 = 1950\n$$\nSo, the upper bound of our confidence interval is the 1950th value in the sorted list, $\\hat{p}^*_{(1950)}$.\n\nThe problem provides the necessary values from the sorted list:\n- Lower bound = $\\hat{p}^*_{(50)} = 0.080$\n- Upper bound = $\\hat{p}^*_{(1950)} = 0.165$\n\nThe problem requires the final answers to be rounded to three significant figures.\nThe lower bound, 0.080, has two significant figures. To express it with three, we can write it as 0.0800.\nThe upper bound, 0.165, already has three significant figures.\n\nThus, the 95% bootstrap percentile confidence interval is $[0.0800, 0.165]$. The requested values are the lower and upper bounds.\nLower bound: 0.0800\nUpper bound: 0.165", "answer": "$$\\boxed{\\begin{pmatrix} 0.0800 & 0.165 \\end{pmatrix}}$$", "id": "1959396"}, {"introduction": "The bootstrap's versatility allows it to be applied to far more than just simple means or proportions; it can be used to assess the uncertainty of parameters in complex models. This exercise [@problem_id:1959369] demonstrates this by applying the bootstrap to a simple linear regression model. By calculating the standard deviation of bootstrap replicates for the intercept coefficient, $\\hat{b}_0$, you will compute its bootstrap standard error, a key metric for understanding the stability and reliability of your model's estimates.", "problem": "A real estate analyst is studying the relationship between the size of a house and its selling price. A small dataset is collected, containing four observations of house size (in square feet) and selling price (in thousands of dollars):\n- (1000 sq ft, $250k)\n- (1500 sq ft, $300k)\n- (2000 sq ft, $450k)\n- (2500 sq ft, $500k)\n\nThe analyst fits a simple linear regression model of the form $P = b_0 + b_1 S$, where $P$ is the price and $S$ is the size. To assess the uncertainty of the model's intercept coefficient, $b_0$, the analyst employs a computational resampling technique. This procedure involves generating five new datasets, each the same size as the original. Each new dataset is created by drawing four data points (i.e., size-price pairs) with replacement from the original set of four points. For each of these five resampled datasets, a new simple linear regression model is fitted.\n\nThe intercept coefficients ($b_0$) calculated from these five models were found to be:\n79.6, 0.0, 61.1, 22.7, 60.0\n\nUsing this collection of five intercept values as a sample, calculate the estimated standard error of the intercept coefficient. Express your final answer in thousands of dollars, rounded to three significant figures.", "solution": "The bootstrap standard error of the intercept is estimated by the sample standard deviation of the bootstrap intercept estimates. Let the bootstrap estimates be $\\hat{b}_{0}^{*(i)}$ for $i=1,\\dots,B$, with $B=5$. The estimator is\n$$\n\\widehat{\\operatorname{SE}}(\\hat{b}_{0})=\\sqrt{\\frac{1}{B-1}\\sum_{i=1}^{B}\\left(\\hat{b}_{0}^{*(i)}-\\bar{b}_{0}^{*}\\right)^{2}},\\quad \\bar{b}_{0}^{*}=\\frac{1}{B}\\sum_{i=1}^{B}\\hat{b}_{0}^{*(i)}.\n$$\nWith $\\{\\hat{b}_{0}^{*(i)}\\}=\\{79.6,\\,0.0,\\,61.1,\\,22.7,\\,60.0\\}$ (in thousands of dollars), first compute the mean:\n$$\n\\bar{b}_{0}^{*}=\\frac{79.6+0.0+61.1+22.7+60.0}{5}=\\frac{223.4}{5}=44.68.\n$$\nCompute the squared deviations and their sum:\n$$\n\\begin{aligned}\n(79.6-44.68)^{2}&=34.92^{2}=1219.4064,\\\\\n(0.0-44.68)^{2}&=44.68^{2}=1996.3024,\\\\\n(61.1-44.68)^{2}&=16.42^{2}=269.6164,\\\\\n(22.7-44.68)^{2}&=21.98^{2}=483.1204,\\\\\n(60.0-44.68)^{2}&=15.32^{2}=234.7024,\n\\end{aligned}\n$$\nso\n$$\n\\sum_{i=1}^{5}\\left(\\hat{b}_{0}^{*(i)}-\\bar{b}_{0}^{*}\\right)^{2}=1219.4064+1996.3024+269.6164+483.1204+234.7024=4203.148.\n$$\nThus the sample variance and standard error are\n$$\ns^{2}=\\frac{4203.148}{5-1}=1050.787,\\qquad \\widehat{\\operatorname{SE}}(\\hat{b}_{0})=\\sqrt{1050.787}\\approx 32.416.\n$$\nRounded to three significant figures and expressed in thousands of dollars, the estimated standard error is $32.4$.", "answer": "$$\\boxed{32.4}$$", "id": "1959369"}, {"introduction": "Beyond measuring uncertainty with confidence intervals and standard errors, the bootstrap can also be used to estimate the bias of an estimator. An estimator is biased if it systematically over- or underestimates the true parameter value, a common issue with skewed data. This problem [@problem_id:1959393] provides a foundational look into the bootstrap's mechanics by asking you to calculate the bias of the sample median for a small dataset, considering every possible bootstrap resample to build a complete picture of the bootstrap distribution.", "problem": "An analyst in a semiconductor manufacturing plant is studying the turn-on voltage of a particular type of transistor. She collects a small sample of $n=3$ measurements, which are recorded as $\\{1.1, 2.5, 6.2\\}$ volts. Based on prior knowledge of the fabrication process, she believes the underlying distribution of turn-on voltages is right-skewed and can be modeled by a chi-squared distribution with 3 degrees of freedom, $\\chi^2(3)$.\n\nThe analyst is considering using the sample median as an estimator for the population mean turn-on voltage. To evaluate the suitability of this estimator, she decides to estimate its bias. The bias of an estimator $\\hat{\\theta}$ for a parameter $\\theta$ is defined as $\\text{Bias}(\\hat{\\theta}) = E[\\hat{\\theta}] - \\theta$.\n\nUsing the bootstrap method, calculate the estimated bias of the sample median when used as an estimator for the population mean. The bootstrap estimate for the bias is defined as the average of the statistic computed over all bootstrap samples minus the statistic computed on the original sample. For this calculation, you must consider all possible *distinct* bootstrap samples of size $n=3$ that can be drawn with replacement from the original data.\n\nReport your final answer for the estimated bias rounded to two significant figures.", "solution": "We denote the observed sample as $x=\\{1.1,2.5,6.2\\}$ with $n=3$. The statistic of interest is the sample median. For the original sample, the median is $T = \\text{median}(1.1,2.5,6.2)=2.5$.\n\nThe bootstrap estimate for the bias is defined as $\\widehat{\\text{Bias}}=E[T^{*}]-T$, where $E[T^{*}]$ is the expected value of the statistic computed over all possible bootstrap samples. There are $n^n = 3^3 = 27$ possible bootstrap samples, each drawn with replacement from the original sample and each equally likely.\n\nTo calculate $E[T^{*}]$, we can enumerate the distinct bootstrap samples (multisets), find their medians, and then compute a weighted average based on the number of ways each distinct multiset can be formed.\n\nLet's list the distinct multisets, their medians, and the number of permutations (their frequency out of 27):\n1.  $\\{1.1, 1.1, 1.1\\}$: median = 1.1. Count = 1.\n2.  $\\{1.1, 1.1, 2.5\\}$: median = 1.1. Count = 3.\n3.  $\\{1.1, 1.1, 6.2\\}$: median = 1.1. Count = 3.\n4.  $\\{1.1, 2.5, 2.5\\}$: median = 2.5. Count = 3.\n5.  $\\{1.1, 2.5, 6.2\\}$: median = 2.5. Count = 6.\n6.  $\\{1.1, 6.2, 6.2\\}$: median = 6.2. Count = 3.\n7.  $\\{2.5, 2.5, 2.5\\}$: median = 2.5. Count = 1.\n8.  $\\{2.5, 2.5, 6.2\\}$: median = 2.5. Count = 3.\n9.  $\\{2.5, 6.2, 6.2\\}$: median = 6.2. Count = 3.\n10. $\\{6.2, 6.2, 6.2\\}$: median = 6.2. Count = 1.\n\nThe total count is $1+3+3+3+6+3+1+3+3+1 = 27$, which is correct.\n\nThe bootstrap expectation of the median, $E[T^*]$, is the average of the medians over all 27 possible samples:\n- The value 1.1 occurs as the median with a total count of $1 + 3 + 3 = 7$.\n- The value 2.5 occurs as the median with a total count of $3 + 6 + 1 + 3 = 13$.\n- The value 6.2 occurs as the median with a total count of $3 + 3 + 1 = 7$.\n\n$$\nE[T^*] = \\frac{(7 \\times 1.1) + (13 \\times 2.5) + (7 \\times 6.2)}{27} = \\frac{7.7 + 32.5 + 43.4}{27} = \\frac{83.6}{27} \\approx 3.0963\n$$\n\nThe bootstrap bias estimate is:\n$$\n\\widehat{\\text{Bias}} = E[T^*] - T \\approx 3.0963 - 2.5 = 0.5963\n$$\n\nRounding to two significant figures, the estimated bias is $0.60$.", "answer": "$$\\boxed{0.60}$$", "id": "1959393"}]}