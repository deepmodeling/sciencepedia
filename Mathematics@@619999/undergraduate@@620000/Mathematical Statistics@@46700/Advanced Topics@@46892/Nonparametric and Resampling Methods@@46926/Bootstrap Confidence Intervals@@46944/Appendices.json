{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we'll start with a foundational scenario. When dealing with small datasets, as is common in fields like molecular biology, classical statistical methods can be unreliable. This is where bootstrapping shines. This first practice demonstrates the core mechanic of the percentile bootstrap method using a tangible example: estimating the confidence interval for a population median, a robust measure of central tendency, from a very small sample [@problem_id:1901792]. You'll work directly with a list of sorted bootstrap medians to construct the interval, giving you a clear, step-by-step understanding of the process.", "problem": "A molecular biologist is studying the expression level of a specific gene, 'Gene-X', under a certain condition. The expression level is measured as a normalized fluorescence intensity. Due to the high cost of the experiment, only a small sample of five measurements could be obtained. The observed expression levels were:\n$$\n3.1, 4.5, 2.8, 5.9, 3.4\n$$\nTo estimate the variability of the population median expression level, the biologist employs a non-parametric bootstrap procedure. A large number of bootstrap samples are created by resampling the original five data points with replacement. For each bootstrap sample, the median is calculated. After generating 20 such bootstrap medians and sorting them in ascending order, the following list of ordered medians is obtained:\n$$\n2.8, 2.9, 3.1, 3.1, 3.1, 3.2, 3.3, 3.4, 3.4, 3.4, 3.5, 3.6, 3.9, 4.1, 4.2, 4.5, 4.5, 4.5, 4.8, 5.1\n$$\nUsing the percentile method on this set of 20 sorted bootstrap medians, construct a 90% confidence interval for the population median expression level. Which of the following represents the correct interval?\n\nA. [2.8, 4.8]\n\nB. [2.9, 5.1]\n\nC. [2.8, 5.1]\n\nD. [3.1, 4.5]\n\nE. [2.9, 4.8]", "solution": "We seek a percentile bootstrap confidence interval for the population median using the sorted bootstrap medians. For a confidence level of $1-\\alpha=0.90$, the percentile method uses the empirical quantiles at probabilities $\\alpha/2=0.05$ and $1-\\alpha/2=0.95$ of the bootstrap distribution.\n\nLet $B=20$ be the number of bootstrap medians, and denote the ordered bootstrap medians by $m_{(1)} \\leq m_{(2)} \\leq \\cdots \\leq m_{(20)}$. Using the nearest-rank definition of empirical quantiles, the rank corresponding to probability $p$ is\n$$\nr(p)=\\lceil B p \\rceil.\n$$\nThus,\n$$\nr(0.05)=\\lceil 20 \\times 0.05 \\rceil=\\lceil 1 \\rceil=1,\\quad r(0.95)=\\lceil 20 \\times 0.95 \\rceil=\\lceil 19 \\rceil=19.\n$$\nTherefore, the $90\\%$ percentile interval is\n$$\n\\left[m_{(1)},\\,m_{(19)}\\right].\n$$\nFrom the given sorted list, $m_{(1)}=2.8$ and $m_{(19)}=4.8$, so the interval is $[2.8, 4.8]$, which corresponds to option A.", "answer": "$$\\boxed{A}$$", "id": "1901792"}, {"introduction": "Having mastered the basics, we now move to a more complex and abstract application that showcases the true power of bootstrapping. Instead of a simple parameter like the median, we'll investigate the uncertainty of a goodness-of-fit statistic: the maximum absolute difference between an empirical distribution function ($F_n$) and the true underlying distribution function ($F$), often denoted $d_n$. This practice is valuable because analytic methods for such a statistic are often intractable [@problem_id:1901810]. By working with a frequency table of bootstrap results, you will learn how to derive a confidence interval for a non-standard statistic, a skill essential for modern data analysis and research.", "problem": "An engineer is analyzing the performance of a new database query optimizer. A sample of $n=8$ independent measurements of query execution times (in milliseconds) is collected: $\\{15.3, 12.1, 18.6, 9.8, 21.0, 16.5, 13.5, 17.2\\}$.\n\nLet $F(x)$ be the true, unknown Cumulative Distribution Function (CDF) of query execution times, and let $F_n(x)$ be the Empirical Cumulative Distribution Function (ECDF) constructed from the sample. The engineer is interested in the statistic $d_n$, defined as the maximum absolute difference between the ECDF and the true CDF over all possible execution times $x$:\n$$d_n = \\sup_{x} |F_n(x) - F(x)|$$\nTo estimate the uncertainty in this value, a percentile bootstrap procedure is used. A total of $B=10000$ bootstrap replicates of the statistic, denoted $d_n^*$, are generated. Each replicate $d_n^*$ is calculated by drawing a new sample of size $n=8$ with replacement from the original data, constructing its ECDF $F_n^*(x)$, and finding the value $\\sup_x|F_n^*(x) - F_n(x)|$.\n\nThe frequencies of the distinct values observed among the 10000 bootstrap replicates are summarized in the following table:\n\n| Value of $d_n^*$ | Frequency |\n|:----------------:|:---------:|\n| 0.000            | 1373      |\n| 0.125            | 4390      |\n| 0.250            | 3088      |\n| 0.375            | 963       |\n| 0.500            | 172       |\n| 0.625            | 14        |\n\nBased on this distribution of bootstrap replicates, construct a 70% percentile bootstrap confidence interval for the statistic $d_n$. Present your answer as an ordered pair $(L, U)$, where $L$ is the lower bound and $U$ is the upper bound. Round your final answers for $L$ and $U$ to three significant figures.", "solution": "We seek a 0.70 percentile bootstrap confidence interval for the scalar parameter $d_{n}$ using the bootstrap replicates $d_{n}^{*}$. For the percentile method with confidence level $1-\\alpha=0.70$, the equal-tailed interval is given by the empirical $\\alpha/2$ and $1-\\alpha/2$ quantiles of the bootstrap distribution:\n$$\n(L,U)=\\left(\\hat{Q}_{d_{n}^{*}}(0.15),\\ \\hat{Q}_{d_{n}^{*}}(0.85)\\right),\n$$\nwhere $\\hat{Q}_{d_{n}^{*}}(p)$ denotes the empirical $p$-quantile, defined as the smallest value $x$ such that the empirical CDF $\\hat{F}_{d_{n}^{*}}(x)\\geq p$.\n\nFrom the provided frequencies over $B=10000$ replicates, the cumulative proportions at the distinct values are:\n$$\n\\begin{aligned}\nP(d_{n}^{*}\\leq 0.000)&=\\frac{1373}{10000}=0.1373,\\\\\nP(d_{n}^{*}\\leq 0.125)&=\\frac{1373+4390}{10000}=\\frac{5763}{10000}=0.5763,\\\\\nP(d_{n}^{*}\\leq 0.250)&=\\frac{8851}{10000}=0.8851,\\\\\nP(d_{n}^{*}\\leq 0.375)&=\\frac{9814}{10000}=0.9814,\\\\\nP(d_{n}^{*}\\leq 0.500)&=\\frac{9986}{10000}=0.9986,\\\\\nP(d_{n}^{*}\\leq 0.625)&=1.\n\\end{aligned}\n$$\n\nFor the lower quantile $p=0.15$, we find $0.1373<0.15\\leq 0.5763$, so\n$$\n\\hat{Q}_{d_{n}^{*}}(0.15)=0.125.\n$$\nFor the upper quantile $p=0.85$, we find $0.5763<0.85\\leq 0.8851$, so\n$$\n\\hat{Q}_{d_{n}^{*}}(0.85)=0.250.\n$$\n\nThus, the $0.70$ percentile bootstrap confidence interval is $(0.125,\\ 0.250)$. Rounding each endpoint to three significant figures yields $L=0.125$ and $U=0.250$.", "answer": "$$\\boxed{\\begin{pmatrix} 0.125 & 0.250 \\end{pmatrix}}$$", "id": "1901810"}, {"introduction": "In our final practice, we'll apply bootstrapping to one of the most common tools in statistics: linear regression. Standard regression analysis relies on several assumptions, such as the constancy of error variance (homoscedasticity), which are often violated in real-world data. This problem introduces a powerful variant called the \"wild bootstrap,\" designed specifically to provide reliable confidence intervals for regression coefficients even when such assumptions fail [@problem_id:1901772]. This exercise demonstrates the adaptability and importance of bootstrap methods in building robust statistical models, cementing your understanding of its practical utility in a sophisticated scientific context.", "problem": "A materials engineer is investigating the properties of a new polymer composite. She studies the relationship between the concentration of a novel hardening agent and the resulting tensile strength of the material. A linear relationship is hypothesized: $S_i = \\beta_0 + \\beta_1 C_i + \\epsilon_i$, where $S_i$ is the tensile strength in Gigapascals (GPa), $C_i$ is the hardener concentration in percent (%), and $\\epsilon_i$ are the error terms. The engineer is particularly interested in the coefficient $\\beta_1$, which represents the marginal increase in GPa of tensile strength for each additional percentage point of hardener.\n\nAfter collecting data, a preliminary analysis suggests that the variance of the error terms $\\epsilon_i$ may not be constant across different concentration levels, a condition which would invalidate the standard confidence interval for $\\beta_1$. To obtain a more reliable interval, a robust computational method is employed. This method involves the following steps to generate a distribution of plausible slope estimates:\n1.  An initial Ordinary Least Squares (OLS) regression is performed on the original data to find the estimated coefficients $\\hat{\\beta}_0, \\hat{\\beta}_1$ and the residuals $\\hat{\\epsilon}_i = S_i - (\\hat{\\beta}_0 + \\hat{\\beta}_1 C_i)$.\n2.  A large number, $B$, of new \"bootstrap\" datasets are generated. For each replication $b \\in \\{1, \\dots, B\\}$, a new set of pseudo-errors is created as $\\epsilon_{i,b}^* = \\hat{\\epsilon}_i \\cdot v_{i,b}$, where each $v_{i,b}$ is an independent random draw from a distribution with a mean of 0 and a variance of 1.\n3.  New pseudo-responses are constructed using the original fitted values: $S_{i,b}^* = (\\hat{\\beta}_0 + \\hat{\\beta}_1 C_i) + \\epsilon_{i,b}^*$.\n4.  For each replication $b$, a new slope coefficient, $\\hat{\\beta}_{1,b}^*$, is estimated by performing an OLS regression of $S_b^*$ on the original concentrations $C$.\n\nThis procedure was conducted for $B=4999$ replications. The resulting $4999$ slope estimates, $\\{\\hat{\\beta}_{1,b}^*\\}$, were then sorted in ascending order. The analysis yielded the following key values from the sorted list:\n- The 125th value is $2.18$.\n- The OLS estimate from the original data is $\\hat{\\beta}_1 = 2.51$.\n- The 4875th value is $2.93$.\n\nBased on this information, determine the 95% bootstrap percentile confidence interval for the slope coefficient $\\beta_1$. Express your answer as a row matrix `[lower_bound, upper_bound]`, with values given in units of GPa/%. The provided values are already at the required precision, so no further rounding is necessary.", "solution": "We are asked for a 95 percent bootstrap percentile confidence interval for the slope coefficient $\\beta_{1}$, based on $B=4999$ bootstrap slope estimates. Let the sorted bootstrap slopes be denoted by the order statistics $\\hat{\\beta}_{1,(1)}^{*} \\leq \\cdots \\leq \\hat{\\beta}_{1,(B)}^{*}$.\n\nFor a nominal two-sided confidence level $1-\\alpha=0.95$ with $\\alpha=0.05$, the percentile method takes the empirical $\\alpha/2$ and $1-\\alpha/2$ quantiles of the bootstrap distribution. Using the standard $(B+1)$ indexing rule, the quantile indices are\n$$\nk_{\\ell} = \\alpha/2 \\cdot (B+1), \\qquad k_{u} = (1-\\alpha/2) \\cdot (B+1).\n$$\nWith $B=4999$ and $\\alpha=0.05$,\n$$\nk_{\\ell} = 0.025 \\cdot 5000 = 125, \\qquad k_{u} = 0.975 \\cdot 5000 = 4875.\n$$\nTherefore, the 95 percent bootstrap percentile confidence interval is\n$$\n\\left[\\, \\hat{\\beta}_{1,(125)}^{*},\\ \\hat{\\beta}_{1,(4875)}^{*} \\,\\right].\n$$\nFrom the provided sorted bootstrap outputs, $\\hat{\\beta}_{1,(125)}^{*} = 2.18$ and $\\hat{\\beta}_{1,(4875)}^{*} = 2.93$. Hence, the 95 percent bootstrap percentile confidence interval is\n$$\n[\\,2.18,\\ 2.93\\,].\n$$\nThe original OLS estimate $\\hat{\\beta}_{1}=2.51$ is not needed for the percentile interval construction; it is reported for context.", "answer": "$$\\boxed{\\begin{pmatrix} 2.18 & 2.93 \\end{pmatrix}}$$", "id": "1901772"}]}