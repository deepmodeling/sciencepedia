{"hands_on_practices": [{"introduction": "Before we dive into more advanced techniques, it's crucial to understand the method they often replace: the histogram. This practice [@problem_id:1939942] demonstrates a fundamental weakness of histograms—their shape can change dramatically just by shifting the starting point of the bins, even when the data and bin width remain the same. This exercise highlights why we need more robust and less arbitrary methods for density estimation.", "problem": "A statistician is exploring the sensitivity of a histogram as a nonparametric density estimator. The value of the histogram density estimate at a point $x$, denoted $\\hat{f}(x)$, is given by the formula:\n$$\n\\hat{f}(x) = \\frac{k}{nh}\n$$\nwhere $n$ is the total number of data points, $h$ is the bin width, and $k$ is the number of data points that fall into the specific bin containing the point $x$.\n\nThe bins are defined by an origin point, $t_0$, and a width, $h$. The set of all bins is given by intervals of the form $[t_0 + j \\cdot h, t_0 + (j+1) \\cdot h)$ for all integers $j$.\n\nConsider the following dataset of $n=5$ observations:\n$$\nD = \\{0.8, 0.9, 1.2, 1.5, 2.6\\}\n$$\nThe statistician decides to use a fixed bin width of $h=1.0$. However, they consider two different binning schemes by choosing two different origins.\n\n- **Scheme A:** The bin origin is $t_{0,A} = 0.0$.\n- **Scheme B:** The bin origin is $t_{0,B} = 0.5$.\n\nLet $\\hat{f}_A(x)$ be the density estimate calculated using Scheme A, and $\\hat{f}_B(x)$ be the estimate calculated using Scheme B.\n\nCalculate the absolute difference between the two density estimates at the point $x = 1.1$. That is, find the value of $|\\hat{f}_A(1.1) - \\hat{f}_B(1.1)|$.\n\nExpress your answer as a decimal.", "solution": "The histogram density estimate at a point $x$ is defined by $\\hat{f}(x) = \\frac{k}{n h}$, where $k$ is the count of data points in the bin containing $x$, $n$ is the sample size, and $h$ is the bin width. Here, $n=5$ and $h=1.0$, and bins are of the form $[t_{0}+j h, t_{0}+(j+1) h)$.\n\nFor Scheme A with $t_{0,A}=0.0$, the bins are $[0,1)$, $[1,2)$, $[2,3)$, etc. The point $x=1.1$ lies in the bin $[1,2)$. The data points in $[1,2)$ are $1.2$ and $1.5$, so $k_{A}=2$. Therefore,\n$$\n\\hat{f}_{A}(1.1) = \\frac{k_{A}}{n h} = \\frac{2}{5 \\cdot 1} = 0.4.\n$$\n\nFor Scheme B with $t_{0,B}=0.5$, the bins are $[0.5,1.5)$, $[1.5,2.5)$, $[2.5,3.5)$, etc. The point $x=1.1$ lies in $[0.5,1.5)$. The data points in $[0.5,1.5)$ are $0.8$, $0.9$, and $1.2$, while $1.5$ is excluded since the interval is right-open. Thus $k_{B}=3$. Therefore,\n$$\n\\hat{f}_{B}(1.1) = \\frac{k_{B}}{n h} = \\frac{3}{5 \\cdot 1} = 0.6.\n$$\n\nThe requested absolute difference is\n$$\n|\\hat{f}_{A}(1.1) - \\hat{f}_{B}(1.1)| = |0.4 - 0.6| = 0.2.\n$$", "answer": "$$\\boxed{0.2}$$", "id": "1939942"}, {"introduction": "Kernel Density Estimation (KDE) improves upon histograms by placing a smooth \"bump\"—a kernel—at each data point. For the resulting estimate to be a valid probability density function, the kernel itself must also be a probability density function. This practice [@problem_id:1939931] asks you to find the normalizing constant for a common kernel, an essential step in ensuring it integrates to one and is thus a valid building block for KDE.", "problem": "In the statistical method of kernel density estimation, a kernel function $K(u)$ is used to weight and smooth data points. To be mathematically valid, any such kernel function must itself be a probability density function. Consider the following function, known as the biweight (or quartic) kernel, which is often used for its smoothness properties:\n$$\nK(u) = \\begin{cases} c(1 - u^2)^2 & \\text{for } |u| \\le 1 \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\nwhere $c$ is a positive constant. Determine the precise numerical value of $c$ that makes $K(u)$ a valid kernel.", "solution": "To be a valid probability density function on the real line, the kernel must satisfy nonnegativity and unit integral. The given $K(u)$ is nonnegative since $(1-u^{2})^{2} \\ge 0$ for all $u$, and it is zero outside $|u| \\le 1$. Thus, the normalization condition determines $c$:\n$$\n\\int_{-\\infty}^{\\infty} K(u)\\,du \\;=\\; \\int_{-1}^{1} c\\left(1 - u^{2}\\right)^{2}\\,du \\;=\\; 1.\n$$\nExpand the square and integrate term by term:\n$$\n\\int_{-1}^{1} c\\left(1 - 2u^{2} + u^{4}\\right)\\,du\n\\;=\\;\nc\\left(\\int_{-1}^{1} 1\\,du - 2\\int_{-1}^{1} u^{2}\\,du + \\int_{-1}^{1} u^{4}\\,du\\right).\n$$\nUsing symmetry and standard integrals,\n$$\n\\int_{-1}^{1} 1\\,du = 2,\\quad \\int_{-1}^{1} u^{2}\\,du = \\frac{2}{3},\\quad \\int_{-1}^{1} u^{4}\\,du = \\frac{2}{5}.\n$$\nTherefore,\n$$\n\\int_{-1}^{1} c\\left(1 - u^{2}\\right)^{2}\\,du\n=\nc\\left(2 - 2\\cdot\\frac{2}{3} + \\frac{2}{5}\\right)\n=\nc\\left(2 - \\frac{4}{3} + \\frac{2}{5}\\right)\n=\nc\\left(\\frac{30}{15} - \\frac{20}{15} + \\frac{6}{15}\\right)\n=\nc\\cdot\\frac{16}{15}.\n$$\nSetting this equal to $1$ gives\n$$\nc\\cdot\\frac{16}{15} = 1 \\quad\\Rightarrow\\quad c = \\frac{15}{16}.\n$$\nThus, $c = \\frac{15}{16}$ ensures $K(u)$ integrates to $1$, making it a valid kernel.", "answer": "$$\\boxed{\\frac{15}{16}}$$", "id": "1939931"}, {"introduction": "With an understanding of what makes a valid kernel, we can now construct a full density estimate. This exercise [@problem_id:1939894] guides you through a concrete calculation of a Kernel Density Estimate at a specific point for a small, hypothetical dataset. By working through the KDE formula step-by-step, you will gain a tangible sense of how individual data points and the bandwidth parameter, $h$, contribute to the final smooth density curve.", "problem": "A materials science lab is testing a new type of polymer battery. They perform five trials, measuring the time until the battery is fully discharged under a constant load. The recorded discharge times, in hours, are: $\\{2.1, 2.5, 3.0, 3.8, 4.2\\}$.\n\nTo analyze this small sample, a statistician decides to use a Kernel Density Estimator (KDE) to estimate the underlying probability density function of the discharge time. The KDE is given by the formula:\n$$ \\hat{f}_h(x) = \\frac{1}{nh} \\sum_{i=1}^{n} K\\left(\\frac{x - x_i}{h}\\right) $$\nwhere $n$ is the number of data points, $\\{x_1, \\dots, x_n\\}$ is the set of observed data, $h$ is a parameter called the bandwidth, and $K(u)$ is the kernel function.\n\nFor this analysis, a triangular kernel is chosen, defined as:\n$$ K(u) = \\begin{cases} 1 - |u| & \\text{if } |u| \\le 1 \\\\ 0 & \\text{if } |u| > 1 \\end{cases} $$\nUsing a bandwidth of $h = 1.0$ hour, calculate the numerical value of the estimated probability density, $\\hat{f}_h(x)$, at the point $x = 2.8$ hours. Round your final answer to three significant figures.", "solution": "We are given the Kernel Density Estimator\n$$\n\\hat{f}_{h}(x)=\\frac{1}{nh}\\sum_{i=1}^{n}K\\!\\left(\\frac{x-x_{i}}{h}\\right),\n$$\nwith triangular kernel\n$$\nK(u)=\\begin{cases}\n1-|u| & \\text{if } |u|\\leq 1\\\\\n0 & \\text{if } |u|>1\n\\end{cases}\n$$\nfor data $\\{x_{i}\\}=\\{2.1,2.5,3.0,3.8,4.2\\}$, bandwidth $h=1.0$, and the evaluation point $x=2.8$. Here $n=5$.\n\nSince $h=1$, we have $u_{i}=(x-x_{i})/h=x-x_{i}$. Compute each contribution:\n- For $x_{1}=2.1$: $u_{1}=2.8-2.1=0.7$, so $|u_{1}|\\leq 1$ and $K(u_{1})=1-|0.7|=0.3$.\n- For $x_{2}=2.5$: $u_{2}=2.8-2.5=0.3$, so $|u_{2}|\\leq 1$ and $K(u_{2})=1-|0.3|=0.7$.\n- For $x_{3}=3.0$: $u_{3}=2.8-3.0=-0.2$, so $|u_{3}|\\leq 1$ and $K(u_{3})=1-|-0.2|=0.8$.\n- For $x_{4}=3.8$: $u_{4}=2.8-3.8=-1.0$, so $|u_{4}|=1$ and $K(u_{4})=1-1=0$.\n- For $x_{5}=4.2$: $u_{5}=2.8-4.2=-1.4$, so $|u_{5}|>1$ and $K(u_{5})=0$.\n\nThus\n$$\n\\sum_{i=1}^{5}K\\!\\left(\\frac{2.8-x_{i}}{1}\\right)=0.3+0.7+0.8+0+0=1.8.\n$$\nTherefore,\n$$\n\\hat{f}_{1}(2.8)=\\frac{1}{5\\cdot 1}\\times 1.8=0.36.\n$$\nRounding to three significant figures gives $0.360$.", "answer": "$$\\boxed{0.360}$$", "id": "1939894"}]}