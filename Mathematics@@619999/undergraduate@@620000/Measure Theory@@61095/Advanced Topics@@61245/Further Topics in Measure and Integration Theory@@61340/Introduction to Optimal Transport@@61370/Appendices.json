{"hands_on_practices": [{"introduction": "This first exercise grounds the abstract concept of optimal transport in a familiar logistics scenario. We will explore the Kantorovich formulation by finding the most cost-effective way to distribute goods between a set of discrete locations. This practice will guide you through setting up and solving a simple optimal transport problem as a linear program, making the idea of a \"transport plan\" tangible and concrete. [@problem_id:1424977]", "problem": "A company operates two bakeries, $B_1$ and $B_2$, and two cafes, $C_1$ and $C_2$, all located along a single straight road. Their positions are given in kilometers from a reference point:\n- Bakery $B_1$ is at position $a_1 = 1$.\n- Bakery $B_2$ is at position $a_2 = 2$.\n- Cafe $C_1$ is at position $b_1 = 5$.\n- Cafe $C_2$ is at position $b_2 = 8$.\n\nEach morning, both bakeries produce an equal amount of goods, with each contributing exactly half of the total supply. Similarly, both cafes have an equal demand, each requiring half of the total supply to be delivered. The supply and demand can be modeled as discrete probability measures: the supply measure is $\\mu = \\frac{1}{2}\\delta_{a_1} + \\frac{1}{2}\\delta_{a_2}$, and the demand measure is $\\nu = \\frac{1}{2}\\delta_{b_1} + \\frac{1}{2}\\delta_{b_2}$, where $\\delta_x$ denotes a unit mass located at position $x$.\n\nThe cost of transporting a unit of goods from a location $x$ to a location $y$ is given by the squared Euclidean distance $c(x, y) = (x-y)^2$. The company seeks to determine a transportation schedule that moves all goods from the bakeries to the cafes while minimizing the total transportation cost. Such a schedule, known as a transport plan, can be represented by a matrix $\\Pi = (\\pi_{ij})$, where $\\pi_{ij}$ is the fraction of the total supply transported from bakery $i$ to cafe $j$ (for $i,j \\in \\{1,2\\}$).\n\nDetermine the optimal transport plan $\\Pi$ that achieves the minimum possible total cost. Present your answer as a row matrix of the components of the plan in the order $\\begin{pmatrix} \\pi_{11} & \\pi_{12} & \\pi_{21} & \\pi_{22} \\end{pmatrix}$.", "solution": "This problem is an instance of the Kantorovich formulation of the optimal transport problem for discrete measures. We need to find a transport plan $\\Pi = (\\pi_{ij})$ that minimizes the total cost, subject to constraints on its marginals.\n\nThe transport plan is a $2 \\times 2$ matrix with non-negative entries:\n$$\n\\Pi = \\begin{pmatrix} \\pi_{11} & \\pi_{12} \\\\ \\pi_{21} & \\pi_{22} \\end{pmatrix}\n$$\nwhere $\\pi_{ij}$ is the amount of mass transported from bakery $B_i$ at $a_i$ to cafe $C_j$ at $b_j$.\n\nFirst, we compute the cost matrix $C = (c_{ij})$, where $c_{ij} = c(a_i, b_j) = (a_i - b_j)^2$.\n- $c_{11} = (a_1 - b_1)^2 = (1 - 5)^2 = (-4)^2 = 16$.\n- $c_{12} = (a_1 - b_2)^2 = (1 - 8)^2 = (-7)^2 = 49$.\n- $c_{21} = (a_2 - b_1)^2 = (2 - 5)^2 = (-3)^2 = 9$.\n- $c_{22} = (a_2 - b_2)^2 = (2 - 8)^2 = (-6)^2 = 36$.\nSo the cost matrix is:\n$$\nC = \\begin{pmatrix} 16 & 49 \\\\ 9 & 36 \\end{pmatrix}\n$$\n\nThe total transportation cost is the objective function to be minimized:\n$$\nJ(\\Pi) = \\sum_{i=1}^{2} \\sum_{j=1}^{2} c_{ij} \\pi_{ij} = 16\\pi_{11} + 49\\pi_{12} + 9\\pi_{21} + 36\\pi_{22}\n$$\n\nThe constraints are that the marginals of the transport plan $\\Pi$ must match the given measures $\\mu$ and $\\nu$.\nThe row sums of $\\Pi$ must equal the masses at the source locations (bakeries):\n1.  $\\pi_{11} + \\pi_{12} = \\mu(\\{a_1\\}) = \\frac{1}{2}$ (Total mass from $B_1$)\n2.  $\\pi_{21} + \\pi_{22} = \\mu(\\{a_2\\}) = \\frac{1}{2}$ (Total mass from $B_2$)\n\nThe column sums of $\\Pi$ must equal the masses at the target locations (cafes):\n3.  $\\pi_{11} + \\pi_{21} = \\nu(\\{b_1\\}) = \\frac{1}{2}$ (Total mass to $C_1$)\n4.  $\\pi_{12} + \\pi_{22} = \\nu(\\{b_2\\}) = \\frac{1}{2}$ (Total mass to $C_2$)\n\nAdditionally, all entries of the transport plan must be non-negative:\n5.  $\\pi_{ij} \\ge 0$ for all $i,j \\in \\{1,2\\}$.\n\nThis is a linear programming problem. We can solve it by parameterizing the space of valid transport plans. Let's express all variables in terms of one variable, say $\\pi_{11} = x$.\nFrom constraint (1): $\\pi_{12} = \\frac{1}{2} - \\pi_{11} = \\frac{1}{2} - x$.\nFrom constraint (3): $\\pi_{21} = \\frac{1}{2} - \\pi_{11} = \\frac{1}{2} - x$.\nUsing these, we find $\\pi_{22}$ from constraint (2):\n$\\pi_{22} = \\frac{1}{2} - \\pi_{21} = \\frac{1}{2} - (\\frac{1}{2} - x) = x$.\nWe can check that this also satisfies constraint (4): $\\pi_{12} + \\pi_{22} = (\\frac{1}{2} - x) + x = \\frac{1}{2}$. This is consistent.\n\nSo any valid transport plan can be written as:\n$$\n\\Pi(x) = \\begin{pmatrix} x & \\frac{1}{2} - x \\\\ \\frac{1}{2} - x & x \\end{pmatrix}\n$$\nNow we apply the non-negativity constraint (5):\n- $\\pi_{11} = x \\ge 0$.\n- $\\pi_{12} = \\frac{1}{2} - x \\ge 0 \\implies x \\le \\frac{1}{2}$.\n- $\\pi_{21} = \\frac{1}{2} - x \\ge 0 \\implies x \\le \\frac{1}{2}$.\n- $\\pi_{22} = x \\ge 0$.\nCombining these, the valid range for the parameter $x$ is $0 \\le x \\le \\frac{1}{2}$.\n\nNow we express the total cost $J$ as a function of $x$:\n$$\nJ(x) = 16x + 49\\left(\\frac{1}{2} - x\\right) + 9\\left(\\frac{1}{2} - x\\right) + 36x\n$$\n$$\nJ(x) = 16x + \\frac{49}{2} - 49x + \\frac{9}{2} - 9x + 36x\n$$\n$$\nJ(x) = (16 - 49 - 9 + 36)x + \\left(\\frac{49}{2} + \\frac{9}{2}\\right)\n$$\n$$\nJ(x) = (52 - 58)x + \\frac{58}{2}\n$$\n$$\nJ(x) = -6x + 29\n$$\nWe need to minimize this linear function $J(x)$ over the interval $x \\in [0, \\frac{1}{2}]$. Since the function has a negative slope ($-6$), its minimum value on the interval will be at the largest possible value of $x$, which is $x = \\frac{1}{2}$.\n\nThe optimal value for $x$ is $x_{opt} = \\frac{1}{2}$.\nSubstituting this back into the parameterized plan $\\Pi(x)$:\n- $\\pi_{11} = x_{opt} = \\frac{1}{2}$.\n- $\\pi_{12} = \\frac{1}{2} - x_{opt} = \\frac{1}{2} - \\frac{1}{2} = 0$.\n- $\\pi_{21} = \\frac{1}{2} - x_{opt} = \\frac{1}{2} - \\frac{1}{2} = 0$.\n- $\\pi_{22} = x_{opt} = \\frac{1}{2}$.\n\nSo the optimal transport plan is:\n$$\n\\Pi^* = \\begin{pmatrix} \\frac{1}{2} & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix}\n$$\nThis plan corresponds to sending all supply from bakery $B_1$ to cafe $C_1$ and all supply from bakery $B_2$ to cafe $C_2$, which is the non-crossing matching.\n\nThe final answer should be presented as a row matrix: $\\begin{pmatrix} \\pi_{11} & \\pi_{12} & \\pi_{21} & \\pi_{22} \\end{pmatrix}$.\nThis is $\\begin{pmatrix} \\frac{1}{2} & 0 & 0 & \\frac{1}{2} \\end{pmatrix}$.", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2} & 0 & 0 & \\frac{1}{2} \\end{pmatrix}}$$", "id": "1424977"}, {"introduction": "Having understood discrete transport plans, we now turn to the continuous case in one dimension, which often allows for an elegant solution in the form of a \"transport map\". This problem demonstrates a powerful technique for finding the optimal map when the cost is convex, using the cumulative distribution functions (CDFs) of the source and target measures. You will see how a seemingly complex problem of reshaping one continuous distribution into another can be solved by a simple functional transformation. [@problem_id:1424962]", "problem": "Consider a problem of resource allocation. A continuous resource is initially distributed uniformly over the interval $I = [0, 1]$. The probability density function for this initial distribution is $f(x)=1$ for $x \\in I$ and zero otherwise. This resource needs to be moved and rearranged to match a target distribution on the interval $J = [0, \\infty)$. The target distribution is described by the probability density function $g(y) = \\exp(-y)$ for $y \\in J$.\n\nThe cost of transporting a small amount of resource from a point $x \\in I$ to a point $y \\in J$ is proportional to the square of the distance between them. The goal is to find a transport map, $T: I \\to J$, which is a strictly increasing function that assigns to each initial point $x$ a unique final point $y = T(x)$, such that the total cost of this rearrangement is minimized.\n\nDetermine the explicit functional form of this optimal transport map, $T(x)$.", "solution": "We seek the optimal transport map for the quadratic cost $c(x,y)=(x-y)^{2}$ from the source probability density $f(x)=1$ on $I=[0,1]$ to the target probability density $g(y)=\\exp(-y)$ on $J=[0,\\infty)$. In one dimension with a convex cost, the optimal Monge map is the monotone rearrangement, which is uniquely characterized (up to sets of measure zero) by the pushforward condition and is strictly increasing. For a strictly increasing transport map $T$, the pushforward condition is equivalently expressed in terms of cumulative distribution functions: if $F$ and $G$ are the CDFs of $f$ and $g$, then\n$$\nF(x)=G(T(x)) \\quad \\text{for all } x \\in [0,1].\n$$\nThis follows from mass conservation on intervals: for any $x \\in [0,1]$, the mass of $[0,x]$ under $f$ equals the mass of $[0,T(x)]$ under $g$. Therefore the optimal map is given by the quantile formula\n$$\nT(x)=G^{-1}(F(x)).\n$$\nWe compute the CDFs. For $f(x)=1$ on $[0,1]$, its CDF is\n$$\nF(x)=x \\quad \\text{for } x \\in [0,1].\n$$\nFor $g(y)=\\exp(-y)$ on $[0,\\infty)$, its CDF is\n$$\nG(y)=\\int_{0}^{y}\\exp(-t)\\,dt=1-\\exp(-y) \\quad \\text{for } y \\geq 0.\n$$\nTo obtain the quantile function, solve $u=G(y)=1-\\exp(-y)$ for $y$:\n$$\n\\exp(-y)=1-u \\quad \\Longrightarrow \\quad y=-\\ln(1-u),\n$$\nso\n$$\nG^{-1}(u)=-\\ln(1-u) \\quad \\text{for } u \\in [0,1).\n$$\nHence the optimal transport map is\n$$\nT(x)=G^{-1}(F(x))=-\\ln(1-x) \\quad \\text{for } x \\in [0,1).\n$$\nThis $T$ is strictly increasing since $T'(x)=\\frac{1}{1-x}>0$ on $[0,1)$, satisfies the boundary condition $T(0)=0$, and as $x \\uparrow 1$, $T(x)\\to+\\infty$, matching the unbounded support of the exponential target. One may also verify the pushforward density identity $g(T(x))\\,T'(x)=f(x)$:\n$$\ng(T(x))\\,T'(x)=\\exp\\bigl(-T(x)\\bigr)\\cdot \\frac{1}{1-x}=\\exp\\bigl(\\ln(1-x)\\bigr)\\cdot \\frac{1}{1-x}=1=f(x).\n$$\nBy the one-dimensional monotone rearrangement theorem for convex costs, this $T$ is the unique optimal transport map.", "answer": "$$\\boxed{-\\ln(1-x)}$$", "id": "1424962"}, {"introduction": "Our previous exercises featured a standard quadratic cost, which is a convex function. But what happens if the cost is different? This exercise reveals the profound impact of the cost function's geometry on the optimal solution. By contrasting a convex cost with a concave one, you will discover that the optimal strategy can switch from an intuitive, order-preserving map to a surprising, order-reversing one, highlighting a crucial principle in optimal transport theory. [@problem_id:1424951]", "problem": "Consider two one-dimensional optimal transport problems. In both problems, the goal is to transport a source probability measure $\\mu$ to a target probability measure $\\nu$. The source measure $\\mu$ is the uniform probability measure on the interval $[0, 1]$, and the target measure $\\nu$ is the uniform probability measure on the interval $[1, 2]$.\n\nThe two problems differ only in their cost function, $c(x, y)$, which represents the cost of moving a unit of mass from a point $x \\in [0, 1]$ to a point $y \\in [1, 2]$.\n\n1.  **Problem 1:** The cost function is $c_1(x, y) = (x - y)^2$. Let $\\pi_1$ be the optimal transport plan that minimizes the total cost $\\int_{[0,1]\\times[1,2]} c_1(x, y) \\, d\\pi(x, y)$ over all valid transport plans $\\pi$. Let $S_1$ be the support of $\\pi_1$.\n\n2.  **Problem 2:** The cost function is $c_2(x, y) = \\sqrt{|x - y|}$. Let $\\pi_2$ be the optimal transport plan that minimizes the total cost $\\int_{[0,1]\\times[1,2]} c_2(x, y) \\, d\\pi(x, y)$ over all valid transport plans $\\pi$. Let $S_2$ be the support of $\\pi_2$.\n\nA function $T:[0,1] \\to [1,2]$ is called \"increasing\" if for any $x_1 < x_2$ in $[0,1]$, we have $T(x_1) \\leq T(x_2)$. It is called \"decreasing\" if for any $x_1 < x_2$ in $[0,1]$, we have $T(x_1) \\geq T(x_2)$. The support of a transport plan is the smallest closed set in $[0,1] \\times [1,2]$ on which the measure is concentrated.\n\nWhich of the following statements correctly describes the geometric nature of the supports $S_1$ and $S_2$?\n\nA. Both $S_1$ and $S_2$ are one-dimensional sets, each corresponding to the graph of a unique increasing function from $[0,1]$ to $[1,2]$.\n\nB. Both $S_1$ and $S_2$ are one-dimensional sets, each corresponding to the graph of a unique decreasing function from $[0,1]$ to $[1,2]$.\n\nC. $S_1$ is a one-dimensional set corresponding to the graph of a unique increasing function, while $S_2$ is a one-dimensional set corresponding to the graph of a unique decreasing function.\n\nD. $S_1$ is a one-dimensional set corresponding to the graph of a function, while $S_2$ is the two-dimensional set $[0,1] \\times [1,2]$.\n\nE. $S_1$ is a one-dimensional set corresponding to the graph of a unique decreasing function, while $S_2$ is a one-dimensional set corresponding to the graph of a unique increasing function.\n\nF. Both $S_1$ and $S_2$ are the two-dimensional set $[0,1] \\times [1,2]$, as the plans are not deterministic.", "solution": "We consider the two one-dimensional optimal transport problems on $[0,1] \\times [1,2]$ with source $\\mu$ uniform on $[0,1]$ and target $\\nu$ uniform on $[1,2]$.\n\nProblem 1: $c_{1}(x,y)=(x-y)^{2}$. In one dimension, for costs of the form $c(x,y)=h(y-x)$ with $h$ strictly convex, the optimal plan is induced by the monotone rearrangement map $T_{1}=F_{\\nu}^{-1}\\circ F_{\\mu}$; moreover, it is unique and monotone increasing. Here $F_{\\mu}(x)=x$ for $x\\in[0,1]$, $F_{\\nu}(y)=y-1$ for $y\\in[1,2]$, and hence $F_{\\nu}^{-1}(u)=u+1$ for $u\\in[0,1]$. Therefore\n$$\nT_{1}(x)=F_{\\nu}^{-1}(F_{\\mu}(x))=x+1,\n$$\nwhich is increasing on $[0,1]$. The optimal plan $\\pi_{1}$ is deterministic and its support is the graph\n$$\nS_{1}=\\{(x,T_{1}(x)):(x\\in[0,1])\\}=\\{(x,x+1):x\\in[0,1]\\},\n$$\na one-dimensional set. Uniqueness follows from strict convexity and the twist condition.\n\nProblem 2: $c_{2}(x,y)=\\sqrt{|x-y|}$. Since $x\\in[0,1]$ and $y\\in[1,2]$, we have $y\\ge x$ for all feasible pairs, hence $|x-y|=y-x$. Define $h(r)=r^{1/2}$ for $r\\ge 0$. Then $h$ is strictly concave and increasing. For any coupling of $(X,Y)$ with marginals $\\mu$ and $\\nu$, the mean distance satisfies\n$$\n\\mathbb{E}[Y-X]=\\mathbb{E}[Y]-\\mathbb{E}[X]=1,\n$$\nwhich is fixed across all couplings. To minimize $\\mathbb{E}[h(Y-X)]$ with $h$ strictly concave and fixed mean of $Y-X$, one should maximize the dispersion of $Y-X$. This can be formalized by a two-point swap argument: take $x_{1}<x_{2}$ and $y_{1}<y_{2}$. Denote $r=y_{1}-x_{1}$ and $s=y_{2}-x_{2}$, both nonnegative. The monotone pairing uses $(x_{1},y_{1})$ and $(x_{2},y_{2})$ with total cost $h(r)+h(s)$. The anti-monotone pairing uses $(x_{1},y_{2})$ and $(x_{2},y_{1})$ with distances $r+\\delta$ and $s-\\delta$, where\n$$\n\\delta=(y_{2}-y_{1})-(x_{2}-x_{1}).\n$$\nNote that $r+\\delta=y_{2}-x_{1}\\ge 0$ and $s-\\delta=y_{1}-x_{2}\\ge 0$ since $y_{1}\\ge 1\\ge x_{2}$. The sums of the two distances are equal:\n$$\n(r+\\delta)+(s-\\delta)=r+s=(y_{1}-x_{1})+(y_{2}-x_{2}).\n$$\nSince $h$ is strictly concave, among pairs with fixed sum, the sum of $h$ is strictly smaller for the more spread pair unless $\\delta=0$. Therefore\n$$\nh(y_{1}-x_{1})+h(y_{2}-x_{2})>h(y_{2}-x_{1})+h(y_{1}-x_{2})\n$$\nwhenever $\\delta\\ne 0$. Iterating this swap argument shows that any plan that is not fully anti-monotone can be improved, so an optimal plan must be supported on a decreasing relation. Because the marginals are continuous and uniform on intervals of equal length, the only decreasing measure-preserving transport map is\n$$\nT_{2}(x)=2-x,\n$$\nwhich indeed pushes $\\mu$ to $\\nu$. The induced plan is deterministic, strictly optimal (by strict concavity, any deviation raises cost), and unique up to $\\mu$-null sets. Its support is the graph\n$$\nS_{2}=\\{(x,T_{2}(x)):(x\\in[0,1])\\}=\\{(x,2-x):x\\in[0,1]\\},\n$$\na one-dimensional set, and $T_{2}$ is decreasing.\n\nPutting these together: $S_{1}$ is a one-dimensional graph of a unique increasing function, and $S_{2}$ is a one-dimensional graph of a unique decreasing function. This corresponds to option C.", "answer": "$$\\boxed{C}$$", "id": "1424951"}]}