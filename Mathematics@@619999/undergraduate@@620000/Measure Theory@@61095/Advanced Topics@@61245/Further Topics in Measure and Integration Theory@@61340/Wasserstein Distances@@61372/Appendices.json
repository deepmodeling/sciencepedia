{"hands_on_practices": [{"introduction": "A fundamental method for calculating the 1-Wasserstein distance on the real line involves integrating the absolute difference between the Cumulative Distribution Functions (CDFs). This exercise provides a foundational application of this technique, allowing you to practice constructing the step-function CDFs for discrete measures and computing the resulting integral. Mastering this calculation is a key first step to working with Wasserstein distances [@problem_id:1465007].", "problem": "In the field of optimal transport, the 1-Wasserstein distance is used to measure the \"cost\" of transforming one probability distribution into another. For two probability measures $\\mu$ and $\\nu$ on the real line $\\mathbb{R}$, this distance, denoted $W_1(\\mu, \\nu)$, can be calculated using their respective Cumulative Distribution Functions (CDFs). The CDF of a measure $\\sigma$, denoted $F_\\sigma(t)$, is defined as the total measure of the interval $(-\\infty, t]$, i.e., $F_\\sigma(t) = \\sigma((-\\infty, t])$. The 1-Wasserstein distance is then given by the total area between their CDFs:\n\n$$W_1(\\mu, \\nu) = \\int_{-\\infty}^{\\infty} |F_\\mu(t) - F_\\nu(t)| \\, dt$$\n\nThe Dirac delta measure, $\\delta_a$, represents a probability distribution where the entire probability mass is concentrated at a single point $a$.\n\nConsider two discrete probability measures, $\\mu$ and $\\nu$, defined on the real line as follows:\n- The measure $\\mu$ is given by $\\mu = \\frac{1}{3}\\delta_{-2} + \\frac{2}{3}\\delta_{1}$. This means $\\mu$ places a probability mass of $1/3$ at the point $x=-2$ and a mass of $2/3$ at the point $x=1$.\n- The measure $\\nu$ is given by $\\nu = \\frac{1}{2}\\delta_{0} + \\frac{1}{2}\\delta_{3}$. This means $\\nu$ places a probability mass of $1/2$ at the point $x=0$ and a mass of $1/2$ at the point $x=3$.\n\nCalculate the 1-Wasserstein distance, $W_1(\\mu, \\nu)$, between these two measures. Express your answer as an exact fraction in simplest form.", "solution": "We use the 1-Wasserstein distance formula on the real line:\n$$\nW_{1}(\\mu,\\nu)=\\int_{-\\infty}^{\\infty}\\left|F_{\\mu}(t)-F_{\\nu}(t)\\right|\\,dt.\n$$\nFor the given discrete measures, their CDFs are step functions. From $\\mu=\\frac{1}{3}\\delta_{-2}+\\frac{2}{3}\\delta_{1}$, we have\n$$\nF_{\\mu}(t)=\\begin{cases}\n0 & \\text{if } t < -2\\\\\n\\frac{1}{3} & \\text{if } -2\\le t<1\\\\\n1 & \\text{if } t\\ge 1\n\\end{cases}\n$$\nFrom $\\nu=\\frac{1}{2}\\delta_{0}+\\frac{1}{2}\\delta_{3}$, we have\n$$\nF_{\\nu}(t)=\\begin{cases}\n0 & \\text{if } t < 0\\\\\n\\frac{1}{2} & \\text{if } 0\\le t<3\\\\\n1 & \\text{if } t\\ge 3\n\\end{cases}\n$$\nThe only points where the CDFs change are at $-2,0,1,3$. On each interval between these points, $|F_{\\mu}-F_{\\nu}|$ is constant, so the integral is the sum over these intervals of (interval length)$\\times$(absolute difference).\n\n- For $(-\\infty,-2)$: $F_{\\mu}=0$, $F_{\\nu}=0$, so the contribution is $0$.\n- For $[-2,0)$: $F_{\\mu}=\\frac{1}{3}$, $F_{\\nu}=0$, so the contribution is $(0-(-2))\\cdot\\left|\\frac{1}{3}-0\\right|=2\\cdot\\frac{1}{3}=\\frac{2}{3}$.\n- For $[0,1)$: $F_{\\mu}=\\frac{1}{3}$, $F_{\\nu}=\\frac{1}{2}$, so the contribution is $(1-0)\\cdot\\left|\\frac{1}{3}-\\frac{1}{2}\\right|=1\\cdot\\frac{1}{6}=\\frac{1}{6}$.\n- For $[1,3)$: $F_{\\mu}=1$, $F_{\\nu}=\\frac{1}{2}$, so the contribution is $(3-1)\\cdot\\left|1-\\frac{1}{2}\\right|=2\\cdot\\frac{1}{2}=1$.\n- For $[3,\\infty)$: $F_{\\mu}=1$, $F_{\\nu}=1$, so the contribution is $0$.\n\nSumming these contributions gives\n$$\nW_{1}(\\mu,\\nu)=\\frac{2}{3}+\\frac{1}{6}+1=\\frac{11}{6}.\n$$", "answer": "$$\\boxed{\\frac{11}{6}}$$", "id": "1465007"}, {"introduction": "After applying the CDF-based formula to discrete measures, it is natural to explore its application to continuous distributions. This practice problem investigates the $W_1$ distance between two uniform distributions, leading to a surprisingly simple and intuitive result [@problem_id:1465037]. By working through this example, you will develop a geometric intuition for the area between CDF curves and see how the Wasserstein distance can capture significant structural properties of distributions.", "problem": "In measure theory and statistics, the Wasserstein distance provides a way to measure the \"distance\" between two probability distributions. For two one-dimensional probability distributions $\\mu$ and $\\nu$ with cumulative distribution functions (CDFs) $F_\\mu(x)$ and $F_\\nu(x)$ respectively, the 1-Wasserstein distance between them is defined as:\n$$\nW_1(\\mu, \\nu) = \\int_{-\\infty}^{\\infty} |F_\\mu(x) - F_\\nu(x)| dx\n$$\n\nConsider two distinct uniform probability distributions, $\\mu_A$ and $\\mu_B$.\nThe distribution $\\mu_A$ is uniform on the interval centered at $c_A$ with a half-width of $R > 0$, which corresponds to the interval $[c_A - R, c_A + R]$.\nThe distribution $\\mu_B$ is uniform on the interval centered at $c_B$ with the same half-width $R$, which corresponds to the interval $[c_B - R, c_B + R]$.\n\nAssume that $c_B > c_A$ and that the two intervals are disjoint, which means the condition $c_A + R \\le c_B - R$ is satisfied.\n\nCalculate the 1-Wasserstein distance, $W_1(\\mu_A, \\mu_B)$, between these two distributions. Express your answer as a closed-form analytic expression in terms of $c_A$ and $c_B$.", "solution": "The problem asks for the 1-Wasserstein distance $W_1(\\mu_A, \\mu_B)$ between two uniform distributions, $\\mu_A$ on $[c_A - R, c_A + R]$ and $\\mu_B$ on $[c_B - R, c_B + R]$. The distance is defined as $W_1(\\mu_A, \\mu_B) = \\int_{-\\infty}^{\\infty} |F_A(x) - F_B(x)| dx$, where $F_A(x)$ and $F_B(x)$ are the cumulative distribution functions (CDFs) of $\\mu_A$ and $\\mu_B$, respectively.\n\nFirst, we must determine the CDFs for each distribution.\nFor a uniform distribution on an interval $[a, b]$, the probability density function (PDF), $p(x)$, is $p(x) = \\frac{1}{b-a}$ for $x \\in [a, b]$ and $0$ otherwise. The CDF, $F(x) = \\int_{-\\infty}^x p(t) dt$, is then $\\frac{x-a}{b-a}$ for $x \\in [a, b]$, $0$ for $x < a$, and $1$ for $x > b$.\n\nFor distribution $\\mu_A$ on the interval $[c_A - R, c_A + R]$, the length of the interval is $(c_A + R) - (c_A - R) = 2R$. The PDF is $p_A(x) = \\frac{1}{2R}$ for $x \\in [c_A - R, c_A + R]$.\nThe CDF, $F_A(x)$, is:\n$$\nF_A(x) = \n\\begin{cases}\n    0 & \\text{if } x < c_A - R \\\\\n    \\frac{x - (c_A - R)}{2R} & \\text{if } c_A - R \\le x \\le c_A + R \\\\\n    1 & \\text{if } x > c_A + R\n\\end{cases}\n$$\n\nSimilarly, for distribution $\\mu_B$ on the interval $[c_B - R, c_B + R]$, the length is $2R$ and the PDF is $p_B(x) = \\frac{1}{2R}$ for $x \\in [c_B - R, c_B + R]$.\nThe CDF, $F_B(x)$, is:\n$$\nF_B(x) = \n\\begin{cases}\n    0 & \\text{if } x < c_B - R \\\\\n    \\frac{x - (c_B - R)}{2R} & \\text{if } c_B - R \\le x \\le c_B + R \\\\\n    1 & \\text{if } x > c_B + R\n\\end{cases}\n$$\n\nNow, we must compute the integral $W_1(\\mu_A, \\mu_B) = \\int_{-\\infty}^{\\infty} |F_A(x) - F_B(x)| dx$.\nWe are given that $c_B > c_A$ and $c_A + R \\le c_B - R$. This ordering implies the critical points for the piecewise CDFs are ordered as $c_A - R < c_A + R \\le c_B - R < c_B + R$. We can split the integral over the entire real line into five regions based on these points.\n\n1.  For $x < c_A - R$:\n    $F_A(x) = 0$ and $F_B(x) = 0$. So, $|F_A(x) - F_B(x)| = 0$. The integral over $(-\\infty, c_A - R)$ is $0$.\n\n2.  For $c_A - R \\le x \\le c_A + R$:\n    $F_A(x) = \\frac{x - c_A + R}{2R}$ and $F_B(x) = 0$ (since $x \\le c_A + R \\le c_B - R$).\n    The integral in this region is:\n    $$\n    I_1 = \\int_{c_A - R}^{c_A + R} \\left| \\frac{x - c_A + R}{2R} - 0 \\right| dx = \\int_{c_A - R}^{c_A + R} \\frac{x - c_A + R}{2R} dx\n    $$\n    This integral represents the area of a right triangle with base $(c_A + R) - (c_A - R) = 2R$ and height $F_A(c_A+R) = \\frac{(c_A+R)-c_A+R}{2R} = 1$. The area is $\\frac{1}{2} \\times \\text{base} \\times \\text{height} = \\frac{1}{2} (2R)(1) = R$.\n\n3.  For $c_A + R < x < c_B - R$:\n    $F_A(x) = 1$ and $F_B(x) = 0$. So, $|F_A(x) - F_B(x)| = |1 - 0| = 1$.\n    The integral in this region is:\n    $$\n    I_2 = \\int_{c_A + R}^{c_B - R} 1 \\, dx = [x]_{c_A + R}^{c_B - R} = (c_B - R) - (c_A + R) = c_B - c_A - 2R\n    $$\n\n4.  For $c_B - R \\le x \\le c_B + R$:\n    $F_A(x) = 1$ and $F_B(x) = \\frac{x - c_B + R}{2R}$.\n    The integral in this region is:\n    $$\n    I_3 = \\int_{c_B - R}^{c_B + R} \\left| 1 - \\frac{x - c_B + R}{2R} \\right| dx = \\int_{c_B - R}^{c_B + R} \\left| \\frac{2R - (x - c_B + R)}{2R} \\right| dx = \\int_{c_B - R}^{c_B + R} \\frac{c_B + R - x}{2R} dx\n    $$\n    The term $c_B + R - x$ is non-negative in this interval. This integral represents the area of a right triangle with base $(c_B + R) - (c_B - R) = 2R$ and height at $x=c_B-R$ being $\\frac{c_B+R-(c_B-R)}{2R} = \\frac{2R}{2R} = 1$. The area is $\\frac{1}{2} (2R)(1) = R$.\n\n5.  For $x > c_B + R$:\n    $F_A(x) = 1$ and $F_B(x) = 1$. So, $|F_A(x) - F_B(x)| = 0$. The integral over $(c_B + R, \\infty)$ is $0$.\n\nThe total 1-Wasserstein distance is the sum of the integrals over these regions:\n$$\nW_1(\\mu_A, \\mu_B) = I_1 + I_2 + I_3 = R + (c_B - c_A - 2R) + R\n$$\n$$\nW_1(\\mu_A, \\mu_B) = c_B - c_A\n$$\nThe result shows that the distance depends only on the difference between the centers of the two distributions, $c_A$ and $c_B$, and is independent of the half-width $R$. Given $c_B > c_A$, this is the distance between the centers.", "answer": "$$\\boxed{c_B - c_A}$$", "id": "1465037"}, {"introduction": "The Wasserstein distance is fundamentally a solution to an optimal transport problem, giving rise to its interpretation as the \"earth mover's distance.\" This exercise delves into this core concept by asking you to find the explicit optimal transport plan that minimizes the cost of reconfiguring one discrete distribution into another [@problem_id:1465059]. Solving this problem provides a concrete understanding of the transport analogy and the underlying optimization that defines the distance.", "problem": "Consider a simple logistics problem for distributing a resource. A company has two supply depots located at positions $x_1=0$ and $x_2=2$ along a straight highway. Each depot holds exactly half of the total available resource. This resource needs to be delivered to two distribution centers located at positions $y_1=1$ and $y_2=3$ along the same highway. Each distribution center demands exactly half of the total resource.\n\nThis distribution can be modeled using a concept from measure theory called optimal transport. The initial resource distribution is represented by a probability measure $\\mu = \\frac{1}{2}\\delta_0 + \\frac{1}{2}\\delta_2$, where $\\delta_x$ is the Dirac delta measure, signifying a point mass at position $x$. The target distribution at the centers is given by the measure $\\nu = \\frac{1}{2}\\delta_1 + \\frac{1}{2}\\delta_3$.\n\nA \"transport plan\" specifies how much resource to move from each depot to each center. For this discrete case, a transport plan $\\gamma$ can be represented by a $2 \\times 2$ matrix $\\Gamma = (\\gamma_{ij})$, where $\\gamma_{ij}$ is the fraction of the total resource moved from depot $i$ (at position $x_i$) to center $j$ (at position $y_j$). A valid plan must satisfy the supply and demand constraints: the total resource shipped from each depot and the total resource received by each center must match the given distributions.\n\nThe cost of transporting one unit of resource from a location $x$ to a location $y$ is proportional to the distance traveled, so we can define the cost as $c(x,y) = |x-y|$. The total transport cost for a given plan is the sum of the costs for all individual movements, weighted by the fraction of resource moved along each path. The goal of optimal transport is to find the plan that minimizes this total cost.\n\nYour task is to determine the optimal transport plan for this scenario. Find the matrix $\\Gamma_{opt} = \\begin{pmatrix} \\gamma_{11} & \\gamma_{12} \\\\ \\gamma_{21} & \\gamma_{22} \\end{pmatrix}$ that minimizes the total transport cost. The element $\\gamma_{11}$ represents the fraction of resource moved from depot $x_1=0$ to center $y_1=1$, $\\gamma_{12}$ from $x_1=0$ to $y_2=3$, $\\gamma_{21}$ from $x_2=2$ to $y_1=1$, and $\\gamma_{22}$ from $x_2=2$ to $y_2=3$.", "solution": "The problem asks for the optimal transport plan $\\gamma$, represented by a matrix $\\Gamma = (\\gamma_{ij})$, that minimizes the cost of moving mass from a distribution $\\mu = \\frac{1}{2}\\delta_0 + \\frac{1}{2}\\delta_2$ to a distribution $\\nu = \\frac{1}{2}\\delta_1 + \\frac{1}{2}\\delta_3$.\n\nFirst, let's establish the constraints on the elements $\\gamma_{ij}$ of the transport matrix $\\Gamma$. The matrix is indexed such that $i=1$ corresponds to the source point $x_1=0$, $i=2$ to $x_2=2$, $j=1$ to the destination point $y_1=1$, and $j=2$ to $y_2=3$.\n\nThe marginal constraints require that the sum of each row equals the mass at the corresponding source point, and the sum of each column equals the mass at the corresponding destination point.\n\nRow sums (supply constraints):\n1.  The total mass leaving $x_1=0$ must be $\\mu(\\{0\\}) = 1/2$. So, $\\gamma_{11} + \\gamma_{12} = \\frac{1}{2}$.\n2.  The total mass leaving $x_2=2$ must be $\\mu(\\{2\\}) = 1/2$. So, $\\gamma_{21} + \\gamma_{22} = \\frac{1}{2}$.\n\nColumn sums (demand constraints):\n1.  The total mass arriving at $y_1=1$ must be $\\nu(\\{1\\}) = 1/2$. So, $\\gamma_{11} + \\gamma_{21} = \\frac{1}{2}$.\n2.  The total mass arriving at $y_2=3$ must be $\\nu(\\{3\\}) = 1/2$. So, $\\gamma_{12} + \\gamma_{22} = \\frac{1}{2}$.\n\nAdditionally, the amount of mass moved cannot be negative, so $\\gamma_{ij} \\ge 0$ for all $i,j \\in \\{1, 2\\}$.\n\nNext, we define the total cost function to be minimized. The cost of moving a unit mass from source $x_i$ to destination $y_j$ is $c_{ij} = |x_i - y_j|$. Let's compute the cost matrix $C = (c_{ij})$:\n$c_{11} = |x_1 - y_1| = |0 - 1| = 1$\n$c_{12} = |x_1 - y_2| = |0 - 3| = 3$\n$c_{21} = |x_2 - y_1| = |2 - 1| = 1$\n$c_{22} = |x_2 - y_2| = |2 - 3| = 1$\n\nSo the cost matrix is $C = \\begin{pmatrix} 1 & 3 \\\\ 1 & 1 \\end{pmatrix}$.\n\nThe total transport cost, which we want to minimize, is given by the sum of the products of costs and corresponding mass fractions:\n$$ \\mathcal{C}(\\Gamma) = \\sum_{i=1}^{2}\\sum_{j=1}^{2} c_{ij} \\gamma_{ij} = 1\\gamma_{11} + 3\\gamma_{12} + 1\\gamma_{21} + 1\\gamma_{22} $$\n\nNow we solve this constrained minimization problem. The four linear constraints on $\\gamma_{ij}$ are not independent. Let's express all variables in terms of one, say $\\gamma_{11}$. Let $\\gamma_{11} = t$.\nFrom the first row sum constraint: $\\gamma_{12} = \\frac{1}{2} - \\gamma_{11} = \\frac{1}{2} - t$.\nFrom the first column sum constraint: $\\gamma_{21} = \\frac{1}{2} - \\gamma_{11} = \\frac{1}{2} - t$.\nFrom the second row sum constraint: $\\gamma_{22} = \\frac{1}{2} - \\gamma_{21} = \\frac{1}{2} - \\left(\\frac{1}{2} - t\\right) = t$.\nWe can check that this also satisfies the second column sum constraint: $\\gamma_{12} + \\gamma_{22} = (\\frac{1}{2} - t) + t = \\frac{1}{2}$.\n\nSo, any valid transport plan can be written as a function of the single parameter $t$:\n$$ \\Gamma(t) = \\begin{pmatrix} t & \\frac{1}{2} - t \\\\ \\frac{1}{2} - t & t \\end{pmatrix} $$\nThe non-negativity constraint $\\gamma_{ij} \\ge 0$ implies $t \\ge 0$ and $\\frac{1}{2} - t \\ge 0$, which means $t \\le \\frac{1}{2}$. Thus, the valid range for $t$ is $0 \\le t \\le \\frac{1}{2}$.\n\nNow, we express the total cost $\\mathcal{C}$ as a function of $t$:\n$$ \\mathcal{C}(t) = 1(t) + 3\\left(\\frac{1}{2} - t\\right) + 1\\left(\\frac{1}{2} - t\\right) + 1(t) $$\n$$ \\mathcal{C}(t) = t + \\frac{3}{2} - 3t + \\frac{1}{2} - t + t $$\n$$ \\mathcal{C}(t) = \\left(\\frac{3}{2} + \\frac{1}{2}\\right) + (1 - 3 - 1 + 1)t $$\n$$ \\mathcal{C}(t) = 2 - 2t $$\n\nTo minimize $\\mathcal{C}(t) = 2 - 2t$ on the interval $t \\in [0, \\frac{1}{2}]$, we need to make the term $-2t$ as small as possible. This means we should choose the largest possible value for $t$. The maximum value for $t$ in its domain is $t = \\frac{1}{2}$.\n\nSubstituting $t = \\frac{1}{2}$ into our parameterized matrix $\\Gamma(t)$, we find the optimal transport plan:\n$\\gamma_{11} = t = \\frac{1}{2}$\n$\\gamma_{12} = \\frac{1}{2} - t = \\frac{1}{2} - \\frac{1}{2} = 0$\n$\\gamma_{21} = \\frac{1}{2} - t = \\frac{1}{2} - \\frac{1}{2} = 0$\n$\\gamma_{22} = t = \\frac{1}{2}$\n\nThus, the optimal transport matrix is:\n$$ \\Gamma_{opt} = \\begin{pmatrix} \\frac{1}{2} & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix} $$\nThis plan corresponds to moving all the resource from depot $x_1=0$ to center $y_1=1$ and all the resource from depot $x_2=2$ to center $y_2=3$. This is the Monge solution, which avoids the more expensive \"cross\" transports (e.g., from $x_1=0$ to $y_2=3$).", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2} & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix}}$$", "id": "1465059"}]}