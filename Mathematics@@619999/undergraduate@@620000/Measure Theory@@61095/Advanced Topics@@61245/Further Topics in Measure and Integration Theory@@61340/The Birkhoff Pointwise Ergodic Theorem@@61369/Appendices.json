{"hands_on_practices": [{"introduction": "Let's begin with a concrete and intuitive example to build our understanding of time averages. This practice explores a system with a finite number of states that evolve in a perfectly predictable cycle [@problem_id:1447062]. By calculating the long-term average value of a property in this simple system, you will see a direct illustration of how the temporal behavior of a trajectory can reflect the overall properties of the entire state space, a core idea of ergodic theory.", "problem": "Consider a system with a finite number of states, labeled by the integers in the set $X = \\{1, 2, \\dots, N\\}$ for some integer $N \\ge 2$. The system evolves in discrete time steps. If the system is in state $k$ at time $t$, it transitions to a new state at time $t+1$ according to the transformation rule $T: X \\to X$, defined as $T(k) = (k \\pmod N) + 1$.\n\nAn observable quantity, denoted by $f$, is measured at each state. The value of this observable when the system is in state $k$ is given by the function $f(k) = k$.\n\nFor any initial state $k_0 \\in X$, we can define the time average of the observable $f$ along the trajectory starting from $k_0$. If the sequence of states visited is $k_0, k_1, k_2, \\dots$, where $k_{m+1} = T(k_m)$, the time average is given by the limit:\n$$\n\\hat{f}(k_0) = \\lim_{M \\to \\infty} \\frac{1}{M}\\sum_{m=0}^{M-1} f(k_m)\n$$\nIt can be shown that this limit exists and is independent of the starting state $k_0$. Calculate this time average. Your answer should be a closed-form analytic expression in terms of $N$.", "solution": "The map $T(k)=(k \\bmod N)+1$ generates a cycle through all states in $X=\\{1,2,\\dots,N\\}$. For any initial $k_{0}\\in X$, define the trajectory by $k_{m+1}=T(k_{m})$. By induction one obtains the explicit form\n$$\nk_{m}=\\bigl((k_{0}+m-1)\\bmod N\\bigr)+1,\n$$\nso the sequence $\\{k_{m}\\}_{m=0}^{N-1}$ is a permutation of $\\{1,2,\\dots,N\\}$ and $k_{m+N}=k_{m}$ for all $m$, i.e., the orbit is periodic with period $N$.\n\nLet $S_{N}=\\sum_{j=1}^{N}j$. Because each block of $N$ consecutive steps visits every state exactly once, for any integer $\\ell\\ge 0$,\n$$\n\\sum_{m=\\ell N}^{\\ell N+N-1} f(k_{m})=\\sum_{m=\\ell N}^{\\ell N+N-1} k_{m}=S_{N}.\n$$\nFor an arbitrary $M$, write $M=qN+r$ with integers $q\\ge 0$ and $0\\le r<N$. Then\n$$\n\\sum_{m=0}^{M-1} f(k_{m})=\\sum_{m=0}^{qN-1} f(k_{m})+\\sum_{m=qN}^{qN+r-1} f(k_{m})=qS_{N}+R_{r},\n$$\nwhere $R_{r}=\\sum_{m=qN}^{qN+r-1} f(k_{m})$ satisfies $0\\le R_{r}\\le rN$. Hence the time average satisfies\n$$\n\\frac{1}{M}\\sum_{m=0}^{M-1} f(k_{m})=\\frac{qS_{N}+R_{r}}{qN+r}.\n$$\nTaking $M\\to\\infty$ forces $q\\to\\infty$ while $0\\le r<N$ remains bounded, so $R_{r}/(qN+r)\\to 0$ and\n$$\n\\hat{f}(k_{0})=\\lim_{M\\to\\infty}\\frac{1}{M}\\sum_{m=0}^{M-1} f(k_{m})=\\frac{S_{N}}{N}.\n$$\nEvaluating $S_{N}$ gives\n$$\nS_{N}=\\sum_{j=1}^{N} j=\\frac{N(N+1)}{2},\n$$\nso the time average, independent of $k_{0}$, is\n$$\n\\hat{f}(k_{0})=\\frac{1}{N}\\cdot \\frac{N(N+1)}{2}=\\frac{N+1}{2}.\n$$", "answer": "$$\\boxed{\\frac{N+1}{2}}$$", "id": "1447062"}, {"introduction": "The Birkhoff Ergodic Theorem connects time and space averages, but a key condition is \"ergodicity\"â€“the idea that the system explores its entire state space over time. This exercise demonstrates what happens when this condition is not met [@problem_id:1447100]. By analyzing a system that is broken into separate, invariant cycles, you will discover that the time average can depend on the starting point, providing crucial insight into why ergodicity is such a fundamental concept.", "problem": "Let $X = \\{1, 2, 3, 4, 5\\}$ be a discrete space. Consider a transformation $T: X \\to X$ defined by the permutation $T(1)=2$, $T(2)=3$, $T(3)=1$, $T(4)=5$, and $T(5)=4$. Let $f: X \\to \\mathbb{R}$ be a function defined by $f(k) = k^2$.\n\nThe long-term time average of the function $f$ starting from a point $k \\in X$ is defined by the limit:\n$$ \\bar{f}(k) = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} f(T^n k) $$\nwhere $T^n k$ denotes applying the transformation $T$ for $n$ times, with $T^0 k = k$.\n\nYour task is to compute the function $\\bar{f}: X \\to \\mathbb{R}$. Which of the following options correctly specifies the function $\\bar{f}$?\n\nA. $\\bar{f}(k) = 11$ for all $k \\in X$.\n\nB. $\\bar{f}(k) = 2$ for $k \\in \\{1,2,3\\}$, and $\\bar{f}(k) = 4.5$ for $k \\in \\{4,5\\}$.\n\nC. $\\bar{f}(k) = \\frac{14}{3}$ for $k \\in \\{1,2,3\\}$, and $\\bar{f}(k) = \\frac{41}{2}$ for $k \\in \\{4,5\\}$.\n\nD. $\\bar{f}(k) = \\frac{41}{2}$ for $k \\in \\{1,2,3\\}$, and $\\bar{f}(k) = \\frac{14}{3}$ for $k \\in \\{4,5\\}$.\n\nE. $\\bar{f}(k) = \\frac{14}{5}$ for $k \\in \\{1,2,3\\}$, and $\\bar{f}(k) = \\frac{41}{5}$ for $k \\in \\{4,5\\}$.", "solution": "Because $X$ is finite and $T$ is a permutation, every point $k \\in X$ lies on a periodic orbit. If the period of $k$ is $m \\in \\mathbb{N}$, then $T^{m}k=k$ and the sequence $\\{f(T^{n}k)\\}_{n \\geq 0}$ is periodic with period $m$. For $N=qm+r$ with $q \\in \\mathbb{N}$ and $0 \\leq r < m$, we have\n$$\n\\sum_{n=0}^{N-1} f(T^{n}k)=q \\sum_{n=0}^{m-1} f(T^{n}k)+\\sum_{n=0}^{r-1} f(T^{n}k).\n$$\nDividing by $N$ gives\n$$\n\\frac{1}{N}\\sum_{n=0}^{N-1} f(T^{n}k) = \\frac{q}{N} \\sum_{n=0}^{m-1} f(T^{n}k) + \\frac{1}{N}\\sum_{n=0}^{r-1} f(T^{n}k).\n$$\nAs $N \\to \\infty$, we have $\\frac{q}{N} \\to \\frac{1}{m}$ and the remainder term tends to $0$ since $f$ is bounded on the finite set $X$. Therefore,\n$$\n\\bar{f}(k)=\\lim_{N \\to \\infty} \\frac{1}{N}\\sum_{n=0}^{N-1} f(T^{n}k)=\\frac{1}{m}\\sum_{n=0}^{m-1} f(T^{n}k),\n$$\nthe average of $f$ over one period of the orbit through $k$.\n\nThe permutation $T$ has two disjoint cycles: $(1\\,2\\,3)$ of length $3$ and $(4\\,5)$ of length $2$. Hence, for $k \\in \\{1,2,3\\}$,\n$$\n\\bar{f}(k)=\\frac{1}{3}\\big(f(1)+f(2)+f(3)\\big)=\\frac{1}{3}\\big(1^{2}+2^{2}+3^{2}\\big)=\\frac{1+4+9}{3}=\\frac{14}{3},\n$$\nand for $k \\in \\{4,5\\}$,\n$$\n\\bar{f}(k)=\\frac{1}{2}\\big(f(4)+f(5)\\big)=\\frac{1}{2}\\big(4^{2}+5^{2}\\big)=\\frac{16+25}{2}=\\frac{41}{2}.\n$$\nComparing with the options, this matches option C.", "answer": "$$\\boxed{C}$$", "id": "1447100"}, {"introduction": "This final practice showcases the true power and elegance of the Birkhoff Ergodic Theorem by applying it to a continuous system: an irrational rotation on a circle [@problem_id:1447084]. You are asked to determine the long-term average squared distance of a moving particle from a fixed observer. This problem beautifully illustrates how the theorem allows us to replace a difficult time-averaging calculation along an infinite orbit with a much simpler spatial integral, turning a complex dynamics problem into a straightforward calculus exercise.", "problem": "Consider a particle whose position is described by a point on the unit circle in the Cartesian plane. The state of the system is given by a parameter $x \\in [0, 1)$, where the particle's coordinates are $(\\cos(2\\pi x), \\sin(2\\pi x))$. The particle's state evolves in discrete time steps according to the transformation $T(x) = (x + \\alpha) \\pmod{1}$, where $\\alpha$ is a fixed irrational number.\n\nA stationary observer is located at the point $P$ with coordinates $(a, b)$ in the same plane. Let $d(x)$ be the Euclidean distance between the particle at state $x$ and the observer at $P$.\n\nIt can be shown that for almost every initial state $x_0 \\in [0, 1)$, the limit defining the long-term time average of any sufficiently well-behaved function along the orbit generated by $T$ exists and is independent of the specific choice of $x_0$. You may assume this property holds. The orbit is defined by the sequence of states $x_n = T^n(x_0)$ for $n=0, 1, 2, \\dots$.\n\nDetermine the value of the long-term time average of the *squared* distance between the particle and the observer, which we denote as $L$:\n$$ L = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} [d(x_n)]^2 $$\nExpress your answer as a function of the parameters $a$ and $b$.", "solution": "The particle at state $x$ has angle $\\theta=2\\pi x$ and position $(\\cos\\theta,\\sin\\theta)$. The squared distance to $P=(a,b)$ is\n$$\nd(x)^{2}=(\\cos\\theta-a)^{2}+(\\sin\\theta-b)^{2}\n=\\cos^{2}\\theta+\\sin^{2}\\theta-2a\\cos\\theta-2b\\sin\\theta+a^{2}+b^{2}.\n$$\nUsing $\\cos^{2}\\theta+\\sin^{2}\\theta=1$, this simplifies to\n$$\nd(x)^{2}=1+a^{2}+b^{2}-2a\\cos\\theta-2b\\sin\\theta.\n$$\nBy the assumed ergodic property for the irrational rotation $T(x)=(x+\\alpha)\\bmod 1$, the long-term time average equals the space average with respect to the uniform measure on $x\\in[0,1)$ (equivalently, uniform in $\\theta\\in[0,2\\pi)$). Therefore,\n$$\nL=\\int_{0}^{1} d(x)^{2}\\,dx=\\frac{1}{2\\pi}\\int_{0}^{2\\pi}\\left(1+a^{2}+b^{2}-2a\\cos\\theta-2b\\sin\\theta\\right)\\,d\\theta.\n$$\nThe integrals of $\\cos\\theta$ and $\\sin\\theta$ over a full period vanish:\n$$\n\\int_{0}^{2\\pi}\\cos\\theta\\,d\\theta=0,\\qquad \\int_{0}^{2\\pi}\\sin\\theta\\,d\\theta=0,\n$$\nso the average reduces to\n$$\nL=1+a^{2}+b^{2}.\n$$", "answer": "$$\\boxed{1+a^{2}+b^{2}}$$", "id": "1447084"}]}