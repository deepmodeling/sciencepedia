{"hands_on_practices": [{"introduction": "We begin our hands-on practice with a classic logistics scenario. This problem translates the abstract idea of a transport plan into a concrete task: redistributing resources between discrete locations. By working through this exercise [@problem_id:1456726], you will develop a foundational understanding of how to set up and solve a discrete optimal transport problem, a skill applicable to many real-world optimization challenges.", "problem": "A logistics company is tasked with redistributing a divisible resource along a one-dimensional track. The initial distribution of the resource is described by a supply measure $\\mu$, and the desired final distribution is described by a demand measure $\\nu$. The total amount of resource is normalized to one unit.\n\nThe supply is located at two points: half of the resource is at position $x=0$ and the other half is at position $x=3$. This can be represented by the discrete measure $\\mu = \\frac{1}{2}\\delta_{0} + \\frac{1}{2}\\delta_{3}$, where $\\delta_p$ denotes a unit mass located at position $p$.\n\nThe demand is also at two points: half of the resource is required at position $y=1$ and the other half is required at position $y=2$. This is represented by the demand measure $\\nu = \\frac{1}{2}\\delta_{1} + \\frac{1}{2}\\delta_{2}$.\n\nThe cost of transporting a quantity $m$ of the resource from a point $x$ to a point $y$ is given by $m \\times |x-y|$. The company wants to find a transportation plan that satisfies all the demand from the available supply while minimizing the total transportation cost.\n\nWhat is the minimum total transportation cost?", "solution": "We model the optimal transport as a discrete linear program. Let $\\gamma_{x,y}$ denote the amount of mass transported from source position $x$ to target position $y$. The sources are at $x\\in\\{0,3\\}$ with supplies $\\mu(0)=\\frac{1}{2}$ and $\\mu(3)=\\frac{1}{2}$, and targets are at $y\\in\\{1,2\\}$ with demands $\\nu(1)=\\frac{1}{2}$ and $\\nu(2)=\\frac{1}{2}$. The cost of transporting $m$ from $x$ to $y$ is $m|x-y|$.\n\nDefine the decision variables:\n$$\na=\\gamma_{0,1},\\quad b=\\gamma_{0,2},\\quad c=\\gamma_{3,1},\\quad d=\\gamma_{3,2}.\n$$\nMass conservation (supply and demand) imposes the linear constraints:\n$$\na+b=\\frac{1}{2},\\quad c+d=\\frac{1}{2},\\quad a+c=\\frac{1}{2},\\quad b+d=\\frac{1}{2},\n$$\nwith nonnegativity $a,b,c,d\\geq 0$.\n\nSolving the constraints, express all variables in terms of $a$:\n- From $a+b=\\frac{1}{2}$, obtain $b=\\frac{1}{2}-a$.\n- From $a+c=\\frac{1}{2}$, obtain $c=\\frac{1}{2}-a$.\n- From $b+d=\\frac{1}{2}$ with $b=\\frac{1}{2}-a$, obtain $d=a$.\nNonnegativity requires $0\\leq a\\leq \\frac{1}{2}$.\n\nThe total transportation cost is\n$$\nC(a)=a|0-1|+b|0-2|+c|3-1|+d|3-2|.\n$$\nUsing $|0-1|=1$, $|0-2|=2$, $|3-1|=2$, and $|3-2|=1$, and substituting $b=\\frac{1}{2}-a$, $c=\\frac{1}{2}-a$, $d=a$, we get\n$$\nC(a)=a\\cdot 1+\\left(\\frac{1}{2}-a\\right)\\cdot 2+\\left(\\frac{1}{2}-a\\right)\\cdot 2+a\\cdot 1\n= a+1-2a+1-2a+a=2-2a.\n$$\nThis is linear and decreasing in $a$ over $[0,\\frac{1}{2}]$, so the minimum occurs at the largest feasible $a=\\frac{1}{2}$, yielding\n$$\nC_{\\min}=2-2\\cdot\\frac{1}{2}=1.\n$$\nThe corresponding optimal plan sends the entire $\\frac{1}{2}$ at $x=0$ to $y=1$ and the entire $\\frac{1}{2}$ at $x=3$ to $y=2$, which also aligns with the monotone optimal transport for cost $|x-y|$ on the real line.", "answer": "$$\\boxed{1}$$", "id": "1456726"}, {"introduction": "An optimal transport plan is only \"optimal\" with respect to a specific cost function. This exercise [@problem_id:1456712] powerfully illustrates this crucial concept by asking you to solve the same transport problem under two different cost structures. By comparing the results from the standard distance cost $c(x,y) = |x-y|$ and the binary cost, you will gain insight into how the definition of \"efficiency\" fundamentally shapes the optimal strategy.", "problem": "In the field of optimal transport, a central problem is to find the most efficient way to redistribute a mass distribution $\\mu$ into a target distribution $\\nu$. The \"efficiency\" is measured by a total cost, which depends on a chosen cost function $c(x,y)$ for moving a unit of mass from location $x$ to location $y$.\n\nConsider two discrete probability distributions on the real line, $\\mu$ and $\\nu$. The source distribution $\\mu$ is given by\n$$ \\mu = 0.4 \\delta_{-1} + 0.6 \\delta_{2} $$\nwhere $\\delta_x$ denotes a Dirac delta measure, representing a point mass at location $x$. The target distribution $\\nu$ is given by\n$$ \\nu = 0.5 \\delta_{-1} + 0.2 \\delta_{1} + 0.3 \\delta_{2} $$\nThe total cost of transporting $\\mu$ to $\\nu$ according to a transport plan $\\pi$ is given by the sum of costs for moving infinitesimal masses. For discrete measures, this is $C(\\pi) = \\sum_{i,j} c(x_i, y_j) \\pi_{ij}$, where $\\pi_{ij}$ is the amount of mass moved from a source point $x_i$ of $\\mu$ to a target point $y_j$ of $\\nu$. The optimal transport cost is the minimal possible cost over all valid transport plans $\\pi$.\n\nCalculate the optimal transport cost for transforming $\\mu$ into $\\nu$ for two distinct cost functions:\n(a) The standard distance cost: $c_a(x, y) = |x - y|$.\n(b) The binary cost: $c_b(x, y) = 1$ if $x \\neq y$, and $c_b(x, y) = 0$ if $x = y$.\n\nLet the optimal cost for case (a) be $C_a$ and for case (b) be $C_b$. Provide the values for both $C_a$ and $C_b$.", "solution": "We denote the source points and masses by $x_{1}=-1$ with mass $0.4$ and $x_{2}=2$ with mass $0.6$. The target points and demands are $y_{1}=-1$ with demand $0.5$, $y_{2}=1$ with demand $0.2$, and $y_{3}=2$ with demand $0.3$. A discrete transport plan is given by nonnegative variables $\\pi_{ij}$ representing mass moved from $x_{i}$ to $y_{j}$, subject to the conservation constraints\n$$\n\\pi_{11}+\\pi_{12}+\\pi_{13}=0.4,\\quad \\pi_{21}+\\pi_{22}+\\pi_{23}=0.6,\n$$\n$$\n\\pi_{11}+\\pi_{21}=0.5,\\quad \\pi_{12}+\\pi_{22}=0.2,\\quad \\pi_{13}+\\pi_{23}=0.3,\n$$\nand $\\pi_{ij}\\ge 0$.\n\nFor cost (a), $c_{a}(x,y)=|x-y|$, the nonzero distances are\n$$\n|{-1}-(-1)|=0,\\quad |{-1}-1|=2,\\quad |{-1}-2|=3,\\quad |2-(-1)|=3,\\quad |2-1|=1,\\quad |2-2|=0.\n$$\nTo minimize cost, first allocate on zero-cost arcs as much as possible: set $\\pi_{11}=\\min(0.4,0.5)=0.4$ and $\\pi_{23}=\\min(0.6,0.3)=0.3$. Then from the constraints,\n$$\n\\pi_{21}=0.5-\\pi_{11}=0.1,\\quad \\pi_{13}=0.3-\\pi_{23}=0,\\quad \\pi_{22}=0.6-\\pi_{21}-\\pi_{23}=0.2,\\quad \\pi_{12}=0.4-\\pi_{11}-\\pi_{13}=0.\n$$\nThe total cost is\n$$\nC_{a}=\\sum_{i,j}|x_{i}-y_{j}|\\pi_{ij}=0\\cdot \\pi_{11}+2\\cdot \\pi_{12}+3\\cdot \\pi_{13}+3\\cdot \\pi_{21}+1\\cdot \\pi_{22}+0\\cdot \\pi_{23}=3\\cdot 0.1+1\\cdot 0.2=\\frac{1}{2}.\n$$\nThis plan is optimal by the monotone (increasing) coupling on the real line or, equivalently, by prioritizing zero-cost and then lower-cost arcs under the given residual demands.\n\nFor cost (b), $c_{b}(x,y)=1$ if $x\\neq y$ and $c_{b}(x,y)=0$ if $x=y$, the total cost simplifies to the total mass moved off its original locations. Writing\n$$\nC_{b}=\\sum_{i,j}c_{b}(x_{i},y_{j})\\pi_{ij}=\\sum_{i}\\left(\\sum_{j}\\pi_{ij}-\\sum_{j:y_{j}=x_{i}}\\pi_{ij}\\right)=1-\\left(\\pi_{11}+\\pi_{23}\\right),\n$$\nwe see that minimizing $C_{b}$ is equivalent to maximizing the mass kept at the same locations, $\\pi_{11}+\\pi_{23}$. The constraints imply $\\pi_{11}\\le \\min(0.4,0.5)=0.4$ and $\\pi_{23}\\le \\min(0.6,0.3)=0.3$, and these can be attained simultaneously (as above), giving $\\pi_{11}+\\pi_{23}=0.7$. Therefore\n$$\nC_{b}=1-0.7=\\frac{3}{10}.\n$$\nThus the optimal costs are $C_{a}=\\frac{1}{2}$ and $C_{b}=\\frac{3}{10}$.", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{2} & \\frac{3}{10}\\end{pmatrix}}$$", "id": "1456712"}, {"introduction": "Having explored discrete scenarios, we now transition to the continuous realm, where mass is described by density functions. In this setting, the transport plan becomes a map $T(x)$ that reshapes one distribution into another. This problem [@problem_id:1456745] introduces a powerful and elegant method for finding the optimal map in one dimension for a quadratic cost, connecting optimal transport to the cumulative distribution functions of the measures involved.", "problem": "Consider a one-dimensional material redistribution scenario. A company needs to reshape a pile of granular material distributed along the interval $[0, 1]$. The initial mass distribution is described by a linear density function $\\rho_0(x) = 2x$ for $x \\in [0, 1]$ and is zero elsewhere. The desired final configuration is a uniform mass distribution, described by the density function $\\rho_1(y) = 1$ for $y \\in [0, 1]$ and zero elsewhere.\n\nThe cost of moving a unit of mass from position $x$ to position $y$ is given by the quadratic cost function $c(x, y) = (x - y)^2$. The redistribution is achieved via a transport map $T: [0, 1] \\to [0, 1]$, where a particle at an initial position $x$ is moved to the final position $y = T(x)$. The goal is to find the specific map $T(x)$ that minimizes the total transportation cost, defined by the integral $\\int_0^1 c(x, T(x)) \\rho_0(x) \\, dx$. In one dimension with this type of cost function, this optimal map is known to be unique and monotonically increasing.\n\nDetermine the explicit functional form of this optimal transport map, $T(x)$.", "solution": "In one dimension with strictly convex quadratic cost $c(x,y)=(x-y)^{2}$ and absolutely continuous source and target densities, the unique optimal transport map is the increasing monotone rearrangement given by\n$$\nT(x)=F_{1}^{-1}\\big(F_{0}(x)\\big),\n$$\nwhere $F_{0}$ and $F_{1}$ are the cumulative distribution functions (CDFs) of $\\rho_{0}$ and $\\rho_{1}$, respectively.\n\nCompute the CDFs on $[0,1]$:\n$$\nF_{0}(x)=\\int_{0}^{x}2t\\,dt=x^{2},\\quad F_{1}(y)=\\int_{0}^{y}1\\,ds=y.\n$$\nSince $F_{1}(y)=y$ on $[0,1]$, its inverse is $F_{1}^{-1}(u)=u$ for $u\\in[0,1]$. Therefore,\n$$\nT(x)=F_{1}^{-1}\\big(F_{0}(x)\\big)=F_{1}^{-1}\\big(x^{2}\\big)=x^{2}.\n$$\n\nAs a consistency check using the mass conservation (Jacobian) equation for an increasing map $T$,\n$$\n\\rho_{0}(x)=\\rho_{1}\\big(T(x)\\big)\\,T'(x).\n$$\nWith $\\rho_{0}(x)=2x$ and $\\rho_{1}\\equiv 1$, this gives $T'(x)=2x$, whose solution is $T(x)=x^{2}+C$. The boundary condition follows from $F_{1}(T(0))=F_{0}(0)=0$, which implies $T(0)=0$ and thus $C=0$. Hence $T(x)=x^{2}$, which maps $[0,1]$ into $[0,1]$ and yields the target density.", "answer": "$$\\boxed{x^{2}}$$", "id": "1456745"}]}