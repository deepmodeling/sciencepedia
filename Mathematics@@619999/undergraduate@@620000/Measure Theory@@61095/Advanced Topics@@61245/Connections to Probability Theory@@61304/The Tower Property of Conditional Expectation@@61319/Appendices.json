{"hands_on_practices": [{"introduction": "To build a solid intuition for the Tower Property, we begin with a foundational exercise. This problem illustrates the core concept of iterated expectation in a clear and straightforward setting. By calculating an expected value in two ways—directly, and by first conditioning on partial information—you will see firsthand how averaging over conditional averages recovers the original, unconditional expectation. This practice [@problem_id:1461118] confirms that the formula $E[X] = E[E[X|\\mathcal{G}]]$ is not just an abstract statement, but a tangible principle that equates the overall average with the average of localized, intermediate averages.", "problem": "A certain manufacturing process produces a component whose quality characteristic, $U$, is a random variable uniformly distributed on the interval $[0, 1]$. A preliminary quality control check sorts the components into two bins. Bin A is for components with $U \\in [0, 1/2)$, and Bin B is for components with $U \\in [1/2, 1]$.\n\nAn engineer is interested in the expected value of the squared quality characteristic, $X = U^2$. The only information available to the engineer is which bin a component belongs to. This information is represented by the $\\sigma$-algebra $\\mathcal{G} = \\{\\emptyset, [0, 1/2), [1/2, 1], [0, 1]\\}$, which is generated by the partition of the sample space $\\Omega = [0, 1]$ into the two bins.\n\nThe engineer defines a new random variable $Y$ as the conditional expectation of $X$ given the information from the quality check, i.e., $Y = E[X | \\mathcal{G}]$.\n\nCalculate the expected value of this new random variable, $E[Y]$.", "solution": "Let $U$ be uniformly distributed on $[0,1]$, so its density is $f_{U}(u)=1$ for $u \\in [0,1]$ and $0$ otherwise. Define $X=U^{2}$ and let $\\mathcal{G}$ be the $\\sigma$-algebra generated by the partition $[0,1/2)$ and $[1/2,1]$. The random variable of interest is $Y=E[X | \\mathcal{G}]$.\n\nBy the law of iterated expectations (tower property), for any integrable random variable $X$ and sub-$\\sigma$-algebra $\\mathcal{G}$,\n$$\nE\\!\\left[E[X | \\mathcal{G}]\\right]=E[X].\n$$\nApplying this to $X=U^{2}$ gives\n$$\nE[Y]=E\\!\\left[E[U^{2} | \\mathcal{G}]\\right]=E[U^{2}].\n$$\n\nWe compute $E[U^{2}]$ directly from the definition of expectation for a continuous random variable with density $f_{U}$:\n$$\nE[U^{2}]=\\int_{0}^{1} u^{2} f_{U}(u)\\,du=\\int_{0}^{1} u^{2}\\,du=\\left.\\frac{u^{3}}{3}\\right|_{0}^{1}=\\frac{1}{3}.\n$$\n\nFor completeness, one can verify this by computing $Y$ explicitly on each bin. On $A=[0,1/2)$,\n$$\nE[U^{2} | A]=\\frac{1}{P(A)}\\int_{0}^{1/2} u^{2}\\,du=2 \\int_{0}^{1/2} u^{2}\\,du=2 \\cdot \\frac{1}{24}=\\frac{1}{12}.\n$$\nOn $B=[1/2,1]$,\n$$\nE[U^{2} | B]=\\frac{1}{P(B)}\\int_{1/2}^{1} u^{2}\\,du=2 \\int_{1/2}^{1} u^{2}\\,du=2 \\cdot \\frac{7}{24}=\\frac{7}{12}.\n$$\nThus $Y=\\frac{1}{12}$ on $A$ and $Y=\\frac{7}{12}$ on $B$, and using $P(A)=P(B)=\\frac{1}{2}$,\n$$\nE[Y]=\\frac{1}{2}\\cdot \\frac{1}{12}+\\frac{1}{2}\\cdot \\frac{7}{12}=\\frac{1}{3},\n$$\nwhich matches the result from the tower property.", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "1461118"}, {"introduction": "Now let's apply the Tower Property to a practical problem from the field of computer science. Analyzing the performance of randomized algorithms is a crucial task, and conditional expectation is one of the most powerful tools for the job. In this exercise [@problem_id:1461125], you will calculate the expected number of comparisons in the randomized quicksort algorithm. The solution hinges on conditioning on the outcome of the first random step—the choice of a pivot—and then applying the law of total expectation, which is a key instance of the Tower Property. This demonstrates how a seemingly complex expectation can be broken down into simpler, weighted cases, revealing an elegant path to the solution.", "problem": "Consider a set of three distinct numbers. We wish to sort these numbers using a randomized quicksort algorithm. The algorithm proceeds as follows:\n1.  From the current list of numbers to be sorted, a single number is chosen uniformly at random to serve as the pivot.\n2.  The pivot is compared to every other number in the list, partitioning them into two sub-lists: those smaller than the pivot and those larger than the pivot.\n3.  The algorithm is then applied recursively to any non-empty sub-lists. The recursion terminates when a list contains one or zero elements, as such a list is already sorted.\n\nLet $C$ be the total number of pairwise comparisons performed until the original list of three numbers is fully sorted. Calculate the expected value of $C$.\n\nExpress your answer as a rational number in its simplest form.", "solution": "Label the three distinct numbers in increasing order as $x_{1}x_{2}x_{3}$. At each recursive call on a sublist of size $m$, the algorithm compares the pivot with every other element in that sublist, using exactly $m-1$ comparisons, then recurses independently on the (at most two) sublists formed. The recursion stops for sublists of size at most $1$, which contribute $0$ comparisons.\n\nFor the initial list of size $3$, the first partition step always performs $2$ comparisons. The pivot is chosen uniformly at random from $\\{x_{1},x_{2},x_{3}\\}$.\n\n- If the pivot is the median $x_{2}$ (probability $\\frac{1}{3}$), the partition produces two sublists of sizes $1$ and $1$. These require no further comparisons, so the total is $2$.\n- If the pivot is an extreme, $x_{1}$ or $x_{3}$ (probability $\\frac{2}{3}$), the partition produces one empty sublist and one sublist of size $2$. Sorting a size-$2$ list uses exactly $1$ comparison (the pivot is compared to the other element), so the total is $2+1=3$.\n\nBy the law of total expectation,\n$$\n\\mathbb{E}[C]=\\frac{1}{3}\\cdot 2+\\frac{2}{3}\\cdot 3=\\frac{2}{3}+2=\\frac{8}{3}.\n$$\nTherefore, the expected total number of pairwise comparisons is $\\frac{8}{3}$.", "answer": "$$\\boxed{\\frac{8}{3}}$$", "id": "1461125"}, {"introduction": "Few problems in probability are as famous or as confounding as the Monty Hall problem. This final practice challenges you to move beyond informal arguments and use the formal structure of the Tower Property to prove the optimal strategy. By defining a sequence of \"information levels\" as nested $\\sigma$-algebras, you will dissect the problem layer by layer, from the host's action to the final outcome. This exercise [@problem_id:1461166] is a testament to the power of measure-theoretic probability; it shows how the rigorous framework of conditional expectation can transform a confusing brain-teaser into a crystal-clear application of mathematical principles, leaving no room for doubt.", "problem": "Consider a game show, which we will model on a probability space $(\\Omega, \\mathcal{F}, P)$. In this game, there are three identical doors, labeled 1, 2, and 3. Behind one door is a car, and behind the other two are goats. The placement of the car is random. A contestant participates in the following process:\n\n1.  The location of the car is determined by a random variable $C$, which is uniformly distributed on the set $\\{1, 2, 3\\}$.\n2.  The contestant makes an initial choice of a door. This choice is represented by a random variable $P_0$, which is also uniformly distributed on $\\{1, 2, 3\\}$ and is independent of $C$.\n3.  The host, who knows the location of the car ($C$) and the contestant's choice ($P_0$), opens one of the other doors to reveal a goat. The door opened by the host is a random variable $H$. The host's choice is governed by these rules:\n    - The host will never open the door chosen by the contestant ($H \\neq P_0$) and will never open the door with the car ($H \\neq C$).\n    - If the contestant's initial choice $P_0$ is the door with the car ($C=P_0$), the host will randomly choose which of the two goat-hiding doors to open, with each choice having a probability of $1/2$.\n    - If the contestant's initial choice is not the car door ($C \\neq P_0$), the host has only one door they can open (the one that is not $P_0$ and not $C$), and they open it with probability 1.\n4.  The contestant is then given the option to switch their choice to the one remaining closed door. Let $S$ denote the door the contestant would choose if they decide to switch. $S$ is the unique door in $\\{1, 2, 3\\} \\setminus \\{P_0, H\\}$.\n\nLet $X = \\mathbf{1}_{\\{C=S\\}}$ be the indicator random variable for the event that the contestant wins the car by switching. Your task is to calculate the probability of winning by switching, which is given by the expectation $E[X]$.\n\nTo do this, you must explicitly use the tower property of conditional expectation. Define two sub-$\\sigma$-algebras of $\\mathcal{F}$ as $\\mathcal{G}_1 = \\sigma(C)$ (the information of the car's location) and $\\mathcal{G}_2 = \\sigma(C, P_0)$ (the information of both the car's location and the contestant's initial pick).\n\nCalculate $E[X]$ by following these mandated steps:\na) First, compute the conditional expectation $Y = E[X|\\mathcal{G}_2]$. Your result should be an expression in terms of the random variables $C$ and $P_0$.\nb) Second, use your result for $Y$ to compute $Z = E[Y|\\mathcal{G}_1]$.\nc) Finally, compute $E[Z]$ to find the value of $E[X]$.\n\nExpress your final answer as a fraction in simplest form.", "solution": "Let $X=\\mathbf{1}_{\\{C=S\\}}$. We will compute $E[X]$ via the tower property with $\\mathcal{G}_{1}=\\sigma(C)$ and $\\mathcal{G}_{2}=\\sigma(C,P_{0})$.\n\nFirst, compute $Y=E[X|\\mathcal{G}_{2}] = E[\\mathbf{1}_{\\{C=S\\}}| C,P_{0}]$. Conditional on $(C,P_{0})$, the only remaining randomness is the host’s choice $H$, governed by the stated rules. If $C=P_{0}$, then the host picks uniformly between the two goat doors, and the switch door $S$ is the other goat door, so $S\\neq C$ and hence $X=0$ almost surely. If $C\\neq P_{0}$, then the host deterministically opens the unique goat door $H\\notin\\{C,P_{0}\\}$, and the remaining closed door is $S=C$, so $X=1$ almost surely. Therefore,\n$$\nY=E[X| C,P_{0}]\n=\\begin{cases}\n0,  C=P_{0},\\\\\n1,  C\\neq P_{0},\n\\end{cases}\n=\\mathbf{1}_{\\{C\\neq P_{0}\\}}.\n$$\n\nSecond, compute $Z=E[Y|\\mathcal{G}_{1}]=E[\\mathbf{1}_{\\{C\\neq P_{0}\\}}|C]$. Using the independence of $P_{0}$ and $C$ and the uniformity of $P_{0}$ on $\\{1,2,3\\}$, we have\n$$\nZ=E[\\mathbf{1}_{\\{C\\neq P_{0}\\}}|C]\n=1-P(P_{0}=C|C)\n=1-P(P_{0}=C)\n=1-\\frac{1}{3}\n=\\frac{2}{3}.\n$$\n\nFinally, by the tower property,\n$$\nE[X] = E[E[X|\\mathcal{G}_{2}]] = E[E[Y|\\mathcal{G}_{1}]] = E[Z] = \\frac{2}{3}.\n$$\nThus the probability of winning by switching is $\\frac{2}{3}$.", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "1461166"}]}