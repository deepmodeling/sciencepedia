{"hands_on_practices": [{"introduction": "The first step in applying the geometry of numbers is to translate an arithmetic problem into the language of lattices. This exercise is foundational, guiding you to construct the specific lattice whose structure encodes the conditions for a prime to be a sum of two squares. By defining a basis and computing the lattice's determinant, you will establish the essential geometric properties needed for Minkowski's theorem. [@problem_id:3081185]", "problem": "Let $p$ be an odd prime such that there exists an integer $a$ with $a^{2} \\equiv -1 \\pmod{p}$. Consider the subset $\\Lambda \\subset \\mathbb{R}^{2}$ defined by\n$$\n\\Lambda \\;=\\; \\{(x,y) \\in \\mathbb{Z}^{2} \\;:\\; x \\equiv a y \\pmod{p}\\}.\n$$\nThis lattice arises in the geometry-of-numbers approach to representing $p$ as a sum of two squares via Minkowski's convex body theorem. Starting from the fundamental definitions of a lattice in $\\mathbb{R}^{2}$ and the determinant (covolume) of a lattice as the area of a fundamental parallelogram, do the following:\n- Prove that $\\Lambda$ is a full-rank lattice in $\\mathbb{R}^{2}$.\n- Construct an explicit $\\mathbb{Z}$-basis for $\\Lambda$ in terms of $p$ and $a$.\n- Compute the determinant $\\det(\\Lambda)$ directly from your basis.\n\nYour final answer must be the exact closed-form expression for $\\det(\\Lambda)$ in terms of $p$ and $a$. No rounding is required.", "solution": "The problem asks for an analysis of a set $\\Lambda$ and a computation of its determinant.\nThe problem statement provides the following givens:\n- $p$ is an odd prime.\n- There exists an integer $a$ such that $a^{2} \\equiv -1 \\pmod{p}$.\n- The set $\\Lambda \\subset \\mathbb{R}^{2}$ is defined as $\\Lambda = \\{(x,y) \\in \\mathbb{Z}^{2} \\;:\\; x \\equiv a y \\pmod{p}\\}$.\n\nThe problem is validated as sound. It is a standard problem in the geometry of numbers, which is a branch of number theory. All terms are well-defined, the premises are mathematically correct, and the objectives are formalizable and solvable. The condition $a^{2} \\equiv -1 \\pmod{p}$ is a well-known prerequisite for expressing $p$ as a sum of two squares, which is the context for this problem.\n\nWe proceed with the three tasks required.\n\n**1. Prove that $\\Lambda$ is a full-rank lattice in $\\mathbb{R}^{2}$.**\n\nA subset of $\\mathbb{R}^{n}$ is a lattice if it is a discrete subgroup of the additive group $(\\mathbb{R}^{n}, +)$. First, we demonstrate that $\\Lambda$ is a subgroup of $(\\mathbb{Z}^{2}, +)$. Since $(\\mathbb{Z}^{2}, +)$ is a discrete subgroup of $(\\mathbb{R}^{2}, +)$, any of its subgroups, including $\\Lambda$, will also be discrete.\n\nTo show $\\Lambda$ is a subgroup, we use the subgroup criterion.\n- The set $\\Lambda$ is non-empty because $(0,0) \\in \\mathbb{Z}^{2}$ and $0 \\equiv a \\cdot 0 \\pmod{p}$, so $(0,0) \\in \\Lambda$.\n- Let $v_1 = (x_1, y_1)$ and $v_2 = (x_2, y_2)$ be two arbitrary elements of $\\Lambda$. By definition, $x_1, y_1, x_2, y_2$ are all integers. The conditions for their membership in $\\Lambda$ are:\n  $x_1 \\equiv a y_1 \\pmod{p}$\n  $x_2 \\equiv a y_2 \\pmod{p}$\n- Consider the difference $v_1 - v_2 = (x_1 - x_2, y_1 - y_2)$. Since $x_1, x_2, y_1, y_2$ are integers, the components of the difference are also integers, so $v_1 - v_2 \\in \\mathbb{Z}^{2}$.\n- Now we check the congruence condition for $v_1 - v_2$:\n  $$x_1 - x_2 \\equiv a y_1 - a y_2 \\pmod{p}$$\n  $$x_1 - x_2 \\equiv a(y_1 - y_2) \\pmod{p}$$\n- This shows that $v_1 - v_2 \\in \\Lambda$. By the subgroup criterion, $\\Lambda$ is a subgroup of $(\\mathbb{Z}^{2}, +)$. As argued before, this implies $\\Lambda$ is a discrete subgroup of $\\mathbb{R}^{2}$ and is therefore a lattice.\n\nTo prove that $\\Lambda$ is a *full-rank* lattice in $\\mathbb{R}^{2}$, we must show that it contains two vectors that are linearly independent over $\\mathbb{R}$. This is equivalent to showing that the real vector space spanned by the elements of $\\Lambda$ is $\\mathbb{R}^{2}$ itself.\n\nLet's find two such vectors in $\\Lambda$.\n- Consider a vector with $y$-component $y=0$. The condition becomes $x \\equiv a \\cdot 0 \\pmod{p}$, which simplifies to $x \\equiv 0 \\pmod{p}$. This means $x$ must be a multiple of $p$. The simplest non-zero integer choice is $x=p$. Thus, the vector $v_1 = (p, 0)$ is in $\\Lambda$.\n- Consider a vector with $y$-component $y=1$. The condition becomes $x \\equiv a \\cdot 1 \\pmod p$. A simple integer choice for $x$ is $x=a$. Thus, the vector $v_2 = (a, 1)$ is in $\\Lambda$.\n\nNow we check if the vectors $v_1 = (p, 0)$ and $v_2 = (a, 1)$ are linearly independent over $\\mathbb{R}$. We can do this by forming a matrix with these vectors and checking if its determinant is non-zero.\n$$\n\\det\\begin{pmatrix} p  a \\\\ 0  1 \\end{pmatrix} = (p)(1) - (a)(0) = p\n$$\nSince $p$ is a prime number, $p \\neq 0$. Therefore, the vectors $v_1$ and $v_2$ are linearly independent over $\\mathbb{R}$. Since $\\Lambda$ contains two linearly independent vectors in $\\mathbb{R}^{2}$, it spans $\\mathbb{R}^{2}$ and is a full-rank lattice.\n\n**2. Construct an explicit $\\mathbb{Z}$-basis for $\\Lambda$.**\n\nWe propose that the two vectors found above, $v_1 = (p, 0)$ and $v_2 = (a, 1)$, form a $\\mathbb{Z}$-basis for $\\Lambda$. To prove this, we must show that any vector $v = (x, y) \\in \\Lambda$ can be written as a unique integer linear combination of $v_1$ and $v_2$.\n\nLet $v = (x,y)$ be an arbitrary element of $\\Lambda$. We want to find integers $c_1, c_2$ such that:\n$$ (x,y) = c_1 v_1 + c_2 v_2 = c_1(p, 0) + c_2(a, 1) $$\nExpanding the right side gives:\n$$ (x,y) = (c_1 p + c_2 a, c_2) $$\nEquating the components, we get a system of two equations:\n1. $y = c_2$\n2. $x = c_1 p + c_2 a$\n\nFrom the first equation, $c_2 = y$. Since $v=(x,y) \\in \\Lambda \\subset \\mathbb{Z}^{2}$, $y$ is an integer. So $c_2$ is an integer.\nSubstituting $c_2=y$ into the second equation gives:\n$$ x = c_1 p + y a $$\n$$ c_1 p = x - ya $$\nTo find $c_1$, we must check if $x-ya$ is divisible by $p$. By the definition of $\\Lambda$, since $(x,y) \\in \\Lambda$, we have $x \\equiv ya \\pmod{p}$. This means that $x-ya$ is an integer multiple of $p$. Let $x - ya = k p$ for some integer $k$.\nThen $c_1 p = kp$, which implies $c_1 = k$. Since $k$ is an integer, $c_1$ is also an integer.\nThus, for any $v=(x,y) \\in \\Lambda$, we can find unique integers $c_1 = \\frac{x-ya}{p}$ and $c_2 = y$ such that $v = c_1 v_1 + c_2 v_2$.\nThis proves that the set $\\{v_1, v_2\\} = \\{(p, 0), (a, 1)\\}$ constitutes a $\\mathbb{Z}$-basis for the lattice $\\Lambda$.\n\n**3. Compute the determinant $\\det(\\Lambda)$ directly from your basis.**\n\nThe determinant of a lattice $\\Lambda$ in $\\mathbb{R}^{n}$ (also known as its covolume) is defined as the absolute value of the determinant of a matrix whose rows (or columns) are the basis vectors of the lattice.\nUsing the basis we constructed, $v_1 = (p, 0)$ and $v_2 = (a, 1)$, we form the basis matrix $B$:\n$$\nB = \\begin{pmatrix} p  0 \\\\ a  1 \\end{pmatrix}\n$$\nThe determinant of this matrix is:\n$$ \\det(B) = (p)(1) - (0)(a) = p $$\nThe determinant of the lattice $\\Lambda$ is the absolute value of $\\det(B)$:\n$$ \\det(\\Lambda) = |\\det(B)| = |p| $$\nSince $p$ is a prime number, it is positive. Therefore, $|p| = p$.\nThe determinant of the lattice $\\Lambda$ is $p$.", "answer": "$$\\boxed{p}$$", "id": "3081185"}, {"introduction": "Abstract proofs become clear when seen through a concrete example. This practice walks you through the entire process for the prime $p=29$, from finding a modular square root of $-1$ to applying Minkowski's theorem with a specific convex body. This hands-on calculation makes the theoretical steps tangible and demonstrates how the existence of a short vector in the lattice directly yields the desired sum of two squares. [@problem_id:3081193]", "problem": "Let $p=29$. Using the principle of Minkowski's convex body theorem in the plane $\\mathbb{R}^{2}$ and the basic fact that when $p \\equiv 1 \\pmod{4}$ the residue class $-1$ has a square root modulo $p$, carry out the following program.\n\n- Construct a full-rank lattice $\\Lambda \\subset \\mathbb{R}^{2}$ of determinant $p$ that encodes the congruence constraint $x^{2}+y^{2} \\equiv 0 \\pmod{p}$ for integer vectors $(x,y) \\in \\Lambda$.\n- Select a centrally symmetric convex square $B \\subset \\mathbb{R}^{2}$ whose area strictly exceeds the threshold required by Minkowskiâ€™s convex body theorem for $\\Lambda$, and explain why Minkowski guarantees a nonzero lattice point $(x,y) \\in \\Lambda \\cap B$.\n- Show that your choices force $0  x^{2}+y^{2}  2p$ for the nonzero point $(x,y)$ found above, and deduce from this that $x^{2}+y^{2}=p$.\n- Compute an explicit integer pair $(x,y)$ produced by this method with minimal nonnegative coordinates that satisfies $x^{2}+y^{2}=29$.\n\nGive your final $(x,y)$ as a single row using the $\\pmatrix{\\cdot  \\cdot}$ notation. No rounding is required, and no units are involved.", "solution": "The problem asks for the application of Minkowski's convex body theorem to find an integer solution to $x^2+y^2=p$ for the prime $p=29$. The procedure is broken down into four steps, which we will follow methodically.\n\nFirst, we validate the premise that the congruence $u^2 \\equiv -1 \\pmod{p}$ has a solution. We are given $p=29$. This prime satisfies $29 \\equiv 1 \\pmod{4}$. By Fermat's theorem on sums of two squares (or more elementarily, by properties of quadratic residues), the congruence $u^2 \\equiv -1 \\pmod{p}$ is guaranteed to have a solution in integers. For $p=29$, we need to find an integer $u$ such that $u^2 \\equiv -1 \\pmod{29}$, or $u^2 \\equiv 28 \\pmod{29}$. By testing small integer values, we find $12^2 = 144$. Dividing $144$ by $29$ gives $144 = 4 \\times 29 + 28$. Thus, $12^2 \\equiv 28 \\pmod{29}$, and we can choose $u=12$.\n\n**Step 1: Construct the Lattice $\\Lambda$**\n\nWe need to construct a full-rank lattice $\\Lambda \\subset \\mathbb{R}^2$ with determinant $p=29$, such that any integer vector $(x,y) \\in \\Lambda$ satisfies $x^2+y^2 \\equiv 0 \\pmod{29}$.\nThe congruence $x^2+y^2 \\equiv 0 \\pmod{p}$ can be rewritten using our value of $u$:\n$x^2 - u^2y^2 \\equiv 0 \\pmod{p} \\implies (x-uy)(x+uy) \\equiv 0 \\pmod{p}$.\nThis congruence holds if $x \\equiv uy \\pmod{p}$ or $x \\equiv -uy \\pmod{p}$. We can choose one of these conditions to define our lattice. Let's choose $x \\equiv uy \\pmod{p}$. With $u=12$ and $p=29$, the condition is $x \\equiv 12y \\pmod{29}$.\n\nA lattice is the set of all integer linear combinations of a set of basis vectors. We seek a basis $\\{\\mathbf{v}_1, \\mathbf{v}_2\\}$ for the set of integer vectors $(x,y) \\in \\mathbb{Z}^2$ satisfying $x \\equiv 12y \\pmod{29}$.\nA point in the lattice is of the form $\\mathbf{v} = (x,y) = a\\mathbf{v}_1 + b\\mathbf{v}_2$ for integers $a, b$.\nLet's construct a basis. The condition $x - 12y = 29k$ for some integer $k$ defines the set of points.\nOne obvious vector satisfying this is $(29,0)$, since $29 - 12(0) = 29(1)$. So we can take $\\mathbf{v}_1 = (29, 0)$.\nAnother simple vector is found by setting $y=1$ and finding the smallest non-negative $x$ that satisfies $x \\equiv 12 \\pmod{29}$. This is $x=12$. So, the vector $(12,1)$ satisfies the congruence. Let's choose $\\mathbf{v}_2 = (12,1)$.\n\nThe lattice $\\Lambda$ is the set of all integer linear combinations of these vectors:\n$$ \\Lambda = \\{ a(29, 0) + b(12, 1) \\mid a, b \\in \\mathbb{Z} \\} $$\nAny vector $(x,y) \\in \\Lambda$ can be written as $(x,y) = (29a+12b, b)$. For such a vector, let's verify the congruence:\n$x - 12y = (29a+12b) - 12(b) = 29a$.\nSince $29a \\equiv 0 \\pmod{29}$, we have $x \\equiv 12y \\pmod{29}$, which implies $x^2 \\equiv 144y^2 \\equiv -y^2 \\pmod{29}$, and thus $x^2+y^2 \\equiv 0 \\pmod{29}$. The lattice correctly encodes the constraint.\n\nThe determinant of the lattice, $\\det(\\Lambda)$, is the absolute value of the determinant of the matrix formed by the basis vectors:\n$$ \\det(\\Lambda) = \\left| \\det \\begin{pmatrix} 29  0 \\\\ 12  1 \\end{pmatrix} \\right| = |29 \\cdot 1 - 0 \\cdot 12| = 29 $$\nSo $\\det(\\Lambda)=p=29$, as required.\n\n**Step 2: Select a Convex Body and Apply Minkowski's Theorem**\n\nWe must select a centrally symmetric convex square $B \\subset \\mathbb{R}^2$ whose area is strictly greater than $4 \\det(\\Lambda)$. Minkowski's second theorem states that for a centrally symmetric convex body $B$ in $\\mathbb{R}^2$, if $\\text{Area}(B) > 4 \\det(\\Lambda)$, then $B$ must contain at least one non-zero point of $\\Lambda$.\n\nLet $B$ be an open square centered at the origin, defined by $B = \\{ (x,y) \\in \\mathbb{R}^2 \\mid |x|  s, |y|  s \\}$ for some real number $s$. This set is convex and centrally symmetric.\nIts area is $\\text{Area}(B) = (2s)^2 = 4s^2$.\nThe condition from Minkowski's theorem is $4s^2 > 4 \\det(\\Lambda) = 4p = 4(29) = 116$.\nThis simplifies to $s^2 > 29$.\nTo satisfy the next step of the problem, we need to choose $s$ judiciously. Let's make a specific choice. We need $s > \\sqrt{29} \\approx 5.385$. Let's choose $s=5.5$, which gives $s^2 = 30.25$.\nSince $30.25 > 29$, the condition $s^2 > p$ is satisfied. With this choice, $\\text{Area}(B) = 4(30.25) = 121 > 116$.\nMinkowski's theorem guarantees the existence of a non-zero integer vector $(x,y) \\in \\Lambda \\cap B$.\n\n**Step 3: Deduce $x^2+y^2=p$**\n\nThe non-zero vector $(x,y)$ found in Step 2 has integer coordinates and belongs to both the lattice $\\Lambda$ and the square $B$.\n- Since $(x,y) \\in B$, we have $|x|  5.5$ and $|y|  5.5$. Because $x$ and $y$ are integers, these inequalities imply $|x| \\le 5$ and $|y| \\le 5$.\n- From these integer bounds, we can bound the sum of squares: $x^2 \\le 25$ and $y^2 \\le 25$, so $x^2+y^2 \\le 25+25=50$.\n- Since $(x,y) \\in \\Lambda$, we know that $x^2+y^2$ must be a multiple of $p=29$. So, $x^2+y^2 = k \\cdot 29$ for some integer $k$.\n- Since $(x,y)$ is a non-zero vector, $(x,y) \\ne (0,0)$, which means $x^2+y^2 > 0$. Thus, $k$ must be a positive integer, $k \\ge 1$.\n\nCombining the conditions, we have $x^2+y^2 = 29k \\le 50$.\nThe only positive integer $k$ that satisfies this inequality is $k=1$.\nTherefore, we must have $x^2+y^2=29$.\n\nThis result, $x^2+y^2=29$, satisfies the condition $0  x^2+y^2  2p$ because $0  29  2(29)=58$. The choice of the square $B$ with side length parameter $s=5.5$ has forced the desired conclusion.\n\n**Step 4: Compute the Explicit Integer Pair**\n\nWe need to find an explicit non-zero vector $(x,y) \\in \\Lambda$ that lies within our square $B$. A vector in $\\Lambda$ has the form $(x,y) = (29a+12b, b)$ for integers $a, b$. The conditions are $|x| \\le 5$ and $|y| \\le 5$.\nThe condition $|y| \\le 5$ translates to $|b| \\le 5$. We search for integer pairs $(a,b)$ (not both zero) satisfying these constraints.\nLet's test values of $b$ from $1$ to $5$:\n- If $b=1$: $|29a+12| \\le 5 \\implies -17 \\le 29a \\le -7$. No integer solution for $a$.\n- If $b=2$: $|29a+24| \\le 5 \\implies -29 \\le 29a \\le -19$. This implies $a=-1$.\n  Let's check this pair $(a,b)=(-1,2)$:\n  $x = 29(-1) + 12(2) = -29+24 = -5$.\n  $y = b = 2$.\n  The vector is $(-5, 2)$. This is a non-zero vector. Its coordinates satisfy $|-5| \\le 5$ and $|2| \\le 5$. Its sum of squares is $(-5)^2+2^2 = 25+4=29$. This is one such vector.\n- If $b=3$: $|29a+36| \\le 5 \\implies -41 \\le 29a \\le -31$. No integer solution for $a$.\n- If $b=4$: $|29a+48| \\le 5 \\implies -53 \\le 29a \\le -43$. No integer solution for $a$.\n- If $b=5$: $|29a+60| \\le 5 \\implies -65 \\le 29a \\le -55$. This implies $a=-2$.\n  Let's check this pair $(a,b)=(-2,5)$:\n  $x=29(-2)+12(5) = -58+60 = 2$.\n  $y=b=5$.\n  The vector is $(2,5)$. This is a non-zero vector. Its coordinates satisfy $|2|\\le 5$ and $|5|\\le 5$. Its sum of squares is $2^2+5^2=4+25=29$.\n\nWe have found two candidate pairs (up to signs and order): $(2,5)$ and $(5,2)$. The problem asks for the pair $(x,y)$ with minimal nonnegative coordinates. The pairs with non-negative coordinates are $(2,5)$ from $(a,b)=(-2,5)$ and potentially others by changing $u$. In our construction, we found $(2,5)$. By convention, we list the smaller coordinate first.\n\nThe pair $(2,5)$ with $x=2$ and $y=5$ consists of non-negative integers, satisfies $2^2+5^2=29$, and arose from our systematic search for a point guaranteed by Minkowski's theorem.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  5\n\\end{pmatrix}\n}\n$$", "id": "3081193"}, {"introduction": "The true power of a constructive proof lies in its ability to be implemented as an algorithm. This final practice challenges you to synthesize the concepts from the previous exercises into a working computer program. You will implement methods for modular arithmetic, lattice basis construction, and lattice reduction to create a tool that automatically finds the sum-of-squares representation for any suitable prime, turning abstract theory into a practical problem-solving engine. [@problem_id:3081159]", "problem": "Let $p$ be an odd prime with $p \\equiv 1 \\pmod{4}$. The goal is to implement an algorithm that, for each such $p$, constructs a representation $p = x^2 + y^2$ using lattice methods derived from Minkowski's convex body theorem.\n\nFoundational base:\n- Minkowski's convex body theorem (from the geometry of numbers): If $\\Lambda \\subset \\mathbb{R}^n$ is a lattice with covolume $\\operatorname{covol}(\\Lambda)$ and $K \\subset \\mathbb{R}^n$ is a centrally symmetric convex body with volume $\\operatorname{vol}(K)  2^n \\operatorname{covol}(\\Lambda)$, then $K$ contains a nonzero lattice point.\n- Definitions: A lattice $\\Lambda \\subset \\mathbb{R}^2$ is a discrete subgroup generated by two linearly independent vectors. The covolume is the absolute value of the determinant of a basis matrix. The norm of $(x,y)$ is $\\sqrt{x^2 + y^2}$.\n- Quadratic residues modulo primes: For odd prime $p$, $-1$ is a quadratic residue if and only if $p \\equiv 1 \\pmod{4}$.\n\nYour program must:\n1. For each input prime $p$ with $p \\equiv 1 \\pmod{4}$, compute an integer $a$ with $a^2 \\equiv -1 \\pmod{p}$ using a general modular square root algorithm that is valid for any odd prime (e.g., a variant of the Tonelliâ€“Shanks algorithm that does not rely on special congruences of $p$ beyond primality).\n2. Construct the lattice $\\Lambda = \\{(x,y) \\in \\mathbb{Z}^2 : x \\equiv a y \\pmod{p}\\}$. Exhibit a $\\mathbb{Z}$-basis of $\\Lambda$, and perform a two-dimensional lattice reduction (Gauss reduction) to obtain a short nonzero vector $(x,y) \\in \\Lambda$.\n3. Justify by an application of Minkowski's convex body theorem that there exists a nonzero $(x,y) \\in \\Lambda$ with $x^2 + y^2  2p$. Explain why any such $(x,y)$ must satisfy $x^2 + y^2 = p$ when $p$ is prime and $a^2 \\equiv -1 \\pmod{p}$. Your implementation must search only within bounds justified by Minkowskiâ€™s theorem, i.e., it must find a nonzero $(x,y) \\in \\Lambda$ with $x^2 + y^2  2p$.\n4. Canonicalize the output pair for each $p$ by requiring $x \\ge 0$, $y \\ge 0$, and $x \\le y$.\n\nInput specification is implicit: your program has no external input and must run on a fixed test suite of primes listed below.\n\nTest suite:\n- Case $1$: $p = 5$.\n- Case $2$: $p = 13$.\n- Case $3$: $p = 29$.\n- Case $4$: $p = 37$.\n- Case $5$: $p = 97$.\n- Case $6$: $p = 101$.\n\nAnswer specification:\n- For each test case prime $p$, output a pair $[x,y]$ of nonnegative integers satisfying $x^2 + y^2 = p$ with $x \\le y$. The result for the entire test suite must be a single list of these pairs in the same order as the test suite. The final output must be a single line string formatted exactly as a Python list literal of lists, for example, $[[x_1,y_1],[x_2,y_2],\\dots]$ with no spaces added or removed other than those required by list syntax.\n- All quantities are pure integers; there are no physical units.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[[x1,y1],[x2,y2],[x3,y3]]\").", "solution": "We begin from standard principles in number theory and the geometry of numbers.\n\nStep 1: Existence of a square root of $-1$ modulo $p$ and how to compute it.\n- For an odd prime $p$, Euler's criterion states that for any $n \\not\\equiv 0 \\pmod{p}$, $n^{(p-1)/2} \\equiv \\left(\\frac{n}{p}\\right) \\pmod{p}$, where $\\left(\\frac{n}{p}\\right)$ is the Legendre symbol. In particular, $\\left(\\frac{-1}{p}\\right) = 1$ if and only if $p \\equiv 1 \\pmod{4}$, which ensures that there exists $a$ with $a^2 \\equiv -1 \\pmod{p}$.\n- To compute such an $a$ algorithmically for a general odd prime $p$, we can use the Tonelliâ€“Shanks algorithm. Given $n \\equiv -1 \\pmod{p}$, Tonelliâ€“Shanks computes $a$ with $a^2 \\equiv n \\pmod{p}$ by:\n  - Writing $p-1 = Q \\cdot 2^S$ with $Q$ odd.\n  - Finding $z$ with $\\left(\\frac{z}{p}\\right) = -1$.\n  - Setting $M = S$, $c \\equiv z^Q \\pmod{p}$, $t \\equiv n^Q \\pmod{p}$, $R \\equiv n^{(Q+1)/2} \\pmod{p}$.\n  - Iterating until $t \\equiv 1 \\pmod{p}$, correcting $R$, $t$, and $c$ using successive squarings to force convergence. This algorithm is a well-tested standard and does not rely on special-case shortcuts like the $p \\equiv 3 \\pmod{4}$ exponent trick.\n\nStep 2: Constructing the lattice $\\Lambda$ and its basis.\n- Define the lattice $\\Lambda = \\{ (x,y) \\in \\mathbb{Z}^2 : x \\equiv a y \\pmod{p} \\}$. This is a full-rank lattice in $\\mathbb{R}^2$. A convenient $\\mathbb{Z}$-basis is given by the two vectors\n  $$\n  \\mathbf{b}_1 = (a,1), \\quad \\mathbf{b}_2 = (p,0).\n  $$\n  Indeed, any integer combination $m \\mathbf{b}_1 + n \\mathbf{b}_2 = (ma + np, m)$ lies in $\\Lambda$ since $ma + np \\equiv a m \\equiv a y \\pmod{p}$. The basis matrix\n  $$\n  B = \\begin{pmatrix} a  p \\\\ 1  0 \\end{pmatrix}\n  $$\n  has determinant $-p$, so the covolume of $\\Lambda$ is $|\\det(B)| = p$.\n\nStep 3: Applying Minkowski's convex body theorem to bound the search.\n- Consider the closed Euclidean disk\n  $$\n  K = \\{ (x,y) \\in \\mathbb{R}^2 : x^2 + y^2 \\le 2p \\}.\n  $$\n  This is a centrally symmetric convex body in $\\mathbb{R}^2$ with area $\\operatorname{vol}(K) = \\pi ( \\sqrt{2p} )^2 = 2 \\pi p$. Since $2 \\pi p  4 p = 2^2 \\cdot \\operatorname{covol}(\\Lambda)$ (because $\\pi > 2$), Minkowski's convex body theorem guarantees the existence of a nonzero lattice point $(x,y) \\in \\Lambda \\cap K$. Therefore, there exists a nonzero $(x,y) \\in \\Lambda$ with\n  $$\n  x^2 + y^2 \\le 2p.\n  $$\n  A refinement using the pigeonhole principle or considering a slightly smaller radius yields strict inequality $x^2 + y^2  2p$ for some nonzero lattice vector. In particular, the minimal nonzero squared norm in $\\Lambda$ is strictly less than $2p$.\n- By the defining congruence for $\\Lambda$ and the choice of $a$, any $(x,y) \\in \\Lambda$ satisfies\n  $$\n  x \\equiv a y \\pmod{p} \\quad \\Longrightarrow \\quad x^2 + y^2 \\equiv (a^2 + 1) y^2 \\equiv 0 \\pmod{p}.\n  $$\n  Thus, for any nonzero $(x,y) \\in \\Lambda$, the integer $x^2 + y^2$ is a positive multiple of $p$. If, additionally, $x^2 + y^2  2p$, then the only possibility is\n  $$\n  x^2 + y^2 = p.\n  $$\n\nStep 4: Algorithmic extraction of a short nonzero lattice vector.\n- In two dimensions, Gauss reduction provides an efficient way to find a very short basis for a lattice. Starting from $(\\mathbf{b}_1,\\mathbf{b}_2)$, repeatedly perform:\n  - If $\\|\\mathbf{b}_2\\|  \\|\\mathbf{b}_1\\|$, swap them.\n  - Set $\\mu = \\left\\lfloor \\frac{\\langle \\mathbf{b}_1, \\mathbf{b}_2 \\rangle}{\\|\\mathbf{b}_1\\|^2} \\right\\rceil$ (nearest integer), and replace $\\mathbf{b}_2 \\leftarrow \\mathbf{b}_2 - \\mu \\mathbf{b}_1$.\n  - Terminate when $|\\langle \\mathbf{b}_1, \\mathbf{b}_2 \\rangle| \\le \\frac{1}{2} \\|\\mathbf{b}_1\\|^2$ and $\\|\\mathbf{b}_1\\| \\le \\|\\mathbf{b}_2\\|$.\n- The resulting first basis vector is a shortest nonzero vector in the lattice in two dimensions. By the Minkowski argument above, its squared norm is strictly less than $2p$, so it yields $x^2 + y^2 = p$.\n\nStep 5: Canonicalization.\n- To make the output unique, transform $(x,y)$ by sign changes and, if needed, swapping coordinates so that $x \\ge 0$, $y \\ge 0$, and $x \\le y$.\n\nAlgorithm summary integrating principles with computation:\n- Use Tonelliâ€“Shanks on $n \\equiv -1 \\pmod{p}$ to find $a$ with $a^2 \\equiv -1 \\pmod{p}$.\n- Form the lattice basis $\\mathbf{b}_1 = (a,1)$, $\\mathbf{b}_2 = (p,0)$.\n- Apply Gauss reduction to obtain a shortest nonzero vector $(x,y)$ in $\\Lambda$.\n- By the modular property and Minkowskiâ€™s bound, verify $x^2 + y^2 = p$.\n- Canonicalize $(x,y)$ to nonnegative, ordered form.\n\nCorrectness justification:\n- Existence of $a$ follows from $p \\equiv 1 \\pmod{4}$ and Euler's criterion; Tonelliâ€“Shanks computes it in polynomial time in $\\log p$.\n- The lattice $\\Lambda$ has covolume $p$; by Minkowski, there is a nonzero point with squared norm less than $2p$.\n- For such $(x,y)$, $x^2 + y^2$ is a positive multiple of $p$ less than $2p$, hence equal to $p$.\n- Gauss reduction finds the shortest vector in two dimensions, so it finds a vector achieving the strict bound.\n\nTest suite and output:\n- Apply the algorithm to $p \\in \\{5, 13, 29, 37, 97, 101\\}$.\n- Output a single line string that is a Python list of the pairs $[x,y]$ (with $x \\ge 0$, $y \\ge 0$, $x \\le y$) in the same order as the primes listed.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef legendre_symbol(a, p):\n    # Returns 1 if a is a quadratic residue mod p, -1 if non-residue, 0 if a % p == 0.\n    ls = pow(a % p, (p - 1) // 2, p)\n    if ls == 0:\n        return 0\n    return -1 if ls == p - 1 else 1\n\ndef tonelli_shanks(n, p):\n    \"\"\"\n    Solve x^2 â‰¡ n (mod p) for odd prime p using the Tonelli-Shanks algorithm.\n    Returns a solution x in [0, p-1], or None if no solution exists.\n    \"\"\"\n    assert p  2 and p % 2 == 1\n    n %= p\n    if n == 0:\n        return 0\n    if p == 2:\n        return n\n    if legendre_symbol(n, p) != 1:\n        return None\n\n    # Factor p-1 as Q*2^S with Q odd\n    Q = p - 1\n    S = 0\n    while Q % 2 == 0:\n        Q //= 2\n        S += 1\n\n    # Find a quadratic nonresidue z\n    z = 2\n    while legendre_symbol(z, p) != -1:\n        z += 1\n\n    # Initialize variables\n    M = S\n    c = pow(z, Q, p)\n    t = pow(n, Q, p)\n    R = pow(n, (Q + 1) // 2, p)\n\n    # Main loop\n    while t != 1:\n        # Find the least i (0  i  M) such that t^(2^i) â‰¡ 1 mod p\n        i = 1\n        t2i = pow(t, 2, p)\n        while t2i != 1:\n            i += 1\n            t2i = pow(t2i, 2, p)\n            if i == M:\n                # This should not happen if n is a residue\n                return None\n        # Compute b = c^{2^{M-i-1}}\n        b = c\n        for _ in range(M - i - 1):\n            b = pow(b, 2, p)\n        # Update state\n        R = (R * b) % p\n        t = (t * pow(b, 2, p)) % p\n        c = pow(b, 2, p)\n        M = i\n    return R\n\ndef gauss_reduce_2d(b1, b2):\n    \"\"\"\n    Gauss reduction for 2D lattice basis.\n    Input: b1, b2 as tuples or lists of integers.\n    Output: reduced basis (u, v) with u being (a) shortest (in 2D gauss reduction),\n            and inner product condition satisfied.\n    \"\"\"\n    # Represent as floats for inner products, but maintain integers for updates.\n    x1, y1 = b1\n    x2, y2 = b2\n\n    def norm2(u):\n        return u[0] * u[0] + u[1] * u[1]\n\n    def dot(u, v):\n        return u[0] * v[0] + u[1] * v[1]\n\n    u = [int(x1), int(y1)]\n    v = [int(x2), int(y2)]\n\n    changed = True\n    while changed:\n        changed = False\n        # Ensure ||u|| = ||v||\n        if norm2(v)  norm2(u):\n            u, v = v, u\n            changed = True\n        # Compute mu = round(u,v/||u||^2)\n        # Protect against division by zero (should not happen if lattice basis nonzero)\n        u_norm2 = norm2(u)\n        if u_norm2 == 0:\n            # Degenerate; return as-is\n            break\n        mu_num = dot(u, v)\n        # Round to nearest integer\n        mu = int(round(mu_num / u_norm2))\n        if mu != 0:\n            v = [v[0] - mu * u[0], v[1] - mu * u[1]]\n            changed = True\n    return tuple(u), tuple(v)\n\ndef find_sum_of_two_squares_via_minkowski(p):\n    \"\"\"\n    For prime p â‰¡ 1 mod 4, compute a with a^2 â‰¡ -1 (mod p),\n    construct the lattice L = {(x,y): x â‰¡ a y (mod p)}, reduce it,\n    and return a canonical (x,y) with x^2 + y^2 = p, x=0, y=0, x=y.\n    \"\"\"\n    assert p % 2 == 1 and p % 4 == 1\n    # Compute a square root of -1 mod p\n    a = tonelli_shanks(p - 1, p)\n    if a is None:\n        raise ValueError(f\"No sqrt of -1 mod {p}, but p â‰¡ 1 mod 4 expected.\")\n    # Lattice basis: (a,1), (p,0)\n    b1 = (a, 1)\n    b2 = (p, 0)\n    u, v = gauss_reduce_2d(b1, b2)\n    # The shortest vector should be u\n    x, y = u\n    # If u is zero vector (pathological), fallback to v\n    if x == 0 and y == 0:\n        x, y = v\n    # Ensure vector is in the constructed lattice (sanity)\n    assert (x - a * y) % p == 0\n    # Compute norm squared\n    n2 = x * x + y * y\n    # By construction, n2 must be a multiple of p\n    assert n2 % p == 0\n    # Minkowski bound ensures n2  2p for shortest nonzero vector\n    # In rare pathological cases, reduction may not give strictly shortest due to rounding;\n    # however, Gauss reduction in 2D yields the shortest vector.\n    # Assert the strict inequality as guaranteed by theory.\n    assert n2  2 * p, f\"Found vector too long: {n2} = {2*p}\"\n    # Therefore n2 == p\n    assert n2 == p\n    # Canonicalize: x,y = 0 and x = y\n    x_abs, y_abs = abs(x), abs(y)\n    if x_abs  y_abs:\n        x_abs, y_abs = y_abs, x_abs\n    return [x_abs, y_abs]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [5, 13, 29, 37, 97, 101]\n\n    results = []\n    for p in test_cases:\n        pair = find_sum_of_two_squares_via_minkowski(p)\n        results.append(pair)\n\n    # Final print statement in the exact required format.\n    # Python list literal with pairs as lists: e.g., [[x1,y1],[x2,y2],...]\n    print(f\"{results}\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3081159"}]}