{"hands_on_practices": [{"introduction": "The success of the Quadratic Sieve hinges on finding special numbers, known as \"smooth\" numbers, whose prime factors are all small. This first exercise provides practice with this foundational concept by asking you to determine if a number is smooth with respect to a given bound and to construct its exponent vector. This vector representation is the essential data format used in the algorithm's subsequent linear algebra stage [@problem_id:3092955].", "problem": "In the Quadratic Sieve (QS) factorization method, a central idea is to collect values of a quadratic form whose prime factorizations lie entirely within a fixed set of small primes called the factor base. An integer is called $B$-smooth if all of its prime factors are less than or equal to $B$. Starting from the fundamental definition of prime factorization and the notion of $B$-smoothness, analyze the integer $Q(x)=4200$ with respect to the factor base consisting of all primes $\\leq B$, where $B=30$. Determine whether $Q(x)$ is $B$-smooth, and construct the exponent vector of the primes in ascending order of the factor base. Use the factor base primes $\\{2,3,5,7,11,13,17,19,23,29\\}$, and place the exponents corresponding to these primes in that order. For your final answer, present a single row matrix: the first entry must be $1$ if $Q(x)$ is $B$-smooth and $0$ otherwise, followed by the ten exponents of the listed primes in order. No rounding is needed.", "solution": "The problem requires an analysis of the integer $Q(x)=4200$ within the context of the Quadratic Sieve factorization method. Specifically, we must determine if this integer is $B$-smooth for a given bound $B$ and then construct its corresponding exponent vector with respect to a defined factor base.\n\nFirst, we establish the fundamental definitions. An integer is said to be $B$-smooth if all of its prime factors are less than or equal to the bound $B$. In this problem, the integer to be analyzed is $N = 4200$, and the smoothness bound is $B = 30$.\n\nTo ascertain whether $N=4200$ is $30$-smooth, we must determine its prime factorization.\nWe can begin by factoring $4200$ into more manageable components:\n$$4200 = 42 \\times 100$$\nNext, we find the prime factorization of each component:\n$$42 = 2 \\times 21 = 2 \\times 3 \\times 7$$\n$$100 = 10^2 = (2 \\times 5)^2 = 2^2 \\times 5^2$$\nBy combining these results, we obtain the complete prime factorization of $4200$:\n$$4200 = (2 \\times 3 \\times 7) \\times (2^2 \\times 5^2) = 2^{1+2} \\times 3^1 \\times 5^2 \\times 7^1 = 2^3 \\times 3^1 \\times 5^2 \\times 7^1$$\nThe set of unique prime factors of $4200$ is $\\{2, 3, 5, 7\\}$. Now, we must check if each of these prime factors, $p$, satisfies the condition $p \\le B$, where $B=30$.\n- For the prime factor $2$, we have $2 \\le 30$.\n- For the prime factor $3$, we have $3 \\le 30$.\n- For the prime factor $5$, we have $5 \\le 30$.\n- For the prime factor $7$, we have $7 \\le 30$.\nSince every prime factor of $4200$ is less than or equal to $30$, the integer $4200$ is, by definition, $30$-smooth. As per the problem's instructions, this finding corresponds to a value of $1$ for the first entry in our final answer matrix.\n\nThe second part of the task is to construct the exponent vector of $4200$. This vector's components are the exponents of the primes in the specified factor base, which consists of all primes less than or equal to $30$. The problem provides this factor base as the ordered set $P = \\{2, 3, 5, 7, 11, 13, 17, 19, 23, 29\\}$.\n\nWe can express $4200$ as a product of the primes in this factor base raised to certain powers:\n$$4200 = 2^{e_1} \\times 3^{e_2} \\times 5^{e_3} \\times 7^{e_4} \\times 11^{e_5} \\times 13^{e_6} \\times 17^{e_7} \\times 19^{e_8} \\times 23^{e_9} \\times 29^{e_{10}}$$\nBy comparing this form with our derived prime factorization $4200 = 2^3 \\times 3^1 \\times 5^2 \\times 7^1$, we can identify the exponents for the primes present in the factorization:\n- The exponent of $2$ is $e_1 = 3$.\n- The exponent of $3$ is $e_2 = 1$.\n- The exponent of $5$ is $e_3 = 2$.\n- The exponent of $7$ is $e_4 = 1$.\n\nThe primes in the factor base that do not appear in the factorization of $4200$ (namely, $11, 13, 17, 19, 23, 29$) have an exponent of $0$:\n- The exponent of $11$ is $e_5 = 0$.\n- The exponent of $13$ is $e_6 = 0$.\n- The exponent of $17$ is $e_7 = 0$.\n- The exponent of $19$ is $e_8 = 0$.\n- The exponent of $23$ is $e_9 = 0$.\n- The exponent of $29$ is $e_{10} = 0$.\n\nArranging these exponents in the same order as the primes in the factor base, we obtain the exponent vector: $(3, 1, 2, 1, 0, 0, 0, 0, 0, 0)$.\n\nThe final answer must be a single row matrix containing the smoothness indicator ($1$ for smooth) followed by the ten exponents. Therefore, the matrix comprises $11$ elements in total.", "answer": "$$\\boxed{\\begin{pmatrix} 1  3  1  2  1  0  0  0  0  0  0 \\end{pmatrix}}$$", "id": "3092955"}, {"introduction": "To efficiently find smooth numbers, the Quadratic Sieve doesn't check divisibility by all small primes; instead, it uses a carefully chosen \"factor base.\" This practice demonstrates how to construct this crucial set by applying the theory of quadratic residues. This selection process significantly narrows down the primes we need to consider, making the sieving stage practical and efficient [@problem_id:3092957].", "problem": "You are preparing the factor base used in the Quadratic Sieve (QS) for integer factorization. Let $N=10403$ and let the smoothness bound be $B=31$. In this context, the factor base $\\mathcal{F}$ is defined as the set of odd primes $p$ with $p \\leq B$ such that either $p$ divides $N$ or $N$ is a quadratic residue modulo $p$, that is, the Legendre symbol $\\left( \\frac{N}{p} \\right)=1$. The prime $2$ is handled separately in the Quadratic Sieve and is excluded from this set by definition.\n\nDetermine the set $\\mathcal{F}$ in accordance with these principles, and then compute the exact value of the sum\n$$S \\;=\\; \\sum_{p \\in \\mathcal{F}} p.$$\nGive your final answer as an exact integer (no rounding).", "solution": "The task is to determine the factor base $\\mathcal{F}$ for the integer $N=10403$ with a smoothness bound $B=31$, and then calculate the sum $S$ of the primes in this set.\n\nAccording to the problem statement, the factor base $\\mathcal{F}$ is the set of odd primes $p$ such that $p \\leq B$ and either $p$ divides $N$ or $N$ is a quadratic residue modulo $p$. This second condition is equivalent to the Legendre symbol $\\left( \\frac{N}{p} \\right)$ being equal to $1$. The prime $p=2$ is explicitly excluded.\n\nFirst, we list all odd primes $p$ that are less than or equal to the smoothness bound $B=31$. These primes are:\n$$ \\{3, 5, 7, 11, 13, 17, 19, 23, 29, 31\\} $$\nThis is our set of candidate primes for inclusion in $\\mathcal{F}$.\n\nFor each candidate prime $p$, we must check if one of two conditions is met:\n1.  $p$ divides $N$, i.e., $N \\equiv 0 \\pmod{p}$.\n2.  $N$ is a quadratic residue modulo $p$, i.e., $\\left( \\frac{N}{p} \\right) = 1$.\n\nLet's first investigate if any of these primes divide $N = 10403$. A quick check for small prime factors reveals that $N = 101 \\times 103$. Since the smallest prime factor of $N$ is $101$, and for all candidate primes $p$ we have $p \\leq 31$, it is clear that none of the candidate primes divide $N$.\nTherefore, the condition for a prime $p$ to be in $\\mathcal{F}$ simplifies to only the second condition: $\\left( \\frac{N}{p} \\right) = 1$.\n\nWe now proceed to calculate the Legendre symbol $\\left( \\frac{N}{p} \\right) = \\left( \\frac{10403}{p} \\right)$ for each candidate prime $p$. We will use the property $\\left( \\frac{a}{p} \\right) = \\left( \\frac{a \\pmod{p}}{p} \\right)$ and the laws of quadratic reciprocity.\n\nFor $p=3$:\n$10403 \\equiv 1+0+4+0+3 \\equiv 8 \\equiv 2 \\pmod{3}$.\n$\\left( \\frac{10403}{3} \\right) = \\left( \\frac{2}{3} \\right) = -1$. Thus, $3 \\notin \\mathcal{F}$.\n\nFor $p=5$:\n$10403 \\equiv 3 \\pmod{5}$.\n$\\left( \\frac{10403}{5} \\right) = \\left( \\frac{3}{5} \\right) = \\left( \\frac{5}{3} \\right)(-1)^{\\frac{3-1}{2}\\frac{5-1}{2}} = \\left( \\frac{2}{3} \\right)(-1)^2 = -1$. Thus, $5 \\notin \\mathcal{F}$.\n\nFor $p=7$:\n$10403 = 7 \\times 1486 + 1$, so $10403 \\equiv 1 \\pmod{7}$.\n$\\left( \\frac{10403}{7} \\right) = \\left( \\frac{1}{7} \\right) = 1$. Thus, $7 \\in \\mathcal{F}$.\n\nFor $p=11$:\n$10403 = 11 \\times 945 + 8$, so $10403 \\equiv 8 \\pmod{11}$.\n$\\left( \\frac{10403}{11} \\right) = \\left( \\frac{8}{11} \\right) = \\left( \\frac{2^2 \\cdot 2}{11} \\right) = \\left( \\frac{2}{11} \\right) = -1$, because $11 \\equiv 3 \\pmod{8}$. Thus, $11 \\notin \\mathcal{F}$.\n\nFor $p=13$:\n$10403 = 13 \\times 800 + 3$, so $10403 \\equiv 3 \\pmod{13}$.\n$\\left( \\frac{10403}{13} \\right) = \\left( \\frac{3}{13} \\right) = \\left( \\frac{13}{3} \\right)(-1)^{\\frac{3-1}{2}\\frac{13-1}{2}} = \\left( \\frac{1}{3} \\right)(-1)^6 = 1$. Thus, $13 \\in \\mathcal{F}$.\n\nFor $p=17$:\n$10403 = 17 \\times 611 + 16$, so $10403 \\equiv 16 \\pmod{17}$.\n$\\left( \\frac{10403}{17} \\right) = \\left( \\frac{16}{17} \\right) = \\left( \\frac{4^2}{17} \\right) = 1$. Thus, $17 \\in \\mathcal{F}$.\n\nFor $p=19$:\n$10403 = 19 \\times 547 + 10$, so $10403 \\equiv 10 \\pmod{19}$.\n$\\left( \\frac{10403}{19} \\right) = \\left( \\frac{10}{19} \\right) = \\left( \\frac{2}{19} \\right)\\left( \\frac{5}{19} \\right)$. Since $19 \\equiv 3 \\pmod{8}$, $\\left( \\frac{2}{19} \\right)=-1$. For the second term, $\\left( \\frac{5}{19} \\right) = \\left( \\frac{19}{5} \\right) = \\left( \\frac{4}{5} \\right) = 1$. So, $\\left( \\frac{10}{19} \\right) = (-1)(1) = -1$. Thus, $19 \\notin \\mathcal{F}$.\n\nFor $p=23$:\n$10403 = 23 \\times 452 + 7$, so $10403 \\equiv 7 \\pmod{23}$.\n$\\left( \\frac{10403}{23} \\right) = \\left( \\frac{7}{23} \\right) = \\left( \\frac{23}{7} \\right)(-1)^{\\frac{7-1}{2}\\frac{23-1}{2}} = \\left( \\frac{2}{7} \\right)(-1)^{3 \\cdot 11} = (1)(-1) = -1$, because $7 \\equiv -1 \\pmod{8}$. Thus, $23 \\notin \\mathcal{F}$.\n\nFor $p=29$:\n$10403 = 29 \\times 358 + 21$, so $10403 \\equiv 21 \\pmod{29}$.\n$\\left( \\frac{10403}{29} \\right) = \\left( \\frac{21}{29} \\right) = \\left( \\frac{3}{29} \\right)\\left( \\frac{7}{29} \\right)$. For the first term, $\\left( \\frac{3}{29} \\right) = \\left( \\frac{29}{3} \\right) = \\left( \\frac{2}{3} \\right) = -1$. For the second, $\\left( \\frac{7}{29} \\right) = \\left( \\frac{29}{7} \\right) = \\left( \\frac{1}{7} \\right)=1$. So, $\\left( \\frac{21}{29} \\right) = (-1)(1) = -1$. Thus, $29 \\notin \\mathcal{F}$.\n\nFor $p=31$:\n$10403 = 31 \\times 335 + 18$, so $10403 \\equiv 18 \\pmod{31}$.\n$\\left( \\frac{10403}{31} \\right) = \\left( \\frac{18}{31} \\right) = \\left( \\frac{2 \\cdot 3^2}{31} \\right) = \\left( \\frac{2}{31} \\right) = 1$, because $31 \\equiv 7 \\pmod{8}$. Thus, $31 \\in \\mathcal{F}$.\n\nThe primes that satisfy the condition are $\\{7, 13, 17, 31\\}$.\nTherefore, the factor base is $\\mathcal{F} = \\{7, 13, 17, 31\\}$.\n\nFinally, we compute the sum $S$ of the elements in $\\mathcal{F}$:\n$$ S \\;=\\; \\sum_{p \\in \\mathcal{F}} p \\;=\\; 7 + 13 + 17 + 31 $$\n$$ S \\;=\\; 20 + 17 + 31 \\;=\\; 37 + 31 \\;=\\; 68 $$\nThe exact value of the sum is $68$.", "answer": "$$\\boxed{68}$$", "id": "3092957"}, {"introduction": "This final practice integrates all the preceding concepts into a complete, albeit small-scale, execution of the Quadratic Sieve. This comprehensive exercise guides you through the entire process for a small example, from defining the polynomial and factor base to finding smooth relations, identifying a linear dependency, and finally computing a nontrivial factor. This practice solidifies your understanding of how the different theoretical pieces work together to achieve the goal of integer factorization [@problem_id:3092961].", "problem": "Let $N$ be a composite integer. The quadratic sieve method seeks a congruence of squares $X^{2} \\equiv Y^{2} \\pmod{N}$ with $X \\not\\equiv \\pm Y \\pmod{N}$, from which a nontrivial factor of $N$ can be extracted using the greatest common divisor. A standard construction sets $a=\\lfloor \\sqrt{N} \\rfloor$ and $Q(x)=(a+x)^{2}-N$, and searches for values of $x$ such that $Q(x)$ factor completely over a small set of primes called the factor base. One then uses parity of exponents modulo $2$ to identify a multiplicative subset of these $Q(x)$ whose product is a perfect square.\n\nWork with $N=589$. Perform the following steps to obtain a congruence of squares and extract a factor of $N$.\n\n1. Compute $a=\\lfloor \\sqrt{N} \\rfloor$ and define $Q(x)=(a+x)^{2}-N$.\n2. Take a factor-base bound $B=13$. Build the factor base $\\mathcal{F}$ consisting of $-1$, the prime $2$, and all odd primes $p \\leq B$ for which $N$ is a quadratic residue modulo $p$.\n3. For each integer $x$ with $0 \\leq x \\leq 13$, compute $Q(x)$ and factor it. Keep only those $Q(x)$ that factor completely over $\\mathcal{F}$.\n4. Associate to each kept $Q(x)$ a parity vector over $\\mathbb{Z}/2\\mathbb{Z}$ indexed by the ordered list of factor-base elements, recording the exponent of each prime in the factorization of $Q(x)$ modulo $2$ (and including the sign via the exponent of $-1$). Identify a dependency, that is, a nonempty subset whose parity vectors sum to the zero vector modulo $2$.\n5. From such a subset $S$, form $X=\\prod_{x \\in S}(a+x)$ and $Y=\\sqrt{\\prod_{x \\in S}Q(x)}$, and use $\\gcd(|X-Y|,N)$ to extract a nontrivial factor of $N$.\n\nProvide as your final answer the smaller prime factor of $N$, as an integer. No rounding is needed, and there are no physical units involved. Your final answer must be a single integer.", "solution": "The goal is to use the congruence-of-squares principle: if $X^{2} \\equiv Y^{2} \\pmod{N}$ with $X \\not\\equiv \\pm Y \\pmod{N}$, then $\\gcd(|X-Y|,N)$ yields a nontrivial factor of $N$. The quadratic sieve operationalizes this by setting $a=\\lfloor \\sqrt{N} \\rfloor$ and $Q(x)=(a+x)^{2}-N$, then seeking a product of values $Q(x)$ that is a perfect square.\n\nStep $1$: Compute $a$ and $Q(x)$. For $N=589$, $\\sqrt{N}$ lies between $\\sqrt{576}=24$ and $\\sqrt{625}=25$, so $a=\\lfloor \\sqrt{589} \\rfloor=24$. Define $Q(x)=(24+x)^{2}-589$.\n\nStep $2$: Build the factor base. Take $B=13$. Include $-1$ and $2$. For odd primes $p \\leq 13$, include those for which $N$ is a quadratic residue modulo $p$. Compute the residues:\n- Modulo $3$, $589 \\equiv 1$, and $1$ is a square modulo $3$, so include $3$.\n- Modulo $5$, $589 \\equiv 4$, and $4$ is a square modulo $5$, so include $5$.\n- Modulo $7$, $589 \\equiv 1$, and $1$ is a square modulo $7$, so include $7$.\n- Modulo $11$, $589 \\equiv 6$, and $6$ is not a square modulo $11$, so exclude $11$.\n- Modulo $13$, $589 \\equiv 4$, and $4$ is a square modulo $13$, so include $13$.\nThus the factor base is $\\mathcal{F}=\\{-1,2,3,5,7,13\\}$.\n\nStep $3$: Evaluate $Q(x)$ for $0 \\leq x \\leq 13$ and factor:\n- $x=0$: $Q(0)=24^{2}-589=576-589=-13=(-1)\\cdot 13$.\n- $x=1$: $Q(1)=25^{2}-589=625-589=36=2^{2}\\cdot 3^{2}$.\n- $x=2$: $Q(2)=26^{2}-589=676-589=87=3\\cdot 29$ (not $\\mathcal{F}$-smooth).\n- $x=3$: $Q(3)=27^{2}-589=729-589=140=2^{2}\\cdot 5\\cdot 7$.\n- $x=4$: $Q(4)=28^{2}-589=784-589=195=3\\cdot 5\\cdot 13$.\n- $x=5$: $Q(5)=29^{2}-589=841-589=252=2^{2}\\cdot 3^{2}\\cdot 7$.\n- $x=6$: $Q(6)=30^{2}-589=900-589=311$ (prime, not in $\\mathcal{F}$).\n- $x=7$: $Q(7)=31^{2}-589=961-589=372=2^{2}\\cdot 3\\cdot 31$ (not $\\mathcal{F}$-smooth).\n- $x=8$: $Q(8)=32^{2}-589=1024-589=435=3\\cdot 5\\cdot 29$ (not $\\mathcal{F}$-smooth).\n- $x=9$: $Q(9)=33^{2}-589=1089-589=500=2^{2}\\cdot 5^{3}$.\n- $x=10$: $Q(10)=34^{2}-589=1156-589=567=3^{4}\\cdot 7$.\n- $x=11$: $Q(11)=35^{2}-589=1225-589=636=2^{2}\\cdot 3\\cdot 53$ (not $\\mathcal{F}$-smooth).\n- $x=12$: $Q(12)=36^{2}-589=1296-589=707=7\\cdot 101$ (not $\\mathcal{F}$-smooth).\n- $x=13$: $Q(13)=37^{2}-589=1369-589=780=2^{2}\\cdot 3\\cdot 5\\cdot 13$.\nThe $\\mathcal{F}$-smooth values are at $x \\in \\{0,1,3,4,5,9,10,13\\}$.\n\nStep $4$: Build parity vectors modulo $2$ with respect to the ordered factor base $\\{-1,2,3,5,7,13\\}$:\n- $x=0$: $Q(0)=(-1)^{1}\\cdot 13^{1}$ gives $[1,0,0,0,0,1]$.\n- $x=1$: $Q(1)=2^{2}\\cdot 3^{2}$ gives $[0,0,0,0,0,0]$.\n- $x=3$: $Q(3)=2^{2}\\cdot 5^{1}\\cdot 7^{1}$ gives $[0,0,0,1,1,0]$.\n- $x=4$: $Q(4)=3^{1}\\cdot 5^{1}\\cdot 13^{1}$ gives $[0,0,1,1,0,1]$.\n- $x=5$: $Q(5)=2^{2}\\cdot 3^{2}\\cdot 7^{1}$ gives $[0,0,0,0,1,0]$.\n- $x=9$: $Q(9)=2^{2}\\cdot 5^{3}$ gives $[0,0,0,1,0,0]$.\n- $x=10$: $Q(10)=3^{4}\\cdot 7^{1}$ gives $[0,0,0,0,1,0]$.\n- $x=13$: $Q(13)=2^{2}\\cdot 3^{1}\\cdot 5^{1}\\cdot 13^{1}$ gives $[0,0,1,1,0,1]$.\n\nA dependency is a nonempty subset whose parity vectors sum to the zero vector modulo $2$. One such dependency is obtained by taking $x=4$ and $x=13$, since $[0,0,1,1,0,1]+[0,0,1,1,0,1]=[0,0,0,0,0,0]$ modulo $2$.\n\nStep $5$: Form $X$ and $Y$ from this subset $S=\\{4,13\\}$. Compute\n- $X=\\prod_{x \\in S}(a+x)=(24+4)\\cdot(24+13)=28\\cdot 37=1036$.\n- $\\prod_{x \\in S}Q(x)=195\\cdot 780=(3\\cdot 5\\cdot 13)\\cdot(2^{2}\\cdot 3\\cdot 5\\cdot 13)=2^{2}\\cdot 3^{2}\\cdot 5^{2}\\cdot 13^{2}=Y^{2}$, so $Y=2\\cdot 3\\cdot 5\\cdot 13=390$.\nThen $X^{2} \\equiv Y^{2} \\pmod{N}$, and we compute\n$\\gcd(|X-Y|,N)=\\gcd(|1036-390|,589)=\\gcd(646,589)=\\gcd(57,589)=19$,\nand also\n$\\gcd(X+Y,N)=\\gcd(1426,589)=\\gcd(248,589)=31$,\nyielding the factorization $589=19\\cdot 31$. The smaller prime factor is $19$.", "answer": "$$\\boxed{19}$$", "id": "3092961"}]}