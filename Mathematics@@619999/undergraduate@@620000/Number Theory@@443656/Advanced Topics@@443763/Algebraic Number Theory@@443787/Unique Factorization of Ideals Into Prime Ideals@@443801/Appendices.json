{"hands_on_practices": [{"introduction": "The journey into ideal factorization begins with its most fundamental tool: the ideal norm. The norm provides a bridge from the abstract world of ideals back to the familiar realm of integers, allowing us to measure an ideal's \"size.\" This first practice demystifies the concept of the norm in the classic setting of Gaussian integers, $\\mathbb{Z}[i]$. By connecting the abstract definition to a concrete geometric picture of lattices, you will derive the famous formula for the norm of a principal ideal and verify its essential multiplicative property [@problem_id:3093808].", "problem": "Let $\\mathbb{Z}[i]$ denote the ring of Gaussian integers. For a nonzero ideal $I \\subset \\mathbb{Z}[i]$, define its norm by $N(I) \\coloneqq \\left|\\mathbb{Z}[i]/I\\right|$. For a nonzero Gaussian integer $\\alpha = a+bi$ with $a,b \\in \\mathbb{Z}$, consider the principal ideal $(\\alpha) = \\alpha \\mathbb{Z}[i]$.\n\n(a) Using only the definition of ideal norm as the index of a sublattice of $\\mathbb{Z}^{2}$ under the identification $\\mathbb{Z}[i] \\cong \\mathbb{Z}^{2}$ via the $\\mathbb{Z}$-basis $\\{1,i\\}$, derive a general formula for $N\\!\\left((a+bi)\\right)$ in terms of $a$ and $b$.\n\n(b) Then, take $\\alpha = 3+4i$ and $\\beta = 2+i$. Compute $N\\!\\left((\\alpha)\\right)$, $N\\!\\left((\\beta)\\right)$, and $N\\!\\left((\\alpha\\beta)\\right)$ explicitly, and verify the multiplicativity of principal ideal norms by evaluating \n$$R \\coloneqq \\frac{N\\!\\left((\\alpha\\beta)\\right)}{N\\!\\left((\\alpha)\\right)\\,N\\!\\left((\\beta)\\right)}.$$\nExplain why the observed multiplicativity aligns with the structure of $\\mathbb{Z}[i]$ and the general theory of unique factorization of ideals into prime ideals.\n\nReport your final answer as the closed-form expression you obtained for $N\\!\\left((a+bi)\\right)$ from part (a). No rounding is required.", "solution": "The problem is assessed to be valid as it is mathematically sound, self-contained, well-posed, and falls squarely within the established domain of algebraic number theory. All terms are standard and clearly defined.\n\n(a) We aim to derive a formula for the norm of a principal ideal $I = (\\alpha)$ in the ring of Gaussian integers $\\mathbb{Z}[i]$, where $\\alpha = a+bi$ for $a, b \\in \\mathbb{Z}$. The norm is defined as the size of the quotient ring, $N(I) \\coloneqq \\left|\\mathbb{Z}[i]/I\\right|$. We are instructed to use the identification of $\\mathbb{Z}[i]$ with the integer lattice $\\mathbb{Z}^2$.\n\nWe can view $\\mathbb{Z}[i]$ as a free $\\mathbb{Z}$-module of rank $2$, with a basis given by $\\{1, i\\}$. Under this view, any element $x+yi \\in \\mathbb{Z}[i]$ corresponds to the vector $(x, y) \\in \\mathbb{Z}^2$. The entire ring $\\mathbb{Z}[i]$ corresponds to the standard integer lattice $\\mathbb{Z}^2$.\n\nThe principal ideal $I = (\\alpha) = \\alpha \\mathbb{Z}[i]$ is the set of all elements of the form $\\alpha(x+yi)$ where $x,y \\in \\mathbb{Z}$. This ideal is a $\\mathbb{Z}$-submodule of $\\mathbb{Z}[i]$. We can find a $\\mathbb{Z}$-basis for $I$ by multiplying the basis elements of $\\mathbb{Z}[i]$ by $\\alpha$:\n$$ \\alpha \\cdot 1 = (a+bi) \\cdot 1 = a+bi $$\n$$ \\alpha \\cdot i = (a+bi) \\cdot i = ai + bi^2 = -b+ai $$\nIn the coordinate system corresponding to the basis $\\{1, i\\}$, these two basis vectors of the submodule $I$ are $(a, b)$ and $(-b, a)$. These vectors generate $I$ as a sublattice within the larger lattice $\\mathbb{Z}^2$ (which corresponds to $\\mathbb{Z}[i]$).\n\nThe norm of the ideal, $N(I) = \\left|\\mathbb{Z}[i]/I\\right|$, is the index of the sublattice $I$ in the lattice $\\mathbb{Z}[i]$. For a two-dimensional lattice, this index is given by the area of the fundamental parallelogram of the sublattice, assuming the fundamental parallelogram of the base lattice has area $1$. This area is computed as the absolute value of the determinant of the matrix whose columns (or rows) are the basis vectors of the sublattice.\n\nLet's form a matrix $M$ whose columns are the coordinate vectors of the basis of $I$:\n$$ M = \\begin{pmatrix} a  -b \\\\ b  a \\end{pmatrix} $$\nThe determinant of this matrix is:\n$$ \\det(M) = a \\cdot a - (-b) \\cdot b = a^2 + b^2 $$\nThe index of the sublattice, and thus the norm of the ideal, is the absolute value of this determinant:\n$$ N((\\alpha)) = \\left|\\det(M)\\right| = |a^2 + b^2| $$\nSince $a$ and $b$ are real integers, $a^2 \\ge 0$ and $b^2 \\ge 0$, so their sum $a^2+b^2$ is always non-negative. Therefore, the absolute value is redundant. The general formula is:\n$$ N((a+bi)) = a^2 + b^2 $$\nThis is recognized as the field norm of the element $a+bi$, i.e., $N_{\\mathbb{Q}(i)/\\mathbb{Q}}(a+bi) = (a+bi)(a-bi) = a^2+b^2$.\n\n(b) We are given $\\alpha = 3+4i$ and $\\beta = 2+i$. We will compute the specified norms using the formula derived in part (a).\n\nFor $\\alpha = 3+4i$, we have $a=3$ and $b=4$. The norm of the ideal $(\\alpha)$ is:\n$$ N((\\alpha)) = N((3+4i)) = 3^2 + 4^2 = 9 + 16 = 25 $$\n\nFor $\\beta = 2+i$, we have $a=2$ and $b=1$. The norm of the ideal $(\\beta)$ is:\n$$ N((\\beta)) = N((2+i)) = 2^2 + 1^2 = 4 + 1 = 5 $$\n\nNext, we compute the product $\\alpha\\beta$:\n$$ \\alpha\\beta = (3+4i)(2+i) = 6 + 3i + 8i + 4i^2 = (6-4) + (3+8)i = 2+11i $$\nThe norm of the ideal $(\\alpha\\beta)$ is then:\n$$ N((\\alpha\\beta)) = N((2+11i)) = 2^2 + 11^2 = 4 + 121 = 125 $$\n\nNow we compute the ratio $R$:\n$$ R = \\frac{N((\\alpha\\beta))}{N((\\alpha))\\,N((\\beta))} = \\frac{125}{25 \\cdot 5} = \\frac{125}{125} = 1 $$\nThis explicitly verifies that $N((\\alpha\\beta)) = N((\\alpha))N((\\beta))$ for the given $\\alpha$ and $\\beta$.\n\nThe observed multiplicativity, $N(IJ)=N(I)N(J)$, is a fundamental property of the ideal norm in any Dedekind domain. The ring $\\mathbb{Z}[i]$ is a Dedekind domain (in fact, it's a principal ideal domain, which is a stronger condition). For principal ideals, the product of ideals corresponds to the ideal of the product of their generators: $(\\alpha)(\\beta) = (\\alpha\\beta)$. Thus, the general property $N((\\alpha)(\\beta)) = N((\\alpha))N((\\beta))$ becomes $N((\\alpha\\beta)) = N((\\alpha))N((\\beta))$.\n\nThis property stems from the fact that the ideal norm for a principal ideal $(\\alpha)$, $N((\\alpha))$, is equal to the absolute value of the field norm of its generator, $|N_{\\mathbb{Q}(i)/\\mathbb{Q}}(\\alpha)|$. The field norm is itself multiplicative, i.e., $N_{\\mathbb{Q}(i)/\\mathbb{Q}}(\\alpha\\beta) = N_{\\mathbb{Q}(i)/\\mathbb{Q}}(\\alpha)N_{\\mathbb{Q}(i)/\\mathbb{Q}}(\\beta)$. This can be seen from its definition as the determinant of the multiplication-by-element map or more simply by:\n$$ N_{\\mathbb{Q}(i)/\\mathbb{Q}}(\\alpha\\beta) = (\\alpha\\beta)\\overline{(\\alpha\\beta)} = (\\alpha\\beta)(\\overline{\\alpha}\\overline{\\beta}) = (\\alpha\\overline{\\alpha})(\\beta\\overline{\\beta}) = N_{\\mathbb{Q}(i)/\\mathbb{Q}}(\\alpha)N_{\\mathbb{Q}(i)/\\mathbb{Q}}(\\beta) $$\nSince the field norms are non-negative in this case ($a^2+b^2 \\ge 0$), the multiplicativity of the ideal norm is a direct consequence. This property is crucial for the theory of unique factorization of ideals into prime ideals. In a Dedekind domain, any nonzero proper ideal $I$ has a unique factorization $I = \\mathfrak{p}_1^{e_1} \\dots \\mathfrak{p}_k^{e_k}$ into a product of prime ideals. The multiplicative nature of the norm implies $N(I) = N(\\mathfrak{p}_1)^{e_1} \\dots N(\\mathfrak{p}_k)^{e_k}$, which allows the computation of any ideal norm to be reduced to computing norms of prime ideals.", "answer": "$$\\boxed{a^2+b^2}$$", "id": "3093808"}, {"introduction": "With the ideal norm as our guide, we can now investigate the core phenomenon of unique ideal factorization. A fascinating question in number theory is what happens to prime numbers from $\\mathbb{Z}$ when we view them as ideals in a larger ring. This exercise explores precisely that, by asking you to factor ideals generated by rational primes like $(2)$, $(3)$, and $(5)$ within the Gaussian integers. You will see firsthand how these once-indivisible numbers can split, remain inert, or ramify into prime ideals, governed by simple congruence rules [@problem_id:3093797].", "problem": "Let $K=\\mathbb{Q}(i)$ be the Gaussian rational number field, and let $\\mathcal{O}_{K}=\\mathbb{Z}[i]$ be its ring of integers. Recall the following fundamental definitions and facts for number fields and their rings of integers. The norm of an ideal $I\\subset\\mathcal{O}_{K}$, denoted $N(I)$, is defined to be the cardinality $|\\mathcal{O}_{K}/I|$. The unique factorization of ideals into prime ideals holds in $\\mathcal{O}_{K}$, meaning every nonzero ideal can be written uniquely as a product of prime ideals up to ordering. For a rational prime $p$, its factorization in $\\mathcal{O}_{K}$ is governed by the factorization of the minimal polynomial of $i$, namely $x^{2}+1$, modulo $p$: splitting occurs if and only if $x^{2}+1$ has two distinct roots in $\\mathbb{F}_{p}$, inertia occurs if and only if $x^{2}+1$ is irreducible in $\\mathbb{F}_{p}[x]$, and ramification occurs if and only if $x^{2}+1$ has a repeated root in $\\mathbb{F}_{p}$.\n\n(a) Using the criterion above and basic properties of quadratic residues, decide the splitting type of $(p)$ in $\\mathbb{Z}[i]$ according to $p\\bmod 4$, and treat the special prime $p=2$ separately.\n\n(b) For the primes $p\\in\\{2,3,5,13\\}$, explicitly factor the ideal $(p)$ in $\\mathbb{Z}[i]$ into prime ideals. In the split cases, exhibit generators $a+bi$ with $a^{2}+b^{2}=p$ so that $(p)=(a+bi)(a-bi)$; in the inert case, show $(p)$ remains a prime ideal; in the ramified case, show $(p)$ is a square of a prime ideal.\n\n(c) Let $\\mathcal{P}$ be the set of all distinct prime ideals of $\\mathbb{Z}[i]$ that lie above the rational primes in $\\{2,3,5,13\\}$, i.e., all distinct prime ideal factors appearing in the factorizations from part (b). Compute the exact integer\n$$S=\\prod_{\\mathfrak{p}\\in\\mathcal{P}}N(\\mathfrak{p}).$$\nReport your final value of $S$ as an exact integer.", "solution": "The problem asks for an analysis of ideal factorization in the ring of Gaussian integers, $\\mathcal{O}_{K}=\\mathbb{Z}[i]$, where $K=\\mathbb{Q}(i)$. The solution is presented in three parts as requested.\n\n(a) Classification of prime factorization in $\\mathbb{Z}[i]$\n\nThe factorization of the ideal $(p)=p\\mathbb{Z}[i]$ for a rational prime $p$ is determined by the factorization of the polynomial $f(x)=x^2+1$ modulo $p$. This is a direct application of the Dedekind-Kummer theorem.\n\nCase 1: $p$ is an odd prime.\nThe ideal $(p)$ splits if $x^2+1 \\equiv 0 \\pmod{p}$ has two distinct roots. This is equivalent to asserting that $-1$ is a quadratic residue modulo $p$. The existence of such roots is determined by the Legendre symbol $(\\frac{-1}{p})$. We know from elementary number theory that $(\\frac{-1}{p}) = (-1)^{\\frac{p-1}{2}}$.\n- If $p \\equiv 1 \\pmod{4}$, then $\\frac{p-1}{2}$ is an even integer, so $(\\frac{-1}{p})=1$. Thus, $x^2 \\equiv -1 \\pmod{p}$ has two distinct solutions. In this case, the prime $p$ splits in $\\mathbb{Z}[i]$, meaning $(p) = \\mathfrak{p}\\overline{\\mathfrak{p}}$ where $\\mathfrak{p}$ and $\\overline{\\mathfrak{p}}$ are distinct prime ideals.\n- If $p \\equiv 3 \\pmod{4}$, then $\\frac{p-1}{2}$ is an odd integer, so $(\\frac{-1}{p})=-1$. Thus, $x^2 \\equiv -1 \\pmod{p}$ has no solutions. The polynomial $x^2+1$ is irreducible in $\\mathbb{F}_p[x]$. In this case, the prime $p$ is inert in $\\mathbb{Z}[i]$, meaning the ideal $(p)$ remains a prime ideal in $\\mathbb{Z}[i]$.\n\nCase 2: $p=2$.\nWe examine the polynomial $x^2+1$ modulo $2$. We have $x^2+1 \\equiv x^2-1 \\equiv (x-1)^2 \\pmod{2}$. The polynomial has a repeated root at $x=1$ in $\\mathbb{F}_2$. This corresponds to the case of ramification. The prime $2$ ramifies in $\\mathbb{Z}[i]$, meaning the ideal $(2)$ is the square of a prime ideal, $(2)=\\mathfrak{p}^2$.\n\nIn summary:\n- If $p=2$, $p$ ramifies.\n- If $p \\equiv 1 \\pmod{4}$, $p$ splits.\n- If $p \\equiv 3 \\pmod{4}$, $p$ is inert.\n\n(b) Explicit factorization for $p \\in \\{2, 3, 5, 13\\}$\n\n- For $p=2$: As determined in part (a), $2$ ramifies. We seek a prime ideal $\\mathfrak{p}$ such that $(2) = \\mathfrak{p}^2$. Let's consider the element $1+i \\in \\mathbb{Z}[i]$. The ideal it generates is $\\mathfrak{p}=(1+i)$. The square of this ideal is $(1+i)^2$, which is generated by $(1+i)^2 = 1^2 + 2i + i^2 = 1+2i-1=2i$. Since $i$ is a unit in $\\mathbb{Z}[i]$, the ideal $(2i)$ is the same as the ideal $(2)$. Thus, $(2) = (1+i)^2$. The ideal $(1+i)$ is prime because its norm, $N((1+i))$, which is the norm of its generator $1+i$, is $1^2+1^2=2$, and $2$ is a prime number. An ideal with a prime norm must be a prime ideal.\n\n- For $p=3$: Since $3 \\equiv 3 \\pmod{4}$, the prime $3$ is inert. This means the ideal $(3)$ is a prime ideal in $\\mathbb{Z}[i]$. To verify this, we can show that the quotient ring $\\mathbb{Z}[i]/(3)$ is an integral domain, and therefore a field since it's finite.\n$\\mathbb{Z}[i]/(3) \\cong \\mathbb{Z}[x]/(x^2+1, 3) \\cong (\\mathbb{Z}/3\\mathbb{Z})[x]/(x^2+1) = \\mathbb{F}_3[x]/(x^2+1)$.\nThe polynomial $x^2+1$ is irreducible over $\\mathbb{F}_3$ because it has degree $2$ and no roots in $\\mathbb{F}_3$: $0^2+1=1 \\neq 0$, $1^2+1=2 \\neq 0$, and $2^2+1=5 \\equiv 2 \\neq 0$. Therefore, $\\mathbb{F}_3[x]/(x^2+1)$ is a field. This implies that $(3)$ is a maximal ideal in $\\mathbb{Z}[i]$, and hence a prime ideal.\n\n- For $p=5$: Since $5 \\equiv 1 \\pmod{4}$, the prime $5$ splits. We need to find integers $a, b$ such that $a^2+b^2=5$. A solution is $a=1, b=2$ (or $a=2, b=1$). Let's take the generator $1+2i$. The factorization of the ideal $(5)$ is given by $(5)=(1+2i)(1-2i)$. This equality holds because the product of the generators is $(1+2i)(1-2i) = 1^2 - (2i)^2 = 1 - 4i^2 = 1+4=5$. The ideals $\\mathfrak{p}_1=(1+2i)$ and $\\mathfrak{p}_2=(1-2i)$ are prime because their norms are $N(\\mathfrak{p}_1) = 1^2+2^2=5$ and $N(\\mathfrak{p}_2) = 1^2+(-2)^2=5$, both of which are prime numbers.\n\n- For $p=13$: Since $13 \\equiv 1 \\pmod{4}$, the prime $13$ splits. We seek integers $a, b$ such that $a^2+b^2=13$. A solution is $a=2, b=3$. The factorization of the ideal $(13)$ is given by $(13)=(2+3i)(2-3i)$. The product of generators is $(2+3i)(2-3i) = 2^2 - (3i)^2 = 4 - 9i^2 = 4+9=13$. The ideals $\\mathfrak{p}_1=(2+3i)$ and $\\mathfrak{p}_2=(2-3i)$ are prime since their norms are $N(\\mathfrak{p}_1)=2^2+3^2=13$ and $N(\\mathfrak{p}_2)=2^2+(-3)^2=13$, which is a prime number.\n\n(c) Computation of the product of norms\n\nFirst, we must identify the set $\\mathcal{P}$ of all distinct prime ideals lying above the primes $\\{2,3,5,13\\}$. Based on the factorizations in part (b):\n- For $p=2$, the factorization is $(2)=(1+i)^2$. The only distinct prime ideal factor is $\\mathfrak{p}_2=(1+i)$.\n- For $p=3$, the factorization is $(3)$, which is itself a prime ideal. The prime ideal is $\\mathfrak{p}_3=(3)$.\n- For $p=5$, the factorization is $(5)=(1+2i)(1-2i)$. The prime ideal factors are $\\mathfrak{p}_{5,1}=(1+2i)$ and $\\mathfrak{p}_{5,2}=(1-2i)$. These are distinct ideals, as $1+2i \\neq u(1-2i)$ for any unit $u \\in \\{\\pm 1, \\pm i\\}$.\n- For $p=13$, the factorization is $(13)=(2+3i)(2-3i)$. The prime ideal factors are $\\mathfrak{p}_{13,1}=(2+3i)$ and $\\mathfrak{p}_{13,2}=(2-3i)$. These are also distinct ideals.\n\nSo, the set of distinct prime ideals is $\\mathcal{P} = \\{ (1+i), (3), (1+2i), (1-2i), (2+3i), (2-3i) \\}$.\n\nNext, we compute the norm of each of these prime ideals. The norm of an ideal $I \\subset \\mathbb{Z}[i]$ is defined as $N(I) = |\\mathbb{Z}[i]/I|$.\n- For a principal ideal $(\\alpha)$ where $\\alpha=a+bi$, its norm is $N((\\alpha)) = |a^2+b^2|$.\n- For an inert prime ideal $(p)$, its norm is $N((p)) = p^2$.\n\nThe norms of the ideals in $\\mathcal{P}$ are:\n- $N((1+i)) = 1^2+1^2 = 2$.\n- $N((3)) = 3^2 = 9$.\n- $N((1+2i)) = 1^2+2^2 = 5$.\n- $N((1-2i)) = 1^2+(-2)^2 = 5$.\n- $N((2+3i)) = 2^2+3^2 = 13$.\n- $N((2-3i)) = 2^2+(-3)^2 = 13$.\n\nFinally, we compute the product $S$:\n$$S = \\prod_{\\mathfrak{p}\\in\\mathcal{P}}N(\\mathfrak{p})$$\n$$S = N((1+i)) \\cdot N((3)) \\cdot N((1+2i)) \\cdot N((1-2i)) \\cdot N((2+3i)) \\cdot N((2-3i))$$\n$$S = 2 \\cdot 9 \\cdot 5 \\cdot 5 \\cdot 13 \\cdot 13$$\n$$S = 18 \\cdot (5 \\cdot 5) \\cdot (13 \\cdot 13)$$\n$$S = 18 \\cdot 25 \\cdot 169$$\nFirst, $18 \\cdot 25 = (20-2) \\cdot 25 = 500 - 50 = 450$.\nThen, $S = 450 \\cdot 169$.\n$450 \\cdot 169 = 450 \\cdot (100 + 60 + 9) = 45000 + 27000 + 4050 = 72000 + 4050 = 76050$.\nAlternatively, $450 \\cdot 169 = 45 \\cdot 1690$.\n$45 \\cdot 169 = (40+5) \\cdot 169 = 40 \\cdot 169 + 5 \\cdot 169 = 6760 + 845 = 7605$.\nSo, $S = 76050$.", "answer": "$$\n\\boxed{76050}\n$$", "id": "3093797"}, {"introduction": "Having explored the norm and the behavior of rational primes, it's time to synthesize these concepts into a powerful, general procedure. This final practice moves beyond individual examples in $\\mathbb{Z}[i]$ to the challenge of building a systematic algorithm for factoring any ideal in a general quadratic number field. By translating theoretical principles—like the role of the Kronecker symbol and congruence conditions—into a step-by-step computational method, you will solidify your understanding and appreciate how abstract theory enables concrete problem-solving [@problem_id:3093786].", "problem": "You are to implement a program that, given an imaginary or real quadratic field $K = \\mathbb{Q}(\\sqrt{D})$ with fundamental discriminant $D$ satisfying $D \\equiv 1 \\pmod{4}$, and a nonzero integral ideal of the ring of integers $\\mathcal{O}_K$ presented in two-generator form\n$$\nI = \\left(a, \\frac{b + \\sqrt{D}}{2}\\right),\n$$\nwhere $a \\in \\mathbb{Z}_{0}$ and $b \\in \\mathbb{Z}$ satisfy the integrality condition $b^2 \\equiv D \\pmod{4a}$, computes the factorization of $I$ into prime ideals using the following principle-based process derived from unique factorization of ideals in Dedekind domains.\n\nFoundational base:\n- Definitions: The ring of integers $\\mathcal{O}_K$ of the quadratic field $K = \\mathbb{Q}(\\sqrt{D})$ with $D \\equiv 1 \\pmod{4}$ is $\\mathcal{O}_K = \\mathbb{Z}\\left[\\frac{1 + \\sqrt{D}}{2}\\right]$. The norm of an ideal $I$ is $N(I) = \\lvert \\mathcal{O}_K / I \\rvert \\in \\mathbb{Z}_{0}$.\n- Fact: Under the given two-generator presentation, the ideal norm satisfies $N(I) = a$.\n- Fact: In a Dedekind domain (which $\\mathcal{O}_K$ is), every nonzero ideal factors uniquely into prime ideals.\n- Fact: For a rational prime $p$, the factorization of the principal ideal $p \\mathcal{O}_K$ is determined by the Kronecker symbol $\\left(\\frac{D}{p}\\right)$: if $\\left(\\frac{D}{p}\\right) = 1$, then $p$ splits as $p \\mathcal{O}_K = \\mathfrak{p} \\overline{\\mathfrak{p}}$ with $N(\\mathfrak{p}) = p$; if $\\left(\\frac{D}{p}\\right) = -1$, then $p$ is inert and $p \\mathcal{O}_K$ is a prime ideal with norm $p^2$; if $p \\mid D$ then $p$ is ramified and $p \\mathcal{O}_K = \\mathfrak{p}^2$ with $N(\\mathfrak{p}) = p$.\n- Fact: When $p \\nmid D$ and $\\left(\\frac{D}{p}\\right) = 1$, the two prime ideals above $p$ can be written as $\\left(p, \\frac{r + \\sqrt{D}}{2}\\right)$ and $\\left(p, \\frac{-r + \\sqrt{D}}{2}\\right)$ where $r^2 \\equiv D \\pmod{p}$. When $p \\mid D$, there is a unique prime ideal above $p$, namely $\\left(p, \\frac{\\sqrt{D}}{2}\\right)$, corresponding to the repeated root $r \\equiv 0 \\pmod{p}$ of $x^2 \\equiv D \\pmod{p}$ (in the sense of discriminants modulo $p$).\n\nTask:\n- Derive, from the above base, an algorithm to factor the given nonzero ideal $I$ into prime ideals by:\n  1. Computing $N(I) = a$.\n  2. Factoring $a$ into rational primes in $\\mathbb{Z}$.\n  3. For each rational prime $p$ dividing $a$, determining the splitting type in $\\mathcal{O}_K$ via the Kronecker symbol $\\left(\\frac{D}{p}\\right)$.\n  4. For split primes $p \\nmid D$ with $\\left(\\frac{D}{p}\\right) = 1$, identifying the unique prime ideal above $p$ that divides $I$ by solving $r^2 \\equiv D \\pmod{p}$ and selecting the root $r$ (taken in $\\{0,1,\\dots,p-1\\}$) that satisfies $r \\equiv b \\pmod{p}$. The corresponding prime ideal is $\\left(p, \\frac{r + \\sqrt{D}}{2}\\right)$ and its exponent in the factorization of $I$ is $v_p(a)$.\n  5. For ramified primes $p \\mid D$, using the unique prime ideal above $p$ with residue $r \\equiv 0 \\pmod{p}$ and exponent $v_p(a)$.\n  6. For inert primes $p$ (i.e., $\\left(\\frac{D}{p}\\right) = -1$), note the necessary compatibility condition that $v_p(a)$ must be even, since any prime ideal above $p$ has norm $p^2$. In the provided test suite, the data are chosen to avoid inert primes dividing $a$.\n\nInput specification for your implementation:\n- You are given a finite list of test cases. Each test case is a triple $(D, a, b)$ with $D \\equiv 1 \\pmod{4}$ a fundamental discriminant, $a \\in \\mathbb{Z}_{0}$, $b \\in \\mathbb{Z}$, and $b^2 \\equiv D \\pmod{4a}$.\n\nOutput specification:\n- For each test case, output a list encoding the prime ideal factorization of $I$ as a list of triples `[p, r, e]` where:\n  - $p$ is a rational prime dividing $a$,\n  - $r$ is the residue in $\\{0,1,\\dots,p-1\\}$ representing the chosen factor above $p$:\n    - if $\\left(\\frac{D}{p}\\right) = 1$, then $r$ is the unique root of $x^2 \\equiv D \\pmod{p}$ satisfying $r \\equiv b \\pmod{p}$ (the other root is $-r \\pmod{p}$ and corresponds to the conjugate prime),\n    - if $p \\mid D$ (ramified), set $r = 0$,\n  - $e = v_p(a)$ is the exponent of this prime ideal in the factorization of $I$.\n- Sort the triples within each test case by increasing $p$.\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, where each entry is the list for that test case. The output entries must be lists of lists of integers and must not include any other characters or text.\n\nTest suite:\n- Case $1$: $(D, a, b) = (5, 11, 15)$. This is a “happy path” split case with a single prime factor.\n- Case $2$: $(D, a, b) = (13, 3, 1)$. A split case in a real quadratic field with small prime.\n- Case $3$: $(D, a, b) = (-3, 13, 7)$. An imaginary quadratic field where the odd prime splits.\n- Case $4$: $(D, a, b) = (13, 13, 13)$. A ramified case where $p \\mid D$.\n- Case $5$: $(D, a, b) = (5, 319, 301)$ with $a = 11 \\cdot 29$. A composite $a$ with two split primes to test multi-prime factorization.\n\nThe final output format must be a single line of the form\n`[R_1,R_2,R_3,R_4,R_5]`\nwhere each $R_i$ is the list of triples `[p,r,e]` for test case $i$ in the order given above. No additional whitespace or text should be printed.", "solution": "The problem statement is a valid, well-posed exercise in computational algebraic number theory. It asks for the implementation of a standard algorithm to factor ideals in quadratic number fields. The theoretical basis provided is sound and internally consistent.\n\nThe problem centers on the ring of integers $\\mathcal{O}_K = \\mathbb{Z}\\left[\\frac{1 + \\sqrt{D}}{2}\\right]$ of a quadratic field $K = \\mathbb{Q}(\\sqrt{D})$, where $D$ is a fundamental discriminant satisfying $D \\equiv 1 \\pmod{4}$. We are given an integral ideal $I$ in its two-generator form $I = \\left(a, \\frac{b + \\sqrt{D}}{2}\\right)$, where $a$ is a positive integer equal to the norm of the ideal, $N(I) = a$. The integers $a$ and $b$ are constrained by the condition $b^2 \\equiv D \\pmod{4a}$, which ensures that $I$ is indeed an ideal of $\\mathcal{O}_K$.\n\nThe core of the task is to find the unique factorization of $I$ into prime ideals, $I = \\mathfrak{p}_1^{e_1} \\mathfrak{p}_2^{e_2} \\cdots \\mathfrak{p}_k^{e_k}$. The algorithm proceeds by first factoring the norm $a$ into rational primes, $a = p_1^{v_1} p_2^{v_2} \\cdots p_m^{v_m}$. Each prime ideal factor $\\mathfrak{p}_i$ of $I$ must lie above some rational prime factor $p_j$ of $a$. The exponent $e_i$ of $\\mathfrak{p}_i$ in the factorization of $I$ is determined by the exponent of $p_j$ in the factorization of $a$, specifically $e_i = v_{p_j}(a)$.\n\nThe main challenge is to identify which prime ideal above $p_j$ divides $I$. The behavior of a rational prime $p$ in $\\mathcal{O}_K$ is dictated by the Kronecker symbol $\\left(\\frac{D}{p}\\right)$:\n1.  If $\\left(\\frac{D}{p}\\right) = 1$ (split case), the ideal $p\\mathcal{O}_K$ factors into two distinct prime ideals, $p\\mathcal{O}_K = \\mathfrak{p}\\overline{\\mathfrak{p}}$, both of norm $p$. These ideals can be written as $\\left(p, \\frac{r + \\sqrt{D}}{2}\\right)$ and $\\left(p, \\frac{-r + \\sqrt{D}}{2}\\right)$, where $r$ is a solution to $x^2 \\equiv D \\pmod{p}$. The ideal $I$ is divisible by exactly one of these two. The correct one, say $\\mathfrak{p}_r = \\left(p, \\frac{r + \\sqrt{D}}{2}\\right)$, is the one for which $I \\subseteq \\mathfrak{p}_r$. This containment holds if and only if the generators of $I$ are elements of $\\mathfrak{p}_r$. The generator $a$ is in $\\mathfrak{p}_r$ because $p \\mid a$. The crucial condition comes from the second generator: $\\frac{b + \\sqrt{D}}{2} \\in \\mathfrak{p}_r$. This holds if and only if $b \\equiv r \\pmod{p}$. This congruence allows for the unique selection of the correct prime ideal factor.\n2.  If $p \\mid D$ (ramified case), $p\\mathcal{O}_K$ factors as $\\mathfrak{p}^2$, where $\\mathfrak{p} = \\left(p, \\frac{\\sqrt{D}}{2}\\right)$ is the unique prime ideal above $p$. There is no ambiguity; this must be the prime factor. This corresponds to the root $r=0$ of $x^2 \\equiv D \\pmod p$.\n3.  If $\\left(\\frac{D}{p}\\right) = -1$ (inert case), $p\\mathcal{O}_K$ is itself a prime ideal of norm $p^2$. The problem statement guarantees that the given test cases do not involve inert prime factors of $a$.\n\nThe algorithmic procedure is as follows:\n1.  For a given test case $(D, a, b)$, factor the integer $a$ into its prime powers, $a = \\prod p_i^{e_i}$.\n2.  For each prime factor $p$ with exponent $e=v_p(a)$:\n    a. Determine if $p$ is ramified or split. If $D \\pmod p = 0$, it is ramified. The corresponding prime ideal factor is represented by the triple $[p, 0, e]$.\n    b. If $D \\pmod p \\neq 0$, calculate the Legendre symbol $\\left(\\frac{D}{p}\\right)$. Since inert primes are excluded, this will be $1$. The prime $p$ is split.\n    c. Solve the congruence $x^2 \\equiv D \\pmod p$ to find the two roots, $r_1$ and $r_2 = p - r_1$. This can be done by a simple search for the small primes involved, or by standard algorithms like Tonelli-Shanks for larger primes.\n    d. Select the root $r$ that satisfies $r \\equiv b \\pmod p$.\n    e. The corresponding prime ideal factor is represented by the triple $[p, r, e]$.\n3.  Collect all such triples $[p, r, e]$ for a given ideal $I$ and sort them in increasing order of $p$.\n\nThis process is implemented for each test case to produce the final output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np # numpy is permitted but not used in this solution.\n\ndef solve():\n    \"\"\"\n    Main function to process test cases and print the results.\n    \"\"\"\n\n    def factorize_integer(n):\n        \"\"\"\n        Factorizes an integer n into its prime factors with exponents.\n        Returns a sorted list of (prime, exponent) tuples.\n        \"\"\"\n        factors = {}\n        d = 2\n        temp_n = n\n        while d * d = temp_n:\n            while temp_n % d == 0:\n                factors[d] = factors.get(d, 0) + 1\n                temp_n //= d\n            d += 1\n        if temp_n  1:\n            factors[temp_n] = factors.get(temp_n, 0) + 1\n        \n        return sorted(factors.items())\n\n    def legendre_symbol(a, p):\n        \"\"\"\n        Computes the Legendre symbol (a/p) for an odd prime p.\n        \"\"\"\n        if p = 2:\n            raise ValueError(\"p must be an odd prime\")\n        ls = pow(a, (p - 1) // 2, p)\n        if ls == p - 1:\n            return -1\n        return ls\n\n    def modular_sqrt(n, p):\n        \"\"\"\n        Finds a modular square root of n modulo p for an odd prime p.\n        Uses a simple search, sufficient for small primes.\n        \"\"\"\n        n_mod_p = n % p\n        for x in range(p):\n            if (x * x) % p == n_mod_p:\n                return x\n        return None  # Should not be reached for quadratic residues\n\n    def factor_ideal(D, a, b):\n        \"\"\"\n        Factors the ideal I = (a, (b + sqrt(D))/2) into prime ideals.\n        \"\"\"\n        prime_factors_of_a = factorize_integer(a)\n        ideal_factors = []\n\n        for p, e in prime_factors_of_a:\n            # Case 1: Ramified prime (p | D)\n            if D % p == 0:\n                r = 0\n                ideal_factors.append([p, r, e])\n                continue\n\n            # Case 2: Split or Inert prime (p does not divide D)\n            # The problem guarantees test cases will not have inert primes in 'a'.\n            ls = legendre_symbol(D, p)\n            if ls == 1:  # Split prime\n                # Find the roots of x^2 = D (mod p)\n                r1 = modular_sqrt(D, p)\n                \n                # The other root is p - r1. We need to select the one\n                # that is congruent to b mod p.\n                if b % p == r1:\n                    r = r1\n                else:\n                    # The other root is (p - r1) mod p.\n                    # It must be this one.\n                    r = p - r1\n                \n                ideal_factors.append([p, r, e])\n\n        # The problem requires sorting by p, which `factorize_integer` already provides.\n        return ideal_factors\n\n    def list_to_str_no_space(lst):\n        \"\"\"\n        Converts a list to a string representation without spaces.\n        \"\"\"\n        if not isinstance(lst, list):\n            return str(lst)\n        return '[' + ','.join(list_to_str_no_space(item) for item in lst) + ']'\n\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (5, 11, 15),\n        (13, 3, 1),\n        (-3, 13, 7),\n        (13, 13, 13),\n        (5, 319, 301)\n    ]\n\n    results = []\n    for case in test_cases:\n        D, a, b = case\n        result = factor_ideal(D, a, b)\n        results.append(result)\n\n    # Convert results to strings without spaces, then join.\n    results_str = [list_to_str_no_space(res) for res in results]\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```", "id": "3093786"}]}