{"hands_on_practices": [{"introduction": "Before diving into cryptographic operations, it's essential to understand the fundamental structure of an elliptic curve. This exercise solidifies your understanding of the curve's defining equation, $y^2 \\equiv x^3 + ax + b \\pmod{p}$, over a finite field. By determining an unknown parameter from a known point, you will practice the foundational property upon which all other operations are built: verifying that a point lies on the curve [@problem_id:1366833].", "problem": "In the field of elliptic curve cryptography, the security of a system relies on a set of publicly agreed-upon parameters. These parameters define an elliptic curve over a finite field. Consider an elliptic curve defined by the Weierstrass equation $y^2 \\equiv x^3 + ax + b \\pmod{p}$, where $p$ is a prime number and $a, b$ are integers within the finite field defined by the modulus $p$.\n\nFor a particular cryptographic setup, the chosen prime modulus is $p = 17$ and the coefficient $a$ is set to $7$. Therefore, the curve equation is $y^2 \\equiv x^3 + 7x + b \\pmod{17}$.\n\nAs part of the system's verification, it is confirmed that the point with coordinates $(x, y) = (2, 5)$ lies on this curve. Your task is to determine the value of the integer coefficient $b$. The value of $b$ must be an integer in the range $0 \\le b < 17$.", "solution": "We are given the elliptic curve over the finite field modulo the prime $p=17$ defined by $y^{2} \\equiv x^{3} + 7x + b \\pmod{17}$, and the point $(x,y)=(2,5)$ lies on the curve. Substituting $x=2$ and $y=5$ into the curve equation yields\n$$\n5^{2} \\equiv 2^{3} + 7\\cdot 2 + b \\pmod{17}.\n$$\nCompute each side modulo $17$. For the left-hand side,\n$$\n5^{2} = 25 \\equiv 25 - 17 = 8 \\pmod{17}.\n$$\nFor the right-hand side without $b$,\n$$\n2^{3} + 7\\cdot 2 = 8 + 14 = 22 \\equiv 22 - 17 = 5 \\pmod{17}.\n$$\nThus the congruence becomes\n$$\n8 \\equiv 5 + b \\pmod{17}.\n$$\nSolving for $b$ modulo $17$ gives\n$$\nb \\equiv 8 - 5 \\equiv 3 \\pmod{17}.\n$$\nThe required range is $0 \\leq b < 17$, so the unique value is $b=3$.", "answer": "$$\\boxed{3}$$", "id": "1366833"}, {"introduction": "The cornerstone of elliptic curve cryptography is scalar multiplication, where a point $P$ is added to itself $k$ times to produce a new point $Q = kP$. This operation is straightforward to compute but computationally difficult to reverse, forming the basis of ECC's security. This practice problem guides you through the mechanics of scalar multiplication by calculating $4P$, giving you hands-on experience with the point doubling and addition rules that underpin all ECC protocols [@problem_id:1366844].", "problem": "In elliptic curve cryptography, a public key is generated by performing scalar multiplication of a base point $P$ on a given elliptic curve. This operation, denoted as $kP$, involves adding the point $P$ to itself $k-1$ times, where $k$ is an integer secret key. The addition of points on an elliptic curve follows specific algebraic rules.\n\nConsider an elliptic curve defined over a finite field $\\mathbb{F}_p$ by the equation $y^2 \\equiv x^3 + ax + b \\pmod{p}$, where $p$ is a prime number.\n\nThe rule for adding two distinct points $P=(x_1, y_1)$ and $Q=(x_2, y_2)$ to get $R=P+Q=(x_3, y_3)$ is:\n$$ \\lambda = (y_2 - y_1)(x_2-x_1)^{-1} \\pmod{p} $$\n$$ x_3 = \\lambda^2 - x_1 - x_2 \\pmod{p} $$\n$$ y_3 = \\lambda(x_1 - x_3) - y_1 \\pmod{p} $$\nHere, $(x_2-x_1)^{-1}$ denotes the modular multiplicative inverse of $(x_2-x_1)$ modulo $p$.\n\nThe rule for doubling a point $P=(x_1, y_1)$ to get $R=2P=(x_3, y_3)$ is:\n$$ \\lambda = (3x_1^2 + a)(2y_1)^{-1} \\pmod{p} $$\n$$ x_3 = \\lambda^2 - 2x_1 \\pmod{p} $$\n$$ y_3 = \\lambda(x_1 - x_3) - y_1 \\pmod{p} $$\nHere, $(2y_1)^{-1}$ denotes the modular multiplicative inverse of $(2y_1)$ modulo $p$.\n\nGiven the elliptic curve $y^2 \\equiv x^3 + x + 1 \\pmod{5}$ and a base point $P = (0, 1)$ on this curve. A user chooses the secret key $k=4$.\n\nCalculate the coordinates of the resulting point $Q = 4P$. Express your answer as a row matrix $\\begin{pmatrix} x & y \\end{pmatrix}$ where $x$ and $y$ are the coordinates of the resulting point, with values in the set $\\{0, 1, 2, 3, 4\\}$.", "solution": "We work over the finite field $\\mathbb{F}_{5}$ on the curve $y^{2} \\equiv x^{3} + x + 1 \\pmod{5}$ with $a=1$. The base point is $P=(0,1)$, and we seek $Q=4P$.\n\nFirst, verify $P$ lies on the curve:\n$$\ny^{2} \\equiv 1^{2} \\equiv 1,\\quad x^{3}+x+1 \\equiv 0^{3}+0+1 \\equiv 1 \\pmod{5}.\n$$\nThus $P$ is on the curve.\n\nCompute $2P$ using the doubling rule with $x_{1}=0$, $y_{1}=1$:\n$$\n\\lambda = (3x_{1}^{2}+a)(2y_{1})^{-1} \\equiv (0+1)\\cdot(2)^{-1} \\equiv 1\\cdot 3 \\equiv 3 \\pmod{5},\n$$\nsince $2^{-1} \\equiv 3 \\pmod{5}$.\nThen\n$$\nx_{3} \\equiv \\lambda^{2} - 2x_{1} \\equiv 3^{2} - 0 \\equiv 9 \\equiv 4 \\pmod{5},\n$$\n$$\ny_{3} \\equiv \\lambda(x_{1}-x_{3}) - y_{1} \\equiv 3(0-4) - 1 \\equiv 3\\cdot 1 - 1 \\equiv 2 \\pmod{5},\n$$\nusing $0-4 \\equiv 1 \\pmod{5}$. Hence $2P=(4,2)$.\n\nCompute $3P = 2P + P$ using the addition rule with $(x_{1},y_{1})=(4,2)$ and $(x_{2},y_{2})=(0,1)$:\n$$\n\\lambda = (y_{2}-y_{1})(x_{2}-x_{1})^{-1} \\equiv (1-2)(0-4)^{-1} \\equiv (-1)(-4)^{-1} \\equiv 4\\cdot 1 \\equiv 4 \\pmod{5},\n$$\nsince $-1 \\equiv 4$ and $-4 \\equiv 1$ so $(0-4)^{-1} \\equiv 1^{-1} \\equiv 1$. Then\n$$\nx_{3} \\equiv \\lambda^{2} - x_{1} - x_{2} \\equiv 4^{2} - 4 - 0 \\equiv 16 - 4 \\equiv 12 \\equiv 2 \\pmod{5},\n$$\n$$\ny_{3} \\equiv \\lambda(x_{1}-x_{3}) - y_{1} \\equiv 4(4-2) - 2 \\equiv 4\\cdot 2 - 2 \\equiv 8 - 2 \\equiv 6 \\equiv 1 \\pmod{5}.\n$$\nThus $3P=(2,1)$.\n\nCompute $4P = 3P + P$ with $(x_{1},y_{1})=(2,1)$ and $(x_{2},y_{2})=(0,1)$:\n$$\n\\lambda = (y_{2}-y_{1})(x_{2}-x_{1})^{-1} \\equiv (1-1)(0-2)^{-1} \\equiv 0\\cdot(-2)^{-1} \\equiv 0 \\pmod{5},\n$$\nsince $(0-2) \\equiv -2 \\equiv 3$ and $3^{-1} \\equiv 2$, but $0\\cdot 2 \\equiv 0$. Then\n$$\nx_{3} \\equiv \\lambda^{2} - x_{1} - x_{2} \\equiv 0 - 2 - 0 \\equiv -2 \\equiv 3 \\pmod{5},\n$$\n$$\ny_{3} \\equiv \\lambda(x_{1}-x_{3}) - y_{1} \\equiv 0\\cdot(2-3) - 1 \\equiv -1 \\equiv 4 \\pmod{5}.\n$$\nTherefore $4P=(3,4)$.\n\nAs a check, $(3,4)$ satisfies the curve equation modulo $5$:\n$$\ny^{2} \\equiv 4^{2} \\equiv 16 \\equiv 1,\\quad x^{3}+x+1 \\equiv 27+3+1 \\equiv 31 \\equiv 1 \\pmod{5}.\n$$\nHence the result is correct.", "answer": "$$\\boxed{\\begin{pmatrix} 3 & 4 \\end{pmatrix}}$$", "id": "1366844"}, {"introduction": "Now we put theory into practice by simulating a complete cryptographic protocol. The Elliptic Curve Diffie-Hellman (ECDH) key exchange allows two parties to establish a shared secret over an insecure channel, a landmark achievement in modern cryptography. This exercise walks you through every step of the ECDH process, from generating public keys to computing the final shared secret, demonstrating how the abstract group law enables secure communication [@problem_id:3084656].", "problem": "Consider the elliptic curve over the finite field $\\mathbb{F}_{17}$ defined by\n$$E: y^2 \\equiv x^3 + 2x + 2 \\pmod{17}.$$\nThe point $G=(5,1)$ lies on $E$, and the cyclic subgroup $\\langle G \\rangle$ generated by $G$ has prime order $n=19$. Two parties, Alice and Bob, perform Elliptic Curve Diffieâ€“Hellman (ECDH) key exchange in the subgroup $\\langle G \\rangle$.\n\nAlice chooses a private scalar $d_A=3$ and publishes $A=[d_A]G$. Bob chooses a private scalar $d_B=10$ and publishes $B=[d_B]G$. They then compute their shared secret as $S_A=[d_A]B$ and $S_B=[d_B]A$ using the chord-and-tangent group law on $E(\\mathbb{F}_{17})$. All field arithmetic is performed modulo $17$.\n\nStarting from the definition of an elliptic curve group over a finite field and the explicit chord-and-tangent addition law (with slope $m$ given by\n$$m \\equiv \\begin{cases}\n\\frac{y_2 - y_1}{x_2 - x_1} \\pmod{17}, & \\text{for } P=(x_1,y_1)\\neq \\pm Q=(x_2,y_2),\\\\\n\\frac{3x_1^2 + a}{2y_1} \\pmod{17}, & \\text{for } P=Q, \n\\end{cases}$$\nand the formulas\n$$x_3 \\equiv m^2 - x_1 - x_2 \\pmod{17}, \\qquad y_3 \\equiv m(x_1 - x_3) - y_1 \\pmod{17},$$\ntogether with the usual point-at-infinity as identity), carry out the full ECDH exchange: compute $A=[d_A]G$, $B=[d_B]G$, and then $S_A=[d_A]B$ and $S_B=[d_B]A$, and verify $S_A=S_B$.\n\nReport the $x$-coordinate $x_S$ of the shared secret point $S$ as an exact integer in $\\mathbb{F}_{17}$. No rounding is required, and your final answer must be a single number.", "solution": "The problem is to perform an Elliptic Curve Diffie-Hellman (ECDH) key exchange. The parameters are:\nThe finite field is $\\mathbb{F}_{17}$.\nThe elliptic curve is $E: y^2 \\equiv x^3 + 2x + 2 \\pmod{17}$. The coefficient for the point-doubling formula is thus $a_{curve}=2$.\nThe generator point is $G=(5,1)$.\nAlice's private key is $d_A=3$.\nBob's private key is $d_B=10$.\n\nAll arithmetic operations are performed modulo $17$. The multiplicative inverse of a number $z$ in $\\mathbb{F}_{17}$ is denoted by $z^{-1}$.\n\n**1. Computation of Alice's Public Key $A=[d_A]G=[3]G$**\n\nFirst, we compute $[2]G = G+G$ by point doubling.\nLet $G=(x_1, y_1) = (5, 1)$. The slope $m$ for doubling is given by $m \\equiv \\frac{3x_1^2 + a_{curve}}{2y_1} \\pmod{17}$.\n$$m \\equiv \\frac{3(5^2) + 2}{2(1)} = \\frac{3(25)+2}{2} = \\frac{75+2}{2} = \\frac{77}{2} \\pmod{17}$$\nIn $\\mathbb{F}_{17}$, $77 \\equiv 9$ and $2^{-1} \\equiv 9$ (since $2 \\times 9 = 18 \\equiv 1$).\n$$m \\equiv 9 \\times 9 = 81 \\equiv 13 \\pmod{17}$$\nThe coordinates of $[2]G=(x_2, y_2)$ are:\n$$x_2 \\equiv m^2 - x_1 - x_1 = 13^2 - 5 - 5 = 169 - 10 = 159 \\equiv 6 \\pmod{17}$$\n$$y_2 \\equiv m(x_1 - x_2) - y_1 = 13(5 - 6) - 1 = 13(-1) - 1 = -13 - 1 = -14 \\equiv 3 \\pmod{17}$$\nSo, $[2]G = (6, 3)$.\n\nNext, we compute $A = [3]G = [2]G + G$ by point addition.\nLet $P=(x_P, y_P)=[2]G=(6,3)$ and $Q=(x_Q, y_Q)=G=(5,1)$. The slope is $m \\equiv \\frac{y_Q - y_P}{x_Q - x_P} \\pmod{17}$.\n$$m \\equiv \\frac{1 - 3}{5 - 6} = \\frac{-2}{-1} = 2 \\pmod{17}$$\nThe coordinates of $A=(x_A, y_A)$ are:\n$$x_A \\equiv m^2 - x_P - x_Q = 2^2 - 6 - 5 = 4 - 11 = -7 \\equiv 10 \\pmod{17}$$\n$$y_A \\equiv m(x_P - x_A) - y_P = 2(6 - 10) - 3 = 2(-4) - 3 = -8 - 3 = -11 \\equiv 6 \\pmod{17}$$\nAlice's public key is $A = (10, 6)$.\n\n**2. Computation of Bob's Public Key $B=[d_B]G=[10]G$**\n\nWe use the double-and-add algorithm. Since $10 = 8+2$, we compute $B = [8]G + [2]G$. We already have $[2]G=(6,3)$.\nFirst, we find $[4]G = [2]([2]G)$ by doubling $[2]G = (6,3)$.\n$$m \\equiv \\frac{3(6^2)+2}{2(3)} = \\frac{3(36)+2}{6} = \\frac{108+2}{6} = \\frac{110}{6} \\pmod{17}$$\nIn $\\mathbb{F}_{17}$, $110 \\equiv 8$ and $6^{-1} \\equiv 3$.\n$$m \\equiv 8 \\times 3 = 24 \\equiv 7 \\pmod{17}$$\n$$x_4 \\equiv 7^2 - 6 - 6 = 49 - 12 = 37 \\equiv 3 \\pmod{17}$$\n$$y_4 \\equiv 7(6 - 3) - 3 = 7(3) - 3 = 21 - 3 = 18 \\equiv 1 \\pmod{17}$$\nSo, $[4]G = (3, 1)$.\n\nNext, we find $[8]G = [2]([4]G)$ by doubling $[4]G=(3,1)$.\n$$m \\equiv \\frac{3(3^2)+2}{2(1)} = \\frac{27+2}{2} = \\frac{29}{2} \\pmod{17}$$\nIn $\\mathbb{F}_{17}$, $29 \\equiv 12$ and $2^{-1} \\equiv 9$.\n$$m \\equiv 12 \\times 9 = 108 \\equiv 6 \\pmod{17}$$\n$$x_8 \\equiv 6^2 - 3 - 3 = 36 - 6 = 30 \\equiv 13 \\pmod{17}$$\n$$y_8 \\equiv 6(3 - 13) - 1 = 6(-10) - 1 = -60 - 1 = -61 \\equiv 7 \\pmod{17}$$\nSo, $[8]G = (13, 7)$.\n\nFinally, we compute $B = [10]G = [8]G + [2]G$. Let $P=(13,7)$ and $Q=(6,3)$.\n$$m \\equiv \\frac{3-7}{6-13} = \\frac{-4}{-7} = \\frac{4}{7} \\pmod{17}$$\nIn $\\mathbb{F}_{17}$, $7^{-1} \\equiv 5$.\n$$m \\equiv 4 \\times 5 = 20 \\equiv 3 \\pmod{17}$$\nThe coordinates of $B=(x_B, y_B)$ are:\n$$x_B \\equiv 3^2 - 13 - 6 = 9 - 19 = -10 \\equiv 7 \\pmod{17}$$\n$$y_B \\equiv 3(13 - 7) - 7 = 3(6) - 7 = 18 - 7 = 11 \\pmod{17}$$\nBob's public key is $B = (7, 11)$.\n\n**3. Computation of the Shared Secret $S_A = [d_A]B = [3]B$**\n\nAlice computes the shared secret $S_A = [3]B = [2]B + B$. Let $B=(7,11)$.\nFirst, we double $B$ to get $[2]B$.\n$$m \\equiv \\frac{3(7^2)+2}{2(11)} = \\frac{3(49)+2}{22} = \\frac{147+2}{22} = \\frac{149}{22} \\pmod{17}$$\nIn $\\mathbb{F}_{17}$, $149 \\equiv 13$ and $22 \\equiv 5$. We have $5^{-1} \\equiv 7$.\n$$m \\equiv 13 \\times 7 = 91 \\equiv 6 \\pmod{17}$$\n$$x_{2B} \\equiv 6^2 - 7 - 7 = 36 - 14 = 22 \\equiv 5 \\pmod{17}$$\n$$y_{2B} \\equiv 6(7 - 5) - 11 = 6(2) - 11 = 12 - 11 = 1 \\pmod{17}$$\nSo, $[2]B = (5, 1)$, which is the generator $G$.\n\nNow Alice computes $S_A = [2]B + B = G+B$. Let $P=G=(5,1)$ and $Q=B=(7,11)$.\n$$m \\equiv \\frac{11-1}{7-5} = \\frac{10}{2} = 5 \\pmod{17}$$\nThe coordinates of the shared secret $S_A = (x_S, y_S)$ are:\n$$x_S \\equiv 5^2 - 5 - 7 = 25 - 12 = 13 \\pmod{17}$$\n$$y_S \\equiv 5(5 - 13) - 1 = 5(-8) - 1 = -40 - 1 = -41 \\equiv 10 \\pmod{17}$$\nThe shared secret computed by Alice is $S_A = (13, 10)$.\n\n**4. Computation and Verification of the Shared Secret $S_B = [d_B]A = [10]A$**\n\nBob computes the shared secret $S_B = [10]A = [8]A + [2]A$. We have $A=(10,6)$.\nWe first compute $[2]A$, $[4]A$, and $[8]A$.\n$[2]A$: Doubling $A=(10,6)$.\n$$m \\equiv \\frac{3(10^2)+2}{2(6)} = \\frac{302}{12} \\pmod{17}$$\n$302 \\equiv 13$ and $12^{-1} \\equiv 10$. So $m \\equiv 13 \\times 10 = 130 \\equiv 11$.\n$x_{2A} \\equiv 11^2 - 10 - 10 = 121 - 20 = 101 \\equiv 16$.\n$y_{2A} \\equiv 11(10-16)-6 = -66-6 = -72 \\equiv 13$. So $[2]A=(16,13)$.\n\n$[4]A$: Doubling $[2]A=(16,13)$.\n$$m \\equiv \\frac{3(16^2)+2}{2(13)} = \\frac{3(256)+2}{26} \\equiv \\frac{3(1)+2}{9} = \\frac{5}{9} \\pmod{17}$$\n$9^{-1} \\equiv 2$. So $m \\equiv 5 \\times 2 = 10$.\n$x_{4A} \\equiv 10^2 - 16 - 16 = 100 - 32 = 68 \\equiv 0$.\n$y_{4A} \\equiv 10(16-0)-13 = 160-13 = 147 \\equiv 11$. So $[4]A=(0,11)$.\n\n$[8]A$: Doubling $[4]A=(0,11)$.\n$$m \\equiv \\frac{3(0^2)+2}{2(11)} = \\frac{2}{22} \\equiv \\frac{2}{5} \\pmod{17}$$\n$5^{-1} \\equiv 7$. So $m \\equiv 2 \\times 7 = 14$.\n$x_{8A} \\equiv 14^2 - 0 - 0 = 196 \\equiv 9$.\n$y_{8A} \\equiv 14(0-9)-11 = -126-11 = -137 \\equiv 16$. So $[8]A=(9,16)$.\n\nFinally, Bob computes $S_B = [8]A + [2]A$. Let $P=[8]A=(9,16)$ and $Q=[2]A=(16,13)$.\n$$m \\equiv \\frac{13-16}{16-9} = \\frac{-3}{7} = \\frac{14}{7} = 2 \\pmod{17}$$\nThe coordinates of $S_B=(x'_S, y'_S)$ are:\n$$x'_S \\equiv 2^2 - 9 - 16 = 4 - 25 = -21 \\equiv 13 \\pmod{17}$$\n$$y'_S \\equiv 2(9 - 13) - 16 = 2(-4) - 16 = -8 - 16 = -24 \\equiv 10 \\pmod{17}$$\nThe shared secret computed by Bob is $S_B = (13, 10)$.\n\nWe verify that $S_A = (13, 10) = S_B$, so the ECDH exchange is successful. The shared secret point is $S = (13, 10)$. The problem asks for the x-coordinate $x_S$.\n\n$x_S = 13$.", "answer": "$$\n\\boxed{13}\n$$", "id": "3084656"}]}