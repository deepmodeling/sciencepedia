{"hands_on_practices": [{"introduction": "The power of the Lenstra Elliptic Curve Method (ECM) stems from the properties of the group of points on an elliptic curve over a finite field. Before we can use these groups to factor integers, we must first understand their basic structure, starting with their size. This first exercise [@problem_id:3091819] guides you through the fundamental process of counting the points on a specific curve over a small prime field, $\\mathbb{F}_{11}$, and verifying your result with Hasse's theorem, a cornerstone in the theory of elliptic curves.", "problem": "Consider the elliptic curve $E$ given by $y^{2}=x^{3}+4x+1$ defined over the finite field $\\mathbb{F}_{11}$. In the Lenstra Elliptic Curve Method (ECM) for integer factorization, one studies elliptic curves modulo primes and composites; as a baseline, work over $\\mathbb{F}_{p}$ with a prime $p$ relies on foundational properties of elliptic curves over finite fields. Starting from the definitions of an elliptic curve as a nonsingular projective cubic and the group of $\\mathbb{F}_{p}$-rational points that includes the point at infinity, and using the fact that for each $x \\in \\mathbb{F}_{p}$ the number of $y \\in \\mathbb{F}_{p}$ solving $y^{2}=\\text{RHS}(x)$ depends on whether $\\text{RHS}(x)$ is a quadratic residue, proceed as follows:\n\n1. Verify that $E$ is nonsingular over $\\mathbb{F}_{11}$ by checking that its discriminant is nonzero modulo $11$.\n2. Enumerate all points of $E(\\mathbb{F}_{11})$ by determining, for each $x \\in \\mathbb{F}_{11}$, the number of solutions $y \\in \\mathbb{F}_{11}$ to $y^{2}=x^{3}+4x+1$, and then add the point at infinity.\n3. Let $q=11$ and $N=\\#E(\\mathbb{F}_{11})$. Using the Hasse bound, which states $|N-(q+1)|\\leq 2\\sqrt{q}$, check that your computed $N$ satisfies this inequality.\n\nReturn only the value of $N$ as your final answer. No rounding is required, and no units are involved.", "solution": "The problem asks for the number of points, $N$, on the elliptic curve $E$ given by the equation $y^{2}=x^{3}+4x+1$ over the finite field $\\mathbb{F}_{11}$. The total number of points, denoted $\\#E(\\mathbb{F}_{11})$, includes all pairs $(x, y) \\in \\mathbb{F}_{11} \\times \\mathbb{F}_{11}$ satisfying the curve equation, plus a single point at infinity, $\\mathcal{O}$. The procedure involves three steps as outlined in the problem statement.\n\nFirst, we verify that the curve $E$ is nonsingular over $\\mathbb{F}_{11}$. An elliptic curve of the form $y^{2}=x^{3}+Ax+B$ is nonsingular if and only if its discriminant, $\\Delta = -16(4A^3 + 27B^2)$, is nonzero. For the given curve, we have $A=4$ and $B=1$. All calculations are performed modulo $11$.\nThe discriminant is:\n$$ \\Delta = -16(4A^3 + 27B^2) $$\nSubstituting the values of $A$ and $B$ and working in $\\mathbb{F}_{11}$:\n$$ -16 \\equiv -5 \\equiv 6 \\pmod{11} $$\n$$ 4 \\equiv 4 \\pmod{11} $$\n$$ 27 \\equiv 5 \\pmod{11} $$\nSo, the discriminant modulo $11$ is:\n$$ \\Delta \\equiv 6(4 \\cdot 4^3 + 5 \\cdot 1^2) \\pmod{11} $$\n$$ \\Delta \\equiv 6(4 \\cdot 64 + 5) \\pmod{11} $$\nSince $64 = 5 \\times 11 + 9$, we have $64 \\equiv 9 \\pmod{11}$.\n$$ \\Delta \\equiv 6(4 \\cdot 9 + 5) \\pmod{11} $$\n$$ \\Delta \\equiv 6(36 + 5) \\pmod{11} $$\nSince $36 = 3 \\times 11 + 3$, we have $36 \\equiv 3 \\pmod{11}$.\n$$ \\Delta \\equiv 6(3 + 5) \\pmod{11} $$\n$$ \\Delta \\equiv 6(8) \\pmod{11} $$\n$$ \\Delta \\equiv 48 \\pmod{11} $$\nSince $48 = 4 \\times 11 + 4$, we have $48 \\equiv 4 \\pmod{11}$.\nThe discriminant is $\\Delta = 4$, which is nonzero in $\\mathbb{F}_{11}$. Thus, the curve $E$ is nonsingular.\n\nSecond, we enumerate the points on $E(\\mathbb{F}_{11})$. We must find the number of solutions $y \\in \\mathbb{F}_{11}$ to $y^2 = z$ for each value of $z = x^3+4x+1$, where $x$ ranges over all elements of $\\mathbb{F}_{11} = \\{0, 1, 2, \\dots, 10\\}$.\nThe number of solutions for $y$ depends on whether $z$ is a quadratic residue modulo $11$. Let's first determine the set of quadratic residues in $\\mathbb{F}_{11}$. We square the elements of $\\mathbb{F}_{11}$:\n$0^2 \\equiv 0$\n$1^2 \\equiv 1$, $10^2 \\equiv (-1)^2 \\equiv 1$\n$2^2 \\equiv 4$, $9^2 \\equiv (-2)^2 \\equiv 4$\n$3^2 \\equiv 9$, $8^2 \\equiv (-3)^2 \\equiv 9$\n$4^2 = 16 \\equiv 5$, $7^2 \\equiv (-4)^2 \\equiv 5$\n$5^2 = 25 \\equiv 3$, $6^2 \\equiv (-5)^2 \\equiv 3$\nThe set of quadratic residues (QR) is $\\{0, 1, 3, 4, 5, 9\\}$. The set of quadratic non-residues (QNR) is $\\{2, 6, 7, 8, 10\\}$.\nFor $y^2 = z$:\n- If $z=0$, there is one solution: $y=0$.\n- If $z$ is a non-zero QR, there are two solutions.\n- If $z$ is a QNR, there are zero solutions.\n\nNow we iterate through all $x \\in \\mathbb{F}_{11}$, calculate $z(x) = x^3+4x+1 \\pmod{11}$, and count the corresponding $y$ solutions.\n\n- For $x=0$: $z(0) = 0^3+4(0)+1 = 1$. $1$ is a QR. Number of solutions for $y$: $2$.\n- For $x=1$: $z(1) = 1^3+4(1)+1 = 6$. $6$ is a QNR. Number of solutions for $y$: $0$.\n- For $x=2$: $z(2) = 2^3+4(2)+1 = 8+8+1 = 17 \\equiv 6$. $6$ is a QNR. Number of solutions for $y$: $0$.\n- For $x=3$: $z(3) = 3^3+4(3)+1 = 27+12+1 \\equiv 5+1+1=7$. $7$ is a QNR. Number of solutions for $y$: $0$.\n- For $x=4$: $z(4) = 4^3+4(4)+1 = 64+16+1 \\equiv 9+5+1=15 \\equiv 4$. $4$ is a QR. Number of solutions for $y$: $2$.\n- For $x=5$: $z(5) = 5^3+4(5)+1 = 125+20+1 \\equiv 4+9+1=14 \\equiv 3$. $3$ is a QR. Number of solutions for $y$: $2$.\n- For $x=6$: $z(6) = 6^3+4(6)+1 = 216+24+1 \\equiv 7+2+1=10$. $10$ is a QNR. Number of solutions for $y$: $0$.\n- For $x=7$: $z(7) = 7^3+4(7)+1 = 343+28+1 \\equiv 2+6+1=9$. $9$ is a QR. Number of solutions for $y$: $2$.\n- For $x=8$: $z(8) = 8^3+4(8)+1 = 512+32+1 \\equiv 6+10+1=17 \\equiv 6$. $6$ is a QNR. Number of solutions for $y$: $0$.\n- For $x=9$: $z(9) = 9^3+4(9)+1 = 729+36+1 \\equiv 3+3+1=7$. $7$ is a QNR. Number of solutions for $y$: $0$.\n- For $x=10$: $z(10) = 10^3+4(10)+1 = 1000+40+1 \\equiv 10+7+1=18 \\equiv 7$. $7$ is a QNR. Number of solutions for $y$: $0$.\n\nThe total number of affine points (points with finite coordinates) is the sum of the number of solutions for $y$:\n$$ 2 + 0 + 0 + 0 + 2 + 2 + 0 + 2 + 0 + 0 + 0 = 8 $$\nThe total number of points on the curve is the sum of the affine points and the point at infinity, $\\mathcal{O}$.\n$$ N = \\#E(\\mathbb{F}_{11}) = 8 + 1 = 9 $$\n\nThird, we check this result against the Hasse bound. The Hasse bound for an elliptic curve over a finite field $\\mathbb{F}_q$ states that $| \\#E(\\mathbb{F}_q) - (q+1) | \\leq 2\\sqrt{q}$.\nIn our case, $q=11$ and we found $N=9$. We must check if $|9 - (11+1)| \\leq 2\\sqrt{11}$.\n$$ |9 - 12| \\leq 2\\sqrt{11} $$\n$$ |-3| \\leq 2\\sqrt{11} $$\n$$ 3 \\leq 2\\sqrt{11} $$\nTo verify this inequality, we can square both sides since both are positive:\n$$ 3^2 \\leq (2\\sqrt{11})^2 $$\n$$ 9 \\leq 4 \\times 11 $$\n$$ 9 \\leq 44 $$\nThe inequality is true, which means our computed number of points $N=9$ is consistent with Hasse's theorem.\n\nThe value of $N = \\#E(\\mathbb{F}_{11})$ is $9$.", "answer": "$$\n\\boxed{9}\n$$", "id": "3091819"}, {"introduction": "At the heart of ECM is arithmeticâ€”specifically, adding points on an elliptic curve. To perform the scalar multiplication $[k]P$ that drives the algorithm, we need to master the underlying operations of point addition and point doubling. This practice problem [@problem_id:3091839] allows you to perform these crucial calculations in a prime field, where the group law is well-behaved, providing a solid foundation before tackling the more complex case of a composite modulus.", "problem": "Consider the elliptic curve $E$ over the finite field $\\mathbb{F}_{101}$ given by $y^{2}=x^{3}+2x+3$. In the Lenstra elliptic curve factorization method (ECM), one performs group operations on elliptic curves modulo a composite integer, where inverses can fail to exist and thereby reveal a nontrivial factor. To practice the underlying group operations in a setting where all nonzero elements are invertible, work over the prime field $\\mathbb{F}_{101}$ and let $(x_{1},y_{1})=(1,39)$ and $(x_{2},y_{2})=(3,6)$.\n\nTasks:\n- First, verify from first principles that $(x_{1},y_{1})$ and $(x_{2},y_{2})$ lie on $E$ by directly checking the defining equation $y^{2}=x^{3}+2x+3$ in $\\mathbb{F}_{101}$.\n- Using only the chord-and-tangent geometric group law as the fundamental base (that is, the line through two points or the tangent at a point meets the cubic in a third point, and the group sum is the reflection of this third intersection across the $x$-axis), derive algebraic formulas for $(x_{3},y_{3})=(x_{1},y_{1})+(x_{2},y_{2})$ and for $(x_{4},y_{4})=2(x_{1},y_{1})$ over $\\mathbb{F}_{101}$. Justify why the multiplicative inverses you use exist in $\\mathbb{F}_{101}$, and carry out the computations explicitly to obtain $(x_{3},y_{3})$ and $(x_{4},y_{4})$.\n- Let $s$ be the reduction modulo $101$ of the sum of the $x$-coordinates $x_{3}$ and $x_{4}$; that is, $s\\equiv x_{3}+x_{4}\\pmod{101}$ with $s\\in\\{0,1,\\dots,100\\}$. Report the single integer $s$ as your final answer.\n\nYour final answer must be the single integer $s$ in the canonical representative set $\\{0,1,\\dots,100\\}$. No rounding is required, and no units are involved. Do not report intermediate coordinates in the final answer; only provide $s$.", "solution": "We work over the prime field $\\mathbb{F}_{101}$, so every nonzero element has a multiplicative inverse modulo $101$.\n\nStep $1$: Verification that $(x_{1},y_{1})$ and $(x_{2},y_{2})$ lie on $E$.\n\n- For $(x_{1},y_{1})=(1,39)$, compute $y_{1}^{2}$ and $x_{1}^{3}+2x_{1}+3$ modulo $101$:\n$$y_{1}^{2}\\equiv 39^{2}\\equiv 1521\\equiv 1521-101\\cdot 15=1521-1515=6\\pmod{101}.$$\n$$x_{1}^{3}+2x_{1}+3\\equiv 1^{3}+2\\cdot 1+3=1+2+3=6\\pmod{101}.$$\nThus $(1,39)$ satisfies $y^{2}=x^{3}+2x+3$ in $\\mathbb{F}_{101}$.\n\n- For $(x_{2},y_{2})=(3,6)$:\n$$y_{2}^{2}\\equiv 6^{2}=36\\pmod{101},$$\n$$x_{2}^{3}+2x_{2}+3\\equiv 3^{3}+2\\cdot 3+3=27+6+3=36\\pmod{101}.$$\nThus $(3,6)$ satisfies the curve equation.\n\nStep $2$: Derivation of the addition and doubling formulas from the chord-and-tangent law.\n\nFundamental base: For a short Weierstrass equation $y^{2}=x^{3}+ax+b$ over a field of characteristic not equal to $2$ or $3$, the group law is defined geometrically as follows. Given two points $P=(x_{1},y_{1})$ and $Q=(x_{2},y_{2})$ with $x_{1}\\neq x_{2}$, the unique line $\\ell$ through $P$ and $Q$ has slope $m$ and equation $y=m(x-x_{1})+y_{1}$. Substituting $y$ into $y^{2}=x^{3}+ax+b$ yields a cubic in $x$ whose roots are the $x$-coordinates of the three intersection points of $\\ell$ with the curve. Since $x_{1}$ and $x_{2}$ are two roots, let $x_{3}$ be the third. By ViÃ¨teâ€™s relation, the sum of the roots equals $m^{2}$, hence\n$$x_{1}+x_{2}+x_{3}=m^{2},\\quad\\text{so}\\quad x_{3}=m^{2}-x_{1}-x_{2}.$$\nThe third intersection point on the curve is $(x_{3},y_{3}^{\\prime})$ with $y_{3}^{\\prime}=m(x_{3}-x_{1})+y_{1}$ on the line; the group sum is obtained by reflecting across the $x$-axis, so\n$$P+Q=(x_{3},-y_{3}^{\\prime})=(x_{3},\\,m(x_{1}-x_{3})-y_{1}).$$\nWhen $P=Q$, the line is tangent at $P$ and its slope is given by implicit differentiation of $y^{2}=x^{3}+ax+b$:\n$$2y\\,\\frac{dy}{dx}=3x^{2}+a\\quad\\Rightarrow\\quad m=\\frac{3x_{1}^{2}+a}{2y_{1}}.$$\nSubstituting this $m$ into the same algebraic relations gives\n$$x_{4}=m^{2}-2x_{1},\\qquad y_{4}=m(x_{1}-x_{4})-y_{1},$$\nfor $2P=(x_{4},y_{4})$. Over $\\mathbb{F}_{101}$, denominators are invertible as long as they are nonzero. In our case $x_{1}\\neq x_{2}$ so $x_{2}-x_{1}\\neq 0$, and $y_{1}\\neq 0$, so $2y_{1}\\neq 0$; thus inverses exist.\n\nWe now compute explicitly in $\\mathbb{F}_{101}$ with $a=2$.\n\nStep $3$: Compute $(x_{3},y_{3})=(x_{1},y_{1})+(x_{2},y_{2})$.\n\n- Slope $m$:\n$$m\\equiv \\frac{y_{2}-y_{1}}{x_{2}-x_{1}}\\equiv \\frac{6-39}{3-1}\\equiv \\frac{-33}{2}\\equiv \\frac{68}{2}\\pmod{101}.$$\nThe inverse of $2$ modulo $101$ is $51$ since $2\\cdot 51\\equiv 102\\equiv 1\\pmod{101}$. Hence\n$$m\\equiv 68\\cdot 51\\equiv 3468\\equiv 3468-101\\cdot 34=3468-3434=34\\pmod{101}.$$\n\n- $x$-coordinate:\n$$x_{3}\\equiv m^{2}-x_{1}-x_{2}\\equiv 34^{2}-1-3\\pmod{101}.$$\nSince $34^{2}=1156\\equiv 45\\pmod{101}$, we get\n$$x_{3}\\equiv 45-4=41\\pmod{101}.$$\n\n- $y$-coordinate:\n$$y_{3}\\equiv m(x_{1}-x_{3})-y_{1}\\equiv 34(1-41)-39\\equiv 34\\cdot (-40)-39\\pmod{101}.$$\nCompute $1-41\\equiv -40\\equiv 61\\pmod{101}$, so\n$$y_{3}\\equiv 34\\cdot 61-39\\equiv 2074-39\\equiv (2074-101\\cdot 20)-39\\equiv 54-39=15\\pmod{101}.$$\nThus $(x_{3},y_{3})=(41,15)$. A quick check: $y_{3}^{2}\\equiv 15^{2}=225\\equiv 23$, and $x_{3}^{3}+2x_{3}+3\\equiv 41^{3}+82+3$. Using $41^{2}\\equiv 65$ gives $41^{3}\\equiv 41\\cdot 65=2665\\equiv 39$, so $39+85\\equiv 124\\equiv 23$, agreeing with $y_{3}^{2}$.\n\nStep $4$: Compute $(x_{4},y_{4})=2(x_{1},y_{1})$.\n\n- Tangent slope $m$:\n$$m\\equiv \\frac{3x_{1}^{2}+a}{2y_{1}}\\equiv \\frac{3\\cdot 1^{2}+2}{2\\cdot 39}\\equiv \\frac{5}{78}\\pmod{101}.$$\nFind the inverse of $78$ modulo $101$. Using the extended Euclidean algorithm:\n$$101=78+23,\\quad 78=3\\cdot 23+9,\\quad 23=2\\cdot 9+5,\\quad 9=1\\cdot 5+4,\\quad 5=1\\cdot 4+1,$$\nback-substitution yields $-22\\cdot 78+17\\cdot 101=1$, so $78^{-1}\\equiv -22\\equiv 79\\pmod{101}$. Therefore\n$$m\\equiv 5\\cdot 79\\equiv 395\\equiv 395-101\\cdot 3=395-303=92\\pmod{101}.$$\n\n- $x$-coordinate:\n$$x_{4}\\equiv m^{2}-2x_{1}\\equiv 92^{2}-2\\cdot 1\\pmod{101}.$$\nSince $92\\equiv -9$, $92^{2}\\equiv 81$, giving\n$$x_{4}\\equiv 81-2=79\\pmod{101}.$$\n\n- $y$-coordinate:\n$$y_{4}\\equiv m(x_{1}-x_{4})-y_{1}\\equiv 92(1-79)-39\\equiv 92\\cdot (-78)-39\\pmod{101}.$$\nSince $-78\\equiv 23$, we have\n$$y_{4}\\equiv 92\\cdot 23-39\\equiv 2116-39\\equiv (2116-101\\cdot 20)-39\\equiv 96-39=57\\pmod{101}.$$\nThus $(x_{4},y_{4})=(79,57)$. A quick check: $y_{4}^{2}\\equiv 57^{2}=3249\\equiv 17$, and $x_{4}^{3}+2x_{4}+3\\equiv 79^{3}+161\\equiv 58+60=118\\equiv 17$.\n\nStep $5$: Compute the requested single integer $s$.\n\nBy definition $s\\equiv x_{3}+x_{4}\\pmod{101}$ with $s\\in\\{0,1,\\dots,100\\}$. We have $x_{3}=41$ and $x_{4}=79$, so\n$$s\\equiv 41+79=120\\equiv 120-101=19\\pmod{101}.$$\nTherefore $s=19$ in the canonical representative set.\n\nRemark on relevance to the Lenstra elliptic curve factorization method (ECM): In ECM one performs the same rational-slope computations modulo a composite integer $N$. When a denominator such as $x_{2}-x_{1}$ or $2y_{1}$ is not invertible modulo $N$, computing its greatest common divisor with $N$ yields a nontrivial factor. The explicit computations above illustrate the group law steps that ECM relies on, here carried out in the safe setting of a prime modulus $101$ where all nonzero denominators are invertible.", "answer": "$$\\boxed{19}$$", "id": "3091839"}, {"introduction": "Now we arrive at the central insight of the Lenstra method: the elegant failure of the group law. When we perform elliptic curve arithmetic modulo a composite number $N$, an operation that is routine over a field might fail because a required modular inverse does not exist. This \"failure\" is actually a success, as it immediately reveals a factor of $N$. This final exercise [@problem_id:3091785] provides a concrete example of this phenomenon, walking you through the exact moment a point doubling operation uncovers a hidden prime factor of a composite number.", "problem": "Let $N$ be the composite modulus $N = 10403$ and consider the cubic congruence class defined by\n$$\nE: \\ y^{2} \\equiv x^{3} + a x + b \\pmod{N}\n$$\nwith coefficients $a = 99$ and $b = 454$. Let $P = (x_{0}, y_{0}) = (26, 101)$ be the chosen starting point for applying the Lenstra elliptic curve factorization method (ECM) over $\\mathbb{Z}_{N}$. You may take as foundational facts that, over a ring, the standard chord-and-tangent addition law for a Weierstrass model requires inverting certain denominators modulo $N$, and that a nonzero element of $\\mathbb{Z}_{N}$ is invertible if and only if it is coprime to $N$.\n\nTasks:\n1. Verify that $P$ satisfies the curve equation $E$ modulo $N$.\n2. Explain, starting from the group law on a Weierstrass model and the fact that not all nonzero elements are invertible in $\\mathbb{Z}_{N}$, why attempting the first doubling $2P$ forces the computation of an inverse of a denominator of the form $2 y_{0} \\pmod N$, and why failure of invertibility reveals a nontrivial greatest common divisor with $N$.\n3. Compute that greatest common divisor explicitly for this $E$ and $P$, and thereby obtain a nontrivial prime factor $p$ of $N$. As a consistency check grounded in the definition of singularity, briefly justify that modulo this $p$ the curve $E$ is singular, while modulo the complementary prime factor $q$ of $N$ it is nonsingular, by examining the discriminant factor $4 a^{3} + 27 b^{2}$ modulo $p$ and modulo $q$.\n\nGive the prime $p$ you obtain as your final answer. No rounding is required, and no units are involved. Your answer must be a single integer.", "solution": "We begin with the standard Weierstrass model $E: y^{2} \\equiv x^{3} + a x + b \\pmod{N}$ over the ring $\\mathbb{Z}_{N}$. In the Lenstra elliptic curve factorization method (ECM), one performs elliptic curve additions and scalar multiplications modulo $N$ using the usual chord-and-tangent formulas. These formulas require computing a slope $\\lambda$ that contains a numerator and a denominator; the denominator must be inverted modulo $N$ to complete the addition. Over a field, every nonzero element is invertible, but over the ring $\\mathbb{Z}_{N}$ with composite $N$, a nonzero element is invertible if and only if its greatest common divisor with $N$ is $1$. If the required denominator has a nontrivial greatest common divisor with $N$, the attempted inversion fails and that greatest common divisor yields a factor of $N$.\n\nStep $1$: Verify that $P$ lies on $E$ modulo $N$.\nWe compute\n$$\nx_{0}^{3} + a x_{0} + b \\equiv 26^{3} + 99 \\cdot 26 + 454 \\pmod{10403}.\n$$\nFirst, $26^{3} = 17576$, and $99 \\cdot 26 = 2574$, so\n$$\nx_{0}^{3} + a x_{0} + b = 17576 + 2574 + 454 = 20604.\n$$\nReduce modulo $10403$:\n$$\n20604 \\equiv 20604 - 10403 = 10201 \\pmod{10403}.\n$$\nAlso,\n$$\ny_{0}^{2} = 101^{2} = 10201.\n$$\nTherefore $y_{0}^{2} \\equiv x_{0}^{3} + a x_{0} + b \\pmod{10403}$, so $P$ satisfies the curve equation.\n\nStep $2$: Explain the role of the denominator and the greatest common divisor.\nFor a point $P = (x_{0}, y_{0})$ with $y_{0} \\not\\equiv 0 \\pmod{N}$, the tangent (doubling) formula on a Weierstrass model uses a slope\n$$\n\\lambda \\equiv \\frac{3 x_{0}^{2} + a}{2 y_{0}} \\pmod{N},\n$$\nand the computation requires the modular inverse of $2 y_{0}$ modulo $N$. Over $\\mathbb{Z}_{N}$, such an inverse exists if and only if $\\gcd(2 y_{0}, N) = 1$. If $\\gcd(2 y_{0}, N) = d > 1$, then inversion fails, and the computation of $\\gcd(2 y_{0}, N)$ immediately yields a nontrivial factor $d$ of $N$. This mechanism is exactly how ECM exploits accidental singularities modulo a hidden prime factor $p$ of $N$: on the singular fiber modulo $p$, group-law denominators can vanish in the field $\\mathbb{F}_{p}$, and over $\\mathbb{Z}_{N}$ this manifests as a denominator sharing a nontrivial divisor with $N$, revealing that divisor by a greatest common divisor computation.\n\nStep $3$: Compute the revealing greatest common divisor for this example.\nFor our $P = (26, 101)$, the doubling denominator is $2 y_{0} = 2 \\cdot 101 = 202$. Compute\n$$\n\\gcd(2 y_{0}, N) = \\gcd(202, 10403).\n$$\nWe perform the Euclidean algorithm:\n$$\n10403 = 202 \\cdot 51 + 101, \\quad 202 = 101 \\cdot 2 + 0,\n$$\nhence $\\gcd(202, 10403) = 101$. Therefore $p = 101$ is a nontrivial prime factor of $N$ revealed by the failed inversion of the doubling denominator.\n\nConsistency check via singularity and nonsingularity modulo the prime factors.\nThe discriminant of $y^{2} = x^{3} + a x + b$ is $\\Delta = -16(4 a^{3} + 27 b^{2})$. Singularity modulo a prime $r$ is equivalent to $4 a^{3} + 27 b^{2} \\equiv 0 \\pmod{r}$. We verify this modulo $p = 101$ and modulo the complementary prime $q = N / p = 10403 / 101 = 103$.\n\nCompute modulo $p = 101$:\n$$\na \\equiv 99 \\equiv -2 \\pmod{101}, \\quad b \\equiv 454 \\equiv 50 \\pmod{101}.\n$$\nThen\n$$\n4 a^{3} + 27 b^{2} \\equiv 4(-2)^{3} + 27 \\cdot 50^{2} \\equiv 4(-8) + 27 \\cdot 2500 \\pmod{101}.\n$$\nReduce each term modulo $101$:\n$$\n4(-8) \\equiv -32 \\equiv 69 \\pmod{101},\n$$\nand\n$$\n50^{2} = 2500 \\equiv 2500 - 24 \\cdot 101 = 2500 - 2424 = 76 \\pmod{101}, \\quad 27 \\cdot 76 = 2052 \\equiv 2052 - 20 \\cdot 101 = 32 \\pmod{101}.\n$$\nThus\n$$\n4 a^{3} + 27 b^{2} \\equiv 69 + 32 = 101 \\equiv 0 \\pmod{101},\n$$\nso $E$ is singular modulo $p$.\n\nCompute modulo $q = 103$:\n$$\na \\equiv 99 \\pmod{103}, \\quad b \\equiv 454 \\equiv 42 \\pmod{103}.\n$$\nWe have $a^{3} \\equiv 99^{3} \\equiv (-4)^{3} \\equiv -64 \\equiv 39 \\pmod{103}$, so $4 a^{3} \\equiv 4 \\cdot 39 \\equiv 156 \\equiv 53 \\pmod{103}$. Also $b^{2} \\equiv 42^{2} = 1764 \\equiv 1764 - 17 \\cdot 103 = 13 \\pmod{103}$, hence $27 b^{2} \\equiv 27 \\cdot 13 = 351 \\equiv 351 - 3 \\cdot 103 = 42 \\pmod{103}$. Therefore\n$$\n4 a^{3} + 27 b^{2} \\equiv 53 + 42 = 95 \\not\\equiv 0 \\pmod{103},\n$$\nso $E$ is nonsingular modulo $q$.\n\nThis confirms that our chosen example is singular modulo the hidden factor $p$ and that the first doubling step triggers a greatest common divisor computation yielding $p$ immediately.\n\nTherefore, the prime factor revealed by early ECM arithmetic is $p = 101$.", "answer": "$$\\boxed{101}$$", "id": "3091785"}]}