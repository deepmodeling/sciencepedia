{"hands_on_practices": [{"introduction": "The modern statement of the Prime Number Theorem asserts that the prime-counting function $\\pi(x)$ is best approximated by the logarithmic integral, $\\mathrm{Li}(x)$. To truly appreciate why $\\mathrm{Li}(x)$ is a superior approximation to the simpler $x/\\ln x$, and to understand the structure of the error in the approximation, we must first analyze the behavior of $\\mathrm{Li}(x)$ itself for large $x$. This exercise guides you through a fundamental technique in analytic number theory—repeated integration by parts—to derive the asymptotic expansion of $\\mathrm{Li}(x)$. Mastering this procedure is key to understanding how approximations and their error terms are systematically improved. [@problem_id:3092785]", "problem": "Let $x>2$ and define the logarithmic integral function by the improper integral\n$$\\mathrm{Li}(x)\\;=\\;\\int_{2}^{x}\\frac{dt}{\\ln t}.$$\nThis function is central in the statement of the Prime Number Theorem (PNT), which asserts that the prime counting function $\\pi(x)$ is asymptotic to $\\mathrm{Li}(x)$ as $x\\to\\infty$. Starting only from the definition of $\\mathrm{Li}(x)$ and standard results from real analysis and calculus (including the Riemann integral, the natural logarithm, and the method of integration by parts), derive the two-term asymptotic expansion of $\\mathrm{Li}(x)$ as $x\\to\\infty$, along with a remainder term bounded in Landau big-$O$ notation. Your derivation should justify the order of the remainder term from first principles. \n\nExpress your final result as a single analytic expression involving $x$, $\\ln x$, and big-$O$ notation. No numerical approximation or rounding is required. The final answer must be a single expression, not an equation or inequality.", "solution": "The problem requires the derivation of the two-term asymptotic expansion for the logarithmic integral function, $\\mathrm{Li}(x)$, defined for $x > 2$ as:\n$$ \\mathrm{Li}(x) = \\int_{2}^{x} \\frac{dt}{\\ln t} $$\nThe derivation must be performed from first principles using standard calculus results, primarily the method of integration by parts.\n\nWe begin with the integral definition of $\\mathrm{Li}(x)$. To find its asymptotic behavior as $x \\to \\infty$, we apply integration by parts, which follows the formula $\\int u \\, dv = uv - \\int v \\, du$. We make the following choices for $u$ and $dv$:\nLet $u = \\frac{1}{\\ln t}$ and $dv = dt$.\nDifferentiating $u$ and integrating $dv$ gives us:\n$du = \\frac{d}{dt} \\left( (\\ln t)^{-1} \\right) = -1 \\cdot (\\ln t)^{-2} \\cdot \\frac{1}{t} dt = -\\frac{dt}{t (\\ln t)^2}$.\n$v = \\int dt = t$.\n\nApplying this to the definite integral for $\\mathrm{Li}(x)$:\n$$ \\mathrm{Li}(x) = \\left[ t \\cdot \\frac{1}{\\ln t} \\right]_{2}^{x} - \\int_{2}^{x} t \\left( -\\frac{1}{t (\\ln t)^2} \\right) dt $$\nEvaluating the boundary term, we get:\n$$ \\left[ \\frac{t}{\\ln t} \\right]_{2}^{x} = \\frac{x}{\\ln x} - \\frac{2}{\\ln 2} $$\nThe integral part simplifies to:\n$$ - \\int_{2}^{x} \\left( -\\frac{1}{(\\ln t)^2} \\right) dt = \\int_{2}^{x} \\frac{dt}{(\\ln t)^2} $$\nCombining these results gives the first step of our expansion:\n$$ \\mathrm{Li}(x) = \\frac{x}{\\ln x} - \\frac{2}{\\ln 2} + \\int_{2}^{x} \\frac{dt}{(\\ln t)^2} $$\nThe term $\\frac{x}{\\ln x}$ is the leading term in the asymptotic expansion. The term $-\\frac{2}{\\ln 2}$ is a constant. The integral $\\int_{2}^{x} \\frac{dt}{(\\ln t)^2}$ is a remainder term, which we expect to be of a lower order than $\\frac{x}{\\ln x}$.\n\nTo find the second term of the expansion, we apply integration by parts again to the remainder integral, which we denote as $I_1(x) = \\int_{2}^{x} \\frac{dt}{(\\ln t)^2}$. We choose parts similarly:\nLet $u = \\frac{1}{(\\ln t)^2}$ and $dv = dt$.\nThen, $du = -2(\\ln t)^{-3} \\cdot \\frac{1}{t} dt = -\\frac{2 dt}{t (\\ln t)^3}$ and $v = t$.\nApplying integration by parts to $I_1(x)$:\n$$ I_1(x) = \\left[ \\frac{t}{(\\ln t)^2} \\right]_{2}^{x} - \\int_{2}^{x} t \\left( -\\frac{2}{t (\\ln t)^3} \\right) dt $$\n$$ I_1(x) = \\frac{x}{(\\ln x)^2} - \\frac{2}{(\\ln 2)^2} + 2 \\int_{2}^{x} \\frac{dt}{(\\ln t)^3} $$\nNow, we substitute this expression for $I_1(x)$ back into our equation for $\\mathrm{Li}(x)$:\n$$ \\mathrm{Li}(x) = \\frac{x}{\\ln x} - \\frac{2}{\\ln 2} + \\left( \\frac{x}{(\\ln x)^2} - \\frac{2}{(\\ln 2)^2} + 2 \\int_{2}^{x} \\frac{dt}{(\\ln t)^3} \\right) $$\nWe can group the terms to obtain:\n$$ \\mathrm{Li}(x) = \\frac{x}{\\ln x} + \\frac{x}{(\\ln x)^2} - C + 2 \\int_{2}^{x} \\frac{dt}{(\\ln t)^3} $$\nwhere $C = \\frac{2}{\\ln 2} + \\frac{2}{(\\ln 2)^2}$ is a constant.\n\nThe expression now contains the first two terms of the expansion, $\\frac{x}{\\ln x}$ and $\\frac{x}{(\\ln x)^2}$. The remaining part is the error term, $E(x) = -C + 2 \\int_{2}^{x} \\frac{dt}{(\\ln t)^3}$. The final step is to determine the asymptotic order of this term using Landau big-$O$ notation.\n\nThe constant $-C$ is of order $O(1)$. The primary component of the error term is the integral $R(x) = \\int_{2}^{x} \\frac{dt}{(\\ln t)^3}$. We need to show that this integral is of order $O\\left(\\frac{x}{(\\ln x)^3}\\right)$. To do this rigorously, we can use L'Hôpital's rule to evaluate the limit of the ratio of $R(x)$ and the function $g(x) = \\frac{x}{(\\ln x)^3}$ as $x \\to \\infty$.\nConsider the limit:\n$$ L = \\lim_{x \\to \\infty} \\frac{R(x)}{g(x)} = \\lim_{x \\to \\infty} \\frac{\\int_{2}^{x} \\frac{dt}{(\\ln t)^3}}{x/(\\ln x)^3} $$\nThis limit is an indeterminate form of the type $\\frac{\\infty}{\\infty}$. Both the numerator and the denominator are differentiable functions of $x$ for $x > 2$. Thus, we can apply L'Hôpital's rule.\nThe derivative of the numerator, by the Fundamental Theorem of Calculus, is:\n$$ \\frac{d}{dx} R(x) = \\frac{1}{(\\ln x)^3} $$\nThe derivative of the denominator is found using the quotient rule:\n$$ \\frac{d}{dx} g(x) = \\frac{d}{dx} \\left( \\frac{x}{(\\ln x)^3} \\right) = \\frac{1 \\cdot (\\ln x)^3 - x \\cdot 3(\\ln x)^2 \\cdot (1/x)}{(\\ln x)^6} = \\frac{(\\ln x)^3 - 3(\\ln x)^2}{(\\ln x)^6} = \\frac{\\ln x - 3}{(\\ln x)^4} $$\nNow we take the limit of the ratio of the derivatives:\n$$ L = \\lim_{x \\to \\infty} \\frac{1/(\\ln x)^3}{(\\ln x - 3)/(\\ln x)^4} = \\lim_{x \\to \\infty} \\frac{(\\ln x)^4}{(\\ln x)^3 (\\ln x - 3)} = \\lim_{x \\to \\infty} \\frac{\\ln x}{\\ln x - 3} $$\nDividing the numerator and denominator by $\\ln x$:\n$$ L = \\lim_{x \\to \\infty} \\frac{1}{1 - 3/\\ln x} = \\frac{1}{1-0} = 1 $$\nSince the limit $L=1$ exists and is finite, we have shown that $R(x) \\sim g(x)$, i.e., $\\int_{2}^{x} \\frac{dt}{(\\ln t)^3} \\sim \\frac{x}{(\\ln x)^3}$. By the definition of asymptotic equivalence, this implies that $R(x) = O(g(x))$, so $R(x) = O\\left(\\frac{x}{(\\ln x)^3}\\right)$.\n\nThe full error term is $E(x) = -C + 2 R(x)$. Substituting the order of $R(x)$, we have:\n$$ E(x) = O(1) + 2 \\cdot O\\left(\\frac{x}{(\\ln x)^3}\\right) = O(1) + O\\left(\\frac{x}{(\\ln x)^3}\\right) $$\nAs $x \\to \\infty$, the term $\\frac{x}{(\\ln x)^3}$ grows without bound, while the $O(1)$ term remains bounded. Therefore, the $O(1)$ term is subdominant and is absorbed into the larger big-O term:\n$$ E(x) = O\\left(\\frac{x}{(\\ln x)^3}\\right) $$\nSubstituting this result for the error term back into our expression for $\\mathrm{Li}(x)$, we arrive at the desired two-term asymptotic expansion:\n$$ \\mathrm{Li}(x) = \\frac{x}{\\ln x} + \\frac{x}{(\\ln x)^2} + O\\left(\\frac{x}{(\\ln x)^3}\\right) $$\nThis expression provides the first two terms of the asymptotic series for $\\mathrm{Li}(x)$ along with a remainder term whose order has been justified from first principles.", "answer": "$$\n\\boxed{\\frac{x}{\\ln x} + \\frac{x}{(\\ln x)^2} + O\\left(\\frac{x}{(\\ln x)^3}\\right)}\n$$", "id": "3092785"}, {"introduction": "A direct and powerful consequence of the Prime Number Theorem is the ability to estimate the density of primes in large intervals. This practice addresses a classic question: approximately how many primes exist between a large number $x$ and its double, $2x$? While it may seem straightforward to just subtract the asymptotic formulas, this exercise requires a more careful approach using the formal definition of asymptotic equivalence. This problem reinforces the precise meaning of the '$\\sim$' notation and provides a rigorous justification for a result that is a far-reaching extension of Bertrand's Postulate. [@problem_id:3092828]", "problem": "Let $\\pi(x)$ denote the prime-counting function, that is, the number of prime numbers less than or equal to $x$. Using only the statement of the Prime Number Theorem (PNT), namely that $\\pi(x)\\sim x/\\ln x$ as $x\\to\\infty$, derive an asymptotic estimate for the number of primes in the interval $(x,2x]$. Begin from the fundamental identity $\\pi(2x)-\\pi(x)$ and justify, by careful comparison of the terms arising from the PNT, that this count is asymptotic to a single closed-form expression in $x$ involving the natural logarithm. Your final answer must be a single analytic expression in $x$ with no inequalities.", "solution": "The problem asks for an asymptotic estimate for the number of prime numbers in the interval $(x, 2x]$. The number of such primes is precisely given by the difference of the prime-counting function values, $\\pi(2x) - \\pi(x)$. We are to use the Prime Number Theorem (PNT) to derive this estimate.\n\nThe statement of the PNT is given as $\\pi(x) \\sim \\frac{x}{\\ln x}$ as $x \\to \\infty$. By definition, two functions $f(x)$ and $g(x)$ are asymptotic to each other, written $f(x) \\sim g(x)$, if the limit of their ratio is $1$:\n$$ \\lim_{x\\to\\infty} \\frac{f(x)}{g(x)} = 1 $$\n\nWe seek a simple function $g(x)$ such that $\\pi(2x) - \\pi(x) \\sim g(x)$. A natural candidate for $g(x)$ is the difference of the asymptotic approximations for $\\pi(2x)$ and $\\pi(x)$. However, one must be cautious, as $f_1(x) \\sim g_1(x)$ and $f_2(x) \\sim g_2(x)$ does not, in general, imply that $f_1(x) - f_2(x) \\sim g_1(x) - g_2(x)$, especially if $g_1(x)$ and $g_2(x)$ are close in value.\n\nA rigorous approach is to directly analyze the limit of the ratio of $\\pi(2x) - \\pi(x)$ to a candidate function. Let us test the function $\\frac{x}{\\ln x}$ as the asymptotic estimate. We must verify if the following limit holds:\n$$ \\lim_{x\\to\\infty} \\frac{\\pi(2x) - \\pi(x)}{\\frac{x}{\\ln x}} = 1 $$\n\nUsing the properties of limits, we can express the limit of the ratio as the difference of two limits, provided each limit exists and is finite:\n$$ \\lim_{x\\to\\infty} \\frac{\\pi(2x) - \\pi(x)}{\\frac{x}{\\ln x}} = \\lim_{x\\to\\infty} \\left( \\frac{\\pi(2x)}{\\frac{x}{\\ln x}} - \\frac{\\pi(x)}{\\frac{x}{\\ln x}} \\right) = \\left( \\lim_{x\\to\\infty} \\frac{\\pi(2x)}{\\frac{x}{\\ln x}} \\right) - \\left( \\lim_{x\\to\\infty} \\frac{\\pi(x)}{\\frac{x}{\\ln x}} \\right) $$\n\nLet's evaluate each limit separately.\n\nFor the second term, by the definition of the PNT, we have:\n$$ \\lim_{x\\to\\infty} \\frac{\\pi(x)}{\\frac{x}{\\ln x}} = 1 $$\n\nFor the first term, we can rewrite the expression by multiplying and dividing by the asymptotic form of $\\pi(2x)$, which is $\\frac{2x}{\\ln(2x)}$, as given by the PNT with argument $2x$:\n$$ \\lim_{x\\to\\infty} \\frac{\\pi(2x)}{\\frac{x}{\\ln x}} = \\lim_{x\\to\\infty} \\left( \\frac{\\pi(2x)}{\\frac{2x}{\\ln(2x)}} \\cdot \\frac{\\frac{2x}{\\ln(2x)}}{\\frac{x}{\\ln x}} \\right) $$\nUsing the product rule for limits, we can separate this into two limits:\n$$ \\left( \\lim_{x\\to\\infty} \\frac{\\pi(2x)}{\\frac{2x}{\\ln(2x)}} \\right) \\cdot \\left( \\lim_{x\\to\\infty} \\frac{\\frac{2x}{\\ln(2x)}}{\\frac{x}{\\ln x}} \\right) $$\nThe first of these limits is equal to $1$ by the PNT applied to the argument $2x$:\n$$ \\lim_{x\\to\\infty} \\frac{\\pi(2x)}{\\frac{2x}{\\ln(2x)}} = 1 $$\nThe second limit requires algebraic manipulation:\n$$ \\lim_{x\\to\\infty} \\frac{\\frac{2x}{\\ln(2x)}}{\\frac{x}{\\ln x}} = \\lim_{x\\to\\infty} \\frac{2x}{\\ln(2x)} \\cdot \\frac{\\ln x}{x} = \\lim_{x\\to\\infty} \\frac{2\\ln x}{\\ln(2x)} $$\nUsing the logarithmic property $\\ln(2x) = \\ln 2 + \\ln x$, we have:\n$$ \\lim_{x\\to\\infty} \\frac{2\\ln x}{\\ln 2 + \\ln x} $$\nTo evaluate this limit, we divide the numerator and the denominator by $\\ln x$:\n$$ \\lim_{x\\to\\infty} \\frac{2}{\\frac{\\ln 2}{\\ln x} + 1} $$\nAs $x \\to \\infty$, $\\ln x \\to \\infty$, so $\\frac{\\ln 2}{\\ln x} \\to 0$. The limit is therefore:\n$$ \\frac{2}{0 + 1} = 2 $$\nCombining the results for the first term of the original difference:\n$$ \\lim_{x\\to\\infty} \\frac{\\pi(2x)}{\\frac{x}{\\ln x}} = 1 \\cdot 2 = 2 $$\n\nNow we can substitute the values of the two limits back into the expression for the limit of the difference:\n$$ \\lim_{x\\to\\infty} \\frac{\\pi(2x) - \\pi(x)}{\\frac{x}{\\ln x}} = \\left( \\lim_{x\\to\\infty} \\frac{\\pi(2x)}{\\frac{x}{\\ln x}} \\right) - \\left( \\lim_{x\\to\\infty} \\frac{\\pi(x)}{\\frac{x}{\\ln x}} \\right) = 2 - 1 = 1 $$\nSince the limit of the ratio of $\\pi(2x) - \\pi(x)$ to $\\frac{x}{\\ln x}$ is $1$, we have rigorously established that:\n$$ \\pi(2x) - \\pi(x) \\sim \\frac{x}{\\ln x} $$\n\nThus, the asymptotic estimate for the number of primes in the interval $(x, 2x]$ is $\\frac{x}{\\ln x}$. This is a single closed-form expression in $x$ involving the natural logarithm, as required.", "answer": "$$\\boxed{\\frac{x}{\\ln x}}$$", "id": "3092828"}, {"introduction": "Asymptotic formulas are powerful for describing the limiting behavior of functions, but for practical applications in fields like cryptography and computational number theory, we need explicit, guaranteed bounds for finite values of $x$. This exercise bridges the gap between abstract theory and concrete computation. By applying established, effective bounds of the Rosser-Schoenfeld type, you will calculate a rigorous numerical interval for the value of $\\pi(10^{10})$. This practice demonstrates how the deep theoretical results of the Prime Number Theorem are honed into tools for precise, real-world estimation. [@problem_id:3092799]", "problem": "Let $\\pi(x)$ denote the prime-counting function. Using only established consequences of the prime number theorem and explicit effective bounds, proceed as follows:\n\n- State a pair of explicit Rosser–Schoenfeld-type inequalities for $\\pi(x)$ that hold for large $x$ and exhibit the first-order correction in $\\frac{1}{\\ln x}$ with concrete numerical constants.\n- Specialize your inequalities to $x = 10^{10}$ and compute a rigorous two-sided numerical interval containing $\\pi(10^{10})$.\n- From this interval, produce a single numerical estimate for $\\pi(10^{10})$ by taking the midpoint of your bounds. Then, certify an upper bound on the relative error of your estimate based on the interval you obtained, and ensure this certified relative error is no more than $6.0 \\times 10^{-3}$.\n- Round your final numerical estimate for $\\pi(10^{10})$ to four significant figures.\n\nYour final answer must be a single real number (rounded as instructed).", "solution": "The problem asks for an estimate of the prime-counting function, $\\pi(x)$, at $x=10^{10}$, based on explicit bounds related to the prime number theorem.\n\nFirst, we state a pair of explicit inequalities for $\\pi(x)$ that exhibit the first-order correction term. We use the bounds established by Dusart in 2010, which are a refinement of the original Rosser-Schoenfeld inequalities. For $x \\ge 599$, the following inequalities hold:\n$$ \\frac{x}{\\ln x} + \\frac{x}{(\\ln x)^2} < \\pi(x) $$\nAnd for $x \\ge 1$:\n$$ \\pi(x) < \\frac{x}{\\ln x} + \\frac{1.2762 x}{(\\ln x)^2} $$\nThese can be written in the form $\\frac{x}{\\ln x} \\left(1 + \\frac{C}{\\ln x}\\right)$ as requested:\n$$ \\frac{x}{\\ln x}\\left(1 + \\frac{1}{\\ln x}\\right) < \\pi(x) < \\frac{x}{\\ln x}\\left(1 + \\frac{1.2762}{\\ln x}\\right) $$\nThe condition $x \\ge 599$ is satisfied by $x=10^{10}$.\n\nNext, we specialize these inequalities for $x = 10^{10}$. We must compute $\\ln(x)$:\n$$ \\ln(x) = \\ln(10^{10}) = 10 \\ln(10) $$\nUsing a high-precision value for the natural logarithm of $10$, $\\ln(10) \\approx 2.30258509299$, we have:\n$$ L = \\ln(10^{10}) \\approx 10 \\times 2.30258509299 = 23.0258509299 $$\nLet $L_B$ be the lower bound and $U_B$ be the upper bound for $\\pi(10^{10})$.\n$$ L_B = \\frac{10^{10}}{L} + \\frac{10^{10}}{L^2} $$\n$$ U_B = \\frac{10^{10}}{L} + \\frac{1.2762 \\times 10^{10}}{L^2} $$\nWe compute the terms:\n$$ \\frac{10^{10}}{L} = \\frac{10^{10}}{10 \\ln 10} \\approx \\frac{10^{10}}{23.02585093} \\approx 434,294,481.90 $$\n$$ \\frac{10^{10}}{L^2} = \\frac{10^{10}}{(10 \\ln 10)^2} \\approx \\frac{10^{10}}{530.190108} \\approx 18,861,218.43 $$\nNow, we can compute the bounds:\n$$ L_B \\approx 434,294,481.90 + 18,861,218.43 = 453,155,700.33 $$\n$$ U_B \\approx 434,294,481.90 + 1.2762 \\times 18,861,218.43 \\approx 434,294,481.90 + 24,071,192.56 = 458,365,674.46 $$\nSince $\\pi(10^{10})$ must be an integer, we can establish the rigorous interval:\n$$ 453,155,701 \\le \\pi(10^{10}) \\le 458,365,674 $$\n\nThe problem asks for a single numerical estimate, $P_{est}$, by taking the midpoint of the calculated bounds $[L_B, U_B]$.\n$$ P_{est} = \\frac{L_B + U_B}{2} = \\frac{453,155,700.33 + 458,365,674.46}{2} = \\frac{911,521,374.79}{2} \\approx 455,760,687.4 $$\n\nWe must then certify an upper bound on the relative error of this estimate. The true value $\\pi(x)$ lies in the interval $[L_B, U_B]$, and our estimate $P_{est}$ is the midpoint. The maximum absolute error is the half-width of the interval:\n$$ \\Delta P = \\frac{U_B - L_B}{2} $$\nThe relative error is $\\frac{|\\pi(x) - P_{est}|}{\\pi(x)}$. To find an upper bound for this quantity, we use the maximum possible absolute error for the numerator and the minimum possible value for the denominator, which is $L_B$. The certified relative error $E_r$ is thus bounded by:\n$$ E_r \\le \\frac{\\Delta P}{L_B} = \\frac{(U_B - L_B) / 2}{L_B} $$\nLet's express this symbolically. Our bounds are of the form $\\frac{x}{L} + \\frac{C_1 x}{L^2}$ and $\\frac{x}{L} + \\frac{C_2 x}{L^2}$, with $L = \\ln x$, $C_1=1$, and $C_2=1.2762$.\n$$ E_r \\le \\frac{\\left(\\frac{x}{L} + \\frac{C_2 x}{L^2}\\right) - \\left(\\frac{x}{L} + \\frac{C_1 x}{L^2}\\right)}{2 \\left(\\frac{x}{L} + \\frac{C_1 x}{L^2}\\right)} = \\frac{\\frac{(C_2-C_1)x}{L^2}}{2 \\frac{x(L+C_1)}{L^2}} = \\frac{C_2 - C_1}{2(L+C_1)} $$\nSubstituting the values $C_1=1$, $C_2=1.2762$, and $L=10 \\ln 10$:\n$$ E_r \\le \\frac{1.2762 - 1}{2(10 \\ln 10 + 1)} \\approx \\frac{0.2762}{2(23.02585093 + 1)} = \\frac{0.2762}{48.05170186} \\approx 0.00574796 $$\nThe problem requires this certified relative error to be no more than $6.0 \\times 10^{-3}$. Our bound satisfies this condition:\n$$ 0.00574796 < 0.006 $$\n\nFinally, we round the numerical estimate for $\\pi(10^{10})$ to four significant figures.\n$$ P_{est} \\approx 455,760,687.4 $$\nThe first four significant figures are $4$, $5$, $5$, $7$. The following digit is $6$, so we round the fourth digit up.\n$$ P_{est} \\approx 455,800,000 = 4.558 \\times 10^8 $$", "answer": "$$ \\boxed{4.558 \\times 10^{8}} $$", "id": "3092799"}]}