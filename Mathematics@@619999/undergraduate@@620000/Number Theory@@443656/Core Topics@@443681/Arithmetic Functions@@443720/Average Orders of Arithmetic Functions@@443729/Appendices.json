{"hands_on_practices": [{"introduction": "To understand the average behavior of an arithmetic function like $\\sigma(n)$, we often study its summatory function, $S(x) = \\sum_{n \\le x} \\sigma(n)$. This first practice guides you through a fundamental technique in analytic number theory: transforming the sum by switching the order of summation. By doing so, you will derive the leading-order behavior of $S(x)$ and gain insight into why the average value of $\\sigma(n)$ grows linearly [@problem_id:3081698].", "problem": "Let $x \\geq 1$ be a real parameter, and let $\\sigma(n)$ denote the sum of the positive divisors of the integer $n$. Consider the summatory function $S(x)$ defined by $S(x) = \\sum_{n \\leq x} \\sigma(n)$. Starting from the definition of $\\sigma(n)$ and standard counting principles, derive the leading-order asymptotic for $S(x)$ as $x \\to \\infty$ by transforming the sum into an appropriate double sum and using well-tested estimates for simple finite sums of integers. Your derivation should begin with first principles (such as the definition of $\\sigma(n)$ and elementary summation facts) and may invoke widely accepted constants and limits for series that are known to converge. Provide your final result as a single closed-form expression for the quadratic leading term in $x$ that approximates $S(x)$ for large $x$. Additionally, briefly interpret why the leading term is quadratic and what its constant coefficient signifies in terms of the average order of $\\sigma(n)$. No rounding is required; report the leading term exactly.", "solution": "The problem is to find the leading-order asymptotic behavior of the summatory function $S(x) = \\sum_{n \\leq x} \\sigma(n)$ for large $x$, where $\\sigma(n)$ is the sum of the positive divisors of an integer $n$.\n\nWe begin with the definition of $S(x)$:\n$$S(x) = \\sum_{n=1}^{\\lfloor x \\rfloor} \\sigma(n)$$\nBy definition, $\\sigma(n) = \\sum_{d|n} d$, where the sum is over all positive divisors $d$ of $n$. Substituting this into the expression for $S(x)$ gives:\n$$S(x) = \\sum_{n=1}^{\\lfloor x \\rfloor} \\sum_{d|n} d$$\nThis is a double summation over pairs of integers $(n, d)$ such that $d$ divides $n$ and $n \\leq x$. We can change the order of summation. The condition $d | n$ means that $n = kd$ for some positive integer $k$. The condition $n \\leq x$ becomes $kd \\leq x$. Thus, we are summing the term $d$ over all pairs of positive integers $(k, d)$ satisfying $kd \\leq x$.\n$$S(x) = \\sum_{k \\geq 1, d \\geq 1, kd \\leq x} d$$\nWe can evaluate this sum by iterating over $k$ first, and then $d$. For a fixed $k$, the possible values of $d$ are $1, 2, \\ldots, \\lfloor x/k \\rfloor$. The range for $k$ is from $1$ up to $\\lfloor x \\rfloor$.\n$$S(x) = \\sum_{k=1}^{\\lfloor x \\rfloor} \\sum_{d=1}^{\\lfloor x/k \\rfloor} d$$\nThe inner sum is a simple arithmetic progression:\n$$\\sum_{d=1}^{\\lfloor x/k \\rfloor} d = \\frac{\\lfloor x/k \\rfloor (\\lfloor x/k \\rfloor + 1)}{2}$$\nSubstituting this back into the expression for $S(x)$:\n$$S(x) = \\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{\\lfloor x/k \\rfloor (\\lfloor x/k \\rfloor + 1)}{2}$$\nTo find the leading-order behavior for large $x$, we use the approximation for the floor function. For any real number $y \\geq 1$, we have $\\lfloor y \\rfloor = y - \\{y\\}$, where $0 \\leq \\{y\\} < 1$ is the fractional part of $y$. Therefore, we can write $\\lfloor y \\rfloor = y + O(1)$.\nApplying this to $\\lfloor x/k \\rfloor$:\n$$\\lfloor x/k \\rfloor = \\frac{x}{k} + O(1)$$\nThe term in the sum for $S(x)$ becomes:\n$$\\frac{1}{2}\\left(\\left(\\frac{x}{k} + O(1)\\right)\\left(\\frac{x}{k} + O(1) + 1\\right)\\right) = \\frac{1}{2}\\left(\\left(\\frac{x}{k}\\right)^2 + O\\left(\\frac{x}{k}\\right)\\right) = \\frac{x^2}{2k^2} + O\\left(\\frac{x}{k}\\right)$$\nNow, we sum this expression over $k$:\n$$S(x) = \\sum_{k=1}^{\\lfloor x \\rfloor} \\left(\\frac{x^2}{2k^2} + O\\left(\\frac{x}{k}\\right)\\right)$$\nWe can separate this into two parts:\n$$S(x) = \\frac{x^2}{2} \\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{1}{k^2} + \\sum_{k=1}^{\\lfloor x \\rfloor} O\\left(\\frac{x}{k}\\right)$$\nLet's analyze the first term, which will provide the leading term. The sum is a partial sum of the series $\\sum_{k=1}^{\\infty} \\frac{1}{k^2}$. This series converges to the Riemann zeta function evaluated at $2$, i.e., $\\zeta(2) = \\frac{\\pi^2}{6}$. We can write the partial sum as:\n$$\\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{1}{k^2} = \\sum_{k=1}^{\\infty} \\frac{1}{k^2} - \\sum_{k=\\lfloor x \\rfloor + 1}^{\\infty} \\frac{1}{k^2} = \\zeta(2) - R(x)$$\nThe remainder term $R(x)$ can be bounded by an integral:\n$$R(x) = \\sum_{k=\\lfloor x \\rfloor + 1}^{\\infty} \\frac{1}{k^2} < \\int_{\\lfloor x \\rfloor}^{\\infty} \\frac{1}{t^2} dt = \\left[-\\frac{1}{t}\\right]_{\\lfloor x \\rfloor}^{\\infty} = \\frac{1}{\\lfloor x \\rfloor} = O\\left(\\frac{1}{x}\\right)$$\nSo, the first part of $S(x)$ is:\n$$\\frac{x^2}{2} \\left(\\zeta(2) + O\\left(\\frac{1}{x}\\right)\\right) = \\frac{\\zeta(2)x^2}{2} + O(x) = \\frac{\\pi^2 x^2}{12} + O(x)$$\nNext, we analyze the error term from our approximation:\n$$E(x) = \\sum_{k=1}^{\\lfloor x \\rfloor} O\\left(\\frac{x}{k}\\right) = O\\left(x \\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{1}{k}\\right)$$\nThe sum is the harmonic series, whose asymptotic behavior is well-known:\n$$\\sum_{k=1}^{N} \\frac{1}{k} = \\ln(N) + \\gamma + O\\left(\\frac{1}{N}\\right) = O(\\ln N)$$\nwhere $\\gamma$ is the Euler-Mascheroni constant. With $N = \\lfloor x \\rfloor$, we have $\\sum_{k=1}^{\\lfloor x \\rfloor} \\frac{1}{k} = O(\\ln x)$.\nTherefore, the error term is:\n$$E(x) = O(x \\ln x)$$\nCombining the main term and the error term, we get the asymptotic formula for $S(x)$:\n$$S(x) = \\frac{\\pi^2 x^2}{12} + O(x \\ln x)$$\nThe leading-order term is the one that grows fastest as $x \\to \\infty$. Since $x^2$ grows faster than $x \\ln x$, the leading term is $\\frac{\\pi^2 x^2}{12}$.\n\nInterpretation:\n\n1.  Why is the leading term quadratic?\n    The summatory function $S(x) = \\sum_{n \\leq x} \\sigma(n)$ is a cumulative sum. The behavior of such a sum is largely determined by the average size of its terms. Our result implies that the average value of $\\sigma(n)$ for $n \\in [1, x]$ is $\\frac{S(x)}{x} \\approx \\frac{\\pi^2 x}{12}$. This means the average value of $\\sigma(n)$ grows approximately linearly with $n$. The summation (or discrete integration) of a function that grows linearly results in a function that grows quadratically, analogous to how $\\int_{0}^{x} ct \\,dt = \\frac{c}{2}x^2$. More formally, the average order of $\\sigma(n)$ is $\\frac{\\pi^2}{6}n$, because $\\sum_{n \\leq x} \\sigma(n) \\sim \\frac{\\pi^2 x^2}{12}$ and $\\sum_{n \\leq x} \\frac{\\pi^2}{6}n = \\frac{\\pi^2}{6} \\frac{\\lfloor x \\rfloor(\\lfloor x \\rfloor+1)}{2} \\sim \\frac{\\pi^2}{12}x^2$.\n\n2.  What does the constant coefficient $\\frac{\\pi^2}{12}$ signify?\n    The coefficient $\\frac{\\pi^2}{12}$ is precisely $\\frac{\\zeta(2)}{2}$. This constant arises from two factors in the derivation. The factor of $\\frac{1}{2}$ comes from the summation of a linear function, as explained above (e.g., from the formula for the sum of the first $M$ integers being $\\frac{M(M+1)}{2} \\approx \\frac{M^2}{2}$). The factor of $\\zeta(2) = \\frac{\\pi^2}{6}$ originates from the sum over the reciprocals of squares, $\\sum_{k=1}^{\\infty} \\frac{1}{k^2}$. This sum appears because of the way divisors are distributed. The average value of the ratio $\\frac{\\sigma(n)}{n}$ over large ranges of integers approaches $\\zeta(2)$. That is, $\\lim_{x\\to\\infty} \\frac{1}{x} \\sum_{n \\leq x} \\frac{\\sigma(n)}{n} = \\zeta(2) = \\frac{\\pi^2}{6}$. Our result for $S(x)$ is consistent with the heuristic that $\\sigma(n)$ behaves, on average, like $\\frac{\\pi^2}{6}n$. Summing this average behavior up to $x$ gives $\\sum_{n \\leq x} \\frac{\\pi^2}{6}n \\approx \\frac{\\pi^2}{6} \\frac{x^2}{2} = \\frac{\\pi^2}{12}x^2$. Thus, the coefficient encapsulates both the arithmetic nature of the divisor function (through $\\zeta(2)$) and the fundamental result of summation/integration.\n\nThe quadratic leading term of $S(x)$ is therefore $\\frac{\\pi^2}{12}x^2$.", "answer": "$$\\boxed{\\frac{\\pi^2}{12}x^2}$$", "id": "3081698"}, {"introduction": "Asymptotic formulas are powerful, but their practical utility often depends on our ability to control the error. Building on the previous derivation, this exercise challenges you to find an explicit bound for the error term in the approximation for $\\sum_{n \\le x} \\sigma(n)$. You will then use this bound to justify a numerical calculation, bridging the gap between abstract theory and concrete application [@problem_id:3081695].", "problem": "Let $\\sigma(n)$ denote the sum of the positive divisors of the integer $n$, and define $S(x) := \\sum_{n \\leq x} \\sigma(n)$ for a positive integer $x$. Starting from fundamental counting and summation principles, express $S(x)$ in a way that allows you to isolate a quadratic main term and to quantify the remainder. Without introducing any unproven shortcut formulas in the problem statement, derive an explicit approximation of the form $S(x) = \\text{(constant)} \\cdot x^{2} + \\text{error}$ and prove a fully explicit error bound of the shape $c_{1} x \\ln x + c_{2} x$ by determining concrete numerical constants $c_{1}$ and $c_{2}$. To identify the constant in the quadratic main term, you may use the well-tested fact $\\sum_{m=1}^{\\infty} m^{-2} = \\pi^{2}/6$. Then evaluate your approximation at $x = 10^{6}$ and provide the resulting numerical value of $S(10^{6})$ approximated by its main term, rounded to four significant figures. Use the natural logarithm for any bounds you require, and justify that your rounding is guaranteed by your explicit error bound.", "solution": "The problem asks for an approximation of the summatory function $S(x) := \\sum_{n \\leq x} \\sigma(n)$, where $\\sigma(n)$ is the sum of the positive divisors of $n$, for a positive integer $x$. The approximation should have a quadratic main term and an explicit error bound of the form $c_1 x \\ln x + c_2 x$.\n\n**Derivation of the Asymptotic Formula**\n\nWe start from the definition of $S(x)$ and $\\sigma(n)$.\n$$S(x) = \\sum_{n=1}^{x} \\sigma(n) = \\sum_{n=1}^{x} \\sum_{d|n} d$$\nThe condition $d|n$ means $n=dk$ for some integer $k$. The condition $n \\le x$ becomes $dk \\le x$. We can thus rewrite the sum over all pairs of positive integers $(d, k)$ such that $dk \\le x$, where the summand is $d$.\n$$S(x) = \\sum_{dk \\le x} d$$\nTo evaluate this sum over the region under the hyperbola $dk=x$, we can sum over one variable first. It is more convenient to sum over $k$ first.\n$$S(x) = \\sum_{k=1}^{x} \\sum_{d=1}^{\\lfloor x/k \\rfloor} d$$\nThe inner sum is the sum of the first $\\lfloor x/k \\rfloor$ integers, for which there is a closed-form expression:\n$$\\sum_{d=1}^{N} d = \\frac{N(N+1)}{2}$$\nSetting $N = \\lfloor x/k \\rfloor$, we get:\n$$S(x) = \\sum_{k=1}^{x} \\frac{\\lfloor x/k \\rfloor \\left(\\lfloor x/k \\rfloor + 1\\right)}{2}$$\nThis expression is exact. To obtain an approximation, we use the identity $\\lfloor y \\rfloor = y - \\{y\\}$, where $\\{y\\}$ is the fractional part of $y$, satisfying $0 \\le \\{y\\} < 1$. Let $y_k = x/k$.\n\\begin{align*} S(x) &= \\frac{1}{2} \\sum_{k=1}^{x} (y_k - \\{y_k\\})(y_k - \\{y_k\\} + 1) \\\\ &= \\frac{1}{2} \\sum_{k=1}^{x} \\left( y_k^2 + y_k - 2y_k\\{y_k\\} - \\{y_k\\} + \\{y_k\\}^2 \\right) \\\\ &= \\frac{1}{2} \\sum_{k=1}^{x} \\left( \\left(\\frac{x}{k}\\right)^2 + \\frac{x}{k} - 2\\frac{x}{k}\\left\\{\\frac{x}{k}\\right\\} + \\left\\{\\frac{x}{k}\\right\\}^2 - \\left\\{\\frac{x}{k}\\right\\} \\right)\\end{align*}\nWe can separate this into a sum of five terms:\n$$S(x) = \\frac{x^2}{2} \\sum_{k=1}^{x} \\frac{1}{k^2} + \\frac{x}{2} \\sum_{k=1}^{x} \\frac{1}{k} - x \\sum_{k=1}^{x} \\frac{\\{x/k\\}}{k} + \\frac{1}{2} \\sum_{k=1}^{x} \\left( \\left\\{\\frac{x}{k}\\right\\}^2 - \\left\\{\\frac{x}{k}\\right\\} \\right)$$\nThe main term comes from the first part. We use the given fact $\\sum_{k=1}^{\\infty} k^{-2} = \\pi^2/6$.\n$$\\frac{x^2}{2} \\sum_{k=1}^{x} \\frac{1}{k^2} = \\frac{x^2}{2} \\left( \\sum_{k=1}^{\\infty} \\frac{1}{k^2} - \\sum_{k=x+1}^{\\infty} \\frac{1}{k^2} \\right) = \\frac{\\pi^2 x^2}{12} - \\frac{x^2}{2} \\sum_{k=x+1}^{\\infty} \\frac{1}{k^2}$$\nSo, our approximation is $S(x) = \\frac{\\pi^2}{12} x^2 + E(x)$, where the error term $E(x)$ is:\n$$E(x) = - \\frac{x^2}{2} \\sum_{k=x+1}^{\\infty} \\frac{1}{k^2} + \\frac{x}{2} \\sum_{k=1}^{x} \\frac{1}{k} - x \\sum_{k=1}^{x} \\frac{\\{x/k\\}}{k} + \\frac{1}{2} \\sum_{k=1}^{x} \\left( \\left\\{\\frac{x}{k}\\right\\}^2 - \\left\\{\\frac{x}{k}\\right\\} \\right)$$\n**Derivation of the Explicit Error Bound**\n\nWe now derive an explicit bound for $|E(x)|$ for integer $x \\ge 1$. To this end, we find separate upper and lower bounds for $E(x)$ using elementary integral comparisons.\n\nFor a positive, decreasing function $f$, we have $\\int_{N+1}^{\\infty} f(t) dt < \\sum_{k=N+1}^{\\infty} f(k) < \\int_{N}^{\\infty} f(t) dt$.\nFor the harmonic series, we have $\\ln(x) < \\sum_{k=1}^x \\frac{1}{k} < 1 + \\ln(x)$.\n\n**Upper Bound for $E(x)$:**\nThe third and fourth terms in $E(x)$ are non-positive, since $0 \\le \\{y\\} < 1$ implies $\\{y\\} \\ge 0$ and $\\{y\\}^2 - \\{y\\} = \\{y\\}(\\{y\\}-1) \\le 0$.\n$$E(x) \\le - \\frac{x^2}{2} \\sum_{k=x+1}^{\\infty} \\frac{1}{k^2} + \\frac{x}{2} \\sum_{k=1}^{x} \\frac{1}{k}$$\nUsing the integral bounds:\n- $\\sum_{k=x+1}^{\\infty} \\frac{1}{k^2} > \\int_{x+1}^{\\infty} \\frac{dt}{t^2} = \\frac{1}{x+1}$.\n- $\\sum_{k=1}^{x} \\frac{1}{k} < 1 + \\ln(x)$.\n$$E(x) < - \\frac{x^2}{2(x+1)} + \\frac{x}{2}(1 + \\ln x)$$\nSince $\\frac{x^2}{x+1} = \\frac{x^2-1+1}{x+1} = x-1+\\frac{1}{x+1}$, we get:\n$$E(x) < - \\frac{1}{2}\\left(x-1+\\frac{1}{x+1}\\right) + \\frac{x}{2} + \\frac{x \\ln x}{2} = -\\frac{x}{2} + \\frac{1}{2} - \\frac{1}{2(x+1)} + \\frac{x}{2} + \\frac{x \\ln x}{2} = \\frac{x \\ln x}{2} + \\frac{1}{2} - \\frac{1}{2(x+1)}$$\nFor $x \\ge 1$, this gives $E(x) < \\frac{1}{2}x \\ln x + \\frac{1}{2}$.\n\n**Lower Bound for $E(x)$:**\nWe use the bounds $0 \\le \\{y\\} < 1$ and $\\{y\\}^2 - \\{y\\} \\ge -1/4$. The term $-x\\sum \\frac{\\{x/k\\}}{k}$ is bounded below by $-x\\sum\\frac{1}{k}$.\n$$E(x) > - \\frac{x^2}{2} \\sum_{k=x+1}^{\\infty} \\frac{1}{k^2} - \\frac{x}{2} \\sum_{k=1}^{x} \\frac{1}{k} - \\frac{x}{8}$$\nUsing the integral bounds:\n- $\\sum_{k=x+1}^{\\infty} \\frac{1}{k^2} < \\int_{x}^{\\infty} \\frac{dt}{t^2} = \\frac{1}{x}$.\n- $\\sum_{k=1}^{x} \\frac{1}{k} < 1 + \\ln(x)$.\n$$E(x) > - \\frac{x^2}{2x} - \\frac{x}{2}(1+\\ln x) - \\frac{x}{8} = -\\frac{x}{2} - \\frac{x}{2} - \\frac{x \\ln x}{2} - \\frac{x}{8} = - \\frac{x \\ln x}{2} - \\frac{9x}{8}$$\nLet's refine this. We are using $-x\\sum \\frac{\\{x/k\\}}{k} \\ge -x\\sum \\frac{1}{k}$ and $\\frac{1}{2}\\sum(\\{y\\}^2-\\{y\\}) \\ge \\frac{1}{2}\\sum(-\\frac{1}{4})=-\\frac{x}{8}$. The sum is $E(x) = [- \\frac{x^2}{2} \\sum_{k>x} \\frac{1}{k^2}] + [\\frac{x}{2} \\sum \\frac{1}{k}] + [-x\\sum \\frac{\\{x/k\\}}{k}] + [\\frac{1}{2}\\sum(\\dots)]$.\nThe lower bound is\n$E(x) > - \\frac{x^2}{2x} + \\frac{x}{2}\\ln x - x(1+\\ln x) - \\frac{x}{8} = -\\frac{1}{2}x \\ln x -(\\frac{1}{2}+1+\\frac{1}{8})x = -\\frac{1}{2}x\\ln x - \\frac{13}{8}x$.\nCombining the bounds, we have:\n$$-\\frac{1}{2}x \\ln x - \\frac{13}{8}x \\le E(x) < \\frac{1}{2}x \\ln x + \\frac{1}{2}$$\nFor $x \\ge 1$, the magnitude of the lower bound is greater than the magnitude of the upper bound. Thus, we can bound the absolute value of the error as:\n$$|E(x)| \\le \\frac{1}{2}x \\ln x + \\frac{13}{8}x$$\nThis gives the requested form with $c_1 = 1/2$ and $c_2 = 13/8 = 1.625$.\n\n**Numerical Approximation and Justification**\nWe are asked to approximate $S(10^6)$ using the main term $M(x) = \\frac{\\pi^2}{12}x^2$.\nLet $x=10^6$.\n$$M(10^6) = \\frac{\\pi^2}{12} (10^6)^2 = \\frac{\\pi^2}{12} \\times 10^{12}$$\nUsing $\\pi \\approx 3.1415926535$, we get $\\pi^2 \\approx 9.869604401$.\n$$M(10^6) \\approx \\frac{9.869604401}{12} \\times 10^{12} \\approx 0.8224670334 \\times 10^{12} = 8.224670334 \\times 10^{11}$$\nRounding this main term to four significant figures gives $8.225 \\times 10^{11}$.\n\nWe must justify this rounding using our error bound $|E(x)| \\le \\frac{1}{2}x\\ln x + \\frac{13}{8}x$.\nFor $x=10^6$, $\\ln(10^6) = 6 \\ln(10) \\approx 6 \\times 2.302585 = 13.81551$.\n$$|E(10^6)| \\le \\frac{1}{2}(10^6)(13.81551) + \\frac{13}{8}(10^6) = (6.907755 + 1.625) \\times 10^6 = 8.532755 \\times 10^6$$\nThe true value is $S(10^6) = M(10^6) + E(10^6)$. This means $S(10^6)$ lies in the interval:\n$$[M(10^6) - |E(10^6)|, M(10^6) + |E(10^6)|]$$\n$$[8.2246703 \\times 10^{11} - 8.532755 \\times 10^6, 8.2246703 \\times 10^{11} + 8.532755 \\times 10^6]$$\n$$[8.2246703 \\times 10^{11} - 0.008532755 \\times 10^{11}, 8.2246703 \\times 10^{11} + 0.008532755 \\times 10^{11}]$$\n$$[8.2245849 \\times 10^{11}, 8.2247556 \\times 10^{11}]$$\nTo round a number to four significant figures, we check the fifth significant digit. The rounding threshold for the main term $8.2246... \\times 10^{11}$ to be rounded up to $8.225 \\times 10^{11}$ is $8.2245 \\times 10^{11}$.\nThe lower bound of our interval for $S(10^6)$ is $8.2245849 \\times 10^{11}$, which is greater than the rounding threshold. The upper bound is $8.2247556 \\times 10^{11}$. Since the entire possible range for the true value of $S(10^6)$ is above the rounding threshold of $8.2245 \\times 10^{11}$, any value in this range would be rounded up to $8.225 \\times 10^{11}$. Therefore, the rounding is justified by our explicit error bound.\n\nThe approximated value is $S(10^6) \\approx 8.225 \\times 10^{11}$.", "answer": "$$\\boxed{8.225 \\times 10^{11}}$$", "id": "3081695"}, {"introduction": "We now turn our attention to a different but equally important function, the divisor function $\\tau(n)$. This problem introduces a more advanced and powerful tool: the Dirichlet hyperbola method. By symmetrically partitioning the summation region, you will derive the celebrated asymptotic formula for $\\sum_{n \\le x} \\tau(n)$, including its constant term involving the Euler–Mascheroni constant $\\gamma$ [@problem_id:3081675].", "problem": "Let $\\tau(n)$ denote the number of positive divisors of $n$, and for real $t \\geq 1$ let $H_t := \\sum_{n \\leq t} \\frac{1}{n}$ denote the generalized harmonic sum. Consider the summatory function $S(x) := \\sum_{n \\leq x} \\tau(n)$ for real $x \\geq 1$. Starting from the foundational definition of $\\tau(n)$ and the double-counting interpretation of $S(x)$ as the number of integer pairs $(d,m)$ with $d m \\leq x$, derive an exact identity that expresses $S(x)$ in terms of a sum of floor functions. Then, by symmetrically splitting the resulting sum at $n = \\lfloor \\sqrt{x} \\rfloor$, approximate the main term using $x H_{\\lfloor \\sqrt{x} \\rfloor}$ and control the remainder using only elementary bounds. Assume the well-tested asymptotic expansion $H_t = \\ln(t) + \\gamma + O(1/t)$, where $\\gamma$ is the Euler–Mascheroni constant. Show that there is a constant $C$ such that\n$$\nS(x) = x \\ln(x) + C x + o(x),\n$$\nand determine the closed-form expression for $C$. Your final answer must be a single analytic expression. No rounding is required.", "solution": "The problem asks for a derivation of the asymptotic formula for the summatory function of the divisor function, $S(x) = \\sum_{n \\leq x} \\tau(n)$, and the determination of a specific constant in this formula. The derivation must follow a prescribed path involving a double-counting argument, a symmetric splitting of the sum, and asymptotic analysis.\n\nFirst, we establish an exact identity for $S(x)$. The divisor function $\\tau(n)$ is defined as the number of positive divisors of an integer $n$, which can be written as $\\tau(n) = \\sum_{d|n, d>0} 1$. Substituting this definition into the expression for $S(x)$ gives:\n$$\nS(x) = \\sum_{n=1}^{\\lfloor x \\rfloor} \\tau(n) = \\sum_{n=1}^{\\lfloor x \\rfloor} \\sum_{d|n} 1\n$$\nWe can interchange the order of summation. The sum is over pairs of positive integers $(n, d)$ such that $d$ divides $n$ and $n \\leq x$. This is equivalent to summing over pairs of positive integers $(d, m)$ such that $n = dm$ and $dm \\leq x$. Therefore, $S(x)$ is the number of integer lattice points $(d, m)$ in the first quadrant satisfying $dm \\leq x$.\n$$\nS(x) = \\sum_{d \\geq 1, m \\geq 1, dm \\leq x} 1\n$$\nTo express this as a sum of floor functions, we can sum over $d$ first. For a fixed positive integer $d$, the condition on $m$ is $m \\leq \\frac{x}{d}$. Since $m$ must be an integer, we have $1 \\leq m \\leq \\lfloor \\frac{x}{d} \\rfloor$. The largest possible value for $d$ is $\\lfloor x \\rfloor$, as for $d > x$, $\\lfloor \\frac{x}{d} \\rfloor = 0$. Thus, we obtain the exact identity:\n$$\nS(x) = \\sum_{d=1}^{\\lfloor x \\rfloor} \\sum_{m=1}^{\\lfloor x/d \\rfloor} 1 = \\sum_{d=1}^{\\lfloor x \\rfloor} \\lfloor \\frac{x}{d} \\rfloor\n$$\nNext, we apply the technique known as the Dirichlet hyperbola method, which corresponds to the \"symmetrically splitting\" instruction. The region of summation, $dm \\leq x$ with $d,m \\geq 1$, is symmetric with respect to the line $d=m$. This line intersects the boundary curve $dm=x$ at the point $(\\sqrt{x}, \\sqrt{x})$. Let $N = \\lfloor \\sqrt{x} \\rfloor$. We count the points in two overlapping rectangular regions and subtract the count of their intersection.\nThe first region is defined by $1 \\leq d \\leq N$. The number of points in this region is $\\sum_{d=1}^{N} \\lfloor \\frac{x}{d} \\rfloor$.\nThe second region is defined by $1 \\leq m \\leq N$. The number of points is $\\sum_{m=1}^{N} \\lfloor \\frac{x}{m} \\rfloor$.\nThe intersection of these two regions is the square defined by $1 \\leq d \\leq N$ and $1 \\leq m \\leq N$. The number of points in this square is $N \\times N = N^2$.\nBy the Principle of Inclusion-Exclusion, the total number of points is:\n$$\nS(x) = \\left( \\sum_{d=1}^{N} \\lfloor \\frac{x}{d} \\rfloor \\right) + \\left( \\sum_{m=1}^{N} \\lfloor \\frac{x}{m} \\rfloor \\right) - N^2 = 2 \\sum_{n=1}^{N} \\lfloor \\frac{x}{n} \\rfloor - N^2\n$$\nwhere we use $n$ as the dummy summation index.\n\nNow we perform the asymptotic analysis. We decompose the floor function as $\\lfloor z \\rfloor = z - \\{z\\}$, where $\\{z\\}$ is the fractional part of $z$, satisfying $0 \\leq \\{z\\} < 1$.\n$$\nS(x) = 2 \\sum_{n=1}^{N} \\left(\\frac{x}{n} - \\left\\{\\frac{x}{n}\\right\\}\\right) - N^2 = 2x \\sum_{n=1}^{N} \\frac{1}{n} - 2 \\sum_{n=1}^{N} \\left\\{\\frac{x}{n}\\right\\} - N^2\n$$\nThe first term involves the harmonic sum $H_N = \\sum_{n=1}^{N} \\frac{1}{n}$. So, the expression becomes:\n$$\nS(x) = 2x H_N - 2 \\sum_{n=1}^{N} \\left\\{\\frac{x}{n}\\right\\} - N^2\n$$\nLet's analyze the magnitude of each term.\nThe remainder sum is bounded: $0 \\leq \\sum_{n=1}^{N} \\{\\frac{x}{n}\\} < \\sum_{n=1}^{N} 1 = N$. Therefore, $2 \\sum_{n=1}^{N} \\{\\frac{x}{n}\\} = O(N) = O(\\sqrt{x})$.\nFor the term $N^2$, we have $N = \\lfloor\\sqrt{x}\\rfloor = \\sqrt{x} - \\{\\sqrt{x}\\}$.\n$$\nN^2 = (\\sqrt{x} - \\{\\sqrt{x}\\})^2 = x - 2\\sqrt{x}\\{\\sqrt{x}\\} + \\{\\sqrt{x}\\}^2\n$$\nSince $0 \\leq \\{\\sqrt{x}\\} < 1$, the term $-2\\sqrt{x}\\{\\sqrt{x}\\} + \\{\\sqrt{x}\\}^2$ is $O(\\sqrt{x})$. Thus, we can write $N^2 = x - O(\\sqrt{x})$, or equivalently $-N^2 = -x + O(\\sqrt{x})$.\nSubstituting these estimates back into the expression for $S(x)$:\n$$\nS(x) = 2x H_N - O(\\sqrt{x}) - (x - O(\\sqrt{x})) = 2x H_N - x + O(\\sqrt{x})\n$$\nThe problem provides the asymptotic expansion for the harmonic sum: $H_t = \\ln(t) + \\gamma + O(1/t)$, where $\\gamma$ is the Euler–Mascheroni constant. We apply this with $t = N = \\lfloor\\sqrt{x}\\rfloor$.\n$$\nH_N = \\ln(N) + \\gamma + O(1/N)\n$$\nWe need to relate $\\ln(N)$ to $\\ln(x)$.\n$$\n\\ln(N) = \\ln(\\lfloor\\sqrt{x}\\rfloor) = \\ln(\\sqrt{x} - \\{\\sqrt{x}\\}) = \\ln\\left(\\sqrt{x}\\left(1 - \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}}\\right)\\right)\n$$\n$$\n\\ln(N) = \\ln(\\sqrt{x}) + \\ln\\left(1 - \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}}\\right) = \\frac{1}{2}\\ln(x) + \\ln\\left(1 - \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}}\\right)\n$$\nUsing the Taylor expansion $\\ln(1-u) = -u - \\frac{u^2}{2} - \\dots$ for small $u$. Here $u = \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}} = O(1/\\sqrt{x})$.\n$$\n\\ln\\left(1 - \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}}\\right) = O\\left(\\frac{1}{\\sqrt{x}}\\right)\n$$\nSo, $\\ln(N) = \\frac{1}{2}\\ln(x) + O(1/\\sqrt{x})$. Since $1/N = O(1/\\sqrt{x})$, the approximation for $H_N$ becomes:\n$$\nH_N = \\left(\\frac{1}{2}\\ln(x) + O\\left(\\frac{1}{\\sqrt{x}}\\right)\\right) + \\gamma + O\\left(\\frac{1}{\\sqrt{x}}\\right) = \\frac{1}{2}\\ln(x) + \\gamma + O\\left(\\frac{1}{\\sqrt{x}}\\right)\n$$\nFinally, we substitute this into our expression for $S(x)$:\n$$\nS(x) = 2x \\left(\\frac{1}{2}\\ln(x) + \\gamma + O\\left(\\frac{1}{\\sqrt{x}}\\right)\\right) - x + O(\\sqrt{x})\n$$\n$$\nS(x) = x\\ln(x) + 2\\gamma x + 2x \\cdot O\\left(\\frac{1}{\\sqrt{x}}\\right) - x + O(\\sqrt{x})\n$$\nThe term $2x \\cdot O(1/\\sqrt{x})$ is $O(\\sqrt{x})$. Combining all error terms gives:\n$$\nS(x) = x\\ln(x) + (2\\gamma - 1)x + O(\\sqrt{x})\n$$\nWe are asked to show that $S(x) = x \\ln(x) + C x + o(x)$. An error term of $O(\\sqrt{x})$ is a function $f(x)$ for which there exists a constant $M$ such that $|f(x)| \\leq M\\sqrt{x}$ for sufficiently large $x$. Since $\\lim_{x\\to\\infty} \\frac{\\sqrt{x}}{x} = \\lim_{x\\to\\infty} \\frac{1}{\\sqrt{x}} = 0$, any function that is $O(\\sqrt{x})$ is also $o(x)$.\nTherefore, our derived asymptotic formula has the required form:\n$$\nS(x) = x \\ln(x) + (2\\gamma - 1) x + o(x)\n$$\nBy comparing this with $S(x) = x \\ln(x) + C x + o(x)$, we identify the constant $C$.\n$$\nC = 2\\gamma - 1\n$$\nThis is the closed-form expression for the constant $C$.", "answer": "$$\n\\boxed{2\\gamma - 1}\n$$", "id": "3081675"}]}