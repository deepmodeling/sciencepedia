{"hands_on_practices": [{"introduction": "The theory of Diophantine approximation can feel abstract, but its core ideas can be powerfully illustrated through computation. This first practice invites you to take on the role of a numerical explorer. By systematically searching for the best rational approximations to $\\alpha = \\sqrt{3}$, you will computationally rediscover a fundamental result: the most efficient rational approximations are none other than the convergents of the continued fraction [@problem_id:3083983]. This exercise solidifies the connection between brute-force search, the elegant structure of continued fractions, and the bounds guaranteed by Dirichlet's and Hurwitz's theorems.", "problem": "Let $\\alpha=\\sqrt{3}$ be an irrational real number. For integers $p$ and $q\\ge 1$, define the absolute linear form error $\\lvert q\\alpha - p\\rvert$ and the rational approximation error $\\lvert \\alpha - \\frac{p}{q}\\rvert$. The foundational base for this problem consists of the following widely accepted facts and definitions in number theory:\n- The nearest integer property: For fixed $q$, the integer $p$ minimizing $\\lvert q\\alpha - p\\rvert$ is the nearest integer to $q\\alpha$.\n- Continued fractions and convergents: The simple continued fraction expansion of a real number $\\alpha$ determines a sequence of convergents $\\frac{p_n}{q_n}$ given by recurrence relations that provide best rational approximations in a precise sense.\n- Dirichlet’s approximation theorem: For any real $\\alpha$ and any integer $N\\ge 1$, there exist integers $p$ and $q$ with $1\\le q\\le N$ such that $\\lvert q\\alpha - p\\rvert  \\frac{1}{N}$; furthermore, there are infinitely many fractions $\\frac{p}{q}$ with $\\lvert \\alpha - \\frac{p}{q}\\rvert  \\frac{1}{q^2}$.\n- Hurwitz’s theorem: For any irrational $\\alpha$, there exist infinitely many rationals $\\frac{p}{q}$ such that $\\lvert \\alpha - \\frac{p}{q}\\rvert  \\frac{1}{\\sqrt{5}\\,q^2}$. The constant $\\frac{1}{\\sqrt{5}}$ is best possible.\n\nYour task is to implement a complete program that:\n1. For each given bound $N$, searches all denominators $q$ with $1\\le q\\le N$ and, for each $q$, selects the integer $p$ that minimizes $\\lvert q\\alpha - p\\rvert$. Among all such pairs $\\left(p,q\\right)$ with $1\\le q\\le N$, identify the pair $\\left(p^\\ast,q^\\ast\\right)$ that minimizes $\\lvert q\\alpha - p\\rvert$, and record the minimum value $\\min_{1\\le q\\le N}\\min_{p\\in\\mathbb{Z}}\\lvert q\\alpha - p\\rvert$.\n2. Compute the simple continued fraction expansion of $\\alpha$ sufficiently far to generate all convergents $\\frac{p_n}{q_n}$ with $q_n\\le N$. Determine whether the best pair $\\left(p^\\ast,q^\\ast\\right)$ found by brute force is equal to one of these convergents. Also verify that the best convergent (the one among $\\frac{p_n}{q_n}$ with $q_n\\le N$ minimizing $\\lvert q_n\\alpha - p_n\\rvert$) matches the brute-force best.\n3. Verify Dirichlet’s bound by checking whether $\\min_{1\\le q\\le N}\\min_{p\\in\\mathbb{Z}}\\lvert q\\alpha - p\\rvert  \\frac{1}{N}$.\n4. Verify Hurwitz’s bound for the best pair $\\left(p^\\ast,q^\\ast\\right)$ by checking whether $\\left\\lvert \\alpha - \\frac{p^\\ast}{q^\\ast}\\right\\rvert  \\frac{1}{\\sqrt{5}\\,(q^\\ast)^2}$.\n\nUse only pure mathematical quantities; no physical units are involved. All angles, if any, are to be assumed dimensionless. The program must compute the above for a fixed $\\alpha=\\sqrt{3}$.\n\nTest Suite:\n- Case A: $N=1$ (boundary small)\n- Case B: $N=10^2$\n- Case C: $N=10^3$\n- Case D: $N=10^5$ (computational large)\n\nFor each test case, the program must output a list of the form $[q^\\ast, p^\\ast, \\text{min\\_abs}, \\text{is\\_convergent}, \\text{dirichlet\\_ok}, \\text{hurwitz\\_ok}]$, where:\n- $q^\\ast$ and $p^\\ast$ are integers,\n- $\\text{min\\_abs}$ is a floating-point number representing $\\min_{1\\le q\\le N}\\min_{p\\in\\mathbb{Z}}\\lvert q\\alpha - p\\rvert$,\n- $\\text{is\\_convergent}$ is a boolean indicating whether $\\left(p^\\ast,q^\\ast\\right)$ is a continued fraction convergent of $\\alpha$,\n- $\\text{dirichlet\\_ok}$ is a boolean indicating whether $\\text{min\\_abs}\\frac{1}{N}$,\n- $\\text{hurwitz\\_ok}$ is a boolean indicating whether $\\left\\lvert \\alpha - \\frac{p^\\ast}{q^\\ast}\\right\\rvert  \\frac{1}{\\sqrt{5}\\,(q^\\ast)^2}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results for the four test cases as a comma-separated list enclosed in square brackets, with each test case result itself being a list in the above format. For example: $[[\\cdots],[\\cdots],[\\cdots],[\\cdots]]$ and with no extra spaces required.", "solution": "The problem requires a computational analysis of Diophantine approximation for the irrational number $\\alpha = \\sqrt{3}$. For specified upper bounds $N$ on the denominator $q$, we are tasked with several objectives: finding the best rational approximation via a brute-force search, comparing this result with the theory of continued fractions, and verifying two fundamental theorems of approximation theory, namely those of Dirichlet and Hurwitz.\n\nThe solution is implemented by analyzing each test case, characterized by a bound $N$, through a series of computational and verification steps. We use high-precision floating-point arithmetic to handle the irrational number $\\alpha$. The overall procedure for a single test case with a given bound $N$ is as follows.\n\n**Step 1: Brute-Force Minimization of the Linear Form Error**\n\nThe first task is to find the integer pair $(p^\\ast, q^\\ast)$ with $1 \\le q^\\ast \\le N$ that minimizes the absolute linear form error, defined as $\\lvert q\\alpha - p\\rvert$. For any given integer denominator $q \\ge 1$, the integer $p$ that minimizes this error is the one closest to the value $q\\alpha$. This is known as the nearest integer to $q\\alpha$, which can be computed as $p = \\text{round}(q\\alpha)$.\n\nWe iterate through all possible denominators $q$ from $1$ to $N$. For each $q$, we determine the optimal $p$ and calculate the corresponding error $\\epsilon_q = \\lvert q\\alpha - \\text{round}(q\\alpha)\\rvert$. We maintain a record of the minimum error found so far, $\\epsilon_{min}$, and the pair $(p^\\ast, q^\\ast)$ that produced it.\n\n$$ \\epsilon_{min} = \\min_{1 \\le q \\le N} \\min_{p \\in \\mathbb{Z}} \\lvert q\\alpha - p \\rvert = \\min_{1 \\le q \\le N} \\lvert q\\alpha - \\text{round}(q\\alpha) \\rvert $$\n\nThe final values of $p^\\ast$, $q^\\ast$, and $\\epsilon_{min}$ (denoted as `min_abs` in the output) are recorded.\n\n**Step 2: Verification against Continued Fraction Convergents**\n\nThe theory of continued fractions provides a powerful method for finding the best rational approximations of a number. A key result, Lagrange's approximation theorem, states that the set of \"best approximations of the second kind\" (fractions $p/q$ for which $\\lvert q\\alpha - p \\rvert  \\lvert q'\\alpha - p' \\rvert$ for all $1 \\le q'  q$) is precisely the set of principal convergents of $\\alpha$. The pair $(p^\\ast, q^\\ast)$ found in Step 1, which represents the global minimum over the range $1 \\le q \\le N$, must therefore be one of these convergents.\n\nTo verify this, we first generate the sequence of convergents $\\frac{p_n}{q_n}$ for $\\alpha = \\sqrt{3}$. The simple continued fraction expansion of $\\sqrt{3}$ is periodic: $\\sqrt{3} = [1; \\overline{1, 2}]$. The coefficients are $a_0 = 1$, and for $n \\ge 1$, $a_n=1$ if $n$ is odd, and $a_n=2$ if $n$ is even. The convergents $p_n/q_n$ are generated using the standard recurrence relations:\n$$ p_n = a_n p_{n-1} + p_{n-2} $$\n$$ q_n = a_n q_{n-1} + q_{n-2} $$\nwith initial conditions $p_{-1}=1, q_{-1}=0$ and $p_0=a_0=1, q_0=1$.\n\nWe generate all convergents $(p_n, q_n)$ for which $q_n \\le N$ and store them. We then check if the pair $(p^\\ast, q^\\ast)$ from Step 1 is present in this set of convergents. This verification yields the boolean value `is_convergent`, which, according to theory, must be true.\n\n**Step 3: Verification of Dirichlet's Approximation Theorem**\n\nDirichlet's theorem on Diophantine approximation states that for any real number $\\alpha$ and any integer $N \\ge 1$, there exist integers $p$ and $q$ with $1 \\le q \\le N$ such that $\\lvert q\\alpha - p \\rvert  \\frac{1}{N}$.\n\nThe value $\\epsilon_{min} = \\lvert q^\\ast\\alpha - p^\\ast \\rvert$ found in Step 1 is the minimum possible error for any $q$ in the range $1 \\le q \\le N$. Since Dirichlet's theorem guarantees the existence of at least one pair $(p,q)$ satisfying the inequality, the minimum error over all such pairs must also satisfy it. Therefore, we verify the condition:\n$$ \\epsilon_{min}  \\frac{1}{N} $$\nThis check produces the boolean value `dirichlet_ok`, which is expected to be true for all $N \\ge 1$.\n\n**Step 4: Verification of Hurwitz's Theorem Bound**\n\nHurwitz's theorem states that for any irrational number $\\alpha$, there exist infinitely many rational numbers $\\frac{p}{q}$ such that the rational approximation error satisfies:\n$$ \\left\\lvert \\alpha - \\frac{p}{q} \\right\\rvert  \\frac{1}{\\sqrt{5}\\,q^2} $$\nThis theorem guarantees an infinite number of such approximations but does not guarantee that every best approximation (or every convergent) satisfies this specific bound. For the best approximation pair $(p^\\ast, q^\\ast)$ found in Step 1, we explicitly check if this inequality holds.\n\nThe rational approximation error for this pair is $\\left\\lvert \\alpha - \\frac{p^\\ast}{q^\\ast} \\right\\rvert = \\frac{\\lvert q^\\ast\\alpha - p^\\ast \\rvert}{q^\\ast} = \\frac{\\epsilon_{min}}{q^\\ast}$. The verification is thus:\n$$ \\frac{\\epsilon_{min}}{q^\\ast}  \\frac{1}{\\sqrt{5}\\,(q^\\ast)^2} $$\nThis produces the boolean value `hurwitz_ok`. Unlike the previous checks, this result is not guaranteed to be true for every $N$.\n\nThe complete program implements these four steps for each value of $N$ in the test suite and formats the results as specified.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for the specified test cases and print the results.\n    \"\"\"\n\n    def get_cf_coeff_sqrt3(n):\n        \"\"\"\n        Returns the n-th coefficient (a_n) of the simple continued fraction of sqrt(3),\n        which is [1; 1, 2, 1, 2, ...].\n        \"\"\"\n        if n == 0:\n            return 1\n        return 1 if n % 2 != 0 else 2\n\n    def get_convergents_up_to_n(N_max):\n        \"\"\"\n        Generates convergents p_n/q_n for sqrt(3) until q_n  N_max.\n        Returns a set of (p, q) tuples for efficient lookup.\n        \"\"\"\n        convergents = set()\n        n = 0\n        p_prev, q_prev = 1, 0\n        a_n = get_cf_coeff_sqrt3(n)\n        p_curr, q_curr = a_n, 1\n        \n        while q_curr = N_max:\n            convergents.add((p_curr, q_curr))\n            \n            n += 1\n            a_n = get_cf_coeff_sqrt3(n)\n            \n            p_next = a_n * p_curr + p_prev\n            q_next = a_n * q_curr + q_prev\n            \n            p_prev, q_prev = p_curr, q_curr\n            p_curr, q_curr = p_next, q_next\n            \n        return convergents\n\n    def analyze_approximation(N):\n        \"\"\"\n        Performs the full Diophantine approximation analysis for a given denominator bound N.\n        \n        Returns:\n            A list containing [q*, p*, min_abs, is_convergent, dirichlet_ok, hurwitz_ok].\n        \"\"\"\n        alpha = np.sqrt(3)\n\n        # Task 1: Brute-force search for the best rational approximation.\n        min_abs_linear_error = np.inf\n        p_star, q_star = -1, -1\n\n        for q in range(1, N + 1):\n            p = int(round(q * alpha))\n            current_error = abs(q * alpha - p)\n\n            if current_error  min_abs_linear_error:\n                min_abs_linear_error = current_error\n                p_star = p\n                q_star = q\n\n        # Task 2: Compare with continued fraction convergents.\n        convergents = get_convergents_up_to_n(N)\n        is_convergent = (p_star, q_star) in convergents\n\n        # Task 3: Verify Dirichlet's approximation theorem bound.\n        dirichlet_bound = 1.0 / N\n        dirichlet_ok = min_abs_linear_error  dirichlet_bound\n\n        # Task 4: Verify Hurwitz's theorem bound for the best pair (p*, q*).\n        rational_approx_error = min_abs_linear_error / q_star\n        hurwitz_bound = 1.0 / (np.sqrt(5) * q_star**2)\n        hurwitz_ok = rational_approx_error  hurwitz_bound\n\n        return [q_star, p_star, min_abs_linear_error, is_convergent, dirichlet_ok, hurwitz_ok]\n\n    # Define the test cases from the problem statement.\n    test_cases = [1, 10**2, 10**3, 10**5]\n\n    results = []\n    for N_val in test_cases:\n        results.append(analyze_approximation(N_val))\n\n    # Format the results into the required single-line string.\n    def format_result(res):\n        q, p, err, is_c, is_d, is_h = res\n        return f\"[{q},{p},{err},{str(is_c).lower()},{str(is_d).lower()},{str(is_h).lower()}]\"\n\n    final_output_str = f\"[{','.join([format_result(r) for r in results])}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_str)\n\nsolve()\n```", "id": "3083983"}, {"introduction": "Building on the discovery that best approximations are convergents, we now turn to a more rigorous test. Legendre's criterion provides a powerful, one-way test: if a rational fraction $p/q$ is a \"sufficiently good\" approximation to an irrational $\\alpha$, satisfying $|\\alpha - p/q| \\lt 1/(2q^2)$, then it *must* be a convergent. This exercise challenges you to computationally verify this profound statement [@problem_id:3084028]. By implementing an algorithm to find all such good approximations and checking them against the list of convergents, you will not only gain confidence in the theorem but also appreciate the practical challenges of numerical precision in number theory.", "problem": "Let $\\alpha \\in \\mathbb{R}$ be irrational. A continued fraction of $\\alpha$ is the expression\n$$\n\\alpha = a_0 + \\cfrac{1}{a_1 + \\cfrac{1}{a_2 + \\cdots}},\n$$\nwhere $a_0 \\in \\mathbb{Z}$ and $a_k \\in \\mathbb{Z}_{\\ge 1}$ for $k \\ge 1$. The $n$-th convergent of $\\alpha$ is the rational number $p_n/q_n$ obtained by truncating the continued fraction after $a_n$. The convergents satisfy the recurrence\n$$\np_{-2} = 0,\\quad p_{-1} = 1,\\quad p_n = a_n p_{n-1} + p_{n-2},\\quad n \\ge 0,\n$$\n$$\nq_{-2} = 1,\\quad q_{-1} = 0,\\quad q_n = a_n q_{n-1} + q_{n-2},\\quad n \\ge 0.\n$$\nClassical results such as Dirichlet’s approximation theorem and Hurwitz’s theorem on Diophantine approximation guarantee the existence of infinitely many rational approximations $p/q$ to any irrational $\\alpha$ with small error $|\\alpha - p/q|$. A refinement known as Legendre’s criterion asserts that sufficiently good rational approximations arise from convergents of the continued fraction.\n\nYour task is to write a complete, runnable program that, for a set of given irrational numbers $\\alpha$, verifies computationally the following property: every rational $p/q$ (with integer $p$ and positive integer $q$) that satisfies the strict inequality\n$$\n\\left|\\alpha - \\frac{p}{q}\\right|  \\frac{1}{2 q^2}\n$$\nis a convergent of the continued fraction of $\\alpha$. For each $\\alpha$, you must:\n- Compute its continued fraction partial quotients and convergents until the denominator $q$ of the convergent exceeds a specified bound $Q_{\\max}$.\n- For every integer $q$ with $1 \\le q \\le Q_{\\max}$, check a small neighborhood of the nearest integers to $\\alpha q$ to find all rationals $p/q$ that satisfy the strict inequality $|\\alpha - p/q|  1/(2 q^2)$.\n- Verify that each such $p/q$ is indeed among the convergents computed up to the bound.\n\nUse only the definitions above as the foundation of your computation; do not rely on any shortcut formulas beyond these definitions.\n\nTest Suite:\nFor each case below, use the given $\\alpha$ and $Q_{\\max}$, and produce a boolean indicating whether, within the search $1 \\le q \\le Q_{\\max}$, all rationals $p/q$ satisfying the strict inequality are convergents.\n\n- Case 1 (happy path, many qualifying approximations): $\\alpha_1 = \\sqrt{2}$, $Q_{\\max} = 300$.\n- Case 2 (edge case with eventually failing bound for large denominators): $\\alpha_2 = \\dfrac{1+\\sqrt{5}}{2}$, $Q_{\\max} = 300$.\n- Case 3 (another quadratic irrational with mixed partial quotients): $\\alpha_3 = \\sqrt{3}$, $Q_{\\max} = 300$.\n- Case 4 (random-looking irrational constructed as a rational shift of a quadratic irrational): $\\alpha_4 = \\sqrt{2} + r$, where $r = 0.2718281828459045235$, $Q_{\\max} = 300$. Note that $\\sqrt{2}$ is irrational, $r$ is rational, and therefore $\\alpha_4$ is irrational.\n\nFinal Output Format:\nYour program should produce a single line of output containing the four boolean results for the cases above, as a comma-separated list enclosed in square brackets (e.g., `[result1,result2,result3,result4]`). No physical units or angles are involved. The only acceptable output types are booleans as specified.", "solution": "The problem requires a computational verification of a property related to Legendre's criterion in Diophantine approximation for a given set of irrational numbers $\\alpha$ and a maximum denominator bound $Q_{\\max}$. The property states that any rational number $p/q$, with $p \\in \\mathbb{Z}$ and $q \\in \\mathbb{Z}_{0}$, that satisfies the strict inequality $|\\alpha - p/q|  1/(2q^2)$ must be a convergent of the continued fraction of $\\alpha$. My approach will be to implement a procedure that systematically checks this property for all denominators $q$ up to $Q_{\\max}$. This involves three main steps: generating the convergents of $\\alpha$, identifying all \"good\" rational approximations satisfying the given inequality, and finally, verifying that the set of the latter is a subset of the former.\n\n**Step 1: Generation of Continued Fraction Convergents**\n\nThe first step is to compute the sequence of partial quotients $a_0, a_1, a_2, \\ldots$ and the corresponding convergents $p_n/q_n$ for a given irrational number $\\alpha$. The partial quotients are generated by the standard continued fraction algorithm. We initialize $\\xi_0 = \\alpha$. Then, for $n = 0, 1, 2, \\ldots$, we compute:\n$$\na_n = \\lfloor \\xi_n \\rfloor\n$$\n$$\n\\xi_{n+1} = \\frac{1}{\\xi_n - a_n}\n$$\nThis process continues as long as the remainder $\\xi_n - a_n$ is non-zero, which is always the case for an irrational $\\alpha$.\n\nThe convergents $p_n/q_n$ are calculated using the provided recurrence relations with the initial values $p_{-2} = 0$, $p_{-1} = 1$, $q_{-2} = 1$, and $q_{-1} = 0$. For $n \\ge 0$, the recurrences are:\n$$\np_n = a_n p_{n-1} + p_{n-2}\n$$\n$$\nq_n = a_n q_{n-1} + q_{n-2}\n$$\nWe generate these convergents $(p_n, q_n)$ sequentially, collecting them into a set for efficient lookup. The process is terminated once the denominator $q_n$ exceeds the specified bound $Q_{\\max}$, as any further convergents will have denominators larger than the search space defined by the problem.\n\n**Step 2: Identification of \"Good\" Rational Approximations**\n\nThe second step is to find all rational numbers $p/q$ that satisfy the strict inequality:\n$$\n\\left|\\alpha - \\frac{p}{q}\\right|  \\frac{1}{2q^2}\n$$\nThe search is conducted for all integer denominators $q$ in the range $1 \\le q \\le Q_{\\max}$. For a fixed $q$, we need to find all integers $p$ that satisfy the condition. A brute-force search for $p$ is unnecessary. The inequality can be rearranged to be more revealing and numerically stable:\n$$\n\\left|\\alpha q - p\\right|  \\frac{1}{2q}\n$$\nThis shows that $p$ must be an integer lying in the open interval $(\\alpha q - 1/(2q), \\alpha q + 1/(2q))$. The length of this interval is $1/q$. For any $q \\ge 1$, this interval can contain at most one integer. This unique integer candidate for $p$ is the integer closest to the real number $\\alpha q$. This can be computed as $p = \\text{round}(\\alpha q)$.\n\nThus, the search algorithm is as follows: for each $q$ from $1$ to $Q_{\\max}$, we compute the unique candidate $p = \\text{round}(\\alpha q)$ and then test if this pair $(p, q)$ satisfies the inequality. To avoid potential floating-point precision issues with the expression $|\\alpha - p/q|$, we use the more stable form $|\\alpha q - p|  1/(2q)$. All pairs $(p, q)$ that satisfy this condition are collected into a set of \"good\" approximations. It is a known consequence of the theorem itself that any such fraction $p/q$ must be irreducible, so no explicit check for the greatest common divisor is necessary.\n\n**Step 3: Verification and Numerical Considerations**\n\nThe final step is to verify the property. According to Legendre's criterion, every \"good\" approximation found in Step 2 must be one of the convergents generated in Step 1. This is algorithmically equivalent to checking if the set of good approximations is a subset of the set of convergents. If this condition holds true for all tested denominators up to $Q_{\\max}$, the verification for the given $\\alpha$ is successful. Since Legendre's criterion is a proven theorem, a correct implementation is expected to return `True` for all test cases.\n\nA critical aspect of the implementation is handling numerical precision. For the first three test cases ($\\alpha_1 = \\sqrt{2}$, $\\alpha_2 = (1+\\sqrt{5})/2$, $\\alpha_3 = \\sqrt{3}$), the standard `numpy.float64` floating-point type provides sufficient precision given that $Q_{\\max}=300$. However, the fourth case, $\\alpha_4 = \\sqrt{2} + r$ with $r = 0.2718281828459045235$, requires special attention. The rational number $r$ is given with $20$ decimal places. A standard `float64` can only store about $15$ to $17$ significant decimal digits, and would thus truncate the value of $r$, leading to an incorrect $\\alpha_4$. To perform the calculation correctly, it is essential to use a high-precision arithmetic library. Python's standard `decimal` module is perfectly suited for this. By setting a sufficiently high precision (e.g., $100$ digits), we can represent $\\alpha_4$ and perform all related calculations without loss of accuracy, ensuring a valid verification. My implementation uses a type-dispatch mechanism to transparently handle both standard floats and `Decimal` objects.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom decimal import Decimal, getcontext, ROUND_HALF_EVEN\n\ndef solve():\n    \"\"\"\n    Main function to run the verification for all test cases and print the results.\n    \"\"\"\n    # Set precision for Decimal calculations. This is high enough for the given problem.\n    getcontext().prec = 100\n\n    def verify_legendre(alpha, Q_max):\n        \"\"\"\n        Verifies Legendre's criterion for a given number alpha up to a denominator Q_max.\n\n        Args:\n            alpha (float or Decimal): The irrational number to test.\n            Q_max (int): The maximum denominator to check.\n\n        Returns:\n            bool: True if all good approximations are convergents, False otherwise.\n        \"\"\"\n        is_decimal = isinstance(alpha, Decimal)\n        \n        # Define type-dependent constants and functions for numerical operations.\n        if is_decimal:\n            one, two = Decimal(1), Decimal(2)\n            floor = lambda x: x.to_integral_value(rounding='ROUND_FLOOR')\n            round_f = lambda x: int(x.to_integral_value(rounding=ROUND_HALF_EVEN))\n            abs_f = abs\n            epsilon = Decimal('1e-95')\n        else:  # numpy.float64\n            one, two = 1.0, 2.0\n            floor = np.floor\n            round_f = lambda x: int(np.round(x))\n            abs_f = np.abs\n            # Epsilon for float is based on machine precision.\n            epsilon = 1e-14\n\n        # Step 1: Compute convergents of the continued fraction of alpha.\n        convergents = set()\n        p_prev2, p_prev1 = 0, 1\n        q_prev2, q_prev1 = 1, 0\n        \n        xi = alpha\n        \n        while True:\n            # Safety break for runaway calculations due to precision limits.\n            if is_decimal and xi  Decimal(10)**(getcontext().prec - 5): break\n            if not is_decimal and xi  1e15: break\n\n            a = int(floor(xi))\n            p_curr = a * p_prev1 + p_prev2\n            q_curr = a * q_prev1 + q_prev2\n\n            if q_curr  Q_max:\n                break\n            \n            if q_curr  0:\n                convergents.add((p_curr, q_curr))\n            \n            p_prev2, p_prev1 = p_prev1, p_curr\n            q_prev2, q_prev1 = q_prev1, q_curr\n            \n            remainder = xi - a\n            if abs_f(remainder)  epsilon: # Handles case where alpha is rational or precision is lost\n                break\n            xi = one / remainder\n\n        # Step 2: Find all rational approximations p/q satisfying the strict inequality.\n        good_approximations = set()\n        for q in range(1, Q_max + 1):\n            if is_decimal:\n                q_dec = Decimal(q)\n                p = round_f(alpha * q_dec)\n                # Numerically stable check: |alpha*q - p|  1/(2q)\n                # which is equivalent to 2*q * |alpha*q - p|  1\n                if abs_f(alpha * q_dec - Decimal(p)) * two * q_dec  one:\n                    good_approximations.add((p, q))\n            else:  # float\n                p = round_f(alpha * q)\n                if abs_f(alpha * q - p) * two * q  one:\n                    good_approximations.add((p, q))\n        \n        # Step 3: Verify that the set of good approximations is a subset of the set of convergents.\n        return good_approximations.issubset(convergents)\n\n    # Define the test cases from the problem statement.\n    Q_max = 300\n    \n    # Case 1: sqrt(2)\n    alpha1 = np.sqrt(2.0)\n    \n    # Case 2: Golden ratio phi\n    alpha2 = (1.0 + np.sqrt(5.0)) / 2.0\n    \n    # Case 3: sqrt(3)\n    alpha3 = np.sqrt(3.0)\n    \n    # Case 4: sqrt(2) + r, using high-precision Decimal\n    r_str = \"0.2718281828459045235\"\n    alpha4 = Decimal(2).sqrt() + Decimal(r_str)\n    \n    test_params = [\n        (alpha1, Q_max), \n        (alpha2, Q_max), \n        (alpha3, Q_max), \n        (alpha4, Q_max)\n    ]\n\n    results = []\n    for alpha, q_max_val in test_params:\n        result = verify_legendre(alpha, q_max_val)\n        results.append(str(result).lower())\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3084028"}, {"introduction": "Hurwitz's theorem states that for any irrational $\\alpha$, there are infinitely many rational approximations $p/q$ such that $|\\alpha - p/q| \\lt 1/(\\sqrt{5}q^2)$. But where does the constant $\\sqrt{5}$ come from, and why is it optimal? This final practice delves into this fundamental question by examining the approximation properties of the golden ratio, $\\varphi = (1+\\sqrt{5})/2$ [@problem_id:3084017]. Through a combination of numerical calculation and analytical derivation, you will see that the quality of approximation for $\\varphi$, measured by $q^2|\\varphi - p/q|$, converges to exactly $1/\\sqrt{5}$, demonstrating that for this \"worst-case\" number, the bound cannot be improved.", "problem": "Let $\\varphi$ denote the golden ratio $\\varphi = \\frac{1+\\sqrt{5}}{2}$. Consider the simple continued fraction expansion of $\\varphi$, and let $\\frac{p_{n}}{q_{n}}$ denote its $n$-th convergent, with $n \\geq 1$. It is known that the convergents of $\\varphi$ are ratios of consecutive Fibonacci numbers. Using only fundamental definitions of simple continued fractions and convergents, the recurrence relations for the Fibonacci numbers, and the Binet formula for the Fibonacci numbers $F_{n} = \\frac{\\varphi^{n} - \\psi^{n}}{\\sqrt{5}}$ with $\\psi = \\frac{1-\\sqrt{5}}{2}$, do the following:\n\n1) Compute numerically, to $4$ significant figures, the values of $q_{n}^{2}\\,|\\varphi - p_{n}/q_{n}|$ for $n = 1, 2, 3, 4$, and comment on whether these values lie above or below the constant $\\frac{1}{\\sqrt{5}}$.\n\n2) Derive a closed-form expression for $q_{n}^{2}\\,|\\varphi - p_{n}/q_{n}|$ in terms of $n$ and $\\varphi$ only, by starting from the definitions and the Binet formula.\n\n3) Using your expression from part $2)$, determine the exact value of $\\lim_{n \\to \\infty} q_{n}^{2}\\,|\\varphi - p_{n}/q_{n}|$ and briefly interpret this limit in the context of the optimal constant in Hurwitz’s theorem on Diophantine approximation.\n\nGive your final answer as the exact value of the limit in part $3)$. No units are required, and no rounding is needed for the final answer.", "solution": "The problem is valid as it is mathematically sound, self-contained, and well-posed within the domain of number theory. We will proceed with a full solution.\n\nThe golden ratio is $\\varphi = \\frac{1+\\sqrt{5}}{2}$. Its simple continued fraction is $[1; 1, 1, 1, \\dots]$. The convergents $\\frac{p_n}{q_n}$ are ratios of consecutive Fibonacci numbers. The Fibonacci sequence is defined by $F_0=0, F_1=1$, and $F_{k} = F_{k-1} + F_{k-2}$ for $k \\ge 2$. The first few terms are $0, 1, 1, 2, 3, 5, 8, 13, \\dots$.\n\nThe convergents of $[a_0; a_1, a_2, \\dots]$ are given by the recurrence relations $p_k = a_k p_{k-1} + p_{k-2}$ and $q_k = a_k q_{k-1} + q_{k-2}$, with initial values $p_{-1}=1, q_{-1}=0, p_0=a_0, q_0=1$. For $\\varphi$, we have $a_k=1$ for all $k \\ge 0$.\nFor $n=0$: $p_0/q_0 = 1/1 = F_2/F_1$.\nFor $n=1$: $p_1/q_1 = (1 \\cdot 1 + 1)/(1 \\cdot 1 + 0) = 2/1 = F_3/F_2$.\nFor $n=2$: $p_2/q_2 = (1 \\cdot 2 + 1)/(1 \\cdot 1 + 1) = 3/2 = F_4/F_3$.\nBy induction, the $n$-th convergent (for $n \\ge 1$ as specified in the problem) is $\\frac{p_n}{q_n} = \\frac{F_{n+2}}{F_{n+1}}$. Thus, we identify $p_n = F_{n+2}$ and $q_n = F_{n+1}$.\n\nThe Binet formula for the $k$-th Fibonacci number is $F_k = \\frac{\\varphi^k - \\psi^k}{\\sqrt{5}}$, where $\\psi = \\frac{1-\\sqrt{5}}{2}$. The numbers $\\varphi$ and $\\psi$ are the roots of the quadratic equation $x^2 - x - 1 = 0$, which implies $\\varphi^2 = \\varphi+1$, $\\psi^2 = \\psi+1$, $\\varphi+\\psi=1$, and $\\varphi\\psi=-1$.\n\n**1) Numerical Computation**\n\nWe compute $q_n^2 \\, |\\varphi - p_n/q_n|$ for $n=1, 2, 3, 4$. We will use the numerical values $\\varphi \\approx 1.618034$ and $\\frac{1}{\\sqrt{5}} \\approx 0.447214$.\n\nFor $n=1$:\n$q_1 = F_2 = 1$, $p_1 = F_3=2$.\n$q_1^2 \\, |\\varphi - p_1/q_1| = 1^2 |\\varphi - 2/1| = |1.618034 - 2| = |-0.381966| \\approx 0.3820$.\nThis value is below $\\frac{1}{\\sqrt{5}}$.\n\nFor $n=2$:\n$q_2 = F_3 = 2$, $p_2 = F_4=3$.\n$q_2^2 \\, |\\varphi - p_2/q_2| = 2^2 |\\varphi - 3/2| = 4|1.618034 - 1.5| = 4(0.118034) \\approx 0.4721$.\nThis value is above $\\frac{1}{\\sqrt{5}}$.\n\nFor $n=3$:\n$q_3 = F_4 = 3$, $p_3 = F_5=5$.\n$q_3^2 \\, |\\varphi - p_3/q_3| = 3^2 |\\varphi - 5/3| = 9|1.618034 - 1.666667| = 9|-0.048633| \\approx 0.4377$.\nThis value is below $\\frac{1}{\\sqrt{5}}$.\n\nFor $n=4$:\n$q_4 = F_5 = 5$, $p_4 = F_6=8$.\n$q_4^2 \\, |\\varphi - p_4/q_4| = 5^2 |\\varphi - 8/5| = 25|1.618034 - 1.6| = 25(0.018034) \\approx 0.4508$.\nThis value is above $\\frac{1}{\\sqrt{5}}$.\n\nThe values of $q_n^2 \\, |\\varphi - p_n/q_n|$ are observed to alternate between being below and above the constant $\\frac{1}{\\sqrt{5}}$. This is consistent with the theory of continued fractions, which states that the convergents are alternately smaller and larger than the irrational number they approximate.\n\n**2) Closed-Form Expression**\n\nWe want to find a closed-form expression for $E_n = q_n^2 \\, |\\varphi - p_n/q_n|$. We start by substituting $p_n=F_{n+2}$ and $q_n=F_{n+1}$:\n$$E_n = F_{n+1}^2 \\left|\\varphi - \\frac{F_{n+2}}{F_{n+1}}\\right| = F_{n+1}^2 \\frac{|\\varphi F_{n+1} - F_{n+2}|}{|F_{n+1}|} = |F_{n+1}(\\varphi F_{n+1} - F_{n+2})|$$\nsince $F_{n+1}  0$ for $n \\ge 1$.\n\nLet's analyze the term $\\varphi F_{n+1} - F_{n+2}$ using the Binet formula:\n$$\\varphi F_{n+1} - F_{n+2} = \\varphi \\left(\\frac{\\varphi^{n+1} - \\psi^{n+1}}{\\sqrt{5}}\\right) - \\left(\\frac{\\varphi^{n+2} - \\psi^{n+2}}{\\sqrt{5}}\\right)$$\n$$= \\frac{1}{\\sqrt{5}} \\left( \\varphi^{n+2} - \\varphi\\psi^{n+1} - \\varphi^{n+2} + \\psi^{n+2} \\right) = \\frac{1}{\\sqrt{5}} \\left( \\psi^{n+2} - \\varphi\\psi^{n+1} \\right)$$\nFactoring out $\\psi^{n+1}$:\n$$= \\frac{\\psi^{n+1}}{\\sqrt{5}} (\\psi - \\varphi)$$\nSince $\\varphi - \\psi = \\frac{1+\\sqrt{5}}{2} - \\frac{1-\\sqrt{5}}{2} = \\sqrt{5}$, we have $\\psi - \\varphi = -\\sqrt{5}$.\nSo, $\\varphi F_{n+1} - F_{n+2} = \\frac{\\psi^{n+1}}{\\sqrt{5}}(-\\sqrt{5}) = -\\psi^{n+1}$.\n\nNow substitute this back into the expression for $E_n$:\n$$E_n = |F_{n+1}(-\\psi^{n+1})| = F_{n+1} |\\psi^{n+1}|$$\nWe use Binet's formula for $F_{n+1}$ again:\n$$E_n = \\left(\\frac{\\varphi^{n+1} - \\psi^{n+1}}{\\sqrt{5}}\\right) |\\psi|^{n+1}$$\nNote that $\\psi = -1/\\varphi$, so $|\\psi| = 1/\\varphi$. The expression becomes:\n$$E_n = \\left(\\frac{\\varphi^{n+1} - \\psi^{n+1}}{\\sqrt{5}}\\right) \\left(\\frac{1}{\\varphi}\\right)^{n+1} = \\frac{1}{\\sqrt{5}} \\left(1 - \\frac{\\psi^{n+1}}{\\varphi^{n+1}}\\right) = \\frac{1}{\\sqrt{5}} \\left(1 - \\left(\\frac{\\psi}{\\varphi}\\right)^{n+1}\\right)$$\nFinally, substitute $\\psi/\\varphi = (-1/\\varphi)/\\varphi = -1/\\varphi^2$:\n$$E_n = \\frac{1}{\\sqrt{5}} \\left(1 - \\left(-\\frac{1}{\\varphi^2}\\right)^{n+1}\\right) = \\frac{1}{\\sqrt{5}} \\left(1 - \\frac{(-1)^{n+1}}{\\varphi^{2(n+1)}}\\right)$$\nThis is the closed-form expression for $q_n^2 \\, |\\varphi - p_n/q_n|$ in terms of $n$ and $\\varphi$.\n\n**3) Limit and Interpretation**\n\nWe now compute the limit of the expression derived in part $2$) as $n \\to \\infty$:\n$$\\lim_{n \\to \\infty} q_n^2 \\, |\\varphi - p_n/q_n| = \\lim_{n \\to \\infty} \\frac{1}{\\sqrt{5}} \\left(1 - \\frac{(-1)^{n+1}}{\\varphi^{2n+2}}\\right)$$\nSince $\\varphi = \\frac{1+\\sqrt{5}}{2} \\approx 1.618  1$, we have $|\\varphi|1$. As $n \\to \\infty$, the denominator $\\varphi^{2n+2} \\to \\infty$. Therefore, the term $\\frac{(-1)^{n+1}}{\\varphi^{2n+2}}$ approaches $0$:\n$$\\lim_{n \\to \\infty} \\frac{(-1)^{n+1}}{\\varphi^{2n+2}} = 0$$\nThe limit is thus:\n$$\\lim_{n \\to \\infty} q_n^2 \\, |\\varphi - p_n/q_n| = \\frac{1}{\\sqrt{5}} (1 - 0) = \\frac{1}{\\sqrt{5}}$$\n\nThis result is central to the theory of Diophantine approximation. Hurwitz's theorem states that for any irrational number $\\alpha$, there exist infinitely many rational numbers $\\frac{p}{q}$ such that $\\left|\\alpha - \\frac{p}{q}\\right|  \\frac{1}{\\sqrt{5}q^2}$. This inequality can be rewritten as $q^2\\left|\\alpha - \\frac{p}{q}\\right|  \\frac{1}{\\sqrt{5}}$. The constant $\\sqrt{5}$ is optimal, meaning the theorem does not hold if $\\sqrt{5}$ is replaced by any larger constant $C  \\sqrt{5}$.\n\nOur calculation shows that for the irrational number $\\alpha = \\varphi$, the best rational approximations (its convergents $\\frac{p_n}{q_n}$) yield values of $q_n^2|\\varphi - p_n/q_n|$ that converge to exactly $\\frac{1}{\\sqrt{5}}$. This means that for any $\\epsilon  0$, there are only finitely many rational numbers $\\frac{p}{q}$ satisfying $|\\varphi - \\frac{p}{q}|  \\frac{1}{(\\sqrt{5}+\\epsilon)q^2}$, because for all sufficiently large $n$, we have $q_n^2|\\varphi - p_n/q_n|  \\frac{1}{\\sqrt{5}+\\epsilon}$. This demonstrates that $\\varphi$ is one of the numbers for which the constant $\\sqrt{5}$ in Hurwitz's theorem cannot be improved, thereby establishing the optimality of the constant. In this sense, $\\varphi$ is the \"worst\" approximable irrational number by rationals.", "answer": "$$\\boxed{\\frac{1}{\\sqrt{5}}}$$", "id": "3084017"}]}