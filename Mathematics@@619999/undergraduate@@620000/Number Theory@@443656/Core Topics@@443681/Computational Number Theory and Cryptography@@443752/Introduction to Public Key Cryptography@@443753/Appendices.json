{"hands_on_practices": [{"introduction": "The security of the RSA cryptosystem begins with the careful generation of its keys. This process transforms two large, secret prime numbers into a public key for encryption and a private key for decryption. This first practice exercise [@problem_id:3086473] walks you through the fundamental arithmetic of creating a complete RSA key pair, demonstrating how the public modulus $n$, the totient $\\varphi(n)$, and the private exponent $d$ are derived from first principles.", "problem": "In the Rivest–Shamir–Adleman (RSA) public-key cryptosystem, keys are constructed using arithmetic in the ring of integers modulo a composite number. Let $p=61$ and $q=53$ be distinct odd primes, and let the public exponent be $e=17$. Starting solely from the definitions of Euler’s totient function, coprimality, and modular inverses, derive and compute explicitly:\n- the modulus $n$,\n- the value $\\varphi(n)$, and\n- the least positive integer $d$ satisfying $e d \\equiv 1 \\pmod{\\varphi(n)}$.\n\nPresent your final answer as a single row vector in the order $(n,\\ \\varphi(n),\\ d)$, written as a row matrix. No rounding is required; provide exact integers.", "solution": "The problem is well-posed and scientifically grounded in the principles of number theory as applied to public-key cryptography. All necessary data are provided, and the required quantities can be uniquely determined. The problem is therefore deemed **valid**. We proceed with the derivation and computation.\n\nThe problem requires the calculation of three quantities related to the RSA cryptosystem: the modulus $n$, Euler's totient function $\\varphi(n)$, and the private exponent $d$. We are given two distinct prime numbers, $p=61$ and $q=53$, and the public exponent $e=17$.\n\nFirst, we compute the modulus $n$. In the RSA algorithm, the modulus $n$ is defined as the product of two large, distinct prime numbers, which in this problem are denoted by $p$ and $q$.\n$$n = p \\times q$$\nSubstituting the given values $p=61$ and $q=53$:\n$$n = 61 \\times 53$$\nThe computation is performed as follows:\n$$n = 61 \\times (50 + 3) = 61 \\times 50 + 61 \\times 3 = 3050 + 183 = 3233$$\nThus, the modulus is $n = 3233$.\n\nSecond, we compute the value of Euler's totient function, $\\varphi(n)$. By definition, $\\varphi(n)$ counts the number of positive integers up to $n$ that are relatively prime to $n$. A key property of the totient function is that it is multiplicative. This means that if two integers $a$ and $b$ are coprime, then $\\varphi(ab) = \\varphi(a)\\varphi(b)$. Since $p$ and $q$ are distinct prime numbers, they are, by definition, coprime. Therefore, we can write:\n$$\\varphi(n) = \\varphi(pq) = \\varphi(p)\\varphi(q)$$\nFor any prime number $k$, all integers from $1$ to $k-1$ are coprime to $k$. Thus, the value of the totient function for a prime $k$ is $\\varphi(k) = k-1$. Applying this to our primes $p$ and $q$:\n$$\\varphi(p) = p - 1$$\n$$\\varphi(q) = q - 1$$\nCombining these results, we derive the formula for $\\varphi(n)$:\n$$\\varphi(n) = (p-1)(q-1)$$\nSubstituting the given values $p=61$ and $q=53$:\n$$\\varphi(n) = (61 - 1)(53 - 1) = 60 \\times 52$$\nThe computation is as follows:\n$$\\varphi(n) = 60 \\times 52 = 3120$$\nThus, the value of Euler's totient function is $\\varphi(n) = 3120$.\n\nThird, we compute the private exponent $d$. The problem states that $d$ is the least positive integer satisfying the congruence relation $ed \\equiv 1 \\pmod{\\varphi(n)}$. This means $d$ is the modular multiplicative inverse of $e$ modulo $\\varphi(n)$. We are given $e=17$ and we have calculated $\\varphi(n)=3120$. The congruence is:\n$$17d \\equiv 1 \\pmod{3120}$$\nFor an inverse to exist, $e$ and $\\varphi(n)$ must be coprime, i.e., $\\gcd(e, \\varphi(n)) = 1$. Since $e=17$ is a prime number, we only need to check if $17$ is a factor of $3120$. The division $3120 \\div 17$ yields approximately $183.5$, which is not an integer. Therefore, $\\gcd(17, 3120) = 1$, and a unique modular inverse for $d$ exists.\n\nTo find $d$, we use the Extended Euclidean Algorithm to solve the Diophantine equation $17d + 3120k = 1$ for integers $d$ and $k$. The algorithm proceeds by finding the greatest common divisor of $3120$ and $17$:\n\\begin{align*} 3120 = 183 \\times 17 + 9 \\\\ 17 = 1 \\times 9 + 8 \\\\ 9 = 1 \\times 8 + 1 \\end{align*}\nThe last non-zero remainder is $1$, confirming $\\gcd(3120, 17) = 1$. Now, we work backwards to express $1$ as a linear combination of $17$ and $3120$:\nFrom the third equation, $1 = 9 - 1 \\times 8$.\nSubstitute $8$ from the second equation, $8 = 17 - 1 \\times 9$:\n$$1 = 9 - 1 \\times (17 - 1 \\times 9) = 9 - 17 + 9 = 2 \\times 9 - 1 \\times 17$$\nSubstitute $9$ from the first equation, $9 = 3120 - 183 \\times 17$:\n$$1 = 2 \\times (3120 - 183 \\times 17) - 1 \\times 17$$\n$$1 = 2 \\times 3120 - 366 \\times 17 - 1 \\times 17$$\n$$1 = 2 \\times 3120 - 367 \\times 17$$\nThis equation can be written as $(-367) \\times 17 + 2 \\times 3120 = 1$. Taking this equation modulo $3120$:\n$$(-367) \\times 17 \\equiv 1 \\pmod{3120}$$\nThis shows that $d \\equiv -367 \\pmod{3120}$. The problem requires the least positive integer value for $d$. We find this by adding the modulus to the negative result:\n$$d = -367 + 3120 = 2753$$\nThus, the private exponent is $d = 2753$.\n\nIn summary, the computed values are:\n- $n = 3233$\n- $\\varphi(n) = 3120$\n- $d = 2753$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3233  3120  2753\n\\end{pmatrix}\n}\n$$", "id": "3086473"}, {"introduction": "After generating keys, the core operation of RSA is modular exponentiation, which is used for both encrypting and decrypting messages. This next practice [@problem_id:3086499] tackles this essential calculation, guiding you through the efficient 'square-and-multiply' algorithm. You will then verify your result using the elegant shortcut provided by Fermat's Little Theorem, highlighting the powerful interplay between computational algorithms and pure number theory.", "problem": "A central operation in Rivest–Shamir–Adleman (RSA) public key cryptography is modular exponentiation in a prime modulus ring, which relies on efficient algorithms and number theoretic guarantees for correctness. Consider the task of computing the modular exponentiation $3^{200} \\bmod 101$, where $101$ is a prime. Derive the value by implementing the square-and-multiply algorithm grounded in binary expansion and repeated squaring in the residue class ring modulo $101$. Then, give an independent verification of your computed result using Fermat’s little theorem (FLT), starting from the foundational properties of the multiplicative group modulo a prime. Express your final answer as the least nonnegative residue in the set $\\{0,1,2,\\dots,100\\}$. No rounding is required.", "solution": "The problem requires the computation of $3^{200} \\bmod 101$. The problem statement is valid as it is mathematically well-posed, scientifically grounded in number theory, and contains all necessary information to derive a unique solution. The modulus, $101$, is a prime number, which is a key property for the requested verification method.\n\nWe will first compute the value using the square-and-multiply algorithm. Then, we will provide an independent verification using Fermat's Little Theorem.\n\n### Method 1: Square-and-Multiply Algorithm\n\nThis algorithm computes $a^e \\pmod{n}$ by using the binary representation of the exponent $e$. The base is $a=3$, the exponent is $e=200$, and the modulus is $n=101$.\n\nFirst, we find the binary representation of the exponent $200$:\n$200 = 128 + 64 + 8 = 2^7 + 2^6 + 2^3$.\nIn binary, this is $200_{10} = 11001000_2$.\n\nThe exponentiation can be broken down according to this binary expansion:\n$$3^{200} = 3^{128+64+8} = 3^{128} \\cdot 3^{64} \\cdot 3^8$$\nWe need to compute the terms $3^{2^k}$ for $k$ up to $7$ by repeated squaring, all modulo $101$.\n\nThe sequence of squarings is as follows:\n\\begin{align*}\n3^1 \\equiv 3 \\pmod{101} \\\\\n3^2 \\equiv 3^2 = 9 \\pmod{101} \\\\\n3^4 \\equiv 9^2 = 81 \\pmod{101} \\\\\n3^8 \\equiv 81^2 = 6561 \\pmod{101}\n\\end{align*}\nTo simplify $6561 \\pmod{101}$, we perform division: $6561 = 64 \\times 101 + 97$. Thus, $3^8 \\equiv 97 \\pmod{101}$. It is often computationally simpler to work with residues of smaller absolute value. Since $97 \\equiv 97 - 101 \\equiv -4 \\pmod{101}$, we can use this for subsequent steps.\n\\begin{align*}\n3^{16} \\equiv (3^8)^2 \\equiv 97^2 \\equiv (-4)^2 = 16 \\pmod{101} \\\\\n3^{32} \\equiv (3^{16})^2 \\equiv 16^2 = 256 \\pmod{101}\n\\end{align*}\nTo simplify $256 \\pmod{101}$, we perform division: $256 = 2 \\times 101 + 54$. Thus, $3^{32} \\equiv 54 \\pmod{101}$.\n\\begin{align*}\n3^{64} \\equiv (3^{32})^2 \\equiv 54^2 = 2916 \\pmod{101}\n\\end{align*}\nTo simplify $2916 \\pmod{101}$, we perform division: $2916 = 28 \\times 101 + 88$. Thus, $3^{64} \\equiv 88 \\pmod{101}$.\n\\begin{align*}\n3^{128} \\equiv (3^{64})^2 \\equiv 88^2 = 7744 \\pmod{101}\n\\end{align*}\nTo simplify $7744 \\pmod{101}$, we perform division: $7744 = 76 \\times 101 + 68$. Thus, $3^{128} \\equiv 68 \\pmod{101}$.\n\nNow, we combine the necessary powers of $3$ to compute the final result:\n$$3^{200} \\equiv 3^{128} \\cdot 3^{64} \\cdot 3^8 \\pmod{101}$$\nSubstituting the calculated values:\n$$3^{200} \\equiv 68 \\cdot 88 \\cdot 97 \\pmod{101}$$\nTo simplify the multiplication, we can use negative residues where convenient: $88 \\equiv -13 \\pmod{101}$ and $97 \\equiv -4 \\pmod{101}$.\n$$3^{200} \\equiv 68 \\cdot (-13) \\cdot (-4) \\pmod{101}$$\nFirst, multiply the negative terms:\n$$(-13) \\cdot (-4) = 52$$\nSo the expression becomes:\n$$3^{200} \\equiv 68 \\cdot 52 \\pmod{101}$$\nPerforming the final multiplication:\n$$68 \\cdot 52 = 3536$$\nTo find the residue modulo $101$, we divide $3536$ by $101$:\n$$3536 = 35 \\times 101 + 1$$\nTherefore, we have:\n$$3^{200} \\equiv 1 \\pmod{101}$$\n\n### Method 2: Verification using Fermat's Little Theorem (FLT)\n\nFermat's Little Theorem states that if $p$ is a prime number, then for any integer $a$ such that $p$ does not divide $a$, we have:\n$$a^{p-1} \\equiv 1 \\pmod{p}$$\nThis theorem is a foundational property of the multiplicative group of integers modulo a prime $p$, denoted $(\\mathbb{Z}/p\\mathbb{Z})^\\times$, which has order $p-1$.\n\nIn this problem, we have $p=101$, which is a prime number, and the base is $a=3$. Since $101$ does not divide $3$, the conditions of the theorem are satisfied.\nApplying FLT, we get:\n$$3^{101-1} \\equiv 3^{100} \\equiv 1 \\pmod{101}$$\nOur goal is to compute $3^{200} \\bmod 101$. We can express the exponent $200$ in terms of the exponent from FLT, which is $100$:\n$$200 = 2 \\times 100$$\nNow we can rewrite the original expression:\n$$3^{200} = 3^{2 \\times 100} = (3^{100})^2$$\nTaking this expression modulo $101$ and substituting the result from FLT:\n$$3^{200} \\equiv (3^{100})^2 \\pmod{101}$$\n$$3^{200} \\equiv (1)^2 \\pmod{101}$$\n$$3^{200} \\equiv 1 \\pmod{101}$$\nBoth methods produce the same result, $1$. The value is the least nonnegative residue in the set $\\{0,1,2,\\dots,100\\}$, as requested.", "answer": "$$\\boxed{1}$$", "id": "3086499"}, {"introduction": "The security of an RSA key pair hinges on the primality of its two source numbers, $p$ and $q$. But how can we be sure a very large number is prime? This final practice [@problem_id:3086457] explores the Miller-Rabin test, a powerful probabilistic method used to efficiently identify prime numbers for cryptographic use. By working through an iteration of the test, you will learn how it can definitively prove a number is composite and understand the basis for its reliability in finding strong probable primes.", "problem": "An advanced undergraduate course in number theory and introduction to public key cryptography often studies primality testing methods used in key generation for the Rivest–Shamir–Adleman (RSA) scheme. One such method is the Miller–Rabin primality test, which relies on modular arithmetic and the structure of the multiplicative group of integers modulo a composite candidate. Starting from the fundamental definitions of modular exponentiation and the statement of Fermat's little theorem (if $p$ is prime and $\\gcd(a,p)=1$, then $a^{p-1} \\equiv 1 \\pmod{p}$), derive the steps of a single Miller–Rabin iteration for the odd integer $n=341$ with base $a=2$ by expressing $n-1$ in the form $2^{s} d$ with $d$ odd, computing $x_{0} \\equiv a^{d} \\pmod{n}$, and then iteratively squaring $x_{i+1} \\equiv x_{i}^{2} \\pmod{n}$ up to $s-1$ times, checking whether any $x_{i}$ equals $-1 \\pmod{n}$. Use only properties of modular arithmetic and the Chinese Remainder Theorem as needed to carry out exact computations. Determine whether $a=2$ is a Miller–Rabin witness of compositeness for $n=341$ according to the strong probable prime condition.\n\nExpress your final answer as $1$ if $a=2$ is a witness of compositeness for $n=341$, and $0$ otherwise. No rounding is required, and no units are involved.", "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in number theory, well-posed, objective, and contains all necessary information to derive a unique solution. We may proceed with the solution.\n\nThe Miller-Rabin primality test for an odd integer $n  2$ and a base $a$ (where $1  a  n-1$) is a probabilistic test for primality. It is an extension of the test based on Fermat's Little Theorem. If $n$ is a prime number, then by Fermat's Little Theorem, $a^{n-1} \\equiv 1 \\pmod{n}$ for any integer $a$ not divisible by $n$. Furthermore, if $n$ is prime, the only solutions to the congruence $x^2 \\equiv 1 \\pmod{n}$ are $x \\equiv 1 \\pmod{n}$ and $x \\equiv -1 \\pmod{n}$. The Miller-Rabin test exploits this latter property.\n\nThe algorithm proceeds as follows:\n1.  First, we write $n-1$ in the form $2^s d$, where $d$ is an odd integer and $s \\ge 1$.\n2.  We then consider the sequence of modular exponentiations:\n    $$a^d \\pmod{n}, \\quad a^{2d} \\pmod{n}, \\quad a^{4d} \\pmod{n}, \\quad \\dots, \\quad a^{2^{s-1}d} \\pmod{n}$$\n    This sequence is computed efficiently by first calculating $x_0 \\equiv a^d \\pmod{n}$ and then repeatedly squaring: $x_{i+1} \\equiv x_i^2 \\pmod{n}$ for $i=0, 1, \\dots, s-2$. The full sequence of values is $x_0, x_1, \\dots, x_{s-1}$.\n\nAn integer $n$ is called a strong probable prime to base $a$ if one of the following two conditions holds:\n(A) $a^d \\equiv 1 \\pmod{n}$.\n(B) $a^{2^i d} \\equiv -1 \\pmod{n}$ for some integer $i$ in the range $0 \\le i \\le s-1$.\n\nIf neither of these conditions is met, then $n$ is definitively composite, and $a$ is called a Miller-Rabin witness to the compositeness of $n$. This occurs if $a^d \\not\\equiv 1 \\pmod{n}$ and if no term in the sequence $x_0, x_1, \\dots, x_{s-1}$ is congruent to $-1 \\pmod{n}$. A key indicator of compositeness is finding a \"non-trivial square root of 1 modulo $n$,\" which is a value $x_i \\not\\equiv \\pm 1 \\pmod{n}$ such that $x_{i+1} \\equiv x_i^2 \\equiv 1 \\pmod{n}$.\n\nWe are tasked to perform a single Miller-Rabin iteration for the integer $n=341$ with base $a=2$.\n\nFirst, we decompose $n-1$ into the form $2^s d$:\n$n - 1 = 341 - 1 = 340$.\nTo find $s$ and $d$, we factor out powers of $2$:\n$340 = 2 \\times 170 = 2^2 \\times 85$.\nSince $85$ is odd, we have $s=2$ and $d=85$.\n\nNext, we compute $x_0 \\equiv a^d \\pmod{n}$:\n$x_0 \\equiv 2^{85} \\pmod{341}$.\nWe use the method of binary exponentiation (also known as exponentiation by squaring) to compute this value. The binary representation of the exponent $85$ is $1010101_2$, which corresponds to $85 = 64 + 16 + 4 + 1 = 2^6 + 2^4 + 2^2 + 2^0$.\nWe compute powers of $2$ modulo $341$:\n$2^1 \\equiv 2 \\pmod{341}$\n$2^2 \\equiv 4 \\pmod{341}$\n$2^4 \\equiv 4^2 \\equiv 16 \\pmod{341}$\n$2^8 \\equiv 16^2 \\equiv 256 \\pmod{341}$\n$2^{16} \\equiv 256^2 = 65536 \\pmod{341}$. To reduce this, we divide by $341$: $65536 = 192 \\times 341 + 64$. So, $2^{16} \\equiv 64 \\pmod{341}$.\n$2^{32} \\equiv 64^2 = 4096 \\pmod{341}$. To reduce this, we divide by $341$: $4096 = 12 \\times 341 + 4$. So, $2^{32} \\equiv 4 \\pmod{341}$.\n$2^{64} \\equiv 4^2 \\equiv 16 \\pmod{341}$.\n\nNow we combine the required powers for the exponent $85$:\n$2^{85} = 2^{64} \\times 2^{16} \\times 2^4 \\times 2^1$\n$x_0 \\equiv 16 \\times 64 \\times 16 \\times 2 \\pmod{341}$\nLet's compute this step-wise:\n$16 \\times 64 = 1024$. To reduce this, $1024 = 3 \\times 341 + 1$. So, $16 \\times 64 \\equiv 1 \\pmod{341}$.\n$x_0 \\equiv (16 \\times 64) \\times (16 \\times 2) \\equiv 1 \\times 32 \\equiv 32 \\pmod{341}$.\nSo, $x_0 = 32$.\n\nNow we check the conditions for $n=341$ being a strong probable prime to base $a=2$.\nCondition (A): Is $x_0 \\equiv 1 \\pmod{341}$?\n$32 \\not\\equiv 1 \\pmod{341}$. So, condition (A) is false.\n\nCondition (B): Is $x_i \\equiv -1 \\pmod{341}$ for some $i \\in \\{0, 1, \\dots, s-1\\}$?\nHere, $s=2$, so we check for $i=0$ and $i=1$.\nThe values to check are $x_0 = a^d \\pmod{n}$ and $x_1 = a^{2d} \\pmod{n}$.\nFor $i=0$: Is $x_0 \\equiv -1 \\pmod{341}$?\n$-1 \\pmod{341}$ is $340$. We have $x_0 = 32$, and $32 \\not\\equiv 340 \\pmod{341}$.\n\nFor $i=1$: We must compute $x_1 \\equiv x_0^2 \\pmod{341}$.\n$x_1 \\equiv 32^2 \\pmod{341}$\n$x_1 \\equiv 1024 \\pmod{341}$\nAs calculated before, $1024 = 3 \\times 341 + 1$, so $x_1 \\equiv 1 \\pmod{341}$.\nIs $x_1 \\equiv -1 \\pmod{341}$?\n$1 \\not\\equiv -1 \\pmod{341}$ since $n2$.\n\nSince neither condition (A) nor (B) is satisfied, $n=341$ is not a strong probable prime to base $2$. Therefore, $a=2$ is a Miller-Rabin witness of compositeness for $n=341$.\nThe test reveals the compositeness because we found that $x_0=32 \\not\\equiv \\pm 1 \\pmod{341}$ while $x_1 \\equiv x_0^2 \\equiv 1 \\pmod{341}$. This means $32$ is a non-trivial square root of $1$ modulo $341$, which can only exist if $341$ is composite. This discovery implies that $\\gcd(32-1, 341)$ and $\\gcd(32+1, 341)$ are non-trivial factors of $341$. Indeed, $\\gcd(31, 341) = 31$, which is a prime factor of $341 = 11 \\times 31$.\n\nThe problem asks for the answer to be $1$ if $a=2$ is a witness of compositeness for $n=341$, and $0$ otherwise. Our conclusion is that $a=2$ is a witness.", "answer": "$$\\boxed{1}$$", "id": "3086457"}]}