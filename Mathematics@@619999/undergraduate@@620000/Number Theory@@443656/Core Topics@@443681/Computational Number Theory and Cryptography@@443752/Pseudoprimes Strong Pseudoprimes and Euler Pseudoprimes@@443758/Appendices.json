{"hands_on_practices": [{"introduction": "Fermat's Little Theorem provides a powerful property of prime numbers, but its converse does not hold true for primality testing. This first practice challenges you to find the smallest composite number $n$ that masquerades as a prime by satisfying the congruence $2^{n-1} \\equiv 1 \\pmod{n}$. By systematically applying the concepts of multiplicative order and the Chinese Remainder Theorem, you will uncover the first Fermat pseudoprime to base 2, gaining essential skills in number-theoretic investigation [@problem_id:3088873].", "problem": "Let $a$ be an integer with $a \\geq 2$. A composite integer $n$ is called a Fermat pseudoprime to base $a$ if $a^{n-1} \\equiv 1 \\pmod{n}$. For base $a = 2$, determine the smallest composite integer $n$ that satisfies $2^{n-1} \\equiv 1 \\pmod{n}$. Your reasoning must begin from the following foundational facts: Fermat’s little theorem, the concept of multiplicative order in the multiplicative group of units modulo a prime power, and the Chinese remainder theorem. You must justify why no smaller composite $n$ can satisfy the defining congruence by using order divisibility constraints at prime and prime-power moduli, and you must explicitly compute $2^{n-1} \\bmod n$ to verify the pseudoprime property of your candidate.\n\nInstructions and requirements:\n- Use the definition of multiplicative order $\\operatorname{ord}_m(2)$, namely the least positive integer $t$ such that $2^t \\equiv 1 \\pmod{m}$ when $\\gcd(2,m)=1$.\n- Argue why any such $n$ must be odd and, for all candidates below your final $n$, eliminate the possibilities systematically by combining the order constraints modulo each prime divisor with the Chinese remainder theorem.\n- When a prime square $p^2$ divides a candidate $n$, use order considerations modulo $p^2$ to determine whether this can occur for base $2$ in the size range relevant to the search.\n- After determining the smallest such composite $n$, verify $2^{n-1} \\bmod n$ by explicit congruence computations.\n- Express the final answer as the value of $n$ only. No rounding is required, and no units apply.", "solution": "The problem asks for the smallest composite integer $n$ that satisfies the congruence $2^{n-1} \\equiv 1 \\pmod{n}$. Such an integer is known as a Fermat pseudoprime to base $2$. Our solution will be developed from foundational principles of number theory, including Fermat's little theorem, the concept of multiplicative order, and the Chinese remainder theorem, as required.\n\nFirst, we establish that any such integer $n$ must be odd.\nLet $n$ be a composite number satisfying $2^{n-1} \\equiv 1 \\pmod{n}$. This congruence implies that $n$ must divide $2^{n-1} - 1$. If $n$ were an even number, then $2$ would be a divisor of $n$. Consequently, $2$ would have to divide $2^{n-1} - 1$. However, for any integer $n \\ge 2$, $n-1 \\ge 1$, which means $2^{n-1}$ is an even integer, and thus $2^{n-1}-1$ is an odd integer. An odd integer is not divisible by $2$. This is a contradiction. Therefore, any candidate for $n$ must be an odd composite integer.\n\nThe core of the problem is the condition $2^{n-1} \\equiv 1 \\pmod n$. Let the prime factorization of $n$ be $n = p_1^{k_1} p_2^{k_2} \\cdots p_r^{k_r}$. By the Chinese remainder theorem, the congruence $2^{n-1} \\equiv 1 \\pmod n$ is equivalent to the system of congruences $2^{n-1} \\equiv 1 \\pmod{p_i^{k_i}}$ for each $i \\in \\{1, 2, \\dots, r\\}$.\nThis condition, in turn, is equivalent to requiring that the multiplicative order of $2$ modulo each prime power factor $p_i^{k_i}$, denoted $\\operatorname{ord}_{p_i^{k_i}}(2)$, must divide the exponent $n-1$. That is, $\\operatorname{ord}_{p_i^{k_i}}(2) \\mid (n-1)$ for all $i$.\n\nWe now conduct a systematic search for the smallest odd composite $n$, eliminating candidates by applying these order divisibility constraints. We categorize candidates by their prime factorization structure.\n\nCase 1: $n$ is a power of a single prime, $n = p^k$ with $k \\ge 2$.\nFor $n=p^k$ to be a pseudoprime, we require $\\operatorname{ord}_{p^k}(2) \\mid (p^k - 1)$.\nFor an odd prime $p$, the order $\\operatorname{ord}_{p^k}(2)$ is related to $\\operatorname{ord}_p(2)$. A standard result from the theory of orders (related to the lifting-the-exponent lemma) states that if $p$ is an odd prime such that $2^{\\operatorname{ord}_p(2)} \\not\\equiv 1 \\pmod{p^2}$, then $\\operatorname{ord}_{p^k}(2) = p^{k-1} \\operatorname{ord}_p(2)$. Primes $p$ for which $2^{p-1} \\equiv 1 \\pmod{p^2}$ are called Wieferich primes; the only known ones are $1093$ and $3511$. For any prime $p  1093$, we can assume $2^{p-1} \\not\\equiv 1 \\pmod{p^2}$. This simplifies the analysis for small $n$.\nSpecifically, if $p$ is not a Wieferich prime, then for $k \\ge 2$, $\\operatorname{ord}_{p^k}(2)$ is a multiple of $p$.\nSo, for $n=p^k$ to be a pseudoprime, we would need $p \\mid \\operatorname{ord}_{p^k}(2)$, which would imply $p \\mid (p^k-1)$. But $p^k-1 \\equiv -1 \\pmod p$, so $p$ does not divide $p^k-1$. This is a contradiction.\nTherefore, no power $p^k$ (with $k \\ge 2$) of a non-Wieferich prime $p$ can be a Fermat pseudoprime to base $2$. Since the smallest odd composite numbers that are prime powers are $9=3^2$, $25=5^2$, $27=3^3$, $49=7^2$, etc., and all primes involved are less than $1093$, none of these can be pseudoprimes to base $2$. For instance, for $n=9=3^2$, $\\operatorname{ord}_9(2)=6$. We require $6 \\mid (9-1)=8$, which is false. For $n=25=5^2$, $\\operatorname{ord}_{25}(2)=20$. We require $20 \\mid (25-1)=24$, which is false.\n\nCase 2: $n$ is a product of two distinct primes, $n = pq$ with $p  q$.\nThe condition $2^{n-1} \\equiv 1 \\pmod n$ becomes $\\operatorname{ord}_p(2) \\mid (pq-1)$ and $\\operatorname{ord}_q(2) \\mid (pq-1)$.\nUsing the fact that $\\operatorname{ord}_p(2) \\mid (p-1)$ from Fermat's little theorem, and that $pq-1 = q(p-1) + (q-1)$, the condition $\\operatorname{ord}_p(2) \\mid (pq-1)$ simplifies to $\\operatorname{ord}_p(2) \\mid (q-1)$.\nSymmetrically, $\\operatorname{ord}_q(2) \\mid (p-1)$.\nWe test odd composite numbers of this form:\n- $n=15=3 \\times 5$: $p=3, q=5$. We need $\\operatorname{ord}_5(2) \\mid (3-1)=2$. But $\\operatorname{ord}_5(2)=4$, and $4 \\nmid 2$. Fails.\n- $n=21=3 \\times 7$: $p=3, q=7$. We need $\\operatorname{ord}_7(2) \\mid (3-1)=2$. But $\\operatorname{ord}_7(2)=3$, and $3 \\nmid 2$. Fails.\n- $n=33=3 \\times 11$: $p=3, q=11$. We need $\\operatorname{ord}_{11}(2) \\mid (3-1)=2$. But $\\operatorname{ord}_{11}(2)=10$, and $10 \\nmid 2$. Fails.\n- $n=35=5 \\times 7$: $p=5, q=7$. We need $\\operatorname{ord}_5(2) \\mid (7-1)=6$. $\\operatorname{ord}_5(2)=4$, and $4 \\mid 6$ is false. Fails.\nSystematic investigation of all products $n=pq  341$ shows they all fail these conditions. For instance, $51, 57, 69, \\dots$ fail because $p=3$ requires $\\operatorname{ord}_q(2) \\mid 2$, which implies $q=3$, contradicting $pq$. Other examples: $n=65=5 \\times 13$ fails as $\\operatorname{ord}_{13}(2)=12 \\nmid (5-1)=4$. $n=91=7 \\times 13$ fails as $\\operatorname{ord}_{13}(2)=12 \\nmid (7-1)=6$. This continues for all such composites.\n\nCase 3: $n$ has three or more distinct prime factors.\nThe smallest such number is $n = 3 \\times 5 \\times 7 = 105$. The condition is $2^{104} \\equiv 1 \\pmod{105}$. This requires $\\operatorname{ord}_3(2) \\mid 104$, $\\operatorname{ord}_5(2) \\mid 104$, and $\\operatorname{ord}_7(2) \\mid 104$.\n- $\\operatorname{ord}_3(2)=2$, and $2 \\mid 104$. (Holds)\n- $\\operatorname{ord}_5(2)=4$, and $4 \\mid 104$. (Holds)\n- $\\operatorname{ord}_7(2)=3$, but $3 \\nmid 104$ (since the sum of digits $1+0+4=5$ is not divisible by $3$). Fails.\nThe next such number is $n=3 \\times 5 \\times 11=165$. We require $2^{164} \\equiv 1 \\pmod{165}$. This requires $\\operatorname{ord}_{11}(2)=10 \\mid 164$, which is false.\n\nCase 4: $n$ is not square-free and has multiple prime factors.\nSmallest is $n=45=3^2 \\times 5$. Requires $2^{44} \\equiv 1 \\pmod 9$ and $2^{44} \\equiv 1 \\pmod 5$.\nThe first congruence requires $\\operatorname{ord}_9(2) \\mid 44$. We know $\\operatorname{ord}_9(2)=6$, and $6 \\nmid 44$. Fails.\nNext is $n=63=3^2 \\times 7$. Requires $\\operatorname{ord}_9(2) \\mid 62$. $6 \\nmid 62$. Fails.\nA thorough check of all odd composite integers up to $340$ confirms that none satisfy the pseudoprime condition.\n\nNow, we test the number $n=341$.\n$n = 341 = 11 \\times 31$. This is a composite number of the form $pq$ with $p=11, q=31$. We apply our derived conditions:\n1. $\\operatorname{ord}_p(2) \\mid (q-1)$: We need $\\operatorname{ord}_{11}(2) \\mid (31-1)=30$. The powers of $2$ modulo $11$ are $2, 4, 8, 5, 10(-1), \\dots$. The order is $\\operatorname{ord}_{11}(2)=10$. Since $10 \\mid 30$, this condition holds.\n2. $\\operatorname{ord}_q(2) \\mid (p-1)$: We need $\\operatorname{ord}_{31}(2) \\mid (11-1)=10$. The powers of $2$ modulo $31$ are $2, 4, 8, 16, 32 \\equiv 1$. The order is $\\operatorname{ord}_{31}(2)=5$. Since $5 \\mid 10$, this condition also holds.\nSince both divisibility conditions are met, $n=341$ is indeed a Fermat pseudoprime to base $2$.\n\nFinally, as required, we explicitly verify the congruence $2^{340} \\equiv 1 \\pmod{341}$.\nUsing the Chinese Remainder Theorem, we verify the congruence modulo its prime factors, $11$ and $31$.\n- Modulo $11$: By Fermat's little theorem, $2^{10} \\equiv 1 \\pmod{11}$. Then $2^{340} = (2^{10})^{34} \\equiv 1^{34} \\equiv 1 \\pmod{11}$.\n- Modulo $31$: We found $\\operatorname{ord}_{31}(2)=5$. Then $2^{340} = (2^5)^{68} \\equiv 1^{68} \\equiv 1 \\pmod{31}$.\nSince $2^{340}-1$ is divisible by both $11$ and $31$, and since $\\gcd(11, 31)=1$, it must be divisible by their product $341$. Thus, $2^{340} \\equiv 1 \\pmod{341}$.\n\nOur systematic elimination of all smaller odd composite integers ($9, 15, 21, 25, \\dots, 339$) shows that $341$ is the smallest such integer.", "answer": "$$\n\\boxed{341}\n$$", "id": "3088873"}, {"introduction": "Having identified a number that can fool the simple Fermat test, we now dissect its properties more closely. This exercise asks you to demonstrate that being a pseudoprime is not necessarily an intrinsic property of a number, but can depend on the chosen base, distinguishing it from a Carmichael number. By then applying the stricter Euler and strong pseudoprime tests, you will see firsthand how these more advanced criteria can successfully expose a composite number that passes the basic test [@problem_id:3088843].", "problem": "Let $a$ be an integer with $a \\geq 2$, and let $n$ be an odd composite integer with $\\gcd(a,n)=1$. A composite $n$ is called a Fermat pseudoprime to base $a$ if $a^{n-1} \\equiv 1 \\pmod{n}$. A Carmichael number is a composite $n$ such that $a^{n-1} \\equiv 1 \\pmod{n}$ for every integer $a$ with $\\gcd(a,n)=1$. A strong pseudoprime to base $a$ is defined as follows: write $n-1=2^{s}d$ with $d$ odd; then $n$ is a strong pseudoprime to base $a$ if either $a^{d} \\equiv 1 \\pmod{n}$ or there exists $r \\in \\{0,1,\\dots,s-1\\}$ with $a^{2^{r}d} \\equiv -1 \\pmod{n}$. An Euler pseudoprime to base $a$ is an odd composite $n$ with $\\gcd(a,n)=1$ such that $a^{(n-1)/2} \\equiv \\left(\\frac{a}{n}\\right) \\pmod{n}$, where $\\left(\\frac{a}{n}\\right)$ is the Jacobi symbol.\n\nStarting from Fermat’s little theorem and these definitions, produce a concrete example of an odd composite integer $n$ that is a Fermat pseudoprime to a single base but is not Carmichael, by explicitly computing $a^{n-1} \\bmod n$ for one base where the congruence holds and for another coprime base where it fails. In addition, for your chosen $n$, determine by explicit computation whether $n$ is a strong pseudoprime to the first base and whether it is an Euler pseudoprime to that base, by evaluating the necessary residues and the relevant Jacobi symbol. Use the Chinese Remainder Theorem (CRT) only as a consequence of coprime prime factors, and justify each modular step from first principles.\n\nState the value of your example $n$ as your final answer. Your answer must be a single exact integer.", "solution": "Our objective is to find an odd composite integer $n$ that is a Fermat pseudoprime to a base $a \\geq 2$, but is not a Carmichael number. We must then further test if this $n$ is a strong pseudoprime and an Euler pseudoprime to the base $a$.\n\nLet's propose a candidate integer $n$. The smallest odd composite number that is a Fermat pseudoprime to base $2$ is $n=341$. We will verify if this number meets all the required conditions.\n\nFirst, we establish that $n=341$ is an odd composite integer. Indeed, $341$ is odd and can be factored as $341 = 11 \\times 31$.\n\n**Part 1: Fermat Pseudoprime Test and Carmichael Number Status**\n\nWe need to show that $n=341$ is a Fermat pseudoprime to a base $a$, but not for all coprime bases. Let's choose the base $a=2$.\n\nA composite $n$ is a Fermat pseudoprime to base $a$ if $a^{n-1} \\equiv 1 \\pmod{n}$. For $n=341$ and $a=2$, we must verify if $2^{341-1} \\equiv 1 \\pmod{341}$, i.e., $2^{340} \\equiv 1 \\pmod{341}$.\nSince $341 = 11 \\times 31$, this congruence is equivalent to the system of congruences:\n$$\n\\begin{cases}\n2^{340} \\equiv 1 \\pmod{11} \\\\\n2^{340} \\equiv 1 \\pmod{31}\n\\end{cases}\n$$\nFor the first congruence, by Fermat's Little Theorem, since $11$ is a prime number and $\\gcd(2, 11)=1$, we have $2^{11-1} \\equiv 2^{10} \\equiv 1 \\pmod{11}$. The exponent is $340 = 10 \\times 34$. Therefore,\n$$2^{340} = (2^{10})^{34} \\equiv 1^{34} \\equiv 1 \\pmod{11}$$\nFor the second congruence, we first determine the order of $2$ modulo $31$. We have $2^1=2$, $2^2=4$, $2^3=8$, $2^4=16$, and $2^5 = 32 \\equiv 1 \\pmod{31}$. Thus, the order of $2$ modulo $31$ is $5$. The exponent is $340$, which is a multiple of $5$ since $340 = 5 \\times 68$. Therefore,\n$$2^{340} = (2^5)^{68} \\equiv 1^{68} \\equiv 1 \\pmod{31}$$\nSince $2^{340} \\equiv 1$ modulo both $11$ and $31$, and $\\gcd(11, 31)=1$, by the Chinese Remainder Theorem, we can conclude that $2^{340} \\equiv 1 \\pmod{11 \\times 31}$, or $2^{340} \\equiv 1 \\pmod{341}$. Thus, $341$ is a Fermat pseudoprime to base $2$.\n\nNow, to show that $341$ is not a Carmichael number, we must find another base $b$ with $\\gcd(b, 341)=1$ such that $b^{340} \\not\\equiv 1 \\pmod{341}$. Let's test base $b=3$. Note that $\\gcd(3, 341)=1$ as $11$ and $31$ are not divisible by $3$.\nWe need to compute $3^{340} \\pmod{341}$. If $3^{340} \\equiv 1 \\pmod{341}$ were true, it would imply $3^{340} \\equiv 1 \\pmod{31}$. Let's check this. By Fermat's Little Theorem, $3^{30} \\equiv 1 \\pmod{31}$. We can write the exponent $340$ in terms of $30$: $340 = 30 \\times 11 + 10$.\nSo, we have:\n$$3^{340} = 3^{30 \\times 11 + 10} = (3^{30})^{11} \\times 3^{10} \\equiv 1^{11} \\times 3^{10} \\equiv 3^{10} \\pmod{31}$$\nLet's compute $3^{10} \\pmod{31}$:\n$3^1 = 3$\n$3^2 = 9$\n$3^3 = 27 \\equiv -4 \\pmod{31}$\n$3^4 \\equiv 9^2 = 81 = 2 \\times 31 + 19 \\equiv 19 \\pmod{31}$\n$3^5 \\equiv 3 \\times 19 = 57 = 1 \\times 31 + 26 \\equiv 26 \\equiv -5 \\pmod{31}$\n$3^{10} = (3^5)^2 \\equiv (-5)^2 = 25 \\pmod{31}$\nSince $3^{340} \\equiv 25 \\pmod{31}$ and $25 \\not\\equiv 1 \\pmod{31}$, it follows that $3^{340} \\not\\equiv 1 \\pmod{341}$. Therefore, $341$ is not a Carmichael number.\n\n**Part 2: Strong Pseudoprime Test**\n\nNext, we determine if $n=341$ is a strong pseudoprime to base $a=2$. We first write $n-1 = 2^s d$ with $d$ odd.\n$n-1 = 340 = 4 \\times 85 = 2^2 \\times 85$. So, $s=2$ and $d=85$.\nThe conditions for $n$ to be a strong pseudoprime to base $2$ are:\n$$2^d \\equiv 1 \\pmod{n} \\quad \\text{or} \\quad \\exists r \\in \\{0, 1, \\dots, s-1\\} \\text{ with } 2^{2^r d} \\equiv -1 \\pmod{n}$$\nFor our case, this means we must check if $2^{85} \\equiv 1 \\pmod{341}$, or $2^{85} \\equiv -1 \\pmod{341}$ (for $r=0$), or $2^{2 \\times 85} \\equiv 2^{170} \\equiv -1 \\pmod{341}$ (for $r=1$).\n\nLet's compute $2^{85} \\pmod{341}$. We again use the Chinese Remainder Theorem.\nModulo $11$: $2^{10} \\equiv 1 \\pmod{11}$. Also, $85 = 8 \\times 10 + 5$.\n$2^{85} = (2^{10})^8 \\times 2^5 \\equiv 1^8 \\times 32 \\equiv 32 \\equiv 10 \\equiv -1 \\pmod{11}$.\nModulo $31$: $2^5 \\equiv 1 \\pmod{31}$. Also, $85 = 17 \\times 5$.\n$2^{85} = (2^5)^{17} \\equiv 1^{17} \\equiv 1 \\pmod{31}$.\nWe need to solve the system $x \\equiv -1 \\pmod{11}$ and $x \\equiv 1 \\pmod{31}$. From the second congruence, $x=31k+1$ for some integer $k$. Substituting into the first: $31k+1 \\equiv -1 \\pmod{11}$. This simplifies to $9k \\equiv -2 \\pmod{11}$, which is $9k \\equiv 9 \\pmod{11}$. Since $\\gcd(9, 11)=1$, we can divide by $9$ to get $k \\equiv 1 \\pmod{11}$. So $k=11j+1$ for some integer $j$. Substituting back, $x = 31(11j+1)+1 = 341j+32$. Thus, $2^{85} \\equiv 32 \\pmod{341}$.\nThis result, $32$, is neither $1$ nor $-1 \\pmod{341}$. So we check the next condition for $r=1$.\nWe compute $2^{170} \\pmod{341}$:\n$$2^{170} = (2^{85})^2 \\equiv 32^2 = 1024 \\pmod{341}$$\nDividing $1024$ by $341$: $1024 = 3 \\times 341 + 1$.\nSo, $2^{170} \\equiv 1 \\pmod{341}$. This is not $-1 \\pmod{341}$.\nThe sequence of values $2^d, 2^{2d}$ modulo $n$ is $32, 1$. Since no term is congruent to $-1$ and the first term is not congruent to $1$, $n=341$ is not a strong pseudoprime to base $2$.\n\n**Part 3: Euler Pseudoprime Test**\n\nFinally, we determine if $n=341$ is an Euler pseudoprime to base $a=2$. An odd composite $n$ is an Euler pseudoprime to base $a$ if $a^{(n-1)/2} \\equiv \\left(\\frac{a}{n}\\right) \\pmod{n}$, where $\\left(\\frac{a}{n}\\right)$ is the Jacobi symbol.\nFor $n=341$ and $a=2$, we have $(n-1)/2 = 340/2 = 170$.\nThe left side of the congruence is $2^{170} \\pmod{341}$. From the previous step, we found $2^{170} \\equiv 1 \\pmod{341}$.\nThe right side is the Jacobi symbol $\\left(\\frac{2}{341}\\right)$. We use the supplementary law for the Jacobi symbol: $\\left(\\frac{2}{n}\\right) = (-1)^{(n^2-1)/8}$.\nFor $n=341$, we find its residue modulo $8$: $341 = 42 \\times 8 + 5$, so $341 \\equiv 5 \\pmod{8}$.\nFor $n \\equiv 3, 5 \\pmod{8}$, the exponent $(n^2-1)/8$ is odd. In our case, $(341^2-1)/8 = (116281-1)/8 = 14535$, which is odd.\nTherefore, $\\left(\\frac{2}{341}\\right) = (-1)^{14535} = -1$.\nThe condition for an Euler pseudoprime becomes $1 \\equiv -1 \\pmod{341}$, which implies $2 \\equiv 0 \\pmod{341}$. This is false.\nThus, $341$ is not an Euler pseudoprime to base $2$.\n\nIn conclusion, the integer $n=341$ is an odd composite number that is a Fermat pseudoprime to base $2$ but is not a Carmichael number. It is also not a strong pseudoprime or an Euler pseudoprime to base $2$. The number $341$ serves as the required concrete example.", "answer": "$$\\boxed{341}$$", "id": "3088843"}, {"introduction": "The strong pseudoprime test, forming the basis of the Miller-Rabin algorithm, is a far more robust tool for primality testing than the simple Fermat congruence. However, it is not infallible. This final practice challenges you to find the smallest composite number that can pass even this stringent test for base 2, thereby qualifying as the first strong pseudoprime [@problem_id:3088867]. Completing this search will solidify your understanding of the Miller-Rabin criteria and highlight why it is considered a powerful probabilistic test.", "problem": "Let $n$ be an odd composite integer and write $n-1=2^{s} d$ with $d$ odd. By definition, $n$ is a strong pseudoprime to base $a$ if either $a^{d}\\equiv 1 \\pmod{n}$ or there exists an integer $r$ with $0\\le r\\le s-1$ such that $a^{2^{r} d}\\equiv -1 \\pmod{n}$. The Miller–Rabin primality test to base $a$ declares $n$ “probably prime” precisely when this strong pseudoprime condition holds for base $a$.\n\nUsing only the fundamental definitions above, determine the smallest strong pseudoprime to base $2$. Justify minimality by noting that any strong pseudoprime to base $2$ must be a Fermat pseudoprime to base $2$ (that is, must satisfy $2^{n-1}\\equiv 1 \\pmod{n}$), and then checking the Miller–Rabin chain for each odd base-$2$ Fermat pseudoprime below your candidate. You may use that the complete list of odd base-$2$ Fermat pseudoprimes less than $2050$ is $\\{341,561,645,1105,1387,1729,1905,2047\\}$.\n\nConfirm your final candidate by explicitly exhibiting the Miller–Rabin chain starting with $x_{0}\\equiv 2^{d}\\pmod{n}$ and iterating $x_{r+1}\\equiv x_{r}^{2}\\pmod{n}$ for $r=0,1,\\dots,s-1$.\n\nYour final answer must be the integer $n$ only. No rounding is required.", "solution": "The problem asks for the smallest strong pseudoprime to base $2$. We are given that any strong pseudoprime to a base $a$ must also be a Fermat pseudoprime to base $a$. A number $n$ is a Fermat pseudoprime to base $a$ if it is a composite number such that $a^{n-1} \\equiv 1 \\pmod{n}$. This implies that the smallest strong pseudoprime to base $2$ must be present in the provided list of the smallest odd Fermat pseudoprimes to base $2$: $\\{341, 561, 645, 1105, 1387, 1729, 1905, 2047\\}$. We will test each of these composite numbers, in increasing order, against the definition of a strong pseudoprime.\n\nAn odd composite integer $n$ is a strong pseudoprime to base $a$ if, with $n-1 = 2^s d$ where $d$ is odd, one of the following conditions holds:\n1. $a^d \\equiv 1 \\pmod{n}$\n2. $a^{2^r d} \\equiv -1 \\pmod{n}$ for some integer $r$ in the range $0 \\le r \\le s-1$.\n\nThe sequence of values $x_r \\equiv a^{2^r d} \\pmod{n}$ for $r=0, 1, \\dots, s-1$ is the Miller-Rabin chain. The test passes if $x_0 \\equiv 1 \\pmod n$ or if any $x_r \\equiv -1 \\pmod n$.\n\nLet's test the candidates with base $a=2$:\n\n1.  For $n=341$:\n    $n=341 = 11 \\times 31$ is composite.\n    $n-1 = 340 = 4 \\times 85 = 2^2 \\times 85$. Thus, $s=2$ and $d=85$.\n    We compute the Miller-Rabin chain for $r=0, 1$:\n    $x_0 \\equiv 2^d \\pmod{n} \\equiv 2^{85} \\pmod{341}$.\n    Since $2^{10} = 1024 = 3 \\times 341 + 1 \\equiv 1 \\pmod{341}$, we have $2^{85} = 2^{10 \\times 8 + 5} = (2^{10})^8 \\times 2^5 \\equiv 1^8 \\times 32 \\equiv 32 \\pmod{341}$.\n    $x_0 \\equiv 32 \\not\\equiv 1 \\pmod{341}$ and $x_0 \\not\\equiv -1 \\pmod{341}$.\n    $x_1 \\equiv x_0^2 \\pmod{n} \\equiv 32^2 = 1024 \\equiv 1 \\pmod{341}$.\n    The chain of values $(x_0, x_1)$ is $(32, 1)$. Since $x_0 \\neq 1$ and no term in the sequence is congruent to $-1 \\pmod{341}$, the number $341$ is not a strong pseudoprime to base $2$.\n\n2.  For $n=561$:\n    $n-1 = 560 = 16 \\times 35 = 2^4 \\times 35$. So, $s=4, d=35$.\n    The chain is $x_0 \\equiv 2^{35} \\equiv 263 \\pmod{561}$, $x_1 \\equiv 263^2 \\equiv 166 \\pmod{561}$, $x_2 \\equiv 166^2 \\equiv 67 \\pmod{561}$, and $x_3 \\equiv 67^2 \\equiv 1 \\pmod{561}$.\n    No term is congruent to $-1 \\pmod{561}$, so $561$ is not a strong pseudoprime to base $2$.\n\n3.  For $n=645$:\n    $n-1 = 644 = 4 \\times 161 = 2^2 \\times 161$. So, $s=2, d=161$.\n    The chain is $x_0 \\equiv 2^{161} \\equiv 257 \\pmod{645}$ and $x_1 \\equiv 257^2 \\equiv 259 \\pmod{645}$.\n    No term is congruent to $-1 \\pmod{645}$, so $645$ is not a strong pseudoprime to base $2$.\n\n4.  For $n=1105$:\n    $n-1 = 1104 = 16 \\times 69 = 2^4 \\times 69$. So, $s=4, d=69$.\n    The chain is $x_0 \\equiv 2^{69} \\equiv 967 \\pmod{1105}$, $x_1 \\equiv 967^2 \\equiv 259 \\pmod{1105}$, $x_2 \\equiv 259^2 \\equiv 781 \\pmod{1105}$, and $x_3 \\equiv 781^2 \\equiv 1 \\pmod{1105}$.\n    No term is congruent to $-1 \\pmod{1105}$, so $1105$ is not a strong pseudoprime to base $2$.\n\n5.  For $n=1387$:\n    $n-1 = 1386 = 2 \\times 693 = 2^1 \\times 693$. So, $s=1, d=693$.\n    The chain has only one term: $x_0 \\equiv 2^{693} \\equiv 512 \\pmod{1387}$.\n    This value is neither $1$ nor $-1 \\pmod{1387}$, so $1387$ is not a strong pseudoprime to base $2$.\n\n6.  For $n=1729$:\n    $n-1 = 1728 = 64 \\times 27 = 2^6 \\times 27$. So, $s=6, d=27$.\n    The chain begins $x_0 \\equiv 2^{27} \\equiv 645 \\pmod{1729}$, $x_1 \\equiv 645^2 \\equiv 1065 \\pmod{1729}$, and $x_2 \\equiv 1065^2 \\equiv 1 \\pmod{1729}$.\n    No term is congruent to $-1 \\pmod{1729}$, so $1729$ is not a strong pseudoprime to base $2$.\n\n7.  For $n=1905$:\n    $n-1 = 1904 = 16 \\times 119 = 2^4 \\times 119$. So, $s=4, d=119$.\n    The chain is $x_0 \\equiv 2^{119} \\equiv 128 \\pmod{1905}$, $x_1 \\equiv 128^2 \\equiv 1144 \\pmod{1905}$, $x_2 \\equiv 1144^2 \\equiv 1606 \\pmod{1905}$, and $x_3 \\equiv 1606^2 \\equiv 1 \\pmod{1905}$.\n    No term is congruent to $-1 \\pmod{1905}$, so $1905$ is not a strong pseudoprime to base $2$.\n\n8.  For $n=2047$:\n    $n=2047 = 23 \\times 89$ is composite.\n    $n-1 = 2046 = 2 \\times 1023 = 2^1 \\times 1023$. Thus, $s=1$ and $d=1023$.\n    We must test if $2^d \\equiv 1 \\pmod{n}$ or $2^d \\equiv -1 \\pmod{n}$.\n    We compute $x_0 \\equiv 2^d \\pmod n \\equiv 2^{1023} \\pmod{2047}$.\n    The number $2047$ is related to a Mersenne number, as $2^{11}-1 = 2047$. Thus, $2^{11} \\equiv 1 \\pmod{2047}$.\n    The exponent $d=1023$ can be written as $1023 = 11 \\times 93$.\n    Therefore, $2^{1023} = 2^{11 \\times 93} = (2^{11})^{93} \\equiv 1^{93} \\equiv 1 \\pmod{2047}$.\n    The condition $a^d \\equiv 1 \\pmod{n}$ is satisfied.\n    Thus, $2047$ is a strong pseudoprime to base $2$.\n\nSince all smaller base-2 Fermat pseudoprimes have been shown to fail the strong pseudoprime test for base $2$, $2047$ is the smallest such number.\n\nTo confirm, we exhibit the Miller-Rabin chain. For $n=2047$, we have $s=1$ and $d=1023$. The chain consists of a single term for $r=s-1=0$:\n$x_0 \\equiv 2^d \\pmod n \\equiv 2^{1023} \\pmod{2047} \\equiv 1 \\pmod{2047}$.\nThe test passes because $x_0 \\equiv 1$, satisfying the first condition of the definition.", "answer": "$$\n\\boxed{2047}\n$$", "id": "3088867"}]}