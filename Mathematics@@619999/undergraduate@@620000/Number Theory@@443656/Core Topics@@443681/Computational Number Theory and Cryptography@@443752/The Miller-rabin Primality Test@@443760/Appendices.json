{"hands_on_practices": [{"introduction": "The Miller-Rabin primality test always begins with a crucial algebraic preparation. Before we can test a number $n$, we must first express $n-1$ in the form $2^s d$, where $d$ is an odd number. This practice solidifies your ability to perform this essential decomposition, a step rooted in the unique prime factorization of integers. [@problem_id:3092099]", "problem": "In the Miller–Rabin primality test, one begins by writing $n-1$ as a product $2^{s} d$ where $s$ is a nonnegative integer and $d$ is odd. Justify the existence and uniqueness of such a decomposition by appealing to the Fundamental Theorem of Arithmetic and the definition of the highest power of $2$ dividing a positive integer, and then carry out this decomposition explicitly for $n=2047$ and $n=221$. Verify that the values $s$ and $d$ you find satisfy $n-1=2^{s} d$ and that $d$ is odd in each case. Provide your final answer as a row matrix $\\left(s_{2047}, d_{2047}, s_{221}, d_{221}\\right)$, and give exact integers.", "solution": "The problem statement is valid. It is a well-posed question in elementary number theory, directly related to the standard procedure of the Miller-Rabin primality test. It requires a formal justification for a number-theoretic decomposition and its application to specific integer inputs.\n\nThe problem asks for two main tasks: first, to justify the existence and uniqueness of the decomposition of a positive integer $n-1$ into the form $2^s d$ where $s$ is a non-negative integer and $d$ is an odd integer; second, to perform this decomposition for $n=2047$ and $n=221$.\n\nFirst, we address the justification of existence and uniqueness. Let $N$ be a positive integer, which in the context of the problem is $n-1$. We wish to show that there exist unique integers $s \\ge 0$ and odd $d > 0$ such that $N = 2^s d$.\n\nThe justification rests upon the Fundamental Theorem of Arithmetic, which states that every integer greater than $1$ can be represented uniquely as a product of prime numbers, up to the order of the factors.\n\n**Existence of the decomposition:**\nLet $N$ be any positive integer.\nCase 1: $N$ is odd. In this case, the prime factorization of $N$ contains no factors of the prime $2$. We can write $N = 2^0 \\cdot N$. Here, we can set $s=0$ and $d=N$. Since $s=0$ is a non-negative integer and $d=N$ is odd by hypothesis, this decomposition exists.\n\nCase 2: $N$ is even. Since $N$ is even, it is divisible by $2$. By the Fundamental Theorem of Arithmetic, $N$ has a unique prime factorization. We can write this factorization by explicitly separating the prime factor $2$:\n$$N = 2^{e_1} p_2^{e_2} p_3^{e_3} \\cdots p_k^{e_k}$$\nwhere $2, p_2, \\dots, p_k$ are distinct prime numbers and $e_1, e_2, \\dots, e_k$ are positive integers. Since $N$ is even, the exponent $e_1$ of the prime $2$ must be at least $1$, i.e., $e_1 \\ge 1$. The other prime factors $p_2, \\dots, p_k$ must all be odd primes.\nLet us define $s = e_1$ and $d = p_2^{e_2} p_3^{e_3} \\cdots p_k^{e_k}$.\nBy this definition, $s$ is a positive integer (and thus non-negative). The integer $d$ is a product of odd primes raised to various powers. The product of any number of odd integers is always odd. Therefore, $d$ is a positive odd integer. We have thus constructed the desired decomposition $N = 2^s d$.\nIn both cases, such a decomposition exists.\n\n**Uniqueness of the decomposition:**\nSuppose there are two such decompositions for the same integer $N$:\n$$N = 2^{s_1} d_1 = 2^{s_2} d_2$$\nwhere $s_1, s_2$ are non-negative integers and $d_1, d_2$ are positive odd integers.\nBy definition, $d_1$ and $d_2$ are not divisible by $2$. This means that their prime factorizations consist entirely of odd primes.\nThe expressions $2^{s_1} d_1$ and $2^{s_2} d_2$ represent the prime factorization of $N$, where the factor $2$ is explicitly separated. The Fundamental Theorem of Arithmetic guarantees that the prime factorization of $N$ is unique. This uniqueness applies to the primes themselves and their exponents.\nThe exponent of the prime $2$ in the unique factorization of $N$ must be a single, well-defined value. In the first decomposition, this exponent is $s_1$. In the second, it is $s_2$. For the factorizations to be identical, we must have $s_1 = s_2$.\nIf $s_1 = s_2$, then our original equation $2^{s_1} d_1 = 2^{s_2} d_2$ simplifies to $d_1 = d_2$.\nThus, the integers $s$ and $d$ are uniquely determined. The integer $s$ is the highest non-negative integer such that $2^s$ divides $N$. This is also known as the $2$-adic valuation of $N$, denoted $\\nu_2(N)$. The integer $d$ is then uniquely given by $d = N / 2^s$.\n\nNext, we carry out the explicit decomposition for the given values of $n$.\n\nFor $n=2047$:\nWe need to decompose $n-1 = 2047 - 1 = 2046$.\nWe find the highest power of $2$ that divides $2046$ by successive division:\n$2046 \\div 2 = 1023$.\nThe number $1023$ is odd, so we cannot divide by $2$ any further.\nThus, the highest power of $2$ dividing $2046$ is $2^1$.\nWe can write $2046 = 2^1 \\cdot 1023$.\nThis is in the form $2^s d$, so for $n=2047$, we have $s_{2047} = 1$ and $d_{2047} = 1023$.\n**Verification:** $s_{2047}=1$ is a non-negative integer. $d_{2047}=1023$ is an odd integer. The product is $2^1 \\cdot 1023 = 2 \\cdot 1023 = 2046$, which equals $n-1$. The values are correct.\n\nFor $n=221$:\nWe need to decompose $n-1 = 221 - 1 = 220$.\nWe find the highest power of $2$ that divides $220$:\n$220 \\div 2 = 110$.\n$110 \\div 2 = 55$.\nThe number $55$ is odd, so we stop.\nThe highest power of $2$ dividing $220$ is $2^2$.\nWe can write $220 = 2^2 \\cdot 55$.\nThis is in the form $2^s d$, so for $n=221$, we have $s_{221} = 2$ and $d_{221} = 55$.\n**Verification:** $s_{221}=2$ is a non-negative integer. $d_{221}=55$ is an odd integer. The product is $2^2 \\cdot 55 = 4 \\cdot 55 = 220$, which equals $n-1$. The values are correct.\n\nThe final answer requires the values in a row matrix $(s_{2047}, d_{2047}, s_{221}, d_{221})$.\nSubstituting our calculated values: $(1, 1023, 2, 55)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 1023 & 2 & 55\n\\end{pmatrix}\n}\n$$", "id": "3092099"}, {"introduction": "To truly understand a primality test, it's vital to see how it behaves with a number that is actually prime. This exercise walks you through the Miller-Rabin test for the prime number $p=29$, demonstrating the theoretical 'pass' condition. You will trace the sequence of modular squarings and verify that it adheres to the strict pattern expected for a prime number, where the sequence must encounter $-1$ right before it reaches $1$. [@problem_id:3092066]", "problem": "Let $p$ be an odd prime and let $a$ be an integer with $\\gcd(a,p)=1$. The Miller–Rabin primality test (MR) is based on Fermat's little theorem and properties of the multiplicative group modulo $p$. Starting from Fermat's little theorem, which states that $a^{p-1} \\equiv 1 \\pmod p$, explain why writing $p-1=2^{s}d$ with $d$ odd creates a chain of squarings\n$$\nx_{0} \\equiv a^{d} \\pmod p,\\quad x_{1} \\equiv x_{0}^{2} \\pmod p,\\quad \\ldots,\\quad x_{s} \\equiv x_{s-1}^{2} \\pmod p,\n$$\nthat terminates at $x_{s} \\equiv 1 \\pmod p$, and why, in a prime modulus, the only possible values immediately preceding $1$ in this chain are $1$ or $-1$ modulo $p$.\n\nFor the specific case $p=29$ and base $a=10$:\n- Compute the decomposition $p-1=2^{s}d$ with $d$ odd, and determine $x_{0} \\equiv a^{d} \\pmod p$.\n- Square successively to obtain $x_{1}, x_{2}$ as needed, and verify that the Miller–Rabin test passes by reaching $-1$ or $1$ at the appropriate stage.\n\nReport, as your final numeric answer, the minimal integer $t$ with $0 \\leq t < s$ such that $x_{t} \\equiv -1 \\pmod p$. If $x_{0} \\equiv -1 \\pmod p$, then $t=0$. If no such $t$ exists, define $t=s$.", "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It is based on established principles of number theory, specifically Fermat's little theorem and the properties of quadratic residues modulo a prime number, which form the basis of the Miller-Rabin primality test. The problem is self-contained, provides all necessary information, and asks for a verifiable result. Therefore, a full solution is warranted.\n\nThe problem asks for two conceptual explanations followed by a specific computation.\n\nFirst, we address the conceptual parts. Let $p$ be an odd prime and $a$ be an integer such that $\\gcd(a,p)=1$. We are given the decomposition of $p-1$ as $p-1=2^{s}d$, where $d$ is an odd integer and $s \\ge 1$ since $p-1$ is even. The sequence is defined by $x_{0} \\equiv a^{d} \\pmod p$ and $x_{k} \\equiv x_{k-1}^{2} \\pmod p$ for $k \\ge 1$.\n\nThe first task is to explain why the chain terminates at $x_{s} \\equiv 1 \\pmod p$.\nWe can express each term $x_k$ directly in terms of $a$, $d$, and $k$.\nThe base case is $x_{0} \\equiv a^{d} \\pmod p$.\nFor $k=1$, we have $x_{1} \\equiv x_{0}^{2} \\equiv (a^{d})^{2} \\equiv a^{d \\cdot 2^{1}} \\pmod p$.\nFor $k=2$, we have $x_{2} \\equiv x_{1}^{2} \\equiv (a^{d \\cdot 2^{1}})^{2} \\equiv a^{d \\cdot 2^{2}} \\pmod p$.\nBy mathematical induction, it is clear that for any $k \\ge 0$, the $k$-th term in the sequence is given by:\n$$x_{k} \\equiv a^{d \\cdot 2^{k}} \\pmod p$$\nTo find the terminal element of the chain, $x_s$, we substitute $k=s$:\n$$x_{s} \\equiv a^{d \\cdot 2^{s}} \\pmod p$$\nBy the given decomposition of $p-1$, we have $2^{s}d = p-1$. Substituting this into the exponent gives:\n$$x_{s} \\equiv a^{p-1} \\pmod p$$\nAccording to Fermat's little theorem, for a prime $p$ and an integer $a$ not divisible by $p$ (i.e., $\\gcd(a,p)=1$), it holds that $a^{p-1} \\equiv 1 \\pmod p$.\nTherefore, we can conclude that the chain of squarings necessarily terminates at $x_{s} \\equiv 1 \\pmod p$.\n\nThe second task is to explain why the only possible values immediately preceding $1$ in this chain are $1$ or $-1$ modulo $p$.\nSuppose for some $k$ where $0  k \\le s$, we have $x_{k} \\equiv 1 \\pmod p$. We are interested in the value of the preceding term, $x_{k-1}$. The relationship between these terms is given by $x_{k} \\equiv x_{k-1}^{2} \\pmod p$.\nSubstituting $x_{k} \\equiv 1 \\pmod p$, we get the congruence:\n$$x_{k-1}^{2} \\equiv 1 \\pmod p$$\nThis can be rewritten as:\n$$x_{k-1}^{2} - 1 \\equiv 0 \\pmod p$$\nFactoring the left side as a difference of squares yields:\n$$(x_{k-1} - 1)(x_{k-1} + 1) \\equiv 0 \\pmod p$$\nThis means that the prime number $p$ must divide the product $(x_{k-1} - 1)(x_{k-1} + 1)$. A fundamental property of prime numbers (Euclid's lemma) states that if a prime divides a product of two integers, it must divide at least one of the integers. Thus, we have two possibilities:\n1. $p$ divides $(x_{k-1} - 1)$, which means $x_{k-1} - 1 \\equiv 0 \\pmod p$, or $x_{k-1} \\equiv 1 \\pmod p$.\n2. $p$ divides $(x_{k-1} + 1)$, which means $x_{k-1} + 1 \\equiv 0 \\pmod p$, or $x_{k-1} \\equiv -1 \\pmod p$.\nThese are the only two solutions for the square root of $1$ in the field of integers modulo a prime $p$. Therefore, if a term $x_k$ in the chain is $1$, its predecessor $x_{k-1}$ must be either $1$ or $-1$ modulo $p$.\n\nNow, we proceed with the specific case for $p=29$ and base $a=10$.\nFirst, we compute the decomposition $p-1 = 2^{s}d$.\nGiven $p=29$, we have $p-1 = 28$.\nFactoring out powers of $2$: $28 = 4 \\times 7 = 2^{2} \\times 7$.\nComparing this with $p-1=2^{s}d$, we identify $s=2$ and $d=7$. The value $d=7$ is odd, as required.\n\nNext, we compute $x_{0} \\equiv a^{d} \\pmod p$.\n$$x_{0} \\equiv 10^{7} \\pmod{29}$$\nWe can compute this using modular exponentiation (binary exponentiation):\n$10^{1} \\equiv 10 \\pmod{29}$\n$10^{2} \\equiv 100 \\equiv 3 \\times 29 + 13 \\equiv 13 \\pmod{29}$\n$10^{4} \\equiv 13^{2} \\equiv 169 \\equiv 5 \\times 29 + 24 \\equiv 24 \\equiv -5 \\pmod{29}$\nSince the exponent is $7 = 4+2+1$, we have:\n$x_{0} \\equiv 10^{7} \\equiv 10^{4} \\cdot 10^{2} \\cdot 10^{1} \\pmod{29}$\n$x_{0} \\equiv 24 \\cdot 13 \\cdot 10 \\pmod{29}$\nFirst, $24 \\cdot 13 \\equiv (-5) \\cdot 13 = -65 \\pmod{29}$. Since $-65 = -3 \\times 29 + 22 = -87 + 22$, we have $-65 \\equiv 22 \\pmod{29}$.\nThen, $22 \\cdot 10 = 220 \\pmod{29}$. Since $220 = 7 \\times 29 + 17 = 203 + 17$, we have $220 \\equiv 17 \\pmod{29}$.\nSo, $x_{0} \\equiv 17 \\pmod{29}$.\n\nThe Miller-Rabin test passes if either $x_{0} \\equiv 1 \\pmod p$ or one of the subsequent terms $x_t$ is congruent to $-1 \\pmod p$ for $0 \\le t  s$.\nHere, $x_{0} = 17 \\not\\equiv 1 \\pmod{29}$. Also, $x_{0} \\not\\equiv -1 \\pmod{29}$. So we proceed to compute $x_1$.\nThe chain of squarings is $x_{0}, x_{1}, \\ldots, x_{s}$, which is $x_{0}, x_{1}, x_{2}$ for $s=2$.\nWe compute $x_{1} \\equiv x_{0}^{2} \\pmod{29}$:\n$$x_{1} \\equiv 17^{2} \\pmod{29}$$\n$17^{2} = 289$. We divide $289$ by $29$: $289 = 9 \\times 29 + 28 = 261 + 28$.\nThus, $x_{1} \\equiv 28 \\pmod{29}$.\nSince $28 \\equiv -1 \\pmod{29}$, we have found that $x_{1} \\equiv -1 \\pmod{29}$.\nThe Miller-Rabin test passes because we found a term congruent to $-1$ before the end of the chain. For completeness, we compute $x_2$:\n$x_2 \\equiv x_1^2 \\equiv (-1)^2 \\equiv 1 \\pmod{29}$, which confirms the chain terminates as expected.\nThe sequence of congruences is $x_0 \\equiv 17$, $x_1 \\equiv -1$, $x_2 \\equiv 1 \\pmod{29}$.\n\nThe final task is to find the minimal integer $t$ with $0 \\leq t  s$ such that $x_{t} \\equiv -1 \\pmod p$.\nHere, $s=2$, so we are looking for the minimal $t \\in \\{0, 1\\}$.\nFor $t=0$: $x_{0} \\equiv 17 \\pmod{29}$, which is not $-1 \\pmod{29}$.\nFor $t=1$: $x_{1} \\equiv -1 \\pmod{29}$.\nThe condition is met for $t=1$. Since it is not met for any smaller non-negative integer, the minimal value for $t$ is $1$.", "answer": "$$\\boxed{1}$$", "id": "3092066"}, {"introduction": "Perhaps the most compelling feature of the Miller-Rabin test is what happens when it uncovers a composite number. The result is not just a simple 'composite' verdict; it can reveal deep structural information. This practice demonstrates how finding a nontrivial square root of $1$ modulo $n$ provides irrefutable proof of compositeness and, remarkably, gives us a direct and efficient method to find the factors of $n$. [@problem_id:3092062]", "problem": "Let $n=341$. Begin from Fermat's little theorem: for a prime $p$ and any integer $a$ with $\\gcd(a,p)=1$, one has $a^{p-1} \\equiv 1 \\pmod{p}$. The Miller–Rabin primality test builds on this by probing the structure of residues modulo an odd integer $n$ through repeated squaring. Write $n-1$ in the form $2^{s} d$ with $d$ odd, choose a base $a=2$ with $\\gcd(2,n)=1$, and compute the sequence defined by $x_{0} \\equiv 2^{d} \\pmod{n}$ and $x_{i+1} \\equiv x_{i}^{2} \\pmod{n}$ for $i \\ge 0$. Using only the properties of modular arithmetic and the above fundamental fact, determine whether this sequence reveals a nontrivial square root of $1$ modulo $n$, meaning an $x$ such that $x^{2} \\equiv 1 \\pmod{n}$ but $x \\not\\equiv \\pm 1 \\pmod{n}$. If such an $x$ is found, explain how it certifies that $n$ is composite and use it to obtain a nontrivial factorization of $n$ by computing two greatest common divisors with $n$. Report your final results as a single row matrix containing the nontrivial square root you found followed by the two prime factors of $n$, in exact integer form. No rounding is required.", "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, and complete. All conditions are met for a valid problem in number theory. We proceed with the solution.\n\nThe problem asks to perform a specific set of steps related to the Miller-Rabin primality test on the integer $n=341$ with the base $a=2$. The goal is to determine if a nontrivial square root of $1$ modulo $n$ is found and, if so, to use it to factor $n$.\n\nFirst, we must decompose $n-1$ into the form $2^s d$, where $d$ is an odd integer and $s \\ge 1$.\nGiven $n=341$, we have $n-1 = 340$.\nTo find $s$ and $d$, we factor out powers of $2$ from $340$:\n$$340 = 2 \\times 170 = 2 \\times (2 \\times 85) = 2^2 \\times 85$$\nHere, $d = 85$ is odd. Thus, we have $s=2$ and $d=85$.\n\nThe problem specifies using the base $a=2$. A prerequisite for the test is that $\\gcd(a, n) = 1$.\nWe check this condition: $\\gcd(2, 341) = 1$, because $341$ is an odd number. The condition holds.\n\nNext, we are instructed to compute the sequence defined by $x_0 \\equiv a^d \\pmod{n}$ and $x_{i+1} \\equiv x_i^2 \\pmod{n}$. This sequence is $a^d, a^{2d}, a^{4d}, \\dots, a^{2^{s-1}d}$ evaluated modulo $n$.\nFor our values, we compute $x_0 \\equiv 2^{85} \\pmod{341}$.\nWe can perform this calculation using modular exponentiation. An efficient approach is to first note that $341 = 11 \\times 31$. By Fermat's Little Theorem, for a prime $p$ and integer $a$ not divisible by $p$, $a^{p-1} \\equiv 1 \\pmod{p}$.\nFor $p=11$, $2^{11-1} = 2^{10} \\equiv 1 \\pmod{11}$.\nFor $p=31$, $2^5 = 32 \\equiv 1 \\pmod{31}$, which implies $2^{10} = (2^5)^2 \\equiv 1^2 \\equiv 1 \\pmod{31}$.\nSince $2^{10} - 1$ is divisible by both $11$ and $31$, and $\\gcd(11, 31) = 1$, it must be divisible by their product $11 \\times 31 = 341$. Therefore, $2^{10} \\equiv 1 \\pmod{341}$.\n\nUsing this property, we can simplify the computation of $x_0$:\n$$x_0 \\equiv 2^{85} \\pmod{341}$$\n$$2^{85} = 2^{10 \\times 8 + 5} = (2^{10})^8 \\cdot 2^5$$\n$$x_0 \\equiv (1)^8 \\cdot 2^5 \\pmod{341}$$\n$$x_0 \\equiv 32 \\pmod{341}$$\n\nThe first term in our sequence is $x_0 = 32$. The Miller-Rabin test checks if this term is $1$ or $-1$.\n$$32 \\not\\equiv 1 \\pmod{341}$$\n$$32 \\not\\equiv -1 \\pmod{341} \\quad (\\text{since } -1 \\equiv 340 \\pmod{341})$$\nSince $x_0$ is not $\\pm 1$, we proceed to the next term in the sequence, $x_1$.\n$$x_1 \\equiv x_0^2 \\pmod{341}$$\n$$x_1 \\equiv 32^2 \\pmod{341}$$\n$$x_1 \\equiv 1024 \\pmod{341}$$\nTo simplify $1024 \\pmod{341}$, we perform division: $1024 = 3 \\times 341 + 1$.\nSo, $x_1 \\equiv 1 \\pmod{341}$.\n\nWe have found a term in the sequence, $x_1$, which is congruent to $1 \\pmod{n}$. The core of the Miller-Rabin test lies in examining the preceding term, $x_0$. We found that $x_0 = 32$ and $x_0^2 \\equiv 1 \\pmod{341}$. However, $x_0$ itself is not congruent to $1$ or $-1$ modulo $341$.\nThis means that $x_0=32$ is a nontrivial square root of $1$ modulo $341$.\n\nThe existence of such a root is definitive proof that $n$ is composite. If $n$ were a prime number, the congruence $x^2 \\equiv 1 \\pmod n$ would be equivalent to the polynomial equation $x^2-1=0$ in the field $\\mathbb{Z}_n$. By Lagrange's theorem, a polynomial of degree $k$ has at most $k$ roots in a field. For $x^2-1=0$, the roots are always $x=1$ and $x=-1$. The discovery of a third root, $x=32$, proves that the ring of integers modulo $n$, $\\mathbb{Z}_n$, is not a field, and therefore $n$ is not prime.\n\nThe relation $x_0^2 \\equiv 1 \\pmod{n}$ implies $x_0^2 - 1 \\equiv 0 \\pmod{n}$, which can be written as $(x_0-1)(x_0+1) \\equiv 0 \\pmod{n}$. This means $n$ divides the product $(x_0-1)(x_0+1)$.\nSince $x_0 \\not\\equiv 1 \\pmod{n}$, $n$ does not divide $x_0-1$.\nSince $x_0 \\not\\equiv -1 \\pmod{n}$, $n$ does not divide $x_0+1$.\nFor $n$ to divide the product without dividing either factor, $n$ must be composite, and its factors must be distributed between $(x_0-1)$ and $(x_0+1)$. Specifically, $\\gcd(x_0 - 1, n)$ and $\\gcd(x_0 + 1, n)$ must be nontrivial factors of $n$.\n\nWe now compute these factors using our nontrivial square root $x_0=32$.\nThe first factor is $\\gcd(x_0 - 1, n) = \\gcd(32 - 1, 341) = \\gcd(31, 341)$.\nBy trial division, we see that $341 = 11 \\times 31$. Therefore, $\\gcd(31, 341) = 31$.\n\nThe second factor is $\\gcd(x_0 + 1, n) = \\gcd(32 + 1, 341) = \\gcd(33, 341)$.\nUsing the Euclidean algorithm or prime factorization: $33 = 3 \\times 11$ and $341 = 11 \\times 31$. The greatest common divisor is $11$.\nSo, $\\gcd(33, 341) = 11$.\n\nThe procedure has revealed the nontrivial square root $32$ and the factors $11$ and $31$ of $n=341$. We can verify that $11 \\times 31 = 341$. The problem requires reporting these three numbers in a single row matrix.\n\nThe nontrivial square root found is $32$.\nThe two prime factors found are $11$ and $31$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n32  11  31\n\\end{pmatrix}\n}\n$$", "id": "3092062"}]}