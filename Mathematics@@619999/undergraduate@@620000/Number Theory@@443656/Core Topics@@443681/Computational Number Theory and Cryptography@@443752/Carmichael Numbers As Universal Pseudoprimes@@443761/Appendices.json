{"hands_on_practices": [{"introduction": "Understanding a mathematical concept often begins with its simplest example. This practice guides you through the discovery of the smallest Carmichael number, not by memorization, but through logical deduction from first principles [@problem_id:3082961]. By systematically applying the constraints derived from Korselt's criterion, you will see how theoretical properties can transform an infinite search space into a manageable puzzle, building a deep, constructive understanding of these fascinating numbers.", "problem": "Let $n$ be a composite integer that is a Carmichael number, meaning that for every integer $a$ with $\\gcd(a,n)=1$ one has $a^{n-1} \\equiv 1 \\pmod{n}$. It is known (Korselt’s criterion) that a composite integer $n$ is a Carmichael number if and only if $n$ is square-free and, for every prime $p$ dividing $n$, one has $p-1 \\mid n-1$. Starting from these foundational definitions and facts, determine the smallest Carmichael number. Your reasoning must:\n\n- Establish structural constraints on Carmichael numbers (including parity and the number of prime factors) from the given definitions and Korselt’s criterion.\n- Specialize to the case $n=3qr$ with primes $3<q<r$ and derive the divisibility constraints forced by Korselt’s criterion, then solve these constraints to locate the smallest such $n$.\n- Verify the universality property by checking the Korselt conditions explicitly for the candidate $n$ and then deducing $a^{n-1} \\equiv 1 \\pmod{n}$ for all integers $a$ with $\\gcd(a,n)=1$ using appropriate foundational results.\n\nExpress your final answer as the exact integer value of the smallest Carmichael number. No rounding is required.", "solution": "The problem requires finding the smallest Carmichael number by first establishing structural properties, then conducting a systematic search, and finally verifying the result.\n\nA Carmichael number $n$ is a composite integer such that $a^{n-1} \\equiv 1 \\pmod{n}$ for all integers $a$ with $\\gcd(a,n)=1$. Korselt's criterion states that a composite integer $n$ is a Carmichael number if and only if $n$ is square-free and for every prime factor $p$ of $n$, $p-1$ divides $n-1$.\n\n**Step 1: Structural Constraints on Carmichael Numbers**\n\nLet $n$ be a Carmichael number. According to Korselt's criterion, $n$ must be square-free, meaning $n$ is a product of distinct primes, say $n = p_1 p_2 \\cdots p_k$. Since $n$ is composite, it must have at least two distinct prime factors, so $k \\ge 2$.\n\n1.  **Parity of $n$**: We will show that $n$ must be odd. Assume, for the sake of contradiction, that $n$ is even. Since $n$ is square-free, one of its prime factors must be $2$. Let $p_1=2$. Then $n = 2 \\cdot p_2 \\cdots p_k$, where $p_2, \\dots, p_k$ are distinct odd primes. As $n$ is even, $n-1$ is odd.\n    Korselt's criterion requires that for any prime factor $p_i$ of $n$, $p_i-1$ must divide $n-1$. Let's consider an odd prime factor $p_i$ (where $i \\ge 2$). For such a prime, $p_i-1$ is an even number. However, an even number ($p_i-1$) cannot divide an odd number ($n-1$). This is a contradiction. Therefore, the initial assumption that $n$ is even must be false. All Carmichael numbers must be odd.\n\n2.  **Number of Prime Factors**: We will show that $n$ must have at least three prime factors. We already know $n$ must be odd and composite, so $k \\ge 2$. Let's assume $n$ has exactly two prime factors, $n=pq$, where $p$ and $q$ are distinct odd primes with $p<q$.\n    By Korselt's criterion:\n    - $p-1 \\mid n-1 \\implies p-1 \\mid pq-1$. We can write $pq-1 = q(p-1) + q-1$. This implies $p-1 \\mid q-1$.\n    - $q-1 \\mid n-1 \\implies q-1 \\mid pq-1$. We can write $pq-1 = p(q-1) + p-1$. This implies $q-1 \\mid p-1$.\n    Since $p$ and $q$ are primes, $p-1$ and $q-1$ are positive integers. The conditions $p-1 \\mid q-1$ and $q-1 \\mid p-1$ together imply $p-1 = q-1$, which means $p=q$. This contradicts the fact that $p$ and $q$ are distinct primes. Thus, a Carmichael number cannot be the product of two distinct primes.\n    Combining this with the fact that $n$ is composite, $n$ must be the product of at least three distinct odd primes.\n\n**Step 2: Searching for the Smallest Carmichael Number**\n\nBased on the derived properties, the smallest Carmichael number must be of the form $n = p_1 p_2 p_3 \\cdots$ where $p_i$ are distinct odd primes. To find the smallest such $n$, we should use the smallest possible odd primes. Let's try to construct $n$ with exactly three prime factors: $n=pqr$ with $3 \\le p < q < r$ being prime numbers.\n\nLet's test the smallest possible prime, $p=3$. So, $n=3qr$ with $3<q<r$.\nApplying Korselt's criterion, $p'-1 \\mid n-1$ for $p' \\in \\{3,q,r\\}$:\n- For $p'=3$: $3-1 = 2 \\mid 3qr-1$. Since $3$, $q$, $r$ are odd primes, their product $n=3qr$ is odd, so $n-1$ is even. This condition is always satisfied.\n- For $p'=q$: $q-1 \\mid 3qr-1$. We rewrite $3qr-1 = 3r(q-1) + 3r-1$. This requires $q-1 \\mid 3r-1$.\n- For $p'=r$: $r-1 \\mid 3qr-1$. We rewrite $3qr-1 = 3q(r-1) + 3q-1$. This requires $r-1 \\mid 3q-1$.\n\nFrom $r-1 \\mid 3q-1$ and the fact that $r>q>3$, we have $r-1>q-1$. Also, $3q-1 < 3(r-1)$. Therefore, $3q-1$ must be a multiple of $r-1$. Let $3q-1 = k(r-1)$ for some integer $k$. Since $q<r$, $3q-1 < 3r-1$, so $k(r-1) < 3r-1$. This implies $kr-k < 3r-1$. If $k \\ge 3$, $kr \\ge 3r$, which leads to a contradiction. So $k$ must be $1$ or $2$.\n- If $k=1$: $3q-1 = r-1 \\implies r=3q$. Since $q>3$, $3q$ is a composite number, so $r$ cannot be prime. This case is impossible.\n- If $k=2$: $3q-1 = 2(r-1) \\implies 2r = 3q+1 \\implies r = \\frac{3q+1}{2}$. This seems plausible.\n\nNow we substitute this expression for $r$ into the other condition, $q-1 \\mid 3r-1$:\n$q-1 \\mid 3\\left(\\frac{3q+1}{2}\\right) - 1 = \\frac{9q+3-2}{2} = \\frac{9q+1}{2}$.\nThis means $q-1$ divides $\\frac{9q+1}{2}$, or $2(q-1)$ divides $9q+1$.\nLet $A = q-1$. We have $2A \\mid 9(A+1)+1 = 9A+10$. Since $2A \\mid 9(2A) = 18A$, we can say that if $2A \\mid 9A+10$, then $2A \\mid 2(9A+10)=18A+20$. Thus $2A \\mid (18A+20) - 18A = 20$. So $2(q-1) \\mid 20 \\implies q-1 \\mid 10$.\nThe divisors of $10$ are $1, 2, 5, 10$.\n- $q-1=1 \\implies q=2$. Ruled out ($q$ must be an odd prime $>3$).\n- $q-1=2 \\implies q=3$. Ruled out ($q>3$).\n- $q-1=5 \\implies q=6$. Ruled out (not prime).\n- $q-1=10 \\implies q=11$. This gives a prime $q=11$, which is $>3$. This is a valid candidate.\n\nNow we find $r$ using this value of $q$:\nFor $q=11$, $r = \\frac{3q+1}{2} = \\frac{3(11)+1}{2} = \\frac{34}{2} = 17$.\nThe number $17$ is prime and satisfies $r>q$ ($17>11$).\nSo, the smallest set of three primes starting with $3$ that could form a Carmichael number is $\\{3, 11, 17\\}$.\nThe candidate number is $n = 3 \\times 11 \\times 17 = 33 \\times 17 = 561$.\nA systematic search would show that using $p=5$ as the smallest prime, or trying prime combinations not in increasing order of size (which is done implicitly by our construction), would lead to larger Carmichael numbers. Thus, $561$ is the smallest candidate for a Carmichael number.\n\n**Step 3: Verification of the Candidate**\n\nWe must verify that $n=561$ is indeed a Carmichael number.\n1.  **Composite**: $561 = 3 \\times 11 \\times 17$, so it is composite.\n2.  **Square-free**: The prime factors $3, 11, 17$ are distinct, so it is square-free.\n3.  **Korselt's Divisibility Conditions**: We check if $p-1 \\mid n-1$ for each prime factor $p$. Here $n-1=560$.\n    - For $p=3$: $p-1 = 2$. $560 = 2 \\times 280$, so $2 \\mid 560$. The condition holds.\n    - For $p=11$: $p-1 = 10$. $560 = 10 \\times 56$, so $10 \\mid 560$. The condition holds.\n    - For $p=17$: $p-1 = 16$. $560 = 16 \\times 35$, so $16 \\mid 560$. The condition holds.\nSince all conditions of Korselt's criterion are satisfied, $n=561$ is a Carmichael number.\n\nFinally, we show how these conditions imply the Carmichael property $a^{n-1} \\equiv 1 \\pmod n$ for $\\gcd(a,n)=1$.\nLet $n=561$ and consider an integer $a$ such that $\\gcd(a, 561)=1$. This implies $\\gcd(a,3)=1$, $\\gcd(a,11)=1$, and $\\gcd(a,17)=1$.\n\n- Modulo $3$: By Fermat's Little Theorem, $a^{3-1} \\equiv a^2 \\equiv 1 \\pmod 3$. Since $2 \\mid 560$, we can write $560 = 2 \\times 280$. Then $a^{560} = (a^2)^{280} \\equiv 1^{280} \\equiv 1 \\pmod 3$.\n- Modulo $11$: By Fermat's Little Theorem, $a^{11-1} \\equiv a^{10} \\equiv 1 \\pmod{11}$. Since $10 \\mid 560$, we can write $560 = 10 \\times 56$. Then $a^{560} = (a^{10})^{56} \\equiv 1^{56} \\equiv 1 \\pmod{11}$.\n- Modulo $17$: By Fermat's Little Theorem, $a^{17-1} \\equiv a^{16} \\equiv 1 \\pmod{17}$. Since $16 \\mid 560$, we can write $560 = 16 \\times 35$. Then $a^{560} = (a^{16})^{35} \\equiv 1^{35} \\equiv 1 \\pmod{17}$.\n\nWe have the system of congruences:\n$$ \\begin{cases} a^{560} \\equiv 1 \\pmod 3 \\\\ a^{560} \\equiv 1 \\pmod{11} \\\\ a^{560} \\equiv 1 \\pmod{17} \\end{cases} $$\nSince $3, 11, 17$ are pairwise coprime, by the Chinese Remainder Theorem, there is a unique solution for $a^{560}$ modulo their product $3 \\times 11 \\times 17 = 561$.\nThe congruences show that $a^{560}-1$ is divisible by $3$, $11$, and $17$. Therefore, $a^{560}-1$ is divisible by their least common multiple, which is their product $561$.\nThis means $a^{560} \\equiv 1 \\pmod{561}$. This confirms that $561$ is a Carmichael number, and our systematic search indicates it is the smallest such number.\n\nThe final answer is the integer value of the smallest Carmichael number.", "answer": "$$\\boxed{561}$$", "id": "3082961"}, {"introduction": "The existence of pseudoprimes complicates primality testing, but not all pseudoprimes are created equal. This exercise explores the crucial distinction between a Fermat pseudoprime to a specific base and a universal pseudoprime (a Carmichael number) by analyzing the classic case of $n=341$ [@problem_id:3082957]. You will investigate why this number successfully masquerades as a prime for base $2$, yet fails the more stringent test for being a Carmichael number, thereby clarifying the limits of the Fermat primality test.", "problem": "Let $n=341$. Recall the following standard definitions. A composite integer $n$ is called a Fermat pseudoprime to base $a$ if $a^{n-1} \\equiv 1 \\pmod{n}$ while $n$ is composite. A Carmichael number is a composite integer $n$ such that $a^{n-1} \\equiv 1 \\pmod{n}$ for every integer $a$ with $\\gcd(a,n)=1$. Korselt’s criterion states that a composite integer $n$ is a Carmichael number if and only if $n$ is square-free and, for every prime $p$ dividing $n$, one has $p-1 \\mid n-1$.\n\nStarting from these definitions, establish that $n=341$ is a Fermat pseudoprime to base $2$ but is not a Carmichael number, and then determine the exact number $N$ of residue classes $a \\pmod{341}$ such that $a^{340} \\equiv 1 \\pmod{341}$.\n\nProvide your final answer as the exact integer $N$.", "solution": "The problem requires us to analyze the number $n=341$ with respect to the properties of Fermat pseudoprimes and Carmichael numbers, and then to calculate the number of solutions to a specific congruence. We will address each part of the problem systematically.\n\nFirst, we establish that $n=341$ is a Fermat pseudoprime to base $2$.\nA number $n$ is a Fermat pseudoprime to base $a$ if it is composite and satisfies $a^{n-1} \\equiv 1 \\pmod{n}$.\nWe are given $n=341$. We find its prime factorization: $341 = 11 \\times 31$. Since $11$ and $31$ are prime numbers, $n=341$ is a composite number.\nNext, we must verify the congruence $2^{341-1} \\equiv 1 \\pmod{341}$, which is $2^{340} \\equiv 1 \\pmod{341}$. We can use the Chinese Remainder Theorem by checking the congruence modulo the prime factors $11$ and $31$.\n1. Modulo $11$: According to Fermat's Little Theorem, since $11$ is prime and $\\gcd(2, 11) = 1$, we have $2^{11-1} \\equiv 2^{10} \\equiv 1 \\pmod{11}$. The exponent is $340 = 10 \\times 34$. Therefore,\n$$2^{340} = (2^{10})^{34} \\equiv 1^{34} \\equiv 1 \\pmod{11}$$\n2. Modulo $31$: We can compute powers of $2$ modulo $31$. We notice that $2^5 = 32 \\equiv 1 \\pmod{31}$. The exponent is $340 = 5 \\times 68$. Thus,\n$$2^{340} = (2^5)^{68} \\equiv 1^{68} \\equiv 1 \\pmod{31}$$\nSince $2^{340} \\equiv 1 \\pmod{11}$ and $2^{340} \\equiv 1 \\pmod{31}$, and given that $\\gcd(11, 31) = 1$, the Chinese Remainder Theorem implies that $2^{340} \\equiv 1 \\pmod{11 \\times 31}$, or $2^{340} \\equiv 1 \\pmod{341}$.\nAs $341$ is composite and satisfies $2^{340} \\equiv 1 \\pmod{341}$, it is a Fermat pseudoprime to base $2$.\n\nSecond, we establish that $n=341$ is not a Carmichael number.\nWe use Korselt's criterion, which is provided: a composite integer $n$ is a Carmichael number if and only if $n$ is square-free and for every prime $p$ dividing $n$, $p-1$ divides $n-1$.\nLet's check these conditions for $n=341$:\n1. $n=341$ is composite, which we have already shown.\n2. $n=341=11 \\times 31$ is square-free, as its prime factors appear with exponent $1$.\n3. For every prime factor $p$ of $n$, we must check if $p-1 \\mid n-1$. Here $n-1 = 340$.\n   - For the prime factor $p=11$, we check if $p-1=10$ divides $n-1=340$. Indeed, $340 = 10 \\times 34$, so $10 \\mid 340$. This condition holds.\n   - For the prime factor $p=31$, we check if $p-1=30$ divides $n-1=340$. We have $340 = 11 \\times 30 + 10$. Since the remainder is non-zero, $30$ does not divide $340$.\nSince the condition $p-1 \\mid n-1$ fails for the prime factor $p=31$, $n=341$ is not a Carmichael number according to Korselt's criterion.\n\nThird, we determine the number $N$ of residue classes $a \\pmod{341}$ such that $a^{340} \\equiv 1 \\pmod{341}$.\nThis is equivalent to finding the number of solutions to the polynomial congruence $x^{340} - 1 \\equiv 0 \\pmod{341}$.\nUsing the Chinese Remainder Theorem, we can break this into a system of congruences:\n$$a^{340} \\equiv 1 \\pmod{11}$$\n$$a^{340} \\equiv 1 \\pmod{31}$$\nWe find the number of solutions for each congruence separately.\n1. For $a^{340} \\equiv 1 \\pmod{11}$:\n   A solution cannot be $a \\equiv 0 \\pmod{11}$, since $0^{340} \\equiv 0 \\not\\equiv 1 \\pmod{11}$. So, any solution must be an element of the multiplicative group of integers modulo $11$, $(\\mathbb{Z}/11\\mathbb{Z})^\\times$, which has order $\\phi(11) = 10$.\n   By Fermat's Little Theorem, for any $a$ such that $\\gcd(a,11)=1$, we have $a^{10} \\equiv 1 \\pmod{11}$.\n   Since $340 = 10 \\times 34$, we have $a^{340} = (a^{10})^{34} \\equiv 1^{34} \\equiv 1 \\pmod{11}$.\n   This means the congruence holds for all elements in $(\\mathbb{Z}/11\\mathbb{Z})^\\times$. The number of such elements is $\\phi(11) = 10$. So there are $10$ solutions modulo $11$.\n\n2. For $a^{340} \\equiv 1 \\pmod{31}$:\n   Similarly, $a \\equiv 0 \\pmod{31}$ is not a solution. We are looking for solutions in the group $(\\mathbb{Z}/31\\mathbb{Z})^\\times$, which is a cyclic group of order $\\phi(31) = 30$.\n   The number of solutions to a congruence $x^k \\equiv 1 \\pmod{p}$ in $(\\mathbb{Z}/p\\mathbb{Z})^\\times$ is given by $\\gcd(k, p-1)$.\n   In our case, $k=340$ and $p=31$, so $p-1=30$. The number of solutions is $\\gcd(340, 30)$.\n   We compute the greatest common divisor:\n   $340 = 34 \\times 10 = 2 \\times 17 \\times 2 \\times 5 = 2^2 \\times 5 \\times 17$\n   $30 = 3 \\times 10 = 2 \\times 3 \\times 5$\n   $\\gcd(340, 30) = 2^1 \\times 5^1 = 10$.\n   Thus, there are $10$ solutions to $a^{340} \\equiv 1 \\pmod{31}$.\n\nBy the Chinese Remainder Theorem, for each pair of solutions $(r_{11}, r_{31})$, where $r_{11}$ is a solution modulo $11$ and $r_{31}$ is a solution modulo $31$, there exists a unique solution $a$ modulo $341$. The total number of solutions $N$ is the product of the number of solutions for each modulus.\n$N = (\\text{number of solutions mod } 11) \\times (\\text{number of solutions mod } 31) = 10 \\times 10 = 100$.\nTherefore, there are exactly $100$ residue classes $a \\pmod{341}$ such that $a^{340} \\equiv 1 \\pmod{341}$.", "answer": "$$\\boxed{100}$$", "id": "3082957"}, {"introduction": "With the foundational concepts established, this practice challenges you to apply your knowledge to a larger, more complex number. You will verify whether $n=41041$ is a Carmichael number, a task that reinforces the direct application of Korselt's criterion on a non-trivial example [@problem_id:3082962]. This exercise also highlights a more computationally efficient verification method: ensuring that $n-1$ is divisible by the least common multiple of all $p-1$ terms, a powerful shortcut rooted in the structure of multiplicative groups.", "problem": "Let $n=41041=7\\cdot 11\\cdot 13\\cdot 41$. A Carmichael number is a composite, squarefree integer $n$ such that for every integer $a$ with $\\gcd(a,n)=1$, one has $a^{n-1}\\equiv 1 \\pmod n$, making $n$ a universal Fermat pseudoprime. Using the characterization that such an $n$ is Carmichael if and only if it is squarefree and, for every prime $p$ dividing $n$, one has $p-1\\mid n-1$, proceed as follows:\n\n- Compute the set $\\{p-1: p\\mid n\\}$ and its least common multiple $L=\\operatorname{lcm}\\{p-1: p\\mid n\\}$.\n- Verify whether $p-1\\mid n-1$ holds for each prime $p\\mid n$ and conclude whether $n$ is a Carmichael number.\n- Report the value of $L$ as your final answer in exact form (no rounding).", "solution": "The problem requires the validation of $n=41041$ as a Carmichael number using Korselt's criterion and the computation of a specific least common multiple, $L$.\n\nFirst, we establish the given information. The integer is $n=41041$. Its prime factorization is provided as $n = 7 \\cdot 11 \\cdot 13 \\cdot 41$. The prime factors of $n$ are therefore $p_1=7$, $p_2=11$, $p_3=13$, and $p_4=41$.\n\nKorselt's criterion states that a composite integer $n$ is a Carmichael number if and only if two conditions are met:\n1. $n$ is squarefree.\n2. For every prime factor $p$ of $n$, the divisibility relation $p-1 \\mid n-1$ holds.\n\nLet us verify these conditions for $n=41041$.\n\nFirst condition: Is $n$ squarefree?\nThe prime factorization of $n$ is $7^1 \\cdot 11^1 \\cdot 13^1 \\cdot 41^1$. Since all prime factors appear with an exponent of $1$, there are no repeated prime factors. Thus, $n$ is squarefree. This condition is satisfied. Also, $n$ is clearly composite as it is a product of four distinct primes.\n\nSecond condition: Does $p-1 \\mid n-1$ for all prime factors $p$ of $n$?\nTo verify this, we first compute the set $\\{p-1 : p \\mid n\\}$ as instructed.\nFor $p_1=7$, we have $p_1-1 = 7-1 = 6$.\nFor $p_2=11$, we have $p_2-1 = 11-1 = 10$.\nFor $p_3=13$, we have $p_3-1 = 13-1 = 12$.\nFor $p_4=41$, we have $p_4-1 = 41-1 = 40$.\nThe set is $\\{6, 10, 12, 40\\}$.\n\nNext, we compute the least common multiple of this set, denoted by $L$.\n$L = \\operatorname{lcm}(6, 10, 12, 40)$.\nTo find the least common multiple, we determine the prime factorization of each number in the set:\n$6 = 2 \\cdot 3 = 2^1 \\cdot 3^1$\n$10 = 2 \\cdot 5 = 2^1 \\cdot 5^1$\n$12 = 4 \\cdot 3 = 2^2 \\cdot 3^1$\n$40 = 8 \\cdot 5 = 2^3 \\cdot 5^1$\nThe least common multiple is found by taking the highest power of each prime factor present in these factorizations. The prime factors are $2$, $3$, and $5$.\nThe highest power of $2$ is $2^3$.\nThe highest power of $3$ is $3^1$.\nThe highest power of $5$ is $5^1$.\nTherefore, $L = 2^3 \\cdot 3^1 \\cdot 5^1 = 8 \\cdot 3 \\cdot 5 = 120$.\n\nNow we must verify that $p-1 \\mid n-1$ for each $p \\in \\{7, 11, 13, 41\\}$. A more efficient way to do this is to use the property of the least common multiple. If $L = \\operatorname{lcm}(p_1-1, p_2-1, \\dots, p_k-1)$, then the condition that $p_i-1 \\mid n-1$ for all $i$ is equivalent to the single condition $L \\mid n-1$.\n\nWe need to calculate $n-1$:\n$n-1 = 41041 - 1 = 41040$.\n\nWe then check if $L \\mid n-1$, which is to say, we check if $120 \\mid 41040$. We perform the division:\n$$ \\frac{41040}{120} = \\frac{4104}{12} $$\nWe can simplify the division:\n$$ \\frac{4104}{12} = \\frac{3600 + 480 + 24}{12} = \\frac{3600}{12} + \\frac{480}{12} + \\frac{24}{12} = 300 + 40 + 2 = 342 $$\nSince the result of the division is an integer, $342$, the divisibility condition $120 \\mid 41040$ holds. This implies that $p-1 \\mid n-1$ for all prime factors $p$ of $n$.\n\nConclusion:\nSince $n=41041$ is a composite, squarefree integer, and for every prime $p$ dividing $n$, we have verified that $p-1 \\mid n-1$, both conditions of Korselt's criterion are satisfied. Therefore, $n=41041$ is a Carmichael number.\n\nThe problem requires reporting the value of $L$. As calculated, $L = 120$.", "answer": "$$\\boxed{120}$$", "id": "3082962"}]}