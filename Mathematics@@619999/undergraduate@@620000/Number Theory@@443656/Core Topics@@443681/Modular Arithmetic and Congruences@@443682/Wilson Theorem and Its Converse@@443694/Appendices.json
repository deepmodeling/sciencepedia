{"hands_on_practices": [{"introduction": "Wilson's Theorem provides a remarkable characterization of prime numbers through the congruence $(p-1)! \\equiv -1 \\pmod{p}$. This exercise allows you to explore the mechanism behind this theorem by working through small prime examples from first principles. By manually pairing elements with their unique multiplicative inverses modulo $p$, you will gain a concrete understanding of why only the elements $1$ and $p-1$ are left over in the product [@problem_id:3094034].", "problem": "Let $p$ be a prime and define $P(p) \\equiv \\prod_{a=1}^{p-1} a \\pmod{p}$. Using only the basic properties of modular arithmetic over a prime modulus—specifically, that every nonzero residue class modulo $p$ has a unique multiplicative inverse modulo $p$, and that an element $x$ is its own inverse (i.e., $x \\equiv x^{-1} \\pmod p$) if and only if $x^2 \\equiv 1 \\pmod p$—compute $P(p) \\pmod{p}$ for $p \\in \\{5,7,11\\}$ by reasoning from first principles. For each of $p=5$, $p=7$, and $p=11$, identify the least nonnegative residue of $P(p)$ modulo $p$. Then, let $S$ denote the sum of these three least nonnegative residues. What is the exact value of $S$? Provide your final answer as a single integer. No rounding is necessary and no units are required.", "solution": "The problem asks for the computation of $P(p) \\equiv \\prod_{a=1}^{p-1} a \\pmod{p}$ for the primes $p=5$, $p=7$, and $p=11$, and then for the sum $S$ of the resulting least non-negative residues. The computation must be based on first principles, specifically using the property that for a prime modulus $p$, every non-zero residue class has a unique multiplicative inverse.\n\nLet $\\mathbb{Z}_p^* = \\{1, 2, \\dots, p-1\\}$ be the set of non-zero residue classes modulo $p$. The product we are asked to compute is $P(p) = (p-1)!$. The core principle is to pair each element $a \\in \\mathbb{Z}_p^*$ with its unique multiplicative inverse $a^{-1} \\in \\mathbb{Z}_p^*$. The product of such a pair is $a \\cdot a^{-1} \\equiv 1 \\pmod{p}$.\n\nThe elements that cannot be paired with a distinct element are those which are their own inverses. These are the solutions to the congruence $x^2 \\equiv 1 \\pmod{p}$. This can be rewritten as $x^2 - 1 \\equiv 0 \\pmod{p}$, which factors into $(x-1)(x+1) \\equiv 0 \\pmod{p}$. Since $p$ is a prime number, this implies that either $p | (x-1)$ or $p | (x+1)$.\nThis gives two solutions for $x$ in $\\mathbb{Z}_p^*$:\n1. $x-1 \\equiv 0 \\pmod{p} \\implies x \\equiv 1 \\pmod{p}$.\n2. $x+1 \\equiv 0 \\pmod{p} \\implies x \\equiv -1 \\pmod{p}$.\n\nWithin the set $\\{1, 2, \\dots, p-1\\}$, the residue class $-1 \\pmod{p}$ corresponds to the integer $p-1$. For the primes given ($p=5, 7, 11$), $p$ is greater than $2$, so $1 \\not\\equiv p-1 \\pmod{p}$. Thus, there are exactly two elements in $\\mathbb{Z}_p^*$ that are their own inverses: $1$ and $p-1$.\n\nAll other elements in the set $\\mathbb{Z}_p^* \\setminus \\{1, p-1\\}$ can be grouped into pairs $(a, a^{-1})$ where $a \\neq a^{-1}$. The product of each such pair is $1 \\pmod{p}$. The set $\\{2, 3, \\dots, p-2\\}$ contains $p-3$ elements. Since each pair consists of $2$ distinct elements, there are $(p-3)/2$ such pairs.\n\nTherefore, the product $P(p)$ can be computed as:\n$$P(p) = (p-1)! \\equiv 1 \\cdot (p-1) \\cdot \\prod_{a \\in \\{2, \\dots, p-2\\}} a \\pmod{p}$$\nThe product over the set $\\{2, \\dots, p-2\\}$ is the product of $(p-3)/2$ pairs, each of which is congruent to $1$ modulo $p$.\n$$P(p) \\equiv 1 \\cdot (p-1) \\cdot (1)^{(p-3)/2} \\pmod{p}$$\n$$P(p) \\equiv p-1 \\pmod{p}$$\nSince $p-1 \\equiv -1 \\pmod{p}$, this is the general result known as Wilson's Theorem. We will now apply this reasoning to each specific case as requested.\n\nCase $1$: $p=5$\nWe need to compute $P(5) = (5-1)! = 4! \\pmod{5}$.\nThe set of non-zero residues is $\\{1, 2, 3, 4\\}$.\nThe self-inverse elements are $1$ and $4$ (since $4 \\equiv -1 \\pmod{5}$ and $4^2 = 16 \\equiv 1 \\pmod{5}$).\nThe remaining elements are $\\{2, 3\\}$. We check that they are inverses of each other: $2 \\cdot 3 = 6 \\equiv 1 \\pmod{5}$.\nSo, we can group the product as:\n$$P(5) = 1 \\cdot 2 \\cdot 3 \\cdot 4 \\equiv 1 \\cdot (2 \\cdot 3) \\cdot 4 \\pmod{5}$$\n$$P(5) \\equiv 1 \\cdot 1 \\cdot 4 \\pmod{5}$$\n$$P(5) \\equiv 4 \\pmod{5}$$\nThe least non-negative residue for $p=5$ is $4$.\n\nCase $2$: $p=7$\nWe need to compute $P(7) = (7-1)! = 6! \\pmod{7}$.\nThe set of non-zero residues is $\\{1, 2, 3, 4, 5, 6\\}$.\nThe self-inverse elements are $1$ and $6$ (since $6 \\equiv -1 \\pmod{7}$).\nThe remaining elements are $\\{2, 3, 4, 5\\}$. We form pairs of multiplicative inverses:\n- $2 \\cdot 4 = 8 \\equiv 1 \\pmod{7}$. The pair is $(2, 4)$.\n- $3 \\cdot 5 = 15 \\equiv 1 \\pmod{7}$. The pair is $(3, 5)$.\nSo, we can group the product as:\n$$P(7) = 1 \\cdot 2 \\cdot 3 \\cdot 4 \\cdot 5 \\cdot 6 \\equiv 1 \\cdot (2 \\cdot 4) \\cdot (3 \\cdot 5) \\cdot 6 \\pmod{7}$$\n$$P(7) \\equiv 1 \\cdot 1 \\cdot 1 \\cdot 6 \\pmod{7}$$\n$$P(7) \\equiv 6 \\pmod{7}$$\nThe least non-negative residue for $p=7$ is $6$.\n\nCase $3$: $p=11$\nWe need to compute $P(11) = (11-1)! = 10! \\pmod{11}$.\nThe set of non-zero residues is $\\{1, 2, 3, 4, 5, 6, 7, 8, 9, 10\\}$.\nThe self-inverse elements are $1$ and $10$ (since $10 \\equiv -1 \\pmod{11}$).\nThe remaining elements are $\\{2, 3, 4, 5, 6, 7, 8, 9\\}$. We form pairs of multiplicative inverses:\n- $2 \\cdot 6 = 12 \\equiv 1 \\pmod{11}$. The pair is $(2, 6)$.\n- $3 \\cdot 4 = 12 \\equiv 1 \\pmod{11}$. The pair is $(3, 4)$.\n- $5 \\cdot 9 = 45 \\equiv 1 \\pmod{11}$ (since $45 = 4 \\cdot 11 + 1$). The pair is $(5, 9)$.\n- $7 \\cdot 8 = 56 \\equiv 1 \\pmod{11}$ (since $56 = 5 \\cdot 11 + 1$). The pair is $(7, 8)$.\nSo, we can group the product as:\n$$P(11) = 1 \\cdot (2 \\cdot 6) \\cdot (3 \\cdot 4) \\cdot (5 \\cdot 9) \\cdot (7 \\cdot 8) \\cdot 10 \\pmod{11}$$\n$$P(11) \\equiv 1 \\cdot 1 \\cdot 1 \\cdot 1 \\cdot 1 \\cdot 10 \\pmod{11}$$\n$$P(11) \\equiv 10 \\pmod{11}$$\nThe least non-negative residue for $p=11$ is $10$.\n\nFinally, we are asked to find the value of $S$, the sum of these three least non-negative residues.\nLet $r_p$ be the least non-negative residue of $P(p) \\pmod{p}$.\nWe found $r_5 = 4$, $r_7 = 6$, and $r_{11} = 10$.\n$$S = r_5 + r_7 + r_{11}$$\n$$S = 4 + 6 + 10$$\n$$S = 20$$", "answer": "$$\n\\boxed{20}\n$$", "id": "3094034"}, {"introduction": "After verifying Wilson's Theorem for primes, it is natural to investigate the behavior of $(n-1)!$ for composite moduli. This practice explores the converse, demonstrating why the theorem fails for composite numbers and establishing the general result that $(n-1)! \\equiv 0 \\pmod n$ for composite $n \\gt 4$. Analyzing these cases will solidify your understanding of why Wilson's Theorem is a definitive test for primality and reveal the unique nature of the composite number $n=4$ [@problem_id:3094020].", "problem": "Let $n$ be a positive integer and let $(n-1)!$ denote the factorial of $n-1$. Using only fundamental properties of congruences modulo $n$, the prime factorization of $n$, and standard results about the exponents of primes in factorials, compute the residue of $(n-1)! \\pmod n$ for each $n \\in \\{4,6,8,9,10,12\\}$ without expanding the factorials explicitly. For each case, give a clear justification of the residue you obtain by analyzing divisibility within the product $1 \\cdot 2 \\cdot \\dots \\cdot (n-1)$, and classify whether the residue is $0$, $1$, or another residue modulo $n$. Present your final six residues as a single row matrix in the order $n=4,6,8,9,10,12$.", "solution": "The problem requires the computation of the residue of $(n-1)!$ modulo $n$ for a set of composite integers $n \\in \\{4, 6, 8, 9, 10, 12\\}$. The general principle for a composite integer $n$ is that if $n  4$, then $(n-1)!$ is divisible by $n$, which means $(n-1)! \\equiv 0 \\pmod{n}$. The only composite exception is $n=4$. We will verify this principle for each given value of $n$ by analyzing the divisibility of $(n-1)!$ based on the factors of $n$.\n\nThe analysis will proceed case-by-case for each value of $n$.\n\nCase $n=4$:\nThe number $n=4$ is a composite number, with prime factorization $2^2$. We are asked to compute $(4-1)! \\pmod{4}$, which is $3! \\pmod{4}$.\nThe factorial is calculated as $3! = 1 \\cdot 2 \\cdot 3 = 6$.\nTo find the residue of $6$ modulo $4$, we perform the division: $6 = 1 \\cdot 4 + 2$.\nThus, $3! \\equiv 2 \\pmod{4}$.\nThe factors of $3!$ are $1, 2, 3$. Because the prime factorization of $4$ is $2^2$, for $4$ to divide $3!$, the factor $2$ must appear at least twice in the prime factorization of $3!$. However, it appears only once. Therefore, $4$ does not divide $3!$ and the residue is non-zero.\nThe residue is $2$. This is classified as a residue other than $0$ or $1$.\n\nCase $n=6$:\nThe number $n=6$ is a composite number, with prime factorization $2 \\cdot 3$. We need to compute $(6-1)! \\pmod{6}$, which is $5! \\pmod{6}$.\nThe factorial product is $5! = 1 \\cdot 2 \\cdot 3 \\cdot 4 \\cdot 5$.\nThe integer $n=6$ can be written as a product of two distinct integers, $n=2 \\cdot 3$.\nBoth factors, $2$ and $3$, are less than $6$ and therefore appear in the list of factors of $5!$.\nSince $2$ and $3$ are distinct factors within the product $1 \\cdot 2 \\cdot 3 \\cdot 4 \\cdot 5$, their product $2 \\cdot 3 = 6$ must be a divisor of $5!$.\nThis implies that $5!$ is a multiple of $6$.\nTherefore, $(6-1)! \\equiv 0 \\pmod{6}$.\nThe residue is $0$.\n\nCase $n=8$:\nThe number $n=8$ is a composite number, with prime factorization $2^3$. We need to compute $(8-1)! \\pmod{8}$, which is $7! \\pmod{8}$.\nThe factorial product is $7! = 1 \\cdot 2 \\cdot 3 \\cdot 4 \\cdot 5 \\cdot 6 \\cdot 7$.\nThe integer $n=8$ can be written as a product of two distinct integers, $n=2 \\cdot 4$.\nBoth factors, $2$ and $4$, are less than $8$ and are distinct. They both appear in the list of factors of $7!$.\nTherefore, their product $2 \\cdot 4 = 8$ must be a divisor of $7!$.\nThis implies that $7!$ is a multiple of $8$.\nTherefore, $(8-1)! \\equiv 0 \\pmod{8}$.\nThe residue is $0$.\n\nCase $n=9$:\nThe number $n=9$ is a composite number, with prime factorization $3^2$. We need to compute $(9-1)! \\pmod{9}$, which is $8! \\pmod{9}$.\nThe factorial product is $8! = 1 \\cdot 2 \\cdot 3 \\cdot 4 \\cdot 5 \\cdot 6 \\cdot 7 \\cdot 8$.\nUnlike the previous cases, $n=9$ cannot be written as a product of two distinct integers that are both smaller than $9$ (as $9=3 \\cdot 3$). However, we can find two distinct factors in the product for $8!$ whose product is a multiple of $9$.\nConsider the factors $3$ and $6$. Both are less than $9$ and are distinct integers appearing in the product for $8!$.\nTheir product is $3 \\cdot 6 = 18$.\nSince $18 = 2 \\cdot 9$, we see that $18$ is a multiple of $9$.\nBecause $8!$ is divisible by $18$, it must also be divisible by $9$.\nThis implies that $8!$ is a multiple of $9$.\nTherefore, $(9-1)! \\equiv 0 \\pmod{9}$.\nThe residue is $0$.\n\nCase $n=10$:\nThe number $n=10$ is a composite number, with prime factorization $2 \\cdot 5$. We need to compute $(10-1)! \\pmod{10}$, which is $9! \\pmod{10}$.\nThe factorial product is $9! = 1 \\cdot 2 \\cdot \\dots \\cdot 9$.\nThe integer $n=10$ can be written as a product of two distinct integers, $n=2 \\cdot 5$.\nBoth factors, $2$ and $5$, are less than $10$ and are distinct. They both appear in the list of factors of $9!$.\nTherefore, their product $2 \\cdot 5 = 10$ must be a divisor of $9!$.\nThis implies that $9!$ is a multiple of $10$.\nTherefore, $(10-1)! \\equiv 0 \\pmod{10}$.\nThe residue is $0$.\n\nCase $n=12$:\nThe number $n=12$ is a composite number, with prime factorization $2^2 \\cdot 3$. We need to compute $(12-1)! \\pmod{12}$, which is $11! \\pmod{12}$.\nThe factorial product is $11! = 1 \\cdot 2 \\cdot \\dots \\cdot 11$.\nThe integer $n=12$ can be written as a product of two distinct integers, $n=3 \\cdot 4$.\nBoth factors, $3$ and $4$, are less than $12$ and are distinct. They both appear in the list of factors of $11!$.\nTherefore, their product $3 \\cdot 4 = 12$ must be a divisor of $11!$.\nThis implies that $11!$ is a multiple of $12$.\nTherefore, $(12-1)! \\equiv 0 \\pmod{12}$.\nThe residue is $0$.\n\nThe final list of residues for $n \\in \\{4, 6, 8, 9, 10, 12\\}$ is $(2, 0, 0, 0, 0, 0)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  0  0  0  0  0\n\\end{pmatrix}\n}\n$$", "id": "3094020"}, {"introduction": "The core idea in the proof of Wilson's Theorem is the product of all elements in the multiplicative group of units modulo a prime, $U(p)$. This advanced practice generalizes that concept to the group of units $U(n)$ for composite numbers $n$. By computing the product of all invertible elements for various composite moduli, you will uncover a more general group-theoretic principle about self-inverse elements, deepening your appreciation for the structure of modular arithmetic [@problem_id:3094028].", "problem": "Let $U(n)$ denote the multiplicative group of units modulo $n$, that is, the set of residue classes $[a]$ modulo $n$ with $\\gcd(a,n)=1$, under multiplication modulo $n$. For each of $n \\in \\{8,12,15,21\\}$, compute the product\n$$\nP(n) \\;=\\; \\prod_{u \\in U(n)} u \\pmod{n}.\n$$\nThen, using only core definitions (group inverses in a finite group, the idea of pairing an element with its inverse, and the Chinese Remainder Theorem), verify that your computed values are consistent with the criterion that relates $P(n)$ to the self-inverse elements of $U(n)$, namely those $x \\in U(n)$ satisfying $x^{2} \\equiv 1 \\pmod{n}$.\n\nYour final answer must list the values of $P(8)$, $P(12)$, $P(15)$, and $P(21)$, each given as its least nonnegative residue modulo the corresponding modulus, presented as a single row matrix in the order $n=8,12,15,21$. No rounding is required.", "solution": "The problem asks for the computation of the product of all elements in the multiplicative group of units $U(n)$ for $n \\in \\{8, 12, 15, 21\\}$, and to verify the results using the general principle concerning self-inverse elements.\n\nThe guiding principle for this problem rests on the structure of a finite abelian group, such as $U(n)$. Let $G$ be a finite abelian group with identity element $e$. The product of all elements in $G$, $\\prod_{g \\in G} g$, can be calculated by pairing each element $g$ with its unique inverse $g^{-1}$. The product of such a pair is $g \\cdot g^{-1} = e$. Elements that cannot be paired with a distinct inverse are those that are their own inverses, i.e., elements $x$ satisfying $x^2 = e$. These are the elements of order $1$ or $2$. Consequently, the product of all elements in the group is equal to the product of all elements that are their own inverses. For the group $U(n)$, the identity is the residue class $1$, and the condition for a self-inverse element $u$ is $u^2 \\equiv 1 \\pmod{n}$.\n\nWe will now analyze each case for $n \\in \\{8, 12, 15, 21\\}$.\n\nFor $n=8$:\nThe group of units $U(8)$ consists of integers less than and coprime to $8$. These are the odd integers.\n$$U(8) = \\{1, 3, 5, 7\\}$$\nThe product $P(8)$ is calculated directly:\n$$P(8) = 1 \\cdot 3 \\cdot 5 \\cdot 7 = 105 \\pmod{8}$$\nSince $105 = 13 \\times 8 + 1$, we have $P(8) \\equiv 1 \\pmod{8}$.\n\nTo verify this, we identify the self-inverse elements in $U(8)$, which are the solutions to $x^2 \\equiv 1 \\pmod{8}$.\nChecking each element:\n$1^2 = 1 \\equiv 1 \\pmod{8}$\n$3^2 = 9 \\equiv 1 \\pmod{8}$\n$5^2 = 25 \\equiv 1 \\pmod{8}$\n$7^2 = 49 \\equiv 1 \\pmod{8}$\nAll elements of $U(8)$ are self-inverse. The product of the self-inverse elements is therefore the product of all elements, which we have already calculated to be $1 \\pmod{8}$. The result is consistent.\n\nFor $n=12$:\nThe group of units $U(12)$ consists of integers less than and coprime to $12=2^2 \\cdot 3$.\n$$U(12) = \\{1, 5, 7, 11\\}$$\nThe product $P(12)$ is:\n$$P(12) = 1 \\cdot 5 \\cdot 7 \\cdot 11 = 385 \\pmod{12}$$\nSince $385 = 32 \\times 12 + 1$, we have $P(12) \\equiv 1 \\pmod{12}$. Alternatively, $5 \\cdot 7 = 35 \\equiv 11 \\pmod{12}$. So $P(12) \\equiv 1 \\cdot 11 \\cdot 11 = 121 \\equiv 1 \\pmod{12}$.\n\nFor verification, we find the solutions to $x^2 \\equiv 1 \\pmod{12}$. By the Chinese Remainder Theorem (CRT), this congruence is equivalent to the system:\n$$\n\\begin{cases}\nx^2 \\equiv 1 \\pmod{4} \\\\\nx^2 \\equiv 1 \\pmod{3}\n\\end{cases}\n$$\nThe solutions are $x \\equiv \\pm 1 \\pmod{4}$ (i.e., $x \\equiv 1, 3 \\pmod{4}$) and $x \\equiv \\pm 1 \\pmod{3}$ (i.e., $x \\equiv 1, 2 \\pmod{3}$). Combining these via CRT yields four solutions modulo $12$:\n1. $x \\equiv 1 \\pmod{4}$, $x \\equiv 1 \\pmod{3} \\implies x \\equiv 1 \\pmod{12}$\n2. $x \\equiv 1 \\pmod{4}$, $x \\equiv 2 \\pmod{3} \\implies x \\equiv 5 \\pmod{12}$\n3. $x \\equiv 3 \\pmod{4}$, $x \\equiv 1 \\pmod{3} \\implies x \\equiv 7 \\pmod{12}$\n4. $x \\equiv 3 \\pmod{4}$, $x \\equiv 2 \\pmod{3} \\implies x \\equiv 11 \\pmod{12}$\nThe set of self-inverse elements is $\\{1, 5, 7, 11\\}$, which is all of $U(12)$. The product of these elements is $1 \\cdot 5 \\cdot 7 \\cdot 11 \\equiv 1 \\pmod{12}$, which is consistent with our calculation of $P(12)$.\n\nFor $n=15$:\nThe group of units $U(15)$ consists of integers less than and coprime to $15=3 \\cdot 5$. Its order is $\\phi(15) = (3-1)(5-1) = 8$.\n$$U(15) = \\{1, 2, 4, 7, 8, 11, 13, 14\\}$$\nThe self-inverse elements are the solutions to $x^2 \\equiv 1 \\pmod{15}$, which by CRT is equivalent to:\n$$\n\\begin{cases}\nx^2 \\equiv 1 \\pmod{3} \\implies x \\equiv 1, 2 \\pmod{3} \\\\\nx^2 \\equiv 1 \\pmod{5} \\implies x \\equiv 1, 4 \\pmod{5}\n\\end{cases}\n$$\nThe four solutions are:\n1. $x \\equiv 1 \\pmod{3}$, $x \\equiv 1 \\pmod{5} \\implies x \\equiv 1 \\pmod{15}$\n2. $x \\equiv 1 \\pmod{3}$, $x \\equiv 4 \\pmod{5} \\implies x \\equiv 4 \\pmod{15}$\n3. $x \\equiv 2 \\pmod{3}$, $x \\equiv 1 \\pmod{5} \\implies x \\equiv 11 \\pmod{15}$\n4. $x \\equiv 2 \\pmod{3}$, $x \\equiv 4 \\pmod{5} \\implies x \\equiv 14 \\pmod{15}$\nThe set of self-inverse elements is $\\{1, 4, 11, 14\\}$. The other elements of $U(15)$ can be paired with their distinct inverses: $(2, 8)$ since $2 \\cdot 8=16 \\equiv 1 \\pmod{15}$, and $(7, 13)$ since $7 \\cdot 13 = 91 \\equiv 1 \\pmod{15}$.\nThe product $P(15)$ is the product of the self-inverse elements, as the products of the other pairs are $1$:\n$$P(15) \\equiv (1 \\cdot 4 \\cdot 11 \\cdot 14) \\cdot (2 \\cdot 8) \\cdot (7 \\cdot 13) \\equiv (1 \\cdot 4 \\cdot 11 \\cdot 14) \\cdot 1 \\cdot 1 \\pmod{15}$$\nLet's compute the product of the self-inverses:\n$$1 \\cdot 4 \\cdot 11 \\cdot 14 = 4 \\cdot 11 \\cdot 14 = 44 \\cdot 14 \\equiv 14 \\cdot 14 = 196 \\pmod{15}$$\nSince $196 = 13 \\times 15 + 1$, we have $196 \\equiv 1 \\pmod{15}$.\nThus, $P(15) \\equiv 1 \\pmod{15}$. This result is consistent with the principle.\n\nFor $n=21$:\nThe group of units $U(21)$ consists of integers less than and coprime to $21=3 \\cdot 7$. Its order is $\\phi(21) = (3-1)(7-1)=12$.\n$$U(21) = \\{1, 2, 4, 5, 8, 10, 11, 13, 16, 17, 19, 20\\}$$\nThe self-inverse elements are the solutions to $x^2 \\equiv 1 \\pmod{21}$, which by CRT is equivalent to:\n$$\n\\begin{cases}\nx^2 \\equiv 1 \\pmod{3} \\implies x \\equiv 1, 2 \\pmod{3} \\\\\nx^2 \\equiv 1 \\pmod{7} \\implies x \\equiv 1, 6 \\pmod{7}\n\\end{cases}\n$$\nThe four solutions are:\n1. $x \\equiv 1 \\pmod{3}$, $x \\equiv 1 \\pmod{7} \\implies x \\equiv 1 \\pmod{21}$\n2. $x \\equiv 1 \\pmod{3}$, $x \\equiv 6 \\pmod{7} \\implies x \\equiv 13 \\pmod{21}$\n3. $x \\equiv 2 \\pmod{3}$, $x \\equiv 1 \\pmod{7} \\implies x \\equiv 8 \\pmod{21}$\n4. $x \\equiv 2 \\pmod{3}$, $x \\equiv 6 \\pmod{7} \\implies x \\equiv 20 \\pmod{21}$\nThe set of self-inverse elements is $\\{1, 8, 13, 20\\}$. The remaining $8$ elements form pairs of distinct inverses: $(2, 11)$, $(4, 16)$, $(5, 17)$, and $(10, 19)$.\nThe product $P(21)$ is therefore the product of the self-inverse elements.\n$$P(21) \\equiv 1 \\cdot 8 \\cdot 13 \\cdot 20 \\pmod{21}$$\nWe compute this product:\n$8 \\cdot 13 = 104$. Since $104 = 4 \\times 21 + 20$, $8 \\cdot 13 \\equiv 20 \\pmod{21}$.\nThen, $P(21) \\equiv 20 \\cdot 20 = 400 \\pmod{21}$.\nSince $400 = 19 \\times 21 + 1$, we have $400 \\equiv 1 \\pmod{21}$.\nThus, $P(21) \\equiv 1 \\pmod{21}$. This confirms the expected result.\n\nIn summary, the values for $P(n)$, given as the least nonnegative residue modulo $n$, are:\n$P(8) = 1$\n$P(12) = 1$\n$P(15) = 1$\n$P(21) = 1$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1  1  1\n\\end{pmatrix}\n}\n$$", "id": "3094028"}]}