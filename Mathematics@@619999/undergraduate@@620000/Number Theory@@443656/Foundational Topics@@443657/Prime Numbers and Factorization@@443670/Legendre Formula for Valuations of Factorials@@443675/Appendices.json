{"hands_on_practices": [{"introduction": "The journey to mastering a mathematical tool often begins with understanding its origins. Instead of simply accepting Legendre's formula, this first practice guides you through its derivation from the fundamental principles of prime factorization. By methodically counting the contributions of prime factors across the integers from $1$ to $n$, you will build the formula from the ground up and then immediately apply it to a concrete example, calculating the $p$-adic valuations of $100!$ [@problem_id:3086742].", "problem": "Let $p$ be a prime and let $v_{p}(n!)$ denote the exponent of $p$ in the prime factorization of $n!$, that is, the unique integer $e \\geq 0$ such that $p^{e}$ divides $n!$ and $p^{e+1}$ does not divide $n!$. Starting only from the Fundamental Theorem of Arithmetic (unique factorization of integers) and the definition of $v_{p}(n!)$ as $\\sum_{m=1}^{n} v_{p}(m)$, first derive an explicit expression for $v_{p}(n!)$ in terms of a finite sum involving the greatest-integer (floor) function $\\lfloor \\cdot \\rfloor$ by carefully counting how many factors of $p$ are contributed by the integers $1,2,\\dots,n$. Then use your derived expression to compute $v_{2}(100!)$ and $v_{5}(100!)$ explicitly.\n\nReport your final result as the row matrix $\\begin{pmatrix} v_{2}(100!) & v_{5}(100!) \\end{pmatrix}$. No rounding is required.", "solution": "The problem requires the derivation of an explicit formula for the $p$-adic valuation of $n!$, denoted $v_{p}(n!)$, and its subsequent application. The derivation must start from the Fundamental Theorem of Arithmetic and the definition of $v_{p}(n!)$ as the sum of the $p$-adic valuations of integers from $1$ to $n$.\n\nLet $p$ be a prime number and $n$ be a positive integer. The term $n!$ is the product of all positive integers up to $n$:\n$$n! = 1 \\cdot 2 \\cdot 3 \\cdots n = \\prod_{m=1}^{n} m$$\nThe Fundamental Theorem of Arithmetic states that any integer greater than $1$ can be uniquely represented as a product of prime numbers. The $p$-adic valuation of an integer $k$, denoted $v_{p}(k)$, is the exponent of the prime $p$ in the prime factorization of $k$. From the properties of exponents, the valuation of a product is the sum of the valuations of its factors. Therefore, the exponent of $p$ in the prime factorization of $n!$ is given by:\n$$v_{p}(n!) = v_{p}\\left(\\prod_{m=1}^{n} m\\right) = \\sum_{m=1}^{n} v_{p}(m)$$\nThis confirms the starting point provided in the problem statement. The term $v_{p}(m)$ is zero if $p$ does not divide $m$.\n\nTo find an explicit expression, we will recount this sum by considering which integers $m \\in \\{1, 2, \\dots, n\\}$ contribute factors of $p$.\nA factor of $p$ is contributed by each multiple of $p$ in the set $\\{1, 2, \\dots, n\\}$. The multiples of $p$ are $p, 2p, 3p, \\dots, kp$ such that $kp \\le n$. The number of such multiples is given by the largest integer $k$ satisfying $k \\le \\frac{n}{p}$, which is exactly $\\lfloor \\frac{n}{p} \\rfloor$. This accounts for at least one factor of $p$ for each of these numbers.\n\nHowever, some numbers contribute more than one factor of $p$. Specifically, multiples of $p^2$ contribute at least two factors of $p$. The multiples of $p^2$ in $\\{1, 2, \\dots, n\\}$ are $p^2, 2p^2, \\dots, lp^2$ such that $lp^2 \\le n$. The number of such multiples is $\\lfloor \\frac{n}{p^2} \\rfloor$. In the previous step, we already credited each of these numbers with one factor of $p$ (since every multiple of $p^2$ is also a multiple of $p$). Thus, we must count an additional factor of $p$ for each multiple of $p^2$.\n\nThis reasoning extends to higher powers of $p$. For any integer $k \\ge 1$, the multiples of $p^k$ in the set $\\{1, 2, \\dots, n\\}$ are of the form $j p^k \\le n$. The number of such multiples is $\\lfloor \\frac{n}{p^k} \\rfloor$. Each of these numbers contributes at least $k$ factors of $p$ to $n!$. Our counting method sums the number of factors at each level:\n- The count $\\lfloor \\frac{n}{p} \\rfloor$ includes every number divisible by $p$, $p^2$, $p^3$, etc., exactly once.\n- The count $\\lfloor \\frac{n}{p^2} \\rfloor$ includes every number divisible by $p^2$, $p^3$, etc., exactly once.\n- The count $\\lfloor \\frac{n}{p^k} \\rfloor$ includes every number divisible by $p^k$, $p^{k+1}$, etc., exactly once.\n\nAn integer $m$ for which $v_p(m) = E$ is divisible by $p, p^2, \\dots, p^E$ but not by $p^{E+1}$. Therefore, this integer $m$ is counted exactly once in each of the sums for $\\lfloor\\frac{n}{p}\\rfloor, \\lfloor\\frac{n}{p^2}\\rfloor, \\dots, \\lfloor\\frac{n}{p^E}\\rfloor$. The total number of times the integer $m$ is counted in our scheme is $E$, which is precisely its $p$-adic valuation, $v_p(m)$.\nSumming these contributions over all integers $m$ from $1$ to $n$ gives the total exponent $v_p(n!)$.\nThus, the total number of factors of $p$ in $n!$ is the sum of these counts for all powers of $p$:\n$$v_{p}(n!) = \\left\\lfloor \\frac{n}{p} \\right\\rfloor + \\left\\lfloor \\frac{n}{p^2} \\right\\rfloor + \\left\\lfloor \\frac{n}{p^3} \\right\\rfloor + \\dots = \\sum_{k=1}^{\\infty} \\left\\lfloor \\frac{n}{p^k} \\right\\rfloor$$\nThis is known as Legendre's formula. The sum is finite since for $p^k > n$, the term $\\lfloor \\frac{n}{p^k} \\rfloor$ becomes $0$.\n\nNow, we use this formula to compute the required values.\n\nFirst, we calculate $v_{2}(100!)$. Here, $p=2$ and $n=100$.\n$$v_{2}(100!) = \\sum_{k=1}^{\\infty} \\left\\lfloor \\frac{100}{2^k} \\right\\rfloor$$\nThe terms of the sum are:\nFor $k=1$: $\\lfloor \\frac{100}{2} \\rfloor = \\lfloor 50 \\rfloor = 50$\nFor $k=2$: $\\lfloor \\frac{100}{4} \\rfloor = \\lfloor 25 \\rfloor = 25$\nFor $k=3$: $\\lfloor \\frac{100}{8} \\rfloor = \\lfloor 12.5 \\rfloor = 12$\nFor $k=4$: $\\lfloor \\frac{100}{16} \\rfloor = \\lfloor 6.25 \\rfloor = 6$\nFor $k=5$: $\\lfloor \\frac{100}{32} \\rfloor = \\lfloor 3.125 \\rfloor = 3$\nFor $k=6$: $\\lfloor \\frac{100}{64} \\rfloor = \\lfloor 1.5625 \\rfloor = 1$\nFor $k=7$: $\\lfloor \\frac{100}{128} \\rfloor = \\lfloor 0.78125 \\rfloor = 0$. All subsequent terms are also $0$.\nSo, the sum is:\n$$v_{2}(100!) = 50 + 25 + 12 + 6 + 3 + 1 = 97$$\n\nSecond, we calculate $v_{5}(100!)$. Here, $p=5$ and $n=100$.\n$$v_{5}(100!) = \\sum_{k=1}^{\\infty} \\left\\lfloor \\frac{100}{5^k} \\right\\rfloor$$\nThe terms of the sum are:\nFor $k=1$: $\\lfloor \\frac{100}{5} \\rfloor = \\lfloor 20 \\rfloor = 20$\nFor $k=2$: $\\lfloor \\frac{100}{25} \\rfloor = \\lfloor 4 \\rfloor = 4$\nFor $k=3$: $\\lfloor \\frac{100}{125} \\rfloor = \\lfloor 0.8 \\rfloor = 0$. All subsequent terms are also $0$.\nSo, the sum is:\n$$v_{5}(100!) = 20 + 4 = 24$$\n\nThe computed values are $v_{2}(100!) = 97$ and $v_{5}(100!) = 24$. The problem requests the result as a row matrix.", "answer": "$$\n\\boxed{\\begin{pmatrix} 97 & 24 \\end{pmatrix}}\n$$", "id": "3086742"}, {"introduction": "One of the beautiful aspects of number theory is the discovery of unexpected connections between different mathematical ideas. This practice introduces an elegant alternative form of Legendre's formula that relates the $p$-adic valuation of $n!$ to the sum of the digits of $n$ when written in base $p$. You will compute $v_3(100!)$ using both the standard summation method and this new digit-sum formula, allowing you to verify their equivalence and appreciate the efficiency of the latter [@problem_id:3086771].", "problem": "Let $p$ be a prime and let $v_{p}(n!)$ denote the exponent of $p$ in the prime factorization of $n!$, that is, the largest integer $a$ such that $p^{a}$ divides $n!$. Consider the case $p=3$ and $n=100$. Using only the definition of $v_{p}(n!)$ and the fundamental facts that a factor of $p$ arises from each multiple of $p$ and, more generally, that higher powers $p^{k}$ contribute additional factors, do the following:\n- First, compute $v_{3}(100!)$ by counting the contribution of each factor of $3$ across the integers from $1$ to $100$, in terms of how many are divisible by $3$, by $3^{2}$, by $3^{3}$, and so on, and summing these counts as $\\,\\sum_{k \\ge 1} \\left\\lfloor \\frac{100}{3^{k}} \\right\\rfloor$.\n- Second, write $100$ in base $3$, define the base-$3$ digit sum $s_{3}(100)$ as the sum of the digits in that base-$3$ expansion, and compute the expression $\\frac{100 - s_{3}(100)}{2}$ based on the relationship between the place-value decomposition of $100$ in base $3$ and the total number of factors of $3$ in $100!$.\nVerify that the two computations agree. Express your final answer as an exact integer, with no rounding.", "solution": "The problem statement is evaluated and found to be valid. It is a well-posed problem in elementary number theory, based on established principles, and contains all necessary information for a unique solution.\n\nThe objective is to compute the exponent of the prime $p=3$ in the prime factorization of $n=100!$, a quantity denoted by $v_{3}(100!)$. This calculation will be performed using two different, but related, methods as specified in the problem statement. Finally, we will verify that both methods yield the same integer result.\n\nThe first method is a direct application of Legendre's formula, which provides the exponent of a prime $p$ in the factorization of $n!$ as the sum of the integer parts of the quotients of $n$ divided by successive powers of $p$. The formula is:\n$$v_{p}(n!) = \\sum_{k=1}^{\\infty} \\left\\lfloor \\frac{n}{p^k} \\right\\rfloor$$\nFor the given case, $n=100$ and $p=3$, the formula becomes:\n$$v_{3}(100!) = \\sum_{k=1}^{\\infty} \\left\\lfloor \\frac{100}{3^k} \\right\\rfloor$$\nThe summation is finite, as the terms become zero when $3^k > 100$. We need to evaluate the terms for $k=1, 2, 3, 4$. The subsequent power, $3^5=243$, exceeds $100$.\nThe individual terms are calculated as follows:\n- For $k=1$: The contribution is from multiples of $3^1=3$. The number of such multiples in the range from $1$ to $100$ is $\\left\\lfloor \\frac{100}{3} \\right\\rfloor = 33$.\n- For $k=2$: The contribution is from multiples of $3^2=9$. The number of such multiples is $\\left\\lfloor \\frac{100}{9} \\right\\rfloor = 11$. These numbers contribute an additional factor of $3$ beyond the one already counted for their divisibility by $3$.\n- For $k=3$: The contribution is from multiples of $3^3=27$. The number of such multiples is $\\left\\lfloor \\frac{100}{27} \\right\\rfloor = 3$.\n- For $k=4$: The contribution is from multiples of $3^4=81$. The number of such multiples is $\\left\\lfloor \\frac{100}{81} \\right\\rfloor = 1$.\nThe total exponent $v_{3}(100!)$ is the sum of these counts:\n$$v_{3}(100!) = 33 + 11 + 3 + 1 = 48$$\n\nThe second method uses an alternative formulation of Legendre's theorem, which connects $v_{p}(n!)$ to the sum of the digits of $n$ when written in base $p$, denoted $s_{p}(n)$. The formula is:\n$$v_{p}(n!) = \\frac{n - s_{p}(n)}{p-1}$$\nFor $n=100$ and $p=3$, we are asked to compute the expression $\\frac{100 - s_{3}(100)}{3-1} = \\frac{100 - s_{3}(100)}{2}$.\nFirst, we must express $n=100$ in base $3$. This is done using successive divisions by $3$ and recording the remainders:\n$100 \\div 3 = 33$ remainder $1$\n$33 \\div 3 = 11$ remainder $0$\n$11 \\div 3 = 3$ remainder $2$\n$3 \\div 3 = 1$ remainder $0$\n$1 \\div 3 = 0$ remainder $1$\nReading the remainders in reverse order of their calculation gives the base-$3$ representation: $100_{10} = 10201_{3}$.\nWe can verify this: $1 \\cdot 3^4 + 0 \\cdot 3^3 + 2 \\cdot 3^2 + 0 \\cdot 3^1 + 1 \\cdot 3^0 = 1 \\cdot 81 + 0 + 2 \\cdot 9 + 0 + 1 = 81 + 18 + 1 = 100$.\nNext, we calculate $s_{3}(100)$, the sum of the digits of $100$ in base $3$:\n$$s_{3}(100) = 1 + 0 + 2 + 0 + 1 = 4$$\nNow, we substitute this value into the given expression:\n$$\\frac{100 - s_{3}(100)}{2} = \\frac{100 - 4}{2} = \\frac{96}{2} = 48$$\n\nBoth computational methods yield the result $48$. The first method, by counting multiples of powers of $3$, gives $v_{3}(100!) = 48$. The second method, using the base-$3$ expansion of $100$, also evaluates to $48$. The two results are in agreement, as expected from the two equivalent forms of Legendre's formula.", "answer": "$$\\boxed{48}$$", "id": "3086771"}, {"introduction": "A truly powerful mathematical concept extends its reach beyond its initial application. This exercise demonstrates the utility of Legendre's formula by applying it to a related but more complex object: the binomial coefficient $\\binom{n}{k}$. By leveraging the digit-sum formulation, you will uncover a profound result known as Kummer's Theorem, which provides a simple criterion for the divisibility of $\\binom{n}{k}$ by a prime $p$ based on their base-$p$ representations [@problem_id:3086784].", "problem": "Let $p$ be a fixed prime. For a positive integer $m$, define the $p$-adic valuation $v_p(m)$ as the largest integer $e$ such that $p^{e}$ divides $m$, and let $s_p(m)$ denote the sum of the base-$p$ digits of $m$. Let $n$ be written in base $p$ as $n=\\sum_{i=0}^{t} n_i p^{i}$ with $n_t \\neq 0$ and each digit $n_i \\in \\{0,1,\\dots,p-1\\}$. Define\n$$N_p(n) \\text{ as the number of integers } k \\text{ with } 0 \\leq k \\leq n \\text{ and } p \\nmid \\binom{n}{k}.$$\nUsing only the definition of $v_p(\\cdot)$, the base-$p$ representation, and the well-tested fact known as Legendre’s formula for factorial valuations, derive a necessary and sufficient condition on the base-$p$ digits of $k$ and $n$ for which $p \\nmid \\binom{n}{k}$, and then obtain a closed-form expression for $N_p(n)$ purely in terms of the base-$p$ digits $n_0,n_1,\\dots,n_t$. Your final answer must be a single analytic expression depending on $n_0,n_1,\\dots,n_t$ and $p$. No rounding is required.", "solution": "The problem is subjected to validation and is deemed valid. It is a well-posed problem in number theory that is scientifically grounded and objective.\n\nLet $p$ be a fixed prime number. For a positive integer $m$, the $p$-adic valuation $v_p(m)$ is the exponent of the highest power of $p$ that divides $m$. We are asked to find the number of integers $k$ such that $0 \\leq k \\leq n$ for which $p$ does not divide the binomial coefficient $\\binom{n}{k}$. This condition is equivalent to $v_p\\left(\\binom{n}{k}\\right) = 0$.\n\nThe binomial coefficient is defined as $\\binom{n}{k} = \\frac{n!}{k!(n-k)!}$ for $0 \\leq k \\leq n$. Using the fundamental property of $p$-adic valuations, $v_p(ab) = v_p(a) + v_p(b)$ and $v_p(a/b) = v_p(a) - v_p(b)$, we can write the valuation of the binomial coefficient as:\n$$v_p\\left(\\binom{n}{k}\\right) = v_p(n!) - v_p(k!) - v_p((n-k)!)$$\nThis holds for $0 < k < n$. For $k=0$ or $k=n$, $\\binom{n}{k}=1$, so $v_p\\left(\\binom{n}{k}\\right) = 0$.\n\nThe problem states we must use Legendre's formula, which gives the $p$-adic valuation of a factorial $m!$ as:\n$$v_p(m!) = \\sum_{j=1}^{\\infty} \\left\\lfloor \\frac{m}{p^j} \\right\\rfloor$$\nLet the integer $m$ have the base-$p$ representation $m = \\sum_{i=0}^{t} m_i p^i$, where $m_i \\in \\{0, 1, \\dots, p-1\\}$. The sum of the digits is $s_p(m) = \\sum_{i=0}^{t} m_i$. We can express $v_p(m!)$ in terms of $m$ and $s_p(m)$.\nThe term $\\lfloor m/p^j \\rfloor$ can be written as:\n$$\\left\\lfloor \\frac{m}{p^j} \\right\\rfloor = \\left\\lfloor \\sum_{i=0}^{t} m_i p^{i-j} \\right\\rfloor = \\sum_{i=j}^{t} m_i p^{i-j}$$\nSubstituting this into Legendre's formula:\n$$v_p(m!) = \\sum_{j=1}^{\\infty} \\sum_{i=j}^{t} m_i p^{i-j}$$\nChanging the order of summation:\n$$v_p(m!) = \\sum_{i=1}^{t} \\sum_{j=1}^{i} m_i p^{i-j} = \\sum_{i=1}^{t} m_i \\sum_{j=1}^{i} p^{i-j}$$\nThe inner sum is a geometric series: $\\sum_{l=0}^{i-1} p^l = \\frac{p^i-1}{p-1}$.\n$$v_p(m!) = \\sum_{i=1}^{t} m_i \\left(\\frac{p^i-1}{p-1}\\right) = \\frac{1}{p-1} \\sum_{i=0}^{t} m_i (p^i-1)$$\nNote that we can include the $i=0$ term as $m_0(p^0-1)=0$.\n$$v_p(m!) = \\frac{1}{p-1} \\left( \\sum_{i=0}^{t} m_i p^i - \\sum_{i=0}^{t} m_i \\right) = \\frac{m - s_p(m)}{p-1}$$\nThis is a well-known identity, derived as requested from Legendre's formula.\n\nNow, we substitute this identity into the expression for $v_p\\left(\\binom{n}{k}\\right)$:\n$$v_p\\left(\\binom{n}{k}\\right) = \\frac{n-s_p(n)}{p-1} - \\frac{k-s_p(k)}{p-1} - \\frac{(n-k)-s_p(n-k)}{p-1}$$\n$$v_p\\left(\\binom{n}{k}\\right) = \\frac{(n-k-(n-k)) + s_p(k) + s_p(n-k) - s_p(n)}{p-1}$$\n$$v_p\\left(\\binom{n}{k}\\right) = \\frac{s_p(k) + s_p(n-k) - s_p(n)}{p-1}$$\nThis result is known as Kummer's Theorem. The condition $v_p\\left(\\binom{n}{k}\\right) = 0$ is equivalent to the numerator being zero, since $p-1 > 0$:\n$$s_p(k) + s_p(n-k) = s_p(n)$$\nTo understand what this condition implies for the digits, consider the addition of $k$ and $n-k$ in base $p$. Let $k = \\sum_{i=0}^{t} k_i p^i$ and $n-k = \\sum_{i=0}^{t} m_i p^i$. Their sum is $n = \\sum_{i=0}^{t} n_i p^i$. Let $c_i$ be the carry generated at position $i-1$ during base-$p$ addition, where $c_0 = 0$. The relationship between the digits is given by the standard addition algorithm:\n$$k_i + m_i + c_i = n_i + p c_{i+1}$$\nSumming over all $i \\ge 0$:\n$$\\sum_{i=0}^{t} k_i + \\sum_{i=0}^{t} m_i + \\sum_{i=0}^{t} c_i = \\sum_{i=0}^{t} n_i + p \\sum_{i=0}^{t} c_{i+1}$$\nRecognizing the sums of digits:\n$$s_p(k) + s_p(n-k) + \\sum_{i=1}^{t+1} c_i = s_p(n) + p \\sum_{i=1}^{t+1} c_i$$\nLet $C = \\sum_{i=1}^{t+1} c_i$ be the total number of carries. Then:\n$$s_p(k) + s_p(n-k) - s_p(n) = (p-1)C$$\nComparing this with our expression for $v_p\\left(\\binom{n}{k}\\right)$, we find:\n$$v_p\\left(\\binom{n}{k}\\right) = C$$\nThis means the $p$-adic valuation of $\\binom{n}{k}$ is precisely the number of carries when adding $k$ and $n-k$ in base $p$.\nThe condition $p \\nmid \\binom{n}{k}$, i.e., $v_p\\left(\\binom{n}{k}\\right)=0$, is therefore equivalent to $C=0$. Since carries $c_i$ are non-negative integers, $C=0$ if and only if all carries are zero, i.e., $c_i=0$ for all $i$.\n\nThe condition $c_i = 0$ for all $i$ simplifies the digit-wise addition to $k_i+m_i = n_i$. This corresponds to performing the subtraction $n-k$ without any \"borrows\". Since $m_i$ are the digits of $n-k$, they are non-negative, $m_i \\ge 0$. The relation $k_i+m_i = n_i$ thus implies $k_i \\le n_i$ for all $i$.\nConversely, if $k_i \\le n_i$ for all $i$, then we can compute $n-k = \\sum (n_i - k_i)p^i$. The digits of $n-k$ are $m_i=n_i-k_i$. In this case, $s_p(n-k) = \\sum(n_i-k_i) = s_p(n)-s_p(k)$, so $s_p(k)+s_p(n-k)=s_p(n)$, which implies $v_p\\left(\\binom{n}{k}\\right)=0$.\nThus, the necessary and sufficient condition for $p \\nmid \\binom{n}{k}$ is that for every $i$, the $i$-th base-$p$ digit of $k$, denoted $k_i$, must be less than or equal to the $i$-th base-$p$ digit of $n$, $n_i$.\n\nWe now need to find $N_p(n)$, the number of integers $k$ in the range $0 \\le k \\le n$ that satisfy this digit-wise condition. Let $n = \\sum_{i=0}^{t} n_i p^i$ with $n_t \\neq 0$. An integer $k$ is uniquely determined by its base-$p$ digits $k_i$. We are looking for the number of sequences of digits $(k_t, k_{t-1}, \\dots, k_0)$ such that $0 \\le k_i \\le n_i$ for each $i \\in \\{0, 1, \\dots, t\\}$.\nFor each digit position $i$, the number of possible choices for $k_i$ is $n_i - 0 + 1 = n_i+1$.\nThe choice of each digit $k_i$ is independent of the choices for the other digits. By the fundamental principle of counting (the rule of product), the total number of ways to choose the sequence of digits $(k_t, \\dots, k_0)$ is the product of the number of choices for each digit.\nAny integer $k$ formed this way, $k=\\sum_{i=0}^t k_i p^i$ with $0 \\le k_i \\le n_i$, will automatically satisfy $k \\le n$, since $n-k = \\sum_{i=0}^t (n_i-k_i)p^i \\ge 0$.\nTherefore, the total number of such integers $k$ is:\n$$N_p(n) = (n_0+1)(n_1+1)\\cdots(n_t+1) = \\prod_{i=0}^{t} (n_i+1)$$\nThis is the required closed-form expression for $N_p(n)$ in terms of the base-$p$ digits of $n$.", "answer": "$$\\boxed{\\prod_{i=0}^{t} (n_i+1)}$$", "id": "3086784"}]}