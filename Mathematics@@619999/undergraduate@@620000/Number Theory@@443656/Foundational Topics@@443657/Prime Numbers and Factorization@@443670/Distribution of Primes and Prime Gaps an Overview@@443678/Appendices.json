{"hands_on_practices": [{"introduction": "The Prime Number Theorem tells us that $\\pi(x)$ is approximately $\\frac{x}{\\ln x}$, but how accurate is this estimate? To answer this question rigorously, mathematicians have developed explicit bounds that hold for all $x$ above a certain value. This practice invites you to work directly with the celebrated Rosser–Schoenfeld inequalities, allowing you to calculate a guaranteed range for the number of primes up to $100$ million and appreciate the power of these explicit formulas in practical number theory.", "problem": "Let $\\pi(x)$ denote the prime counting function, defined by $\\pi(x)=|\\{p \\text{ prime} : p \\leq x\\}|$, and let $\\ln(x)$ denote the natural logarithm. It is a well-tested fact that the Prime Number Theorem (PNT) asserts $\\pi(x)\\sim x/\\ln(x)$ as $x\\to\\infty$, but for concrete numerical certification one uses explicit inequalities. The Rosser–Schoenfeld explicit bounds (1962) state that for all real $x \\geq 55$,\n$$\\frac{x}{\\ln(x)-1}  \\pi(x)  \\frac{x}{\\ln(x)-1.08366}.$$\nUsing only these explicit bounds, produce a certified upper and lower bound for $\\pi(10^{8})$ and form the ratio\n$$R=\\frac{\\text{upper bound} - \\text{lower bound}}{10^{8}/\\ln(10^{8})}.$$\nCompute $R$ and round your final answer to four significant figures. Express your answer as a pure number without units.", "solution": "We begin with the definition of the prime counting function $\\pi(x)$ and the natural logarithm $\\ln(x)$. The Prime Number Theorem provides the heuristic scale $\\pi(x)\\sim x/\\ln(x)$, but to obtain certified bounds we rely on the Rosser–Schoenfeld inequalities, which are well-tested explicit formulas.\n\nFor $x=10^{8}$, the Rosser–Schoenfeld bounds give\n$$\\frac{10^{8}}{\\ln(10^{8})-1}  \\pi(10^{8})  \\frac{10^{8}}{\\ln(10^{8})-1.08366}.$$\nLet $L=\\ln(10^{8})$. Then the lower and upper bounds are\n$$\\text{LB}=\\frac{10^{8}}{L-1},\\qquad \\text{UB}=\\frac{10^{8}}{L-1.08366}.$$\nThe width of the certified interval is\n$$\\text{width}=\\text{UB}-\\text{LB}=\\frac{10^{8}}{L-1.08366}-\\frac{10^{8}}{L-1}.$$\nAlgebraically, this difference simplifies to\n\\begin{align*}\n\\text{width}\n=10^{8}\\left(\\frac{1}{L-1.08366}-\\frac{1}{L-1}\\right)\n=10^{8}\\cdot\\frac{(L-1)-(L-1.08366)}{(L-1.08366)(L-1)}\\\\\n=10^{8}\\cdot\\frac{0.08366}{(L-1.08366)(L-1)}.\n\\end{align*}\nWe are asked to compare this width to the baseline scale $10^{8}/L$ by forming the ratio\n$$R=\\frac{\\text{width}}{10^{8}/L}=\\frac{10^{8}\\cdot\\frac{0.08366}{(L-1.08366)(L-1)}}{10^{8}/L}=\\frac{0.08366\\,L}{(L-1.08366)(L-1)}.$$\nThus, the ratio is given exactly by\n$$R=\\frac{0.08366\\,\\ln(10^{8})}{\\big(\\ln(10^{8})-1.08366\\big)\\big(\\ln(10^{8})-1\\big)}.$$\nTo evaluate $R$ numerically, we use $\\ln(10)=2.302585093$ and hence\n$$L=\\ln(10^{8})=8\\ln(10)=8\\times 2.302585093=18.420680744.$$\nNext, compute the factors:\n\\begin{align*}\nL-1 = 18.420680744 - 1 = 17.420680744,\\\\\nL-1.08366 = 18.420680744 - 1.08366 = 17.337020744,\\\\\n(L-1.08366)(L-1) \\approx 17.337020744 \\times 17.420680744 \\approx 302.022676,\\\\\n0.08366\\,L \\approx 0.08366 \\times 18.420680744 \\approx 1.541074088.\n\\end{align*}\nTherefore,\n$$R \\approx \\frac{1.541074088}{302.022676} \\approx 0.005102512\\ldots.$$\nRounding to four significant figures yields\n$$R \\approx 0.005103.$$\n\nFor completeness, one can also observe the numerical lower and upper bounds themselves:\n\\begin{align*}\n\\text{LB}=\\frac{10^{8}}{17.420680744}\\approx 5{,}740{,}304,\\\\\n\\text{UB}=\\frac{10^{8}}{17.337020744}\\approx 5{,}768{,}004,\n\\end{align*}\nso the interval width is approximately $27{,}700$, and $10^{8}/L\\approx 5{,}428{,}682$, consistent with the ratio $R\\approx 27{,}700/5{,}428{,}682\\approx 0.005103$.\n\nThis computation uses only the explicit Rosser–Schoenfeld bounds as a well-tested starting point and compares their certified interval width to the natural scale $10^{8}/\\ln(10^{8})$ suggested by the Prime Number Theorem.", "answer": "$$\\boxed{0.005103}$$", "id": "3084502"}, {"introduction": "While the Prime Number Theorem successfully predicts the *average* gap between primes, the behavior of *maximal* prime gaps remains one of number theory's great mysteries. This computational exercise puts you in the role of an experimental mathematician, tasking you with generating primes and analyzing their gaps. By comparing the growth of the largest gaps you find against the functions $\\ln x$ and $(\\ln x)^2$, you will gain firsthand insight into the heuristics that guide modern research on prime distribution.", "problem": "You are to study the empirical behavior of prime gaps through computation. Let $p_n$ denote the $n$-th prime number, and define the prime gap sequence $g(p_n) = p_{n+1} - p_n$ for $n \\geq 1$. Let $\\pi(x)$ denote the prime counting function, that is, the number of primes less than or equal to $x$. Let $\\log x$ denote the natural logarithm of $x$. The fundamental base for this investigation is the Prime Number Theorem (PNT), which states that $\\pi(x) \\sim \\dfrac{x}{\\log x}$ as $x \\to \\infty$. This implies that the average spacing between consecutive primes near $x$ is heuristically of scale $\\log x$. Another widely discussed heuristic, often attributed to Cramér, suggests that the maximal gaps may grow on the scale of $(\\log x)^2$.\n\nYour task is to write a complete, runnable program that:\n\n- Generates all prime numbers up to $X = 10^7$ using an algorithm justified by fundamental number theoretic principles (for example, the Sieve of Eratosthenes).\n- For a given $x$, defines:\n  - The maximal observed gap up to $x$,\n    $$ G_{\\max}(x) = \\max\\{ g(p_n) : p_{n+1} \\leq x \\}. $$\n  - The empirical average gap up to $x$,\n    $$ \\overline{g}(x) = \\frac{p_k - 2}{k - 1}, \\quad \\text{where } p_k = \\max\\{p_n \\leq x\\} \\text{ and } k = \\pi(x). $$\n    This quantity equals the average of the consecutive prime differences $g(p_n)$ for $p_{n+1} \\leq x$ by telescoping, and is a direct computation that can be compared to the $\\log x$ scale suggested by the Prime Number Theorem.\n  - The minimal gap up to $x$ among consecutive primes with both primes at least $5$ (to exclude the exceptional initial gap between $2$ and $3$),\n    $$ G_{\\min}^{\\geq 5}(x) = \\min\\{ g(p_n) : p_n \\geq 5 \\text{ and } p_{n+1} \\leq x \\}. $$\n  - The ratio of the maximal observed gap to the natural logarithm,\n    $$ R_1(x) = \\frac{G_{\\max}(x)}{\\log x}, $$\n    and the ratio of the maximal observed gap to the square of the natural logarithm,\n    $$ R_2(x) = \\frac{G_{\\max}(x)}{(\\log x)^2}. $$\n- Compares $G_{\\max}(x)$ empirically to the baselines $\\log x$ and $(\\log x)^2$ via the ratios $R_1(x)$ and $R_2(x)$.\n\nUse the following test suite of $x$ values:\n- $x = 30$ (small-scale behavior and boundary effects),\n- $x = 10^5$,\n- $x = 10^6$,\n- $x = 3 \\cdot 10^6$,\n- $x = 10^7$ (upper limit).\n\nFor each $x$ in the test suite, compute and report the list\n`[x, G_max(x), g_bar(x), G_min_geq_5(x), R_1(x), R_2(x)]`.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the sublist above for the corresponding test case, in the same order as given. All floating-point values should be printed to six decimal places. For example, the outer structure should look like\n$$ [\\,[\\cdots],\\,[\\cdots],\\,[\\cdots],\\,[\\cdots],\\,[\\cdots]\\,] $$\nwith no spaces after commas.\n\nAll answers are pure numbers with no physical units. Angles are not involved. Percentages are not involved; ratios are to be expressed as decimals. The program must be self-contained and require no user input, must not access external files or networks, and must run deterministically.", "solution": "The problem posed is a well-defined exercise in computational number theory, requiring an empirical investigation of the distribution of prime numbers and the gaps between them. The problem is scientifically sound, mathematically consistent, and computationally feasible. It is grounded in established number-theoretic concepts such as the Prime Number Theorem and heuristic models of prime gaps. I will therefore proceed with a complete solution.\n\nThe solution methodology is structured into two main phases: first, the efficient generation of a list of prime numbers up to the specified limit $X = 10^7$; and second, the computation of the required statistical measures for each value of $x$ in the provided test suite.\n\n**1. Prime Number Generation: The Sieve of Eratosthenes**\n\nTo perform any analysis of primes, we must first generate them. For the given range up to $X = 10^7$, the most appropriate algorithm is the Sieve of Eratosthenes. This classical algorithm is renowned for its efficiency and conceptual elegance.\n\nThe principle of the sieve is based on a fundamental property of composite numbers: any composite number $n$ has at least one prime factor $p$ such that $p \\leq \\sqrt{n}$. The algorithm works as follows:\n- We create a boolean array, let us call it `is_prime`, of size $X+1$, initializing all entries from $2$ to $X$ as true. The numbers $0$ and $1$ are marked as not prime by definition.\n- We begin with the first prime number, $p=2$. We iterate through its multiples ($2p, 3p, \\dots$) and mark them as not prime in our array.\n- We then find the next number in the array that is still marked as prime; this must be the next prime number, which is $3$. We repeat the process, marking all multiples of $3$ as not prime.\n- This process continues for all primes $p$ up to $\\sqrt{X}$. An optimization is to start marking multiples of $p$ from $p^2$, as any smaller multiple $k \\cdot p$ with $k  p$ would have already been marked as composite by one of $k$'s prime factors (which is smaller than $p$).\n\nThe time complexity of this algorithm is approximately $O(X \\log \\log X)$, which is very efficient and allows for the generation of primes up to $10^7$ in a few seconds on a standard computer. After the sieve has run, the `is_prime` array allows for the extraction of an ordered list of all prime numbers up to $X$.\n\n**2. Computation of Prime Gap Statistics**\n\nWith the ordered list of primes, denoted as the array `primes`, we can proceed to calculate the required quantities for each test value of $x \\in \\{30, 10^5, 10^6, 3 \\cdot 10^6, 10^7\\}$.\n\nFor each value of $x$:\n\nFirst, we must identify the set of primes less than or equal to $x$. Let these be $\\{p_1, p_2, \\dots, p_k\\}$, where $p_k$ is the largest prime not exceeding $x$. The count of these primes is $k = \\pi(x)$. Using a pre-computed sorted array of all primes up to $10^7$, we can efficiently find $k$ by performing a binary search for $x$. The sub-array `primes[0:k]` then contains exactly the primes we need.\n\nThe required statistics are calculated as follows:\n\n-   **Maximal Observed Gap, $G_{\\max}(x)$**: This is defined as $G_{\\max}(x) = \\max\\{ g(p_n) : p_{n+1} \\leq x \\}$. This condition implies we consider all consecutive prime pairs $(p_n, p_{n+1})$ where both primes are less than or equal to $p_k$. This corresponds to the maximum of the differences $p_{n+1} - p_n$ for $n$ from $1$ to $k-1$. This is programmatically found by taking the maximum value of the array of differences computed from the prime subset.\n\n-   **Empirical Average Gap, $\\overline{g}(x)$**: This is defined by the formula $\\overline{g}(x) = \\frac{p_k - 2}{k - 1}$. The validity of this formula rests on the telescoping sum of gaps: $\\sum_{n=1}^{k-1} g(p_n) = \\sum_{n=1}^{k-1} (p_{n+1} - p_n) = p_k - p_1$. Since $p_1 = 2$, the sum is $p_k - 2$. The number of gaps is $k-1$. The calculation is a direct application of this formula using the determined values of $p_k$ and $k$. This empirical average can be compared to the heuristic $\\log x$ from the Prime Number Theorem.\n\n-   **Minimal Gap, $G_{\\min}^{\\geq 5}(x)$**: This is defined as $G_{\\min}^{\\geq 5}(x) = \\min\\{ g(p_n) : p_n \\geq 5 \\text{ and } p_{n+1} \\leq x \\}$. The condition $p_n \\geq 5$ means we begin our search for gaps starting from the pair $(p_3, p_4) = (5, 7)$. We consider all subsequent gaps $g(p_n)$ as long as $p_{n+1} \\leq x$. The Twin Prime Conjecture posits that there are infinitely many prime pairs $(p, p+2)$, which would imply that for sufficiently large $x$, $G_{\\min}^{\\geq 5}(x)$ should be $2$. For all the values of $x$ in the test suite, there exists at least one twin prime pair $(p, p+2)$ with $p \\geq 5$ and $p+2 \\leq x$, so we expect to find $G_{\\min}^{\\geq 5}(x) = 2$.\n\n-   **Ratios $R_1(x)$ and $R_2(x)$**: These are defined as $R_1(x) = \\frac{G_{\\max}(x)}{\\log x}$ and $R_2(x) = \\frac{G_{\\max}(x)}{(\\log x)^2}$. These ratios are computed directly using the natural logarithm function, `numpy.log`, and the previously calculated $G_{\\max}(x)$. $R_1(x)$ measures the maximal gap in units of the average gap size. $R_2(x)$ tests the scale of maximal gaps against the heuristic model proposed by Cramér. While Cramér's original probabilistic model suggests $\\limsup_{n \\to \\infty} \\frac{g(p_n)}{(\\log p_n)^2} = 1$, refined heuristics suggest the constant may be different. These empirical ratios provide a simple numerical test of these ideas.\n\nThe implementation will synthesize these steps into a single program that first builds the prime list and then iterates through the test cases to compute and format the results as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes empirical statistics of prime gaps up to a specified limit.\n    \"\"\"\n\n    # Define the upper bound for prime generation.\n    # The largest test case is 10^7, so we generate primes up to this limit.\n    limit = 10**7\n\n    # Step 1: Generate all primes up to the limit using the Sieve of Eratosthenes.\n    # This function returns a sorted numpy array of prime numbers.\n    def sieve_of_eratosthenes(n):\n        \"\"\"Generates primes up to n using the Sieve of Eratosthenes.\"\"\"\n        # Create a boolean array `is_prime` of size n + 1.\n        is_prime = np.ones(n + 1, dtype=bool)\n        is_prime[0] = is_prime[1] = False  # 0 and 1 are not prime.\n\n        # Iterate from p = 2 up to sqrt(n).\n        for p in range(2, int(np.sqrt(n)) + 1):\n            if is_prime[p]:\n                # Mark all multiples of p as not prime, starting from p*p.\n                is_prime[p*p::p] = False\n        \n        # Extract prime numbers from the boolean array.\n        primes = np.where(is_prime)[0]\n        return primes\n\n    primes = sieve_of_eratosthenes(limit)\n\n    # Step 2: Define the test cases from the problem statement.\n    test_cases = [\n        30,\n        100000,\n        1000000,\n        3000000,\n        10000000,\n    ]\n\n    all_results = []\n    # Step 3: Process each test case.\n    for x in test_cases:\n        # Find all primes less than or equal to x.\n        # np.searchsorted gives the index where x would be inserted to maintain order.\n        # 'right' side ensures that if x is prime, it's included.\n        k = np.searchsorted(primes, x, side='right')\n        primes_subset = primes[:k]\n        \n        # Ensure there are at least two primes to form a gap.\n        if k  2:\n            # This case is not reached with the given test suite.\n            continue\n            \n        p_k = primes_subset[-1]\n\n        # Calculate all gaps between consecutive primes up to x.\n        gaps = primes_subset[1:] - primes_subset[:-1]\n        \n        # a) Maximal observed gap up to x, G_max(x)\n        g_max = np.max(gaps) if gaps.size > 0 else 0\n\n        # b) Empirical average gap up to x, g_bar(x)\n        # Note: k is the count of primes, p_1=2, so k-1 is the number of gaps.\n        g_bar = (p_k - 2) / (k - 1)\n        \n        # c) Minimal gap for primes = 5, G_min_geq_5(x)\n        # Find the index of the first prime = 5.\n        # For all test cases, this will be index 2 (prime 5).\n        start_idx = np.searchsorted(primes_subset, 5)\n        \n        # Check if there are any gaps to consider.\n        if start_idx  len(gaps):\n            g_min_geq_5 = np.min(gaps[start_idx:])\n        else:\n            # No primes = 5, so no such gaps. Not possible with given tests.\n            g_min_geq_5 = float('inf')\n\n        # d) Ratios R1(x) and R2(x)\n        ln_x = np.log(x)\n        r1 = g_max / ln_x\n        r2 = g_max / (ln_x**2)\n        \n        # Store results for this case. x, g_max, g_min are integers.\n        # g_bar, r1, r2 are floating-point values.\n        result_list = [int(x), int(g_max), g_bar, int(g_min_geq_5), r1, r2]\n        all_results.append(result_list)\n\n    # Step 4: Format and print the final output exactly as required.\n    formatted_sublists = []\n    for res in all_results:\n        x_val, gmax_val, gbar_val, gmin_val, r1_val, r2_val = res\n        s = f\"[{x_val},{gmax_val},{gbar_val:.6f},{gmin_val},{r1_val:.6f},{r2_val:.6f}]\"\n        formatted_sublists.append(s)\n\n    # The final print statement must produce a single line in the specified format.\n    print(f\"[{','.join(formatted_sublists)}]\")\n\nsolve()\n```", "id": "3084537"}, {"introduction": "To build intuition about prime distribution, it is tempting to model the primes as a random sequence, an idea formalized in Cramér's model. This thought experiment guides you through deriving the expected number and variance of primes in short intervals based on simple probabilistic assumptions. You will then confront this model's predictions with the surprising realities revealed by Maier's theorem, providing a profound lesson on the limitations of intuition and the deep, underlying structure of the integers.", "problem": "Let $x$ be a large real parameter and let $\\pi(x)$ denote the prime counting function. Consider the short interval $[x, x+y]$ with $y=\\lambda \\ln x$, where $\\lambda>0$ is a fixed constant independent of $x$. In Cramér’s random model for primes, each integer $n\\geq 2$ is independently declared “prime” with probability $1/\\ln n$. Using only this modeling assumption and first principles of probability, derive the leading-order expressions (as $x\\to\\infty$ with fixed $\\lambda$) for the expected value and the variance of the random variable $\\pi(x+y)-\\pi(x)$.\n\nYou must justify the approximations used to replace sums by integrals or by Taylor expansions at scale $y=\\lambda \\ln x$. Then, explain qualitatively how these Cramér-model predictions compare with the actual behavior established by Maier’s phenomenon for primes in short intervals of length comparable to $\\ln x$.\n\nProvide your final answer as the ordered pair consisting of the leading-order mean and variance in terms of $\\lambda$ in the form of a row matrix. Do not provide a numerical approximation.", "solution": "The problem asks for the leading-order expressions for the expected value and variance of the number of primes in a short interval $[x, x+y]$, where $y = \\lambda \\ln x$ for a large parameter $x$ and a fixed constant $\\lambda>0$. This is to be done within the framework of Cramér's random model and then compared to the phenomenon described by Maier's theorem.\n\nFirst, we formalize the problem using Cramér's model. In this model, for each integer $n \\ge 2$, we associate an independent Bernoulli random variable $I_n$ such that:\n$$\nI_n = \\begin{cases} 1  \\text{if } n \\text{ is \"prime\"} \\\\ 0  \\text{if } n \\text{ is \"composite\"} \\end{cases}\n$$\nThe probability of success (i.e., of $n$ being \"prime\") is given as $p_n = P(I_n=1) = \\frac{1}{\\ln n}$. The events $\\{I_n=1\\}$ are assumed to be independent for all $n \\ge 2$.\n\nThe number of primes in the interval $[x, x+y]$ is the random variable $N$, defined as the sum of these indicator variables over the integers in the interval. For large $x$, we can consider the integers $n$ satisfying $x  n \\le x+y$.\n$$\nN = \\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} I_n\n$$\n\n**1. Expected Value**\n\nThe expected value of $N$, denoted $E[N]$, is found by the linearity of expectation:\n$$\nE[N] = E\\left[ \\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} I_n \\right] = \\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} E[I_n]\n$$\nThe expectation of a single Bernoulli variable $I_n$ is its success probability, $E[I_n] = p_n = \\frac{1}{\\ln n}$. Therefore,\n$$\nE[N] = \\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} \\frac{1}{\\ln n}\n$$\nTo find the leading-order behavior as $x \\to \\infty$, we must approximate this sum. The interval of summation is $[x, x+y]$, which has length $y = \\lambda \\ln x$. The number of integer terms in the sum is $\\lfloor x+y \\rfloor - \\lfloor x \\rfloor \\approx y = \\lambda \\ln x$.\n\nFor any integer $n$ in the summation range, $x  n \\le x+y$. For such $n$, the value of $\\ln n$ is close to $\\ln x$. We can make this precise. Since $x  n \\le x + \\lambda \\ln x$, we have:\n$$\n\\ln x  \\ln n \\le \\ln(x + \\lambda \\ln x) = \\ln\\left(x\\left(1 + \\frac{\\lambda \\ln x}{x}\\right)\\right) = \\ln x + \\ln\\left(1 + \\frac{\\lambda \\ln x}{x}\\right)\n$$\nAs $x \\to \\infty$, the term $\\frac{\\lambda \\ln x}{x} \\to 0$. Using the Taylor expansion $\\ln(1+u) = u + O(u^2)$ for small $u$, we get:\n$$\n\\ln n = \\ln x + O\\left(\\frac{\\ln x}{x}\\right)\n$$\nThis means that for all $n$ in the interval, $\\ln n$ is very close to $\\ln x$. The term $\\frac{1}{\\ln n}$ can be approximated by $\\frac{1}{\\ln x}$.\n$$\n\\frac{1}{\\ln n} = \\frac{1}{\\ln x + O\\left(\\frac{\\ln x}{x}\\right)} = \\frac{1}{\\ln x} \\left(1 + O\\left(\\frac{1}{x}\\right)\\right)^{-1} = \\frac{1}{\\ln x} \\left(1 - O\\left(\\frac{1}{x}\\right)\\right) = \\frac{1}{\\ln x} + O\\left(\\frac{1}{x \\ln x}\\right)\n$$\nThe dominant, or leading-order, term is $\\frac{1}{\\ln x}$. Replacing each term in the sum by this high-accuracy approximation:\n$$\nE[N] = \\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} \\left(\\frac{1}{\\ln x} + O\\left(\\frac{1}{x \\ln x}\\right)\\right)\n$$\nThe number of terms in the sum is $y$ up to an additive constant of at most $1$, which is negligible. So, approximately $y = \\lambda \\ln x$ terms.\n$$\nE[N] \\approx (\\lambda \\ln x) \\cdot \\frac{1}{\\ln x} = \\lambda\n$$\nThe error term is of order $y \\cdot O\\left(\\frac{1}{x \\ln x}\\right) = (\\lambda \\ln x) \\cdot O\\left(\\frac{1}{x \\ln x}\\right) = O\\left(\\frac{\\lambda}{x}\\right)$, which vanishes as $x \\to \\infty$. Thus, the leading-order expression for the expected value is:\n$$\nE[N] \\approx \\lambda\n$$\nThis can be confirmed by approximating the sum with an integral:\n$$\nE[N] \\approx \\int_x^{x+y} \\frac{dt}{\\ln t}\n$$\nBy the Mean Value Theorem for integrals, for some $c \\in (x, x+y)$, the integral equals $(x+y-x) \\frac{1}{\\ln c} = \\frac{y}{\\ln c}$. Since $c \\sim x$ as $x \\to \\infty$, $\\ln c \\sim \\ln x$. The integral is asymptotic to $\\frac{y}{\\ln x} = \\frac{\\lambda \\ln x}{\\ln x} = \\lambda$.\n\n**2. Variance**\n\nThe variance of $N$, denoted $V[N]$, is calculated next. Since the random variables $I_n$ are independent by the model's assumption, the variance of the sum is the sum of the variances:\n$$\nV[N] = V\\left[ \\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} I_n \\right] = \\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} V[I_n]\n$$\nThe variance of a Bernoulli variable with parameter $p_n$ is $V[I_n] = p_n(1-p_n)$. So,\n$$\nV[N] = \\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} \\frac{1}{\\ln n}\\left(1 - \\frac{1}{\\ln n}\\right) = \\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} \\frac{1}{\\ln n} - \\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} \\frac{1}{(\\ln n)^2}\n$$\nThe first term is exactly the expected value $E[N]$, for which we have already established the leading-order behavior is $\\lambda$.\n$$\n\\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} \\frac{1}{\\ln n} = \\lambda + O\\left(\\frac{1}{x}\\right)\n$$\nFor the second term, we use the same approximation as before: for $n$ in the interval, $\\ln n \\approx \\ln x$.\n$$\n\\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} \\frac{1}{(\\ln n)^2} \\approx (\\text{number of terms}) \\times \\frac{1}{(\\ln x)^2} \\approx y \\cdot \\frac{1}{(\\ln x)^2}\n$$\nSubstituting $y = \\lambda \\ln x$, we get:\n$$\n\\sum_{n=\\lfloor x \\rfloor+1}^{\\lfloor x+y \\rfloor} \\frac{1}{(\\ln n)^2} \\approx (\\lambda \\ln x) \\cdot \\frac{1}{(\\ln x)^2} = \\frac{\\lambda}{\\ln x}\n$$\nThis term tends to $0$ as $x \\to \\infty$. It is a lower-order correction.\nCombining the terms for the variance:\n$$\nV[N] \\approx \\lambda - \\frac{\\lambda}{\\ln x}\n$$\nAs $x \\to \\infty$, the term $\\frac{\\lambda}{\\ln x}$ vanishes, so the leading-order expression for the variance is:\n$$\nV[N] \\approx \\lambda\n$$\nTherefore, within Cramér's model, both the mean and the variance of the number of primes in the interval $[x, x+\\lambda \\ln x]$ are approximately $\\lambda$ for large $x$. This suggests that the distribution of primes in such an interval is well-approximated by a Poisson distribution with parameter $\\lambda$.\n\n**3. Comparison with Maier's Phenomenon**\n\nThe predictions of the Cramér model can be compared with rigorous results from number theory concerning the distribution of primes in short intervals.\n\n*   **Cramér Model Prediction**: The number of primes $N$ in $[x, x+\\lambda \\ln x]$ is a random variable with $E[N] \\approx \\lambda$ and $V[N] \\approx \\lambda$. The distribution of $N$ is approximately Poisson($\\lambda$). Standard deviations from the mean are of the order $\\sqrt{\\lambda}$, and large deviations are exponentially rare. For example, the probability of observing $2\\lambda$ primes when $\\lambda$ are expected is very small.\n\n*   **Maier's Phenomenon (Actual Behavior)**: In 1985, Helmut Maier proved a surprising result that contradicts the simple Poissonian picture. The Prime Number Theorem suggests that the number of primes in $[x, x+y]$ should be approximately $\\text{li}(x+y) - \\text{li}(x) \\approx \\frac{y}{\\ln x}$. For $y=\\lambda \\ln x$, this expected number is $\\lambda$, matching the Cramér model's mean. However, Maier showed that there are systematic, large-scale deviations from this average behavior.\n\nMaier's theorem shows that for any large constant $M > 1$, there exist sequences of $x \\to \\infty$ for which the number of primes in the much longer interval $[x, x+(\\ln x)^M]$ is consistently greater than the expected number by a factor, and other sequences where it is consistently smaller. While the original theorem is stated for intervals of length $(\\ln x)^M$, the underlying principle applies to intervals of length $\\lambda \\ln x$ as well. The number of primes $\\pi(x+\\lambda\\ln x) - \\pi(x)$ can exhibit oscillations that are much larger than the $\\sqrt{\\lambda}$ fluctuations predicted by a Poisson model. For certain sequences of $x$, the count can be significantly and persistently different from $\\lambda$.\n\nThe fundamental reason for the failure of the Cramér model is its **independence assumption**. The property of an integer $n$ being prime is not independent of the primality of its neighbors. The distribution of primes is deeply connected to the arithmetic structure of integers. For instance, primality is related to divisibility by small primes. An integer is prime only if it is not divisible by any prime $p \\le \\sqrt{n}$. Maier's proof cleverly exploits the non-uniform distribution of integers that lack small prime factors. By choosing $x$ appropriately within a long arithmetic progression, one can land in regions of integers that are unusually \"favorable\" (having fewer small prime factors than average) or \"unfavorable\" for being prime, leading to clusters (more primes than expected) or voids (fewer primes than expected).\n\nIn summary, the Cramér model provides a useful first-order heuristic giving a mean count of $\\lambda$, but it fails to capture the subtle correlations in the sequence of primes. Maier's theorem demonstrates that the true variance in prime counts in short intervals is significantly larger than the variance of $\\lambda$ predicted by the Cramér model, reflecting the underlying arithmetic, non-random structure of prime numbers.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\lambda  \\lambda \\end{pmatrix}}\n$$", "id": "3084527"}]}