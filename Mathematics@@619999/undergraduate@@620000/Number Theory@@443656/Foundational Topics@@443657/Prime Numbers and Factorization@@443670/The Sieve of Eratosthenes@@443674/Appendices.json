{"hands_on_practices": [{"introduction": "The Sieve of Eratosthenes works by iteratively striking out multiples of primes. To analyze this ancient algorithm or implement modern, optimized versions like the segmented sieve, we must first be able to precisely count how many numbers are marked in any given interval. This exercise strengthens that foundational skill by connecting the abstract concept of multiples to a concrete counting formula using floor and ceiling functions, which are essential tools in computational number theory. [@problem_id:3093465]", "problem": "In the algorithmic step of the sieve of Eratosthenes, one fixes a prime $p$ and marks, within a given integer segment $[L,R]$ with $1 \\leq L \\leq R$, all positions whose indices are multiples of $p$. Assume that $[L,R]$ contains at least one multiple of $p$, and let $a$ denote the smallest multiple of $p$ in $[L,R]$. Using only core definitions (the definition of a prime number, the operational principle of the sieve of Eratosthenes, and the definitions and basic properties of the floor function $\\lfloor \\cdot \\rfloor$ and the ceiling function $\\lceil \\cdot \\rceil$), derive an exact, closed-form expression for the number of marked positions in $[L,R]$ as a function of $p$, $L$, $R$, and $a$.\n\nThen, apply your derivation to compute the exact number of positions marked when $p=9973$, $L=1,234,567$, and $R=1,345,678$. Express your final numerical count exactly with no rounding.", "solution": "The sieve of Eratosthenes proceeds by, for each prime $p$, marking all multiples of $p$ in the working range. In a fixed segment $[L,R]$ of the positive integers, the marked positions arising from a given prime $p$ are precisely the integers of the form $pm$ with $m \\in \\mathbb{Z}$ such that $L \\leq pm \\leq R$. By assumption, there is at least one multiple of $p$ in $[L,R]$, and we define $a$ to be the smallest such multiple:\n$$\na = \\min\\{ pm : m \\in \\mathbb{Z},\\, L \\leq pm \\leq R \\}.\n$$\nEquivalently, by the definition of the ceiling function, the smallest multiple of $p$ that is at least $L$ is\n$$\na = p \\cdot \\left\\lceil \\frac{L}{p} \\right\\rceil ,\n$$\nand the largest multiple of $p$ that is at most $R$ is\n$$\nb = p \\cdot \\left\\lfloor \\frac{R}{p} \\right\\rfloor .\n$$\nThe marked positions in $[L,R]$ form an arithmetic progression with common difference $p$ starting at $a$:\n$$\na,\\; a+p,\\; a+2p,\\; \\dots,\\; a+kp \\leq R,\n$$\nfor integers $k \\geq 0$. Let $K$ denote the largest integer $k$ such that $a + kp \\leq R$. By definition of the floor function, the inequality $a + kp \\leq R$ is equivalent to $k \\leq \\frac{R-a}{p}$, hence\n$$\nK = \\left\\lfloor \\frac{R-a}{p} \\right\\rfloor .\n$$\nSince the progression starts at $k=0$ and ends at $k=K$, the number of terms (and thus the number of marked positions in $[L,R]$) is\n$$\n\\left\\lfloor \\frac{R-a}{p} \\right\\rfloor + 1.\n$$\nThis establishes the closed-form count from first principles.\n\nIt is instructive to connect this expression to a complementary count using endpoints. Substituting $a = p \\cdot \\left\\lceil \\frac{L}{p} \\right\\rceil$ gives\n$$\n\\left\\lfloor \\frac{R-a}{p} \\right\\rfloor + 1\n= \\left\\lfloor \\frac{R}{p} - \\left\\lceil \\frac{L}{p} \\right\\rceil \\right\\rfloor + 1.\n$$\nFor any real $x$ and integer $n$, the floor satisfies $\\lfloor x - n \\rfloor = \\lfloor x \\rfloor - n$. Applying this with $x = \\frac{R}{p}$ and $n = \\left\\lceil \\frac{L}{p} \\right\\rceil$ yields\n$$\n\\left\\lfloor \\frac{R}{p} \\right\\rfloor - \\left\\lceil \\frac{L}{p} \\right\\rceil + 1.\n$$\nFor integer $L$ and positive real $p$, one has the identity\n$$\n\\left\\lceil \\frac{L}{p} \\right\\rceil = \\left\\lfloor \\frac{L-1}{p} \\right\\rfloor + 1,\n$$\nwhich follows because the smallest integer $m$ with $m \\geq \\frac{L}{p}$ is exactly one more than the largest integer $n$ with $n \\leq \\frac{L}{p} - 1 = \\frac{L-1}{p}$. Substituting this identity gives the equivalent form\n$$\n\\left\\lfloor \\frac{R}{p} \\right\\rfloor - \\left( \\left\\lfloor \\frac{L-1}{p} \\right\\rfloor + 1 \\right) + 1\n= \\left\\lfloor \\frac{R}{p} \\right\\rfloor - \\left\\lfloor \\frac{L-1}{p} \\right\\rfloor,\n$$\nwhich is the canonical count of multiples of $p$ in $[L,R]$ computed directly by endpoints.\n\nWe now compute the requested numerical count for $p=9973$, $L=1,234,567$, and $R=1,345,678$.\n\nFirst, compute $\\left\\lfloor \\frac{R}{p} \\right\\rfloor$:\n$$\n\\left\\lfloor \\frac{1345678}{9973} \\right\\rfloor = 134,\n$$\nsince $9973 \\cdot 134 = 1336382 \\leq 1345678$ and $9973 \\cdot 135 = 1346355 > 1345678$.\n\nNext, compute $\\left\\lfloor \\frac{L-1}{p} \\right\\rfloor$:\n$$\n\\left\\lfloor \\frac{1234566}{9973} \\right\\rfloor = 123,\n$$\nsince $9973 \\cdot 123 = 1226679 \\leq 1234566$ and $9973 \\cdot 124 = 1236652 > 1234566$.\n\nTherefore, the exact count of marked positions is\n$$\n\\left\\lfloor \\frac{R}{p} \\right\\rfloor - \\left\\lfloor \\frac{L-1}{p} \\right\\rfloor = 134 - 123 = 11.\n$$\nEquivalently, one can compute $a = p \\cdot \\left\\lceil \\frac{L}{p} \\right\\rceil = 9973 \\cdot 124 = 1236652$, and then\n$$\n\\left\\lfloor \\frac{R-a}{p} \\right\\rfloor + 1\n= \\left\\lfloor \\frac{1345678 - 1236652}{9973} \\right\\rfloor + 1\n= \\left\\lfloor \\frac{109026}{9973} \\right\\rfloor + 1\n= \\left\\lfloor 10.935\\ldots \\right\\rfloor + 1\n= 10 + 1\n= 11,\n$$\nwhich matches the endpoint computation and confirms the derived formula.", "answer": "$$\\boxed{11}$$", "id": "3093465"}, {"introduction": "The Sieve of Eratosthenes is elegant, but its correctness relies on subtle properties of prime numbers. For instance, a composite number like 12 is marked by both prime 2 and prime 3; does this redundancy affect the final outcome? This practice guides you through a formal proof that the algorithm correctly identifies all primes, then challenges you to quantify the maximum number of times any single number can be marked—a key step in analyzing the algorithm's computational workload. [@problem_id:3093460]", "problem": "Consider the classical Sieve of Eratosthenes procedure to enumerate all prime numbers up to a fixed bound $N \\in \\mathbb{N}$: initialize an array indexed by the integers from $2$ through $N$, with all entries unmarked. For each integer $p$ from $2$ to $\\lfloor \\sqrt{N} \\rfloor$, if the entry for $p$ is unmarked (so $p$ is treated as prime at this stage), then mark every multiple of $p$ beginning at $p^{2}$ and proceeding in steps of $p$ (that is, mark $p^{2}, p^{2} + p, p^{2} + 2p, \\dots$ up to $N$). At the end, the unmarked entries are declared to be prime.\n\nUsing only the Fundamental Theorem of Arithmetic (FTA) and basic properties of divisibility, do the following:\n- Give a rigorous argument that, in this sieve, if some composite integer $n \\leq N$ happens to be marked more than once because it is a multiple of several distinct primes, then this repeated marking has no adverse effect on the correctness of the sieve’s output (that is, the set of unmarked numbers equals the set of primes $\\leq N$).\n- Quantify the worst-case multiplicity of markings per integer in this sieve. Specifically, define $M(N)$ to be the maximum, over all $n \\leq N$, of the number of distinct primes $q$ for which the marking pass of $q$ marks $n$. Determine an exact expression for $M(N)$ in closed form as a function of $N$ and the prime sequence $\\{p_{i}\\}_{i \\geq 1}$, where $p_{i}$ denotes the $i$-th prime.\n\nYour final answer must be given as a single closed-form analytic expression for $M(N)$. No numerical rounding is required.", "solution": "The problem statement is parsed and validated as being self-contained, scientifically grounded in number theory, and well-posed. The problem consists of two parts: a proof regarding the correctness of the Sieve of Eratosthenes and the derivation of an expression for the worst-case marking multiplicity.\n\n**Part 1: Rigorous Argument for Correctness**\n\nThe goal is to demonstrate that the set of unmarked numbers at the end of the Sieve of Eratosthenes procedure is precisely the set of prime numbers less than or equal to $N$. This requires proving two assertions:\n1. Every prime number $p \\leq N$ remains unmarked.\n2. Every composite number $n \\leq N$ is marked.\n\n**Assertion 1: Primes Remain Unmarked**\nLet $p$ be a prime number such that $p \\leq N$. For $p$ to be marked, it must be a multiple of some prime $q$ for which the sieve performs a marking pass. The primes $q$ that are used for marking are those satisfying $q \\le \\lfloor \\sqrt{N} \\rfloor$.\n\nCase 1: $p  \\lfloor \\sqrt{N} \\rfloor$.\nIf $p$ were to be marked, it must be a multiple of some prime $q \\le \\lfloor \\sqrt{N} \\rfloor$. Since $p$ is prime, this would imply $p=q$. However, this contradicts our assumption that $p  \\lfloor \\sqrt{N} \\rfloor$. Thus, $p$ cannot be a multiple of any prime $q \\le \\lfloor \\sqrt{N} \\rfloor$ and, consequently, will not be marked.\n\nCase 2: $p \\le \\lfloor \\sqrt{N} \\rfloor$.\nIn this case, $p$ itself is one of the primes for which a marking pass is executed. The algorithm specifies that for a prime $p$, we mark its multiples starting from $p^2$. The numbers marked are $p^2, p^2+p, p^2+2p, \\dots$. Since $p  p^2$ for any prime $p \\ge 2$, the number $p$ itself is not in the list of numbers to be marked. Furthermore, $p$ cannot be marked by any other prime $q  p$, because $p$ is prime and thus not a multiple of $q$. Therefore, $p$ will remain unmarked.\n\nCombining both cases, no prime number $p \\leq N$ is ever marked by the Sieve of Eratosthenes.\n\n**Assertion 2: Composites are Marked**\nLet $n$ be a composite number such that $2 \\le n \\le N$. According to the Fundamental Theorem of Arithmetic (FTA), $n$ can be written as a product of prime numbers. Let $p$ be the smallest prime factor of $n$. We can write $n = p \\cdot k$ for some integer $k$. Since $p$ is the smallest prime factor of $n$, any prime factor of $k$ must be greater than or equal to $p$. This implies $k \\ge p$.\n\nFrom $n = pk$ and $k \\ge p$, we deduce that $n \\ge p^2$, which in turn implies $p \\le \\sqrt{n}$.\nSince $n \\le N$, we have $\\sqrt{n} \\le \\sqrt{N}$, and therefore $p \\le \\sqrt{N}$. As $p$ is an integer, this means $p \\le \\lfloor \\sqrt{N} \\rfloor$.\n\nThis shows that the smallest prime factor $p$ of any composite number $n \\le N$ is included in the set of primes used for marking. The algorithm executes a marking pass for $p$. In this pass, multiples of $p$ are marked, starting from $p^2$. Since $n$ is a multiple of $p$ and we have shown that $n \\ge p^2$, $n$ is guaranteed to be in the sequence $p^2, p^2+p, \\dots$ of numbers marked during the pass for $p$.\n\nThus, every composite number $n \\le N$ is marked at least once.\n\n**Effect of Repeated Markings**\nThe state of each number in the sieve is binary: unmarked or marked. The marking operation is idempotent; marking an already-marked number does not change its state. Our argument has shown that all composite numbers will be in the \"marked\" state at least once, and all prime numbers will always remain in the \"unmarked\" state. The fact that a composite number (e.g., $12$, which is marked by both $2$ and $3$) is processed in multiple marking passes is irrelevant to the final outcome. The final set of unmarked numbers will correctly be the set of primes up to $N$.\n\n**Part 2: Worst-Case Multiplicity of Markings, $M(N)$**\n\nWe are asked to find $M(N)$, the maximum number of times any integer $n \\le N$ is marked. An integer $n$ is marked by a prime $q$ during the sieve process if and only if three conditions are met:\n1. $q$ is a prime number such that $q \\le \\lfloor \\sqrt{N} \\rfloor$.\n2. $q$ is a divisor of $n$ (i.e., $q | n$).\n3. $n$ is a multiple of $q$ starting from $q^2$, which means $n \\ge q^2$.\n\nLet $m$ be the number of markings for a given $n \\le N$. Let the distinct primes marking $n$ be $\\{q_1, q_2, \\dots, q_m\\}$. To maximize $m$, we want to find an integer $n \\le N$ that is divisible by the largest possible number of distinct primes, each satisfying the marking conditions.\n\nTo maximize the number of prime factors for a number not exceeding $N$, we should construct this number from the smallest primes. Let us therefore seek to construct a number $n$ that is marked by the first $m$ primes, $\\{p_1, p_2, \\dots, p_m\\}$.\nFor such an $n$ to exist, it must satisfy the following for some integer $m$:\na) $n \\le N$.\nb) $n$ must be divisible by each of $p_1, \\dots, p_m$. The smallest such positive integer is their product, the primorial $P_m = \\prod_{i=1}^m p_i$. So, $n$ must be a multiple of $P_m$.\nc) For each $p_i$ in this set to mark $n$, $n$ must be $\\ge p_i^2$. This is most restrictive for the largest prime, $p_m$. So, we require $n \\ge p_m^2$.\nd) For each $p_i$ to be a marking prime in the sieve for $N$, we must have $p_i \\le \\lfloor \\sqrt{N} \\rfloor$. This is equivalent to $p_m \\le \\lfloor \\sqrt{N} \\rfloor$.\n\nCombining these, for a given $m$, a number marked $m$ times by the first $m$ primes can exist only if there is an integer $n \\le N$ that is a multiple of $P_m$ and satisfies $n \\ge p_m^2$. Let us find the smallest such integer, $n_m^*$, and check if it is less than or equal to $N$.\nThe multiples of $P_m$ are $P_m, 2P_m, 3P_m, \\dots$. The smallest multiple of $P_m$ that is greater than or equal to $p_m^2$ is given by $n_m^* = k \\cdot P_m$ where $k = \\lceil \\frac{p_m^2}{P_m} \\rceil$.\nSo, $n_m^* = \\left\\lceil \\frac{p_m^2}{\\prod_{i=1}^m p_i} \\right\\rceil \\left(\\prod_{i=1}^m p_i\\right)$.\n\nA multiplicity of $m$ markings (by the first $m$ primes) is achievable if and only if $n_m^* \\le N$. If we can find such an $n_m^* \\le N$, then the condition $p_m \\le \\lfloor \\sqrt{N} \\rfloor$ is automatically satisfied, since $p_m^2 \\le n_m^* \\le N$ implies $p_m \\le \\sqrt{N}$.\n\nTherefore, $M(N)$ is simply the largest integer $m$ for which this condition holds. Any other choice of $m$ primes would result in a larger product and a larger $n^*$ value, making it less likely to be $\\le N$. Thus, we don't need to consider any set of marking primes other than the first $m$ primes.\n\nThe maximum multiplicity $M(N)$ is the largest integer $m$ satisfying the inequality:\n$$ \\left\\lceil \\frac{p_m^2}{\\prod_{i=1}^m p_i} \\right\\rceil \\left(\\prod_{i=1}^m p_i\\right) \\le N $$\nThis can be expressed as:\n$$ M(N) = \\max\\left\\{m \\in \\mathbb{N} \\mid \\left\\lceil \\frac{p_m^2}{\\prod_{i=1}^m p_i} \\right\\rceil \\left(\\prod_{i=1}^m p_i\\right) \\le N\\right\\} $$\nwhere $\\mathbb{N}$ is the set of natural numbers $\\{1, 2, 3, \\dots\\}$ and if the set is empty (e.g., for $N4$), the maximum is taken to be $0$. This expression is an exact, closed-form definition of $M(N)$ as a function of $N$ and the prime sequence $\\{p_i\\}$.\nFor $m=1$, the value is $\\lceil \\frac{2^2}{2} \\rceil \\cdot 2 = 4$. For $m=2$, the value is $\\lceil \\frac{3^2}{6} \\rceil \\cdot 6 = 12$. For $m \\ge 3$, it can be shown that $\\prod_{i=1}^m p_i  p_m^2$, so the ceiling term is $1$, and the condition simplifies to $\\prod_{i=1}^m p_i \\le N$.\nThe general expression remains valid for all $m \\ge 1$.", "answer": "$$\\boxed{\\max\\left\\{m \\in \\mathbb{N} \\mid \\left\\lceil \\frac{p_m^2}{\\prod_{i=1}^m p_i} \\right\\rceil \\left(\\prod_{i=1}^m p_i\\right) \\le N\\right\\}}$$", "id": "3093460"}, {"introduction": "A critical step in the Sieve of Eratosthenes is to continue the process for all primes up to $\\lfloor \\sqrt{n} \\rfloor$. Is this bound arbitrary, or is it essential to the algorithm's logic? This problem presents a hypothetical scenario where the sieve is stopped prematurely to test your understanding of this crucial boundary condition. By determining the exact conditions under which this modified algorithm fails, you will develop a deeper appreciation for why the $\\sqrt{n}$ limit is a mathematical necessity for the sieve's correctness. [@problem_id:3093455]", "problem": "Consider the following variant of the sieve of Eratosthenes. Given an integer bound $n \\geq 2$, initialize a boolean array indexed by the integers $2,3,\\dots,n$ as \"potentially prime.\" For each integer $p$ that is currently \"potentially prime\" with $2 \\leq p \\leq B(n)$, mark all integers of the form $p^{2}, p^{2}+p, p^{2}+2p, \\dots$ (that do not exceed $n$) as \"composite.\" At the end, declare as \"prime\" every integer that remains \"potentially prime.\" In the classical sieve, one takes $B(n)=\\lfloor \\sqrt{n} \\rfloor$. In the variant considered here, one stops too early at\n$$\nB(n)=\\lfloor \\sqrt{n} \\rfloor - 1.\n$$\nYour tasks are:\n- Construct an explicit counterexample $n$ showing that this early stopping can cause the sieve to incorrectly classify a composite number as prime, and determine the smallest such $n$.\n- Derive a necessary and sufficient condition on $n$ under which this failure occurs, and compress this condition into a single analytic expression $f(n)$ that equals $1$ if failure occurs for the sieve with $B(n)=\\lfloor \\sqrt{n} \\rfloor - 1$ and equals $0$ otherwise.\n\nYou may use the following foundational facts about divisibility:\n- If an integer $m \\geq 2$ is composite, then it has a prime divisor $p$ with $p \\leq \\sqrt{m}$.\n- In the sieve of Eratosthenes, when correctly implemented with $B(n)=\\lfloor \\sqrt{n} \\rfloor$, every composite $m \\leq n$ is marked by the step corresponding to its least prime factor.\n\nDefine the characteristic function of the set of prime numbers by\n$$\n\\chi_{\\mathbb{P}}(k)=\\begin{cases}\n1  \\text{if $k$ is prime},\\\\\n0  \\text{if $k$ is composite or $k2$}.\n\\end{cases}\n$$\nExpress your final answer as a row matrix with two entries: the first entry is the smallest integer $n$ exhibiting failure, and the second entry is the closed-form analytic expression $f(n)$ in terms of $n$. No rounding is required, and no units are involved.", "solution": "The problem describes a variant of the sieve of Eratosthenes for finding prime numbers up to an integer $n \\geq 2$. The process involves marking multiples of \"potentially prime\" numbers. The key feature of this variant is that the sieving process is stopped prematurely. In the classical sieve, one marks multiples of primes up to $\\lfloor \\sqrt{n} \\rfloor$. In this variant, one only marks multiples of \"potentially prime\" numbers $p$ in the range $2 \\leq p \\leq B(n)$, where the bound is $B(n) = \\lfloor \\sqrt{n} \\rfloor - 1$. A failure of the algorithm occurs if a composite number $m \\leq n$ is not marked as \"composite\" and is therefore incorrectly classified as \"prime.\"\n\nLet's establish the necessary and sufficient condition for such a failure. Let $k = \\lfloor \\sqrt{n} \\rfloor$. The set of integers used for sieving are the \"potentially prime\" numbers $p$ such that $2 \\leq p \\leq k-1$. The \"potentially prime\" numbers less than or equal to $k-1$ that are used sequentially for sieving are indeed the prime numbers. Any composite number $c \\le k-1$ would have a prime factor $p' \\le \\sqrt{c} \\le \\sqrt{k-1}  \\sqrt{k-1} \\le \\sqrt{\\sqrt{n}-1}$, and would already have been marked composite by a smaller prime. Therefore, the set of sieving numbers is precisely the set of primes $p$ satisfying $p \\leq k-1$.\n\nA composite number $m \\leq n$ is correctly marked (\"sieved\") if it is a multiple of at least one of these sieving primes. Conversely, a composite number $m$ is missed (incorrectly classified as prime) if and only if all of its prime factors are strictly greater than $k-1$. Let $p_{lpf}(m)$ denote the least prime factor of $m$. The condition for $m$ to be missed is $p_{lpf}(m)  k-1$. Since $p_{lpf}(m)$ must be a prime number, this is equivalent to the condition $p_{lpf}(m) \\geq k$.\n\nThus, the algorithm fails for a given $n$ if and only if there exists a composite number $m$ such that $m \\leq n$ and its least prime factor $p_{lpf}(m)$ satisfies $p_{lpf}(m) \\geq k = \\lfloor \\sqrt{n} \\rfloor$.\n\nLet's find the smallest possible composite number that could be missed. If such a composite number $m$ exists, its least prime factor $p=p_{lpf}(m)$ must satisfy $p \\geq k$. Any other prime factor $q$ of $m$ must also satisfy $q \\geq p \\geq k$. The smallest such composite number would be formed by the product of the smallest possible prime factors satisfying this condition. Let $p_k$ be the smallest prime number such that $p_k \\geq k$. The smallest composite number $m$ satisfying $p_{lpf}(m) \\geq k$ is $m_{min} = p_k^2$.\n\nTherefore, the sieve fails if and only if this smallest candidate for a missed composite, $m_{min} = p_k^2$, is within the specified range, i.e., $p_k^2 \\leq n$. So, the condition for failure is:\n$$\n(\\min\\{p \\in \\mathbb{P} \\mid p \\geq \\lfloor \\sqrt{n} \\rfloor\\})^2 \\leq n\n$$\nwhere $\\mathbb{P}$ is the set of prime numbers.\n\nLet's analyze this condition by considering two cases for $k = \\lfloor \\sqrt{n} \\rfloor$.\nCase 1: $k$ is a prime number.\nIn this case, the smallest prime $p_k$ greater than or equal to $k$ is $k$ itself. So, $p_k=k$. The failure condition becomes $k^2 \\leq n$. From the definition of the floor function, $k = \\lfloor \\sqrt{n} \\rfloor$ implies $k \\leq \\sqrt{n}$, which upon squaring yields $k^2 \\leq n$. Thus, the condition is always satisfied when $k = \\lfloor \\sqrt{n} \\rfloor$ is prime.\n\nCase 2: $k$ is a composite number.\nIn this case, the smallest prime $p_k$ greater than or equal to $k$ must be strictly greater than $k$, so $p_k \\geq k+1$. The failure condition requires $p_k^2 \\leq n$. However, from the definition of the floor function, $k = \\lfloor \\sqrt{n} \\rfloor$ implies $\\sqrt{n}  k+1$, which upon squaring yields $n  (k+1)^2$. Combining these inequalities, we have $n  (k+1)^2 \\leq p_k^2$. This means $n  p_k^2$, so the failure condition $p_k^2 \\leq n$ can never be satisfied when $k = \\lfloor \\sqrt{n} \\rfloor$ is composite.\n\nFrom these two cases, we deduce that the algorithm fails if and only if $k = \\lfloor \\sqrt{n} \\rfloor$ is a prime number.\n\nThis establishes the necessary and sufficient condition. Now we can address the specific tasks.\n\nTask 1: Find the smallest integer $n \\geq 2$ that exhibits failure.\nWe seek the smallest $n \\geq 2$ such that $\\lfloor \\sqrt{n} \\rfloor$ is a prime number.\n- For $n=2, 3$: $\\lfloor \\sqrt{2} \\rfloor = 1$, $\\lfloor \\sqrt{3} \\rfloor = 1$. The number $1$ is not prime. No failure.\n- For $n=4$: $\\lfloor \\sqrt{4} \\rfloor = 2$. The number $2$ is prime. Thus, failure occurs. Let's verify: for $n=4$, $B(4) = \\lfloor \\sqrt{4} \\rfloor - 1 = 2-1 = 1$. The sieving loop `for p from 2 to 1` does not execute. All numbers from $2$ to $4$ are declared \"prime.\" This is incorrect for the composite number $4$.\nSince failure does not occur for $n=2$ or $n=3$, the smallest integer $n$ for which the sieve fails is $n=4$.\n\nTask 2: Derive a necessary and sufficient condition and express it as a function $f(n)$.\nAs derived above, the failure occurs if and only if $\\lfloor \\sqrt{n} \\rfloor$ is a prime number. We are asked to express this as an analytic function $f(n)$ that is $1$ for failure and $0$ otherwise. The problem defines the characteristic function of the prime numbers:\n$$\n\\chi_{\\mathbb{P}}(j)=\\begin{cases}\n1  \\text{if } j \\text{ is prime},\\\\\n0  \\text{if } j \\text{ is composite or } j2.\n\\end{cases}\n$$\nThis function evaluates to $1$ if its argument is prime and $0$ otherwise (for integers $\\ge 2$). The condition for failure is that the integer $j = \\lfloor \\sqrt{n} \\rfloor$ is prime. This is directly captured by applying the function $\\chi_{\\mathbb{P}}$ to $j$.\nTherefore, the function $f(n)$ is:\n$$\nf(n) = \\chi_{\\mathbb{P}}(\\lfloor \\sqrt{n} \\rfloor)\n$$\nThis function equals $1$ if $\\lfloor \\sqrt{n} \\rfloor$ is a prime number (the condition for failure) and $0$ otherwise.\n\nThe final answer consists of the smallest integer $n$ exhibiting failure and the expression for $f(n)$.\nSmallest $n$: $4$.\nFunction $f(n)$: $\\chi_{\\mathbb{P}}(\\lfloor \\sqrt{n} \\rfloor)$.\nWe present these in a row matrix as requested.", "answer": "$$\\boxed{\\begin{pmatrix} 4  \\chi_{\\mathbb{P}}(\\lfloor \\sqrt{n} \\rfloor) \\end{pmatrix}}$$", "id": "3093455"}]}