{"hands_on_practices": [{"introduction": "The deep connection between analytic functions and harmonic functions is a two-way street. Just as the real part of an analytic function is always harmonic, we can often reverse the process. This exercise challenges you to reconstruct a full analytic function, $f(z)$, starting only from its real part, $u(x,y)$, which could represent a physical potential. Mastering this technique by using the Cauchy-Riemann equations allows you to leverage the powerful toolkit of complex analysis to solve problems governed by Laplace's equation. [@problem_id:2249550]", "problem": "Consider an analytic function $f(z)$ of a complex variable $z=x+iy$, where $x$ and $y$ are real variables. The real part of this function is given by $u(x, y) = \\text{Re}[f(z)] = e^{-y}\\cos(x) + xy$. Given that the function satisfies the condition $f(0) = 1$, determine the function $f(z)$ expressed solely in terms of the complex variable $z$.", "solution": "We are given the real part of an analytic function $f(z)=u(x,y)+i v(x,y)$ as\n$$\nu(x,y)=\\exp(-y)\\cos x + x y,\n$$\nwith $z=x+i y$ and the condition $f(0)=1$. Since $f$ is analytic, its harmonic conjugate $v$ satisfies the Cauchy-Riemann equations:\n$$\nu_{x}=v_{y}, \\quad u_{y}=-v_{x}.\n$$\nCompute the partial derivatives of $u$:\n$$\nu_{x}=\\frac{\\partial}{\\partial x}\\big(\\exp(-y)\\cos x + x y\\big)=-\\exp(-y)\\sin x + y,\n$$\n$$\nu_{y}=\\frac{\\partial}{\\partial y}\\big(\\exp(-y)\\cos x + x y\\big)=-\\exp(-y)\\cos x + x.\n$$\nFrom $v_{y}=u_{x}$, integrate with respect to $y$:\n$$\nv(x,y)=\\int\\big(-\\exp(-y)\\sin x + y\\big)\\,dy=\\exp(-y)\\sin x + \\frac{y^{2}}{2} + \\phi(x),\n$$\nwhere $\\phi$ is a function of $x$ only. Differentiate this with respect to $x$:\n$$\nv_{x}=\\exp(-y)\\cos x + \\phi'(x).\n$$\nUse the second Cauchy-Riemann equation $v_{x}=-u_{y}$ to get\n$$\n\\exp(-y)\\cos x + \\phi'(x)=\\exp(-y)\\cos x - x \\;\\;\\Rightarrow\\;\\; \\phi'(x)=-x,\n$$\nhence\n$$\n\\phi(x)=-\\frac{x^{2}}{2}+C,\n$$\nwith constant $C\\in\\mathbb{R}$. Therefore\n$$\nv(x,y)=\\exp(-y)\\sin x + \\frac{y^{2}}{2} - \\frac{x^{2}}{2} + C,\n$$\nand the analytic function is\n$$\nf(z)=u+i v=\\big(\\exp(-y)\\cos x\\big)+i\\big(\\exp(-y)\\sin x\\big) + \\Big(x y + i\\big(\\frac{y^{2}}{2}-\\frac{x^{2}}{2}\\big)\\Big) + i C.\n$$\nImpose $f(0)=1$. At $(x,y)=(0,0)$ we have $u(0,0)=\\exp(0)\\cos 0=1$ and $v(0,0)=C$, so $f(0)=1+i C=1$ implies $C=0$.\n\nNow express $f$ purely in terms of $z$. Note that\n$$\n\\exp(i z)=\\exp(i x - y)=\\exp(-y)\\big(\\cos x + i \\sin x\\big),\n$$\nand\n$$\nz^{2}=(x+i y)^{2}=x^{2}-y^{2}+2 i x y.\n$$\nThen\n$$\n-\\frac{i}{2}z^{2}=-\\frac{i}{2}(x^{2}-y^{2})+xy =\\Big(x y\\Big)+i\\Big(\\frac{y^{2}}{2}-\\frac{x^{2}}{2}\\Big),\n$$\nso the remaining terms match exactly. Therefore\n$$\nf(z)=\\exp(i z)-\\frac{i}{2} z^{2},\n$$\nwhich also satisfies $f(0)=1$.", "answer": "$$\\boxed{\\exp(i z)-\\frac{i}{2} z^{2}}$$", "id": "2249550"}, {"introduction": "Harmonic functions possess remarkable properties, one of the most important being the maximum/minimum principle. This principle states that a non-constant harmonic function on a closed, bounded domain must attain its absolute maximum and minimum values on the boundary of the domain, never in the interior. In this practice, you will apply this powerful theorem to a potential defined on a unit disk to locate its points of highest and lowest value, a task with direct applications in fields like heat transfer and electrostatics. [@problem_id:2249485]", "problem": "In physics, the real part of an analytic complex function often represents a scalar potential, such as electrostatic potential or temperature distribution. Such functions are harmonic, meaning they satisfy Laplace's equation in regions where the complex function is analytic.\n\nConsider a harmonic potential function $\\Phi(x, y)$ defined on the closed unit disk, $D = \\{z \\in \\mathbb{C} : |z| \\leq 1\\}$, where $z=x+iy$. The potential is given by $\\Phi(x, y) = \\text{Re}(F(z))$ for the complex function $F(z) = (z-a)^2$. The constant $a$ is a real number specified as $a=1/2$.\n\nYour task is to locate the points on the disk $D$ where the potential $\\Phi(x,y)$ reaches its absolute maximum and absolute minimum values. Which of the following options correctly identifies the locations of the maximum (denoted $z_{max}$) and minimum (denoted $z_{min}$)?\n\nA. $z_{max} = 1$; $z_{min} = -1$.\n\nB. $z_{max} = -1$; $z_{min}$ are the two points in the set $\\{ \\frac{1}{4} + i\\frac{\\sqrt{15}}{4}, \\frac{1}{4} - i\\frac{\\sqrt{15}}{4} \\}$.\n\nC. $z_{max}$ are the two points in the set $\\{1, -1\\}$; $z_{min}$ are the two points in the set $\\{i, -i\\}$.\n\nD. $z_{max} = 1/2$; $z_{min} = -1$.\n\nE. $z_{max} = 1$; $z_{min}$ are the two points in the set $\\{ \\frac{1}{2} + i\\frac{\\sqrt{3}}{2}, \\frac{1}{2} - i\\frac{\\sqrt{3}}{2} \\}$.", "solution": "We are given $F(z)=(z-a)^{2}$ with $a=\\frac{1}{2}$ real, and $\\Phi(x,y)=\\operatorname{Re}(F(z))$ on the closed unit disk $D=\\{z\\in\\mathbb{C}:|z|\\leq 1\\}$. Since $F$ is analytic on a neighborhood of $D$, $\\Phi$ is harmonic on $D$. By the maximum/minimum principle for harmonic functions, a non-constant harmonic function attains its absolute maximum and minimum on the boundary $|z|=1$.\n\nWrite $z=x+iy$ and set $u=x-\\frac{1}{2}$, $v=y$. Then\n$$\nF(z)=(u+iv)^{2}=u^{2}-v^{2}+2iuv,\n$$\nso\n$$\n\\Phi(x,y)=\\operatorname{Re}(F(z))=u^{2}-v^{2}=(x-\\tfrac{1}{2})^{2}-y^{2}.\n$$\nRestricting to the boundary $x^{2}+y^{2}=1$, parametrize by $x=\\cos\\theta$, $y=\\sin\\theta$. Then\n$$\n\\Phi(\\theta)=(\\cos\\theta-\\tfrac{1}{2})^{2}-\\sin^{2}\\theta=\\cos^{2}\\theta-\\cos\\theta+\\tfrac{1}{4}-(1-\\cos^{2}\\theta)=2\\cos^{2}\\theta-\\cos\\theta-\\tfrac{3}{4}.\n$$\nLet $u=\\cos\\theta\\in[-1,1]$. Then\n$$\n\\Phi(u)=2u^{2}-u-\\tfrac{3}{4}.\n$$\nThis is a quadratic in $u$ with positive leading coefficient, so its minimum over $[-1,1]$ occurs at the vertex $u=\\frac{1}{4}$, and its maximum over $[-1,1]$ occurs at an endpoint. Compute the values:\n$$\n\\Phi\\!\\left(\\tfrac{1}{4}\\right)=2\\cdot\\tfrac{1}{16}-\\tfrac{1}{4}-\\tfrac{3}{4}=\\tfrac{1}{8}-1=-\\tfrac{7}{8},\n$$\n$$\n\\Phi(-1)=2\\cdot 1-(-1)-\\tfrac{3}{4}=\\tfrac{9}{4},\\quad \\Phi(1)=2\\cdot 1-1-\\tfrac{3}{4}=\\tfrac{1}{4}.\n$$\nTherefore, the absolute maximum is at $u=-1$, i.e., $x=\\cos\\theta=-1$, $y=0$, so $z_{\\max}=-1$. The absolute minima occur where $u=\\cos\\theta=\\frac{1}{4}$, which gives $x=\\frac{1}{4}$ and $y=\\pm\\sqrt{1-\\frac{1}{16}}=\\pm\\frac{\\sqrt{15}}{4}$, i.e., $z_{\\min}\\in\\left\\{\\frac{1}{4}\\pm i\\frac{\\sqrt{15}}{4}\\right\\}$.\n\nThese locations match option B.", "answer": "$$\\boxed{B}$$", "id": "2249485"}, {"introduction": "Theory comes to life when it can be tested and observed. This practice shifts our focus from analytical derivation to computational verification by exploring another fundamental property: the mean value property. You will write a program to numerically confirm that the value of a harmonic function at a point is precisely the average of its values on a surrounding circle. This hands-on coding exercise not only reinforces the theory but also demonstrates how computational tools can provide insight into abstract mathematical concepts. [@problem_id:2406764]", "problem": "You will design and implement a program to numerically verify the mean value property associated with solutions of the two-dimensional Laplace equation. The foundational base for this task is the definition of a harmonic function as a sufficiently smooth function $u(x,y)$ that satisfies the two-dimensional Laplace equation $\\Delta u = u_{xx} + u_{yy} = 0$, and the classical concept of averaging a function along a circle in the plane. Work entirely in purely mathematical terms. All angles must be in radians.\n\nYour task is to do the following:\n- For each test case, consider a function $u(x,y)$ defined on a subset of $\\mathbb{R}^2$, a center point $(x_0,y_0)$, a radius $r \\ge 0$, and a positive integer $M$.\n- Define the circular parametrization by $\\theta \\in [0,2\\pi)$, and the circle of radius $r$ centered at $(x_0,y_0)$ as $(x(\\theta),y(\\theta)) = (x_0 + r\\cos\\theta, y_0 + r\\sin\\theta)$.\n- Define the angular average of $u$ along the circle as the integral average over $\\theta \\in [0,2\\pi)$. Numerically approximate this angular average using $M$ equispaced samples $\\theta_j = \\frac{2\\pi j}{M}$, for $j=0,1,\\dots,M-1$. Use the simple equispaced sample mean as the numerical approximation to the angular average. When $r = 0$, interpret the circle as the single point $(x_0,y_0)$ and take the average to be $u(x_0,y_0)$.\n- For each test case, compute the absolute difference between the function value at the center and the numerical angular average on the circle, that is, compute $\\left|u(x_0,y_0) - \\overline{u}\\right|$ where $\\overline{u}$ is the numerical average described above.\n\nImplement the following test suite of $6$ cases, which jointly exercise typical behavior, edge cases, and contrast with a non-harmonic function. In all cases, angles are in radians:\n- Case $1$ (harmonic polynomial of degree $2$): $u(x,y) = x^2 - y^2$, with $(x_0,y_0) = (0.1,-0.2)$, $r = 0.4$, $M = 4096$.\n- Case $2$ (harmonic polynomial of degree $3$): $u(x,y) = x^3 - 3xy^2$, with $(x_0,y_0) = (-0.3,0.25)$, $r = 0.2$, $M = 4096$.\n- Case $3$ (harmonic but not polynomial; singular at the origin only): $u(x,y) = \\log\\!\\big(\\sqrt{x^2 + y^2}\\big)$, with $(x_0,y_0) = (0.5,0.4)$, $r = 0.3$, $M = 8192$. In this case, the entire circle lies at a distance strictly greater than $0$ from the origin.\n- Case $4$ (non-harmonic contrast): $u(x,y) = x^2 + y^2$, with $(x_0,y_0) = (0.1,0.2)$, $r = 0.4$, $M = 4096$.\n- Case $5$ (degenerate radius): $u(x,y) = x^2 - y^2$, with $(x_0,y_0) = (-0.75,0.6)$, $r = 0.0$, $M = 16$.\n- Case $6$ (coarse sampling on a non-polynomial harmonic function): $u(x,y) = \\log\\!\\big(\\sqrt{x^2 + y^2}\\big)$, with $(x_0,y_0) = (0.5,0.4)$, $r = 0.3$, $M = 32$.\n\nYour program must:\n- Implement the numerical procedure described above to approximate the angular average as a discrete mean over the $M$ samples.\n- For each case, compute and collect the absolute difference $\\left|u(x_0,y_0) - \\overline{u}\\right|$ as a floating-point number.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases $1$ through $6$, for example, $[r_1,r_2,r_3,r_4,r_5,r_6]$ where each $r_k$ is the floating-point absolute difference for case $k$.", "solution": "The problem as stated is valid, self-contained, and scientifically sound. It presents a standard task in computational physics: the numerical verification of a fundamental mathematical theorem. We shall proceed with the derivation of the solution.\n\nThe core of this problem rests on the Mean Value Property for harmonic functions. A function $u(x,y)$ of two real variables is defined as harmonic in a domain $\\Omega \\subseteq \\mathbb{R}^2$ if it is of class $C^2$ and satisfies the two-dimensional Laplace equation throughout $\\Omega$:\n$$\n\\Delta u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = 0\n$$\nThe Mean Value Theorem for harmonic functions is a central result in potential theory. It states that if $u$ is a harmonic function on a domain $\\Omega$, then for any point $(x_0, y_0) \\in \\Omega$ and any disk $D$ centered at $(x_0, y_0)$ that is fully contained in $\\Omega$, the value of the function at the center of the disk is equal to the average of its values on the boundary circle of that disk.\n\nLet the circle be denoted by $C_r$, with center $(x_0, y_0)$ and radius $r > 0$. We can parametrize this circle using the angle $\\theta \\in [0, 2\\pi)$ as $(x(\\theta), y(\\theta)) = (x_0 + r\\cos\\theta, y_0 + r\\sin\\theta)$. The theorem states:\n$$\nu(x_0, y_0) = \\frac{1}{2\\pi r} \\oint_{C_r} u(x,y) \\, ds = \\frac{1}{2\\pi} \\int_0^{2\\pi} u(x_0 + r\\cos\\theta, y_0 + r\\sin\\theta) \\, d\\theta\n$$\nwhere $ds$ is the arc length element. The problem requires us to numerically verify this property.\n\nThe numerical procedure specified is to approximate the continuous integral average with a discrete sample mean. We discretize the angle $\\theta$ into $M$ equispaced points:\n$$\n\\theta_j = \\frac{2\\pi j}{M}, \\quad \\text{for } j = 0, 1, \\dots, M-1\n$$\nThe corresponding points on the circle are $(x_j, y_j) = (x_0 + r\\cos\\theta_j, y_0 + r\\sin\\theta_j)$. The numerical approximation of the average, which we denote by $\\overline{u}$, is then the arithmetic mean of the function values at these points:\n$$\n\\overline{u} = \\frac{1}{M} \\sum_{j=0}^{M-1} u(x_j, y_j)\n$$\nThis is a standard numerical quadrature technique, equivalent to the rectangular rule or the trapezoidal rule for a periodic function integrated over its period.\n\nThe objective is to compute the absolute difference $\\left|u(x_0, y_0) - \\overline{u}\\right|$ for several test cases. For the special case where the radius $r=0$, the circle degenerates to the point $(x_0, y_0)$. The problem correctly specifies that in this case the average is simply $u(x_0, y_0)$, leading to an absolute difference of exactly $0$.\n\nWe will analyze the test cases based on these principles:\n\n-   Cases $1$, $2$, $3$, and $6$ involve functions that are harmonic in the domain containing the circle of integration.\n    -   In Case $1$, $u(x,y) = x^2 - y^2$. We verify its harmonicity: $u_{xx} = 2$, $u_{yy} = -2$, so $\\Delta u = 2-2=0$.\n    -   In Case $2$, $u(x,y) = x^3 - 3xy^2$. We verify: $u_{xx} = 6x$, $u_{yy} = -6x$, so $\\Delta u = 6x-6x=0$.\n    -   Cases $3$ and $6$ use $u(x,y) = \\log\\sqrt{x^2+y^2} = \\frac{1}{2}\\log(x^2+y^2)$. This function is harmonic everywhere except at the origin $(0,0)$. For the given parameters $(x_0,y_0)=(0.5,0.4)$ and $r=0.3$, the distance of the center from the origin is $\\sqrt{0.5^2+0.4^2} = \\sqrt{0.41} \\approx 0.64$. Since $r < \\sqrt{0.41}$, the circle does not enclose the singularity at $(0,0)$, so the function is harmonic on and inside the circle.\n    -   For these harmonic cases, the theoretical difference is $0$. The computed quantity $\\left|u(x_0, y_0) - \\overline{u}\\right|$ is therefore a measure of the numerical error of the discrete approximation. For polynomial functions of $\\sin\\theta$ and $\\cos\\theta$, the trapezoidal rule is extremely accurate, so for Cases $1$ and $2$ with large $M$, the error should be close to machine precision. For Case $3$ with $M=8192$, the error should be small. For Case $6$, with a much smaller $M=32$, the numerical error is expected to be significantly larger than in Case $3$.\n\n-   Case $4$ provides a contrast with a non-harmonic function, $u(x,y) = x^2 + y^2$. Here, $\\Delta u = 2+2=4 \\neq 0$. The Mean Value Theorem does not apply. The exact integral average is $u(x_0,y_0)+r^2$. The theoretical difference is $\\left|u(x_0,y_0) - (u(x_0,y_0)+r^2)\\right| = r^2$. For $r=0.4$, this is $0.16$. The numerical result should be very close to this value, as the quadrature is accurate for this integrand.\n\n-   Case $5$ is a degenerate case with $r=0$. As specified, $\\overline{u} = u(x_0, y_0)$, so the difference $\\left|u(x_0, y_0) - \\overline{u}\\right|$ is exactly $0$.\n\nThe implementation will consist of a main function that iterates through the provided test cases. For each case, it will evaluate $u(x_0, y_0)$ and calculate $\\overline{u}$ according to the discrete summation formula. The absolute difference is then computed and stored. A special condition handles the $r=0$ case as defined. The results are collected and formatted into the required output string.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of numerically verifying the mean value property for\n    harmonic functions.\n    \"\"\"\n\n    # Define the functions for each test case.\n    # Note: Using np.sqrt and np.log for vectorized operations.\n    u1 = lambda x, y: x**2 - y**2\n    u2 = lambda x, y: x**3 - 3*x*y**2\n    u3 = lambda x, y: np.log(np.sqrt(x**2 + y**2))\n    u4 = lambda x, y: x**2 + y**2\n    # Case 5 uses the same function as Case 1.\n    u5 = u1\n    # Case 6 uses the same function as Case 3.\n    u6 = u3\n\n    test_cases = [\n        # (function, (x0, y0), r, M)\n        {'u': u1, 'center': (0.1, -0.2), 'r': 0.4, 'M': 4096},\n        {'u': u2, 'center': (-0.3, 0.25), 'r': 0.2, 'M': 4096},\n        {'u': u3, 'center': (0.5, 0.4), 'r': 0.3, 'M': 8192},\n        {'u': u4, 'center': (0.1, 0.2), 'r': 0.4, 'M': 4096},\n        {'u': u5, 'center': (-0.75, 0.6), 'r': 0.0, 'M': 16},\n        {'u': u6, 'center': (0.5, 0.4), 'r': 0.3, 'M': 32},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        u_func = case['u']\n        x0, y0 = case['center']\n        r = case['r']\n        M = case['M']\n\n        # Calculate the function value at the center.\n        u_at_center = u_func(x0, y0)\n\n        # Calculate the numerical average on the circle.\n        if r == 0.0:\n            # Per problem definition, the average is the function value at the center.\n            u_average = u_at_center\n        else:\n            # Generate M equispaced angles from 0 to 2*pi (exclusive of 2*pi).\n            # theta_j = 2*pi*j/M for j=0, ..., M-1.\n            thetas = np.linspace(0, 2 * np.pi, M, endpoint=False)\n            \n            # Parametrize the circle points.\n            x_coords = x0 + r * np.cos(thetas)\n            y_coords = y0 + r * np.sin(thetas)\n            \n            # Evaluate the function at all points on the circle.\n            u_values_on_circle = u_func(x_coords, y_coords)\n            \n            # Compute the sample mean.\n            u_average = np.mean(u_values_on_circle)\n\n        # Compute the absolute difference.\n        abs_diff = np.abs(u_at_center - u_average)\n        results.append(abs_diff)\n    \n    # Format the output as a comma-separated list in brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2406764"}]}