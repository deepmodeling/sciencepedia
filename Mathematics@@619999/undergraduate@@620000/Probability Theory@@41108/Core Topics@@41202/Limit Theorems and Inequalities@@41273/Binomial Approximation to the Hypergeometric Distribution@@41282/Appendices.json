{"hands_on_practices": [{"introduction": "Calculating probabilities with the Hypergeometric formula can be computationally intensive, especially for large populations. This exercise [@problem_id:1346396] introduces a powerful simplification: approximating the Hypergeometric distribution with the Binomial distribution. We explore the conditions under which this approximation is valid—namely, when the sample size $n$ is a very small fraction of the total population $N$—and practice applying it to a realistic large-scale scenario.", "problem": "A large social media platform hosts a total of $N = 10,000,000$ active users. Within this user base, a specific group of $K = 1,000$ accounts are designated as verified \"influencers\". For a marketing study, a firm selects a random sample of $n = 500$ users from the entire active user population. Assuming this sample is selected without replacement, calculate the probability that the sample contains exactly one influencer account.\n\nProvide your answer as a single real number, rounded to three significant figures.", "solution": "The number of influencer accounts in a simple random sample without replacement from a finite population with $N$ total users and $K$ influencers follows a hypergeometric distribution. The probability that the sample of size $n$ contains exactly one influencer is\n$$\nP(X=1)=\\frac{\\binom{K}{1}\\binom{N-K}{n-1}}{\\binom{N}{n}}.\n$$\nSubstituting $N=10^{7}$, $K=10^{3}$, and $n=500$, we have\n$$\nP(X=1)=\\frac{\\binom{10^{3}}{1}\\binom{10^{7}-10^{3}}{499}}{\\binom{10^{7}}{500}}.\n$$\nBecause $n \\ll N$, the hypergeometric distribution is well-approximated by a binomial distribution with success probability $p=\\frac{K}{N}=10^{-4}$. Thus,\n$$\nP(X=1)\\approx \\binom{500}{1}\\,p\\,(1-p)^{499}=500\\cdot 10^{-4}\\,(1-10^{-4})^{499}=0.05\\,(0.9999)^{499}.\n$$\nTo evaluate $(0.9999)^{499}$ accurately, use logarithms and the Taylor expansion $\\ln(1-x)=-x-\\frac{x^{2}}{2}-\\frac{x^{3}}{3}-\\cdots$ for $|x|1$ with $x=10^{-4}$:\n$$\n\\ln\\big((0.9999)^{499}\\big)=499\\,\\ln(1-10^{-4})\\approx -499\\left(10^{-4}+\\frac{10^{-8}}{2}+\\frac{10^{-12}}{3}\\right).\n$$\nThis gives\n$$\n\\ln\\big((0.9999)^{499}\\big)\\approx -\\left(0.0499+0.000002495+1.663\\ldots\\times 10^{-10}\\right)\\approx -0.049902495,\n$$\nso\n$$\n(0.9999)^{499}\\approx \\exp(-0.049902495)\\approx 0.951322.\n$$\nTherefore,\n$$\nP(X=1)\\approx 0.05\\times 0.951322\\approx 0.047566.\n$$\nGiven that the finite population correction is negligible at the scale of three significant figures when $\\frac{n}{N}=5\\times 10^{-5}$, rounding to three significant figures yields\n$$\nP(X=1)\\approx 0.0476.\n$$", "answer": "$$\\boxed{0.0476}$$", "id": "1346396"}, {"introduction": "Building on our understanding of the Binomial approximation, we now encounter situations where a further simplification is possible and highly effective. This practice [@problem_id:1346441] illustrates how the Binomial distribution itself, when the number of trials $n$ is large and the success probability $p$ is small, can be approximated by the Poisson distribution. This two-step approximation, from Hypergeometric to Binomial and finally to Poisson, is a cornerstone of applied probability, particularly in quality control and risk analysis.", "problem": "A major publisher has just completed a print run of 1,000,000 copies of a highly anticipated novel. Due to a brief calibration error in the printing process, exactly 450 of these copies have a single, specific page printed upside down, making them defective. A large bookstore chain receives a shipment of 120 copies of this novel, selected at random from the entire print run.\n\nUsing a suitable approximation, calculate the probability that the bookstore's shipment contains at most one copy with the misprint. Round your final answer to four significant figures.", "solution": "Let $N=1,000,000$ be the total number of copies, $D=450$ the number of defective copies, and $n=120$ the sample size received by the bookstore. Let $X$ denote the number of defective copies in the sample. The exact distribution is hypergeometric:\n$$\n\\Pr(X=k)=\\frac{\\binom{D}{k}\\binom{N-D}{n-k}}{\\binom{N}{n}},\\quad k=0,1,\\dots,n.\n$$\nWe seek $\\Pr(X\\le 1)=\\Pr(X=0)+\\Pr(X=1)$. Because $n\\ll N$ and $p=D/N$ is very small, the hypergeometric is well-approximated by a binomial $X \\sim \\text{Binomial}(n,p)$ with\n$$\np=\\frac{D}{N}=\\frac{450}{10^{6}}=0.00045.\n$$\nSince $np=120\\times 0.00045=0.054\\ll 1$, a Poisson approximation with rate $\\lambda=np$ is suitable:\n$$\nX\\approx \\text{Poisson}(\\lambda),\\quad \\lambda=np=0.054.\n$$\nFor a Poisson variable,\n$$\n\\Pr(X\\le 1)=\\Pr(X=0)+\\Pr(X=1)=\\exp(-\\lambda)\\left(1+\\lambda\\right).\n$$\nSubstituting $\\lambda=0.054$,\n$$\n\\Pr(X\\le 1)\\approx \\exp(-0.054)\\left(1+0.054\\right).\n$$\nNumerically,\n$$\n\\exp(-0.054)\\left(1+0.054\\right)\\approx 0.998593\\ldots\n$$\nRounding to four significant figures gives $0.9986$.", "answer": "$$\\boxed{0.9986}$$", "id": "1346441"}, {"introduction": "So far, we have focused on counting successes within a fixed sample size. This final practice [@problem_id:1346383] expands our perspective to a different but related question: how many trials are needed to observe a predetermined number of successes? We will see that the same logic of approximation applies, allowing us to model this 'waiting-time' scenario using the Negative Binomial distribution instead of the more complex Negative Hypergeometric distribution. This exercise challenges you to move beyond direct calculation and identify the fundamental parameters that connect the real-world problem to its mathematical model.", "problem": "A semiconductor fabrication plant produces a large batch of $N$ identical Central Processing Units (CPUs). Due to manufacturing imperfections, a total of $K$ of these CPUs are defective, where $N$ and $K$ are both very large numbers. A quality assurance team is tasked with collecting exactly $m$ defective CPUs for a detailed failure analysis, where $m$ is a small integer. To do this, they sample CPUs one by one from the batch without replacement, testing each one until they have found the $m$-th defective unit.\n\nLet $X$ be the random variable representing the total number of CPUs that must be sampled to obtain the $m$-th defective one. The exact distribution of $X$ is a Negative Hypergeometric distribution. However, for a very large population $N$ such that the ratio $p_0 = K/N$ is a non-negligible constant, the distribution of $X$ can be well-approximated by a Negative Binomial distribution.\n\nThe probability mass function of a random variable $Y$ following a Negative Binomial distribution, denoted $Y \\sim \\text{NB}(r, p)$, is given by $P(Y=n) = \\binom{n-1}{r-1} p^r (1-p)^{n-r}$. This distribution is defined by two parameters: the number of successes to be found, $r$, and the probability of success in a single trial, $p$.\n\nIdentify the parameters $r$ and $p$ for the Negative Binomial distribution that approximates the distribution of $X$. Express your answer as a pair of symbolic expressions for $(r, p)$ in terms of the given quantities $N, K,$ and $m$.", "solution": "We are sampling without replacement from a finite population of size $N$ with $K$ defective items, seeking the $m$-th defective. The exact stopping-time distribution $X$ (the draw count at which the $m$-th defective is found) is Negative Hypergeometric. For very large $N$ with a non-negligible defect fraction $p_{0} = \\frac{K}{N}$, the dependence between draws becomes negligible, and sampling without replacement is well-approximated by sampling with replacement where each draw is an independent Bernoulli trial with success probability $p_{0}$.\n\nDefine a “success” as selecting a defective CPU. Under the with-replacement approximation, each draw is a Bernoulli trial with success probability $p = p_{0} = \\frac{K}{N}$. The number of trials $Y$ needed to observe $r$ successes in independent Bernoulli trials with success probability $p$ is Negative Binomial, with probability mass function\n$$\nP(Y=n) = \\binom{n-1}{r-1} p^{r} (1-p)^{n-r}, \\quad n=r, r+1, \\ldots\n$$\nThe event “the $m$-th defective occurs on draw $n$” corresponds exactly to “the $r$-th success occurs on trial $n$” with $r=m$. Therefore, to match the Negative Binomial form that approximates $X$, we identify\n$$\nr = m, \\quad p = \\frac{K}{N}.\n$$\nThis matches the given Negative Binomial parameterization and captures the large-population approximation of the Negative Hypergeometric stopping-time distribution by the Negative Binomial distribution.", "answer": "$$\\boxed{\\begin{pmatrix} m  \\frac{K}{N} \\end{pmatrix}}$$", "id": "1346383"}]}