{"hands_on_practices": [{"introduction": "Our exploration of Chernoff bounds begins with a foundational exercise. This problem demonstrates the most direct application of a Chernoff bound to estimate the probability of rare events in a quality control context. By working through this example [@problem_id:1348627], you will practice the core mechanics of identifying the mean $\\mu$, calculating the deviation parameter $\\delta$, and applying a standard inequality to find a probabilistic upper bound. This is the first step in mastering these powerful tools.", "problem": "A company manufactures large batches of simple electronic switches. Each switch is produced independently and has a probability of being functional of exactly $p = 0.5$. The company sells these switches in boxes containing $n=100$ units. Let $S$ represent the total number of functional switches in a randomly selected box.\n\nCompany policy requires investigation of any production run that shows anomalous results. They are not only concerned about too many faulty switches but also about batches that seem \"too perfect,\" as this might indicate a flaw in their automated testing equipment (e.g., being too charitable in its assessments).\n\nYou are tasked with analyzing the likelihood of such an \"overly perfect\" batch. Using a specific form of the Chernoff bound, calculate an upper bound for the probability that the number of functional switches in a box exceeds 65.\n\nFor a sum $S = \\sum_{i=1}^n X_i$ of independent Bernoulli random variables with mean $\\mu = E[S]$, the following Chernoff bound inequality holds for any $0 < \\delta \\le 1$:\n$$P(S > (1+\\delta)\\mu) \\le \\exp\\left(-\\frac{\\delta^2 \\mu}{3}\\right)$$\nProvide your answer as a numerical value. Round your final answer to three significant figures.", "solution": "Let $X_{i}$ be independent Bernoulli random variables with $P(X_{i}=1)=p=0.5$ and $S=\\sum_{i=1}^{n}X_{i}$ with $n=100$. Then the mean is\n$$\n\\mu=E[S]=np=100\\times 0.5=50.\n$$\nWe seek an upper bound for $P(S>65)$. Using the given Chernoff bound, for $0<\\delta\\le 1$,\n$$\nP\\!\\left(S>(1+\\delta)\\mu\\right)\\le \\exp\\!\\left(-\\frac{\\delta^{2}\\mu}{3}\\right).\n$$\nChoose $\\delta$ so that $(1+\\delta)\\mu=65$. Solving,\n$$\n\\delta=\\frac{65}{\\mu}-1=\\frac{65}{50}-1=1.3-1=0.3,\n$$\nwhich satisfies $0<\\delta\\le 1$. Therefore,\n$$\nP(S>65)\\le \\exp\\!\\left(-\\frac{\\delta^{2}\\mu}{3}\\right)=\\exp\\!\\left(-\\frac{(0.3)^{2}\\cdot 50}{3}\\right)=\\exp(-1.5).\n$$\nEvaluating numerically and rounding to three significant figures gives\n$$\n\\exp(-1.5)\\approx 0.223.\n$$", "answer": "$$\\boxed{0.223}$$", "id": "1348627"}, {"introduction": "Beyond simply analyzing probabilities, Chernoff bounds are powerful tools for experimental design. This exercise [@problem_id:1348596] flips the typical question: instead of calculating a probability for a fixed number of trials, we determine the minimum number of trials $n$ needed to guarantee an outcome with high confidence. This practice is fundamental in fields from scientific polling to software A/B testing, where knowing \"how much data is enough\" is a critical practical question.", "problem": "A company is developing a new hardware Random Number Generator (RNG) intended for cryptographic applications. A crucial property of this RNG is that it must be \"fair,\" meaning the probability of generating a '1' is exactly the same as generating a '0', i.e., $p=0.5$.\n\nTo perform a preliminary quality assurance test, an engineer runs the generator a total of $n$ times and records the sequence of bits. The test is considered a \"pass\" if the observed fraction of '1's in the sequence falls strictly between 0.4 and 0.6.\n\nUsing a Chernoff-type inequality, determine the minimum number of trials, $n$, that must be performed to guarantee that the probability of passing the test is at least 99%. Your final answer must be an integer.", "solution": "Let $X_{1},\\dots,X_{n}$ be i.i.d. Bernoulli variables with $\\mathbb{P}(X_{i}=1)=\\mathbb{P}(X_{i}=0)=\\frac{1}{2}$. Write the sample mean as $\\hat{p}_{n}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}$. The test passes if $0.4<\\hat{p}_{n}<0.6$, i.e., if $|\\hat{p}_{n}-\\frac{1}{2}|<\\frac{1}{10}$. The failure event is $|\\hat{p}_{n}-\\frac{1}{2}|\\geq \\frac{1}{10}$.\n\nUsing the Hoeffding (Chernoff-type) inequality for bounded i.i.d. variables in $[0,1]$,\n$$\n\\mathbb{P}\\!\\left(\\left|\\hat{p}_{n}-\\mathbb{E}[X_{i}]\\right|\\geq \\epsilon\\right)\\leq 2\\exp\\!\\left(-2n\\epsilon^{2}\\right),\n$$\nwith $\\epsilon=\\frac{1}{10}$ and $\\mathbb{E}[X_{i}]=\\frac{1}{2}$, we obtain\n$$\n\\mathbb{P}(\\text{fail})=\\mathbb{P}\\!\\left(\\left|\\hat{p}_{n}-\\tfrac{1}{2}\\right|\\geq \\tfrac{1}{10}\\right)\\leq 2\\exp\\!\\left(-2n\\cdot\\frac{1}{100}\\right)=2\\exp\\!\\left(-\\frac{n}{50}\\right).\n$$\nTo guarantee $\\mathbb{P}(\\text{pass})\\geq 0.99$, it suffices to enforce $\\mathbb{P}(\\text{fail})\\leq \\frac{1}{100}$, i.e.,\n$$\n2\\exp\\!\\left(-\\frac{n}{50}\\right)\\leq \\frac{1}{100}.\n$$\nSolving,\n$$\n\\exp\\!\\left(-\\frac{n}{50}\\right)\\leq \\frac{1}{200}\n\\;\\;\\Longrightarrow\\;\\;\n-\\frac{n}{50}\\leq \\ln\\!\\left(\\frac{1}{200}\\right)=-\\ln(200)\n\\;\\;\\Longrightarrow\\;\\;\nn\\geq 50\\ln(200).\n$$\nThus the minimal integer is $n=\\lceil 50\\ln(200)\\rceil$. Using $\\ln(200)=\\ln 2+2\\ln 10\\approx 0.69314718056+2\\cdot 2.302585093\\approx 5.298317366$, we get\n$$\n50\\ln(200)\\approx 264.9158683,\n$$\nso the smallest integer $n$ satisfying the requirement is $265$.", "answer": "$$\\boxed{265}$$", "id": "1348596"}, {"introduction": "We now advance to a classic and elegant application of Chernoff bounds: the analysis of randomized algorithms. This problem [@problem_id:1348647] demonstrates how these concentration inequalities can provide rigorous guarantees on the performance and efficiency of complex computational processes. Your task is to model the behavior of Randomized Quicksort, identify the underlying independent trials, and use a Chernoff bound to prove that its recursion depth is highly unlikely to be large, showcasing the algorithm's reliability.", "problem": "Consider the Randomized Quicksort algorithm applied to an array of $n$ distinct elements. At each step of the recursion on a sub-array, a pivot is chosen uniformly at random from that sub-array. We define a pivot selection as \"balanced\" if the chosen pivot is not among the smallest 25% or the largest 25% of the elements in the current sub-array. In other words, a balanced pivot lies between the 25th and 75th percentiles of the elements it is chosen from.\n\nThe recursion path for a specific element terminates when the sub-array containing it shrinks to size 1. The total number of recursive calls on the path for that element is its \"recursion depth\".\n\nYour task is to find a simplified, high-probability upper bound on the maximum recursion depth for any element in the array. Specifically, derive an upper bound for the probability that the recursion depth for at least one element exceeds $k_0 = \\frac{4 \\ln n}{\\ln(4/3)}$.\n\nFor your derivation, you may use the following multiplicative Chernoff bound for the lower tail. Let $S$ be a sum of independent Bernoulli random variables with mean $\\mu = E[S]$. For any $0 < \\delta < 1$, the following inequality holds:\n$$P(S < (1-\\delta)\\mu) \\le \\exp\\left(-\\frac{\\mu\\delta^2}{2}\\right)$$\n\nExpress your final answer as a symbolic expression in terms of $n$.", "solution": "Fix any element and follow its recursion path. Each recursive call on a sub-array chooses a pivot uniformly at random from that sub-array. Call a pivot selection balanced if the pivotâ€™s rank within the sub-array lies in the interval from the 25th to the 75th percentile. A balanced pivot reduces the size of the sub-array that continues to contain our fixed element by a factor of at most $\\frac{3}{4}$, because both resulting parts have size at most $\\frac{3}{4}$ of the current size.\n\nLet $X_{i}$ be the indicator that the $i$-th pivot on this fixed path is balanced. Because each pivot is chosen independently and uniformly from the current sub-array and exactly half of the ranks are balanced under the stated definition, we have $P(X_{i}=1)=\\frac{1}{2}$ for every $i$, and the $X_{i}$ are independent across steps. Define $S_{k}=\\sum_{i=1}^{k}X_{i}$, so $S_{k}$ counts how many balanced pivots occur in the first $k$ steps on the path. Its mean is $\\mu=E[S_{k}]=\\frac{k}{2}$.\n\nIf after $k$ steps the recursion for our element has not terminated, then the sub-array still containing it has size at least $2$. On the other hand, each balanced step multiplies the size by at most $\\frac{3}{4}$, so after $S_{k}$ balanced steps the size is at most $n\\left(\\frac{3}{4}\\right)^{S_{k}}$. Therefore, the event that the depth exceeds $k$ implies\n$$\nn\\left(\\frac{3}{4}\\right)^{S_{k}}\\geq 2 \\quad\\Rightarrow\\quad n\\left(\\frac{3}{4}\\right)^{S_{k}}>1 \\quad\\Rightarrow\\quad S_{k}\\leq \\frac{\\ln n}{\\ln(4/3)}.\n$$\nIn particular, for $k=k_{0}=\\frac{4\\ln n}{\\ln(4/3)}$, we have $\\frac{\\ln n}{\\ln(4/3)}=\\frac{k_{0}}{4}$. Thus, for a fixed element,\n$$\nP(\\text{depth}>k_{0})\\leq P\\!\\left(S_{k_{0}}<\\frac{k_{0}}{4}\\right).\n$$\n\nApply the given multiplicative Chernoff bound to $S_{k_{0}}$, which is a sum of independent Bernoulli random variables with mean $\\mu=\\frac{k_{0}}{2}$. Set $(1-\\delta)\\mu=\\frac{k_{0}}{4}$, which gives $1-\\delta=\\frac{1}{2}$ and hence $\\delta=\\frac{1}{2}$. The bound yields\n$$\nP\\!\\left(S_{k_{0}}<\\frac{k_{0}}{4}\\right)\\leq \\exp\\!\\left(-\\frac{\\mu\\delta^{2}}{2}\\right)=\\exp\\!\\left(-\\frac{\\frac{k_{0}}{2}\\cdot \\frac{1}{4}}{2}\\right)=\\exp\\!\\left(-\\frac{k_{0}}{16}\\right).\n$$\nTherefore, for a fixed element,\n$$\nP(\\text{depth}>k_{0})\\leq \\exp\\!\\left(-\\frac{k_{0}}{16}\\right).\n$$\n\nTo bound the probability that at least one of the $n$ elements has recursion depth exceeding $k_{0}$, apply the union bound:\n$$\nP\\!\\left(\\max_{\\text{elements}} \\text{depth}>k_{0}\\right)\\leq n\\cdot \\exp\\!\\left(-\\frac{k_{0}}{16}\\right).\n$$\nSubstitute $k_{0}=\\frac{4\\ln n}{\\ln(4/3)}$ and simplify:\n$$\nn\\cdot \\exp\\!\\left(-\\frac{1}{16}\\cdot \\frac{4\\ln n}{\\ln(4/3)}\\right)\n= n\\cdot \\exp\\!\\left(-\\frac{\\ln n}{4\\ln(4/3)}\\right)\n= n^{\\,1-\\frac{1}{4\\ln(4/3)}}.\n$$\n\nThis gives the requested simplified upper bound in terms of $n$.", "answer": "$$\\boxed{n^{\\,1-\\frac{1}{4\\ln(4/3)}}}$$", "id": "1348647"}]}