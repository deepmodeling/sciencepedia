{"hands_on_practices": [{"introduction": "The Bernstein inequality is a powerful tool for managing risk in complex systems. This first exercise places you in the role of a systems engineer for a cloud provider, a scenario where understanding the probability of rare overload events is critical for ensuring reliability. By applying the inequality to a sum of independent random variables representing server loads, you will practice calculating a concrete upper bound on the chance of system failure, a foundational skill in reliability engineering. [@problem_id:1345789]", "problem": "A cloud infrastructure provider manages a large-scale distributed system composed of $N$ identical, independent servers. Let $X_i$ denote the number of active computational jobs in the queue of server $i$, where $i \\in \\{1, 2, \\dots, N\\}$. The variables $X_i$ are independent and identically distributed.\n\nBased on historical performance data, the following parameters have been established for each server:\n- The total number of servers is $N=500$.\n- The number of jobs for any server, $X_i$, can take any integer value in the set $\\{0, 1, 2, \\dots, 50\\}$.\n- The expected number of jobs for a single server is $E[X_i] = 20$.\n- The variance of the number of jobs for a single server is $\\text{Var}(X_i) = 100$.\n\nThe entire system is considered to be in an overload state if the total number of jobs across all servers, $S_N = \\sum_{i=1}^N X_i$, exceeds a threshold of $11000$. Using an appropriate concentration inequality based on the provided information, calculate an upper bound on the probability of system overload, $P(S_N > 11000)$.\n\nRound your final answer to three significant figures.", "solution": "The problem asks for an upper bound on the tail probability $P(S_N > 11000)$, where $S_N = \\sum_{i=1}^N X_i$ is a sum of $N=500$ independent and identically distributed (IID) random variables.\n\nFirst, let's identify the key parameters and the event of interest.\nThe random variables $X_i$ are IID with:\n- Mean: $E[X_i] = \\mu = 20$\n- Variance: $\\text{Var}(X_i) = \\sigma^2 = 100$\n- Number of variables: $N = 500$\n\nThe sum of these variables is $S_N = \\sum_{i=1}^N X_i$. By linearity of expectation, the expected value of the sum is:\n$$ E[S_N] = E\\left[\\sum_{i=1}^N X_i\\right] = \\sum_{i=1}^N E[X_i] = N\\mu = 500 \\times 20 = 10000 $$\nSince the variables are independent, the variance of the sum is the sum of the variances:\n$$ \\text{Var}(S_N) = \\text{Var}\\left[\\sum_{i=1}^N X_i\\right] = \\sum_{i=1}^N \\text{Var}(X_i) = N\\sigma^2 = 500 \\times 100 = 50000 $$\n\nThe event of interest is $S_N > 11000$. We can express this in terms of the deviation from the mean:\n$$ P(S_N > 11000) = P(S_N - E[S_N] > 11000 - 10000) = P(S_N - 10000 > 1000) $$\nLet $t=1000$. We are looking for an upper bound on $P(S_N - E[S_N] > t)$.\n\nWe are given that the random variables $X_i$ are bounded, as they take values in $\\{0, 1, \\dots, 50\\}$. This suggests that a concentration inequality which leverages this boundedness, in addition to the variance, would be most effective. Bernstein's inequality is a suitable choice.\n\nBernstein's inequality for a sum of zero-mean independent random variables $Y_i$ such that $|Y_i| \\le M$ for some constant $M$, is given by:\n$$ P\\left(\\sum_{i=1}^N Y_i > t\\right) \\le \\exp\\left(-\\frac{t^2/2}{\\sum_{i=1}^N E[Y_i^2] + Mt/3}\\right) $$\n\nTo apply this, we define a set of zero-mean random variables $Y_i = X_i - \\mu = X_i - 20$. The sum is $\\sum_{i=1}^N Y_i = \\sum_{i=1}^N (X_i - \\mu) = S_N - N\\mu = S_N - 10000$.\nThe problem is now to bound $P(\\sum Y_i > 1000)$.\nWe need to determine the parameters for Bernstein's inequality:\n1.  The bound $M$: Since $X_i \\in [0, 50]$, the centered variable $Y_i = X_i - 20$ is in the range $[0-20, 50-20] = [-20, 30]$. The absolute value is bounded by $|Y_i| \\le \\max(|-20|, |30|) = 30$. So, we can take $M=30$.\n2.  The sum of second moments: For a zero-mean variable, $E[Y_i^2] = \\text{Var}(Y_i) = \\text{Var}(X_i) = \\sigma^2 = 100$. Thus, the sum is:\n    $$ \\sum_{i=1}^N E[Y_i^2] = \\sum_{i=1}^N \\text{Var}(X_i) = N\\sigma^2 = 500 \\times 100 = 50000 $$\n\nNow we can substitute $t=1000$, $M=30$, and $\\sum E[Y_i^2] = 50000$ into Bernstein's inequality:\n$$ P(S_N - 10000 > 1000) \\le \\exp\\left(-\\frac{t^2/2}{\\sum E[Y_i^2] + Mt/3}\\right) $$\n$$ P(S_N > 11000) \\le \\exp\\left(-\\frac{(1000)^2/2}{50000 + (30)(1000)/3}\\right) $$\nLet's evaluate the expression in the exponent:\nNumerator: $\\frac{t^2}{2} = \\frac{(1000)^2}{2} = \\frac{1000000}{2} = 500000$.\nDenominator: $50000 + \\frac{30000}{3} = 50000 + 10000 = 60000$.\n\nSo the probability bound is:\n$$ P(S_N > 11000) \\le \\exp\\left(-\\frac{500000}{60000}\\right) = \\exp\\left(-\\frac{50}{6}\\right) = \\exp\\left(-\\frac{25}{3}\\right) $$\n\nNow we compute the numerical value:\n$$ \\exp\\left(-\\frac{25}{3}\\right) \\approx \\exp(-8.333333...) \\approx 0.000240449... $$\nThe problem asks to round the final answer to three significant figures.\nThe first significant figure is 2, the second is 4, and the third is 0. The next digit is 4, so we do not round up.\nThe result is $0.000240$.\nIn scientific notation, this is $2.40 \\times 10^{-4}$.", "answer": "$$\\boxed{2.40 \\times 10^{-4}}$$", "id": "1345789"}, {"introduction": "Moving from systems engineering to quantitative finance, this practice explores how the Bernstein inequality can be used to assess investment risk. A key challenge in risk management is to quantify the 'downside'â€”the probability of a strategy performing worse than expected. This problem requires you to not only apply the inequality but also to first manipulate the probability event of interest to fit the standard form, a common and crucial step in real-world applications. [@problem_id:1345810]", "problem": "A quantitative analyst is developing a model for an automated high-frequency trading strategy. The daily profit or loss, expressed as a fraction of the capital, is represented by a random variable. The model assumes that the daily returns are independent and identically distributed.\n\nLet the return on day $i$ be the random variable $X_i$. Over a trading year of $n=252$ days, the returns $\\{X_i\\}_{i=1}^{n}$ are modeled with the following properties:\n- The expected daily return is $E[X_i] = \\mu = 8.0 \\times 10^{-4}$.\n- The variance of the daily return is $\\text{Var}(X_i) = \\sigma^2 = 1.2 \\times 10^{-4}$.\n- The daily return is strictly bounded, such that for any day $i$, the return $X_i$ is guaranteed to be in the interval $[-0.02, 0.03]$.\n\nTo assess the risk of the strategy, the analyst wants to find an upper bound on the probability of the strategy losing money over the entire year.\n\nFor a set of $n$ independent random variables $\\{Z_i\\}_{i=1}^n$ with $E[Z_i]=0$ and $|Z_i| \\le K$ for all $i$, the following concentration inequality holds for any $t>0$:\n$$\nP\\left(\\sum_{i=1}^n Z_i \\ge t\\right) \\le \\exp\\left(-\\frac{t^2}{2\\left(\\sum_{i=1}^n \\text{Var}(Z_i) + \\frac{1}{3}Kt\\right)}\\right)\n$$\nUsing this provided inequality, calculate an upper bound for the probability that the total return for the year, $\\sum_{i=1}^{n} X_i$, is negative. Express your answer as a decimal rounded to three significant figures.", "solution": "The problem asks for an upper bound on the probability $P\\left(\\sum_{i=1}^{n} X_i < 0\\right)$. The provided inequality gives a bound for a sum of zero-mean random variables being greater than or equal to a positive value $t$. We must first transform our problem to fit this structure.\n\nLet $S_n = \\sum_{i=1}^{n} X_i$. We want to bound $P(S_n < 0)$.\n\nThe given inequality applies to zero-mean random variables. Let's define a new set of random variables $Z_i$ with zero mean. A natural choice is to center the $X_i$ variables:\nLet $Y_i = X_i - \\mu$. Then $E[Y_i] = E[X_i - \\mu] = E[X_i] - \\mu = \\mu - \\mu = 0$.\nThe sum of these new variables is $\\sum_{i=1}^{n} Y_i = \\sum_{i=1}^{n} (X_i - \\mu) = S_n - n\\mu$.\n\nThe event of interest, $S_n < 0$, can be rewritten in terms of the sum of $Y_i$:\n$S_n - n\\mu < -n\\mu$\n$\\sum_{i=1}^{n} Y_i < -n\\mu$\n\nThis is not yet in the form $\\sum Z_i \\ge t$. To handle the direction of the inequality, we can define a second set of zero-mean variables, $W_i = -Y_i = \\mu - X_i$.\n$E[W_i] = E[\\mu - X_i] = \\mu - E[X_i] = 0$.\nThe event $\\sum Y_i < -n\\mu$ is equivalent to $-\\sum W_i < -n\\mu$, which simplifies to $\\sum W_i > n\\mu$.\n\nNow we have the problem in the required form: we want to find an upper bound for $P\\left(\\sum_{i=1}^{n} W_i > n\\mu\\right)$. We can apply the given inequality with $Z_i = W_i$ and $t = n\\mu$.\n\nFirst, we must determine the parameters for the inequality:\n1.  **The threshold $t$**:\n    $t = n\\mu = 252 \\times (8.0 \\times 10^{-4}) = 0.2016$.\n\n2.  **The variance term $\\sum_{i=1}^n \\text{Var}(W_i)$**:\n    The variance of $W_i$ is related to the variance of $X_i$:\n    $\\text{Var}(W_i) = \\text{Var}(\\mu - X_i) = \\text{Var}(-X_i) = (-1)^2 \\text{Var}(X_i) = \\sigma^2$.\n    Since the variables are identically distributed, $\\text{Var}(W_i) = \\sigma^2 = 1.2 \\times 10^{-4}$ for all $i$.\n    The sum of variances is:\n    $\\sum_{i=1}^{n} \\text{Var}(W_i) = n\\sigma^2 = 252 \\times (1.2 \\times 10^{-4}) = 0.03024$.\n\n3.  **The bound $K$**:\n    We need an upper bound $K$ on $|W_i| = |\\mu - X_i|$.\n    We are given that $X_i \\in [-0.02, 0.03]$. With $\\mu = 0.0008$, the variable $W_i = 0.0008 - X_i$ is bounded as follows:\n    When $X_i = -0.02$, $W_i = 0.0008 - (-0.02) = 0.0208$.\n    When $X_i = 0.03$, $W_i = 0.0008 - 0.03 = -0.0292$.\n    So, $W_i \\in [-0.0292, 0.0208]$.\n    The bound $K$ is the maximum absolute value that $W_i$ can take:\n    $K = \\max(|-0.0292|, |0.0208|) = 0.0292$.\n\nNow we substitute these values into the inequality:\n$$\nP\\left(\\sum_{i=1}^{n} W_i \\ge n\\mu\\right) \\le \\exp\\left(-\\frac{t^2}{2\\left(\\sum_{i=1}^{n} \\text{Var}(W_i) + \\frac{1}{3}Kt\\right)}\\right)\n$$\nThe terms are:\n$t^2 = (0.2016)^2 = 0.04064256$.\n$\\sum_{i=1}^{n} \\text{Var}(W_i) = 0.03024$.\n$\\frac{1}{3}Kt = \\frac{1}{3} \\times 0.0292 \\times 0.2016 = \\frac{0.00588672}{3} = 0.00196224$.\n\nThe denominator of the fraction in the exponent is:\n$2 \\times (0.03024 + 0.00196224) = 2 \\times (0.03220224) = 0.06440448$.\n\nThe full exponent is:\n$-\\frac{0.04064256}{0.06440448} \\approx -0.63105$\n\nThe upper bound on the probability is:\n$P \\le \\exp(-0.63105) \\approx 0.53203$\n\nRounding to three significant figures, the upper bound is $0.532$.", "answer": "$$\\boxed{0.532}$$", "id": "1345810"}, {"introduction": "Our final practice moves into the realm of theoretical data science, demonstrating how the Bernstein inequality provides rigorous guarantees for modern statistical methods like bootstrapping. Instead of calculating a numerical probability, your task is to derive a general analytical bound for the stability of a bootstrap estimate. This exercise showcases the inequality's role as a fundamental tool for proving the reliability and consistency of statistical and machine learning algorithms. [@problem_id:1345793]", "problem": "A data scientist is analyzing the stability of an estimate derived from a dataset $S$ containing $n$ measurements, $\\{x_1, x_2, \\dots, x_n\\}$. It is known that every measurement $x_i$ is contained within the interval $[a, b]$, where $a$ and $b$ are known real numbers.\n\nLet $\\bar{x}$ be the sample mean of this dataset, i.e., $\\bar{x} = \\frac{1}{n}\\sum_{i=1}^n x_i$. A key measure of the data's dispersion is its sum of squared deviations from the mean, which is given as $V = \\sum_{i=1}^n (x_i - \\bar{x})^2$.\n\nTo assess the stability of the mean, a bootstrap resample, $S^* = \\{X_1^*, \\dots, X_n^*\\}$, is a new dataset created by drawing $n$ samples from the original dataset $S$ uniformly and with replacement. The mean of this new dataset is the random variable $\\bar{X}^* = \\frac{1}{n}\\sum_{i=1}^n X_i^*$.\n\nDetermine a rigorous upper bound for the probability that the absolute difference between the bootstrap mean $\\bar{X}^*$ and the original sample mean $\\bar{x}$ exceeds a given positive tolerance $\\epsilon$. Your final answer should be a closed-form analytic expression in terms of $n$, $\\epsilon$, $V$, $a$, and $b$.", "solution": "Define the empirical distribution that places mass $1/n$ at each observed value $x_{i}$. A bootstrap resample $X_{1}^{*},\\dots,X_{n}^{*}$ is an independent sample from this empirical distribution, so each $X_{i}^{*}$ takes values in $\\{x_{1},\\dots,x_{n}\\}\\subseteq[a,b]$ with $\\mathbb{P}(X_{i}^{*}=x_{j})=1/n$.\n\nCompute the mean and variance of a single bootstrap draw, conditional on the fixed dataset $S$. By linearity of expectation,\n$$\n\\mathbb{E}[X_{i}^{*}\\mid S] = \\frac{1}{n}\\sum_{j=1}^{n} x_{j} = \\bar{x}.\n$$\nIts variance under the empirical distribution is\n$$\n\\text{Var}(X_{i}^{*}\\mid S) = \\frac{1}{n}\\sum_{j=1}^{n}(x_{j}-\\bar{x})^{2} = \\frac{V}{n}.\n$$\nMoreover, since $x_{j}\\in[a,b]$ for all $j$, we have $X_{i}^{*}\\in[a,b]$, hence\n$$\n|X_{i}^{*}-\\bar{x}| \\leq \\max\\{\\bar{x}-a, b-\\bar{x}\\} \\leq b-a.\n$$\n\nLet $Y_{i}=X_{i}^{*}-\\bar{x}$. Then $Y_{1},\\dots,Y_{n}$ are independent, centered random variables with $\\text{Var}(Y_{i}\\mid S)=V/n$ and $|Y_{i}|\\leq b-a$ almost surely. We want to bound\n$$\n\\mathbb{P}\\left(|\\bar{X}^{*}-\\bar{x}|\\geq\\epsilon\\mid S\\right)\n=\n\\mathbb{P}\\left(\\left|\\frac{1}{n}\\sum_{i=1}^{n}Y_{i}\\right|\\geq\\epsilon \\mid S\\right).\n$$\n\nApply Bernsteinâ€™s inequality for independent, mean-zero, bounded variables: if $|Y_{i}|\\leq M$ almost surely and $\\sum_{i=1}^{n}\\text{Var}(Y_{i})=n\\sigma^{2}$, then for all $\\epsilon>0$,\n$$\n\\mathbb{P}\\left(\\left|\\frac{1}{n}\\sum_{i=1}^{n}Y_{i}\\right|\\geq\\epsilon\\right)\n\\leq\n2\\exp\\left(-\\frac{n\\epsilon^{2}}{2\\sigma^{2}+\\frac{2}{3}M\\epsilon}\\right).\n$$\nHere, $\\sigma^{2}=V/n$ and $M=b-a$. Substituting gives the conditional bound\n$$\n\\mathbb{P}\\left(|\\bar{X}^{*}-\\bar{x}|\\geq\\epsilon\\mid S\\right)\n\\leq\n2\\exp\\left(-\\frac{n\\epsilon^{2}}{\\frac{2V}{n}+\\frac{2}{3}(b-a)\\epsilon}\\right)\n=\n2\\exp\\left(-\\frac{n^{2}\\epsilon^{2}}{2V+\\frac{2}{3}n(b-a)\\epsilon}\\right).\n$$\nSince the randomness is only over the bootstrap resampling given $S$, this furnishes the desired rigorous upper bound in terms of $n$, $\\epsilon$, $V$, $a$, and $b.", "answer": "$$\\boxed{2\\exp\\left(-\\frac{n\\epsilon^{2}}{\\frac{2V}{n}+\\frac{2}{3}(b-a)\\epsilon}\\right)}$$", "id": "1345793"}]}