{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, let's start with the fundamental definition of an n-step transition probability. This first practice demonstrates how to calculate the probability of moving from one state to another in exactly two steps by considering all possible intermediate states. By working through this library book scenario [@problem_id:1377143], you'll gain a concrete understanding of what the entries in the squared transition matrix, $P^2$, truly represent.", "id": "1377143", "problem": "The state of a specific book in a university library can be modeled as a discrete-time stochastic process. The state of the book is observed at the end of each day. The possible states for the book are: 'On the Shelf' (S), 'Checked Out' (C), or 'In Reshelving' (R).\n\nThe transitions between these states follow a set of fixed probabilities:\n- If a book is 'On the Shelf' on a given day, there is a 0.15 probability that it will be 'Checked Out' the next day. Otherwise, it remains 'On the Shelf'.\n- If a book is 'Checked Out', there is a 0.25 probability that it will be returned and move to the 'In Reshelving' state the next day. Otherwise, it remains 'Checked Out'.\n- If a book is 'In Reshelving', there is a 0.90 probability that it will be placed 'On the Shelf' the next day. Otherwise, it remains 'In Reshelving'.\n\nAssume that a book cannot move from 'On the Shelf' to 'In Reshelving', from 'Checked Out' to 'On the Shelf', or from 'In Reshelving' to 'Checked Out' in a single day.\n\nSuppose a particular book is currently 'On the Shelf'. What is the probability that this same book will be 'On the Shelf' again exactly two days from now? Express your answer as a decimal rounded to three significant figures.\n\n", "solution": "Let the states be $S$ (On the Shelf), $C$ (Checked Out), and $R$ (In Reshelving). The one-step transition matrix $P$ with row/column order $(S,C,R)$ is\n$$\nP=\\begin{pmatrix}\n0.85 & 0.15 & 0 \\\\\n0 & 0.75 & 0.25 \\\\\n0.90 & 0 & 0.10\n\\end{pmatrix}.\n$$\nThe probability that a book starting in $S$ is in $S$ exactly two days later is the two-step transition probability $(P^{2})_{SS}$, given by\n$$\n(P^{2})_{SS}=\\sum_{x\\in\\{S,C,R\\}} P_{Sx}P_{xS}\n= P_{SS}P_{SS}+P_{SC}P_{CS}+P_{SR}P_{RS}.\n$$\nFrom the transition structure, $P_{SS}=0.85$, $P_{SC}=0.15$, $P_{CS}=0$, $P_{SR}=0$, and $P_{RS}=0.90$. Therefore,\n$$\n(P^{2})_{SS}=0.85^{2}+0.15\\cdot 0+0\\cdot 0.90=0.7225.\n$$\nRounding to three significant figures gives $0.723$.", "answer": "$$\\boxed{0.723}$$"}, {"introduction": "While tracing paths is insightful for a small number of steps, it quickly becomes impractical for long-term predictions. This next exercise [@problem_id:1377157] introduces a far more powerful and efficient technique: using matrix exponentiation to calculate the complete $n$-step transition matrix, $P^n$. By determining a commuter's transport habits five days into the future, you will practice the essential skill of matrix diagonalization to solve for $P^5$.", "id": "1377157", "problem": "A commuter's daily choice of transport to work is between driving their car (State 1) and taking the train (State 2). The choice for any given day is influenced by the choice made on the preceding day. The probabilities governing this daily decision are as follows:\n\n*   If the commuter drives on day $k$, the probability they will also drive on day $k+1$ is $0.7$.\n*   If the commuter takes the train on day $k$, the probability they will drive on day $k+1$ is $0.2$.\n\nAssume that for any given day $k$, the commuter must either drive or take the train, and that these two options are mutually exclusive. The transition probabilities are constant for all days.\n\nDetermine the 5-step transition probability matrix, $P^{(5)}$, where the element $(i, j)$ of the matrix represents the probability that the commuter who uses transport method $i$ on a given day will use transport method $j$ five days later. Present your final answer as a $2 \\times 2$ matrix, rounding each entry to four significant figures.\n\n", "solution": "Let State 1 be 'Drive' and State 2 be 'Train'. We are given the probabilities of transitioning from one state to another in a single day. We can use these to construct the one-step transition probability matrix $P$. The element $P_{ij}$ of this matrix is the probability of moving from state $i$ to state $j$ in one day.\n\nFrom the problem statement:\nThe probability of driving on day $k+1$ given the commuter drove on day $k$ is $P_{11} = 0.7$.\nSince there are only two states, the probability of taking the train on day $k+1$ given a drive on day $k$ must be $P_{12} = 1 - P_{11} = 1 - 0.7 = 0.3$.\n\nThe probability of driving on day $k+1$ given the commuter took the train on day $k$ is $P_{21} = 0.2$.\nSimilarly, the probability of taking the train again on day $k+1$ given a train ride on day $k$ is $P_{22} = 1 - P_{21} = 1 - 0.2 = 0.8$.\n\nThe one-step transition matrix $P$ is therefore:\n$$\nP = \\begin{pmatrix} 0.7 & 0.3 \\\\ 0.2 & 0.8 \\end{pmatrix}\n$$\nThe 5-step transition probability matrix, $P^{(5)}$, is given by the fifth power of the one-step transition matrix, i.e., $P^{(5)} = P^5$. To compute this efficiently, we diagonalize the matrix $P$. The diagonalization of a matrix $P$ is given by $P = VDV^{-1}$, where $D$ is a diagonal matrix of eigenvalues and $V$ is a matrix whose columns are the corresponding eigenvectors.\n\nFirst, we find the eigenvalues ($\\lambda$) of $P$ by solving the characteristic equation $\\det(P - \\lambda I) = 0$:\n$$\n\\det\\begin{pmatrix} 0.7-\\lambda & 0.3 \\\\ 0.2 & 0.8-\\lambda \\end{pmatrix} = (0.7-\\lambda)(0.8-\\lambda) - (0.3)(0.2) = 0\n$$\n$$\n\\lambda^2 - 1.5\\lambda + 0.56 - 0.06 = 0\n$$\n$$\n\\lambda^2 - 1.5\\lambda + 0.5 = 0\n$$\nThis quadratic equation can be factored as $(\\lambda - 1)(\\lambda - 0.5) = 0$.\nThe eigenvalues are $\\lambda_1 = 1$ and $\\lambda_2 = 0.5$.\n\nNext, we find the corresponding eigenvectors.\nFor $\\lambda_1 = 1$, we solve $(P - I)v_1 = 0$:\n$$\n\\begin{pmatrix} 0.7-1 & 0.3 \\\\ 0.2 & 0.8-1 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} -0.3 & 0.3 \\\\ 0.2 & -0.2 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\nThis gives the equation $-0.3x + 0.3y = 0$, which simplifies to $x=y$. A simple choice for the eigenvector is $v_1 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$.\n\nFor $\\lambda_2 = 0.5$, we solve $(P - 0.5I)v_2 = 0$:\n$$\n\\begin{pmatrix} 0.7-0.5 & 0.3 \\\\ 0.2 & 0.8-0.5 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0.2 & 0.3 \\\\ 0.2 & 0.3 \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\nThis gives the equation $0.2x + 0.3y = 0$, which simplifies to $2x = -3y$. A simple choice for the eigenvector is $v_2 = \\begin{pmatrix} 3 \\\\ -2 \\end{pmatrix}$.\n\nNow we construct the matrices $V$, $D$, and $V^{-1}$:\n$$\nV = \\begin{pmatrix} 1 & 3 \\\\ 1 & -2 \\end{pmatrix}, \\quad D = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0.5 \\end{pmatrix}\n$$\nThe inverse of $V$ is:\n$$\nV^{-1} = \\frac{1}{(1)(-2) - (3)(1)} \\begin{pmatrix} -2 & -3 \\\\ -1 & 1 \\end{pmatrix} = \\frac{1}{-5} \\begin{pmatrix} -2 & -3 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 2/5 & 3/5 \\\\ 1/5 & -1/5 \\end{pmatrix} = \\begin{pmatrix} 0.4 & 0.6 \\\\ 0.2 & -0.2 \\end{pmatrix}\n$$\nNow we can compute $P^5$ using the formula $P^5 = VD^5V^{-1}$.\nFirst, we find $D^5$:\n$$\nD^5 = \\begin{pmatrix} 1^5 & 0 \\\\ 0 & (0.5)^5 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0.03125 \\end{pmatrix}\n$$\nNow, we perform the matrix multiplication $P^5 = V D^5 V^{-1}$:\n$$\nP^5 = \\begin{pmatrix} 1 & 3 \\\\ 1 & -2 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0.03125 \\end{pmatrix} \\begin{pmatrix} 0.4 & 0.6 \\\\ 0.2 & -0.2 \\end{pmatrix}\n$$\nFirst, multiply $V D^5$:\n$$\nV D^5 = \\begin{pmatrix} 1 \\cdot 1 & 3 \\cdot 0.03125 \\\\ 1 \\cdot 1 & -2 \\cdot 0.03125 \\end{pmatrix} = \\begin{pmatrix} 1 & 0.09375 \\\\ 1 & -0.0625 \\end{pmatrix}\n$$\nThen, multiply the result by $V^{-1}$:\n$$\nP^5 = \\begin{pmatrix} 1 & 0.09375 \\\\ 1 & -0.0625 \\end{pmatrix} \\begin{pmatrix} 0.4 & 0.6 \\\\ 0.2 & -0.2 \\end{pmatrix}\n$$\nNow we compute the elements of the final matrix:\n$$\nP^{(5)}_{11} = (1)(0.4) + (0.09375)(0.2) = 0.4 + 0.01875 = 0.41875\n$$\n$$\nP^{(5)}_{12} = (1)(0.6) + (0.09375)(-0.2) = 0.6 - 0.01875 = 0.58125\n$$\n$$\nP^{(5)}_{21} = (1)(0.4) + (-0.0625)(0.2) = 0.4 - 0.0125 = 0.3875\n$$\n$$\nP^{(5)}_{22} = (1)(0.6) + (-0.0625)(-0.2) = 0.6 + 0.0125 = 0.6125\n$$\nSo, the 5-step transition matrix is:\n$$\nP^{(5)} = \\begin{pmatrix} 0.41875 & 0.58125 \\\\ 0.3875 & 0.6125 \\end{pmatrix}\n$$\nFinally, we round each element to four significant figures:\n$P^{(5)}_{11} = 0.41875 \\approx 0.4188$\n$P^{(5)}_{12} = 0.58125 \\approx 0.5813$\n$P^{(5)}_{21} = 0.3875$ (already has four significant figures)\n$P^{(5)}_{22} = 0.6125$ (already has four significant figures)\n\nThe final matrix is:\n$$\nP^{(5)} \\approx \\begin{pmatrix} 0.4188 & 0.5813 \\\\ 0.3875 & 0.6125 \\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.4188 & 0.5813 \\\\ 0.3875 & 0.6125 \\end{pmatrix}}\n$$"}, {"introduction": "Our analysis so far has focused on the probability of being in a state at a specific time. This final practice introduces a more nuanced and critical question: what is the probability of reaching a particular state for the *first time* at a given step? This web crawler model [@problem_id:1377161] explores the concepts of absorbing states and first passage time, which are essential for modeling systems with terminal events, such as equipment failure or project completion.", "id": "1377161", "problem": "A simplified model of a website consists of five distinct webpages, labeled Page 1 through Page 5. A web crawler navigates this site according to a set of probabilistic rules. At each discrete time step, referred to as a \"click\", the crawler moves from its current page to an adjacent page. The connections are as follows:\n- From Page 1, there are links to Page 2, Page 3, and Page 4.\n- From Page 2, there are links to Page 1 and Page 5.\n- From Page 3, there are links to Page 1 and Page 4.\n- From Page 4, there are links to Page 1 and Page 5.\n- Page 5 has no outgoing links.\n\nWhen on a given page, the crawler chooses any of its outgoing links with equal probability to move to the next page. If the crawler reaches a page with no outgoing links (a sink), it remains on that page in all subsequent steps.\n\nSuppose the crawler starts on Page 1. What is the probability that the crawler is on Page 5 for the first time after exactly three clicks?\n\nProvide your answer as an exact fraction.\n\n", "solution": "Let the states be $\\{1,2,3,4,5\\}$ with transition probabilities determined by equal choice among outgoing links and absorption at Page $5$. Thus:\n$$\nP(1\\to 2)=P(1\\to 3)=P(1\\to 4)=\\frac{1}{3},\\quad\nP(2\\to 1)=P(2\\to 5)=\\frac{1}{2},\\quad\nP(3\\to 1)=P(3\\to 4)=\\frac{1}{2},\\quad\nP(4\\to 1)=P(4\\to 5)=\\frac{1}{2},\\quad\nP(5\\to 5)=1.\n$$\nWe seek the probability that Page $5$ is visited for the first time exactly after three clicks starting from Page $1$. This is the probability of all length-$3$ paths $1\\to a\\to b\\to 5$ such that $a\\neq 5$ and $b\\neq 5$, and the transitions are allowed by the graph.\n\nFor the third step to reach $5$, the state at step $2$ must be either $2$ or $4$, since only $2$ and $4$ link to $5$. We check which of these can be reached at step $2$ from $1$ without visiting $5$ earlier:\n- Reaching $b=2$ at step $2$ requires a path $1\\to a\\to 2$. The only incoming link to $2$ is from $1$, so the second step to $2$ would require $a=1$, but there is no self-loop $1\\to 1$. Hence $b=2$ at step $2$ is impossible.\n- Reaching $b=4$ at step $2$ requires a path $1\\to a\\to 4$. The incoming links to $4$ are from $1$ and $3$. The possibilities are $1\\to 1\\to 4$ (impossible), $1\\to 3\\to 4$ (possible), and $1\\to 4\\to 4$ (impossible). Thus the only valid way is $1\\to 3\\to 4$.\n\nTherefore, the only path that first reaches $5$ at exactly step $3$ is $1\\to 3\\to 4\\to 5$. Its probability is the product of the transition probabilities along this path:\n$$\nP(1\\to 3\\to 4\\to 5)=P(1\\to 3)\\,P(3\\to 4)\\,P(4\\to 5)=\\frac{1}{3}\\cdot\\frac{1}{2}\\cdot\\frac{1}{2}=\\frac{1}{12}.\n$$\nThis path does not visit $5$ at steps $1$ or $2$, so it indeed represents a first visit at step $3$. Summing over all admissible paths yields the same value, since the path is unique.", "answer": "$$\\boxed{\\frac{1}{12}}$$"}]}