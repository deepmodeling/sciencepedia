{"hands_on_practices": [{"introduction": "We begin our hands-on exploration with the cornerstone of the Gambler's Ruin problem. This exercise challenges you to derive the probability of ruin for a gambler playing a game with an unfair coin, meaning the probability of winning, $p$, is not equal to the probability of losing, $q$. By setting up and solving the fundamental recurrence relation, you will uncover how the ratio of losing to winning, $\\frac{q}{p}$, powerfully dictates the gambler's ultimate fate, providing the essential toolkit for analyzing more complex random walk scenarios [@problem_id:7867].", "problem": "A gambler, Alice, plays a sequential game of chance. She starts with an initial fortune of $i$ dollars, where $i$ is an integer. Her goal is to reach a total fortune of $N$ dollars, where $N > i$. If her fortune ever drops to $0$ dollars, she is ruined and must stop playing.\n\nIn each round of the game, she bets a single dollar. She wins the round with a constant probability $p$ (increasing her fortune by $1 dollar) and loses with a probability $q = 1-p$ (decreasing her fortune by $1 dollar). The game is played with an unfair coin, meaning that $p \\neq q$.\n\nLet $P_k$ be the probability that Alice is eventually ruined (i.e., her fortune reaches $0$) given that she currently has $k$ dollars. You are tasked with finding the probability of ruin given her initial fortune, $P_i$.\n\nDerive a closed-form expression for the probability of ruin, $P_i$, in terms of her initial fortune $i$, the target fortune $N$, and the probabilities $p$ and $q$.", "solution": "Let $P_k$ be the probability that the gambler's fortune reaches $0$ before it reaches $N$, given a starting fortune of $k$. We are looking for $P_i$. The range of possible fortunes is the set of integers $\\{0, 1, 2, ..., N\\}$.\n\nFirst, we establish the boundary conditions for the problem.\nIf the starting fortune is $k=0$, the gambler is already ruined. Therefore, the probability of ruin is $1$.\n$$\nP_0 = 1\n$$\nIf the starting fortune is $k=N$, the gambler has reached her target and the game is over. The probability of being ruined from this state is $0$.\n$$\nP_N = 0\n$$\n\nFor any intermediate fortune $k$ such that $0 < k < N$, we can establish a recurrence relation for $P_k$ by conditioning on the outcome of the very next round.\n- With probability $p$, the gambler wins the next round, and her fortune becomes $k+1$. The probability of ruin from this new state is $P_{k+1}$.\n- With probability $q$, she loses the next round, and her fortune becomes $k-1$. The probability of ruin from this new state is $P_{k-1}$.\n\nBy the law of total probability, $P_k$ is the weighted average of these two outcomes:\n$$\nP_k = p P_{k+1} + q P_{k-1}\n$$\nSince $p+q=1$, we can rewrite $P_k$ as $(p+q)P_k = pP_k + qP_k$. Substituting this into the relation:\n$$\np P_k + q P_k = p P_{k+1} + q P_{k-1}\n$$\nRearranging the terms, we group the $p$'s and $q$'s:\n$$\nq (P_k - P_{k-1}) = p (P_{k+1} - P_k)\n$$\nLet's define the difference in probabilities between consecutive states as $\\Delta_k = P_k - P_{k-1}$. The equation becomes:\n$$\nq \\Delta_k = p \\Delta_{k+1}\n$$\nThis yields a simple relationship for the differences:\n$$\n\\Delta_{k+1} = \\frac{q}{p} \\Delta_k\n$$\nThis shows that the differences $\\Delta_k$ form a geometric progression with a common ratio $r = q/p$. We can express any difference $\\Delta_k$ in terms of the first difference, $\\Delta_1 = P_1 - P_0$:\n$$\n\\Delta_k = \\left(\\frac{q}{p}\\right)^{k-1} \\Delta_1\n$$\nNow, we can express $P_k$ by summing these differences starting from $P_0$:\n$$\nP_k = P_0 + \\sum_{j=1}^{k} (P_j - P_{j-1}) = P_0 + \\sum_{j=1}^{k} \\Delta_j\n$$\nSubstituting the expression for $\\Delta_j$:\n$$\nP_k = P_0 + \\sum_{j=1}^{k} \\left(\\frac{q}{p}\\right)^{j-1} \\Delta_1 = P_0 + \\Delta_1 \\sum_{j=0}^{k-1} \\left(\\frac{q}{p}\\right)^j\n$$\nThe sum is a finite geometric series. Since the problem states $p \\neq q$, the ratio $r=q/p \\neq 1$. The sum of a geometric series is $\\sum_{j=0}^{n} r^j = \\frac{1-r^{n+1}}{1-r}$. Applying this formula:\n$$\nP_k = P_0 + \\Delta_1 \\left( \\frac{1 - (q/p)^k}{1 - q/p} \\right)\n$$\nWe have two unknowns, $P_0$ and $\\Delta_1$. We use our boundary conditions to solve for them. We already know $P_0=1$. We can also express $\\Delta_1$ as $P_1-P_0 = P_1 - 1$.\nSo, $\\Delta_1$ is an unknown constant we need to determine. Let's use the other boundary condition, $P_N=0$:\n$$\n0 = P_N = P_0 + \\Delta_1 \\left( \\frac{1 - (q/p)^N}{1 - q/p} \\right)\n$$\nSubstituting $P_0=1$:\n$$\n0 = 1 + \\Delta_1 \\left( \\frac{1 - (q/p)^N}{1 - q/p} \\right)\n$$\nSolving for $\\Delta_1$:\n$$\n\\Delta_1 = - \\frac{1 - q/p}{1 - (q/p)^N}\n$$\nNow we substitute this expression for $\\Delta_1$ back into our equation for $P_k$:\n$$\nP_k = P_0 + \\left( - \\frac{1 - q/p}{1 - (q/p)^N} \\right) \\left( \\frac{1 - (q/p)^k}{1 - q/p} \\right)\n$$\nAgain, using $P_0=1$ and simplifying by canceling the $(1-q/p)$ terms:\n$$\nP_k = 1 - \\frac{1 - (q/p)^k}{1 - (q/p)^N}\n$$\nTo get a single fractional term, we find a common denominator:\n$$\nP_k = \\frac{(1 - (q/p)^N) - (1 - (q/p)^k)}{1 - (q/p)^N} = \\frac{1 - (q/p)^N - 1 + (q/p)^k}{1 - (q/p)^N}\n$$\nThis simplifies to the general solution for the probability of ruin starting from a fortune of $k$:\n$$\nP_k = \\frac{(q/p)^k - (q/p)^N}{1 - (q/p)^N}\n$$\nThe problem asks for the probability of ruin starting with an initial fortune of $i$. We simply set $k=i$ in the general solution.\n$$\nP_i = \\frac{(q/p)^i - (q/p)^N}{1 - (q/p)^N}\n$$\nThis is the final expression for the probability of ruin.", "answer": "$$\n\\boxed{\\frac{\\left(\\frac{q}{p}\\right)^i - \\left(\\frac{q}{p}\\right)^N}{1 - \\left(\\frac{q}{p}\\right)^N}}\n$$", "id": "7867"}, {"introduction": "Building on the classic model, let's introduce a seemingly simple twist: what happens if a round can end in a draw? This practice asks you to analyze a game where the gambler's capital may remain unchanged with probability $r$. Intuitively, one might think that draws would alter the final outcome, but this exercise leads to a surprising and profound insight about the structure of the problem. By working through the derivation, you will demonstrate that the ultimate probability of ruin is independent of the possibility of a draw, deepening your understanding of the core factors at play [@problem_id:7893].", "problem": "Consider a modified version of the classic Gambler's Ruin problem. A gambler starts with an initial capital of $i$ units, where $i$ is an integer such that $0 < i < N$. The gambler plays a series of rounds against an opponent who has an initial capital of $N-i$. The total capital in the game is fixed at $N$ units.\n\nIn each round, the gambler wagers one unit. The possible outcomes of a round are:\n- The gambler wins the round with probability $p$. Their capital increases by one unit.\n- The gambler loses the round with probability $q$. Their capital decreases by one unit.\n- The round is a draw with probability $r$. The gambler's capital remains unchanged.\n\nThe probabilities are constant for each round, with $p, q, r > 0$ and $p+q+r=1$. The game ends when the gambler's capital reaches 0 (an event called \"ruin\") or $N$ (an event called \"victory\").\n\nLet $P_i$ be the probability that the gambler is eventually ruined, given that their starting capital is $i$. Assume the case where the probability of winning a round is not equal to the probability of losing a round, i.e., $p \\neq q$.\n\nDerive a general expression for the probability of ruin, $P_i$, in terms of the initial capital $i$, the total capital $N$, and the probabilities $p$ and $q$.", "solution": "We denote by $P_i$ the probability of eventual ruin starting from capital $i$. Since each round has a win with probability $p$, a loss with probability $q$, and a draw with probability $r$, where $p+q+r=1$, the one-step recursion for $1 \\le i \\le N-1$ is\n$$P_i = p P_{i+1} + q P_{i-1} + r P_i.$$\nRearranging, using $1-r=p+q$, gives the homogeneous difference equation\n$$p P_{i+1} - (p+q)P_i + q P_{i-1} = 0.$$\nThe characteristic equation is\n$$p\\lambda^2-(p+q)\\lambda+q=0,$$\nwith solutions \n$$\\lambda_1=1, \\quad \\lambda_2=\\frac{q}{p}.$$\nHence the general solution is\n$$P_i=A+B\\left(\\frac{q}{p}\\right)^i.$$\nImposing the boundary conditions $P_0=1$ and $P_N=0$ yields\n$$A+B=1, \\quad A+B\\left(\\frac{q}{p}\\right)^N=0.$$\nSolving for $A$ and $B$ gives\n$$B=\\frac{1}{1-(q/p)^N}, \\quad A=-\\frac{(q/p)^N}{1-(q/p)^N}.$$\nTherefore the probability of ruin is\n$$\nP_i\n=\\frac{(q/p)^i - (q/p)^N}{1 - (q/p)^N}.\n$$", "answer": "$$\\boxed{\\frac{\\left(\\frac{q}{p}\\right)^i - \\left(\\frac{q}{p}\\right)^N}{1 - \\left(\\frac{q}{p}\\right)^N}}$$", "id": "7893"}, {"introduction": "Our final practice moves beyond the assumption of constant probabilities, venturing into a more realistic and complex scenario where the odds are not fixed. Here, the probability of moving left or right depends on the particle's current position, a feature common in many real-world systems. This problem guides you through solving a difference equation with variable coefficients, showcasing the robust power of the recurrence-relation method you've developed. Successfully solving this problem will not only test your skills but also reveal a beautiful and unexpected connection between random walks and the classical harmonic series [@problem_id:1398174].", "problem": "A particle performs a one-dimensional random walk on the set of integers $\\{0, 1, 2, \\dots, N\\}$, where $N$ is a positive integer greater than 1. The positions $0$ and $N$ are absorbing barriers. When the particle is at any integer position $i$ such that $0 < i < N$, it will move to position $i+1$ with probability $p_i$ or to position $i-1$ with probability $q_i = 1-p_i$ in the next discrete time step. The probabilities of moving are position-dependent. Specifically, the ratio of the probability of moving left (decreasing its position) to the probability of moving right (increasing its position) from any state $i$ is given by:\n$$\n\\frac{q_i}{p_i} = \\frac{i}{i+1}\n$$\nSuppose the particle starts at an initial position $k$, where $k$ is an integer such that $0 < k < N$. Determine the probability that the particle is absorbed at the barrier $N$ before being absorbed at the barrier $0$.\n\nYour final answer should be an analytic expression in terms of $k$, $N$, and the harmonic number function $H_n$, which is defined as the sum of the reciprocals of the first $n$ positive integers: $H_n = \\sum_{j=1}^{n} \\frac{1}{j}$.", "solution": "Let $h_{i}$ denote the probability that the particle, starting from position $i$, is absorbed at $N$ before $0$. The boundary conditions are $h_{0}=0$ and $h_{N}=1$. For $0<i<N$, the one-step conditioning gives the recurrence\n$$\nh_{i}=p_{i}h_{i+1}+q_{i}h_{i-1}.\n$$\nRearranging,\n$$\np_{i}\\left(h_{i+1}-h_{i}\\right)=q_{i}\\left(h_{i}-h_{i-1}\\right).\n$$\nDefine the forward difference $d_{i}=h_{i}-h_{i-1}$ for $i\\geq 1$. Then for $1\\leq i\\leq N-1$,\n$$\np_{i}d_{i+1}=q_{i}d_{i}\\quad\\Longrightarrow\\quad d_{i+1}=\\frac{q_{i}}{p_{i}}d_{i}.\n$$\nWith $r_{i}=\\frac{q_{i}}{p_{i}}$ and the given ratio $r_{i}=\\frac{i}{i+1}$, we obtain\n$$\nd_{j}=d_{1}\\prod_{m=1}^{j-1}r_{m}=d_{1}\\prod_{m=1}^{j-1}\\frac{m}{m+1}=\\frac{d_{1}}{j}\\quad\\text{for }j=1,2,\\dots,N,\n$$\nusing the telescoping product $\\prod_{m=1}^{j-1}\\frac{m}{m+1}=\\frac{1}{j}$. Since $h_{0}=0$, we have\n$$\nh_{k}=\\sum_{j=1}^{k}d_{j}=d_{1}\\sum_{j=1}^{k}\\frac{1}{j}=d_{1}H_{k}.\n$$\nImposing the boundary condition $h_{N}=1$ yields\n$$\n1=h_{N}=d_{1}H_{N}\\quad\\Longrightarrow\\quad d_{1}=\\frac{1}{H_{N}}.\n$$\nTherefore,\n$$\nh_{k}=\\frac{H_{k}}{H_{N}}.\n$$\nThis is the desired probability that the particle starting at $k$ is absorbed at $N$ before $0$.", "answer": "$$\\boxed{\\frac{H_{k}}{H_{N}}}$$", "id": "1398174"}]}