{"hands_on_practices": [{"introduction": "The detailed balance condition, $\\pi_i p_{ij} = \\pi_j p_{ji}$, forms the computational core of time-reversible systems, linking the stationary distribution $\\pi$ with the transition probabilities $P$. This first exercise provides a direct, hands-on application of this fundamental equation. By working through it, you will practice using known equilibrium probabilities and transition rates to deduce unknown dynamics, a crucial skill in building and validating stochastic models such as the protein conformation model described here [@problem_id:1407749].", "problem": "A simplified model for a protein describes its conformation using three distinct states: State 1, State 2, and State 3. The protein transitions between these states at discrete time steps, following the dynamics of a discrete-time Markov chain.\n\nAfter a long time, the system reaches a statistical equilibrium where the probability of finding the protein in each state is constant. This stationary distribution is given by the vector $\\pi = (\\pi_1, \\pi_2, \\pi_3)$ where $\\pi_1 = 1/2$, $\\pi_2 = 1/4$, and $\\pi_3 = 1/4$.\n\nThe underlying physical process is known to be time-reversible, which implies that the Markov chain satisfies the detailed balance condition with respect to its stationary distribution $\\pi$.\n\nThe transition matrix $P$ for this chain has a probability of transitioning from State 1 to State 2 of $p_{12} = 1/3$. The probability of transitioning from State 3 to State 2 is $p_{32} = 1/5$.\n\nBased on this information, what is the probability that the protein remains in State 2 for one time step, i.e., the value of $p_{22}$?\n\nA. $1/15$\n\nB. $2/15$\n\nC. $1/5$\n\nD. $4/15$\n\nE. $7/15$\n\nF. $8/15$", "solution": "The chain is time-reversible with stationary distribution $\\pi=(\\pi_{1},\\pi_{2},\\pi_{3})$ where $\\pi_{1}=\\frac{1}{2}$, $\\pi_{2}=\\frac{1}{4}$, and $\\pi_{3}=\\frac{1}{4}$. Time-reversibility implies the detailed balance condition\n$$\n\\pi_{i}p_{ij}=\\pi_{j}p_{ji}\\quad \\text{for all }i,j.\n$$\nUsing the given $p_{12}=\\frac{1}{3}$, apply detailed balance between states $1$ and $2$:\n$$\n\\pi_{1}p_{12}=\\pi_{2}p_{21}\\;\\Rightarrow\\;\\frac{1}{2}\\cdot \\frac{1}{3}=\\frac{1}{4}p_{21}\\;\\Rightarrow\\;p_{21}=\\frac{\\frac{1}{6}}{\\frac{1}{4}}=\\frac{2}{3}.\n$$\nUsing the given $p_{32}=\\frac{1}{5}$, apply detailed balance between states $3$ and $2$:\n$$\n\\pi_{3}p_{32}=\\pi_{2}p_{23}\\;\\Rightarrow\\;\\frac{1}{4}\\cdot \\frac{1}{5}=\\frac{1}{4}p_{23}\\;\\Rightarrow\\;p_{23}=\\frac{\\frac{1}{20}}{\\frac{1}{4}}=\\frac{1}{5}.\n$$\nSince each row of the transition matrix sums to $1$, for row $2$ we have\n$$\np_{21}+p_{22}+p_{23}=1.\n$$\nSubstituting $p_{21}=\\frac{2}{3}$ and $p_{23}=\\frac{1}{5}$ gives\n$$\np_{22}=1-\\frac{2}{3}-\\frac{1}{5}=\\frac{15}{15}-\\frac{10}{15}-\\frac{3}{15}=\\frac{2}{15}.\n$$\nThis corresponds to option B.", "answer": "$$\\boxed{B}$$", "id": "1407749"}, {"introduction": "Not all Markov chains are time-reversible. Reversibility is a special property that emerges when a system lacks a net probabilistic 'current' at equilibrium. This next practice [@problem_id:1407763] moves beyond simple application and asks you to determine the precise conditions under which a system becomes reversible. By analyzing a particle's random walk on a cycle, you will discover how a system parameter dictates its fundamental symmetry, distinguishing between biased, irreversible motion and balanced, reversible dynamics.", "problem": "A particle is confined to move between three distinct sites, labeled 1, 2, and 3, arranged in a cycle. The particle's position is observed at discrete time steps. At each step, if the particle is at site $i \\in \\{1, 2, 3\\}$, it will jump to site $(i \\pmod 3) + 1$ with probability $\\alpha$ or to site $((i-2) \\pmod 3) + 1$ with probability $1-\\alpha$. The parameter $\\alpha$ is a constant, with $0 < \\alpha < 1$.\n\nAfter a long time, the system is assumed to reach a stationary state, characterized by a stationary probability distribution $(\\pi_1, \\pi_2, \\pi_3)$, where $\\pi_i$ is the probability of finding the particle at site $i$. The process is defined as time-reversible if, for this stationary distribution, the rate of transitions from any site $i$ to any site $j$ is equal to the rate of transitions from site $j$ back to site $i$.\n\nDetermine the specific numerical value of $\\alpha$ for which this random walk process is time-reversible.", "solution": "Let the state space of the Markov chain be $S = \\{1, 2, 3\\}$. The problem describes the transition probabilities. Let's denote the transition probability from state $i$ to state $j$ as $p_{ij}$. The problem statement gives us:\n- From site $i$ to site $(i \\pmod 3) + 1$: This corresponds to moving $1 \\to 2$, $2 \\to 3$, and $3 \\to 1$. The probability is $\\alpha$.\n- From site $i$ to site $((i-2) \\pmod 3) + 1$: This corresponds to moving $1 \\to 3$, $2 \\to 1$, and $3 \\to 2$. The probability is $1-\\alpha$.\n\nThe transition matrix $P$ for the states $(1, 2, 3)$ is:\n$$\nP = \\begin{pmatrix}\np_{11} & p_{12} & p_{13} \\\\\np_{21} & p_{22} & p_{23} \\\\\np_{31} & p_{32} & p_{33}\n\\end{pmatrix}\n= \\begin{pmatrix}\n0 & \\alpha & 1-\\alpha \\\\\n1-\\alpha & 0 & \\alpha \\\\\n\\alpha & 1-\\alpha & 0\n\\end{pmatrix}\n$$\n\nFirst, we must find the stationary distribution $\\pi = (\\pi_1, \\pi_2, \\pi_3)$, which satisfies the equation $\\pi P = \\pi$ and the normalization condition $\\sum_{i=1}^{3} \\pi_i = 1$. The equation $\\pi P = \\pi$ leads to the following system of linear equations:\n1. $\\pi_1 = (1-\\alpha)\\pi_2 + \\alpha\\pi_3$\n2. $\\pi_2 = \\alpha\\pi_1 + (1-\\alpha)\\pi_3$\n3. $\\pi_3 = (1-\\alpha)\\pi_1 + \\alpha\\pi_2$\n\nDue to the cyclic symmetry of the problem (the rules for jumping from any site are structurally identical), we can hypothesize that the stationary distribution is uniform, i.e., $\\pi_1 = \\pi_2 = \\pi_3$.\nUsing the normalization condition $\\pi_1 + \\pi_2 + \\pi_3 = 1$, we get $3\\pi_1 = 1$, which implies $\\pi_1 = \\pi_2 = \\pi_3 = 1/3$.\n\nLet's verify if $\\pi = (1/3, 1/3, 1/3)$ satisfies the system of equations for any $\\alpha \\in (0,1)$:\nFor equation 1:\n$$ (1-\\alpha)\\frac{1}{3} + \\alpha\\frac{1}{3} = \\frac{1-\\alpha+\\alpha}{3} = \\frac{1}{3} = \\pi_1 $$\nThis holds. By symmetry, the other two equations also hold. Thus, the stationary distribution for this Markov chain is $\\pi = (1/3, 1/3, 1/3)$, regardless of the value of $\\alpha$.\n\nNow, we apply the condition for time reversibility. The problem states this as \"the rate of transitions from any site $i$ to any site $j$ is equal to the rate of transitions from site $j$ back to site $i$.\" The rate of transitions from $i$ to $j$ is the probability of being at state $i$ ($\\pi_i$) times the probability of transitioning from $i$ to $j$ ($p_{ij}$). So, the condition for time reversibility is the detailed balance condition:\n$$ \\pi_i p_{ij} = \\pi_j p_{ji} \\quad \\text{for all } i, j \\in S $$\n\nWe only need to check this for pairs of states with non-zero transition probabilities.\nLet's check the pair of states (1, 2):\n$$ \\pi_1 p_{12} = \\pi_2 p_{21} $$\nSubstituting the known values:\n$$ \\frac{1}{3} \\cdot \\alpha = \\frac{1}{3} \\cdot (1-\\alpha) $$\n$$ \\alpha = 1 - \\alpha $$\n$$ 2\\alpha = 1 $$\n$$ \\alpha = \\frac{1}{2} $$\n\nLet's check the pair of states (2, 3):\n$$ \\pi_2 p_{23} = \\pi_3 p_{32} $$\nSubstituting the known values:\n$$ \\frac{1}{3} \\cdot \\alpha = \\frac{1}{3} \\cdot (1-\\alpha) $$\n$$ \\alpha = 1 - \\alpha $$\n$$ \\alpha = \\frac{1}{2} $$\n\nFinally, let's check the pair of states (3, 1):\n$$ \\pi_3 p_{31} = \\pi_1 p_{13} $$\nSubstituting the known values:\n$$ \\frac{1}{3} \\cdot \\alpha = \\frac{1}{3} \\cdot (1-\\alpha) $$\n$$ \\alpha = 1 - \\alpha $$\n$$ \\alpha = \\frac{1}{2} $$\n\nThe detailed balance condition is satisfied for all pairs of states if and only if $\\alpha = 1/2$. For any other value of $\\alpha$, the chain is not time-reversible. For example, if $\\alpha > 1/2$, there is a net probabilistic flow in the direction $1 \\to 2 \\to 3 \\to 1$.\n\nTherefore, the specific value of $\\alpha$ for which the process is time-reversible is $1/2$.", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1407763"}, {"introduction": "The power of the detailed balance condition extends far beyond verifying reversibility or finding a single transition rate. In complex systems with vast state spaces, such as those modeled on an $n$-hypercube, calculating the full stationary distribution can be computationally infeasible. This advanced exercise [@problem_id:1407802] introduces a powerful technique that leverages time-reversibility to directly calculate the ratio of stationary probabilities between any two states, offering profound insight into the system's equilibrium landscape without needing the complete picture.", "problem": "Consider a system of $n$ interacting elements, where the state of the system is represented by a binary vector $x = (x_1, x_2, \\dots, x_n) \\in \\{0, 1\\}^n$. The system evolves in discrete time steps according to a Markov chain on the $n$-hypercube.\n\nThe transition mechanism is as follows: At any given state $x$, a coordinate index $j \\in \\{1, \\dots, n\\}$ is chosen to be flipped. The probability of choosing the index $j$ depends on the current value of the bit $x_j$. Specifically, the selection weight for index $j$ is $\\alpha_j$ if $x_j=0$ and $\\beta_j$ if $x_j=1$, where all $\\alpha_j$ and $\\beta_j$ are positive constants. The probability of choosing index $j$ is its weight divided by the sum of all weights for the current state $x$. Once an index $j$ is chosen, the system deterministically transitions to the new state $x^{(j)}$, which is identical to $x$ except that the $j$-th bit is flipped.\n\nThis Markov chain is known to be time-reversible with respect to its unique stationary distribution $\\pi(x)$.\n\nFor a system with $n=4$, the weight parameters are given by the vectors $\\vec{\\alpha} = (1, 2, 3, 4)$ and $\\vec{\\beta} = (4, 3, 2, 1)$.\n\nDetermine the ratio of stationary probabilities $\\pi(x_A) / \\pi(x_B)$ for the states $x_A = (1, 0, 1, 0)$ and $x_B = (0, 1, 0, 1)$.\n\nProvide your answer as an exact fraction in simplest form.", "solution": "Let $w_{j}(x)$ denote the weight used to select coordinate $j$ in state $x$, namely\n$$\nw_{j}(x) =\n\\begin{cases}\n\\alpha_{j}, & \\text{if } x_{j}=0,\\\\\n\\beta_{j}, & \\text{if } x_{j}=1,\n\\end{cases}\n$$\nand let $W(x) = \\sum_{k=1}^{n} w_{k}(x)$ be the total weight in state $x$. The transition probability from $x$ to $x^{(j)}$ is\n$$\nP(x, x^{(j)}) = \\frac{w_{j}(x)}{W(x)}.\n$$\nTime-reversibility with stationary distribution $\\pi$ implies detailed balance:\n$$\n\\pi(x) P(x, x^{(j)}) = \\pi(x^{(j)}) P(x^{(j)}, x).\n$$\nTherefore, for adjacent states $x$ and $x^{(j)}$,\n$$\n\\frac{\\pi(x)}{\\pi(x^{(j)})} = \\frac{P(x^{(j)}, x)}{P(x, x^{(j)})} = \\frac{w_{j}(x^{(j)})}{W(x^{(j)})} \\cdot \\frac{W(x)}{w_{j}(x)}.\n$$\nLet $(x_{0}, x_{1}, \\dots, x_{m})$ be any path from $x_{0}=x_{A}$ to $x_{m}=x_{B}$ where each $x_{s+1}$ is obtained from $x_{s}$ by flipping one coordinate $j_{s}$. Multiplying the detailed balance ratios along the path yields\n$$\n\\frac{\\pi(x_{A})}{\\pi(x_{B})}\n= \\prod_{s=0}^{m-1} \\frac{\\pi(x_{s})}{\\pi(x_{s+1})}\n= \\prod_{s=0}^{m-1} \\left( \\frac{w_{j_{s}}(x_{s+1})}{w_{j_{s}}(x_{s})} \\cdot \\frac{W(x_{s})}{W(x_{s+1})} \\right)\n= \\frac{W(x_{A})}{W(x_{B})} \\cdot \\prod_{s=0}^{m-1} \\frac{w_{j_{s}}(x_{s+1})}{w_{j_{s}}(x_{s})},\n$$\nbecause the $W$ terms telescope to $W(x_{A})/W(x_{B})$. If a bit $j$ is flipped once from $x_{A}$ to $x_{B}$, then $w_{j}$ contributes the factor $w_{j}(x_{B})/w_{j}(x_{A})$; bits flipped an even number of times contribute a net factor $1$. Hence, taking a shortest path that flips exactly the bits where $x_{A}$ and $x_{B}$ differ, we obtain the path-independent formula\n$$\n\\frac{\\pi(x_{A})}{\\pi(x_{B})} = \\frac{W(x_{A})}{W(x_{B})} \\prod_{j:\\, x_{A,j} \\neq x_{B,j}} \\frac{w_{j}(x_{B})}{w_{j}(x_{A})}.\n$$\n\nFor $n=4$, with $\\vec{\\alpha}=(1,2,3,4)$ and $\\vec{\\beta}=(4,3,2,1)$, compute $w_{j}(x)$ and $W(x)$ for $x_{A}=(1,0,1,0)$ and $x_{B}=(0,1,0,1)$.\n\nFor $x_{A}=(1,0,1,0)$:\n- $w_{1}(x_{A})=\\beta_{1}=4$, $w_{2}(x_{A})=\\alpha_{2}=2$, $w_{3}(x_{A})=\\beta_{3}=2$, $w_{4}(x_{A})=\\alpha_{4}=4$,\nso\n$$\nW(x_{A})=4+2+2+4=12.\n$$\n\nFor $x_{B}=(0,1,0,1)$:\n- $w_{1}(x_{B})=\\alpha_{1}=1$, $w_{2}(x_{B})=\\beta_{2}=3$, $w_{3}(x_{B})=\\alpha_{3}=3$, $w_{4}(x_{B})=\\beta_{4}=1$,\nso\n$$\nW(x_{B})=1+3+3+1=8.\n$$\n\nAll four coordinates differ between $x_{A}$ and $x_{B}$, hence\n$$\n\\prod_{j=1}^{4} \\frac{w_{j}(x_{B})}{w_{j}(x_{A})}\n= \\frac{1}{4} \\cdot \\frac{3}{2} \\cdot \\frac{3}{2} \\cdot \\frac{1}{4}\n= \\frac{9}{64}.\n$$\nTherefore,\n$$\n\\frac{\\pi(x_{A})}{\\pi(x_{B})}\n= \\frac{W(x_{A})}{W(x_{B})} \\cdot \\frac{9}{64}\n= \\frac{12}{8} \\cdot \\frac{9}{64}\n= \\frac{3}{2} \\cdot \\frac{9}{64}\n= \\frac{27}{128}.\n$$\nThis fraction is already in simplest form.", "answer": "$$\\boxed{\\frac{27}{128}}$$", "id": "1407802"}]}