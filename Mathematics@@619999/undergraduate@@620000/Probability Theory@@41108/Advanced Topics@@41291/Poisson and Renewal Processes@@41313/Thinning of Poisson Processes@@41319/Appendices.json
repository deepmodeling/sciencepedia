{"hands_on_practices": [{"introduction": "The fundamental theorem of thinning states that when you randomly classify events from a Poisson process, the resulting sub-processes are themselves independent Poisson processes. This first exercise provides a concrete scenario to explore this crucial property of independence. By considering goals in a soccer match, you will see how a single process with rate $\\lambda$ splits into two streams—home goals and away goals—and how to calculate probabilities related to them, reinforcing the idea that the count of one type of event gives no information about the count of the other [@problem_id:1407548].", "problem": "In a major soccer league, analysis has shown that goals are scored according to a Poisson process with an average rate of $\\lambda$ goals per minute. For any given goal, the probability that it is scored by the designated home team is $p$, independent of all other goals. Consider a standard-length match of $T$ minutes. In a particular match, it is observed that the home team scored exactly $k$ goals. What is the probability that the away team scored exactly $j$ goals in that same match?\n\nProvide the answer for the specific case where $\\lambda = 0.025$ goals/minute, $p = 0.6$, $T = 90$ minutes, $k=2$, and $j=2$. Round your final answer to four significant figures.", "solution": "Let $N$ be the total number of goals in time $T$. Since goals follow a Poisson process of rate $\\lambda$, we have $N \\sim \\text{Poisson}(\\lambda T)$. Each goal is labeled as a home goal with probability $p$ and as an away goal with probability $1-p$, independently of all others.\n\nBy the thinning property of Poisson processes, the number of home goals $N_{H}$ and the number of away goals $N_{A}$ are independent Poisson random variables with parameters\n$$\nN_{H} \\sim \\text{Poisson}(\\lambda p T), \\quad N_{A} \\sim \\text{Poisson}(\\lambda (1-p) T).\n$$\nTherefore, $N_{A}$ is independent of $N_{H}$, and hence\n$$\n\\mathbb{P}(N_{A}=j \\mid N_{H}=k) = \\mathbb{P}(N_{A}=j) = \\exp\\!\\big(-\\lambda(1-p)T\\big)\\,\\frac{\\big(\\lambda(1-p)T\\big)^{j}}{j!}.\n$$\n\nFor the given values $\\lambda=0.025$, $p=0.6$, $T=90$, $j=2$, $k=2$, compute the away-team mean\n$$\n\\mu_{A}=\\lambda(1-p)T=0.025 \\times 0.4 \\times 90=0.9.\n$$\nThus\n$$\n\\mathbb{P}(N_{A}=2 \\mid N_{H}=2)=\\exp(-0.9)\\,\\frac{0.9^{2}}{2!}.\n$$\nCompute numerically:\n$$\n0.9^{2}=0.81,\\quad \\frac{0.81}{2}=0.405,\\quad \\exp(-0.9)\\cdot 0.405 \\approx 0.164660712\\ldots\n$$\nRounding to four significant figures gives $0.1647$.", "answer": "$$\\boxed{0.1647}$$", "id": "1407548"}, {"introduction": "Once we establish that a thinned process is a new Poisson process, we can analyze all its characteristics, including the time between events. This practice moves beyond simply counting events and focuses on the temporal structure of the thinned stream [@problem_id:1407550]. Using the example of critical error messages in a data center, you will determine the distribution of the time elapsed between specific occurrences, which involves understanding that the inter-arrival times of the thinned process are exponentially distributed and their sum follows an Erlang distribution.", "problem": "In a large-scale data center, error messages are generated by a cluster of servers. These messages arrive at a central logging system according to a Poisson process with a constant average rate of $\\lambda$ messages per hour. Each error message is independently classified as 'critical' with a probability $p$, or 'non-critical' with a probability $1-p$. An automated alert is triggered by the arrival of critical messages. Let $T_1$ be the time of the first critical message and $T_3$ be the time of the third critical message, with time measured in hours from an initial observation point $t=0$. Find a closed-form analytic expression for the probability that the time elapsed between the first and third critical messages is greater than a specified duration $\\tau$.", "solution": "By the thinning property of Poisson processes, classifying each message as critical with probability $p$ independently of everything else yields that the critical messages form a Poisson process with rate $\\mu=\\lambda p$. Let the interarrival times of this critical-process be $\\{S_{i}\\}_{i\\geq 1}$, where each $S_{i}$ is independent and identically distributed with $S_{i}\\sim \\text{Exp}(\\mu)$. The arrival times satisfy $T_{1}=S_{1}$, $T_{2}=S_{1}+S_{2}$, and $T_{3}=S_{1}+S_{2}+S_{3}$. Therefore, the elapsed time between the first and third critical messages is\n$$\nT_{3}-T_{1}=S_{2}+S_{3}.\n$$\nSince $S_{2}$ and $S_{3}$ are independent $\\text{Exp}(\\mu)$ random variables, $S:=S_{2}+S_{3}$ has the Erlang (Gamma) distribution with shape parameter $2$ and rate $\\mu$. Its probability density function is\n$$\nf_{S}(s)=\\mu^{2}s\\,\\exp(-\\mu s), \\quad s\\geq 0.\n$$\nWe require $P(T_{3}-T_{1}>\\tau)=P(S>\\tau)$ for $\\tau\\geq 0$. Compute the survival function:\n$$\nP(S>\\tau)=\\int_{\\tau}^{\\infty}\\mu^{2}s\\,\\exp(-\\mu s)\\,ds.\n$$\nEvaluate the integral by parts. Let $I=\\int_{\\tau}^{\\infty}s\\,\\exp(-\\mu s)\\,ds$. Take $u=s$ and $dv=\\exp(-\\mu s)\\,ds$, so $du=ds$ and $v=-(1/\\mu)\\exp(-\\mu s)$. Then\n$$\nI=\\left[-\\frac{s}{\\mu}\\exp(-\\mu s)\\right]_{\\tau}^{\\infty}+\\int_{\\tau}^{\\infty}\\frac{1}{\\mu}\\exp(-\\mu s)\\,ds\n=\\frac{\\tau}{\\mu}\\exp(-\\mu \\tau)+\\frac{1}{\\mu^{2}}\\exp(-\\mu \\tau).\n$$\nTherefore,\n$$\nP(S>\\tau)=\\mu^{2}I=\\exp(-\\mu \\tau)\\left(1+\\mu \\tau\\right).\n$$\nSubstituting $\\mu=\\lambda p$ gives the required probability:\n$$\nP(T_{3}-T_{1}>\\tau)=\\exp(-\\lambda p\\,\\tau)\\left(1+\\lambda p\\,\\tau\\right).\n$$\nFor $\\tau<0$, the probability is $1$, but the stated expression above applies for $\\tau\\geq 0$ (the case of interest for elapsed times).", "answer": "$$\\boxed{\\exp\\!\\left(-\\lambda p\\,\\tau\\right)\\left(1+\\lambda p\\,\\tau\\right)}$$", "id": "1407550"}, {"introduction": "The theory of thinning Poisson processes is not just for calculating forward probabilities; it is a powerful tool for statistical inference. This final practice demonstrates how the model is used to work backward from observed data to estimate parameters of an unobserved, underlying process [@problem_id:1407560]. Set in the context of a physics experiment searching for dark matter, you will use the number of detected particles—the outcome of a thinned process—to find the most likely value of the true WIMP arrival rate $\\lambda$, providing a glimpse into how these probabilistic models form the foundation of scientific discovery.", "problem": "A team of astrophysicists is conducting an experiment in a deep underground laboratory to detect hypothetical particles known as Weakly Interacting Massive Particles (WIMPs), which are a candidate for cosmic dark matter. The theoretical model predicts that WIMPs pass through the detector's location according to a Poisson process with a constant but unknown average rate of $\\lambda$ particles per unit time.\n\nThe detector itself is not perfectly efficient. There is a constant and known probability, $p$, that a WIMP passing through the detector will interact and produce a detectable signal. Each WIMP's detection is an independent event. If a WIMP does not interact, it passes through undetected.\n\nOver a continuous observation period of duration $T$, the experiment records a total of $n$ interaction events. Based on this single experimental outcome, determine the most likely value of the true WIMP arrival rate $\\lambda$. Express your answer as a formula in terms of the observed count $n$, the observation time $T$, and the detection probability $p$.", "solution": "The WIMP arrival process is modeled as a Poisson process with rate $\\lambda$. Each arriving WIMP is independently detected with probability $p$. By the thinning property of Poisson processes, the detected events form a Poisson process with rate $p \\lambda$. Over an observation time $T$, the total detected count $N$ is therefore distributed as a Poisson random variable with mean $p \\lambda T$:\n$$\nN \\sim \\text{Poisson}(p \\lambda T).\n$$\nGiven the observed count $n$, the likelihood function for $\\lambda$ is\n$$\nL(\\lambda \\mid n) = \\mathbb{P}(N=n \\mid \\lambda) = \\frac{\\exp(-p \\lambda T)\\,(p \\lambda T)^{n}}{n!}.\n$$\nThe log-likelihood is\n$$\n\\ell(\\lambda) = \\ln L(\\lambda \\mid n) = -p \\lambda T + n \\ln(p \\lambda T) - \\ln(n!) = -p \\lambda T + n \\ln \\lambda + n \\ln p + n \\ln T - \\ln(n!).\n$$\nDifferentiating with respect to $\\lambda$ and setting the derivative to zero gives the score equation\n$$\n\\frac{d\\ell}{d\\lambda} = -p T + \\frac{n}{\\lambda} = 0 \\quad \\Longrightarrow \\quad \\hat{\\lambda} = \\frac{n}{p T}.\n$$\nTo verify this is a maximum, compute the second derivative:\n$$\n\\frac{d^{2}\\ell}{d\\lambda^{2}} = -\\frac{n}{\\lambda^{2}} \\le 0 \\quad \\text{for } \\lambda > 0,\n$$\nso the solution is indeed the maximizer. When $n=0$, the log-likelihood is strictly decreasing in $\\lambda$, and the maximum over $\\lambda \\ge 0$ occurs at $\\lambda=0$, which is consistent with $\\hat{\\lambda} = \\frac{n}{p T}$.\n\nTherefore, the maximum likelihood estimator for the true WIMP arrival rate is $\\hat{\\lambda} = \\frac{n}{p T}$.", "answer": "$$\\boxed{\\frac{n}{p T}}$$", "id": "1407560"}]}