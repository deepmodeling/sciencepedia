{"hands_on_practices": [{"introduction": "We begin our exploration with a foundational example from random graph theory. This problem examines the \"influence score\" of a user in a randomly generated social network, which is mathematically equivalent to the out-degree of a vertex in a random tournament. This exercise provides a clean and intuitive setting to apply concentration inequalities, as the random variable of interest can be expressed as a simple sum of independent variables—the most straightforward type of martingale. [@problem_id:1345082]", "problem": "Consider a simplified model for a social network consisting of $n$ users. The relationships between users are modeled as a random tournament graph. For any pair of distinct users, say user A and user B, a directed \"follow\" relationship is established between them. The direction is chosen randomly and independently for all pairs: there is a probability of $1/2$ that user A follows user B, and a probability of $1/2$ that user B follows user A.\n\nThe \"influence score\" of a user is defined as their out-degree, which is the number of other users they follow.\n\nLet's focus on a single, specific user in this network of $n$ users. Let $D$ be this user's influence score. The expected influence score is $E[D]$. Your task is to find an upper bound for the probability that the actual influence score $D$ deviates from its expected value by at least an amount $\\lambda > 0$. That is, determine an upper bound for the probability $P(|D - E[D]| \\ge \\lambda)$. The bound should be expressed as a function of $n$ and $\\lambda$.", "solution": "Fix a particular user. For each other user, define indicator variables as follows: for each of the $n-1$ other users, let $X_{i}$ be $1$ if our fixed user follows that user and $0$ otherwise. By the tournament construction, for each pair the direction is chosen independently and with probability $\\frac{1}{2}$ for each direction, hence $X_{i}$ are independent and identically distributed with $X_{i} \\sim \\text{Bernoulli}\\!\\left(\\frac{1}{2}\\right)$ and $X_{i} \\in [0,1]$.\n\nThe influence score of the fixed user is the out-degree\n$$\nD=\\sum_{i=1}^{n-1} X_{i}.\n$$\nBy linearity of expectation and $\\mathbb{E}[X_{i}]=\\frac{1}{2}$, we have\n$$\n\\mathbb{E}[D]=\\sum_{i=1}^{n-1} \\mathbb{E}[X_{i}]=\\frac{n-1}{2}.\n$$\n\nTo bound the deviation probability $\\mathbb{P}(|D-\\mathbb{E}[D]|\\ge \\lambda)$, apply Hoeffding's inequality for independent bounded variables $X_{i}\\in[a_{i},b_{i}]$ with $a_{i}=0$ and $b_{i}=1$. For $S=\\sum_{i=1}^{n-1} X_{i}$ and any $t>0$,\n$$\n\\mathbb{P}\\!\\left(S-\\mathbb{E}[S]\\ge t\\right)\\le \\exp\\!\\left(-\\frac{2 t^{2}}{\\sum_{i=1}^{n-1} (b_{i}-a_{i})^{2}}\\right)=\\exp\\!\\left(-\\frac{2 t^{2}}{n-1}\\right),\n$$\nand similarly\n$$\n\\mathbb{P}\\!\\left(\\mathbb{E}[S]-S\\ge t\\right)\\le \\exp\\!\\left(-\\frac{2 t^{2}}{n-1}\\right).\n$$\nUsing the union bound for the two tails (or symmetry), with $S=D$ and $t=\\lambda$, we obtain the two-sided concentration bound\n$$\n\\mathbb{P}\\!\\left(|D-\\mathbb{E}[D]|\\ge \\lambda\\right)\\le 2 \\exp\\!\\left(-\\frac{2 \\lambda^{2}}{n-1}\\right).\n$$\n\nThis provides the requested upper bound as a function of $n$ and $\\lambda$.", "answer": "$$\\boxed{2 \\exp\\!\\left(-\\frac{2 \\lambda^{2}}{n-1}\\right)}$$", "id": "1345082"}, {"introduction": "Moving beyond simple sums of independent variables, we now tackle a classic and highly practical application in computer science: analyzing the performance of randomized quicksort. The total number of comparisons is a complex random variable that depends on the entire sequence of random pivot choices. This problem showcases the true power of the Azuma-Hoeffding inequality, which allows us to bound the deviation of such complex functions by analyzing the effect of each individual random choice in a sequential process. [@problem_id:1336225]", "problem": "A software engineer is analyzing the performance of a legacy data processing system. A core component of this system sorts large batches of unique numerical job identifiers using the randomized quicksort algorithm. The overall system performance is highly sensitive to the number of key comparisons performed during this sorting step.\n\nConsider a single run of the randomized quicksort algorithm on a list of $n$ distinct elements. Let $C$ be the total number of key comparisons, which is a random variable. The engineer's goal is to establish a robust performance guarantee.\n\nFor this analysis, you are given the following information:\n1.  The number of elements to be sorted is $n = 40000$.\n2.  The expected number of comparisons, $\\mu$, is given by the formula $\\mu = 2n \\ln(n)$, where $\\ln$ denotes the natural logarithm.\n3.  The probabilistic behavior of $C$ can be bounded using a form of the Azuma-Hoeffding inequality. For a suitable martingale representation of the sorting process, the sum of the squares of the one-step differences is bounded above by $\\frac{\\pi^2}{6} n^2$.\n4.  The specific inequality to use is: $P(|C - \\mu| \\ge t) \\le 2 \\exp\\left(-\\frac{t^2}{B}\\right)$, where $t > 0$ and $B$ is the upper bound on the sum of the squares of the one-step differences mentioned in point 3.\n\nA new Service Level Agreement (SLA) requires that the probability of the number of comparisons $C$ exceeding its mean $\\mu$ by more than a certain fraction $\\lambda$ of the mean must be extremely small. Specifically, the requirement is $P(C - \\mu > \\lambda \\mu) \\le 10^{-12}$.\n\nDetermine the minimum dimensionless value of the fractional deviation $\\lambda$ that satisfies this SLA. Round your final answer to three significant figures.", "solution": "We are given a single-run randomized quicksort on $n$ distinct elements with total comparisons $C$, mean $\\mu=2n\\ln(n)$, and an Azuma-Hoeffding type tail bound\n$$\nP\\!\\left(|C-\\mu|\\ge t\\right)\\le 2\\exp\\!\\left(-\\frac{t^{2}}{B}\\right),\n$$\nwith $B$ bounded by the sum of squared one-step differences, here $B=\\frac{\\pi^{2}}{6}n^{2}$.\n\nThe SLA requires\n$$\nP\\!\\left(C-\\mu>\\lambda\\mu\\right)\\le 10^{-12}.\n$$\nSince $P(C-\\mu>\\lambda\\mu)\\le P(|C-\\mu|\\ge \\lambda\\mu)$, it suffices to enforce\n$$\nP\\!\\left(|C-\\mu|\\ge \\lambda\\mu\\right)\\le 10^{-12}.\n$$\nBy the given inequality,\n$$\nP\\!\\left(|C-\\mu|\\ge \\lambda\\mu\\right)\\le 2\\exp\\!\\left(-\\frac{\\lambda^{2}\\mu^{2}}{B}\\right).\n$$\nThus a sufficient condition for the SLA is\n$$\n2\\exp\\!\\left(-\\frac{\\lambda^{2}\\mu^{2}}{B}\\right)\\le 10^{-12}.\n$$\nTaking natural logarithms and rearranging gives\n$$\n-\\frac{\\lambda^{2}\\mu^{2}}{B}+\\ln 2\\le -12\\ln 10\n\\quad\\Longrightarrow\\quad\n\\frac{\\lambda^{2}\\mu^{2}}{B}\\ge 12\\ln 10+\\ln 2,\n$$\nso\n$$\n\\lambda^{2}\\ge \\frac{B}{\\mu^{2}}\\left(12\\ln 10+\\ln 2\\right).\n$$\nUsing $\\mu=2n\\ln n$ and $B=\\frac{\\pi^{2}}{6}n^{2}$,\n$$\n\\frac{B}{\\mu^{2}}\n=\\frac{\\frac{\\pi^{2}}{6}n^{2}}{\\left(2n\\ln n\\right)^{2}}\n=\\frac{\\pi^{2}}{24(\\ln n)^{2}}.\n$$\nHence the minimal sufficient $\\lambda$ is\n$$\n\\lambda=\\frac{\\pi}{\\ln n}\\sqrt{\\frac{12\\ln 10+\\ln 2}{24}}.\n$$\nFor $n=40000$, $\\ln n=\\ln(4\\times 10^{4})=\\ln 4+4\\ln 10$. Substituting numerical values,\n$$\n\\ln 2\\approx 0.6931471806,\\quad \\ln 10\\approx 2.302585093,\\quad \\ln 4=2\\ln 2\\approx 1.386294361,\n$$\nso\n$$\n\\ln n\\approx 1.386294361+4\\times 2.302585093\\approx 10.596634733,\n$$\nand\n$$\n\\lambda\\approx \\frac{\\pi}{10.596634733}\\sqrt{\\frac{12\\ln 10+\\ln 2}{24}}\n\\approx 0.296470788\\times 1.086357989\\approx 0.322073409.\n$$\nRounding to three significant figures gives $0.322$.", "answer": "$$\\boxed{0.322}$$", "id": "1336225"}, {"introduction": "For our final practice, we venture into the study of evolving random structures by analyzing the Wiener index of a random recursive tree. This problem introduces a powerful generalization of the Azuma-Hoeffding inequality known as McDiarmid's inequality, which applies to any function of independent variables that satisfies the \"bounded difference\" property. Your task will be to quantify how much a single, local random choice—the attachment of a new vertex—can influence a global property of the tree, thereby establishing a concentration bound for a complex graph metric. [@problem_id:1345075]", "problem": "A random recursive tree $T_n$ on the vertex set $V=\\{1, 2, \\dots, n\\}$ is constructed as follows: The tree starts with a single vertex, $T_1$. For $k=2, 3, \\dots, n$, the tree $T_k$ is formed from $T_{k-1}$ by adding vertex $k$ and an edge connecting $k$ to a parent vertex chosen uniformly at random from the set $\\{1, 2, \\dots, k-1\\}$.\n\nThe Wiener index of a graph $G$, denoted $W(G)$, is the sum of the shortest path distances between all unordered pairs of distinct vertices. That is, $W(G) = \\sum_{\\{u,v\\} \\subseteq V} d(u,v)$, where $d(u,v)$ is the number of edges in the shortest path between $u$ and $v$.\n\nLet $W(T_n)$ be the Wiener index of the random recursive tree on $n$ vertices. Derive an upper bound for the probability $P(|W(T_n) - \\mathbb{E}[W(T_n)]| \\geq t)$, where $t > 0$. Your final answer should be a closed-form expression in terms of $n$ and $t$.", "solution": "The problem asks for a concentration inequality for the Wiener index of a random recursive tree. The random process is determined by a sequence of $n-1$ independent random choices: for each vertex $k \\in \\{2, \\dots, n\\}$, we choose a parent $J_k$ uniformly from $\\{1, \\dots, k-1\\}$. The Wiener index $W(T_n)$ is a function of these $n-1$ random variables, $W(T_n) = f(J_2, J_3, \\dots, J_n)$.\n\nWe can use McDiarmid's inequality to bound the deviation of $W(T_n)$ from its expectation. McDiarmid's inequality states that if a function $f(X_1, \\dots, X_m)$ of independent random variables satisfies the bounded differences property,\n$$\n\\sup_{x_1, \\dots, x_m, x'_i} |f(x_1, \\dots, x_i, \\dots, x_m) - f(x_1, \\dots, x'_i, \\dots, x_m)| \\leq c_i\n$$\nfor each $i \\in \\{1, \\dots, m\\}$, then for any $t > 0$,\n$$\nP(|f(X_1, \\dots, X_m) - \\mathbb{E}[f]| \\geq t) \\leq 2 \\exp\\left(-\\frac{2t^2}{\\sum_{i=1}^m c_i^2}\\right).\n$$\n\nIn our case, the variables are $J_2, \\dots, J_n$. We need to find the bounds $c_k$ for $k=2, \\dots, n$. The constant $c_k$ is the maximum possible change in the Wiener index $W(T_n)$ if we only change the parent of vertex $k$, keeping all other parent choices fixed.\n\nLet's fix the parent choices $J_i$ for all $i \\in \\{2, \\dots, n\\} \\setminus \\{k\\}$. This defines the structure of the tree $T_{k-1}$ and also specifies how all vertices $i > k$ will attach to the growing tree. Let $T$ be the resulting tree when vertex $k$ attaches to a parent $j_a \\in \\{1, \\dots, k-1\\}$, and let $T'$ be the tree when $k$ attaches to a different parent $j_b \\in \\{1, \\dots, k-1\\}$. The trees $T$ and $T'$ have the same vertex set and differ only by one edge: $(k, j_a) \\in E(T)$ and $(k, j_b) \\in E(T')$.\n\nWe want to bound $|W(T) - W(T')|$. Removing the edge $(k, j_a)$ from $T$ splits the tree into two components. One component is the subtree rooted at $k$, let's call it $S_k$. This subtree contains vertex $k$ itself and all vertices $i>k$ for which the path from $i$ to the root set $\\{1, \\dots, k-1\\}$ passes through $k$. The other component is $T \\setminus S_k$. In $T'$, the subtree $S_k$ is attached to vertex $j_b$ instead of $j_a$.\n\nThe distances between pairs of vertices both in $S_k$ or both in $T \\setminus S_k$ remain unchanged. The change in the Wiener index comes from pairs of vertices with one vertex in $S_k$ and the other in $T \\setminus S_k$.\nLet $u \\in S_k$ and $v \\in T \\setminus S_k$.\nIn $T$, the path from $u$ to $v$ goes through the edge $(k, j_a)$. So, $d_T(u,v) = d_{S_k}(u,k) + 1 + d_{T \\setminus S_k}(j_a, v)$.\nIn $T'$, the path from $u$ to $v$ goes through the edge $(k, j_b)$. So, $d_{T'}(u,v) = d_{S_k}(u,k) + 1 + d_{T \\setminus S_k}(j_b, v)$.\nNote that the graphs $T \\setminus S_k$ and $T' \\setminus S_k$ are identical.\n\nThe total change in the Wiener index is:\n$$\n\\Delta W = W(T) - W(T') = \\sum_{u \\in S_k} \\sum_{v \\in T \\setminus S_k} (d_T(u,v) - d_{T'}(u,v))\n$$\n$$\n\\Delta W = \\sum_{u \\in S_k} \\sum_{v \\in T \\setminus S_k} (d_{T \\setminus S_k}(j_a,v) - d_{T \\setminus S_k}(j_b,v))\n$$\n$$\n\\Delta W = |S_k| \\sum_{v \\in T \\setminus S_k} (d_{T \\setminus S_k}(j_a,v) - d_{T \\setminus S_k}(j_b,v))\n$$\nTo bound $|\\Delta W|$, we use the triangle inequality on distances: $|d(j_a,v) - d(j_b,v)| \\le d(j_a,j_b)$. The distance $d(j_a, j_b)$ is computed in the graph $T\\setminus S_k$. Since $j_a, j_b \\in \\{1,\\dots, k-1\\}$, the path between them lies entirely within the subgraph induced by $\\{1,\\dots, k-1\\}$, which is $T_{k-1}$.\n$$\n|\\Delta W| \\leq |S_k| \\sum_{v \\in T \\setminus S_k} |d_{T \\setminus S_k}(j_a,v) - d_{T \\setminus S_k}(j_b,v)| \\leq |S_k| \\sum_{v \\in T \\setminus S_k} d_{T_{k-1}}(j_a,j_b)\n$$\n$$\n|\\Delta W| \\leq |S_k| |V(T \\setminus S_k)| d_{T_{k-1}}(j_a,j_b) = |S_k| (n - |S_k|) d_{T_{k-1}}(j_a,j_b).\n$$\nTo find $c_k$, we must maximize this quantity over all possible configurations. The choices for attachments that determine $S_k$ are independent of the choices that determine $T_{k-1}$.\nWe maximize each term separately:\n1.  $\\max d_{T_{k-1}}(j_a, j_b)$: The maximum distance between any two vertices in a tree on $k-1$ vertices (its diameter) is at most $k-2$. This occurs if $T_{k-1}$ is a path graph and $j_a, j_b$ are its endpoints.\n2.  $\\max_{|S_k|} |S_k|(n - |S_k|)$: The size of the subtree $S_k$ can range from 1 to $n-k+1$. The function $x(n-x)$ is maximized at $x=n/2$. Thus, $|S_k|(n-|S_k|) \\leq \\frac{n^2}{4}$.\n\nCombining these bounds gives the worst-case change $c_k$:\n$$\nc_k \\leq \\frac{n^2}{4}(k-2).\n$$\nNow we compute the sum of squares for McDiarmid's inequality:\n$$\n\\sum_{k=2}^{n} c_k^2 \\leq \\sum_{k=2}^{n} \\left(\\frac{n^2}{4}(k-2)\\right)^2 = \\frac{n^4}{16} \\sum_{k=2}^{n} (k-2)^2.\n$$\nLet $j=k-2$. The sum becomes:\n$$\n\\sum_{j=0}^{n-2} j^2 = \\frac{(n-2)((n-2)+1)(2(n-2)+1)}{6} = \\frac{(n-2)(n-1)(2n-3)}{6}.\n$$\nSo, the sum of squared differences is bounded by:\n$$\n\\sum_{k=2}^{n} c_k^2 \\leq \\frac{n^4}{16} \\frac{(n-2)(n-1)(2n-3)}{6} = \\frac{n^4(n-1)(n-2)(2n-3)}{96}.\n$$\nSubstituting this into McDiarmid's inequality, we get the final probability bound:\n$$\nP(|W(T_n) - \\mathbb{E}[W(T_n)]| \\geq t) \\leq 2 \\exp\\left(-\\frac{2t^2}{\\frac{n^4(n-1)(n-2)(2n-3)}{96}}\\right)\n$$\n$$\nP(|W(T_n) - \\mathbb{E}[W(T_n)]| \\geq t) \\leq 2 \\exp\\left(-\\frac{192 t^2}{n^4(n-1)(n-2)(2n-3)}\\right).\n$$\nThe problem is only valid for $n \\ge 3$ for the formula to be non-degenerate. For $n=2$, the sum of squares is 0.\n\nFinal expression:\nFor $n \\ge 3$: $2 \\exp\\left(-\\frac{192 t^2}{n^4(n-1)(n-2)(2n-3)}\\right)$.\nFor $n=2$, $T_2$ is fixed (edge (1,2)), $W(T_2)=1$, so the probability is 0 if $t>0$. The formula does not apply. We assume $n \\ge 3$.\nThe expression can also be written avoiding the fraction in the exponent.\n$2 \\exp\\left(-192 t^2 (n^4(n-1)(n-2)(2n-3))^{-1}\\right)$.", "answer": "$$\\boxed{2\\exp\\left(-\\frac{192t^{2}}{n^{4}(n-1)(n-2)(2n-3)}\\right)}$$", "id": "1345075"}]}