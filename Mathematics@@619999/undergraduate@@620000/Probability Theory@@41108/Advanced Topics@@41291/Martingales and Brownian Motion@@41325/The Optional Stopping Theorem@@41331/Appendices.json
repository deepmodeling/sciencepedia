{"hands_on_practices": [{"introduction": "We begin with a classic question: if a random walk has a tendency to drift downwards, what is the chance it ever reaches a high target level? The Optional Stopping Theorem provides an elegant way to answer this. This exercise guides you through the process of constructing a special type of process, an exponential martingale, to find a sharp upper bound on this probability, a technique that is foundational in areas like financial modeling and risk assessment [@problem_id:1403925].", "problem": "A particle performs a random walk on the set of integers $\\mathbb{Z}$. The particle starts at position $S_0=0$. At each discrete time step $n = 1, 2, \\dots$, the particle's position changes by an amount $X_n$. The increments $X_n$ are independent and identically distributed random variables given by the following probability distribution:\n$$\nP(X_n = +1) = p \\quad \\text{and} \\quad P(X_n = -1) = 1-p\n$$\nThe position of the particle after $n$ steps is given by the sum $S_n = \\sum_{i=1}^n X_i$. You are given that the probability of moving one unit to the right, $p$, is a constant strictly less than $1/2$.\n\nFor a given positive integer target level $a > 0$, find an upper bound on the probability that the particle's position $S_n$ ever reaches or exceeds $a$. Express your answer as an analytic expression in terms of $p$ and $a$.", "solution": "Let $q = 1 - p$ so that $q > p$ because $p < \\frac{1}{2}$. Consider the random walk $S_{n} = \\sum_{i=1}^{n} X_{i}$ with $X_{i} \\in \\{+1,-1\\}$, and define the target level $a \\in \\mathbb{N}$.\n\nTo bound $P\\!\\left(\\sup_{n \\geq 0} S_{n} \\geq a\\right)$, construct an exponential martingale. For $r > 0$, define $M_{n} = r^{S_{n}}$. Since the $X_{i}$ are i.i.d.,\n$$\n\\mathbb{E}\\!\\left[r^{X_{1}}\\right] = p r + q r^{-1}.\n$$\nChoose $r$ to satisfy the martingale condition $\\mathbb{E}\\!\\left[r^{X_{1}}\\right] = 1$, which yields the quadratic\n$$\np r^{2} - r + q = 0.\n$$\nThis has roots $r = 1$ and $r = \\frac{q}{p}$. Because $q > p$, take $r = \\frac{q}{p} > 1$. Then $\\{M_{n}\\}_{n \\geq 0}$ with $M_{n} = r^{S_{n}}$ is a martingale and $M_{0} = r^{S_{0}} = 1$.\n\nFor $a, b \\in \\mathbb{N}$, define the stopping times $T_{a} = \\inf\\{n \\geq 0 : S_{n} = a\\}$ and $T_{-b} = \\inf\\{n \\geq 0 : S_{n} = -b\\}$, and set $T = \\min\\{T_{a}, T_{-b}\\}$. By boundedness of increments, the optional stopping theorem applies, giving\n$$\n\\mathbb{E}\\!\\left[M_{T}\\right] = \\mathbb{E}\\!\\left[r^{S_{T}}\\right] = M_{0} = 1.\n$$\nLet $P_{a,b} = \\mathbb{P}(T_{a} < T_{-b})$. On $\\{T_{a} < T_{-b}\\}$, $S_{T} = a$; on $\\{T_{-b} < T_{a}\\}$, $S_{T} = -b$. Therefore\n$$\n1 = \\mathbb{E}\\!\\left[r^{S_{T}}\\right] = r^{a} P_{a,b} + r^{-b} (1 - P_{a,b}).\n$$\nSolve for $P_{a,b}$:\n$$\n1 - r^{-b} = P_{a,b} \\left(r^{a} - r^{-b}\\right)\n\\quad \\Longrightarrow \\quad\nP_{a,b} = \\frac{1 - r^{-b}}{r^{a} - r^{-b}} = \\frac{r^{b} - 1}{r^{a+b} - 1}.\n$$\nLetting $b \\to \\infty$ and using $r > 1$, we obtain\n$$\n\\mathbb{P}\\!\\left(\\sup_{n \\geq 0} S_{n} \\geq a\\right)\n= \\lim_{b \\to \\infty} P_{a,b}\n= \\lim_{b \\to \\infty} \\frac{r^{b} - 1}{r^{a+b} - 1}\n= r^{-a}\n= \\left(\\frac{p}{q}\\right)^{a}\n= \\left(\\frac{p}{1 - p}\\right)^{a}.\n$$\nThus an upper bound is\n$$\n\\mathbb{P}\\!\\left(\\sup_{n \\geq 0} S_{n} \\geq a\\right) \\leq \\left(\\frac{p}{1 - p}\\right)^{a},\n$$\nand in fact equality holds for this random walk.", "answer": "$$\\boxed{\\left(\\frac{p}{1-p}\\right)^{a}}$$", "id": "1403925"}, {"introduction": "Not all processes stop upon hitting a fixed boundary; sometimes, they are terminated by an external event that is independent of the process itself. This practice explores such a scenario, where a symmetric random walk is stopped at a random time $T$ [@problem_id:809821]. By applying the Optional Stopping Theorem to a provided polynomial martingale, you will see how to calculate moments of the process at this random time, a skill that requires careful use of conditional expectation and the law of total expectation.", "problem": "Consider a one-dimensional symmetric random walk $S_n = \\sum_{i=1}^n X_i$ starting from $S_0=0$. The steps $X_i$ are independent and identically distributed random variables with $P(X_i=1) = \\frac{1}{2}$ and $P(X_i=-1) = \\frac{1}{2}$. The random walk is observed until a random time $T$, which is independent of the sequence $\\{X_i\\}$ and follows a geometric distribution with success probability $p \\in (0, 1)$. The probability mass function for $T$ is given by $P(T=k) = p(1-p)^{k-1}$ for $k=1, 2, 3, \\ldots$.\n\nIt is a known result that for this symmetric random walk, the process $M_n$ defined by\n$$\nM_n = S_n^4 - 6nS_n^2 + 3n^2 - 2n\n$$\nis a martingale with respect to the natural filtration $\\mathcal{F}_n = \\sigma(X_1, \\ldots, X_n)$.\n\nBy applying the Optional Stopping Theorem to the martingale $M_n$ at the stopping time $T$, derive a closed-form expression for the fourth moment of the stopped random walk's position, $E[S_T^4]$, in terms of the parameter $p$. You may assume that the conditions for the Optional Stopping Theorem are met.", "solution": "1. Relevant equations:  \n   - Martingale property and Optional Stopping Theorem: \n     $$E[M_T]=E[M_0]=0,$$\n     where \n     $$M_n = S_n^4 - 6nS_n^2 + 3n^2 -2n.$$\n   - Conditional moments for symmetric random walk: \n     $$E[S_n^2]=n,\\quad E[S_n^4]=3n^2 -2n.$$\n   - Moments of $T\\sim\\mathrm{Geom}(p)$:\n     $$E[T]=\\frac1p,\\quad E[T^2]=\\frac{2-p}{p^2}.$$\n2. Apply OST:\n   $$0=E[M_T]=E\\bigl[S_T^4 -6T S_T^2 +3T^2 -2T\\bigr]$$\n   $$\\implies E[S_T^4] = 6\\,E[T S_T^2] -3\\,E[T^2] +2\\,E[T].$$\n3. Compute mixed moment:\n   $$E[T S_T^2]=E\\bigl[E[T S_T^2\\mid T]\\bigr]\n   =E\\bigl[T\\,E[S_T^2\\mid T]\\bigr]\n   =E[T\\cdot T]\n   =E[T^2].$$\n4. Substitute:\n   $$E[S_T^4]\n   =6E[T^2]-3E[T^2]+2E[T]\n   =3E[T^2]+2E[T]\n   =3\\frac{2-p}{p^2}+2\\frac1p\n   =\\frac{6-3p+2p}{p^2}\n   =\\frac{6-p}{p^2}.$$", "answer": "$$\\boxed{\\frac{6-p}{p^2}}$$", "id": "809821"}, {"introduction": "The Gambler's Ruin is a cornerstone problem in probability theory. While finding the probability of ruin is a standard application of martingales, determining the expected duration of the game requires a more sophisticated approach. This culminating exercise demonstrates a powerful strategy where a single martingale is not enough [@problem_id:809940]. You will construct two distinct martingales for the same random walk, apply the Optional Stopping Theorem to each, and combine the resulting equations to solve for the expected time until the game ends.", "problem": "A particle performs a one-dimensional random walk on the integers. The particle's position at time $n$ is denoted by $X_n$. It starts at an initial integer position $X_0 = i$, where $0 < i < N$. At each discrete time step, the particle moves one unit to the right with probability $p$ or one unit to the left with probability $q=1-p$. The walk is biased, meaning $p \\neq q$. The walk stops when the particle's position reaches either 0 or $N$. The time at which this occurs is the stopping time $T = \\inf\\{n \\ge 0: X_n=0 \\text{ or } X_n=N\\}$.\n\nFor this problem, you will need the following definitions:\n- A sequence of random variables $\\{M_n\\}_{n \\ge 0}$ is a **martingale** with respect to a filtration $\\{\\mathcal{F}_n\\}_{n \\ge 0}$ (here, $\\mathcal{F}_n$ is the history of the walk up to time $n$) if $E[|M_n|] < \\infty$ for all $n$, and $E[M_{n+1} | \\mathcal{F}_n] = M_n$.\n- The **Optional Stopping Theorem** states that for a martingale $M_n$ and a stopping time $T$, under certain regularity conditions (which you may assume hold for this problem), the expectation of the martingale at the stopping time is equal to its initial expectation: $E[M_T] = E[M_0]$.\n\nYour task is to derive a closed-form expression for the expected duration of the random walk, $E[T]$, in terms of the parameters $i$, $N$, $p$, and $q$. The derivation must be performed by following these specific steps:\n1.  Define the process $M_n = X_n - n(p-q)$. Show that $M_n$ is a martingale and use the Optional Stopping Theorem to find a relationship between the expected stopping time $E[T]$ and the expected final position $E[X_T]$.\n2.  Define the process $Z_n = (q/p)^{X_n}$. Show that $Z_n$ is a martingale and use the Optional Stopping Theorem to find the probability that the walk ends at position $N$, i.e., $P(X_T=N)$.\n3.  Combine the results from the previous steps to derive the final explicit expression for $E[T]$.", "solution": "1. Define $M_n = X_n - n(p-q)$.  Then\n\n$$\nE[M_{n+1}-M_n\\mid\\mathcal F_n]\n=E[X_{n+1}-X_n\\mid\\mathcal F_n]-(p-q)\n=(p-q)-(p-q)=0,\n$$\n\nand $E[|M_n|]<\\infty$, so $\\{M_n\\}$ is a martingale.  By the Optional Stopping Theorem at $T$,\n\n$$\nE[M_T]=E[M_0]\\quad\\Longrightarrow\\quad\nE[X_T - (p-q)T]=i\n\\quad\\Longrightarrow\\quad\nE[X_T]-(p-q)E[T]=i.\n\\tag{1}\n$$\n\n2. Define $Z_n=(q/p)^{X_n}$.  Then\n\n$$\nE\\bigl[Z_{n+1}\\mid\\mathcal F_n\\bigr]\n=p\\,(q/p)^{X_n+1}+q\\,(q/p)^{X_n-1}\n=(q/p)^{X_n}\\bigl[p(q/p)+q(p/q)\\bigr]\n=(q/p)^{X_n},\n$$\n\nso $\\{Z_n\\}$ is a martingale.  By the Optional Stopping Theorem,\n\n$$\nE[Z_T]=E[Z_0]\\quad\\Longrightarrow\\quad\n(q/p)^i\n=E\\bigl[(q/p)^{X_T}\\bigr]\n=(q/p)^N P(X_T=N)+1\\cdot P(X_T=0).\n$$\n\nLet $\\alpha=P(X_T=N)$.  Then\n\n$$\n(q/p)^i=\\alpha (q/p)^N+(1-\\alpha)\n\\;\\Longrightarrow\\;\n\\alpha=\\frac{1-(q/p)^i}{1-(q/p)^N}.\n\\tag{2}\n$$\n\n3. From (1) we have $E[X_T]=N\\alpha$, so\n\n$$\nN\\alpha-(p-q)E[T]=i\n\\quad\\Longrightarrow\\quad\nE[T]\n=\\frac{N\\alpha-i}{p-q}\n=\\frac{N\\frac{1-(q/p)^i}{1-(q/p)^N}-i}{p-q}.\n$$", "answer": "$$\\boxed{\\frac{N\\frac{1-(\\frac{q}{p})^i}{1-(\\frac{q}{p})^N}-i}{p-q}}$$", "id": "809940"}]}