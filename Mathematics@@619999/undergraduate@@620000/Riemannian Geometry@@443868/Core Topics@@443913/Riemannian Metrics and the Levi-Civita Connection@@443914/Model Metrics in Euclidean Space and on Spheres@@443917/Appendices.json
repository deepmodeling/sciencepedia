{"hands_on_practices": [{"introduction": "The concept of a \"straight line\" becomes beautifully complex when we move from flat Euclidean space to a curved surface like a sphere. This exercise provides a foundational look at the distinction between intrinsic and extrinsic distance. You will derive a precise expression for the difference between the shortest path confined to the sphere's surface (a geodesic arc) and the direct path through the ambient three-dimensional space (a Euclidean chord), giving you a tangible feel for how curvature creates a \"longer\" journey. [@problem_id:3058941]", "problem": "Consider the two-dimensional sphere $S^2_R \\subset \\mathbb{R}^3$ of radius $R$ equipped with the Riemannian metric induced by the standard Euclidean metric on $\\mathbb{R}^3$. Let $p,q \\in S^2_R$ be two points such that the angle between the radius vectors from the center of the sphere to $p$ and $q$ is a given central angle $\\theta$ (in radians), with $0 \\leq \\theta \\leq \\pi$. The geodesic in $S^2_R$ connecting $p$ and $q$ is the shorter great-circle arc, and the Euclidean chord in $\\mathbb{R}^3$ connects $p$ and $q$ directly through the ambient space.\n\nStarting from first principles—namely, the definitions of the induced Riemannian metric and arc length on $S^2_R$, and the Euclidean distance in $\\mathbb{R}^3$—derive an analytic expression for the difference $\\Delta(\\theta; R)$ between the geodesic arc length in $S^2_R$ and the Euclidean chord length in $\\mathbb{R}^3$, as a function of $\\theta$ and $R$. Express angles in radians. Your final answer must be a single closed-form expression for $\\Delta(\\theta; R)$.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains all necessary information for a unique and meaningful solution. It is a fundamental problem in Riemannian geometry concerning the relationship between intrinsic (geodesic) and extrinsic (chord) distances on a submanifold. Therefore, the problem is valid and I will proceed with a full derivation.\n\nThe objective is to find the difference, $\\Delta(\\theta; R)$, between the geodesic distance and the Euclidean distance for two points, $p$ and $q$, on a sphere $S^2_R$ of radius $R$ embedded in the Euclidean space $\\mathbb{R}^3$. The points are separated by a central angle $\\theta$, where $0 \\leq \\theta \\leq \\pi$.\n\nLet the sphere $S^2_R$ be centered at the origin $(0, 0, 0)$ of a Cartesian coordinate system in $\\mathbb{R}^3$. Its equation is $x^2 + y^2 + z^2 = R^2$. Due to the rotational symmetry of the sphere, we can orient our coordinate system for simplicity without loss of generality. Let the great circle containing the geodesic path between $p$ and $q$ lie in the $xy$-plane (i.e., the plane defined by $z=0$).\n\nWe can place point $p$ on the positive $x$-axis. Its coordinates are therefore $p = (R, 0, 0)$.\nSince the central angle between the radius vectors from the origin to $p$ and $q$ is $\\theta$, the coordinates of $q$ in the $xy$-plane are given by a rotation of $p$ by the angle $\\theta$. Thus, $q = (R\\cos\\theta, R\\sin\\theta, 0)$.\n\nFirst, we calculate the geodesic distance, $L_{\\text{geo}}$, between $p$ and $q$. The geodesic on a sphere is an arc of a great circle. The path we have chosen lies on the great circle corresponding to the equator of our coordinate system. This path can be parameterized by a curve $\\gamma(t)$ where $t$ is the angle from the positive $x$-axis.\nThe parameterization of the great-circle arc from $p$ to $q$ is:\n$$\n\\gamma(t) = (R\\cos t, R\\sin t, 0) \\quad \\text{for } t \\in [0, \\theta]\n$$\nNote that $\\gamma(0) = (R, 0, 0) = p$ and $\\gamma(\\theta) = (R\\cos\\theta, R\\sin\\theta, 0) = q$.\n\nThe length of a curve on a Riemannian manifold is found by integrating its speed. The speed is the norm of the velocity vector, computed using the induced Riemannian metric. For a submanifold of $\\mathbb{R}^3$, the induced metric yields the same norm for the tangent vector as the ambient Euclidean metric. The velocity vector of the curve $\\gamma(t)$ is:\n$$\n\\gamma'(t) = \\frac{d\\gamma}{dt} = (-R\\sin t, R\\cos t, 0)\n$$\nThe speed, $\\|\\gamma'(t)\\|$, is the magnitude of this vector:\n$$\n\\|\\gamma'(t)\\| = \\sqrt{(-R\\sin t)^2 + (R\\cos t)^2 + 0^2} = \\sqrt{R^2\\sin^2 t + R^2\\cos^2 t}\n$$\nUsing the fundamental trigonometric identity $\\sin^2 t + \\cos^2 t = 1$, we get:\n$$\n\\|\\gamma'(t)\\| = \\sqrt{R^2(1)} = R\n$$\nThe speed is constant along the path. The geodesic arc length, $L_{\\text{geo}}$, is the integral of the speed over the parameter interval:\n$$\nL_{\\text{geo}} = \\int_{0}^{\\theta} \\|\\gamma'(t)\\| \\,dt = \\int_{0}^{\\theta} R \\,dt = R[t]_{0}^{\\theta} = R\\theta\n$$\n\nNext, we calculate the length of the Euclidean chord, $L_{\\text{chord}}$, which is the straight-line distance between points $p$ and $q$ in the ambient space $\\mathbb{R}^3$. We use the standard Euclidean distance formula for points $p = (R, 0, 0)$ and $q = (R\\cos\\theta, R\\sin\\theta, 0)$:\n$$\nL_{\\text{chord}} = \\sqrt{(x_q - x_p)^2 + (y_q - y_p)^2 + (z_q - z_p)^2}\n$$\nSubstituting the coordinates:\n$$\nL_{\\text{chord}} = \\sqrt{(R\\cos\\theta - R)^2 + (R\\sin\\theta - 0)^2 + (0 - 0)^2}\n$$\n$$\nL_{\\text{chord}} = \\sqrt{R^2(\\cos\\theta - 1)^2 + R^2\\sin^2\\theta} = R\\sqrt{(\\cos\\theta - 1)^2 + \\sin^2\\theta}\n$$\nExpanding the squared term:\n$$\nL_{\\text{chord}} = R\\sqrt{(\\cos^2\\theta - 2\\cos\\theta + 1) + \\sin^2\\theta} = R\\sqrt{(\\cos^2\\theta + \\sin^2\\theta) - 2\\cos\\theta + 1}\n$$\nApplying the identity $\\cos^2\\theta + \\sin^2\\theta = 1$:\n$$\nL_{\\text{chord}} = R\\sqrt{1 - 2\\cos\\theta + 1} = R\\sqrt{2 - 2\\cos\\theta} = R\\sqrt{2(1 - \\cos\\theta)}\n$$\nTo simplify this expression, we use the half-angle identity $1 - \\cos\\theta = 2\\sin^2(\\frac{\\theta}{2})$:\n$$\nL_{\\text{chord}} = R\\sqrt{2 \\cdot 2\\sin^2\\left(\\frac{\\theta}{2}\\right)} = R\\sqrt{4\\sin^2\\left(\\frac{\\theta}{2}\\right)} = 2R\\left|\\sin\\left(\\frac{\\theta}{2}\\right)\\right|\n$$\nGiven the constraint $0 \\leq \\theta \\leq \\pi$, the argument of the sine function is $0 \\leq \\frac{\\theta}{2} \\leq \\frac{\\pi}{2}$. In this interval, $\\sin(\\frac{\\theta}{2})$ is non-negative, so the absolute value is redundant.\n$$\nL_{\\text{chord}} = 2R\\sin\\left(\\frac{\\theta}{2}\\right)\n$$\n\nFinally, the difference $\\Delta(\\theta; R)$ is the geodesic length minus the chord length:\n$$\n\\Delta(\\theta; R) = L_{\\text{geo}} - L_{\\text{chord}}\n$$\n$$\n\\Delta(\\theta; R) = R\\theta - 2R\\sin\\left(\\frac{\\theta}{2}\\right)\n$$\nFactoring out the radius $R$, we obtain the final closed-form expression:\n$$\n\\Delta(\\theta; R) = R\\left(\\theta - 2\\sin\\left(\\frac{\\theta}{2}\\right)\\right)\n$$\nThis expression represents the \"slack\" between the path constrained to the sphere's surface and the direct path through the ambient space. For $\\theta=0$, $\\Delta(0;R) = R(0 - 2\\sin(0)) = 0$, as expected. For $\\theta=\\pi$ (antipodal points), $\\Delta(\\pi;R) = R(\\pi - 2\\sin(\\pi/2)) = R(\\pi - 2)$, which is the difference between half the circumference of a great circle and the diameter of the sphere.", "answer": "$$\n\\boxed{R\\left(\\theta - 2\\sin\\left(\\frac{\\theta}{2}\\right)\\right)}\n$$", "id": "3058941"}, {"introduction": "While we can intuitively grasp that geodesics on a sphere are great circles, Riemannian geometry provides a powerful engine for finding these paths from first principles. The geodesic equation, using Christoffel symbols derived from the metric, acts as a law of motion for a particle trying to move as straight as possible. This practice bridges theory and computation by having you derive these equations and then implement a numerical solver to trace geodesic paths, turning abstract differential equations into visible trajectories on the sphere. [@problem_id:3058947]", "problem": "Consider the standard round metric of the unit two-dimensional sphere $S^2$ written in spherical coordinates $(\\theta,\\phi)$, where $\\theta \\in (0,\\pi)$ is the colatitude and $\\phi \\in [0,2\\pi)$ is the longitude. The Riemannian metric is given by the positive-definite symmetric tensor\n$$\ng = d\\theta^2 + \\sin^2(\\theta)\\, d\\phi^2\n$$\nso that $g_{11} = 1$, $g_{22} = \\sin^2(\\theta)$, and $g_{12} = g_{21} = 0$ in the coordinate basis $(\\partial_\\theta,\\partial_\\phi)$. Using only the following foundational facts:\n- The Levi-Civita connection coefficients (Christoffel symbols) $\\Gamma^k_{ij}$ are defined by\n$$\n\\Gamma^k_{ij} = \\tfrac{1}{2} g^{k\\ell}\\left(\\partial_i g_{j\\ell} + \\partial_j g_{i\\ell} - \\partial_\\ell g_{ij}\\right),\n$$\nwhere $g^{ij}$ are the components of the inverse metric tensor and $\\partial_i$ denotes the partial derivative with respect to the $i$-th coordinate.\n- The geodesic equation in coordinates is\n$$\n\\frac{d^2 x^k}{ds^2} + \\Gamma^k_{ij}(x(s)) \\frac{dx^i}{ds}\\frac{dx^j}{ds} = 0,\n$$\nfor an affinely parameterized curve $s \\mapsto x(s)$, with $x^1=\\theta$, $x^2=\\phi$.\nderive the explicit system of ordinary differential equations (ODEs) for $\\theta(s)$ and $\\phi(s)$ that define geodesics on $S^2$.\n\nImplement a numerical integrator to solve the initial value problem for these geodesic equations, given an initial point $(\\theta_0,\\phi_0)$ and an initial tangent vector $(\\dot{\\theta}_0,\\dot{\\phi}_0)$, for a specified affine parameter length $L > 0$. Convert the second-order system into a first-order system before integrating. You may use any stable, general-purpose ODE integrator.\n\nFor each test case below:\n- Integrate forward in the affine parameter $s$ from $s=0$ to $s=L$.\n- Report the final coordinates $(\\theta(L),\\phi(L))$, with the longitude normalized modulo $2\\pi$ to lie in the interval $[0,2\\pi)$.\n- Report the absolute discrepancy in the squared speed, namely \n$$\n\\left|\\left(g_{ij}(x(0))\\,\\dot{x}^i(0)\\,\\dot{x}^j(0)\\right) - \\left(g_{ij}(x(L))\\,\\dot{x}^i(L)\\,\\dot{x}^j(L)\\right)\\right|,\n$$\nwhich should be small for a good numerical integrator since the Levi-Civita connection preserves the speed along geodesics.\n\nAngles must be expressed in radians. All numerical outputs must be rounded to $8$ decimal places.\n\nTest suite (each tuple is $(\\theta_0,\\phi_0,\\dot{\\theta}_0,\\dot{\\phi}_0,L)$):\n- Case A (equatorial great circle): $(\\frac{\\pi}{2},\\,0,\\,0,\\,1,\\,\\frac{\\pi}{2})$.\n- Case B (meridian segment): $(\\frac{\\pi}{3},\\,1,\\,1,\\,0,\\,0.5)$.\n- Case C (nontrivial initial direction away from equator): $(0.3,\\,0.2,\\,0,\\,\\frac{1}{\\sin(0.3)},\\,0.6)$.\n- Case D (degenerate initial speed): $(1.2,\\,2.3,\\,0,\\,0,\\,1.0)$.\n\nYour program must:\n- Use the derived Christoffel symbols and geodesic equations to set up the first-order ODE system.\n- Numerically integrate each test case.\n- For each case, output a list $[\\theta(L),\\phi(L),\\Delta]$, where $\\Delta$ is the speed-squared discrepancy as defined above, all rounded to $8$ decimal places, and with $\\phi(L)$ reduced modulo $2\\pi$ to $[0,2\\pi)$.\n- Produce a single line of output containing the results for all test cases, as a comma-separated list of these per-case lists, enclosed in square brackets, with no spaces. For example: $[[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot],\\ldots]$.\n\nNo user input is required; all constants are specified above and must be used exactly as written. Ensure numerical stability near the coordinate singularities at $\\theta=0$ and $\\theta=\\pi$ without changing the model metric or reparameterizing the sphere.", "solution": "The problem requires the derivation and numerical solution of the geodesic equations on a two-dimensional unit sphere $S^2$. The derivation proceeds from the provided Riemannian metric and the definition of the Levi-Civita connection.\n\nFirst, we identify the components of the metric tensor and its inverse. The metric is given by $g = d\\theta^2 + \\sin^2(\\theta) d\\phi^2$. In coordinates $x^1 = \\theta$ and $x^2 = \\phi$, the metric tensor components are:\n$$\ng_{ij} = \\begin{pmatrix} 1  0 \\\\ 0  \\sin^2\\theta \\end{pmatrix}\n$$\nSo, $g_{11} = 1$, $g_{22} = \\sin^2\\theta$, and $g_{12} = g_{21} = 0$. The inverse metric tensor $g^{ij}$ is the matrix inverse of $g_{ij}$:\n$$\ng^{ij} = \\begin{pmatrix} 1  0 \\\\ 0  \\frac{1}{\\sin^2\\theta} \\end{pmatrix}\n$$\nSo, $g^{11} = 1$, $g^{22} = \\frac{1}{\\sin^2\\theta}$, and $g^{12} = g^{21} = 0$.\n\nNext, we compute the Christoffel symbols (Levi-Civita connection coefficients) $\\Gamma^k_{ij}$ using the formula:\n$$\n\\Gamma^k_{ij} = \\frac{1}{2} g^{k\\ell}\\left(\\partial_i g_{j\\ell} + \\partial_j g_{i\\ell} - \\partial_\\ell g_{ij}\\right)\n$$\nwhere $\\partial_i$ denotes the partial derivative with respect to $x^i$. Here, $\\partial_1 = \\partial_\\theta$ and $\\partial_2 = \\partial_\\phi$. The only non-constant component of $g_{ij}$ is $g_{22} = \\sin^2\\theta$, so we only need to consider its derivatives. The only non-zero partial derivative is:\n$$\n\\partial_1 g_{22} = \\partial_\\theta(\\sin^2\\theta) = 2\\sin\\theta\\cos\\theta\n$$\nAll other derivatives, $\\partial_2 g_{22}$, $\\partial_i g_{11}$, and $\\partial_i g_{12}$, are zero.\n\nWe can now compute the non-zero Christoffel symbols.\nFor $\\Gamma^1_{ij}$: since $g^{1\\ell}$ is zero for $\\ell \\neq 1$, we only need to consider the $\\ell=1$ term.\n$$\n\\Gamma^1_{ij} = \\frac{1}{2} g^{11}\\left(\\partial_i g_{j1} + \\partial_j g_{i1} - \\partial_1 g_{ij}\\right) = \\frac{1}{2}\\left(-\\partial_1 g_{ij}\\right)\n$$\nThe only way this is non-zero is if $g_{ij}$ depends on $\\theta$. This occurs for $g_{22}$.\n$$\n\\Gamma^1_{22} = \\frac{1}{2}(1)(2\\partial_2 g_{21} - \\partial_1 g_{22}) = \\frac{1}{2}(0 - \\partial_1 g_{22}) = -\\frac{1}{2}(2\\sin\\theta\\cos\\theta) = -\\sin\\theta\\cos\\theta\n$$\nAll other $\\Gamma^1_{ij}$ are zero.\n\nFor $\\Gamma^2_{ij}$: since $g^{2\\ell}$ is zero for $\\ell \\neq 2$, we only need to consider the $\\ell=2$ term.\n$$\n\\Gamma^2_{ij} = \\frac{1}{2} g^{22}\\left(\\partial_i g_{j2} + \\partial_j g_{i2} - \\partial_2 g_{ij}\\right) = \\frac{1}{2\\sin^2\\theta}\\left(\\partial_i g_{j2} + \\partial_j g_{i2}\\right)\n$$\nThe terms are non-zero only if $\\partial_i g_{j2}$ involves $\\partial_1 g_{22}$. This happens for $(i,j) = (1,2)$ or $(2,1)$.\n$$\n\\Gamma^2_{12} = \\Gamma^2_{21} = \\frac{1}{2} g^{22}\\left(\\partial_1 g_{22} + \\partial_2 g_{12} - \\partial_2 g_{12}\\right) = \\frac{1}{2} g^{22}(\\partial_1 g_{22}) = \\frac{1}{2\\sin^2\\theta}(2\\sin\\theta\\cos\\theta) = \\frac{\\cos\\theta}{\\sin\\theta} = \\cot\\theta\n$$\nAll other $\\Gamma^2_{ij}$ are zero.\n\nThe non-zero Christoffel symbols are:\n$$\n\\Gamma^1_{22} = -\\sin\\theta\\cos\\theta, \\quad \\Gamma^2_{12} = \\Gamma^2_{21} = \\cot\\theta\n$$\n\nNow we write the geodesic equations, $\\frac{d^2 x^k}{ds^2} + \\Gamma^k_{ij} \\frac{dx^i}{ds}\\frac{dx^j}{ds} = 0$, where $s$ is the affine parameter, $\\dot{x}^i = \\frac{dx^i}{ds}$, and $\\ddot{x}^k = \\frac{d^2 x^k}{ds^2}$.\n\nFor $k=1$ ($\\theta$ coordinate):\n$$\n\\ddot{\\theta} + \\Gamma^1_{11}\\dot{\\theta}^2 + 2\\Gamma^1_{12}\\dot{\\theta}\\dot{\\phi} + \\Gamma^1_{22}\\dot{\\phi}^2 = 0\n$$\nSubstituting the symbols:\n$$\n\\ddot{\\theta} + 0 + 0 + (-\\sin\\theta\\cos\\theta)\\dot{\\phi}^2 = 0 \\implies \\ddot{\\theta} = \\sin\\theta\\cos\\theta\\,\\dot{\\phi}^2\n$$\n\nFor $k=2$ ($\\phi$ coordinate):\n$$\n\\ddot{\\phi} + \\Gamma^2_{11}\\dot{\\theta}^2 + 2\\Gamma^2_{12}\\dot{\\theta}\\dot{\\phi} + \\Gamma^2_{22}\\dot{\\phi}^2 = 0\n$$\nSubstituting the symbols:\n$$\n\\ddot{\\phi} + 0 + 2(\\cot\\theta)\\dot{\\theta}\\dot{\\phi} + 0 = 0 \\implies \\ddot{\\phi} = -2\\cot\\theta\\,\\dot{\\theta}\\dot{\\phi}\n$$\n\nThe system of second-order ODEs for the geodesics is:\n$$\n\\begin{cases}\n\\ddot{\\theta}(s) = \\sin(\\theta(s)) \\cos(\\theta(s)) \\dot{\\phi}(s)^2 \\\\\n\\ddot{\\phi}(s) = -2 \\cot(\\theta(s)) \\dot{\\theta}(s) \\dot{\\phi}(s)\n\\end{cases}\n$$\n\nFor numerical integration, we convert this system into a first-order system. Let the state vector be $y(s) = [y_1, y_2, y_3, y_4]^T = [\\theta, \\phi, \\dot{\\theta}, \\dot{\\phi}]^T$. The first-order system $\\frac{dy}{ds} = f(s,y)$ is:\n$$\n\\frac{d}{ds}\n\\begin{pmatrix} y_1 \\\\ y_2 \\\\ y_3 \\\\ y_4 \\end{pmatrix}\n=\n\\begin{pmatrix}\ny_3 \\\\\ny_4 \\\\\n\\sin(y_1)\\cos(y_1) y_4^2 \\\\\n-2\\cot(y_1) y_3 y_4\n\\end{pmatrix}\n$$\nThis system is solved numerically for each test case using a standard ODE integrator.\n\nThe squared speed of the curve is given by $v^2(s) = g_{ij}(x(s))\\,\\dot{x}^i(s)\\,\\dot{x}^j(s) = \\dot{\\theta}(s)^2 + \\sin^2(\\theta(s))\\,\\dot{\\phi}(s)^2$. For a geodesic, the Levi-Civita connection preserves the metric, so the speed is constant. The required absolute discrepancy, $\\Delta$, is a measure of the numerical error of the integration:\n$$\n\\Delta = |v^2(0) - v^2(L)| = \\left|(\\dot{\\theta}_0^2 + \\sin^2(\\theta_0)\\dot{\\phi}_0^2) - (\\dot{\\theta}(L)^2 + \\sin^2(\\theta(L))\\dot{\\phi}(L)^2)\\right|\n$$\nThe final longitude $\\phi(L)$ is normalized to the interval $[0, 2\\pi)$.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Derives, implements, and solves the geodesic equations for a 2-sphere.\n    \"\"\"\n    # Define test cases: (theta0, phi0, dtheta0, dphi0, L)\n    test_cases = [\n        (np.pi / 2, 0.0, 0.0, 1.0, np.pi / 2),  # Case A\n        (np.pi / 3, 1.0, 1.0, 0.0, 0.5),      # Case B\n        (0.3, 0.2, 0.0, 1.0 / np.sin(0.3), 0.6), # Case C\n        (1.2, 2.3, 0.0, 0.0, 1.0)           # Case D\n    ]\n\n    def geodesic_ode(s, y):\n        \"\"\"\n        Defines the first-order system for the geodesic equations on S^2.\n        State vector y = [theta, phi, dtheta, dphi].\n        \"\"\"\n        theta, phi, dtheta, dphi = y\n\n        sin_theta = np.sin(theta)\n        cos_theta = np.cos(theta)\n\n        # The coordinate system is singular at the poles (theta=0, pi).\n        # At a pole, cot(theta) is infinite.\n        # However, for a valid geodesic passing through a pole (a meridian),\n        # dphi must be zero, making the problematic term zero.\n        # If dphi is non-zero, the path does not cross the pole.\n        # The term can be evaluated directly if dphi=0 or theta is not a pole.\n        if sin_theta == 0.0:\n            # At a pole, d(dphi)/ds should be 0 for a smooth path.\n            # This is naturally handled if dtheta or dphi is zero.\n            ddphi = 0.0\n        else:\n            cot_theta = cos_theta / sin_theta\n            ddphi = -2.0 * cot_theta * dtheta * dphi\n        \n        ddtheta = sin_theta * cos_theta * dphi**2\n\n        return [dtheta, dphi, ddtheta, ddphi]\n\n    results = []\n    \n    for case in test_cases:\n        theta0, phi0, dtheta0, dphi0, L = case\n        y0 = [theta0, phi0, dtheta0, dphi0]\n\n        # Integrate the ODE system.\n        # Tight tolerances are used to minimize numerical error and ensure\n        # the speed-squared discrepancy is small.\n        sol = solve_ivp(\n            geodesic_ode,\n            [0, L],\n            y0,\n            method='RK45',\n            rtol=1e-12,\n            atol=1e-12\n        )\n\n        # Extract the final state from the integration result.\n        theta_L, phi_L, dtheta_L, dphi_L = sol.y[:, -1]\n\n        # Normalize the final longitude to the interval [0, 2*pi).\n        phi_L_norm = np.mod(phi_L, 2 * np.pi)\n\n        # Calculate the initial and final squared speeds.\n        v0_sq = dtheta0**2 + np.sin(theta0)**2 * dphi0**2\n        vL_sq = dtheta_L**2 + np.sin(theta_L)**2 * dphi_L**2\n\n        # Calculate the absolute discrepancy in squared speed.\n        discrepancy = np.abs(v0_sq - vL_sq)\n\n        # Append the final calculated values for this case.\n        results.append([theta_L, phi_L_norm, discrepancy])\n\n    # Format the output string precisely as required.\n    output_parts = []\n    for res_list in results:\n        # Rounding is done here before formatting to string\n        # to ensure the representation is correct.\n        rounded_list = [round(val, 8) for val in res_list]\n        \n        # Format each number to 8 decimal places to handle trailing zeros.\n        formatted_nums = [f\"{num:.8f}\" for num in rounded_list]\n        output_parts.append(f\"[{','.join(formatted_nums)}]\")\n\n    final_output = f\"[[{','.join(output_parts)}]]\"\n    print(final_output.replace(\"],[\", \"],[\"))\n\nsolve()\n```", "id": "3058947"}, {"introduction": "The Riemannian metric not only defines lengths of curves but also the very notion of area and volume through the volume form. This practice explores a profound scaling property that reveals how the total area of a sphere changes with its radius. By first establishing a general scaling law for volume forms and then applying it to the sphere, you will use a classic integration technique to derive the famous formula for the surface area of an $(n-1)$-dimensional sphere, demonstrating how local metric properties dictate global geometric measures. [@problem_id:3058965]", "problem": "Let $(M,g)$ be an $n$-dimensional Riemannian manifold with Riemannian volume form $\\mathrm{vol}_{g}$. Consider the constant scaling of the metric $\\tilde{g} = c^{2} g$ for a constant $c>0$. Starting from the coordinate definition of the Riemannian volume form and properties of determinants, determine how $\\mathrm{vol}_{g}$ scales under $g \\mapsto c^{2} g$. Then apply this scaling law to the round metric induced on the $(n-1)$-sphere $S^{n-1}(r) \\subset \\mathbb{R}^{n}$ of radius $r>0$, viewed as a hypersurface with the metric induced from the standard Euclidean metric on $\\mathbb{R}^{n}$. Using only fundamental definitions and widely accepted formulas, derive a closed-form analytic expression for the total area $A_{n-1}(r)$ of $S^{n-1}(r)$ in terms of $n$, $r$, $\\pi$, and the Gamma function $\\Gamma$. Your final answer must be a single analytic expression for $A_{n-1}(r)$.", "solution": "The problem asks for a derivation of the total area of an $(n-1)$-sphere of radius $r$, denoted $S^{n-1}(r)$, by first determining how the Riemannian volume form scales under a constant scaling of the metric.\n\nFirst, we address the scaling of the volume form. Let $(M, g)$ be an $n$-dimensional Riemannian manifold. In a local coordinate system $(x^{1}, \\dots, x^{n})$, the metric tensor $g$ is represented by a matrix of its components $g_{ij} = g(\\partial_{i}, \\partial_{j})$. The Riemannian volume form, $\\mathrm{vol}_{g}$, is given by\n$$\n\\mathrm{vol}_{g} = \\sqrt{\\det(g_{ij})} \\, dx^{1} \\wedge \\dots \\wedge dx^{n}\n$$\nwhere $\\det(g_{ij})$ is the determinant of the matrix of metric components. Since $g$ is a Riemannian metric, its matrix representation is positive definite, so its determinant is positive, and we can omit the absolute value sign.\n\nNow, consider a new metric $\\tilde{g} = c^{2}g$ for a constant $c>0$. The components of the new metric tensor are $\\tilde{g}_{ij} = c^{2}g_{ij}$. Let $\\mathbf{G}$ be the $n \\times n$ matrix with entries $g_{ij}$, and $\\mathbf{\\tilde{G}}$ be the matrix with entries $\\tilde{g}_{ij}$. Then $\\mathbf{\\tilde{G}} = c^{2}\\mathbf{G}$.\nUsing the properties of the determinant, we have\n$$\n\\det(\\mathbf{\\tilde{G}}) = \\det(c^{2}\\mathbf{G}) = (c^{2})^{n} \\det(\\mathbf{G}) = c^{2n} \\det(\\mathbf{G})\n$$\nThe new volume form $\\mathrm{vol}_{\\tilde{g}}$ is therefore\n$$\n\\mathrm{vol}_{\\tilde{g}} = \\sqrt{\\det(\\tilde{g}_{ij})} \\, dx^{1} \\wedge \\dots \\wedge dx^{n} = \\sqrt{c^{2n}\\det(g_{ij})} \\, dx^{1} \\wedge \\dots \\wedge dx^{n}\n$$\nSince $c>0$, we can take $\\sqrt{c^{2n}} = c^{n}$ out of the square root:\n$$\n\\mathrm{vol}_{\\tilde{g}} = c^{n} \\sqrt{\\det(g_{ij})} \\, dx^{1} \\wedge \\dots \\wedge dx^{n} = c^{n} \\mathrm{vol}_{g}\n$$\nThus, for an $n$-dimensional manifold, scaling the metric by a factor of $c^{2}$ scales the volume form by a factor of $c^{n}$.\n\nNext, we apply this result to the $(n-1)$-sphere $S^{n-1}(r) \\subset \\mathbb{R}^{n}$ of radius $r>0$. The sphere $S^{n-1}(r)$ is a hypersurface of dimension $n-1$. Let $g_{r}$ be the metric on $S^{n-1}(r)$ induced by the standard Euclidean metric on $\\mathbb{R}^{n}$. Let $g_{1}$ be the induced metric on the unit sphere $S^{n-1}(1)$. The sphere of radius $r$ can be obtained from the unit sphere by the scaling map $\\phi: \\mathbb{R}^{n} \\to \\mathbb{R}^{n}$ given by $\\phi(\\mathbf{x}) = r\\mathbf{x}$. This map sends $S^{n-1}(1)$ to $S^{n-1}(r)$. At corresponding points, the metric tensors are related by $g_{r} = r^{2}g_{1}$. This is a constant scaling of the metric on the $(n-1)$-dimensional manifold $S^{n-1}$.\n\nThe area element on a hypersurface is its volume form. Let $dA_r$ be the area element on $S^{n-1}(r)$ and $dA_1$ be the area element on $S^{n-1}(1)$. Applying the scaling law derived above with an effective dimension of $n-1$ and a scaling constant $c=r$, we find that the area element scales as:\n$$\ndA_{r} = r^{n-1} dA_{1}\n$$\nThe total area $A_{n-1}(r)$ of $S^{n-1}(r)$ is the integral of its area element over the entire manifold:\n$$\nA_{n-1}(r) = \\int_{S^{n-1}(r)} dA_r = \\int_{S^{n-1}(1)} r^{n-1} dA_1 = r^{n-1} \\int_{S^{n-1}(1)} dA_1\n$$\nThe integral $\\int_{S^{n-1}(1)} dA_1$ is the area of the unit $(n-1)$-sphere, which we denote as $A_{n-1}(1)$. Thus, we have the relation $A_{n-1}(r) = r^{n-1}A_{n-1}(1)$. The problem is now reduced to finding a closed-form expression for $A_{n-1}(1)$.\n\nTo find $A_{n-1}(1)$, we employ the widely used technique of evaluating the Gaussian integral over $\\mathbb{R}^{n}$ in two different coordinate systems. Let $I = \\int_{\\mathbb{R}^{n}} \\exp(-\\|\\mathbf{x}\\|^{2}) \\, dV_{n}$, where $\\|\\mathbf{x}\\|^{2} = x_{1}^{2} + \\dots + x_{n}^{2}$ and $dV_{n}$ is the Euclidean volume element.\n\nIn Cartesian coordinates, the integral separates:\n$$\nI = \\int_{-\\infty}^{\\infty} \\dots \\int_{-\\infty}^{\\infty} \\exp(-(x_{1}^{2} + \\dots + x_{n}^{2})) \\, dx_{1} \\dots dx_{n} = \\left(\\int_{-\\infty}^{\\infty} \\exp(-u^{2}) \\, du\\right)^{n}\n$$\nThe value of the standard Gaussian integral is $\\int_{-\\infty}^{\\infty} \\exp(-u^{2}) \\, du = \\sqrt{\\pi}$. Therefore,\n$$\nI = (\\sqrt{\\pi})^{n} = \\pi^{n/2}\n$$\nIn hyperspherical coordinates, the volume element $dV_n$ is expressed as $dV_n = \\rho^{n-1} d\\rho \\, d\\Omega_{n-1}$, where $\\rho$ is the radial coordinate and $d\\Omega_{n-1}$ is the surface element on the unit sphere $S^{n-1}(1)$. The integral becomes:\n$$\nI = \\int_{0}^{\\infty} \\int_{S^{n-1}(1)} \\exp(-\\rho^{2}) \\rho^{n-1} \\, d\\Omega_{n-1} \\, d\\rho\n$$\nSince the integrand $\\exp(-\\rho^{2})\\rho^{n-1}$ does not depend on the angular variables, we can separate the integrals:\n$$\nI = \\left(\\int_{S^{n-1}(1)} d\\Omega_{n-1}\\right) \\left(\\int_{0}^{\\infty} \\rho^{n-1} \\exp(-\\rho^{2}) \\, d\\rho\\right)\n$$\nThe first factor, $\\int_{S^{n-1}(1)} d\\Omega_{n-1}$, is precisely the area of the unit $(n-1)$-sphere, $A_{n-1}(1)$. The second factor is a radial integral that can be evaluated using the Gamma function, $\\Gamma(z) = \\int_{0}^{\\infty} t^{z-1}\\exp(-t) \\, dt$. Let's make the substitution $t = \\rho^{2}$. Then $dt = 2\\rho \\, d\\rho$, so $d\\rho = \\frac{dt}{2\\rho} = \\frac{dt}{2\\sqrt{t}}$. The integral becomes:\n$$\n\\int_{0}^{\\infty} \\rho^{n-1} \\exp(-\\rho^{2}) \\, d\\rho = \\int_{0}^{\\infty} (t^{1/2})^{n-1} \\exp(-t) \\frac{dt}{2t^{1/2}} = \\frac{1}{2} \\int_{0}^{\\infty} t^{(n-1)/2 - 1/2} \\exp(-t) \\, dt\n$$\n$$\n= \\frac{1}{2} \\int_{0}^{\\infty} t^{n/2 - 1} \\exp(-t) \\, dt = \\frac{1}{2}\\Gamma\\left(\\frac{n}{2}\\right)\n$$\nSubstituting this back into the expression for $I$:\n$$\nI = A_{n-1}(1) \\cdot \\frac{1}{2}\\Gamma\\left(\\frac{n}{2}\\right)\n$$\nEquating the two expressions for $I$:\n$$\n\\pi^{n/2} = A_{n-1}(1) \\cdot \\frac{1}{2}\\Gamma\\left(\\frac{n}{2}\\right)\n$$\nSolving for $A_{n-1}(1)$, we get the area of the unit $(n-1)$-sphere:\n$$\nA_{n-1}(1) = \\frac{2\\pi^{n/2}}{\\Gamma\\left(\\frac{n}{2}\\right)}\n$$\nFinally, we substitute this result into our expression for $A_{n-1}(r)$:\n$$\nA_{n-1}(r) = r^{n-1} A_{n-1}(1) = r^{n-1} \\frac{2\\pi^{n/2}}{\\Gamma\\left(\\frac{n}{2}\\right)}\n$$\nThis is the closed-form analytic expression for the total area of the $(n-1)$-sphere of radius $r$.", "answer": "$$\n\\boxed{\\frac{2\\pi^{n/2}r^{n-1}}{\\Gamma\\left(\\frac{n}{2}\\right)}}\n$$", "id": "3058965"}]}