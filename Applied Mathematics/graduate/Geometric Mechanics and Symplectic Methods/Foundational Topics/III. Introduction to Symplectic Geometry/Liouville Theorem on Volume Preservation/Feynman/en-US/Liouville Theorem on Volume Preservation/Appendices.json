{
    "hands_on_practices": [
        {
            "introduction": "Liouville's theorem can be understood by examining the 'source' or 'sink' behavior of the Hamiltonian flow at an infinitesimal level, which is captured by the divergence of the Hamiltonian vector field $X_H$. This exercise provides a hands-on calculation to show that for any system described by a smooth Hamiltonian in canonical coordinates, this divergence is identically zero. By working through a non-polynomial example, you will verify this fundamental property , which holds regardless of the specific form of the energy function.",
            "id": "3754655",
            "problem": "Consider the $2n$-dimensional phase space $\\mathbb{R}^{2n}$ with canonical coordinates $(q^{1},\\dots,q^{n},p_{1},\\dots,p_{n})$, canonical symplectic form $\\omega=\\sum_{i=1}^{n} dq^{i}\\wedge dp_{i}$, and Liouville volume form $\\mu=\\omega^{n}/n!$. Let the Hamiltonian be\n$$\nH(q,p)=\\sum_{i=1}^{n}\\Big(\\ln(1+p_{i}^{2})+\\exp(q^{i})\\Big).\n$$\nStarting from the defining relation for the Hamiltonian vector field $X_{H}$ given by the interior product $i_{X_{H}}\\omega=dH$, derive the corresponding system of ordinary differential equations (ODE) for $(\\dot{q}^{i},\\dot{p}_{i})$ in canonical coordinates. Using the definition of divergence with respect to a volume form, namely $\\mathcal{L}_{X}\\mu=(\\operatorname{div}_{\\mu}X)\\mu$, and the fact that in canonical coordinates where $\\mu$ has constant density the divergence reduces to\n$$\n\\operatorname{div}_{\\mu}X_{H}=\\sum_{i=1}^{n}\\left(\\frac{\\partial \\dot{q}^{i}}{\\partial q^{i}}+\\frac{\\partial \\dot{p}_{i}}{\\partial p_{i}}\\right),\n$$\ncompute $\\operatorname{div}_{\\mu}X_{H}$ for the given non-polynomial Hamiltonian $H(q,p)$ and provide the final simplified analytic expression. Express your final answer as a single closed-form expression. No rounding is required.",
            "solution": "The problem requires the derivation of the equations of motion for a given Hamiltonian system and the computation of the divergence of the corresponding Hamiltonian vector field with respect to the Liouville volume form.\n\nFirst, we validate the problem statement.\n\n### Step 1: Extract Givens\n- Phase space: $2n$-dimensional space $\\mathbb{R}^{2n}$.\n- Canonical coordinates: $(q^{1},\\dots,q^{n},p_{1},\\dots,p_{n})$.\n- Canonical symplectic form: $\\omega=\\sum_{i=1}^{n} dq^{i}\\wedge dp_{i}$.\n- Liouville volume form: $\\mu=\\omega^{n}/n!$.\n- Hamiltonian: $H(q,p)=\\sum_{i=1}^{n}\\Big(\\ln(1+p_{i}^{2})+\\exp(q^{i})\\Big)$.\n- Defining relation for the Hamiltonian vector field $X_{H}$: $i_{X_{H}}\\omega=dH$.\n- Definition of divergence: $\\mathcal{L}_{X}\\mu=(\\operatorname{div}_{\\mu}X)\\mu$, where $\\mathcal{L}_{X}$ is the Lie derivative.\n- Formula for divergence in canonical coordinates: $\\operatorname{div}_{\\mu}X_{H}=\\sum_{i=1}^{n}\\left(\\frac{\\partial \\dot{q}^{i}}{\\partial q^{i}}+\\frac{\\partial \\dot{p}_{i}}{\\partial p_{i}}\\right)$, where $\\dot{q}^{i}$ and $\\dot{p}_{i}$ are the components of $X_{H}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is well-defined within the framework of geometric mechanics and symplectic geometry.\n- **Scientifically Grounded:** The concepts of Hamiltonian mechanics, symplectic forms, Hamiltonian vector fields, and the Liouville volume form are fundamental and well-established. The given Hamiltonian is a smooth function ($C^{\\infty}$) on the phase space $\\mathbb{R}^{2n}$, ensuring that all required derivatives exist and are continuous.\n- **Well-Posed:** The problem is unambiguous and provides all necessary information. It requests a direct calculation based on the provided definitions and formulas. A unique, meaningful solution exists.\n- **Objective:** The problem is stated in precise mathematical language and is free from subjective or opinion-based claims.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution process will proceed.\n\nThe solution consists of two parts: first, deriving Hamilton's equations of motion from the relation $i_{X_{H}}\\omega=dH$, and second, computing the divergence of the resulting vector field $X_{H}$.\n\n**Part 1: Derivation of the Equations of Motion**\n\nThe Hamiltonian is given by\n$$\nH(q,p)=\\sum_{j=1}^{n}\\Big(\\ln(1+p_{j}^{2})+\\exp(q^{j})\\Big)\n$$\nWe compute its exterior derivative, $dH$.\n$$\ndH = \\sum_{i=1}^{n} \\left( \\frac{\\partial H}{\\partial q^{i}} dq^{i} + \\frac{\\partial H}{\\partial p_{i}} dp_{i} \\right)\n$$\nThe partial derivatives of $H$ with respect to the canonical coordinates are:\n$$\n\\frac{\\partial H}{\\partial q^{i}} = \\frac{\\partial}{\\partial q^{i}} \\sum_{j=1}^{n}\\Big(\\ln(1+p_{j}^{2})+\\exp(q^{j})\\Big) = \\exp(q^{i})\n$$\n$$\n\\frac{\\partial H}{\\partial p_{i}} = \\frac{\\partial}{\\partial p_{i}} \\sum_{j=1}^{n}\\Big(\\ln(1+p_{j}^{2})+\\exp(q^{j})\\Big) = \\frac{1}{1+p_{i}^{2}} \\cdot (2p_{i}) = \\frac{2p_{i}}{1+p_{i}^{2}}\n$$\nThus, the exterior derivative of the Hamiltonian is\n$$\ndH = \\sum_{i=1}^{n} \\left( \\exp(q^{i}) dq^{i} + \\frac{2p_{i}}{1+p_{i}^{2}} dp_{i} \\right)\n$$\nThe Hamiltonian vector field $X_{H}$ is written in coordinate form as\n$$\nX_{H} = \\sum_{j=1}^{n} \\left( \\dot{q}^{j} \\frac{\\partial}{\\partial q^{j}} + \\dot{p}_{j} \\frac{\\partial}{\\partial p_{j}} \\right)\n$$\nwhere $\\dot{q}^{j}$ and $\\dot{p}_{j}$ are the component functions of the vector field we seek to determine. The interior product of $X_{H}$ with the symplectic form $\\omega = \\sum_{k=1}^{n} dq^{k} \\wedge dp_{k}$ is\n$$\ni_{X_{H}}\\omega = i_{\\sum_{j=1}^{n} ( \\dot{q}^{j} \\frac{\\partial}{\\partial q^{j}} + \\dot{p}_{j} \\frac{\\partial}{\\partial p_{j}} )} \\left( \\sum_{k=1}^{n} dq^{k} \\wedge dp_{k} \\right)\n$$\nUsing the linearity of the interior product and its action on wedge products, $i_{V}(A \\wedge B) = (i_{V}A)B - A(i_{V}B)$, and on basis forms, $i_{\\partial/\\partial x^{\\alpha}}dx^{\\beta} = \\delta^{\\beta}_{\\alpha}$, we find:\n\\begin{align*}\n i_{X_{H}}\\omega &= \\sum_{j=1}^{n} \\left( \\dot{q}^{j} i_{\\partial/\\partial q^{j}}\\omega + \\dot{p}_{j} i_{\\partial/\\partial p_{j}}\\omega \\right) \\\\\n &= \\sum_{j=1}^{n} \\left( \\dot{q}^{j} \\left( \\sum_{k=1}^{n} (\\delta^{k}_{j} dp_{k} - 0) \\right) + \\dot{p}_{j} \\left( \\sum_{k=1}^{n} (0 - dq^{k} \\delta_{k}^{j}) \\right) \\right) \\\\\n &= \\sum_{j=1}^{n} \\left( \\dot{q}^{j} dp_{j} - \\dot{p}_{j} dq^{j} \\right)\n\\end{align*}\nRe-indexing with $i$ for consistency:\n$$\ni_{X_{H}}\\omega = \\sum_{i=1}^{n} \\left( -\\dot{p}_{i} dq^{i} + \\dot{q}^{i} dp_{i} \\right)\n$$\nNow we enforce the defining relation $i_{X_{H}}\\omega = dH$:\n$$\n\\sum_{i=1}^{n} \\left( -\\dot{p}_{i} dq^{i} + \\dot{q}^{i} dp_{i} \\right) = \\sum_{i=1}^{n} \\left( \\exp(q^{i}) dq^{i} + \\frac{2p_{i}}{1+p_{i}^{2}} dp_{i} \\right)\n$$\nBy comparing the coefficients of the basis $1$-forms $dq^{i}$ and $dp_{i}$ for each $i \\in \\{1, \\dots, n\\}$, we obtain Hamilton's equations:\n$$\n\\dot{q}^{i} = \\frac{\\partial H}{\\partial p_{i}} = \\frac{2p_{i}}{1+p_{i}^{2}}\n$$\n$$\n\\dot{p}_{i} = -\\frac{\\partial H}{\\partial q^{i}} = -\\exp(q^{i})\n$$\nThis is the system of ordinary differential equations describing the evolution of the system.\n\n**Part 2: Computation of the Divergence**\n\nThe problem provides the formula for the divergence of $X_{H}$ with respect to the Liouville volume form $\\mu$ in canonical coordinates:\n$$\n\\operatorname{div}_{\\mu}X_{H}=\\sum_{i=1}^{n}\\left(\\frac{\\partial \\dot{q}^{i}}{\\partial q^{i}}+\\frac{\\partial \\dot{p}_{i}}{\\partial p_{i}}\\right)\n$$\nWe use the expressions for $\\dot{q}^{i}$ and $\\dot{p}_{i}$ derived in Part 1. For each $i$, we compute the required partial derivatives.\n\nThe component $\\dot{q}^{i} = \\frac{2p_{i}}{1+p_{i}^{2}}$ is a function of $p_{i}$ only. Therefore, its partial derivative with respect to $q^{i}$ is:\n$$\n\\frac{\\partial \\dot{q}^{i}}{\\partial q^{i}} = \\frac{\\partial}{\\partial q^{i}} \\left( \\frac{2p_{i}}{1+p_{i}^{2}} \\right) = 0\n$$\nsince $q^{i}$ and $p_i$ are independent coordinates.\n\nThe component $\\dot{p}_{i} = -\\exp(q^{i})$ is a function of $q^{i}$ only. Therefore, its partial derivative with respect to $p_{i}$ is:\n$$\n\\frac{\\partial \\dot{p}_{i}}{\\partial p_{i}} = \\frac{\\partial}{\\partial p_{i}} \\left( -\\exp(q^{i}) \\right) = 0\n$$\nsince $p_i$ and $q^i$ are independent coordinates.\n\nSubstituting these results into the formula for the divergence:\n$$\n\\operatorname{div}_{\\mu}X_{H} = \\sum_{i=1}^{n} (0 + 0) = \\sum_{i=1}^{n} 0 = 0\n$$\nThe divergence of the Hamiltonian vector field is $0$. This result is a specific verification of Liouville's theorem on the preservation of phase space volume, which states that for any Hamiltonian system, the divergence of its vector field with respect to the canonical volume form is identically zero, i.e., $\\operatorname{div}_{\\mu}X_{H}=0$. This is generally true because for any sufficiently smooth Hamiltonian $H$,\n$$\n\\operatorname{div}_{\\mu}X_{H} = \\sum_{i=1}^{n}\\left(\\frac{\\partial}{\\partial q^{i}}\\left(\\frac{\\partial H}{\\partial p_{i}}\\right)+\\frac{\\partial}{\\partial p_{i}}\\left(-\\frac{\\partial H}{\\partial q^{i}}\\right)\\right) = \\sum_{i=1}^{n}\\left(\\frac{\\partial^{2}H}{\\partial q^{i}\\partial p_{i}} - \\frac{\\partial^{2}H}{\\partial p_{i}\\partial q^{i}}\\right) = 0\n$$\nby the equality of mixed partials (Schwarz's theorem). Our explicit calculation confirms this general principle for the given non-polynomial Hamiltonian. The final simplified analytic expression is $0$.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "After seeing the proof in its infinitesimal form, it is instructive to verify Liouville's theorem for a finite time evolution. This practice focuses on a cornerstone of physics, the harmonic oscillator, for which we can explicitly find the flow map $\\Phi_t$ by solving the equations of motion. By directly computing the Jacobian determinant of this map , you will confirm that phase space volume is indeed preserved over any time interval, connecting the abstract theorem to a concrete, time-evolved system.",
            "id": "3754654",
            "problem": "Consider the phase space $\\mathbb{R}^{2n}$ with canonical coordinates $(q_1,\\dots,q_n,p_1,\\dots,p_n)$ and the canonical symplectic two-form $\\omega=\\sum_{i=1}^{n} dq_i \\wedge dp_i$. Let the Hamiltonian be\n$$\nH(q,p)=\\frac{1}{2}\\sum_{i=1}^{n}\\left(p_i^{2}+\\omega_i^{2} q_i^{2}\\right),\n$$\nwhere each $\\omega_i$ is a positive constant. Starting from the definition of the Hamiltonian vector field $X_H$ by interior contraction with the symplectic form, namely $i_{X_H}\\omega=dH$, derive the corresponding system of ordinary differential equations (ODE) for $(q_i(t),p_i(t))$. Solve this initial value problem for arbitrary initial conditions $(q_i(0),p_i(0))$, and thereby obtain the explicit Hamiltonian flow $\\Phi_t:\\mathbb{R}^{2n}\\to\\mathbb{R}^{2n}$. Using your explicit expression for $\\Phi_t$, compute the Jacobian matrix $D\\Phi_t$ and determine its determinant for arbitrary $t\\in\\mathbb{R}$. Your final answer must be the value of $\\det D\\Phi_t$ as a single closed-form expression. No rounding is required. Do not include any physical units.",
            "solution": "The problem is valid as it is scientifically grounded in Hamiltonian mechanics, well-posed, and objective. All definitions and conditions are provided, allowing for a unique and meaningful solution. We will proceed by first deriving Hamilton's equations of motion from the fundamental definition relating the Hamiltonian vector field, the symplectic form, and the Hamiltonian function. Then, we will solve these equations to find the explicit flow map. Finally, we will compute the Jacobian of this flow and its determinant.\n\nThe phase space is $\\mathbb{R}^{2n}$ with canonical coordinates $(q_1, \\dots, q_n, p_1, \\dots, p_n)$.\nThe Hamiltonian is given by\n$$\nH(q,p) = \\frac{1}{2}\\sum_{i=1}^{n}\\left(p_i^{2}+\\omega_i^{2} q_i^{2}\\right)\n$$\nwhere each $\\omega_i$ is a positive constant. The canonical symplectic two-form is $\\omega = \\sum_{i=1}^{n} dq_i \\wedge dp_i$.\n\nFirst, we derive the equations of motion. We start by computing the exterior derivative of the Hamiltonian, $dH$:\n$$\ndH = \\sum_{i=1}^{n} \\left( \\frac{\\partial H}{\\partial q_i} dq_i + \\frac{\\partial H}{\\partial p_i} dp_i \\right)\n$$\nThe partial derivatives are:\n$$\n\\frac{\\partial H}{\\partial q_i} = \\frac{1}{2} (2 \\omega_i^2 q_i) = \\omega_i^2 q_i\n$$\n$$\n\\frac{\\partial H}{\\partial p_i} = \\frac{1}{2} (2 p_i) = p_i\n$$\nSubstituting these into the expression for $dH$ gives:\n$$\ndH = \\sum_{i=1}^{n} \\left( \\omega_i^2 q_i dq_i + p_i dp_i \\right)\n$$\nNext, we consider the Hamiltonian vector field $X_H$. The time evolution of the system is described by the integral curves of $X_H$, so we can write it in terms of the time derivatives of the coordinates:\n$$\nX_H = \\sum_{j=1}^{n} \\left( \\dot{q}_j \\frac{\\partial}{\\partial q_j} + \\dot{p}_j \\frac{\\partial}{\\partial p_j} \\right)\n$$\nThe definition of the Hamiltonian vector field is given by the relation $i_{X_H}\\omega = dH$, where $i_{X_H}$ is the interior product with respect to $X_H$. We compute the left-hand side:\n$$\ni_{X_H}\\omega = i_{X_H} \\left( \\sum_{k=1}^{n} dq_k \\wedge dp_k \\right) = \\sum_{j=1}^{n} \\sum_{k=1}^{n} \\left( \\dot{q}_j i_{\\frac{\\partial}{\\partial q_j}}(dq_k \\wedge dp_k) + \\dot{p}_j i_{\\frac{\\partial}{\\partial p_j}}(dq_k \\wedge dp_k) \\right)\n$$\nUsing the properties of the interior product, $i_V(A \\wedge B) = (i_V A) \\wedge B - A \\wedge (i_V B)$, and the fact that for basis vectors and basis one-forms $i_{\\frac{\\partial}{\\partial x^a}}dx^b = \\delta_a^b$, we have:\n$$\ni_{\\frac{\\partial}{\\partial q_j}}(dq_k \\wedge dp_k) = \\delta_{jk} dp_k\n$$\n$$\ni_{\\frac{\\partial}{\\partial p_j}}(dq_k \\wedge dp_k) = - \\delta_{jk} dq_k\n$$\nSubstituting these into the expression for $i_{X_H}\\omega$:\n$$\ni_{X_H}\\omega = \\sum_{j=1}^{n} \\sum_{k=1}^{n} \\left( \\dot{q}_j \\delta_{jk} dp_k - \\dot{p}_j \\delta_{jk} dq_k \\right) = \\sum_{j=1}^{n} \\left( \\dot{q}_j dp_j - \\dot{p}_j dq_j \\right)\n$$\nNow, we equate the two expressions for $i_{X_H}\\omega$ and $dH$:\n$$\n\\sum_{i=1}^{n} \\left( \\dot{q}_i dp_i - \\dot{p}_i dq_i \\right) = \\sum_{i=1}^{n} \\left( p_i dp_i + \\omega_i^2 q_i dq_i \\right)\n$$\nBy comparing the coefficients of the basis one-forms $dq_i$ and $dp_i$ for each $i \\in \\{1, \\dots, n\\}$, we obtain Hamilton's equations:\n$$\n\\dot{q}_i = p_i \\quad (\\text{from the coefficient of } dp_i)\n$$\n$$\n-\\dot{p}_i = \\omega_i^2 q_i \\implies \\dot{p}_i = -\\omega_i^2 q_i \\quad (\\text{from the coefficient of } dq_i)\n$$\nThis is the system of ordinary differential equations (ODEs) describing the motion. The system decouples into $n$ independent pairs of equations, one for each degree of freedom $i$.\n\nSecond, we solve this system of ODEs to find the Hamiltonian flow $\\Phi_t$. For each $i$, we have:\n$$\n\\ddot{q}_i = \\dot{p}_i = -\\omega_i^2 q_i \\implies \\ddot{q}_i + \\omega_i^2 q_i = 0\n$$\nThis is the equation for a simple harmonic oscillator. The general solution is:\n$$\nq_i(t) = A_i \\cos(\\omega_i t) + B_i \\sin(\\omega_i t)\n$$\nwhere $A_i$ and $B_i$ are constants determined by the initial conditions $(q_i(0), p_i(0))$. We denote the initial conditions as $(q_{i0}, p_{i0})$.\nAt $t=0$, we have $q_i(0) = q_{i0}$, so $A_i = q_{i0}$.\nThe momentum is $p_i(t) = \\dot{q}_i(t) = -A_i \\omega_i \\sin(\\omega_i t) + B_i \\omega_i \\cos(\\omega_i t)$.\nAt $t=0$, we have $p_i(0) = p_{i0}$, so $p_{i0} = B_i \\omega_i$, which gives $B_i = \\frac{p_{i0}}{\\omega_i}$.\nSubstituting $A_i$ and $B_i$ back, we get the explicit solution for the trajectory starting at $(q_0, p_0)$:\n$$\nq_i(t) = q_{i0} \\cos(\\omega_i t) + \\frac{p_{i0}}{\\omega_i} \\sin(\\omega_i t)\n$$\n$$\np_i(t) = -q_{i0} \\omega_i \\sin(\\omega_i t) + p_{i0} \\cos(\\omega_i t)\n$$\nThe Hamiltonian flow $\\Phi_t: \\mathbb{R}^{2n} \\to \\mathbb{R}^{2n}$ is the map that takes the initial state to the state at time $t$. Let $z = (q_1, \\dots, q_n, p_1, \\dots, p_n)$ be a point in the phase space. Then $\\Phi_t(z_0) = z(t)$, where $z_0 = z(0)$.\n\nThird, we compute the Jacobian matrix of the flow, $D\\Phi_t$. This is a $2n \\times 2n$ matrix whose entries are the partial derivatives of the final coordinates with respect to the initial coordinates. The coordinates are ordered as $(q_1, \\dots, q_n, p_1, \\dots, p_n)$.\nThe equations for $(q_i(t), p_i(t))$ only depend on $(q_{i0}, p_{i0})$. This means that derivatives like $\\frac{\\partial q_i(t)}{\\partial q_{j0}}$ for $i \\neq j$ are zero. Consequently, the Jacobian matrix $D\\Phi_t$ is block-diagonal. If we order the coordinates as $(q_1, p_1, q_2, p_2, \\ldots, q_n, p_n)$, the Jacobian matrix has the form:\n$$\nD\\Phi_t = \\begin{pmatrix} J_1 & 0 & \\dots & 0 \\\\ 0 & J_2 & \\dots & 0 \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ 0 & 0 & \\dots & J_n \\end{pmatrix}\n$$\nwhere each $J_i$ is a $2 \\times 2$ Jacobian matrix for the $i$-th subsystem, given by:\n$$\nJ_i = \\begin{pmatrix} \\frac{\\partial q_i(t)}{\\partial q_{i0}} & \\frac{\\partial q_i(t)}{\\partial p_{i0}} \\\\ \\frac{\\partial p_i(t)}{\\partial q_{i0}} & \\frac{\\partial p_i(t)}{\\partial p_{i0}} \\end{pmatrix}\n$$\nWe compute these partial derivatives from the solution equations:\n$$\n\\frac{\\partial q_i(t)}{\\partial q_{i0}} = \\cos(\\omega_i t)\n$$\n$$\n\\frac{\\partial q_i(t)}{\\partial p_{i0}} = \\frac{1}{\\omega_i} \\sin(\\omega_i t)\n$$\n$$\n\\frac{\\partial p_i(t)}{\\partial q_{i0}} = -\\omega_i \\sin(\\omega_i t)\n$$\n$$\n\\frac{\\partial p_i(t)}{\\partial p_{i0}} = \\cos(\\omega_i t)\n$$\nSo the block $J_i$ is:\n$$\nJ_i = \\begin{pmatrix} \\cos(\\omega_i t) & \\frac{1}{\\omega_i} \\sin(\\omega_i t) \\\\ -\\omega_i \\sin(\\omega_i t) & \\cos(\\omega_i t) \\end{pmatrix}\n$$\nFourth, we determine the determinant of the full Jacobian, $\\det D\\Phi_t$. Since $D\\Phi_t$ is block-diagonal, its determinant is the product of the determinants of its diagonal blocks:\n$$\n\\det D\\Phi_t = \\prod_{i=1}^{n} \\det J_i\n$$\nWe compute the determinant of a single block $J_i$:\n$$\n\\det J_i = (\\cos(\\omega_i t))(\\cos(\\omega_i t)) - \\left(\\frac{1}{\\omega_i} \\sin(\\omega_i t)\\right)(-\\omega_i \\sin(\\omega_i t))\n$$\n$$\n\\det J_i = \\cos^2(\\omega_i t) + \\sin^2(\\omega_i t) = 1\n$$\nThe determinant of each block $J_i$ is equal to $1$ for all $t \\in \\mathbb{R}$.\nTherefore, the determinant of the full Jacobian matrix is:\n$$\n\\det D\\Phi_t = \\prod_{i=1}^{n} 1 = 1\n$$\nThis result is an explicit verification of Liouville's theorem on volume preservation for this specific Hamiltonian system, which states that Hamiltonian flows preserve the phase space volume element, implying the Jacobian determinant of the flow map is unity.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "In the world of numerical simulation, Liouville's theorem inspires the design of geometric integrators, but it's crucial to distinguish volume preservation from the stronger condition of symplecticity. This problem explores a numerical map that is volume-preserving but not necessarily symplectic, challenging you to find the condition under which it respects the full Hamiltonian structure . Understanding this distinction is key to appreciating why symplectic integrators are essential for the stable long-term simulation of Hamiltonian systems.",
            "id": "3754652",
            "problem": "Consider a Hamiltonian system with two degrees of freedom on phase space $\\mathbb{R}^{4}$ with canonical coordinates $(q_{1},q_{2},p_{1},p_{2})$ and canonical symplectic form $\\omega = dq_{1} \\wedge dp_{1} + dq_{2} \\wedge dp_{2}$. Let the Hamiltonian be $H(q,p) = \\frac{1}{2}\\left(p_{1}^{2} + p_{2}^{2}\\right) + \\frac{1}{2}\\left(\\Omega_{1}^{2} q_{1}^{2} + \\Omega_{2}^{2} q_{2}^{2}\\right)$, where $\\Omega_{1}$ and $\\Omega_{2}$ are positive constants. Define the one-step numerical method (a discrete-time map) $\\Phi_{h,\\alpha} : \\mathbb{R}^{4} \\to \\mathbb{R}^{4}$ by\n$$\n\\Phi_{h,\\alpha}(q_{1},q_{2},p_{1},p_{2}) = \\left(q_{1} + h\\,p_{1},\\; q_{2} + h\\,p_{2},\\; p_{1},\\; p_{2} + \\alpha\\, q_{1}\\right),\n$$\nwhere $h > 0$ is the time step and $\\alpha \\in \\mathbb{R}$ is a fixed parameter.\n\nStarting from the fundamental definitions that (i) a map is symplectic if and only if its tangent map preserves the canonical symplectic form, equivalently $D\\Phi^{\\top} J\\, D\\Phi = J$ where $J = \\begin{pmatrix} 0 & I \\\\ -I & 0 \\end{pmatrix}$ with $I$ the $2 \\times 2$ identity matrix, and (ii) Liouville's theorem states Hamiltonian flows preserve the Liouville volume form $\\Omega = \\omega \\wedge \\omega$ (so their Jacobian determinant equals one), perform the following:\n\n1. Compute the Jacobian matrix $D\\Phi_{h,\\alpha}$ of the method $\\Phi_{h,\\alpha}$ and its determinant. Conclude whether the method is volume preserving for all $h$ and $\\alpha$.\n\n2. Using the symplecticity condition $D\\Phi_{h,\\alpha}^{\\top} J\\, D\\Phi_{h,\\alpha} = J$, determine the necessary and sufficient condition on $\\alpha$ (in terms of $h$ and constants if any) for which $\\Phi_{h,\\alpha}$ is symplectic.\n\n3. Using first principles of geometric mechanics, explain why preserving volume (i.e., $\\det(D\\Phi_{h,\\alpha}) = 1$) alone does not guarantee correct long-term Hamiltonian structure. Your explanation should reference why non-symplectic volume-preserving methods generally fail to admit a modified Hamiltonian in the sense of Backward Error Analysis (BEA), thereby allowing spurious long-term drifts in invariants even though phase-space volume is preserved.\n\nProvide as your final reported answer the unique value of the parameter $\\alpha$ that makes $\\Phi_{h,\\alpha}$ symplectic. No rounding is required. No units are required.",
            "solution": "The problem asks for an analysis of a numerical method $\\Phi_{h,\\alpha}$ for a Hamiltonian system. The analysis involves checking for volume preservation and symplecticity, and explaining the different implications of these two properties. The state vector for the system is $z = (q_{1}, q_{2}, p_{1}, p_{2})^{\\top} \\in \\mathbb{R}^{4}$.\n\nThe numerical method is given by the map $\\Phi_{h,\\alpha}: \\mathbb{R}^{4} \\to \\mathbb{R}^{4}$, defined as:\n$$\n\\Phi_{h,\\alpha}(q_{1}, q_{2}, p_{1}, p_{2}) = (q_{1} + h p_{1}, q_{2} + h p_{2}, p_{1}, p_{2} + \\alpha q_{1})\n$$\nwhere $h > 0$ is the time step and $\\alpha \\in \\mathbb{R}$ is a parameter.\n\nLet's denote the components of the map as $z' = \\Phi_{h,\\alpha}(z)$:\n$q_{1}' = q_{1} + h p_{1}$\n$q_{2}' = q_{2} + h p_{2}$\n$p_{1}' = p_{1}$\n$p_{2}' = p_{2} + \\alpha q_{1}$\n\n**1. Jacobian Matrix and Volume Preservation**\n\nThe first task is to compute the Jacobian matrix of the map, $D\\Phi_{h,\\alpha}$, and its determinant. A map is volume-preserving if the determinant of its Jacobian is equal to $1$.\n\nThe Jacobian matrix is $D\\Phi_{h,\\alpha} = \\frac{\\partial z'}{\\partial z}$. Its components are the partial derivatives of the output coordinates with respect to the input coordinates.\nThe coordinates are ordered as $(q_{1}, q_{2}, p_{1}, p_{2})$.\n\nThe partial derivatives are:\n$\\frac{\\partial q_{1}'}{\\partial q_{1}} = 1$, $\\frac{\\partial q_{1}'}{\\partial q_{2}} = 0$, $\\frac{\\partial q_{1}'}{\\partial p_{1}} = h$, $\\frac{\\partial q_{1}'}{\\partial p_{2}} = 0$\n$\\frac{\\partial q_{2}'}{\\partial q_{1}} = 0$, $\\frac{\\partial q_{2}'}{\\partial q_{2}} = 1$, $\\frac{\\partial q_{2}'}{\\partial p_{1}} = 0$, $\\frac{\\partial q_{2}'}{\\partial p_{2}} = h$\n$\\frac{\\partial p_{1}'}{\\partial q_{1}} = 0$, $\\frac{\\partial p_{1}'}{\\partial q_{2}} = 0$, $\\frac{\\partial p_{1}'}{\\partial p_{1}} = 1$, $\\frac{\\partial p_{1}'}{\\partial p_{2}} = 0$\n$\\frac{\\partial p_{2}'}{\\partial q_{1}} = \\alpha$, $\\frac{\\partial p_{2}'}{\\partial q_{2}} = 0$, $\\frac{\\partial p_{2}'}{\\partial p_{1}} = 0$, $\\frac{\\partial p_{2}'}{\\partial p_{2}} = 1$\n\nAssembling these into a matrix, we get the Jacobian:\n$$\nD\\Phi_{h,\\alpha} = \\begin{pmatrix}\n1 & 0 & h & 0 \\\\\n0 & 1 & 0 & h \\\\\n0 & 0 & 1 & 0 \\\\\n\\alpha & 0 & 0 & 1\n\\end{pmatrix}\n$$\nTo find the determinant, we can use cofactor expansion. Expanding along the third row, which has mostly zeros, simplifies the calculation:\n$$\n\\det(D\\Phi_{h,\\alpha}) = (-1)^{3+3} \\cdot 1 \\cdot \\det \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & h \\\\\n\\alpha & 0 & 1\n\\end{pmatrix}\n$$\nNow, we compute the determinant of the $3 \\times 3$ matrix, for example by expanding along the first row:\n$$\n\\det \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & h \\\\\n\\alpha & 0 & 1\n\\end{pmatrix} = (-1)^{1+1} \\cdot 1 \\cdot \\det \\begin{pmatrix}\n1 & h \\\\\n0 & 1\n\\end{pmatrix} = 1 \\cdot (1 \\cdot 1 - h \\cdot 0) = 1\n$$\nThus, we have:\n$$\n\\det(D\\Phi_{h,\\alpha}) = 1\n$$\nThe determinant is $1$ for all values of $h > 0$ and $\\alpha \\in \\mathbb{R}$. Therefore, the method $\\Phi_{h,\\alpha}$ is volume-preserving for all $h$ and $\\alpha$.\n\n**2. Condition for Symplecticity**\n\nA map $\\Phi$ is symplectic if its Jacobian matrix $D\\Phi$ satisfies the condition $D\\Phi^{\\top} J D\\Phi = J$.\nThe canonical symplectic matrix $J$ for the coordinate ordering $(q_{1}, q_{2}, p_{1}, p_{2})$ is given by:\n$$\nJ = \\begin{pmatrix} 0 & I \\\\ -I & 0 \\end{pmatrix}_4 = \\begin{pmatrix}\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n-1 & 0 & 0 & 0 \\\\\n0 & -1 & 0 & 0\n\\end{pmatrix}\n$$\nwhere $I$ is the $2 \\times 2$ identity matrix. Let's denote $M = D\\Phi_{h,\\alpha}$. We need to compute $M^{\\top} J M$ and set it equal to $J$.\n\nThe transpose of $M$ is:\n$$\nM^{\\top} = \\begin{pmatrix}\n1 & 0 & 0 & \\alpha \\\\\n0 & 1 & 0 & 0 \\\\\nh & 0 & 1 & 0 \\\\\n0 & h & 0 & 1\n\\end{pmatrix}\n$$\nFirst, we compute the product $J M$:\n$$\nJ M = \\begin{pmatrix}\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n-1 & 0 & 0 & 0 \\\\\n0 & -1 & 0 & 0\n\\end{pmatrix} \\begin{pmatrix}\n1 & 0 & h & 0 \\\\\n0 & 1 & 0 & h \\\\\n0 & 0 & 1 & 0 \\\\\n\\alpha & 0 & 0 & 1\n\\end{pmatrix} = \\begin{pmatrix}\n0 & 0 & 1 & 0 \\\\\n\\alpha & 0 & 0 & 1 \\\\\n-1 & 0 & -h & 0 \\\\\n0 & -1 & 0 & -h\n\\end{pmatrix}\n$$\nNext, we pre-multiply by $M^{\\top}$:\n$$\nM^{\\top}JM = \\begin{pmatrix}\n1 & 0 & 0 & \\alpha \\\\\n0 & 1 & 0 & 0 \\\\\nh & 0 & 1 & 0 \\\\\n0 & h & 0 & 1\n\\end{pmatrix} \\begin{pmatrix}\n0 & 0 & 1 & 0 \\\\\n\\alpha & 0 & 0 & 1 \\\\\n-1 & 0 & -h & 0 \\\\\n0 & -1 & 0 & -h\n\\end{pmatrix} = \\begin{pmatrix}\n0 & -\\alpha & 1 & -h\\alpha \\\\\n\\alpha & 0 & 0 & 1 \\\\\n-1 & 0 & 0 & 0 \\\\\nh\\alpha & -1 & 0 & 0\n\\end{pmatrix}\n$$\nFor the map to be symplectic, this resulting matrix must be equal to $J$:\n$$\n\\begin{pmatrix}\n0 & -\\alpha & 1 & -h\\alpha \\\\\n\\alpha & 0 & 0 & 1 \\\\\n-1 & 0 & 0 & 0 \\\\\nh\\alpha & -1 & 0 & 0\n\\end{pmatrix} = \\begin{pmatrix}\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n-1 & 0 & 0 & 0 \\\\\n0 & -1 & 0 & 0\n\\end{pmatrix}\n$$\nComparing the matrices entry by entry, we obtain several conditions on $\\alpha$:\n\\begin{itemize}\n    \\item From element $(1,2)$: $-\\alpha = 0 \\implies \\alpha = 0$.\n    \\item From element $(1,4)$: $-h\\alpha = 0$. Since $h > 0$, this implies $\\alpha = 0$.\n    \\item From element $(2,1)$: $\\alpha = 0$.\n    \\item From element $(4,1)$: $h\\alpha = 0$. Since $h > 0$, this implies $\\alpha = 0$.\n\\end{itemize}\nAll other entries either match identically (e.g., $(1,1)$, $(1,3)$, etc.) or are consistent with the condition $\\alpha=0$. For instance, if $\\alpha=0$, the resulting matrix becomes identical to $J$.\nTherefore, the necessary and sufficient condition for the map $\\Phi_{h,\\alpha}$ to be symplectic is $\\alpha = 0$.\n\n**3. Volume Preservation versus Symplecticity**\n\nThe third part asks for an explanation of why volume preservation ($\\det(D\\Phi_{h,\\alpha}) = 1$) is not sufficient for a numerical method to correctly capture the long-term behavior of a Hamiltonian system.\n\nA Hamiltonian flow $\\phi_t$ is symplectic, meaning it preserves the symplectic $2$-form $\\omega$. This is expressed as $\\phi_t^*\\omega = \\omega$. A consequence of this property is that the flow also preserves the Liouville volume form, which in this $2n=4$ dimensional case is $\\Omega = \\frac{1}{2}\\omega \\wedge \\omega = dq_{1} \\wedge dp_{1} \\wedge dq_{2} \\wedge dp_{2}$. Preservation of the volume form is equivalent to the Jacobian determinant of the flow map being equal to $1$. Thus, any symplectic map is automatically volume-preserving.\n\nThe converse is not true, as demonstrated by the map $\\Phi_{h,\\alpha}$ for any $\\alpha \\neq 0$. This map is volume-preserving but not symplectic.\n\nThe crucial property of symplectic maps for numerical integration is rooted in backward error analysis (BEA). For a symplectic integrator $\\Phi_h$, there exists a modified Hamiltonian $\\tilde{H}$, typically expressed as an asymptotic series in the step size $h$:\n$$ \\tilde{H}(q,p) = H(q,p) + h H_1(q,p) + h^2 H_2(q,p) + \\dots $$\nThe key result is that the numerical method $\\Phi_h$ is, up to exponentially small terms in $h$, the exact time-$h$ flow map of the modified Hamiltonian system governed by $\\tilde{H}$. This means the numerical solution produced by a symplectic integrator lies on the exact trajectory of a nearby Hamiltonian system.\n\nThis has profound consequences for long-term integration. Any quantity that is a first integral of the modified Hamiltonian $\\tilde{H}$ will be exactly conserved by the numerical method. In particular, the modified energy $\\tilde{H}$ is conserved. Since $\\tilde{H}$ is a small perturbation of the original Hamiltonian $H$, the original energy $H$ will exhibit bounded oscillations around its initial value, but it will not exhibit a systematic drift over long integration times. This near-conservation of energy is a hallmark of symplectic integrators and is essential for stable, long-term simulations of Hamiltonian systems (e.g., in celestial mechanics or molecular dynamics).\n\nFor a non-symplectic method, even if it is volume-preserving, a modified Hamiltonian generally does not exist. The numerical map does not correspond to the flow of any Hamiltonian system. Consequently, there is no conserved quantity analogous to $\\tilde{H}$ that constrains the dynamics. While the total phase-space volume of an ensemble of points is preserved, the trajectory of a single point is not confined to a specific energy surface (or a slightly perturbed one). This typically leads to a spurious, secular drift in quantities like energy that should be conserved. The error in energy can grow unboundedly, for instance, proportionally to the integration time or its square root, leading to qualitatively incorrect physical behavior in long-term simulations.\n\nIn summary, preserving the symplectic form $\\omega$ (symplecticity) is a much stronger condition than preserving the volume form $\\Omega$ (volume preservation). Symplecticity ensures the preservation of the geometric structure of Hamiltonian mechanics, which includes not just volume but also the canonical Poisson bracket algebra. This structural preservation is what guarantees the existence of a modified Hamiltonian and the excellent long-term fidelity of the numerical solution. Volume preservation alone does not provide this guarantee.",
            "answer": "$$\n\\boxed{0}\n$$"
        }
    ]
}