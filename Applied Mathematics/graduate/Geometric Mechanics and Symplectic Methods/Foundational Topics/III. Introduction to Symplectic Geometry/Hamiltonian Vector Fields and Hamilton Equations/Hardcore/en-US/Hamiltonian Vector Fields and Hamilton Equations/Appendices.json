{
    "hands_on_practices": [
        {
            "introduction": "The harmonic oscillator is a quintessential model in physics, and its analysis within the Hamiltonian framework is a foundational exercise. This practice guides you through the calculation of the action variable, $I$, a key component of the action-angle coordinate system. By connecting the geometry of a phase-space orbit—specifically, its enclosed area—to a conserved quantity, this exercise illustrates a powerful method for simplifying the description of periodic motion and revealing the system's fundamental frequency .",
            "id": "3745627",
            "problem": "Consider the $1$-dimensional harmonic oscillator with mass $m>0$ and angular frequency $\\omega>0$, whose Hamiltonian is $H(q,p)=\\dfrac{p^{2}}{2m}+\\dfrac{1}{2}m\\omega^{2}q^{2}$. For a fixed energy level $E>0$, the motion is periodic. Using only fundamental definitions from Hamiltonian mechanics, namely Hamilton's equations $\\dot{q}=\\dfrac{\\partial H}{\\partial p}$ and $\\dot{p}=-\\dfrac{\\partial H}{\\partial q}$, and the definition of the action variable for a system with $1$ degree of freedom,\n$$\nI=\\dfrac{1}{2\\pi}\\oint p\\,\\mathrm{d}q,\n$$\nwhere the integral is taken once around the closed orbit on the energy shell $H(q,p)=E$, compute $I$ as a function of $E$, $m$, and $\\omega$. Then, express the Hamiltonian purely as a function of $I$ and $\\omega$. Provide both results as a single row vector of two entries in the order $\\big(I(E,m,\\omega),\\,H(I,\\omega)\\big)$, and express your final answer as a closed-form analytic expression. Do not use any numerical approximations.",
            "solution": "The user has provided a problem statement that requires validation before a solution is attempted.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **System:** $1$-dimensional harmonic oscillator.\n- **Parameters:** Mass $m>0$, angular frequency $\\omega>0$.\n- **Hamiltonian:** $H(q,p)=\\dfrac{p^{2}}{2m}+\\dfrac{1}{2}m\\omega^{2}q^{2}$.\n- **Energy Level:** A fixed energy $E>0$.\n- **Equations of Motion:** Hamilton's equations, $\\dot{q}=\\dfrac{\\partial H}{\\partial p}$ and $\\dot{p}=-\\dfrac{\\partial H}{\\partial q}$.\n- **Definition:** The action variable is given by $I=\\dfrac{1}{2\\pi}\\oint p\\,\\mathrm{d}q$, where the integral is taken along the closed orbit corresponding to the energy $E$.\n- **Objective 1:** Compute $I$ as a function of $E$, $m$, and $\\omega$.\n- **Objective 2:** Express the Hamiltonian $H$ as a function of $I$ and $\\omega$.\n- **Output Format:** A row vector $(I(E,m,\\omega), H(I,\\omega))$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically and mathematically sound. It describes the simple harmonic oscillator, a fundamental model in physics, within the well-established framework of Hamiltonian mechanics. The Hamiltonian provided is the standard one for this system. The definition of the action variable is correct. All parameters ($m, \\omega, E$) are constrained to be positive, ensuring a physically meaningful, oscillatory system with a non-trivial closed orbit in phase space. The problem is self-contained, unambiguous, and well-posed, asking for a standard derivation in classical mechanics related to action-angle variables. It is free from any scientific inaccuracies, contradictions, or subjective elements.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be provided.\n\n### Solution\n\nThe starting point is the Hamiltonian for the $1$-dimensional harmonic oscillator, given as:\n$$\nH(q,p) = \\dfrac{p^{2}}{2m}+\\dfrac{1}{2}m\\omega^{2}q^{2}\n$$\nThe system's motion evolves according to Hamilton's equations, $\\dot{q}=\\dfrac{\\partial H}{\\partial p}$ and $\\dot{p}=-\\dfrac{\\partial H}{\\partial q}$. For a conservative system like this one, the Hamiltonian is a constant of motion, equal to the total energy $E$. The trajectories in phase space, parameterized by the canonical coordinates $(q,p)$, lie on level sets of the Hamiltonian. For a fixed energy $E>0$, the trajectory is a closed curve defined by the equation:\n$$\n\\dfrac{p^{2}}{2m}+\\dfrac{1}{2}m\\omega^{2}q^{2} = E\n$$\nThis is the equation of an ellipse centered at the origin of the $(q,p)$ phase plane. To determine its geometry, we can write it in the standard form $\\dfrac{x^2}{a^2} + \\dfrac{y^2}{b^2} = 1$:\n$$\n\\dfrac{q^2}{\\left(\\dfrac{2E}{m\\omega^{2}}\\right)} + \\dfrac{p^2}{2mE} = 1\n$$\nThis identifies the squares of the semi-axes of the ellipse. The semi-axis along the $q$-axis is $q_{\\text{max}} = \\sqrt{\\dfrac{2E}{m\\omega^2}}$, and the semi-axis along the $p$-axis is $p_{\\text{max}} = \\sqrt{2mE}$.\n\nThe first objective is to compute the action variable $I$, defined as:\n$$\nI = \\dfrac{1}{2\\pi}\\oint p\\,\\mathrm{d}q\n$$\nThe integral $\\oint p\\,\\mathrm{d}q$ represents the area enclosed by the closed orbit in phase space. For an elliptical path, this area is given by the formula $\\mathcal{A} = \\pi \\times (\\text{semi-axis in } q) \\times (\\text{semi-axis in } p)$.\nUsing the semi-axes identified above, the area is:\n$$\n\\mathcal{A} = \\oint p\\,\\mathrm{d}q = \\pi \\left( \\sqrt{\\dfrac{2E}{m\\omega^2}} \\right) \\left( \\sqrt{2mE} \\right)\n$$\nSimplifying this expression, we get:\n$$\n\\mathcal{A} = \\pi \\sqrt{\\left(\\dfrac{2E}{m\\omega^2}\\right)(2mE)} = \\pi \\sqrt{\\dfrac{4mE^2}{m\\omega^2}} = \\pi \\sqrt{\\dfrac{4E^2}{\\omega^2}}\n$$\nSince $E>0$ and $\\omega>0$, we can take the square root to find:\n$$\n\\mathcal{A} = \\pi \\dfrac{2E}{\\omega}\n$$\nNow, we substitute this area back into the definition of the action variable $I$:\n$$\nI = \\dfrac{1}{2\\pi} \\mathcal{A} = \\dfrac{1}{2\\pi} \\left( \\pi \\dfrac{2E}{\\omega} \\right)\n$$\nThis simplifies to the first required result, the action variable as a function of energy:\n$$\nI(E, \\omega) = \\dfrac{E}{\\omega}\n$$\nIt is noteworthy that the action variable depends on the energy $E$ and the frequency $\\omega$, but not on the mass $m$.\n\nThe second objective is to express the Hamiltonian $H$ as a function of the action variable $I$ and $\\omega$. From the relationship derived above, we can express the energy $E$ in terms of $I$ and $\\omega$:\n$$\nE = I \\omega\n$$\nSince the value of the Hamiltonian function $H(q,p)$ on any trajectory is the constant energy $E$ of that trajectory, we can express the Hamiltonian in terms of the new coordinate $I$. This is the essence of the transformation to action-angle coordinates. Thus, the Hamiltonian function, when expressed in terms of the action $I$, is:\n$$\nH(I, \\omega) = I\\omega\n$$\nThis result shows that in the action-angle coordinate system, the Hamiltonian for the harmonic oscillator depends linearly on the action variable, which implies that the frequency of motion, $\\dfrac{\\partial H}{\\partial I} = \\omega$, is constant and independent of the energy, a defining characteristic of the simple harmonic oscillator.\n\nThe two requested results are $I(E,m,\\omega) = \\dfrac{E}{\\omega}$ and $H(I,\\omega) = I\\omega$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{E}{\\omega}  I\\omega \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While many textbook examples like the harmonic oscillator exhibit stable, predictable motion for all time, not all Hamiltonian systems are so well-behaved. This exercise challenges you to move beyond ideal cases and explore the concept of incomplete flows. You will construct a smooth Hamiltonian on a simple phase space, $\\mathbb{R}^2$, whose trajectories can escape to infinity in a finite amount of time, a phenomenon known as finite-time blowup . This practice is crucial for understanding that the smoothness of a Hamiltonian does not, by itself, guarantee the long-term existence of solutions, a subtle but vital point in the study of dynamical systems.",
            "id": "3745613",
            "problem": "Consider $\\mathbb{R}^2$ with global coordinates $(q,p)$ and the canonical symplectic form $\\omega = dq \\wedge dp$. The Hamiltonian vector field $X_H$ associated to a smooth function $H:\\mathbb{R}^2 \\to \\mathbb{R}$ is defined by the equation $i_{X_H}\\omega = dH$, where $i_{X_H}$ denotes interior contraction and $dH$ is the differential of $H$. Hamilton's equations are the coordinate expressions of the integral curves of $X_H$.\n\nConstruct explicitly a smooth Hamiltonian $H(q,p)$ on $\\mathbb{R}^2$ such that the resulting Hamiltonian flow is incomplete in forward time because some trajectories reach $|q|=\\infty$ in finite time. Starting from the definition $i_{X_H}\\omega = dH$, derive the corresponding Hamilton's equations, solve them exactly for initial data $(q(0),p(0))=(q_0,p_0)$ with $q_0>0$, and determine the maximal forward time of existence $T_+(q_0,p_0)$ of this solution. Explain, using the definition of completeness for vector fields, why the flow fails to be complete.\n\nYour final answer must be the single closed-form expression for $T_+(q_0,p_0)$, with no units. No rounding is required.",
            "solution": "The user wants to construct a smooth Hamiltonian on $\\mathbb{R}^2$ whose flow is incomplete, with trajectories reaching $|q|=\\infty$ in finite time. We must derive and solve Hamilton's equations for this system and determine the maximal forward time of existence for a given initial condition.\n\nFirst, we validate the problem. The problem is set in the standard framework of Hamiltonian mechanics on a symplectic manifold. All terms used—symplectic form, Hamiltonian vector field, interior contraction, completeness of a flow—are standard and well-defined in differential geometry and mechanics. The task is to construct and analyze a specific example exhibiting a known phenomenon (finite-time escape), which is a well-posed mathematical problem. There are no scientific or logical contradictions. The problem is valid.\n\nWe proceed to construct the solution. Let the phase space be $\\mathbb{R}^2$ with global coordinates $(q,p)$. The canonical symplectic form is $\\omega = dq \\wedge dp$. We need to choose a smooth Hamiltonian function $H(q,p)$ such that some integral curves of its Hamiltonian vector field $X_H$ escape to infinity in finite time. A simple choice that induces rapid growth in the $q$ coordinate is $H(q,p) = q^2 p$. This function is a polynomial in $q$ and $p$, and is therefore smooth ($\\mathcal{C}^\\infty$) on all of $\\mathbb{R}^2$.\n\nNext, we derive Hamilton's equations from the fundamental definition $i_{X_H}\\omega = dH$.\nLet the Hamiltonian vector field be written in coordinates as $X_H = A(q,p)\\frac{\\partial}{\\partial q} + B(q,p)\\frac{\\partial}{\\partial p}$. The interior product of $X_H$ with $\\omega$ is:\n$$i_{X_H}\\omega = i_{A\\frac{\\partial}{\\partial q} + B\\frac{\\partial}{\\partial p}}(dq \\wedge dp)$$\n$$i_{X_H}\\omega = A \\cdot i_{\\frac{\\partial}{\\partial q}}(dq \\wedge dp) + B \\cdot i_{\\frac{\\partial}{\\partial p}}(dq \\wedge dp)$$\nUsing the property $i_V( \\alpha \\wedge \\beta) = (i_V \\alpha) \\wedge \\beta - \\alpha \\wedge (i_V \\beta)$, and knowing that $i_{\\frac{\\partial}{\\partial q}}dq=1$, $i_{\\frac{\\partial}{\\partial q}}dp=0$, $i_{\\frac{\\partial}{\\partial p}}dq=0$, $i_{\\frac{\\partial}{\\partial p}}dp=1$:\n$$i_{\\frac{\\partial}{\\partial q}}(dq \\wedge dp) = (i_{\\frac{\\partial}{\\partial q}} dq) \\wedge dp - dq \\wedge (i_{\\frac{\\partial}{\\partial q}} dp) = 1 \\wedge dp - dq \\wedge 0 = dp$$\n$$i_{\\frac{\\partial}{\\partial p}}(dq \\wedge dp) = (i_{\\frac{\\partial}{\\partial p}} dq) \\wedge dp - dq \\wedge (i_{\\frac{\\partial}{\\partial p}} dp) = 0 \\wedge dp - dq \\wedge 1 = -dq$$\nSubstituting these back, we get:\n$$i_{X_H}\\omega = A \\cdot dp + B \\cdot (-dq) = -B dq + A dp$$\nThe exterior derivative of the Hamiltonian $H$ is:\n$$dH = \\frac{\\partial H}{\\partial q} dq + \\frac{\\partial H}{\\partial p} dp$$\nEquating the two expressions, $i_{X_H}\\omega = dH$:\n$$-B dq + A dp = \\frac{\\partial H}{\\partial q} dq + \\frac{\\partial H}{\\partial p} dp$$\nBy comparing the coefficients of the basis 1-forms $dq$ and $dp$, we find the components of the vector field:\n$$A = \\frac{\\partial H}{\\partial p} \\quad \\text{and} \\quad -B = \\frac{\\partial H}{\\partial q} \\implies B = -\\frac{\\partial H}{\\partial q}$$\nAn integral curve $(q(t), p(t))$ of $X_H$ is a path whose velocity vector at each point is given by the vector field. In coordinates, this means $\\frac{d}{dt}(q(t),p(t)) = (\\dot{q}(t), \\dot{p}(t)) = (A(q,p), B(q,p))$. This yields Hamilton's equations:\n$$\\dot{q} = \\frac{\\partial H}{\\partial p} \\quad \\text{and} \\quad \\dot{p} = -\\frac{\\partial H}{\\partial q}$$\nFor our chosen Hamiltonian, $H(q,p) = q^2 p$, these equations become:\n$$\\dot{q} = \\frac{\\partial}{\\partial p}(q^2 p) = q^2$$\n$$\\dot{p} = -\\frac{\\partial}{\\partial q}(q^2 p) = -2qp$$\nNow, we solve this system of ordinary differential equations for the initial condition $(q(0),p(0))=(q_0,p_0)$, with the given constraint $q_0 > 0$.\nThe equation for $q$ is independent of $p$ and can be solved by separation of variables:\n$$\\frac{dq}{dt} = q^2 \\implies \\frac{dq}{q^2} = dt$$\nIntegrating from $t=0$ to a general time $t$:\n$$\\int_{q_0}^{q(t)} \\frac{1}{s^2} ds = \\int_0^t d\\tau$$\n$$\\left[-\\frac{1}{s}\\right]_{q_0}^{q(t)} = t$$\n$$-\\frac{1}{q(t)} + \\frac{1}{q_0} = t$$\nSolving for $q(t)$:\n$$\\frac{1}{q(t)} = \\frac{1}{q_0} - t = \\frac{1 - q_0 t}{q_0}$$\n$$q(t) = \\frac{q_0}{1 - q_0 t}$$\nThis solution for $q(t)$ is defined as long as the denominator is non-zero. Since $q_0 > 0$, the denominator becomes zero at $t = 1/q_0$. As $t \\to (1/q_0)^-$, the denominator approaches $0$ from the positive side, so $q(t) \\to +\\infty$.\n\nNext, we solve for $p(t)$ by substituting the solution for $q(t)$ into the second equation:\n$$\\frac{dp}{dt} = -2q(t)p = -2\\left(\\frac{q_0}{1 - q_0 t}\\right)p$$\nThis is a linear, separable equation for $p(t)$:\n$$\\frac{dp}{p} = -2q_0 \\frac{dt}{1 - q_0 t}$$\nIntegrating from $t=0$ to $t$:\n$$\\int_{p_0}^{p(t)} \\frac{1}{s} ds = -2q_0 \\int_0^t \\frac{1}{1-q_0\\tau} d\\tau$$\nProvided $p_0 \\neq 0$:\n$$\\ln|p(t)| - \\ln|p_0| = \\left[ 2\\ln(1-q_0\\tau) \\right]_0^t$$\n$$\\ln\\left|\\frac{p(t)}{p_0}\\right| = 2\\ln(1-q_0 t) - 2\\ln(1) = \\ln((1-q_0 t)^2)$$\nThis implies $|p(t)| = |p_0|(1-q_0 t)^2$. For $t  1/q_0$, $(1-q_0 t)^2 > 0$, so $p(t)$ does not change sign. Thus we can write:\n$$p(t) = p_0 (1-q_0 t)^2$$\nIf $p_0=0$, the equation $\\dot{p}=0$ yields $p(t)=0$, which is consistent with the derived formula.\n\nThe exact solution for the initial data $(q_0, p_0)$ with $q_0>0$ is:\n$$q(t) = \\frac{q_0}{1 - q_0 t}, \\quad p(t) = p_0 (1 - q_0 t)^2$$\nThis solution is defined on the maximal time interval containing $t=0$ where the expressions are valid, which is $(-\\infty, 1/q_0)$.\nThe maximal forward time of existence, denoted $T_+(q_0, p_0)$, is the supremum of the times $t>0$ for which the solution starting at $(q_0, p_0)$ exists. From our analysis, the solution blows up as $t$ approaches $1/q_0$ from below. Therefore, the maximal forward time of existence is:\n$$T_+(q_0, p_0) = \\frac{1}{q_0}$$\nNote that this time depends only on $q_0$ and not on $p_0$.\n\nFinally, we explain why the flow is incomplete. A vector field on a manifold is defined as complete if its flow is defined for all time, which means that every maximal integral curve is defined on all of $\\mathbb{R}$. The Hamiltonian flow is the flow of the Hamiltonian vector field $X_H$. We have explicitly found initial conditions, e.g., any $(q_0, p_0)$ with $q_0 > 0$, for which the maximal integral curve $\\gamma(t)=(q(t),p(t))$ is defined only on the interval $(-\\infty, 1/q_0)$. Since this interval is a proper subset of $\\mathbb{R}$, the integral curve is not defined for all time. The existence of at least one such trajectory is sufficient to prove that the vector field $X_H = q^2 \\frac{\\partial}{\\partial q} - 2qp \\frac{\\partial}{\\partial p}$ is not complete. Its flow is therefore incomplete, and specifically, it is not forward-complete for any trajectory with $q(0) > 0$.",
            "answer": "$$\n\\boxed{\\frac{1}{q_0}}\n$$"
        },
        {
            "introduction": "Most physical systems are not perfectly integrable but can be modeled as small perturbations of integrable ones. This practice introduces you to canonical perturbation theory, a powerful set of tools for analyzing such \"near-integrable\" systems. You will use the Lie transform method, a sophisticated and elegant technique, to find a near-identity canonical transformation that systematically simplifies a perturbed Hamiltonian . The goal is to \"average out\" the fast, non-resonant oscillations to reveal the essential long-term dynamics, a procedure fundamental to advanced topics in celestial mechanics, accelerator physics, and plasma dynamics.",
            "id": "3745632",
            "problem": "Consider the canonical phase space $\\mathbb{T}^{2} \\times \\mathbb{R}^{2}$ with angle-action coordinates $(\\theta_{1},\\theta_{2},I_{1},I_{2})$ and the canonical symplectic form $\\omega_{\\text{can}}=\\mathrm{d}\\theta_{1}\\wedge \\mathrm{d}I_{1}+\\mathrm{d}\\theta_{2}\\wedge \\mathrm{d}I_{2}$. Let the Hamiltonian be\n$H_{\\varepsilon}(\\theta,I)=H_{0}(I)+\\varepsilon H_{1}(\\theta)$,\nwith unperturbed part $H_{0}(I)=\\omega_{1} I_{1}+\\omega_{2} I_{2}$, where $\\omega_{1}=1$ and $\\omega_{2}=2$, and perturbation\n$H_{1}(\\theta)=a\\cos(\\theta_{1})+b\\sin(2\\theta_{1}-\\theta_{2})+c\\cos(3\\theta_{2})$,\nfor real parameters $a$, $b$, $c$. Using only the fundamental definitions of Hamiltonian vector fields (defined by $\\iota_{X_{F}}\\omega_{\\text{can}}=\\mathrm{d}F$) and the Lie derivative acting on functions (so that the flow generated by $X_{G}$ effects a near-identity canonical transformation), construct the first-order Lie-transform of $H_{\\varepsilon}$ under the time-$\\varepsilon$ flow of $X_{G}$ and determine a generator $G(\\theta,I)$ that removes all nonresonant Fourier modes of $H_{1}$ at order $\\varepsilon$ while leaving any resonant modes untouched. Here “resonant” refers to integer wavevectors $k=(k_{1},k_{2})\\in\\mathbb{Z}^{2}$ satisfying $k\\cdot\\omega=0$ with $\\omega=(\\omega_{1},\\omega_{2})$.\n\nYour task: Derive the first-order condition that $G$ must satisfy in order to eliminate the nonresonant part of $H_{1}$, identify which Fourier modes of $H_{1}$ are nonresonant for the given $\\omega$, and compute an explicit closed-form expression for such a generator $G(\\theta)$ that achieves this elimination at order $\\varepsilon$. Provide your final answer as the single explicit expression for $G(\\theta_{1},\\theta_{2})$.",
            "solution": "The problem is first validated against the specified criteria.\n\n### Step 1: Extract Givens\n-   Phase space: $\\mathbb{T}^{2} \\times \\mathbb{R}^{2}$\n-   Coordinates: Angle-action coordinates $(\\theta_{1},\\theta_{2},I_{1},I_{2})$\n-   Symplectic form: $\\omega_{\\text{can}}=\\mathrm{d}\\theta_{1}\\wedge \\mathrm{d}I_{1}+\\mathrm{d}\\theta_{2}\\wedge \\mathrm{d}I_{2}$\n-   Hamiltonian: $H_{\\varepsilon}(\\theta,I)=H_{0}(I)+\\varepsilon H_{1}(\\theta)$\n-   Unperturbed Hamiltonian: $H_{0}(I)=\\omega_{1} I_{1}+\\omega_{2} I_{2}$, with $\\omega_{1}=1$ and $\\omega_{2}=2$.\n-   Perturbation: $H_{1}(\\theta)=a\\cos(\\theta_{1})+b\\sin(2\\theta_{1}-\\theta_{2})+c\\cos(3\\theta_{2})$, for real parameters $a$, $b$, $c$.\n-   Definition of resonance: An integer wavevector $k=(k_{1},k_{2})\\in\\mathbb{Z}^{2}$ corresponds to a resonant mode if $k\\cdot\\omega=k_{1}\\omega_{1}+k_{2}\\omega_{2}=0$, where $\\omega=(\\omega_{1},\\omega_{2})=(1,2)$.\n-   Task: Construct the first-order Lie-transform of $H_{\\varepsilon}$ using the time-$\\varepsilon$ flow of a Hamiltonian vector field $X_{G}$ to determine a generator $G(\\theta)$ that removes all nonresonant Fourier modes of $H_{1}$ at order $\\varepsilon$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is set within the standard framework of Hamiltonian mechanics, specifically canonical perturbation theory using Lie transforms. All concepts, such as phase space, symplectic form, Hamilton's equations, and Lie series, are fundamental to geometric mechanics. The problem is scientifically sound.\n-   **Well-Posed**: The problem is well-posed. It provides a clear objective (find a specific generator $G$) and all necessary information (Hamiltonian, symplectic form, resonance condition) to uniquely determine the required function $G$, up to an arbitrary constant which does not affect the dynamics.\n-   **Objective**: The language is precise and mathematical, free of ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A complete, reasoned solution will be provided.\n\nThe goal is to find a generating function $G(\\theta,I)$ for a near-identity canonical transformation that simplifies the Hamiltonian $H_{\\varepsilon}$ at first order in $\\varepsilon$. The transformation is given by the time-$\\varepsilon$ flow, $\\Phi_{\\varepsilon}^{G}$, generated by the Hamiltonian vector field $X_{G}$. The transformed Hamiltonian, $K$, is given by the pullback $K = (\\Phi_{\\varepsilon}^{G})^{*}H_{\\varepsilon} = H_{\\varepsilon} \\circ \\Phi_{\\varepsilon}^{G}$.\n\nWe expand $K$ in powers of $\\varepsilon$. The flow map can be expanded as a Taylor series in $\\varepsilon$:\n$$\n\\Phi_{\\varepsilon}^{G}(z) = z + \\varepsilon X_{G}(z) + O(\\varepsilon^{2})\n$$\nwhere $z=(\\theta,I)$ are the phase space coordinates. The Hamiltonian is $H_{\\varepsilon} = H_{0} + \\varepsilon H_{1}$. Substituting these into the expression for $K$:\n$$\nK(z) = (H_{0} + \\varepsilon H_{1}) \\circ (z + \\varepsilon X_{G}(z))\n$$\nExpanding this expression for small $\\varepsilon$:\n$$\nK(z) \\approx (H_{0}(z) + \\varepsilon \\mathrm{d}H_{0}|_{z}(X_{G}(z))) + \\varepsilon H_{1}(z) + O(\\varepsilon^{2})\n$$\nThe term $\\mathrm{d}H_{0}(X_{G})$ is the Lie derivative of $H_{0}$ along the vector field $X_{G}$, which is equivalent to the Poisson bracket $\\{H_{0}, G\\}$. Thus, the expansion becomes:\n$$\nK = H_{0} + \\varepsilon(H_{1} + \\{H_{0}, G\\}) + O(\\varepsilon^{2})\n$$\nThis equation is known as the first-order homological equation. We denote the transformed Hamiltonian by $K=K_{0}+\\varepsilon K_{1}+\\dots$. Comparing terms of order $\\varepsilon$, we have $K_{0} = H_{0}$ and\n$$\nK_{1} = H_{1} + \\{H_{0}, G\\}\n$$\nThe problem requires us to choose the generator $G$ to eliminate all nonresonant Fourier modes from $H_{1}$, leaving only the resonant part in $K_{1}$. Let $H_{1} = H_{1,\\text{res}} + H_{1,\\text{nonres}}$, where $H_{1,\\text{res}}$ contains the resonant modes and $H_{1,\\text{nonres}}$ contains the nonresonant modes. We want to set $K_{1} = H_{1,\\text{res}}$. Substituting this into the homological equation gives:\n$$\nH_{1,\\text{res}} = (H_{1,\\text{res}} + H_{1,\\text{nonres}}) + \\{H_{0}, G\\}\n$$\nThis implies that the generator $G$ must satisfy the condition:\n$$\n\\{H_{0}, G\\} = -H_{1,\\text{nonres}}\n$$\nTo proceed, we must compute the Poisson bracket. With $\\omega_{\\text{can}}=\\mathrm{d}\\theta_{1}\\wedge \\mathrm{d}I_{1}+\\mathrm{d}\\theta_{2}\\wedge \\mathrm{d}I_{2}$, Hamilton's equations are $\\dot{\\theta}_{i} = \\frac{\\partial H}{\\partial I_{i}}$ and $\\dot{I}_{i} = -\\frac{\\partial H}{\\partial \\theta_{i}}$. The Poisson bracket is then $\\{F,G\\} = \\omega_{\\text{can}}(X_F, X_G) = \\sum_{i=1}^{2} \\left( \\frac{\\partial F}{\\partial \\theta_{i}}\\frac{\\partial G}{\\partial I_{i}} - \\frac{\\partial F}{\\partial I_{i}}\\frac{\\partial G}{\\partial \\theta_{i}} \\right)$.\n\nGiven $H_{0}(I) = \\omega_{1}I_{1}+\\omega_{2}I_{2}$, and assuming the generator $G$ is a function of the angles only, $G=G(\\theta)$, as requested:\n$\\frac{\\partial H_{0}}{\\partial I_{i}} = \\omega_{i}$ and $\\frac{\\partial H_{0}}{\\partial \\theta_{i}} = 0$. Also, $\\frac{\\partial G}{\\partial I_{i}} = 0$.\nThe Poisson bracket simplifies to:\n$$\n\\{H_{0}, G\\} = \\sum_{i=1}^{2} \\left( 0 \\cdot 0 - \\omega_{i} \\frac{\\partial G}{\\partial \\theta_{i}} \\right) = -\\omega \\cdot \\nabla_{\\theta} G\n$$\nThe condition on $G$ becomes the linear partial differential equation:\n$$\n-\\left(\\omega_{1} \\frac{\\partial G}{\\partial \\theta_{1}} + \\omega_{2} \\frac{\\partial G}{\\partial \\theta_{2}}\\right) = -H_{1,\\text{nonres}}(\\theta) \\implies \\omega \\cdot \\nabla_{\\theta} G = H_{1,\\text{nonres}}(\\theta)\n$$\nNext, we identify the resonant and nonresonant modes of $H_{1}$. The perturbation is $H_{1}(\\theta)=a\\cos(\\theta_{1})+b\\sin(2\\theta_{1}-\\theta_{2})+c\\cos(3\\theta_{2})$. The frequency vector is $\\omega=(\\omega_1, \\omega_2)=(1,2)$.\nWe examine the Fourier modes of $H_{1}$:\n1.  The term $a\\cos(\\theta_{1})$ corresponds to wavevectors $k=(\\pm 1, 0)$. The resonance condition is $k \\cdot \\omega = (\\pm 1)(1) + (0)(2) = \\pm 1 \\neq 0$. This term is nonresonant.\n2.  The term $b\\sin(2\\theta_{1}-\\theta_{2})$ corresponds to wavevectors $k=(\\pm 2, \\mp 1)$. The resonance condition is $k \\cdot \\omega = (\\pm 2)(1) + (\\mp 1)(2) = \\pm 2 \\mp 2 = 0$. This term is resonant.\n3.  The term $c\\cos(3\\theta_{2})$ corresponds to wavevectors $k=(0, \\pm 3)$. The resonance condition is $k \\cdot \\omega = (0)(1) + (\\pm 3)(2) = \\pm 6 \\neq 0$. This term is nonresonant.\n\nSo, the nonresonant part of $H_{1}$ is $H_{1,\\text{nonres}}(\\theta) = a\\cos(\\theta_{1}) + c\\cos(3\\theta_{2})$.\nThe PDE for $G$ is:\n$$\n\\frac{\\partial G}{\\partial \\theta_{1}} + 2 \\frac{\\partial G}{\\partial \\theta_{2}} = a\\cos(\\theta_{1}) + c\\cos(3\\theta_{2})\n$$\nWe solve this equation by assuming a form for $G$ with the same Fourier modes as the right-hand side. Let $G(\\theta) = A\\sin(\\theta_{1}) + B\\sin(3\\theta_{2})$.\nWe compute the partial derivatives of this trial solution:\n$$\n\\frac{\\partial G}{\\partial \\theta_{1}} = A\\cos(\\theta_{1})\n$$\n$$\n\\frac{\\partial G}{\\partial \\theta_{2}} = 3B\\cos(3\\theta_{2})\n$$\nSubstituting these into the PDE:\n$$\nA\\cos(\\theta_{1}) + 2(3B\\cos(3\\theta_{2})) = a\\cos(\\theta_{1}) + c\\cos(3\\theta_{2})\n$$\n$$\nA\\cos(\\theta_{1}) + 6B\\cos(3\\theta_{2}) = a\\cos(\\theta_{1}) + c\\cos(3\\theta_{2})\n$$\nBy comparing the coefficients of the linearly independent functions $\\cos(\\theta_{1})$ and $\\cos(3\\theta_{2})$, we find:\n$$\nA = a\n$$\n$$\n6B = c \\implies B = \\frac{c}{6}\n$$\nThus, the generating function that removes the nonresonant terms is:\n$$\nG(\\theta_{1},\\theta_{2}) = a\\sin(\\theta_{1}) + \\frac{c}{6}\\sin(3\\theta_{2})\n$$\nAn arbitrary additive constant to $G$ would not alter the Poisson bracket, so we can set it to zero for simplicity.\nThis generator $G$ ensures that the new first-order Hamiltonian is $K_{1} = H_{1,\\text{res}} = b\\sin(2\\theta_{1}-\\theta_{2})$, which contains only the resonant term as required.",
            "answer": "$$\\boxed{a\\sin(\\theta_{1}) + \\frac{c}{6}\\sin(3\\theta_{2})}$$"
        }
    ]
}