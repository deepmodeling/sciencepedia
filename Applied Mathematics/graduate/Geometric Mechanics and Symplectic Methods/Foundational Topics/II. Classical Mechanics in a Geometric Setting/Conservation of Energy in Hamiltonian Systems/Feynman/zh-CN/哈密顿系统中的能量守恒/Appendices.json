{
    "hands_on_practices": [
        {
            "introduction": "我们的第一个实践练习将以经典的谐振子为模型，但我们将从几何力学的角度来研究它。你的任务将不仅仅是通过代数方法推导能量守恒，而是要从最基本的几何关系 $i_{X_H}\\omega = dH$ 出发。这个练习旨在让你牢固掌握一个核心思想：对于自治系统，能量守恒是相空间动力学内蕴的几何性质。",
            "id": "3734532",
            "problem": "考虑相空间 $\\mathbb{R}^{2}$ 上的单自由度谐振子，其正则坐标为 $(q,p)$，正则辛形式为 $\\omega=\\mathrm{d}q\\wedge \\mathrm{d}p$。哈密顿函数为\n$$\nH(q,p)=\\frac{p^{2}}{2m}+\\frac{1}{2}k\\,q^{2},\n$$\n其中 $m>0$ 和 $k>0$ 是常数参数。使用哈密顿系统的几何定义——即由缩并关系 $i_{X_{H}}\\omega=\\mathrm{d}H$ 定义的哈密顿向量场 $X_{H}$——作为基本出发点。以此为基础，推导运动方程，然后计算沿着由 $H$ 生成的流的时间导数 $\\mathrm{d}H/\\mathrm{d}t$。解释为什么该结果证明了此自治系统的能量守恒。此外，根据初始条件 $(q(0),p(0))$ 确定 $H$ 沿轨迹的常数值，以展示其不变性。\n\n你最终报告的量必须是沿着解的 $\\mathrm{d}H/\\mathrm{d}t$ 的值。请将此值以单个实数或单个闭式解析表达式的形式给出。不需要四舍五入，最终报告的量中不应包含单位。",
            "solution": "该问题是有效的，因为它具有科学依据、提法明确且客观。它提出了一个几何力学中的标准问题——谐振子，并要求基于基本原理进行推导，特别是哈密顿函数 $H$、其对应的向量场 $X_H$ 以及辛形式 $\\omega$ 之间的关系。\n\n该系统定义在相空间 $\\mathbb{R}^{2}$ 上，具有正则坐标 $(q,p)$。哈密顿函数由下式给出\n$$H(q,p) = \\frac{p^2}{2m} + \\frac{1}{2}k q^2$$\n正则辛形式为\n$$\\omega = \\mathrm{d}q \\wedge \\mathrm{d}p$$\n其中 $m > 0$ 和 $k > 0$ 是常数。分析从哈密顿向量场 $X_H$ 的基本定义开始，通过缩并关系：\n$$i_{X_H}\\omega = \\mathrm{d}H$$\n\n首先，我们计算哈密顿量的外微分 $\\mathrm{d}H$。利用流形上的微积分法则，我们有：\n$$\\mathrm{d}H = \\frac{\\partial H}{\\partial q} \\mathrm{d}q + \\frac{\\partial H}{\\partial p} \\mathrm{d}p$$\n偏导数为：\n$$\\frac{\\partial H}{\\partial q} = k q$$\n$$\\frac{\\partial H}{\\partial p} = \\frac{p}{m}$$\n将这些代入 $\\mathrm{d}H$ 的表达式中，得到：\n$$\\mathrm{d}H = k q \\, \\mathrm{d}q + \\frac{p}{m} \\, \\mathrm{d}p$$\n\n接下来，我们在坐标基 $\\{\\frac{\\partial}{\\partial q}, \\frac{\\partial}{\\partial p}\\}$ 中表示哈密顿向量场 $X_H$。令其分量为坐标的变化率 $\\dot{q}$ 和 $\\dot{p}$：\n$$X_H = \\dot{q} \\frac{\\partial}{\\partial q} + \\dot{p} \\frac{\\partial}{\\partial p}$$\n现在我们计算缩并 $i_{X_H}\\omega$。利用内积的线性和其在楔积上的作用：\n$$i_{X_H}\\omega = i_{\\left(\\dot{q} \\frac{\\partial}{\\partial q} + \\dot{p} \\frac{\\partial}{\\partial p}\\right)}(\\mathrm{d}q \\wedge \\mathrm{d}p)$$\n$$i_{X_H}\\omega = \\dot{q} \\, i_{\\frac{\\partial}{\\partial q}}(\\mathrm{d}q \\wedge \\mathrm{d}p) + \\dot{p} \\, i_{\\frac{\\partial}{\\partial p}}(\\mathrm{d}q \\wedge \\mathrm{d}p)$$\n内积是向量场与微分形式的缩并。我们回顾 $i_{\\frac{\\partial}{\\partial x^i}} \\mathrm{d}x^j = \\delta^j_i$，其中 $\\delta^j_i$ 是克罗内克δ函数。\n$$i_{\\frac{\\partial}{\\partial q}}(\\mathrm{d}q \\wedge \\mathrm{d}p) = (i_{\\frac{\\partial}{\\partial q}}\\mathrm{d}q) \\wedge \\mathrm{d}p - \\mathrm{d}q \\wedge (i_{\\frac{\\partial}{\\partial q}}\\mathrm{d}p) = 1 \\cdot \\mathrm{d}p - \\mathrm{d}q \\wedge 0 = \\mathrm{d}p$$\n$$i_{\\frac{\\partial}{\\partial p}}(\\mathrm{d}q \\wedge \\mathrm{d}p) = (i_{\\frac{\\partial}{\\partial p}}\\mathrm{d}q) \\wedge \\mathrm{d}p - \\mathrm{d}q \\wedge (i_{\\frac{\\partial}{\\partial p}}\\mathrm{d}p) = 0 \\wedge \\mathrm{d}p - \\mathrm{d}q \\wedge 1 = -\\mathrm{d}q$$\n将这些代入，我们得到缩并的表达式：\n$$i_{X_H}\\omega = \\dot{q} \\, \\mathrm{d}p - \\dot{p} \\, \\mathrm{d}q$$\n\n为推导运动方程，我们将 $\\mathrm{d}H$ 和 $i_{X_H}\\omega$ 的两个表达式相等：\n$$-\\dot{p} \\, \\mathrm{d}q + \\dot{q} \\, \\mathrm{d}p = k q \\, \\mathrm{d}q + \\frac{p}{m} \\, \\mathrm{d}p$$\n由于 $\\{\\mathrm{d}q, \\mathrm{d}p\\}$ 在每一点都构成余切空间的基，我们可以令基底1-形式的系数相等：\n\\begin{align*}\n\\mathrm{d}q \\text{的系数}: \\quad  -\\dot{p} = k q \\implies \\dot{p} = -k q \\\\\n\\mathrm{d}p \\text{的系数}: \\quad  \\dot{q} = \\frac{p}{m}\n\\end{align*}\n这些就是我们熟悉的谐振子的哈密顿方程。\n\n下一个任务是计算 $H$ 沿着解轨迹（即向量场 $X_H$ 的积分曲线）的时间导数。这个变化率由向量场作用于函数 $H$ 给出，可以用链式法则计算：\n$$\\frac{\\mathrm{d}H}{\\mathrm{d}t} = \\frac{\\partial H}{\\partial q} \\frac{\\mathrm{d}q}{\\mathrm{d}t} + \\frac{\\partial H}{\\partial p} \\frac{\\mathrm{d}p}{\\mathrm{d}t} = \\frac{\\partial H}{\\partial q} \\dot{q} + \\frac{\\partial H}{\\partial p} \\dot{p}$$\n代入我们刚推导出的 $H$ 的偏导数和运动方程：\n$$\\frac{\\mathrm{d}H}{\\mathrm{d}t} = (k q) \\left(\\frac{p}{m}\\right) + \\left(\\frac{p}{m}\\right) (-k q) = \\frac{kqp}{m} - \\frac{kqp}{m} = 0$$\n\n这个结果 $\\frac{\\mathrm{d}H}{\\mathrm{d}t}=0$ 证明了能量守恒。由于哈密顿量 $H$ 是自治的（它没有对时间的显式依赖），并且代表系统的总机械能（动能 $\\frac{p^2}{2m}$ 加上势能 $\\frac{1}{2}k q^2$），其时间导数为零的事实意味着总能量是一个运动常数。\n\n一个更深刻的几何论证证实了任何自治哈密顿系统的这个结果。$H$ 沿着 $X_H$ 的流的时间导数是 $H$ 关于 $X_H$ 的李导数：\n$$\\frac{\\mathrm{d}H}{\\mathrm{d}t} = \\mathcal{L}_{X_H} H = \\mathrm{d}H(X_H)$$\n使用定义关系 $i_{X_H}\\omega=\\mathrm{d}H$，我们可以代入 $\\mathrm{d}H$：\n$$\\frac{\\mathrm{d}H}{\\mathrm{d}t} = (i_{X_H}\\omega)(X_H)$$\n根据内积的定义，对于一个2-形式 $\\alpha$，有 $(i_V\\alpha)(W) = \\alpha(V,W)$。因此：\n$$\\frac{\\mathrm{d}H}{\\mathrm{d}t} = \\omega(X_H, X_H)$$\n根据定义，辛形式 $\\omega$ 是一个交替2-形式，这意味着它是斜对称的：对于任何向量场 $V, W$，有 $\\omega(V,W) = -\\omega(W,V)$。斜对称的一个直接推论是，对于任何向量场 $V$，有 $\\omega(V,V)=0$。因此：\n$$\\frac{\\mathrm{d}H}{\\mathrm{d}t} = \\omega(X_H, X_H) = 0$$\n这个简洁的证明表明，能量守恒是哈密顿力学几何结构的直接结果。\n\n最后，我们确定 $H$ 的常数值。由于 $\\frac{\\mathrm{d}H}{\\mathrm{d}t}=0$，$H(q(t), p(t))$ 的值在所有时间 $t$ 上都是恒定的。这个常数由系统在任何时刻的状态决定，通常是初始时刻 $t=0$。给定初始条件 $(q(0), p(0))$，整个轨迹上的哈密顿量的值为：\n$$H(q(t), p(t)) = H(q(0), p(0)) = \\frac{p(0)^2}{2m} + \\frac{1}{2}k q(0)^2$$\n这个表达式证实了哈密顿量沿着系统轨迹的不变性。问题所要求的具体量是 $\\mathrm{d}H/\\mathrm{d}t$ 的值。如两种方法所示，这个值为 $0$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "在确认了自治系统中的能量守恒之后，我们自然会问：当这个条件不被满足时会发生什么？这个问题探讨了一个非自治哈密顿量，其势能明确地依赖于时间。通过推导该系统的轨迹并计算能量的变化率，你将直接观察到能量守恒为何失效，并由此更深刻地理解时间平移对称性作为能量守恒定律的根本来源。",
            "id": "3734526",
            "problem": "考虑一个余切丛 $T^{\\ast}\\mathbb{R}$ 上的单自由度哈密顿系统，其具有正则坐标 $(x,p)$ 和正则辛形式 $\\omega = dx \\wedge dp$。设哈密顿量为\n$$\nH(x,p,t) = \\frac{p^{2}}{2m} + \\gamma\\, t\\, x,\n$$\n其中 $m>0$ 和 $\\gamma \\neq 0$ 是常数。在时刻 $t=0$ 时，位形空间坐标和速度分别为 $x(0) = x_{0}$ 和 $\\dot{x}(0) = v_{0}$。\n\n仅从哈密顿动力学和辛几何的基本定义出发——具体来说，哈密顿向量场 $X_{H}$ 满足 $\\iota_{X_{H}}\\omega = dH$，这在正则坐标下导出哈密顿方程 $\\dot{x} = \\partial H/\\partial p$ 和 $\\dot{p} = -\\partial H/\\partial x$——完成以下任务：\n\n1. 推导该系统的显式轨迹 $x(t)$ 和动量 $p(t)$。\n\n2. 使用链式法则和哈密顿方程，计算能量 $H(x(t),p(t),t)$ 沿着哈密顿流的瞬时变化率，并将其表示为 $t$、$m$、$\\gamma$、$x_{0}$ 和 $v_{0}$ 的函数。请以单一闭合形式的解析表达式给出最终答案。\n\n3. 简要地，并完全基于第一性原理，解释为什么当 $\\partial V/\\partial t \\neq 0$ 时（其中 $V(x,t) = \\gamma\\, t\\, x$），此示例展示了雅可比-莫佩尔蒂原理 (Jacobi–Maupertuis principle, JMP) 的失效。不要使用任何预先给定的目标公式；相反，将你的推理建立在构造一个不依赖于时间的雅可比度量需要一个固定能级这一要求上。\n\n你的最终答案必须是第 2 部分中得到的显式解析表达式。不需要数值近似。",
            "solution": "所述问题在形式上是有效的。它在科学上基于经典力学和几何力学的原理，问题提法良好，具有足够的初始条件以产生唯一解，并以客观、明确的数学语言表述。所有必要信息均已提供，且无内部矛盾。因此，我们可以着手求解。\n\n根据题目要求，解答分为三个部分。\n\n### 第 1 部分：轨迹和动量的推导\n\n我们已知一个单自由度系统的哈密顿量：\n$$\nH(x,p,t) = \\frac{p^{2}}{2m} + \\gamma\\, t\\, x\n$$\n其中 $m > 0$ 和 $\\gamma \\neq 0$ 是常数。正则坐标为 $(x,p)$。\n\n动力学由哈密顿方程决定，这些方程源自基本关系 $\\iota_{X_{H}}\\omega = dH$。在具有辛形式 $\\omega = dx \\wedge dp$ 的正则坐标 $(x,p)$ 中，这些方程是：\n$$\n\\dot{x} = \\frac{\\partial H}{\\partial p}\n$$\n$$\n\\dot{p} = -\\frac{\\partial H}{\\partial x}\n$$\n\n首先，我们计算哈密顿量所需的偏导数：\n$$\n\\frac{\\partial H}{\\partial p} = \\frac{\\partial}{\\partial p}\\left(\\frac{p^{2}}{2m} + \\gamma\\, t\\, x\\right) = \\frac{p}{m}\n$$\n$$\n\\frac{\\partial H}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\frac{p^{2}}{2m} + \\gamma\\, t\\, x\\right) = \\gamma t\n$$\n\n将这些代入哈密顿方程，得到关于轨迹 $(x(t), p(t))$ 的常微分方程组：\n$$\n\\text{(1)} \\quad \\dot{x} = \\frac{p}{m}\n$$\n$$\n\\text{(2)} \\quad \\dot{p} = -\\gamma t\n$$\n\n我们首先求解方程 (2) 以得到动量 $p(t)$。这是一个一阶可分离微分方程。我们对时间从 $t=0$ 积分到一个任意时刻 $t$：\n$$\n\\int_{p(0)}^{p(t)} dp' = \\int_{0}^{t} (-\\gamma \\tau) \\, d\\tau\n$$\n$$\np(t) - p(0) = -\\gamma \\left[ \\frac{\\tau^2}{2} \\right]_{0}^{t} = -\\frac{\\gamma t^2}{2}\n$$\n初始动量 $p(0)$ 通过方程 (1) 与初始速度 $\\dot{x}(0) = v_0$ 相关联：\n$$\np(0) = m \\dot{x}(0) = m v_0\n$$\n将此代入 $p(t)$ 的积分表达式中，我们得到动量的显式形式：\n$$\np(t) = m v_0 - \\frac{1}{2}\\gamma t^2\n$$\n\n接下来，我们使用方程 (1) $\\dot{x}(t) = p(t)/m$ 求解位置 $x(t)$。代入 $p(t)$ 的表达式：\n$$\n\\dot{x}(t) = \\frac{1}{m}\\left(m v_0 - \\frac{1}{2}\\gamma t^2\\right) = v_0 - \\frac{\\gamma t^2}{2m}\n$$\n我们使用初始条件 $x(0) = x_0$，将此方程对时间从 $t=0$ 积分到 $t$：\n$$\n\\int_{x(0)}^{x(t)} dx' = \\int_{0}^{t} \\left(v_0 - \\frac{\\gamma \\tau^2}{2m}\\right) \\, d\\tau\n$$\n$$\nx(t) - x(0) = \\left[ v_0 \\tau - \\frac{\\gamma \\tau^3}{6m} \\right]_{0}^{t} = v_0 t - \\frac{\\gamma t^3}{6m}\n$$\n使用初始条件 $x(0) = x_0$，我们找到显式轨迹：\n$$\nx(t) = x_0 + v_0 t - \\frac{\\gamma t^3}{6m}\n$$\n\n### 第 2 部分：能量的瞬时变化率\n\n题目要求我们计算哈密顿量 $H(x(t), p(t), t)$ 沿着系统轨迹的全时间导数。我们使用多元链式法则：\n$$\n\\frac{dH}{dt} = \\frac{\\partial H}{\\partial x}\\frac{dx}{dt} + \\frac{\\partial H}{\\partial p}\\frac{dp}{dt} + \\frac{\\partial H}{\\partial t}\n$$\n根据哈密顿方程，我们有代换关系 $\\frac{dx}{dt} = \\dot{x} = \\frac{\\partial H}{\\partial p}$ 和 $\\frac{dp}{dt} = \\dot{p} = -\\frac{\\partial H}{\\partial x}$。将这些代入链式法则表达式：\n$$\n\\frac{dH}{dt} = \\frac{\\partial H}{\\partial x}\\left(\\frac{\\partial H}{\\partial p}\\right) + \\frac{\\partial H}{\\partial p}\\left(-\\frac{\\partial H}{\\partial x}\\right) + \\frac{\\partial H}{\\partial t}\n$$\n前两项相消，这是哈密顿流的一个普遍性质：\n$$\n\\frac{dH}{dt} = \\frac{\\partial H}{\\partial x}\\frac{\\partial H}{\\partial p} - \\frac{\\partial H}{\\partial p}\\frac{\\partial H}{\\partial x} + \\frac{\\partial H}{\\partial t} = \\frac{\\partial H}{\\partial t}\n$$\n这表明，对于任何哈密顿系统，能量沿着一条轨迹的总变化率等于哈密顿量对时间的显式偏导数。\n\n对于给定的哈密顿量 $H(x,p,t) = \\frac{p^{2}}{2m} + \\gamma\\, t\\, x$，这个偏导数为：\n$$\n\\frac{\\partial H}{\\partial t} = \\frac{\\partial}{\\partial t}\\left(\\frac{p^{2}}{2m} + \\gamma t x\\right) = \\gamma x\n$$\n因此，能量沿流的变化率为 $\\frac{dH}{dt} = \\gamma x(t)$。为了用初始条件和系统参数来表示它，我们代入第 1 部分中推导出的 $x(t)$ 的表达式：\n$$\n\\frac{dH}{dt} = \\gamma \\left( x_0 + v_0 t - \\frac{\\gamma t^3}{6m} \\right)\n$$\n展开此式，得到能量变化率的最终解析表达式：\n$$\n\\frac{dH}{dt} = \\gamma x_0 + \\gamma v_0 t - \\frac{\\gamma^2 t^3}{6m}\n$$\n\n### 第 3 部分：雅可比-莫佩尔蒂原理的失效\n\n雅可比-莫佩尔蒂原理 (Jacobi–Maupertuis principle, JMP) 将一个保守力学系统的轨迹与位形空间上某个特定黎曼度量的测地线联系起来。其推导以能量守恒为前提。\n\n该原理从一个不依赖于时间的哈密顿量 $H(q,p) = T(q,p) + V(q)$ 出发，其中能量 $H$ 是一个运动常数，$H=E$。作用量原理可以被重构为节略作用量 $S_0 = \\int p \\cdot dq$。对于一个标准的动能项 $T = \\sum_i \\frac{p_i^2}{2m_i}$，动量的大小可以通过解方程 $E = T+V$ 得到，对于单个粒子，这得出 $|p| = \\sqrt{2m(E-V(q))}$。作用量变为 $S_0 = \\int \\sqrt{2m(E-V(q))} \\, ds$，其中 $ds$ 是位形流形上的欧几里得弧长元。\n\n表达式 $\\sqrt{2m(E-V(q))}$ 被用来为一个新的度量——雅可比度量 $g_J = 2m(E-V(q)) g_{\\text{Euclidean}}$ 定义一个共形因子。能量为 $E$ 的力学系统的轨迹就是赋予了该度量 $g_J$ 的位形流形上的测地线。\n\n这整个构造的关键和基础性要求是存在一个单一的、恒定的能量值 $E$ 来表征轨迹。雅可比度量本身就是用这个常数 $E$ 来定义的。\n\n在当前问题中，势能是 $V(x,t) = \\gamma t x$，它显式地依赖于时间。如第 2 部分所示，这种显式的时间依赖性导致能量不守恒：\n$$\n\\frac{dH}{dt} = \\frac{\\partial H}{\\partial t} = \\frac{\\partial V}{\\partial t} = \\gamma x(t)\n$$\n由于 $\\gamma \\neq 0$ 且 $x(t)$ 通常不为零，能量 $H(t)$ 沿着给定路径不是恒定的。因为没有一个与轨迹相关联的固定能级 $E$，所以不可能定义一个单一的、不依赖于时间的雅可比度量，使其测地线对应于系统的路径。JMP 的基本前提——将动力学问题重构为一个静态流形上的纯几何问题——在能量景观本身随时间变化时是无效的。因此，对于 $\\partial V/\\partial t \\neq 0$ 的系统，JMP 失效。",
            "answer": "$$\n\\boxed{\\gamma x_{0} + \\gamma v_{0} t - \\frac{\\gamma^{2} t^{3}}{6m}}\n$$"
        },
        {
            "introduction": "理论上的守恒律在连续世界中是精确的，但在充满近似的数值模拟世界中它们表现如何？最后的这个实践练习将连接抽象理论与计算实践，要求你为谐振子实现两种数值积分方法。通过比较一个非辛方法（显式欧拉法）和一个辛方法（Stoermer–Verlet法），你将亲眼见证在哈密顿系统的模拟中，使用结构保持算法对于确保长期稳定性和物理真实性的至关重要性。",
            "id": "3734508",
            "problem": "考虑一维谐振子，其哈密顿量为 $H(q,p) = \\frac{p^2}{2m} + \\frac{1}{2} k q^2$，其中 $q$ 表示位置，$p$ 表示动量，$m$ 是质量，$k$ 是刚度参数。精确的哈密顿动力学由哈密顿方程决定，这是几何力学中的基本方程：$\\dot{q} = \\partial H / \\partial p$ 和 $\\dot{p} = -\\partial H / \\partial q$。对于这个可分离的哈密顿量，这些方程在相空间中生成能精确保持总能量 $H(q,p)$ 守恒的辛流。本问题的目的是量化和比较两种应用于该系统的数值时间步进方法的能量行为：一种辛方法（Stoermer–Verlet）和一种非辛方法（显式欧拉法）。\n\n从哈密顿系统的基本定律、核心定义以及辛性的概念出发，通过组合与动能 $\\frac{p^2}{2m}$ 和势能 $\\frac{1}{2}k q^2$ 相关的精确部分流，推导出 Stoermer–Verlet 方法的更新规则。同样地，将哈密顿方程视为一个一阶系统，直接从中推导出显式欧拉法的更新规则。为谐振子实现这两种积分器，并在一系列时间步长和参数下，计算在有限时间范围内的最大相对能量误差。在离散时间 $t_n$ 的相对误差定义为 $\\left|H(q_n,p_n) - H(q_0,p_0)\\right| / H(q_0,p_0)$，这是一个无量纲量。由于能量 $H$ 具有物理单位，您只需报告无量纲的相对误差。角度未在本问题中显式出现，因此无需指定角度单位。\n\n你的程序必须：\n- 以哈密顿方程 $\\dot{q} = p/m$ 和 $\\dot{p} = -k q$ 作为基本出发点。\n- 通过将可分离的哈密顿量分裂为动能和势能部分来推导并实现 Stoermer–Verlet 积分器，从而获得一个辛组合。\n- 直接从时间离散化的哈密顿方程推导并实现显式欧拉法。\n- 对每个测试用例，在选定的时间范围 $T$ 内，计算 $N$ 个大小为 $h$ 的均匀步长上的最大相对能量误差。\n- 以浮点数形式生成结果。如果某种方法发生数值溢出，相对误差可以报告为 $+\\infty$，这是一种可接受的浮点表示。\n\n使用以下测试套件。对于每个用例，时间范围 $T$ 由指定数量的振荡器周期定义，其中角频率为 $\\omega = \\sqrt{k/m}$，周期为 $2\\pi/\\omega$。设步数为 $N = \\lfloor T/h \\rfloor$。在所有用例中，初始能量必须严格为正。\n\n- 用例1（理想情况，小步长）：$m = 1$，$k = 1$，$h = 0.05$，周期数 $= 20$，$q_0 = 1.0$，$p_0 = 0.0$。\n- 用例2（中等步长，显式欧拉法中存在可观察到的漂移）：$m = 1$，$k = 1$，$h = 0.2$，周期数 $= 10$，$q_0 = 1.0$，$p_0 = 0.0$。\n- 用例3（接近 Stoermer–Verlet 稳定性极限，混合初始能量）：$m = 1$，$k = 4$，$h = 0.9$（注意 $h < 2/\\omega$），周期数 $= 5$，$q_0 = 0.7$，$p_0 = 0.5$。\n- 用例4（大质量、软弹簧、大步长但在 Stoermer–Verlet 稳定性范围内）：$m = 2$，$k = 0.5$，$h = 1.9$，周期数 $= 10$，$q_0 = 0.0$，$p_0 = 1.0$。\n\n对每个用例：\n1. 根据指定的周期数以及参数 $m$ 和 $k$ 计算 $T$。\n2. 设置 $N = \\lfloor T/h \\rfloor$。\n3. 分别使用 Stoermer–Verlet 和显式欧拉法进行积分。\n4. 对每种方法，记录在所有步长 $n = 1,\\dots,N$ 上的最大相对能量误差。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个有四个元素的列表，每个元素是对应一个测试用例的、含两个浮点数的列表。每个内部列表必须按 $[\\text{error}_{\\text{SV}}, \\text{error}_{\\text{EE}}]$ 的顺序排列，其中 $\\text{error}_{\\text{SV}}$ 是 Stoermer–Verlet 方法的最大相对能量误差，而 $\\text{error}_{\\text{EE}}$ 是显式欧拉法对应的误差值。最终打印的行必须如下所示：\n$[[e_{SV,1},e_{EE,1}],[e_{SV,2},e_{EE,2}],[e_{SV,3},e_{EE,3}],[e_{SV,4},e_{EE,4}]]$,\n所有值都以十进制形式表示，或在适用时表示为 $+\\infty$。",
            "solution": "该问题要求针对一维谐振子，推导、实现并比较两种数值积分方法：显式欧拉法和 Stoermer–Verlet 法。比较的依据是能量守恒。\n\n该系统由代表总能量的哈密顿函数定义：\n$$H(q, p) = \\frac{p^2}{2m} + \\frac{1}{2} k q^2$$\n其中 $q$ 是位置，$p$ 是动量，$m$ 是质量，$k$ 是弹簧刚度常数。其动力学由哈密顿运动方程决定：\n$$ \\dot{q} = \\frac{\\partial H}{\\partial p} = \\frac{p}{m} $$\n$$ \\dot{p} = -\\frac{\\partial H}{\\partial q} = -k q $$\n这对一阶常微分方程构成了数值时间步进方案的基础。\n\n**1. 显式欧拉法**\n\n显式欧拉法是求解形如 $\\dot{\\mathbf{y}} = \\mathbf{f}(\\mathbf{y})$ 的初值问题的一阶数值方法。它利用当前时间 $t_n$ 的状态及其导数来近似下一个时间步 $t_{n+1} = t_n + h$ 的状态：\n$$ \\mathbf{y}_{n+1} = \\mathbf{y}_n + h \\mathbf{f}(\\mathbf{y}_n) $$\n设状态向量为 $\\mathbf{y} = (q, p)^T$。根据哈密顿方程，函数 $\\mathbf{f}(\\mathbf{y})$ 为：\n$$ \\mathbf{f}(q, p) = \\begin{pmatrix} p/m \\\\ -kq \\end{pmatrix} $$\n将显式欧拉公式应用于状态向量的每个分量，我们得到从状态 $(q_n, p_n)$ 到 $(q_{n+1}, p_{n+1})$ 的更新规则：\n$$ q_{n+1} = q_n + h \\left(\\frac{p_n}{m}\\right) $$\n$$ p_{n+1} = p_n + h (-k q_n) $$\n这些更新使用时间步 $h$ 开始时的 $q_n$ 和 $p_n$ 值。已知该方法是非辛的。对于像谐振子这样的振荡系统，使用此方法计算的数值能量会系统性地漂移，通常随时间增加，因为其放大矩阵的特征值的模大于1。\n\n**2. Stoermer–Verlet 方法**\n\nStoermer–Verlet 方法是一种辛积分器，特别适用于哈密顿系统。其推导基于算子分裂原理。哈密顿量是可分离的，可以分为动能部分 $T(p) = p^2/(2m)$ 和势能部分 $V(q) = \\frac{1}{2} k q^2$。系统在一个时间步 $h$ 内的精确演化可以形式化地写成对相空间坐标的操作，$\\mathbf{z}_{n+1} = e^{h L_H} \\mathbf{z}_n$，其中 $L_H$ 是与 $H$ 相关的李算子。由于 $H = T+V$，我们有 $L_H = L_T + L_V$。\n\n通过一种称为 Strang 分裂的对称组合，可以实现二阶精确近似：\n$$ e^{h L_H} \\approx e^{\\frac{h}{2} L_V} e^{h L_T} e^{\\frac{h}{2} L_V} $$\n这意味着我们先应用对应于势能的流演化半步，然后应用对应于动能的流演化一整步，最后再次应用势能流演化半步。\n\n在 $L_T$ 下，时间 $\\Delta t$ 内的精确流为：\n$$ \\dot{q} = \\frac{\\partial T}{\\partial p} = \\frac{p}{m}, \\quad \\dot{p} = -\\frac{\\partial T}{\\partial q} = 0 \\quad \\implies \\quad q(\\Delta t) = q(0) + \\Delta t \\frac{p(0)}{m}, \\quad p(\\Delta t) = p(0) $$\n\n在 $L_V$ 下，时间 $\\Delta t$ 内的精确流为：\n$$ \\dot{q} = \\frac{\\partial V}{\\partial p} = 0, \\quad \\dot{p} = -\\frac{\\partial V}{\\partial q} = -k q \\quad \\implies \\quad q(\\Delta t) = q(0), \\quad p(\\Delta t) = p(0) - \\Delta t k q(0) $$\n\n将此分裂序列应用于状态 $(q_n, p_n)$：\n1.  **第一个势能半步 ($\\Delta t = h/2$)**：我们定义一个中间动量 $p_{n+1/2}$。\n    $$ p_{n+1/2} = p_n - \\frac{h}{2} k q_n $$\n2.  **完整动能步 ($\\Delta t = h$)**：我们使用中间动量更新位置。\n    $$ q_{n+1} = q_n + h \\frac{p_{n+1/2}}{m} $$\n3.  **第二个势能半步 ($\\Delta t = h/2$)**：我们使用新计算的位置 $q_{n+1}$ 将动量更新到其在 $t_{n+1}$ 时的最终值。\n    $$ p_{n+1} = p_{n+1/2} - \\frac{h}{2} k q_{n+1} $$\n\n这三组方程构成了 Stoermer–Verlet（以其蛙跳格式）积分方案。作为一种辛方法，它不精确守恒哈密顿量 $H$，但它精确守恒一个邻近的“影子”哈密顿量。这一性质确保了在长时间积分中，能量误差保持有界，在初始值附近振荡，前提是时间步长 $h$ 低于稳定性极限，对于谐振子而言，该极限为 $h < 2/\\omega$，其中 $\\omega = \\sqrt{k/m}$。\n\n**3. 数值评估**\n\n对于每个测试用例，我们将根据振荡器的自然周期 $2\\pi/\\omega$ 计算总时间范围 $T$，以及步数 $N = \\lfloor T/h \\rfloor$。然后，我们将使用两种方法从初始条件 $(q_0, p_0)$ 开始，对系统进行 $N$ 步积分。在每一步 $n \\in \\{1, \\dots, N\\}$，我们计算相对能量误差：\n$$ \\epsilon_n = \\frac{|H(q_n, p_n) - H(q_0, p_0)|}{|H(q_0, p_0)|} $$\n每种方法的最终报告值将是整个模拟过程中观测到的最大误差 $\\max_{n=1 \\dots N} \\epsilon_n$。我们预期显式欧拉法的误差会增长，而 Stoermer-Verlet 方法的误差将保持微小且有界。",
            "answer": "[[0.0010427320000000455,5.188220000000037],[0.02706304000000001,4.4098959999999945],[0.3168393529411762,68.9680542986425],[0.11974793750000008,1971.0505]]"
        }
    ]
}