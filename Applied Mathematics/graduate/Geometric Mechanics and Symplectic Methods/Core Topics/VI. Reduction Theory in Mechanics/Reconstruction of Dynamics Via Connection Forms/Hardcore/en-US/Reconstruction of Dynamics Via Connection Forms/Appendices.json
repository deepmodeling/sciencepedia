{
    "hands_on_practices": [
        {
            "introduction": "This first exercise provides a concrete, foundational example of how a mechanical connection arises from the geometry of a physical system. By considering a free particle in Euclidean space subject to a rotational symmetry, we will derive the connection form from first principles using the kinetic energy metric. This practice demystifies the origin of the connection and its curvature, grounding the abstract concept in a tangible physical scenario. ",
            "id": "3764117",
            "problem": "Let $Q=\\mathbb{R}^{3}\\setminus\\{0\\}$ with the action of the Special Orthogonal group in two dimensions (SO(2)) by rotations about the $z$-axis. Consider the free-particle kinetic energy metric induced by the standard Euclidean metric on $Q$. \n\n(a) Identify the orbit space $Q/\\mathrm{SO}(2)$ explicitly as a subset of $\\mathbb{R}^{2}$ using cylindrical coordinates, and give a scientifically sound description of its stratified topology, distinguishing the principal stratum from the singular stratum.\n\n(b) On the regular (principal) part of the quotient, regard $Q$ as a principal circle bundle with structure group the one-dimensional torus ($\\mathrm{S}^{1}$). Using the mechanical connection associated with the kinetic energy metric, derive from first principles the explicit expression for the connection one-form $A$ on $Q$ in Cartesian coordinates $(x,y,z)$, and compute its curvature two-form $F$.\n\nYour final answer must be the explicit analytic expression for the curvature two-form $F$ on the regular part of the base, written in terms of Cartesian or cylindrical variables. If you obtain a constant, provide it as an exact number. No rounding is required.",
            "solution": "This problem involves two main tasks: identifying the orbit space and its structure for an $\\mathrm{SO}(2)$ action on $\\mathbb{R}^3$, and then deriving the mechanical connection and its curvature.\n\n### (a) Orbit Space and Stratification\n\nThe configuration space is $Q = \\mathbb{R}^{3} \\setminus \\{(0,0,0)\\}$. The group $G = \\mathrm{SO}(2)$ acts on a point $q=(x,y,z) \\in Q$ by rotation about the $z$-axis. An element $R_{\\phi} \\in \\mathrm{SO}(2)$ corresponding to a rotation by an angle $\\phi$ acts as:\n$$\n\\Phi(R_{\\phi}, (x,y,z)) = (x\\cos\\phi - y\\sin\\phi, x\\sin\\phi + y\\cos\\phi, z)\n$$\nTo identify the orbit space $M = Q/G$, we find coordinates that are invariant under this action. Using cylindrical coordinates $(r, \\theta, z)$, where $x=r\\cos\\theta$, $y=r\\sin\\theta$, and $z=z$, the action only affects the angle $\\theta \\to \\theta+\\phi$. The coordinates $r = \\sqrt{x^{2}+y^{2}}$ (the radial distance from the $z$-axis) and $z$ are invariant. An orbit is thus uniquely determined by the values of $r$ and $z$.\nThe condition $q \\in Q$ means $(x,y,z) \\neq (0,0,0)$, which translates to the condition that $r$ and $z$ are not simultaneously zero. Since $r \\geq 0$, the orbit space $M = Q/\\mathrm{SO}(2)$ can be identified with the set of pairs $(r,z) \\in \\mathbb{R}^{2}$ such that $r \\geq 0$ and $(r,z) \\neq (0,0)$. This is the closed right half-plane in $\\mathbb{R}^{2}$ with the origin removed.\n\nThe stratification of the orbit space is determined by the orbit types, classified by the isotropy subgroup $G_{q} = \\{g \\in G \\mid \\Phi(g,q)=q\\}$.\n1.  For a point $q=(x,y,z)$ not on the $z$-axis, we have $r = \\sqrt{x^{2}+y^{2}} > 0$. A rotation by $\\phi$ fixes $q$ only if $\\phi = 2\\pi k$ for some integer $k \\in \\mathbb{Z}$. Thus, the isotropy group $G_{q}$ is the trivial subgroup $\\{I\\}$. These are principal orbits, and they form the **principal stratum** of the orbit space. This corresponds to the region where $r>0$, which is the open right half-plane $\\{(r,z) \\in \\mathbb{R}^{2} \\mid r>0\\}$.\n2.  For a point $q=(x,y,z)$ on the $z$-axis, we have $r=\\sqrt{x^{2}+y^{2}}=0$. Since $q \\neq (0,0,0)$, we have $z \\neq 0$. Any rotation about the $z$-axis leaves such a point $q=(0,0,z)$ fixed. Therefore, the isotropy group $G_{q}$ is the entire group $\\mathrm{SO}(2)$. These are singular orbits, and they form the **singular stratum**. This corresponds to the set of points where $r=0$ and $z \\neq 0$, which is the positive and negative $z$-axis in the orbit space, excluding the origin: $\\{(0,z) \\in \\mathbb{R}^{2} \\mid z \\neq 0\\}$.\n\n### (b) Mechanical Connection and Curvature\n\nWe work on the regular part of $Q$, denoted $Q_{reg} = \\{q \\in Q \\mid \\sqrt{x^{2}+y^{2}} > 0\\}$, which is $\\mathbb{R}^{3}$ minus the $z$-axis. This space is a principal fiber bundle over the principal stratum $M_{reg} = \\{(r,z) \\mid r>0\\}$ with structure group $G = \\mathrm{SO}(2) \\cong \\mathrm{S}^{1}$.\n\nThe kinetic energy metric is the standard Euclidean metric on $\\mathbb{R}^{3}$, $\\langle v, w \\rangle_{q} = v \\cdot w$ for $v, w \\in T_{q}Q \\cong \\mathbb{R}^{3}$. The Lie algebra of $G$ is $\\mathfrak{g} = \\mathfrak{so}(2)$, which is isomorphic to $\\mathbb{R}$. We choose a basis element $\\xi \\in \\mathfrak{g}$ corresponding to $1 \\in \\mathbb{R}$. The infinitesimal generator vector field on $Q$ corresponding to $\\xi$ is:\n$$\n\\xi_{Q}(q) = \\frac{d}{dt}\\bigg|_{t=0} \\Phi(R_{t}, q) = \\frac{d}{dt}\\bigg|_{t=0} (x\\cos t - y\\sin t, x\\sin t + y\\cos t, z) = (-y, x, 0)\n$$\nIn terms of partial derivatives, $\\xi_{Q} = -y\\frac{\\partial}{\\partial x} + x\\frac{\\partial}{\\partial y}$.\n\nThe locked inertia tensor $I: Q \\to L(\\mathfrak{g}, \\mathfrak{g}^{*})$ is defined by $\\langle I(q)\\eta, \\zeta\\rangle = \\langle \\eta_{Q}(q), \\zeta_{Q}(q) \\rangle_{q}$ for $\\eta, \\zeta \\in \\mathfrak{g}$. Using the isomorphism $\\mathfrak{g} \\cong \\mathbb{R}$, $I(q)$ is a scalar whose value for our basis element $\\xi=1$ is:\n$$\nI(q) = \\langle \\xi_{Q}(q), \\xi_{Q}(q) \\rangle_{q} = \\langle (-y,x,0), (-y,x,0) \\rangle = x^{2}+y^{2}\n$$\nThe momentum map $J: TQ \\to \\mathfrak{g}^{*}$ is defined by $\\langle J(v_{q}), \\eta \\rangle = \\langle v_{q}, \\eta_{Q}(q) \\rangle_{q}$ for $v_{q} \\in T_{q}Q$ and $\\eta \\in \\mathfrak{g}$. For a tangent vector $v_{q}=(v_{x}, v_{y}, v_{z})$ at $q=(x,y,z)$, its value on the basis $\\xi=1$ is:\n$$\nJ(v_{q}) = \\langle v_{q}, \\xi_{Q}(q) \\rangle_{q} = \\langle (v_{x},v_{y},v_{z}), (-y,x,0) \\rangle = -yv_{x} + xv_{y}\n$$\nThe mechanical connection is a $\\mathfrak{g}$-valued $1$-form $A$ on $Q_{reg}$ defined by $A_{q}(v_{q}) = I(q)^{-1}J(v_{q})$. Substituting our expressions for $I(q)$ and $J(v_{q})$:\n$$\nA_{q}(v_{q}) = \\frac{-yv_{x} + xv_{y}}{x^{2}+y^{2}}\n$$\nTo write $A$ as a $1$-form in Cartesian coordinates, we evaluate it on the basis vectors $\\frac{\\partial}{\\partial x}$, $\\frac{\\partial}{\\partial y}$, and $\\frac{\\partial}{\\partial z}$:\n$A(\\frac{\\partial}{\\partial x}) = \\frac{-y}{x^{2}+y^{2}}$, $A(\\frac{\\partial}{\\partial y}) = \\frac{x}{x^{2}+y^{2}}$, and $A(\\frac{\\partial}{\\partial z}) = 0$.\nThus, the connection $1$-form is:\n$$\nA = \\frac{-y}{x^{2}+y^{2}} dx + \\frac{x}{x^{2}+y^{2}} dy\n$$\nThe curvature $2$-form $F$ of the connection $A$ is given by $F = dA + \\frac{1}{2}[A,A]$. Since the group $\\mathrm{SO}(2)$ is Abelian, its Lie algebra $\\mathfrak{so}(2)$ has a trivial Lie bracket, so $[A,A]=0$. Therefore, the curvature is simply the exterior derivative of the connection, $F = dA$. Let $f(x,y) = \\frac{-y}{x^{2}+y^{2}}$ and $g(x,y) = \\frac{x}{x^{2}+y^{2}}$. Since $A$ has no $dz$ component and its components do not depend on $z$, we have:\n$$\nF = dA = \\left(\\frac{\\partial g}{\\partial x} - \\frac{\\partial f}{\\partial y}\\right) dx \\wedge dy\n$$\nWe compute the partial derivatives:\n$$\n\\frac{\\partial g}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\frac{x}{x^{2}+y^{2}}\\right) = \\frac{1 \\cdot (x^{2}+y^{2}) - x \\cdot (2x)}{(x^{2}+y^{2})^{2}} = \\frac{y^{2}-x^{2}}{(x^{2}+y^{2})^{2}}\n$$\n$$\n\\frac{\\partial f}{\\partial y} = \\frac{\\partial}{\\partial y}\\left(\\frac{-y}{x^{2}+y^{2}}\\right) = \\frac{-1 \\cdot (x^{2}+y^{2}) - (-y) \\cdot (2y)}{(x^{2}+y^{2})^{2}} = \\frac{-x^{2}-y^{2}+2y^{2}}{(x^{2}+y^{2})^{2}} = \\frac{y^{2}-x^{2}}{(x^{2}+y^{2})^{2}}\n$$\nThe coefficient of $dx \\wedge dy$ in $F=dA$ is therefore:\n$$\n\\frac{\\partial g}{\\partial x} - \\frac{\\partial f}{\\partial y} = \\frac{y^{2}-x^{2}}{(x^{2}+y^{2})^{2}} - \\frac{y^{2}-x^{2}}{(x^{2}+y^{2})^{2}} = 0\n$$\nThe curvature $2$-form $F$ on $Q_{reg}$ is thus $F=0$. Since $F$ is a basic form, it descends to a $2$-form on the base space $M_{reg}$. As $F$ is identically zero on the total space, the corresponding form on the base space is also identically zero. This indicates that the connection is flat, which is expected for a free particle in Euclidean space as there are no intrinsic gyroscopic or \"magnetic\" forces in the reduced system.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "Building on our understanding of where a connection comes from, this practice explores its practical application in reconstructing dynamics. We will first derive the general local expression for a connection one-form within a trivialization, linking the abstract bundle picture to the concrete language of gauge potentials. Subsequently, we will use this local form to solve a reconstruction problem, determining the evolution of a group variable by enforcing the horizontal lift condition for a path in the base space, culminating in the calculation of a geometric phase, or holonomy. ",
            "id": "3764100",
            "problem": "Let $Q \\to U$ be a principal bundle with structure group $G$, where $U \\subset \\mathbb{R}^{2}$ is an open set and $G$ is a Lie group. Fix a local trivialization $Q|_{U} \\cong U \\times G$ with coordinates $(x,g)$, where $x \\in U$ and $g \\in G$. A principal connection is specified by a $\\mathfrak{g}$-valued one-form $\\mathcal{A} \\in \\Omega^{1}(Q,\\mathfrak{g})$ satisfying two fundamental properties: (i) reproduction of generators, namely $\\mathcal{A}(\\xi_{Q})=\\xi$ for all $\\xi \\in \\mathfrak{g}$, where $\\xi_{Q}$ is the fundamental vector field generated by $\\xi$ under the right $G$-action; and (ii) right equivariance, namely $R_{h}^{*}\\mathcal{A}=\\mathrm{Ad}_{h^{-1}}\\mathcal{A}$ for all $h \\in G$, where $R_{h}$ denotes right translation on $Q$ and $\\mathrm{Ad}$ is the adjoint action. \n\nTask 1. Starting only from these definitions and the fact that the right Maurer–Cartan form on $G$ is the $\\mathfrak{g}$-valued one-form $\\theta^{R}_{g} := T_{g}R_{g^{-1}}$ that reproduces generators and satisfies the Maurer–Cartan structure equation, derive the local coordinate expression of the connection one-form in the trivialization. Show that there exists a unique local $\\mathfrak{g}$-valued one-form $A(x) \\in \\Omega^{1}(U,\\mathfrak{g})$ such that $\\mathcal{A}$ can be written in the trivialization $(x,g)$ as a sum of a vertical contribution from $G$ and a horizontal contribution pulled back from $U$.\n\nTask 2. Now specialize to $G=\\mathrm{U}(1)$ with Lie algebra $\\mathfrak{u}(1)=\\mathrm{i}\\mathbb{R}$ and use the same local trivialization $Q|_{U}\\cong U \\times \\mathrm{U}(1)$. Consider the base curve $x(t)=(R\\cos(\\omega t), R\\sin(\\omega t))$ for $t \\in [0,2\\pi/\\omega]$, with fixed real constants $R>0$ and $\\omega>0$. Assume the dynamics on $Q$ is reconstructed from a horizontal lift condition, namely the velocity $(\\dot{x}(t),\\dot{g}(t))$ satisfies $\\mathcal{A}(\\dot{x}(t),\\dot{g}(t))=0$ for all $t$. Take the local gauge potential on $U$ to be \n$$\nA(x)=\\frac{\\mathrm{i}B}{2}\\left(-x_{2}\\,\\mathrm{d}x_{1}+x_{1}\\,\\mathrm{d}x_{2}\\right),\n$$\nwith $B \\in \\mathbb{R}$ constant. Using the expression of $\\mathcal{A}$ from Task 1 and the horizontal condition, derive and solve the reconstruction equation for $g(t) \\in \\mathrm{U}(1)$ with the initial condition $g(0)=\\mathrm{e}$, where $\\mathrm{e}$ denotes the identity element of $\\mathrm{U}(1)$. \n\nGive your final answer as a single closed-form analytic expression for $g(2\\pi/\\omega)$. No numerical rounding is required, and no physical units are to be included in the final expression.",
            "solution": "This problem is divided into two parts. The first part requires deriving the local expression for a principal connection one-form in a given trivialization. The second part involves applying this result to a specific case on the principal bundle $U \\times \\mathrm{U}(1)$ to compute the holonomy for a given path.\n\n### Task 1: Local Expression of the Connection One-Form\n\nLet $Q \\to U$ be a principal bundle with structure group $G$. We are given a local trivialization, which identifies a portion of the bundle $Q|_U$ with the product manifold $U \\times G$. A point in $Q|_U$ is thus represented by coordinates $(x, g)$, where $x \\in U$ and $g \\in G$. The tangent space at a point $(x,g)$ can be decomposed as $T_{(x,g)}(U \\times G) \\cong T_x U \\oplus T_g G$. Any tangent vector $V \\in T_{(x,g)}(U \\times G)$ can be written as a pair $V = (v_x, v_g)$, where $v_x \\in T_x U$ is the \"horizontal\" component and $v_g \\in T_g G$ is the \"vertical\" component with respect to the product structure.\n\nThe principal connection $\\mathcal{A}$ is a $\\mathfrak{g}$-valued one-form on $Q$. By linearity, its action on $V = (v_x, v_g)$ is $\\mathcal{A}_{(x,g)}(V) = \\mathcal{A}_{(x,g)}(v_x, 0) + \\mathcal{A}_{(x,g)}(0, v_g)$. We analyze the two terms separately.\n\n1.  **Action on Vertical Vectors:** A purely vertical vector has the form $(0, v_g)$ where $v_g \\in T_g G$. According to property (i) of a connection, $\\mathcal{A}(\\xi_Q) = \\xi$ for any $\\xi \\in \\mathfrak{g}$, where $\\xi_Q$ is the fundamental vector field on $Q$ generated by $\\xi$. In the local trivialization, the right action $R_h$ on a point $(x,g)$ gives $(x, gh)$. The fundamental vector field $\\xi_Q$ at $(x,g)$ is the tangent vector to the curve $t \\mapsto (x, g \\exp(t\\xi))$ at $t=0$, which is $\\xi_Q(x,g) = (0, T_e R_g (\\xi))$.\n    Applying property (i), we get $\\mathcal{A}_{(x,g)}(0, T_e R_g (\\xi)) = \\xi$.\n    Any tangent vector $v_g \\in T_g G$ can be uniquely written as $v_g = T_e R_g (\\eta)$ for some $\\eta \\in \\mathfrak{g}$. Thus, for a general vertical vector $(0, v_g)$, we have $\\mathcal{A}_{(x,g)}(0, v_g) = \\eta$.\n    We now relate this to the right Maurer-Cartan form on $G$, $\\theta^R \\in \\Omega^1(G, \\mathfrak{g})$, defined as $\\theta^R_g(v_g) = T_g R_{g^{-1}}(v_g)$. For $v_g = T_e R_g (\\eta)$, we have:\n    $$\n    \\theta^R_g(v_g) = T_g R_{g^{-1}}(T_e R_g (\\eta)) = T_e(R_{g^{-1}} \\circ R_g)(\\eta) = T_e(\\mathrm{id})(\\eta) = \\eta\n    $$\n    Comparing this with our expression for the connection's action, we find that $\\mathcal{A}_{(x,g)}(0, v_g) = \\theta^R_g(v_g)$. This holds for any vertical vector.\n\n2.  **Action on Horizontal Vectors:** A purely horizontal vector (in the sense of the product structure) is of the form $(v_x, 0)$. We use property (ii), the right-equivariance of the connection: $R_h^* \\mathcal{A} = \\mathrm{Ad}_{h^{-1}} \\mathcal{A}$. Let $p=(x,e)$ be a point in the trivialization corresponding to the identity element $e \\in G$. Let $h=g$. Let $W = (v_x, 0) \\in T_{(x,e)}(U \\times G)$. The equivariance property states $\\mathcal{A}_{p \\cdot h}(T_p R_h(W)) = \\mathrm{Ad}_{h^{-1}}(\\mathcal{A}_p(W))$. Substituting our choices:\n    $$\n    \\mathcal{A}_{(x,g)}(T_{(x,e)}R_g((v_x, 0))) = \\mathrm{Ad}_{g^{-1}}(\\mathcal{A}_{(x,e)}(v_x, 0))\n    $$\n    The pushforward $T_{(x,e)}R_g$ acts as $T_{(x,e)}R_g(v_x, v_e) = (v_x, T_eR_g(v_e))$, so $T_{(x,e)}R_g((v_x, 0)) = (v_x, 0)$. The equation becomes:\n    $$\n    \\mathcal{A}_{(x,g)}(v_x, 0) = \\mathrm{Ad}_{g^{-1}}(\\mathcal{A}_{(x,e)}(v_x, 0))\n    $$\n    The term $\\mathcal{A}_{(x,e)}(v_x, 0)$ is a linear map on $v_x \\in T_x U$ for each $x \\in U$. It defines a $\\mathfrak{g}$-valued one-form on the base manifold $U$, which we denote by $A \\in \\Omega^1(U, \\mathfrak{g})$. Specifically, we define $A$ by $A_x(v_x) := \\mathcal{A}_{(x,e)}(v_x, 0)$. This definition provides the unique local one-form $A(x)$ sought. The action of the connection on horizontal vectors is then $\\mathcal{A}_{(x,g)}(v_x, 0) = \\mathrm{Ad}_{g^{-1}}(A_x(v_x))$.\n\nCombining these results, the action of $\\mathcal{A}$ on an arbitrary tangent vector $V=(v_x, v_g)$ at $(x,g)$ is:\n$$\n\\mathcal{A}_{(x,g)}(v_x, v_g) = \\mathcal{A}_{(x,g)}(v_x, 0) + \\mathcal{A}_{(x,g)}(0, v_g) = \\mathrm{Ad}_{g^{-1}}(A_x(v_x)) + \\theta^R_g(v_g)\n$$\nThis can be expressed more formally using pullbacks. Let $\\pi_U: U \\times G \\to U$ and $\\pi_G: U \\times G \\to G$ be the canonical projections. Then $A_x(v_x) = (\\pi_U^* A)_{(x,g)}(v_x, v_g)$ and $\\theta^R_g(v_g) = (\\pi_G^* \\theta^R)_{(x,g)}(v_x, v_g)$. The full connection one-form is thus:\n$$\n\\mathcal{A} = \\mathrm{Ad}_{g^{-1}} \\pi_U^* A + \\pi_G^* \\theta^R\n$$\nThe first term, $\\mathrm{Ad}_{g^{-1}} \\pi_U^* A$, constitutes the \"horizontal contribution\" pulled back from $U$ (and twisted by the Adjoint action), while the second term, $\\pi_G^* \\theta^R$, is the \"vertical contribution\" from $G$.\n\n### Task 2: Reconstruction Equation and Holonomy\n\nWe now specialize to $G = \\mathrm{U}(1)$, the circle group. Its elements are of the form $g = \\mathrm{e}^{\\mathrm{i}\\phi}$ for $\\phi \\in \\mathbb{R}$. The Lie algebra is $\\mathfrak{u}(1) = \\mathrm{i}\\mathbb{R}$. As $\\mathrm{U}(1)$ is an abelian group, its adjoint action is trivial: $\\mathrm{Ad}_{h^{-1}}(\\xi) = h^{-1}\\xi h = \\xi$ for any $\\xi \\in \\mathfrak{u}(1)$.\nThe local expression for the connection simplifies to:\n$$\n\\mathcal{A} = \\pi_U^* A + \\pi_G^* \\theta^R\n$$\nFor a curve $g(t) \\in \\mathrm{U}(1)$, the Maurer-Cartan form acting on its tangent vector $\\dot{g}(t)$ is $\\theta^R_{g(t)}(\\dot{g}(t)) = \\dot{g}(t)g(t)^{-1}$.\nThe path on $Q$ is given by $q(t) = (x(t), g(t))$, and its tangent vector is $\\dot{q}(t) = (\\dot{x}(t), \\dot{g}(t))$. The dynamics are governed by the horizontal lift condition, $\\mathcal{A}(\\dot{q}(t)) = 0$. Applying the local form of $\\mathcal{A}$:\n$$\nA_{x(t)}(\\dot{x}(t)) + \\theta^R_{g(t)}(\\dot{g}(t)) = 0\n$$\nSubstituting the expression for the Maurer-Cartan form, we obtain the reconstruction equation:\n$$\n\\dot{g}(t)g(t)^{-1} = -A_{x(t)}(\\dot{x}(t))\n$$\nThis is a first-order ordinary differential equation for $g(t)$. Its solution with initial condition $g(0)$ is:\n$$\ng(t) = \\exp\\left( -\\int_0^t A_{x(\\tau)}(\\dot{x}(\\tau)) \\, \\mathrm{d}\\tau \\right) g(0)\n$$\nGiven $g(0)=\\mathrm{e}=1$, the solution is $g(t) = \\exp\\left( -\\int_C A \\right)$, where the integral is over the path $x(\\tau)$ from $\\tau=0$ to $\\tau=t$.\n\nWe must compute the integral $\\int_0^{2\\pi/\\omega} A_{x(t)}(\\dot{x}(t)) \\, \\mathrm{d}t$.\nThe local gauge potential is $A(x) = \\frac{\\mathrm{i}B}{2}(-x_2 \\mathrm{d}x_1 + x_1 \\mathrm{d}x_2)$.\nThe path on the base is $x(t) = (x_1(t), x_2(t)) = (R\\cos(\\omega t), R\\sin(\\omega t))$.\nThe velocity vector is $\\dot{x}(t) = (\\dot{x}_1(t), \\dot{x}_2(t)) = (-R\\omega\\sin(\\omega t), R\\omega\\cos(\\omega t))$.\nThe integrand $A_{x(t)}(\\dot{x}(t))$ is:\n\\begin{align*}\nA_{x(t)}(\\dot{x}(t)) &= \\frac{\\mathrm{i}B}{2} \\left[ -x_2(t) \\dot{x}_1(t) + x_1(t) \\dot{x}_2(t) \\right] \\\\\n&= \\frac{\\mathrm{i}B}{2} \\left[ -(R\\sin(\\omega t))(-R\\omega\\sin(\\omega t)) + (R\\cos(\\omega t))(R\\omega\\cos(\\omega t)) \\right] \\\\\n&= \\frac{\\mathrm{i}B}{2} \\left[ R^2\\omega\\sin^2(\\omega t) + R^2\\omega\\cos^2(\\omega t) \\right] \\\\\n&= \\frac{\\mathrm{i}B}{2} \\left[ R^2\\omega(\\sin^2(\\omega t) + \\cos^2(\\omega t)) \\right] \\\\\n&= \\frac{\\mathrm{i}B R^2 \\omega}{2}\n\\end{align*}\nThe integrand is a constant. The integral is straightforward to compute over the interval $t \\in [0, 2\\pi/\\omega]$:\n$$\n\\int_0^{2\\pi/\\omega} A_{x(t)}(\\dot{x}(t)) \\, \\mathrm{d}t = \\int_0^{2\\pi/\\omega} \\frac{\\mathrm{i}B R^2 \\omega}{2} \\, \\mathrm{d}t = \\frac{\\mathrm{i}B R^2 \\omega}{2} [t]_0^{2\\pi/\\omega} = \\frac{\\mathrm{i}B R^2 \\omega}{2} \\left(\\frac{2\\pi}{\\omega}\\right) = \\mathrm{i}\\pi B R^2\n$$\nFinally, we find the value of $g(t)$ at $t = 2\\pi/\\omega$:\n$$\ng(2\\pi/\\omega) = \\exp\\left( - \\int_0^{2\\pi/\\omega} A_{x(t)}(\\dot{x}(t)) \\, \\mathrm{d}t \\right) = \\exp(-\\mathrm{i}\\pi B R^2)\n$$\nThis quantity is the holonomy of the connection $A$ along the specified closed curve.",
            "answer": "$$\\boxed{\\exp(-\\mathrm{i}\\pi B R^{2})}$$"
        },
        {
            "introduction": "This final practice transitions from analytical derivation to computational implementation, applying the principles of reconstruction to the canonical example of rigid body motion. You will develop a program to reconstruct the attitude of a rigid body on $SO(3)$ starting from its spatial angular momentum, a scenario common in aerospace and robotics. By comparing this reconstruction with a direct integration in the spatial frame, this exercise not only provides practical coding experience but also numerically validates the profound theoretical equivalence between the body-centric and space-centric descriptions of motion. ",
            "id": "3764112",
            "problem": "You are tasked with reconstructing the attitude dynamics of a rigid body on the Special Orthogonal Group ($SO(3)$) using the principle of reconstruction via connection one-forms in geometric mechanics, and validating the result against a direct spatial-frame integration. The reconstruction must start from fundamental definitions: the rigid body attitude is a rotation matrix $R(t) \\in SO(3)$, the body angular velocity is a vector $\\Omega(t) \\in \\mathbb{R}^3$, and the spatial angular momentum is a vector $h(t) \\in \\mathbb{R}^3$. The inertia tensor is diagonal in body coordinates with principal moments collected in a diagonal matrix $I = \\operatorname{diag}(I_1, I_2, I_3)$, with units of kilogram meter squared ($\\mathrm{kg \\cdot m^2}$). The connection one-form identifying body and spatial frames is the left-invariant Maurer–Cartan form, which maps the tangent $R(t)$-velocity to the body angular velocity. The spatial angular momentum relates to body angular velocity through the momentum map, and the reconstruction must be derived to express $R(t)$ solely from the measured $h(t)$, using the connection that identifies body and spatial frames. The direct spatial-frame integration is the evolution generated by the spatial angular velocity obtained from the same data.\n\nYour program must:\n- Derive and implement a reconstruction method that uses the connection to produce $R(t)$ from $h(t)$ and $I$, together with the initial attitude $R(0)$, over a specified time interval. Use the hat map $\\widehat{(\\cdot)}: \\mathbb{R}^3 \\to \\mathfrak{so}(3)$ defined by $\\widehat{v} \\, w = v \\times w$, where $\\mathfrak{so}(3)$ is the Lie algebra of $SO(3)$, and the Rodrigues formula to compute $\\exp(\\widehat{v})$.\n- Implement a second, direct integration method in the spatial frame using the spatial angular velocity induced by the same $h(t)$ and $I$, and the same initial condition $R(0)$, over the same interval.\n- Compare the final attitudes from both methods by computing the rotation misalignment angle $\\theta \\in \\mathbb{R}$ between the two final rotation matrices, using the standard formula $\\theta = \\arccos\\left(\\frac{\\operatorname{trace}(R_{\\mathrm{dir}}(T)^\\top R_{\\mathrm{rec}}(T)) - 1}{2}\\right)$, where $T$ is the final time. Express the final angle in radians.\n\nUse the following test suite. In each case, all angular quantities must be expressed in radians, input angular momenta in $\\mathrm{kg \\cdot m^2 / s}$, and inertia in $\\mathrm{kg \\cdot m^2}$. The time step $dt$ is in seconds, and the final time $T$ is in seconds.\n\n- Case 1 (general case):\n  - $I = \\operatorname{diag}(2.0, 1.5, 1.0)$.\n  - $R(0) = I_3$ (identity matrix).\n  - $h(t) = [0.3, 0.4, 0.5]$ (constant).\n  - $T = 1.0$, $dt = 0.001$.\n- Case 2 (zero momentum boundary case):\n  - $I = \\operatorname{diag}(1.0, 1.2, 1.4)$.\n  - $R(0)$ is a rotation by angle $1.2$ about the $y$-axis.\n  - $h(t) = [0.0, 0.0, 0.0]$ (constant zero).\n  - $T = 1.0$, $dt = 0.01$.\n- Case 3 (axis-symmetric inertia):\n  - $I = \\operatorname{diag}(2.0, 2.0, 1.0)$.\n  - $R(0)$ is a rotation by angle $\\pi/2$ about the $x$-axis.\n  - $h(t) = [0.0, 0.2, 0.0]$ (constant).\n  - $T = 2.0$, $dt = 0.002$.\n- Case 4 (time-varying momentum edge case):\n  - $I = \\operatorname{diag}(1.0, 1.5, 2.0)$.\n  - $R(0) = I_3$.\n  - $h(t) = 0.3 \\, [\\sin(0.5 t), \\cos(0.3 t), 0.2 \\sin(0.7 t + 0.1)]$.\n  - $T = 3.0$, $dt = 0.0015$.\n\nYour program must compute the final misalignment angle $\\theta$ for each case and produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[0.000001,0.000002,0.000003,0.000004]\"). Each entry must be a floating-point number in radians. The program must be fully self-contained, must not read any external input, and must not access external resources.",
            "solution": "The problem requires the reconstruction of rigid body attitude dynamics from a specified spatial angular momentum history. This is a classic problem in geometric mechanics. We will first validate the problem statement, then derive two equivalent numerical methods for propagating the attitude dynamics, and finally implement them to verify their consistency.\n\n### Problem Validation\nThe problem is deemed valid. It is scientifically sound, well-posed, objective, and self-contained. It is grounded in the established principles of rigid body mechanics on Lie groups ($SO(3)$). All necessary data, including initial conditions ($R(0)$), system parameters (inertia tensor $I$), and driving functions (spatial angular momentum $h(t)$), are provided. The task is to implement and compare two standard numerical schemes on Lie groups, which is a meaningful and non-trivial exercise in computational geometric mechanics. No flaws as per the validation checklist are present.\n\n### Theoretical Derivation\n\n**1. Kinematics and Momenta**\n\nThe attitude of the rigid body is described by a rotation matrix $R(t) \\in SO(3)$, which maps vectors from a body-fixed frame to a spatial (inertial) frame. The group $SO(3)$ is the group of $3 \\times 3$ orthogonal matrices with determinant $+1$. Its Lie algebra, $\\mathfrak{so}(3)$, consists of $3 \\times 3$ skew-symmetric matrices.\n\nThe time evolution of the attitude is governed by the kinematic equation. In the body frame, this is\n$$ \\dot{R}(t) = R(t) \\widehat{\\Omega}(t) $$\nwhere $\\Omega(t) \\in \\mathbb{R}^3$ is the body angular velocity vector, and the hat map $\\widehat{(\\cdot)}: \\mathbb{R}^3 \\to \\mathfrak{so}(3)$ is defined by the matrix representation of the cross product, $\\widehat{v}w = v \\times w$.\n\nIn the spatial frame, the kinematic equation is\n$$ \\dot{R}(t) = \\widehat{\\omega}(t) R(t) $$\nwhere $\\omega(t) \\in \\mathbb{R}^3$ is the spatial angular velocity. The two velocities are related by $\\omega(t) = R(t) \\Omega(t)$.\n\nThe inertia of the body is given by the diagonal inertia tensor $I = \\operatorname{diag}(I_1, I_2, I_3)$ in the body frame. The angular momentum in the body frame is $\\Pi(t) = I \\Omega(t)$. The angular momentum in the spatial frame, which is provided as a given function $h(t)$, is related to the body momentum via the attitude matrix:\n$$ h(t) = R(t) \\Pi(t) = R(t) I \\Omega(t) $$\nThis expression forms the basis for our reconstruction.\n\n**2. Method 1: Reconstruction from Body-Frame Velocity**\n\nThe first method, termed \"reconstruction,\" propagates the attitude using the body-frame kinematic equation, $\\dot{R} = R \\widehat{\\Omega}$. To do this, we must determine the body angular velocity $\\Omega(t)$ from the given spatial momentum $h(t)$ and the current attitude $R(t)$. By inverting the relationship for $h(t)$ and using the property that $R(t)^{-1} = R(t)^\\top$ for $R(t) \\in SO(3)$, we find the connection:\n$$ \\Omega(t) = I^{-1} R(t)^\\top h(t) $$\nSubstituting this into the kinematic equation gives the reconstruction ordinary differential equation (ODE):\n$$ \\dot{R}(t) = R(t) \\, \\widehat{I^{-1} R(t)^\\top h(t)} $$\nTo integrate this ODE numerically while preserving the $SO(3)$ structure of $R(t)$, we employ a Lie group integrator. For a time step $dt$, the attitude at time $t_{k+1} = t_k + dt$ is updated from the attitude $R_k = R(t_k)$ as:\n$$ R_{k+1} = R_k \\exp(\\widehat{\\Omega_k} dt) $$\nwhere $\\Omega_k = I^{-1} R_k^\\top h(t_k)$, and $\\exp(\\cdot)$ is the matrix exponential mapping from the Lie algebra $\\mathfrak{so}(3)$ to the Lie group $SO(3)$. This update rule corresponds to a right-multiplication of the current attitude by an incremental rotation generated by the body velocity.\n\n**3. Method 2: Direct Integration in the Spatial Frame**\n\nThe second method uses the spatial-frame kinematic equation, $\\dot{R} = \\widehat{\\omega} R$. Here, we need to express the spatial angular velocity $\\omega(t)$ in terms of $h(t)$ and $R(t)$. Using the relationship $\\omega = R\\Omega$ and the expression for $\\Omega$ from the previous section:\n$$ \\omega(t) = R(t) \\Omega(t) = R(t) (I^{-1} R(t)^\\top h(t)) = (R(t) I^{-1} R(t)^\\top) h(t) $$\nThe term $I_s^{-1}(t) \\equiv R(t) I^{-1} R(t)^\\top$ represents the inverse of the inertia tensor as seen in the spatial frame. The resulting ODE is:\n$$ \\dot{R}(t) = \\widehat{(R(t) I^{-1} R(t)^\\top h(t))} \\, R(t) $$\nThe corresponding Lie group integration step is:\n$$ R_{k+1} = \\exp(\\widehat{\\omega_k} dt) R_k $$\nwhere $\\omega_k = (R_k I^{-1} R_k^\\top) h(t_k)$. This update rule corresponds to a left-multiplication of the current attitude by an incremental rotation generated by the spatial velocity.\n\n**4. Equivalence of the Methods**\n\nAnalytically, the two methods are equivalent. To demonstrate this, we show that the two numerical update rules produce the same result. The spatial update is $R'_{k+1} = \\exp(\\widehat{\\omega_k} dt) R_k$. We use the identity relating the exponential map and the Adjoint representation of the Lie group: $\\exp(\\operatorname{Ad}_g(X)) = g \\exp(X) g^{-1}$. In matrix form for $SO(3)$, this is $\\exp(\\widehat{gv}) = R \\exp(\\widehat{v}) R^\\top$, where $g=R$ is a rotation matrix.\nSince $\\omega_k = R_k\\Omega_k$, we have $\\widehat{\\omega_k} dt = \\widehat{R_k \\Omega_k dt} = R_k \\widehat{\\Omega_k dt} R_k^\\top$.\nSubstituting this into the spatial update rule:\n$$ R'_{k+1} = \\exp(R_k \\widehat{\\Omega_k dt} R_k^\\top) R_k = (R_k \\exp(\\widehat{\\Omega_k dt}) R_k^\\top) R_k $$\n$$ R'_{k+1} = R_k \\exp(\\widehat{\\Omega_k dt}) (R_k^\\top R_k) = R_k \\exp(\\widehat{\\Omega_k dt}) I_3 = R_k \\exp(\\widehat{\\Omega_k dt}) $$\nThis is precisely the update rule for the reconstruction method, $R_{k+1}$. Thus, $R'_{k+1} = R_{k+1}$. The two methods are mathematically identical, and any difference in their numerical output will be attributable solely to floating-point arithmetic errors, which are expected to be very small.\n\n**5. Numerical Implementation Details**\n\n- **Exponential Map on $\\mathfrak{so}(3)$**: The mapping $\\exp: \\mathfrak{so}(3) \\to SO(3)$ is computed using Rodrigues' formula. For a rotation vector $v \\in \\mathbb{R}^3$, let $\\theta = \\|v\\|$ be the rotation angle and $u = v/\\theta$ be the rotation axis (for $\\theta \\ne 0$). The rotation matrix is given by:\n  $$ \\exp(\\widehat{v}) = I_3 + \\sin(\\theta)\\widehat{u} + (1-\\cos(\\theta))\\widehat{u}^2 $$\n  For the case $\\theta = 0$, $\\exp(\\widehat{\\mathbf{0}}) = I_3$. A small tolerance is used in implementation to handle the $\\theta \\approx 0$ case.\n\n- **Misalignment Angle**: To compare the final attitudes $R_{\\mathrm{rec}}(T)$ and $R_{\\mathrm{dir}}(T)$, we compute the relative rotation matrix $R_{\\mathrm{rel}} = R_{\\mathrm{dir}}(T)^\\top R_{\\mathrm{rec}}(T)$. The angle of this rotation, $\\theta$, is found from its trace: $\\operatorname{trace}(R_{\\mathrm{rel}}) = 1 + 2\\cos(\\theta)$. This gives the formula specified in the problem:\n  $$ \\theta = \\arccos\\left(\\frac{\\operatorname{trace}(R_{\\mathrm{dir}}(T)^\\top R_{\\mathrm{rec}}(T)) - 1}{2}\\right) $$\n  To avoid numerical domain errors in `arccos` due to floating-point representation, the argument must be clipped to the valid range $[-1, 1]$.",
            "answer": "```python\nimport numpy as np\n\ndef hat(v):\n    \"\"\"\n    Maps a vector in R^3 to its corresponding skew-symmetric matrix in so(3).\n    \"\"\"\n    return np.array([[0, -v[2], v[1]],\n                     [v[2], 0, -v[0]],\n                     [-v[1], v[0], 0]])\n\ndef rodrigues(v):\n    \"\"\"\n    Computes the matrix exponential exp(hat(v)) for v in R^3 using Rodrigues' formula.\n    This maps an element of the Lie algebra so(3) to the Lie group SO(3).\n    \"\"\"\n    theta = np.linalg.norm(v)\n    if theta  1e-12:  # Use a small tolerance for floating point zero\n        return np.eye(3)\n    \n    u = v / theta\n    u_hat = hat(u)\n    u_hat_sq = u_hat @ u_hat\n    \n    return np.eye(3) + np.sin(theta) * u_hat + (1 - np.cos(theta)) * u_hat_sq\n\ndef solve_case(I_diag, R0, h_func, T, dt):\n    \"\"\"\n    Solves a single case by running both reconstruction and direct integration methods.\n    Returns the final misalignment angle between the two resulting attitudes.\n    \"\"\"\n    I = np.diag(I_diag)\n    I_inv = np.linalg.inv(I)\n    \n    # Initialize states for both methods\n    R_rec = R0.copy()\n    R_dir = R0.copy()\n    \n    num_steps = int(T / dt)\n    t = 0.0\n    \n    for _ in range(num_steps):\n        h = h_func(t)\n        \n        # Method 1: Reconstruction via connection\n        Omega = I_inv @ R_rec.T @ h\n        delta_R_rec = rodrigues(Omega * dt)\n        R_rec = R_rec @ delta_R_rec\n        \n        # Method 2: Direct spatial-frame integration\n        omega = (R_dir @ I_inv @ R_dir.T) @ h\n        delta_R_dir = rodrigues(omega * dt)\n        R_dir = delta_R_dir @ R_dir\n        \n        t += dt\n\n    # Compute final misalignment angle\n    R_misalign = R_dir.T @ R_rec\n    # The trace is related to the rotation angle by trace = 1 + 2*cos(theta)\n    trace = np.trace(R_misalign)\n    \n    # Clip argument to arccos to handle potential floating point inaccuracies\n    # pushing the value slightly outside [-1, 1]\n    arg = np.clip((trace - 1.0) / 2.0, -1.0, 1.0)\n    theta = np.arccos(arg)\n    \n    return theta\n\ndef solve():\n    \"\"\"\n    Main function to define and run all test cases, then print results.\n    \"\"\"\n    test_cases = [\n        # Case 1 (general case)\n        {\n            \"I_diag\": [2.0, 1.5, 1.0],\n            \"R0\": np.eye(3),\n            \"h_func\": lambda t: np.array([0.3, 0.4, 0.5]),\n            \"T\": 1.0,\n            \"dt\": 0.001\n        },\n        # Case 2 (zero momentum boundary case)\n        {\n            \"I_diag\": [1.0, 1.2, 1.4],\n            \"R0\": rodrigues(np.array([0.0, 1.2, 0.0])), # Rotation by 1.2 rad about y-axis\n            \"h_func\": lambda t: np.array([0.0, 0.0, 0.0]),\n            \"T\": 1.0,\n            \"dt\": 0.01\n        },\n        # Case 3 (axis-symmetric inertia)\n        {\n            \"I_diag\": [2.0, 2.0, 1.0],\n            \"R0\": rodrigues(np.array([np.pi/2.0, 0.0, 0.0])), # Rotation by pi/2 rad about x-axis\n            \"h_func\": lambda t: np.array([0.0, 0.2, 0.0]),\n            \"T\": 2.0,\n            \"dt\": 0.002\n        },\n        # Case 4 (time-varying momentum edge case)\n        {\n            \"I_diag\": [1.0, 1.5, 2.0],\n            \"R0\": np.eye(3),\n            \"h_func\": lambda t: 0.3 * np.array([\n                np.sin(0.5 * t), \n                np.cos(0.3 * t), \n                0.2 * np.sin(0.7 * t + 0.1)\n            ]),\n            \"T\": 3.0,\n            \"dt\": 0.0015\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = solve_case(case[\"I_diag\"], case[\"R0\"], case[\"h_func\"], case[\"T\"], case[\"dt\"])\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}