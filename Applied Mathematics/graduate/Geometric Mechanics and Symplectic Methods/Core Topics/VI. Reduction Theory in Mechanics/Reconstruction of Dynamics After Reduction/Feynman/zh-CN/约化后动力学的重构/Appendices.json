{
    "hands_on_practices": [
        {
            "introduction": "重构动力学的过程依赖于主联络的几何结构。此联络决定了如何将路径从约化的底空间“提升”回完整的位形空间。联络的一个关键性质是其曲率，它衡量了平行输运的路径依赖性，这正是几何相位或完整相的本质。第一个练习  将指导你完成从度量出发构造机械联络并计算其曲率的基本过程，为重构理论奠定几何基础。",
            "id": "3763937",
            "problem": "考虑位形空间 $Q=\\mathbb{R}^{3}\\setminus\\{0\\}$，其上赋予了标准的欧几里得度量以及李群 $G=\\mathrm{SO}(2)$ 绕 $z$ 轴旋转的作用。用 $(r,\\phi,z)$ 表示 $Q$ 上的柱坐标，其中 $r=\\sqrt{x^{2}+y^{2}}$，$\\phi=\\arctan2(y,x)$ 且 $z\\in\\mathbb{R}$。群 $\\mathrm{SO}(2)$ 的作用是平移角度 $\\phi$，同时保持 $r$ 和 $z$ 不变。\n\n在作用是自由的正则部分 $Q_{\\mathrm{reg}}=\\{(r,\\phi,z)\\in Q \\mid r>0\\}$ 上，仅使用以下输入，将机械联络构造为该主丛 $\\pi:Q_{\\mathrm{reg}}\\to Q_{\\mathrm{reg}}/\\mathrm{SO}(2)$ 上的一个 $\\mathfrak{so}(2)$ 值的 Ehresmann 联络：\n- 主联络 1-形式 $A:TQ_{\\mathrm{reg}}\\to\\mathfrak{so}(2)$ 的定义，即 $A$ 是 $\\mathrm{SO}(2)$-等变的，并且在基本向量场上再生生成元，\n- $Q_{\\mathrm{reg}}$ 上的欧几里得黎曼度量，通过与群轨道的正交性来定义机械联络。\n\n然后，使用 $F=\\mathrm{d}A+\\tfrac{1}{2}[A\\wedge A]$ 计算此联络的曲率 2-形式 $F\\in\\Omega^{2}(Q_{\\mathrm{reg}};\\mathfrak{so}(2))$，并用坐标 $(r,\\phi,z)$ 明确表示你的最终结果。\n\n你的最终答案必须是曲率 2-形式的单个闭式解析表达式。不需要数值近似，也不涉及单位。如果需要，请用弧度表示角度。最终答案必须只是一个单独的表达式。",
            "solution": "我们首先回顾一下基本结构。群 $G=\\mathrm{SO}(2)$ 的李代数为 $\\mathfrak{so}(2)\\cong\\mathbb{R}$，它是阿贝尔的。$G$ 在 $Q$ 上的作用是绕 $z$ 轴的旋转，在柱坐标 $(r,\\phi,z)$ 下，该作用由 $(r,\\phi,z)\\mapsto(r,\\phi+\\theta,z)$ 给出，其中 $\\theta\\in\\mathbb{R}/2\\pi\\mathbb{Z}$。在正则集 $Q_{\\mathrm{reg}}=\\{r>0\\}$ 上，此作用是自由且正常的，从而产生一个主 $\\mathrm{SO}(2)$-丛 $\\pi:Q_{\\mathrm{reg}}\\to B$，其中底空间 $B=Q_{\\mathrm{reg}}/\\mathrm{SO}(2)$ 可被等同于具有坐标 $(r,z)$ 的半平面。\n\n该主丛上的一个 Ehresmann 联络可以通过一个主联络 1-形式 $A\\in\\Omega^{1}(Q_{\\mathrm{reg}};\\mathfrak{so}(2))$ 来指定，该形式满足：\n1. $A$ 是 $\\mathrm{SO}(2)$-等变的，\n2. $A$ 在基本向量场上再生生成元，即对所有 $\\xi\\in\\mathfrak{so}(2)$，有 $A(\\xi_{Q})=\\xi$，其中 $\\xi_{Q}$ 表示由 $\\xi$ 在 $Q_{\\mathrm{reg}}$ 上生成的基本向量场。\n\n我们使用 $Q_{\\mathrm{reg}}$ 上的欧几里得度量 $g$ 来构造机械联络。机械联络的定义是：在 $q\\in Q_{\\mathrm{reg}}$ 处的水平子空间是垂直子空间的 $g$-正交补，而垂直子空间是过 $q$ 点的轨道的切空间。等价地，主联络 1-形式 $A$ 由以下常用公式（在一维阿贝尔情形下）给出：\n$$\nA_{q}(v)=\\frac{g_{q}\\big(v,\\xi_{Q}(q)\\big)}{g_{q}\\big(\\xi_{Q}(q),\\xi_{Q}(q)\\big)},\n$$\n其中我们作等同 $\\mathfrak{so}(2)\\cong\\mathbb{R}$，使得一个固定的生成元 $\\xi=1\\in\\mathbb{R}$ 对应于基本向量场 $\\xi_{Q}$。在柱坐标下，欧几里得度量为\n$$\ng= \\mathrm{d}r^{2}+r^{2}\\,\\mathrm{d}\\phi^{2}+\\mathrm{d}z^{2}.\n$$\n生成元 $\\xi=1$ 的基本向量场是对应于 $\\phi$ 增加的无穷小作用，即\n$$\n\\xi_{Q}=\\frac{\\partial}{\\partial \\phi}.\n$$\n我们计算它关于 $g$ 的范数：\n$$\ng\\!\\left(\\frac{\\partial}{\\partial \\phi},\\frac{\\partial}{\\partial \\phi}\\right)=r^{2}.\n$$\n$\\frac{\\partial}{\\partial \\phi}$ 的 $g$-对偶 1-形式是 $r^{2}\\,\\mathrm{d}\\phi$，因此对于任意 $v\\in T_{q}Q_{\\mathrm{reg}}$，\n$$\ng\\!\\left(v,\\frac{\\partial}{\\partial \\phi}\\right)=r^{2}\\,\\mathrm{d}\\phi(v).\n$$\n因此，机械联络 1-形式为\n$$\nA=\\frac{r^{2}\\,\\mathrm{d}\\phi}{r^{2}}=\\mathrm{d}\\phi,\n$$\n将其视为一个 $\\mathfrak{so}(2)\\cong\\mathbb{R}$ 值的 1-形式。\n\n我们现在通过定义来计算曲率 2-形式 $F\\in\\Omega^{2}(Q_{\\mathrm{reg}};\\mathfrak{so}(2))$\n$$\nF=\\mathrm{d}A+\\frac{1}{2}[A\\wedge A].\n$$\n因为 $\\mathfrak{so}(2)\\cong\\mathbb{R}$ 是阿贝尔的，所以李括号项为零：\n$$\n[A\\wedge A]=0.\n$$\n因此\n$$\nF=\\mathrm{d}A=\\mathrm{d}(\\mathrm{d}\\phi)=0,\n$$\n这是在正则域 $Q_{\\mathrm{reg}}$ 上的普通外微分，其中 $(r,\\phi,z)$ 是有效的局部坐标。因此，该机械联络在 $Q_{\\mathrm{reg}}$ 上的曲率 2-形式恒为零。\n\n从约化后动力学重构的角度来看，这个结果意味着由机械联络定义的水平分布是可积的，并且在底空间 $B$ 的单连通分支上，平行输运与路径无关。因此，群变量在底空间中绕任何可缩闭路累积的几何相位是平凡的，这与 $F=0$ 一致。\n\n因此，在 $Q_{\\mathrm{reg}}$ 上的坐标 $(r,\\phi,z)$ 中，曲率 2-形式明确地为零 2-形式：\n$$\nF=0.\n$$",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "在奠定了坚实的几何基础之后，我们现在来解决一个完整的端到端问题。这个练习  从一个在圆柱体上运动的粒子的拉格朗日量出发，要求你执行辛约化，然后重构整个系统的轨迹。这个实践将巩固拉格朗日和哈密顿框架之间的相互作用，并展示如何利用守恒动量和联络来明确求解系统随时间的演化。",
            "id": "3763982",
            "problem": "考虑一个质量为 $m>0$ 的单个粒子，其组态流形为 $Q=S^{1}\\times\\mathbb{R}$，全局坐标为 $(\\theta,z)$，其中 $\\theta\\in S^{1}$ 是一个角度，$z\\in\\mathbb{R}$ 是一个轴向位置。设对称群为 $G=S^{1}$，通过 $\\theta$ 坐标的旋转作用于 $Q$。为 $Q$ 配备由 G-不变拉格朗日量编码的卡鲁扎-克莱因动能度规\n$$\nL(\\theta,z,\\dot{\\theta},\\dot{z})=\\frac{m}{2}\\left[R^{2}\\left(\\dot{\\theta}+c\\,\\dot{z}\\right)^{2}+\\dot{z}^{2}\\right],\n$$\n其中 $R>0$ 是一个固定的几何尺度，$c\\in\\mathbb{R}$ 是一个固定常数，它确定了平凡主丛 $Q\\to Q/G\\cong\\mathbb{R}$ 上一个选定的平坦主联络 $A=d\\theta+c\\,dz$。假设没有势能。设相空间为余切丛 $T^{\\ast}Q$，其上具有典范辛形式。与 G-作用相关联的余切提升动量映射 $J:T^{\\ast}Q\\to\\mathfrak{g}^{\\ast}\\cong\\mathbb{R}$ 表示为 $J(\\theta,z,p_{\\theta},p_{z})=p_{\\theta}$，其中 $(p_{\\theta},p_{z})$ 是典范动量。\n\n你将通过 Marsden–Weinstein 约化 (MWR) 在固定值 $J=\\mu\\in\\mathbb{R}$ 处进行辛约化。从第一性原理（典范辛结构、勒让德变换和哈密顿方程）出发，推导 $T^{\\ast}(Q/G)\\cong T^{\\ast}\\mathbb{R}$ 上的约化动力学，然后使用指定的平坦联络 $A$ 重构 $Q$ 上的完整轨迹。假设 $t=0$ 时的初始条件由以下给出\n- $z(0)=z_{0}$，\n- $\\theta(0)=\\theta_{0}$，\n- $p_{z}(0)=p_{z0}$，\n以及约化水平集条件 $p_{\\theta}(t)\\equiv\\mu$。\n\n以时间的函数 $t$ 的显式闭合形式，计算重构轨迹 $q(t)=(\\theta(t),z(t))$。将角度 $\\theta(t)$ 以弧度表示。将最终答案以包含 $(\\theta(t),z(t))$ 的双元行矩阵形式给出。无需四舍五入；给出精确的解析表达式。",
            "solution": "该问题陈述是适定的，在几何力学框架内具有科学依据，并提供了所有必要的信息和条件来确定一个唯一的、有意义的解。陈述中没有矛盾、歧义或事实上的不健全之处。因此，我们可以进行推导。\n\n目标是确定质量为 $m$ 的粒子轨迹 $q(t) = (\\theta(t), z(t))$，该粒子由以下拉格朗日量描述：\n$$\nL(\\theta,z,\\dot{\\theta},\\dot{z})=\\frac{m}{2}\\left[R^{2}\\left(\\dot{\\theta}+c\\,\\dot{z}\\right)^{2}+\\dot{z}^{2}\\right]\n$$\n此过程涉及过渡到哈密顿表述，进行辛约化，求解约化动力学，然后重构完整轨迹。\n\n首先，我们进行勒让德变换以求出典范动量 $(p_{\\theta}, p_{z})$。\n共轭于 $\\theta$ 的动量是：\n$$\np_{\\theta} = \\frac{\\partial L}{\\partial \\dot{\\theta}} = \\frac{m}{2} \\cdot 2 R^{2} (\\dot{\\theta} + c\\,\\dot{z}) \\cdot 1 = mR^{2}(\\dot{\\theta} + c\\dot{z})\n$$\n共轭于 $z$ 的动量是：\n$$\np_{z} = \\frac{\\partial L}{\\partial \\dot{z}} = \\frac{m}{2} \\left[ 2 R^{2} (\\dot{\\theta} + c\\,\\dot{z}) \\cdot c + 2\\dot{z} \\right] = mcR^{2}(\\dot{\\theta} + c\\dot{z}) + m\\dot{z}\n$$\n将 $p_{\\theta}$ 的表达式代入 $p_{z}$ 的表达式中，我们得到一个更简单的关系：\n$$\np_{z} = c p_{\\theta} + m\\dot{z}\n$$\n接下来，我们用动量 $(p_{\\theta}, p_z)$ 来表示速度 $(\\dot{\\theta}, \\dot{z})$。根据 $p_z$ 的关系式：\n$$\n\\dot{z} = \\frac{p_{z} - c p_{\\theta}}{m}\n$$\n根据 $p_{\\theta}$ 的关系式：\n$\\dot{\\theta} + c\\dot{z} = \\frac{p_{\\theta}}{mR^{2}} \\implies \\dot{\\theta} = \\frac{p_{\\theta}}{mR^{2}} - c\\dot{z}$\n代入 $\\dot{z}$ 的表达式：\n$$\n\\dot{\\theta} = \\frac{p_{\\theta}}{mR^{2}} - c\\left(\\frac{p_{z} - c p_{\\theta}}{m}\\right) = \\frac{p_{\\theta}}{mR^{2}} - \\frac{cp_z}{m} + \\frac{c^2 p_{\\theta}}{m} = \\frac{1}{m}\\left(\\frac{1}{R^2} + c^2\\right)p_{\\theta} - \\frac{c}{m}p_z\n$$\n哈密顿量 $H$ 定义为 $H = p_{\\theta}\\dot{\\theta} + p_{z}\\dot{z} - L$。由于拉格朗日量是速度的齐次二次函数且没有势能，哈密顿量等于用动量表示的动能。\n$$\nH(p_{\\theta}, p_{z}) = \\frac{m}{2}\\left[R^{2}\\left(\\frac{p_{\\theta}}{mR^2}\\right)^{2} + \\left(\\frac{p_{z} - c p_{\\theta}}{m}\\right)^{2}\\right] = \\frac{1}{2m}\\left[\\frac{p_{\\theta}^2}{R^2} + (p_{z} - c p_{\\theta})^2\\right]\n$$\n展开此表达式，得到哈密顿量的显式形式：\n$$\nH(p_{\\theta}, p_{z}) = \\frac{1}{2m}\\left[\\left(\\frac{1}{R^2} + c^2\\right)p_{\\theta}^2 - 2c p_{\\theta}p_{z} + p_{z}^2\\right]\n$$\n哈密顿运动方程由 $\\dot{q}^i = \\partial H / \\partial p_i$ 和 $\\dot{p}_i = - \\partial H / \\partial q^i$ 给出。对于我们的系统，这得出：\n$$\n\\dot{\\theta} = \\frac{\\partial H}{\\partial p_{\\theta}} = \\frac{1}{m}\\left[\\left(\\frac{1}{R^2} + c^2\\right)p_{\\theta} - c p_{z}\\right]\n$$\n$$\n\\dot{z} = \\frac{\\partial H}{\\partial p_{z}} = \\frac{1}{m}\\left[-c p_{\\theta} + p_{z}\\right]\n$$\n$$\n\\dot{p_{\\theta}} = -\\frac{\\partial H}{\\partial \\theta} = 0\n$$\n$$\n\\dot{p_{z}} = -\\frac{\\partial H}{\\partial z} = 0\n$$\n方程 $\\dot{p_{\\theta}} = 0$ 和 $\\dot{p_{z}} = 0$ 表明 $p_{\\theta}$ 和 $p_{z}$ 是守恒量，这是预料之中的，因为哈密顿量不依赖于 $\\theta$ 或 $z$。\n\n我们现在在水平集 $J=p_{\\theta}=\\mu$ 处进行辛约化。这与动力学是一致的，因为 $p_{\\theta}$ 是一个运动常数。约化相空间是 $T^*(Q/G) \\cong T^*\\mathbb{R}$，坐标为 $(z, p_z)$。该空间上的约化哈密顿量 $h_{\\mu}$ 是通过将 $p_{\\theta} = \\mu$ 代入 $H$ 得到的：\n$$\nh_{\\mu}(p_z) = H(\\mu, p_{z}) = \\frac{1}{2m}\\left[\\left(\\frac{1}{R^2} + c^2\\right)\\mu^2 - 2c \\mu p_{z} + p_{z}^2\\right]\n$$\n约化相空间上的动力学由 $h_{\\mu}$ 的哈密顿方程控制：\n$$\n\\dot{z} = \\frac{\\partial h_{\\mu}}{\\partial p_z} = \\frac{1}{2m}(-2c\\mu + 2p_z) = \\frac{p_z - c\\mu}{m}\n$$\n$$\n\\dot{p_z} = -\\frac{\\partial h_{\\mu}}{\\partial z} = 0\n$$\n方程 $\\dot{p_z}=0$ 意味着 $p_z$ 在约化相空间上是常数。使用初始条件 $p_z(0) = p_{z0}$，我们得到对于所有时间 $t$，$p_z(t) = p_{z0}$。\n将此代入 $\\dot{z}$ 的方程，我们发现速度 $\\dot{z}$ 也是常数：\n$$\n\\dot{z}(t) = \\frac{p_{z0} - c\\mu}{m}\n$$\n将此方程对时间 $t$ 积分，并应用初始条件 $z(0)=z_0$，我们得到 $z(t)$ 的轨迹：\n$$\nz(t) = z(0) + \\int_0^t \\frac{p_{z0} - c\\mu}{m} \\,d\\tau = z_0 + \\left(\\frac{p_{z0} - c\\mu}{m}\\right)t\n$$\n为了找到完整轨迹，我们必须重构群变量 $\\theta$ 的动力学。我们使用 $\\dot{\\theta}$ 的完整哈密顿方程，并代入运动常数 $p_{\\theta}=\\mu$ 和 $p_z=p_{z0}$：\n$$\n\\dot{\\theta}(t) = \\frac{1}{m}\\left[\\left(\\frac{1}{R^2} + c^2\\right)\\mu - c p_{z0}\\right]\n$$\n角速度 $\\dot{\\theta}$ 也是常数。对时间积分并应用初始条件 $\\theta(0)=\\theta_0$，我们得到 $\\theta(t)$ 的轨迹：\n$$\n\\theta(t) = \\theta(0) + \\int_0^t \\frac{1}{m}\\left[\\left(\\frac{1}{R^2} + c^2\\right)\\mu - c p_{z0}\\right] \\,d\\tau = \\theta_0 + \\frac{1}{m}\\left[\\left(\\frac{1}{R^2} + c^2\\right)\\mu - c p_{z0}\\right]t\n$$\n综合这些结果，重构的轨迹 $q(t) = (\\theta(t), z(t))$ 由以下给出：\n$$\n\\theta(t) = \\theta_0 + \\frac{1}{m}\\left[\\left(\\frac{1}{R^2} + c^2\\right)\\mu - c p_{z0}\\right]t\n$$\n$$\nz(t) = z_0 + \\frac{p_{z0} - c\\mu}{m}t\n$$\n这为粒子的运动提供了显式的闭合形式解。该轨迹是圆柱体 $Q=S^1 \\times \\mathbb{R}$ 上的一条螺旋线，具有恒定的线速度和角速度。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\theta_0 + \\frac{1}{m}\\left(\\left(\\frac{1}{R^2} + c^2\\right)\\mu - c p_{z0}\\right)t & z_0 + \\frac{p_{z0} - c\\mu}{m}t \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "尽管解析解能提供深刻的洞察力，但许多现实世界中的系统需要借助数值方法。最后一个练习  通过要求你实现一个数值方案来执行重构，从而在理论和计算之间架起一座桥梁。通过沿底空间中的不同路径对重构方程进行积分，你将直接计算出累积的几何相位，即完整相，从而对联络的几何性质如何影响动力学获得具体且定量的理解。",
            "id": "3763948",
            "problem": "考虑由投影 $\\pi: Q \\to Q/G$ 给出的平凡主纤维丛，其总空间为 $Q = \\mathbb{R}^2 \\times S^1$，底为 $Q/G = \\mathbb{R}^2$，结构群为 $G = S^1$，通过对纤维坐标的右平移作用于 $Q$。设 $(x,y) \\in \\mathbb{R}^2$ 为底坐标，$\\theta \\in S^1$ 为纤维角坐标。为 $Q$ 配备主联络1-形式\n$$\n\\mathcal{A} = d\\theta + \\frac{B}{2}\\left(-y\\,dx + x\\,dy\\right),\n$$\n其中 $B \\in \\mathbb{R}$ 是一个常数。沿提升曲线 $q(t) = (x(t),y(t),\\theta(t))$ 的水平条件是 $\\mathcal{A}(\\dot q(t)) = 0$，这产生标量常微分方程 (ODE)\n$$\n\\dot{\\theta}(t) = -\\frac{B}{2}\\left(-y(t)\\,\\dot{x}(t) + x(t)\\,\\dot{y}(t)\\right) = \\frac{B}{2}\\left(y(t)\\,\\dot{x}(t) - x(t)\\,\\dot{y}(t)\\right).\n$$\n这个 ODE 通过局部平凡化 $q(t) = g(t)\\cdot s(x(t),y(t))$ 和局部截面 $s(x,y) = (x,y,0)$ 来重构群变量 $g(t) \\in S^1$，因为 $g(t)$ 对应于纤维角 $\\theta(t)$，且有 $g(t) = e^{i\\theta(t)}$。假设初始条件为 $\\theta(0) = 0$，因此 $g(0) = 1$。\n\n您的任务是实现一个基于平行输运的数值方法，通过对给定的底曲线 $(x(t),y(t))$ 积分上述 ODE 来重构 $g(t)$（等价于 $\\theta(t)$）。使用固定步长四阶龙格-库塔方法在时间区间 $t \\in [0,T]$ 上对 $\\dot{\\theta}(t)$ 进行积分。所有角度必须用弧度表示。\n\n实现一个程序，该程序：\n- 对于每个测试用例，在 $[0,T]$上定义一条光滑的底曲线 $(x(t),y(t))$ 及其时间导数 $(\\dot{x}(t),\\dot{y}(t))$。\n- 在初始条件 $\\theta(0)=0$ 下对 $\\theta(t)$ 的 ODE 进行积分，以获得 $\\theta(T)$。\n- 为下面的测试套件输出最终角度 $\\theta(T)$ 的列表。\n\n使用以下测试套件，它探究了一条直线路径、零曲率情况以及两个具有已知完整体的闭合环路。在所有情况下，将最终角度 $\\theta(T)$ 报告为以弧度为单位的实数。\n\n测试用例：\n1. B 不为零的直线：\n   - 参数：$B = 1$, $x(t) = t$, $y(t) = 0$, $t \\in [0,1]$。\n   - 预期的定性行为：对于所有 $t$，$\\dot{\\theta}(t) = 0$，因此 $\\theta(1) = 0$。\n2. 曲率为零的椭圆环路：\n   - 参数：$B = 0$, $x(t) = \\cos(3 t)$, $y(t) = 2\\sin(3 t)$, $t \\in [0, \\frac{2\\pi}{3}]$。\n   - 预期的定性行为：对于所有 $t$，$\\dot{\\theta}(t) = 0$，因此 $\\theta\\!\\left(\\frac{2\\pi}{3}\\right) = 0$。\n3. 曲率恒定的圆形环路：\n   - 参数：$B = \\frac{1}{2}$, $x(t) = 2\\cos(t)$, $y(t) = 2\\sin(t)$, $t \\in [0, 2\\pi]$。\n   - 注意：对于一个闭合环路，$\\theta(2\\pi) = -B \\,\\text{Area}$，其中 $\\text{Area} = \\pi R^2$。这里 $R = 2$，所以 $\\theta(2\\pi) = -B \\pi R^2 = -\\frac{1}{2}\\cdot \\pi \\cdot 4 = -2\\pi$。\n4. 曲率恒定的椭圆环路：\n   - 参数：$B = 1.2$, $x(t) = 3\\cos(2 t)$, $y(t) = \\sin(2 t)$, $t \\in [0, \\pi]$。\n   - 注意：对于椭圆 $x = a\\cos(\\omega t)$，$y = b\\sin(\\omega t)$，在一个完整周期 $T = \\frac{2\\pi}{\\omega}$ 内，$\\theta(T) = -B \\pi a b$。这里 $a = 3$, $b = 1$，并且区间 $[0,\\pi]$ 覆盖了一个完整周期，因为 $\\omega = 2$，所以 $\\theta(\\pi) = -1.2 \\cdot \\pi \\cdot 3 = -3.6\\pi$。\n\n角度单位说明：所有角度必须以弧度为单位。\n\n您的程序应生成单行输出，其中包含一个由四个最终角度组成的逗号分隔列表，每个角度四舍五入到 $8$ 位小数，并用方括号括起来（例如 $[\\theta_1,\\theta_2,\\theta_3,\\theta_4]$）。",
            "solution": "该问题已经过验证，被认为是合理的。这是一个在几何力学领域内适定的问题，具体涉及通过平行输运在主纤维丛上重构动力学。所有提供的数据和条件都是一致的，并且足以得出一个唯一且有意义的解。\n\n问题的核心是求解纤维角 $\\theta(t) \\in S^1$ 的标量常微分方程 (ODE)：\n$$\n\\dot{\\theta}(t) = \\frac{d\\theta}{dt} = \\frac{B}{2}\\left(y(t)\\,\\dot{x}(t) - x(t)\\,\\dot{y}(t)\\right)\n$$\n初始条件为 $\\theta(0) = 0$。对于每个测试用例，都给定了由坐标 $(x(t), y(t))$ 描述的底曲线以及常数 $B$。任务是找到时间区间 $t \\in [0, T]$ 结束时的最终角度 $\\theta(T)$。\n\n指定的数值方法是固定步长四阶龙格-库塔 ($RK4$) 方法。对于形式为 $\\dot{y} = f(t, y)$ 的一般一阶 ODE，$RK4$ 算法使用以下更新规则将解从时间 $t_n$ 推进到 $t_{n+1} = t_n + h$：\n$$\ny_{n+1} = y_n + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)\n$$\n其中 $h$ 是步长，中间斜率计算如下：\n$$\n\\begin{align*}\nk_1 = f(t_n, y_n) \\\\\nk_2 = f(t_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_1) \\\\\nk_3 = f(t_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_2) \\\\\nk_4 = f(t_n + h, y_n + h k_3)\n\\end{align*}\n$$\n\n在这个特定问题中，状态变量是 $y(t) = \\theta(t)$，右侧的函数是：\n$$\nf(t, \\theta) = \\frac{B}{2}\\left(y_{\\text{path}}(t)\\,\\dot{x}_{\\text{path}}(t) - x_{\\text{path}}(t)\\,\\dot{y}_{\\text{path}}(t)\\right)\n$$\n关键是要观察到这个函数 $f$ 仅依赖于时间 $t$（通过给定的路径函数 $x(t)$ 和 $y(t)$ 及其速度），并且独立于状态变量 $\\theta$。这简化了 $RK4$ 的计算，因为中间步骤中对状态变量的更新（$y_n + \\frac{h}{2}k_1$ 等）不影响 $f$ 的求值。\n\n解决方案的实现首先是创建一个通用函数，用于对任意 ODE 执行 $RK4$ 积分。该函数接受 ODE 函数 $f(t, y)$、初始值 $y_0$、时间区间 $[t_0, t_f]$ 和积分步数 $N$作为输入。步长是恒定的，$h = (t_f - t_0) / N$。选择一个较大的步数，如 $N=10000$，以确保高精度并展示该方法的鲁棒性。\n\n对于所提供的四个测试用例中的每一个，我们定义了具体的参数 ($B, T$) 以及底路径 ($x(t), y(t)$) 及其时间导数 ($\\dot{x}(t), \\dot{y}(t)$) 的函数。这些用于构建 ODE 的右侧函数 $f(t, \\theta)$。然后对每种情况，在各自的区间 $[0, T]$ 上，以初始条件 $\\theta_0 = 0$ 调用 $RK4$ 求解器。\n\n对测试用例的初步分析表明，在每种情况下，被积函数 $f(t, \\theta)$ 的计算结果都是一个常数。\n1.  对于情况 1 ($B=1, x(t)=t, y(t)=0$)，$f(t, \\theta) = \\frac{1}{2}(0 \\cdot 1 - t \\cdot 0) = 0$。精确解为 $\\theta(1)=0$。\n2.  对于情况 2 ($B=0$)，$f(t, \\theta) = 0$ 显然成立。精确解为 $\\theta(2\\pi/3)=0$。\n3.  对于情况 3 ($B=0.5, R=2$ 的圆)，$f(t, \\theta) = \\frac{0.5}{2}( (2\\sin t)(-2\\sin t) - (2\\cos t)(2\\cos t) ) = -1$。精确解为 $\\theta(2\\pi)=-2\\pi$。\n4.  对于情况 4 ($B=1.2$，椭圆 $a=3, b=1$)，$f(t, \\theta) = \\frac{1.2}{2}( (\\sin 2t)(-6\\sin 2t) - (3\\cos 2t)(2\\cos 2t)) = -3.6$。精确解为 $\\theta(\\pi)=-3.6\\pi$。\n\n对于次数最高为 4 的多项式被积函数，RK4 方法可以得到精确结果。由于在所有测试用例中被积函数都是常数（0 次多项式），因此所实现求解器的数值结果将与解析解在机器浮点精度范围内匹配。因此，该计算可用于验证 RK4 实现的正确性。然后收集最终值并按要求进行格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the final angle theta(T) for four different base curves\n    by numerically integrating the reconstruction ODE using the RK4 method.\n    \"\"\"\n\n    def rk4_integrator(f, y0, t_span, n_steps):\n        \"\"\"\n        Integrates a scalar ODE dy/dt = f(t, y) using the 4th-order Runge-Kutta method.\n\n        Args:\n            f (callable): The function f(t, y) representing the ODE.\n            y0 (float): The initial value y(t0).\n            t_span (tuple): A tuple (t0, tf) for the integration interval.\n            n_steps (int): The number of fixed steps to take.\n\n        Returns:\n            float: The value of y at tf.\n        \"\"\"\n        t0, tf = t_span\n        h = (tf - t0) / n_steps\n        t = t0\n        y = y0\n\n        for _ in range(n_steps):\n            k1 = f(t, y)\n            k2 = f(t + 0.5 * h, y + 0.5 * h * k1)\n            k3 = f(t + 0.5 * h, y + 0.5 * h * k2)\n            k4 = f(t + h, y + h * k3)\n            y = y + (h / 6.0) * (k1 + 2*k2 + 2*k3 + k4)\n            t += h\n        return y\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (B, T, x(t), y(t), dx/dt, dy/dt)\n    test_cases = [\n        # Case 1: Straight line\n        (1.0, 1.0, \n         lambda t: t, \n         lambda t: 0.0, \n         lambda t: 1.0, \n         lambda t: 0.0),\n        \n        # Case 2: Elliptical loop, B=0\n        (0.0, 2 * np.pi / 3.0,\n         lambda t: np.cos(3 * t),\n         lambda t: 2 * np.sin(3 * t),\n         lambda t: -3 * np.sin(3 * t),\n         lambda t: 6 * np.cos(3 * t)),\n         \n        # Case 3: Circular loop\n        (0.5, 2 * np.pi,\n         lambda t: 2 * np.cos(t),\n         lambda t: 2 * np.sin(t),\n         lambda t: -2 * np.sin(t),\n         lambda t: 2 * np.cos(t)),\n         \n        # Case 4: Elliptical loop\n        (1.2, np.pi,\n         lambda t: 3 * np.cos(2 * t),\n         lambda t: np.sin(2 * t),\n         lambda t: -6 * np.sin(2 * t),\n         lambda t: 2 * np.cos(2 * t))\n    ]\n\n    results = []\n    n_steps = 10000  # Number of steps for the RK4 integrator\n\n    for case in test_cases:\n        B, T, x_path, y_path, dx_path, dy_path = case\n        \n        # Define the ODE function dy/dt = f(t, y) for the current case.\n        # Note: the function is independent of y (theta)\n        def ode_func(t, theta):\n            xt = x_path(t)\n            yt = y_path(t)\n            dxt = dx_path(t)\n            dyt = dy_path(t)\n            return (B / 2.0) * (yt * dxt - xt * dyt)\n            \n        # Initial conditions\n        theta0 = 0.0\n        t_span = (0.0, T)\n        \n        # Solve the ODE to find theta(T)\n        theta_T = rk4_integrator(ode_func, theta0, t_span, n_steps)\n        results.append(theta_T)\n\n    # Format the results to 8 decimal places as a string\n    formatted_results = [f\"{res:.8f}\" for res in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}