{
    "hands_on_practices": [
        {
            "introduction": "The Liouville-Arnold theorem guarantees that the phase space of an integrable Hamiltonian system is foliated by invariant tori. This exercise  provides a foundational practice in making this abstract structure concrete by constructing the action-angle variables for the $n$-dimensional harmonic oscillator from first principles. Mastering this canonical example is essential for understanding how the dynamics on these tori simplifies to linear flow, setting the stage for perturbation theory.",
            "id": "3750346",
            "problem": "Consider the autonomous Hamiltonian system on $\\mathbb{R}^{2n}$ with the standard symplectic form $\\omega_{\\mathrm{std}} = \\sum_{i=1}^{n} \\mathrm{d}q_{i} \\wedge \\mathrm{d}p_{i}$ and Hamiltonian\n$$\nH(q,p) \\;=\\; \\sum_{i=1}^{n} \\left( \\frac{1}{2} \\, p_{i}^{2} \\;+\\; \\frac{1}{2} \\, \\omega_{i}^{2} \\, q_{i}^{2} \\right),\n$$\nwhere $q = (q_{1},\\dots,q_{n}) \\in \\mathbb{R}^{n}$, $p = (p_{1},\\dots,p_{n}) \\in \\mathbb{R}^{n}$, and each $\\omega_{i} \\in \\mathbb{R}_{>0}$ is a fixed positive constant. Starting from the fundamental definitions of symplectic geometry and Hamiltonian mechanics, do the following:\n\n- Derive the invariant Lagrangian tori associated with this integrable system as level sets of appropriately defined action variables. Explicitly identify the $n$ action variables $(I_{1},\\dots,I_{n})$ via the line integrals of the canonical one-form along the independent fundamental cycles of the invariant tori.\n- Construct a canonical transformation to action-angle coordinates $(I,\\theta) = \\big( (I_{1},\\dots,I_{n}),(\\theta_{1},\\dots,\\theta_{n}) \\big)$ and provide explicit formulas for $(q_{i},p_{i})$ in terms of $(I_{i},\\theta_{i})$ for each $i \\in \\{1,\\dots,n\\}$.\n- Using Hamilton’s equations in action-angle variables, determine the frequency vector $\\Omega(I) = \\left( \\dot{\\theta}_{1},\\dots,\\dot{\\theta}_{n} \\right)$ on each invariant torus and describe its dependence on the actions.\n\nYour reasoning must start from first principles: the definition of the symplectic form, the canonical one-form, Hamilton’s equations, and the definition of action-angle variables via action integrals and canonical transformations. Do not invoke pre-packaged formulas without justification.\n\nAnswer specification:\n- Provide your final boxed answer as a single closed-form analytic expression for the Hamiltonian expressed purely in terms of the action variables, namely $H(I_{1},\\dots,I_{n})$. No units are required.",
            "solution": "The problem is to analyze the Hamiltonian system of $n$ uncoupled harmonic oscillators, find its invariant tori, construct the action-angle coordinates, and determine the resulting dynamics.\n\nThe phase space is $\\mathbb{R}^{2n}$ with coordinates $(q,p) = (q_1, \\dots, q_n, p_1, \\dots, p_n)$.\nThe given symplectic form is $\\omega_{\\mathrm{std}} = \\sum_{i=1}^{n} \\mathrm{d}q_{i} \\wedge \\mathrm{d}p_{i}$.\nThe Hamiltonian is $H(q,p) = \\sum_{i=1}^{n} H_i(q_i, p_i)$, where $H_i(q_i, p_i) = \\frac{1}{2} p_i^2 + \\frac{1}{2} \\omega_i^2 q_i^2$.\n\nFirst, we establish Hamilton's equations for the standard symplectic form $\\omega_{\\mathrm{std}}$. They are given by:\n$$\n\\dot{q}_i = \\frac{\\partial H}{\\partial p_i} \\quad \\text{and} \\quad \\dot{p}_i = -\\frac{\\partial H}{\\partial q_i}\n$$\nFor our specific Hamiltonian, these equations become:\n$$\n\\dot{q}_i = p_i \\quad \\text{and} \\quad \\dot{p}_i = -\\omega_i^2 q_i\n$$\nDifferentiating the first equation with respect to time gives $\\ddot{q}_i = \\dot{p}_i = -\\omega_i^2 q_i$, which is the standard equation for a harmonic oscillator, $\\ddot{q}_i + \\omega_i^2 q_i = 0$.\n\nThe Hamiltonian is a sum of $n$ functions, $H = \\sum_{i=1}^n H_i(q_i, p_i)$, where each $H_i$ only depends on the pair of coordinates $(q_i, p_i)$. This system is separable. The dynamics of each $(q_i, p_i)$ pair are independent of the others. The individual Hamiltonians $H_i$ are themselves constants of motion, since $\\{H_i, H\\} = \\{H_i, \\sum_j H_j\\} = \\sum_j \\{H_i, H_j\\} = 0$ as $\\{H_i, H_j\\}=0$ for $i \\neq j$ (disjoint variables) and $\\{H_i, H_i\\}=0$. These $n$ functions $H_1, \\dots, H_n$ are the independent integrals of motion in involution required for Liouville-Arnold integrability.\n\nFor each subsystem $i$, the motion is constrained to a level set $H_i(q_i, p_i) = E_i$, where $E_i > 0$ is a constant energy. The equation $\\frac{1}{2} p_i^2 + \\frac{1}{2} \\omega_i^2 q_i^2 = E_i$ describes an ellipse in the $(q_i, p_i)$ phase plane. The motion for the full system is constrained to the product of these $n$ ellipses. Topologically, each ellipse is a circle ($S^1$). Thus, the level set of the collective integrals of motion $(H_1, \\dots, H_n)$ is an $n$-dimensional torus $T^n = S^1 \\times \\dots \\times S^1$. These are the invariant Lagrangian tori of the system.\n\nThe action variables $(I_1, \\dots, I_n)$ are defined by integrating the canonical one-form $\\lambda = \\sum_i p_i \\mathrm{d}q_i$ over a basis of fundamental cycles on the invariant torus. Since the torus is a product, we can choose the cycles $\\gamma_i$ to be the individual ellipses in each $(q_i, p_i)$ plane. The action $I_i$ is defined as:\n$$\nI_i = \\frac{1}{2\\pi} \\oint_{\\gamma_i} p_i \\, \\mathrm{d}q_i\n$$\nwhere $\\gamma_i$ is the curve defined by $H_i(q_i, p_i) = E_i$. The integral $\\oint p_i \\, \\mathrm{d}q_i$ represents the area enclosed by the ellipse. The equation of the ellipse is $\\frac{q_i^2}{a^2} + \\frac{p_i^2}{b^2} = 1$, where the semi-axes are $a = \\sqrt{2E_i / \\omega_i^2}$ and $b = \\sqrt{2E_i}$. The area of the ellipse is $\\pi a b$.\n$$\n\\text{Area} = \\pi \\left(\\frac{\\sqrt{2E_i}}{\\omega_i}\\right) (\\sqrt{2E_i}) = \\frac{2\\pi E_i}{\\omega_i}\n$$\nTherefore, the action variable $I_i$ is:\n$$\nI_i = \\frac{1}{2\\pi} \\left( \\frac{2\\pi E_i}{\\omega_i} \\right) = \\frac{E_i}{\\omega_i}\n$$\nThis gives us a relationship between the energy of each oscillator and its corresponding action: $E_i = I_i \\omega_i$.\n\nNow we construct the canonical transformation to action-angle coordinates $(I_i, \\theta_i)$. The goal is to find new coordinates such that the Hamiltonian only depends on the actions $I_i$. Based on the elliptic motion, we propose the following transformation for each $i \\in \\{1, \\dots, n\\}$:\n$$\nq_i(I_i, \\theta_i) = \\sqrt{\\frac{2I_i}{\\omega_i}} \\sin \\theta_i\n$$\n$$\np_i(I_i, \\theta_i) = \\sqrt{2I_i \\omega_i} \\cos \\theta_i\n$$\nTo verify that this is a valid coordinate transformation leading to the correct dynamics, we express the Hamiltonian $K(I, \\theta)$ in the new coordinates by substituting the transformation into $H(q,p)$:\n$$\nK(I, \\theta) = \\sum_{i=1}^n \\left( \\frac{1}{2} (\\sqrt{2I_i \\omega_i} \\cos \\theta_i)^2 + \\frac{1}{2} \\omega_i^2 (\\sqrt{\\frac{2I_i}{\\omega_i}} \\sin \\theta_i)^2 \\right)\n$$\n$$\nK(I, \\theta) = \\sum_{i=1}^n \\left( \\frac{1}{2} (2I_i \\omega_i \\cos^2 \\theta_i) + \\frac{1}{2} \\omega_i^2 (\\frac{2I_i}{\\omega_i} \\sin^2 \\theta_i) \\right)\n$$\n$$\nK(I, \\theta) = \\sum_{i=1}^n ( I_i \\omega_i \\cos^2 \\theta_i + I_i \\omega_i \\sin^2 \\theta_i ) = \\sum_{i=1}^n I_i \\omega_i\n$$\nAs required, the transformed Hamiltonian $K$ depends only on the action variables $I_i$. We denote this as $H(I_1, \\dots, I_n)$.\n\nTo determine the dynamics, we must find the form of Hamilton's equations in the new coordinates. This requires checking how the symplectic form transforms. We compute the differentials:\n$$\n\\mathrm{d}q_i = \\frac{\\partial q_i}{\\partial I_i} \\mathrm{d}I_i + \\frac{\\partial q_i}{\\partial \\theta_i} \\mathrm{d}\\theta_i = \\frac{1}{\\sqrt{2I_i \\omega_i}} \\sin \\theta_i \\, \\mathrm{d}I_i + \\sqrt{\\frac{2I_i}{\\omega_i}} \\cos \\theta_i \\, \\mathrm{d}\\theta_i\n$$\n$$\n\\mathrm{d}p_i = \\frac{\\partial p_i}{\\partial I_i} \\mathrm{d}I_i + \\frac{\\partial p_i}{\\partial \\theta_i} \\mathrm{d}\\theta_i = \\sqrt{\\frac{\\omega_i}{2I_i}} \\cos \\theta_i \\, \\mathrm{d}I_i - \\sqrt{2I_i \\omega_i} \\sin \\theta_i \\, \\mathrm{d}\\theta_i\n$$\nNow we compute the wedge product $\\mathrm{d}q_i \\wedge \\mathrm{d}p_i$:\n\\begin{align*}\n\\mathrm{d}q_i \\wedge \\mathrm{d}p_i &= \\left( \\frac{\\partial q_i}{\\partial I_i} \\frac{\\partial p_i}{\\partial \\theta_i} - \\frac{\\partial q_i}{\\partial \\theta_i} \\frac{\\partial p_i}{\\partial I_i} \\right) \\mathrm{d}I_i \\wedge \\mathrm{d}\\theta_i \\\\\n&= \\left( \\left(\\frac{1}{\\sqrt{2I_i \\omega_i}} \\sin \\theta_i\\right)\\left(-\\sqrt{2I_i \\omega_i} \\sin \\theta_i\\right) - \\left(\\sqrt{\\frac{2I_i}{\\omega_i}} \\cos \\theta_i\\right)\\left(\\sqrt{\\frac{\\omega_i}{2I_i}} \\cos \\theta_i\\right) \\right) \\mathrm{d}I_i \\wedge \\mathrm{d}\\theta_i \\\\\n&= (-\\sin^2 \\theta_i - \\cos^2 \\theta_i) \\mathrm{d}I_i \\wedge \\mathrm{d}\\theta_i \\\\\n&= - \\mathrm{d}I_i \\wedge \\mathrm{d}\\theta_i = \\mathrm{d}\\theta_i \\wedge \\mathrm{d}I_i\n\\end{align*}\nThe symplectic form transforms from $\\omega = \\sum \\mathrm{d}q_i \\wedge \\mathrm{d}p_i$ to $\\omega' = \\sum \\mathrm{d}\\theta_i \\wedge \\mathrm{d}I_i$. In coordinates $(q', p')$ with form $\\sum \\mathrm{d}q' \\wedge \\mathrm{d}p'$, Hamilton's equations are $\\dot{q}' = \\partial H/\\partial p'$ and $\\dot{p}' = -\\partial H/\\partial q'$. Identifying $q'_i = \\theta_i$ and $p'_i = I_i$, the equations of motion for the new coordinates are:\n$$\n\\dot{\\theta}_i = \\frac{\\partial K}{\\partial I_i} \\quad \\text{and} \\quad \\dot{I}_i = -\\frac{\\partial K}{\\partial \\theta_i}\n$$\nUsing our expression for $K(I) = \\sum_{j=1}^n I_j \\omega_j$:\n$$\n\\dot{I}_i = -\\frac{\\partial}{\\partial \\theta_i} \\left( \\sum_{j=1}^n I_j \\omega_j \\right) = 0\n$$\nThis confirms that the actions $I_i$ are indeed constants of motion.\n$$\n\\dot{\\theta}_i = \\frac{\\partial}{\\partial I_i} \\left( \\sum_{j=1}^n I_j \\omega_j \\right) = \\omega_i\n$$\nThe frequency of each angle variable is the constant $\\omega_i$. The motion on the invariant torus is a linear flow with frequency vector $\\Omega(I) = (\\omega_1, \\dots, \\omega_n)$. For the harmonic oscillator, the frequencies of motion are independent of the actions $I_i$ (i.e., independent of the amplitudes or energies).\n\nThe final expression for the Hamiltonian in terms of the action variables is the transformed Hamiltonian $K(I)$.\n$$ H(I_1, \\dots, I_n) = \\sum_{i=1}^n I_i \\omega_i $$",
            "answer": "$$\\boxed{\\sum_{i=1}^{n} I_{i} \\omega_{i}}$$"
        },
        {
            "introduction": "While integrable systems are elegant, most real-world systems are non-integrable perturbations of them. The celebrated Kolmogorov-Arnold-Moser (KAM) theorem tells us that many invariant tori survive, but only if their frequency vectors satisfy a \"Diophantine\" condition, protecting them from destruction by resonances. This practice  delves into the heart of this condition, asking you to determine whether a specific torus is resonant or Diophantine, thereby connecting the abstract number theory of Diophantine approximation to the concrete question of stability in Hamiltonian dynamics.",
            "id": "3750316",
            "problem": "Consider a two-degree-of-freedom integrable Hamiltonian system composed of two decoupled linear oscillators with canonical coordinates $(q_{1},p_{1},q_{2},p_{2})$ and Hamiltonian\n$$\nH(q_{1},p_{1},q_{2},p_{2}) \\;=\\; \\frac{1}{2}\\left(p_{1}^{2} + \\omega_{1}^{2} q_{1}^{2}\\right) \\;+\\; \\frac{1}{2}\\left(p_{2}^{2} + \\omega_{2}^{2} q_{2}^{2}\\right),\n$$\nwhere $\\omega_{1}$ and $\\omega_{2}$ are positive parameters. In action-angle variables $(I_{1},\\theta_{1},I_{2},\\theta_{2})$ for each harmonic oscillator, the invariant torus given by fixed actions $(I_{1},I_{2})$ supports quasi-periodic flow with constant frequencies given by the frequency vector\n$$\n\\boldsymbol{\\omega} \\;=\\; \\left(\\omega_{1},\\,\\omega_{2}\\right).\n$$\nA torus is called resonant if there exist integers $m_{1},m_{2}$, not both zero, such that $m_{1}\\omega_{1} + m_{2}\\omega_{2} = 0$. Otherwise it is nonresonant. In the context of Kolmogorov-Arnold-Moser (KAM) theory, a nonresonant torus is called Diophantine with exponent $\\tau \\geq 1$ and constant $\\gamma > 0$ if\n$$\n|m_{1}\\omega_{1} + m_{2}\\omega_{2}| \\;\\geq\\; \\gamma \\,\\left(|m_{1}|+|m_{2}|\\right)^{-\\tau}\n\\quad\\text{for all}\\quad (m_{1},m_{2}) \\in \\mathbb{Z}^{2}\\setminus\\{(0,0)\\}.\n$$\n\nAssume the system is near the $(3:2)$ resonance through a small detuning parameter $\\delta$ in the second oscillator, specifically\n$$\n\\omega_{1} \\;=\\; 1,\n\\qquad\n\\omega_{2} \\;=\\; \\frac{3}{2} \\;+\\; \\delta,\n\\qquad\n\\delta \\;=\\; \\phi^{-4},\n\\qquad\n\\phi \\;=\\; \\frac{1+\\sqrt{5}}{2}.\n$$\nCompute the exact frequency ratio $r = \\omega_{2}/\\omega_{1}$ for this invariant torus. Then, starting from the definitions of resonance and the Diophantine condition above, use first principles about harmonic oscillators in action-angle variables and well-known properties of quadratic irrational numbers to assess whether this torus is resonant or Diophantine for the specified parameter values.\n\nExpress the final answer as an exact closed-form analytic expression for $r$. No rounding is required. No units are required.",
            "solution": "The problem requires the analysis of an invariant torus in a two-degree-of-freedom Hamiltonian system. The tasks are to compute the frequency ratio $r = \\omega_{2}/\\omega_{1}$ for a specific choice of parameters and then to determine whether the corresponding torus is resonant or Diophantine based on the provided definitions.\n\nFirst, we establish the context from the problem statement. The system is described by the Hamiltonian\n$$\nH(q_{1},p_{1},q_{2},p_{2}) = \\frac{1}{2}\\left(p_{1}^{2} + \\omega_{1}^{2} q_{1}^{2}\\right) + \\frac{1}{2}\\left(p_{2}^{2} + \\omega_{2}^{2} q_{2}^{2}\\right)\n$$\nThis represents two uncoupled harmonic oscillators. In action-angle variables $(I_k, \\theta_k)$, the Hamiltonian for a single oscillator $k$ is $H_k = \\omega_k I_k$. The total Hamiltonian is $H(I_1, I_2) = H_1 + H_2 = \\omega_1 I_1 + \\omega_2 I_2$. Hamilton's equations for the angles are $\\dot{\\theta}_k = \\frac{\\partial H}{\\partial I_k} = \\omega_k$, confirming that the motion on an invariant torus (fixed $I_1, I_2$) occurs with the constant frequency vector $\\boldsymbol{\\omega} = (\\omega_1, \\omega_2)$.\n\nThe problem provides the specific parameter values:\n$$\n\\omega_{1} = 1\n$$\n$$\n\\omega_{2} = \\frac{3}{2} + \\delta, \\quad \\text{where} \\quad \\delta = \\phi^{-4}\n$$\nThe constant $\\phi$ is the golden ratio, $\\phi = \\frac{1+\\sqrt{5}}{2}$.\n\nOur first task is to compute the exact frequency ratio $r = \\omega_{2}/\\omega_{1}$. Given $\\omega_1=1$, this ratio is simply $r = \\omega_2$.\n$$\nr = \\frac{\\omega_{2}}{\\omega_{1}} = \\frac{\\frac{3}{2} + \\phi^{-4}}{1} = \\frac{3}{2} + \\phi^{-4}\n$$\nTo find the exact value of $r$, we must compute $\\phi^{-4}$. The golden ratio $\\phi$ satisfies the characteristic quadratic equation $x^2 - x - 1 = 0$, which implies $\\phi^2 = \\phi + 1$. From this, we can also derive $\\phi^{-1} = \\phi - 1$. We can compute $\\phi^{-4}$ recursively:\n$$\n\\phi^{-2} = (\\phi^{-1})^{2} = (\\phi - 1)^2 = \\phi^2 - 2\\phi + 1 = (\\phi+1) - 2\\phi + 1 = 2 - \\phi\n$$\n$$\n\\phi^{-4} = (\\phi^{-2})^{2} = (2 - \\phi)^2 = 4 - 4\\phi + \\phi^2 = 4 - 4\\phi + (\\phi+1) = 5 - 3\\phi\n$$\nNow, we substitute the numerical value of $\\phi$:\n$$\n\\phi^{-4} = 5 - 3\\left(\\frac{1+\\sqrt{5}}{2}\\right) = 5 - \\frac{3}{2} - \\frac{3\\sqrt{5}}{2} = \\frac{10 - 3 - 3\\sqrt{5}}{2} = \\frac{7 - 3\\sqrt{5}}{2}\n$$\nWe can now calculate the frequency ratio $r$:\n$$\nr = \\frac{3}{2} + \\phi^{-4} = \\frac{3}{2} + \\frac{7 - 3\\sqrt{5}}{2} = \\frac{3 + 7 - 3\\sqrt{5}}{2} = \\frac{10 - 3\\sqrt{5}}{2}\n$$\n\nNext, we assess whether the torus is resonant or Diophantine.\n\nA torus is resonant if there exist integers $(m_1, m_2) \\in \\mathbb{Z}^2 \\setminus \\{(0,0)\\}$ such that $m_1 \\omega_1 + m_2 \\omega_2 = 0$. With $\\omega_1=1$ and $\\omega_2=r$, this condition becomes $m_1 + m_2 r = 0$. If $m_2 \\neq 0$, this implies $r = -m_1/m_2$, meaning $r$ must be a rational number. If $m_2=0$, then $m_1$ must also be $0$, which is excluded. Our calculated value for the ratio is $r = \\frac{10 - 3\\sqrt{5}}{2} = 5 - \\frac{3}{2}\\sqrt{5}$. Since $\\sqrt{5}$ is an irrational number, $r$ is an irrational number. Specifically, it is a linear combination of a rational number ($5$) and an irrational number ($\\sqrt{5}$) with a rational coefficient ($-3/2$), which results in an irrational number. Because $r$ is irrational, it cannot be expressed as a ratio of two integers. Therefore, the resonance condition $m_1 + m_2 r = 0$ is not satisfied for any non-zero integer pair $(m_1, m_2)$. The torus is nonresonant.\n\nNow, we check if the torus is Diophantine. A nonresonant torus is Diophantine if for some constants $\\tau \\ge 1$ and $\\gamma > 0$, the following inequality holds for all $(m_1, m_2) \\in \\mathbb{Z}^2 \\setminus \\{(0,0)\\}$:\n$$\n|m_{1}\\omega_{1} + m_{2}\\omega_{2}| \\ge \\gamma (|m_{1}|+|m_{2}|)^{-\\tau}\n$$\nSubstituting $\\omega_1 = 1$ and $\\omega_2 = r$, this is:\n$$\n|m_1 + m_2 r| \\ge \\gamma (|m_1|+|m_2|)^{-\\tau}\n$$\nThe number $r = \\frac{10 - 3\\sqrt{5}}{2}$ is a quadratic irrational number because it is a root of a quadratic equation with integer coefficients. Let us find this equation:\n$$\nx = \\frac{10 - 3\\sqrt{5}}{2} \\\\\n2x = 10 - 3\\sqrt{5} \\\\\n2x - 10 = -3\\sqrt{5} \\\\\n(2x - 10)^2 = (-3\\sqrt{5})^2 \\\\\n4x^2 - 40x + 100 = 45 \\\\\n4x^2 - 40x + 55 = 0\n$$\nLet $P(x) = 4x^2 - 40x + 55$. We have shown that $P(r) = 0$.\nA cornerstone result in the theory of Diophantine approximation is that quadratic irrational numbers are \"badly approximable\" by rationals. This property directly leads to them satisfying a Diophantine condition. We can demonstrate this from first principles.\n\nFor any integers $m_1, m_2$ with $m_2 \\neq 0$, let us evaluate the polynomial $P$ at the rational number $-m_1/m_2$:\n$$\nP(-m_1/m_2) = 4\\left(\\frac{-m_1}{m_2}\\right)^2 - 40\\left(\\frac{-m_1}{m_2}\\right) + 55 = \\frac{4m_1^2 + 40m_1m_2 + 55m_2^2}{m_2^2}\n$$\nThe numerator, $N = 4m_1^2 + 40m_1m_2 + 55m_2^2$, is an integer. Furthermore, $N \\neq 0$ because if it were, $-m_1/m_2$ would be a rational root of $P(x)=0$, but the roots of $P(x)$ are irrational. Thus, as $N$ is a non-zero integer, we must have $|N| \\ge 1$. This implies:\n$$\n|P(-m_1/m_2)| \\ge \\frac{1}{m_2^2}\n$$\nBy the Mean Value Theorem, for any $-m_1/m_2$, there exists a $\\xi$ between $r$ and $-m_1/m_2$ such that:\n$$\nP(-m_1/m_2) - P(r) = P'(\\xi) \\left(-\\frac{m_1}{m_2} - r\\right)\n$$\nSince $P(r)=0$, we have $|P(-m_1/m_2)| = |P'(\\xi)| \\left|r + \\frac{m_1}{m_2}\\right|$. Combining these results:\n$$\n\\left|r + \\frac{m_1}{m_2}\\right| = \\frac{|P(-m_1/m_2)|}{|P'(\\xi)|} \\ge \\frac{1}{m_2^2 |P'(\\xi)|}\n$$\nMultiplying by $|m_2|$ gives a lower bound for the expression in the Diophantine condition:\n$$\n|m_1 + m_2 r| = |m_2|\\left|r + \\frac{m_1}{m_2}\\right| \\ge \\frac{1}{|m_2| |P'(\\xi)|}\n$$\nThe derivative is $P'(x) = 8x-40$. The relevant approximations $-m_1/m_2$ are those close to $r$. If we consider a bounded interval around $r$, say $[r-1, r+1]$, the derivative $P'(\\xi)$ for $\\xi$ in this interval is bounded, i.e., $|P'(\\xi)| \\le M$ for some constant $M>0$. For approximations outside this interval, $|r+m_1/m_2| > 1$, which gives $|m_1+m_2r| > |m_2|$, a very poor approximation for which the Diophantine condition is easily satisfied. So focusing on good approximations, we have $|m_1 + m_2 r| \\ge \\frac{1}{M|m_2|}$.\n\nLet's set $\\tau=1$ in the Diophantine condition. We need to show that $|m_1 + m_2 r| \\ge \\gamma (|m_1|+|m_2|)^{-1}$. This is equivalent to showing that the product $(|m_1| + |m_2|)|m_1 + m_2 r|$ is bounded below by a positive constant $\\gamma$.\nFrom our derivation, we have $(|m_1| + |m_2|)|m_1 + m_2 r| \\ge \\frac{|m_1|+|m_2|}{M|m_2|} = \\frac{1}{M}\\left(\\left|\\frac{m_1}{m_2}\\right|+1\\right)$.\nFor good rational approximations, $-m_1/m_2$ is close to $r$, so $|-m_1/m_2|$ is close to $|r|$. The term $|\\frac{m_1}{m_2}|+1$ is therefore bounded below by a value close to $|r|+1$. Thus, we can find a constant $\\gamma > 0$ such that the inequality holds. This confirms that the vector $(1,r)$ is Diophantine with exponent $\\tau = 1$. Since the condition $\\tau \\ge 1$ is satisfied, the torus is Diophantine.\n\nIn summary, the frequency ratio is $r = \\frac{10-3\\sqrt{5}}{2}$. This is an irrational number, so the torus is nonresonant. It is a quadratic irrational, which implies it is badly approximable and satisfies the Diophantine condition.",
            "answer": "$$\\boxed{\\frac{10 - 3\\sqrt{5}}{2}}$$"
        },
        {
            "introduction": "The existence of action-angle coordinates is a local property on the set of regular values of an integrable system, but this local picture does not tell the whole story. This exercise  explores the global topological obstructions that can arise when encircling singularities, a phenomenon known as Hamiltonian monodromy. By analyzing the classic spherical pendulum, you will compute how the basis cycles of an invariant torus are transformed when transported around a focus-focus singularity, revealing a fundamental geometric feature of integrable systems.",
            "id": "3750350",
            "problem": "Consider the spherical pendulum consisting of a point mass constrained to move on the unit sphere under a uniform gravitational field. Its configuration space is the $2$-sphere $S^{2}$, and the phase space is the cotangent bundle $T^{*}S^{2}$ equipped with the canonical symplectic form. Let $H$ denote the Hamiltonian (total energy) and let $J$ denote the vertical component of the angular momentum about the symmetry axis. The pair of functions $F = (H, J)$ defines an integrable system in the sense of the Liouville-Arnold (LA) theorem, with regular Liouville tori for regular values of $F$.\n\nIt is known, and you may assume, that there is an isolated critical value $c = (H_{*}, 0)$ of focus-focus type in the image of $F$, corresponding to the unstable equilibrium at the top of the sphere. Let $\\Gamma \\subset \\mathbb{R}^{2}$ be a small, positively oriented simple loop in the set of regular values of $F$ that winds once counterclockwise around $c$ without enclosing any other critical values. Over $\\Gamma$, the fibers form a torus bundle whose first homology $H_{1}(\\text{torus}, \\mathbb{Z}) \\cong \\mathbb{Z}^{2}$ admits a locally constant integer basis transported by the symplectic connection induced by action-angle coordinates.\n\nStarting from the fundamental base:\n- The Liouville-Arnold theorem and the existence of action-angle coordinates on simply connected open sets of regular values.\n- The classification of the isolated focus-focus singularity by the Eliasson local normal form and the ensuing topological structure of a pinched torus with one vanishing cycle.\n- Picard-Lefschetz type transport of cycles and the identification of Hamiltonian monodromy as an element of the Special Linear group of $2 \\times 2$ integer matrices (SL$(2,\\mathbb{Z})$),\n\nderive the monodromy matrix $M \\in \\text{SL}(2,\\mathbb{Z})$ of the spherical pendulum around the loop $\\Gamma$ with respect to the ordered integer basis $(\\gamma_{1}, \\gamma_{2})$ of $H_{1}$ where:\n- $\\gamma_{1}$ is the cycle generated by the $S^{1}$ symmetry associated with the $\\varphi$-rotation (the $J$-flow),\n- $\\gamma_{2}$ is the complementary cycle that does not arise from the symmetry and remains non-collapsed along regular fibers near $c$.\n\nProvide the exact matrix $M$ (with integer entries) that represents the effect of transporting these cycles once around $\\Gamma$. No numerical rounding is required. Express the final answer as a single exact matrix.",
            "solution": "We first recall the fundamental structures. In a $2$-degree-of-freedom integrable Hamiltonian system with commuting integrals $F = (H, J)$, the Liouville-Arnold (LA) theorem ensures that for regular values of $F$, each fiber $F^{-1}(h, j)$ is diffeomorphic to a $2$-torus. Over a simply connected domain of regular values, one can choose a global basis of cycles $\\gamma_{1}, \\gamma_{2}$ for $H_{1}(\\text{torus}, \\mathbb{Z})$ that varies continuously. Over non-simply connected domains, such as one encircling a singular value, this basis can undergo a non-trivial transformation upon transport, known as monodromy. The monodromy is represented by an integer matrix $M \\in \\text{SL}(2,\\mathbb{Z})$ that acts on the coordinate representation of homology cycles.\n\nFor the spherical pendulum, the conserved quantities are $H$ (energy) and $J$ (vertical angular momentum). The system has an isolated critical value $c = (H_{*}, 0)$ at the unstable equilibrium at the top of the sphere. This singularity is of focus-focus type, meaning the fiber at the critical value is a pinched torus with one vanishing cycle.\n\nThe presence of a focus-focus singularity implies nontrivial Hamiltonian monodromy. The effect of transporting cycles around a loop enclosing the singularity is described by the Picard-Lefschetz formula. It states that the transformation is a Dehn twist along the vanishing cycle $\\delta$. For any cycle $\\alpha$, its transport $\\alpha'$ is given by:\n$$\n\\alpha' = \\alpha + (\\alpha \\cdot \\delta) \\, \\delta,\n$$\nwhere $(\\alpha \\cdot \\delta)$ is the oriented intersection number on the torus.\n\nWe must identify the vanishing cycle $\\delta$ in the given basis $(\\gamma_1, \\gamma_2)$. The problem specifies that $\\gamma_1$ is the cycle generated by the $S^1$ symmetry of $\\varphi$-rotation, and $\\gamma_2$ is the complementary cycle. At the unstable equilibrium point (the top of the sphere), the azimuthal $\\varphi$-rotation degenerates as all meridians meet at the pole. The $S^1$ orbit corresponding to this rotation shrinks to a point. Therefore, the symmetry-generated cycle $\\gamma_1$ is the vanishing cycle for the focus-focus singularity: $\\delta = \\gamma_1$.\n\nNow, let's determine the transformation of an arbitrary cycle $v = a\\gamma_1 + b\\gamma_2$, represented by the coordinate vector $\\begin{pmatrix} a \\\\ b \\end{pmatrix}$. The transformed cycle $v'$ will have coordinates $\\begin{pmatrix} a' \\\\ b' \\end{pmatrix}$. The transformation law acts on the basis cycles as follows:\n- The vanishing cycle $\\gamma_1$ is transported into itself: $\\gamma_1' = \\gamma_1 + (\\gamma_1 \\cdot \\gamma_1)\\gamma_1 = \\gamma_1$, since the self-intersection number $(\\gamma_1 \\cdot \\gamma_1)$ is zero.\n- The complementary cycle $\\gamma_2$ transforms as: $\\gamma_2' = \\gamma_2 + (\\gamma_2 \\cdot \\gamma_1)\\gamma_1$. For a standard oriented basis, the intersection number is $(\\gamma_2 \\cdot \\gamma_1) = 1$. Thus, $\\gamma_2' = \\gamma_2 + \\gamma_1$.\n\nNow we apply this to the arbitrary cycle $v$:\n$$\nv' = a\\gamma_1' + b\\gamma_2' = a\\gamma_1 + b(\\gamma_2 + \\gamma_1) = (a+b)\\gamma_1 + b\\gamma_2.\n$$\nThe new coordinate vector is $\\begin{pmatrix} a' \\\\ b' \\end{pmatrix} = \\begin{pmatrix} a+b \\\\ b \\end{pmatrix}$.\nThe monodromy matrix $M$ is the matrix that produces this transformation:\n$$\n\\begin{pmatrix} a' \\\\ b' \\end{pmatrix} = M \\begin{pmatrix} a \\\\ b \\end{pmatrix}\n$$\n$$\n\\begin{pmatrix} a+b \\\\ b \\end{pmatrix} = \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} a \\\\ b \\end{pmatrix}\n$$\nThus, the Hamiltonian monodromy matrix for the spherical pendulum around the focus-focus singularity is:\n$$\nM = \\begin{pmatrix}\n1 & 1 \\\\\n0 & 1\n\\end{pmatrix}.\n$$\nThis matrix lies in $\\text{SL}(2,\\mathbb{Z})$ and encodes the nontrivial twisting of the torus bundle. It shows that while the action associated with the first cycle is single-valued, the action associated with the second cycle is multi-valued, picking up an integer multiple of the first action upon transport around the singularity.",
            "answer": "$$\\boxed{\\begin{pmatrix}1 & 1 \\\\ 0 & 1\\end{pmatrix}}$$"
        }
    ]
}