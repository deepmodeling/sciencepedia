{
    "hands_on_practices": [
        {
            "introduction": "The Energy-Casimir method provides a powerful tool for analyzing the stability of equilibria in Lie-Poisson systems by transforming a dynamical problem into a static variational one. This first practice focuses on the essential starting point of this method: identifying an equilibrium as a critical point of an augmented functional. By applying the method of Lagrange multipliers to the canonical example of a free rigid body, you will solidify your understanding of how conserved quantities, or Casimirs, are used to set up the stability analysis.",
            "id": "3729734",
            "problem": "Consider the free rigid body in the Hamiltonian formulation on the dual of the special orthogonal Lie algebra $\\mathfrak{so}(3)^{\\ast}$. Let the inertia tensor be diagonal in the body frame with distinct principal moments $I_{1}$, $I_{2}$, $I_{3}$ satisfying $I_{i} \\in \\mathbb{R}_{0}$ for $i \\in \\{1,2,3\\}$. The body angular momentum is $M = (M_{1},M_{2},M_{3}) \\in \\mathfrak{so}(3)^{\\ast} \\cong \\mathbb{R}^{3}$. The Hamiltonian is the kinetic energy\n$$\nH(M) = \\frac{1}{2} \\left( \\frac{M_{1}^{2}}{I_{1}} + \\frac{M_{2}^{2}}{I_{2}} + \\frac{M_{3}^{2}}{I_{3}} \\right).\n$$\nThe coadjoint orbits of $\\mathfrak{so}(3)^{\\ast}$ are spheres of constant magnitude of angular momentum. Consider the sphere leaf\n$$\nS_{m} = \\{\\, M \\in \\mathbb{R}^{3} \\mid C(M) = m^{2} \\,\\}, \\quad \\text{where} \\quad C(M) = |M|^{2} = M_{1}^{2} + M_{2}^{2} + M_{3}^{2},\n$$\nand $m \\in \\mathbb{R}_{0}$ is fixed. Define the augmented functional\n$$\nF_{\\lambda}(M) = H(M) + \\lambda\\, C(M),\n$$\nwith $\\lambda \\in \\mathbb{R}$ a Lagrange multiplier.\n\nStarting from first principles of constrained critical points on a smooth submanifold (Lagrange multipliers) and the definitions above, perform the following:\n\n- Compute the explicit expression of $F_{\\lambda}(M)$ in terms of $M_{1}$, $M_{2}$, $M_{3}$, $I_{1}$, $I_{2}$, $I_{3}$, and $\\lambda$.\n- Determine the value of $\\lambda$ such that the steady rotation about the third principal axis,\n$M^{\\ast} = m\\, e_{3} = (0,0,m)$,\nis a critical point of $F_{\\lambda}$ when restricted to the sphere $S_{m}$.\n\nYour final answer must be a single closed-form analytic expression for the required $\\lambda$. You do not need to report $F_{\\lambda}$ in the final answer. No numerical substitution is required.",
            "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **System**: A free rigid body in the Hamiltonian formulation on $\\mathfrak{so}(3)^{\\ast}$.\n- **Inertia Tensor**: Diagonal, with distinct principal moments $I_{1}$, $I_{2}$, $I_{3}$ satisfying $I_{i} \\in \\mathbb{R}_{0}$ for $i \\in \\{1,2,3\\}$.\n- **Angular Momentum**: $M = (M_{1},M_{2},M_{3}) \\in \\mathfrak{so}(3)^{\\ast} \\cong \\mathbb{R}^{3}$.\n- **Hamiltonian**: $H(M) = \\frac{1}{2} \\left( \\frac{M_{1}^{2}}{I_{1}} + \\frac{M_{2}^{2}}{I_{2}} + \\frac{M_{3}^{2}}{I_{3}} \\right)$.\n- **Coadjoint Orbit (Casimir function level set)**: Sphere leaf $S_{m} = \\{\\, M \\in \\mathbb{R}^{3} \\mid C(M) = m^{2} \\,\\}$.\n- **Casimir Function**: $C(M) = |M|^{2} = M_{1}^{2} + M_{2}^{2} + M_{3}^{2}$, with $m \\in \\mathbb{R}_{0}$ fixed.\n- **Augmented Functional**: $F_{\\lambda}(M) = H(M) + \\lambda\\, C(M)$, with $\\lambda \\in \\mathbb{R}$.\n- **Point of Interest**: Steady rotation about the third principal axis, $M^{\\ast} = m\\, e_{3} = (0,0,m)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically rigorous and well-posed.\n- **Scientific Grounding**: The problem describes the Hamiltonian mechanics of a free rigid body, a canonical topic in classical and geometric mechanics. The Hamiltonian, the coadjoint orbits of $\\mathfrak{so}(3)$ (which are spheres), and the use of an augmented functional (the energy-Casimir functional) are standard elements of Arnold's stability method. The setup is entirely consistent with established physical and mathematical principles.\n- **Well-Posedness**: The problem is self-contained. All necessary functions ($H$, $C$) and variables are explicitly defined. The task is to find a specific parameter $\\lambda$ that satisfies a clear mathematical condition (making a specific point a critical point). This leads to a unique solution.\n- **Objectivity**: The problem is stated in precise, unambiguous mathematical language, free from any subjective or non-formalizable content.\n\nNo flaws are found. The problem is a standard exercise in applying the energy-Casimir method for stability analysis.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\nThe objective is to find the value of the parameter $\\lambda$ such that the specific configuration $M^{\\ast} = (0,0,m)$ is a critical point of the Hamiltonian $H(M)$ when restricted to the sphere $S_m$. The method of Lagrange multipliers states that this condition is equivalent to finding $\\lambda$ such that $M^{\\ast}$ is an unconstrained critical point of the augmented functional $F_{\\lambda}(M) = H(M) + \\lambda C(M)$. A point is an unconstrained critical point if the gradient of the function vanishes at that point.\n\nFirst, we write the explicit expression for the augmented functional $F_{\\lambda}(M)$ by substituting the definitions of $H(M)$ and $C(M)$:\n$$\nF_{\\lambda}(M) = \\frac{1}{2} \\left( \\frac{M_{1}^{2}}{I_{1}} + \\frac{M_{2}^{2}}{I_{2}} + \\frac{M_{3}^{2}}{I_{3}} \\right) + \\lambda (M_{1}^{2} + M_{2}^{2} + M_{3}^{2})\n$$\nWe can regroup the terms by components of $M$:\n$$\nF_{\\lambda}(M) = \\left(\\frac{1}{2I_{1}} + \\lambda\\right)M_{1}^{2} + \\left(\\frac{1}{2I_{2}} + \\lambda\\right)M_{2}^{2} + \\left(\\frac{1}{2I_{3}} + \\lambda\\right)M_{3}^{2}\n$$\nThe condition for $M^{\\ast}$ to be a critical point of $F_{\\lambda}(M)$ is that the gradient of $F_{\\lambda}$ evaluated at $M^{\\ast}$ must be the zero vector:\n$$\n\\nabla F_{\\lambda}(M^{\\ast}) = 0\n$$\nThe gradient of $F_{\\lambda}(M)$ with respect to $M=(M_1, M_2, M_3)$ is given by the vector of partial derivatives:\n$$\n\\nabla F_{\\lambda}(M) = \\left( \\frac{\\partial F_{\\lambda}}{\\partial M_{1}}, \\frac{\\partial F_{\\lambda}}{\\partial M_{2}}, \\frac{\\partial F_{\\lambda}}{\\partial M_{3}} \\right)\n$$\nWe compute each component of the gradient:\n$$\n\\frac{\\partial F_{\\lambda}}{\\partial M_{1}} = 2 \\left(\\frac{1}{2I_{1}} + \\lambda\\right) M_{1} = \\left(\\frac{1}{I_{1}} + 2\\lambda\\right) M_{1}\n$$\n$$\n\\frac{\\partial F_{\\lambda}}{\\partial M_{2}} = 2 \\left(\\frac{1}{2I_{2}} + \\lambda\\right) M_{2} = \\left(\\frac{1}{I_{2}} + 2\\lambda\\right) M_{2}\n$$\n$$\n\\frac{\\partial F_{\\lambda}}{\\partial M_{3}} = 2 \\left(\\frac{1}{2I_{3}} + \\lambda\\right) M_{3} = \\left(\\frac{1}{I_{3}} + 2\\lambda\\right) M_{3}\n$$\nNow, we evaluate this gradient at the specific point of interest, $M^{\\ast} = (0,0,m)$:\n$$\n\\frac{\\partial F_{\\lambda}}{\\partial M_{1}}\\bigg|_{M=M^{\\ast}} = \\left(\\frac{1}{I_{1}} + 2\\lambda\\right) (0) = 0\n$$\n$$\n\\frac{\\partial F_{\\lambda}}{\\partial M_{2}}\\bigg|_{M=M^{\\ast}} = \\left(\\frac{1}{I_{2}} + 2\\lambda\\right) (0) = 0\n$$\n$$\n\\frac{\\partial F_{\\lambda}}{\\partial M_{3}}\\bigg|_{M=M^{\\ast}} = \\left(\\frac{1}{I_{3}} + 2\\lambda\\right) (m)\n$$\nFor the gradient vector to be zero at $M^{\\ast}$, all its components must be zero. The first two components are identically zero. The third component gives the following equation:\n$$\nm \\left(\\frac{1}{I_{3}} + 2\\lambda\\right) = 0\n$$\nAccording to the problem statement, $m \\in \\mathbb{R}_{0}$, which implies $m \\neq 0$. Therefore, for the product to be zero, the other factor must be zero:\n$$\n\\frac{1}{I_{3}} + 2\\lambda = 0\n$$\nSolving this equation for $\\lambda$, we find:\n$$\n2\\lambda = -\\frac{1}{I_{3}}\n$$\n$$\n\\lambda = -\\frac{1}{2I_{3}}\n$$\nThis is the required value of the Lagrange multiplier $\\lambda$ for the steady rotation about the third principal axis to be a critical point of the constrained system.",
            "answer": "$$\n\\boxed{-\\frac{1}{2I_{3}}}\n$$"
        },
        {
            "introduction": "Having established an equilibrium as a critical point of the augmented functional $F_\\lambda = H + \\lambda C$ , Arnold's theorem directs us to examine the second variation, $\\delta^2 F_\\lambda$, to determine stability. This exercise challenges you to compute this second variation and, crucially, to evaluate its definiteness on the subspace tangent to the coadjoint orbit, which acts as the symplectic leaf. Performing this calculation for the rigid body's intermediate axis of rotation provides a direct, hands-on confirmation of the famous result that this equilibrium is nonlinearly unstable.",
            "id": "3729747",
            "problem": "Consider the reduced free rigid body on the dual of the Lie algebra of the Special Orthogonal Group (SO(3)), modeled on the vector space $\\mathbb{R}^{3}$ with coordinates $M = (M_{1}, M_{2}, M_{3})$. The Lie–Poisson bracket for functions $F, G$ on $\\mathbb{R}^{3}$ is defined by $\\{F,G\\}(M) = - M \\cdot (\\nabla F(M) \\times \\nabla G(M))$, and the coadjoint orbits are the spheres $|M| = \\text{constant}$ endowed with the Kirillov–Kostant–Souriau symplectic structure. The Hamiltonian is\n$$\nH(M) = \\frac{1}{2}\\left(\\frac{M_{1}^{2}}{I_{1}} + \\frac{M_{2}^{2}}{I_{2}} + \\frac{M_{3}^{2}}{I_{3}}\\right),\n$$\nwhere $I_{1}, I_{2}, I_{3}  0$ are distinct principal moments of inertia with ordering $I_{1}  I_{2}  I_{3}$. The function\n$$\nC(M) = |M|^{2} = M_{1}^{2} + M_{2}^{2} + M_{3}^{2}\n$$\nis a Casimir (a constant of motion for the Lie–Poisson dynamics). Let $M_{0} = \\mu\\, e_{2} = (0, \\mu, 0)$ for some fixed $\\mu \\neq 0$, which corresponds to steady rotation about the axis associated with $I_{2}$.\n\nStarting from the definitions of the first and second variations and the standard Euclidean gradient and Hessian, determine the scalar $\\lambda$ such that $M_{0}$ is a critical point of the constrained functional $F(M) = H(M) - \\lambda\\, C(M)$. Compute explicitly the second variation $D^{2}F(M_{0})$ as a symmetric bilinear form and determine its signature when restricted to the constrained subspace $T_{M_{0}}\\mathcal{O}$, where $\\mathcal{O}$ is the coadjoint orbit through $M_{0}$ (equivalently, the sphere $|M| = |M_{0}|$), so $T_{M_{0}}\\mathcal{O} = \\{ \\delta M \\in \\mathbb{R}^{3} \\mid \\delta M \\cdot M_{0} = 0 \\}$.\n\nProvide the signature as the ordered pair $(n_{+}, n_{-})$, where $n_{+}$ is the number of positive directions and $n_{-}$ is the number of negative directions of $D^{2}F(M_{0})$ restricted to $T_{M_{0}}\\mathcal{O}$. Your final answer must be this ordered pair only.",
            "solution": "We begin from the definitions of the Euclidean gradient and Hessian for smooth functions on $\\mathbb{R}^{3}$. For the Hamiltonian\n$$\nH(M) = \\frac{1}{2}\\left(\\frac{M_{1}^{2}}{I_{1}} + \\frac{M_{2}^{2}}{I_{2}} + \\frac{M_{3}^{2}}{I_{3}}\\right),\n$$\nthe gradient and Hessian are\n$$\n\\nabla H(M) = \\left(\\frac{M_{1}}{I_{1}}, \\frac{M_{2}}{I_{2}}, \\frac{M_{3}}{I_{3}}\\right), \\quad D^{2}H(M) = \\operatorname{diag}\\!\\left(\\frac{1}{I_{1}}, \\frac{1}{I_{2}}, \\frac{1}{I_{3}}\\right).\n$$\nFor the Casimir\n$$\nC(M) = M_{1}^{2} + M_{2}^{2} + M_{3}^{2},\n$$\nwe have\n$$\n\\nabla C(M) = \\left(2 M_{1}, 2 M_{2}, 2 M_{3}\\right), \\quad D^{2}C(M) = 2\\, I_{3 \\times 3},\n$$\nwhere $I_{3 \\times 3}$ is the $3 \\times 3$ identity matrix.\n\nDefine the constrained functional\n$$\nF(M) = H(M) - \\lambda\\, C(M).\n$$\nIts gradient and Hessian are\n$$\n\\nabla F(M) = \\nabla H(M) - \\lambda\\, \\nabla C(M), \\quad D^{2}F(M) = D^{2}H(M) - \\lambda\\, D^{2}C(M).\n$$\nEvaluate the first variation at $M_{0} = (0, \\mu, 0)$:\n$$\n\\nabla F(M_{0}) = \\left(0, \\frac{\\mu}{I_{2}}, 0\\right) - \\lambda\\, \\left(0, 2\\mu, 0\\right) = \\left(0, \\mu\\left(\\frac{1}{I_{2}} - 2\\lambda\\right), 0\\right).\n$$\nThe critical point condition $\\nabla F(M_{0}) = 0$ yields\n$$\n\\lambda = \\frac{1}{2 I_{2}}.\n$$\n\nNext compute the second variation at $M_{0}$:\n$$\nD^{2}F(M_{0}) = \\operatorname{diag}\\!\\left(\\frac{1}{I_{1}}, \\frac{1}{I_{2}}, \\frac{1}{I_{3}}\\right) - \\frac{1}{2 I_{2}} \\cdot 2\\, I_{3 \\times 3} = \\operatorname{diag}\\!\\left(\\frac{1}{I_{1}} - \\frac{1}{I_{2}}, 0, \\frac{1}{I_{3}} - \\frac{1}{I_{2}}\\right).\n$$\nThe constrained subspace is the tangent space to the coadjoint orbit through $M_{0}$, which is the sphere $|M| = |M_{0}|$. Its tangent space at $M_{0}$ is\n$$\nT_{M_{0}}\\mathcal{O} = \\left\\{ \\delta M \\in \\mathbb{R}^{3} \\mid \\delta M \\cdot M_{0} = 0 \\right\\} = \\left\\{ (\\delta M_{1}, \\delta M_{2}, \\delta M_{3}) \\mid \\mu\\, \\delta M_{2} = 0 \\right\\}.\n$$\nSince $\\mu \\neq 0$, the constraint is $\\delta M_{2} = 0$, so $T_{M_{0}}\\mathcal{O}$ is spanned by the coordinate directions $e_{1}$ and $e_{3}$.\n\nRestricting $D^{2}F(M_{0})$ to $T_{M_{0}}\\mathcal{O}$ yields the diagonal form with entries\n$$\n\\lambda_{1} = \\frac{1}{I_{1}} - \\frac{1}{I_{2}}, \\quad \\lambda_{3} = \\frac{1}{I_{3}} - \\frac{1}{I_{2}}.\n$$\nUsing the ordering $I_{1}  I_{2}  I_{3}$, we have\n$$\n\\frac{1}{I_{1}} - \\frac{1}{I_{2}} = \\frac{I_{2} - I_{1}}{I_{1} I_{2}}  0, \\quad \\frac{1}{I_{3}} - \\frac{1}{I_{2}} = \\frac{I_{2} - I_{3}}{I_{2} I_{3}}  0.\n$$\nTherefore, the restricted second variation is indefinite with one positive and one negative direction. The signature on $T_{M_{0}}\\mathcal{O}$ is\n$$\n(n_{+}, n_{-}) = (1, 1).\n$$",
            "answer": "$$\\boxed{(1, 1)}$$"
        },
        {
            "introduction": "This practice bridges the gap between the analytical theory of the Energy-Casimir method and modern computational practice. You are tasked with developing a numerical algorithm that automates the stability analysis for the free rigid body, a process you previously explored by hand  . Implementing this test requires translating abstract geometric concepts, such as the tangent space to a coadjoint orbit and the restriction of a quadratic form, into concrete linear algebra operations, thereby deepening your intuition and building valuable skills in computational geometric mechanics.",
            "id": "3729741",
            "problem": "Consider the free rigid body as a paradigmatic Lie–Poisson Hamiltonian system. Let the configuration group be the special orthogonal group $\\mathrm{SO}(3)$, and let the state variable be the body angular momentum $\\mathbf{M} \\in \\mathbb{R}^3 \\cong \\mathfrak{so}(3)^*$. The Hamiltonian is given by $H(\\mathbf{M}) = \\tfrac{1}{2} \\mathbf{M}^{\\top} \\mathbb{I}^{-1} \\mathbf{M}$, where $\\mathbb{I} = \\mathrm{diag}(I_1, I_2, I_3)$ is the diagonal inertia matrix with strictly positive principal moments of inertia $I_1, I_2, I_3$. The Lie–Poisson dynamics preserve the Casimir $C(\\mathbf{M}) = \\tfrac{1}{2} \\|\\mathbf{M}\\|^2$, and coadjoint orbits are spheres of constant $C$. Arnold’s nonlinear stability theorem states that if the second variation of an augmented energy, restricted to a suitable slice through the coadjoint orbit, is definite, then the equilibrium is nonlinearly stable.\n\nStarting from the fundamental definitions:\n- The Hamiltonian $H(\\mathbf{M}) = \\tfrac{1}{2} \\mathbf{M}^{\\top} \\mathbb{I}^{-1} \\mathbf{M}$,\n- The Casimir $C(\\mathbf{M}) = \\tfrac{1}{2} \\|\\mathbf{M}\\|^2$,\n- The Energy–Casimir Method (ECM): consider the augmented function $F_\\lambda(\\mathbf{M}) = H(\\mathbf{M}) - \\lambda C(\\mathbf{M})$, with $\\lambda \\in \\mathbb{R}$ chosen so that $\\nabla F_\\lambda(\\mathbf{M}_e) = \\mathbf{0}$ at the equilibrium $\\mathbf{M}_e$,\n\nyour task is to implement a numerical method to test the definiteness of the reduced quadratic form of $F_\\lambda$ on the slice that is tangent to the coadjoint orbit at $\\mathbf{M}_e$. Concretely:\n\n1. Consider equilibria where $\\mathbf{M}_e$ is aligned with a principal axis: $\\mathbf{M}_e = m \\mathbf{e}_k$, where $\\mathbf{e}_k$ is the $k$-th standard basis vector of $\\mathbb{R}^3$ and $m \\in \\mathbb{R}$, with $k \\in \\{0,1,2\\}$ corresponding to axes associated with $I_1, I_2, I_3$, respectively. Determine the Lagrange multiplier $\\lambda$ from the stationarity condition $\\nabla H(\\mathbf{M}_e) = \\lambda \\nabla C(\\mathbf{M}_e)$.\n\n2. Compute the Hessian of $F_\\lambda$ at $\\mathbf{M}_e$, denoted $\\mathrm{Hess}\\, F_\\lambda(\\mathbf{M}_e)$. Do not simplify using any pre-known shortcut formulas; derive $\\mathrm{Hess}\\, F_\\lambda$ from the definitions of $H$ and $C$.\n\n3. Define the slice as the tangent space to the coadjoint orbit at $\\mathbf{M}_e$, which is the subspace orthogonal to $\\mathbf{M}_e$: $\\mathcal{S} = \\{\\delta \\mathbf{M} \\in \\mathbb{R}^3 \\mid \\mathbf{M}_e^{\\top} \\delta \\mathbf{M} = 0\\}$. Construct an orthonormal basis $\\{\\mathbf{v}_1, \\mathbf{v}_2\\}$ for $\\mathcal{S}$ without using any special-case simplifications. Using this basis, compute the reduced quadratic form $Q$ as the symmetric $2 \\times 2$ matrix $Q = [q_{ij}]$ with entries $q_{ij} = \\mathbf{v}_i^{\\top} \\big(\\mathrm{Hess}\\, F_\\lambda(\\mathbf{M}_e)\\big) \\mathbf{v}_j$.\n\n4. Compute the eigenvalues of $Q$ and determine the definiteness type by verifying their signs:\n   - Positive definite if both eigenvalues are strictly positive.\n   - Negative definite if both eigenvalues are strictly negative.\n   - Semidefinite if at least one eigenvalue is numerically zero (within a specified tolerance), and the other is nonzero but not of opposite sign.\n   - Indefinite if the eigenvalues have opposite signs.\n\n5. Implement a robust numerical classification with a tolerance threshold $t > 0$ for deciding when a value is treated as zero (you must choose a reasonable $t$). Report the definiteness type for each test case as an integer code:\n   - $1$ for positive definite,\n   - $-1$ for negative definite,\n   - $2$ for semidefinite,\n   - $0$ for indefinite.\n\nYour program must use the following test suite of parameter values:\n- Case A (generic stable about the smallest inertia axis): $I_1 = 2.0$, $I_2 = 3.0$, $I_3 = 5.0$, $k = 0$.\n- Case B (generic stable about the largest inertia axis): $I_1 = 2.0$, $I_2 = 3.0$, $I_3 = 5.0$, $k = 2$.\n- Case C (generic unstable about the middle inertia axis): $I_1 = 2.0$, $I_2 = 3.0$, $I_3 = 5.0$, $k = 1$.\n- Case D (boundary semidefinite case): $I_1 = 1.0$, $I_2 = 1.0$, $I_3 = 2.0$, $k = 0$.\n\nYour program must produce a single line of output containing the classification results for these four cases as a comma-separated list enclosed in square brackets with no spaces, in the order A, B, C, D. For example, if the classifications are $a$, $b$, $c$, $d$, the output must be formatted as $[a,b,c,d]$. No physical units are involved in this problem, and angles do not appear, so no unit specification is required. The program must be complete and runnable without user input.",
            "solution": "The problem requires an implementation of the Energy-Casimir method to test the nonlinear stability of equilibria for a free rigid body. The stability is determined by the definiteness of the second variation of an augmented Hamiltonian, restricted to a specific subspace. We will follow the prescribed steps to derive the necessary mathematical quantities and then implement a numerical test.\n\nLet the state be the angular momentum vector $\\mathbf{M} = (M_1, M_2, M_3)^\\top \\in \\mathbb{R}^3$. The inertia matrix is $\\mathbb{I} = \\mathrm{diag}(I_1, I_2, I_3)$, where $I_1, I_2, I_3  0$.\n\nThe Hamiltonian is given by $H(\\mathbf{M}) = \\frac{1}{2} \\mathbf{M}^\\top \\mathbb{I}^{-1} \\mathbf{M} = \\frac{1}{2}\\left(\\frac{M_1^2}{I_1} + \\frac{M_2^2}{I_2} + \\frac{M_3^2}{I_3}\\right)$.\nThe Casimir function is $C(\\mathbf{M}) = \\frac{1}{2} \\|\\mathbf{M}\\|^2 = \\frac{1}{2} \\mathbf{M}^\\top \\mathbf{M} = \\frac{1}{2}(M_1^2 + M_2^2 + M_3^2)$.\n\nThe augmented function is $F_\\lambda(\\mathbf{M}) = H(\\mathbf{M}) - \\lambda C(\\mathbf{M})$, where $\\lambda$ is a Lagrange multiplier.\n\n**Step 1: Determine the Lagrange Multiplier $\\lambda$**\n\nEquilibria, denoted $\\mathbf{M}_e$, are stationary points of $F_\\lambda$ for some $\\lambda$. The stationarity condition is $\\nabla F_\\lambda(\\mathbf{M}_e) = \\mathbf{0}$.\nLet's compute the gradients of $H$ and $C$:\n$$ \\nabla H(\\mathbf{M}) = \\begin{pmatrix} \\partial H / \\partial M_1 \\\\ \\partial H / \\partial M_2 \\\\ \\partial H / \\partial M_3 \\end{pmatrix} = \\begin{pmatrix} M_1/I_1 \\\\ M_2/I_2 \\\\ M_3/I_3 \\end{pmatrix} = \\mathbb{I}^{-1} \\mathbf{M} $$\n$$ \\nabla C(\\mathbf{M}) = \\begin{pmatrix} \\partial C / \\partial M_1 \\\\ \\partial C / \\partial M_2 \\\\ \\partial C / \\partial M_3 \\end{pmatrix} = \\begin{pmatrix} M_1 \\\\ M_2 \\\\ M_3 \\end{pmatrix} = \\mathbf{M} $$\nThe stationarity condition is $\\nabla H(\\mathbf{M}_e) - \\lambda \\nabla C(\\mathbf{M}_e) = \\mathbf{0}$, which translates to $\\mathbb{I}^{-1} \\mathbf{M}_e = \\lambda \\mathbf{M}_e$.\nThis is an eigenvalue problem for the matrix $\\mathbb{I}^{-1}$.\n\nWe consider equilibria of the form $\\mathbf{M}_e = m \\mathbf{e}_k$, where $m \\neq 0$ and $\\mathbf{e}_k$ is the $k$-th standard basis vector (with $k \\in \\{0, 1, 2\\}$ mapping to axes $1, 2, 3$). Let $I_{k+1}$ be the moment of inertia about this axis.\nSubstituting $\\mathbf{M}_e$ into the condition:\n$$ \\mathbb{I}^{-1} (m \\mathbf{e}_k) = \\lambda (m \\mathbf{e}_k) $$\nSince $m \\neq 0$, we can divide by $m$:\n$$ \\mathbb{I}^{-1} \\mathbf{e}_k = \\lambda \\mathbf{e}_k $$\nThe vector $\\mathbf{e}_k$ is an eigenvector of the diagonal matrix $\\mathbb{I}^{-1} = \\mathrm{diag}(1/I_1, 1/I_2, 1/I_3)$. The corresponding eigenvalue is the $k$-th diagonal element. Using 0-based indexing for $k$, this is $1/I_{k+1}$.\nThus, the Lagrange multiplier is $\\lambda = 1/I_{k+1}$.\n\n**Step 2: Compute the Hessian of $F_\\lambda$**\n\nThe Hessian matrix of a scalar function $f(\\mathbf{M})$ is the matrix of second partial derivatives, $[\\mathrm{Hess}\\, f]_{ij} = \\frac{\\partial^2 f}{\\partial M_i \\partial M_j}$.\nThe function $F_\\lambda(\\mathbf{M})$ can be written as a quadratic form:\n$$ F_\\lambda(\\mathbf{M}) = \\frac{1}{2} \\mathbf{M}^\\top (\\mathbb{I}^{-1} - \\lambda \\mathbf{I}) \\mathbf{M} $$\nwhere $\\mathbf{I}$ is the $3 \\times 3$ identity matrix.\nThe Hessian of a quadratic form $\\frac{1}{2}\\mathbf{x}^\\top A \\mathbf{x}$ (for symmetric $A$) is simply $A$.\nTherefore, the Hessian of $F_\\lambda$ is constant (independent of $\\mathbf{M}$):\n$$ \\mathrm{Hess}\\, F_\\lambda(\\mathbf{M}_e) = \\mathbb{I}^{-1} - \\lambda \\mathbf{I} = \\mathrm{diag}\\left(\\frac{1}{I_1}, \\frac{1}{I_2}, \\frac{1}{I_3}\\right) - \\frac{1}{I_{k+1}}\\mathbf{I} $$\nLet's denote this matrix by $\\mathbf{H}_F$.\n\n**Step 3: Construct Orthonormal Basis and Reduced Quadratic Form**\n\nThe stability analysis is performed on a slice $\\mathcal{S}$ tangent to the coadjoint orbit at $\\mathbf{M}_e$. The coadjoint orbits are spheres of constant $\\|\\mathbf{M}\\|$, so the tangent space at $\\mathbf{M}_e$ is the plane orthogonal to $\\mathbf{M}_e$.\n$$ \\mathcal{S} = \\{\\delta \\mathbf{M} \\in \\mathbb{R}^3 \\mid \\mathbf{M}_e^\\top \\delta \\mathbf{M} = 0\\} $$\nFor $\\mathbf{M}_e = m \\mathbf{e}_k$, this is the plane orthogonal to $\\mathbf{e}_k$. We need to construct a generic orthonormal basis $\\{\\mathbf{v}_1, \\mathbf{v}_2\\}$ for this plane.\nA general numerical procedure is as follows:\n1.  Define the unit normal vector to the plane: $\\hat{\\mathbf{n}} = \\mathbf{M}_e / \\|\\mathbf{M}_e\\| = \\mathbf{e}_k$.\n2.  Choose an arbitrary vector $\\mathbf{d}$ that is not parallel to $\\hat{\\mathbf{n}}$. A numerically robust choice is to pick a standard basis vector that is \"most orthogonal\" to $\\hat{\\mathbf{n}}$. For instance, if $\\hat{\\mathbf{n}}=\\mathbf{e}_0$, we can pick $\\mathbf{d}=\\mathbf{e}_1$.\n3.  The first basis vector $\\mathbf{v}_1$ is found by taking the cross product and normalizing: $\\mathbf{v}_1 = \\frac{\\hat{\\mathbf{n}} \\times \\mathbf{d}}{\\|\\hat{\\mathbf{n}} \\times \\mathbf{d}\\|}$. This vector is guaranteed to be in the plane $\\mathcal{S}$.\n4.  The second basis vector $\\mathbf{v}_2$ is found by another cross product: $\\mathbf{v}_2 = \\hat{\\mathbf{n}} \\times \\mathbf{v}_1$. Since $\\hat{\\mathbf{n}}$ and $\\mathbf{v}_1$ are orthonormal, $\\mathbf{v}_2$ is automatically a unit vector and completes the orthonormal basis $\\{\\mathbf{v}_1, \\mathbf{v}_2\\}$ for the plane $\\mathcal{S}$.\n\nLet $V = [\\mathbf{v}_1 | \\mathbf{v}_2]$ be the $3 \\times 2$ matrix whose columns are the basis vectors. The reduced quadratic form, which represents the second variation of $F_\\lambda$ on the slice $\\mathcal{S}$, is given by the $2 \\times 2$ matrix $Q$:\n$$ Q = V^\\top \\mathbf{H}_F V $$\nThe entries of $Q$ are $q_{ij} = \\mathbf{v}_i^\\top \\mathbf{H}_F \\mathbf{v}_j$.\n\n**Step 4  5: Eigenvalue Analysis and Classification**\n\nThe definiteness of the quadratic form on the slice is determined by the properties of the matrix $Q$. Since $Q$ is a real symmetric matrix, we can determine its definiteness from the signs of its two eigenvalues, $\\mu_1$ and $\\mu_2$.\nA numerical tolerance $t  0$ is used to classify eigenvalues as positive, negative, or zero.\n-   If $\\mu_1  t$ and $\\mu_2  t$, $Q$ is **positive definite** (code $1$).\n-   If $\\mu_1  -t$ and $\\mu_2  -t$, $Q$ is **negative definite** (code $-1$).\n-   If $(\\mu_1  t \\text{ and } \\mu_2  -t)$ or $(\\mu_1  -t \\text{ and } \\mu_2  t)$, $Q$ is **indefinite** (code $0$).\n-   In all other cases, at least one eigenvalue is numerically zero (i.e., its absolute value is $\\le t$). According to the problem's definition, these cases are classified as **semidefinite** (code $2$). This includes cases where one eigenvalue is zero and the other is non-zero, or both are zero.\n\nArnold's theorem implies that if the reduced form $Q$ is definite (positive or negative), the equilibrium is nonlinearly stable. If it is indefinite, the equilibrium is unstable.\nThe following implementation carries out these steps numerically for the given test cases.",
            "answer": "```python\nimport numpy as np\n\ndef classify_definiteness(mu1, mu2, tol):\n    \"\"\"\n    Classifies the definiteness of a 2x2 symmetric matrix based on its eigenvalues.\n\n    Args:\n        mu1 (float): First eigenvalue.\n        mu2 (float): Second eigenvalue.\n        tol (float): Tolerance for treating a value as zero.\n\n    Returns:\n        int: Classification code (1, -1, 0, 2).\n    \"\"\"\n    is_pos1 = mu1  tol\n    is_pos2 = mu2  tol\n    is_neg1 = mu1  -tol\n    is_neg2 = mu2  -tol\n\n    # Indefinite: eigenvalues have opposite signs.\n    if (is_pos1 and is_neg2) or (is_neg1 and is_pos2):\n        return 0\n\n    # Positive definite: both eigenvalues are strictly positive.\n    if is_pos1 and is_pos2:\n        return 1\n\n    # Negative definite: both eigenvalues are strictly negative.\n    if is_neg1 and is_neg2:\n        return -1\n\n    # Semidefinite: all other cases, where at least one eigenvalue is\n    # numerically zero and they do not have opposite signs.\n    return 2\n\ndef analyze_stability(I_diag_vals, k_axis, m_magnitude, tolerance):\n    \"\"\"\n    Performs stability analysis for a given rigid body equilibrium.\n\n    Args:\n        I_diag_vals (tuple): Principal moments of inertia (I1, I2, I3).\n        k_axis (int): Index of the equilibrium axis (0, 1, or 2).\n        m_magnitude (float): Magnitude of the angular momentum.\n        tolerance (float): Numerical tolerance for zero checks.\n\n    Returns:\n        int: The definiteness classification code.\n    \"\"\"\n    # Step 0: Setup inertia tensors\n    I_diag = np.array(I_diag_vals, dtype=float)\n    I_inv = np.diag(1.0 / I_diag)\n\n    # Step 1: Determine the Lagrange multiplier lambda\n    # Equilibrium M_e = m * e_k, where e_k is the standard basis vector.\n    # The moment of inertia for this principal axis is I_diag[k_axis].\n    lambda_val = 1.0 / I_diag[k_axis]\n\n    # Define the equilibrium angular momentum vector M_e\n    M_e = np.zeros(3)\n    M_e[k_axis] = m_magnitude\n\n    # Step 2: Compute the Hessian of the augmented function F_lambda\n    # Hess(F_lambda) = I^-1 - lambda * Identity\n    hess_F = I_inv - lambda_val * np.identity(3)\n\n    # Step 3: Construct an orthonormal basis for the slice S\n    # The slice S is the plane orthogonal to M_e. Its normal is n_hat.\n    n_hat = np.zeros(3)\n    n_hat[k_axis] = 1.0 # Normalization is trivial since M_e is along an axis\n\n    # Construct a robust orthonormal basis {v1, v2} for the slice\n    # Pick a dummy vector not parallel to n_hat.\n    dummy_vec = np.array([1.0, 0.0, 0.0])\n    if abs(np.dot(n_hat, dummy_vec))  1.0 - tolerance:\n        # If n_hat is parallel to [1,0,0], use [0,1,0] instead.\n        dummy_vec = np.array([0.0, 1.0, 0.0])\n\n    # v1 is orthogonal to n_hat (and in the slice)\n    v1_unnormalized = np.cross(n_hat, dummy_vec)\n    v1 = v1_unnormalized / np.linalg.norm(v1_unnormalized)\n\n    # v2 is orthogonal to both n_hat and v1, completing the basis for the slice\n    v2 = np.cross(n_hat, v1)\n    \n    # Form the basis matrix V from the column vectors v1, v2\n    V = np.column_stack((v1, v2))\n\n    # Step 4: Compute the reduced quadratic form Q\n    # Q = V^T * Hess(F_lambda) * V\n    Q_matrix = V.T @ hess_F @ V\n\n    # Step 5: Compute eigenvalues of Q and classify definiteness\n    # Use eigvalsh as Q is symmetric by construction.\n    eigenvalues = np.linalg.eigvalsh(Q_matrix)\n    mu1, mu2 = eigenvalues[0], eigenvalues[1]\n    \n    return classify_definiteness(mu1, mu2, tolerance)\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # The magnitude of momentum m is arbitrary (let m=1.0) as it does not affect\n    # the definiteness of the Hessian for this quadratic system.\n    m_magnitude = 1.0\n    # A reasonable tolerance for floating-point zero checks.\n    tolerance = 1e-9\n\n    test_cases = [\n        # Case A: Stable rotation about the smallest inertia axis\n        {'I_vals': (2.0, 3.0, 5.0), 'k': 0},\n        # Case B: Stable rotation about the largest inertia axis\n        {'I_vals': (2.0, 3.0, 5.0), 'k': 2},\n        # Case C: Unstable rotation about the middle inertia axis\n        {'I_vals': (2.0, 3.0, 5.0), 'k': 1},\n        # Case D: Semidefinite (degenerate) case\n        {'I_vals': (1.0, 1.0, 2.0), 'k': 0},\n    ]\n\n    results = []\n    for case in test_cases:\n        result_code = analyze_stability(\n            case['I_vals'],\n            case['k'],\n            m_magnitude,\n            tolerance\n        )\n        results.append(result_code)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}