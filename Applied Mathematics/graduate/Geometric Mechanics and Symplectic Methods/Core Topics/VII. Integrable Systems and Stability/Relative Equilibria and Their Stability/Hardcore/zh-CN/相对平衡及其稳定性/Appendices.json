{
    "hands_on_practices": [
        {
            "introduction": "理论学习需要通过实践来巩固。本节的第一个练习将带领我们应用能量-卡西米尔方法，这是分析李-泊松系统稳定性的一个核心工具。我们将以自由刚体这一几何力学中的经典模型为对象，通过构造一个增广的能量函数并分析其二阶变分，来直接判断其主轴定常转动的稳定性，而无需直接求解复杂的动力学方程。这个练习旨在让你熟练掌握在余伴随轨道上利用守恒量判断相对平衡稳定性的基本计算技巧。",
            "id": "3731511",
            "problem": "将自由刚体视为特殊正交李代数 $\\mathfrak{so}(3)^{*}$ 的对偶空间上的一个哈密顿系统，其具有李-泊松括号。设物体角动量在主轴坐标系下为 $m \\in \\mathfrak{so}(3)^{*} \\cong \\mathbb{R}^{3}$，哈密顿量为 $H(m) = \\frac{1}{2}\\left(\\frac{m_{1}^{2}}{I_{1}} + \\frac{m_{2}^{2}}{I_{2}} + \\frac{m_{3}^{2}}{I_{3}}\\right)$，其中 $0  I_{1}  I_{2}  I_{3}$ 是主转动惯量。$\\mathfrak{so}(3)^{*}$ 的余伴随轨道是球面，卡西米尔函数是 $C(m) = \\frac{1}{2}\\|m\\|^{2}$ 的函数。考虑能量-卡西米尔泛函 $\\mathcal{E}(m) = H(m) + \\lambda \\|m\\|^{2}$，其中 $\\lambda \\in \\mathbb{R}$ 的选择应使得给定的相对平衡点 $m^{\\ast}$ 是 $\\mathcal{E}$ 的一个临界点。\n\n仅使用上述定义和李-泊松系统的几何结构，对绕中间主轴稳定转动所对应的相对平衡点执行以下步骤：\n1. 确定 $\\lambda$ 需满足的条件，使得 $m^{\\ast} = M e_{2}$（其中 $M \\neq 0$，$e_{2}$ 是沿第二主轴的单位向量）是 $\\mathcal{E}$ 的一个临界点。\n2. 计算 $\\mathcal{E}$ 在 $m^{\\ast}$ 处的 Hessian 矩阵，并将其限制在 $m^{\\ast}$ 处余伴随轨道的切空间上（等价地，限制在与 $m^{\\ast}$ 正交的平面上）。\n3. 用 $I_{1}$、$I_{2}$ 和 $I_{3}$ 表示此受限 Hessian 矩阵的行列式。\n\n答案规格：\n- 将步骤 $3$ 中得到的行列式以单一闭式解析表达式的形式给出最终答案。\n- 无需进行数值计算或四舍五入。\n- 最终答案中无需包含物理单位。",
            "solution": "### 解答\n\n我们将依次执行三个必需的步骤以得出最终答案。\n\n**第1步：临界点对 $\\lambda$ 的条件**\n\n能量-卡西米尔泛函由 $\\mathcal{E}(m) = H(m) + \\lambda \\|m\\|^{2}$ 给出。我们可以用 $m = (m_1, m_2, m_3)$ 的分量明确写出：\n$$\n\\mathcal{E}(m_1, m_2, m_3) = \\frac{1}{2}\\left(\\frac{m_{1}^{2}}{I_{1}} + \\frac{m_{2}^{2}}{I_{2}} + \\frac{m_{3}^{2}}{I_{3}}\\right) + \\lambda(m_{1}^{2} + m_{2}^{2} + m_{3}^{2})\n$$\n这可以重新组合为：\n$$\n\\mathcal{E}(m) = \\left(\\frac{1}{2I_1} + \\lambda\\right) m_1^2 + \\left(\\frac{1}{2I_2} + \\lambda\\right) m_2^2 + \\left(\\frac{1}{2I_3} + \\lambda\\right) m_3^2\n$$\n如果 $\\mathcal{E}$ 的微分（或梯度）在点 $m^{\\ast}$ 处为零，即 $d\\mathcal{E}(m^{\\ast}) = 0$，则该点是 $\\mathcal{E}$ 的一个临界点。$\\mathcal{E}$ 的偏导数是：\n$$\n\\frac{\\partial \\mathcal{E}}{\\partial m_1} = 2\\left(\\frac{1}{2I_1} + \\lambda\\right) m_1 = \\left(\\frac{1}{I_1} + 2\\lambda\\right) m_1\n$$\n$$\n\\frac{\\partial \\mathcal{E}}{\\partial m_2} = \\left(\\frac{1}{I_2} + 2\\lambda\\right) m_2\n$$\n$$\n\\frac{\\partial \\mathcal{E}}{\\partial m_3} = \\left(\\frac{1}{I_3} + 2\\lambda\\right) m_3\n$$\n相对平衡点为 $m^{\\ast} = M e_{2} = (0, M, 0)$，其中 $M \\neq 0$。我们在此点计算梯度：\n$$\n\\frac{\\partial \\mathcal{E}}{\\partial m_1}\\bigg|_{m^{\\ast}} = \\left(\\frac{1}{I_1} + 2\\lambda\\right) (0) = 0\n$$\n$$\n\\frac{\\partial \\mathcal{E}}{\\partial m_2}\\bigg|_{m^{\\ast}} = \\left(\\frac{1}{I_2} + 2\\lambda\\right) M\n$$\n$$\n\\frac{\\partial \\mathcal{E}}{\\partial m_3}\\bigg|_{m^{\\ast}} = \\left(\\frac{1}{I_3} + 2\\lambda\\right) (0) = 0\n$$\n为了使梯度为零向量，第二个分量必须为零。由于 $M \\neq 0$，这要求括号内的项为零：\n$$\n\\frac{1}{I_2} + 2\\lambda = 0 \\implies 2\\lambda = -\\frac{1}{I_2} \\implies \\lambda = -\\frac{1}{2I_2}\n$$\n这就是对 $\\lambda$ 的条件。\n\n**第2步：$\\mathcal{E}$ 在 $m^{\\ast}$ 处的 Hessian 矩阵**\n\n$\\mathcal{E}$ 的 Hessian 矩阵是二阶偏导数矩阵，$D^2\\mathcal{E}(m) = \\left[\\frac{\\partial^2 \\mathcal{E}}{\\partial m_i \\partial m_j}\\right]$。二阶导数是：\n$$\n\\frac{\\partial^2 \\mathcal{E}}{\\partial m_1^2} = \\frac{1}{I_1} + 2\\lambda\n$$\n$$\n\\frac{\\partial^2 \\mathcal{E}}{\\partial m_2^2} = \\frac{1}{I_2} + 2\\lambda\n$$\n$$\n\\frac{\\partial^2 \\mathcal{E}}{\\partial m_3^2} = \\frac{1}{I_3} + 2\\lambda\n$$\n所有 $i \\neq j$ 的混合偏导数 $\\frac{\\partial^2 \\mathcal{E}}{\\partial m_i \\partial m_j}$ 均为零。因此，Hessian 矩阵是一个对角矩阵，其值是常数（与 $m$ 无关）。\n为了求出在临界点 $m^{\\ast}$ 处的 Hessian 矩阵，我们代入第1步中求得的值 $2\\lambda = -1/I_2$：\n$$\nD^2\\mathcal{E}(m^{\\ast}) = \\begin{pmatrix}\n\\frac{1}{I_1} - \\frac{1}{I_2}  0  0 \\\\\n0  \\frac{1}{I_2} - \\frac{1}{I_2}  0 \\\\\n0  0  \\frac{1}{I_3} - \\frac{1}{I_2}\n\\end{pmatrix} = \\begin{pmatrix}\n\\frac{I_2 - I_1}{I_1 I_2}  0  0 \\\\\n0  0  0 \\\\\n0  0  \\frac{I_2 - I_3}{I_2 I_3}\n\\end{pmatrix}\n$$\n\n**第3步：受限 Hessian 矩阵的行列式**\n\n$\\mathfrak{so}(3)^{*}$ 的余伴随轨道是以原点为中心的球面。经过 $m^{\\ast} = (0, M, 0)$ 的轨道是球面 $\\|m\\|^2 = M^2$。此轨道在 $m^{\\ast}$ 处的切空间，记作 $T_{m^{\\ast}}\\mathcal{O}$，是所有与 $m^{\\ast}$ 正交的向量 $v \\in \\mathbb{R}^3$ 的集合。\n$$\nv \\cdot m^{\\ast} = 0 \\implies (v_1, v_2, v_3) \\cdot (0, M, 0) = M v_2 = 0\n$$\n由于 $M \\neq 0$，我们有 $v_2 = 0$。这意味着切空间是 $m_1$-$m_3$ 平面，由基向量 $e_1 = (1, 0, 0)$ 和 $e_3 = (0, 0, 1)$ 张成。\n\n为了求出受限 Hessian 矩阵，我们考虑对于切空间中的任意向量 $v \\in T_{m^{\\ast}}\\mathcal{O}$ 的二次型 $q(v) = v^{T} [D^2\\mathcal{E}(m^{\\ast})] v$。切空间中的向量可以写成 $v = c_1 e_1 + c_3 e_3 = (c_1, 0, c_3)$。受限 Hessian 矩阵 $H_{res}$ 在基 $\\{e_1, e_3\\}$ 下的矩阵是 $D^2\\mathcal{E}(m^{\\ast})$ 中对应于第一行、第三行和第一列、第三列的 $2 \\times 2$ 子矩阵。\n$$\nH_{res} = \\begin{pmatrix}\n\\frac{I_2 - I_1}{I_1 I_2}  0 \\\\\n0  \\frac{I_2 - I_3}{I_2 I_3}\n\\end{pmatrix}\n$$\n这个受限 Hessian 矩阵的行列式是其对角线元素的乘积：\n$$\n\\det(H_{res}) = \\left(\\frac{I_2 - I_1}{I_1 I_2}\\right) \\left(\\frac{I_2 - I_3}{I_2 I_3}\\right)\n$$\n简化表达式，我们得到最终结果：\n$$\n\\det(H_{res}) = \\frac{(I_2 - I_1)(I_2 - I_3)}{I_1 I_2^2 I_3}\n$$\n根据排序 $0  I_{1}  I_{2}  I_{3}$，我们有 $I_2 - I_1 > 0$ 和 $I_2 - I_3  0$，这意味着行列式为负。这表明受限 Hessian 矩阵是不定的，意味着该平衡点是余伴随轨道上有效势 $\\mathcal{E}$ 的一个鞍点，因此是不稳定的。",
            "answer": "$$\n\\boxed{\\frac{(I_2 - I_1)(I_2 - I_3)}{I_1 I_2^{2} I_3}}\n$$"
        },
        {
            "introduction": "在掌握了能量-卡西米尔方法的基础后，我们将挑战一个更复杂的系统：受重力作用的对称陀螺。此练习将引导你运用更普适的能量-动量方法，它适用于具有对称性的更广泛的哈密顿系统。你将需要从第一性原理出发，计算“锁定转动惯量”并构造“增广势能”，最终推导出著名的“睡眠陀螺”保持直立旋转的稳定性条件。这个实践不仅加深了对能量-动量方法理论框架的理解，也展示了它在解决具体物理问题时的威力。",
            "id": "3775624",
            "problem": "考虑一个在其尖端有一个固定点的对称刚体（轴对称陀螺）。其关于固定点的体坐标系惯性张量是对角的，主转动惯量为 $I_{1}=I_{2}$ 和 $I_{3}$，其中 $I_{3}$ 是围绕对称轴的转动惯量。其质量为 $m$，质心位于对称轴上，距离固定点为 $c$，均匀引力场的强度为 $g$。位形空间是特殊正交群 $\\mathrm{SO}(3)$，并且存在一个由围绕垂直空间轴的旋转给出的二维特殊正交群 $\\mathrm{SO}(2)$ 对称性。\n\n将此视为一个简单力学系统，其动能由惯性张量导出的黎曼度量定义，势能 $V(q)$ 由引力高度给出。设 $\\theta$ 表示刚体对称轴与垂直空间轴之间的夹角。使用能量-动量方法研究相对平衡的稳定性，从第一性原理出发，按以下步骤进行：\n\n- 定义 $\\mathrm{SO}(2)$ 对称性的动量映射，以及在位形 $q \\in \\mathrm{SO}(3)$ 处的锁定惯性张量 $\\mathbb{I}(q)$，它是由动能度量限制在通过 $q$ 的群轨道上所定义的 $\\mathrm{SO}(2)$ 李代数上的对称、正定算子。\n- 显式计算 $\\langle \\mathbb{I}(q)\\xi,\\xi\\rangle$，其中 $\\xi$ 是对应于围绕垂直轴的稳定自旋速率 $\\Omega$ 的 $\\mathrm{SO}(2)$ 作用的生成元，将其表示为角度 $\\theta$ 和主转动惯量 $I_{1}$、$I_{3}$ 的函数。\n- 构建增广势 $V_{\\xi}(q)=V(q)-\\frac{1}{2}\\langle \\mathbb{I}(q)\\xi,\\xi\\rangle$，并将其在直立位形（$\\theta=0$）附近按小倾角 $\\theta$ 展开至二阶，用 $I_{1}$、$I_{3}$、$m$、$g$ 和 $c$ 表示决定稳定性的二次型。\n- 对此阿贝尔对称性计算 Arnold 形式，并解释其对辛切片上二次型的贡献（或无贡献）。\n- 从上述得到的总二次型的正定性出发，确定临界自旋大小 $\\Omega_{\\mathrm{crit}}$，当自旋大于此值时，直立旋转的陀螺是一个能量-动量稳定的相对平衡。\n\n将你的最终答案表示为 $\\Omega_{\\mathrm{crit}}$ 的封闭形式解析表达式，单位为弧度/秒。没有提供数值；你的答案必须保持符号形式，且无需取整。",
            "solution": "### 解答\n\n我们按照问题中概述的步骤，使用能量-动量方法推导稳定性条件。\n\n**1. 坐标、能量和对称性**\n\n- **坐标与能量：** 设空间坐标系的基为 $\\{\\mathbf{e}_1, \\mathbf{e}_2, \\mathbf{e}_3\\}$，其中 $\\mathbf{e}_3$ 垂直向上。体坐标系的基为 $\\{\\mathbf{b}_1, \\mathbf{b}_2, \\mathbf{b}_3\\}$，其中 $\\mathbf{b}_3$ 沿陀螺对称轴。位形由旋转矩阵 $R \\in \\mathrm{SO}(3)$ 描述。势能是质心的引力势能 $V = mgz_{\\mathrm{cm}}$。质心在体坐标系中的位置为 $c\\mathbf{b}_3$，在空间坐标系中的高度为 $z_{\\mathrm{cm}} = (R(c\\mathbf{b}_3)) \\cdot \\mathbf{e}_3 = c(R\\mathbf{b}_3) \\cdot \\mathbf{e}_3$。设 $\\theta$ 为刚体对称轴 $R\\mathbf{b}_3$ 与空间垂直轴 $\\mathbf{e}_3$ 的夹角，则 $\\cos\\theta = (R\\mathbf{b}_3) \\cdot \\mathbf{e}_3$。因此，势能为 $V(\\theta) = mgc\\cos\\theta$。\n\n- **对称性：** 系统具有绕空间垂直轴 $\\mathbf{e}_3$ 旋转的 $\\mathrm{SO}(2)$ 对称性。相对平衡是绕该轴以恒定角速度 $\\Omega$ 旋转的运动。其生成元为 $\\xi \\in \\mathfrak{so}(2) \\cong \\mathbb{R}$，对应于空间角速度向量 $\\boldsymbol{\\Omega}_s = \\Omega \\mathbf{e}_3$。\n\n**2. 锁定惯性张量**\n\n锁定惯性张量 $\\mathbb{I}(R): \\mathfrak{so}(2) \\to \\mathfrak{so}(2)^*$ 描述了当刚体仅沿群轨道运动时的动能。与生成元 $\\xi$ 相关的体角速度 $\\boldsymbol{\\omega}_\\xi$ 由 $\\hat{\\boldsymbol{\\omega}}_\\xi = R^{-1}\\hat{\\xi}_s R$ 给出，其中 $\\hat{\\xi}_s$ 是 $\\boldsymbol{\\Omega}_s$ 的反对称矩阵形式。这等价于 $\\boldsymbol{\\omega}_\\xi = R^T \\boldsymbol{\\Omega}_s = \\Omega(R^T \\mathbf{e}_3)$。\n\n$\\langle \\mathbb{I}(R)\\xi, \\xi \\rangle$ 项是相应锁定运动动能的两倍：\n$$\n\\langle \\mathbb{I}(R)\\xi, \\xi \\rangle = \\boldsymbol{\\omega}_\\xi^T I \\boldsymbol{\\omega}_\\xi = (\\Omega R^T \\mathbf{e}_3)^T I (\\Omega R^T \\mathbf{e}_3) = \\Omega^2 (R^T \\mathbf{e}_3)^T I (R^T \\mathbf{e}_3)\n$$\n令 $\\boldsymbol{\\nu} = R^T \\mathbf{e}_3$ 为空间垂直向量在体坐标系中的表示。其分量为 $\\nu_i = \\boldsymbol{\\nu} \\cdot \\mathbf{b}_i$。特别地，$\\nu_3 = (R^T \\mathbf{e}_3) \\cdot \\mathbf{b}_3 = \\mathbf{e}_3 \\cdot (R\\mathbf{b}_3) = \\cos\\theta$。由于 $\\boldsymbol{\\nu}$ 是单位向量，我们有 $\\nu_1^2 + \\nu_2^2 = 1 - \\nu_3^2 = \\sin^2\\theta$。代入惯性张量 $I = \\mathrm{diag}(I_1, I_1, I_3)$，我们得到：\n$$\n(R^T \\mathbf{e}_3)^T I (R^T \\mathbf{e}_3) = \\boldsymbol{\\nu}^T I \\boldsymbol{\\nu} = I_1 \\nu_1^2 + I_1 \\nu_2^2 + I_3 \\nu_3^2 = I_1(\\nu_1^2+\\nu_2^2) + I_3\\nu_3^2 = I_1\\sin^2\\theta + I_3\\cos^2\\theta\n$$\n因此，我们得到所求的表达式：\n$$\n\\langle \\mathbb{I}(R)\\xi, \\xi \\rangle = \\Omega^2(I_1\\sin^2\\theta + I_3\\cos^2\\theta)\n$$\n\n**3. 增广势及其展开**\n\n增广势 $V_{\\xi}$ 定义为 $V_{\\xi}(q) = V(q) - \\frac{1}{2}\\langle \\mathbb{I}(q)\\xi, \\xi \\rangle$。代入前述表达式：\n$$\nV_{\\xi}(\\theta) = mgc\\cos\\theta - \\frac{1}{2}\\Omega^2(I_1\\sin^2\\theta + I_3\\cos^2\\theta)\n$$\n我们研究直立位形 $\\theta=0$ 的稳定性。为此，我们将 $V_{\\xi}(\\theta)$ 在 $\\theta=0$ 附近展开至二阶。使用泰勒近似 $\\cos\\theta \\approx 1 - \\frac{\\theta^2}{2}$ 和 $\\sin\\theta \\approx \\theta$：\n$$\nV_{\\xi}(\\theta) \\approx mgc\\left(1 - \\frac{\\theta^2}{2}\\right) - \\frac{1}{2}\\Omega^2(I_1\\theta^2 + I_3(1-\\theta^2))\n$$\n$$\nV_{\\xi}(\\theta) \\approx \\left(mgc - \\frac{1}{2}\\Omega^2 I_3\\right) - \\frac{1}{2}mgc\\theta^2 - \\frac{1}{2}\\Omega^2(I_1 - I_3)\\theta^2\n$$\n将关于 $\\theta^2$ 的项合并：\n$$\nV_{\\xi}(\\theta) \\approx V_{\\xi}(0) + \\frac{1}{2}\\left[\\Omega^2(I_3 - I_1) - mgc\\right]\\theta^2\n$$\n在 $\\theta=0$ 处，一阶变分为零，确认了其为临界点。决定稳定性的二次型由 $\\theta^2$ 的系数给出。\n\n**4. Arnold 形式**\n\n对于阿贝尔（交换）对称群，如本例中的 $\\mathrm{SO}(2)$，其李代数 $\\mathfrak{g}$ 的李括号恒为零。Arnold 形式的定义依赖于李括号，因此对于任何阿贝尔对称群，Arnold 形式都恒为零。它对稳定性的二次型没有贡献。\n\n**5. 稳定性条件与临界自旋**\n\n直立旋转的陀螺的稳定性由增广势 $V_\\xi$ 在 $\\theta=0$ 处的二阶变分的符号决定。为使该位形成（李雅普诺夫）稳定，二阶变分必须是正定的。这意味着 $\\theta^2$ 的系数必须为正：\n$$\n\\Omega^2(I_3 - I_1) - mgc > 0\n$$\n要满足此不等式，必须有 $I_3 - I_1 > 0$，即 $I_3 > I_1$（陀螺是“细长”的）。在此条件下，我们可以解出 $\\Omega^2$：\n$$\n\\Omega^2 > \\frac{mgc}{I_3 - I_1}\n$$\n临界自旋大小 $\\Omega_{\\mathrm{crit}}$ 是满足稳定条件的最小自旋速率的绝对值。因此，\n$$\n\\Omega_{\\mathrm{crit}} = \\sqrt{\\frac{mgc}{I_3-I_1}}\n$$",
            "answer": "$$\\boxed{\\sqrt{\\frac{mgc}{I_{3}-I_{1}}}}$$"
        },
        {
            "introduction": "理论分析与数值计算是现代科学研究的两翼。最后一个练习将理论与实践相结合，要求你为中心力场中的相对平衡问题设计并实现一个数值求解方案。你将首先需要运用辛约化的思想，将二维平面上的动力学问题降维成一个关于径向坐标的一维有效势问题。随后，你需要编写程序来数值求解平衡点（即相对平衡的半径）并判断其稳定性。这个练习不仅能让你体验如何将抽象的几何力学理论转化为可执行的算法，也突显了在面对解析解不可行时，计算方法作为研究工具的重要性。",
            "id": "3764833",
            "problem": "考虑一个在余切丛 $T^*\\mathbb{R}^2$ 上的哈密顿系统，其正则坐标为 $(q,p)$，其中 $q \\in \\mathbb{R}^2$ 且 $p \\in \\mathbb{R}^2$。辛形式为标准形式，由 $\\omega = dq \\wedge dp$ 给出。哈密顿量 $H$ 是简单机械类型的，即 $H(q,p) = \\tfrac{1}{2}\\|p\\|^2 + V(\\|q\\|)$，其中 $V$ 是一个光滑的、仅依赖于半径 $r = \\|q\\|$ 的径向对称势。\n\n令二维特殊正交群 (SO$(2)$) 通过旋转作用于位形空间，其作用以正则方式提升至 $T^*\\mathbb{R}^2$。相关的动量映射 $J: T^*\\mathbb{R}^2 \\to \\mathbb{R}$ 是标量角动量 $J(q,p) = q_1 p_2 - q_2 p_1$。如果存在一个李代数元 $\\xi \\in \\mathfrak{so}(2)$（等价于一个标量角速度 $\\omega$），使得哈密顿向量场 $X_H(z)$ 等于由 $\\xi$ 诱导的在 $z$ 点的群作用的无穷小生成元，则称状态 $z \\in T^*\\mathbb{R}^2$ 为一个相对平衡。\n\n从这些基本定义出发，在动量映射 $J = \\mu$ 的固定值上使用辛约化，将相对平衡刻画为径向坐标 $r$ 的约化动力学的平衡点。然后，设计一种数值方法，对于给定的光滑中心势 $V(r)$ 和固定的角动量 $\\mu$，构造出相对平衡的所有正半径 $r  0$，并通过评估约化能量沿径向方向的二次变分的定号性来验证其稳定性。角速度 $\\omega$ 以弧度每单位时间表示。\n\n您的任务是实现一个程序，对每个提供的测试用例执行以下操作：\n- 构造在固定角动量 $J = \\mu$ 下，对于辛约化径向动力学而言是驻定的所有正半径 $r$。\n- 对于每个这样的半径 $r$，计算与相对平衡相关联的角速度 $\\omega$。\n- 通过检查约化单自由度问题中的二次变分在 $r$ 处是否为正来对径向稳定性进行分类；如果为正，则返回 $True$，否则返回 $False$。\n\n您的程序必须处理以下测试套件。在每个案例中，$r$ 是径向坐标，$\\mu$ 是固定的角动量，$V(r)$ 按指定方式定义。下面提供的所有数值都是无量纲的，并且必须如此处理。角速度必须以弧度每单位时间（无量纲时间）表示。\n\n- 测试用例 1（正常路径，单根，凸势）：\n  - 势类型：谐振势，$V(r) = \\tfrac{1}{2}\\kappa r^2$，参数 $\\kappa = 2.0$。\n  - 角动量：$\\mu = 1.5$。\n\n- 测试用例 2（边界情况，长程引力，单根）：\n  - 势类型：Kepler 势加约束势，其中约束为零，$V(r) = -\\alpha / r + \\tfrac{1}{2}\\beta r^2$，参数 $\\alpha = 1.0$，$\\beta = 0.0$。\n  - 角动量：$\\mu = 0.5$。\n\n- 测试用例 3（混合曲率，约束加引力，可能根据参数有多个根）：\n  - 势类型：Kepler 势加约束势，$V(r) = -\\alpha / r + \\tfrac{1}{2}\\beta r^2$，参数 $\\alpha = 2.0$，$\\beta = 0.5$。\n  - 角动量：$\\mu = 0.2$。\n\n- 测试用例 4（多阱多项式，允许多个驻定半径的势）：\n  - 势类型：六次多项式势，$V(r) = \\tfrac{1}{2}\\kappa r^2 - \\tfrac{1}{4}\\delta r^4 + 0.1 \\lambda r^6$，参数 $\\kappa = 1.0$，$\\delta = 3.0$，$\\lambda = 0.5$。\n  - 角动量：$\\mu = 10^{-6}$。\n\n- 测试用例 5（边缘情况，没有物理驻定半径的反谐振势）：\n  - 势类型：谐振势，$V(r) = \\tfrac{1}{2}\\kappa r^2$，参数 $\\kappa = -1.0$。\n  - 角动量：$\\mu = 0.2$。\n\n输出规范：\n- 对于每个测试用例，返回一个包含所有找到的相对平衡的列表，每个相对平衡以 $[r, \\omega, s]$ 形式的子列表表示，其中 $r$ 和 $\\omega$ 是浮点数，s 是一个布尔值，指示径向稳定性（$True$ 表示稳定，$False$ 表示不稳定）。\n- 如果某个测试用例不存在正的驻定半径，则为该案例返回一个空列表。\n- 您的程序应生成单行输出，其中包含一个列表，该列表包含每个测试用例的结果列表。例如：$[[[r_{11}, \\omega_{11}, s_{11}]], [[r_{21}, \\omega_{21}, s_{21}], [r_{22}, \\omega_{22}, s_{22}]], ...]$。\n\n角度单位要求：角速度 $\\omega$ 必须以弧度每单位时间（无量纲时间）表示。本问题中不出现其他物理单位。\n\n重要约束：\n- 推导和算法必须从基本基础开始：哈密顿系统、辛形式、动量映射和在固定 $J = \\mu$ 处的辛约化。\n- 不要在问题陈述中使用快捷公式；实现所需的所有具体公式必须在您的解答中推导出来。\n- 通过使用光滑势并正确处理定义域 $r  0$ 来确保科学真实性。\n\n您的程序不得要求任何用户输入，并且必须精确解决指定的测试套件。最终输出必须遵循上述的确切格式。",
            "solution": "### 方法推导\n\n对于具有 SO$(2)$ 对称性的平面中心力问题，我们可以通过辛约化将系统简化。在固定的角动量 $J = \\mu$ 水平集上，系统的动力学等价于一个关于径向坐标 $r$ 的一维哈密顿系统。该约化系统的哈密顿量为：\n$$\nH_{\\mathrm{red}}(r,p_r; \\mu) = \\tfrac{1}{2} p_r^2 + V_{\\mathrm{eff}}(r; \\mu)\n$$\n其中 $V_{\\mathrm{eff}}$ 是有效势，由原始势 $V(r)$ 和离心势组成：\n$$\nV_{\\mathrm{eff}}(r; \\mu) = V(r) + \\frac{\\mu^2}{2 r^2}\n$$\n系统的相对平衡对应于约化动力学中的平衡点。这些点满足 $p_r=0$ 且有效势的梯度为零。因此，驻定半径 $r > 0$ 是以下方程的解：\n$$\n\\frac{d}{dr} V_{\\mathrm{eff}}(r; \\mu) = \\frac{d}{dr} V(r) - \\frac{\\mu^2}{r^3} = 0\n$$\n与每个驻定半径 $r$ 相关的角速度 $\\omega$ 是圆形轨道上速度与半径的比值，可以通过角动量守恒导出：\n$$\n\\omega = \\frac{\\mu}{r^2}\n$$\n其单位为弧度每单位时间。\n\n相对平衡的稳定性由有效势在平衡点处的二阶变分决定。如果二阶变分为正定，则该点是 $V_{\\mathrm{eff}}$ 的一个局部极小值，相对平衡是（径向）稳定的。稳定性条件为：\n$$\n\\frac{d^2}{dr^2} V_{\\mathrm{eff}}(r; \\mu) \\bigg|_{r=r_{\\text{eq}}} = \\left(\\frac{d^2}{dr^2} V(r) + \\frac{3 \\mu^2}{r^4}\\right) \\bigg|_{r=r_{\\text{eq}}} > 0\n$$\n\n### 算法与实现\n\n基于上述推导，我们设计如下算法：\n1.  对于每个测试用例，定义势函数 $V(r)$ 及其一阶和二阶导数。\n2.  定义函数 $F(r; \\mu) = \\frac{d}{dr} V(r) - \\frac{\\mu^2}{r^3}$，其根对应于驻定半径。\n3.  在合适的区间 $(0, r_{\\max}]$ 内数值求解方程 $F(r; \\mu) = 0$ 的所有正根。这可以通过在网格上检测符号变化并结合鲁棒的求根算法（如 Brent 方法）来实现。\n4.  对于找到的每个驻定半径 $r_i$：\n    a. 计算角速度 $\\omega_i = \\mu / r_i^2$。\n    b. 计算有效势的二阶导数 $G(r_i; \\mu) = \\frac{d^2}{dr^2} V(r_i) + \\frac{3 \\mu^2}{r_i^4}$。\n    c. 判断稳定性：如果 $G(r_i; \\mu) > 0$，则稳定 ($True$)，否则不稳定 ($False$)。\n5.  将每个测试用例的结果组织成 $[r, \\omega, s]$ 列表，并按要求格式化最终输出。\n\n以下 Python 代码实现了该算法，并为指定的测试套件生成结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\n# Define potential functions and their derivatives for each type.\ndef potential_funcs(case):\n    ptype = case['type']\n    if ptype == 'harmonic':\n        kappa = case['kappa']\n        def V(r):\n            return 0.5 * kappa * r**2\n        def dV(r):\n            return kappa * r\n        def ddV(r):\n            return kappa\n        return V, dV, ddV\n    elif ptype == 'kepler_conf':\n        alpha = case['alpha']\n        beta = case['beta']\n        def V(r):\n            return -alpha / r + 0.5 * beta * r**2\n        def dV(r):\n            return alpha / r**2 + beta * r\n        def ddV(r):\n            return -2.0 * alpha / r**3 + beta\n        return V, dV, ddV\n    elif ptype == 'poly6':\n        kappa = case['kappa']\n        delta = case['delta']\n        lam = case['lambda']\n        # V(r) = 0.5 kappa r^2 - 0.25 delta r^4 + 0.1 lambda r^6\n        def V(r):\n            return 0.5 * kappa * r**2 - 0.25 * delta * r**4 + 0.1 * lam * r**6\n        def dV(r):\n            return kappa * r - delta * r**3 + 0.6 * lam * r**5\n        def ddV(r):\n            return kappa - 3.0 * delta * r**2 + 3.0 * lam * r**4\n        return V, dV, ddV\n    else:\n        raise ValueError(\"Unknown potential type\")\n\ndef find_stationary_radii(dV, mu, rmin=1e-6, rmax=100.0, ngrid=2000):\n    # F(r) = dV(r) - mu^2 / r^3\n    def F(r):\n        if r = 0: return np.nan\n        return dV(r) - (mu**2) / (r**3)\n    \n    # Construct a grid that is dense near small r and spans the search range\n    small = np.logspace(np.log10(rmin), np.log10(1.0), num=ngrid//2, base=10.0)\n    large = np.linspace(1.0 + 1e-9, rmax, num=ngrid//2) # Avoid duplicate 1.0\n    grid = np.unique(np.concatenate([small, large]))\n    \n    vals = np.array([F(r) for r in grid])\n    roots = []\n    \n    for i in range(len(grid)-1):\n        a, b = grid[i], grid[i+1]\n        fa, fb = vals[i], vals[i+1]\n        \n        if np.isnan(fa) or np.isnan(fb):\n            continue\n        \n        root = None\n        if abs(fa)  1e-12:\n            root = a\n        elif abs(fb)  1e-12:\n            root = b\n        elif fa * fb  0.0:\n            try:\n                res = root_scalar(F, bracket=(a, b), method='brentq')\n                if res.converged and res.root > 0:\n                    root = res.root\n            except (ValueError, RuntimeError):\n                continue\n        \n        if root is not None:\n            # Deduplicate roots\n            if not any(abs(root - r0)  1e-6 for r0 in roots):\n                roots.append(root)\n\n    roots.sort()\n    return roots\n\ndef classify_equilibria(case):\n    _, dV, ddV = potential_funcs(case)\n    mu = case['mu']\n    radii = find_stationary_radii(dV, mu)\n    eqs = []\n    for r in radii:\n        omega = mu / (r**2)\n        # Second derivative of effective potential: ddV + 3 mu^2 / r^4\n        G = ddV(r) + 3.0 * (mu**2) / (r**4)\n        stable = bool(G > 0.0)\n        eqs.append([float(r), float(omega), stable])\n    return eqs\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'type': 'harmonic', 'kappa': 2.0, 'mu': 1.5},                        # Case 1\n        {'type': 'kepler_conf', 'alpha': 1.0, 'beta': 0.0, 'mu': 0.5},        # Case 2\n        {'type': 'kepler_conf', 'alpha': 2.0, 'beta': 0.5, 'mu': 0.2},        # Case 3\n        {'type': 'poly6', 'kappa': 1.0, 'delta': 3.0, 'lambda': 0.5, 'mu': 1e-6},  # Case 4\n        {'type': 'harmonic', 'kappa': -1.0, 'mu': 0.2},                       # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        eqs = classify_equilibria(case)\n        results.append(eqs)\n\n    # Final print statement in the exact required format.\n    # The output of map(str, results) will use single quotes for strings, which is valid JSON/Python list representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}