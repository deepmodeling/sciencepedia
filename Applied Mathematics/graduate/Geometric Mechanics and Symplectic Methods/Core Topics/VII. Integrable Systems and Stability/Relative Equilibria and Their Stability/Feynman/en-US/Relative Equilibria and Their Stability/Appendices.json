{
    "hands_on_practices": [
        {
            "introduction": "We begin with a foundational example in geometric mechanics: the free rigid body, whose relative equilibria correspond to steady rotations about its principal axes of inertia. This exercise  provides a direct application of the energy-momentum method, in its energy-Casimir formulation, to analytically determine the stability of these rotations. By calculating the definiteness of the effective energy functional, you will uncover the classic result concerning the stability of the principal axes.",
            "id": "3731511",
            "problem": "Consider the free rigid body as a Hamiltonian system on the dual of the special orthogonal Lie algebra $\\mathfrak{so}(3)^{*}$ with the Lie-Poisson bracket. Let the body angular momentum be $m \\in \\mathfrak{so}(3)^{*} \\cong \\mathbb{R}^{3}$ in principal axes coordinates, and let the Hamiltonian be $H(m) = \\frac{1}{2}\\left(\\frac{m_{1}^{2}}{I_{1}} + \\frac{m_{2}^{2}}{I_{2}} + \\frac{m_{3}^{2}}{I_{3}}\\right)$, where $0 < I_{1} < I_{2} < I_{3}$ are the principal moments of inertia. The coadjoint orbits of $\\mathfrak{so}(3)^{*}$ are spheres, and the Casimir functions are functions of $C(m) = \\frac{1}{2}\\|m\\|^{2}$. Consider the energy-Casimir functional $\\mathcal{E}(m) = H(m) + \\lambda \\|m\\|^{2}$, where $\\lambda \\in \\mathbb{R}$ is to be chosen so that a given relative equilibrium $m^{\\ast}$ is a critical point of $\\mathcal{E}$.\n\nUsing only the above definitions and the geometric structure of the Lie-Poisson system, perform the following steps for the relative equilibrium corresponding to steady rotation about the intermediate principal axis:\n1. Identify the condition on $\\lambda$ such that $m^{\\ast} = M e_{2}$, with $M \\neq 0$ and $e_{2}$ the unit vector along the second principal axis, is a critical point of $\\mathcal{E}$.\n2. Compute the Hessian of $\\mathcal{E}$ at $m^{\\ast}$ and restrict it to the tangent space of the coadjoint orbit at $m^{\\ast}$ (equivalently, to the plane orthogonal to $m^{\\ast}$).\n3. Determine the determinant of this restricted Hessian in terms of $I_{1}$, $I_{2}$, and $I_{3}$.\n\nAnswer specification:\n- Provide your final answer as a single closed-form analytic expression for the determinant from step $3$.\n- No numerical evaluation or rounding is required.\n- No physical units are required in the final answer.",
            "solution": "The three required steps will be performed sequentially to arrive at the final answer.\n\n**Step 1: Condition on $\\lambda$ for the critical point**\n\nThe energy-Casimir functional is given by $\\mathcal{E}(m) = H(m) + \\lambda \\|m\\|^{2}$. We can write this explicitly in terms of the components of $m = (m_1, m_2, m_3)$:\n$$\n\\mathcal{E}(m_1, m_2, m_3) = \\frac{1}{2}\\left(\\frac{m_{1}^{2}}{I_{1}} + \\frac{m_{2}^{2}}{I_{2}} + \\frac{m_{3}^{2}}{I_{3}}\\right) + \\lambda(m_{1}^{2} + m_{2}^{2} + m_{3}^{2})\n$$\nA point $m^{\\ast}$ is a critical point of $\\mathcal{E}$ if the differential (or gradient) of $\\mathcal{E}$ vanishes at $m^{\\ast}$, i.e., $d\\mathcal{E}(m^{\\ast}) = 0$. The partial derivatives of $\\mathcal{E}$ are:\n$$\n\\frac{\\partial \\mathcal{E}}{\\partial m_1} = \\left(\\frac{1}{I_1} + 2\\lambda\\right) m_1\n$$\n$$\n\\frac{\\partial \\mathcal{E}}{\\partial m_2} = \\left(\\frac{1}{I_2} + 2\\lambda\\right) m_2\n$$\n$$\n\\frac{\\partial \\mathcal{E}}{\\partial m_3} = \\left(\\frac{1}{I_3} + 2\\lambda\\right) m_3\n$$\nThe relative equilibrium is given as $m^{\\ast} = M e_{2} = (0, M, 0)$, where $M \\neq 0$. We evaluate the gradient at this point. For the gradient to be the zero vector, the second component must be zero. Since $M \\neq 0$, this requires:\n$$\n\\frac{1}{I_2} + 2\\lambda = 0 \\implies \\lambda = -\\frac{1}{2I_2}\n$$\nThis is the condition on $\\lambda$.\n\n**Step 2: Hessian of $\\mathcal{E}$ at $m^{\\ast}$**\n\nThe Hessian of $\\mathcal{E}$ is the matrix of second partial derivatives, $D^2\\mathcal{E}(m) = \\left[\\frac{\\partial^2 \\mathcal{E}}{\\partial m_i \\partial m_j}\\right]$. The second derivatives are:\n$$\n\\frac{\\partial^2 \\mathcal{E}}{\\partial m_1^2} = \\frac{1}{I_1} + 2\\lambda, \\quad \\frac{\\partial^2 \\mathcalE}{\\partial m_2^2} = \\frac{1}{I_2} + 2\\lambda, \\quad \\frac{\\partial^2 \\mathcal{E}}{\\partial m_3^2} = \\frac{1}{I_3} + 2\\lambda\n$$\nAll mixed partial derivatives for $i \\neq j$ are zero. To find the Hessian at the critical point $m^{\\ast}$, we substitute the value $2\\lambda = -1/I_2$ found in Step 1:\n$$\nD^2\\mathcal{E}(m^{\\ast}) = \\begin{pmatrix}\n\\frac{1}{I_1} - \\frac{1}{I_2} & 0 & 0 \\\\\n0 & \\frac{1}{I_2} - \\frac{1}{I_2} & 0 \\\\\n0 & 0 & \\frac{1}{I_3} - \\frac{1}{I_2}\n\\end{pmatrix} = \\begin{pmatrix}\n\\frac{I_2 - I_1}{I_1 I_2} & 0 & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & \\frac{I_2 - I_3}{I_2 I_3}\n\\end{pmatrix}\n$$\n\n**Step 3: Determinant of the restricted Hessian**\n\nThe coadjoint orbit passing through $m^{\\ast} = (0, M, 0)$ is the sphere $\\|m\\|^2 = M^2$. The tangent space to this orbit at $m^{\\ast}$, denoted $T_{m^{\\ast}}\\mathcal{O}$, is the set of all vectors $v \\in \\mathbb{R}^3$ that are orthogonal to $m^{\\ast}$. This condition, $v \\cdot m^{\\ast} = 0$, implies $v_2 = 0$. Thus, the tangent space is the $m_1$-$m_3$ plane, spanned by the basis vectors $e_1 = (1, 0, 0)$ and $e_3 = (0, 0, 1)$.\n\nTo find the restricted Hessian, we consider the quadratic form $q(v) = v^{T} [D^2\\mathcal{E}(m^{\\ast})] v$ for any vector $v$ in the tangent space. The matrix of the restricted Hessian, $H_{res}$, in the basis $\\{e_1, e_3\\}$ is the $2 \\times 2$ submatrix of $D^2\\mathcal{E}(m^{\\ast})$ corresponding to the first and third rows and columns.\n$$\nH_{res} = \\begin{pmatrix}\n\\frac{I_2 - I_1}{I_1 I_2} & 0 \\\\\n0 & \\frac{I_2 - I_3}{I_2 I_3}\n\\end{pmatrix}\n$$\nThe determinant of this restricted Hessian is the product of its diagonal entries:\n$$\n\\det(H_{res}) = \\left(\\frac{I_2 - I_1}{I_1 I_2}\\right) \\left(\\frac{I_2 - I_3}{I_2 I_3}\\right) = \\frac{(I_2 - I_1)(I_2 - I_3)}{I_1 I_2^2 I_3}\n$$\nGiven the ordering $0 < I_{1} < I_{2} < I_{3}$, we have $I_2 - I_1 > 0$ and $I_2 - I_3 < 0$, which implies that the determinant is negative. This indicates that the restricted Hessian is indefinite, meaning the equilibrium is a saddle point of the effective potential $\\mathcal{E}$ on the coadjoint orbit, and is therefore unstable.",
            "answer": "$$\n\\boxed{\\frac{(I_2 - I_1)(I_2 - I_3)}{I_1 I_2^{2} I_3}}\n$$"
        },
        {
            "introduction": "Building on the free rigid body, we now introduce an external force by considering a heavy symmetric top in a gravitational field. The 'sleeping top'—spinning upright—is a classic relative equilibrium whose stability depends critically on its spin rate. This problem  guides you through using the energy-momentum method to derive the famous critical spin condition, illustrating how the augmented potential, $V_{\\xi}$, combines physical potential energy with a kinetic term related to the conserved momentum to govern stability.",
            "id": "3775624",
            "problem": "Consider a symmetric rigid body (axisymmetric top) with a fixed point at its tip. Its body-frame inertia tensor about the fixed point is diagonal with principal moments $I_{1}=I_{2}$ and $I_{3}$, where $I_{3}$ is the moment about the symmetry axis. The mass is $m$, the center of mass lies on the symmetry axis at a distance $c$ from the fixed point, and the uniform gravitational field has magnitude $g$. The configuration space is the Special Orthogonal Group $\\mathrm{SO}(3)$, and there is a symmetry under the Special Orthogonal Group in two dimensions $\\mathrm{SO}(2)$ given by rotations about the vertical spatial axis.\n\nTreat this as a simple mechanical system with kinetic energy defined by the Riemannian metric induced by the inertia tensor and potential energy $V(q)$ given by gravitational height. Let $\\theta$ denote the angle between the body symmetry axis and the vertical spatial axis. Using the energy-momentum method for stability of relative equilibria, work from first principles as follows:\n\n- Define the momentum map for the $\\mathrm{SO}(2)$ symmetry and the locked inertia tensor $\\mathbb{I}(q)$ at configuration $q \\in \\mathrm{SO}(3)$ as the symmetric, positive-definite operator on the Lie algebra of $\\mathrm{SO}(2)$ defined by the kinetic energy metric restricted to the group orbit through $q$.\n- Compute $\\langle \\mathbb{I}(q)\\xi,\\xi\\rangle$ explicitly, where $\\xi$ is the generator of the $\\mathrm{SO}(2)$ action corresponding to a steady spin rate $\\Omega$ about the vertical, as a function of the angle $\\theta$ and the principal moments $I_{1}$ and $I_{3}$.\n- Form the augmented potential $V_{\\xi}(q)=V(q)-\\frac{1}{2}\\langle \\mathbb{I}(q)\\xi,\\xi\\rangle$ and expand it up to second order in small tilts $\\theta$ around the upright configuration ($\\theta=0$), expressing the quadratic form that governs stability in terms of $I_{1}$, $I_{3}$, $m$, $g$, and $c$.\n- Evaluate the Arnold form for this abelian symmetry and explain its contribution (or lack thereof) to the quadratic form on the symplectic slice.\n- From the positivity of the total quadratic form obtained above, determine the critical spin magnitude $\\Omega_{\\mathrm{crit}}$ above which the upright spinning top is an energy-momentum stable relative equilibrium.\n\nExpress your final answer as a closed-form analytic expression for $\\Omega_{\\mathrm{crit}}$ in radians per second. No numerical values are provided; your answer must remain symbolic, and no rounding is required.",
            "solution": "The symmetry group $G = \\mathrm{SO}(2)$ acts by rotation about the vertical spatial axis, $\\mathbf{e}_3$. A relative equilibrium with steady spin $\\Omega$ corresponds to a motion $R(t) = \\exp(t\\hat{\\xi}_s) R_0$, where $\\xi_s = \\Omega \\mathbf{e}_3$ is the spatial angular velocity.\n\n**1. Momentum Map and Locked Inertia Tensor**\n\nThe momentum map $J$ for this action gives the conserved angular momentum about the vertical axis. The kinetic energy is $T = \\frac{1}{2}\\boldsymbol{\\omega}^T I \\boldsymbol{\\omega}$, where $\\boldsymbol{\\omega}$ is the body angular velocity. The term $\\langle \\mathbb{I}(q)\\xi, \\xi \\rangle$ in the energy-momentum method is twice the kinetic energy of the \"locked\" system, where the body rotates with the symmetry generator. The body angular velocity corresponding to the spatial velocity $\\xi_s = \\Omega \\mathbf{e}_3$ at configuration $R$ is $\\boldsymbol{\\omega}_\\xi = R^T (\\Omega \\mathbf{e}_3) = \\Omega (R^T \\mathbf{e}_3)$.\n\n**2. Computation of $\\langle \\mathbb{I}(q)\\xi, \\xi \\rangle$**\n\nWe compute the kinetic energy term:\n$$\n\\langle \\mathbb{I}(q)\\xi, \\xi \\rangle = 2T(\\boldsymbol{\\omega}_\\xi) = \\boldsymbol{\\omega}_\\xi^T I \\boldsymbol{\\omega}_\\xi = (\\Omega R^T \\mathbf{e}_3)^T I (\\Omega R^T \\mathbf{e}_3) = \\Omega^2 (R^T \\mathbf{e}_3)^T I (R^T \\mathbf{e}_3)\n$$\nLet $\\mathbf{n} = R \\mathbf{b}_3$ be the unit vector along the body's symmetry axis in the spatial frame, and let $\\theta$ be the angle between $\\mathbf{n}$ and $\\mathbf{e}_3$. Then $\\cos\\theta = \\mathbf{n} \\cdot \\mathbf{e}_3$. The vector $\\boldsymbol{\\nu} = R^T \\mathbf{e}_3$ is the representation of the vertical axis in the body frame. Its component along the body symmetry axis is $\\nu_3 = \\boldsymbol{\\nu} \\cdot \\mathbf{b}_3 = (R^T \\mathbf{e}_3) \\cdot \\mathbf{b}_3 = \\mathbf{e}_3 \\cdot (R \\mathbf{b}_3) = \\cos\\theta$. Since $\\boldsymbol{\\nu}$ is a unit vector, the sum of squares of its components perpendicular to $\\mathbf{b}_3$ is $\\nu_1^2 + \\nu_2^2 = \\sin^2\\theta$.\nThe term becomes:\n$$\n(R^T \\mathbf{e}_3)^T I (R^T \\mathbf{e}_3) = \\boldsymbol{\\nu}^T I \\boldsymbol{\\nu} = I_1 \\nu_1^2 + I_2 \\nu_2^2 + I_3 \\nu_3^2\n$$\nUsing $I_1=I_2$, we have:\n$$\nI_1(\\nu_1^2 + \\nu_2^2) + I_3 \\nu_3^2 = I_1 \\sin^2\\theta + I_3 \\cos^2\\theta\n$$\nThus, we obtain the explicit expression:\n$$\n\\langle \\mathbb{I}(q)\\xi, \\xi \\rangle = \\Omega^2(I_1 \\sin^2\\theta + I_3 \\cos^2\\theta)\n$$\n\n**3. Augmented Potential and Stability Analysis**\n\nThe gravitational potential energy is $V(\\theta) = mgc \\cos\\theta$. The augmented potential (or amended potential) $V_\\xi$ is:\n$$\nV_{\\xi}(\\theta) = V(\\theta) - \\frac{1}{2}\\langle \\mathbb{I}(q)\\xi, \\xi \\rangle = mgc \\cos\\theta - \\frac{1}{2}\\Omega^2(I_1 \\sin^2\\theta + I_3 \\cos^2\\theta)\n$$\nTo analyze stability of the upright \"sleeping top\" equilibrium at $\\theta=0$, we expand $V_\\xi$ for small $\\theta$. Using $\\cos\\theta \\approx 1 - \\frac{\\theta^2}{2}$ and $\\sin\\theta \\approx \\theta$:\n$$\nV_{\\xi}(\\theta) \\approx mgc\\left(1 - \\frac{\\theta^2}{2}\\right) - \\frac{1}{2}\\Omega^2(I_1 \\theta^2 + I_3(1 - \\theta^2))\n$$\n$$\nV_{\\xi}(\\theta) \\approx \\left(mgc - \\frac{1}{2}I_3\\Omega^2\\right) - \\frac{1}{2}mgc\\theta^2 - \\frac{1}{2}\\Omega^2(I_1 - I_3)\\theta^2\n$$\n$$\nV_{\\xi}(\\theta) \\approx V_\\xi(0) + \\frac{1}{2}\\left[\\Omega^2(I_3 - I_1) - mgc\\right]\\theta^2\n$$\nThe upright configuration is a stable relative equilibrium if it corresponds to a local minimum of the augmented potential. This requires the coefficient of the $\\theta^2$ term to be positive.\n\n**4. Arnold Form Contribution**\n\nThe Arnold form, which can contribute to the stability condition, depends on the Lie bracket of the symmetry group's Lie algebra. For this problem, the symmetry group is $G = \\mathrm{SO}(2)$, which is abelian. Its Lie algebra $\\mathfrak{so}(2) \\cong \\mathbb{R}$ is also abelian, meaning all Lie brackets are zero. Consequently, the Arnold form is identically zero and does not contribute to the stability calculation.\n\n**5. Critical Spin Condition**\n\nStability is determined solely by the positivity of the second variation of the augmented potential. This means we require the coefficient of $\\theta^2$ to be positive:\n$$\n\\Omega^2(I_3 - I_1) - mgc > 0\n$$\nThis inequality can only be satisfied if $I_3 > I_1$ (a prolate, or \"fast\", top). Assuming this condition holds, we can solve for $\\Omega^2$:\n$$\n\\Omega^2 > \\frac{mgc}{I_3 - I_1}\n$$\nThe critical spin magnitude $\\Omega_{\\mathrm{crit}}$ is the minimum spin for which this inequality holds. Therefore,\n$$\n\\Omega_{\\mathrm{crit}} = \\sqrt{\\frac{mgc}{I_3 - I_1}}\n$$\nThis is the minimum spin rate (in radians per second) required for the sleeping top to be stable.",
            "answer": "$$\\boxed{\\sqrt{\\frac{mgc}{I_{3}-I_{1}}}}$$"
        },
        {
            "introduction": "The previous exercises demonstrated analytical stability analysis for specific, canonical systems. We now generalize this approach by translating the core principle—finding critical points of an effective potential—into a computational framework. This exercise  challenges you to design and implement a numerical method to find and classify the stability of relative equilibria for any general central potential, bridging the gap between theoretical derivation and practical, computer-aided analysis.",
            "id": "3764833",
            "problem": "Consider a Hamiltonian system on the cotangent bundle $T^*\\mathbb{R}^2$ with canonical coordinates $(q,p)$, where $q \\in \\mathbb{R}^2$ and $p \\in \\mathbb{R}^2$. The symplectic form is the standard one, given by $\\omega = dq \\wedge dp$. The Hamiltonian $H$ is of the simple mechanical type $H(q,p) = \\tfrac{1}{2}\\|p\\|^2 + V(\\|q\\|)$, where $V$ is a smooth, radially symmetric potential depending only on the radius $r = \\|q\\|$.\n\nLet the Special Orthogonal group in two dimensions (SO(2)) act on the configuration space by rotations, with the action lifted to $T^*\\mathbb{R}^2$ in the canonical way. The associated momentum map $J: T^*\\mathbb{R}^2 \\to \\mathbb{R}$ is the scalar angular momentum $J(q,p) = q_1 p_2 - q_2 p_1$. A state $z \\in T^*\\mathbb{R}^2$ is called a relative equilibrium if there exists a Lie algebra element $\\xi \\in \\mathfrak{so}(2)$, equivalently a scalar angular velocity $\\omega$, such that the Hamiltonian vector field $X_H(z)$ is equal to the infinitesimal generator of the group action at $z$ induced by $\\xi$.\n\nStarting from these fundamental definitions, use symplectic reduction at a fixed value of the momentum map $J = \\mu$ to characterize relative equilibria as equilibria of the reduced dynamics for the radial coordinate $r$. Then, design a numerical method to construct all positive radii $r > 0$ of relative equilibria for a given smooth central potential $V(r)$ and fixed angular momentum $\\mu$, and verify their stability by assessing the definiteness of the second variation of the reduced energy along the radial direction. Express angular velocities $\\omega$ in radians per unit time.\n\nYour task is to implement a program that, for each provided test case, performs the following:\n- Constructs all positive radii $r$ that are stationary for the symplectically reduced radial dynamics at fixed angular momentum $J = \\mu$.\n- For each such radius $r$, computes the angular velocity $\\omega$ associated with the relative equilibrium.\n- Classifies radial stability by checking whether the second variation in the reduced one-degree-of-freedom problem is positive at $r$; return $True$ if it is positive and $False$ otherwise.\n\nYour program must handle the following test suite. In each case, $r$ is the radial coordinate, $\\mu$ is the fixed angular momentum, and $V(r)$ is defined as specified. All numerical values provided below are dimensionless and must be treated as such. Angular velocities must be expressed in radians per unit time (dimensionless time).\n\n- Test case $1$ (happy path, single root, convex potential):\n  - Potential type: harmonic, $V(r) = \\tfrac{1}{2}\\kappa r^2$ with parameter $\\kappa = 2.0$.\n  - Angular momentum: $\\mu = 1.5$.\n\n- Test case $2$ (boundary case with long-range attraction, single root):\n  - Potential type: Kepler plus confining with zero confining, $V(r) = -\\alpha / r + \\tfrac{1}{2}\\beta r^2$ with parameters $\\alpha = 1.0$, $\\beta = 0.0$.\n  - Angular momentum: $\\mu = 0.5$.\n\n- Test case $3$ (mixed curvature, confining plus attraction, possibly multiple roots depending on parameters):\n  - Potential type: Kepler plus confining, $V(r) = -\\alpha / r + \\tfrac{1}{2}\\beta r^2$ with parameters $\\alpha = 2.0$, $\\beta = 0.5$.\n  - Angular momentum: $\\mu = 0.2$.\n\n- Test case $4$ (multiwell polynomial, potential allowing multiple stationary radii):\n  - Potential type: sextic polynomial, $V(r) = \\tfrac{1}{2}\\kappa r^2 - \\tfrac{1}{4}\\delta r^4 + 0.1 \\lambda r^6$ with parameters $\\kappa = 1.0$, $\\delta = 3.0$, $\\lambda = 0.5$.\n  - Angular momentum: $\\mu = 10^{-6}$.\n\n- Test case $5$ (edge case, inverted harmonic potential with no physical stationary radius):\n  - Potential type: harmonic, $V(r) = \\tfrac{1}{2}\\kappa r^2$ with parameter $\\kappa = -1.0$.\n  - Angular momentum: $\\mu = 0.2$.\n\nOutput specification:\n- For each test case, return a list of all relative equilibria found as sublists of the form $[r, \\omega, s]$, where $r$ and $\\omega$ are floating-point numbers, and $s$ is a boolean indicating radial stability ($True$ for stable, $False$ for unstable).\n- If no positive stationary radii exist for a test case, return an empty list for that case.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example: $[[r_1,\\omega_1,s_1],[r_2,\\omega_2,s_2],\\dots]$ for each test case, aggregated as $[case1,case2,case3,case4,case5]$.\n\nAngle unit requirement: angular velocities $\\omega$ must be expressed in radians per unit time (dimensionless time). No other physical units occur in this problem.\n\nImportant constraints:\n- Derivations and the algorithm must start from the fundamental base: Hamiltonian systems, symplectic form, momentum map, and symplectic reduction at fixed $J = \\mu$.\n- Do not use shortcut formulas in the problem statement; all specific formulas needed for implementation must be derived in your solution.\n- Ensure scientific realism by using smooth potentials and correctly handling the domain $r > 0$.\n\nYour program must not require any user input and must solve exactly the specified test suite. The final output must adhere to the exact format described above.",
            "solution": "We begin from the fundamental definitions of Hamiltonian systems and symmetries. The phase space is $T^*\\mathbb{R}^2$ with canonical coordinates $(q,p)$ and standard symplectic form $\\omega = dq \\wedge dp$. The Hamiltonian is $H(q,p) = \\tfrac{1}{2}\\|p\\|^2 + V(\\|q\\|)$, where $V$ is a smooth central potential depending on the radius $r = \\|q\\|$. The Special Orthogonal group in two dimensions (SO(2)) acts on the configuration space $\\mathbb{R}^2$ by rotations, and its cotangent lift acts on $T^*\\mathbb{R}^2$ preserving the symplectic form. The associated momentum map $J: T^*\\mathbb{R}^2 \\to \\mathbb{R}$ is the scalar angular momentum $J(q,p) = q_1 p_2 - q_2 p_1$.\n\nA relative equilibrium is defined as a point $z \\in T^*\\mathbb{R}^2$ such that there exists $\\xi \\in \\mathfrak{so}(2)$ (which can be identified with a scalar angular velocity $\\omega$) for which the Hamiltonian vector field equals the infinitesimal generator of the group action at $z$, namely $X_H(z) = \\xi_{T^*\\mathbb{R}^2}(z)$. For simple mechanical systems with this symmetry, symplectic reduction at a fixed value $J = \\mu$ leads to dynamics on a reduced space parameterized by the radial coordinate $r$ and its conjugate radial momentum $p_r$. The reduction exploits the invariance of $H$ under SO(2) and the conservation of $J$ along trajectories.\n\nOn the level set $J = \\mu$, the effective reduced Hamiltonian in the radial variables $(r, p_r)$ is of the form\n$$\nH_{\\text{red}}(r,p_r; \\mu) = \\tfrac{1}{2} p_r^2 + V_{\\text{eff}}(r; \\mu),\n$$\nwhere the effective potential $V_{\\text{eff}}$ arises from the original potential $V$ together with the centrifugal contribution due to fixed angular momentum. The reduced equations of motion imply that equilibria in the reduced dynamics correspond to critical points of $V_{\\text{eff}}(r; \\mu)$. Specifically, equilibria satisfy $p_r = 0$ and\n$$\n\\frac{d}{dr} V_{\\text{eff}}(r; \\mu) = 0.\n$$\n\nWe now derive the explicit form of $V_{\\text{eff}}(r; \\mu)$. In polar coordinates, the kinetic energy decomposes into radial and angular parts, with the angular part constrained by the fixed angular momentum $J = \\mu$. The standard mechanical reduction yields\n$$\nV_{\\text{eff}}(r; \\mu) = V(r) + \\frac{\\mu^2}{2 r^2},\n$$\nwhere the additional term $\\frac{\\mu^2}{2 r^2}$ encodes the centrifugal barrier. Therefore, stationary radii $r > 0$ are solutions of\n$$\n\\frac{d}{dr} V_{\\text{eff}}(r; \\mu) = \\frac{d}{dr} V(r) - \\frac{\\mu^2}{r^3} = 0.\n$$\nThe angular velocity $\\omega$ of the relative equilibrium follows from the kinematics with fixed angular momentum in planar motion,\n$$\n\\omega = \\frac{\\mu}{r^2},\n$$\nwhich is expressed in radians per unit time.\n\nTo assess stability, we consider the second variation of the reduced energy along the radial direction. Linearizing the reduced one-degree-of-freedom system about the stationary radius yields the condition\n$$\n\\frac{d^2}{dr^2} V_{\\text{eff}}(r; \\mu) = \\frac{d^2}{dr^2} V(r) + \\frac{3 \\mu^2}{r^4}.\n$$\nPositivity of this second derivative at the equilibrium radius ensures that the equilibrium is a local minimum of $V_{\\text{eff}}$ and is linearly stable in the reduced dynamics. In the context of the energy-momentum method for simple mechanical systems with SO(2) symmetry in the plane, positivity of this reduced Hessian along the radial direction suffices to conclude formal stability of the relative equilibrium modulo the group action. We therefore classify stability using the sign of $\\frac{d^2}{dr^2} V_{\\text{eff}}(r; \\mu)$ at each stationary radius.\n\nAlgorithmic design:\n1. For each test case, define $V(r)$, its first derivative $\\frac{d}{dr} V(r)$, and its second derivative $\\frac{d^2}{dr^2} V(r)$ according to the specified potential type and parameters.\n   - Harmonic potential: $V(r) = \\tfrac{1}{2}\\kappa r^2$, hence $\\frac{d}{dr} V(r) = \\kappa r$ and $\\frac{d^2}{dr^2} V(r) = \\kappa$.\n   - Kepler plus confining potential: $V(r) = -\\alpha / r + \\tfrac{1}{2}\\beta r^2$, hence $\\frac{d}{dr} V(r) = \\alpha / r^2 + \\beta r$ and $\\frac{d^2}{dr^2} V(r) = -2\\alpha / r^3 + \\beta$.\n   - Sextic polynomial potential: $V(r) = \\tfrac{1}{2}\\kappa r^2 - \\tfrac{1}{4}\\delta r^4 + 0.1 \\lambda r^6$, hence $\\frac{d}{dr} V(r) = \\kappa r - \\delta r^3 + 0.6 \\lambda r^5$ and $\\frac{d^2}{dr^2} V(r) = \\kappa - 3 \\delta r^2 + 3.0 \\lambda r^4$.\n\n2. Construct the derivative of the effective potential:\n   $$\n   F(r; \\mu) := \\frac{d}{dr} V_{\\text{eff}}(r; \\mu) = \\frac{d}{dr} V(r) - \\frac{\\mu^2}{r^3}.\n   $$\n   The domain constraint is $r > 0$. Note that as $r \\to 0^+$, $F(r; \\mu) \\to -\\infty$ due to the centrifugal term when $\\mu \\neq 0$.\n\n3. Find all roots of $F(r; \\mu) = 0$ for $r > 0$:\n   - Use a bracketed root-finding approach based on sign changes of $F$ across a grid of $r$ values in an interval $[r_{\\min}, r_{\\max}]$ with $r_{\\min}$ small (e.g., $10^{-6}$) and $r_{\\max}$ chosen sufficiently large to capture all potential stationary radii relevant to the specified potentials.\n   - For each adjacent pair of grid points $(a,b)$ with $F(a) \\cdot F(b) < 0$, apply a robust scalar root-finding method (Brent's method) to locate a root in $(a,b)$.\n   - Deduplicate roots that are numerically close to each other under a tolerance.\n\n4. For each root $r$ found:\n   - Compute $\\omega = \\mu / r^2$ (radians per unit time).\n   - Compute $G(r; \\mu) := \\frac{d^2}{dr^2} V_{\\text{eff}}(r; \\mu) = \\frac{d^2}{dr^2} V(r) + \\frac{3 \\mu^2}{r^4}$.\n   - Classify stability via $s = (G(r; \\mu) > 0)$.\n\n5. Return, for each test case, the list of $[r, \\omega, s]$ triples sorted by increasing $r$. If no roots exist, return an empty list for that case.\n\nNumerical considerations:\n- The function $F(r; \\mu)$ has a singularity at $r = 0$ for $\\mu \\neq 0$, but the algorithm avoids this by starting the search at $r_{\\min} = 10^{-6}$.\n- For the Kepler potential $V(r) = -\\alpha / r$ with $\\alpha > 0$, there is exactly one physically relevant root at $r = \\mu^2 / \\alpha$, and the second derivative $G(r; \\mu)$ is positive, indicating stability.\n- For convex potentials like the harmonic case with $\\kappa > 0$, the stationary radius is unique and stable.\n- For multiwell polynomial potentials, multiple stationary radii can exist; the algorithm discovers all sign changes and classifies each equilibrium accordingly.\n- For an inverted harmonic potential with $\\kappa < 0$, $F(r; \\mu)$ remains negative for all $r > 0$ (for $\\mu \\neq 0$), so no positive stationary radius exists.\n\nThe program implements these steps for the specified test suite and prints a single line containing the aggregated results across all test cases in the required format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\n# Define potential functions and their derivatives for each type.\ndef potential_funcs(case):\n    ptype = case['type']\n    if ptype == 'harmonic':\n        kappa = case['kappa']\n        def V(r):\n            return 0.5 * kappa * r**2\n        def dV(r):\n            return kappa * r\n        def ddV(r):\n            return kappa\n        return V, dV, ddV\n    elif ptype == 'kepler_conf':\n        alpha = case['alpha']\n        beta = case['beta']\n        def V(r):\n            return -alpha / r + 0.5 * beta * r**2\n        def dV(r):\n            return alpha / r**2 + beta * r\n        def ddV(r):\n            return -2.0 * alpha / r**3 + beta\n        return V, dV, ddV\n    elif ptype == 'poly6':\n        kappa = case['kappa']\n        delta = case['delta']\n        lam = case['lambda']\n        # V(r) = 0.5 kappa r^2 - 0.25 delta r^4 + 0.1 lambda r^6\n        def V(r):\n            return 0.5 * kappa * r**2 - 0.25 * delta * r**4 + 0.1 * lam * r**6\n        def dV(r):\n            return kappa * r - delta * r**3 + 0.6 * lam * r**5\n        def ddV(r):\n            return kappa - 3.0 * delta * r**2 + 3.0 * lam * r**4\n        return V, dV, ddV\n    else:\n        raise ValueError(\"Unknown potential type\")\n\ndef find_stationary_radii(dV, mu, rmin=1e-6, rmax=100.0, ngrid=2000):\n    # F(r) = dV(r) - mu^2 / r^3\n    def F(r):\n        return dV(r) - (mu**2) / (r**3)\n    # Sample grid and detect sign changes\n    # Use logarithmic spacing near small r and linear towards larger r\n    # Construct a grid that is dense near small r\n    small = np.logspace(np.log10(rmin), np.log10(1.0), num=ngrid//2, base=10.0)\n    large = np.linspace(1.0, rmax, num=ngrid//2)\n    grid = np.unique(np.concatenate([small, large]))\n    vals = np.array([F(r) for r in grid])\n    roots = []\n    for i in range(len(grid)-1):\n        a, b = grid[i], grid[i+1]\n        fa, fb = vals[i], vals[i+1]\n        if np.isnan(fa) or np.isnan(fb):\n            continue\n        # Check for sign change\n        if fa == 0.0:\n            root = a\n        elif fb == 0.0:\n            root = b\n        elif fa * fb  0.0:\n            # Brent's method\n            try:\n                res = root_scalar(F, bracket=(a, b), method='brentq')\n                if res.converged and res.root > 0:\n                    root = res.root\n                else:\n                    continue\n            except ValueError:\n                continue\n        else:\n            continue\n        # Deduplicate roots\n        if all(abs(root - r0) > 1e-6 for r0 in roots):\n            roots.append(root)\n    roots.sort()\n    return roots\n\ndef classify_equilibria(case):\n    V, dV, ddV = potential_funcs(case)\n    mu = case['mu']\n    radii = find_stationary_radii(dV, mu)\n    eqs = []\n    for r in radii:\n        omega = mu / (r**2)\n        # Second derivative of effective potential: ddV + 3 mu^2 / r^4\n        G = ddV(r) + 3.0 * (mu**2) / (r**4)\n        stable = bool(G > 0.0)\n        eqs.append([float(r), float(omega), stable])\n    return eqs\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'type': 'harmonic', 'kappa': 2.0, 'mu': 1.5},                        # Case 1\n        {'type': 'kepler_conf', 'alpha': 1.0, 'beta': 0.0, 'mu': 0.5},        # Case 2\n        {'type': 'kepler_conf', 'alpha': 2.0, 'beta': 0.5, 'mu': 0.2},        # Case 3\n        {'type': 'poly6', 'kappa': 1.0, 'delta': 3.0, 'lambda': 0.5, 'mu': 1e-6},  # Case 4\n        {'type': 'harmonic', 'kappa': -1.0, 'mu': 0.2},                       # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        eqs = classify_equilibria(case)\n        results.append(eqs)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}