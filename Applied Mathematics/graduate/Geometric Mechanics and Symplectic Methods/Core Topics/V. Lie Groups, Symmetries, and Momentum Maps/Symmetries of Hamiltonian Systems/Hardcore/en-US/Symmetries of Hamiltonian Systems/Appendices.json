{
    "hands_on_practices": [
        {
            "introduction": "The momentum map is the cornerstone of Hamiltonian systems with symmetry. This exercise guides you through the foundational derivation for the most common class of mechanical systems: those defined on a cotangent bundle. By working from first principles, you will uncover the canonical expression for the momentum map associated with a cotangent-lifted action , solidifying your understanding of how conserved quantities naturally emerge from geometric structure.",
            "id": "3767919",
            "problem": "Let $Q$ be a smooth manifold and let a Lie group $G$ act smoothly on $Q$ by a left action $\\Phi:G\\times Q\\to Q$, written $\\Phi(g,q)=g\\cdot q$. Denote by $\\pi:T^{*}Q\\to Q$ the cotangent bundle projection, by $\\theta$ the canonical one-form on $T^{*}Q$ defined by $\\theta_{\\alpha_{q}}(V_{\\alpha_{q}})=\\alpha_{q}(T_{\\alpha_{q}}\\pi\\cdot V_{\\alpha_{q}})$ for $\\alpha_{q}\\in T_{q}^{*}Q$ and $V_{\\alpha_{q}}\\in T_{\\alpha_{q}}(T^{*}Q)$, and by $\\omega=-\\mathrm{d}\\theta$ the canonical symplectic form. The action $\\Phi$ lifts to the cotangent bundle via the cotangent lift $\\Phi^{T^{*}}:G\\times T^{*}Q\\to T^{*}Q$, so that each $g\\in G$ acts by $(\\Phi^{T^{*}}_{g})(\\alpha_{q})=((T_{g^{-1}\\cdot q}\\Phi_{g})^{*})^{-1}\\alpha_{q}$, and this lifted action preserves the symplectic form $\\omega$. For $\\xi\\in\\mathfrak{g}$, let $\\xi_{Q}$ denote the infinitesimal generator on $Q$ and let $\\xi_{T^{*}Q}$ denote the infinitesimal generator on $T^{*}Q$ induced by the cotangent-lifted action.\n\nStarting from the canonical symplectic structure on $T^{*}Q$, the definition of the momentum map $J:T^{*}Q\\to\\mathfrak{g}^{*}$ for a symplectic $G$-action is that, for each $\\xi\\in\\mathfrak{g}$, the function $\\langle J,\\xi\\rangle:T^{*}Q\\to\\mathbb{R}$ satisfies the identity $\\iota_{\\xi_{T^{*}Q}}\\omega=\\mathrm{d}\\langle J,\\xi\\rangle$. Derive from these data the expression for the momentum map of the cotangent-lifted action and show that\n$$\n\\langle J(\\alpha_{q}),\\xi\\rangle=\\alpha_{q}(\\xi_{Q}(q))\\quad\\text{for all }\\alpha_{q}\\in T_{q}^{*}Q\\text{ and }\\xi\\in\\mathfrak{g}.\n$$\n\nThen specialize to the case $Q=\\mathbb{R}^{2}$ with the standard rotation action of $G=\\mathrm{SO}(2)$ on $Q$. Identify $T^{*}\\mathbb{R}^{2}$ with $\\mathbb{R}^{2}\\times(\\mathbb{R}^{2})^{*}$ via the standard pairing, and write a point as $(x,p)$ with $x=(x_{1},x_{2})$ and $p=(p_{1},p_{2})$. Using your general result, determine the scalar momentum map $J(x,p)$ associated with the $\\mathrm{SO}(2)$ action, and finally evaluate $J$ at the point with $x=(\\,2,\\,-1\\,)$ and $p=(\\,3,\\,4\\,)$. Provide the value of $J$ at this point as an exact integer with no rounding required.",
            "solution": "The problem is divided into three parts: first, to derive the general expression for the momentum map of a cotangent-lifted action; second, to specialize this result to the case of the rotation group $\\mathrm{SO}(2)$ acting on $\\mathbb{R}^{2}$; and third, to evaluate this specific momentum map at a given point.\n\nPart 1: General Derivation of the Momentum Map\n\nThe momentum map $J: T^{*}Q \\to \\mathfrak{g}^{*}$ for a symplectic $G$-action on a symplectic manifold $(M, \\omega)$ is defined by the relation\n$$\n\\mathrm{d}\\langle J, \\xi \\rangle = \\iota_{\\xi_M} \\omega\n$$\nwhere $\\xi \\in \\mathfrak{g}$ is an element of the Lie algebra of $G$, $\\xi_M$ is the corresponding infinitesimal generator (a vector field on $M$), $\\langle \\cdot, \\cdot \\rangle$ denotes the pairing between the dual Lie algebra $\\mathfrak{g}^{*}$ and $\\mathfrak{g}$, and $\\iota_X$ is the interior product with respect to the vector field $X$.\n\nIn our case, the manifold is the cotangent bundle $M = T^{*}Q$ and the symplectic form is the canonical one, $\\omega = -\\mathrm{d}\\theta$, where $\\theta$ is the canonical one-form on $T^{*}Q$. The infinitesimal generator is denoted $\\xi_{T^{*}Q}$. The defining equation for the momentum map component $\\langle J, \\xi \\rangle$ becomes:\n$$\n\\mathrm{d}\\langle J, \\xi \\rangle = \\iota_{\\xi_{T^{*}Q}} (-\\mathrm{d}\\theta) = -\\iota_{\\xi_{T^{*}Q}} \\mathrm{d}\\theta\n$$\nWe use Cartan's magic formula for the Lie derivative of a differential form $A$ with respect to a vector field $X$: $L_X A = \\mathrm{d}(\\iota_X A) + \\iota_X \\mathrm{d}A$. Rearranging for $\\iota_X \\mathrm{d}A$ gives $\\iota_X \\mathrm{d}A = L_X A - \\mathrm{d}(\\iota_X A)$.\nApplying this formula with $X = \\xi_{T^{*}Q}$ and $A = \\theta$, we get:\n$$\n\\mathrm{d}\\langle J, \\xi \\rangle = - (L_{\\xi_{T^{*}Q}}\\theta - \\mathrm{d}(\\iota_{\\xi_{T^{*}Q}}\\theta)) = \\mathrm{d}(\\iota_{\\xi_{T^{*}Q}}\\theta) - L_{\\xi_{T^{*}Q}}\\theta\n$$\nA fundamental property of the cotangent-lifted action $\\Phi^{T^{*}}$ is that it preserves the canonical one-form $\\theta$. That is, for any $g \\in G$, $(\\Phi^{T^{*}}_g)^*\\theta = \\theta$. The Lie derivative $L_{\\xi_{T^{*}Q}}\\theta$ is the infinitesimal version of this statement. It is defined as the derivative of the pullback along the flow of $\\xi_{T^{*}Q}$ at time $t=0$:\n$$\nL_{\\xi_{T^{*}Q}}\\theta = \\frac{\\mathrm{d}}{\\mathrm{d}t}\\bigg|_{t=0} (\\Phi^{T^{*}}_{\\exp(t\\xi)})^*\\theta\n$$\nSince the pullback is constant and equal to $\\theta$, its derivative is zero. Thus, $L_{\\xi_{T^{*}Q}}\\theta = 0$.\n\nThe defining equation for the momentum map simplifies to:\n$$\n\\mathrm{d}\\langle J, \\xi \\rangle = \\mathrm{d}(\\iota_{\\xi_{T^{*}Q}}\\theta)\n$$\nThis implies that $\\langle J, \\xi \\rangle$ and $\\iota_{\\xi_{T^{*}Q}}\\theta$ differ by at most a constant function on each connected component of $T^{*}Q$. It is standard to choose this constant to be zero, which corresponds to normalizing the momentum map. Thus, we have the expression:\n$$\n\\langle J, \\xi \\rangle = \\iota_{\\xi_{T^{*}Q}}\\theta\n$$\nWe now evaluate the right-hand side at an arbitrary point $\\alpha_q \\in T_q^{*}Q$. By definition of the interior product, this is the one-form $\\theta$ evaluated at the point $\\alpha_q$ on the vector $(\\xi_{T^{*}Q})(\\alpha_q)$:\n$$\n\\langle J(\\alpha_q), \\xi \\rangle = (\\iota_{\\xi_{T^{*}Q}}\\theta)(\\alpha_q) = \\theta_{\\alpha_q}((\\xi_{T^{*}Q})(\\alpha_q))\n$$\nThe canonical one-form $\\theta$ is defined by its action on a tangent vector $V_{\\alpha_q} \\in T_{\\alpha_q}(T^{*}Q)$: $\\theta_{\\alpha_q}(V_{\\alpha_q}) = \\alpha_q(T_{\\alpha_q}\\pi \\cdot V_{\\alpha_q})$, where $T_{\\alpha_q}\\pi$ is the tangent map of the cotangent bundle projection $\\pi: T^{*}Q \\to Q$. Let $V_{\\alpha_q} = (\\xi_{T^{*}Q})(\\alpha_q)$. Then:\n$$\n\\langle J(\\alpha_q), \\xi \\rangle = \\alpha_q(T_{\\alpha_q}\\pi \\cdot (\\xi_{T^{*}Q})(\\alpha_q))\n$$\nThe vector $T_{\\alpha_q}\\pi \\cdot (\\xi_{T^{*}Q})(\\alpha_q)$ is the projection of the infinitesimal generator on $T^{*}Q$ to the base manifold $Q$. This projection is precisely the infinitesimal generator $\\xi_Q$ on $Q$, evaluated at the point $q = \\pi(\\alpha_q)$. To see this, consider a curve $c(t) = \\Phi^{T^{*}}_{\\exp(t\\xi)}(\\alpha_q)$ in $T^{*}Q$. Its tangent vector at $t=0$ is $(\\xi_{T^{*}Q})(\\alpha_q)$. The projection of this curve onto $Q$ is $\\pi(c(t)) = \\pi(\\Phi^{T^{*}}_{\\exp(t\\xi)}(\\alpha_q))$. Since the lift commutes with the projection in the sense that $\\pi \\circ \\Phi^{T^{*}}_g = \\Phi_g \\circ \\pi$, this becomes $(\\Phi_{\\exp(t\\xi)} \\circ \\pi)(\\alpha_q) = \\exp(t\\xi) \\cdot q$. The tangent vector to this projected curve at $t=0$ is $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\big|_{t=0} (\\exp(t\\xi) \\cdot q)$, which is by definition the infinitesimal generator $\\xi_Q(q)$. Therefore, $T_{\\alpha_q}\\pi \\cdot (\\xi_{T^{*}Q})(\\alpha_q) = \\xi_Q(q)$.\n\nSubstituting this result into our expression for the momentum map, we arrive at the desired general formula:\n$$\n\\langle J(\\alpha_q), \\xi \\rangle = \\alpha_q(\\xi_Q(q))\n$$\n\nPart 2: Specialization to $\\mathrm{SO}(2)$ on $\\mathbb{R}^{2}$\n\nWe are given $Q = \\mathbb{R}^{2}$ with coordinates $x = (x_1, x_2)$ and $G = \\mathrm{SO}(2)$, the group of rotations in the plane. An element $g(\\phi) \\in \\mathrm{SO}(2)$ corresponding to a rotation by angle $\\phi$ is given by the matrix:\n$$\ng(\\phi) = \\begin{pmatrix} \\cos\\phi & -\\sin\\phi \\\\ \\sin\\phi & \\cos\\phi \\end{pmatrix}\n$$\nThe action on a point $x \\in \\mathbb{R}^2$ is matrix multiplication: $g(\\phi) \\cdot x$. The Lie algebra $\\mathfrak{so}(2)$ is one-dimensional and can be identified with $\\mathbb{R}$. A basis vector $\\xi \\in \\mathfrak{so}(2)$ is obtained by differentiating $g(\\phi)$ with respect to $\\phi$ at $\\phi=0$:\n$$\n\\xi = \\frac{\\mathrm{d}g}{\\mathrm{d}\\phi}\\bigg|_{\\phi=0} = \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix}\n$$\nThe infinitesimal generator $\\xi_Q(x)$ on $Q=\\mathbb{R}^{2}$ is defined as $\\xi_Q(x) = \\frac{\\mathrm{d}}{\\mathrm{d}t}\\big|_{t=0} (\\exp(t\\xi)\\cdot x)$. For a matrix Lie group, this is simply $\\xi x$:\n$$\n\\xi_Q(x) = \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} -x_2 \\\\ x_1 \\end{pmatrix}\n$$\nAs a vector field on $\\mathbb{R}^{2}$, this is $\\xi_Q(x) = -x_2 \\frac{\\partial}{\\partial x_1} + x_1 \\frac{\\partial}{\\partial x_2}$.\n\nA point in $T^{*}Q = T^{*}\\mathbb{R}^{2}$ is given by $(x, p)$, where $x \\in \\mathbb{R}^{2}$ and $p \\in (T_x\\mathbb{R}^{2})^{*} \\cong (\\mathbb{R}^{2})^{*}$. We write $x=(x_1, x_2)$ and $p=(p_1, p_2)$. In this context, $\\alpha_q$ corresponds to the covector $p$ at the point $q=x$. The pairing $\\alpha_q(\\xi_Q(q))$ becomes the standard pairing between a covector $p$ and a vector $v = \\xi_Q(x)$, which is $p(v) = p \\cdot v = p_1 v_1 + p_2 v_2$.\n\nSince $\\mathfrak{so}(2)$ is one-dimensional, we can identify $\\mathfrak{so}(2)^*$ with $\\mathbb{R}$ and the momentum map $J$ becomes a scalar function on $T^{*}\\mathbb{R}^{2}$. Using our basis element $\\xi$, the scalar momentum map $J(x, p)$ is given by $\\langle J(x,p), \\xi \\rangle$. We apply the general formula:\n$$\nJ(x,p) = \\langle J(x,p), \\xi \\rangle = p(\\xi_Q(x)) = p \\cdot \\xi_Q(x)\n$$\nSubstituting the components:\n$$\nJ(x,p) = (p_1, p_2) \\cdot (-x_2, x_1) = p_1(-x_2) + p_2(x_1) = x_1 p_2 - x_2 p_1\n$$\nThis is the expression for the scalar momentum map associated with the standard $\\mathrm{SO}(2)$ action on $\\mathbb{R}^{2}$, which is recognized as the standard expression for angular momentum.\n\nPart 3: Evaluation at a Specific Point\n\nWe are asked to evaluate $J(x,p)$ at the point where $x=(2, -1)$ and $p=(3, 4)$. Thus, we have the values:\n$x_1 = 2$\n$x_2 = -1$\n$p_1 = 3$\n$p_2 = 4$\n\nSubstituting these values into the expression for $J(x,p)$:\n$$\nJ = (2)(4) - (-1)(3) = 8 - (-3) = 8 + 3 = 11\n$$\nThe value of the momentum map at the specified point is $11$.",
            "answer": "$$\n\\boxed{11}\n$$"
        },
        {
            "introduction": "Having established how to derive a momentum map, the next logical step is to use it to simplify a system's dynamics through symplectic reduction. This practice tackles the classic problem of a particle in a central potential, a cornerstone example in mechanics . You will perform the reduction explicitly, revealing how the conservation of angular momentum allows a two-degree-of-freedom planar motion to be described by a one-degree-of-freedom radial motion with an effective potential.",
            "id": "3767945",
            "problem": "Consider the following simple mechanical system in the plane. Let $Q$ be the punctured plane, identified with $\\mathbb{R}^{2} \\setminus \\{0\\}$, and let $T^{*}Q$ be its cotangent bundle equipped with the canonical symplectic form. The configuration variable is $q \\in Q$, the momentum variable is $p \\in T_{q}^{*}Q \\cong \\mathbb{R}^{2}$ via the Euclidean metric, and the Hamiltonian is\n$$\nH(q,p) \\;=\\; \\frac{1}{2 m} \\, |p|^{2} \\;+\\; V\\big(|q|\\big),\n$$\nwhere $m>0$ is a constant mass and $V:(0,\\infty)\\to \\mathbb{R}$ is a smooth central potential. The Special Orthogonal group of degree two $\\mathrm{SO}(2)$ acts freely and properly on $Q$ by rotations, and this action lifts canonically to a Hamiltonian action on $T^{*}Q$.\n\nUsing only the foundational definitions of the cotangent bundle and its canonical symplectic form, the cotangent-lifted action of a Lie group, the momentum map for a Hamiltonian group action, and the Marsden–Weinstein symplectic reduction, do the following:\n\n- Identify the momentum map $J:T^{*}Q \\to \\mathfrak{so}(2)^{*}$ associated with the lifted $\\mathrm{SO}(2)$-action and argue that $H$ is invariant under this action.\n- For a fixed regular value $\\mu \\in \\mathfrak{so}(2)^{*} \\cong \\mathbb{R}$ with $\\mu \\neq 0$, construct the reduced phase space $J^{-1}(\\mu)/\\mathrm{SO}(2)$ and show that it can be identified with the cotangent bundle of the shape space $T^{*}(Q/\\mathrm{SO}(2)) \\cong T^{*}\\big((0,\\infty)\\big)$, using the orbit projection $Q \\to Q/\\mathrm{SO}(2)$ and an appropriate connection.\n- Derive the reduced Hamiltonian dynamics on this reduced space in canonical variables and interpret physically the reduced coordinate and its conjugate momentum.\n\nYour final answer must be the single, closed-form analytic expression for the reduced Hamiltonian $H_{\\mathrm{red}}(r,p_{r};\\mu)$ in terms of the radial coordinate $r \\in (0,\\infty)$, its conjugate momentum $p_{r}$, the parameter $\\mu$, the mass $m$, and the potential $V(r)$. Do not provide any intermediate expressions as your final answer. No numerical approximation is required, and no physical units should accompany the final expression.",
            "solution": "We begin from the standard structures of cotangent bundles and Hamiltonian group actions. The cotangent bundle $T^{*}Q$ carries the canonical $1$-form $\\theta_{\\mathrm{can}}$ defined by $\\theta_{\\mathrm{can}}(\\alpha_{q})(X_{\\alpha_{q}}) = \\alpha_{q}\\big(T\\pi(X_{\\alpha_{q}})\\big)$, where $\\pi:T^{*}Q \\to Q$ is the bundle projection, and the canonical symplectic form is $\\omega_{\\mathrm{can}} = -\\mathrm{d}\\theta_{\\mathrm{can}}$. The action of a Lie group $G$ on $Q$ by diffeomorphisms $g \\cdot q$ lifts to a symplectic action on $T^{*}Q$ via\n$$\ng \\cdot \\alpha_{q} \\;=\\; \\big(T(g^{-1})\\big)^{*} \\alpha_{q},\n$$\nand the associated momentum map $J:T^{*}Q \\to \\mathfrak{g}^{*}$ is characterized by\n$$\n\\mathrm{d}\\langle J, \\xi \\rangle \\;=\\; \\iota_{\\xi_{T^{*}Q}} \\,\\omega_{\\mathrm{can}}, \n\\quad \\text{for all } \\xi \\in \\mathfrak{g},\n$$\nwhere $\\xi_{Q}$ is the fundamental vector field on $Q$ and $\\xi_{T^{*}Q}$ is its cotangent lift.\n\nFor the present system, $G=\\mathrm{SO}(2)$ acts on $Q=\\mathbb{R}^{2}\\setminus \\{0\\}$ by rotations about the origin, which is free and proper on $Q$. Identifying $T_{q}^{*}Q$ with $\\mathbb{R}^{2}$ via the Euclidean metric, the cotangent lift acts by the same rotation on $p$. The generator of $\\mathfrak{so}(2)$ can be represented by the infinitesimal rotation with fundamental vector field on $Q$: for the unique nonzero $\\xi \\in \\mathfrak{so}(2)$, the corresponding $\\xi_{Q}(q)$ is the counterclockwise rotation of $q$ by an infinitesimal angle, i.e., $\\xi_{Q}(q)$ is orthogonal to $q$ with $|\\xi_{Q}(q)|=|q|$. The standard calculation of the momentum map for planar rotations yields\n$$\n\\langle J(q,p), \\xi \\rangle \\;=\\; q_{x}p_{y} \\,-\\, q_{y}p_{x},\n$$\nwhich identifies $J(q,p)$ with the scalar angular momentum about the origin. Equivalently, $J(q,p)$ is the signed area form pairing of $(q,p)$, often written as the scalar $L_{z}$. Because the Hamiltonian $H(q,p)=\\frac{1}{2 m}|p|^{2} + V(|q|)$ depends only on $|q|$ and $|p|$, it is invariant under rotations, and thus invariant under the cotangent-lifted $\\mathrm{SO}(2)$-action.\n\nFor a fixed regular value $\\mu \\in \\mathfrak{so}(2)^{*}\\cong \\mathbb{R}$ with $\\mu \\neq 0$, consider the Marsden–Weinstein reduced space\n$$\nM_{\\mu} \\;=\\; J^{-1}(\\mu) \\big/ \\mathrm{SO}(2).\n$$\nSince $\\mathrm{SO}(2)$ is Abelian, the coadjoint action is trivial and the isotropy subgroup of $\\mu$ is the whole group, so the quotient by $\\mathrm{SO}(2)$ is well defined and smooth. By dimension counting, $\\dim T^{*}Q=4$, $\\dim J^{-1}(\\mu)=3$, and $\\dim M_{\\mu}=2$. The base (or shape) space $Q/\\mathrm{SO}(2)$ is diffeomorphic to $(0,\\infty)$ via the projection $Q \\to (0,\\infty)$, $q \\mapsto r=|q|$. The bundle $Q \\to (0,\\infty)$ is a principal $\\mathrm{SO}(2)$-bundle with fiber the circle of directions. The mechanical connection associated with the Euclidean kinetic energy has horizontal spaces orthogonal to the group orbits, which in polar coordinates corresponds to the $1$-form $A = \\mathrm{d}\\theta$ along the circle coordinate $\\theta$. Its curvature is $\\mathrm{d}A = \\mathrm{d}^{2}\\theta = 0$, so there is no magnetic term induced on reduction. A standard result for cotangent bundle reduction by a free and proper action, when the curvature vanishes, is that the reduced symplectic manifold $M_{\\mu}$ is symplectomorphic to $T^{*}(Q/\\mathrm{SO}(2)) \\cong T^{*}\\big((0,\\infty)\\big)$ with its canonical symplectic form.\n\nTo make this identification explicitly, write $q$ in polar coordinates as $(r,\\theta)$ with $r=|q|$ and $\\theta \\in \\mathbb{S}^{1}$, and decompose $p$ into its components along the orthonormal frame $\\{e_{r},e_{\\theta}\\}$ at $q$:\n$$\np \\;=\\; p_{r} \\, e_{r} \\;+\\; p_{\\perp} \\, e_{\\theta}.\n$$\nThe scalar angular momentum about the origin is\n$$\n\\mu \\;=\\; \\langle J(q,p), \\xi \\rangle \\;=\\; q_{x}p_{y} - q_{y}p_{x} \\;=\\; r \\, p_{\\perp},\n$$\nso along the level set $J^{-1}(\\mu)$ we have $p_{\\perp}=\\mu/r$. The kinetic energy depends on $|p|^{2} = p_{r}^{2} + p_{\\perp}^{2}$, hence along $J^{-1}(\\mu)$ we find\n$$\n|p|^{2} \\;=\\; p_{r}^{2} \\;+\\; \\frac{\\mu^{2}}{r^{2}}.\n$$\nThe coordinates $(r,p_{r})$ descend to the quotient $M_{\\mu}$ and provide canonical cotangent bundle coordinates on $T^{*}\\big((0,\\infty)\\big)$. Because the curvature vanishes, the reduced symplectic form is the canonical one, so the reduced Hamiltonian system has the canonical equations\n$$\n\\dot{r} \\;=\\; \\frac{\\partial H_{\\mathrm{red}}}{\\partial p_{r}}, \n\\qquad\n\\dot{p}_{r} \\;=\\; -\\frac{\\partial H_{\\mathrm{red}}}{\\partial r}.\n$$\nSubstituting the expression for $|p|^{2}$ restricted to $J^{-1}(\\mu)$ into the original Hamiltonian yields the reduced Hamiltonian on the shape space:\n$$\nH_{\\mathrm{red}}(r,p_{r};\\mu) \n\\;=\\; \\frac{1}{2 m} \\left( p_{r}^{2} \\;+\\; \\frac{\\mu^{2}}{r^{2}} \\right) \\;+\\; V(r)\n\\;=\\; \\frac{p_{r}^{2}}{2 m} \\;+\\; \\frac{\\mu^{2}}{2 m \\, r^{2}} \\;+\\; V(r).\n$$\nFrom this, the reduced equations are\n$$\n\\dot{r} \\;=\\; \\frac{p_{r}}{m}, \n\\qquad \n\\dot{p}_{r} \\;=\\; -V'(r) \\;+\\; \\frac{\\mu^{2}}{m \\, r^{3}}.\n$$\nPhysically, $r$ is the radial distance to the origin, $p_{r}$ is the radial component of the linear momentum (conjugate to $r$), and $\\mu$ is the conserved angular momentum. The term $\\frac{\\mu^{2}}{2 m r^{2}}$ in $H_{\\mathrm{red}}$ is the centrifugal barrier, encoding the effect of angular motion after reduction by symmetry. The absence of a magnetic term in the reduced symplectic form reflects the vanishing curvature of the mechanical connection for the planar rotation symmetry of the Euclidean metric.",
            "answer": "$$\\boxed{\\frac{p_{r}^{2}}{2 m} \\;+\\; \\frac{\\mu^{2}}{2 m \\, r^{2}} \\;+\\; V(r)}$$"
        },
        {
            "introduction": "This final practice bridges the gap between abstract theory and computational practice, demonstrating the profound utility of the geometric mechanics perspective. You will analyze the free rigid body, whose reduction leads to the famous Euler equations on the Lie-Poisson manifold $\\mathfrak{so}(3)^*$. The core of the exercise  is to numerically compare a naive integrator, which breaks the system's underlying symmetry, with an integrator on the reduced space, quantifying the dramatic difference in their ability to preserve conserved quantities.",
            "id": "3767954",
            "problem": "Consider a free rigid body with configuration space the Special Orthogonal group (SO(3)) and phase space the cotangent bundle $T^{*}SO(3)$ equipped with the canonical symplectic form. The Hamiltonian is given by the kinetic energy induced by a diagonal inertia tensor. Let the body angular momentum be the element $M \\in \\mathfrak{so}(3)^{*} \\cong \\mathbb{R}^{3}$, and let the inertia operator be a diagonal linear map $I: \\mathbb{R}^{3} \\to \\mathbb{R}^{3}$ with entries $I_{1}$, $I_{2}$, $I_{3}$ along the principal axes. The associated Hamiltonian function on the reduced space $\\mathfrak{so}(3)^{*}$ is $H(M)$ and the dynamics are governed by Hamiltonian mechanics on a Lie–Poisson manifold. The configuration dynamics are given by a rotation matrix $R \\in SO(3)$ satisfying the kinematic relation $R^{\\prime} = R \\,\\widehat{\\Omega}$, where $\\Omega \\in \\mathbb{R}^{3}$ is the body angular velocity, and $\\widehat{\\Omega} \\in \\mathfrak{so}(3)$ is the skew-symmetric matrix corresponding to the vector $\\Omega$ via the standard hat map.\n\nStarting strictly from the foundational principles of Hamiltonian mechanics, Lie group symmetries, and the reduction of a cotangent bundle by symmetry (no shortcut formulas are given), do the following:\n\n- Derive the reduced equation of motion on $\\mathfrak{so}(3)^{*}$ for the free rigid body and identify two invariants of this reduced dynamics that are conserved by the exact flow due to symmetry: the Hamiltonian $H(M)$ and the quadratic Casimir $C(M)$ of the Lie–Poisson structure.\n- Explain how, for the unreduced description on $T^{*}SO(3)$, the spatial angular momentum $L \\in \\mathbb{R}^{3}$ is conserved in the exact flow and how the body angular momentum $M$ relates to $L$ via the rotation matrix $R$.\n- Implement two numerical integrators:\n    1. A reduced explicit Runge–Kutta of order four (RK4) method stepping only the body angular momentum $M$ according to the reduced dynamics on $\\mathfrak{so}(3)^{*}$.\n    2. An unreduced explicit first-order method stepping the orientation $R$ by the naive forward Euler update $R_{n+1} = R_{n} + \\Delta t \\, R_{n} \\,\\widehat{\\Omega}_{n}$, where $\\Omega_{n}$ is computed from the instantaneous body angular momentum $M_{n}$, and $M_{n}$ is obtained from the conserved spatial angular momentum $L$ via $M_{n} = R_{n}^{\\top} L$. This discretization does not enforce the orthogonality constraint $R^{\\top}R = I$, thereby breaking the symmetry at the discrete level.\n- For both integrators, quantify the drift in the invariants at final time $T$ relative to their initial values by computing the relative error of $H$ and $C$, defined as $\\left|H_{\\text{final}} - H_{\\text{initial}}\\right| / H_{\\text{initial}}$ and $\\left|C_{\\text{final}} - C_{\\text{initial}}\\right| / C_{\\text{initial}}$. For the unreduced integrator, also quantify the violation of the orthogonality constraint by computing the Frobenius norm $\\|R^{\\top}R - I\\|_{F}$ at the final step.\n- All quantities are dimensionless and angles are in radians.\n\nUse the following test suite of parameter values, where each tuple lists $(I_{1}, I_{2}, I_{3})$, the initial body angular momentum $M(0)$, the time step $\\Delta t$, and the final time $T$:\n\n- Test $1$: $(I_{1}, I_{2}, I_{3}) = (2.0, 2.0, 1.0)$, $M(0) = (0.5, 0.1, 1.0)$, $\\Delta t = 0.02$, $T = 5.0$.\n- Test $2$: $(I_{1}, I_{2}, I_{3}) = (1.0, 1.0, 1.0)$, $M(0) = (1.0, -0.7, 0.3)$, $\\Delta t = 0.05$, $T = 5.0$.\n- Test $3$: $(I_{1}, I_{2}, I_{3}) = (2.0, 2.0, 1.0)$, $M(0) = (0.5, 0.1, 1.0)$, $\\Delta t = 0.001$, $T = 5.0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list of lists enclosed in square brackets. For each test case, output the list of five floats in the following order: $[\\text{drift}_{H}^{\\text{reduced}}, \\text{drift}_{H}^{\\text{unreduced}}, \\text{drift}_{C}^{\\text{reduced}}, \\text{drift}_{C}^{\\text{unreduced}}, \\|R^{\\top}R - I\\|_{F}]$. The final output format must be exactly: $[[r_{11},r_{12},r_{13},r_{14},r_{15}],[r_{21},r_{22},r_{23},r_{24},r_{25}],[r_{31},r_{32},r_{33},r_{34},r_{35}]]$, where each $r_{ij}$ is a float computed by your program.",
            "solution": "The problem requires a thorough analysis of the free rigid body dynamics from the perspective of geometric mechanics, followed by a numerical comparison between a reduced-space integrator and a naive unreduced-space integrator.\n\n### 1. Theoretical Formulation\n\n#### 1.1. System, Symmetry, and Reduction\nA free rigid body's orientation is described by a rotation matrix $R \\in SO(3)$, the Special Orthogonal group of dimension $3$. Its phase space is the cotangent bundle $T^{*}SO(3)$. The dynamics are governed by a Hamiltonian, which for a free body is its kinetic energy. The kinetic energy is naturally expressed in the body-fixed frame using the body angular velocity $\\Omega \\in \\mathbb{R}^3 \\cong \\mathfrak{so}(3)$. The relationship between the time derivative of the orientation $\\dot{R} \\in T_R SO(3)$ and $\\Omega$ is given by the kinematic equation $\\dot{R} = R \\widehat{\\Omega}$, where $\\widehat{\\cdot}: \\mathbb{R}^3 \\to \\mathfrak{so}(3)$ is the \"hat map\" sending a vector to its corresponding skew-symmetric matrix.\n\nThe Hamiltonian is $H = \\frac{1}{2} \\Omega \\cdot I \\Omega$, where $I$ is the diagonal inertia tensor in the body's principal axes frame, $I = \\text{diag}(I_1, I_2, I_3)$. The body angular momentum $M$ is defined as $M = \\frac{\\partial H}{\\partial \\Omega} = I\\Omega$. Expressing the Hamiltonian in terms of $M$ gives $H(M) = \\frac{1}{2} M \\cdot (I^{-1}M)$.\n\nThe Hamiltonian system on $T^{*}SO(3)$ possesses a left $SO(3)$ symmetry corresponding to the freedom to reorient the body in space without changing its dynamics (the kinetic energy is independent of $R$). This symmetry allows for a process called **symplectic reduction**. The symmetry action reduces the phase space $T^{*}SO(3)$ to the dual of the Lie algebra, $\\mathfrak{so}(3)^*$, which we identify with $\\mathbb{R}^3$ via the dot product. The variable on this reduced space is the body angular momentum $M$.\n\n#### 1.2. Reduced Dynamics: The Lie–Poisson Equation\nThe dynamics on the reduced space $\\mathfrak{so}(3)^*$ are not governed by the canonical symplectic structure but by a **Lie–Poisson structure**. For the Lie algebra $\\mathfrak{so}(3)$, the Lie–Poisson bracket of two functions $F, G: \\mathbb{R}^3 \\to \\mathbb{R}$ is given by:\n$$\n\\{F, G\\}(M) = M \\cdot (\\nabla_M F \\times \\nabla_M G)\n$$\nThe evolution of any observable $F(M)$ is given by Hamilton's equation $\\dot{F} = \\{F, H\\}$. To find the equations of motion for the momentum vector $M$ itself, we consider its components $M_i$.\n$$\n\\dot{M}_i = \\{M_i, H\\}(M) = M \\cdot (\\nabla_M M_i \\times \\nabla_M H)\n$$\nSince $\\nabla_M M_i = e_i$ (the $i$-th standard basis vector), this becomes $\\dot{M}_i = M \\cdot (e_i \\times \\nabla_M H)$. This is the $i$-th component of the vector equation:\n$$\n\\dot{M} = M \\times \\nabla_M H\n$$\nThe Hamiltonian is $H(M) = \\frac{1}{2} \\left( \\frac{M_1^2}{I_1} + \\frac{M_2^2}{I_2} + \\frac{M_3^2}{I_3} \\right)$. Its gradient with respect to $M$ is:\n$$\n\\nabla_M H = \\left( \\frac{\\partial H}{\\partial M_1}, \\frac{\\partial H}{\\partial M_2}, \\frac{\\partial H}{\\partial M_3} \\right) = \\left( \\frac{M_1}{I_1}, \\frac{M_2}{I_2}, \\frac{M_3}{I_3} \\right) = I^{-1}M\n$$\nThis vector is precisely the body angular velocity $\\Omega$. Substituting this into the equation for $\\dot{M}$, we obtain the celebrated **Euler equations for a free rigid body**:\n$$\n\\dot{M} = M \\times (I^{-1}M) = M \\times \\Omega\n$$\n\n#### 1.3. Invariants of the Motion\nThe reduced dynamics possess two independent conserved quantities (integrals of motion).\n\n1.  **The Hamiltonian ($H$)**: The Hamiltonian is always conserved by the flow it generates, provided it has no explicit time dependence. We can verify this with the Lie–Poisson bracket:\n    $$\n    \\dot{H} = \\{H, H\\} = M \\cdot (\\nabla_M H \\times \\nabla_M H) = 0\n    $$\n    since the cross product of any vector with itself is zero.\n\n2.  **The Casimir Invariant ($C$)**: A Lie–Poisson manifold may possess special functions called **Casimir invariants**, which Poisson-commute with all other functions on the manifold. For a function $C(M)$ to be a Casimir, we must have $\\{C, F\\}(M) = 0$ for any function $F(M)$. This requires $M \\cdot (\\nabla_M C \\times \\nabla_M F) = 0$. For this to hold for arbitrary $F$, the vector $M \\times \\nabla_M C$ must be zero, which means $\\nabla_M C$ must be parallel to $M$. The simplest non-trivial choice is $\\nabla_M C \\propto M$. Integrating this gives the quadratic Casimir $C(M) = \\|M\\|^2 = M_1^2 + M_2^2 + M_3^2$. Its conservation is guaranteed as $\\dot{C} = \\{C, H\\} = 0$. This invariant corresponds to the squared magnitude of the body angular momentum.\n\n#### 1.4. Unreduced Dynamics and Spatial Angular Momentum\nIn the unreduced description on $T^{*}SO(3)$, the aforementioned $SO(3)$ symmetry has a profound consequence due to **Noether's theorem**. The theorem states that this continuous symmetry implies the existence of a conserved quantity, known as the momentum map associated with the symmetry action. For the left $SO(3)$ action on $T^{*}SO(3)$, this conserved quantity is the **spatial angular momentum**, a vector $L \\in \\mathbb{R}^3$ that remains constant in the laboratory (spatial) frame.\n\nThe spatial momentum $L$ and body momentum $M$ are related by the current orientation $R \\in SO(3)$ through the Adjoint action:\n$$\nL = R M \\quad \\implies \\quad M(t) = R(t)^{-1} L = R(t)^T L\n$$\nSince $L$ is constant, the body-fixed momentum $M(t)$ changes over time as the body rotates. The dynamics of the full system can be seen as the evolution of $R(t)$ that maintains the constancy of $L$.\n\n### 2. Numerical Implementation\n\nWe implement and compare two numerical integrators as specified.\n\n#### 2.1. Integrator 1: Reduced Explicit Runge–Kutta (RK4)\nThis integrator operates on the reduced space $\\mathbb{R}^3$. The state is the vector $M$. We numerically solve the ODE $\\dot{M} = f(M) = M \\times (I^{-1}M)$ using the classical fourth-order Runge-Kutta scheme. Given $M_n$ at time $t_n$:\n$$\n\\begin{aligned}\nk_1 &= \\Delta t \\cdot f(M_n) \\\\\nk_2 &= \\Delta t \\cdot f(M_n + k_1/2) \\\\\nk_3 &= \\Delta t \\cdot f(M_n + k_2/2) \\\\\nk_4 &= \\Delta t \\cdot f(M_n + k_3) \\\\\nM_{n+1} &= M_n + \\frac{1}{6}(k_1 + 2k_2 + 2k_3 + k_4)\n\\end{aligned}\n$$\nThis method is highly accurate for a given step size $\\Delta t$, but as a generic ODE solver, it does not intrinsically preserve the Casimir invariant $C(M)$. However, the drift is expected to be very small, scaling with $(\\Delta t)^4$.\n\n#### 2.2. Integrator 2: Unreduced Naive Forward Euler\nThis integrator attempts to solve for the unreduced state $R \\in SO(3)$. We make the standard assumption that the simulation starts from the body frame, so $R(0) = I_{3\\times3}$ (the $3 \\times 3$ identity matrix). This allows us to compute the conserved spatial momentum once at the beginning: $L = R(0)M(0) = M(0)$.\n\nThe integration loop proceeds as follows for each step $n$:\n1.  Obtain the current body momentum from the constant $L$ and current orientation $R_n$: $M_n = R_n^T L$.\n2.  Compute the corresponding body angular velocity: $\\Omega_n = I^{-1}M_n$.\n3.  Update the orientation using the kinematic relation $\\dot{R} = R\\widehat{\\Omega}$, discretized by the first-order forward Euler method:\n    $$\n    R_{n+1} = R_n + \\Delta t \\cdot (R_n \\widehat{\\Omega}_n)\n    $$\nThis update is a simple matrix addition. It does not respect the geometric constraint that $R$ must belong to $SO(3)$ (i.e., $R^T R = I$ and $\\det(R)=1$). This \"symmetry breaking\" at the discrete level introduces errors that cause the numerical trajectory to leave the correct configuration manifold, leading to drifts in the conserved quantities $H$ and $C$ and a violation of orthogonality.\n\n#### 2.3. Error Quantification\nFor each integrator, we compute the state at the final time $T$. Let the initial momentum be $M_0$ and the final momentum be $M_T$. The initial invariants are $H_0 = H(M_0)$ and $C_0 = C(M_0)$. The final invariants are $H_T = H(M_T)$ and $C_T = C(M_T)$.\nThe relative drifts are computed as $\\frac{|H_T - H_0|}{|H_0|}$ and $\\frac{|C_T - C_0|}{|C_0|}$. For the unreduced integrator, the violation of the geometric constraint is measured by the Frobenius norm of the residual of the orthogonality condition at the final time, $\\|R_T^T R_T - I\\|_{F}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the rigid body dynamics problem using two different integrators\n    and computes the drift in conserved quantities.\n    \"\"\"\n    \n    # Test cases as specified in the problem statement.\n    # Each tuple: (I1, I2, I3), M(0), dt, T\n    test_cases = [\n        ((2.0, 2.0, 1.0), np.array([0.5, 0.1, 1.0]), 0.02, 5.0),\n        ((1.0, 1.0, 1.0), np.array([1.0, -0.7, 0.3]), 0.05, 5.0),\n        ((2.0, 2.0, 1.0), np.array([0.5, 0.1, 1.0]), 0.001, 5.0),\n    ]\n\n    # Helper function for the hat map\n    def hat(v):\n        \"\"\"Maps a vector in R^3 to a skew-symmetric matrix in so(3).\"\"\"\n        return np.array([\n            [0.0, -v[2], v[1]],\n            [v[2], 0.0, -v[0]],\n            [-v[1], v[0], 0.0]\n        ])\n\n    # Euler's equations for the rigid body: dM/dt = M x (I^-1 * M)\n    def f_M(M, inv_I):\n        \"\"\"The RHS of the reduced ODE for body angular momentum M.\"\"\"\n        omega = inv_I @ M\n        return np.cross(M, omega)\n\n    # Hamiltonian H(M) = 1/2 * M . (I^-1 * M)\n    def hamiltonian(M, inv_I):\n        return 0.5 * np.dot(M, inv_I @ M)\n\n    # Casimir C(M) = ||M||^2\n    def casimir(M):\n        return np.dot(M, M)\n\n    all_results = []\n\n    for case in test_cases:\n        I_diag, M0, dt, T = case\n        I = np.diag(I_diag)\n        inv_I = np.diag([1.0/i for i in I_diag])\n        \n        num_steps = int(round(T / dt))\n\n        # Initial values of conserved quantities\n        H0 = hamiltonian(M0, inv_I)\n        C0 = casimir(M0)\n\n        # --- 1. Reduced RK4 Integrator ---\n        M_red = M0.copy()\n        for _ in range(num_steps):\n            k1 = dt * f_M(M_red, inv_I)\n            k2 = dt * f_M(M_red + 0.5 * k1, inv_I)\n            k3 = dt * f_M(M_red + 0.5 * k2, inv_I)\n            k4 = dt * f_M(M_red + k3, inv_I)\n            M_red += (k1 + 2.0*k2 + 2.0*k3 + k4) / 6.0\n        \n        H_final_red = hamiltonian(M_red, inv_I)\n        C_final_red = casimir(M_red)\n        \n        drift_H_red = abs(H_final_red - H0) / abs(H0) if H0 != 0.0 else 0.0\n        drift_C_red = abs(C_final_red - C0) / abs(C0) if C0 != 0.0 else 0.0\n        \n        # --- 2. Unreduced Naive Euler Integrator ---\n        R_unred = np.identity(3)\n        L = M0.copy()  # Conserved spatial momentum, L = R(0)M(0) = I*M0 = M0\n\n        for _ in range(num_steps):\n            M_n = R_unred.T @ L\n            Omega_n = inv_I @ M_n\n            Omega_hat = hat(Omega_n)\n            R_unred += dt * (R_unred @ Omega_hat)\n            \n        M_final_unred = R_unred.T @ L\n        H_final_unred = hamiltonian(M_final_unred, inv_I)\n        C_final_unred = casimir(M_final_unred)\n\n        drift_H_unred = abs(H_final_unred - H0) / abs(H0) if H0 != 0.0 else 0.0\n        drift_C_unred = abs(C_final_unred - C0) / abs(C0) if C0 != 0.0 else 0.0\n        \n        ortho_error = np.linalg.norm(R_unred.T @ R_unred - np.identity(3), 'fro')\n\n        all_results.append([\n            drift_H_red, \n            drift_H_unred, \n            drift_C_red, \n            drift_C_unred, \n            ortho_error\n        ])\n\n    # Format the final output string\n    formatted_results = [\n        \"[\" + \",\".join(f\"{v:.15e}\" for v in res) + \"]\" \n        for res in all_results\n    ]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}