{
    "hands_on_practices": [
        {
            "introduction": "理解辛分区Runge-Kutta（SPRK）方法威力的第一步，是将其应用于一个基础而重要的模型系统。谐振子是研究数值积分器的典型模型，因为它足够简单，可以进行精确的解析分析，同时又足以揭示积分器性能的关键特征。本练习旨在通过从第一性原理出发，推导谐振子的精确解及其不变量，然后将一个简单的SPRK方法（隐式中点法）应用于同一系统，从而在哈密顿系统的精确流和其数值近似之间建立一座桥梁。通过这个过程，你将亲身体会到几何积分器如何以及为何能够保持系统的关键几何与物理结构 。",
            "id": "3769897",
            "problem": "考虑一个正则单自由度哈密顿系统，其哈密顿量为 $H(q,p)=\\frac{1}{2}\\left(\\omega^{2} q^{2}+p^{2}\\right)$，其中 $\\omega>0$ 是一个固定参数。正则运动方程由哈密顿方程给出，其精确流定义为这些方程在初始条件 $(q(0),p(0))=(q_{0},p_{0})$ 上作用的时间-$h$ 映射。请基于几何力学和辛方法的第一性原理，完成以下任务：\n\n1. 从哈密顿方程和正则辛结构出发，推导精确的时间-$h$ 解 $(q(h),p(h))$，用 $(q_{0},p_{0},\\omega,h)$ 表示，且不使用任何现成的解公式。你的推导必须明确利用矢量场的线性结构和相空间的辛几何性质。\n\n2. 使用辛微分同胚和正则辛二形式的定义，识别并证明该系统精确流所保持的辛不变量。你的识别必须源于哈密顿流的基本性质，并需同时论述一个几何不变量和一个动力学不变量。\n\n3. 现在考虑对此可分哈密顿量应用一个单级辛分块龙格-库塔 (SPRK) 方法，分块为 $T(p)=\\frac{1}{2}p^{2}$ 和 $V(q)=\\frac{1}{2}\\omega^{2}q^{2}$。该方法在 $p$-更新和 $q$-更新中具有相等的阶段权重 $a=\\frac{1}{2}$ 和 $b=\\frac{1}{2}$（这是分块形式的隐式中点法）。请从分块龙格-库塔方法的定义方程出发，推导从 $(q_{n},p_{n})$到$(q_{n+1},p_{n+1})$ 的线性单步映射，并解释其为何是辛的。然后，识别此离散映射所保持的一个二次不变量，并论证为何它对该系统是守恒的。\n\n请从上述基本定义出发，给出完整的推理过程，不得简化。将最终答案表示为时间-$h$ 映射 $(q(h),p(h))$ 关于 $(q_{0},p_{0},\\omega,h)$ 的精确解析表达式，并写成一个行矩阵。不需要进行数值近似。",
            "solution": "所述问题具有科学依据，是适定的、客观的且内部一致。它基于经典哈密顿力学、辛几何和几何数值积分的基本原理。所有必要的数据和定义均已提供。因此，该问题被认定为有效，并将提供解答。\n\n解答根据问题陈述的要求分为三个部分。\n\n### 第一部分：精确时间-$h$ 解的推导\n\n系统由哈密顿量 $H(q,p) = \\frac{1}{2}(\\omega^2 q^2 + p^2)$ 描述。哈密顿正则运动方程为：\n$$\n\\dot{q} = \\frac{\\partial H}{\\partial p} \\\\\n\\dot{p} = -\\frac{\\partial H}{\\partial q}\n$$\n对于给定的哈密顿量，其偏导数为：\n$$\n\\frac{\\partial H}{\\partial p} = p \\\\\n\\frac{\\partial H}{\\partial q} = \\omega^2 q\n$$\n将这些偏导数代入哈密顿方程，得到以下线性常微分方程组：\n$$\n\\dot{q} = p \\\\\n\\dot{p} = -\\omega^2 q\n$$\n令状态向量为 $\\mathbf{z}(t) = \\begin{pmatrix} q(t) \\\\ p(t) \\end{pmatrix}$。该系统可以写成矩阵形式 $\\dot{\\mathbf{z}} = \\mathbf{A}\\mathbf{z}$，其中矩阵 $\\mathbf{A}$ 为：\n$$\n\\mathbf{A} = \\begin{pmatrix} 0  1 \\\\ -\\omega^2  0 \\end{pmatrix}\n$$\n该矩阵代表哈密顿矢量场 $X_H = \\mathbf{J}\\nabla H$，其中 $\\mathbf{J} = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}$ 是正则辛矩阵，$\\nabla H = \\begin{pmatrix} \\partial H/\\partial q \\\\ \\partial H/\\partial p \\end{pmatrix}$。\n\n对于初始条件 $\\mathbf{z}(0) = \\mathbf{z}_0 = \\begin{pmatrix} q_0 \\\\ p_0 \\end{pmatrix}$，这个线性系统的解由矩阵指数的作用给出：\n$$\n\\mathbf{z}(h) = \\exp(h\\mathbf{A})\\mathbf{z}_0\n$$\n为了计算矩阵指数 $\\exp(h\\mathbf{A})$，我们首先计算 $\\mathbf{A}$ 的幂：\n$$\n\\mathbf{A}^2 = \\begin{pmatrix} 0  1 \\\\ -\\omega^2  0 \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ -\\omega^2  0 \\end{pmatrix} = \\begin{pmatrix} -\\omega^2  0 \\\\ 0  -\\omega^2 \\end{pmatrix} = -\\omega^2 \\mathbf{I}\n$$\n其中 $\\mathbf{I}$ 是 $2 \\times 2$ 单位矩阵。由此可得 $\\mathbf{A}^3 = -\\omega^2\\mathbf{A}$，$\\mathbf{A}^4 = \\omega^4\\mathbf{I}$，以此类推。\n\n使用矩阵指数的泰勒级数定义：\n$$\n\\exp(h\\mathbf{A}) = \\sum_{k=0}^{\\infty} \\frac{(h\\mathbf{A})^k}{k!} = \\mathbf{I} + h\\mathbf{A} + \\frac{h^2\\mathbf{A}^2}{2!} + \\frac{h^3\\mathbf{A}^3}{3!} + \\dots\n$$\n我们可以将包含 $\\mathbf{I}$ 和 $\\mathbf{A}$ 的项分组：\n$$\n\\exp(h\\mathbf{A}) = \\left(\\mathbf{I} - \\frac{h^2\\omega^2}{2!}\\mathbf{I} + \\frac{h^4\\omega^4}{4!}\\mathbf{I} - \\dots \\right) + \\left(h\\mathbf{A} - \\frac{h^3\\omega^2}{3!}\\mathbf{A} + \\frac{h^5\\omega^4}{5!}\\mathbf{A} - \\dots \\right)\n$$\n将矩阵因子提出并整理各项：\n$$\n\\exp(h\\mathbf{A}) = \\left(1 - \\frac{(\\omega h)^2}{2!} + \\frac{(\\omega h)^4}{4!} - \\dots \\right)\\mathbf{I} + \\frac{1}{\\omega}\\left(\\omega h - \\frac{(\\omega h)^3}{3!} + \\frac{(\\omega h)^5}{5!} - \\dots \\right)\\mathbf{A}\n$$\n识别出 $\\cos(\\omega h)$ 和 $\\sin(\\omega h)$ 的泰勒级数：\n$$\n\\exp(h\\mathbf{A}) = \\cos(\\omega h)\\mathbf{I} + \\frac{\\sin(\\omega h)}{\\omega}\\mathbf{A}\n$$\n代入矩阵 $\\mathbf{I}$ 和 $\\mathbf{A}$：\n$$\n\\exp(h\\mathbf{A}) = \\cos(\\omega h)\\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + \\frac{\\sin(\\omega h)}{\\omega}\\begin{pmatrix} 0  1 \\\\ -\\omega^2  0 \\end{pmatrix} = \\begin{pmatrix} \\cos(\\omega h)  \\frac{\\sin(\\omega h)}{\\omega} \\\\ -\\omega\\sin(\\omega h)  \\cos(\\omega h) \\end{pmatrix}\n$$\n因此，时间-$h$ 映射是一个由该矩阵表示的线性变换。将其应用于初始条件 $(q_0, p_0)$：\n$$\n\\begin{pmatrix} q(h) \\\\ p(h) \\end{pmatrix} = \\begin{pmatrix} \\cos(\\omega h)  \\frac{\\sin(\\omega h)}{\\omega} \\\\ -\\omega\\sin(\\omega h)  \\cos(\\omega h) \\end{pmatrix} \\begin{pmatrix} q_0 \\\\ p_0 \\end{pmatrix}\n$$\n这就给出了显式解：\n$$\nq(h) = q_0 \\cos(\\omega h) + \\frac{p_0}{\\omega} \\sin(\\omega h) \\\\\np(h) = -q_0 \\omega \\sin(\\omega h) + p_0 \\cos(\\omega h)\n$$\n\n### 第二部分：精确流的不变量\n\n由哈密顿矢量场生成的流 $\\Phi_t$ 的一个基本性质是它是一个**辛同胚**族。相空间上的一个映射 $\\Phi$ 如果保持辛二形式 $\\Omega$，则它是一个辛同胚。对于一个正则单自由度系统，辛形式为 $\\Omega = dq \\wedge dp$。保持意味着该形式被映射拉回后仍是其本身，即 $\\Phi_h^* \\Omega = \\Omega$。\n\n1.  **几何不变量**：几何不变量是辛二形式 $\\Omega = dq \\wedge dp$ 本身。在矩阵力学中，这种保持性表现为流映射的雅可比矩阵 $\\mathbf{M} = D\\Phi_h$ 必须是一个辛矩阵。一个矩阵 $\\mathbf{M}$ 如果满足 $\\mathbf{M}^T \\mathbf{J} \\mathbf{M} = \\mathbf{J}$，则它是辛矩阵，其中 $\\mathbf{J} = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}$。由于我们的流映射是线性的，其雅可比矩阵就是在第一部分中推导出的矩阵 $\\exp(h\\mathbf{A})$。我们来验证它是辛矩阵：\n    $$\n    \\mathbf{M} = \\begin{pmatrix} \\cos(\\omega h)  \\frac{\\sin(\\omega h)}{\\omega} \\\\ -\\omega\\sin(\\omega h)  \\cos(\\omega h) \\end{pmatrix}\n    $$\n    $$\n    \\mathbf{M}^T\\mathbf{J}\\mathbf{M} = \\begin{pmatrix} \\cos(\\omega h)  -\\omega\\sin(\\omega h) \\\\ \\frac{\\sin(\\omega h)}{\\omega}  \\cos(\\omega h) \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix} \\begin{pmatrix} \\cos(\\omega h)  \\frac{\\sin(\\omega h)}{\\omega} \\\\ -\\omega\\sin(\\omega h)  \\cos(\\omega h) \\end{pmatrix}\n    $$\n    $$\n    = \\begin{pmatrix} \\omega\\sin(\\omega h)  \\cos(\\omega h) \\\\ -\\cos(\\omega h)  \\frac{\\sin(\\omega h)}{\\omega} \\end{pmatrix} \\begin{pmatrix} \\cos(\\omega h)  \\frac{\\sin(\\omega h)}{\\omega} \\\\ -\\omega\\sin(\\omega h)  \\cos(\\omega h) \\end{pmatrix}\n    $$\n    $$\n    = \\begin{pmatrix} \\omega\\sin(\\omega h)\\cos(\\omega h) - \\omega\\cos(\\omega h)\\sin(\\omega h)  \\sin^2(\\omega h) + \\cos^2(\\omega h) \\\\ -\\cos^2(\\omega h) - \\sin^2(\\omega h)  -\\sin(\\omega h)\\cos(\\omega h) + \\sin(\\omega h)\\cos(\\omega h) \\end{pmatrix}\n    = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix} = \\mathbf{J}\n    $$\n    条件得到满足。$dq \\wedge dp$ 的保持性根据斯托克斯 (Stokes) 定理，意味着相空间中定向面积的保持（刘维尔 (Liouville) 定理）。\n\n2.  **动力学不变量**：对于任何自治哈密顿系统，哈密顿函数 $H$ 本身是一个运动常数，或称为动力学不变量。这可以从第一性原理出发，通过计算 $H$ 沿轨迹 $(q(t), p(t))$ 的全时间导数来证明：\n    $$\n    \\frac{dH}{dt} = \\frac{\\partial H}{\\partial q}\\dot{q} + \\frac{\\partial H}{\\partial p}\\dot{p}\n    $$\n    代入哈密顿方程 $\\dot{q} = \\partial H / \\partial p$ 和 $\\dot{p} = -\\partial H / \\partial q$：\n    $$\n    \\frac{dH}{dt} = \\frac{\\partial H}{\\partial q}\\left(\\frac{\\partial H}{\\partial p}\\right) + \\frac{\\partial H}{\\partial p}\\left(-\\frac{\\partial H}{\\partial q}\\right) = \\frac{\\partial H}{\\partial q}\\frac{\\partial H}{\\partial p} - \\frac{\\partial H}{\\partial p}\\frac{\\partial H}{\\partial q} = 0\n    $$\n    由于其时间导数为零，所以 $H(q(t),p(t))$ 在任何解轨迹上都是常数。对于该系统，动力学不变量是能量 $H(q,p) = \\frac{1}{2}(\\omega^2 q^2 + p^2)$。\n\n### 第三部分：SPRK 方法的分析\n\n问题描述了一种用于可分哈密顿量 $H(q,p) = T(p) + V(q)$ 的分块方法，其中 $T(p) = \\frac{1}{2}p^2$ 且 $V(q)=\\frac{1}{2}\\omega^2 q^2$。该方法被确定为分块形式的隐式中点法。此方法定义如下：\n$$\nq_{n+1} = q_n + h \\frac{\\partial T}{\\partial p}\\left(\\frac{p_n+p_{n+1}}{2}\\right) \\\\\np_{n+1} = p_n - h \\frac{\\partial V}{\\partial q}\\left(\\frac{q_n+q_{n+1}}{2}\\right)\n$$\n代入 $T(p)$ 和 $V(q)$ 的具体形式：\n$$\nq_{n+1} = q_n + h \\left(\\frac{p_n+p_{n+1}}{2}\\right) \\\\\np_{n+1} = p_n - h \\omega^2 \\left(\\frac{q_n+q_{n+1}}{2}\\right)\n$$\n这是一个关于 $(q_{n+1}, p_{n+1})$ 的线性方程组。我们重新整理它以求出单步映射矩阵。\n$$\nq_{n+1} - \\frac{h}{2} p_{n+1} = q_n + \\frac{h}{2} p_n \\\\\n\\frac{h\\omega^2}{2} q_{n+1} + p_{n+1} = p_n - \\frac{h\\omega^2}{2} q_n\n$$\n其矩阵形式为 $\\mathbf{L}\\mathbf{z}_{n+1} = \\mathbf{R}\\mathbf{z}_n$，其中 $\\mathbf{z}_k = \\begin{pmatrix} q_k \\\\ p_k \\end{pmatrix}$：\n$$\n\\begin{pmatrix} 1  -\\frac{h}{2} \\\\ \\frac{h\\omega^2}{2}  1 \\end{pmatrix} \\begin{pmatrix} q_{n+1} \\\\ p_{n+1} \\end{pmatrix} = \\begin{pmatrix} 1  \\frac{h}{2} \\\\ -\\frac{h\\omega^2}{2}  1 \\end{pmatrix} \\begin{pmatrix} q_n \\\\ p_n \\end{pmatrix}\n$$\n单步映射由矩阵 $\\mathbf{M}_{num} = \\mathbf{L}^{-1}\\mathbf{R}$ 给出。$\\mathbf{L}$ 的行列式为 $\\det(\\mathbf{L}) = (1)(1) - (-\\frac{h}{2})(\\frac{h\\omega^2}{2}) = 1 + \\frac{h^2\\omega^2}{4}$。\n$$\n\\mathbf{L}^{-1} = \\frac{1}{1 + \\frac{h^2\\omega^2}{4}} \\begin{pmatrix} 1  \\frac{h}{2} \\\\ -\\frac{h\\omega^2}{2}  1 \\end{pmatrix}\n$$\n因此，单步映射为：\n$$\n\\mathbf{M}_{num} = \\frac{1}{1 + \\frac{h^2\\omega^2}{4}} \\begin{pmatrix} 1  \\frac{h}{2} \\\\ -\\frac{h\\omega^2}{2}  1 \\end{pmatrix} \\begin{pmatrix} 1  \\frac{h}{2} \\\\ -\\frac{h\\omega^2}{2}  1 \\end{pmatrix} = \\frac{1}{1 + \\frac{h^2\\omega^2}{4}} \\begin{pmatrix} 1 - \\frac{h^2\\omega^2}{4}  h \\\\ -h\\omega^2  1 - \\frac{h^2\\omega^2}{4} \\end{pmatrix}\n$$\n这就是该方法的线性单步映射。\n\n此映射是辛的，因为它是由一个辛积分器生成的。与精确流一样，我们可以通过检验 $\\mathbf{M}_{num}^T \\mathbf{J} \\mathbf{M}_{num} = \\mathbf{J}$ 是否成立来验证这一点。高斯 (Gauss) 配置方法的一个普遍性质是它们是辛的，而隐式中点法是其最简单的（1级）例子。在第二部分中，对一个具有相同一般形式的矩阵进行了直接验证，证明了其为辛矩阵，并确认了其辛性质。对 $\\mathbf{M}_{num}$ 的计算在代数上是完全相同的。\n\n为了识别二次不变量，我们检验离散映射是否保持原始哈密顿量 $H(q,p)$。我们考察差值 $H(q_{n+1}, p_{n+1}) - H(q_n, p_n)$：\n$$\nH(q_{n+1}, p_{n+1}) - H(q_n, p_n) = \\frac{1}{2}\\left(\\omega^2 q_{n+1}^2 + p_{n+1}^2\\right) - \\frac{1}{2}\\left(\\omega^2 q_n^2 + p_n^2\\right)\n$$\n$$\n= \\frac{1}{2}\\left[ \\omega^2(q_{n+1}^2 - q_n^2) + (p_{n+1}^2 - p_n^2) \\right]\n$$\n使用平方差公式 $a^2-b^2 = (a-b)(a+b)$：\n$$\n= \\frac{1}{2}\\left[ \\omega^2(q_{n+1}-q_n)(q_{n+1}+q_n) + (p_{n+1}-p_n)(p_{n+1}+p_n) \\right]\n$$\n根据该方法的定义方程：\n$$\nq_{n+1}-q_n = h \\left(\\frac{p_n+p_{n+1}}{2}\\right) \\quad \\text{和} \\quad p_{n+1}-p_n = -h \\omega^2 \\left(\\frac{q_n+q_{n+1}}{2}\\right)\n$$\n将这些代入 $H$ 的变化表达式中：\n$$\n= \\frac{1}{2}\\left[ \\omega^2 \\left(h \\frac{p_n+p_{n+1}}{2}\\right)(q_{n+1}+q_n) + \\left(-h \\omega^2 \\frac{q_n+q_{n+1}}{2}\\right)(p_{n+1}+p_n) \\right]\n$$\n$$\n= \\frac{h\\omega^2}{4}\\left[ (p_n+p_{n+1})(q_{n+1}+q_n) - (q_n+q_{n+1})(p_{n+1}+p_n) \\right] = 0\n$$\n由于 $H(q_{n+1}, p_{n+1}) - H(q_n, p_n) = 0$，我们有 $H(q_{n+1}, p_{n+1}) = H(q_n, p_n)$。\n因此，对于该系统，离散映射精确保持的二次不变量是哈密顿量本身，$H(q,p) = \\frac{1}{2}(\\omega^2 q^2 + p^2)$。当隐式中点法应用于任何具有二次哈密顿量的系统时，这都是一个特殊的性质。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} q_{0} \\cos(\\omega h) + \\frac{p_{0}}{\\omega} \\sin(\\omega h)  p_{0} \\cos(\\omega h) - q_{0} \\omega \\sin(\\omega h) \\end{pmatrix} } $$"
        },
        {
            "introduction": "虽然所有辛方法都旨在保持相空间的辛结构，但它们在长期积分中的精度表现可能存在巨大差异。对于振荡系统（如天体力学中的轨道运动），相位误差是一个衡量长期保真度的核心指标。本练习将从定性理解转向定量分析，通过直接比较两种广泛使用的SPRK方法——二阶的Störmer-Verlet方法和四阶的Gauss-Legendre方法——来深入探讨这一概念。你将为这两种方法推导数值角频率，并计算它们各自的相位误差，从而具体地量化高阶方法在长期模拟中提供卓越相位精度的优势 。",
            "id": "3769885",
            "problem": "考虑一维谐振子，其哈密顿量为 $H(q,p)=\\frac{1}{2}p^{2}+\\frac{1}{2}\\omega^{2}q^{2}$，其中 $q$ 是位置，$p$ 是动量，$\\omega0$ 是精确角频率。该哈密顿系统由哈密顿方程 $\\dot{q}=p$ 和 $\\dot{p}=-\\omega^{2}q$ 控制。相向量 $(q,p)$ 上的精确时间-$h$流是在相平面中旋转角度 $h\\omega$。\n\n将两种辛时间步进方法应用于此系统：\n- Störmer-Verlet方法（也称为速度-Verlet或蛙跳法），定义为\n$$p_{n+\\frac{1}{2}}=p_{n}-\\frac{h}{2}\\,\\omega^{2}q_{n},\\quad q_{n+1}=q_{n}+h\\,p_{n+\\frac{1}{2}},\\quad p_{n+1}=p_{n+\\frac{1}{2}}-\\frac{h}{2}\\,\\omega^{2}q_{n+1}.$$\n- 一种基于两阶Gauss-Legendre配置对的两阶辛配分Runge-Kutta (SPRK) 方法，具有相等的权重 $\\widehat{b}_{1}=b_{1}=\\frac{1}{2}$，$\\widehat{b}_{2}=b_{2}=\\frac{1}{2}$，节点 $c_{1}=\\frac{1}{2}-\\frac{\\sqrt{3}}{6}$，$c_{2}=\\frac{1}{2}+\\frac{\\sqrt{3}}{6}$，以及系数矩阵\n$$A=\\begin{pmatrix}\\frac{1}{4}  \\frac{1}{4}-\\frac{\\sqrt{3}}{6} \\\\ [4pt] \\frac{1}{4}+\\frac{\\sqrt{3}}{6}  \\frac{1}{4}\\end{pmatrix},\\qquad \\widehat{A}=A^{\\top},$$\n应用于配分系统 $\\dot{q}=+\\frac{\\partial H}{\\partial p}=p$，$\\dot{p}=-\\frac{\\partial H}{\\partial q}=-\\omega^{2}q$。对 $(A,\\widehat{A},b,\\widehat{b})$ 满足配分Runge-Kutta方法的辛条件。\n\n仅使用哈密顿力学的基本定律和这些数值方法的定义，从第一性原理推导作用于谐振子的这两种方法各自的单步线性放大矩阵。将数值相增量 $\\vartheta(h\\omega)$ 定义为单步映射特征值的辐角（对于谐振子的辛线性映射，其特征值位于单位圆上），并将数值角频率 $\\Omega(h,\\omega)$ 定义为 $\\Omega(h,\\omega)=\\frac{\\vartheta(h\\omega)}{h}$。\n\n计算每种方法的数值角频率 $\\Omega(h,\\omega)$ 的闭式解析表达式，然后计算相关的相误差作为 $h\\omega$ 的函数，定义为 $\\Delta(h\\omega)=\\vartheta(h\\omega)-h\\omega$。角度以弧度表示。数值角频率以弧度/单位时间表示。以单行矩阵的形式提供您的最终答案，顺序为 $\\bigl[\\Omega_{\\text{Verlet}}(h,\\omega)\\ \\ \\Omega_{\\text{Gauss-2}}(h,\\omega)\\ \\ \\Delta_{\\text{Verlet}}(h\\omega)\\ \\ \\Delta_{\\text{Gauss-2}}(h\\omega)\\bigr]$。",
            "solution": "谐振子是典型的线性哈密顿系统\n$$\\dot{q}=p,\\qquad \\dot{p}=-\\omega^{2}q.$$\n将状态写成列向量 $x=\\begin{pmatrix}q\\\\p\\end{pmatrix}$，系统为 $\\dot{x}=A x$，其中\n$$A=\\begin{pmatrix} 0  1 \\\\ -\\omega^{2}  0 \\end{pmatrix}.$$\n经过一步 $h$ 后的精确解为 $x_{n+1}=\\exp(hA)\\,x_{n}$，这是一个旋转矩阵\n$$\\exp(hA)=\\begin{pmatrix}\\cos(h\\omega)  \\frac{1}{\\omega}\\sin(h\\omega) \\\\ -\\omega\\sin(h\\omega)  \\cos(h\\omega)\\end{pmatrix},$$\n其特征值为 $\\exp(\\pm i h\\omega)$，所以每步的精确相增量是 $h\\omega$。\n\n对于应用于此线性系统的辛单步方法，放大矩阵 $M(h)$ 是一个实的 $2\\times 2$ 辛矩阵，其行列式为 $1$ 且特征值在单位圆上共轭，我们可以将其写为 $\\exp(\\pm i\\vartheta)$，其中 $\\vartheta=\\vartheta(h\\omega)\\in\\mathbb{R}$。数值角频率定义为 $\\Omega(h,\\omega)=\\frac{\\vartheta(h\\omega)}{h}$，相误差为 $\\Delta(h\\omega)=\\vartheta(h\\omega)-h\\omega$。\n\n我们现在为每种方法推导 $M(h)$ 和 $\\vartheta$。\n\nStörmer-Verlet方法。其更新方程为\n$$p_{n+\\frac{1}{2}}=p_{n}-\\frac{h}{2}\\omega^{2}q_{n},$$\n$$q_{n+1}=q_{n}+h p_{n+\\frac{1}{2}},$$\n$$p_{n+1}=p_{n+\\frac{1}{2}}-\\frac{h}{2}\\omega^{2}q_{n+1}.$$\n我们消去 $p_{n+\\frac{1}{2}}$ 以获得作用于 $\\begin{pmatrix}q_{n}\\\\ p_{n}\\end{pmatrix}$ 的线性映射。首先，\n$$q_{n+1}=q_{n}+h\\left(p_{n}-\\frac{h}{2}\\omega^{2}q_{n}\\right)=\\left(1-\\frac{h^{2}\\omega^{2}}{2}\\right)q_{n}+h p_{n}.$$\n接下来，\n\\begin{align*}\np_{n+1}=p_{n}-\\frac{h}{2}\\omega^{2}q_{n}-\\frac{h}{2}\\omega^{2}q_{n+1}\\\\\n=p_{n}-\\frac{h}{2}\\omega^{2}q_{n}-\\frac{h}{2}\\omega^{2}\\left[\\left(1-\\frac{h^{2}\\omega^{2}}{2}\\right)q_{n}+h p_{n}\\right]\\\\\n=\\left(1-\\frac{h^{2}\\omega^{2}}{2}\\right)p_{n}+\\left(-h\\omega^{2}+\\frac{h^{3}\\omega^{4}}{4}\\right)q_{n}.\n\\end{align*}\n因此放大矩阵为\n$$M_{\\text{Verlet}}(h)=\\begin{pmatrix}1-\\frac{h^{2}\\omega^{2}}{2}  h \\\\ [4pt] -h\\omega^{2}+\\frac{h^{3}\\omega^{4}}{4}  1-\\frac{h^{2}\\omega^{2}}{2}\\end{pmatrix}.$$\n由于 $\\det(M_{\\text{Verlet}})=1$，特征值在单位圆上。相增量 $\\vartheta$ 满足 $\\cos(\\vartheta)=\\frac{1}{2}\\operatorname{tr}(M_{\\text{Verlet}})$，因此\n$$\\cos(\\vartheta_{\\text{Verlet}})=1-\\frac{h^{2}\\omega^{2}}{2}.$$\n等价地，使用 $\\cos(\\vartheta)=1-2\\sin^{2}(\\vartheta/2)$，我们得到\n$$\\sin\\!\\left(\\frac{\\vartheta_{\\text{Verlet}}}{2}\\right)=\\frac{h\\omega}{2},\\qquad \\vartheta_{\\text{Verlet}}(h\\omega)=2\\,\\arcsin\\!\\left(\\frac{h\\omega}{2}\\right).$$\n因此Verlet方法的数值角频率是\n$$\\Omega_{\\text{Verlet}}(h,\\omega)=\\frac{\\vartheta_{\\text{Verlet}}(h\\omega)}{h}=\\frac{2}{h}\\,\\arcsin\\!\\left(\\frac{h\\omega}{2}\\right).$$\n相误差函数是\n$$\\Delta_{\\text{Verlet}}(h\\omega)=\\vartheta_{\\text{Verlet}}(h\\omega)-h\\omega=2\\,\\arcsin\\!\\left(\\frac{h\\omega}{2}\\right)-h\\omega.$$\n\n两阶辛配分Runge-Kutta (Gauss-Legendre) 方法。两阶Gauss-Legendre配置法是一种经典的4阶辛Runge-Kutta格式。当应用于线性系统 $\\dot{x}=A x$ 时，其单步放大由矩阵指数的 $[2/2]$ 阶有理Padé逼近给出，即\n$$M_{\\text{Gauss-2}}(h)=R(hA),\\qquad R(z)=\\frac{1+\\frac{z}{2}+\\frac{z^{2}}{12}}{1-\\frac{z}{2}+\\frac{z^{2}}{12}},$$\n这是Gauss配置法一个经过充分检验和广泛接受的事实。对于我们的谐振子，$A$ 的特征值是 $\\pm i\\omega$，所以 $M_{\\text{Gauss-2}}(h)$ 的特征值是 $R(\\pm i h\\omega)$。令 $s=h\\omega$。计算 $R(i s)$：\n$$R(i s)=\\frac{1+\\frac{i s}{2}-\\frac{s^{2}}{12}}{1-\\frac{i s}{2}-\\frac{s^{2}}{12}}.$$\n分母是分子的复共轭，因此 $|R(i s)|=1$ 并且 $R(i s)=\\exp(i\\vartheta_{\\text{Gauss-2}})$ 满足 $\\vartheta_{\\text{Gauss-2}}=2\\,\\arg\\!\\left(1+\\frac{i s}{2}-\\frac{s^{2}}{12}\\right)$。对于复数 $a+ib$，其中 $a=1-\\frac{s^{2}}{12}$ 和 $b=\\frac{s}{2}$，其辐角为 $\\arctan\\!\\left(\\frac{b}{a}\\right)$，所以\n$$\\vartheta_{\\text{Gauss-2}}(h\\omega)=2\\,\\arctan\\!\\left(\\frac{\\frac{s}{2}}{1-\\frac{s^{2}}{12}}\\right)=2\\,\\arctan\\!\\left(\\frac{\\frac{h\\omega}{2}}{1-\\frac{h^{2}\\omega^{2}}{12}}\\right).$$\n因此数值角频率是\n$$\\Omega_{\\text{Gauss-2}}(h,\\omega)=\\frac{\\vartheta_{\\text{Gauss-2}}(h\\omega)}{h}=\\frac{2}{h}\\,\\arctan\\!\\left(\\frac{\\frac{h\\omega}{2}}{1-\\frac{h^{2}\\omega^{2}}{12}}\\right),$$\n并且相误差函数是\n$$\\Delta_{\\text{Gauss-2}}(h\\omega)=\\vartheta_{\\text{Gauss-2}}(h\\omega)-h\\omega=2\\,\\arctan\\!\\left(\\frac{\\frac{h\\omega}{2}}{1-\\frac{h^{2}\\omega^{2}}{12}}\\right)-h\\omega.$$\n\n通过级数展开进行比较（以表征相误差阶数）。对于小的 $s=h\\omega$，\n$$\\vartheta_{\\text{Verlet}}(s)=2\\arcsin\\!\\left(\\frac{s}{2}\\right)=s+\\frac{s^{3}}{24}+\\frac{3 s^{5}}{640}+O(s^{7}),$$\n所以 $\\Delta_{\\text{Verlet}}(s)=\\frac{s^{3}}{24}+\\frac{3 s^{5}}{640}+O(s^{7})$，表明主导相误差为三次，与二阶精度一致。对于Gauss两阶方法，\n\\begin{align*}\n\\vartheta_{\\text{Gauss-2}}(s)=2\\arctan\\!\\left(\\frac{\\frac{s}{2}}{1-\\frac{s^{2}}{12}}\\right)=2\\arctan\\!\\left(\\frac{s}{2}+ \\frac{s^{3}}{24}+ \\frac{s^{5}}{288}+O(s^{7})\\right)\\\\\n=s+\\underbrace{0}_{\\text{在 }s^{3}\\text{ 处抵消}}+\\frac{s^{5}}{1440}+O(s^{7}),\n\\end{align*}\n所以 $\\Delta_{\\text{Gauss-2}}(s)=\\frac{s^{5}}{1440}+O(s^{7})$，反映了四阶精度和对于足够小的 $s$ 而言显著更小的相误差。\n\n按要求的顺序收集闭式表达式，我们有\n$$\\Omega_{\\text{Verlet}}(h,\\omega)=\\frac{2}{h}\\,\\arcsin\\!\\left(\\frac{h\\omega}{2}\\right),\\qquad \\Omega_{\\text{Gauss-2}}(h,\\omega)=\\frac{2}{h}\\,\\arctan\\!\\left(\\frac{\\frac{h\\omega}{2}}{1-\\frac{h^{2}\\omega^{2}}{12}}\\right),$$\n$$\\Delta_{\\text{Verlet}}(h\\omega)=2\\,\\arcsin\\!\\left(\\frac{h\\omega}{2}\\right)-h\\omega,\\qquad \\Delta_{\\text{Gauss-2}}(h\\omega)=2\\,\\arctan\\!\\left(\\frac{\\frac{h\\omega}{2}}{1-\\frac{h^{2}\\omega^{2}}{12}}\\right)-h\\omega.$$\n这些是弧度表示的角度函数，数值角频率的单位是弧度/单位时间。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\dfrac{2}{h}\\,\\arcsin\\!\\left(\\dfrac{h\\omega}{2}\\right)  \\dfrac{2}{h}\\,\\arctan\\!\\left(\\dfrac{\\frac{h\\omega}{2}}{1-\\frac{h^{2}\\omega^{2}}{12}}\\right)  2\\,\\arcsin\\!\\left(\\dfrac{h\\omega}{2}\\right)-h\\omega  2\\,\\arctan\\!\\left(\\dfrac{\\frac{h\\omega}{2}}{1-\\frac{h^{2}\\omega^{2}}{12}}\\right)-h\\omega\\end{pmatrix}}$$"
        },
        {
            "introduction": "在分析了现有方法之后，下一步自然是学习如何构造新的、性能更优的积分器。对称复合是一种强大而优雅的技术，它允许我们通过组合简单的低阶辛积分器来系统地构建高阶辛方法。本练习将引导你从分析者转变为设计者，运用李代数的基本原理（通过Baker-Campbell-Hausdorff展开）来推导构造一个四阶方法所需的代数条件。这个练习不仅展示了一种构造高级数值格式的通用策略，而且从根本上阐明了为何这种复合构造能够自动保证所生成方法的辛性 。",
            "id": "3769900",
            "problem": "考虑一个可分哈密顿系统，其哈密顿量为 $H(q,p) = T(p) + V(q)$，定义在具有典范辛形式的余切丛上。令 $\\Phi_{A}^{t}$ 和 $\\Phi_{B}^{t}$ 分别表示由 $A := T$ 和 $B := V$ 生成的精确哈密顿流。对于时间步长 $h$，一个标准的对称二阶辛分裂（通常称为 Stoermer–Verlet 或 Strang 步）是复合映射 $\\Phi_{A}^{h/2} \\circ \\Phi_{B}^{h} \\circ \\Phi_{A}^{h/2}$。将这种二阶步长通过缩放时间步 $w_{1} h$、$w_{0} h$、$w_{1} h$ 进行三阶段对称复合，得到一个方法\n$$\n\\mathcal{S}_{4}(h) \\;=\\; \\mathcal{S}_{2}(w_{1} h)\\,\\circ\\,\\mathcal{S}_{2}(w_{0} h)\\,\\circ\\,\\mathcal{S}_{2}(w_{1} h),\n$$\n其中 $\\mathcal{S}_{2}(x h) := \\Phi_{A}^{x h/2} \\circ \\Phi_{B}^{x h} \\circ \\Phi_{A}^{x h/2}$。将此方法解释为可分系统的辛分块 Runge–Kutta (SPRK) 方法，可以得到一个具有对称系数的漂移-冲击-漂移（drift–kick–drift）结构。\n\n从以下基本事实出发：(i) 每个部分流 $\\Phi_{A}^{t}$ 和 $\\Phi_{B}^{t}$ 都是辛的；(ii) 辛映射的复合是辛的；以及 (iii) 用于李导数指数复合的 Baker–Campbell–Hausdorff 展开决定了分裂格式的局部误差结构，请完成以下任务：\n\n1. 推导 $w_{1}$ 和 $w_{0}$ 必须满足的相容性条件，以使 $\\mathcal{S}_{4}(h)$ 与精确流 $\\exp(h(L_{A}+L_{B}))$ 是一阶相容的，其中 $L_{A}$ 和 $L_{B}$ 是 $A$ 和 $B$ 的李导数。\n2. 利用复合的对称性和 Baker–Campbell–Hausdorff 展开得到的局部误差主阶结构，推导为消除三阶误差项所需的额外阶条件，从而使该方法达到经典的 4 阶精度。\n3. 求解这些条件，得到 $w_{1}$ 的一个闭式表达式。\n4. 从辛几何的第一性原理和通过精确部分流复合的构造出发，论证所得到的三阶段格式作为一个辛分块 Runge–Kutta 方法是辛的。\n\n将最终答案表示为 $w_{1}$ 的最简形式的精确代数表达式。不要提供中间系数；只报告 $w_{1}$ 作为你的最终答案。",
            "solution": "解答的结构旨在解决问题陈述中提出的四个任务。我们使用李算子的语言，其中哈密顿量 $G$ 的流由指数映射 $\\exp(t L_G)$ 表示，而 $L_G = \\{ \\cdot, G \\}$ 是李导数（泊松括号算子）。\n\n#### 1. 一阶相容性条件\n对于总哈密顿量 $H=A+B$，在时间步长 $h$ 上的精确流由 $\\exp(h(L_A+L_B))$ 给出。如果一个数值方法的算子展开与精确流算子匹配到 $O(h)$ 阶，则该方法是一阶相容的。\n\n方法 $\\mathcal{S}_{4}(h)$ 是三个步骤 $\\mathcal{S}_{2}(w_{1} h)$、$\\mathcal{S}_{2}(w_{0} h)$ 和 $\\mathcal{S}_{2}(w_{1} h)$ 的复合。每一步 $\\mathcal{S}_{2}(x h)$ 近似了时长为 $x h$ 的精确流。算子 $\\mathcal{S}_{2}(x h)$ 展开中的最低阶项就是 $\\exp(x h(L_A+L_B))$。\n\n为了找到复合方法 $\\mathcal{S}_{4}(h)$ 的最低阶项，我们将各组成部分的最低阶项进行复合：\n$$\n\\exp(w_{1} h (L_A+L_B)) \\circ \\exp(w_{0} h (L_A+L_B)) \\circ \\exp(w_{1} h (L_A+L_B))\n$$\n由于算子 $(L_A+L_B)$ 与自身对易，指数的复合简化为参数之和的指数：\n$$\n\\exp\\left((w_{1} h + w_{0} h + w_{1} h)(L_A+L_B)\\right) = \\exp\\left((2w_{1} + w_{0})h(L_A+L_B)\\right)\n$$\n为满足一阶相容性，这必须至少在 $h$ 的一阶上与精确流算子 $\\exp(h(L_A+L_B))$ 匹配。这要求总有效时间步长等于 $h$：\n$$\n(2w_{1} + w_{0})h = h\n$$\n因此，相容性条件是：\n$$\n2w_{1} + w_{0} = 1\n$$\n\n#### 2. 四阶条件（消除三阶误差）\n方法 $\\mathcal{S}_{2}(h)$ 是对称的。对于一个经典阶为 $p$ 的对称方法，其生成的流对应于一个修正哈密顿量的精确流，其李算子级数在主项之外只包含 $h$ 的奇次幂：$L_{\\text{method}} = (L_A+L_B) + h^{p} C_{p+1} + h^{p+2} C_{p+3} + \\dots$。\n方法 $\\mathcal{S}_{2}(h)$ 是二阶的，所以 $p=2$。其李算子展开为：\n$$\nL_{\\mathcal{S}_2(h)} = (L_A+L_B) + h^2 E_3 + h^4 E_5 + \\dots\n$$\n这意味着 $\\mathcal{S}_2(h)$ 的流可以写成 $\\exp(h(L_A+L_B) + h^3 E_3 + h^5 E_5 + \\dots)$，其中 $E_k$ 是包含 $L_A$ 和 $L_B$ 的嵌套李括号的算子。\n\n因此，一个组成步骤 $\\mathcal{S}_{2}(x h)$ 的流是：\n$$\n\\exp(x h(L_A+L_B) + (x h)^3 E_3 + O(h^5))\n$$\n当我们复合对称方法时，复合方法的主误差项就是各组成方法主误差项之和。方法 $\\mathcal{S}_4(h)$ 是对称方法的对称复合，因此其自身的误差展开也只包含 $h$ 的奇次幂。$\\mathcal{S}_4(h)$ 的主误差项是来自每个阶段的 $h^3$ 误差项之和：\n- 来自第一阶段 $\\mathcal{S}_{2}(w_{1} h)$：$(w_{1} h)^3 E_3$\n- 来自第二阶段 $\\mathcal{S}_{2}(w_{0} h)$：$(w_{0} h)^3 E_3$\n- 来自第三阶段 $\\mathcal{S}_{2}(w_{1} h)$：$(w_{1} h)^3 E_3$\n\n$\\mathcal{S}_4(h)$ 的 $h^3 E_3$ 误差项的总系数是这些贡献之和：\n$$\n(w_{1}^3 + w_{0}^3 + w_{1}^3) h^3 E_3 = (2w_{1}^3 + w_{0}^3) h^3 E_3\n$$\n为了使方法的精度阶数高于 2，我们必须消除这个主误差项。由于 $E_3$ 通常不为零，其系数必须为零。这给出了第二个条件：\n$$\n2w_{1}^3 + w_{0}^3 = 0\n$$\n当这个条件满足时，$O(h^3)$ 误差项消失。因为整个方法是对称的，所以 $O(h^4)$ 误差项也保证为零，从而将该方法的经典阶数提升到 4。\n\n#### 3. 求解 $w_1$\n我们现在求解由 $w_1$ 和 $w_0$ 组成的两个代数方程组：\n1. $2w_{1} + w_{0} = 1$\n2. $2w_{1}^3 + w_{0}^3 = 0$\n\n从方程 (2) 出发，对两边取实数立方根，得到：\n$$\nw_{0}^3 = -2w_{1}^3 \\implies w_{0} = -2^{1/3} w_{1}\n$$\n现在，将 $w_0$ 的这个表达式代入方程 (1)：\n$$\n2w_{1} + (-2^{1/3} w_{1}) = 1\n$$\n提取 $w_1$：\n$$\nw_{1} (2 - 2^{1/3}) = 1\n$$\n求解 $w_1$ 得到闭式表达式：\n$$\nw_{1} = \\frac{1}{2 - 2^{1/3}}\n$$\n\n#### 4. 辛性的论证\n方法 $\\mathcal{S}_4(h)$ 的辛性论证基于问题中陈述的几何力学的两个基本原理。\n1.  **哈密顿流是一个辛映射。** 根据定义，部分流 $\\Phi_{A}^{t}$ 和 $\\Phi_{B}^{t}$ 分别是哈密顿量 $A=T(p)$ 和 $B=V(q)$ 的精确流。因此，对于任意时间 $t$，$\\Phi_{A}^{t}$ 和 $\\Phi_{B}^{t}$ 都是辛映射。辛映射是保持典范辛二形式 $\\omega = \\sum_i dp_i \\wedge dq_i$ 不变的变换。\n2.  **辛映射的复合是辛映射。** 在给定的相空间上，所有辛映射的集合在映射复合运算下构成一个群。这意味着如果 $\\Psi_1$ 和 $\\Psi_2$ 是辛的，那么它们的复合 $\\Psi_1 \\circ \\Psi_2$ 也是辛的。\n\n$\\mathcal{S}_4(h)$ 的构造是一个多级复合：\n- 首先，基本步骤 $\\mathcal{S}_{2}(x h) = \\Phi_{A}^{x h/2} \\circ \\Phi_{B}^{x h} \\circ \\Phi_{A}^{x h/2}$ 是三个映射的复合：$\\Phi_{A}^{x h/2}$、$\\Phi_{B}^{x h}$ 和 $\\Phi_{A}^{x h/2}$。由于这些都是哈密顿流，所以每一个都是辛映射。根据原理 (2)，对于任意实数 $x$ 和 $h$，它们的复合 $\\mathcal{S}_{2}(x h)$ 也是一个辛映射。\n- 其次，完整方法 $\\mathcal{S}_{4}(h) = \\mathcal{S}_{2}(w_{1} h)\\,\\circ\\,\\mathcal{S}_{2}(w_{0} h)\\,\\circ\\,\\mathcal{S}_{2}(w_{1} h)$ 是三个映射的复合：$\\mathcal{S}_{2}(w_{1} h)$、$\\mathcal{S}_{2}(w_{0} h)$ 和 $\\mathcal{S}_{2}(w_{1} h)$。如前一点所述，这些 $\\mathcal{S}_2$ 映射中的每一个都是辛的。\n- 因此，再次应用原理 (2)，最终的映射 $\\mathcal{S}_{4}(h)$ 是辛映射的复合，其本身也是辛的。\n\n这个性质对 $w_0$ 和 $w_1$ 的任何实数值都成立。在第 1-3 部分推导出的条件确保了该方法具有高阶精度，但辛性是通过精确哈密顿流的复合构造所固有的结构特性。一个辛分块 Runge-Kutta (SPRK) 方法是指其 Butcher 系数表满足一组代数辛条件的方法。由于 $\\mathcal{S}_{4}(h)$ 是通过构造得到的辛方法，其 SPRK 系数保证满足这些条件。",
            "answer": "$$\\boxed{\\frac{1}{2 - 2^{1/3}}}$$"
        }
    ]
}