{
    "hands_on_practices": [
        {
            "introduction": "许多复杂的哈密顿系统可以通过研究更简单的离散时间映射来理解，这些映射捕捉了其核心动力学特征。本练习将引导您从一个具有物理背景的系统（周期性受踢转子）出发，推导出哈密顿混沌中最著名的模型之一——Chirikov标准映射 ()。此过程将巩固连续时间哈密顿力学与离散辛映射之间的联系，并揭示面积守恒这一基本属性。",
            "id": "3746892",
            "problem": "考虑在正则坐标 $(q,p) \\in \\mathbb{R} \\times \\mathbb{R}$ 中的周期性受踢转子，其具有周期性依赖于时间的哈密顿量\n$$\nH(q,p,t) = \\frac{p^{2}}{2} + \\kappa \\cos(q) \\sum_{n \\in \\mathbb{Z}} \\delta(t - n),\n$$\n其中 $\\kappa \\in \\mathbb{R}$ 是一个参数，$\\delta(\\cdot)$ 是狄拉克δ分布。令 $\\Phi_{\\kappa}$ 表示将状态从一次踢动刚结束后推进到下一次踢动刚结束后的庞加莱映射（即周期为1的频闪采样）。在正则坐标下，使用正则辛矩阵\n$$\nJ = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}.\n$$\n从哈密顿方程和庞加莱映射的定义出发，推导 $\\Phi_{\\kappa}$ 作为一次踢动和一个单位时间的漂移的复合形式，计算其在任意点 $(q,p)$ 处的雅可比矩阵 $D\\Phi_{\\kappa}(q,p)$，并求出其雅可比行列式。然后通过对所有 $(q,p)$ 检验条件 $D\\Phi_{\\kappa}(q,p)^{T} J \\, D\\Phi_{\\kappa}(q,p) = J$ 来验证其辛性。\n\n将雅可比行列式 $\\det(D\\Phi_{\\kappa}(q,p))$ 的值作为你的最终答案，以最简的单个闭式解析表达式形式报告。无需数值四舍五-入，不涉及单位。",
            "solution": "该问题要求推导和分析周期性受踢转子的庞加莱映射，这是哈密顿动力学中的一个典型模型。我们将验证问题设置，推导该映射，计算其雅可比矩阵，并验证其辛性质。\n\n首先，我们从给定的含时哈密顿量开始：\n$$\nH(q,p,t) = \\frac{p^{2}}{2} + \\kappa \\cos(q) \\sum_{n \\in \\mathbb{Z}} \\delta(t - n)\n$$\n系统的动力学由哈密顿方程决定：\n$$\n\\dot{q} = \\frac{\\partial H}{\\partial p} \\quad \\text{和} \\quad \\dot{p} = -\\frac{\\partial H}{\\partial q}\n$$\n代入哈密顿量，我们得到：\n$$\n\\dot{q} = p\n$$\n$$\n\\dot{p} = \\kappa \\sin(q) \\sum_{n \\in \\mathbb{Z}} \\delta(t - n)\n$$\n庞加莱映射 $\\Phi_{\\kappa}$ 将状态 $(q,p)$ 从时间 $t=n^{+}$（第 $n$ 次踢动刚结束）推进到 $t=(n+1)^{+}$（第 $n+1$ 次踢动刚结束）。在一个时间周期内，从 $t \\in [n^{+}, (n+1)^{+}]$ 的演化包含两个不同部分：在 $t \\in (n, n+1)$ 期间的“自由漂移”和在 $t=n+1$ 时的瞬时“踢动”。\n\n令 $(q_n, p_n)$ 为 $t=n^{+}$ 时的状态。我们将跟踪其演化以求得 $t=(n+1)^{+}$ 时的状态 $(q_{n+1}, p_{n+1})$。\n\n1.  **自由漂移：** 对于 $t \\in (n, n+1)$，包含狄拉克δ分布的项为零。哈密顿量简化为 $H_{drift} = \\frac{p^2}{2}$。相应的哈密顿方程为：\n    $$\n    \\dot{q} = p\n    $$\n    $$\n    \\dot{p} = 0\n    $$\n    在时长为 1 的时间区间上，将这些方程从 $t=n^{+}$ 积分到 $t=(n+1)^{-}$，得到下一次踢动前的状态 $(\\tilde{q}, \\tilde{p})$：\n    $$\n    \\int_{p_n}^{\\tilde{p}} dp' = \\int_{n^{+}}^{(n+1)^{-}} 0 \\, dt' \\implies \\tilde{p} = p_n\n    $$\n    由于在此区间内 $p$ 是常数，我们有：\n    $$\n    \\int_{q_n}^{\\tilde{q}} dq' = \\int_{n^{+}}^{(n+1)^{-}} p(t') \\, dt' = \\int_{n^{+}}^{(n+1)^{-}} p_n \\, dt' = p_n \\cdot 1 \\implies \\tilde{q} = q_n + p_n\n    $$\n    因此，漂移映射（我们称之为 $D_1$）将 $(q_n, p_n)$ 变换为 $(\\tilde{q}, \\tilde{p}) = (q_n + p_n, p_n)$。\n\n2.  **踢动：** 在离散时间 $t = n+1$，踢动项起作用。我们在无穷小区间 $[(n+1)^{-}, (n+1)^{+}]$ 上对哈密顿方程进行积分。\n    对于坐标 $q$，变化量为：\n    $$\n    q_{n+1} - \\tilde{q} = \\int_{(n+1)^{-}}^{(n+1)^{+}} p(t') \\, dt'\n    $$\n    由于踢动是瞬时的，且 $p(t)$ 不包含δ函数，因此动量 $p$ 在踢动期间保持有界。因此，在无穷小时间段上的积分为零，这意味着 $q_{n+1} = \\tilde{q}$。\n    对于动量 $p$，变化量为：\n    $$\n    p_{n+1} - \\tilde{p} = \\int_{(n+1)^{-}}^{(n+1)^{+}} \\kappa \\sin(q(t')) \\delta(t' - (n+1)) \\, dt'\n    $$\n    由于 $q(t)$ 在踢动期间是连续的（$q((n+1)^{+}) = q((n+1)^{-}) = \\tilde{q}$），我们可以在 $t'=n+1$ 处计算 $\\sin(q(t'))$ 的值：\n    $$\n    p_{n+1} - \\tilde{p} = \\kappa \\sin(\\tilde{q})\n    $$\n    这得到 $p_{n+1} = \\tilde{p} + \\kappa \\sin(\\tilde{q})$。踢动映射（我们称之为 $K_{\\kappa}$）将 $(\\tilde{q}, \\tilde{p})$ 变换为 $(q_{n+1}, p_{n+1}) = (\\tilde{q}, \\tilde{p} + \\kappa \\sin(\\tilde{q}))$。\n\n3.  **庞加莱映射 $\\Phi_{\\kappa}$：** 完整的庞加莱映射是漂移和踢动的复合：$\\Phi_{\\kappa} = K_{\\kappa} \\circ D_1$。令 $(q', p') = \\Phi_{\\kappa}(q,p)$。\n    从 $(q, p)$ 开始，漂移 $D_1$ 产生 $(q+p, p)$。\n    对这个中间状态应用踢动 $K_{\\kappa}$ 得到：\n    $$\n    q' = q+p\n    $$\n    $$\n    p' = p + \\kappa \\sin(q+p)\n    $$\n    这就是庞加莱映射的显式形式，通常称为 Chirikov 标准映射。\n\n接下来，我们计算映射 $\\Phi_{\\kappa}(q,p) = (q'(q,p), p'(q,p))$ 的雅可比矩阵 $D\\Phi_{\\kappa}(q,p)$。\n$$\nD\\Phi_{\\kappa}(q,p) = \\begin{pmatrix} \\frac{\\partial q'}{\\partial q}  \\frac{\\partial q'}{\\partial p} \\\\ \\frac{\\partial p'}{\\partial q}  \\frac{\\partial p'}{\\partial p} \\end{pmatrix}\n$$\n偏导数为：\n$$\n\\frac{\\partial q'}{\\partial q} = \\frac{\\partial}{\\partial q}(q+p) = 1\n$$\n$$\n\\frac{\\partial q'}{\\partial p} = \\frac{\\partial}{\\partial p}(q+p) = 1\n$$\n$$\n\\frac{\\partial p'}{\\partial q} = \\frac{\\partial}{\\partial q}(p + \\kappa \\sin(q+p)) = \\kappa \\cos(q+p)\n$$\n$$\n\\frac{\\partial p'}{\\partial p} = \\frac{\\partial}{\\partial p}(p + \\kappa \\sin(q+p)) = 1 + \\kappa \\cos(q+p)\n$$\n所以，雅可比矩阵是：\n$$\nD\\Phi_{\\kappa}(q,p) = \\begin{pmatrix} 1  1 \\\\ \\kappa \\cos(q+p)  1 + \\kappa \\cos(q+p) \\end{pmatrix}\n$$\n现在我们可以计算其行列式：\n$$\n\\det(D\\Phi_{\\kappa}(q,p)) = (1)(1 + \\kappa \\cos(q+p)) - (1)(\\kappa \\cos(q+p))\n$$\n$$\n\\det(D\\Phi_{\\kappa}(q,p)) = 1 + \\kappa \\cos(q+p) - \\kappa \\cos(q+p) = 1\n$$\n该映射的雅可比行列式对于所有的 $(q,p)$ 和任意的 $\\kappa$ 都为 $1$。这个结果是哈密顿系统刘维尔定理的一种体现，该定理指出相空间体积在哈密顿流下是守恒的。源自哈密顿系统的映射是保面积的，这对应于雅可比行列式为1。\n\n最后，我们验证该映射是辛的。如果一个映射的雅可比矩阵 $M = D\\Phi_{\\kappa}$ 满足条件 $M^T J M = J$，其中 $J = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}$ 是正则辛矩阵，则该映射是辛的。\n雅可比矩阵的转置是：\n$$\nM^T = \\begin{pmatrix} 1  \\kappa \\cos(q+p) \\\\ 1  1 + \\kappa \\cos(q+p) \\end{pmatrix}\n$$\n我们计算乘积 $M^T J M$：\n$$\nM^T J = \\begin{pmatrix} 1  \\kappa \\cos(q+p) \\\\ 1  1 + \\kappa \\cos(q+p) \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix} = \\begin{pmatrix} -\\kappa \\cos(q+p)  1 \\\\ -1 - \\kappa \\cos(q+p)  1 \\end{pmatrix}\n$$\n$$\n(M^T J) M = \\begin{pmatrix} -\\kappa \\cos(q+p)  1 \\\\ -1 - \\kappa \\cos(q+p)  1 \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ \\kappa \\cos(q+p)  1 + \\kappa \\cos(q+p) \\end{pmatrix}\n$$\n让我们计算所得矩阵乘积的分量：\n- 元素 $(1,1)$: $(-\\kappa \\cos(q+p))(1) + (1)(\\kappa \\cos(q+p)) = 0$\n- 元素 $(1,2)$: $(-\\kappa \\cos(q+p))(1) + (1)(1 + \\kappa \\cos(q+p)) = 1$\n- 元素 $(2,1)$: $(-1 - \\kappa \\cos(q+p))(1) + (1)(\\kappa \\cos(q+p)) = -1$\n- 元素 $(2,2)$: $(-1 - \\kappa \\cos(q+p))(1) + (1)(1 + \\kappa \\cos(q+p)) = 0$\n结果是：\n$$\nM^T J M = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix} = J\n$$\n该条件得到满足，证实了庞加莱映射 $\\Phi_{\\kappa}$ 对于相空间中的所有点 $(q,p)$ 确实是一个辛变换。问题要求将雅可比行列式作为最终答案。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "在理解了混沌映射的构造之后，我们接下来探索混沌是如何产生的。在可积系统中，运动通常被分界线所限制，但当系统受到微扰时，这些结构可能会破裂。本练习将介绍强大的Melnikov方法，通过计算来确定分界线何时分裂成独立的稳定与不稳定流形，从而形成复杂的同宿缠结 ()，这是混沌动力学的标志。",
            "id": "3746857",
            "problem": "考虑一个具有周期性微扰的单自由度哈密顿系统\n$$\nH(q,p,t;\\varepsilon,\\omega,\\phi)=\\frac{1}{2}p^{2}+1-\\cos(q)+\\varepsilon\\,\\cos\\!\\left(\\frac{q}{2}\\right)\\cos\\!\\big(\\omega t+\\phi\\big),\n$$\n其中 $q\\in\\mathbb{R}$ 是构型变量，$p\\in\\mathbb{R}$ 是共轭动量，$\\varepsilon>0$ 是一个足够小的参数，$\\omega>0$ 是驱动频率，$\\phi\\in[0,2\\pi)$ 是一个相位参数。未扰动的哈密顿量 $H_{0}(q,p)=\\frac{1}{2}p^{2}+1-\\cos(q)$ 在 $(q,p)=(\\pi,0)$ 处有一个双曲平衡点，其分界线是一条同宿轨道。对于足够小的 $\\varepsilon>0$，这个双曲平衡点会延续为 $T$-周期流的一个双曲周期轨道，其中 $T=2\\pi/\\omega$。通常情况下，其稳定流形和不稳定流形发生分裂，从而产生或消灭连接到该双曲周期轨道的同宿连接。\n\n该系统具有一个标准的反演对称性，由对合 $R(q,p)=(q,-p)$ 和时间反演 $t\\mapsto -t$ 组合而成。一条关于 $R$ 对称的同宿轨道必须在某个时刻与不动点集 $\\mathrm{Fix}(R)=\\{(q,p):p=0\\}$ 相交，该时刻可选择为 $t=0$。\n\n仅从哈密顿方程、泊松括号的定义，以及基于微扰沿未扰动同宿轨道的主导阶效应的一阶分裂分析出发，确定由于对称性约束，连接到双曲周期轨道的对称同宿轨道在哪些相位参数 $\\phi\\in[0,2\\pi)$ 的值（以弧度表示）上产生或消灭。你的最终答案必须只包含 $\\phi$ 的一个或多个值；不含任何中间量或条件。不需要四舍五入；请提供精确值。",
            "solution": "用户希望找到对于一个受扰动的哈密顿系统，对称同宿轨道在哪些相位参数 $\\phi$ 的值上产生或消灭。\n\n### 第1步：问题验证\n\n问题提供了一个具有周期性微扰的单自由度哈密顿系统：\n$$\nH(q,p,t;\\varepsilon,\\omega,\\phi)=\\frac{1}{2}p^{2}+1-\\cos(q)+\\varepsilon\\,\\cos\\!\\left(\\frac{q}{2}\\right)\\cos\\!\\big(\\omega t+\\phi\\big)\n$$\n未扰动部分是 $H_0(q,p) = \\frac{1}{2}p^2 + 1-\\cos(q)$。该系统具有反演对称性 $R(q,p)=(q,-p)$ 及时间反演 $t\\mapsto -t$。问题要求基于微扰沿未扰动同宿轨道的一阶效应进行分析，以确定 $\\phi$ 的分岔值。\n\n这个问题有坚实的科学基础，根植于非线性动力学和哈密顿力学的标准理论，特别是用于检测同宿分岔的梅尔尼科夫方法（Melnikov method）。它的提法是适定的（well-posed），提供了足够的信息来进行分析。语言客观且数学上精确。其设定是一个经典的教科书示例，没有科学缺陷或矛盾，所要求的任务虽然不简单但可行。因此，该问题被认为是有效的。\n\n### 第2步：求解推导\n\n求解过程通过应用梅尔尼科夫方法来分析分界线的分裂。\n\n**2.1 未扰动系统及其同宿轨道**\n\n未扰动的哈密顿量为 $H_0(q,p) = \\frac{1}{2}p^2 + 1 - \\cos(q)$。运动方程为 $\\dot{q} = \\frac{\\partial H_0}{\\partial p} = p$ 和 $\\dot{p} = -\\frac{\\partial H_0}{\\partial q} = -\\sin(q)$。系统在 $(q,p) = ((2n+1)\\pi, 0)$（其中 $n \\in \\mathbb{Z}$）处有双曲（鞍点）平衡点。问题指定了在 $(\\pi, 0)$ 处的双曲平衡点。\n\n在此平衡点处的能量为 $H_0(\\pi, 0) = \\frac{1}{2}(0)^2 + 1 - \\cos(\\pi) = 1 - (-1) = 2$。分界线是等能面 $H_0(q,p) = 2$。\n$$\n\\frac{1}{2}p^2 + 1 - \\cos(q) = 2 \\implies \\frac{1}{2}p^2 = 1 + \\cos(q) = 2\\cos^2\\left(\\frac{q}{2}\\right).\n$$\n这给出了沿分界线的动量为 $p = \\pm 2\\cos(q/2)$。我们考虑连接鞍点 $(-\\pi,0)$ 和鞍点 $(\\pi,0)$ 的轨迹，这对应于分界线中 $p>0$ 的一个分支。$q$ 的运动方程是 $\\frac{dq}{dt} = 2\\cos(q/2)$。通过分离变量法求解此微分方程，并使用条件 $t=0$ 时 $q=0$，可得：\n$$\n\\int_0^q \\frac{d\\xi}{2\\cos(\\xi/2)} = \\int_0^t d\\tau \\implies \\left[\\ln\\left|\\sec\\left(\\frac{\\xi}{2}\\right)+\\tan\\left(\\frac{\\xi}{2}\\right)\\right|\\right]_0^q = t.\n$$\n这导出了参数化的未扰动同宿轨道（更准确地说是异宿轨道）$\\mathbf{x}_0(t) = (q_0(t), p_0(t))$：\n$$\nq_0(t) = 4\\arctan(e^t) - \\pi\n$$\n$$\np_0(t) = \\frac{dq_0}{dt} = \\frac{4e^t}{1+e^{2t}} = \\frac{2}{e^{-t}+e^t} = 2\\,\\mathrm{sech}(t)\n$$\n当 $t \\to -\\infty$ 时，该轨迹趋近于 $(-\\pi, 0)$；当 $t \\to +\\infty$ 时，趋近于 $(\\pi, 0)$。\n\n**2.2 梅尔尼科夫函数**\n\n梅尔尼科夫函数度量了受扰动的双曲周期轨道的稳定流形和不稳定流形之间的一阶有符号距离。它由未扰动哈密顿量 $H_0$ 和微扰哈密顿量 $H_1$ 的泊松括号沿未扰动同宿轨道的积分给出：\n$$\nM(t_0) = \\int_{-\\infty}^{\\infty} \\{H_0, H_1\\}(q_0(t), p_0(t), t+t_0) dt\n$$\n其中 $H_1(q,p,t) = \\cos(q/2)\\cos(\\omega t+\\phi)$。泊松括号为\n$$\n\\{H_0, H_1\\} = \\frac{\\partial H_0}{\\partial q}\\frac{\\partial H_1}{\\partial p} - \\frac{\\partial H_0}{\\partial p}\\frac{\\partial H_1}{\\partial q}\n$$\n由于 $H_1$ 与 $p$ 无关，所以 $\\frac{\\partial H_1}{\\partial p}=0$。\n$$\n\\{H_0, H_1\\} = - p \\frac{\\partial}{\\partial q}\\left[\\cos\\left(\\frac{q}{2}\\right)\\cos(\\omega \\tau + \\phi)\\right] = - p \\left[-\\frac{1}{2}\\sin\\left(\\frac{q}{2}\\right)\\cos(\\omega \\tau + \\phi)\\right] = \\frac{1}{2}p \\sin\\left(\\frac{q}{2}\\right)\\cos(\\omega \\tau + \\phi)\n$$\n其中 $\\tau$ 是时间。因此，梅尔尼科夫函数为：\n$$\nM(t_0, \\phi) = \\int_{-\\infty}^{\\infty} \\frac{1}{2} p_0(t) \\sin\\left(\\frac{q_0(t)}{2}\\right) \\cos(\\omega(t+t_0)+\\phi) dt\n$$\n我们计算涉及未扰动轨道的各项：\n$p_0(t) = 2\\,\\mathrm{sech}(t)$。\n对于 $q_0(t)/2 = 2\\arctan(e^t) - \\pi/2$，我们有 $\\sin(q_0(t)/2) = \\sin(2\\arctan(e^t) - \\pi/2) = -\\cos(2\\arctan(e^t))$。\n令 $\\theta = \\arctan(e^t)$。那么 $\\cos(2\\theta) = \\cos^2\\theta-\\sin^2\\theta = \\frac{1-e^{2t}}{1+e^{2t}} = -\\tanh(t)$。\n所以，$\\sin(q_0(t)/2) = -(-\\tanh(t)) = \\tanh(t)$。\n乘积为 $\\frac{1}{2} p_0(t) \\sin(q_0(t)/2) = \\frac{1}{2} (2\\,\\mathrm{sech}(t))(\\tanh(t)) = \\mathrm{sech}(t)\\tanh(t)$。\n这个函数是关于 $t$ 的奇函数。梅尔尼科夫积分变为：\n$$\nM(t_0, \\phi) = \\int_{-\\infty}^{\\infty} \\mathrm{sech}(t)\\tanh(t) \\cos(\\omega(t+t_0)+\\phi) dt\n$$\n展开余弦项：$\\cos(\\omega t+\\omega t_0+\\phi) = \\cos(\\omega t)\\cos(\\omega t_0+\\phi) - \\sin(\\omega t)\\sin(\\omega t_0+\\phi)$。\n由于 $\\mathrm{sech}(t)\\tanh(t)$ 是一个奇函数，它与偶函数 $\\cos(\\omega t)$ 在 $(-\\infty, \\infty)$ 上的积分为零。它与奇函数 $\\sin(\\omega t)$ 的积分非零。\n$$\nM(t_0, \\phi) = -\\sin(\\omega t_0+\\phi) \\int_{-\\infty}^{\\infty} \\mathrm{sech}(t)\\tanh(t)\\sin(\\omega t) dt\n$$\n设该积分为 $I_M = \\int_{-\\infty}^{\\infty} \\mathrm{sech}(t)\\tanh(t)\\sin(\\omega t) dt$。此积分可以通过分部积分法计算，注意到 $\\frac{d}{dt}\\mathrm{sech}(t) = -\\mathrm{sech}(t)\\tanh(t)$：\n$$\nI_M = \\int_{-\\infty}^{\\infty} \\left(-\\frac{d}{dt}\\mathrm{sech}(t)\\right)\\sin(\\omega t) dt = \\left[-\\mathrm{sech}(t)\\sin(\\omega t)\\right]_{-\\infty}^\\infty + \\int_{-\\infty}^\\infty \\mathrm{sech}(t) \\frac{d}{dt}\\sin(\\omega t) dt\n$$\n边界项为零。\n$$\nI_M = \\omega \\int_{-\\infty}^\\infty \\mathrm{sech}(t)\\cos(\\omega t) dt\n$$\n这是一个已知的傅里叶变换对：$\\int_{-\\infty}^\\infty \\mathrm{sech}(t) e^{-i\\omega t} dt = \\pi\\,\\mathrm{sech}(\\pi\\omega/2)$。取实部得到余弦变换：\n$$\nI_M = \\omega \\left(\\pi\\,\\mathrm{sech}\\left(\\frac{\\pi\\omega}{2}\\right)\\right) = \\pi\\omega\\,\\mathrm{sech}\\left(\\frac{\\pi\\omega}{2}\\right)\n$$\n由于 $\\omega > 0$，所以 $I_M > 0$。梅尔尼科夫函数为：\n$$\nM(t_0, \\phi) = -I_M \\sin(\\omega t_0+\\phi)\n$$\n\n**2.3 对称轨道的分岔条件**\n\n问题陈述了一个反演对称性 $R(q,p)=(q,-p)$ 及 $t \\mapsto -t$。如果一条同宿轨道 $\\mathbf{z}(t)=(q(t),p(t))$ 满足 $\\mathbf{z}(t)=R(\\mathbf{z}(-t))$，则称其关于 $R$ 是对称的，这意味着 $q(t)=q(-t)$（偶函数）和 $p(t)=-p(-t)$（奇函数）。这要求轨道在 $t=0$ 时穿过不动点集 $\\mathrm{Fix}(R)=\\{(q,p): p=0\\}$。\n\n对称同宿轨道的产生或消灭是一种分岔，它在梅尔尼科夫函数的特定条件下发生。对于具有给定对称性的系统，当梅尔尼科夫函数关于 $t_0$ 的偶数部分恒为零时，就会发生这种类型的分岔。\n\n我们将 $M(t_0, \\phi)$ 分解为其偶部和奇部：\n$M_e(t_0, \\phi) = \\frac{1}{2}[M(t_0, \\phi) + M(-t_0, \\phi)]$。\n$M_o(t_0, \\phi) = \\frac{1}{2}[M(t_0, \\phi) - M(-t_0, \\phi)]$。\n\n我们来计算 $M(-t_0, \\phi)$：\n$$\nM(-t_0, \\phi) = -I_M \\sin(\\omega(-t_0)+\\phi) = -I_M \\sin(\\phi-\\omega t_0)\n$$\n偶部为：\n$$\nM_e(t_0, \\phi) = \\frac{1}{2}[-I_M \\sin(\\phi+\\omega t_0) - I_M \\sin(\\phi-\\omega t_0)] = -\\frac{I_M}{2}[\\sin(\\phi+\\omega t_0) + \\sin(\\phi-\\omega t_0)]\n$$\n使用和差化积公式 $\\sin(A+B)+\\sin(A-B) = 2\\sin(A)\\cos(B)$：\n$$\nM_e(t_0, \\phi) = -\\frac{I_M}{2}[2\\sin(\\phi)\\cos(\\omega t_0)] = -I_M \\sin(\\phi) \\cos(\\omega t_0)\n$$\n当 $M_e(t_0, \\phi)$ 对所有 $t_0$ 恒为零时，产生或消灭对称轨道的分岔就会发生。\n$$\n-I_M \\sin(\\phi) \\cos(\\omega t_0) = 0 \\quad \\forall t_0\n$$\n由于 $I_M \\neq 0$ 且 $\\cos(\\omega t_0)$ 不恒为零，此条件要求：\n$$\n\\sin(\\phi) = 0\n$$\n在区间 $[0, 2\\pi)$ 内满足此条件的 $\\phi$ 值为 $\\phi=0$ 和 $\\phi=\\pi$。在这些值上，梅尔尼科夫函数变为关于 $t_0$ 的纯奇函数，这是对称同宿轨道发生叉式分岔（pitchfork bifurcation）的条件。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  \\pi \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "一旦同宿缠结形成，其中的轨道便表现出对初始条件的敏感依赖性，这是混沌的定义性特征。最后的这个练习将从解析理论转向计算实践，指导您通过编程来量化这种敏感性。通过计算标准映射的最大李雅普诺夫指数 ()，您将掌握一个量化混沌强度的实用工具，并观察其如何随系统参数变化。",
            "id": "3746886",
            "problem": "考虑二维环面上的二维保面积Chirikov标准映射，该映射由弧度角定义，是一个光滑映射 $F_{K} : \\mathbb{T}^{2} \\to \\mathbb{T}^{2}$，依赖于一个实参数 $K > 0$。二维环面 $\\mathbb{T}^{2}$ 被视为边沿认同的正方形 $[-\\pi,\\pi) \\times [-\\pi,\\pi)$。该映射作用于一个状态 $(x,y)$，其中 $x$ 和 $y$ 都被视为弧度角，并且所有迭代分量都对 $2\\pi$ 取模。\n\n您需要从几何力学和辛方法的首要原则出发：光滑映射的导数上循环的定义、保面积微分同胚的性质，以及光滑动力系统的乘法遍历定理（Oseledets定理）。利用这些，构建一个定义在 $\\mathbb{T}^{2}$ 上的 $C^{1}$ 保面积映射的最大李雅普诺夫指数的公式，并推导出对于此类映射，沿任意轨道的李雅普诺夫指数之和为零的约束。然后，聚焦于当 $K>0$ 时位于 $(x,y)=(0,0)$ 的双曲不动点，论证其稳定流形和不稳定流形如何生成一个同宿缠结，并解释为什么从 $(0,0)$ 的不稳定流形附近开始的轨道在有限时间内会自然地被限制在同宿缠结中。基于此，构建一个计算程序，以估计被限制在缠结中的轨道上的有限时间最大李雅普诺夫指数。\n\n您的程序必须以科学合理且自洽的方式实现以下任务：\n\n- 实现环面 $\\mathbb{T}^{2}$ 上的映射 $F_{K}$，确保角度变量在每次迭代后总是被环绕到 $[-\\pi,\\pi)$ 内，并且所有三角函数都以弧度解释角度。\n\n- 通过对映射关于 $(x,y)$ 求导，推导在点 $(x,y)$ 处的雅可比矩阵 $DF_{K}(x,y)$，并验证其在每一点的行列式都等于 $1$，与保面积特性一致。使用此雅可比矩阵构建沿轨道的导数上循环。\n\n- 对于 $K>0$，使用 $DF_{K}(0,0)$ 的本征结构，计算与在 $(0,0)$ 处大于 $1$ 的本征值相关联的单位不稳定本征向量。沿此不稳定方向，在距离 $(0,0)$ 很小的距离 $\\delta$（被视为弧度角位移）处初始化几个邻近的初始条件，以获得从同宿缠结的不稳定侧开始的轨道。\n\n- 定义一个限制区域，通过限制两个环绕坐标来近似 $(0,0)$ 附近的局部同宿缠结：要求 $|x| \\le r_{x}$ 和 $|y| \\le r_{y}$，其中 $x,y \\in [-\\pi,\\pi)$，$r_{x}$ 和 $r_{y}$ 是以弧度给出的正常数阈值。仅当轨道停留在此区域内时累积李雅普诺夫增长，一旦它离开该区域或达到最大迭代次数 $N_{\\max}$ 后，即停止累积。\n\n- 通过沿轨道用雅可比矩阵迭代一个切向量，在每一步进行归一化以防止溢出，并对瞬时增长率进行平均，来估计受限段上的有限时间最大李雅普诺夫指数。将多个沿不稳定本征向量的微小初始位移 $\\delta$ 的指数估计值进行平均，以减少对精确初始条件的敏感性。\n\n您的程序必须为以下参数测试套件生成有限时间最大李雅普诺夫指数的数值估计：\n$$\\{10^{-6},\\, 0.5,\\, 1.0,\\, 2.0,\\, 4.0,\\, 6.0\\}.$$\n对于每个 $K$ 值，使用沿 $(0,0)$ 处不稳定本征向量的三个初始偏移量 $\\delta \\in \\{10^{-8},\\, 5 \\cdot 10^{-8},\\, 10^{-7}\\}$ 弧度，并对结果进行平均。使用限制阈值 $r_{x} = 1.0$ 和 $r_{y} = 1.0$ 弧度，以及每个初始条件最多 $N_{\\max} = 5000$ 次迭代。所有角度都必须以弧度处理和报告，所有计算都应使用双精度浮点算术进行。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，列表用方括号括起来，结果顺序与参数测试套件的顺序相同，例如：\n$$[\\lambda(K_{1}),\\lambda(K_{2}),\\ldots,\\lambda(K_{6})],$$\n其中每个条目都是一个浮点数。除了此单行格式外，不应打印任何额外的文本、空格或单位。如果一条轨道立即（在零步内）离开限制区域，则该初始条件的指数在平均时必须视为 $0$。最终输出必须是纯浮点数，不带任何百分号或角度单位注释。",
            "solution": "该问题陈述已经过验证，被认为是有效的。它在科学上根植于已建立的哈密顿动力学和混沌理论，问题设定良好，具有清晰且可实现的计算目标，并且没有主观或模糊的语言。“Chirikov标准映射”是一个经典模型，我们将假定其标准定义。\n\n该问题要求为Chirikov标准映射构建有限时间最大李雅普诺夫指数的公式，重点关注从原点附近的双曲不动点开始的轨道。这将通过遵循几何力学和动力系统理论的原则来完成。\n\nChirikov标准映射 $F_{K} : \\mathbb{T}^{2} \\to \\mathbb{T}^{2}$ 是一个在二维环面上的离散时间动力系统，由实数 $K > 0$ 参数化。我们将环面 $\\mathbb{T}^{2}$ 与正方形 $[-\\pi, \\pi) \\times [-\\pi, \\pi)$ 等同。环面上的一个点由坐标 $(x, y)$ 表示，它们是弧度角。标准映射由以下公式给出：\n$$\n\\begin{align*}\ny_{n+1} = y_n + K \\sin(x_n) \\\\\nx_{n+1} = x_n + y_{n+1}\n\\end{align*}\n$$\n每次应用映射后，坐标被环绕以保持在区间 $[-\\pi, \\pi)$ 内。令 $p_n = (x_n, y_n)$。则映射可以写为 $p_{n+1} = F_K(p_n)$。\n\n**1. 保面积性质与辛结构**\n\n如果一个映射的雅可比矩阵的行列式为1，则该映射是保面积的。映射 $F_K$ 在点 $p=(x,y)$ 的雅可比矩阵 $DF_K(p)$ 描述了在 $p$ 处切空间中无穷小向量的线性变换。令 $p' = (x', y') = F_K(x,y)$。分量为 $y' = y + K \\sin(x)$ 和 $x' = x+y' = x + y + K \\sin(x)$。雅可比矩阵是：\n$$\nDF_K(x,y) = \\begin{pmatrix} \\frac{\\partial x'}{\\partial x}  \\frac{\\partial x'}{\\partial y} \\\\ \\frac{\\partial y'}{\\partial x}  \\frac{\\partial y'}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} 1 + K \\cos(x)  1 \\\\ K \\cos(x)  1 \\end{pmatrix}\n$$\n该矩阵的行列式是：\n$$\n\\det(DF_K(x,y)) = (1 + K \\cos(x))(1) - (1)(K \\cos(x)) = 1 + K \\cos(x) - K \\cos(x) = 1\n$$\n由于对于所有点 $(x,y)$ 和任何参数 $K$，行列式都为 $1$，因此Chirikov标准映射是一个保面积微分同胚。这是辛映射的一个关键性质，辛映射源于哈密顿系统。\n\n**2. 李雅普诺夫指数与乘法遍历定理**\n\n切向量 $v_0$ 在动力学下的演化由导数上循环控制，导数上循环是沿轨道 $\\{p_n\\}$ 的雅可比矩阵的乘积：\n$$\nDF_K^n(p_0) = DF_K(p_{n-1}) \\cdots DF_K(p_1) DF_K(p_0)\n$$\n乘法遍历定理（Oseledets定理）指出，对于几乎所有初始点 $p_0$ 和任何切向量 $v_0$，极限\n$$\n\\lambda(p_0, v_0) = \\lim_{n \\to \\infty} \\frac{1}{n} \\ln \\|DF_K^n(p_0) v_0\\|\n$$\n存在，并被称为李雅普诺夫指数。$\\lambda$ 的值仅取决于 $p_0$，而不取决于 $v_0$ 的方向（对于几乎所有 $v_0$）。对于一个 $d$ 维系统，存在 $d$ 个这样的指数。\n\n对于辛映射，李雅普诺夫指数成对出现 $(\\lambda_i, -\\lambda_i)$。由于标准映射是一个二维保面积映射，我们有两个指数，$\\lambda_1$ 和 $\\lambda_2$。辛结构保证了 $\\lambda_1 + \\lambda_2 = 0$。因此，$\\lambda_2 = -\\lambda_1$。我们将最大李雅普诺夫指数定义为 $\\lambda_{max} = \\max(\\lambda_1, \\lambda_2)$。如果 $\\lambda_{max} > 0$，轨道是混沌的，表现出对初始条件的敏感依赖性。如果 $\\lambda_{max} = 0$，轨道是规则的（周期性或准周期性的）。\n\n**3. 双曲不动点与同宿缠结**\n\n映射的不动点满足 $F_K(p) = p$。点 $(0,0)$ 对所有 $K$ 都是不动点，因为对于 $(x,y)=(0,0)$，我们有 $y' = 0 + K\\sin(0)=0$ 和 $x' = 0+0=0$。\n\n不动点的稳定性由在该点计算的雅可比矩阵 $DF_K(0,0)$ 的本征值决定。当 $\\cos(0)=1$ 时，我们有：\n$$\nDF_K(0,0) = \\begin{pmatrix} 1+K  1 \\\\ K  1 \\end{pmatrix}\n$$\n本征值 $\\lambda$ 是特征方程 $\\det(DF_K(0,0) - \\lambda I) = 0$ 的根：\n$$\n(1+K-\\lambda)(1-\\lambda) - K = 0 \\implies \\lambda^2 - (2+K)\\lambda + 1 = 0\n$$\n解为：\n$$\n\\lambda_{\\pm} = \\frac{(2+K) \\pm \\sqrt{(2+K)^2 - 4}}{2} = \\frac{2+K \\pm \\sqrt{K^2 + 4K}}{2}\n$$\n对于 $K>0$，$K^2+4K > 0$，所以本征值是实数且不相等。注意 $\\lambda_+\\lambda_- = 1$。一个本征值 $\\lambda_+ = \\frac{2+K + \\sqrt{K^2+4K}}{2}$ 大于 $1$。另一个 $\\lambda_- = \\frac{1}{\\lambda_+}$ 介于 $0$ 和 $1$ 之间。具有实数本征值，一个模大于 $1$，一个模小于 $1$ 的不动点是双曲不动点。\n\n与这些本征值相关联的是不稳定和稳定本征空间，分别由本征向量 $v_u$ 和 $v_s$ 张成。这些本征空间构成了不动点处不稳定流形 $W^u(0,0)$ 和稳定流形 $W^s(0,0)$ 的切空间。从 $W^u(0,0)$ 开始的轨道被排斥出 $(0,0)$，而 $W^s(0,0)$ 上的轨道则接近它。\n\n对于标准映射，这些流形延伸到相空间中并横截相交，形成一种称为同宿缠结的复杂结构。Smale-Birkhoff定理表明，这种缠结的存在是混沌的标志。一条从不稳定流形附近开始的轨道会沿着它被拉伸，但映射的全局折叠作用使其反复返回到原始不动点附近。这个过程将混沌运动在可能很长的时间内限制在由缠结占据的相空间区域。\n\n**4. 有限时间李雅普诺夫指数的计算程序**\n\n我们通过数值模拟沿有限轨道段的切向量演化来估计有限时间最大李雅普诺夫指数 $\\lambda_{FTLE}$。\n1.  **初始化**：对于给定的 $K$，计算 $DF_K(0,0)$ 对应于本征值 $\\lambda_+ > 1$ 的本征向量 $v_u$。将其归一化为单位向量 $\\hat{v}_u$。为了探测同宿缠结，我们在点 $p_0 = (0,0) + \\delta \\hat{v}_u$ 处初始化轨道，其中 $\\delta$ 是几个小的位移。\n2.  **轨道和切向量迭代**：我们从轨道 $p_0$ 和一个任意的初始单位切向量 $w_0$（例如 $w_0 = [1,0]^T$）开始。\n3.  **累积**：对于每一步 $n = 0, 1, 2, \\ldots, N_{max}-1$：\n    a. 检查当前点 $p_n$ 是否在由 $|x_n| \\le r_x$ 和 $|y_n| \\le r_y$ 定义的限制区域内。如果不在，则此轨道的计算终止。\n    b. 如果 $p_n$ 在限制区域内，计算归一化前的下一个切向量：$w'_{n+1} = DF_K(p_n) w_n$。\n    c. 局部扩张率是范数 $\\|w'_{n+1}\\|$。我们将其对数加到一个运行总和中：$S_{n+1} = S_n + \\ln(\\|w'_{n+1}\\|)$。\n    d. 为下一步归一化切向量：$w_{n+1} = w'_{n+1} / \\|w'_{n+1}\\|$。\n    e. 计算轨道中的下一个点：$p_{n+1} = F_K(p_n)$，确保其分量被环绕到 $[-\\pi, \\pi)$ 内。\n4.  **估计**：如果轨道在限制区域内停留了 $N_{stop}$ 步（$N_{stop} > 0$），则指数估计为 $\\lambda_{FTLE} \\approx S_{N_{stop}} / N_{stop}$。如果轨道立即离开（$N_{stop}=0$），其对平均值的贡献定义为 $0$。\n5.  **平均**：对每个 $K$，为几个初始位移 $\\delta$ 重复此过程，并平均所得的 $\\lambda_{FTLE}$ 值，以获得更稳健的估计。\n\n这个程序，在以下程序中实现，计算了限制在原点附近近似同宿缠结区域的轨道的平均有限时间最大李雅普诺夫指数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and prints the finite-time maximal Lyapunov exponent for the\n    Chirikov standard map for a suite of K parameters.\n    \"\"\"\n\n    def wrap_angle(angle):\n        \"\"\"Wraps an angle in radians to the interval [-pi, pi).\"\"\"\n        return (angle + np.pi) % (2.0 * np.pi) - np.pi\n\n    def standard_map(p, K):\n        \"\"\"\n        Applies the Chirikov standard map F_K to a point p = (x, y).\n\n        Args:\n            p (np.ndarray): A 2-element array representing the state (x, y).\n            K (float): The stochasticity parameter.\n\n        Returns:\n            np.ndarray: The next state (x_new, y_new), with components wrapped.\n        \"\"\"\n        x, y = p\n        y_new = y + K * np.sin(x)\n        x_new = x + y_new\n        return np.array([wrap_angle(x_new), wrap_angle(y_new)])\n\n    def jacobian_map(p, K):\n        \"\"\"\n        Computes the Jacobian matrix of the standard map at point p = (x, y).\n\n        Args:\n            p (np.ndarray): A 2-element array representing the state (x, y).\n            K (float): The stochasticity parameter.\n\n        Returns:\n            np.ndarray: The 2x2 Jacobian matrix.\n        \"\"\"\n        x, _ = p\n        cos_x = np.cos(x)\n        return np.array([\n            [1.0 + K * cos_x, 1.0],\n            [K * cos_x, 1.0]\n        ])\n\n    def calculate_single_orbit_lyapunov(p0, K, rx, ry, Nmax):\n        \"\"\"\n        Calculates the finite-time Lyapunov exponent for a single orbit.\n\n        Args:\n            p0 (np.ndarray): The initial condition (x0, y0).\n            K (float): The stochasticity parameter.\n            rx (float): The confinement radius for the x-coordinate.\n            ry (float): The confinement radius for the y-coordinate.\n            Nmax (int): The maximum number of iterations.\n\n        Returns:\n            float: The estimated finite-time maximal Lyapunov exponent.\n        \"\"\"\n        p = p0\n        # Initialize a random tangent vector and normalize it.\n        w = np.array([1.0, 0.0])\n        log_sum = 0.0\n        n_steps = 0\n\n        for _ in range(Nmax):\n            # Check for confinement before accumulating growth\n            if abs(p[0]) > rx or abs(p[1]) > ry:\n                break\n            \n            # Evolve the tangent vector using the Jacobian at the current point\n            J_p = jacobian_map(p, K)\n            w_next_unnormalized = J_p @ w\n\n            # Calculate the norm and add its log to the sum\n            norm_w = np.linalg.norm(w_next_unnormalized)\n            if norm_w > 0:\n                log_sum += np.log(norm_w)\n                # Normalize the vector for the next step\n                w = w_next_unnormalized / norm_w\n            else:\n                # This case is unlikely but would terminate growth\n                break\n\n            # Evolve the orbit to the next point\n            p = standard_map(p, K)\n            n_steps += 1\n\n        if n_steps > 0:\n            return log_sum / n_steps\n        else:\n            return 0.0\n\n    # Define the test parameters from the problem statement.\n    K_values = [1e-6, 0.5, 1.0, 2.0, 4.0, 6.0]\n    deltas = [1e-8, 5e-8, 1e-7]\n    rx, ry = 1.0, 1.0\n    Nmax = 5000\n\n    results = []\n    \n    # Run the simulation for each K value\n    for K in K_values:\n        k_results = []\n\n        # Find the unstable eigenvector at the origin (0,0)\n        J0 = jacobian_map(np.array([0.0, 0.0]), K)\n        eigenvalues, eigenvectors = np.linalg.eig(J0)\n        \n        # The unstable eigenvector corresponds to the eigenvalue > 1\n        # which is the largest eigenvalue for K > 0.\n        unstable_vec_idx = np.argmax(eigenvalues)\n        unstable_vec = eigenvectors[:, unstable_vec_idx].real\n\n        # Average over several initial displacements along the unstable manifold\n        for delta in deltas:\n            p0 = delta * unstable_vec\n            lyap_exponent = calculate_single_orbit_lyapunov(p0, K, rx, ry, Nmax)\n            k_results.append(lyap_exponent)\n        \n        # Average the results for the current K and store it\n        avg_lyap = np.mean(k_results)\n        results.append(avg_lyap)\n\n    # Format and print the final output exactly as specified.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}