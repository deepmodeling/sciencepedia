{
    "hands_on_practices": [
        {
            "introduction": "我们从哈密顿混沌的一个基本模型——周期性受踢转子——开始。本练习将引导你从第一性原理出发，推导其对应的庞加莱映射（即Chirikov标准映射）。此练习的核心目标是显式地验证该映射的保面积性质（辛性质），这是哈密顿系统的一个关键特征，它约束了系统的动力学行为，并且是形成同宿缠结等复杂结构的根本原因。",
            "id": "3746892",
            "problem": "考虑在正则坐标 $(q,p) \\in \\mathbb{R} \\times \\mathbb{R}$ 中的周期性受踢转子，其含时哈密顿量为\n$$\nH(q,p,t) = \\frac{p^{2}}{2} + \\kappa \\cos(q) \\sum_{n \\in \\mathbb{Z}} \\delta(t - n),\n$$\n其中 $\\kappa \\in \\mathbb{R}$ 是一个参数，$\\delta(\\cdot)$ 是狄拉克δ分布。令 $\\Phi_{\\kappa}$表示将状态从一次踢之后推进到下一次踢之后的庞加莱映射（即周期为 $1$ 的频闪采样）。在正则坐标下使用正则辛矩阵\n$$\nJ = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}.\n$$\n从哈密顿方程和庞加莱映射的定义出发，推导出 $\\Phi_{\\kappa}$ 作为单位时间内一次踢和一次漂移复合的显式形式，计算其在任意点 $(q,p)$ 的雅可比矩阵 $D\\Phi_{\\kappa}(q,p)$，并确定其雅可比行列式。然后通过对所有 $(q,p)$ 检验条件 $D\\Phi_{\\kappa}(q,p)^{T} J \\, D\\Phi_{\\kappa}(q,p) = J$ 来验证其辛性。\n\n将雅可比行列式 $\\det(D\\Phi_{\\kappa}(q,p))$ 的值作为你的最终答案，以最简形式的单个封闭解析表达式给出。不需要数值四舍五入，也不涉及单位。",
            "solution": "该问题要求推导和分析周期性受踢转子的庞加莱映射，这是哈密顿动力学中的一个典型模型。我们将验证问题设置，推导该映射，计算其雅可比矩阵，并验证其辛性。\n\n首先，我们从给定的含时哈密顿量开始：\n$$\nH(q,p,t) = \\frac{p^{2}}{2} + \\kappa \\cos(q) \\sum_{n \\in \\mathbb{Z}} \\delta(t - n)\n$$\n系统的动力学由哈密顿方程决定：\n$$\n\\dot{q} = \\frac{\\partial H}{\\partial p} \\quad \\text{和} \\quad \\dot{p} = -\\frac{\\partial H}{\\partial q}\n$$\n代入哈密顿量，我们得到：\n$$\n\\dot{q} = p\n$$\n$$\n\\dot{p} = \\kappa \\sin(q) \\sum_{n \\in \\mathbb{Z}} \\delta(t - n)\n$$\n庞加莱映射 $\\Phi_{\\kappa}$ 将状态 $(q,p)$ 从时间 $t = n^{+}$（第 $n$ 次踢之后）推进到 $t = (n+1)^{+}$（第 $(n+1)$ 次踢之后）。在一个时间周期 $t \\in [n^{+}, (n+1)^{+}]$ 内的演化包含两个不同部分：在 $t \\in (n, n+1)$ 期间的“自由漂移”和在 $t = n+1$ 时的瞬时“踢”。\n\n设 $(q_n, p_n)$ 为 $t=n^{+}$ 时的状态。我们将跟踪其演化以求得 $t=(n+1)^{+}$ 时的状态 $(q_{n+1}, p_{n+1})$。\n\n1.  **自由漂移：** 对于 $t \\in (n, n+1)$，包含狄拉克δ分布的项消失。哈密顿量简化为 $H_{drift} = \\frac{p^2}{2}$。相应的哈密顿方程为：\n    $$\n    \\dot{q} = p\n    $$\n    $$\n    \\dot{p} = 0\n    $$\n    将这些方程在时长为 $1$ 的时间区间上从 $t=n^{+}$ 积分到 $t=(n+1)^{-}$，得到下一次踢之前的状态 $(\\tilde{q}, \\tilde{p})$：\n    $$\n    \\int_{p_n}^{\\tilde{p}} dp' = \\int_{n^{+}}^{(n+1)^{-}} 0 \\, dt' \\implies \\tilde{p} = p_n\n    $$\n    由于在此区间内 $p$ 是常数，我们有：\n    $$\n    \\int_{q_n}^{\\tilde{q}} dq' = \\int_{n^{+}}^{(n+1)^{-}} p(t') \\, dt' = \\int_{n^{+}}^{(n+1)^{-}} p_n \\, dt' = p_n \\cdot 1 \\implies \\tilde{q} = q_n + p_n\n    $$\n    因此，漂移映射（我们称之为 $D_1$）将 $(q_n, p_n)$ 变换为 $(\\tilde{q}, \\tilde{p}) = (q_n + p_n, p_n)$。\n\n2.  **踢：** 在离散时间 $t = n+1$ 时，踢项起作用。我们在无穷小区间 $[(n+1)^{-}, (n+1)^{+}]$ 上对哈密顿方程进行积分。\n    对于坐标 $q$，其变化为：\n    $$\n    q_{n+1} - \\tilde{q} = \\int_{(n+1)^{-}}^{(n+1)^{+}} p(t') \\, dt'\n    $$\n    由于踢是瞬时的，且 $p(t)$ 不包含δ函数，因此动量 $p$ 在踢的过程中保持有界。所以，在无穷小时间段上的积分消失，这意味着 $q_{n+1} = \\tilde{q}$。\n    对于动量 $p$，其变化为：\n    $$\n    p_{n+1} - \\tilde{p} = \\int_{(n+1)^{-}}^{(n+1)^{+}} \\kappa \\sin(q(t')) \\delta(t' - (n+1)) \\, dt'\n    $$\n    由于 $q(t)$ 在踢的过程中是连续的（$q((n+1)^{+}) = q((n+1)^{-}) = \\tilde{q}$），我们可以在 $t'=n+1$ 处计算 $\\sin(q(t'))$ 的值：\n    $$\n    p_{n+1} - \\tilde{p} = \\kappa \\sin(\\tilde{q})\n    $$\n    这得到 $p_{n+1} = \\tilde{p} + \\kappa \\sin(\\tilde{q})$。踢映射（我们称之为 $K_{\\kappa}$）将 $(\\tilde{q}, \\tilde{p})$ 变换为 $(q_{n+1}, p_{n+1}) = (\\tilde{q}, \\tilde{p} + \\kappa \\sin(\\tilde{q}))$。\n\n3.  **庞加莱映射 $\\Phi_{\\kappa}$：** 完整的庞加莱映射是漂移和踢的复合：$\\Phi_{\\kappa} = K_{\\kappa} \\circ D_1$。令 $(q', p') = \\Phi_{\\kappa}(q,p)$。\n    从 $(q, p)$ 开始，漂移 $D_1$ 得到 $(q+p, p)$。\n    对这个中间状态应用踢 $K_{\\kappa}$ 得到：\n    $$\n    q' = q+p\n    $$\n    $$\n    p' = p + \\kappa \\sin(q+p)\n    $$\n    这就是庞加莱映射的显式形式，通常称为Chirikov标准映射。\n\n接下来，我们计算映射 $\\Phi_{\\kappa}(q,p) = (q'(q,p), p'(q,p))$ 的雅可比矩阵 $D\\Phi_{\\kappa}(q,p)$。\n$$\nD\\Phi_{\\kappa}(q,p) = \\begin{pmatrix} \\frac{\\partial q'}{\\partial q} & \\frac{\\partial q'}{\\partial p} \\\\ \\frac{\\partial p'}{\\partial q} & \\frac{\\partial p'}{\\partial p} \\end{pmatrix}\n$$\n偏导数如下：\n$$\n\\frac{\\partial q'}{\\partial q} = \\frac{\\partial}{\\partial q}(q+p) = 1\n$$\n$$\n\\frac{\\partial q'}{\\partial p} = \\frac{\\partial}{\\partial p}(q+p) = 1\n$$\n$$\n\\frac{\\partial p'}{\\partial q} = \\frac{\\partial}{\\partial q}(p + \\kappa \\sin(q+p)) = \\kappa \\cos(q+p)\n$$\n$$\n\\frac{\\partial p'}{\\partial p} = \\frac{\\partial}{\\partial p}(p + \\kappa \\sin(q+p)) = 1 + \\kappa \\cos(q+p)\n$$\n所以，雅可比矩阵是：\n$$\nD\\Phi_{\\kappa}(q,p) = \\begin{pmatrix} 1 & 1 \\\\ \\kappa \\cos(q+p) & 1 + \\kappa \\cos(q+p) \\end{pmatrix}\n$$\n我们现在可以计算其行列式：\n$$\n\\det(D\\Phi_{\\kappa}(q,p)) = (1)(1 + \\kappa \\cos(q+p)) - (1)(\\kappa \\cos(q+p))\n$$\n$$\n\\det(D\\Phi_{\\kappa}(q,p)) = 1 + \\kappa \\cos(q+p) - \\kappa \\cos(q+p) = 1\n$$\n对于所有的 $(q,p)$ 和任意 $\\kappa$，该映射的雅可比行列式都为 $1$。这个结果是哈密顿系统刘维尔定理的一种体现，该定理指出相空间体积在哈密顿流下是守恒的。由哈密顿系统导出的映射是保面积的，这对应于雅可比行列式为1。\n\n最后，我们验证该映射是辛的。如果一个映射的雅可比矩阵 $M = D\\Phi_{\\kappa}$ 满足条件 $M^T J M = J$，那么该映射就是辛的，其中 $J = \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix}$ 是正则辛矩阵。\n雅可比矩阵的转置是：\n$$\nM^T = \\begin{pmatrix} 1 & \\kappa \\cos(q+p) \\\\ 1 & 1 + \\kappa \\cos(q+p) \\end{pmatrix}\n$$\n我们计算乘积 $M^T J M$：\n$$\nM^T J = \\begin{pmatrix} 1 & \\kappa \\cos(q+p) \\\\ 1 & 1 + \\kappa \\cos(q+p) \\end{pmatrix} \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix} = \\begin{pmatrix} -\\kappa \\cos(q+p) & 1 \\\\ -1 - \\kappa \\cos(q+p) & 1 \\end{pmatrix}\n$$\n$$\n(M^T J) M = \\begin{pmatrix} -\\kappa \\cos(q+p) & 1 \\\\ -1 - \\kappa \\cos(q+p) & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 1 \\\\ \\kappa \\cos(q+p) & 1 + \\kappa \\cos(q+p) \\end{pmatrix}\n$$\n我们来计算所得矩阵乘积的各个分量：\n- 元素 $(1,1)$: $(-\\kappa \\cos(q+p))(1) + (1)(\\kappa \\cos(q+p)) = 0$\n- 元素 $(1,2)$: $(-\\kappa \\cos(q+p))(1) + (1)(1 + \\kappa \\cos(q+p)) = 1$\n- 元素 $(2,1)$: $(-1 - \\kappa \\cos(q+p))(1) + (1)(\\kappa \\cos(q+p)) = -1$\n- 元素 $(2,2)$: $(-1 - \\kappa \\cos(q+p))(1) + (1)(1 + \\kappa \\cos(q+p)) = 0$\n结果是：\n$$\nM^T J M = \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix} = J\n$$\n该条件得到满足，证实了庞加莱映射 $\\Phi_{\\kappa}$ 对于相空间中的所有点 $(q,p)$ 确实是一个辛变换。问题要求将雅可比行列式作为最终答案。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "在理解了辛映射的基础上，本练习将深入探讨一个关键现象：二次同宿切。你将推导一个局部正规形式映射，该映射描述了这些切点在参数变化下的展开方式。此分析将揭示稳定椭圆不动点——以及其周围的规则运动“岛屿”——是如何从该切点中诞生的，这是保守系统中Newhouse现象的一个标志性特征。",
            "id": "3746883",
            "problem": "考虑一个二维辛流形上的光滑双参数 $C^{r}$ ($r \\geq 3$) 辛微分同胚族 $F_{\\alpha,\\beta}$，该流形具有局部 Darboux 坐标 $(x,y)$，其辛形式为 $dx \\wedge dy$。假设在 $(\\alpha,\\beta)=(2,0)$ 时，映射 $F_{\\alpha,\\beta}$ 有一个双曲不动点，其同宿轨道表现出稳定流形与不稳定流形的二次切触。关于 $(\\alpha,\\beta)$ 的展开是泛函的，即对于邻近的参数，同宿切触持续存在为横截相交，且主阶分裂由参数 $(\\alpha,\\beta)$ 控制。\n\n仅使用辛结构、适应于同宿几何的局部典范坐标以及与辛性一致的泰勒展开，执行以下步骤：\n\n1. 在切触点的一个小邻域内，为首次返回映射推导一个主阶范式，该范式能捕捉此辛背景下同宿相交的泛函二次展开。证明经过对 $(x,y)$ 的适当重标度和对 $(\\alpha,\\beta)$ 的重参数化后，该局部模型可以写成保面积二次形式\n$$\nT_{\\alpha,\\beta}(x,y) \\;=\\; \\big(y,\\, \\beta + \\alpha\\, y - x + y^{2}\\big).\n$$\n\n2. 确定从同宿切触分岔出的 $T_{\\alpha,\\beta}$ 的不动点，并计算这些不动点的线性化。利用保面积映射的椭圆性迹条件，确定使这些不动点成为椭圆点（即，它们具有单位圆上的复共轭乘子，抛物情形除外）的参数 $(\\alpha,\\beta)$ 需满足的条件。\n\n3. 椭圆不动点产生了局部不变曲线和岛链，这些是保守（保面积）动力学中 Newhouse 现象的特征。对于固定的 $\\alpha$ 值，$\\beta$ 参数中的椭圆区域由不动点变为抛物点的曲线所界定。计算使得不动点为椭圆点的 $\\beta$-区间的宽度（作为一个实数），表示为 $\\alpha$ 的函数，然后给出其值。\n\n你的最终答案必须是对于任何固定的 $\\alpha$，椭圆区间的 $\\beta$-参数宽度的值，表示为一个无单位的实数。无需四舍五入。",
            "solution": "我们从一个曲面上的双参数辛微分同胚族 $F_{\\alpha,\\beta}$ 开始，该曲面具有局部 Darboux 坐标 $(x,y)$，因此辛形式为 $dx \\wedge dy$。辛性意味着面积保持，并且任何局部表示的雅可比行列式都为 $1$。同宿切触是二次的，意味着稳定流形和不稳定流形的局部图像以二阶接触的方式相遇。可以在同宿轨道穿过的一个小矩形上构造一个切触点附近的 Poincaré 首次返回映射，通过选择适应的典范坐标，可以通过一个降维的二维映射捕捉到展开的主要机制。\n\n步骤1：辛约束下的范式推导。\n\n在局部典范坐标中，同宿切触附近的首次返回映射允许一个与辛性和同宿几何一致的泰勒展开。泛函结构包括坐标之间的“翻转”（反映了沿稳定和不稳定方向的移动）以及与切触对应的坐标中的最低阶二次非线性项。与辛性和几何一致的一般二次拟设为\n$$\n\\widetilde{T}_{\\alpha,\\beta}(x,y) \\;=\\; \\big( y + \\mathcal{O}(2),\\; \\beta + \\alpha\\, y - x + a\\, y^{2} + \\mathcal{O}(3) \\big),\n$$\n其中 $\\alpha$ 和 $\\beta$ 是展开参数：$\\beta$ 度量稳定流形和不稳定流形的主阶法向位移（一个有向距离），而 $\\alpha$ 度量分裂中的线性阶剪切（一阶角度变化）。$\\mathcal{O}(2)$ 和 $\\mathcal{O}(3)$ 表示 $(x,y)$ 的高阶项。\n\n取主阶项，我们舍去高阶项得到\n$$\n\\widehat{T}_{\\alpha,\\beta}(x,y) \\;=\\; \\big(y,\\; \\beta + \\alpha\\, y - x + a\\, y^{2}\\big).\n$$\n$\\widehat{T}_{\\alpha,\\beta}$ 的雅可比矩阵为\n$$\nD\\widehat{T}_{\\alpha,\\beta}(x,y) \\;=\\; \\begin{pmatrix}\n0 & 1 \\\\\n-1 & \\alpha + 2 a\\, y\n\\end{pmatrix},\n$$\n其行列式为 $1$，与 $(x,y)$ 无关，因此对于任何 $a$，该映射都是保面积的。通过一个简单的辛标度变换 $(x,y) \\mapsto (\\lambda x, \\lambda y)$，再结合一个重参数化 $(\\alpha,\\beta) \\mapsto (\\alpha',\\beta')$，我们可以将二次项系数归一化为 $a=1$，而不改变面积保持性或定性展开。具体来说，选择 $\\lambda = \\sqrt{|a|}$ 并将常数吸收到 $(\\alpha',\\beta')$ 中，以获得典范保面积二次范式\n$$\nT_{\\alpha,\\beta}(x,y) \\;=\\; \\big(y,\\; \\beta + \\alpha\\, y - x + y^{2}\\big),\n$$\n这里我们将 $(\\alpha',\\beta')$ 重新标记为 $(\\alpha,\\beta)$。\n\n步骤2：不动点和椭圆性条件。\n\n不动点 $(x,y)$ 满足 $T_{\\alpha,\\beta}(x,y) = (x,y)$，这得到方程组\n$$\ny = x,\\qquad \\beta + \\alpha\\, y - x + y^{2} = y.\n$$\n代入 $y=x$，我们得到一个关于 $x$ 的标量二次方程：\n$$\n\\beta + \\alpha\\, x - x + x^{2} = x \\quad \\Longrightarrow \\quad x^{2} + (\\alpha - 2)\\, x + \\beta = 0.\n$$\n因此，不动点（当为实数时）为\n$$\nx_{\\pm} \\;=\\; \\frac{2 - \\alpha \\pm \\sqrt{\\Delta}}{2}, \\qquad \\text{其中} \\quad \\Delta \\;=\\; (\\alpha - 2)^{2} - 4\\,\\beta,\n$$\n且 $y_{\\pm} = x_{\\pm}$。在 $(x,y) = (x_{\\pm},x_{\\pm})$ 处的雅可比矩阵是\n$$\nDT_{\\alpha,\\beta}(x_{\\pm},x_{\\pm}) \\;=\\; \\begin{pmatrix}\n0 & 1 \\\\\n-1 & \\alpha + 2 x_{\\pm}\n\\end{pmatrix}.\n$$\n对于一个行列式为 $1$ 的保面积映射，其乘子 $\\lambda$ 满足 $\\lambda \\cdot \\lambda^{-1} = 1$，且迹 $\\tau$ 为\n$$\n\\tau \\;=\\; \\operatorname{tr}\\big(DT_{\\alpha,\\beta}(x_{\\pm},x_{\\pm})\\big) \\;=\\; \\alpha + 2 x_{\\pm}.\n$$\n一个不动点是椭圆的，当且仅当其特征值是单位圆上的复共轭对，这对于行列式为 $1$ 的 $2 \\times 2$ 实矩阵而言，当且仅当 $|\\tau| < 2$ 时发生（不包括抛物边界情形 $|\\tau|=2$）。代入 $x_{\\pm}$，我们发现\n$$\n\\tau_{\\pm} \\;=\\; \\alpha + 2\\left(\\frac{2 - \\alpha \\pm \\sqrt{\\Delta}}{2}\\right) \\;=\\; \\alpha + (2 - \\alpha) \\pm \\sqrt{\\Delta} \\;=\\; 2 \\pm \\sqrt{\\Delta}.\n$$\n因此：\n- 带 $+$ 的分支有 $\\tau_{+} = 2 + \\sqrt{\\Delta} \\geq 2$，绝不是椭圆的（在 $\\Delta=0$ 时是抛物的，否则是双曲的）。\n- 带 $-$ 的分支有 $\\tau_{-} = 2 - \\sqrt{\\Delta}$，它是椭圆的当且仅当\n$$\n|\\tau_{-}| \\;=\\; |\\,2 - \\sqrt{\\Delta}\\,| \\;<\\; 2 \\quad \\Longleftrightarrow \\quad 0 \\;<\\; \\sqrt{\\Delta} \\;<\\; 4 \\quad \\Longleftrightarrow \\quad 0 \\;<\\; \\Delta \\;<\\; 16.\n$$\n此外，不动点为实数当且仅当 $\\Delta \\geq 0$。综合这些条件，椭圆不动点存在的条件恰好是\n$$\n0 \\;<\\; \\Delta \\;=\\; (\\alpha - 2)^{2} - 4\\,\\beta \\;<\\; 16.\n$$\n对于每个固定的 $\\alpha$，这些不等式在 $\\beta$ 中定义了一个区间，在此区间内，“-”分支上唯一的实不动点是椭圆的。\n\n步骤3：对于固定的 $\\alpha$，$\\beta$ 中椭圆区间的边界和宽度。\n\n对于一个固定的 $\\alpha$，$\\beta$ 中椭圆区间的边界出现在抛物阈值 $\\Delta = 0$ 和 $\\Delta = 16$ 处。解出 $\\beta$ 可得：\n- 上边界（抛物情形，$\\tau=2$）： $\\Delta = 0 \\Rightarrow (\\alpha - 2)^{2} - 4\\,\\beta = 0 \\Rightarrow \\beta_{\\mathrm{upper}} = \\dfrac{(\\alpha - 2)^{2}}{4}$。\n- 下边界（“－”分支上的抛物情形，$\\tau=-2$）： $\\Delta = 16 \\Rightarrow (\\alpha - 2)^{2} - 4\\,\\beta = 16 \\Rightarrow \\beta_{\\mathrm{lower}} = \\dfrac{(\\alpha - 2)^{2} - 16}{4}$。\n\n对于固定的 $\\alpha$，$\\beta$ 中椭圆区间的宽度是\n$$\nW(\\alpha) \\;=\\; \\beta_{\\mathrm{upper}} - \\beta_{\\mathrm{lower}} \\;=\\; \\frac{(\\alpha - 2)^{2}}{4} \\;-\\; \\frac{(\\alpha - 2)^{2} - 16}{4} \\;=\\; \\frac{16}{4} \\;=\\; 4.\n$$\n这个宽度与 $\\alpha$ 无关。因此，对于任何固定的 $\\alpha$，在辛展开中由二次同宿切触产生的椭圆不动点所对应的 $\\beta$ 参数区间，其宽度等于 $4$。\n\n这个椭圆区间是保守 Newhouse 现象的局部特征：在此区间内，椭圆不动点生成了环绕它的不变曲线和共振岛链，这些结构累积并组织了同宿缠结，导致了复杂的、散布着稳定岛的混沌动力学。\n\n因此，所求宽度是常实数 $4$。",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "在探究了混沌动力学的几何起源和结构之后，这最后一个练习提供了一个计算工具来量化其强度。本练习要求你实现标准映射，并编写一个数值算法来估算同宿缠结内轨道的最大李雅普诺夫指数。这项实践将抽象的几何理论与对初始条件敏感依赖性（混沌的标志）的实际测量联系起来。",
            "id": "3746886",
            "problem": "考虑二维环面上的二维保面积 Chirikov 标准映射，该映射由一个光滑映射 $F_{K} : \\mathbb{T}^{2} \\to \\mathbb{T}^{2}$ 给出，依赖于一个实数参数 $K > 0$，其中角度以弧度为单位。二维环面 $\\mathbb{T}^{2}$ 等同于边沿进行了等同识别的正方形 $[-\\pi,\\pi) \\times [-\\pi,\\pi)$。该映射作用于一个状态 $(x,y)$，其中 $x$ 和 $y$ 都被视为以弧度为单位的角度，并且所有迭代在两个分量上都对 $2\\pi$ 取模。\n\n您需要从几何力学和辛方法的基本原理出发：光滑映射的导数上循环的定义、保面积微分同胚的性质以及光滑动力系统的乘法遍历定理（Oseledets 定理）。利用这些原理，阐述在 $\\mathbb{T}^{2}$ 上的 $C^{1}$ 保面积映射的最大李雅普诺夫指数的定义，并推导出对于此类映射，沿任意轨道的李雅普诺夫指数之和为零的约束。然后，重点关注当 $K>0$ 时位于 $(x,y)=(0,0)$ 的双曲不动点，论证其稳定流形和不稳定流形如何生成一个同宿缠结，并解释为什么在 $(0,0)$ 的不稳定流形附近起始的轨道，在有限时间内自然地被限制在同宿缠结中。基于此，构建一个计算程序来估计限制在缠结内的轨道的有限时间最大李雅普诺夫指数。\n\n您的程序必须以科学上合理且自洽的方式实现以下任务：\n\n- 实现二维环面 $\\mathbb{T}^{2}$ 上的映射 $F_{K}$，确保角度变量在每次迭代后总是被包裹到 $[-\\pi,\\pi)$ 区间内，并且所有三角函数都将角度解释为弧度。\n\n- 通过对映射关于 $(x,y)$ 求导，推导出映射在点 $(x,y)$ 处的雅可比矩阵 $DF_{K}(x,y)$，并验证其行列式在每一点都等于 $1$，这与保面积性质一致。使用此雅可比矩阵来构建沿轨道的导数上循环。\n\n- 利用 $DF_{K}(0,0)$ 的特征结构，计算当 $K>0$ 时与大于 $1$ 的特征值相关联的单位不稳定特征向量。沿此不稳定方向，在距离 $(0,0)$ 很小的位移 $\\delta$（视为以弧度为单位的角度位移）处初始化几个邻近的初始条件，以获得从同宿缠结的不稳定侧开始的轨道。\n\n- 定义一个限制区域，通过限制两个包裹后的坐标来近似 $(0,0)$ 附近的局部同宿缠结：要求 $|x| \\le r_{x}$ 且 $|y| \\le r_{y}$，其中 $x,y \\in [-\\pi,\\pi)$，$r_{x}$ 和 $r_{y}$ 是以弧度为单位的正阈值。仅当轨道停留在此区域内时才累积李雅普诺夫增长，一旦离开该区域或达到最大迭代次数 $N_{\\max}$ 后就停止累积。\n\n- 通过沿轨道的雅可比矩阵迭代一个切向量，在每一步进行归一化以防止溢出，并平均瞬时增长率，来估计沿受限轨道段的有限时间最大李雅普诺夫指数。对沿不稳定特征向量的几个小的初始位移 $\\delta$ 的指数估计值进行平均，以减少对精确初始条件的敏感性。\n\n您的程序必须为以下参数测试套件生成数值估计：\n$$\\{10^{-6},\\, 0.5,\\, 1.0,\\, 2.0,\\, 4.0,\\, 6.0\\}.$$\n在 $(0,0)$ 处沿不稳定特征向量使用三个初始偏移量 $\\delta \\in \\{10^{-8},\\, 5 \\cdot 10^{-8},\\, 10^{-7}\\}$ 弧度，并对每个 $K$ 的结果进行平均。使用限制阈值 $r_{x} = 1.0$ 和 $r_{y} = 1.0$ 弧度，以及每个初始条件最多迭代 $N_{\\max} = 5000$ 次。所有角度都必须以弧度处理和报告，所有计算都应使用双精度浮点运算进行。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，顺序与参数测试套件相同，例如：\n$$[\\lambda(K_{1}),\\lambda(K_{2}),\\ldots,\\lambda(K_{6})],$$\n其中每个条目都是一个浮点数。除了这种单行格式外，不应打印任何额外的文本、空格或单位。如果轨道立即（在零步内）离开限制区域，则出于平均目的，该初始条件的指数必须视为 $0$。最终输出必须是纯浮点数，不带任何百分号或角度单位注释。",
            "solution": "问题陈述已经过验证，被认为是有效的。其科学基础扎根于哈密顿动力学和混沌的既定理论，问题提法清晰，具有明确且可实现的计算目标，并且没有主观或模糊的语言。“Chirikov 标准映射”是一个经典模型，我们将采用其标准定义。\n\n该问题要求为 Chirikov 标准映射表述有限时间最大李雅普诺夫指数，重点关注在原点处的双曲不动点附近起始的轨道。这将通过遵循几何力学和动力系统理论的原理来完成。\n\nChirikov 标准映射 $F_{K} : \\mathbb{T}^{2} \\to \\mathbb{T}^{2}$ 是一个二维环面上的离散时间动力系统，由一个实数 $K > 0$ 参数化。我们将环面 $\\mathbb{T}^{2}$ 等同于正方形 $[-\\pi, \\pi) \\times [-\\pi, \\pi)$。环面上的一个点由坐标 $(x, y)$ 表示，它们是弧度单位的角度。标准映射由以下公式给出：\n$$\n\\begin{align*}\ny_{n+1} = y_n + K \\sin(x_n) \\\\\nx_{n+1} = x_n + y_{n+1}\n\\end{align*}\n$$\n每次应用映射后，坐标都会被包裹以保持在区间 $[-\\pi, \\pi)$ 内。令 $p_n = (x_n, y_n)$。则该映射可以写为 $p_{n+1} = F_K(p_n)$。\n\n**1. 保面积性质与辛结构**\n\n如果一个映射的雅可比矩阵的行列式为 1，则该映射是保面积的。映射 $F_K$ 在点 $p=(x,y)$ 处的雅可比矩阵 $DF_K(p)$ 描述了在 $p$ 点切空间中无穷小向量的线性变换。令 $p' = (x', y') = F_K(x,y)$。其分量为 $y' = y + K \\sin(x)$ 和 $x' = x+y' = x + y + K \\sin(x)$。雅可比矩阵是：\n$$\nDF_K(x,y) = \\begin{pmatrix} 1 + K \\cos(x) & 1 \\\\ K \\cos(x) & 1 \\end{pmatrix}\n$$\n该矩阵的行列式为：\n$$\n\\det(DF_K(x,y)) = (1 + K \\cos(x))(1) - (1)(K \\cos(x)) = 1 + K \\cos(x) - K \\cos(x) = 1\n$$\n由于对于所有点 $(x,y)$ 和任何参数 $K$，行列式都为 $1$，因此 Chirikov 标准映射是一个保面积微分同胚。这是辛映射的一个关键性质，辛映射源于哈密顿系统。\n\n**2. 李雅普诺夫指数与乘法遍历定理**\n\n一个切向量 $v_0$ 在动力学下的演化由导数上循环决定，导数上循环是沿轨道 $\\{p_n\\}$ 的雅可比矩阵的乘积：\n$$\nDF_K^n(p_0) = DF_K(p_{n-1}) \\cdots DF_K(p_1) DF_K(p_0)\n$$\n乘法遍历定理（Oseledets 定理）指出，对于几乎所有的初始点 $p_0$ 和任意切向量 $v_0$，极限\n$$\n\\lambda(p_0, v_0) = \\lim_{n \\to \\infty} \\frac{1}{n} \\ln \\|DF_K^n(p_0) v_0\\|\n$$\n存在，并被称为李雅普诺夫指数。$\\lambda$ 的值仅取决于 $p_0$，而与 $v_0$ 的方向无关（对于几乎所有的 $v_0$）。对于一个 $d$ 维系统，存在 $d$ 个这样的指数。\n\n对于辛映射，李雅普诺夫指数成对出现 $(\\lambda_i, -\\lambda_i)$。由于标准映射是二维保面积映射，我们有两个指数 $\\lambda_1$ 和 $\\lambda_2$。辛结构确保了 $\\lambda_1 + \\lambda_2 = 0$。因此，$\\lambda_2 = -\\lambda_1$。我们将最大李雅普诺夫指数定义为 $\\lambda_{max} = \\max(\\lambda_1, \\lambda_2)$。如果 $\\lambda_{max} > 0$，轨道是混沌的，表现出对初始条件的敏感依赖性。如果 $\\lambda_{max} = 0$，轨道是规则的（周期性或准周期性的）。\n\n**3. 双曲不动点与同宿缠结**\n\n映射的不动点满足 $F_K(p) = p$。点 $(0,0)$ 对所有 $K$ 都是一个不动点，因为对于 $(x,y)=(0,0)$，我们有 $y' = 0 + K\\sin(0)=0$ 和 $x' = 0+0=0$。\n\n不动点的稳定性由在该点计算的雅可比矩阵 $DF_K(0,0)$ 的特征值决定。当 $\\cos(0)=1$ 时，我们有：\n$$\nDF_K(0,0) = \\begin{pmatrix} 1+K & 1 \\\\ K & 1 \\end{pmatrix}\n$$\n特征值 $\\lambda$ 是特征方程 $\\det(DF_K(0,0) - \\lambda I) = 0$ 的根：\n$$\n(1+K-\\lambda)(1-\\lambda) - K = 0 \\implies \\lambda^2 - (2+K)\\lambda + 1 = 0\n$$\n解为：\n$$\n\\lambda_{\\pm} = \\frac{(2+K) \\pm \\sqrt{(2+K)^2 - 4}}{2} = \\frac{2+K \\pm \\sqrt{K^2 + 4K}}{2}\n$$\n对于 $K>0$，$K^2+4K > 0$，因此特征值是实数且不相等。注意到 $\\lambda_+\\lambda_- = 1$。一个特征值 $\\lambda_+ = \\frac{2+K + \\sqrt{K^2+4K}}{2}$ 大于 $1$。另一个 $\\lambda_- = \\frac{1}{\\lambda_+}$ 在 $0$ 和 $1$ 之间。一个具有实特征值，其中一个的模大于 $1$，另一个的模小于 $1$ 的不动点，是一个双曲不动点。\n\n与这些特征值相关联的是不稳定和稳定特征空间，分别由特征向量 $v_u$ 和 $v_s$ 张成。这些特征空间构成了不动点处不稳定流形 $W^u(0,0)$ 和稳定流形 $W^s(0,0)$ 的切空间。在 $W^u(0,0)$ 上开始的轨道被排斥出 $(0,0)$，而在 $W^s(0,0)$ 上的轨道则趋近它。\n\n对于标准映射，这些流形延伸到相空间中并横截相交，形成一个被称为同宿缠结的复杂结构。Smale-Birkhoff 定理意味着这种缠结的存在是混沌的一个标志。在不稳定流形附近起始的轨道会沿着它被拉伸，但映射的全局折叠作用使其反复返回到原始不动点附近。这个过程将混沌运动限制在由缠结占据的相空间区域内，可能会持续很长时间。\n\n**4. 有限时间李雅普诺夫指数的计算程序**\n\n我们通过数值模拟一个切向量沿有限轨道段的演化来估计有限时间最大李雅普诺夫指数 $\\lambda_{FTLE}$。\n1.  **初始化**：对于给定的 $K$，计算 $DF_K(0,0)$ 对应于特征值 $\\lambda_+ > 1$ 的特征向量 $v_u$。将其归一化为单位向量 $\\hat{v}_u$。为了探测同宿缠结，我们在几个小的位移 $\\delta$ 处，在点 $p_0 = (0,0) + \\delta \\hat{v}_u$ 初始化轨道。\n2.  **轨道和切向量迭代**：我们从 $p_0$ 处的一条轨道和一个任意的初始单位切向量 $w_0$（例如 $w_0 = [1,0]^T$）开始。\n3.  **累积**：对于每一步 $n = 0, 1, 2, \\ldots, N_{max}-1$：\n    a. 检查当前点 $p_n$ 是否在由 $|x_n| \\le r_x$ 和 $|y_n| \\le r_y$ 定义的限制区域内。如果不在，则此轨道的计算终止。\n    b. 如果 $p_n$ 被限制，计算归一化之前的下一个切向量：$w'_{n+1} = DF_K(p_n) w_n$。\n    c. 局部扩张率是范数 $\\|w'_{n+1}\\|$。我们将其对数加到一个运行总和中：$S_{n+1} = S_n + \\ln(\\|w'_{n+1}\\|)$。\n    d. 为下一步归一化切向量：$w_{n+1} = w'_{n+1} / \\|w'_{n+1}\\|$。\n    e. 计算轨道上的下一个点：$p_{n+1} = F_K(p_n)$，确保其分量被包裹到 $[-\\pi, \\pi)$ 区间内。\n4.  **估计**：如果轨道在限制区域内停留了 $N_{stop}$ 步（$N_{stop} > 0$），则指数估计值为 $\\lambda_{FTLE} \\approx S_{N_{stop}} / N_{stop}$。如果轨道立即离开（$N_{stop}=0$），其对平均值的贡献定义为 $0$。\n5.  **平均**：对几个初始位移 $\\delta$ 重复此过程，并对每个 $K$ 所得的 $\\lambda_{FTLE}$ 值进行平均，以获得更稳健的估计。\n\n此过程在以下程序中实现，用于计算限制在近似原点附近同宿缠结区域内的轨道的平均有限时间最大李雅普诺夫指数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and prints the finite-time maximal Lyapunov exponent for the\n    Chirikov standard map for a suite of K parameters.\n    \"\"\"\n\n    def wrap_angle(angle):\n        \"\"\"Wraps an angle in radians to the interval [-pi, pi).\"\"\"\n        return (angle + np.pi) % (2.0 * np.pi) - np.pi\n\n    def standard_map(p, K):\n        \"\"\"\n        Applies the Chirikov standard map F_K to a point p = (x, y).\n\n        Args:\n            p (np.ndarray): A 2-element array representing the state (x, y).\n            K (float): The stochasticity parameter.\n\n        Returns:\n            np.ndarray: The next state (x_new, y_new), with components wrapped.\n        \"\"\"\n        x, y = p\n        y_new = y + K * np.sin(x)\n        x_new = x + y_new\n        return np.array([wrap_angle(x_new), wrap_angle(y_new)])\n\n    def jacobian_map(p, K):\n        \"\"\"\n        Computes the Jacobian matrix of the standard map at point p = (x, y).\n\n        Args:\n            p (np.ndarray): A 2-element array representing the state (x, y).\n            K (float): The stochasticity parameter.\n\n        Returns:\n            np.ndarray: The 2x2 Jacobian matrix.\n        \"\"\"\n        x, _ = p\n        cos_x = np.cos(x)\n        return np.array([\n            [1.0 + K * cos_x, 1.0],\n            [K * cos_x, 1.0]\n        ])\n\n    def calculate_single_orbit_lyapunov(p0, K, rx, ry, Nmax):\n        \"\"\"\n        Calculates the finite-time Lyapunov exponent for a single orbit.\n\n        Args:\n            p0 (np.ndarray): The initial condition (x0, y0).\n            K (float): The stochasticity parameter.\n            rx (float): The confinement radius for the x-coordinate.\n            ry (float): The confinement radius for the y-coordinate.\n            Nmax (int): The maximum number of iterations.\n\n        Returns:\n            float: The estimated finite-time maximal Lyapunov exponent.\n        \"\"\"\n        p = p0\n        # Initialize a random tangent vector and normalize it.\n        w = np.array([1.0, 0.0])\n        log_sum = 0.0\n        n_steps = 0\n\n        for _ in range(Nmax):\n            # Check for confinement before accumulating growth\n            if abs(p[0]) > rx or abs(p[1]) > ry:\n                break\n            \n            # Evolve the tangent vector using the Jacobian at the current point\n            J_p = jacobian_map(p, K)\n            w_next_unnormalized = J_p @ w\n\n            # Calculate the norm and add its log to the sum\n            norm_w = np.linalg.norm(w_next_unnormalized)\n            if norm_w > 0:\n                log_sum += np.log(norm_w)\n                # Normalize the vector for the next step\n                w = w_next_unnormalized / norm_w\n            else:\n                # This case is unlikely but would terminate growth\n                break\n\n            # Evolve the orbit to the next point\n            p = standard_map(p, K)\n            n_steps += 1\n\n        if n_steps > 0:\n            return log_sum / n_steps\n        else:\n            return 0.0\n\n    # Define the test parameters from the problem statement.\n    K_values = [1e-6, 0.5, 1.0, 2.0, 4.0, 6.0]\n    deltas = [1e-8, 5e-8, 1e-7]\n    rx, ry = 1.0, 1.0\n    Nmax = 5000\n\n    results = []\n    \n    # Run the simulation for each K value\n    for K in K_values:\n        k_results = []\n\n        # Find the unstable eigenvector at the origin (0,0)\n        J0 = jacobian_map(np.array([0.0, 0.0]), K)\n        eigenvalues, eigenvectors = np.linalg.eig(J0)\n        \n        # The unstable eigenvector corresponds to the eigenvalue > 1\n        # which is the largest eigenvalue for K > 0.\n        unstable_vec_idx = np.argmax(eigenvalues)\n        unstable_vec = eigenvectors[:, unstable_vec_idx].real\n\n        # Average over several initial displacements along the unstable manifold\n        for delta in deltas:\n            p0 = delta * unstable_vec\n            lyap_exponent = calculate_single_orbit_lyapunov(p0, K, rx, ry, Nmax)\n            k_results.append(lyap_exponent)\n        \n        # Average the results for the current K and store it\n        avg_lyap = np.mean(k_results)\n        results.append(avg_lyap)\n\n    # Format and print the final output exactly as specified.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}