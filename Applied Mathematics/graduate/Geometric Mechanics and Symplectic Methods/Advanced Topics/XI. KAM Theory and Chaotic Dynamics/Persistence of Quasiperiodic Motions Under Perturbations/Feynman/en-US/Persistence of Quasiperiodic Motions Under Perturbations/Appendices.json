{
    "hands_on_practices": [
        {
            "introduction": "The persistence of an invariant torus under perturbation hinges on a crucial criterion from Kolmogorov-Arnold-Moser (KAM) theory: the nondegeneracy condition. This condition ensures that the frequencies of motion, given by the map $\\omega(I) = \\nabla_I H_0(I)$, vary sufficiently as the actions $I$ change, a property often called \"twist.\" This practice  provides a direct exercise in verifying this condition by computing the Hessian matrix of an integrable Hamiltonian, which is a fundamental skill for applying the theory.",
            "id": "3760487",
            "problem": "Consider an integrable Hamiltonian system on the phase space $\\mathbb{T}^{2} \\times \\mathbb{R}^{2}$ with standard action-angle coordinates $(\\theta, I)$ and canonical symplectic two-form $dI \\wedge d\\theta$. The Hamiltonian depends only on the actions $I=(I_{1}, I_{2})$ and is given by\n$$\nH_{0}(I) \\;=\\; I_{1}^{2} \\;+\\; \\frac{3}{2} I_{2}^{2} \\;+\\; \\frac{1}{2} I_{1} I_{2} \\;+\\; \\frac{1}{3} I_{1}^{3} \\;+\\; \\frac{1}{2} I_{1}^{2} I_{2} \\;+\\; \\frac{1}{24} I_{2}^{4}.\n$$\nThe frequency map is defined by $\\omega(I) = \\nabla_{I} H_{0}(I)$, and its derivative $D\\omega(I)$ with respect to the actions is called the twist matrix. In the context of the Kolmogorov–Arnold–Moser (KAM) theory, a sufficient nondegeneracy condition for the persistence of quasiperiodic invariant tori under small Hamiltonian perturbations is the invertibility of the twist matrix at the corresponding action, which is equivalent to the nonvanishing of the determinant of the Hessian of $H_{0}$ with respect to $I$.\n\nWorking from the definitions above and using only standard calculus and the canonical geometric setup, compute the twist matrix $D\\omega(I) = D^{2}H_{0}(I)$ for the given $H_{0}$, then evaluate it at the specified action $I^{\\ast} = (1, -1)$. Verify the nondegeneracy condition by computing the determinant $\\det\\!\\big(D^{2}H_{0}(I^{\\ast})\\big)$. Express your final answer as the exact value of this determinant. No rounding is required, and no physical units apply. Provide the determinant as your final answer.",
            "solution": "The problem is well-posed and scientifically sound, set within the standard framework of Hamiltonian mechanics and KAM theory. All necessary data and definitions are provided. We proceed with the solution.\n\nThe unperturbed Hamiltonian $H_{0}$ is given as a function of the action variables $I = (I_{1}, I_{2})$:\n$$\nH_{0}(I_{1}, I_{2}) \\;=\\; I_{1}^{2} \\;+\\; \\frac{3}{2} I_{2}^{2} \\;+\\; \\frac{1}{2} I_{1} I_{2} \\;+\\; \\frac{1}{3} I_{1}^{3} \\;+\\; \\frac{1}{2} I_{1}^{2} I_{2} \\;+\\; \\frac{1}{24} I_{2}^{4}\n$$\nThe problem states that the twist matrix, which is the derivative of the frequency map $\\omega(I) = \\nabla_{I} H_{0}(I)$, is given by $D\\omega(I) = D^{2}H_{0}(I)$. This is the Hessian matrix of $H_{0}$ with respect to the actions $I$. The Hessian matrix is defined as:\n$$\nD^{2}H_{0}(I) = \\begin{pmatrix} \\frac{\\partial^{2} H_{0}}{\\partial I_{1}^{2}} & \\frac{\\partial^{2} H_{0}}{\\partial I_{1} \\partial I_{2}} \\\\ \\frac{\\partial^{2} H_{0}}{\\partial I_{2} \\partial I_{1}} & \\frac{\\partial^{2} H_{0}}{\\partial I_{2}^{2}} \\end{pmatrix}\n$$\nTo compute this matrix, we must find the second partial derivatives of $H_{0}$. First, we compute the first partial derivatives (which form the components of the frequency map $\\omega(I)$):\n$$\n\\frac{\\partial H_{0}}{\\partial I_{1}} = \\frac{\\partial}{\\partial I_{1}} \\left( I_{1}^{2} + \\frac{3}{2} I_{2}^{2} + \\frac{1}{2} I_{1} I_{2} + \\frac{1}{3} I_{1}^{3} + \\frac{1}{2} I_{1}^{2} I_{2} + \\frac{1}{24} I_{2}^{4} \\right) = 2I_{1} + \\frac{1}{2} I_{2} + I_{1}^{2} + I_{1} I_{2}\n$$\n$$\n\\frac{\\partial H_{0}}{\\partial I_{2}} = \\frac{\\partial}{\\partial I_{2}} \\left( I_{1}^{2} + \\frac{3}{2} I_{2}^{2} + \\frac{1}{2} I_{1} I_{2} + \\frac{1}{3} I_{1}^{3} + \\frac{1}{2} I_{1}^{2} I_{2} + \\frac{1}{24} I_{2}^{4} \\right) = 3I_{2} + \\frac{1}{2} I_{1} + \\frac{1}{2} I_{1}^{2} + \\frac{4}{24} I_{2}^{3} = 3I_{2} + \\frac{1}{2} I_{1} + \\frac{1}{2} I_{1}^{2} + \\frac{1}{6} I_{2}^{3}\n$$\nNext, we compute the second partial derivatives from these expressions:\n$$\n\\frac{\\partial^{2} H_{0}}{\\partial I_{1}^{2}} = \\frac{\\partial}{\\partial I_{1}} \\left( 2I_{1} + \\frac{1}{2} I_{2} + I_{1}^{2} + I_{1} I_{2} \\right) = 2 + 2I_{1} + I_{2}\n$$\n$$\n\\frac{\\partial^{2} H_{0}}{\\partial I_{1} \\partial I_{2}} = \\frac{\\partial}{\\partial I_{2}} \\left( 2I_{1} + \\frac{1}{2} I_{2} + I_{1}^{2} + I_{1} I_{2} \\right) = \\frac{1}{2} + I_{1}\n$$\nBy Clairaut's theorem for the smooth function $H_0$, we have $\\frac{\\partial^{2} H_{0}}{\\partial I_{2} \\partial I_{1}} = \\frac{\\partial^{2} H_{0}}{\\partial I_{1} \\partial I_{2}} = I_{1} + \\frac{1}{2}$.\n$$\n\\frac{\\partial^{2} H_{0}}{\\partial I_{2}^{2}} = \\frac{\\partial}{\\partial I_{2}} \\left( 3I_{2} + \\frac{1}{2} I_{1} + \\frac{1}{2} I_{1}^{2} + \\frac{1}{6} I_{2}^{3} \\right) = 3 + \\frac{3}{6} I_{2}^{2} = 3 + \\frac{1}{2} I_{2}^{2}\n$$\nAssembling these components, the twist matrix is:\n$$\nD^{2}H_{0}(I) = \\begin{pmatrix} 2 + 2I_{1} + I_{2} & I_{1} + \\frac{1}{2} \\\\ I_{1} + \\frac{1}{2} & 3 + \\frac{1}{2} I_{2}^{2} \\end{pmatrix}\n$$\nNow, we evaluate this matrix at the specified action $I^{\\ast} = (1, -1)$. We substitute $I_{1} = 1$ and $I_{2} = -1$:\n$$\nD^{2}H_{0}(I^{\\ast}) = \\begin{pmatrix} 2 + 2(1) + (-1) & (1) + \\frac{1}{2} \\\\ (1) + \\frac{1}{2} & 3 + \\frac{1}{2} (-1)^{2} \\end{pmatrix} = \\begin{pmatrix} 2 + 2 - 1 & 1 + \\frac{1}{2} \\\\ 1 + \\frac{1}{2} & 3 + \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} 3 & \\frac{3}{2} \\\\ \\frac{3}{2} & \\frac{7}{2} \\end{pmatrix}\n$$\nFinally, we compute the determinant of this matrix to check the nondegeneracy condition. For a $2 \\times 2$ matrix $\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$, the determinant is $ad - bc$.\n$$\n\\det\\!\\big(D^{2}H_{0}(I^{\\ast})\\big) = (3)\\left(\\frac{7}{2}\\right) - \\left(\\frac{3}{2}\\right)\\left(\\frac{3}{2}\\right) = \\frac{21}{2} - \\frac{9}{4}\n$$\nTo subtract these fractions, we find a common denominator, which is $4$:\n$$\n\\det\\!\\big(D^{2}H_{0}(I^{\\ast})\\big) = \\frac{21 \\times 2}{2 \\times 2} - \\frac{9}{4} = \\frac{42}{4} - \\frac{9}{4} = \\frac{42 - 9}{4} = \\frac{33}{4}\n$$\nThe value of the determinant is $\\frac{33}{4}$. As this value is non-zero, the nondegeneracy condition for the persistence of the invariant torus at action $I^{\\ast}$ is satisfied. The problem asks for the exact value of this determinant.",
            "answer": "$$\\boxed{\\frac{33}{4}}$$"
        },
        {
            "introduction": "Building on the previous exercise, we now investigate a system where the nondegeneracy condition is explicitly violated. While the standard KAM theorem no longer applies, this does not necessarily imply a complete breakdown of ordered motion. This practice  challenges you to use the fundamental principles of Hamiltonian mechanics to analyze the dynamics directly, revealing how the structure of invariant tori is altered and demonstrating the persistence of lower-dimensional invariant sets.",
            "id": "3760458",
            "problem": "Consider a Hamiltonian system on the cotangent bundle of the two-torus, $\\mathbb{T}^{2} \\times \\mathbb{R}^{2}$, with canonical coordinates $(\\theta_{1},\\theta_{2},I_{1},I_{2})$ and symplectic form $dI \\wedge d\\theta$. Let the unperturbed integrable Hamiltonian be\n$$\nH_{0}(I_{1},I_{2}) = \\frac{1}{2} I_{1}^{2},\n$$\nand define a real-analytic one-parameter family of perturbed Hamiltonians\n$$\nH_{\\varepsilon}(\\theta_{1},\\theta_{2},I_{1},I_{2}) = H_{0}(I_{1},I_{2}) + \\varepsilon V(\\theta_{2}), \\quad V(\\theta_{2}) = \\cos(\\theta_{2}),\n$$\nfor $0 < \\varepsilon \\ll 1$.\n\nThe context is the persistence of quasiperiodic motions under perturbations in geometric mechanics and symplectic methods. You may use fundamental facts such as Hamilton’s equations, the definition of an invariant torus, the frequency map $\\omega(I) = \\partial H_{0}/\\partial I$, and the standard nondegeneracy (twist) role of the Hessian of $H_{0}$ in Kolmogorov-Arnold-Moser (KAM) theory, but do not assume any specialized “shortcut” formulas not derivable from these bases.\n\nTasks:\n1. Compute the Hessian of $H_{0}$ with respect to $(I_{1},I_{2})$, determine its rank at every point, and explain the geometric meaning of this degeneracy for the frequency map $\\omega(I)$.\n2. Using Hamilton’s equations for $H_{\\varepsilon}$, analyze the dynamics of $(\\theta_{2},I_{2})$ for small but nonzero $\\varepsilon$, and determine whether two-frequency quasiperiodic invariant two-tori (with both angles evolving linearly in time with nonzero frequencies) can persist near the unperturbed $H_{0}$-tori.\n3. Identify any reduced-dimensional invariant structures that do persist for $\\varepsilon \\neq 0$ and argue their dimensionality using the equations of motion and invariant set criteria.\n\nAnswer specification: Report, as a single integer, the dimension of the largest invariant quasiperiodic torus that persists for sufficiently small $\\varepsilon > 0$ in this family. No units are required. No rounding is needed.",
            "solution": "The problem asks for an analysis of the persistence of invariant tori in a perturbed Hamiltonian system. We will proceed by first validating the problem statement and then performing the requested tasks in order.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- Phase Space: Cotangent bundle of the two-torus, $\\mathbb{T}^2 \\times \\mathbb{R}^2$.\n- Canonical Coordinates: $(\\theta_{1}, \\theta_{2}, I_{1}, I_{2})$.\n- Symplectic Form: $dI \\wedge d\\theta = dI_1 \\wedge d\\theta_1 + dI_2 \\wedge d\\theta_2$.\n- Unperturbed Hamiltonian: $H_{0}(I_{1}, I_{2}) = \\frac{1}{2} I_{1}^{2}$.\n- Perturbed Hamiltonian: $H_{\\varepsilon}(\\theta_{1}, \\theta_{2}, I_{1}, I_{2}) = H_{0}(I_{1}, I_{2}) + \\varepsilon V(\\theta_{2})$, where $V(\\theta_{2}) = \\cos(\\theta_{2})$ and $0 < \\varepsilon \\ll 1$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is set within the standard framework of Hamiltonian mechanics and specifically addresses concepts from KAM theory (integrable systems, perturbations, invariant tori, nondegeneracy). All concepts are standard in geometric mechanics and symplectic methods. The problem is scientifically and mathematically sound.\n- **Well-Posed:** The problem provides all necessary information to perform the tasks. The questions are specific and solvable using the provided Hamiltonians and fundamental principles.\n- **Objective:** The language is formal, precise, and free of subjective or ambiguous terms.\n\n**Step 3: Verdict and Action**\nThe problem is valid. We proceed to solve it.\n\n### Solution\n\n**Task 1: Hessian of $H_0$ and the Degeneracy of the Frequency Map**\n\nThe unperturbed Hamiltonian is given by $H_{0}(I_{1}, I_{2}) = \\frac{1}{2} I_{1}^{2}$. The frequency map for the unperturbed system, $\\omega(I)$, is defined as the gradient of $H_0$ with respect to the action variables $I = (I_1, I_2)$.\nThe components of the frequency vector are:\n$$\n\\omega_{1}(I) = \\frac{\\partial H_{0}}{\\partial I_{1}} = \\frac{\\partial}{\\partial I_{1}}\\left(\\frac{1}{2} I_{1}^{2}\\right) = I_{1}\n$$\n$$\n\\omega_{2}(I) = \\frac{\\partial H_{0}}{\\partial I_{2}} = \\frac{\\partial}{\\partial I_{2}}\\left(\\frac{1}{2} I_{1}^{2}\\right) = 0\n$$\nThus, the frequency map is $\\omega(I_{1}, I_{2}) = (I_{1}, 0)$.\n\nThe Hessian of $H_0$ is the matrix of second partial derivatives with respect to the action variables, which is also the Jacobian of the frequency map:\n$$\n\\text{Hess}(H_{0}) = \\frac{\\partial \\omega}{\\partial I} = \\begin{pmatrix} \\frac{\\partial \\omega_{1}}{\\partial I_{1}} & \\frac{\\partial \\omega_{1}}{\\partial I_{2}} \\\\ \\frac{\\partial \\omega_{2}}{\\partial I_{1}} & \\frac{\\partial \\omega_{2}}{\\partial I_{2}} \\end{pmatrix}\n$$\nCalculating the entries:\n$$\n\\frac{\\partial \\omega_{1}}{\\partial I_{1}} = \\frac{\\partial}{\\partial I_{1}}(I_{1}) = 1\n$$\n$$\n\\frac{\\partial \\omega_{1}}{\\partial I_{2}} = \\frac{\\partial}{\\partial I_{2}}(I_{1}) = 0\n$$\n$$\n\\frac{\\partial \\omega_{2}}{\\partial I_{1}} = \\frac{\\partial}{\\partial I_{1}}(0) = 0\n$$\n$$\n\\frac{\\partial \\omega_{2}}{\\partial I_{2}} = \\frac{\\partial}{\\partial I_{2}}(0) = 0\n$$\nThe Hessian matrix is therefore constant:\n$$\n\\text{Hess}(H_{0}) = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\nThe rank of this matrix is $1$ for all points $(I_1, I_2)$ in the action space.\n\nThe geometric meaning of this result relates to the nondegeneracy (or \"twist\") condition of the Kolmogorov-Arnold-Moser (KAM) theorem. The standard KAM theorem requires the Hessian of $H_0$ to be non-singular, meaning its determinant must be non-zero. Here, $\\det(\\text{Hess}(H_{0})) = 0$. The system is **degenerate**. This means that the frequency map $\\omega: \\mathbb{R}^{2} \\to \\mathbb{R}^{2}$ is not a local diffeomorphism. It maps the entire action plane $(I_{1}, I_{2})$ onto the line $(\\omega_{1}, 0)$ in the frequency space. This degeneracy violates a crucial hypothesis of the standard KAM theorem, which guarantees the persistence of a majority of non-resonant quasiperiodic $2$-tori.\n\n**Task 2: Dynamics of $H_\\varepsilon$ and Persistence of 2-Tori**\n\nThe perturbed Hamiltonian is $H_{\\varepsilon} = \\frac{1}{2} I_{1}^{2} + \\varepsilon \\cos(\\theta_{2})$. We use Hamilton's equations, $\\dot{\\theta}_{i} = \\frac{\\partial H_{\\varepsilon}}{\\partial I_{i}}$ and $\\dot{I}_{i} = -\\frac{\\partial H_{\\varepsilon}}{\\partial \\theta_{i}}$, to analyze the dynamics.\n$$\n\\dot{\\theta}_{1} = \\frac{\\partial H_{\\varepsilon}}{\\partial I_{1}} = I_{1}\n$$\n$$\n\\dot{\\theta}_{2} = \\frac{\\partial H_{\\varepsilon}}{\\partial I_{2}} = 0\n$$\n$$\n\\dot{I}_{1} = -\\frac{\\partial H_{\\varepsilon}}{\\partial \\theta_{1}} = 0\n$$\n$$\n\\dot{I}_{2} = -\\frac{\\partial H_{\\varepsilon}}{\\partial \\theta_{2}} = -\\frac{\\partial}{\\partial \\theta_{2}}(\\varepsilon \\cos(\\theta_{2})) = \\varepsilon \\sin(\\theta_{2})\n$$\nThe equations $\\dot{I}_1=0$ and $\\dot{\\theta}_2=0$ provide immediate and crucial insights.\nFrom $\\dot{\\theta}_{2} = 0$, it follows that for any trajectory, $\\theta_{2}(t) = \\theta_{2,0}$ (a constant determined by the initial conditions). The frequency associated with the coordinate $\\theta_2$ is identically zero for any motion in the perturbed system.\nA two-frequency quasiperiodic invariant two-torus, as described in the problem, requires both angles to evolve with non-zero frequencies. Since the frequency for $\\theta_2$ is always zero, no such tori can exist in the perturbed system for any $\\varepsilon \\neq 0$. The unperturbed invariant $2$-tori (level sets of $I_1, I_2$) do not persist as invariant $2$-tori carrying two-frequency quasiperiodic motion.\n\n**Task 3: Reduced-Dimensional Invariant Structures**\n\nWe now search for any invariant structures that do persist. An invariant torus must be a compact manifold, which implies that trajectories on it must be bounded. Let's analyze the conditions for bounded motion.\nFrom Hamilton's equations, we have:\n1. $I_{1}(t) = I_{1,0}$ (constant)\n2. $\\theta_{2}(t) = \\theta_{2,0}$ (constant)\n3. $\\theta_{1}(t) = I_{1,0} t + \\theta_{1,0}$\n4. $\\dot{I}_{2} = \\varepsilon \\sin(\\theta_{2,0})$, which implies $I_{2}(t) = I_{2,0} + (\\varepsilon \\sin(\\theta_{2,0}))t$.\n\nFor the motion to be bounded, the action variable $I_2$ must not grow or shrink indefinitely. This requires $\\dot{I}_{2} = 0$.\n$$\n\\varepsilon \\sin(\\theta_{2,0}) = 0\n$$\nFor $\\varepsilon \\neq 0$, this condition is satisfied only if $\\sin(\\theta_{2,0}) = 0$, which means $\\theta_{2,0} = k\\pi$ for some integer $k$. As $\\theta_2$ is an angle, this corresponds to the two distinct submanifolds defined by $\\theta_2=0$ and $\\theta_2=\\pi$.\n\nIf a trajectory starts with an initial condition satisfying $\\theta_2 = k\\pi$, it will remain on this submanifold for all time, as $\\dot{\\theta}_2=0$. Furthermore, on this submanifold, $\\dot{I}_2=0$. Therefore, these are invariant submanifolds.\nLet's consider the dynamics restricted to these invariant sets. For a given initial state $(I_{1,0}, I_{2,0})$ and $\\theta_{2,0}=k\\pi$:\n- $I_{1}(t) = I_{1,0}$\n- $I_{2}(t) = I_{2,0}$\n- $\\theta_{1}(t) = I_{1,0}t + \\theta_{1,0}$\n- $\\theta_{2}(t) = k\\pi$\n\nFor any fixed values of $I_{1,0}$, $I_{2,0}$, and $k$, the set of points\n$$\n\\mathcal{T}_{I_{1,0}, I_{2,0}, k} = \\{ (\\theta_{1}, k\\pi, I_{1,0}, I_{2,0}) \\mid \\theta_{1} \\in [0, 2\\pi) \\}\n$$\nis an invariant manifold. Topologically, this set is a circle ($S^1$), which is a $1$-dimensional torus.\nIf $I_{1,0} \\neq 0$, the motion on this circle is periodic with frequency $I_{1,0}$. Periodic motion is a special case of quasiperiodic motion (with a single frequency). If $I_{1,0} = 0$, the circle is composed entirely of fixed points.\n\nWe have established that invariant $2$-tori do not persist, but families of invariant $1$-tori do persist for $\\varepsilon > 0$. These are the only invariant structures that support bounded (quasiperiodic) motion. Therefore, the dimension of the largest invariant quasiperiodic torus that persists is $1$.\n\nFinal Answer: The dimension of the largest invariant quasiperiodic torus that persists for sufficiently small $\\varepsilon > 0$ is $1$.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "Analytical conditions like nondegeneracy provide local guarantees for specific tori, but understanding the global transition to chaos requires exploring the full parameter space. This final practice  shifts our focus from analytical calculation to computational experiment, using the canonical sine-circle map as our laboratory. By implementing a numerical scheme to compute rotation numbers and test for their Diophantine properties, you will estimate the measure of surviving tori and gain insight into the formation of the complex, fractal structure of mode-locking regions known as the \"Devil's staircase.\"",
            "id": "3760485",
            "problem": "Consider the persistence of quasiperiodic motions in one-dimensional circle diffeomorphisms under smooth perturbations, studied in the context of Kolmogorov–Arnold–Moser (KAM) theory. We design a computational experiment using the sine-circle map, which is a canonical model for mode-locking and the formation of a Cantor-like set of surviving quasiperiodic motions. The goal is to numerically estimate, for a set of perturbation strengths, the measure of parameters that lead to surviving invariant curves (tori) with Diophantine rotation numbers, and thereby indirectly visualize the Cantor structure through the dependency of rotation numbers on perturbation strength.\n\nLet the sine-circle map be defined by the lift on the real line:\n$$\nx_{n+1} \\;=\\; x_n \\;+\\; \\Omega \\;-\\; \\frac{K}{2\\pi}\\,\\sin(2\\pi x_n),\n$$\nwhere $x_n \\in \\mathbb{R}$ is the lifted angle variable, $K \\ge 0$ is the perturbation strength, and $\\Omega \\in [0,1]$ is a parameter analogous to the unperturbed rotation number. The corresponding circle map is obtained by projecting $x_n$ modulo $1$. Angles inside the sine function are measured in radians.\n\nFor each fixed $K$, the long-time average increment per iterate defines the rotation number:\n$$\n\\rho(K,\\Omega) \\;=\\; \\lim_{n\\to\\infty} \\frac{x_n - x_0}{n},\n$$\nwhich we estimate numerically by finite-time averaging. According to KAM theory, for sufficiently small $K$ and for Diophantine $\\Omega$, invariant curves (tori) survive and the rotation number $\\rho$ remains irrational and satisfies a Diophantine condition. As $K$ increases, mode-locking tongues open and a positive measure subset of parameters yields rational rotation numbers corresponding to periodic orbits instead of invariant curves, producing a Devil’s staircase (a Cantor-like structure in the complement of mode-locked intervals).\n\nDefine a finite Diophantine test as follows. A number $\\rho \\in \\mathbb{R}$ passes the finite Diophantine test with parameters $(\\gamma,\\tau,Q_{\\max})$ if for all integers $q$ with $1 \\le q \\le Q_{\\max}$ and for all integers $p$,\n$$\n\\left|\\rho - \\frac{p}{q}\\right| \\;\\ge\\; \\frac{\\gamma}{q^\\tau}.\n$$\nIn practice, for each $q$, it suffices to check the nearest rational $\\frac{p}{q}$ with $p = \\mathrm{round}(q\\rho)$.\n\nYour task is to write a program that, for a fixed grid of $\\Omega$ values in $[0,1]$, computes the finite-time approximation of $\\rho(K,\\Omega)$ and classifies whether it passes the finite Diophantine test. For each $K$ in the test suite below, estimate the measure of surviving tori as the fraction of $\\Omega$ values whose rotation numbers pass the Diophantine test. This fraction must be reported as a float in $[0,1]$.\n\nFundamental base for the derivation and algorithm:\n- Definition of the rotation number as the long-time average increment for a lift of a circle map.\n- The notion of invariant curves (tori) being characterized by quasiperiodic motion with irrational, Diophantine rotation numbers.\n- The Diophantine condition as a quantitative arithmetic property ensuring nonresonance required by KAM-type persistence under small perturbations.\n\nAngle unit: radians, as the sine function uses radian arguments.\n\nNumerical protocol to implement:\n- Use a uniform grid of $\\Omega$ values in $[0,1]$ with $M$ points, including endpoints.\n- For each $K$ in the test suite, iterate the lifted map for $N$ steps starting from $x_0 = 0$, and compute the finite-time rotation number $\\hat{\\rho}(K,\\Omega) = \\frac{x_N - x_0}{N}$.\n- Apply the finite Diophantine test with fixed parameters $(\\gamma,\\tau,Q_{\\max})$ to each $\\hat{\\rho}$; classify as \"surviving\" if it passes the test for all $q \\le Q_{\\max}$.\n- Estimate the measure of surviving tori as the fraction of $\\Omega$ in the grid classified as surviving.\n- Important: Use the lifted map without modulo to accumulate $x_n$, but the sine function argument is $2\\pi x_n$, so use radians.\n\nTest suite:\n- Perturbation strengths $K \\in \\{0.0,\\;0.5,\\;0.9,\\;1.0,\\;1.2\\}$.\n- Grid size $M = 601$ for $\\Omega$ uniformly in $[0,1]$.\n- Iteration length $N = 10000$.\n- Diophantine parameters $\\gamma = 5\\times 10^{-3}$, $\\tau = 2$, $Q_{\\max} = 20$.\n\nOutput specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one float per $K$ in the test suite, in the same order as listed above. For example: \"[result_K0,result_K1,result_K2,result_K3,result_K4]\".\n- Each result must be a float in $[0,1]$ representing the estimated fraction of $\\Omega$ values whose rotation numbers pass the Diophantine test for that $K$; rounding is not required beyond the default Python float printing.\n\nConstraints and scientific realism:\n- Do not assume exact convergence of $\\rho$; finite-time estimates must be used.\n- The Diophantine test is finite and approximate; use the specified parameters without modification.\n- Angles inside the sine function must be treated in radians.\n\nYour program must be complete and runnable and produce the exact single-line output format described.",
            "solution": "We begin from the foundational definitions of rotation number and quasiperiodic motion for circle maps. A smooth circle diffeomorphism can be represented by a lift $f:\\mathbb{R}\\to\\mathbb{R}$, and the rotation number is defined by the limit\n$$\n\\rho \\;=\\; \\lim_{n\\to\\infty} \\frac{f^n(x) - x}{n},\n$$\nwhich exists and is independent of $x$ for orientation-preserving diffeomorphisms. For the sine-circle map lift\n$$\nf(x) \\;=\\; x + \\Omega - \\frac{K}{2\\pi}\\sin(2\\pi x),\n$$\nthe map is smooth for any $K$, and for $K<1$ it is strictly increasing. The rotation number $\\rho$ characterizes the average angular advance per iterate, matching $\\Omega$ when $K=0$. Under smooth perturbations, Kolmogorov–Arnold–Moser (KAM) theory asserts that invariant curves (tori) with Diophantine rotation numbers persist for sufficiently small perturbation strength, while resonant (rational) rotation numbers correspond to mode-locked periodic orbits rather than surviving tori.\n\nThe Cantor-like structure of surviving quasiperiodic motions arises because the set of parameters leading to irrational rotation numbers is a closed perfect set with zero measure in fully mode-locked regimes, but has positive measure for small $K$. To make this quantitative in a computation, we use a finite-time approximation of the rotation number and a finite Diophantine test.\n\nStep-by-step derivation and algorithmic design:\n\n1. Map selection and lifting:\n   - We use the sine-circle map lift\n     $$\n     x_{n+1} \\;=\\; x_n + \\Omega - \\frac{K}{2\\pi}\\sin(2\\pi x_n),\n     $$\n     with $x_0=0$. We do not reduce modulo $1$ in the iteration because the rotation number $\\rho$ is defined for the lift via the net increment; however, the sine function argument $\\sin(2\\pi x_n)$ is evaluated in radians.\n\n2. Rotation number estimate:\n   - The finite-time rotation number is\n     $$\n     \\hat{\\rho}(K,\\Omega) \\;=\\; \\frac{x_N - x_0}{N},\n     $$\n     with a chosen $N$ that balances computational tractability and accuracy. For $N$ sufficiently large, $\\hat{\\rho}$ approximates $\\rho$ with error that typically scales like $\\mathcal{O}(1/N)$ for sufficiently regular dynamics.\n\n3. Diophantine condition:\n   - KAM persistence for invariant curves requires a nonresonance (Diophantine) condition: for some $\\gamma>0$, $\\tau>1$,\n     $$\n     \\left|\\rho - \\frac{p}{q}\\right| \\;\\ge\\; \\frac{\\gamma}{q^\\tau}\n     $$\n     for all integers $p$ and $q$. This excludes rotation numbers that are too close to rationals with small denominator. In computation, we enforce a finite version by restricting to $1\\le q\\le Q_{\\max}$ and checking only the nearest rational $\\frac{p}{q}$ determined by $p=\\mathrm{round}(q\\hat{\\rho})$.\n\n4. Surviving tori classification:\n   - For each $(K,\\Omega)$, we classify the outcome as \"surviving\" if $\\hat{\\rho}(K,\\Omega)$ passes the finite Diophantine test for all $q$ in $\\{1,2,\\dots,Q_{\\max}\\}$, namely\n     $$\n     \\left|\\hat{\\rho}(K,\\Omega) - \\frac{p}{q}\\right| \\;\\ge\\; \\frac{\\gamma}{q^\\tau}.\n     $$\n   - This criterion is consistent with the KAM requirement of Diophantine rotation numbers and discriminates against mode-locked rationals and near-rationals.\n\n5. Measure estimation:\n   - Fix a uniform grid of $\\Omega \\in [0,1]$ of size $M$. For each $K$, compute the fraction of $\\Omega$ values for which the classification is \"surviving\". This fraction approximates the measure (with respect to $\\Omega$) of parameters yielding surviving invariant curves.\n\n6. Parameter choices:\n   - We choose $M=601$ for resolution across $[0,1]$.\n   - We choose $N=10000$ to ensure adequate convergence of $\\hat{\\rho}$.\n   - We set $(\\gamma,\\tau,Q_{\\max})=(5\\times 10^{-3},\\,2,\\,20)$ to enforce a reasonably strict Diophantine filter while allowing for finite-time estimation error. For $q=20$, the threshold is $\\gamma/q^\\tau \\approx 1.25\\times 10^{-5}$; typical finite-time estimation error for $N=10000$ is of order $10^{-4}$, which means we will rarely misclassify truly irrational rotation numbers as rational unless they are exceptionally close to a low-denominator rational, which is precisely what the Diophantine condition is designed to exclude.\n\n7. Visualization proxy:\n   - Although we do not produce plots, the dependence of the fraction of surviving rotation numbers on $K$ serves as a quantitative proxy for the Devil’s staircase: as $K$ increases, mode-locking tongues expand, the set of surviving irrationals shrinks, and the estimated measure decreases, reflecting the Cantor-like structure of the complement of resonances.\n\n8. Test suite and output:\n   - We evaluate $K$ in $\\{0.0,0.5,0.9,1.0,1.2\\}$ to cover the unperturbed case, small perturbations, near the monotonicity threshold ($K\\approx 1$), and supercritical values with significant mode-locking.\n   - The program outputs a single line containing a list of five floats, each the fraction of surviving $\\Omega$ for the corresponding $K$.\n\nComputational considerations:\n- The map iteration can be vectorized over the grid of $\\Omega$ values using numerical arrays, significantly reducing runtime compared to scalar loops.\n- The Diophantine test can be vectorized across denominators $q$ and the set of rotation numbers, computing distances to the nearest rationals efficiently as\n  $$\n  \\mathrm{dist}_q(\\hat{\\rho}) = \\frac{\\left| q\\hat{\\rho} - \\mathrm{round}(q\\hat{\\rho}) \\right|}{q},\n  $$\n  and checking whether any $\\mathrm{dist}_q(\\hat{\\rho})$ violates the threshold $\\gamma/q^\\tau$.\n\nThis design integrates the geometric mechanics perspective (invariant curves, twist dynamics), the symplectic methods mindset (rotation numbers and torus persistence), and KAM-inspired arithmetic nonresonance conditions into a concrete, testable numerical experiment. The produced fractions across the test suite serve as robust indicators of how the measure of surviving tori depends on the perturbation strength.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_rotation_numbers(K, Omegas, N):\n    \"\"\"\n    Compute finite-time rotation numbers for the sine-circle map lift:\n        x_{n+1} = x_n + Omega - (K/(2*pi)) * sin(2*pi*x_n)\n    using vectorized iteration over the array of Omegas.\n    \"\"\"\n    x = np.zeros_like(Omegas, dtype=np.float64)\n    two_pi = 2.0 * np.pi\n    k_coeff = K / two_pi\n    for _ in range(N):\n        # Update lifted map without modulo\n        x += Omegas - k_coeff * np.sin(two_pi * x)\n    rho_hat = x / float(N)  # since x0=0, rotation number estimate is x_N / N\n    # Reduce to [0,1) if desired for Diophantine check; safe to wrap fractional part\n    rho_hat = rho_hat - np.floor(rho_hat)  # fractional part\n    return rho_hat\n\ndef diophantine_mask(rhos, gamma, tau, Qmax):\n    \"\"\"\n    Return a boolean mask indicating which rotation numbers pass the finite\n    Diophantine test with parameters (gamma, tau, Qmax).\n    For each q in [1, Qmax], check |rho - p/q| >= gamma / q^tau, with p = round(q*rho).\n    Vectorized across rhos.\n    \"\"\"\n    # rhos shape: (M,)\n    M = rhos.shape[0]\n    # Initialize as all True; will set to False if any q violates the condition\n    mask = np.ones(M, dtype=bool)\n    # Loop over q; vectorized nearest rational distance computation\n    for q in range(1, Qmax + 1):\n        q_rho = rhos * q\n        p = np.rint(q_rho)  # nearest integer\n        # distance to nearest p/q in absolute value\n        dist = np.abs(q_rho - p) / q\n        threshold = gamma / (q ** tau)\n        # Any point with dist < threshold fails the Diophantine test\n        mask &= (dist >= threshold)\n        # Early exit if all have already failed (unlikely but safe)\n        if not np.any(mask):\n            break\n    return mask\n\ndef solve():\n    # Define the test cases from the problem statement.\n    K_values = [0.0, 0.5, 0.9, 1.0, 1.2]\n    M = 601  # number of Omega samples\n    N = 10000  # iteration length\n    gamma = 5e-3\n    tau = 2\n    Qmax = 20\n\n    # Uniform grid of Omega in [0,1], including endpoints\n    Omegas = np.linspace(0.0, 1.0, M, dtype=np.float64)\n\n    results = []\n    for K in K_values:\n        # Compute rotation numbers for this K\n        rhos = compute_rotation_numbers(K, Omegas, N)\n        # Apply finite Diophantine test\n        mask = diophantine_mask(rhos, gamma, tau, Qmax)\n        # Fraction of Omegas that pass the Diophantine test\n        fraction_surviving = float(np.count_nonzero(mask)) / float(M)\n        results.append(fraction_surviving)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}