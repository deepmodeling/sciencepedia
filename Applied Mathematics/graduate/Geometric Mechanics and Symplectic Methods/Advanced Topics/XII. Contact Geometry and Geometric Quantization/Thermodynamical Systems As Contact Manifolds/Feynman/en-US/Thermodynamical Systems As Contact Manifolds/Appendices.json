{
    "hands_on_practices": [
        {
            "introduction": "Darboux's theorem is a cornerstone of contact geometry, stating that any contact manifold is locally indistinguishable from a standard model. This practice  provides a concrete exercise in this fundamental concept. By starting with a thermodynamic contact form in a non-standard \"gauge,\" you will first verify that it indeed defines a valid contact structure and then explicitly construct the change of variables that transforms it into the canonical Darboux form.",
            "id": "3783492",
            "problem": "Consider a closed, single-component thermodynamical system at fixed volume and fixed amount of substance, so that the First Law of Thermodynamics reduces to $dU = T\\,dS$, where $U$ is the internal energy, $S$ is the entropy, and $T$ is the temperature. On the $3$-dimensional manifold with local coordinates $(U,T,S)$, the Gibbs $1$-form $\\theta_{0} = dU - T\\,dS$ defines a contact structure. Any smooth nowhere-vanishing multiple of $\\theta_{0}$ defines the same contact structure. Let $\\alpha$ be a fixed nonzero real constant and consider the scaled contact form\n$$\n\\theta_{\\alpha} = \\exp(\\alpha S)\\,dU - \\exp(\\alpha S)\\,T\\,dS.\n$$\nThis $1$-form models the same thermodynamic contact structure associated to the internal energy potential, but written in a non-Darboux gauge.\n\nTasks:\n- Starting from the definitions of a contact manifold and the contact condition, compute $\\theta_{\\alpha} \\wedge d\\theta_{\\alpha}$ explicitly and verify that it is a nowhere-vanishing $3$-form on an open set where $(U,T,S)$ are valid coordinates, thereby confirming that $\\theta_{\\alpha}$ is a contact form.\n- Construct an explicit local change of variables $(U,T,S) \\mapsto (Z,P,Q)$ to Darboux coordinates such that in the new coordinates the form becomes $\\theta_{\\alpha} = dZ - P\\,dQ$.\n- As a quantitative check of your transformation, compute the Jacobian determinant $\\det\\left(\\frac{\\partial(Z,P,Q)}{\\partial(U,T,S)}\\right)$ of your change of variables and provide this determinant as the final answer.\n\nExpress the final answer as a single closed-form analytic expression in terms of $S$ and $\\alpha$. No numerical rounding is required. Do not include any units in the final answer.",
            "solution": "The problem requires three tasks related to the contact $1$-form $\\theta_{\\alpha} = \\exp(\\alpha S)\\,dU - \\exp(\\alpha S)\\,T\\,dS$ on a $3$-dimensional manifold with coordinates $(U,T,S)$. We address each task in sequence.\n\nFirst, we verify that $\\theta_{\\alpha}$ is a contact form by computing $\\theta_{\\alpha} \\wedge d\\theta_{\\alpha}$ and showing it is a nowhere-vanishing $3$-form. The form is given by\n$$\n\\theta_{\\alpha} = \\exp(\\alpha S)\\,dU - \\exp(\\alpha S)\\,T\\,dS\n$$\nwhere $\\alpha$ is a nonzero real constant. We compute its exterior derivative $d\\theta_{\\alpha}$.\n$$\nd\\theta_{\\alpha} = d(\\exp(\\alpha S)\\,dU) - d(\\exp(\\alpha S)\\,T\\,dS)\n$$\nUsing the product rule for exterior derivatives, $d(\\omega \\wedge \\eta) = d\\omega \\wedge \\eta + (-1)^p \\omega \\wedge d\\eta$ where $\\omega$ is a $p$-form. Here, we can treat functions as $0$-forms.\n$$\nd\\theta_{\\alpha} = (d(\\exp(\\alpha S)) \\wedge dU + \\exp(\\alpha S) \\wedge d(dU)) - (d(\\exp(\\alpha S)T) \\wedge dS + \\exp(\\alpha S)T \\wedge d(dS))\n$$\nSince $d(dU)=0$ and $d(dS)=0$, this simplifies to\n$$\nd\\theta_{\\alpha} = d(\\exp(\\alpha S)) \\wedge dU - d(\\exp(\\alpha S)T) \\wedge dS\n$$\nThe exterior derivatives of the coefficient functions are:\n$$\nd(\\exp(\\alpha S)) = \\frac{\\partial}{\\partial S}(\\exp(\\alpha S))\\,dS = \\alpha \\exp(\\alpha S)\\,dS\n$$\n$$\nd(\\exp(\\alpha S)T) = \\frac{\\partial}{\\partial T}(\\exp(\\alpha S)T)\\,dT + \\frac{\\partial}{\\partial S}(\\exp(\\alpha S)T)\\,dS = \\exp(\\alpha S)\\,dT + \\alpha \\exp(\\alpha S)T\\,dS\n$$\nSubstituting these back into the expression for $d\\theta_{\\alpha}$:\n$$\nd\\theta_{\\alpha} = (\\alpha \\exp(\\alpha S)\\,dS) \\wedge dU - (\\exp(\\alpha S)\\,dT + \\alpha \\exp(\\alpha S)T\\,dS) \\wedge dS\n$$\nUsing the properties of the wedge product, $dS \\wedge dU = -dU \\wedge dS$ and $dS \\wedge dS = 0$:\n$$\nd\\theta_{\\alpha} = -\\alpha \\exp(\\alpha S)\\,dU \\wedge dS - \\exp(\\alpha S)\\,dT \\wedge dS - \\alpha \\exp(\\alpha S)T\\,dS \\wedge dS\n$$\n$$\nd\\theta_{\\alpha} = -\\alpha \\exp(\\alpha S)\\,dU \\wedge dS - \\exp(\\alpha S)\\,dT \\wedge dS\n$$\nNow we compute the wedge product $\\theta_{\\alpha} \\wedge d\\theta_{\\alpha}$:\n$$\n\\theta_{\\alpha} \\wedge d\\theta_{\\alpha} = (\\exp(\\alpha S)\\,dU - \\exp(\\alpha S)\\,T\\,dS) \\wedge (-\\alpha \\exp(\\alpha S)\\,dU \\wedge dS - \\exp(\\alpha S)\\,dT \\wedge dS)\n$$\nWe expand the product. Any term containing a repeated $1$-form, like $dU \\wedge dU$ or $dS \\wedge dS$, will be zero.\nThe first term of $\\theta_{\\alpha}$ gives:\n$$\n\\exp(\\alpha S)\\,dU \\wedge (-\\alpha \\exp(\\alpha S)\\,dU \\wedge dS) = -\\alpha \\exp(2\\alpha S)\\,dU \\wedge dU \\wedge dS = 0\n$$\n$$\n\\exp(\\alpha S)\\,dU \\wedge (-\\exp(\\alpha S)\\,dT \\wedge dS) = -\\exp(2\\alpha S)\\,dU \\wedge dT \\wedge dS\n$$\nThe second term of $\\theta_{\\alpha}$ gives:\n$$\n-\\exp(\\alpha S)\\,T\\,dS \\wedge (-\\alpha \\exp(\\alpha S)\\,dU \\wedge dS) = \\alpha T \\exp(2\\alpha S)\\,dS \\wedge dU \\wedge dS = 0\n$$\n$$\n-\\exp(\\alpha S)\\,T\\,dS \\wedge (-\\exp(\\alpha S)\\,dT \\wedge dS) = T \\exp(2\\alpha S)\\,dS \\wedge dT \\wedge dS = 0\n$$\nCombining the non-zero terms, we find:\n$$\n\\theta_{\\alpha} \\wedge d\\theta_{\\alpha} = -\\exp(2\\alpha S)\\,dU \\wedge dT \\wedge dS\n$$\nSince $\\alpha$ is a nonzero real constant, $\\exp(2\\alpha S)$ is strictly positive for any real $S$. Therefore, $-\\exp(2\\alpha S)$ is never zero. The form $dU \\wedge dT \\wedge dS$ is the standard volume form on the coordinate chart $(U,T,S)$. Thus, $\\theta_{\\alpha} \\wedge d\\theta_{\\alpha}$ is a nowhere-vanishing $3$-form, which confirms that $\\theta_{\\alpha}$ is a valid contact form.\n\nSecond, we construct the change of variables $(U,T,S) \\mapsto (Z,P,Q)$ that transforms $\\theta_{\\alpha}$ into the Darboux form $dZ - P\\,dQ$. We need to solve the equation:\n$$\n\\exp(\\alpha S)\\,dU - \\exp(\\alpha S)\\,T\\,dS = dZ - P\\,dQ\n$$\nwhere $Z, P, Q$ are functions of $(U,T,S)$. A standard method is to make an educated guess for one of the new coordinates. Let us choose $Q=S$. This implies $dQ=dS$. Substituting this into the equation gives:\n$$\n\\exp(\\alpha S)\\,dU - \\exp(\\alpha S)\\,T\\,dS = dZ - P\\,dS\n$$\nRearranging to solve for $dZ$:\n$$\ndZ = \\exp(\\alpha S)\\,dU + (P - \\exp(\\alpha S)T)\\,dS\n$$\nSince $Z$ is a function of $(U,T,S)$, its total differential is $dZ = \\frac{\\partial Z}{\\partial U}dU + \\frac{\\partial Z}{\\partial T}dT + \\frac{\\partial Z}{\\partial S}dS$. Comparing the coefficients, we obtain:\n1. $\\frac{\\partial Z}{\\partial U} = \\exp(\\alpha S)$\n2. $\\frac{\\partial Z}{\\partial T} = 0$\n3. $\\frac{\\partial Z}{\\partial S} = P - \\exp(\\alpha S)T$\n\nFrom condition $2$, $Z$ does not depend on $T$, so $Z=Z(U,S)$. Integrating condition $1$ with respect to $U$, we get:\n$$\nZ(U,S) = \\int \\exp(\\alpha S)\\,dU = U\\exp(\\alpha S) + g(S)\n$$\nwhere $g(S)$ is an arbitrary function of $S$. Differentiating this expression for $Z$ with respect to $S$:\n$$\n\\frac{\\partial Z}{\\partial S} = \\alpha U \\exp(\\alpha S) + g'(S)\n$$\nSubstituting this into condition $3$:\n$$\n\\alpha U \\exp(\\alpha S) + g'(S) = P - \\exp(\\alpha S)T\n$$\nThis gives an expression for the new coordinate $P$ in terms of the old coordinates and $g'(S)$:\n$$\nP(U,T,S) = \\alpha U \\exp(\\alpha S) + T \\exp(\\alpha S) + g'(S)\n$$\nWe have the freedom to choose $g(S)$. The simplest choice that defines a valid coordinate transformation is to take $g(S)$ to be a constant, which implies $g'(S)=0$. With this choice, our transformation becomes:\n$$\nZ = U \\exp(\\alpha S)\n$$\n$$\nP = (\\alpha U + T) \\exp(\\alpha S)\n$$\n$$\nQ = S\n$$\nThis is the explicit local change of variables to Darboux coordinates.\n\nThird, we compute the Jacobian determinant $\\det\\left(\\frac{\\partial(Z,P,Q)}{\\partial(U,T,S)}\\right)$. The Jacobian matrix $J$ is given by:\n$$\nJ = \\begin{pmatrix} \\frac{\\partial Z}{\\partial U} & \\frac{\\partial Z}{\\partial T} & \\frac{\\partial Z}{\\partial S} \\\\ \\frac{\\partial P}{\\partial U} & \\frac{\\partial P}{\\partial T} & \\frac{\\partial P}{\\partial S} \\\\ \\frac{\\partial Q}{\\partial U} & \\frac{\\partial Q}{\\partial T} & \\frac{\\partial Q}{\\partial S} \\end{pmatrix}\n$$\nWe compute the necessary partial derivatives:\n$\\frac{\\partial Z}{\\partial U} = \\exp(\\alpha S)$\n$\\frac{\\partial Z}{\\partial T} = 0$\n$\\frac{\\partial Z}{\\partial S} = \\alpha U \\exp(\\alpha S)$\n\n$\\frac{\\partial P}{\\partial U} = \\alpha \\exp(\\alpha S)$\n$\\frac{\\partial P}{\\partial T} = \\exp(\\alpha S)$\n$\\frac{\\partial P}{\\partial S} = \\frac{\\partial}{\\partial S}[(\\alpha U + T) \\exp(\\alpha S)] = (\\alpha U + T) (\\alpha \\exp(\\alpha S)) = \\alpha(\\alpha U + T)\\exp(\\alpha S)$\n\n$\\frac{\\partial Q}{\\partial U} = 0$\n$\\frac{\\partial Q}{\\partial T} = 0$\n$\\frac{\\partial Q}{\\partial S} = 1$\n\nAssembling the Jacobian matrix:\n$$\nJ = \\begin{pmatrix} \\exp(\\alpha S) & 0 & \\alpha U \\exp(\\alpha S) \\\\ \\alpha \\exp(\\alpha S) & \\exp(\\alpha S) & \\alpha(\\alpha U + T)\\exp(\\alpha S) \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\nThe determinant can be computed by cofactor expansion along the third row:\n$$\n\\det(J) = 1 \\cdot \\det\\begin{pmatrix} \\exp(\\alpha S) & 0 \\\\ \\alpha \\exp(\\alpha S) & \\exp(\\alpha S) \\end{pmatrix} - 0 + 0\n$$\n$$\n\\det(J) = (\\exp(\\alpha S))(\\exp(\\alpha S)) - (0)(\\alpha \\exp(\\alpha S)) = \\exp(2\\alpha S)\n$$\nThe Jacobian determinant is $\\exp(2\\alpha S)$.",
            "answer": "$$\\boxed{\\exp(2\\alpha S)}$$"
        },
        {
            "introduction": "The geometric framework of contact manifolds finds its physical relevance in describing equilibrium states as special surfaces known as Legendre submanifolds. This practice  provides a direct application of this idea by testing whether a set of hypothetical equations of state can form a valid thermodynamic system. You will apply the mathematical conditions of exactness, which correspond to the physical Maxwell relations, and assess the system's stability by analyzing the convexity of the resulting thermodynamic potential.",
            "id": "3783533",
            "problem": "Consider the thermodynamic contact manifold with local coordinates $(U,S,V,N,T,p,\\mu)$ and contact $1$-form $\\eta = dU - T\\,dS + p\\,dV - \\mu\\,dN$. A Legendre submanifold is an integral submanifold on which $\\eta$ vanishes and which can be described by a generating function (thermodynamic potential) whose total differential reproduces the First Law of Thermodynamics (FLT), $dU = T\\,dS - p\\,dV + \\mu\\,dN$. In the energy representation, the equations of state satisfy $T = \\partial U/\\partial S$, $p = -\\partial U/\\partial V$, and $\\mu = \\partial U/\\partial N$. A necessary and sufficient condition for the existence of such a potential is the exactness of the $1$-form $T\\,dS - p\\,dV + \\mu\\,dN$ on the state space, equivalently the symmetry of mixed partial derivatives (Maxwell relations).\n\nYou are given empirical equations of state for a simple single-species system with extensive variables $(S,V,N)$ and intensive variables $(T,p,\\mu)$:\n$$\nT(S,V,N) = A\\,S\\,V^{\\lambda},\\qquad p(S,V,N) = -\\frac{A\\,\\lambda}{2}\\,S^{2}\\,V^{\\lambda-1},\\qquad \\mu(S,V,N) = 3\\,B\\,N^{2},\n$$\nwhere $A>0$, $B>0$, $\\lambda \\in \\mathbb{R}$ are fixed constants, and $S>0$, $V>0$, $N>0$. Starting from the FLT and the definition of a Legendre submanifold, do the following:\n\n1. Derive the exactness conditions (Maxwell-type relations) that must hold between $T$, $p$, and $\\mu$ for a potential $U(S,V,N)$ to exist, and verify whether these relations are satisfied by the given empirical equations of state.\n\n2. If exactness holds, construct a thermodynamic potential $U(S,V,N)$, unique up to an additive constant, such that $T = \\partial U/\\partial S$, $p = -\\partial U/\\partial V$, and $\\mu = \\partial U/\\partial N$.\n\n3. Assess the convexity (thermodynamic stability) of $U(S,V,N)$ with respect to $(S,V,N)$ by computing the Hessian matrix $H = \\nabla^{2}_{(S,V,N)}U$ and analyzing its principal minors. Provide the closed-form analytic expression for the determinant $\\det(H)$ as a function of $(S,V,N)$ and $(A,B,\\lambda)$.\n\nExpress your final answer as the analytic expression for $\\det(H)$ in terms of $(S,V,N)$ and $(A,B,\\lambda)$. No numerical approximation or rounding is required, and no units should be included in the final answer.",
            "solution": "The problem requires us to validate a set of empirical equations of state for a thermodynamic system, construct the corresponding internal energy potential $U(S,V,N)$ if it exists, and analyze its convexity by computing the determinant of its Hessian matrix. The starting point is the First Law of Thermodynamics for an open system, which, on the Legendre submanifold where the contact form vanishes, is given by $dU = T\\,dS - p\\,dV + \\mu\\,dN$.\n\nFor a potential $U(S,V,N)$ to exist, the $1$-form $\\omega = T\\,dS - p\\,dV + \\mu\\,dN$ must be exact. This means that $T$, $-p$, and $\\mu$ must be the partial derivatives of $U$ with respect to $S$, $V$, and $N$, respectively:\n$$\nT = \\frac{\\partial U}{\\partial S}, \\quad -p = \\frac{\\partial U}{\\partial V}, \\quad \\mu = \\frac{\\partial U}{\\partial N}\n$$\nThe problem statement gives $p = -\\frac{\\partial U}{\\partial V}$, which is consistent with the above. The condition for the exactness of $\\omega$ is that the mixed second partial derivatives of $U$ must be equal (Clairaut's theorem). This gives rise to a set of Maxwell-type relations.\n\n**1. Derivation and Verification of Exactness Conditions**\n\nThe three conditions for exactness are:\n1.  $\\frac{\\partial^2 U}{\\partial V \\partial S} = \\frac{\\partial^2 U}{\\partial S \\partial V} \\implies \\frac{\\partial}{\\partial V}\\left(\\frac{\\partial U}{\\partial S}\\right) = \\frac{\\partial}{\\partial S}\\left(\\frac{\\partial U}{\\partial V}\\right) \\implies \\frac{\\partial T}{\\partial V} = \\frac{\\partial(-p)}{\\partial S} = -\\frac{\\partial p}{\\partial S}$\n2.  $\\frac{\\partial^2 U}{\\partial N \\partial S} = \\frac{\\partial^2 U}{\\partial S \\partial N} \\implies \\frac{\\partial}{\\partial N}\\left(\\frac{\\partial U}{\\partial S}\\right) = \\frac{\\partial}{\\partial S}\\left(\\frac{\\partial U}{\\partial N}\\right) \\implies \\frac{\\partial T}{\\partial N} = \\frac{\\partial \\mu}{\\partial S}$\n3.  $\\frac{\\partial^2 U}{\\partial N \\partial V} = \\frac{\\partial^2 U}{\\partial V \\partial N} \\implies \\frac{\\partial}{\\partial N}\\left(\\frac{\\partial U}{\\partial V}\\right) = \\frac{\\partial}{\\partial V}\\left(\\frac{\\partial U}{\\partial N}\\right) \\implies \\frac{\\partial(-p)}{\\partial N} = \\frac{\\partial \\mu}{\\partial V} \\implies -\\frac{\\partial p}{\\partial N} = \\frac{\\partial \\mu}{\\partial V}$\n\nWe now verify these three relations using the given empirical equations of state:\n$T(S,V,N) = A\\,S\\,V^{\\lambda}$\n$p(S,V,N) = -\\frac{A\\,\\lambda}{2}\\,S^{2}\\,V^{\\lambda-1}$\n$\\mu(S,V,N) = 3\\,B\\,N^{2}$\n\nFor the first relation, $\\frac{\\partial T}{\\partial V} = -\\frac{\\partial p}{\\partial S}$:\n$$\n\\frac{\\partial T}{\\partial V} = \\frac{\\partial}{\\partial V}(A\\,S\\,V^{\\lambda}) = A\\,\\lambda\\,S\\,V^{\\lambda-1}\n$$\n$$\n-\\frac{\\partial p}{\\partial S} = -\\frac{\\partial}{\\partial S}\\left(-\\frac{A\\,\\lambda}{2}\\,S^{2}\\,V^{\\lambda-1}\\right) = \\frac{A\\,\\lambda}{2}\\,(2S)\\,V^{\\lambda-1} = A\\,\\lambda\\,S\\,V^{\\lambda-1}\n$$\nSince $A\\,\\lambda\\,S\\,V^{\\lambda-1} = A\\,\\lambda\\,S\\,V^{\\lambda-1}$, the first relation is satisfied.\n\nFor the second relation, $\\frac{\\partial T}{\\partial N} = \\frac{\\partial \\mu}{\\partial S}$:\n$$\n\\frac{\\partial T}{\\partial N} = \\frac{\\partial}{\\partial N}(A\\,S\\,V^{\\lambda}) = 0\n$$\n$$\n\\frac{\\partial \\mu}{\\partial S} = \\frac{\\partial}{\\partial S}(3\\,B\\,N^{2}) = 0\n$$\nSince $0 = 0$, the second relation is satisfied.\n\nFor the third relation, $-\\frac{\\partial p}{\\partial N} = \\frac{\\partial \\mu}{\\partial V}$:\n$$\n-\\frac{\\partial p}{\\partial N} = -\\frac{\\partial}{\\partial N}\\left(-\\frac{A\\,\\lambda}{2}\\,S^{2}\\,V^{\\lambda-1}\\right) = 0\n$$\n$$\n\\frac{\\partial \\mu}{\\partial V} = \\frac{\\partial}{\\partial V}(3\\,B\\,N^{2}) = 0\n$$\nSince $0=0$, the third relation is satisfied.\nAll three exactness conditions hold, so a thermodynamic potential $U(S,V,N)$ exists.\n\n**2. Construction of the Thermodynamic Potential $U(S,V,N)$**\n\nWe construct $U(S,V,N)$ by integrating its partial derivatives.\nFirst, we integrate $\\frac{\\partial U}{\\partial S} = T(S,V,N)$ with respect to S:\n$$\nU(S,V,N) = \\int T(S,V,N)\\,dS + f(V,N) = \\int A\\,S\\,V^{\\lambda}\\,dS + f(V,N) = \\frac{A}{2}\\,S^{2}\\,V^{\\lambda} + f(V,N)\n$$\nwhere $f(V,N)$ is an arbitrary function of $V$ and $N$.\nNext, we use the condition $\\frac{\\partial U}{\\partial V} = -p(S,V,N)$:\n$$\n\\frac{\\partial U}{\\partial V} = \\frac{\\partial}{\\partial V}\\left(\\frac{A}{2}\\,S^{2}\\,V^{\\lambda} + f(V,N)\\right) = \\frac{A}{2}\\,S^{2}\\,\\lambda\\,V^{\\lambda-1} + \\frac{\\partial f}{\\partial V}\n$$\nWe set this equal to $-p = -(-\\frac{A\\,\\lambda}{2}\\,S^{2}\\,V^{\\lambda-1}) = \\frac{A\\,\\lambda}{2}\\,S^{2}\\,V^{\\lambda-1}$:\n$$\n\\frac{A\\,\\lambda}{2}\\,S^{2}\\,V^{\\lambda-1} + \\frac{\\partial f}{\\partial V} = \\frac{A\\,\\lambda}{2}\\,S^{2}\\,V^{\\lambda-1}\n$$\nThis implies $\\frac{\\partial f}{\\partial V} = 0$, so $f$ is not a function of $V$. It can only be a function of $N$, which we denote as $g(N)$. Thus, our potential takes the form:\n$$\nU(S,V,N) = \\frac{A}{2}\\,S^{2}\\,V^{\\lambda} + g(N)\n$$\nFinally, we use the condition $\\frac{\\partial U}{\\partial N} = \\mu(S,V,N)$:\n$$\n\\frac{\\partial U}{\\partial N} = \\frac{\\partial}{\\partial N}\\left(\\frac{A}{2}\\,S^{2}\\,V^{\\lambda} + g(N)\\right) = \\frac{dg}{dN}\n$$\nSetting this equal to $\\mu = 3\\,B\\,N^{2}$:\n$$\n\\frac{dg}{dN} = 3\\,B\\,N^{2}\n$$\nIntegrating with respect to $N$ gives:\n$$\ng(N) = \\int 3\\,B\\,N^{2}\\,dN = B\\,N^{3} + C_0\n$$\nwhere $C_0$ is an arbitrary constant of integration. The thermodynamic potential is therefore:\n$$\nU(S,V,N) = \\frac{A}{2}\\,S^{2}\\,V^{\\lambda} + B\\,N^{3} + C_0\n$$\nThis potential is unique up to the additive constant $C_0$.\n\n**3. Convexity and Hessian Determinant**\n\nThe thermodynamic stability of the system is determined by the convexity of the internal energy $U(S,V,N)$. A sufficient condition for local convexity is that the Hessian matrix of second partial derivatives is positive definite. The Hessian matrix $H$ with respect to the variables $(S,V,N)$ is:\n$$\nH = \\nabla^{2}_{(S,V,N)}U = \\begin{pmatrix}\n\\frac{\\partial^2 U}{\\partial S^2} & \\frac{\\partial^2 U}{\\partial S \\partial V} & \\frac{\\partial^2 U}{\\partial S \\partial N} \\\\\n\\frac{\\partial^2 U}{\\partial V \\partial S} & \\frac{\\partial^2 U}{\\partial V^2} & \\frac{\\partial^2 U}{\\partial V \\partial N} \\\\\n\\frac{\\partial^2 U}{\\partial N \\partial S} & \\frac{\\partial^2 U}{\\partial N \\partial V} & \\frac{\\partial^2 U}{\\partial N^2}\n\\end{pmatrix}\n$$\nWe compute the elements of the Hessian matrix:\n$\\frac{\\partial^2 U}{\\partial S^2} = \\frac{\\partial T}{\\partial S} = \\frac{\\partial}{\\partial S}(A\\,S\\,V^{\\lambda}) = A\\,V^{\\lambda}$\n$\\frac{\\partial^2 U}{\\partial V^2} = \\frac{\\partial(-p)}{\\partial V} = \\frac{\\partial}{\\partial V}(\\frac{A\\,\\lambda}{2}\\,S^{2}\\,V^{\\lambda-1}) = \\frac{A\\,\\lambda(\\lambda-1)}{2}\\,S^{2}\\,V^{\\lambda-2}$\n$\\frac{\\partial^2 U}{\\partial N^2} = \\frac{\\partial \\mu}{\\partial N} = \\frac{\\partial}{\\partial N}(3\\,B\\,N^{2}) = 6\\,B\\,N$\nThe mixed partial derivatives are:\n$\\frac{\\partial^2 U}{\\partial S \\partial V} = \\frac{\\partial T}{\\partial V} = A\\,\\lambda\\,S\\,V^{\\lambda-1}$\n$\\frac{\\partial^2 U}{\\partial S \\partial N} = \\frac{\\partial T}{\\partial N} = 0$\n$\\frac{\\partial^2 U}{\\partial V \\partial N} = \\frac{\\partial(-p)}{\\partial N} = 0$\n\nThe Hessian matrix is symmetric, as expected:\n$$\nH = \\begin{pmatrix}\nA\\,V^{\\lambda} & A\\,\\lambda\\,S\\,V^{\\lambda-1} & 0 \\\\\nA\\,\\lambda\\,S\\,V^{\\lambda-1} & \\frac{A\\,\\lambda(\\lambda-1)}{2}\\,S^{2}\\,V^{\\lambda-2} & 0 \\\\\n0 & 0 & 6\\,B\\,N\n\\end{pmatrix}\n$$\nThe determinant of this block-diagonal matrix is the product of the determinant of the upper-left $2 \\times 2$ block and the third diagonal element $H_{33}$:\n$$\n\\det(H) = (6\\,B\\,N) \\cdot \\det\\begin{pmatrix}\nA\\,V^{\\lambda} & A\\,\\lambda\\,S\\,V^{\\lambda-1} \\\\\nA\\,\\lambda\\,S\\,V^{\\lambda-1} & \\frac{A\\,\\lambda(\\lambda-1)}{2}\\,S^{2}\\,V^{\\lambda-2}\n\\end{pmatrix}\n$$\n$$\n\\det(H) = (6\\,B\\,N) \\left[ (A\\,V^{\\lambda})\\left(\\frac{A\\,\\lambda(\\lambda-1)}{2}\\,S^{2}\\,V^{\\lambda-2}\\right) - (A\\,\\lambda\\,S\\,V^{\\lambda-1})^{2} \\right]\n$$\n$$\n\\det(H) = (6\\,B\\,N) \\left[ \\frac{A^2\\,\\lambda(\\lambda-1)}{2}\\,S^{2}\\,V^{2\\lambda-2} - A^2\\,\\lambda^2\\,S^2\\,V^{2\\lambda-2} \\right]\n$$\nFactoring out common terms inside the bracket:\n$$\n\\det(H) = (6\\,B\\,N) \\left( A^2\\,S^2\\,V^{2\\lambda-2} \\right) \\left[ \\frac{\\lambda(\\lambda-1)}{2} - \\lambda^2 \\right]\n$$\n$$\n\\det(H) = (6\\,B\\,N\\,A^2\\,S^2\\,V^{2\\lambda-2}) \\left[ \\frac{\\lambda^2 - \\lambda - 2\\lambda^2}{2} \\right]\n$$\n$$\n\\det(H) = (6\\,B\\,N\\,A^2\\,S^2\\,V^{2\\lambda-2}) \\left[ \\frac{-\\lambda^2 - \\lambda}{2} \\right]\n$$\n$$\n\\det(H) = -3\\,A^2\\,B\\,\\lambda(\\lambda+1)\\,N\\,S^2\\,V^{2\\lambda-2}\n$$\nFor thermodynamic stability (convexity), all leading principal minors of $H$ must be positive.\n$D_1 = A\\,V^{\\lambda} > 0$ (since $A>0, V>0$).\n$D_2 = -\\frac{A^2\\,\\lambda(\\lambda+1)}{2}\\,S^{2}\\,V^{2\\lambda-2} > 0$, which requires $\\lambda(\\lambda+1) < 0$, i.e., $-1 < \\lambda < 0$.\n$D_3 = \\det(H) > 0$, which also requires $\\lambda(\\lambda+1) < 0$.\nThus, the system is stable if and only if $-1 < \\lambda < 0$. The assessment leads to this condition, and the problem asks for the closed-form expression for the determinant.",
            "answer": "$$\n\\boxed{-3\\,A^{2}\\,B\\,\\lambda(\\lambda+1)\\,N\\,S^{2}\\,V^{2\\lambda-2}}\n$$"
        },
        {
            "introduction": "Beyond describing static equilibrium, the contact formalism provides a powerful framework for modeling dynamic processes, including the relaxation of a system towards equilibrium. This advanced exercise  guides you through the construction of a contact Hamiltonian that generates precisely such a relaxation process. By defining a Hamiltonian that drives the system towards a Legendre submanifold, you will derive and solve the equations of motion, gaining insight into how time evolution is elegantly captured in this geometric setting.",
            "id": "3783552",
            "problem": "Consider a contact manifold with Darboux coordinates given by the triple $(x,p,z) \\in \\mathbb{R}_{>0} \\times \\mathbb{R} \\times \\mathbb{R}$ and contact one-form $\\lambda = \\mathrm{d}z - p\\,\\mathrm{d}x$. Let the Reeb vector field be the vector field $R$ satisfying $\\iota_R \\mathrm{d}\\lambda = 0$ and $\\iota_R \\lambda = 1$. A contact Hamiltonian field $X_H$ generated by a smooth Hamiltonian $H(x,p,z)$ is defined by the equations\n$$\n\\iota_{X_H}\\mathrm{d}\\lambda = \\mathrm{d}H - \\left(R(H)\\right)\\lambda,\\qquad \\iota_{X_H}\\lambda = -H.\n$$\nStarting from these definitions and no other pre-derived formulas, perform the following tasks in the context of thermodynamical systems modeled as contact manifolds:\n\n1) Interpret the triple $\\left(x,p,z\\right)$ as follows: $x$ is a dimensionless temperature-like coordinate constrained to $x \\in \\mathbb{R}_{>0}$, $z$ is a dimensionless Helmholtz free energy-like potential, and $p$ is its conjugate. Let the Helmholtz free energy manifold (a Legendre submanifold) be specified by a smooth, strictly convex function $\\psi(x)$ through the relations\n$$\nz = \\psi(x), \\qquad p = \\frac{\\mathrm{d}\\psi}{\\mathrm{d}x}(x).\n$$\nAssume a concrete dimensionless model for the Helmholtz free energy,\n$\\psi(x) = \\alpha\\, x \\ln x + \\frac{\\beta}{2}\\, x^2,$ with $\\alpha>0,\\ \\beta>0,\\ x>0,$\nwith derivative\n$$\n\\psi'(x) = \\alpha\\left(\\ln x + 1\\right) + \\beta x.\n$$\n\n2) Construct a contact Hamiltonian $H(x,p,z)$ that enforces isothermal relaxation to the Helmholtz free energy manifold in the following sense:\n- The flow keeps $x$ constant in time (isothermal condition).\n- The quantity $\\Delta_0 := z - \\psi(x)$ monotonically relaxes to $0$.\n- The quantity $\\Delta_1 := p - \\psi'(x)$ also relaxes to $0$.\n\nYour construction should use only the fundamental definitions stated above and must ensure that the resulting Ordinary Differential Equations (ODEs) are globally well-posed for $x>0$.\n\n3) Using the contact Hamiltonian built in item 2), derive the Darboux-coordinate ODEs for $\\left(x(t),p(t),z(t)\\right)$ and solve them explicitly for general initial conditions $\\left(x(0),p(0),z(0)\\right)$, expressing the solutions purely in terms of the parameters, the initial conditions, and time $t$.\n\n4) Define the isothermal relaxation error at time $t$ by\n$\\mathcal{E}(t) := \\max\\left( \\left|p(t) - \\psi'(x(t))\\right|,\\ \\left|z(t) - \\psi(x(t))\\right| \\right).$\nProvide a closed-form expression for $\\mathcal{E}(t)$ in terms of the parameters and initial conditions.\n\n5) Implement a program that computes $\\mathcal{E}(t_f)$ for a set of five test cases. All quantities are dimensionless. You must use the explicit solution derived in item 3) to evaluate $\\mathcal{E}(t_f)$. For each case, output a float rounded to six decimal places. The five test cases are:\n\n- Case 1 (happy path): $\\alpha=1.0$, $\\beta=0.5$, $\\gamma=2.0$, $x_0=1.5$, $p_0=-1.0$, $z_0=0.0$, $t_f=1.0$.\n- Case 2 (on-manifold initial condition): $\\alpha=0.8$, $\\beta=0.3$, $\\gamma=4.0$, $x_0=2.0$, $p_0=\\psi'(2.0)$, $z_0=\\psi(2.0)$, $t_f=1.0$.\n- Case 3 (no relaxation boundary): $\\alpha=1.0$, $\\beta=1.0$, $\\gamma=0.0$, $x_0=1.2$, $p_0=2.0$, $z_0=-0.5$, $t_f=3.0$.\n- Case 4 (small $x$ edge): $\\alpha=1.5$, $\\beta=0.2$, $\\gamma=3.0$, $x_0=0.1$, $p_0=0.0$, $z_0=1.0$, $t_f=2.0$.\n- Case 5 (stiff relaxation): $\\alpha=0.7$, $\\beta=0.4$, $\\gamma=50.0$, $x_0=1.1$, $p_0=5.0$, $z_0=-2.0$, $t_f=0.5$.\n\nHere $\\gamma \\ge 0$ is the relaxation rate parameter you introduce within your contact Hamiltonian, and you must use it consistently in your derivations.\n\n6) Final output format requirement: Your program should produce a single line of output containing the results as a comma-separated list of the five floats $\\left[\\mathcal{E}(t_f)_{\\text{Case 1}},\\ldots,\\mathcal{E}(t_f)_{\\text{Case 5}}\\right]$, enclosed in square brackets and with each value rounded to six decimal places, for example, $\\left[0.123456,0.000000,1.234000,0.010000,0.000001\\right]$. No other text should be printed.",
            "solution": "The problem is well-posed, scientifically grounded, and internally consistent. We proceed with the solution by following the specified tasks.\n\nFirst, we derive the general expressions for the Reeb vector field $R$ and the contact Hamiltonian vector field $X_H$ in the given Darboux coordinates $(x, p, z)$.\n\nThe contact one-form is $\\lambda = \\mathrm{d}z - p\\,\\mathrm{d}x$. Its exterior derivative is $\\mathrm{d}\\lambda = \\mathrm{d}(\\mathrm{d}z - p\\,\\mathrm{d}x) = -\\mathrm{d}p \\wedge \\mathrm{d}x = \\mathrm{d}x \\wedge \\mathrm{d}p$.\nLet the Reeb vector field be $R = R_x \\frac{\\partial}{\\partial x} + R_p \\frac{\\partial}{\\partial p} + R_z \\frac{\\partial}{\\partial z}$. It must satisfy two conditions:\n1.  $\\iota_R \\lambda = 1$: $\\lambda(R) = (\\mathrm{d}z - p\\,\\mathrm{d}x)(R) = R_z - p R_x = 1$.\n2.  $\\iota_R \\mathrm{d}\\lambda = 0$: $\\iota_R(\\mathrm{d}x \\wedge \\mathrm{d}p) = (\\iota_R \\mathrm{d}x)\\mathrm{d}p - (\\iota_R \\mathrm{d}p)\\mathrm{d}x = R_x \\mathrm{d}p - R_p \\mathrm{d}x = 0$.\nThe second condition implies $R_x = 0$ and $R_p = 0$. Substituting $R_x=0$ into the first condition gives $R_z = 1$. Thus, the Reeb vector field is $R = \\frac{\\partial}{\\partial z}$.\n\nLet the contact Hamiltonian vector field be $X_H = \\dot{x}\\frac{\\partial}{\\partial x} + \\dot{p}\\frac{\\partial}{\\partial p} + \\dot{z}\\frac{\\partial}{\\partial z}$. It is defined by two equations:\n1.  $\\iota_{X_H}\\lambda = -H$: $\\lambda(X_H) = \\dot{z} - p\\dot{x} = -H$.\n2.  $\\iota_{X_H}\\mathrm{d}\\lambda = \\mathrm{d}H - (R(H))\\lambda$:\n    The left side is $\\iota_{X_H}(\\mathrm{d}x \\wedge \\mathrm{d}p) = \\dot{x}\\mathrm{d}p - \\dot{p}\\mathrm{d}x$.\n    For the right side, we first find $R(H) = \\frac{\\partial}{\\partial z}(H) = \\frac{\\partial H}{\\partial z}$.\n    Then $\\mathrm{d}H - (R(H))\\lambda = \\left(\\frac{\\partial H}{\\partial x}\\mathrm{d}x + \\frac{\\partial H}{\\partial p}\\mathrm{d}p + \\frac{\\partial H}{\\partial z}\\mathrm{d}z\\right) - \\frac{\\partial H}{\\partial z}(\\mathrm{d}z - p\\,\\mathrm{d}x) = \\left(\\frac{\\partial H}{\\partial x} + p\\frac{\\partial H}{\\partial z}\\right)\\mathrm{d}x + \\frac{\\partial H}{\\partial p}\\mathrm{d}p$.\n    Equating coefficients of the basis one-forms $\\mathrm{d}x$ and $\\mathrm{d}p$, we get:\n    $\\dot{x} = \\frac{\\partial H}{\\partial p}$\n    $-\\dot{p} = \\frac{\\partial H}{\\partial x} + p\\frac{\\partial H}{\\partial z} \\implies \\dot{p} = -\\frac{\\partial H}{\\partial x} - p\\frac{\\partial H}{\\partial z}$.\nFrom the first definition, we find $\\dot{z} = p\\dot{x} - H = p\\frac{\\partial H}{\\partial p} - H$.\nThe ODEs for the flow are:\n$$\n\\dot{x} = \\frac{\\partial H}{\\partial p}, \\qquad \\dot{p} = -\\frac{\\partial H}{\\partial x} - p\\frac{\\partial H}{\\partial z}, \\qquad \\dot{z} = p\\frac{\\partial H}{\\partial p} - H.\n$$\n\nWith these general equations, we can proceed to construct the specific Hamiltonian for isothermal relaxation.\n\nThe isothermal condition requires $\\dot{x}=0$. From the flow equations, this means $\\frac{\\partial H}{\\partial p} = 0$, so the Hamiltonian $H$ must be a function of $x$ and $z$ only, $H=H(x,z)$.\n\nWith $H=H(x,z)$, the flow equations simplify to:\n$$\n\\dot{x} = 0, \\qquad \\dot{p} = -\\frac{\\partial H}{\\partial x} - p\\frac{\\partial H}{\\partial z}, \\qquad \\dot{z} = -H.\n$$\nThe condition $\\dot{x}=0$ implies $x(t) = x_0$ for all time $t$, where $x_0$ is the initial value.\n\nWe want the quantities $\\Delta_0(t) := z(t) - \\psi(x(t))$ and $\\Delta_1(t) := p(t) - \\psi'(x(t))$ to relax to $0$. Let's examine their time evolution:\n$\\dot{\\Delta}_0 = \\dot{z} - \\frac{\\mathrm{d}}{\\mathrm{d}t}\\psi(x(t)) = \\dot{z} - \\psi'(x)\\dot{x}$. Since $\\dot{x}=0$, we have $\\dot{\\Delta}_0 = \\dot{z} = -H$.\n$\\dot{\\Delta}_1 = \\dot{p} - \\frac{\\mathrm{d}}{\\mathrm{d}t}\\psi'(x(t)) = \\dot{p} - \\psi''(x)\\dot{x}$. Since $\\dot{x}=0$, we have $\\dot{\\Delta}_1 = \\dot{p} = -\\frac{\\partial H}{\\partial x} - p\\frac{\\partial H}{\\partial z}$.\n\nTo achieve monotonic relaxation to $0$, we can model the dynamics with exponential decay. Let's demand $\\dot{\\Delta}_0 = -\\gamma \\Delta_0$ for some non-negative relaxation rate $\\gamma$. This means $-H = -\\gamma \\Delta_0$, leading to the choice of Hamiltonian:\n$$\nH(x,z) = \\gamma \\Delta_0 = \\gamma(z - \\psi(x)).\n$$\nThis Hamiltonian is independent of $p$ as required. Let's verify if it produces the desired relaxation for $\\Delta_1$. We compute the partial derivatives of $H$:\n$\\frac{\\partial H}{\\partial x} = -\\gamma\\psi'(x)$\n$\\frac{\\partial H}{\\partial z} = \\gamma$.\n\nSubstituting these into the equation for $\\dot{\\Delta}_1$:\n$\\dot{\\Delta}_1 = -\\frac{\\partial H}{\\partial x} - p\\frac{\\partial H}{\\partial z} = -(-\\gamma\\psi'(x)) - p(\\gamma) = \\gamma\\psi'(x) - \\gamma p = -\\gamma(p - \\psi'(x)) = -\\gamma \\Delta_1$.\nThis confirms that our choice of $H$ leads to exponential relaxation for both $\\Delta_0$ and $\\Delta_1$ with the same rate $\\gamma$. This completes the construction of the Hamiltonian.\n\nNext, we derive and explicitly solve the resulting ODEs for the system with initial conditions $(x_0, p_0, z_0)$.\nThe system of ODEs is:\n1.  $\\dot{x}(t) = 0$\n2.  $\\dot{p}(t) = -\\gamma(p(t) - \\psi'(x(t)))$\n3.  $\\dot{z}(t) = -\\gamma(z(t) - \\psi(x(t)))$\n\nSolving the first equation: $x(t) = x_0$ for all $t \\ge 0$.\nSince $x(t) = x_0$, the terms $\\psi(x(t))$ and $\\psi'(x(t))$ are constant. Let's denote them as $\\psi_0 := \\psi(x_0)$ and $\\psi'_0 := \\psi'(x_0)$. The ODEs become:\n$\\dot{p}(t) = -\\gamma(p(t) - \\psi'_0)$\n$\\dot{z}(t) = -\\gamma(z(t) - \\psi_0)$\nThese are standard first-order linear ODEs. The solution for an equation of the form $\\dot{y} = -a(y-c)$ is $y(t) = c + (y(0) - c)e^{-at}$.\nApplying this to our system:\n$p(t) = \\psi'_0 + (p_0 - \\psi'_0)e^{-\\gamma t}$\n$z(t) = \\psi_0 + (z_0 - \\psi_0)e^{-\\gamma t}$\n\nThe full explicit solution is:\n$$\nx(t) = x_0\n$$\n$$\np(t) = \\psi'(x_0) + (p_0 - \\psi'(x_0)) e^{-\\gamma t}\n$$\n$$\nz(t) = \\psi(x_0) + (z_0 - \\psi(x_0)) e^{-\\gamma t}\n$$\nwhere $\\psi(x_0) = \\alpha x_0 \\ln x_0 + \\frac{\\beta}{2} x_0^2$ and $\\psi'(x_0) = \\alpha(\\ln x_0 + 1) + \\beta x_0$.\n\nFinally, we derive the closed-form expression for the isothermal relaxation error $\\mathcal{E}(t)$, defined as:\n$$\n\\mathcal{E}(t) := \\max\\left( \\left|p(t) - \\psi'(x(t))\\right|,\\ \\left|z(t) - \\psi(x(t))\\right| \\right).\n$$\nUsing the solutions we found:\n$p(t) - \\psi'(x(t)) = p(t) - \\psi'(x_0) = (p_0 - \\psi'(x_0))e^{-\\gamma t}$\n$z(t) - \\psi(x(t)) = z(t) - \\psi(x_0) = (z_0 - \\psi(x_0))e^{-\\gamma t}$\n\nTaking the absolute values:\n$|p(t) - \\psi'(x_0)| = |p_0 - \\psi'(x_0)|e^{-\\gamma t}$\n$|z(t) - \\psi(x_0)| = |z_0 - \\psi(x_0)|e^{-\\gamma t}$\n(since $e^{-\\gamma t} \\ge 0$ for $\\gamma \\ge 0, t \\ge 0$).\n\nSubstituting these into the definition of $\\mathcal{E}(t)$:\n$\\mathcal{E}(t) = \\max\\left( |p_0 - \\psi'(x_0)|e^{-\\gamma t}, |z_0 - \\psi(x_0)|e^{-\\gamma t} \\right)$\nSince $e^{-\\gamma t}$ is a common non-negative factor, it can be pulled out of the maximum function:\n$$\n\\mathcal{E}(t) = e^{-\\gamma t} \\max\\left( |p_0 - \\psi'(x_0)|, |z_0 - \\psi(x_0)| \\right)\n$$\nThis is the required closed-form expression. The term $\\max\\left( |p_0 - \\psi'(x_0)|, |z_0 - \\psi(x_0)| \\right)$ represents the initial error $\\mathcal{E}(0)$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the isothermal relaxation error E(t_f) for a set of test cases.\n    \"\"\"\n\n    def psi(x, alpha, beta):\n        \"\"\"\n        Computes the Helmholtz free energy-like function psi(x).\n        \"\"\"\n        if x <= 0:\n            # log(x) is undefined for x <= 0.\n            # Problem constraints state x > 0.\n            raise ValueError(\"x must be positive.\")\n        return alpha * x * np.log(x) + (beta / 2.0) * x**2\n\n    def psi_prime(x, alpha, beta):\n        \"\"\"\n        Computes the derivative of psi(x).\n        \"\"\"\n        if x <= 0:\n            raise ValueError(\"x must be positive.\")\n        return alpha * (np.log(x) + 1.0) + beta * x\n\n    def calculate_error(alpha, beta, gamma, x0, p0, z0, tf):\n        \"\"\"\n        Calculates the relaxation error E(tf) using the derived closed-form solution.\n        \n        The formula is E(t) = max(|p0 - psi'(x0)|, |z0 - psi(x0)|) * exp(-gamma * t).\n        \"\"\"\n        # Calculate the equilibrium values at x0\n        psi_val_at_x0 = psi(x0, alpha, beta)\n        psi_prime_val_at_x0 = psi_prime(x0, alpha, beta)\n        \n        # Calculate the initial errors in p and z\n        error_p0 = np.abs(p0 - psi_prime_val_at_x0)\n        error_z0 = np.abs(z0 - psi_val_at_x0)\n        \n        # Determine the maximum initial error E(0)\n        error_t0 = np.maximum(error_p0, error_z0)\n        \n        # Calculate the error at time tf\n        error_tf = error_t0 * np.exp(-gamma * tf)\n        \n        return error_tf\n\n    # Define the five test cases from the problem statement.\n    test_cases = [\n        # Case 1: alpha=1.0, beta=0.5, gamma=2.0, x0=1.5, p0=-1.0, z0=0.0, tf=1.0\n        (1.0, 0.5, 2.0, 1.5, -1.0, 0.0, 1.0),\n        # Case 2: alpha=0.8, beta=0.3, gamma=4.0, x0=2.0, p0=psi'(2.0), z0=psi(2.0), tf=1.0\n        (0.8, 0.3, 4.0, 2.0, 'psi_prime', 'psi', 1.0),\n        # Case 3: alpha=1.0, beta=1.0, gamma=0.0, x0=1.2, p0=2.0, z0=-0.5, tf=3.0\n        (1.0, 1.0, 0.0, 1.2, 2.0, -0.5, 3.0),\n        # Case 4: alpha=1.5, beta=0.2, gamma=3.0, x0=0.1, p0=0.0, z0=1.0, tf=2.0\n        (1.5, 0.2, 3.0, 0.1, 0.0, 1.0, 2.0),\n        # Case 5: alpha=0.7, beta=0.4, gamma=50.0, x0=1.1, p0=5.0, z0=-2.0, tf=0.5\n        (0.7, 0.4, 50.0, 1.1, 5.0, -2.0, 0.5),\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha, beta, gamma, x0, p0_val, z0_val, tf = case\n        \n        # Handle special case where initial conditions are on the manifold\n        if p0_val == 'psi_prime':\n            p0 = psi_prime(x0, alpha, beta)\n        else:\n            p0 = p0_val\n            \n        if z0_val == 'psi':\n            z0 = psi(x0, alpha, beta)\n        else:\n            z0 = z0_val\n\n        result = calculate_error(alpha, beta, gamma, x0, p0, z0, tf)\n        results.append(result)\n\n    # Format the results to six decimal places for the final output string.\n    formatted_results = [f'{res:.6f}' for res in results]\n    \n    # Print the final output in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}