{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握欧拉陀螺的动力学，我们必须首先从其基本的几何框架中推导出其运动方程。这个练习将指导您使用李-泊松括号和哈密顿量来计算角动量分量的时间演化，从而在抽象结构与著名的欧拉方程之间建立起具体的联系。",
            "id": "3748149",
            "problem": "考虑一个自由刚体（欧拉陀螺），其具有不同的主转动惯量 $I_{1}$、$I_{2}$ 和 $I_{3}$，在体坐标系中于特殊正交群 $\\operatorname{SO}(3)$ 上演化。设体角动量为 $M = (M_{1}, M_{2}, M_{3}) \\in \\mathfrak{so}(3)^{\\ast}$，体角速度为 $\\Omega = (\\Omega_{1}, \\Omega_{2}, \\Omega_{3}) \\in \\mathbb{R}^{3}$，二者通过 $M = \\mathbb{I}\\Omega$ 相关联，其中 $\\mathbb{I} = \\operatorname{diag}(I_{1}, I_{2}, I_{3})$。该动力学系统在李代数的对偶空间 $\\mathfrak{so}(3)^{\\ast}$ 上是哈密顿的，其李-泊松括号（LP括号）对于光滑函数 $F, G : \\mathfrak{so}(3)^{\\ast} \\to \\mathbb{R}$ 定义为\n$$\n\\{F, G\\}(M) = -\\,M \\cdot \\big(\\nabla F(M) \\times \\nabla G(M)\\big),\n$$\n哈密顿量为\n$$\nH(M) = \\tfrac{1}{2}\\,\\Omega \\cdot M = \\tfrac{1}{2}\\,M \\cdot \\mathbb{I}^{-1}M.\n$$\n从这些定义出发，推导坐标函数 $M_{i}$ ($i \\in \\{1,2,3\\}$) 的哈密顿运动方程，并计算时间导数 $\\frac{d}{dt}(M_{i})$，用 $M$ 的分量和主转动惯量 $I_{1}, I_{2}, I_{3}$ 表示。通过将 $\\frac{d}{dt}(M_{i})$ 完全用 $M_{j}$ 和 $I_{k}$ 表示，明确验证各分量如何通过转动惯量耦合。\n\n将您的最终答案表示为一个单行矩阵，其中包含三个分量表达式 $\\frac{d}{dt}(M_{1})$、$\\frac{d}{dt}(M_{2})$ 和 $\\frac{d}{dt}(M_{3})$。不需要进行数值计算，也不需要包含单位。",
            "solution": "首先根据既定准则对问题进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **系统**：一个自由刚体（欧拉陀螺）。\n- **主转动惯量**：$I_{1}$、$I_{2}$ 和 $I_{3}$（不同）。\n- **体角动量**：$M = (M_{1}, M_{2}, M_{3}) \\in \\mathfrak{so}(3)^{\\ast}$。\n- **体角速度**：$\\Omega = (\\Omega_{1}, \\Omega_{2}, \\Omega_{3}) \\in \\mathbb{R}^{3}$。\n- **M 与 $\\Omega$ 之间的关系**：$M = \\mathbb{I}\\Omega$，其中 $\\mathbb{I} = \\operatorname{diag}(I_{1}, I_{2}, I_{3})$。\n- **李-泊松括号**：对于光滑函数 $F, G : \\mathfrak{so}(3)^{\\ast} \\to \\mathbb{R}$，括号定义为 $\\{F, G\\}(M) = -\\,M \\cdot \\big(\\nabla F(M) \\times \\nabla G(M)\\big)$。\n- **哈密顿量**：$H(M) = \\tfrac{1}{2}\\,\\Omega \\cdot M = \\tfrac{1}{2}\\,M \\cdot \\mathbb{I}^{-1}M$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题描述了欧拉陀螺在 $\\operatorname{SO}(3)$ 的李代数的对偶空间上的运动的哈密顿表述。所提供的哈密顿量是动能，而李-泊松括号是 $\\mathfrak{so}(3)^{\\ast}$ 的标准括号。这种表述是几何力学的基石。因此，该问题在科学上是合理的。\n- **适定性**：该问题提供了推导运动方程所需的所有定义和方程。它要求进行一个由已知条件唯一确定的特定计算。\n- **客观性**：该问题使用精确的数学语言陈述，没有任何主观或含糊的术语。\n- **缺陷检查**：\n  1. **科学/事实不健全**：无。物理和数学是标准且正确的。\n  2. **不可形式化/不相关**：无。该问题是指定领域的核心练习。\n  3. **不完整/矛盾的设置**：无。所有定义都已提供并且相互一致。\n  4. **不切实际/不可行**：无。这是一个标准的、具有物理意义的模型。\n  5. **不适定/结构不良**：无。推导过程得出了一个唯一的、明确定义的结果。\n  6. **伪深刻/琐碎**：无。该推导是一个基本的计算，展示了李-泊松形式体系的应用。\n  7. **无法进行科学验证**：无。该推导是一个数学证明。\n\n**步骤3：结论与行动**\n该问题是**有效的**。继续进行求解。\n\n### 运动方程的推导\n\n相空间 $\\mathfrak{so}(3)^{\\ast}$ 上任何可观测量 $F(M)$ 的时间演化由哈密顿方程决定：\n$$\n\\frac{dF}{dt} = \\{F, H\\}\n$$\n其中 $H$ 是哈密顿量，$\\{\\cdot, \\cdot\\}$ 是李-泊松括号。我们的任务是找到角动量矢量分量 $M_i$ 的运动方程。这对应于将可观测量 $F$ 分别设为坐标函数 $M_1$、$M_2$ 和 $M_3$。\n\n李-泊松括号给出如下：\n$$\n\\{F, G\\}(M) = -M \\cdot \\left(\\nabla F(M) \\times \\nabla G(M)\\right)\n$$\n这里，$\\nabla$ 是关于坐标 $M = (M_1, M_2, M_3)$ 的梯度，即 $\\nabla = \\left(\\frac{\\partial}{\\partial M_1}, \\frac{\\partial}{\\partial M_2}, \\frac{\\partial}{\\partial M_3}\\right)$。\n\n我们需要计算 $\\frac{dM_i}{dt} = \\{M_i, H\\}$，其中 $i \\in \\{1, 2, 3\\}$。这需要计算函数 $M_i$ 和哈密顿量 $H$ 的梯度。\n\n首先，我们来求哈密顿量 $H$ 的梯度。哈密顿量由下式给出：\n$$\nH(M) = \\frac{1}{2} M \\cdot \\mathbb{I}^{-1}M = \\frac{1}{2} \\left( \\frac{M_1^2}{I_1} + \\frac{M_2^2}{I_2} + \\frac{M_3^2}{I_3} \\right)\n$$\n梯度 $\\nabla H$ 是一个矢量，其分量是 $H$ 对每个 $M_i$ 的偏导数：\n$$\n\\frac{\\partial H}{\\partial M_1} = \\frac{M_1}{I_1}, \\quad \\frac{\\partial H}{\\partial M_2} = \\frac{M_2}{I_2}, \\quad \\frac{\\partial H}{\\partial M_3} = \\frac{M_3}{I_3}\n$$\n因此，梯度矢量为：\n$$\n\\nabla H = \\left( \\frac{M_1}{I_1}, \\frac{M_2}{I_2}, \\frac{M_3}{I_3} \\right) = \\mathbb{I}^{-1}M = \\Omega\n$$\n\n接下来，我们计算坐标函数 $F = M_i$ 的梯度。\n对于 $F = M_1$：\n$$\n\\nabla M_1 = \\left(\\frac{\\partial M_1}{\\partial M_1}, \\frac{\\partial M_1}{\\partial M_2}, \\frac{\\partial M_1}{\\partial M_3}\\right) = (1, 0, 0) = \\mathbf{e}_1\n$$\n同理，$\\nabla M_2 = \\mathbf{e}_2$ 且 $\\nabla M_3 = \\mathbf{e}_3$。\n\n现在我们可以计算每个分量 $M_i$ 的时间导数。\n\n**对于 $M_1$：**\n$$\n\\frac{dM_1}{dt} = \\{M_1, H\\} = -M \\cdot (\\nabla M_1 \\times \\nabla H)\n$$\n我们计算叉积：\n$$\n\\nabla M_1 \\times \\nabla H = \\mathbf{e}_1 \\times \\Omega = (1, 0, 0) \\times \\left(\\frac{M_1}{I_1}, \\frac{M_2}{I_2}, \\frac{M_3}{I_3}\\right) = \\left(0, -\\frac{M_3}{I_3}, \\frac{M_2}{I_2}\\right)\n$$\n现在，我们与 $-M$ 做点积：\n$$\n\\frac{dM_1}{dt} = -(M_1, M_2, M_3) \\cdot \\left(0, -\\frac{M_3}{I_3}, \\frac{M_2}{I_2}\\right) = -\\left( M_2 \\left(-\\frac{M_3}{I_3}\\right) + M_3 \\left(\\frac{M_2}{I_2}\\right) \\right)\n$$\n$$\n\\frac{dM_1}{dt} = -\\left( -\\frac{M_2 M_3}{I_3} + \\frac{M_2 M_3}{I_2} \\right) = M_2 M_3 \\left(\\frac{1}{I_3} - \\frac{1}{I_2}\\right)\n$$\n\n**对于 $M_2$：**\n$$\n\\frac{dM_2}{dt} = \\{M_2, H\\} = -M \\cdot (\\nabla M_2 \\times \\nabla H)\n$$\n叉积为：\n$$\n\\nabla M_2 \\times \\nabla H = \\mathbf{e}_2 \\times \\Omega = (0, 1, 0) \\times \\left(\\frac{M_1}{I_1}, \\frac{M_2}{I_2}, \\frac{M_3}{I_3}\\right) = \\left(\\frac{M_3}{I_3}, 0, -\\frac{M_1}{I_1}\\right)\n$$\n与 $-M$ 做点积：\n$$\n\\frac{dM_2}{dt} = -(M_1, M_2, M_3) \\cdot \\left(\\frac{M_3}{I_3}, 0, -\\frac{M_1}{I_1}\\right) = -\\left( M_1 \\left(\\frac{M_3}{I_3}\\right) + M_3 \\left(-\\frac{M_1}{I_1}\\right) \\right)\n$$\n$$\n\\frac{dM_2}{dt} = -\\left( \\frac{M_1 M_3}{I_3} - \\frac{M_1 M_3}{I_1} \\right) = M_1 M_3 \\left(\\frac{1}{I_1} - \\frac{1}{I_3}\\right)\n$$\n\n**对于 $M_3$：**\n$$\n\\frac{dM_3}{dt} = \\{M_3, H\\} = -M \\cdot (\\nabla M_3 \\times \\nabla H)\n$$\n叉积为：\n$$\n\\nabla M_3 \\times \\nabla H = \\mathbf{e}_3 \\times \\Omega = (0, 0, 1) \\times \\left(\\frac{M_1}{I_1}, \\frac{M_2}{I_2}, \\frac{M_3}{I_3}\\right) = \\left(-\\frac{M_2}{I_2}, \\frac{M_1}{I_1}, 0\\right)\n$$\n与 $-M$ 做点积：\n$$\n\\frac{dM_3}{dt} = -(M_1, M_2, M_3) \\cdot \\left(-\\frac{M_2}{I_2}, \\frac{M_1}{I_1}, 0\\right) = -\\left( M_1 \\left(-\\frac{M_2}{I_2}\\right) + M_2 \\left(\\frac{M_1}{I_1}\\right) \\right)\n$$\n$$\n\\frac{dM_3}{dt} = -\\left( -\\frac{M_1 M_2}{I_2} + \\frac{M_1 M_2}{I_1} \\right) = M_1 M_2 \\left(\\frac{1}{I_2} - \\frac{1}{I_1}\\right)\n$$\n\n这些是自由刚体的欧拉运动方程，以体坐标系中的角动量分量 $M_i$ 和主转动惯量 $I_k$ 表示。分量之间的耦合通过另外两个动量分量的乘积以及转动惯量倒数之差明确地显示出来。\n\n最终结果是关于 $\\frac{d}{dt}(M_i)$ 的三个表达式的集合。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} M_{2}M_{3}\\left(\\frac{1}{I_{3}} - \\frac{1}{I_{2}}\\right)  M_{1}M_{3}\\left(\\frac{1}{I_{1}} - \\frac{1}{I_{3}}\\right)  M_{1}M_{2}\\left(\\frac{1}{I_{2}} - \\frac{1}{I_{1}}\\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在获得了运动方程之后，我们可以分析系统在其稳态附近的行为。此练习涉及在主轴旋转附近对动力学进行线性化以确定其稳定性，这是分析动力系统的基本技术。通过计算线性化系统的特征值，您将揭示刚体旋转的经典稳定性判据。",
            "id": "3748189",
            "problem": "考虑一个自由刚体（欧拉陀螺），其主转动惯量为 $I_1$、$I_2$ 和 $I_3$，惯性张量为 $I = \\operatorname{diag}(I_1, I_2, I_3)$。在几何力学中，刚体角动量 $M \\in \\mathbb{R}^3 \\simeq \\mathfrak{so}(3)^{\\ast}$ 在特殊正交群李代数 $\\mathfrak{so}(3)$ 的对偶空间上演化，其遵循李-泊松括号 $\\{F,G\\}(M) = - M \\cdot \\left(\\nabla F(M) \\times \\nabla G(M)\\right)$，哈密顿量为 $H(M) = \\tfrac{1}{2} M \\cdot I^{-1} M$。刚体角速度 $\\omega$ 由 $M = I \\omega$ 定义，因此 $\\omega = I^{-1} M$。\n\n从这些给定的几何和哈密顿结构出发（除已给出的公式外，不假定任何简化公式），推导运动方程，将围绕主轴的稳态转动识别为平衡点，并在线性化围绕主轴 $e_k$（其中 $k \\in \\{1,2,3\\}$）以恒定角速度 $\\Omega \\neq 0$ 进行的稳态转动附近的动力学。令 $j$ 和 $l$ 表示 $\\{1,2,3\\} \\setminus \\{k\\}$ 中的另外两个指标。\n\n计算限制在由 $e_j$ 和 $e_l$ 张成的二维子空间上的线性化系统的一对非零特征值，并将您的最终结果表示为关于 $I_1$、$I_2$、$I_3$ 和 $\\Omega$ 的特征值平方 $\\lambda^2$ 的单一解析表达式，该表达式对任意选择的转动轴 $k$ 均有效。您的最终答案必须是 $\\lambda^2$ 的单一表达式（无需单位）。",
            "solution": "该问题要求推导自由刚体（欧拉陀螺）在围绕主轴的稳态转动附近的线性化动力学的特征值平方。推导必须从所提供的几何哈密顿表述开始。\n\n首先，我们验证问题陈述。\n问题提供了以下已知条件：\n- 一个自由刚体，其主转动惯量为 $I_1$、$I_2$、$I_3$。\n- 在刚体坐标系中的惯性张量为 $I = \\operatorname{diag}(I_1, I_2, I_3)$。\n- 状态为刚体角动量 $M \\in \\mathbb{R}^3 \\simeq \\mathfrak{so}(3)^{\\ast}$。\n- 动力学由李-泊松括号 $\\{F,G\\}(M) = - M \\cdot \\left(\\nabla F(M) \\times \\nabla G(M)\\right)$ 控制。\n- 哈密顿量为 $H(M) = \\frac{1}{2} M \\cdot I^{-1} M$。\n- 刚体角速度为 $\\omega = I^{-1} M$。\n问题是推导运动方程，将稳态转动识别为平衡点，并在线性化围绕主轴 $e_k$ 以速度 $\\Omega \\neq 0$ 进行的稳态转动附近的动力学，以求出横向动力学的特征值平方 $\\lambda^2$。\n\n该问题具有科学依据、良定且客观。它是几何力学和刚体动力学中的一个标准问题。未发现任何缺陷。我们可以继续进行解答。\n\n第1步：推导运动方程。\n任何可观测量 $F(M)$ 的时间演化由 $\\frac{dF}{dt} = \\{F, H\\}$ 给出。我们通过令 $F = M_i$（其中 $i=1, 2, 3$）来求角动量矢量 $M = (M_1, M_2, M_3)$ 各分量的方程。\n\n哈密顿量为 $H(M) = \\frac{1}{2} \\sum_{i=1}^3 \\frac{M_i^2}{I_i}$。\n哈密顿量关于 $M$ 的梯度是：\n$$ \\nabla H(M) = \\left( \\frac{\\partial H}{\\partial M_1}, \\frac{\\partial H}{\\partial M_2}, \\frac{\\partial H}{\\partial M_3} \\right) = \\left( \\frac{M_1}{I_1}, \\frac{M_2}{I_2}, \\frac{M_3}{I_3} \\right) = I^{-1} M = \\omega $$\n分量函数 $F = M_i$ 的梯度是标准基矢量 $\\nabla M_i = e_i$。\n\n$M_i$ 的运动方程是：\n$$ \\frac{dM_i}{dt} = \\{M_i, H\\}(M) = - M \\cdot \\left(\\nabla M_i \\times \\nabla H(M)\\right) = - M \\cdot (e_i \\times \\omega) $$\n使用矢量三重积恒等式 $A \\cdot (B \\times C) = C \\cdot (A \\times B)$，我们有：\n$$ \\frac{dM_i}{dt} = - \\omega \\cdot (M \\times e_i) = (M \\times \\omega)_i $$\n以矢量形式，这就是著名的关于角动量的欧拉方程：\n$$ \\frac{dM}{dt} = M \\times \\omega = M \\times (I^{-1}M) $$\n按分量写出：\n$$ \\dot{M}_1 = M_2 \\omega_3 - M_3 \\omega_2 = M_2 \\frac{M_3}{I_3} - M_3 \\frac{M_2}{I_2} = M_2 M_3 \\left(\\frac{1}{I_3} - \\frac{1}{I_2}\\right) $$\n$$ \\dot{M}_2 = M_3 \\omega_1 - M_1 \\omega_3 = M_3 \\frac{M_1}{I_1} - M_1 \\frac{M_3}{I_3} = M_1 M_3 \\left(\\frac{1}{I_1} - \\frac{1}{I_3}\\right) $$\n$$ \\dot{M}_3 = M_1 \\omega_2 - M_2 \\omega_1 = M_1 \\frac{M_2}{I_2} - M_2 \\frac{M_1}{I_1} = M_1 M_2 \\left(\\frac{1}{I_2} - \\frac{1}{I_1}\\right) $$\n\n第2步：识别平衡点。\n平衡点或稳态转动是满足 $\\frac{dM}{dt} = 0$ 的点 $M_e$。假设主转动惯量互不相同（即 $I_1 \\neq I_2 \\neq I_3$），则上述方程成立的充要条件是 $M$ 的至少两个分量为零。这对应于纯粹绕某个主轴的转动。\n我们考虑围绕第 $k$ 个主轴 $e_k$ 以恒定角速度 $\\Omega \\neq 0$ 进行的稳态转动。角速度为 $\\omega_e = \\Omega e_k$。相应的平衡角动量为 $M_e = I \\omega_e = I (\\Omega e_k) = I_k \\Omega e_k$。\n所以，平衡点为 $M_{e,i} = \\delta_{ik} I_k \\Omega$，其中 $\\delta_{ik}$ 是克罗内克 δ。\n\n第3步：线性化动力学。\n我们在平衡点 $M_e$ 附近线性化运动方程。令 $M(t) = M_e + \\delta M(t)$，其中 $\\delta M$ 是一个小扰动。\n方程的一般形式为 $\\dot{M}_i = \\sum_{p,q} \\varepsilon_{ipq} \\frac{M_p M_q}{I_q}$，其中 $\\varepsilon_{ipq}$ 是列维-奇维塔符号。\n\n我们来分析扰动分量 $\\delta M_k$、$\\delta M_j$ 和 $\\delta M_l$ 的动力学，其中 $k, j, l$ 是来自 $\\{1, 2, 3\\}$ 的不同指标。\n对于沿转动轴的分量 $\\delta M_k$：\n$$ \\dot{M}_k = \\sum_{p,q} \\varepsilon_{kpq} \\frac{M_p M_q}{I_q} = \\varepsilon_{kjl} \\left(\\frac{1}{I_l} - \\frac{1}{I_j}\\right) M_j M_l $$\n代入 $M_j = \\delta M_j$ 和 $M_l = \\delta M_l$：\n$$ \\dot{\\delta M}_k = \\varepsilon_{kjl} \\left(\\frac{1}{I_l} - \\frac{1}{I_j}\\right) \\delta M_j \\delta M_l $$\n由于这是扰动的二阶项，在线性化系统中 $\\dot{\\delta M}_k=0$。这表明在一阶近似下，动力学被限制在垂直于转动轴的平面内，即由 $e_j$ 和 $e_l$ 张成的子空间。\n\n现在，我们求 $\\delta M_j$ 和 $\\delta M_l$ 的线性化方程。\n对于 $\\delta M_j$：\n$$ \\dot{M}_j = \\varepsilon_{jkl} \\left(\\frac{1}{I_l} - \\frac{1}{I_k}\\right) M_k M_l $$\n代入 $M_k = M_{e,k} + \\delta M_k = I_k \\Omega + \\delta M_k$ 和 $M_l = \\delta M_l$。\n$$ \\dot{\\delta M}_j = \\varepsilon_{jkl} \\left(\\frac{1}{I_l} - \\frac{1}{I_k}\\right) (I_k \\Omega + \\delta M_k) \\delta M_l $$\n仅保留一阶项：\n$$ \\dot{\\delta M}_j \\approx \\varepsilon_{jkl} \\Omega \\left(\\frac{I_k}{I_l} - 1\\right) \\delta M_l $$\n对于 $\\delta M_l$ 也类似：\n$$ \\dot{M}_l = \\varepsilon_{lkj} \\left(\\frac{1}{I_j} - \\frac{1}{I_k}\\right) M_k M_j $$\n代入 $M_k = I_k \\Omega + \\delta M_k$ 和 $M_j = \\delta M_j$。\n$$ \\dot{\\delta M}_l \\approx \\varepsilon_{lkj} \\Omega \\left(\\frac{I_k}{I_j} - 1\\right) \\delta M_j $$\n\n横向动力学的线性化系统为：\n$$ \\frac{d}{dt} \\begin{pmatrix} \\delta M_j \\\\ \\delta M_l \\end{pmatrix} = \\begin{pmatrix} 0  \\varepsilon_{jkl} \\Omega \\left(\\frac{I_k}{I_l} - 1\\right) \\\\ \\varepsilon_{lkj} \\Omega \\left(\\frac{I_k}{I_j} - 1\\right)  0 \\end{pmatrix} \\begin{pmatrix} \\delta M_j \\\\ \\delta M_l \\end{pmatrix} $$\n\n第4步：计算特征值。\n设线性化矩阵为 $A$。特征值 $\\lambda$ 可从特征方程 $\\det(A - \\lambda I_{2\\times2}) = 0$ 求得。\n$$ \\det \\begin{pmatrix} -\\lambda  \\varepsilon_{jkl} \\Omega \\left(\\frac{I_k}{I_l} - 1\\right) \\\\ \\varepsilon_{lkj} \\Omega \\left(\\frac{I_k}{I_j} - 1\\right)  -\\lambda \\end{pmatrix} = 0 $$\n$$ \\lambda^2 - \\left[ \\varepsilon_{jkl} \\Omega \\left(\\frac{I_k}{I_l} - 1\\right) \\right] \\left[ \\varepsilon_{lkj} \\Omega \\left(\\frac{I_k}{I_j} - 1\\right) \\right] = 0 $$\n利用性质 $\\varepsilon_{lkj} = -\\varepsilon_{jkl}$：\n$$ \\lambda^2 + (\\varepsilon_{jkl})^2 \\Omega^2 \\left(\\frac{I_k}{I_l} - 1\\right) \\left(\\frac{I_k}{I_j} - 1\\right) = 0 $$\n因为 $k, j, l$ 是不同的指标，所以 $(\\varepsilon_{jkl})^2=1$。\n$$ \\lambda^2 = - \\Omega^2 \\left(\\frac{I_k - I_l}{I_l}\\right) \\left(\\frac{I_k - I_j}{I_j}\\right) $$\n此表达式可重写为：\n$$ \\lambda^2 = - \\Omega^2 \\frac{(I_k - I_j)(I_k - I_l)}{I_j I_l} $$\n这个最终表达式关于指标 $j$ 和 $l$ 的交换是对称的，正如所要求的那样，因为它们的顺序没有被指定。它给出了垂直于转动轴 $e_k$ 的平面内的动力学特征值的平方。\n这个结果正确地恢复了欧拉陀螺的稳定性性质：如果 $I_k$ 是最大或最小的转动惯量，则 $(I_k - I_j)(I_k - I_l)$ 项为正，使得 $\\lambda^2  0$，这意味着虚数特征值和稳定振荡。如果 $I_k$ 是中间大小的转动惯量，则该项为负，使得 $\\lambda^2  0$，这意味着实数特征值和不稳定的鞍点平衡。",
            "answer": "$$\n\\boxed{- \\Omega^2 \\frac{(I_k - I_j)(I_k - I_l)}{I_j I_l}}\n$$"
        },
        {
            "introduction": "可积性的理论之美对数值模拟具有深远的实际影响。这项练习要求您比较一种标准数值方法（RK4）与一种几何积分方法（隐式中点法），观察它们如何处理系统的守恒量。通过研究在敏感的分界线区域附近的数值漂移，您将对结构保持算法在计算力学中的重要性获得实际的理解。",
            "id": "3748272",
            "problem": "考虑一个无力矩刚体（欧拉陀螺），其在特殊正交群的对偶空间 $\\mathfrak{so}(3)^{\\ast}$ 上演化。该刚体的体角动量为 $M \\in \\mathbb{R}^{3}$，对角惯性张量为 $I = \\operatorname{diag}(I_{1}, I_{2}, I_{3})$，且满足 $0  I_{1}  I_{2}  I_{3}$。其哈密顿量为 $H(M) = \\tfrac{1}{2} M \\cdot \\Omega$，其中 $\\Omega = I^{-1} M$。在物体坐标系中的运动方程为欧拉方程 $\\dot{M} = M \\times \\Omega = M \\times (I^{-1} M)$。这是一个李-泊松系统，其卡西米尔不变量为 $C(M) = \\tfrac{1}{2} \\lVert M \\rVert^{2}$。该系统因能量 $H$ 和卡西米尔不变量 $C$ 的存在而经典可积。分界线划分了性质不同的运动，并穿过对应于绕中间主轴 $e_{2}$ 旋转的鞍点平衡。对于固定的 $C$，分界线所处的能量值为 $H = C / I_{2}$。\n\n基于以上基本原理，您必须：\n- 推导数值积分欧拉方程的算法步骤，使用以下方法：\n  1) 经典的四阶龙格-库塔方法 (RK4)，以及\n  2) 隐式中点法，通过每步的牛顿迭代将其视为 $\\mathfrak{so}(3)^{\\ast}$ 上的泊松积分器。\n- 通过测量不变量漂移来量化分界线附近的数值敏感性。具体而言，对于给定的初始条件 $M(0)$、时间步长 $h$ 和终止时间 $T$，计算：\n  - 最大相对能量漂移 $\\max_{0 \\le t \\le T} \\left| H(M(t)) - H(M(0)) \\right| / \\left| H(M(0)) \\right|$，\n  - 最大相对卡西米尔不变量漂移 $\\max_{0 \\le t \\le T} \\left| C(M(t)) - C(M(0)) \\right| / \\left| C(M(0)) \\right|$，\n对两种积分器均进行计算。\n- 分析与分界线（绕 $e_{2}$ 轴的旋转）的接近程度如何影响数值误差的增长，以及可积性如何约束漂移，从而为步长控制提供参考。\n\n使用以下科学合理且自洽的参数化：\n- 惯性参数：$I_{1} = 1$, $I_{2} = 2$, $I_{3} = 3$ (无量纲)。\n- 初始角动量大小：$\\lVert M(0) \\rVert = 1$，因此 $C(M(0)) = \\tfrac{1}{2}$。\n- 角度必须以弧度为单位指定和解释。\n- 定义两族初始条件：\n  - $(e_{1}, e_{2})$ 平面内靠近分界线的条件：$M(0) = (\\sin \\varepsilon, \\cos \\varepsilon, 0)$，其中 $\\varepsilon$ 很小。\n  - 靠近稳定轴 $e_{3}$ 且远离分界线的条件：$M(0) = (0, \\sin \\varepsilon, \\cos \\varepsilon)$，其中 $\\varepsilon$ 为中等大小。\n- 时间范围：$T = 5$ (无量纲)。\n\n使用固定时间步长实现两种积分器，并对以下每个测试案例（角度以弧度为单位）评估漂移：\n1) 靠近分界线, $\\varepsilon = 10^{-1}$, $h = 10^{-2}$。\n2) 靠近分界线, $\\varepsilon = 10^{-3}$, $h = 10^{-2}$。\n3) 靠近分界线, $\\varepsilon = 10^{-6}$, $h = 10^{-2}$。\n4) 远离分界线，靠近 $e_{3}$, $\\varepsilon = 10^{-1}$, $h = 2 \\cdot 10^{-2}$。\n5) 靠近分界线, $\\varepsilon = 10^{-3}$, $h = 5 \\cdot 10^{-2}$。\n\n对于每个测试案例，按以下顺序计算并记录四个浮点数：\n- RK4 的最大相对能量漂移。\n- RK4 的最大相对卡西米尔不变量漂移。\n- 隐式中点法的最大相对能量漂移。\n- 隐式中点法的最大相对卡西米尔不变量漂移。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[r1,r2,r3,...]”）。该序列按上述顺序串联了所有五个测试案例的四个浮点数结果。由于所有量都是无量纲的，因此不需要物理单位，并且所有角度都必须以弧度处理。",
            "solution": "该问题要求对描述无力矩刚体运动的欧拉方程的两种数值积分方案进行比较分析。这是几何力学中的一个基本问题，分析的重点将是每种方法在保持系统不变量方面的表现，即哈密顿量 $H$（能量）和卡西米尔函数 $C$（角动量大小的平方）。\n\n系统的状态由物体固连坐标系中的角动量矢量 $M = (M_1, M_2, M_3) \\in \\mathbb{R}^3$ 给出。主转动惯量由对角张量 $I = \\operatorname{diag}(I_1, I_2, I_3)$ 给出，其给定值为 $I_1=1$, $I_2=2$ 和 $I_3=3$。运动方程为欧拉方程：\n$$\n\\dot{M} = M \\times \\Omega = M \\times (I^{-1}M)\n$$\n这定义了该常微分方程组的矢量场，$f(M) = M \\times (I^{-1}M)$。对于精确解，这些方程有两个守恒量：\n\n1. 哈密顿量，或动能，$H(M)$：\n$$\nH(M) = \\frac{1}{2} M \\cdot \\Omega = \\frac{1}{2} M \\cdot (I^{-1}M) = \\frac{1}{2} \\left( \\frac{M_1^2}{I_1} + \\frac{M_2^2}{I_2} + \\frac{M_3^2}{I_3} \\right)\n$$\n\n2. 卡西米尔函数，即角动量欧几里得范数平方的一半，$C(M)$：\n$$\nC(M) = \\frac{1}{2} \\lVert M \\rVert^2 = \\frac{1}{2} (M_1^2 + M_2^2 + M_3^2)\n$$\n对于任何精确解轨道 $M(t)$， $H(M(t))$ 和 $C(M(t))$ 都必须保持恒定。然而，数值积分器是近似方法，可能无法保持这些不变量，从而导致非物理漂移。我们将实现并比较两种方法：经典的四阶龙格-库塔方法和隐式中点法。\n\n**第一种积分器：四阶龙格-库塔 (RK4)**\n\nRK4 方法是一种广泛使用的、显式的、通用的求解器，用于求解形式为 $\\dot{y} = f(y)$ 的常微分方程。对于从状态 $M_n$ 到 $M_{n+1}$ 的大小为 $h$ 的单步，算法如下：\n$$\n\\begin{aligned}\nk_1 = f(M_n) \\\\\nk_2 = f(M_n + \\frac{h}{2} k_1) \\\\\nk_3 = f(M_n + \\frac{h}{2} k_2) \\\\\nk_4 = f(M_n + h k_3) \\\\\nM_{n+1} = M_n + \\frac{h}{6} (k_1 + 2k_2 + 2k_3 + k_4)\n\\end{aligned}\n$$\nRK4 以其在给定步长下的高精度而闻名（局部误差为 $O(h^5)$），但它不是几何积分器。它不尊重欧拉方程底层的李-泊松结构。因此，我们预计哈密顿量 $H$ 和卡西米尔不变量 $C$ 都会随时间表现出长期漂移，这意味着误差将系统性地累积。\n\n**第二种积分器：隐式中点法**\n\n隐式中点法是一种单步隐式龙格-库塔方法。单步由以下非线性方程定义：\n$$\nM_{n+1} = M_n + h f\\left(\\frac{M_n + M_{n+1}}{2}\\right)\n$$\n该方法是隐式的，因为未知数 $M_{n+1}$ 出现在方程的两边。要实现它，我们必须在每个时间步求解此方程以得到 $M_{n+1}$。我们可以使用牛顿法。令 $X = M_{n+1}$ 为待求解的变量。该方程可以写成寻找残差函数 $G(X)$ 的根：\n$$\nG(X) = X - M_n - h f\\left(\\frac{M_n + X}{2}\\right) = 0\n$$\n牛顿法通过更新规则 $X^{(k+1)} = X^{(k)} + \\Delta X^{(k)}$ 来迭代地优化初始猜测 $X^{(0)}$ (例如，$X^{(0)}=M_n$)，其中校正量 $\\Delta X^{(k)}$ 通过求解以下线性系统得到：\n$$\nJ_G(X^{(k)}) \\Delta X^{(k)} = -G(X^{(k)})\n$$\n这里，$J_G(X)$ 是 $G(X)$ 相对于 $X$ 的雅可比矩阵。该雅可比矩阵由下式给出：\n$$\nJ_G(X) = \\mathbb{I} - \\frac{h}{2} J_f\\left(\\frac{M_n + X}{2}\\right)\n$$\n其中 $\\mathbb{I}$ 是 $3 \\times 3$ 的单位矩阵，$J_f$ 是矢量场 $f(M) = M \\times (I^{-1}M)$ 的雅可比矩阵。这个雅可比矩阵可以使用表示与矢量 $v$ 的叉积的反对称矩阵 $[v]_\\times$ 优雅地表示：\n$$\nJ_f(M) = [M]_\\times I^{-1} - [I^{-1}M]_\\times\n$$\n隐式中点法的一个关键特性是它是一种几何积分器。对于此李-泊松系统，它是一个泊松积分器，这意味着它能精确地保持所有的卡西米尔函数。为了验证它对 $C(M)$ 的保持性，我们将中点法则与 $(M_{n+1} + M_n)$ 做点积：\n$$\n(M_{n+1} - M_n) \\cdot (M_{n+1} + M_n) = h f\\left(\\frac{M_n + M_{n+1}}{2}\\right) \\cdot (M_n + M_{n+1})\n$$\n令 $M_{mid} = \\frac{M_n + M_{n+1}}{2}$。方程变为：\n$$\n\\lVert M_{n+1} \\rVert^2 - \\lVert M_n \\rVert^2 = 2h (M_{mid} \\times (I^{-1}M_{mid})) \\cdot M_{mid}\n$$\n右侧为零，因为两个矢量的叉积与这两个矢量都正交。因此，$\\lVert M_{n+1} \\rVert^2 = \\lVert M_n \\rVert^2$，这意味着 $C(M_{n+1}) = C(M_n)$。对于该方法，在卡西米尔不变量中观察到的任何数值漂移都将归因于牛顿求解器的有限容差和浮点精度限制，而非方法本身。虽然哈密顿量 $H$ 没有被精确保持，但已知其误差在非常长的积分时间内是有界的，表现为振荡而不是长期漂移。\n\n**数值评估**\n\n我们将实现两种积分器，并在五个不同的测试案例中，通过改变初始条件 $M(0)$ 和步长 $h$，将系统从 $t=0$ 演化到 $T=5$。初始条件被选为靠近分界线（对应于绕中间轴 $e_2$ 的不稳定旋转）或远离分界线（靠近稳定轴 $e_3$）。我们测量两个不变量 $H$ 和 $C$ 的最大相对漂移，其定义为：\n$$\n\\Delta_H = \\max_{0 \\le t \\le T} \\frac{\\left| H(M(t)) - H(M(0)) \\right|}{\\left| H(M(0)) \\right|}, \\quad \\Delta_C = \\max_{0 \\le t \\le T} \\frac{\\left| C(M(t)) - C(M(0)) \\right|}{\\left| C(M(0)) \\right|}\n$$\n所提供的 Python 代码执行了这些步骤。它定义了系统动力学，实现了 RK4 和隐式中点求解器（使用牛顿-拉夫逊求根器），遍历了指定的测试案例，为每个案例计算了四个漂移指标，并按要求格式化输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Euler top problem by integrating the equations of motion\n    using RK4 and Implicit Midpoint methods, then calculates and prints\n    the drift of the Hamiltonian and Casimir invariants for a set of test cases.\n    \"\"\"\n\n    # --- System Definition ---\n    I = np.array([1.0, 2.0, 3.0])\n    I_inv = 1.0 / I\n\n    def euler_rhs(M):\n        \"\"\"Computes the right-hand side of the Euler equations: M x (I^-1 * M).\"\"\"\n        M = np.asarray(M)\n        Omega = I_inv * M\n        return np.cross(M, Omega)\n\n    def hamiltonian(M):\n        \"\"\"Computes the Hamiltonian H = 1/2 * M . (I^-1 * M).\"\"\"\n        M = np.asarray(M)\n        return 0.5 * np.dot(M, I_inv * M)\n\n    def casimir(M):\n        \"\"\"Computes the Casimir C = 1/2 * ||M||^2.\"\"\"\n        M = np.asarray(M)\n        return 0.5 * np.dot(M, M)\n\n    # --- Integrator Implementations ---\n\n    def rk4_step(M_n, h):\n        \"\"\"Performs a single step of the 4th-order Runge-Kutta method.\"\"\"\n        k1 = euler_rhs(M_n)\n        k2 = euler_rhs(M_n + h / 2.0 * k1)\n        k3 = euler_rhs(M_n + h / 2.0 * k2)\n        k4 = euler_rhs(M_n + h * k3)\n        return M_n + h / 6.0 * (k1 + 2 * k2 + 2 * k3 + k4)\n\n    def midpoint_step(M_n, h):\n        \"\"\"Performs a single step of the implicit midpoint method using Newton's method.\"\"\"\n        X = M_n.copy()  # Initial guess M_{n+1}^{(0)} = M_n\n        max_iter = 10\n        tol = 1e-14\n\n        for _ in range(max_iter):\n            M_mid = (M_n + X) / 2.0\n            f_mid = euler_rhs(M_mid)\n            \n            G = X - M_n - h * f_mid\n            if np.linalg.norm(G)  tol:\n                break\n\n            # Jacobian of G w.r.t. X\n            Omega_mid = I_inv * M_mid\n            \n            M_mid_skew = np.array([[0, -M_mid[2], M_mid[1]],\n                                   [M_mid[2], 0, -M_mid[0]],\n                                   [-M_mid[1], M_mid[0], 0]])\n            \n            Omega_mid_skew = np.array([[0, -Omega_mid[2], Omega_mid[1]],\n                                       [Omega_mid[2], 0, -Omega_mid[0]],\n                                       [-Omega_mid[1], Omega_mid[0], 0]])\n            \n            # J_f(M) = [M]_x @ I^-1 - [I^-1 M]_x\n            J_f_mid = M_mid_skew @ np.diag(I_inv) - Omega_mid_skew\n            \n            # J_G(X) = I - (h/2) * J_f(M_mid)\n            J_G = np.eye(3) - (h / 2.0) * J_f_mid\n            \n            delta_X = np.linalg.solve(J_G, -G)\n            X += delta_X\n        \n        return X\n\n    # --- Test Cases and Simulation ---\n    test_cases = [\n        # (is_near_separatrix, epsilon, h)\n        (True, 1e-1, 1e-2),\n        (True, 1e-3, 1e-2),\n        (True, 1e-6, 1e-2),\n        (False, 1e-1, 2e-2),\n        (True, 1e-3, 5e-2),\n    ]\n\n    all_results = []\n    T_final = 5.0\n\n    for is_near_sep, eps, h in test_cases:\n        num_steps = int(round(T_final / h))\n\n        # Initial conditions\n        if is_near_sep:\n            M0 = np.array([np.sin(eps), np.cos(eps), 0.0])\n        else:\n            M0 = np.array([0.0, np.sin(eps), np.cos(eps)])\n        \n        # Normalize to ensure ||M(0)|| = 1 precisely\n        M0 /= np.linalg.norm(M0)\n\n        H0 = hamiltonian(M0)\n        C0 = casimir(M0)\n\n        # --- RK4 Integration ---\n        M_rk4_hist = np.zeros((num_steps + 1, 3))\n        M_rk4_hist[0] = M0\n        M_current_rk4 = M0.copy()\n        for i in range(num_steps):\n            M_current_rk4 = rk4_step(M_current_rk4, h)\n            M_rk4_hist[i+1] = M_current_rk4\n\n        # --- Implicit Midpoint Integration ---\n        M_mid_hist = np.zeros((num_steps + 1, 3))\n        M_mid_hist[0] = M0\n        M_current_mid = M0.copy()\n        for i in range(num_steps):\n            M_current_mid = midpoint_step(M_current_mid, h)\n            M_mid_hist[i+1] = M_current_mid\n\n        # --- Drift Calculation ---\n        H_rk4_vals = np.array([hamiltonian(m) for m in M_rk4_hist])\n        C_rk4_vals = np.array([casimir(m) for m in M_rk4_hist])\n        \n        H_mid_vals = np.array([hamiltonian(m) for m in M_mid_hist])\n        C_mid_vals = np.array([casimir(m) for m in M_mid_hist])\n\n        drift_H_rk4 = np.max(np.abs(H_rk4_vals - H0)) / np.abs(H0)\n        drift_C_rk4 = np.max(np.abs(C_rk4_vals - C0)) / np.abs(C0)\n        \n        drift_H_mid = np.max(np.abs(H_mid_vals - H0)) / np.abs(H0)\n        drift_C_mid = np.max(np.abs(C_mid_vals - C0)) / np.abs(C0)\n        \n        all_results.extend([drift_H_rk4, drift_C_rk4, drift_H_mid, drift_C_mid])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6e}' for r in all_results)}]\")\n\nsolve()\n```"
        }
    ]
}