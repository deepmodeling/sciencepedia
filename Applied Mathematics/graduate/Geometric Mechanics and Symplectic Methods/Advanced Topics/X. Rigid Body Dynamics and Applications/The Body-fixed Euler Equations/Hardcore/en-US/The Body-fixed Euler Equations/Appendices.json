{
    "hands_on_practices": [
        {
            "introduction": "To begin our hands-on exploration, we first consider the simplest non-trivial case: a spherical rigid body. This problem invites you to derive and solve the Euler equations under a constant body torque, revealing how the system's perfect symmetry causes the internal gyroscopic term to vanish. This foundational exercise provides a clear baseline for understanding the full dynamics before tackling more complex, anisotropic bodies. ",
            "id": "3773474",
            "problem": "Consider a free rigid body whose attitude is described by a curve $R(t)$ in the Special Orthogonal group (SO(3)), with body angular velocity $\\omega(t)\\in\\mathbb{R}^{3}$ defined by the kinematic relation $\\dot{R}(t)=R(t)\\,\\widehat{\\omega}(t)$, where $\\widehat{\\omega}$ is the skew-symmetric matrix associated to $\\omega$ via the isomorphism $\\mathbb{R}^{3}\\cong\\mathfrak{so}(3)$. The body angular momentum is $M(t)\\in\\mathbb{R}^{3}$ and is related to $\\omega$ by the inertia operator $I:\\mathbb{R}^{3}\\to\\mathbb{R}^{3}$ via $M=I\\,\\omega$. Suppose the body is spherical with $I=\\lambda\\,\\mathbf{1}$ for some constant $\\lambda0$, and is subjected to a constant body torque $\\tau\\in\\mathbb{R}^{3}$ (that is, $\\tau$ is constant in body coordinates). Let the initial conditions be $R(0)=R_{0}\\in\\mathrm{SO}(3)$ and $M(0)=M_{0}\\in\\mathbb{R}^{3}$.\n\nStarting from the Lagrange-d'Alembert principle for a left-invariant kinetic energy on $\\mathrm{SO}(3)$ with work term due to a body torque, and using the identification $\\mathfrak{so}(3)\\cong\\mathbb{R}^{3}$ with the vector cross product, derive the body-fixed evolution equation for $M(t)$ under a body torque, and then solve it explicitly in the spherical case. In your analysis, explain why the coadjoint term vanishes for a spherical inertia, characterize the resulting $\\omega(t)$, describe how the kinetic energy evolves in time, and discuss the structure of $R(t)$ both in general and in the special case when $M_{0}$ and $\\tau$ are colinear.\n\nYour final answer must be the explicit closed-form expression for $M(t)$ in terms of $M_{0}$, $\\tau$, and $t$. No numerical evaluation is required, and no units should be reported in the final answer.",
            "solution": "This problem requires the derivation and solution of the equations of motion for a spherical rigid body subject to a constant body-fixed torque, starting from the Lagrange-d'Alembert principle within the framework of geometric mechanics.\n\nFirst, we validate the problem statement.\nThe givens are:\n- The configuration space is the Special Orthogonal group, $R(t) \\in \\mathrm{SO}(3)$.\n- The body angular velocity is $\\omega(t) \\in \\mathbb{R}^3$.\n- The kinematic equation is $\\dot{R}(t) = R(t)\\,\\widehat{\\omega}(t)$, where $\\widehat{\\cdot}: \\mathbb{R}^3 \\to \\mathfrak{so}(3)$ is the hat map defining the Lie algebra isomorphism.\n- The body angular momentum is $M(t) \\in \\mathbb{R}^3$, related to $\\omega(t)$ by the inertia operator $I$ via $M=I\\,\\omega$.\n- The body is spherical, so $I = \\lambda \\mathbf{1}$ for a scalar $\\lambda  0$.\n- There is a constant body-fixed torque $\\tau \\in \\mathbb{R}^3$.\n- The initial conditions are $R(0)=R_0$ and $M(0)=M_0$.\n\nThe problem is scientifically grounded in classical and geometric mechanics, is well-posed as an initial value problem, and is stated using objective, formal language. It is self-contained and consistent. Therefore, the problem is valid.\n\nWe begin by applying the Lagrange-d'Alembert principle. The system's Lagrangian is its kinetic energy, as there is no potential energy. For a rigid body, the kinetic energy is a left-invariant quadratic form on the tangent bundle $T\\mathrm{SO}(3)$. In body coordinates, this is given by:\n$$\nT = \\frac{1}{2} \\langle \\omega, I\\omega \\rangle\n$$\nHere, $\\langle \\cdot, \\cdot \\rangle$ denotes the standard inner product on $\\mathbb{R}^3$. The Lagrange-d'Alembert principle for a system with external forces is:\n$$\n\\delta \\int_{t_1}^{t_2} T(\\omega) \\, dt + \\int_{t_1}^{t_2} \\mathcal{W}(\\delta q) \\, dt = 0\n$$\nwhere $\\mathcal{W}$ is the virtual work done by non-conservative forces. A variation of the trajectory $R(t)$ can be expressed in the body frame by a curve $\\eta(t) \\in \\mathbb{R}^3$ such that the infinitesimal displacement is $\\delta R = R(t)\\widehat{\\eta}(t)$. The virtual work done by the body-fixed torque $\\tau$ for such a virtual displacement is $\\mathcal{W} = \\langle \\tau, \\eta \\rangle$. Note that $\\eta$ represents the virtual angular velocity of the displacement. The principle is thus:\n$$\n\\int_{t_1}^{t_2} \\left[ \\delta T(\\omega) + \\langle \\tau, \\eta \\rangle \\right] dt = 0\n$$\nThe variation of the kinetic energy is:\n$$\n\\delta T = \\frac{1}{2} \\delta \\langle \\omega, I\\omega \\rangle = \\langle \\delta\\omega, I\\omega \\rangle = \\langle M, \\delta\\omega \\rangle\n$$\nThe variation of the angular velocity, $\\delta\\omega$, is related to the variation parameter $\\eta$ by the formula for variations on Lie groups (the Euler-Poincaré variation formula):\n$$\n\\delta\\omega = \\dot{\\eta} + \\omega \\times \\eta\n$$\nSubstituting these into the principle gives:\n$$\n\\int_{t_1}^{t_2} \\left[ \\langle M, \\dot{\\eta} + \\omega \\times \\eta \\rangle + \\langle \\tau, \\eta \\rangle \\right] dt = 0\n$$\nWe integrate the term $\\langle M, \\dot{\\eta} \\rangle$ by parts:\n$$\n\\int_{t_1}^{t_2} \\langle M, \\dot{\\eta} \\rangle dt = \\left[ \\langle M, \\eta \\rangle \\right]_{t_1}^{t_2} - \\int_{t_1}^{t_2} \\langle \\dot{M}, \\eta \\rangle dt\n$$\nThe boundary term vanishes because variations $\\eta$ are taken to be zero at the endpoints, i.e., $\\eta(t_1) = \\eta(t_2) = 0$. Using the cyclic property of the scalar triple product, $\\langle M, \\omega \\times \\eta \\rangle = \\langle \\eta, M \\times \\omega \\rangle$. The integral becomes:\n$$\n\\int_{t_1}^{t_2} \\left[ - \\langle \\dot{M}, \\eta \\rangle + \\langle M \\times \\omega, \\eta \\rangle + \\langle \\tau, \\eta \\rangle \\right] dt = 0\n$$\n$$\n\\int_{t_1}^{t_2} \\langle -\\dot{M} + M \\times \\omega + \\tau, \\eta \\rangle dt = 0\n$$\nSince this must hold for any arbitrary smooth variation $\\eta(t)$ that vanishes at the endpoints, the expression inside the inner product must be zero. This yields the Euler-Poincaré equation for a rigid body with an external body torque:\n$$\n\\dot{M} = M \\times \\omega + \\tau\n$$\nThis equation, often written as $\\dot{M} + \\omega \\times M = \\tau$, is the general evolution equation for the body angular momentum $M$. The term $M \\times \\omega$ comes from the non-commutativity of rotations and is related to the coadjoint action of the Lie group on the dual of its Lie algebra.\n\nNow we specialize to the given spherical body. The inertia operator is $I = \\lambda \\mathbf{1}$, where $\\lambda  0$ is a constant. The relationship between momentum $M$ and angular velocity $\\omega$ becomes:\n$$\nM = I\\omega = \\lambda\\mathbf{1}\\omega = \\lambda\\omega\n$$\nThis implies that $\\omega = \\frac{1}{\\lambda}M$. For a spherical body, the body angular momentum and angular velocity are always parallel.\n\nWe substitute this relationship into the evolution equation:\n$$\n\\dot{M} = M \\times \\left(\\frac{1}{\\lambda}M\\right) + \\tau\n$$\nThe cross product of any vector with a scalar multiple of itself is zero: $M \\times (\\frac{1}{\\lambda}M) = \\frac{1}{\\lambda}(M \\times M) = 0$. The coadjoint term $M\\times \\omega$ vanishes precisely because of this collinearity, which is a unique feature of the spherical inertia tensor. Physically, a spherical body has no preferred axes of rotation, so there are no internal gyroscopic torques generated by the body's motion.\n\nThe evolution equation for the spherical body thus simplifies dramatically to:\n$$\n\\dot{M}(t) = \\tau\n$$\nSince the body torque $\\tau$ is given as constant, this is a simple first-order vector ordinary differential equation. We can integrate it directly with respect to time from $t=0$ to a general time $t$:\n$$\n\\int_{0}^{t} \\dot{M}(s) ds = \\int_{0}^{t} \\tau ds\n$$\n$$\nM(t) - M(0) = \\tau t\n$$\nUsing the initial condition $M(0) = M_0$, we find the explicit solution for the body angular momentum:\n$$\nM(t) = M_0 + t\\tau\n$$\n\nWe can now characterize $\\omega(t)$, the kinetic energy $T(t)$, and the attitude $R(t)$.\nThe angular velocity is $\\omega(t) = \\frac{1}{\\lambda}M(t)$, so:\n$$\n\\omega(t) = \\frac{1}{\\lambda}(M_0 + t\\tau)\n$$\nThe body angular velocity vector $\\omega(t)$ starts at $\\omega_0 = M_0/\\lambda$ and increases linearly with time in the constant direction of $\\tau$. The tip of the $\\omega(t)$ vector traces a straight line in the body frame.\n\nThe kinetic energy is $T = \\frac{1}{2}\\langle \\omega, M \\rangle = \\frac{1}{2\\lambda}\\|M\\|^2$. The evolution of the kinetic energy is:\n$$\nT(t) = \\frac{1}{2\\lambda} \\|M_0 + t\\tau\\|^2 = \\frac{1}{2\\lambda} \\langle M_0 + t\\tau, M_0 + t\\tau \\rangle\n$$\n$$\nT(t) = \\frac{1}{2\\lambda} \\left( \\|M_0\\|^2 + 2t\\langle M_0, \\tau \\rangle + t^2\\|\\tau\\|^2 \\right)\n$$\nThe kinetic energy is a quadratic function of time. Its rate of change is $\\dot{T}(t) = \\frac{1}{\\lambda} (\\langle M_0, \\tau \\rangle + t\\|\\tau\\|^2)$. This is equal to the power input from the torque, $P(t) = \\langle \\tau, \\omega(t) \\rangle = \\langle \\tau, \\frac{1}{\\lambda}(M_0 + t\\tau) \\rangle = \\frac{1}{\\lambda}(\\langle \\tau, M_0 \\rangle + t\\|\\tau\\|^2)$, which confirms the work-energy theorem.\n\nFinally, we discuss the structure of the attitude matrix $R(t)$. It is the solution to the kinematic initial value problem:\n$$\n\\dot{R}(t) = R(t)\\,\\widehat{\\omega}(t), \\quad R(0) = R_0\n$$\nIn the general case, the matrix generator $\\widehat{\\omega}(t) = \\frac{1}{\\lambda}(\\widehat{M_0} + t\\widehat{\\tau})$ is time-dependent. The solution cannot be written as a simple matrix exponential because the matrices $\\widehat{\\omega}(t_1)$ and $\\widehat{\\omega}(t_2)$ do not commute for different times $t_1, t_2$, unless $M_0$ and $\\tau$ are collinear. The commutator is $[\\widehat{\\omega}(t_1), \\widehat{\\omega}(t_2)] = \\widehat{\\omega(t_1) \\times \\omega(t_2)} = \\frac{1}{\\lambda^2}(t_1-t_2)\\widehat{M_0 \\times \\tau} \\neq 0$. The formal solution involves a time-ordered exponential, which does not generally have a simple closed form.\n\nIn the special case where $M_0$ and $\\tau$ are collinear (i.e., they are parallel or one is zero), the vector $M_0 \\times \\tau = 0$, so the commutator $[\\widehat{\\omega}(t_1), \\widehat{\\omega}(t_2)]$ is zero. In this case, the matrix exponential can be used:\n$$\nR(t) = R_0 \\exp\\left( \\int_0^t \\widehat{\\omega}(s) ds \\right)\n$$\nThe integrated angular velocity is:\n$$\n\\theta(t) = \\int_0^t \\omega(s) ds = \\int_0^t \\frac{1}{\\lambda}(M_0 + s\\tau) ds = \\frac{1}{\\lambda}\\left( tM_0 + \\frac{1}{2}t^2\\tau \\right)\n$$\nSince $M_0$ and $\\tau$ are collinear, $\\theta(t)$ is a vector that always points along their common direction. The solution is $R(t) = R_0 \\exp(\\widehat{\\theta(t)})$, which represents a rotation from the initial orientation $R_0$ about a fixed axis in the body frame (the direction of $\\tau$), with the angle of rotation being $\\|\\theta(t)\\|$, a quadratic function of time.\n\nThe problem asks for the explicit closed-form expression for $M(t)$. As derived above, this is a linear function of time.",
            "answer": "$$\n\\boxed{M(t) = M_{0} + t\\tau}\n$$"
        },
        {
            "introduction": "Building on the spherical case, we now investigate the richer dynamics of an anisotropic, or triaxial, rigid body. This practice challenges you to find the conditions for steady-state rotation under a constant torque, a scenario where the internal gyroscopic effects perfectly balance the external forcing. By solving this problem, you will uncover the crucial role of inertial anisotropy and the non-alignment of the angular velocity and momentum vectors in achieving dynamic equilibrium. ",
            "id": "3773453",
            "problem": "A rigid body with three distinct principal moments of inertia $I_1$, $I_2$, and $I_3$ about body-fixed orthonormal principal axes $\\{e_1,e_2,e_3\\}$ undergoes rotation with angular velocity $\\omega$ expressed in the body frame. Its body angular momentum is $M=I\\omega$, where $I=\\operatorname{diag}(I_1,I_2,I_3)$ in this basis. The body is subjected to a constant body-fixed torque $\\tau=\\tau_3 e_3$ with $\\tau_30$. Assume $I_1I_2I_3$ and that all quantities are smooth functions of time.\n\nStarting only from the Newton–Euler equation in the body frame,\n$$\n\\frac{dM}{dt}+\\omega\\times M=\\tau,\n$$\nperform the following tasks:\n\n- Derive the necessary and sufficient conditions for a steady state of uniform rotation in the body frame, meaning $\\omega$ is constant in the body frame and the motion is dynamically balanced under the constant body torque. Express these conditions purely in terms of the components of $\\omega$ and $I_1$, $I_2$, $I_3$, and characterize how the torque constrains the relative orientation of $M$ and $\\omega$ for anisotropic inertia (i.e., $I_1\\neq I_2\\neq I_3$). Your derivation should make explicit whether $M$ and $\\omega$ are aligned or not in such a steady state, and how this depends on the direction of the torque relative to the principal axes.\n\n- Among all such steady states with the given $\\tau=\\tau_3 e_3$ and $I_1I_2I_3$, determine the minimal possible kinetic energy\n$$\nT=\\frac{1}{2}\\,\\omega\\cdot M=\\frac{1}{2}\\left(I_1\\omega_1^2+I_2\\omega_2^2+I_3\\omega_3^2\\right),\n$$\nover all steady-state angular velocities $\\omega$ that satisfy the steady-state conditions you derived. Express your final answer as a closed-form analytic expression in terms of $I_1$, $I_2$, $I_3$, and $\\tau_3$.\n\nAnswer specification:\n- Provide your final answer as a single exact analytic expression.\n- No rounding is required, and no approximations are permitted.",
            "solution": "We begin from the Newton–Euler equation in the body frame,\n$$\n\\frac{dM}{dt}+\\omega\\times M=\\tau.\n$$\nA steady state of uniform rotation in the body frame means $\\omega$ is constant in the body frame. Since $M=I\\omega$ with $I$ constant in the body frame (principal axes), this implies $\\frac{dM}{dt}=0$. Therefore, the steady-state condition reduces to\n$$\n\\omega\\times M=\\tau.\n$$\nWriting $\\omega=(\\omega_1,\\omega_2,\\omega_3)$ and $M=(I_1\\omega_1,I_2\\omega_2,I_3\\omega_3)$ in the principal basis, we compute the cross product components:\n$$\n(\\omega\\times M)_1=(I_3-I_2)\\,\\omega_2\\omega_3,\\quad\n(\\omega\\times M)_2=(I_1-I_3)\\,\\omega_3\\omega_1,\\quad\n(\\omega\\times M)_3=(I_2-I_1)\\,\\omega_1\\omega_2.\n$$\nThe applied torque is $\\tau=(0,0,\\tau_3)$ with $\\tau_30$, so the steady-state equations are\n$$\n(I_3-I_2)\\,\\omega_2\\omega_3=0,\\qquad\n(I_1-I_3)\\,\\omega_3\\omega_1=0,\\qquad\n(I_2-I_1)\\,\\omega_1\\omega_2=\\tau_3.\n$$\nAssuming $I_1I_2I_3$ so that $I_1$, $I_2$, $I_3$ are pairwise distinct, the first two equations imply $\\omega_3=0$ (because neither $I_3-I_2$ nor $I_1-I_3$ is zero and we must allow $\\omega_1$ and $\\omega_2$ to be nonzero to generate the nonzero $\\tau_3$). Thus, steady states must satisfy\n$$\n\\omega_3=0,\\qquad (I_2-I_1)\\,\\omega_1\\omega_2=\\tau_3.\n$$\nThese are the necessary and sufficient conditions for a steady state under the given torque. In particular, $\\omega$ lies in the principal plane spanned by $e_1$ and $e_2$, and the product $\\omega_1\\omega_2$ is fixed by the torque magnitude and the difference $I_2-I_1$:\n$$\n\\omega_1\\omega_2=\\frac{\\tau_3}{I_2-I_1}.\n$$\nThis shows that $M$ and $\\omega$ are not aligned in this steady state unless one of $\\omega_1$ or $\\omega_2$ vanishes, which would force $\\tau_3=0$ by the last equation. Indeed,\n$$\nM=(I_1\\omega_1,I_2\\omega_2,0),\n$$\nso unless $I_1=I_2$ (which contradicts anisotropy) or one of $\\omega_1,\\omega_2$ is zero (which contradicts $\\tau_30$), $M$ and $\\omega$ are not colinear. The torque constrains their relative orientation via the requirement that $\\omega\\times M$ be along $e_3$ with magnitude $\\tau_3$, which is only possible if $\\omega$ and $M$ both lie in the plane orthogonal to the torque axis $e_3$ and are skewed relative to each other by the anisotropy $(I_1\\neq I_2)$. If the inertia were isotropic in that plane (i.e., $I_1=I_2$), then $(I_2-I_1)\\omega_1\\omega_2=0$ would preclude generating a nonzero $\\tau_3$ at steady state, so anisotropy is essential to support a nontrivial steady state under a constant body torque.\n\nNext we determine the minimal kinetic energy among all steady states. With $\\omega_3=0$ and $\\omega_1\\omega_2=\\tau_3/(I_2-I_1)$, the kinetic energy reduces to\n$$\nT=\\frac{1}{2}\\left(I_1\\omega_1^2+I_2\\omega_2^2\\right).\n$$\nWe minimize $T$ subject to the constraint $\\omega_1\\omega_2=c$, where\n$$\nc:=\\frac{\\tau_3}{I_2-I_1}.\n$$\nUsing the method of Lagrange multipliers, define\n$$\n\\mathcal{L}(\\omega_1,\\omega_2,\\lambda)=\\frac{1}{2}\\left(I_1\\omega_1^2+I_2\\omega_2^2\\right)-\\lambda\\left(\\omega_1\\omega_2-c\\right).\n$$\nStationarity yields\n$$\n\\frac{\\partial\\mathcal{L}}{\\partial\\omega_1}=I_1\\omega_1-\\lambda\\omega_2=0,\\qquad\n\\frac{\\partial\\mathcal{L}}{\\partial\\omega_2}=I_2\\omega_2-\\lambda\\omega_1=0,\\qquad\n\\frac{\\partial\\mathcal{L}}{\\partial\\lambda}=\\omega_1\\omega_2-c=0.\n$$\nFrom the first two equations, assuming $\\omega_1\\omega_2\\neq 0$, we obtain\n$$\n\\lambda^2=I_1 I_2,\\qquad \\omega_2=\\frac{I_1}{\\lambda}\\,\\omega_1.\n$$\nUsing the constraint $\\omega_1\\omega_2=c$ gives\n$$\n\\omega_1^2=\\frac{c}{\\lambda/I_1},\\qquad \\omega_2^2=\\frac{c}{\\lambda/I_2}.\n$$\nTo ensure $\\omega_1^20$ and $\\omega_2^20$ with $c0$ (since $\\tau_30$ and $I_2-I_10$), we choose $\\lambda=+\\sqrt{I_1 I_2}$, which yields\n$$\n\\omega_2=\\sqrt{\\frac{I_1}{I_2}}\\,\\omega_1,\\qquad\n\\omega_1^2=c\\,\\sqrt{\\frac{I_2}{I_1}},\\qquad\n\\omega_2^2=c\\,\\sqrt{\\frac{I_1}{I_2}}.\n$$\nSubstituting into $T$ gives\n$$\nT_{\\min}=\\frac{1}{2}\\left(I_1\\,c\\,\\sqrt{\\frac{I_2}{I_1}}+I_2\\,c\\,\\sqrt{\\frac{I_1}{I_2}}\\right)\n=\\frac{1}{2}\\left(c\\,\\sqrt{I_1 I_2}+c\\,\\sqrt{I_1 I_2}\\right)\n=c\\,\\sqrt{I_1 I_2}.\n$$\nRecalling $c=\\tau_3/(I_2-I_1)$, the minimal kinetic energy among all steady states is\n$$\nT_{\\min}=\\frac{\\tau_3\\,\\sqrt{I_1 I_2}}{I_2-I_1}.\n$$\nThis value is achieved by steady angular velocities with $\\omega_3=0$ and the ratio $\\omega_2/\\omega_1=\\sqrt{I_1/I_2}$, consistent with the anisotropic alignment: $\\omega$ and $M$ lie in the plane orthogonal to the torque axis, are not colinear, and are skewed just enough that their cross product yields the prescribed torque while minimizing energy.\n\nAs requested, the final result is an exact closed-form expression in terms of $I_1$, $I_2$, and $\\tau_3$.",
            "answer": "$$\\boxed{\\frac{\\tau_3\\,\\sqrt{I_1 I_2}}{I_2 - I_1}}$$"
        },
        {
            "introduction": "We now transition from analytical solutions to computational practice, a crucial skill in modern mechanics. This exercise tasks you with deriving and numerically implementing the Euler equations in two equivalent forms: a component-wise system and a compact vector formulation. By simulating the motion for various scenarios and comparing the results, you will gain hands-on experience with numerical integration and verify the theoretical equivalence of these mathematical descriptions. ",
            "id": "3773475",
            "problem": "Consider a freely rotating rigid body observed in its body frame, where the angular velocity is denoted by $\\boldsymbol{\\omega}(t)$ and the body-frame angular momentum is $\\mathbf{L}(t)=\\mathbf{I}\\boldsymbol{\\omega}(t)$. Here $\\mathbf{I}$ is the inertia tensor in the body frame, taken to be diagonal with respect to the principal axes as $\\mathbf{I}=\\mathrm{diag}(I_{1},I_{2},I_{3})$, and $\\boldsymbol{\\tau}(t)$ is the externally applied torque in the body frame. Starting from the balance of angular momentum and the kinematics of rotating frames, derive the body-fixed equations of motion for $\\boldsymbol{\\omega}(t)$ in two equivalent forms: (i) a componentwise set of ordinary differential equations (ODEs) aligned with the principal axes, and (ii) a compact vector form involving a cross product. Then implement both forms and numerically integrate them over time for the numerical test suite below. Quantitatively compare the two implementations by computing, for each test case, the maximum absolute componentwise difference between the angular velocities produced by the two integrations over the entire time interval.\n\nYour derivation must begin from fundamental laws and definitions only, such as the balance of angular momentum in the spatial frame and the transformation law for time derivatives between spatial and body frames. Do not assume or quote the target componentwise or cross product formulas; derive them from first principles.\n\nNumerical details and units:\n- Inertia parameters $I_{1}$, $I_{2}$, $I_{3}$ are given in $\\mathrm{kg}\\cdot\\mathrm{m}^{2}$.\n- Torque $\\boldsymbol{\\tau}(t)$ is in $\\mathrm{N}\\cdot\\mathrm{m}$.\n- Angular velocity $\\boldsymbol{\\omega}(t)$ is in $\\mathrm{rad/s}$.\n- Time $t$ is in $\\mathrm{s}$, and angles are in radians.\n\nIntegration requirements:\n- Use a standard numerical ODE integrator to compute $\\boldsymbol{\\omega}(t)$ for both formulations over the specified intervals with identical time sampling.\n- For each test case, sample the solution at $1001$ uniformly spaced time points on the closed interval $[0,T]$.\n- For each test case, compute the scalar quantity\n$$\n\\Delta = \\max_{0\\leq k \\leq 1000} \\max_{j\\in\\{1,2,3\\}} \\left|\\omega^{(\\mathrm{comp})}_{j}(t_{k}) - \\omega^{(\\mathrm{vec})}_{j}(t_{k})\\right|,\n$$\nwhere $\\boldsymbol{\\omega}^{(\\mathrm{comp})}(t)$ is the solution obtained from the componentwise ODEs and $\\boldsymbol{\\omega}^{(\\mathrm{vec})}(t)$ is the solution obtained from the vector cross product formulation. Express $\\Delta$ in $\\mathrm{rad/s}$, rounded to six significant figures.\n\nTest suite:\n- Case A (general anisotropic inertia, free rigid body):\n  - $\\mathbf{I}=\\mathrm{diag}(2.0,1.5,1.0)\\ \\mathrm{kg}\\cdot\\mathrm{m}^{2}$,\n  - $\\boldsymbol{\\tau}(t)=\\mathbf{0}\\ \\mathrm{N}\\cdot\\mathrm{m}$,\n  - $\\boldsymbol{\\omega}(0)=\\begin{bmatrix}2.0\\\\0.8\\\\-1.2\\end{bmatrix}\\ \\mathrm{rad/s}$,\n  - $T=2.5\\ \\mathrm{s}$.\n- Case B (constant torque about the third axis):\n  - $\\mathbf{I}=\\mathrm{diag}(3.0,2.0,1.0)\\ \\mathrm{kg}\\cdot\\mathrm{m}^{2}$,\n  - $\\boldsymbol{\\tau}(t)=\\begin{bmatrix}0.0\\\\0.0\\\\0.2\\end{bmatrix}\\ \\mathrm{N}\\cdot\\mathrm{m}$,\n  - $\\boldsymbol{\\omega}(0)=\\begin{bmatrix}0.1\\\\-0.2\\\\0.0\\end{bmatrix}\\ \\mathrm{rad/s}$,\n  - $T=5.0\\ \\mathrm{s}$.\n- Case C (near-symmetric in the first two axes, sinusoidal torque about the first axis):\n  - $\\mathbf{I}=\\mathrm{diag}(1.0,1.01,2.0)\\ \\mathrm{kg}\\cdot\\mathrm{m}^{2}$,\n  - $\\boldsymbol{\\tau}(t)=\\begin{bmatrix}0.5\\sin(2\\pi t)\\\\0.0\\\\0.0\\end{bmatrix}\\ \\mathrm{N}\\cdot\\mathrm{m}$,\n  - $\\boldsymbol{\\omega}(0)=\\begin{bmatrix}0.0\\\\1.0\\\\0.0\\end{bmatrix}\\ \\mathrm{rad/s}$,\n  - $T=3.0\\ \\mathrm{s}$.\n- Case D (isotropic inertia, free rigid body):\n  - $\\mathbf{I}=\\mathrm{diag}(1.5,1.5,1.5)\\ \\mathrm{kg}\\cdot\\mathrm{m}^{2}$,\n  - $\\boldsymbol{\\tau}(t)=\\mathbf{0}\\ \\mathrm{N}\\cdot\\mathrm{m}$,\n  - $\\boldsymbol{\\omega}(0)=\\begin{bmatrix}0.5\\\\-0.5\\\\1.0\\end{bmatrix}\\ \\mathrm{rad/s}$,\n  - $T=4.0\\ \\mathrm{s}$.\n\nProgram output specification:\n- Your program should produce a single line of output containing the results for Cases A–D as a comma-separated list enclosed in square brackets, with each entry equal to the value of $\\Delta$ for that case in $\\mathrm{rad/s}$, rounded to six significant figures (for example, `[1.23456e-7,3.21000e-8,...]`). The output must have the format: `[Δ_A,Δ_B,Δ_C,Δ_D]` with no additional text.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of classical rigid body dynamics, is well-posed with sufficient information for a unique solution, and is expressed in objective, formal language. The task involves a standard derivation of the Euler equations of motion followed by a numerical implementation and comparison, which is a standard exercise in computational mechanics.\n\n### Part 1: Derivation of the Body-Fixed Euler Equations\n\nOur derivation begins from two fundamental principles: the law of conservation of angular momentum as observed in an inertial frame, and the kinematic relationship for the time derivative of a vector between a rotating and an inertial frame.\n\nLet $S$ denote an inertial reference frame (the \"space\" frame) and $B$ denote a non-inertial reference frame fixed to the rotating body (the \"body\" frame). Let $\\mathbf{A}$ be an arbitrary vector. The time derivative of $\\mathbf{A}$ as observed in the space frame, $(\\frac{d\\mathbf{A}}{dt})_S$, is related to its time derivative as observed in the body frame, $(\\frac{d\\mathbf{A}}{dt})_B$, by the transport theorem:\n$$\n\\left(\\frac{d\\mathbf{A}}{dt}\\right)_S = \\left(\\frac{d\\mathbf{A}}{dt}\\right)_B + \\boldsymbol{\\omega} \\times \\mathbf{A}\n$$\nHere, $\\boldsymbol{\\omega}$ is the angular velocity vector of the body frame $B$ relative to the space frame $S$. For the remainder of this derivation, all vectors ($\\boldsymbol{\\omega}$, angular momentum $\\mathbf{L}$, torque $\\boldsymbol{\\tau}$) are expressed by their components in the body frame $B$, unless explicitly noted otherwise. The term $(\\frac{d\\mathbf{A}}{dt})_B$ represents the rate of change of the components of the vector $\\mathbf{A}$ in the body frame's basis, which we will denote with a dot, e.g., $\\dot{\\mathbf{A}}$.\n\nThe fundamental law of rotational dynamics (Newton's second law for rotation) states that the time rate of change of the angular momentum vector, $\\mathbf{L}_S$, in the inertial frame is equal to the net external torque, $\\boldsymbol{\\tau}_S$, applied to the body, as observed in the same inertial frame.\n$$\n\\left(\\frac{d\\mathbf{L}}{dt}\\right)_S = \\boldsymbol{\\tau}_S\n$$\nWe now apply the transport theorem to the angular momentum vector $\\mathbf{L}$:\n$$\n\\left(\\frac{d\\mathbf{L}}{dt}\\right)_S = \\dot{\\mathbf{L}} + \\boldsymbol{\\omega} \\times \\mathbf{L}\n$$\nThe torque vector $\\boldsymbol{\\tau}$ transforms between frames like any other vector. If $R(t)$ is the rotation matrix from the body frame to the space frame, then $\\boldsymbol{\\tau}_S(t) = R(t)\\boldsymbol{\\tau}(t)$. Equating the two expressions for $(\\frac{d\\mathbf{L}}{dt})_S$ and expressing the torque in body frame components yields:\n$$\n\\dot{\\mathbf{L}} + \\boldsymbol{\\omega} \\times \\mathbf{L} = \\boldsymbol{\\tau}\n$$\nThis is the general form of Euler's equations of motion in the body frame.\n\nThe angular momentum $\\mathbf{L}$ in the body frame is related to the angular velocity $\\boldsymbol{\\omega}$ by the inertia tensor $\\mathbf{I}$ (also in the body frame): $\\mathbf{L} = \\mathbf{I}\\boldsymbol{\\omega}$. Since the body frame is fixed to the body, the inertia tensor $\\mathbf{I}$ is constant in this frame. Therefore, its time derivative is zero, and we have $\\dot{\\mathbf{L}} = \\frac{d}{dt}(\\mathbf{I}\\boldsymbol{\\omega}) = \\mathbf{I}\\frac{d\\boldsymbol{\\omega}}{dt} = \\mathbf{I}\\dot{\\boldsymbol{\\omega}}$.\n\nSubstituting this into the general form gives:\n$$\n\\mathbf{I}\\dot{\\boldsymbol{\\omega}} + \\boldsymbol{\\omega} \\times (\\mathbf{I}\\boldsymbol{\\omega}) = \\boldsymbol{\\tau}\n$$\nThis is the desired **compact vector form (ii)** of the Euler equations. To obtain an ODE for $\\dot{\\boldsymbol{\\omega}}$, we can rearrange it as $\\dot{\\boldsymbol{\\omega}} = \\mathbf{I}^{-1} \\left( \\boldsymbol{\\tau} - \\boldsymbol{\\omega} \\times (\\mathbf{I}\\boldsymbol{\\omega}) \\right)$.\n\nTo derive the **componentwise form (i)**, we align the body frame's axes with the principal axes of inertia. In this basis, the inertia tensor $\\mathbf{I}$ is diagonal:\n$$\n\\mathbf{I} = \\begin{pmatrix} I_1  0  0 \\\\ 0  I_2  0 \\\\ 0  0  I_3 \\end{pmatrix}\n$$\nLet $\\boldsymbol{\\omega} = (\\omega_1, \\omega_2, \\omega_3)^T$ and $\\boldsymbol{\\tau} = (\\tau_1, \\tau_2, \\tau_3)^T$. We compute the terms in the vector equation.\nFirst, $\\mathbf{I}\\boldsymbol{\\omega} = (I_1\\omega_1, I_2\\omega_2, I_3\\omega_3)^T$.\nNext, the cross product term:\n$$\n\\boldsymbol{\\omega} \\times (\\mathbf{I}\\boldsymbol{\\omega}) = \\begin{pmatrix} \\omega_1 \\\\ \\omega_2 \\\\ \\omega_3 \\end{pmatrix} \\times \\begin{pmatrix} I_1\\omega_1 \\\\ I_2\\omega_2 \\\\ I_3\\omega_3 \\end{pmatrix} = \\begin{pmatrix} \\omega_2(I_3\\omega_3) - \\omega_3(I_2\\omega_2) \\\\ \\omega_3(I_1\\omega_1) - \\omega_1(I_3\\omega_3) \\\\ \\omega_1(I_2\\omega_2) - \\omega_2(I_1\\omega_1) \\end{pmatrix} = \\begin{pmatrix} (I_3 - I_2)\\omega_2\\omega_3 \\\\ (I_1 - I_3)\\omega_1\\omega_3 \\\\ (I_2 - I_1)\\omega_1\\omega_2 \\end{pmatrix}\n$$\nThe term $\\mathbf{I}\\dot{\\boldsymbol{\\omega}} = (I_1\\dot{\\omega}_1, I_2\\dot{\\omega}_2, I_3\\dot{\\omega}_3)^T$.\nSubstituting these into the vector equation $\\mathbf{I}\\dot{\\boldsymbol{\\omega}} + \\boldsymbol{\\omega} \\times (\\mathbf{I}\\boldsymbol{\\omega}) = \\boldsymbol{\\tau}$, we obtain the three component equations:\n$$\n\\begin{cases}\nI_1 \\dot{\\omega}_1 + (I_3 - I_2)\\omega_2\\omega_3 = \\tau_1 \\\\\nI_2 \\dot{\\omega}_2 + (I_1 - I_3)\\omega_1\\omega_3 = \\tau_2 \\\\\nI_3 \\dot{\\omega}_3 + (I_2 - I_1)\\omega_1\\omega_2 = \\tau_3\n\\end{cases}\n$$\nIsolating the time derivatives $\\dot{\\omega}_j$ gives the explicit system of first-order ODEs:\n$$\n\\begin{cases}\n\\dot{\\omega}_1 = \\frac{1}{I_1}\\left(\\tau_1 + (I_2 - I_3)\\omega_2\\omega_3\\right) \\\\\n\\dot{\\omega}_2 = \\frac{1}{I_2}\\left(\\tau_2 + (I_3 - I_1)\\omega_1\\omega_3\\right) \\\\\n\\dot{\\omega}_3 = \\frac{1}{I_3}\\left(\\tau_3 + (I_1 - I_2)\\omega_1\\omega_2\\right)\n\\end{cases}\n$$\nThis is the desired componentwise form (i).\n\n### Part 2: Numerical Implementation Plan\n\nThe numerical part of the problem requires solving the initial value problem for $\\dot{\\boldsymbol{\\omega}} = f(t, \\boldsymbol{\\omega})$ for each of the four test cases using both formulations.\n\n1.  **ODE Solvers:** We will implement two distinct functions for the right-hand side (RHS) of the ODE system $\\dot{\\boldsymbol{\\omega}} = f(t, \\boldsymbol{\\omega})$, corresponding to the two derived forms.\n    *   `euler_comp_rhs(t, w, I, tau_func)`: This function will implement the componentwise equations directly, taking the state vector `w`$=(\\omega_1, \\omega_2, \\omega_3)$, inertia tensor `I`$=(I_1, I_2, I_3)$, and a function `tau_func(t)` for the torque as input.\n    *   `euler_vec_rhs(t, w, I, tau_func)`: This function will implement the compact vector form $\\dot{\\boldsymbol{\\omega}} = \\mathbf{I}^{-1} \\left( \\boldsymbol{\\tau} - \\boldsymbol{\\omega} \\times (\\mathbf{I}\\boldsymbol{\\omega}) \\right)$. It will use NumPy's vector and matrix operations (`np.cross`, element-wise multiplication and division) for a concise implementation.\n\n2.  **Integration:** For each test case, we will use the `scipy.integrate.solve_ivp` function, which is a robust, adaptive-step ODE solver.\n    *   We will call `solve_ivp` twice, once for each RHS function (`euler_comp_rhs` and `euler_vec_rhs`), but with identical initial conditions $\\boldsymbol{\\omega}(0)$, time interval $[0, T]$, and integration tolerances.\n    *   To minimize numerical errors stemming from the integrator itself and to isolate the floating-point differences between the two RHS implementations, we will use strict relative and absolute tolerances (e.g., `rtol=1e-13`, `atol=1e-13`).\n    *   The solution will be evaluated at $1001$ uniformly spaced time points $t_k$ in $[0, T]$ using the `t_eval` argument of `solve_ivp`.\n\n3.  **Comparison:** After obtaining the two solution trajectories, $\\boldsymbol{\\omega}^{(\\mathrm{comp})}(t_k)$ and $\\boldsymbol{\\omega}^{(\\mathrm{vec})}(t_k)$, we will compute the required discrepancy metric $\\Delta$:\n    $$\n    \\Delta = \\max_{0\\leq k \\leq 1000} \\max_{j\\in\\{1,2,3\\}} \\left|\\omega^{(\\mathrm{comp})}_{j}(t_{k}) - \\omega^{(\\mathrm{vec})}_{j}(t_{k})\\right|\n    $$\n    This is equivalent to finding the maximum absolute value in the element-wise difference of the two solution arrays.\n\n4.  **Output:** The calculated $\\Delta$ for each of the four cases will be formatted to six significant figures in scientific notation and printed as a comma-separated list enclosed in square brackets.\n\nThis procedure will be encapsulated in a Python script adhering to the specified environment and output format.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef euler_comp_rhs(t, w, I, tau_func):\n    \"\"\"\n    Computes the RHS of the Euler equations in component-wise form.\n    dot(w) = f(t, w)\n    \"\"\"\n    I1, I2, I3 = I\n    w1, w2, w3 = w\n    tau = tau_func(t)\n    tau1, tau2, tau3 = tau\n\n    dw1_dt = (tau1 + (I2 - I3) * w2 * w3) / I1\n    dw2_dt = (tau2 + (I3 - I1) * w1 * w3) / I2\n    dw3_dt = (tau3 + (I1 - I2) * w1 * w2) / I3\n\n    return np.array([dw1_dt, dw2_dt, dw3_dt])\n\ndef euler_vec_rhs(t, w, I_vec, tau_func):\n    \"\"\"\n    Computes the RHS of the Euler equations in vector form.\n    dot(w) = I_inv * (tau - w x (I*w))\n    \"\"\"\n    tau = tau_func(t)\n    # Since I is diagonal, I*w is element-wise multiplication\n    Iw = I_vec * w\n    # I_inv is also diagonal, so I_inv * vector is element-wise division\n    dw_dt = (tau - np.cross(w, Iw)) / I_vec\n    return dw_dt\n\ndef format_to_6_sf(n):\n    \"\"\"\n    Formats a number to 6 significant figures in scientific notation.\n    e.g., 1.234567e-8 -> 1.23457e-08.\n    The precision for 'e' format is (number of significant figures - 1).\n    \"\"\"\n    if n == 0.0:\n        return \"0.00000e+00\"\n    return f\"{n:.5e}\"\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run simulations, and print results.\n    \"\"\"\n    test_cases = [\n        {\n            \"name\": \"A\",\n            \"I\": np.array([2.0, 1.5, 1.0]),\n            \"tau_func\": lambda t: np.zeros(3),\n            \"w0\": np.array([2.0, 0.8, -1.2]),\n            \"T\": 2.5,\n        },\n        {\n            \"name\": \"B\",\n            \"I\": np.array([3.0, 2.0, 1.0]),\n            \"tau_func\": lambda t: np.array([0.0, 0.0, 0.2]),\n            \"w0\": np.array([0.1, -0.2, 0.0]),\n            \"T\": 5.0,\n        },\n        {\n            \"name\": \"C\",\n            \"I\": np.array([1.0, 1.01, 2.0]),\n            \"tau_func\": lambda t: np.array([0.5 * np.sin(2.0 * np.pi * t), 0.0, 0.0]),\n            \"w0\": np.array([0.0, 1.0, 0.0]),\n            \"T\": 3.0,\n        },\n        {\n            \"name\": \"D\",\n            \"I\": np.array([1.5, 1.5, 1.5]),\n            \"tau_func\": lambda t: np.zeros(3),\n            \"w0\": np.array([0.5, -0.5, 1.0]),\n            \"T\": 4.0,\n        },\n    ]\n\n    results = []\n    num_points = 1001\n    # Use tight tolerances to minimize integrator error and isolate\n    # floating-point differences between the two RHS function implementations.\n    rtol = 1e-13\n    atol = 1e-13\n\n    for case in test_cases:\n        I = case['I']\n        tau_func = case['tau_func']\n        w0 = case['w0']\n        T = case['T']\n        \n        t_span = [0, T]\n        t_eval = np.linspace(0, T, num_points)\n\n        # Integrate component-wise formulation\n        sol_comp = solve_ivp(\n            euler_comp_rhs, t_span, w0, args=(I, tau_func),\n            t_eval=t_eval, rtol=rtol, atol=atol, method='RK45'\n        )\n        omega_comp = sol_comp.y\n        \n        # Integrate vector formulation\n        sol_vec = solve_ivp(\n            euler_vec_rhs, t_span, w0, args=(I, tau_func),\n            t_eval=t_eval, rtol=rtol, atol=atol, method='RK45'\n        )\n        omega_vec = sol_vec.y\n\n        # Calculate the maximum absolute componentwise difference\n        delta = np.max(np.abs(omega_comp - omega_vec))\n        \n        results.append(delta)\n\n    # Format results as specified\n    formatted_results = [format_to_6_sf(r) for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}