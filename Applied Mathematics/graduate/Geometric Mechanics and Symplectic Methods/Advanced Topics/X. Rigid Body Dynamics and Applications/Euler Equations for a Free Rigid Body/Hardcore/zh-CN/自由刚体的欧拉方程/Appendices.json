{
    "hands_on_practices": [
        {
            "introduction": "几何力学的优雅之处在于其能从基本结构中推导出动力学方程。本练习提供了这一原理的直接应用，将引导您从 $\\mathfrak{so}(3)^{\\ast}$ 上的李-泊松（Lie-Poisson）括号和动能哈密顿量出发，推导出著名的刚体欧拉方程。此实践旨在巩固抽象几何框架与具体物理运动方程之间的联系。",
            "id": "3748149",
            "problem": "考虑一个自由刚体（欧拉陀螺），其主转动惯量 $I_{1}$、$I_{2}$ 和 $I_{3}$ 互不相同，在物体坐标系中的特殊正交群 $\\operatorname{SO}(3)$ 上演化。设物体角动量为 $M = (M_{1}, M_{2}, M_{3}) \\in \\mathfrak{so}(3)^{\\ast}$，物体角速度为 $\\Omega = (\\Omega_{1}, \\Omega_{2}, \\Omega_{3}) \\in \\mathbb{R}^{3}$，它们之间的关系为 $M = \\mathbb{I}\\Omega$，其中 $\\mathbb{I} = \\operatorname{diag}(I_{1}, I_{2}, I_{3})$。其动力学在李代数的对偶空间 $\\mathfrak{so}(3)^{\\ast}$ 上是哈密顿的，对于光滑函数 $F, G : \\mathfrak{so}(3)^{\\ast} \\to \\mathbb{R}$，李-泊松括号（LP括号）定义为\n$$\n\\{F, G\\}(M) = -\\,M \\cdot \\big(\\nabla F(M) \\times \\nabla G(M)\\big),\n$$\n哈密顿量为\n$$\nH(M) = \\tfrac{1}{2}\\,\\Omega \\cdot M = \\tfrac{1}{2}\\,M \\cdot \\mathbb{I}^{-1}M.\n$$\n从这些定义出发，推导坐标函数 $M_{i}$（$i \\in \\{1,2,3\\}$）的哈密顿运动方程，并用 $M$ 的分量和主转动惯量 $I_{1}, I_{2}, I_{3}$ 计算时间导数 $\\frac{d}{dt}(M_{i})$。通过将 $\\frac{d}{dt}(M_{i})$ 完全用 $M_{j}$ 和 $I_{k}$ 表示，明确验证各分量如何通过惯量耦合。\n\n将最终答案表示为一个包含三个分量表达式 $\\frac{d}{dt}(M_{1})$、$\\frac{d}{dt}(M_{2})$ 和 $\\frac{d}{dt}(M_{3})$ 的单行矩阵。不需要进行数值计算，也不需要包含单位。",
            "solution": "首先根据既定标准对问题进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **系统**：一个自由刚体（欧拉陀螺）。\n- **主转动惯量**：$I_{1}$、$I_{2}$ 和 $I_{3}$（互不相同）。\n- **物体角动量**：$M = (M_{1}, M_{2}, M_{3}) \\in \\mathfrak{so}(3)^{\\ast}$。\n- **物体角速度**：$\\Omega = (\\Omega_{1}, \\Omega_{2}, \\Omega_{3}) \\in \\mathbb{R}^{3}$。\n- **M 与 $\\Omega$ 之间的关系**：$M = \\mathbb{I}\\Omega$，其中 $\\mathbb{I} = \\operatorname{diag}(I_{1}, I_{2}, I_{3})$。\n- **李-泊松括号**：对于光滑函数 $F, G : \\mathfrak{so}(3)^{\\ast} \\to \\mathbb{R}$，括号定义为 $\\{F, G\\}(M) = -\\,M \\cdot \\big(\\nabla F(M) \\times \\nabla G(M)\\big)$。\n- **哈密顿量**：$H(M) = \\tfrac{1}{2}\\,\\Omega \\cdot M = \\tfrac{1}{2}\\,M \\cdot \\mathbb{I}^{-1}M$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题描述了欧拉陀螺在李代数 $\\operatorname{SO}(3)$ 对偶空间上的哈密顿表述。所提供的哈密顿量是动能，而李-泊松括号是 $\\mathfrak{so}(3)^{\\ast}$ 上的标准括号。此表述是几何力学的基石。因此，该问题是科学上合理的。\n- **适定性**：该问题提供了推导运动方程所需的所有必要定义和方程。它要求进行一个由给定条件唯一确定的特定计算。\n- **客观性**：该问题使用精确的数学语言陈述，没有任何主观或模糊的术语。\n- **缺陷检查**：\n  1. **科学/事实不准确性**：无。其物理学和数学是标准且正确的。\n  2. **非形式化/不相关**：无。该问题是指定领域的核心练习。\n  3. **设置不完整/矛盾**：无。所有定义均已提供且相互一致。\n  4. **不切实际/不可行**：无。这是一个标准的、具有物理意义的模型。\n  5. **不适定/结构不良**：无。推导过程得出了一个唯一的、定义明确的结果。\n  6. **故作高深/琐碎**：无。该推导是一个基础计算，展示了李-泊松形式体系的应用。\n  7. **超出科学可验证范围**：无。该推导是一个数学证明。\n\n**步骤3：结论与行动**\n此问题**有效**。继续进行求解。\n\n### 运动方程的推导\n\n相空间 $\\mathfrak{so}(3)^{\\ast}$ 上任意可观测量 $F(M)$ 的时间演化由哈密顿方程决定：\n$$\n\\frac{dF}{dt} = \\{F, H\\}\n$$\n其中 $H$ 是哈密顿量，$\\{\\cdot, \\cdot\\}$ 是李-泊松括号。我们的任务是找到角动量矢量分量 $M_i$ 的运动方程。这对应于将可观测量 $F$ 分别设为坐标函数 $M_1$、$M_2$ 和 $M_3$。\n\n李-泊松括号由下式给出：\n$$\n\\{F, G\\}(M) = -M \\cdot \\left(\\nabla F(M) \\times \\nabla G(M)\\right)\n$$\n此处，$\\nabla$ 是关于坐标 $M = (M_1, M_2, M_3)$ 的梯度，即 $\\nabla = \\left(\\frac{\\partial}{\\partial M_1}, \\frac{\\partial}{\\partial M_2}, \\frac{\\partial}{\\partial M_3}\\right)$。\n\n我们需要计算 $\\frac{dM_i}{dt} = \\{M_i, H\\}$，其中 $i \\in \\{1, 2, 3\\}$。这需要计算函数 $M_i$ 和哈密顿量 $H$ 的梯度。\n\n首先，我们求哈密顿量 $H$ 的梯度。哈密顿量由下式给出：\n$$\nH(M) = \\frac{1}{2} M \\cdot \\mathbb{I}^{-1}M = \\frac{1}{2} \\left( \\frac{M_1^2}{I_1} + \\frac{M_2^2}{I_2} + \\frac{M_3^2}{I_3} \\right)\n$$\n梯度 $\\nabla H$ 是一个矢量，其分量是 $H$ 对每个 $M_i$ 的偏导数：\n$$\n\\frac{\\partial H}{\\partial M_1} = \\frac{M_1}{I_1}, \\quad \\frac{\\partial H}{\\partial M_2} = \\frac{M_2}{I_2}, \\quad \\frac{\\partial H}{\\partial M_3} = \\frac{M_3}{I_3}\n$$\n因此，梯度矢量为：\n$$\n\\nabla H = \\left( \\frac{M_1}{I_1}, \\frac{M_2}{I_2}, \\frac{M_3}{I_3} \\right) = \\mathbb{I}^{-1}M = \\Omega\n$$\n\n接下来，我们计算坐标函数 $F = M_i$ 的梯度。\n对于 $F = M_1$：\n$$\n\\nabla M_1 = \\left(\\frac{\\partial M_1}{\\partial M_1}, \\frac{\\partial M_1}{\\partial M_2}, \\frac{\\partial M_1}{\\partial M_3}\\right) = (1, 0, 0) = \\mathbf{e}_1\n$$\n同理，$\\nabla M_2 = \\mathbf{e}_2$ 且 $\\nabla M_3 = \\mathbf{e}_3$。\n\n现在我们可以计算每个分量 $M_i$ 的时间导数。\n\n**对于 $M_1$：**\n$$\n\\frac{dM_1}{dt} = \\{M_1, H\\} = -M \\cdot (\\nabla M_1 \\times \\nabla H)\n$$\n我们计算叉积：\n$$\n\\nabla M_1 \\times \\nabla H = \\mathbf{e}_1 \\times \\Omega = (1, 0, 0) \\times \\left(\\frac{M_1}{I_1}, \\frac{M_2}{I_2}, \\frac{M_3}{I_3}\\right) = \\left(0, -\\frac{M_3}{I_3}, \\frac{M_2}{I_2}\\right)\n$$\n现在，我们与 $-M$ 求点积：\n$$\n\\frac{dM_1}{dt} = -(M_1, M_2, M_3) \\cdot \\left(0, -\\frac{M_3}{I_3}, \\frac{M_2}{I_2}\\right) = -\\left( M_2 \\left(-\\frac{M_3}{I_3}\\right) + M_3 \\left(\\frac{M_2}{I_2}\\right) \\right)\n$$\n$$\n\\frac{dM_1}{dt} = -\\left( -\\frac{M_2 M_3}{I_3} + \\frac{M_2 M_3}{I_2} \\right) = M_2 M_3 \\left(\\frac{1}{I_3} - \\frac{1}{I_2}\\right)\n$$\n\n**对于 $M_2$：**\n$$\n\\frac{dM_2}{dt} = \\{M_2, H\\} = -M \\cdot (\\nabla M_2 \\times \\nabla H)\n$$\n叉积为：\n$$\n\\nabla M_2 \\times \\nabla H = \\mathbf{e}_2 \\times \\Omega = (0, 1, 0) \\times \\left(\\frac{M_1}{I_1}, \\frac{M_2}{I_2}, \\frac{M_3}{I_3}\\right) = \\left(\\frac{M_3}{I_3}, 0, -\\frac{M_1}{I_1}\\right)\n$$\n与 $-M$ 求点积：\n$$\n\\frac{dM_2}{dt} = -(M_1, M_2, M_3) \\cdot \\left(\\frac{M_3}{I_3}, 0, -\\frac{M_1}{I_1}\\right) = -\\left( M_1 \\left(\\frac{M_3}{I_3}\\right) + M_3 \\left(-\\frac{M_1}{I_1}\\right) \\right)\n$$\n$$\n\\frac{dM_2}{dt} = -\\left( \\frac{M_1 M_3}{I_3} - \\frac{M_1 M_3}{I_1} \\right) = M_1 M_3 \\left(\\frac{1}{I_1} - \\frac{1}{I_3}\\right)\n$$\n\n**对于 $M_3$：**\n$$\n\\frac{dM_3}{dt} = \\{M_3, H\\} = -M \\cdot (\\nabla M_3 \\times \\nabla H)\n$$\n叉积为：\n$$\n\\nabla M_3 \\times \\nabla H = \\mathbf{e}_3 \\times \\Omega = (0, 0, 1) \\times \\left(\\frac{M_1}{I_1}, \\frac{M_2}{I_2}, \\frac{M_3}{I_3}\\right) = \\left(-\\frac{M_2}{I_2}, \\frac{M_1}{I_1}, 0\\right)\n$$\n与 $-M$ 求点积：\n$$\n\\frac{dM_3}{dt} = -(M_1, M_2, M_3) \\cdot \\left(-\\frac{M_2}{I_2}, \\frac{M_1}{I_1}, 0\\right) = -\\left( M_1 \\left(-\\frac{M_2}{I_2}\\right) + M_2 \\left(\\frac{M_1}{I_1}\\right) \\right)\n$$\n$$\n\\frac{dM_3}{dt} = -\\left( -\\frac{M_1 M_2}{I_2} + \\frac{M_1 M_2}{I_1} \\right) = M_1 M_2 \\left(\\frac{1}{I_2} - \\frac{1}{I_1}\\right)\n$$\n\n这些是自由刚体的欧拉运动方程，以物体坐标系中角动量分量 $M_i$ 和主转动惯量 $I_k$ 表示。分量之间的耦合通过另外两个动量分量的乘积以及逆转动惯量的差值明确地显示出来。\n\n最终结果是关于 $\\frac{d}{dt}(M_i)$ 的三个表达式的集合。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} M_{2}M_{3}\\left(\\frac{1}{I_{3}} - \\frac{1}{I_{2}}\\right)  M_{1}M_{3}\\left(\\frac{1}{I_{1}} - \\frac{1}{I_{3}}\\right)  M_{1}M_{2}\\left(\\frac{1}{I_{2}} - \\frac{1}{I_{1}}\\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在建立了运动方程之后，我们下一步将通过分析定常转动的稳定性来探究其行为。本练习将深入探讨刚体动力学中的一个基石——中间轴定理，并运用能量-卡西米尔（Energy-Casimir）方法这一精巧工具。您将通过考察限制在余伴随轨道上的哈密顿量的定性，来判断围绕各主轴转动的稳定性，从而为观察到的动力学现象提供深刻的几何解释。",
            "id": "3740955",
            "problem": "考虑一个自由刚体，其主转动惯量 $I_{1}$、$I_{2}$、$I_{3}$ 互不相同，满足 $0  I_3  I_2  I_1$。其动力学由李代数的对偶空间 $\\mathfrak{so}(3)^{\\ast}$ 上的李-泊松方程描述，哈密顿量 $h(m) = \\tfrac{1}{2} m \\cdot \\mathbb{I}^{-1}m$（动能）和卡西米尔函数 $C(m) = \\tfrac{1}{2} m \\cdot m$（角动量范数的平方的一半）。定常转动（平衡点）是纯粹绕主轴的转动。利用能量-卡西米尔方法来研究这些平衡点的稳定性。该方法要求研究哈密顿量 $h$ 在由卡西米尔函数固定的水平集（在本例中为半径为 $R$ 的球面 $S^2_R$）上的临界点。一个平衡点 $m_e$ 是稳定的，如果它是 $h$ 在 $S^2_R$ 上的局部极小值或极大值；如果它是鞍点，则是不稳定的。这等同于检查 $h$ 在 $S^2_R$ 上的受限黑塞矩阵在 $m_e$ 处的定性。对于绕轴 $i$ 的平衡点 $m_e = (0, \\dots, R, \\dots, 0)$，受限黑塞矩阵的两个特征值 $\\lambda_{H,a}$ 和 $\\lambda_{H,b}$ 由下式给出：\n$$\n\\lambda_{H,a} = \\frac{1}{I_a} - \\frac{1}{I_i} \\quad \\text{和} \\quad \\lambda_{H,b} = \\frac{1}{I_b} - \\frac{1}{I_i},\n$$\n其中 $a$ 和 $b$ 是垂直于 $i$ 的另外两个主轴的索引。根据 $I_3  I_2  I_1$ 的排序，对绕三个主轴（1、2、3）的每个平衡点，确定受限黑塞矩阵特征值的符号。\n\n将你的答案表示为一个包含六个条目的单行矩阵，这六个条目对应于绕轴1旋转的 $(\\lambda_{H,2}, \\lambda_{H,3})$，绕轴2旋转的 $(\\lambda_{H,1}, \\lambda_{H,3})$，以及绕轴3旋转的 $(\\lambda_{H,1}, \\lambda_{H,2})$ 的符号。使用 `+1` 表示正，`-1` 表示负。例如，如果对于绕轴1的旋转，两个特征值都是正的，则前两个条目为 `+1, +1`。",
            "solution": "【此题解不完整。以下为求解思路。】\n- 撰写一个自洽且逻辑连贯的叙述。\n- 声明验证结论：该问题在几何力学中是适定且标准的问题，因此是有效的。\n- **第1步：平衡点。** 从李-泊松括号和哈密顿量推导欧拉方程。求解 $\\dot{m}=0$。证明这表明平衡点 $m_e$ 与一个主轴对齐。列出球面 $S^2_R$ 上的6个平衡点。\n- **第2步：受限黑塞矩阵。** 引入拉格朗日函数 $L(m, \\lambda) = h(m) - \\lambda C(m)$。解释受限黑塞矩阵是在切空间 $T_{m_e}S^2_R$ 上计算的 $L$ 的黑塞矩阵。对三个主轴中的每一个进行计算，确定拉格朗日乘子 $\\lambda$、切空间的基，以及得到的 $2 \\times 2$ 受限黑塞矩阵及其特征值。\n- **第3步：线性化与稳定性。** 将欧拉方程在每个主轴的平衡点附近进行线性化。推导横向动力学的 $2 \\times 2$ 矩阵。求其特征值 $\\sigma$。通过关系式 $\\sigma^2 = -R^2 \\lambda_{H,a} \\lambda_{H,b}$ 将线性化动力学与黑塞矩阵的特征值联系起来。根据惯量排序 $I_1 > I_2 > I_3$ 讨论每个轴上 $\\sigma^2$ 的符号，从而得出结论：轴1和轴3是稳定的，轴2是不稳定的。这满足了问题的所有要求。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -1  -1  1  -1  1  1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "理论分析揭示了解的性质，而数值模拟则使其栩栩如生并暴露出实践中的挑战。这项计算练习要求您实现标准的数值积分器来求解欧拉方程，让您亲眼观察理论所预测的不稳定性。此外，您还将研究几何积分的一个关键方面：非几何方法在多大程度上能够保持系统的基本不变量，即卡西米尔（Casimir）不变量。",
            "id": "3776192",
            "problem": "考虑在物体坐标系下的自由刚体，其模型为一个在特殊正交群李代数的对偶空间（记为 $\\mathfrak{so}(3)^{\\ast}$）上的李-泊松系统。设刚体角动量为 $M \\in \\mathbb{R}^{3}$，对角惯性张量为 $I = \\mathrm{diag}(I_{1}, I_{2}, I_{3})$ 且其元素严格为正，刚体角速度为 $\\omega = I^{-1} M$。在物体坐标系中，自由刚体的演化方程（欧拉方程）由以下常微分方程（ODE）给出\n$$\n\\dot{M} = M \\times \\omega = M \\times (I^{-1} M),\n$$\n这是一个李-泊松系统，其哈密顿量为 $H(M) = \\tfrac{1}{2} M \\cdot I^{-1} M$，对于光滑函数 $F,G : \\mathbb{R}^{3} \\to \\mathbb{R}$，其泊松括号为 $\\{F,G\\}(M) = -M \\cdot (\\nabla F \\times \\nabla G)$。该李-泊松系统的一个基本不变量（卡西米尔不变量）是角动量范数的平方 $C(M) = \\tfrac{1}{2} \\|M\\|^{2}$。\n\n你的任务是编写一个完整、可运行的程序，该程序能够：\n- 使用两种固定步长方法数值积分该 ODE：显式欧拉法和经典的四阶龙格-库塔法（RK4）。\n- 对于每种方法和步长，通过量化 $\\|M\\|$ 中由离散化引起的漂移，来数值验证在精确动力学下 $\\|M(t)\\|$ 保持恒定。\n- 通过报告每个测试用例在整个仿真过程中范数与其初始值的最大相对偏差，来评估对离散化误差的敏感性。\n\n在无量纲单位下进行计算。对于由数值方法在时间区间 $[0,T]$ 上以固定步长 $h$ 计算出的给定轨迹 $M_{0}, M_{1}, \\dots, M_{N}$，将最大相对范数漂移定义为\n$$\n\\Delta = \\max_{0 \\leq n \\leq N} \\frac{\\big|\\|M_{n}\\| - \\|M_{0}\\|\\big|}{\\|M_{0}\\|}.\n$$\n\n将两种方法实现为固定步长积分器：\n- 显式欧拉法：$M_{n+1} = M_{n} + h f(M_{n})$，其中 $f(M) = M \\times (I^{-1} M)$。\n- 使用 $f(M)$ 和常规 Butcher 算表的经典 RK4 法。\n\n测试套件：\n为以下八个测试用例中的每一个计算 $\\Delta$。每个用例由惯性分量 $(I_{1}, I_{2}, I_{3})$、初始动量分量 $(M_{0x}, M_{0y}, M_{0z})$、总时间 $T$、固定时间步长 $h$ 以及要使用的数值方法（“euler”或“rk4”）指定。\n\n1. $(I_{1},I_{2},I_{3}) = (1.0, 1.5, 2.0)$, $(M_{0x}, M_{0y}, M_{0z}) = (0.3, 0.4, 0.5)$, $T = 5.0$, $h = 1\\times 10^{-3}$, method = \"rk4\"。\n2. $(I_{1},I_{2},I_{3}) = (1.0, 1.5, 2.0)$, $(M_{0x}, M_{0y}, M_{0z}) = (0.3, 0.4, 0.5)$, $T = 5.0$, $h = 5\\times 10^{-3}$, method = \"rk4\"。\n3. $(I_{1},I_{2},I_{3}) = (1.0, 1.5, 2.0)$, $(M_{0x}, M_{0y}, M_{0z}) = (0.3, 0.4, 0.5)$, $T = 5.0$, $h = 5\\times 10^{-2}$, method = \"rk4\"。\n4. $(I_{1},I_{2},I_{3}) = (1.0, 1.5, 2.0)$, $(M_{0x}, M_{0y}, M_{0z}) = (0.3, 0.4, 0.5)$, $T = 5.0$, $h = 1\\times 10^{-3}$, method = \"euler\"。\n5. $(I_{1},I_{2},I_{3}) = (1.0, 1.5, 2.0)$, $(M_{0x}, M_{0y}, M_{0z}) = (0.3, 0.4, 0.5)$, $T = 5.0$, $h = 5\\times 10^{-3}$, method = \"euler\"。\n6. $(I_{1},I_{2},I_{3}) = (1.0, 1.5, 2.0)$, $(M_{0x}, M_{0y}, M_{0z}) = (0.3, 0.4, 0.5)$, $T = 5.0$, $h = 5\\times 10^{-2}$, method = \"euler\"。\n7. $(I_{1},I_{2},I_{3}) = (1.0, 1.0, 1.0)$, $(M_{0x}, M_{0y}, M_{0z}) = (0.7, 0.0, 0.0)$, $T = 5.0$, $h = 1\\times 10^{-1}$, method = \"euler\"。\n8. $(I_{1},I_{2},I_{3}) = (1.0, 2.0, 3.0)$, $(M_{0x}, M_{0y}, M_{0z}) = (1.0, 0.0, 0.5)$, $T = 10.0$, $h = 1\\times 10^{-2}$, method = \"rk4\"。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个条目是对应测试用例的最大相对范数漂移 $\\Delta$（如上定义），并四舍五入到十位有效数字。例如，输出应如下所示\n$$\n[\\Delta_{1},\\Delta_{2},\\dots,\\Delta_{8}]\n$$\n其中每个 $\\Delta_{k}$ 是一个四舍五入到十位有效数字的浮点数。",
            "solution": "在尝试任何解决方案之前，问题陈述都经过了严格的验证过程。\n\n### 步骤1：提取已知信息\n- **系统**：物体坐标系下的自由刚体。\n- **模型**：特殊正交群李代数的对偶空间 $\\mathfrak{so}(3)^{\\ast}$ 上的李-泊松系统。\n- **状态变量**：刚体角动量，$M \\in \\mathbb{R}^{3}$。\n- **参数**：对角惯性张量 $I = \\mathrm{diag}(I_{1}, I_{2}, I_{3})$，其中 $I_{k} > 0$。\n- **派生变量**：刚体角速度，$\\omega = I^{-1} M$。\n- **运动方程**：自由刚体的欧拉方程，由 ODE $\\dot{M} = M \\times \\omega = M \\times (I^{-1} M)$ 给出。\n- **哈密顿量**：$H(M) = \\tfrac{1}{2} M \\cdot I^{-1} M$。\n- **泊松括号**：$\\{F,G\\}(M) = -M \\cdot (\\nabla F \\times \\nabla G)$。\n- **卡西米尔不变量**：角动量范数的平方，$C(M) = \\tfrac{1}{2} \\|M\\|^{2}$，这意味着对于真实动力学，$\\|M(t)\\|$ 是一个守恒量。\n- **任务**：使用两种方法对 ODE 进行数值积分，并量化卡西米尔不变量 $\\|M\\|$ 的数值漂移。\n- **数值方法**：\n    1. 显式欧拉法：$M_{n+1} = M_{n} + h f(M_{n})$，其中 $f(M) = M \\times (I^{-1} M)$。\n    2. 经典四阶龙格-库塔法 (RK4)。\n- **度量**：在仿真区间 $[0,T]$ 上的最大相对范数漂移定义为 $\\Delta = \\max_{0 \\leq n \\leq N} \\frac{\\big|\\|M_{n}\\| - \\|M_{0}\\|\\big|}{\\|M_{0}\\|}$，其中 $N$ 是步数。\n- **测试套件**：指定了八个测试用例，每个用例都给定了 $(I_{1}, I_{2}, I_{3})$、$(M_{0x}, M_{0y}, M_{0z})$、总时间 $T$、步长 $h$ 和所选的数值方法。\n\n### 步骤2：使用提取的已知信息进行验证\n1.  **科学依据**：该问题是几何力学中的一个经典基础范例。将刚体动力学表述为 $\\mathfrak{so}(3)^{\\ast}$ 上的李-泊松系统、欧拉方程的形式、哈密顿量以及将 $\\|M\\|^2$ 识别为卡西米尔不变量，这些都是标准且正确的。\n2.  **良态问题**：该问题是一个标准的常微分方程组初值问题。右侧项 $f(M) = M \\times (I^{-1} M)$ 是一个关于 $M$ 各分量的矢量值多项式，因此在任何有界域上都是光滑且全局利普希茨的。这保证了对于给定的初始条件 $M_0$，解的存在性和唯一性。每个测试用例都提供了所有参数和初始条件，并且度量 $\\Delta$ 的定义明确（因为在所有用例中 $\\|M_0\\| \\neq 0$）。\n3.  **客观性**：问题使用精确的数学语言陈述，没有任何主观或模棱两可的术语。\n4.  **完整性与一致性**：问题是自洽的。每个测试用例所需的所有数据（$I$、$M_0$、$T$、$h$、方法）都已提供。没有矛盾之处。\n5.  **非平凡性**：该问题并非无足轻重。它要求正确实现两种标准数值方法，并理解它们如何与动力学系统的守恒量相互作用。$I_1=I_2=I_3$ 的特殊情况可作为一个非平凡的合理性检查，因为此时动力学是平凡的（$\\dot{M}=0$），任何非零漂移都将表明实现错误。\n\n### 步骤3：结论与行动\n问题有效。这是计算物理和数值分析中一个明确定义的任务，其基础是经典力学和几何力学的既定原理。将提供解决方案。\n\n### 解法推导\n问题的核心是求解角动量矢量 $M(t) \\in \\mathbb{R}^3$ 的初值问题：\n$$\n\\frac{dM}{dt} = M(t) \\times (I^{-1} M(t)), \\quad M(0) = M_0\n$$\n惯性张量 $I$ 是对角阵，所以其逆 $I^{-1}$ 也是对角阵，元素为 $1/I_1$、$1/I_2$ 和 $1/I_3$。ODE 的右侧项（我们记为 $f(M)$）可以按分量计算。如果 $M = (M_x, M_y, M_z)^T$，\n$$\nf(M) = \n\\begin{pmatrix} M_x \\\\ M_y \\\\ M_z \\end{pmatrix} \n\\times\n\\begin{pmatrix} M_x/I_1 \\\\ M_y/I_2 \\\\ M_z/I_3 \\end{pmatrix} \n=\n\\begin{pmatrix} M_y M_z (1/I_3 - 1/I_2) \\\\ M_z M_x (1/I_1 - 1/I_3) \\\\ M_x M_y (1/I_2 - 1/I_1) \\end{pmatrix}\n$$\n问题要求使用固定步长 $h$ 进行从 $t=0$ 到 $t=T$ 的数值积分。步数为 $N = T/h$。对于所有提供的测试用例，$T/h$ 都是整数。设 $M_n$ 是 $M(n h)$ 的数值近似。\n\n**1. 显式欧拉法**\n这是一种一阶方法。一步的更新规则是：\n$$\nM_{n+1} = M_n + h f(M_n)\n$$\n这种方法易于实现，但已知其不保留像卡西米尔不变量这样的几何不变量。对于欧拉-庞加莱方程，显式欧拉法通常会导致动量范数出现长期的单调漂移。分析表明 $\\|M_{n+1}\\|^2 = \\|M_n\\|^2 + h^2 \\|M_n \\times (I^{-1}M_n)\\|^2$，证实了范数是不减的。\n\n**2. 经典四阶龙格-库塔 (RK4) 法**\n这是一种标准的高阶方法。一步的更新规则是：\n$$\n\\begin{aligned}\nk_1 = f(M_n) \\\\\nk_2 = f(M_n + \\frac{h}{2} k_1) \\\\\nk_3 = f(M_n + \\frac{h}{2} k_2) \\\\\nk_4 = f(M_n + h k_3) \\\\\nM_{n+1} = M_n + \\frac{h}{6} (k_1 + 2k_2 + 2k_3 + k_4)\n\\end{aligned}\n$$\n虽然对于给定的步长 $h$，RK4 的精度远高于显式欧拉法，但它也是一种通用积分器，通常不保留卡西米尔不变量 $\\|M\\|^2$。然而，预计不变量的误差会小得多，并且随着 $h \\to 0$ 减小得更快（例如，以 $O(h^4)$ 或类似的高次幂）。\n\n**3. 实现与漂移计算**\n对于每个测试用例，流程如下：\n- 用初始值 $M_0$ 初始化动量矢量 $M$。\n- 计算并存储初始范数 $\\|M_0\\|$。\n- 将最大相对漂移变量 $\\Delta_{max}$ 初始化为 $0$。\n- 迭代 $N = T/h$ 次。在每次迭代 $n$ 中：\n    - 使用欧拉或 RK4 公式将 $M_n$ 更新为 $M_{n+1}$。\n    - 计算新矢量 $\\|M_{n+1}\\|$ 的范数。\n    - 计算当前的相对漂移：$\\delta_n = \\big|\\|M_{n+1}\\| - \\|M_0\\|\\big| / \\|M_0\\|$。\n    - 更新最大值：$\\Delta_{max} = \\max(\\Delta_{max}, \\delta_n)$。\n- 循环完成后，$\\Delta_{max}$ 的最终值即为该测试用例的结果 $\\Delta$。\n\n对问题中定义的所有八个测试用例重复此过程，并收集和格式化结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of numerically integrating the rigid body equations and\n    quantifying the drift in the norm of the angular momentum.\n    \"\"\"\n\n    test_cases = [\n        {'I': (1.0, 1.5, 2.0), 'M0': (0.3, 0.4, 0.5), 'T': 5.0, 'h': 1e-3, 'method': 'rk4'},\n        {'I': (1.0, 1.5, 2.0), 'M0': (0.3, 0.4, 0.5), 'T': 5.0, 'h': 5e-3, 'method': 'rk4'},\n        {'I': (1.0, 1.5, 2.0), 'M0': (0.3, 0.4, 0.5), 'T': 5.0, 'h': 5e-2, 'method': 'rk4'},\n        {'I': (1.0, 1.5, 2.0), 'M0': (0.3, 0.4, 0.5), 'T': 5.0, 'h': 1e-3, 'method': 'euler'},\n        {'I': (1.0, 1.5, 2.0), 'M0': (0.3, 0.4, 0.5), 'T': 5.0, 'h': 5e-3, 'method': 'euler'},\n        {'I': (1.0, 1.5, 2.0), 'M0': (0.3, 0.4, 0.5), 'T': 5.0, 'h': 5e-2, 'method': 'euler'},\n        {'I': (1.0, 1.0, 1.0), 'M0': (0.7, 0.0, 0.0), 'T': 5.0, 'h': 1e-1, 'method': 'euler'},\n        {'I': (1.0, 2.0, 3.0), 'M0': (1.0, 0.0, 0.5), 'T': 10.0, 'h': 1e-2, 'method': 'rk4'},\n    ]\n\n    def run_simulation(I_tuple, M0_tuple, T, h, method):\n        \"\"\"\n        Runs a single simulation and returns the maximum relative norm drift.\n\n        Args:\n            I_tuple (tuple): Principal moments of inertia (I1, I2, I3).\n            M0_tuple (tuple): Initial angular momentum (Mx, My, Mz).\n            T (float): Total integration time.\n            h (float): Fixed time step.\n            method (str): Integration method, \"euler\" or \"rk4\".\n\n        Returns:\n            float: The maximum relative norm drift Delta.\n        \"\"\"\n        I = np.array(I_tuple)\n        M0 = np.array(M0_tuple)\n        \n        # Pre-calculate inverse of inertia tensor\n        I_inv = 1.0 / I\n\n        def f(M_vec):\n            \"\"\"The right-hand side of the ODE: dM/dt = M x (I^-1 * M)\"\"\"\n            omega = I_inv * M_vec\n            return np.cross(M_vec, omega)\n\n        # Use rounding to prevent floating-point issues in calculating num_steps\n        num_steps = int(round(T / h))\n        M = np.copy(M0)\n        norm_M0 = np.linalg.norm(M0)\n\n        # If initial momentum is zero, norm is always zero, so drift is zero.\n        if norm_M0 == 0:\n            return 0.0\n\n        max_rel_drift = 0.0\n\n        # Integration loop\n        for _ in range(num_steps):\n            if method == \"euler\":\n                M = M + h * f(M)\n            elif method == \"rk4\":\n                k1 = f(M)\n                k2 = f(M + 0.5 * h * k1)\n                k3 = f(M + 0.5 * h * k2)\n                k4 = f(M + h * k3)\n                M = M + (h / 6.0) * (k1 + 2.0 * k2 + 2.0 * k3 + k4)\n            \n            # Calculate and track the maximum relative drift\n            current_norm = np.linalg.norm(M)\n            rel_drift = abs(current_norm - norm_M0) / norm_M0\n            if rel_drift > max_rel_drift:\n                max_rel_drift = rel_drift\n        \n        return max_rel_drift\n\n    results = []\n    for case in test_cases:\n        delta = run_simulation(case['I'], case['M0'], case['T'], case['h'], case['method'])\n        results.append(delta)\n\n    # Format the final output string as required\n    # \"{:.10g}\" formats a number to 10 significant digits.\n    formatted_results = [f\"{res:.10g}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}