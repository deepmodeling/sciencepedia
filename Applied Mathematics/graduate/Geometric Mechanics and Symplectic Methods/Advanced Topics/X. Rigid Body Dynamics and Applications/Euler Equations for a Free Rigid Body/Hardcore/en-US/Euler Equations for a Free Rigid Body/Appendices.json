{
    "hands_on_practices": [
        {
            "introduction": "Before analyzing the intricate dynamics of a free rigid body, we must first quantify its rotational inertia. This physical property, which describes how mass is distributed relative to an axis of rotation, is mathematically captured by the inertia tensor, $I$. This practice guides you through the fundamental derivation of the inertia tensor from the definition of kinetic energy, providing a direct link between a body's physical geometry and the parameters in its equations of motion .",
            "id": "3740943",
            "problem": "Consider a free rigid body whose configuration space is the Special Orthogonal Group (SO(3)). In body coordinates, let the mass density be a smooth function $\\rho(x)$ supported on a bounded region $\\mathcal{B} \\subset \\mathbb{R}^{3}$, with $x \\in \\mathcal{B}$ measured relative to the body-fixed origin at the center of mass. The rigid body has angular velocity $\\omega \\in \\mathbb{R}^{3}$ expressed in body coordinates, and the instantaneous body velocity field is $v(x) = \\omega \\times x$. The kinetic energy is given by the integral $T = \\frac{1}{2} \\int_{\\mathcal{B}} \\rho(x) \\|v(x)\\|^{2} \\, dx$.\n\nStarting from this fundamental base, first derive an explicit integral formula for the inertia tensor $I \\in \\mathbb{R}^{3 \\times 3}$ such that $T = \\frac{1}{2} \\, \\omega^{\\top} I \\, \\omega$ holds for all $\\omega$. Second, evaluate this formula for a uniform rectangular block occupying the body domain $\\mathcal{B} = \\left[-\\frac{L_{x}}{2}, \\frac{L_{x}}{2}\\right] \\times \\left[-\\frac{L_{y}}{2}, \\frac{L_{y}}{2}\\right] \\times \\left[-\\frac{L_{z}}{2}, \\frac{L_{z}}{2}\\right]$, with constant density $\\rho_{0}  0$ and total mass $m = \\rho_{0} L_{x} L_{y} L_{z}$. Use the body-fixed coordinate axes aligned with the edges of the block (so that the inertia tensor and its principal moments are computed about the center-of-mass frame with axes along the block edges).\n\nProvide the final answer as the ordered triple of principal moments $(I_{xx}, I_{yy}, I_{zz})$ in terms of $m$, $L_{x}$, $L_{y}$, and $L_{z}$. Express your final answer in the International System of Units (SI) as kilogram meter squared. Write your final triple as a single row matrix. No rounding is required.",
            "solution": "The problem presents a valid and well-posed question in classical mechanics, specifically the dynamics of a free rigid body. All definitions and given conditions are standard, scientifically sound, and self-consistent. The problem is comprised of two parts: first, a general derivation of the inertia tensor from the kinetic energy, and second, the evaluation of this tensor for a specific geometry.\n\nPart 1: Derivation of the Inertia Tensor\n\nThe kinetic energy $T$ of a rigid body is given by the integral of the kinetic energy of its infinitesimal mass elements over its volume. In a body-fixed frame with origin at the center of mass, the velocity of a point $x \\in \\mathcal{B}$ is purely rotational, given by $v(x) = \\omega \\times x$, where $\\omega$ is the body's angular velocity vector.\n\nThe kinetic energy is:\n$$\nT = \\frac{1}{2} \\int_{\\mathcal{B}} \\rho(x) \\|v(x)\\|^{2} \\, d^3x = \\frac{1}{2} \\int_{\\mathcal{B}} \\rho(x) \\|\\omega \\times x\\|^{2} \\, d^3x\n$$\nWe use the vector identity $\\|\\mathbf{a} \\times \\mathbf{b}\\|^2 = \\|\\mathbf{a}\\|^2 \\|\\mathbf{b}\\|^2 - (\\mathbf{a} \\cdot \\mathbf{b})^2$. Let $\\omega = (\\omega_1, \\omega_2, \\omega_3)$ and $x = (x_1, x_2, x_3)$. Then, $\\|\\omega\\|^2 = \\sum_i \\omega_i^2$, $\\|x\\|^2 = \\sum_k x_k^2$, and $\\omega \\cdot x = \\sum_j \\omega_j x_j$.\nSo,\n$$\n\\|\\omega \\times x\\|^2 = \\left(\\sum_i \\omega_i^2\\right) \\left(\\sum_k x_k^2\\right) - \\left(\\sum_j \\omega_j x_j\\right)^2\n$$\nWe can express this as a quadratic form in $\\omega$. Let us use index notation with Einstein summation convention.\n$$\n\\|\\omega \\times x\\|^2 = \\omega_i \\omega_i x_k x_k - (\\omega_j x_j)(\\omega_m x_m)\n$$\nTo write this in the form $\\omega_j I_{jm} \\omega_m$, we manipulate the indices:\n$$\n\\|\\omega \\times x\\|^2 = \\omega_j \\delta_{jm} \\omega_m x_k x_k - \\omega_j x_j \\omega_m x_m\n$$\nwhere $\\delta_{jm}$ is the Kronecker delta. Factoring out $\\omega_j$ and $\\omega_m$:\n$$\n\\|\\omega \\times x\\|^2 = \\omega_j \\left( \\delta_{jm} (x_k x_k) - x_j x_m \\right) \\omega_m\n$$\nSubstituting this back into the kinetic energy integral:\n$$\nT = \\frac{1}{2} \\int_{\\mathcal{B}} \\rho(x) \\left( \\omega_j \\left( \\delta_{jm} \\|x\\|^2 - x_j x_m \\right) \\omega_m \\right) \\, d^3x\n$$\nSince the components $\\omega_j$ of the angular velocity are constant with respect to the spatial integration over the body $\\mathcal{B}$, we can pull them out of the integral:\n$$\nT = \\frac{1}{2} \\, \\omega_j \\left( \\int_{\\mathcal{B}} \\rho(x) \\left( \\delta_{jm} \\|x\\|^2 - x_j x_m \\right) \\, d^3x \\right) \\omega_m\n$$\nThis expression is of the form $T = \\frac{1}{2} \\omega^{\\top} I \\omega$, which in index notation is $T = \\frac{1}{2} \\omega_j I_{jm} \\omega_m$. By direct comparison, we identify the components of the inertia tensor $I$ as:\n$$\nI_{jm} = \\int_{\\mathcal{B}} \\rho(x) \\left( \\delta_{jm} \\|x\\|^2 - x_j x_m \\right) \\, d^3x\n$$\nThis is the general integral formula for the inertia tensor.\nThe diagonal components ($j=m$), called the moments of inertia, are:\n$$\nI_{jj} = \\int_{\\mathcal{B}} \\rho(x) \\left( \\|x\\|^2 - x_j^2 \\right) \\, d^3x\n$$\nFor example, using coordinates $(x,y,z)$ for $(x_1, x_2, x_3)$:\n$$\nI_{xx} = I_{11} = \\int_{\\mathcal{B}} \\rho(x,y,z) (y^2+z^2) \\, dx\\,dy\\,dz\n$$\nThe off-diagonal components ($j \\neq m$), called the products of inertia, are:\n$$\nI_{jm} = - \\int_{\\mathcal{B}} \\rho(x) x_j x_m \\, d^3x\n$$\n\nPart 2: Evaluation for a Uniform Rectangular Block\n\nWe are given a rectangular block with constant density $\\rho_0$ and dimensions $L_x, L_y, L_z$. The domain is $\\mathcal{B} = \\left[-\\frac{L_{x}}{2}, \\frac{L_{x}}{2}\\right] \\times \\left[-\\frac{L_{y}}{2}, \\frac{L_{y}}{2}\\right] \\times \\left[-\\frac{L_{z}}{2}, \\frac{L_{z}}{2}\\right]$. The total mass is $m = \\rho_0 L_x L_y L_z$. The body-fixed axes are aligned with the block's edges.\n\nFirst, we check the products of inertia. For instance, $I_{xy}$:\n$$\nI_{xy} = - \\int_{\\mathcal{B}} \\rho_0 x y \\, dx\\,dy\\,dz = -\\rho_0 \\left( \\int_{-L_x/2}^{L_x/2} x \\, dx \\right) \\left( \\int_{-L_y/2}^{L_y/2} y \\, dy \\right) \\left( \\int_{-L_z/2}^{L_z/2} dz \\right)\n$$\nThe integral $\\int_{-L_x/2}^{L_x/2} x \\, dx = \\left[ \\frac{x^2}{2} \\right]_{-L_x/2}^{L_x/2} = \\frac{1}{2}\\left(\\left(\\frac{L_x}{2}\\right)^2 - \\left(-\\frac{L_x}{2}\\right)^2\\right) = 0$.\nThe integral is zero because the integrand is an odd function over a symmetric interval. Consequently, $I_{xy} = 0$. By symmetry, $I_{xz} = 0$ and $I_{yz} = 0$. The inertia tensor is diagonal, and its diagonal elements are the principal moments of inertia.\n\nNow, we compute the principal moments. Let's start with $I_{xx}$:\n$$\nI_{xx} = \\int_{\\mathcal{B}} \\rho_0 (y^2 + z^2) \\, dx\\,dy\\,dz = \\rho_0 \\left( \\int_{\\mathcal{B}} y^2 \\, dV + \\int_{\\mathcal{B}} z^2 \\, dV \\right)\n$$\nwhere $dV = dx\\,dy\\,dz$. We evaluate the first integral:\n$$\n\\int_{\\mathcal{B}} y^2 \\, dV = \\int_{-L_x/2}^{L_x/2} dx \\int_{-L_y/2}^{L_y/2} y^2 \\, dy \\int_{-L_z/2}^{L_z/2} dz\n$$\nThe separate integrals are:\n$\\int_{-L_x/2}^{L_x/2} dx = L_x$\n$\\int_{-L_z/2}^{L_z/2} dz = L_z$\n$\\int_{-L_y/2}^{L_y/2} y^2 \\, dy = \\left[ \\frac{y^3}{3} \\right]_{-L_y/2}^{L_y/2} = \\frac{1}{3}\\left( \\left(\\frac{L_y}{2}\\right)^3 - \\left(-\\frac{L_y}{2}\\right)^3 \\right) = \\frac{1}{3}\\left(\\frac{L_y^3}{8} + \\frac{L_y^3}{8}\\right) = \\frac{L_y^3}{12}$\nThus, $\\int_{\\mathcal{B}} y^2 \\, dV = L_x \\left( \\frac{L_y^3}{12} \\right) L_z = \\frac{L_x L_y^3 L_z}{12}$.\nBy a symmetric argument, $\\int_{\\mathcal{B}} z^2 \\, dV = \\frac{L_x L_y L_z^3}{12}$.\nSubstituting these results back into the expression for $I_{xx}$:\n$$\nI_{xx} = \\rho_0 \\left( \\frac{L_x L_y^3 L_z}{12} + \\frac{L_x L_y L_z^3}{12} \\right) = \\frac{\\rho_0 L_x L_y L_z}{12} (L_y^2 + L_z^2)\n$$\nUsing the given relation for the total mass, $m = \\rho_0 L_x L_y L_z$, we obtain:\n$$\nI_{xx} = \\frac{m}{12} (L_y^2 + L_z^2)\n$$\nThe other two principal moments, $I_{yy}$ and $I_{zz}$, can be found by cyclic permutation of the indices $x, y, z$ and the corresponding dimensions $L_x, L_y, L_z$:\n$$\nI_{yy} = \\frac{m}{12} (L_x^2 + L_z^2)\n$$\n$$\nI_{zz} = \\frac{m}{12} (L_x^2 + L_y^2)\n$$\nThe ordered triple of principal moments $(I_{xx}, I_{yy}, I_{zz})$ is therefore:\n$$\n\\left( \\frac{m}{12}(L_y^2 + L_z^2), \\frac{m}{12}(L_x^2 + L_z^2), \\frac{m}{12}(L_x^2 + L_y^2) \\right)\n$$\nThese expressions have units of mass times length squared (e.g., kg m$^2$ in SI units), as required for moments of inertia. The final answer is requested as a single row matrix.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{m}{12}(L_y^2 + L_z^2)  \\frac{m}{12}(L_x^2 + L_z^2)  \\frac{m}{12}(L_x^2 + L_y^2) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "With the inertia tensor established, we can now derive the laws governing the body's rotational motion. This exercise demonstrates how the elegant framework of geometric mechanics, using the kinetic energy as the Hamiltonian $H$ and the natural Lie-Poisson bracket on the space of angular momenta, gives rise to the celebrated Euler equations . This practice is key to understanding the deep connection between the system's geometric structure and its dynamical behavior.",
            "id": "3748149",
            "problem": "Consider a free rigid body (Euler top) with distinct principal moments of inertia $I_{1}$, $I_{2}$, and $I_{3}$, evolving on the Special Orthogonal group $\\operatorname{SO}(3)$ in the body frame. Let the body angular momentum be $M = (M_{1}, M_{2}, M_{3}) \\in \\mathfrak{so}(3)^{\\ast}$ and the body angular velocity be $\\omega = (\\omega_{1}, \\omega_{2}, \\omega_{3}) \\in \\mathbb{R}^{3}$, related by $M = \\mathbb{I}\\omega$ where $\\mathbb{I} = \\operatorname{diag}(I_{1}, I_{2}, I_{3})$. The dynamics are Hamiltonian on the dual of the Lie algebra $\\mathfrak{so}(3)^{\\ast}$, with the Lie-Poisson bracket (LP bracket) defined for smooth functions $F, G : \\mathfrak{so}(3)^{\\ast} \\to \\mathbb{R}$ by\n$$\n\\{F, G\\}(M) = -\\,M \\cdot \\big(\\nabla F(M) \\times \\nabla G(M)\\big),\n$$\nand Hamiltonian\n$$\nH(M) = \\tfrac{1}{2}\\,\\omega \\cdot M = \\tfrac{1}{2}\\,M \\cdot \\mathbb{I}^{-1}M.\n$$\nStarting from these definitions, derive the Hamiltonian equations of motion for the coordinate functions $M_{i}$, $i \\in \\{1,2,3\\}$, and compute the time derivatives $\\frac{d}{dt}(M_{i})$ in terms of the components of $M$ and the principal moments $I_{1}, I_{2}, I_{3}$. Verify explicitly how the components couple through the inertias by expressing $\\frac{d}{dt}(M_{i})$ solely in terms of $M_{j}$ and $I_{k}$.\n\nExpress your final answer as a single row matrix containing the three component expressions $\\frac{d}{dt}(M_{1})$, $\\frac{d}{dt}(M_{2})$, and $\\frac{d}{dt}(M_{3})$. No numerical evaluation is required, and no units are to be included.",
            "solution": "The problem is first validated against the established criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **System**: A free rigid body (Euler top).\n- **Principal Moments of Inertia**: $I_{1}$, $I_{2}$, and $I_{3}$ (distinct).\n- **Body Angular Momentum**: $M = (M_{1}, M_{2}, M_{3}) \\in \\mathfrak{so}(3)^{\\ast}$.\n- **Body Angular Velocity**: $\\omega = (\\omega_{1}, \\omega_{2}, \\omega_{3}) \\in \\mathbb{R}^{3}$.\n- **Relation between M and $\\omega$**: $M = \\mathbb{I}\\omega$, where $\\mathbb{I} = \\operatorname{diag}(I_{1}, I_{2}, I_{3})$.\n- **Lie-Poisson Bracket**: For smooth functions $F, G : \\mathfrak{so}(3)^{\\ast} \\to \\mathbb{R}$, the bracket is defined as $\\{F, G\\}(M) = -\\,M \\cdot \\big(\\nabla F(M) \\times \\nabla G(M)\\big)$.\n- **Hamiltonian**: $H(M) = \\tfrac{1}{2}\\,\\omega \\cdot M = \\tfrac{1}{2}\\,M \\cdot \\mathbb{I}^{-1}M$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem describes the Hamiltonian formulation of the Euler top's motion on the dual of the Lie algebra of $\\operatorname{SO}(3)$. The provided Hamiltonian is the kinetic energy, and the Lie-Poisson bracket is the standard bracket for $\\mathfrak{so}(3)^{\\ast}$. This formulation is a cornerstone of geometric mechanics. Thus, the problem is scientifically sound.\n- **Well-Posed**: The problem provides all necessary definitions and equations to derive the equations of motion. It asks for a specific calculation which is uniquely determined by the givens.\n- **Objective**: The problem is stated using precise mathematical language, free from any subjective or ambiguous terminology.\n- **Flaw Check**:\n  1. **Scientific/Factual Unsoundness**: None. The physics and mathematics are standard and correct.\n  2. **Non-Formalizable/Irrelevant**: None. The problem is a core exercise in the specified field.\n  3. **Incomplete/Contradictory Setup**: None. All definitions are provided and are mutually consistent.\n  4. **Unrealistic/Infeasible**: None. It is a standard, physically meaningful model.\n  5. **Ill-Posed/Poorly Structured**: None. The derivation leads to a unique, well-defined result.\n  6. **Pseudo-Profound/Trivial**: None. The derivation is a fundamental calculation that demonstrates the application of the Lie-Poisson formalism.\n  7. **Outside Scientific Verifiability**: None. The derivation is a mathematical proof.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. Proceed to the solution.\n\n### Derivation of the Equations of Motion\n\nThe time evolution of any observable quantity $F(M)$ on the phase space $\\mathfrak{so}(3)^{\\ast}$ is governed by Hamilton's equation:\n$$\n\\frac{dF}{dt} = \\{F, H\\}\n$$\nwhere $H$ is the Hamiltonian and $\\{\\cdot, \\cdot\\}$ is the Lie-Poisson bracket. We are tasked with finding the equations of motion for the components of the angular momentum vector, $M_i$. This corresponds to setting the observable $F$ to be each of the coordinate functions $M_1$, $M_2$, and $M_3$.\n\nThe Lie-Poisson bracket is given as:\n$$\n\\{F, G\\}(M) = -M \\cdot \\left(\\nabla F(M) \\times \\nabla G(M)\\right)\n$$\nHere, $\\nabla$ is the gradient with respect to the coordinates $M = (M_1, M_2, M_3)$, i.e., $\\nabla = \\left(\\frac{\\partial}{\\partial M_1}, \\frac{\\partial}{\\partial M_2}, \\frac{\\partial}{\\partial M_3}\\right)$.\n\nWe need to compute $\\frac{dM_i}{dt} = \\{M_i, H\\}$ for $i \\in \\{1, 2, 3\\}$. This requires calculating the gradients of the functions $M_i$ and the Hamiltonian $H$.\n\nFirst, let's find the gradient of the Hamiltonian $H$. The Hamiltonian is given by:\n$$\nH(M) = \\frac{1}{2} M \\cdot \\mathbb{I}^{-1}M = \\frac{1}{2} \\left( \\frac{M_1^2}{I_1} + \\frac{M_2^2}{I_2} + \\frac{M_3^2}{I_3} \\right)\n$$\nThe gradient $\\nabla H$ is a vector whose components are the partial derivatives of $H$ with respect to each $M_i$:\n$$\n\\frac{\\partial H}{\\partial M_1} = \\frac{M_1}{I_1}, \\quad \\frac{\\partial H}{\\partial M_2} = \\frac{M_2}{I_2}, \\quad \\frac{\\partial H}{\\partial M_3} = \\frac{M_3}{I_3}\n$$\nThus, the gradient vector is:\n$$\n\\nabla H = \\left( \\frac{M_1}{I_1}, \\frac{M_2}{I_2}, \\frac{M_3}{I_3} \\right) = \\mathbb{I}^{-1}M = \\omega\n$$\n\nNext, we calculate the gradients of the coordinate functions $F = M_i$.\nFor $F = M_1$:\n$$\n\\nabla M_1 = \\left(\\frac{\\partial M_1}{\\partial M_1}, \\frac{\\partial M_1}{\\partial M_2}, \\frac{\\partial M_1}{\\partial M_3}\\right) = (1, 0, 0) = \\mathbf{e}_1\n$$\nSimilarly, $\\nabla M_2 = \\mathbf{e}_2$ and $\\nabla M_3 = \\mathbf{e}_3$.\n\nNow we can compute the time derivative for each component $M_i$.\n\n**For $M_1$:**\n$$\n\\frac{dM_1}{dt} = \\{M_1, H\\} = -M \\cdot (\\nabla M_1 \\times \\nabla H)\n$$\nWe compute the cross product:\n$$\n\\nabla M_1 \\times \\nabla H = \\mathbf{e}_1 \\times \\omega = (1, 0, 0) \\times \\left(\\frac{M_1}{I_1}, \\frac{M_2}{I_2}, \\frac{M_3}{I_3}\\right) = \\left(0, -\\frac{M_3}{I_3}, \\frac{M_2}{I_2}\\right)\n$$\nNow, we take the dot product with $-M$:\n$$\n\\frac{dM_1}{dt} = -(M_1, M_2, M_3) \\cdot \\left(0, -\\frac{M_3}{I_3}, \\frac{M_2}{I_2}\\right) = -\\left( M_2 \\left(-\\frac{M_3}{I_3}\\right) + M_3 \\left(\\frac{M_2}{I_2}\\right) \\right)\n$$\n$$\n\\frac{dM_1}{dt} = -\\left( -\\frac{M_2 M_3}{I_3} + \\frac{M_2 M_3}{I_2} \\right) = M_2 M_3 \\left(\\frac{1}{I_3} - \\frac{1}{I_2}\\right)\n$$\n\n**For $M_2$:**\n$$\n\\frac{dM_2}{dt} = \\{M_2, H\\} = -M \\cdot (\\nabla M_2 \\times \\nabla H)\n$$\nThe cross product is:\n$$\n\\nabla M_2 \\times \\nabla H = \\mathbf{e}_2 \\times \\omega = (0, 1, 0) \\times \\left(\\frac{M_1}{I_1}, \\frac{M_2}{I_2}, \\frac{M_3}{I_3}\\right) = \\left(\\frac{M_3}{I_3}, 0, -\\frac{M_1}{I_1}\\right)\n$$\nTaking the dot product with $-M$:\n$$\n\\frac{dM_2}{dt} = -(M_1, M_2, M_3) \\cdot \\left(\\frac{M_3}{I_3}, 0, -\\frac{M_1}{I_1}\\right) = -\\left( M_1 \\left(\\frac{M_3}{I_3}\\right) + M_3 \\left(-\\frac{M_1}{I_1}\\right) \\right)\n$$\n$$\n\\frac{dM_2}{dt} = -\\left( \\frac{M_1 M_3}{I_3} - \\frac{M_1 M_3}{I_1} \\right) = M_1 M_3 \\left(\\frac{1}{I_1} - \\frac{1}{I_3}\\right)\n$$\n\n**For $M_3$:**\n$$\n\\frac{dM_3}{dt} = \\{M_3, H\\} = -M \\cdot (\\nabla M_3 \\times \\nabla H)\n$$\nThe cross product is:\n$$\n\\nabla M_3 \\times \\nabla H = \\mathbf{e}_3 \\times \\omega = (0, 0, 1) \\times \\left(\\frac{M_1}{I_1}, \\frac{M_2}{I_2}, \\frac{M_3}{I_3}\\right) = \\left(-\\frac{M_2}{I_2}, \\frac{M_1}{I_1}, 0\\right)\n$$\nTaking the dot product with $-M$:\n$$\n\\frac{dM_3}{dt} = -(M_1, M_2, M_3) \\cdot \\left(-\\frac{M_2}{I_2}, \\frac{M_1}{I_1}, 0\\right) = -\\left( M_1 \\left(-\\frac{M_2}{I_2}\\right) + M_2 \\left(\\frac{M_1}{I_1}\\right) \\right)\n$$\n$$\n\\frac{dM_3}{dt} = -\\left( -\\frac{M_1 M_2}{I_2} + \\frac{M_1 M_2}{I_1} \\right) = M_1 M_2 \\left(\\frac{1}{I_2} - \\frac{1}{I_1}\\right)\n$$\n\nThese are the Euler equations of motion for a free rigid body, expressed in the body frame in terms of the angular momentum components $M_i$ and the principal moments of inertia $I_k$. The coupling between the components is explicitly shown through the products of the other two momentum components and the differences in the inverse moments of inertia.\n\nThe final result is the set of three expressions for $\\frac{d}{dt}(M_i)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} M_{2}M_{3}\\left(\\frac{1}{I_{3}} - \\frac{1}{I_{2}}\\right)  M_{1}M_{3}\\left(\\frac{1}{I_{1}} - \\frac{1}{I_{3}}\\right)  M_{1}M_{2}\\left(\\frac{1}{I_{2}} - \\frac{1}{I_{1}}\\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Theoretical derivations gain deeper meaning when tested through practical implementation. This computational exercise tasks you with numerically simulating the Euler equations to observe a crucial feature of the underlying Lie-Poisson structure: the conservation of the angular momentum's magnitude, a so-called Casimir invariant . By comparing standard numerical methods, you will witness how these general-purpose algorithms can fail to preserve the system's geometric invariants, providing a compelling motivation for the study of structure-preserving numerical schemes.",
            "id": "3776192",
            "problem": "Consider the free rigid body in the body frame, modeled as a Lie-Poisson system on the dual of the Lie algebra of the special orthogonal group, denoted $\\mathfrak{so}(3)^{\\ast}$. Let the body angular momentum be $M \\in \\mathbb{R}^{3}$, the diagonal inertia tensor $I = \\mathrm{diag}(I_{1}, I_{2}, I_{3})$ with strictly positive entries, and the body angular velocity $\\omega = I^{-1} M$. The evolution equations of the free rigid body (Euler’s equations) in the body frame are given by the Ordinary Differential Equation (ODE)\n$$\n\\dot{M} = M \\times \\omega = M \\times (I^{-1} M),\n$$\nwhich is a Lie-Poisson system with Hamiltonian $H(M) = \\tfrac{1}{2} M \\cdot I^{-1} M$ and Poisson bracket $\\{F,G\\}(M) = -M \\cdot (\\nabla F \\times \\nabla G)$ for smooth functions $F,G : \\mathbb{R}^{3} \\to \\mathbb{R}$. A fundamental invariant (Casimir) of this Lie-Poisson system is the squared norm $C(M) = \\tfrac{1}{2} \\|M\\|^{2}$.\n\nYour task is to write a complete, runnable program that:\n- Integrates the ODE numerically using two fixed-step methods: explicit Euler and classical fourth-order Runge-Kutta (RK4).\n- Validates numerically that $\\|M(t)\\|$ remains constant for the exact dynamics by quantifying the discretization-induced drift in $\\|M\\|$ for each method and step size.\n- Assesses sensitivity to discretization error by reporting, for each test case, the maximum relative deviation of the norm from its initial value over the simulation.\n\nWork in nondimensional units. For a given trajectory $M_{0}, M_{1}, \\dots, M_{N}$ computed by a numerical method over a time interval $[0,T]$ with fixed step size $h$, define the maximum relative norm drift as\n$$\n\\Delta = \\max_{0 \\leq n \\leq N} \\frac{\\big|\\|M_{n}\\| - \\|M_{0}\\|\\big|}{\\|M_{0}\\|}.\n$$\n\nImplement both methods as fixed-step integrators:\n- Explicit Euler: $M_{n+1} = M_{n} + h f(M_{n})$ with $f(M) = M \\times (I^{-1} M)$.\n- Classical RK4 with the usual Butcher tableau using $f(M)$.\n\nTest Suite:\nCompute $\\Delta$ for each of the following eight test cases. Each case is specified by the inertia components $(I_{1}, I_{2}, I_{3})$, the initial momentum components $(M_{0x}, M_{0y}, M_{0z})$, the total time $T$, the fixed time step $h$, and the numerical method to use (\"euler\" or \"rk4\").\n\n1. $(I_{1},I_{2},I_{3}) = (1.0, 1.5, 2.0)$, $(M_{0x}, M_{0y}, M_{0z}) = (0.3, 0.4, 0.5)$, $T = 5.0$, $h = 1\\times 10^{-3}$, method = \"rk4\".\n2. $(I_{1},I_{2},I_{3}) = (1.0, 1.5, 2.0)$, $(M_{0x}, M_{0y}, M_{0z}) = (0.3, 0.4, 0.5)$, $T = 5.0$, $h = 5\\times 10^{-3}$, method = \"rk4\".\n3. $(I_{1},I_{2},I_{3}) = (1.0, 1.5, 2.0)$, $(M_{0x}, M_{0y}, M_{0z}) = (0.3, 0.4, 0.5)$, $T = 5.0$, $h = 5\\times 10^{-2}$, method = \"rk4\".\n4. $(I_{1},I_{2},I_{3}) = (1.0, 1.5, 2.0)$, $(M_{0x}, M_{0y}, M_{0z}) = (0.3, 0.4, 0.5)$, $T = 5.0$, $h = 1\\times 10^{-3}$, method = \"euler\".\n5. $(I_{1},I_{2},I_{3}) = (1.0, 1.5, 2.0)$, $(M_{0x}, M_{0y}, M_{0z}) = (0.3, 0.4, 0.5)$, $T = 5.0$, $h = 5\\times 10^{-3}$, method = \"euler\".\n6. $(I_{1},I_{2},I_{3}) = (1.0, 1.5, 2.0)$, $(M_{0x}, M_{0y}, M_{0z}) = (0.3, 0.4, 0.5)$, $T = 5.0$, $h = 5\\times 10^{-2}$, method = \"euler\".\n7. $(I_{1},I_{2},I_{3}) = (1.0, 1.0, 1.0)$, $(M_{0x}, M_{0y}, M_{0z}) = (0.7, 0.0, 0.0)$, $T = 5.0$, $h = 1\\times 10^{-1}$, method = \"euler\".\n8. $(I_{1},I_{2},I_{3}) = (1.0, 2.0, 3.0)$, $(M_{0x}, M_{0y}, M_{0z}) = (1.0, 0.0, 0.5)$, $T = 10.0$, $h = 1\\times 10^{-2}$, method = \"rk4\".\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is the maximum relative norm drift $\\Delta$ (as defined above) for the corresponding test case, rounded to ten significant digits. For example, the output should look like\n$$\n[\\Delta_{1},\\Delta_{2},\\dots,\\Delta_{8}]\n$$\nwith each $\\Delta_{k}$ a floating-point number rounded to ten significant digits.",
            "solution": "The problem statement undergoes a rigorous validation process before any attempt at a solution.\n\n### Step 1: Extract Givens\n- **System**: The free rigid body in the body frame.\n- **Model**: A Lie-Poisson system on the dual of the Lie algebra of the special orthogonal group, $\\mathfrak{so}(3)^{\\ast}$.\n- **State Variable**: Body angular momentum, $M \\in \\mathbb{R}^{3}$.\n- **Parameters**: Diagonal inertia tensor $I = \\mathrm{diag}(I_{1}, I_{2}, I_{3})$ with $I_{k}  0$.\n- **Derived Variable**: Body angular velocity, $\\omega = I^{-1} M$.\n- **Equation of Motion**: Euler's equations for a free rigid body, given by the ODE $\\dot{M} = M \\times \\omega = M \\times (I^{-1} M)$.\n- **Hamiltonian**: $H(M) = \\tfrac{1}{2} M \\cdot I^{-1} M$.\n- **Poisson Bracket**: $\\{F,G\\}(M) = -M \\cdot (\\nabla F \\times \\nabla G)$.\n- **Casimir Invariant**: The squared norm of the angular momentum, $C(M) = \\tfrac{1}{2} \\|M\\|^{2}$, which implies $\\|M(t)\\|$ is a conserved quantity for the true dynamics.\n- **Task**: Numerically integrate the ODE using two methods and quantify the numerical drift of the Casimir invariant $\\|M\\|$.\n- **Numerical Methods**:\n    1.  Explicit Euler: $M_{n+1} = M_{n} + h f(M_{n})$, where $f(M) = M \\times (I^{-1} M)$.\n    2.  Classical Fourth-Order Runge-Kutta (RK4).\n- **Metric**: The maximum relative norm drift over the simulation interval $[0,T]$ is defined as $\\Delta = \\max_{0 \\leq n \\leq N} \\frac{\\big|\\|M_{n}\\| - \\|M_{0}\\|\\big|}{\\|M_{0}\\|}$, where $N$ is the number of steps.\n- **Test Suite**: Eight test cases are specified, each with values for $(I_{1}, I_{2}, I_{3})$, $(M_{0x}, M_{0y}, M_{0z})$, total time $T$, step size $h$, and the chosen numerical method.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is a classic and fundamental example in geometric mechanics. The formulation of the rigid body dynamics as a Lie-Poisson system on $\\mathfrak{so}(3)^{\\ast}$, the form of Euler's equations, the Hamiltonian, and the identification of $\\|M\\|^2$ as a Casimir invariant are all standard and correct.\n2.  **Well-Posed**: The problem is a standard initial value problem for a system of ordinary differential equations. The right-hand side, $f(M) = M \\times (I^{-1} M)$, is a vector-valued polynomial in the components of $M$, making it smooth and globally Lipschitz on any bounded domain. This guarantees the existence and uniqueness of a solution for a given initial condition $M_0$. All parameters and initial conditions are provided for each test case, and the metric $\\Delta$ is unambiguously defined (since $\\|M_0\\| \\neq 0$ in all cases).\n3.  **Objective**: The problem is stated using precise mathematical language, free from any subjective or ambiguous terminology.\n4.  **Completeness and Consistency**: The problem is self-contained. All necessary data ($I$, $M_0$, $T$, $h$, method) are provided for each of the eight test cases. There are no contradictions.\n5.  **Triviality**: The problem is not trivial. It requires the correct implementation of two standard numerical methods and an understanding of how they interact with conserved quantities of a dynamical system. The specific case where $I_1=I_2=I_3$ serves as a non-trivial sanity check, as the dynamics become trivial ($\\dot{M}=0$), and any non-zero drift would indicate an implementation error.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a well-defined task in computational physics and numerical analysis, grounded in the established principles of classical and geometric mechanics. A solution will be provided.\n\n### Solution Derivation\nThe core of the problem is to solve the initial value problem for the angular momentum vector $M(t) \\in \\mathbb{R}^3$:\n$$\n\\frac{dM}{dt} = M(t) \\times (I^{-1} M(t)), \\quad M(0) = M_0\n$$\nThe inertia tensor $I$ is diagonal, so its inverse $I^{-1}$ is also diagonal with entries $1/I_1$, $1/I_2$, and $1/I_3$. The right-hand side of the ODE, which we denote $f(M)$, can be computed component-wise. If $M = (M_x, M_y, M_z)^T$,\n$$\nf(M) = \n\\begin{pmatrix} M_x \\\\ M_y \\\\ M_z \\end{pmatrix} \n\\times\n\\begin{pmatrix} M_x/I_1 \\\\ M_y/I_2 \\\\ M_z/I_3 \\end{pmatrix} \n=\n\\begin{pmatrix} M_y M_z (1/I_3 - 1/I_2) \\\\ M_z M_x (1/I_1 - 1/I_3) \\\\ M_x M_y (1/I_2 - 1/I_1) \\end{pmatrix}\n$$\nThe problem requires numerical integration from $t=0$ to $t=T$ with a fixed step size $h$. The number of steps is $N = T/h$. For all provided test cases, $T/h$ is an integer. Let $M_n$ be the numerical approximation of $M(n h)$.\n\n**1. Explicit Euler Method**\nThis is a first-order method. The update rule for one step is:\n$$\nM_{n+1} = M_n + h f(M_n)\n$$\nThis method is simple to implement but is known to not preserve geometric invariants like Casimirs. For the Euler-Poincaré equations, the explicit Euler method typically causes the norm of the momentum to exhibit a secular, monotonic drift. Analysis shows $\\|M_{n+1}\\|^2 = \\|M_n\\|^2 + h^2 \\|M_n \\times (I^{-1}M_n)\\|^2$, confirming a non-decreasing norm.\n\n**2. Classical Fourth-Order Runge-Kutta (RK4) Method**\nThis is a standard higher-order method. The update rule for one step is:\n$$\n\\begin{aligned}\nk_1 = f(M_n) \\\\\nk_2 = f(M_n + \\frac{h}{2} k_1) \\\\\nk_3 = f(M_n + \\frac{h}{2} k_2) \\\\\nk_4 = f(M_n + h k_3) \\\\\nM_{n+1} = M_n + \\frac{h}{6} (k_1 + 2k_2 + 2k_3 + k_4)\n\\end{aligned}\n$$\nWhile much more accurate for a given step size $h$ than explicit Euler, RK4 is also a general-purpose integrator and does not, in general, preserve the Casimir invariant $\\|M\\|^2$. However, the error in the invariant is expected to be much smaller and to decrease much more rapidly (as $O(h^4)$ or a similar high power) as $h \\to 0$.\n\n**3. Implementation and Drift Calculation**\nFor each test case, the procedure is as follows:\n- Initialize the momentum vector $M$ with its initial value $M_0$.\n- Calculate and store the initial norm, $\\|M_0\\|$.\n- Initialize a variable for the maximum relative drift, $\\Delta_{max}$, to $0$.\n- Iterate $N = T/h$ times. In each iteration $n$:\n    - Update $M_n$ to $M_{n+1}$ using either the Euler or RK4 formula.\n    - Calculate the norm of the new vector, $\\|M_{n+1}\\|$.\n    - Compute the current relative drift: $\\delta_n = \\big|\\|M_{n+1}\\| - \\|M_0\\|\\big| / \\|M_0\\|$.\n    - Update the maximum: $\\Delta_{max} = \\max(\\Delta_{max}, \\delta_n)$.\n- After the loop completes, the final value of $\\Delta_{max}$ is the result $\\Delta$ for that test case.\n\nThis process is repeated for all eight test cases defined in the problem, and the results are collected and formatted.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of numerically integrating the rigid body equations and\n    quantifying the drift in the norm of the angular momentum.\n    \"\"\"\n\n    test_cases = [\n        {'I': (1.0, 1.5, 2.0), 'M0': (0.3, 0.4, 0.5), 'T': 5.0, 'h': 1e-3, 'method': 'rk4'},\n        {'I': (1.0, 1.5, 2.0), 'M0': (0.3, 0.4, 0.5), 'T': 5.0, 'h': 5e-3, 'method': 'rk4'},\n        {'I': (1.0, 1.5, 2.0), 'M0': (0.3, 0.4, 0.5), 'T': 5.0, 'h': 5e-2, 'method': 'rk4'},\n        {'I': (1.0, 1.5, 2.0), 'M0': (0.3, 0.4, 0.5), 'T': 5.0, 'h': 1e-3, 'method': 'euler'},\n        {'I': (1.0, 1.5, 2.0), 'M0': (0.3, 0.4, 0.5), 'T': 5.0, 'h': 5e-3, 'method': 'euler'},\n        {'I': (1.0, 1.5, 2.0), 'M0': (0.3, 0.4, 0.5), 'T': 5.0, 'h': 5e-2, 'method': 'euler'},\n        {'I': (1.0, 1.0, 1.0), 'M0': (0.7, 0.0, 0.0), 'T': 5.0, 'h': 1e-1, 'method': 'euler'},\n        {'I': (1.0, 2.0, 3.0), 'M0': (1.0, 0.0, 0.5), 'T': 10.0, 'h': 1e-2, 'method': 'rk4'},\n    ]\n\n    def run_simulation(I_tuple, M0_tuple, T, h, method):\n        \"\"\"\n        Runs a single simulation and returns the maximum relative norm drift.\n\n        Args:\n            I_tuple (tuple): Principal moments of inertia (I1, I2, I3).\n            M0_tuple (tuple): Initial angular momentum (Mx, My, Mz).\n            T (float): Total integration time.\n            h (float): Fixed time step.\n            method (str): Integration method, \"euler\" or \"rk4\".\n\n        Returns:\n            float: The maximum relative norm drift Delta.\n        \"\"\"\n        I = np.array(I_tuple)\n        M0 = np.array(M0_tuple)\n        \n        # Pre-calculate inverse of inertia tensor\n        I_inv = 1.0 / I\n\n        def f(M_vec):\n            \"\"\"The right-hand side of the ODE: dM/dt = M x (I^-1 * M)\"\"\"\n            omega = I_inv * M_vec\n            return np.cross(M_vec, omega)\n\n        # Use rounding to prevent floating-point issues in calculating num_steps\n        num_steps = int(round(T / h))\n        M = np.copy(M0)\n        norm_M0 = np.linalg.norm(M0)\n\n        # If initial momentum is zero, norm is always zero, so drift is zero.\n        if norm_M0 == 0:\n            return 0.0\n\n        max_rel_drift = 0.0\n\n        # Integration loop\n        for _ in range(num_steps):\n            if method == \"euler\":\n                M = M + h * f(M)\n            elif method == \"rk4\":\n                k1 = f(M)\n                k2 = f(M + 0.5 * h * k1)\n                k3 = f(M + 0.5 * h * k2)\n                k4 = f(M + h * k3)\n                M = M + (h / 6.0) * (k1 + 2.0 * k2 + 2.0 * k3 + k4)\n            \n            # Calculate and track the maximum relative drift\n            current_norm = np.linalg.norm(M)\n            rel_drift = abs(current_norm - norm_M0) / norm_M0\n            if rel_drift  max_rel_drift:\n                max_rel_drift = rel_drift\n        \n        return max_rel_drift\n\n    results = []\n    for case in test_cases:\n        delta = run_simulation(case['I'], case['M0'], case['T'], case['h'], case['method'])\n        results.append(delta)\n\n    # Format the final output string as required\n    # \"{:.10g}\" formats a number to 10 significant digits.\n    formatted_results = [f\"{res:.10g}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}