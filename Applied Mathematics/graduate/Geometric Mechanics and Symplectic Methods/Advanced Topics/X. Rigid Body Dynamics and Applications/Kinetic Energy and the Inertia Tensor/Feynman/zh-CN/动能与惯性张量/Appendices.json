{
    "hands_on_practices": [
        {
            "introduction": "在研究刚体动力学时，惯性张量是描述其旋转惯性的核心。这个练习将带我们回归第一性原理，从动能的基本定义出发，通过体积积分推导出惯性张量的具体形式。通过为一个具有均匀密度和简单几何形状（矩形块）的物体执行此计算，我们可以巩固对惯性张量物理意义的理解，并为处理更复杂的物体奠定坚实的基础 。",
            "id": "3740943",
            "problem": "考虑一个自由刚体，其位形空间为特殊正交群 (SO(3))。在体坐标系中，设质量密度为一个光滑函数 $\\rho(x)$，其支撑集为有界区域 $\\mathcal{B} \\subset \\mathbb{R}^{3}$，其中 $x \\in \\mathcal{B}$ 是相对于位于质心的体固坐标系原点测量的。该刚体的角速度在体坐标系中表示为 $\\omega \\in \\mathbb{R}^{3}$，瞬时体速度场为 $v(x) = \\omega \\times x$。其动能由积分 $T = \\frac{1}{2} \\int_{\\mathcal{B}} \\rho(x) \\|v(x)\\|^{2} \\, dx$ 给出。\n\n从这个基本出发点开始，首先推导惯性张量 $I \\in \\mathbb{R}^{3 \\times 3}$ 的显式积分公式，使得 $T = \\frac{1}{2} \\, \\omega^{\\top} I \\, \\omega$ 对所有 $\\omega$ 都成立。其次，对于一个占据物体区域 $\\mathcal{B} = \\left[-\\frac{L_{x}}{2}, \\frac{L_{x}}{2}\\right] \\times \\left[-\\frac{L_{y}}{2}, \\frac{L_{y}}{2}\\right] \\times \\left[-\\frac{L_{z}}{2}, \\frac{L_{z}}{2}\\right]$ 的均匀长方体，计算此公式。该长方体密度为常数 $\\rho_{0} > 0$，总质量为 $m = \\rho_{0} L_{x} L_{y} L_{z}$。使用与长方体边缘对齐的体固坐标轴（因此惯性张量及其主惯性矩是关于以长方体边缘为轴的质心坐标系计算的）。\n\n以 $m$、$L_{x}$、$L_{y}$ 和 $L_{z}$ 表示主惯性矩的有序三元组 $(I_{xx}, I_{yy}, I_{zz})$ 作为最终答案。最终答案的单位为国际单位制（SI）的千克米平方。将最终的三元组写成一个单行矩阵。无需四舍五入。",
            "solution": "该问题提出了一个经典力学中有效且适定的问题，具体涉及自由刚体的动力学。所有定义和给定条件都是标准的、科学上合理的且自洽的。问题由两部分组成：首先，从动能推导惯性张量的一般形式；其次，针对特定几何形状计算该张量。\n\n第一部分：惯性张量的推导\n\n刚体的动能 $T$ 由其无穷小质量元的动能在其体积上的积分给出。在以质心为原点的体固坐标系中，点 $x \\in \\mathcal{B}$ 的速度纯粹是转动的，由 $v(x) = \\omega \\times x$ 给出，其中 $\\omega$ 是物体的角速度矢量。\n\n动能为：\n$$\nT = \\frac{1}{2} \\int_{\\mathcal{B}} \\rho(x) \\|v(x)\\|^{2} \\, d^3x = \\frac{1}{2} \\int_{\\mathcal{B}} \\rho(x) \\|\\omega \\times x\\|^{2} \\, d^3x\n$$\n我们使用向量恒等式 $\\|\\mathbf{a} \\times \\mathbf{b}\\|^2 = \\|\\mathbf{a}\\|^2 \\|\\mathbf{b}\\|^2 - (\\mathbf{a} \\cdot \\mathbf{b})^2$。令 $\\omega = (\\omega_1, \\omega_2, \\omega_3)$ 和 $x = (x_1, x_2, x_3)$。则 $\\|\\omega\\|^2 = \\sum_i \\omega_i^2$，$\\|x\\|^2 = \\sum_k x_k^2$ 且 $\\omega \\cdot x = \\sum_j \\omega_j x_j$。\n因此，\n$$\n\\|\\omega \\times x\\|^2 = \\left(\\sum_i \\omega_i^2\\right) \\left(\\sum_k x_k^2\\right) - \\left(\\sum_j \\omega_j x_j\\right)^2\n$$\n我们可以将其表示为 $\\omega$ 的二次型。我们使用爱因斯坦求和约定的指标记法。\n$$\n\\|\\omega \\times x\\|^2 = \\omega_i \\omega_i x_k x_k - (\\omega_j x_j)(\\omega_m x_m)\n$$\n为了将其写成 $\\omega_j I_{jm} \\omega_m$ 的形式，我们处理一下指标：\n$$\n\\|\\omega \\times x\\|^2 = \\omega_j \\delta_{jm} \\omega_m x_k x_k - \\omega_j x_j \\omega_m x_m\n$$\n其中 $\\delta_{jm}$ 是克罗内克δ符号。将 $\\omega_j$ 和 $\\omega_m$ 因子分解出来：\n$$\n\\|\\omega \\times x\\|^2 = \\omega_j \\left( \\delta_{jm} (x_k x_k) - x_j x_m \\right) \\omega_m\n$$\n将此代回动能积分中：\n$$\nT = \\frac{1}{2} \\int_{\\mathcal{B}} \\rho(x) \\left( \\omega_j \\left( \\delta_{jm} \\|x\\|^2 - x_j x_m \\right) \\omega_m \\right) \\, d^3x\n$$\n由于角速度的分量 $\\omega_j$ 相对于在物体 $\\mathcal{B}$ 上的空间积分是常数，我们可以将它们从积分中提出：\n$$\nT = \\frac{1}{2} \\, \\omega_j \\left( \\int_{\\mathcal{B}} \\rho(x) \\left( \\delta_{jm} \\|x\\|^2 - x_j x_m \\right) \\, d^3x \\right) \\omega_m\n$$\n该表达式的形式为 $T = \\frac{1}{2} \\omega^{\\top} I \\omega$，用指标记法表示为 $T = \\frac{1}{2} \\omega_j I_{jm} \\omega_m$。通过直接比较，我们确定惯性张量 $I$ 的分量为：\n$$\nI_{jm} = \\int_{\\mathcal{B}} \\rho(x) \\left( \\delta_{jm} \\|x\\|^2 - x_j x_m \\right) \\, d^3x\n$$\n这就是惯性张量的一般积分公式。\n对角分量（$j=m$），称为转动惯量，为：\n$$\nI_{jj} = \\int_{\\mathcal{B}} \\rho(x) \\left( \\|x\\|^2 - x_j^2 \\right) \\, d^3x\n$$\n例如，使用坐标 $(x,y,z)$ 代替 $(x_1, x_2, x_3)$：\n$$\nI_{xx} = I_{11} = \\int_{\\mathcal{B}} \\rho(x,y,z) (y^2+z^2) \\, dx\\,dy\\,dz\n$$\n非对角分量（$j \\neq m$），称为惯性积，为：\n$$\nI_{jm} = - \\int_{\\mathcal{B}} \\rho(x) x_j x_m \\, d^3x\n$$\n\n第二部分：对均匀长方体的计算\n\n给定一个密度为常数 $\\rho_0$、尺寸为 $L_x, L_y, L_z$ 的长方体。区域为 $\\mathcal{B} = \\left[-\\frac{L_{x}}{2}, \\frac{L_{x}}{2}\\right] \\times \\left[-\\frac{L_{y}}{2}, \\frac{L_{y}}{2}\\right] \\times \\left[-\\frac{L_{z}}{2}, \\frac{L_{z}}{2}\\right]$。总质量为 $m = \\rho_0 L_x L_y L_z$。体固坐标轴与长方体的边缘对齐。\n\n首先，我们检查惯性积。例如，$I_{xy}$：\n$$\nI_{xy} = - \\int_{\\mathcal{B}} \\rho_0 x y \\, dx\\,dy\\,dz = -\\rho_0 \\left( \\int_{-L_x/2}^{L_x/2} x \\, dx \\right) \\left( \\int_{-L_y/2}^{L_y/2} y \\, dy \\right) \\left( \\int_{-L_z/2}^{L_z/2} dz \\right)\n$$\n积分 $\\int_{-L_x/2}^{L_x/2} x \\, dx = \\left[ \\frac{x^2}{2} \\right]_{-L_x/2}^{L_x/2} = \\frac{1}{2}\\left(\\left(\\frac{L_x}{2}\\right)^2 - \\left(-\\frac{L_x}{2}\\right)^2\\right) = 0$。\n该积分为零，因为被积函数是在对称区间上的奇函数。因此，$I_{xy} = 0$。根据对称性，$I_{xz} = 0$ 且 $I_{yz} = 0$。惯性张量是对角的，其对角元素是主惯性矩。\n\n现在，我们计算主惯性矩。让我们从 $I_{xx}$ 开始：\n$$\nI_{xx} = \\int_{\\mathcal{B}} \\rho_0 (y^2 + z^2) \\, dx\\,dy\\,dz = \\rho_0 \\left( \\int_{\\mathcal{B}} y^2 \\, dV + \\int_{\\mathcal{B}} z^2 \\, dV \\right)\n$$\n其中 $dV = dx\\,dy\\,dz$。我们计算第一个积分：\n$$\n\\int_{\\mathcal{B}} y^2 \\, dV = \\int_{-L_x/2}^{L_x/2} dx \\int_{-L_y/2}^{L_y/2} y^2 \\, dy \\int_{-L_z/2}^{L_z/2} dz\n$$\n分离的积分为：\n$\\int_{-L_x/2}^{L_x/2} dx = L_x$\n$\\int_{-L_z/2}^{L_z/2} dz = L_z$\n$\\int_{-L_y/2}^{L_y/2} y^2 \\, dy = \\left[ \\frac{y^3}{3} \\right]_{-L_y/2}^{L_y/2} = \\frac{1}{3}\\left( \\left(\\frac{L_y}{2}\\right)^3 - \\left(-\\frac{L_y}{2}\\right)^3 \\right) = \\frac{1}{3}\\left(\\frac{L_y^3}{8} + \\frac{L_y^3}{8}\\right) = \\frac{L_y^3}{12}$\n因此，$\\int_{\\mathcal{B}} y^2 \\, dV = L_x \\left( \\frac{L_y^3}{12} \\right) L_z = \\frac{L_x L_y^3 L_z}{12}$。\n通过对称性论证，$\\int_{\\mathcal{B}} z^2 \\, dV = \\frac{L_x L_y L_z^3}{12}$。\n将这些结果代回 $I_{xx}$ 的表达式中：\n$$\nI_{xx} = \\rho_0 \\left( \\frac{L_x L_y^3 L_z}{12} + \\frac{L_x L_y L_z^3}{12} \\right) = \\frac{\\rho_0 L_x L_y L_z}{12} (L_y^2 + L_z^2)\n$$\n使用给定的总质量关系 $m = \\rho_0 L_x L_y L_z$，我们得到：\n$$\nI_{xx} = \\frac{m}{12} (L_y^2 + L_z^2)\n$$\n另外两个主惯性矩，$I_{yy}$ 和 $I_{zz}$，可以通过对指标 $x, y, z$ 和相应的尺寸 $L_x, L_y, L_z$ 进行循环置换得到：\n$$\nI_{yy} = \\frac{m}{12} (L_x^2 + L_z^2)\n$$\n$$\nI_{zz} = \\frac{m}{12} (L_x^2 + L_y^2)\n$$\n因此，主惯性矩的有序三元组 $(I_{xx}, I_{yy}, I_{zz})$ 是：\n$$\n\\left( \\frac{m}{12}(L_y^2 + L_z^2), \\frac{m}{12}(L_x^2 + L_z^2), \\frac{m}{12}(L_x^2 + L_y^2) \\right)\n$$\n这些表达式的单位是质量乘以长度的平方（例如，在国际单位制中为 kg m$^2$），这符合转动惯量的要求。最终答案要求以单行矩阵的形式给出。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{m}{12}(L_y^2 + L_z^2)  \\frac{m}{12}(L_x^2 + L_z^2)  \\frac{m}{12}(L_x^2 + L_y^2) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "现实世界中的工程系统，例如机器人、卫星或车辆，通常是由多个部件刚性连接而成的复合体。这个练习探讨了如何处理这类系统，特别是如何运用平行轴定理来计算复合刚体的总惯性张量。通过这个实践，你将学会如何将各个部件的惯性特性组合起来，从而得到整个系统的动力学模型，这是分析复杂多体系统动态行为的一项关键技能 。",
            "id": "3750941",
            "problem": "考虑一个组合刚体，它由两个刚性部件（标记为 $1$ 和 $2$）刚性连接而成，因此它们作为一个整体一起运动。在一个固定的惯性空间参考系 $\\mathcal{F}$ 中进行计算，该参考系的原点为 $O$，基向量为标准正交向量。假设该组合刚体绕 $O$ 点以角速度 $\\boldsymbol{\\omega}$ 进行纯转动，角度以弧度为单位。在几何力学中，刚体的转动动能是通过对质点进行积分的动能连续介质表达式来定义的，其中使用了由三维特殊欧几里得群 (SE(3)) 的刚体运动所产生的刚体速度场：\n$$\nT \\;=\\; \\frac{1}{2}\\int \\rho(\\mathbf{x})\\,\\|\\mathbf{v}(\\mathbf{x})\\|^{2}\\,d^{3}\\mathbf{x},\n$$\n其中 $\\rho(\\mathbf{x})$ 是质量密度，$\\mathbf{v}(\\mathbf{x})$ 是位于空间位置 $\\mathbf{x}$ 的质点的速度。从这个定义和绕 $O$ 点纯转动的刚体运动学公式 $\\mathbf{v}(\\mathbf{x}) = \\boldsymbol{\\omega}\\times \\mathbf{x}$ 出发，推导出组合刚体关于原点 $O$ 的总惯性张量 $\\mathbf{I}_{O}$ 的表达式，该表达式应使用各部件的质量 $m_{i}$、它们相对于 $O$ 的质心位置 $\\mathbf{r}_{i}$ 以及各部件关于其自身质心的惯性张量 $\\mathbf{I}_{i,c_{i}}$ 来表示，所有这些量都在空间参考系 $\\mathcal{F}$ 中表达。然后使用您推导的表达式，根据以下数据计算转动动能 $T = \\frac{1}{2}\\boldsymbol{\\omega}^{\\mathsf{T}}\\mathbf{I}_{O}\\boldsymbol{\\omega}$：\n- 部件 $1$：质量 $m_{1} = 3.2\\,\\mathrm{kg}$，质心位置 $\\mathbf{r}_{1} = \\begin{pmatrix}0.25 \\\\ -0.10 \\\\ 0.05\\end{pmatrix}\\,\\mathrm{m}$，关于其质心的惯性张量 $\\mathbf{I}_{1,c_{1}} = \\begin{pmatrix}0.12  0  0 \\\\ 0  0.15  0 \\\\ 0  0  0.09\\end{pmatrix}\\,\\mathrm{kg\\,m^{2}}$。\n- 部件 $2$：质量 $m_{2} = 2.7\\,\\mathrm{kg}$，质心位置 $\\mathbf{r}_{2} = \\begin{pmatrix}-0.15 \\\\ 0.20 \\\\ 0.00\\end{pmatrix}\\,\\mathrm{m}$，关于其质心的惯性张量 $\\mathbf{I}_{2,c_{2}} = \\begin{pmatrix}0.08  0.01  -0.005 \\\\ 0.01  0.11  0.002 \\\\ -0.005  0.002  0.10\\end{pmatrix}\\,\\mathrm{kg\\,m^{2}}$。\n- 组合刚体角速度 $\\boldsymbol{\\omega} = \\begin{pmatrix}2.0 \\\\ -1.5 \\\\ 0.75\\end{pmatrix}\\,\\mathrm{rad/s}$。\n\n您的答案必须是一个等于转动动能 $T$ 的单个实数。将您的答案四舍五入到四位有效数字。最终能量以 $\\mathrm{J}$（焦耳）为单位表示。",
            "solution": "用户的请求已经过验证，确认为一个刚体动力学中的良定问题。求解过程分两个阶段：首先，推导组合刚体惯性张量的公式；其次，使用所提供的数据对动能进行数值计算。\n\n刚体的转动动能 $T$ 由其体积 $\\mathcal{B}$ 上带有质量密度 $\\rho(\\mathbf{x})$ 的积分给出：\n$$\nT \\;=\\; \\frac{1}{2}\\int_{\\mathcal{B}} \\rho(\\mathbf{x})\\,\\|\\mathbf{v}(\\mathbf{x})\\|^{2}\\,d V\n$$\n对于一个绕固定原点 $O$ 以角速度 $\\boldsymbol{\\omega}$ 进行纯转动的刚体，位于位置 $\\mathbf{x}$ 的点的速度由 $\\mathbf{v}(\\mathbf{x}) = \\boldsymbol{\\omega} \\times \\mathbf{x}$ 给出。将此代入能量表达式，得到：\n$$\nT \\;=\\; \\frac{1}{2}\\int_{\\mathcal{B}} \\rho(\\mathbf{x})\\,\\|\\boldsymbol{\\omega} \\times \\mathbf{x}\\|^{2}\\,d V\n$$\n范数的平方可以表示为 $\\boldsymbol{\\omega}$ 的一个二次型。使用恒等式 $\\|\\mathbf{a} \\times \\mathbf{b}\\|^2 = \\mathbf{a}^{\\mathsf{T}}(\\|\\mathbf{b}\\|^2\\mathbf{1} - \\mathbf{b}\\mathbf{b}^{\\mathsf{T}})\\mathbf{a}$，其中 $\\mathbf{1}$ 是 $3 \\times 3$ 单位矩阵，我们可以写出：\n$$\n\\|\\boldsymbol{\\omega} \\times \\mathbf{x}\\|^{2} = \\boldsymbol{\\omega}^{\\mathsf{T}}(\\|\\mathbf{x}\\|^2\\mathbf{1} - \\mathbf{x}\\mathbf{x}^{\\mathsf{T}})\\boldsymbol{\\omega}\n$$\n由于 $\\boldsymbol{\\omega}$ 在整个刚体上是相同的，我们可以将其提到积分号外面：\n$$\nT \\;=\\; \\frac{1}{2}\\boldsymbol{\\omega}^{\\mathsf{T}} \\left( \\int_{\\mathcal{B}} \\rho(\\mathbf{x}) (\\|\\mathbf{x}\\|^2\\mathbf{1} - \\mathbf{x}\\mathbf{x}^{\\mathsf{T}}) \\,d V \\right) \\boldsymbol{\\omega}\n$$\n括号中的项是刚体关于原点 $O$ 的惯性张量 $\\mathbf{I}_O$ 的定义：\n$$\n\\mathbf{I}_O \\;=\\; \\int_{\\mathcal{B}} \\rho(\\mathbf{x}) (\\|\\mathbf{x}\\|^2\\mathbf{1} - \\mathbf{x}\\mathbf{x}^{\\mathsf{T}}) \\,d V\n$$\n因此，动能由表达式 $T = \\frac{1}{2}\\boldsymbol{\\omega}^{\\mathsf{T}}\\mathbf{I}_{O}\\boldsymbol{\\omega}$ 给出。\n\n对于一个由标记为 $1$ 和 $2$ 的两个部件组成的组合刚体，其总动能是各部件动能之和，即 $T = T_1 + T_2$。因此，总惯性张量是各部件惯性张量之和，所有张量都相对于同一原点 $O$：\n$$\n\\mathbf{I}_O \\;=\\; \\mathbf{I}_{O,1} + \\mathbf{I}_{O,2}\n$$\n题目给出了每个部件关于其自身质心的惯性张量 $\\mathbf{I}_{i,c_i}$。我们必须使用平行轴定理来求出每个部件关于原点 $O$ 的惯性张量。设 $\\mathbf{r}_i$ 是部件 $i$ 的质心 $c_i$ 相对于 $O$ 的位置向量。设 $\\mathbf{x}'$ 是部件 $i$ 内一个质量元相对于其质心 $c_i$ 的位置，因此相对于 $O$ 的位置是 $\\mathbf{x} = \\mathbf{r}_i + \\mathbf{x}'$。惯性张量 $\\mathbf{I}_{O,i}$ 是：\n$$\n\\mathbf{I}_{O,i} \\;=\\; \\int_{\\mathcal{B}_i} \\rho_i(\\mathbf{x}'+\\mathbf{r}_i) (\\|\\mathbf{r}_i+\\mathbf{x}'\\|^2\\mathbf{1} - (\\mathbf{r}_i+\\mathbf{x}')(\\mathbf{r}_i+\\mathbf{x}')^{\\mathsf{T}}) \\,d V'\n$$\n展开积分内的各项，并使用质心的定义 $\\int_{\\mathcal{B}_i} \\rho_i \\mathbf{x}' \\,d V' = \\mathbf{0}$，即可得到平行轴定理：\n$$\n\\mathbf{I}_{O,i} \\;=\\; \\mathbf{I}_{i,c_i} + m_i (\\|\\mathbf{r}_i\\|^2\\mathbf{1} - \\mathbf{r}_i\\mathbf{r}_i^{\\mathsf{T}})\n$$\n其中 $m_i = \\int_{\\mathcal{B}_i} \\rho_i \\,dV'$ 是部件 $i$ 的质量。\n\n因此，组合刚体关于 $O$ 的总惯性张量是：\n$$\n\\mathbf{I}_O \\;=\\; \\sum_{i=1}^{2} \\left( \\mathbf{I}_{i,c_i} + m_i (\\|\\mathbf{r}_i\\|^2\\mathbf{1} - \\mathbf{r}_i\\mathbf{r}_i^{\\mathsf{T}}) \\right)\n$$\n这就是所要求解的通用表达式。我们现在根据给定的数据对其进行计算。\n\n对于部件 1：\n$m_1 = 3.2\\,\\mathrm{kg}$，$\\mathbf{r}_1 = \\begin{pmatrix}0.25 \\\\ -0.10 \\\\ 0.05\\end{pmatrix}\\,\\mathrm{m}$。\n$\\|\\mathbf{r}_1\\|^2 = 0.25^2 + (-0.10)^2 + 0.05^2 = 0.0625 + 0.01 + 0.0025 = 0.075\\,\\mathrm{m}^2$。\n位移项是 $\\Delta\\mathbf{I}_1 = m_1 (\\|\\mathbf{r}_1\\|^2\\mathbf{1} - \\mathbf{r}_1\\mathbf{r}_1^{\\mathsf{T}})$。\n$$\n\\mathbf{r}_1\\mathbf{r}_1^{\\mathsf{T}} = \\begin{pmatrix} 0.25 \\\\ -0.10 \\\\ 0.05 \\end{pmatrix} \\begin{pmatrix} 0.25  -0.10  0.05 \\end{pmatrix} = \\begin{pmatrix} 0.0625  -0.025  0.0125 \\\\ -0.025  0.01  -0.005 \\\\ 0.0125  -0.005  0.0025 \\end{pmatrix}\\,\\mathrm{m}^2\n$$\n$$\n\\|\\mathbf{r}_1\\|^2\\mathbf{1} - \\mathbf{r}_1\\mathbf{r}_1^{\\mathsf{T}} = \\begin{pmatrix} 0.075  0  0 \\\\ 0  0.075  0 \\\\ 0  0  0.075 \\end{pmatrix} - \\begin{pmatrix} 0.0625  -0.025  0.0125 \\\\ -0.025  0.01  -0.005 \\\\ 0.0125  -0.005  0.0025 \\end{pmatrix} = \\begin{pmatrix} 0.0125  0.025  -0.0125 \\\\ 0.025  0.065  0.005 \\\\ -0.0125  0.005  0.0725 \\end{pmatrix}\\,\\mathrm{m}^2\n$$\n$$\n\\Delta\\mathbf{I}_1 = 3.2 \\times \\begin{pmatrix} 0.0125  0.025  -0.0125 \\\\ 0.025  0.065  0.005 \\\\ -0.0125  0.005  0.0725 \\end{pmatrix} = \\begin{pmatrix} 0.04  0.08  -0.04 \\\\ 0.08  0.208  0.016 \\\\ -0.04  0.016  0.232 \\end{pmatrix}\\,\\mathrm{kg\\,m^2}\n$$\n$$\n\\mathbf{I}_{O,1} = \\mathbf{I}_{1,c_1} + \\Delta\\mathbf{I}_1 = \\begin{pmatrix} 0.12  0  0 \\\\ 0  0.15  0 \\\\ 0  0  0.09 \\end{pmatrix} + \\begin{pmatrix} 0.04  0.08  -0.04 \\\\ 0.08  0.208  0.016 \\\\ -0.04  0.016  0.232 \\end{pmatrix} = \\begin{pmatrix} 0.16  0.08  -0.04 \\\\ 0.08  0.358  0.016 \\\\ -0.04  0.016  0.322 \\end{pmatrix}\\,\\mathrm{kg\\,m^2}\n$$\n\n对于部件 2：\n$m_2 = 2.7\\,\\mathrm{kg}$，$\\mathbf{r}_2 = \\begin{pmatrix}-0.15 \\\\ 0.20 \\\\ 0.00\\end{pmatrix}\\,\\mathrm{m}$。\n$\\|\\mathbf{r}_2\\|^2 = (-0.15)^2 + 0.20^2 + 0.00^2 = 0.0225 + 0.04 = 0.0625\\,\\mathrm{m}^2$。\n$$\n\\Delta\\mathbf{I}_2 = m_2 (\\|\\mathbf{r}_2\\|^2\\mathbf{1} - \\mathbf{r}_2\\mathbf{r}_2^{\\mathsf{T}}) = 2.7 \\left( \\begin{pmatrix} 0.0625  0  0 \\\\ 0  0.0625  0 \\\\ 0  0  0.0625 \\end{pmatrix} - \\begin{pmatrix} 0.0225  -0.03  0 \\\\ -0.03  0.04  0 \\\\ 0  0  0 \\end{pmatrix} \\right)\n$$\n$$\n\\Delta\\mathbf{I}_2 = 2.7 \\times \\begin{pmatrix} 0.04  0.03  0 \\\\ 0.03  0.0225  0 \\\\ 0  0  0.0625 \\end{pmatrix} = \\begin{pmatrix} 0.108  0.081  0 \\\\ 0.081  0.06075  0 \\\\ 0  0  0.16875 \\end{pmatrix}\\,\\mathrm{kg\\,m^2}\n$$\n$$\n\\mathbf{I}_{O,2} = \\mathbf{I}_{2,c_2} + \\Delta\\mathbf{I}_2 = \\begin{pmatrix} 0.08  0.01  -0.005 \\\\ 0.01  0.11  0.002 \\\\ -0.005  0.002  0.10 \\end{pmatrix} + \\begin{pmatrix} 0.108  0.081  0 \\\\ 0.081  0.06075  0 \\\\ 0  0  0.16875 \\end{pmatrix} = \\begin{pmatrix} 0.188  0.091  -0.005 \\\\ 0.091  0.17075  0.002 \\\\ -0.005  0.002  0.26875 \\end{pmatrix}\\,\\mathrm{kg\\,m^2}\n$$\n\n组合刚体的总惯性张量为 $\\mathbf{I}_O = \\mathbf{I}_{O,1} + \\mathbf{I}_{O,2}$：\n$$\n\\mathbf{I}_O = \\begin{pmatrix} 0.16  0.08  -0.04 \\\\ 0.08  0.358  0.016 \\\\ -0.04  0.016  0.322 \\end{pmatrix} + \\begin{pmatrix} 0.188  0.091  -0.005 \\\\ 0.091  0.17075  0.002 \\\\ -0.005  0.002  0.26875 \\end{pmatrix}\n$$\n$$\n\\mathbf{I}_O = \\begin{pmatrix} 0.348  0.171  -0.045 \\\\ 0.171  0.52875  0.018 \\\\ -0.045  0.018  0.59075 \\end{pmatrix}\\,\\mathrm{kg\\,m^2}\n$$\n\n最后，我们用 $\\boldsymbol{\\omega} = \\begin{pmatrix}2.0 \\\\ -1.5 \\\\ 0.75\\end{pmatrix}\\,\\mathrm{rad/s}$ 计算动能 $T = \\frac{1}{2}\\boldsymbol{\\omega}^{\\mathsf{T}}\\mathbf{I}_{O}\\boldsymbol{\\omega}$。\n首先，我们计算乘积 $\\mathbf{I}_O \\boldsymbol{\\omega}$：\n$$\n\\mathbf{I}_O\\boldsymbol{\\omega} = \\begin{pmatrix} 0.348  0.171  -0.045 \\\\ 0.171  0.52875  0.018 \\\\ -0.045  0.018  0.59075 \\end{pmatrix} \\begin{pmatrix} 2.0 \\\\ -1.5 \\\\ 0.75 \\end{pmatrix} = \\begin{pmatrix} 0.348(2.0) + 0.171(-1.5) - 0.045(0.75) \\\\ 0.171(2.0) + 0.52875(-1.5) + 0.018(0.75) \\\\ -0.045(2.0) + 0.018(-1.5) + 0.59075(0.75) \\end{pmatrix}\n$$\n$$\n\\mathbf{I}_O\\boldsymbol{\\omega} = \\begin{pmatrix} 0.696 - 0.2565 - 0.03375 \\\\ 0.342 - 0.793125 + 0.0135 \\\\ -0.09 - 0.027 + 0.4430625 \\end{pmatrix} = \\begin{pmatrix} 0.40575 \\\\ -0.437625 \\\\ 0.3260625 \\end{pmatrix}\n$$\n现在，我们计算二次型 $\\boldsymbol{\\omega}^{\\mathsf{T}}(\\mathbf{I}_O \\boldsymbol{\\omega})$：\n$$\n\\boldsymbol{\\omega}^{\\mathsf{T}}(\\mathbf{I}_O \\boldsymbol{\\omega}) = \\begin{pmatrix} 2.0  -1.5  0.75 \\end{pmatrix} \\begin{pmatrix} 0.40575 \\\\ -0.437625 \\\\ 0.3260625 \\end{pmatrix}\n$$\n$$\n= 2.0(0.40575) - 1.5(-0.437625) + 0.75(0.3260625) = 0.8115 + 0.6564375 + 0.244546875 = 1.712484375\n$$\n动能是该值的一半：\n$$\nT = \\frac{1}{2}(1.712484375) = 0.8562421875\\,\\mathrm{J}\n$$\n按要求四舍五入到四位有效数字，我们得到 $T = 0.8562\\,\\mathrm{J}$。",
            "answer": "$$\\boxed{0.8562}$$"
        },
        {
            "introduction": "理论与实践的结合是几何力学的魅力所在。在机器人学、航空航天和计算机图形学等领域，我们经常需要从传感器测量的姿态数据中提取动力学信息。这个练习提供了一个从离散的姿态矩阵时间序列 $R(t_k)$ 计算刚体角速度 $\\boldsymbol{\\omega}_b(t_k)$ 和旋转动能 $T_{\\text{rot}}(t_k)$ 的完整计算流程。它将抽象的李群 $SO(3)$ 与其李代数 $\\mathfrak{so}(3)$ 的关系与实际的数值计算相结合，让你能够亲手实现从运动学数据到能量计算的转化 。",
            "id": "3750940",
            "problem": "给定一个姿态矩阵 $R(t_k) \\in \\mathrm{SO}(3)$ 的时间序列，其中 $\\mathrm{SO}(3)$ 表示由行列式为 $1$ 的 $3 \\times 3$ 实正交矩阵构成的特殊正交群，以及一个恒定的体坐标系惯性张量 $I_b \\in \\mathbb{R}^{3 \\times 3}$，该张量是对称正定的。你的任务是从第一性原理出发，推导如何从时间序列 $R(t_k)$ 计算体坐标系角速度 $\\omega_b(t_k) \\in \\mathbb{R}^3$，然后用它来估算刚体的转动动能 $T_{\\text{rot}}(t_k)$。所有角度单位必须是弧度，时间单位为秒，惯性单位为千克·米平方 ($\\mathrm{kg \\cdot m^2}$)，角速度单位为弧度/秒 ($\\mathrm{rad/s}$)，能量单位为焦耳 ($\\mathrm{J}$)。\n\n使用的基本原理：\n- $\\mathrm{SO}(3)$ 的定义意味着对于所有 $t$，都有 $R(t)^\\top R(t) = I$ 和 $\\det R(t) = 1$，其中 $I$ 是单位矩阵。\n- 特殊正交群 (SO(3)) 的李代数由 $3 \\times 3$ 的斜对称矩阵组成。\n- 刚体的转动动能源于动能密度在物体质量分布上的积分，并且可以用体坐标系中的惯性张量和体角速度来表示。\n\n你的算法实现应包括：\n- 根据提供的测试套件规范构建 $R(t_k)$。\n- 使用与单位和几何结构一致的有限差分格式，从离散时间序列中近似计算 $\\dot{R}(t_k)$。对内部点使用中心差分，对端点使用前向/后向差分。\n- 推导并实现由特殊正交群及其李代数的结构所决定的体角速度与姿态矩阵导数之间的关系。在映射到李代数时，在数值上强制施加斜对称性，以减轻离散化产生的误差。\n- 通过 $\\mathfrak{so}(3)$ 与 $\\mathbb{R}^3$ 之间的标准同构（\"vee\" 算子），将每个时间点 $t_k$ 得到的斜对称矩阵映射到唯一的角速度向量 $\\omega_b(t_k) \\in \\mathbb{R}^3$。\n- 使用由惯性张量定义得出的适当表达式，从 $\\omega_b(t_k)$ 和 $I_b$ 计算 $T_{\\text{rot}}(t_k)$。\n\n测试套件：\n- 情况 1 (理想情况，绕 z 轴的匀速转动)：\n  - 惯性张量 $I_b = \\mathrm{diag}(2.0,\\,3.0,\\,4.0)$，单位 $\\mathrm{kg \\cdot m^2}$。\n  - 时间样本 $t_k = k \\Delta t$，其中 $\\Delta t = 0.001$ 且 $k = 0,1,\\dots,2000$，总时长为 $2.000$ 秒。\n  - 姿态 $R(t) = R_z(\\theta(t))$，其中 $\\theta(t) = t$（单位为弧度），$R_z(\\theta)$ 是绕 z 轴旋转角度 $\\theta$ 的旋转矩阵。使用三角函数进行 $R_z(\\theta)$ 的标准构建。\n  - 设真实恒定角速度为 $\\omega_z = 1\\,\\mathrm{rad/s}$，因此真实转动动能为 $T^\\star = \\tfrac{1}{2} I_{zz} \\omega_z^2 = 2.0\\,\\mathrm{J}$。计算并返回最大绝对偏差 $E_1 = \\max_k \\lvert T_{\\text{rot}}(t_k) - T^\\star \\rvert$，以焦耳为单位表示。\n\n- 情况 2 (边界情况，近单位矩阵的小角度抖动)：\n  - 惯性张量 $I_b = \\mathrm{diag}(2.0,\\,3.0,\\,4.0)$，单位 $\\mathrm{kg \\cdot m^2}$。\n  - 时间样本 $t_k = k \\Delta t$，其中 $\\Delta t = 0.001$ 且 $k = 0,1,\\dots,1000$，总时长为 $1.000$ 秒。\n  - 小角度函数 $\\alpha(t) = \\varepsilon \\sin(2 \\pi t)$ 和 $\\beta(t) = \\varepsilon \\cos(2 \\pi t)$，其中 $\\varepsilon = 10^{-3}$ 弧度。\n  - 姿态 $R(t) = R_x(\\alpha(t))\\, R_y(\\beta(t))$，其中 $R_x(\\cdot)$ 和 $R_y(\\cdot)$ 是分别绕 x 轴和 y 轴旋转的旋转矩阵，由三角函数构建。\n  - 计算并返回 $M_2 = \\max_k \\lVert \\omega_b(t_k) \\rVert_2$，单位为 $\\mathrm{rad/s}$。\n\n- 情况 3 (一般时变旋转与非对角惯性张量)：\n  - 惯性张量\n    $$I_b = \\begin{bmatrix}\n    3.0  0.2  0.1 \\\\\n    0.2  2.0  0.3 \\\\\n    0.1  0.3  1.5\n    \\end{bmatrix} \\quad \\text{单位 } \\mathrm{kg \\cdot m^2}。$$\n  - 时间样本 $t_k = k \\Delta t$，其中 $\\Delta t = 0.002$ 且 $k = 0,1,\\dots,500$，总时长为 $1.000$ 秒。\n  - 姿态\n    $$R(t) = R_z(0.8\\, t)\\, R_x(0.3 \\sin(2 t))\\, R_y(0.5\\, t^2),$$\n    其中 $R_x, R_y, R_z$ 的自变量单位为弧度。\n  - 计算并返回平均转动动能\n    $$M_3 = \\frac{1}{N} \\sum_{k=0}^{N-1} T_{\\text{rot}}(t_k),$$\n    以焦耳为单位表示。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表：$[E_1, M_2, M_3]$。确保这三个数字按此确切顺序返回，并使用指定的单位：$E_1$ 单位为焦耳，$M_2$ 单位为弧度/秒，$M_3$ 单位为焦耳。",
            "solution": "该问题是有效的，因为它在科学上基于刚体力学，在数学上是适定的，并且所有提供的数据和约束都是自洽和客观的。我们现在将从第一性原理出发，给出一个完整的解决方案。\n\n### 理论基础\n\n问题的核心在于刚体的姿态（由姿态矩阵 $R(t) \\in \\mathrm{SO}(3)$ 表示）与其角速度 $\\omega_b(t) \\in \\mathbb{R}^3$ 之间的关系。这种关系根植于特殊正交群 $\\mathrm{SO}(3)$ 及其关联的李代数 $\\mathfrak{so}(3)$ 的几何结构。\n\n#### 1. 体角速度的推导\n\n姿态矩阵 $R(t)$ 将向量从体坐标系转换到空间（惯性）参考系。设 $\\mathbf{x}_b$ 是体坐标系中的一个恒定向量。它在空间坐标系中的表示是随时间变化的：$\\mathbf{x}_s(t) = R(t)\\mathbf{x}_b$。\n\n点 $\\mathbf{x}_s(t)$ 在空间坐标系中的速度通过对时间求导得到：\n$$ \\dot{\\mathbf{x}}_s(t) = \\frac{d}{dt}(R(t)\\mathbf{x}_b) = \\dot{R}(t)\\mathbf{x}_b $$\n根据运动学，该点的速度也由空间角速度向量 $\\omega_s(t)$ 与位置向量 $\\mathbf{x}_s(t)$ 的叉积给出：\n$$ \\dot{\\mathbf{x}}_s(t) = \\omega_s(t) \\times \\mathbf{x}_s(t) $$\n与向量 $\\mathbf{v}$ 的叉积可以用与一个斜对称矩阵 $[\\mathbf{v}]_\\times$ 的矩阵乘法来表示，这被称为 \"hat\" 映射。如果 $\\mathbf{v} = (v_1, v_2, v_3)^\\top$，那么：\n$$ [\\mathbf{v}]_\\times = \\begin{pmatrix} 0  -v_3  v_2 \\\\ v_3  0  -v_1 \\\\ -v_2  v_1  0 \\end{pmatrix} $$\n使用这种表示法，我们有 $\\dot{\\mathbf{x}}_s(t) = [\\omega_s(t)]_\\times \\mathbf{x}_s(t)$。代入 $\\mathbf{x}_s(t) = R(t)\\mathbf{x}_b$：\n$$ \\dot{R}(t)\\mathbf{x}_b = [\\omega_s(t)]_\\times R(t)\\mathbf{x}_b $$\n由于此等式必须对体坐标系中固定的任何向量 $\\mathbf{x}_b$ 都成立，我们可以推断出以下矩阵关系：\n$$ \\dot{R}(t) = [\\omega_s(t)]_\\times R(t) $$\n体角速度 $\\omega_b(t)$ 通过旋转矩阵 $R(t)$ 与空间角速度 $\\omega_s(t)$ 相关联：\n$$ \\omega_s(t) = R(t)\\omega_b(t) $$\n将此代入 $\\dot{R}(t)$ 的方程中：\n$$ \\dot{R}(t) = [R(t)\\omega_b(t)]_\\times R(t) $$\n\"hat\" 映射的一个关键性质是它在旋转下的行为：对于任何 $R \\in \\mathrm{SO}(3)$ 和 $\\mathbf{v} \\in \\mathbb{R}^3$，我们有 $[R\\mathbf{v}]_\\times = R[\\mathbf{v}]_\\times R^\\top$。应用此性质：\n$$ \\dot{R}(t) = \\left( R(t)[\\omega_b(t)]_\\times R(t)^\\top \\right) R(t) = R(t)[\\omega_b(t)]_\\times $$\n为了求解 $[\\omega_b(t)]_\\times$，我们用 $R(t)^\\top$ 左乘。由于 $R(t) \\in \\mathrm{SO}(3)$，我们知道 $R(t)^\\top R(t) = I$，其中 $I$ 是 $3 \\times 3$ 的单位矩阵。\n$$ R(t)^\\top \\dot{R}(t) = R(t)^\\top R(t) [\\omega_b(t)]_\\times = I [\\omega_b(t)]_\\times $$\n这就给出了姿态矩阵的时间导数与体角速度之间的基本关系：\n$$ [\\omega_b(t)]_\\times = R(t)^\\top \\dot{R}(t) $$\n矩阵 $[\\omega_b(t)]_\\times$ 是李代数 $\\mathfrak{so}(3)$ 的一个元素，该李代数由所有 $3 \\times 3$ 的实斜对称矩阵组成。给定这样一个矩阵 $\\Omega = [\\omega_b]_\\times$，我们可以使用 \"vee\" 算子（$\\vee$）恢复向量 $\\omega_b$，该算子是 \"hat\" 映射的逆运算：\n$$ \\omega_b = \\begin{pmatrix} \\Omega_{21} \\\\ \\Omega_{02} \\\\ \\Omega_{10} \\end{pmatrix} $$\n其中 $\\Omega_{ij}$ 是使用 0-基索引的 $\\Omega$ 矩阵的元素。\n\n#### 2. 转动动能的推导\n\n刚体的转动动能是其无穷小质量元的动能相对于其质心在其整个体积上的积分。\n$$ T_{\\text{rot}} = \\frac{1}{2} \\int_V \\|\\mathbf{v}(\\mathbf{p}_b)\\|^2 dm $$\n在这里，$\\mathbf{p}_b$ 是体坐标系中（原点在质心）质量元 $dm$ 的位置向量，$\\mathbf{v}(\\mathbf{p}_b)$ 是其在空间坐标系中的速度，即 $\\mathbf{v}(\\mathbf{p}_b) = \\omega_s \\times (R \\mathbf{p}_b)$。\n在体坐标系中进行计算更为方便。质量元相对于质心的速度，用体坐标系坐标表示为 $\\omega_b \\times \\mathbf{p}_b$。该速度的大小在旋转下是不变的，因此 $\\|\\mathbf{v}(\\mathbf{p}_b)\\|^2 = \\|\\omega_b \\times \\mathbf{p}_b\\|^2$。\n$$ T_{\\text{rot}} = \\frac{1}{2} \\int_V \\|\\omega_b \\times \\mathbf{p}_b\\|^2 dm = \\frac{1}{2} \\int_V (-[\\mathbf{p}_b]_\\times \\omega_b)^\\top (-[\\mathbf{p}_b]_\\times \\omega_b) dm $$\n使用性质 $([\\mathbf{p}_b]_\\times)^\\top = -[\\mathbf{p}_b]_\\times$，上式可简化为：\n$$ T_{\\text{rot}} = \\frac{1}{2} \\int_V \\omega_b^\\top ([\\mathbf{p}_b]_\\times^\\top [\\mathbf{p}_b]_\\times) \\omega_b dm = \\frac{1}{2} \\omega_b^\\top \\left( -\\int_V [\\mathbf{p}_b]_\\times^2 dm \\right) \\omega_b $$\n括号中的项是体坐标系惯性张量 $I_b$：\n$$ I_b = -\\int_V [\\mathbf{p}_b]_\\times^2 dm = \\int_V \\begin{pmatrix} y^2+z^2  -xy  -xz \\\\ -yx  x^2+z^2  -yz \\\\ -zx  -zy  x^2+y^2 \\end{pmatrix} dm $$\n其中 $\\mathbf{p}_b = (x,y,z)^\\top$。因此，转动动能由以下二次型给出：\n$$ T_{\\text{rot}}(t) = \\frac{1}{2} \\omega_b(t)^\\top I_b \\omega_b(t) $$\n\n### 数值实现\n\n算法首先生成姿态矩阵 $R(t_k)$ 的离散时间序列。然后，对于每个时间步 $t_k$，执行以下计算。\n\n1.  **近似计算 $\\dot{R}(t_k)$**：使用有限差分法近似计算姿态矩阵序列的时间导数。我们对内部点使用中心差分格式，因为它具有二阶精度，对端点使用前向/后向差分。对于时间步长均匀为 $\\Delta t$ 的时间序列 $R_k = R(t_k)$：\n    -   $\\dot{R}_0 \\approx \\frac{R_1 - R_0}{\\Delta t}$ (前向差分)\n    -   $\\dot{R}_k \\approx \\frac{R_{k+1} - R_{k-1}}{2 \\Delta t}$，对于 $0  k  N-1$ (中心差分)\n    -   $\\dot{R}_{N-1} \\approx \\frac{R_{N-1} - R_{N-2}}{\\Delta t}$ (后向差分)\n    这种格式可以使用 `numpy.gradient` 方便地实现。\n\n2.  **计算体角速度 $\\omega_b(t_k)$**：\n    a.  计算矩阵 $\\Omega_k = R(t_k)^\\top \\dot{R}(t_k)$。\n    b.  由于有限差分格式带来的数值误差，$\\Omega_k$ 可能不完全是斜对称的。我们通过将其投影到 $\\mathfrak{so}(3)$ 空间来强制施加此性质：\n        $$ \\Omega'_k = \\frac{1}{2} (\\Omega_k - \\Omega_k^\\top) $$\n    c.  使用 vee 算子从斜对称矩阵 $\\Omega'_k$ 中提取角速度向量 $\\omega_{b,k}$：\n        $$ \\omega_{b,k} = (\\Omega'_{k,21}, \\Omega'_{k,02}, \\Omega'_{k,10})^\\top $$\n\n3.  **计算转动动能 $T_{\\text{rot}}(t_k)$**：\n    使用计算出的体角速度 $\\omega_{b,k}$ 和给定的惯性张量 $I_b$，动能计算如下：\n    $$ T_{\\text{rot},k} = \\frac{1}{2} \\omega_{b,k}^\\top I_b \\omega_{b,k} $$\n\n将此流程应用于每个测试用例，以计算指定的指标。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the rotational dynamics problem for three test cases.\n    Derives angular velocity and kinetic energy from a time series of attitude matrices.\n    \"\"\"\n\n    def get_rot_matrices(theta, axis):\n        \"\"\"Constructs a rotation matrix for a given angle and axis.\"\"\"\n        c, s = np.cos(theta), np.sin(theta)\n        if axis == 'x':\n            return np.array([[1, 0, 0], [0, c, -s], [0, s, c]])\n        elif axis == 'y':\n            return np.array([[c, 0, s], [0, 1, 0], [-s, 0, c]])\n        elif axis == 'z':\n            return np.array([[c, -s, 0], [s, c, 0], [0, 0, 1]])\n        else:\n            raise ValueError(\"Invalid axis\")\n\n    def compute_from_R_series(R_series, dt, I_b):\n        \"\"\"\n        Computes omega_b and T_rot from a series of rotation matrices.\n        \n        Args:\n            R_series (np.ndarray): Array of shape (N, 3, 3) containing rotation matrices.\n            dt (float): Time step.\n            I_b (np.ndarray): Body-frame inertia tensor of shape (3, 3).\n            \n        Returns:\n            tuple: (omega_b_series, T_rot_series)\n        \"\"\"\n        # Step 1: Approximate dR/dt using finite differences.\n        # np.gradient uses central differences for interior and 1st-order\n        # forward/backward differences for boundaries, as specified.\n        R_dot_series = np.gradient(R_series, dt, axis=0)\n\n        # Step 2: Compute omega_b for each time step.\n        N = R_series.shape[0]\n        omega_b_series = np.zeros((N, 3))\n        T_rot_series = np.zeros(N)\n\n        for k in range(N):\n            R = R_series[k]\n            R_dot = R_dot_series[k]\n            \n            # a. Compute Omega = R^T * R_dot\n            Omega = R.T @ R_dot\n            \n            # b. Enforce skew-symmetry\n            Omega_skew = 0.5 * (Omega - Omega.T)\n            \n            # c. Extract omega_b using the 'vee' operator\n            omega_b = np.array([Omega_skew[2, 1], Omega_skew[0, 2], Omega_skew[1, 0]])\n            omega_b_series[k, :] = omega_b\n            \n            # Step 3: Compute rotational kinetic energy\n            T_rot = 0.5 * omega_b.T @ I_b @ omega_b\n            T_rot_series[k] = T_rot\n            \n        return omega_b_series, T_rot_series\n\n    # Test Case 1\n    def run_case_1():\n        I_b = np.diag([2.0, 3.0, 4.0])\n        dt = 0.001\n        num_steps = 2001\n        t_samples = np.linspace(0.0, (num_steps - 1) * dt, num_steps)\n        \n        R_series = np.array([get_rot_matrices(t, 'z') for t in t_samples])\n        \n        _ , T_rot_series = compute_from_R_series(R_series, dt, I_b)\n        \n        T_star = 2.0  # True kinetic energy\n        E1 = np.max(np.abs(T_rot_series - T_star))\n        return E1\n\n    # Test Case 2\n    def run_case_2():\n        I_b = np.diag([2.0, 3.0, 4.0])\n        dt = 0.001\n        num_steps = 1001\n        t_samples = np.linspace(0.0, (num_steps - 1) * dt, num_steps)\n        epsilon = 1e-3\n        \n        alpha = epsilon * np.sin(2 * np.pi * t_samples)\n        beta = epsilon * np.cos(2 * np.pi * t_samples)\n        \n        R_series = np.zeros((num_steps, 3, 3))\n        for k in range(num_steps):\n            Rx = get_rot_matrices(alpha[k], 'x')\n            Ry = get_rot_matrices(beta[k], 'y')\n            R_series[k] = Rx @ Ry\n\n        omega_b_series, _ = compute_from_R_series(R_series, dt, I_b)\n        \n        M2 = np.max(np.linalg.norm(omega_b_series, axis=1))\n        return M2\n\n    # Test Case 3\n    def run_case_3():\n        I_b = np.array([[3.0, 0.2, 0.1],\n                        [0.2, 2.0, 0.3],\n                        [0.1, 0.3, 1.5]])\n        dt = 0.002\n        num_steps = 501\n        t_samples = np.linspace(0.0, (num_steps - 1) * dt, num_steps)\n        \n        R_series = np.zeros((num_steps, 3, 3))\n        for k, t in enumerate(t_samples):\n            Rz = get_rot_matrices(0.8 * t, 'z')\n            Rx = get_rot_matrices(0.3 * np.sin(2 * t), 'x')\n            Ry = get_rot_matrices(0.5 * t**2, 'y')\n            R_series[k] = Rz @ Rx @ Ry\n        \n        _, T_rot_series = compute_from_R_series(R_series, dt, I_b)\n        \n        M3 = np.mean(T_rot_series)\n        return M3\n\n    results = [run_case_1(), run_case_2(), run_case_3()]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}