{
    "hands_on_practices": [
        {
            "introduction": "This practice starts from the foundational definition of kinetic energy for a continuum. You will derive the inertia tensor as the object that elegantly captures how a body's mass distribution affects its rotational motion. This exercise solidifies the connection between the physical concept of rotational inertia and its mathematical representation as a symmetric tensor, $I$, which allows kinetic energy to be expressed as the quadratic form $T = \\frac{1}{2} \\boldsymbol{\\omega}^{\\top} I \\boldsymbol{\\omega}$.",
            "id": "3740943",
            "problem": "Consider a free rigid body whose configuration space is the Special Orthogonal Group (SO(3)). In body coordinates, let the mass density be a smooth function $\\rho(x)$ supported on a bounded region $\\mathcal{B} \\subset \\mathbb{R}^{3}$, with $x \\in \\mathcal{B}$ measured relative to the body-fixed origin at the center of mass. The rigid body has angular velocity $\\omega \\in \\mathbb{R}^{3}$ expressed in body coordinates, and the instantaneous body velocity field is $v(x) = \\omega \\times x$. The kinetic energy is given by the integral $T = \\frac{1}{2} \\int_{\\mathcal{B}} \\rho(x) \\|v(x)\\|^{2} \\, dx$.\n\nStarting from this fundamental base, first derive an explicit integral formula for the inertia tensor $I \\in \\mathbb{R}^{3 \\times 3}$ such that $T = \\frac{1}{2} \\, \\omega^{\\top} I \\, \\omega$ holds for all $\\omega$. Second, evaluate this formula for a uniform rectangular block occupying the body domain $\\mathcal{B} = \\left[-\\frac{L_{x}}{2}, \\frac{L_{x}}{2}\\right] \\times \\left[-\\frac{L_{y}}{2}, \\frac{L_{y}}{2}\\right] \\times \\left[-\\frac{L_{z}}{2}, \\frac{L_{z}}{2}\\right]$, with constant density $\\rho_{0} > 0$ and total mass $m = \\rho_{0} L_{x} L_{y} L_{z}$. Use the body-fixed coordinate axes aligned with the edges of the block (so that the inertia tensor and its principal moments are computed about the center-of-mass frame with axes along the block edges).\n\nProvide the final answer as the ordered triple of principal moments $(I_{xx}, I_{yy}, I_{zz})$ in terms of $m$, $L_{x}$, $L_{y}$, and $L_{z}$. Express your final answer in the International System of Units (SI) as kilogram meter squared. Write your final triple as a single row matrix. No rounding is required.",
            "solution": "The problem presents a valid and well-posed question in classical mechanics, specifically the dynamics of a free rigid body. All definitions and given conditions are standard, scientifically sound, and self-consistent. The problem is comprised of two parts: first, a general derivation of the inertia tensor from the kinetic energy, and second, the evaluation of this tensor for a specific geometry.\n\nPart 1: Derivation of the Inertia Tensor\n\nThe kinetic energy $T$ of a rigid body is given by the integral of the kinetic energy of its infinitesimal mass elements over its volume. In a body-fixed frame with origin at the center of mass, the velocity of a point $x \\in \\mathcal{B}$ is purely rotational, given by $v(x) = \\omega \\times x$, where $\\omega$ is the body's angular velocity vector.\n\nThe kinetic energy is:\n$$\nT = \\frac{1}{2} \\int_{\\mathcal{B}} \\rho(x) \\|v(x)\\|^{2} \\, d^3x = \\frac{1}{2} \\int_{\\mathcal{B}} \\rho(x) \\|\\omega \\times x\\|^{2} \\, d^3x\n$$\nWe use the vector identity $\\|\\mathbf{a} \\times \\mathbf{b}\\|^2 = \\|\\mathbf{a}\\|^2 \\|\\mathbf{b}\\|^2 - (\\mathbf{a} \\cdot \\mathbf{b})^2$. Let $\\omega = (\\omega_1, \\omega_2, \\omega_3)$ and $x = (x_1, x_2, x_3)$. Then, $\\|\\omega\\|^2 = \\sum_i \\omega_i^2$, $\\|x\\|^2 = \\sum_k x_k^2$, and $\\omega \\cdot x = \\sum_j \\omega_j x_j$.\nSo,\n$$\n\\|\\omega \\times x\\|^2 = \\left(\\sum_i \\omega_i^2\\right) \\left(\\sum_k x_k^2\\right) - \\left(\\sum_j \\omega_j x_j\\right)^2\n$$\nWe can express this as a quadratic form in $\\omega$. Let us use index notation with Einstein summation convention.\n$$\n\\|\\omega \\times x\\|^2 = \\omega_i \\omega_i x_k x_k - (\\omega_j x_j)(\\omega_m x_m)\n$$\nTo write this in the form $\\omega_j I_{jm} \\omega_m$, we manipulate the indices:\n$$\n\\|\\omega \\times x\\|^2 = \\omega_j \\delta_{jm} \\omega_m x_k x_k - \\omega_j x_j \\omega_m x_m\n$$\nwhere $\\delta_{jm}$ is the Kronecker delta. Factoring out $\\omega_j$ and $\\omega_m$:\n$$\n\\|\\omega \\times x\\|^2 = \\omega_j \\left( \\delta_{jm} (x_k x_k) - x_j x_m \\right) \\omega_m\n$$\nSubstituting this back into the kinetic energy integral:\n$$\nT = \\frac{1}{2} \\int_{\\mathcal{B}} \\rho(x) \\left( \\omega_j \\left( \\delta_{jm} \\|x\\|^2 - x_j x_m \\right) \\omega_m \\right) \\, d^3x\n$$\nSince the components $\\omega_j$ of the angular velocity are constant with respect to the spatial integration over the body $\\mathcal{B}$, we can pull them out of the integral:\n$$\nT = \\frac{1}{2} \\, \\omega_j \\left( \\int_{\\mathcal{B}} \\rho(x) \\left( \\delta_{jm} \\|x\\|^2 - x_j x_m \\right) \\, d^3x \\right) \\omega_m\n$$\nThis expression is of the form $T = \\frac{1}{2} \\omega^{\\top} I \\omega$, which in index notation is $T = \\frac{1}{2} \\omega_j I_{jm} \\omega_m$. By direct comparison, we identify the components of the inertia tensor $I$ as:\n$$\nI_{jm} = \\int_{\\mathcal{B}} \\rho(x) \\left( \\delta_{jm} \\|x\\|^2 - x_j x_m \\right) \\, d^3x\n$$\nThis is the general integral formula for the inertia tensor.\nThe diagonal components ($j=m$), called the moments of inertia, are:\n$$\nI_{jj} = \\int_{\\mathcal{B}} \\rho(x) \\left( \\|x\\|^2 - x_j^2 \\right) \\, d^3x\n$$\nFor example, using coordinates $(x,y,z)$ for $(x_1, x_2, x_3)$:\n$$\nI_{xx} = I_{11} = \\int_{\\mathcal{B}} \\rho(x,y,z) (y^2+z^2) \\, dx\\,dy\\,dz\n$$\nThe off-diagonal components ($j \\neq m$), called the products of inertia, are:\n$$\nI_{jm} = - \\int_{\\mathcal{B}} \\rho(x) x_j x_m \\, d^3x\n$$\n\nPart 2: Evaluation for a Uniform Rectangular Block\n\nWe are given a rectangular block with constant density $\\rho_0$ and dimensions $L_x, L_y, L_z$. The domain is $\\mathcal{B} = \\left[-\\frac{L_{x}}{2}, \\frac{L_{x}}{2}\\right] \\times \\left[-\\frac{L_{y}}{2}, \\frac{L_{y}}{2}\\right] \\times \\left[-\\frac{L_{z}}{2}, \\frac{L_{z}}{2}\\right]$. The total mass is $m = \\rho_0 L_x L_y L_z$. The body-fixed axes are aligned with the block's edges.\n\nFirst, we check the products of inertia. For instance, $I_{xy}$:\n$$\nI_{xy} = - \\int_{\\mathcal{B}} \\rho_0 x y \\, dx\\,dy\\,dz = -\\rho_0 \\left( \\int_{-L_x/2}^{L_x/2} x \\, dx \\right) \\left( \\int_{-L_y/2}^{L_y/2} y \\, dy \\right) \\left( \\int_{-L_z/2}^{L_z/2} dz \\right)\n$$\nThe integral $\\int_{-L_x/2}^{L_x/2} x \\, dx = \\left[ \\frac{x^2}{2} \\right]_{-L_x/2}^{L_x/2} = \\frac{1}{2}\\left(\\left(\\frac{L_x}{2}\\right)^2 - \\left(-\\frac{L_x}{2}\\right)^2\\right) = 0$.\nThe integral is zero because the integrand is an odd function over a symmetric interval. Consequently, $I_{xy} = 0$. By symmetry, $I_{xz} = 0$ and $I_{yz} = 0$. The inertia tensor is diagonal, and its diagonal elements are the principal moments of inertia.\n\nNow, we compute the principal moments. Let's start with $I_{xx}$:\n$$\nI_{xx} = \\int_{\\mathcal{B}} \\rho_0 (y^2 + z^2) \\, dx\\,dy\\,dz = \\rho_0 \\left( \\int_{\\mathcal{B}} y^2 \\, dV + \\int_{\\mathcal{B}} z^2 \\, dV \\right)\n$$\nwhere $dV = dx\\,dy\\,dz$. We evaluate the first integral:\n$$\n\\int_{\\mathcal{B}} y^2 \\, dV = \\int_{-L_x/2}^{L_x/2} dx \\int_{-L_y/2}^{L_y/2} y^2 \\, dy \\int_{-L_z/2}^{L_z/2} dz\n$$\nThe separate integrals are:\n$\\int_{-L_x/2}^{L_x/2} dx = L_x$\n$\\int_{-L_z/2}^{L_z/2} dz = L_z$\n$\\int_{-L_y/2}^{L_y/2} y^2 \\, dy = \\left[ \\frac{y^3}{3} \\right]_{-L_y/2}^{L_y/2} = \\frac{1}{3}\\left( \\left(\\frac{L_y}{2}\\right)^3 - \\left(-\\frac{L_y}{2}\\right)^3 \\right) = \\frac{1}{3}\\left(\\frac{L_y^3}{8} + \\frac{L_y^3}{8}\\right) = \\frac{L_y^3}{12}$\nThus, $\\int_{\\mathcal{B}} y^2 \\, dV = L_x \\left( \\frac{L_y^3}{12} \\right) L_z = \\frac{L_x L_y^3 L_z}{12}$.\nBy a symmetric argument, $\\int_{\\mathcal{B}} z^2 \\, dV = \\frac{L_x L_y L_z^3}{12}$.\nSubstituting these results back into the expression for $I_{xx}$:\n$$\nI_{xx} = \\rho_0 \\left( \\frac{L_x L_y^3 L_z}{12} + \\frac{L_x L_y L_z^3}{12} \\right) = \\frac{\\rho_0 L_x L_y L_z}{12} (L_y^2 + L_z^2)\n$$\nUsing the given relation for the total mass, $m = \\rho_0 L_x L_y L_z$, we obtain:\n$$\nI_{xx} = \\frac{m}{12} (L_y^2 + L_z^2)\n$$\nThe other two principal moments, $I_{yy}$ and $I_{zz}$, can be found by cyclic permutation of the indices $x, y, z$ and the corresponding dimensions $L_x, L_y, L_z$:\n$$\nI_{yy} = \\frac{m}{12} (L_x^2 + L_z^2)\n$$\n$$\nI_{zz} = \\frac{m}{12} (L_x^2 + L_y^2)\n$$\nThe ordered triple of principal moments $(I_{xx}, I_{yy}, I_{zz})$ is therefore:\n$$\n\\left( \\frac{m}{12}(L_y^2 + L_z^2), \\frac{m}{12}(L_x^2 + L_z^2), \\frac{m}{12}(L_x^2 + L_y^2) \\right)\n$$\nThese expressions have units of mass times length squared (e.g., kg m$^2$ in SI units), as required for moments of inertia. The final answer is requested as a single row matrix.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{m}{12}(L_y^2 + L_z^2) & \\frac{m}{12}(L_x^2 + L_z^2) & \\frac{m}{12}(L_x^2 + L_y^2) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Real-world systems are often composed of multiple rigid parts, and this exercise extends our understanding by showing how to determine the inertia tensor of such a composite body. By applying the parallel axis theorem, you will learn to combine the inertial properties of individual components into a single tensor for the entire assembly . This is a critical skill in mechanical design and the dynamic analysis of complex systems like vehicles or robotic manipulators.",
            "id": "3750941",
            "problem": "Consider a composite rigid body formed by rigidly attaching two rigid parts, labeled $1$ and $2$, so that they move together as a single body. Work in a fixed inertial space frame $\\mathcal{F}$ with origin $O$ and orthonormal basis vectors. Let the composite undergo pure rotation about $O$ with angular velocity $\\boldsymbol{\\omega}$, and let angles be measured in radians. The rotational kinetic energy of a rigid body in geometric mechanics is defined from the continuum expression for kinetic energy, integrated over the material points, using the rigid-body velocity field induced by the group of rigid motions Special Euclidean group in three dimensions (SE(3)):\n$$\nT \\;=\\; \\frac{1}{2}\\int \\rho(\\mathbf{x})\\,\\|\\mathbf{v}(\\mathbf{x})\\|^{2}\\,d^{3}\\mathbf{x},\n$$\nwhere $\\rho(\\mathbf{x})$ is the mass density and $\\mathbf{v}(\\mathbf{x})$ is the velocity of the material point at spatial position $\\mathbf{x}$. Starting from this definition and the rigid-body kinematics $\\mathbf{v}(\\mathbf{x}) = \\boldsymbol{\\omega}\\times \\mathbf{x}$ for pure rotation about $O$, derive an expression for the total inertia tensor $\\mathbf{I}_{O}$ of the composite body about the origin $O$ in terms of the masses $m_{i}$ of the parts, their centers of mass $\\mathbf{r}_{i}$ relative to $O$, and the inertia tensors of the parts about their own centers of mass, $\\mathbf{I}_{i,c_{i}}$, all expressed in the space frame $\\mathcal{F}$. Then use your derived expression to evaluate the rotational kinetic energy $T = \\frac{1}{2}\\boldsymbol{\\omega}^{\\mathsf{T}}\\mathbf{I}_{O}\\boldsymbol{\\omega}$ for the following data:\n- Part $1$: mass $m_{1} = 3.2\\,\\mathrm{kg}$, center of mass position $\\mathbf{r}_{1} = \\begin{pmatrix}0.25 \\\\ -0.10 \\\\ 0.05\\end{pmatrix}\\,\\mathrm{m}$, inertia tensor about its center of mass $\\mathbf{I}_{1,c_{1}} = \\begin{pmatrix}0.12 & 0 & 0 \\\\ 0 & 0.15 & 0 \\\\ 0 & 0 & 0.09\\end{pmatrix}\\,\\mathrm{kg\\,m^{2}}$.\n- Part $2$: mass $m_{2} = 2.7\\,\\mathrm{kg}$, center of mass position $\\mathbf{r}_{2} = \\begin{pmatrix}-0.15 \\\\ 0.20 \\\\ 0.00\\end{pmatrix}\\,\\mathrm{m}$, inertia tensor about its center of mass $\\mathbf{I}_{2,c_{2}} = \\begin{pmatrix}0.08 & 0.01 & -0.005 \\\\ 0.01 & 0.11 & 0.002 \\\\ -0.005 & 0.002 & 0.10\\end{pmatrix}\\,\\mathrm{kg\\,m^{2}}$.\n- Composite angular velocity $\\boldsymbol{\\omega} = \\begin{pmatrix}2.0 \\\\ -1.5 \\\\ 0.75\\end{pmatrix}\\,\\mathrm{rad/s}$.\n\nYour answer must be a single real number equal to the rotational kinetic energy $T$. Round your answer to four significant figures. Express the final energy in $\\mathrm{J}$.",
            "solution": "The user's request has been validated and found to be a well-posed problem in rigid body dynamics. The solution proceeds in two stages: first, a derivation of the formula for the inertia tensor of a composite body, and second, the numerical evaluation of the kinetic energy using the provided data.\n\nThe rotational kinetic energy $T$ of a rigid body is given by the integral over its volume $\\mathcal{B}$ with mass density $\\rho(\\mathbf{x})$:\n$$\nT \\;=\\; \\frac{1}{2}\\int_{\\mathcal{B}} \\rho(\\mathbf{x})\\,\\|\\mathbf{v}(\\mathbf{x})\\|^{2}\\,d V\n$$\nFor a rigid body undergoing pure rotation about a fixed origin $O$ with angular velocity $\\boldsymbol{\\omega}$, the velocity of a point at position $\\mathbf{x}$ is given by $\\mathbf{v}(\\mathbf{x}) = \\boldsymbol{\\omega} \\times \\mathbf{x}$. Substituting this into the energy expression yields:\n$$\nT \\;=\\; \\frac{1}{2}\\int_{\\mathcal{B}} \\rho(\\mathbf{x})\\,\\|\\boldsymbol{\\omega} \\times \\mathbf{x}\\|^{2}\\,d V\n$$\nThe squared norm can be expressed as a quadratic form in $\\boldsymbol{\\omega}$. Using the identity $\\|\\mathbf{a} \\times \\mathbf{b}\\|^2 = \\mathbf{a}^{\\mathsf{T}}(\\|\\mathbf{b}\\|^2\\mathbf{1} - \\mathbf{b}\\mathbf{b}^{\\mathsf{T}})\\mathbf{a}$, where $\\mathbf{1}$ is the $3 \\times 3$ identity matrix, we can write:\n$$\n\\|\\boldsymbol{\\omega} \\times \\mathbf{x}\\|^{2} = \\boldsymbol{\\omega}^{\\mathsf{T}}(\\|\\mathbf{x}\\|^2\\mathbf{1} - \\mathbf{x}\\mathbf{x}^{\\mathsf{T}})\\boldsymbol{\\omega}\n$$\nSince $\\boldsymbol{\\omega}$ is uniform over the body, we can take it outside the integral:\n$$\nT \\;=\\; \\frac{1}{2}\\boldsymbol{\\omega}^{\\mathsf{T}} \\left( \\int_{\\mathcal{B}} \\rho(\\mathbf{x}) (\\|\\mathbf{x}\\|^2\\mathbf{1} - \\mathbf{x}\\mathbf{x}^{\\mathsf{T}}) \\,d V \\right) \\boldsymbol{\\omega}\n$$\nThe term in the parentheses is the definition of the inertia tensor $\\mathbf{I}_O$ of the body about the origin $O$:\n$$\n\\mathbf{I}_O \\;=\\; \\int_{\\mathcal{B}} \\rho(\\mathbf{x}) (\\|\\mathbf{x}\\|^2\\mathbf{1} - \\mathbf{x}\\mathbf{x}^{\\mathsf{T}}) \\,d V\n$$\nThus, the kinetic energy is given by the expression $T = \\frac{1}{2}\\boldsymbol{\\omega}^{\\mathsf{T}}\\mathbf{I}_{O}\\boldsymbol{\\omega}$.\n\nFor a composite body made of two parts, labeled $1$ and $2$, the total kinetic energy is the sum of the kinetic energies of the parts, $T = T_1 + T_2$. Consequently, the total inertia tensor is the sum of the inertia tensors of the parts, all referred to the same origin $O$:\n$$\n\\mathbf{I}_O \\;=\\; \\mathbf{I}_{O,1} + \\mathbf{I}_{O,2}\n$$\nThe problem provides the inertia tensor for each part about its own center of mass, $\\mathbf{I}_{i,c_i}$. We must use the parallel axis theorem to find the inertia tensor of each part about the origin $O$. Let $\\mathbf{r}_i$ be the position vector of the center of mass $c_i$ of part $i$ with respect to $O$. Let $\\mathbf{x}'$ be the position of a mass element within part $i$ relative to its center of mass $c_i$, so that the position relative to $O$ is $\\mathbf{x} = \\mathbf{r}_i + \\mathbf{x}'$. The inertia tensor $\\mathbf{I}_{O,i}$ is:\n$$\n\\mathbf{I}_{O,i} \\;=\\; \\int_{\\mathcal{B}_i} \\rho_i(\\mathbf{x}'+\\mathbf{r}_i) (\\|\\mathbf{r}_i+\\mathbf{x}'\\|^2\\mathbf{1} - (\\mathbf{r}_i+\\mathbf{x}')(\\mathbf{r}_i+\\mathbf{x}')^{\\mathsf{T}}) \\,d V'\n$$\nExpanding the terms inside the integral and using the definition of the center of mass, $\\int_{\\mathcal{B}_i} \\rho_i \\mathbf{x}' \\,d V' = \\mathbf{0}$, one arrives at the parallel axis theorem:\n$$\n\\mathbf{I}_{O,i} \\;=\\; \\mathbf{I}_{i,c_i} + m_i (\\|\\mathbf{r}_i\\|^2\\mathbf{1} - \\mathbf{r}_i\\mathbf{r}_i^{\\mathsf{T}})\n$$\nwhere $m_i = \\int_{\\mathcal{B}_i} \\rho_i \\,dV'$ is the mass of part $i$.\n\nThe total inertia tensor of the composite body about $O$ is therefore:\n$$\n\\mathbf{I}_O \\;=\\; \\sum_{i=1}^{2} \\left( \\mathbf{I}_{i,c_i} + m_i (\\|\\mathbf{r}_i\\|^2\\mathbf{1} - \\mathbf{r}_i\\mathbf{r}_i^{\\mathsf{T}}) \\right)\n$$\nThis is the general expression required. We now evaluate it for the given data.\n\nFor Part $1$:\n$m_1 = 3.2\\,\\mathrm{kg}$, $\\mathbf{r}_1 = \\begin{pmatrix}0.25 \\\\ -0.10 \\\\ 0.05\\end{pmatrix}\\,\\mathrm{m}$.\n$\\|\\mathbf{r}_1\\|^2 = 0.25^2 + (-0.10)^2 + 0.05^2 = 0.0625 + 0.01 + 0.0025 = 0.075\\,\\mathrm{m}^2$.\nThe shift term is $\\Delta\\mathbf{I}_1 = m_1 (\\|\\mathbf{r}_1\\|^2\\mathbf{1} - \\mathbf{r}_1\\mathbf{r}_1^{\\mathsf{T}})$.\n$$\n\\mathbf{r}_1\\mathbf{r}_1^{\\mathsf{T}} = \\begin{pmatrix} 0.25 \\\\ -0.10 \\\\ 0.05 \\end{pmatrix} \\begin{pmatrix} 0.25 & -0.10 & 0.05 \\end{pmatrix} = \\begin{pmatrix} 0.0625 & -0.025 & 0.0125 \\\\ -0.025 & 0.01 & -0.005 \\\\ 0.0125 & -0.005 & 0.0025 \\end{pmatrix}\\,\\mathrm{m}^2\n$$\n$$\n\\|\\mathbf{r}_1\\|^2\\mathbf{1} - \\mathbf{r}_1\\mathbf{r}_1^{\\mathsf{T}} = \\begin{pmatrix} 0.075 & 0 & 0 \\\\ 0 & 0.075 & 0 \\\\ 0 & 0 & 0.075 \\end{pmatrix} - \\begin{pmatrix} 0.0625 & -0.025 & 0.0125 \\\\ -0.025 & 0.01 & -0.005 \\\\ 0.0125 & -0.005 & 0.0025 \\end{pmatrix} = \\begin{pmatrix} 0.0125 & 0.025 & -0.0125 \\\\ 0.025 & 0.065 & 0.005 \\\\ -0.0125 & 0.005 & 0.0725 \\end{pmatrix}\\,\\mathrm{m}^2\n$$\n$$\n\\Delta\\mathbf{I}_1 = 3.2 \\times \\begin{pmatrix} 0.0125 & 0.025 & -0.0125 \\\\ 0.025 & 0.065 & 0.005 \\\\ -0.0125 & 0.005 & 0.0725 \\end{pmatrix} = \\begin{pmatrix} 0.04 & 0.08 & -0.04 \\\\ 0.08 & 0.208 & 0.016 \\\\ -0.04 & 0.016 & 0.232 \\end{pmatrix}\\,\\mathrm{kg\\,m^2}\n$$\n$$\n\\mathbf{I}_{O,1} = \\mathbf{I}_{1,c_1} + \\Delta\\mathbf{I}_1 = \\begin{pmatrix} 0.12 & 0 & 0 \\\\ 0 & 0.15 & 0 \\\\ 0 & 0 & 0.09 \\end{pmatrix} + \\begin{pmatrix} 0.04 & 0.08 & -0.04 \\\\ 0.08 & 0.208 & 0.016 \\\\ -0.04 & 0.016 & 0.232 \\end{pmatrix} = \\begin{pmatrix} 0.16 & 0.08 & -0.04 \\\\ 0.08 & 0.358 & 0.016 \\\\ -0.04 & 0.016 & 0.322 \\end{pmatrix}\\,\\mathrm{kg\\,m^2}\n$$\n\nFor Part $2$:\n$m_2 = 2.7\\,\\mathrm{kg}$, $\\mathbf{r}_2 = \\begin{pmatrix}-0.15 \\\\ 0.20 \\\\ 0.00\\end{pmatrix}\\,\\mathrm{m}$.\n$\\|\\mathbf{r}_2\\|^2 = (-0.15)^2 + 0.20^2 + 0.00^2 = 0.0225 + 0.04 = 0.0625\\,\\mathrm{m}^2$.\n$$\n\\Delta\\mathbf{I}_2 = m_2 (\\|\\mathbf{r}_2\\|^2\\mathbf{1} - \\mathbf{r}_2\\mathbf{r}_2^{\\mathsf{T}}) = 2.7 \\left( \\begin{pmatrix} 0.0625 & 0 & 0 \\\\ 0 & 0.0625 & 0 \\\\ 0 & 0 & 0.0625 \\end{pmatrix} - \\begin{pmatrix} 0.0225 & -0.03 & 0 \\\\ -0.03 & 0.04 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\right)\n$$\n$$\n\\Delta\\mathbf{I}_2 = 2.7 \\times \\begin{pmatrix} 0.04 & 0.03 & 0 \\\\ 0.03 & 0.0225 & 0 \\\\ 0 & 0 & 0.0625 \\end{pmatrix} = \\begin{pmatrix} 0.108 & 0.081 & 0 \\\\ 0.081 & 0.06075 & 0 \\\\ 0 & 0 & 0.16875 \\end{pmatrix}\\,\\mathrm{kg\\,m^2}\n$$\n$$\n\\mathbf{I}_{O,2} = \\mathbf{I}_{2,c_2} + \\Delta\\mathbf{I}_2 = \\begin{pmatrix} 0.08 & 0.01 & -0.005 \\\\ 0.01 & 0.11 & 0.002 \\\\ -0.005 & 0.002 & 0.10 \\end{pmatrix} + \\begin{pmatrix} 0.108 & 0.081 & 0 \\\\ 0.081 & 0.06075 & 0 \\\\ 0 & 0 & 0.16875 \\end{pmatrix} = \\begin{pmatrix} 0.188 & 0.091 & -0.005 \\\\ 0.091 & 0.17075 & 0.002 \\\\ -0.005 & 0.002 & 0.26875 \\end{pmatrix}\\,\\mathrm{kg\\,m^2}\n$$\n\nThe total inertia tensor of the composite body is $\\mathbf{I}_O = \\mathbf{I}_{O,1} + \\mathbf{I}_{O,2}$:\n$$\n\\mathbf{I}_O = \\begin{pmatrix} 0.16 & 0.08 & -0.04 \\\\ 0.08 & 0.358 & 0.016 \\\\ -0.04 & 0.016 & 0.322 \\end{pmatrix} + \\begin{pmatrix} 0.188 & 0.091 & -0.005 \\\\ 0.091 & 0.17075 & 0.002 \\\\ -0.005 & 0.002 & 0.26875 \\end{pmatrix}\n$$\n$$\n\\mathbf{I}_O = \\begin{pmatrix} 0.348 & 0.171 & -0.045 \\\\ 0.171 & 0.52875 & 0.018 \\\\ -0.045 & 0.018 & 0.59075 \\end{pmatrix}\\,\\mathrm{kg\\,m^2}\n$$\n\nFinally, we compute the kinetic energy $T = \\frac{1}{2}\\boldsymbol{\\omega}^{\\mathsf{T}}\\mathbf{I}_{O}\\boldsymbol{\\omega}$ with $\\boldsymbol{\\omega} = \\begin{pmatrix}2.0 \\\\ -1.5 \\\\ 0.75\\end{pmatrix}\\,\\mathrm{rad/s}$.\nFirst, we compute the product $\\mathbf{I}_O \\boldsymbol{\\omega}$:\n$$\n\\mathbf{I}_O\\boldsymbol{\\omega} = \\begin{pmatrix} 0.348 & 0.171 & -0.045 \\\\ 0.171 & 0.52875 & 0.018 \\\\ -0.045 & 0.018 & 0.59075 \\end{pmatrix} \\begin{pmatrix} 2.0 \\\\ -1.5 \\\\ 0.75 \\end{pmatrix} = \\begin{pmatrix} 0.348(2.0) + 0.171(-1.5) - 0.045(0.75) \\\\ 0.171(2.0) + 0.52875(-1.5) + 0.018(0.75) \\\\ -0.045(2.0) + 0.018(-1.5) + 0.59075(0.75) \\end{pmatrix}\n$$\n$$\n\\mathbf{I}_O\\boldsymbol{\\omega} = \\begin{pmatrix} 0.696 - 0.2565 - 0.03375 \\\\ 0.342 - 0.793125 + 0.0135 \\\\ -0.09 - 0.027 + 0.4430625 \\end{pmatrix} = \\begin{pmatrix} 0.40575 \\\\ -0.437625 \\\\ 0.3260625 \\end{pmatrix}\n$$\nNow, we compute the quadratic form $\\boldsymbol{\\omega}^{\\mathsf{T}}(\\mathbf{I}_O \\boldsymbol{\\omega})$:\n$$\n\\boldsymbol{\\omega}^{\\mathsf{T}}(\\mathbf{I}_O \\boldsymbol{\\omega}) = \\begin{pmatrix} 2.0 & -1.5 & 0.75 \\end{pmatrix} \\begin{pmatrix} 0.40575 \\\\ -0.437625 \\\\ 0.3260625 \\end{pmatrix}\n$$\n$$\n= 2.0(0.40575) - 1.5(-0.437625) + 0.75(0.3260625) = 0.8115 + 0.6564375 + 0.244546875 = 1.712484375\n$$\nThe kinetic energy is half of this value:\n$$\nT = \\frac{1}{2}(1.712484375) = 0.8562421875\\,\\mathrm{J}\n$$\nRounding to four significant figures as requested, we get $T = 0.8562\\,\\mathrm{J}$.",
            "answer": "$$\\boxed{0.8562}$$"
        },
        {
            "introduction": "Bridging theory and practice, this final exercise challenges you to compute rotational kinetic energy from discrete motion data . You will implement the fundamental kinematic relationship between an orientation matrix $R(t) \\in \\mathrm{SO}(3)$ and the body's angular velocity $\\boldsymbol{\\omega}_b(t)$, a core task in fields like robotics, aerospace engineering, and motion tracking. This practice emphasizes the computational aspects of geometric mechanics and the numerical handling of time-series data derived from the configuration manifold.",
            "id": "3750940",
            "problem": "You are given a time series of attitude matrices $R(t_k) \\in \\mathrm{SO}(3)$, where $\\mathrm{SO}(3)$ denotes the Special Orthogonal Group consisting of $3 \\times 3$ real orthogonal matrices with determinant $1$, and a constant body-frame inertia tensor $I_b \\in \\mathbb{R}^{3 \\times 3}$ that is symmetric and positive definite. Your task is to derive from first principles how to compute the body-frame angular velocity $\\omega_b(t_k) \\in \\mathbb{R}^3$ from the time series $R(t_k)$, and then use it to estimate the rotational kinetic energy $T_{\\text{rot}}(t_k)$ of the rigid body. All angles must be in radians, time in seconds, inertia in kilogram-meter-squared ($\\mathrm{kg \\cdot m^2}$), angular velocity in radians per second ($\\mathrm{rad/s}$), and energy in joules ($\\mathrm{J}$).\n\nFundamental base to use:\n- The definition of $\\mathrm{SO}(3)$ implies $R(t)^\\top R(t) = I$ and $\\det R(t) = 1$ for all $t$, where $I$ is the identity.\n- The Lie algebra of the Special Orthogonal Group (SO(3)) consists of $3 \\times 3$ skew-symmetric matrices.\n- The rigid body rotational kinetic energy arises from the kinetic energy density integrated over the mass distribution in the body and can be expressed in terms of the inertia tensor in the body frame and the body angular velocity.\n\nYour algorithmic implementation should:\n- Construct $R(t_k)$ from the provided test suite specifications.\n- Approximate $\\dot{R}(t_k)$ from the discrete time series using a finite difference scheme that is consistent with the units and the geometric structure. Use a central difference for interior points and forward/backward difference at the endpoints.\n- Derive and implement the relation between the body angular velocity and the attitude matrix derivative implied by the structure of the Special Orthogonal Group and its Lie algebra. Numerically enforce skew-symmetry when mapping to the Lie algebra to mitigate discretization artifacts.\n- Map the resulting skew-symmetric matrix at each time $t_k$ to the unique angular velocity vector $\\omega_b(t_k) \\in \\mathbb{R}^3$ via the standard isomorphism between $\\mathfrak{so}(3)$ and $\\mathbb{R}^3$ (the \"vee\" operator).\n- Compute $T_{\\text{rot}}(t_k)$ from $\\omega_b(t_k)$ and $I_b$ using the appropriate expression that follows from the definition of the inertia tensor.\n\nTest suite:\n- Case $1$ (happy path, constant rotation about the $z$-axis):\n  - Inertia tensor $I_b = \\mathrm{diag}(2.0, 3.0, 4.0)$ in $\\mathrm{kg \\cdot m^2}$.\n  - Time samples $t_k = k \\Delta t$ with $\\Delta t = 0.001$ and $k = 0,1,\\dots,2000$, so total duration $2.000$ seconds.\n  - Attitude $R(t) = R_z(\\theta(t))$ with $\\theta(t) = t$ in radians, where $R_z(\\theta)$ is the rotation about the $z$-axis by angle $\\theta$. Use the standard construction of $R_z(\\theta)$ from trigonometric functions.\n  - Let the true constant angular speed be $\\omega_z = 1\\,\\mathrm{rad/s}$ so the true rotational kinetic energy is $T^\\star = \\frac{1}{2} I_{zz} \\omega_z^2 = 2.0\\,\\mathrm{J}$. Compute and return the maximum absolute deviation $E_1 = \\max_k | T_{\\text{rot}}(t_k) - T^\\star |$, expressed in joules.\n\n- Case $2$ (edge case, near-identity small-angle jitter):\n  - Inertia tensor $I_b = \\mathrm{diag}(2.0, 3.0, 4.0)$ in $\\mathrm{kg \\cdot m^2}$.\n  - Time samples $t_k = k \\Delta t$ with $\\Delta t = 0.001$ and $k = 0,1,\\dots,1000$, so total duration $1.000$ seconds.\n  - Small-angle functions $\\alpha(t) = \\varepsilon \\sin(2 \\pi t)$ and $\\beta(t) = \\varepsilon \\cos(2 \\pi t)$ with $\\varepsilon = 10^{-3}$ radians.\n  - Attitude $R(t) = R_x(\\alpha(t)) R_y(\\beta(t))$, where $R_x(\\cdot)$ and $R_y(\\cdot)$ are rotations about the $x$- and $y$-axes constructed from trigonometric functions.\n  - Compute and return $M_2 = \\max_k \\|\\omega_b(t_k)\\|_2$ in $\\mathrm{rad/s}$.\n\n- Case $3$ (general time-varying rotation with non-diagonal inertia):\n  - Inertia tensor\n    $$I_b = \\begin{bmatrix}\n    3.0 & 0.2 & 0.1 \\\\\n    0.2 & 2.0 & 0.3 \\\\\n    0.1 & 0.3 & 1.5\n    \\end{bmatrix} \\quad \\text{in } \\mathrm{kg \\cdot m^2}.$$\n  - Time samples $t_k = k \\Delta t$ with $\\Delta t = 0.002$ and $k = 0,1,\\dots,500$, so total duration $1.000$ seconds.\n  - Attitude\n    $R(t) = R_z(0.8 t) R_x(0.3 \\sin(2 t)) R_y(0.5 t^2),$\n    where the arguments to $R_x, R_y, R_z$ are in radians.\n  - Compute and return the mean rotational kinetic energy\n    $M_3 = \\frac{1}{N} \\sum_{k=0}^{N-1} T_{\\text{rot}}(t_k),$\n    expressed in joules.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets: `[E_1, M_2, M_3]`. Ensure the three numbers are returned in this exact order, using the specified units: $E_1$ in joules, $M_2$ in radians per second, and $M_3$ in joules.",
            "solution": "The problem is valid as it is scientifically grounded in rigid body mechanics, mathematically well-posed, and all provided data and constraints are self-consistent and objective. We shall now proceed with a complete solution derived from first principles.\n\n### Theoretical Foundation\n\nThe core of the problem lies in the relationship between the orientation of a rigid body, represented by an attitude matrix $R(t) \\in \\mathrm{SO}(3)$, and its angular velocity $\\omega_b(t) \\in \\mathbb{R}^3$. This relationship is rooted in the geometric structure of the special orthogonal group $\\mathrm{SO}(3)$ and its associated Lie algebra $\\mathfrak{so}(3)$.\n\n#### 1. Derivation of Body Angular Velocity\n\nThe attitude matrix $R(t)$ transforms vectors from a body-fixed reference frame to a spatial (inertial) reference frame. Let $\\mathbf{x}_b$ be a constant vector in the body frame. Its representation in the spatial frame is time-dependent: $\\mathbf{x}_s(t) = R(t)\\mathbf{x}_b$.\n\nThe velocity of the point $\\mathbf{x}_s(t)$ in the spatial frame is obtained by time differentiation:\n$$ \\dot{\\mathbf{x}}_s(t) = \\frac{d}{dt}(R(t)\\mathbf{x}_b) = \\dot{R}(t)\\mathbf{x}_b $$\nFrom kinematics, the velocity of this point is also given by the cross product of the spatial angular velocity vector $\\omega_s(t)$ with the position vector $\\mathbf{x}_s(t)$:\n$$ \\dot{\\mathbf{x}}_s(t) = \\omega_s(t) \\times \\mathbf{x}_s(t) $$\nThe cross product with a vector $\\mathbf{v}$ can be represented by a matrix multiplication with a skew-symmetric matrix $[\\mathbf{v}]_\\times$, known as the \"hat\" map. If $\\mathbf{v} = (v_1, v_2, v_3)^\\top$, then:\n$$ [\\mathbf{v}]_\\times = \\begin{pmatrix} 0 & -v_3 & v_2 \\\\ v_3 & 0 & -v_1 \\\\ -v_2 & v_1 & 0 \\end{pmatrix} $$\nUsing this notation, we have $\\dot{\\mathbf{x}}_s(t) = [\\omega_s(t)]_\\times \\mathbf{x}_s(t)$. Substituting $\\mathbf{x}_s(t) = R(t)\\mathbf{x}_b$:\n$$ \\dot{R}(t)\\mathbf{x}_b = [\\omega_s(t)]_\\times R(t)\\mathbf{x}_b $$\nSince this equality must hold for any vector $\\mathbf{x}_b$ fixed in the body, we can deduce the matrix relationship:\n$$ \\dot{R}(t) = [\\omega_s(t)]_\\times R(t) $$\nThe body angular velocity $\\omega_b(t)$ is related to the spatial angular velocity $\\omega_s(t)$ by the rotation $R(t)$:\n$$ \\omega_s(t) = R(t)\\omega_b(t) $$\nSubstituting this into the equation for $\\dot{R}(t)$:\n$$ \\dot{R}(t) = [R(t)\\omega_b(t)]_\\times R(t) $$\nA key property of the hat map is its behavior under rotations: for any $R \\in \\mathrm{SO}(3)$ and $\\mathbf{v} \\in \\mathbb{R}^3$, we have $[R\\mathbf{v}]_\\times = R[\\mathbf{v}]_\\times R^\\top$. Applying this property:\n$$ \\dot{R}(t) = \\left( R(t)[\\omega_b(t)]_\\times R(t)^\\top \\right) R(t) = R(t)[\\omega_b(t)]_\\times $$\nTo solve for $[\\omega_b(t)]_\\times$, we left-multiply by $R(t)^\\top$. Since $R(t) \\in \\mathrm{SO}(3)$, we know $R(t)^\\top R(t) = I$, where $I$ is the $3 \\times 3$ identity matrix.\n$$ R(t)^\\top \\dot{R}(t) = R(t)^\\top R(t) [\\omega_b(t)]_\\times = I [\\omega_b(t)]_\\times $$\nThis gives us the fundamental relationship between the time derivative of the attitude matrix and the body angular velocity:\n$$ [\\omega_b(t)]_\\times = R(t)^\\top \\dot{R}(t) $$\nThe matrix $[\\omega_b(t)]_\\times$ is an element of the Lie algebra $\\mathfrak{so}(3)$, which consists of all $3 \\times 3$ real skew-symmetric matrices. Given such a matrix $\\Omega = [\\omega_b]_\\times$, we can recover the vector $\\omega_b$ using the \"vee\" operator ($\\vee$), which is the inverse of the hat map. For a matrix $\\Omega$ with 0-based indexing, the vector is $\\omega_b = (\\Omega_{21}, \\Omega_{02}, \\Omega_{10})^\\top$.\n\n#### 2. Derivation of Rotational Kinetic Energy\n\nThe rotational kinetic energy of a rigid body is the integral of the kinetic energy of its infinitesimal mass elements over its volume, relative to its center of mass.\n$$ T_{\\text{rot}} = \\frac{1}{2} \\int_V \\|\\mathbf{v}(\\mathbf{p}_b)\\|^2 dm $$\nHere, $\\mathbf{p}_b$ is the position vector of a mass element $dm$ in the body frame (with origin at the center of mass), and $\\mathbf{v}(\\mathbf{p}_b)$ is its velocity in the spatial frame, which is $\\mathbf{v}(\\mathbf{p}_b) = \\omega_s \\times (R \\mathbf{p}_b)$.\nIt is more convenient to perform calculations in the body frame. The velocity of the mass element relative to the center of mass, expressed in body-frame coordinates, is $\\omega_b \\times \\mathbf{p}_b$. The magnitude of this velocity is invariant under rotation, so $\\|\\mathbf{v}(\\mathbf{p}_b)\\|^2 = \\|\\omega_b \\times \\mathbf{p}_b\\|^2$.\n$$ T_{\\text{rot}} = \\frac{1}{2} \\int_V \\|\\omega_b \\times \\mathbf{p}_b\\|^2 dm = \\frac{1}{2} \\int_V (-[\\mathbf{p}_b]_\\times \\omega_b)^\\top (-[\\mathbf{p}_b]_\\times \\omega_b) dm $$\nUsing the property $([\\mathbf{p}_b]_\\times)^\\top = -[\\mathbf{p}_b]_\\times$, this simplifies to:\n$$ T_{\\text{rot}} = \\frac{1}{2} \\int_V \\omega_b^\\top ([\\mathbf{p}_b]_\\times^\\top [\\mathbf{p}_b]_\\times) \\omega_b dm = \\frac{1}{2} \\omega_b^\\top \\left( -\\int_V [\\mathbf{p}_b]_\\times^2 dm \\right) \\omega_b $$\nThe term in the parenthesis is the body-frame inertia tensor $I_b$:\n$$ I_b = -\\int_V [\\mathbf{p}_b]_\\times^2 dm = \\int_V \\begin{pmatrix} y^2+z^2 & -xy & -xz \\\\ -yx & x^2+z^2 & -yz \\\\ -zx & -zy & x^2+y^2 \\end{pmatrix} dm $$\nwhere $\\mathbf{p}_b = (x,y,z)^\\top$. Thus, the rotational kinetic energy is given by the quadratic form:\n$$ T_{\\text{rot}}(t) = \\frac{1}{2} \\omega_b(t)^\\top I_b \\omega_b(t) $$\n\n### Numerical Implementation\n\nThe algorithm proceeds by first generating the discrete time series of attitude matrices $R(t_k)$. Then, for each time step $t_k$, it executes the following computations.\n\n1.  **Approximate $\\dot{R}(t_k)$**: The time derivative of the attitude matrix sequence is approximated using finite differences. We use a central difference scheme for interior points for its second-order accuracy, and forward/backward differences for the endpoints. For a time series $R_k = R(t_k)$ with uniform time step $\\Delta t$:\n    -   $\\dot{R}_0 \\approx \\frac{R_1 - R_0}{\\Delta t}$ (Forward difference)\n    -   $\\dot{R}_k \\approx \\frac{R_{k+1} - R_{k-1}}{2 \\Delta t}$ for $0 < k < N-1$ (Central difference)\n    -   $\\dot{R}_{N-1} \\approx \\frac{R_{N-1} - R_{N-2}}{\\Delta t}$ (Backward difference)\n    This scheme is readily implemented using `numpy.gradient`.\n\n2.  **Compute Body Angular Velocity $\\omega_b(t_k)$**:\n    a.  Compute the matrix $\\Omega_k = R(t_k)^\\top \\dot{R}(t_k)$.\n    b.  Due to numerical errors from the finite difference scheme, $\\Omega_k$ may not be perfectly skew-symmetric. We enforce this property by projecting it onto the space $\\mathfrak{so}(3)$:\n        $$ \\Omega'_k = \\frac{1}{2} (\\Omega_k - \\Omega_k^\\top) $$\n    c.  Extract the angular velocity vector $\\omega_{b,k}$ from the skew-symmetric matrix $\\Omega'_k$ using the vee operator:\n        $$ \\omega_{b,k} = (\\Omega'_{k,21}, \\Omega'_{k,02}, \\Omega'_{k,10})^\\top $$\n\n3.  **Compute Rotational Kinetic Energy $T_{\\text{rot}}(t_k)$**:\n    Using the computed body angular velocity $\\omega_{b,k}$ and the given inertia tensor $I_b$, the kinetic energy is calculated as:\n    $$ T_{\\text{rot},k} = \\frac{1}{2} \\omega_{b,k}^\\top I_b \\omega_{b,k} $$\n\nThis procedure is applied to each test case to compute the specified metrics.",
            "answer": "`[1.3322676295501878e-15,0.006283251412027231,0.9029676579893922]`"
        }
    ]
}