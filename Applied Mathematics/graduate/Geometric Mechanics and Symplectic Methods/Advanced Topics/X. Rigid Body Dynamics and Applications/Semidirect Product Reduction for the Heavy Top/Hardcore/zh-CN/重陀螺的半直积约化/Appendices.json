{
    "hands_on_practices": [
        {
            "introduction": "分析任何力学系统的第一步都是推导其运动方程。这个练习将指导你使用半直积的欧拉-庞加莱框架，从拉格朗日量出发，推导重刚体的运动方程 。这个过程将巩固你对拉格朗日形式和简化后的李-泊松方程之间联系的理解，是几何力学中的一项基本功。",
            "id": "3765893",
            "problem": "考虑一个刚性重陀螺，该陀螺被建模为一个半直积系统，其中三维特殊正交群 (SO(3)) 作用于三维向量空间。系统状态由物体角速度 $\\Omega \\in \\mathbb{R}^{3}$ 和伴随引力方向 $\\Gamma \\in \\mathbb{R}^{3}$ 描述。设物体惯性张量 $I:\\mathbb{R}^{3}\\to\\mathbb{R}^{3}$ 是对称正定的，质量为 $m$，重力加速度为 $g$，从固定点到质心的距离为 $l$，从固定点指向质心的固定物体向量为 $\\chi \\in \\mathbb{R}^{3}$。约化拉格朗日量为\n$$\nl(\\Omega,\\Gamma)=\\frac{1}{2}\\,\\Omega\\cdot I\\Omega - mgl\\,\\Gamma\\cdot \\chi.\n$$\n使用哈密顿原理处理具有右不变约化和相关约束变分的半直积，并从以下基本出发点开始：\n- 通过帽子映射将三维特殊正交群的李代数 (so(3)) 与 $\\mathbb{R}^{3}$ 等同，其中李括号由叉积给出。\n- 对于 $\\Omega,\\mu\\in\\mathbb{R}^{3}$，余伴随作用恒等式为 $\\,\\mathrm{ad}^{*}_{\\Omega}\\mu=\\mu\\times\\Omega\\,$。\n- 物体坐标系中引力方向的伴随参数运动学为 $\\dot{\\Gamma}+\\Omega\\times\\Gamma=0$。\n- 半直积的钻石运算 (diamond operation) 的定义，该运算由标准旋转作用诱导，通过与无穷小生成元的对偶性得到。\n\n推导该系统的带伴随参数的欧拉-庞加莱 (EP) 方程，计算变分导数 $\\frac{\\delta l}{\\delta \\Omega}$ 和 $\\frac{\\delta l}{\\delta \\Gamma}$，然后简化表示为 $-\\Gamma\\times\\frac{\\delta l}{\\delta \\Gamma}$ 的相应半直积力项。除了所列出的基本出发点外，不要引入任何快捷公式；相反，明确执行达到约化方程所需的所有变分步骤。\n\n将您的最终结果表示为一个由元组 $\\left(\\frac{\\delta l}{\\delta \\Omega},\\frac{\\delta l}{\\delta \\Gamma},-\\Gamma\\times\\frac{\\delta l}{\\delta \\Gamma}\\right)$ 组成的单一闭式解析表达式。无需进行数值计算。如果返回多个表达式，请将它们表示为单个行矩阵。最终表达式中不需要单位，角度应理解为弧度。",
            "solution": "该问题是有效的。这是一个几何力学中适定的问题，基于已建立的科学原理，并且为唯一的推导提供了所有必要的信息。\n\n重陀螺的欧拉-庞加莱方程的推导始于约化系统的哈密顿原理。作用量 $S$ 是约化拉格朗日量 $l(\\Omega, \\Gamma)$ 在时间区间 $[t_1, t_2]$ 上的积分。\n$$\nS = \\int_{t_1}^{t_2} l(\\Omega(t), \\Gamma(t)) dt\n$$\n哈密顿原理指出，对于路径的任何容许变分，作用量的变分 $\\delta S$ 必须为零，即 $\\delta S = 0$。\n$$\n\\delta S = \\delta \\int_{t_1}^{t_2} l(\\Omega, \\Gamma) dt = \\int_{t_1}^{t_2} \\delta l(\\Omega, \\Gamma) dt = 0\n$$\n拉格朗日量的变分 $\\delta l$ 由链式法则给出：\n$$\n\\delta l = \\frac{\\delta l}{\\delta \\Omega} \\cdot \\delta \\Omega + \\frac{\\delta l}{\\delta \\Gamma} \\cdot \\delta \\Gamma\n$$\n这里，$\\frac{\\delta l}{\\delta \\Omega}$ 和 $\\frac{\\delta l}{\\delta \\Gamma}$ 是拉格朗日量的变分（或泛函）导数。该问题设定在右不变约化的框架中。位形由路径 $g(t) \\in SO(3)$ 描述。物体角速度为 $\\Omega(t) = g(t)^{-1} \\dot{g}(t)$。路径的变分由 $g_\\epsilon(t) = g(t) \\exp(\\epsilon \\xi(t))$ 给出，其中 $\\xi(t) \\in \\mathfrak{so}(3) \\cong \\mathbb{R}^3$ 是一个在端点处为零的任意变分向量场，即 $\\xi(t_1) = \\xi(t_2) = 0$。\n\n变分 $\\delta \\Omega$ 和 $\\delta \\Gamma$ 是由 $\\xi(t)$ 诱导的。\n物体角速度 $\\Omega$ 的变分由下式给出：\n$$\n\\delta \\Omega = \\frac{d\\xi}{dt} + [\\Omega, \\xi] = \\frac{d\\xi}{dt} + \\Omega \\times \\xi\n$$\n伴随参数 $\\Gamma(t)$ 是从物体坐标系观察到的空间固定向量的表示，$\\Gamma(t) = g(t)^{-1} \\Gamma_{\\text{space}}$。其变分为：\n$$\n\\delta \\Gamma = \\frac{d}{d\\epsilon}\\bigg|_{\\epsilon=0} (\\exp(\\epsilon \\xi(t))^{-1} \\Gamma(t)) = -\\hat{\\xi}\\Gamma = -\\xi \\times \\Gamma = \\Gamma \\times \\xi\n$$\n这与所提供的运动学方程 $\\dot{\\Gamma} + \\Omega \\times \\Gamma = 0$ 一致，通过对 $\\Gamma (t) = g(t)^{-1}\\Gamma_{\\text{space}}$ 求导可以看出。\n\n将 $\\delta l$、$\\delta\\Omega$ 和 $\\delta\\Gamma$ 的这些表达式代入作用量变分中，得到：\n$$\n\\delta S = \\int_{t_1}^{t_2} \\left[ \\frac{\\delta l}{\\delta \\Omega} \\cdot \\left(\\frac{d\\xi}{dt} + \\Omega \\times \\xi\\right) + \\frac{\\delta l}{\\delta \\Gamma} \\cdot (\\Gamma \\times \\xi) \\right] dt = 0\n$$\n我们对第一项进行分部积分：\n$$\n\\int_{t_1}^{t_2} \\frac{\\delta l}{\\delta \\Omega} \\cdot \\frac{d\\xi}{dt} dt = \\left[ \\frac{\\delta l}{\\delta \\Omega} \\cdot \\xi \\right]_{t_1}^{t_2} - \\int_{t_1}^{t_2} \\frac{d}{dt}\\left(\\frac{\\delta l}{\\delta \\Omega}\\right) \\cdot \\xi dt\n$$\n边界项因为 $\\xi(t_1) = \\xi(t_2) = 0$ 而消失。积分变为：\n$$\n\\delta S = \\int_{t_1}^{t_2} \\left[ -\\frac{d}{dt}\\left(\\frac{\\delta l}{\\delta \\Omega}\\right) \\cdot \\xi + \\frac{\\delta l}{\\delta \\Omega} \\cdot (\\Omega \\times \\xi) + \\frac{\\delta l}{\\delta \\Gamma} \\cdot (\\Gamma \\times \\xi) \\right] dt = 0\n$$\n使用标量三重积恒等式 $A \\cdot (B \\times C) = C \\cdot (A \\times B)$，我们可以将变分 $\\xi$ 因子提出：\n$$\n\\frac{\\delta l}{\\delta \\Omega} \\cdot (\\Omega \\times \\xi) = \\xi \\cdot \\left(\\frac{\\delta l}{\\delta \\Omega} \\times \\Omega\\right)\n$$\n$$\n\\frac{\\delta l}{\\delta \\Gamma} \\cdot (\\Gamma \\times \\xi) = \\xi \\cdot \\left(\\frac{\\delta l}{\\delta \\Gamma} \\times \\Gamma\\right)\n$$\n将这些代回 $\\delta S$ 的积分中：\n$$\n\\delta S = \\int_{t_1}^{t_2} \\left[ -\\frac{d}{dt}\\left(\\frac{\\delta l}{\\delta \\Omega}\\right) + \\frac{\\delta l}{\\delta \\Omega} \\times \\Omega + \\frac{\\delta l}{\\delta \\Gamma} \\times \\Gamma \\right] \\cdot \\xi dt = 0\n$$\n因为这个方程必须对任意变分 $\\xi(t)$ 成立，所以方括号中的项必须恒为零。这就得出了带伴随参数的欧拉-庞加莱方程：\n$$\n\\frac{d}{dt}\\left(\\frac{\\delta l}{\\delta \\Omega}\\right) = \\frac{\\delta l}{\\delta \\Omega} \\times \\Omega + \\frac{\\delta l}{\\delta \\Gamma} \\times \\Gamma\n$$\n该方程描述了物体角动量的演化。右边的第一项 $\\frac{\\delta l}{\\delta \\Omega} \\times \\Omega$ 对应于余伴随作用项 $\\mathrm{ad}^*_\\Omega \\frac{\\delta l}{\\delta \\Omega}$。第二项 $\\frac{\\delta l}{\\delta \\Gamma} \\times \\Gamma$ 是由势能引起的力项，它对应于抽象理论中的钻石积项。\n\n现在我们为给定的拉格朗日量计算具体的量：\n$$\nl(\\Omega,\\Gamma)=\\frac{1}{2}\\,\\Omega\\cdot I\\Omega - mgl\\,\\Gamma\\cdot \\chi\n$$\n其中 $I$ 是对称惯性张量。\n\n首先，我们求关于 $\\Omega$ 的变分导数：\n$l$ 关于 $\\Omega$ 变化的变分是：\n$$\n\\delta_\\Omega l = \\frac{1}{2}(\\delta\\Omega \\cdot I\\Omega + \\Omega \\cdot I\\delta\\Omega) = \\frac{1}{2}(\\delta\\Omega \\cdot I\\Omega + \\Omega \\cdot I^T\\delta\\Omega) = \\frac{1}{2}(\\delta\\Omega \\cdot I\\Omega + I\\Omega \\cdot \\delta\\Omega) = I\\Omega \\cdot \\delta\\Omega\n$$\n因此，变分导数为：\n$$\n\\frac{\\delta l}{\\delta \\Omega} = I\\Omega\n$$\n这是重陀螺在物体坐标系中的角动量。\n\n其次，我们求关于 $\\Gamma$ 的变分导数：\n$l$ 关于 $\\Gamma$ 变化的变分是：\n$$\n\\delta_\\Gamma l = -mgl\\,(\\delta\\Gamma \\cdot \\chi) = (-mgl\\chi) \\cdot \\delta\\Gamma\n$$\n因此，变分导数为：\n$$\n\\frac{\\delta l}{\\delta \\Gamma} = -mgl\\,\\chi\n$$\n\n第三，我们计算问题中指定的半直积力项 $-\\Gamma\\times\\frac{\\delta l}{\\delta \\Gamma}$：\n$$\n-\\Gamma\\times\\frac{\\delta l}{\\delta \\Gamma} = -\\Gamma \\times (-mgl\\,\\chi) = mgl\\,(\\Gamma \\times \\chi)\n$$\n该项表示重力施加在陀螺上的力矩，在物体坐标系中表示。我们注意到，这与从第一性原理推导出的力项 $\\frac{\\delta l}{\\delta \\Gamma} \\times \\Gamma$ 是相同的：\n$$\n\\frac{\\delta l}{\\delta \\Gamma} \\times \\Gamma = (-mgl\\,\\chi) \\times \\Gamma = -mgl\\,(\\chi \\times \\Gamma) = mgl\\,(\\Gamma \\times \\chi)\n$$\n\n问题要求给出这三个计算量的元组。它们是：\n1.  $\\frac{\\delta l}{\\delta \\Omega} = I\\Omega$\n2.  $\\frac{\\delta l}{\\delta \\Gamma} = -mgl\\,\\chi$\n3.  $-\\Gamma\\times\\frac{\\delta l}{\\delta \\Gamma} = mgl\\,(\\Gamma \\times \\chi)$\n\n按要求将这些组合成一个单一的表达式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} I\\Omega  -mgl\\chi  mgl(\\Gamma \\times \\chi) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在推导出运动方程后，下一步往往是寻找守恒量，因为它们可以极大地简化系统的分析。这个练习将应用诺特定理，在几何力学的背景下，找出与重刚体轴对称性相对应的守恒量——即垂直方向的角动量分量 。这个练习揭示了对称性与守恒律之间深刻的联系，这是现代物理学的基石之一。",
            "id": "3765899",
            "problem": "考虑一个重刚体，其位形由特殊正交群 $\\mathrm{SO}(3)$ 描述，取向为 $R \\in \\mathrm{SO}(3)$，体角速度为 $\\Omega \\in \\mathbb{R}^{3}$，定义为 $\\widehat{\\Omega} = R^{-1} \\dot{R}$，伴流参数为 $\\Gamma \\in \\mathbb{R}^{3}$，由 $\\Gamma = R^{\\top} e_{3}$ 给出，其中 $e_{3} \\in \\mathbb{R}^{3}$ 是沿垂直（空间固定）轴的单位向量。映射 $\\,\\widehat{\\cdot}\\, : \\mathbb{R}^{3} \\to \\mathfrak{so}(3)$ 是满足对所有 $u, v \\in \\mathbb{R}^{3}$ 都有 $\\widehat{u} v = u \\times v$ 的典范同构。约化重刚体的拉格朗日量为\n$$\n\\ell(\\Omega, \\Gamma) = \\tfrac{1}{2}\\, \\Omega \\cdot \\mathbb{I} \\Omega \\;-\\; m g\\, \\chi \\cdot \\Gamma,\n$$\n其中 $\\mathbb{I}$ 是惯性张量（一个在 $\\mathbb{R}^{3}$ 上的对称正定线性映射），$m$ 是质量，$g$ 是重力加速度，$\\chi \\in \\mathbb{R}^{3}$ 是从固定点到质心的向量，在体坐标系中表示。伴流参数的运动学约束为 $\\dot{\\Gamma} = -\\,\\Omega \\times \\Gamma$。\n\n作用于该位形的对称群是绕空间固定垂直轴 $e_3$ 旋转的子群 $\\mathrm{SO}(2) \\subset \\mathrm{SO}(3)$。该子群通过左乘作用于 $R$，即对 $h \\in \\mathrm{SO}(2)$ 有 $h \\cdot R = h R$，并使 $\\Gamma$ 保持不变，即 $h \\cdot \\Gamma = \\Gamma$。该作用提升到切丛上为 $h \\cdot (R, \\dot{R}) = (h R, h \\dot{R})$。\n\n从以上定义和重刚体的拉格朗日量出发，并利用具有对称性和半直积约化系统的 Noether 定理的标准原理，完成以下任务：\n\n1. 计算与 $\\mathrm{SO}(2)$ 的单参数子群 $h(s) = \\exp\\!\\big(s\\,\\widehat{e_{3}}\\big)$ 相关联的、在 $(R, \\Gamma)$ 上的无穷小生成元（基本向量场）。\n2. 计算与此 $\\mathrm{SO}(2)$ 对称性相应的守恒量（动量映射值），并纯粹用 $\\Omega$、$\\Gamma$ 和 $\\mathbb{I}$ 表示。\n\n你的最终答案必须同时包含无穷小生成元和守恒量。将最终答案表示为一个行矩阵，顺序如下：第一个元素等于在 $(R, \\Gamma)$ 上的无穷小生成元，第二个元素等于守恒量。不需要进行数值计算，也不需要四舍五入。最终答案中不应出现物理单位。对于任何角度描述，请使用弧度。",
            "solution": "问题陈述有效。这是一个几何力学中适定的问题，基于重刚体和半直积约化的标准理论。其定义、约束和要求的计算在科学上是合理的、完整的且表述一致。我们将开始求解。\n\n问题要求两个量：指定的 $\\mathrm{SO}(2)$ 对称作用的无穷小生成元，以及根据 Noether 定理导出的相应守恒量。\n\n**1. 无穷小生成元**\n\n系统的位形由对 $(R, \\Gamma) \\in \\mathrm{SO}(3) \\times \\mathbb{R}^3$ 描述。对称群为 $G = \\mathrm{SO}(2)$，被识别为 $\\mathrm{SO}(3)$ 中绕空间固定垂直轴 $e_3$ 旋转的子群。与此对称性对应的单参数子群由 $h(s) = \\exp(s\\,\\widehat{e_3})$ 给出，其中 $\\widehat{e_3}$ 是李代数 $\\mathfrak{so}(3)$ 中对应于 $e_3 \\in \\mathbb{R}^3$ 的元素。\n\n元素 $h \\in \\mathrm{SO}(2)$ 在点 $(R, \\Gamma)$ 上的作用定义为：\n- 对 $R$ 的作用：$h \\cdot R = hR$（左乘）。\n- 对 $\\Gamma$ 的作用：$h \\cdot \\Gamma = \\Gamma$（恒等作用）。\n\n与李代数元素 $\\xi = \\widehat{e_3} \\in \\mathfrak{so}(3)$ 相关联的作用的无穷小生成元，是流形 $\\mathrm{SO}(3) \\times \\mathbb{R}^3$ 上的一个向量场。在点 $(R, \\Gamma)$ 处的该向量场，是通过对单参数子群 $h(s) = \\exp(s\\xi)$ 的作用在 $s=0$ 处求导得到的。\n\n在点 $R$ 处，生成元在 $\\mathrm{SO}(3)$ 上的分量为：\n$$ \\xi_{\\mathrm{SO}(3)}(R) = \\left. \\frac{d}{ds} \\right|_{s=0} (h(s) \\cdot R) = \\left. \\frac{d}{ds} \\right|_{s=0} (\\exp(s\\widehat{e_3}) R) $$\n使用微分的乘法法则，我们得到：\n$$ \\xi_{\\mathrm{SO}(3)}(R) = \\left( \\left. \\frac{d}{ds} \\right|_{s=0} \\exp(s\\widehat{e_3}) \\right) R = \\widehat{e_3} R $$\n这是 $T_R\\mathrm{SO}(3)$ 中的一个切向量，即 $\\mathrm{SO}(3)$ 在 $R$ 点的切空间。\n\n在点 $\\Gamma$ 处，生成元在 $\\mathbb{R}^3$ 上的分量为：\n$$ \\xi_{\\mathbb{R}^3}(\\Gamma) = \\left. \\frac{d}{ds} \\right|_{s=0} (h(s) \\cdot \\Gamma) = \\left. \\frac{d}{ds} \\right|_{s=0} (\\Gamma) = 0 $$\n生成元在 $\\mathbb{R}^3$ 上是零向量场，因为对 $\\Gamma$ 的作用是平凡的。\n\n综合这些，在乘积空间 $\\mathrm{SO}(3) \\times \\mathbb{R}^3$ 的点 $(R, \\Gamma)$ 上的无穷小生成元是对 $(\\widehat{e_3} R, 0)$。\n\n**2. 守恒量（动量映射）**\n\n根据 Noether 定理，重刚体拉格朗日量在 $\\mathrm{SO}(2)$ 对 $\\mathrm{SO}(3)$ 的左作用下保持不变，这保证了守恒量的存在。该量是与该对称性相关联的动量映射的值。\n\n在完整切丛 $T\\mathrm{SO}(3)$ 上的拉格朗日量由 $L(R, \\dot{R}) = \\ell(\\Omega, \\Gamma)$ 给出，其中 $\\Omega$ 和 $\\Gamma$ 是 $(R, \\dot{R})$ 的函数：\n$$ L(R, \\dot{R}) = \\frac{1}{2} (\\text{unhat}(R^{-1}\\dot{R})) \\cdot \\mathbb{I} (\\text{unhat}(R^{-1}\\dot{R})) - m g\\, \\chi \\cdot (R^{\\top} e_3) $$\n与李代数元素 $\\xi$ 相关联的守恒量由共轭动量与位形空间上作用的无穷小生成元的配对给出：$J_{\\xi} = \\langle \\frac{\\partial L}{\\partial \\dot{R}}, \\xi_{\\mathrm{SO}(3)}(R) \\rangle$。\n\n通常使用体固定的量更为方便。李群上左不变系统的动量映射可以表示为体坐标系中的动量 $\\Pi = \\frac{\\partial \\ell}{\\partial \\Omega}$ 与对称性生成元的体表示的配对。\n\n首先，我们从约化的拉格朗日量 $\\ell(\\Omega, \\Gamma) = \\frac{1}{2} \\Omega \\cdot \\mathbb{I} \\Omega - m g\\, \\chi \\cdot \\Gamma$ 计算体动量 $\\Pi \\in \\mathbb{R}^3$。体角速度 $\\Omega$ 的共轭动量为：\n$$ \\Pi = \\frac{\\partial \\ell}{\\partial \\Omega} = \\mathbb{I} \\Omega $$\n这是在体固定坐标系中表示的角动量向量。\n\n接下来，我们求对称性生成元在体坐标系中的表示。该对称性对应于绕空间固定轴 $e_3$ 的旋转。向量 $e_3$ 通过变换 $R^{-1}e_3$ 在体坐标系中表示。因为 $R \\in \\mathrm{SO}(3)$，其逆是其转置，即 $R^{-1} = R^{\\top}$。因此，对称轴的体表示是 $R^{\\top}e_3$。\n根据问题陈述，我们已知伴流参数 $\\Gamma = R^{\\top}e_3$。因此，$\\Gamma$ 正是空间固定垂直轴在体坐标系中的表示。\n\n守恒量是体角动量 $\\Pi$ 和对称轴的体表示 $\\Gamma$ 的点积：\n$$ p_3 = \\Pi \\cdot \\Gamma = (\\mathbb{I}\\Omega) \\cdot \\Gamma $$\n\n这个结果可以通过考虑空间角动量来验证。空间角动量向量为 $\\pi = R\\Pi = R\\mathbb{I}\\Omega$。对称性是关于绕固定空间轴 $e_3$ 的旋转。守恒量是空间角动量沿此轴的分量：\n$$ \\pi \\cdot e_3 = (R\\mathbb{I}\\Omega) \\cdot e_3 $$\n利用正交变换下点积的性质 $\\langle u, v \\rangle = \\langle R^{\\top}u, R^{\\top}v \\rangle$，我们可以将其写为：\n$$ (R\\mathbb{I}\\Omega) \\cdot e_3 = \\langle R\\mathbb{I}\\Omega, e_3 \\rangle = \\langle \\mathbb{I}\\Omega, R^{\\top}e_3 \\rangle = (\\mathbb{I}\\Omega) \\cdot (R^{\\top}e_3) $$\n代入 $\\Gamma = R^{\\top}e_3$，我们得到相同的结果：\n$$ p_3 = (\\mathbb{I}\\Omega) \\cdot \\Gamma $$\n这个量代表总角动量的守恒的垂直分量。\n\n所要求的两个量是无穷小生成元 $(\\widehat{e_3} R, 0)$ 和守恒量 $(\\mathbb{I}\\Omega) \\cdot \\Gamma$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} (\\widehat{e_3} R, 0)  (\\mathbb{I}\\Omega) \\cdot \\Gamma \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "解析解在复杂系统中是罕见的，因此我们经常需要借助数值方法。这个练习将理论付诸实践，要求你实现一个李-泊松积分器 。这种积分器的特殊之处在于，它在设计上能够精确地保持系统的几何不变量（卡西米尔不变量），从而得到更稳定和物理上更准确的长期模拟结果。",
            "id": "3765884",
            "problem": "考虑特殊正交群上的重陀螺，它通过半直积结构 $SO(3) \\ltimes \\mathbb{R}^3$ 作用于一个向量空间。设体角动量为 $\\Pi \\in \\mathbb{R}^3$，固定空间垂直方向的物体坐标系表示为 $\\Gamma \\in \\mathbb{R}^3$。惯性张量是一个对称正定矩阵 $I \\in \\mathbb{R}^{3 \\times 3}$，质量为 $m$（单位：千克），重力加速度为 $g$（单位：米/秒²），从固定点到质心的向量为 $\\chi$（单位：米）。在半直积李代数的对偶空间上，约化后的重陀螺方程为\n$$\n\\dot{\\Pi} = \\Pi \\times \\Omega + mg(\\Gamma \\times \\chi), \\qquad \\dot{\\Gamma} = \\Gamma \\times \\Omega,\n$$\n其中角速度定义为\n$$\n\\Omega = I^{-1} \\Pi.\n$$\n在本次数值实现中，我们假设质心位于刚体的第三根主轴上，即 $\\chi = (0, 0, l)$，其中 $l$ 是从固定点到质心的距离。角度必须以弧度为单位。\n\n您的任务是实现一个单步一阶李-泊松积分器，从给定的 $(\\Pi, \\Gamma)$ 和参数 $(I, m, g, l)$ 出发，将 $(\\Pi, \\Gamma)$ 向前推进一个时间步长 $h$（单位：秒）。该积分器必须基于半直积结构，并在离散层面上精确保持李-泊松不变量（卡西米尔不变量）$C_1 = \\|\\Gamma\\|^2$ 和 $C_2 = \\Pi \\cdot \\Gamma$。设计您的程序以实现以下功能：\n- 计算 $\\Omega = I^{-1}\\Pi$。\n- 使用矩阵指数 $\\exp(h[\\Omega]_\\times)$ 应用由 $\\Omega$ 生成的李群旋转，其中 $[\\Omega]_\\times$ 是表示与 $\\Omega$ 的叉积的反对称矩阵，以此来推进 $\\Pi$ 和 $\\Gamma$。\n- 以与半直积约化一致的方式应用引力相互作用，从而使离散映射能够保持卡西米尔不变量 $C_1$ 和 $C_2$。\n\n物理单位：\n- $I$ 单位为千克·米² ($\\mathrm{kg}\\cdot \\mathrm{m}^2$)，\n- $m$ 单位为千克 ($\\mathrm{kg}$)，\n- $g$ 单位为米/秒² ($\\mathrm{m/s}^2$)，\n- $l$ 单位为米 ($\\mathrm{m}$)，\n- $\\Pi$ 单位为千克·米²/秒 ($\\mathrm{kg}\\cdot \\mathrm{m}^2/\\mathrm{s}$)，\n- $h$ 单位为秒 ($\\mathrm{s}$)，\n- $\\Gamma$ 是无量纲的。\n\n对于每个测试用例，您的程序应生成一个时间步长 $h$ 后更新的 $(\\Pi_{\\text{new}}, \\Gamma_{\\text{new}})$，并计算卡西米尔不变量的变化：\n$$\n\\Delta C_1 = \\|\\Gamma_{\\text{new}}\\|^2 - \\|\\Gamma\\|^2, \\qquad\n\\Delta C_2 = \\Pi_{\\text{new}} \\cdot \\Gamma_{\\text{new}} - \\Pi \\cdot \\Gamma.\n$$\n为每个测试用例返回这八个数字组成的列表 $[\\Pi_{\\text{new},1}, \\Pi_{\\text{new},2}, \\Pi_{\\text{new},3}, \\Gamma_{\\text{new},1}, \\Gamma_{\\text{new},2}, \\Gamma_{\\text{new},3}, \\Delta C_1, \\Delta C_2]$。\n\n测试套件（所有角度均以弧度为单位，时间步长 $h$ 以秒为单位）：\n1. 具有各向异性惯量的典型情况：\n   - $I = \\mathrm{diag}(0.37,\\,0.52,\\,0.91)$ $\\mathrm{kg}\\cdot\\mathrm{m}^2$,\n   - $m = 3.0$ $\\mathrm{kg}$，$g = 9.80665$ $\\mathrm{m/s}^2$，$l = 0.25$ $\\mathrm{m}$,\n   - $h = 0.01$ $\\mathrm{s}$,\n   - $\\Pi = (0.12,\\,-0.08,\\,0.20)$ $\\mathrm{kg}\\cdot\\mathrm{m}^2/\\mathrm{s}$,\n   - $\\Gamma = \\left(0.5,\\,0.5,\\,0.70710678\\right)$ (单位向量)。\n2. 角动量为零的边界情况：\n   - $I = \\mathrm{diag}(1.1,\\,0.9,\\,0.7)$ $\\mathrm{kg}\\cdot\\mathrm{m}^2$,\n   - $m = 2.5$ $\\mathrm{kg}$，$g = 9.81$ $\\mathrm{m/s}^2$，$l = 0.35$ $\\mathrm{m}$,\n   - $h = 0.005$ $\\mathrm{s}$,\n   - $\\Pi = (0,\\,0,\\,0)$ $\\mathrm{kg}\\cdot\\mathrm{m}^2/\\mathrm{s}$,\n   - $\\Gamma = (0.6,\\,-0.8,\\,0.0)$ (单位向量)。\n3. 垂直对齐 $\\Gamma \\parallel e_3$ 的边缘情况：\n   - $I = \\mathrm{diag}(0.8,\\,0.6,\\,0.4)$ $\\mathrm{kg}\\cdot\\mathrm{m}^2$,\n   - $m = 1.2$ $\\mathrm{kg}$，$g = 9.81$ $\\mathrm{m/s}^2$，$l = 0.20$ $\\mathrm{m}$,\n   - $h = 0.02$ $\\mathrm{s}$,\n   - $\\Pi = (0.3,\\,-0.15,\\,0.05)$ $\\mathrm{kg}\\cdot\\mathrm{m}^2/\\mathrm{s}$,\n   - $\\Gamma = (0.0,\\,0.0,\\,1.0)$ (单位向量)。\n4. 无重力情况 ($g = 0$)：\n   - $I = \\mathrm{diag}(0.5,\\,0.5,\\,0.5)$ $\\mathrm{kg}\\cdot\\mathrm{m}^2$,\n   - $m = 4.0$ $\\mathrm{kg}$，$g = 0.0$ $\\mathrm{m/s}^2$，$l = 0.30$ $\\mathrm{m}$,\n   - $h = 0.015$ $\\mathrm{s}$,\n   - $\\Pi = (0.05,\\,0.08,\\,-0.02)$ $\\mathrm{kg}\\cdot\\mathrm{m}^2/\\mathrm{s}$,\n   - $\\Gamma = (0.2,\\,0.5,\\,0.842614)$ (单位向量)。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有测试用例的结果。结果是一个用方括号括起来的逗号分隔列表，每个测试用例的结果本身也是一个如上所述格式的列表。例如：\n- $[\\,[\\Pi_{\\text{new},1},\\Pi_{\\text{new},2},\\Pi_{\\text{new},3},\\Gamma_{\\text{new},1},\\Gamma_{\\text{new},2},\\Gamma_{\\text{new},3},\\Delta C_1,\\Delta C_2],\\ldots\\,]$.",
            "solution": "该问题要求为重陀螺的运动方程实现一个一阶李-泊松积分器。该动力学系统是在半直积群 $SE(3) = SO(3) \\ltimes \\mathbb{R}^3$ 的李代数的对偶空间上描述的。系统状态由数对 $(\\Pi, \\Gamma)$ 给出，其中 $\\Pi \\in \\mathbb{R}^3$ 是体坐标系中的角动量，而 $\\Gamma \\in \\mathbb{R}^3$ 是固定空间垂直方向在体坐标系中的表示。\n\n运动方程如下：\n$$\n\\dot{\\Pi} = \\Pi \\times \\Omega + mg(\\Gamma \\times \\chi)\n$$\n$$\n\\dot{\\Gamma} = \\Gamma \\times \\Omega\n$$\n其中 $\\Omega = I^{-1} \\Pi$ 是体角速度，$I$ 是惯性张量，$m$ 是质量，$g$ 是重力加速度，$\\chi$ 是从支点到质心的体坐标系向量。\n\n该系统拥有两个卡西米尔不变量，它们是在任何轨迹上都保持恒定的函数。它们由以下公式给出：\n$C_1 = \\|\\Gamma\\|^2$\n$C_2 = \\Pi \\cdot \\Gamma$\n李-泊松积分器是一种数值方法，其设计旨在离散层面上精确保持这些卡西米尔不变量，从而尊重相空间的几何结构。\n\n该问题指定了一个通过分裂法构建的一阶积分器。控制动力学的矢量场可以分解为两个不同的部分。设状态为 $z = (\\Pi, \\Gamma)$。方程 $\\dot{z} = f(z)$ 被分裂为 $\\dot{z} = f_1(z) + f_2(z)$，其中：\n$f_1(\\Pi, \\Gamma) = (\\Pi \\times \\Omega, \\Gamma \\times \\Omega)$：这对应于自由刚体的动力学。\n$f_2(\\Pi, \\Gamma) = (mg(\\Gamma \\times \\chi), 0)$：这对应于引力矩的作用。\n\n李-特罗特分裂法的关键思想是，如果我们能为每个子问题找到精确解（流）$\\Phi_t^{f_1}$ 和 $\\Phi_t^{f_2}$，我们就可以通过组合它们来近似整个系统的流。对于一个时间步长 $h$，一阶积分器由 $\\Phi_h \\approx \\Phi_h^{f_2} \\circ \\Phi_h^{f_1}$ 给出。组合的顺序可以颠倒；我们选择这个特定的顺序。我们现在将证明这种组合精确地保持了卡西米尔不变量 $C_1$ 和 $C_2$。\n\n**步骤1：自由刚体子问题的流，$\\Phi_h^{f_1}$**\n这部分的方程是 $\\dot{\\Pi} = \\Pi \\times \\Omega$ 和 $\\dot{\\Gamma} = \\Gamma \\times \\Omega$，其中为了分裂的目的，$\\Omega = I^{-1}\\Pi$ 在无穷小区间内保持不变。这描述了向量 $\\Pi$ 和 $\\Gamma$ 围绕轴 $\\Omega$ 以角速度 $\\|\\Omega\\|$ 的旋转。在一个时间步长 $h$ 上的解是一个旋转。设 $(\\Pi_n, \\Gamma_n)$ 是步长开始时的状态。我们首先计算角速度 $\\Omega_n = I^{-1}\\Pi_n$。然后通过一个旋转矩阵 $R_n = \\exp(h[\\Omega_n]_\\times)$ 来更新状态，其中 $[\\Omega_n]_\\times$ 是对应于与 $\\Omega_n$ 的叉积的反对称矩阵。\n中间状态 $(\\Pi_{n+1/2}, \\Gamma_{n+1/2})$ 为：\n$$\n\\Pi_{n+1/2} = R_n \\Pi_n\n$$\n$$\n\\Gamma_{n+1/2} = R_n \\Gamma_n\n$$\n由于 $R_n$ 是一个正交矩阵（$R_n^T R_n = I$），它保持范数和点积不变。因此，这一步同时保持了两个卡西米尔不变量：\n$\\|\\Gamma_{n+1/2}\\|^2 = \\|R_n \\Gamma_n\\|^2 = \\Gamma_n^T R_n^T R_n \\Gamma_n = \\Gamma_n^T \\Gamma_n = \\|\\Gamma_n\\|^2$。\n$\\Pi_{n+1/2} \\cdot \\Gamma_{n+1/2} = (R_n \\Pi_n) \\cdot (R_n \\Gamma_n) = \\Pi_n^T R_n^T R_n \\Gamma_n = \\Pi_n^T \\Gamma_n = \\Pi_n \\cdot \\Gamma_n$。\n\n**步骤2：引力矩子问题的流，$\\Phi_h^{f_2}$**\n这部分的方程是 $\\dot{\\Pi} = mg(\\Gamma \\times \\chi)$ 和 $\\dot{\\Gamma} = 0$。\n在这个子系统中，$\\Gamma$ 是常数。关于 $\\Pi$ 的方程是一个简单的前向欧拉步，这是精确的，因为在该步长内右侧是常数（因为 $\\Gamma$ 是常数）。我们将此流应用于中间状态 $(\\Pi_{n+1/2}, \\Gamma_{n+1/2})$。\n最终状态 $(\\Pi_{n+1}, \\Gamma_{n+1})$ 为：\n$$\n\\Pi_{n+1} = \\Pi_{n+1/2} + h \\, mg (\\Gamma_{n+1/2} \\times \\chi)\n$$\n$$\n\\Gamma_{n+1} = \\Gamma_{n+1/2}\n$$\n现在，我们检查这一步对卡西米尔不变量的保持情况。\n$C_1$ 的保持：\n$\\|\\Gamma_{n+1}\\|^2 = \\|\\Gamma_{n+1/2}\\|^2$。这显然是保持的。\n$C_2$ 的保持：\n$ \\Pi_{n+1} \\cdot \\Gamma_{n+1} = \\left( \\Pi_{n+1/2} + h \\, mg (\\Gamma_{n+1/2} \\times \\chi) \\right) \\cdot \\Gamma_{n+1/2} $\n$ = \\Pi_{n+1/2} \\cdot \\Gamma_{n+1/2} + h \\, mg ((\\Gamma_{n+1/2} \\times \\chi) \\cdot \\Gamma_{n+1/2}) $\n第二项为零，因为叉积 $\\Gamma_{n+1/2} \\times \\chi$ 产生一个与 $\\Gamma_{n+1/2}$ 正交的向量。因此，它们的点积为零。\n$ \\Pi_{n+1} \\cdot \\Gamma_{n+1} = \\Pi_{n+1/2} \\cdot \\Gamma_{n+1/2} $\n\n通过组合这两个步骤，我们发现 $(\\Pi_{n+1}, \\Gamma_{n+1})$ 具有与 $(\\Pi_n, \\Gamma_n)$ 相同的卡西米尔值。卡西米尔不变量的变化量 $\\Delta C_1$ 和 $\\Delta C_2$ 在浮点精度范围内将为零。该实现将使用 `scipy.linalg.expm` 来计算矩阵指数，这是一种数值稳健的方法。\n\n单步的整体算法如下：\n1. 给定 $(\\Pi_n, \\Gamma_n)$ 和参数 $(I, m, g, l, h)$，计算初始卡西米尔不变量 $C_{1,n} = \\Gamma_n \\cdot \\Gamma_n$ 和 $C_{2,n} = \\Pi_n \\cdot \\Gamma_n$。根据问题设定，$\\chi=(0,0,l)$。\n2. 计算角速度 $\\Omega_n = I^{-1} \\Pi_n$。\n3. 构建反对称矩阵 $[\\Omega_n]_\\times$。\n4. 计算旋转矩阵 $R_n = \\exp(h[\\Omega_n]_\\times)$。\n5. 应用旋转：$\\Pi_{n+1/2} = R_n \\Pi_n$, $\\Gamma_{n+1/2} = R_n \\Gamma_n$。\n6. 应用引力矩：$\\Pi_{n+1} = \\Pi_{n+1/2} + h mg (\\Gamma_{n+1/2} \\times \\chi)$，$\\Gamma_{n+1} = \\Gamma_{n+1/2}$。\n7. 计算最终卡西米尔不变量 $C_{1,n+1} = \\Gamma_{n+1} \\cdot \\Gamma_{n+1}$ 和 $C_{2,n+1} = \\Pi_{n+1} \\cdot \\Gamma_{n+1}$。\n8. 计算差值 $\\Delta C_1 = C_{1,n+1} - C_{1,n}$ 和 $\\Delta C_2 = C_{2,n+1} - C_{2,n}$。\n9. 返回包含八个值的列表：$(\\Pi_{n+1}, \\Gamma_{n+1}, \\Delta C_1, \\Delta C_2)$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Solves the heavy top problem for the given test cases using a\n    one-step, first-order Lie-Poisson integrator.\n    \"\"\"\n\n    test_cases = [\n        # 1. Happy path with anisotropic inertia\n        {\n            \"I_diag\": np.array([0.37, 0.52, 0.91]),\n            \"m\": 3.0, \"g\": 9.80665, \"l\": 0.25, \"h\": 0.01,\n            \"Pi\": np.array([0.12, -0.08, 0.20]),\n            \"Gamma\": np.array([0.5, 0.5, 0.70710678]),\n        },\n        # 2. Boundary case with zero angular momentum\n        {\n            \"I_diag\": np.array([1.1, 0.9, 0.7]),\n            \"m\": 2.5, \"g\": 9.81, \"l\": 0.35, \"h\": 0.005,\n            \"Pi\": np.array([0.0, 0.0, 0.0]),\n            \"Gamma\": np.array([0.6, -0.8, 0.0]),\n        },\n        # 3. Edge case with vertical alignment Gamma || e_3\n        {\n            \"I_diag\": np.array([0.8, 0.6, 0.4]),\n            \"m\": 1.2, \"g\": 9.81, \"l\": 0.20, \"h\": 0.02,\n            \"Pi\": np.array([0.3, -0.15, 0.05]),\n            \"Gamma\": np.array([0.0, 0.0, 1.0]),\n        },\n        # 4. No gravity case (g = 0)\n        {\n            \"I_diag\": np.array([0.5, 0.5, 0.5]),\n            \"m\": 4.0, \"g\": 0.0, \"l\": 0.30, \"h\": 0.015,\n            \"Pi\": np.array([0.05, 0.08, -0.02]),\n            \"Gamma\": np.array([0.2, 0.5, 0.842614]),\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        I_inv = np.diag(1.0 / case[\"I_diag\"])\n        m, g, l, h = case[\"m\"], case[\"g\"], case[\"l\"], case[\"h\"]\n        Pi_n, Gamma_n = case[\"Pi\"], case[\"Gamma\"]\n        chi = np.array([0.0, 0.0, l])\n\n        # Calculate initial Casimirs\n        C1_initial = np.dot(Gamma_n, Gamma_n)\n        C2_initial = np.dot(Pi_n, Gamma_n)\n\n        # Step 1: Free rigid body motion (Flow of f1)\n        Omega_n = I_inv @ Pi_n\n        \n        # Handle zero rotation case\n        if np.linalg.norm(Omega_n) == 0.0:\n            R_n = np.identity(3)\n        else:\n            # Construct skew-symmetric matrix for cross product\n            Omega_skew = np.array([\n                [0, -Omega_n[2], Omega_n[1]],\n                [Omega_n[2], 0, -Omega_n[0]],\n                [-Omega_n[1], Omega_n[0], 0]\n            ])\n            # Compute rotation matrix using matrix exponential\n            R_n = expm(h * Omega_skew)\n        \n        # Apply rotation\n        Pi_half = R_n @ Pi_n\n        Gamma_half = R_n @ Gamma_n\n\n        # Step 2: Gravitational action (Flow of f2)\n        torque = m * g * np.cross(Gamma_half, chi)\n        \n        Pi_new = Pi_half + h * torque\n        Gamma_new = Gamma_half  # Gamma is constant in this step\n\n        # Calculate final Casimirs and their change\n        C1_final = np.dot(Gamma_new, Gamma_new)\n        C2_final = np.dot(Pi_new, Gamma_new)\n        \n        delta_C1 = C1_final - C1_initial\n        delta_C2 = C2_final - C2_initial\n        \n        # Format result for this case\n        case_result = list(Pi_new) + list(Gamma_new) + [delta_C1, delta_C2]\n        results.append(case_result)\n    \n    # Format the final output string\n    # Using a list of lists comprehension for clean formatting.\n    # The str() conversion is sufficient for standard floating point representation.\n    output_str = \"[\" + \",\".join([\n        \"[\" + \",\".join(map(str, res)) + \"]\" for res in results\n    ]) + \"]\"\n\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}