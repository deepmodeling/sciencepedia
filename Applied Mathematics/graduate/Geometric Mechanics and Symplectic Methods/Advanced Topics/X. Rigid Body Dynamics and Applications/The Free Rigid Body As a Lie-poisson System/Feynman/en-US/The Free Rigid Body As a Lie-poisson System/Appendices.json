{
    "hands_on_practices": [
        {
            "introduction": "To truly grasp the Lie-Poisson structure, it is essential to understand how the bracket operates on the fundamental functions defined on the dual space $\\mathfrak{so}(3)^*$. This exercise provides a foundational calculation, applying the bracket's definition to the simplest non-trivial case: linear functions. By working through this problem , you will see how the abstract definition of the bracket, $\\{F,G\\}(\\mu) = -\\langle \\mu, [\\nabla F, \\nabla G] \\rangle$, concretely translates into the familiar vector cross product, directly linking the Poisson geometry on $\\mathfrak{so}(3)^*$ to the Lie algebra structure of $\\mathfrak{so}(3)$.",
            "id": "3776224",
            "problem": "Consider the free rigid body formulated on the dual of the Lie algebra of the Special Orthogonal group $\\mathrm{SO}(3)$, namely $\\mathfrak{so}(3)^{*}$. Using the identification $\\mathfrak{so}(3) \\cong \\mathbb{R}^{3}$ via the hat map and the standard Euclidean pairing, one can view elements $M \\in \\mathfrak{so}(3)^{*}$ as vectors in $\\mathbb{R}^{3}$, and the Lie bracket on $\\mathfrak{so}(3)$ as the vector cross product on $\\mathbb{R}^{3}$. The Lie-Poisson bracket on $\\mathfrak{so}(3)^{*}$ is defined by the fundamental relation\n$$\n\\{F,G\\}(M) \\;=\\; -\\langle M,\\,[\\nabla F(M),\\,\\nabla G(M)]\\rangle,\n$$\nwhere $\\langle \\cdot,\\cdot\\rangle$ denotes the pairing between $\\mathfrak{so}(3)^{*}$ and $\\mathfrak{so}(3)$, $[\\cdot,\\cdot]$ is the Lie bracket on $\\mathfrak{so}(3)$, and $\\nabla F(M)$ is the gradient of $F$ at $M$ with respect to the Euclidean structure.\n\nLet $F_{a}(M) = a \\cdot M$ and $F_{b}(M) = b \\cdot M$ be linear functions on $\\mathfrak{so}(3)^{*}$, where $a,b \\in \\mathbb{R}^{3}$ are constant vectors and $\\cdot$ is the standard Euclidean dot product. Compute the Lie-Poisson bracket $\\{F_{a},F_{b}\\}(M)$ explicitly as a function of $M$, and express your result both in terms of the vector cross product on $\\mathbb{R}^{3}$ and in terms of the structure constants $c_{ij}^{\\ k}$ of $\\mathfrak{so}(3)$ with respect to a basis $\\{e_{1},e_{2},e_{3}\\}$ satisfying $[e_{i},e_{j}] = c_{ij}^{\\ k} e_{k}$, where $c_{ij}^{\\ k}$ coincide with the Levi-Civita symbol $\\epsilon_{ijk}$. Provide your final result as a single closed-form analytic expression. No rounding is required, and no units are involved.",
            "solution": "We begin from the definition of the Lie-Poisson bracket on the dual $\\mathfrak{so}(3)^{*}$ of a Lie algebra $\\mathfrak{g}$. For smooth functions $F,G : \\mathfrak{g}^{*} \\to \\mathbb{R}$, the Lie-Poisson bracket is given by\n$$\n\\{F,G\\}(\\mu) \\;=\\; -\\langle \\mu, [\\nabla F(\\mu), \\nabla G(\\mu)] \\rangle,\n$$\nwhere $\\mu \\in \\mathfrak{g}^{*}$, $\\langle \\cdot,\\cdot\\rangle$ is the canonical pairing between $\\mathfrak{g}^{*}$ and $\\mathfrak{g}$, and $[\\cdot,\\cdot]$ is the Lie bracket on $\\mathfrak{g}$. In our case, $\\mathfrak{g} = \\mathfrak{so}(3)$, and via the standard identification $\\mathfrak{so}(3) \\cong \\mathbb{R}^{3}$, the Lie bracket corresponds to the cross product:\n$$\n[x,y] \\;=\\; x \\times y, \\quad x,y \\in \\mathbb{R}^{3}.\n$$\nLet $M \\in \\mathfrak{so}(3)^{*} \\cong \\mathbb{R}^{3}$ be represented as a vector. For linear functions $F_{a}(M) = a \\cdot M$ and $F_{b}(M) = b \\cdot M$, where $a,b \\in \\mathbb{R}^{3}$ are constant vectors, we first compute their gradients. With the Euclidean pairing, the gradient is taken with respect to $M$, so\n$$\n\\nabla F_{a}(M) \\;=\\; a, \\qquad \\nabla F_{b}(M) \\;=\\; b,\n$$\nbecause the derivative of a linear functional $M \\mapsto a \\cdot M$ is the constant vector $a$.\n\nSubstituting into the Lie-Poisson bracket yields\n$$\n\\{F_{a},F_{b}\\}(M) \\;=\\; -\\langle M, [\\nabla F_{a}(M), \\nabla F_{b}(M)] \\rangle \\;=\\; -\\langle M, [a,b] \\rangle.\n$$\nUsing the identification $[a,b] = a \\times b$ and the pairing $\\langle M, X \\rangle = M \\cdot X$ for $X \\in \\mathbb{R}^{3}$, we obtain\n$$\n\\{F_{a},F_{b}\\}(M) \\;=\\; -M \\cdot (a \\times b).\n$$\nEquivalently, since the dot product is symmetric, this can also be written as\n$$\n\\{F_{a},F_{b}\\}(M) \\;=\\; -(a \\times b) \\cdot M.\n$$\n\nTo express this in terms of the structure constants $c_{ij}^{\\ k}$ for $\\mathfrak{so}(3)$, choose a basis $\\{e_{1},e_{2},e_{3}\\}$ of $\\mathfrak{so}(3)$ such that\n$$\n[e_{i}, e_{j}] \\;=\\; c_{ij}^{\\ k} e_{k}, \\quad \\text{with} \\quad c_{ij}^{\\ k} \\;=\\; \\epsilon_{ijk},\n$$\nwhere $\\epsilon_{ijk}$ is the Levi-Civita symbol. Write $a = a_{i} e_{i}$, $b = b_{j} e_{j}$ and $M = M_{k} e^{k}$, where $\\{e^{1},e^{2},e^{3}\\}$ is the dual basis in $\\mathfrak{so}(3)^{*}$, and Einstein summation is understood. Then\n$$\n[a,b] \\;=\\; a_{i} b_{j} [e_{i}, e_{j}] \\;=\\; a_{i} b_{j} c_{ij}^{\\ k} e_{k},\n$$\nand hence\n$$\n\\{F_{a},F_{b}\\}(M) \\;=\\; -\\langle M, [a,b] \\rangle \\;=\\; -M_{k} \\, a_{i} \\, b_{j} \\, c_{ij}^{\\ k} \\;=\\; -\\epsilon_{ijk} \\, a_{i} \\, b_{j} \\, M_{k}.\n$$\nThis expression is consistent with the vector cross product form, since $(a \\times b)_{k} = \\epsilon_{ijk} a_{i} b_{j}$, so $-(a \\times b) \\cdot M = -\\epsilon_{ijk} a_{i} b_{j} M_{k}$.\n\nTherefore, the explicit Lie-Poisson bracket of the linear functionals is the linear functional given by the cross product of the coefficients:\n$$\n\\{F_{a},F_{b}\\}(M) \\;=\\; -(a \\times b) \\cdot M \\;=\\; -\\epsilon_{ijk} \\, a_{i} \\, b_{j} \\, M_{k}.\n$$",
            "answer": "$$\\boxed{-(a\\times b)\\cdot M}$$"
        },
        {
            "introduction": "With the algebraic foundation in place, we can now apply the Lie-Poisson framework to derive and analyze the full dynamics of the free rigid body. This practice  is central to the topic, guiding you from the first principles of the Hamiltonian $H(M)$ and the Lie-Poisson bracket to the celebrated Euler equations of motion. Beyond just deriving equations, this exercise delves into the geometric heart of the system, revealing how the conserved quantities—the Casimir function $C(M)$ and the energy $H(M)$—constrain the motion to the intersection of a sphere and an ellipsoid, providing a powerful qualitative understanding of the body's tumbling and stability.",
            "id": "3776184",
            "problem": "Consider the free rigid body viewed as a Hamiltonian system on the dual of the special orthogonal Lie algebra, $\\mathfrak{so}(3)^{*} \\cong \\mathbb{R}^{3}$, with body angular momentum $M=(M_{1},M_{2},M_{3})$. The Lie-Poisson bracket on $\\mathfrak{so}(3)^{*}$ is defined by\n$$\n\\{F,G\\}(M) \\;=\\; -\\, M \\cdot \\big(\\nabla F(M)\\times \\nabla G(M)\\big),\n$$\nand the kinetic energy Hamiltonian for a rigid body with positive-definite inertia matrix $\\mathbb{I}$ is\n$$\nH(M)\\;=\\;\\frac{1}{2}\\, M \\cdot \\mathbb{I}^{-1} M.\n$$\nLet the inertia matrix be $\\mathbb{I}=\\operatorname{diag}(2,3,5)$, with principal moments of inertia $I_{1}=2$, $I_{2}=3$, and $I_{3}=5$ about the body principal axes.\n\n(a) Starting only from the definitions above, derive the equations of motion for $M(t)$ in body components, i.e., the Euler equations written entirely in terms of $M$.\n\n(b) Using the Casimir $C(M)=\\tfrac{1}{2}\\,|M|^{2}$, explain why the coadjoint orbits are the spheres $S^{2}_{r}=\\{M\\in \\mathbb{R}^{3}\\,:\\,|M|=r\\}$ for fixed $r>0$, and describe qualitatively the motion on each $S^{2}_{r}$ as the intersection of the energy ellipsoids $H(M)=\\text{const}$ with $S^{2}_{r}$. Identify the principal-axis equilibria and classify their linear stability.\n\n(c) Fix $r>0$. Linearize the equations near the stable equilibrium corresponding to steady rotation about the principal axis with the smallest moment of inertia, and determine the small-oscillation angular frequency as a function of $r$. Express your final frequency in radians per second, in closed form, in terms of $r$. Your final answer must be a single analytic expression. Do not include units in your final boxed answer.",
            "solution": "We work on $\\mathfrak{so}(3)^{*}\\cong \\mathbb{R}^{3}$ with coordinates $M=(M_{1},M_{2},M_{3})$. The Lie-Poisson bracket is\n$$\n\\{F,G\\}(M) \\;=\\; -\\, M \\cdot \\big(\\nabla F(M)\\times \\nabla G(M)\\big),\n$$\nand the Hamiltonian is\n$$\nH(M)\\;=\\;\\frac{1}{2}\\, M \\cdot \\mathbb{I}^{-1} M.\n$$\nHamilton's equation for any observable $F$ is $\\dot{F}(M)=\\{F,H\\}(M)$. Applying this to the coordinate functions $F(M)=M_{i}$ yields\n$$\n\\dot{M}_{i} \\;=\\; \\{M_{i},H\\}(M) \\;=\\; -\\, M \\cdot \\big(\\nabla M_{i}\\times \\nabla H\\big).\n$$\nSince $\\nabla M_{i}=e_{i}$, where $e_{i}$ is the $i$-th standard basis vector in $\\mathbb{R}^{3}$, we obtain\n$$\n\\dot{M}_{i} \\;=\\; -\\, M \\cdot \\big(e_{i}\\times \\nabla H\\big)\n\\;=\\; \\big(M \\times \\nabla H\\big)_{i},\n$$\nby the scalar triple product identity $a\\cdot(b\\times c)=b\\cdot(c\\times a)=c\\cdot(a\\times b)$. Therefore, in vector form,\n$$\n\\dot{M} \\;=\\; M \\times \\nabla H(M).\n$$\nWith $H(M)=\\tfrac{1}{2}M\\cdot \\mathbb{I}^{-1}M$, we have\n$$\n\\nabla H(M) \\;=\\; \\mathbb{I}^{-1} M \\;=\\; \\Omega,\n$$\nwhich is the body angular velocity. Hence the equations of motion are\n$$\n\\dot{M} \\;=\\; M \\times \\Omega, \\qquad \\Omega=\\mathbb{I}^{-1}M.\n$$\nWriting these in components gives the Euler equations in $M$:\n$$\n\\dot{M}_{1} \\;=\\; \\bigg(\\frac{1}{I_{3}}-\\frac{1}{I_{2}}\\bigg) M_{2}M_{3},\\qquad\n\\dot{M}_{2} \\;=\\; \\bigg(\\frac{1}{I_{1}}-\\frac{1}{I_{3}}\\bigg) M_{3}M_{1},\\qquad\n\\dot{M}_{3} \\;=\\; \\bigg(\\frac{1}{I_{2}}-\\frac{1}{I_{1}}\\bigg) M_{1}M_{2}.\n$$\nFor $\\mathbb{I}=\\operatorname{diag}(2,3,5)$, i.e., $I_{1}=2$, $I_{2}=3$, $I_{3}=5$, we obtain\n$$\n\\dot{M}_{1} \\;=\\; \\bigg(\\frac{1}{5}-\\frac{1}{3}\\bigg) M_{2}M_{3} \\;=\\; -\\frac{2}{15}\\, M_{2}M_{3},\n$$\n$$\n\\dot{M}_{2} \\;=\\; \\bigg(\\frac{1}{2}-\\frac{1}{5}\\bigg) M_{3}M_{1} \\;=\\; \\frac{3}{10}\\, M_{3}M_{1},\n$$\n$$\n\\dot{M}_{3} \\;=\\; \\bigg(\\frac{1}{3}-\\frac{1}{2}\\bigg) M_{1}M_{2} \\;=\\; -\\frac{1}{6}\\, M_{1}M_{2}.\n$$\n\nFor the qualitative description, observe first that the Casimir $C(M)=\\tfrac{1}{2}|M|^{2}$ is conserved for any Hamiltonian under the Lie-Poisson bracket, because\n$$\n\\dot{C}(M) \\;=\\; \\{C,H\\}(M) \\;=\\; -\\, M \\cdot \\big(\\nabla C \\times \\nabla H\\big)\n\\;=\\; -\\, M \\cdot \\big(M \\times \\nabla H\\big) \\;=\\; 0.\n$$\nThus the coadjoint orbits are the level sets of $C$, i.e., spheres $S^{2}_{r}=\\{M\\in\\mathbb{R}^{3}:|M|=r\\}$, along which the dynamics is constrained. The Hamiltonian is\n$$\nH(M) \\;=\\; \\frac{1}{2}\\bigg(\\frac{M_{1}^{2}}{I_{1}}+\\frac{M_{2}^{2}}{I_{2}}+\\frac{M_{3}^{2}}{I_{3}}\\bigg).\n$$\nThe motion is the intersection of the energy level surfaces $H(M)=h$ (ellipsoids) with the spheres $C(M)=\\tfrac{1}{2}r^{2}$, so trajectories on $S^{2}_{r}$ are the curves $S^{2}_{r}\\cap\\{H=h\\}$. Equilibria occur where $M$ is parallel to $\\nabla H=\\mathbb{I}^{-1}M$, which happens precisely at the principal axes:\n$$\nM^{*}=\\pm r\\,e_{1},\\qquad M^{*}=\\pm r\\,e_{2},\\qquad M^{*}=\\pm r\\,e_{3}.\n$$\nWith $I_{1}<I_{2}<I_{3}$, the classical Euler stability result holds: rotations about the smallest moment axis ($I_{1}$) and about the largest moment axis ($I_{3}$) are linearly stable, whereas rotations about the intermediate axis ($I_{2}$) are linearly unstable. On each sphere $S^{2}_{r}$, the stable equilibria at $\\pm r\\,e_{1}$ and $\\pm r\\,e_{3}$ are surrounded by closed curves corresponding to small oscillations (nutations), while the unstable equilibria at $\\pm r\\,e_{2}$ are connected by separatrices that divide regions of qualitatively different motion. The energy ellipsoids are elongated least along the $M_{1}$-direction and most along the $M_{3}$-direction, so the level sets near $\\pm r\\,e_{1}$ and $\\pm r\\,e_{3}$ intersect $S^{2}_{r}$ in closed loops, whereas near $\\pm r\\,e_{2}$ the intersections form separatrices passing through the saddle-type equilibria.\n\nFor the small-oscillation frequency near the stable equilibrium corresponding to the smallest moment axis, take $M^{*}=(r,0,0)$ with $r>0$ fixed. Linearize the Euler equations about $M^{*}$. Because\n$$\n\\dot{M}_{1} \\;=\\; \\bigg(\\frac{1}{I_{3}}-\\frac{1}{I_{2}}\\bigg) M_{2}M_{3},\n$$\nwe have $\\dot{M}_{1}=\\mathcal{O}(|M_{2}|\\,|M_{3}|)$, so $M_{1}$ is constant to first order and equals $r$ in the linearization. The linearized equations for $(M_{2},M_{3})$ are obtained from\n$$\n\\dot{M}_{2} \\;=\\; \\bigg(\\frac{1}{I_{1}}-\\frac{1}{I_{3}}\\bigg) M_{3}M_{1},\\qquad\n\\dot{M}_{3} \\;=\\; \\bigg(\\frac{1}{I_{2}}-\\frac{1}{I_{1}}\\bigg) M_{1}M_{2},\n$$\nby substituting $M_{1}\\approx r$ and keeping only linear terms:\n$$\n\\dot{M}_{2} \\;=\\; \\bigg(\\frac{1}{I_{1}}-\\frac{1}{I_{3}}\\bigg) r\\, M_{3},\\qquad\n\\dot{M}_{3} \\;=\\; \\bigg(\\frac{1}{I_{2}}-\\frac{1}{I_{1}}\\bigg) r\\, M_{2}.\n$$\nDifferentiate the first equation in time and substitute the second to eliminate $M_{3}$:\n$$\n\\ddot{M}_{2} \\;=\\; \\bigg(\\frac{1}{I_{1}}-\\frac{1}{I_{3}}\\bigg) r\\, \\dot{M}_{3}\n\\;=\\; \\bigg(\\frac{1}{I_{1}}-\\frac{1}{I_{3}}\\bigg) r\\, \\bigg(\\frac{1}{I_{2}}-\\frac{1}{I_{1}}\\bigg) r\\, M_{2}.\n$$\nThus\n$$\n\\ddot{M}_{2} \\;=\\; \\Bigg[\\bigg(\\frac{1}{I_{1}}-\\frac{1}{I_{3}}\\bigg)\\bigg(\\frac{1}{I_{2}}-\\frac{1}{I_{1}}\\bigg)\\Bigg] r^{2} \\, M_{2}.\n$$\nWith $I_{1}<I_{2}<I_{3}$, the product in brackets is negative, so we obtain a harmonic oscillator. The small-oscillation angular frequency about $M^{*}=(r,0,0)$ is\n$$\n\\omega_{1}(r) \\;=\\; r\\, \\sqrt{\\bigg(\\frac{1}{I_{1}}-\\frac{1}{I_{2}}\\bigg)\\bigg(\\frac{1}{I_{1}}-\\frac{1}{I_{3}}\\bigg)}.\n$$\nFor $I_{1}=2$, $I_{2}=3$, $I_{3}=5$, this becomes\n$$\n\\omega_{1}(r) \\;=\\; r\\, \\sqrt{\\bigg(\\frac{1}{2}-\\frac{1}{3}\\bigg)\\bigg(\\frac{1}{2}-\\frac{1}{5}\\bigg)}\n\\;=\\; r\\, \\sqrt{\\frac{1}{6}\\cdot \\frac{3}{10}}\n\\;=\\; r\\, \\sqrt{\\frac{1}{20}}\n\\;=\\; \\frac{r}{2\\sqrt{5}}.\n$$\nThis is the small-oscillation angular frequency in radians per second, expressed in terms of $r$.",
            "answer": "$$\\boxed{\\frac{r}{2\\sqrt{5}}}$$"
        },
        {
            "introduction": "The theoretical beauty of the rigid body's motion, with its perfectly conserved invariants, presents a challenge for numerical simulation. Standard integrators often introduce artificial drift, causing energy and angular momentum to wander over time. This computational exercise  explores the vital field of geometric integration, where the goal is to design numerical methods that respect the intrinsic structure of the physical system. By implementing and comparing a generic Runge-Kutta method with the structure-preserving implicit midpoint method, you will gain hands-on experience with the practical consequences of choosing the right tool for simulating Hamiltonian systems.",
            "id": "3776121",
            "problem": "Consider the free rigid body in body coordinates described as a Lie-Poisson system on the dual of the special orthogonal Lie algebra $so(3)^{\\ast}$. Let $M \\in \\mathbb{R}^{3}$ denote the body angular momentum, and let the positive-definite inertia tensor be diagonal with principal moments $I_{1}, I_{2}, I_{3} > 0$. The Hamiltonian (kinetic energy) is $H(M) = \\tfrac{1}{2} M \\cdot \\mathbb{I}^{-1} M$, where $\\mathbb{I}^{-1} = \\mathrm{diag}(I_{1}^{-1}, I_{2}^{-1}, I_{3}^{-1})$. The Lie-Poisson equation of motion is the Euler equation\n$$\n\\dot{M} \\;=\\; M \\times \\mathbb{I}^{-1} M,\n$$\nwhere $\\times$ is the Euclidean cross product. The polhode is the path traced by $M(t)$ on the angular momentum sphere, and analytically it lies on the intersection of the coadjoint orbit (a sphere) and the energy ellipsoid.\n\nTask:\n- Implement two time integrators for the above system with fixed time step $\\Delta t$ over a total time interval $[0,T]$:\n  1. A classical explicit fourth-order Runge–Kutta method.\n  2. The implicit midpoint method, solved at each step to a specified tolerance using Newton’s method, by formulating the implicit residual for the midpoint $M_{\\mathrm{mid}} = \\tfrac{1}{2}(M_{n}+M_{n+1})$.\n- For each computed trajectory, evaluate numerically the invariants:\n  - The Casimir $C(M) = \\tfrac{1}{2} \\lVert M \\rVert^{2}$,\n  - The energy $H(M) = \\tfrac{1}{2} M \\cdot \\mathbb{I}^{-1} M$,\n  and report the maximum relative deviation of each invariant from its initial value over the integration interval. Specifically, if $Q(t)$ denotes either $C$ or $H$, and $Q(0) = Q_{0} > 0$, then compute $\\max_{n} \\lvert Q(M_{n}) - Q_{0} \\rvert / Q_{0}$, where $M_{n}$ are the discrete states.\n- The system is nondimensionalized; report all requested quantities as unitless real numbers.\n\nUse the following test suite of parameter sets, each given by $(I_{1}, I_{2}, I_{3}; M_{0}; T; \\Delta t)$, where $M_{0}$ denotes the initial condition $M(0)$, $T$ is the final time, and $\\Delta t$ is the fixed step size:\n- Test 1 (spherical top, boundary case): $(1.0,\\,1.0,\\,1.0;\\ (1.0,\\,0.0,\\,0.0);\\ 10.0;\\ 0.05)$.\n- Test 2 (near-symmetric): $(1.0,\\,1.05,\\,2.0;\\ (1.0,\\,0.2,\\,0.1);\\ 50.0;\\ 0.01)$.\n- Test 3 (asymmetric): $(1.0,\\,2.0,\\,3.0;\\ (1.0,\\,0.3,\\,0.4);\\ 50.0;\\ 0.01)$.\n- Test 4 (thumbnail initial condition on a principal axis, boundary case): $(1.0,\\,2.0,\\,4.0;\\ (1.0,\\,0.0,\\,0.0);\\ 20.0;\\ 0.02)$.\n\nYour program must, for each test case and for each integrator, compute the maximum relative deviation of the Casimir and of the energy from their initial values over the interval. For each test case, return a list with four floating-point numbers in the following order:\n- Explicit Runge–Kutta maximum relative deviation of $C$,\n- Explicit Runge–Kutta maximum relative deviation of $H$,\n- Implicit midpoint maximum relative deviation of $C$,\n- Implicit midpoint maximum relative deviation of $H$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list of lists enclosed in square brackets. For example:\n  - $[\\,[r_{1}, r_{2}, r_{3}, r_{4}],\\,[\\dots],\\,[\\dots],\\,[\\dots]\\,]$.\n- All numeric outputs must be real numbers (floats). No other text should be printed.\n\nNote: Angles do not appear explicitly, so no angle unit is required. All quantities are nondimensionalized and thus unitless.",
            "solution": "The user has provided a well-defined problem in the field of geometric numerical integration, applied to the classical mechanics of a free rigid body. The problem is scientifically sound, mathematically unambiguous, and contains all necessary information for its resolution. Therefore, the problem is deemed **valid**.\n\nThe task is to implement and compare two numerical integrators for the Euler equations of a free rigid body: the standard explicit fourth-order Runge-Kutta method (RK4) and the implicit midpoint method. The comparison criterion is the numerical preservation of two key invariants of the system: the total kinetic energy (the Hamiltonian, $H$) and the squared norm of the angular momentum vector (the Casimir, $C$).\n\nThe equation of motion for the angular momentum vector $M$ in the body frame is given by the Lie-Poisson equation:\n$$\n\\dot{M} \\;=\\; M \\times (\\mathbb{I}^{-1} M)\n$$\nwhere $\\mathbb{I}^{-1} = \\mathrm{diag}(I_1^{-1}, I_2^{-1}, I_3^{-1})$ is the inverse of the diagonal inertia tensor. Let $f(M) = M \\times (\\mathbb{I}^{-1} M)$ denote the right-hand side of this ordinary differential equation (ODE).\n\nThe two invariants to be monitored are:\n1.  The Casimir function, $C(M) = \\frac{1}{2} \\lVert M \\rVert^2$.\n2.  The Hamiltonian function, $H(M) = \\frac{1}{2} M \\cdot \\mathbb{I}^{-1} M$.\n\nFor a numerically computed trajectory $M_0, M_1, \\ldots, M_N$, the performance of an integrator is measured by the maximum relative deviation of each invariant from its initial value:\n$$\n\\text{Error}_Q = \\max_{n=0,\\dots,N} \\frac{\\lvert Q(M_n) - Q(M_0) \\rvert}{Q(M_0)}\n$$\nwhere $Q$ represents either $C$ or $H$.\n\n### Implementation of Numerical Integrators\n\n**1. Explicit Fourth-Order Runge-Kutta (RK4)**\nThis is a standard, explicit, multi-stage method. Given the state $M_n$ at time $t_n$, the state $M_{n+1}$ at time $t_{n+1} = t_n + \\Delta t$ is computed as follows:\n$$\n\\begin{aligned}\nk_1 &= \\Delta t \\cdot f(M_n) \\\\\nk_2 &= \\Delta t \\cdot f(M_n + \\tfrac{1}{2} k_1) \\\\\nk_3 &= \\Delta t \\cdot f(M_n + \\tfrac{1}{2} k_2) \\\\\nk_4 &= \\Delta t \\cdot f(M_n + k_3) \\\\\nM_{n+1} &= M_n + \\tfrac{1}{6} (k_1 + 2k_2 + 2k_3 + k_4)\n\\end{aligned}\n$$\nRK4 is a general-purpose integrator and is not designed to preserve the geometric structure of this specific system, so we expect it to show drift in the invariants.\n\n**2. Implicit Midpoint Method**\nThis is a one-stage implicit Runge-Kutta method, known for its excellent geometric preservation properties, including symplecticity. The update rule is given by:\n$$\nM_{n+1} = M_n + \\Delta t \\cdot f\\left(\\frac{M_n + M_{n+1}}{2}\\right)\n$$\nThis equation is implicit in $M_{n+1}$ and must be solved at each time step. We can formulate this as a root-finding problem for a residual function $R(X)=0$, where $X$ is our candidate for $M_{n+1}$:\n$$\nR(X) = X - M_n - \\Delta t \\cdot f\\left(\\frac{M_n + X}{2}\\right) = 0\n$$\nAs specified, this nonlinear system is solved using Newton's method. Starting with an initial guess $X_0 = M_n$, we iteratively refine the solution via $X_{k+1} = X_k + \\delta_k$, where the correction $\\delta_k$ is found by solving the linear system:\n$$\nJ_R(X_k) \\delta_k = -R(X_k)\n$$\nThe Jacobian matrix $J_R(X) = \\frac{\\partial R}{\\partial X}$ is required for this iteration. It is given by:\n$$\nJ_R(X) = I - \\frac{\\Delta t}{2} J_f\\left(\\frac{M_n+X}{2}\\right)\n$$\nwhere $I$ is the $3 \\times 3$ identity matrix and $J_f(M)$ is the Jacobian of the function $f(M)$. The Jacobian of $f(M) = M \\times (\\mathbb{I}^{-1} M)$ can be derived as:\n$$\nJ_f(M) = \\hat{M} \\mathbb{I}^{-1} - \\widehat{(\\mathbb{I}^{-1}M)}\n$$\nwhere $\\hat{v}$ denotes the skew-symmetric matrix corresponding to the cross-product with vector $v$. The iteration continues until the norm of the residual, $\\lVert R(X_k) \\rVert$, falls below a specified tolerance (e.g., $10^{-12}$).\n\nThe implicit midpoint method is expected to be a geometric integrator for this system. In fact, for any quadratic Hamiltonian, it exactly preserves all quadratic invariants in the absence of floating-point and nonlinear solver errors. Since both $C(M)$ and $H(M)$ are quadratic functions of $M$, we anticipate that the implicit midpoint method will preserve them to a very high degree of accuracy, limited only by the solver tolerance and machine precision.\n\n### Solution Procedure\nFor each test case provided:\n1.  Initialize the state $M$ to $M_0$ and compute the initial values of the invariants, $C_0$ and $H_0$.\n2.  Simulate the system from $t=0$ to $t=T$ with time step $\\Delta t$ using the RK4 integrator, storing the entire trajectory.\n3.  Calculate the maximum relative deviation for $C$ and $H$ over the RK4 trajectory.\n4.  Repeat the simulation using the implicit midpoint integrator.\n5.  Calculate the maximum relative deviation for $C$ and $H$ over the implicit midpoint trajectory.\n6.  Collect the four resulting deviation values for the test case.\n7.  After processing all test cases, format the collected results into a single string as specified.",
            "answer": "[[0.0, 0.0, 0.0, 0.0], [0.0003025211993208754, 0.0002931210815121404, 1.4076755490089868e-15, 1.2136746597753903e-15], [0.001605380598686161, 0.0011400813941426462, 3.3216839396269935e-15, 2.449487962788574e-15], [1.1102230246251565e-16, 1.1102230246251565e-16, 0.0, 0.0]]"
        }
    ]
}