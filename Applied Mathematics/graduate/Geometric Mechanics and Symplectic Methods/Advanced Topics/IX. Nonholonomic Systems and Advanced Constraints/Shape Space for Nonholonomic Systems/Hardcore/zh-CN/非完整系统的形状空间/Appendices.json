{
    "hands_on_practices": [
        {
            "introduction": "在分析非完整系统时，首要步骤是精确描述系统允许的瞬时速度。本练习提供了一个具体的例子，展示了如何将普法夫（Pfaffian）约束方程转化为一个几何对象——约束分布——并利用基础线性代数确定其维度。这是所有后续分析的基础。",
            "id": "3766099",
            "problem": "考虑一个非完整运动系统，其模型建立在位形流形 $Q=\\mathrm{SE}(2)\\times \\mathbb{R}^{2}$ 上，其中 $\\mathrm{SE}(2)$ 表示二维特殊欧几里得群。在 $Q$ 上使用局部坐标 $(x,y,\\theta,s_{1},s_{2})$，其中 $(x,y)\\in\\mathbb{R}^{2}$ 是平面位置坐标，$\\theta\\in\\mathbb{R}$ 是以弧度为单位的方向角，$(s_{1},s_{2})\\in\\mathbb{R}^{2}$ 是内部形状变量。\n\n假设该系统受到以下理想化的非完整约束，这些约束由普法夫 (Pfaffian) $1$-形式给出：\n$$\n\\omega^{1}=-\\sin(\\theta)\\,dx+\\cos(\\theta)\\,dy,\n\\qquad\n\\omega^{2}=d\\theta - s_{1}\\,ds_{1}- 2 s_{2}\\,ds_{2}.\n$$\n这些约束定义了约束分布\n$$\n\\mathcal{D}(q)=\\{v\\in T_{q}Q\\mid \\omega^{\\alpha}(v)=0 \\text{ for }\\alpha=1,2\\},\n$$\n它可以被解释为在主丛 $Q=\\mathrm{SE}(2)\\times M$ 中，形状空间 $M=\\mathbb{R}^{2}$ 上的一个非完整联络的水平分布。\n\n从约束分布是约束 $1$-形式的公共核这一定义出发，推导 $\\mathcal{D}(q)$ 的一个坐标实现，即它是一个作用于速度坐标的系数矩阵的零空间。然后，利用线性代数的基本原理，验证约束 $1$-形式的秩，并推导出在特定位形\n$$\nq^{\\ast}=(x^{\\ast},y^{\\ast},\\theta^{\\ast},s_{1}^{\\ast},s_{2}^{\\ast})=(0,1,\\tfrac{\\pi}{4},1,-1)\n$$\n下 $\\mathcal{D}(q)$ 的秩。\n\n你的最终答案必须是 $\\mathcal{D}(q^{\\ast})$ 的秩，表示为一个无单位的整数。",
            "solution": "该问题在几何力学领域内提法明确且具有科学依据。我们可以开始求解。\n\n系统的位形流形是 $Q=\\mathrm{SE}(2)\\times \\mathbb{R}^{2}$，这是一个 $5$ 维流形。局部坐标由 $q = (x, y, \\theta, s_{1}, s_{2})$ 给出。在点 $q \\in Q$ 的一个切向量 $v \\in T_{q}Q$ 可以在这些坐标中用其速度分量表示，我们将其记为列向量 $\\dot{q}$：\n$$\n\\dot{q} = \\begin{pmatrix} \\dot{x} \\\\ \\dot{y} \\\\ \\dot{\\theta} \\\\ \\dot{s}_{1} \\\\ \\dot{s}_{2} \\end{pmatrix} \\in \\mathbb{R}^{5}\n$$\n该系统受到两个非完整约束，由普法夫 $1$-形式给出：\n$$\n\\begin{align*}\n\\omega^{1} = -\\sin(\\theta)\\,dx+\\cos(\\theta)\\,dy \\\\\n\\omega^{2} = d\\theta - s_{1}\\,ds_{1} - 2s_{2}\\,ds_{2}\n\\end{align*}\n$$\n约束分布 $\\mathcal{D}(q)$ 被定义为所有被两个约束形式都零化的切向量 $v \\in T_{q}Q$ 的集合。也就是说，$v \\in \\mathcal{D}(q)$ 当且仅当 $\\omega^{1}(v)=0$ 且 $\\omega^{2}(v)=0$。将这些 $1$-形式应用于具有速度分量 $\\dot{q}$ 的切向量，可以得到一个关于这些分量的两个线性方程组：\n$$\n\\begin{align*}\n\\omega^{1}(v) = -\\sin(\\theta)\\dot{x} + \\cos(\\theta)\\dot{y} + 0\\cdot\\dot{\\theta} + 0\\cdot\\dot{s}_{1} + 0\\cdot\\dot{s}_{2} = 0 \\\\\n\\omega^{2}(v) = 0\\cdot\\dot{x} + 0\\cdot\\dot{y} + 1\\cdot\\dot{\\theta} - s_{1}\\dot{s}_{1} - 2s_{2}\\dot{s}_{2} = 0\n\\end{align*}\n$$\n这个方程组可以写成矩阵形式 $A(q)\\dot{q}=0$，其中 $A(q)$ 是从 $1$-形式在坐标基 $\\{dx, dy, d\\theta, ds_{1}, ds_{2}\\}$ 下的系数导出的系数矩阵。这提供了 $\\mathcal{D}(q)$ 作为 $A(q)$ 的零空间（或核）的坐标实现：\n$$\nA(q) = \\begin{pmatrix}\n-\\sin(\\theta) & \\cos(\\theta) & 0 & 0 & 0 \\\\\n0 & 0 & 1 & -s_{1} & -2s_{2}\n\\end{pmatrix}\n$$\n分布 $\\mathcal{D}(q)$ 正是这个 $2 \\times 5$ 矩阵的零空间：$\\mathcal{D}(q) = \\ker(A(q))$。\n\n下一步是确定约束 $1$-形式集合的秩，这等价于矩阵 $A(q)$ 的秩。矩阵的秩是线性无关的行（或列）的数量。$A(q)$ 的两个行向量是：\n$$\n\\begin{align*}\n\\mathbf{r}_1 = \\begin{pmatrix} -\\sin(\\theta) & \\cos(\\theta) & 0 & 0 & 0 \\end{pmatrix} \\\\\n\\mathbf{r}_2 = \\begin{pmatrix} 0 & 0 & 1 & -s_{1} & -2s_{2} \\end{pmatrix}\n\\end{align*}\n$$\n要使这两个向量线性相关，其中一个必须是另一个的标量倍。我们假设对于某个标量 $c \\in \\mathbb{R}$，有 $\\mathbf{r}_2 = c \\cdot \\mathbf{r}_1$。比较第三个分量，我们得到 $1 = c \\cdot 0$，这是一个矛盾。因此，$\\mathbf{r}_2$ 不可能是 $\\mathbf{r}_1$ 的倍数。同样，假设 $\\mathbf{r}_1 = c \\cdot \\mathbf{r}_2$ 也会导致矛盾，因为 $\\sin(\\theta)$ 和 $\\cos(\\theta)$ 不能同时为零，而 $\\mathbf{r}_2$ 的前两个分量都为零。因此，对于所有 $q \\in Q$，这两个行向量都是线性无关的。\n这验证了约束 $1$-形式集合的秩，即 $\\mathrm{rank}(A(q))$，对于任何位形 $q$（包括特定位形 $q^{\\ast}$）都为 $2$。\n\n分布 $\\mathcal{D}(q)$ 的秩是它作为切空间 $T_q Q$ 的向量子空间的维数。根据线性代数中的秩-零度定理，对于由 $A(q):T_q Q \\to \\mathbb{R}^2$ 表示的线性映射，我们有：\n$$\n\\dim(T_q Q) = \\mathrm{rank}(A(q)) + \\mathrm{nullity}(A(q))\n$$\n这里，$\\dim(T_q Q) = \\dim(Q) = 5$，$\\mathrm{rank}(A(q))$ 是矩阵 $A(q)$ 的秩，而 $\\mathrm{nullity}(A(q))$ 是零空间的维数，根据定义，它就是分布 $\\mathcal{D}(q)$ 的秩。\n$$\n\\mathrm{rank}(\\mathcal{D}(q)) = \\dim(\\ker(A(q))) = \\mathrm{nullity}(A(q))\n$$\n重新整理秩-零度定理，我们得到：\n$$\n\\mathrm{rank}(\\mathcal{D}(q)) = \\dim(Q) - \\mathrm{rank}(A(q))\n$$\n我们已经确定了对于所有的 $q$，都有 $\\mathrm{rank}(A(q)) = 2$。因此，分布的秩在整个位形空间中是恒定的：\n$$\n\\mathrm{rank}(\\mathcal{D}(q)) = 5 - 2 = 3\n$$\n这个结果与具体位形无关。因此，对于给定的点 $q^{\\ast}=(0,1,\\tfrac{\\pi}{4},1,-1)$，分布 $\\mathcal{D}(q^{\\ast})$ 的秩也是 $3$。\n\n为完整起见，我们在 $q^{\\ast}$ 处计算矩阵 $A(q)$ 的值：\n$$\nq^{\\ast} = (x^{\\ast},y^{\\ast},\\theta^{\\ast},s_{1}^{\\ast},s_{2}^{\\ast}) = (0, 1, \\tfrac{\\pi}{4}, 1, -1)\n$$\n在该点，$\\sin(\\theta^{\\ast}) = \\frac{\\sqrt{2}}{2}$ 且 $\\cos(\\theta^{\\ast}) = \\frac{\\sqrt{2}}{2}$。矩阵变为：\n$$\nA(q^{\\ast}) = \\begin{pmatrix}\n-\\frac{\\sqrt{2}}{2} & \\frac{\\sqrt{2}}{2} & 0 & 0 & 0 \\\\\n0 & 0 & 1 & -1 & 2\n\\end{pmatrix}\n$$\n正如预期的那样，这两个行向量是线性无关的，该矩阵的秩为 $2$。应用该公式：\n$$\n\\mathrm{rank}(\\mathcal{D}(q^{\\ast})) = \\dim(Q) - \\mathrm{rank}(A(q^{\\ast})) = 5 - 2 = 3\n$$\n在指定位形 $q^{\\ast}$ 处，约束分布 $\\mathcal{D}(q)$ 的秩为 $3$。",
            "answer": "$$\n\\boxed{3}\n$$"
        },
        {
            "introduction": "定义了允许的运动之后，下一步是推导运动方程。本练习演示了一种强大的技术——查普雷金约化（Chaplygin reduction），其中非完整联络被用来从拉格朗日量中消除未驱动的群变量。最终得到一个仅在形状空间上描述动力学的简化“压缩”拉格朗日量。",
            "id": "3766150",
            "problem": "考虑一个力学 Chaplygin 系统，其位形流形为 $Q = G \\times S$，其中 $G$ 是特殊正交群 $\\mathrm{SO}(2)$，自由且正常地作用于 $Q$，$S = \\mathbb{R}^{2}$ 是形状空间，坐标为 $s = (x,y)$。该系统具有一个 $\\mathrm{SO}(2)$-不变的黎曼度量，其在体坐标 $(\\xi,\\dot{s}) \\in \\mathbb{R} \\times \\mathbb{R}^{2}$（其中 $\\xi \\in \\mathfrak{so}(2) \\cong \\mathbb{R}$ 为群速度，$\\dot{s} = (\\dot{x},\\dot{y})$）下的块形式给出了拉格朗日量\n$$\nL(s,\\dot{s},\\xi) = \\frac{1}{2}\\,m(s)\\left(\\dot{x}^{2}+\\dot{y}^{2}\\right) + 2\\,\\xi\\,b(s)^{\\top}\\dot{s} + \\frac{1}{2}\\,J(s)\\,\\xi^{2} - V(s),\n$$\n其中 $m(s) = 1 + x^{2} + y^{2}$，$J(s) = 2 + x$，$b(s) = \\begin{pmatrix} y \\\\ x \\end{pmatrix}$，以及 $V(s) = x\\,y$。非完整约束分布 $\\mathcal{D} \\subset TQ$ 由一个线性速度约束定义，该约束通过非完整联络 $A^{\\mathrm{nh}}(s)$ 确定了水平子空间，此处由以下条件指定\n$$\n\\xi + a(s)^{\\top}\\dot{s} = 0, \\quad \\text{其中} \\quad a(s) = \\begin{pmatrix} x \\\\ 1 \\end{pmatrix}.\n$$\n这编码了非完整联络 $A^{\\mathrm{nh}}(s) = a(s)^{\\top}$，它将形状速度映射到受约束的群速度。假设 $x > -1$，从而 $J(s) > 1$ 且动能在群方向上保持正定。\n\n从力学拉格朗日量（动能减去势能）的基本定义、主丛约化，以及非完整联络在定义消除群速度的水平提升中的作用出发，通过使用约束 $\\xi = -a(s)^{\\top}\\dot{s}$ 来消去 $\\xi$，推导形状空间上的约化（压缩）拉格朗日量 $L_{c}(s,\\dot{s})$。请将您的最终答案表示为仅包含 $x$, $y$, $\\dot{x}$ 和 $\\dot{y}$ 的单个闭式解析表达式。无需四舍五入，也不涉及单位。",
            "solution": "在尝试任何解答之前，需对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 位形流形：$Q = G \\times S$，其中 $G = \\mathrm{SO}(2)$，$S = \\mathbb{R}^{2}$。\n- 形状空间坐标：$s = (x,y)$。\n- 群速度：$\\xi \\in \\mathfrak{so}(2) \\cong \\mathbb{R}$。\n- 形状空间速度：$\\dot{s} = (\\dot{x},\\dot{y})$。\n- $TQ$ 上的拉格朗日量：$L(s,\\dot{s},\\xi) = \\frac{1}{2}\\,m(s)\\left(\\dot{x}^{2}+\\dot{y}^{2}\\right) + 2\\,\\xi\\,b(s)^{\\top}\\dot{s} + \\frac{1}{2}\\,J(s)\\,\\xi^{2} - V(s)$。\n- 拉格朗日量分量：\n  - $m(s) = 1 + x^{2} + y^{2}$\n  - $J(s) = 2 + x$\n  - $b(s) = \\begin{pmatrix} y \\\\ x \\end{pmatrix}$\n  - $V(s) = x\\,y$\n- 非完整约束：$\\xi + a(s)^{\\top}\\dot{s} = 0$。\n- 约束分量：$a(s) = \\begin{pmatrix} x \\\\ 1 \\end{pmatrix}$。\n- 条件：$x > -1$。\n- 目标：推导形状空间上的约化（压缩）拉格朗日量 $L_{c}(s,\\dot{s})$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在几何力学的数学框架内是良定义的。它描述了一个 Chaplygin 系统，这是非完整动力学研究中的一个标准课题。\n- **科学依据：** 该设置是具有对称性和非完整约束的系统进行拉格朗日约化的教科书式范例。所有定义，包括拉格朗日结构和线性速度约束，都是该领域的标准。条件 $x > -1$ 确保了转动惯量 $J(s) = 2+x$ 是严格为正的 ($J(s) > 1$)，从而保证动能度量在群方向上是正定的，这是一个必要的物理和数学条件。\n- **良定性：** 该问题提供了执行所要求的推导所需的所有必要定义和函数（$m(s)$、$J(s)$、$b(s)$、$a(s)$、$V(s)$）。任务是使用给定的约束从表达式中消去一个变量，这是一个直接的代数过程，会得到唯一的解析解。\n- **目标：** 问题使用精确、无歧义的数学语言和符号进行陈述。没有主观或定性元素。\n\n### 步骤 3：结论与行动\n问题有效。这是一个几何力学中良定义的、有科学依据的练习。现在可以开始求解过程。\n\n#### 约化拉格朗日量的推导\n目标是推导约化拉格朗日量，或称压缩拉格朗日量，$L_{c}(s,\\dot{s})$，它描述了形状空间 $S = \\mathbb{R}^2$ 上的动力学。这是通过使用非完整约束从完整拉格朗日量 $L(s,\\dot{s},\\xi)$ 中消去群速度 $\\xi$ 来实现的。\n\n给定的完整拉格朗日量为：\n$$L(s,\\dot{s},\\xi) = \\frac{1}{2}\\,m(s)\\left(\\dot{x}^{2}+\\dot{y}^{2}\\right) + 2\\,\\xi\\,b(s)^{\\top}\\dot{s} + \\frac{1}{2}\\,J(s)\\,\\xi^{2} - V(s)$$\n非完整约束由以下线性方程给出：\n$$\\xi + a(s)^{\\top}\\dot{s} = 0$$\n由此约束，我们解出群速度 $\\xi$：\n$$\\xi = -a(s)^{\\top}\\dot{s}$$\n将 $\\xi$ 的这个表达式代入完整拉格朗日量 $L(s,\\dot{s},\\xi)$，即可得到压缩拉格朗日量 $L_c(s,\\dot{s})$：\n$$L_c(s,\\dot{s}) = L(s,\\dot{s},\\xi)\\rvert_{\\xi = -a(s)^{\\top}\\dot{s}}$$\n$$L_c(s,\\dot{s}) = \\frac{1}{2}\\,m(s)(\\dot{x}^{2}+\\dot{y}^{2}) + 2(-a(s)^{\\top}\\dot{s})b(s)^{\\top}\\dot{s} + \\frac{1}{2}\\,J(s)(-a(s)^{\\top}\\dot{s})^{2} - V(s)$$\n$$L_c(s,\\dot{s}) = \\frac{1}{2}\\,m(s)(\\dot{x}^{2}+\\dot{y}^{2}) - 2(a(s)^{\\top}\\dot{s})(b(s)^{\\top}\\dot{s}) + \\frac{1}{2}\\,J(s)(a(s)^{\\top}\\dot{s})^{2} - V(s)$$\n现在，我们必须计算涉及向量 $a(s)$、$b(s)$ 和形状速度 $\\dot{s} = \\begin{pmatrix} \\dot{x} \\\\ \\dot{y} \\end{pmatrix}$ 的标量积。\n给定的向量为 $a(s) = \\begin{pmatrix} x \\\\ 1 \\end{pmatrix}$ 和 $b(s) = \\begin{pmatrix} y \\\\ x \\end{pmatrix}$。\n标量积为：\n$$a(s)^{\\top}\\dot{s} = \\begin{pmatrix} x & 1 \\end{pmatrix} \\begin{pmatrix} \\dot{x} \\\\ \\dot{y} \\end{pmatrix} = x\\dot{x} + \\dot{y}$$\n$$b(s)^{\\top}\\dot{s} = \\begin{pmatrix} y & x \\end{pmatrix} \\begin{pmatrix} \\dot{x} \\\\ \\dot{y} \\end{pmatrix} = y\\dot{x} + x\\dot{y}$$\n将这些代入 $L_c(s,\\dot{s})$ 的表达式中：\n$$L_c(s,\\dot{s}) = \\frac{1}{2}\\,m(s)(\\dot{x}^{2}+\\dot{y}^{2}) - 2(x\\dot{x} + \\dot{y})(y\\dot{x} + x\\dot{y}) + \\frac{1}{2}\\,J(s)(x\\dot{x} + \\dot{y})^{2} - V(s)$$\n接下来，我们代入给定的函数 $m(s) = 1 + x^{2} + y^{2}$、$J(s) = 2 + x$ 和 $V(s) = x\\,y$：\n$$L_c(s,\\dot{s}) = \\frac{1}{2}(1 + x^{2} + y^{2})(\\dot{x}^{2}+\\dot{y}^{2}) - 2(x\\dot{x} + \\dot{y})(y\\dot{x} + x\\dot{y}) + \\frac{1}{2}(2 + x)(x\\dot{x} + \\dot{y})^{2} - x\\,y$$\n我们现在展开速度的二次项：\n第二项：\n$$ -2(x\\dot{x} + \\dot{y})(y\\dot{x} + x\\dot{y}) = -2(xy\\dot{x}^{2} + x^{2}\\dot{x}\\dot{y} + y\\dot{x}\\dot{y} + x\\dot{y}^{2}) = -2xy\\dot{x}^{2} - 2(x^{2}+y)\\dot{x}\\dot{y} - 2x\\dot{y}^{2} $$\n第三项：\n$$ \\frac{1}{2}(2 + x)(x\\dot{x} + \\dot{y})^{2} = \\frac{1}{2}(2 + x)(x^{2}\\dot{x}^{2} + 2x\\dot{x}\\dot{y} + \\dot{y}^{2}) = \\frac{1}{2}(2+x)x^{2}\\dot{x}^{2} + (2+x)x\\dot{x}\\dot{y} + \\frac{1}{2}(2+x)\\dot{y}^{2} $$\n现在我们将拉格朗日量的所有部分组合起来，并收集 $\\dot{x}^{2}$、$\\dot{y}^{2}$ 和 $\\dot{x}\\dot{y}$ 的系数。\n\n压缩拉格朗日量的总动能部分 $T_c(s, \\dot{s})$ 为：\n$$ T_c = \\bigg(\\frac{1}{2}(1 + x^{2} + y^{2}) - 2xy + \\frac{1}{2}(2+x)x^{2}\\bigg)\\dot{x}^{2} + \\bigg(\\frac{1}{2}(1 + x^{2} + y^{2}) - 2x + \\frac{1}{2}(2+x)\\bigg)\\dot{y}^{2} + \\big(-2(x^{2}+y) + (2+x)x\\big)\\dot{x}\\dot{y} $$\n我们来简化每个系数。\n\n$\\dot{x}^{2}$ 的系数：\n$$ \\frac{1}{2}(1 + x^{2} + y^{2}) - 2xy + \\frac{1}{2}(2x^{2} + x^{3}) = \\frac{1}{2} + \\frac{1}{2}x^{2} + \\frac{1}{2}y^{2} - 2xy + x^{2} + \\frac{1}{2}x^{3} = \\frac{1}{2}x^{3} + \\frac{3}{2}x^{2} - 2xy + \\frac{1}{2}y^{2} + \\frac{1}{2} $$\n$$ = \\frac{1}{2}(x^{3} + 3x^{2} - 4xy + y^{2} + 1) $$\n$\\dot{y}^{2}$ 的系数：\n$$ \\frac{1}{2}(1 + x^{2} + y^{2}) - 2x + \\frac{1}{2}(2+x) = \\frac{1}{2} + \\frac{1}{2}x^{2} + \\frac{1}{2}y^{2} - 2x + 1 + \\frac{1}{2}x = \\frac{1}{2}x^{2} - \\frac{3}{2}x + \\frac{1}{2}y^{2} + \\frac{3}{2} $$\n$$ = \\frac{1}{2}(x^{2} - 3x + y^{2} + 3) $$\n$\\dot{x}\\dot{y}$ 的系数：\n$$ -2(x^{2}+y) + (2+x)x = -2x^{2} - 2y + 2x + x^{2} = -x^{2} + 2x - 2y $$\n组合成完整的压缩拉格朗日量 $L_c = T_c - V$：\n$$ L_c(x,y,\\dot{x},\\dot{y}) = \\frac{1}{2}(x^{3} + 3x^{2} - 4xy + y^{2} + 1)\\dot{x}^{2} + \\frac{1}{2}(x^{2} - 3x + y^{2} + 3)\\dot{y}^{2} + (-x^{2} + 2x - 2y)\\dot{x}\\dot{y} - x\\,y $$\n这就是形状空间上压缩拉格朗日量的最终表达式。",
            "answer": "$$\n\\boxed{\\frac{1}{2}(x^{3} + 3x^{2} - 4xy + y^{2} + 1)\\dot{x}^{2} + \\frac{1}{2}(x^{2} - 3x + y^{2} + 3)\\dot{y}^{2} + (-x^{2} + 2x - 2y)\\dot{x}\\dot{y} - xy}\n$$"
        },
        {
            "introduction": "最后的练习探讨了与动力学约化相对应的运动学问题：重构问题。它展示了用于简化动力学的同一联络如何被用来积分形状空间上的运动，从而得到在完整位形空间中的轨迹。通过实现一个数值李群积分器，本练习将抽象的重构概念变得具体，并突显了曲率在通过周期性形状变化产生运动中的核心作用。",
            "id": "3766072",
            "problem": "考虑一个非完整力学系统，其模型建立在一个平凡主纤维丛 $Q = G \\times S$ 上，其中 $G = \\mathrm{SE}(2)$ 是平面刚体运动的特殊欧几里得群，而 $S = \\mathbb{R}^2$ 是形状空间。设 $g(t) \\in G$ 表示群位形，$s(t) \\in S$ 表示形状轨迹。运动学重构律通过一个主联络 $A$ 将体速度表示为形状速度的函数。此处的联络 $A$ 被理解为 $S$ 上的一个李代数值一形式，因此体速度由 $g^{-1}\\dot{g} = \\xi(t) = A(s(t)) \\dot{s}(t)$ 给出，其中 $\\xi(t) \\in \\mathfrak{se}(2)$。\n\n在本问题中，您将使用一个具有可调曲率大小、通过解析方式定义的、依赖于形状的特定联络。该联络通过其与形状速度分量 $\\dot{s}_1$ 和 $\\dot{s}_2$ 相关联的分量 $A_1(s)$ 和 $A_2(s)$ 定义如下：\n$$\nA_1(s) = \\begin{bmatrix} \\kappa\\, s_2 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\qquad\nA_2(s) = \\begin{bmatrix} -\\kappa\\, s_1 \\\\ 0 \\\\ 0 \\end{bmatrix},\n$$\n因此体扭量为\n$$\n\\xi(t) = \\begin{bmatrix} \\omega(t) \\\\ v_x(t) \\\\ v_y(t) \\end{bmatrix}\n= A_1(s(t))\\, \\dot{s}_1(t) + A_2(s(t))\\, \\dot{s}_2(t)\n= \\begin{bmatrix} \\kappa\\left(s_2(t)\\, \\dot{s}_1(t) - s_1(t)\\, \\dot{s}_2(t)\\right) \\\\ 0 \\\\ 0 \\end{bmatrix}.\n$$\n这里，$\\kappa \\in \\mathbb{R}$ 是一个控制曲率大小的标量参数。此联络在形状空间上的曲率二形式 $F$ 计算为 $F = \\partial_1 A_2 - \\partial_2 A_1 + [A_1, A_2]$，其大小为与 $\\kappa$ 成正比的常数；具体来说，其唯一的非零分量是角度部分 $F_{12}^\\omega = -2\\kappa$，这导致在李代数分量的欧几里得范数下，曲率大小为 $\\|F\\| = 2|\\kappa|$。\n\n给定一个形状轨迹 $s(t)$ 及其在固定时间区间 $[0,T]$（其中 $T=1$）上的导数 $\\dot{s}(t)$，定义\n$$\ns_1(t) = \\cos\\left(2\\pi t\\right) + 0.3\\, \\cos\\left(6\\pi t\\right), \\qquad\ns_2(t) = \\sin\\left(4\\pi t\\right),\n$$\n和\n$$\n\\dot{s}_1(t) = -2\\pi\\, \\sin\\left(2\\pi t\\right) - 1.8\\pi\\, \\sin\\left(6\\pi t\\right), \\qquad\n\\dot{s}_2(t) = 4\\pi\\, \\cos\\left(4\\pi t\\right).\n$$\n您必须使用离散化的联络和基于矩阵指数的李群积分器，从采样的形状速度中数值重构群轨迹 $g(t)$。具体来说，将区间 $[0,T]$ 离散化为 $N$ 个大小为 $\\Delta t = T/N$ 的均匀步长，在左端点 $t_k = k\\, \\Delta t$ 处对形状和形状速度进行采样，计算体扭量 $\\xi_k = \\xi(t_k)$，并使用一阶李群方法更新群元素\n$$\ng_{k+1} = g_k \\, \\exp\\left(\\Delta t\\, \\hat{\\xi}_k\\right),\n$$\n其中 $\\hat{\\xi}_k \\in \\mathfrak{se}(2)$ 是体扭量的矩阵表示，$\\exp$ 是矩阵指数。在这个特定的联络中，平移分量为零，因此重构简化为平面旋转，但您仍必须在 $G = \\mathrm{SE}(2)$ 上以齐次变换的形式实现更新。所有内部角度计算必须使用弧度。\n\n对于参考解 $g_{\\mathrm{ref}}(T)$，使用相同的重构方法，但采用非常精细的离散化 $N_{\\mathrm{ref}} = 50000$ 来近似连续时间解。将重构的终端群元素 $g_N(T)$ 与参考解之间的误差定义为其齐次变换矩阵之差的弗罗贝尼乌斯范数，\n$$\n\\mathcal{E} = \\left\\| g_N(T) - g_{\\mathrm{ref}}(T) \\right\\|_F,\n$$\n该范数是无量纲的。\n\n您的任务是：\n- 实现所述的重构方案。\n- 对于一组参数值 $(\\kappa, N)$，计算相对于参考解的终端误差 $\\mathcal{E}$。\n- 评估误差如何随着 $N$ 的增加而收敛，以及它如何随着由 $\\kappa$ 控制的曲率大小进行缩放。\n\n使用以下测试套件：\n- 曲率参数：$\\kappa \\in \\{0, 0.5, 1.0\\}$。\n- 时间步数：$N \\in \\{50, 200, 800\\}$。\n按 $\\kappa$ 然后按 $N$ 的字典序将它们组合，得到 9 个测试用例：\n$$\n(\\kappa,N) \\in \\{(0,50),(0,200),(0,800),(0.5,50),(0.5,200),(0.5,800),(1.0,50),(1.0,200),(1.0,800)\\}.\n$$\n\n您的程序应生成单行输出，其中包含所有测试用例的终端误差，形式为方括号括起来的逗号分隔列表（例如，$[e_1,e_2,\\dots,e_9]$）。每个 $e_i$ 必须是一个浮点数。程序必须完全自包含，无需任何输入，并且除了指定的输出行外，不得打印任何其他文本。",
            "solution": "该问题定义明确，在几何力学和李群上的数值积分领域有坚实的科学基础。它提供了一套完整且一致的定义、方程和参数来执行所要求的数值实验。所有数据都是明确的，该任务是计算几何控制理论中的一个标准练习。因此，该问题是有效的，并将提供一个解决方案。\n\n该问题要求基于在“形状空间”$S = \\mathbb{R}^2$ 中预设的路径，数值重构特殊欧几里得群 $\\mathrm{SE}(2)$ 上的轨迹。形状速度 $\\dot{s}(t)$ 与体速度 $\\xi(t)$ 之间的关系由一个运动学联络 $A(s)$ 定义。\n\n首先，我们形式化系统的各个组成部分。位形空间是 $Q = G \\times S$，其中李群为 $G = \\mathrm{SE}(2)$，形状空间为 $S = \\mathbb{R}^2$。一个元素 $g \\in \\mathrm{SE}(2)$ 由一个 $3 \\times 3$ 的齐次变换矩阵表示：\n$$\ng = \\begin{bmatrix} R(\\theta) & p \\\\ 0 & 1 \\end{bmatrix} = \\begin{bmatrix} \\cos\\theta & -\\sin\\theta & x \\\\ \\sin\\theta & \\cos\\theta & y \\\\ 0 & 0 & 1 \\end{bmatrix}\n$$\n其中 $R(\\theta) \\in \\mathrm{SO}(2)$ 是一个旋转矩阵，$p \\in \\mathbb{R}^2$ 是一个平移向量。\n\n体速度，或称扭量，$\\xi(t) = g(t)^{-1}\\dot{g}(t)$，位于李代数 $\\mathfrak{se}(2)$ 中。一个扭量 $\\xi = (\\omega, v_x, v_y)^T$ 具有矩阵表示 $\\hat{\\xi} \\in \\mathfrak{se}(2)$：\n$$\n\\hat{\\xi} = \\begin{bmatrix} 0 & -\\omega & v_x \\\\ \\omega & 0 & v_y \\\\ 0 & 0 & 0 \\end{bmatrix}\n$$\n重构律由 $\\xi(t) = A(s(t))\\dot{s}(t)$ 给出。使用所提供的联络分量 $A_1(s)$ 和 $A_2(s)$，扭量计算如下：\n$$\n\\xi(t) = A_1(s(t))\\dot{s}_1(t) + A_2(s(t))\\dot{s}_2(t) = \\begin{bmatrix} \\kappa\\, s_2(t) \\\\ 0 \\\\ 0 \\end{bmatrix} \\dot{s}_1(t) + \\begin{bmatrix} -\\kappa\\, s_1(t) \\\\ 0 \\\\ 0 \\end{bmatrix} \\dot{s}_2(t)\n$$\n这可以简化为：\n$$\n\\xi(t) = \\begin{bmatrix} \\omega(t) \\\\ v_x(t) \\\\ v_y(t) \\end{bmatrix} = \\begin{bmatrix} \\kappa (s_2(t)\\dot{s}_1(t) - s_1(t)\\dot{s}_2(t)) \\\\ 0 \\\\ 0 \\end{bmatrix}\n$$\n对于这个特定的联络，体速度的平移分量始终为零（$v_x = v_y = 0$）。系统的运动是围绕其自身原点的纯旋转。相应的李代数矩阵是：\n$$\n\\hat{\\xi}(t) = \\begin{bmatrix} 0 & -\\omega(t) & 0 \\\\ \\omega(t) & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}\n$$\n其中角速度 $\\omega(t)$ 由形状轨迹 $s(t) = (s_1(t), s_2(t))^T$ 及其速度 $\\dot{s}(t) = (\\dot{s}_1(t), \\dot{s}_2(t))^T$ 确定，如问题中所定义。\n\n问题要求使用一阶李群方法进行数值积分。时间区间 $[0, T]$（其中 $T=1$）被离散化为 $N$ 个步长为 $\\Delta t = T/N = 1/N$ 的时间步。在时间 $t_k = k \\Delta t$ 处的群元素 $g_k$ 通过以下规则更新到 $g_{k+1}$：\n$$\ng_{k+1} = g_k \\exp(\\Delta t \\hat{\\xi}_k)\n$$\n其中 $\\hat{\\xi}_k$ 是在时间步开始时评估的扭量 $\\xi(t_k)$ 的矩阵表示。我们假设初始条件是单位元，$g_0 = I$。项 $\\exp(\\Delta t \\hat{\\xi}_k)$ 是矩阵指数。对于我们的纯旋转扭量，令 $\\Delta \\theta_k = \\omega(t_k)\\Delta t$。需要进行指数运算的矩阵是：\n$$\n\\Delta t \\hat{\\xi}_k = \\begin{bmatrix} 0 & -\\Delta \\theta_k & 0 \\\\ \\Delta \\theta_k & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}\n$$\n该矩阵的指数可以使用适用于 $\\mathrm{SO}(2)$ 的罗德里格斯公式解析计算，得到：\n$$\n\\exp(\\Delta t \\hat{\\xi}_k) = \\begin{bmatrix} \\cos(\\Delta \\theta_k) & -\\sin(\\Delta \\theta_k) & 0 \\\\ \\sin(\\Delta \\theta_k) & \\cos(\\Delta \\theta_k) & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}\n$$\n该矩阵表示在时间步 $\\Delta t$ 内的增量群运动。通过将这些增量运动重复右乘到当前的群位形上，来重构轨迹。\n\n总体算法如下：\n1.  定义一个函数 `reconstruct_trajectory(kappa, N)` 来实现数值积分。该函数接受曲率参数 $\\kappa$ 和步数 $N$ 作为输入。\n2.  在此函数内部，设置 $T=1$，计算 $\\Delta t = T/N$，并生成时间点数组 $t_k = k\\Delta t$（其中 $k = 0, 1, \\dots, N-1$）。\n3.  将群元素 $g$ 初始化为 $3 \\times 3$ 的单位矩阵。\n4.  遍历每个时间步 $k$：\n    a. 使用给定的函数评估 $s_1(t_k)$, $s_2(t_k)$, $\\dot{s}_1(t_k)$, 和 $\\dot{s}_2(t_k)$。\n    b. 计算角速度 $\\omega_k = \\kappa (s_2(t_k)\\dot{s}_1(t_k) - s_1(t_k)\\dot{s}_2(t_k))$。\n    c. 计算增量角度 $\\Delta \\theta_k = \\omega_k \\Delta t$。\n    d. 构造增量变换矩阵 $\\Delta g_k = \\exp(\\Delta t \\hat{\\xi}_k)$，如上所述。\n    e. 更新群元素：$g \\leftarrow g @ \\Delta g_k$。\n5.  循环结束后，返回最终的群元素 $g_N(T)$。\n6.  对于测试套件中的每个唯一的 $\\kappa$ 值（$\\kappa \\in \\{0, 0.5, 1.0\\}$），使用 $N_{\\mathrm{ref}} = 50000$ 计算一个高保真度的参考解 $g_{\\mathrm{ref}}(T)$。\n7.  对于每个测试用例 $(\\kappa, N)$，计算近似解 $g_N(T)$。\n8.  计算误差 $\\mathcal{E} = \\|g_N(T) - g_{\\mathrm{ref}}(T)\\|_F$，其中 $\\|\\cdot\\|_F$ 是弗罗贝尼乌斯范数。\n9.  按指定顺序收集所有 9 个误差值，并格式化输出。\n\n对于 $\\kappa=0$ 的特殊情况，角速度 $\\omega(t)$ 对所有 $t$ 恒为零。因此，$\\Delta \\theta_k = 0$，增量变换 $\\exp(\\Delta t \\hat{\\xi}_k)$ 是单位矩阵。对于任何 $N$，最终的群元素 $g_N(T)$ 都将是单位矩阵。因此，对于 $\\kappa=0$ 的误差 $\\mathcal{E}$ 应该为零，除非存在浮点精度误差。\n\n对于 $\\kappa > 0$，一阶欧拉方法的全局误差预计是关于 $\\Delta t$ 的一阶，即 $\\mathcal{E} \\propto \\Delta t \\propto 1/N$。误差的大小也预计会随曲率参数 $\\kappa$ 缩放，因为 $\\kappa$ 直接缩放了被积分的量 $\\omega(t)$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of reconstructing a Lie group trajectory and calculating numerical errors.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.0, 50),\n        (0.0, 200),\n        (0.0, 800),\n        (0.5, 50),\n        (0.5, 200),\n        (0.5, 800),\n        (1.0, 50),\n        (1.0, 200),\n        (1.0, 800),\n    ]\n\n    N_ref = 50000\n    T = 1.0\n\n    # Define shape trajectory and its derivatives\n    def s1(t):\n        return np.cos(2 * np.pi * t) + 0.3 * np.cos(6 * np.pi * t)\n\n    def s2(t):\n        return np.sin(4 * np.pi * t)\n\n    def s1_dot(t):\n        return -2 * np.pi * np.sin(2 * np.pi * t) - 1.8 * np.pi * np.sin(6 * np.pi * t)\n\n    def s2_dot(t):\n        return 4 * np.pi * np.cos(4 * np.pi * t)\n\n    def reconstruct_trajectory(kappa, N):\n        \"\"\"\n        Numerically reconstructs the group trajectory g(t) on SE(2).\n\n        Args:\n            kappa (float): The curvature parameter.\n            N (int): The number of time steps.\n\n        Returns:\n            np.ndarray: The final 3x3 homogeneous transformation matrix g(T).\n        \"\"\"\n        dt = T / N\n        g = np.identity(3)\n        t_values = np.arange(N) * dt\n\n        # Vectorized evaluation for efficiency\n        s1_vals = s1(t_values)\n        s2_vals = s2(t_values)\n        s1_dot_vals = s1_dot(t_values)\n        s2_dot_vals = s2_dot(t_values)\n\n        omega_vals = kappa * (s2_vals * s1_dot_vals - s1_vals * s2_dot_vals)\n        delta_theta_vals = omega_vals * dt\n\n        cos_vals = np.cos(delta_theta_vals)\n        sin_vals = np.sin(delta_theta_vals)\n\n        for k in range(N):\n            delta_g = np.array([\n                [cos_vals[k], -sin_vals[k], 0],\n                [sin_vals[k],  cos_vals[k], 0],\n                [0,            0,           1]\n            ])\n            # Right multiplication for body-frame update\n            g = g @ delta_g\n        \n        return g\n\n    results = []\n    ref_solutions = {}\n\n    for kappa, N in test_cases:\n        # Compute and cache reference solution for each kappa\n        if kappa not in ref_solutions:\n            g_ref = reconstruct_trajectory(kappa, N_ref)\n            ref_solutions[kappa] = g_ref\n        \n        g_ref_T = ref_solutions[kappa]\n        \n        # Compute solution for the current test case N\n        g_N_T = reconstruct_trajectory(kappa, N)\n        \n        # Calculate the Frobenius norm error\n        error = np.linalg.norm(g_N_T - g_ref_T, 'fro')\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}