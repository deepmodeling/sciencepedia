## 引言
在力学世界中，[非完整系统](@entry_id:173158)（nonholonomic systems）——如滚动的球、滑冰者或空间机器人——构成了一个独特而富有挑战性的领域。它们的运动受到不可积的速度约束的限制，这意味着标准的拉格朗日或[哈密顿方法](@entry_id:180487)往往难以直接适用，也无法完全揭示其丰富的动力学行为。为了理解这些系统如何通过内部的周期性运动实现整体位移，或者为何快速滚动的硬币能够稳定不倒，我们需要一个更深刻的几何工具。[非完整联络](@entry_id:1128845)（nonholonomic connection）正是为解决这一知识鸿沟而生的核心概念，它为分析[非完整动力学](@entry_id:1128846)提供了一种优雅而强大的语言。

本文旨在系统地构建和阐释[非完整联络](@entry_id:1128845)。读者将通过三个层次的递进学习，全面掌握这一理论及其应用。在第一章“原理与机制”中，我们将从第一性原理出发，严格定义[约束分布](@entry_id:1122944)和[非完整联络](@entry_id:1128845)，并探讨其与曲率、挠率及对称性的深刻关系。接着，在第二章“应用与交叉学科联系”中，我们将展示这些抽象的几何概念如何应用于现实世界的问题，包括滚动几何学、机器人的运动生成以及与控制理论的联系。最后，在第三章“动手实践”中，你将通过一系列计算练习，亲手应用所学知识，将理论转化为可操作的技能。

## 原理与机制

在理解了[非完整系统](@entry_id:173158)的基本概念之后，本章将深入探讨其核心的几何结构——[非完整联络](@entry_id:1128845)。我们将从第一性原理出发，系统地构建这一概念，并阐明其在描述非完整系统动力学中的关键作用。通过一系列精确的定义和计算，我们将揭示[非完整约束](@entry_id:167828)如何从根本上改变系统的几何与动力学行为。

### 几何背景：[约束分布](@entry_id:1122944)

力学系统的[运动约束](@entry_id:168736)，在几何语言中，被描述为一个位于[切丛](@entry_id:161294) $TQ$ 内的**分布**（distribution） $D$。对于一个位形空间为 $n$ 维流形 $Q$ 的系统，其在任意位形 $q \in Q$ 的所有可能[瞬时速度](@entry_id:167797)构成的集合，就是切空间 $T_qQ$ 的一个子空间 $D_q$。分布 $D = \bigcup_{q \in Q} D_q$ 便是这些子空间在整个[位形空间](@entry_id:149531)上的汇集。

在[非完整力学](@entry_id:1128848)中，我们主要关注对速度呈线性的约束。这类约束通常可以由一组（共 $m$ 个）光滑的1-形式 $\alpha^a$ 来定义。在任意点 $q \in Q$，一个速度向量 $v \in T_qQ$ 是**容许的**（admissible），当且仅当它满足所有[约束方程](@entry_id:138140)，即 $\alpha^a(v)=0$ 对所有 $a=1, \dots, m$ 成立。因此，[约束分布](@entry_id:1122944) $D$ 恰好是这些[1-形式](@entry_id:270392)的共同[零化子](@entry_id:155446)（kernel）：
$$
D_q = \{ v \in T_qQ \mid \alpha^a(v) = 0, \forall a=1, \dots, m \}
$$
在[局部坐标](@entry_id:181200)下，这些1-形式可以写成矩阵 $A(q)$ 的行向量，[约束方程](@entry_id:138140)则简洁地表示为矩阵方程 $A(q)v = 0$。

为了使后续的几何构造（如联络）具有良好的性质，我们必须对[约束分布](@entry_id:1122944)的“光滑性”提出要求。一个关键的概念是**正则性**（regularity）。如果分布 $D$ 在流形 $Q$ 上每一点的维数（即秩）都是常数，那么我们称该分布是正则的。根据微分几何中的[常秩定理](@entry_id:159251)，一个正则分布是一个光滑的向量子丛（vector subbundle） 。这意味着 $D$ 本身就是一个光滑的流形，并且其到 $Q$ 的投影是一个向量丛映射。相反，如果分布的秩在某些点发生变化，系统就会在这些点上表现出奇异性，导致几何结构（如[投影算子](@entry_id:154142)）的破坏，这类系统被称为**奇异[非完整系统](@entry_id:173158)**（singular nonholonomic systems）。在接下来的讨论中，我们默认所考虑的分布都是正则的。

我们必须严格区分分布的**正则性**与**[可积性](@entry_id:142415)**（integrability）。[可积性](@entry_id:142415)是判断一个约束是完整约束还是[非完整约束](@entry_id:167828)的根本标准。根据**[Frobenius可积性定理](@entry_id:161479)**，一个分布 $D$ 是可积的，当且仅当它是**对合的**（involutive），即对于任意两个属于 $D$ 的光滑向量场 $X, Y \in \Gamma(D)$，它们的[李括号](@entry_id:636461) $[X,Y]$ 也必须属于 $D$。一个可积的分布意味着它能“积分”成一族[子流形](@entry_id:159439)，这些[子流形](@entry_id:159439)的切空间恰好就是该分布。这样的约束即为**[完整约束](@entry_id:140686)**（holonomic constraints）。如果一个分布不是对合的，即存在 $X, Y \in \Gamma(D)$ 使得 $[X,Y] \notin \Gamma(D)$，那么它就是**不可积的**，相应的约束即为**[非完整约束](@entry_id:167828)**（nonholonomic constraints）。[Frobenius定理](@entry_id:181858)还有一个等价的微分形式表述：由 $\{\alpha^a\}$ 定义的分布是可积的，当且仅当 $d\alpha^a \wedge \alpha^1 \wedge \dots \wedge \alpha^m = 0$ 对所有 $a$ 成立 。

### [非完整联络](@entry_id:1128845)：[约束分布](@entry_id:1122944)上的动力学

给定一个由度规 $g$（通常来自系统的动能）和[约束分布](@entry_id:1122944) $D$ 定义的非完整系统 $(Q, g, D)$，一个核心问题是：如何描述系统在该约束下的运动？经典力学中的自由运动轨迹是测地线，即满足 $\nabla_{\dot{\gamma}}\dot{\gamma} = 0$ 的曲线，其中 $\nabla$ 是由度规 $g$ 决定的[Levi-Civita联络](@entry_id:161107)。然而，对于[非完整系统](@entry_id:173158)，速度向量 $\dot{\gamma}$ 被限制在分布 $D$ 中，而其[协变](@entry_id:634097)加速度 $\nabla_{\dot{\gamma}}\dot{\gamma}$ 通常会偏离 $D$。

**[d'](@entry_id:902691)Alembert-Lagrange原理**为我们指明了方向。该原理断言，[理想约束](@entry_id:168997)力所做的虚功为零。这意味着约束力必须与所有容许的[虚位移](@entry_id:168781)（即 $D$ 中的向量）正交。在[黎曼几何](@entry_id:160508)的框架下，“正交”由度规 $g$ 定义。因此，[约束力](@entry_id:170052)必须位于 $D$ 的**$g$-[正交补](@entry_id:149922)** $D^\perp$ 中。这样，[运动方程](@entry_id:264286)变为：加速度 $\nabla_{\dot{\gamma}}\dot{\gamma}$ 的切向分量（在 $D$ 内的分量）为零，只留下一个法向分量（在 $D^\perp$ 内的分量），该法向分量即代表约束力。

这启发我们定义一种新的联络——**[非完整联络](@entry_id:1128845)** $\nabla^{\mathrm{nh}}$，它专门用于描述[约束分布](@entry_id:1122944) $D$ 内部的动力学。其构造步骤如下：

1.  **[正交分解](@entry_id:148020)**：利用黎曼度规 $g$，我们可以将每个[切空间](@entry_id:199137) $T_qQ$ 分解为约束子空间 $D_q$ 与其 $g$-[正交补](@entry_id:149922) $D_q^\perp$ 的[直和](@entry_id:156782)：$T_qQ = D_q \oplus D_q^\perp$。这个分解的良定义性依赖于 $D$ 的正则性，它保证了 $D$ 和 $D^\perp$ 都是光滑的向量子丛 。

2.  **[投影算子](@entry_id:154142)**：上述分解唯一地定义了一个到 $D$ 上的**$g$-[正交投影](@entry_id:144168)算子** $P_D: TQ \to D$。对于任意向量 $v \in T_qQ$， $P_D(v)$ 是 $v$ 在 $D_q$ 上的分量。在局部坐标下，如果度规矩阵为 $G$，约束矩阵为 $A$（其行[向量张成](@entry_id:152883) $D$ 的[零化子](@entry_id:155446)），这个[投影算子](@entry_id:154142)可以通过求解一个[约束最小化](@entry_id:747762)问题得到，其矩阵形式为 ：
    $$
    P_D = I - G^{-1} A^{\mathsf T}\,(A\,G^{-1}\,A^{\mathsf T})^{-1}\,A
    $$
    其中 $I$ 是[单位矩阵](@entry_id:156724)。这个公式在具体计算中非常实用。

3.  **定义[非完整联络](@entry_id:1128845)**：对于任意两个属于[约束分布](@entry_id:1122944)的光滑向量场 $X, Y \in \Gamma(D)$，我们将它们在背景流形中的[协变导数](@entry_id:152476) $\nabla_X Y$ 通过投影算子 $P_D$ 投射回分布 $D$ 中。这个结果就被定义为[非完整联络](@entry_id:1128845)下的[协变导数](@entry_id:152476) ：
    $$
    \nabla^{\mathrm{nh}}_X Y := P_D(\nabla_X Y)
    $$

有了这个定义，[非完整系统](@entry_id:173158)的动力学轨迹便有了极其优雅的几何描述。一个在无势场中运动的[非完整系统](@entry_id:173158)的轨迹 $\gamma(t)$，正是[非完整联络](@entry_id:1128845) $\nabla^{\mathrm{nh}}$ 的**自平行曲线**（autoparallel curve），或称**测地线**。这由两个条件定义 ：
1.  速度约束：$\dot{\gamma}(t) \in D_{\gamma(t)}$ 对所有 $t$ 成立。
2.  [测地线方程](@entry_id:264349)：$\nabla^{\mathrm{nh}}_{\dot{\gamma}} \dot{\gamma} = 0$。

将[测地线方程](@entry_id:264349)展开，我们得到 $P_D(\nabla_{\dot{\gamma}}\dot{\gamma}) = 0$，这意味着[协变](@entry_id:634097)加速度 $\nabla_{\dot{\gamma}}\dot{\gamma}$ 完全位于[正交补](@entry_id:149922)空间 $D^\perp$ 中。这与[d'](@entry_id:902691)Alembert-Lagrange原理的推论——加速度等于一个正交于约束的约束力——完全吻合 。因此，[非完整联络](@entry_id:1128845)的测地线精确地刻画了非完整系统的动力学轨迹。

### [非完整联络](@entry_id:1128845)的性质

[非完整联络](@entry_id:1128845)虽然由标准的[Levi-Civita联络](@entry_id:161107)派生而来，但其性质却展现出非完整几何的独特性。

#### 度规相容性

[非完整联络](@entry_id:1128845) $\nabla^{\mathrm{nh}}$ 与[约束分布](@entry_id:1122944) $D$ 上的度规 $g|_D$ 是相容的。也就是说，对于任意 $X, Y, Z \in \Gamma(D)$，我们有：
$$
X\big(g(Y,Z)\big) = g\big(\nabla^{\mathrm{nh}}_X Y, Z\big) + g\big(Y, \nabla^{\mathrm{nh}}_X Z\big)
$$
证明这一点只需利用 $P_D$ 是 $g$-[正交投影](@entry_id:144168)算子（即[自伴算子](@entry_id:152188)）以及 $\nabla$ 本身的度规相容性即可  。这一性质的直接物理推论是，沿非完整测地线运动的系统，其动能 $E = \frac{1}{2}g(\dot{\gamma}, \dot{\gamma})$ 是守恒的。

#### 挠率

[联络的挠率](@entry_id:192913)衡量了其在两个方向上求导的不[可交换性](@entry_id:909050)。挠率的定义依赖于[李括号](@entry_id:636461)的选取。如果我们采用一个**投射李括号** $[X,Y]_D := P_D([X,Y])$，那么[非完整联络](@entry_id:1128845)的挠率 $T^{\mathrm{nh}}(X,Y) = \nabla^{\mathrm{nh}}_X Y - \nabla^{\mathrm{nh}}_Y X - [X,Y]_D$ 是恒等于零的。这是因为[Levi-Civita联络](@entry_id:161107) $\nabla$ 本身是[无挠的](@entry_id:161664)（即 $\nabla_X Y - \nabla_Y X = [X,Y]$） 。

然而，更有物理意义的是相对于标准[李括号](@entry_id:636461) $[X,Y]$ 的挠率。在这种定义下，挠率通常非零。其表达式揭示了[约束分布](@entry_id:1122944)的外部几何性质。具体而言，挠率与分布 $D$ 的**[第二基本形式](@entry_id:161454)**（second fundamental form） $B(X,Y) := (I-P_D)(\nabla_X Y) = Q(\nabla_X Y)$ 密切相关，其中 $Q=I-P_D$ 是到 $D^\perp$ 的投影。计算表明 ：
$$
T^{\mathrm{nh}}(X,Y) = \nabla^{\mathrm{nh}}_X Y - \nabla^{\mathrm{nh}}_Y X - [X,Y] = B(Y,X) - B(X,Y)
$$
在非完整系统中，[第二基本形式](@entry_id:161454)通常是非对称的，因此挠率非零。这正是非完整几何区别于标准[黎曼几何](@entry_id:160508)（[子流形几何](@entry_id:189265)）的一个关键特征。

#### 曲率与[非完整性](@entry_id:175408)（Anholonomy）

[非完整联络](@entry_id:1128845)最引人入胜的性质在于其曲率。曲率从根本上源于[约束分布](@entry_id:1122944) $D$ 的**不可积性**。如前所述，不可积意味着李括号 $[X,Y]$ 会“[逸出](@entry_id:141194)”分布 $D$。这个逸出的部分，正是曲率的根源。

我们可以从更广泛的**Ehresmann联络**视角来理解这一点。任何一个将切丛分解为“水平”和“垂直”子丛的结构 $TE = H \oplus V$ 都构成一个Ehresmann联络。在非完整系统中，我们可以自然地取[水平分布](@entry_id:196663)为[约束分布](@entry_id:1122944) $H=D$。该联络的**曲率** $R$ 被定义为衡量[水平分布](@entry_id:196663) $D$ 不可积的程度。具体来说，对于基底流形上的任意向量场 $X, Y$，我们可以将它们提升为 $D$ 中的水平向量场 $X^H, Y^H$。它们的[李括号](@entry_id:636461) $[X^H, Y^H]$ 的垂直分量（即在 $D^\perp$ 中的分量）就定义了曲率 。

让我们通过一个经典的例子来具[体感](@entry_id:910191)受这一点 。考虑在 $\mathbb{R}^3$ 中由1-形式 $\alpha = dz + \lambda(x\,dy - y\,dx)$ 定义的约束。这可以看作是一个简化的滚动硬币模型。[约束分布](@entry_id:1122944) $D = \ker\alpha$ 是二维的。我们可以选取 $D$ 的一组基向量场：
$$
X = \partial_x + \lambda y \partial_z, \quad Y = \partial_y - \lambda x \partial_z
$$
直接计算它们的李括号，我们得到一个惊人的结果：
$$
[X, Y] = -2\lambda \partial_z
$$
由于 $\lambda \neq 0$，这个[李括号](@entry_id:636461)是一个纯粹的“垂直”向量，显然不属于 $D$。这表明分布 $D$ 是不可积的。这个垂直分量 $-2\lambda \partial_z$ 正是联络曲率的表现。

曲率的宏观效应是**[非完整性](@entry_id:175408)**（anholonomy），又称**和乐**（holonomy）。它指的是沿基底空间中的一条闭合路径进行水平移动，最终在纤维方向（垂直方向）上会产生一个净位移。对于上述例子，如果我们让系统在 $(x,y)$ 平面上沿一个边长为 $a$ 和 $b$ 的小矩形路径 $\gamma$ 运动，并始终保持速度在 $D$ 中（即 $\alpha(\dot{c})=0$），那么 $z$ 方向的高度将发生变化。其净位移 $\Delta z$ 可以通过对[约束方程](@entry_id:138140)积分得到，并利用[Stokes定理](@entry_id:146491)转化为[面积分](@entry_id:275394)：
$$
\Delta z = \oint_\gamma \lambda(y\,dx - x\,dy) = \iint_{\text{Area}} (-2\lambda) \,dx\,dy = -2\lambda \times (\text{Area})
$$
对于这个矩形，$\Delta z = -2\lambda ab$。这个结果完美地展示了微观的不[可交换性](@entry_id:909050)（李括号非零）如何转化为宏观的路径依赖几何效应（绕路一周后无法回到原点）。这个 $-2\lambda$ 系数，正是我们从[李括号](@entry_id:636461)中计算出的曲率。

最后需要强调，[非完整联络](@entry_id:1128845)的曲率 $R^{\mathrm{nh}}$ 与背景度规的[黎曼曲率张量](@entry_id:160189) $R^g$ 并非简单的投影关系。即使背景空间是平坦的（$R^g=0$），如 $\mathbb{R}^3$ 的例子，[非完整联络](@entry_id:1128845)的曲率也可能非零。它包含了由约束的外部几何（[第二基本形式](@entry_id:161454)）诱导的附加项 。

#### 对度规的依赖性

[非完整联络](@entry_id:1128845)的定义依赖于一个“背景”结构——黎曼度规 $g$。即使对于完全相同的运动学约束（即同一个分布 $D$），选择不同的度规（例如，在拉格朗日量中改变质量矩阵）会导致不同的[正交补](@entry_id:149922) $D^\perp$，从而产生不同的投影算子 $P_D$，最终定义出不同的[非完整联络](@entry_id:1128845)。这种对度规的依赖性，可以看作是一种“[规范自由度](@entry_id:160491)”（gauge-like ambiguity）。例如，在 $\mathbb{R}^3$ 中，对于同一个[约束分布](@entry_id:1122944)，采用标准欧氏度规 $g_1 = dx^2+dy^2+dz^2$ 和一个各向异性的度规 $g_2 = dx^2+dy^2+a^2 dz^2$ 会得到不同的[联络系数](@entry_id:157618) 。这提醒我们，非完整系统的“动力学几何”不仅由约束本身决定，也由系统的惯性属性（即[动能度规](@entry_id:184650)）决定。

### 对称性与守恒律

对称性在力学中起着核心作用，它通过Noether定理与守恒律紧密相连。然而，在[非完整系统](@entry_id:173158)中，这一美妙的对应关系被打破了。

考虑一个具有Lie群 $G$ 对称性的系统，即[拉格朗日量](@entry_id:174593) $L$ 和[约束分布](@entry_id:1122944) $D$ 在 $G$ 的作用下均保持不变。对于[李代数](@entry_id:137954) $\mathfrak{g}$ 中的任一元素 $\xi$，它在 $Q$ 上生成一个向量场 $\xi_Q$，并对应一个动量 $J_\xi = \langle \frac{\partial L}{\partial \dot{q}}, \xi_Q \rangle$。在完整系统中，$L$ 的不变性直接保证了 $J_\xi$ 的守恒。

但在非完整系统中，情况并非如此。标准Noether定理的推导依赖于一个关键步骤：对称性产生的位形变化 $\delta q = \epsilon \xi_Q$ 必须是一个容许的虚位移。而在非完整系统中，虚位移被限制在 $D$ 内。如果对称性生成元 $\xi_Q$ 不在 $D$ 中，那么它就不是一个容许的[虚位移](@entry_id:168781)，[约束力](@entry_id:170052)对其所做的[虚功](@entry_id:176403) $\langle R, \xi_Q \rangle$ 不一定为零。

通过[d'](@entry_id:902691)Alembert-[Lagrange方程](@entry_id:175419)，我们可以推导出**[非完整动量方程](@entry_id:1128849)** ：
$$
\frac{d}{dt}J_\xi = \langle R, \xi_Q \rangle
$$
这个方程表明，动量不再守恒，其变化率等于[约束力](@entry_id:170052)在对称性方向上所做的功。利用[投影算子](@entry_id:154142)，我们能更清晰地看到这一点：由于[约束力](@entry_id:170052) $R$ 存在于 $D^\circ$（$D$的[零化子](@entry_id:155446)，与 $D^\perp$ 等价），而它只对 $D$ 中的向量做功为零，所以 $\langle R, P_D(\xi_Q) \rangle = 0$。因此，动量方程可以写作：
$$
\frac{d}{dt}J_\xi = \langle R, P_{D^\perp}(\xi_Q) \rangle
$$
这精确地表明，动量的不守恒性完全源于对称性生成元 $\xi_Q$ 中垂直于[约束分布](@entry_id:1122944)的分量。只有当一个对称性是“容许的”（即 $\xi_Q \in D$）时，相应的动量才会守恒。

为了在存在对称性的情况下更好地分析系统，我们引入**主[非完整联络](@entry_id:1128845)**（principal nonholonomic connection）的概念。当 $Q$ 是一个[主丛](@entry_id:160029) $Q \to Q/G$ 时，切丛可以分解为垂直丛 $V$（[群作用](@entry_id:268812)轨道方向）和某个水平补。在[非完整系统](@entry_id:173158)中，我们关心的只是容许的运动 $D$。因此，我们寻求在 $D$ 内部进行类似的分解。我们将 $D$ 分解为“容许的垂直运动” $D \cap V$ 和其在 $D$ 内部的[正交补](@entry_id:149922) $H$：
$$
D = H \oplus (D \cap V)
$$
这个 $H$ 就是主[非完整联络](@entry_id:1128845)的[水平分布](@entry_id:196663)。这里的正交性是由**锁定惯量张量**（locked inertia tensor） $I(q)(\xi, \eta) = g_q(\xi_Q(q), \eta_Q(q))$ 来保证的，它本质上是度规在垂直空间 $V$ 上的限制，为这个分解提供了唯一的、典范的选择 。这种分解将系统的运动优雅地分离为沿对称性方向的运动和与之正交的“形状”运动。

当联络由一个 $\mathfrak{g}$-值的1-形式 $\mathcal{A}$ 给出时（此时水平空间为 $H = \ker\mathcal{A}$），其[曲率2-形式](@entry_id:187677) $\mathcal{F} = d\mathcal{A} + \frac{1}{2}[\mathcal{A}, \mathcal{A}]$ 与Ehresmann曲率图像紧密相连。对于[水平提升](@entry_id:160651)的向量场 $X^H, Y^H$，曲率的值 $\mathcal{F}(X^H, Y^H)$ 恰好等于[李括号](@entry_id:636461) $[X^H, Y^H]$ 的垂直部分的[李代数表示](@entry_id:196776)（带有负号），即 $\mathcal{F}(X^H, Y^H) = -\mathcal{A}([X^H, Y^H])$ 。这再次将抽象的[曲率形式](@entry_id:199387)与向量场[李括号](@entry_id:636461)的不[可交换性](@entry_id:909050)联系在一起，为[非完整动力学](@entry_id:1128846)的[几何分析](@entry_id:157700)提供了有力的计算工具。