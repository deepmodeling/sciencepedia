{
    "hands_on_practices": [
        {
            "introduction": "Conservation laws are central to our understanding of physical dynamics. The Wong equations possess a crucial geometric property: the conservation of Casimir invariants, which correspond to the magnitude of the Yang-Mills charge. This exercise will guide you through a first-principles proof of this conservation law, solidifying your understanding of the interplay between the Lie algebra structure and the equations of motion .",
            "id": "3784816",
            "problem": "Consider a relativistic particle of unit mass carrying non-Abelian Yang-Mills (YM) charge moving in a background gauge field. Let $G$ be a compact semisimple Lie group with Lie algebra $\\mathfrak{g}$, and fix a basis $\\{T_{a}\\}$ with structure constants $f_{ab}{}^{c}$ defined by $[T_{a},T_{b}] = f_{ab}{}^{c}\\,T_{c}$. The YM gauge potential is $A_{\\mu}(x) = A_{\\mu}^{a}(x)\\,T_{a}$, and the particle follows a worldline $x^{\\mu}(t)$ with four-velocity $u^{\\mu}(t) = \\mathrm{d}x^{\\mu}/\\mathrm{d}t$. The internal charge is a curve $Q(t) \\in \\mathfrak{g}$ governed by the Wong equation\n$$\n\\dot{Q}(t) = [\\,Q(t),\\,A_{\\mu}(x(t))\\,u^{\\mu}(t)\\,] \\, .\n$$\nAssume $\\mathfrak{g}$ is equipped with an $\\mathrm{Ad}$-invariant, symmetric, nondegenerate bilinear form $\\kappa:\\mathfrak{g} \\times \\mathfrak{g} \\to \\mathbb{R}$ (for example, the negative of the Killing form for a compact semisimple Lie algebra) so that $\\kappa(\\mathrm{Ad}_{g}X,\\mathrm{Ad}_{g}Y) = \\kappa(X,Y)$ for all $g \\in G$ and $X,Y \\in \\mathfrak{g}$. Define the quadratic Casimir\n$$\nC_{2}(Q) = \\frac{1}{2}\\,\\kappa(Q,Q) = \\frac{1}{2}\\,\\kappa_{ab}\\,Q^{a}\\,Q^{b} \\, ,\n$$\nwhere $Q = Q^{a}T_{a}$ and $\\kappa_{ab} = \\kappa(T_{a},T_{b})$. More generally, let $C_{k}(Q)$ denote any $\\mathrm{Ad}$-invariant homogeneous polynomial of degree $k$ on $\\mathfrak{g}$.\n\nUsing only the above foundational definitions and facts, do the following:\n\n1) Explain from first principles why the Wong equation implies that each $\\mathrm{Ad}$-invariant polynomial $C_{k}(Q)$ is conserved along the motion, that is, $\\mathrm{d}C_{k}(Q(t))/\\mathrm{d}t = 0$.\n\n2) Compute explicitly $\\mathrm{d}C_{2}(Q(t))/\\mathrm{d}t$ and show that it vanishes, presenting the chain of equalities that lead to $0$ in terms of $\\kappa$ and the Lie bracket.\n\nYour final answer must be the single value of $\\mathrm{d}C_{2}(Q(t))/\\mathrm{d}t$. No rounding is required, and no units are to be reported.",
            "solution": "The problem asks for two related tasks concerning the conservation of Casimir invariants under the dynamics of the Wong equation for a non-Abelian charge. We will address each part systematically, building upon the provided definitions.\n\nLet us begin by establishing some notation. The Lie algebra is denoted by $\\mathfrak{g}$, the internal charge is $Q(t) \\in \\mathfrak{g}$, and its evolution is given by the Wong equation:\n$$\n\\frac{\\mathrm{d}Q(t)}{\\mathrm{d}t} = [Q(t), A(t)]\n$$\nwhere we have defined $A(t) \\equiv A_{\\mu}(x(t))u^{\\mu}(t)$ for notational brevity. $A(t)$ is a curve in the Lie algebra $\\mathfrak{g}$.\n\nThe problem statement provides two key definitions of invariance. The first is for a polynomial function $C_k: \\mathfrak{g} \\to \\mathbb{R}$, which is $\\mathrm{Ad}$-invariant if $C_k(\\mathrm{Ad}_g X) = C_k(X)$ for all $g \\in G$ and $X \\in \\mathfrak{g}$. The second is for the bilinear form $\\kappa: \\mathfrak{g} \\times \\mathfrak{g} \\to \\mathbb{R}$, which is $\\mathrm{Ad}$-invariant if $\\kappa(\\mathrm{Ad}_g X, \\mathrm{Ad}_g Y) = \\kappa(X,Y)$ for all $g \\in G$ and $X, Y \\in \\mathfrak{g}$. A crucial step in both parts of the solution is to use the infinitesimal form of these invariance conditions.\n\nAn element $g$ near the identity of the Lie group $G$ can be written as $g = \\exp(sZ)$ for some $Z \\in \\mathfrak{g}$ and a small parameter $s$. The adjoint action is then given by $\\mathrm{Ad}_{\\exp(sZ)}X = \\exp(\\mathrm{ad}_{sZ})X = X + s[Z,X] + O(s^2)$.\n\n**1) Conservation of general $\\mathrm{Ad}$-invariant polynomials a.k.a. Casimir invariants**\n\nLet $C_k(Q)$ be any $\\mathrm{Ad}$-invariant homogeneous polynomial of degree $k$ on $\\mathfrak{g}$. The condition of $\\mathrm{Ad}$-invariance, $C_k(\\mathrm{Ad}_g X) = C_k(X)$, implies an infinitesimal condition. Let $g = \\exp(sZ)$ for an arbitrary $Z \\in \\mathfrak{g}$. The invariance means $C_k(\\mathrm{Ad}_{\\exp(sZ)} X) = C_k(X)$ for all $s \\in \\mathbb{R}$. Differentiating this identity with respect to $s$ and evaluating at $s=0$ must yield zero:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}s} C_k(\\mathrm{Ad}_{\\exp(sZ)} X) \\bigg|_{s=0} = 0\n$$\nUsing the chain rule, this becomes:\n$$\n\\mathrm{d}(C_k)_X \\left( \\frac{\\mathrm{d}}{\\mathrm{d}s} \\mathrm{Ad}_{\\exp(sZ)} X \\bigg|_{s=0} \\right) = 0\n$$\nThe derivative of the adjoint action is $\\frac{\\mathrm{d}}{\\mathrm{d}s} \\mathrm{Ad}_{\\exp(sZ)} X \\big|_{s=0} = [Z,X]$. Thus, the infinitesimal condition for an $\\mathrm{Ad}$-invariant function $C_k$ is that its differential $\\mathrm{d}(C_k)_X$ vanishes on any vector of the form $[Z,X]$:\n$$\n\\mathrm{d}(C_k)_X([Z,X]) = 0 \\quad \\forall X, Z \\in \\mathfrak{g}\n$$\nNow, we compute the time derivative of $C_k(Q(t))$ along the trajectory governed by the Wong equation. Using the chain rule:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} C_k(Q(t)) = \\mathrm{d}(C_k)_{Q(t)} \\left( \\frac{\\mathrm{d}Q(t)}{\\mathrm{d}t} \\right)\n$$\nSubstituting the Wong equation $\\dot{Q}(t) = [Q(t), A(t)]$:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} C_k(Q(t)) = \\mathrm{d}(C_k)_{Q(t)} ([Q(t), A(t)])\n$$\nWe can now apply the infinitesimal invariance condition. Let $X = Q(t)$ and $Z = -A(t)$. The condition states:\n$$\n\\mathrm{d}(C_k)_{Q(t)} ([-A(t), Q(t)]) = 0\n$$\nUsing the antisymmetry of the Lie bracket, $[-A(t), Q(t)] = -[Q(t), -A(t)] = [Q(t), A(t)]$. Substituting this into the invariance condition gives:\n$$\n\\mathrm{d}(C_k)_{Q(t)} ([Q(t), A(t)]) = 0\n$$\nThis is precisely the expression for the time derivative of $C_k(Q(t))$. Therefore, we have shown from first principles that:\n$$\n\\frac{\\mathrm{d}C_k(Q(t))}{\\mathrm{d}t} = 0\n$$\nThis demonstrates that any Casimir invariant is conserved along the motion described by the Wong equation. The physical reason is that the Wong equation describes a \"rotation\" of the charge vector $Q$ within its adjoint orbit, and Casimir invariants are by definition constant on such orbits.\n\n**2) Explicit computation for the quadratic Casimir $C_2(Q)$**\n\nWe now apply the general principle to the specific case of the quadratic Casimir, $C_2(Q) = \\frac{1}{2}\\kappa(Q,Q)$. We will compute its time derivative directly and show that it vanishes.\n\nFirst, we find the infinitesimal invariance condition for the bilinear form $\\kappa$. Differentiating $\\kappa(\\mathrm{Ad}_{\\exp(sZ)}X, \\mathrm{Ad}_{\\exp(sZ)}Y) = \\kappa(X,Y)$ with respect to $s$ at $s=0$ yields:\n$$\n\\kappa\\left(\\frac{\\mathrm{d}}{\\mathrm{d}s}\\mathrm{Ad}_{\\exp(sZ)}X\\bigg|_{s=0}, Y\\right) + \\kappa\\left(X, \\frac{\\mathrm{d}}{\\mathrm{d}s}\\mathrm{Ad}_{\\exp(sZ)}Y\\bigg|_{s=0}\\right) = 0\n$$\nThis gives the infinitesimal property:\n$$\n\\kappa([Z,X], Y) + \\kappa(X, [Z,Y]) = 0 \\quad \\forall X, Y, Z \\in \\mathfrak{g}\n$$\nThis property is also known as the associativity of the inner product with respect to the Lie bracket.\n\nNow, we compute the derivative of $C_2(Q(t))$:\n$$\n\\frac{\\mathrm{d}C_2(Q(t))}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\frac{1}{2}\\kappa(Q(t), Q(t))\\right)\n$$\nUsing the product rule for bilinear forms and the symmetry of $\\kappa(\\cdot, \\cdot)$:\n$$\n\\frac{\\mathrm{d}C_2}{\\mathrm{d}t} = \\frac{1}{2}\\left(\\kappa(\\dot{Q}(t), Q(t)) + \\kappa(Q(t), \\dot{Q}(t))\\right) = \\kappa(Q(t), \\dot{Q}(t))\n$$\nNext, we substitute the Wong equation, $\\dot{Q}(t) = [Q(t), A(t)]$:\n$$\n\\frac{\\mathrm{d}C_2}{\\mathrm{d}t} = \\kappa(Q(t), [Q(t), A(t)])\n$$\nTo show this expression is zero, we use the infinitesimal invariance property of $\\kappa$ derived above: $\\kappa([Z,X], Y) + \\kappa(X, [Z,Y]) = 0$. Let us make the substitutions $Z=Q(t)$, $X=Q(t)$, and $Y=A(t)$. This gives:\n$$\n\\kappa([Q(t), Q(t)], A(t)) + \\kappa(Q(t), [Q(t), A(t)]) = 0\n$$\nBy the antisymmetry property of the Lie bracket, $[Q(t), Q(t)] = 0$. The first term thus becomes $\\kappa(0, A(t))$, which is $0$ due to the bilinearity of $\\kappa$. The equation simplifies to:\n$$\n0 + \\kappa(Q(t), [Q(t), A(t)]) = 0\n$$\nThis directly implies that $\\kappa(Q(t), [Q(t), A(t)]) = 0$.\n\nTherefore, the chain of equalities shows that the time derivative of the quadratic Casimir vanishes:\n$$\n\\frac{\\mathrm{d}C_2(Q(t))}{\\mathrm{d}t} = \\kappa(Q(t), \\dot{Q}(t)) = \\kappa(Q(t), [Q(t), A(t)]) = 0\n$$\nThis completes the explicit computation and confirms the general result from the first part for the specific case of $C_2(Q)$. The value of the derivative is $0$.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "Moving from abstract principles to concrete applications is a key step in mastering any physical theory. Here, we analyze the motion of a Yang-Mills charged particle in a constant, uniform non-Abelian magnetic field, a canonical example in gauge theory. This practice demonstrates how the general Wong equations can be reduced in a symmetric setting to reveal familiar physics, such as cyclotron motion, and connects the system to the powerful framework of Hamiltonian integrability and action-angle variables .",
            "id": "3784830",
            "problem": "Consider a classical point particle of mass $m$ and non-Abelian charge $Q \\in \\mathfrak{su}(2)^{\\ast}$ moving in $\\mathbb{R}^{3}$, coupled to a fixed background Yang–Mills (YM) gauge potential $A_{i}^{a}(x)$ of the Special Unitary group of degree two (SU(2)). The color charge components are denoted $Q^{a}$, and the structure constants of $\\mathfrak{su}(2)$ are $f^{abc}=\\epsilon^{abc}$. The phase space is $T^{\\ast}\\mathbb{R}^{3}\\times\\mathcal{O}_{C}$, where $\\mathcal{O}_{C}$ is the coadjoint orbit of $\\mathfrak{su}(2)^{\\ast}$ with fixed Casimir $C=|Q|^{2}$, and the dynamics obey the Wong equations\n$$\nm\\,\\ddot{x}^{i} = Q^{a}\\,F_{ij}^{a}(x)\\,\\dot{x}^{j},\\qquad \\dot{Q}^{a} = - f^{abc}\\,A_{i}^{b}(x)\\,\\dot{x}^{i}\\,Q^{c},\n$$\nwith magnetic field strength $F_{ij}^{a}=\\partial_{i}A_{j}^{a}-\\partial_{j}A_{i}^{a}+f^{abc}A_{i}^{b}A_{j}^{c}$. The Hamiltonian is the kinetic energy written in terms of the gauge-covariant momentum $\\Pi_{i}=p_{i}-Q^{a}A_{i}^{a}$:\n$$\nH(x,p,Q)=\\frac{1}{2m}\\,\\Pi_{i}\\Pi_{i}.\n$$\n\nAssume the background has a constant non-Abelian magnetic field with magnitude $B>0$ oriented along the spatial $z$-axis and the color direction $a=3$, implemented in the symmetric gauge\n$$\nA_{x}^{3}(x,y,z) = -\\frac{B}{2}\\,y,\\qquad A_{y}^{3}(x,y,z) = \\frac{B}{2}\\,x,\\qquad A_{z}^{3}(x,y,z) = 0,\\qquad A_{i}^{1}=A_{i}^{2}=0,\n$$\nso that $F_{xy}^{3}=B$ and all other components of $F_{ij}^{a}$ vanish. Take initial data with $Q^{1}=Q^{2}=0$ and $Q^{3}>0$ so that the color charge remains aligned with the fixed color direction.\n\nStarting from the Wong equations and the canonical plus Kirillov–Kostant–Souriau symplectic viewpoint, analyze the integrability of the spatial dynamics for fixed Casimir $C$ and fixed $Q^{3}>0$ under this background. In particular:\n\n- Identify the reduced degrees of freedom after using the constants of motion associated with translation along the $z$-axis and the guiding-center invariants in the $xy$-plane, and argue that the remaining nontrivial motion is periodic cyclotron motion in the transverse plane.\n- Define the transverse energy $E_{\\perp}$ as the portion of the energy associated with the $xy$-plane and express it in terms of $H$ and $p_{z}$. Then, compute the action variable $J_{\\perp}$ of the periodic transverse motion in terms of $E_{\\perp}$, $m$, $B$, and $Q^{3}$.\n\nYour final answer must be the single closed-form analytic expression for $J_{\\perp}$ in terms of $H$, $p_{z}$, $m$, $B$, and $Q^{3}$. No numerical evaluation is required, and no rounding is needed. Do not include units in your final boxed expression.",
            "solution": "The starting point is the Wong equations for a classical YM-charged particle in a fixed background, together with the Hamiltonian formulation using the gauge-covariant momentum. The gauge field is chosen with constant field strength $F_{xy}^{3}=B$, all other components zero, and with potentials linear in $(x,y)$:\n$$\nA_{x}^{3}=-\\frac{B}{2}\\,y,\\qquad A_{y}^{3}=\\frac{B}{2}\\,x,\\qquad A_{z}^{3}=0,\\qquad A_{i}^{1}=A_{i}^{2}=0.\n$$\nThe field strength is constant and purely magnetic. The Wong equation for the color charge reads\n$$\n\\dot{Q}^{a}=-f^{abc}A_{i}^{b}\\dot{x}^{i}Q^{c}.\n$$\nWith $A_{i}^{b}$ nonzero only for $b=3$ and initial $Q$ aligned with the $a=3$ direction ($Q^{1}=Q^{2}=0$, $Q^{3}>0$), we have for $a=1$,\n$$\n\\dot{Q}^{1}=-f^{1\\,3\\,c}A_{i}^{3}\\dot{x}^{i}Q^{c}=-\\epsilon^{13c}A_{i}^{3}\\dot{x}^{i}Q^{c}.\n$$\nSince $Q^{c}$ is zero unless $c=3$, and $\\epsilon^{133}=0$, it follows that $\\dot{Q}^{1}=0$. A similar argument gives $\\dot{Q}^{2}=0$, and for $a=3$,\n$$\n\\dot{Q}^{3}=-f^{3\\,3\\,c}A_{i}^{3}\\dot{x}^{i}Q^{c}=-\\epsilon^{33c}(\\cdots)=0,\n$$\nso $Q^{3}$ is a constant of motion. Thus, for the chosen background and initial alignment, the internal (color) dynamics is frozen to $Q^{3}=\\text{const}>0$, and the spatial force reduces to an Abelian Lorentz force with effective charge $Q^{3}$:\n$$\nm\\,\\ddot{x}^{i}=Q^{3}\\,F_{ij}^{3}\\,\\dot{x}^{j}.\n$$\nWith $F_{xy}^{3}=B$ and the usual identification of the magnetic field along $\\hat{z}$, the spatial dynamics separates into:\n- Free motion along the $z$-axis, since $F_{iz}^{a}=0$ implies $m\\,\\ddot{z}=0$, so $p_{z}=m\\,\\dot{z}$ is conserved.\n- Uniform circular motion in the $xy$-plane due to the constant magnetic field.\n\nIntroduce the gauge-covariant momenta\n$$\n\\Pi_{x}=p_{x}-Q^{3}A_{x}^{3}=p_{x}+\\frac{Q^{3}B}{2}\\,y,\\qquad\n\\Pi_{y}=p_{y}-Q^{3}A_{y}^{3}=p_{y}-\\frac{Q^{3}B}{2}\\,x,\\qquad\n\\Pi_{z}=p_{z},\n$$\nand the Hamiltonian\n$$\nH=\\frac{1}{2m}\\left(\\Pi_{x}^{2}+\\Pi_{y}^{2}+\\Pi_{z}^{2}\\right).\n$$\nBecause $A_{z}^{3}=0$ and no field acts along $z$, the longitudinal motion is free with constant $p_{z}$, so the transverse energy is\n$$\nE_{\\perp}=H-\\frac{p_{z}^{2}}{2m}.\n$$\nThe effective cyclotron frequency $\\omega$ for planar motion is determined by the Lorentz force law $m\\,\\ddot{\\boldsymbol{r}}=\\dot{\\boldsymbol{r}}\\times (Q^{3}\\boldsymbol{B})$ with $\\boldsymbol{B}=B\\,\\hat{z}$, yielding\n$$\n\\omega=\\frac{Q^{3}\\,B}{m}.\n$$\nSince $Q^{3}>0$ and $B>0$ by assumption, $\\omega>0$. It is convenient to reduce the planar dynamics by the guiding-center invariants. Define the guiding-center coordinates $(X,Y)$ via\n$$\nX = x - \\frac{\\Pi_{y}}{Q^{3}B},\\qquad Y = y + \\frac{\\Pi_{x}}{Q^{3}B},\n$$\nwhich are constants of motion for the uniform field (they generate the magnetic translation symmetries). The nontrivial periodic dynamics occurs in the relative coordinates\n$$\n\\xi = x - X,\\qquad \\eta = y - Y,\n$$\nfor which the equations of motion are\n$$\n\\dot{\\xi}=\\omega\\,\\eta,\\qquad \\dot{\\eta}=-\\omega\\,\\xi.\n$$\nThese are the equations of a one-degree-of-freedom periodic system (equivalent to a planar harmonic oscillator confined to a single rotational normal mode), with conserved transverse energy\n$$\nE_{\\perp}=\\frac{m}{2}\\left(\\dot{\\xi}^{2}+\\dot{\\eta}^{2}\\right)\n=\\frac{m\\omega^{2}}{2}\\left(\\xi^{2}+\\eta^{2}\\right),\n$$\nand period $T=2\\pi/\\omega$. The action variable $J_{\\perp}$ associated with this periodic motion can be computed from its definition for a one-degree-of-freedom periodic system,\n$$\nJ_{\\perp}=\\frac{1}{2\\pi}\\oint p_{\\text{eff}}\\,dq_{\\text{eff}},\n$$\nor, more directly, using the standard relation for a single periodic mode with frequency $\\omega$,\n$$\nJ_{\\perp}=\\frac{E_{\\perp}}{\\omega}.\n$$\nSubstituting $E_{\\perp}$ and $\\omega$ in terms of the invariants $H$ and $p_{z}$ and parameters $m$, $B$, and $Q^{3}$ gives\n$$\nJ_{\\perp}=\\frac{H-\\frac{p_{z}^{2}}{2m}}{\\frac{Q^{3}B}{m}}=\\frac{m}{Q^{3}B}\\left(H-\\frac{p_{z}^{2}}{2m}\\right).\n$$\n\nRegarding integrability, for fixed Casimir $C=|Q|^{2}$ and aligned $Q^{3}>0$, the system possesses the invariants $(H,p_{z},X,Y)$ in the uniform field, with Poisson commuting subsets suitable for reduction. After reduction by the two guiding-center invariants $(X,Y)$ and the trivial longitudinal translation (fixing $p_{z}$), the remaining nontrivial transverse motion is periodic and admits action-angle variables $(J_{\\perp},\\theta_{\\perp})$ with $J_{\\perp}$ given above and $\\theta_{\\perp}$ the cyclotron phase advancing at rate $\\dot{\\theta}_{\\perp}=\\omega$. The explicit expression for the action variable of the periodic transverse motion is therefore the formula displayed above.",
            "answer": "$$\\boxed{\\frac{m}{Q^{3}B}\\left(H-\\frac{p_{z}^{2}}{2m}\\right)}$$"
        },
        {
            "introduction": "While analytical solutions are invaluable, most realistic physical systems require numerical simulation. For Hamiltonian systems like the Wong equations, it is crucial to use methods that preserve the underlying geometric structure. This computational exercise challenges you to design and implement a second-order symplectic integrator, a powerful technique that ensures excellent long-term conservation of energy and other invariants, providing a practical foundation in the essential field of geometric integration .",
            "id": "3784823",
            "problem": "A Yang–Mills charged particle moving in a three-dimensional physical space interacts with a non-Abelian gauge field, and its dynamics can be formulated on a product of a cotangent bundle and a coadjoint orbit using geometric mechanics and symplectic methods. Consider a particle with position $x \\in \\mathbb{R}^3$, canonical momentum $p \\in \\mathbb{R}^3$, and internal color charge $Q \\in \\mathfrak{su}(2) \\cong \\mathbb{R}^3$. Let the gauge group be the Special Unitary group of degree $2$ (SU(2)). The fundamental base you should use consists of: Hamiltonian mechanics on cotangent bundles, coadjoint orbits with their Kirillov–Kostant–Souriau symplectic forms, and the Wong equations for Yang–Mills charged particles as a Hamiltonian system on a semidirect product phase space. All quantities are nondimensional.\n\nThe task is to design a symplectic integrator for the Wong equations by splitting the Hamiltonian flow into two parts: one that advances the $(x,p)$ variables with $Q$ held constant, and another that advances $Q$ with $(x,p)$ held constant. Your integrator must be constructed from first principles, without using any shortcut formulas, and you must analyze its order and stability properties.\n\nWork in the following physically consistent setting to make the problem computationally tractable and scientifically realistic. Assume a constant non-Abelian magnetic field in physical space represented by a magnetic field vector $B \\in \\mathbb{R}^3$, and a fixed color direction $c \\in \\mathbb{R}^3$ of unit length specifying that the non-Abelian gauge potential is aligned with $c$. Use the gauge potential $A(x) \\in \\mathbb{R}^3$ defined by $A(x) = \\tfrac{1}{2}\\, B \\times x$ in physical space and aligned in color with $c$. There is no electric field. The particle’s mass is $m \\in \\mathbb{R}_{>0}$. In this setting, the Wong equations can be expressed as a coupled Ordinary Differential Equation (ODE) system for $(x,v,Q)$, where $v \\in \\mathbb{R}^3$ is the physical velocity:\n- The spatial kinematics $x$ and velocity $v$ satisfy $m\\, \\frac{dv}{dt} = (Q \\cdot c)\\, v \\times B$ and $\\frac{dx}{dt} = v$.\n- The color charge $Q$ evolves on the coadjoint orbit according to $\\frac{dQ}{dt} = -\\big(A(x) \\cdot v\\big)\\, c \\times Q$.\n\nYour goals are:\n1. Starting from the above fundamental base, derive a symplectic splitting of the Hamiltonian flow into an $(x,p)$-part with $Q$ frozen, and a $Q$-part with $(x,p)$ frozen. Construct a second-order accurate method by symmetric composition of these flows. Clearly explain how the exact flows of each split are obtained in this constant-field setting.\n2. Implement the resulting method as a program that advances $(x,v,Q)$ from initial conditions to a final time $T \\in \\mathbb{R}_{>0}$, using a uniform time step $h \\in \\mathbb{R}_{>0}$ with an integer number of steps $N \\in \\mathbb{N}$ chosen so that $N h = T$ holds exactly. For the $(x,p)$-part, use the exact solution under a uniform magnetic field with $Q$ fixed over the substep. For the $Q$-part, use the exact coadjoint action (rotation in color space about the axis $c$) generated by the scalar $\\big(A(x) \\cdot v\\big)$, with $(x,v)$ frozen over the substep.\n3. Analyze the method’s observed order and stability by:\n   - Computing the position error at the final time $T$ for two step sizes $h$ and $h/2$, relative to a high-accuracy reference solution computed by a non-symplectic but accurate integrator, and estimating the observed order $p$ via the ratio of these errors.\n   - Measuring the maximum deviation of the color-charge Casimir $\\|Q\\|^2$ from its initial value over the numerical trajectory.\n   - Measuring the maximum drift of the kinetic energy $\\tfrac{1}{2} m \\|v\\|^2$ from its initial value over the numerical trajectory.\n\nYour program must implement the above integrator and produce results for the following test suite. In all cases, treat $c$ as a unit vector, and all quantities are dimensionless. For each case, you are given $(m,B,c,x_0,v_0,Q_0,T,h_{\\mathrm{large}},h_{\\mathrm{small}})$:\n- Case $1$ (general constant-field “happy path”): $m = 1$, $B = [0,0,1]$, $c = [0,0,1]$, $x_0 = [0.1,-0.2,0.0]$, $v_0 = [0.7,0.0,0.3]$, $Q_0 = [0.5,-0.4,0.2]$, $T = 2.0$, $h_{\\mathrm{large}} = 0.1$, $h_{\\mathrm{small}} = 0.05$.\n- Case $2$ (zero-field edge case): $m = 1$, $B = [0,0,0]$, $c = [0,0,1]$, $x_0 = [0.1,0.2,-0.1]$, $v_0 = [0.3,-0.6,0.2]$, $Q_0 = [0.2,0.1,0.3]$, $T = 1.0$, $h_{\\mathrm{large}} = 0.2$, $h_{\\mathrm{small}} = 0.1$.\n- Case $3$ (velocity parallel to field): $m = 1$, $B = [0,0,2]$, $c = [0,0,1]$, $x_0 = [0.0,0.0,0.0]$, $v_0 = [0.0,0.0,1.0]$, $Q_0 = [0.6,-0.1,0.3]$, $T = 3.0$, $h_{\\mathrm{large}} = 0.2$, $h_{\\mathrm{small}} = 0.1$.\n- Case $4$ (long-time, larger step stability probe): $m = 1$, $B = [0.0,1.0,0.5]$, $c = [0.0,0.0,1.0]$, $x_0 = [0.05,-0.05,0.1]$, $v_0 = [1.0,-0.5,0.2]$, $Q_0 = [0.4,0.3,-0.2]$, $T = 10.0$, $h_{\\mathrm{large}} = 0.5$, $h_{\\mathrm{small}} = 0.25$.\n\nFor each case, compute:\n- The observed order $p$ as a float evaluated from the position error ratio at time $T$ between $h_{\\mathrm{large}}$ and $h_{\\mathrm{small}}$, using a high-accuracy reference solution of the full Wong equations (not the split integrator).\n- The maximum absolute deviation of the color-charge norm $\\|Q(t)\\|$ from $\\|Q(0)\\|$ over the trajectory using the split integrator with $h_{\\mathrm{large}}$.\n- The maximum absolute kinetic energy drift $\\left|\\tfrac{1}{2} m \\|v(t)\\|^2 - \\tfrac{1}{2} m \\|v(0)\\|^2\\right|$ over the trajectory using the split integrator with $h_{\\mathrm{large}}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry corresponds to one test case and is itself a list of three floats in the order $[p,\\Delta\\|Q\\|,\\Delta E]$. For example, the output format must be like $[[p_1,\\Delta\\|Q\\|_1,\\Delta E_1],[p_2,\\Delta\\|Q\\|_2,\\Delta E_2],[p_3,\\Delta\\|Q\\|_3,\\Delta E_3],[p_4,\\Delta\\|Q\\|_4,\\Delta E_4]]$ with all numeric values as decimal floats.",
            "solution": "The problem requires the design, implementation, and analysis of a second-order symplectic integrator for the Wong equations, which describe the motion of a classical particle with position $x \\in \\mathbb{R}^3$, velocity $v \\in \\mathbb{R}^3$, and internal $\\mathfrak{su}(2)$ charge $Q \\in \\mathbb{R}^3$ interacting with a non-Abelian gauge field.\n\nThe provided equations of motion for a constant magnetic field $B$ and a fixed color direction $c$ are:\n$$\n\\frac{dx}{dt} = v\n$$\n$$\nm \\frac{dv}{dt} = (Q \\cdot c) (v \\times B)\n$$\n$$\n\\frac{dQ}{dt} = -\\left(A(x) \\cdot v\\right) (c \\times Q)\n$$\nwhere $A(x) = \\frac{1}{2} B \\times x$ is the vector potential. This system conserves the Hamiltonian $H = \\frac{1}{2} m \\|v\\|^2$ and the Casimir invariant (the magnitude of the charge) $\\|Q\\|^2$.\n\n**1. Derivation of the Symplectic Splitting Method**\n\nA symplectic integrator can be constructed by splitting the dynamics into exactly solvable parts. The problem suggests a splitting based on freezing variables. We decompose the total evolution into two distinct Hamiltonian flows:\n- **Flow A ($\\Phi_A^t$)**: The dynamics of the spatial variables $(x, v)$ with the charge $Q$ held constant.\n- **Flow B ($\\Phi_B^t$)**: The dynamics of the charge $Q$ with the spatial variables $(x, v)$ held constant.\n\nThis corresponds to splitting the vector field $X = (\\dot{x}, \\dot{v}, \\dot{Q})$ into $X = X_A + X_B$, where:\n- $X_A = (v, \\frac{1}{m}(Q \\cdot c)(v \\times B), 0)$\n- $X_B = (0, 0, -\\left(A(x) \\cdot v\\right) (c \\times Q))$\n\nEach of these vector fields can be integrated exactly under the assumption that the variables they do not evolve are treated as fixed parameters during the substep.\n\n**Exact Solution for Flow A**\n\nWith $Q$ constant, the effective charge is $q_{\\text{eff}} = Q \\cdot c$, a fixed scalar. The equations of motion are:\n$$\n\\frac{dx}{dt} = v, \\quad m\\frac{dv}{dt} = q_{\\text{eff}} (v \\times B)\n$$\nThis is the classic problem of a charged particle in a uniform magnetic field. The velocity vector $v$ undergoes gyration around the magnetic field direction. Let $\\hat{B} = B/\\|B\\|$ be the unit vector along the magnetic field. We decompose the initial velocity $v_0$ into components parallel ($v_\\parallel$) and perpendicular ($v_\\perp$) to $B$:\n$v_\\parallel = (v_0 \\cdot \\hat{B}) \\hat{B}$, $v_\\perp = v_0 - v_\\parallel$.\nThe parallel component is constant: $v_\\parallel(t) = v_\\parallel$. The perpendicular component rotates in the plane normal to $B$ with the cyclotron frequency $\\omega = \\frac{q_{\\text{eff}} \\|B\\|}{m}$. The velocity at time $t$ is given by:\n$$\nv(t) = v_\\parallel + \\cos(\\omega t) v_\\perp + \\sin(\\omega t) (\\hat{B} \\times v_\\perp)\n$$\nIntegrating the velocity gives the position. The exact update over a time step $\\Delta t$ is:\n$$\nx(\\Delta t) = x_0 + v_\\parallel \\Delta t + \\frac{\\sin(\\omega \\Delta t)}{\\omega} v_\\perp + \\frac{1-\\cos(\\omega \\Delta t)}{\\omega} (\\hat{B} \\times v_\\perp)\n$$\nIn the special case where $\\omega = 0$ (either $B=0$ or $q_{\\text{eff}}=0$), the motion is rectilinear: $v(\\Delta t) = v_0$ and $x(\\Delta t) = x_0 + v_0 \\Delta t$. These formulas are obtained by taking the limit $\\omega \\to 0$.\n\n**Exact Solution for Flow B**\n\nWith $x$ and $v$ held constant, the scalar term $k = A(x) \\cdot v = \\left(\\frac{1}{2} B \\times x\\right) \\cdot v$ is a constant. The equation of motion for $Q$ is:\n$$\n\\frac{dQ}{dt} = -k (c \\times Q) = k (Q \\times c)\n$$\nThis describes a rotation of the vector $Q$ around the axis $c$ (which is a unit vector) with a constant angular velocity $k$. The rotation angle over a time step $\\Delta t$ is $\\theta = k \\Delta t$. The updated charge vector $Q(\\Delta t)$ can be found using Rodrigues' rotation formula:\n$$\nQ(\\Delta t) = \\cos(\\theta) Q_0 + (1-\\cos(\\theta))(Q_0 \\cdot c)c + \\sin(\\theta)(c \\times Q_0)\n$$\nThis flow is a rotation, so it exactly preserves the norm $\\|Q\\|$.\n\n**Second-Order Symmetric Composition (Strang Splitting)**\n\nTo construct a second-order accurate method, we symmetrically compose these flows. A common choice is the ABA or Strang splitting scheme. For a time step $h$, the update from state $Z_n = (x_n, v_n, Q_n)$ to $Z_{n+1}$ is:\n$$\nZ_{n+1} = \\Phi_A^{h/2} \\circ \\Phi_B^h \\circ \\Phi_A^{h/2} (Z_n)\n$$\nThe algorithm proceeds in three steps:\n1.  **A-step (half)**: Evolve $(x_n, v_n)$ to an intermediate state $(x^*, v^*)$ over time $h/2$ using Flow A with the charge $Q_n$.\n2.  **B-step (full)**: Evolve $Q_n$ to $Q_{n+1}$ over time $h$ using Flow B, with the spatial variables frozen at the intermediate state $(x^*, v^*)$.\n3.  **A-step (half)**: Evolve $(x^*, v^*)$ to the final state $(x_{n+1}, v_{n+1})$ over time $h/2$ using Flow A, but now with the updated charge $Q_{n+1}$.\n\nThis method is symplectic by construction, as it is a composition of exact Hamiltonian flows. It is symmetric in time, which guarantees second-order accuracy in $h$.\n\n**2. Implementation and Analysis**\n\nThe implementation requires functions for each flow and a main loop to execute the splitting scheme. For analysis, we need:\n-   A high-accuracy reference solution, obtained using a standard high-order ODE solver like `scipy.integrate.solve_ivp` with stringent tolerances.\n-   **Observed Order ($p$)**: Calculated by comparing the final position error for two different step sizes, $h$ and $h/2=h_{\\text{small}}$. Since the error $e(h) \\approx C h^p$, we have $p \\approx \\log_2(e(h)/e(h/2))$.\n-   **Casimir Conservation ($\\Delta\\|Q\\|$)**: The B-step exactly preserves $\\|Q\\|$. Therefore, the composed method should also preserve $\\|Q\\|$ to machine precision. We measure the maximum deviation $|\\,\\|Q(t)\\| - \\|Q(0)\\|\\,|$ over the simulation.\n-   **Energy Conservation ($\\Delta E$)**: The total Hamiltonian $H = \\frac{1}{2}m\\|v\\|^2$ is the kinetic energy. As a symplectic method, the integrator should exhibit excellent long-term energy conservation, meaning the energy will oscillate around its initial value with a small amplitude, rather than drifting. We measure the maximum drift $|\\,E(t) - E(0)\\,|$ over the simulation.\n\nThe specific test cases will probe the integrator's behavior in general scenarios, degenerate cases ($B=0$, $v \\parallel B$), and for long-time stability.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the Wong equations problem for a suite of test cases.\n    It implements a second-order symplectic integrator based on Strang splitting\n    and analyzes its order, Casimir conservation, and energy drift.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1: general constant-field \"happy path\"\n        {'m': 1.0, 'B': np.array([0.0, 0.0, 1.0]), 'c': np.array([0.0, 0.0, 1.0]), \n         'x0': np.array([0.1, -0.2, 0.0]), 'v0': np.array([0.7, 0.0, 0.3]), 'Q0': np.array([0.5, -0.4, 0.2]),\n         'T': 2.0, 'h_large': 0.1, 'h_small': 0.05},\n        # Case 2: zero-field edge case\n        {'m': 1.0, 'B': np.array([0.0, 0.0, 0.0]), 'c': np.array([0.0, 0.0, 1.0]), \n         'x0': np.array([0.1, 0.2, -0.1]), 'v0': np.array([0.3, -0.6, 0.2]), 'Q0': np.array([0.2, 0.1, 0.3]),\n         'T': 1.0, 'h_large': 0.2, 'h_small': 0.1},\n        # Case 3: velocity parallel to field\n        {'m': 1.0, 'B': np.array([0.0, 0.0, 2.0]), 'c': np.array([0.0, 0.0, 1.0]), \n         'x0': np.array([0.0, 0.0, 0.0]), 'v0': np.array([0.0, 0.0, 1.0]), 'Q0': np.array([0.6, -0.1, 0.3]),\n         'T': 3.0, 'h_large': 0.2, 'h_small': 0.1},\n        # Case 4: long-time, larger step stability probe\n        {'m': 1.0, 'B': np.array([0.0, 1.0, 0.5]), 'c': np.array([0.0, 0.0, 1.0]), \n         'x0': np.array([0.05, -0.05, 0.1]), 'v0': np.array([1.0, -0.5, 0.2]), 'Q0': np.array([0.4, 0.3, -0.2]),\n         'T': 10.0, 'h_large': 0.5, 'h_small': 0.25},\n    ]\n\n    # Helper function for Rodrigues' rotation formula\n    def rodrigues(vec, axis, angle):\n        if np.abs(angle) < 1e-15:\n            return vec\n        # Normalize axis to be safe, though c is given as unit vector\n        axis_norm = np.linalg.norm(axis)\n        if axis_norm < 1e-15:\n            return vec\n        k = axis / axis_norm\n        \n        cos_theta = np.cos(angle)\n        sin_theta = np.sin(angle)\n        \n        return (vec * cos_theta + \n                np.cross(k, vec) * sin_theta + \n                k * np.dot(k, vec) * (1 - cos_theta))\n\n    # Flow A: Evolve (x, v) with Q constant\n    def evolve_A(x, v, Q, c, B, m, dt):\n        q_eff = np.dot(Q, c)\n        B_norm = np.linalg.norm(B)\n        \n        if np.abs(q_eff * B_norm) < 1e-15: # Handle linear motion case\n            x_new = x + v * dt\n            v_new = v\n            return x_new, v_new\n\n        omega = q_eff * B_norm / m\n        B_hat = B / B_norm\n        \n        v_parallel = np.dot(v, B_hat) * B_hat\n        v_perp = v - v_parallel\n        \n        omega_dt = omega * dt\n        cos_odt = np.cos(omega_dt)\n        sin_odt = np.sin(omega_dt)\n        \n        # Evolve v\n        v_perp_new = v_perp * cos_odt + np.cross(B_hat, v_perp) * sin_odt\n        v_new = v_parallel + v_perp_new\n        \n        # Evolve x by integrating v(t)\n        x_new = (x + v_parallel * dt +\n                 (v_perp * sin_odt) / omega +\n                 (np.cross(B_hat, v_perp) * (1 - cos_odt)) / omega)\n\n        return x_new, v_new\n        \n    # Flow B: Evolve Q with (x, v) constant\n    def evolve_B(x, v, Q, c, B, dt):\n        A = 0.5 * np.cross(B, x)\n        k = np.dot(A, v)\n        theta = k * dt\n        \n        Q_new = rodrigues(Q, c, theta)\n        return Q_new\n\n    def run_split_integrator(m, B, c, x0, v0, Q0, T, h):\n        n_steps = int(round(T / h))\n        x, v, Q = np.copy(x0), np.copy(v0), np.copy(Q0)\n        \n        Q_norm_0 = np.linalg.norm(Q0)\n        E_kin_0 = 0.5 * m * np.dot(v0, v0)\n        \n        max_delta_Q_norm = 0.0\n        max_delta_E_kin = 0.0\n        \n        for _ in range(n_steps):\n            # First half-step for (x, v)\n            x_star, v_star = evolve_A(x, v, Q, c, B, m, h/2.0)\n            \n            # Full step for Q\n            Q_new = evolve_B(x_star, v_star, Q, c, B, h)\n            \n            # Second half-step for (x, v) with updated Q\n            x_new, v_new = evolve_A(x_star, v_star, Q_new, c, B, m, h/2.0)\n            \n            x, v, Q = x_new, v_new, Q_new\n            \n            # Update diagnostics\n            delta_Q_norm = np.abs(np.linalg.norm(Q) - Q_norm_0)\n            if delta_Q_norm > max_delta_Q_norm:\n                max_delta_Q_norm = delta_Q_norm\n            \n            E_kin_t = 0.5 * m * np.dot(v, v)\n            delta_E_kin = np.abs(E_kin_t - E_kin_0)\n            if delta_E_kin > max_delta_E_kin:\n                max_delta_E_kin = delta_E_kin\n        \n        return x, max_delta_Q_norm, max_delta_E_kin\n\n    # ODE system for scipy's high-accuracy solver\n    def ode_system(t, y, m, B, c):\n        x = y[0:3]\n        v = y[3:6]\n        Q = y[6:9]\n        \n        dxdt = v\n        dvdt = (np.dot(Q, c) * np.cross(v, B)) / m\n        \n        A = 0.5 * np.cross(B, x)\n        k = np.dot(A, v)\n        dQdt = -k * np.cross(c, Q)\n        \n        return np.concatenate((dxdt, dvdt, dQdt))\n\n    results = []\n    for case in test_cases:\n        m, B, c, x0, v0, Q0, T = case['m'], case['B'], case['c'], case['x0'], case['v0'], case['Q0'], case['T']\n        h_large, h_small = case['h_large'], case['h_small']\n        \n        y0 = np.concatenate((x0, v0, Q0))\n        \n        # High-accuracy reference solution\n        ref_sol = solve_ivp(\n            ode_system, (0, T), y0, args=(m, B, c), \n            method='DOP853', rtol=1e-13, atol=1e-13\n        )\n        x_ref_final = ref_sol.y[0:3, -1]\n        \n        # Run with h_large\n        x_large_final, delta_Q, delta_E = run_split_integrator(m, B, c, x0, v0, Q0, T, h_large)\n        err_large = np.linalg.norm(x_large_final - x_ref_final)\n        \n        # Run with h_small\n        x_small_final, _, _ = run_split_integrator(m, B, c, x0, v0, Q0, T, h_small)\n        err_small = np.linalg.norm(x_small_final - x_ref_final)\n        \n        # Compute observed order p\n        if err_large < 1e-14 or err_small < 1e-14:\n            # If the error is near machine precision, the method is essentially exact for this case.\n            # Order is theoretically infinite, but we assign 2.0 as the method is at least second-order.\n            p = 2.0 \n        else:\n            p = np.log2(err_large / err_small)\n\n        results.append([p, delta_Q, delta_E])\n\n    # Convert results to a string in the specified format\n    result_str = \"[\" + \",\".join([f\"[{p:.6f},{dq:.6e},{de:.6e}]\" for p, dq, de in results]) + \"]\"\n    print(result_str)\n\nsolve()\n\n```"
        }
    ]
}