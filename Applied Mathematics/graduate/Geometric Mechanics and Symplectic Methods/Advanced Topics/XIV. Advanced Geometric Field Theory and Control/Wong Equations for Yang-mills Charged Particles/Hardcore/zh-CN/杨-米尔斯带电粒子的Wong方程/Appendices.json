{
    "hands_on_practices": [
        {
            "introduction": "对任何动力系统而言，识别其守恒量都是理解其行为的关键第一步。对于像带有杨-米尔斯荷 $Q$ 的粒子这样具有内禀自由度的系统，这些守恒量与内禀空间的对称性紧密相关，而这种对称性由李群描述。本练习  旨在从王氏方程的几何结构出发，直接识别这些被称为卡西米尔不变量 $C(Q)$ 的守恒量，并练习处理李代数、余伴随轨道以及像基灵型这样的伴随不变形式等基本概念。",
            "id": "3784787",
            "problem": "考虑一个杨-米尔斯（YM）带电粒子在具有局部坐标 $x^{\\mu}(t)$ 的黎曼构型流形上运动，该粒子与一个背景规范势 $A_{\\mu}(x)$ 相互作用，此规范势的值取于一个紧连通李群 $G$ 的李代数 $\\mathfrak{g}$ 中。该粒子携带一个内禀荷 $Q(t)\\in \\mathfrak{g}$，其内禀动力学由 Wong 方程决定：\n$$\n\\dot{Q}(t)+\\big[A_{\\mu}(x(t))\\,\\dot{x}^{\\mu}(t),\\,Q(t)\\big]=0,\n$$\n其中 $[\\,\\cdot\\,,\\,\\cdot\\,]$ 表示 $\\mathfrak{g}$ 上的李括号。在几何力学中，$\\mathfrak{g}$ 上的内禀动力学 $Q(t)$ 可以通过 $\\mathfrak{g}^{\\ast}$ 上的李-泊松（LP）结构，经由一个不变配对来描述，而与所有其他函数泊松对易的函数被称为卡西米尔不变量。\n\n从由一个 $\\mathrm{Ad}$-不变的非退化双线性形式 $\\kappa:\\mathfrak{g}\\times\\mathfrak{g}\\to\\mathbb{R}$ 导出的 $\\mathfrak{g}^{\\ast}$ 上的李-泊松括号的基本定义出发，并视 Wong 方程为 $Q(t)$ 的余伴随输运，完成以下任务：\n\n1. 识别并论证在 $Q(t)$ 的 Wong 演化过程中的一类守恒量 $C_{k}(Q)$（卡西米尔不变量），解释为什么它们随时间保持不变。\n2. 对于 $\\mathfrak{g}=\\mathfrak{su}(2)$ 的情况，固定一个基 $\\{T_{a}\\}_{a=1}^{3}$，其结构常数为 $f_{ab}{}^{c}=\\epsilon_{abc}$，满足 $[T_{a},T_{b}]=\\epsilon_{abc}\\,T_{c}$，并定义基灵型 $\\kappa(X,Y)=\\mathrm{Tr}\\big(\\mathrm{ad}_{X}\\,\\mathrm{ad}_{Y}\\big)$，其中 $\\mathrm{ad}_{X}(Y)=[X,Y]$。记 $Q=Q^{a}T_{a}$，并用分量 $\\{Q^{a}\\}_{a=1}^{3}$ 显式地计算二次卡西米尔不变量 $C_{2}(Q)=\\kappa(Q,Q)$。\n\n请用 $Q$ 的分量 $\\{Q^{a}\\}$ 将你的最终答案表示为单个闭式解析表达式。无需四舍五入。",
            "solution": "该问题是有效的。其科学基础在于几何力学和规范理论的原理，特别是关于杨-米尔斯带电粒子的动力学。该问题提法恰当、客观，并提供了进行严格推导所需的所有信息。\n\n该问题需要一个分为两部分的解答。首先，识别并论证在 Wong 演化下卡西米尔不变量的守恒性。其次，显式地计算李代数 $\\mathfrak{su}(2)$ 的二次卡西米尔不变量。\n\n### 第一部分：卡西米尔不变量的守恒性\n\n内禀荷 $Q(t) \\in \\mathfrak{g}$ 的动力学由 Wong 方程决定：\n$$\n\\dot{Q}(t) + \\big[A_{\\mu}(x(t))\\,\\dot{x}^{\\mu}(t),\\,Q(t)\\big] = 0\n$$\n我们定义李代数值函数 $\\Omega(t) = A_{\\mu}(x(t))\\,\\dot{x}^{\\mu}(t)$。使用此定义，Wong 方程可以写成更紧凑的形式：\n$$\n\\dot{Q}(t) = -[-\\Omega(t), Q(t)] = [\\Omega(t), Q(t)]\n$$\n此方程是李群 $G$ 在其李代数 $\\mathfrak{g}$ 上伴随作用的无穷小形式。其解可以形式上写为：\n$$\nQ(t) = \\mathrm{Ad}_{g(t)}(Q(0))\n$$\n其中 $g(t) \\in G$ 是通过沿粒子世界线对无穷小生成元 $\\Omega(t)$ 积分得到的群元，具体为 $g(t) = \\mathcal{P}\\exp\\left(\\int_0^t \\Omega(\\tau) d\\tau\\right)$，其中 $\\mathcal{P}$ 表示路径排序算符。这意味着 $Q(t)$ 的时间演化只是其初始值 $Q(0)$ 的伴随轨道内的一条轨迹。\n\n问题指明，内禀动力学可以通过对偶空间 $\\mathfrak{g}^*$ 上的李-泊松结构来描述。李代数 $\\mathfrak{g}$ 及其对偶 $\\mathfrak{g}^*$ 通过一个非退化、Ad-不变的双线性形式 $\\kappa$（例如基灵型）来等同。在这种等同下，$\\mathfrak{g}$ 上的伴随作用 $\\mathrm{Ad}_g$ 对应于 $\\mathfrak{g}^*$ 上的余伴随作用 $\\mathrm{Ad}^*_{g^{-1}}$。因此，$Q(t)$ 的演化（被视为 $\\mathfrak{g}^*$ 的一个元素）被限制在单个余伴随轨道上。\n\n根据定义，卡西米尔函数 $C(Q)$ 是 $\\mathfrak{g}$ （或 $\\mathfrak{g}^*$）上的函数，其在群 $G$ 的（余）伴随作用下是不变的。也就是说，对于任何 $g \\in G$：\n$$\nC(\\mathrm{Ad}_g(Q)) = C(Q)\n$$\n由于 Wong 演化规定了 $Q(t) = \\mathrm{Ad}_{g(t)}(Q(0))$，沿轨迹 $Q(t)$ 计算的任何卡西米尔函数的值为：\n$$\nC(Q(t)) = C(\\mathrm{Ad}_{g(t)}(Q(0)))\n$$\n根据卡西米尔不变量的不变性，这变为：\n$$\nC(Q(t)) = C(Q(0)) = \\text{常数}\n$$\n因此，所有卡西米尔函数都是沿荷 $Q(t)$ 的 Wong 演化的守恒量（运动常数）。一个无穷小论证是，卡西米尔不变量的时间导数为零：\n$$\n\\frac{d}{dt}C(Q(t)) = \\left\\langle \\frac{\\delta C}{\\delta Q}, \\dot{Q}(t) \\right\\rangle = \\left\\langle \\frac{\\delta C}{\\delta Q}, [\\Omega(t), Q(t)] \\right\\rangle\n$$\n其中 $\\langle \\cdot, \\cdot \\rangle$ 表示 $\\mathfrak{g}^*$ 和 $\\mathfrak{g}$ 之间的配对。一个函数 $C$ 是卡西米尔不变量的无穷小条件恰好是，对于所有 $\\xi \\in \\mathfrak{g}$，都有 $\\langle \\frac{\\delta C}{\\delta Q}, [\\xi, Q] \\rangle = 0$。由于对所有 $t$ 都有 $\\Omega(t) \\in \\mathfrak{g}$，立即推得 $\\frac{d}{dt}C(Q(t)) = 0$。\n\n这类守恒量，即卡西米尔不变量，是由 $\\mathfrak{g}$ 上的 Ad-不变的对称多重线性形式生成的。对于半单李代数，这些是 $Q$ 分量的多项式，例如对于适当的矩阵表示为 $C_k(Q) = \\mathrm{Tr}(Q^k)$，或更一般地为 $C_p(Q) = I_p(Q, \\dots, Q)$，其中 $I_p$ 是一个本原、对称、Ad-不变的 $p$ 阶张量。\n\n### 第二部分：$\\mathfrak{su}(2)$ 的二次卡西米尔不变量\n\n题目要求我们计算 $\\mathfrak{g} = \\mathfrak{su}(2)$ 的二次卡西米尔不变量 $C_2(Q) = \\kappa(Q, Q)$，其中 $Q = Q^a T_a$ 且 $\\kappa(X,Y) = \\mathrm{Tr}(\\mathrm{ad}_X \\mathrm{ad}_Y)$。基 $\\{T_a\\}_{a=1}^3$ 满足对易关系 $[T_a, T_b] = \\epsilon_{abc} T_c$。结构常数为 $f_{ab}{}^c = \\epsilon_{abc}$。\n\n根据基灵型的双线性，我们可以写出：\n$$\nC_2(Q) = \\kappa(Q^a T_a, Q^b T_b) = Q^a Q^b \\kappa(T_a, T_b)\n$$\n我们必须首先计算基灵型张量的分量 $\\kappa_{ab} = \\kappa(T_a, T_b)$。\n$$\n\\kappa_{ab} = \\mathrm{Tr}(\\mathrm{ad}_{T_a} \\mathrm{ad}_{T_b})\n$$\n算符 $\\mathrm{ad}_{T_a}$ 作用在基矢上为 $\\mathrm{ad}_{T_a}(T_c) = [T_a, T_c] = \\epsilon_{acd} T_d$。因此，$\\mathrm{ad}_{T_a}$ 在基 $\\{T_c\\}$ 中的矩阵表示的矩阵元为 $(M_a)_d{}^c = f_{ac}{}^d = \\epsilon_{acd}$。\n\n复合算符 $\\mathrm{ad}_{T_a} \\mathrm{ad}_{T_b}$ 的矩阵元为：\n$$\n(\\mathrm{ad}_{T_a} \\mathrm{ad}_{T_b})_e{}^c = \\sum_{d=1}^3 (\\mathrm{ad}_{T_a})_e{}^d (\\mathrm{ad}_{T_b})_d{}^c = \\sum_{d=1}^3 f_{ae}{}^d f_{bd}{}^c = \\sum_{d=1}^3 \\epsilon_{aed} \\epsilon_{bdc}\n$$\n迹是其对角元之和：\n$$\n\\kappa_{ab} = \\mathrm{Tr}(\\mathrm{ad}_{T_a} \\mathrm{ad}_{T_b}) = \\sum_{c=1}^3 (\\mathrm{ad}_{T_a} \\mathrm{ad}_{T_b})_c{}^c = \\sum_{c=1}^3 \\sum_{d=1}^3 \\epsilon_{acd} \\epsilon_{bdc}\n$$\n虽然可以使用 Levi-Civita 符号的恒等式来计算这个和，但一个更直接和不容易出错的方法是使用伴随表示的显式矩阵。对于 $\\mathfrak{su}(2)$，$\\mathrm{ad}_{T_a}$ 的矩阵表示 $(M_a)_c{}^b = \\epsilon_{acb}$ 是：\n$M_1 = \\begin{pmatrix} 0  0  0 \\\\ 0  0  -1 \\\\ 0  1  0 \\end{pmatrix}$, $M_2 = \\begin{pmatrix} 0  0  1 \\\\ 0  0  0 \\\\ -1  0  0 \\end{pmatrix}$, $M_3 = \\begin{pmatrix} 0  -1  0 \\\\ 1  0  0 \\\\ 0  0  0 \\end{pmatrix}$。\n直接计算矩阵乘积的迹：\n$\\mathrm{Tr}(M_1^2) = \\mathrm{Tr}\\begin{pmatrix} 0  0  0 \\\\ 0  -1  0 \\\\ 0  0  -1 \\end{pmatrix} = -2$。\n$\\mathrm{Tr}(M_2^2) = \\mathrm{Tr}\\begin{pmatrix} -1  0  0 \\\\ 0  0  0 \\\\ 0  0  -1 \\end{pmatrix} = -2$。\n$\\mathrm{Tr}(M_3^2) = \\mathrm{Tr}\\begin{pmatrix} -1  0  0 \\\\ 0  -1  0 \\\\ 0  0  0 \\end{pmatrix} = -2$。\n对于 $a \\neq b$, $\\mathrm{Tr}(M_a M_b) = 0$。例如, $\\mathrm{Tr}(M_1 M_2) = \\mathrm{Tr}\\begin{pmatrix} 0  0  0 \\\\ 1  0  0 \\\\ 0  0  0 \\end{pmatrix} = 0$。\n因此，我们确认了 $\\kappa_{ab} = \\kappa(T_a, T_b) = -2\\delta_{ab}$。\n\n现在我们将此结果代回 $C_2(Q)$ 的表达式中：\n$$\nC_2(Q) = Q^a Q^b \\kappa_{ab} = Q^a Q^b (-2\\delta_{ab}) = -2 \\sum_{a=1}^3 Q^a Q^a\n$$\n这可以简化为：\n$$\nC_2(Q) = -2 \\left( (Q^1)^2 + (Q^2)^2 + (Q^3)^2 \\right)\n$$\n此表达式是用荷矢量 $Q$ 的分量 $\\{Q^a\\}$ 表示的 $\\mathfrak{su}(2)$ 的二次卡西米尔不变量。",
            "answer": "$$\\boxed{-2\\left( (Q^1)^2 + (Q^2)^2 + (Q^3)^2 \\right)}$$"
        },
        {
            "introduction": "在掌握了理论基础之后，我们将这些抽象概念应用于一个具体的物理问题。本练习  将王氏方程应用于一个在特殊配置的恒定非阿贝尔磁场中运动的粒子。其目标是展示在特定条件下，一个复杂的非阿贝尔系统如何可以简化为一个更简单、可积的问题，类似于带电粒子在电磁场中为人所熟知的回旋运动。这个练习旨在锻炼识别对称性、寻找运动常数并用它们来分析系统动力学的技能，最终计算出一个作用量 $J$。",
            "id": "3784830",
            "problem": "考虑一个质量为 $m$、非阿贝尔荷为 $Q \\in \\mathfrak{su}(2)^{\\ast}$ 的经典点粒子，在 $\\mathbb{R}^{3}$ 中运动，并与二次特殊酉群 (SU(2)) 的一个固定背景杨-米尔斯 (YM) 规范势 $A_{i}^{a}(x)$ 耦合。色荷分量记为 $Q^{a}$，$\\mathfrak{su}(2)$ 的结构常数为 $f^{abc}=\\epsilon^{abc}$。相空间为 $T^{\\ast}\\mathbb{R}^{3}\\times\\mathcal{O}_{C}$，其中 $\\mathcal{O}_{C}$ 是 $\\mathfrak{su}(2)^{\\ast}$ 上卡西米尔不变量 $C=|Q|^{2}$ 固定的余伴随轨道，动力学遵循王氏方程 (Wong equations)\n$$\nm\\,\\ddot{x}^{i} = Q^{a}\\,F_{ij}^{a}(x)\\,\\dot{x}^{j},\\qquad \\dot{Q}^{a} = - f^{abc}\\,A_{i}^{b}(x)\\,\\dot{x}^{i}\\,Q^{c},\n$$\n磁场强度为 $F_{ij}^{a}=\\partial_{i}A_{j}^{a}-\\partial_{j}A_{i}^{a}+f^{abc}A_{i}^{b}A_{j}^{c}$。哈密顿量是用规范协变动量 $\\Pi_{i}=p_{i}-Q^{a}A_{i}^{a}$ 表示的动能：\n$$\nH(x,p,Q)=\\frac{1}{2m}\\,\\Pi_{i}\\Pi_{i}.\n$$\n\n假设背景场具有一个大小为 $B0$ 的恒定非阿贝尔磁场，其方向沿空间 $z$ 轴和色方向 $a=3$，在对称规范下实现为\n$$\nA_{x}^{3}(x,y,z) = -\\frac{B}{2}\\,y,\\qquad A_{y}^{3}(x,y,z) = \\frac{B}{2}\\,x,\\qquad A_{z}^{3}(x,y,z) = 0,\\qquad A_{i}^{1}=A_{i}^{2}=0,\n$$\n使得 $F_{xy}^{3}=B$ 且 $F_{ij}^{a}$ 的所有其他分量为零。取初始数据为 $Q^{1}=Q^{2}=0$ 和 $Q^{3}0$，以使色荷与固定的色方向保持对齐。\n\n从王氏方程和正则加 Kirillov–Kostant–Souriau 辛观点出发，分析在此背景下，对于固定的卡西米尔不变量 $C$ 和固定的 $Q^{3}0$，空间动力学的可积性。具体而言：\n\n- 在使用与沿 $z$ 轴平移相关的运动常数以及 $xy$ 平面中的导心不变量后，确定约化自由度，并论证剩余的非平凡运动是横向平面内的周期性回旋运动。\n- 将横向能量 $E_{\\perp}$ 定义为与 $xy$ 平面相关的能量部分，并用 $H$ 和 $p_{z}$ 表示。然后，计算周期性横向运动的作用量变量 $J_{\\perp}$，用 $E_{\\perp}$、$m$、$B$ 和 $Q^{3}$ 表示。\n\n你的最终答案必须是 $J_{\\perp}$ 关于 $H$、$p_{z}$、$m$、$B$ 和 $Q^{3}$ 的单一闭式解析表达式。无需进行数值计算，也无需四舍五入。最终的方框表达式中不要包含单位。",
            "solution": "出发点是经典杨-米尔斯带电粒子在固定背景场中的王氏方程，以及使用规范协变动量的哈密顿表述。选择的规范场具有恒定的场强 $F_{xy}^{3}=B$，所有其他分量为零，且势在 $(x,y)$ 中是线性的：\n$$\nA_{x}^{3}=-\\frac{B}{2}\\,y,\\qquad A_{y}^{3}=\\frac{B}{2}\\,x,\\qquad A_{z}^{3}=0,\\qquad A_{i}^{1}=A_{i}^{2}=0.\n$$\n场强是恒定的且纯磁性的。色荷的王氏方程为\n$$\n\\dot{Q}^{a}=-f^{abc}A_{i}^{b}\\dot{x}^{i}Q^{c}.\n$$\n当 $A_{i}^{b}$ 仅在 $b=3$ 时非零，且初始 $Q$ 与 $a=3$ 方向对齐（$Q^{1}=Q^{2}=0$, $Q^{3}0$）时，对于 $a=1$ 我们有，\n$$\n\\dot{Q}^{1}=-f^{1\\,3\\,c}A_{i}^{3}\\dot{x}^{i}Q^{c}=-\\epsilon^{13c}A_{i}^{3}\\dot{x}^{i}Q^{c}.\n$$\n由于除非 $c=3$，否则 $Q^{c}$ 为零，且 $\\epsilon^{133}=0$，可得 $\\dot{Q}^{1}=0$。类似的论证得出 $\\dot{Q}^{2}=0$，而对于 $a=3$，\n$$\n\\dot{Q}^{3}=-f^{3\\,3\\,c}A_{i}^{3}\\dot{x}^{i}Q^{c}=-\\epsilon^{33c}(\\cdots)=0,\n$$\n因此 $Q^{3}$ 是一个运动常数。于是，对于所选的背景和初始对齐，内部（色）动力学被冻结为 $Q^{3}=\\text{const}0$，空间力简化为有效电荷为 $Q^{3}$ 的阿贝尔洛伦兹力：\n$$\nm\\,\\ddot{x}^{i}=Q^{3}\\,F_{ij}^{3}\\,\\dot{x}^{j}.\n$$\n当 $F_{xy}^{3}=B$ 且按惯例将磁场沿 $\\hat{z}$ 方向识别时，空间动力学分解为：\n- 沿 $z$ 轴的自由运动，因为 $F_{iz}^{a}=0$ 意味着 $m\\,\\ddot{z}=0$，所以 $p_{z}=m\\,\\dot{z}$ 是守恒的。\n- 由恒定磁场引起的在 $xy$ 平面内的匀速圆周运动。\n\n引入规范协变动量\n$$\n\\Pi_{x}=p_{x}-Q^{3}A_{x}^{3}=p_{x}+\\frac{Q^{3}B}{2}\\,y,\\qquad\n\\Pi_{y}=p_{y}-Q^{3}A_{y}^{3}=p_{y}-\\frac{Q^{3}B}{2}\\,x,\\qquad\n\\Pi_{z}=p_{z},\n$$\n和哈密顿量\n$$\nH=\\frac{1}{2m}\\left(\\Pi_{x}^{2}+\\Pi_{y}^{2}+\\Pi_{z}^{2}\\right).\n$$\n因为 $A_{z}^{3}=0$ 且没有场作用于 $z$ 方向，纵向运动是自由的且 $p_{z}$ 为常数，所以横向能量为\n$$\nE_{\\perp}=H-\\frac{p_{z}^{2}}{2m}.\n$$\n平面运动的有效回旋频率 $\\omega$ 由洛伦兹力定律 $m\\,\\ddot{\\boldsymbol{r}}=\\dot{\\boldsymbol{r}}\\times (Q^{3}\\boldsymbol{B})$（其中 $\\boldsymbol{B}=B\\,\\hat{z}$）确定，得到\n$$\n\\omega=\\frac{Q^{3}\\,B}{m}.\n$$\n根据假设 $Q^{3}0$ 和 $B0$，因此 $\\omega0$。通过导心不变量来约化平面动力学是方便的。定义导心坐标 $(X,Y)$ 为\n$$\nX = x - \\frac{\\Pi_{y}}{Q^{3}B},\\qquad Y = y + \\frac{\\Pi_{x}}{Q^{3}B},\n$$\n它们是均匀场下的运动常数（它们生成磁平移对称性）。非平凡的周期动力学发生在相对坐标中\n$$\n\\xi = x - X,\\qquad \\eta = y - Y,\n$$\n其运动方程为\n$$\n\\dot{\\xi}=\\omega\\,\\eta,\\qquad \\dot{\\eta}=-\\omega\\,\\xi.\n$$\n这些是一个单自由度周期系统（等效于限制在单个旋转简正模上的平面谐振子）的方程，具有守恒的横向能量\n$$\nE_{\\perp}=\\frac{m}{2}\\left(\\dot{\\xi}^{2}+\\dot{\\eta}^{2}\\right)\n=\\frac{m\\omega^{2}}{2}\\left(\\xi^{2}+\\eta^{2}\\right),\n$$\n和周期 $T=2\\pi/\\omega$。与此周期运动相关的作用量变量 $J_{\\perp}$ 可以从其对于单自由度周期系统的定义计算，\n$$\nJ_{\\perp}=\\frac{1}{2\\pi}\\oint p_{\\text{eff}}\\,dq_{\\text{eff}},\n$$\n或者，更直接地，使用频率为 $\\omega$ 的单个周期模的标准关系式，\n$$\nJ_{\\perp}=\\frac{E_{\\perp}}{\\omega}.\n$$\n将 $E_{\\perp}$ 和 $\\omega$ 用不变量 $H$ 和 $p_{z}$ 以及参数 $m$、$B$ 和 $Q^{3}$ 表示，得到\n$$\nJ_{\\perp}=\\frac{H-\\frac{p_{z}^{2}}{2m}}{\\frac{Q^{3}B}{m}}=\\frac{m}{Q^{3}B}\\left(H-\\frac{p_{z}^{2}}{2m}\\right).\n$$\n\n关于可积性，对于固定的卡西米尔不变量 $C=|Q|^{2}$ 和对齐的 $Q^{3}0$，系统在均匀场中拥有不变量 $(H,p_{z},X,Y)$，其泊松对易的子集适合用于约化。通过两个导心不变量 $(X,Y)$ 和平凡的纵向平移（固定 $p_{z}$）进行约化后，剩余的非平凡横向运动是周期的，并容许作用量-角度变量 $(J_{\\perp},\\theta_{\\perp})$，其中 $J_{\\perp}$ 如上所示，$\\theta_{\\perp}$ 是以速率 $\\dot{\\theta}_{\\perp}=\\omega$ 前进的回旋相位。因此，周期性横向运动的作用量变量的显式表达式就是上面显示的公式。",
            "answer": "$$\\boxed{\\frac{m}{Q^{3}B}\\left(H-\\frac{p_{z}^{2}}{2m}\\right)}$$"
        },
        {
            "introduction": "现实中，大多数涉及王氏方程的问题都无法解析求解，这使得数值方法变得必不可少。最后的这个练习  介绍了几何积分这一强大思想，特别是利用辛可分方法来构建一个能保持相空间内在几何结构的数值算法。任务包括推导积分格式、编程实现并分析其性能，从而为几何力学的计算方面提供实践经验，并确保模拟结果的长期保真度。",
            "id": "3784823",
            "problem": "一个在三维物理空间中运动的杨-米尔斯（Yang–Mills）带电粒子与一个非阿贝尔规范场相互作用，其动力学可以使用几何力学和辛方法在一个余切丛与一个余伴随轨道的乘积上进行表述。考虑一个粒子，其位置为 $x \\in \\mathbb{R}^3$，正则动量为 $p \\in \\mathbb{R}^3$，内禀色荷为 $Q \\in \\mathfrak{su}(2) \\cong \\mathbb{R}^3$。设规范群为2次特殊酉群（SU(2)）。您应使用的基本理论基础包括：余切丛上的哈密顿力学、带有其 Kirillov–Kostant–Souriau 辛形式的余伴随轨道，以及作为半直积相空间上哈密顿系统的杨-米尔斯带电粒子的 Wong 方程。所有量均为无量纲。\n\n任务是为 Wong 方程设计一个辛积分器，方法是将哈密顿流分裂为两部分：一部分在保持 $Q$ 不变的情况下推进 $(x,p)$ 变量，另一部分在保持 $(x,p)$ 不变的情况下推进 $Q$。您的积分器必须从第一性原理构建，不使用任何快捷公式，并且您必须分析其阶数和稳定性。\n\n为使问题在计算上可行且在科学上现实，请在以下物理一致的设定中进行。假设物理空间中存在一个由磁场矢量 $B \\in \\mathbb{R}^3$ 表示的恒定非阿贝尔磁场，以及一个长度为单位的固定色方向 $c \\in \\mathbb{R}^3$，它指定了非阿贝尔规范势与 $c$ 对齐。规范势 $A(x) \\in \\mathbb{R}^3$ 定义为 $A(x) = \\tfrac{1}{2}\\, B \\times x$，在物理空间中，且在色空间中与 $c$ 对齐。不存在电场。粒子的质量为 $m \\in \\mathbb{R}_{0}$。在此设定下，Wong 方程可以表示为一个关于 $(x,v,Q)$ 的耦合常微分方程（ODE）系统，其中 $v \\in \\mathbb{R}^3$ 是物理速度：\n$$\nm\\, \\dfrac{dv}{dt} = (Q \\cdot c)\\, v \\times B \\qquad \\text{以及} \\qquad \\dfrac{dx}{dt} = v\n$$\n$$\n\\dfrac{dQ}{dt} = -\\big(A(x) \\cdot v\\big)\\, c \\times Q\n$$\n\n您的目标是：\n1. 从上述基本理论基础出发，将哈密顿流推导出一个辛分裂，分解为一个冻结 $Q$ 的 $(x,p)$ 部分和一个冻结 $(x,p)$ 的 $Q$ 部分。通过对这些流进行对称复合，构造一个二阶精度的方法。清晰地解释在这个恒定场设定下，每个分裂部分的精确流是如何获得的。\n2. 将所得方法实现为一个程序，该程序使用均匀的时间步长 $h \\in \\mathbb{R}_{0}$ 将 $(x,v,Q)$ 从初始条件推进到最终时间 $T \\in \\mathbb{R}_{0}$，步数 $N \\in \\mathbb{N}$ 为整数，使得 $N h = T$ 精确成立。对于 $(x,p)$ 部分，在子步中 $Q$ 固定的情况下，使用均匀磁场下的精确解。对于 $Q$ 部分，在子步中 $(x,v)$ 冻结的情况下，使用由标量 $\\big(A(x) \\cdot v\\big)$ 生成的精确余伴随作用（即在色空间中绕轴 $c$ 的旋转）。\n3. 通过以下方式分析该方法的观测阶数和稳定性：\n   - 计算在最终时间 $T$ 时，对于两个步长 $h$ 和 $h/2$ 的位置误差（相对于一个由非辛但精确的积分器计算出的高精度参考解），并通过这些误差的比率估计观测阶数 $p$。\n   - 在数值轨迹上，测量色荷 Casimir 不变量 $\\|Q\\|^2$ 与其初始值的最大偏差。\n   - 在数值轨迹上，测量动能 $\\tfrac{1}{2} m \\|v\\|^2$ 与其初始值的最大漂移。\n\n您的程序必须实现上述积分器，并为以下测试套件生成结果。在所有情况下，将 $c$ 视为单位向量，所有量均为无量纲。对于每种情况，给定 $(m,B,c,x_0,v_0,Q_0,T,h_{\\mathrm{large}},h_{\\mathrm{small}})$：\n- 情况1（一般恒定场“理想路径”）：$m = 1$, $B = [0,0,1]$, $c = [0,0,1]$, $x_0 = [0.1,-0.2,0.0]$, $v_0 = [0.7,0.0,0.3]$, $Q_0 = [0.5,-0.4,0.2]$, $T = 2.0$, $h_{\\mathrm{large}} = 0.1$, $h_{\\mathrm{small}} = 0.05$。\n- 情况2（零场边缘情况）：$m = 1$, $B = [0,0,0]$, $c = [0,0,1]$, $x_0 = [0.1,0.2,-0.1]$, $v_0 = [0.3,-0.6,0.2]$, $Q_0 = [0.2,0.1,0.3]$, $T = 1.0$, $h_{\\mathrm{large}} = 0.2$, $h_{\\mathrm{small}} = 0.1$。\n- 情况3（速度与场平行）：$m = 1$, $B = [0,0,2]$, $c = [0,0,1]$, $x_0 = [0.0,0.0,0.0]$, $v_0 = [0.0,0.0,1.0]$, $Q_0 = [0.6,-0.1,0.3]$, $T = 3.0$, $h_{\\mathrm{large}} = 0.2$, $h_{\\mathrm{small}} = 0.1$。\n- 情况4（长时间、较大步长稳定性探测）：$m = 1$, $B = [0.0,1.0,0.5]$, $c = [0.0,0.0,1.0]$, $x_0 = [0.05,-0.05,0.1]$, $v_0 = [1.0,-0.5,0.2]$, $Q_0 = [0.4,0.3,-0.2]$, $T = 10.0$, $h_{\\mathrm{large}} = 0.5$, $h_{\\mathrm{small}} = 0.25$。\n\n对于每种情况，计算：\n- 观测阶数 $p$，作为一个浮点数，通过在时间 $T$ 时 $h_{\\mathrm{large}}$ 和 $h_{\\mathrm{small}}$ 之间的位置误差比计算得出，使用完整 Wong 方程（而非分裂积分器）的高精度参考解。\n- 使用分裂积分器和 $h_{\\mathrm{large}}$，在轨迹上色荷范数 $\\|Q(t)\\|$ 与 $\\|Q(0)\\|$ 的最大绝对偏差。\n- 使用分裂积分器和 $h_{\\mathrmlarge}$，在轨迹上动能 $\\left|\\tfrac{1}{2} m \\|v(t)\\|^2 - \\tfrac{1}{2} m \\|v(0)\\|^2\\right|$ 的最大绝对漂移。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个条目对应一个测试用例，并且本身是按 $[p,\\Delta\\|Q\\|,\\Delta E]$ 顺序排列的三个浮点数的列表。例如，输出格式必须类似于 $[[p_1,\\Delta\\|Q\\|_1,\\Delta E_1],[p_2,\\Delta\\|Q\\|_2,\\Delta E_2],[p_3,\\Delta\\|Q\\|_3,\\Delta E_3],[p_4,\\Delta\\|Q\\|_4,\\Delta E_4]]$，所有数值均为十进制浮点数。",
            "solution": "该问题要求设计、实现并分析一个用于 Wong 方程的二阶辛积分器。Wong 方程描述了一个经典粒子（位置为 $x \\in \\mathbb{R}^3$，速度为 $v \\in \\mathbb{R}^3$，内禀 $\\mathfrak{su}(2)$ 荷为 $Q \\in \\mathbb{R}^3$）与非阿贝尔规范场相互作用的运动。\n\n对于恒定磁场 $B$ 和固定色方向 $c$，所提供的运动方程为：\n$$\n\\frac{dx}{dt} = v\n$$\n$$\nm \\frac{dv}{dt} = (Q \\cdot c) (v \\times B)\n$$\n$$\n\\frac{dQ}{dt} = -\\left(A(x) \\cdot v\\right) (c \\times Q)\n$$\n其中 $A(x) = \\frac{1}{2} B \\times x$ 是矢量势。该系统保守哈密顿量 $H = \\frac{1}{2} m \\|v\\|^2$ 和 Casimir 不变量（荷的大小）$\\|Q\\|^2$。\n\n**1. 辛分裂方法的推导**\n\n可以通过将动力学分裂成多个精确可解的部分来构造辛积分器。问题建议基于冻结变量进行分裂。我们将总演化分解为两个不同的哈密顿流：\n- **流 A ($\\Phi_A^t$)**：在电荷 $Q$ 保持不变的情况下，空间变量 $(x, v)$ 的动力学。\n- **流 B ($\\Phi_B^t$)**：在空间变量 $(x, v)$ 保持不变的情况下，电荷 $Q$ 的动力学。\n\n这对应于将矢量场 $X = (\\dot{x}, \\dot{v}, \\dot{Q})$ 分裂为 $X = X_A + X_B$，其中：\n- $X_A = (v, \\frac{1}{m}(Q \\cdot c)(v \\times B), 0)$\n- $X_B = (0, 0, -\\left(A(x) \\cdot v\\right) (c \\times Q))$\n\n假设在子步中，每个矢量场不演化的变量被视为固定参数，那么这两个矢量场都可以被精确积分。\n\n**流 A 的精确解**\n\n当 $Q$ 恒定时，有效电荷为一个固定标量 $q_{\\text{eff}} = Q \\cdot c$。运动方程为：\n$$\n\\frac{dx}{dt} = v, \\quad m\\frac{dv}{dt} = q_{\\text{eff}} (v \\times B)\n$$\n这是带电粒子在均匀磁场中的经典问题。速度矢量 $v$ 围绕磁场方向进行回旋运动。令 $\\hat{B} = B/\\|B\\|$ 为沿磁场方向的单位矢量。我们将初始速度 $v_0$ 分解为平行于 $B$ 的分量 ($v_\\parallel$) 和垂直于 $B$ 的分量 ($v_\\perp$)：\n$$\nv_\\parallel = (v_0 \\cdot \\hat{B}) \\hat{B}, \\quad v_\\perp = v_0 - v_\\parallel\n$$\n平行分量是恒定的：$v_\\parallel(t) = v_\\parallel$。垂直分量在垂直于 $B$ 的平面内以回旋频率 $\\omega = \\frac{q_{\\text{eff}} \\|B\\|}{m}$ 旋转。時刻 $t$ 的速度由下式给出：\n$$\nv(t) = v_\\parallel + \\cos(\\omega t) v_\\perp + \\sin(\\omega t) (\\hat{B} \\times v_\\perp)\n$$\n对速度进行积分得到位置。在一个时间步 $\\Delta t$ 内的精确更新为：\n$$\nx(\\Delta t) = x_0 + v_\\parallel \\Delta t + \\frac{\\sin(\\omega \\Delta t)}{\\omega} v_\\perp + \\frac{1-\\cos(\\omega \\Delta t)}{\\omega} (\\hat{B} \\times v_\\perp)\n$$\n在 $\\omega = 0$ 的特殊情况下（$B=0$ 或 $q_{\\text{eff}}=0$），运动是直线运动：$v(\\Delta t) = v_0$ 和 $x(\\Delta t) = x_0 + v_0 \\Delta t$。这些公式是通过取极限 $\\omega \\to 0$ 得到的。\n\n**流 B 的精确解**\n\n当 $x$ 和 $v$ 保持不变时，标量项 $k = A(x) \\cdot v = \\left(\\frac{1}{2} B \\times x\\right) \\cdot v$ 是一个常数。$Q$ 的运动方程为：\n$$\n\\frac{dQ}{dt} = -k (c \\times Q) = k (Q \\times c)\n$$\n这描述了矢量 $Q$ 以恒定角速度 $k$ 围绕轴 $c$（一个单位矢量）的旋转。在一个时间步 $\\Delta t$ 内的旋转角为 $\\theta = k \\Delta t$。更新后的电荷矢量 $Q(\\Delta t)$ 可以使用罗德里格（Rodrigues）旋转公式找到：\n$$\nQ(\\Delta t) = \\cos(\\theta) Q_0 + (1-\\cos(\\theta))(Q_0 \\cdot c)c + \\sin(\\theta)(c \\times Q_0)\n$$\n这个流是一个旋转，因此它能精确地保持范数 $\\|Q\\|$ 不变。\n\n**二阶对称复合（Strang 分裂）**\n\n为了构造一个二阶精度的方法，我们对称地复合这些流。一个常见的选择是 ABA 或 Strang 分裂格式。对于一个时间步 $h$，从状态 $Z_n = (x_n, v_n, Q_n)$到 $Z_{n+1}$ 的更新是：\n$$\nZ_{n+1} = \\Phi_A^{h/2} \\circ \\Phi_B^h \\circ \\Phi_A^{h/2} (Z_n)\n$$\n该算法分三步进行：\n1.  **A步（半步）**：使用流 A，将 $(x_n, v_n)$ 演化到中间状态 $(x^*, v^*)$，时间为 $h/2$，其中电荷为 $Q_n$。\n2.  **B步（全步）**：使用流 B，将 $Q_n$ 演化到 $Q_{n+1}$，时间为 $h$，其中空间变量冻结在中间状态 $(x^*, v^*)$。\n3.  **A步（半步）**：使用流 A，将 $(x^*, v^*)$ 演化到最终状态 $(x_{n+1}, v_{n+1})$，时间为 $h/2$，但此时使用更新后的电荷 $Q_{n+1}$。\n\n该方法通过构造是辛的，因为它是精确哈密顿流的复合。它在时间上是对称的，这保证了其在 $h$上具有二阶精度。\n\n**2. 实现与分析**\n\n实现需要为每个流编写函数，并有一个主循环来执行分裂格式。为了进行分析，我们需要：\n-   一个高精度参考解，使用像 `scipy.integrate.solve_ivp` 这样的标准高阶 ODE 求解器，并设置严格的容差来获得。\n-   **观测阶数 ($p$)**：通过比较两种不同步长 $h$ 和 $h/2=h_{\\text{small}}$ 的最终位置误差来计算。由于误差 $e(h) \\approx C h^p$，我们有 $p \\approx \\log_2(e(h)/e(h/2))$。\n-   **Casimir 不变量守恒 ($\\Delta\\|Q\\|$)**：B 步能精确保持 $\\|Q\\|$。因此，复合方法也应该能将 $\\|Q\\|$ 保持在机器精度内。我们测量模拟过程中 $|\\,\\|Q(t)\\| - \\|Q(0)\\|\\,|$ 的最大偏差。\n-   **能量守恒 ($\\Delta E$)**：总哈密顿量 $H = \\frac{1}{2}m\\|v\\|^2$ 就是动能。作为一个辛方法，该积分器应表现出优秀的长期能量守恒性，即能量会围绕其初始值以小振幅振荡，而不是漂移。我们测量模拟过程中 $|\\,E(t) - E(0)\\,|$ 的最大漂移。\n\n具体的测试用例将探测积分器在一般场景、退化情况（$B=0$, $v \\parallel B$）以及长期稳定性方面的行为。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the Wong equations problem for a suite of test cases.\n    It implements a second-order symplectic integrator based on Strang splitting\n    and analyzes its order, Casimir conservation, and energy drift.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1: general constant-field \"happy path\"\n        {'m': 1.0, 'B': np.array([0.0, 0.0, 1.0]), 'c': np.array([0.0, 0.0, 1.0]), \n         'x0': np.array([0.1, -0.2, 0.0]), 'v0': np.array([0.7, 0.0, 0.3]), 'Q0': np.array([0.5, -0.4, 0.2]),\n         'T': 2.0, 'h_large': 0.1, 'h_small': 0.05},\n        # Case 2: zero-field edge case\n        {'m': 1.0, 'B': np.array([0.0, 0.0, 0.0]), 'c': np.array([0.0, 0.0, 1.0]), \n         'x0': np.array([0.1, 0.2, -0.1]), 'v0': np.array([0.3, -0.6, 0.2]), 'Q0': np.array([0.2, 0.1, 0.3]),\n         'T': 1.0, 'h_large': 0.2, 'h_small': 0.1},\n        # Case 3: velocity parallel to field\n        {'m': 1.0, 'B': np.array([0.0, 0.0, 2.0]), 'c': np.array([0.0, 0.0, 1.0]), \n         'x0': np.array([0.0, 0.0, 0.0]), 'v0': np.array([0.0, 0.0, 1.0]), 'Q0': np.array([0.6, -0.1, 0.3]),\n         'T': 3.0, 'h_large': 0.2, 'h_small': 0.1},\n        # Case 4: long-time, larger step stability probe\n        {'m': 1.0, 'B': np.array([0.0, 1.0, 0.5]), 'c': np.array([0.0, 0.0, 1.0]), \n         'x0': np.array([0.05, -0.05, 0.1]), 'v0': np.array([1.0, -0.5, 0.2]), 'Q0': np.array([0.4, 0.3, -0.2]),\n         'T': 10.0, 'h_large': 0.5, 'h_small': 0.25},\n    ]\n\n    # Helper function for Rodrigues' rotation formula\n    def rodrigues(vec, axis, angle):\n        if np.abs(angle)  1e-15:\n            return vec\n        # Normalize axis to be safe, though c is given as unit vector\n        axis_norm = np.linalg.norm(axis)\n        if axis_norm  1e-15:\n            return vec\n        k = axis / axis_norm\n        \n        cos_theta = np.cos(angle)\n        sin_theta = np.sin(angle)\n        \n        return (vec * cos_theta + \n                np.cross(k, vec) * sin_theta + \n                k * np.dot(k, vec) * (1 - cos_theta))\n\n    # Flow A: Evolve (x, v) with Q constant\n    def evolve_A(x, v, Q, c, B, m, dt):\n        q_eff = np.dot(Q, c)\n        B_norm = np.linalg.norm(B)\n        \n        if np.abs(q_eff * B_norm)  1e-15: # Handle linear motion case\n            x_new = x + v * dt\n            v_new = v\n            return x_new, v_new\n\n        omega = q_eff * B_norm / m\n        B_hat = B / B_norm\n        \n        v_parallel = np.dot(v, B_hat) * B_hat\n        v_perp = v - v_parallel\n        \n        omega_dt = omega * dt\n        cos_odt = np.cos(omega_dt)\n        sin_odt = np.sin(omega_dt)\n        \n        # Evolve v\n        v_perp_new = v_perp * cos_odt + np.cross(B_hat, v_perp) * sin_odt\n        v_new = v_parallel + v_perp_new\n        \n        # Evolve x by integrating v(t)\n        x_new = (x + v_parallel * dt +\n                 (v_perp * sin_odt) / omega +\n                 (np.cross(B_hat, v_perp) * (1 - cos_odt)) / omega)\n\n        return x_new, v_new\n        \n    # Flow B: Evolve Q with (x, v) constant\n    def evolve_B(x, v, Q, c, B, dt):\n        A = 0.5 * np.cross(B, x)\n        k = np.dot(A, v)\n        theta = k * dt\n        \n        Q_new = rodrigues(Q, c, theta)\n        return Q_new\n\n    def run_split_integrator(m, B, c, x0, v0, Q0, T, h):\n        n_steps = int(round(T / h))\n        x, v, Q = np.copy(x0), np.copy(v0), np.copy(Q0)\n        \n        Q_norm_0 = np.linalg.norm(Q0)\n        E_kin_0 = 0.5 * m * np.dot(v0, v0)\n        \n        max_delta_Q_norm = 0.0\n        max_delta_E_kin = 0.0\n        \n        for _ in range(n_steps):\n            # First half-step for (x, v)\n            x_star, v_star = evolve_A(x, v, Q, c, B, m, h/2.0)\n            \n            # Full step for Q\n            Q_new = evolve_B(x_star, v_star, Q, c, B, h)\n            \n            # Second half-step for (x, v) with updated Q\n            x_new, v_new = evolve_A(x_star, v_star, Q_new, c, B, m, h/2.0)\n            \n            x, v, Q = x_new, v_new, Q_new\n            \n            # Update diagnostics\n            delta_Q_norm = np.abs(np.linalg.norm(Q) - Q_norm_0)\n            if delta_Q_norm > max_delta_Q_norm:\n                max_delta_Q_norm = delta_Q_norm\n            \n            E_kin_t = 0.5 * m * np.dot(v, v)\n            delta_E_kin = np.abs(E_kin_t - E_kin_0)\n            if delta_E_kin > max_delta_E_kin:\n                max_delta_E_kin = delta_E_kin\n        \n        return x, max_delta_Q_norm, max_delta_E_kin\n\n    # ODE system for scipy's high-accuracy solver\n    def ode_system(t, y, m, B, c):\n        x = y[0:3]\n        v = y[3:6]\n        Q = y[6:9]\n        \n        dxdt = v\n        dvdt = (np.dot(Q, c) * np.cross(v, B)) / m\n        \n        A = 0.5 * np.cross(B, x)\n        k = np.dot(A, v)\n        dQdt = -k * np.cross(c, Q)\n        \n        return np.concatenate((dxdt, dvdt, dQdt))\n\n    results = []\n    for case in test_cases:\n        m, B, c, x0, v0, Q0, T = case['m'], case['B'], case['c'], case['x0'], case['v0'], case['Q0'], case['T']\n        h_large, h_small = case['h_large'], case['h_small']\n        \n        y0 = np.concatenate((x0, v0, Q0))\n        \n        # High-accuracy reference solution\n        ref_sol = solve_ivp(\n            ode_system, (0, T), y0, args=(m, B, c), \n            method='DOP853', rtol=1e-13, atol=1e-13\n        )\n        x_ref_final = ref_sol.y[0:3, -1]\n        \n        # Run with h_large\n        x_large_final, delta_Q, delta_E = run_split_integrator(m, B, c, x0, v0, Q0, T, h_large)\n        err_large = np.linalg.norm(x_large_final - x_ref_final)\n        \n        # Run with h_small\n        x_small_final, _, _ = run_split_integrator(m, B, c, x0, v0, Q0, T, h_small)\n        err_small = np.linalg.norm(x_small_final - x_ref_final)\n        \n        # Compute observed order p\n        if err_large  1e-14 or err_small  1e-14:\n            # If the error is near machine precision, the method is essentially exact for this case.\n            # Order is theoretically infinite, but we assign 2.0 as the method is at least second-order.\n            p = 2.0 \n        else:\n            p = np.log2(err_large / err_small)\n\n        results.append([p, delta_Q, delta_E])\n\n    # Convert results to a string in the specified format\n    result_str = \"[\" + \",\".join([f\"[{p:.6f},{dq:.6e},{de:.6e}]\" for p, dq, de in results]) + \"]\"\n    print(result_str)\n\nsolve()\n\n```"
        }
    ]
}