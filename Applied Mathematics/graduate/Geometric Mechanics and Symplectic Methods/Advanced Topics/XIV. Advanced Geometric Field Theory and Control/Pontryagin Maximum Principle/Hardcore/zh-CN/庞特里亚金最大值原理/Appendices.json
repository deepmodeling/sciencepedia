{
    "hands_on_practices": [
        {
            "introduction": "这第一个练习处理的是最优控制中的一个经典问题：在最短时间内将一个双积分器系统引导至原点。该系统模拟了许多基本动力学过程，例如受控力作用下的物体。通过这个问题 ，您将应用庞特里亚金极大值原理来推导“砰砰”（bang-bang）控制策略，并掌握切换曲线这一几何概念，它是时间最优控制的基石。",
            "id": "3762899",
            "problem": "考虑位形空间 $\\mathbb{R}^{2}$ 上的时间最优控制问题，其状态 $x=(x_{1},x_{2})$ 由控制仿射动力学 $\\dot{x}_{1}=x_{2}$ 和 $\\dot{x}_{2}=u$ 控制，其中控制量 $u$ 在紧凸集 $U=[-1,1]$ 内取值。目标是在最小时间 $T0$ 内将系统从初始状态 $x(0)=(1,-1)$ 驱动到终端状态 $x(T)=(0,0)$。假设在 Pontryagin 极大值原理 (PMP) 的意义下为正常极值，代价泛函为 $J=\\int_{0}^{T} 1 \\, \\mathrm{d}t$。\n\n利用 Pontryagin 极大值原理 (PMP) 的几何形式，将必要条件解释为赋有典范辛形式的余切丛 $T^{*}\\mathbb{R}^{2}$ 上的哈密顿系统，并导出最优控制的开关结构。然后，通过强制施加状态和协态的横截性及连续性条件，确定：\n- 最优 bang-bang 序列（即在每个弧段上 $u$ 的符号及其顺序），\n- 唯一的开关时间 $\\tau \\in [0,T]$，以及\n- 最小终端时间 $T$。\n\n请以精确代数形式给出最终答案，即有序对 $(\\tau, T)$。不需要数值近似。您的最终答案必须是单个表达式；请将其报告为包含两个条目的行向量。",
            "solution": "这是一个双积分器系统的时间最优控制问题。我们将使用 Pontryagin 极大值原理 (PMP) 来解决它。\n\n1.  **哈密顿表述：**\n    该问题设定在余切丛 $T^{*}\\mathbb{R}^{2}$ 上，坐标为 $(x, p) = (x_1, x_2, p_1, p_2)$。对于时间最优问题（最小化 $T$），代价泛函为 $J = \\int_0^T 1 dt$，即运行成本 $L=1$。\n    假设为正常极值，我们将代价乘子 $p_0$ 归一化为 $-1$ (对于最大值原理)。哈密顿量为 $H = \\langle p, f(x,u) \\rangle - L$：\n    $$H(x,p,u) = p_1 x_2 + p_2 u - 1$$\n\n2.  **Pontryagin 极大值原理 (PMP):**\n    PMP 指出，对于最优控制 $u^*(t)$，存在一个非零的协态轨迹 $p(t)$，使得：\n    (i) 哈密顿量由最优控制最大化：\n    $H(x^*(t), p(t), u^*(t)) = \\max_{v \\in [-1,1]} (p_1 x_2 + p_2 v - 1)$\n    这要求最大化 $p_2 u$，因此最优控制律为：\n    $$u^*(t) = \\mathrm{sgn}(p_2(t))$$\n    这是一个 bang-bang 控制。\n    (ii) 协态变量根据 Hamilton 方程演化：\n    $\\dot{p}_1 = -\\frac{\\partial H}{\\partial x_1} = 0 \\implies p_1(t) = c_1$\n    $\\dot{p}_2 = -\\frac{\\partial H}{\\partial x_2} = -p_1 = -c_1 \\implies p_2(t) = -c_1 t + c_2$\n    开关函数 $p_2(t)$ 是时间的线性函数，因此最多只有一个零点，意味着最多只有一次控制切换。\n    (iii) 对于时间最优问题，最大化哈密顿量沿最优轨迹恒为零：$\\mathcal{H}(x^*(t), p(t)) = 0$。\n\n3.  **几何解释和开关曲线：**\n    最优策略是将状态从 $x(0)$ 驱动到一条称为开关曲线 $\\mathcal{S}$ 的特殊曲线上，然后沿着 $\\mathcal{S}$ 到达原点。开关曲线是所有可以使用单个恒定控制（$u=+1$ 或 $u=-1$）驱动到原点的点的集合。我们通过对动力学进行时间上的向后积分来找到 $\\mathcal{S}$。\n    - **最终弧段使用 $u=+1$**: 要用 $u=+1$ 到达原点，速度 $x_2$ 必须从负值增加到零，因此状态必须在 $x_2  0$ 的区域。从 $(x_1, x_2)$ 点到达原点需要时间 $t_{arc} = -x_2$。在这段时间内，$x_1$ 的变化为 $\\Delta x_1 = -x_1(0) = \\int_0^{-x_2} (x_2+s)ds = -x_2^2 + \\frac{1}{2}x_2^2 = -\\frac{1}{2}x_2^2$。因此，初始点必须满足 $x_1 = \\frac{1}{2}x_2^2$。这条曲线段是 $\\mathcal{S}_+ = \\{(x_1, x_2) | x_1 = \\frac{1}{2}x_2^2, x_2  0\\}$。\n    - **最终弧段使用 $u=-1$**: 类似地，要用 $u=-1$ 到达原点，状态必须在 $x_2 > 0$ 的区域。可以推导出曲线为 $\\mathcal{S}_- = \\{(x_1, x_2) | x_1 = -\\frac{1}{2}x_2^2, x_2 > 0\\}$。\n\n4.  **寻找最优轨迹和开关时间 $\\tau$：**\n    初始状态为 $x(0)=(1,-1)$。由于 $x_2(0) = -1  0$，我们将其与开关曲线 $\\mathcal{S}_+$ 进行比较。在 $\\mathcal{S}_+$ 上，$x_2=-1$ 对应的点是 $x_1 = \\frac{1}{2}(-1)^2 = 0.5$。我们的初始点 $x_1(0)=1$ 大于 $0.5$，这意味着该点位于相平面中 $\\mathcal{S}_+$ 右侧的区域。在该区域中，时间最优控制是 $u=-1$。\n    因此，最优控制序列是先 $u=-1$ 后 $u=+1$。设 $\\tau$ 为开关时间。\n\n    - **弧段 1：** $t \\in [0, \\tau]$, $u(t) = -1$。\n        初始条件：$x_1(0)=1$, $x_2(0)=-1$。\n        $\\dot{x}_2 = -1 \\implies x_2(t) = x_2(0) - t = -1-t$。\n        $\\dot{x}_1 = x_2(t) \\implies x_1(t) = x_1(0) + \\int_0^t (-1-s)ds = 1 - t - \\frac{1}{2}t^2$。\n        在时间 $\\tau$，状态为 $x(\\tau)=(1-\\tau-\\frac{1}{2}\\tau^2, -1-\\tau)$。\n\n    - **开关条件：** 在 $t=\\tau$ 时，状态 $x(\\tau)$ 必须位于开关曲线 $\\mathcal{S}_+$ 上，因为接下来的控制是 $u=+1$。\n        $x_1(\\tau) = \\frac{1}{2}[x_2(\\tau)]^2$。\n        $$1 - \\tau - \\frac{1}{2}\\tau^2 = \\frac{1}{2}(-1-\\tau)^2$$\n        $$1 - \\tau - \\frac{1}{2}\\tau^2 = \\frac{1}{2}(1 + 2\\tau + \\tau^2)$$\n        两边乘以 $2$：\n        $$2 - 2\\tau - \\tau^2 = 1 + 2\\tau + \\tau^2$$\n        $$2\\tau^2 + 4\\tau - 1 = 0$$\n        求解关于 $\\tau$ 的二次方程：\n        $$\\tau = \\frac{-4 \\pm \\sqrt{16 - 4(2)(-1)}}{4} = \\frac{-4 \\pm \\sqrt{24}}{4} = \\frac{-2 \\pm \\sqrt{6}}{2}$$\n        由于时间必须为正 ($\\tau0$)，我们取正根：\n        $$\\tau = \\frac{\\sqrt{6}-2}{2}$$\n\n5.  **寻找最小终端时间 $T$：**\n    - **弧段 2：** $t \\in (\\tau, T]$, $u(t) = +1$。\n        该弧段从 $x(\\tau)$ 开始，到 $x(T)=(0,0)$ 结束。从 $\\mathcal{S}_+$ 上的点 $(x_1,x_2)$ 行进到原点所需的时间为 $t_{final\\_arc} = -x_2$。\n        第二个弧段的持续时间为 $T-\\tau$。因此：\n        $$T-\\tau = -x_2(\\tau)$$\n        我们有 $x_2(\\tau) = -1-\\tau$。\n        $$T-\\tau = -(-1-\\tau) = 1+\\tau$$\n        $$T = 2\\tau + 1$$\n        代入 $\\tau$ 的值：\n        $$T = 2 \\left(\\frac{\\sqrt{6}-2}{2}\\right) + 1 = (\\sqrt{6}-2) + 1 = \\sqrt{6}-1$$\n\n最优开关时间是 $\\tau = \\frac{\\sqrt{6}-2}{2}$，最小终端时间是 $T = \\sqrt{6}-1$。bang-bang 序列是在 $[0, \\tau]$ 上 $u=-1$，在 $(\\tau, T]$ 上 $u=+1$。\n\n最终答案是有序对 $(\\tau, T)$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{\\sqrt{6}-2}{2}  \\sqrt{6}-1 \\end{pmatrix} } $$"
        },
        {
            "introduction": "虽然“砰砰”控制很常见，但许多系统表现出更精细的最优解，即奇异控制。本练习  探讨了一个控制输入呈线性的系统，这种结构常常导致奇异现象的出现。您将练习一项关键技术：通过对切换函数进行连续微分来显式计算奇异控制，这是分析一大类优化问题的核心技能。",
            "id": "3162826",
            "problem": "考虑一个受控系统，其状态为 $x(t) = \\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\end{pmatrix} \\in \\mathbb{R}^{2}$，控制为 $u(t) \\in [-1,1]$，时间域为固定的 $t \\in [0,T]$：\n$$\n\\dot{x}_{1}(t) = x_{2}(t), \\qquad \\dot{x}_{2}(t) = -x_{1}(t) + u(t).\n$$\n需要最小化的性能指标是关于控制呈线性的运行成本的积分，\n$$\nJ[u] = \\int_{0}^{T} L(x(t),u(t)) \\, dt, \\qquad L(x,u) = c(x) \\, u, \\qquad c(x) = x_{1}.\n$$\n使用庞特里亚金极大值原理（PMP），研究奇异最优控制的可能性。该原理指出，沿着一条最优轨迹，存在一个非平凡的协态 $p(t) = \\begin{pmatrix} p_{1}(t) \\\\ p_{2}(t) \\end{pmatrix}$，使得哈密顿函数\n$$\nH(x,u,p) = p^{\\top}\\big(f(x) + g(x)u\\big) - L(x,u)\n$$\n几乎处处被最优控制 $u(t)$ 最大化，其中 $f(x) = \\begin{pmatrix} x_{2} \\\\ -x_{1} \\end{pmatrix}$ 且 $g(x) = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。当开关函数在一个区间上为零时，就会出现奇异控制。由于哈密顿函数对 $u$ 是线性的，必须沿着轨迹对开关函数求导，直到控制量 $u$ 显式出现；然后通过强制奇异性持续存在的条件来确定奇异控制的值。\n\n推导哈密顿函数、协态动力学和开关函数。然后，假设在一段奇异弧上，开关函数及其一阶时间导数均为零，通过沿着轨迹对开关函数求导直至 $u$ 出现，并强制奇异性持续，来计算奇异控制 $u_{\\text{sing}}$ 的显式值。请将最终答案表示为单个实数，无需四舍五入。",
            "solution": "该问题要求计算一个特定的对控制量呈线性的最优控制问题中的奇异控制 $u_{\\text{sing}}$ 的显式值。分析将使用庞特里亚金极大值原理（PMP）进行。\n\n首先，我们根据问题陈述定义系统各组成部分。状态向量为 $x(t) = \\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\end{pmatrix}$，控制输入为 $u(t) \\in [-1, 1]$。状态动力学由以下方程给出：\n$$\n\\dot{x}_{1}(t) = x_{2}(t) \\\\\n\\dot{x}_{2}(t) = -x_{1}(t) + u(t)\n$$\n这可以写成 $\\dot{x} = f(x) + g(x)u$ 的形式，其中：\n$$\nf(x) = \\begin{pmatrix} x_{2} \\\\ -x_{1} \\end{pmatrix}, \\qquad g(x) = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n拉格朗日函数（运行成本）为 $L(x, u) = x_{1}u$。\n\n根据庞特里亚金极大值原理，对于一条最优轨迹，存在一个非零的协态向量 $p(t) = \\begin{pmatrix} p_{1}(t) \\\\ p_{2}(t) \\end{pmatrix}$，使得哈密顿函数 $H(x, u, p)$ 关于控制量 $u$ 被最大化。问题中哈密顿函数定义为 $H = p^{\\top}(f+gu) - L(x,u)$，这对应于最大化 $\\int -L(x,u) dt$ 的问题。\n\n代入系统动力学和拉格朗日函数，哈密顿函数为：\n$$\nH(x, u, p) = p_{1}(t)x_{2}(t) + p_{2}(t)(-x_{1}(t) + u(t)) - x_{1}(t)u(t)\n$$\n我们可以重新整理此式，以分离出依赖于控制量 $u$ 的项：\n$$\nH(x, u, p) = (p_{1}x_{2} - p_{2}x_{1}) + (p_{2} - x_{1})u\n$$\n哈密顿函数对控制量 $u$ 呈线性关系。乘以 $u$ 的项是开关函数，我们记为 $\\Phi(t)$。\n$$\n\\Phi(t) = \\frac{\\partial H}{\\partial u} = p_{2}(t) - x_{1}(t)\n$$\n最优控制 $u^*(t)$ 使 $H$ 最大化。考虑到控制约束 $u \\in [-1, 1]$，最优控制律由下式给出：\n$$\nu^{*}(t) = \\begin{cases}\n1  \\text{如果 } \\Phi(t) > 0 \\\\\n-1  \\text{如果 } \\Phi(t)  0 \\\\\n\\text{不确定}  \\text{如果 } \\Phi(t) = 0\n\\end{cases}\n$$\n奇异弧是 $\\Phi(t) = 0$ 成立的一段时间区间。为维持此条件，开关函数的所有时间导数也必须为零，即 $\\Phi^{(k)}(t) = 0$ 对 $k = 1, 2, \\ldots$ 成立。我们必须对 $\\Phi(t)$ 求导，直到控制量 $u$ 显式出现。\n\n协态动力学由正则方程 $\\dot{p} = -\\frac{\\partial H}{\\partial x}$ 给出。\n$$\n\\dot{p}_{1} = -\\frac{\\partial H}{\\partial x_{1}} = -(-p_{2} - u) = p_{2} + u\n$$\n$$\n\\dot{p}_{2} = -\\frac{\\partial H}{\\partial x_{2}} = -(p_{1}) = -p_{1}\n$$\n现在，我们计算开关函数 $\\Phi(t) = p_{2}(t) - x_{1}(t)$ 的时间导数。\n一阶导数为：\n$$\n\\dot{\\Phi}(t) = \\frac{d}{dt}\\Phi(t) = \\dot{p}_{2}(t) - \\dot{x}_{1}(t)\n$$\n代入 $\\dot{p}_{2}$ 和 $\\dot{x}_{1}$ 的表达式：\n$$\n\\dot{\\Phi}(t) = -p_{1}(t) - x_{2}(t)\n$$\n在奇异弧上，必须有 $\\Phi(t) = 0$ 和 $\\dot{\\Phi}(t) = 0$。\n条件 $\\Phi(t) = 0$ 意味着 $p_{2}(t) = x_{1}(t)$。\n条件 $\\dot{\\Phi}(t) = 0$ 意味着 $-p_{1}(t) - x_{2}(t) = 0$，或 $p_{1}(t) = -x_{2}(t)$。\n控制量 $u$ 没有出现在 $\\dot{\\Phi}(t)$ 的表达式中。因此，我们必须计算二阶时间导数。\n$$\n\\ddot{\\Phi}(t) = \\frac{d}{dt}\\dot{\\Phi}(t) = -\\dot{p}_{1}(t) - \\dot{x}_{2}(t)\n$$\n代入 $\\dot{p}_{1}$ 和 $\\dot{x}_{2}$ 的表达式：\n$$\n\\ddot{\\Phi}(t) = -(p_{2}(t) + u(t)) - (-x_{1}(t) + u(t))\n$$\n$$\n\\ddot{\\Phi}(t) = -p_{2}(t) - u(t) + x_{1}(t) - u(t)\n$$\n$$\n\\ddot{\\Phi}(t) = x_{1}(t) - p_{2}(t) - 2u(t)\n$$\n在奇异弧上，还必须有 $\\ddot{\\Phi}(t) = 0$。满足此条件的控制即为奇异控制 $u_{\\text{sing}}(t)$。令 $\\ddot{\\Phi}(t) = 0$：\n$$\nx_{1}(t) - p_{2}(t) - 2u_{\\text{sing}}(t) = 0\n$$\n我们还知道，在奇异弧上，$\\Phi(t) = p_{2}(t) - x_{1}(t) = 0$，这意味着 $p_{2}(t) = x_{1}(t)$。将此代入 $\\ddot{\\Phi}(t) = 0$ 的方程中：\n$$\nx_{1}(t) - x_{1}(t) - 2u_{\\text{sing}}(t) = 0\n$$\n$$\n0 - 2u_{\\text{sing}}(t) = 0\n$$\n$$\n-2u_{\\text{sing}}(t) = 0\n$$\n求解 $u_{\\text{sing}}(t)$ 可得：\n$$\nu_{\\text{sing}}(t) = 0\n$$\n这个值是一个常数，并且位于容许控制集 $0 \\in [-1, 1]$ 内。因此，奇异控制的显式值为 $0$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "除了优化成本函数的“正常”极值之外，庞特里亚金的框架还能揭示完全由系统几何约束决定的“异常”极值。这个高级问题  深入探讨了这一深刻概念，它对于理解系统的可控性至关重要。您将学习通过将代价乘子 $p_0$ 设为零来识别这些特殊轨迹，从而揭示控制系统内在的几何限制。",
            "id": "3762921",
            "problem": "考虑流形 $M = \\mathbb{R}^{3}$，其坐标为 $(x,y,z)$，以及一个控制仿射系统\n$$\n\\dot{q}(t) = u_{1}(t) X_{1}(q(t)) + u_{2}(t) X_{2}(q(t)),\n$$\n其中 $q(t) \\in M$，$(u_{1}(t),u_{2}(t)) \\in U := \\{(u_{1},u_{2}) \\in \\mathbb{R}^{2} : u_{1}^{2}+u_{2}^{2} \\leq 1\\}$，且向量场为\n$$\nX_{1}(x,y,z) = \\partial_{x} + y^{2} \\partial_{z}, \\qquad X_{2}(x,y,z) = \\partial_{y}.\n$$\n我们考虑一个时间最优问题：在所有将 $q(0) = (0,0,0)$ 驱动至 $q(T) = (x_{T}, 0, 0)$（对于某个固定的 $x_{T}  0$）的容许控制 $(u_{1},u_{2})$ 中，最小化转移时间 $T$。在几何力学和辛框架内使用 Pontryagin 极大值原理，其中极值曲线是到配备了典范辛形式的余切丛 $T^{*}M$ 上的提升。\n\n任务：\n1. 为此问题构建 Pontryagin 哈密顿量 $H(q,p,u,p_{0})$，并解释正常极值曲线 ($p_{0}  0$) 和异常极值曲线 ($p_{0} = 0$) 之间的区别。推导异常极值曲线的一阶最优性必要条件，包括在 $U$ 上的极大化条件以及由哈密顿向量场在 $T^{*}M$ 上诱导的协态动力学。\n2. 证明该系统存在异常极值曲线，并找出一个完全位于平面 $y=0$ 内的非平凡异常极值曲线。特别地，考虑轨迹\n$$\nq(t) = (t,0,0), \\qquad t \\in [0,T], \\quad \\text{以及控制} \\quad u_{1}(t) \\equiv 1, \\; u_{2}(t) \\equiv 0.\n$$\n3. 针对此异常极值曲线，推导协态 $p(t) \\in T^{*}_{q(t)}M$ 所需满足的必要条件，并显式计算在任务2的轨迹上协态分量 $(p_{x}(t), p_{y}(t), p_{z}(t))$ 的时间演化。将你对 $(p_{x}(t), p_{y}(t), p_{z}(t))$ 的最终答案表示为单个闭式解析表达式。无需四舍五入。不包含单位。如果你的最终表达式包含常数，可以将其保留为符号参数。",
            "solution": "该问题是几何控制理论领域中一个良定的时间最优控制问题，我们将分三部分来解决。\n\n**1. Pontryagin 哈密顿量与异常极值曲线的条件**\n\n目标是最小化最终时间 $T$，这对应于代价泛函 $J = \\int_0^T 1 \\, dt$。拉格朗日量为 $L(q,u) = 1$。状态方程为 $\\dot{q} = u_1 X_1(q) + u_2 X_2(q)$，其中 $q=(x,y,z)$，$X_1 = \\partial_x + y^2 \\partial_z = (1, 0, y^2)$，以及 $X_2 = \\partial_y = (0, 1, 0)$。\n\n根据 Pontryagin 极大值原理 (PMP)，对于一个具有控制 $u(t)$ 的最优轨迹 $q(t)$，存在一条非零曲线 $(p(t), p_0)$，其中 $p(t) \\in T_{q(t)}^*M$ 是协态，$p_0 \\leq 0$ 是一个常数。Pontryagin 哈密顿量定义为：\n$$ H(q, p, u, p_0) = \\langle p, \\dot{q} \\rangle + p_0 L(q,u) $$\n此处，$p = (p_x, p_y, p_z)$ 是协态向量。我们定义控制哈密顿量 $H_i(q,p) = \\langle p, X_i(q) \\rangle$，对于 $i=1,2$。\n$$ H_1(q,p) = \\langle (p_x, p_y, p_z), (1, 0, y^2) \\rangle = p_x + y^2 p_z $$\n$$ H_2(q,p) = \\langle (p_x, p_y, p_z), (0, 1, 0) \\rangle = p_y $$\n于是 Pontryagin 哈密顿量可以写为：\n$$ H(q, p, u, p_0) = u_1 H_1(q,p) + u_2 H_2(q,p) + p_0 $$\n正常极值曲线与异常极值曲线的区别基于 $p_0$ 的值：\n- **正常极值曲线**：$p_0  0$。根据齐次性，我们可以将 $p_0$ 归一化为 $-1$。代价函数通过哈密顿量 $H = u_1 H_1 + u_2 H_2 - 1$ 被真正地纳入到优化中。\n- **异常极值曲线**：$p_0 = 0$。哈密顿量变为 $H_{ab} = u_1 H_1 + u_2 H_2$。这些极值曲线独立于代价函数，完全由向量场的几何结构和控制约束决定。PMP 提升的非零条件意味着 $p(t)$ 不能恒等于零。\n\n对于异常极值曲线 ($p_0=0$)，PMP 的必要条件是：\n1.  **哈密顿动力学**：极值曲线 $(q(t), p(t))$ 根据余切丛 $T^*M$ 上关于 $H_{ab}$ 的哈密顿方程演化。哈密顿向量场 $\\vec{H}_{ab}$ 生成流：$\\dot{q} = \\frac{\\partial H_{ab}}{\\partial p}$ 和 $\\dot{p} = -\\frac{\\partial H_{ab}}{\\partial q}$。\n    $\\dot{q}$ 方程恢复了状态动力学。协态动力学为：\n    $$ \\dot{p}_x = -\\frac{\\partial H_{ab}}{\\partial x} = 0 $$\n    $$ \\dot{p}_y = -\\frac{\\partial H_{ab}}{\\partial y} = -\\frac{\\partial}{\\partial y}(u_1(p_x + y^2 p_z) + u_2 p_y) = -2 u_1 y p_z $$\n    $$ \\dot{p}_z = -\\frac{\\partial H_{ab}}{\\partial z} = 0 $$\n2.  **极大化条件**：对于几乎所有的 $t \\in [0,T]$，最优控制 $u^*(t)$ 使哈密顿量极大化：\n    $$ H_{ab}(q(t), p(t), u^*(t)) = \\max_{v \\in U} H_{ab}(q(t), p(t), v) $$\n3.  **哈密顿量的值**：对于时间最优问题，极大化后的哈密顿量在极值轨迹上必须为常数且等于零。\n    $$ \\mathcal{H}_{ab}(t) = u_1^*(t) H_1(t) + u_2^*(t) H_2(t) = 0 $$\n    在圆盘 $U$ 上对线性函数 $u_1 H_1 + u_2 H_2$ 进行极大化，并要求极大值为零，这意味着向量 $(H_1(t), H_2(t))$ 必须是零向量。如果不是，极大值将是 $\\sqrt{H_1(t)^2 + H_2(t)^2} > 0$。因此，异常极值曲线的一个必要条件是\n    $$ H_1(q(t), p(t)) = 0 \\quad \\text{和} \\quad H_2(q(t), p(t)) = 0 $$\n    对于几乎所有的 $t \\in [0,T]$ 成立。\n\n**2. 非平凡异常极值曲线的存在性**\n\n我们需要证明存在一条轨迹 $q(t)$ 和一个非零协态 $p(t)$ 满足异常条件。问题提出了在 $t \\in [0,T]$ 上的轨迹 $q(t) = (t,0,0)$，其控制为 $u_1(t) \\equiv 1, u_2(t) \\equiv 0$。\n\n首先，我们来验证该轨迹是否有效。\n对于 $q(t)=(t,0,0)$，我们有 $\\dot{q}(t)=(1,0,0)$。\n对于 $u=(1,0)$ 和 $y=0$，动力学为 $\\dot{q} = 1 \\cdot X_1(t,0,0) + 0 \\cdot X_2(t,0,0)$。\n$X_1(t,0,0) = \\partial_x + 0^2 \\partial_z = \\partial_x$，这对应于向量 $(1,0,0)$。\n所以，$\\dot{q} = 1 \\cdot (1,0,0) = (1,0,0)$，这是一致的。控制 $u=(1,0)$ 在 $U$ 内，因为 $1^2+0^2=1 \\leq 1$。轨迹从 $q(0)=(0,0,0)$ 开始，到 $q(T)=(T,0,0)$ 结束。\n\n现在，我们检查这是否能成为一条异常极值曲线。必须存在一个非零的 $p(t)$，使得沿此路径 $H_1(t)=0$ 和 $H_2(t)=0$，并且 $p(t)$ 必须满足协态方程。\n沿 $q(t)=(t,0,0)$ 的条件 $H_1=0$ 和 $H_2=0$ 变为：\n$$ H_1(t) = p_x(t) + y(t)^2 p_z(t) = p_x(t) + 0^2 \\cdot p_z(t) = p_x(t) = 0 $$\n$$ H_2(t) = p_y(t) = 0 $$\n所以，要使我们的轨迹是异常的，协态必须对所有 $t$ 都满足 $p_x(t) = 0$ 和 $p_y(t) = 0$。\n\n让我们检查与协态动力学的一致性，使用 $u(t)=(1,0)$ 和 $q(t)=(t,0,0)$：\n$$ \\dot{p}_x = 0 \\implies p_x(t) = \\text{常数} $$\n$$ \\dot{p}_y = -2 u_1(t) y(t) p_z(t) = -2(1)(0)p_z(t) = 0 \\implies p_y(t) = \\text{常数} $$\n$$ \\dot{p}_z = 0 \\implies p_z(t) = \\text{常数} $$\n条件 $p_x(t)=0$ 要求积分常数为 $0$。这是一致的。\n条件 $p_y(t)=0$ 要求积分常数为 $0$。这是一致的。\n$p_z(t)$ 的方程意味着 $p_z(t)=C$，其中 $C$ 是某个常数。\n所以，我们有一个候选协态轨迹 $p(t) = (0, 0, C)$。为了使极值曲线非平凡（即 $(p(t),p_0)$ 从不为零且 $p_0=0$），我们必须有 $p(t) \\neq 0$，这意味着 $C \\neq 0$。\n\n因此，轨迹 $q(t)=(t,0,0)$ 与控制 $u(t)=(1,0)$，配以协态 $p(t)=(0,0,C)$（对于任意非零常数 $C$），满足了异常极值曲线的所有一阶必要条件。这证明了存在一条位于平面 $y=0$ 内的非平凡异常极值曲线。\n\n**3. 沿异常极值曲线的协态演化**\n\n题目要求我们推导针对特定异常极值曲线 $q(t)=(t,0,0)$（控制为 $u(t)=(1,0)$）的协态 $p(t)$ 所需满足的必要条件，并显式计算协态分量 $(p_x(t), p_y(t), p_z(t))$ 的时间演化。\n\n对于异常极值曲线，协态的必要条件是必须存在一个非零的 $p(t)$，使得对于几乎所有的 $t \\in [0,T]$：\n1.  $H_1(q(t),p(t)) = p_x(t) + y(t)^2 p_z(t) = 0$.\n2.  $H_2(q(t),p(t)) = p_y(t) = 0$.\n3.  协态根据 $\\dot{p}(t) = -\\frac{\\partial H_{ab}}{\\partial q}|_{(q(t),p(t),u(t))}$ 演化。\n\n我们将指定的轨迹 $q(t)=(t,0,0)$（其中 $y(t)=0$）代入前两个条件：\n1.  $p_x(t) + (0)^2 p_z(t) = p_x(t) = 0$.\n2.  $p_y(t) = 0$.\n\n这些代数约束必须对所有 $t$ 成立。\n\n现在我们分析沿给定极值路径（其中 $q(t)=(t,0,0)$ 且 $u(t)=(1,0)$）的协态微分方程：\n$$ \\dot{p}_x(t) = 0 $$\n$$ \\dot{p}_y(t) = -2 u_1(t) y(t) p_z(t) = -2(1)(0)p_z(t) = 0 $$\n$$ \\dot{p}_z(t) = 0 $$\n对这些简单的微分方程进行积分得到：\n$$ p_x(t) = C_x $$\n$$ p_y(t) = C_y $$\n$$ p_z(t) = C_z $$\n其中 $C_x, C_y, C_z$ 是积分常数。\n\n为了得到 $p(t)$ 的最终表达式，我们必须应用从 $H_1=0$ 和 $H_2=0$ 推导出的代数约束。\n从 $p_x(t)=0$，我们必须有 $C_x=0$。\n从 $p_y(t)=0$，我们必须有 $C_y=0$。\n分量 $p_z(t)$ 只是一个常数，$p_z(t)=C_z$。\n根据 PMP 的要求，为使极值曲线非平凡，协态向量 $p(t)$ 不能是零向量。因此，我们必须有 $C_z \\neq 0$。\n\n因此，协态分量的时间演化由下式给出：\n$$ p_x(t) = 0 $$\n$$ p_y(t) = 0 $$\n$$ p_z(t) = C $$\n其中 $C$ 是一个任意非零常数。我们将此符号参数表示为 $C$。最终得到的协态向量表达式为 $(p_x(t), p_y(t), p_z(t)) = (0, 0, C)$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0  0  C \\end{pmatrix} } $$"
        }
    ]
}