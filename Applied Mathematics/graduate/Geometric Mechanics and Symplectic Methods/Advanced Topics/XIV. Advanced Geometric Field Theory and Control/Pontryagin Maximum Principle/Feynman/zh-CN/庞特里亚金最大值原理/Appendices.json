{
    "hands_on_practices": [
        {
            "introduction": "本练习是经典最优控制理论的基石，其任务是找到将一个简单的机械系统（双积分器，可类比为轨道上的一辆小车）以最快速度引导至目标位置。此问题完美地展示了庞特里亚金极大值原理（PMP）如何导出一个“砰砰控制”（bang-bang control）策略，即控制量在其最大值和最小值之间进行突变切换。通过解决这个问题 ，您将获得设置哈密尔顿量、推导协态动力学，以及最重要地，在状态空间中构建“切换曲线”的实践经验，这是一个决定最优控制策略的强大几何工具。",
            "id": "3762899",
            "problem": "考虑位形空间 $\\mathbb{R}^{2}$ 上的时间最优控制问题，状态 $x=(x_{1},x_{2})$ 由控制仿射动力学 $\\dot{x}_{1}=x_{2}$ 和 $\\dot{x}_{2}=u$ 决定，其中控制 $u$ 在紧凸集 $U=[-1,1]$ 中取值。目标是在最小时间 $T0$ 内将系统从初始状态 $x(0)=(1,-1)$ 驱动到终端状态 $x(T)=(0,0)$。假设在庞特里亚金极大值原理（PMP）意义下存在一个正常极值，其代价泛函为 $J=\\int_{0}^{T} 1 \\, \\mathrm{d}t$。\n\n使用庞特里亚金极大值原理（PMP）的几何形式，将必要条件解释为赋有典范辛形式的余切丛 $T^{*}\\mathbb{R}^{2}$ 上的一个哈密顿系统，并推导出最优控制的开关结构。然后，通过施加状态和协态的横截性与连续性条件，确定：\n- 最优bang-bang序列（即每段弧上 $u$ 的符号及其顺序），\n- 唯一的开关时间 $\\tau \\in [0,T]$，以及\n- 最小终端时间 $T$。\n\n以精确代数形式给出有序对 $(\\tau, T)$作为最终答案。不需要数值近似。你的最终答案必须是单一表达式；请将其报告为一个包含两个条目的行向量。",
            "solution": "这是一个双积分器系统的时间最优控制问题。我们将使用庞特里亚金极大值原理（PMP）的几何解释来解决它。\n\n首先验证问题陈述。\n已知条件：\n- 状态空间：$\\mathbb{R}^{2}$，状态为 $x=(x_{1},x_{2})$。\n- 动力学：$\\dot{x}_{1}=x_{2}$, $\\dot{x}_{2}=u$。\n- 控制集：$u \\in U=[-1,1]$。\n- 初始状态：$x(0)=(1,-1)$。\n- 终端状态：$x(T)=(0,0)$。\n- 目标：最小化终端时间 $T  0$。\n- 代价泛函：$J = \\int_{0}^{T} 1 \\, dt$。这对应于运行成本 $L(x,u) = 1$。\n- 假设：极值是正常的。\n\n该问题具有科学依据，是适定的、客观的和完整的。它是最优控制理论中的一个典型例子，适合求解。该问题是有效的。\n\n我们继续进行求解。\n\n1.  **哈密顿形式：**\n    问题设定在余切丛 $T^{*}\\mathbb{R}^{2}$ 上，坐标为 $(x, p) = (x_1, x_2, p_1, p_2)$。该最优控制问题的哈密顿量由 $H(x,p,u) = p_0 L(x,u) + \\langle p, f(x,u) \\rangle$ 给出，其中 $f(x,u)$ 是动力学系统的向量场。\n    给定 $L(x,u)=1$ 和 $f(x,u)=(x_2, u)$，哈密顿量为：\n    $$H(x,p,u) = p_0 + p_1 x_2 + p_2 u$$\n    问题陈述中假设极值是正常的，这意味着协态乘子 $p_0$ 非零。对于最小化问题，我们有 $p_0 \\leq 0$。通过缩放协态向量 $(p_0, p)$，我们可以设定 $p_0 = -1$。\n    $$H(x,p,u) = p_1 x_2 + p_2 u - 1$$\n\n2.  **庞特里亚金极大值原理 (PMP)：**\n    PMP指出，对于最优控制 $u^*(t)$ 和对应的状态轨迹 $x^*(t)$，存在一个非零的协态轨迹 $p(t)$，使得：\n    (i) 哈密顿量被最优控制最大化：\n    $$H(x^*(t), p(t), u^*(t)) = \\max_{v \\in [-1,1]} H(x^*(t), p(t), v)$$\n    (ii) 状态和协态变量根据哈密顿方程演化：\n    $$\\dot{x}_i = \\frac{\\partial H}{\\partial p_i}, \\quad \\dot{p}_i = -\\frac{\\partial H}{\\partial x_i}$$\n    (iii) 沿最优轨迹，最大化后的哈密顿量 $\\mathcal{H}(x,p) = \\max_{u \\in U} H(x,p,u)$ 为常数。对于时间最优问题（终端时间自由），该常数值为零。\n    $$\\mathcal{H}(x^*(t), p(t)) = 0 \\quad \\forall t \\in [0,T]$$\n\n3.  **最优控制律和协态动力学：**\n    根据条件(i)，为了相对于 $u \\in [-1,1]$ 最大化 $H = p_1 x_2 + p_2 u - 1$，我们必须最大化项 $p_2 u$。这得出了控制律：\n    $$u^*(t) = \\mathrm{sgn}(p_2(t))$$\n    这是一个bang-bang控制律。只有当开关函数 $\\phi(t) = p_2(t)$ 过零时，控制才会切换取值。\n\n    根据条件(ii)，哈密顿方程为：\n    $\\dot{x}_1 = \\frac{\\partial H}{\\partial p_1} = x_2$\n    $\\dot{x}_2 = \\frac{\\partial H}{\\partial p_2} = u$\n    （正如预期的，这些是状态动力学方程。）\n    $\\dot{p}_1 = -\\frac{\\partial H}{\\partial x_1} = 0 \\implies p_1(t) = c_1$（一个常数）\n    $\\dot{p}_2 = -\\frac{\\partial H}{\\partial x_2} = -p_1 = -c_1 \\implies p_2(t) = -c_1 t + c_2$（一个常数）\n    由于开关函数 $p_2(t)$ 是时间的线性函数，它最多只能有一个零点（除非 $c_1=0$，这意味着常数控制，但我们可以证明这种情况不满足边界条件）。因此，最多只有一次控制切换。\n\n4.  **几何解释与开关曲线：**\n    最优策略是将状态从 $x(0)$ 驱动到一条特殊曲线，即开关曲线 $\\mathcal{S}$，然后沿着 $\\mathcal{S}$ 到达原点。开关曲线是所有可以用单一常数控制（$u=+1$ 或 $u=-1$）驱动到原点的点的集合。我们通过分析到达原点的轨迹来确定这些曲线。\n    - **到达原点的 $u=-1$ 弧段 ($\\mathcal{S}_-$):** 若要用 $u=-1$ 到达原点，速度必须减小至零，因此在到达前 $x_2$ 必须为正。通过反向积分从 $(0,0)$ 出发或正向求解到达 $(0,0)$ 的条件，可得该弧段遵循方程 $x_1 = -\\frac{1}{2}x_2^2$，其中 $x_2 > 0$。此为 $\\mathcal{S}_-$。\n    - **到达原点的 $u=+1$ 弧段 ($\\mathcal{S}_+$):** 若要用 $u=+1$ 到达原点，速度必须从负值增加至零，因此在到达前 $x_2$ 必须为负。该弧段遵循方程 $x_1 = \\frac{1}{2}x_2^2$，其中 $x_2  0$。此为 $\\mathcal{S}_+$。\n\n    完整的开关曲线是 $\\mathcal{S} = \\mathcal{S}_- \\cup \\mathcal{S}_+$，可以写成 $x_1 = -\\frac{1}{2}x_2|x_2|$。\n\n5.  **寻找最优轨迹和开关时间 $\\tau$：**\n    初始状态是 $x(0)=(1,-1)$。我们检查它相对于开关曲线的位置。对于 $x_2=-1$，开关曲线 $\\mathcal{S}_+$ 上的对应点在 $x_1 = \\frac{1}{2}(-1)^2 = 0.5$。我们的初始点 $x_1(0)=1$，因此 $1  0.5$。相图显示，当 $u=+1$ 时轨迹向右移动（在 $x_20$ 时 $x_1$ 增加），当 $u=-1$ 时轨迹向左移动。要从 $(1,-1)$ 到达开关曲线 $\\mathcal{S}_+$，我们必须向左移动，所以初始控制必须是 $u=-1$。\n    因此，最优控制序列是先 $u=-1$，然后是 $u=+1$。设 $\\tau$ 为开关时间。\n\n    -   **弧段1：** $t \\in [0, \\tau]$，$u(t) = -1$。\n        初始条件：$x_1(0)=1$, $x_2(0)=-1$。\n        $\\dot{x}_2 = -1 \\implies x_2(t) = x_2(0) - t = -1-t$。\n        $\\dot{x}_1 = x_2(t) \\implies x_1(t) = x_1(0) + \\int_0^t (-1-s)ds = 1 - t - \\frac{1}{2}t^2$。\n        在时间 $\\tau$，状态为 $x(\\tau)=(1-\\tau-\\frac{1}{2}\\tau^2, -1-\\tau)$。\n\n    -   **开关条件：** 在 $t=\\tau$ 时，状态 $x(\\tau)$ 必须位于开关曲线 $\\mathcal{S}_+$ 上。\n        $x_1(\\tau) = \\frac{1}{2}[x_2(\\tau)]^2$。\n        $$1 - \\tau - \\frac{1}{2}\\tau^2 = \\frac{1}{2}(-1-\\tau)^2$$\n        $$1 - \\tau - \\frac{1}{2}\\tau^2 = \\frac{1}{2}(1 + 2\\tau + \\tau^2)$$\n        两边乘以 $2$：\n        $$2 - 2\\tau - \\tau^2 = 1 + 2\\tau + \\tau^2$$\n        $$2\\tau^2 + 4\\tau - 1 = 0$$\n        解关于 $\\tau$ 的二次方程：\n        $$\\tau = \\frac{-4 \\pm \\sqrt{16 - 4(2)(-1)}}{4} = \\frac{-4 \\pm \\sqrt{24}}{4} = \\frac{-2 \\pm \\sqrt{6}}{2}$$\n        因为时间必须是正的（$\\tau0$），我们取正根：\n        $$\\tau = \\frac{-2+\\sqrt{6}}{2} = -1 + \\frac{\\sqrt{6}}{2}$$\n\n6.  **寻找最小终端时间 $T$：**\n    -   **弧段2：** $t \\in (\\tau, T]$, $u(t) = +1$。\n        该弧段从 $x(\\tau)$ 开始，到 $x(T)=(0,0)$ 结束。从 $\\mathcal{S}_+$ 上的点 $(x_1,x_2)$ 使用 $u=+1$ 到达原点所需的时间由 $t_{final\\_arc} = -x_2$ 给出。\n        第二段弧的持续时间是 $T-\\tau$。因此：\n        $$T-\\tau = -x_2(\\tau)$$\n        我们有 $x_2(\\tau) = -1-\\tau$。\n        $$T-\\tau = -(-1-\\tau) = 1+\\tau$$\n        $$T = 2\\tau + 1$$\n        代入 $\\tau$ 的值：\n        $$T = 2 \\left(\\frac{\\sqrt{6}-2}{2}\\right) + 1 = (\\sqrt{6}-2) + 1 = \\sqrt{6}-1$$\n\n最优开关时间是 $\\tau = \\frac{\\sqrt{6}-2}{2}$，最小终端时间是 $T = \\sqrt{6}-1$。bang-bang序列是在 $[0, \\tau]$ 上 $u=-1$，在 $(\\tau, T]$ 上 $u=+1$。\n\n最终答案是有序对 $(\\tau, T)$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{\\sqrt{6}-2}{2}  \\sqrt{6}-1 \\end{pmatrix} } $$"
        },
        {
            "introduction": "虽然许多最优控制问题会得到砰砰解，但某些情况下需要更为精细的处理。当哈密尔顿量对控制是线性的，并且决定控制符号的“切换函数”在某个时间区间内恒为零时，就会出现这种情况。这些区间被称为“奇异弧”（singular arcs），在这些弧上，标准的砰砰控制律失效。本练习  演示了求解奇异控制的基本技巧：沿时间重复对切换函数求导，直到控制变量显式出现，从而可以直接求解。对于掌握那些砰砰控制不足以解决的系统分析而言，这项练习至关重要，它提供了一种处理奇异最优控制的直接计算方法。",
            "id": "3162826",
            "problem": "考虑一个受控系统，其状态为 $x(t) = \\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\end{pmatrix} \\in \\mathbb{R}^{2}$，控制为 $u(t) \\in [-1,1]$，时间域为固定的 $t \\in [0,T]$：\n$$\n\\dot{x}_{1}(t) = x_{2}(t), \\qquad \\dot{x}_{2}(t) = -x_{1}(t) + u(t).\n$$\n待最小化的性能指标是关于控制呈线性的运行成本的积分，\n$$\nJ[u] = \\int_{0}^{T} L(x(t),u(t)) \\, dt, \\qquad L(x,u) = c(x) \\, u, \\qquad c(x) = x_{1}.\n$$\n使用庞特里亚金极大值原理（Pontryagin Maximum Principle, PMP），研究奇异最优控制的可能性。该原理指出，沿着最优轨迹存在一个非平凡的协态 $p(t) = \\begin{pmatrix} p_{1}(t) \\\\ p_{2}(t) \\end{pmatrix}$，使得哈密顿量\n$$\nH(x,u,p) = p^{\\top}\\big(f(x) + g(x)u\\big) - L(x,u)\n$$\n几乎处处被最优控制 $u(t)$ 最大化，其中 $f(x) = \\begin{pmatrix} x_{2} \\\\ -x_{1} \\end{pmatrix}$ 和 $g(x) = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。奇异控制发生在一个区间上，在该区间上开关函数为零。由于对 $u$ 的线性关系，必须沿着轨迹对开关函数进行微分，直到控制 $u$ 显式地出现；然后通过强制奇异性持续存在的条件来确定奇异控制值。\n\n推导哈密顿量、协态动力学和开关函数。然后，假设在一个奇异弧上，开关函数及其一阶时间导数都为零，通过沿着轨迹对开关函数进行微分，直到 $u$ 出现，并强制奇异性持续存在，来计算奇异控制 $u_{\\text{sing}}$ 的显式值。将最终答案表示为单个实数。无需四舍五入。",
            "solution": "问题要求解一个指定的关于控制呈线性的最优控制问题中奇异控制 $u_{\\text{sing}}$ 的显式值。将使用庞特里亚金极大值原理（PMP）进行分析。\n\n首先，我们根据问题陈述定义系统各组成部分。状态向量为 $x(t) = \\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\end{pmatrix}$，控制输入为 $u(t) \\in [-1, 1]$。状态动力学由以下公式给出：\n$$\n\\dot{x}_{1}(t) = x_{2}(t) \\\\\n\\dot{x}_{2}(t) = -x_{1}(t) + u(t)\n$$\n这可以写成 $\\dot{x} = f(x) + g(x)u$ 的形式，其中：\n$$\nf(x) = \\begin{pmatrix} x_{2} \\\\ -x_{1} \\end{pmatrix}, \\qquad g(x) = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n拉格朗日量（运行成本）为 $L(x, u) = x_{1}u$。\n\n根据庞特里亚金极大值原理，对于一条最优轨迹，存在一个非零的协态向量 $p(t) = \\begin{pmatrix} p_{1}(t) \\\\ p_{2}(t) \\end{pmatrix}$，使得哈密顿量 $H(x, u, p)$ 关于控制 $u$ 最大化。哈密顿量定义为 $H(x, u, p) = p^{\\top}\\dot{x} - L(x, u)$。注意，问题为我们的目的提供了一个略有不同但等价的定义（$H = p^{\\top}(f+gu) - L$）。我们将使用控制理论中对于最小化问题的标准定义，即 $H= p^{\\top}\\dot{x} + L_0$，其中目标是 $\\min \\int_0^T L_0(x,u) dt$。为了与问题陈述中的最大化提法相协调，我们考虑最小化 $J = \\int L(x,u) dt$，这等价于最大化 $\\int -L(x,u) dt$。因此，用于最大化的哈密顿量是 $H = p^{\\top}\\dot{x} - L(x,u)$。我们以此公式进行推导。\n\n代入系统动力学和拉格朗日量，哈密顿量为：\n$$\nH(x, u, p) = p_{1}(t)\\dot{x}_{1}(t) + p_{2}(t)\\dot{x}_{2}(t) - L(x(t), u(t))\n$$\n$$\nH(x, u, p) = p_{1}x_{2} + p_{2}(-x_{1} + u) - x_{1}u\n$$\n我们可以重新整理这个表达式，以分离出依赖于控制 $u$ 的项：\n$$\nH(x, u, p) = (p_{1}x_{2} - p_{2}x_{1}) + (p_{2} - x_{1})u\n$$\n哈密顿量关于控制 $u$ 是线性的。乘以 $u$ 的项是开关函数，我们记为 $\\Phi(t)$。\n$$\n\\Phi(t) = \\frac{\\partial H}{\\partial u} = p_{2}(t) - x_{1}(t)\n$$\n最优控制 $u^*(t)$ 使 $H$ 最大化。在控制约束 $u \\in [-1, 1]$ 下，最优控制律由以下公式给出：\n$$\nu^{*}(t) = \\begin{cases}\n1  \\text{若 } \\Phi(t)  0 \\\\\n-1  \\text{若 } \\Phi(t)  0 \\\\\n\\text{不确定}  \\text{若 } \\Phi(t) = 0\n\\end{cases}\n$$\n奇异弧是一段时间区间，在此区间上 $\\Phi(t) = 0$。为维持此条件，开关函数的所有时间导数也必须为零，即 $\\Phi^{(k)}(t) = 0$ 对 $k = 1, 2, \\ldots$ 成立。我们必须对 $\\Phi(t)$ 求导，直到控制 $u$ 显式出现。\n\n协态动力学由典范方程 $\\dot{p} = -\\frac{\\partial H}{\\partial x}$ 给出。\n$$\n\\dot{p}_{1} = -\\frac{\\partial H}{\\partial x_{1}} = -(-p_{2} - u) = p_{2} + u\n$$\n$$\n\\dot{p}_{2} = -\\frac{\\partial H}{\\partial x_{2}} = -(p_{1}) = -p_{1}\n$$\n现在，我们计算开关函数 $\\Phi(t) = p_{2}(t) - x_{1}(t)$ 的时间导数。\n一阶导数为：\n$$\n\\dot{\\Phi}(t) = \\frac{d}{dt}\\Phi(t) = \\dot{p}_{2}(t) - \\dot{x}_{1}(t)\n$$\n代入 $\\dot{p}_{2}$ 和 $\\dot{x}_{1}$ 的表达式：\n$$\n\\dot{\\Phi}(t) = -p_{1}(t) - x_{2}(t)\n$$\n在奇异弧上，我们必须有 $\\Phi(t) = 0$ 和 $\\dot{\\Phi}(t) = 0$。\n条件 $\\Phi(t) = 0$ 意味着 $p_{2}(t) = x_{1}(t)$。\n条件 $\\dot{\\Phi}(t) = 0$ 意味着 $-p_{1}(t) - x_{2}(t) = 0$，或 $p_{1}(t) = -x_{2}(t)$。\n控制 $u$ 没有出现在 $\\dot{\\Phi}(t)$ 的表达式中。因此，我们必须计算二阶时间导数。\n$$\n\\ddot{\\Phi}(t) = \\frac{d}{dt}\\dot{\\Phi}(t) = -\\dot{p}_{1}(t) - \\dot{x}_{2}(t)\n$$\n代入 $\\dot{p}_{1}$ 和 $\\dot{x}_{2}$ 的表达式：\n$$\n\\ddot{\\Phi}(t) = -(p_{2}(t) + u(t)) - (-x_{1}(t) + u(t))\n$$\n$$\n\\ddot{\\Phi}(t) = -p_{2}(t) - u(t) + x_{1}(t) - u(t)\n$$\n$$\n\\ddot{\\Phi}(t) = x_{1}(t) - p_{2}(t) - 2u(t)\n$$\n在奇异弧上，我们也必须有 $\\ddot{\\Phi}(t) = 0$。强制该条件的控制即为奇异控制 $u_{\\text{sing}}(t)$。令 $\\ddot{\\Phi}(t) = 0$：\n$$\nx_{1}(t) - p_{2}(t) - 2u_{\\text{sing}}(t) = 0\n$$\n我们还知道，在奇异弧上，$\\Phi(t) = p_{2}(t) - x_{1}(t) = 0$，这意味着 $p_{2}(t) = x_{1}(t)$。将此代入 $\\ddot{\\Phi}(t) = 0$ 的方程中：\n$$\nx_{1}(t) - x_{1}(t) - 2u_{\\text{sing}}(t) = 0\n$$\n$$\n0 - 2u_{\\text{sing}}(t) = 0\n$$\n$$\n-2u_{\\text{sing}}(t) = 0\n$$\n解出 $u_{\\text{sing}}(t)$ 得到：\n$$\nu_{\\text{sing}}(t) = 0\n$$\n该值是一个常数，并且位于容许控制集 $0 \\in [-1, 1]$ 内。因此，奇异控制的显式值为0。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "进入庞特里亚金极大值原理更深层次的几何层面，我们会遇到“反常极值”（abnormal extremals）。这些特殊的轨迹完全由系统的动力学和约束决定，而与所要最小化的代价函数无关。反常极值的出现，对应于与运行成本相关的协态乘子 $p_0$ 为零的情形。它们的存在性与系统矢量场的几何性质紧密相关，通常预示着局部可控性的丧失。本练习  提供了一个存在此类极值的具体系统。通过完成此题，您将学会识别反常性条件（$p_0=0$），推导由此产生的对协态变量的必要条件，并验证一条特定轨迹确实是反常极值，从而深入理解几何控制理论中最精妙和深刻的概念之一。",
            "id": "3762921",
            "problem": "考虑流形 $M = \\mathbb{R}^{3}$，其坐标为 $(x,y,z)$，以及控制仿射系统\n$$\n\\dot{q}(t) = u_{1}(t) X_{1}(q(t)) + u_{2}(t) X_{2}(q(t)),\n$$\n其中 $q(t) \\in M$，$(u_{1}(t),u_{2}(t)) \\in U := \\{(u_{1},u_{2}) \\in \\mathbb{R}^{2} : u_{1}^{2}+u_{2}^{2} \\leq 1\\}$，且向量场为\n$$\nX_{1}(x,y,z) = \\partial_{x} + y^{2} \\partial_{z}, \\qquad X_{2}(x,y,z) = \\partial_{y}.\n$$\n我们考虑时间最优问题：在所有将 $q(0) = (0,0,0)$ 驱动到 $q(T) = (x_{T}, 0, 0)$（对于某个固定的 $x_{T}  0$）的容许控制 $(u_{1},u_{2})$ 中，最小化转移时间 $T$。在几何力学和辛框架内使用庞特里亚金极大值原理，其中极值曲线是到赋予了典范辛形式的余切丛 $T^{*}M$ 上的提升。\n\n任务：\n1. 为此问题构建庞特里亚金哈密顿量 $H(q,p,u,p_{0})$，并解释正常极值曲线（$p_{0}  0$）和异常极值曲线（$p_{0} = 0$）之间的区别。推导异常极值曲线的一阶必要最优性条件，包括在 $U$ 上的最大化条件以及由哈密顿向量场在 $T^{*}M$ 上诱导的协态动力学。\n2. 证明该系统存在异常极值曲线，并找出一个完全位于平面 $y=0$ 内的非平凡异常极值曲线。特别地，考虑轨迹\n$$\nq(t) = (t,0,0), \\qquad t \\in [0,T], \\quad \\text{以及控制} \\quad u_{1}(t) \\equiv 1, \\; u_{2}(t) \\equiv 0.\n$$\n3. 推导此异常极值曲线的协态 $p(t) \\in T^{*}_{q(t)}M$ 所需满足的必要条件，并显式计算协态分量 $(p_{x}(t), p_{y}(t), p_{z}(t))$ 沿着任务2中轨迹的时间演化。将你对 $(p_{x}(t), p_{y}(t), p_{z}(t))$ 的最终答案表示为单一的闭式解析表达式。无需四舍五入。不包含单位。如果你的最终表达式包含常数，可以将其保留为符号参数。",
            "solution": "所给出的问题是几何控制理论领域中一个定义明确的时间最优控制问题。所有提供的信息——状态空间 $M = \\mathbb{R}^3$、控制仿射动力学 $\\dot{q} = u_1 X_1 + u_2 X_2$、向量场 $X_1$ 和 $X_2$、控制约束集 $U$ 以及边界条件 $q(0)=(0,0,0)$ 和 $q(T)=(x_T,0,0)$——在数学上是精确、自洽且一致的。在其几何/辛形式下应用庞特里亚金极大值原理来分析异常极值曲线的指定任务是该领域的一个标准且严谨的程序。任务2中提供的候选轨迹和控制与系统动力学一致。该问题没有科学缺陷、歧义或矛盾。因此，该问题是有效的，可以推导出解答。\n\n按要求，该问题分三部分解答。\n\n**1. 庞特里亚金哈密顿量与异常极值曲线的条件**\n\n目标是最小化最终时间 $T$，这对应于一个成本泛函 $J = \\int_0^T 1 \\, dt$。拉格朗日量为 $L(q,u) = 1$。状态方程为 $\\dot{q} = u_1 X_1(q) + u_2 X_2(q)$，其中 $q=(x,y,z)$，$X_1 = \\partial_x + y^2 \\partial_z = (1, 0, y^2)$，$X_2 = \\partial_y = (0, 1, 0)$。\n\n根据庞特里亚金极大值原理 (PMP)，对于一个最优轨迹 $q(t)$ 和其控制 $u(t)$，存在一条非零曲线 $(p(t), p_0)$，其中 $p(t) \\in T_{q(t)}^*M$ 是协态，$p_0 \\leq 0$ 是一个常数。庞特里亚金哈密顿量定义为：\n$$ H(q, p, u, p_0) = \\langle p, \\dot{q} \\rangle + p_0 L(q,u) $$\n这里，$p = (p_x, p_y, p_z)$ 是协态向量。我们定义控制哈密顿量 $H_i(q,p) = \\langle p, X_i(q) \\rangle$，其中 $i=1,2$。\n$$ H_1(q,p) = \\langle (p_x, p_y, p_z), (1, 0, y^2) \\rangle = p_x + y^2 p_z $$\n$$ H_2(q,p) = \\langle (p_x, p_y, p_z), (0, 1, 0) \\rangle = p_y $$\n庞特里亚金哈密顿量可以写为：\n$$ H(q, p, u, p_0) = u_1 H_1(q,p) + u_2 H_2(q,p) + p_0 $$\n正常极值曲线和异常极值曲线的区别基于 $p_0$ 的值：\n- **正常极值曲线**：$p_0  0$。根据齐次性，我们可以将 $p_0$ 归一化为 $-1$。成本函数通过哈密顿量 $H = u_1 H_1 + u_2 H_2 - 1$ 被真正地纳入优化中。\n- **异常极值曲线**：$p_0 = 0$。哈密顿量变为 $H_{ab} = u_1 H_1 + u_2 H_2$。这些极值曲线与成本函数无关，完全由向量场和控制约束的几何性质决定。PMP 提升上的非零条件意味着 $p(t)$ 不能恒为零。\n\n对于异常极值曲线 ($p_0=0$)，PMP 的必要条件是：\n1.  **哈密顿动力学**：极值曲线 $(q(t), p(t))$ 根据余切丛 $T^*M$ 上 $H_{ab}$ 的哈密顿方程演化。哈密顿向量场 $\\vec{H}_{ab}$ 生成流：$\\dot{q} = \\frac{\\partial H_{ab}}{\\partial p}$ 和 $\\dot{p} = -\\frac{\\partial H_{ab}}{\\partial q}$。\n    $$ \\dot{x} = \\frac{\\partial H_{ab}}{\\partial p_x} = u_1, \\quad \\dot{y} = \\frac{\\partial H_{ab}}{\\partial p_y} = u_2, \\quad \\dot{z} = \\frac{\\partial H_{ab}}{\\partial p_z} = u_1 y^2 $$\n    这些正是给定的状态动力学。协态动力学为：\n    $$ \\dot{p}_x = -\\frac{\\partial H_{ab}}{\\partial x} = 0 $$\n    $$ \\dot{p}_y = -\\frac{\\partial H_{ab}}{\\partial y} = -\\frac{\\partial}{\\partial y}(u_1(p_x + y^2 p_z) + u_2 p_y) = -2 u_1 y p_z $$\n    $$ \\dot{p}_z = -\\frac{\\partial H_{ab}}{\\partial z} = 0 $$\n2.  **最大化条件**：对于几乎所有的 $t \\in [0,T]$，最优控制 $u^*(t)$ 使哈密顿量最大化：\n    $$ H_{ab}(q(t), p(t), u^*(t)) = \\max_{v \\in U} H_{ab}(q(t), p(t), v) $$\n3.  **哈密顿量值**：对于时间最优问题，最大化的哈密顿量在极值轨迹上必须为常数且等于零：\n    $$ H_{ab}(q(t), p(t), u^*(t)) = u_1^*(t) H_1(t) + u_2^*(t) H_2(t) = 0 $$\n    在圆盘 $U$ 上最大化线性函数 $u_1 H_1 + u_2 H_2$，并满足最大值为零的条件，意味着向量 $(H_1(t), H_2(t))$ 必须是零向量。如果不是，最大值将是 $\\sqrt{H_1(t)^2 + H_2(t)^2}  0$。因此，异常极值曲线的一个必要条件是\n    $$ H_1(q(t), p(t)) = 0 \\quad \\text{and} \\quad H_2(q(t), p(t)) = 0 $$\n    对于几乎所有的 $t \\in [0,T]$。\n\n**2. 非平凡异常极值曲线的存在性**\n\n我们需要证明存在一条轨迹 $q(t)$ 和一个非零协态 $p(t)$ 满足异常条件。问题提出了轨迹 $q(t) = (t,0,0)$（对于 $t \\in [0,T]$）以及控制 $u_1(t) \\equiv 1, u_2(t) \\equiv 0$。\n\n首先，我们验证该轨迹是否有效。\n对于 $q(t)=(t,0,0)$，我们有 $\\dot{q}(t)=(1,0,0)$。\n当 $u=(1,0)$ 且 $y=0$ 时，动力学方程为 $\\dot{q} = 1 \\cdot X_1(t,0,0) + 0 \\cdot X_2(t,0,0)$。\n$X_1(t,0,0) = \\partial_x + 0^2 \\partial_z = \\partial_x$，对应于向量 $(1,0,0)$。\n所以，$\\dot{q} = 1 \\cdot (1,0,0) = (1,0,0)$，这是一致的。控制 $u=(1,0)$ 属于 $U$，因为 $1^2+0^2=1 \\leq 1$。轨迹从 $q(0)=(0,0,0)$ 开始，在 $q(T)=(T,0,0)$ 结束。对于给定的 $x_T0$，我们可以设置 $T=x_T$。\n\n现在，我们检查这是否能成为一条异常极值曲线。必须存在一个非零的 $p(t)$，使得沿着该路径 $H_1(t)=0$ 和 $H_2(t)=0$ 成立，且 $p(t)$ 必须满足协态方程。沿着 $q(t)=(t,0,0)$ 的条件 $H_1=0$ 和 $H_2=0$ 变为：\n$$ H_1(t) = p_x(t) + y(t)^2 p_z(t) = p_x(t) + 0^2 \\cdot p_z(t) = p_x(t) = 0 $$\n$$ H_2(t) = p_y(t) = 0 $$\n所以，要使我们的轨迹是异常的，协态必须在所有 $t$ 上都满足 $p_x(t) = 0$ 和 $p_y(t) = 0$。\n\n我们来检查与协态动力学的一致性，使用 $u(t)=(1,0)$ 和 $q(t)=(t,0,0)$：\n$$ \\dot{p}_x = 0 \\implies p_x(t) = \\text{常数} $$\n$$ \\dot{p}_y = -2 u_1(t) y(t) p_z(t) = -2(1)(0)p_z(t) = 0 \\implies p_y(t) = \\text{常数} $$\n$$ \\dot{p}_z = 0 \\implies p_z(t) = \\text{常数} $$\n条件 $p_x(t)=0$ 要求积分常数为 $0$，这是一致的。\n条件 $p_y(t)=0$ 要求积分常数为 $0$，这也是一致的。\n关于 $p_z(t)$ 的方程意味着 $p_z(t)=C$，其中 $C$ 是某个常数。\n因此，我们有一个候选的协态轨迹 $p(t) = (0, 0, C)$。为使极值曲线是非平凡的（即 $(p(t),p_0)$ 永不为零且 $p_0=0$），我们必须有 $p(t) \\neq 0$，这意味着 $C \\neq 0$。\n\n因此，轨迹 $q(t)=(t,0,0)$ 与控制 $u(t)=(1,0)$，配上协态 $p(t)=(0,0,C)$（对于任意非零常数 $C$），满足异常极值曲线的所有一阶必要条件。这证明了存在一条位于平面 $y=0$ 内的非平凡异常极值曲线。\n\n**3. 异常极值曲线上的协态演化**\n\n我们被要求推导特定异常极值曲线 $q(t)=(t,0,0)$（控制为 $u(t)=(1,0)$）上协态 $p(t)$ 所需满足的必要条件，并显式计算协态分量 $(p_x(t), p_y(t), p_z(t))$ 的时间演化。\n\n异常极值曲线上协态的必要条件是：必须存在一个非零的 $p(t)$，使得对于几乎所有的 $t \\in [0,T]$：\n1.  $H_1(q(t),p(t)) = p_x(t) + y(t)^2 p_z(t) = 0$。\n2.  $H_2(q(t),p(t)) = p_y(t) = 0$。\n3.  协态根据 $\\dot{p}(t) = -\\frac{\\partial H_{ab}}{\\partial q}|_{(q(t),p(t),u(t))}$ 演化。\n\n我们将指定的轨迹 $q(t)=(t,0,0)$（其中 $y(t)=0$）代入前两个条件：\n1.  $p_x(t) + (0)^2 p_z(t) = p_x(t) = 0$。\n2.  $p_y(t) = 0$。\n\n这些代数约束必须对所有 $t$ 成立。\n\n现在我们分析沿给定极值路径（其中 $q(t)=(t,0,0)$ 和 $u(t)=(1,0)$）的协态微分方程：\n$$ \\dot{p}_x(t) = 0 $$\n$$ \\dot{p}_y(t) = -2 u_1(t) y(t) p_z(t) = -2(1)(0)p_z(t) = 0 $$\n$$ \\dot{p}_z(t) = 0 $$\n对这些简单的微分方程积分得到：\n$$ p_x(t) = C_x $$\n$$ p_y(t) = C_y $$\n$$ p_z(t) = C_z $$\n其中 $C_x, C_y, C_z$ 是积分常数。\n\n为了得到 $p(t)$ 的最终表达式，我们必须强制执行从 $H_1=0$ 和 $H_2=0$ 推导出的代数约束。\n由 $p_x(t)=0$，我们必须有 $C_x=0$。\n由 $p_y(t)=0$，我们必须有 $C_y=0$。\n分量 $p_z(t)$ 只是一个常数，$p_z(t)=C_z$。\n根据 PMP 的要求，为使极值曲线非平凡，协态向量 $p(t)$ 不能是零向量。因此，我们必须有 $C_z \\neq 0$。\n\n因此，协态分量的时间演化由下式给出：\n$$ p_x(t) = 0 $$\n$$ p_y(t) = 0 $$\n$$ p_z(t) = C $$\n其中 $C$ 是一个任意非零常数。我们将此符号参数表示为 $C$。最终得到的协态向量表达式为 $(p_x(t), p_y(t), p_z(t)) = (0, 0, C)$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0  0  C \\end{pmatrix} } $$"
        }
    ]
}