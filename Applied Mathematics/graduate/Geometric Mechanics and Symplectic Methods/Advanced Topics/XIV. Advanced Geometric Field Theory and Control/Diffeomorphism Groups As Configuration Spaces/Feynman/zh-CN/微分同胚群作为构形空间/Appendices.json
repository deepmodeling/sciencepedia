{
    "hands_on_practices": [
        {
            "introduction": "这第一个练习为后续内容奠定了基础。它将微分同胚群在点（地标）构型上的抽象李群作用，与李代数对偶空间中的一个具体对象——动量映射——联系起来。通过推导其平流定律，您将看到欧拉-庞加莱方程如何优雅地描述这种动量的输运，这是计算解剖学中许多模型的无坐标基础。",
            "id": "3738117",
            "problem": "设 $M$ 为一个带体积形式 $\\mu$ 的光滑、可定向、有限维黎曼流形，并令 $\\mathrm{Diff}(M)$ 表示 $M$ 上的光滑微分同胚群。考虑 $N$ 个点地标 $q=(q_{1},\\dots,q_{N})\\in M^{N}$ 的位形空间，其上 $\\mathrm{Diff}(M)$ 的自然左作用由 $\\Phi\\cdot(q_{1},\\dots,q_{N})=(\\Phi(q_{1}),\\dots,\\Phi(q_{N}))$ 给出。设 $T^{\\ast}M^{N}$ 是具有典范辛结构的余切丛，并将 $T^{\\ast}_{q}M^{N}$ 中的元素写为 $p=(p_{1},\\dots,p_{N})$，其中 $p_{a}\\in T^{\\ast}_{q_{a}}M$。$\\mathrm{Diff}(M)$-作用的余切提升导出一个相关的动量映射 $J:T^{\\ast}M^{N}\\to\\mathfrak{X}(M)^{\\ast}$，其中 $\\mathfrak{X}(M)$ 是 $M$ 上光滑向量场的李代数，由典范配对定义\n$$\n\\langle J(q,p),\\xi\\rangle=\\sum_{a=1}^{N}p_{a}\\big(\\xi(q_{a})\\big),\\quad \\xi\\in\\mathfrak{X}(M).\n$$\n此处，$\\langle\\cdot,\\cdot\\rangle$ 表示对偶配对，$p_{a}(\\xi(q_{a}))$ 是余向量 $p_{a}$ 在向量 $\\xi(q_{a})$ 上的求值。\n\n1. 通过用狄拉克测度来识别 $J(q,p)$，将其计算为 $M$ 上的一个显式分布值1-形式。回想一下，对于所有检验函数 $f$，在 $x\\in M$ 处的狄拉克测度 $\\delta_{x}$ 满足 $\\int_{M}f\\,\\delta_{x}=f(x)$。\n\n2. 考虑在 $\\mathrm{Diff}(M)$ 上关于由一个对称、正定、自伴的椭圆算子 $L:\\mathfrak{X}(M)\\to\\mathfrak{X}(M)$ 导出的右不变度量的测地运动。微分同胚群上的欧拉-庞加莱方程（EPDiff）在欧拉变量中由方程对 $m=L u$ 和演化方程 $\\partial_{t}m+\\operatorname{ad}^{\\ast}_{u}m=0$ 给出，其中 $u$ 是速度向量场，$\\operatorname{ad}^{\\ast}_{u}$ 是在1-形式密度上的余伴随作用，等价于 $\\operatorname{ad}^{\\ast}_{u}m=\\mathcal{L}_{u}m$，即沿 $u$ 的李导数。令 $\\phi_{t}:M\\to M$ 表示 $u$ 的流，定义为 $\\partial_{t}\\phi_{t}=u\\circ\\phi_{t}$，其中 $\\phi_{0}=\\mathrm{id}_{M}$。\n\n从上述基本定义出发，在不假设任何特定坐标系的情况下，推导由地标初始数据 $m(0)=J\\big(q(0),p(0)\\big)$ 产生的分布动量 $m(t)$ 所满足的平流定律。最后用流 $\\phi_{t}$ 和初始地标数据 $\\big(q_{a}(0),p_{a}(0)\\big)_{a=1}^{N}$ 给出一个关于 $m(t)$ 的单一闭式解析表达式。\n\n你的最终答案必须是一个单一表达式或一对表达式。如果你同时提供动量映射和平流后的动量，请将它们写成一个单行矩阵。最终方框内的答案中不要包含任何等号。",
            "solution": "该问题被认为是有效的，因为它科学上基于几何力学的既定原理，是适定且客观的。它为微分同胚群上的欧拉-庞加莱方程（EPDiff）理论中的一个标准推导提供了完整且一致的设置。\n\n问题分为两部分。首先，我们被要求将动量映射 $J(q,p)$ 表示为一个分布值1-形式。其次，我们必须在 EPDiff 动力学下推导该动量 $m(t)$ 的时间演化。\n\n第1部分：作为分布的动量映射\n\n动量映射 $J: T^{\\ast}M^{N} \\to \\mathfrak{X}(M)^{\\ast}$ 是通过其与任意光滑向量场 $\\xi \\in \\mathfrak{X}(M)$ 的配对来定义的：\n$$\n\\langle J(q,p),\\xi\\rangle = \\sum_{a=1}^{N} p_{a}\\big(\\xi(q_{a})\\big)\n$$\n此处，$(q,p) = (q_1, \\dots, q_N, p_1, \\dots, p_N)$，其中 $q_a \\in M$ 且 $p_a \\in T_{q_a}^*M$。空间 $\\mathfrak{X}(M)^*$ 是光滑向量场空间的对偶空间，它可以被等同于 $M$ 上的分布值1-形式空间。\n\n为了将 $J(q,p)$ 表示为一个显式分布，我们使用狄拉克delta分布。对于一个点 $x_0 \\in M$，狄拉克分布 $\\delta_{x_0}$ 由其对检验函数 $f: M \\to \\mathbb{R}$ 的作用定义，即 $\\int_M f(x) \\delta_{x_0}(x) d\\mu(x) = f(x_0)$。我们可以将这个概念推广到余向量值分布。对于一个余向量 $p_0 \\in T_{x_0}^*M$，我们将对象 $p_0 \\delta_{x_0}$ 定义为一个分布值1-形式，其对向量场 $\\xi \\in \\mathfrak{X}(M)$ 的作用由下式给出：\n$$\n\\langle p_0 \\delta_{x_0}, \\xi \\rangle := p_0(\\xi(x_0))\n$$\n这是 $\\mathfrak{X}(M)$ 上的一个良定义的线性泛函。\n\n将此定义与给定的动量映射公式进行比较，我们可以看到 $\\langle J(q,p), \\xi \\rangle$ 是此类项的和。具体来说，\n$$\n\\langle J(q,p), \\xi \\rangle = \\sum_{a=1}^{N} p_{a}\\big(\\xi(q_{a})\\big) = \\sum_{a=1}^{N} \\langle p_a \\delta_{q_a}, \\xi \\rangle = \\left\\langle \\sum_{a=1}^{N} p_a \\delta_{q_a}, \\xi \\right\\rangle\n$$\n由于这对任意 $\\xi \\in \\mathfrak{X}(M)$ 都成立，我们可以将动量映射 $J(q,p)$ 等同于以下分布值1-形式：\n$$\nJ(q,p) = \\sum_{a=1}^{N} p_{a} \\delta_{q_{a}}\n$$\n这个表达式将动量表示为位于点 $q_a$ 处的余向量 $p_a$ 的总和。\n\n第2部分：动量的平流\n\n动力学由关于动量 $m(t) \\in \\mathfrak{X}(M)^*$ 的欧拉-庞加莱（EPDiff）方程控制：\n$$\n\\partial_{t}m + \\operatorname{ad}^{\\ast}_{u}m=0\n$$\n其中 $u$ 是通过 $m=Lu$ 与 $m$ 相关的速度向量场，余伴随作用以李导数的形式给出，$\\operatorname{ad}^{\\ast}_{u}m = \\mathcal{L}_{u}m$。因此，该方程是一个输运方程：\n$$\n\\partial_{t}m(t) + \\mathcal{L}_{u(t)}m(t) = 0\n$$\n速度场 $u(t)$ 生成一个流 $\\phi_t: M \\to M$，这是微分同胚群 $\\mathrm{Diff}(M)$ 中的一条路径，定义为 $\\partial_{t}\\phi_{t} = u(t) \\circ \\phi_{t}$，其中 $\\phi_{0}=\\mathrm{id}_{M}$。\n\n为了求解这个输运方程，我们考虑流 $\\phi_t$ 对 $m(t)$ 的拉回。令 $M(t) = \\phi_t^* m(t)$。$M(t)$ 的时间导数由链式法则和性质 $\\frac{d}{dt}\\phi_t^* = \\phi_t^* \\mathcal{L}_{u(t)}$ 给出：\n$$\n\\frac{d}{dt}M(t) = \\frac{d}{dt}(\\phi_t^* m(t)) = (\\frac{d}{dt}\\phi_t^*) m(t) + \\phi_t^* (\\partial_t m(t)) = \\phi_t^* (\\mathcal{L}_{u(t)} m(t)) + \\phi_t^* (\\partial_t m(t))\n$$\n提出拉回算子，我们得到：\n$$\n\\frac{d}{dt}M(t) = \\phi_t^* (\\partial_t m(t) + \\mathcal{L}_{u(t)} m(t))\n$$\n根据 EPDiff 方程，括号中的项为零。因此，$\\frac{d}{dt}M(t) = 0$，这意味着 $M(t)$ 不随时间变化。所以，$M(t) = M(0)$。\n$$\n\\phi_t^* m(t) = \\phi_0^* m(0)\n$$\n由于 $\\phi_0 = \\mathrm{id}_M$，其拉回 $\\phi_0^*$ 是恒等算子，所以 $\\phi_t^* m(t) = m(0)$。为了求 $m(t)$，我们将推前算子 $(\\phi_t)_* = (\\phi_t^*)^{-1}$ 应用到方程两边：\n$$\nm(t) = (\\phi_t)_* m(0)\n$$\n这表明动量 $m(t)$ 是通过将初始动量 $m(0)$ 沿流 $\\phi_t$ 推前得到的。\n\n初始条件被指定为 $m(0) = J(q(0), p(0))$。使用我们从第1部分得到的结果：\n$$\nm(0) = \\sum_{a=1}^{N} p_{a}(0) \\delta_{q_{a}(0)}\n$$\n我们将推前算子应用到这个表达式上：\n$$\nm(t) = (\\phi_t)_* \\left( \\sum_{a=1}^{N} p_{a}(0) \\delta_{q_{a}(0)} \\right) = \\sum_{a=1}^{N} (\\phi_t)_* (p_{a}(0) \\delta_{q_{a}(0)})\n$$\n推前算子同时作用于狄拉克delta的位置和余向量。位于 $q_a(0)$ 的狄拉克delta的推前是位于平流点的一个狄拉克delta：\n$$\n(\\phi_t)_* \\delta_{q_{a}(0)} = \\delta_{\\phi_t(q_a(0))}\n$$\n让我们将演化后的地标位置定义为 $q_a(t) = \\phi_t(q_a(0))$。\n\n为了确定余向量 $p_a(0) \\in T_{q_a(0)}^*M$ 是如何被输运的，我们考察推前算子在整个余向量值分布上的作用。这通过其与一个检验向量场 $\\xi$ 的配对来定义。在 $\\mathfrak{X}(M)^*$ 上的推前 $(\\phi_t)_*$ 与在 $\\mathfrak{X}(M)$ 上的伴随作用 $\\text{Ad}_{\\phi_t^{-1}}$ 是对偶的。\n$$\n\\langle m(t), \\xi \\rangle = \\langle (\\phi_t)_* m(0), \\xi \\rangle = \\langle m(0), \\text{Ad}_{\\phi_t^{-1}} \\xi \\rangle\n$$\n伴随作用是 $\\text{Ad}_{\\phi_t^{-1}}\\xi = (\\phi_t^{-1})_*(\\xi \\circ \\phi_t)$。计算与初始动量的配对：\n$$\n\\langle m(t), \\xi \\rangle = \\sum_{a=1}^N p_a(0) \\left( ((\\phi_t^{-1})_*(\\xi \\circ \\phi_t))(q_a(0)) \\right)\n$$\n$p_a(0)$ 的自变量是 $(d\\phi_t^{-1})_{\\phi_t(q_a(0))} (\\xi(\\phi_t(q_a(0)))) = (d\\phi_t^{-1})_{q_a(t)} (\\xi(q_a(t)))$。\n映射 $\\phi_t^{-1}$ 将 $q_a(t)$ 映到 $q_a(0)$。它的拉回 $(\\phi_t^{-1})^*$ 将余向量从 $T_{q_a(0)}^*M$ 映到 $T_{q_a(t)}^*M$。让我们将演化后的动量定义为 $p_a(t) = (\\phi_t^{-1})^* p_a(0)$。根据拉回的定义，对于任意向量 $v \\in T_{q_a(t)}M$：\n$$\n\\langle p_a(t), v \\rangle = \\langle (\\phi_t^{-1})^* p_a(0), v \\rangle = \\langle p_a(0), (d\\phi_t^{-1})_{q_a(t)}(v) \\rangle\n$$\n令 $v = \\xi(q_a(t))$，我们得到 $\\langle p_a(t), \\xi(q_a(t)) \\rangle = \\langle p_a(0), (d\\phi_t^{-1})_{q_a(t)}(\\xi(q_a(t))) \\rangle$。\n因此，我们可以写出：\n$$\n\\langle m(t), \\xi \\rangle = \\sum_{a=1}^N \\langle p_a(t), \\xi(q_a(t)) \\rangle\n$$\n这意味着 $m(t) = \\sum_{a=1}^N p_a(t) \\delta_{q_a(t)}$。代入 $q_a(t)$ 和 $p_a(t)$ 的表达式，我们得到平流后动量的最终闭式表达式：\n$$\nm(t) = \\sum_{a=1}^{N} \\big( (\\phi_t^{-1})^* p_a(0) \\big) \\delta_{\\phi_t(q_a(0))}\n$$\n这个表达式概括了平流定律：地标位置 $q_a$ 被流 $\\phi_t$ 输运，而地标动量 $p_a$ 被相应的余切提升作用输运。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sum_{a=1}^{N} p_{a} \\delta_{q_{a}} & \\sum_{a=1}^{N} ((\\phi_t^{-1})^* p_{a}(0)) \\delta_{\\phi_t(q_{a}(0))}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在先前练习的基础上，本实践将抽象理论具体化。我们将把无限维的EPDiff方程约化为一个有限维的地标哈密顿系统。您将为一个特定的相互作用核计算地标哈密顿量，并推导出在形状分析和医学成像中广泛使用的显式运动方程。",
            "id": "3738094",
            "problem": "考虑由平面微分同胚群 $\\operatorname{Diff}(\\mathbb{R}^{2})$ 给出的组态空间，该空间配备了由作用于足够光滑的向量场上的一个正、自伴、椭圆惯性算子 $A$ 所诱导的右不变黎曼度量。诱导的动能定义了向量场李代数对偶上的一个哈密顿量，并且微分同胚群（EPDiff）上相应的欧拉-庞加莱方程允许一个支撑在有限地标集上的奇异动量拟设。设动量集中在 $N \\geq 2$ 个地标上，形式为\n$$\nm(x,t) = \\sum_{i=1}^{N} p_{i}(t)\\,\\delta\\!\\left(x - q_{i}(t)\\right),\n$$\n其中 $q_{i}(t) \\in \\mathbb{R}^{2}$ 是地标位置，$p_{i}(t) \\in \\mathbb{R}^{2}$ 是相应的共轭动量。假设惯性算子 $A$ 的逆 $A^{-1}$ 由一个标量值高斯核\n$$\nK_{\\sigma}(x) = \\exp\\!\\left(-\\frac{\\|x\\|^{2}}{2\\sigma^{2}}\\right),\n$$\n来近似，其尺度参数 $\\sigma > 0$，各向同性地作用于 $\\mathbb{R}^{2}$ 中的向量，使得由 $m$ 生成的速度场 $u$ 通过卷积 $u = K_{\\sigma} * m$ 给出：\n$$\nu(x,t) = \\sum_{j=1}^{N} K_{\\sigma}\\!\\left(x - q_{j}(t)\\right) p_{j}(t).\n$$\n在具有典范辛结构的余切丛 $T^{*}\\left(\\mathbb{R}^{2N}\\right)$ 上的有限维简化哈密顿量是\n$$\nH(q,p) = \\frac{1}{2} \\sum_{i=1}^{N}\\sum_{j=1}^{N} \\left(p_{i} \\cdot p_{j}\\right) K_{\\sigma}\\!\\left(q_{i} - q_{j}\\right),\n$$\n其中 $q = (q_{1},\\dots,q_{N})$ 且 $p = (p_{1},\\dots,p_{N})$。\n\n从典范哈密顿框架和上述定义出发，计算仅包含地标间交叉贡献（即 $i \\neq j$ 的项）的相互作用项 $H_{\\mathrm{int}}(q,p)$ 的闭式表达式，然后用 $K_{\\sigma}$ 及其梯度推导地标的运动方程 $\\dot{q}_{i}$ 和 $\\dot{p}_{i}$。将最终结果表示为关于 $q_{i}$、$p_{i}$ 和 $\\sigma$ 的解析表达式。不需要数值近似，也无需指定单位。最终答案必须以闭式解析表达式的形式给出。如果您给出多个表达式，请将它们写成一个单行矩阵。",
            "solution": "该问题是有效的。它展示了来自几何力学的一个标准公式，具体涉及将微分同胚群（EPDiff）上的欧拉-庞加莱方程有限维简化为一个相互作用的地标系统。所提供的哈密顿量是良定义的，该任务需要对哈密顿运动方程进行标准的、尽管并非微不足道的推导。所有术语都定义清晰，问题是自洽的并且在科学上是合理的。\n\n求解过程分为两部分。首先，我们确定哈密顿量的相互作用项。其次，我们使用典范哈密顿框架推导地标位置 $q_i$ 和动量 $p_i$ 的运动方程。\n\n相空间是余切丛 $T^{*}\\left(\\mathbb{R}^{2N}\\right)$，它是一个辛流形，具有典范坐标 $(q, p) = (q_1, \\dots, q_N, p_1, \\dots, p_N)$。动力学由哈密顿方程决定：\n$$\n\\dot{q}_{i} = \\frac{\\partial H}{\\partial p_{i}}, \\quad \\dot{p}_{i} = -\\frac{\\partial H}{\\partial q_{i}}\n$$\n其中 $\\frac{\\partial}{\\partial q_{i}}$ 和 $\\frac{\\partial}{\\partial p_{i}}$ 表示关于向量变量 $q_i \\in \\mathbb{R}^2$ 和 $p_i \\in \\mathbb{R}^2$ 的向量梯度。\n\n哈密顿量由下式给出：\n$$\nH(q,p) = \\frac{1}{2} \\sum_{i=1}^{N}\\sum_{j=1}^{N} \\left(p_{i} \\cdot p_{j}\\right) K_{\\sigma}\\!\\left(q_{i} - q_{j}\\right)\n$$\n其中 $K_{\\sigma}(x) = \\exp\\!\\left(-\\frac{\\|x\\|^{2}}{2\\sigma^{2}}\\right)$。\n\n**第1部分：相互作用哈密顿量 $H_{\\mathrm{int}}(q,p)$**\n\n总哈密顿量可以分解为自相互作用项（$i=j$）和交叉相互作用项（$i \\neq j$）。\n自相互作用部分 $H_{\\mathrm{self}}$ 由 $i=j$ 的项求和给出：\n$$\nH_{\\mathrm{self}}(q,p) = \\frac{1}{2} \\sum_{i=1}^{N} \\left(p_{i} \\cdot p_{i}\\right) K_{\\sigma}\\!\\left(q_{i} - q_{i}\\right) = \\frac{1}{2} \\sum_{i=1}^{N} \\|p_{i}\\|^{2} K_{\\sigma}(0)\n$$\n由于 $K_{\\sigma}(0) = \\exp(0) = 1$，自相互作用能纯粹是动能：\n$$\nH_{\\mathrm{self}}(q,p) = \\frac{1}{2} \\sum_{i=1}^{N} \\|p_{i}\\|^{2}\n$$\n相互作用项 $H_{\\mathrm{int}}(q,p)$ 包含所有 $i \\neq j$ 的项：\n$$\nH_{\\mathrm{int}}(q,p) = H(q,p) - H_{\\mathrm{self}}(q,p) = \\frac{1}{2} \\sum_{i=1, i \\neq j}^{N} \\sum_{j=1}^{N} \\left(p_{i} \\cdot p_{j}\\right) K_{\\sigma}\\!\\left(q_{i} - q_{j}\\right)\n$$\n将核 $K_{\\sigma}$ 的表达式代入，我们得到相互作用哈密顿量的闭式表达式：\n$$\nH_{\\mathrm{int}}(q,p) = \\frac{1}{2} \\sum_{i,j=1, i \\neq j}^{N} \\left(p_{i} \\cdot p_{j}\\right) \\exp\\!\\left(-\\frac{\\|q_{i} - q_{j}\\|^{2}}{2\\sigma^{2}}\\right)\n$$\n注意，由于被加数在交换索引 $i$ 和 $j$ 时是对称的，这也可以写成对唯一对的求和，即 $H_{\\mathrm{int}}(q,p) = \\sum_{1 \\le i  j \\le N} \\left(p_{i} \\cdot p_{j}\\right) K_{\\sigma}\\!\\left(q_{i} - q_{j}\\right)$。\n\n**第2部分：地标运动方程**\n\n我们现在推导 $\\dot{q}_i$ 和 $\\dot{p}_i$ 的方程。\n\n**关于 $\\dot{q}_{i}$ 的方程：**\n我们计算 $H$ 对 $p_i$ 的梯度：\n$$\n\\dot{q}_{i} = \\frac{\\partial H}{\\partial p_{i}} = \\frac{\\partial}{\\partial p_{i}} \\left[ \\frac{1}{2} \\sum_{k=1}^{N}\\sum_{j=1}^{N} \\left(p_{k} \\cdot p_{j}\\right) K_{\\sigma}\\!\\left(q_{k} - q_{j}\\right) \\right]\n$$\n我们使用恒等式 $\\frac{\\partial}{\\partial p_i}(p_k \\cdot p_j) = \\delta_{ik} p_j + \\delta_{ij} p_k$，其中 $\\delta_{ij}$ 是克罗内克 delta。\n$$\n\\dot{q}_{i} = \\frac{1}{2} \\sum_{k=1}^{N}\\sum_{j=1}^{N} \\left( \\delta_{ik} p_{j} + \\delta_{ij} p_{k} \\right) K_{\\sigma}\\!\\left(q_{k} - q_{j}\\right)\n$$\n将求和分为两部分：\n$$\n\\dot{q}_{i} = \\frac{1}{2} \\left[ \\sum_{j=1}^{N} p_{j} K_{\\sigma}\\!\\left(q_{i} - q_{j}\\right) + \\sum_{k=1}^{N} p_{k} K_{\\sigma}\\!\\left(q_{k} - q_{i}\\right) \\right]\n$$\n由于 $K_{\\sigma}(x)$ 是偶函数，所以 $K_{\\sigma}(q_k - q_i) = K_{\\sigma}(-(q_i - q_k)) = K_{\\sigma}(q_i - q_k)$。第二个和与第一个和相同（通过将哑索引 $k$ 重命名为 $j$）。\n$$\n\\dot{q}_{i} = \\frac{1}{2} \\left[ 2 \\sum_{j=1}^{N} p_{j} K_{\\sigma}\\!\\left(q_{i} - q_{j}\\right) \\right] = \\sum_{j=1}^{N} K_{\\sigma}\\!\\left(q_{i} - q_{j}\\right) p_{j}\n$$\n这个方程表明，第 $i$ 个地标的速度是所有地标（包括其自身）影响的叠加，其中每个地标 $j$ 贡献一个速度场 $K_\\sigma(x-q_j)p_j$。\n\n**关于 $\\dot{p}_{i}$ 的方程：**\n接下来，我们计算 $H$ 对 $q_i$ 的负梯度：\n$$\n\\dot{p}_{i} = -\\frac{\\partial H}{\\partial q_{i}} = -\\frac{1}{2} \\sum_{k=1}^{N}\\sum_{j=1}^{N} \\left(p_{k} \\cdot p_{j}\\right) \\frac{\\partial}{\\partial q_{i}} K_{\\sigma}\\!\\left(q_{k} - q_{j}\\right)\n$$\n使用链式法则，$\\frac{\\partial}{\\partial q_{i}} f(q_k - q_j) = (\\delta_{ik} - \\delta_{ij}) (\\nabla f)(q_k - q_j)$，其中 $\\nabla f$ 是 $f$ 对其自变量的梯度。\n$$\n\\dot{p}_{i} = -\\frac{1}{2} \\sum_{k=1}^{N}\\sum_{j=1}^{N} \\left(p_{k} \\cdot p_{j}\\right) \\left(\\delta_{ik} - \\delta_{ij}\\right) \\nabla K_{\\sigma}\\!\\left(q_{k} - q_{j}\\right)\n$$\n分解求和：\n$$\n\\dot{p}_{i} = -\\frac{1}{2} \\left[ \\sum_{j=1}^{N} (p_{i} \\cdot p_{j}) \\nabla K_{\\sigma}(q_{i} - q_{j}) - \\sum_{k=1}^{N} (p_{k} \\cdot p_{i}) \\nabla K_{\\sigma}(q_{k} - q_{i}) \\right]\n$$\n设 $g(x) = \\nabla K_{\\sigma}(x)$。由于 $K_{\\sigma}(x)$ 是偶函数，其梯度 $g(x)$ 是奇函数，因此 $g(-x) = -g(x)$。通过将 $k$ 重命名为 $j$ 可以重写第二个和：\n$$\n\\sum_{j=1}^{N} (p_{j} \\cdot p_{i}) \\nabla K_{\\sigma}(q_{j} - q_{i}) = \\sum_{j=1}^{N} (p_{i} \\cdot p_{j}) g(q_{j} - q_{i}) = \\sum_{j=1}^{N} (p_{i} \\cdot p_{j}) \\left( -g(q_{i} - q_{j}) \\right) = -\\sum_{j=1}^{N} (p_{i} \\cdot p_{j}) g(q_{i} - q_{j})\n$$\n将此代回 $\\dot{p}_i$ 的表达式中：\n$$\n\\dot{p}_{i} = -\\frac{1}{2} \\left[ \\sum_{j=1}^{N} (p_{i} \\cdot p_{j}) g(q_{i} - q_{j}) - \\left(-\\sum_{j=1}^{N} (p_{i} \\cdot p_{j}) g(q_{i} - q_{j})\\right) \\right] = - \\sum_{j=1}^{N} (p_{i} \\cdot p_{j}) \\nabla K_{\\sigma}(q_{i}-q_{j})\n$$\n核的梯度是 $\\nabla K_{\\sigma}(x) = \\nabla \\exp\\!\\left(-\\frac{\\|x\\|^{2}}{2\\sigma^{2}}\\right) = -\\frac{x}{\\sigma^{2}} \\exp\\!\\left(-\\frac{\\|x\\|^{2}}{2\\sigma^{2}}\\right) = -\\frac{x}{\\sigma^{2}} K_{\\sigma}(x)$。\n将此代入 $\\dot{p}_i$ 的方程中：\n$$\n\\dot{p}_{i} = - \\sum_{j=1}^{N} (p_{i} \\cdot p_{j}) \\left(-\\frac{q_{i}-q_{j}}{\\sigma^{2}} K_{\\sigma}(q_{i}-q_{j})\\right) = \\frac{1}{\\sigma^{2}} \\sum_{j=1}^{N} (p_{i} \\cdot p_{j}) (q_{i}-q_{j}) K_{\\sigma}(q_{i}-q_{j})\n$$\n求和中 $j=i$ 的项为零，因为 $q_i - q_i = 0$。\n\n综合结果，相互作用哈密顿量和运动方程的最终解析表达式为：\n$H_{\\mathrm{int}}(q,p) = \\frac{1}{2} \\sum_{i,j=1, i \\neq j}^{N} (p_i \\cdot p_j) \\exp\\!\\left(-\\frac{\\|q_i-q_j\\|^2}{2\\sigma^2}\\right)$\n$\\dot{q}_{i} = \\sum_{j=1}^{N} \\exp\\!\\left(-\\frac{\\|q_{i} - q_{j}\\|^{2}}{2\\sigma^{2}}\\right) p_j$\n$\\dot{p}_{i} = \\frac{1}{\\sigma^{2}} \\sum_{j=1}^{N} (p_{i} \\cdot p_{j}) (q_{i}-q_{j}) \\exp\\!\\left(-\\frac{\\|q_{i} - q_{j}\\|^{2}}{2\\sigma^{2}}\\right)$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} \\sum_{i,j=1, i \\neq j}^{N} (p_i \\cdot p_j) \\exp\\left(-\\frac{\\|q_i - q_j\\|^2}{2\\sigma^2}\\right)  \\sum_{j=1}^{N} \\exp\\left(-\\frac{\\|q_i - q_j\\|^2}{2\\sigma^2}\\right) p_j  \\frac{1}{\\sigma^2} \\sum_{j=1}^{N} (p_i \\cdot p_j) (q_i - q_j) \\exp\\left(-\\frac{\\|q_i-q_j\\|^2}{2\\sigma^2}\\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "现实世界的问题通常涉及带边界的区域。本实践探讨了如何将边界条件（例如流体的无通量条件）融入几何框架中。您将为一个带有诺伊曼（Neumann）边界条件的简单一维情况推导惯性算子和修正后的欧拉-庞加莱方程，并计算相应的格林（Green）函数，从而揭示边界如何改变流体元素之间的相互作用。",
            "id": "3738083",
            "problem": "考虑一维流形 $M = [0,\\infty)$，其坐标为 $x$，以及 $M$ 上的保向微分同胚群，该群固定边界点 $x=0$，即容许速度场 $u(x,t)$ 在所有时间 $t$ 满足诺伊曼（Neumann）边界条件 $u_{x}(0,t)=0$。为此位形空间配备一个右不变 $H^{1}$ 黎曼度量，其在单位元处的拉格朗日量定义为\n$$\n\\ell(u) = \\frac{1}{2}\\int_{0}^{\\infty}\\left(u(x,t)^{2} + \\alpha^{2}\\,u_{x}(x,t)^{2}\\right)\\,dx,\n$$\n其中 $\\alpha0$ 是一个固定参数，并假设所有场都是光滑的，且当 $x\\to\\infty$ 时充分衰减。相应的惯性算子 $A$ 由变分关系 $\\delta\\ell = \\langle Au, \\delta u\\rangle$ 定义，其中配对为 $L^{2}$ 配对，且受诺伊曼（Neumann）边界条件约束，因此动量变量为 $m(x,t) = A u(x,t)$。\n\n仅从右不变度量、欧拉-庞加莱（Euler–Poincaré）约化原理以及具有李括号 $[u,v] = u\\,v_{x} - v\\,u_{x}$ 的一维向量场李代数的定义出发，分析诺伊曼（Neumann）边界条件的存在如何影响微分同胚群（EPDiff）上的欧拉-庞加莱（Euler–Poincaré）方程的推导，并通过核表示 $u(x,t) = \\int_{0}^{\\infty}K_{N}(x,y)\\,m(y,t)\\,dy$ 确定将 $m$ 映射到 $u$ 的算子。此处 $K_{N}(x,y)$ 是惯性算子逆的格林（Green）函数核，该算子在 $x=0$ 处满足诺伊曼（Neumann）边界条件，并在 $x\\to\\infty$ 时衰减。\n\n通过将 $K_{N}(0,y)$ 作为 $y\\ge 0$ 和参数 $\\alpha0$ 的函数进行求值，计算该核在边界附近的显式闭式解析表达式。请以单个解析表达式的形式提供最终答案。不需要数值舍入，也不涉及物理单位。",
            "solution": "用户提供了一个几何力学中的有效问题。任务是分析在特定边界条件下微分同胚群上的欧拉-庞加莱方程，并计算逆惯性算子在边界处的核。\n\n位形空间是流形 $M=[0,\\infty)$ 上的一个微分同胚群。速度场 $u(x,t)$ 是相应李代数 $\\mathfrak{g}$ 中的元素，该李代数由 $M$ 上的光滑向量场组成，满足诺伊曼（Neumann）边界条件 $u_x(0,t)=0$ 和当 $x\\to\\infty$ 时的适当衰减条件。该问题为此空间配备了一个右不变 $H^1$ 度量，其在单位元处相关的拉格朗日量由下式给出\n$$\n\\ell(u) = \\frac{1}{2}\\int_{0}^{\\infty}\\left(u(x,t)^{2} + \\alpha^{2}\\,u_{x}(x,t)^{2}\\right)\\,dx\n$$\n其中 $\\alpha0$ 是一个常数。动量 $m(x,t)$ 通过惯性算子 $A$ 定义为 $m = Au$，其中 $A$ 由变分原理 $\\delta\\ell = \\langle Au, \\delta u \\rangle_{L^2}$ 确定。我们来计算对于一个变分 $\\delta u \\in \\mathfrak{g}$ 的 $\\delta\\ell$。\n$$\n\\delta\\ell = \\frac{1}{2}\\int_{0}^{\\infty}\\left(2u\\,\\delta u + 2\\alpha^{2}\\,u_{x}\\,\\delta u_{x}\\right)\\,dx = \\int_{0}^{\\infty}\\left(u\\,\\delta u + \\alpha^{2}\\,u_{x}\\,\\delta u_{x}\\right)\\,dx\n$$\n我们对第二项应用分部积分法：\n$$\n\\int_{0}^{\\infty}\\alpha^{2}\\,u_{x}\\,\\delta u_{x}\\,dx = \\left[\\alpha^{2}\\,u_{x}\\,\\delta u\\right]_{0}^{\\infty} - \\int_{0}^{\\infty}\\alpha^{2}\\,u_{xx}\\,\\delta u\\,dx\n$$\n由于场上的衰减条件，在 $x\\to\\infty$ 处的边界项为零。在 $x=0$ 处，该项为 $-\\alpha^{2}\\,u_{x}(0)\\,\\delta u(0)$。因为任何容许场 $u \\in \\mathfrak{g}$ 都必须满足 $u_x(0)=0$，所以该项为零。因此，整个边界项都为零。拉格朗日量的变分变为\n$$\n\\delta\\ell = \\int_{0}^{\\infty}\\left(u - \\alpha^{2}\\,u_{xx}\\right)\\,\\delta u\\,dx\n$$\n将此与定义 $\\delta\\ell = \\langle Au, \\delta u \\rangle_{L^2} = \\int_{0}^{\\infty} (Au)\\,\\delta u\\,dx$ 相比较，我们确定惯性算子 $A$ 为\n$$\nAu = u - \\alpha^{2}\\,u_{xx}\n$$\n因此动量为 $m(x,t) = u(x,t) - \\alpha^{2}\\,u_{xx}(x,t)$。\n\n测地流的欧拉-庞加莱（Euler-Poincaré）方程是 $\\frac{\\partial m}{\\partial t} = -\\text{ad}^*_u m$，其中 $\\text{ad}^*$ 是关于李括号 $[u,v] = u v_x - v u_x$ 和 $L^2$ 配对的余伴随算子。$\\text{ad}^*_u m$ 在元素 $v \\in \\mathfrak{g}$ 上的作用定义为 $\\langle \\text{ad}^*_u m, v \\rangle = \\langle m, \\text{ad}_u v \\rangle = \\langle m, [u,v] \\rangle$。\n$$\n\\langle m, [u,v] \\rangle = \\int_{0}^{\\infty} m(x)\\,(u(x)v_x(x) - v(x)u_x(x))\\,dx\n$$\n对第一项进行分部积分得到：\n$$\n\\int_{0}^{\\infty} m u v_x \\,dx = [m u v]_{0}^{\\infty} - \\int_{0}^{\\infty} (mu)_x v \\,dx = -m(0)u(0)v(0) - \\int_{0}^{\\infty} (m_x u + m u_x) v \\,dx\n$$\n在 $x\\to\\infty$ 处的边界项为零。在 $x=0$ 处的边界项通常不为零，因为 $v(0)$ 不一定为零。合并各项，我们得到：\n$$\n\\langle m, [u,v] \\rangle = -m(0)u(0)v(0) - \\int_{0}^{\\infty} (m_x u + 2m u_x) v \\,dx\n$$\n为了使关系 $\\langle \\frac{\\partial m}{\\partial t}, v \\rangle = \\langle -\\text{ad}^*_u m, v \\rangle$ 对所有 $v \\in \\mathfrak{g}$ 成立，我们必须有一个对于 $x0$ 的偏微分方程和一个在 $x=0$ 处的单独的边界条件。这导致了修正的欧拉-庞加莱（Euler-Poincaré）系统：\n$$\n\\frac{\\partial m}{\\partial t} + u m_x + 2m u_x = 0 \\quad \\text{for } x0\n$$\n$$\nm(0,t)u(0,t) = 0 \\quad \\text{at } x=0\n$$\n这展示了速度空间 $\\mathfrak{g}$ 上的诺伊曼（Neumann）边界条件如何影响最终的演化方程。\n\n中心任务是找到反演关系 $m=Au$（即 $u = A^{-1}m$）的算子的核 $K_N(x,y)$。这个核是算子 $L = 1 - \\alpha^2\\frac{d^2}{dx^2}$ 在适当边界条件下的格林（Green）函数。格林（Green）函数 $K_N(x,y)$ 的方程是\n$$\n\\left(1 - \\alpha^2\\frac{d^2}{dx^2}\\right) K_N(x,y) = \\delta(x-y)\n$$\n解 $u(x) = \\int_0^\\infty K_N(x,y) m(y) dy$ 必须满足 $u_x(0)=0$ 并在无穷远处衰减。这对作为 $x$ 的函数的 $K_N(x,y)$ 施加了边界条件：\n1. $\\frac{\\partial K_N}{\\partial x}(0,y) = 0$ (诺伊曼（Neumann）条件)\n2. 当 $x \\to \\infty$ 时 $K_N(x,y) \\to 0$ (衰减条件)\n\n对于 $x \\neq y$，方程是齐次的：$K_N - \\alpha^2 K_{N,xx} = 0$，或 $K_{N,xx} - \\frac{1}{\\alpha^2}K_N = 0$。通解是 $e^{x/\\alpha}$ 和 $e^{-x/\\alpha}$ 的线性组合。\n我们为 $0 \\le x  y$ 和 $x  y$ 分段构造解。\n\n对于 $x  y$，为满足当 $x \\to \\infty$ 时的衰减条件，解必须具有以下形式：\n$$\nK_N(x,y) = B(y) e^{-x/\\alpha}\n$$\n对于 $0 \\le x  y$，解为 $K_N(x,y) = C(y)e^{x/\\alpha} + D(y)e^{-x/\\alpha}$。在 $x=0$ 处应用诺伊曼（Neumann）条件：\n$$\n\\frac{\\partial K_N}{\\partial x}(0,y) = \\frac{C(y)}{\\alpha} e^0 - \\frac{D(y)}{\\alpha} e^0 = \\frac{1}{\\alpha}(C(y) - D(y)) = 0 \\implies C(y)=D(y)\n$$\n因此，对于 $0 \\le x  y$，解为 $K_N(x,y) = C(y)(e^{x/\\alpha} + e^{-x/\\alpha}) = E(y)\\cosh(x/\\alpha)$，其中 $E(y)=2C(y)$。\n\n格林（Green）函数必须在 $x=y$ 处满足两个连接条件：\n(a) 连续性：$K_N(x,y)$ 在 $x=y$ 处是连续的。\n$$\nE(y)\\cosh(y/\\alpha) = B(y)e^{-y/\\alpha}\n$$\n(b) 一阶导数的跳跃：将常微分方程从 $y-\\epsilon$ 积分到 $y+\\epsilon$ 得到 $\\frac{\\partial K_N}{\\partial x}(y^+,y) - \\frac{\\partial K_N}{\\partial x}(y^-,y) = -\\frac{1}{\\alpha^2}$。\n$$\n-\\frac{B(y)}{\\alpha}e^{-y/\\alpha} - \\frac{E(y)}{\\alpha}\\sinh(y/\\alpha) = -\\frac{1}{\\alpha^2} \\implies B(y)e^{-y/\\alpha} + E(y)\\sinh(y/\\alpha) = \\frac{1}{\\alpha}\n$$\n我们现在解这个关于 $E(y)$ 和 $B(y)$ 的方程组。将连续性条件代入跳跃条件：\n$$\nE(y)\\cosh(y/\\alpha) + E(y)\\sinh(y/\\alpha) = \\frac{1}{\\alpha}\n$$\n使用恒等式 $\\cosh(z) + \\sinh(z) = e^z$，我们有：\n$$\nE(y)e^{y/\\alpha} = \\frac{1}{\\alpha} \\implies E(y) = \\frac{1}{\\alpha}e^{-y/\\alpha}\n$$\n问题要求解 $K_N(0,y)$。对于任何 $y>0$，我们有 $x=0  y$，因此我们使用适用于 $0 \\le x  y$ 区间的表达式：$K_N(x,y) = E(y)\\cosh(x/\\alpha)$。在 $x=0$ 处求值，得到 $K_N(0,y) = E(y)\\cosh(0) = E(y)$。代入已求出的 $E(y)$，最终结果为 $K_N(0,y) = \\frac{1}{\\alpha}e^{-y/\\alpha}$。",
            "answer": "$$\n\\boxed{\\frac{1}{\\alpha}\\exp\\left(-\\frac{y}{\\alpha}\\right)}\n$$"
        }
    ]
}