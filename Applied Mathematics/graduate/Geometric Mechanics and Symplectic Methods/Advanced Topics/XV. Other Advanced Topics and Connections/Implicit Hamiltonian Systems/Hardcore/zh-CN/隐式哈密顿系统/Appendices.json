{
    "hands_on_practices": [
        {
            "introduction": "在理想情况下，勒让德变换（Legendre transform）为我们提供了从拉格朗日力学到哈密顿力学的直接桥梁。然而，当拉格朗日量是“奇异的”（singular），即其勒让德变换不可逆时，标准的构造方法便会失效，我们就进入了隐式哈密顿系统的领域。这个练习 () 将指导你处理一个经典的奇异拉格朗日量，通过应用 Gotay-Nester 约束算法，你将亲手揭示系统内在的全部约束，并确定其一致的动力学行为。",
            "id": "3747517",
            "problem": "考虑位形流形 $Q=\\mathbb{R}$ 和拉格朗日量 $L:TQ\\to\\mathbb{R}$，其定义为 $L(q,v)=\\sin(q)\\,v-\\frac{1}{2}q^{2}$。\n\n1. 从勒让德变换（也称纤维导数）$\\mathbb{F}L:TQ\\to T^{*}Q$ 的定义出发，即 $\\mathbb{F}L(q,v)=(q,p)$ 且 $p=\\frac{\\partial L}{\\partial v}(q,v)$，解释为什么对于此拉格朗日量 $L$，勒让德变换是不可逆的。\n\n2. 使用作用量泛函为 $S(q,v,p)=\\int_{t_{0}}^{t_{1}}\\left(L(q,v)+p(\\dot{q}-v)\\right)\\,dt$ 的 Hamilton–Pontryagin (HP) 变分原理，推导隐式 Euler–Lagrange–Pontryagin 方程。确定主约束子流形 $\\mathcal{C}_{0}\\subset TQ\\oplus T^{*}Q$ 和广义能量 $E:TQ\\oplus T^{*}Q\\to\\mathbb{R}$。\n\n3. 将用于预辛系统的 Gotay–Nester (GN) 约束算法应用于此 HP 表述。使用 $T^{*}Q$ 上的典范 2-形式 $\\omega=dq\\wedge dp$ 及其到约束子流形的拉回，来施加相容性条件 $i_{X}\\omega=dH$（限制在约束上），其中 $H$ 是从 $E$ 在 $\\mathcal{C}_{0}$ 上得到的约化哈密顿量。确定次级约束，并说明算法是否终止。确定最终约束子流形 $\\mathcal{C}_{\\infty}$ 及其上的约化哈密顿向量场 $X$。\n\n你的最终答案必须是 GN 算法为此例选择的唯一容许对 $(q,p)\\in T^{*}Q$。使用 $\\mathrm{pmatrix}$ 环境将此对表示为行矩阵。不需要单位。如果存在多个容许对，选择动力学一致且在 $\\mathbb{R}^{2}$ 中具有最小欧几里得范数的那一对，并报告该对。无需四舍五入。",
            "solution": "该问题要求使用 Hamilton-Pontryagin 原理和 Gotay-Nester 约束算法，对一个由奇异拉格朗日量描述的系统进行完整分析。我们将验证问题的有效性，然后按要求分三部分进行解答。\n\n问题陈述在科学上基于几何力学的原理，特别是约束哈密顿系统理论。在位形流形 $Q=\\mathbb{R}$ 上的拉格朗日量 $L(q,v)=\\sin(q)\\,v-\\frac{1}{2}q^{2}$ 是一个定义明确的数学对象。这些任务涉及分析此类系统的标准（尽管高级）的程序，即 Hamilton-Pontryagin 变分原理和 Gotay-Nester (GN) 算法。该问题是自洽的、适定的，且所有术语都已明确定义。因此，该问题是有效的，我们可以继续进行求解。\n\n### 第 1 部分：勒让德变换的不可逆性\n\n勒让德变换（或纤维导数）$\\mathbb{F}L: TQ \\to T^*Q$ 将点 $(q, v) \\in TQ$ 映射到点 $(q, p) \\in T^*Q$，其中动量 $p$ 定义为 $p = \\frac{\\partial L}{\\partial v}$。\n\n对于给定的拉格朗日量 $L(q,v)=\\sin(q)\\,v-\\frac{1}{2}q^{2}$，动量为：\n$$\np = \\frac{\\partial L}{\\partial v}(q,v) = \\frac{\\partial}{\\partial v}\\left(\\sin(q)\\,v-\\frac{1}{2}q^{2}\\right) = \\sin(q)\n$$\n因此，勒让德变换是映射 $\\mathbb{F}L(q,v) = (q, \\sin(q))$。\n\n为了可逆，映射 $\\mathbb{F}L$ 必须是双射；也就是说，对于每个 $(q, p) \\in T^*Q$，必须存在一个唯一的 $(q, v) \\in TQ$ 映射到它。这需要根据 $q$ 和 $p$ 求解 $v$。方程 $p = \\sin(q)$ 与 $v$ 无关，这使得对于给定的 $(q,p)$ 不可能确定唯一的 $v$。\n\n更形式化地，不可逆性可以通过两种方式证明：\n1.  该映射不是满射的。$\\mathbb{F}L$ 的像是点的集合 $\\{(q,p) \\in T^*Q \\mid p = \\sin(q)\\}$。这是二维余切丛 $T^*Q \\cong \\mathbb{R}^2$ 的一个一维子流形。任何不在此子流形上的点（即 $p \\neq \\sin(q)$ 的点）在 $TQ$ 中没有原像。\n2.  该映射不是单射的。对于 $\\mathbb{F}L$ 的像中的任何点 $(q,p)$，其原像不是单个点。对于一个固定的 $q_0$，所有点 $(q_0, v)$（对于任何 $v \\in \\mathbb{R}$）都映射到同一个点 $(q_0, \\sin(q_0))$。\n\n检查勒让德变换局部可逆性的一个系统方法是计算纤维 Hessian 矩阵，其分量为 $W_{ij} = \\frac{\\partial^2 L}{\\partial v^i \\partial v^j}$。当且仅当该矩阵非奇异时，变换才是局部可逆的。在我们的一维情况下（$v$ 是标量），这简化为单个分量：\n$$\nW = \\frac{\\partial^2 L}{\\partial v^2} = \\frac{\\partial}{\\partial v}\\left(\\frac{\\partial L}{\\partial v}\\right) = \\frac{\\partial}{\\partial v}(\\sin(q)) = 0\n$$\n由于 Hessian 恒为零（这是奇异的），勒让德变换是不可逆的。这样的拉格朗日量被称为奇异的。\n\n### 第 2 部分：Hamilton–Pontryagin 变分原理\n\nHamilton–Pontryagin (HP) 作用量泛函在扩展空间 $TQ \\oplus T^*Q$ 上给出，坐标为 $(q,v,p)$。作用量为：\n$$\nS(q,v,p) = \\int_{t_{0}}^{t_{1}} \\left( L(q,v) + p(\\dot{q}-v) \\right) \\,dt = \\int_{t_{0}}^{t_{1}} \\left( \\sin(q)v - \\frac{1}{2}q^2 + p\\dot{q} - pv \\right) \\,dt\n$$\n我们通过对 $S$ 进行关于 $q$、$v$ 和 $p$ 的变分并令 $\\delta S = 0$ 来求运动方程。\n$$\n\\delta S = \\int_{t_{0}}^{t_{1}} \\left( \\frac{\\partial L}{\\partial q}\\delta q + \\frac{\\partial L}{\\partial v}\\delta v + \\delta p(\\dot{q}-v) + p(\\delta\\dot{q} - \\delta v) \\right) \\,dt\n$$\n将 $p\\delta\\dot{q}$ 项分部积分，$\\int p\\delta\\dot{q}\\,dt = [p\\delta q]_{t_0}^{t_1} - \\int \\dot{p}\\delta q\\,dt$，其中边界项消失，因为 $\\delta q(t_0)=\\delta q(t_1)=0$。代入 $\\frac{\\partial L}{\\partial q} = \\cos(q)v - q$ 和 $\\frac{\\partial L}{\\partial v} = \\sin(q)$：\n$$\n\\delta S = \\int_{t_{0}}^{t_{1}} \\left( (\\cos(q)v - q - \\dot{p})\\delta q + (\\sin(q)-p)\\delta v + (\\dot{q}-v)\\delta p \\right) \\,dt = 0\n$$\n由于变分 $\\delta q$、$\\delta v$ 和 $\\delta p$ 是独立的，它们的系数必须为零。这就得到了 Euler-Lagrange-Pontryagin 方程：\n1.  $\\delta q: \\quad \\dot{p} = \\cos(q)v - q$\n2.  $\\delta v: \\quad p = \\sin(q)$\n3.  $\\delta p: \\quad \\dot{q} = v$\n\n**主约束子流形** $\\mathcal{C}_0$ 是 $TQ \\oplus T^*Q$ 的一个子集，在该子集上，来自变分原理的代数（非微分）方程必须成立。这由方程 (2) 给出。\n$$\n\\mathcal{C}_{0} = \\{ (q,v,p) \\in TQ \\oplus T^*Q \\mid p - \\sin(q) = 0 \\}\n$$\n**广义能量** $E: TQ \\oplus T^*Q \\to \\mathbb{R}$ 定义为 $E = pv - L(q,v)$：\n$$\nE(q,v,p) = pv - \\left(\\sin(q)v - \\frac{1}{2}q^2\\right) = (p - \\sin(q))v + \\frac{1}{2}q^2\n$$\n\n### 第 3 部分：Gotay–Nester 约束算法\n\nGN 算法应用于从此表述中产生的预辛系统。如问题所示，我们将在具有坐标 $(q,p)$ 的余切丛 $T^*Q$ 及其典范辛形式 $\\omega = dq \\wedge dp$ 上进行研究。\n\n主约束流形是勒让德变换的像，是 $T^*Q$ 的一个子流形：\n$$\nM_1 = \\{ (q,p) \\in T^*Q \\mid \\phi_1(q,p) := p - \\sin(q) = 0 \\}\n$$\n$M_1$ 上的约化哈密顿量 $H$ 是通过将广义能量 $E$ 限制在约束流形 $\\mathcal{C}_0$ 上得到的。在 $\\mathcal{C}_0$ 上，其中 $p=\\sin(q)$，我们有：\n$$\nH = E|_{\\mathcal{C}_0} = (p-\\sin(q))v + \\frac{1}{2}q^2 \\Big|_{p=\\sin(q)} = (0)v + \\frac{1}{2}q^2 = \\frac{1}{2}q^2\n$$\n我们可以将 $H(q,p) = \\frac{1}{2}q^2$ 视为背景空间 $T^*Q$ 上的一个函数。该算法寻找一个与 $M_1$ 相切并且在 $M_1$ 上满足预辛哈密顿方程 $i_X \\omega = dH$ 的向量场 $X$。\n\n首先，我们从方程 $i_X \\omega = dH$ 求解 $T^*Q$ 上的候选向量场 $X$。\n哈密顿量的微分是 $dH = d(\\frac{1}{2}q^2) = q\\,dq$。\n设 $X = A(q,p)\\frac{\\partial}{\\partial q} + B(q,p)\\frac{\\partial}{\\partial p}$。内积是：\n$$\ni_X \\omega = i_{A\\partial_q + B\\partial_p}(dq \\wedge dp) = A\\,dp - B\\,dq\n$$\n将此与 $dH$ 等同：\n$$\nA\\,dp - B\\,dq = q\\,dq\n$$\n通过比较基 1-形式 $dq$ 和 $dp$ 的系数，我们发现 $A=0$ 和 $B=-q$。因此，候选的哈密顿向量场是：\n$$\nX = -q \\frac{\\partial}{\\partial p}\n$$\n接下来，我们检查 $X$ 是否与约束流形 $M_1$ 相切。相切条件是对于 $M_1$ 上的所有点，$X[\\phi_1] = 0$。\n$$\nX[\\phi_1] = \\left(-q \\frac{\\partial}{\\partial p}\\right)[p - \\sin(q)] = -q \\cdot (1 - 0) = -q\n$$\n为了使 $X$ 与 $M_1$ 相切，我们必须有 $X[\\phi_1] = 0$，这意味着 $-q = 0$。这是一个为了使动力学保持一致而必须满足的新条件。这产生了一个**次级约束**，$\\phi_2(q,p) := q = 0$。\n\n算法进行到一个新的、更小的约束子流形 $M_2$，它是 $M_1$ 与由新约束定义的曲面的交集：\n$$\nM_2 = \\{ (q,p) \\in M_1 \\mid q=0 \\} = \\{ (q,p) \\in T^*Q \\mid p - \\sin(q) = 0 \\text{ and } q=0 \\}\n$$\n将 $q=0$ 代入第一个约束得到 $p - \\sin(0) = 0 \\implies p = 0$。因此，第二阶段的约束子流形仅包含一个点：\n$$\nM_2 = \\{ (0,0) \\}\n$$\n现在必须在 $M_2$ 上检查该算法。我们需要找到一个与 $M_2$ 相切且在 $M_2$ 上满足哈密顿方程的向量场。在点 $(0,0)$ 处，哈密顿量是 $H=\\frac{1}{2}(0)^2=0$ 且其微分是 $dH = q\\,dq|_{(0,0)} = 0$。方程是 $i_X \\omega = 0$。由于 $\\omega$ 在 $T^*Q$ 上是非退化的，唯一的解是 $X=0$。\n零向量场平凡地与任何子流形相切，包括点流形 $M_2$。相切条件 $X[\\phi_1]=-q$ 在 $M_2$ 上变为 $0 = 0$，并且 $X[\\phi_2]=0$ 也得到满足。\n由于存在一个一致的向量场（$X=0$）且该向量场与子流形 $M_2$ 相切，**算法终止**。\n\n最终约束子流形为 $\\mathcal{C}_{\\infty} = M_2 = \\{(0,0)\\}$。\n$\\mathcal{C}_{\\infty}$ 上的约化哈密顿向量场为 $X=0$。这意味着点 $(0,0)$ 是该系统动力学的一个不动点。\nGN 算法为该系统选择了一个唯一的容许状态（一个驻定点）。这个点是序对 $(q,p) = (0,0)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "上一个练习揭示了奇异拉格朗日量如何导致一个约束哈密顿系统。其核心数学结构是一个退化的（或预辛）相空间，其中的动力学方程并非显式地给出速度。本练习 () 将剥离拉格朗日量的具体形式，直接从预辛形式 $\\omega$ 出发，探索隐式哈密顿方程 $i_{\\dot{x}}\\omega = dH$ 的本质。你将学习到，这个方程的可解性本身就对系统状态施加了代数限制，这些限制正是系统的“主约束”（primary constraints）。",
            "id": "3747502",
            "problem": "考虑一个光滑流形 $\\mathbb{R}^{3}$，其全局坐标为 $(q,p,s)$，以及在其上的常秩微分 2-形式 $\\omega = dq \\wedge dp$。令 $H \\colon \\mathbb{R}^{3} \\to \\mathbb{R}$ 为一个光滑哈密顿量。隐式哈密顿动力学由以下要求定义：一条曲线 $x(t) = (q(t),p(t),s(t))$ 满足 $i_{\\dot{x}(t)}\\omega = dH(x(t))$，其中 $i_{\\dot{x}(t)}$ 表示与速度向量 $\\dot{x}(t)$ 的内缩。\n\n仅使用内缩和双线性形式的核的定义，完成以下任务：\n\n- 计算在任意点 $x \\in \\mathbb{R}^{3}$ 的逐点核 $\\ker\\omega(x) = \\{ v \\in T_{x}\\mathbb{R}^{3} \\mid i_{v}\\omega(x) = 0 \\}$。\n- 从由 $b_{\\omega}(x)(v) = i_{v}\\omega(x)$ 定义的线性映射 $b_{\\omega}(x) \\colon T_{x}\\mathbb{R}^{3} \\to T^{*}_{x}\\mathbb{R}^{3}$ 出发，推导隐式哈密顿系统 $i_{\\dot{x}}\\omega = dH$ 的一个关于余切向量 $dH(x)$ 和核子空间 $\\ker\\omega(x)$ 的可解性充要条件。解释非平凡的 $\\ker\\omega(x)$ 如何对动力学产生约束，并阐明 $\\dot{x}$ 的非唯一性。\n- 对于特定的哈密顿量\n$$\nH(q,p,s) = \\frac{1}{2}p^{2} + V(q) + s\\,q\\,p,\n$$\n其中 $V \\colon \\mathbb{R} \\to \\mathbb{R}$ 是一个仅依赖于 $q$ 的光滑势，将主约束函数 $C(q,p,s)$ 定义为通过在 $\\ker\\omega(x)$ 的一个生成元 $Z$ 上计算 $dH$ 所得到的可解性障碍。计算 $C(q,p,s)$ 的闭式表达式。\n\n你的最终答案必须是 $C(q,p,s)$ 的显式闭式表达式。不需要数值近似。",
            "solution": "本问题将通过依次完成所列出的三个任务来解决。\n\n首先，我们计算在 $\\mathbb{R}^{3}$ 上的 2-形式 $\\omega = dq \\wedge dp$ 的逐点核 $\\ker\\omega(x)$。在任意点 $x=(q,p,s) \\in \\mathbb{R}^{3}$ 的切空间是 $T_{x}\\mathbb{R}^{3}$，它有一组由坐标向量场构成的自然基 $\\{\\frac{\\partial}{\\partial q}, \\frac{\\partial}{\\partial p}, \\frac{\\partial}{\\partial s}\\}$。任意切向量 $v \\in T_{x}\\mathbb{R}^{3}$ 可以在该基下表示为 $v = v^q \\frac{\\partial}{\\partial q} + v^p \\frac{\\partial}{\\partial p} + v^s \\frac{\\partial}{\\partial s}$，其中 $(v^q, v^p, v^s)$ 为实系数。\n\n根据定义，在点 $x$ 的双线性形式 $\\omega(x)$ 的核是所有向量 $v \\in T_{x}\\mathbb{R}^{3}$ 的集合，使得内积 $i_{v}\\omega(x)$ 为零 1-形式。这等价于对于所有向量 $w \\in T_{x}\\mathbb{R}^{3}$，都有 $\\omega(x)(v, w) = 0$。\n\n让我们对一个任意测试向量 $w = w^q \\frac{\\partial}{\\partial q} + w^p \\frac{\\partial}{\\partial p} + w^s \\frac{\\partial}{\\partial s}$ 来计算 $\\omega(v,w)$。使用楔积的定义以及微分 1-形式 $dx^i$ 在坐标向量场 $\\frac{\\partial}{\\partial x^j}$ 上的作用，其中 $dx^i(\\frac{\\partial}{\\partial x^j}) = \\delta^i_j$：\n$$\n\\omega(v,w) = (dq \\wedge dp)(v,w) = dq(v)dp(w) - dp(v)dq(w)\n$$\n1-形式在这些向量上求值的结果是：\n$dq(v) = v^q$, $dp(v) = v^p$。\n$dq(w) = w^q$, $dp(w) = w^p$。\n将这些代入 $\\omega(v,w)$ 的表达式中，得到：\n$$\n\\omega(v,w) = v^q w^p - v^p w^q\n$$\n要使 $v$ 属于 $\\ker\\omega(x)$，对于 $w \\in T_x\\mathbb{R}^3$ 的所有可能选择，即对于分量 $(w^q, w^p, w^s)$ 的任意选择，该表达式都必须为零。\n如果我们选择 $w = \\frac{\\partial}{\\partial q}$，其分量为 $(w^q, w^p, w^s) = (1, 0, 0)$。条件变为：\n$$\nv^q (0) - v^p (1) = -v^p = 0\n$$\n因此，我们必须有 $v^p = 0$。\n如果我们选择 $w = \\frac{\\partial}{\\partial p}$，其分量为 $(w^q, w^p, w^s) = (0, 1, 0)$。条件变为：\n$$\nv^q (1) - v^p (0) = v^q = 0\n$$\n因此，我们必须有 $v^q = 0$。\n分量 $v^s$ 没有出现在方程 $v^q w^p - v^p w^q = 0$ 中，因此它不受约束。所以，任何向量 $v \\in \\ker\\omega(x)$ 都必须具有形式 $v = 0 \\cdot \\frac{\\partial}{\\partial q} + 0 \\cdot \\frac{\\partial}{\\partial p} + v^s \\cdot \\frac{\\partial}{\\partial s} = v^s \\frac{\\partial}{\\partial s}$，其中 $v^s \\in \\mathbb{R}$ 是任意的。这意味着核是由向量场 $\\frac{\\partial}{\\partial s}$ 张成的一维子空间。\n$$\n\\ker\\omega(x) = \\mathrm{span}\\left\\{\\frac{\\partial}{\\partial s}\\right\\}\n$$\n这个结果与点 $x$ 无关。\n\n其次，我们推导隐式哈密顿系统 $i_{\\dot{x}}\\omega = dH$ 的可解性条件。这个方程代表了一个关于未知速度向量 $\\dot{x} \\in T_x\\mathbb{R}^3$ 的线性代数问题。让我们引入由 $v \\mapsto i_v\\omega(x)$ 定义的线性映射 $b_{\\omega}(x) \\colon T_{x}\\mathbb{R}^{3} \\to T^{*}_{x}\\mathbb{R}^{3}$。动力学方程则可写为：\n$$\nb_{\\omega}(x)(\\dot{x}) = dH(x)\n$$\n根据线性代数，这个关于 $\\dot{x}$ 的方程有解，当且仅当右侧的向量 $dH(x)$ 位于线性映射 $b_{\\omega}(x)$ 的像（或值域）中。$b_{\\omega}(x)$ 的像是所有 1-形式 $\\alpha \\in T_x^*\\mathbb{R}^3$ 的集合，对其中每个 $\\alpha$，都存在一个向量 $v \\in T_x\\mathbb{R}^3$ 使得 $\\alpha = i_v\\omega$。\n\n$b_{\\omega}(x)$ 的像与 $\\omega(x)$ 的核有关。具体而言，$b_{\\omega}(x)$ 的像是 $\\omega(x)$ 的核的零化子，记作 $(\\ker\\omega(x))^\\circ$。子空间 $W \\subseteq V$ 的零化子是 $V^*$ 的子空间 $W^\\circ$，由所有在 $W$ 中每个向量上都为零的余向量组成。也就是说，$\\alpha \\in W^\\circ$ 当且仅当对于所有 $w \\in W$ 都有 $\\alpha(w) = 0$。\n\n因此，解 $\\dot{x}$ 存在的充要条件是 $dH(x)$ 必须属于 $\\ker\\omega(x)$ 的零化子。这意味着 1-形式 $dH(x)$ 在 $\\ker\\omega(x)$ 中的每个向量上求值都必须为零。如果 $Z$ 是 $\\ker\\omega(x)$ 中的任意向量，则该条件为：\n$$\ndH(x)(Z) = 0\n$$\n这就是所要求的可解性条件。它对相空间中动力学可以发生的点 $x=(q,p,s)$ 起到了约束作用。满足此条件的点的集合形成一个称为主约束曲面的子流形。\n\n如果此条件得到满足，则存在一个解 $\\dot{x}_0$。然而，它不是唯一的。如果 $\\dot{x}_0$ 是一个解，那么对于任意向量 $Z \\in \\ker\\omega(x)$，向量 $\\dot{x} = \\dot{x}_0 + Z$ 也是一个解，因为：\n$$\ni_{\\dot{x}_0 + Z}\\omega = i_{\\dot{x}_0}\\omega + i_Z\\omega = dH(x) + 0 = dH(x)\n$$\n因此，$\\ker\\omega(x)$ 的非平凡性既导致了对允许状态的约束，也导致了系统时间演化的非唯一性。速度向量在核生成元（此处为 $\\frac{\\partial}{\\partial s}$）方向上的分量由运动方程所无法确定。\n\n第三，我们计算特定哈密顿量 $H(q,p,s) = \\frac{1}{2}p^{2} + V(q) + s\\,q\\,p$ 的主约束函数 $C(q,p,s)$。该约束函数是可解性的障碍，通过在 $\\ker\\omega(x)$ 的一个生成元上计算 $dH$ 来获得。\n首先，我们计算外微分 $dH$：\n$$\ndH = \\frac{\\partial H}{\\partial q} dq + \\frac{\\partial H}{\\partial p} dp + \\frac{\\partial H}{\\partial s} ds\n$$\n偏导数是：\n$$\n\\frac{\\partial H}{\\partial q} = \\frac{dV}{dq} + sp\n$$\n$$\n\\frac{\\partial H}{\\partial p} = p + sq\n$$\n$$\n\\frac{\\partial H}{\\partial s} = qp\n$$\n所以，1-形式 $dH$ 是：\n$$\ndH(q,p,s) = \\left(\\frac{dV}{dq} + sp\\right) dq + (p + sq) dp + (qp) ds\n$$\n根据我们之前的分析，$\\ker\\omega(x)$ 的一个生成元是向量场 $Z = \\frac{\\partial}{\\partial s}$。主约束函数 $C(q,p,s)$ 定义为 $dH$ 在 $Z$ 上的求值。\n$$\nC(q,p,s) = dH(Z) = \\left\\langle dH, \\frac{\\partial}{\\partial s} \\right\\rangle\n$$\n使用配对 $\\langle dx^i, \\frac{\\partial}{\\partial x^j} \\rangle = \\delta^i_j$，我们得到：\n$$\nC(q,p,s) = \\left\\langle \\left(\\frac{dV}{dq} + sp\\right) dq + (p + sq) dp + (qp) ds, \\frac{\\partial}{\\partial s} \\right\\rangle\n$$\n$$\nC(q,p,s) = \\left(\\frac{dV}{dq} + sp\\right) \\left\\langle dq, \\frac{\\partial}{\\partial s} \\right\\rangle + (p + sq) \\left\\langle dp, \\frac{\\partial}{\\partial s} \\right\\rangle + (qp) \\left\\langle ds, \\frac{\\partial}{\\partial s} \\right\\rangle\n$$\n$$\nC(q,p,s) = \\left(\\frac{dV}{dq} + sp\\right)(0) + (p + sq)(0) + (qp)(1)\n$$\n$$\nC(q,p,s) = qp\n$$\n可解性条件 $C(q,p,s)=0$ 将动力学限制在由方程 $qp=0$ 定义的 $\\mathbb{R}^3$ 中的曲面上。",
            "answer": "$$\\boxed{qp}$$"
        },
        {
            "introduction": "理论的威力在于其应用。非完整约束（nonholonomic constraints），例如滚动而不滑动的车轮所受到的约束，是隐式哈密顿系统在物理世界中的一个典型来源。在此练习中 ()，我们将把前述的抽象理论应用于一个具体的非完整力学系统。你将看到，通过施加动力学一致性条件——即约束必须在时间演化中保持——我们能够确定原本未知的拉格朗日乘子，它在物理上代表了维持约束所需的力。",
            "id": "3747521",
            "problem": "考虑一个位形流形 $Q=\\mathbb{R}^{3}$，其坐标为 $(x,y,z)$，以及其上的余切丛 $T^{*}Q$。余切丛上带有典范1-形式 $\\theta=p_{x}\\,\\mathrm{d}x+p_{y}\\,\\mathrm{d}y+p_{z}\\,\\mathrm{d}z$ 和典范辛形式 $\\omega=\\mathrm{d}\\theta$。设哈密顿量为 $H(x,y,z,p_{x},p_{y},p_{z})=\\frac{1}{2}\\big(p_{x}^{2}+p_{y}^{2}+p_{z}^{2}\\big)+V(x,y,z)$，其中 $V$ 是一个光滑势。施加一个分布 $\\mathcal{D}\\subset TQ$，该分布由1-形式 $\\alpha=\\mathrm{d}z-x\\,\\mathrm{d}y$ 的核给出，因此容许速度满足 $\\alpha(\\dot{q})=0$，即 $\\dot{z}-x\\,\\dot{y}=0$。该分布由矩阵 $A(q)=\\begin{pmatrix}0-x1\\end{pmatrix}$ 通过 $A(q)\\,\\dot{q}=0$ 指定。\n\n从由条件 $\\iota_{X_{H}}\\omega=\\mathrm{d}H$ 定义的典范辛动力学出发，并通过 d’Alembert 原理（反作用力取值于零化子 $\\mathcal{D}^{\\circ}=\\mathrm{span}\\{\\alpha\\}$）施加非完整约束，推导 $T^{*}Q$ 上的隐式约束哈密顿动力学，并确定施加该约束的拉格朗日乘子场 $\\lambda(x,y,z,p_{x},p_{y},p_{z})$。\n\n你的最终答案必须是 $\\lambda$ 的一个单一闭式解析表达式，用 $(x,y,z,p_{x},p_{y},p_{z})$ 和 $V$ 的偏导数表示。不需要数值近似或四舍五入。",
            "solution": "该问题被验证为有科学依据、适定且客观的。这是一个关于非完整系统的几何力学标准问题。\n\n该系统在余切丛 $T^{*}Q = T^{*}\\mathbb{R}^{3}$ 上描述，其典范坐标为 $(q, p) = (x, y, z, p_{x}, p_{y}, p_{z})$。哈密顿量由 $H(q,p) = \\frac{1}{2}(p_{x}^{2}+p_{y}^{2}+p_{z}^{2}) + V(x,y,z)$ 给出。动力学受到关于速度 $\\dot{q} = (\\dot{x}, \\dot{y}, \\dot{z})$ 的非完整条件约束，该条件由1-形式 $\\alpha = \\mathrm{d}z - x\\,\\mathrm{d}y$ 的核给出。因此约束方程为 $\\alpha(\\dot{q}) = \\dot{z} - x\\,\\dot{y} = 0$。\n\n在哈密顿框架中，无约束动力学由哈密顿向量场 $X_{H}$ 生成，其定义为 $\\iota_{X_{H}}\\omega = \\mathrm{d}H$，其中 $\\omega = \\mathrm{d}p_{x} \\wedge \\mathrm{d}x + \\mathrm{d}p_{y} \\wedge \\mathrm{d}y + \\mathrm{d}p_{z} \\wedge \\mathrm{d}z$ 是典范辛形式。非完整约束的影响通过在运动方程中增加一个约束力项来体现。根据 d’Alembert 原理，该约束力必须位于容许速度分布 $\\mathcal{D}$ 的零化子 $\\mathcal{D}^{\\circ}$ 中。在本例中，$\\mathcal{D}^{\\circ} = \\mathrm{span}\\{\\alpha\\}$。因此，约束动力学由隐式方程 $\\iota_{X}\\omega = \\mathrm{d}H - \\lambda\\alpha$ 控制，其中 $X$ 是约束向量场，$\\lambda$ 是 $T^{*}Q$ 上的一个拉格朗日乘子场。\n\n在坐标中展开此方程可得到约束哈密顿方程。首先，关于速度的哈密顿方程不受约束力项的影响：\n$\\dot{x} = \\frac{\\partial H}{\\partial p_{x}} = p_{x}$\n$\\dot{y} = \\frac{\\partial H}{\\partial p_{y}} = p_{y}$\n$\\dot{z} = \\frac{\\partial H}{\\partial p_{z}} = p_{z}$\n\n动量方程被修正。约束1-形式为 $\\alpha = (0)\\,\\mathrm{d}x + (-x)\\,\\mathrm{d}y + (1)\\,\\mathrm{d}z$，因此其分量为 $\\alpha_{x}=0$，$\\alpha_{y}=-x$ 和 $\\alpha_{z}=1$。约束力余向量为 $F_{c} = \\lambda\\alpha$，其分量为 $F_{c, i} = \\lambda \\alpha_{i}$。动量方程变为 $\\dot{p}_{i} = -\\frac{\\partial H}{\\partial q^{i}} + F_{c,i}$：\n$\\dot{p}_{x} = -\\frac{\\partial H}{\\partial x} + \\lambda\\alpha_x = -\\frac{\\partial V}{\\partial x}$\n$\\dot{p}_{y} = -\\frac{\\partial H}{\\partial y} + \\lambda\\alpha_y = -\\frac{\\partial V}{\\partial y} - \\lambda x$\n$\\dot{p}_{z} = -\\frac{\\partial H}{\\partial z} + \\lambda\\alpha_z = -\\frac{\\partial V}{\\partial z} + \\lambda$\n\n拉格朗日乘子 $\\lambda$ 不是任意的；它由系统流在任何时候都必须满足约束这一条件来确定。将速度的哈密顿表达式代入约束方程 $\\dot{z} - x\\dot{y} = 0$，我们得到相空间变量上的一个约束：\n$p_{z} - x p_{y} = 0$\n\n设 $C(q,p) = p_{z} - x p_{y}$。此函数在任何有效轨道上都必须为零。为使动力学一致，如果系统轨道从约束子流形 $M_{C} = \\{(q,p) \\in T^{*}Q \\mid C(q,p)=0\\}$ 开始，则必须保持在 $M_{C}$ 上。这要求 $C$ 沿着约束流的全时间导数为零。\n$\\frac{\\mathrm{d}C}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t}(p_{z} - x p_{y}) = 0$\n\n使用链式法则，我们有：\n$\\dot{p}_{z} - (\\dot{x} p_{y} + x \\dot{p}_{y}) = 0$\n\n现在，我们将约束哈密顿方程中时间导数的表达式代入这个一致性条件：\n$(\\dot{p}_{z}) - (\\dot{x})p_{y} - x(\\dot{p}_{y}) = 0$\n$\\left(-\\frac{\\partial V}{\\partial z} + \\lambda\\right) - (p_{x})p_{y} - x\\left(-\\frac{\\partial V}{\\partial y} - \\lambda x\\right) = 0$\n\n这给出了一个关于 $\\lambda$ 的代数方程。我们展开并合并包含 $\\lambda$ 的项：\n$-\\frac{\\partial V}{\\partial z} + \\lambda - p_{x} p_{y} + x\\frac{\\partial V}{\\partial y} + \\lambda x^{2} = 0$\n$\\lambda(1 + x^{2}) - p_{x} p_{y} + x\\frac{\\partial V}{\\partial y} - \\frac{\\partial V}{\\partial z} = 0$\n\n最后，我们求解拉格朗日乘子场 $\\lambda$：\n$\\lambda(1 + x^{2}) = p_{x} p_{y} - x\\frac{\\partial V}{\\partial y} + \\frac{\\partial V}{\\partial z}$\n$\\lambda(x,y,z,p_{x},p_{y},p_{z}) = \\frac{p_{x} p_{y} - x\\frac{\\partial V}{\\partial y} + \\frac{\\partial V}{\\partial z}}{1 + x^{2}}$\n\n这就是拉格朗日乘子作为相空间 $T^{*}Q$ 上的函数的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{p_{x} p_{y} - x\\frac{\\partial V}{\\partial y} + \\frac{\\partial V}{\\partial z}}{1 + x^{2}}}\n$$"
        }
    ]
}