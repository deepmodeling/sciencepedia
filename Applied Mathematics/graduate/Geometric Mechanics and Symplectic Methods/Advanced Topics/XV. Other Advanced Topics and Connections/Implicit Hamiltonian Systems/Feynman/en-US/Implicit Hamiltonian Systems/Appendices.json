{
    "hands_on_practices": [
        {
            "introduction": "The core idea behind an implicit Hamiltonian system is that the structure of the phase space itself, rather than externally imposed rules, can restrict the dynamics. This first exercise provides a clear, simplified setting to explore this phenomenon. By working on a space equipped with a degenerate (or presymplectic) 2-form, you will directly derive the necessary condition for the Hamiltonian equations of motion to even have a solution, revealing the origin of what are known as primary constraints .",
            "id": "3747502",
            "problem": "Consider a smooth manifold $\\mathbb{R}^{3}$ with global coordinates $(q,p,s)$ and the differential $2$-form $\\omega = dq \\wedge dp$ of constant rank on $\\mathbb{R}^{3}$. Let $H \\colon \\mathbb{R}^{3} \\to \\mathbb{R}$ be a smooth Hamiltonian. The implicit Hamiltonian dynamics is defined by the requirement that a curve $x(t) = (q(t),p(t),s(t))$ satisfies $i_{\\dot{x}(t)}\\omega = dH(x(t))$, where $i_{\\dot{x}(t)}$ denotes interior contraction with the velocity vector $\\dot{x}(t)$.\n\nUsing only the definitions of interior contraction and the kernel of a bilinear form, perform the following:\n\n- Compute the pointwise kernel $\\ker\\omega(x) = \\{ v \\in T_{x}\\mathbb{R}^{3} \\mid i_{v}\\omega(x) = 0 \\}$ at an arbitrary point $x \\in \\mathbb{R}^{3}$.\n- Starting from the linear map $b_{\\omega}(x) \\colon T_{x}\\mathbb{R}^{3} \\to T^{*}_{x}\\mathbb{R}^{3}$ defined by $b_{\\omega}(x)(v) = i_{v}\\omega(x)$, derive a necessary and sufficient solvability condition for the implicit Hamiltonian system $i_{\\dot{x}}\\omega = dH$ in terms of the cotangent vector $dH(x)$ and the kernel subspace $\\ker\\omega(x)$. Explain how a nontrivial $\\ker\\omega(x)$ induces constraints on the dynamics and clarifies the nonuniqueness of $\\dot{x}$.\n- For the specific Hamiltonian\n$$\nH(q,p,s) = \\frac{1}{2}p^{2} + V(q) + s\\,q\\,p,\n$$\nwith $V \\colon \\mathbb{R} \\to \\mathbb{R}$ a smooth potential depending only on $q$, define the primary constraint function $C(q,p,s)$ as the obstruction to solvability given by evaluating $dH$ on a generator $Z$ of $\\ker\\omega(x)$. Compute the closed-form expression for $C(q,p,s)$.\n\nYour final answer must be the explicit closed-form expression for $C(q,p,s)$. No numerical approximation is required.",
            "solution": "The problem will be addressed by sequentially completing the three tasks outlined. The validation step confirms the problem is well-posed and scientifically sound within the framework of geometric mechanics.\n\nFirst, we compute the pointwise kernel $\\ker\\omega(x)$ of the $2$-form $\\omega = dq \\wedge dp$ on $\\mathbb{R}^{3}$. The tangent space at any point $x=(q,p,s) \\in \\mathbb{R}^{3}$ is $T_{x}\\mathbb{R}^{3}$, which has a natural basis of coordinate vector fields $\\{\\frac{\\partial}{\\partial q}, \\frac{\\partial}{\\partial p}, \\frac{\\partial}{\\partial s}\\}$. An arbitrary tangent vector $v \\in T_{x}\\mathbb{R}^{3}$ can be expressed in this basis as $v = v^q \\frac{\\partial}{\\partial q} + v^p \\frac{\\partial}{\\partial p} + v^s \\frac{\\partial}{\\partial s}$ for some real coefficients $(v^q, v^p, v^s)$.\n\nBy definition, the kernel of the bilinear form $\\omega(x)$ at a point $x$ is the set of vectors $v \\in T_{x}\\mathbb{R}^{3}$ such that the interior product $i_{v}\\omega(x)$ is the zero $1$-form. This is equivalent to the condition that $\\omega(x)(v, w) = 0$ for all vectors $w \\in T_{x}\\mathbb{R}^{3}$.\n\nLet's evaluate $\\omega(v,w)$ for an arbitrary test vector $w = w^q \\frac{\\partial}{\\partial q} + w^p \\frac{\\partial}{\\partial p} + w^s \\frac{\\partial}{\\partial s}$. Using the definition of the wedge product and the action of a differential $1$-form $dx^i$ on a coordinate vector field $\\frac{\\partial}{\\partial x^j}$, where $dx^i(\\frac{\\partial}{\\partial x^j}) = \\delta^i_j$:\n$$\n\\omega(v,w) = (dq \\wedge dp)(v,w) = dq(v)dp(w) - dp(v)dq(w)\n$$\nThe components of the $1$-forms evaluated on the vectors are:\n$dq(v) = v^q$, $dp(v) = v^p$.\n$dq(w) = w^q$, $dp(w) = w^p$.\nSubstituting these into the expression for $\\omega(v,w)$ gives:\n$$\n\\omega(v,w) = v^q w^p - v^p w^q\n$$\nFor $v$ to be in $\\ker\\omega(x)$, this expression must be zero for all possible choices of $w \\in T_x\\mathbb{R}^3$, which means for any choice of components $(w^q, w^p, w^s)$.\nIf we choose $w = \\frac{\\partial}{\\partial q}$, its components are $(w^q, w^p, w^s) = (1, 0, 0)$. The condition becomes:\n$$\nv^q (0) - v^p (1) = -v^p = 0\n$$\nThus, we must have $v^p = 0$.\nIf we choose $w = \\frac{\\partial}{\\partial p}$, its components are $(w^q, w^p, w^s) = (0, 1, 0)$. The condition becomes:\n$$\nv^q (1) - v^p (0) = v^q = 0\n$$\nThus, we must have $v^q = 0$.\nThe component $v^s$ does not appear in the equation $v^q w^p - v^p w^q = 0$, so it remains unconstrained. Therefore, any vector $v \\in \\ker\\omega(x)$ must be of the form $v = 0 \\cdot \\frac{\\partial}{\\partial q} + 0 \\cdot \\frac{\\partial}{\\partial p} + v^s \\cdot \\frac{\\partial}{\\partial s} = v^s \\frac{\\partial}{\\partial s}$ for any $v^s \\in \\mathbb{R}$. This means the kernel is a one-dimensional subspace spanned by the vector field $\\frac{\\partial}{\\partial s}$.\n$$\n\\ker\\omega(x) = \\mathrm{span}\\left\\{\\frac{\\partial}{\\partial s}\\right\\}\n$$\nThis result is independent of the point $x$.\n\nSecond, we derive the solvability condition for the implicit Hamiltonian system $i_{\\dot{x}}\\omega = dH$. This equation represents a linear algebraic problem for the unknown velocity vector $\\dot{x} \\in T_x\\mathbb{R}^3$. Let's introduce the linear map $b_{\\omega}(x) \\colon T_{x}\\mathbb{R}^{3} \\to T^{*}_{x}\\mathbb{R}^{3}$ defined by $v \\mapsto i_v\\omega(x)$. The dynamics equation is then cast as:\n$$\nb_{\\omega}(x)(\\dot{x}) = dH(x)\n$$\nFrom linear algebra, this equation for $\\dot{x}$ has a solution if and only if the vector $dH(x)$ on the right-hand side lies in the image (or range) of the linear map $b_{\\omega}(x)$. The image of $b_{\\omega}(x)$ is the set of all $1$-forms $\\alpha \\in T_x^*\\mathbb{R}^3$ for which there exists a vector $v \\in T_x\\mathbb{R}^3$ such that $\\alpha = i_v\\omega$.\n\nThe image of $b_{\\omega}(x)$ is related to the kernel of $\\omega(x)$. Specifically, the image of $b_{\\omega}(x)$ is the annihilator of the kernel of $\\omega(x)$, denoted $(\\ker\\omega(x))^\\circ$. The annihilator of a subspace $W \\subseteq V$ is the subspace $W^\\circ \\subseteq V^*$ consisting of all covectors that vanish on every vector in $W$. That is, $\\alpha \\in W^\\circ$ if and only if $\\alpha(w) = 0$ for all $w \\in W$.\n\nThus, a necessary and sufficient condition for the existence of a solution $\\dot{x}$ is that $dH(x)$ must belong to the annihilator of $\\ker\\omega(x)$. This means that the $1$-form $dH(x)$ must evaluate to zero on every vector in $\\ker\\omega(x)$. If $Z$ is any vector in $\\ker\\omega(x)$, the condition is:\n$$\ndH(x)(Z) = 0\n$$\nThis is the required solvability condition. It acts as a constraint on the points $x=(q,p,s)$ of the phase space where the dynamics can occur. The set of points satisfying this condition forms a submanifold called the primary constraint surface.\n\nIf this condition is met, a solution $\\dot{x}_0$ exists. However, it is not unique. If $\\dot{x}_0$ is a solution, then for any vector $Z \\in \\ker\\omega(x)$, the vector $\\dot{x} = \\dot{x}_0 + Z$ is also a solution, because:\n$$\ni_{\\dot{x}_0 + Z}\\omega = i_{\\dot{x}_0}\\omega + i_Z\\omega = dH(x) + 0 = dH(x)\n$$\nThe non-triviality of $\\ker\\omega(x)$ thus leads to both a constraint on the allowable states and a non-uniqueness in the time evolution of the system. The velocity vector component in the direction of the kernel generators (here, $\\frac{\\partial}{\\partial s}$) is left undetermined by the equations of motion.\n\nThird, we compute the primary constraint function $C(q,p,s)$ for the specific Hamiltonian $H(q,p,s) = \\frac{1}{2}p^{2} + V(q) + s\\,q\\,p$. The constraint function is the obstruction to solvability, obtained by evaluating $dH$ on a generator of $\\ker\\omega(x)$.\nFirst, we compute the exterior derivative $dH$:\n$$\ndH = \\frac{\\partial H}{\\partial q} dq + \\frac{\\partial H}{\\partial p} dp + \\frac{\\partial H}{\\partial s} ds\n$$\nThe partial derivatives are:\n$$\n\\frac{\\partial H}{\\partial q} = \\frac{dV}{dq} + sp\n$$\n$$\n\\frac{\\partial H}{\\partial p} = p + sq\n$$\n$$\n\\frac{\\partial H}{\\partial s} = qp\n$$\nSo, the $1$-form $dH$ is:\n$$\ndH(q,p,s) = \\left(\\frac{dV}{dq} + sp\\right) dq + (p + sq) dp + (qp) ds\n$$\nFrom our previous analysis, a generator for $\\ker\\omega(x)$ is the vector field $Z = \\frac{\\partial}{\\partial s}$. The primary constraint function $C(q,p,s)$ is defined as the evaluation of $dH$ on $Z$.\n$$\nC(q,p,s) = dH(Z) = \\left\\langle dH, \\frac{\\partial}{\\partial s} \\right\\rangle\n$$\nUsing the pairing $\\langle dx^i, \\frac{\\partial}{\\partial x^j} \\rangle = \\delta^i_j$, we find:\n$$\nC(q,p,s) = \\left\\langle \\left(\\frac{dV}{dq} + sp\\right) dq + (p + sq) dp + (qp) ds, \\frac{\\partial}{\\partial s} \\right\\rangle\n$$\n$$\nC(q,p,s) = \\left(\\frac{dV}{dq} + sp\\right) \\left\\langle dq, \\frac{\\partial}{\\partial s} \\right\\rangle + (p + sq) \\left\\langle dp, \\frac{\\partial}{\\partial s} \\right\\rangle + (qp) \\left\\langle ds, \\frac{\\partial}{\\partial s} \\right\\rangle\n$$\n$$\nC(q,p,s) = \\left(\\frac{dV}{dq} + sp\\right)(0) + (p + sq)(0) + (qp)(1)\n$$\n$$\nC(q,p,s) = qp\n$$\nThe solvability condition $C(q,p,s)=0$ confines the dynamics to the surface in $\\mathbb{R}^3$ defined by the equation $qp=0$.",
            "answer": "$$\\boxed{qp}$$"
        },
        {
            "introduction": "A primary source of degeneracy in mechanics is the singular Lagrangian, where the Legendre transform fails to be invertible, preventing a direct transition to the Hamiltonian picture. This practice walks you through the modern geometric remedy for this situation. Starting from a singular Lagrangian, you will use the Hamilton-Pontryagin principle to formulate the dynamics on an extended phase space and then apply the powerful Gotay-Nester constraint algorithm to systematically uncover the full chain of constraints and determine the final, consistent dynamics .",
            "id": "3747517",
            "problem": "Consider the configuration manifold $Q=\\mathbb{R}$ and the Lagrangian $L:TQ\\to\\mathbb{R}$ defined by $L(q,v)=\\sin(q)\\,v-\\frac{1}{2}q^{2}$. \n\n1. Starting from the definition of the Legendre transform (also called the fiber derivative) $\\mathbb{F}L:TQ\\to T^{*}Q$ given by $\\mathbb{F}L(q,v)=(q,p)$ with $p=\\frac{\\partial L}{\\partial v}(q,v)$, explain why the Legendre transform is noninvertible for this $L$.\n\n2. Using the Hamilton–Pontryagin (HP) variational principle with action functional $S(q,v,p)=\\int_{t_{0}}^{t_{1}}\\left(L(q,v)+p(\\dot{q}-v)\\right)\\,dt$, derive the implicit Euler–Lagrange–Pontryagin equations. Identify the primary constraint submanifold $\\mathcal{C}_{0}\\subset TQ\\oplus T^{*}Q$ and the generalized energy $E:TQ\\oplus T^{*}Q\\to\\mathbb{R}$.\n\n3. Apply the Gotay–Nester (GN) constraint algorithm for presymplectic systems to this HP formulation. Use the canonical two-form $\\omega=dq\\wedge dp$ on $T^{*}Q$ and its pullback to the constraint submanifolds to enforce the compatibility condition $i_{X}\\omega=dH$ restricted to constraints, where $H$ is the reduced Hamiltonian obtained from $E$ on $\\mathcal{C}_{0}$. Determine the secondary constraint(s) and show whether the algorithm terminates. Identify the final constraint submanifold $\\mathcal{C}_{\\infty}$ and the reduced Hamiltonian vector field $X$ on it.\n\nYour final answer must be the unique admissible pair $(q,p)\\in T^{*}Q$ selected by the GN algorithm for this example. Express this pair as a row matrix using the $\\mathrm{pmatrix}$ environment. No units are required. If more than one admissible pair exists, select the one that is dynamically consistent and has minimal Euclidean norm in $\\mathbb{R}^{2}$, and report that pair. No rounding is needed.",
            "solution": "The problem asks for a complete analysis of a system described by a singular Lagrangian, using the Hamilton-Pontryagin principle and the Gotay-Nester constraint algorithm. We will validate the problem and then proceed through the three parts as requested.\n\nThe problem statement is scientifically grounded in the principles of geometric mechanics, specifically the theory of constrained Hamiltonian systems. The Lagrangian $L(q,v)=\\sin(q)\\,v-\\frac{1}{2}q^{2}$ on the configuration manifold $Q=\\mathbb{R}$ is a well-defined mathematical object. The tasks involve standard, albeit advanced, procedures for analyzing such systems, namely the Hamilton-Pontryagin variational principle and the Gotay-Nester (GN) algorithm. The problem is self-contained, well-posed, and all terms are clearly defined. Therefore, the problem is valid and we may proceed with the solution.\n\n### Part 1: Noninvertibility of the Legendre Transform\n\nThe Legendre transform (or fiber derivative) $\\mathbb{F}L: TQ \\to T^*Q$ maps a point $(q, v) \\in TQ$ to a point $(q, p) \\in T^*Q$, where the momentum $p$ is defined as $p = \\frac{\\partial L}{\\partial v}$.\n\nFor the given Lagrangian, $L(q,v)=\\sin(q)\\,v-\\frac{1}{2}q^{2}$, the momentum is:\n$$\np = \\frac{\\partial L}{\\partial v}(q,v) = \\frac{\\partial}{\\partial v}\\left(\\sin(q)\\,v-\\frac{1}{2}q^{2}\\right) = \\sin(q)\n$$\nThe Legendre transform is therefore the map $\\mathbb{F}L(q,v) = (q, \\sin(q))$.\n\nTo be invertible, the map $\\mathbb{F}L$ must be a bijection; that is, for every $(q, p) \\in T^*Q$, there must exist a unique $(q, v) \\in TQ$ that maps to it. This requires solving for $v$ in terms of $q$ and $p$. The equation $p = \\sin(q)$ is independent of $v$, making it impossible to determine a unique $v$ for a given $(q,p)$.\n\nMore formally, the noninvertibility can be demonstrated in two ways:\n1.  The map is not surjective (onto). The image of $\\mathbb{F}L$ is the set of points $\\{(q,p) \\in T^*Q \\mid p = \\sin(q)\\}$. This is a one-dimensional submanifold of the two-dimensional cotangent bundle $T^*Q \\cong \\mathbb{R}^2$. Any point $(q,p)$ not on this submanifold (i.e., where $p \\neq \\sin(q)$) has no preimage in $TQ$.\n2.  The map is not injective (one-to-one). For any point $(q,p)$ in the image of $\\mathbb{F}L$, the preimage is not a single point. For a fixed $q_0$, all points $(q_0, v)$ for any $v \\in \\mathbb{R}$ are mapped to the same point $(q_0, \\sin(q_0))$.\n\nA systematic way to check for the local invertibility of the Legendre transform is to compute the fiber Hessian matrix, whose components are $W_{ij} = \\frac{\\partial^2 L}{\\partial v^i \\partial v^j}$. The transform is locally invertible if and only if this matrix is non-singular. In our one-dimensional case ($v$ is a scalar), this reduces to a single component:\n$$\nW = \\frac{\\partial^2 L}{\\partial v^2} = \\frac{\\partial}{\\partial v}\\left(\\frac{\\partial L}{\\partial v}\\right) = \\frac{\\partial}{\\partial v}(\\sin(q)) = 0\n$$\nSince the Hessian is identically zero (which is singular), the Legendre transform is noninvertible. Such a Lagrangian is termed singular.\n\n### Part 2: Hamilton–Pontryagin Variational Principle\n\nThe Hamilton–Pontryagin (HP) action functional is given on the extended space $TQ \\oplus T^*Q$ with coordinates $(q,v,p)$. The action is:\n$$\nS(q,v,p) = \\int_{t_{0}}^{t_{1}} \\left( L(q,v) + p(\\dot{q}-v) \\right) \\,dt = \\int_{t_{0}}^{t_{1}} \\left( \\sin(q)v - \\frac{1}{2}q^2 + p\\dot{q} - pv \\right) \\,dt\n$$\nWe find the equations of motion by taking variations of $S$ with respect to $q$, $v$, and $p$, and setting $\\delta S = 0$.\n$$\n\\delta S = \\int_{t_{0}}^{t_{1}} \\left( \\frac{\\partial L}{\\partial q}\\delta q + \\frac{\\partial L}{\\partial v}\\delta v + \\delta p(\\dot{q}-v) + p(\\delta\\dot{q} - \\delta v) \\right) \\,dt\n$$\nIntegrating the $p\\delta\\dot{q}$ term by parts, $\\int p\\delta\\dot{q}\\,dt = [p\\delta q]_{t_0}^{t_1} - \\int \\dot{p}\\delta q\\,dt$, where the boundary term vanishes since $\\delta q(t_0)=\\delta q(t_1)=0$. Substituting $\\frac{\\partial L}{\\partial q} = \\cos(q)v - q$ and $\\frac{\\partial L}{\\partial v} = \\sin(q)$:\n$$\n\\delta S = \\int_{t_{0}}^{t_{1}} \\left( (\\cos(q)v - q - \\dot{p})\\delta q + (\\sin(q)-p)\\delta v + (\\dot{q}-v)\\delta p \\right) \\,dt = 0\n$$\nSince the variations $\\delta q$, $\\delta v$, and $\\delta p$ are independent, their coefficients must vanish. This yields the Euler-Lagrange-Pontryagin equations:\n1.  $\\delta q: \\quad \\dot{p} = \\cos(q)v - q$\n2.  $\\delta v: \\quad p = \\sin(q)$\n3.  $\\delta p: \\quad \\dot{q} = v$\n\nThe **primary constraint submanifold** $\\mathcal{C}_0$ is the subset of $TQ \\oplus T^*Q$ on which the algebraic (non-differential) equations from the variational principle must hold. This is given by equation (2).\n$$\n\\mathcal{C}_{0} = \\{ (q,v,p) \\in TQ \\oplus T^*Q \\mid p - \\sin(q) = 0 \\}\n$$\nThe **generalized energy** $E: TQ \\oplus T^*Q \\to \\mathbb{R}$ is defined as $E = pv - L(q,v)$:\n$$\nE(q,v,p) = pv - \\left(\\sin(q)v - \\frac{1}{2}q^2\\right) = (p - \\sin(q))v + \\frac{1}{2}q^2\n$$\n\n### Part 3: Gotay–Nester Constraint Algorithm\n\nThe GN algorithm is applied to the presymplectic system that arises from this formulation. As suggested by the problem, we will work on the cotangent bundle $T^*Q$ with coordinates $(q,p)$ and its canonical symplectic form $\\omega = dq \\wedge dp$.\n\nThe primary constraint manifold is the image of the Legendre transform, a submanifold of $T^*Q$:\n$$\nM_1 = \\{ (q,p) \\in T^*Q \\mid \\phi_1(q,p) := p - \\sin(q) = 0 \\}\n$$\nThe reduced Hamiltonian $H$ on $M_1$ is obtained by restricting the generalized energy $E$ to the constraint manifold $\\mathcal{C}_0$. On $\\mathcal{C}_0$, where $p=\\sin(q)$, we have:\n$$\nH = E|_{\\mathcal{C}_0} = (p-\\sin(q))v + \\frac{1}{2}q^2 \\Big|_{p=\\sin(q)} = (0)v + \\frac{1}{2}q^2 = \\frac{1}{2}q^2\n$$\nWe can consider $H(q,p) = \\frac{1}{2}q^2$ as a function on the ambient space $T^*Q$. The algorithm seeks a vector field $X$ that is tangent to $M_1$ and satisfies the presymplectic Hamilton's equation $i_X \\omega = dH$ on $M_1$.\n\nFirst, we solve for a candidate vector field $X$ on $T^*Q$ from the equation $i_X \\omega = dH$.\nThe differential of the Hamiltonian is $dH = d(\\frac{1}{2}q^2) = q\\,dq$.\nLet $X = A(q,p)\\frac{\\partial}{\\partial q} + B(q,p)\\frac{\\partial}{\\partial p}$. The interior product is:\n$$\ni_X \\omega = i_{A\\partial_q + B\\partial_p}(dq \\wedge dp) = A\\,dp - B\\,dq\n$$\nEquating this with $dH$:\n$$\nA\\,dp - B\\,dq = q\\,dq\n$$\nBy comparing the coefficients of the basis 1-forms $dq$ and $dp$, we find $A=0$ and $B=-q$. Thus, the candidate Hamiltonian vector field is:\n$$\nX = -q \\frac{\\partial}{\\partial p}\n$$\nNext, we check if $X$ is tangent to the constraint manifold $M_1$. The tangency condition is $X[\\phi_1] = 0$ for all points on $M_1$.\n$$\nX[\\phi_1] = \\left(-q \\frac{\\partial}{\\partial p}\\right)[p - \\sin(q)] = -q \\cdot (1 - 0) = -q\n$$\nFor $X$ to be tangent to $M_1$, we must have $X[\\phi_1] = 0$, which implies $-q = 0$. This is a new condition that must be satisfied for the dynamics to be consistent. This gives rise to a **secondary constraint**, $\\phi_2(q,p) := q = 0$.\n\nThe algorithm proceeds to a new, smaller constraint submanifold $M_2$, which is the intersection of $M_1$ and the surface defined by the new constraint:\n$$\nM_2 = \\{ (q,p) \\in M_1 \\mid q=0 \\} = \\{ (q,p) \\in T^*Q \\mid p - \\sin(q) = 0 \\text{ and } q=0 \\}\n$$\nSubstituting $q=0$ into the first constraint gives $p - \\sin(0) = 0 \\implies p = 0$. Therefore, the second-stage constraint submanifold consists of a single point:\n$$\nM_2 = \\{ (0,0) \\}\n$$\nThe algorithm now must be checked on $M_2$. We need to find a vector field tangent to $M_2$ that satisfies the Hamilton's equation on $M_2$. At the point $(0,0)$, the Hamiltonian is $H=\\frac{1}{2}(0)^2=0$ and its differential is $dH = q\\,dq|_{(0,0)} = 0$. The equation is $i_X \\omega = 0$. Since $\\omega$ is non-degenerate on $T^*Q$, the only solution is $X=0$.\nThe zero vector field is trivially tangent to any submanifold, including the point manifold $M_2$. The tangency condition $X[\\phi_1]=-q$ becomes $0 = 0$ on $M_2$, and $X[\\phi_2]=0$ is also satisfied.\nSince a consistent vector field ($X=0$) exists and is tangent to the submanifold $M_2$, the **algorithm terminates**.\n\nThe final constraint submanifold is $\\mathcal{C}_{\\infty} = M_2 = \\{(0,0)\\}$.\nThe reduced Hamiltonian vector field on $\\mathcal{C}_{\\infty}$ is $X=0$. This implies that the point $(0,0)$ is a fixed point of the system's dynamics.\nThe GN algorithm has selected a unique admissible state (a stationary point) for the system. This point is the pair $(q,p) = (0,0)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Our exploration now turns to another important class of constrained systems: nonholonomic systems, where constraints are imposed on velocities rather than configurations. This exercise demonstrates how to integrate such non-integrable velocity constraints into the Hamiltonian framework. You will derive the modified Hamilton's equations, which include a constraint force, and solve for the unknown Lagrange multiplier by enforcing the consistency of the system's evolution with the constraint itself .",
            "id": "3747521",
            "problem": "Consider a configuration manifold $Q=\\mathbb{R}^{3}$ with coordinates $(x,y,z)$ and its cotangent bundle $T^{*}Q$ carrying the canonical one-form $\\theta=p_{x}\\,\\mathrm{d}x+p_{y}\\,\\mathrm{d}y+p_{z}\\,\\mathrm{d}z$ and the canonical symplectic form $\\omega=\\mathrm{d}\\theta$. Let the Hamiltonian be $H(x,y,z,p_{x},p_{y},p_{z})=\\frac{1}{2}\\big(p_{x}^{2}+p_{y}^{2}+p_{z}^{2}\\big)+V(x,y,z)$, where $V$ is a smooth potential. Impose a distribution $\\mathcal{D}\\subset TQ$ given as the kernel of the one-form $\\alpha=\\mathrm{d}z-x\\,\\mathrm{d}y$, so that admissible velocities satisfy $\\alpha(\\dot{q})=0$, i.e., $\\dot{z}-x\\,\\dot{y}=0$. This distribution is specified by the matrix $A(q)=\\begin{pmatrix}0&-x&1\\end{pmatrix}$ via $A(q)\\,\\dot{q}=0$.\n\nStarting from the canonical symplectic dynamics defined by the condition $\\iota_{X_{H}}\\omega=\\mathrm{d}H$ and imposing the nonholonomic constraint via the d’Alembert principle (reaction forces take values in the annihilator $\\mathcal{D}^{\\circ}=\\mathrm{span}\\{\\alpha\\}$), derive the implicit constrained Hamiltonian dynamics on $T^{*}Q$ and determine the Lagrange multiplier field $\\lambda(x,y,z,p_{x},p_{y},p_{z})$ that enforces the constraint.\n\nYour final answer must be a single closed-form analytic expression for $\\lambda$ in terms of $(x,y,z,p_{x},p_{y},p_{z})$ and the partial derivatives of $V$. No numerical approximation or rounding is required.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard problem in geometric mechanics concerning nonholonomic systems.\n\nThe system is described on the cotangent bundle $T^{*}Q = T^{*}\\mathbb{R}^{3}$, with canonical coordinates $(q, p) = (x, y, z, p_{x}, p_{y}, p_{z})$. The Hamiltonian is given by $H(q,p) = \\frac{1}{2}(p_{x}^{2}+p_{y}^{2}+p_{z}^{2}) + V(x,y,z)$. The dynamics are constrained by a nonholonomic condition on the velocities $\\dot{q} = (\\dot{x}, \\dot{y}, \\dot{z})$, given by the kernel of the one-form $\\alpha = \\mathrm{d}z - x\\,\\mathrm{d}y$. The constraint equation is thus $\\alpha(\\dot{q}) = \\dot{z} - x\\,\\dot{y} = 0$.\n\nIn the Hamiltonian framework, the unconstrained dynamics are generated by the Hamiltonian vector field $X_{H}$, defined by $\\iota_{X_{H}}\\omega = \\mathrm{d}H$, where $\\omega = \\mathrm{d}p_{x} \\wedge \\mathrm{d}x + \\mathrm{d}p_{y} \\wedge \\mathrm{d}y + \\mathrm{d}p_{z} \\wedge \\mathrm{d}z$ is the canonical symplectic form. The effect of the nonholonomic constraint is incorporated by adding a constraint force term to the equations of motion. According to the d’Alembert principle, this constraint force must lie in the annihilator $\\mathcal{D}^{\\circ}$ of the distribution of allowed velocities $\\mathcal{D}$. In this case, $\\mathcal{D}^{\\circ} = \\mathrm{span}\\{\\alpha\\}$. The constrained dynamics are thus governed by the implicit equation $\\iota_{X}\\omega = \\mathrm{d}H - \\lambda\\alpha$, where $X$ is the constrained vector field and $\\lambda$ is a Lagrange multiplier field on $T^{*}Q$.\n\nExpanding this equation in coordinates gives the constrained Hamilton's equations. First, Hamilton's equations for the velocities are unaffected by the constraint force term:\n$\\dot{x} = \\frac{\\partial H}{\\partial p_{x}} = p_{x}$\n$\\dot{y} = \\frac{\\partial H}{\\partial p_{y}} = p_{y}$\n$\\dot{z} = \\frac{\\partial H}{\\partial p_{z}} = p_{z}$\n\nThe equations for the momenta are modified. The constraint one-form is $\\alpha = (0)\\,\\mathrm{d}x + (-x)\\,\\mathrm{d}y + (1)\\,\\mathrm{d}z$, so its components are $\\alpha_{x}=0$, $\\alpha_{y}=-x$, and $\\alpha_{z}=1$. The constraint force covector is $F_{c} = \\lambda\\alpha$, with components $F_{c, i} = \\lambda \\alpha_{i}$. The momentum equations become $\\dot{p}_{i} = -\\frac{\\partial H}{\\partial q^{i}} + F_{c,i}$:\n$\\dot{p}_{x} = -\\frac{\\partial H}{\\partial x} + \\lambda\\alpha_x = -\\frac{\\partial V}{\\partial x}$\n$\\dot{p}_{y} = -\\frac{\\partial H}{\\partial y} + \\lambda\\alpha_y = -\\frac{\\partial V}{\\partial y} - \\lambda x$\n$\\dot{p}_{z} = -\\frac{\\partial H}{\\partial z} + \\lambda\\alpha_z = -\\frac{\\partial V}{\\partial z} + \\lambda$\n\nThe Lagrange multiplier $\\lambda$ is not arbitrary; it is determined by the condition that the flow of the system must satisfy the constraint at all times. Substituting the Hamiltonian expressions for velocities into the constraint equation $\\dot{z} - x\\dot{y} = 0$, we obtain a constraint on the phase space variables:\n$p_{z} - x p_{y} = 0$\n\nLet $C(q,p) = p_{z} - x p_{y}$. This function must be zero along any valid trajectory. For the dynamics to be consistent, the system's trajectory, if starting on the constraint submanifold $M_{C} = \\{(q,p) \\in T^{*}Q \\mid C(q,p)=0\\}$, must remain on $M_{C}$. This requires the total time derivative of $C$ along the constrained flow to be zero.\n$\\frac{\\mathrm{d}C}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t}(p_{z} - x p_{y}) = 0$\n\nUsing the chain rule, we have:\n$\\dot{p}_{z} - (\\dot{x} p_{y} + x \\dot{p}_{y}) = 0$\n\nNow, we substitute the expressions for the time derivatives from the constrained Hamilton's equations into this consistency condition:\n$(\\dot{p}_{z}) - (\\dot{x})p_{y} - x(\\dot{p}_{y}) = 0$\n$\\left(-\\frac{\\partial V}{\\partial z} + \\lambda\\right) - (p_{x})p_{y} - x\\left(-\\frac{\\partial V}{\\partial y} - \\lambda x\\right) = 0$\n\nThis gives an algebraic equation for $\\lambda$. We expand and collect terms involving $\\lambda$:\n$-\\frac{\\partial V}{\\partial z} + \\lambda - p_{x} p_{y} + x\\frac{\\partial V}{\\partial y} + \\lambda x^{2} = 0$\n$\\lambda(1 + x^{2}) - p_{x} p_{y} + x\\frac{\\partial V}{\\partial y} - \\frac{\\partial V}{\\partial z} = 0$\n\nFinally, we solve for the Lagrange multiplier field $\\lambda$:\n$\\lambda(1 + x^{2}) = p_{x} p_{y} - x\\frac{\\partial V}{\\partial y} + \\frac{\\partial V}{\\partial z}$\n$\\lambda(x,y,z,p_{x},p_{y},p_{z}) = \\frac{p_{x} p_{y} - x\\frac{\\partial V}{\\partial y} + \\frac{\\partial V}{\\partial z}}{1 + x^{2}}$\n\nThis is the closed-form analytic expression for the Lagrange multiplier as a function on the phase space $T^{*}Q$.",
            "answer": "$$\n\\boxed{\\frac{p_{x} p_{y} - x\\frac{\\partial V}{\\partial y} + \\frac{\\partial V}{\\partial z}}{1 + x^{2}}}\n$$"
        }
    ]
}