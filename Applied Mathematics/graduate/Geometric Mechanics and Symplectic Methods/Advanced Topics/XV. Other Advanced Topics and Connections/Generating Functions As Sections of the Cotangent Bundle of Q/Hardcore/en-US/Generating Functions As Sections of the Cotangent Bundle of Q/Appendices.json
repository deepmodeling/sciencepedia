{
    "hands_on_practices": [
        {
            "introduction": "The simplest way a generating function creates a Lagrangian submanifold is by defining a section of the cotangent bundle, where momentum is the differential of a scalar function on configuration space, $p=dS(q)$. The analytical properties of this function $S$, such as its critical points and the signature of its Hessian matrix, translate directly into geometric features of the corresponding Lagrangian section. This exercise provides a concrete link between the Morse theory of the function $S$ on $Q$ and the geometry of the state it defines in the phase space $T^*Q$ .",
            "id": "3742811",
            "problem": "Let $Q$ be the smooth manifold $\\mathbb{R}^{4}$ with global coordinates $(q_{1}, q_{2}, q_{3}, q_{4})$, and consider the cotangent bundle $T^{*}Q$ equipped with the canonical symplectic form. Let $S: Q \\to \\mathbb{R}$ be the smooth function\n$$\nS(q_{1}, q_{2}, q_{3}, q_{4}) = \\frac{1}{2}\\left(-2 q_{1}^{2} - q_{2}^{2} + 3 q_{3}^{2} + 5 q_{4}^{2}\\right) + q_{1} q_{2} + 2 q_{3} q_{4}.\n$$\nThe exact $1$-form $dS$ defines a Lagrangian section $\\Lambda = \\operatorname{graph}(dS) \\subset T^{*}Q$. Starting only from the definitions of the gradient, Hessian, Morse index, and the characterization of the tangent space of a graph as the graph of the derivative, proceed as follows:\n\n1. Determine the critical points of $S$ and verify that they are nondegenerate.\n\n2. Compute the Morse index of $S$ at the critical point(s). The Morse index is the number of negative eigenvalues (counted with multiplicity) of the Hessian matrix of $S$ at the critical point.\n\n3. Using the identification $T_{(q_{0}, dS(q_{0}))}\\Lambda = \\{(v, \\mathrm{Hess}_{q_{0}}(S)\\cdot v) : v \\in T_{q_{0}}Q\\}$ and the projection $\\pi: T^{*}Q \\to Q$, relate the Morse index to the local intersection orientation of $\\Lambda$ with the zero section and describe how the signature of the Hessian determines the local behavior of $\\Lambda$ under $\\pi$ near the critical point.\n\nProvide the single integer value of the Morse index of $S$ at its critical point as your final answer. No rounding is required, and no units are involved. Express the answer as a single integer.",
            "solution": "The problem is well-posed and self-contained, situated within the standard mathematical framework of differential geometry and Morse theory. We shall proceed by following the three specified steps.\n\nLet the smooth manifold be $Q = \\mathbb{R}^{4}$ with global coordinates $(q_{1}, q_{2}, q_{3}, q_{4})$. The smooth function $S: Q \\to \\mathbb{R}$ is given by\n$$\nS(q_{1}, q_{2}, q_{3}, q_{4}) = \\frac{1}{2}\\left(-2 q_{1}^{2} - q_{2}^{2} + 3 q_{3}^{2} + 5 q_{4}^{2}\\right) + q_{1} q_{2} + 2 q_{3} q_{4}.\n$$\nThe Lagrangian section $\\Lambda$ is the graph of the exact $1$-form $dS$.\n\n**1. Critical Points and Nondegeneracy**\n\nA point $q_{0} \\in Q$ is a critical point of $S$ if the differential $dS$ vanishes at $q_{0}$. In local coordinates, this means all first partial derivatives of $S$ are zero at $q_{0}$. We compute the gradient of $S$:\n$$\n\\nabla S = \\left( \\frac{\\partial S}{\\partial q_{1}}, \\frac{\\partial S}{\\partial q_{2}}, \\frac{\\partial S}{\\partial q_{3}}, \\frac{\\partial S}{\\partial q_{4}} \\right).\n$$\nThe partial derivatives are:\n$$\n\\frac{\\partial S}{\\partial q_{1}} = -2 q_{1} + q_{2}\n$$\n$$\n\\frac{\\partial S}{\\partial q_{2}} = -q_{2} + q_{1}\n$$\n$$\n\\frac{\\partial S}{\\partial q_{3}} = 3 q_{3} + 2 q_{4}\n$$\n$$\n\\frac{\\partial S}{\\partial q_{4}} = 5 q_{4} + 2 q_{3}\n$$\nSetting these derivatives to zero gives a system of linear equations:\n\\begin{align*}\n-2 q_{1} + q_{2} &= 0 \\\\\nq_{1} - q_{2} &= 0 \\\\\n3 q_{3} + 2 q_{4} &= 0 \\\\\n2 q_{3} + 5 q_{4} &= 0\n\\end{align*}\nFrom the first two equations, $q_{2} = 2 q_{1}$ and $q_{1} = q_{2}$. This implies $q_{1} = 2 q_{1}$, which means $q_{1} = 0$, and consequently $q_{2} = 0$.\nFrom the third equation, $q_{4} = -\\frac{3}{2} q_{3}$. Substituting this into the fourth equation gives $2 q_{3} + 5(-\\frac{3}{2} q_{3}) = 0$, which simplifies to $2 q_{3} - \\frac{15}{2} q_{3} = 0$, or $-\\frac{11}{2} q_{3} = 0$. This implies $q_{3} = 0$, and consequently $q_{4} = 0$.\nThus, there is a single critical point at $q_{0} = (0, 0, 0, 0)$.\n\nA critical point is nondegenerate if the Hessian matrix of $S$ evaluated at that point is invertible. The Hessian matrix, $H = \\mathrm{Hess}(S)$, has entries $H_{ij} = \\frac{\\partial^2 S}{\\partial q_i \\partial q_j}$. As $S$ is a quadratic function, its Hessian is a constant matrix.\n$$\nH = \\begin{pmatrix}\n\\frac{\\partial^2 S}{\\partial q_{1}^2} & \\frac{\\partial^2 S}{\\partial q_{1} \\partial q_{2}} & \\frac{\\partial^2 S}{\\partial q_{1} \\partial q_{3}} & \\frac{\\partial^2 S}{\\partial q_{1} \\partial q_{4}} \\\\\n\\frac{\\partial^2 S}{\\partial q_{2} \\partial q_{1}} & \\frac{\\partial^2 S}{\\partial q_{2}^2} & \\frac{\\partial^2 S}{\\partial q_{2} \\partial q_{3}} & \\frac{\\partial^2 S}{\\partial q_{2} \\partial q_{4}} \\\\\n\\frac{\\partial^2 S}{\\partial q_{3} \\partial q_{1}} & \\frac{\\partial^2 S}{\\partial q_{3} \\partial q_{2}} & \\frac{\\partial^2 S}{\\partial q_{3}^2} & \\frac{\\partial^2 S}{\\partial q_{3} \\partial q_{4}} \\\\\n\\frac{\\partial^2 S}{\\partial q_{4} \\partial q_{1}} & \\frac{\\partial^2 S}{\\partial q_{4} \\partial q_{2}} & \\frac{\\partial^2 S}{\\partial q_{4} \\partial q_{3}} & \\frac{\\partial^2 S}{\\partial q_{4}^2}\n\\end{pmatrix} = \\begin{pmatrix}\n-2 & 1 & 0 & 0 \\\\\n1 & -1 & 0 & 0 \\\\\n0 & 0 & 3 & 2 \\\\\n0 & 0 & 2 & 5\n\\end{pmatrix}.\n$$\nThe determinant of this block-diagonal matrix is the product of the determinants of the diagonal blocks:\n$$\n\\det(H) = \\det\\begin{pmatrix} -2 & 1 \\\\ 1 & -1 \\end{pmatrix} \\cdot \\det\\begin{pmatrix} 3 & 2 \\\\ 2 & 5 \\end{pmatrix} = ((-2)(-1) - (1)(1)) \\cdot ((3)(5) - (2)(2)) = (2-1)(15-4) = (1)(11) = 11.\n$$\nSince $\\det(H) = 11 \\neq 0$, the Hessian is invertible. Therefore, the critical point $q_{0} = (0, 0, 0, 0)$ is nondegenerate.\n\n**2. Morse Index**\n\nThe Morse index of $S$ at a critical point is the number of negative eigenvalues of the Hessian matrix at that point. We need to find the eigenvalues of $H$. Due to the block-diagonal structure, we can find the eigenvalues of each $2 \\times 2$ block separately.\n\nFor the first block, $H_{11} = \\begin{pmatrix} -2 & 1 \\\\ 1 & -1 \\end{pmatrix}$, the characteristic equation is $\\det(H_{11} - \\lambda I) = 0$:\n$$\n(-2-\\lambda)(-1-\\lambda) - 1 = \\lambda^2 + 3\\lambda + 2 - 1 = \\lambda^2 + 3\\lambda + 1 = 0.\n$$\nThe eigenvalues are $\\lambda = \\frac{-3 \\pm \\sqrt{3^2 - 4(1)(1)}}{2} = \\frac{-3 \\pm \\sqrt{5}}{2}$. Since $\\sqrt{5} \\approx 2.236$, both eigenvalues $\\lambda_{1} = \\frac{-3+\\sqrt{5}}{2}$ and $\\lambda_{2} = \\frac{-3-\\sqrt{5}}{2}$ are negative.\n\nFor the second block, $H_{22} = \\begin{pmatrix} 3 & 2 \\\\ 2 & 5 \\end{pmatrix}$, the characteristic equation is $\\det(H_{22} - \\lambda I) = 0$:\n$$\n(3-\\lambda)(5-\\lambda) - 4 = \\lambda^2 - 8\\lambda + 15 - 4 = \\lambda^2 - 8\\lambda + 11 = 0.\n$$\nThe eigenvalues are $\\lambda = \\frac{8 \\pm \\sqrt{(-8)^2 - 4(1)(11)}}{2} = \\frac{8 \\pm \\sqrt{64-44}}{2} = \\frac{8 \\pm \\sqrt{20}}{2} = 4 \\pm \\sqrt{5}$. Since $\\sqrt{5} \\approx 2.236 < 4$, both eigenvalues $\\lambda_{3} = 4+\\sqrt{5}$ and $\\lambda_{4} = 4-\\sqrt{5}$ are positive.\n\nThe set of eigenvalues of $H$ is $\\{\\frac{-3+\\sqrt{5}}{2}, \\frac{-3-\\sqrt{5}}{2}, 4+\\sqrt{5}, 4-\\sqrt{5}\\}$. There are exactly two negative eigenvalues.\nTherefore, the Morse index of $S$ at the critical point $q_{0}=(0,0,0,0)$ is $2$.\n\n**3. Geometric Interpretation**\n\nThe Lagrangian section $\\Lambda = \\operatorname{graph}(dS)$ intersects the zero section $Z = \\{(q, 0) \\mid q \\in Q\\}$ at points $(q, p) \\in T^*Q$ where $p = dS(q) = 0$. This corresponds precisely to the critical points of $S$. In our case, the only intersection point is $(q_{0}, 0) = ((0,0,0,0), 0)$.\n\nThe tangent space to $\\Lambda$ at this intersection point is $T_{(q_{0}, 0)}\\Lambda = \\{(v, \\mathrm{Hess}_{q_{0}}(S)\\cdot v) : v \\in T_{q_{0}}Q\\}$, and the tangent space to the zero section is $T_{(q_{0}, 0)}Z = \\{(v, 0) : v \\in T_{q_{0}}Q\\}$. The intersection of these two tangent spaces is transverse if $T_{(q_{0}, 0)}\\Lambda \\cap T_{(q_{0}, 0)}Z = \\{0\\}$. This requires that if $(v, \\mathrm{Hess}_{q_{0}}(S)\\cdot v) = (v, 0)$, then $v=0$. This is equivalent to requiring that $\\mathrm{Hess}_{q_{0}}(S)\\cdot v = 0$ implies $v=0$, which is true if and only if $\\mathrm{Hess}_{q_{0}}(S)$ is invertible. As we have shown $\\det(H) \\neq 0$, the intersection is transverse.\n\nThe Morse index describes the local geometry of this intersection. By the Morse Lemma, there exist local coordinates $(y_1, y_2, y_3, y_4)$ near $q_0$ such that $S$ takes the form\n$$\nS(y) = S(q_0) - \\frac{1}{2}(y_1^2 + y_2^2) + \\frac{1}{2}(y_3^2 + y_4^2),\n$$\nwhere the number of negative terms corresponds to the Morse index, which is $2$.\nIn these coordinates, the section $\\Lambda$ is given by $p_i = \\partial S/\\partial y_i$, so $p_1 = -y_1$, $p_2 = -y_2$, $p_3 = y_3$, $p_4 = y_4$.\nThe Hessian matrix in these coordinates is $\\mathrm{diag}(-1, -1, 1, 1)$, which has signature $(2, 2)$ (number of positive, number of negative eigenvalues). The Morse index is the number of negative eigenvalues, $k=2$.\n\nThe \"local intersection orientation\" can be described by a quadratic form on $T_{q_0}Q$ that measures the discrepancy between $T\\Lambda$ and $TZ$. This form is given by $B(v,v) = - \\langle v, \\mathrm{Hess}_{q_0}(S) \\cdot v \\rangle$. The signature of this form is $(k, n-k)$, where $n=\\dim Q=4$ and $k$ is the Morse index. In our case, the signature is $(2, 2)$.\n\nThe projection $\\pi: T^*Q \\to Q$ maps $(q,p) \\mapsto q$. Its restriction to $\\Lambda$, $\\pi|_\\Lambda: \\Lambda \\to Q$, is a local diffeomorphism around the critical point because its differential is an isomorphism (a consequence of the non-degeneracy of the Hessian). The Morse index does not affect the local diffeomorphic nature of the projection itself, but rather describes how the section $\\Lambda$ is \"tilted\" with respect to the zero section $Z$. A Morse index of $k=2$ means that locally, $\\Lambda$ is tilted \"downwards\" (momentum opposite to position displacement) in two directions and \"upwards\" (momentum aligned with position displacement) in the other two directions. This describes the local behavior of $\\Lambda$ relative to the base space $Q$ near the critical point.",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "Beyond defining static states, generating functions are powerful tools for constructing canonical transformations—coordinate changes on phase space that preserve the fundamental symplectic structure. A function of both \"old\" and \"new\" configuration coordinates, $S(q,Q)$, defines a Lagrangian submanifold in a product phase space, which can be interpreted as the graph of a symplectomorphism. This practice guides you through the explicit construction of a linear symplectic map from a quadratic generating function, making tangible the crucial role of the invertible mixed Hessian in defining the transformation .",
            "id": "3742786",
            "problem": "Let $Q$ be a smooth manifold diffeomorphic to $\\mathbb{R}^2$ with global coordinates $q = (q_1,q_2)$. Consider the cotangent bundle $T^*Q$ with canonical coordinates $(q,p)$, where $p=(p_1,p_2)$ are fiber coordinates. The cotangent bundle $T^*Q$ carries the canonical one-form $\\theta = p_i \\, dq^i$ and the canonical symplectic form $\\omega = d\\theta$. A diffeomorphism $\\Phi: T^*Q \\to T^*Q$ is called a symplectomorphism if it preserves $\\omega$. One method to construct local symplectomorphisms is via generating functions as sections of the cotangent bundle of $Q$, using a smooth function $S(q,Q)$ on $Q \\times Q$ to define an exact Lagrangian submanifold of $T^*Q \\times T^*Q$ with respect to the symplectic form $\\pi_1^* \\omega - \\pi_2^* \\omega$, where $\\pi_1$ and $\\pi_2$ are the projections to the first and second factors.\n\nStarting only from the canonical definitions of $\\theta$ and $\\omega$ on $T^*Q$, and the characterization that the graph of a symplectomorphism is a Lagrangian submanifold in $T^*Q \\times T^*Q$ with respect to $\\pi_1^* \\omega - \\pi_2^* \\omega$, derive the local conditions under which a smooth function $S(q,Q)$ generates a symplectomorphism $\\Phi: (q,p) \\mapsto (Q,P)$ and explain why the invertibility of the mixed Hessian $\\frac{\\partial^2 S}{\\partial q \\, \\partial Q}$ guarantees solvability for $(Q,P)$ as functions of $(q,p)$ in a neighborhood.\n\nThen, for the explicit choice\n$$\nS(q,Q) = \\frac{1}{2} q^{\\top} A q + q^{\\top} B Q + \\frac{1}{2} Q^{\\top} C Q,\n$$\nwith\n$$\nA = \\begin{pmatrix} 2 & 1 \\\\ 1 & 3 \\end{pmatrix}, \n\\quad B = \\begin{pmatrix} 1 & 2 \\\\ 3 & 1 \\end{pmatrix}, \n\\quad C = \\begin{pmatrix} 4 & 0 \\\\ 0 & 5 \\end{pmatrix},\n$$\nverify that the mixed Hessian $\\frac{\\partial^2 S}{\\partial q \\, \\partial Q}$ is invertible at every point, construct the corresponding symplectomorphism $\\Phi$ generated by $S$, and solve explicitly for $Q=(Q_1,Q_2)$ and $P=(P_1,P_2)$ as functions of $q=(q_1,q_2)$ and $p=(p_1,p_2)$.\n\nYour final answer must be a single analytic expression that provides the four components $Q_1$, $Q_2$, $P_1$, and $P_2$ in terms of $q_1$, $q_2$, $p_1$, and $p_2$, presented together as a single row matrix.",
            "solution": "We begin with the cotangent bundle $T^*Q$ equipped with the canonical one-form $\\theta = p_i \\, dq^i$ and symplectic form $\\omega = d\\theta$. On the product $T^*Q \\times T^*Q$ with coordinates $(q,p; Q,P)$, consider the symplectic form $\\pi_1^* \\omega - \\pi_2^* \\omega$. The graph of a diffeomorphism $\\Phi: T^*Q \\to T^*Q$, namely the set\n$$\n\\Gamma_{\\Phi} = \\{ (q,p; Q,P) \\in T^*Q \\times T^*Q \\mid (Q,P) = \\Phi(q,p) \\},\n$$\nis Lagrangian with respect to $\\pi_1^* \\omega - \\pi_2^* \\omega$ if and only if $\\Phi$ is a symplectomorphism.\n\nA generating function of the first kind is a smooth function $S: Q \\times Q \\to \\mathbb{R}$. It defines a one-form on $Q \\times Q$ given by $dS = \\frac{\\partial S}{\\partial q_i} \\, dq^i + \\frac{\\partial S}{\\partial Q_i} \\, dQ^i$. Consider the one-form on $T^*Q \\times T^*Q$,\n$$\n\\beta = \\pi_1^* \\theta - \\pi_2^* \\theta - dS = p_i \\, dq^i - P_i \\, dQ^i - \\frac{\\partial S}{\\partial q_i} \\, dq^i - \\frac{\\partial S}{\\partial Q_i} \\, dQ^i.\n$$\nThen\n$$\nd\\beta = \\pi_1^* \\omega - \\pi_2^* \\omega,\n$$\nsince $d(dS)=0$. The zero-set of $\\beta$ defines a submanifold\n$$\nL = \\{ (q,p; Q,P) \\in T^*Q \\times T^*Q \\mid \\beta = 0 \\}.\n$$\nAlong $L$, the equality $\\beta=0$ implies that the coefficients of $dq^i$ and $dQ^i$ vanish, yielding the relations\n$$\np_i = \\frac{\\partial S}{\\partial q_i}, \\qquad P_i = - \\frac{\\partial S}{\\partial Q_i}.\n$$\nThese equations specify $p$ and $P$ as functions of $q$ and $Q$. Moreover, since $d\\beta = \\pi_1^* \\omega - \\pi_2^* \\omega$, the submanifold $L$ is Lagrangian. When the mixed Hessian $\\frac{\\partial^2 S}{\\partial q \\, \\partial Q}$ is invertible, the implicit function theorem guarantees that the system\n$$\np - \\frac{\\partial S}{\\partial q}(q,Q) = 0\n$$\ncan be locally solved for $Q$ as a smooth function of $(q,p)$. Substituting this $Q(q,p)$ into $P = - \\frac{\\partial S}{\\partial Q}(q,Q)$ produces a smooth local map $\\Phi(q,p) = \\big(Q(q,p), P(q,p)\\big)$ whose graph is $L$, hence $\\Phi$ is a local symplectomorphism.\n\nWe now apply this construction to the explicit function\n$$\nS(q,Q) = \\frac{1}{2} q^{\\top} A q + q^{\\top} B Q + \\frac{1}{2} Q^{\\top} C Q,\n$$\nwith\n$$\nA = \\begin{pmatrix} 2 & 1 \\\\ 1 & 3 \\end{pmatrix}, \n\\quad B = \\begin{pmatrix} 1 & 2 \\\\ 3 & 1 \\end{pmatrix}, \n\\quad C = \\begin{pmatrix} 4 & 0 \\\\ 0 & 5 \\end{pmatrix}.\n$$\nThe gradient with respect to $q$ and $Q$ are\n$$\n\\frac{\\partial S}{\\partial q} = A q + B Q, \n\\qquad \n\\frac{\\partial S}{\\partial Q} = B^{\\top} q + C Q.\n$$\nTherefore the relations defining $L$ are\n$$\np = A q + B Q, \n\\qquad \nP = - B^{\\top} q - C Q.\n$$\nThe mixed Hessian is\n$$\n\\frac{\\partial^2 S}{\\partial q \\, \\partial Q} = B,\n$$\nwhich is constant. Its determinant is\n$$\n\\det(B) = (1)(1) - (2)(3) = 1 - 6 = -5 \\neq 0,\n$$\nso $B$ is invertible, and thus the mixed Hessian is everywhere invertible. Consequently, we can solve the first equation for $Q$:\n$$\nB Q = p - A q \n\\quad\\Longrightarrow\\quad\nQ = B^{-1} \\big( p - A q \\big).\n$$\nFor the given $B$, its inverse is\n$$\nB^{-1} = \\frac{1}{\\det(B)} \\begin{pmatrix} 1 & -2 \\\\ -3 & 1 \\end{pmatrix}\n= -\\frac{1}{5} \\begin{pmatrix} 1 & -2 \\\\ -3 & 1 \\end{pmatrix}.\n$$\nWrite $q = (q_1,q_2)^{\\top}$ and $p = (p_1,p_2)^{\\top}$. Then\n$$\nA q = \\begin{pmatrix} 2 & 1 \\\\ 1 & 3 \\end{pmatrix} \\begin{pmatrix} q_1 \\\\ q_2 \\end{pmatrix}\n= \\begin{pmatrix} 2 q_1 + q_2 \\\\ q_1 + 3 q_2 \\end{pmatrix},\n$$\nand\n$$\np - A q = \\begin{pmatrix} p_1 - (2 q_1 + q_2) \\\\ p_2 - (q_1 + 3 q_2) \\end{pmatrix}.\n$$\nHence\n\\begin{align*}\nQ &= B^{-1} (p - A q) \\\\\n&= -\\frac{1}{5} \n\\begin{pmatrix} \n1 & -2 \\\\\n-3 & 1 \n\\end{pmatrix}\n\\begin{pmatrix} \np_1 - (2 q_1 + q_2) \\\\\np_2 - (q_1 + 3 q_2) \n\\end{pmatrix}.\n\\end{align*}\nExpanding components:\n\\begin{align*}\nQ_1 &= -\\frac{1}{5} \\Big( \\big(p_1 - 2 q_1 - q_2\\big) - 2\\big(p_2 - q_1 - 3 q_2\\big) \\Big)\n= -\\frac{1}{5} \\big( p_1 - 2 p_2 + 5 q_2 \\big)\n= -\\frac{1}{5} p_1 + \\frac{2}{5} p_2 - q_2, \\\\\nQ_2 &= -\\frac{1}{5} \\Big( -3\\big(p_1 - 2 q_1 - q_2\\big) + \\big(p_2 - q_1 - 3 q_2\\big) \\Big)\n= -\\frac{1}{5} \\big( -3 p_1 + p_2 + 5 q_1 \\big)\n= \\frac{3}{5} p_1 - \\frac{1}{5} p_2 - q_1.\n\\end{align*}\nWith $Q$ expressed in terms of $(q,p)$, we compute $P$ using\n$$\nP = - B^{\\top} q - C Q.\n$$\nSince $B^{\\top} = \\begin{pmatrix} 1 & 3 \\\\ 2 & 1 \\end{pmatrix}$, we have\n$$\n- B^{\\top} q = \\begin{pmatrix} -q_1 - 3 q_2 \\\\ -2 q_1 - q_2 \\end{pmatrix},\n\\qquad\nC Q = \\begin{pmatrix} 4 & 0 \\\\ 0 & 5 \\end{pmatrix} \\begin{pmatrix} Q_1 \\\\ Q_2 \\end{pmatrix}\n= \\begin{pmatrix} 4 Q_1 \\\\ 5 Q_2 \\end{pmatrix}.\n$$\nThus\n\\begin{align*}\nP_1 &= -q_1 - 3 q_2 - 4 Q_1 \n= -q_1 - 3 q_2 - 4\\Big( -\\frac{1}{5} p_1 + \\frac{2}{5} p_2 - q_2 \\Big)\n= -q_1 + q_2 + \\frac{4}{5} p_1 - \\frac{8}{5} p_2, \\\\\nP_2 &= -2 q_1 - q_2 - 5 Q_2 \n= -2 q_1 - q_2 - 5\\Big( \\frac{3}{5} p_1 - \\frac{1}{5} p_2 - q_1 \\Big)\n= 3 q_1 - q_2 - 3 p_1 + p_2.\n\\end{align*}\nTherefore, the local symplectomorphism $\\Phi: (q,p) \\mapsto (Q,P)$ generated by $S$ is explicitly given by the above component-wise formulas, valid in a neighborhood where the implicit function theorem applies (in this linear case, globally since $B$ is invertible). The mixed Hessian is constant and equal to $B$, which is invertible everywhere, so solvability for $(Q,P)$ in terms of $(q,p)$ follows directly.\n\nCollecting the four components as requested, we obtain the final expressions\n\\begin{align*}\nQ_1 &= -\\frac{1}{5} p_1 + \\frac{2}{5} p_2 - q_2, \\\\\nQ_2 &= \\frac{3}{5} p_1 - \\frac{1}{5} p_2 - q_1, \\\\\nP_1 &= \\frac{4}{5} p_1 - \\frac{8}{5} p_2 - q_1 + q_2, \\\\\nP_2 &= -3 p_1 + p_2 + 3 q_1 - q_2.\n\\end{align*}\nThese solve explicitly for $(Q,P)$ as functions of $(q,p)$ for the given generating function $S$.",
            "answer": "$$\\boxed{\\begin{pmatrix}\n-\\frac{1}{5} p_1 + \\frac{2}{5} p_2 - q_2 & \\frac{3}{5} p_1 - \\frac{1}{5} p_2 - q_1 & \\frac{4}{5} p_1 - \\frac{8}{5} p_2 - q_1 + q_2 & -3 p_1 + p_2 + 3 q_1 - q_2\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "The concept of generating functions finds a profound application in describing the time evolution of mechanical systems, forming the theoretical foundation for geometric numerical methods known as variational integrators. The \"exact discrete Lagrangian,\" derived from the action integral, acts as a generating function for the system's exact time-$h$ flow map, guaranteeing that the resulting discrete-time algorithm is symplectic. By deriving this map for the harmonic oscillator, you will witness how a variational principle leads to a structure-preserving integrator that exactly conserves energy, a remarkable feature not shared by many standard numerical schemes .",
            "id": "3742803",
            "problem": "Consider a one-degree-of-freedom mechanical system with configuration manifold $Q=\\mathbb{R}$ and cotangent bundle $T^{*}Q$ equipped with the canonical symplectic form $\\omega_{\\mathrm{can}}=\\mathrm{d}q \\wedge \\mathrm{d}p$. Let the system be the harmonic oscillator with mass $m>0$ and stiffness $k>0$, with continuous-time Lagrangian $L(q,\\dot{q})=\\tfrac{1}{2}m\\,\\dot{q}^{2}-\\tfrac{1}{2}k\\,q^{2}$. Define the angular frequency $\\omega=\\sqrt{k/m}$ and a fixed time-step $h>0$.\n\nThe exact discrete Lagrangian $L_{d}(q_{0},q_{1};h)$ is defined as the action integral along the unique solution of the Euler–Lagrange equation that interpolates the boundary values $q(0)=q_{0}$ and $q(h)=q_{1}$ over the time interval $[0,h]$:\n$$\nL_{d}(q_{0},q_{1};h)=\\int_{0}^{h} L\\big(q(t),\\dot{q}(t)\\big)\\,\\mathrm{d}t,\n$$\nwhere $q(t)$ satisfies $m\\,\\ddot{q}(t)+k\\,q(t)=0$ and the given endpoint conditions. Use only fundamental definitions and well-tested facts to:\n- Solve the ordinary differential equation (ODE) for $q(t)$ with the specified boundary conditions.\n- Evaluate the action integral to obtain a closed-form analytic expression for $L_{d}(q_{0},q_{1};h)$ in terms of $q_{0}$, $q_{1}$, $m$, $\\omega$, and $h$, with all trigonometric arguments in radians.\n- Using the discrete Legendre transforms $p_{0}=-D_{1}L_{d}(q_{0},q_{1};h)$ and $p_{1}=D_{2}L_{d}(q_{0},q_{1};h)$, derive the induced discrete map $\\Phi_{h}:(q_{0},p_{0})\\mapsto(q_{1},p_{1})$ and interpret it as a rotation in the $(q,p)$-plane generated by the harmonic oscillator flow.\n- Verify that the resulting discrete map is symplectic with respect to $\\omega_{\\mathrm{can}}$.\n- Demonstrate that the mechanical energy $H(q,p)=\\tfrac{1}{2m}p^{2}+\\tfrac{1}{2}k\\,q^{2}$ is exactly preserved by the discrete map for all $h$.\n\nReport as your final answer only the explicit closed-form analytic expression for $L_{d}(q_{0},q_{1};h)$. The quantity $L_{d}$ has units of action (Joule-second), but do not include units in your final boxed answer. All angles must be in radians. No rounding is required.",
            "solution": "**1. Solve the ODE for the path $q(t)$**\nThe Euler-Lagrange equation for the given Lagrangian is derived from $\\frac{\\mathrm{d}}{\\mathrm{d}t}\\frac{\\partial L}{\\partial \\dot{q}} - \\frac{\\partial L}{\\partial q} = 0$.\n$\\frac{\\partial L}{\\partial \\dot{q}} = m\\dot{q}$ and $\\frac{\\partial L}{\\partial q} = -kq$.\nThus, the equation of motion is $m\\ddot{q} + kq = 0$. Using the definition $\\omega^2 = k/m$, this becomes:\n$$\n\\ddot{q}(t) + \\omega^2 q(t) = 0\n$$\nThe general solution to this second-order linear homogeneous ODE is:\n$$\nq(t) = A\\cos(\\omega t) + B\\sin(\\omega t)\n$$\nwhere $A$ and $B$ are constants determined by the boundary conditions $q(0)=q_{0}$ and $q(h)=q_{1}$.\nApplying the first condition at $t=0$:\n$$\nq(0) = A\\cos(0) + B\\sin(0) = A = q_{0}\n$$\nSo, the solution becomes $q(t) = q_{0}\\cos(\\omega t) + B\\sin(\\omega t)$.\nApplying the second condition at $t=h$:\n$$\nq(h) = q_{0}\\cos(\\omega h) + B\\sin(\\omega h) = q_{1}\n$$\nSolving for $B$, assuming $\\sin(\\omega h) \\neq 0$:\n$$\nB = \\frac{q_{1} - q_{0}\\cos(\\omega h)}{\\sin(\\omega h)}\n$$\nSubstituting $A$ and $B$ back into the general solution gives the unique trajectory satisfying the boundary conditions:\n$$\nq(t) = q_{0}\\cos(\\omega t) + \\left(\\frac{q_{1} - q_{0}\\cos(\\omega h)}{\\sin(\\omega h)}\\right)\\sin(\\omega t)\n$$\nThe velocity along this trajectory is $\\dot{q}(t)$:\n$$\n\\dot{q}(t) = -q_{0}\\omega\\sin(\\omega t) + \\omega\\left(\\frac{q_{1} - q_{0}\\cos(\\omega h)}{\\sin(\\omega h)}\\right)\\cos(\\omega t)\n$$\n\n**2. Evaluate the action integral for $L_{d}(q_{0},q_{1};h)$**\nThe discrete Lagrangian is $L_{d}=\\int_{0}^{h} (\\tfrac{1}{2}m\\,\\dot{q}^{2}-\\tfrac{1}{2}k\\,q^{2})\\,\\mathrm{d}t$. A more elegant method utilizes integration by parts and the equation of motion.\n$$\n\\int_{0}^{h} \\tfrac{1}{2}m\\dot{q}^{2} \\,\\mathrm{d}t = \\frac{1}{2}m \\int_{0}^{h} \\dot{q} \\cdot \\dot{q} \\,\\mathrm{d}t\n$$\nIntegrating by parts with $u=\\dot{q}$ and $\\mathrm{d}v=\\dot{q}\\mathrm{d}t$:\n$$\n\\frac{1}{2}m \\int_{0}^{h} \\dot{q}^{2} \\,\\mathrm{d}t = \\frac{1}{2}m \\left[ \\dot{q}(t)q(t) \\right]_{0}^{h} - \\frac{1}{2}m \\int_{0}^{h} \\ddot{q}(t)q(t) \\,\\mathrm{d}t\n$$\nFrom the equation of motion, $m\\ddot{q} = -kq$. Substituting this into the integral:\n$$\n- \\frac{1}{2}m \\int_{0}^{h} \\ddot{q}q \\,\\mathrm{d}t = - \\frac{1}{2} \\int_{0}^{h} (-kq)q \\,\\mathrm{d}t = \\int_{0}^{h} \\tfrac{1}{2}kq^2 \\,\\mathrm{d}t\n$$\nSo we have:\n$$\n\\int_{0}^{h} \\tfrac{1}{2}m\\dot{q}^{2} \\,\\mathrm{d}t = \\frac{1}{2}m \\left( \\dot{q}(h)q(h) - \\dot{q}(0)q(0) \\right) + \\int_{0}^{h} \\tfrac{1}{2}kq^2 \\,\\mathrm{d}t\n$$\nNow substitute this back into the definition of $L_d$:\n$$\nL_{d} = \\left[ \\frac{1}{2}m (\\dot{q}(h)q_{1} - \\dot{q}(0)q_{0}) + \\int_{0}^{h} \\tfrac{1}{2}kq^2 \\,\\mathrm{d}t \\right] - \\int_{0}^{h} \\tfrac{1}{2}kq^2 \\,\\mathrm{d}t\n$$\n$$\nL_{d}(q_{0},q_{1};h) = \\frac{1}{2}m \\left( \\dot{q}(h)q_{1} - \\dot{q}(0)q_{0} \\right)\n$$\nWe need the velocities at the endpoints.\nAt $t=0$:\n$$\n\\dot{q}(0) = -q_{0}\\omega\\sin(0) + \\omega\\left(\\frac{q_{1} - q_{0}\\cos(\\omega h)}{\\sin(\\omega h)}\\right)\\cos(0) = \\omega\\frac{q_{1} - q_{0}\\cos(\\omega h)}{\\sin(\\omega h)}\n$$\nAt $t=h$:\n$$\n\\dot{q}(h) = -q_{0}\\omega\\sin(\\omega h) + \\omega\\left(\\frac{q_{1} - q_{0}\\cos(\\omega h)}{\\sin(\\omega h)}\\right)\\cos(\\omega h) = \\frac{\\omega(q_{1}\\cos(\\omega h) - q_{0})}{\\sin(\\omega h)}\n$$\nSubstituting these velocities into the expression for $L_d$:\n$$\nL_{d} = \\frac{1}{2}m \\left[ \\left(\\frac{\\omega(q_{1}\\cos(\\omega h) - q_{0})}{\\sin(\\omega h)}\\right)q_{1} - \\left(\\frac{\\omega(q_{1} - q_{0}\\cos(\\omega h))}{\\sin(\\omega h)}\\right)q_{0} \\right]\n$$\n$$\nL_{d} = \\frac{m\\omega}{2\\sin(\\omega h)} \\left[ (q_{1}^2\\cos(\\omega h) - q_{0}q_{1}) - (q_{0}q_{1} - q_{0}^2\\cos(\\omega h)) \\right]\n$$\n$$\nL_{d}(q_{0},q_{1};h) = \\frac{m\\omega}{2\\sin(\\omega h)} \\left[ (q_{0}^2 + q_{1}^2)\\cos(\\omega h) - 2q_{0}q_{1} \\right]\n$$\nThis is the closed-form expression for the exact discrete Lagrangian.\n\n**3. Derive the discrete map $\\Phi_{h}$**\nThe discrete momenta $p_0$ and $p_1$ are found via the discrete Legendre transforms:\n$p_0 = -D_1 L_d = -\\frac{\\partial L_d}{\\partial q_0}$:\n$$\np_0 = -\\frac{m\\omega}{2\\sin(\\omega h)} \\left[ 2q_{0}\\cos(\\omega h) - 2q_{1} \\right] = \\frac{m\\omega}{\\sin(\\omega h)} \\left( q_{1} - q_{0}\\cos(\\omega h) \\right)\n$$\n$p_1 = D_2 L_d = \\frac{\\partial L_d}{\\partial q_1}$:\n$$\np_1 = \\frac{m\\omega}{2\\sin(\\omega h)} \\left[ 2q_{1}\\cos(\\omega h) - 2q_{0} \\right] = \\frac{m\\omega}{\\sin(\\omega h)} \\left( q_{1}\\cos(\\omega h) - q_{0} \\right)\n$$\nTo find $\\Phi_h: (q_0, p_0)\\mapsto(q_1, p_1)$, we must express $q_1$ and $p_1$ in terms of $q_0$ and $p_0$. From the equation for $p_0$:\n$$\nq_1 = q_0\\cos(\\omega h) + \\frac{p_0}{m\\omega}\\sin(\\omega h)\n$$\nNow substitute this into the equation for $p_1$:\n$$\np_1 = \\frac{m\\omega}{\\sin(\\omega h)} \\left[ \\left(q_0\\cos(\\omega h) + \\frac{p_0}{m\\omega}\\sin(\\omega h)\\right)\\cos(\\omega h) - q_0 \\right]\n$$\n$$\np_1 = \\frac{m\\omega}{\\sin(\\omega h)} \\left[ q_0(\\cos^2(\\omega h)-1) + \\frac{p_0}{m\\omega}\\sin(\\omega h)\\cos(\\omega h) \\right]\n$$\n$$\np_1 = -m\\omega q_0\\sin(\\omega h) + p_0\\cos(\\omega h)\n$$\nSo, the discrete map $\\Phi_h$ is given by the matrix equation:\n$$\n\\begin{pmatrix} q_1 \\\\ p_1 \\end{pmatrix} = \\begin{pmatrix} \\cos(\\omega h) & \\frac{1}{m\\omega}\\sin(\\omega h) \\\\ -m\\omega\\sin(\\omega h) & \\cos(\\omega h) \\end{pmatrix} \\begin{pmatrix} q_0 \\\\ p_0 \\end{pmatrix}\n$$\nThis is the time-$h$ flow map for the continuous harmonic oscillator, a rotation in phase space.\n\n**4. Verify the map is symplectic**\nThe Jacobian matrix of the map is $M = \\begin{pmatrix} \\cos(\\omega h) & \\frac{1}{m\\omega}\\sin(\\omega h) \\\\ -m\\omega\\sin(\\omega h) & \\cos(\\omega h) \\end{pmatrix}$. A $2 \\times 2$ linear map is symplectic if and only if its determinant is $1$.\n$$\n\\det(M) = \\cos^2(\\omega h) - (\\frac{1}{m\\omega}\\sin(\\omega h))(-m\\omega\\sin(\\omega h)) = \\cos^2(\\omega h) + \\sin^2(\\omega h) = 1\n$$\nThe map is symplectic, as expected from its construction via a generating function.\n\n**5. Verify energy conservation**\nThe Hamiltonian is $H(q,p) = \\frac{p^2}{2m} + \\frac{1}{2}m\\omega^2q^2$. We must show $H(q_1,p_1)=H(q_0,p_0)$. Consider $2mH(q_1, p_1) = p_1^2 + m^2\\omega^2q_1^2$.\n$$\np_1^2 = (-m\\omega q_0\\sin(\\omega h) + p_0\\cos(\\omega h))^2 = m^2\\omega^2q_0^2\\sin^2(\\omega h) - 2m\\omega q_0 p_0 \\sin(\\omega h)\\cos(\\omega h) + p_0^2\\cos^2(\\omega h)\n$$\n$$\nm^2\\omega^2q_1^2 = m^2\\omega^2(q_0\\cos(\\omega h) + \\frac{p_0}{m\\omega}\\sin(\\omega h))^2 = m^2\\omega^2q_0^2\\cos^2(\\omega h) + 2m\\omega q_0 p_0 \\cos(\\omega h)\\sin(\\omega h) + p_0^2\\sin^2(\\omega h)\n$$\nAdding these two expressions, the cross terms cancel:\n$$\np_1^2+m^2\\omega^2q_1^2 = m^2\\omega^2q_0^2(\\sin^2(\\omega h)+\\cos^2(\\omega h)) + p_0^2(\\cos^2(\\omega h)+\\sin^2(\\omega h))\n$$\n$$\np_1^2+m^2\\omega^2q_1^2 = m^2\\omega^2q_0^2 + p_0^2\n$$\nDividing by $2m$ gives $H(q_1,p_1)=H(q_0,p_0)$, demonstrating exact energy conservation.",
            "answer": "$$\n\\boxed{\\frac{m\\omega}{2\\sin(\\omega h)} \\left[ (q_{0}^{2} + q_{1}^{2})\\cos(\\omega h) - 2q_{0}q_{1} \\right]}\n$$"
        }
    ]
}