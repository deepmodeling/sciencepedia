{
    "hands_on_practices": [
        {
            "introduction": "迭代玻尔兹曼反演（IBI）是基于结构的粗粒化方法的核心。为了理解其工作原理，最清晰的起点是考虑其第一次迭代。这个练习  将引导你从一个零相互作用的初始猜测（即理想气体）开始，推导第一个校正后的有效势。这个过程不仅能阐明IBI的更新规则，还能揭示目标结构（由径向分布函数 $g(r)$ 描述）与平均力势（PMF）之间的基本联系。",
            "id": "3810822",
            "problem": "考虑一个处于绝对温度 $T$ 和数密度 $\\rho$ 下的单原子Lennard-Jones流体。对于该流体，原子模拟已为所有满足 $g_{\\mathrm{target}}(r)>0$ 的距离 $r$ 提供了一个径向平均的目标径向分布函数 $g_{\\mathrm{target}}(r)$。您需要对该流体进行基于结构的粗粒化，将其转化为一个单点、对加性模型，该模型具有一个各向同性的有效对势 $u(r)$，并能在相同的 $T$ 和 $\\rho$ 下再现 $g_{\\mathrm{target}}(r)$。\n\n假设粗粒化相互作用是平移不变且对加性的，并考虑体积为 $V$、包含 $N$ 个粒子的正则系综。\n\n从零相互作用的初始猜测 $u_{0}(r)=0$ 开始，您需要执行一步迭代玻尔兹曼反演（IBI），仅使用基于物理的统计力学定义以及当 $u_{0}(r)=0$ 时的试验模拟是理想气体这一事实，来构建一个更新后的势 $u_{1}(r)$。请推导 $u_{1}(r)$ 关于 $k_{\\mathrm{B}}$、$T$ 和 $g_{\\mathrm{target}}(r)$ 的闭式表达式。\n\n将最终答案表示为单个解析表达式。不需要进行数值近似或四舍五入。在答案框内的最终表达式中不要包含物理单位；表达式必须是关于 $k_{\\mathrm{B}}$、$T$ 和 $g_{\\mathrm{target}}(r)$ 的符号形式。",
            "solution": "用户提供了一个问题陈述，在尝试解答之前需要对其进行验证。\n\n### 步骤1：提取已知条件\n- **系统**：单原子Lennard-Jones流体。\n- **状态变量**：绝对温度 $T$ 和数密度 $\\rho$。\n- **目标函数**：对于所有满足 $g_{\\mathrm{target}}(r)>0$ 的距离 $r$，径向平均的目标径向分布函数 $g_{\\mathrm{target}}(r)$。\n- **粗粒化模型**：一个单点、对加性模型，具有各向同性的有效对势 $u(r)$。\n- **目标**：粗粒化模型必须在相同的 $T$ 和 $\\rho$ 下再现 $g_{\\mathrm{target}}(r)$。\n- **假设**：粗粒化相互作用是平移不变且对加性的。\n- **系综**：正则系综（体积为 $V$，包含 $N$ 个粒子）。\n- **方法**：一步迭代玻尔兹曼反演（IBI）。\n- **初始条件**：势的初始猜测为 $u_{0}(r)=0$。\n- **任务**：推导更新后的势 $u_{1}(r)$ 关于 $k_{\\mathrm{B}}$、$T$ 和 $g_{\\mathrm{target}}(r)$ 的闭式表达式。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准对问题陈述进行评估。\n\n- **科学性**：该问题牢固地植根于统计力学和计算化学的原理。迭代玻尔兹曼反演（IBI）是一种标准且广泛使用的基于结构的粗粒化技术。径向分布函数（$g(r)$）、对势（$u(r)$）、理想气体和正则系综等概念是该领域的基础。\n- **适定性**：该问题是适定的。它提供了一个明确的初始条件（$u_{0}(r)=0$）、一个要应用的具体算法（一步IBI）以及一个明确定义的目标（$u_{1}(r)$的闭式表达式）。这种结构导向一个唯一且有意义的解。\n- **客观性**：该问题使用精确、客观和标准的科学术语进行陈述。没有主观或模棱两可的陈述。\n\n该问题没有表现出任何列出的无效性缺陷。它在科学上是合理的、可形式化的、完整的，并且直接关系到基于结构的粗粒化这一特定主题。\n\n### 步骤3：结论与行动\n该问题是**有效的**。将提供解答。\n\n目标是，从初始猜测 $u_{0}(r)=0$ 开始，经过一次迭代玻尔兹曼反演（IBI）方法迭代后，求出有效对势 $u_{1}(r)$。\n\nIBI方法是一个迭代过程，旨在优化对势 $u(r)$ 以再现已知的目标径向分布函数 $g_{\\mathrm{target}}(r)$。该方法的核心是更新规则，它根据第 $i$ 次迭代产生的RDF $g_{i}(r)$ 与目标RDF $g_{\\mathrm{target}}(r)$ 之间的差异来修正势。标准的IBI更新方程为：\n$$u_{i+1}(r) = u_{i}(r) + k_{\\mathrm{B}} T \\ln\\left( \\frac{g_{i}(r)}{g_{\\mathrm{target}}(r)} \\right)$$\n其中 $u_{i+1}(r)$ 是下一次迭代的优化势，$u_{i}(r)$ 是当前势，$g_{i}(r)$ 是使用 $u_{i}(r)$ 进行模拟得到的RDF，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度。此更新是根据一个将平均力势与对势相关联的近似推导出来的。\n\n我们被要求执行此迭代的第一步，这对应于设置 $i=0$。更新方程变为：\n$$u_{1}(r) = u_{0}(r) + k_{\\mathrm{B}} T \\ln\\left( \\frac{g_{0}(r)}{g_{\\mathrm{target}}(r)} \\right)$$\n\n问题给出了势的初始猜测：\n$$u_{0}(r) = 0$$\n\n接下来，我们必须确定 $g_{0}(r)$，即由势 $u_{0}(r)=0$ 控制的系统的径向分布函数。根据定义，一个相互作用势为零的粒子系统是理想气体。在理想气体中，粒子不相互作用，因此它们的位置完全不相关。\n\n径向分布函数 $g(r)$ 的定义是，$\\rho g(r)$ 给出距离任意选定中心粒子为 $r$ 处的平均局域粒子数密度，其中 $\\rho$ 是体数密度。对于理想气体，原点处存在一个粒子不会影响在任何其他位置找到另一个粒子的概率。因此，距离中心粒子任意距离 $r$ 处的局域密度就是体密度 $\\rho$。\n$$\\rho g_{0}(r) = \\rho$$\n这意味着对于理想气体，径向分布函数在所有距离 $r$ 上都为1：\n$$g_{0}(r) = 1$$\n\n现在，我们将 $u_{0}(r)$ 和 $g_{0}(r)$ 的表达式代入 $u_{1}(r)$ 的IBI更新方程中：\n$$u_{1}(r) = 0 + k_{\\mathrm{B}} T \\ln\\left( \\frac{1}{g_{\\mathrm{target}}(r)} \\right)$$\n\n利用对数的性质 $\\ln(1/x) = \\ln(1) - \\ln(x) = -\\ln(x)$，我们简化表达式：\n$$u_{1}(r) = k_{\\mathrm{B}} T \\left( \\ln(1) - \\ln(g_{\\mathrm{target}}(r)) \\right)$$\n$$u_{1}(r) = k_{\\mathrm{B}} T \\left( 0 - \\ln(g_{\\mathrm{target}}(r)) \\right)$$\n$$u_{1}(r) = -k_{\\mathrm{B}} T \\ln(g_{\\mathrm{target}}(r))$$\n\n这个结果是对应于目标RDF的平均力势 $W(r)$，因为 $W(r) = -k_{\\mathrm{B}}T \\ln(g(r))$。因此，从零势开始的IBI第一步等效于用目标系统的平均力势来近似有效对势。问题陈述中指明 $g_{\\mathrm{target}}(r) > 0$，这确保了对数函数有明确定义，且得到的势 $u_1(r)$ 是有限的。在粒子不能重叠的极小距离处，$g_{\\mathrm{target}}(r) \\to 0$，推导出的势 $u_1(r) \\to \\infty$，这正确地表示了强烈的空间位阻排斥。",
            "answer": "$$\\boxed{-k_{\\mathrm{B}} T \\ln(g_{\\mathrm{target}}(r))}$$"
        },
        {
            "introduction": "在掌握了IBI的基本思想后，下一个挑战是将其应用于实际的迭代过程，这通常涉及离散的数值数据。这个练习  模拟了一个真实的IBI更新步骤，你需要利用给定的模拟数据来计算更新后的势能。此外，本练习还将引导你思考一个在实践中常见且重要的问题：当模拟得到的径向分布函数 $g_n(r)$ 在某些区域为零时，应如何处理更新，并从统计力学的角度理解其物理意义。",
            "id": "3843094",
            "problem": "您正在对单组分流体进行粗粒化，以再现预先设定的径向分布函数（RDF）。在成对粗粒化模型中，径向分布函数 $g(r)$ 通过平衡玻尔兹曼关系 $g(r) = \\exp\\!\\big(-\\beta W(r)\\big)$ 与平均力势（PMF）$W(r)$ 相关联（$W(r)$ 可相差一个加性常数），其中 $\\beta = 1/(k_{\\mathrm{B}} T)$ 是逆热能，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度。在通过迭代玻尔兹曼反演（IBI）进行的基于结构的粗粒化中，目标是更新试验对势 $V_n(r)$，使得模拟得到的RDF $g_n(r)$ 与从更高分辨率的参考体系中获得的目标RDF $g_{\\text{target}}(r)$ 相匹配。缩写IBI代表迭代玻尔兹曼反演（Iterative Boltzmann Inversion）。\n\n假设使用约化的Lennard-Jones单位，其中距离以特征长度的倍数度量，能量以特征能量的倍数度量，热能为 $k_{\\mathrm{B}} T = 2.5$。您被给予了在均匀网格的区间中心 $r \\in \\{0.60, 0.70, 0.80, 0.90, 1.00\\}$ 上的离散数据：\n- 在这些区间上的当前对势 $V_n(r)$ 为 $\\{10.0, 2.5, -0.3, 0.1, 0.2\\}$。\n- 当前模拟的RDF $g_n(r)$ 为 $\\{0.00, 0.40, 1.30, 1.10, 0.80\\}$。\n- 目标RDF $g_{\\text{target}}(r)$ 为 $\\{0.02, 0.50, 1.20, 0.95, 0.85\\}$。\n\n从 $g(r)$ 和PMF $W(r)$ 之间的基本关系出发，并基于成对粗粒化势 $V(r)$ 应追踪PMF以实现目标结构的建模假设，推导一个用 $V_n(r)$、$g_n(r)$、$g_{\\text{target}}(r)$ 和 $k_{\\mathrm{B}} T$ 表示的 $V_{n+1}(r)$ 的迭代更新公式。并基于物理推理来证明每一项的符号和形式的合理性。\n\n然后，使用您推导的更新公式，计算当 $k_{\\mathrm{B}} T = 2.5$ 时，$V_{n+1}(r)$ 在 $r = 0.70$ 处的数值。将您的最终数值答案四舍五入到四位有效数字。能量使用上述相同的约化单位表示。\n\n最后，解释如何处理 $g_n(r) = 0$ 的区间（例如，给定数据中 $r = 0.60$ 处），以使更新保持适定性和物理上的合理性。您的解释应基于 $g(r)$ 的统计力学意义。\n\n您的最终答案必须是一个实数，对应于约化能量单位下的 $V_{n+1}(0.70)$，并按要求四舍五入到四位有效数字。在最终的方框答案中不要包含任何单位。",
            "solution": "该问题陈述经评估具有科学依据、适定、客观且自洽。所需计算的所有必要数据均已提供。所涉及的概念，如径向分布函数 $g(r)$、平均力势 $W(r)$、玻尔兹曼反演以及迭代方案，在统计力学和分子模拟领域都是标准且成熟的。对于以约化单位描述的系统，所给出的数值在物理上是合理的。因此，该问题是有效的，下面将构建解决方案。\n\n基于结构的粗粒化的核心是找到一个有效的对势 $V(r)$，该势能够再现目标径向分布函数 $g_{\\text{target}}(r)$。RDF $g(r)$ 与平均力势 (PMF) $W(r)$ 之间的基本统计力学关系由下式给出：\n$$g(r) = \\exp\\left(-\\frac{W(r)}{k_{\\mathrm{B}} T}\\right)$$\n其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度。因此，可以通过反演该关系从RDF中获得PMF：\n$$W(r) = -k_{\\mathrm{B}} T \\ln(g(r))$$\n该表达式的确定可相差一个任意的加性常数，我们可以不失一般性地将其设为零，因为它只移动势能基线。\n\n像迭代玻尔兹曼反演 (IBI) 这类方法的基本假设是，有效对势 $V(r)$ 应该近似于PMF，即 $V(r) \\approx W(r)$。这一假设的动机来自于 Henderson 唯一定理，该定理在特定条件下保证，对于给定的 $g(r)$，产生它的对势 $V(r)$ 是唯一的。然而，PMF $W(r)$ 隐式地包含了多体关联效应，而粗粒化模拟通常是使用纯粹的成对势 $V(r)$ 进行的。因此，直接反演 $V(r) = -k_{\\mathrm{B}} T \\ln(g_{\\text{target}}(r))$ 通常无法再现 $g_{\\text{target}}(r)$，因为使用此 $V(r)$ 进行模拟所得到的PMF将不等于 $V(r)$。\n\nIBI通过迭代方式解决这个问题。在第 $n$ 次迭代中，我们有一个试验势 $V_n(r)$，它产生一个模拟的RDF $g_n(r)$ 和一个相应的PMF $W_n(r) = -k_{\\mathrm{B}} T \\ln(g_n(r))$。目标是获得目标RDF $g_{\\text{target}}(r)$，它对应于一个目标PMF $W_{\\text{target}}(r) = -k_{\\mathrm{B}} T \\ln(g_{\\text{target}}(r))$。\n\nIBI更新提出了对势的一个修正项 $\\Delta V_n(r)$，该修正项基于当前结构与目标结构之间的不匹配。用于下一次迭代的势的更新公式构建如下：\n$$V_{n+1}(r) = V_n(r) + \\Delta V_n(r)$$\n选择修正项是为了补偿PMF的差异。其基本原理是，对势 $V(r)$ 和PMF $W(r)$ 之间的差异源于多体贡献，而这些贡献被假设在迭代之间变化缓慢。因此，我们用目标PMF和当前PMF之间的差异来近似所需的势修正：\n$$\\Delta V_n(r) \\approx W_{\\text{target}}(r) - W_n(r)$$\n代入PMF的表达式：\n$$\\Delta V_n(r) = \\left(-k_{\\mathrm{B}} T \\ln(g_{\\text{target}}(r))\\right) - \\left(-k_{\\mathrm{B}} T \\ln(g_n(r))\\right)$$\n$$\\Delta V_n(r) = k_{\\mathrm{B}} T \\left(\\ln(g_n(r)) - \\ln(g_{\\text{target}}(r))\\right)$$\n利用对数性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$:\n$$\\Delta V_n(r) = k_{\\mathrm{B}} T \\ln\\left(\\frac{g_n(r)}{g_{\\text{target}}(r)}\\right)$$\n因此，势的完整更新规则是：\n$$V_{n+1}(r) = V_n(r) + k_{\\mathrm{B}} T \\ln\\left(\\frac{g_n(r)}{g_{\\text{target}}(r)}\\right)$$\n在实践中，通常会引入一个阻尼因子 $\\alpha \\in (0, 1]$，$V_{n+1}(r) = V_n(r) + \\alpha k_{\\mathrm{B}} T \\ln(g_n(r)/g_{\\text{target}}(r))$，以提高数值稳定性，但本问题暗示 $\\alpha=1$。\n\n此更新规则的物理原因如下：\n1.  如果 $g_n(r) > g_{\\text{target}}(r)$，说明当前RDF在距离 $r$ 处显示出粒子对的过度聚集。这意味着势 $V_n(r)$ 太具吸引力（或排斥力不足）。为了修正这一点，必须增加势（使其更具排斥性）。更新项的参数 $\\frac{g_n(r)}{g_{\\text{target}}(r)} > 1$，使其对数为正，因此 $\\Delta V_n(r) > 0$。这正确地增加了势。\n2.  如果 $g_n(r) < g_{\\text{target}}(r)$，说明当前RDF在距离 $r$ 处显示出粒子对的聚集不足。这意味着 $V_n(r)$ 太具排斥性。必须减小势（使其更具吸引力）。参数 $\\frac{g_n(r)}{g_{\\text{target}}(r)} < 1$，使其对数为负，因此 $\\Delta V_n(r) < 0$。这正确地减小了势。\n3.  如果 $g_n(r) = g_{\\text{target}}(r)$，说明在此距离处的结构是正确的，不需要更新。对数的参数为1，使其对数为0，因此 $\\Delta V_n(r) = 0$。势保持不变，这是期望的行为。\n\n接下来，我们计算 $V_{n+1}(r)$ 在 $r = 0.70$ 处的数值。\n给定数据为：\n- $k_{\\mathrm{B}} T = 2.5$\n- 在 $r = 0.70$ 处：\n  - $V_n(0.70) = 2.5$\n  - $g_n(0.70) = 0.40$\n  - $g_{\\text{target}}(0.70) = 0.50$\n\n使用推导出的更新公式：\n$$V_{n+1}(0.70) = V_n(0.70) + k_{\\mathrm{B}} T \\ln\\left(\\frac{g_n(0.70)}{g_{\\text{target}}(0.70)}\\right)$$\n代入数值：\n$$V_{n+1}(0.70) = 2.5 + 2.5 \\ln\\left(\\frac{0.40}{0.50}\\right)$$\n$$V_{n+1}(0.70) = 2.5 + 2.5 \\ln(0.8)$$\n$0.8$ 的自然对数约等于 $-0.22314355$。\n$$V_{n+1}(0.70) \\approx 2.5 + 2.5 \\times (-0.22314355)$$\n$$V_{n+1}(0.70) \\approx 2.5 - 0.55785888$$\n$$V_{n+1}(0.70) \\approx 1.94214112$$\n四舍五入到四位有效数字得到 $1.942$。\n\n最后，我们讨论 $g_n(r) = 0$ 的特殊情况，如在 $r=0.60$ 处所观察到的。\n$g(r)$ 的统计力学解释是，它与在分离距离 $r$ 处找到一对粒子的概率密度成正比。在有限时长的模拟中，$g_n(r)=0$ 的值意味着在该距离区间内没有观察到粒子对。这通常是由于强排斥势核（即排除体积）或对高能构象的采样不足所致。\n如果我们直接在 $g_n(r) = 0$ 的地方应用IBI更新规则：\n$$V_{n+1}(r) = V_n(r) + k_{\\mathrm{B}} T \\ln\\left(\\frac{0}{g_{\\text{target}}(r)}\\right)$$\n$\\ln(0)$ 项是未定义的，趋近于 $-\\infty$。这将导致数值灾难性的更新，试图将 $V_{n+1}(r) \\to -\\infty$。这是有限采样的产物；一个零计数事件并不意味着一个不可能的事件（零概率），而是一个未被观察到的低概率事件。由此产生的无限吸引力修正是非物理的。\n\n为了处理这种情况，必须对更新规则进行正则化。一个稳健的实现不应在 $g_n(r)=0$ 的区间使用直接公式。一个常见且物理上合理的过程是：\n1.  认识到当 $g_{\\text{target}}(r) > 0$（此处，$g_{\\text{target}}(0.60) = 0.02$）时，$g_n(r)=0$ 表明当前势 $V_n(r)$ 排斥性过强。\n2.  不使用对数公式，而是应用启发式修正。例如，可以对更新进行封顶，或用一个合理的、有限的吸引力修正来代替。一种方法是从 $g_n(r)$ 非零且行为良好的相邻区域对势进行线性外推。\n3.  另一种简单有效的方法是给势施加一个较大但有限的吸引力“踢”。例如，可以设置 $V_{n+1}(r) = V_n(r) - C$，其中 $C$ 是一个量级为几倍 $k_{\\mathrm{B}} T$ 的常数。这降低了势垒，使得该区域在下一次模拟迭代中变得可及，从而可以采样到非零的 $g_{n+1}(r)$，之后便可使用标准的IBI更新。其目标是恰到好处地修正势，以便在下一步中填充该区间，从而避免数值奇点。",
            "answer": "$$\\boxed{1.942}$$"
        },
        {
            "introduction": "通过IBI，我们能够系统地优化势函数以再现目标结构。但这是否足够呢？这个思想实验  旨在挑战一个核心假设：仅匹配结构（即径向分布函数 $g(r)$）是否能保证所有热力学性质的一致性。你将构建一个反例，其中两个系统具有完全相同的 $g(r)$，但压力却不相同，并通过维里方程来量化这种差异。这个问题揭示了基于结构的方法的一个基本局限性，即“可表征性问题”，并强调了在粗粒化建模中同时考虑结构和热力学性质（如压力）的必要性。",
            "id": "3810827",
            "problem": "考虑两种在相同数密度 $\\rho$ 和温度 $T$ 下的均匀、各向同性的三维流体。两种流体均被设计成在该状态点具有相同的径向分布函数 $g(r)$。第一种流体由一个具有各向同性候选对势 $u(r)$ 的对势粗粒化模型表示；第二种流体是一个底层的多体系统，其微观状态权重被一个均匀的、依赖于体积的项所修正，该项在指定的 $(\\rho, T)$ 下不改变对关联，但确实会改变热力学压力。\n\n您将构建一个反例，证明匹配径向分布函数并不能保证压力也匹配，并且您将通过粗粒化对势模型的维里路径来量化压力不匹配的程度。\n\n假设使用约化单位，其中特征长度 $\\sigma$ 和能量 $\\epsilon$ 定义了尺度，压力以 $\\epsilon/\\sigma^3$ 为单位表示。在给定状态下：\n- 共享的径向分布函数为 $g(r) = \\Theta(r - \\sigma)$，其中 $\\Theta(\\cdot)$ 是亥维赛阶跃函数。\n- 候选对势为 $u(r) = -\\epsilon \\exp\\!\\big(-\\frac{(r - \\sigma)^2}{\\lambda^2}\\big)$，其中 $\\lambda = \\frac{1}{2}\\sigma$。\n- 数密度和温度分别为 $\\rho = \\frac{1}{2}\\sigma^{-3}$ 和 $k_{\\mathrm{B}} T = \\epsilon$。\n\n对于底层的多体流体，由于存在一个额外的、均匀的、依赖于体积的能量项（该项在此 $(\\rho, T)$ 下不改变 $g(r)$），在该状态下测得的热力学压力为 $P^{\\star} = 0.55$（使用相同的约化压力单位）。\n\n使用适用于各向同性对势的维里路径，根据给定的 $g(r)$ 和 $u(r)$ 计算粗粒化模型的压力 $P_{\\mathrm{CG}}$，然后评估不匹配量 $\\Delta P \\equiv P^{\\star} - P_{\\mathrm{CG}}$。请以精确的符号形式给出答案，不要进行四舍五入。最终的不匹配量以 $\\epsilon/\\sigma^3$ 为单位表示。",
            "solution": "该问题是有效的，因为它提出了统计力学中一个适定的问题，阐释了基于结构的粗粒化的一个基本局限性——即匹配对结构（径向分布函数 $g(r)$）并不能唯一确定所有的热力学性质，例如压力。所提供的函数和参数对于理论模型而言在物理上是合理的，在数学上是良定义的，从而允许一个严格且唯一的解。\n\n对于通过对势 $u(r)$ 相互作用的均匀、各向同性流体，其压力可以通过维里状态方程计算。对于三维系统，压力 $P$ 由下式给出：\n$$\nP = \\rho k_{\\mathrm{B}} T - \\frac{2\\pi \\rho^2}{3} \\int_0^\\infty r^3 \\frac{du(r)}{dr} g(r) dr\n$$\n此处，$\\rho$ 是数密度，$k_{\\mathrm{B}} T$ 是热能，$g(r)$ 是径向分布函数，$\\frac{du(r)}{dr}$ 是对势的导数。第一项 $\\rho k_{\\mathrm{B}} T$ 是理想气体压力，第二项是来自粒子间作用力的贡献。我们的任务是使用此公式计算粗粒化模型 $P_{\\mathrm{CG}}$ 的压力。\n\n给定的参数为：\n- 数密度：$\\rho = \\frac{1}{2}\\sigma^{-3}$\n- 热能：$k_{\\mathrm{B}} T = \\epsilon$\n- 径向分布函数：$g(r) = \\Theta(r - \\sigma)$，其中 $\\Theta(\\cdot)$ 是亥维赛阶跃函数。此函数在 $r  \\sigma$ 时为 $0$，在 $r \\ge \\sigma$ 时为 $1$。\n- 对势：$u(r) = -\\epsilon \\exp\\left(-\\frac{(r - \\sigma)^2}{\\lambda^2}\\right)$，其中 $\\lambda = \\frac{1}{2}\\sigma$。\n\n首先，我们计算压力的理想气体贡献：\n$$\n\\rho k_{\\mathrm{B}} T = \\left(\\frac{1}{2}\\sigma^{-3}\\right)(\\epsilon) = \\frac{1}{2} \\frac{\\epsilon}{\\sigma^3}\n$$\n\n接下来，我们计算势 $u(r)$ 对 $r$ 的导数：\n$$\n\\frac{du}{dr} = \\frac{d}{dr}\\left[-\\epsilon \\exp\\left(-\\frac{(r - \\sigma)^2}{\\lambda^2}\\right)\\right] = -\\epsilon \\exp\\left(-\\frac{(r - \\sigma)^2}{\\lambda^2}\\right) \\cdot \\left(-\\frac{2(r - \\sigma)}{\\lambda^2}\\right)\n$$\n$$\n\\frac{du}{dr} = \\frac{2\\epsilon(r - \\sigma)}{\\lambda^2} \\exp\\left(-\\frac{(r - \\sigma)^2}{\\lambda^2}\\right)\n$$\n\n现在，我们计算压力方程中的积分项，记为 $I_{virial}$：\n$$\nI_{virial} = \\int_0^\\infty r^3 \\frac{du(r)}{dr} g(r) dr\n$$\n代入 $\\frac{du}{dr}$ 和 $g(r)$ 的表达式：\n$$\nI_{virial} = \\int_0^\\infty r^3 \\left[\\frac{2\\epsilon(r - \\sigma)}{\\lambda^2} \\exp\\left(-\\frac{(r - \\sigma)^2}{\\lambda^2}\\right)\\right] \\Theta(r - \\sigma) dr\n$$\n亥维赛函数 $\\Theta(r - \\sigma)$ 使得被积函数在 $r  \\sigma$ 时为零，因此积分下限变为 $\\sigma$：\n$$\nI_{virial} = \\frac{2\\epsilon}{\\lambda^2} \\int_\\sigma^\\infty r^3 (r - \\sigma) \\exp\\left(-\\frac{(r - \\sigma)^2}{\\lambda^2}\\right) dr\n$$\n为了求解这个积分，我们可以使用分部积分法。令 $f(r) = r^3$ 且 $g'(r) = (r-\\sigma)\\frac{du}{dr}$。一种更直接的方法是在原始维里积分形式上使用分部积分法，并认识到 $\\frac{1}{g(r)}\\frac{du}{dr}$ 与平均力势有关。另一种方法是对整个压力积分项使用分部积分法：\n$$\n\\int_0^\\infty r^3 \\frac{du}{dr} g(r) dr = [r^3 u(r) g(r)]_0^\\infty - \\int_0^\\infty u(r) \\frac{d}{dr}(r^3 g(r)) dr\n$$\n对于 $g(r) = \\Theta(r-\\sigma)$，边界项为 $[r^3 u(r) g(r)]_\\sigma^\\infty = 0 - \\sigma^3 u(\\sigma) g(\\sigma) = -\\sigma^3 u(\\sigma) = -\\sigma^3 (-\\epsilon) = \\epsilon\\sigma^3$。\n导数为 $\\frac{d}{dr}(r^3 \\Theta(r-\\sigma)) = 3r^2\\Theta(r-\\sigma) + r^3\\delta(r-\\sigma)$。$\\delta$函数项导致 $-u(\\sigma)\\sigma^3 = \\epsilon\\sigma^3$，这一点比较微妙。\n我们还是坚持直接计算 $I_{virial}$。这种方法更简单，且在处理分布时不易出错。\n我们进行变量替换：$x = \\frac{r - \\sigma}{\\lambda}$。这得到 $r = \\lambda x + \\sigma$ 和 $dr = \\lambda dx$。积分限从 $[ \\sigma, \\infty )$ 变为 $[ 0, \\infty )$。\n$$\nI_{virial} = \\frac{2\\epsilon}{\\lambda^2} \\int_0^\\infty (\\lambda x + \\sigma)^3 (\\lambda x) \\exp(-x^2) (\\lambda dx)\n= 2\\epsilon \\int_0^\\infty x (\\lambda x + \\sigma)^3 \\exp(-x^2) dx\n$$\n展开三次项：$(\\lambda x + \\sigma)^3 = \\lambda^3 x^3 + 3\\lambda^2\\sigma x^2 + 3\\lambda\\sigma^2 x + \\sigma^3$。\n$$\nI_{virial} = 2\\epsilon \\int_0^\\infty (\\lambda^3 x^4 + 3\\lambda^2\\sigma x^3 + 3\\lambda\\sigma^2 x^2 + \\sigma^3 x) \\exp(-x^2) dx\n$$\n这需要求解形如 $\\int_0^\\infty x^n \\exp(-x^2) dx = \\frac{1}{2}\\Gamma\\left(\\frac{n+1}{2}\\right)$ 的积分，其中 $\\Gamma(z)$ 是伽马函数。\n所需的积分为：\n$J_4 = \\int_0^\\infty x^4 \\exp(-x^2) dx = \\frac{1}{2}\\Gamma(\\frac{5}{2}) = \\frac{1}{2}\\frac{3}{2}\\frac{1}{2}\\Gamma(\\frac{1}{2}) = \\frac{3\\sqrt{\\pi}}{8}$\n$J_3 = \\int_0^\\infty x^3 \\exp(-x^2) dx = \\frac{1}{2}\\Gamma(2) = \\frac{1}{2}$\n$J_2 = \\int_0^\\infty x^2 \\exp(-x^2) dx = \\frac{1}{2}\\Gamma(\\frac{3}{2}) = \\frac{1}{2}\\frac{1}{2}\\Gamma(\\frac{1}{2}) = \\frac{\\sqrt{\\pi}}{4}$\n$J_1 = \\int_0^\\infty x \\exp(-x^2) dx = \\frac{1}{2}\\Gamma(1) = \\frac{1}{2}$\n\n代入这些结果：\n$$\nI_{virial} = 2\\epsilon \\left[ \\lambda^3 \\frac{3\\sqrt{\\pi}}{8} + 3\\lambda^2\\sigma \\frac{1}{2} + 3\\lambda\\sigma^2 \\frac{\\sqrt{\\pi}}{4} + \\sigma^3 \\frac{1}{2} \\right]\n$$\n现在，代入 $\\lambda = \\frac{1}{2}\\sigma$：\n$$\nI_{virial} = 2\\epsilon \\left[ \\left(\\frac{\\sigma^3}{8}\\right) \\frac{3\\sqrt{\\pi}}{8} + 3\\left(\\frac{\\sigma^2}{4}\\right)\\sigma \\frac{1}{2} + 3\\left(\\frac{\\sigma}{2}\\right)\\sigma^2 \\frac{\\sqrt{\\pi}}{4} + \\frac{\\sigma^3}{2} \\right]\n$$\n$$\nI_{virial} = 2\\epsilon\\sigma^3 \\left[ \\frac{3\\sqrt{\\pi}}{64} + \\frac{3}{8} + \\frac{3\\sqrt{\\pi}}{8} + \\frac{1}{2} \\right]\n= 2\\epsilon\\sigma^3 \\left[ \\frac{3\\sqrt{\\pi} + 24\\sqrt{\\pi}}{64} + \\frac{3+4}{8} \\right]\n$$\n$$\nI_{virial} = 2\\epsilon\\sigma^3 \\left[ \\frac{27\\sqrt{\\pi}}{64} + \\frac{7}{8} \\right] = 2\\epsilon\\sigma^3 \\left[ \\frac{27\\sqrt{\\pi} + 56}{64} \\right] = \\epsilon\\sigma^3 \\frac{27\\sqrt{\\pi} + 56}{32}\n$$\n现在我们计算压力 $P_{\\mathrm{CG}}$：\n$$\nP_{\\mathrm{CG}} = \\rho k_{\\mathrm{B}} T - \\frac{2\\pi \\rho^2}{3} I_{virial}\n$$\n代入 $\\rho = \\frac{1}{2}\\sigma^{-3}$ 和 $I_{virial}$ 的表达式：\n$$\nP_{\\mathrm{CG}} = \\frac{1}{2}\\frac{\\epsilon}{\\sigma^3} - \\frac{2\\pi}{3} \\left(\\frac{1}{4}\\sigma^{-6}\\right) \\left(\\epsilon\\sigma^3 \\frac{27\\sqrt{\\pi} + 56}{32}\\right)\n$$\n$$\nP_{\\mathrm{CG}} = \\frac{\\epsilon}{2\\sigma^3} - \\frac{\\pi\\epsilon}{6\\sigma^3} \\frac{27\\sqrt{\\pi} + 56}{32}\n= \\frac{\\epsilon}{\\sigma^3} \\left[ \\frac{1}{2} - \\frac{\\pi(27\\sqrt{\\pi} + 56)}{192} \\right]\n$$\n问题要求压力不匹配量 $\\Delta P = P^{\\star} - P_{\\mathrm{CG}}$。目标压力给定为 $P^{\\star} = 0.55 \\frac{\\epsilon}{\\sigma^3} = \\frac{11}{20} \\frac{\\epsilon}{\\sigma^3}$。\n以 $\\frac{\\epsilon}{\\sigma^3}$ 为单位表示所有压力：\n$$\n\\frac{P_{\\mathrm{CG}}}{\\epsilon/\\sigma^3} = \\frac{1}{2} - \\frac{27\\pi\\sqrt{\\pi} + 56\\pi}{192}\n$$\n$$\n\\frac{\\Delta P}{\\epsilon/\\sigma^3} = \\frac{P^{\\star}}{\\epsilon/\\sigma^3} - \\frac{P_{\\mathrm{CG}}}{\\epsilon/\\sigma^3} = \\frac{11}{20} - \\left(\\frac{1}{2} - \\frac{27\\pi\\sqrt{\\pi} + 56\\pi}{192}\\right)\n$$\n$$\n\\frac{\\Delta P}{\\epsilon/\\sigma^3} = \\frac{11}{20} - \\frac{10}{20} + \\frac{27\\pi\\sqrt{\\pi} + 56\\pi}{192}\n$$\n$$\n\\frac{\\Delta P}{\\epsilon/\\sigma^3} = \\frac{1}{20} + \\frac{27\\pi\\sqrt{\\pi} + 56\\pi}{192}\n$$\n这是在指定约化单位下，压力不匹配量的最终符号表达式。",
            "answer": "$$\n\\boxed{\\frac{1}{20} + \\frac{27\\pi\\sqrt{\\pi} + 56\\pi}{192}}\n$$"
        }
    ]
}