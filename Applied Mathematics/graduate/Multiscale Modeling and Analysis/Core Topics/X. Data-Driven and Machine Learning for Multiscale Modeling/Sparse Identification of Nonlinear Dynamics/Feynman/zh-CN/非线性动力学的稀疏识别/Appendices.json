{
    "hands_on_practices": [
        {
            "introduction": "SINDy 算法的核心在于其通过施加稀疏性，将复杂动态系统提炼为简洁且可解释模型的能力。此练习聚焦于算法的关键步骤——阈值化，即利用稀疏性参数 $\\lambda$ 从初始模型中剔除不重要的项 。通过完成这项练习，您将亲身体验这个参数如何调控模型保真度与复杂度之间的权衡。",
            "id": "1466851",
            "problem": "一位系统生物学家正在使用一种名为稀疏非线性动力学辨识 (Sparse Identification of Nonlinear Dynamics, SINDy) 的数据驱动方法，以发现细胞内蛋白质浓度 $x(t)$ 的控制常微分方程。其目标是找到能够描述所观测到的动力学现象的最简约（最简单）的模型。该生物学家提出了一个候选模型结构，其形式如下：\n$$\n\\frac{dx}{dt} = \\xi_{0} + \\xi_{1}x + \\xi_{2}x^{2}\n$$\n在这里，项 $1$、$x$ 和 $x^{2}$ 构成了候选函数的库，而 $\\xi_{0}$、$\\xi_{1}$ 和 $\\xi_{2}$ 是待确定的系数。\n\n在收集了 $x(t)$ 的时间序列数据并数值估计其导数 $\\frac{dx}{dt}$ 后，执行标准的最小二乘回归，以找到系数向量 $\\Xi = [\\xi_0, \\xi_1, \\xi_2]^T$ 的初始估计。这个初始拟合可能会包含一些不属于真实底层动力学但数值很小的非零系数项，其得到的系数向量如下：\n$$\n\\Xi_{LS} = [0.019, -0.85, 0.042]^T\n$$\nSINDy 算法的核心步骤是强制稀疏性。这是通过应用阈值化过程来实现的：初始向量 $\\Xi_{LS}$ 中的任何系数 $\\xi_i$，如果其绝对值小于选定的稀疏性阈值 $\\lambda$，则被设置为零。这样可以消除不必要的项并简化模型。\n\n给定稀疏性阈值为 $\\lambda = 0.1$，以下哪个微分方程代表了由 SINDy 算法辨识出的最终模型？\n\nA. $\\frac{dx}{dt} = 0.019 - 0.85x + 0.042x^{2}$\n\nB. $\\frac{dx}{dt} = -0.85x$\n\nC. $\\frac{dx}{dt} = 0$\n\nD. $\\frac{dx}{dt} = 0.019 - 0.85x$\n\nE. $\\frac{dx}{dt} = -0.85x + 0.042x^{2}$",
            "solution": "我们从提出的模型开始\n$$\n\\frac{dx}{dt}=\\xi_{0}+\\xi_{1}x+\\xi_{2}x^{2},\n$$\n以及系数的最小二乘估计\n$$\n\\Xi_{LS}=[0.019,\\,-0.85,\\,0.042]^{T}.\n$$\nSINDy 的稀疏性强制步骤应用了阈值为 $\\lambda=0.1$ 的阈值化，将绝对值小于 $\\lambda$ 的任何系数设置为零。形式上，对于每个 $i$：\n$$\n\\tilde{\\xi}_{i}=\\begin{cases}\n\\xi_{i},  |\\xi_{i}|\\geq \\lambda,\\\\\n0,  |\\xi_{i}|  \\lambda.\n\\end{cases}\n$$\n应用此规则：\n$$\n|\\xi_{0}|=|0.019|=0.019  0.1 \\;\\Rightarrow\\; \\tilde{\\xi}_{0}=0,\n$$\n$$\n|\\xi_{1}|=|-0.85|=0.85\\geq 0.1 \\;\\Rightarrow\\; \\tilde{\\xi}_{1}=-0.85,\n$$\n$$\n|\\xi_{2}|=|0.042|=0.042  0.1 \\;\\Rightarrow\\; \\tilde{\\xi}_{2}=0.\n$$\n因此，稀疏化后的模型是\n$$\n\\frac{dx}{dt}=-0.85\\,x,\n$$\n这对应于选项 B。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "当一个稀疏模型被识别出来后，下一个关键步骤是解释其结构并提取有意义的科学见解。此练习  利用 SINDy 分析的输出——一个稀疏系数向量，要求您重建描述物种竞争的控制微分方程。您将接着使用这个发现的模型来计算一个关键的生态学参数，从而展示 SINDy 如何将原始数据与可操作的生物学知识联系起来。",
            "id": "1466807",
            "problem": "一个系统生物学家团队正在研究在受控环境中共同存在的两种微生物物种 X 和 Y 之间的竞争性相互作用。他们收集了这两个物种的种群密度的时间序列数据。为了在不预先假设特定模型的情况下揭示其潜在的动力学，他们采用了非线性动力学的稀疏辨识 (SINDy) 方法。\n\nSINDy 算法旨在从数据中找到动力学系统的稀疏表示。对于以 $x(t)$ 表示的物种 X 的种群动力学，目标是找到一个函数 $f(x, y)$，使得 $\\frac{dx}{dt} = f(x, y)$。SINDy 假设 $f(x, y)$ 可以表示为一个大型候选函数库中少数几个函数的线性组合。\n\n研究人员使用以下候选函数库，表示为行向量 $\\mathbf{\\Theta}(x, y)$：\n$$\n\\mathbf{\\Theta}(x, y) = \\begin{pmatrix} 1  x  y  x^2  y^2  xy \\end{pmatrix}\n$$\n则该动力学模型为 $\\frac{dx}{dt} = \\mathbf{\\Theta}(x, y) \\cdot \\mathbf{C}^T$，其中 $\\mathbf{C}$ 是一个稀疏的系数行向量。在处理实验数据后，SINDy 算法返回了以下用于描述物种 X 动力学的系数向量：\n$$\n\\mathbf{C} = \\begin{pmatrix} 0  0.80  0  -0.0125  0  -0.030 \\end{pmatrix}\n$$\n种群密度 $x$ 和 $y$ 的测量单位是百万细胞/毫升。\n\n根据 SINDy 算法发现的 $\\frac{dx}{dt}$ 模型，确定物种 X 在单种培养（即完全没有物种 Y 的情况下）中的环境承载量。请以百万细胞/毫升为单位，将答案四舍五入到两位有效数字。",
            "solution": "题目要求根据使用非线性动力学的稀疏辨识 (SINDy) 方法发现的动力学模型，计算物种 X 在单种培养中的环境承载量。\n\n首先，我们必须使用提供的候选库 $\\mathbf{\\Theta}(x, y)$ 和得到的系数向量 $\\mathbf{C}$，来重建描述物种 X 种群动力学的微分方程 $\\frac{dx}{dt}$。\n\n该模型由点积 $\\frac{dx}{dt} = \\mathbf{\\Theta}(x, y) \\cdot \\mathbf{C}^T$ 给出。\n候选库是 $\\mathbf{\\Theta}(x, y) = \\begin{pmatrix} 1  x  y  x^2  y^2  xy \\end{pmatrix}$。\n系数向量是 $\\mathbf{C} = \\begin{pmatrix} c_1  c_2  c_3  c_4  c_5  c_6 \\end{pmatrix} = \\begin{pmatrix} 0  0.80  0  -0.0125  0  -0.030 \\end{pmatrix}$。\n\n我们来写出 $\\frac{dx}{dt}$ 的完整表达式：\n$$\n\\frac{dx}{dt} = c_1 \\cdot 1 + c_2 \\cdot x + c_3 \\cdot y + c_4 \\cdot x^2 + c_5 \\cdot y^2 + c_6 \\cdot xy\n$$\n代入 $\\mathbf{C}$ 中的系数值：\n$$\n\\frac{dx}{dt} = (0) \\cdot 1 + (0.80) \\cdot x + (0) \\cdot y + (-0.0125) \\cdot x^2 + (0) \\cdot y^2 + (-0.030) \\cdot xy\n$$\n简化此表达式，我们得到在物种 Y 存在下，物种 X 的主导微分方程：\n$$\n\\frac{dx}{dt} = 0.80x - 0.0125x^2 - 0.030xy\n$$\n接下来，我们需要计算物种 X 在单种培养中的环境承载量。单种培养意味着物种 Y 不存在，因此其种群密度为 $y=0$。我们可以通过将 $y=0$ 代入我们刚刚推导出的方程中来找到单种培养的动力学。\n$$\n\\frac{dx}{dt} = 0.80x - 0.0125x^2 - 0.030x(0)\n$$\n$$\n\\frac{dx}{dt} = 0.80x - 0.0125x^2\n$$\n这个方程是逻辑斯谛增长模型的一种形式。一般的逻辑斯谛方程通常写为：\n$$\n\\frac{dx}{dt} = r x \\left(1 - \\frac{x}{K}\\right)\n$$\n其中 $r$ 是内禀增长率，$K$ 是环境承载量。为了找到 $K$，我们可以重新整理我们推导出的方程，使其与标准逻辑斯谛方程的结构相匹配。\n首先，让我们从方程右侧提出因子 $0.80x$：\n$$\n\\frac{dx}{dt} = 0.80x \\left(1 - \\frac{0.0125x}{0.80}\\right)\n$$\n$$\n\\frac{dx}{dt} = 0.80x \\left(1 - \\frac{x}{0.80 / 0.0125}\\right)\n$$\n通过将其与标准形式 $\\frac{dx}{dt} = r x \\left(1 - \\frac{x}{K}\\right)$进行比较，我们可以确定内禀增长率为 $r=0.80$，环境承载量 $K$ 为：\n$$\nK = \\frac{0.80}{0.0125}\n$$\n现在，我们计算 $K$ 的值：\n$$\nK = \\frac{8000}{125} = \\frac{1600}{25} = 64\n$$\n题目说明种群密度以百万细胞/毫升为单位，答案也应以相同单位表示，并四舍五入到两位有效数字。计算出的值为 64，这已经有两位有效数字。\n因此，物种 X 在单种培养中的环境承载量是 64 百万细胞/毫升。",
            "answer": "$$\\boxed{64}$$"
        },
        {
            "introduction": "通过将先验科学知识融入发现过程，可以显著增强 SINDy 的能力。这个高级问题  介绍了一种约束 SINDy 框架，其中已知的结构信息（例如代谢网络的化学计量关系）被强制执行。本练习将指导您在固定的网络结构内识别未知的反应动力学，展示如何将数据驱动方法与既有领域知识相结合，以构建更稳健且符合物理现实的模型。",
            "id": "1466844",
            "problem": "一个描述两种相互作用的蛋白质 A 和 B 浓度动态的简化模型由一个代谢网络来描述。A 和 B 的浓度分别用 $c_1(t)$ 和 $c_2(t)$ 表示。浓度向量 $\\mathbf{c}(t) = [c_1(t), c_2(t)]^T$ 的时间演化由方程 $\\dot{\\mathbf{c}} = S \\mathbf{v}(\\mathbf{c})$ 控制，其中 $S$ 是化学计量矩阵，$\\mathbf{v}(\\mathbf{c}) = [v_1(\\mathbf{c}), v_2(\\mathbf{c}), v_3(\\mathbf{c})]^T$ 是反应速率法则（通量）向量。\n\n该网络包含三个反应：\n1.  从一个源合成蛋白质 A。($ \\emptyset \\xrightarrow{v_1} A $)\n2.  蛋白质 A 转化为蛋白质 B。($ A \\xrightarrow{v_2} B $)\n3.  蛋白质 B 的降解。($ B \\xrightarrow{v_3} \\emptyset $)\n\n相应的化学计量矩阵 $S$ 由下式给出：\n$$S = \\begin{pmatrix} 1  -1  0 \\\\ 0  1  -1 \\end{pmatrix}$$\n\n你的任务是使用一种基于非线性动力学稀疏辨识（SINDy）的约束方法来发现未知速率法则 $v_1, v_2, v_3$ 的函数形式。我们假设每个速率法则 $v_j(\\mathbf{c})$ 可以表示为一个候选函数库中函数的稀疏线性组合。所选择的候选函数库是 $\\Phi(\\mathbf{c}) = [1, c_1, c_2]$。因此，每个速率法则可以写成 $v_j(\\mathbf{c}) = \\Phi(\\mathbf{c}) \\mathbf{p}_j$，其中 $\\mathbf{p}_j$ 是一个系数列向量。这些系数向量的集合构成了系数矩阵 $P = [\\mathbf{p}_1, \\mathbf{p}_2, \\mathbf{p}_3]$ 的列。\n\n提供了由三次浓度及其时间导数的测量组成的实验数据：\n\n| 测量        | $c_1$ | $c_2$ | $\\dot{c}_1$ | $\\dot{c}_2$ |\n| :---------- | :---- | :---- | :---------- | :---------- |\n| 1           | 1.0   | 1.0   | 3.0         | -1.5        |\n| 2           | 2.0   | 1.0   | 1.0         | 0.5         |\n| 3           | 1.0   | 2.0   | 3.0         | -5.0        |\n\n一个关键的先验生物学知识施加了一个强结构约束：**已知每个速率法则 $v_j$ 都恰好由候选库 $\\Phi(\\mathbf{c})$ 中的一项决定**。这意味着每个系数向量 $\\mathbf{p}_j$ 恰好包含一个非零元素。\n\n使用所提供的数据和这个结构约束，确定 $3 \\times 3$ 系数矩阵 $P$。",
            "solution": "我们被给予紧凑形式的质量作用平衡方程 $\\dot{\\mathbf{c}}=S\\mathbf{v}(\\mathbf{c})$，其中：\n$$\nS=\\begin{pmatrix}1  -1  0\\\\ 0  1  -1\\end{pmatrix},\n\\quad\n\\mathbf{v}(\\mathbf{c})=\n\\begin{pmatrix}\nv_{1}(\\mathbf{c})\\\\\nv_{2}(\\mathbf{c})\\\\\nv_{3}(\\mathbf{c})\n\\end{pmatrix},\n\\quad\nv_{j}(\\mathbf{c})=\\Phi(\\mathbf{c})\\mathbf{p}_{j},\n\\quad\n\\Phi(\\mathbf{c})=[1,\\;c_{1},\\;c_{2}],\n$$\n以及每个 $\\mathbf{p}_{j}$ 恰好有一个非零项的结构约束。记系数矩阵 $P$ 为：\n$$\nP=\\begin{pmatrix}\np_{11}  p_{12}  p_{13}\\\\\np_{21}  p_{22}  p_{23}\\\\\np_{31}  p_{32}  p_{33}\n\\end{pmatrix},\n$$\n我们对于任意测量值 $(c_{1},c_{2})$ 有：\n$$\nv_{1}=p_{11}+p_{21}c_{1}+p_{31}c_{2},\\quad\nv_{2}=p_{12}+p_{22}c_{1}+p_{32}c_{2},\\quad\nv_{3}=p_{13}+p_{23}c_{1}+p_{33}c_{2}.\n$$\n从 $\\dot{c}_{1}=v_{1}-v_{2}$ 和 $\\dot{c}_{2}=v_{2}-v_{3}$ 可得：\n$$\n\\dot{c}_{1}=(p_{11}-p_{12})+(p_{21}-p_{22})c_{1}+(p_{31}-p_{32})c_{2},\n$$\n$$\n\\dot{c}_{2}=(p_{12}-p_{13})+(p_{22}-p_{23})c_{1}+(p_{32}-p_{33})c_{2}.\n$$\n使用三个测量值 $(c_{1},c_{2},\\dot{c}_{1},\\dot{c}_{2})\\in\\{(1, 1, 3, -1.5), (2, 1, 1, 0.5), (1, 2, 3, -5)\\}$，我们建立两组线性方程。\n对于 $\\dot{c}_{1}$ 的方程组：\n$$\n\\begin{cases}\n(p_{11}-p_{12}) + (p_{21}-p_{22})(1) + (p_{31}-p_{32})(1) = 3 \\\\\n(p_{11}-p_{12}) + (p_{21}-p_{22})(2) + (p_{31}-p_{32})(1) = 1 \\\\\n(p_{11}-p_{12}) + (p_{21}-p_{22})(1) + (p_{31}-p_{32})(2) = 3\n\\end{cases}\n$$\n对于 $\\dot{c}_{2}$ 的方程组：\n$$\n\\begin{cases}\n(p_{12}-p_{13}) + (p_{22}-p_{23})(1) + (p_{32}-p_{33})(1) = -1.5 \\\\\n(p_{12}-p_{13}) + (p_{22}-p_{23})(2) + (p_{32}-p_{33})(1) = 0.5 \\\\\n(p_{12}-p_{13}) + (p_{22}-p_{23})(1) + (p_{32}-p_{33})(2) = -5\n\\end{cases}\n$$\n求解第一组方程，我们得到： $p_{11}-p_{12}=5$, $p_{21}-p_{22}=-2$, $p_{31}-p_{32}=0$。\n求解第二组方程，我们得到： $p_{12}-p_{13}=0$, $p_{22}-p_{23}=2$, $p_{32}-p_{33}=-3.5$ (即 $-\\frac{7}{2}$)。\n\n现在我们强制执行结构约束：$P$ 的每一列（即每个 $\\mathbf{p}_j$）只有一个非零元。\n\n从 $p_{21}-p_{22}=-2$ 和约束条件出发，存在两种可能性：\n1.  如果 $p_{21}\\neq 0$ 且 $p_{22}=0$：那么 $p_{21}=-2$。因为 $\\mathbf{p}_1$ 只有一个非零元，所以 $p_{11}=0, p_{31}=0$。从 $p_{11}-p_{12}=5$ 得到 $p_{12}=-5$。因为 $\\mathbf{p}_2$ 只有一个非零元，所以 $p_{22}=0, p_{32}=0$（与假设一致）。从 $p_{12}-p_{13}=0$ 得到 $p_{13}=-5$。从 $p_{22}-p_{23}=2$ 得到 $p_{23}=-2$。此时 $\\mathbf{p}_3$ 中至少有两个非零元（$p_{13}, p_{23}$），与约束矛盾。因此该分支无效。\n2.  如果 $p_{21}=0$ 且 $p_{22}\\neq 0$：那么 $p_{22}=2$。因为 $\\mathbf{p}_2$ 只有一个非零元，所以 $p_{12}=0, p_{32}=0$。\n\n现在我们使用 $p_{21}=0, p_{12}=0, p_{22}=2, p_{32}=0$ 来确定所有其他系数：\n- 从 $p_{11}-p_{12}=5$ 得到 $p_{11}=5$。\n- 从 $p_{21}-p_{22}=-2$ 得到 $0-2=-2$（一致）。\n- 从 $p_{31}-p_{32}=0$ 得到 $p_{31}=0$。\n- 从 $p_{12}-p_{13}=0$ 得到 $p_{13}=0$。\n- 从 $p_{22}-p_{23}=2$ 得到 $2-p_{23}=2$，所以 $p_{23}=0$。\n- 从 $p_{32}-p_{33}=-3.5$ 得到 $0-p_{33}=-3.5$，所以 $p_{33}=3.5$。\n\n我们检查约束条件：\n- $\\mathbf{p}_1$: $[5, 0, 0]^T$ (一个非零元，OK)\n- $\\mathbf{p}_2$: $[0, 2, 0]^T$ (一个非零元，OK)\n- $\\mathbf{p}_3$: $[0, 0, 3.5]^T$ (一个非零元，OK)\n\n因此，系数矩阵 $P$ 是：\n$$\nP=\\begin{pmatrix}\n5  0  0\\\\\n0  2  0\\\\\n0  0  3.5\n\\end{pmatrix}\n$$\n这对应于速率法则 $v_{1}(\\mathbf{c})=5$，$v_{2}(\\mathbf{c})=2c_{1}$，$v_{3}(\\mathbf{c})=3.5c_{2}$，每个法则都恰好使用 $\\Phi(\\mathbf{c})$ 中的一项，并且该模型拟合了所有测量数据。",
            "answer": "$$\\boxed{\\begin{pmatrix} 5  0  0 \\\\ 0  2  0 \\\\ 0  0  3.5 \\end{pmatrix}}$$"
        }
    ]
}