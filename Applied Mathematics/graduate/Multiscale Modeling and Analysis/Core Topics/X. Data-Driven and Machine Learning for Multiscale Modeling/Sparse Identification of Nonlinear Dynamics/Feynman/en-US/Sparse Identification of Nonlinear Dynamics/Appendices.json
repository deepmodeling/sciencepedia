{
    "hands_on_practices": [
        {
            "introduction": "The power of the SINDy algorithm lies not just in its ability to fit data, but in its capacity to discover the simplest model that describes a system's dynamics. This first exercise isolates the most critical step in this process: the application of a sparsity threshold . By starting with an initial set of coefficients from a least-squares fit, you will practice applying this threshold to eliminate insignificant terms and reveal a parsimonious governing equation.",
            "id": "1466851",
            "problem": "A systems biologist is using a data-driven approach called Sparse Identification of Nonlinear Dynamics (SINDy) to discover the governing ordinary differential equation for the concentration of a protein, $x(t)$, within a cell. The goal is to find the most parsimonious (simplest) model that describes the observed dynamics. The biologist proposes a candidate model structure of the form:\n$$\n\\frac{dx}{dt} = \\xi_{0} + \\xi_{1}x + \\xi_{2}x^{2}\n$$\nHere, the terms $1$, $x$, and $x^{2}$ form the library of candidate functions, and $\\xi_{0}$, $\\xi_{1}$, and $\\xi_{2}$ are the coefficients to be determined.\n\nAfter collecting time-series data for $x(t)$ and numerically estimating its derivative $\\frac{dx}{dt}$, a standard least-squares regression is performed to find an initial estimate for the coefficient vector $\\Xi = [\\xi_0, \\xi_1, \\xi_2]^T$. This initial fit, which may include small, non-zero coefficients for terms that are not part of the true underlying dynamics, yields the following coefficient vector:\n$$\n\\Xi_{LS} = [0.019, -0.85, 0.042]^T\n$$\nThe core step of the SINDy algorithm is to enforce sparsity. This is achieved by applying a thresholding procedure: any coefficient $\\xi_i$ in the initial vector $\\Xi_{LS}$ whose absolute value is less than a chosen sparsity threshold, $\\lambda$, is set to zero. This eliminates unnecessary terms and simplifies the model.\n\nGiven a sparsity threshold of $\\lambda = 0.1$, which of the following differential equations represents the final model identified by the SINDy algorithm?\n\nA. $\\frac{dx}{dt} = 0.019 - 0.85x + 0.042x^{2}$\n\nB. $\\frac{dx}{dt} = -0.85x$\n\nC. $\\frac{dx}{dt} = 0$\n\nD. $\\frac{dx}{dt} = 0.019 - 0.85x$\n\nE. $\\frac{dx}{dt} = -0.85x + 0.042x^{2}$",
            "solution": "We begin with the proposed model\n$$\n\\frac{dx}{dt}=\\xi_{0}+\\xi_{1}x+\\xi_{2}x^{2},\n$$\nand the least-squares estimate of the coefficients\n$$\n\\Xi_{LS}=[0.019,\\,-0.85,\\,0.042]^{T}.\n$$\nThe SINDy sparsity-enforcement step applies thresholding with threshold $\\lambda=0.1$, setting any coefficient with absolute value less than $\\lambda$ to zero. Formally, for each $i$,\n$$\n\\tilde{\\xi}_{i}=\\begin{cases}\n\\xi_{i}, & |\\xi_{i}|\\geq \\lambda,\\\\\n0, & |\\xi_{i}|<\\lambda.\n\\end{cases}\n$$\nApplying this rule:\n$$\n|\\xi_{0}|=|0.019|=0.019<0.1 \\;\\Rightarrow\\; \\tilde{\\xi}_{0}=0,\n$$\n$$\n|\\xi_{1}|=|-0.85|=0.85\\geq 0.1 \\;\\Rightarrow\\; \\tilde{\\xi}_{1}=-0.85,\n$$\n$$\n|\\xi_{2}|=|0.042|=0.042<0.1 \\;\\Rightarrow\\; \\tilde{\\xi}_{2}=0.\n$$\nTherefore, the sparsified model is\n$$\n\\frac{dx}{dt}=-0.85\\,x,\n$$\nwhich corresponds to option B.",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "After identifying a sparse model, the next crucial skill is to interpret its structure and extract meaningful scientific insights. This practice problem puts you in the role of a systems biologist who has just used SINDy to analyze microbial competition . Your task is to translate the algorithm's sparse output back into a differential equation and use it to predict a fundamental ecological propertyâ€”the carrying capacity of one species in the absence of its competitor.",
            "id": "1466807",
            "problem": "A team of systems biologists is investigating the competitive interactions between two microbial species, X and Y, co-existing in a controlled environment. They have collected time-series data of the population densities for both species. To uncover the underlying dynamics without assuming a specific model *a priori*, they employ the Sparse Identification of Nonlinear Dynamics (SINDy) method.\n\nThe SINDy algorithm aims to find a sparse representation of a dynamical system from data. For the population dynamics of species X, denoted by $x(t)$, the goal is to find a function $f(x, y)$ such that $\\frac{dx}{dt} = f(x, y)$. SINDy assumes that $f(x, y)$ can be expressed as a linear combination of a few functions from a large candidate library.\n\nThe researchers use the following candidate function library, represented as a row vector $\\mathbf{\\Theta}(x, y)$:\n$$\n\\mathbf{\\Theta}(x, y) = \\begin{pmatrix} 1 & x & y & x^2 & y^2 & xy \\end{pmatrix}\n$$\nThe model for the dynamics is then $\\frac{dx}{dt} = \\mathbf{\\Theta}(x, y) \\cdot \\mathbf{C}^T$, where $\\mathbf{C}$ is a sparse row vector of coefficients. After processing the experimental data, the SINDy algorithm returned the following coefficient vector for the dynamics of species X:\n$$\n\\mathbf{C} = \\begin{pmatrix} 0 & 0.80 & 0 & -0.0125 & 0 & -0.030 \\end{pmatrix}\n$$\nThe population densities $x$ and $y$ are measured in units of millions of cells per milliliter.\n\nBased on the model for $\\frac{dx}{dt}$ discovered by the SINDy algorithm, determine the carrying capacity of species X if it were grown in a monoculture (i.e., in the complete absence of species Y). Express your answer in millions of cells per milliliter, rounded to two significant figures.",
            "solution": "The problem asks for the carrying capacity of species X in a monoculture, based on a dynamical model discovered using the Sparse Identification of Nonlinear Dynamics (SINDy) method.\n\nFirst, we must reconstruct the differential equation for the population dynamics of species X, $\\frac{dx}{dt}$, using the provided candidate library $\\mathbf{\\Theta}(x, y)$ and the resulting coefficient vector $\\mathbf{C}$.\n\nThe model is given by the dot product $\\frac{dx}{dt} = \\mathbf{\\Theta}(x, y) \\cdot \\mathbf{C}^T$.\nThe candidate library is $\\mathbf{\\Theta}(x, y) = \\begin{pmatrix} 1 & x & y & x^2 & y^2 & xy \\end{pmatrix}$.\nThe coefficient vector is $\\mathbf{C} = \\begin{pmatrix} c_1 & c_2 & c_3 & c_4 & c_5 & c_6 \\end{pmatrix} = \\begin{pmatrix} 0 & 0.80 & 0 & -0.0125 & 0 & -0.030 \\end{pmatrix}$.\n\nLet's write out the full expression for $\\frac{dx}{dt}$:\n$$\n\\frac{dx}{dt} = c_1 \\cdot 1 + c_2 \\cdot x + c_3 \\cdot y + c_4 \\cdot x^2 + c_5 \\cdot y^2 + c_6 \\cdot xy\n$$\nSubstituting the numerical values of the coefficients from $\\mathbf{C}$:\n$$\n\\frac{dx}{dt} = (0) \\cdot 1 + (0.80) \\cdot x + (0) \\cdot y + (-0.0125) \\cdot x^2 + (0) \\cdot y^2 + (-0.030) \\cdot xy\n$$\nSimplifying this expression, we get the governing differential equation for species X in the presence of species Y:\n$$\n\\frac{dx}{dt} = 0.80x - 0.0125x^2 - 0.030xy\n$$\nNext, we need to find the carrying capacity of species X in a monoculture. A monoculture implies that species Y is absent, so its population density is $y=0$. We can find the dynamics of the monoculture by substituting $y=0$ into the equation we just derived.\n$$\n\\frac{dx}{dt} = 0.80x - 0.0125x^2 - 0.030x(0)\n$$\n$$\n\\frac{dx}{dt} = 0.80x - 0.0125x^2\n$$\nThis equation is a form of the logistic growth model. The general logistic equation is typically written as:\n$$\n\\frac{dx}{dt} = r x \\left(1 - \\frac{x}{K}\\right)\n$$\nwhere $r$ is the intrinsic growth rate and $K$ is the carrying capacity. To find $K$, we can rearrange our derived equation to match the structure of the standard logistic equation.\nFirst, let's factor out $0.80x$ from the right-hand side of our equation:\n$$\n\\frac{dx}{dt} = 0.80x \\left(1 - \\frac{0.0125x}{0.80}\\right)\n$$\n$$\n\\frac{dx}{dt} = 0.80x \\left(1 - \\frac{x}{0.80 / 0.0125}\\right)\n$$\nBy comparing this to the standard form $\\frac{dx}{dt} = r x \\left(1 - \\frac{x}{K}\\right)$, we can identify the intrinsic growth rate as $r=0.80$ and the carrying capacity $K$ as:\n$$\nK = \\frac{0.80}{0.0125}\n$$\nNow, we calculate the value of $K$:\n$$\nK = \\frac{8000}{125} = \\frac{1600}{25} = 64\n$$\nThe problem states that the population densities are measured in millions of cells per milliliter, and the answer should be expressed in the same units, rounded to two significant figures. The calculated value is 64, which already has two significant figures.\nTherefore, the carrying capacity of species X in a monoculture is 64 million cells per milliliter.",
            "answer": "$$\\boxed{64}$$"
        },
        {
            "introduction": "Real-world systems often come with known physical laws or structural constraints, such as conservation of mass. This final challenge moves beyond standard SINDy to an advanced application where prior knowledge is integrated directly into the discovery process . You will work with a metabolic network where the connections (stoichiometry) are known but the reaction rate laws are not, using a constrained approach to uncover the precise functional forms of the underlying kinetics.",
            "id": "1466844",
            "problem": "A simplified model for the concentration dynamics of two interacting proteins, A and B, is described by a metabolic network. The concentrations of A and B are denoted by $c_1(t)$ and $c_2(t)$, respectively. The time evolution of the concentration vector $\\mathbf{c}(t) = [c_1(t), c_2(t)]^T$ is governed by the equation $\\dot{\\mathbf{c}} = S \\mathbf{v}(\\mathbf{c})$, where $S$ is the stoichiometric matrix and $\\mathbf{v}(\\mathbf{c}) = [v_1(\\mathbf{c}), v_2(\\mathbf{c}), v_3(\\mathbf{c})]^T$ is the vector of reaction rate laws (fluxes).\n\nThe network consists of three reactions:\n1.  Synthesis of protein A from a source. ($ \\emptyset \\xrightarrow{v_1} A $)\n2.  Conversion of protein A into protein B. ($ A \\xrightarrow{v_2} B $)\n3.  Degradation of protein B. ($ B \\xrightarrow{v_3} \\emptyset $)\n\nThe corresponding stoichiometric matrix $S$ is given by:\n$$S = \\begin{pmatrix} 1 & -1 & 0 \\\\ 0 & 1 & -1 \\end{pmatrix}$$\n\nYour task is to discover the functional forms of the unknown rate laws $v_1, v_2, v_3$ using a constrained approach based on Sparse Identification of Nonlinear Dynamics (SINDy). We assume that each rate law $v_j(\\mathbf{c})$ can be expressed as a sparse linear combination of candidate functions from a library. The chosen library of candidate functions is $\\Phi(\\mathbf{c}) = [1, c_1, c_2]$. Therefore, each rate law can be written as $v_j(\\mathbf{c}) = \\Phi(\\mathbf{c}) \\mathbf{p}_j$, where $\\mathbf{p}_j$ is a column vector of coefficients. The collection of these coefficient vectors forms the columns of a coefficient matrix $P = [\\mathbf{p}_1, \\mathbf{p}_2, \\mathbf{p}_3]$.\n\nYou are provided with experimental data consisting of three measurements of the concentrations and their time derivatives:\n\n| Measurement | $c_1$ | $c_2$ | $\\dot{c}_1$ | $\\dot{c}_2$ |\n| :---------- | :---- | :---- | :---------- | :---------- |\n| 1           | 1.0   | 1.0   | 3.0         | -1.5        |\n| 2           | 2.0   | 1.0   | 1.0         | 0.5         |\n| 3           | 1.0   | 2.0   | 3.0         | -5.0        |\n\nA key piece of prior biological knowledge imposes a strong structural constraint: **each rate law $v_j$ is known to be governed by exactly one term from the candidate library $\\Phi(\\mathbf{c})$**. This means each coefficient vector $\\mathbf{p}_j$ contains exactly one non-zero element.\n\nUsing the provided data and this structural constraint, determine the $3 \\times 3$ coefficient matrix $P$.",
            "solution": "We are given the mass-action balance in compact form as $\\dot{\\mathbf{c}}=S\\mathbf{v}(\\mathbf{c})$ with\n$$\nS = \\begin{pmatrix} 1 & -1 & 0 \\\\ 0 & 1 & -1 \\end{pmatrix},\n\\quad\n\\mathbf{v}(\\mathbf{c})=\n\\begin{pmatrix}\nv_{1}(\\mathbf{c})\\\\\nv_{2}(\\mathbf{c})\\\\\nv_{3}(\\mathbf{c})\n\\end{pmatrix},\n\\quad\nv_{j}(\\mathbf{c})=\\Phi(\\mathbf{c})\\mathbf{p}_{j},\n\\quad\n\\Phi(\\mathbf{c})=[1,\\;c_{1},\\;c_{2}],\n$$\nand the structural constraint that each $\\mathbf{p}_{j}$ has exactly one nonzero entry. Writing\n$$\nP=\\begin{pmatrix}\np_{11}&p_{12}&p_{13}\\\\\np_{21}&p_{22}&p_{23}\\\\\np_{31}&p_{32}&p_{33}\n\\end{pmatrix},\n$$\nwe have for any measurement $(c_{1},c_{2})$:\n$$\nv_{1}=p_{11}+p_{21}c_{1}+p_{31}c_{2},\\quad\nv_{2}=p_{12}+p_{22}c_{1}+p_{32}c_{2},\\quad\nv_{3}=p_{13}+p_{23}c_{1}+p_{33}c_{2}.\n$$\nFrom $\\dot{c}_{1}=v_{1}-v_{2}$ and $\\dot{c}_{2}=v_{2}-v_{3}$ it follows that\n$$\n\\dot{c}_{1}=(p_{11}-p_{12})+(p_{21}-p_{22})c_{1}+(p_{31}-p_{32})c_{2},\n$$\n$$\n\\dot{c}_{2}=(p_{12}-p_{13})+(p_{22}-p_{23})c_{1}+(p_{32}-p_{33})c_{2}.\n$$\nUsing the three measurements\n$(c_{1},c_{2},\\dot{c}_{1},\\dot{c}_{2})\\in\\{(1,1,3,-\\tfrac{3}{2}),(2,1,1,\\tfrac{1}{2}),(1,2,3,-5)\\}$,\ndefine $x=p_{11}-p_{12}$, $y=p_{21}-p_{22}$, $z=p_{31}-p_{32}$, and $u=p_{12}-p_{13}$, $v=p_{22}-p_{23}$, $w=p_{32}-p_{33}$. The six equations become\n$$\n\\begin{aligned}\nx+y+z&=3,\\\\\nx+2y+z&=1,\\\\\nx+y+2z&=3,\n\\end{aligned}\n\\qquad\n\\begin{aligned}\nu+v+w&=-\\tfrac{3}{2},\\\\\nu+2v+w&=\\tfrac{1}{2},\\\\\nu+v+2w&=-5.\n\\end{aligned}\n$$\nSubtracting the first two equations on the left gives $y=-2$, subtracting the first and third gives $z=0$, and then $x=5$. On the right, subtracting the first two gives $v=2$, subtracting the first and third gives $w=-\\tfrac{7}{2}$, and then $u=0$. Thus\n$$\np_{11}-p_{12}=5, \\quad p_{21}-p_{22}=-2, \\quad p_{31}-p_{32}=0,\n$$\n$$\np_{12}-p_{13}=0, \\quad p_{22}-p_{23}=2, \\quad p_{32}-p_{33}=-\\tfrac{7}{2}.\n$$\nNow enforce the structural constraint: exactly one nonzero per column.\n\nFrom $p_{21}-p_{22}=-2$ and the one-nonzero-per-column constraint, there are two possibilities:\n- If $p_{21}\\neq 0$ and $p_{22}=0$, then $p_{21}=-2$. With $p_{11}-p_{12}=5$ and column 1 having $p_{11}=0$, we get $p_{12}=-5$, hence $p_{13}=-5$ from $p_{12}-p_{13}=0$, and from $p_{22}-p_{23}=2$ with $p_{22}=0$ we get $p_{23}=-2$. This makes column 3 have two nonzeros ($p_{13}$ and $p_{23}$), contradicting the constraint. Therefore this branch is invalid.\n- Hence $p_{21}=0$ and $p_{22}=2$.\n\nWith $p_{22}=2$, the constraint on column 2 forces $p_{12}=0$ and $p_{32}=0$. Then $p_{11}-p_{12}=5$ gives $p_{11}=5$. From $p_{12}-p_{13}=0$ we get $p_{13}=0$. From $p_{22}-p_{23}=2$ we get $p_{23}=0$. From $p_{32}-p_{33}=-\\tfrac{7}{2}$ and $p_{32}=0$ we get $p_{33}=\\tfrac{7}{2}$. Finally, $p_{31}-p_{32}=0$ with $p_{32}=0$ gives $p_{31}=0$.\n\nThus\n$$\nP = \\begin{pmatrix}\n5 & 0 & 0 \\\\\n0 & 2 & 0 \\\\\n0 & 0 & \\tfrac{7}{2}\n\\end{pmatrix},\n$$\nwhich corresponds to the rate laws $v_{1}(\\mathbf{c})=5$, $v_{2}(\\mathbf{c})=2\\,c_{1}$, $v_{3}(\\mathbf{c})=\\tfrac{7}{2}\\,c_{2}$, each using exactly one term from $\\Phi(\\mathbf{c})$ and fitting all measurements via $\\dot{c}_{1}=v_{1}-v_{2}$ and $\\dot{c}_{2}=v_{2}-v_{3}$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 5 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & \\frac{7}{2} \\end{pmatrix}}$$"
        }
    ]
}