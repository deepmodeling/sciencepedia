## 引言
在现代科学与工程中，从分子动力学到宇宙学，我们面临着海量的多尺度数据。这些数据内部蕴含着复杂的几何形状和拓扑结构，它们在不同尺度下呈现出不同的形态，并决定着系统的宏观功能。然而，传统的统计方法往往难以捕捉这些超越局部度量的全局形状信息，从而留下了一道关键的知识鸿沟：我们如何才能稳健、定量地描述和比较这些复杂数据内在的[多尺度结构](@entry_id:752336)？

[拓扑数据分析](@entry_id:154661)（Topological Data Analysis, TDA）正是为了应对这一挑战而生的一种革命性方法。它借鉴了[代数拓扑学](@entry_id:138192)的深刻思想，提供了一套严谨的数学框架，用于从离散的数据点云或复杂的标量场中提取、量化和比较其内在的拓扑特征。TDA的核心优势在于其对形状的坐标无关描述以及对噪声和变形的内在鲁棒性，使其成为探索[多尺度系统](@entry_id:1128345)隐藏几何规律的理想工具。

本文旨在为读者提供一份关于TDA在[多尺度系统](@entry_id:1128345)中应用的全面指南。我们将首先在“原理和机制”一章中，深入剖析TDA的数学基础，从将数据转化为单纯复形，到利用持久同调捕捉跨尺度的拓扑演化。接着，在“应用与跨学科连接”一章中，我们将展示TDA如何在材料科学、生物学、物理学和机器学习等前沿领域解决实际问题。最后，通过“动手实践”部分，读者将有机会亲手实现TDA的核心算法，将理论知识转化为解决问题的实践能力。通过这三个章节的学习，您将掌握使用TDA分析复杂系统的核心思想和实用技能。

## 原理和机制

本章旨在深入阐述[拓扑数据分析](@entry_id:154661)（Topological Data Analysis, TDA）在[多尺度系统](@entry_id:1128345)研究中的核心原理和底层机制。我们将从最基本的概念——如何将离散数据点转化为[拓扑空间](@entry_id:155056)——出发，逐步构建一套用于在不同尺度下分析和比较这些空间的代数和计算框架。最终，我们将探讨一些前沿方法，这些方法将TDA的应用从纯粹的拓扑不变量提取，扩展到功能引导的分析和局部-全局信息的整合。

### 从数据到拓扑：单纯复形和同调

[多尺度系统](@entry_id:1128345)的原始数据通常表现为在高维[欧几里得空间](@entry_id:138052) $\mathbb{R}^d$ 中的一个点云 $X$。这些点可能代表分子动力学模拟中的原子位置、材料科学中的微观结构特征，或是复杂网络中的[节点嵌入](@entry_id:1128746)。TDA的首要任务是将这些离散的点云数据转化为一个具有拓扑结构的数学对象，即**[单纯复形](@entry_id:160461)**（simplicial complex）。

#### 单纯复形作为拓扑近似

单纯复形是一种通过将点（0-单纯形）、边（1-单纯形）、三角形（2-单纯形）及更高维的对应物（$k$-单纯形）“粘合”在一起而构成的[拓扑空间](@entry_id:155056)。对于一个点云数据 $X$，最常用的两种构建单纯复形的规则是Vietoris-Rips (VR)复形和Čech复形。

- **Vietoris-Rips (VR)复形**：给定一个尺度参数 $\alpha > 0$，VR复形 $K_\alpha$ 的顶点集是数据点 $X$。任何一个由 $k+1$ 个顶点组成的子集，如果其中任意两点之间的距离都不超过 $\alpha$，那么这个子集就构成一个 $k$-单纯形。VR复形因其定义简单、易于计算而广受欢迎 。

- **Čech复形**：同样给定一个[尺度参数](@entry_id:268705) $r > 0$，我们首先在每个数据点 $x \in X$ 周围构建一个半径为 $r$ 的[闭球](@entry_id:157850) $B(x, r)$。一个顶点子集 $\sigma \subseteq X$ 在Čech复形 $\check{C}(X,r)$ 中构成一个单纯形，当且仅当这些顶点对应的[闭球](@entry_id:157850)的交集非空，即 $\bigcap_{x \in \sigma} B(x,r) \neq \emptyset$。

#### 神经元定理：连接离散与连续

Čech复形的重要性在于它与一个深刻的拓扑学定理——**神经元定理**（Nerve Theorem）——紧密相关。该定理为我们使用离散的组合结构（单纯复形）来推断连续空间的拓扑提供了理论基础。

首先，我们可以将Čech复形 $\check{C}(X,r)$ 视为一个球覆盖 $\mathcal{U}_r = \{ B(x,r) : x \in X \}$ 的**神经元**（nerve）。一个[覆盖的神经](@entry_id:265866)元，其顶点对应于覆盖中的集合，而一组顶点张成一个单纯形当且仅当它们对应的集合交集非空。根据定义，$\check{C}(X,r)$ 正是球覆盖 $\mathcal{U}_r$ 的神经元 。

神经元定理指出，如果一个覆盖是**好覆盖**（good cover），即其任意有限非空子交集都是可收缩的（contractible），那么该[覆盖的神经](@entry_id:265866)元与其并集具有相同的[同伦型](@entry_id:148015)（homotopy type）。在[欧几里得空间](@entry_id:138052)中，[闭球](@entry_id:157850)是[凸集](@entry_id:155617)，而任意有限个[凸集](@entry_id:155617)的交集仍然是[凸集](@entry_id:155617)，因此也是可收缩的。这意味着 $\mathcal{U}_r$ 是一个好覆盖。因此，根据神经元定理，我们有如下的[同伦等价](@entry_id:150816)关系：
$$
\check{C}(X,r) \simeq \bigcup_{x \in X} B(x,r)
$$
这意味着Čech复形的[拓扑性质](@entry_id:141605)（如同调群、[Betti数](@entry_id:153109)、[欧拉示性数](@entry_id:152513)等）与这些球的并集的拓扑性质完全相同。例如，考虑位于 $\mathbb{R}^2$ 中边长为 $\ell$ 的等边三角形的三个顶点 $X = \{p_1, p_2, p_3\}$。我们可以通过计算 $\check{C}(X,r)$ 的[欧拉示性数](@entry_id:152513) $\chi$ 来得到球并集 $U_r = \bigcup_{i=1}^3 B(p_i, r)$ 的[欧拉示性数](@entry_id:152513)。随着半径 $r$ 的变化，[单纯复形](@entry_id:160461)的组合结构会发生改变：
- 当 $r  \ell/2$ 时，球互不相交，复形只有3个顶点，$\chi(U_r) = 3$。
- 当 $\ell/2 \le r  \ell/\sqrt{3}$ 时，任意两球相交但三球交集为空，复形有3个顶点和3条边，形成一个环，$\chi(U_r) = 3 - 3 = 0$。
- 当 $r \ge \ell/\sqrt{3}$ 时，三球交集非空，复形有一个2-单纯形（实心三角形），是可收缩的，$\chi(U_r) = 3 - 3 + 1 = 1$。
利用[单位阶跃函数](@entry_id:268807) $\mathrm{H}(t)$（当 $t \ge 0$ 时为1，否则为0），我们可以将此关系表示为 $\chi(U_r) = 3 - 3\,\mathrm{H}(r - \frac{\ell}{2}) + \mathrm{H}(r - \frac{\ell}{\sqrt{3}})$ 。

#### [采样理论](@entry_id:268394)保证

神经元定理告诉我们Čech复形能够捕捉到球并集的拓扑。然而，在科学应用中，我们更关心的是数据点 $P$ 所采样的某个未知连续空间 $X$ 的拓扑。TDA提供了一个强有力的理论保证，说明在特定条件下，这是可以做到的。

这个理论依赖于两个关键几何量：未知空间 $X$ 的**厚度**（reach）和采样点集 $P$ 的**密度**。空间的厚度 $\tau > 0$ 是一个度量其“平滑度”的量，直观地讲，空间中任何一点的法空间在半径为 $\tau$ 的邻域内都是良好定义的。采样的密度则通过**[豪斯多夫距离](@entry_id:152367)**（Hausdorff distance）$d_H(P, X)$ 来衡量，如果 $d_H(P, X) \le \varepsilon$，我们称 $P$ 是 $X$ 的一个 $\varepsilon$-样本。

一个里程碑式的结论是：如果 $P$ 是一个紧致子集 $X \subset \mathbb{R}^d$ 的 $\varepsilon$-样本，且 $X$ 的厚度为 $\tau$，那么对于任何满足 $\varepsilon  r  \tau - \varepsilon$ 的[尺度参数](@entry_id:268705) $r$，由样本点 $P$ 构建的Čech复形 $\check{C}(P,r)$ 与原始空间 $X$ 具有相同的[同伦型](@entry_id:148015)：
$$
\check{C}(P,r) \simeq X
$$
这个结论的证明思路是，在给定条件下，球并集 $U_r(P) = \bigcup_{p \in P} B(p,r)$ 被“夹在” $X$ 的两个偏移曲面 $X_{r-\varepsilon}$ 和 $X_{r+\varepsilon}$ 之间，即 $X_{r-\varepsilon} \subseteq U_r(P) \subseteq X_{r+\varepsilon}$。由于 $r \pm \varepsilon$ 均在 $(0, \tau)$ 区间内，这两个偏移曲面都能够[形变收缩](@entry_id:148036)到 $X$ 上。通过拓扑学中的“夹逼论证”，可以证明 $U_r(P)$ 也与 $X$ [同伦等价](@entry_id:150816)。再结合神经元定理 $\check{C}(P,r) \simeq U_r(P)$，就得到了最终的结论 。这个定理是TDA作为一种几何推断工具的理论基石。

#### 拓扑的代数语言

一旦我们将数据转化为单纯复形 $K$，下一步就是用代数方法来定量描述其拓扑特征，例如连通分支、环、空腔等。这通过**同调论**（homology theory）实现。

给定一个域作为系数（在TDA中通常使用[二元域](@entry_id:267286) $\mathbb{Z}_2$ 以简化计算），我们构建一个**[链复形](@entry_id:150246)**（chain complex）$(C_\bullet(K;k), \partial)$ 。
- **链群**（Chain Groups）：对于每个维度 $n \ge 0$，$n$-链群 $C_n(K;k)$ 是一个由 $K$ 的所有定向 $n$-单纯形作为基底生成的 $k$-[向量空间](@entry_id:151108)。它的元素（称为**$n$-链**）是 $n$-单纯形的形式[线性组合](@entry_id:154743)。
- **[边界算子](@entry_id:160216)**（Boundary Operator）：[边界算子](@entry_id:160216) $\partial_n : C_n(K;k) \to C_{n-1}(K;k)$ 是一个[线性映射](@entry_id:185132)，它将一个 $n$-单纯形 $[v_0, \dots, v_n]$ 映为其所有 $(n-1)$-维面的交错和：
$$
\partial_n [v_0, \dots, v_n] = \sum_{i=0}^{n} (-1)^i [v_0, \dots, \widehat{v_i}, \dots, v_n]
$$
其中 $\widehat{v_i}$ 表示省略顶点 $v_i$。这个算子最关键的性质是**“[边界的边界为零](@entry_id:269907)”**，即 $\partial_n \circ \partial_{n+1} = 0$。

有了[链复形](@entry_id:150246)，我们便可以定义描述拓扑特征的代数不变量：
- **圈**（Cycles）：一个 $n$-链 $z$，如果它的边界为零（$\partial_n z = 0$），则称之为一个 $n$-圈。$n$-圈的集合构成一个[向量空间](@entry_id:151108) $Z_n(K;k) = \ker(\partial_n)$。
- **边界**（Boundaries）：一个 $n$-链 $b$，如果它是某个 $(n+1)$-链的边界（$b = \partial_{n+1} c$），则称之为一个 $n$-边界。$n$-边界的集合也构成一个向量空间 $B_n(K;k) = \operatorname{im}(\partial_{n+1})$。

由于 $\partial \circ \partial = 0$，所有边界都是圈，即 $B_n(K;k) \subseteq Z_n(K;k)$。
- **同调群**（Homology Groups）：第 $n$ 个同调群 $H_n(K;k)$ 定义为 $n$-圈模去 $n$-边界的[商空间](@entry_id:274314)：
$$
H_n(K;k) = Z_n(K;k) / B_n(K;k) = \ker(\partial_n) / \operatorname{im}(\partial_{n+1})
$$
同调群的维数，记为 $\beta_n = \dim H_n(K;k)$，被称为第 $n$ 个**[Betti数](@entry_id:153109)**。$\beta_0$ 是[连通分支](@entry_id:141881)的数量，$\beta_1$ 是“环”的数量，$\beta_2$ 是“空腔”的数量，依此类推。

与同调对偶的概念是**[上同调](@entry_id:160558)**（cohomology）。它通过对[链复形](@entry_id:150246)取对偶空间来构造。上链群是 $C^n(K;k) = \operatorname{Hom}_k(C_n(K;k),k)$，上[边界算子](@entry_id:160216) $\delta^n$ 是 $\partial_{n+1}$ 的对偶映射。[上同调群](@entry_id:142450)定义为 $H^n(K;k) = \ker(\delta^n) / \operatorname{im}(\delta^{n-1})$。同调和[上同调](@entry_id:160558)的一个关键区别在于它们在映射下的表现：同调是**[协变](@entry_id:634097)的**（covariant），而[上同调](@entry_id:160558)是**逆变的**（contravariant）。这个区别在研究空间之间的映射时至关重要。

### 捕获尺度：[持续同调](@entry_id:161156)

[多尺度系统](@entry_id:1128345)的核心在于其结构和性质如何随尺度变化。TDA通过**[持续同调](@entry_id:161156)**（Persistent Homology, PH）来捕捉这种变化。[持续同调](@entry_id:161156)不是分析单个的[单纯复形](@entry_id:160461)，而是分析一个随[尺度参数](@entry_id:268705)演化的复形族。

#### 滤子和持续同调模

这种演化通过**滤子**（filtration）来形式化。一个[单纯复形](@entry_id:160461)的滤子是一个由[尺度参数](@entry_id:268705) $\alpha \in \mathbb{R}$ 索引的复形族 $\{K_\alpha\}$，它满足嵌套属性：如果 $\alpha \le \beta$，则 $K_\alpha$ 是 $K_\beta$ 的一个[子复形](@entry_id:264130)，即 $K_\alpha \subseteq K_\beta$ 。这意味着随着尺度参数的增大，我们只向复形中添加新的单纯形，从不移除。例如，VR复形和Čech复形族 $\{K_\alpha\}_{\alpha \ge 0}$ 都是滤子。

这种嵌套的空间结构，通过应用同调[函子](@entry_id:150427)，被转化为一个[代数结构](@entry_id:137052)。对于滤子中的每一个包含关系 $i_{\alpha,\beta}: K_\alpha \hookrightarrow K_\beta$（其中 $\alpha \le \beta$），同调的[协变](@entry_id:634097)性会诱导出同调群之间的一个[线性映射](@entry_id:185132) $(i_{\alpha,\beta})_* : H_n(K_\alpha; k) \to H_n(K_\beta; k)$。这样，对于一个固定的维度 $n$，我们就得到了一族向量空间和连接它们的[线性映射](@entry_id:185132)。这个代数对象被称为一个**持续同调模**（persistence module）。

更形式地说，我们可以将索引集 $(\mathbb{R}, \le)$ 看作一个[偏序](@entry_id:145467)范畴（poset category）。一个[持续同调](@entry_id:161156)模就是一个从 $(\mathbb{R}, \le)$ 到 $k$-[向量空间](@entry_id:151108)范畴 $\mathrm{Vec}_k$ 的**协变[函子](@entry_id:150427)** $V$。它将每个尺度 $\alpha$ 映为一个[向量空间](@entry_id:151108) $V(\alpha) = H_n(K_\alpha; k)$，并将每对关系 $\alpha \le \beta$ 映为一个[线性映射](@entry_id:185132) $V(\alpha \le \beta) : V(\alpha) \to V(\beta)$ 。

#### [持续性条形码](@entry_id:273949)

持续同调模的核心思想是追踪拓扑特征（即同调类）在滤子中的“生命周期”。一个在尺度 $\alpha_b$ 首次出现的 $n$ 维同调类被称为在 $\alpha_b$ **诞生**（born）。如果这个同调类在尺度 $\alpha_d$ 时与一个更高维单纯形的边界合并而消失，我们称它在 $\alpha_d$ **死亡**（dies）。这对值 $(\alpha_b, \alpha_d)$ 构成一个**持续性区间**，其长度 $\alpha_d - \alpha_b$ 衡量了这个拓扑特征的**持续性**。

所有这些持续性区间的集合可以被可视化为一个**[持续性条形码](@entry_id:273949)**（persistence barcode），其中每个条形代表一个拓扑特征的生命周期。长条纹对应于在很大尺度范围内都存在的“稳定”特征，而短条纹通常被解释为“噪声”。条形码是持续同调模的一个完备不变量，这意味着它完全刻画了模的结构。

#### 计算与复杂度

[持续性条形码](@entry_id:273949)的计算依赖于一种特殊的矩阵约减算法。首先，我们将滤子中的所有单纯形 $\{\sigma_1, \dots, \sigma_m\}$ 按照它们出现的尺度值进行排序（尺度相同则按维度排序）。然后，我们构建一个**边界矩阵** $D$，其中第 $j$ 列表示单纯形 $\sigma_j$ 的边界 $\partial \sigma_j$（用排在它前面的单纯形基底表示）。

该算法通过一系列的列操作来约减矩阵 $D$，但必须遵守滤子顺序的约束：在处理第 $j$ 列时，只能将索引小于 $j$ 的列加到第 $j$ 列上。算法的目标是使每一列的最低非零元（称为**主元**，pivot）的行索引是唯一的。具体操作是：对于第 $j$ 列，如果其主元所在的行 $i$ 已经被某个更早的列 $k  j$ 占据，则将第 $k$ 列加到第 $j$ 列上，直到第 $j$ 列的主元行不再冲突，或者第 $j$ 列变全为零。

约减完成后，如果第 $j$ 列的主元在第 $i$ 行，这对应一个持续性对 $(\sigma_i, \sigma_j)$，意味着由 $\sigma_i$ 引入的同调类在 $\sigma_j$ 加入时死亡。在最坏情况下，此算法的计算复杂度为 $O(m^3)$，其中 $m$ 是单纯形的总数，[空间复杂度](@entry_id:136795)为 $O(m^2)$ 。

#### [稳定性定理](@entry_id:1132262)：对噪声的鲁棒性

TDA的一个关键优势在于其**稳定性**。[稳定性定理](@entry_id:1132262)保证了如果输入数据或用于构建滤子的函数发生微小扰动，那么输出的[持续性条形码](@entry_id:273949)（通常用等价的[持续性图](@entry_id:1129534)表示）也只会发生微小变化。这使得TDA方法对噪声具有鲁棒性。

形式上，对于两个函数 $f, g: X \to \mathbb{R}$，它们各自的子水平集滤子（sublevel set filtration）所产生的[持续性图](@entry_id:1129534) $Dgm(f)$ 和 $Dgm(g)$ 之间的**瓶颈距离**（bottleneck distance）$d_B$ 有一个[上界](@entry_id:274738)：
$$
d_B(Dgm(f), Dgm(g)) \le \|f - g\|_{\infty} = \sup_{x \in X} |f(x) - g(x)|
$$
这个定理意味着，[持续性图](@entry_id:1129534)的变化不会超过原始函数变化的幅度。

我们可以通过一个具体的例子来理解这一原理。假设我们有一组原始数据样本 $\{X_i\}$，并将其[经验测度](@entry_id:181007)记为 $\mu_n$。另一组数据 $\{Y_i\}$ 是被加性噪声污染后的版本，满足 $\|Y_i - X_i\| \le \epsilon$，其[经验测度](@entry_id:181007)为 $\nu_n$。我们可以使用**距离到测度函数**（distance-to-measure function）$d_{\rho,m}$ 来构建滤子。通过一系列推导，可以证明这两个距离函数之间的差异也由噪声界限 $\epsilon$ 控制：
$$
\|d_{\mu_n, m} - d_{\nu_n, m}\|_{\infty} \le \epsilon
$$
因此，应用[稳定性定理](@entry_id:1132262)，我们得到它们各自的[持续性图](@entry_id:1129534)之间的瓶颈距离也以 $\epsilon$ 为界：$d_B(Dgm(d_{\mu_n,m}), Dgm(d_{\nu_n,m})) \le \epsilon$ 。这个结果清晰地表明，TDA能够稳健地处理有界噪声，这是其在[真实世界数据](@entry_id:902212)分析中获得成功的一个重要原因。

### 高级方法与视角

除了标准的持续同调，TDA还发展出了一系列更先进的方法，以应对更复杂的分析场景。

#### Mapper：功能引导的数据景观探索

**[Mapper算法](@entry_id:261272)**是一种强大的可视化和探索性数据分析工具，它通过一个用户选择的**滤子函数**（filter function）$f: X \to \mathbb{R}$ 来简化和表示高维数据。这个函数可以捕获数据的某些宏观属性，如密度、中心性或某个[物理可观测量](@entry_id:154692)。

Mapper的构造过程如下 ：
1.  **覆盖（Cover）**：用一组有重叠的区间 $\{U_i\}$ 覆盖滤子[函数的值域](@entry_id:161901) $f(X)$。
2.  **拉回（Pullback）**：对于每个区间 $U_i$，计算其在数据点集 $X$ 中的[原像](@entry_id:150899)（或称拉回）$f^{-1}(U_i) = \{x \in X \mid f(x) \in U_i\}$。
3.  **聚类（Clustering）**：在每个[原像](@entry_id:150899) $f^{-1}(U_i)$ 内部，应用聚类算法将其划分为若干个不相交的簇 $\{C_{i\alpha}\}$。
4.  **神经元（Nerve）**：将所有这些簇 $\{C_{i\alpha}\}$ 作为顶点，构建一个图（或更高维的单纯复形）。如果两个簇 $C_{i\alpha}$ 和 $C_{j\beta}$ 的交集非空（$C_{i\alpha} \cap C_{j\beta} \neq \emptyset$），就在它们对应的顶点之间连接一条边。

最终得到的Mapper图是一个低维的、骨架式的表示，它揭示了数据在滤子函数引导下的连通结构。Mapper与**Reeb图**密切相关，Reeb图是一个理论对象，它通过将水平集（level set）的[连通分支](@entry_id:141881)压缩成点来定义。Mapper图可以被看作是Reeb图的一个数据驱动的、鲁棒的近似 。

Mapper图的拓扑结构何时会发生变化？这与**[莫尔斯理论](@entry_id:151962)**（Morse Theory）有关。对于一个光滑的滤子函数 $f$，其[拓扑性质](@entry_id:141605)仅在**临界值**（critical values）处发生改变。Mapper的理论基础表明，只要覆盖区间 $I$ 完全位于两个相邻临界值之间的正则区间内，其[原像](@entry_id:150899) $f^{-1}(I)$ 的拓扑就是稳定的。因此，Mapper图的[拓扑变化](@entry_id:136654)预计会发生在覆盖区间的端点跨越临界值时。这一原理为Mapper参数的选择提供了理论指导。例如，若函数值有界为 $\nu$ 的噪声，而[函数的临界值](@entry_id:269296)之间最小间距为 $d_{\min}$，那么为保证每个覆盖区间最多只捕捉一个[拓扑变化](@entry_id:136654)，其长度 $\ell$ 应满足 $\ell \le d_{\min} - 2\nu$ 。

#### 推广滤子：Z形与[多参数持续性](@entry_id:1128311)

标准的[持续同调](@entry_id:161156)要求一个严格嵌套的滤子。然而，在许多应用中，例如处理时变数据或比较两个不相关的数据集时，这种嵌套结构并不存在。

**Z形[持续同调](@entry_id:161156)**（Zigzag Persistence）推广了持续同调，以处理一个由任意向前或向后映射连接起来的空间序列，例如 $K_0 \leftrightarrow K_1 \leftrightarrow \dots \leftrightarrow K_T$。通过对这个序列应用同调[函子](@entry_id:150427)，我们得到一个向量空间和[线性映射](@entry_id:185132)的“Z”字形序列。这个[代数结构](@entry_id:137052)可以被精确地描述为**A型[箭图](@entry_id:143940)**（type A quiver）的一个表示。一个深刻的代数结果保证，这种表示也能够唯一地分解为一系列“区间模”的[直和](@entry_id:156782)，从而产生一个Z形[持续性条形码](@entry_id:273949)，捕捉了在非[单调序列](@entry_id:145193)中特征的生命周期 。

另一个方向的推广是**多参数[持续同调](@entry_id:161156)**。当系统由两个或更多参数（例如，尺度和密度）同时控制时，我们会得到一个由 $\mathbb{R}^2$ 或更高维偏序集索引的滤子。这产生了一个多参数[持续同调](@entry_id:161156)模 。然而，与一维情况不同，多参数持续同调模的理论变得异常复杂。它们的表示类型是“野性”的（wild representation type），这意味着不存在一个简单的、如条形码那样的完备离散不变量。这是多参数TDA中的一个核心挑战。尽管如此，研究人员已经开发出一些不完备但仍然有用的不变量，例如**[纤维化](@entry_id:203334)条形码**（fibered barcode），它通过沿着多[参数空间](@entry_id:178581)中的一系列直线“切片”来得到一组一维条形码的集合 。

#### 整合局部数据与全局拓扑：胞腔层

经典的TDA方法主要关注空间的全局拓扑形状。然而，在许多[多尺度系统](@entry_id:1128345)中，在空间的不同位置和尺度上，我们还拥有丰富的局部测量数据（例如，传感器读数、材料[应力张量](@entry_id:148973)等）。**胞腔层理论**（cellular sheaf theory）为整合这些局部数据与全局拓扑提供了一个强大的数学框架。

一个**胞腔层**（cellular sheaf）$\mathcal{F}$ 在一个[胞腔复形](@entry_id:262638)（如单纯复形或图）$X$ 上，为每个胞腔（顶点、边等）赋予一个向量空间（“茎”，stalk），并为每个面关系（如顶点 $v$ 是边 $e$ 的一个面，记为 $v \le e$）赋予一个线性**限制映射**（restriction map）$\rho_{e \to v} : \mathcal{F}(e) \to \mathcal{F}(v)$。这些映射的方向是从大胞腔到小胞腔，体现了“限制”的思想。一个层的**[截面](@entry_id:154995)**（section）是在所有胞腔上赋予的数据，这些数据必须与限制映射兼容（即，在一个顶点上的数据必须是包含它的所有边上数据的限制）。层的**[上同调](@entry_id:160558)**可以检测出是否存在一个全局一致的解来满足所有局部约束 。

与层对偶的概念是**上层**（cosheaf）。一个胞腔[上层](@entry_id:198114) $\mathcal{G}$ 同样为每个胞腔赋予向量空间，但其映射方向相反：对于 $v \le e$，它定义了一个**扩张映射**（extension map）$\iota_{v \to e} : \mathcal{G}(v) \to \mathcal{G}(e)$，从低维胞腔向高维胞腔“推送”数据。层的选择（层还是上层）取决于所研究系统的具体物理或信息流模型，它为在复杂的几何和拓扑骨架上进行局部-[全局分析](@entry_id:188294)提供了严谨的语言 。