{
    "hands_on_practices": [
        {
            "introduction": "理论学习的最佳方式之一就是通过一个精确可解的模型来验证它。这项练习将自由能微扰（FEP）的核心思想应用于一个简单的一维谐振子系统。通过两种不同的方法——直接使用FEP指数平均公式和通过计算配分函数之比——推导自由能差，你将亲手验证自由能微扰理论的正确性，并加深对系综平均和自由能之间基本关系的理解。",
            "id": "3847564",
            "problem": "考虑一个温度恒定为 $T$ 的经典一维系统，由单一坐标 $x$ 和两个谐振势能函数描述：$U_{A}(x)=\\tfrac{1}{2}k_{A}x^{2}$ 和 $U_{B}(x)=\\tfrac{1}{2}k_{B}x^{2}$，其中 $k_{A}0$ 和 $k_{B}0$ 是力常数。仅使用正则系综的定义和经典统计力学的基本事实，通过两种方法推导状态 $B$ 和状态 $A$ 之间的自由能差 $\\Delta F \\equiv F_{B}-F_{A}$：\n1. 从 $U_{A}(x)$ 下的正则平均定义出发，计算系综平均 $\\langle \\exp(-\\beta\\Delta U)\\rangle_{A}$，其中 $\\Delta U(x)\\equiv U_{B}(x)-U_{A}(x)$ 且 $\\beta\\equiv 1/(k_{\\mathrm{B}}T)$，$k_{\\mathrm{B}}$ 为玻尔兹曼常数。利用此平均值获得 $\\Delta F$ 的解析表达式，除正则定义外不借助任何预先给定的恒等式。\n2. 独立计算 $U_{B}$ 和 $U_{A}$ 的精确位形配分函数之比，并用它来求得 $\\Delta F$。证明两种方法得到的结果一致。\n\n假设哈密顿量可分离为动能和势能部分，并注意由于状态 $A$ 和 $B$ 的动能相同，任何动量贡献在自由能差中都会相互抵消。请用 $k_{A}$、$k_{B}$、$k_{\\mathrm{B}}$ 和 $T$ 表示 $\\Delta F$ 的单一闭合形式表达式。自由能以焦耳为单位表示。无需进行数值计算或四舍五入。",
            "solution": "本题要求推导由谐振势能函数 $U_{A}(x)=\\tfrac{1}{2}k_{A}x^{2}$ 和 $U_{B}(x)=\\tfrac{1}{2}k_{B}x^{2}$ 描述的一维经典系统两个状态之间的亥姆霍兹自由能差 $\\Delta F \\equiv F_{B}-F_{A}$。推导必须通过两种不同的方法进行，以证明它们的等价性。给定逆温度 $\\beta \\equiv 1/(k_{\\mathrm{B}}T)$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是恒定温度。\n\n首先，我们建立自由能和配分函数之间的基本关系。亥姆霍兹自由能 $F$ 通过总正则配分函数 $Z$ 定义为：\n$$F = -k_{\\mathrm{B}}T \\ln Z = -\\frac{1}{\\beta} \\ln Z$$\n对于具有可分离哈密顿量 $H(p,x) = K(p) + U(x)$ 的一维系统，总配分函数 $Z$ 由对所有相空间坐标 $(p,x)$ 的积分给出：\n$$Z = \\frac{1}{h} \\int \\int \\exp(-\\beta H(p,x)) dp dx = \\left(\\frac{1}{h} \\int \\exp(-\\beta K(p)) dp\\right) \\left(\\int \\exp(-\\beta U(x)) dx\\right)$$\n其中 $h$ 是一个具有作用量单位的常数，以使 $Z$ 无量纲，通常为普朗克常数。我们可以将其写为 $Z = Z_{\\mathrm{kin}} Q$，其中 $Z_{\\mathrm{kin}}$ 是动能贡献，$Q$ 是位形配分函数，$Q = \\int_{-\\infty}^{\\infty} \\exp(-\\beta U(x)) dx$。\n\n自由能差 $\\Delta F$ 为：\n$$\\Delta F = F_{B} - F_{A} = \\left(-\\frac{1}{\\beta} \\ln Z_{B}\\right) - \\left(-\\frac{1}{\\beta} \\ln Z_{A}\\right) = -\\frac{1}{\\beta} \\ln\\left(\\frac{Z_{B}}{Z_{A}}\\right)$$\n由于状态 $A$ 和 $B$ 的动能项 $K(p)$ 相同，它们的动能配分函数 $Z_{\\mathrm{kin},A}$ 和 $Z_{\\mathrm{kin},B}$ 也相同。因此，总配分函数之比简化为位形配分函数之比：\n$$\\frac{Z_{B}}{Z_{A}} = \\frac{Z_{\\mathrm{kin}} Q_{B}}{Z_{\\mathrm{kin}} Q_{A}} = \\frac{Q_{B}}{Q_{A}}$$\n因此，自由能差与位形配分函数直接相关：\n$$\\Delta F = -\\frac{1}{\\beta} \\ln\\left(\\frac{Q_{B}}{Q_{A}}\\right)$$\n这个从正则定义推导出的关系将是两种方法的核心。\n\n**方法一：使用系综平均进行推导**\n\n此方法要求我们计算系综平均 $\\langle \\exp(-\\beta\\Delta U)\\rangle_{A}$ 并将其与 $\\Delta F$ 联系起来。首先，我们必须按要求从基本定义中推导出这种关系。\n\n在状态 $A$ 中，物理量 $O(x)$ 的正则系综平均定义为：\n$$\\langle O(x) \\rangle_{A} = \\frac{\\int_{-\\infty}^{\\infty} O(x) \\exp(-\\beta U_{A}(x)) dx}{\\int_{-\\infty}^{\\infty} \\exp(-\\beta U_{A}(x)) dx} = \\frac{\\int_{-\\infty}^{\\infty} O(x) \\exp(-\\beta U_{A}(x)) dx}{Q_{A}}$$\n我们感兴趣的是 $O(x) = \\exp(-\\beta\\Delta U(x))$ 的特定平均值，其中 $\\Delta U(x) = U_{B}(x) - U_{A}(x)$。将其代入定义中：\n$$\\langle \\exp(-\\beta\\Delta U) \\rangle_{A} = \\frac{\\int_{-\\infty}^{\\infty} \\exp(-\\beta(U_{B}(x) - U_{A}(x))) \\exp(-\\beta U_{A}(x)) dx}{Q_{A}}$$\n通过合并分子中的指数项，我们发现：\n$$\\int_{-\\infty}^{\\infty} \\exp(-\\beta U_{B}(x) + \\beta U_{A}(x) - \\beta U_{A}(x)) dx = \\int_{-\\infty}^{\\infty} \\exp(-\\beta U_{B}(x)) dx = Q_{B}$$\n因此，系综平均恰好是位形配分函数之比：\n$$\\langle \\exp(-\\beta\\Delta U) \\rangle_{A} = \\frac{Q_{B}}{Q_{A}}$$\n将此结果与前面推导的 $\\Delta F$ 表达式相结合，我们得到自由能微扰恒等式：\n$$\\Delta F = -k_{\\mathrm{B}}T \\ln \\langle \\exp(-\\beta\\Delta U) \\rangle_{A}$$\n现在，我们为给定的势能显式计算该平均值。势能差为：\n$$\\Delta U(x) = U_{B}(x) - U_{A}(x) = \\frac{1}{2}k_{B}x^{2} - \\frac{1}{2}k_{A}x^{2} = \\frac{1}{2}(k_{B} - k_{A})x^{2}$$\n系综平均为：\n$$\\langle \\exp(-\\beta\\Delta U) \\rangle_{A} = \\frac{\\int_{-\\infty}^{\\infty} \\exp\\left(-\\beta \\left(\\frac{1}{2}(k_{B}-k_{A})x^{2}\\right)\\right) \\exp\\left(-\\beta \\left(\\frac{1}{2}k_{A}x^{2}\\right)\\right) dx}{\\int_{-\\infty}^{\\infty} \\exp\\left(-\\beta \\left(\\frac{1}{2}k_{A}x^{2}\\right)\\right) dx}$$\n分子的积分为：\n$$I_{\\mathrm{num}} = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta}{2}(k_{B}-k_{A}+k_{A})x^{2}\\right) dx = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta k_{B}}{2}x^{2}\\right) dx$$\n分母的积分为：\n$$I_{\\mathrm{den}} = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta k_{A}}{2}x^{2}\\right) dx$$\n这些是形式为 $\\int_{-\\infty}^{\\infty} \\exp(-ax^{2})dx = \\sqrt{\\pi/a}$ 的标准高斯积分。\n对于分子，$a = \\frac{\\beta k_{B}}{2}$，所以 $I_{\\mathrm{num}} = \\sqrt{\\frac{2\\pi}{\\beta k_{B}}}$。\n对于分母，$a = \\frac{\\beta k_{A}}{2}$，所以 $I_{\\mathrm{den}} = \\sqrt{\\frac{2\\pi}{\\beta k_{A}}}$。\n系综平均是这两个结果的比值：\n$$\\langle \\exp(-\\beta\\Delta U) \\rangle_{A} = \\frac{\\sqrt{2\\pi/(\\beta k_{B})}}{\\sqrt{2\\pi/(\\beta k_{A})}} = \\sqrt{\\frac{2\\pi}{\\beta k_{B}} \\cdot \\frac{\\beta k_{A}}{2\\pi}} = \\sqrt{\\frac{k_{A}}{k_{B}}}$$\n最后，我们将此代入 $\\Delta F$ 的表达式中：\n$$\\Delta F = -k_{\\mathrm{B}}T \\ln\\left(\\sqrt{\\frac{k_{A}}{k_{B}}}\\right) = -k_{\\mathrm{B}}T \\ln\\left(\\left(\\frac{k_{A}}{k_{B}}\\right)^{1/2}\\right) = -\\frac{1}{2}k_{\\mathrm{B}}T \\ln\\left(\\frac{k_{A}}{k_{B}}\\right)$$\n利用对数性质 $\\ln(1/x) = -\\ln(x)$，这可以写成：\n$$\\Delta F = \\frac{1}{2}k_{\\mathrm{B}}T \\ln\\left(\\frac{k_{B}}{k_{A}}\\right)$$\n\n**方法二：使用配分函数之比进行推导**\n\n此方法直接通过位形配分函数之比 $Q_{B}/Q_{A}$ 计算 $\\Delta F$。如引言中所述，$\\Delta F = -k_{\\mathrm{B}}T \\ln(Q_{B}/Q_{A})$。\n\n状态 $A$ 和 $B$ 的位形配分函数为：\n$$Q_{A} = \\int_{-\\infty}^{\\infty} \\exp(-\\beta U_{A}(x)) dx = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta k_{A}}{2}x^{2}\\right) dx$$\n$$Q_{B} = \\int_{-\\infty}^{\\infty} \\exp(-\\beta U_{B}(x)) dx = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta k_{B}}{2}x^{2}\\right) dx$$\n利用高斯积分结果 $\\int_{-\\infty}^{\\infty} \\exp(-ax^{2})dx = \\sqrt{\\pi/a}$，我们计算每个配分函数：\n$$Q_{A} = \\sqrt{\\frac{\\pi}{(\\beta k_{A}/2)}} = \\sqrt{\\frac{2\\pi}{\\beta k_{A}}}$$\n$$Q_{B} = \\sqrt{\\frac{\\pi}{(\\beta k_{B}/2)}} = \\sqrt{\\frac{2\\pi}{\\beta k_{B}}}$$\n接下来，我们计算它们的比值：\n$$\\frac{Q_{B}}{Q_{A}} = \\frac{\\sqrt{2\\pi/(\\beta k_{B})}}{\\sqrt{2\\pi/(\\beta k_{A})}} = \\sqrt{\\frac{k_{A}}{k_{B}}}$$\n将该比值代入自由能差的方程中：\n$$\\Delta F = -k_{\\mathrm{B}}T \\ln\\left(\\frac{Q_{B}}{Q_{A}}\\right) = -k_{\\mathrm{B}}T \\ln\\left(\\sqrt{\\frac{k_{A}}{k_{B}}}\\right)$$\n这可以简化为：\n$$\\Delta F = -\\frac{1}{2}k_{\\mathrm{B}}T \\ln\\left(\\frac{k_{A}}{k_{B}}\\right) = \\frac{1}{2}k_{\\mathrm{B}}T \\ln\\left(\\frac{k_{B}}{k_{A}}\\right)$$\n\n**结论**\n\n两种方法都得出了相同的自由能差结果：$\\Delta F = \\frac{1}{2}k_{\\mathrm{B}}T \\ln(k_{B}/k_{A})$。这证实了两种方法的一致性，它们都是统计力学和计算自由能计算的基石。该表达式具有能量单位（国际单位制中为焦耳），因为乘积 $k_{\\mathrm{B}}T$ 具有能量单位，而对数项是无量纲的。",
            "answer": "$$\n\\boxed{\\frac{1}{2} k_{\\mathrm{B}}T \\ln\\left(\\frac{k_{B}}{k_{A}}\\right)}\n$$"
        },
        {
            "introduction": "自由能计算的核心在于理解能量差分布 $\\Delta U$ 与自由能变化 $\\Delta F$ 之间的深刻联系。本练习探讨了一个特殊但极其重要的情景：当能量差 $\\Delta U$ 服从高斯分布时会发生什么。通过证明在此假设下，精确的自由能结果与二阶累积量展开的结果完全吻合，你将揭示为什么高斯近似和线性响应理论在许多近谐振体系中如此有效。",
            "id": "3847576",
            "problem": "考虑一个具有两个热力学状态的生物分子系统，标记为 $A$（参考态）和 $B$（目标态），处于恒定温度 $T$。令 $U_{A}(x)$ 和 $U_{B}(x)$ 分别表示构象 $x$ 在状态 $A$ 和 $B$ 中的势能，并定义能量差 $\\Delta U(x) \\equiv U_{B}(x) - U_{A}(x)$。在统计力学框架下进行分析，其中状态 $A$ 的系综遵循玻尔兹曼分布，其逆温度为 $\\beta \\equiv (k_{B} T)^{-1}$（$k_{B}$ 是玻尔兹曼常数），系综的归一化由配分函数给出。自由能微扰（FEP）方法通过对参考系综使用能量差 $\\Delta U$ 进行重加权，来计算状态 $A$ 和 $B$ 之间的亥姆霍兹自由能差 $\\Delta F$。\n\n假设从状态 $A$ 中采样的标量随机变量 $\\Delta U$是一维的，并且服从均值为 $\\mu$、方差为 $\\sigma^{2}$ 的正态（高斯）分布，即 $\\Delta U \\sim \\mathcal{N}(\\mu,\\sigma^{2})$。这种情况在谐振或近谐振体系中很典型，其中线性响应和中心极限定理行为使得 $\\Delta U$ 近似呈高斯分布。\n\n从玻尔兹曼分布和配分函数的定义出发，推导出通过 FEP 获得的无量纲自由能变化 $\\beta \\Delta F$ 的精确表达式，该表达式应以对状态 $A$ 的系综平均表示。然后，仅使用高斯分布的定义性质和广义矩量生成函数，证明该精确结果与二阶矩量展开的截断相匹配。最后，通过此等式解释为什么高斯近似在谐振体系中是合理的。\n\n你的最终答案必须是关于 $\\beta \\Delta F$ 的一个封闭形式解析表达式，用 $\\mu$、$\\sigma^{2}$ 和 $\\beta$ 表示。不要包含单位。无需四舍五入。",
            "solution": "该问题要求在能量差 $\\Delta U = U_B - U_A$（从参考态 $A$ 采样）服从高斯分布的假设下，推导两个热力学状态 $A$ 和 $B$ 之间的无量纲亥姆霍兹自由能差 $\\beta \\Delta F$。推导过程将首先使用基本的自由能微扰（FEP）公式，然后证明该结果与二阶矩量展开式完全相同，而后者对于高斯分布是精确的。\n\n设系统处于恒定温度 $T$，其中 $\\beta = (k_B T)^{-1}$，$k_B$ 是玻尔兹曼常数。一个状态的亥姆霍兹自由能 $F$ 与其正则配分函数 $Z$ 通过表达式 $F = -\\frac{1}{\\beta} \\ln Z$ 相关联。具有势能 $U(x)$ 的状态的配分函数由对所有相空间坐标 $x$ 的积分给出：\n$$Z = \\int \\exp(-\\beta U(x)) dx$$\n因此，自由能差 $\\Delta F = F_B - F_A$ 可以写为：\n$$\\Delta F = F_B - F_A = \\left(-\\frac{1}{\\beta} \\ln Z_B\\right) - \\left(-\\frac{1}{\\beta} \\ln Z_A\\right) = -\\frac{1}{\\beta} \\ln\\left(\\frac{Z_B}{Z_A}\\right)$$\n无量纲自由能变化为 $\\beta \\Delta F = -\\ln(Z_B / Z_A)$。\n\nFEP方法的核心在于计算配分函数之比 $Z_B/Z_A$：\n$$\\frac{Z_B}{Z_A} = \\frac{\\int \\exp(-\\beta U_B(x)) dx}{\\int \\exp(-\\beta U_A(x)) dx}$$\n使用定义 $\\Delta U(x) = U_B(x) - U_A(x)$，我们可以将 $U_B(x)$ 重写为 $U_A(x) + \\Delta U(x)$。将其代入分子得到：\n$$\\frac{Z_B}{Z_A} = \\frac{\\int \\exp(-\\beta [U_A(x) + \\Delta U(x)]) dx}{Z_A} = \\frac{\\int \\exp(-\\beta \\Delta U(x)) \\exp(-\\beta U_A(x)) dx}{Z_A}$$\n右侧的表达式是在参考态 $A$ 上对量 $\\exp(-\\beta \\Delta U(x))$ 进行正则系综平均的定义。在状态 $A$ 中观察到构象 $x$ 的概率密度为 $p_A(x) = \\exp(-\\beta U_A(x)) / Z_A$。因此，系综平均为：\n$$\\langle \\exp(-\\beta \\Delta U) \\rangle_A = \\int \\exp(-\\beta \\Delta U(x)) p_A(x) dx = \\frac{\\int \\exp(-\\beta \\Delta U(x)) \\exp(-\\beta U_A(x)) dx}{Z_A}$$\n因此，我们得到了基本的 FEP 方程（也称为 Zwanzig 公式）：\n$$\\frac{Z_B}{Z_A} = \\langle \\exp(-\\beta \\Delta U) \\rangle_A$$\n于是，无量纲自由能变化为：\n$$\\beta \\Delta F = -\\ln \\langle \\exp(-\\beta \\Delta U) \\rangle_A$$\n问题陈述，从状态 $A$ 采样的随机变量 $\\Delta U$ 服从均值为 $\\mu$、方差为 $\\sigma^2$ 的正态分布，即 $\\Delta U \\sim \\mathcal{N}(\\mu, \\sigma^2)$。系综平均 $\\langle \\exp(-\\beta \\Delta U) \\rangle_A$ 是函数 $\\exp(-\\beta \\Delta U)$ 关于此高斯分布的期望值。这恰好是随机变量 $\\Delta U$ 的矩量生成函数（MGF），记为 $M_{\\Delta U}(t) = \\langle \\exp(t \\Delta U) \\rangle_A$，在 $t = -\\beta$ 处取值。\n\n对于一个普遍的正态分布 $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$，其 MGF 已知为：\n$$M_X(t) = \\exp\\left(\\mu t + \\frac{1}{2} \\sigma^2 t^2\\right)$$\n将此应用于我们的变量 $\\Delta U$，我们在 $t = -\\beta$ 处计算 MGF：\n$$\\langle \\exp(-\\beta \\Delta U) \\rangle_A = M_{\\Delta U}(-\\beta) = \\exp\\left(\\mu(-\\beta) + \\frac{1}{2}\\sigma^2(-\\beta)^2\\right) = \\exp\\left(-\\beta\\mu + \\frac{1}{2}\\beta^2\\sigma^2\\right)$$\n将此结果代回 $\\beta \\Delta F$ 的表达式中：\n$$\\beta \\Delta F = -\\ln\\left[\\exp\\left(-\\beta\\mu + \\frac{1}{2}\\beta^2\\sigma^2\\right)\\right]$$\n$$\\beta \\Delta F = - \\left(-\\beta\\mu + \\frac{1}{2}\\beta^2\\sigma^2\\right) = \\beta\\mu - \\frac{1}{2}\\beta^2\\sigma^2$$\n这是在 $\\Delta U$ 服从高斯分布的假设下的精确自由能差。\n\n接下来，我们证明该结果等于二阶矩量展开。自由能的矩量展开源自矩量生成函数（CGF）$K_{\\Delta U}(t)$，其定义为 MGF 的自然对数：\n$$K_{\\Delta U}(t) = \\ln(M_{\\Delta U}(t))$$\n自由能可以用 CGF 表示为：\n$$\\beta \\Delta F = -\\ln(M_{\\Delta U}(-\\beta)) = -K_{\\Delta U}(-\\beta)$$\nCGF 有一个关于矩量 $\\kappa_n$ 的通用级数展开：\n$$K_{\\Delta U}(t) = \\sum_{n=1}^{\\infty} \\frac{\\kappa_n t^n}{n!}$$\n因此，自由能展开为：\n$$\\beta \\Delta F = - \\sum_{n=1}^{\\infty} \\frac{\\kappa_n (-\\beta)^n}{n!} = \\sum_{n=1}^{\\infty} \\frac{(-1)^{n+1} \\kappa_n \\beta^n}{n!} = \\kappa_1 \\beta - \\frac{\\kappa_2 \\beta^2}{2} + \\frac{\\kappa_3 \\beta^3}{6} - \\dots$$\n前两个矩量分别是均值和方差：\n$\\kappa_1 = \\langle \\Delta U \\rangle_A = \\mu$\n$\\kappa_2 = \\langle (\\Delta U - \\mu)^2 \\rangle_A = \\sigma^2$\n将矩量展开截断至二阶（即只保留到 $n=2$ 的项）得到：\n$$(\\beta \\Delta F)_{\\text{2nd-order}} \\approx \\mu \\beta - \\frac{\\sigma^2 \\beta^2}{2}$$\n此表达式与先前推导的精确结果完全相同。此等式成立的原因是高斯分布的一个定义性质。对于高斯变量 $\\Delta U \\sim \\mathcal{N}(\\mu, \\sigma^2)$，其 CGF 不是一个无穷级数，而是一个有限多项式：\n$$K_{\\Delta U}(t) = \\ln(M_{\\Delta U}(t)) = \\ln\\left(\\exp\\left(\\mu t + \\frac{1}{2}\\sigma^2 t^2\\right)\\right) = \\mu t + \\frac{1}{2}\\sigma^2 t^2$$\n通过比较 $K_{\\Delta U}(t)$ 的通用级数展开与这个精确形式，我们可以通过匹配 $t$ 的幂次系数来确定矩量：\n$\\kappa_1/1! = \\mu \\implies \\kappa_1 = \\mu$\n$\\kappa_2/2! = \\sigma^2/2 \\implies \\kappa_2 = \\sigma^2$\n$\\kappa_n/n! = 0$ for all $n  2 \\implies \\kappa_n = 0$ for all $n  2$.\n由于对于高斯分布，所有高于二阶的矩量都精确为零，因此矩量展开级数在第二项之后就精确终止了。因此，对于任何真正服从高斯分布的随机变量，二阶截断不是一个近似，而是一个精确的恒等式。\n\n结论是，在 $\\Delta U$ 的高斯模型下，精确的自由能由与二阶矩量展开相同的表达式给出。这个等式证明了在物理上合理的体系（例如谐振或近谐振体系）中使用高斯近似的合理性。在这种情况下，中心极限定理表明，能量差的许多微小、独立的贡献之和将趋向于高斯分布。自由能差的计算因此得到极大简化，仅需要计算能量差分布的均值和方差，即前两个矩。\n无量纲自由能变化的最终表达式用 $\\mu$、$\\sigma^2$ 和 $\\beta$ 表示。",
            "answer": "$$\\boxed{\\beta \\mu - \\frac{1}{2} \\beta^2 \\sigma^2}$$"
        },
        {
            "introduction": "从理想化的理论模型转向复杂的实际应用，是每个计算科学家的必经之路。这项练习将你置于一个“同行评审”的角色，要求你批判性地评估一个用于计算绝对结合自由能的、存在多处方法学缺陷的模拟方案。通过识别诸如相空间重叠不足、热力学循环不完整和终点奇异性等问题，你将学会将在理论学习中掌握的原则应用于评估真实世界研究的严谨性，从而培养至关重要的科学判断力。",
            "id": "2455870",
            "problem": "最近一篇论文报道了，使用单步自由能微扰（FEP）方案，为一个大的、柔性的、类药物配体与蛋白质结合计算的“绝对”结合自由能。作者们在正则系综（NVT）下，使用 $2\\ \\mathrm{fs}$ 的时间步长，在一个显式溶剂盒子中对蛋白质-配体复合物进行了 $5\\ \\mathrm{ns}$ 的模拟，温度为 $T=300\\ \\mathrm{K}$。Lennard-Jones 相互作用在 $1.0\\ \\mathrm{nm}$ 的球形截断半径处被截断，且没有长程色散校正；静电作用在周期性边界条件下使用粒子网格埃瓦尔德（PME）方法处理。配体在一个步骤中被炼金术般地“关闭”：其与环境的非键相互作用被移除，所报道的自由能是使用 Zwanzig 指数平均公式计算的\n\n$$\n\\Delta G_{0\\to 1} \\;=\\; -k_{\\mathrm{B}}T \\,\\ln \\left\\langle \\exp\\!\\left[-\\beta\\big(U_{1}-U_{0}\\big)\\right]\\right\\rangle_{0},\n$$\n\n其中 $\\beta=1/(k_{\\mathrm{B}}T)$，$U_{0}$ 是完全相互作用的结合复合物的势能，$U_{1}$ 是当配体与其环境完全解耦时的势能，$\\langle\\cdot\\rangle_{0}$ 表示对从 $U_{0}$ 采样的构象进行的系综平均。计算中没有使用中间耦合参数，没有对范德华相互作用应用软核修正，并且只评估了正向 $0\\to 1$ 的过程。在解耦过程中，配体的净电荷变化了 $+1e$；没有添加显式的抗衡离子（依赖于 PME 的均匀中和背景电荷）。没有施加位置或朝向约束以将解耦的配体保持在结合位点中，并且在通过 $\\Delta G^{\\circ}=RT\\ln K_{\\mathrm{d}}$ 将 $\\Delta G$ 转换为解离常数时没有添加标准态校正。作者们没有进行溶剂“分支”（即配体在体相水中的解耦）的计算，并且没有报告不确定性或收敛性诊断。\n\n考虑到所描述的方法，以下哪些批评在科学上是合理的？选择所有适用的选项。\n\nA. 对于一个大的、柔性的配体，从一个完全相互作用的状态到一个完全不相互作用的状态执行单步 FEP，很可能会因为相空间重叠差而导致指数平均 $-k_{\\mathrm{B}}T\\ln\\langle e^{-\\beta\\Delta U}\\rangle$ 在没有中间态的情况下不稳定且有偏。\n\nB. 忽略对结合位点中配体的约束以及相关的标准态校正会使绝对结合自由能产生偏差，因为一个解耦的配体可以自由平移和旋转；必须包含约束自由能和 $\\Delta G^{\\circ}$ 校正。\n\nC. 在有限周期性盒子中使用 PME 时，将净电荷改变 $+1e$ 会由于均匀中和背景电荷和镜像相互作用而引入有限尺寸效应；需要进行净电荷校正，忽略该校正会使 $\\Delta G$ 产生偏差。\n\nD. 只计算复合物“分支”（配体在蛋白质结合位点中的解耦）不足以得到绝对结合自由能；一个热力学循环需要将复合物分支与溶剂分支（配体在水中的解耦）以及约束和标准态项结合起来。\n\nE. 使用正则（NVT）系综而非等温等压（NPT）系综必然会使 FEP 计算出的结合自由能无效，因此所报告的值根本上是无意义的。\n\nF. 在没有软核势的情况下，在单一步骤中关闭 Lennard-Jones 相互作用，当原子重叠时可能导致端点奇点和巨大的力尖峰，从而造成数值不稳定和严重偏差。\n\nG. PME 静电学方法不适用于炼金术转换，因此会使任何此类结合自由能的计算结果都不可靠。\n\nH. 仅依赖正向指数估计器，而没有进行反向计算或使用 Bennett 接受率（BAR）或跨多个中间态的多态 BAR（MBAR），会带来巨大的偏差风险，并缺乏稳健的不确定性量化。",
            "solution": "问题陈述描述了一个旨在确定配体与蛋白质的绝对结合自由能的计算实验。这个问题是对计算化学中自由能计算理论和实践知识的有效检验。所描述的方法充满了严重的错误，任务是识别所提供的批评中哪些在科学上是合理的。我现在将逐一评估每个批评。\n\n计算的核心是 Zwanzig 公式，或称自由能微扰（FEP）：\n$$\n\\Delta G_{0\\to 1} \\;=\\; -k_{\\mathrm{B}}T \\,\\ln \\left\\langle \\exp\\!\\left[-\\beta\\big(U_{1}-U_{0}\\big)\\right]\\right\\rangle_{0}\n$$\n其中状态 0 是完全相互作用的蛋白质-配体复合物，状态 1 是配体的非键相互作用被炼金术般“关闭”的体系。\n\nA. 对于一个大的、柔性的配体，从一个完全相互作用的状态到一个完全不相互作用的状态执行单步 FEP，很可能会因为相空间重叠差而导致指数平均 $-k_{\\mathrm{B}}T\\ln\\langle e^{-\\beta\\Delta U}\\rangle$ 在没有中间态的情况下不稳定且有偏。\n这个批评是**正确的**。FEP 公式的有效性取决于参考态（状态 0）的系综与目标态（状态 1）的相空间有足够的重叠。当两个状态差异很大时，例如湮灭一个大配体的所有非键相互作用时，对于从状态 0 采样的几乎所有构象，势能差 $\\Delta U = U_1 - U_0$ 将会非常大且为正。指数平均 $\\langle e^{-\\beta\\Delta U} \\rangle_{0}$ 会被 $\\Delta U$ 值很小的极端罕见构象所主导。一个 5 ns 的有限模拟极不可能充分采样到这些关键构象。这会导致系统性的欠采样问题，从而使得计算出的 $\\Delta G$ 具有巨大的统计误差（方差）和显著的系统误差（偏差）。标准且必要的过程是将转换分解为多个更小的步骤（例如，使用由耦合参数 $\\lambda$ 定义的中间态），以确保相邻步骤之间有足够的相空间重叠。\n\nB. 忽略对结合位点中配体的约束以及相关的标准态校正会使绝对结合自由能产生偏差，因为一个解耦的配体可以自由平移和旋转；必须包含约束自由能和 $\\Delta G^{\\circ}$ 校正。\n这个批评是**正确的**。目标是“绝对”结合自由能，它对应于标准结合自由能 $\\Delta G^{\\circ}$。这个值与标准条件（例如 1 M 浓度）下的平衡常数 $K_d$ 或 $K_a$ 相关。原始的炼金术计算得到的是将配体从其结合态转移到一个仍然被限制在蛋白质结合位点内的不相互作用状态的自由能。为了将其与 $\\Delta G^{\\circ}$ 联系起来，需要一个严谨的方案。这包括对配体施加位置和朝向约束，计算在这些约束下的自由能变化，然后解析地计算并加上将这些约束释放到标准态体积（$V^\\circ$，对应于 1 M）所需的自由能。通过忽略约束，配体的最终状态是未明确定义的（它在口袋内的一个未知体积中采样），并且通过忽略标准态校正，所得的数值无法有意义地转换或与实验解离常数进行比较。\n\nC. 在有限周期性盒子中使用 PME 时，将净电荷改变 $+1e$ 会由于均匀中和背景电荷和镜像相互作用而引入有限尺寸效应；需要进行净电荷校正，忽略该校正会使 $\\Delta G$ 产生偏差。\n这个批评是**正确的**。用于计算周期性体系中静电相互作用的粒子网格埃瓦尔德（PME）方法假定整个模拟盒子是电中性的。如果体系有净电荷，PME 会隐式地添加一个均匀的背景电荷（中和等离子体）以维持电中性。这会由于电荷与其自身的周期性镜像以及这个背景电荷的相互作用，而引入一个与体系尺寸相关的人为能量项。当炼金术转换改变体系的净电荷时（如此处所述的 +1e），这种效应不会被抵消。它会给计算出的自由能差引入显著的误差。存在成熟的校正方案来估计和移除这种有限尺寸效应。对于改变电荷的转换忽略这样的校正是严重的方法学错误。\n\nD. 只计算复合物“分支”（配体在蛋白质结合位点中的解耦）不足以得到绝对结合自由能；一个热力学循环需要将复合物分支与溶剂分支（配体在水中的解耦）以及约束和标准态项结合起来。\n这个批评是**正确的**。绝对结合自由能 $\\Delta G_{bind}^\\circ$ 对应于将一个配体从体相溶剂转移到蛋白质的结合位点。这个过程不是直接模拟的。取而代之的是，构建一个热力学循环：\n$$\n\\begin{array}{ccc} \\text{复合物(aq)}  \\xrightarrow{\\Delta G_{\\text{bind}}^\\circ}  \\text{蛋白质(aq) + 配体(aq)} \\\\ \\downarrow \\Delta G_{\\text{complex}}   \\downarrow \\Delta G_{\\text{solvent}} \\\\ \\text{蛋白质(aq) + “虚拟”配体(在位点中)}  \\xrightarrow{\\approx 0}  \\text{蛋白质(aq) + “虚拟”配体(在溶剂中)} \\end{array}\n$$\n从这个循环可知，$\\Delta G_{\\text{bind}}^\\circ = \\Delta G_{\\text{solvent}} - \\Delta G_{\\text{complex}}$。问题陈述中描述的计算只计算了这个循环的一部分，即“复合物分支”($\\Delta G_{\\text{complex}}$)。如果不计算“溶剂分支”($\\Delta G_{\\text{solvent}}$)，即同一个配体在体相水中解耦的自由能，就不可能确定结合自由能。将复合物分支的值单独报告为绝对结合自由能是对该方法的根本性误解。\n\nE. 使用正则（NVT）系综而非等温等压（NPT）系综必然会使 FEP 计算出的结合自由能无效，因此所报告的值根本上是无意义的。\n这个批评是**不正确的**。FEP 计算可以在不同的统计系综中进行。在 NVT 系综中，结果是亥姆霍兹自由能差 $\\Delta A$。在 NPT 系综中，结果是吉布斯自由能差 $\\Delta G$。两者通过 $\\Delta G = \\Delta A + P\\Delta V$ 相关联。对于凝聚相生物分子体系，配体结合或解耦时的体积变化 $\\Delta V$ 通常非常小，使得 $P\\Delta V$ 项与其他误差来源相比可以忽略不计。虽然 NPT 系综在理论上更适合与通常在恒压下进行的实验进行比较，但使用 NVT 系综是一种常见且通常合理的近似。声称它“必然使”结果无效是一种夸张的说法。所描述的其他错误（A, B, C, D, F, H）要严重得多。\n\nF. 在没有软核势的情况下，在单一步骤中关闭 Lennard-Jones 相互作用，当原子重叠时可能导致端点奇点和巨大的力尖峰，从而造成数值不稳定和严重偏差。\n这个批评是**正确的**。Lennard-Jones 势有一个强排斥的 $r^{-12}$ 项，当原子间距离 $r \\to 0$ 时会发散。当炼金术般地湮灭一个粒子时，其相互作用被关闭。在逆向过程（创生）中，人们会从一个粒子是无相互作用的“虚拟”原子的状态中采样构象。这个虚拟原子可能会漂移到一个与环境中某个原子发生空间冲突的位置。为这种构象评估完全相互作用的势能会产生近乎无限的能量和力，这个问题被称为“端点奇点”。软核势是一种标准技术，用于在短程范围内修改势能以防止这种发散，并使自由能计算稳定和收敛。试图在没有软核势的情况下单步关闭 LJ 相互作用是极具问题的，并且可能导致模拟崩溃，或者充其量由于这些高能事件而得到一个偏差大到无可救药的结果。\n\nG. PME 静电学方法不适用于炼金术转换，因此会使任何此类结合自由能的计算结果都不可靠。\n这个批评是**不正确的**。这是一个错误且过于宽泛的概括。PME 是处理周期性模拟中长程静电相互作用的标准、最先进的方法，包括用于炼金术自由能计算的模拟。虽然它有已知的效应必须被正确处理（如批评 C 中所述），但该方法本身并非“不适用”。文献中绝大多数可靠的 FEP 研究都使用 PME。\n\nH. 仅依赖正向指数估计器，而没有进行反向计算或使用 Bennett 接受率（BAR）或跨多个中间态的多态 BAR（MBAR），会带来巨大的偏差风险，并缺乏稳健的不确定性量化。\n这个批评是**正确的**。正向 FEP 估计器（Zwanzig 公式）已知是有偏的，尤其是在相空间重叠很差时。它收敛非常慢，并且没有提供对其自身有效性的内部检查。现代自由能计算的最佳实践要求使用统计上更稳健的估计器。Bennett 接受率（BAR）方法结合了正向（$0 \\to 1$）和反向（$1 \\to 0$）模拟的数据，以在给定的模拟时间内提供偏差最小和方差最小的自由能估计。正向和反向估计之间的差异也可以作为一种有用的、尽管不完美的收敛性诊断。仅仅依赖单向的 Zwanzig 公式是不好的做法，可能会产生有偏的结果，并且没有提供可靠的方法来评估计算的统计不确定性或系统误差。",
            "answer": "$$\\boxed{ABCDF H}$$"
        }
    ]
}