{
    "hands_on_practices": [
        {
            "introduction": "任何TDDFT计算的第一步都是设定可靠的模拟参数。本练习将指导您如何基于第一性原理，为实空间TDDFT模拟推导并选择两个最关键的参数：网格间距和模拟区域尺寸。通过将德布罗意波长和波函数渐进行为等基本物理概念与计算需求联系起来，您将深刻理解如何确保计算结果的数值收敛性和物理精确性。",
            "id": "2682991",
            "problem": "要求您为中性钠原子的实空间、有限差分、含时密度泛函理论 (TDDFT) 模拟设计数值参数，以使线性光吸收谱在达到目标光子能量时收敛。您的任务是推导、论证并实现两个关键参数的公式：均匀网格间距和最小球形模拟盒子半径，以确保边界效应和离散化误差在达到目标能量尺度之前不会污染光谱。\n\n您的推导必须仅基于物理化学中适用于含时密度泛函理论的基本定律和核心定义，包括非相对论性不含时薛定谔方程、自由粒子色散关系、德布罗意波长、采样定理、束缚态轨道在有效势垒外的渐近指数衰减，以及广为接受的物理常数。请勿假定任何专用代码或预先推导的“黑箱”公式。您必须从第一性原理出发，论证以下建模选择：\n- 空间分辨率要求：要求在与最高动能相关的每个空间振荡（德布罗意波长）内，至少有最小数量的网格点，该最高动能是为了解析达到目标光子能量的线性响应所必需的。\n- 有限模拟域要求：要求在模拟域的边界处，渐近束缚态价轨道的振幅受用户指定的容差限制，并使用电离势来设定衰减尺度。\n\n假设所有计算均以原子单位进行，但输入的目标能量以电子伏特给出。使用以下常数：\n- 钠的电离势：$I_{\\mathrm{p}} = 5.139\\ \\mathrm{eV}$。\n- 一哈特里（Hartree）对应的电子伏特：$1\\ \\mathrm{Ha} = 27.211386245988\\ \\mathrm{eV}$。\n\n您必须使用的定义和建模假设：\n- 对于达到目标光子能量 $E_{\\max}$ 的线性光吸收，必须表示的最高动能由与 $E_{\\max}$ 对应的自由电子动能给出，并以哈特里（Hartree）为单位表示。\n- 必须使用动能与波数之间的自由粒子关系以及采样定理来设置网格间距，以确保在由 $E_{\\max}$ 隐含的最高波数下，每个德布罗意波长至少有 $N_{\\mathrm{p}}$ 个网格点。\n- 对于中性原子，最高占据Kohn–Sham轨道的渐近振幅呈指数衰减，该衰减由电离势决定；使用此渐近形式选择一个最小球形半径 $R$，使得边界处的振幅不大于用户指定的无量纲容差 $\\varepsilon$。\n\n程序要求：\n- 对于每个测试用例，您的程序必须计算一个数对 $[h_{\\mathrm{bohr}}, R_{\\mathrm{bohr}}]$，其中 $h_{\\mathrm{bohr}}$ 是以玻尔（bohr）为单位的均匀网格间距，$R_{\\mathrm{bohr}}$ 是以玻尔（bohr）为单位的最小球形模拟盒子半径。\n- 所有长度必须以玻尔（bohr）为单位表示，并四舍五入到六位小数。\n- 角度（如果在您的推导中出现）必须以弧度为单位。\n- 您的程序不得读取任何输入，并且必须生成单行输出，其中包含所有测试用例的有序结果列表，格式为不带空格的列表的列表，例如 $[[h_1,R_1],[h_2,R_2],\\dots]$。\n\n测试套件：\n每个测试用例是一个三元组 $(E_{\\max}^{(\\mathrm{eV})}, N_{\\mathrm{p}}, \\varepsilon)$。\n1. $(10.0, 10, 1\\times 10^{-6})$\n2. $(10.0, 12, 1\\times 10^{-8})$\n3. $(10.0, 2, 1\\times 10^{-3})$\n4. $(8.0, 10, 1\\times 10^{-6})$\n5. $(12.0, 10, 1\\times 10^{-6})$\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔结果列表，每个元素是相应测试用例的数对 $[h_{\\mathrm{bohr}}, R_{\\mathrm{bohr}}]$，例如 $[[h_1,R_1],[h_2,R_2],[h_3,R_3],[h_4,R_4],[h_5,R_5]]$。",
            "solution": "所提出的问题陈述已经过验证，并被认定为有效。它具有科学依据、提法得当、客观且内部一致。该问题提出了一个计算物理化学领域的标准可解问题，涉及基于基本原理建立数值模拟。我们现在开始推导所需参数。\n\n所有推导和计算都将在原子单位（a.u.）中进行，其中约化普朗克常数 $\\hbar$、电子质量 $m_e$ 和元电荷 $e$ 均等于 $1$。在此单位系统中，能量以哈特里（Hartree, $Ha$）计量，距离以玻尔（Bohr, $a_0$）计量。所提供的以其他单位给出的输入参数必须进行相应转换。电子伏特（$eV$）与哈特里（$Ha$）之间的转换因子为 $1\\ \\mathrm{Ha} = C_{\\mathrm{Ha/eV}} \\ \\mathrm{eV}$，其中 $C_{\\mathrm{Ha/eV}} = 27.211386245988$。\n\n首先，我们推导均匀网格间距 $h$ 的公式。\n问题要求数值网格必须足够精细，以表示吸收了能量最高达 $E_{\\max}$ 的光子后的电子动力学。问题明确指出，必须精确表示的最高动能 $T_{\\max}$ 等于此最大光子能量。设 $E_{\\max}^{(\\mathrm{eV})}$ 是以电子伏特为单位的输入能量。我们首先将其转换为哈特里：\n$$ E_{\\max}^{(\\mathrm{Ha})} = \\frac{E_{\\max}^{(\\mathrm{eV})}}{C_{\\mathrm{Ha/eV}}} $$\n因此，我们将需要解析的最大动能设置为：\n$$ T_{\\max} = E_{\\max}^{(\\mathrm{Ha})} $$\n在原子单位中，自由粒子的动能 $T$ 与波数 $k$ 之间的关系由色散关系给出：\n$$ T = \\frac{k^2}{2} $$\n由此，我们可以求出与 $T_{\\max}$ 对应的最大波数 $k_{\\max}$：\n$$ k_{\\max} = \\sqrt{2 T_{\\max}} = \\sqrt{2 E_{\\max}^{(\\mathrm{Ha})}} $$\n德布罗意波长 $\\lambda$ 通过 $\\lambda = 2\\pi/k$ 与波数 $k$ 相关。因此，需要解析的最小波长 $\\lambda_{\\min}$ 对应于 $k_{\\max}$：\n$$ \\lambda_{\\min} = \\frac{2\\pi}{k_{\\max}} = \\frac{2\\pi}{\\sqrt{2 E_{\\max}^{(\\mathrm{Ha})}}} $$\n采样定理规定，要在离散网格上表示波长为 $\\lambda_{\\min}$ 的波，需要一个网格间距 $h$，该间距是 $\\lambda_{\\min}$ 的一小部分。问题指定了一个分辨率标准，即每个波长至少有 $N_{\\mathrm{p}}$ 个网格点。为了找到满足此条件的最大允许网格间距，我们设定：\n$$ h = \\frac{\\lambda_{\\min}}{N_{\\mathrm{p}}} $$\n代入 $\\lambda_{\\min}$ 的表达式，我们得到以玻尔为单位的网格间距 $h_{\\mathrm{bohr}}$ 的最终公式：\n$$ h_{\\mathrm{bohr}} = \\frac{2\\pi}{N_{\\mathrm{p}} \\sqrt{2 E_{\\max}^{(\\mathrm{Ha})}}} = \\frac{2\\pi}{N_{\\mathrm{p}} \\sqrt{2 \\frac{E_{\\max}^{(\\mathrm{eV})}}{C_{\\mathrm{Ha/eV}}}}} $$\n\n接下来，我们推导最小球形模拟盒子半径 $R$ 的公式。\n模拟盒子必须足够大，以包含束缚态的电子密度，且截断误差可以忽略。问题指示我们基于最高占据Kohn-Sham轨道的渐近衰减来确定。对于能量为 $E = -I_{\\mathrm{p}}$ 的束缚态，其中 $I_{\\mathrm{p}}$ 是电离势，在远离原子核处（势能消失的地方），不含时薛定谔方程的解呈指数衰减。在较大径向距离 $r$ 处的波函数 $\\psi(r)$ 表现为：\n$$ \\psi(r) \\sim e^{-\\alpha r} $$\n衰减常数 $\\alpha$ 由结合能决定。在势能 $V(r) \\approx 0$ 的区域中，能量为 $E$ 的状态的薛定谔方程的径向部分近似为 $\\frac{d^2\\psi}{dr^2} \\approx 2E\\psi$。当 $E=-I_{\\mathrm{p}}$ 时，这给出 $\\alpha^2 = 2 I_{\\mathrm{p}}^{(\\mathrm{Ha})}$，其中 $I_{\\mathrm{p}}^{(\\mathrm{Ha})}$ 是以哈特里为单位的电离势。因此，衰减常数为：\n$$ \\alpha = \\sqrt{2 I_{\\mathrm{p}}^{(\\mathrm{Ha})}} $$\n钠的电离势为 $I_{\\mathrm{p}}^{(\\mathrm{eV})} = 5.139\\ \\mathrm{eV}$。我们将其转换为哈特里：\n$$ I_{\\mathrm{p}}^{(\\mathrm{Ha})} = \\frac{I_{\\mathrm{p}}^{(\\mathrm{eV})}}{C_{\\mathrm{Ha/eV}}} = \\frac{5.139}{27.211386245988} $$\n问题要求在模拟盒子边界 $r = R$ 处的轨道振幅受无量纲容差 $\\varepsilon$ 的限制。我们通过将指数衰减因子本身设为等于 $\\varepsilon$ 来形式化此要求：\n$$ e^{-\\alpha R} = \\varepsilon $$\n这是一个标准准则，假设任何指前因子都为 1 的数量级。为了求解最小半径 $R$，我们对等式两边取自然对数：\n$$ -\\alpha R = \\ln(\\varepsilon) $$\n$$ R = -\\frac{\\ln(\\varepsilon)}{\\alpha} $$\n由于容差 $\\varepsilon$ 是一个小于 1 的小数，其对数为负，从而确保 $R$ 是一个正量。代入 $\\alpha$ 的表达式，我们得到以玻尔为单位的盒子半径 $R_{\\mathrm{bohr}}$ 的最终公式：\n$$ R_{\\mathrm{bohr}} = -\\frac{\\ln(\\varepsilon)}{\\sqrt{2 I_{\\mathrm{p}}^{(\\mathrm{Ha})}}} = -\\frac{\\ln(\\varepsilon)}{\\sqrt{2 \\frac{I_{\\mathrm{p}}^{(\\mathrm{eV})}}{C_{\\mathrm{Ha/eV}}}}} $$\n\n这些推导出的 $h_{\\mathrm{bohr}}$ 和 $R_{\\mathrm{bohr}}$ 公式在提供的程序中实现，用于计算给定测试用例所需的模拟参数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and calculates simulation parameters for TDDFT based on first principles.\n    \"\"\"\n    \n    # Constants provided in the problem statement.\n    # Ionization potential of Sodium in eV.\n    IP_NA_EV = 5.139\n    # Conversion factor from Hartree to eV.\n    HARTREE_TO_EV = 27.211386245988\n    \n    # Convert Sodium IP to a.u.\n    ip_na_ha = IP_NA_EV / HARTREE_TO_EV\n\n    # Test suite from the problem statement.\n    # Each case is a tuple: (E_max_eV, N_p, epsilon)\n    test_cases = [\n        (10.0, 10, 1e-6),\n        (10.0, 12, 1e-8),\n        (10.0, 2, 1e-3),\n        (8.0, 10, 1e-6),\n        (12.0, 10, 1e-6),\n    ]\n\n    results = []\n    for case in test_cases:\n        e_max_ev, n_p, epsilon = case\n\n        # 1. Calculate the uniform grid spacing, h (in Bohr).\n        # Convert max energy from eV to Hartree.\n        e_max_ha = e_max_ev / HARTREE_TO_EV\n        # Derivation: h = (2*pi) / (N_p * k_max) where k_max = sqrt(2 * T_max)\n        # T_max is assumed to be e_max_ha.\n        # h = (2*pi) / (N_p * sqrt(2 * e_max_ha))\n        h_bohr = (2 * np.pi) / (n_p * np.sqrt(2 * e_max_ha))\n\n        # 2. Calculate the minimal spherical simulation box radius, R (in Bohr).\n        # Derivation: R = -ln(epsilon) / alpha where alpha = sqrt(2 * I_p)\n        # R = -ln(epsilon) / sqrt(2 * ip_na_ha)\n        r_bohr = -np.log(epsilon) / np.sqrt(2 * ip_na_ha)\n\n        # Format results to six decimal places, as required.\n        h_formatted = f\"{h_bohr:.6f}\"\n        r_formatted = f\"{r_bohr:.6f}\"\n        \n        results.append(f\"[{h_formatted},{r_formatted}]\")\n\n    # Final print statement in the exact required format: [[h1,R1],[h2,R2],...]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在运行TDDFT计算后，解读其输出是关键一步，而反直觉的结果往往蕴含着重要信息。本练习聚焦于一个常见的“异常”现象：计算得到负的激发能。您将学习到，这并非数值错误，而是一个重要的诊断信号，揭示了所选的参考基态（如此处使用的自旋限制闭壳层单重态）存在不稳定性，意味着体系的真正基态具有更低的能量。",
            "id": "1417491",
            "problem": "一名本科生研究员正在研究一种已知具有显著双自由基特征的分子的电子性质。他首先使用密度泛函理论（DFT）和自旋限制形式进行标准的基态计算，该形式假设所有电子在轨道中成对，从而得到一个闭壳层单重态（$S_0$）。为了探究激发态，他们接着以这个自旋限制的 $S_0$ 态为参考态，进行了含时密度泛函理论（TD-DFT）计算。TD-DFT计算的输出报告称，最低的三重态（$T_1$）的激发能为-0.15 Hartree。\n\n基于这个看似不符合物理规律的负激发能结果，关于初始的基态DFT计算，最可能的结论是什么？\n\nA. DFT计算中使用的数值积分格点不够密集，导致了一个虚假的、非物理的结果，该结果在用更精细的格点重新计算后会消失。\n\nB. 所选的基组不足以描述三重态，导致其能量被人为地降低到基态能量之下。需要使用一个大得多的基组。\n\nC. 对于该分子，采用自旋限制形式是一个不正确的假设。真实的基态能量低于计算出的自旋限制单重态，并且这个能量更低的状态可能具有三重态或开壳层特征。\n\nD. TD-DFT方法从根本上无法描述任何分子体系的三重态，而负能量是这种理论局限性造成的一种常见假象。",
            "solution": "这个问题的核心在于理解激发能的含义以及含时密度泛函理论（TD-DFT）是如何计算它的。\n\n1.  **激发能的定义**：在量子力学中，激发能（$\\Delta E$）是激发态与基态之间的能量差。根据定义，基态是一个体系的最低能量状态。因此，对于一个物理上真实的过程，激发能必须为正：\n    $$\n    \\Delta E = E_{\\text{excited}} - E_{\\text{ground}} \\ge 0\n    $$\n    负的激发能意味着所谓的“激发态”实际上比被假定为“基态”的状态能量更低。\n\n2.  **TD-DFT的背景**：TD-DFT是一种计算激发态性质的方法。它基于一个参考态进行计算，这个参考态通常是用标准的密度泛函理论（DFT）计算出的基态。然后，激发态的能量是*相对于*这个DFT参考态计算的。在这个问题中，参考态是一个自旋限制的闭壳层单重态，我们可以将其表示为 $E(S_0, \\text{restricted})$。\n\n3.  **分析结果**：TD-DFT计算得出了最低三重态（$T_1$）的负激发能。我们将这个能量称为 $\\Delta E(T_1)$。根据TD-DFT的原理，这意味着：\n    $$\n    \\Delta E(T_1) = E(T_1) - E(S_0, \\text{restricted})  0\n    $$\n    这可以重新排列为：\n    $$\n    E(T_1)  E(S_0, \\text{restricted})\n    $$\n    这个不等式表明，计算出的三重态（$T_1$）的能量低于用作参考态的自旋限制单重态（$S_0$）的能量。\n\n4.  **物理解释**：TD-DFT中的负激发能实际上并非“不符合物理规律”。相反，它是一个诊断工具，揭示了参考态DFT计算中的不稳定性。它表明参考态 $E(S_0, \\text{restricted})$ *不是*体系的真实基态。由于自旋限制形式的约束（强制所有电子成对），计算被强制收敛到一个能量更高的解。存在另一个能量更低的电子构型——在这种情况下，是一个具有三重态特征的构型。这对于具有双自由基特征的分子来说是常见现象，其最低能量的单重态通常是开壳层单重态，而三重态的能量可能非常接近甚至低于被不恰当描述的闭壳层单重态的能量。TD-DFT的负激发能是参考态这种所谓的“三重态不稳定性”的标志。\n\n5.  **评估选项**：\n    *   **A. 数值积分格点：**虽然不良的格点可能导致数值噪音和收敛问题，但它不是导致像负激发能这样定性错误结果的根本原因。这种特定的假象是参考态稳定性问题的公认指标，而不是一个简单的数值精度问题。\n    *   **B. 基组不充分：**不充分的基组可能导致所有态的能量不准确。然而，与格点问题类似，它通常不会表现为负激发能，除非它加剧了潜在的稳定性问题。主要原因是参考波函数本身的性质。\n    *   **C. 不正确的自旋限制形式：**这与我们的分析完全一致。负激发能是自旋限制单重态参考态的能量高于三重态的直接后果。这意味着基态是闭壳层单重态的假设是错误的，并且真实的基态可以由不同的电子构型（例如，开壳层或非限制构型）更好地描述。\n    *   **D. TD-DFT无法描述三重态：**这种说法过于绝对且不正确。TD-DFT，特别是在大多数代码中使用的绝热近似下，可以并且确实能计算三重态激发能。这里的问题不是TD-DFT的普遍失败，而是提供给TD-DFT计算的*输入参考态*的特定问题。该方法正确地诊断出了有缺陷的参考态。\n\n因此，最准确的结论是，自旋限制的DFT计算未能找到该分子的真实基态。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "即便计算设置无误且参考态稳定，绝热TDDFT方法本身也存在固有局限性，其中最著名的就是电荷转移（CT）激发问题。本练习将引导您从基本定义出发，构建一个最小模型来演示并量化这一问题。通过这个实践，您将深入理解为何标准的半局域泛函会严重低估长程CT激发能，并认识到其根源在于交换相关核的局域近似未能正确描述激发态中的长程库仑相互作用。",
            "id": "2466214",
            "problem": "要求您编写一个完整、可运行的程序，该程序在一个最小但具有科学依据的模型中，演示含时密度泛函理论 (TD-DFT) 如何在使用标准广义梯度近似 (GGA) 泛函时，错误地预测空间分离的给体-受体对中一个虚假的低能量电荷转移激发。您的程序必须从第一性原理出发实现以下逻辑。\n\n从密度泛函理论 (DFT) 中电离势和电子亲和能的基本定义，以及分离电荷的静电相互作用出发。使用这些原理推导一个表达式，用于计算大分离距离下最低的从给体到受体的电荷转移激发能。然后，利用线性响应 TD-DFT 以及对于空间不重叠的轨道，绝热半局域哈特里-交换-相关核产生的耦合可以忽略不计这一事实，推导出半局域 GGA 泛函所做的相应预测。最后，通过引入导数不连续性，将 Kohn–Sham 轨道能量差与基本带隙联系起来。在您的推导中，请勿使用或引用任何已有的简化公式；相反，仅从以下基本依据进行推理：\n- 基本定义：通过总能量差定义的电离势 $I$ 和电子亲和能 $A$，以及两个相距为 $R$ 的单位电荷之间的静电相互作用能。\n- 线性响应理论核心思想：激发能来自一个响应极点，该极点由一个无相互作用的跃迁能和一个耦合项决定；对于轨道重叠可忽略不计的空间分离片段之间的电荷转移，局域且绝热的核提供的长程耦合可忽略不计。\n- 经过充分检验的概念性事实：多体基本带隙通过导数不连续性与 Kohn–Sham 带隙相关联。\n\n实现一个最小的双片段模型，每个测试用例使用以下参数：\n- 给体电离势 $I_D$，单位为哈特里 (Hartree)。\n- 受体电子亲和能 $A_A$，单位为哈特里 (Hartree)。\n- 中心间距 $R$，单位为玻尔 (bohr)。\n- 一个有效的正值导数不连续性参数 $\\Delta_{\\mathrm{xc}}$，单位为哈特里 (Hartree)，该参数捕捉了半局域 GGA 泛函所特有的带隙低估特性。\n\n对于每个测试用例，计算：\n1. 基于上述原理的、具有物理意义的大分离距离电荷转移激发能，以哈特里 (Hartree) 表示，此处记为 $E_{\\mathrm{true}}$。\n2. 绝热半局域 GGA TD-DFT 对相同电荷转移激发的预测值，以哈特里 (Hartree) 表示，此处记为 $E_{\\mathrm{GGA}}$。\n3. 带符号误差 $\\Delta E = E_{\\mathrm{GGA}} - E_{\\mathrm{true}}$，单位为哈特里 (Hartree)。\n4. 一个布尔标志，当且仅当 GGA 预测值虚假地低时为真，定义为严格不等式 $E_{\\mathrm{GGA}}  E_{\\mathrm{true}}$。\n\n您的程序必须使用以下固定的参数元组 $(I_D,A_A,R,\\Delta_{\\mathrm{xc}})$ 测试套件，单位为原子单位（能量为哈特里，距离为玻尔）：\n- 测试 1 (一般分离对): $(0.30, 0.08, 30.0, 0.12)$。\n- 测试 2 (极大分离距离): $(0.30, 0.08, 200.0, 0.12)$。\n- 测试 3 (导致 GGA 激发能接近于零的小基本带隙): $(0.20, 0.08, 25.0, 0.12)$。\n- 测试 4 (数值平衡点，在该 $R$ 值下，低估值等于缺失的静电项): $(0.25, 0.05, 8.\\overline{3}, 0.12)$，其中 $8.\\overline{3}$ 表示 $25/3$ 玻尔。\n\n所有能量必须以哈特里表示，并四舍五入到六位小数。对于每个测试用例，您的程序必须按顺序输出 $E_{\\mathrm{true}}$、$E_{\\mathrm{GGA}}$、$\\Delta E$ 和布尔标志这四个值。将所有测试用例的结果汇总到一个扁平列表中。您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表形式的结果（例如，“[result1,result2,result3,...]”）。\n\n不涉及角度单位。不允许外部输入；程序必须是完全自包含的，并在执行时产生所需的单行输出。",
            "solution": "该问题陈述具有科学依据、问题定义良好，并包含了推导唯一解所需的所有信息。它描述了常见密度泛函近似的一种众所周知的失效模式。因此，该问题被认为是有效的，并将基于所提供的第一性原理构建一个解。\n\n我们首先推导物理上正确的、大分离距离下的电荷转移 ($CT$) 激发能的表达式，记为 $E_{\\mathrm{true}}$。一个 $CT$ 激发过程涉及将一个电子从相距为 $R$ 的给体分子 $D$ 移动到受体分子 $A$。该过程可以表示为 $D^0A^0 \\rightarrow D^+A^-$。此激发的能量 $\\omega_{CT}$ 是末态和初态总能量之差：\n$$ \\omega_{CT} = E(D^+A^-) - E(D^0A^0) $$\n在大分离距离 $R$ 的极限下，组合体系的能量可以近似为其无相互作用的组分片段的能量之和，再加上它们的经典静电相互作用能。对于初始中性态，其能量为：\n$$ E(D^0A^0) \\approx E(D^0) + E(A^0) $$\n对于最终离子态，其能量包括新形成的离子之间的静电吸引：\n$$ E(D^+A^-) \\approx E(D^+) + E(A^-) + E_{\\mathrm{int}} $$\n这里，$E(X)$ 表示物种 $X$ 的总能量。$D^+$ 上的 $+1e$ 点电荷与 $A^-$ 上的 $-1e$ 点电荷之间的相互作用能 $E_{\\mathrm{int}}$ 由库仑定律给出。在原子单位制中，能量单位为哈特里，距离单位为玻尔，该能量为：\n$$ E_{\\mathrm{int}} = -\\frac{1}{R} $$\n将这些表达式代入 $\\omega_{CT}$ 的方程，我们得到：\n$$ \\omega_{CT} \\approx \\left( E(D^+) + E(A^-) - \\frac{1}{R} \\right) - \\left( E(D^0) + E(A^0) \\right) $$\n按物种重新组合各项可得：\n$$ \\omega_{CT} \\approx \\left( E(D^+) - E(D^0) \\right) + \\left( E(A^-) - E(A^0) \\right) - \\frac{1}{R} $$\n括号中的项对应于基本定义。给体的电离势 $I_D$ 是移去一个电子所需的能量：\n$$ I_D = E(D^+) - E(D^0) $$\n受体的电子亲和能 $A_A$ 是捕获一个电子所释放的能量，定义为：\n$$ A_A = E(A^0) - E(A^-) $$\n根据这个定义，可得 $E(A^-) - E(A^0) = -A_A$。将 $I_D$ 和 $A_A$ 的定义代入，我们便得到了真实的大分离距离电荷转移激发能的表达式：\n$$ E_{\\mathrm{true}} = I_D - A_A - \\frac{1}{R} $$\n\n接下来，我们推导绝热半局域含时密度泛函理论 ($TD-DFT$) 的相应预测值，记为 $E_{\\mathrm{GGA}}$。在线性响应 $TD-DFT$ 中，激发能 $\\omega$ 作为矩阵方程的本征值获得。对于从一个已占据的 Kohn-Sham ($KS$) 轨道 $\\phi_i$ 到一个空的 $KS$ 轨道 $\\phi_a$ 的单次激发，其激发能在绝热近似下由下式给出：\n$$ \\omega_{ia} = \\varepsilon_a - \\varepsilon_i + K_{ia,ia} $$\n其中 $\\varepsilon_i$ 和 $\\varepsilon_a$ 是 $KS$ 轨道的能量，$K_{ia,ia}$ 是耦合矩阵元。该矩阵元依赖于哈特里-交换-相关 ($HXC$) 核 $f_{HXC}$：\n$$ K_{ia,ia} = \\iint \\phi_i^*(\\mathbf{r})\\phi_a(\\mathbf{r}) f_{HXC}(\\mathbf{r}, \\mathbf{r}') \\phi_a^*(\\mathbf{r}')\\phi_i(\\mathbf{r}') d\\mathbf{r} d\\mathbf{r}' $$\n对于我们所考虑的 $CT$ 激发，已占据轨道 $\\phi_i$ 是给体的最高已占分子轨道 ($HOMO_D$)，而空轨道 $\\phi_a$ 是受体的最低未占分子轨道 ($LUMO_A$)。在大分离距离 $R$ 下，这些轨道在空间上是孤立的，它们的重叠乘积 $\\phi_i(\\mathbf{r})\\phi_a(\\mathbf{r})$ 对于所有 $\\mathbf{r}$ 都是可以忽略的。\n对于像广义梯度近似 ($GGA$) 这样的半局域泛函，其核 $f_{HXC}^{GGA}(\\mathbf{r}, \\mathbf{r}')$ 是有效局域的，这意味着随着距离 $|\\mathbf{r} - \\mathbf{r}'|$ 的增加它会迅速消失。局域核与消失的轨道重叠相结合，导致耦合积分 $K_{ia,ia}$ 变为零：\n$$ K_{ia,ia}^{GGA} \\approx 0 $$\n因此，$TD-GGA$ 激发能虚假地简化为所涉及 $KS$ 轨道能量的简单差值：\n$$ E_{\\mathrm{GGA}} = \\omega_{CT}^{GGA} \\approx \\varepsilon_{LUMO,A} - \\varepsilon_{HOMO,D} $$\n为了使此表达式有用，我们必须将此 $KS$ 轨道能隙与物理量 $I_D$ 和 $A_A$ 联系起来。组合的 $D-A$ 体系的基本多体带隙为 $E_{gap} = I_D - A_A$。相应的 $KS$ 带隙为 $\\varepsilon_{gap}^{KS} = \\varepsilon_{LUMO,A} - \\varepsilon_{HOMO,D}$。对于一个精确泛函，这些量通过交换相关势的导数不连续性 $\\Delta_{xc}$ 相关联：\n$$ E_{gap} = \\varepsilon_{gap}^{KS} + \\Delta_{xc} \\implies I_D - A_A = (\\varepsilon_{LUMO,A} - \\varepsilon_{HOMO,D}) + \\Delta_{xc} $$\n像 $GGA$ 这样的近似泛函已知存在系统误差，该误差实际上对应于一个缺失的导数不连续性。问题提供了一个有效的参数 $\\Delta_{\\mathrm{xc}} > 0$ 来模拟这一缺陷。将在 $GGA$ 框架内预测的 $KS$ 带隙方程重新整理可得：\n$$ \\varepsilon_{LUMO,A}^{GGA} - \\varepsilon_{HOMO,D}^{GGA} = (I_D - A_A) - \\Delta_{\\mathrm{xc}} $$\n这就给出了 $TD-GGA$ 电荷转移激发能的最终表达式：\n$$ E_{\\mathrm{GGA}} = I_D - A_A - \\Delta_{\\mathrm{xc}} $$\n这个结果错误地显示激发能在大 $R$ 时趋于一个常数值，完全没有体现正确的 $-1/R$ 渐近行为。\n\n最后，我们计算带符号误差 $\\Delta E$，并建立虚假低预测的条件。误差是 $GGA$ 值与真实值之差：\n$$ \\Delta E = E_{\\mathrm{GGA}} - E_{\\mathrm{true}} = (I_D - A_A - \\Delta_{\\mathrm{xc}}) - \\left(I_D - A_A - \\frac{1}{R}\\right) $$\n$$ \\Delta E = \\frac{1}{R} - \\Delta_{\\mathrm{xc}} $$\n$GGA$ 预测值是虚假地低，当且仅当 $E_{\\mathrm{GGA}}  E_{\\mathrm{true}}$，这意味着 $\\Delta E  0$。这给出了条件：\n$$ \\frac{1}{R} - \\Delta_{\\mathrm{xc}}  0 \\implies \\frac{1}{R}  \\Delta_{\\mathrm{xc}} $$\n随着分离距离 $R$ 的增加，$1/R$ 减小。对于任何具有非零带隙低估误差 ($\\Delta_{\\mathrm{xc}} > 0$) 的体系，都存在一个分离距离，超过该距离此不等式即成立，这证明了绝热半局域泛函在描述长程电荷转移方面的根本性失效。下面的程序实现了这些推导出的公式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the true and TD-GGA charge-transfer excitation energies for a\n    series of donor-acceptor pairs to demonstrate the failure of semilocal DFT.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (I_D, A_A, R, delta_xc) in atomic units.\n    test_cases = [\n        # Test 1: General separated pair\n        (0.30, 0.08, 30.0, 0.12),\n        # Test 2: Very large separation\n        (0.30, 0.08, 200.0, 0.12),\n        # Test 3: Small fundamental gap\n        (0.20, 0.08, 25.0, 0.12),\n        # Test 4: Numerical balance point\n        (0.25, 0.05, 25.0/3.0, 0.12),\n    ]\n\n    results = []\n    for case in test_cases:\n        I_D, A_A, R, delta_xc = case\n        \n        # 1. Calculate the physically motivated charge-transfer energy, E_true.\n        # This is derived from E_true = I_D - A_A - 1/R.\n        E_true = I_D - A_A - 1.0/R\n        \n        # 2. Calculate the adiabatic semilocal GGA TD-DFT prediction, E_GGA.\n        # This is derived from E_GGA = I_D - A_A - delta_xc.\n        E_gga = I_D - A_A - delta_xc\n        \n        # 3. Calculate the signed error, delta_E.\n        # This is delta_E = E_GGA - E_true, which simplifies to 1/R - delta_xc.\n        delta_E = 1.0/R - delta_xc\n\n        # 4. Determine if the GGA prediction is spuriously low.\n        # This is true if E_GGA  E_true.\n        is_spurious = E_gga  E_true\n\n        # Append the four required results for this test case.\n        # Energies are rounded to six decimal places.\n        results.append(np.round(E_true, 6))\n        results.append(np.round(E_gga, 6))\n        results.append(np.round(delta_E, 6))\n        results.append(is_spurious)\n        \n    # Final print statement in the exact required format.\n    # The boolean `True`/`False` is converted to string \"True\"/\"False\".\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}