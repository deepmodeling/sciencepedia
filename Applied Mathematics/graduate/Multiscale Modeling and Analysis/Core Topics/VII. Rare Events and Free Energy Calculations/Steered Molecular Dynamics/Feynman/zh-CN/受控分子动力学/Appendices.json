{
    "hands_on_practices": [
        {
            "introduction": "成功的导向分子动力学（SMD）模拟通常始于将其参数正确地映射到真实世界的实验。这项实践将指导您完成在模拟中常见的约化Lennard-Jones单位与原子力显微镜（AFM）等实验中使用的标准国际单位（SI）之间进行单位转换的基本过程。通过执行此校准，您将掌握一项基础技能，用于设计不仅内部一致，而且具有物理意义并能与实验数据相比较的模拟。",
            "id": "3809071",
            "problem": "一个引导分子动力学（SMD）协议被用于通过一个附有虚拟弹簧的拉动手柄，拉动一个粗粒化配体穿过一个蛋白质通道。在模拟中，使用了约化的Lennard-Jones（LJ）单位，这些单位由特征长度 $\\sigma$、能量 $\\epsilon$ 和质量 $m$ 定义。虚拟弹簧遵循胡克定律 $F = k\\,\\Delta x$，其中 $k$ 的单位是力每单位长度。基本尺度如下：$\\sigma = 0.50\\,\\text{nm}$，在 $T=300\\,\\text{K}$ 时 $\\epsilon = 1.5\\,k_{B}T$，以及 $m = 72\\,\\text{u}$。模拟代码只接受以 $\\epsilon/\\sigma^{2}$ 为约化单位、按 $0.10$ 离散增量变化的虚拟弹簧刚度 $k$。用于校准该设置的原子力显微镜（AFM）悬臂，其校准后的刚度为 $k_{\\text{AFM}} = 0.060\\,\\text{N}\\,\\text{m}^{-1}$。\n\n运用适用于多尺度建模的基本定律和定义（牛顿第二定律、胡克定律以及约化LJ单位的量纲定义），完成以下任务：\n\n1.  从约化LJ单位的定义和量纲一致性出发，推导距离、力和时间的国际单位制（SI）到模拟单位的转换因子。用 $\\sigma$、$\\epsilon$ 和 $m$ 表示每个转换因子。\n\n2.  使用推导出的转换因子，确定模拟约化单位 $\\epsilon/\\sigma^{2}$ 下的虚拟弹簧刚度 $k$ 的值。该值在转换回国际单位制时，应在 $5\\%$ 的误差范围内与 $k_{\\text{AFM}}$ 最佳匹配。在所有与代码增量约束和 $5\\%$ 误差范围兼容的离散值中，选择使相对于 $k_{\\text{AFM}}$ 的绝对相对误差最小的那个值。\n\n使用常数 $k_{B} = 1.380\\,649 \\times 10^{-23}\\,\\text{J}\\,\\text{K}^{-1}$ 和 $1\\,\\text{u} = 1.660\\,539\\,066\\,60 \\times 10^{-27}\\,\\text{kg}$。将最终校准的虚拟弹簧刚度以模拟约化单位 $\\epsilon/\\sigma^{2}$ 表示，并将您的答案四舍五入至三位有效数字。",
            "solution": "所述问题具有科学依据，提法恰当，客观，并包含足够的信息以获得唯一解。它基于量纲分析和力学的基本原理，并应用于分子动力学模拟的背景中。因此，该问题被认为是有效的，并将提供完整的解答。\n\n按照要求，问题分两部分解决：首先，推导转换因子；其次，确定约化单位下的最优虚拟弹簧刚度。\n\n### 第一部分：国际单位制到模拟单位转换因子的推导\n\n在使用约化Lennard-Jones（LJ）单位的系统中，物理量通过相对于一组质量、长度和能量的特征基本单位进行归一化而变得无量纲。这些基本单位分别给定为 $m$、$\\sigma$ 和 $\\epsilon$。我们用下标 'SI' 表示国际单位制中的物理量，用上标 '*' 表示其对应的约化（无量纲）量。转换因子是约化单位的物理尺度。\n\n**1. 距离（长度）**\n特征长度是 $\\sigma$。物理距离 $x_{\\text{SI}}$ 与约化距离 $x^*$ 的关系为：\n$$x_{\\text{SI}} = \\sigma x^*$$\n距离的转换因子是 $\\sigma$。约化长度为 $1$ 对应于物理长度为 $\\sigma$ 米。\n\n**2. 力**\n力 $F$ 的量纲为 $[M][L][T]^{-2}$。我们可以从基本单位 $m$、$\\sigma$ 和 $\\epsilon$ 构建一个特征力。能量 $\\epsilon$ 的量纲为 $[M][L]^2[T]^{-2}$，也就是力乘以长度。因此，一个特征力单位可以定义为 $\\epsilon/\\sigma$。\n我们来验证其量纲：\n$$\\left[\\frac{\\epsilon}{\\sigma}\\right] = \\frac{[\\text{Energy}]}{[\\text{Length}]} = \\frac{[M][L]^2[T]^{-2}}{[L]} = [M][L][T]^{-2}$$\n这确实是力的量纲。因此，物理力 $F_{\\text{SI}}$ 与约化力 $F^*$ 的关系为：\n$$F_{\\text{SI}} = \\left(\\frac{\\epsilon}{\\sigma}\\right) F^*$$\n力的转换因子是 $\\epsilon/\\sigma$。\n\n**3. 时间**\n为了找到特征时间 $\\tau$，我们必须找到 $m$、$\\sigma$ 和 $\\epsilon$ 的一个组合，其量纲为时间 $[T]$。我们建立量纲方程：\n$$\\tau = m^a \\sigma^b \\epsilon^c$$\n$$[T]^1 = [M]^a [L]^b ([M][L]^2[T]^{-2})^c = [M]^{a+c} [L]^{b+2c} [T]^{-2c}$$\n对每个基本量纲的指数进行等式匹配：\n- 质量 ($[M]$): $a+c = 0 \\implies a = -c$\n- 长度 ($[L]$): $b+2c = 0 \\implies b = -2c$\n- 时间 ($[T]$): $-2c = 1 \\implies c = -1/2$\n\n将 $c = -1/2$ 代入其他方程，得到 $a = 1/2$ 和 $b = 1$。因此，特征时间 $\\tau$ 为：\n$$\\tau = m^{1/2} \\sigma^1 \\epsilon^{-1/2} = \\sigma\\sqrt{\\frac{m}{\\epsilon}}$$\n物理时间 $t_{\\text{SI}}$ 与约化时间 $t^*$ 的关系为：\n$$t_{\\text{SI}} = \\tau t^* = \\left(\\sigma\\sqrt{\\frac{m}{\\epsilon}}\\right) t^*$$\n时间的转换因子是 $\\tau = \\sigma\\sqrt{m/\\epsilon}$。\n\n### 第二部分：虚拟弹簧刚度的确定\n\n目标是找到约化单位下的虚拟弹簧刚度 $k^*$ 的值，该值最接近给定的AFM悬臂刚度 $k_{\\text{AFM}} = 0.060\\,\\text{N}\\,\\text{m}^{-1}$。\n\n首先，我们建立国际单位制下的刚度 $k_{\\text{SI}}$ 与其约化对应量 $k^*$ 之间的关系。约化刚度的单位给定为 $\\epsilon/\\sigma^2$。我们来验证该单位的量纲：\n$$\\left[\\frac{\\epsilon}{\\sigma^2}\\right] = \\frac{[\\text{Energy}]}{[\\text{Length}]^2} = \\frac{[M][L]^2[T]^{-2}}{[L]^2} = \\frac{[M][T]^{-2}}{1} = \\frac{[M][L][T]^{-2}}{[L]} = \\frac{[\\text{Force}]}{[\\text{Length}]}$$\n这与刚度的量纲（例如 $\\text{N}\\,\\text{m}^{-1}$）相匹配。因此，国际单位制值与约化值之间的关系为：\n$$k_{\\text{SI}} = k^* \\left(\\frac{\\epsilon}{\\sigma^2}\\right)$$\n整理方程求解约化刚度：\n$$k^* = k_{\\text{SI}} \\left(\\frac{\\sigma^2}{\\epsilon}\\right)$$\n我们现在计算与 $k_{\\text{AFM}}$ 对应的目标约化刚度 $k_{\\text{target}}^*$ 的数值。\n\n首先，我们必须计算特征能量 $\\epsilon$ 的国际单位制值（焦耳）。\n给定 $\\epsilon = 1.5\\,k_{B}T$，其中 $T = 300\\,\\text{K}$ 且 $k_{B} = 1.380649 \\times 10^{-23}\\,\\text{J}\\,\\text{K}^{-1}$：\n$$\\epsilon = 1.5 \\times (1.380649 \\times 10^{-23}\\,\\text{J}\\,\\text{K}^{-1}) \\times (300\\,\\text{K}) = 6.2129205 \\times 10^{-21}\\,\\text{J}$$\n特征长度 $\\sigma$ 给定为 $0.50\\,\\text{nm}$：\n$$\\sigma = 0.50\\,\\text{nm} = 0.50 \\times 10^{-9}\\,\\text{m}$$\n现在，我们可以使用 $k_{\\text{SI}} = k_{\\text{AFM}} = 0.060\\,\\text{N}\\,\\text{m}^{-1}$ 来计算 $k_{\\text{target}}^*$：\n$$k_{\\text{target}}^* = (0.060\\,\\text{N}\\,\\text{m}^{-1}) \\frac{(0.50 \\times 10^{-9}\\,\\text{m})^2}{6.2129205 \\times 10^{-21}\\,\\text{J}}$$\n$$k_{\\text{target}}^* = 0.060 \\times \\frac{0.25 \\times 10^{-18}}{6.2129205 \\times 10^{-21}} = \\frac{0.015 \\times 10^{-18}}{6.2129205 \\times 10^{-21}} \\approx 2.414305$$\n模拟中的刚度值 $k_{\\text{sim}}^*$ 必须是 $0.10$ 的倍数。此外，与 $k_{\\text{sim}}^*$ 对应的物理刚度必须在 $k_{\\text{AFM}}$ 的 $5\\%$ 范围内。这个要求等同于找到一个与 $k_{\\text{target}}^*$ 相差在 $5\\%$ 以内的 $k_{\\text{sim}}^*$：\n$$|k_{\\text{sim}}^* - k_{\\text{target}}^*| \\le 0.05 \\times k_{\\text{target}}^*$$\n$$0.95 \\times k_{\\text{target}}^* \\le k_{\\text{sim}}^* \\le 1.05 \\times k_{\\text{target}}^*$$\n代入 $k_{\\text{target}}^*$ 的值：\n$$0.95 \\times 2.414305 \\le k_{\\text{sim}}^* \\le 1.05 \\times 2.414305$$\n$$2.29359 \\le k_{\\text{sim}}^* \\le 2.53502$$\n$k_{\\text{sim}}^*$ 的可能值是位于此区间内的 $0.10$ 的离散倍数。候选值为：\n- $k_1^* = 2.30$\n- $k_2^* = 2.40$\n- $k_3^* = 2.50$\n\n问题要求选择“最小化绝对相对误差”的值，这等同于最小化绝对差 $|k_{\\text{sim}}^* - k_{\\text{target}}^*|$。我们为每个候选值计算这个差值：\n- 对于 $k_1^* = 2.30$: $|2.30 - 2.414305| = 0.114305$\n- 对于 $k_2^* = 2.40$: $|2.40 - 2.414305| = 0.014305$\n- 对于 $k_3^* = 2.50$: $|2.50 - 2.414305| = 0.085695$\n\n最小绝对差对应于 $k_{\\text{sim}}^* = 2.40$。\n问题要求答案四舍五入至三位有效数字。值 $2.40$ 已经以三位有效数字给出。\n\n因此，与实验悬臂最匹配的模拟约化单位下的虚拟弹簧刚度是 $2.40\\,\\epsilon/\\sigma^2$。",
            "answer": "$$\\boxed{2.40}$$"
        },
        {
            "introduction": "为了真正理解复杂模拟的结果，首先在一个简化的、可解析求解的模型中探索核心概念是极其宝贵的。本练习研究了一个经典的SMD情景——从谐波势阱中拉出一个粒子——从而可以精确推导出功、自由能和耗散。通过解决这个模型，您将对拉伸速度和系统特性如何影响非平衡功以及Jarzynski等式背后的原理，获得深刻而直观的理解。",
            "id": "3809094",
            "problem": "一个生物分子系统的一维反应坐标 $x$ 由一个二次形式的内在自由能 $F_{\\text{sys}}(x) = \\frac{1}{2} a x^{2}$ 建模，其中 $a$ 是一个正的类刚度参数。在控向分子动力学 (SMD) 中，施加一个谐波偏置 $U_{\\text{bias}}(x,\\lambda) = \\frac{1}{2} k_{s} \\left(x - \\lambda\\right)^{2}$，其中心 $\\lambda(t)$ 根据 $\\lambda(t) = v t$ 在 $t \\in [0, T]$ 内以恒定速度平移。弹簧施加在协议坐标上的广义力为 $F_{\\text{spring}}(t) = k_{s} \\left(\\lambda(t) - x(t)\\right)$。移动偏置所做的总功定义为\n$$\nW \\;=\\; \\int_{0}^{T} F_{\\text{spring}}(t)\\,\\dot{\\lambda}(t)\\,dt \\;=\\; \\int_{0}^{T} k_{s} \\left(\\lambda(t) - x(t)\\right)\\,v\\,dt.\n$$\n假设 $x(t)$ 的动力学是过阻尼的，摩擦系数为 $\\zeta$，其（对于系综平均）由过阻尼朗之万方程的确定性极限描述，\n$$\n\\zeta \\,\\dot{x}(t) \\;=\\; -\\frac{d}{dx}\\Big(F_{\\text{sys}}(x) + U_{\\text{bias}}(x,\\lambda)\\Big)\\Big|_{x=x(t)} \\;=\\; - a\\,x(t) \\;-\\; k_{s}\\left(x(t) - \\lambda(t)\\right),\n$$\n初始条件为 $x(0)$ 等于 $\\lambda(0)=0$ 时的平衡平均值。定义可逆功为协议的准静态极限，$\\Delta F \\equiv \\lim_{v \\to 0} W$，即系统对移动偏置做出绝热响应时所做的功。\n\n从这些定义和基本定律出发，推导在二次自由能形貌上恒速协议的 $W$ 和 $\\Delta F$。然后，对于以下参数值\n$$\na = 0.20~\\text{N}\\cdot\\text{m}^{-1}, \\quad k_{s} = 0.60~\\text{N}\\cdot\\text{m}^{-1}, \\quad \\zeta = 2.00 \\times 10^{-11}~\\text{N}\\cdot\\text{s}\\cdot\\text{m}^{-1}, \\quad v = 4.00~\\text{m}\\cdot\\text{s}^{-1}, \\quad T = 1.25 \\times 10^{-9}~\\text{s},\n$$\n计算耗散功 $W - \\Delta F$。用焦耳表示你的最终答案，并四舍五入到四位有效数字。",
            "solution": "### 步骤1：提取给定信息\n问题提供了以下数据、定义和方程：\n1.  **系统自由能**：$F_{\\text{sys}}(x) = \\frac{1}{2} a x^{2}$\n2.  **谐波偏置势**：$U_{\\text{bias}}(x,\\lambda) = \\frac{1}{2} k_{s} \\left(x - \\lambda\\right)^{2}$\n3.  **偏置中心的协议**：$\\lambda(t) = v t$ for $t \\in [0, T]$\n4.  **弹簧力**：$F_{\\text{spring}}(t) = k_{s} \\left(\\lambda(t) - x(t)\\right)$\n5.  **总功**：$W = \\int_{0}^{T} F_{\\text{spring}}(t)\\,\\dot{\\lambda}(t)\\,dt = \\int_{0}^{T} k_{s} \\left(\\lambda(t) - x(t)\\right)\\,v\\,dt$\n6.  **运动方程（系综平均）**：$\\zeta \\,\\dot{x}(t) = - a\\,x(t) - k_{s}\\left(x(t) - \\lambda(t)\\right)$\n7.  **初始条件**：$x(0)$ 是在 $\\lambda(0)=0$ 时的平衡平均值。\n8.  **可逆功**：$\\Delta F \\equiv \\lim_{v \\to 0} W$ （对于固定的最终协议值 $\\lambda_f = vT$）。\n9.  **参数值**：\n    - $a = 0.20~\\text{N}\\cdot\\text{m}^{-1}$\n    - $k_{s} = 0.60~\\text{N}\\cdot\\text{m}^{-1}$\n    - $\\zeta = 2.00 \\times 10^{-11}~\\text{N}\\cdot\\text{s}\\cdot\\text{m}^{-1}$\n    - $v = 4.00~\\text{m}\\cdot\\text{s}^{-1}$\n    - $T = 1.25 \\times 10^{-9}~\\text{s}$\n\n### 步骤2：使用提取的信息进行验证\n该问题描述了非平衡统计力学和多尺度建模中的一个典范模型：一个位于谐振子势阱中的粒子被一个移动的谐振子陷阱所拉动。这个设置是理解控向分子动力学 (SMD) 模拟的核心。\n\n1.  **科学依据**：该问题基于为布朗粒子建立的成熟的过阻尼朗之万动力学框架。功、自由能和耗散等概念是热力学和统计力学中的标准概念。所有方程在物理上和数学上都是合理的。\n2.  **良定的**：该问题定义清晰，包含一个线性一阶常微分方程、一个特定的初始条件和一个明确的目标（计算耗散功）。对于轨迹 $x(t)$ 以及因此对于功 $W$ 存在唯一且稳定的解。\n3.  **目标**：语言精确且定量。所有术语都有正式定义。\n4.  **自洽且一致**：解决该问题所需的所有信息都已提供。给定参数的单位在国际单位制（SI）中是一致的。\n5.  **非平凡的**：求解过程需要解一个微分方程并进行积分，然后进行仔细的代数处理和数值计算。这是一个有实质内容的问题。\n\n### 步骤3：结论与行动\n问题是有效的。我们开始求解。\n\n### 耗散功的推导\n\n首先，我们确定初始条件 $x(0)$。系统在 $\\lambda(0)=0$ 时初始处于平衡状态。平衡位置 $x_{\\text{eq}}$ 是总力为零的位置。力由总势能 $U_{\\text{total}}(x, \\lambda) = F_{\\text{sys}}(x) + U_{\\text{bias}}(x, \\lambda)$ 导出。\n$$F_x = -\\frac{d}{dx}\\left(\\frac{1}{2}ax^2 + \\frac{1}{2}k_s(x-\\lambda)^2\\right) = -ax - k_s(x-\\lambda)$$\n令 $F_x=0$ 得到 $ax_{\\text{eq}} + k_s(x_{\\text{eq}}-\\lambda) = 0$，解得 $x_{\\text{eq}}(\\lambda) = \\frac{k_s}{a+k_s}\\lambda$。\n对于 $\\lambda(0)=0$，初始条件为 $x(0) = x_{\\text{eq}}(0) = 0$。\n\n接下来，我们求解 $x(t)$ 的运动方程：\n$$\\zeta \\frac{dx}{dt} = -ax - k_s(x - \\lambda(t))$$\n$$\\zeta \\frac{dx}{dt} + (a+k_s)x = k_s \\lambda(t)$$\n代入 $\\lambda(t) = vt$，我们得到一个一阶线性非齐次常微分方程：\n$$\\frac{dx}{dt} + \\frac{a+k_s}{\\zeta}x = \\frac{k_s v}{\\zeta}t$$\n解由齐次部分 $x_h(t) = C \\exp\\left(-\\frac{a+k_s}{\\zeta}t\\right)$ 和一个特解 $x_p(t)$ 组成。我们猜测特解的形式为 $x_p(t) = At+B$。代入常微分方程得到：\n$$A + \\frac{a+k_s}{\\zeta}(At+B) = \\frac{k_s v}{\\zeta}t$$\n令 $t$ 的各次幂系数相等：\n- $t^1: \\quad \\frac{a+k_s}{\\zeta}A = \\frac{k_s v}{\\zeta} \\implies A = \\frac{k_s v}{a+k_s}$\n- $t^0: \\quad A + \\frac{a+k_s}{\\zeta}B = 0 \\implies B = -A \\frac{\\zeta}{a+k_s} = -\\frac{\\zeta k_s v}{(a+k_s)^2}$\n通解为 $x(t) = C \\exp\\left(-\\frac{a+k_s}{\\zeta}t\\right) + \\frac{k_s v}{a+k_s}t - \\frac{\\zeta k_s v}{(a+k_s)^2}$。\n使用初始条件 $x(0)=0$：\n$$0 = C - \\frac{\\zeta k_s v}{(a+k_s)^2} \\implies C = \\frac{\\zeta k_s v}{(a+k_s)^2}$$\n因此，轨迹为：\n$$x(t) = \\frac{k_s v}{a+k_s}t - \\frac{\\zeta k_s v}{(a+k_s)^2}\\left(1 - \\exp\\left(-\\frac{a+k_s}{\\zeta}t\\right)\\right)$$\n\n可逆功 $\\Delta F$ 是组合系统从 $\\lambda=0$ 到 $\\lambda=\\lambda_f = vT$ 的平衡自由能变化。平衡自由能为 $F(\\lambda) = U_{\\text{total}}(x_{\\text{eq}}(\\lambda), \\lambda)$：\n$$F(\\lambda) = \\frac{1}{2}a\\left(\\frac{k_s\\lambda}{a+k_s}\\right)^2 + \\frac{1}{2}k_s\\left(\\frac{k_s\\lambda}{a+k_s} - \\lambda\\right)^2 = \\frac{1}{2}\\lambda^2 \\frac{ak_s^2+k_sa^2}{(a+k_s)^2} = \\frac{1}{2}\\frac{ak_s}{a+k_s}\\lambda^2$$\n可逆功为 $\\Delta F = F(vT) - F(0) = \\frac{1}{2}\\frac{ak_s}{a+k_s}(vT)^2$。\n\n总功为 $W = \\int_{0}^{T} k_s (\\lambda(t)-x(t))v\\,dt$。我们来求 $\\lambda(t)-x(t)$：\n$$\\lambda(t)-x(t) = vt - \\left[\\frac{k_s v}{a+k_s}t - \\frac{\\zeta k_s v}{(a+k_s)^2}\\left(1 - \\exp\\left(-\\frac{a+k_s}{\\zeta}t\\right)\\right)\\right]$$\n$$\\lambda(t)-x(t) = \\frac{a}{a+k_s}vt + \\frac{\\zeta k_s v}{(a+k_s)^2}\\left(1 - \\exp\\left(-\\frac{a+k_s}{\\zeta}t\\right)\\right)$$\n积分求功 $W$：\n$$W = k_s v \\int_0^T \\left[\\frac{a v t}{a+k_s} + \\frac{\\zeta k_s v}{(a+k_s)^2}\\left(1 - \\exp\\left(-\\frac{a+k_s}{\\zeta}t\\right)\\right)\\right]dt$$\n$$W = \\frac{ak_sv^2}{a+k_s}\\int_0^T t\\,dt + \\frac{\\zeta k_s^2 v^2}{(a+k_s)^2}\\int_0^T \\left(1 - \\exp\\left(-\\frac{a+k_s}{\\zeta}t\\right)\\right)dt$$\n第一个积分为 $\\frac{T^2}{2}$。第二个积分为 $\\left[t + \\frac{\\zeta}{a+k_s}\\exp\\left(-\\frac{a+k_s}{\\zeta}t\\right)\\right]_0^T = T - \\frac{\\zeta}{a+k_s}\\left(1-\\exp\\left(-\\frac{a+k_s}{\\zeta}T\\right)\\right)$。\n$$W = \\frac{1}{2}\\frac{ak_s}{a+k_s}(vT)^2 + \\frac{\\zeta k_s^2 v^2}{(a+k_s)^2}\\left[T - \\frac{\\zeta}{a+k_s}\\left(1-\\exp\\left(-\\frac{a+k_s}{\\zeta}T\\right)\\right)\\right]$$\n第一项恰好是可逆功 $\\Delta F$。耗散功为 $W_{\\text{diss}} = W - \\Delta F$：\n$$W_{\\text{diss}} = \\frac{\\zeta k_s^2 v^2}{(a+k_s)^2}\\left[T - \\frac{\\zeta}{a+k_s}\\left(1-\\exp\\left(-\\frac{a+k_s}{\\zeta}T\\right)\\right)\\right]$$\n\n现在我们代入给定的数值：\n$a = 0.20~\\text{N}\\cdot\\text{m}^{-1}$, $k_s = 0.60~\\text{N}\\cdot\\text{m}^{-1}$, $\\zeta = 2.00 \\times 10^{-11}~\\text{N}\\cdot\\text{s}\\cdot\\text{m}^{-1}$, $v = 4.00~\\text{m}\\cdot\\text{s}^{-1}$, $T = 1.25 \\times 10^{-9}~\\text{s}$。\n\n首先，我们计算参数的组合：\n$a+k_s = 0.20 + 0.60 = 0.80~\\text{N}\\cdot\\text{m}^{-1}$。\n令 $\\tau = \\frac{\\zeta}{a+k_s}$ 为系统的弛豫时间。\n$$\\tau = \\frac{2.00 \\times 10^{-11}~\\text{N}\\cdot\\text{s}\\cdot\\text{m}^{-1}}{0.80~\\text{N}\\cdot\\text{m}^{-1}} = 2.5 \\times 10^{-11}~\\text{s}$$\n指数函数的自变量是 $\\frac{T}{\\tau}$：\n$$\\frac{T}{\\tau} = \\frac{1.25 \\times 10^{-9}~\\text{s}}{2.5 \\times 10^{-11}~\\text{s}} = 50$$\n耗散功的表达式可以写成 $W_{\\text{diss}} = \\frac{\\zeta k_s^2 v^2}{(a+k_s)^2} [T - \\tau(1-\\exp(-T/\\tau))]$。\n我们来计算预因子：\n$$\\frac{\\zeta k_s^2 v^2}{(a+k_s)^2} = \\frac{(2.00 \\times 10^{-11}) (0.60)^2 (4.00)^2}{(0.80)^2} = \\frac{(2.00 \\times 10^{-11}) \\times 0.36 \\times 16.0}{0.64}~\\text{J}\\cdot\\text{s}^{-1}$$\n$$= \\frac{11.52 \\times 10^{-11}}{0.64} = 18.0 \\times 10^{-11} = 1.80 \\times 10^{-10}~\\text{J}\\cdot\\text{s}^{-1}$$\n现在计算方括号中的项：\n$$T - \\tau(1-\\exp(-T/\\tau)) = 1.25 \\times 10^{-9} - (2.5 \\times 10^{-11})(1 - \\exp(-50))~\\text{s}$$\n由于 $\\exp(-50) \\approx 1.9 \\times 10^{-22}$，与 $1$ 相比可以忽略不计。\n$$ \\approx 1.25 \\times 10^{-9} - 2.5 \\times 10^{-11} = 1.25 \\times 10^{-9} - 0.025 \\times 10^{-9} = 1.225 \\times 10^{-9}~\\text{s}$$\n最后，我们计算耗散功：\n$$W_{\\text{diss}} = (1.80 \\times 10^{-10}~\\text{J}\\cdot\\text{s}^{-1}) \\times (1.225 \\times 10^{-9}~\\text{s})$$\n$$W_{\\text{diss}} = 2.205 \\times 10^{-19}~\\text{J}$$\n题目要求答案保留四位有效数字，此结果已满足要求。",
            "answer": "$$\\boxed{2.205 \\times 10^{-19}}$$"
        },
        {
            "introduction": "计算科学家最关键的技能之一是能够识别和理解模拟中的假象。这个编码练习让您亲身体验并研究SMD中一个常见的陷阱：断裂力假象。您将以不同的拉伸速度模拟配体解离过程，并亲手发现过快的拉伸如何产生一个由粘性阻力主导的峰值力，而这个力与真实的结合能之间缺乏明确的关联。这项实践强调了批判性分析和审慎选择模拟参数以获得物理上可靠结果的重要性。",
            "id": "2463081",
            "problem": "单个集体坐标 $x(t)$ 描述了配体沿拉伸轴与受体分离的过程。配体受到一个内在结合势 $U(x)$ 和一个来自谐振子弹簧的随时间变化的外部约束，该弹簧的锚点以恒定速度 $v$ 移动。在零温度（确定性极限）下朗之万动力学的过阻尼极限中，$x(t)$ 的演化由力平衡方程决定\n$$\n\\gamma \\,\\frac{dx}{dt} \\;=\\; -\\,\\frac{dU}{dx}(x) \\;-\\; k_s\\bigl(x - x_s(t)\\bigr),\n$$\n其中 $\\gamma$ 是摩擦系数，$k_s$ 是弹簧常数，$x_s(t) = v\\,t$ 是拉伸台的位置。测量到的力是弹簧力\n$$\nF_{\\text{spring}}(t) \\;=\\; k_s\\,\\bigl(x(t) - x_s(t)\\bigr),\n$$\n其大小 $\\lvert F_{\\text{spring}}(t)\\rvert$ 在拉伸过程中通常会显示一个峰值（“断裂力”）。\n\n你将使用深度为 $\\varepsilon$、范围参数为 $a$ 的莫尔斯势阱来模拟结合势，\n$$\nU(x) \\;=\\; \\varepsilon\\left[\\left(1 - e^{-a x}\\right)^2 - 1\\right],\n$$\n该势在 $x = 0$ 处有最小值，$U(0) = -\\varepsilon$，并且当 $x\\to +\\infty$ 时 $U(x)\\to 0$。在此定义下，结合最小值与未结合基线之间的平衡结合自由能差为 $\\Delta F = \\varepsilon$。\n\n从过阻尼力平衡和弹簧力的定义出发，推导一个适用于零温度过阻尼体系中稳定时间步进的数值方案，并实现一个程序来完成以下任务。\n\n1) 使用以下物理上一致的参数和单位：\n- 长度单位为纳米 (nm)，时间单位为皮秒 (ps)，力单位为皮牛 (pN)，能量单位为 pN·nm。\n- 温度固定在 $0$ K（确定性极限）。\n- 摩擦系数 $\\gamma = 5000$ pN·ps/nm。\n- 弹簧常数 $k_s = 100$ pN/nm。\n- 莫尔斯范围参数 $a = 6$ nm$^{-1}$。\n- 结合深度 $\\varepsilon \\in \\{\\varepsilon_i\\}_{i=1}^{4}$，其值为 $\\varepsilon_1 = 10$ pN·nm, $\\varepsilon_2 = 20$ pN·nm, $\\varepsilon_3 = 30$ pN·nm, $\\varepsilon_4 = 40$ pN·nm。\n- 初始条件 $x(0) = 0$ nm 和 $x_s(0) = 0$ nm。\n- 时间步长 $\\Delta t = 0.001$ ps，总模拟时间 $T = 50$ ps。\n\n2) 对于每个深度 $\\varepsilon_i$，积分运动方程以获得 $x(t)$，并计算轨迹上弹簧力的最大值，\n$$\nF_{\\max}(v;\\varepsilon_i) \\;=\\; \\max_{t\\in[0,T]} \\lvert F_{\\text{spring}}(t)\\rvert.\n$$\n\n3) 考虑包含三种拉伸速度 $v$ 的测试集：\n- 准绝热情况 $v_1 = 0.01$ nm/ps (慢速)，\n- 非平衡情况 $v_2 = 0.05$ nm/ps (中速)，\n- 强非平衡情况 $v_3 = 0.50$ nm/ps (快速)。\n\n对于每个 $v_j$，评估平衡结合自由能列表 $\\bigl[\\Delta F_i\\bigr]_{i=1}^{4} = \\bigl[\\varepsilon_i\\bigr]_{i=1}^{4}$ 与相应的断裂力列表 $\\bigl[F_{\\max}(v_j;\\varepsilon_i)\\bigr]_{i=1}^{4}$ 之间的皮尔逊线性相关系数。\n\n4) 你的程序必须输出一行，其中包含 $v_1$、$v_2$ 和 $v_3$ 的三个相关系数，按此顺序排列，形式为用方括号括起来的逗号分隔列表。例如，打印的行应类似于“[c1,c2,c3]”，其中每个 $c_j$ 是一个浮点数。不应有任何多余的空格或文本。\n\n科学真实性要求：\n- 你的推导应基于过阻尼极限下的牛顿力学和弹簧的胡克定律。莫尔斯势是具有单一位能最小值的短程结合的标准选择。所选参数与计算化学中使用的纳米–皮秒–皮牛单位系统一致。\n- 数值积分必须从控制方程推导而来，并且量纲上保持一致。\n- 最终的相关系数应表示为无量纲的浮点数。\n\n测试集覆盖要求：\n- 慢速情况 $v_1$ 作为一条“理想路径”，更接近可逆拉伸，其中 $\\lvert F_{\\max}\\rvert$ 应受到 $\\Delta F$ 的影响。\n- 中速情况 $v_2$ 探查一个过渡区域。\n- 快速情况 $v_3$ 是一个旨在展示“断裂力伪影”的边界情况，其中 $\\lvert F_{\\max}\\rvert$ 可能由粘性项主导，并与 $\\Delta F$ 失去相关性。\n\n程序应生成单行输出，其中包含三个相关系数，形式为用方括号括起来的逗号分隔列表。不使用角度。输出中不应出现百分比；相关系数是无单位的纯数。",
            "solution": "问题陈述已经过验证，被认为是科学上合理、良定且完整的。它描述了在确定性的过阻尼极限下，力探针分子动力学的一个典范模型。我们现在来推导数值解。\n\n该问题要求对集体坐标 $x(t)$ 在内在势 $U(x)$ 和随时间变化的外部谐波约束作用下的运动方程进行数值积分。控制方程由零温度下过阻尼体系的力平衡给出：\n$$\n\\gamma \\frac{dx}{dt} = F_{\\text{intrinsic}}(x) + F_{\\text{external}}(x, t)\n$$\n其中 $\\gamma$ 是摩擦系数。力分量包括：\n1.  来自莫尔斯势的内禀力，$F_{\\text{intrinsic}}(x) = -\\frac{dU}{dx}(x)$。\n2.  来自移动弹簧的外力，$F_{\\text{external}}(x, t) = -k_s(x - x_s(t))$。\n\n莫尔斯势由 $U(x) = \\varepsilon\\left[\\left(1 - e^{-a x}\\right)^2 - 1\\right]$ 给出。它对 $x$ 的导数是：\n$$\n\\frac{dU}{dx}(x) = \\varepsilon \\cdot 2(1 - e^{-ax}) \\cdot \\frac{d}{dx}(1 - e^{-ax}) = 2\\varepsilon(1 - e^{-ax})(a e^{-ax}) = 2a\\varepsilon(e^{-ax} - e^{-2ax})\n$$\n外部弹簧的锚点以恒定速度 $v$ 移动，因此其位置为 $x_s(t) = v t$。将这些表达式代入运动方程，得到：\n$$\n\\gamma \\frac{dx}{dt} = -2a\\varepsilon(e^{-ax} - e^{-2ax}) - k_s(x - vt)\n$$\n为便于数值积分，我们将此一阶常微分方程重排为标准形式 $\\frac{dx}{dt} = f(x, t)$：\n$$\n\\frac{dx}{dt} = \\frac{1}{\\gamma} \\left[ -2a\\varepsilon(e^{-ax} - e^{-2ax}) - k_s(x - vt) \\right]\n$$\n我们将使用前向欧拉法求解此方程，这是一种简单且显式的时间步进方案。对于时间步长 $\\Delta t$，在时间 $t + \\Delta t$ 的位置可以通过在时间 $t$ 的位置和速度来近似：\n$$\nx(t + \\Delta t) \\approx x(t) + \\Delta t \\cdot \\frac{dx}{dt}\\bigg|_t\n$$\n令 $x_i = x(t_i)$，其中 $t_i = i\\Delta t$。更新规则是：\n$$\nx_{i+1} = x_i + \\frac{\\Delta t}{\\gamma} \\left[ -2a\\varepsilon(e^{-ax_i} - e^{-2ax_i}) - k_s(x_i - v t_i) \\right]\n$$\n该方案的稳定性取决于 $\\Delta t$ 相对于系统特征弛豫时间的大小。总势能 $U_{\\text{tot}}(x, t) = U(x) + \\frac{1}{2}k_s(x-vt)^2$ 的有效刚度为 $k_{\\text{eff}} = \\frac{d^2 U}{dx^2} + k_s$。莫尔斯势的刚度 $\\frac{d^2 U}{dx^2} = 2a^2\\varepsilon(2e^{-2ax} - e^{-ax})$ 在 $x=0$ 处达到最大值 $k_{\\text{morse,max}} = 2a^2\\varepsilon$。对于最大值 $\\varepsilon = 40$ pN·nm 和 $a = 6$ nm$^{-1}$，该值为 $k_{\\text{morse,max}} = 2 \\cdot (6)^2 \\cdot 40 = 2880$ pN/nm。总刚度约等于 $k_{\\text{eff,max}} \\approx 2880 + k_s = 2880 + 100 = 2980$ pN/nm。因此，系统中最快的弛豫时间为 $\\tau_{\\text{min}} = \\gamma / k_{\\text{eff,max}} \\approx 5000 / 2980 \\approx 1.68$ ps。指定的时间步长 $\\Delta t = 0.001$ ps 比这个最快的时间尺度小三个数量级以上（$\\Delta t \\ll \\tau_{\\text{min}}$）。因此，前向欧拉法对于此问题保证是稳定和准确的。\n\n模拟协议如下。对于每个拉伸速度 $v \\in \\{0.01, 0.05, 0.50\\}$ nm/ps，我们进行一系列模拟，每个结合能 $\\varepsilon \\in \\{10, 20, 30, 40\\}$ pN·nm 对应一次模拟。\n对于每对 $(v, \\varepsilon)$：\n1.  在 $t=0$ 时用 $x(0)=0$ 初始化系统。\n2.  从 $t=0$ 到 $T=50$ ps，以时间步长 $\\Delta t = 0.001$ ps 进行迭代。在每个步骤 $i$ 中：\n    a. 计算当前时间 $t_i = i \\Delta t$。\n    b. 使用上面推导的欧拉公式将粒子位置从 $x_i$ 更新到 $x_{i+1}$。\n    c. 计算新位置和时间的弹簧力：$F_{\\text{spring}}(t_{i+1}) = k_s(x_{i+1} - v t_{i+1})$。\n3.  生成轨迹后，确定弹簧力的最大值：$F_{\\max}(v; \\varepsilon) = \\max_{t \\in [0, T]} |F_{\\text{spring}}(t)|$。\n\n在获得给定速度 $v$ 的断裂力列表 $[F_{\\max}(v; \\varepsilon_1), F_{\\max}(v; \\varepsilon_2), F_{\\max}(v; \\varepsilon_3), F_{\\max}(v; \\varepsilon_4)]$ 后，我们计算此列表与相应结合自由能列表 $[\\Delta F_i] = [\\varepsilon_i]$ 之间的皮尔逊线性相关系数 $\\rho$。具有 $N$ 个样本的两个变量 $X$ 和 $Y$ 之间的皮尔逊相关系数定义为：\n$$\n\\rho_{X,Y} = \\frac{\\sum_{i=1}^N (X_i - \\bar{X})(Y_i - \\bar{Y})}{\\sqrt{\\sum_{i=1}^N (X_i - \\bar{X})^2} \\sqrt{\\sum_{i=1}^N (Y_i - \\bar{Y})^2}}\n$$\n其中 $\\bar{X}$ 和 $\\bar{Y}$ 是样本均值。对三种拉伸速度中的每一种重复此过程，从而产生三个相关系数。此整个过程的实现将在下一节中提供。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the steered molecular dynamics problem to find the correlation\n    between binding energy and rupture force at different pulling speeds.\n    \"\"\"\n    \n    # 1) Define physically consistent parameters and units\n    # Length in nm, time in ps, force in pN, energy in pN·nm\n    gamma = 5000.0  # Friction coefficient (pN·ps/nm)\n    k_s = 100.0     # Spring constant (pN/nm)\n    a = 6.0         # Morse range parameter (nm⁻¹)\n    \n    # Binding depths epsilon (pN·nm)\n    epsilons = np.array([10.0, 20.0, 30.0, 40.0])\n    \n    # Time parameters\n    dt = 0.001      # Time step (ps)\n    T = 50.0        # Total simulation time (ps)\n    \n    # Initial conditions\n    x0 = 0.0        # Initial position (nm)\n    \n    # 3) Test suite of pulling speeds\n    velocities = [0.01, 0.05, 0.50]  # Pulling speeds (nm/ps)\n\n    # List to store the correlation coefficients\n    correlation_results = []\n    \n    # Calculate number of steps\n    num_steps = int(T / dt)\n    \n    # Main simulation loop\n    for v in velocities:\n        max_forces = []\n        \n        for epsilon in epsilons:\n            # Initialize arrays for position and time\n            x = np.zeros(num_steps + 1)\n            t = np.linspace(0, T, num_steps + 1)\n            \n            x[0] = x0\n            \n            # Array to store spring force magnitude\n            spring_force_magnitudes = np.zeros(num_steps + 1)\n            # Initial spring force is zero\n            spring_force_magnitudes[0] = 0.0\n            \n            # 2) Integrate the equation of motion\n            for i in range(num_steps):\n                # Force from Morse potential\n                force_morse = -2.0 * a * epsilon * (np.exp(-a * x[i]) - np.exp(-2.0 * a * x[i]))\n                \n                # Position of the spring anchor\n                x_s = v * t[i]\n                \n                # Force from the spring on the particle\n                force_spring_on_particle = -k_s * (x[i] - x_s)\n                \n                # Total force on the particle\n                total_force = force_morse + force_spring_on_particle\n                \n                # Update position using Forward Euler method\n                x[i+1] = x[i] + (total_force / gamma) * dt\n                \n                # Calculate the measured spring force F_spring(t) = k_s * (x(t) - x_s(t))\n                # Note: t[i+1] corresponds to the time for x[i+1]\n                x_s_next = v * t[i+1]\n                f_spring = k_s * (x[i+1] - x_s_next)\n                \n                # Store its magnitude\n                spring_force_magnitudes[i+1] = np.abs(f_spring)\n\n            # Find the maximum magnitude of the spring force (rupture force)\n            F_max = np.max(spring_force_magnitudes)\n            max_forces.append(F_max)\n        \n        # 3) Evaluate the Pearson linear correlation coefficient\n        # Note: binding free energy Delta_F is equal to epsilon\n        correlation_matrix = np.corrcoef(epsilons, max_forces)\n        correlation = correlation_matrix[0, 1]\n        correlation_results.append(correlation)\n        \n    # 4) Output the results in the specified format\n    # Example format: \"[c1,c2,c3]\"\n    print(f\"[{','.join(map(str, correlation_results))}]\")\n\nsolve()\n```"
        }
    ]
}