{
    "hands_on_practices": [
        {
            "introduction": "Before conducting a Steered Molecular Dynamics simulation, it is crucial to ensure that the parameters used in the model, such as the virtual spring constant, are physically meaningful. This exercise guides you through the essential process of converting between the abstract reduced units common in simulations and the standard SI units used in experimental measurements . Mastering this skill is the first step toward designing simulations that can be directly compared with real-world experiments, like those using Atomic Force Microscopy.",
            "id": "3809071",
            "problem": "A Steered Molecular Dynamics (SMD) protocol is used to pull a coarse-grained ligand through a protein channel with a virtual spring attached to a pulling handle. In the simulation, reduced Lennard-Jones (LJ) units are used, defined by a characteristic length $\\sigma$, energy $\\epsilon$, and mass $m$. The virtual spring obeys Hooke's law $F = k\\,\\Delta x$, where $k$ has units of force per unit length. The underlying scales are as follows: $\\sigma = 0.50\\,\\text{nm}$, $\\epsilon = 1.5\\,k_{B}T$ at $T=300\\,\\text{K}$, and $m = 72\\,\\text{u}$. The simulation code accepts the virtual spring stiffness $k$ only in discrete increments of $0.10$ in reduced units of $\\epsilon/\\sigma^{2}$. An Atomic Force Microscopy (AFM) cantilever used to benchmark the setup has a calibrated stiffness $k_{\\text{AFM}} = 0.060\\,\\text{N}\\,\\text{m}^{-1}$.\n\nUsing the base laws and definitions appropriate for multiscale modeling (Newton’s second law, Hooke’s law, and the dimensional definitions of reduced LJ units), carry out the following:\n\n1. Derive the SI-to-simulation conversion factors for distance, force, and time, starting from the definitions of reduced LJ units and dimensional consistency. Express each conversion factor in terms of $\\sigma$, $\\epsilon$, and $m$.\n\n2. Using the derived conversions, determine the value of the virtual spring stiffness $k$ in simulation reduced units of $\\epsilon/\\sigma^{2}$ that best matches $k_{\\text{AFM}}$ within $5\\%$ when translated back to SI units. Among all discrete values compatible with the code’s increment constraint and the $5\\%$ bound, select the one that minimizes the absolute relative error with respect to $k_{\\text{AFM}}$.\n\nUse the constants $k_{B} = 1.380\\,649 \\times 10^{-23}\\,\\text{J}\\,\\text{K}^{-1}$ and $1\\,\\text{u} = 1.660\\,539\\,066\\,60 \\times 10^{-27}\\,\\text{kg}$. Express the final calibrated virtual spring stiffness in simulation reduced units of $\\epsilon/\\sigma^{2}$ and round your answer to three significant figures.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. It is based on fundamental principles of dimensional analysis and mechanics as applied in the context of molecular dynamics simulations. Therefore, the problem is deemed valid and a full solution will be provided.\n\nThe problem is addressed in two parts as requested: first, the derivation of conversion factors, and second, the determination of the optimal virtual spring stiffness in reduced units.\n\n### Part 1: Derivation of SI-to-Simulation Conversion Factors\n\nIn a system using reduced Lennard-Jones (LJ) units, physical quantities are made dimensionless by normalizing them with respect to a set of characteristic base units for mass, length, and energy. These are given as $m$, $\\sigma$, and $\\epsilon$, respectively. We denote a physical quantity in SI units with a subscript 'SI' and its corresponding reduced (dimensionless) counterpart with a superscript '*'. The conversion factor is the physical scale of the reduced unit.\n\n**1. Distance (Length)**\nThe characteristic length is $\\sigma$. A physical distance $x_{\\text{SI}}$ is related to the reduced distance $x^*$ by:\n$$x_{\\text{SI}} = \\sigma x^*$$\nThe conversion factor for distance is $\\sigma$. A reduced length of $1$ corresponds to a physical length of $\\sigma$ meters.\n\n**2. Force**\nForce, $F$, has dimensions of $[M][L][T]^{-2}$. We can construct a characteristic force from the base units $m$, $\\sigma$, and $\\epsilon$. Energy, $\\epsilon$, has dimensions of $[M][L]^2[T]^{-2}$, which is also Force $\\times$ Length. Therefore, a characteristic force unit can be defined as $\\epsilon/\\sigma$.\nLet's verify the dimensions:\n$$\\left[\\frac{\\epsilon}{\\sigma}\\right] = \\frac{[\\text{Energy}]}{[\\text{Length}]} = \\frac{[M][L]^2[T]^{-2}}{[L]} = [M][L][T]^{-2}$$\nThis is indeed the dimension of force. Thus, a physical force $F_{\\text{SI}}$ is related to the reduced force $F^*$ by:\n$$F_{\\text{SI}} = \\left(\\frac{\\epsilon}{\\sigma}\\right) F^*$$\nThe conversion factor for force is $\\epsilon/\\sigma$.\n\n**3. Time**\nTo find the characteristic time, $\\tau$, we must find a combination of $m$, $\\sigma$, and $\\epsilon$ that yields dimensions of time, $[T]$. We set up the dimensional equation:\n$$\\tau = m^a \\sigma^b \\epsilon^c$$\n$$[T]^1 = [M]^a [L]^b ([M][L]^2[T]^{-2})^c = [M]^{a+c} [L]^{b+2c} [T]^{-2c}$$\nEquating the exponents for each base dimension:\n- Mass ($[M]$): $a+c = 0 \\implies a = -c$\n- Length ($[L]$): $b+2c = 0 \\implies b = -2c$\n- Time ($[T]$): $-2c = 1 \\implies c = -1/2$\n\nSubstituting $c = -1/2$ into the other equations gives $a = 1/2$ and $b = 1$. The characteristic time $\\tau$ is therefore:\n$$\\tau = m^{1/2} \\sigma^1 \\epsilon^{-1/2} = \\sigma\\sqrt{\\frac{m}{\\epsilon}}$$\nA physical time $t_{\\text{SI}}$ is related to the reduced time $t^*$ by:\n$$t_{\\text{SI}} = \\tau t^* = \\left(\\sigma\\sqrt{\\frac{m}{\\epsilon}}\\right) t^*$$\nThe conversion factor for time is $\\tau = \\sigma\\sqrt{m/\\epsilon}$.\n\n### Part 2: Determination of the Virtual Spring Stiffness\n\nThe goal is to find the value of the virtual spring stiffness $k^*$ in reduced units that best approximates the given AFM cantilever stiffness, $k_{\\text{AFM}} = 0.060\\,\\text{N}\\,\\text{m}^{-1}$.\n\nFirst, we establish the relationship between the stiffness in SI units, $k_{\\text{SI}}$, and its reduced counterpart, $k^*$. The unit of reduced stiffness is given as $\\epsilon/\\sigma^2$. Let's verify the dimensions of this unit:\n$$\\left[\\frac{\\epsilon}{\\sigma^2}\\right] = \\frac{[\\text{Energy}]}{[\\text{Length}]^2} = \\frac{[M][L]^2[T]^{-2}}{[L]^2} = \\frac{[M][T]^{-2}}{1} = \\frac{[M][L][T]^{-2}}{[L]} = \\frac{[\\text{Force}]}{[\\text{Length}]}$$\nThis matches the dimensions of stiffness (e.g., $\\text{N}\\,\\text{m}^{-1}$). The relationship between the SI value and the reduced value is thus:\n$$k_{\\text{SI}} = k^* \\left(\\frac{\\epsilon}{\\sigma^2}\\right)$$\nRearranging for the reduced stiffness gives:\n$$k^* = k_{\\text{SI}} \\left(\\frac{\\sigma^2}{\\epsilon}\\right)$$\nWe now calculate the numerical value of the target reduced stiffness, $k_{\\text{target}}^*$, which corresponds to $k_{\\text{AFM}}$.\n\nFirst, we must calculate the characteristic energy $\\epsilon$ in SI units (Joules).\nGiven $\\epsilon = 1.5\\,k_{B}T$, with $T = 300\\,\\text{K}$ and $k_{B} = 1.380649 \\times 10^{-23}\\,\\text{J}\\,\\text{K}^{-1}$:\n$$\\epsilon = 1.5 \\times (1.380649 \\times 10^{-23}\\,\\text{J}\\,\\text{K}^{-1}) \\times (300\\,\\text{K}) = 6.2129205 \\times 10^{-21}\\,\\text{J}$$\nThe characteristic length $\\sigma$ is given as $0.50\\,\\text{nm}$:\n$$\\sigma = 0.50\\,\\text{nm} = 0.50 \\times 10^{-9}\\,\\text{m}$$\nNow, we can compute $k_{\\text{target}}^*$ using $k_{\\text{SI}} = k_{\\text{AFM}} = 0.060\\,\\text{N}\\,\\text{m}^{-1}$:\n$$k_{\\text{target}}^* = (0.060\\,\\text{N}\\,\\text{m}^{-1}) \\frac{(0.50 \\times 10^{-9}\\,\\text{m})^2}{6.2129205 \\times 10^{-21}\\,\\text{J}}$$\n$$k_{\\text{target}}^* = 0.060 \\times \\frac{0.25 \\times 10^{-18}}{6.2129205 \\times 10^{-21}} = \\frac{0.015 \\times 10^{-18}}{6.2129205 \\times 10^{-21}} \\approx 2.414305$$\nThe stiffness value in the simulation, $k_{\\text{sim}}^*$, must be a multiple of $0.10$. Furthermore, the physical stiffness corresponding to $k_{\\text{sim}}^*$ must be within $5\\%$ of $k_{\\text{AFM}}$. This requirement is equivalent to finding a $k_{\\text{sim}}^*$ that is within $5\\%$ of $k_{\\text{target}}^*$:\n$$|k_{\\text{sim}}^* - k_{\\text{target}}^*| \\le 0.05 \\times k_{\\text{target}}^*$$\n$$0.95 \\times k_{\\text{target}}^* \\le k_{\\text{sim}}^* \\le 1.05 \\times k_{\\text{target}}^*$$\nSubstituting the value of $k_{\\text{target}}^*$:\n$$0.95 \\times 2.414305 \\le k_{\\text{sim}}^* \\le 1.05 \\times 2.414305$$\n$$2.29359 \\le k_{\\text{sim}}^* \\le 2.53502$$\nThe possible values for $k_{\\text{sim}}^*$ are discrete multiples of $0.10$ that lie within this interval. The candidates are:\n- $k_1^* = 2.30$\n- $k_2^* = 2.40$\n- $k_3^* = 2.50$\n\nThe problem requires selecting the value that \"minimizes the absolute relative error,\" which is equivalent to minimizing the absolute difference $|k_{\\text{sim}}^* - k_{\\text{target}}^*|$. We compute this difference for each candidate:\n- For $k_1^* = 2.30$: $|2.30 - 2.414305| = 0.114305$\n- For $k_2^* = 2.40$: $|2.40 - 2.414305| = 0.014305$\n- For $k_3^* = 2.50$: $|2.50 - 2.414305| = 0.085695$\n\nThe minimum absolute difference corresponds to $k_{\\text{sim}}^* = 2.40$.\nThe problem requires the answer to be rounded to three significant figures. The value $2.40$ is already presented with three significant figures.\n\nTherefore, the virtual spring stiffness in simulation reduced units that best matches the experimental cantilever is $2.40\\,\\epsilon/\\sigma^2$.",
            "answer": "$$\\boxed{2.40}$$"
        },
        {
            "introduction": "Steered Molecular Dynamics pulls a system along a reaction coordinate, performing work ($W$) that, due to finite pulling speeds, typically exceeds the equilibrium free energy change ($\\Delta F$). This exercise explores the fundamental relationship between these quantities using an analytically solvable model based on overdamped Langevin dynamics . By deriving the total work and comparing it to the reversible work, you will gain a clear, first-principles understanding of non-equilibrium dissipation, a central concept in the theoretical framework of SMD.",
            "id": "3809094",
            "problem": "A one-dimensional reaction coordinate $x$ for a biomolecular system is modeled by a quadratic underlying free energy $F_{\\text{sys}}(x) = \\frac{1}{2} a x^{2}$, where $a$ is a positive stiffness-like parameter. In Steered Molecular Dynamics (SMD), a harmonic bias $U_{\\text{bias}}(x,\\lambda) = \\frac{1}{2} k_{s} \\left(x - \\lambda\\right)^{2}$ is applied, whose center $\\lambda(t)$ is translated at constant velocity according to $\\lambda(t) = v t$ for $t \\in [0, T]$. The generalized force exerted by the spring on the protocol coordinate is $F_{\\text{spring}}(t) = k_{s} \\left(\\lambda(t) - x(t)\\right)$. The total work performed by the moving bias is defined by\n$$\nW \\;=\\; \\int_{0}^{T} F_{\\text{spring}}(t)\\,\\dot{\\lambda}(t)\\,dt \\;=\\; \\int_{0}^{T} k_{s} \\left(\\lambda(t) - x(t)\\right)\\,v\\,dt.\n$$\nAssume overdamped dynamics for $x(t)$ with friction coefficient $\\zeta$, described (for the ensemble average) by the deterministic limit of the overdamped Langevin equation,\n$$\n\\zeta \\,\\dot{x}(t) \\;=\\; -\\frac{d}{dx}\\Big(F_{\\text{sys}}(x) + U_{\\text{bias}}(x,\\lambda)\\Big)\\Big|_{x=x(t)} \\;=\\; - a\\,x(t) \\;-\\; k_{s}\\left(x(t) - \\lambda(t)\\right),\n$$\nwith the initial condition $x(0)$ equal to the equilibrium mean at $\\lambda(0)=0$. Let the reversible work be defined as the quasistatic limit of the protocol, $\\Delta F \\equiv \\lim_{v \\to 0} W$, i.e., the work when the system responds adiabatically to the moving bias.\n\nStarting from these definitions and fundamental laws, derive $W$ and $\\Delta F$ for the constant-velocity protocol through the quadratic free energy landscape. Then, for the parameter values\n$$\na = 0.20~\\text{N}\\cdot\\text{m}^{-1}, \\quad k_{s} = 0.60~\\text{N}\\cdot\\text{m}^{-1}, \\quad \\zeta = 2.00 \\times 10^{-11}~\\text{N}\\cdot\\text{s}\\cdot\\text{m}^{-1}, \\quad v = 4.00~\\text{m}\\cdot\\text{s}^{-1}, \\quad T = 1.25 \\times 10^{-9}~\\text{s},\n$$\ncompute the dissipated work $W - \\Delta F$. Express your final answer in Joules and round your answer to four significant figures.",
            "solution": "### Step 1: Extract Givens\nThe problem provides the following data, definitions, and equations:\n1.  **System free energy**: $F_{\\text{sys}}(x) = \\frac{1}{2} a x^{2}$\n2.  **Harmonic bias potential**: $U_{\\text{bias}}(x,\\lambda) = \\frac{1}{2} k_{s} \\left(x - \\lambda\\right)^{2}$\n3.  **Protocol for bias center**: $\\lambda(t) = v t$ for $t \\in [0, T]$\n4.  **Spring force**: $F_{\\text{spring}}(t) = k_{s} \\left(\\lambda(t) - x(t)\\right)$\n5.  **Total work**: $W = \\int_{0}^{T} F_{\\text{spring}}(t)\\,\\dot{\\lambda}(t)\\,dt = \\int_{0}^{T} k_{s} \\left(\\lambda(t) - x(t)\\right)\\,v\\,dt$\n6.  **Equation of motion (ensemble average)**: $\\zeta \\,\\dot{x}(t) = - a\\,x(t) - k_{s}\\left(x(t) - \\lambda(t)\\right)$\n7.  **Initial condition**: $x(0)$ is the equilibrium mean at $\\lambda(0)=0$.\n8.  **Reversible work**: $\\Delta F \\equiv \\lim_{v \\to 0} W$ (for a fixed final protocol value $\\lambda_f = vT$).\n9.  **Parameter values**:\n    - $a = 0.20~\\text{N}\\cdot\\text{m}^{-1}$\n    - $k_{s} = 0.60~\\text{N}\\cdot\\text{m}^{-1}$\n    - $\\zeta = 2.00 \\times 10^{-11}~\\text{N}\\cdot\\text{s}\\cdot\\text{m}^{-1}$\n    - $v = 4.00~\\text{m}\\cdot\\text{s}^{-1}$\n    - $T = 1.25 \\times 10^{-9}~\\text{s}$\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes a canonical model in non-equilibrium statistical mechanics and multiscale modeling: a particle in a harmonic potential well being pulled by a moving harmonic trap. This setup is central to understanding steered molecular dynamics (SMD) simulations.\n\n1.  **Scientifically Grounded**: The problem is based on the well-established framework of overdamped Langevin dynamics for a Brownian particle. The concepts of work, free energy, and dissipation are standard in thermodynamics and statistical mechanics. All equations are physically and mathematically sound.\n2.  **Well-Posed**: The problem is clearly defined with a linear first-order ordinary differential equation, a specific initial condition, and a clear objective (calculate the dissipated work). A unique and stable solution exists for the trajectory $x(t)$, and consequently for the work $W$.\n3.  **Objective**: The language is precise and quantitative. All terms are formally defined.\n4.  **Self-Contained and Consistent**: All necessary information to solve the problem is provided. The units of the given parameters are consistent within the SI system.\n5.  **Not Trivial**: The solution requires solving a differential equation and performing integration, followed by careful algebraic manipulation and numerical calculation. It is a substantive problem.\n\n### Step 3: Verdict and Action\nThe problem is valid. We proceed to the solution.\n\n### Derivation of the Dissipated Work\n\nFirst, we determine the initial condition $x(0)$. The system is initially in equilibrium at $\\lambda(0)=0$. The equilibrium position $x_{\\text{eq}}$ is where the total force is zero. The force is derived from the total potential $U_{\\text{total}}(x, \\lambda) = F_{\\text{sys}}(x) + U_{\\text{bias}}(x, \\lambda)$.\n$$F_x = -\\frac{d}{dx}\\left(\\frac{1}{2}ax^2 + \\frac{1}{2}k_s(x-\\lambda)^2\\right) = -ax - k_s(x-\\lambda)$$\nSetting $F_x=0$ yields $ax_{\\text{eq}} + k_s(x_{\\text{eq}}-\\lambda) = 0$, which solves to $x_{\\text{eq}}(\\lambda) = \\frac{k_s}{a+k_s}\\lambda$.\nFor $\\lambda(0)=0$, the initial condition is $x(0) = x_{\\text{eq}}(0) = 0$.\n\nNext, we solve the equation of motion for $x(t)$:\n$$\\zeta \\frac{dx}{dt} = -ax - k_s(x - \\lambda(t))$$\n$$\\zeta \\frac{dx}{dt} + (a+k_s)x = k_s \\lambda(t)$$\nSubstituting $\\lambda(t) = vt$, we get a first-order linear non-homogeneous ordinary differential equation:\n$$\\frac{dx}{dt} + \\frac{a+k_s}{\\zeta}x = \\frac{k_s v}{\\zeta}t$$\nThe solution consists of a homogeneous part $x_h(t) = C \\exp\\left(-\\frac{a+k_s}{\\zeta}t\\right)$ and a particular solution $x_p(t)$. We guess a particular solution of the form $x_p(t) = At+B$. Substituting into the ODE gives:\n$$A + \\frac{a+k_s}{\\zeta}(At+B) = \\frac{k_s v}{\\zeta}t$$\nEquating coefficients of powers of $t$:\n- $t^1: \\quad \\frac{a+k_s}{\\zeta}A = \\frac{k_s v}{\\zeta} \\implies A = \\frac{k_s v}{a+k_s}$\n- $t^0: \\quad A + \\frac{a+k_s}{\\zeta}B = 0 \\implies B = -A \\frac{\\zeta}{a+k_s} = -\\frac{\\zeta k_s v}{(a+k_s)^2}$\nThe general solution is $x(t) = C \\exp\\left(-\\frac{a+k_s}{\\zeta}t\\right) + \\frac{k_s v}{a+k_s}t - \\frac{\\zeta k_s v}{(a+k_s)^2}$.\nUsing the initial condition $x(0)=0$:\n$$0 = C - \\frac{\\zeta k_s v}{(a+k_s)^2} \\implies C = \\frac{\\zeta k_s v}{(a+k_s)^2}$$\nThus, the trajectory is:\n$$x(t) = \\frac{k_s v}{a+k_s}t - \\frac{\\zeta k_s v}{(a+k_s)^2}\\left(1 - \\exp\\left(-\\frac{a+k_s}{\\zeta}t\\right)\\right)$$\n\nThe reversible work $\\Delta F$ is the change in the equilibrium free energy of the combined system from $\\lambda=0$ to $\\lambda=\\lambda_f = vT$. The equilibrium free energy is $F(\\lambda) = U_{\\text{total}}(x_{\\text{eq}}(\\lambda), \\lambda)$:\n$$F(\\lambda) = \\frac{1}{2}a\\left(\\frac{k_s\\lambda}{a+k_s}\\right)^2 + \\frac{1}{2}k_s\\left(\\frac{k_s\\lambda}{a+k_s} - \\lambda\\right)^2 = \\frac{1}{2}\\lambda^2 \\frac{ak_s^2+k_sa^2}{(a+k_s)^2} = \\frac{1}{2}\\frac{ak_s}{a+k_s}\\lambda^2$$\nThe reversible work is $\\Delta F = F(vT) - F(0) = \\frac{1}{2}\\frac{ak_s}{a+k_s}(vT)^2$.\n\nThe total work is $W = \\int_{0}^{T} k_s (\\lambda(t)-x(t))v\\,dt$. Let's find $\\lambda(t)-x(t)$:\n$$\\lambda(t)-x(t) = vt - \\left[\\frac{k_s v}{a+k_s}t - \\frac{\\zeta k_s v}{(a+k_s)^2}\\left(1 - \\exp\\left(-\\frac{a+k_s}{\\zeta}t\\right)\\right)\\right]$$\n$$\\lambda(t)-x(t) = \\frac{a}{a+k_s}vt + \\frac{\\zeta k_s v}{(a+k_s)^2}\\left(1 - \\exp\\left(-\\frac{a+k_s}{\\zeta}t\\right)\\right)$$\nIntegrating to find the work $W$:\n$$W = k_s v \\int_0^T \\left[\\frac{a v t}{a+k_s} + \\frac{\\zeta k_s v}{(a+k_s)^2}\\left(1 - \\exp\\left(-\\frac{a+k_s}{\\zeta}t\\right)\\right)\\right]dt$$\n$$W = \\frac{ak_sv^2}{a+k_s}\\int_0^T t\\,dt + \\frac{\\zeta k_s^2 v^2}{(a+k_s)^2}\\int_0^T \\left(1 - \\exp\\left(-\\frac{a+k_s}{\\zeta}t\\right)\\right)dt$$\nThe first integral is $\\frac{T^2}{2}$. The second is $\\left[t + \\frac{\\zeta}{a+k_s}\\exp\\left(-\\frac{a+k_s}{\\zeta}t\\right)\\right]_0^T = T - \\frac{\\zeta}{a+k_s}\\left(1-\\exp\\left(-\\frac{a+k_s}{\\zeta}T\\right)\\right)$.\n$$W = \\frac{1}{2}\\frac{ak_s}{a+k_s}(vT)^2 + \\frac{\\zeta k_s^2 v^2}{(a+k_s)^2}\\left[T - \\frac{\\zeta}{a+k_s}\\left(1-\\exp\\left(-\\frac{a+k_s}{\\zeta}T\\right)\\right)\\right]$$\nThe first term is exactly the reversible work $\\Delta F$. The dissipated work is $W_{\\text{diss}} = W - \\Delta F$:\n$$W_{\\text{diss}} = \\frac{\\zeta k_s^2 v^2}{(a+k_s)^2}\\left[T - \\frac{\\zeta}{a+k_s}\\left(1-\\exp\\left(-\\frac{a+k_s}{\\zeta}T\\right)\\right)\\right]$$\n\nNow we substitute the given numerical values:\n$a = 0.20~\\text{N}\\cdot\\text{m}^{-1}$, $k_s = 0.60~\\text{N}\\cdot\\text{m}^{-1}$, $\\zeta = 2.00 \\times 10^{-11}~\\text{N}\\cdot\\text{s}\\cdot\\text{m}^{-1}$, $v = 4.00~\\text{m}\\cdot\\text{s}^{-1}$, $T = 1.25 \\times 10^{-9}~\\text{s}$.\n\nFirst, we compute the combinations of parameters:\n$a+k_s = 0.20 + 0.60 = 0.80~\\text{N}\\cdot\\text{m}^{-1}$.\nLet $\\tau = \\frac{\\zeta}{a+k_s}$ be the relaxation time of the system.\n$$\\tau = \\frac{2.00 \\times 10^{-11}~\\text{N}\\cdot\\text{s}\\cdot\\text{m}^{-1}}{0.80~\\text{N}\\cdot\\text{m}^{-1}} = 2.5 \\times 10^{-11}~\\text{s}$$\nThe argument of the exponential is $\\frac{T}{\\tau}$:\n$$\\frac{T}{\\tau} = \\frac{1.25 \\times 10^{-9}~\\text{s}}{2.5 \\times 10^{-11}~\\text{s}} = 50$$\nThe expression for dissipated work can be written as $W_{\\text{diss}} = \\frac{\\zeta k_s^2 v^2}{(a+k_s)^2} [T - \\tau(1-\\exp(-T/\\tau))]$.\nLet's compute the prefactor:\n$$\\frac{\\zeta k_s^2 v^2}{(a+k_s)^2} = \\frac{(2.00 \\times 10^{-11}) (0.60)^2 (4.00)^2}{(0.80)^2} = \\frac{(2.00 \\times 10^{-11}) \\times 0.36 \\times 16.0}{0.64}~\\text{J}\\cdot\\text{s}^{-1}$$\n$$= \\frac{11.52 \\times 10^{-11}}{0.64} = 18.0 \\times 10^{-11} = 1.80 \\times 10^{-10}~\\text{J}\\cdot\\text{s}^{-1}$$\nNow compute the term in the square brackets:\n$$T - \\tau(1-\\exp(-T/\\tau)) = 1.25 \\times 10^{-9} - (2.5 \\times 10^{-11})(1 - \\exp(-50))~\\text{s}$$\nSince $\\exp(-50) \\approx 1.9 \\times 10^{-22}$, it is negligible compared to $1$.\n$$ \\approx 1.25 \\times 10^{-9} - 2.5 \\times 10^{-11} = 1.25 \\times 10^{-9} - 0.025 \\times 10^{-9} = 1.225 \\times 10^{-9}~\\text{s}$$\nFinally, we compute the dissipated work:\n$$W_{\\text{diss}} = (1.80 \\times 10^{-10}~\\text{J}\\cdot\\text{s}^{-1}) \\times (1.225 \\times 10^{-9}~\\text{s})$$\n$$W_{\\text{diss}} = 2.205 \\times 10^{-19}~\\text{J}$$\nThe problem asks for the answer to be rounded to four significant figures, which this result already has.",
            "answer": "$$\\boxed{2.205 \\times 10^{-19}}$$"
        },
        {
            "introduction": "A common application of SMD is to measure the force required to rupture a molecular bond, but this \"rupture force\" can be a misleading artifact of the simulation protocol. This hands-on coding exercise challenges you to simulate a bond-pulling experiment at different speeds and analyze the results . You will discover how at high pulling velocities, the measured peak force becomes dominated by viscous effects and loses its correlation with the true binding energy, highlighting a crucial pitfall in non-equilibrium simulations.",
            "id": "2463081",
            "problem": "A single collective coordinate $x(t)$ describes the separation of a ligand from a receptor along a pulling axis. The ligand experiences an intrinsic binding potential $U(x)$ and a time-dependent external restraint from a harmonic spring whose anchor point moves at constant speed $v$. In the overdamped limit of Langevin dynamics at zero temperature (deterministic limit), the evolution of $x(t)$ is governed by the force balance\n$$\n\\gamma \\,\\frac{dx}{dt} \\;=\\; -\\,\\frac{dU}{dx}(x) \\;-\\; k_s\\bigl(x - x_s(t)\\bigr),\n$$\nwhere $\\gamma$ is the friction coefficient, $k_s$ is the spring constant, and $x_s(t) = v\\,t$ is the pulling stage position. The measured force is the spring force\n$$\nF_{\\text{spring}}(t) \\;=\\; k_s\\,\\bigl(x(t) - x_s(t)\\bigr),\n$$\nand its magnitude $\\lvert F_{\\text{spring}}(t)\\rvert$ typically shows a peak (“rupture force”) during a pull.\n\nYou will model the binding potential as a Morse well with depth $\\varepsilon$ and range parameter $a$,\n$$\nU(x) \\;=\\; \\varepsilon\\left[\\left(1 - e^{-a x}\\right)^2 - 1\\right],\n$$\nwhich has a minimum at $x = 0$ with $U(0) = -\\varepsilon$ and $U(x)\\to 0$ as $x\\to +\\infty$. Under this definition, the equilibrium binding free energy difference between the bound minimum and the unbound baseline is $\\Delta F = \\varepsilon$.\n\nStarting from the overdamped force balance and the definition of the spring force, derive a numerical scheme suitable for stable time stepping in the zero-temperature overdamped regime, and implement a program that does the following.\n\n1) Use the following physically consistent parameters and units:\n- Length in nanometers (nm), time in picoseconds (ps), force in piconewtons (pN), and energy in pN·nm.\n- Temperature is fixed at $0$ K (deterministic limit).\n- Friction coefficient $\\gamma = 5000$ pN·ps/nm.\n- Spring constant $k_s = 100$ pN/nm.\n- Morse range parameter $a = 6$ nm$^{-1}$.\n- Binding depths $\\varepsilon \\in \\{\\varepsilon_i\\}_{i=1}^{4}$ with values $\\varepsilon_1 = 10$ pN·nm, $\\varepsilon_2 = 20$ pN·nm, $\\varepsilon_3 = 30$ pN·nm, $\\varepsilon_4 = 40$ pN·nm.\n- Initial condition $x(0) = 0$ nm and $x_s(0) = 0$ nm.\n- Time step $\\Delta t = 0.001$ ps and total simulation time $T = 50$ ps.\n\n2) For each depth $\\varepsilon_i$, integrate the equation of motion to obtain $x(t)$ and compute the maximum magnitude of the spring force over the trajectory,\n$$\nF_{\\max}(v;\\varepsilon_i) \\;=\\; \\max_{t\\in[0,T]} \\lvert F_{\\text{spring}}(t)\\rvert.\n$$\n\n3) Consider the test suite of three pulling speeds $v$:\n- A quasi-adiabatic case $v_1 = 0.01$ nm/ps (slow),\n- A non-equilibrium case $v_2 = 0.05$ nm/ps (intermediate),\n- A strongly non-equilibrium case $v_3 = 0.50$ nm/ps (fast).\n\nFor each $v_j$, evaluate the Pearson linear correlation coefficient between the list of equilibrium binding free energies $\\bigl[\\Delta F_i\\bigr]_{i=1}^{4} = \\bigl[\\varepsilon_i\\bigr]_{i=1}^{4}$ and the corresponding rupture force list $\\bigl[F_{\\max}(v_j;\\varepsilon_i)\\bigr]_{i=1}^{4}$.\n\n4) Your program must output a single line containing the three correlation coefficients for $v_1$, $v_2$, and $v_3$, in that order, as a comma-separated list enclosed in square brackets. For example, the printed line should look like \"[c1,c2,c3]\" where each $c_j$ is a float number. There should be no extra spaces or text.\n\nScientific realism requirements:\n- Base your derivation on Newtonian mechanics in the overdamped limit and Hooke’s law for the spring. The Morse potential is a standard choice for short-range binding with a single minimum. The chosen parameters are consistent with nanometer–picosecond–piconewton units used in computational chemistry.\n- The numerical integration must be justified from the governing equation and be dimensionally consistent.\n- Express the final correlation coefficients as dimensionless floats.\n\nTest suite coverage requirements:\n- The slow case $v_1$ serves as a “happy path” that is closer to reversible pulling, where $\\lvert F_{\\max}\\rvert$ should be influenced by $\\Delta F$.\n- The intermediate case $v_2$ probes a transition regime.\n- The fast case $v_3$ is an edge case designed to demonstrate a “rupture force artifact,” where $\\lvert F_{\\max}\\rvert$ can be dominated by the viscous term and loses correlation with $\\Delta F$.\n\nThe program should produce a single line of output containing the three correlation coefficients as a comma-separated list enclosed in square brackets. Angles are not used. No percentages should appear in the output; correlations are pure numbers without units.",
            "solution": "The problem statement has been validated and is deemed scientifically sound, well-posed, and complete. It describes a canonical model of force-probe molecular dynamics in the deterministic, overdamped limit. We shall now derive the numerical solution.\n\nThe problem requires the numerical integration of the equation of motion for a collective coordinate $x(t)$ under the influence of an intrinsic potential $U(x)$ and an external time-dependent harmonic restraint. The governing equation is given by the force balance in the overdamped regime at zero temperature:\n$$\n\\gamma \\frac{dx}{dt} = F_{\\text{intrinsic}}(x) + F_{\\text{external}}(x, t)\n$$\nwhere $\\gamma$ is the friction coefficient. The force components are:\n1.  The intrinsic force derived from the Morse potential, $F_{\\text{intrinsic}}(x) = -\\frac{dU}{dx}(x)$.\n2.  The external force from the moving spring, $F_{\\text{external}}(x, t) = -k_s(x - x_s(t))$.\n\nThe Morse potential is given as $U(x) = \\varepsilon\\left[\\left(1 - e^{-a x}\\right)^2 - 1\\right]$. Its derivative with respect to $x$ is:\n$$\n\\frac{dU}{dx}(x) = \\varepsilon \\cdot 2(1 - e^{-ax}) \\cdot \\frac{d}{dx}(1 - e^{-ax}) = 2\\varepsilon(1 - e^{-ax})(a e^{-ax}) = 2a\\varepsilon(e^{-ax} - e^{-2ax})\n$$\nThe external spring's anchor point moves at a constant velocity $v$, so its position is $x_s(t) = v t$. Substituting these expressions into the equation of motion yields:\n$$\n\\gamma \\frac{dx}{dt} = -2a\\varepsilon(e^{-ax} - e^{-2ax}) - k_s(x - vt)\n$$\nTo facilitate numerical integration, we rearrange this first-order ordinary differential equation into the standard form $\\frac{dx}{dt} = f(x, t)$:\n$$\n\\frac{dx}{dt} = \\frac{1}{\\gamma} \\left[ -2a\\varepsilon(e^{-ax} - e^{-2ax}) - k_s(x - vt) \\right]\n$$\nWe will solve this equation using the Forward Euler method, which is a simple and explicit time-stepping scheme. For a time step $\\Delta t$, the position at time $t + \\Delta t$ is approximated from the position and velocity at time $t$:\n$$\nx(t + \\Delta t) \\approx x(t) + \\Delta t \\cdot \\frac{dx}{dt}\\bigg|_t\n$$\nLet $x_i = x(t_i)$ where $t_i = i\\Delta t$. The update rule is:\n$$\nx_{i+1} = x_i + \\frac{\\Delta t}{\\gamma} \\left[ -2a\\varepsilon(e^{-ax_i} - e^{-2ax_i}) - k_s(x_i - v t_i) \\right]\n$$\nThe stability of this scheme depends on the size of $\\Delta t$ relative to the characteristic relaxation times of the system. The effective stiffness of the total potential $U_{\\text{tot}}(x, t) = U(x) + \\frac{1}{2}k_s(x-vt)^2$ is $k_{\\text{eff}} = \\frac{d^2 U}{dx^2} + k_s$. The stiffness of the Morse potential, $\\frac{d^2 U}{dx^2} = 2a^2\\varepsilon(2e^{-2ax} - e^{-ax})$, has its maximum value at $x=0$, which is $k_{\\text{morse,max}} = 2a^2\\varepsilon$. For the largest value of $\\varepsilon = 40$ pN·nm and $a = 6$ nm$^{-1}$, this is $k_{\\text{morse,max}} = 2 \\cdot (6)^2 \\cdot 40 = 2880$ pN/nm. The total stiffness is approximately $k_{\\text{eff,max}} \\approx 2880 + k_s = 2880 + 100 = 2980$ pN/nm. The fastest relaxation time in the system is therefore $\\tau_{\\text{min}} = \\gamma / k_{\\text{eff,max}} \\approx 5000 / 2980 \\approx 1.68$ ps. The specified time step $\\Delta t = 0.001$ ps is more than three orders of magnitude smaller than this fastest timescale ($\\Delta t \\ll \\tau_{\\text{min}}$). Consequently, the Forward Euler method is guaranteed to be stable and accurate for this problem.\n\nThe simulation protocol is as follows. For each pulling speed $v \\in \\{0.01, 0.05, 0.50\\}$ nm/ps, we perform a series of simulations, one for each binding energy $\\varepsilon \\in \\{10, 20, 30, 40\\}$ pN·nm.\nFor each $(v, \\varepsilon)$ pair:\n1.  Initialize the system at $t=0$ with $x(0)=0$.\n2.  Iterate from $t=0$ to $T=50$ ps with time step $\\Delta t = 0.001$ ps. In each step $i$:\n    a. Calculate the current time $t_i = i \\Delta t$.\n    b. Update the particle position from $x_i$ to $x_{i+1}$ using the Euler formula derived above.\n    c. Calculate the spring force at the new position and time: $F_{\\text{spring}}(t_{i+1}) = k_s(x_{i+1} - v t_{i+1})$.\n3.  After the trajectory is generated, determine the maximum magnitude of the spring force: $F_{\\max}(v; \\varepsilon) = \\max_{t \\in [0, T]} |F_{\\text{spring}}(t)|$.\n\nAfter obtaining the list of rupture forces, $[F_{\\max}(v; \\varepsilon_1), F_{\\max}(v; \\varepsilon_2), F_{\\max}(v; \\varepsilon_3), F_{\\max}(v; \\varepsilon_4)]$, for a given velocity $v$, we calculate the Pearson linear correlation coefficient, $\\rho$, between this list and the list of corresponding binding free energies, $[\\Delta F_i] = [\\varepsilon_i]$. The Pearson correlation coefficient between two variables $X$ and $Y$ with $N$ samples is defined as:\n$$\n\\rho_{X,Y} = \\frac{\\sum_{i=1}^N (X_i - \\bar{X})(Y_i - \\bar{Y})}{\\sqrt{\\sum_{i=1}^N (X_i - \\bar{X})^2} \\sqrt{\\sum_{i=1}^N (Y_i - \\bar{Y})^2}}\n$$\nwhere $\\bar{X}$ and $\\bar{Y}$ are the sample means. This procedure is repeated for each of the three pulling speeds, yielding three correlation coefficients. The implementation of this entire procedure is provided in the subsequent section.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the steered molecular dynamics problem to find the correlation\n    between binding energy and rupture force at different pulling speeds.\n    \"\"\"\n    \n    # 1) Define physically consistent parameters and units\n    # Length in nm, time in ps, force in pN, energy in pN·nm\n    gamma = 5000.0  # Friction coefficient (pN·ps/nm)\n    k_s = 100.0     # Spring constant (pN/nm)\n    a = 6.0         # Morse range parameter (nm⁻¹)\n    \n    # Binding depths epsilon (pN·nm)\n    epsilons = np.array([10.0, 20.0, 30.0, 40.0])\n    \n    # Time parameters\n    dt = 0.001      # Time step (ps)\n    T = 50.0        # Total simulation time (ps)\n    \n    # Initial conditions\n    x0 = 0.0        # Initial position (nm)\n    \n    # 3) Test suite of pulling speeds\n    velocities = [0.01, 0.05, 0.50]  # Pulling speeds (nm/ps)\n\n    # List to store the correlation coefficients\n    correlation_results = []\n    \n    # Calculate number of steps\n    num_steps = int(T / dt)\n    \n    # Main simulation loop\n    for v in velocities:\n        max_forces = []\n        \n        for epsilon in epsilons:\n            # Initialize arrays for position and time\n            x = np.zeros(num_steps + 1)\n            t = np.linspace(0, T, num_steps + 1)\n            \n            x[0] = x0\n            \n            # Array to store spring force magnitude\n            spring_force_magnitudes = np.zeros(num_steps + 1)\n            # Initial spring force is zero\n            spring_force_magnitudes[0] = 0.0\n            \n            # 2) Integrate the equation of motion\n            for i in range(num_steps):\n                # Force from Morse potential\n                force_morse = -2.0 * a * epsilon * (np.exp(-a * x[i]) - np.exp(-2.0 * a * x[i]))\n                \n                # Position of the spring anchor\n                x_s = v * t[i]\n                \n                # Force from the spring on the particle\n                force_spring_on_particle = -k_s * (x[i] - x_s)\n                \n                # Total force on the particle\n                total_force = force_morse + force_spring_on_particle\n                \n                # Update position using Forward Euler method\n                x[i+1] = x[i] + (total_force / gamma) * dt\n                \n                # Calculate the measured spring force F_spring(t) = k_s * (x(t) - x_s(t))\n                # Note: t[i+1] corresponds to the time for x[i+1]\n                x_s_next = v * t[i+1]\n                f_spring = k_s * (x[i+1] - x_s_next)\n                \n                # Store its magnitude\n                spring_force_magnitudes[i+1] = np.abs(f_spring)\n\n            # Find the maximum magnitude of the spring force (rupture force)\n            F_max = np.max(spring_force_magnitudes)\n            max_forces.append(F_max)\n        \n        # 3) Evaluate the Pearson linear correlation coefficient\n        # Note: binding free energy Delta_F is equal to epsilon\n        correlation_matrix = np.corrcoef(epsilons, max_forces)\n        correlation = correlation_matrix[0, 1]\n        correlation_results.append(correlation)\n        \n    # 4) Output the results in the specified format\n    # Example format: \"[c1,c2,c3]\"\n    print(f\"[{','.join(map(str, correlation_results))}]\")\n\nsolve()\n```"
        }
    ]
}