{
    "hands_on_practices": [
        {
            "introduction": "在一次成功的加偏压模拟之后，一个核心问题是如何从累积的偏置势中重建真实的自由能形貌。这个练习将从统计力学的基本原理出发，推导出在充分采样（无限时间）极限下，淬火元动力学（WTMetaD）偏置势 $V_b(s)$ 与自由能 $F(s)$ 之间的精确数学关系。通过这个实践 ，你将掌握将模拟输出转化为物理上有意义的自由能景观的关键步骤。",
            "id": "4244349",
            "problem": "在一项关于带电界面上质子耦合电子转移的恒电势分子动力学研究中，您希望使用淬火元动力学 (WTMetaD) 沿一个集体变量 $s$（例如，电荷转移坐标）重建自由能面 $F(s)$。系统在温度 $T$ 下进行恒温控制，WTMetaD 偏置 $V_b(s,t)$ 通过沉积高斯山来构建，其瞬时速率根据 WTMetaD 方案进行调制。假设以下基本事实：\n\n- 偏置系综的统计力学表明，在外加偏置下，集体变量的稳态分布为 $P_b(s) \\propto \\exp\\!\\left(-\\beta\\,[F(s) + V_b(s)]\\right)$，其中 $\\beta = 1/(k_B T)$，$k_B$ 是玻尔兹曼常数，$T$ 是物理温度。\n- 在淬火元动力学 (WTMetaD) 中，给定 $s$ 处的瞬时偏置沉积速率与 $\\exp\\!\\left(-V_b(s,t)/(k_B \\Delta T)\\right)$ 成正比，其中 $\\Delta T$ 是偏置温度。在无限时间准稳态机制中，偏置累积的期望速率在整个 $s$ 上是均匀的，这意味着 $P_b(s)\\,\\exp\\!\\left(-V_b(s)/(k_B \\Delta T)\\right)$ 与 $s$ 无关。\n- WTMetaD 偏置因子 $\\gamma$ 定义为 $\\gamma = (T + \\Delta T)/T$。\n\n仅使用这些事实，推导连接 $V_b(s)$ 和 $F(s)$ 的无限时间关系式，并确定缩放因子 $c$ 使得 $F(s) = c\\,V_b(s)$（相差一个加性常数）。然后，对于在 $T = 300\\ \\mathrm{K}$、偏置因子 $\\gamma = 10$ 的条件下进行的模拟，计算偏置温度 $\\Delta T$（以 $\\mathrm{K}$ 为单位表示）和无限时间极限下的无量纲缩放因子 $c$。以行矩阵 $\\begin{pmatrix}\\Delta T & c\\end{pmatrix}$ 的形式给出您的最终答案。不要对答案进行四舍五入。",
            "solution": "问题要求推导自由能面 $F(s)$ 和收敛的淬火元动力学 (WTMetaD) 偏置势 $V_b(s)$ 之间的关系，并计算给定系统的特定参数。推导将基于问题陈述中提供的偏置统计力学系综和 WTMetaD 的基本原理。\n\n第一条原理指出，在内在自由能 $F(s)$ 和外加偏置 $V_b(s)$ 的共同影响下，集体变量 $s$ 的稳态概率分布由下式给出：\n$$P_b(s) \\propto \\exp\\left(-\\beta[F(s) + V_b(s)]\\right)$$\n其中 $\\beta = 1/(k_B T)$，$k_B$ 是玻尔兹曼常数，$T$ 是系统温度。我们可以用一个明确的归一化常数 $C_1$ 来写出这个式子：\n$$P_b(s) = C_1 \\exp\\left(-\\beta F(s) - \\beta V_b(s)\\right)$$\n\n第二条原理描述了在无限时间极限下达到的 WTMetaD 准稳态条件。它指出有效采样率在集体变量 $s$ 的空间中是均匀的。这在数学上表示为偏置概率 $P_b(s)$ 和一个调节因子之积为常数：\n$$P_b(s) \\exp\\left(-\\frac{V_b(s)}{k_B \\Delta T}\\right) = C_2$$\n其中 $\\Delta T$ 是偏置温度，$C_2$ 是一个常数。从此表达式中，我们可以分离出 $P_b(s)$：\n$$P_b(s) = C_2 \\exp\\left(\\frac{V_b(s)}{k_B \\Delta T}\\right)$$\n\n现在我们有了同一个稳态分布 $P_b(s)$ 的两个表达式。令它们相等可得：\n$$C_1 \\exp\\left(-\\beta F(s) - \\beta V_b(s)\\right) = C_2 \\exp\\left(\\frac{V_b(s)}{k_B \\Delta T}\\right)$$\n为了求解 $F(s)$，我们对两边取自然对数：\n$$\\ln(C_1) - \\beta F(s) - \\beta V_b(s) = \\ln(C_2) + \\frac{V_b(s)}{k_B \\Delta T}$$\n接下来，我们重新排列各项以分离出 $\\beta F(s)$：\n$$-\\beta F(s) = \\beta V_b(s) + \\frac{V_b(s)}{k_B \\Delta T} + \\ln(C_2) - \\ln(C_1)$$\n我们可以从右侧前两项中提出公因子 $V_b(s)$，并将对数项合并为一个常数 $C' = \\ln(C_2) - \\ln(C_1)$：\n$$-\\beta F(s) = V_b(s)\\left(\\beta + \\frac{1}{k_B \\Delta T}\\right) + C'$$\n两边除以 $-\\beta$ 来求解 $F(s)$：\n$$F(s) = -\\frac{1}{\\beta} V_b(s)\\left(\\beta + \\frac{1}{k_B \\Delta T}\\right) - \\frac{C'}{\\beta}$$\n令 $C_{add} = -C'/\\beta$ 为新的加性常数，我们简化括号中的项：\n$$F(s) = -V_b(s)\\left(1 + \\frac{1}{\\beta k_B \\Delta T}\\right) + C_{add}$$\n代入 $\\beta = 1/(k_B T)$ 的定义：\n$$F(s) = -V_b(s)\\left(1 + \\frac{k_B T}{k_B \\Delta T}\\right) + C_{add} = -V_b(s)\\left(1 + \\frac{T}{\\Delta T}\\right) + C_{add}$$\n这就是所求的 $F(s)$ 和 $V_b(s)$ 之间的关系。问题要求用偏置因子 $\\gamma$ 来表示这个关系，$\\gamma$ 定义为 $\\gamma = (T + \\Delta T)/T$。我们来处理这个缩放项：\n$$1 + \\frac{T}{\\Delta T} = \\frac{\\Delta T + T}{\\Delta T}$$\n根据 $\\gamma$ 的定义，我们有 $T + \\Delta T = \\gamma T$ 和 $\\Delta T = \\gamma T - T = T(\\gamma-1)$。将这些代入缩放项中得到：\n$$\\frac{\\Delta T + T}{\\Delta T} = \\frac{\\gamma T}{T(\\gamma-1)} = \\frac{\\gamma}{\\gamma-1}$$\n因此，自由能与收敛的偏置势之间的最终关系是：\n$$F(s) = -\\frac{\\gamma}{\\gamma-1}V_b(s) + C_{add}$$\n这个方程表明，自由能面 $F(s)$ 与收敛的 WTMetaD 偏置势 $V_b(s)$ 线性成正比（相差一个加性常数）。\n\n问题定义了一个缩放因子 $c$ 使得 $F(s) = c\\,V_b(s)$（相差一个加性常数）。通过与我们推导出的关系直接比较，我们发现：\n$$c = -\\frac{\\gamma}{\\gamma-1}$$\n\n现在，我们进行问题的数值计算部分。给定系统温度 $T = 300\\ \\mathrm{K}$ 和偏置因子 $\\gamma = 10$。\n\n首先，我们计算偏置温度 $\\Delta T$。使用 $\\gamma$ 的重新整理后的定义：\n$$\\Delta T = T(\\gamma - 1)$$\n代入给定值：\n$$\\Delta T = 300 \\cdot (10 - 1) = 300 \\cdot 9 = 2700\\ \\mathrm{K}$$\n\n其次，我们计算无量纲缩放因子 $c$：\n$$c = -\\frac{\\gamma}{\\gamma-1}$$\n代入 $\\gamma$ 的值：\n$$c = -\\frac{10}{10-1} = -\\frac{10}{9}$$\n\n最终答案要求以行矩阵 $\\begin{pmatrix}\\Delta T & c\\end{pmatrix}$ 的形式给出。其值为 $\\Delta T = 2700$ 和 $c = -10/9$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2700 & -\\frac{10}{9}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "元动力学等增强采样方法的主要目标是克服高能垒，从而加速对稀有事件的采样。但是，这种“加速”究竟有多显著？本练习  旨在量化淬火元动力学对能垒区域采样频率的提升效果，让你亲手推导并计算采样增强因子。这将帮助你直观地理解关键参数“偏置因子” $\\gamma$ 是如何调控模拟效率的。",
            "id": "4244390",
            "problem": "考虑一个单一集合变量 (CV) $s$，它在一个电化学体系的恒温分子动力学模拟中，捕捉了金属电极界面处阳离子去溶剂化事件的进程。沿 $s$ 的无偏置平稳概率密度遵循 Boltzmann 统计，因此对于温度 $T$ 下的自由能 $F(s)$，其概率密度与 $\\exp(-\\beta F(s))$ 成正比，其中 $\\beta = 1/(k_{B} T)$，$k_{B}$ 是 Boltzmann 常数。在以偏置因子 $\\gamma$ 为特征的 Well-Tempered Metadynamics (WTMetaD) 中，沿 $s$ 的长时间平稳概率密度与无偏置密度值的 $1/\\gamma$ 次幂成正比。考虑一个位于过渡态 $s^{\\ddagger}$ 的能垒区域和一个附近的反应物盆地 $s_{\\mathrm{b}}$，其自由能差为 $\\Delta F = F(s^{\\ddagger}) - F(s_{\\mathrm{b}})$。将相对于盆地的能垒采样概率定义为比率 $P(s^{\\ddagger})/P(s_{\\mathrm{b}})$。从第一性原理推导增强因子 $E(\\Delta F, \\gamma)$，其定义为\n$$\nE(\\Delta F, \\gamma) = \\frac{\\left[P_{\\gamma}(s^{\\ddagger})/P_{\\gamma}(s_{\\mathrm{b}})\\right]}{\\left[P_{0}(s^{\\ddagger})/P_{0}(s_{\\mathrm{b}})\\right]},\n$$\n其中 $P_{0}$ 表示无偏置平稳概率密度，$P_{\\gamma}$ 表示 WTMetaD 平稳概率密度。然后，在 $\\gamma = 8$ 和 $\\Delta F = 10 k_{B} T$ 的条件下计算 $E$ 的值。将最终答案表示为一个无量纲因子，并四舍五入到三位有效数字。",
            "solution": "该问题要求推导 Well-Tempered Metadynamics (WTMetaD) 中的增强因子 $E(\\Delta F, \\gamma)$，并随后针对一组特定参数进行计算。推导过程将从给出的平稳概率分布的基本定义出发。\n\n沿集合变量 $s$ 的无偏置平稳概率密度，记为 $P_0(s)$，遵循 Boltzmann 分布。它与负的自由能 $F(s)$ 除以热能 $k_B T$ 后的指数成正比。令 $\\beta = 1/(k_B T)$，其中 $k_B$ 是 Boltzmann 常数，$T$ 是绝对温度。\n该概率密度可以写成：\n$$\nP_0(s) = C_0 \\exp(-\\beta F(s))\n$$\n其中 $C_0$ 是一个归一化常数。问题将相对于盆地的能垒采样概率定义为在过渡态 $s^{\\ddagger}$ 和反应物盆地 $s_{\\mathrm{b}}$ 的概率密度之比。对于无偏置的情况，这个比率是：\n$$\n\\frac{P_0(s^{\\ddagger})}{P_0(s_{\\mathrm{b}})} = \\frac{C_0 \\exp(-\\beta F(s^{\\ddagger}))}{C_0 \\exp(-\\beta F(s_{\\mathrm{b}}))}\n$$\n归一化常数 $C_0$ 被消去。利用指数函数的性质，上式简化为：\n$$\n\\frac{P_0(s^{\\ddagger})}{P_0(s_{\\mathrm{b}})} = \\exp\\left(-\\beta [F(s^{\\ddagger}) - F(s_{\\mathrm{b}})]\\right)\n$$\n根据自由能垒的定义 $\\Delta F = F(s^{\\ddagger}) - F(s_{\\mathrm{b}})$，无偏置概率比变为：\n$$\n\\frac{P_0(s^{\\ddagger})}{P_0(s_{\\mathrm{b}})} = \\exp(-\\beta \\Delta F)\n$$\n这个量代表了增强因子 $E$ 定义中的分母。\n\n接下来，我们考虑 WTMetaD 中的平稳概率密度 $P_{\\gamma}(s)$，它由偏置因子 $\\gamma$ 表征。问题指出，该密度与无偏置密度的 $1/\\gamma$ 次幂成正比：\n$$\nP_{\\gamma}(s) \\propto [P_0(s)]^{1/\\gamma}\n$$\n引入一个新的归一化常数 $C_{\\gamma}$，我们可以写出：\n$$\nP_{\\gamma}(s) = C_{\\gamma} [P_0(s)]^{1/\\gamma} = C_{\\gamma} [C_0 \\exp(-\\beta F(s))]^{1/\\gamma} = C_{\\gamma} C_0^{1/\\gamma} \\exp\\left(-\\frac{\\beta F(s)}{\\gamma}\\right)\n$$\n令 $C'_{\\gamma} = C_{\\gamma} C_0^{1/\\gamma}$ 为 WTMetaD 分布的组合归一化常数。那么，\n$$\nP_{\\gamma}(s) = C'_{\\gamma} \\exp\\left(-\\frac{\\beta F(s)}{\\gamma}\\right)\n$$\n对于 WTMetaD 的情况，在过渡态和盆地的概率之比为：\n$$\n\\frac{P_{\\gamma}(s^{\\ddagger})}{P_{\\gamma}(s_{\\mathrm{b}})} = \\frac{C'_{\\gamma} \\exp\\left(-\\frac{\\beta F(s^{\\ddagger})}{\\gamma}\\right)}{C'_{\\gamma} \\exp\\left(-\\frac{\\beta F(s_{\\mathrm{b}})}{\\gamma}\\right)}\n$$\n常数 $C'_{\\gamma}$ 被消去，我们得到：\n$$\n\\frac{P_{\\gamma}(s^{\\ddagger})}{P_{\\gamma}(s_{\\mathrm{b}})} = \\exp\\left(-\\frac{\\beta}{\\gamma} [F(s^{\\ddagger}) - F(s_{\\mathrm{b}})]\\right) = \\exp\\left(-\\frac{\\beta \\Delta F}{\\gamma}\\right)\n$$\n这个量是增强因子 $E$ 定义中的分子。\n\n现在我们可以通过将推导出的比率代入其定义中来推导增强因子 $E(\\Delta F, \\gamma)$ 的表达式：\n$$\nE(\\Delta F, \\gamma) = \\frac{\\left[P_{\\gamma}(s^{\\ddagger})/P_{\\gamma}(s_{\\mathrm{b}})\\right]}{\\left[P_{0}(s^{\\ddagger})/P_{0}(s_{\\mathrm{b}})\\right]} = \\frac{\\exp\\left(-\\frac{\\beta \\Delta F}{\\gamma}\\right)}{\\exp(-\\beta \\Delta F)}\n$$\n使用恒等式 $\\exp(a)/\\exp(b) = \\exp(a-b)$，该表达式简化为：\n$$\nE(\\Delta F, \\gamma) = \\exp\\left(-\\frac{\\beta \\Delta F}{\\gamma} - (-\\beta \\Delta F)\\right) = \\exp\\left(\\beta \\Delta F - \\frac{\\beta \\Delta F}{\\gamma}\\right)\n$$\n提出公因子项 $\\beta \\Delta F$，我们得到增强因子的最终解析表达式：\n$$\nE(\\Delta F, \\gamma) = \\exp\\left(\\beta \\Delta F \\left(1 - \\frac{1}{\\gamma}\\right)\\right) = \\exp\\left(\\frac{\\Delta F}{k_B T} \\left(\\frac{\\gamma - 1}{\\gamma}\\right)\\right)\n$$\n这个表达式表明，对于 $\\gamma > 1$ 的情况，指数为正，导致增强因子 $E > 1$，这证实了 WTMetaD 增加了能垒区域的相对采样概率。\n\n最后一步是针对给定参数 $\\gamma = 8$ 和 $\\Delta F = 10 k_B T$ 计算该表达式的值。\n代入这些值，我们首先注意到项 $\\Delta F / (k_B T)$ 变为：\n$$\n\\frac{\\Delta F}{k_B T} = \\frac{10 k_B T}{k_B T} = 10\n$$\n现在我们将此结果和 $\\gamma=8$ 代入 E 的表达式中：\n$$\nE = \\exp\\left(10 \\left(1 - \\frac{1}{8}\\right)\\right) = \\exp\\left(10 \\left(\\frac{7}{8}\\right)\\right) = \\exp(8.75)\n$$\n计算其数值：\n$$\nE \\approx 6309.5734...\n$$\n问题要求答案四舍五入到三位有效数字。这得到 $6310$。用标准科学记数法表示为 $6.31 \\times 10^3$。",
            "answer": "$$\\boxed{6.31 \\times 10^{3}}$$"
        },
        {
            "introduction": "在理论层面，元动力学是一个加在自由能上的偏置势；但在实际的分子动力学模拟中，它必须转化为一个作用在粒子上的力才能驱动系统演化。本练习  让你扮演一名算法开发者，推导出一个沿集合变量（CV）的总广义力，该力结合了元动力学偏置和用于限制CV范围的边界“墙”势。这揭示了增强采样方法在模拟引擎中的核心力学实现，是连接理论与计算实践的重要一环。",
            "id": "3778848",
            "problem": "考虑一个在经典动力学下演化的多粒子系统，使用简约的无量纲单位，使得所有能量和力均为无量纲。设 $s = s(\\mathbf{x})$ 是一个可微的集体变量 (CV)，其具有物理意义的严格定义域为 $s \\in [s_{\\min}, s_{\\max}]$。为增强沿 $s$ 的采样，你应用了淬火元动力学方法，在该方法中，通过沉积高斯核来构建一个随时间变化的偏置势 $V_{\\mathrm{bias}}(s,t)$。这些高斯核的中心位于在沉积时间 $\\{t_i\\}_{i=1}^{N(t)}$ 记录的CV值 $\\{s_i\\}_{i=1}^{N(t)}$ 处，并具有基础高度 $w$、宽度 $\\sigma$、玻尔兹曼常数 $k_B$ 和调温参数 $\\Delta T > 0$。第 $i$ 个沉积的高斯核的高度按 $\\exp\\!\\left(- V_{\\mathrm{bias}}(s_i,t_i)/(k_B \\Delta T)\\right)$ 进行缩放，其中 $V_{\\mathrm{bias}}(s_i,t_i)$ 表示在位置 $s_i$ 处进行第 $i$ 次沉积前瞬间的累积偏置。因此，偏置势的形式为\n$$\nV_{\\mathrm{bias}}(s,t) \\;=\\; \\sum_{i=1}^{N(t)} w \\,\\exp\\!\\left(- \\frac{V_{\\mathrm{bias}}(s_i,t_i)}{k_B \\Delta T}\\right)\\, \\exp\\!\\left(- \\frac{(s - s_i)^2}{2 \\sigma^2}\\right).\n$$\n为了对 $s$ 施加严格的边界限制，你在边界处添加了软半谐波墙势：\n$$\nV_{\\mathrm{L}}(s) \\;=\\; \\frac{1}{2}\\,k_{\\mathrm{L}}\\,\\big[\\,\\max(0,\\, s_{\\min} - s)\\,\\big]^2,\\qquad\nV_{\\mathrm{R}}(s) \\;=\\; \\frac{1}{2}\\,k_{\\mathrm{R}}\\,\\big[\\,\\max(0,\\, s - s_{\\max})\\,\\big]^2,\n$$\n其劲度系数为 $k_{\\mathrm{L}} > 0$ 和 $k_{\\mathrm{R}} > 0$。作用于该CV上的总附加势为 $V_{\\mathrm{tot}}(s,t) = V_{\\mathrm{bias}}(s,t) + V_{\\mathrm{L}}(s) + V_{\\mathrm{R}}(s)$。\n\n仅从势能可加和与 $s$ 共轭的广义力为 $- \\partial V_{\\mathrm{tot}}(s,t)/\\partial s$ 这两条原则出发，推导出沿CV的总广义力\n$$\nF_s(s,t) \\;=\\; -\\frac{\\partial}{\\partial s}\\,V_{\\mathrm{tot}}(s,t),\n$$\n的闭式解析表达式，该表达式应明确地表示为 $s$、沉积历史 $\\{s_i,t_i\\}_{i=1}^{N(t)}$ 以及参数 $w$、$\\sigma$、$k_B$、$\\Delta T$、$k_{\\mathrm{L}}$、$k_{\\mathrm{R}}$、$s_{\\min}$ 和 $s_{\\max}$ 的函数。如果需要，你可以使用正部算子 $[x]_+ \\equiv \\max(0,x)$。在简约的无量纲单位下进行计算。你的最终答案必须是 $F_s(s,t)$ 的单个闭式解析表达式。",
            "solution": "与集体变量 $s$ 共轭的总广义力 $F_s(s,t)$ 定义为总势能 $V_{\\mathrm{tot}}(s,t)$ 对 $s$ 的负偏导数：\n$$F_s(s,t) = -\\frac{\\partial}{\\partial s}V_{\\mathrm{tot}}(s,t)$$\n鉴于总势能是三个分量 $V_{\\mathrm{tot}}(s,t) = V_{\\mathrm{bias}}(s,t) + V_{\\mathrm{L}}(s) + V_{\\mathrm{R}}(s)$ 的和，并且微分算子是线性的，我们可以将总力写成从每个分量推导出的力之和：\n$$F_s(s,t) = -\\frac{\\partial V_{\\mathrm{bias}}(s,t)}{\\partial s} - \\frac{\\partial V_{\\mathrm{L}}(s)}{\\partial s} - \\frac{\\partial V_{\\mathrm{R}}(s)}{\\partial s}$$\n我们将分别计算每一项。\n\n**1. 来自元动力学偏置势的力, $F_{s, \\text{bias}}(s,t)$：**\n偏置势由下式给出：\n$$V_{\\mathrm{bias}}(s,t) = \\sum_{i=1}^{N(t)} w \\,\\exp\\left(- \\frac{V_{\\mathrm{bias}}(s_i,t_i)}{k_B \\Delta T}\\right)\\, \\exp\\left(- \\frac{(s - s_i)^2}{2 \\sigma^2}\\right)$$\n我们对 $s$ 进行微分。注意到对于求和中的每一项，只有 $\\exp\\left(- \\frac{(s - s_i)^2}{2 \\sigma^2}\\right)$ 因子依赖于 $s$。使用链式法则，我们得到：\n$$\\frac{\\partial V_{\\mathrm{bias}}}{\\partial s} = \\sum_{i=1}^{N(t)} w \\,\\exp\\left(- \\frac{V_{\\mathrm{bias}}(s_i,t_i)}{k_B \\Delta T}\\right) \\left[ \\exp\\left(- \\frac{(s - s_i)^2}{2 \\sigma^2}\\right) \\left(-\\frac{s - s_i}{\\sigma^2}\\right) \\right]$$\n因此，来自偏置势的力分量是该导数的负值：\n$$F_{s, \\text{bias}}(s,t) = -\\frac{\\partial V_{\\mathrm{bias}}}{\\partial s} = \\frac{w}{\\sigma^2} \\sum_{i=1}^{N(t)} (s - s_i) \\exp\\left(- \\frac{V_{\\mathrm{bias}}(s_i,t_i)}{k_B \\Delta T}\\right) \\exp\\left(- \\frac{(s - s_i)^2}{2 \\sigma^2}\\right)$$\n\n**2. 来自左墙势的力, $F_{s, \\text{L}}(s)$：**\n左墙势由 $V_{\\mathrm{L}}(s) = \\frac{1}{2}\\,k_{\\mathrm{L}}\\,\\big[\\,\\max(0,\\, s_{\\min} - s)\\,\\big]^2$ 给出。使用正部算子 $[x]_+ = \\max(0,x)$，可写为 $V_{\\mathrm{L}}(s) = \\frac{1}{2} k_{\\mathrm{L}} ([s_{\\min} - s]_+)^2$。\n使用链式法则对 $s$ 进行微分：\n$$\\frac{\\partial V_{\\mathrm{L}}}{\\partial s} = k_{\\mathrm{L}} [s_{\\min} - s]_+ \\cdot \\frac{\\partial}{\\partial s}(s_{\\min} - s) = -k_{\\mathrm{L}} [s_{\\min} - s]_+$$\n因此，力分量是：\n$$F_{s, \\text{L}}(s) = - \\frac{\\partial V_{\\mathrm{L}}}{\\partial s} = k_{\\mathrm{L}} [s_{\\min} - s]_+$$\n\n**3. 来自右墙势的力, $F_{s, \\text{R}}(s)$：**\n类似地，右墙势为 $V_{\\mathrm{R}}(s) = \\frac{1}{2}\\,k_{\\mathrm{R}}\\,\\big[\\,\\max(0,\\, s - s_{\\max})\\,\\big]^2$。\n其导数为：\n$$\\frac{\\partial V_{\\mathrm{R}}}{\\partial s} = k_{\\mathrm{R}} [s - s_{\\max}]_+ \\cdot \\frac{\\partial}{\\partial s}(s - s_{\\max}) = k_{\\mathrm{R}} [s - s_{\\max}]_+$$\n力分量是该导数的负值：\n$$F_{s, \\text{R}}(s) = - \\frac{\\partial V_{\\mathrm{R}}}{\\partial s} = -k_{\\mathrm{R}} [s - s_{\\max}]_+$$\n\n**4. 总广义力：**\n总力是各个力分量的和：\n$$F_s(s,t) = F_{s, \\text{bias}}(s,t) + F_{s, \\text{L}}(s) + F_{s, \\text{R}}(s)$$\n代入推导出的表达式，得到最终的闭式解析表达式：\n$$F_s(s,t) = \\frac{w}{\\sigma^2} \\sum_{i=1}^{N(t)} (s - s_i) \\exp\\left(- \\frac{V_{\\mathrm{bias}}(s_i,t_i)}{k_B \\Delta T}\\right) \\exp\\left(- \\frac{(s - s_i)^2}{2 \\sigma^2}\\right) + k_{\\mathrm{L}} [s_{\\min} - s]_+ - k_{\\mathrm{R}} [s - s_{\\max}]_+$$",
            "answer": "$$ \\boxed{ \\frac{w}{\\sigma^2} \\sum_{i=1}^{N(t)} (s - s_i) \\exp\\left(-\\frac{V_{\\mathrm{bias}}(s_i,t_i)}{k_B \\Delta T}\\right) \\exp\\left(-\\frac{(s - s_i)^2}{2 \\sigma^2}\\right) + k_{\\mathrm{L}} [s_{\\min} - s]_+ - k_{\\mathrm{R}} [s - s_{\\max}]_+ } $$"
        }
    ]
}