{
    "hands_on_practices": [
        {
            "introduction": "第一个实践通过考察最简单的情形——一维问题，为周期性均匀化理论提供了一个基础的切入点。通过推导层状介质的均匀化过程，你将亲手计算有效系数，并理解为何在此场景下自然出现的是调和平均，而非简单的算术平均。这个练习  对于建立微观结构如何决定宏观属性的直觉至关重要，它与串联电路中电阻的计算形成了直接的类比。",
            "id": "3794299",
            "problem": "考虑一个带有快速振荡系数的二阶线性椭圆型偏微分方程 (PDE) 的一维周期性均匀化问题。设 $a:\\mathbb{R}\\to(0,\\infty)$ 是一个可测、有界且1-周期的函数，并给定 $f\\in H^{-1}(0,L)$。对于 $\\varepsilon0$，考虑边值问题\n$$\n-\\frac{d}{dx}\\left(a\\left(\\frac{x}{\\varepsilon}\\right)\\frac{du_{\\varepsilon}}{dx}(x)\\right)=f(x)\\quad\\text{在 }(0,L)\\text{ 内},\\qquad u_{\\varepsilon}(0)=0,\\quad u_{\\varepsilon}(L)=0.\n$$\n从定常椭圆算子的通量守恒基本概念和均匀化理论中使用的周期性元胞问题公式出发，推导控制极限方程的等效（均匀化）标量系数 $a^{\\text{hom}}$\n$$\n-\\frac{d}{dx}\\left(a^{\\text{hom}}\\frac{du_{0}}{dx}(x)\\right)=f(x)\\quad\\text{在 }(0,L)\\text{ 内},\\qquad u_{0}(0)=0,\\quad u_{0}(L)=0,\n$$\n其中当 $\\varepsilon\\to 0$ 时，$u_{\\varepsilon}\\rightharpoonup u_{0}$ 在 $H_{0}^{1}(0,L)$ 中弱收敛。然后，将问题特殊化为每个周期具有两相的层状微结构：设 $0  \\alpha  1$，$a_{1}0$ 且 $a_{2}0$，并定义\n$$\na(y)=\\begin{cases}\na_{1},  y\\in[0,\\alpha), \\\\\na_{2},  y\\in[\\alpha,1),\n\\end{cases}\n$$\n并周期性地延拓到 $\\mathbb{R}$。显式地计算均匀化系数 $a^{\\text{hom}}$，给出一个用 $\\alpha$、$a_{1}$ 和 $a_{2}$ 表示的闭式解析表达式，并从基本原理出发解释为什么在一维 ($d=1$) 层状介质中会出现调和平均。将最终答案表示为单个解析表达式。无需四舍五入，也无需物理单位。",
            "solution": "所述问题是二阶椭圆算子一维周期性均匀化的一个典型例子。它在数学上是适定的，其科学基础在于多尺度分析理论，并且所有必要的条件和定义都已给出。该问题是有效的。\n\n我们的任务是推导方程\n$$-\\frac{d}{dx}\\left(a\\left(\\frac{x}{\\varepsilon}\\right)\\frac{du_{\\varepsilon}}{dx}(x)\\right)=f(x)\\quad\\text{在 }(0,L)\\text{ 内}$$\n在狄利克雷边界条件 $u_{\\varepsilon}(0)=u_{\\varepsilon}(L)=0$ 下的均匀化系数 $a^{\\text{hom}}$。系数 $a(y)$ 是一个1-周期的、可测的、有界的函数，且对于某个常数 $c$，$a(y)  c  0$。已知解 $u_\\varepsilon$ 在 $H^1_0(0,L)$ 中弱收敛于 $u_0$，而 $u_0$ 满足均匀化方程：\n$$-\\frac{d}{dx}\\left(a^{\\text{hom}}\\frac{du_{0}}{dx}(x)\\right)=f(x)\\quad\\text{在 }(0,L)\\text{ 内}$$\n\n$a^{\\text{hom}}$ 的推导可以从通量守恒和多尺度分析的角度进行。我们引入通量 $\\sigma_{\\varepsilon}(x) = -a\\left(\\frac{x}{\\varepsilon}\\right)\\frac{du_{\\varepsilon}}{dx}(x)$。则偏微分方程变为 $\\frac{d\\sigma_{\\varepsilon}}{dx} = f(x)$。在极限 $\\varepsilon \\to 0$下，通量 $\\sigma_{\\varepsilon}$ 弱收敛于一个均匀化通量 $\\sigma_{0}(x)$，它通过等效定律 $\\sigma_{0}(x) = -a^{\\text{hom}}\\frac{du_{0}}{dx}(x)$ 与宏观梯度 $\\frac{du_{0}}{dx}$ 相关联。\n\n为了求得 $a^{\\text{hom}}$，我们在两个尺度上分析该问题：由变量 $x$ 表征的宏观尺度，以及由快变量 $y = x/\\varepsilon$ 表征的微观尺度。均匀化的核心思想是，对于小的 $\\varepsilon$，解的局部行为类似于在单个周期性元胞 $Y=[0,1)$ 上提出的问题的行为。\n\n让我们考虑通量。在没有源项 ($f=0$) 的情况下，通量 $\\sigma_{\\varepsilon}$ 将是常数。有源项 $f$ 时，通量在宏观尺度上缓慢变化。然而，在微观尺度上，通量必须保持近似恒定。这是方程 $\\frac{d}{dx}(\\dots) = f$ 的一个推论。让我们使用双尺度渐近展开 $u_{\\varepsilon}(x) \\approx u_0(x) + \\varepsilon u_1(x,y)$ 来表示解的梯度，其中 $u_1$ 在 $y$ 方向上是1-周期的：\n$$\\frac{du_{\\varepsilon}}{dx} = \\frac{du_0}{dx} + \\frac{\\partial u_1}{\\partial y} + O(\\varepsilon)$$\n因此，微观通量为\n$$\\sigma_{\\varepsilon}(x) \\approx -a(y)\\left(\\frac{du_0}{dx}(x) + \\frac{\\partial u_1}{\\partial y}(x,y)\\right)$$\n在主导阶上，该偏微分方程变为一个关于快变量 $y$ 的方程：\n$$-\\frac{1}{\\varepsilon}\\frac{\\partial}{\\partial y}\\left(a(y)\\left(\\frac{du_0}{dx}(x) + \\frac{\\partial u_1}{\\partial y}(x,y)\\right)\\right) \\approx 0$$\n这意味着导数内的量，即微观通量，与 $y$ 无关。我们称这个微观通量为 $j(x)$。\n$$j(x) = -a(y)\\left(\\frac{du_0}{dx}(x) + \\frac{\\partial u_1}{\\partial y}(x,y)\\right)$$\n这是跨越微观各层的通量守恒的表述。由此，我们表示出局部梯度场：\n$$\\frac{du_0}{dx}(x) + \\frac{\\partial u_1}{\\partial y}(x,y) = -\\frac{j(x)}{a(y)}$$\n根据定义，宏观梯度 $\\frac{du_0}{dx}$ 是微观梯度场在周期性元胞 $Y$ 上的平均值。我们将上述表达式在 $[0,1)$ 上对 $y$ 进行平均，记平均为 $\\langle \\cdot \\rangle_y = \\int_0^1 (\\cdot) dy$。\n$$\\left\\langle \\frac{du_0}{dx}(x) + \\frac{\\partial u_1}{\\partial y}(x,y) \\right\\rangle_y = \\left\\langle -\\frac{j(x)}{a(y)} \\right\\rangle_y$$\n由于 $\\frac{du_0}{dx}$ 和 $j(x)$ 不依赖于 $y$，它们在平均过程中可被视为常数。$\\frac{\\partial u_1}{\\partial y}$ 的平均值由于 $u_1$ 在 $y$ 方向的周期性而为零：$\\langle \\frac{\\partial u_1}{\\partial y} \\rangle_y = \\int_0^1 \\frac{\\partial u_1}{\\partial y} dy = u_1(x,1) - u_1(x,0) = 0$。\n因此，方程简化为：\n$$\\frac{du_0}{dx}(x) = -j(x) \\left\\langle \\frac{1}{a(y)} \\right\\rangle_y$$\n宏观通量 $\\sigma_0(x)$ 是微观通量 $j(x,y)=j(x)$ 的平均值：\n$$\\sigma_0(x) = \\langle j(x) \\rangle_y = j(x)$$\n将 $j(x) = \\sigma_0(x)$ 代入前一个方程得到：\n$$\\frac{du_0}{dx}(x) = -\\sigma_0(x) \\left\\langle \\frac{1}{a(y)} \\right\\rangle_y$$\n重新整理以找到宏观本构关系 $\\sigma_0(x) = -a^{\\text{hom}}\\frac{du_0}{dx}(x)$：\n$$\\sigma_0(x) = -\\frac{1}{\\left\\langle \\frac{1}{a(y)} \\right\\rangle_y} \\frac{du_0}{dx}(x)$$\n将此与均匀化通量的定义进行比较，我们确定均匀化系数为：\n$$a^{\\text{hom}} = \\frac{1}{\\left\\langle \\frac{1}{a(y)} \\right\\rangle_y} = \\frac{1}{\\int_0^1 \\frac{1}{a(y)} dy}$$\n此公式表明，等效系数是微观系数在周期性元胞上的调和平均。\n\n这个结果的出现是因为在一维介质中，材料的各层相对于通量（电流）方向是串联排列的。如果我们将 $a(y)$ 视为电导率，那么它的倒数 $\\rho(y) = 1/a(y)$就是电阻率。对于串联的组件，总电阻是个体电阻之和。因此，等效电阻率 $\\rho^{\\text{hom}}$ 是微观电阻率的平均值：$\\rho^{\\text{hom}} = \\langle \\rho(y) \\rangle_y = \\int_0^1 (1/a(y)) dy$。等效电导率是等效电阻率的倒数，$a^{\\text{hom}} = 1/\\rho^{\\text{hom}}$，这直接导出了调和平均公式。\n\n现在，我们将其特殊化到给定的层状微结构：\n$$\na(y)=\\begin{cases}\na_{1},  y\\in[0,\\alpha), \\\\\na_{2},  y\\in[\\alpha,1),\n\\end{cases}\n$$\n其中 $0  \\alpha  1$，$a_{1}0$ 且 $a_{2}0$。我们计算 $a^{\\text{hom}}$ 公式分母中的积分：\n$$\\int_0^1 \\frac{1}{a(y)} dy = \\int_0^\\alpha \\frac{1}{a(y)} dy + \\int_\\alpha^1 \\frac{1}{a(y)} dy$$\n代入 $a(y)$ 的分段值：\n$$\\int_0^1 \\frac{1}{a(y)} dy = \\int_0^\\alpha \\frac{1}{a_1} dy + \\int_\\alpha^1 \\frac{1}{a_2} dy$$\n$$= \\frac{1}{a_1} [y]_0^\\alpha + \\frac{1}{a_2} [y]_\\alpha^1$$\n$$= \\frac{\\alpha}{a_1} + \\frac{1-\\alpha}{a_2}$$\n该表达式是平均电阻率，是两相电阻率的加权和，其权重等于它们的体积分数 $\\alpha$ 和 $1-\\alpha$。\n\n最后，均匀化系数 $a^{\\text{hom}}$ 是该平均电阻率的倒数：\n$$a^{\\text{hom}} = \\frac{1}{\\frac{\\alpha}{a_1} + \\frac{1-\\alpha}{a_2}}$$\n为了得到单个闭式表达式，我们简化该分数：\n$$a^{\\text{hom}} = \\frac{1}{\\frac{\\alpha a_2 + (1-\\alpha)a_1}{a_1 a_2}} = \\frac{a_1 a_2}{(1-\\alpha)a_1 + \\alpha a_2}$$\n这就是给定两相层状介质的均匀化系数的显式解析表达式。",
            "answer": "$$\\boxed{\\frac{a_1 a_2}{(1-\\alpha)a_1 + \\alpha a_2}}$$"
        },
        {
            "introduction": "在一维情形的基础上，这个练习  将挑战你处理一个具有各向异性棋盘格结构的二维问题。在这里，有效属性不再是一个标量，而是一个均匀化张量，反映了材料响应的方向依赖性。这个实践不仅要求你求解底层的元胞问题，还将通过计算有效质量张量，把均匀化理论与固态物理中的概念联系起来，展示了不同科学领域之间的深刻联系。",
            "id": "3794313",
            "problem": "考虑具有快速振荡周期性系数的散度形式二阶线性椭圆算子，\n$$\n\\mathcal{L}_{\\varepsilon} u_{\\varepsilon}(x) \\;=\\; -\\nabla \\cdot \\left( A\\!\\left(\\frac{x}{\\varepsilon}\\right) \\nabla u_{\\varepsilon}(x) \\right), \\quad x \\in \\mathbb{R}^{2},\n$$\n其中系数场 $A(y)$ 是 $\\mathbb{Z}^{2}$-周期的，并在单元胞 $Y = [0,1]^{2}$ 上呈现以下正交各向异性棋盘格形式：\n$$\nA(y) \\;=\\; \\begin{pmatrix}\na(y_{1})  0 \\\\\n0  c(y_{2})\n\\end{pmatrix},\n\\qquad\na(y_{1}) \\;=\\; \\begin{cases}\na_{1},  y_{1} \\in [0,\\tfrac{1}{2}), \\\\[0.25em]\na_{2},  y_{1} \\in [\\tfrac{1}{2},1),\n\\end{cases}\n\\qquad\nc(y_{2}) \\;=\\; \\begin{cases}\nc_{1},  y_{2} \\in [0,\\tfrac{1}{2}), \\\\[0.25em]\nc_{2},  y_{2} \\in [\\tfrac{1}{2},1),\n\\end{cases}\n$$\n其中 $a_{1},a_{2},c_{1},c_{2}  0$ 是固定的正常数。均匀化张量 $A^{\\text{hom}}$ 由与算子 $\\mathcal{L}_{\\varepsilon}$ 相关的标准周期性单元胞问题定义。\n\n定义周期算子 $-\\nabla \\cdot (A(y)\\nabla)$ 的布洛赫特征值问题，其准动量向量为 $\\theta \\in \\mathbb{R}^{2}$，\n$$\n-\\nabla \\cdot \\big(A(y)\\nabla \\phi_{\\theta}(y)\\big) \\;=\\; \\lambda(\\theta)\\,\\phi_{\\theta}(y),\n$$\n该问题在 $Y$ 上服从相位为 $\\theta$ 的准周期边界条件。对于小的 $|\\theta|$，最低能带函数 $\\lambda(\\theta)$ 在 $\\theta = 0$ 附近有一个二次展开。\n\n从散度形式椭圆方程的周期性均匀化和布洛赫准周期谱问题的基本定义出发，推导均匀化张量 $A^{\\text{hom}}$ 以及 $\\lambda(\\theta)$ 在 $\\theta = 0$ 附近的主阶二次展开。利用这些结果，由以下关系式定义有效质量张量 $M_{\\text{eff}}$\n$$\n\\lambda(\\theta) \\;=\\; \\frac{1}{2}\\,\\theta^{\\top} M_{\\text{eff}}^{-1}\\,\\theta \\;+\\; o(|\\theta|^{2}),\n\\qquad \\text{as } \\theta \\to 0,\n$$\n并用 $a_{1},a_{2},c_{1},c_{2}$ 显式计算 $M_{\\text{eff}}$。将您的最终答案表示为单个闭式解析表达式。不需要数值近似或四舍五入。",
            "solution": "该问题要求计算与周期性椭圆算子的低能激发相关的有效质量张量 $M_{\\text{eff}}$。这包含两个主要步骤：首先，利用周期性均匀化理论确定均匀化张量 $A^{\\text{hom}}$；其次，通过最低布洛赫特征值能带的二次展开，将该张量与有效质量张量 $M_{\\text{eff}}$ 联系起来。\n\n均匀化张量 $A^{\\text{hom}}$ 的分量由以下公式给出\n$$\nA^{\\text{hom}}_{ij} = \\int_{Y} \\left( A_{ij}(y) + \\sum_{k=1}^{2} A_{ik}(y) \\frac{\\partial \\chi_j}{\\partial y_k}(y) \\right) dy,\n$$\n其中 $Y = [0,1]^2$ 是单元胞，对于每个 $j \\in \\{1, 2\\}$，函数 $\\chi_j(y)$ 是具有零均值且满足以下单元胞问题的唯一 $Y$-周期解：\n$$\n-\\nabla_y \\cdot \\left( A(y) (\\nabla_y \\chi_j(y) + e_j) \\right) = 0 \\quad \\text{in } Y.\n$$\n这里，$e_j$ 是 $\\mathbb{R}^2$ 中的第 $j$ 个标准基向量。\n\n所给的系数张量 $A(y)$ 是对角的（正交各向异性），其元素是 $y_1$ 和 $y_2$ 的可分离函数：\n$$\nA(y) = \\begin{pmatrix} a(y_1)  0 \\\\ 0  c(y_2) \\end{pmatrix}.\n$$\n这种结构显著简化了单元胞问题。\n\n我们首先计算 $A^{\\text{hom}}_{11}$ 和 $A^{\\text{hom}}_{21}$。考虑 $j=1$ 的单元胞问题：\n$$\n-\\nabla_y \\cdot \\left( A(y) (\\nabla_y \\chi_1(y) + e_1) \\right) = 0.\n$$\n展开此方程可得：\n$$\n-\\frac{\\partial}{\\partial y_1} \\left( a(y_1) \\left( \\frac{\\partial \\chi_1}{\\partial y_1} + 1 \\right) \\right) - \\frac{\\partial}{\\partial y_2} \\left( c(y_2) \\frac{\\partial \\chi_1}{\\partial y_2} \\right) = 0.\n$$\n鉴于系数的可分离性，我们寻求一个仅依赖于 $y_1$ 的解，即 $\\chi_1(y) = \\chi_1(y_1)$。在此拟设下，$\\frac{\\partial \\chi_1}{\\partial y_2} = 0$，该方程简化为一个常微分方程：\n$$\n-\\frac{d}{d y_1} \\left( a(y_1) \\left( \\frac{d \\chi_1}{d y_1} + 1 \\right) \\right) = 0.\n$$\n对 $y_1$ 积分可得 $a(y_1) \\left( \\frac{d \\chi_1}{d y_1} + 1 \\right) = C_1$，其中 $C_1$ 是一个常数。因此，$\\frac{d \\chi_1}{d y_1} = \\frac{C_1}{a(y_1)} - 1$。\n$\\chi_1$ 的周期性要求 $\\chi_1(1) = \\chi_1(0)$，这意味着 $\\int_0^1 \\frac{d \\chi_1}{d y_1} dy_1 = 0$。\n$$\n\\int_0^1 \\left( \\frac{C_1}{a(y_1)} - 1 \\right) dy_1 = 0 \\implies C_1 \\int_0^1 \\frac{1}{a(y_1)} dy_1 - 1 = 0.\n$$\n这使我们可以解出 $C_1$：\n$$\nC_1 = \\left( \\int_0^1 \\frac{1}{a(y_1)} dy_1 \\right)^{-1}.\n$$\n现在，我们计算分量 $A^{\\text{hom}}_{i1}$：\n$$\nA^{\\text{hom}}_{11} = \\int_Y \\left( A_{11}(y) + A_{11}(y) \\frac{\\partial \\chi_1}{\\partial y_1} + A_{12}(y) \\frac{\\partial \\chi_1}{\\partial y_2} \\right) dy.\n$$\n由于 $A_{12}=0$ 且 $\\chi_1$ 仅依赖于 $y_1$，这可简化为：\n$$\nA^{\\text{hom}}_{11} = \\int_0^1 \\int_0^1 a(y_1) \\left( \\frac{d \\chi_1}{d y_1} + 1 \\right) dy_1 dy_2 = \\int_0^1 \\int_0^1 C_1 dy_1 dy_2 = C_1.\n$$\n因此，$A^{\\text{hom}}_{11}$ 是 $a(y_1)$ 在单元胞上的调和平均。使用 $a(y_1)$ 的定义：\n$$\n\\int_0^1 \\frac{1}{a(y_1)} dy_1 = \\int_0^{1/2} \\frac{1}{a_1} dy_1 + \\int_{1/2}^1 \\frac{1}{a_2} dy_1 = \\frac{1}{2a_1} + \\frac{1}{2a_2} = \\frac{a_1+a_2}{2a_1 a_2}.\n$$\n因此，\n$$\nA^{\\text{hom}}_{11} = \\frac{2a_1 a_2}{a_1+a_2}.\n$$\n对于非对角项 $A^{\\text{hom}}_{21}$：\n$$\nA^{\\text{hom}}_{21} = \\int_Y \\left( A_{21}(y) + A_{21}(y) \\frac{\\partial \\chi_1}{\\partial y_1} + A_{22}(y) \\frac{\\partial \\chi_1}{\\partial y_2} \\right) dy.\n$$\n由于 $A_{21}=0$ 且 $\\frac{\\partial \\chi_1}{\\partial y_2}=0$，我们有 $A^{\\text{hom}}_{21} = 0$。\n\n通过对 $j=2$ 的对称性论证，我们为 $e_2$ 的单元胞问题寻求一个解 $\\chi_2(y) = \\chi_2(y_2)$。这得到：\n$$\nA^{\\text{hom}}_{22} = C_2 = \\left( \\int_0^1 \\frac{1}{c(y_2)} dy_2 \\right)^{-1}.\n$$\n我们使用 $c(y_2)$ 的定义来计算该积分：\n$$\n\\int_0^1 \\frac{1}{c(y_2)} dy_2 = \\int_0^{1/2} \\frac{1}{c_1} dy_2 + \\int_{1/2}^1 \\frac{1}{c_2} dy_2 = \\frac{1}{2c_1} + \\frac{1}{2c_2} = \\frac{c_1+c_2}{2c_1 c_2}.\n$$\n因此，\n$$\nA^{\\text{hom}}_{22} = \\frac{2c_1 c_2}{c_1+c_2}.\n$$\n非对角项 $A^{\\text{hom}}_{12}$ 为零，因为 $A_{12}=0$ 且 $\\frac{\\partial \\chi_2}{\\partial y_1}=0$。\n因此，均匀化张量是对角的：\n$$\nA^{\\text{hom}} = \\begin{pmatrix} \\frac{2a_1 a_2}{a_1+a_2}  0 \\\\ 0  \\frac{2c_1 c_2}{c_1+c_2} \\end{pmatrix}.\n$$\n接下来，我们将 $A^{\\text{hom}}$ 与有效质量张量 $M_{\\text{eff}}$ 联系起来。布洛赫波的渐近分析的标准结果表明，对于小的准动量 $\\theta$，最低特征值能带 $\\lambda(\\theta)$ 具有以下展开式：\n$$\n\\lambda(\\theta) = \\theta^{\\top} A^{\\text{hom}} \\theta + o(|\\theta|^2).\n$$\n题目给出了有效质量张量 $M_{\\text{eff}}$ 的定义：\n$$\n\\lambda(\\theta) = \\frac{1}{2}\\,\\theta^{\\top} M_{\\text{eff}}^{-1}\\,\\theta + o(|\\theta|^2).\n$$\n比较 $\\lambda(\\theta)$ 的这两个表达式，我们在这两个矩阵之间建立直接的对应关系：\n$$\n\\theta^{\\top} A^{\\text{hom}} \\theta = \\frac{1}{2}\\,\\theta^{\\top} M_{\\text{eff}}^{-1}\\,\\theta.\n$$\n由于此等式必须对所有足够小的 $\\theta \\in \\mathbb{R}^2$ 成立，这些矩阵本身必须满足以下关系：\n$$\nA^{\\text{hom}} = \\frac{1}{2} M_{\\text{eff}}^{-1}.\n$$\n解出 $M_{\\text{eff}}$ 可得：\n$$\nM_{\\text{eff}} = (2 A^{\\text{hom}})^{-1} = \\frac{1}{2} (A^{\\text{hom}})^{-1}.\n$$\n由于 $A^{\\text{hom}}$ 是一个对角矩阵，其逆矩阵可以通过取其对角元素的倒数得到：\n$$\n(A^{\\text{hom}})^{-1} = \\begin{pmatrix} \\left(\\frac{2a_1 a_2}{a_1+a_2}\\right)^{-1}  0 \\\\ 0  \\left(\\frac{2c_1 c_2}{c_1+c_2}\\right)^{-1} \\end{pmatrix} = \\begin{pmatrix} \\frac{a_1+a_2}{2a_1 a_2}  0 \\\\ 0  \\frac{c_1+c_2}{2c_1 c_2} \\end{pmatrix}.\n$$\n最后，我们计算有效质量张量 $M_{\\text{eff}}$：\n$$\nM_{\\text{eff}} = \\frac{1}{2} (A^{\\text{hom}})^{-1} = \\frac{1}{2} \\begin{pmatrix} \\frac{a_1+a_2}{2a_1 a_2}  0 \\\\ 0  \\frac{c_1+c_2}{2c_1 c_2} \\end{pmatrix} = \\begin{pmatrix} \\frac{a_1+a_2}{4a_1 a_2}  0 \\\\ 0  \\frac{c_1+c_2}{4c_1 c_2} \\end{pmatrix}.\n$$\n这就是用给定的材料常数表示的有效质量张量的最终表达式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{a_{1}+a_{2}}{4a_{1}a_{2}}  0 \\\\ 0  \\frac{c_{1}+c_{2}}{4c_{1}c_{2}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "为了弥合解析理论与现代计算方法之间的鸿沟，最后一个实践  将指导你实现周期性展开法。你将编写一个程序来处理几何上复杂的情形，例如带有周期性孔洞的区域，这些问题仅用纸笔是难以解决的。这个计算练习让你在数值上验证均匀化理论的核心原理，并理解在真实世界模拟中出现的边界效应等实际挑战，从而获得具体的实践经验。",
            "id": "3794346",
            "problem": "考虑一个有界开域 $\\Omega \\subset \\mathbb{R}^2$，其中 $\\Omega = (0,1)^2$，以及一个周期性参考单元 $Y = (0,1)^2$。令 $H$ 为一个孔洞，模型化为一个半径为 $r \\in (0, \\frac{1}{2})$、圆心在 $c = (\\frac{1}{2}, \\frac{1}{2})$ 的闭圆盘。通过特征函数 $\\chi(y) = \\mathbf{1}_{Y \\setminus H}(y)$ 定义孔洞指示函数，其中 $\\mathbf{1}_S$ 表示集合 $S$ 的特征函数。对于一个周期为 $\\varepsilon  0$ 的周期性穿孔图案，定义穿孔域 $\\Omega_\\varepsilon = \\{ x \\in \\Omega : \\chi(\\{ \\frac{x}{\\varepsilon} \\}) = 1 \\}$，其中 $\\{ \\cdot \\}$ 表示分量级别的小数部分（模1），及其特征函数 $\\chi^\\varepsilon(x) = \\chi\\!\\left(\\left\\{\\frac{x}{\\varepsilon}\\right\\}\\right)\\mathbf{1}_{\\Omega}(x)$。\n\n周期性展开方法（Periodic Unfolding Method, PUM）将定义在振荡域上的函数映射到固定的乘积空间 $\\Omega \\times Y$。对于一个可积函数 $u^\\varepsilon : \\Omega \\to \\mathbb{R}$，展开算子 $\\mathcal{T}_\\varepsilon$ 定义为\n$$\n\\mathcal{T}_\\varepsilon(u^\\varepsilon)(x,y) =\n\\begin{cases}\nu^\\varepsilon\\!\\left(\\varepsilon\\left\\lfloor \\frac{x}{\\varepsilon} \\right\\rfloor + \\varepsilon y\\right),  \\text{若 } \\varepsilon\\left\\lfloor \\frac{x}{\\varepsilon} \\right\\rfloor + \\varepsilon y \\in \\Omega, \\\\\n0,  \\text{其他情况},\n\\end{cases}\n$$\n其中 $\\lfloor \\cdot \\rfloor$ 是将 $\\mathbb{R}^2$ 映射到 $\\mathbb{Z}^2$ 的分量级别下取整函数。对于穿孔域，展开后的特征函数 $\\,\\mathcal{T}_\\varepsilon(\\chi^\\varepsilon)\\,$ 满足\n$$\n\\mathcal{T}_\\varepsilon(\\chi^\\varepsilon)(x,y) = \\chi(y)\\,\\mathbf{1}_{\\Omega_\\varepsilon^Y}(x,y),\n$$\n其中 $\\Omega_\\varepsilon^Y = \\left\\{(x,y)\\in\\Omega\\times Y \\,:\\, \\varepsilon\\left\\lfloor \\frac{x}{\\varepsilon} \\right\\rfloor + \\varepsilon y \\in \\Omega \\right\\}$，确保孔洞由周期性掩模 $\\chi(y)$ 处理，而边界效应则由 $\\mathbf{1}_{\\Omega_\\varepsilon^Y}$ 编码。\n\n目标是实现一个程序，该程序能够：\n- 在 $Y$ 上为半径为 $r$ 的圆盘孔洞 $H$ 构建 $\\chi(y)$。\n- 通过展开算子 $\\mathcal{T}_\\varepsilon$ 实现穿孔域的展开特征函数。\n- 数值验证展开方法对特征函数的质量守恒性质，该性质（在没有边界余项的理想情况下）表述为\n$$\n\\int_{\\Omega_\\varepsilon} \\chi^\\varepsilon(x)\\,\\mathrm{d}x \\approx \\int_{\\Omega\\times Y} \\mathcal{T}_\\varepsilon(\\chi^\\varepsilon)(x,y)\\,\\mathrm{d}y\\,\\mathrm{d}x,\n$$\n并通过计算绝对差值来量化由边界余项集引起的差异\n$$\nE_{\\mathrm{mass}}(\\varepsilon,r) = \\left| \\int_{\\Omega} \\chi^\\varepsilon(x)\\,\\mathrm{d}x - \\int_{\\Omega\\times Y} \\mathcal{T}_\\varepsilon(\\chi^\\varepsilon)(x,y)\\,\\mathrm{d}y\\,\\mathrm{d}x \\right|.\n$$\n- 通过计算绝对差值来量化 $\\chi^\\varepsilon$ 的空间平均值向 $\\chi$ 的 $Y$-平均值的收敛性\n$$\nE_{\\mathrm{frac}}(\\varepsilon,r) = \\left| \\frac{1}{|\\Omega|}\\int_{\\Omega} \\chi^\\varepsilon(x)\\,\\mathrm{d}x - \\frac{1}{|Y|}\\int_{Y} \\chi(y)\\,\\mathrm{d}y \\right|.\n$$\n\n在 $\\Omega$ 中使用大小为 $N_\\Omega \\times N_\\Omega$ 的均匀笛卡尔网格，在 $Y$ 中使用大小为 $N_Y \\times N_Y$ 的均匀笛卡尔网格，其中 $N_\\Omega = 1000$，$N_Y = 1000$。使用中点进行简单的黎曼和来近似积分。通过仅计算完全包含在 $\\Omega$ 内的内部单元的贡献来实现 $\\Omega \\times Y$ 上的展开积分，即单元格原点 $c = \\varepsilon k$ 满足对每个分量 $i$ 都有 $c_i \\in [0,1-\\varepsilon]$ 的那些单元格，这得到\n$$\n\\int_{\\Omega\\times Y} \\mathcal{T}_\\varepsilon(\\chi^\\varepsilon)(x,y)\\,\\mathrm{d}y\\,\\mathrm{d}x\n\\,\\approx\\,\n|\\Omega_{\\mathrm{int}}(\\varepsilon)| \\cdot \\overline{\\chi}_Y,\n$$\n其中 $|\\Omega_{\\mathrm{int}}(\\varepsilon)| = \\left( \\left\\lfloor \\frac{1-\\varepsilon}{\\varepsilon} \\right\\rfloor + 1 \\right)^2 \\varepsilon^2$ 是由内部单元覆盖的面积，$\\overline{\\chi}_Y = \\frac{1}{|Y|}\\int_Y \\chi(y)\\,\\mathrm{d}y$ 是 $Y$ 中固相的体积分数。\n\n对于每个测试用例 $(\\varepsilon,r)$，计算：\n- 质量差异 $E_{\\mathrm{mass}}(\\varepsilon,r)$，作为浮点数。\n- 体积分数差异 $E_{\\mathrm{frac}}(\\varepsilon,r)$，作为浮点数。\n- $\\overline{\\chi}_Y$ 的数值估计，作为浮点数。\n\n您的程序必须实现以上内容并评估以下测试套件：\n- 测试 $1$：$(\\varepsilon,r) = (0.2,0.3)$。\n- 测试 $2$：$(\\varepsilon,r) = (0.1,0.1)$。\n- 测试 $3$：$(\\varepsilon,r) = (0.05,0.45)$。\n- 测试 $4$：$(\\varepsilon,r) = (0.25,0.0)$。\n\n所有量纲均为无量纲。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。此列表的每个元素本身必须是一个包含三个浮点数的逗号分隔列表，分别对应于相应测试用例的 $[E_{\\mathrm{mass}},E_{\\mathrm{frac}},\\overline{\\chi}_Y]$。例如，一个有效的输出字符串形式为 $[ [e_{1},f_{1},v_{1}], [e_{2},f_{2},v_{2}], [e_{3},f_{3},v_{3}], [e_{4},f_{4},v_{4}] ]$，但在打印输出中不含任何空格。",
            "solution": "该问题是有效的。它在周期性均匀化和数值分析的数学领域内提出了一个明确定义的计算任务。所有术语都有清晰的定义，参数已提供，目标是可量化且明确的。该问题在科学上是合理的、自洽的，并且是可形式化的。\n\n目标是数值研究周期性展开方法（PUM）对于二维穿孔域的性质。我们被要求为一组参数 $(\\varepsilon, r)$ 计算两个误差度量 $E_{\\mathrm{mass}}$ 和 $E_{\\mathrm{frac}}$，以及周期性单元中固体材料的体积分数 $\\overline{\\chi}_Y$。\n\n总体方法论涉及在均匀笛卡尔网格上使用黎曼和对多个积分进行数值近似。\n\n**步骤1：域和网格离散化**\n\n宏观域是 $\\Omega = (0,1)^2$，微观参考单元是 $Y = (0,1)^2$。我们将 $\\Omega$ 离散化为 $N_\\Omega \\times N_\\Omega$ 的均匀网格，其中 $N_\\Omega=1000$。每个单元的边长为 $h_\\Omega = 1/N_\\Omega$，面积为 $h_\\Omega^2$。我们使用单元中点进行黎曼和：$x_{ij} = ((i+0.5)h_\\Omega, (j+0.5)h_\\Omega)$，对于 $i,j \\in \\{0, 1, \\dots, N_\\Omega-1\\}$。\n\n类似地，我们将 $Y$ 离散化为 $N_Y \\times N_Y$ 的网格，其中 $N_Y=1000$，单元边长为 $h_Y = 1/N_Y$，面积为 $h_Y^2$。中点为 $y_{kl} = ((k+0.5)h_Y, (l+0.5)h_Y)$，对于 $k,l \\in \\{0, 1, \\dots, N_Y-1\\}$。\n\n**步骤2：$\\overline{\\chi}_Y$ 的数值近似**\n\n孔洞 $H$ 是单元 $Y$ 内的一个闭圆盘，半径为 $r$，圆心在 $c = (\\frac{1}{2}, \\frac{1}{2})$。单元中固体部分的特征函数是 $\\chi(y) = \\mathbf{1}_{Y \\setminus H}(y)$，如果 $y \\notin H$ 则为 $1$，如果 $y \\in H$ 则为 $0$。这个条件转化为：如果 $\\|y - c\\|_2  r$，则 $\\chi(y) = 1$；如果 $\\|y - c\\|_2 \\le r$，则 $\\chi(y) = 0$。\n\n$Y$ 中固体材料的体积分数定义为 $\\overline{\\chi}_Y = \\frac{1}{|Y|}\\int_{Y} \\chi(y)\\,\\mathrm{d}y$。由于 $|Y|=1^2=1$，我们有 $\\overline{\\chi}_Y = \\int_{Y} \\chi(y)\\,\\mathrm{d}y$。我们使用 $Y$-网格上的黎曼和来近似这个积分：\n$$\n\\overline{\\chi}_Y \\approx \\sum_{k=0}^{N_Y-1} \\sum_{l=0}^{N_Y-1} \\chi(y_{kl}) h_Y^2 = \\frac{1}{N_Y^2} \\sum_{k=0}^{N_Y-1} \\sum_{l=0}^{N_Y-1} \\chi(y_{kl})\n$$\n其中，如果 $\\sqrt{( (k+0.5)h_Y - 0.5 )^2 + ( (l+0.5)h_Y - 0.5 )^2}  r$，则 $\\chi(y_{kl}) = 1$，否则为 $0$。这个量是每个测试用例所需的三个输出之一。\n\n**步骤3：$\\int_{\\Omega} \\chi^\\varepsilon(x) \\mathrm{d}x$ 的数值近似**\n\n穿孔域 $\\Omega_\\varepsilon$ 的特征函数由 $\\chi^\\varepsilon(x) = \\chi(\\{x/\\varepsilon\\})$ 给出。项 $\\{x/\\varepsilon\\}$ 将点 $x \\in \\Omega$ 映射到其在参考单元 $Y$ 中的对应位置。对于一个点 $x=(x_1, x_2)$，这等于 $\\{x/\\varepsilon\\} = (x_1/\\varepsilon - \\lfloor x_1/\\varepsilon \\rfloor, x_2/\\varepsilon - \\lfloor x_2/\\varepsilon \\rfloor)$。\n\n$\\chi^\\varepsilon$ 在 $\\Omega$ 上的积分通过 $\\Omega$-网格上的黎曼和来近似：\n$$\nI_\\Omega^\\varepsilon := \\int_{\\Omega} \\chi^\\varepsilon(x) \\mathrm{d}x \\approx \\sum_{i=0}^{N_\\Omega-1} \\sum_{j=0}^{N_\\Omega-1} \\chi^\\varepsilon(x_{ij}) h_\\Omega^2 = \\frac{1}{N_\\Omega^2} \\sum_{i=0}^{N_\\Omega-1} \\sum_{j=0}^{N_\\Omega-1} \\chi(\\{(x_{ij})/\\varepsilon\\})\n$$\n对于每个网格点 $x_{ij}$，我们计算微观坐标 $y'_{ij} = \\{x_{ij}/\\varepsilon\\}$，然后根据其与中心 $c$ 的距离来评估 $\\chi(y'_{ij})$。\n\n**步骤4：计算差异量**\n\n问题要求计算两个差异量，$E_{\\mathrm{mass}}$ 和 $E_{\\mathrm{frac}}$。\n\n体积分数差异定义为：\n$$\nE_{\\mathrm{frac}}(\\varepsilon,r) = \\left| \\frac{1}{|\\Omega|}\\int_{\\Omega} \\chi^\\varepsilon(x)\\,\\mathrm{d}x - \\frac{1}{|Y|}\\int_{Y} \\chi(y)\\,\\mathrm{d}y \\right|\n$$\n由于 $|\\Omega|=1$ 和 $|Y|=1$，这简化为：\n$$\nE_{\\mathrm{frac}}(\\varepsilon,r) = \\left| I_\\Omega^\\varepsilon - \\overline{\\chi}_Y \\right|\n$$\n使用我们对积分的数值近似。\n\n质量差异定义为：\n$$\nE_{\\mathrm{mass}}(\\varepsilon,r) = \\left| \\int_{\\Omega} \\chi^\\varepsilon(x)\\,\\mathrm{d}x - \\int_{\\Omega\\times Y} \\mathcal{T}_\\varepsilon(\\chi^\\varepsilon)(x,y)\\,\\mathrm{d}y\\,\\mathrm{d}x \\right|\n$$\n问题为第二项，即展开函数的积分，指定了一个特定的数值计算方法。它通过仅考虑完全包含在 $\\Omega$ 内的大小为 $\\varepsilon \\times \\varepsilon$ 的内部单元的贡献来近似。这个内部区域的面积由下式给出：\n$$\n|\\Omega_{\\mathrm{int}}(\\varepsilon)| = \\left( \\left\\lfloor \\frac{1-\\varepsilon}{\\varepsilon} \\right\\rfloor + 1 \\right)^2 \\varepsilon^2\n$$\n因此，展开积分的近似被规定为：\n$$\nI_{\\text{unfold}} := \\int_{\\Omega\\times Y} \\mathcal{T}_\\varepsilon(\\chi^\\varepsilon)(x,y)\\,\\mathrm{d}y\\,\\mathrm{d}x \\approx |\\Omega_{\\mathrm{int}}(\\varepsilon)| \\cdot \\overline{\\chi}_Y\n$$\n因此，质量差异计算为：\n$$\nE_{\\mathrm{mass}}(\\varepsilon,r) = \\left| I_\\Omega^\\varepsilon - I_{\\text{unfold}} \\right| = \\left| I_\\Omega^\\varepsilon - |\\Omega_{\\mathrm{int}}(\\varepsilon)| \\cdot \\overline{\\chi}_Y \\right|\n$$\n\n**算法摘要**\n\n对于每个测试用例 $(\\varepsilon, r)$：\n1.  定义网格参数 $N_Y = 1000$ 和 $N_\\Omega = 1000$。\n2.  为单位单元 $Y$ 构建一个二维中点网格。\n3.  在 $Y$-网格上计算孔洞 $H$ 的布尔掩模，并由此得到特征函数数组 $\\chi_{kl}$。\n4.  通过取 $\\chi_{kl}$ 数组的平均值来计算 $\\overline{\\chi}_Y$。这是第三个输出值。\n5.  为域 $\\Omega$ 构建一个二维中点网格。\n6.  对于 $\\Omega$-网格上的每个点 $x_{ij}$，计算微观坐标 $y'_{ij} = \\{x_{ij}/\\varepsilon\\}$ 并评估 $\\chi(y'_{ij})$。这给出了数组 $\\chi^\\varepsilon_{ij}$。\n7.  通过对 $\\chi^\\varepsilon_{ij}$ 求和并乘以面积元 $h_\\Omega^2 = (1/N_\\Omega)^2$ 来计算积分 $I_\\Omega^\\varepsilon$。\n8.  使用给定公式计算内部单元的面积 $|\\Omega_{\\mathrm{int}}(\\varepsilon)|$。\n9.  计算展开积分的近似值 $I_{\\text{unfold}} = |\\Omega_{\\mathrm{int}}(\\varepsilon)| \\cdot \\overline{\\chi}_Y$。\n10. 计算 $E_{\\mathrm{mass}} = |I_\\Omega^\\varepsilon - I_{\\text{unfold}}|$。这是第一个输出值。\n11. 计算 $E_{\\mathrm{frac}} = |I_\\Omega^\\varepsilon - \\overline{\\chi}_Y|$。这是第二个输出值。\n12. 整理当前测试用例的三个浮点数 $[E_{\\mathrm{mass}}, E_{\\mathrm{frac}}, \\overline{\\chi}_Y]$。\n13. 处理完所有测试用例后，将结果格式化为所需的字符串格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.2, 0.3),   # Test 1\n        (0.1, 0.1),   # Test 2\n        (0.05, 0.45), # Test 3\n        (0.25, 0.0),  # Test 4\n    ]\n\n    # Global numerical parameters\n    N_Omega = 1000\n    N_Y = 1000\n\n    results = []\n    for epsilon, r in test_cases:\n        result_triplet = compute_quantities(epsilon, r, N_Omega, N_Y)\n        results.append(result_triplet)\n\n    # Format the final output string exactly as specified.\n    # e.g., [[e1,f1,v1],[e2,f2,v2],...] with no spaces.\n    output_str = f\"[[{'],['.join([','.join(map(str, res)) for res in results])}]]\"\n    print(output_str)\n\ndef compute_quantities(epsilon, r, N_Omega, N_Y):\n    \"\"\"\n    Computes the three required quantities for a given (epsilon, r) pair.\n    \n    Args:\n        epsilon (float): The periodicity parameter.\n        r (float): The radius of the hole in the unit cell.\n        N_Omega (int): Grid size for the Omega domain.\n        N_Y (int): Grid size for the Y cell.\n\n    Returns:\n        list: A list of three floats [E_mass, E_frac, chi_bar_Y].\n    \"\"\"\n    # Step 1: Compute the numerical estimate of the volume fraction chi_bar_Y\n    h_Y = 1.0 / N_Y\n    y_coords = np.linspace(0.5 * h_Y, 1.0 - 0.5 * h_Y, N_Y)\n    yy1, yy2 = np.meshgrid(y_coords, y_coords, indexing='ij')\n\n    # Distance squared from the center of the cell Y\n    dist_sq_Y = (yy1 - 0.5)**2 + (yy2 - 0.5)**2\n    \n    # Characteristic function chi(y). It's 1 if outside the closed disk, 0 otherwise.\n    chi_Y = np.where(dist_sq_Y  r**2, 1.0, 0.0)\n    \n    # The integral of chi over Y (since |Y|=1) is approximated by the mean.\n    chi_bar_Y = np.mean(chi_Y)\n\n    # Step 2: Compute the numerical estimate of the integral of chi_epsilon over Omega\n    h_Omega = 1.0 / N_Omega\n    x_coords = np.linspace(0.5 * h_Omega, 1.0 - 0.5 * h_Omega, N_Omega)\n    xx1, xx2 = np.meshgrid(x_coords, x_coords, indexing='ij')\n\n    # Microscopic coordinates {x/epsilon}\n    y_prime_1 = (xx1 / epsilon) % 1.0\n    y_prime_2 = (xx2 / epsilon) % 1.0\n\n    # Distance squared from the center of the effective cell for each point in Omega\n    dist_sq_Omega = (y_prime_1 - 0.5)**2 + (y_prime_2 - 0.5)**2\n    \n    # Characteristic function chi_epsilon(x) = chi({x/epsilon})\n    chi_epsilon = np.where(dist_sq_Omega  r**2, 1.0, 0.0)\n    \n    # Riemann sum for the integral of chi_epsilon over Omega\n    integral_chi_epsilon = np.sum(chi_epsilon) * (h_Omega**2)\n\n    # Step 3: Compute the discrepancies\n    \n    # Area of interior cells\n    num_interior_cells_1d = np.floor((1.0 - epsilon) / epsilon) + 1.0\n    area_int = (num_interior_cells_1d**2) * (epsilon**2)\n    \n    # Prescribed approximation for the unfolded integral\n    integral_unfolded = area_int * chi_bar_Y\n    \n    # Mass discrepancy E_mass\n    E_mass = np.abs(integral_chi_epsilon - integral_unfolded)\n    \n    # Volume fraction discrepancy E_frac (since |Omega|=1)\n    E_frac = np.abs(integral_chi_epsilon - chi_bar_Y)\n\n    return [E_mass, E_frac, chi_bar_Y]\n\nsolve()\n```"
        }
    ]
}