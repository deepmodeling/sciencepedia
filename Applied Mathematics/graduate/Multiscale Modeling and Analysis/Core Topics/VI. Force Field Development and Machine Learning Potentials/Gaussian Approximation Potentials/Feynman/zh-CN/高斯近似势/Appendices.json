{
    "hands_on_practices": [
        {
            "introduction": "高斯近似势 (GAP) 的核心是局域原子环境的概念，即一个原子的能量由其近邻原子决定。因此，在任何基于局域环境的势函数模型中，第一步都是准确地识别出一个原子的所有邻居。本练习将指导您在周期性边界条件下构建邻居列表，这是为GAP模型构建描述符的基石。",
            "id": "3763478",
            "problem": "给定一个由晶格基矢和一组原子位置定义的三维周期性原子构型。目标是根据第一性原理，为给定的截断半径 $r_c$ 构建周期性边界条件下的近邻列表，并阐明该近邻列表如何成为高斯近似势 (GAP) 中使用的局域原子环境 $\\mathcal{X}_i$ 的基础输入。推导必须从晶体周期性的定义和由晶格基矢导出的度规开始，并逻辑地推导出应如何实现。\n\n使用以下基本依据：\n- 周期性：如果空间中的两个点相差晶格基矢的整数线性组合，则认为它们是等价的。如果晶格基矢由一个 $3 \\times 3$ 矩阵 $\\mathbf{A}$ 表示，其列是基矢向量，那么对于任何 $\\mathbf{n} \\in \\mathbb{Z}^3$，平移 $\\mathbf{x} \\mapsto \\mathbf{x} + \\mathbf{A}\\mathbf{n}$ 保持晶体不变。\n- 在一般三斜晶格中，距离是使用欧几里得范数在笛卡尔空间中测量的。导出的度规张量为 $\\mathbf{G} = \\mathbf{A}^\\top \\mathbf{A}$，因此与分数坐标差 $\\Delta \\mathbf{s}$ 相关的距离平方为 $\\Delta \\mathbf{s}^\\top \\mathbf{G} \\Delta \\mathbf{s}$。\n\n将原子 $i$ 的近邻列表 $\\mathcal{N}(i)$ 定义为所有索引 $j \\ne i$ 的集合，使得在周期性边界条件下原子 $i$ 和原子 $j$ 之间的最短距离小于或等于截断半径 $r_c$。位置以埃（Angstrom）为单位的笛卡尔坐标表示，截断半径 $r_c$ 也以埃为单位。近邻判据必须包含相等情况，即距离为 $r_{ij} = r_c$ 的原子对被视为近邻。\n\n你必须实现一个程序，该程序：\n1. 对每个测试用例，计算每个原子 $i$ 在周期性边界条件下的近邻数 $|\\mathcal{N}(i)|$。\n2. 使用与一般三斜晶胞一致的最小镜像约定。将位置表示为分数坐标 $\\mathbf{s}_i = \\mathbf{A}^{-1}\\mathbf{x}_i$，并使用整数晶格平移来确定笛卡尔坐标中最短的原子间向量，然后使用欧几里得范数和截断半径 $r_c$ 来决定是否包含为近邻。\n3. 在注释或附带的推导中，概述生成的近邻列表如何为高斯近似势 (GAP) 定义局域环境 $\\mathcal{X}_i$，包括哪些数据进入 $\\mathcal{X}_i$ 以及它们如何在典型的二体或更高阶描述符中使用。程序的输出必须仅为下面指定的数值结果。\n\n物理单位：所有距离和截断半径 $r_c$ 都必须以埃（Angstrom）为单位处理。本任务中不需要角度。\n\n测试套件：\n为以下四个测试用例提供结果。\n\n- 测试用例 1（立方，典型情况）：\n  - 晶格矩阵 $\\mathbf{A} = \\mathrm{diag}(5.0, 5.0, 5.0)$ 埃。\n  - 笛卡尔坐标 $\\mathbf{x}_1 = (0.5, 0.5, 0.5)$ 埃, $\\mathbf{x}_2 = (2.0, 2.0, 2.0)$ 埃。\n  - 截断半径 $r_c = 3.0$ 埃。\n\n- 测试用例 2（三斜，边界环绕情况）：\n  - 晶格矩阵\n    $$\n    \\mathbf{A} =\n    \\begin{bmatrix}\n    4.0  0.5  0.0 \\\\\n    0.0  3.5  0.5 \\\\\n    0.2  0.0  4.5\n    \\end{bmatrix}\n    \\text{ 埃。}\n    $$\n  - 分数坐标 $\\mathbf{s}_1 = (0.98, 0.50, 0.50)$，$\\mathbf{s}_2 = (0.02, 0.50, 0.50)$，$\\mathbf{s}_3 = (0.50, 0.50, 0.50)$，其笛卡尔坐标由 $\\mathbf{x}_i = \\mathbf{A}\\mathbf{s}_i$ 定义。\n  - 截断半径 $r_c = 2.5$ 埃。\n\n- 测试用例 3（立方，小截断边界情况）：\n  - 晶格矩阵 $\\mathbf{A} = \\mathrm{diag}(5.0, 5.0, 5.0)$ 埃。\n  - 笛卡尔坐标 $\\mathbf{x}_1 = (0.5, 0.5, 0.5)$ 埃, $\\mathbf{x}_2 = (2.0, 2.0, 2.0)$ 埃。\n  - 截断半径 $r_c = 1.0$ 埃。\n\n- 测试用例 4（立方，精确边界包含情况）：\n  - 晶格矩阵 $\\mathbf{A} = \\mathrm{diag}(10.0, 10.0, 10.0)$ 埃。\n  - 笛卡尔坐标 $\\mathbf{x}_1 = (0.0, 0.0, 0.0)$ 埃, $\\mathbf{x}_2 = (5.0, 0.0, 0.0)$ 埃。\n  - 截断半径 $r_c = 5.0$ 埃。\n\n要求的最终输出格式：\n你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。列表中的每个元素对应一个测试用例，并且本身是该用例中每个原子的近邻数列表。例如，对于四个各有两原子的测试用例，输出格式必须为 $[[n_{1,1},n_{1,2}], [n_{2,1},n_{2,2}], [n_{3,1},n_{3,2}], [n_{4,1},n_{4,2}]]$。对于上述测试套件，每个用例的原子数分别为 $2$、$3$、$2$ 和 $2$。输出必须只包含整数。",
            "solution": "该问题要求为给定的原子构型和截断半径构建周期性近邻列表，并解释其作为高斯近似势 (GAP) 基础输入的作用。解决方案首先建立周期性系统中距离计算的理论框架，然后将该框架应用于所提供的测试用例。\n\n### 理论框架\n\n**1. 周期性与坐标系**\n理想晶体结构由重复的晶胞表征。晶胞的几何形状由一组三个线性无关的晶格基矢 $\\mathbf{a}_1, \\mathbf{a}_2, \\mathbf{a}_3$ 定义。这些向量可以作为列组装成一个 $3 \\times 3$ 的晶格矩阵 $\\mathbf{A} = [\\mathbf{a}_1, \\mathbf{a}_2, \\mathbf{a}_3]$。\n\n晶体中的任何点都可以用笛卡尔坐标 $\\mathbf{x} \\in \\mathbb{R}^3$ 描述。或者，我们可以使用分数（或晶体）坐标 $\\mathbf{s} \\in \\mathbb{R}^3$，它将位置表示为基矢的线性组合。两种坐标系之间的关系由下式给出：\n$$ \\mathbf{x} = \\mathbf{A}\\mathbf{s} \\quad \\Leftrightarrow \\quad \\mathbf{s} = \\mathbf{A}^{-1}\\mathbf{x} $$\n周期性的定义属性是晶体在晶格向量的任何整数线性组合的平移下保持不变。也就是说，对于任何位置向量 $\\mathbf{x}$ 和任何整数向量 $\\mathbf{n} = (n_1, n_2, n_3)^\\top \\in \\mathbb{Z}^3$，点 $\\mathbf{x}' = \\mathbf{x} + \\mathbf{A}\\mathbf{n}$ 在物理上等同于 $\\mathbf{x}$。在分数坐标中，这对应于一个简单的整数向量平移：$\\mathbf{s}' = \\mathbf{s} + \\mathbf{n}$。\n\n**2. 最小镜像约定**\n要确定位于 $\\mathbf{x}_i$ 和 $\\mathbf{x}_j$ 位置的两个原子 $i$ 和 $j$ 是否为近邻，我们必须找到原子 $i$ 与原子 $j$ 的任何周期性镜像之间的最短可能距离。原子 $j$ 的周期性镜像位于 $\\mathbf{x}_j'(\\mathbf{n}) = \\mathbf{x}_j + \\mathbf{A}\\mathbf{n}$，其中 $\\mathbf{n} \\in \\mathbb{Z}^3$。我们需要找到使距离 $||\\mathbf{x}_j'(\\mathbf{n}) - \\mathbf{x}_i||$ 最小化的整数向量 $\\mathbf{n}^*$。\n\n这个最小化问题在分数坐标中解决最为方便。连接原子 $i$ 和原子 $j$ 的一个镜像的向量是 $\\mathbf{r}_{ij}(\\mathbf{n}) = \\mathbf{x}_j'(\\mathbf{n}) - \\mathbf{x}_i = \\mathbf{A}(\\mathbf{s}_j + \\mathbf{n} - \\mathbf{s}_i)$。令 $\\Delta\\mathbf{s} = \\mathbf{s}_j - \\mathbf{s}_i$。则 $\\mathbf{r}_{ij}(\\mathbf{n}) = \\mathbf{A}(\\Delta\\mathbf{s} + \\mathbf{n})$。我们需要找到使该向量长度最小化的 $\\mathbf{n}^*$。\n\n**最小镜像约定**提供了一种直接的方法来找到与最短距离相对应的位移向量的表示。我们寻找一个整数向量 $\\mathbf{n}$，使得平移后的分数位移 $\\Delta\\mathbf{s}' = \\Delta\\mathbf{s} + \\mathbf{n}$ 的分量位于一个特定的域内，通常以原点为中心。通过选择该域为 $[-0.5, 0.5]^3$，我们确保我们正在考虑最近的周期性镜像。这可以通过设置 $\\mathbf{n} = -\\mathrm{round}(\\Delta\\mathbf{s})$ 来实现，其中舍入操作逐分量应用于向量 $\\Delta\\mathbf{s}$。因此，最小分数位移向量为：\n$$ \\Delta\\mathbf{s}_\\text{min} = \\Delta\\mathbf{s} - \\mathrm{round}(\\Delta\\mathbf{s}) $$\n$\\Delta\\mathbf{s}_\\text{min}$ 的每个分量都保证在区间 $[-0.5, 0.5]$ 内。然后通过应用晶格矩阵找到笛卡尔坐标中的最短位移向量：\n$$ \\mathbf{r}_{ij, \\text{min}} = \\mathbf{A} \\Delta\\mathbf{s}_\\text{min} $$\n最后，最短距离的平方是该向量的欧几里得范数的平方：\n$$ d_{ij}^2 = ||\\mathbf{r}_{ij, \\text{min}}||^2 = \\mathbf{r}_{ij, \\text{min}} \\cdot \\mathbf{r}_{ij, \\text{min}} $$\n\n**3. 近邻列表构建**\n原子 $i$ 的近邻列表，记为 $\\mathcal{N}(i)$，是所有其他原子 $j$ ($j \\neq i$) 的索引集合，其中最短距离 $d_{ij}$ 小于或等于指定的截断半径 $r_c$。\n$$ \\mathcal{N}(i) = \\{ j \\mid j \\neq i \\land d_{ij} \\le r_c \\} $$\n原子 $i$ 的近邻数是该集合的基数 $|\\mathcal{N}(i)|$。\n\n计算近邻数的算法如下：\n1.  对于给定的原子构型（晶格矩阵 $\\mathbf{A}$ 和原子位置），如果尚未提供，则将所有笛卡尔坐标 $\\mathbf{x}_k$ 转换为分数坐标 $\\mathbf{s}_k = \\mathbf{A}^{-1}\\mathbf{x}_k$。\n2.  对于系统中的每个原子 $i$：\n    a. 初始化一个近邻计数器 $C_i = 0$。\n    b. 对于系统中的每个其他原子 $j$ ($j \\neq i$)：\n        i.   计算分数位移向量：$\\Delta\\mathbf{s} = \\mathbf{s}_j - \\mathbf{s}_i$。\n        ii.  应用最小镜像约定：$\\Delta\\mathbf{s}_\\text{min} = \\Delta\\mathbf{s} - \\mathrm{round}(\\Delta\\mathbf{s})$。\n        iii. 转换为最短笛卡尔位移向量：$\\mathbf{r}_{ij, \\text{min}} = \\mathbf{A} \\Delta\\mathbf{s}_\\text{min}$。\n        iv.  计算距离的平方：$d_{ij}^2 = \\mathbf{r}_{ij, \\text{min}} \\cdot \\mathbf{r}_{ij, \\text{min}}$。\n        v.   检查近邻判据：如果 $d_{ij}^2 \\le r_c^2$，则增加计数器 $C_i$。\n3.  该构型的最终结果是所有近邻数的列表 $[C_0, C_1, \\dots, C_{N-1}]$。\n\n**4. 与高斯近似势 (GAP) 的联系**\n高斯近似势，与许多其他机器学习的原子间势一样，都建立在局域性原理之上。该原理指出，一个原子 $i$ 的势能 $E_i$ 由其周围原子的排列决定。系统的总能量则近似为这些原子贡献的总和：\n$$ E_\\text{total} \\approx \\sum_{i=1}^{N} E_i(\\mathcal{X}_i) $$\n项 $\\mathcal{X}_i$ 表示原子 $i$ 的**局域原子环境**。近邻列表是用于定义此环境的主要组成部分。形式上，局域环境 $\\mathcal{X}_i$ 是从原子 $i$ 指向其所有近邻 $j \\in \\mathcal{N}(i)$ 的最短位移向量的集合，通常还会附加上每个原子的化学种类。\n$$ \\mathcal{X}_i = \\{ (\\mathbf{r}_{ij, \\text{min}}, Z_j) \\mid j \\in \\mathcal{N}(i) \\} $$\n其中 $Z_j$ 是原子 $j$ 的原子序数（或元素类型）。\n\n$\\mathcal{X}_i$ 中的原始向量数据不能直接用于机器学习模型，因为它对于旋转或相同近邻的排列不具有不变性。因此，$\\mathcal{X}_i$ 被转换为一个固定大小、对称性不变的特征向量，称为**描述符**。\n-   **二体描述符**，在早期 GAP 模型中使用的，依赖于距离 $d_{ij} = ||\\mathbf{r}_{ij, \\text{min}}||$。例如，描述符可以是这些距离的直方图，或者是对这些距离求值的函数之和。\n-   **多体描述符**，如原子位置光滑重叠 (SOAP)，提供了对三维几何更完整的描述。SOAP 通过在每个近邻向量 $\\mathbf{r}_{ij, \\text{min}}$ 的位置放置高斯函数来构建局域原子密度场。然后将该场在径向函数和球谐函数基上展开。将得到的展开系数组合起来，形成一个旋转和排列不变的描述符向量。\n\n在所有情况下，准确高效地构建近邻列表 $\\mathcal{N}(i)$ 及相应的位移向量集 $\\{\\mathbf{r}_{ij, \\text{min}}\\}$ 是不可或缺的第一步。它定义了每个原子的“视场”，此步骤中的任何错误或不一致都会直接影响势能模型的保真度。因此，上述算法是现代计算材料建模的基石。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the neighbor list problem for a series of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"A\": np.diag([5.0, 5.0, 5.0]),\n            \"pos\": np.array([[0.5, 0.5, 0.5], [2.0, 2.0, 2.0]]),\n            \"r_c\": 3.0,\n            \"pos_type\": \"cartesian\"\n        },\n        {\n            \"A\": np.array([\n                [4.0, 0.5, 0.0],\n                [0.0, 3.5, 0.5],\n                [0.2, 0.0, 4.5]\n            ]),\n            \"pos\": np.array([\n                [0.98, 0.50, 0.50],\n                [0.02, 0.50, 0.50],\n                [0.50, 0.50, 0.50]\n            ]),\n            \"r_c\": 2.5,\n            \"pos_type\": \"fractional\"\n        },\n        {\n            \"A\": np.diag([5.0, 5.0, 5.0]),\n            \"pos\": np.array([[0.5, 0.5, 0.5], [2.0, 2.0, 2.0]]),\n            \"r_c\": 1.0,\n            \"pos_type\": \"cartesian\"\n        },\n        {\n            \"A\": np.diag([10.0, 10.0, 10.0]),\n            \"pos\": np.array([[0.0, 0.0, 0.0], [5.0, 0.0, 0.0]]),\n            \"r_c\": 5.0,\n            \"pos_type\": \"cartesian\"\n        },\n    ]\n\n    results = []\n\n    # The derivation of local atomic environments for GAP is as follows:\n    # 1. For each atom 'i', its neighbor list N(i) is constructed by finding all\n    #    atoms 'j' whose shortest periodic distance d_ij is within a cutoff r_c.\n    #    This is the core calculation performed in this function.\n    # 2. The local atomic environment, X_i, is the set of shortest displacement\n    #    vectors from atom 'i' to its neighbors: X_i = {r_ij | j in N(i)}.\n    # 3. These vectors {r_ij} are inputs to descriptor functions.\n    #    - For two-body terms, only the distances ||r_ij|| are used.\n    #    - For many-body terms (like SOAP), the full 3D vectors {r_ij} are\n    #      used to construct a local atomic density, which is then expanded\n    #      in a basis of spherical harmonics and radial functions to produce\n    #      a rotationally-invariant descriptor vector.\n    # The neighbor list is therefore the fundamental input that defines the\n    # local chemical information processed by the GAP model.\n\n    for case in test_cases:\n        A = case[\"A\"]\n        pos = case[\"pos\"]\n        r_c = case[\"r_c\"]\n        pos_type = case[\"pos_type\"]\n        \n        num_atoms = pos.shape[0]\n        r_c_sq = r_c**2\n\n        # Step 1: Convert Cartesian to fractional coordinates if necessary.\n        if pos_type == \"cartesian\":\n            A_inv = np.linalg.inv(A)\n            # To transform a set of row vectors (N, 3), we compute (X @ A_inv.T)\n            frac_pos = pos @ A_inv.T\n        else: # pos_type == \"fractional\"\n            frac_pos = pos\n\n        neighbor_counts = []\n        for i in range(num_atoms):\n            count = 0\n            for j in range(num_atoms):\n                if i == j:\n                    continue\n\n                # Step 2: Calculate fractional displacement and apply minimum image convention.\n                # delta_s = s_j - s_i\n                delta_s = frac_pos[j] - frac_pos[i]\n                \n                # delta_s_min = delta_s - round(delta_s)\n                # This maps each component to the interval [-0.5, 0.5].\n                delta_s_min = delta_s - np.round(delta_s)\n\n                # Step 3: Convert minimal fractional vector back to Cartesian.\n                # r_ij_min = A * delta_s_min\n                r_ij_min = A @ delta_s_min\n                \n                # Step 4: Calculate squared distance and check against cutoff.\n                d_sq = np.dot(r_ij_min, r_ij_min)\n\n                # The problem requires inclusion on the boundary (r_ij = r_c), so we use =.\n                # A small tolerance is generally wise for float comparisons, but the test\n                # cases are constructed to be exact, so a direct comparison is sufficient.\n                if d_sq = r_c_sq:\n                    count += 1\n            \n            neighbor_counts.append(count)\n        \n        results.append(neighbor_counts)\n\n    # Final print statement in the exact required format.\n    # Using a custom string formatter to avoid spaces after commas in lists.\n    formatted_results = [f\"[{','.join(map(str, r))}]\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在识别出邻居原子之后，我们需要将其几何构型表示为一种对旋转和相同原子排列具有不变性的数学形式。平滑原子位置重叠 (SOAP) 描述符是实现这一目标的强大工具。本练习将引导您从第一性原理出发，为一个简单的系统计算SOAP功率谱分量，从而揭示其核心的数学机制。",
            "id": "3763502",
            "problem": "在高斯近似势 (GAP) 中，通过将中心原子周围的邻近原子密度在径向函数和球谐函数的正交归一基上展开，并形成旋转不变的功率谱分量，来构建原子位置平滑重叠 (SOAP) 描述符。考虑一个位于原点的中心原子和两个分别位于 $\\mathbf{r}_{1} = (0,0,1\\,\\mathrm{\\AA})$ 和 $\\mathbf{r}_{2} = (2\\,\\mathrm{\\AA},0,0)$ 的邻近原子。邻近原子密度被建模为以每个邻近原子为中心、宽度为 $\\sigma$ 的归一化三维高斯函数的和，\n$$\n\\rho(\\mathbf{r}) = \\sum_{i=1}^{2} \\left(2\\pi \\sigma^{2}\\right)^{-3/2} \\exp\\!\\left(-\\frac{|\\mathbf{r}-\\mathbf{r}_{i}|^{2}}{2\\sigma^{2}}\\right).\n$$\n展开基由单个径向基函数 $R_{1}(r)$ 和零阶 ($l=0$) 球谐函数组成。具体来说，取高斯展宽宽度为 $\\sigma = 0.5\\,\\mathrm{\\AA}$，并选择径向基 $R_{1}(r)$ 为归一化的 高斯函数\n$$\nR_{1}(r) = \\mathcal{N} \\exp\\!\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right),\n$$\n其归一化常数 $\\mathcal{N}$ 由正交归一化条件 $\\int_{0}^{\\infty} r^{2} \\, R_{1}(r)^{2} \\, dr = 1$ 确定。仅使用 $l=0$ 的球谐函数 $Y_{00}(\\hat{\\mathbf{r}}) = \\left(4\\pi\\right)^{-1/2}$，即设 $l_{\\max}=0$ 和 $n_{\\max}=1$。\n\n从标准的 SOAP 定义出发，\n- 展开系数 $c_{nlm} = \\int d^{3}\\mathbf{r}\\, R_{n}(r)\\, Y_{lm}^{*}(\\hat{\\mathbf{r}})\\, \\rho(\\mathbf{r})$，\n- 功率谱分量 $p_{nn'l} = \\sum_{m=-l}^{l} c_{nlm}\\, c_{n'lm}^{*}$，\n\n推导在此环境下唯一的非零 SOAP 功率谱分量 $p_{11,0}$ 的精确闭合形式表达式。将最终结果表示为一个包含指数和 $\\pi$ 的简化解析表达式。除已说明的内容外，不要引入任何额外的截断或窗函数。最终数值以 $\\mathrm{\\AA}^{-3}$ 为单位表示。无需四舍五入；提供精确表达式。",
            "solution": "用户提供了一个问题，要求在原子位置平滑重叠 (SOAP) 框架内计算一个特定的功率谱分量 $p_{11,0}$，该框架是高斯近似势 (GAP) 方法论的一部分。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n- **中心原子：**位于原点 $\\mathbf{r}_{0} = (0,0,0)$。\n- **邻近原子：**两个原子，位置分别为 $\\mathbf{r}_{1} = (0,0,1\\,\\mathrm{\\AA})$ 和 $\\mathbf{r}_{2} = (2\\,\\mathrm{\\AA},0,0)$。\n- **邻近原子密度：**$\\rho(\\mathbf{r}) = \\sum_{i=1}^{2} \\left(2\\pi \\sigma^{2}\\right)^{-3/2} \\exp\\!\\left(-\\frac{|\\mathbf{r}-\\mathbf{r}_{i}|^{2}}{2\\sigma^{2}}\\right)$。\n- **高斯展宽宽度：**$\\sigma = 0.5\\,\\mathrm{\\AA}$。\n- **展开基：**\n  - 径向部分 ($n_{\\max}=1$)：$R_{1}(r) = \\mathcal{N} \\exp\\!\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right)$，归一化条件为 $\\int_{0}^{\\infty} r^{2} \\, R_{1}(r)^{2} \\, dr = 1$。\n  - 角向部分 ($l_{\\max}=0$)：$Y_{00}(\\hat{\\mathbf{r}}) = \\left(4\\pi\\right)^{-1/2}$。\n- **SOAP 定义：**\n  - 展开系数：$c_{nlm} = \\int d^{3}\\mathbf{r}\\, R_{n}(r)\\, Y_{lm}^{*}(\\hat{\\mathbf{r}})\\, \\rho(\\mathbf{r})$。\n  - 功率谱：$p_{nn'l} = \\sum_{m=-l}^{l} c_{nlm}\\, c_{n'lm}^{*}$。\n- **目标：**推导 $p_{11,0}$ 的精确闭合形式表达式。\n\n**1.2. 使用提取的已知条件进行验证**\n这个问题有充分的科学依据，完全处于计算材料科学的既定理论框架之内。所使用的术语、定义和物理参数都是标准的且自洽的。这是一个适定问题，为求得唯一解提供了所有必要信息。问题中没有矛盾、歧义或不科学的前提。\n\n**1.3. 结论与行动**\n问题有效。将提供一个完整的、有理有据的解答。\n\n### 步骤 2：求解推导\n\n目标是计算功率谱分量 $p_{11,0}$。根据所给定义，当 $n=1, n'=1, l=0$ 时，我们有：\n$$\np_{11,0} = \\sum_{m=-0}^{0} c_{10m}\\, c_{10m}^{*} = c_{100}\\,c_{100}^{*} = |c_{100}|^{2}\n$$\n因此，计算过程主要分为三个步骤：\n1. 确定径向基函数 $R_{1}(r)$ 的归一化常数 $\\mathcal{N}$。\n2. 计算展开系数 $c_{100}$。\n3. 根据 $c_{100}$ 计算 $p_{11,0}$ 并代入给定的物理数值。\n\n**2.1. 径向基函数的归一化**\n$R_{1}(r)$ 的归一化条件是 $\\int_{0}^{\\infty} r^{2} R_{1}(r)^{2} dr = 1$。代入 $R_{1}(r)$ 的函数形式：\n$$\n\\int_{0}^{\\infty} r^{2} \\left(\\mathcal{N} \\exp\\!\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right)\\right)^{2} dr = \\mathcal{N}^{2} \\int_{0}^{\\infty} r^{2} \\exp\\!\\left(-\\frac{r^{2}}{\\sigma^{2}}\\right) dr = 1\n$$\n这是一个标准的高斯积分，形式为 $\\int_0^\\infty x^{2n} e^{-ax^2} dx = \\frac{(2n-1)!!}{2^{n+1}}\\sqrt{\\frac{\\pi}{a^{2n+1}}}$。在本例中，$n=1$ 且 $a=1/\\sigma^2$。\n$$\n\\int_{0}^{\\infty} r^{2} \\exp\\!\\left(-\\frac{r^{2}}{\\sigma^{2}}\\right) dr = \\frac{1!!}{2^{2}} \\sqrt{\\frac{\\pi}{(1/\\sigma^2)^3}} = \\frac{1}{4}\\sqrt{\\pi\\sigma^6} = \\frac{\\sigma^3\\sqrt{\\pi}}{4}\n$$\n归一化条件变为：\n$$\n\\mathcal{N}^{2} \\frac{\\sigma^3\\sqrt{\\pi}}{4} = 1 \\implies \\mathcal{N}^{2} = \\frac{4}{\\sigma^3\\sqrt{\\pi}} \\implies \\mathcal{N} = \\frac{2}{\\sigma^{3/2}\\pi^{1/4}}\n$$\n由于 $\\mathcal{N}$ 通常取正值，我们取正根。\n\n**2.2. 计算展开系数 $c_{100}$**\n系数 $c_{100}$ 定义为：\n$$\nc_{100} = \\int d^{3}\\mathbf{r}\\, R_{1}(r)\\, Y_{00}^{*}(\\hat{\\mathbf{r}})\\, \\rho(\\mathbf{r})\n$$\n由于 $Y_{00}(\\hat{\\mathbf{r}}) = (4\\pi)^{-1/2}$ 是一个实常数，所以 $Y_{00}^{*} = Y_{00}$。代入 $\\rho(\\mathbf{r})$、$R_{1}(r)$ 和 $Y_{00}(\\hat{\\mathbf{r}})$ 的表达式：\n$$\nc_{100} = \\int d^{3}\\mathbf{r}\\, \\left(\\mathcal{N} \\exp\\!\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right)\\right) \\left(\\frac{1}{\\sqrt{4\\pi}}\\right) \\left(\\sum_{i=1}^{2} \\left(2\\pi \\sigma^{2}\\right)^{-3/2} \\exp\\!\\left(-\\frac{|\\mathbf{r}-\\mathbf{r}_{i}|^{2}}{2\\sigma^{2}}\\right)\\right)\n$$\n根据积分的线性性质，我们可以交换求和与积分的次序：\n$$\nc_{100} = \\sum_{i=1}^{2} \\frac{\\mathcal{N}}{\\sqrt{4\\pi}(2\\pi\\sigma^2)^{3/2}} \\int d^3\\mathbf{r} \\exp\\!\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right) \\exp\\!\\left(-\\frac{|\\mathbf{r}-\\mathbf{r}_{i}|^{2}}{2\\sigma^{2}}\\right)\n$$\n该积分表示两个高斯函数的重叠，一个以原点为中心，另一个以 $\\mathbf{r}_i$ 为中心。两个高斯函数的乘积是另一个高斯函数。我们来合并指数部分：\n$$\n-\\frac{r^{2}}{2\\sigma^{2}} - \\frac{|\\mathbf{r}-\\mathbf{r}_{i}|^{2}}{2\\sigma^{2}} = -\\frac{1}{2\\sigma^{2}} \\left(r^{2} + r^{2} - 2\\mathbf{r}\\cdot\\mathbf{r}_{i} + r_{i}^{2}\\right) = -\\frac{1}{\\sigma^{2}}\\left(r^{2} - \\mathbf{r}\\cdot\\mathbf{r}_{i} + \\frac{r_{i}^{2}}{2}\\right)\n$$\n对含 $\\mathbf{r}$ 的项进行配方：\n$$\n-\\frac{1}{\\sigma^{2}}\\left(\\left|\\mathbf{r} - \\frac{\\mathbf{r}_{i}}{2}\\right|^{2} - \\frac{r_{i}^{2}}{4} + \\frac{r_{i}^{2}}{2}\\right) = -\\frac{1}{\\sigma^{2}}\\left|\\mathbf{r} - \\frac{\\mathbf{r}_{i}}{2}\\right|^{2} - \\frac{r_{i}^{2}}{4\\sigma^{2}}\n$$\n积分变为：\n$$\n\\int d^3\\mathbf{r} \\exp\\!\\left(-\\frac{r_{i}^{2}}{4\\sigma^{2}}\\right) \\exp\\!\\left(-\\frac{|\\mathbf{r} - \\mathbf{r}_{i}/2|^{2}}{\\sigma^{2}}\\right) = \\exp\\!\\left(-\\frac{r_{i}^{2}}{4\\sigma^{2}}\\right) \\int d^3\\mathbf{r}' \\exp\\!\\left(-\\frac{|\\mathbf{r}'|^{2}}{\\sigma^{2}}\\right)\n$$\n剩余的积分是一个标准的三维高斯积分，$\\int \\exp(-ax^2)dx = \\sqrt{\\pi/a}$，所以 $\\int \\exp(-ar^2)d^3\\mathbf{r} = (\\pi/a)^{3/2}$。当 $a=1/\\sigma^2$ 时，该积分的值为 $(\\pi\\sigma^2)^{3/2}$。\n来自原子 $i$ 对 $c_{100}$ 的贡献为：\n$$\nc_{100}^{(i)} = \\frac{\\mathcal{N}}{\\sqrt{4\\pi}(2\\pi\\sigma^2)^{3/2}} \\left(\\exp\\!\\left(-\\frac{r_{i}^{2}}{4\\sigma^{2}}\\right) (\\pi\\sigma^2)^{3/2}\\right)\n= \\frac{\\mathcal{N}}{2\\pi^{1/2} \\cdot 2^{3/2}\\pi^{3/2}\\sigma^3} \\exp\\!\\left(-\\frac{r_{i}^{2}}{4\\sigma^{2}}\\right) \\pi^{3/2}\\sigma^3\n$$\n$$\nc_{100}^{(i)} = \\frac{\\mathcal{N}}{4\\sqrt{2}\\pi^{1/2}} \\exp\\!\\left(-\\frac{r_{i}^{2}}{4\\sigma^{2}}\\right)\n$$\n现在，对两个原子求和并代入 $\\mathcal{N}$ 的表达式：\n$$\nc_{100} = \\sum_{i=1}^{2} c_{100}^{(i)} = \\frac{\\mathcal{N}}{4\\sqrt{2}\\pi^{1/2}} \\left(\\exp\\!\\left(-\\frac{r_{1}^{2}}{4\\sigma^{2}}\\right) + \\exp\\!\\left(-\\frac{r_{2}^{2}}{4\\sigma^{2}}\\right)\\right)\n$$\n$$\nc_{100} = \\frac{1}{4\\sqrt{2}\\pi^{1/2}} \\left(\\frac{2}{\\sigma^{3/2}\\pi^{1/4}}\\right) \\left(\\exp\\!\\left(-\\fracr_{1}^{2}}{4\\sigma^{2}}\\right) + \\exp\\!\\left(-\\frac{r_{2}^{2}}{4\\sigma^{2}}\\right)\\right)\n$$\n$$\nc_{100} = \\frac{1}{2\\sqrt{2}\\sigma^{3/2}\\pi^{3/4}} \\left(\\exp\\!\\left(-\\frac{r_{1}^{2}}{4\\sigma^{2}}\\right) + \\exp\\!\\left(-\\frac{r_{2}^{2}}{4\\sigma^{2}}\\right)\\right)\n$$\n\n**2.3. 计算功率谱 $p_{11,0}$**\n系数 $c_{100}$ 是实数，因此 $p_{11,0} = |c_{100}|^2 = c_{100}^2$：\n$$\np_{11,0} = \\left(\\frac{1}{2\\sqrt{2}\\sigma^{3/2}\\pi^{3/4}}\\right)^{2} \\left(\\exp\\!\\left(-\\frac{r_{1}^{2}}{4\\sigma^{2}}\\right) + \\exp\\!\\left(-\\frac{r_{2}^{2}}{4\\sigma^{2}}\\right)\\right)^{2}\n$$\n$$\np_{11,0} = \\frac{1}{8\\sigma^3\\pi^{3/2}} \\left(\\exp\\!\\left(-\\frac{r_{1}^{2}}{4\\sigma^{2}}\\right) + \\exp\\!\\left(-\\frac{r_{2}^{2}}{4\\sigma^{2}}\\right)\\right)^{2}\n$$\n现在，我们代入给定值：$\\sigma = 0.5\\,\\mathrm{\\AA}$，$\\mathbf{r}_1 = (0,0,1\\,\\mathrm{\\AA})$，$\\mathbf{r}_2 = (2\\,\\mathrm{\\AA},0,0)$。\n这得到 $r_1=|\\mathbf{r}_1| = 1\\,\\mathrm{\\AA}$ 和 $r_2=|\\mathbf{r}_2| = 2\\,\\mathrm{\\AA}$。\n指数的值为：\n$$\n\\frac{r_1^2}{4\\sigma^2} = \\frac{1^2}{4(0.5)^2} = \\frac{1}{4(0.25)} = 1\n$$\n$$\n\\frac{r_2^2}{4\\sigma^2} = \\frac{2^2}{4(0.5)^2} = \\frac{4}{4(0.25)} = 4\n$$\n$\\sigma^3$ 的值为 $(0.5)^3 = 1/8$。将这些值代入 $p_{11,0}$ 的表达式中：\n$$\np_{11,0} = \\frac{1}{8(1/8)\\pi^{3/2}} \\left(\\exp(-1) + \\exp(-4)\\right)^{2} = \\frac{1}{\\pi^{3/2}} \\left(\\exp(-1) + \\exp(-4)\\right)^{2}\n$$\n为了提供一个简化的解析表达式，我们可以展开平方项：\n$$\np_{11,0} = \\frac{1}{\\pi^{3/2}} \\left((\\exp(-1))^2 + 2\\exp(-1)\\exp(-4) + (\\exp(-4))^2\\right)\n$$\n$$\np_{11,0} = \\frac{\\exp(-2) + 2\\exp(-5) + \\exp(-8)}{\\pi^{3/2}}\n$$\n这就是功率谱分量 $p_{11,0}$ 的最终精确表达式，单位为 $\\mathrm{\\AA}^{-3}$。",
            "answer": "$$\n\\boxed{\\frac{\\exp(-2) + 2\\exp(-5) + \\exp(-8)}{\\pi^{3/2}}}\n$$"
        },
        {
            "introduction": "像GAP这样的解析势函数的一个关键优势是通过自动微分计算原子间作用力的能力。本练习探讨了如何从多体的GAP能量表达式中推导出作用力。通过一个简单的对称构型，本练习展示了对称性如何体现在力中，以及GAP模型如何遵守平移不变性等基本物理原理。",
            "id": "3763464",
            "problem": "考虑一个一维三原子玩具系统，其位置分别为 $\\mathbf{R}_{1}=(-a,0,0)$, $\\mathbf{R}_{2}=(0,0,0)$ 和 $\\mathbf{R}_{3}=(a,0,0)$，其中 $a>0$ 是一个固定的间距。在高斯近似势 (GAP) 中，总能量写为各局域原子贡献之和 $E=\\sum_{i=1}^{3}E_{i}$，而力则由总能量相对于原子位置的负梯度得出。设每个原子的能量由单个稀疏点高斯过程回归模型化为 $E_{i}=w\\,k(q_{i},q_{*})$，其中 $w>0$ 是回归权重，$q_{*}$ 是来自代表性稀疏集的固定描述符值，$k$ 是一个标量核函数。使用平方指数核函数\n$$\nk(q,q')=\\sigma^{2}\\,\\exp\\!\\left(-\\frac{(q-q')^{2}}{2\\ell^{2}}\\right),\n$$\n其核振幅为 $\\sigma>0$，长度标度为 $\\ell>0$。对于局域原子描述符，使用一个简单的各向同性径向和\n$$\nq_{i}=\\sum_{j\\neq i}\\exp\\!\\left(-\\beta\\,r_{ij}^{2}\\right),\n$$\n其中 $\\beta>0$ 且 $r_{ij}=|\\mathbf{R}_{i}-\\mathbf{R}_{j}|$ 是原子间距离。假设所有常数 $(w,\\sigma,\\ell,\\beta,q_{*})$ 都是有限、正值且与位置无关。\n\n仅从上述定义以及作用在原子 $i$ 上的力为 $\\mathbf{F}_{i}=-\\nabla_{\\mathbf{R}_{i}}E$ 这一事实出发，推导在所述对称构型下，作用在中心原子 2 上的力的 $x$ 分量的精确表达式，并将其完全简化。然后，基于相同的定义和构型的对称性，验证该学习势满足牛顿第三定律，即 $\\mathbf{F}_{1}+\\mathbf{F}_{3}=\\mathbf{0}$。\n\n您的最终答案必须是 $F_{2,x}$ 的完全简化表达式，形式为单个实数或闭式解析表达式。将 $F_{2,x}$ 的最终结果以电子伏特每埃（eV/\\AA）为单位表示。无需四舍五入。",
            "solution": "该问题要求推导在一个对称一维三原子系统中，作用在中心原子（原子 2）上的力的 x 分量，该系统采用高斯近似势 (GAP) 建模。问题还要求验证外部原子之间的力抵消性质。\n\n### 问题验证\n首先，对问题陈述进行验证。\n\n**第 1 步：提取已知条件**\n-   系统：一维构型中的三个原子。\n-   位置：$\\mathbf{R}_{1}=(-a,0,0)$, $\\mathbf{R}_{2}=(0,0,0)$, $\\mathbf{R}_{3}=(a,0,0)$，其中 $a>0$。\n-   总能量：$E=\\sum_{i=1}^{3}E_{i}$。\n-   原子能量：$E_{i}=w\\,k(q_{i},q_{*})$，回归权重 $w>0$。\n-   核函数：平方指数核 $k(q,q')=\\sigma^{2}\\,\\exp\\!\\left(-\\frac{(q-q')^{2}}{2\\ell^{2}}\\right)$，振幅 $\\sigma>0$，长度标度 $\\ell>0$。\n-   描述符：各向同性径向和 $q_{i}=\\sum_{j\\neq i}\\exp\\!\\left(-\\beta\\,r_{ij}^{2}\\right)$，缩放因子 $\\beta>0$。\n-   原子间距离：$r_{ij}=|\\mathbf{R}_{i}-\\mathbf{R}_{j}|$。\n-   稀疏点描述符：$q_{*}$ 是一个固定值。\n-   常数：所有参数 $(w,\\sigma,\\ell,\\beta,q_{*}, a)$ 都是有限、正值且与原子位置无关。\n-   力的定义：$\\mathbf{F}_{i}=-\\nabla_{\\mathbf{R}_{i}}E$。\n-   任务 1：推导在给定对称构型下 $F_{2,x}$ 的精确表达式。\n-   任务 2：验证在此构型下 $\\mathbf{F}_{1}+\\mathbf{F}_{3}=\\mathbf{0}$。\n-   最终答案单位约定：问题要求 $F_{2,x}$ 的最终答案以电子伏特每埃 (eV/Å) 为单位表示。这意味着一个潜在的假设，即所提供的常数具有一套一致的单位（例如，能量单位为 eV，距离单位为 Å），以得出此结果。\n\n**第 2 步：使用提取的已知条件进行验证**\n该问题具有科学依据，使用了机器学习原子间势领域中一个简化但标准的公式。问题提法清晰，提供了执行所需推导的所有必要数学定义和约束。语言客观而精确。该问题并非微不足道，因为势的多体性质意味着中心原子上的力不像简单的对偶势那样可以通过观察直接得出。其内部一致性是可靠的；基于所提供的框架，所要求的计算是可行的。“牛顿第三定律”的非标准提法通过一个明确的定义得到了澄清，消除了歧义。因此，该问题被认定为有效。\n\n**第 3 步：结论与行动**\n问题有效。将提供完整解答。\n\n### 解题推导\n\n**第 1 部分：推导原子 2 上的力 ($F_{2,x}$)**\n\n作用在原子 $i$ 上的力由 $\\mathbf{F}_{i}=-\\nabla_{\\mathbf{R}_{i}}E$ 给出。我们关心的是作用在原子 2 上的力的 $x$ 分量，即 $F_{2,x} = -\\frac{\\partial E}{\\partial x_{2}}$。由于该问题实际上是沿 $x$ 轴的一维问题，我们可以将位置简化为 $R_{1,x}=-a$, $R_{2,x}=x_2$ 和 $R_{3,x}=a$。我们将对 $x_2$ 进行微分，然后在对称构型 $x_2=0$ 处计算结果。\n\n总能量为 $E = E_1 + E_2 + E_3$。力的分量为：\n$$\nF_{2,x} = -\\frac{\\partial}{\\partial x_{2}}(E_{1} + E_{2} + E_{3}) = -\\left(\\frac{\\partial E_{1}}{\\partial x_{2}} + \\frac{\\partial E_{2}}{\\partial x_{2}} + \\frac{\\partial E_{3}}{\\partial x_{2}}\\right)\n$$\n我们需要使用链式法则计算每一项。对于任意原子能量 $E_i = w\\,k(q_i, q_*)$，其对 $x_2$ 的导数为：\n$$\n\\frac{\\partial E_i}{\\partial x_2} = \\frac{\\partial E_i}{\\partial q_i} \\frac{\\partial q_i}{\\partial x_2} = w \\frac{d k(q_i, q_*)}{d q_i} \\frac{\\partial q_i}{\\partial x_2}\n$$\n核函数 $k(q, q')$ 对其第一个参数 $q$ 的导数为：\n$$\n\\frac{d k(q, q_*)}{d q} = \\frac{d}{dq}\\left[\\sigma^{2}\\exp\\left(-\\frac{(q-q_{*})^{2}}{2\\ell^{2}}\\right)\\right] = \\sigma^{2}\\exp\\left(-\\frac{(q-q_{*})^{2}}{2\\ell^{2}}\\right) \\left(-\\frac{2(q-q_{*})}{2\\ell^{2}}\\right) = -\\frac{\\sigma^2}{\\ell^2}(q-q_{*})\\exp\\left(-\\frac{(q-q_{*})^{2}}{2\\ell^{2}}\\right) = -\\frac{1}{\\ell^2}(q-q_*) k(q, q_*)\n$$\n因此，能量的导数为：\n$$\n\\frac{\\partial E_i}{\\partial x_2} = -\\frac{w}{\\ell^2} (q_i - q_*) k(q_i, q_*) \\frac{\\partial q_i}{\\partial x_2}\n$$\n接下来，我们将描述符 $q_i$ 定义为 $x_2$ 的函数。原子间距离的平方为：\n-   $r_{12}^2 = (R_{1,x} - R_{2,x})^2 = (-a - x_2)^2 = (x_2+a)^2$\n-   $r_{23}^2 = (R_{2,x} - R_{3,x})^2 = (x_2 - a)^2$\n-   $r_{13}^2 = (R_{1,x} - R_{3,x})^2 = (-a - a)^2 = 4a^2$\n\n描述符为：\n-   $q_1 = \\exp(-\\beta r_{12}^2) + \\exp(-\\beta r_{13}^2) = \\exp(-\\beta(x_2+a)^2) + \\exp(-4\\beta a^2)$\n-   $q_2 = \\exp(-\\beta r_{21}^2) + \\exp(-\\beta r_{23}^2) = \\exp(-\\beta(x_2+a)^2) + \\exp(-\\beta(x_2-a)^2)$\n-   $q_3 = \\exp(-\\beta r_{31}^2) + \\exp(-\\beta r_{32}^2) = \\exp(-4\\beta a^2) + \\exp(-\\beta(x_2-a)^2)$\n\n现在我们求描述符对 $x_2$ 的导数：\n-   $\\frac{\\partial q_1}{\\partial x_2} = \\exp(-\\beta(x_2+a)^2) \\cdot (-2\\beta(x_2+a))$\n-   $\\frac{\\partial q_2}{\\partial x_2} = \\exp(-\\beta(x_2+a)^2) \\cdot (-2\\beta(x_2+a)) + \\exp(-\\beta(x_2-a)^2) \\cdot (-2\\beta(x_2-a))$\n-   $\\frac{\\partial q_3}{\\partial x_2} = \\exp(-\\beta(x_2-a)^2) \\cdot (-2\\beta(x_2-a))$\n\n我们在指定的对称构型，即 $x_2=0$ 处，计算这些量：\n-   当 $x_2=0$ 时： $q_1(0) = \\exp(-\\beta a^2) + \\exp(-4\\beta a^2)$\n-   当 $x_2=0$ 时： $q_2(0) = \\exp(-\\beta a^2) + \\exp(-\\beta a^2) = 2\\exp(-\\beta a^2)$\n-   当 $x_2=0$ 时： $q_3(0) = \\exp(-4\\beta a^2) + \\exp(-\\beta a^2) = q_1(0)$。我们记 $q_{sym} \\equiv q_1(0) = q_3(0)$。\n\n$x_2=0$ 处描述符的导数为：\n-   $\\frac{\\partial q_1}{\\partial x_2}\\bigg|_{x_2=0} = \\exp(-\\beta a^2) \\cdot (-2\\beta a) = -2a\\beta\\exp(-\\beta a^2)$\n-   $\\frac{\\partial q_2}{\\partial x_2}\\bigg|_{x_2=0} = \\exp(-\\beta a^2) \\cdot (-2\\beta a) + \\exp(-\\beta a^2) \\cdot (2\\beta a) = 0$\n-   $\\frac{\\partial q_3}{\\partial x_2}\\bigg|_{x_2=0} = \\exp(-\\beta a^2) \\cdot (-2\\beta(-a)) = 2a\\beta\\exp(-\\beta a^2)$\n\n现在我们可以组合力的各个项了。\n来自 $E_2$ 的贡献：\n$$\n\\frac{\\partial E_2}{\\partial x_2}\\bigg|_{x_2=0} = \\left(-\\frac{w}{\\ell^2} (q_2(0) - q_*) k(q_2(0), q_*)\\right) \\cdot \\left(\\frac{\\partial q_2}{\\partial x_2}\\bigg|_{x_2=0}\\right) = \\left(-\\frac{w}{\\ell^2} (q_2(0) - q_*) k(q_2(0), q_*)\\right) \\cdot 0 = 0\n$$\n来自 $E_1$ 的贡献：\n$$\n\\frac{\\partial E_1}{\\partial x_2}\\bigg|_{x_2=0} = \\left(-\\frac{w}{\\ell^2} (q_{sym} - q_*) k(q_{sym}, q_*)\\right) \\cdot \\left(-2a\\beta\\exp(-\\beta a^2)\\right)\n$$\n来自 $E_3$ 的贡献：\n$$\n\\frac{\\partial E_3}{\\partial x_2}\\bigg|_{x_2=0} = \\left(-\\frac{w}{\\ell^2} (q_{sym} - q_*) k(q_{sym}, q_*)\\right) \\cdot \\left(2a\\beta\\exp(-\\beta a^2)\\right)\n$$\n能量的总导数是这三项贡献之和：\n$$\n\\frac{\\partial E}{\\partial x_2}\\bigg|_{x_2=0} = \\frac{\\partial E_1}{\\partial x_2}\\bigg|_{x_2=0} + \\frac{\\partial E_2}{\\partial x_2}\\bigg|_{x_2=0} + \\frac{\\partial E_3}{\\partial x_2}\\bigg|_{x_2=0}\n$$\n$$\n\\frac{\\partial E}{\\partial x_2}\\bigg|_{x_2=0} = \\left(-\\frac{w}{\\ell^2} (q_{sym} - q_*) k(q_{sym}, q_*)\\right) \\left(-2a\\beta\\exp(-\\beta a^2)\\right) + 0 + \\left(-\\frac{w}{\\ell^2} (q_{sym} - q_*) k(q_{sym}, q_*)\\right) \\left(2a\\beta\\exp(-\\beta a^2)\\right)\n$$\n第一项和第三项大小相等，符号相反。因此，它们相互抵消：\n$$\n\\frac{\\partial E}{\\partial x_2}\\bigg|_{x_2=0} = 0\n$$\n作用在原子 2 上的力的 $x$ 分量为 $F_{2,x} = -\\frac{\\partial E}{\\partial x_2}$。在对称构型下，该值为：\n$$\nF_{2,x} = -0 = 0\n$$\n结果恰好为零。根据对称性，作用在原子 2 上的力的 $y$ 和 $z$ 分量也为零，因此 $\\mathbf{F}_2 = \\mathbf{0}$。\n\n**第 2 部分：验证 $\\mathbf{F}_{1}+\\mathbf{F}_{3}=\\mathbf{0}$**\n\n系统的总势能 $E$ 是由描述符 $q_i$ 构建的，而这些描述符仅依赖于原子间距离 $r_{ij} = |\\mathbf{R}_i - \\mathbf{R}_j|$。一个仅依赖于粒子相对位置的势能函数，在所有粒子进行统一平移时保持不变，即对于任意常数向量 $\\mathbf{c}$，都有 $E(\\mathbf{R}_1+\\mathbf{c}, \\mathbf{R}_2+\\mathbf{c}, \\mathbf{R}_3+\\mathbf{c}) = E(\\mathbf{R}_1, \\mathbf{R}_2, \\mathbf{R}_3)$。\n这种平移不变性的一个直接推论是，系统中所有原子上的力之和必须为零（这是孤立系统总动量守恒的表述）。\n$$\n\\sum_{i=1}^{3} \\mathbf{F}_i = \\mathbf{F}_1 + \\mathbf{F}_2 + \\mathbf{F}_3 = \\mathbf{0}\n$$\n在第 1 部分中，我们明确推导出，对于指定的对称构型，中心原子上的力为零：$\\mathbf{F}_2 = \\mathbf{0}$。\n将此结果代入力求和式中，得到：\n$$\n\\mathbf{F}_1 + \\mathbf{0} + \\mathbf{F}_3 = \\mathbf{0}\n$$\n$$\n\\mathbf{F}_1 + \\mathbf{F}_3 = \\mathbf{0}\n$$\n这验证了问题陈述中要求的性质。这是 GAP 势的平移不变性以及原子构型的特定对称性的直接结果，该对称性导致中心原子上的力为零。问题陈述中“牛顿第三定律”的非标准标签指的是在这种特定的对称多体背景下出现的力抵消关系 $\\mathbf{F}_1 = -\\mathbf{F}_3$。\n\n$F_{2,x}$ 的最终简化表达式为 $0$。以所要求的单位表示，即为 $0 \\text{ eV/\\AA}$。",
            "answer": "$$\n\\boxed{0}\n$$"
        }
    ]
}