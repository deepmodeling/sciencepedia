{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any local environment-based potential, including Gaussian Approximation Potentials, is the principle of locality: an atom's energy is determined by its nearby neighbors. This first practice focuses on the essential prerequisite of identifying these neighbors within a periodic system, a standard setup in materials modeling. You will implement the robust minimum image convention to construct a neighbor list, a fundamental algorithm that serves as the entry point for transforming raw atomic coordinates into meaningful chemical information .",
            "id": "3763478",
            "problem": "You are given a three-dimensional periodic atomic configuration defined by a lattice basis and a set of atomic positions. The objective is to construct, from first principles, the neighbor list under periodic boundary conditions for a given cutoff radius $r_c$, and to articulate how this neighbor list is the foundational input to local atomic environments $\\mathcal{X}_i$ used in Gaussian Approximation Potentials (GAP). The derivation must begin from the definitions of periodicity in crystals and the metric induced by a lattice basis, and proceed logically to what should be implemented.\n\nUse the following fundamental base:\n- Periodicity: Two points in space are considered equivalent if they differ by an integer linear combination of lattice basis vectors. If the lattice basis is represented by a $3 \\times 3$ matrix $\\mathbf{A}$ whose columns are the basis vectors, then for any $\\mathbf{n} \\in \\mathbb{Z}^3$, the translation $\\mathbf{x} \\mapsto \\mathbf{x} + \\mathbf{A}\\mathbf{n}$ leaves the crystal invariant.\n- Distances in a general triclinic lattice are measured in Cartesian space using the Euclidean norm. The induced metric tensor is $\\mathbf{G} = \\mathbf{A}^\\top \\mathbf{A}$, so that the squared distance associated with a fractional coordinate difference $\\Delta \\mathbf{s}$ is $\\Delta \\mathbf{s}^\\top \\mathbf{G} \\Delta \\mathbf{s}$.\n\nDefine the neighbor list $\\mathcal{N}(i)$ for atom $i$ as the set of all indices $j \\ne i$ such that the shortest distance under periodic boundary conditions between atom $i$ and atom $j$ is less than or equal to the cutoff $r_c$. Positions are expressed in Cartesian coordinates in Angstroms, and the cutoff $r_c$ is also in Angstroms. The neighbor criterion must include equality, i.e., a pair with distance $r_{ij} = r_c$ is considered neighbors.\n\nYou must implement a program that:\n1. Computes, for each atom $i$, the number of neighbors $|\\mathcal{N}(i)|$ under periodic boundary conditions for each test case.\n2. Uses the minimum image convention consistent with general triclinic cells. Represent positions as fractional coordinates $\\mathbf{s}_i = \\mathbf{A}^{-1}\\mathbf{x}_i$ and use integer lattice translations to identify the shortest interatomic vector in Cartesian coordinates, and then decide neighbor inclusion with the Euclidean norm and the cutoff $r_c$.\n3. Outlines, in comments or accompanying derivation, how the resulting neighbor list defines the local environment $\\mathcal{X}_i$ for Gaussian Approximation Potentials (GAP), including what data enter $\\mathcal{X}_i$ and how they would be used in typical two-body or higher-order descriptors. The program’s output must remain only the numerical results specified below.\n\nPhysical units: All distances and the cutoff $r_c$ must be treated in Angstroms. No angles are required in this task.\n\nTest Suite:\nProvide results for the following four test cases.\n\n- Test case 1 (cubic, typical case):\n  - Lattice matrix $\\mathbf{A} = \\mathrm{diag}(5.0, 5.0, 5.0)$ Angstrom.\n  - Cartesian positions $\\mathbf{x}_1 = (0.5, 0.5, 0.5)$ Angstrom, $\\mathbf{x}_2 = (2.0, 2.0, 2.0)$ Angstrom.\n  - Cutoff $r_c = 3.0$ Angstrom.\n\n- Test case 2 (triclinic, boundary wrapping case):\n  - Lattice matrix\n    $$\n    \\mathbf{A} =\n    \\begin{bmatrix}\n    4.0 & 0.5 & 0.0 \\\\\n    0.0 & 3.5 & 0.5 \\\\\n    0.2 & 0.0 & 4.5\n    \\end{bmatrix}\n    \\text{ Angstrom.}\n    $$\n  - Fractional coordinates $\\mathbf{s}_1 = (0.98, 0.50, 0.50)$, $\\mathbf{s}_2 = (0.02, 0.50, 0.50)$, $\\mathbf{s}_3 = (0.50, 0.50, 0.50)$, with Cartesian positions defined by $\\mathbf{x}_i = \\mathbf{A}\\mathbf{s}_i$.\n  - Cutoff $r_c = 2.5$ Angstrom.\n\n- Test case 3 (cubic, small cutoff edge case):\n  - Lattice matrix $\\mathbf{A} = \\mathrm{diag}(5.0, 5.0, 5.0)$ Angstrom.\n  - Cartesian positions $\\mathbf{x}_1 = (0.5, 0.5, 0.5)$ Angstrom, $\\mathbf{x}_2 = (2.0, 2.0, 2.0)$ Angstrom.\n  - Cutoff $r_c = 1.0$ Angstrom.\n\n- Test case 4 (cubic, exact boundary inclusion case):\n  - Lattice matrix $\\mathbf{A} = \\mathrm{diag}(10.0, 10.0, 10.0)$ Angstrom.\n  - Cartesian positions $\\mathbf{x}_1 = (0.0, 0.0, 0.0)$ Angstrom, $\\mathbf{x}_2 = (5.0, 0.0, 0.0)$ Angstrom.\n  - Cutoff $r_c = 5.0$ Angstrom.\n\nRequired final output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of neighbor counts per atom in that case. For example, for four test cases with two atoms each, the output must be of the form $[[n_{1,1},n_{1,2}], [n_{2,1},n_{2,2}], [n_{3,1},n_{3,2}], [n_{4,1},n_{4,2}]]$. For the above test suite, the number of atoms per case is $2$, $3$, $2$, and $2$, respectively. The output must contain integers only.",
            "solution": "The problem requires the construction of a periodic neighbor list for a given atomic configuration and cutoff radius, and an explanation of its role as the foundational input for Gaussian Approximation Potentials (GAP). The solution proceeds by first establishing the theoretical framework for distance calculations in periodic systems and then applying this framework to the provided test cases.\n\n### Theoretical Framework\n\n**1. Periodicity and Coordinate Systems**\nAn ideal crystal structure is characterized by a repeating unit cell. The geometry of this cell is defined by a set of three linearly independent lattice basis vectors, $\\mathbf{a}_1, \\mathbf{a}_2, \\mathbf{a}_3$. These vectors can be assembled as columns into a $3 \\times 3$ lattice matrix $\\mathbf{A} = [\\mathbf{a}_1, \\mathbf{a}_2, \\mathbf{a}_3]$.\n\nAny point in the crystal can be described by Cartesian coordinates $\\mathbf{x} \\in \\mathbb{R}^3$. Alternatively, we can use fractional (or crystal) coordinates $\\mathbf{s} \\in \\mathbb{R}^3$, which express a position as a linear combination of the basis vectors. The relationship between the two coordinate systems is given by:\n$$ \\mathbf{x} = \\mathbf{A}\\mathbf{s} \\quad \\Leftrightarrow \\quad \\mathbf{s} = \\mathbf{A}^{-1}\\mathbf{x} $$\nThe defining property of periodicity is that the crystal is invariant under translation by any integer linear combination of the lattice vectors. That is, for any position vector $\\mathbf{x}$ and any integer vector $\\mathbf{n} = (n_1, n_2, n_3)^\\top \\in \\mathbb{Z}^3$, the point $\\mathbf{x}' = \\mathbf{x} + \\mathbf{A}\\mathbf{n}$ is physically equivalent to $\\mathbf{x}$. In fractional coordinates, this corresponds to a simple translation by an integer vector: $\\mathbf{s}' = \\mathbf{s} + \\mathbf{n}$.\n\n**2. Minimum Image Convention**\nTo determine if two atoms, $i$ and $j$, at positions $\\mathbf{x}_i$ and $\\mathbf{x}_j$ are neighbors, we must find the shortest possible distance between atom $i$ and any periodic image of atom $j$. A periodic image of atom $j$ is located at $\\mathbf{x}_j'(\\mathbf{n}) = \\mathbf{x}_j + \\mathbf{A}\\mathbf{n}$ for some $\\mathbf{n} \\in \\mathbb{Z}^3$. We seek to find the integer vector $\\mathbf{n}^*$ that minimizes the distance $||\\mathbf{x}_j'(\\mathbf{n}) - \\mathbf{x}_i||$.\n\nThis minimization problem is most conveniently solved in fractional coordinates. The vector connecting atom $i$ to an image of atom $j$ is $\\mathbf{r}_{ij}(\\mathbf{n}) = \\mathbf{x}_j'(\\mathbf{n}) - \\mathbf{x}_i = \\mathbf{A}(\\mathbf{s}_j + \\mathbf{n} - \\mathbf{s}_i)$. Let $\\Delta\\mathbf{s} = \\mathbf{s}_j - \\mathbf{s}_i$. Then $\\mathbf{r}_{ij}(\\mathbf{n}) = \\mathbf{A}(\\Delta\\mathbf{s} + \\mathbf{n})$. We need to find $\\mathbf{n}^*$ that minimizes the length of this vector.\n\nThe **minimum image convention** provides a direct method to find the representation of the displacement vector corresponding to the shortest distance. We seek an integer vector $\\mathbf{n}$ such that the components of the shifted fractional displacement, $\\Delta\\mathbf{s}' = \\Delta\\mathbf{s} + \\mathbf{n}$, lie within a specific domain, typically centered at the origin. By choosing this domain to be $[-0.5, 0.5]^3$, we ensure that we are considering the closest periodic image. This is achieved by setting $\\mathbf{n} = -\\mathrm{round}(\\Delta\\mathbf{s})$, where the rounding operation is applied component-wise to the vector $\\Delta\\mathbf{s}$. The minimal fractional displacement vector is thus:\n$$ \\Delta\\mathbf{s}_\\text{min} = \\Delta\\mathbf{s} - \\mathrm{round}(\\Delta\\mathbf{s}) $$\nEach component of $\\Delta\\mathbf{s}_\\text{min}$ is guaranteed to be in the interval $[-0.5, 0.5]$. The shortest displacement vector in Cartesian coordinates is then found by applying the lattice matrix:\n$$ \\mathbf{r}_{ij, \\text{min}} = \\mathbf{A} \\Delta\\mathbf{s}_\\text{min} $$\nFinally, the squared shortest distance is the squared Euclidean norm of this vector:\n$$ d_{ij}^2 = ||\\mathbf{r}_{ij, \\text{min}}||^2 = \\mathbf{r}_{ij, \\text{min}} \\cdot \\mathbf{r}_{ij, \\text{min}} $$\n\n**3. Neighbor List Construction**\nThe neighbor list for atom $i$, denoted $\\mathcal{N}(i)$, is the set of indices of all other atoms $j$ ($j \\neq i$) for which the shortest distance $d_{ij}$ is less than or equal to a specified cutoff radius $r_c$.\n$$ \\mathcal{N}(i) = \\{ j \\mid j \\neq i \\land d_{ij} \\le r_c \\} $$\nThe number of neighbors for atom $i$ is the cardinality of this set, $|\\mathcal{N}(i)|$.\n\nThe algorithm to compute the neighbor counts is as follows:\n1.  For a given atomic configuration (lattice matrix $\\mathbf{A}$ and atomic positions), convert all Cartesian positions $\\mathbf{x}_k$ to fractional coordinates $\\mathbf{s}_k = \\mathbf{A}^{-1}\\mathbf{x}_k$, if not already provided.\n2.  For each atom $i$ in the system:\n    a. Initialize a neighbor counter, $C_i = 0$.\n    b. For each other atom $j$ in the system ($j \\neq i$):\n        i.   Calculate the fractional displacement vector: $\\Delta\\mathbf{s} = \\mathbf{s}_j - \\mathbf{s}_i$.\n        ii.  Apply the minimum image convention: $\\Delta\\mathbf{s}_\\text{min} = \\Delta\\mathbf{s} - \\mathrm{round}(\\Delta\\mathbf{s})$.\n        iii. Convert to the shortest Cartesian displacement vector: $\\mathbf{r}_{ij, \\text{min}} = \\mathbf{A} \\Delta\\mathbf{s}_\\text{min}$.\n        iv.  Compute the squared distance: $d_{ij}^2 = \\mathbf{r}_{ij, \\text{min}} \\cdot \\mathbf{r}_{ij, \\text{min}}$.\n        v.   Check the neighbor criterion: If $d_{ij}^2 \\le r_c^2$, increment the counter $C_i$.\n3.  The final result for the configuration is the list of all neighbor counts $[C_0, C_1, \\dots, C_{N-1}]$.\n\n**4. Connection to Gaussian Approximation Potentials (GAP)**\nGaussian Approximation Potentials, like many other machine-learned interatomic potentials, are founded on the principle of locality. This principle states that the potential energy of an atom, $E_i$, is determined by the arrangement of its nearby atoms. The total energy of the system is then approximated as a sum over these atomic contributions:\n$$ E_\\text{total} \\approx \\sum_{i=1}^{N} E_i(\\mathcal{X}_i) $$\nThe term $\\mathcal{X}_i$ represents the **local atomic environment** of atom $i$. The neighbor list is the primary component used to define this environment. Formally, the local environment $\\mathcal{X}_i$ is the set of shortest displacement vectors pointing from atom $i$ to all its neighbors $j \\in \\mathcal{N}(i)$, often augmented with the chemical species of each atom.\n$$ \\mathcal{X}_i = \\{ (\\mathbf{r}_{ij, \\text{min}}, Z_j) \\mid j \\in \\mathcal{N}(i) \\} $$\nwhere $Z_j$ is the atomic number (or element type) of atom $j$.\n\nThe raw vector data in $\\mathcal{X}_i$ is not directly usable in a machine learning model because it is not invariant to rotations or permutations of identical neighbors. Therefore, $\\mathcal{X}_i$ is transformed into a fixed-size, symmetry-invariant feature vector known as a **descriptor**.\n-   **Two-body descriptors**, used in early GAP models, depend on the distances $d_{ij} = ||\\mathbf{r}_{ij, \\text{min}}||$. For example, a descriptor could be a histogram of these distances or a sum of functions evaluated at these distances.\n-   **Many-body descriptors**, such as the Smooth Overlap of Atomic Positions (SOAP), provide a more complete description of the 3D geometry. SOAP constructs a local atomic density field by placing Gaussian functions at the location of each neighbor vector $\\mathbf{r}_{ij, \\text{min}}$. This field is then expanded in a basis of radial functions and spherical harmonics. The resulting expansion coefficients are combined to form a rotationally and permutationally invariant descriptor vector.\n\nIn all cases, the accurate and efficient construction of the neighbor list $\\mathcal{N}(i)$ and the corresponding set of displacement vectors $\\{\\mathbf{r}_{ij, \\text{min}}\\}$ is the non-negotiable first step. It defines the \"field of view\" for each atom, and any error or inconsistency in this step directly compromises the fidelity of the potential energy model. Thus, the algorithm described above is a cornerstone of modern computational materials modeling.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the neighbor list problem for a series of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"A\": np.diag([5.0, 5.0, 5.0]),\n            \"pos\": np.array([[0.5, 0.5, 0.5], [2.0, 2.0, 2.0]]),\n            \"r_c\": 3.0,\n            \"pos_type\": \"cartesian\"\n        },\n        {\n            \"A\": np.array([\n                [4.0, 0.5, 0.0],\n                [0.0, 3.5, 0.5],\n                [0.2, 0.0, 4.5]\n            ]),\n            \"pos\": np.array([\n                [0.98, 0.50, 0.50],\n                [0.02, 0.50, 0.50],\n                [0.50, 0.50, 0.50]\n            ]),\n            \"r_c\": 2.5,\n            \"pos_type\": \"fractional\"\n        },\n        {\n            \"A\": np.diag([5.0, 5.0, 5.0]),\n            \"pos\": np.array([[0.5, 0.5, 0.5], [2.0, 2.0, 2.0]]),\n            \"r_c\": 1.0,\n            \"pos_type\": \"cartesian\"\n        },\n        {\n            \"A\": np.diag([10.0, 10.0, 10.0]),\n            \"pos\": np.array([[0.0, 0.0, 0.0], [5.0, 0.0, 0.0]]),\n            \"r_c\": 5.0,\n            \"pos_type\": \"cartesian\"\n        },\n    ]\n\n    results = []\n\n    # The derivation of local atomic environments for GAP is as follows:\n    # 1. For each atom 'i', its neighbor list N(i) is constructed by finding all\n    #    atoms 'j' whose shortest periodic distance d_ij is within a cutoff r_c.\n    #    This is the core calculation performed in this function.\n    # 2. The local atomic environment, X_i, is the set of shortest displacement\n    #    vectors from atom 'i' to its neighbors: X_i = {r_ij | j in N(i)}.\n    # 3. These vectors {r_ij} are inputs to descriptor functions.\n    #    - For two-body terms, only the distances ||r_ij|| are used.\n    #    - For many-body terms (like SOAP), the full 3D vectors {r_ij} are\n    #      used to construct a local atomic density, which is then expanded\n    #      in a basis of spherical harmonics and radial functions to produce\n    #      a rotationally-invariant descriptor vector.\n    # The neighbor list is therefore the fundamental input that defines the\n    # local chemical information processed by the GAP model.\n\n    for case in test_cases:\n        A = case[\"A\"]\n        pos = case[\"pos\"]\n        r_c = case[\"r_c\"]\n        pos_type = case[\"pos_type\"]\n        \n        num_atoms = pos.shape[0]\n        r_c_sq = r_c**2\n\n        # Step 1: Convert Cartesian to fractional coordinates if necessary.\n        if pos_type == \"cartesian\":\n            A_inv = np.linalg.inv(A)\n            # To transform a set of row vectors (N, 3), we compute (X @ A_inv.T)\n            frac_pos = pos @ A_inv.T\n        else: # pos_type == \"fractional\"\n            frac_pos = pos\n\n        neighbor_counts = []\n        for i in range(num_atoms):\n            count = 0\n            for j in range(num_atoms):\n                if i == j:\n                    continue\n\n                # Step 2: Calculate fractional displacement and apply minimum image convention.\n                # delta_s = s_j - s_i\n                delta_s = frac_pos[j] - frac_pos[i]\n                \n                # delta_s_min = delta_s - round(delta_s)\n                # This maps each component to the interval [-0.5, 0.5].\n                delta_s_min = delta_s - np.round(delta_s)\n\n                # Step 3: Convert minimal fractional vector back to Cartesian.\n                # r_ij_min = A * delta_s_min\n                r_ij_min = A @ delta_s_min\n                \n                # Step 4: Calculate squared distance and check against cutoff.\n                d_sq = np.dot(r_ij_min, r_ij_min)\n\n                # The problem requires inclusion on the boundary (r_ij = r_c), so we use <=.\n                # A small tolerance is generally wise for float comparisons, but the test\n                # cases are constructed to be exact, so a direct comparison is sufficient.\n                if d_sq <= r_c_sq:\n                    count += 1\n            \n            neighbor_counts.append(count)\n        \n        results.append(neighbor_counts)\n\n    # Final print statement in the exact required format.\n    # Using a custom string formatter to avoid spaces after commas in lists.\n    formatted_results = [f\"[{','.join(map(str, r))}]\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "After identifying an atom's neighbors, their geometric arrangement must be encoded into a standardized, symmetry-invariant feature vector, or \"descriptor.\" This exercise demystifies the widely used Smooth Overlap of Atomic Positions (SOAP) descriptor by guiding you through a first-principles calculation for a simple atomic environment . By deriving a component of the SOAP power spectrum, you will gain a concrete understanding of how this powerful technique transforms a collection of neighbor positions into a structured mathematical object suitable for machine learning.",
            "id": "3763502",
            "problem": "In Gaussian Approximation Potentials (GAP), a Smooth Overlap of Atomic Positions (SOAP) descriptor is built from a neighbor density around a central atom by expanding the density in an orthonormal basis of radial functions and spherical harmonics, and forming rotationally invariant power spectrum components. Consider a central atom at the origin and exactly two neighbor atoms at positions $\\mathbf{r}_{1} = (0,0,1\\,\\mathrm{\\AA})$ and $\\mathbf{r}_{2} = (2\\,\\mathrm{\\AA},0,0)$. The neighbor density is modeled as a sum of normalized three-dimensional Gaussians of width $\\sigma$ centered on each neighbor,\n$$\n\\rho(\\mathbf{r}) = \\sum_{i=1}^{2} \\left(2\\pi \\sigma^{2}\\right)^{-3/2} \\exp\\!\\left(-\\frac{|\\mathbf{r}-\\mathbf{r}_{i}|^{2}}{2\\sigma^{2}}\\right).\n$$\nThe expansion basis consists of a single radial basis function $R_{1}(r)$ and the spherical harmonic of order $l=0$. Specifically, take the Gaussian smearing width to be $\\sigma = 0.5\\,\\mathrm{\\AA}$ and choose the radial basis $R_{1}(r)$ to be the normalized Gaussian\n$$\nR_{1}(r) = \\mathcal{N} \\exp\\!\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right),\n$$\nwith normalization constant $\\mathcal{N}$ fixed by the orthonormality condition $\\int_{0}^{\\infty} r^{2} \\, R_{1}(r)^{2} \\, dr = 1$. Use only the $l=0$ spherical harmonic $Y_{00}(\\hat{\\mathbf{r}}) = \\left(4\\pi\\right)^{-1/2}$, that is, set $l_{\\max}=0$ and $n_{\\max}=1$.\n\nStarting from the standard SOAP definitions,\n- expansion coefficients $c_{nlm} = \\int d^{3}\\mathbf{r}\\, R_{n}(r)\\, Y_{lm}^{*}(\\hat{\\mathbf{r}})\\, \\rho(\\mathbf{r})$,\n- power spectrum components $p_{nn'l} = \\sum_{m=-l}^{l} c_{nlm}\\, c_{n'lm}^{*}$,\n\nderive the exact closed-form expression for the single nonzero SOAP power spectrum component $p_{11,0}$ for this environment. Express your final result as a simplified analytic expression involving exponentials and $\\pi$. Do not introduce any additional cutoffs or window functions beyond what is stated. Express the final numerical value in $\\mathrm{\\AA}^{-3}$. No rounding is required; provide the exact expression.",
            "solution": "The user has provided a problem that requires the calculation of a specific power spectrum component, $p_{11,0}$, within the Smooth Overlap of Atomic Positions (SOAP) framework, which is a part of the Gaussian Approximation Potential (GAP) methodology.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n- **Central Atom:** located at the origin $\\mathbf{r}_{0} = (0,0,0)$.\n- **Neighbor Atoms:** two atoms at positions $\\mathbf{r}_{1} = (0,0,1\\,\\mathrm{\\AA})$ and $\\mathbf{r}_{2} = (2\\,\\mathrm{\\AA},0,0)$.\n- **Neighbor Density:** $\\rho(\\mathbf{r}) = \\sum_{i=1}^{2} \\left(2\\pi \\sigma^{2}\\right)^{-3/2} \\exp\\!\\left(-\\frac{|\\mathbf{r}-\\mathbf{r}_{i}|^{2}}{2\\sigma^{2}}\\right)$.\n- **Gaussian Smearing Width:** $\\sigma = 0.5\\,\\mathrm{\\AA}$.\n- **Expansion Basis:**\n  - Radial part ($n_{\\max}=1$): $R_{1}(r) = \\mathcal{N} \\exp\\!\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right)$, with normalization $\\int_{0}^{\\infty} r^{2} \\, R_{1}(r)^{2} \\, dr = 1$.\n  - Angular part ($l_{\\max}=0$): $Y_{00}(\\hat{\\mathbf{r}}) = \\left(4\\pi\\right)^{-1/2}$.\n- **SOAP Definitions:**\n  - Expansion coefficients: $c_{nlm} = \\int d^{3}\\mathbf{r}\\, R_{n}(r)\\, Y_{lm}^{*}(\\hat{\\mathbf{r}})\\, \\rho(\\mathbf{r})$.\n  - Power spectrum: $p_{nn'l} = \\sum_{m=-l}^{l} c_{nlm}\\, c_{n'lm}^{*}$.\n- **Objective:** Derive the exact closed-form expression for $p_{11,0}$.\n\n**1.2. Validate Using Extracted Givens**\nThe problem is scientifically grounded, situated squarely within the established theoretical framework of computational materials science. The terminology, definitions, and physical parameters are standard and self-consistent. The problem is well-posed, providing all necessary information for a unique solution. There are no contradictions, ambiguities, or scientifically unsound premises.\n\n**1.3. Verdict and Action**\nThe problem is valid. A full, reasoned solution will be provided.\n\n### Step 2: Solution Derivation\n\nThe goal is to compute the power spectrum component $p_{11,0}$. According to the provided definition, for $n=1, n'=1, l=0$, this is:\n$$\np_{11,0} = \\sum_{m=-0}^{0} c_{10m}\\, c_{10m}^{*} = c_{100}\\,c_{100}^{*} = |c_{100}|^{2}\n$$\nThe calculation thus proceeds in three main steps:\n1. Determine the normalization constant $\\mathcal{N}$ for the radial basis function $R_{1}(r)$.\n2. Calculate the expansion coefficient $c_{100}$.\n3. Compute $p_{11,0}$ from $c_{100}$ and substitute the given physical values.\n\n**2.1. Normalization of the Radial Basis Function**\nThe normalization condition for $R_{1}(r)$ is $\\int_{0}^{\\infty} r^{2} R_{1}(r)^{2} dr = 1$. Substituting the functional form of $R_{1}(r)$:\n$$\n\\int_{0}^{\\infty} r^{2} \\left(\\mathcal{N} \\exp\\!\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right)\\right)^{2} dr = \\mathcal{N}^{2} \\int_{0}^{\\infty} r^{2} \\exp\\!\\left(-\\frac{r^{2}}{\\sigma^{2}}\\right) dr = 1\n$$\nThis is a standard Gaussian integral of the form $\\int_0^\\infty x^{2n} e^{-ax^2} dx = \\frac{(2n-1)!!}{2^{n+1}}\\sqrt{\\frac{\\pi}{a^{2n+1}}}$. For our case, $n=1$ and $a=1/\\sigma^2$.\n$$\n\\int_{0}^{\\infty} r^{2} \\exp\\!\\left(-\\frac{r^{2}}{\\sigma^{2}}\\right) dr = \\frac{1!!}{2^{2}} \\sqrt{\\frac{\\pi}{(1/\\sigma^2)^3}} = \\frac{1}{4}\\sqrt{\\pi\\sigma^6} = \\frac{\\sigma^3\\sqrt{\\pi}}{4}\n$$\nThe normalization condition becomes:\n$$\n\\mathcal{N}^{2} \\frac{\\sigma^3\\sqrt{\\pi}}{4} = 1 \\implies \\mathcal{N}^{2} = \\frac{4}{\\sigma^3\\sqrt{\\pi}} \\implies \\mathcal{N} = \\frac{2}{\\sigma^{3/2}\\pi^{1/4}}\n$$\nSince $\\mathcal{N}$ is typically chosen to be positive, we take the positive root.\n\n**2.2. Calculation of the Expansion Coefficient $c_{100}$**\nThe coefficient $c_{100}$ is defined as:\n$$\nc_{100} = \\int d^{3}\\mathbf{r}\\, R_{1}(r)\\, Y_{00}^{*}(\\hat{\\mathbf{r}})\\, \\rho(\\mathbf{r})\n$$\nSince $Y_{00}(\\hat{\\mathbf{r}}) = (4\\pi)^{-1/2}$ is a real constant, $Y_{00}^{*} = Y_{00}$. Substituting the expressions for $\\rho(\\mathbf{r})$, $R_{1}(r)$, and $Y_{00}(\\hat{\\mathbf{r}})$:\n$$\nc_{100} = \\int d^{3}\\mathbf{r}\\, \\left(\\mathcal{N} \\exp\\!\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right)\\right) \\left(\\frac{1}{\\sqrt{4\\pi}}\\right) \\left(\\sum_{i=1}^{2} \\left(2\\pi \\sigma^{2}\\right)^{-3/2} \\exp\\!\\left(-\\frac{|\\mathbf{r}-\\mathbf{r}_{i}|^{2}}{2\\sigma^{2}}\\right)\\right)\n$$\nDue to the linearity of the integral, we can swap the summation and integration:\n$$\nc_{100} = \\sum_{i=1}^{2} \\frac{\\mathcal{N}}{\\sqrt{4\\pi}(2\\pi\\sigma^2)^{3/2}} \\int d^3\\mathbf{r} \\exp\\!\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right) \\exp\\!\\left(-\\frac{|\\mathbf{r}-\\mathbf{r}_{i}|^{2}}{2\\sigma^{2}}\\right)\n$$\nThe integral represents the overlap of two Gaussian functions, one centered at the origin and the other at $\\mathbf{r}_i$. The product of two Gaussians is another Gaussian. Let's combine the exponents:\n$$\n-\\frac{r^{2}}{2\\sigma^{2}} - \\frac{|\\mathbf{r}-\\mathbf{r}_{i}|^{2}}{2\\sigma^{2}} = -\\frac{1}{2\\sigma^{2}} \\left(r^{2} + r^{2} - 2\\mathbf{r}\\cdot\\mathbf{r}_{i} + r_{i}^{2}\\right) = -\\frac{1}{\\sigma^{2}}\\left(r^{2} - \\mathbf{r}\\cdot\\mathbf{r}_{i} + \\frac{r_{i}^{2}}{2}\\right)\n$$\nCompleting the square for the terms involving $\\mathbf{r}$:\n$$\n-\\frac{1}{\\sigma^{2}}\\left(\\left|\\mathbf{r} - \\frac{\\mathbf{r}_{i}}{2}\\right|^{2} - \\frac{r_{i}^{2}}{4} + \\frac{r_{i}^{2}}{2}\\right) = -\\frac{1}{\\sigma^{2}}\\left|\\mathbf{r} - \\frac{\\mathbf{r}_{i}}{2}\\right|^{2} - \\frac{r_{i}^{2}}{4\\sigma^{2}}\n$$\nThe integral becomes:\n$$\n\\int d^3\\mathbf{r} \\exp\\!\\left(-\\frac{r_{i}^{2}}{4\\sigma^{2}}\\right) \\exp\\!\\left(-\\frac{|\\mathbf{r} - \\mathbf{r}_{i}/2|^{2}}{\\sigma^{2}}\\right) = \\exp\\!\\left(-\\frac{r_{i}^{2}}{4\\sigma^{2}}\\right) \\int d^3\\mathbf{r}' \\exp\\!\\left(-\\frac{|\\mathbf{r}'|^{2}}{\\sigma^{2}}\\right)\n$$\nThe remaining integral is a standard 3D Gaussian integral, $\\int \\exp(-ax^2)dx = \\sqrt{\\pi/a}$, so $\\int \\exp(-ar^2)d^3\\mathbf{r} = (\\pi/a)^{3/2}$. With $a=1/\\sigma^2$, the integral evaluates to $(\\pi\\sigma^2)^{3/2}$.\nThe contribution to $c_{100}$ from atom $i$ is:\n$$\nc_{100}^{(i)} = \\frac{\\mathcal{N}}{\\sqrt{4\\pi}(2\\pi\\sigma^2)^{3/2}} \\left(\\exp\\!\\left(-\\frac{r_{i}^{2}}{4\\sigma^{2}}\\right) (\\pi\\sigma^2)^{3/2}\\right)\n= \\frac{\\mathcal{N}}{2\\pi^{1/2} \\cdot 2^{3/2}\\pi^{3/2}\\sigma^3} \\exp\\!\\left(-\\frac{r_{i}^{2}}{4\\sigma^{2}}\\right) \\pi^{3/2}\\sigma^3\n$$\n$$\nc_{100}^{(i)} = \\frac{\\mathcal{N}}{4\\sqrt{2}\\pi^{1/2}} \\exp\\!\\left(-\\frac{r_{i}^{2}}{4\\sigma^{2}}\\right)\n$$\nNow, summing over the two atoms and substituting the expression for $\\mathcal{N}$:\n$$\nc_{100} = \\sum_{i=1}^{2} c_{100}^{(i)} = \\frac{\\mathcal{N}}{4\\sqrt{2}\\pi^{1/2}} \\left(\\exp\\!\\left(-\\frac{r_{1}^{2}}{4\\sigma^{2}}\\right) + \\exp\\!\\left(-\\frac{r_{2}^{2}}{4\\sigma^{2}}\\right)\\right)\n$$\n$$\nc_{100} = \\frac{1}{4\\sqrt{2}\\pi^{1/2}} \\left(\\frac{2}{\\sigma^{3/2}\\pi^{1/4}}\\right) \\left(\\exp\\!\\left(-\\fracr_{1}^{2}}{4\\sigma^{2}}\\right) + \\exp\\!\\left(-\\frac{r_{2}^{2}}{4\\sigma^{2}}\\right)\\right)\n$$\n$$\nc_{100} = \\frac{1}{2\\sqrt{2}\\sigma^{3/2}\\pi^{3/4}} \\left(\\exp\\!\\left(-\\frac{r_{1}^{2}}{4\\sigma^{2}}\\right) + \\exp\\!\\left(-\\frac{r_{2}^{2}}{4\\sigma^{2}}\\right)\\right)\n$$\n\n**2.3. Calculation of the Power Spectrum $p_{11,0}$**\nThe coefficient $c_{100}$ is real, so $p_{11,0} = |c_{100}|^2 = c_{100}^2$:\n$$\np_{11,0} = \\left(\\frac{1}{2\\sqrt{2}\\sigma^{3/2}\\pi^{3/4}}\\right)^{2} \\left(\\exp\\!\\left(-\\frac{r_{1}^{2}}{4\\sigma^{2}}\\right) + \\exp\\!\\left(-\\frac{r_{2}^{2}}{4\\sigma^{2}}\\right)\\right)^{2}\n$$\n$$\np_{11,0} = \\frac{1}{8\\sigma^3\\pi^{3/2}} \\left(\\exp\\!\\left(-\\frac{r_{1}^{2}}{4\\sigma^{2}}\\right) + \\exp\\!\\left(-\\frac{r_{2}^{2}}{4\\sigma^{2}}\\right)\\right)^{2}\n$$\nNow, we substitute the given values: $\\sigma = 0.5\\,\\mathrm{\\AA}$, $\\mathbf{r}_1 = (0,0,1\\,\\mathrm{\\AA})$, $\\mathbf{r}_2 = (2\\,\\mathrm{\\AA},0,0)$.\nThis gives $r_1=|\\mathbf{r}_1| = 1\\,\\mathrm{\\AA}$ and $r_2=|\\mathbf{r}_2| = 2\\,\\mathrm{\\AA}$.\nThe values for the exponents are:\n$$\n\\frac{r_1^2}{4\\sigma^2} = \\frac{1^2}{4(0.5)^2} = \\frac{1}{4(0.25)} = 1\n$$\n$$\n\\frac{r_2^2}{4\\sigma^2} = \\frac{2^2}{4(0.5)^2} = \\frac{4}{4(0.25)} = 4\n$$\nThe value of $\\sigma^3$ is $(0.5)^3 = 1/8$. Substituting these into the expression for $p_{11,0}$:\n$$\np_{11,0} = \\frac{1}{8(1/8)\\pi^{3/2}} \\left(\\exp(-1) + \\exp(-4)\\right)^{2} = \\frac{1}{\\pi^{3/2}} \\left(\\exp(-1) + \\exp(-4)\\right)^{2}\n$$\nTo provide a simplified analytic expression, we can expand the squared term:\n$$\np_{11,0} = \\frac{1}{\\pi^{3/2}} \\left((\\exp(-1))^2 + 2\\exp(-1)\\exp(-4) + (\\exp(-4))^2\\right)\n$$\n$$\np_{11,0} = \\frac{\\exp(-2) + 2\\exp(-5) + \\exp(-8)}{\\pi^{3/2}}\n$$\nThis is the final exact expression for the power spectrum component $p_{11,0}$ in units of $\\mathrm{\\AA}^{-3}$.",
            "answer": "$$\n\\boxed{\\frac{\\exp(-2) + 2\\exp(-5) + \\exp(-8)}{\\pi^{3/2}}}\n$$"
        },
        {
            "introduction": "A key application of GAPs is in performing molecular dynamics simulations, which requires accurate forces on every atom. This practice connects the abstract descriptor-based energy model to this crucial physical observable. By deriving the force on an atom in a toy many-body system using the chain rule, you will see explicitly how the force on one atom arises from the collective positions of its neighbors and how physical principles like symmetry naturally lead to expected outcomes like force cancellation .",
            "id": "3763464",
            "problem": "Consider a one-dimensional toy system of three atoms with positions $\\mathbf{R}_{1}=(-a,0,0)$, $\\mathbf{R}_{2}=(0,0,0)$, and $\\mathbf{R}_{3}=(a,0,0)$, where $a>0$ is a fixed separation. In a Gaussian Approximation Potential (GAP), the total energy is written as a sum of local atomic contributions $E=\\sum_{i=1}^{3}E_{i}$, and forces follow from the negative gradient of the total energy with respect to atomic positions. Take each atomic energy to be modeled by a single sparse-point Gaussian process regression as $E_{i}=w\\,k(q_{i},q_{*})$, where $w>0$ is a regression weight, $q_{*}$ is a fixed descriptor value from the representative sparse set, and $k$ is a scalar kernel. Use the squared-exponential kernel\n$$\nk(q,q')=\\sigma^{2}\\,\\exp\\!\\left(-\\frac{(q-q')^{2}}{2\\ell^{2}}\\right),\n$$\nwith kernel amplitude $\\sigma>0$ and length scale $\\ell>0$. For the local atomic descriptor, use a simple isotropic radial sum\n$$\nq_{i}=\\sum_{j\\neq i}\\exp\\!\\left(-\\beta\\,r_{ij}^{2}\\right),\n$$\nwhere $\\beta>0$ and $r_{ij}=|\\mathbf{R}_{i}-\\mathbf{R}_{j}|$ is the interatomic distance. Assume all constants $(w,\\sigma,\\ell,\\beta,q_{*})$ are finite, positive, and independent of position.\n\nStarting only from the definitions above and the fact that the force on atom $i$ is $\\mathbf{F}_{i}=-\\nabla_{\\mathbf{R}_{i}}E$, derive the exact expression for the $x$-component of the force on the central atom $2$ for the symmetric configuration described, and simplify it fully. Then, on the basis of the same definitions and the symmetry of the configuration, verify that Newton’s third law is respected by the learned potential in the sense that $\\mathbf{F}_{1}+\\mathbf{F}_{3}=\\mathbf{0}$.\n\nYour final answer must be the fully simplified expression for $F_{2,x}$ as a single real number or a closed-form analytic expression. Express the final result for $F_{2,x}$ in electronvolts per ångström (eV/\\AA). No rounding is required.",
            "solution": "The problem asks for the derivation of the x-component of the force on the central atom (atom $2$) in a symmetric one-dimensional three-atom system, modeled with a Gaussian Approximation Potential (GAP). It also asks for verification of a force-cancellation property between the outer atoms.\n\n### Problem Validation\nFirst, the problem statement is validated.\n\n**Step 1: Extract Givens**\n-   System: Three atoms in a one-dimensional configuration.\n-   Positions: $\\mathbf{R}_{1}=(-a,0,0)$, $\\mathbf{R}_{2}=(0,0,0)$, $\\mathbf{R}_{3}=(a,0,0)$, with $a>0$.\n-   Total Energy: $E=\\sum_{i=1}^{3}E_{i}$.\n-   Atomic Energy: $E_{i}=w\\,k(q_{i},q_{*})$, with regression weight $w>0$.\n-   Kernel: Squared-exponential $k(q,q')=\\sigma^{2}\\,\\exp\\!\\left(-\\frac{(q-q')^{2}}{2\\ell^{2}}\\right)$, with amplitude $\\sigma>0$ and length scale $\\ell>0$.\n-   Descriptor: Isotropic radial sum $q_{i}=\\sum_{j\\neq i}\\exp\\!\\left(-\\beta\\,r_{ij}^{2}\\right)$, with scaling factor $\\beta>0$.\n-   Interatomic distance: $r_{ij}=|\\mathbf{R}_{i}-\\mathbf{R}_{j}|$.\n-   Sparse point descriptor: $q_{*}$ is a fixed value.\n-   Constants: All parameters $(w,\\sigma,\\ell,\\beta,q_{*}, a)$ are finite, positive, and independent of atomic positions.\n-   Force Definition: $\\mathbf{F}_{i}=-\\nabla_{\\mathbf{R}_{i}}E$.\n-   Task 1: Derive the exact expression for $F_{2,x}$ for the given symmetric configuration.\n-   Task 2: Verify that $\\mathbf{F}_{1}+\\mathbf{F}_{3}=\\mathbf{0}$ for this configuration.\n-   Final Answer Unit Convention: The problem requests the final answer for $F_{2,x}$ to be expressed in units of electronvolts per ångström (eV/Å). This implies an underlying assumption that the constants provided are in a consistent set of units (e.g., energy in eV, distance in Å) to produce this result.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, using a simplified but standard formulation from the field of machine-learned interatomic potentials. It is well-posed, providing all necessary mathematical definitions and constraints to perform the required derivations. The language is objective and precise. The problem is non-trivial, as the many-body nature of the potential means that the force on the central atom is not immediately obvious by inspection, unlike a simple pairwise potential. The internal consistency is sound; the requested calculations are feasible based on the provided framework. The non-standard phrasing of \"Newton's third law\" is clarified by an explicit definition, removing ambiguity. The problem is therefore deemed valid.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be provided.\n\n### Solution Derivation\n\n**Part 1: Derivation of the Force on Atom 2 ($F_{2,x}$)**\n\nThe force on atom $i$ is given by $\\mathbf{F}_{i}=-\\nabla_{\\mathbf{R}_{i}}E$. We are interested in the $x$-component of the force on atom $2$, which is $F_{2,x} = -\\frac{\\partial E}{\\partial x_{2}}$. Since the problem is effectively one-dimensional along the $x$-axis, we can simplify the positions to $R_{1,x}=-a$, $R_{2,x}=x_2$, and $R_{3,x}=a$. We will perform the differentiation with respect to $x_2$ and then evaluate the result at the symmetric configuration where $x_2=0$.\n\nThe total energy is $E = E_1 + E_2 + E_3$. The force component is:\n$$\nF_{2,x} = -\\frac{\\partial}{\\partial x_{2}}(E_{1} + E_{2} + E_{3}) = -\\left(\\frac{\\partial E_{1}}{\\partial x_{2}} + \\frac{\\partial E_{2}}{\\partial x_{2}} + \\frac{\\partial E_{3}}{\\partial x_{2}}\\right)\n$$\nWe need to calculate each term using the chain rule. For any atomic energy $E_i = w\\,k(q_i, q_*)$, its derivative with respect to $x_2$ is:\n$$\n\\frac{\\partial E_i}{\\partial x_2} = \\frac{\\partial E_i}{\\partial q_i} \\frac{\\partial q_i}{\\partial x_2} = w \\frac{d k(q_i, q_*)}{d q_i} \\frac{\\partial q_i}{\\partial x_2}\n$$\nThe derivative of the kernel $k(q, q')$ with respect to its first argument $q$ is:\n$$\n\\frac{d k(q, q_*)}{d q} = \\frac{d}{dq}\\left[\\sigma^{2}\\exp\\left(-\\frac{(q-q_{*})^{2}}{2\\ell^{2}}\\right)\\right] = \\sigma^{2}\\exp\\left(-\\frac{(q-q_{*})^{2}}{2\\ell^{2}}\\right) \\left(-\\frac{2(q-q_{*})}{2\\ell^{2}}\\right) = -\\frac{\\sigma^2}{\\ell^2}(q-q_{*})\\exp\\left(-\\frac{(q-q_{*})^{2}}{2\\ell^{2}}\\right) = -\\frac{1}{\\ell^2}(q-q_*) k(q, q_*)\n$$\nSo, the energy derivative is:\n$$\n\\frac{\\partial E_i}{\\partial x_2} = -\\frac{w}{\\ell^2} (q_i - q_*) k(q_i, q_*) \\frac{\\partial q_i}{\\partial x_2}\n$$\nNext, we define the descriptors $q_i$ as functions of $x_2$. The squared interatomic distances are:\n-   $r_{12}^2 = (R_{1,x} - R_{2,x})^2 = (-a - x_2)^2 = (x_2+a)^2$\n-   $r_{23}^2 = (R_{2,x} - R_{3,x})^2 = (x_2 - a)^2$\n-   $r_{13}^2 = (R_{1,x} - R_{3,x})^2 = (-a - a)^2 = 4a^2$\n\nThe descriptors are:\n-   $q_1 = \\exp(-\\beta r_{12}^2) + \\exp(-\\beta r_{13}^2) = \\exp(-\\beta(x_2+a)^2) + \\exp(-4\\beta a^2)$\n-   $q_2 = \\exp(-\\beta r_{21}^2) + \\exp(-\\beta r_{23}^2) = \\exp(-\\beta(x_2+a)^2) + \\exp(-\\beta(x_2-a)^2)$\n-   $q_3 = \\exp(-\\beta r_{31}^2) + \\exp(-\\beta r_{32}^2) = \\exp(-4\\beta a^2) + \\exp(-\\beta(x_2-a)^2)$\n\nNow we find the derivatives of the descriptors with respect to $x_2$:\n-   $\\frac{\\partial q_1}{\\partial x_2} = \\exp(-\\beta(x_2+a)^2) \\cdot (-2\\beta(x_2+a))$\n-   $\\frac{\\partial q_2}{\\partial x_2} = \\exp(-\\beta(x_2+a)^2) \\cdot (-2\\beta(x_2+a)) + \\exp(-\\beta(x_2-a)^2) \\cdot (-2\\beta(x_2-a))$\n-   $\\frac{\\partial q_3}{\\partial x_2} = \\exp(-\\beta(x_2-a)^2) \\cdot (-2\\beta(x_2-a))$\n\nWe evaluate these quantities at the specified symmetric configuration, i.e., at $x_2=0$:\n-   At $x_2=0$: $q_1(0) = \\exp(-\\beta a^2) + \\exp(-4\\beta a^2)$\n-   At $x_2=0$: $q_2(0) = \\exp(-\\beta a^2) + \\exp(-\\beta a^2) = 2\\exp(-\\beta a^2)$\n-   At $x_2=0$: $q_3(0) = \\exp(-4\\beta a^2) + \\exp(-\\beta a^2) = q_1(0)$. Let us denote $q_{sym} \\equiv q_1(0) = q_3(0)$.\n\nThe derivatives of the descriptors at $x_2=0$:\n-   $\\frac{\\partial q_1}{\\partial x_2}\\bigg|_{x_2=0} = \\exp(-\\beta a^2) \\cdot (-2\\beta a) = -2a\\beta\\exp(-\\beta a^2)$\n-   $\\frac{\\partial q_2}{\\partial x_2}\\bigg|_{x_2=0} = \\exp(-\\beta a^2) \\cdot (-2\\beta a) + \\exp(-\\beta a^2) \\cdot (2\\beta a) = 0$\n-   $\\frac{\\partial q_3}{\\partial x_2}\\bigg|_{x_2=0} = \\exp(-\\beta a^2) \\cdot (-2\\beta(-a)) = 2a\\beta\\exp(-\\beta a^2)$\n\nNow we can assemble the terms of the force.\nThe contribution from $E_2$:\n$$\n\\frac{\\partial E_2}{\\partial x_2}\\bigg|_{x_2=0} = \\left(-\\frac{w}{\\ell^2} (q_2(0) - q_*) k(q_2(0), q_*)\\right) \\cdot \\left(\\frac{\\partial q_2}{\\partial x_2}\\bigg|_{x_2=0}\\right) = \\left(-\\frac{w}{\\ell^2} (q_2(0) - q_*) k(q_2(0), q_*)\\right) \\cdot 0 = 0\n$$\nThe contribution from $E_1$:\n$$\n\\frac{\\partial E_1}{\\partial x_2}\\bigg|_{x_2=0} = \\left(-\\frac{w}{\\ell^2} (q_{sym} - q_*) k(q_{sym}, q_*)\\right) \\cdot \\left(-2a\\beta\\exp(-\\beta a^2)\\right)\n$$\nThe contribution from $E_3$:\n$$\n\\frac{\\partial E_3}{\\partial x_2}\\bigg|_{x_2=0} = \\left(-\\frac{w}{\\ell^2} (q_{sym} - q_*) k(q_{sym}, q_*)\\right) \\cdot \\left(2a\\beta\\exp(-\\beta a^2)\\right)\n$$\nThe total derivative of the energy is the sum of these three contributions:\n$$\n\\frac{\\partial E}{\\partial x_2}\\bigg|_{x_2=0} = \\frac{\\partial E_1}{\\partial x_2}\\bigg|_{x_2=0} + \\frac{\\partial E_2}{\\partial x_2}\\bigg|_{x_2=0} + \\frac{\\partial E_3}{\\partial x_2}\\bigg|_{x_2=0}\n$$\n$$\n\\frac{\\partial E}{\\partial x_2}\\bigg|_{x_2=0} = \\left(-\\frac{w}{\\ell^2} (q_{sym} - q_*) k(q_{sym}, q_*)\\right) \\left(-2a\\beta\\exp(-\\beta a^2)\\right) + 0 + \\left(-\\frac{w}{\\ell^2} (q_{sym} - q_*) k(q_{sym}, q_*)\\right) \\left(2a\\beta\\exp(-\\beta a^2)\\right)\n$$\nThe first and third terms are identical in magnitude but opposite in sign. Therefore, they cancel out:\n$$\n\\frac{\\partial E}{\\partial x_2}\\bigg|_{x_2=0} = 0\n$$\nThe $x$-component of the force on atom $2$ is $F_{2,x} = -\\frac{\\partial E}{\\partial x_2}$. At the symmetric configuration, this is:\n$$\nF_{2,x} = -0 = 0\n$$\nThe result is exactly zero. By symmetry, the $y$- and $z$-components of the force on atom $2$ are also zero, thus $\\mathbf{F}_2 = \\mathbf{0}$.\n\n**Part 2: Verification of $\\mathbf{F}_{1}+\\mathbf{F}_{3}=\\mathbf{0}$**\n\nThe total potential energy $E$ of the system is constructed from descriptors $q_i$ which depend only on the interatomic distances $r_{ij} = |\\mathbf{R}_i - \\mathbf{R}_j|$. A potential energy function that depends only on the relative positions of the particles is invariant under a uniform translation of all particles, i.e., $E(\\mathbf{R}_1+\\mathbf{c}, \\mathbf{R}_2+\\mathbf{c}, \\mathbf{R}_3+\\mathbf{c}) = E(\\mathbf{R}_1, \\mathbf{R}_2, \\mathbf{R}_3)$ for any constant vector $\\mathbf{c}$.\nA direct consequence of this translational invariance is that the sum of the forces on all atoms in the system must be zero (this is a statement of conservation of total momentum for an isolated system).\n$$\n\\sum_{i=1}^{3} \\mathbf{F}_i = \\mathbf{F}_1 + \\mathbf{F}_2 + \\mathbf{F}_3 = \\mathbf{0}\n$$\nIn Part 1, we explicitly derived that for the specified symmetric configuration, the force on the central atom is zero: $\\mathbf{F}_2 = \\mathbf{0}$.\nSubstituting this result into the force summation gives:\n$$\n\\mathbf{F}_1 + \\mathbf{0} + \\mathbf{F}_3 = \\mathbf{0}\n$$\n$$\n\\mathbf{F}_1 + \\mathbf{F}_3 = \\mathbf{0}\n$$\nThis verifies the property requested in the problem statement. It is a direct consequence of the translational invariance of the GAP potential and the specific symmetry of the atomic configuration, which leads to a null force on the central atom. The non-standard label of \"Newton's third law\" in the problem statement refers to this emergent force-cancellation relationship $\\mathbf{F}_1 = -\\mathbf{F}_3$ in this specific symmetric many-body context.\n\nThe final simplified expression for $F_{2,x}$ is $0$. Expressed in the requested units, this is $0 \\text{ eV/\\AA}$.",
            "answer": "$$\n\\boxed{0}\n$$"
        }
    ]
}