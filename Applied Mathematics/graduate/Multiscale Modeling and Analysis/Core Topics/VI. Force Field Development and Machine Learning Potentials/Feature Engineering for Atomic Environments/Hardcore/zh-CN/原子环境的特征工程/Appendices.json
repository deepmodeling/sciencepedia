{
    "hands_on_practices": [
        {
            "introduction": "机器学习模型的第一步是将原子结构转化为固定长度的数值向量，即“描述符”或“指纹”。这个过程对于捕捉原子周围的局部化学环境至关重要。本练习将指导您完成一个基本但完整的流程，为周期性系统中的一个原子构建一个径向描述符，其中涉及处理周期性边界条件和应用平滑截止函数等核心技术 。",
            "id": "3757519",
            "problem": "考虑一个三维的具有周期性边界条件（PBC）的简单立方布拉维格子。原胞晶格矢量为 $\\mathbf{a}_1=(3.0\\,\\mathrm{\\AA},0,0)$、$\\mathbf{a}_2=(0,3.0\\,\\mathrm{\\AA},0)$ 和 $\\mathbf{a}_3=(0,0,3.0\\,\\mathrm{\\AA})$。在一个单胞内，有五个原子，其笛卡尔坐标（单位为 $\\mathrm{\\AA}$）分别为：原子 $i$ 位于 $(0,0,0)$，另外四个原子位于 $(1.0,0,0)$、$(0,1.2,0)$、$(0,0,1.8)$ 和 $(2.5,0,0)$。距离使用欧几里得范数，并遵循周期性边界条件下的最小镜像约定进行计算。\n\n您的任务是为原子 $i$ 构建一个标量径向指纹，该指纹能够捕捉其在半径 $r_c = 2.0\\,\\mathrm{\\AA}$ 的球形邻域内的局部原子环境。该指纹必须同时包含平滑截断和局域径向加权。\n\n从适用于多尺度建模与分析的基本原理出发：\n\n1. 使用 PBC 和最小镜像约定，通过识别哪些原子（如果需要，包括其周期性镜像）位于原子 $i$ 的距离 $r_c$ 之内，来确定原子 $i$ 的邻居列表。报告对指纹有贡献的每个不同的原子间距 $r_{ij}$。\n2. 推导一个在 $[0,r_c]$ 上定义的平滑余弦截断函数 $f_c(r)$，该函数非负，满足 $f_c(0)=1$、$f_c(r_c)=0$，并且在两个端点处的一阶导数均为零，即 $f_c'(0)=0$ 和 $f_c'(r_c)=0$。角度必须以弧度处理。\n3. 使用中心位于 $R_s=1.0\\,\\mathrm{\\AA}$、宽度参数为 $\\eta=4.0\\,\\mathrm{\\AA}^{-2}$ 的高斯径向基，为原子 $i$ 构建标量径向指纹 $G_i(R_s;\\eta)$。该指纹是截断半径内所有邻居贡献的总和，每个邻居的贡献是高斯径向权重与在其到原子 $i$ 的最小镜像距离处计算的截断值的乘积。\n\n将最终的指纹值 $G_i(R_s;\\eta)$ 表示为一个包含 $\\exp(\\cdot)$、$\\pi$ 和根式的单一闭合形式解析表达式；不要提供小数近似值。最终答案必须无量纲，并以一个表达式呈现。三角函数中的角度必须是弧度。",
            "solution": "首先将根据科学合理性、良构性和客观性的指定标准对问题进行验证。\n\n### 问题验证\n\n**步骤1：提取给定条件**\n- **晶格与周期性**：三维具有周期性边界条件（PBC）的简单立方布拉维格子。\n- **晶格矢量**：$\\mathbf{a}_1=(3.0\\,\\mathrm{\\AA},0,0)$、$\\mathbf{a}_2=(0,3.0\\,\\mathrm{\\AA},0)$ 和 $\\mathbf{a}_3=(0,0,3.0\\,\\mathrm{\\AA})$。这定义了一个边长为 $L=3.0\\,\\mathrm{\\AA}$ 的立方晶胞。\n- **原子坐标**：一个中心原子 $i$ 位于 $\\mathbf{r}_i=(0,0,0)\\,\\mathrm{\\AA}$。单胞内另外四个原子位于 $\\mathbf{r}_j$：$(1.0,0,0)\\,\\mathrm{\\AA}$、$(0,1.2,0)\\,\\mathrm{\\AA}$、$(0,0,1.8)\\,\\mathrm{\\AA}$ 和 $(2.5,0,0)\\,\\mathrm{\\AA}$。\n- **距离计算**：欧几里得范数与最小镜像约定（MIC）。\n- **截断半径**：$r_c = 2.0\\,\\mathrm{\\AA}$。\n- **任务1**：确定邻居列表并报告 $r_c$ 范围内邻居的独特原子间距 $r_{ij}$。\n- **任务2**：推导一个在 $[0,r_c]$ 上的平滑余弦截断函数 $f_c(r)$，使得 $f_c(r) \\ge 0$，$f_c(0)=1$，$f_c(r_c)=0$，$f_c'(0)=0$ 和 $f_c'(r_c)=0$。\n- **任务3**：计算标量径向指纹 $G_i(R_s;\\eta)$，其定义为 $G_i = \\sum_{j} \\exp(-\\eta(r_{ij}-R_s)^2) f_c(r_{ij})$，对截断范围内的邻居求和。\n- **指纹参数**：高斯中心 $R_s=1.0\\,\\mathrm{\\AA}$；宽度参数 $\\eta=4.0\\,\\mathrm{\\AA}^{-2}$。\n- **最终答案格式**：单一闭合形式的解析表达式，无量纲。\n\n**步骤2：使用提取的给定条件进行验证**\n- **科学基础**：该问题坚实地植根于计算材料科学和凝聚态物理。原子环境描述符或称指纹，如此处所述（其为一种 Behler-Parrinello 对称函数），是开发机器学习原子间势的基石。PBC、MIC 和平滑截断函数的概念是标准且根本上合理的。\n- **良构性**：该问题提供了所有必要的数据（原子位置、晶格参数、截断半径、函数参数）和清晰的定义，以唯一确定结果。其结构逻辑清晰，导向一个单一、可计算的答案。\n- **客观性**：问题陈述使用了精确、定量且无偏见的语言。没有主观或模糊的术语。\n- **一致性与可行性**：所提供的值对于一个模型原子系统是一致且物理上合理的。将 MIC 应用于给定的坐标和晶格矢量是一个标准的、无歧义的程序。不存在矛盾或不可行的条件。\n\n**步骤3：结论与行动**\n该问题是有效的。这是一个良构的、科学合理的练习，旨在应用多尺度建模的基本概念。现在开始求解过程。\n\n### 求解推导\n\n解法按照问题陈述中概述的三个部分展开。\n\n**第1部分：邻居列表和原子间距**\n中心原子 $i$ 位于原点 $\\mathbf{r}_i = (0,0,0)$。模拟晶胞是由正交晶格矢量定义的立方体，边长 $L = 3.0\\,\\mathrm{\\AA}$。到位于位置 $\\mathbf{r}_j$ 的任何其他原子 $j$ 的距离必须使用最小镜像约定计算。位移矢量为 $\\mathbf{d}_{ij} = \\mathbf{r}_j - \\mathbf{r}_i = \\mathbf{r}_j$。最小镜像位移矢量 $\\mathbf{d}_{ij}^{\\text{mic}}$ 的分量为 $d_k^{\\text{mic}} = d_k - L \\cdot \\text{nint}(d_k / L)$，其中 $k \\in \\{x,y,z\\}$，$\\text{nint}(\\cdot)$ 是最近整数函数。距离则为 $r_{ij} = ||\\mathbf{d}_{ij}^{\\text{mic}}||$。\n\n- **位于 $(1.0, 0, 0)\\,\\mathrm{\\AA}$ 的原子**：\n  - 位移为 $\\mathbf{d} = (1.0, 0, 0)$。\n  - $d_x^{\\text{mic}} = 1.0 - 3.0 \\cdot \\text{nint}(1.0/3.0) = 1.0 - 3.0 \\cdot 0 = 1.0$。\n  - 最小镜像距离为 $r_{ij} = \\sqrt{1.0^2} = 1.0\\,\\mathrm{\\AA}$。由于 $1.0 \\le r_c = 2.0$，这是一个邻居。\n\n- **位于 $(0, 1.2, 0)\\,\\mathrm{\\AA}$ 的原子**：\n  - 位移为 $\\mathbf{d} = (0, 1.2, 0)$。\n  - $d_y^{\\text{mic}} = 1.2 - 3.0 \\cdot \\text{nint}(1.2/3.0) = 1.2 - 3.0 \\cdot 0 = 1.2$。\n  - 最小镜像距离为 $r_{ij} = \\sqrt{1.2^2} = 1.2\\,\\mathrm{\\AA}$。由于 $1.2 \\le r_c$，这是一个邻居。\n\n- **位于 $(0, 0, 1.8)\\,\\mathrm{\\AA}$ 的原子**：\n  - 位移为 $\\mathbf{d} = (0, 0, 1.8)$。\n  - $d_z^{\\text{mic}} = 1.8 - 3.0 \\cdot \\text{nint}(1.8/3.0) = 1.8 - 3.0 \\cdot 1 = -1.2$。\n  - 最小镜像距离为 $r_{ij} = \\sqrt{(-1.2)^2} = 1.2\\,\\mathrm{\\AA}$。由于 $1.2 \\le r_c$，这是一个邻居。\n\n- **位于 $(2.5, 0, 0)\\,\\mathrm{\\AA}$ 的原子**：\n  - 位移为 $\\mathbf{d} = (2.5, 0, 0)$。\n  - $d_x^{\\text{mic}} = 2.5 - 3.0 \\cdot \\text{nint}(2.5/3.0) = 2.5 - 3.0 \\cdot 1 = -0.5$。\n  - 最小镜像距离为 $r_{ij} = \\sqrt{(-0.5)^2} = 0.5\\,\\mathrm{\\AA}$。由于 $0.5 \\le r_c$，这是一个邻居。\n\n所有四个原子（或其最近的周期性镜像）都在截断半径 $r_c = 2.0\\,\\mathrm{\\AA}$ 内。对指纹有贡献的原子间距列表为 $\\{0.5, 1.0, 1.2, 1.2\\}\\,\\mathrm{\\AA}$。不同的距离为 $0.5\\,\\mathrm{\\AA}$、$1.0\\,\\mathrm{\\AA}$ 和 $1.2\\,\\mathrm{\\AA}$。\n\n**第2部分：截断函数的推导**\n我们需要一个在 $[0, r_c]$ 上的平滑函数 $f_c(r)$，满足边界条件 $f_c(0)=1$、$f_c(r_c)=0$、$f_c'(0)=0$ 和 $f_c'(r_c)=0$。一个满足这些要求的标准函数是基于余弦变换的。对于 $r \\in [0, r_c]$，我们定义：\n$$ f_c(r) = \\frac{1}{2} \\left( \\cos\\left(\\frac{\\pi r}{r_c}\\right) + 1 \\right) $$\n对于 $r > r_c$，$f_c(r) = 0$。让我们用 $r_c = 2.0\\,\\mathrm{\\AA}$ 来验证这些条件：\n- $f_c(0) = \\frac{1}{2} (\\cos(0) + 1) = \\frac{1}{2}(1+1) = 1$。\n- $f_c(r_c) = f_c(2.0) = \\frac{1}{2} (\\cos(\\pi) + 1) = \\frac{1}{2}(-1+1) = 0$。\n- 一阶导数为 $f_c'(r) = \\frac{d}{dr} \\left[ \\frac{1}{2} \\cos\\left(\\frac{\\pi r}{r_c}\\right) + \\frac{1}{2} \\right] = -\\frac{\\pi}{2r_c} \\sin\\left(\\frac{\\pi r}{r_c}\\right)$。\n- $f_c'(0) = -\\frac{\\pi}{2r_c} \\sin(0) = 0$。\n- $f_c'(r_c) = -\\frac{\\pi}{2r_c} \\sin(\\pi) = 0$。\n该函数在其定义域上也是非负的。因此，这个函数是应使用的正确截断函数。对于本问题，$f_c(r) = \\frac{1}{2} \\left( \\cos\\left(\\frac{\\pi r}{2}\\right) + 1 \\right)$，其中 $r \\in [0, 2.0]$。\n\n**第3部分：径向指纹的计算**\n径向指纹 $G_i$ 是截断半径内所有邻居 $j$ 贡献的总和：\n$$ G_i = \\sum_{j, r_{ij} \\le r_c} \\exp(-\\eta(r_{ij}-R_s)^2) f_c(r_{ij}) $$\n我们使用参数 $R_s = 1.0\\,\\mathrm{\\AA}$、$\\eta = 4.0\\,\\mathrm{\\AA}^{-2}$ 以及四个邻居距离 $\\{0.5, 1.0, 1.2, 1.2\\}\\,\\mathrm{\\AA}$。\n\n- **来自 $r=0.5\\,\\mathrm{\\AA}$ 的邻居的贡献**：\n  - 高斯权重：$\\exp(-4.0(0.5-1.0)^2) = \\exp(-4.0(-0.5)^2) = \\exp(-1)$。\n  - 截断值：$f_c(0.5) = \\frac{1}{2}(\\cos(\\frac{\\pi \\cdot 0.5}{2}) + 1) = \\frac{1}{2}(\\cos(\\frac{\\pi}{4}) + 1) = \\frac{1}{2}(\\frac{\\sqrt{2}}{2} + 1) = \\frac{2+\\sqrt{2}}{4}$。\n  - 贡献：$\\exp(-1) \\frac{2+\\sqrt{2}}{4}$。\n\n- **来自 $r=1.0\\,\\mathrm{\\AA}$ 的邻居的贡献**：\n  - 高斯权重：$\\exp(-4.0(1.0-1.0)^2) = \\exp(0) = 1$。\n  - 截断值：$f_c(1.0) = \\frac{1}{2}(\\cos(\\frac{\\pi \\cdot 1.0}{2}) + 1) = \\frac{1}{2}(\\cos(\\frac{\\pi}{2}) + 1) = \\frac{1}{2}(0+1) = \\frac{1}{2}$。\n  - 贡献：$1 \\cdot \\frac{1}{2} = \\frac{1}{2}$。\n\n- **来自两个 $r=1.2\\,\\mathrm{\\AA}$ 的邻居的贡献**：\n  - 单个邻居的高斯权重：$\\exp(-4.0(1.2-1.0)^2) = \\exp(-4.0(0.2)^2) = \\exp(-4.0 \\cdot 0.04) = \\exp(-0.16) = \\exp(-\\frac{4}{25})$。\n  - 截断值：$f_c(1.2) = \\frac{1}{2}(\\cos(\\frac{\\pi \\cdot 1.2}{2}) + 1) = \\frac{1}{2}(\\cos(0.6\\pi) + 1) = \\frac{1}{2}(\\cos(\\frac{3\\pi}{5}) + 1)$。\n  - $\\cos(\\frac{3\\pi}{5})$ 的精确值是 $\\frac{1-\\sqrt{5}}{4}$。\n  - 截断值：$f_c(1.2) = \\frac{1}{2}(\\frac{1-\\sqrt{5}}{4} + 1) = \\frac{1}{2}(\\frac{1-\\sqrt{5}+4}{4}) = \\frac{5-\\sqrt{5}}{8}$。\n  - 来自这两个相同邻居的总贡献：$2 \\cdot \\exp(-\\frac{4}{25}) \\cdot \\frac{5-\\sqrt{5}}{8} = \\exp(-\\frac{4}{25}) \\frac{5-\\sqrt{5}}{4}$。\n\n总指纹值 $G_i$ 是这些贡献的总和：\n$$ G_i = \\exp(-1) \\frac{2+\\sqrt{2}}{4} + \\frac{1}{2} + \\exp(-\\frac{4}{25}) \\frac{5-\\sqrt{5}}{4} $$\n为了将其表示为单一表达式，我们找到一个共同的分母：\n$$ G_i = \\frac{\\exp(-1)(2+\\sqrt{2}) + 2 + \\exp(-\\frac{4}{25})(5-\\sqrt{5})}{4} $$\n$$ G_i = \\frac{1}{4} \\left( \\exp(-1)(2+\\sqrt{2}) + 2 + \\exp\\left(-\\frac{4}{25}\\right)(5-\\sqrt{5}) \\right) $$\n这就是指纹的最终闭合形式解析表达式。",
            "answer": "$$ \\boxed{\\frac{1}{4} \\left( \\exp(-1)(2+\\sqrt{2}) + 2 + \\exp\\left(-\\frac{4}{25}\\right)(5-\\sqrt{5}) \\right)} $$"
        },
        {
            "introduction": "在为分子动力学模拟构建机器学习势时，描述符的设计选择直接影响到物理模型的质量。一个关键要求是能量面对原子坐标是平滑可微的，以确保计算出的力是连续且物理上合理的。本练习通过一个思想实验，揭示了使用不连续（或“尖锐”）的截止函数会如何导致力在截止半径处产生非物理性的跳变，从而强调了平滑函数在特征工程中的重要性 。",
            "id": "3757502",
            "problem": "在原子间势的原子尺度特征工程中，一种常见描述中心原子环境的径向描述符依赖于邻近原子的间距，并使用截断来使贡献局部化。考虑单个原子对间距 $r$ 通过 $s(r) = g(r)\\,c(r)$ 对一个标量描述符有贡献，其中 $g(r)$ 是 $(0,\\infty)$ 上的一个 $C^{1}$ 类光滑函数，而 $c(r)$ 是一个由亥维赛德阶跃函数 $c(r) = H(r_{c}-r)$ 给出的不连续指示截断函数，其截断半径 $r_{c} > 0$ 为有限值。假设一个简单的学习目标通过对偶能量来惩罚描述符的大小\n$$\nE(r) = \\frac{\\kappa}{2}\\,s(r)^{2},\n$$\n其刚度为 $\\kappa > 0$，因此根据功能原理和机械力的定义，径向力遵循 $F_{r}(r) = -\\frac{dE}{dr}$。仅使用基本关系式，即 $F_{r}(r) = -\\frac{dE}{dr}$ 和狄拉克 $\\delta$ 分布 $\\delta(x)$ 的分布恒等式 $\\frac{d}{dx}H(x) = \\delta(x)$，推导 $F_{r}(r)$ 的分布值表达式，然后计算径向力经典部分在截断点 $r = r_{c}$ 处的跳跃间断，其定义为\n$$\n\\Delta F_{r} \\equiv \\lim_{\\epsilon \\to 0^{+}} \\Big(F_{r}(r_{c}-\\epsilon) - F_{r}(r_{c}+\\epsilon)\\Big),\n$$\n其中极限是在经典意义上理解的，即忽略在 $r = r_{c}$ 处的奇异 $\\delta$-分布项。用 $\\kappa$、$g(r_{c})$ 和 $g'(r_{c})$ 以闭合形式表示 $\\Delta F_{r}$ 的最终答案。不需要进行数值计算，最终答案中也不应包含单位。最终答案必须是单一的解析表达式。",
            "solution": "该问题要求从给定的对偶能量 $E(r)$ 推导径向力 $F_{r}(r)$，并随后计算其经典部分在截断半径 $r_{c}$ 处的跳跃间断。\n\n对偶能量由下式给出\n$$\nE(r) = \\frac{\\kappa}{2}\\,s(r)^{2}\n$$\n其中 $\\kappa > 0$ 是一个刚度常数，$s(r)$ 是一个标量描述符。该描述符定义为一个 $C^{1}$ 类光滑函数 $g(r)$ 与一个不连续指示截断函数 $c(r) = H(r_{c}-r)$ 的乘积，其中 $H$ 是亥维赛德阶跃函数，$r_c > 0$ 是截断半径。\n将 $s(r)$ 的表达式代入能量方程，我们得到：\n$$\nE(r) = \\frac{\\kappa}{2}\\,\\Big(g(r)\\,H(r_{c}-r)\\Big)^{2} = \\frac{\\kappa}{2}\\,g(r)^{2}\\,H(r_{c}-r)^{2}\n$$\n亥维赛德阶跃函数在乘法下是幂等的，即对于任何整数 $n \\geq 1$，$H(x)^{n} = H(x)$，因为它的值要么是 $0$ 要么是 $1$。因此，$H(r_{c}-r)^{2} = H(r_{c}-r)$。能量表达式简化为：\n$$\nE(r) = \\frac{\\kappa}{2}\\,g(r)^{2}\\,H(r_{c}-r)\n$$\n径向力 $F_{r}(r)$ 定义为势能的负梯度：\n$$\nF_{r}(r) = -\\frac{dE}{dr} = -\\frac{d}{dr}\\left(\\frac{\\kappa}{2}\\,g(r)^{2}\\,H(r_{c}-r)\\right)\n$$\n为了进行微分，我们必须使用分布导数的乘法法则，因为我们正在对一个光滑函数 $g(r)^2$ 和一个分布 $H(r_c-r)$ 的乘积求导。乘法法则表明 $(uv)' = u'v + uv'$，其中导数是在分布意义下求得的。令 $u(r) = g(r)^{2}$ 和 $v(r) = H(r_{c}-r)$。\n\n首先，我们求 $u(r)$ 和 $v(r)$ 的导数。由于 $g(r)$ 是 $C^{1}$ 类函数，其导数 $g'(r)$ 是连续的。$u(r) = g(r)^{2}$ 的导数使用链式法则求得：\n$$\n\\frac{du}{dr} = \\frac{d}{dr}\\left(g(r)^{2}\\right) = 2\\,g(r)\\,g'(r)\n$$\n接下来，我们求 $v(r) = H(r_{c}-r)$ 的导数。使用给定的恒等式 $\\frac{d}{dx}H(x) = \\delta(x)$ 和链式法则，令自变量为 $x = r_{c}-r$，我们有 $\\frac{dx}{dr} = -1$。\n$$\n\\frac{dv}{dr} = \\frac{d}{dr}H(r_{c}-r) = \\frac{dH(r_{c}-r)}{d(r_{c}-r)} \\frac{d(r_{c}-r)}{dr} = \\delta(r_{c}-r) \\cdot (-1) = -\\delta(r_c-r)\n$$\n由于狄拉克 $\\delta$ 分布是偶函数，即 $\\delta(x) = \\delta(-x)$，我们有 $\\delta(r_{c}-r) = \\delta(r-r_{c})$。所以，\n$$\n\\frac{dv}{dr} = -\\delta(r-r_{c})\n$$\n应用乘法法则求 $\\frac{dE}{dr}$：\n$$\n\\frac{dE}{dr} = \\frac{\\kappa}{2} \\left[ \\left(\\frac{d}{dr}g(r)^{2}\\right) H(r_{c}-r) + g(r)^{2} \\left(\\frac{d}{dr}H(r_{c}-r)\\right) \\right]\n$$\n$$\n\\frac{dE}{dr} = \\frac{\\kappa}{2} \\left[ 2\\,g(r)\\,g'(r)\\,H(r_{c}-r) - g(r)^{2}\\,\\delta(r-r_{c}) \\right]\n$$\n力是 $F_{r}(r) = - \\frac{dE}{dr}$：\n$$\nF_{r}(r) = -\\kappa\\,g(r)\\,g'(r)\\,H(r_{c}-r) + \\frac{\\kappa}{2}\\,g(r)^{2}\\,\\delta(r-r_{c})\n$$\n利用 $\\delta$ 分布的筛选性质，即对于在 $x=a$ 处连续的函数 $f(x)$，有 $f(x)\\delta(x-a) = f(a)\\delta(x-a)$，我们在包含 $\\delta$ 分布的项中用 $g(r_{c})^{2}$ 替换 $g(r)^{2}$：\n$$\nF_{r}(r) = -\\kappa\\,g(r)\\,g'(r)\\,H(r_{c}-r) + \\frac{\\kappa}{2}\\,g(r_{c})^{2}\\,\\delta(r-r_{c})\n$$\n这是力的完整分布值表达式。\n\n问题要求在 $r=r_c$ 处力的经典部分的跳跃间断。经典部分，我们记为 $F_{r, \\text{cl}}(r)$，是表达式中不包含奇异 $\\delta$-分布的部分：\n$$\nF_{r, \\text{cl}}(r) = -\\kappa\\,g(r)\\,g'(r)\\,H(r_{c}-r)\n$$\n跳跃间断定义为 $\\Delta F_{r} \\equiv \\lim_{\\epsilon \\to 0^{+}} \\Big(F_{r, \\text{cl}}(r_{c}-\\epsilon) - F_{r, \\text{cl}}(r_{c}+\\epsilon)\\Big)$。\n\n我们分别计算这两个极限。\n首先，对于从下方逼近的极限 ($r \\to r_{c}^{-}$)：\n令 $r = r_{c}-\\epsilon$，其中 $\\epsilon > 0$。当 $\\epsilon \\to 0^{+}$ 时，$r \\to r_{c}^{-}$。\n亥维赛德函数的自变量为 $r_{c}-r = r_{c}-(r_{c}-\\epsilon) = \\epsilon > 0$。因此，$H(r_{c}-r) = 1$。\n$$\n\\lim_{\\epsilon \\to 0^{+}} F_{r, \\text{cl}}(r_{c}-\\epsilon) = \\lim_{\\epsilon \\to 0^{+}} \\Big(-\\kappa\\,g(r_{c}-\\epsilon)\\,g'(r_{c}-\\epsilon) \\cdot 1\\Big)\n$$\n由于 $g(r)$ 是 $C^{1}$ 类函数，所以 $g(r)$ 和 $g'(r)$ 都是连续的。因此，极限为：\n$$\n-\\kappa\\,g(r_{c})\\,g'(r_{c})\n$$\n其次，对于从上方逼近的极限 ($r \\to r_{c}^{+}$)：\n令 $r = r_{c}+\\epsilon$，其中 $\\epsilon > 0$。当 $\\epsilon \\to 0^{+}$ 时，$r \\to r_{c}^{+}$。\n亥维赛德函数的自变量为 $r_{c}-r = r_{c}-(r_{c}+\\epsilon) = -\\epsilon  0$。因此，$H(r_{c}-r) = 0$。\n$$\n\\lim_{\\epsilon \\to 0^{+}} F_{r, \\text{cl}}(r_{c}+\\epsilon) = \\lim_{\\epsilon \\to 0^{+}} \\Big(-\\kappa\\,g(r_{c}+\\epsilon)\\,g'(r_{c}+\\epsilon) \\cdot 0\\Big) = 0\n$$\n最后，我们通过从第一个极限中减去第二个极限来计算跳跃 $\\Delta F_{r}$：\n$$\n\\Delta F_{r} = \\Big(-\\kappa\\,g(r_{c})\\,g'(r_{c})\\Big) - (0) = -\\kappa\\,g(r_{c})\\,g'(r_{c})\n$$\n这就是在截断点处径向力经典部分的跳跃间断的闭合形式表达式。",
            "answer": "$$\n\\boxed{-\\kappa\\,g(r_{c})\\,g'(r_{c})}\n$$"
        },
        {
            "introduction": "一个理想的描述符应该能够唯一地表示一个原子环境，但简单的描述符往往会丢失关键的几何信息。本练习通过一个巧妙的例子，挑战了径向分布函数（RDF）或其离散化的直方图等仅基于二体（配对）距离的描述符的完备性。您将通过计算证明，两个截然不同的三维原子构型可以产生完全相同的配对距离直方图，从而深刻理解高阶（三体及以上）相关性在区分复杂结构时的必要性 。",
            "id": "3757533",
            "problem": "在多尺度建模和分析中，一个常见的原子环境描述符是径向分布函数（RDF），它通常通过对距直方图来近似，该直方图统计有多少原子间距落入预设的区间内。考虑以下基于对距直方图的描述符的上下文。设区间边界由以下半开区间指定：\n$$\\mathcal{B}_{1} = [1.5, 2.5),\\quad \\mathcal{B}_{2} = [2.5, 3.5),\\quad \\mathcal{B}_{3} = [3.5, 4.5),\\quad \\mathcal{B}_{4} = [4.5, 5.5).$$\n给定两个原子环境，每个环境由三维欧几里得空间中的四个原子组成，其笛卡尔坐标以埃为单位描述。第一个环境是\n$$\\mathcal{E}_{A} = \\{ \\mathbf{a}_{0}, \\mathbf{a}_{1}, \\mathbf{a}_{2}, \\mathbf{a}_{3} \\},\\quad \\mathbf{a}_{0} = (0, 0, 0),\\ \\mathbf{a}_{1} = (2, 0, 0),\\ \\mathbf{a}_{2} = (0, 3, 0),\\ \\mathbf{a}_{3} = (0, 0, 4).$$\n第二个环境是\n$$\\mathcal{E}_{B} = \\{ \\mathbf{b}_{0}, \\mathbf{b}_{1}, \\mathbf{b}_{2}, \\mathbf{b}_{3} \\},\\quad \\mathbf{b}_{0} = (0, 0, 0),\\ \\mathbf{b}_{1} = (2, 0, 0),\\ \\mathbf{b}_{2} = (0, 0, 3),$$\n且 $$\\mathbf{b}_{3} = (x, y, z)$$ 的选择使得其距离满足\n$$\\|\\mathbf{b}_{3} - \\mathbf{b}_{0}\\| = 4.9,\\quad \\|\\mathbf{b}_{3} - \\mathbf{b}_{1}\\| = 4.0,\\quad \\|\\mathbf{b}_{3} - \\mathbf{b}_{2}\\| = 3.7,$$\n其中 $\\|\\cdot\\|$ 表示欧几里得范数。假设 $\\mathbf{b}_{3}$ 的笛卡尔坐标为 $x = \\frac{24.01 + 4 - 16}{4}$ 和 $z = \\frac{24.01 + 9 - 13.69}{6}$，并且 $y$ 的选择恰好满足上述三个距离约束。\n\n任务：\n1. 仅使用欧几里得距离的定义和直方图区间 $\\mathcal{B}_{1}, \\mathcal{B}_{2}, \\mathcal{B}_{3}, \\mathcal{B}_{4}$，计算 $\\mathcal{E}_{A}$ 和 $\\mathcal{E}_{B}$ 的对距，并统计每个区间中的计数。证明这两个环境共享相同的对距直方图。\n2. 从顶点为 $\\mathbf{p}_{0}, \\mathbf{p}_{1}, \\mathbf{p}_{2}, \\mathbf{p}_{3}$ 的四面体体积的几何定义出发，\n$$V = \\frac{1}{6}\\left|(\\mathbf{p}_{1} - \\mathbf{p}_{0}) \\cdot \\left((\\mathbf{p}_{2} - \\mathbf{p}_{0}) \\times (\\mathbf{p}_{3} - \\mathbf{p}_{0})\\right)\\right|,$$\n分别推导出由 $\\mathcal{E}_{A}$ 和 $\\mathcal{E}_{B}$ 决定的四面体体积 $V_{A}$ 和 $V_{B}$。\n3. 利用基本定义以及第1部分和第2部分的结果，解释为什么对距直方图不是原子环境的唯一描述符。你的解释应提及区间划分引入的信息损失以及直方图的无标记性质。\n4. 计算量\n$$\\Delta V = V_{A} - V_{B},$$\n并提供其数值。将你的答案四舍五入到四位有效数字。最终答案以立方埃为单位表示。\n\n你的最终回答必须是一个等于 $\\Delta V$ 的实数，并按要求四舍五入。最终的方框答案中不要包含单位。",
            "solution": "该问题陈述已经过严格验证，被认为是科学上可靠、适定、客观且内部一致的。唯一解所需的所有数据和定义均已提供。该问题是计算材料科学中的一个有效练习，特别关注原子环境描述符的性质。因此，我们可以着手求解。\n\n该问题要求进行多步分析，比较两个四原子环境 $\\mathcal{E}_{A}$ 和 $\\mathcal{E}_{B}$，以证明对距直方图作为结构描述符的非唯一性。\n\n**任务1：对距直方图**\n\n首先，我们计算每个环境的所有对距集合。对于一个包含4个原子的系统，有 $\\binom{4}{2} = 6$ 个唯一的对距。\n\n对于环境 $\\mathcal{E}_{A} = \\{ \\mathbf{a}_{0}, \\mathbf{a}_{1}, \\mathbf{a}_{2}, \\mathbf{a}_{3} \\}$，坐标为 $\\mathbf{a}_{0} = (0, 0, 0)$、$\\mathbf{a}_{1} = (2, 0, 0)$、$\\mathbf{a}_{2} = (0, 3, 0)$ 和 $\\mathbf{a}_{3} = (0, 0, 4)$（单位：埃）：\n对距 $d_{ij} = \\|\\mathbf{a}_j - \\mathbf{a}_i\\|$ 为：\n$d_{01} = \\|\\mathbf{a}_{1} - \\mathbf{a}_{0}\\| = \\|(2, 0, 0)\\| = \\sqrt{2^2} = 2$。\n$d_{02} = \\|\\mathbf{a}_{2} - \\mathbf{a}_{0}\\| = \\|(0, 3, 0)\\| = \\sqrt{3^2} = 3$。\n$d_{03} = \\|\\mathbf{a}_{3} - \\mathbf{a}_{0}\\| = \\|(0, 0, 4)\\| = \\sqrt{4^2} = 4$。\n$d_{12} = \\|\\mathbf{a}_{2} - \\mathbf{a}_{1}\\| = \\|(-2, 3, 0)\\| = \\sqrt{(-2)^2 + 3^2 + 0^2} = \\sqrt{4 + 9} = \\sqrt{13}$。\n$d_{13} = \\|\\mathbf{a}_{3} - \\mathbf{a}_{1}\\| = \\|(-2, 0, 4)\\| = \\sqrt{(-2)^2 + 0^2 + 4^2} = \\sqrt{4 + 16} = \\sqrt{20}$。\n$d_{23} = \\|\\mathbf{a}_{3} - \\mathbf{a}_{2}\\| = \\|(0, -3, 4)\\| = \\sqrt{0^2 + (-3)^2 + 4^2} = \\sqrt{9 + 16} = \\sqrt{25} = 5$。\n\n$\\mathcal{E}_{A}$ 的距离集合为 $\\{2, 3, 4, \\sqrt{13}, \\sqrt{20}, 5\\}$。数值上，它们约等于 $\\{2.0, 3.0, 4.0, 3.606, 4.472, 5.0\\}$。\n使用给定的区间 $\\mathcal{B}_{1} = [1.5, 2.5)$、$\\mathcal{B}_{2} = [2.5, 3.5)$、$\\mathcal{B}_{3} = [3.5, 4.5)$、$\\mathcal{B}_{4} = [4.5, 5.5)$：\n- $d_{01}=2.0 \\in \\mathcal{B}_{1}$\n- $d_{02}=3.0 \\in \\mathcal{B}_{2}$\n- $d_{12} \\approx 3.606 \\in \\mathcal{B}_{3}$\n- $d_{03}=4.0 \\in \\mathcal{B}_{3}$\n- $d_{13} \\approx 4.472 \\in \\mathcal{B}_{3}$\n- $d_{23}=5.0 \\in \\mathcal{B}_{4}$\n$\\mathcal{E}_{A}$ 的直方图（记为 $H_A$）是各区间 $(\\mathcal{B}_{1}, \\mathcal{B}_{2}, \\mathcal{B}_{3}, \\mathcal{B}_{4})$ 中计数的向量，即 $(1, 1, 3, 1)$。\n\n对于环境 $\\mathcal{E}_{B} = \\{ \\mathbf{b}_{0}, \\mathbf{b}_{1}, \\mathbf{b}_{2}, \\mathbf{b}_{3} \\}$，坐标为 $\\mathbf{b}_{0} = (0, 0, 0)$、$\\mathbf{b}_{1} = (2, 0, 0)$、$\\mathbf{b}_{2} = (0, 0, 3)$，而 $\\mathbf{b}_{3}$ 由距离约束定义：\n固定的距离是：\n$d_{01} = \\|\\mathbf{b}_{1} - \\mathbf{b}_{0}\\| = \\|(2, 0, 0)\\| = 2$。\n$d_{02} = \\|\\mathbf{b}_{2} - \\mathbf{b}_{0}\\| = \\|(0, 0, 3)\\| = 3$。\n$d_{12} = \\|\\mathbf{b}_{2} - \\mathbf{b}_{1}\\| = \\|(-2, 0, 3)\\| = \\sqrt{(-2)^2 + 0^2 + 3^2} = \\sqrt{4+9} = \\sqrt{13}$。\n涉及 $\\mathbf{b}_3$ 的其余距离在问题陈述中已明确给出：\n$d_{03} = \\|\\mathbf{b}_{3} - \\mathbf{b}_{0}\\| = 4.9$。\n$d_{13} = \\|\\mathbf{b}_{3} - \\mathbf{b}_{1}\\| = 4.0$。\n$d_{23} = \\|\\mathbf{b}_{3} - \\mathbf{b}_{2}\\| = 3.7$。\n\n$\\mathcal{E}_{B}$ 的距离集合为 $\\{2, 3, \\sqrt{13}, 4.9, 4.0, 3.7\\}$。数值上，它们约等于 $\\{2.0, 3.0, 3.606, 4.9, 4.0, 3.7\\}$。\n使用相同的区间：\n- $d_{01}=2.0 \\in \\mathcal{B}_{1}$\n- $d_{02}=3.0 \\in \\mathcal{B}_{2}$\n- $d_{12} \\approx 3.606 \\in \\mathcal{B}_{3}$\n- $d_{23}=3.7 \\in \\mathcal{B}_{3}$\n- $d_{13}=4.0 \\in \\mathcal{B}_{3}$\n- $d_{03}=4.9 \\in \\mathcal{B}_{4}$\n$\\mathcal{E}_{B}$ 的直方图（记为 $H_B$）是计数向量 $(1, 1, 3, 1)$。\n\n因此，我们证明了 $H_A = H_B = (1, 1, 3, 1)$。这两个环境共享相同的对距直方图。\n\n**任务2：四面体体积**\n\n顶点为 $\\mathbf{p}_{0}, \\mathbf{p}_{1}, \\mathbf{p}_{2}, \\mathbf{p}_{3}$ 的四面体体积由以下公式给出：\n$$V = \\frac{1}{6}\\left|(\\mathbf{p}_{1} - \\mathbf{p}_{0}) \\cdot \\left((\\mathbf{p}_{2} - \\mathbf{p}_{0}) \\times (\\mathbf{p}_{3} - \\mathbf{p}_{0})\\right)\\right|$$\n这等价于从一个共同顶点出发的三个边向量所构成矩阵的行列式绝对值的 $\\frac{1}{6}$。\n\n对于环境 $\\mathcal{E}_{A}$，我们选择 $\\mathbf{p}_{0} = \\mathbf{a}_{0} = (0, 0, 0)$。边向量为：\n$\\mathbf{v}_{1} = \\mathbf{a}_{1} - \\mathbf{a}_{0} = (2, 0, 0)$\n$\\mathbf{v}_{2} = \\mathbf{a}_{2} - \\mathbf{a}_{0} = (0, 3, 0)$\n$\\mathbf{v}_{3} = \\mathbf{a}_{3} - \\mathbf{a}_{0} = (0, 0, 4)$\n体积 $V_{A}$ 是：\n$$V_{A} = \\frac{1}{6} \\left| \\det \\begin{pmatrix} 2  0  0 \\\\ 0  3  0 \\\\ 0  0  4 \\end{pmatrix} \\right| = \\frac{1}{6} |2(3 \\cdot 4 - 0 \\cdot 0)| = \\frac{1}{6} |24| = 4$$\n所以，$V_{A} = 4$ 立方埃。\n\n对于环境 $\\mathcal{E}_{B}$，我们首先确定 $\\mathbf{b}_{3}$ 的坐标 $(x,y,z)$。问题提供了公式：\n$x = \\frac{24.01 + 4 - 16}{4} = \\frac{12.01}{4} = 3.0025$。\n$z = \\frac{24.01 + 9 - 13.69}{6} = \\frac{19.32}{6} = 3.22$。\n为了找到 $y$，我们使用约束 $\\|\\mathbf{b}_{3} - \\mathbf{b}_{0}\\|^2 = 4.9^2$：\n$x^2 + y^2 + z^2 = 24.01$\n$y^2 = 24.01 - x^2 - z^2 = 24.01 - (3.0025)^2 - (3.22)^2$\n$y^2 = 24.01 - 9.01500625 - 10.3684 = 4.62659375$。\n存在 $y$ 的实数解：$y = \\pm \\sqrt{4.62659375}$。体积计算取决于 $|y|$，所以符号无关紧要。我们选择 $\\mathbf{p}_{0} = \\mathbf{b}_{0} = (0, 0, 0)$。边向量为：\n$\\mathbf{u}_{1} = \\mathbf{b}_{1} - \\mathbf{b}_{0} = (2, 0, 0)$\n$\\mathbf{u}_{2} = \\mathbf{b}_{2} - \\mathbf{b}_{0} = (0, 0, 3)$\n$\\mathbf{u}_{3} = \\mathbf{b}_{3} - \\mathbf{b}_{0} = (x, y, z) = (3.0025, y, 3.22)$\n体积 $V_{B}$ 是：\n$$V_{B} = \\frac{1}{6} \\left| \\det \\begin{pmatrix} 2  0  0 \\\\ 0  0  3 \\\\ x  y  z \\end{pmatrix} \\right| = \\frac{1}{6} |2(0 \\cdot z - 3 \\cdot y)| = \\frac{1}{6} |-6y| = |y|$$\n代入 $|y|$ 的值：\n$V_{B} = \\sqrt{4.62659375} \\approx 2.1509518$ 立方埃。\n\n**任务3：非唯一性的解释**\n\n对距直方图不是原子环境的唯一描述符。这根本上是因为它代表了对完整几何信息的有损压缩。我们的计算提供了一个具体的例子。\n1. 两个环境 $\\mathcal{E}_{A}$ 和 $\\mathcal{E}_{B}$ 在结构上是不同的。一个明确的证据是它们的四面体体积不同：$V_{A} = 4$ 和 $V_{B} \\approx 2.15$。由于体积是一个几何不变量，不同的体积意味着不同的几何形状。\n2. 尽管它们的结构不同，我们已经证明它们的对距直方图是相同的：$H_A = H_B = (1, 1, 3, 1)$。\n3. 结论是不可避免的：既然两种不同的结构映射到同一个描述符，那么这个描述符就不是唯一的。\n\n这种唯一性的缺乏源于两个主要的信息损失来源：\n- **区间划分 (Binning)：** 直方图用宽泛范围内的计数取代了精确的距离值。例如，在区间 $\\mathcal{B}_{3}$ 中，$\\mathcal{E}_{A}$ 的距离为 $\\{4, \\sqrt{13}, \\sqrt{20}\\}$，而 $\\mathcal{E}_{B}$ 的距离为 $\\{\\sqrt{13}, 3.7, 4.0\\}$。区间划分的行为掩盖了底层距离集合不同的事实。\n- **投影到二体信息：** 直方图是一个二体描述符，因为它只考虑原子对。它丢弃了所有更高阶的相关性，例如键之间的角度或结构内的二面角。四面体的体积是一个四体性质，取决于所有四个原子的精确三维排列。直方图对这类信息是“盲目”的，而这些信息对于唯一定义几何结构至关重要。\n\n**任务4：$\\Delta V$ 的计算**\n\n我们被要求计算 $\\Delta V = V_{A} - V_{B}$ 并四舍五入到四位有效数字。\n$V_{A} = 4$。\n$V_{B} = \\sqrt{4.62659375}$。\n$\\Delta V = 4 - \\sqrt{4.62659375}$。\n$\\Delta V \\approx 4 - 2.150951825...$\n$\\Delta V \\approx 1.849048174...$\n\n四舍五入到四位有效数字得到 $1.849$。",
            "answer": "$$\\boxed{1.849}$$"
        }
    ]
}