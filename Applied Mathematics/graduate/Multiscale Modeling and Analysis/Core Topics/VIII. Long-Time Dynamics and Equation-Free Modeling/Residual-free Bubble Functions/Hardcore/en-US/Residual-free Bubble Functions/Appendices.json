{
    "hands_on_practices": [
        {
            "introduction": "To build a solid understanding of residual-free bubbles (RFBs), we begin with the most fundamental case: a one-dimensional advection-diffusion-reaction problem with constant coefficients. This exercise guides you through the process of deriving the bubble function from first principles by constructing the operator's local Green's function, $G_K$. By computing the bubble as a convolution of $G_K$ with a constant residual, you will gain direct insight into how the bubble is designed to locally invert the differential operator and annihilate the residual, forming the cornerstone of the RFB method .",
            "id": "3804185",
            "problem": "Consider the one-dimensional advection–diffusion–reaction operator with constant coefficients on the open element $K=(0,h)$,\n$$\n\\mathcal{L} u := -\\mu\\,\\frac{\\mathrm{d}^{2}u}{\\mathrm{d}x^{2}} + \\alpha\\,\\frac{\\mathrm{d}u}{\\mathrm{d}x} + \\gamma\\,u,\n$$\nwhere $\\mu>0$, $\\alpha\\in\\mathbb{R}$, and $\\gamma>0$. The Residual-Free Bubble (RFB) method seeks an element bubble $b_{K}$ that annihilates a given element residual $R$ by solving the local boundary value problem\n$$\n\\mathcal{L} b_{K} = R \\quad \\text{in } K, \\qquad b_{K}(0)=0, \\quad b_{K}(h)=0,\n$$\nwith $R$ constant on $K$. The element Green’s function $G_{K}(x,\\xi)$ for $\\mathcal{L}$ on $K$ is defined by\n$$\n\\mathcal{L}_{x} G_{K}(x,\\xi) = \\delta(x-\\xi), \\qquad G_{K}(0,\\xi)=0, \\quad G_{K}(h,\\xi)=0,\n$$\nwhere $\\delta$ is the Dirac distribution and $\\mathcal{L}_{x}$ indicates that $\\mathcal{L}$ acts with respect to the spatial variable $x$.\n\nStarting from the fundamental laws of linear differential operators and distribution theory, and using only the constant-coefficient structure of $\\mathcal{L}$, derive an explicit expression for the element Green’s function $G_{K}(x,\\xi)$. Then, define the RFB bubble as the convolution\n$$\nb_{K}(x) := \\int_{0}^{h} G_{K}(x,\\xi)\\,R\\,\\mathrm{d}\\xi,\n$$\nand validate it against the constant residual by proving it solves the local boundary value problem above. Finally, compute $b_{K}(x)$ in closed form. Express all exponential functions using $\\exp(\\cdot)$, and define any auxiliary quantities you introduce. If you require a piecewise representation, you may use the Heaviside step function $H(s)$ with the convention $H(s)=1$ for $s>0$ and $H(s)=0$ for $s\\le 0$.\n\nYour final answer must be a single analytical expression or, if multiple expressions are necessary, present them as a single row matrix using the $\\mathrm{pmatrix}$ environment. No numerical evaluation is required.",
            "solution": "We begin with the constant-coefficient second-order operator\n$$\n\\mathcal{L} u := -\\mu\\,u'' + \\alpha\\,u' + \\gamma\\,u,\n$$\nwith $\\mu>0$, $\\alpha\\in\\mathbb{R}$, and $\\gamma>0$ on $K=(0,h)$. The element Green’s function $G_{K}(x,\\xi)$ is defined to satisfy\n$$\n\\mathcal{L}_{x} G_{K}(x,\\xi) = \\delta(x-\\xi), \\qquad G_{K}(0,\\xi)=0, \\quad G_{K}(h,\\xi)=0.\n$$\nFor $x\\neq \\xi$, $G_{K}(\\cdot,\\xi)$ satisfies the homogeneous equation\n$$\n-\\mu\\,y'' + \\alpha\\,y' + \\gamma\\,y = 0,\n$$\nwhose characteristic equation is\n$$\n-\\mu r^{2} + \\alpha r + \\gamma = 0 \\quad \\Longleftrightarrow \\quad \\mu r^{2} - \\alpha r - \\gamma = 0.\n$$\nThe two distinct real roots (since $\\alpha^{2}+4\\mu\\gamma>0$) are\n$$\nr_{1} := \\frac{\\alpha + \\sqrt{\\alpha^{2}+4\\mu\\gamma}}{2\\mu}, \\qquad r_{2} := \\frac{\\alpha - \\sqrt{\\alpha^{2}+4\\mu\\gamma}}{2\\mu}.\n$$\nA convenient pair of homogeneous solutions that enforce the Dirichlet boundary conditions at the element endpoints are\n$$\n\\varphi(x) := \\exp(r_{1}x) - \\exp(r_{2}x), \\qquad \\psi(x) := \\exp(r_{1}x)\\exp(-r_{1}h) - \\exp(r_{2}x)\\exp(-r_{2}h),\n$$\nwhich satisfy $\\varphi(0)=0$ and $\\psi(h)=0$. The Green’s function is constructed piecewise by matching continuity and the jump condition in the first derivative at $x=\\xi$ implied by the Dirac distribution. Specifically, continuity requires\n$$\n\\lim_{x\\to \\xi^{-}}G_{K}(x,\\xi) = \\lim_{x\\to \\xi^{+}}G_{K}(x,\\xi),\n$$\nand integrating $\\mathcal{L}_{x}G_{K}(x,\\xi)=\\delta(x-\\xi)$ over a small interval around $\\xi$ yields the jump condition\n$$\n-\\mu\\left(\\frac{\\partial G_{K}}{\\partial x}(\\xi^{+},\\xi) - \\frac{\\partial G_{K}}{\\partial x}(\\xi^{-},\\xi)\\right) = 1.\n$$\nA standard construction in terms of $\\varphi$ and $\\psi$ gives\n$$\nG_{K}(x,\\xi) =\n\\begin{cases}\nA(\\xi)\\,\\varphi(x), & x<\\xi,\\\\\nB(\\xi)\\,\\psi(x), & x>\\xi,\n\\end{cases}\n$$\nwith $A(\\xi)$ and $B(\\xi)$ chosen to enforce continuity and the jump. Solving for $A(\\xi)$ and $B(\\xi)$ using the Wronskian at $x=\\xi$,\n$$\nW(\\varphi,\\psi)(\\xi) := \\varphi(\\xi)\\psi'(\\xi) - \\varphi'(\\xi)\\psi(\\xi),\n$$\nwe obtain\n$$\nA(\\xi) = -\\frac{\\psi(\\xi)}{\\mu\\,W(\\varphi,\\psi)(\\xi)}, \\qquad B(\\xi) = -\\frac{\\varphi(\\xi)}{\\mu\\,W(\\varphi,\\psi)(\\xi)}.\n$$\nWe compute $W(\\varphi,\\psi)(\\xi)$ explicitly. Denote $A_{1}:=\\exp(r_{1}\\xi)$ and $A_{2}:=\\exp(r_{2}\\xi)$ for brevity. Then\n$$\n\\varphi(\\xi) = A_{1}-A_{2}, \\quad \\varphi'(\\xi) = r_{1}A_{1} - r_{2}A_{2}, \\quad\n\\psi(\\xi) = A_{1}\\exp(-r_{1}h) - A_{2}\\exp(-r_{2}h), \\quad \\psi'(\\xi) = r_{1}A_{1}\\exp(-r_{1}h) - r_{2}A_{2}\\exp(-r_{2}h).\n$$\nA direct calculation gives\n$$\nW(\\varphi,\\psi)(\\xi) = (r_{1}-r_{2})\\,\\exp\\big((r_{1}+r_{2})\\,\\xi\\big)\\,\\big(\\exp(-r_{2}h) - \\exp(-r_{1}h)\\big).\n$$\nTherefore,\n$$\nG_{K}(x,\\xi) =\n-\\frac{1}{\\mu\\,(r_{1}-r_{2})\\,\\exp\\big((r_{1}+r_{2})\\,\\xi\\big)\\,\\big(\\exp(-r_{2}h) - \\exp(-r_{1}h)\\big)}\n\\begin{cases}\n\\psi(\\xi)\\,\\varphi(x), & x<\\xi,\\\\\n\\varphi(\\xi)\\,\\psi(x), & x>\\xi.\n\\end{cases}\n$$\nTo present $G_{K}$ as a single expression, we use the Heaviside step function $H(s)$, with $H(s)=1$ for $s>0$ and $H(s)=0$ otherwise:\n$$\nG_{K}(x,\\xi) =\n-\\frac{\\psi(\\xi)\\,\\varphi(x)\\,H(\\xi-x) + \\varphi(\\xi)\\,\\psi(x)\\,H(x-\\xi)}{\\mu\\,(r_{1}-r_{2})\\,\\exp\\big((r_{1}+r_{2})\\,\\xi\\big)\\,\\big(\\exp(-r_{2}h) - \\exp(-r_{1}h)\\big)}.\n$$\n\nWe now define the bubble via convolution with the constant residual $R$:\n$$\nb_{K}(x) := \\int_{0}^{h} G_{K}(x,\\xi)\\,R\\,\\mathrm{d}\\xi.\n$$\nValidation that $b_{K}$ solves the local problem follows directly from the defining properties of $G_{K}$. In the distributional sense,\n$$\n\\mathcal{L} b_{K}(x) = \\mathcal{L}\\int_{0}^{h} G_{K}(x,\\xi)\\,R\\,\\mathrm{d}\\xi = \\int_{0}^{h} \\mathcal{L}_{x} G_{K}(x,\\xi)\\,R\\,\\mathrm{d}\\xi = \\int_{0}^{h} \\delta(x-\\xi)\\,R\\,\\mathrm{d}\\xi = R,\n$$\nand since $G_{K}(0,\\xi)=G_{K}(h,\\xi)=0$ for all $\\xi$, we have $b_{K}(0)=b_{K}(h)=0$. Thus $b_{K}$ satisfies\n$$\n-\\mu\\,b_{K}'' + \\alpha\\,b_{K}' + \\gamma\\,b_{K} = R, \\qquad b_{K}(0)=b_{K}(h)=0.\n$$\nBecause $\\gamma>0$ and $\\mu>0$, the boundary value problem has a unique solution; hence the convoluted bubble is the unique bubble that annihilates the constant residual.\n\nWe now compute $b_{K}(x)$ in closed form by solving the ordinary differential equation directly. A particular solution for the constant right-hand side $R$ is $b_{p}(x)\\equiv R/\\gamma$. The general homogeneous solution is $b_{h}(x)=C_{1}\\exp(r_{1}x)+C_{2}\\exp(r_{2}x)$. Therefore\n$$\nb_{K}(x) = C_{1}\\exp(r_{1}x) + C_{2}\\exp(r_{2}x) + \\frac{R}{\\gamma}.\n$$\nImposing $b_{K}(0)=0$ and $b_{K}(h)=0$ yields\n$$\nC_{1}+C_{2} = -\\frac{R}{\\gamma}, \\qquad C_{1}\\exp(r_{1}h) + C_{2}\\exp(r_{2}h) = -\\frac{R}{\\gamma}.\n$$\nSolving these two linear equations for $C_{1}$ and $C_{2}$ gives\n$$\nC_{1} = \\frac{R}{\\gamma}\\,\\frac{\\exp(r_{2}h)-1}{\\exp(r_{1}h)-\\exp(r_{2}h)}, \\qquad\nC_{2} = \\frac{R}{\\gamma}\\,\\frac{1-\\exp(r_{1}h)}{\\exp(r_{1}h)-\\exp(r_{2}h)}.\n$$\nThus the closed-form bubble is\n$$\nb_{K}(x) = \\frac{R}{\\gamma}\\left[ 1 + \\frac{\\big(\\exp(r_{2}h)-1\\big)\\exp(r_{1}x) + \\big(1-\\exp(r_{1}h)\\big)\\exp(r_{2}x)}{\\exp(r_{1}h)-\\exp(r_{2}h)} \\right].\n$$\nBy uniqueness, this expression coincides with the convolution $b_{K}(x)=\\int_{0}^{h}G_{K}(x,\\xi)\\,R\\,\\mathrm{d}\\xi$. This completes the explicit computation of $G_{K}$ and the validation and closed-form computation of the residual-free bubble $b_{K}$ for a constant residual on $K=(0,h)$.",
            "answer": "$$\\boxed{\\begin{pmatrix}\n-\\dfrac{\\big(\\exp(r_{1}\\xi)\\exp(-r_{1}h)-\\exp(r_{2}\\xi)\\exp(-r_{2}h)\\big)\\big(\\exp(r_{1}x)-\\exp(r_{2}x)\\big)\\,H(\\xi-x)\\;+\\;\\big(\\exp(r_{1}\\xi)-\\exp(r_{2}\\xi)\\big)\\big(\\exp(r_{1}x)\\exp(-r_{1}h)-\\exp(r_{2}x)\\exp(-r_{2}h)\\big)\\,H(x-\\xi)}{\\mu\\,(r_{1}-r_{2})\\,\\exp\\big((r_{1}+r_{2})\\,\\xi\\big)\\,\\big(\\exp(-r_{2}h)-\\exp(-r_{1}h)\\big)} & \\dfrac{R}{\\gamma}\\left[ 1 + \\dfrac{\\big(\\exp(r_{2}h)-1\\big)\\exp(r_{1}x) + \\big(1-\\exp(r_{1}h)\\big)\\exp(r_{2}x)}{\\exp(r_{1}h)-\\exp(r_{2}h)} \\right]\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "Building on the constant-residual case, this practice explores a more realistic scenario where the residual within an element is a linear function. Solving for the bubble in this context reveals one of the most powerful features of the RFB method: its ability to automatically adapt to the local physics of the problem. By analyzing the solution's dependence on the cell Péclet number, $\\mathrm{Pe}_K$, you will see how the bubble function inherently captures sharp internal gradients and boundary layers in advection-dominated flows, providing stabilization precisely where it is needed .",
            "id": "3804226",
            "problem": "Consider the one-dimensional steady advection-diffusion model on a finite element (cell) $K = (0,h)$ with advection coefficient $\\beta \\in \\mathbb{R}\\setminus\\{0\\}$ and diffusion coefficient $\\varepsilon > 0$, and no reaction term. In the residual-free bubble (RFB) method, the local bubble $b_K(x)$ on $K$ is defined as the solution of the subscale problem that cancels the coarse-scale residual inside $K$ while vanishing on the boundary of $K$. Assume that the coarse-scale residual restricted to $K$ is the affine function $r_K(x) = a x + b$, where $a,b \\in \\mathbb{R}$ are constants. The RFB local problem is thus: find $b_K(x)$ such that\n$$\n-\\varepsilon\\, b_K''(x) + \\beta\\, b_K'(x) = r_K(x) \\quad \\text{for } x \\in (0,h), \\qquad b_K(0)=0,\\quad b_K(h)=0,\n$$\nwith $\\sigma=0$ (no reaction). \n\nStarting from the governing operator definition and the definition of the residual-free bubble subproblem, derive a closed-form expression for the unique solution $b_K(x)$ in terms of $a$, $b$, $\\varepsilon$, $\\beta$, $h$, and $x$. Then interpret how the functional form of $b_K(x)$ reflects the capability of the RFB to capture internal gradients within the element for different values of the cell Péclet number $\\mathrm{Pe}_K = \\beta h/\\varepsilon$.\n\nYour final answer must be the single closed-form analytic expression for $b_K(x)$, with no rounding. No units are required.",
            "solution": "The problem requires us to find the closed-form solution to the boundary value problem:\n$$-\\varepsilon\\, b_K''(x) + \\beta\\, b_K'(x) = a x + b \\quad \\text{for } x \\in (0,h)$$\nsubject to the boundary conditions $b_K(0)=0$ and $b_K(h)=0$.\n\nThe general solution $b_K(x)$ is the sum of the homogeneous solution $b_h(x)$ and a particular solution $b_p(x)$.\n\n**1. Homogeneous Solution**\nThe homogeneous equation is $-\\varepsilon\\, b_h''(x) + \\beta\\, b_h'(x) = 0$. Its characteristic equation, $-\\varepsilon \\lambda^2 + \\beta \\lambda = 0$, has roots $\\lambda_1 = 0$ and $\\lambda_2 = \\beta/\\varepsilon$. The general homogeneous solution is therefore:\n$$\nb_h(x) = C_1 + C_2 \\exp\\left(\\frac{\\beta}{\\varepsilon}x\\right)\n$$\n\n**2. Particular Solution**\nSince the right-hand side is a linear polynomial and $\\lambda=0$ is a root of the characteristic equation, we seek a particular solution of the form $b_p(x) = x(K_1 x + K_0) = K_1 x^2 + K_0 x$. Its derivatives are $b_p'(x) = 2K_1 x + K_0$ and $b_p''(x) = 2K_1$. Substituting into the ODE gives:\n$$\n-\\varepsilon (2K_1) + \\beta (2K_1x + K_0) = a x + b\n$$\nBy equating coefficients of like powers of $x$, we find $K_1 = \\frac{a}{2\\beta}$ and $K_0 = \\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}$. The particular solution is:\n$$\nb_p(x) = \\frac{a}{2\\beta}x^2 + \\left(\\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}\\right)x\n$$\n\n**3. General Solution and Application of Boundary Conditions**\nThe general solution is $b_K(x) = C_1 + C_2 \\exp\\left(\\frac{\\beta}{\\varepsilon}x\\right) + b_p(x)$. Applying the boundary conditions:\n- $b_K(0) = 0 \\implies C_1 + C_2 = 0 \\implies C_1 = -C_2$.\n- $b_K(h) = 0 \\implies C_1 + C_2 \\exp\\left(\\frac{\\beta h}{\\varepsilon}\\right) + b_p(h) = 0$.\n\nSubstituting $C_1 = -C_2$ into the second condition gives $C_2 \\left(\\exp\\left(\\frac{\\beta h}{\\varepsilon}\\right) - 1\\right) = -b_p(h)$. Solving for $C_2$ and substituting back gives the final solution:\n$$\nb_K(x) = b_p(x) - b_p(h) \\frac{\\exp\\left(\\frac{\\beta x}{\\varepsilon}\\right) - 1}{\\exp\\left(\\frac{\\beta h}{\\varepsilon}\\right) - 1}\n$$\nExplicitly, this is:\n$$\nb_K(x) = \\left[ \\frac{a x^2}{2\\beta} + \\left(\\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}\\right)x \\right] - \\left[ \\frac{a h^2}{2\\beta} + \\left(\\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}\\right)h \\right] \\frac{\\exp\\left(\\frac{\\beta x}{\\varepsilon}\\right) - 1}{\\exp\\left(\\frac{\\beta h}{\\varepsilon}\\right) - 1}\n$$\n\n**Interpretation in terms of the Cell Péclet Number**\nThe cell Péclet number, $\\mathrm{Pe}_K = \\frac{\\beta h}{\\varepsilon}$, compares advective to diffusive transport. The solution's form adapts based on its value.\n- **Advection-Dominated ($|\\mathrm{Pe}_K| \\gg 1$):** The exponential term $\\exp(\\mathrm{Pe}_K)$ is very large (for $\\beta>0$) or small (for $\\beta0$). The function develops a sharp boundary layer of thickness $\\mathcal{O}(\\varepsilon/\\beta)$ near the element's outflow boundary to satisfy the boundary condition. Away from this layer, the solution is approximated by the polynomial part $b_p(x)$, which solves the first-order problem $\\beta b_K' \\approx ax+b$. This demonstrates the RFB method's ability to automatically capture sharp internal gradients.\n- **Diffusion-Dominated ($|\\mathrm{Pe}_K| \\ll 1$):** The exponential term can be linearly approximated, causing the ratio of exponentials to approach $x/h$. The solution becomes a smoother, more symmetric profile, characteristic of the solution to the diffusion problem $-\\varepsilon b_K''(x) \\approx ax+b$.\n\nThis adaptive behavior, transitioning from a broad profile to one with a sharp internal layer, is a key strength of the RFB method.",
            "answer": "$$\n\\boxed{\\left[ \\frac{a x^2}{2\\beta} + \\left(\\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}\\right)x \\right] - \\left[ \\frac{a h^2}{2\\beta} + \\left(\\frac{b}{\\beta} + \\frac{a\\varepsilon}{\\beta^2}\\right)h \\right] \\frac{\\exp\\left(\\frac{\\beta x}{\\varepsilon}\\right) - 1}{\\exp\\left(\\frac{\\beta h}{\\varepsilon}\\right) - 1}}\n$$"
        },
        {
            "introduction": "This final practice bridges the gap between the continuous, partial differential equation (PDE) theory of RFBs and their practical implementation in a finite element code. The exercise focuses on the algebraic procedure of static condensation, which is used to eliminate the bubble degrees of freedom at the element level. By deriving the resulting stabilization matrix, you will understand how the influence of the sub-grid bubble is mathematically transferred to the coarse-scale system, resulting in a modified (stabilized) problem that can be solved globally .",
            "id": "3804219",
            "problem": "Consider a single finite element $T \\subset \\mathbb{R}^{d}$ on which the scalar advection–diffusion–reaction boundary value problem is posed: find $u$ such that $-\\nabla \\cdot (\\kappa \\nabla u) + \\boldsymbol{\\beta} \\cdot \\nabla u + \\sigma u = f$ in $T$ and $u$ agrees with a prescribed trace on $\\partial T$. Here, $\\kappa \\in \\mathbb{R}^{+}$ is the isotropic diffusion coefficient, $\\boldsymbol{\\beta} \\in \\mathbb{R}^{d}$ is the advection velocity, and $\\sigma \\in \\mathbb{R}$ is the reaction coefficient. Let the standard Galerkin variational bilinear form on $T$ be $a(w,v) = \\int_{T} \\kappa \\nabla w \\cdot \\nabla v \\,\\mathrm{d}x + \\int_{T} (\\boldsymbol{\\beta} \\cdot \\nabla w) v \\,\\mathrm{d}x + \\int_{T} \\sigma w v \\,\\mathrm{d}x$ with linear functional $\\ell(v) = \\int_{T} f v \\,\\mathrm{d}x$.\n\nAugment the coarse finite element space $V_{c}$ (spanned locally on $T$ by shape functions $\\{\\phi_{i}\\}_{i=1}^{n_{c}}$ that may be nonzero on $\\partial T$) with a bubble subscale space $V_{b}$ (spanned on $T$ by interior bubble basis functions $\\{b_{\\alpha}\\}_{\\alpha=1}^{n_{b}}$ that vanish on $\\partial T$), forming $V_{h} = V_{c} \\oplus V_{b}$. The element-level algebraic system in block form for trial coefficients $(\\boldsymbol{u}_{c}, \\boldsymbol{u}_{b}) \\in \\mathbb{R}^{n_{c}} \\times \\mathbb{R}^{n_{b}}$ and test weights $(\\boldsymbol{v}_{c}, \\boldsymbol{v}_{b}) \\in \\mathbb{R}^{n_{c}} \\times \\mathbb{R}^{n_{b}}$ is given by\n$$\n\\begin{pmatrix}\nK_{cc}  K_{cb} \\\\\nK_{bc}  K_{bb}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\boldsymbol{u}_{c} \\\\\n\\boldsymbol{u}_{b}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\boldsymbol{f}_{c} \\\\\n\\boldsymbol{f}_{b}\n\\end{pmatrix},\n$$\nwhere $K_{cc} \\in \\mathbb{R}^{n_{c} \\times n_{c}}$, $K_{cb} \\in \\mathbb{R}^{n_{c} \\times n_{b}}$, $K_{bc} \\in \\mathbb{R}^{n_{b} \\times n_{c}}$, $K_{bb} \\in \\mathbb{R}^{n_{b} \\times n_{b}}$, and $\\boldsymbol{f}_{c} \\in \\mathbb{R}^{n_{c}}$, $\\boldsymbol{f}_{b} \\in \\mathbb{R}^{n_{b}}$ are defined by the bilinear and linear forms $a(\\cdot,\\cdot)$ and $\\ell(\\cdot)$ with respect to $(V_{c}, V_{b})$.\n\nAssume the bubble stiffness matrix $K_{bb}$ is invertible and consider the Residual-Free Bubble (RFB) choice in which bubble unknowns are determined locally so that the interior residual vanishes. Perform exact static condensation of the bubble unknowns and define the condensed coarse-scale stiffness on $T$ as $K_{cc}^{\\mathrm{cond}} = K_{cc} + S$, where $S \\in \\mathbb{R}^{n_{c} \\times n_{c}}$ is the stabilization block induced by eliminating the bubble unknowns. Let $\\boldsymbol{p}_{i} \\in \\mathbb{R}^{n_{b}}$ denote the $i$-th column-vector coupling of $K_{cb}^{\\top}$ with the coarse basis $\\phi_{i}$, i.e., $\\boldsymbol{p}_{i} = (K_{cb})_{i,:}^{\\top}$, and let $\\boldsymbol{g}_{j} \\in \\mathbb{R}^{n_{b}}$ denote the $j$-th column of $K_{bc}$, i.e., $\\boldsymbol{g}_{j} = (K_{bc})_{:,j}$.\n\nDerive a closed-form analytic expression for the stabilization block $S$ in matrix form in terms of $K_{bb}$, $K_{cb}$, and $K_{bc}$, and equivalently in component form using the coupling vectors $\\boldsymbol{p}_{i}$ and $\\boldsymbol{g}_{j}$. Your final answer must be a single symbolic expression for $S$.",
            "solution": "The derivation begins with the element-level algebraic system in block form:\n$$\n\\begin{pmatrix}\nK_{cc}  K_{cb} \\\\\nK_{bc}  K_{bb}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\boldsymbol{u}_{c} \\\\\n\\boldsymbol{u}_{b}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\boldsymbol{f}_{c} \\\\\n\\boldsymbol{f}_{b}\n\\end{pmatrix}\n$$\nThis represents two coupled matrix equations:\n1. $K_{cc} \\boldsymbol{u}_{c} + K_{cb} \\boldsymbol{u}_{b} = \\boldsymbol{f}_{c}$\n2. $K_{bc} \\boldsymbol{u}_{c} + K_{bb} \\boldsymbol{u}_{b} = \\boldsymbol{f}_{b}$\n\nStatic condensation is the process of eliminating the bubble degrees of freedom, $\\boldsymbol{u}_{b}$, at the element level. We use the second equation to express $\\boldsymbol{u}_{b}$ in terms of the coarse-scale unknowns $\\boldsymbol{u}_{c}$. Rearranging the second equation gives:\n$$\nK_{bb} \\boldsymbol{u}_{b} = \\boldsymbol{f}_{b} - K_{bc} \\boldsymbol{u}_{c}\n$$\nSince the bubble stiffness matrix $K_{bb}$ is assumed to be invertible, we can solve for $\\boldsymbol{u}_{b}$ by pre-multiplying by its inverse, $K_{bb}^{-1}$:\n$$\n\\boldsymbol{u}_{b} = K_{bb}^{-1} (\\boldsymbol{f}_{b} - K_{bc} \\boldsymbol{u}_{c})\n$$\nThis expression gives the bubble unknowns entirely in terms of the coarse-scale solution and the load vector on the element.\n\nNext, we substitute this expression for $\\boldsymbol{u}_{b}$ back into the first equation:\n$$\nK_{cc} \\boldsymbol{u}_{c} + K_{cb} \\left( K_{bb}^{-1} (\\boldsymbol{f}_{b} - K_{bc} \\boldsymbol{u}_{c}) \\right) = \\boldsymbol{f}_{c}\n$$\nWe expand the terms and group all expressions involving $\\boldsymbol{u}_{c}$ on the left-hand side:\n$$\nK_{cc} \\boldsymbol{u}_{c} + K_{cb} K_{bb}^{-1} \\boldsymbol{f}_{b} - K_{cb} K_{bb}^{-1} K_{bc} \\boldsymbol{u}_{c} = \\boldsymbol{f}_{c}\n$$\n$$\n(K_{cc} - K_{cb} K_{bb}^{-1} K_{bc}) \\boldsymbol{u}_{c} = \\boldsymbol{f}_{c} - K_{cb} K_{bb}^{-1} \\boldsymbol{f}_{b}\n$$\nThis is the condensed system for the coarse-scale unknowns $\\boldsymbol{u}_{c}$. The effective stiffness matrix for this system is $K_{cc}^{\\mathrm{cond}} = K_{cc} - K_{cb} K_{bb}^{-1} K_{bc}$.\n\nThe problem defines the condensed stiffness as $K_{cc}^{\\mathrm{cond}} = K_{cc} + S$, where $S$ is the stabilization block. By comparing our result with this definition, we can identify $S$:\n$$\nK_{cc} + S = K_{cc} - K_{cb} K_{bb}^{-1} K_{bc}\n$$\nThis directly implies that the stabilization block is:\n$$\nS = - K_{cb} K_{bb}^{-1} K_{bc}\n$$\nThis matrix represents the influence of the unresolved bubble scales on the resolved coarse scales. Its addition to the standard Galerkin matrix $K_{cc}$ provides the stabilization. In component form, using the provided definitions, the $(i,j)$-th entry of $S$ is $S_{ij} = - \\boldsymbol{p}_{i}^{\\top} K_{bb}^{-1} \\boldsymbol{g}_{j}$.",
            "answer": "$$\n\\boxed{- K_{cb} K_{bb}^{-1} K_{bc}}\n$$"
        }
    ]
}