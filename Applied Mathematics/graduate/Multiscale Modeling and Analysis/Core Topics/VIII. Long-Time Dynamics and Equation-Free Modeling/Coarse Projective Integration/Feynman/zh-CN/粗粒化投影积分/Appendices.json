{
    "hands_on_practices": [
        {
            "introduction": "虽然粗粒度投影积分 (CPI) 看似一种复杂的“黑箱”方法，但通过在理想化的极限下进行分析，我们可以理解其基本行为。本练习将展示，在特定假设（爆发长度趋于零）下，CPI 可以优雅地简化为众所周知的前向欧拉方法，为该技术提供了一个至关重要的理论基础。",
            "id": "3744108",
            "problem": "考虑一个确定性粗粒度变量 $U(t) \\in \\mathbb{R}^{m}$，其演化遵循常微分方程 (ODE)\n$$\n\\frac{dU}{dt} = F(U),\n$$\n其中 $F:\\mathbb{R}^{m} \\to \\mathbb{R}^{m}$ 在给定粗粒度状态 $U^{n}$ 的一个邻域内是连续可微的。在粗粒度投影积分法 (CPI; Coarse Projective Integration) 的单个宏观步中，过程如下：在粗粒度时间 $t^{n}$，给定粗粒度状态 $U^{n}$，我们构建一个一致的细尺度微观状态，并让微观模拟器演化一段修复时间 $t_{h} > 0$，随后是一段持续时间为 $\\tau > 0$ 的短时爆发。在短时爆发期间，从微观状态的粗粒度演化中形成一个粗粒度时间导数估计量 $\\widehat{F}_{\\tau}(U^{n})$。然后，CPI 宏观步执行一个投影更新\n$$\nU^{n+1} = U^{n} + \\Delta T\\, \\widehat{F}_{\\tau}(U^{n}),\n$$\n其中宏观步长 $\\Delta T > 0$ 是固定的，且与 $\\tau$ 无关。\n\n假设以下条件成立：\n- 粗粒度 ODE $\\frac{dU}{dt} = F(U)$ 是该粗粒度变量的正确闭合演化。\n- 修复时间 $t_{h}$ 足够长，使得在极限 $\\tau \\to 0$ 下，随后的短时爆发导数估计量相对于在 $U^{n}$ 处的粗粒度动力学是渐近无偏的，意即\n$$\n\\lim_{\\tau \\to 0} \\widehat{F}_{\\tau}(U^{n}) = F(U^{n}),\n$$\n且 $F$ 在 $U^{n}$ 附近是局部利普希茨的。\n- 宏观步长 $\\Delta T$ 是固定的正数。\n\n定义 CPI 宏观斜率\n$$\nL(\\tau) := \\frac{U^{n+1} - U^{n}}{\\Delta T}.\n$$\n仅使用 ODE 定义 $\\frac{dU}{dt} = F(U)$、关于 $F$ 的标准光滑性假设以及上述无偏性条件，推导极限\n$$\nL := \\lim_{\\tau \\to 0} L(\\tau)\n$$\n并将其以 $U^{n}$ 和 $F$ 的符号函数形式表示为闭合形式。\n\n你的最终答案必须是 $L$ 的单个闭合形式解析表达式。不需要进行数值近似。如果使用任何角度，请以弧度表示。不需要单位。不要将最终答案呈现为方程；仅呈现 $L$ 的表达式。",
            "solution": "目标是确定极限 $L := \\lim_{\\tau \\to 0} L(\\tau)$，其中 $L(\\tau)$ 是粗粒度投影积分法 (CPI) 的宏观斜率。问题给出了宏观斜率的定义如下：\n$$\nL(\\tau) := \\frac{U^{n+1} - U^{n}}{\\Delta T}\n$$\n在此，$U^{n}$ 代表在给定时间 $t^{n}$ 的粗粒度状态，$U^{n+1}$ 是经过一个持续时间为 $\\Delta T$ 的宏观步后的粗粒度状态，而 $\\tau$ 是用于估计时间导数的微观模拟爆发的持续时间。\n\n用于将粗粒度状态从 $U^{n}$ 推进到 $U^{n+1}$ 的 CPI 更新规则由以下投影步给出：\n$$\nU^{n+1} = U^{n} + \\Delta T\\, \\widehat{F}_{\\tau}(U^{n})\n$$\n在此表达式中，$\\widehat{F}_{\\tau}(U^{n})$ 是在状态 $U^{n}$ 下，使用持续时间为 $\\tau$ 的模拟计算出的粗粒度时间导数 $\\frac{dU}{dt}$ 的估计量。\n\n为了推导 $L(\\tau)$ 的表达式，我们将 CPI 更新规则代入其定义中。这得到：\n$$\nL(\\tau) = \\frac{\\left(U^{n} + \\Delta T\\, \\widehat{F}_{\\tau}(U^{n})\\right) - U^{n}}{\\Delta T}\n$$\n分子中的项 $U^{n}$ 和 $-U^{n}$ 相互抵消，得到一个简化的表达式：\n$$\nL(\\tau) = \\frac{\\Delta T\\, \\widehat{F}_{\\tau}(U^{n})}{\\Delta T}\n$$\n宏观步长 $\\Delta T$ 被说明是一个固定的正常数，因此只要 $\\Delta T \\neq 0$，它就可以从分子和分母中约去。这给出了宏观斜率和导数估计量之间的直接关系：\n$$\nL(\\tau) = \\widehat{F}_{\\tau}(U^{n})\n$$\n有了 $L(\\tau)$ 的这个简化表达式，我们现在可以计算所需的极限 $L$。该极限定义为：\n$$\nL = \\lim_{\\tau \\to 0} L(\\tau)\n$$\n代入我们得到的 $L(\\tau)$ 的结果，我们有：\n$$\nL = \\lim_{\\tau \\to 0} \\widehat{F}_{\\tau}(U^{n})\n$$\n问题陈述中包含了一个关于估计量 $\\widehat{F}_{\\tau}(U^{n})$ 渐近行为的关键假设。假设修复时间 $t_{h}$ 足够长，使得在极限 $\\tau \\to 0$ 下，该估计量是渐近无偏的。这被正式表述为：\n$$\n\\lim_{\\tau \\to 0} \\widehat{F}_{\\tau}(U^{n}) = F(U^{n})\n$$\n这个条件断言，随着短时爆发时间变得无穷小，估计量收敛到粗粒度向量场 $F$ 在状态 $U^{n}$ 处的精确值。函数 $F(U)$ 由底层的正确粗粒度 ODE $\\frac{dU}{dt} = F(U)$ 定义。\n\n通过将这个给定的极限直接应用到我们关于 $L$ 的表达式中，我们得出最终结果：\n$$\nL = F(U^{n})\n$$\n因此，当短时爆发时间 $\\tau$ 趋近于零时，CPI 宏观斜率的极限就是真实的粗粒度时间导数在宏观步的初始状态 $U^{n}$ 处的值。关于 $F$ 的其他光滑性和利普希茨连续性假设确保了 $F(U^{n})$ 是一个良定义的量，这为整个过程的有效性提供了基础。",
            "answer": "$$\n\\boxed{F(U^{n})}\n$$"
        },
        {
            "introduction": "CPI 的一个核心特征是它利用了微观模拟，而微观模拟本质上是带有噪声的。本练习探讨了控制这种统计不确定性的主要策略：系综平均。通过解决这个问题，您将量化地展示合并多个独立模拟爆发的结果如何系统地减小估计量的方差，这是实现可靠粗粒度模拟的一个基本原则。",
            "id": "3744088",
            "problem": "考虑一个多尺度建模环境，其中使用 Coarse Projective Integration (CPI) 来推进一个宏观粗粒度变量。令宏观粗粒度状态在时刻 $t$ 时表示为 $U^{\\ast}$，并假设在 $U^{\\ast}$ 处的宏观时间导数为 $f(U^{\\ast})$。在 CPI 中，通过运行 $N$ 个独立的微观模拟爆发来估计 $f(U^{\\ast})$，每个爆发的持续时间为 $\\tau$，从通过提升操作与粗粒度状态 $U^{\\ast}$ 一致的微观状态开始。对于爆发 $i$，定义粗粒度可观测量 $X_{i}(t)$ 并构建斜率估计量\n$$\n\\hat{f}_{i} \\equiv \\frac{X_{i}(t+\\tau) - X_{i}(t)}{\\tau}.\n$$\n假设由于微观涨落和有限时长采样，每个 $\\hat{f}_{i}$ 都是 $f(U^{\\ast})$ 的具有有限方差的无偏估计量，并且这些估计量在不同爆发之间相互独立：\n$$\n\\mathbb{E}[\\hat{f}_{i}] = f(U^{\\ast}), \\quad \\mathrm{Var}(\\hat{f}_{i}) = \\sigma^{2}, \\quad \\hat{f}_{1},\\ldots,\\hat{f}_{N} \\text{ independent}.\n$$\n为了减少估计量的可变性，CPI 构建了集成平均斜率估计量\n$$\n\\hat{f}_{N} \\equiv \\frac{1}{N} \\sum_{i=1}^{N} \\hat{f}_{i},\n$$\n然后执行一个步长为 $H$ 的投影前向欧拉步，以如下方式近似在时刻 $t+H$ 的粗粒度状态\n$$\nU_{\\mathrm{proj}} \\equiv U^{\\ast} + H \\hat{f}_{N}.\n$$\n仅从期望和方差的定义、微观爆发的独立性以及投影步的线性性出发，推导投影误差 $U_{\\mathrm{proj}} - \\left(U^{\\ast} + H f(U^{\\ast})\\right)$ 的方差，将其表示为 $N$、$H$ 和 $\\sigma$ 的函数。你的最终答案必须是关于 $N$、$H$ 和 $\\sigma$ 的单一闭式解析表达式，无需进行数值代入。如果在推导中引入任何辅助符号，请明确定义它们。最终表达式无需四舍五入，也无需报告物理单位。",
            "solution": "目标是基于所给的定义和假设，推导投影误差 $U_{\\mathrm{proj}} - \\left(U^{\\ast} + H f(U^{\\ast})\\right)$ 的方差。\n\n令投影误差由随机变量 $\\mathcal{E}$ 表示。根据定义，\n$$\n\\mathcal{E} \\equiv U_{\\mathrm{proj}} - \\left(U^{\\ast} + H f(U^{\\ast})\\right)\n$$\n代入投影状态的表达式 $U_{\\mathrm{proj}} = U^{\\ast} + H \\hat{f}_{N}$，我们得到：\n$$\n\\mathcal{E} = \\left(U^{\\ast} + H \\hat{f}_{N}\\right) - \\left(U^{\\ast} + H f(U^{\\ast})\\right)\n$$\n通过消去 $U^{\\ast}$ 项并提出投影步长 $H$ 来化简该表达式，得到：\n$$\n\\mathcal{E} = H \\left(\\hat{f}_{N} - f(U^{\\ast})\\right)\n$$\n问题要求我们求出这个误差的方差 $\\mathrm{Var}(\\mathcal{E})$。我们将首先计算误差 $\\mathcal{E}$ 的期望，然后使用方差的定义 $\\mathrm{Var}(X) = \\mathbb{E}\\left[(X - \\mathbb{E}[X])^2\\right]$。\n\n首先，我们求出集成平均斜率估计量 $\\hat{f}_{N}$ 的期望。利用期望算子的线性性以及每个单独估计量 $\\hat{f}_{i}$ 都是无偏的这一已知事实，即 $\\mathbb{E}[\\hat{f}_{i}] = f(U^{\\ast})$：\n$$\n\\mathbb{E}[\\hat{f}_{N}] = \\mathbb{E}\\left[\\frac{1}{N} \\sum_{i=1}^{N} \\hat{f}_{i}\\right] = \\frac{1}{N} \\sum_{i=1}^{N} \\mathbb{E}[\\hat{f}_{i}] = \\frac{1}{N} \\sum_{i=1}^{N} f(U^{\\ast}) = \\frac{1}{N} \\left(N f(U^{\\ast})\\right) = f(U^{\\ast})\n$$\n这表明集成平均估计量 $\\hat{f}_{N}$ 也是真实宏观导数 $f(U^{\\ast})$ 的一个无偏估计量。\n\n现在，我们可以计算投影误差 $\\mathcal{E}$ 的期望：\n$$\n\\mathbb{E}[\\mathcal{E}] = \\mathbb{E}\\left[H \\left(\\hat{f}_{N} - f(U^{\\ast})\\right)\\right] = H \\left(\\mathbb{E}[\\hat{f}_{N}] - \\mathbb{E}[f(U^{\\ast})]\\right)\n$$\n由于 $f(U^{\\ast})$ 是一个确定性量（相对于微观涨落是一个常数），其期望就是其本身。因此，\n$$\n\\mathbb{E}[\\mathcal{E}] = H \\left(f(U^{\\ast}) - f(U^{\\ast})\\right) = 0\n$$\n投影误差的均值为零。\n\n在确定 $\\mathcal{E}$ 的均值为 $0$ 后，$\\mathcal{E}$ 的方差简化为其平方的期望：\n$$\n\\mathrm{Var}(\\mathcal{E}) = \\mathbb{E}\\left[(\\mathcal{E} - \\mathbb{E}[\\mathcal{E}])^2\\right] = \\mathbb{E}\\left[(\\mathcal{E} - 0)^2\\right] = \\mathbb{E}[\\mathcal{E}^2]\n$$\n代入 $\\mathcal{E}$ 的表达式：\n$$\n\\mathrm{Var}(\\mathcal{E}) = \\mathbb{E}\\left[\\left(H (\\hat{f}_{N} - f(U^{\\ast}))\\right)^2\\right] = H^2 \\mathbb{E}\\left[(\\hat{f}_{N} - f(U^{\\ast}))^2\\right]\n$$\n根据定义，项 $\\mathbb{E}\\left[(\\hat{f}_{N} - f(U^{\\ast}))^2\\right]$ 就是 $\\hat{f}_{N}$ 的方差，因为 $\\mathbb{E}[\\hat{f}_{N}] = f(U^{\\ast})$。因此，\n$$\n\\mathrm{Var}(\\mathcal{E}) = H^2 \\mathrm{Var}(\\hat{f}_{N})\n$$\n我们剩下的任务是计算 $\\mathrm{Var}(\\hat{f}_{N})$。我们从其定义开始：\n$$\n\\mathrm{Var}(\\hat{f}_{N}) = \\mathrm{Var}\\left(\\frac{1}{N} \\sum_{i=1}^{N} \\hat{f}_{i}\\right)\n$$\n利用方差的性质 $\\mathrm{Var}(cX) = c^2 \\mathrm{Var}(X)$ 和独立随机变量和的方差等于方差之和，我们得到：\n$$\n\\mathrm{Var}(\\hat{f}_{N}) = \\frac{1}{N^2} \\mathrm{Var}\\left(\\sum_{i=1}^{N} \\hat{f}_{i}\\right) = \\frac{1}{N^2} \\sum_{i=1}^{N} \\mathrm{Var}(\\hat{f}_{i})\n$$\n问题中给出，每个单独估计量的方差都是 $\\mathrm{Var}(\\hat{f}_{i}) = \\sigma^2$。因此：\n$$\n\\mathrm{Var}(\\hat{f}_{N}) = \\frac{1}{N^2} \\sum_{i=1}^{N} \\sigma^2 = \\frac{1}{N^2} (N \\sigma^2) = \\frac{\\sigma^2}{N}\n$$\n最后，我们将其代入投影误差方差 $\\mathrm{Var}(\\mathcal{E})$ 的表达式中：\n$$\n\\mathrm{Var}(\\mathcal{E}) = H^2 \\mathrm{Var}(\\hat{f}_{N}) = H^2 \\left(\\frac{\\sigma^2}{N}\\right) = \\frac{H^2 \\sigma^2}{N}\n$$\n这就是投影误差方差的最终表达式，它以爆发数 $N$、投影步长 $H$ 和单个爆发估计量方差 $\\sigma^2$ 的函数形式表示。",
            "answer": "$$\n\\boxed{\\frac{H^{2} \\sigma^{2}}{N}}\n$$"
        },
        {
            "introduction": "CPI 的实际应用需要在相互竞争的误差来源之间取得平衡，以便在给定的计算成本下获得最佳精度。这个高级练习模拟了系统偏差（由于快变量的弛豫不完全）和统计方差（由于有限的采样时间）之间的权衡。通过最小化一个组合的误差泛函，您将推导出最优的爆发持续时间，揭示了设计高效多尺度模拟的一个关键方面。",
            "id": "3744105",
            "problem": "考虑一个多尺度快慢系统，其中粗观测量$Y(t)$在慢时间尺度上演化，而隐藏的快变量以弛豫时间$\\tau_{f}$指数地弛豫到一个慢流形上。在粗投影积分中，通过持续时间为$T$（脉冲长度）的短时“脉冲”微观模拟来构建一个粗时间导数估计器。每个脉冲根据粗状态进行一致的初始化（“提升”），并使用脉冲的最后一部分——一个长度固定为$\\delta$且满足$\\delta \\ll T$和$\\delta \\gg \\tau_{c}$的估计窗口——来估计粗漂移。假设快变量向慢流形平衡，由于长度为$T$的脉冲后不完全弛豫导致的估计粗漂移中的偏差按$b_{0}\\exp(-T/\\tau_{f})$衰减，其中$b_{0}$是由提升决定的初始偏差幅度。\n\n假设在长度为$\\delta$的窗口上污染漂移估计器的噪声涨落来自于一个零均值、方差为$\\sigma^{2}$、积分自相关时间为$\\tau_{c}$（归一化自相关函数的积分）的平稳过程，因此对于$\\delta \\gg \\tau_{c}$，在长度为$\\delta$的窗口上的时间平均的方差为$2\\sigma^{2}\\tau_{c}/\\delta$。假设运行$n$个独立的脉冲并对其估计值进行平均；每个粗步长可用的总微观计算预算是一个固定的微观时间$B$，因此$nT=B$。\n\n将平均粗漂移估计器的均方误差代价泛函定义为偏差平方与平均估计器方差之和。使用上述假设，将$T$视为受$T>\\delta$约束的连续决策变量，从基本原理出发，推导出一个解析表达式，用于表示使该代价最小化的脉冲长度$T^{\\star}$，该表达式是参数$b_{0}$、$\\tau_{f}$、$\\sigma^{2}$、$\\tau_{c}$、$\\delta$和$B$的函数。你的最终答案必须是$T^{\\star}$关于这些参数的单个闭式表达式。不要在最终表达式中包含单位，也不要进行任何数值代入。最终答案必须是精确的（无需四舍五入）。",
            "solution": "目标是找到最优的脉冲长度$T^{\\star}$，它能最小化粗漂移估计器的均方误差（MSE）。MSE定义为估计器偏差的平方与方差之和。\n$$\n\\text{MSE} = (\\text{偏差})^2 + \\text{方差}\n$$\n我们首先将MSE的两个分量表达为脉冲长度$T$的函数。\n\n1.  **偏差平方 (Squared Bias):**\n    问题指出，来自单个长度为$T$的脉冲的估计器的偏差由$b(T) = b_{0}\\exp(-T/\\tau_{f})$给出。由于最终的估计器是对$n$个独立脉冲的估计值进行平均，平均值的期望等于各期望的平均值。因此，平均估计器的偏差与单个估计器的偏差相同。\n    $$\n    \\text{Bias} = b(T) = b_{0}\\exp(-T/\\tau_{f})\n    $$\n    因此，偏差平方为：\n    $$\n    (\\text{Bias})^2 = \\left(b_{0}\\exp(-T/\\tau_{f})\\right)^2 = b_{0}^{2}\\exp(-2T/\\tau_{f})\n    $$\n\n2.  **估计器方差 (Estimator Variance):**\n    单个脉冲的噪声漂移估计（在长度为$\\delta$的估计窗口上进行时间平均）的方差为$V_{1} = \\frac{2\\sigma^{2}\\tau_{c}}{\\delta}$。\n    最终的估计器是$n$个独立脉冲估计的平均值。由于脉冲是独立的，它们的平均值的方差是单个估计的方差除以脉冲数$n$。\n    $$\n    \\text{Variance} = \\frac{V_{1}}{n} = \\frac{1}{n}\\left(\\frac{2\\sigma^{2}\\tau_{c}}{\\delta}\\right)\n    $$\n    问题提供了一个关联脉冲数$n$、脉冲长度$T$和总计算预算$B$的约束条件：$nT = B$。\n    我们可以将$n$表示为$T$的函数：$n = B/T$。将此代入方差表达式，得到方差作为$T$的函数：\n    $$\n    \\text{Variance}(T) = \\frac{1}{(B/T)}\\left(\\frac{2\\sigma^{2}\\tau_{c}}{\\delta}\\right) = \\frac{2\\sigma^{2}\\tau_{c}T}{B\\delta}\n    $$\n\n现在，我们可以将总MSE写成一个仅依赖于$T$的代价泛函$C(T)$：\n$$\nC(T) = b_{0}^{2}\\exp(-2T/\\tau_{f}) + \\frac{2\\sigma^{2}\\tau_{c}T}{B\\delta}\n$$\n为了找到最小化此代价的脉冲长度$T^{\\star}$，我们必须通过求$C(T)$关于$T$的导数并将其设为零来找到临界点。\n$$\n\\frac{dC}{dT} = \\frac{d}{dT}\\left(b_{0}^{2}\\exp(-2T/\\tau_{f}) + \\frac{2\\sigma^{2}\\tau_{c}T}{B\\delta}\\right)\n$$\n计算导数：\n$$\n\\frac{dC}{dT} = b_{0}^{2}\\left(-\\frac{2}{\\tau_{f}}\\right)\\exp(-2T/\\tau_{f}) + \\frac{2\\sigma^{2}\\tau_{c}}{B\\delta} = -\\frac{2b_{0}^{2}}{\\tau_{f}}\\exp(-2T/\\tau_{f}) + \\frac{2\\sigma^{2}\\tau_{c}}{B\\delta}\n$$\n将导数设为零以找到最优脉冲长度$T^{\\star}$：\n$$\n-\\frac{2b_{0}^{2}}{\\tau_{f}}\\exp(-2T^{\\star}/\\tau_{f}) + \\frac{2\\sigma^{2}\\tau_{c}}{B\\delta} = 0\n$$\n$$\n\\frac{2b_{0}^{2}}{\\tau_{f}}\\exp(-2T^{\\star}/\\tau_{f}) = \\frac{2\\sigma^{2}\\tau_{c}}{B\\delta}\n$$\n我们可以消去两边的因子$2$：\n$$\n\\frac{b_{0}^{2}}{\\tau_{f}}\\exp(-2T^{\\star}/\\tau_{f}) = \\frac{\\sigma^{2}\\tau_{c}}{B\\delta}\n$$\n现在，我们求解$T^{\\star}$。首先，分离指数项：\n$$\n\\exp(-2T^{\\star}/\\tau_{f}) = \\frac{\\sigma^{2}\\tau_{c}\\tau_{f}}{B\\delta b_{0}^{2}}\n$$\n取两边的自然对数：\n$$\n-\\frac{2T^{\\star}}{\\tau_{f}} = \\ln\\left(\\frac{\\sigma^{2}\\tau_{c}\\tau_{f}}{B\\delta b_{0}^{2}}\\right)\n$$\n乘以$-\\tau_{f}/2$来求解$T^{\\star}$：\n$$\nT^{\\star} = -\\frac{\\tau_{f}}{2} \\ln\\left(\\frac{\\sigma^{2}\\tau_{c}\\tau_{f}}{B\\delta b_{0}^{2}}\\right)\n$$\n使用对数恒等式$-\\ln(x) = \\ln(1/x)$，我们可以将表达式写成更方便的形式：\n$$\nT^{\\star} = \\frac{\\tau_{f}}{2} \\ln\\left(\\frac{B\\delta b_{0}^{2}}{\\sigma^{2}\\tau_{c}\\tau_{f}}\\right)\n$$\n为了确认这个临界点是一个最小值，我们检查代价函数的二阶导数$\\frac{d^{2}C}{dT^{2}}$：\n$$\n\\frac{d^{2}C}{dT^{2}} = \\frac{d}{dT}\\left(-\\frac{2b_{0}^{2}}{\\tau_{f}}\\exp(-2T/\\tau_{f}) + \\frac{2\\sigma^{2}\\tau_{c}}{B\\delta}\\right) = \\frac{4b_{0}^{2}}{\\tau_{f}^{2}}\\exp(-2T/\\tau_{f})\n$$\n由于所有参数均为正数，且指数函数总是正的，因此二阶导数$\\frac{d^{2}C}{dT^{2}} > 0$对所有$T$都成立。这证实了代价函数$C(T)$是凸函数，我们的解$T^{\\star}$对应于一个全局最小值。",
            "answer": "$$\n\\boxed{\\frac{\\tau_{f}}{2}\\ln\\left(\\frac{B \\delta b_{0}^{2}}{\\sigma^{2}\\tau_{c}\\tau_{f}}\\right)}\n$$"
        }
    ]
}