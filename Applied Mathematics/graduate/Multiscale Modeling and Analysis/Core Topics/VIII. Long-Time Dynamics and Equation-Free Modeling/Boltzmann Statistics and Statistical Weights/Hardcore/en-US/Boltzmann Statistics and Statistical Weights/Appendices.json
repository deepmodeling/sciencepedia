{
    "hands_on_practices": [
        {
            "introduction": "This first practice takes us back to the foundational principles of the canonical ensemble. By considering a simple two-level system, you will derive the partition function, $Z$, from the ground up, seeing how it emerges as the necessary normalization constant for the Boltzmann probability distribution. This exercise  is crucial for understanding the role of statistical weights (degeneracy) and how they combine with energy levels to define the thermodynamic state of a system.",
            "id": "3737568",
            "problem": "Consider a small system with discrete microstates labeled by $i$, each having energy $E_i$, weakly coupled to a large heat reservoir at temperature $T$. In canonical equilibrium, due to the principle of equal a priori probabilities for the composite microcanonical ensemble and the constraint that the reservoir entropy is maximized subject to energy exchange, the probability $p_i$ of system microstate $i$ is proportional to the Boltzmann factor $\\exp(-\\beta E_i)$, where $\\beta$ is the inverse temperature defined by $\\beta = (k_B T)^{-1}$, and $k_B$ is the Boltzmann constant. \n\nStarting from these first principles, determine the normalization constant implied by the requirement $\\sum_i p_i = 1$ and thereby obtain the normalization function $Z(\\beta)$ for arbitrary discrete microstates. Next, in a multiscale modeling context, suppose the system is coarse-grained into two energy levels: a ground level with energy $0$ and an excited level with energy $\\epsilon > 0$. The ground level is non-degenerate and the excited level has degeneracy $g_1 \\in \\mathbb{N}$. Interpret degeneracy as a statistical weight (i.e., a count of microstates at a given energy) and compute the coarse-grained level probabilities $p_0$ and $p_1$.\n\nExpress your final result as a single row matrix with entries in the order $(Z(\\beta), p_0, p_1)$. Provide exact symbolic expressions and do not include any units. No numerical rounding is required.",
            "solution": "The user has provided a problem statement that must first be validated for scientific soundness and logical consistency.\n\n### Step 1: Extract Givens\n- A small system with discrete microstates labeled by $i$.\n- Each microstate $i$ has energy $E_i$.\n- The system is weakly coupled to a large heat reservoir at temperature $T$.\n- The system is in canonical equilibrium.\n- The principle of equal a priori probabilities for the composite microcanonical ensemble is assumed.\n- The reservoir entropy is maximized subject to energy exchange.\n- The probability $p_i$ of system microstate $i$ is proportional to the Boltzmann factor $\\exp(-\\beta E_i)$.\n- The inverse temperature is defined as $\\beta = (k_B T)^{-1}$, where $k_B$ is the Boltzmann constant.\n- The normalization condition is $\\sum_i p_i = 1$.\n- A coarse-grained system with two energy levels is considered:\n  - Ground level with energy $0$ and non-degenerate (implying degeneracy $g_0 = 1$).\n  - Excited level with energy $\\epsilon > 0$ and degeneracy $g_1 \\in \\mathbb{N}$.\n- The task is to determine the normalization function $Z(\\beta)$ and the coarse-grained level probabilities $p_0$ and $p_1$.\n- The final result is to be expressed as a single row matrix with entries in the order $(Z(\\beta), p_0, p_1)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the required criteria:\n- **Scientifically Grounded**: The problem is a textbook example from statistical mechanics. It is based on the fundamental principles of the canonical ensemble, the Boltzmann distribution, and the definition of the partition function. All concepts, such as temperature, energy levels, degeneracy, and probability, are used in their standard scientific context. The coarse-graining into a two-level system is a standard and physically relevant model. The problem is free of scientific flaws.\n- **Well-Posed**: The problem is clearly defined. It provides all necessary information and definitions to uniquely determine the requested quantities ($Z(\\beta)$, $p_0$, and $p_1$). The relationships between the variables are explicitly stated.\n- **Objective**: The language is precise, technical, and devoid of subjectivity or opinion.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, and objective. It contains no contradictions, ambiguities, or unsound premises. Therefore, the problem is deemed **valid**. I will proceed with a full derivation of the solution.\n\nThe problem requires us to first find the general normalization constant for a system in canonical equilibrium and then apply this framework to a specific two-level system.\n\nAccording to the problem statement, the probability $p_i$ of finding the system in a specific microstate $i$ with energy $E_i$ is proportional to the Boltzmann factor:\n$$p_i \\propto \\exp(-\\beta E_i)$$\nWe introduce a constant of proportionality, which we will call $C$, to turn this into an equality:\n$$p_i = C \\exp(-\\beta E_i)$$\nThe constant $C$ must be determined by the normalization condition, which states that the sum of probabilities over all possible microstates must equal unity:\n$$\\sum_i p_i = 1$$\nSubstituting the expression for $p_i$ into the normalization condition gives:\n$$\\sum_i C \\exp(-\\beta E_i) = 1$$\nSince the constant $C$ is independent of the microstate index $i$, it can be factored out of the summation:\n$$C \\left( \\sum_i \\exp(-\\beta E_i) \\right) = 1$$\nSolving for $C$ yields:\n$$C = \\frac{1}{\\sum_i \\exp(-\\beta E_i)}$$\nThe problem asks for the normalization function $Z(\\beta)$. This function is defined as the sum over states itself, which is the canonical partition function.\n$$Z(\\beta) = \\sum_i \\exp(-\\beta E_i)$$\nThus, the normalization constant is $C = 1/Z(\\beta)$, and the probability of any given microstate $i$ is:\n$$p_i = \\frac{\\exp(-\\beta E_i)}{Z(\\beta)} = \\frac{\\exp(-\\beta E_i)}{\\sum_k \\exp(-\\beta E_k)}$$\nThis completes the first part of the problem.\n\nNext, we consider the coarse-grained system with two energy levels. It is crucial to distinguish between microstates and energy levels. An energy level can be degenerate, meaning multiple microstates share the same energy. The partition function $Z(\\beta)$ is a sum over all *microstates*. When energies are grouped into levels, the sum can be written as a sum over energy levels, where each term is weighted by the degeneracy $g_j$ of the level $j$ with energy $E_j$.\n$$Z(\\beta) = \\sum_{\\text{levels } j} g_j \\exp(-\\beta E_j)$$\nFor the given two-level system:\n- The ground level has energy $E_0 = 0$ and degeneracy $g_0 = 1$ (as it is non-degenerate).\n- The excited level has energy $E_1 = \\epsilon$ and degeneracy $g_1$.\n\nSubstituting these values into the expression for $Z(\\beta)$:\n$$Z(\\beta) = g_0 \\exp(-\\beta E_0) + g_1 \\exp(-\\beta E_1)$$\n$$Z(\\beta) = (1) \\exp(-\\beta \\cdot 0) + g_1 \\exp(-\\beta \\epsilon)$$\nSince $\\exp(0) = 1$, the partition function for this specific system is:\n$$Z(\\beta) = 1 + g_1 \\exp(-\\beta \\epsilon)$$\nThis is the first quantity required for the final answer.\n\nNow, we must compute the coarse-grained level probabilities, $p_0$ and $p_1$. The probability $p_j$ of finding the system in energy level $j$ is the sum of the probabilities of all microstates $i$ that belong to that level. Since all microstates in a given level $j$ have the same energy $E_j$, the probability of each of these microstates is identical: $\\exp(-\\beta E_j) / Z(\\beta)$. To find the total probability for the level, we multiply this by the number of microstates in that level, which is the degeneracy $g_j$.\n$$p_j = g_j \\times p_i(\\text{where } E_i=E_j) = \\frac{g_j \\exp(-\\beta E_j)}{Z(\\beta)}$$\nApplying this formula to our two levels:\nFor the ground level (level $0$):\n$$p_0 = \\frac{g_0 \\exp(-\\beta E_0)}{Z(\\beta)} = \\frac{(1) \\exp(-\\beta \\cdot 0)}{1 + g_1 \\exp(-\\beta \\epsilon)} = \\frac{1}{1 + g_1 \\exp(-\\beta \\epsilon)}$$\nFor the excited level (level $1$):\n$$p_1 = \\frac{g_1 \\exp(-\\beta E_1)}{Z(\\beta)} = \\frac{g_1 \\exp(-\\beta \\epsilon)}{1 + g_1 \\exp(-\\beta \\epsilon)}$$\nAs a consistency check, the sum of these probabilities must be $1$:\n$$p_0 + p_1 = \\frac{1}{1 + g_1 \\exp(-\\beta \\epsilon)} + \\frac{g_1 \\exp(-\\beta \\epsilon)}{1 + g_1 \\exp(-\\beta \\epsilon)} = \\frac{1 + g_1 \\exp(-\\beta \\epsilon)}{1 + g_1 \\exp(-\\beta \\epsilon)} = 1$$\nThe check confirms the correctness of our derived probabilities.\n\nThe final result is the row matrix $(Z(\\beta), p_0, p_1)$.\n- $Z(\\beta) = 1 + g_1 \\exp(-\\beta \\epsilon)$\n- $p_0 = \\frac{1}{1 + g_1 \\exp(-\\beta \\epsilon)}$\n- $p_1 = \\frac{g_1 \\exp(-\\beta \\epsilon)}{1 + g_1 \\exp(-\\beta \\epsilon)}$\nThese expressions are assembled into the required format for the final answer.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 + g_1 \\exp(-\\beta \\epsilon) & \\frac{1}{1 + g_1 \\exp(-\\beta \\epsilon)} & \\frac{g_1 \\exp(-\\beta \\epsilon)}{1 + g_1 \\exp(-\\beta \\epsilon)}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Having established the partition function for discrete states, we now bridge the gap to the continuous world of classical mechanics. This exercise  guides you through the calculation of the partition function for a classical harmonic oscillator, a ubiquitous model in physics and chemistry. The key step involves replacing the sum over states with an integral over phase space and understanding the physical necessity of a normalization constant, Planck's constant $h$, to render the partition function dimensionless.",
            "id": "3737610",
            "problem": "In multiscale modeling and analysis, constructing macroscopic thermodynamic functions from microscopic Hamiltonians requires careful normalization of phase-space measures to obtain dimensionless quantities. Consider a single classical degree of freedom representing a coarse-grained vibrational mode modeled as a one-dimensional harmonic oscillator with Hamiltonian $H(x,p)=\\frac{p^{2}}{2m}+\\frac{1}{2}m\\omega^{2}x^{2}$, where $m$ is the mass, $\\omega$ is the angular frequency, $x$ is the coordinate, and $p$ is the momentum. In the classical canonical ensemble at temperature $T$, the partition function is defined by integrating the Boltzmann weight over phase space and normalizing by a chosen phase-space cell area to render the result dimensionless.\n\nStarting from the foundational definition of the classical canonical partition function as a phase-space integral of the Boltzmann factor, compute the partition function $Z$ for the given $H(x,p)$ using a dimensionless normalization based on a uniform cell area in the two-dimensional phase space. Then set this cell area equal to the Planck constant $h$ to obtain a closed-form expression in terms of $h$, the Boltzmann constant $k_{B}$, the temperature $T$, and the angular frequency $\\omega$. Emphasize in your derivation the role played by the choice of phase-space cell size in producing a dimensionless $Z$ and its connection to thermal coarse-graining.\n\nProvide your final answer as a single closed-form analytic expression. No numerical approximation is required and no units should be included in the final answer.",
            "solution": "The problem requires the computation of the classical canonical partition function for a one-dimensional harmonic oscillator. The problem statement is valid as it is scientifically grounded in the principles of classical statistical mechanics, is well-posed with a clear objective and sufficient information, and uses objective, formal language. We may proceed with the solution.\n\nThe classical canonical partition function, $Z$, for a system with continuous degrees of freedom is defined as an integral of the Boltzmann factor over the entire phase space of the system. For a single degree of freedom described by a coordinate $x$ and its conjugate momentum $p$, the phase space is two-dimensional. The partition function is given by:\n$$\nZ = \\frac{1}{h_0} \\iint \\exp(-\\beta H(x,p)) \\,dx \\,dp\n$$\nHere, $H(x,p)$ is the Hamiltonian of the system, and $\\beta = \\frac{1}{k_B T}$, where $k_B$ is the Boltzmann constant and $T$ is the absolute temperature. The integration is performed over all accessible values of $x$ and $p$, which for an unconstrained oscillator is from $-\\infty$ to $+\\infty$ for both variables.\n\nA critical aspect of this definition is the normalization factor $\\frac{1}{h_0}$. The integral $\\iint dx \\,dp$ possesses the physical dimensions of action (energy $\\times$ time). However, the partition function $Z$ must be a dimensionless quantity, as it appears as the argument of a logarithm in fundamental thermodynamic relations such as the Helmholtz free energy, $F = -k_B T \\ln(Z)$. The constant $h_0$ must therefore also have dimensions of action. It represents a fundamental area or \"cell\" in phase space. The choice of $h_0$ corresponds to a \"coarse-graining\" of the continuous classical phase space, effectively counting the number of these fundamental cells accessible to the system. The problem instructs us to use a uniform cell area and eventually set it equal to Planck's constant, $h$. This choice is physically motivated by the correspondence principle, connecting classical statistical mechanics to its quantum mechanical counterpart, where Planck's constant defines the minimum volume of phase space that can be resolved due to the uncertainty principle.\n\nThe Hamiltonian for the one-dimensional harmonic oscillator is provided as:\n$$\nH(x,p) = \\frac{p^2}{2m} + \\frac{1}{2}m\\omega^2 x^2\n$$\nwhere $m$ is the mass and $\\omega$ is the angular frequency.\n\nSubstituting the Hamiltonian into the expression for $Z$, we have:\n$$\nZ = \\frac{1}{h_0} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\beta \\left(\\frac{p^2}{2m} + \\frac{1}{2}m\\omega^2 x^2\\right)\\right) \\,dx \\,dp\n$$\nThe exponential term can be separated into a product of terms depending on $p$ and $x$ independently:\n$$\nZ = \\frac{1}{h_0} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta p^2}{2m}\\right) \\,dp \\cdot \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta m\\omega^2 x^2}{2}\\right) \\,dx\n$$\nBoth integrals are of the standard Gaussian integral form $\\int_{-\\infty}^{\\infty} \\exp(-ay^2) \\,dy = \\sqrt{\\frac{\\pi}{a}}$.\n\nFor the momentum integral, we identify the constant $a_p = \\frac{\\beta}{2m}$:\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta p^2}{2m}\\right) \\,dp = \\sqrt{\\frac{\\pi}{\\frac{\\beta}{2m}}} = \\sqrt{\\frac{2\\pi m}{\\beta}}\n$$\nFor the position integral, we identify the constant $a_x = \\frac{\\beta m\\omega^2}{2}$:\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta m\\omega^2 x^2}{2}\\right) \\,dx = \\sqrt{\\frac{\\pi}{\\frac{\\beta m\\omega^2}{2}}} = \\sqrt{\\frac{2\\pi}{\\beta m\\omega^2}}\n$$\nNow, we multiply these two results and the normalization factor to find $Z$:\n$$\nZ = \\frac{1}{h_0} \\left(\\sqrt{\\frac{2\\pi m}{\\beta}}\\right) \\left(\\sqrt{\\frac{2\\pi}{\\beta m\\omega^2}}\\right)\n$$\n$$\nZ = \\frac{1}{h_0} \\sqrt{\\frac{4\\pi^2 m}{\\beta^2 m\\omega^2}} = \\frac{1}{h_0} \\sqrt{\\frac{4\\pi^2}{\\beta^2 \\omega^2}}\n$$\nTaking the square root gives:\n$$\nZ = \\frac{1}{h_0} \\frac{2\\pi}{\\beta \\omega}\n$$\nAs per the problem statement, we set the phase-space cell area $h_0$ to Planck's constant, $h$:\n$$\nZ = \\frac{2\\pi}{h \\beta \\omega}\n$$\nFinally, we substitute $\\beta = \\frac{1}{k_B T}$ to express the partition function in terms of the specified variables $h$, $k_B$, $T$, and $\\omega$:\n$$\nZ = \\frac{2\\pi}{h \\left(\\frac{1}{k_B T}\\right) \\omega} = \\frac{2\\pi k_B T}{h \\omega}\n$$\nThis is the final closed-form expression for the classical partition function of the one-dimensional harmonic oscillator, using the semi-classical normalization convention.",
            "answer": "$$\\boxed{\\frac{2 \\pi k_B T}{h \\omega}}$$"
        },
        {
            "introduction": "With the ability to calculate the partition function, we can now analyze the physical behavior it predicts. This final practice explores the outcome of a delicate balance: the tendency of a system to explore states with high degeneracy (high entropy) versus the energetic penalty of occupying high-energy states. By finding the most probable energy for a system with an energy-dependent degeneracy , you will gain insight into how the competition between the statistical weight $g(E)$ and the Boltzmann factor $\\exp(-\\beta E)$ shapes the overall energy distribution.",
            "id": "3737617",
            "problem": "In a multiscale coarse-grained model of a large classical system, the energy spectrum is effectively continuous with energy $E \\ge 0$. The canonical ensemble at inverse temperature $\\beta$ assigns to each microstate of energy $E$ the Boltzmann weight $\\exp(-\\beta E)$. The coarse-grained degeneracy (number of microstates at energy $E$) grows monotonically with energy and is modeled by\n$$\ng(E) = A\\,E^{\\nu}\\,\\exp(\\alpha E),\n$$\nwhere $A>0$ is a constant prefactor, $\\nu$ is a real parameter with $\\nu > 0$, and $\\alpha \\ge 0$ quantifies the exponential growth rate of degeneracy with energy.\n\nThe canonical probability density of energy is proportional to $g(E)\\exp(-\\beta E)$ and is normalized by the partition function, provided it exists.\n\nTasks:\n- Using only the canonical ensemble definition and first principles of probability maximization, compute the most probable energy (the mode) $E_{\\star}$ of the canonical energy distribution, expressed in terms of $\\alpha$, $\\beta$, and $\\nu$. Assume $\\beta > \\alpha$ and $\\nu > 0$ so that the partition function is finite and the mode lies in the interior of the domain $E > 0$.\n- Briefly explain, in words, how the competition between the degeneracy factor $g(E)$ and the Boltzmann factor $\\exp(-\\beta E)$ shapes the energy probability density and determines whether a finite most probable energy exists.\n\nExpress your final answer as a single closed-form symbolic expression for $E_{\\star}$ in terms of $\\alpha$, $\\beta$, and $\\nu$. Do not attach units. No numerical evaluation or rounding is required.",
            "solution": "The canonical ensemble for a system with continuous energy $E \\ge 0$ defines the (unnormalized) probability density for observing energy $E$ as\n$$\np(E) \\propto g(E)\\,\\exp(-\\beta E),\n$$\nwith proportionality constant determined by the partition function\n$$\nZ(\\beta) \\equiv \\int_{0}^{\\infty} g(E)\\,\\exp(-\\beta E)\\, \\mathrm{d}E,\n$$\nprovided the integral converges.\n\nGiven the modeled degeneracy\n$$\ng(E) = A\\,E^{\\nu}\\,\\exp(\\alpha E),\n$$\nwith $A>0$, $\\nu>0$, and $\\alpha \\ge 0$, the unnormalized probability density is\n$$\np(E) \\propto A\\,E^{\\nu}\\,\\exp(\\alpha E)\\,\\exp(-\\beta E) = A\\,E^{\\nu}\\,\\exp\\!\\big(-( \\beta - \\alpha )E\\big).\n$$\nSince $A>0$ is a constant factor that does not affect the location of the maximum, we can work with the log-density (up to an additive constant)\n$$\n\\ln p(E) = \\nu \\ln E - (\\beta - \\alpha) E + \\text{const}.\n$$\nWe seek the mode $E_{\\star} > 0$, which is the maximizer of $\\ln p(E)$ under the conditions that ensure normalization and an interior extremum. Differentiating and setting to zero,\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}E}\\ln p(E) = \\frac{\\nu}{E} - (\\beta - \\alpha) = 0.\n$$\nSolving for $E$ gives\n$$\nE_{\\star} = \\frac{\\nu}{\\beta - \\alpha}.\n$$\nUnder the stated assumptions $\\beta > \\alpha$ and $\\nu > 0$, we have $E_{\\star} > 0$. To verify that this critical point is a maximum, compute the second derivative,\n$$\n\\frac{\\mathrm{d}^{2}}{\\mathrm{d}E^{2}} \\ln p(E) = -\\frac{\\nu}{E^{2}},\n$$\nwhich is negative for all $E>0$ when $\\nu>0$. Hence the critical point is indeed a unique interior maximum.\n\nNormalization and existence of the mode require that the partition function be finite. From the tail behavior,\n$$\np(E) \\propto E^{\\nu}\\,\\exp\\!\\big(-(\\beta - \\alpha)E\\big),\n$$\nthe integral $\\int_{0}^{\\infty} p(E)\\,\\mathrm{d}E$ converges if and only if $\\beta > \\alpha$. Near $E=0$, integrability requires $\\nu > -1$, and the existence of an interior mode requires $\\nu > 0$ so that the boundary at $E=0$ is not the maximizer. These are consistent with the given assumptions.\n\nInterplay discussion: The probability density combines the entropic growth from degeneracy and the energetic suppression from the Boltzmann factor,\n$$\np(E) \\propto g(E)\\,\\exp(-\\beta E) = \\exp\\!\\Big(\\ln g(E) - \\beta E\\Big).\n$$\nWith $g(E) = A\\,E^{\\nu}\\,\\exp(\\alpha E)$, one has\n$$\n\\ln g(E) = \\ln A + \\nu \\ln E + \\alpha E.\n$$\nThe competition is governed by the slope balance of the “effective entropy” $\\ln g(E)$ versus the energetic penalty $\\beta E$. The stationary condition\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}E}\\Big(\\ln g(E) - \\beta E\\Big) = 0 \\quad \\Longleftrightarrow \\quad \\alpha + \\frac{\\nu}{E_{\\star}} = \\beta\n$$\nidentifies the energy at which the incremental entropic gain per unit energy equals the thermal penalty. When $\\beta > \\alpha$, the penalty dominates at sufficiently large $E$, producing a normalizable density with a finite most probable energy $E_{\\star} = \\nu/(\\beta - \\alpha)$. When $\\beta \\le \\alpha$, the degeneracy grows too rapidly for the Boltzmann factor to overcome, the partition function diverges for an unbounded spectrum, and no finite interior mode exists; instead, the distribution either is non-normalizable or is pushed to the upper boundary if a finite energy cutoff is present. Thus, the existence and location of the most probable energy are determined by the balance between the exponential growth rate $\\alpha$ from $g(E)$ and the thermal decay rate $\\beta$ from $\\exp(-\\beta E)$, with the polynomial factor $E^{\\nu}$ selecting the precise scale of the mode within the normalizable regime.",
            "answer": "$$\\boxed{\\dfrac{\\nu}{\\beta - \\alpha}}$$"
        }
    ]
}