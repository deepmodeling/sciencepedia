{
    "hands_on_practices": [
        {
            "introduction": "在大涡模拟（LES）中，空间滤波是其核心思想，它将流场分解为直接求解的大尺度部分和需要建模的小尺度部分。不同的滤波器对不同尺度的衰减特性各不相同，理解这些特性对于正确解释和构建 LES 模型至关重要。这项练习将引导你通过推导和比较几种典型滤波器（例如顶帽滤波器、高斯滤波器和尖锐谱截断滤波器）的谱传递函数，来量化它们在波数空间中的行为 。通过这个基础的数学分析，你将深入理解滤波操作如何影响流动的不同尺度。",
            "id": "3773910",
            "problem": "在大涡模拟 (LES) 和亚格子尺度 (SGS) 建模的背景下，对于不可压缩湍流，空间滤波被用来分离解析尺度和未解析尺度。考虑一个一维、线性、位移不变的滤波器，其核函数为 $G_{\\Delta}(x)$，且经过归一化，使得 $\\int_{-\\infty}^{\\infty} G_{\\Delta}(x)\\,dx = 1$。滤波后的场由卷积 $\\bar{u}(x) = \\int_{-\\infty}^{\\infty} G_{\\Delta}(r)\\,u(x-r)\\,dr$ 给出。谱传递函数 $\\widehat{G}_{\\Delta}(k)$ 定义为 $G_{\\Delta}(x)$ 的傅里叶变换，其约定为 $\\widehat{f}(k) = \\int_{-\\infty}^{\\infty} f(x)\\,\\exp(-\\mathrm{i} k x)\\,dx$，波数 $k$ 处的衰减为 $A(k) = |\\widehat{G}_{\\Delta}(k)|$。\n\n考虑三种典型的滤波器，均与一个特征滤波宽度 $\\Delta$ 相关联：\n- 一个顶帽（箱式）滤波器，其核函数 $G_{\\Delta}^{\\mathrm{TH}}(x)$ 在宽度为 $\\Delta$ 的区间上为常数，在其他地方为零。\n- 一个高斯滤波器 $G_{\\Delta}^{\\mathrm{G}}(x)$，其标准差 $\\sigma$ 的选择使其二阶矩与顶帽滤波器的二阶矩相匹配。\n- 一个尖锐谱截断滤波器 $G_{\\Delta}^{\\mathrm{CO}}(x)$，在傅里叶空间中定义，其谱传递函数在一个有限频带内为常数，带外为零，截断值的选择使得 $k_{c}\\Delta = \\pi$。\n\n令无量纲波数为 $\\xi = k \\Delta$。从上述定义出发，推导顶帽滤波器的谱传递函数 $\\widehat{G}_{\\Delta}^{\\mathrm{TH}}(k)$，并用 $\\xi$ 表示。然后，利用指定的匹配条件和截断定义，分别写出高斯滤波器和尖锐谱截断滤波器对应的衰减函数 $A_{\\mathrm{G}}(\\xi)$ 和 $A_{\\mathrm{CO}}(\\xi)$，并比较它们作为 $\\xi$ 的函数的衰减行为（特别是在 $\\xi \\approx \\pi/2$ 附近），过程中不作任何非物理的假设。\n\n你的最终答案应该是一个关于顶帽滤波器谱传递函数 $\\widehat{G}_{\\Delta}^{\\mathrm{TH}}$ 的、纯粹用 $\\xi$ 表示的封闭形式解析表达式。",
            "solution": "问题陈述已经过评估并被确定为有效。它在科学上基于流体动力学中成熟的大涡模拟（LES）理论，问题提法得当，信息充分且一致，并以客观、正式的语言表述。所有定义和要求条件均为该领域的标准。因此，我们可以开始求解。\n\n问题要求推导一维顶帽滤波器的谱传递函数，并随后与等效的高斯滤波器和尖锐谱截断滤波器的衰减函数进行比较。\n\n首先，我们定义顶帽（或箱式）滤波器的核函数 $G_{\\Delta}^{\\mathrm{TH}}(x)$。它被定义为一个在宽度为 $\\Delta$ 的区间上为常数、在其他地方为零的函数。为对称起见，我们将此区间中心设在 $x=0$ 处。归一化条件 $\\int_{-\\infty}^{\\infty} G_{\\Delta}^{\\mathrm{TH}}(x)\\,dx = 1$ 决定了该常数的值。设此常数为 $C$。那么，\n$$\n\\int_{-\\infty}^{\\infty} G_{\\Delta}^{\\mathrm{TH}}(x)\\,dx = \\int_{-\\Delta/2}^{\\Delta/2} C\\,dx = C \\cdot \\Delta = 1\n$$\n这得到 $C = 1/\\Delta$。因此，滤波核函数为：\n$$\nG_{\\Delta}^{\\mathrm{TH}}(x) =\n\\begin{cases}\n\\frac{1}{\\Delta}  \\text{if } |x| \\le \\frac{\\Delta}{2} \\\\\n0  \\text{if } |x|  \\frac{\\Delta}{2}\n\\end{cases}\n$$\n谱传递函数 $\\widehat{G}_{\\Delta}^{\\mathrm{TH}}(k)$ 是核函数 $G_{\\Delta}^{\\mathrm{TH}}(x)$ 的傅里叶变换。使用所提供的傅里叶变换定义 $\\widehat{f}(k) = \\int_{-\\infty}^{\\infty} f(x)\\,\\exp(-\\mathrm{i} k x)\\,dx$，我们计算：\n$$\n\\widehat{G}_{\\Delta}^{\\mathrm{TH}}(k) = \\int_{-\\infty}^{\\infty} G_{\\Delta}^{\\mathrm{TH}}(x)\\,\\exp(-\\mathrm{i} k x)\\,dx = \\int_{-\\Delta/2}^{\\Delta/2} \\frac{1}{\\Delta} \\exp(-\\mathrm{i} k x)\\,dx\n$$\n执行积分：\n$$\n\\widehat{G}_{\\Delta}^{\\mathrm{TH}}(k) = \\frac{1}{\\Delta} \\left[ \\frac{\\exp(-\\mathrm{i} k x)}{-\\mathrm{i} k} \\right]_{-\\Delta/2}^{\\Delta/2} = \\frac{1}{-\\mathrm{i} k \\Delta} \\left( \\exp\\left(-\\mathrm{i} k \\frac{\\Delta}{2}\\right) - \\exp\\left(\\mathrm{i} k \\frac{\\Delta}{2}\\right) \\right)\n$$\n使用欧拉恒等式 $\\sin(\\theta) = \\frac{\\exp(\\mathrm{i}\\theta) - \\exp(-\\mathrm{i}\\theta)}{2\\mathrm{i}}$，我们可以简化表达式：\n$$\n\\widehat{G}_{\\Delta}^{\\mathrm{TH}}(k) = \\frac{1}{k \\Delta} \\left( \\frac{\\exp\\left(\\mathrm{i} k \\frac{\\Delta}{2}\\right) - \\exp\\left(-\\mathrm{i} k \\frac{\\Delta}{2}\\right)}{\\mathrm{i}} \\right) = \\frac{2 \\sin\\left(k \\frac{\\Delta}{2}\\right)}{k \\Delta} = \\frac{\\sin\\left(\\frac{k\\Delta}{2}\\right)}{\\frac{k\\Delta}{2}}\n$$\n这是 sinc 函数，$\\mathrm{sinc}(z) = \\frac{\\sin(z)}{z}$。问题要求结果用无量纲波数 $\\xi = k \\Delta$ 表示。将 $k\\Delta = \\xi$ 代入我们的结果，得到顶帽传递函数的最终表达式：\n$$\n\\widehat{G}_{\\Delta}^{\\mathrm{TH}}(\\xi) = \\frac{\\sin\\left(\\frac{\\xi}{2}\\right)}{\\frac{\\xi}{2}}\n$$\n该函数是实数，因此其衰减为 $A_{\\mathrm{TH}}(\\xi) = |\\widehat{G}_{\\Delta}^{\\mathrm{TH}}(\\xi)| = \\left|\\frac{\\sin(\\xi/2)}{\\xi/2}\\right|$。\n\n接下来，我们推导高斯滤波器的衰减函数 $A_{\\mathrm{G}}(\\xi)$。高斯滤波器的核函数为 $G_{\\Delta}^{\\mathrm{G}}(x) = \\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp(-\\frac{x^2}{2\\sigma^2})$。其标准差 $\\sigma$ 通过将其二阶矩 $M_2^{\\mathrm{G}} = \\int_{-\\infty}^{\\infty} x^2 G_{\\Delta}^{\\mathrm{G}}(x)\\,dx = \\sigma^2$ 与顶帽滤波器的二阶矩相匹配来指定。顶帽滤波器的二阶矩为：\n$$\nM_2^{\\mathrm{TH}} = \\int_{-\\infty}^{\\infty} x^2 G_{\\Delta}^{\\mathrm{TH}}(x)\\,dx = \\int_{-\\Delta/2}^{\\Delta/2} x^2 \\frac{1}{\\Delta}\\,dx = \\frac{1}{\\Delta} \\left[ \\frac{x^3}{3} \\right]_{-\\Delta/2}^{\\Delta/2} = \\frac{1}{3\\Delta} \\left( \\frac{\\Delta^3}{8} - \\left(-\\frac{\\Delta^3}{8}\\right) \\right) = \\frac{2\\Delta^3}{24\\Delta} = \\frac{\\Delta^2}{12}\n$$\n令二阶矩相等，得到 $\\sigma^2 = \\frac{\\Delta^2}{12}$。高斯函数的傅里叶变换是另一个高斯函数：\n$$\n\\widehat{G}_{\\Delta}^{\\mathrm{G}}(k) = \\exp\\left(-\\frac{k^2 \\sigma^2}{2}\\right)\n$$\n代入 $\\sigma^2 = \\frac{\\Delta^2}{12}$：\n$$\n\\widehat{G}_{\\Delta}^{\\mathrm{G}}(k) = \\exp\\left(-\\frac{k^2 \\Delta^2}{24}\\right)\n$$\n用 $\\xi = k\\Delta$ 表示，衰减函数 $A_{\\mathrm{G}}(\\xi) = |\\widehat{G}_{\\Delta}^{\\mathrm{G}}(\\xi)|$ 变为：\n$$\nA_{\\mathrm{G}}(\\xi) = \\exp\\left(-\\frac{\\xi^2}{24}\\right)\n$$\n最后，我们考虑尖锐谱截断滤波器。它在傅里叶空间中定义，其谱传递函数在波数达到截断值 $k_c$ 之前为常数，超过则为零。归一化条件 $\\int G(x)dx=1$ 意味着 $\\widehat{G}(0)=1$，因此该常数值为1。截断值由 $k_c \\Delta = \\pi$ 设定，即 $k_c = \\pi/\\Delta$。因此，传递函数为：\n$$\n\\widehat{G}_{\\Delta}^{\\mathrm{CO}}(k) =\n\\begin{cases}\n1  \\text{if } |k| \\le k_c = \\frac{\\pi}{\\Delta} \\\\\n0  \\text{if } |k|  k_c = \\frac{\\pi}{\\Delta}\n\\end{cases}\n$$\n条件 $|k| \\le \\frac{\\pi}{\\Delta}$ 等价于 $|k\\Delta| \\le \\pi$，或 $|\\xi| \\le \\pi$。因此，衰减函数是波数空间中的一个矩形函数：\n$$\nA_{\\mathrm{CO}}(\\xi) =\n\\begin{cases}\n1  \\text{if } |\\xi| \\le \\pi \\\\\n0  \\text{if } |\\xi|  \\pi\n\\end{cases}\n$$\n现在，我们比较衰减行为。对于小波数（$\\xi \\to 0$），我们可以使用泰勒级数展开：\n$A_{\\mathrm{TH}}(\\xi) = \\frac{\\sin(\\xi/2)}{\\xi/2} \\approx \\frac{\\xi/2 - (\\xi/2)^3/6}{\\xi/2} = 1 - \\frac{\\xi^2}{24} + \\mathcal{O}(\\xi^4)$.\n$A_{\\mathrm{G}}(\\xi) = \\exp(-\\xi^2/24) \\approx 1 - \\frac{\\xi^2}{24} + \\mathcal{O}(\\xi^4)$.\n$A_{\\mathrm{CO}}(\\xi) = 1$ for $\\xi \\le \\pi$.\n对于大尺度（小 $\\xi$），顶帽滤波器和高斯滤波器的衰减在主阶上是等效的，这是匹配它们二阶矩的直接结果。\n\n在特定的无量纲波数 $\\xi = \\pi/2$ 处：\n$A_{\\mathrm{TH}}(\\pi/2) = \\frac{\\sin(\\pi/4)}{\\pi/4} = \\frac{\\sqrt{2}/2}{\\pi/4} = \\frac{2\\sqrt{2}}{\\pi} \\approx 0.9003$.\n$A_{\\mathrm{G}}(\\pi/2) = \\exp(-(\\pi/2)^2/24) = \\exp(-\\pi^2/96) \\approx 0.9023$.\n$A_{\\mathrm{CO}}(\\pi/2) = 1$.\n在这一点上，顶帽滤波器和高斯滤波器的衰减非常相似，而尖锐谱截断滤波器则完全没有衰减信号。\n\n从性质上看，尖锐谱截断滤波器是最“理想”的低通滤波器，因为它完全移除了所有 $|\\xi| > \\pi$ 的模态，并完美保留了所有 $|\\xi| \\le \\pi$ 的模态。然而，它在物理空间中的核函数是非局域的 sinc 函数，这在实际的 LES 中是有问题的。高斯滤波器具有在物理空间和谱空间中都是局域化的理想特性，能对高波数提供平滑、单调的衰减。顶帽滤波器在物理空间中是局域化的，但其传递函数有振荡（旁瓣），这可能在通过零点后将能量重新引入到更高波数，这种现象被称为谱泄漏。这一点很明显，因为 $A_{\\mathrm{TH}}(\\xi)$ 在 $\\xi/2 = \\pi$（即 $\\xi=2\\pi$）处首次达到零。",
            "answer": "$$\n\\boxed{\\frac{\\sin\\left(\\frac{\\xi}{2}\\right)}{\\frac{\\xi}{2}}}\n$$"
        },
        {
            "introduction": "将滤波操作应用于有界流场（如靠近壁面的流动）时，会产生一些非平凡的后果，这与在无限域中的理想情况不同。由于壁面截断了滤波核的支撑域，滤波和求导这两种运算不再能够交换顺序，导致解析的壁面剪切应力与真实值之间存在差异。这项练习将通过分析一个近壁线性速度剖面，让你从第一性原理出发，推导壁面附近滤波操作如何改变解析速度梯度 。这个分析揭示了亚格子尺度（SGS）模型在壁面处必须提供非零应力的根本原因，从而阐明了壁面建模在 LES 中的关键性。",
            "id": "3773928",
            "problem": "考虑一个用于多尺度建模与分析中的大涡模拟（LES）的近壁区典型构型：在 $y=0$ 处有一个光滑、不可穿透、无滑移壁面，其上的不可压缩湍流，计算域限制在 $y \\ge 0$。假设在紧邻壁面的区域，未滤波的流向速度剖面是线性的，$u(y) = S y$，其中 $S > 0$ 是一个恒定的壁面法向剪切率。滤波速度场由与一个核函数的空间卷积定义，该卷积在壁面处受到几何截断，并为了在可及域上保持单位质量而进行重新归一化，\n$$\n\\bar{u}(y) \\equiv \\frac{\\displaystyle \\int_{0}^{\\infty} G(\\eta - y)\\,u(\\eta)\\,d\\eta}{\\displaystyle \\int_{0}^{\\infty} G(\\eta - y)\\,d\\eta}, \\quad y \\ge 0,\n$$\n其中 $G$ 是在没有边界的情况下 $\\mathbb{R}$ 上的一个对称、非负、单位质量的核函数。将分析两种核函数：\n- 宽度为 $\\Delta > 0$ 的对称顶帽核函数，\n$$\nG_{T}(r) = \\begin{cases}\n\\frac{1}{\\Delta},  |r| \\le \\frac{\\Delta}{2}, \\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\n- 标准差为 $\\sigma > 0$ 的高斯核函数，\n$$\nG_{G}(r) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\!\\left(-\\frac{r^{2}}{2\\sigma^{2}}\\right).\n$$\n\n从上述滤波定义和线性剖面 $u(y)=Sy$ 出发，为每种核函数推导 $\\bar{u}(y)$ 的闭式表达式，并仔细考虑壁面截断（$\\eta \\ge 0$）和分母中的重新归一化。使用这些表达式，计算壁面处的已解尺度壁面法向梯度，\n$$\n\\left.\\frac{d \\bar{u}}{dy}\\right|_{y=0^{+}},\n$$\n对于每种核函数。从第一性原理出发，不使用任何快捷公式，解释边界截断如何相对于未滤波剪切 $S$ 来修正已解尺度梯度，并将此修正与近壁区的亚格子尺度（SGS）模型联系起来。\n\n将顶帽核函数和高斯核函数在 $y=0^{+}$ 处的最终已解尺度壁面法向梯度，分别以一个关于 $S$ 的单个解析行向量的形式给出。不需要进行数值四舍五入，最终的方框表达式内不应写入任何单位。",
            "solution": "该问题是适定的且科学上合理的，其基础是近固体边界大涡模拟（LES）的典型公式化。我们将进行形式推导。\n\n对于一维剖面 $u(y)$，滤波速度 $\\bar{u}(y)$ 由一个卷积积分定义，在 $y=0$ 处存在壁面的情况下，该积分被截断和重新归一化：\n$$\n\\bar{u}(y) = \\frac{\\displaystyle \\int_{0}^{\\infty} G(\\eta - y)\\,u(\\eta)\\,d\\eta}{\\displaystyle \\int_{0}^{\\infty} G(\\eta - y)\\,d\\eta}, \\quad y \\ge 0\n$$\n给定线性速度剖面 $u(y) = Sy$（其中 $S > 0$），我们可以将滤波速度表示为：\n$$\n\\bar{u}(y) = \\frac{N(y)}{D(y)} = \\frac{S \\displaystyle \\int_{0}^{\\infty} \\eta G(\\eta - y)\\,d\\eta}{\\displaystyle \\int_{0}^{\\infty} G(\\eta - y)\\,d\\eta}\n$$\n我们需要计算壁面处的已解尺度壁面法向梯度 $\\left.\\frac{d\\bar{u}}{dy}\\right|_{y=0^{+}}$。使用微分法的商法则：\n$$\n\\left.\\frac{d\\bar{u}}{dy}\\right|_{y=0^{+}} = \\frac{N'(0)D(0) - N(0)D'(0)}{[D(0)]^2}\n$$\n其中撇号表示对 $y$ 的微分，并且求值是在 $y \\to 0^{+}$ 时进行的。\n\n我们首先推导所涉及各项的通用表达式。分母为 $D(y) = \\int_{0}^{\\infty} G(\\eta - y)\\,d\\eta$。令 $s = \\eta - y$，则 $d\\eta = ds$。积分限变为 $[\\-y, \\infty)$。\n$$\nD(y) = \\int_{-y}^{\\infty} G(s)\\,ds\n$$\n在 $y=0$ 处，由于 $G$ 是 $\\mathbb{R}$ 上的一个对称、单位质量的核函数，我们有 $D(0) = \\int_{0}^{\\infty} G(s)\\,ds = \\frac{1}{2}\\int_{-\\infty}^{\\infty} G(s)\\,ds = \\frac{1}{2}$。\n使用莱布尼茨积分法则，$D(y)$ 的导数为：\n$$\nD'(y) = \\frac{d}{dy}\\int_{-y}^{\\infty} G(s)\\,ds = -G(-y)\\frac{d(-y)}{dy} = G(-y)\n$$\n由于 $G$ 是对称的，$G(-y) = G(y)$，所以 $D'(y) = G(y)$。在壁面处，$D'(0) = G(0)$。\n\n分子为 $N(y) = S \\int_{0}^{\\infty} \\eta G(\\eta - y)\\,d\\eta$。其导数为 $N'(y) = \\frac{d}{dy} \\left( S \\int_{0}^{\\infty} \\eta G(\\eta - y)\\,d\\eta \\right)$。\n使用性质 $\\frac{\\partial}{\\partial y}G(\\eta-y) = -\\frac{\\partial}{\\partial \\eta}G(\\eta-y)$，我们可以写出：\n$$\nN'(y) = S \\int_{0}^{\\infty} \\eta \\left(-\\frac{\\partial}{\\partial \\eta}G(\\eta-y)\\right) \\,d\\eta\n$$\n使用分部积分法，令 $f(\\eta)=\\eta$ 和 $dg = -\\frac{\\partial}{\\partial\\eta}G(\\eta-y)d\\eta$，则 $df = d\\eta$ 和 $g = -G(\\eta-y)$：\n$$\nN'(y) = S \\left( [-\\eta G(\\eta-y)]_{0}^{\\infty} - \\int_{0}^{\\infty} (-G(\\eta-y))\\,d\\eta \\right)\n$$\n边界项 $[-\\eta G(\\eta-y)]$ 在 $\\eta=0$ 处因为 $\\eta$ 因子而为零，在 $\\eta \\to \\infty$ 处因为顶帽核函数和高斯核函数等核函数衰减得足够快而为零。剩下：\n$$\nN'(y) = S \\int_{0}^{\\infty} G(\\eta-y) \\,d\\eta = S D(y)\n$$\n在壁面处，$N'(0) = S D(0) = S/2$。最后，在壁面处分子为 $N(0) = S \\int_{0}^{\\infty} \\eta G(\\eta)\\,d\\eta$。\n\n将这些通用结果代入 $y=0^{+}$ 处的梯度表达式中：\n$$\n\\left.\\frac{d\\bar{u}}{dy}\\right|_{y=0^{+}} = \\frac{(S/2)(1/2) - (S \\int_{0}^{\\infty} \\eta G(\\eta)\\,d\\eta) G(0)}{(1/2)^2} = \\frac{S/4 - S\\,G(0)\\int_{0}^{\\infty} \\eta G(\\eta)\\,d\\eta}{1/4}\n$$\n$$\n\\left.\\frac{d\\bar{u}}{dy}\\right|_{y=0^{+}} = S - 4S\\,G(0)\\int_{0}^{\\infty} \\eta G(\\eta)\\,d\\eta\n$$\n这个通用公式使得可以对每种核函数进行系统性计算。\n\n**1. 顶帽核函数（$G_T$）**\n核函数为 $G_T(r) = \\frac{1}{\\Delta}$（当 $|r| \\le \\frac{\\Delta}{2}$ 时）和 $0$（其他情况）。我们计算所需的分量：\n- $G_T(0) = \\frac{1}{\\Delta}$。\n- 积分项为：\n$$\n\\int_{0}^{\\infty} \\eta G_T(\\eta)\\,d\\eta = \\int_{0}^{\\Delta/2} \\eta \\frac{1}{\\Delta}\\,d\\eta = \\frac{1}{\\Delta} \\left[\\frac{\\eta^2}{2}\\right]_{0}^{\\Delta/2} = \\frac{1}{\\Delta} \\frac{(\\Delta/2)^2}{2} = \\frac{\\Delta}{8}\n$$\n代入梯度的通用公式：\n$$\n\\left.\\frac{d\\bar{u}_T}{dy}\\right|_{y=0^{+}} = S - 4S \\left(\\frac{1}{\\Delta}\\right) \\left(\\frac{\\Delta}{8}\\right) = S - \\frac{4S}{8} = S - \\frac{S}{2} = \\frac{S}{2}\n$$\n\n**2. 高斯核函数（$G_G$）**\n核函数为 $G_G(r) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp(-r^{2}/(2\\sigma^{2}))$。我们计算各分量：\n- $G_G(0) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}$。\n- 积分项为：\n$$\n\\int_{0}^{\\infty} \\eta G_G(\\eta)\\,d\\eta = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\int_{0}^{\\infty} \\eta \\exp\\left(-\\frac{\\eta^2}{2\\sigma^2}\\right)\\,d\\eta\n$$\n使用换元法 $v = \\eta^2/(2\\sigma^2)$，由此 $dv = \\eta/\\sigma^2\\,d\\eta$，所以 $\\eta\\,d\\eta = \\sigma^2\\,dv$：\n$$\n\\int_{0}^{\\infty} \\eta G_G(\\eta)\\,d\\eta = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma} \\int_{0}^{\\infty} \\exp(-v) (\\sigma^2\\,dv) = \\frac{\\sigma}{\\sqrt{2\\pi}} \\int_{0}^{\\infty} \\exp(-v)\\,dv = \\frac{\\sigma}{\\sqrt{2\\pi}} [-\\exp(-v)]_{0}^{\\infty} = \\frac{\\sigma}{\\sqrt{2\\pi}}\n$$\n代入梯度的通用公式：\n$$\n\\left.\\frac{d\\bar{u}_G}{dy}\\right|_{y=0^{+}} = S - 4S \\left(\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\right) \\left(\\frac{\\sigma}{\\sqrt{2\\pi}}\\right) = S - \\frac{4S}{2\\pi} = S\\left(1 - \\frac{2}{\\pi}\\right)\n$$\n\n**解释与亚格子尺度（SGS）模型之联系**\n壁面处的未滤波速度梯度是 $\\left.\\frac{du}{dy}\\right|_{y=0} = S$。我们的推导表明，对于顶帽核函数和高斯核函数，壁面处的已解尺度梯度都小于 $S$：$\\frac{S}{2}  S$ 且 $S(1 - 2/\\pi) \\approx 0.363S  S$。\n\n这种减小是在函数定义域被截断的边界附近应用空间滤波器的直接数学结果。在靠近壁面的一点 $y$ 处，滤波核函数 $G(\\eta-y)$ 的部分支集位于非物理区域 $\\eta  0$。滤波定义正确地将积分限制在物理域 $\\eta \\ge 0$ 内，并对滤波器权重进行重新归一化。\n\n让我们考虑壁面本身的滤波速度 $\\bar{u}(0)$。未滤波速度是 $u(0)=0$。然而，滤波过程对 $\\eta > 0$ 的 $u(\\eta)=S\\eta$ 值进行平均。由于所有这些值都是正的，得到的平均值 $\\bar{u}(0)$ 也是正的。这在无滑移壁面上为已解尺度场产生了一个人为的“滑移速度”。例如，对于顶帽核函数，$\\bar{u}_T(0) = S\\Delta/4 > 0$。\n\n因为滤波剖面 $\\bar{u}(y)$ 在 $y=0$ 处从一个正值开始，并且当 $y$ 相对于滤波宽度较大时最终必须与未滤波剖面 $u(y)$ 匹配，所以其初始斜率必须小于 $S$。滤波操作将壁面附近的速度值向上“拉”，使剖面变平。这种滤波梯度与真实梯度之间的差异通常被称为“交换误差”，因为在边界附近，微分和滤波操作是不可交换的：$\\frac{d\\bar{u}}{dy} \\neq \\overline{(\\frac{du}{dy})}$。\n\n这对亚格子尺度（SGS）模型具有关键影响。壁面处的总剪切应力为 $\\tau_w = \\mu \\left.\\frac{du}{dy}\\right|_{y=0} = \\mu S$。在 LES 框架中，该应力必须表示为已解尺度粘性应力和亚格子应力之和：\n$$\n\\tau_w = \\mu \\left.\\frac{d\\bar{u}}{dy}\\right|_{y=0^{+}} + \\tau_{sgs}|_{y=0}\n$$\n由于我们的分析表明 $\\mu \\left.\\frac{d\\bar{u}}{dy}\\right|_{y=0^{+}}  \\mu S$，因此必须有 $\\tau_{sgs}|_{y=0} > 0$。SGS 模型必须提供由于滤波操作本身而从已解尺度场中丢失的剪切应力的“缺失”部分。对于高斯核函数，壁面处所需的 SGS 应力为 $\\tau_{sgs}|_{y=0} = \\mu S - \\mu S(1-2/\\pi) = \\mu S (2/\\pi)$。这表明，任何旨在用于直至壁面的 SGS 模型都必须构建为能够解释这种滤波效应，而这正是 LES 中壁面模型所要解决的根本性挑战。\n\n**最终答案计算**\n顶帽核函数和高斯核函数在 $y=0^{+}$ 处的已解尺度壁面法向梯度分别为 $\\frac{S}{2}$ 和 $S(1 - \\frac{2}{\\pi})$。这些结果需要以单个解析行向量的形式提供。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{S}{2}  S\\left(1 - \\frac{2}{\\pi}\\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在理解了滤波的基本原理及其在壁面附近的复杂性之后，下一步是学习如何评估和验证为解决这些问题而提出的亚格子尺度模型。本次实践介绍了一种标准的模型评估方法——“先验”测试（a priori test），它使用高分辨率的直接数值模拟（DNS）数据或合成流场数据来计算精确的亚格子应力。通过一个动手编程练习，你将实现这一测试流程，将经典的 Smagorinsky 模型和梯度模型的预测结果与精确解进行比较，并量化它们的性能差异 。这为你提供了一个评估和开发亚格子模型的重要实践框架。",
            "id": "3773931",
            "problem": "考虑一个在单位正方形域 $[0,1]^2$ 上的二维、周期性、不可压缩场，坐标为 $(x,y)$，维度 $d=2$。速度场 $\\mathbf{u} = (u,v)$ 由流函数 $\\psi(x,y)$ 通过 $u = \\partial \\psi / \\partial y$ 和 $v = - \\partial \\psi / \\partial x$ 生成，这确保了其不可压缩性。设流函数定义为\n$$\n\\psi(x,y) = A_1 \\sin(2\\pi x)\\sin(2\\pi y) + A_2 \\sin(4\\pi x)\\cos(2\\pi y) + A_3 \\cos(3\\pi x)\\sin(5\\pi y),\n$$\n其中 $A_1 = 1$，$A_2 = 1/2$，$A_3 = 1/3$。在每个方向上使用 $N=128$ 个均匀点对该域进行离散化，得到网格间距 $h = 1/N$。假设流动是无量纲的。\n\n在大涡模拟 (LES) 中，滤波后的速度场 $\\bar{\\mathbf{u}}$ 是通过对 $\\mathbf{u}$ 施加一个宽度为 $\\Delta$ 的空间滤波器得到的。使用一个边长为 $\\Delta$ 的方形支撑域和周期性边界条件的顶帽（箱式）滤波器，该滤波器在离散网格上实现为对 $L \\times L$ 个点的均匀平均，其中 $L$ 是一个奇数且 $\\Delta = L h$。\n\n精确的亚网格尺度应力张量定义为\n$$\n\\tau_{ij} = \\overline{u_i u_j} - \\bar{u}_i \\bar{u}_j,\n$$\n其中上划线表示相同的箱式滤波器。偏张量部分移除了各向同性分量：\n$$\n\\tau'_{ij} = \\tau_{ij} - \\frac{1}{d}\\tau_{kk}\\delta_{ij},\n$$\n其中 $\\delta_{ij}$ 是克罗内克δ，重复指标意味着求和。\n\n将评估两种亚网格尺度模型：\n\n1. Smagorinsky 模型：一个涡粘性模型，其涡粘性系数为 $\\nu_t = (C_s \\Delta)^2 \\, \\lvert S \\rvert$，其中 $C_s$ 是 Smagorinsky 常数，$\\Delta$ 是滤波器宽度，且\n$$\nS_{ij} = \\frac{1}{2}\\left(\\frac{\\partial \\bar{u}_i}{\\partial x_j} + \\frac{\\partial \\bar{u}_j}{\\partial x_i}\\right),\n\\quad\n\\lvert S \\rvert = \\sqrt{2 S_{ij} S_{ij}}.\n$$\n模拟的应力为\n$$\n\\tau^{\\text{Smag}}_{ij} = -2 \\nu_t S_{ij}.\n$$\n为了与精确偏应力进行比较的一致性，使用其偏张量部分 $\\tau'^{\\text{Smag}}_{ij}$，其定义与 $\\tau'_{ij}$ 类似。\n\n2. 梯度 (Clark) 模型：对于宽度为 $\\Delta$ 的顶帽滤波器，应力的主阶近似为\n$$\n\\tau^{\\text{Grad}}_{ij} = \\frac{\\Delta^2}{12}\\sum_{k=1}^{d} \\frac{\\partial \\bar{u}_i}{\\partial x_k}\\frac{\\partial \\bar{u}_j}{\\partial x_k},\n$$\n及其偏张量部分为\n$$\n\\tau'^{\\text{Grad}}_{ij} = \\tau^{\\text{Grad}}_{ij} - \\frac{1}{d}\\tau^{\\text{Grad}}_{kk}\\delta_{ij}.\n$$\n\n设计一个先验测试，对于每个指定的滤波器宽度 $\\Delta$，该测试从滤波后的直接数值模拟 (DNS) 数据（此处，上面定义的合成场作为 DNS 场）中计算精确的偏应力 $\\tau'_{ij}$，然后使用以下无量纲度量计算每个模型相对于精确偏应力的失配度：\n$$\nE^{\\text{model}}(\\Delta) = \\frac{\\left\\|\\tau'^{\\text{model}}_{ij} - \\tau'_{ij}\\right\\|_2}{\\left\\|\\tau'_{ij}\\right\\|_2},\n$$\n其中离散 $L^2$ 范数 $\\lVert \\cdot \\rVert_2$ 聚合了所有张量分量和网格点。\n\n使用带周期性边界条件的中心有限差分来计算滤波场上的空间导数。将箱式滤波器实现为对 $L \\times L$ 个点的周期性平均。将 Smagorinsky 常数设为 $C_s = 0.17$。所有计算和输出都是无量纲的。不涉及角度。\n\n测试套件：\n- 使用 $L \\in \\{3,7,15,31\\}$，对应于滤波器宽度 $\\Delta = L h$。\n- 对于每个 $L$，计算并以浮点数形式报告 $E^{\\text{Smag}}(\\Delta)$ 和 $E^{\\text{Grad}}(\\Delta)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表形式的结果，该列表用方括号括起，并按如下顺序排列\n$$\n\\left[E^{\\text{Smag}}(L{=}3h), E^{\\text{Grad}}(L{=}3h), E^{\\text{Smag}}(L{=}7h), E^{\\text{Grad}}(L{=}7h), E^{\\text{Smag}}(L{=}15h), E^{\\text{Grad}}(L{=}15h), E^{\\text{Smag}}(L{=}31h), E^{\\text{Grad}}(L{=}31h)\\right].\n$$\n- 不需要单位；每个条目都必须是一个浮点数。",
            "solution": "该问题要求对两种大涡模拟 (LES) 亚网格尺度 (SGS) 模型进行先验分析：Smagorinsky 模型和梯度 (Clark) 模型。此分析将在一个人工合成的二维不可压缩速度场上进行。核心任务是从这个高分辨率场计算精确的偏 SGS 应力张量，并将其与由模型的预测应力张量进行比较，而后者是从速度场的滤波版本计算得出的。该比较通过对一系列指定的滤波器宽度使用归一化的离散 $L^2$ 误差范数进行量化。\n\n解决方案通过以下结构化步骤进行：\n\n1.  **网格和速度场的生成**：域是单位正方形 $[0,1]^2$，被离散化为 $N \\times N$ 个点的均匀网格，其中 $N=128$。网格间距为 $h = 1/N = 1/128$。网格坐标 $(x,y)$ 定义为 $x_i = i h$ 和 $y_j = j h$，其中 $i,j \\in \\{0, 1, \\dots, N-1\\}$。速度场 $\\mathbf{u} = (u, v)$ 从给定的流函数 $\\psi(x,y)$ 解析推导得出：\n    $$\n    \\psi(x,y) = A_1 \\sin(2\\pi x)\\sin(2\\pi y) + A_2 \\sin(4\\pi x)\\cos(2\\pi y) + A_3 \\cos(3\\pi x)\\sin(5\\pi y)\n    $$\n    其中常数 $A_1 = 1$，$A_2 = 1/2$，$A_3 = 1/3$。速度分量为 $u = \\partial\\psi/\\partial y$ 和 $v = -\\partial\\psi/\\partial x$。它们的解析表达式为：\n    $$\n    u(x,y) = 2\\pi A_1 \\sin(2\\pi x)\\cos(2\\pi y) - 2\\pi A_2 \\sin(4\\pi x)\\sin(2\\pi y) + 5\\pi A_3 \\cos(3\\pi x)\\cos(5\\pi y)\n    $$\n    $$\n    v(x,y) = -\\left( 2\\pi A_1 \\cos(2\\pi x)\\sin(2\\pi y) + 4\\pi A_2 \\cos(4\\pi x)\\cos(2\\pi y) - 3\\pi A_3 \\sin(3\\pi x)\\sin(5\\pi y) \\right)\n    $$\n    这些函数在 $N \\times N$ 网格上进行求值，以生成高分辨率的“DNS”速度场。\n\n2.  **数值运算**：需要两种主要的数值运算：空间滤波和微分。\n    -   **滤波**：宽度为 $\\Delta = L h$ 的顶帽（箱式）滤波器实现为对一个 $L \\times L$ 网格点窗口的均匀平均。此操作遵守域的周期性边界条件，并可使用具有环绕模式（例如，`scipy.ndimage.uniform_filter` 的 `mode='wrap'`）的均匀滤波器函数高效地执行。\n    -   **微分**：空间导数（例如 $\\partial f/\\partial x$）使用周期性网格上的二阶中心有限差分格式计算。对于离散网格上的函数 $f$，在网格点 $(j, i)$ 处关于 $x$ 的导数近似为：\n    $$\n    \\frac{\\partial f}{\\partial x}\\bigg|_{(j,i)} \\approx \\frac{f_{j, i+1} - f_{j, i-1}}{2h}\n    $$\n    周期性索引通过环绕网格来处理（例如，$f_{j,N} = f_{j,0}$）。\n\n3.  **精确偏 SGS 应力（$\\tau'_{ij}$）的计算**：对于给定的滤波器宽度 $\\Delta$，精确的 SGS 应力按如下方式计算：\n    -   通过将 $L \\times L$ 箱式滤波器应用于 DNS 速度分量 $u_i$，得到滤波后的速度分量 $\\bar{u}_i$。\n    -   通过首先在 DNS 网格上计算乘积（例如，$u^2$，$uv$，$v^2$），然后应用相同的箱式滤波器，得到滤波后的速度乘积 $\\overline{u_i u_j}$。\n    -   SGS 应力张量的分量使用其定义计算：$\\tau_{ij} = \\overline{u_i u_j} - \\bar{u}_i \\bar{u}_j$。所需的分量是 $\\tau_{11}$、$\\tau_{12}$ 和 $\\tau_{22}$。\n    -   然后求出该张量的偏（无迹）部分 $\\tau'_{ij}$：\n    $$\n    \\tau'_{ij} = \\tau_{ij} - \\frac{1}{d}\\tau_{kk}\\delta_{ij} = \\tau_{ij} - \\frac{1}{2}(\\tau_{11} + \\tau_{22})\\delta_{ij}\n    $$\n    这就得到了用于先验测试的目标张量场。\n\n4.  **Smagorinsky 模型应力（$\\tau'^{\\text{Smag}}_{ij}$）的计算**：\n    -   从滤波后的速度场 $\\bar{\\mathbf{u}}$ 计算滤波后的应变率张量 $S_{ij}$：\n    $$\n    S_{ij} = \\frac{1}{2}\\left(\\frac{\\partial \\bar{u}_i}{\\partial x_j} + \\frac{\\partial \\bar{u}_j}{\\partial x_i}\\right)\n    $$\n    使用周期性中心差分格式。\n    -   应变率的大小计算为 $|\\boldsymbol{S}| = \\sqrt{2 S_{ij} S_{ij}}$。\n    -   在每个网格点计算涡粘性系数 $\\nu_t$：$\\nu_t = (C_s \\Delta)^2 \\, |\\boldsymbol{S}|$，其中 Smagorinsky 常数 $C_s=0.17$。\n    -   模拟的应力张量由 $\\tau^{\\text{Smag}}_{ij} = -2\\nu_t S_{ij}$ 给出。\n    -   最后，模拟应力的偏张量部分 $\\tau'^{\\text{Smag}}_{ij}$ 的计算方式与 $\\tau'_{ij}$ 的计算方式完全相同。\n\n5.  **梯度模型应力（$\\tau'^{\\text{Grad}}_{ij}$）的计算**：\n    -   该模型定义为 $\\tau^{\\text{Grad}}_{ij} = \\frac{\\Delta^2}{12}\\sum_{k=1}^{d} \\frac{\\partial \\bar{u}_i}{\\partial x_k}\\frac{\\partial \\bar{u}_j}{\\partial x_k}$。滤波后速度分量的必要导数使用中心差分计算。\n    -   分量 $\\tau^{\\text{Grad}}_{11}$、$\\tau^{\\text{Grad}}_{12}$ 和 $\\tau^{\\text{Grad}}_{22}$ 由这些导数计算得出。\n    -   通过减去各向同性分量得到其偏张量部分 $\\tau'^{\\text{Grad}}_{ij}$：$\\tau'^{\\text{Grad}}_{ij} = \\tau^{\\text{Grad}}_{ij} - \\frac{1}{d}\\tau^{\\text{Grad}}_{kk}\\delta_{ij}$。\n\n6.  **误差度量计算**：每个模型的性能由归一化误差度量 $E^{\\text{model}}(\\Delta)$ 量化：\n    $$\n    E^{\\text{model}}(\\Delta) = \\frac{\\left\\|\\tau'^{\\text{model}}_{ij} - \\tau'_{ij}\\right\\|_2}{\\left\\|\\tau'_{ij}\\right\\|_2}\n    $$\n    术语 $\\|\\cdot\\|_2$ 表示张量场的离散 $L^2$ 范数（或弗罗贝尼乌斯范数），即所有网格点上所有张量分量平方和的平方根。设 $T_{ij}$ 是网格上的一个张量场，其范数计算如下：\n    $$\n    \\|T_{ij}\\|_{2} = \\sqrt{\\sum_{p=0}^{N-1}\\sum_{q=0}^{N-1} \\sum_{i,j=1}^{d} (T_{ij})_{p,q}^2}\n    $$\n    对 Smagorinsky 和梯度模型，都针对每个滤波器尺寸 $L \\in \\{3, 7, 15, 31\\}$ 计算该误差度量。结果被收集并按规定格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.ndimage import uniform_filter\n\ndef solve():\n    \"\"\"\n    Performs an a priori test of the Smagorinsky and Gradient subgrid-scale models.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    N = 128\n    h = 1.0 / N\n    d = 2.0\n    A1, A2, A3 = 1.0, 0.5, 1.0 / 3.0\n    Cs = 0.17\n    L_values = [3, 7, 15, 31]\n    \n    # --- Grid Setup ---\n    # Create a grid [0, 1-h] x [0, 1-h]\n    x = np.linspace(0, 1, N, endpoint=False)\n    y = np.linspace(0, 1, N, endpoint=False)\n    xx, yy = np.meshgrid(x, y, indexing='xy')\n\n    # --- DNS Velocity Field Generation (Analytical) ---\n    pi = np.pi\n    u_dns = (A1 * 2*pi * np.sin(2*pi*xx) * np.cos(2*pi*yy) -\n             A2 * 2*pi * np.sin(4*pi*xx) * np.sin(2*pi*yy) +\n             A3 * 5*pi * np.cos(3*pi*xx) * np.cos(5*pi*yy))\n    \n    v_dns = -(A1 * 2*pi * np.cos(2*pi*xx) * np.sin(2*pi*yy) +\n              A2 * 4*pi * np.cos(4*pi*xx) * np.cos(2*pi*yy) -\n              A3 * 3*pi * np.sin(3*pi*xx) * np.sin(5*pi*yy))\n\n    # --- Helper Functions ---\n    def calculate_derivatives(field, grid_spacing):\n        \"\"\"Computes derivatives using periodic second-order central differences.\"\"\"\n        # For a field F[y, x], axis 0 is y, axis 1 is x.\n        # However, numpy's meshgrid with indexing='xy' makes xx shape (N,N)\n        # where xx[j,i] corresponds to x_i and yy[j,i] to y_j.\n        # This means field[j,i] is at (x_i, y_j).\n        # np.roll with axis=1 corresponds to x-direction.\n        # np.roll with axis=0 corresponds to y-direction.\n        dF_dx = (np.roll(field, -1, axis=1) - np.roll(field, 1, axis=1)) / (2 * grid_spacing)\n        dF_dy = (np.roll(field, -1, axis=0) - np.roll(field, 1, axis=0)) / (2 * grid_spacing)\n        return dF_dx, dF_dy\n\n    def calculate_norm(tensor_components):\n        \"\"\"Computes the L2 norm over all grid points and tensor components.\"\"\"\n        # tensor_components is a list of 4 2D arrays: T11, T12, T21, T22\n        return np.linalg.norm(np.stack(tensor_components))\n\n    results = []\n    \n    # --- Main Loop over Test Cases ---\n    for L in L_values:\n        Delta = L * h\n        \n        # --- 1. Compute Exact Deviatoric SGS Stress ---\n        \n        # Filter velocities using a box filter\n        u_bar = uniform_filter(u_dns, size=L, mode='wrap')\n        v_bar = uniform_filter(v_dns, size=L, mode='wrap')\n        \n        # Filter velocity products\n        uu_bar = uniform_filter(u_dns * u_dns, size=L, mode='wrap')\n        uv_bar = uniform_filter(u_dns * v_dns, size=L, mode='wrap')\n        vv_bar = uniform_filter(v_dns * v_dns, size=L, mode='wrap')\n        \n        # SGS stress tensor (tau_ij = overline(u_i u_j) - overline(u_i) overline(u_j))\n        tau_11 = uu_bar - u_bar * u_bar\n        tau_12 = uv_bar - u_bar * v_bar  # tau_21 = tau_12\n        tau_22 = vv_bar - v_bar * v_bar\n        \n        # Deviatoric part of exact stress\n        tau_kk = tau_11 + tau_22\n        tau_prime_exact_11 = tau_11 - (1.0/d) * tau_kk\n        tau_prime_exact_12 = tau_12\n        tau_prime_exact_21 = tau_12\n        tau_prime_exact_22 = tau_22 - (1.0/d) * tau_kk\n        \n        tau_prime_exact_components = [tau_prime_exact_11, tau_prime_exact_12, tau_prime_exact_21, tau_prime_exact_22]\n        norm_tau_prime_exact = calculate_norm(tau_prime_exact_components)\n\n        # --- 2. Compute Modeled Stresses ---\n        \n        # Derivatives of filtered velocity\n        du_bar_dx, du_bar_dy = calculate_derivatives(u_bar, h)\n        dv_bar_dx, dv_bar_dy = calculate_derivatives(v_bar, h)\n        \n        # --- 2a. Smagorinsky Model ---\n        S11 = du_bar_dx\n        S12 = 0.5 * (du_bar_dy + dv_bar_dx)\n        S22 = dv_bar_dy\n        S21 = S12\n\n        S_mag = np.sqrt(2 * (S11**2 + S12**2 + S21**2 + S22**2))\n        nu_t = (Cs * Delta)**2 * S_mag\n        \n        tau_smag_11 = -2 * nu_t * S11\n        tau_smag_12 = -2 * nu_t * S12\n        tau_smag_22 = -2 * nu_t * S22\n        \n        tau_smag_kk = tau_smag_11 + tau_smag_22\n        tau_prime_smag_11 = tau_smag_11 - (1.0/d) * tau_smag_kk\n        tau_prime_smag_12 = tau_smag_12\n        tau_prime_smag_21 = tau_smag_12\n        tau_prime_smag_22 = tau_smag_22 - (1.0/d) * tau_smag_kk\n        \n        # --- 2b. Gradient Model ---\n        factor = (Delta**2) / 12.0\n        \n        tau_grad_11 = factor * (du_bar_dx**2 + du_bar_dy**2)\n        tau_grad_12 = factor * (du_bar_dx * dv_bar_dx + du_bar_dy * dv_bar_dy)\n        tau_grad_22 = factor * (dv_bar_dx**2 + dv_bar_dy**2)\n        \n        tau_grad_kk = tau_grad_11 + tau_grad_22\n        tau_prime_grad_11 = tau_grad_11 - (1.0/d) * tau_grad_kk\n        tau_prime_grad_12 = tau_grad_12\n        tau_prime_grad_21 = tau_grad_12\n        tau_prime_grad_22 = tau_grad_22 - (1.0/d) * tau_grad_kk\n        \n        # --- 3. Compute Error Metrics ---\n        \n        # Smagorinsky Error\n        diff_smag_components = [\n            tau_prime_smag_11 - tau_prime_exact_11,\n            tau_prime_smag_12 - tau_prime_exact_12,\n            tau_prime_smag_21 - tau_prime_exact_21,\n            tau_prime_smag_22 - tau_prime_exact_22\n        ]\n        norm_diff_smag = calculate_norm(diff_smag_components)\n        E_smag = norm_diff_smag / norm_tau_prime_exact if norm_tau_prime_exact > 0 else 0\n        \n        # Gradient Error\n        diff_grad_components = [\n            tau_prime_grad_11 - tau_prime_exact_11,\n            tau_prime_grad_12 - tau_prime_exact_12,\n            tau_prime_grad_21 - tau_prime_exact_21,\n            tau_prime_grad_22 - tau_prime_exact_22\n        ]\n        norm_diff_grad = calculate_norm(diff_grad_components)\n        E_grad = norm_diff_grad / norm_tau_prime_exact if norm_tau_prime_exact > 0 else 0\n        \n        results.append(E_smag)\n        results.append(E_grad)\n        \n    # --- Final Output ---\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}