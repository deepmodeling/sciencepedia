{
    "hands_on_practices": [
        {
            "introduction": "The core of any Discrete Element Method (DEM) simulation is the time-stepping loop, where the laws of motion are applied repeatedly to predict the trajectory of each particle. This first exercise provides a direct, hands-on application of this fundamental process . By calculating the net forces and torques on a single particle and using an explicit time integration scheme, you will update its translational and rotational state, simulating one \"heartbeat\" of a DEM code.",
            "id": "3750282",
            "problem": "Consider a single spherical particle in a Discrete Element Method (DEM) simulation. The particle is modeled as a rigid sphere of mass $m$ and radius $r$, with a uniform mass distribution. Its center-of-mass position is $\\mathbf{x}(t)$, its translational velocity is $\\mathbf{v}(t)$, and its angular velocity is $\\boldsymbol{\\omega}(t)$. At time $t$, the particle experiences two contact forces and associated contact torques about its center, along with gravitational body force. All quantities are given in an inertial laboratory frame.\n\nData:\n- Mass: $m = 0.05\\,\\mathrm{kg}$.\n- Radius: $r = 0.02\\,\\mathrm{m}$.\n- Initial center-of-mass position: $\\mathbf{x}(t) = (0,\\,0,\\,0)\\,\\mathrm{m}$.\n- Initial translational velocity: $\\mathbf{v}(t) = (0.1,\\,-0.2,\\,0)\\,\\mathrm{m/s}$.\n- Initial angular velocity: $\\boldsymbol{\\omega}(t) = (10,\\,0,\\,-5)\\,\\mathrm{rad/s}$.\n- Gravitational acceleration: $\\mathbf{g} = (0,\\,0,\\,-9.81)\\,\\mathrm{m/s^2}$.\n- Contact force $1$: $\\mathbf{F}_1 = (20,\\,-10,\\,0)\\,\\mathrm{N}$.\n- Contact force $2$: $\\mathbf{F}_2 = (-5,\\,25,\\,0)\\,\\mathrm{N}$.\n- Contact torque $1$ (about the center): $\\boldsymbol{\\tau}_1 = (0.02,\\,0.00,\\,0.01)\\,\\mathrm{N\\,m}$.\n- Contact torque $2$ (about the center): $\\boldsymbol{\\tau}_2 = (-0.01,\\,0.03,\\,-0.02)\\,\\mathrm{N\\,m}$.\n- Explicit time-step: $\\Delta t = 1.0\\times 10^{-4}\\,\\mathrm{s}$.\n\nAssume the particle’s moment of inertia tensor is isotropic, with $I = \\frac{2}{5} m r^2$ for a solid sphere, and that the only forces and torques acting during the time-step are those listed above. Using fundamental laws (Newton’s second law for translation and rigid-body rotation), compute:\n1. The instantaneous translational acceleration $\\mathbf{a}(t)$ and rotational acceleration $\\boldsymbol{\\alpha}(t)$.\n2. The updated translational velocity $\\mathbf{v}(t+\\Delta t)$, angular velocity $\\boldsymbol{\\omega}(t+\\Delta t)$, and position $\\mathbf{x}(t+\\Delta t)$, using an explicit forward Euler update over the single time-step $\\Delta t$.\n\nFinally, compute the total kinetic energy at time $t+\\Delta t$,\n$$\nK(t+\\Delta t) \\;=\\; \\frac{1}{2}\\,m\\,\\|\\mathbf{v}(t+\\Delta t)\\|^2 \\;+\\; \\frac{1}{2}\\,I\\,\\|\\boldsymbol{\\omega}(t+\\Delta t)\\|^2,\n$$\nand provide its value rounded to four significant figures. Express the final energy in $\\mathrm{J}$. The final answer must be a single real number.",
            "solution": "We begin from first principles. For translation, Newton’s second law states that the net force equals mass times acceleration:\n$$\nm\\,\\mathbf{a}(t) \\;=\\; \\mathbf{F}_{\\text{net}}(t) \\;=\\; \\mathbf{F}_1 \\;+\\; \\mathbf{F}_2 \\;+\\; m\\,\\mathbf{g}.\n$$\nFor rotation of a rigid body about its center, the angular momentum rate equals the net torque. For a uniform solid sphere, the moment of inertia is isotropic with scalar $I = \\frac{2}{5} m r^2$, so\n$$\nI\\,\\boldsymbol{\\alpha}(t) \\;=\\; \\boldsymbol{\\tau}_{\\text{net}}(t) \\;=\\; \\boldsymbol{\\tau}_1 \\;+\\; \\boldsymbol{\\tau}_2.\n$$\n\nCompute the moment of inertia:\n$$\nI \\;=\\; \\frac{2}{5}\\,m\\,r^2 \\;=\\; \\frac{2}{5}\\times 0.05 \\times (0.02)^2 \\;=\\; 0.4 \\times 0.05 \\times 0.0004 \\;=\\; 8.0\\times 10^{-6}\\,\\mathrm{kg\\,m^2}.\n$$\n\nCompute the net force and translational acceleration. The gravitational force is $m\\,\\mathbf{g} = (0,\\,0,\\,-0.05\\times 9.81)\\,\\mathrm{N} = (0,\\,0,\\,-0.4905)\\,\\mathrm{N}$. Hence\n$$\n\\mathbf{F}_{\\text{net}} \\;=\\; \\mathbf{F}_1 \\;+\\; \\mathbf{F}_2 \\;+\\; m\\,\\mathbf{g}\n\\;=\\; (20,\\,-10,\\,0) \\;+\\; (-5,\\,25,\\,0) \\;+\\; (0,\\,0,\\,-0.4905)\n\\;=\\; (15,\\,15,\\,-0.4905)\\,\\mathrm{N}.\n$$\nTherefore,\n$$\n\\mathbf{a}(t) \\;=\\; \\frac{\\mathbf{F}_{\\text{net}}}{m} \\;=\\; \\frac{(15,\\,15,\\,-0.4905)}{0.05}\n\\;=\\; (300,\\,300,\\,-9.81)\\,\\mathrm{m/s^2}.\n$$\n\nCompute the net torque and rotational acceleration:\n$$\n\\boldsymbol{\\tau}_{\\text{net}} \\;=\\; \\boldsymbol{\\tau}_1 \\;+\\; \\boldsymbol{\\tau}_2 \\;=\\; (0.02,\\,0.00,\\,0.01) \\;+\\; (-0.01,\\,0.03,\\,-0.02) \\;=\\; (0.01,\\,0.03,\\,-0.01)\\,\\mathrm{N\\,m},\n$$\nso\n$$\n\\boldsymbol{\\alpha}(t) \\;=\\; \\frac{\\boldsymbol{\\tau}_{\\text{net}}}{I} \\;=\\; \\frac{(0.01,\\,0.03,\\,-0.01)}{8.0\\times 10^{-6}}\n\\;=\\; (1250,\\,3750,\\,-1250)\\,\\mathrm{rad/s^2}.\n$$\n\nUpdate the state over one explicit forward Euler step of size $\\Delta t = 1.0\\times 10^{-4}\\,\\mathrm{s}$:\n- Translational velocity:\n$$\n\\mathbf{v}(t+\\Delta t) \\;=\\; \\mathbf{v}(t) \\;+\\; \\mathbf{a}(t)\\,\\Delta t\n\\;=\\; (0.1,\\,-0.2,\\,0) \\;+\\; (300,\\,300,\\,-9.81)\\times (1.0\\times 10^{-4})\n\\;=\\; (0.13,\\,-0.17,\\,-9.81\\times 10^{-4})\\,\\mathrm{m/s}.\n$$\nNumerically, $\\mathbf{v}(t+\\Delta t) = (0.13,\\,-0.17,\\,-0.000981)\\,\\mathrm{m/s}$.\n- Position:\n$$\n\\mathbf{x}(t+\\Delta t) \\;=\\; \\mathbf{x}(t) \\;+\\; \\mathbf{v}(t)\\,\\Delta t\n\\;=\\; (0,\\,0,\\,0) \\;+\\; (0.1,\\,-0.2,\\,0)\\times (1.0\\times 10^{-4})\n\\;=\\; (1.0\\times 10^{-5},\\,-2.0\\times 10^{-5},\\,0)\\,\\mathrm{m}.\n$$\n- Angular velocity:\n$$\n\\boldsymbol{\\omega}(t+\\Delta t) \\;=\\; \\boldsymbol{\\omega}(t) \\;+\\; \\boldsymbol{\\alpha}(t)\\,\\Delta t\n\\;=\\; (10,\\,0,\\,-5) \\;+\\; (1250,\\,3750,\\,-1250)\\times (1.0\\times 10^{-4})\n\\;=\\; (10.125,\\,0.375,\\,-5.125)\\,\\mathrm{rad/s}.\n$$\n\nCompute the total kinetic energy at $t+\\Delta t$:\n$$\nK(t+\\Delta t) \\;=\\; \\frac{1}{2}\\,m\\,\\|\\mathbf{v}(t+\\Delta t)\\|^2 \\;+\\; \\frac{1}{2}\\,I\\,\\|\\boldsymbol{\\omega}(t+\\Delta t)\\|^2.\n$$\nFirst, the translational part:\n$$\n\\|\\mathbf{v}(t+\\Delta t)\\|^2 \\;=\\; (0.13)^2 \\;+\\; (-0.17)^2 \\;+\\; (-0.000981)^2\n\\;=\\; 0.0169 \\;+\\; 0.0289 \\;+\\; 9.62361\\times 10^{-7}\n\\;=\\; 0.045800962361.\n$$\nThus,\n$$\n\\frac{1}{2}\\,m\\,\\|\\mathbf{v}(t+\\Delta t)\\|^2 \\;=\\; \\frac{1}{2}\\times 0.05 \\times 0.045800962361 \\;=\\; 0.001145024059025\\,\\mathrm{J}.\n$$\nNext, the rotational part:\n$$\n\\|\\boldsymbol{\\omega}(t+\\Delta t)\\|^2 \\;=\\; (10.125)^2 \\;+\\; (0.375)^2 \\;+\\; (-5.125)^2\n\\;=\\; 102.515625 \\;+\\; 0.140625 \\;+\\; 26.265625 \\;=\\; 128.921875,\n$$\nso\n$$\n\\frac{1}{2}\\,I\\,\\|\\boldsymbol{\\omega}(t+\\Delta t)\\|^2 \\;=\\; \\frac{1}{2}\\times 8.0\\times 10^{-6} \\times 128.921875\n\\;=\\; 4.0\\times 10^{-6} \\times 128.921875 \\;=\\; 5.156875\\times 10^{-4}\\,\\mathrm{J}.\n$$\nTherefore,\n$$\nK(t+\\Delta t) \\;=\\; 0.001145024059025 \\;+\\; 0.0005156875 \\;=\\; 0.001660711559025\\,\\mathrm{J}.\n$$\n\nRounded to four significant figures, the total kinetic energy is\n$$\nK(t+\\Delta t) \\;\\approx\\; 0.001661\\,\\mathrm{J}.\n$$",
            "answer": "$$\\boxed{0.001661}$$"
        },
        {
            "introduction": "Having established how to update a particle's motion, we now turn to the origin of the interaction forces: contact. This practice explores the normal component of the contact force during a collision using the common linear spring-dashpot model . You will derive the governing equation for the collision, analyze the energy dissipated, and connect the microscopic model parameters ($k_n, c_n$) to the macroscopic coefficient of restitution ($e$), providing a crucial link between model inputs and physical reality.",
            "id": "3750261",
            "problem": "Consider a head-on collision between two spherical particles modeled by the Discrete Element Method (DEM), where the normal contact is represented by a linear Kelvin–Voigt element (a linear spring and dashpot in parallel). Let the first particle have mass $m_1 = 0.20\\,\\mathrm{kg}$ and the second particle have mass $m_2 = 0.30\\,\\mathrm{kg}$. The normal contact stiffness is $k_n = 1.0 \\times 10^{5}\\,\\mathrm{N/m}$ and the normal viscous damping coefficient is $c_n = 50\\,\\mathrm{N\\,s/m}$. The particles approach along their line of centers with initial relative normal velocity $v_0 = 1.0\\,\\mathrm{m/s}$, and there are no tangential forces.\n\nAdopt the standard reduction to a single degree of freedom for the normal overlap $x(t)$ using the effective mass $m_{\\mathrm{eff}} = \\frac{m_1 m_2}{m_1 + m_2}$, and assume the collision is underdamped and ends at the first separation time when the overlap returns to zero. Starting only from Newton’s Second Law, Hooke’s law for the spring, and the dashpot constitutive relation, do the following:\n\n- Derive the governing ordinary differential equation for $x(t)$ and the associated mechanical energy $E(t)$ in terms of $m_{\\mathrm{eff}}$, $k_n$, $c_n$, $x(t)$, and $\\dot{x}(t)$.\n- Use first principles to obtain an expression for the energy dissipated per collision, $E_{\\mathrm{diss}}$, in terms of the initial and rebound states. Express your answer in Joules.\n- Define the coefficient of restitution $e$ as the ratio of the magnitude of the rebound relative normal speed to the magnitude of the approach relative normal speed, and derive $e$ for this linear dashpot–spring model. Use it to construct the restitution-based estimate of the dissipated energy and verify that it is consistent with your energy-based derivation.\n\nCompute the numerical value of $E_{\\mathrm{diss}}$ for the given parameters. Round your final numerical answer to four significant figures. Express the energy in Joules.",
            "solution": "The problem describes a one-dimensional head-on collision between two particles, which can be reduced to a single-degree-of-freedom system. The state of this system is described by the normal overlap between the particles, denoted by $x(t)$. The dynamics are governed by an effective mass $m_{\\mathrm{eff}}$ interacting through a Kelvin-Voigt contact model.\n\nFirst, we calculate the effective mass $m_{\\mathrm{eff}}$ of the two-particle system. Given the masses $m_1 = 0.20\\,\\mathrm{kg}$ and $m_2 = 0.30\\,\\mathrm{kg}$:\n$$\nm_{\\mathrm{eff}} = \\frac{m_1 m_2}{m_1 + m_2} = \\frac{(0.20\\,\\mathrm{kg})(0.30\\,\\mathrm{kg})}{0.20\\,\\mathrm{kg} + 0.30\\,\\mathrm{kg}} = \\frac{0.06\\,\\mathrm{kg}^2}{0.50\\,\\mathrm{kg}} = 0.12\\,\\mathrm{kg}\n$$\n\nNext, we derive the governing ordinary differential equation (ODE). The contact force $F_c(t)$ in a linear Kelvin-Voigt model is the sum of a linear spring force and a linear viscous damping force. According to Hooke's law, the spring force is $F_s = -k_n x(t)$, where $k_n$ is the normal stiffness. The dashpot constitutive relation gives the damping force as $F_d = -c_n \\dot{x}(t)$, where $c_n$ is the normal viscous damping coefficient and $\\dot{x}(t)$ is the rate of change of overlap (the relative normal velocity). The total contact force is:\n$$\nF_c(t) = F_s + F_d = -k_n x(t) - c_n \\dot{x}(t)\n$$\nThe negative signs indicate that the forces oppose compression ($x > 0$) and the rate of compression ($\\dot{x} > 0$). Applying Newton's Second Law to the effective mass, $F_c(t) = m_{\\mathrm{eff}} \\ddot{x}(t)$, we obtain the governing ODE:\n$$\nm_{\\mathrm{eff}} \\ddot{x}(t) + c_n \\dot{x}(t) + k_n x(t) = 0\n$$\nThis is the equation for a damped harmonic oscillator. The collision starts at time $t=0$ when the particles first touch, so the initial conditions are $x(0) = 0$ and $\\dot{x}(0) = v_0$, where $v_0 = 1.0\\,\\mathrm{m/s}$ is the initial relative approach speed.\n\nThe mechanical energy $E(t)$ of the system at any time $t$ during the contact is the sum of the kinetic energy of the effective mass, $K(t) = \\frac{1}{2} m_{\\mathrm{eff}} \\dot{x}(t)^2$, and the potential energy stored in the linear spring, $U(t) = \\frac{1}{2} k_n x(t)^2$. Therefore,\n$$\nE(t) = K(t) + U(t) = \\frac{1}{2} m_{\\mathrm{eff}} \\dot{x}(t)^2 + \\frac{1}{2} k_n x(t)^2\n$$\nThe rate of change of mechanical energy is found by differentiating $E(t)$ with respect to time:\n$$\n\\frac{dE}{dt} = m_{\\mathrm{eff}} \\dot{x}(t) \\ddot{x}(t) + k_n x(t) \\dot{x}(t) = \\dot{x}(t) (m_{\\mathrm{eff}} \\ddot{x}(t) + k_n x(t))\n$$\nFrom the governing ODE, we have $m_{\\mathrm{eff}} \\ddot{x}(t) + k_n x(t) = -c_n \\dot{x}(t)$. Substituting this in, we find:\n$$\n\\frac{dE}{dt} = \\dot{x}(t) (-c_n \\dot{x}(t)) = -c_n \\dot{x}(t)^2\n$$\nThis shows that the rate of change of mechanical energy is equal to the power dissipated by the dashpot, as expected.\n\nThe total energy dissipated during the collision, $E_{\\mathrm{diss}}$, is the change in the system's mechanical energy from the beginning of the collision ($t=0$) to the end ($t=t_f$). The collision ends when the particles separate, which is the first time $t_f > 0$ that the overlap $x(t_f)$ returns to zero.\nAt $t=0$: $x(0) = 0$ and $\\dot{x}(0) = v_0$. The initial energy is purely kinetic:\n$$\nE(0) = \\frac{1}{2} m_{\\mathrm{eff}} v_0^2 + \\frac{1}{2} k_n (0)^2 = \\frac{1}{2} m_{\\mathrm{eff}} v_0^2\n$$\nAt $t=t_f$: $x(t_f) = 0$. The rebound relative speed is $v_r = |\\dot{x}(t_f)|$. Since the particles are moving apart, $\\dot{x}(t_f) = -v_r$. The final energy is also purely kinetic:\n$$\nE(t_f) = \\frac{1}{2} m_{\\mathrm{eff}} (-v_r)^2 + \\frac{1}{2} k_n (0)^2 = \\frac{1}{2} m_{\\mathrm{eff}} v_r^2\n$$\nThe dissipated energy is the initial energy minus the final energy:\n$$\nE_{\\mathrm{diss}} = E(0) - E(t_f) = \\frac{1}{2} m_{\\mathrm{eff}} v_0^2 - \\frac{1}{2} m_{\\mathrm{eff}} v_r^2 = \\frac{1}{2} m_{\\mathrm{eff}}(v_0^2 - v_r^2)\n$$\nTo compute $E_{\\mathrm{diss}}$, we need $v_r$, which requires solving the ODE. The solution to the underdamped harmonic oscillator ODE is found by defining the natural frequency $\\omega_n = \\sqrt{k_n / m_{\\mathrm{eff}}}$ and the damping ratio $\\zeta = \\frac{c_n}{2 \\sqrt{m_{\\mathrm{eff}} k_n}}$. The solution for $x(t)$ with initial conditions $x(0) = 0$ and $\\dot{x}(0)=v_0$ is:\n$$\nx(t) = \\frac{v_0}{\\omega_d} \\exp(-\\zeta \\omega_n t) \\sin(\\omega_d t)\n$$\nwhere $\\omega_d = \\omega_n \\sqrt{1 - \\zeta^2}$ is the damped natural frequency. The collision ends at time $t_f$ when $\\omega_d t_f = \\pi$, so $t_f = \\pi / \\omega_d$. The velocity $\\dot{x}(t)$ is:\n$$\n\\dot{x}(t) = v_0 \\exp(-\\zeta \\omega_n t) \\left( \\cos(\\omega_d t) - \\frac{\\zeta}{\\sqrt{1-\\zeta^2}} \\sin(\\omega_d t) \\right)\n$$\nEvaluating at $t_f = \\pi / \\omega_d$:\n$$\n\\dot{x}(t_f) = v_0 \\exp(-\\zeta \\omega_n \\frac{\\pi}{\\omega_d}) \\left( \\cos(\\pi) - \\frac{\\zeta}{\\sqrt{1-\\zeta^2}} \\sin(\\pi) \\right) = -v_0 \\exp\\left(-\\frac{\\zeta \\pi}{\\sqrt{1-\\zeta^2}}\\right)\n$$\nThe rebound speed is $v_r = |\\dot{x}(t_f)| = v_0 \\exp\\left(-\\frac{\\zeta \\pi}{\\sqrt{1-\\zeta^2}}\\right)$.\n\nThe coefficient of restitution $e$ is defined as the ratio of the rebound speed to the approach speed:\n$$\ne = \\frac{v_r}{v_0} = \\exp\\left(-\\frac{\\zeta \\pi}{\\sqrt{1-\\zeta^2}}\\right)\n$$\nThe restitution-based estimate of dissipated energy is derived by substituting $v_r = e v_0$ into our energy-based expression for $E_{\\mathrm{diss}}$:\n$$\nE_{\\mathrm{diss}} = \\frac{1}{2} m_{\\mathrm{eff}}(v_0^2 - (e v_0)^2) = \\frac{1}{2} m_{\\mathrm{eff}} v_0^2 (1 - e^2)\n$$\nThis confirms the consistency between the two approaches.\n\nNow, we compute the numerical value of $E_{\\mathrm{diss}}$.\nThe given parameters are $k_n = 1.0 \\times 10^5\\,\\mathrm{N/m}$, $c_n = 50\\,\\mathrm{N\\,s/m}$, and $v_0 = 1.0\\,\\mathrm{m/s}$. We already found $m_{\\mathrm{eff}} = 0.12\\,\\mathrm{kg}$.\nFirst, we check if the system is underdamped by evaluating $c_n^2$ versus $4 m_{\\mathrm{eff}} k_n$:\n$c_n^2 = (50)^2 = 2500$\n$4 m_{\\mathrm{eff}} k_n = 4 (0.12) (1.0 \\times 10^5) = 48000$\nSince $2500 < 48000$, the system is indeed underdamped, and the derived equations are valid.\n\nNext, we calculate the damping ratio $\\zeta$:\n$$\n\\zeta = \\frac{c_n}{2 \\sqrt{m_{\\mathrm{eff}} k_n}} = \\frac{50}{2 \\sqrt{48000/4}} = \\frac{50}{2\\sqrt{12000}} = \\frac{25}{\\sqrt{12000}} \\approx 0.2282177\n$$\nNow, we can compute the coefficient of restitution $e$:\n$$\ne = \\exp\\left(-\\frac{\\zeta \\pi}{\\sqrt{1-\\zeta^2}}\\right) = \\exp\\left(-\\frac{(0.2282177) \\pi}{\\sqrt{1-(0.2282177)^2}}\\right) \\approx \\exp\\left(-\\frac{0.71696}{0.97361}\\right) \\approx \\exp(-0.73639) \\approx 0.47883\n$$\nFinally, we compute the dissipated energy $E_{\\mathrm{diss}}$:\n$$\nE_{\\mathrm{diss}} = \\frac{1}{2} m_{\\mathrm{eff}} v_0^2 (1 - e^2) = \\frac{1}{2} (0.12\\,\\mathrm{kg}) (1.0\\,\\mathrm{m/s})^2 (1 - (0.47883)^2)\n$$\n$$\nE_{\\mathrm{diss}} = 0.06 \\times (1 - 0.229278) = 0.06 \\times 0.770722 \\approx 0.0462433\\,\\mathrm{J}\n$$\nRounding the final answer to four significant figures gives $0.04624\\,\\mathrm{J}$.",
            "answer": "$$\n\\boxed{0.04624}\n$$"
        },
        {
            "introduction": "To create realistic simulations of granular assemblies, we must also account for tangential forces and friction, which prevent particles from sliding past each other without resistance. This advanced exercise introduces a robust and widely used method for modeling tangential contact, incorporating an elastic spring to track \"stick\" history and enforcing the Coulomb friction limit using a return mapping algorithm . Mastering this practice is essential for accurately simulating phenomena like pile stability and shear banding, where friction plays a dominant role.",
            "id": "4095033",
            "problem": "You are modeling a single tangential contact in the Discrete Element Method (DEM). The contact obeys Newton's laws and Coulomb friction. The tangential contact force is modeled as a linear elastic spring integrated from the slip velocity in the tangential plane, with a Coulomb friction limit. Starting from the fundamental relations that time integration accumulates displacement from velocity and that friction is bounded by the Coulomb limit, derive and implement the update for the tangential elastic spring displacement and the resulting tangential force. Specifically, for a given contact with normal force $F_n \\ge 0$ (compressive positive), friction coefficient $\\mu \\ge 0$, tangential stiffness $k_t > 0$, time step $\\Delta t > 0$, tangential slip velocity vector $\\boldsymbol{v}_t$ in the local tangential plane, and previous tangential spring displacement vector $\\boldsymbol{\\xi}^{old}$ in the same plane, compute the updated tangential spring displacement $\\boldsymbol{\\xi}^{new}$ and the tangential contact force $\\boldsymbol{F}_t$, enforcing the Coulomb limit.\n\nFundamental base to use:\n- Newton's Second Law and kinematics: velocity integrates to displacement, so the elastic spring displacement evolves according to $\\dfrac{d\\boldsymbol{\\xi}}{dt} = \\boldsymbol{v}_t$.\n- Linear elastic tangential force: $\\boldsymbol{F}_t = -k_t \\boldsymbol{\\xi}$.\n- Coulomb friction: $\\lVert \\boldsymbol{F}_t \\rVert \\le \\mu F_n$ and, under sliding, $\\boldsymbol{F}_t$ is directed opposite the slip tendency in the tangential plane.\n\nYour program must:\n1. Perform an explicit time integration trial update of the tangential spring displacement using $\\boldsymbol{\\xi}^{trial} = \\boldsymbol{\\xi}^{old} + \\boldsymbol{v}_t \\Delta t$.\n2. Compute the corresponding trial tangential force $\\boldsymbol{F}_t^{trial} = -k_t \\boldsymbol{\\xi}^{trial}$.\n3. Enforce the Coulomb friction limit by projecting back to the admissible set when necessary:\n   - If $F_n \\le 0$ then the contact is non-load bearing, and set $\\boldsymbol{\\xi}^{new} = \\boldsymbol{0}$ and $\\boldsymbol{F}_t = \\boldsymbol{0}$.\n   - Else if $\\lVert \\boldsymbol{F}_t^{trial} \\rVert \\le \\mu F_n$, then set $\\boldsymbol{\\xi}^{new} = \\boldsymbol{\\xi}^{trial}$ and $\\boldsymbol{F}_t = \\boldsymbol{F}_t^{trial}$ (stick).\n   - Else (slide), rescale the trial state to the Coulomb surface by setting $\\boldsymbol{\\xi}^{new} = \\boldsymbol{\\xi}^{trial} \\dfrac{\\mu F_n}{\\lVert \\boldsymbol{F}_t^{trial} \\rVert}$ and $\\boldsymbol{F}_t = -k_t \\boldsymbol{\\xi}^{new}$. This enforces $\\lVert \\boldsymbol{F}_t \\rVert = \\mu F_n$ with $\\boldsymbol{F}_t$ aligned with the trial direction in the tangential plane.\n\nAll vectors are two-dimensional in the local tangential plane. Use the International System of Units: express $\\boldsymbol{\\xi}^{new}$ in $\\mathrm{m}$ and $\\boldsymbol{F}_t$ in $\\mathrm{N}$. No angles are required. The numerical output shall be expressed as raw decimal floats.\n\nTest suite:\nProvide the following six test cases, each specified by $(F_n, \\mu, k_t, \\Delta t, \\boldsymbol{v}_t, \\boldsymbol{\\xi}^{old})$ with the given units:\n- Case $1$ (stick, small increment): $F_n = 100\\,\\mathrm{N}$, $\\mu = 0.5$, $k_t = 10^4\\,\\mathrm{N/m}$, $\\Delta t = 10^{-3}\\,\\mathrm{s}$, $\\boldsymbol{v}_t = [0.01, 0]\\,\\mathrm{m/s}$, $\\boldsymbol{\\xi}^{old} = [0, 0]\\,\\mathrm{m}$.\n- Case $2$ (slide, large increment): $F_n = 100\\,\\mathrm{N}$, $\\mu = 0.5$, $k_t = 10^4\\,\\mathrm{N/m}$, $\\Delta t = 10^{-3}\\,\\mathrm{s}$, $\\boldsymbol{v}_t = [10, 0]\\,\\mathrm{m/s}$, $\\boldsymbol{\\xi}^{old} = [0, 0]\\,\\mathrm{m}$.\n- Case $3$ (boundary, exactly at limit): $F_n = 100\\,\\mathrm{N}$, $\\mu = 0.5$, $k_t = 10^4\\,\\mathrm{N/m}$, $\\Delta t = 10^{-3}\\,\\mathrm{s}$, $\\boldsymbol{v}_t = [5, 0]\\,\\mathrm{m/s}$, $\\boldsymbol{\\xi}^{old} = [0, 0]\\,\\mathrm{m}$.\n- Case $4$ (no contact): $F_n = 0\\,\\mathrm{N}$, $\\mu = 0.5$, $k_t = 10^4\\,\\mathrm{N/m}$, $\\Delta t = 10^{-3}\\,\\mathrm{s}$, $\\boldsymbol{v}_t = [100, -100]\\,\\mathrm{m/s}$, $\\boldsymbol{\\xi}^{old} = [0, 0]\\,\\mathrm{m}$.\n- Case $5$ (stick with oblique update): $F_n = 10\\,\\mathrm{N}$, $\\mu = 0.3$, $k_t = 2 \\times 10^4\\,\\mathrm{N/m}$, $\\Delta t = 2 \\times 10^{-3}\\,\\mathrm{s}$, $\\boldsymbol{v}_t = [0.003, -0.004]\\,\\mathrm{m/s}$, $\\boldsymbol{\\xi}^{old} = [10^{-4}, 0]\\,\\mathrm{m}$.\n- Case $6$ (return mapping with preloaded spring): $F_n = 5\\,\\mathrm{N}$, $\\mu = 0.2$, $k_t = 10^4\\,\\mathrm{N/m}$, $\\Delta t = 10^{-3}\\,\\mathrm{s}$, $\\boldsymbol{v}_t = [0, 0]\\,\\mathrm{m/s}$, $\\boldsymbol{\\xi}^{old} = [10^{-2}, 10^{-2}]\\,\\mathrm{m}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the list $[\\xi_x, \\xi_y, F_{t,x}, F_{t,y}]$ for the corresponding test case in SI units (for example, $[[\\dots],[\\dots],\\dots]$). Each numerical entry must be a decimal float.",
            "solution": "The problem requires the derivation and implementation of a numerical algorithm to update the tangential force and spring displacement at a single frictional contact, as commonly modeled in the Discrete Element Method (DEM). The model is based on a linear tangential spring and the Coulomb friction law. The problem is well-posed, scientifically sound, and provides all necessary information to construct a unique solution.\n\nThe physical state of the contact is described by the tangential spring displacement vector $\\boldsymbol{\\xi}$ in the local $2$D tangential plane. The tangential force $\\boldsymbol{F}_t$ is assumed to be linearly proportional to this displacement:\n$$\n\\boldsymbol{F}_t = -k_t \\boldsymbol{\\xi}\n$$\nwhere $k_t > 0$ is the tangential stiffness.\n\nThe evolution of the spring displacement is governed by the relative tangential velocity (slip velocity) $\\boldsymbol{v}_t$ between the contacting surfaces. The rate of change of the elastic displacement is equal to the slip velocity:\n$$\n\\frac{d\\boldsymbol{\\xi}}{dt} = \\boldsymbol{v}_t\n$$\n\nThe magnitude of the tangential force is limited by the Coulomb friction criterion. The tangential force must lie within an admissible set, a disk in the tangential plane defined by:\n$$\n\\lVert \\boldsymbol{F}_t \\rVert \\le \\mu F_n\n$$\nwhere $F_n \\ge 0$ is the compressive normal force and $\\mu \\ge 0$ is the coefficient of static friction. When the force magnitude reaches the limit, $\\lVert \\boldsymbol{F}_t \\rVert = \\mu F_n$, the contact is in a state of gross sliding, and the tangential force vector must oppose the direction of slip velocity.\n\nThe algorithm to be implemented is an explicit time-stepping scheme of the predictor-corrector type, often referred to as a \"return mapping\" algorithm in computational plasticity and contact mechanics. Given the state at the beginning of a time step $\\Delta t > 0$ (represented by $\\boldsymbol{\\xi}^{old}$), the goal is to compute the state at the end of the step, $\\boldsymbol{\\xi}^{new}$ and $\\boldsymbol{F}_t$.\n\n**Step 1: Trial (Predictor) Step**\nFirst, we discretize the evolution equation for $\\boldsymbol{\\xi}$ using a forward Euler scheme. This yields a trial displacement, $\\boldsymbol{\\xi}^{trial}$, which assumes purely elastic behavior throughout the time step $\\Delta t$:\n$$\n\\boldsymbol{\\xi}^{trial} = \\boldsymbol{\\xi}^{old} + \\boldsymbol{v}_t \\Delta t\n$$\nFrom this trial displacement, a corresponding trial tangential force, $\\boldsymbol{F}_t^{trial}$, is computed:\n$$\n\\boldsymbol{F}_t^{trial} = -k_t \\boldsymbol{\\xi}^{trial}\n$$\n\n**Step 2: Constraint Enforcement (Corrector) Step**\nNext, the trial state is checked against the Coulomb friction constraint. There are three possible outcomes:\n\n**Case A: No Contact**\nIf the normal force $F_n \\le 0$, the contact is not active or is tensile. In DEM for granular materials, tensile forces are typically not supported, and any existing tangential \"memory\" in the spring is lost. Therefore, the tangential displacement and force are reset to zero.\n$$\n\\boldsymbol{\\xi}^{new} = \\boldsymbol{0} \\quad \\text{and} \\quad \\boldsymbol{F}_t = \\boldsymbol{0}\n$$\n\n**Case B: Stick Condition**\nIf the contact is active ($F_n > 0$) and the magnitude of the trial force is within the admissible friction disk, the purely elastic assumption holds. This is the \"stick\" condition.\n$$\n\\text{If } \\lVert \\boldsymbol{F}_t^{trial} \\rVert \\le \\mu F_n, \\text{ then the contact sticks.}\n$$\nIn this case, the trial values are accepted as the final values for the new state:\n$$\n\\boldsymbol{\\xi}^{new} = \\boldsymbol{\\xi}^{trial}\n$$\n$$\n\\boldsymbol{F}_t = \\boldsymbol{F}_t^{trial}\n$$\n\n**Case C: Slip Condition**\nIf the contact is active ($F_n > 0$) and the magnitude of the trial force exceeds the friction limit, the elastic assumption is invalid. The contact must slip, and the tangential force must lie on the boundary of the friction disk (the \"friction circle\").\n$$\n\\text{If } \\lVert \\boldsymbol{F}_t^{trial} \\rVert > \\mu F_n, \\text{ then the contact slips.}\n$$\nThe corrected force $\\boldsymbol{F}_t$ must have a magnitude of exactly $\\mu F_n$ and must point in the same direction as the trial force $\\boldsymbol{F}_t^{trial}$. This is achieved by radially scaling the trial force vector back to the friction circle. The scaling factor is the ratio of the maximum allowable force magnitude to the trial force magnitude.\n$$\n\\boldsymbol{F}_t = \\boldsymbol{F}_t^{trial} \\frac{\\mu F_n}{\\lVert \\boldsymbol{F}_t^{trial} \\rVert}\n$$\nThe norm of this new force is $\\lVert \\boldsymbol{F}_t \\rVert = \\left\\lVert \\boldsymbol{F}_t^{trial} \\frac{\\mu F_n}{\\lVert \\boldsymbol{F}_t^{trial} \\rVert} \\right\\rVert = \\lVert \\boldsymbol{F}_t^{trial} \\rVert \\frac{\\mu F_n}{\\lVert \\boldsymbol{F}_t^{trial} \\rVert} = \\mu F_n$, as required.\nSince the force and displacement are linearly related by the constant $-k_t$, the final displacement $\\boldsymbol{\\xi}^{new}$ is obtained by applying the same scaling factor to the trial displacement $\\boldsymbol{\\xi}^{trial}$:\n$$\n\\boldsymbol{\\xi}^{new} = \\boldsymbol{\\xi}^{trial} \\frac{\\mu F_n}{\\lVert \\boldsymbol{F}_t^{trial} \\rVert}\n$$\nThe final force can then be computed consistently as $\\boldsymbol{F}_t = -k_t \\boldsymbol{\\xi}^{new}$.\n\nThis predictor-corrector algorithm robustly and efficiently enforces the non-smooth, non-linear Coulomb friction law within an explicit DEM time-stepping framework. We will now implement this procedure for the given test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the DEM tangential contact problem for a suite of test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (stick, small increment)\n        {'Fn': 100.0, 'mu': 0.5, 'kt': 1e4, 'dt': 1e-3, 'vt': [0.01, 0.0], 'xi_old': [0.0, 0.0]},\n        # Case 2 (slide, large increment)\n        {'Fn': 100.0, 'mu': 0.5, 'kt': 1e4, 'dt': 1e-3, 'vt': [10.0, 0.0], 'xi_old': [0.0, 0.0]},\n        # Case 3 (boundary, exactly at limit)\n        {'Fn': 100.0, 'mu': 0.5, 'kt': 1e4, 'dt': 1e-3, 'vt': [5.0, 0.0], 'xi_old': [0.0, 0.0]},\n        # Case 4 (no contact)\n        {'Fn': 0.0, 'mu': 0.5, 'kt': 1e4, 'dt': 1e-3, 'vt': [100.0, -100.0], 'xi_old': [0.0, 0.0]},\n        # Case 5 (stick with oblique update)\n        {'Fn': 10.0, 'mu': 0.3, 'kt': 2e4, 'dt': 2e-3, 'vt': [0.003, -0.004], 'xi_old': [1e-4, 0.0]},\n        # Case 6 (return mapping with preloaded spring)\n        {'Fn': 5.0, 'mu': 0.2, 'kt': 1e4, 'dt': 1e-3, 'vt': [0.0, 0.0], 'xi_old': [1e-2, 1e-2]},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = update_tangential_contact(\n            case['Fn'], case['mu'], case['kt'], case['dt'],\n            np.array(case['vt']), np.array(case['xi_old'])\n        )\n        results.append(result)\n\n    # Format the final output string exactly as required\n    inner_parts = [f\"[{r[0]},{r[1]},{r[2]},{r[3]}]\" for r in results]\n    final_string = f\"[{','.join(inner_parts)}]\"\n    print(final_string)\n\ndef update_tangential_contact(Fn, mu, kt, dt, vt, xi_old):\n    \"\"\"\n    Computes the updated tangential spring displacement and contact force.\n\n    Args:\n        Fn (float): Normal force (N).\n        mu (float): Friction coefficient.\n        kt (float): Tangential stiffness (N/m).\n        dt (float): Time step (s).\n        vt (np.ndarray): Tangential slip velocity vector (m/s).\n        xi_old (np.ndarray): Previous tangential spring displacement vector (m).\n\n    Returns:\n        list: A list containing [xi_new_x, xi_new_y, Ft_x, Ft_y].\n    \"\"\"\n    # Case: No contact\n    if Fn <= 0:\n        xi_new = np.zeros(2)\n        Ft = np.zeros(2)\n        return xi_new.tolist() + Ft.tolist()\n\n    # Step 1: Trial update (predictor)\n    xi_trial = xi_old + vt * dt\n\n    # Step 2: Compute trial force\n    Ft_trial = -kt * xi_trial\n\n    # Compute magnitude of trial force\n    norm_Ft_trial = np.linalg.norm(Ft_trial)\n\n    # Compute friction limit\n    friction_limit = mu * Fn\n\n    # Step 3: Enforce Coulomb friction limit (corrector)\n    # Case: Stick condition\n    if norm_Ft_trial <= friction_limit:\n        xi_new = xi_trial\n        Ft = Ft_trial\n    # Case: Slip condition\n    else:\n        # The return mapping requires division by the norm of the trial force.\n        # This is safe because if norm_Ft_trial were 0, the 'if' condition\n        # (0 <= friction_limit) would have been true (since mu*Fn >= 0).\n        scaling_factor = friction_limit / norm_Ft_trial\n        xi_new = xi_trial * scaling_factor\n        # The final force can be calculated either by scaling Ft_trial or\n        # by using the new displacement. The latter is more robust to\n        # potential floating point inconsistencies.\n        Ft = -kt * xi_new\n\n    # Return the result as a list of floats\n    return xi_new.tolist() + Ft.tolist()\n\nsolve()\n```"
        }
    ]
}