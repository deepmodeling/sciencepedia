{
    "hands_on_practices": [
        {
            "introduction": "The core of the Discrete Element Method is a time-stepping loop that applies fundamental laws of motion to each particle in a system. This first exercise provides a direct, hands-on application of this principle. By calculating the translational and rotational accelerations from given forces and updating a particle's state over a single time step, you will practice the foundational mechanics that drive every DEM simulation .",
            "id": "3750282",
            "problem": "Consider a single spherical particle in a Discrete Element Method (DEM) simulation. The particle is modeled as a rigid sphere of mass $m$ and radius $r$, with a uniform mass distribution. Its center-of-mass position is $\\mathbf{x}(t)$, its translational velocity is $\\mathbf{v}(t)$, and its angular velocity is $\\boldsymbol{\\omega}(t)$. At time $t$, the particle experiences two contact forces and associated contact torques about its center, along with gravitational body force. All quantities are given in an inertial laboratory frame.\n\nData:\n- Mass: $m = 0.05\\,\\mathrm{kg}$.\n- Radius: $r = 0.02\\,\\mathrm{m}$.\n- Initial center-of-mass position: $\\mathbf{x}(t) = (0,\\,0,\\,0)\\,\\mathrm{m}$.\n- Initial translational velocity: $\\mathbf{v}(t) = (0.1,\\,-0.2,\\,0)\\,\\mathrm{m/s}$.\n- Initial angular velocity: $\\boldsymbol{\\omega}(t) = (10,\\,0,\\,-5)\\,\\mathrm{rad/s}$.\n- Gravitational acceleration: $\\mathbf{g} = (0,\\,0,\\,-9.81)\\,\\mathrm{m/s^2}$.\n- Contact force $1$: $\\mathbf{F}_1 = (20,\\,-10,\\,0)\\,\\mathrm{N}$.\n- Contact force $2$: $\\mathbf{F}_2 = (-5,\\,25,\\,0)\\,\\mathrm{N}$.\n- Contact torque $1$ (about the center): $\\boldsymbol{\\tau}_1 = (0.02,\\,0.00,\\,0.01)\\,\\mathrm{N\\,m}$.\n- Contact torque $2$ (about the center): $\\boldsymbol{\\tau}_2 = (-0.01,\\,0.03,\\,-0.02)\\,\\mathrm{N\\,m}$.\n- Explicit time-step: $\\Delta t = 1.0\\times 10^{-4}\\,\\mathrm{s}$.\n\nAssume the particle’s moment of inertia tensor is isotropic, with $I = \\frac{2}{5} m r^2$ for a solid sphere, and that the only forces and torques acting during the time-step are those listed above. Using fundamental laws (Newton’s second law for translation and rigid-body rotation), compute:\n1. The instantaneous translational acceleration $\\mathbf{a}(t)$ and rotational acceleration $\\boldsymbol{\\alpha}(t)$.\n2. The updated translational velocity $\\mathbf{v}(t+\\Delta t)$, angular velocity $\\boldsymbol{\\omega}(t+\\Delta t)$, and position $\\mathbf{x}(t+\\Delta t)$, using an explicit forward Euler update over the single time-step $\\Delta t$.\n\nFinally, compute the total kinetic energy at time $t+\\Delta t$,\n$$\nK(t+\\Delta t) \\;=\\; \\frac{1}{2}\\,m\\,\\|\\mathbf{v}(t+\\Delta t)\\|^2 \\;+\\; \\frac{1}{2}\\,I\\,\\|\\boldsymbol{\\omega}(t+\\Delta t)\\|^2,\n$$\nand provide its value rounded to four significant figures. Express the final energy in $\\mathrm{J}$. The final answer must be a single real number.",
            "solution": "We begin from first principles. For translation, Newton’s second law states that the net force equals mass times acceleration:\n$$\nm\\,\\mathbf{a}(t) \\;=\\; \\mathbf{F}_{\\text{net}}(t) \\;=\\; \\mathbf{F}_1 \\;+\\; \\mathbf{F}_2 \\;+\\; m\\,\\mathbf{g}.\n$$\nFor rotation of a rigid body about its center, the angular momentum rate equals the net torque. For a uniform solid sphere, the moment of inertia is isotropic with scalar $I = \\frac{2}{5} m r^2$, so\n$$\nI\\,\\boldsymbol{\\alpha}(t) \\;=\\; \\boldsymbol{\\tau}_{\\text{net}}(t) \\;=\\; \\boldsymbol{\\tau}_1 \\;+\\; \\boldsymbol{\\tau}_2.\n$$\n\nCompute the moment of inertia:\n$$\nI \\;=\\; \\frac{2}{5}\\,m\\,r^2 \\;=\\; \\frac{2}{5}\\times 0.05 \\times (0.02)^2 \\;=\\; 0.4 \\times 0.05 \\times 0.0004 \\;=\\; 8.0\\times 10^{-6}\\,\\mathrm{kg\\,m^2}.\n$$\n\nCompute the net force and translational acceleration. The gravitational force is $m\\,\\mathbf{g} = (0,\\,0,\\,-0.05\\times 9.81)\\,\\mathrm{N} = (0,\\,0,\\,-0.4905)\\,\\mathrm{N}$. Hence\n$$\n\\mathbf{F}_{\\text{net}} \\;=\\; \\mathbf{F}_1 \\;+\\; \\mathbf{F}_2 \\;+\\; m\\,\\mathbf{g}\n\\;=\\; (20,\\,-10,\\,0) \\;+\\; (-5,\\,25,\\,0) \\;+\\; (0,\\,0,\\,-0.4905)\n\\;=\\; (15,\\,15,\\,-0.4905)\\,\\mathrm{N}.\n$$\nTherefore,\n$$\n\\mathbf{a}(t) \\;=\\; \\frac{\\mathbf{F}_{\\text{net}}}{m} \\;=\\; \\frac{(15,\\,15,\\,-0.4905)}{0.05}\n\\;=\\; (300,\\,300,\\,-9.81)\\,\\mathrm{m/s^2}.\n$$\n\nCompute the net torque and rotational acceleration:\n$$\n\\boldsymbol{\\tau}_{\\text{net}} \\;=\\; \\boldsymbol{\\tau}_1 \\;+\\; \\boldsymbol{\\tau}_2 \\;=\\; (0.02,\\,0.00,\\,0.01) \\;+\\; (-0.01,\\,0.03,\\,-0.02) \\;=\\; (0.01,\\,0.03,\\,-0.01)\\,\\mathrm{N\\,m},\n$$\nso\n$$\n\\boldsymbol{\\alpha}(t) \\;=\\; \\frac{\\boldsymbol{\\tau}_{\\text{net}}}{I} \\;=\\; \\frac{(0.01,\\,0.03,\\,-0.01)}{8.0\\times 10^{-6}}\n\\;=\\; (1250,\\,3750,\\,-1250)\\,\\mathrm{rad/s^2}.\n$$\n\nUpdate the state over one explicit forward Euler step of size $\\Delta t = 1.0\\times 10^{-4}\\,\\mathrm{s}$:\n- Translational velocity:\n$$\n\\mathbf{v}(t+\\Delta t) \\;=\\; \\mathbf{v}(t) \\;+\\; \\mathbf{a}(t)\\,\\Delta t\n\\;=\\; (0.1,\\,-0.2,\\,0) \\;+\\; (300,\\,300,\\,-9.81)\\times (1.0\\times 10^{-4})\n\\;=\\; (0.13,\\,-0.17,\\,-9.81\\times 10^{-4})\\,\\mathrm{m/s}.\n$$\nNumerically, $\\mathbf{v}(t+\\Delta t) = (0.13,\\,-0.17,\\,-0.000981)\\,\\mathrm{m/s}$.\n- Position:\n$$\n\\mathbf{x}(t+\\Delta t) \\;=\\; \\mathbf{x}(t) \\;+\\; \\mathbf{v}(t)\\,\\Delta t\n\\;=\\; (0,\\,0,\\,0) \\;+\\; (0.1,\\,-0.2,\\,0)\\times (1.0\\times 10^{-4})\n\\;=\\; (1.0\\times 10^{-5},\\,-2.0\\times 10^{-5},\\,0)\\,\\mathrm{m}.\n$$\n- Angular velocity:\n$$\n\\boldsymbol{\\omega}(t+\\Delta t) \\;=\\; \\boldsymbol{\\omega}(t) \\;+\\; \\boldsymbol{\\alpha}(t)\\,\\Delta t\n\\;=\\; (10,\\,0,\\,-5) \\;+\\; (1250,\\,3750,\\,-1250)\\times (1.0\\times 10^{-4})\n\\;=\\; (10.125,\\,0.375,\\,-5.125)\\,\\mathrm{rad/s}.\n$$\n\nCompute the total kinetic energy at $t+\\Delta t$:\n$$\nK(t+\\Delta t) \\;=\\; \\frac{1}{2}\\,m\\,\\|\\mathbf{v}(t+\\Delta t)\\|^2 \\;+\\; \\frac{1}{2}\\,I\\,\\|\\boldsymbol{\\omega}(t+\\Delta t)\\|^2.\n$$\nFirst, the translational part:\n$$\n\\|\\mathbf{v}(t+\\Delta t)\\|^2 \\;=\\; (0.13)^2 \\;+\\; (-0.17)^2 \\;+\\; (-0.000981)^2\n\\;=\\; 0.0169 \\;+\\; 0.0289 \\;+\\; 9.62361\\times 10^{-7}\n\\;=\\; 0.045800962361.\n$$\nThus,\n$$\n\\frac{1}{2}\\,m\\,\\|\\mathbf{v}(t+\\Delta t)\\|^2 \\;=\\; \\frac{1}{2}\\times 0.05 \\times 0.045800962361 \\;=\\; 0.001145024059025\\,\\mathrm{J}.\n$$\nNext, the rotational part:\n$$\n\\|\\boldsymbol{\\omega}(t+\\Delta t)\\|^2 \\;=\\; (10.125)^2 \\;+\\; (0.375)^2 \\;+\\; (-5.125)^2\n\\;=\\; 102.515625 \\;+\\; 0.140625 \\;+\\; 26.265625 \\;=\\; 128.921875,\n$$\nso\n$$\n\\frac{1}{2}\\,I\\,\\|\\boldsymbol{\\omega}(t+\\Delta t)\\|^2 \\;=\\; \\frac{1}{2}\\times 8.0\\times 10^{-6} \\times 128.921875\n\\;=\\; 4.0\\times 10^{-6} \\times 128.921875 \\;=\\; 5.156875\\times 10^{-4}\\,\\mathrm{J}.\n$$\nTherefore,\n$$\nK(t+\\Delta t) \\;=\\; 0.001145024059025 \\;+\\; 0.0005156875 \\;=\\; 0.001660711559025\\,\\mathrm{J}.\n$$\n\nRounded to four significant figures, the total kinetic energy is\n$$\nK(t+\\Delta t) \\;\\approx\\; 0.001661\\,\\mathrm{J}.\n$$",
            "answer": "$$\\boxed{0.001661}$$"
        },
        {
            "introduction": "While the basic time-stepping logic is straightforward, the true complexity and power of DEM lie in its contact models. This practice delves into the heart of granular interaction by focusing on tangential friction, which is governed by the non-linear Coulomb law . You will implement a standard \"return mapping\" algorithm, a crucial technique for correctly handling the transition between stick and slip conditions at a frictional contact.",
            "id": "4095033",
            "problem": "You are modeling a single tangential contact in the Discrete Element Method (DEM). The contact obeys Newton's laws and Coulomb friction. The tangential contact force is modeled as a linear elastic spring integrated from the slip velocity in the tangential plane, with a Coulomb friction limit. Starting from the fundamental relations that time integration accumulates displacement from velocity and that friction is bounded by the Coulomb limit, derive and implement the update for the tangential elastic spring displacement and the resulting tangential force. Specifically, for a given contact with normal force $F_n \\ge 0$ (compressive positive), friction coefficient $\\mu \\ge 0$, tangential stiffness $k_t > 0$, time step $\\Delta t > 0$, tangential slip velocity vector $\\boldsymbol{v}_t$ in the local tangential plane, and previous tangential spring displacement vector $\\boldsymbol{\\xi}^{old}$ in the same plane, compute the updated tangential spring displacement $\\boldsymbol{\\xi}^{new}$ and the tangential contact force $\\boldsymbol{F}_t$, enforcing the Coulomb limit.\n\nFundamental base to use:\n- Newton's Second Law and kinematics: velocity integrates to displacement, so the elastic spring displacement evolves according to $\\dfrac{d\\boldsymbol{\\xi}}{dt} = \\boldsymbol{v}_t$.\n- Linear elastic tangential force: $\\boldsymbol{F}_t = -k_t \\boldsymbol{\\xi}$.\n- Coulomb friction: $\\lVert \\boldsymbol{F}_t \\rVert \\le \\mu F_n$ and, under sliding, $\\boldsymbol{F}_t$ is directed opposite the slip tendency in the tangential plane.\n\nYour program must:\n1. Perform an explicit time integration trial update of the tangential spring displacement using $\\boldsymbol{\\xi}^{trial} = \\boldsymbol{\\xi}^{old} + \\boldsymbol{v}_t \\Delta t$.\n2. Compute the corresponding trial tangential force $\\boldsymbol{F}_t^{trial} = -k_t \\boldsymbol{\\xi}^{trial}$.\n3. Enforce the Coulomb friction limit by projecting back to the admissible set when necessary:\n   - If $F_n \\le 0$ then the contact is non-load bearing, and set $\\boldsymbol{\\xi}^{new} = \\boldsymbol{0}$ and $\\boldsymbol{F}_t = \\boldsymbol{0}$.\n   - Else if $\\lVert \\boldsymbol{F}_t^{trial} \\rVert \\le \\mu F_n$, then set $\\boldsymbol{\\xi}^{new} = \\boldsymbol{\\xi}^{trial}$ and $\\boldsymbol{F}_t = \\boldsymbol{F}_t^{trial}$ (stick).\n   - Else (slide), rescale the trial state to the Coulomb surface by setting $\\boldsymbol{\\xi}^{new} = \\boldsymbol{\\xi}^{trial} \\dfrac{\\mu F_n}{\\lVert \\boldsymbol{F}_t^{trial} \\rVert}$ and $\\boldsymbol{F}_t = -k_t \\boldsymbol{\\xi}^{new}$. This enforces $\\lVert \\boldsymbol{F}_t \\rVert = \\mu F_n$ with $\\boldsymbol{F}_t$ aligned with the trial direction in the tangential plane.\n\nAll vectors are two-dimensional in the local tangential plane. Use the International System of Units: express $\\boldsymbol{\\xi}^{new}$ in $\\mathrm{m}$ and $\\boldsymbol{F}_t$ in $\\mathrm{N}$. No angles are required. The numerical output shall be expressed as raw decimal floats.\n\nTest suite:\nProvide the following six test cases, each specified by $(F_n, \\mu, k_t, \\Delta t, \\boldsymbol{v}_t, \\boldsymbol{\\xi}^{old})$ with the given units:\n- Case $1$ (stick, small increment): $F_n = 100\\,\\mathrm{N}$, $\\mu = 0.5$, $k_t = 10^4\\,\\mathrm{N/m}$, $\\Delta t = 10^{-3}\\,\\mathrm{s}$, $\\boldsymbol{v}_t = [0.01, 0]\\,\\mathrm{m/s}$, $\\boldsymbol{\\xi}^{old} = [0, 0]\\,\\mathrm{m}$.\n- Case $2$ (slide, large increment): $F_n = 100\\,\\mathrm{N}$, $\\mu = 0.5$, $k_t = 10^4\\,\\mathrm{N/m}$, $\\Delta t = 10^{-3}\\,\\mathrm{s}$, $\\boldsymbol{v}_t = [10, 0]\\,\\mathrm{m/s}$, $\\boldsymbol{\\xi}^{old} = [0, 0]\\,\\mathrm{m}$.\n- Case $3$ (boundary, exactly at limit): $F_n = 100\\,\\mathrm{N}$, $\\mu = 0.5$, $k_t = 10^4\\,\\mathrm{N/m}$, $\\Delta t = 10^{-3}\\,\\mathrm{s}$, $\\boldsymbol{v}_t = [5, 0]\\,\\mathrm{m/s}$, $\\boldsymbol{\\xi}^{old} = [0, 0]\\,\\mathrm{m}$.\n- Case $4$ (no contact): $F_n = 0\\,\\mathrm{N}$, $\\mu = 0.5$, $k_t = 10^4\\,\\mathrm{N/m}$, $\\Delta t = 10^{-3}\\,\\mathrm{s}$, $\\boldsymbol{v}_t = [100, -100]\\,\\mathrm{m/s}$, $\\boldsymbol{\\xi}^{old} = [0, 0]\\,\\mathrm{m}$.\n- Case $5$ (stick with oblique update): $F_n = 10\\,\\mathrm{N}$, $\\mu = 0.3$, $k_t = 2 \\times 10^4\\,\\mathrm{N/m}$, $\\Delta t = 2 \\times 10^{-3}\\,\\mathrm{s}$, $\\boldsymbol{v}_t = [0.003, -0.004]\\,\\mathrm{m/s}$, $\\boldsymbol{\\xi}^{old} = [10^{-4}, 0]\\,\\mathrm{m}$.\n- Case $6$ (return mapping with preloaded spring): $F_n = 5\\,\\mathrm{N}$, $\\mu = 0.2$, $k_t = 10^4\\,\\mathrm{N/m}$, $\\Delta t = 10^{-3}\\,\\mathrm{s}$, $\\boldsymbol{v}_t = [0, 0]\\,\\mathrm{m/s}$, $\\boldsymbol{\\xi}^{old} = [10^{-2}, 10^{-2}]\\,\\mathrm{m}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the list $[\\xi_x, \\xi_y, F_{t,x}, F_{t,y}]$ for the corresponding test case in SI units (for example, $[[\\dots],[\\dots],\\dots]$). Each numerical entry must be a decimal float.",
            "solution": "The problem requires the derivation and implementation of a numerical algorithm to update the tangential force and spring displacement at a single frictional contact, as commonly modeled in the Discrete Element Method (DEM). The model is based on a linear tangential spring and the Coulomb friction law. The problem is well-posed, scientifically sound, and provides all necessary information to construct a unique solution.\n\nThe physical state of the contact is described by the tangential spring displacement vector $\\boldsymbol{\\xi}$ in the local $2$D tangential plane. The tangential force $\\boldsymbol{F}_t$ is assumed to be linearly proportional to this displacement:\n$$\n\\boldsymbol{F}_t = -k_t \\boldsymbol{\\xi}\n$$\nwhere $k_t > 0$ is the tangential stiffness.\n\nThe evolution of the spring displacement is governed by the relative tangential velocity (slip velocity) $\\boldsymbol{v}_t$ between the contacting surfaces. The rate of change of the elastic displacement is equal to the slip velocity:\n$$\n\\frac{d\\boldsymbol{\\xi}}{dt} = \\boldsymbol{v}_t\n$$\n\nThe magnitude of the tangential force is limited by the Coulomb friction criterion. The tangential force must lie within an admissible set, a disk in the tangential plane defined by:\n$$\n\\lVert \\boldsymbol{F}_t \\rVert \\le \\mu F_n\n$$\nwhere $F_n \\ge 0$ is the compressive normal force and $\\mu \\ge 0$ is the coefficient of static friction. When the force magnitude reaches the limit, $\\lVert \\boldsymbol{F}_t \\rVert = \\mu F_n$, the contact is in a state of gross sliding, and the tangential force vector must oppose the direction of slip velocity.\n\nThe algorithm to be implemented is an explicit time-stepping scheme of the predictor-corrector type, often referred to as a \"return mapping\" algorithm in computational plasticity and contact mechanics. Given the state at the beginning of a time step $\\Delta t > 0$ (represented by $\\boldsymbol{\\xi}^{old}$), the goal is to compute the state at the end of the step, $\\boldsymbol{\\xi}^{new}$ and $\\boldsymbol{F}_t$.\n\n**Step 1: Trial (Predictor) Step**\nFirst, we discretize the evolution equation for $\\boldsymbol{\\xi}$ using a forward Euler scheme. This yields a trial displacement, $\\boldsymbol{\\xi}^{trial}$, which assumes purely elastic behavior throughout the time step $\\Delta t$:\n$$\n\\boldsymbol{\\xi}^{trial} = \\boldsymbol{\\xi}^{old} + \\boldsymbol{v}_t \\Delta t\n$$\nFrom this trial displacement, a corresponding trial tangential force, $\\boldsymbol{F}_t^{trial}$, is computed:\n$$\n\\boldsymbol{F}_t^{trial} = -k_t \\boldsymbol{\\xi}^{trial}\n$$\n\n**Step 2: Constraint Enforcement (Corrector) Step**\nNext, the trial state is checked against the Coulomb friction constraint. There are three possible outcomes:\n\n**Case A: No Contact**\nIf the normal force $F_n \\le 0$, the contact is not active or is tensile. In DEM for granular materials, tensile forces are typically not supported, and any existing tangential \"memory\" in the spring is lost. Therefore, the tangential displacement and force are reset to zero.\n$$\n\\boldsymbol{\\xi}^{new} = \\boldsymbol{0} \\quad \\text{and} \\quad \\boldsymbol{F}_t = \\boldsymbol{0}\n$$\n\n**Case B: Stick Condition**\nIf the contact is active ($F_n > 0$) and the magnitude of the trial force is within the admissible friction disk, the purely elastic assumption holds. This is the \"stick\" condition.\n$$\n\\text{If } \\lVert \\boldsymbol{F}_t^{trial} \\rVert \\le \\mu F_n, \\text{ then the contact sticks.}\n$$\nIn this case, the trial values are accepted as the final values for the new state:\n$$\n\\boldsymbol{\\xi}^{new} = \\boldsymbol{\\xi}^{trial}\n$$\n$$\n\\boldsymbol{F}_t = \\boldsymbol{F}_t^{trial}\n$$\n\n**Case C: Slip Condition**\nIf the contact is active ($F_n > 0$) and the magnitude of the trial force exceeds the friction limit, the elastic assumption is invalid. The contact must slip, and the tangential force must lie on the boundary of the friction disk (the \"friction circle\").\n$$\n\\text{If } \\lVert \\boldsymbol{F}_t^{trial} \\rVert > \\mu F_n, \\text{ then the contact slips.}\n$$\nThe corrected force $\\boldsymbol{F}_t$ must have a magnitude of exactly $\\mu F_n$ and must point in the same direction as the trial force $\\boldsymbol{F}_t^{trial}$. This is achieved by radially scaling the trial force vector back to the friction circle. The scaling factor is the ratio of the maximum allowable force magnitude to the trial force magnitude.\n$$\n\\boldsymbol{F}_t = \\boldsymbol{F}_t^{trial} \\frac{\\mu F_n}{\\lVert \\boldsymbol{F}_t^{trial} \\rVert}\n$$\nThe norm of this new force is $\\lVert \\boldsymbol{F}_t \\rVert = \\left\\lVert \\boldsymbol{F}_t^{trial} \\frac{\\mu F_n}{\\lVert \\boldsymbol{F}_t^{trial} \\rVert} \\right\\rVert = \\lVert \\boldsymbol{F}_t^{trial} \\rVert \\frac{\\mu F_n}{\\lVert \\boldsymbol{F}_t^{trial} \\rVert} = \\mu F_n$, as required.\nSince the force and displacement are linearly related by the constant $-k_t$, the final displacement $\\boldsymbol{\\xi}^{new}$ is obtained by applying the same scaling factor to the trial displacement $\\boldsymbol{\\xi}^{trial}$:\n$$\n\\boldsymbol{\\xi}^{new} = \\boldsymbol{\\xi}^{trial} \\frac{\\mu F_n}{\\lVert \\boldsymbol{F}_t^{trial} \\rVert}\n$$\nThe final force can then be computed consistently as $\\boldsymbol{F}_t = -k_t \\boldsymbol{\\xi}^{new}$.\n\nThis predictor-corrector algorithm robustly and efficiently enforces the non-smooth, non-linear Coulomb friction law within an explicit DEM time-stepping framework. We will now implement this procedure for the given test cases.",
            "answer": "[[1e-05,0.0,-0.1,0.0],[0.005,0.0,-50.0,0.0],[0.005,0.0,-50.0,0.0],[0.0,0.0,0.0,0.0],[0.000106,-8e-06,-2.12,0.16],[7.071067811865475e-05,7.071067811865475e-05,-0.7071067811865475,-0.7071067811865475]]"
        },
        {
            "introduction": "The accuracy and long-term stability of a simulation depend critically on the chosen numerical integrator. Moving beyond the simple forward Euler method, this exercise introduces the widely-used Velocity-Verlet algorithm . By deriving the update rules and performing a stability analysis, you will gain a deeper understanding of how to build robust simulations and appreciate the crucial relationship between the physical properties of the system and the maximum allowable time step.",
            "id": "3947654",
            "problem": "A system of rigid spherical particles is modeled by Discrete Element Methods (DEM), where interactions and motion are described by Newton’s laws. Consider a single rigid spherical particle with mass $m$ and moment of inertia $I$ about its center. Let $\\mathbf{x}(t)$ denote the particle position, $\\mathbf{v}(t)$ its linear velocity, $\\boldsymbol{\\omega}(t)$ its angular velocity, and $\\boldsymbol{\\theta}(t)$ its orientation vector expressed in radians. The net force $\\mathbf{F}$ and torque $\\boldsymbol{\\tau}$ arise from interactions such as springs and contacts, possibly with no-slip constraints, but for the purpose of this problem they are deterministic and depend at most on positions and orientations at each time. The fundamental base is Newton’s second law for translation and rotation:\n$$m \\,\\frac{d^2 \\mathbf{x}}{dt^2} = \\mathbf{F}(\\mathbf{x}, t), \\quad I \\,\\frac{d \\boldsymbol{\\omega}}{dt} = \\boldsymbol{\\tau}(\\boldsymbol{\\theta}, t),$$\nwith the kinematic relation\n$$\\frac{d \\boldsymbol{\\theta}}{dt} = \\boldsymbol{\\omega}.$$\n\nYour tasks are:\n1. Derive, from first principles, a Velocity-Verlet time integration scheme for DEM that updates positions $\\mathbf{x}$, linear velocities $\\mathbf{v}$, and angular velocities $\\boldsymbol{\\omega}$ over a time step $\\Delta t$. The derivation must begin from the fundamental laws above, without introducing any shortcut formulas. The derivation should clearly state and use the accelerations $\\mathbf{a}(t) = \\mathbf{F}(\\mathbf{x}(t), t)/m$ and angular accelerations $\\boldsymbol{\\alpha}(t) = \\boldsymbol{\\tau}(\\boldsymbol{\\theta}(t), t)/I$, and must produce explicit update formulas for $\\mathbf{x}^{n+1}$, $\\mathbf{v}^{n+1}$, and $\\boldsymbol{\\omega}^{n+1}$ from values at time step $n$.\n2. Discuss the formal order of accuracy and stability properties of the scheme for position-dependent forces and torques, including a linear stability analysis for a one-dimensional harmonic oscillator defined by $m \\, d^2 x/dt^2 = -k x$ and its rotational analog $I \\, d^2 \\theta/dt^2 = -k_t \\theta$. Clearly state the stability condition in terms of the natural angular frequency and $\\Delta t$. All angles must be expressed in radians.\n3. Implement a complete, runnable program that applies the derived Velocity-Verlet scheme to the following scientifically realistic test suite. Use the International System of Units (SI): mass in $\\mathrm{kg}$, stiffness in $\\mathrm{N/m}$, moment of inertia in $\\mathrm{kg\\,m^2}$, time in $\\mathrm{s}$, torque stiffness in $\\mathrm{N\\,m/rad}$, and angles in radians. The program must produce quantitative outputs as specified.\n\nTest Suite:\n- Accuracy tests (single-step local truncation error for position-dependent forces and torques):\n    - Translational harmonic oscillator: $m = 1.0$, $k = 100.0$, initial position $x_0 = 0.1$ $\\mathrm{m}$, initial velocity $v_0 = 0.0$ $\\mathrm{m/s}$, time steps $\\Delta t_1 = 0.01$ $\\mathrm{s}$ and $\\Delta t_2 = 0.005$ $\\mathrm{s}$. Compute the exact solution after one step using $x(t) = x_0 \\cos(\\omega t) + v_0 \\frac{\\sin(\\omega t)}{\\omega}$ and $v(t) = -x_0 \\omega \\sin(\\omega t) + v_0 \\cos(\\omega t)$ with $\\omega = \\sqrt{k/m}$. Measure the absolute errors $\\varepsilon_x(\\Delta t)$ and $\\varepsilon_v(\\Delta t)$ after one Velocity-Verlet step for $\\Delta t_1$ and $\\Delta t_2$, then report the ratios $\\varepsilon_x(\\Delta t_1)/\\varepsilon_x(\\Delta t_2)$ and $\\varepsilon_v(\\Delta t_1)/\\varepsilon_v(\\Delta t_2)$ as floats.\n    - Rotational harmonic oscillator: $I = 0.004$, $k_t = 0.5$, initial orientation $\\theta_0 = 0.1$ $\\mathrm{rad}$, initial angular velocity $\\omega_0 = 0.0$ $\\mathrm{rad/s}$, time steps $\\Delta t_1 = 0.01$ $\\mathrm{s}$ and $\\Delta t_2 = 0.005$ $\\mathrm{s}$. Use $\\theta(t) = \\theta_0 \\cos(\\Omega t) + \\omega_0 \\frac{\\sin(\\Omega t)}{\\Omega}$ and $\\omega(t) = -\\theta_0 \\Omega \\sin(\\Omega t) + \\omega_0 \\cos(\\Omega t)$ with $\\Omega = \\sqrt{k_t/I}$. Measure the absolute error in angular velocity $\\varepsilon_\\omega(\\Delta t)$ after one Velocity-Verlet step for both time steps and report the ratio $\\varepsilon_\\omega(\\Delta t_1)/\\varepsilon_\\omega(\\Delta t_2)$ as a float.\n\n- Stability tests (boundedness over many steps for a harmonic oscillator):\n    - Translational harmonic oscillator with $m = 1.0$, $k = 100.0$, initial condition $x_0 = 0.1$ $\\mathrm{m}$, $v_0 = 0.0$ $\\mathrm{m/s}$. Simulate for $N = 2000$ steps using the Velocity-Verlet scheme with three time steps: $\\Delta t_{\\text{small}} = 0.05$ $\\mathrm{s}$, $\\Delta t_{\\text{border}} = 0.2$ $\\mathrm{s}$, and $\\Delta t_{\\text{large}} = 0.25$ $\\mathrm{s}$. Define boundedness as the maximum absolute position over the simulation not exceeding $10$ times the initial absolute position and no numerical overflow. For each time step, output a boolean indicating whether the motion remains bounded.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list should contain six entries in the following order: $[\\varepsilon_x(\\Delta t_1)/\\varepsilon_x(\\Delta t_2), \\varepsilon_v(\\Delta t_1)/\\varepsilon_v(\\Delta t_2), \\varepsilon_\\omega(\\Delta t_1)/\\varepsilon_\\omega(\\Delta t_2), \\text{bounded}(\\Delta t_{\\text{small}}), \\text{bounded}(\\Delta t_{\\text{border}}), \\text{bounded}(\\Delta t_{\\text{large}})]$. All three ratios must be floats, and the three boundedness indicators must be booleans. The program must not read any input and must be fully self-contained.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of Newtonian mechanics and numerical analysis, specifically concerning the Discrete Element Method (DEM). The problem is well-posed, with all necessary parameters and conditions provided to derive a unique, meaningful solution. The language is objective and unambiguous. A complete solution is therefore provided.\n\n### 1. Derivation of the Velocity-Verlet Integration Scheme\n\nThe Velocity-Verlet algorithm is derived from Taylor series expansions of the position, $\\mathbf{x}(t)$, and velocity, $\\mathbf{v}(t)$. The fundamental equations of motion are given as:\n$$m \\frac{d^2 \\mathbf{x}}{dt^2} = \\mathbf{F}(\\mathbf{x}, t) \\implies \\frac{d\\mathbf{v}}{dt} = \\mathbf{a}(\\mathbf{x}, t)$$\n$$I \\frac{d \\boldsymbol{\\omega}}{dt} = \\boldsymbol{\\tau}(\\boldsymbol{\\theta}, t) \\implies \\frac{d\\boldsymbol{\\omega}}{dt} = \\boldsymbol{\\alpha}(\\boldsymbol{\\theta}, t)$$\nwhere $\\mathbf{a}(t)$ is the linear acceleration and $\\boldsymbol{\\alpha}(t)$ is the angular acceleration. The kinematic relation is $\\frac{d\\mathbf{x}}{dt} = \\mathbf{v}$ and $\\frac{d\\boldsymbol{\\theta}}{dt} = \\boldsymbol{\\omega}$.\n\nLet the state of the system at time $t_n = n \\Delta t$ be $(\\mathbf{x}^n, \\mathbf{v}^n, \\boldsymbol{\\theta}^n, \\boldsymbol{\\omega}^n)$. We seek the state at time $t_{n+1} = t_n + \\Delta t$.\n\n**Step 1: Position and Orientation Update**\nWe start with the Taylor series expansion for the position vector $\\mathbf{x}(t)$ around time $t_n$:\n$$\\mathbf{x}(t_n + \\Delta t) = \\mathbf{x}(t_n) + \\frac{d\\mathbf{x}}{dt}\\bigg|_{t_n} \\Delta t + \\frac{1}{2} \\frac{d^2\\mathbf{x}}{dt^2}\\bigg|_{t_n} \\Delta t^2 + O(\\Delta t^3)$$\nSubstituting the kinematic relation $\\mathbf{v} = d\\mathbf{x}/dt$ and the definition of acceleration $\\mathbf{a} = d^2\\mathbf{x}/dt^2$:\n$$\\mathbf{x}^{n+1} \\approx \\mathbf{x}^n + \\mathbf{v}^n \\Delta t + \\frac{1}{2} \\mathbf{a}^n \\Delta t^2$$\nThis is the position update formula, which is accurate to second order. The local error is $O(\\Delta t^3)$.\n\nAn identical derivation applies to the orientation vector $\\boldsymbol{\\theta}$, replacing linear quantities with their rotational counterparts:\n$$\\boldsymbol{\\theta}^{n+1} \\approx \\boldsymbol{\\theta}^n + \\boldsymbol{\\omega}^n \\Delta t + \\frac{1}{2} \\boldsymbol{\\alpha}^n \\Delta t^2$$\n\n**Step 2: Velocity and Angular Velocity Update**\nTo update the velocity, we use the Taylor expansion for $\\mathbf{v}(t)$ around $t_n$:\n$$\\mathbf{v}(t_n + \\Delta t) = \\mathbf{v}(t_n) + \\frac{d\\mathbf{v}}{dt}\\bigg|_{t_n} \\Delta t + O(\\Delta t^2) = \\mathbf{v}^n + \\mathbf{a}^n \\Delta t + O(\\Delta t^2)$$\nThis is a simple forward Euler step and is only first-order accurate. The key to the Velocity-Verlet scheme is to improve this accuracy by averaging the accelerations at the beginning and end of the time step.\n$$\\mathbf{v}^{n+1} \\approx \\mathbf{v}^n + \\frac{\\mathbf{a}^n + \\mathbf{a}^{n+1}}{2} \\Delta t$$\nTo use this formula, we need the acceleration $\\mathbf{a}^{n+1} = \\mathbf{a}(\\mathbf{x}^{n+1}, t_{n+1})$, which depends on the yet-to-be-calculated position $\\mathbf{x}^{n+1}$. This suggests the following sequence of operations:\n1.  Compute the new position $\\mathbf{x}^{n+1}$ using the formula from Step 1.\n2.  Use the new position $\\mathbf{x}^{n+1}$ to calculate the force $\\mathbf{F}(\\mathbf{x}^{n+1}, t_{n+1})$ and thus the new acceleration $\\mathbf{a}^{n+1}$.\n3.  Compute the new velocity $\\mathbf{v}^{n+1}$ using the averaged acceleration formula.\n\nThe complete Velocity-Verlet algorithm for one time step is:\n1.  Update positions: $\\mathbf{x}^{n+1} = \\mathbf{x}^{n} + \\mathbf{v}^{n}\\Delta t + \\frac{1}{2}\\mathbf{a}^{n}\\Delta t^2$.\n2.  Calculate new accelerations: $\\mathbf{a}^{n+1} = \\mathbf{F}(\\mathbf{x}^{n+1}, t_{n+1})/m$.\n3.  Update velocities: $\\mathbf{v}^{n+1} = \\mathbf{v}^{n} + \\frac{1}{2}(\\mathbf{a}^{n} + \\mathbf{a}^{n+1})\\Delta t$.\n\nThe same logic applies to the rotational dynamics:\n1.  Update orientations: $\\boldsymbol{\\theta}^{n+1} = \\boldsymbol{\\theta}^{n} + \\boldsymbol{\\omega}^{n}\\Delta t + \\frac{1}{2}\\boldsymbol{\\alpha}^{n}\\Delta t^2$.\n2.  Calculate new angular accelerations: $\\boldsymbol{\\alpha}^{n+1} = \\boldsymbol{\\tau}(\\boldsymbol{\\theta}^{n+1}, t_{n+1})/I$.\n3.  Update angular velocities: $\\boldsymbol{\\omega}^{n+1} = \\boldsymbol{\\omega}^{n} + \\frac{1}{2}(\\boldsymbol{\\alpha}^{n} + \\boldsymbol{\\alpha}^{n+1})\\Delta t$.\n\n### 2. Accuracy and Stability Analysis\n\n**Order of Accuracy**\nThe local truncation error is the error incurred in a single step, assuming the state at time $t_n$ is exact.\nFor position, the Taylor expansion gives:\n$$ \\mathbf{x}_{\\text{exact}}(t_n+\\Delta t) = \\mathbf{x}^n + \\mathbf{v}^n \\Delta t + \\frac{1}{2} \\mathbf{a}^n \\Delta t^2 + \\frac{1}{6} \\dot{\\mathbf{a}}^n \\Delta t^3 + O(\\Delta t^4) $$\nThe numerical position is $\\mathbf{x}^{n+1} = \\mathbf{x}^n + \\mathbf{v}^n \\Delta t + \\frac{1}{2} \\mathbf{a}^n \\Delta t^2$. The local error is therefore $E_x = \\mathbf{x}_{\\text{exact}}^{n+1} - \\mathbf{x}^{n+1} = \\frac{1}{6} \\dot{\\mathbf{a}}^n \\Delta t^3 + O(\\Delta t^4)$. The position update has a local error of $O(\\Delta t^3)$. However, for the specific test case of a harmonic oscillator starting from rest ($v_0=0$), we have $\\dot{\\mathbf{a}} = (d\\mathbf{a}/d\\mathbf{x})\\mathbf{v}$, so $\\dot{\\mathbf{a}}(t=0) = 0$. The leading error term vanishes, and the error becomes $E_x = \\frac{1}{24}\\ddot{\\mathbf{a}}^n \\Delta t^4 + O(\\Delta t^5)$, which is $O(\\Delta t^4)$.\n\nFor velocity, we expand $\\mathbf{a}^{n+1}$ around $t_n$:\n$$ \\mathbf{a}^{n+1} = \\mathbf{a}(\\mathbf{x}^{n+1}) \\approx \\mathbf{a}(\\mathbf{x}^n + \\mathbf{v}^n\\Delta t + \\dots) \\approx \\mathbf{a}^n + \\frac{d\\mathbf{a}}{dt}\\bigg|_{t_n} \\Delta t + O(\\Delta t^2) = \\mathbf{a}^n + \\dot{\\mathbf{a}}^n \\Delta t + O(\\Delta t^2) $$\nSubstituting this into the velocity update rule:\n$$ \\mathbf{v}^{n+1} = \\mathbf{v}^n + \\frac{1}{2}(\\mathbf{a}^n + \\mathbf{a}^n + \\dot{\\mathbf{a}}^n \\Delta t + O(\\Delta t^2)) \\Delta t = \\mathbf{v}^n + \\mathbf{a}^n \\Delta t + \\frac{1}{2} \\dot{\\mathbf{a}}^n \\Delta t^2 + O(\\Delta t^3) $$\nThe exact velocity is $\\mathbf{v}_{\\text{exact}}(t_n+\\Delta t) = \\mathbf{v}^n + \\mathbf{a}^n\\Delta t + \\frac{1}{2}\\dot{\\mathbf{a}}^n\\Delta t^2 + \\frac{1}{6}\\ddot{\\mathbf{a}}^n\\Delta t^3 + O(\\Delta t^4)$. The local error is $E_v = \\mathbf{v}^{n+1} - \\mathbf{v}_{\\text{exact}}^{n+1} = - \\frac{1}{6}\\ddot{\\mathbf{a}}^n\\Delta t^3 + O(\\Delta t^4)$, neglecting the error contribution from the expansion of $\\mathbf{a}^{n+1}$. A more careful analysis shows $E_v \\sim O(\\Delta t^3)$.\nThe local errors for position and velocity are $O(\\Delta t^3)$. For the specific case where $\\dot{\\mathbf{a}}(0)=0$, the position error is $O(\\Delta t^4)$. The global error for the scheme is one order lower, making it a second-order method, $O(\\Delta t^2)$.\n\n**Linear Stability Analysis**\nWe analyze the one-dimensional harmonic oscillator, $m \\ddot{x} = -k x$, or $\\ddot{x} = -\\omega^2 x$, where $\\omega = \\sqrt{k/m}$. The Velocity-Verlet equations are:\n1. $x_{n+1} = x_n + v_n \\Delta t + \\frac{1}{2} a_n \\Delta t^2 = x_n + v_n \\Delta t - \\frac{1}{2} \\omega^2 x_n \\Delta t^2$\n2. $v_{n+1} = v_n + \\frac{1}{2} (a_n + a_{n+1}) \\Delta t = v_n - \\frac{1}{2} \\omega^2 (x_n + x_{n+1}) \\Delta t$\nWe can represent this system as a matrix transformation on the state vector $\\begin{pmatrix} x_n & v_n \\end{pmatrix}^T$. Substituting $x_{n+1}$ from (1) into (2) gives the system matrix, or amplification matrix, $\\mathbf{M}$:\n$$\n\\begin{pmatrix} x_{n+1} \\\\ v_{n+1} \\end{pmatrix} = \\mathbf{M} \\begin{pmatrix} x_n \\\\ v_n \\end{pmatrix} = \n\\begin{pmatrix} 1 - \\frac{1}{2} (\\omega \\Delta t)^2 & \\Delta t \\\\ -\\omega^2 \\Delta t (1 - \\frac{1}{4} (\\omega \\Delta t)^2) & 1 - \\frac{1}{2} (\\omega \\Delta t)^2 \\end{pmatrix}\n\\begin{pmatrix} x_n \\\\ v_n \\end{pmatrix}\n$$\nThe system is stable if the eigenvalues $\\lambda$ of $\\mathbf{M}$ satisfy $|\\lambda| \\le 1$. The eigenvalues are solutions to the characteristic equation $\\lambda^2 - \\text{Tr}(\\mathbf{M})\\lambda + \\det(\\mathbf{M}) = 0$.\nThe trace is $\\text{Tr}(\\mathbf{M}) = 2 - (\\omega \\Delta t)^2$. The determinant is $\\det(\\mathbf{M}) = 1$. The equation becomes:\n$$ \\lambda^2 - (2 - (\\omega \\Delta t)^2)\\lambda + 1 = 0 $$\nFor the eigenvalues to lie on the unit circle (i.e., $|\\lambda|=1$ and non-growing oscillations), the discriminant of this quadratic equation must be non-positive:\n$$ (2 - (\\omega \\Delta t)^2)^2 - 4 \\le 0 \\implies -2 \\le 2 - (\\omega \\Delta t)^2 \\le 2 $$\nThe right inequality, $-(\\omega \\Delta t)^2 \\le 0$, is always true. The left inequality gives the stability condition:\n$$ (\\omega \\Delta t)^2 \\le 4 \\implies \\omega \\Delta t \\le 2 $$\nThus, the Velocity-Verlet scheme is conditionally stable for the harmonic oscillator. The time step $\\Delta t$ must be chosen such that it is less than or equal to $2/\\omega$, where $\\omega$ is the highest natural frequency in the system. The same condition, $\\Omega \\Delta t \\le 2$, applies to the rotational oscillator.\n\n### 3. Implementation and Test Suite Results\n\nThe provided Python code implements the derived Velocity-Verlet algorithm and applies it to the specified test suite.\n\n**Accuracy Tests**\n- **Translational Oscillator:** $m=1.0$, $k=100.0$, so $\\omega=10.0$ rad/s. Initial conditions are $x_0=0.1, v_0=0.0$. Since $v_0=0$, we have $\\dot{a}(0)=0$. The local truncation error for position is expected to be $O(\\Delta t^4)$, and for velocity, $O(\\Delta t^3)$. When halving the time step from $\\Delta t_1$ to $\\Delta t_2$, the position error should decrease by a factor of $(2)^4=16$, and the velocity error by a factor of $(2)^3=8$.\n- **Rotational Oscillator:** $I=0.004$, $k_t=0.5$, so $\\Omega=\\sqrt{125} \\approx 11.18$ rad/s. Initial conditions are $\\theta_0=0.1, \\omega_0=0.0$. The local truncation error for angular velocity is $O(\\Delta t^3)$, so the error ratio is expected to be $(2)^3=8$.\n\n**Stability Tests**\nThe stability condition is $\\Delta t \\le 2/\\omega = 2/10.0 = 0.2$ s.\n- $\\Delta t_{\\text{small}} = 0.05$ s: $\\omega \\Delta t = 0.5 < 2$. The simulation is expected to be stable and bounded.\n- $\\Delta t_{\\text{border}} = 0.2$ s: $\\omega \\Delta t = 2.0$. The simulation is at the limit of stability. The energy should be conserved, and the motion should remain bounded.\n- $\\Delta t_{\\text{large}} = 0.25$ s: $\\omega \\Delta t = 2.5 > 2$. The simulation is expected to be unstable, with the amplitude growing exponentially and eventually overflowing or exceeding the specified bound.\n\nThe code computes the results for these tests and formats them as requested.",
            "answer": "[15.996001777002012,7.99800044433339,7.999132223405763,true,true,false]"
        }
    ]
}