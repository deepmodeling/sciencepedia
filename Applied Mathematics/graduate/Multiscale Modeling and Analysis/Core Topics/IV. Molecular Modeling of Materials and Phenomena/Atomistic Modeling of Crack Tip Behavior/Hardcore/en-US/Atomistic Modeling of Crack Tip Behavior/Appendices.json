{
    "hands_on_practices": [
        {
            "introduction": "Before modeling the complexities of a crack, it is essential to understand the ideal strength of the material itself. This exercise bridges the microscopic world, described by an interatomic potential, and macroscopic engineering properties like Young's modulus $E$ and surface energy $\\gamma$. By deriving the theoretical brittle strength from first principles , you will establish the physical stress limit for a perfect crystal, providing a crucial benchmark for interpreting the extreme stress states found at a crack tip.",
            "id": "3734045",
            "problem": "Consider a brittle single-crystal solid in which cleavage occurs by breaking interatomic bonds across a crystallographic plane. Assume the interatomic interaction is well represented by the Morse potential\n$$\nU(r) \\;=\\; D\\left[\\exp\\!\\left(-2\\alpha\\,(r - r_0)\\right) \\;-\\; 2\\,\\exp\\!\\left(-\\alpha\\,(r - r_0)\\right)\\right],\n$$\nwhere $r$ is the instantaneous bond length, $r_0$ is the equilibrium bond length, $D$ is the dissociation energy of a single bond, and $\\alpha$ is a positive range parameter. The theoretical brittle strength is defined here as the maximum cleavage traction sustained by these bonds before unstable separation.\n\nUse the following fundamental bases:\n- The force on a bond follows from Newton’s second law and energy conservation as $F(r) = -\\,\\mathrm{d}U/\\mathrm{d}r$.\n- The curvature of the potential at equilibrium is $k \\equiv \\mathrm{d}^2U/\\mathrm{d}r^2\\big|_{r=r_0}$, which governs the small-strain stiffness of a bond.\n- The macroscopic normal stress across the plane is $\\sigma = n_b\\,F(r)$, where $n_b$ is the number of load-bearing bonds per unit area across the cleavage plane.\n- For small strains, Hooke’s law gives the Young’s modulus $E$ via $\\sigma = E\\,\\varepsilon$, with $\\varepsilon \\approx (r - r_0)/r_0$.\n- The work of complete separation per unit area equals twice the surface energy, $2\\gamma$, which is the area under the traction–separation curve and equals the sum of the energies required to break all bonds per unit area.\n\nStarting from these bases, derive an expression for the theoretical brittle strength $\\sigma_{\\mathrm{th}}$ in terms of the macroscopic parameters $E$, $\\gamma$, and the equilibrium bond length $r_0$. Then, using $E = 200\\,\\mathrm{GPa}$, $\\gamma = 1.5\\,\\mathrm{J/m^2}$, and $r_0 = 0.25\\,\\mathrm{nm}$, compute the numerical value of $\\sigma_{\\mathrm{th}}$. Round your final numerical answer to three significant figures and express it in $\\mathrm{GPa}$.\n\nFinally, briefly assess the relevance of this theoretical brittle strength near an atomistic crack tip, commenting on its role in limiting the near-tip stress field and its implications for bond breaking at the scale of a few lattice spacings. Your assessment should be qualitative and based on the derivation, but it must not alter the requested numerical answer.",
            "solution": "The problem asks for the derivation of an expression for the theoretical brittle strength, $\\sigma_{\\mathrm{th}}$, in terms of macroscopic material properties, and its subsequent numerical calculation. The derivation begins with the provided Morse potential for interatomic interaction.\n\nThe Morse potential is given by:\n$$\nU(r) = D\\left[\\exp\\left(-2\\alpha(r - r_0)\\right) - 2\\exp\\left(-\\alpha(r - r_0)\\right)\\right]\n$$\nwhere $r$ is the interatomic distance, $r_0$ is the equilibrium distance, $D$ is the bond dissociation energy, and $\\alpha$ is a parameter related to the potential's width.\n\nFirst, we derive the interatomic force $F(r)$ by taking the negative gradient of the potential energy $U(r)$:\n$$\nF(r) = -\\frac{\\mathrm{d}U}{\\mathrm{d}r} = -D\\left[-2\\alpha\\exp\\left(-2\\alpha(r - r_0)\\right) - 2(-\\alpha)\\exp\\left(-\\alpha(r - r_0)\\right)\\right]\n$$\n$$\nF(r) = 2\\alpha D \\left[\\exp\\left(-2\\alpha(r - r_0)\\right) - \\exp\\left(-\\alpha(r - r_0)\\right)\\right]\n$$\nFor $r > r_0$ (stretching), this force is attractive (negative). The cleavage traction, $\\sigma$, is the magnitude of this restorative force per unit area. Let $u = r - r_0$ be the bond separation distance. The tensile traction is given by $\\sigma(u) = -n_b F(r) = -n_b F(r_0 + u)$, where $n_b$ is the number of bonds per unit area.\n$$\n\\sigma(u) = -2\\alpha D n_b \\left[\\exp(-2\\alpha u) - \\exp(-\\alpha u)\\right] = 2\\alpha D n_b \\left[\\exp(-\\alpha u) - \\exp(-2\\alpha u)\\right]\n$$\nThe theoretical brittle strength, $\\sigma_{\\mathrm{th}}$, is the maximum value of this traction. To find it, we set the derivative of $\\sigma(u)$ with respect to $u$ to zero:\n$$\n\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}u} = 2\\alpha D n_b \\left[-\\alpha\\exp(-\\alpha u) - (-2\\alpha)\\exp(-2\\alpha u)\\right] = 0\n$$\n$$\n-\\alpha\\exp(-\\alpha u) + 2\\alpha\\exp(-2\\alpha u) = 0\n$$\nSince $\\alpha \\neq 0$, we can divide by it. Let $x = \\exp(-\\alpha u)$. The equation becomes $-x + 2x^2 = 0$, or $x(2x - 1) = 0$. Since $x = \\exp(-\\alpha u)$ cannot be zero for any finite $u$, the solution is $x = 1/2$.\n$$\n\\exp(-\\alpha u_{\\mathrm{max}}) = \\frac{1}{2}\n$$\nThis gives the separation $u_{\\mathrm{max}}$ at which the traction is maximum. Substituting this back into the expression for $\\sigma(u)$:\n$$\n\\sigma_{\\mathrm{th}} = \\sigma(u_{\\mathrm{max}}) = 2\\alpha D n_b \\left[\\left(\\frac{1}{2}\\right) - \\left(\\frac{1}{2}\\right)^2\\right] = 2\\alpha D n_b \\left(\\frac{1}{2} - \\frac{1}{4}\\right) = 2\\alpha D n_b \\left(\\frac{1}{4}\\right)\n$$\n$$\n\\sigma_{\\mathrm{th}} = \\frac{\\alpha D n_b}{2}\n$$\nThis expression contains the microscopic parameters $\\alpha$, $D$, and $n_b$. We must express them in terms of the macroscopic parameters $E$, $\\gamma$, and $r_0$.\n\nFrom the problem statement, the work of complete separation per unit area, $2\\gamma$, is the sum of energies to break all bonds per unit area. This is given by $2\\gamma = n_b D$. Substituting this into the expression for $\\sigma_{\\mathrm{th}}$:\n$$\n\\sigma_{\\mathrm{th}} = \\frac{\\alpha(n_b D)}{2} = \\frac{\\alpha(2\\gamma)}{2} = \\alpha\\gamma\n$$\nNow we need to find an expression for $\\alpha$. This can be done by relating the macroscopic Young's modulus $E$ to the curvature of the interatomic potential at equilibrium.\nFor small strains $\\varepsilon = u/r_0 = (r-r_0)/r_0$, Hooke's law gives $\\sigma = E\\varepsilon = E(r-r_0)/r_0$.\nAtomistically, for small separations $u$, the force can be linearized: $F(r) \\approx F(r_0) + \\frac{\\mathrm{d}F}{\\mathrm{d}r}\\big|_{r=r_0}(r-r_0)$.\nSince $F(r_0)=0$, we have $F(r) \\approx \\frac{\\mathrm{d}F}{\\mathrm{d}r}\\big|_{r=r_0}(r-r_0)$.\nThe term $\\frac{\\mathrm{d}F}{\\mathrm{d}r}\\big|_{r=r_0}$ relates to the bond stiffness $k = \\frac{\\mathrm{d}^2U}{\\mathrm{d}r^2}\\big|_{r=r_0} = -\\frac{\\mathrm{d}F}{\\mathrm{d}r}\\big|_{r=r_0}$.\nLet's calculate $k$:\n$$\n\\frac{\\mathrm{d}F}{\\mathrm{d}r} = 2\\alpha D \\left[-2\\alpha\\exp(-2\\alpha(r-r_0)) + \\alpha\\exp(-\\alpha(r-r_0))\\right]\n$$\nAt $r=r_0$:\n$$\n\\frac{\\mathrm{d}F}{\\mathrm{d}r}\\bigg|_{r=r_0} = 2\\alpha D \\left[-2\\alpha + \\alpha\\right] = -2\\alpha^2 D\n$$\nSo, the bond stiffness is $k = -\\frac{\\mathrm{d}F}{\\mathrm{d}r}\\big|_{r=r_0} = 2\\alpha^2 D$.\nThe tensile traction for small separations is $\\sigma(u) = -n_b F(r_0+u) \\approx -n_b \\left(\\frac{\\mathrm{d}F}{\\mathrm{d}r}\\big|_{r=r_0} u\\right) = n_b k u = n_b(2\\alpha^2 D)u$.\nReplacing $u$ with $(r-r_0)$:\n$$\n\\sigma = n_b(2\\alpha^2 D)(r-r_0)\n$$\nEquating the continuum and atomistic expressions for $\\sigma$ in the small-strain limit:\n$$\nE\\frac{(r-r_0)}{r_0} = n_b(2\\alpha^2 D)(r-r_0)\n$$\n$$\n\\frac{E}{r_0} = 2\\alpha^2 n_b D\n$$\nUsing the relation $n_b D = 2\\gamma$:\n$$\n\\frac{E}{r_0} = 2\\alpha^2 (2\\gamma) = 4\\alpha^2\\gamma\n$$\nSolving for $\\alpha$:\n$$\n\\alpha^2 = \\frac{E}{4\\gamma r_0} \\quad \\implies \\quad \\alpha = \\sqrt{\\frac{E}{4\\gamma r_0}} = \\frac{1}{2}\\sqrt{\\frac{E}{\\gamma r_0}}\n$$\nFinally, substitute this expression for $\\alpha$ back into the equation for theoretical strength, $\\sigma_{\\mathrm{th}} = \\alpha\\gamma$:\n$$\n\\sigma_{\\mathrm{th}} = \\left(\\frac{1}{2}\\sqrt{\\frac{E}{\\gamma r_0}}\\right)\\gamma = \\frac{1}{2}\\sqrt{\\frac{E\\gamma^2}{\\gamma r_0}}\n$$\n$$\n\\sigma_{\\mathrm{th}} = \\frac{1}{2}\\sqrt{\\frac{E\\gamma}{r_0}}\n$$\nThis is the desired expression for the theoretical brittle strength.\n\nNow, we compute the numerical value using the provided data: $E = 200\\,\\mathrm{GPa}$, $\\gamma = 1.5\\,\\mathrm{J/m^2}$, and $r_0 = 0.25\\,\\mathrm{nm}$. We must use SI units for consistency.\n$E = 200 \\times 10^9\\,\\mathrm{Pa}$\n$\\gamma = 1.5\\,\\mathrm{J/m^2}$\n$r_0 = 0.25 \\times 10^{-9}\\,\\mathrm{m}$\n\n$$\n\\sigma_{\\mathrm{th}} = \\frac{1}{2}\\sqrt{\\frac{(200 \\times 10^9\\,\\mathrm{Pa}) \\times (1.5\\,\\mathrm{J/m^2})}{0.25 \\times 10^{-9}\\,\\mathrm{m}}}\n$$\nThe argument of the square root is:\n$$\n\\frac{300 \\times 10^9}{0.25 \\times 10^{-9}} \\,\\frac{\\mathrm{Pa} \\cdot \\mathrm{J/m^2}}{\\mathrm{m}} = \\frac{300}{0.25} \\times 10^{18} \\,\\frac{\\mathrm{N/m^2} \\cdot \\mathrm{N\\cdot m/m^2}}{\\mathrm{m}} = 1200 \\times 10^{18} \\,\\frac{\\mathrm{N^2}}{\\mathrm{m^4}} = 1.2 \\times 10^{21}\\,\\mathrm{Pa^2}\n$$\nTaking the square root:\n$$\n\\sqrt{1.2 \\times 10^{21}\\,\\mathrm{Pa^2}} = \\sqrt{12 \\times 10^{20}\\,\\mathrm{Pa^2}} = \\sqrt{12} \\times 10^{10}\\,\\mathrm{Pa} \\approx 3.4641 \\times 10^{10}\\,\\mathrm{Pa}\n$$\nFinally, multiplying by $1/2$:\n$$\n\\sigma_{\\mathrm{th}} = \\frac{1}{2} \\times (3.4641 \\times 10^{10}\\,\\mathrm{Pa}) \\approx 1.73205 \\times 10^{10}\\,\\mathrm{Pa}\n$$\nExpressing the result in Gigapascals (GPa), where $1\\,\\mathrm{GPa} = 10^9\\,\\mathrm{Pa}$:\n$$\n\\sigma_{\\mathrm{th}} \\approx \\frac{1.73205 \\times 10^{10}}{10^9} \\,\\mathrm{GPa} \\approx 17.3205\\,\\mathrm{GPa}\n$$\nRounding to three significant figures, we get $17.3\\,\\mathrm{GPa}$.\n\nThe theoretical brittle strength represents a physical limit on the stress that atomic bonds can sustain. In the context of continuum mechanics, models like Linear Elastic Fracture Mechanics (LEFM) predict an unphysical stress singularity at a sharp crack tip. The concept of a theoretical strength, $\\sigma_{\\mathrm{th}}$, resolves this by providing a natural cutoff. The stress at the very tip of a crack in a real material cannot exceed this value. When the local stress approaches $\\sigma_{\\mathrm{th}}$, the continuum description breaks down, and the material enters a \"fracture process zone\" where discrete atomic-level processes, namely bond stretching and breaking, become dominant. The value $\\sigma_{\\mathrm{th}}$ corresponds to the onset of bond-breaking instability; once this stress is reached, the force required to further separate the atoms decreases, leading to catastrophic failure of the bond and subsequent crack propagation. This entire process is confined to a very small region near the crack tip, typically on the order of a few lattice spacings. Thus, $\\sigma_{\\mathrm{th}}$ is a crucial parameter linking atomistic behavior to macroscopic fracture criteria.",
            "answer": "$$\\boxed{17.3}$$"
        },
        {
            "introduction": "A primary challenge in multiscale modeling is to correctly impose a macroscopic load, characterized by a stress intensity factor like $K_I$, onto a small, atomistic simulation cell. This practice guides you through applying the continuum displacement field from Linear Elastic Fracture Mechanics (LEFM) to set realistic boundary conditions for atoms surrounding a crack tip . You will then computationally verify that the imposed field reproduces the characteristic $\\sqrt{r}$ displacement scaling, a fundamental check that validates the setup of any atomistic crack simulation.",
            "id": "3734046",
            "problem": "You are asked to implement a program that constructs atomistic boundary displacement fields consistent with the continuum Mode I (opening mode) crack solution under plane strain for a given crystal treated as an isotropic elastic solid, and then verifies the near-tip displacement scaling $u \\sim \\sqrt{r}$. The solution must be derived from fundamental principles and then encoded and executed to produce specified outputs for a defined test suite. The program must be self-contained and produce a single line of output in the required format.\n\nThe physical foundation must begin from the following base:\n- Linear elasticity with Hooke’s law relating stress and strain, and the kinematic relation connecting displacement gradients to strain, with small-deformation assumptions.\n- Equilibrium of stresses in the absence of body forces near the crack tip.\n- The near-tip asymptotics of Linear Elastic Fracture Mechanics (LEFM), which state that for a sharp crack in an isotropic elastic medium, the stress intensity factor $K_I$ characterizes the amplitude of the singular near-tip fields and that the displacement field has a square-root dependence on radius $r$ from the crack tip.\n- Plane strain conditions, with effective modulus $E' = E/(1-\\nu^2)$, where $E$ is Young’s modulus and $\\nu$ is Poisson’s ratio, and the Kolosov constant $\\kappa = 3 - 4\\nu$ in plane strain.\n\nYour task is to:\n1. Derive the continuum near-tip displacement field $u_x(r,\\theta)$ and $u_y(r,\\theta)$ for Mode I under plane strain using the above foundations, expressed in polar coordinates $(r,\\theta)$ around the crack tip and converted to Cartesian displacements. From the derivation, show that the displacement magnitude $u(r,\\theta)$ exhibits the scaling $u \\propto \\sqrt{r}$ modulated by an angular function that depends on $\\theta$ and material parameters $E$, $\\nu$, $K_I$.\n2. Construct atomistic boundary nodes as a set of discrete points lying on a family of concentric circular rings (representing boundary atoms around the crack tip) at radii $r_k$ and angles $\\theta_j$. For each such node, apply the derived continuum displacement field to define its boundary displacement. Treat the underlying crystal as an isotropic elastic medium in this construction. Use angles in radians, and compute displacements in meters.\n3. Verify the near-tip displacement scaling by calculating, for each radius $r_k$, the average displacement magnitude $\\overline{u}(r_k)$ over the set of angles $\\theta_j$ (excluding angles arbitrarily close to the crack surfaces at $\\theta = \\pm \\pi$ where branch cuts occur). Perform a log-log regression of $\\overline{u}(r_k)$ versus $r_k$ to estimate the slope $s$. Confirm that $s$ is close to $0.5$.\n\nImplementation instructions:\n- Use the following plan for constructing the atomistic boundary nodes:\n  - For each test case, select radii $\\{r_k\\}$ that are geometrically spaced between a minimum radius $r_{\\min}$ and a maximum radius $r_{\\max}$, where $r_{\\min}$ and $r_{\\max}$ are proportional to a lattice constant $a$.\n  - Select angles $\\{\\theta_j\\}$ uniformly in $[-\\pi, \\pi]$ excluding a small tolerance window of width $\\Delta \\theta$ around $\\theta = \\pm \\pi$ to avoid the crack surfaces, since $u(r,\\theta)$ must be single-valued away from the branch cut.\n  - Assign atomistic boundary displacements to each $(r_k,\\theta_j)$ using your derived continuum field under plane strain.\n\n- Units:\n  - Young’s modulus $E$ must be in Pascals ($\\text{Pa}$).\n  - Poisson’s ratio $\\nu$ is dimensionless.\n  - The Mode I stress intensity factor $K_I$ must be in $\\text{Pa}\\sqrt{\\text{m}}$.\n  - The lattice constant $a$, radii $r_k$, and displacements $u$ must be in meters ($\\text{m}$).\n  - Angles $\\theta$ must be in radians.\n\n- Slope verification:\n  - For each test case, compute the least-squares slope $s$ of $\\log \\overline{u}(r_k)$ versus $\\log r_k$. Also compute a boolean flag $b$ that is true if $|s - 0.5| \\leq \\tau$, where $\\tau$ is a specified tolerance.\n  - Output for all test cases must be aggregated into a single line as a comma-separated list enclosed in square brackets, containing for each test case the slope followed by the boolean (e.g., $[s_1,b_1,s_2,b_2,s_3,b_3]$). The slope is dimensionless and the boolean is either true or false.\n\nTest suite:\nImplement the program for the following three test cases. Use the specified parameters and selections:\n\n- Test case 1 (happy path, typical metallic crystal):\n  - $E = 210\\times 10^9\\ \\text{Pa}$,\n  - $\\nu = 0.30$,\n  - $K_I = 30\\times 10^6\\ \\text{Pa}\\sqrt{\\text{m}}$,\n  - lattice constant $a = 2.5\\times 10^{-10}\\ \\text{m}$,\n  - number of radii $n_r = 12$ logarithmically spaced between $r_{\\min} = 2a$ and $r_{\\max} = 256a$,\n  - number of angles $n_\\theta = 181$ uniformly spaced in $[-\\pi+\\Delta \\theta,\\pi-\\Delta \\theta]$ with $\\Delta \\theta = 0.05$ radians,\n  - tolerance $\\tau = 10^{-10}$ on the slope.\n\n- Test case 2 (near-incompressible isotropic crystal, boundary condition):\n  - $E = 70\\times 10^9\\ \\text{Pa}$,\n  - $\\nu = 0.49$,\n  - $K_I = 10\\times 10^6\\ \\text{Pa}\\sqrt{\\text{m}}$,\n  - lattice constant $a = 2.0\\times 10^{-10}\\ \\text{m}$,\n  - number of radii $n_r = 14$ logarithmically spaced between $r_{\\min} = 3a$ and $r_{\\max} = 512a$,\n  - number of angles $n_\\theta = 241$ uniformly spaced in $[-\\pi+\\Delta \\theta,\\pi-\\Delta \\theta]$ with $\\Delta \\theta = 0.05$ radians,\n  - tolerance $\\tau = 10^{-10}$ on the slope.\n\n- Test case 3 (low Poisson ratio isotropic crystal, edge case):\n  - $E = 130\\times 10^9\\ \\text{Pa}$,\n  - $\\nu = 0.10$,\n  - $K_I = 50\\times 10^6\\ \\text{Pa}\\sqrt{\\text{m}}$,\n  - lattice constant $a = 2.2\\times 10^{-10}\\ \\text{m}$,\n  - number of radii $n_r = 16$ logarithmically spaced between $r_{\\min} = 2a$ and $r_{\\max} = 1024a$,\n  - number of angles $n_\\theta = 121$ uniformly spaced in $[-\\pi+\\Delta \\theta,\\pi-\\Delta \\theta]$ with $\\Delta \\theta = 0.05$ radians,\n  - tolerance $\\tau = 10^{-10}$ on the slope.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[s_1,b_1,s_2,b_2,s_3,b_3]$). Each $s_i$ is a float and each $b_i$ is a boolean. No other output should be printed.",
            "solution": "The problem is deemed valid as it is scientifically grounded in linear elastic fracture mechanics, well-posed with all necessary parameters provided, and objectively formulated. The task is to derive and implement the continuum near-tip displacement field for a Mode I crack under plane strain, apply it to a discrete set of boundary points, and verify the theoretical displacement scaling.\n\n### Part 1: Derivation of the Near-Tip Displacement Field\n\nThe starting point is the standard solution for the near-tip displacement field around a sharp crack in an isotropic, linearly elastic material under Mode I loading conditions. The crack is assumed to lie on the negative $x$-axis, with its tip at the origin of a polar coordinate system $(r, \\theta)$. For plane strain conditions, the displacement components $u_x$ and $u_y$ in Cartesian coordinates are derived from the stress and strain fields.\n\nThe governing relations are:\n1.  **Hooke's Law for Plane Strain**: The strain components ($\\epsilon_{xx}$, $\\epsilon_{yy}$, $\\epsilon_{xy}$) are related to stress components ($\\sigma_{xx}$, $\\sigma_{yy}$, $\\sigma_{xy}$) as:\n    $$ \\epsilon_{xx} = \\frac{1}{E'} (\\sigma_{xx} - \\nu' \\sigma_{yy}) $$\n    $$ \\epsilon_{yy} = \\frac{1}{E'} (\\sigma_{yy} - \\nu' \\sigma_{xx}) $$\n    $$ \\epsilon_{xy} = \\frac{1}{2G} \\sigma_{xy} = \\frac{1+\\nu}{E} \\sigma_{xy} $$\n    For plane strain, the effective modulus is $E' = E/(1-\\nu^2)$ and the effective Poisson's ratio is $\\nu' = \\nu/(1-\\nu)$. However, it is more direct to use the shear modulus $G = E/(2(1+\\nu))$ and the Kolosov constant $\\kappa = 3-4\\nu$.\n\n2.  **Strain-Displacement Relations**: For small deformations, strains are gradients of the displacement vector $\\mathbf{u} = (u_x, u_y)$:\n    $$ \\epsilon_{xx} = \\frac{\\partial u_x}{\\partial x}, \\quad \\epsilon_{yy} = \\frac{\\partial u_y}{\\partial y}, \\quad \\epsilon_{xy} = \\frac{1}{2} \\left( \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} \\right) $$\n\nThe near-tip stress field, characterized by the Mode I stress intensity factor $K_I$, is given by the Williams-Westergaard solution:\n$$ \\sigma_{xx} = \\frac{K_I}{\\sqrt{2\\pi r}} \\cos\\frac{\\theta}{2} \\left(1 - \\sin\\frac{\\theta}{2}\\sin\\frac{3\\theta}{2}\\right) $$\n$$ \\sigma_{yy} = \\frac{K_I}{\\sqrt{2\\pi r}} \\cos\\frac{\\theta}{2} \\left(1 + \\sin\\frac{\\theta}{2}\\sin\\frac{3\\theta}{2}\\right) $$\n$$ \\sigma_{xy} = \\frac{K_I}{\\sqrt{2\\pi r}} \\sin\\frac{\\theta}{2}\\cos\\frac{\\theta}{2}\\cos\\frac{3\\theta}{2} $$\n\nBy substituting these stress expressions into Hooke's law and integrating the strain-displacement relations, one obtains the displacement field. Standard derivations in fracture mechanics literature yield the displacement components in Cartesian coordinates as functions of polar coordinates $(r, \\theta)$. For plane strain, a common and convenient form is:\n$$ u_x(r, \\theta) = \\frac{K_I}{G} \\sqrt{\\frac{r}{2\\pi}} \\cos\\frac{\\theta}{2} \\left( \\frac{\\kappa - 1}{2} - \\sin^2\\frac{\\theta}{2} \\right) $$\n$$ u_y(r, \\theta) = \\frac{K_I}{G} \\sqrt{\\frac{r}{2\\pi}} \\sin\\frac{\\theta}{2} \\left( \\frac{\\kappa + 1}{2} - \\cos^2\\frac{\\theta}{2} \\right) $$\nwhere $G = E/(2(1+\\nu))$ is the shear modulus and $\\kappa = 3-4\\nu$ is the Kolosov constant for plane strain, as specified.\n\nTo implement these formulas using the provided material constants $E$ and $\\nu$, we substitute the expressions for $G$ and $\\kappa$:\n$$ \\frac{1}{G} = \\frac{2(1+\\nu)}{E} $$\n$$ \\frac{\\kappa-1}{2} = \\frac{(3-4\\nu)-1}{2} = 1-2\\nu $$\n$$ \\frac{\\kappa+1}{2} = \\frac{(3-4\\nu)+1}{2} = 2-2\\nu $$\n\nSubstituting these back into the displacement equations gives the final form used for computation:\n$$ u_x(r, \\theta) = \\frac{2K_I(1+\\nu)}{E} \\sqrt{\\frac{r}{2\\pi}} \\cos\\frac{\\theta}{2} \\left( 1 - 2\\nu - \\sin^2\\frac{\\theta}{2} \\right) $$\n$$ u_y(r, \\theta) = \\frac{2K_I(1+\\nu)}{E} \\sqrt{\\frac{r}{2\\pi}} \\sin\\frac{\\theta}{2} \\left( 2 - 2\\nu - \\cos^2\\frac{\\theta}{2} \\right) $$\n\nThese equations explicitly show that both $u_x$ and $u_y$ are proportional to $\\sqrt{r}$. Consequently, the magnitude of the displacement vector, $u(r, \\theta) = \\sqrt{u_x(r, \\theta)^2 + u_y(r, \\theta)^2}$, must also be proportional to $\\sqrt{r}$:\n$$ u(r, \\theta) = \\sqrt{r} \\cdot F(K_I, E, \\nu, \\theta) $$\nwhere $F$ encapsulates all other terms. This confirms the theoretical scaling $u \\propto \\sqrt{r}$.\n\n### Part 2: Algorithmic Construction and Verification\n\nThe numerical procedure to verify this scaling relationship involves several steps:\n1.  **Node Generation**: For each test case, a set of discrete points (nodes) is generated.\n    - The radii $\\{r_k\\}_{k=1}^{n_r}$ are logarithmically (geometrically) spaced between a specified $r_{\\min}$ and $r_{\\max}$, which are defined relative to the lattice constant $a$.\n    - The angles $\\{\\theta_j\\}_{j=1}^{n_\\theta}$ are uniformly spaced in the interval $[-\\pi + \\Delta\\theta, \\pi - \\Delta\\theta]$ to avoid the mathematical singularity and multi-valuedness on the crack surface (branch cut at $\\theta=\\pm\\pi$).\n\n2.  **Displacement Calculation**: For each node at $(r_k, \\theta_j)$, the Cartesian displacement components $(u_x, u_y)$ are computed using the derived formulas. The magnitude of the displacement, $u_{kj} = \\sqrt{u_x(r_k, \\theta_j)^2 + u_y(r_k, \\theta_j)^2}$, is then calculated.\n\n3.  **Averaging**: For each radius $r_k$, the displacement magnitudes are averaged over all angles $\\theta_j$ to obtain a single representative displacement magnitude $\\overline{u}(r_k)$:\n    $$ \\overline{u}(r_k) = \\frac{1}{n_{\\theta}} \\sum_{j=1}^{n_{\\theta}} u_{kj} $$\n    This averaging smooths out the angular dependence, resulting in a cleaner power-law relationship between $\\overline{u}$ and $r$.\n\n4.  **Scaling Verification via Regression**: The relationship $\\overline{u}(r) \\approx C \\cdot r^{0.5}$ implies a linear relationship in a log-log plot: $\\log(\\overline{u}(r)) \\approx 0.5 \\log(r) + \\log(C)$. To verify this, we perform a linear least-squares regression on the set of points $\\{(\\log r_k, \\log \\overline{u}(r_k))\\}_{k=1}^{n_r}$.\n    - The slope $s$ of the regression line is calculated using the formula:\n      $$ s = \\frac{n_r \\sum(\\log r_k \\log \\overline{u}_k) - (\\sum \\log r_k)(\\sum \\log \\overline{u}_k)}{n_r \\sum(\\log r_k)^2 - (\\sum \\log r_k)^2} $$\n    - The theoretical expectation is $s=0.5$. The computed slope is compared against this value. A boolean flag $b$ is set to true if the absolute difference $|s - 0.5|$ is within a given tolerance $\\tau$. This validates both the underlying theory and its numerical implementation.\n\nThis procedure is systematically applied to each test case provided in the problem statement.",
            "answer": "```python\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Solves the crack tip displacement problem for a suite of test cases.\n\n    This function iterates through predefined test cases, each specifying material\n    properties (E, nu), fracture toughness (K_I), and geometric parameters for\n    constructing a set of atomistic boundary nodes. For each case, it:\n    1. Derives the continuum displacement field for a Mode I crack under plane strain.\n    2. Applies these displacements to nodes arranged on concentric circles.\n    3. Calculates the average displacement magnitude at each radius.\n    4. Performs a log-log linear regression of average displacement vs. radius\n       to find the slope, verifying the theoretical u ~ sqrt(r) scaling.\n    5. Compares the resulting slope to the theoretical value of 0.5.\n    \n    The results (slope and a boolean verification flag) for all test cases\n    are aggregated and printed in a single formatted line.\n    \"\"\"\n    test_cases = [\n        {\n            \"E\": 210e9, \"nu\": 0.30, \"K_I\": 30e6, \"a\": 2.5e-10,\n            \"n_r\": 12, \"r_min_factor\": 2, \"r_max_factor\": 256,\n            \"n_theta\": 181, \"delta_theta\": 0.05, \"tau\": 1e-10\n        },\n        {\n            \"E\": 70e9, \"nu\": 0.49, \"K_I\": 10e6, \"a\": 2.0e-10,\n            \"n_r\": 14, \"r_min_factor\": 3, \"r_max_factor\": 512,\n            \"n_theta\": 241, \"delta_theta\": 0.05, \"tau\": 1e-10\n        },\n        {\n            \"E\": 130e9, \"nu\": 0.10, \"K_I\": 50e6, \"a\": 2.2e-10,\n            \"n_r\": 16, \"r_min_factor\": 2, \"r_max_factor\": 1024,\n            \"n_theta\": 121, \"delta_theta\": 0.05, \"tau\": 1e-10\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        E = case[\"E\"]\n        nu = case[\"nu\"]\n        K_I = case[\"K_I\"]\n        a = case[\"a\"]\n        n_r = case[\"n_r\"]\n        r_min = case[\"r_min_factor\"] * a\n        r_max = case[\"r_max_factor\"] * a\n        n_theta = case[\"n_theta\"]\n        delta_theta = case[\"delta_theta\"]\n        tau = case[\"tau\"]\n\n        # 1. Generate node coordinates\n        r_vals = np.logspace(np.log10(r_min), np.log10(r_max), num=n_r)\n        theta_vals = np.linspace(-np.pi + delta_theta, np.pi - delta_theta, num=n_theta)\n\n        # 2. Calculate displacements and average magnitudes\n        avg_u_vals = []\n        for r in r_vals:\n            # Vectorized calculation over all theta values for a given r\n            cos_theta_half = np.cos(theta_vals / 2.0)\n            sin_theta_half = np.sin(theta_vals / 2.0)\n\n            # Prefactor in displacement equations\n            prefactor = (2.0 * K_I * (1.0 + nu) / E) * np.sqrt(r / (2.0 * np.pi))\n            \n            # Displacement component u_x\n            term_x = 1.0 - 2.0 * nu - sin_theta_half**2\n            u_x = prefactor * cos_theta_half * term_x\n            \n            # Displacement component u_y\n            term_y = 2.0 - 2.0 * nu - cos_theta_half**2\n            u_y = prefactor * sin_theta_half * term_y\n\n            # Magnitude of displacement vector\n            u_mag = np.sqrt(u_x**2 + u_y**2)\n            \n            # Average magnitude over all angles\n            avg_u = np.mean(u_mag)\n            avg_u_vals.append(avg_u)\n\n        # 3. Perform log-log regression\n        log_r = np.log(r_vals)\n        log_u = np.log(np.array(avg_u_vals))\n        \n        # Using scipy.stats.linregress for robustness and clarity\n        regression_result = stats.linregress(log_r, log_u)\n        slope = regression_result.slope\n\n        # 4. Verify slope against theoretical value 0.5\n        is_valid_scaling = abs(slope - 0.5) = tau\n        \n        results.append(f\"{slope:.12f}\")\n        results.append(str(is_valid_scaling).lower())\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Atomistic simulations are performed on finite systems, yet our goal is to predict the behavior of effectively infinite, real-world materials. This practice introduces finite-size scaling, a powerful data analysis technique used to systematically correct for artifacts introduced by simulation boundaries . By fitting simulation data from various system sizes to a physically-motivated expansion, you will learn how to extrapolate the true, infinite-system fracture toughness, $K_c^\\infty$, a critical material property, from your finite-sized results.",
            "id": "3734035",
            "problem": "You are given atomistically computed critical stress intensity factors $K_c(L)$ for cracks embedded in finite periodic or bounded simulation boxes of linear dimension $L$. In linear elastic fracture mechanics (LEFM), the energy release rate $G$ scales as $G \\propto K^2/E'$ where $E'$ is an effective elastic modulus depending on plane stress or plane strain, and the near-tip fields are governed by asymptotic singular solutions. In an infinite system, the onset of crack advancement occurs at the size-independent threshold $K_c^\\infty$. In a finite atomistic box, however, the long-range elastic fields are truncated or distorted by boundaries, generating a systematic bias in the measured $K_c(L)$. For boxes that are large compared to a characteristic atomistic process-zone length $\\ell_p$, the distortion can be modeled as a regular perturbation in the dimensionless ratio $\\ell_p/L$. The leading corrections to the near-tip field compliance appear as a series in powers of $\\ell_p/L$. Consequently, for $L \\gg \\ell_p$, it is appropriate to represent the finite-size response by the expansion\n$$\nK_c(L) = K_c^\\infty \\left[ 1 + \\alpha \\left(\\frac{\\ell_p}{L}\\right) + \\beta \\left(\\frac{\\ell_p}{L}\\right)^2 \\right] + \\mathcal{O}\\left( \\left(\\frac{\\ell_p}{L}\\right)^3 \\right),\n$$\nwhere $K_c^\\infty$ is the infinite-system critical stress intensity factor, $\\alpha$ and $\\beta$ are dimensionless coefficients determined by the boundary condition class and lattice-scale perturbations, and $\\ell_p$ is the process-zone length setting the cutoff scale where atomistic discreteness regularizes the singular field.\n\nYour task is to implement a program that, given sets of $(L, \\ell_p, K_c(L))$ values, performs a finite-size scaling fit to extract $K_c^\\infty$ while accounting for boundary-induced field distortion up to second order in $\\ell_p/L$. To obtain a linear regression structure, reparameterize the model as\n$$\nK_c(L) = A_0 + A_1 \\left(\\frac{\\ell_p}{L}\\right) + A_2 \\left(\\frac{\\ell_p}{L}\\right)^2,\n$$\nwhere $A_0 = K_c^\\infty$, $A_1 = K_c^\\infty \\alpha$, and $A_2 = K_c^\\infty \\beta$. Fit $(A_0, A_1, A_2)$ in the least-squares sense, and report $K_c^\\infty = A_0$.\n\nUse the following test suite of independent cases that probe different regimes. All lengths $L$ and $\\ell_p$ are in meters and all $K_c$ values are in megapascal times square root of meter (MPa·$\\sqrt{\\mathrm{m}}$). Your program should output the extrapolated $K_c^\\infty$ for each case in MPa·$\\sqrt{\\mathrm{m}}$, rounded to six decimal places.\n\n- Test case $1$ (general case with both first- and second-order corrections nonzero):\n  - $\\ell_p = 3\\times 10^{-9}\\,\\mathrm{m}$,\n  - $L \\in \\{30\\times 10^{-9}\\,\\mathrm{m},\\,60\\times 10^{-9}\\,\\mathrm{m},\\,120\\times 10^{-9}\\,\\mathrm{m},\\,240\\times 10^{-9}\\,\\mathrm{m}\\}$,\n  - $K_c(L) \\in \\{1.572,\\,1.53675,\\,1.5185625,\\,1.509328125\\}\\,\\mathrm{MPa}\\cdot\\sqrt{\\mathrm{m}}$.\n\n- Test case $2$ (dominant second-order distortion with vanishing first-order term):\n  - $\\ell_p = 2\\times 10^{-9}\\,\\mathrm{m}$,\n  - $L \\in \\{40\\times 10^{-9}\\,\\mathrm{m},\\,80\\times 10^{-9}\\,\\mathrm{m},\\,160\\times 10^{-9}\\,\\mathrm{m},\\,320\\times 10^{-9}\\,\\mathrm{m}\\}$,\n  - $K_c(L) \\in \\{2.004,\\,2.001,\\,2.00025,\\,2.0000625\\}\\,\\mathrm{MPa}\\cdot\\sqrt{\\mathrm{m}}$.\n\n- Test case $3$ (strong finite-size effect with large $\\ell_p/L$):\n  - $\\ell_p = 5\\times 10^{-9}\\,\\mathrm{m}$,\n  - $L \\in \\{10\\times 10^{-9}\\,\\mathrm{m},\\,20\\times 10^{-9}\\,\\mathrm{m},\\,40\\times 10^{-9}\\,\\mathrm{m}\\}$,\n  - $K_c(L) \\in \\{1.44,\\,1.17,\\,1.035\\}\\,\\mathrm{MPa}\\cdot\\sqrt{\\mathrm{m}}$.\n\n- Test case $4$ (noisy measurements superimposed on the second-order model):\n  - $\\ell_p = 4\\times 10^{-9}\\,\\mathrm{m}$,\n  - $L \\in \\{50\\times 10^{-9}\\,\\mathrm{m},\\,100\\times 10^{-9}\\,\\mathrm{m},\\,200\\times 10^{-9}\\,\\mathrm{m},\\,400\\times 10^{-9}\\,\\mathrm{m},\\,800\\times 10^{-9}\\,\\mathrm{m}\\}$,\n  - $K_c(L) \\in \\{1.895248,\\,1.827912,\\,1.841528,\\,1.805782,\\,1.8053955\\}\\,\\mathrm{MPa}\\cdot\\sqrt{\\mathrm{m}}$.\n\nAlgorithmic requirements:\n- Construct the design matrix with columns $[1,\\,(\\ell_p/L),\\,(\\ell_p/L)^2]$ for each case and solve for $(A_0, A_1, A_2)$ via least squares.\n- Extract and report $A_0$ as $K_c^\\infty$ for each case.\n- Express the final outputs in MPa·$\\sqrt{\\mathrm{m}}$, rounded to six decimal places.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[r_1,r_2,r_3,r_4]$, where each $r_i$ is the rounded float corresponding to the extrapolated $K_c^\\infty$ of test case $i$ in MPa·$\\sqrt{\\mathrm{m}}$.",
            "solution": "The user wants me to solve a problem about finite-size scaling in atomistic simulations of crack tips.\n\n### Step 1: Extract Givens\nThe problem provides the following information:\n1.  **Model Equation**: The critical stress intensity factor $K_c(L)$ for a finite system of size $L$ is related to the infinite-system value $K_c^\\infty$ by the expansion:\n    $$\n    K_c(L) = K_c^\\infty \\left[ 1 + \\alpha \\left(\\frac{\\ell_p}{L}\\right) + \\beta \\left(\\frac{\\ell_p}{L}\\right)^2 \\right] + \\mathcal{O}\\left( \\left(\\frac{\\ell_p}{L}\\right)^3 \\right)\n    $$\n2.  **Reparameterized Linear Model**: For fitting purposes, the model is rewritten as:\n    $$\n    K_c(L) = A_0 + A_1 \\left(\\frac{\\ell_p}{L}\\right) + A_2 \\left(\\frac{\\ell_p}{L}\\right)^2\n    $$\n    where $A_0 = K_c^\\infty$, $A_1 = K_c^\\infty \\alpha$, and $A_2 = K_c^\\infty \\beta$.\n3.  **Task**: Fit the coefficients $(A_0, A_1, A_2)$ using a least-squares method for given datasets of $(\\ell_p, L, K_c(L))$ and report the value of $A_0 = K_c^\\infty$.\n4.  **Test Cases** (all lengths in meters, all $K_c$ in MPa$\\cdot\\sqrt{\\mathrm{m}}$):\n    *   **Case 1**:\n        *   $\\ell_p = 3 \\times 10^{-9}$\n        *   $L = \\{30, 60, 120, 240\\} \\times 10^{-9}$\n        *   $K_c(L) = \\{1.572, 1.53675, 1.5185625, 1.509328125\\}$\n    *   **Case 2**:\n        *   $\\ell_p = 2 \\times 10^{-9}$\n        *   $L = \\{40, 80, 160, 320\\} \\times 10^{-9}$\n        *   $K_c(L) = \\{2.004, 2.001, 2.00025, 2.0000625\\}$\n    *   **Case 3**:\n        *   $\\ell_p = 5 \\times 10^{-9}$\n        *   $L = \\{10, 20, 40\\} \\times 10^{-9}$\n        *   $K_c(L) = \\{1.44, 1.17, 1.035\\}$\n    *   **Case 4**:\n        *   $\\ell_p = 4 \\times 10^{-9}$\n        *   $L = \\{50, 100, 200, 400, 800\\} \\times 10^{-9}$\n        *   $K_c(L) = \\{1.895248, 1.827912, 1.841528, 1.805782, 1.8053955\\}$\n5.  **Algorithmic Requirement**: Construct a design matrix with columns for the constant, first-order, and second-order terms and solve via least squares.\n6.  **Output Format**: Report the extrapolated $K_c^\\infty$ for each case, rounded to six decimal places, in a comma-separated list enclosed in square brackets.\n\n### Step 2: Validate Using Extracted Givens\n*   **Scientifically Grounded**: The problem is well-grounded in the field of computational materials science and fracture mechanics. Finite-size scaling is a standard and critical technique for extrapolating results from finite-sized atomistic or continuum simulations to the macroscopic, infinite-system limit. The use of a Taylor-like expansion in the small parameter $\\ell_p/L$ is a common and physically motivated approach derived from perturbation theory of boundary effects. The concepts of linear elastic fracture mechanics (LEFM), stress intensity factor ($K$), process zone length ($\\ell_p$), and the distinction between atomistic and continuum scales are all standard and correctly applied. The problem is scientifically sound.\n*   **Well-Posed**: The problem requires solving a linear least-squares problem, which is a well-defined mathematical task. For each test case, we are given $n$ data points $(\\ell_p/L_i, K_c(L_i))$ to fit a $3$-parameter model ($A_0, A_1, A_2$). For cases 1, 2, and 4, the number of data points ($n=4, 4, 5$ respectively) is greater than or equal to the number of parameters ($p=3$), leading to a well-posed (overdetermined or exactly determined) least-squares problem. For case 3, $n=3$ and $p=3$, which corresponds to an exactly determined system. In all cases, the values of the independent variable, $\\ell_p/L$, are distinct, ensuring that the columns of the design matrix are linearly independent and that a unique solution for the coefficients exists.\n*   **Objective**: The problem is stated using precise mathematical formulas and quantitative data. The task is objective and free from subjective interpretation.\n*   **Completeness and Consistency**: All necessary data for each test case is provided. The units are consistent. The reparameterization is algebraically correct. The problem is self-contained and free of contradictions. The provided data values for lengths and stress intensity factors are physically plausible for atomistic simulations.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically sound, well-posed, objective, and self-contained. I will proceed with generating a solution.\n\n### Principle-Based Solution Strategy\nThe problem requires finding the coefficient $A_0$ in the linear model $K_c(L) = A_0 + A_1 x + A_2 x^2$, where $x = \\ell_p/L$. This is a standard multiple linear regression problem. For each test case, we are given a set of $n$ observations $(x_i, y_i)$, where $x_i = \\ell_p/L_i$ and $y_i = K_c(L_i)$. We want to find the vector of coefficients $\\mathbf{A} = [A_0, A_1, A_2]^T$ that minimizes the sum of the squares of the residuals.\n\nThe problem can be expressed in matrix form as $\\mathbf{y} = \\mathbf{X}\\mathbf{A} + \\boldsymbol{\\epsilon}$, where:\n- $\\mathbf{y}$ is the $n \\times 1$ column vector of observed $K_c(L)$ values.\n- $\\mathbf{X}$ is the $n \\times 3$ design matrix, where the $i$-th row is $[1, x_i, x_i^2]$.\n- $\\mathbf{A}$ is the $3 \\times 1$ column vector of coefficients $[A_0, A_1, A_2]^T$.\n- $\\boldsymbol{\\epsilon}$ is the vector of residuals.\n\nThe least-squares solution $\\hat{\\mathbf{A}}$ that minimizes $||\\mathbf{y} - \\mathbf{X}\\mathbf{A}||^2$ is given by the solution to the normal equations:\n$$\n(\\mathbf{X}^T \\mathbf{X}) \\hat{\\mathbf{A}} = \\mathbf{X}^T \\mathbf{y}\n$$\nAssuming $\\mathbf{X}^T \\mathbf{X}$ is invertible (which it is for our cases, as the predictors are not perfectly collinear), the solution is:\n$$\n\\hat{\\mathbf{A}} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{y}\n$$\nNumerically, it is more stable and efficient to solve this system using methods like QR decomposition, which is what library functions such as `numpy.linalg.lstsq` implement.\n\nThe algorithm for each test case will be as follows:\n1.  Define the given data: the process-zone length $\\ell_p$, the vector of system sizes $\\mathbf{L}$, and the vector of measured critical stress intensity factors $\\mathbf{K_c}$.\n2.  Calculate the vector of the dimensionless ratio $\\mathbf{x} = \\ell_p / \\mathbf{L}$.\n3.  Construct the design matrix $\\mathbf{X}$. The first column is a vector of ones (for the intercept $A_0$), the second column is the vector $\\mathbf{x}$, and the third column is the vector $\\mathbf{x}^2$. The dimensions of $\\mathbf{X}$ will be $n \\times 3$, where $n$ is the number of data points.\n4.  The target vector $\\mathbf{y}$ is the vector of $\\mathbf{K_c}$ values.\n5.  Use a numerical least-squares solver, specifically `numpy.linalg.lstsq`, to find the coefficient vector $\\hat{\\mathbf{A}}$ that best fits the equation $\\mathbf{X}\\mathbf{A} \\approx \\mathbf{y}$.\n6.  The desired result, $K_c^\\infty$, is the first element of the returned coefficient vector, $\\hat{A}_0$.\n7.  Round the result to six decimal places as required.\n8.  Repeat for all four test cases and format the final output.\n\nThis procedure directly implements the requested fitting strategy, leveraging established numerical linear algebra techniques to ensure an accurate and stable solution.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs finite-size scaling analysis on atomistic crack tip data\n    to extrapolate the infinite-system critical stress intensity factor.\n    \"\"\"\n    \n    test_cases = [\n        # Test case 1\n        {\n            \"lp\": 3e-9,\n            \"L_vals\": np.array([30e-9, 60e-9, 120e-9, 240e-9]),\n            \"Kc_vals\": np.array([1.572, 1.53675, 1.5185625, 1.509328125])\n        },\n        # Test case 2\n        {\n            \"lp\": 2e-9,\n            \"L_vals\": np.array([40e-9, 80e-9, 160e-9, 320e-9]),\n            \"Kc_vals\": np.array([2.004, 2.001, 2.00025, 2.0000625])\n        },\n        # Test case 3\n        {\n            \"lp\": 5e-9,\n            \"L_vals\": np.array([10e-9, 20e-9, 40e-9]),\n            \"Kc_vals\": np.array([1.44, 1.17, 1.035])\n        },\n        # Test case 4\n        {\n            \"lp\": 4e-9,\n            \"L_vals\": np.array([50e-9, 100e-9, 200e-9, 400e-9, 800e-9]),\n            \"Kc_vals\": np.array([1.895248, 1.827912, 1.841528, 1.805782, 1.8053955])\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        lp = case[\"lp\"]\n        L = case[\"L_vals\"]\n        Kc = case[\"Kc_vals\"]\n\n        # Calculate the independent variable x = lp / L\n        # This is the dimensionless ratio used in the expansion.\n        x = lp / L\n        \n        # The model is Kc(L) = A0 + A1*x + A2*x^2\n        # We need to solve a linear least-squares problem y = X * A\n        # where y = Kc, A = [A0, A1, A2]^T, and X is the design matrix.\n        \n        # Construct the design matrix X.\n        # The columns are [1, x, x^2] corresponding to coefficients [A0, A1, A2].\n        # np.vander with increasing=True creates such a matrix directly.\n        # The first argument is the vector x, the second is the polynomial degree + 1.\n        X = np.vander(x, 3, increasing=True)\n        \n        # The dependent variable vector y is simply the Kc values.\n        y = Kc\n        \n        # Solve the least-squares problem X * A = y for A.\n        # np.linalg.lstsq is a robust solver for this.\n        # rcond=None is specified to use the machine-precision-dependent default\n        # and suppress future warnings.\n        coeffs, _, _, _ = np.linalg.lstsq(X, y, rcond=None)\n        \n        # The extrapolated infinite-system value Kc_inf is the intercept A0,\n        # which is the first element of the returned coefficient vector.\n        Kc_inf = coeffs[0]\n        \n        # Round the result to six decimal places as required.\n        results.append(f\"{Kc_inf:.6f}\")\n\n    # Print the final results in the specified format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}