{
    "hands_on_practices": [
        {
            "introduction": "The first step in mastering Ginzburg-Landau theory is to understand how it describes the emergence of an ordered phase from a disordered one. This foundational exercise focuses on the simplest case: a uniform system with no spatial variations. By applying the variational principle to a basic GL functional, you will derive the equilibrium value of the order parameter below the critical temperature and calculate the associated condensation energy, which is the energetic advantage of the ordered state .",
            "id": "3812636",
            "problem": "In a coarse-grained multiscale description of a continuous phase transition in a material, the Ginzburg–Landau (GL) free energy density functional for a complex scalar order parameter $\\psi(\\mathbf{r})$ in zero magnetic field can be written, to leading nontrivial order in $|\\psi|$, as\n$$\nf[\\psi] \\;=\\; f_{n} \\;+\\; \\alpha(T)\\,|\\psi|^{2} \\;+\\; \\frac{\\beta}{2}\\,|\\psi|^{4} \\;+\\; \\frac{K}{2}\\,|\\nabla \\psi|^{2},\n$$\nwhere $f_{n}$ is the normal-state free energy density, $\\alpha(T)$ is a real coefficient that changes sign at the critical temperature, $\\beta0$ ensures stability, and $K0$ penalizes spatial variations. Consider the uniform, zero-field case so that $\\nabla \\psi=\\mathbf{0}$. Assume temperatures below the critical temperature such that $\\alpha(T)\\equiv \\alpha0$. Starting only from the variational principle that equilibrium minimizes the free energy with respect to $\\psi$ and its complex conjugate, determine the uniform equilibrium magnitude of the order parameter and evaluate the corresponding free-energy density difference $\\Delta f \\equiv f_{\\mathrm{eq}} - f_{n}$.\n\nExpress your final answer as a single closed-form analytic expression for $\\Delta f$ in terms of $\\alpha$ and $\\beta$. Do not insert any numerical values. No rounding is required and no units should be reported in the final answer.",
            "solution": "The problem is valid as it is scientifically grounded in the established Ginzburg-Landau theory of phase transitions, is well-posed with sufficient and consistent conditions, and is expressed in objective, formal language. We may proceed with the solution.\n\nThe Ginzburg-Landau (GL) free energy density functional is given as:\n$$\nf[\\psi] \\;=\\; f_{n} \\;+\\; \\alpha(T)\\,|\\psi|^{2} \\;+\\; \\frac{\\beta}{2}\\,|\\psi|^{4} \\;+\\; \\frac{K}{2}\\,|\\nabla \\psi|^{2}\n$$\nThe problem specifies the uniform case, where the order parameter $\\psi$ is spatially constant. This implies that its gradient is zero: $\\nabla \\psi = \\mathbf{0}$. The problem also considers temperatures below the critical temperature, such that the coefficient $\\alpha(T)$ is a negative constant, denoted as $\\alpha  0$. Under these conditions, the gradient term vanishes, and the free energy density becomes a function of the magnitude of the order parameter, $|\\psi|$:\n$$\nf(\\psi) \\;=\\; f_{n} \\;+\\; \\alpha\\,|\\psi|^{2} \\;+\\; \\frac{\\beta}{2}\\,|\\psi|^{4}\n$$\nThe order parameter $\\psi$ is a complex scalar, which can be expressed in polar form as $\\psi = \\rho\\,e^{i\\theta}$, where $\\rho = |\\psi| \\ge 0$ is the magnitude and $\\theta$ is the phase. The free energy density expression depends only on the magnitude $\\rho$:\n$$\nf(\\rho) \\;=\\; f_{n} \\;+\\; \\alpha\\,\\rho^{2} \\;+\\; \\frac{\\beta}{2}\\,\\rho^{4}\n$$\nAccording to the variational principle, the system at equilibrium will adopt a state that minimizes this free energy density. To find the minimum, we must find the extrema of $f(\\rho)$ with respect to $\\rho$ and then identify which extremum corresponds to a stable equilibrium (a minimum). We differentiate $f(\\rho)$ with respect to $\\rho$ and set the result to zero:\n$$\n\\frac{df}{d\\rho} \\;=\\; \\frac{d}{d\\rho} \\left( f_{n} \\;+\\; \\alpha\\,\\rho^{2} \\;+\\; \\frac{\\beta}{2}\\,\\rho^{4} \\right) \\;=\\; 2\\alpha\\rho \\;+\\; 2\\beta\\rho^{3}\n$$\nSetting the derivative to zero yields the condition for the extrema:\n$$\n2\\alpha\\rho \\;+\\; 2\\beta\\rho^{3} \\;=\\; 0\n$$\n$$\n2\\rho(\\alpha \\;+\\; \\beta\\rho^{2}) \\;=\\; 0\n$$\nThis equation provides two possible solutions for the equilibrium magnitude $\\rho_{\\mathrm{eq}}$:\n$1$. $\\rho_{\\mathrm{eq}} = 0$. This corresponds to the normal, disordered state where $|\\psi|=0$.\n$2$. $\\alpha + \\beta\\rho_{\\mathrm{eq}}^{2} = 0$, which implies $\\rho_{\\mathrm{eq}}^{2} = -\\frac{\\alpha}{\\beta}$.\n\nSince $\\rho_{\\mathrm{eq}}$ represents a physical magnitude, it must be a real, non-negative number. The problem states that $\\alpha  0$ and $\\beta  0$. Therefore, the ratio $-\\frac{\\alpha}{\\beta}$ is positive, and a real, non-trivial solution for the magnitude exists:\n$$\n\\rho_{\\mathrm{eq}} = \\sqrt{-\\frac{\\alpha}{\\beta}}\n$$\nTo determine which of these two solutions, $\\rho=0$ or $\\rho=\\sqrt{-\\frac{\\alpha}{\\beta}}$, corresponds to a stable equilibrium, we examine the second derivative of the free energy density, $\\frac{d^{2}f}{d\\rho^{2}}$:\n$$\n\\frac{d^{2}f}{d\\rho^{2}} \\;=\\; \\frac{d}{d\\rho} \\left( 2\\alpha\\rho \\;+\\; 2\\beta\\rho^{3} \\right) \\;=\\; 2\\alpha \\;+\\; 6\\beta\\rho^{2}\n$$\nFor the trivial solution $\\rho=0$:\n$$\n\\left. \\frac{d^{2}f}{d\\rho^{2}} \\right|_{\\rho=0} \\;=\\; 2\\alpha\n$$\nSince $\\alpha  0$, the second derivative is negative. This indicates that $\\rho=0$ is a local maximum, representing an unstable equilibrium state.\n\nFor the non-trivial solution $\\rho^{2} = -\\frac{\\alpha}{\\beta}$:\n$$\n\\left. \\frac{d^{2}f}{d\\rho^{2}} \\right|_{\\rho^{2}=-\\alpha/\\beta} \\;=\\; 2\\alpha \\;+\\; 6\\beta\\left(-\\frac{\\alpha}{\\beta}\\right) \\;=\\; 2\\alpha - 6\\alpha \\;=\\; -4\\alpha\n$$\nSince $\\alpha  0$, the second derivative $-4\\alpha$ is positive. This indicates that $\\rho = \\sqrt{-\\frac{\\alpha}{\\beta}}$ corresponds to a local minimum, representing the stable equilibrium state. The equilibrium magnitude of the order parameter is thus $|\\psi|_{\\mathrm{eq}} = \\sqrt{-\\frac{\\alpha}{\\beta}}$.\n\nThe final step is to calculate the free energy density difference $\\Delta f = f_{\\mathrm{eq}} - f_{n}$. We substitute the equilibrium magnitude squared, $|\\psi|_{\\mathrm{eq}}^{2} = -\\frac{\\alpha}{\\beta}$, into the free energy expression to find $f_{\\mathrm{eq}}$:\n$$\nf_{\\mathrm{eq}} \\;=\\; f_{n} \\;+\\; \\alpha\\,|\\psi|_{\\mathrm{eq}}^{2} \\;+\\; \\frac{\\beta}{2}\\,(|\\psi|_{\\mathrm{eq}}^{2})^{2}\n$$\n$$\nf_{\\mathrm{eq}} \\;=\\; f_{n} \\;+\\; \\alpha\\left(-\\frac{\\alpha}{\\beta}\\right) \\;+\\; \\frac{\\beta}{2}\\left(-\\frac{\\alpha}{\\beta}\\right)^{2}\n$$\n$$\nf_{\\mathrm{eq}} \\;=\\; f_{n} \\;-\\; \\frac{\\alpha^{2}}{\\beta} \\;+\\; \\frac{\\beta}{2}\\left(\\frac{\\alpha^{2}}{\\beta^{2}}\\right)\n$$\n$$\nf_{\\mathrm{eq}} \\;=\\; f_{n} \\;-\\; \\frac{\\alpha^{2}}{\\beta} \\;+\\; \\frac{\\alpha^{2}}{2\\beta}\n$$\n$$\nf_{\\mathrm{eq}} \\;=\\; f_{n} \\;-\\; \\frac{\\alpha^{2}}{2\\beta}\n$$\nThe required free-energy density difference is then:\n$$\n\\Delta f \\;=\\; f_{\\mathrm{eq}} - f_{n} \\;=\\; \\left(f_{n} \\;-\\; \\frac{\\alpha^{2}}{2\\beta}\\right) - f_{n} \\;=\\; -\\frac{\\alpha^{2}}{2\\beta}\n$$\nThis result, known as the condensation energy density, is negative, confirming that the ordered state is energetically more favorable than the normal state when $\\alpha  0$.",
            "answer": "$$\\boxed{-\\frac{\\alpha^{2}}{2\\beta}}$$"
        },
        {
            "introduction": "Real materials are rarely uniform; they contain interfaces, domain walls, and other defects where the order parameter changes in space. This practice introduces the crucial gradient energy term, which penalizes such variations, into the Ginzburg-Landau functional. You will solve the resulting Euler-Lagrange equation to find the classic hyperbolic tangent profile of a one-dimensional domain wall and calculate its interfacial energy, revealing how a balance of competing energy terms determines the structure of defects .",
            "id": "3812610",
            "problem": "In the context of phase-field modeling for multiscale materials simulation, consider a one-dimensional planar interface between two degenerate phases of an order parameter field $\\phi(x)$ described by the Ginzburg-Landau (GL) free energy functional\n$$\nF[\\phi] \\;=\\; \\int_{-\\infty}^{\\infty} \\left[ \\frac{\\kappa}{2} \\left( \\frac{d\\phi}{dx} \\right)^{2} \\;+\\; \\frac{r}{2} \\,\\phi^{2} \\;+\\; \\frac{u}{4} \\,\\phi^{4} \\right] \\, dx,\n$$\nwhere $\\kappa0$ is the gradient energy coefficient, $u0$ is the quartic coefficient, and $r0$ is the quadratic coefficient. The physically realized bulk phases correspond to the uniform minima at $\\phi=\\pm \\phi_{0}$, with $\\phi_{0}^{2} = -\\,r/u$. The interfacial energy per unit area (surface tension) is defined as the excess free energy relative to the bulk minimum:\n$$\n\\sigma \\;=\\; \\int_{-\\infty}^{\\infty} \\left\\{ \\frac{\\kappa}{2} \\left( \\frac{d\\phi}{dx} \\right)^{2} \\;+\\; \\left[ \\frac{r}{2}\\phi^{2} + \\frac{u}{4}\\phi^{4} \\;-\\; \\left( \\frac{r}{2}\\phi_{0}^{2} + \\frac{u}{4}\\phi_{0}^{4} \\right) \\right] \\right\\} dx.\n$$\nStarting from the variational principle that stationary profiles minimize $F[\\phi]$ subject to the boundary conditions $\\phi(x\\to -\\infty)=-\\phi_{0}$ and $\\phi(x\\to +\\infty)=+\\phi_{0}$, and without assuming any specific functional form a priori, do the following:\n\n- Derive the Euler–Lagrange equation for $\\phi(x)$ and obtain the unique monotonic domain wall solution connecting the two bulk phases.\n- Introduce the interfacial width $\\xi$ as the emergent length scale that regularizes the domain wall and express it in terms of $r$, $u$, and $\\kappa$.\n- Compute the interfacial energy per unit area $\\sigma$ by integrating the excess free energy density, and express your final result in closed form.\n\nProvide your final answer as two expressions in a single row matrix using the variables $x$, $\\phi_{0}$, $\\xi$, $r$, $u$, and $\\kappa$, where $\\phi_{0}^{2}=-\\,r/u$ and $\\xi^{2}=\\kappa/(-r)$. No numerical evaluation is required, and no rounding is needed. The final answer must be a closed-form analytic expression.",
            "solution": "The problem asks for the derivation of the one-dimensional domain wall solution $\\phi(x)$ for a Ginzburg-Landau (GL) free energy functional and the corresponding interfacial energy $\\sigma$. The problem statement is scientifically grounded in established principles of phase-field theory, is well-posed with a complete and consistent set of definitions and boundary conditions, and is expressed in objective, formal language. It is therefore a valid problem.\n\nThe GL free energy functional is given by\n$$\nF[\\phi] = \\int_{-\\infty}^{\\infty} L\\left(\\phi, \\frac{d\\phi}{dx}\\right) dx\n$$\nwhere the Lagrangian density $L$ is\n$$\nL\\left(\\phi, \\frac{d\\phi}{dx}\\right) = \\frac{\\kappa}{2} \\left( \\frac{d\\phi}{dx} \\right)^{2} + \\frac{r}{2} \\,\\phi^{2} + \\frac{u}{4} \\,\\phi^{4}\n$$\nThe stationary profile $\\phi(x)$ that minimizes $F[\\phi]$ must satisfy the Euler-Lagrange equation:\n$$\n\\frac{\\partial L}{\\partial \\phi} - \\frac{d}{dx} \\left( \\frac{\\partial L}{\\partial (d\\phi/dx)} \\right) = 0\n$$\nFirst, we compute the partial derivatives of $L$:\n$$\n\\frac{\\partial L}{\\partial \\phi} = r\\phi + u\\phi^3\n$$\n$$\n\\frac{\\partial L}{\\partial (d\\phi/dx)} = \\kappa \\frac{d\\phi}{dx}\n$$\nSubstituting these into the Euler-Lagrange equation gives the governing differential equation for $\\phi(x)$:\n$$\n(r\\phi + u\\phi^3) - \\frac{d}{dx} \\left( \\kappa \\frac{d\\phi}{dx} \\right) = 0\n$$\n$$\n\\kappa \\frac{d^2\\phi}{dx^2} - r\\phi - u\\phi^3 = 0\n$$\nThis is a second-order nonlinear ordinary differential equation. Since it is autonomous (does not explicitly depend on $x$), we can find a first integral of motion. Multiplying by $d\\phi/dx$:\n$$\n\\kappa \\frac{d\\phi}{dx} \\frac{d^2\\phi}{dx^2} - (r\\phi + u\\phi^3) \\frac{d\\phi}{dx} = 0\n$$\nRecognizing that $\\frac{d\\phi}{dx} \\frac{d^2\\phi}{dx^2} = \\frac{d}{dx}\\left[\\frac{1}{2}\\left(\\frac{d\\phi}{dx}\\right)^2\\right]$ and $(r\\phi + u\\phi^3) \\frac{d\\phi}{dx} = \\frac{d}{dx}\\left[\\frac{r}{2}\\phi^2 + \\frac{u}{4}\\phi^4\\right]$, we can rewrite the equation as:\n$$\n\\frac{d}{dx} \\left[ \\frac{\\kappa}{2} \\left( \\frac{d\\phi}{dx} \\right)^2 - \\left( \\frac{r}{2}\\phi^2 + \\frac{u}{4}\\phi^4 \\right) \\right] = 0\n$$\nThis implies that the quantity in the brackets is a constant. We can determine this constant using the boundary conditions. As $x \\to \\pm \\infty$, the system is in a bulk phase, so the profile becomes uniform, meaning $\\frac{d\\phi}{dx} \\to 0$ and $\\phi \\to \\pm \\phi_0$. Evaluating the expression at one of these boundaries (e.g., $x \\to +\\infty$, where $\\phi = \\phi_0$):\n$$\n\\frac{\\kappa}{2} (0)^2 - \\left( \\frac{r}{2}\\phi_0^2 + \\frac{u}{4}\\phi_0^4 \\right) = \\text{constant}\n$$\nThus, the first integral of motion is:\n$$\n\\frac{\\kappa}{2} \\left( \\frac{d\\phi}{dx} \\right)^2 - \\left( \\frac{r}{2}\\phi^2 + \\frac{u}{4}\\phi^4 \\right) = - \\left( \\frac{r}{2}\\phi_0^2 + \\frac{u}{4}\\phi_0^4 \\right)\n$$\nRearranging and using the definition $\\phi_0^2 = -r/u$ (which implies $r=-u\\phi_0^2$):\n$$\n\\frac{\\kappa}{2} \\left( \\frac{d\\phi}{dx} \\right)^2 = \\frac{r}{2}(\\phi^2 - \\phi_0^2) + \\frac{u}{4}(\\phi^4 - \\phi_0^4) = \\frac{-u\\phi_0^2}{2}(\\phi^2 - \\phi_0^2) + \\frac{u}{4}(\\phi^2 - \\phi_0^2)(\\phi^2 + \\phi_0^2)\n$$\n$$\n\\frac{\\kappa}{2} \\left( \\frac{d\\phi}{dx} \\right)^2 = \\frac{u}{4}(\\phi^2 - \\phi_0^2) \\left[ -2\\phi_0^2 + (\\phi^2 + \\phi_0^2) \\right] = \\frac{u}{4}(\\phi^2 - \\phi_0^2)(\\phi^2 - \\phi_0^2) = \\frac{u}{4}(\\phi_0^2 - \\phi^2)^2\n$$\nTaking the square root, we get a first-order separable ODE. For a monotonic solution where $\\phi$ increases from $-\\phi_0$ to $+\\phi_0$, we require $\\frac{d\\phi}{dx}  0$.\n$$\n\\frac{d\\phi}{dx} = \\sqrt{\\frac{u}{2\\kappa}} (\\phi_0^2 - \\phi^2)\n$$\nWe separate variables and integrate:\n$$\n\\int \\frac{d\\phi}{\\phi_0^2 - \\phi^2} = \\int \\sqrt{\\frac{u}{2\\kappa}} dx\n$$\nThe integral on the left is a standard form: $\\int \\frac{dy}{a^2 - y^2} = \\frac{1}{a} \\arctanh\\left(\\frac{y}{a}\\right)$.\n$$\n\\frac{1}{\\phi_0} \\arctanh\\left(\\frac{\\phi}{\\phi_0}\\right) = \\sqrt{\\frac{u}{2\\kappa}} x + C\n$$\nWe set the center of the domain wall at $x=0$, where $\\phi=0$. This gives $\\arctanh(0) = 0$, so the integration constant $C=0$.\n$$\n\\phi(x) = \\phi_0 \\tanh\\left(\\phi_0 \\sqrt{\\frac{u}{2\\kappa}} x\\right)\n$$\nNow we introduce the interfacial width $\\xi$, defined by $\\xi^2 = \\kappa/(-r)$. We can rewrite the coefficient in the argument of the hyperbolic tangent using this definition and $\\phi_0^2 = -r/u$:\n$$\n\\phi_0 \\sqrt{\\frac{u}{2\\kappa}} = \\phi_0 \\sqrt{\\frac{-r/\\phi_0^2}{2\\kappa}} = \\phi_0 \\frac{1}{\\phi_0} \\sqrt{\\frac{-r}{2\\kappa}} = \\sqrt{\\frac{1}{2(\\kappa/(-r))}} = \\sqrt{\\frac{1}{2\\xi^2}} = \\frac{1}{\\sqrt{2}\\xi}\n$$\nSubstituting this back, the monotonic domain wall solution is:\n$$\n\\phi(x) = \\phi_0 \\tanh\\left(\\frac{x}{\\sqrt{2}\\xi}\\right)\n$$\nNext, we compute the interfacial energy per unit area, $\\sigma$. The definition provided is the integral of the excess free energy density:\n$$\n\\sigma = \\int_{-\\infty}^{\\infty} \\left\\{ \\frac{\\kappa}{2} \\left( \\frac{d\\phi}{dx} \\right)^{2} + \\left[ \\frac{r}{2}\\phi^{2} + \\frac{u}{4}\\phi^{4} - \\left( \\frac{r}{2}\\phi_{0}^{2} + \\frac{u}{4}\\phi_{0}^{4} \\right) \\right] \\right\\} dx\n$$\nFrom the first integral of motion, we established that for the domain wall solution:\n$$\n\\frac{\\kappa}{2} \\left( \\frac{d\\phi}{dx} \\right)^{2} = \\left[ \\frac{r}{2}\\phi^{2} + \\frac{u}{4}\\phi^{4} \\right] - \\left[ \\frac{r}{2}\\phi_{0}^{2} + \\frac{u}{4}\\phi_{0}^{4} \\right]\n$$\nThis means the gradient energy density term is equal to the excess potential energy density term. Substituting this into the expression for $\\sigma$:\n$$\n\\sigma = \\int_{-\\infty}^{\\infty} 2 \\left[ \\frac{\\kappa}{2} \\left( \\frac{d\\phi}{dx} \\right)^{2} \\right] dx = \\int_{-\\infty}^{\\infty} \\kappa \\left( \\frac{d\\phi}{dx} \\right)^{2} dx\n$$\nWe differentiate our solution for $\\phi(x)$:\n$$\n\\frac{d\\phi}{dx} = \\phi_0 \\, \\text{sech}^2\\left(\\frac{x}{\\sqrt{2}\\xi}\\right) \\cdot \\frac{1}{\\sqrt{2}\\xi}\n$$\nPlugging this into the integral for $\\sigma$:\n$$\n\\sigma = \\int_{-\\infty}^{\\infty} \\kappa \\left[ \\frac{\\phi_0}{\\sqrt{2}\\xi} \\text{sech}^2\\left(\\frac{x}{\\sqrt{2}\\xi}\\right) \\right]^2 dx = \\int_{-\\infty}^{\\infty} \\frac{\\kappa \\phi_0^2}{2\\xi^2} \\text{sech}^4\\left(\\frac{x}{\\sqrt{2}\\xi}\\right) dx\n$$\nLet's make the substitution $z = \\frac{x}{\\sqrt{2}\\xi}$, so $dx = \\sqrt{2}\\xi \\, dz$.\n$$\n\\sigma = \\frac{\\kappa \\phi_0^2}{2\\xi^2} \\int_{-\\infty}^{\\infty} \\text{sech}^4(z) (\\sqrt{2}\\xi \\, dz) = \\frac{\\sqrt{2}\\kappa\\phi_0^2}{2\\xi} \\int_{-\\infty}^{\\infty} \\text{sech}^4(z) dz\n$$\nThe definite integral of $\\text{sech}^4(z)$ is a standard result:\n$$\n\\int_{-\\infty}^{\\infty} \\text{sech}^4(z) dz = \\left[ \\tanh(z) - \\frac{1}{3}\\tanh^3(z) \\right]_{-\\infty}^{\\infty} = \\left(1 - \\frac{1}{3}\\right) - \\left(-1 - \\frac{(-1)^3}{3}\\right) = \\frac{2}{3} - \\left(-1 + \\frac{1}{3}\\right) = \\frac{2}{3} + \\frac{2}{3} = \\frac{4}{3}\n$$\nSubstituting this value back into the expression for $\\sigma$:\n$$\n\\sigma = \\frac{\\sqrt{2}\\kappa\\phi_0^2}{2\\xi} \\left( \\frac{4}{3} \\right) = \\frac{4\\sqrt{2}\\kappa\\phi_0^2}{6\\xi} = \\frac{2\\sqrt{2}\\kappa\\phi_0^2}{3\\xi}\n$$\nThe two required expressions are the domain wall profile $\\phi(x)$ and the interfacial energy $\\sigma$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\phi_0 \\tanh\\left(\\frac{x}{\\sqrt{2}\\xi}\\right)  \\frac{2\\sqrt{2}\\kappa\\phi_0^2}{3\\xi} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While analytical solutions provide deep insight, many real-world phenomena described by Ginzburg-Landau theory are too complex to solve with pen and paper and require computational methods. This practice guides you through the numerical simulation of a quintessential application: the behavior of a superconductor in an external magnetic field. By implementing a gradient descent algorithm to minimize the GL functional, you will observe the formation of quantum vortices, learning how to discretize gauge-covariant derivatives and extract topological information from a simulated field .",
            "id": "3766232",
            "problem": "Consider the extreme type-II limit of the Ginzburg-Landau (GL) theory for a two-dimensional superconducting strip, where magnetic field variations due to supercurrents are neglected. In this limit, the vector potential is externally imposed and the GL free energy functional reduces to the following nondimensionalized form on a rectangular domain $\\Omega = [0,L_x] \\times [0,W]$:\n$$\n\\mathcal{F}[\\psi] \\;=\\; \\int_{\\Omega} \\left( \\left| (\\nabla - i \\mathbf{A}) \\psi \\right|^2 \\;+\\; \\frac{1}{2} \\left( 1 - |\\psi|^2 \\right)^2 \\right) \\, d^2\\mathbf{r},\n$$\nwhere $\\psi(\\mathbf{r})$ is the complex order parameter, $\\mathbf{A}$ is the vector potential corresponding to a uniform perpendicular magnetic field of nondimensional strength $B$, and all quantities are dimensionless. Use the Landau gauge $\\mathbf{A} = (-B y, 0)$ so that $A_x = -B y$ and $A_y = 0$. Impose periodic boundary conditions along the $x$-direction and the de Gennes (superconductor–insulator) boundary condition along the $y$-direction:\n$$\n\\mathbf{n} \\cdot (\\nabla - i \\mathbf{A}) \\psi \\;=\\; 0 \\quad \\text{on} \\quad y=0 \\quad \\text{and} \\quad y=W,\n$$\nwhere $\\mathbf{n}$ is the outward unit normal. Angles must be treated in radians.\n\nYou must minimize $\\mathcal{F}[\\psi]$ numerically on a uniform discrete grid by gradient flow (steepest descent) starting from a slightly perturbed uniform initial state. Discretize the covariant derivatives with gauge-invariant link variables. On a uniform grid with $N_x$ points in $x$ and $N_y$ points in $y$, spacings $\\Delta x$ and $\\Delta y$ (use $\\Delta x = \\Delta y$), define the forward covariant difference operators:\n$$\nD_x \\psi_{i,j} \\;=\\; U_{x,j} \\, \\psi_{i+1,j} - \\psi_{i,j}, \\quad U_{x,j} \\;=\\; e^{-i A_x(j) \\Delta x} \\;=\\; e^{i B \\, y_j \\, \\Delta x},\n$$\n$$\nD_y \\psi_{i,j} \\;=\\; \\psi_{i,j+1} - \\psi_{i,j},\n$$\nwith periodic indexing in $i$ and $y_0 = 0$, $y_j = j \\, \\Delta y$. The adjoint operators on the grid yield the gauge-covariant discrete Laplacian components:\n$$\nD_x^\\dagger D_x \\psi_{i,j} \\;=\\; U_{x,j} \\, \\psi_{i+1,j} + U_{x,j}^\\ast \\, \\psi_{i-1,j} - 2 \\psi_{i,j},\n$$\n$$\nD_y^\\dagger D_y \\psi_{i,j} \\;=\\; \\psi_{i,j+1} + \\psi_{i,j-1} - 2 \\psi_{i,j},\n$$\nwhere the de Gennes boundary condition is enforced by reflection in $y$ so that $\\psi_{i,-1} = \\psi_{i,0}$ and $\\psi_{i,N_y} = \\psi_{i,N_y-1}$. The steepest descent evolution (a nondimensionalized form of the time-dependent GL gradient flow) is\n$$\n\\frac{\\partial \\psi}{\\partial t} \\;=\\; - \\frac{\\delta \\mathcal{F}}{\\delta \\psi^\\ast} \\;=\\; - \\left( D_x^\\dagger D_x \\psi + D_y^\\dagger D_y \\psi - \\left(1 - |\\psi|^2\\right)\\psi \\right),\n$$\nwhich you must discretize explicitly with a time step $\\Delta t$:\n$$\n\\psi^{(n+1)} \\;=\\; \\psi^{(n)} \\;-\\; \\Delta t \\left( D_x^\\dagger D_x \\psi^{(n)} + D_y^\\dagger D_y \\psi^{(n)} - \\left(1 - \\left|\\psi^{(n)}\\right|^2\\right)\\psi^{(n)} \\right).\n$$\n\nTo quantify vortex entry and boundary-induced patterning, compute the total gauge-invariant vorticity after convergence, using gauge-invariant phase differences on links:\n$$\n\\delta\\theta_x(i,j) \\;=\\; \\mathrm{wrap}\\left( \\arg(\\psi_{i+1,j}) - \\arg(\\psi_{i,j}) - \\arg(U_{x,j}) \\right), \\quad \\delta\\theta_y(i,j) \\;=\\; \\mathrm{wrap}\\left( \\arg(\\psi_{i,j+1}) - \\arg(\\psi_{i,j}) \\right),\n$$\nwhere $\\mathrm{wrap}(\\cdot)$ maps angles to $(-\\pi,\\pi]$. The plaquette vorticity (gauge-invariant circulation) is\n$$\n\\omega(i,j) \\;=\\; \\mathrm{wrap}\\left( \\delta\\theta_x(i,j) + \\delta\\theta_y(i+1,j) - \\delta\\theta_x(i,j+1) - \\delta\\theta_y(i,j) \\right),\n$$\nfor $i \\in \\{0,\\dots,N_x-1\\}$ with periodic wrap in $i$ and $j \\in \\{0,\\dots,N_y-2\\}$. The net integer vortex count is then\n$$\nN_v \\;=\\; \\mathrm{round}\\left( \\frac{1}{2\\pi} \\sum_{i=0}^{N_x-1} \\sum_{j=0}^{N_y-2} \\omega(i,j) \\right).\n$$\n\nYour program must implement the above discretization with the following fixed grid and numerical parameters, in dimensionless units:\n- Use $N_x = 24$, $N_y = 12$, $\\Delta x = \\Delta y = 1$.\n- Use an explicit gradient descent with $\\Delta t = 0.05$ and a total of $N_{\\mathrm{iter}} = 400$ iterations per test.\n- Initialize $\\psi$ as $\\psi_{i,j}^{(0)} = 1 + \\epsilon \\, \\eta_{i,j}$ with $\\epsilon = 10^{-2}$ and $\\eta_{i,j}$ a complex Gaussian perturbation with zero mean and unit variance, using a fixed random seed for reproducibility.\n\nTest suite:\n- Case $1$: $B = 0.0000$ (very low field; expected vortex-free).\n- Case $2$: $B = \\frac{2\\pi}{N_x (N_y - 1)} \\approx 0.0238$ (approximately one flux quantum across the strip interior).\n- Case $3$: $B = \\frac{4\\pi}{N_x (N_y - 1)} \\approx 0.0476$ (approximately two flux quanta).\n- Case $4$: $B = \\frac{6\\pi}{N_x (N_y - 1)} \\approx 0.0714$ (approximately three flux quanta).\n- Case $5$ (edge coverage, non-integer flux): $B = \\frac{3\\pi}{N_x (N_y - 1)} \\approx 0.0357$.\n\nFor each case, after minimizing $\\mathcal{F}[\\psi]$, compute $N_v$ as defined above. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[n_1,n_2,n_3,n_4,n_5]$, where each $n_k$ is the integer vortex count for the corresponding test case. All quantities are dimensionless; no physical unit conversion is required, and all angles are in radians.",
            "solution": "The problem requires the numerical minimization of a Ginzburg-Landau (GL) free energy functional for a two-dimensional superconducting strip. This is achieved by simulating the gradient flow of the order parameter, $\\psi$, using an explicit time-stepping method on a discrete grid. The primary goal is to compute the number of emergent vortices, $N_v$, for different strengths of an external magnetic field, $B$. The problem is well-posed, scientifically sound, and provides a complete set of instructions for the numerical implementation.\n\nThe Ginzburg-Landau free energy functional on the domain $\\Omega = [0,L_x] \\times [0,W]$ is given by:\n$$\n\\mathcal{F}[\\psi] \\;=\\; \\int_{\\Omega} \\left( \\left| (\\nabla - i \\mathbf{A}) \\psi \\right|^2 \\;+\\; \\frac{1}{2} \\left( 1 - |\\psi|^2 \\right)^2 \\right) \\, d^2\\mathbf{r}\n$$\nHere, $\\psi$ is the complex order parameter, and $\\mathbf{A} = (-B y, 0)$ is the vector potential in the Landau gauge for a uniform magnetic field of strength $B$.\n\nThe minimization of $\\mathcal{F}[\\psi]$ is performed using a steepest descent (gradient flow) method. This corresponds to evolving $\\psi$ in fictitious time $t$ according to the time-dependent Ginzburg-Landau equation:\n$$\n\\frac{\\partial \\psi}{\\partial t} \\;=\\; - \\frac{\\delta \\mathcal{F}}{\\delta \\psi^\\ast}\n$$\nThe variational derivative $\\frac{\\delta \\mathcal{F}}{\\delta \\psi^\\ast}$ is given in the problem statement, leading to the evolution equation:\n$$\n\\frac{\\partial \\psi}{\\partial t} \\;=\\; (\\nabla - i \\mathbf{A})^2 \\psi + (1 - |\\psi|^2)\\psi\n$$\nThe term $(\\nabla - i \\mathbf{A})^2 \\psi$ is the gauge-covariant Laplacian. The problem provides a specific, explicit discretization of this equation on a uniform grid, which we will implement.\n\nThe domain is discretized into a grid of size $N_x \\times N_y$ with lattice spacings $\\Delta x = \\Delta y = 1$. The order parameter $\\psi(\\mathbf{r})$ becomes a complex array $\\psi_{i,j}$, where $i \\in \\{0, \\dots, N_x-1\\}$ and $j \\in \\{0, \\dots, N_y-1\\}$.\n\nThe time evolution is discretized using an explicit forward Euler scheme with a time step $\\Delta t$:\n$$\n\\psi^{(n+1)}_{i,j} \\;=\\; \\psi^{(n)}_{i,j} \\;+\\; \\Delta t \\cdot \\left( \\frac{\\partial \\psi}{\\partial t} \\right)_{i,j}^{(n)}\n$$\nThe discrete form of the right-hand side, representing $-\\frac{\\delta \\mathcal{F}}{\\delta \\psi^\\ast}$, is given as:\n$$\n-\\frac{\\delta \\mathcal{F}}{\\delta \\psi^\\ast} \\to (D_x^\\dagger D_x \\psi)_{i,j} + (D_y^\\dagger D_y \\psi)_{i,j} - \\left(1 - |\\psi_{i,j}|^2\\right)\\psi_{i,j}\n$$\nThe discrete gauge-covariant Laplacian components are specified as:\n1.  **x-direction:** To maintain gauge invariance under discretization, a link variable $U_{x,j} = e^{i B y_j \\Delta x}$ is introduced, where $y_j = j \\Delta y$. The Laplacian is:\n    $$\n    (D_x^\\dagger D_x \\psi)_{i,j} \\;=\\; U_{x,j} \\, \\psi_{i+1,j} + U_{x,j}^\\ast \\, \\psi_{i-1,j} - 2 \\psi_{i,j}\n    $$\n    Periodic boundary conditions are applied in the $x$-direction, so indices $i$ are evaluated modulo $N_x$.\n\n2.  **y-direction:** The vector potential has no component in the $y$-direction ($A_y=0$), so the link variables are unity. The Laplacian is:\n    $$\n    (D_y^\\dagger D_y \\psi)_{i,j} \\;=\\; \\psi_{i,j+1} + \\psi_{i,j-1} - 2 \\psi_{i,j}\n    $$\n    The de Gennes (superconductor-insulator) boundary conditions, $\\partial_y \\psi = 0$ at $y=0$ and $y=W$, are implemented by reflecting the grid: $\\psi_{i,-1} = \\psi_{i,0}$ at the bottom boundary ($j=0$) and $\\psi_{i,N_y} = \\psi_{i,N_y-1}$ at the top boundary ($j=N_y-1$). This simplifies the Laplacian at the boundaries:\n    - At $j=0$: $(D_y^\\dagger D_y \\psi)_{i,0} = \\psi_{i,1} + \\psi_{i,-1} - 2\\psi_{i,0} = \\psi_{i,1} + \\psi_{i,0} - 2\\psi_{i,0} = \\psi_{i,1} - \\psi_{i,0}$.\n    - At $j=N_y-1$: $(D_y^\\dagger D_y \\psi)_{i,N_y-1} = \\psi_{i,N_y} + \\psi_{i,N_y-2} - 2\\psi_{i,N_y-1} = \\psi_{i,N_y-1} + \\psi_{i,N_y-2} - 2\\psi_{i,N_y-1} = \\psi_{i,N_y-2} - \\psi_{i,N_y-1}$.\n\nThe simulation starts from an initial state $\\psi_{i,j}^{(0)} = 1 + \\epsilon \\, \\eta_{i,j}$, where $\\epsilon = 10^{-2}$ is a small perturbation amplitude and $\\eta_{i,j}$ is a complex random number from a Gaussian distribution with zero mean and unit variance. A fixed random seed is used for reproducibility. The system is evolved for $N_{\\mathrm{iter}} = 400$ steps with a time step of $\\Delta t=0.05$.\n\nAfter the simulation converges to a minimum energy state, the number of vortices, $N_v$, is calculated. A vortex is a topological defect where the phase of $\\psi$ changes by a multiple of $2\\pi$ around a closed loop. On the lattice, this is computed by summing the gauge-invariant circulation around each elementary plaquette.\n\nThe gauge-invariant phase differences across links are:\n$$\n\\delta\\theta_x(i,j) = \\mathrm{wrap}\\left( \\arg(\\psi_{i+1,j}) - \\arg(\\psi_{i,j}) - \\arg(U_{x,j}) \\right)\n$$\n$$\n\\delta\\theta_y(i,j) = \\mathrm{wrap}\\left( \\arg(\\psi_{i,j+1}) - \\arg(\\psi_{i,j}) \\right)\n$$\nThe function $\\mathrm{wrap}(\\cdot)$ maps an angle to the interval $(-\\pi, \\pi]$.\nThe plaquette vorticity for the cell with its bottom-left corner at $(i,j)$ is the sum of phase differences around it:\n$$\n\\omega(i,j) = \\mathrm{wrap}\\left( \\delta\\theta_x(i,j) + \\delta\\theta_y(i+1,j) - \\delta\\theta_x(i,j+1) - \\delta\\theta_y(i,j) \\right)\n$$\nThis is calculated for each plaquette, indexed by $i \\in \\{0, \\dots, N_x-1\\}$ and $j \\in \\{0, \\dots, N_y-2\\}$. The total vortex count is the sum of all plaquette vorticities, normalized by $2\\pi$ and rounded to the nearest integer:\n$$\nN_v = \\mathrm{round}\\left( \\frac{1}{2\\pi} \\sum_{i=0}^{N_x-1} \\sum_{j=0}^{N_y-2} \\omega(i,j) \\right)\n$$\nThis procedure is repeated for each value of $B$ specified in the test suite. All calculations use the provided dimensionless parameters: $N_x = 24$, $N_y = 12$, $\\Delta x = \\Delta y = 1$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Ginzburg-Landau equation using gradient descent\n    and computes the vortex count for several magnetic field strengths.\n    \"\"\"\n    \n    # Fixed grid and numerical parameters\n    Nx = 24\n    Ny = 12\n    dx = 1.0\n    dy = 1.0\n    dt = 0.05\n    N_iter = 400\n    epsilon = 1e-2\n    \n    # Define test cases for the magnetic field B\n    B_denom = Nx * (Ny - 1)\n    test_cases = [\n        0.0,\n        (2 * np.pi) / B_denom,\n        (4 * np.pi) / B_denom,\n        (6 * np.pi) / B_denom,\n        (3 * np.pi) / B_denom,\n    ]\n\n    results = []\n\n    # Use a fixed random seed for reproducibility\n    np.random.seed(0)\n\n    # Grid coordinates\n    y_coords = np.arange(Ny) * dy\n\n    # Angle wrapping function to map angles to (-pi, pi]\n    def wrap_angle(angles):\n        return (angles + np.pi) % (2 * np.pi) - np.pi\n\n    for B in test_cases:\n        # Initialize the order parameter psi\n        # psi is a complex grid of size (Nx, Ny)\n        noise_real = np.random.randn(Nx, Ny)\n        noise_imag = np.random.randn(Nx, Ny)\n        psi = 1.0 + epsilon * (noise_real + 1j * noise_imag)\n\n        # Pre-compute link variables U_x, which depend only on y\n        # U_x is broadcastable to the shape of psi\n        arg_U_x = (B * y_coords * dx).reshape(1, Ny)\n        U_x = np.exp(1j * arg_U_x)\n        U_x_conj = U_x.conj()\n\n        # Perform gradient descent (explicit Euler time evolution)\n        for _ in range(N_iter):\n            # Calculate the gauge-covariant Laplacian in the x-direction\n            # Periodic boundary conditions are handled by np.roll\n            psi_xp1 = np.roll(psi, -1, axis=0)\n            psi_xm1 = np.roll(psi, 1, axis=0)\n            lap_x = U_x * psi_xp1 + U_x_conj * psi_xm1 - 2.0 * psi\n\n            # Calculate the Laplacian in the y-direction\n            # Enforce de Gennes (Neumann) boundary conditions\n            lap_y = np.zeros_like(psi)\n            psi_yp1 = np.roll(psi, -1, axis=1)\n            psi_ym1 = np.roll(psi, 1, axis=1)\n            \n            # Interior points\n            lap_y[:, 1:-1] = psi_yp1[:, 1:-1] + psi_ym1[:, 1:-1] - 2.0 * psi[:, 1:-1]\n            # Boundary at y=0 (j=0)\n            lap_y[:, 0] = psi[:, 1] - psi[:, 0]\n            # Boundary at y=W (j=Ny-1)\n            lap_y[:, -1] = psi[:, -2] - psi[:, -1]\n            \n            # Calculate the potential term\n            potential_term = (1.0 - np.abs(psi)**2) * psi\n\n            # Gradient of the free energy functional (RHS of the evolution eq.)\n            d_psi_dt = lap_x + lap_y + potential_term\n\n            # Update psi using forward Euler step\n            psi += dt * d_psi_dt\n\n        # --- Vortex Counting ---\n        # Calculate gauge-invariant phase differences on links\n        arg_psi = np.angle(psi)\n\n        # Phase difference on horizontal links (size Nx, Ny)\n        d_theta_x = wrap_angle(np.roll(arg_psi, -1, axis=0) - arg_psi - arg_U_x)\n\n        # Phase difference on vertical links (size Nx, Ny-1)\n        # Only defined for links inside the domain\n        d_theta_y = wrap_angle(arg_psi[:, 1:] - arg_psi[:, :-1])\n\n        # Calculate plaquette vorticity (gauge-invariant circulation)\n        # A plaquette (i,j) is bounded by points (i,j), (i+1,j), (i+1,j+1), (i,j+1)\n        # The sum is over i=0..Nx-1 and j=0..Ny-2. Omega has shape (Nx, Ny-1)\n        # Term 1: d_theta_x(i, j) for j=0..Ny-2\n        # Term 2: d_theta_y(i+1, j) for j=0..Ny-2\n        # Term 3: -d_theta_x(i, j+1) for j=0..Ny-2\n        # Term 4: -d_theta_y(i, j) for j=0..Ny-2\n        omega = wrap_angle(\n            d_theta_x[:, :-1] + \n            np.roll(d_theta_y, -1, axis=0) - \n            d_theta_x[:, 1:] - \n            d_theta_y\n        )\n\n        # Sum over all plaquettes and normalize to get the net vortex count\n        total_vorticity = np.sum(omega)\n        Nv = int(np.round(total_vorticity / (2 * np.pi)))\n        results.append(Nv)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}