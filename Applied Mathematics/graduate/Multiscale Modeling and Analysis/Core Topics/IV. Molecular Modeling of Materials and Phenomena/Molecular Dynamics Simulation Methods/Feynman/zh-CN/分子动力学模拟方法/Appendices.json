{
    "hands_on_practices": [
        {
            "introduction": "分子动力学模拟的核心是数值求解牛顿运动方程。积分的稳定性和准确性严重依赖于时间步长 $\\Delta t$ 的选择，过大的时间步长会导致模拟发散。本练习通过分析速度 Verlet 算法在简谐振子（可视为分子中最快振动的模型）上的表现，为理解这一稳定性极限提供了严谨的基础，从而将一个基本的数值参数与系统的物理性质直接联系起来。",
            "id": "3782502",
            "problem": "在分子动力学 (MD) 中，粒子的速度和位置通过源自牛顿第二定律的时间积分方案进行时间推进。考虑一个质量为 $m$ 的单个粒子，被限制在一个空间维度上，并受到简谐力 $F(x)=-kx$ 的作用，因此其运动方程为 $m\\,\\ddot{x}=-kx$。该线性振子模拟了稳定平衡点附近的小振幅振动，并且是在多尺度建模中用于分析显式积分器时间步长稳定性的标准替代模型。\n\n从牛顿第二定律和加速度的定义 $a(x) = \\ddot{x} = F(x)/m$ 出发，采用标准的速度 Verlet 算法。该算法通过一次使用当前速度和加速度的位置更新，随后进行一次使用当前和下一步加速度平均值的速度更新，来在一个时间步长 $\\Delta t$ 内推进位置和速度。对于简谐振子，其加速度为 $a(x)=-\\omega^{2}x$，其中 $\\omega=\\sqrt{k/m}$。\n\n1. 在速度 Verlet 算法下，以闭合形式推导将时刻 $t_n$ 的状态 $(x_n, v_n)$ 映射到时刻 $t_{n+1}=t_n+\\Delta t$ 的状态 $(x_{n+1}, v_{n+1})$ 的单步线性更新。将此映射写成作用于状态向量的放大矩阵 $A(\\omega,\\Delta t)$ 的形式，即：\n   $$\\begin{pmatrix} x_{n+1} \\\\ v_{n+1} \\end{pmatrix} = A(\\omega,\\Delta t)\\,\\begin{pmatrix} x_{n} \\\\ v_{n} \\end{pmatrix}。$$\n\n2. 使用 $A(\\omega,\\Delta t)$ 的特征值，分析该方案的线性稳定性。施加放大因子的模长小于或等于1（无指数增长）的条件，并确定最大稳定时间步长 $\\Delta t_{\\max}$ 作为 $\\omega$ 的函数。\n\n将 $\\Delta t_{\\max}$ 的最终答案表示为关于 $\\omega$ 的闭合形式解析表达式。不要在最终答案中代入数值，也不要包含单位。如果您为了自行验证而选择对特定的 $\\omega$ 进行 $\\Delta t_{\\max}$ 的数值计算，请以秒为单位表示时间，并四舍五入到四位有效数字。",
            "solution": "本题要求推导应用于简谐振子的速度 Verlet 算法的单步更新矩阵，并随后进行线性稳定性分析以确定最大稳定时间步长。\n\n一维简谐振子的运动方程由 $m\\ddot{x} = -kx$ 给出，其中 $m$ 是质量，$x$ 是位置，$k$ 是劲度系数。加速度为 $a(x) = \\ddot{x} = -\\frac{k}{m}x$。通过定义角频率 $\\omega = \\sqrt{k/m}$，加速度可以写为 $a(x) = -\\omega^2 x$。\n\n速度 Verlet 算法包含两个主要步骤，用于将状态从时间 $t_n$ 推进到 $t_{n+1} = t_n + \\Delta t$：\n1. 位置更新： $$x_{n+1} = x_n + v_n \\Delta t + \\frac{1}{2} a_n (\\Delta t)^2$$\n2. 速度更新： $$v_{n+1} = v_n + \\frac{1}{2}(a_n + a_{n+1})\\Delta t$$\n此处，$(x_n, v_n)$ 是时刻 $t_n$ 的状态，$\\Delta t$ 是时间步长，$a_n = a(x_n)$ 和 $a_{n+1} = a(x_{n+1})$ 分别是当前和下一个时间步长的加速度。\n\n**第一部分：推导更新矩阵 $A(\\omega, \\Delta t)$**\n\n我们将简谐振子的特定加速度 $a_n = -\\omega^2 x_n$ 和 $a_{n+1} = -\\omega^2 x_{n+1}$ 代入算法的方程中。\n\n位置更新变为：\n$$x_{n+1} = x_n + v_n \\Delta t + \\frac{1}{2}(-\\omega^2 x_n)(\\Delta t)^2$$\n重新整理以组合 $x_n$ 和 $v_n$ 的项：\n$$x_{n+1} = \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 \\right) x_n + (\\Delta t) v_n$$\n此方程提供了放大矩阵 $A$ 的第一行。\n\n速度更新为：\n$$v_{n+1} = v_n + \\frac{1}{2}(-\\omega^2 x_n - \\omega^2 x_{n+1}) \\Delta t$$\n$$v_{n+1} = v_n - \\frac{1}{2}\\omega^2 \\Delta t (x_n + x_{n+1})$$\n为了仅用时刻 $t_n$ 的状态 $(x_n, v_n)$ 来表示 $v_{n+1}$，我们代入刚刚推导出的 $x_{n+1}$ 的表达式：\n$$v_{n+1} = v_n - \\frac{1}{2}\\omega^2 \\Delta t \\left[x_n + \\left( \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 \\right) x_n + (\\Delta t) v_n \\right) \\right]$$\n收集括号内关于 $x_n$ 和 $v_n$ 的项：\n$$v_{n+1} = v_n - \\frac{1}{2}\\omega^2 \\Delta t \\left[ \\left(2 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 \\right) x_n + (\\Delta t) v_n \\right]$$\n分配因子 $-\\frac{1}{2}\\omega^2 \\Delta t$：\n$$v_{n+1} = v_n - \\omega^2 \\Delta t \\left(1 - \\frac{1}{4}\\omega^2 (\\Delta t)^2 \\right) x_n - \\frac{1}{2}\\omega^2 (\\Delta t)^2 v_n$$\n最后，组合关于 $x_n$ 和 $v_n$ 的项：\n$$v_{n+1} = - \\omega^2 \\Delta t \\left(1 - \\frac{1}{4}\\omega^2 (\\Delta t)^2 \\right) x_n + \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 \\right)v_n$$\n此方程提供了矩阵 $A$ 的第二行。\n\n将这两个结果合并到矩阵方程 $\\begin{pmatrix} x_{n+1} \\\\ v_{n+1} \\end{pmatrix} = A \\begin{pmatrix} x_{n} \\\\ v_{n} \\end{pmatrix}$ 中，我们确定放大矩阵 $A$ 为：\n$$A(\\omega, \\Delta t) = \\begin{pmatrix} 1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 & \\Delta t \\\\ -\\omega^2 \\Delta t \\left(1 - \\frac{1}{4}\\omega^2 (\\Delta t)^2 \\right) & 1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2 \\end{pmatrix}$$\n\n**第二部分：稳定性分析**\n\n数值方案的稳定性由放大矩阵 $A$ 的特征值 $\\lambda$ 决定。该方案是稳定的，当且仅当所有特征值的模长都小于或等于1，即 $|\\lambda| \\le 1$。特征值是特征方程 $\\det(A - \\lambda I) = 0$ 的根，该方程可以写为 $\\lambda^2 - \\text{Tr}(A)\\lambda + \\det(A) = 0$。\n\n首先，我们计算 $A$ 的迹和行列式。\n迹是对角元素之和：\n$$\\text{Tr}(A) = \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2\\right) + \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2\\right) = 2 - \\omega^2 (\\Delta t)^2$$\n行列式为：\n$$\\det(A) = \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2\\right)^2 - (\\Delta t) \\left(-\\omega^2 \\Delta t \\left(1 - \\frac{1}{4}\\omega^2 (\\Delta t)^2 \\right)\\right)$$\n$$\\det(A) = \\left(1 - \\omega^2 (\\Delta t)^2 + \\frac{1}{4}\\omega^4 (\\Delta t)^4\\right) + \\omega^2 (\\Delta t)^2 \\left(1 - \\frac{1}{4}\\omega^2 (\\Delta t)^2 \\right)$$\n$$\\det(A) = 1 - \\omega^2 (\\Delta t)^2 + \\frac{1}{4}\\omega^4 (\\Delta t)^4 + \\omega^2 (\\Delta t)^2 - \\frac{1}{4}\\omega^4 (\\Delta t)^4 = 1$$\n$\\det(A)=1$ 这一性质证实了速度 Verlet 算法是一种辛积分器，它对于哈密顿系统能够保持相空间体积守恒。\n\n特征值的特征方程为：\n$$\\lambda^2 - \\left(2 - \\omega^2 (\\Delta t)^2\\right)\\lambda + 1 = 0$$\n使用二次公式求解 $\\lambda$：\n$$\\lambda = \\frac{(2 - \\omega^2 (\\Delta t)^2) \\pm \\sqrt{(2 - \\omega^2 (\\Delta t)^2)^2 - 4}}{2}$$\n$$\\lambda = \\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2\\right) \\pm \\sqrt{\\left(1 - \\frac{1}{2}\\omega^2 (\\Delta t)^2\\right)^2 - 1}$$\n让我们定义一个无量纲参数 $s = \\omega \\Delta t$。特征值的表达式变为：\n$$\\lambda = \\left(1 - \\frac{s^2}{2}\\right) \\pm \\sqrt{\\left(1 - \\frac{s^2}{2}\\right)^2 - 1} = \\left(1 - \\frac{s^2}{2}\\right) \\pm \\sqrt{1 - s^2 + \\frac{s^4}{4} - 1} = \\left(1 - \\frac{s^2}{2}\\right) \\pm \\sqrt{\\frac{s^4}{4} - s^2}$$\n\n特征值的性质取决于判别式 $D = \\frac{s^4}{4} - s^2 = s^2\\left(\\frac{s^2}{4} - 1\\right)$ 的符号。\n\n情况1：稳定区 ($s^2 < 4$，或 $|\\omega \\Delta t| < 2$)。\n判别式为负，因此特征值是一对共轭复数。\n$$|\\lambda|^2 = \\left(1 - \\frac{s^2}{2}\\right)^2 - \\left(\\frac{s^4}{4} - s^2\\right) = 1 - s^2 + \\frac{s^4}{4} - \\frac{s^4}{4} + s^2 = 1$$\n因此，对于 $|\\omega \\Delta t| < 2$，特征值位于单位圆上 ($|\\lambda|=1$)，算法是稳定的。解的振幅不会增长或衰减，正确地模拟了振子的能量守恒。\n\n情况2：稳定边界 ($s^2 = 4$，或 $|\\omega \\Delta t| = 2$)。\n判别式为零，得到一个重实数特征值：\n$$\\lambda = 1 - \\frac{s^2}{2} = 1 - \\frac{4}{2} = -1$$\n模长为 $|\\lambda| = 1$，因此该方案是临界稳定的。\n\n情况3：不稳定区 ($s^2 > 4$，或 $|\\omega \\Delta t| > 2$)。\n判别式为正，因此特征值是两个互异的实数：\n$$\\lambda_{\\pm} = \\left(1 - \\frac{s^2}{2}\\right) \\pm \\sqrt{s^2\\left(\\frac{s^2}{4} - 1\\right)}$$\n由于 $\\det(A) = \\lambda_+\\lambda_- = 1$，一个特征值的模长必须大于1，而另一个则小于1。对于 $s^2 > 4$，项 $1 - \\frac{s^2}{2}$ 小于 -1。因此，特征值 $\\lambda_- = (1 - s^2/2) - \\sqrt{...}$ 将是一个模长大于1的实数。这导致解的指数增长，因此该方案是不稳定的。\n\n线性稳定性的条件 $|\\lambda| \\le 1$ 当且仅当 $s^2 \\le 4$ 时满足。由于 $\\omega > 0$ 且 $\\Delta t > 0$，这等价于 $\\omega \\Delta t \\le 2$。\n\n最大稳定时间步长 $\\Delta t_{\\max}$ 对应于等式成立的情况：\n$$\\omega \\Delta t_{\\max} = 2$$\n解出 $\\Delta t_{\\max}$ 得：\n$$\\Delta t_{\\max} = \\frac{2}{\\omega}$$\n这就是速度 Verlet 算法应用于简谐振子时的稳定性极限。",
            "answer": "$$\\boxed{\\frac{2}{\\omega}}$$"
        },
        {
            "introduction": "在实际模拟中，我们常常约束最快的运动模式（如键振动）以允许使用更大的时间步长。然而，用于施加这些约束的算法（如 SHAKE）并非完美。本练习探讨了一个精妙而重要的观点：约束算法的有限数值容差可以被建模为一个非常硬的弹簧，而这个“伪”弹簧向系统中引入了一个新的高频振动模式。通过将统计力学（能量均分定理）与数值分析相结合，本练习揭示了算法参数（容差）如何对模拟的时间步长构成物理限制 ，加深了我们对 MD 中物理学与数值方法之间复杂相互作用的理解。",
            "id": "3782515",
            "problem": "考虑一个简单的受约束的分子动力学 (MD) 系统，该系统由两个质量为 $m$ 的相同原子组成，它们在三维空间中运动，其原子间距通过一个完整约束被固定为值 $r_{0}$。该约束通过一个类似于 SHAKE 的位置层面迭代校正器和一个类似于 RATTLE 的速度层面校正器来强制执行，但在实践中，当残余键长违反量的大小 $\\delta r = |\\mathbf{r}_{2} - \\mathbf{r}_{1}| - r_{0}$ 满足 $|\\delta r| \\leq \\tau$ 时，校正器会终止，其中 $\\tau$ 是一个给定的容差。假设在约束流形附近，以容差 $\\tau$ 终止约束迭代的主阶效应，可以通过为哈密顿量增加一个小的谐波惩罚势 $V_{p} = \\frac{1}{2}\\,\\kappa\\,(\\delta r)^{2}$ 来建模，该势仅沿约束键方向作用，从而用一个刚性但有限的恢复力取代理想约束。\n\n仅从以下几点出发：\n- 牛顿第二定律（力等于质量乘以加速度），\n- 完整约束的定义和双粒子系统的相对坐标，\n- 以及温度为 $T$ 时统计力学的能量均分定理，该定理指出对于一个二次自由度，其平均热能为 $\\frac{1}{2} k_{B} T$，其中 $k_{B}$ 是玻尔兹曼常数，\n\n完成以下任务：\n1. 通过确定与键长坐标相关的适当有效质量，并选择 $\\kappa$ 使得 $\\delta r$ 的热均方根振幅等于 $\\tau$，用 $m$、$k_{B}$、$T$ 和 $\\tau$ 推导出由有限约束容差 $\\tau$ 引入的伪振动模式的有效角频率 $\\omega_{\\text{eff}}$。\n2. 使用一维谐振子的速度-Verlet (Störmer–Verlet) 积分的线性稳定性条件，用 $m$、$k_{B}$、$T$ 和 $\\tau$ 推导最大稳定时间步长 $h_{\\max}$。\n\n将最终答案表示为 $h_{\\max}$ 的单个封闭形式解析表达式。未提供数值，无需进行四舍五入。在最终的方框表达式中不要包含单位。",
            "solution": "解答过程根据问题陈述的要求分为两部分。\n\n**第一部分：推导有效角频率 $\\omega_{\\text{eff}}$**\n\n我们首先分析这个双粒子系统的动力学。设两个原子的位置矢量为 $\\mathbf{r}_{1}$ 和 $\\mathbf{r}_{2}$。系统的总动能由下式给出：\n$$\nK = \\frac{1}{2} m |\\dot{\\mathbf{r}}_{1}|^2 + \\frac{1}{2} m |\\dot{\\mathbf{r}}_{2}|^2\n$$\n变换到质心坐标和相对坐标会很方便。质心矢量 $\\mathbf{R}$ 和相对位置矢量 $\\mathbf{r}$ 定义如下：\n$$\n\\mathbf{R} = \\frac{\\mathbf{r}_{1} + \\mathbf{r}_{2}}{2}, \\quad \\mathbf{r} = \\mathbf{r}_{2} - \\mathbf{r}_{1}\n$$\n反解这些关系，我们得到 $\\mathbf{r}_{1} = \\mathbf{R} - \\frac{1}{2}\\mathbf{r}$ 和 $\\mathbf{r}_{2} = \\mathbf{R} + \\frac{1}{2}\\mathbf{r}$。对应的速度为 $\\dot{\\mathbf{r}}_{1} = \\dot{\\mathbf{R}} - \\frac{1}{2}\\dot{\\mathbf{r}}$ 和 $\\dot{\\mathbf{r}}_{2} = \\dot{\\mathbf{R}} + \\frac{1}{2}\\dot{\\mathbf{r}}$。将这些代入动能表达式：\n$$\nK = \\frac{1}{2} m \\left|\\dot{\\mathbf{R}} - \\frac{1}{2}\\dot{\\mathbf{r}}\\right|^2 + \\frac{1}{2} m \\left|\\dot{\\mathbf{R}} + \\frac{1}{2}\\dot{\\mathbf{r}}\\right|^2\n$$\n$$\nK = \\frac{1}{2} m \\left( |\\dot{\\mathbf{R}}|^2 - \\dot{\\mathbf{R}} \\cdot \\dot{\\mathbf{r}} + \\frac{1}{4}|\\dot{\\mathbf{r}}|^2 \\right) + \\frac{1}{2} m \\left( |\\dot{\\mathbf{R}}|^2 + \\dot{\\mathbf{R}} \\cdot \\dot{\\mathbf{r}} + \\frac{1}{4}|\\dot{\\mathbf{r}}|^2 \\right)\n$$\n$$\nK = \\frac{1}{2} (2m) |\\dot{\\mathbf{R}}|^2 + \\frac{1}{2} \\left(\\frac{m}{2}\\right) |\\dot{\\mathbf{r}}|^2\n$$\n动能分解为描述总质量为 $M=2m$ 的质心运动的项，以及描述折合质量为 $\\mu = \\frac{m \\cdot m}{m + m} = \\frac{m}{2}$ 的相对运动的项。\n\n问题陈述指出，不完美约束的效应通过势能 $V_{p} = \\frac{1}{2}\\kappa (\\delta r)^2$ 来建模，其中 $\\delta r = |\\mathbf{r}| - r_{0}$。该势能沿键方向作用。与此势相关的力为 $F = -\\frac{d V_p}{d(\\delta r)} = -\\kappa(\\delta r)$。由于 $\\delta r$ 代表相对坐标大小偏离平衡位置的位移，这个小位移的运动方程就是一个简谐振子方程：\n$$\n\\mu \\frac{d^2(\\delta r)}{dt^2} = -\\kappa (\\delta r)\n$$\n对于由 $\\mu \\ddot{x} = -kx$ 描述的谐振子，其角频率 $\\omega$ 由 $\\omega^2 = k/\\mu$ 给出。在我们的情况中，质量是折合质量 $\\mu = m/2$，弹簧常数是 $\\kappa$。因此，伪振动模式的有效角频率 $\\omega_{\\text{eff}}$ 由下式给出：\n$$\n\\omega_{\\text{eff}}^2 = \\frac{\\kappa}{\\mu} = \\frac{\\kappa}{m/2} = \\frac{2\\kappa}{m}\n$$\n为了求出 $\\omega_{\\text{eff}}$，我们必须首先确定 $\\kappa$。问题要求我们使用能量均分定理以及 $\\delta r$ 的均方根振幅为 $\\tau$ 的条件。势能 $V_p = \\frac{1}{2}\\kappa (\\delta r)^2$ 是坐标 $\\delta r$ 的二次函数。根据能量均分定理，在温度 $T$ 下，储存在该势能模式中的平均热能为：\n$$\n\\langle V_p \\rangle = \\frac{1}{2} k_{B} T\n$$\n代入 $V_p$ 的表达式：\n$$\n\\left\\langle \\frac{1}{2}\\kappa (\\delta r)^2 \\right\\rangle = \\frac{1}{2} \\kappa \\langle (\\delta r)^2 \\rangle = \\frac{1}{2} k_{B} T\n$$\n这得到 $\\kappa \\langle (\\delta r)^2 \\rangle = k_{B} T$。\n$\\delta r$ 的均方根 (RMS) 振幅定义为 $\\sqrt{\\langle (\\delta r)^2 \\rangle}$。题目给定该均方根值等于容差 $\\tau$。\n$$\n\\sqrt{\\langle (\\delta r)^2 \\rangle} = \\tau \\implies \\langle (\\delta r)^2 \\rangle = \\tau^2\n$$\n将此代入 $\\kappa$ 的方程中：\n$$\n\\kappa \\tau^2 = k_{B} T \\implies \\kappa = \\frac{k_{B} T}{\\tau^2}\n$$\n现在我们可以求出 $\\omega_{\\text{eff}}$\n$$\n\\omega_{\\text{eff}}^2 = \\frac{2\\kappa}{m} = \\frac{2}{m} \\left( \\frac{k_{B} T}{\\tau^2} \\right) = \\frac{2 k_{B} T}{m \\tau^2}\n$$\n取平方根得到有效角频率：\n$$\n\\omega_{\\text{eff}} = \\sqrt{\\frac{2 k_{B} T}{m \\tau^2}} = \\frac{1}{\\tau} \\sqrt{\\frac{2 k_{B} T}{m}}\n$$\n\n**第二部分：推导最大稳定时间步长 $h_{\\max}$**\n\n数值积分方案的稳定性受限于系统中存在的最高频率。在此模型中，频率为 $\\omega_{\\text{eff}}$ 的伪高频模式是限制因素。问题指定使用一维谐振子的速度-Verlet积分的线性稳定性条件。对于运动方程为 $\\ddot{x} = -\\omega^2 x$ 的振子，速度-Verlet算法是稳定的当且仅当时间步长 $h$ 满足以下条件：\n$$\n\\omega h \\leq 2\n$$\n因此，最大稳定时间步长 $h_{\\max}$ 由等式给出：\n$$\nh_{\\max} = \\frac{2}{\\omega}\n$$\n将此应用于我们的系统，相关频率为 $\\omega = \\omega_{\\text{eff}}$。\n$$\nh_{\\max} = \\frac{2}{\\omega_{\\text{eff}}}\n$$\n代入第一部分推导出的 $\\omega_{\\text{eff}}$ 表达式：\n$$\nh_{\\max} = \\frac{2}{\\frac{1}{\\tau} \\sqrt{\\frac{2 k_{B} T}{m}}} = 2 \\tau \\sqrt{\\frac{m}{2 k_{B} T}}\n$$\n我们可以通过将因子 $2$ 移入平方根内来简化此表达式：\n$$\nh_{\\max} = \\tau \\sqrt{\\frac{4m}{2 k_{B} T}} = \\tau \\sqrt{\\frac{2m}{k_{B} T}}\n$$\n这就是最大稳定时间步长的最终表达式。",
            "answer": "$$\\boxed{\\tau\\sqrt{\\frac{2m}{k_{B}T}}}$$"
        },
        {
            "introduction": "我们已经看到，无论是真实的物理运动还是数值方法引入的运动，高频振动都会限制我们的模拟时间步长。提高效率的一个关键策略是认识到并非所有力的变化速率都相同。像参考系统传播算法（RESPA）这样的多时间步长（MTS）方法正是利用了这一点，通过更频繁地更新快速变化的力（如键振动），而较少地更新缓慢变化的力（如长程静电力）。本练习通过计算一个真实的 RESPA 方案所带来的计算加速比，让您对如何设计高级算法以实现大规模生物分子模拟的可行性有一个具体而定量的认识。",
            "id": "3782508",
            "problem": "考虑一个使用分子动力学 (MD) 演化的溶剂化生物分子系统。原子运动遵循牛顿第二定律 $m_i \\,\\mathrm{d}^2 \\mathbf{r}_i/\\mathrm{d}t^2 = \\mathbf{F}_i$，其中原子 $i$ 上的总力分解为 $\\mathbf{F}_i = \\mathbf{F}_{i}^{\\text{bond}} + \\mathbf{F}_{i}^{\\text{short}} + \\mathbf{F}_{i}^{\\text{long}}$。在此，$\\mathbf{F}_{i}^{\\text{bond}}$ 聚合了键合相互作用（共价键伸缩、键角弯曲和扭转项），$\\mathbf{F}_{i}^{\\text{short}}$ 聚合了短程非键相互作用（Lennard-Jones 和具有球形截断和光滑切换的实空间库仑相互作用），而 $\\mathbf{F}_{i}^{\\text{long}}$ 聚合了由 Particle Mesh Ewald (PME) 计算的长程静电相互作用。您将基于这种力划分，使用参考系统传播算法 (Reference System Propagator Algorithm, RESPA) 设计一个多时间步长积分器，并估算相对于单时间步长 Verlet 方案的计算加速比。\n\n提出以下科学上真实的划分和时间步长分配：\n- 键合力 $\\mathbf{F}^{\\text{bond}}$：共价键、键角和扭转。将它们分配给最精细的内层时间步长 $\\Delta t_b = 1\\,\\mathrm{fs}$。\n- 短程非键力 $\\mathbf{F}^{\\text{short}}$：Lennard-Jones 和直至截断半径 $r_c = 1.0\\,\\mathrm{nm}$ 的直接空间库仑力，光滑切换函数从 $r_s = 0.9\\,\\mathrm{nm}$ 开始。将它们分配给一个中间时间步长 $\\Delta t_s = 2\\,\\mathrm{fs}$。\n- 长程静电力 $\\mathbf{F}^{\\text{long}}$：PME 倒易空间分量，网格间距为 $0.12\\,\\mathrm{nm}$，使用四阶 B 样条插值。将它们分配给外层时间步长 $\\Delta t_\\ell = 6\\,\\mathrm{fs}$。\n\n假设一个基准的单时间步长 Verlet 积分器使用 $\\Delta t_0 = 2\\,\\mathrm{fs}$，并在每一步都评估所有三类力。对于一个约有 $N \\approx 10^5$ 个原子的代表性溶剂化生物分子，假设每次力评估的实测墙上时钟成本（wall-clock costs）为：\n- 键合力评估成本 $C_b = 0.4\\,\\mathrm{ms}$，\n- 短程力评估成本 $C_s = 2.5\\,\\mathrm{ms}$，\n- 长程 PME 力评估成本 $C_\\ell = 8.0\\,\\mathrm{ms}$。\n\n从力分割下的时间离散化第一性原理出发，推导上述 RESPA 方案相对于基准单时间步长方案在模拟固定物理时间 $T$ 时获得的加速比。你的最终答案应为无量纲的加速因子，四舍五入到三位有效数字。将最终答案表示为一个无量纲数。",
            "solution": "目标是计算加速因子 $S$，其定义为在模拟相同的固定物理时间 $T$ 时，基准单时间步长方案的总计算成本与 RESPA 多时间步长方案的总成本之比。\n$$ S = \\frac{\\text{Cost}_{\\text{baseline}}}{\\text{Cost}_{\\text{RESPA}}} $$\n\n首先，我们将构建基准方案的总成本。基准积分器使用单个时间步长 $\\Delta t_0$。要模拟总时间 $T$，所需的步数为 $N_0 = T / \\Delta t_0$。在每一步中，所有三个力分量都会被评估。因此，每步的成本为 $C_{\\text{step},0} = C_b + C_s + C_\\ell$。\n基准模拟的总成本是步数乘以每步的成本：\n$$ \\text{Cost}_{\\text{baseline}} = N_0 \\cdot C_{\\text{step},0} = \\frac{T}{\\Delta t_0} (C_b + C_s + C_\\ell) $$\n\n接下来，我们构建 RESPA 方案的总成本。RESPA 算法围绕变化最慢的力构建，该力在最外层时间步长 $\\Delta t_\\ell$ 进行更新。要模拟总时间 $T$，最外层步骤的总数为 $N_\\ell = T / \\Delta t_\\ell$。我们需要计算在这样一个持续时间为 $\\Delta t_\\ell$ 的外层步骤内所执行的总计算工作量。\n\n在持续时间为 $\\Delta t_\\ell$ 的一个外层步骤内：\n1.  长程力 $\\mathbf{F}^{\\text{long}}$ 被评估一次。产生的成本为 $1 \\cdot C_\\ell$。\n2.  短程力 $\\mathbf{F}^{\\text{short}}$ 在每个中间时间步长 $\\Delta t_s$ 被评估。一个外层步骤内的短程力评估次数为 $n_s = \\Delta t_\\ell / \\Delta t_s$。产生的成本为 $n_s \\cdot C_s = (\\Delta t_\\ell / \\Delta t_s) \\cdot C_s$。\n3.  键合力 $\\mathbf{F}^{\\text{bond}}$ 在每个最内层时间步长 $\\Delta t_b$ 被评估。一个外层步骤内的键合力评估次数为 $n_b = \\Delta t_\\ell / \\Delta t_b$。产生的成本为 $n_b \\cdot C_b = (\\Delta t_\\ell / \\Delta t_b) \\cdot C_b$。\n\n持续时间为 $\\Delta t_\\ell$ 的单个 RESPA 外层步骤的总成本是这些成本的总和：\n$$ C_{\\text{step,RESPA}} = C_\\ell + \\frac{\\Delta t_\\ell}{\\Delta t_s} C_s + \\frac{\\Delta t_\\ell}{\\Delta t_b} C_b $$\nRESPA 模拟的总成本是外层步数乘以每个外层步骤的成本：\n$$ \\text{Cost}_{\\text{RESPA}} = N_\\ell \\cdot C_{\\text{step,RESPA}} = \\frac{T}{\\Delta t_\\ell} \\left( C_\\ell + \\frac{\\Delta t_\\ell}{\\Delta t_s} C_s + \\frac{\\Delta t_\\ell}{\\Delta t_b} C_b \\right) $$\n\n现在我们可以写出加速比 $S$ 的表达式：\n$$ S = \\frac{\\frac{T}{\\Delta t_0} (C_b + C_s + C_\\ell)}{\\frac{T}{\\Delta t_\\ell} \\left( C_\\ell + \\frac{\\Delta t_\\ell}{\\Delta t_s} C_s + \\frac{\\Delta t_\\ell}{\\Delta t_b} C_b \\right)} $$\n总模拟时间 $T$ 被消掉，得到在此背景下的通用加速比公式：\n$$ S = \\frac{\\Delta t_\\ell}{\\Delta t_0} \\cdot \\frac{C_b + C_s + C_\\ell}{C_\\ell + \\frac{\\Delta t_\\ell}{\\Delta t_s} C_s + \\frac{\\Delta t_\\ell}{\\Delta t_b} C_b} $$\n\n现在我们将给定的数值代入此表达式。\n- 时间步长：$\\Delta t_0 = 2\\,\\mathrm{fs}$，$\\Delta t_b = 1\\,\\mathrm{fs}$，$\\Delta t_s = 2\\,\\mathrm{fs}$，$\\Delta t_\\ell = 6\\,\\mathrm{fs}$。\n- 成本：$C_b = 0.4\\,\\mathrm{ms}$，$C_s = 2.5\\,\\mathrm{ms}$，$C_\\ell = 8.0\\,\\mathrm{ms}$。\n\n首先，计算代表基准模拟每步成本的分子项：\n$$ C_{\\text{baseline\\_per\\_step}} = C_b + C_s + C_\\ell = 0.4\\,\\mathrm{ms} + 2.5\\,\\mathrm{ms} + 8.0\\,\\mathrm{ms} = 10.9\\,\\mathrm{ms} $$\n\n接下来，计算代表 RESPA 积分器单个外层循环总成本的分母项。\n每个外层步骤的短程评估次数为 $n_s = \\Delta t_\\ell / \\Delta t_s = 6\\,\\mathrm{fs} / 2\\,\\mathrm{fs} = 3$。\n每个外层步骤的键合评估次数为 $n_b = \\Delta t_\\ell / \\Delta t_b = 6\\,\\mathrm{fs} / 1\\,\\mathrm{fs} = 6$。\n$$ C_{\\text{RESPA\\_per\\_outer\\_step}} = 1 \\cdot C_\\ell + n_s \\cdot C_s + n_b \\cdot C_b $$\n$$ C_{\\text{RESPA\\_per\\_outer\\_step}} = 1 \\cdot (8.0\\,\\mathrm{ms}) + 3 \\cdot (2.5\\,\\mathrm{ms}) + 6 \\cdot (0.4\\,\\mathrm{ms}) $$\n$$ C_{\\text{RESPA\\_per\\_outer\\_step}} = 8.0\\,\\mathrm{ms} + 7.5\\,\\mathrm{ms} + 2.4\\,\\mathrm{ms} = 17.9\\,\\mathrm{ms} $$\n\n最后，计算加速比 $S$。这等同于比较运行基准方案 $\\Delta t_\\ell$ 时间的成本与运行 RESPA 方案 $\\Delta t_\\ell$ 时间的成本。\n在 $\\Delta t_\\ell$ 持续时间内的基准步数是 $\\Delta t_\\ell / \\Delta t_0 = 6\\,\\mathrm{fs} / 2\\,\\mathrm{fs} = 3$。\n基准方法在 $\\Delta t_\\ell$ 期间的成本是 $3 \\cdot C_{\\text{baseline\\_per\\_step}} = 3 \\cdot 10.9\\,\\mathrm{ms} = 32.7\\,\\mathrm{ms}$。\nRESPA 方法在 $\\Delta t_\\ell$ 期间的成本是 $C_{\\text{RESPA\\_per\\_outer\\_step}} = 17.9\\,\\mathrm{ms}$。\n加速比是这些成本的比率：\n$$ S = \\frac{3 \\cdot (C_b + C_s + C_\\ell)}{1 \\cdot C_\\ell + n_s \\cdot C_s + n_b \\cdot C_b} = \\frac{3 \\cdot (10.9\\,\\mathrm{ms})}{17.9\\,\\mathrm{ms}} = \\frac{32.7}{17.9} $$\n$$ S \\approx 1.8268156... $$\n问题要求答案四舍五入到三位有效数字。\n$$ S \\approx 1.83 $$\n\n无量纲加速因子约为 $1.83$。这表明对于这个特定的系统和参数集，RESPA 方案比基准单时间步长方案快大约 $83\\%$。",
            "answer": "$$\n\\boxed{1.83}\n$$"
        }
    ]
}