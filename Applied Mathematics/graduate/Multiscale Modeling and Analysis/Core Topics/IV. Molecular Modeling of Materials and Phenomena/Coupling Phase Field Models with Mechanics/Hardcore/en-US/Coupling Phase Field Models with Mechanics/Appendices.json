{
    "hands_on_practices": [
        {
            "introduction": "In coupled phase-field models, the state of one field often acts as a source or driving force for the other. This exercise provides hands-on practice in quantifying this interaction by calculating the contribution of mechanical energy to the phase-field equation's residual vector. Mastering this finite element calculation is a foundational step in numerically implementing any coupled model, as it represents the \"force\" that drives phase-field evolution in response to mechanical strain .",
            "id": "3746916",
            "problem": "Consider the small-strain, plane strain elastic response of a linearly elastic body coupled to a scalar phase field variable $\\phi$ through a multiplicative degradation function in the mechanical free energy density. Start from the following fundamental bases:\n\n- The kinematics of small strain: the displacement field components $u_x$ and $u_y$ define the infinitesimal strain tensor $\\boldsymbol{\\varepsilon}$ via the symmetric gradient, and the engineering strain vector $\\boldsymbol{\\varepsilon} = \\left[\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}\\right]^T$ (where $\\gamma_{xy}$ is the engineering shear strain) is given by the spatial derivatives of the displacement field.\n- The linear elastic constitutive law in plane strain with Young's modulus $E$ and Poisson's ratio $\\nu$ defines the fourth-order elasticity tensor, which, in the engineering vector representation, yields the constitutive matrix $\\mathbf{C}$ relating stress and strain by $\\boldsymbol{\\sigma} = \\mathbf{C} \\boldsymbol{\\varepsilon}$.\n- The mechanical free energy density is $\\psi_e(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2} \\boldsymbol{\\varepsilon}^T \\mathbf{C} \\boldsymbol{\\varepsilon}$.\n- The total internal energy density contains the degraded mechanical energy $g(\\phi)\\,\\psi_e(\\boldsymbol{\\varepsilon})$ with the degradation function $g(\\phi) = (1 - \\phi)^2 + \\kappa$, where $\\kappa$ is a small, positive residual stiffness constant that is independent of $\\phi$.\n\nUsing the principle of virtual work and the calculus of variations, the coupling contribution from mechanics to the weak form of the $\\phi$-equation arises from the variational derivative of the degraded mechanical energy with respect to $\\phi$. When discretized with the Finite Element Method (FEM), the residual coupling vector entries associated with the $\\phi$-equation at the element level are obtained by integrating the mechanical coupling term against the $\\phi$-test functions over the element domain.\n\nYour task is to compute, for a single isoparametric bilinear quadrilateral element with unit thickness (specified as $1$ meter), the element-level residual coupling vector for the $\\phi$-equation due solely to mechanical contributions, using standard $2 \\times 2$ Gaussian quadrature. Use the canonical bilinear shape functions over the parent domain with natural coordinates $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$, and assemble the strain from the displacement degrees of freedom via the usual $\\mathbf{B}$-matrix. Assume plane strain. The degradation function derivative needed in the mechanical coupling is the derivative $g'(\\phi)$ with respect to $\\phi$.\n\nImplement the following numerical procedure:\n\n- Map the parent-space derivatives of the shape functions to physical-space derivatives using the Jacobian matrix of the isoparametric mapping at each Gauss point.\n- Construct the $\\mathbf{B}$-matrix at each Gauss point to compute the strain vector from the nodal displacements.\n- Evaluate $\\psi_e(\\boldsymbol{\\varepsilon})$ and $g'(\\phi)$ at each Gauss point, where $\\phi$ at the Gauss point is obtained from the nodal $\\phi$ values via the shape functions.\n- Accumulate the element residual coupling vector entries by integrating the product of the test function, the mechanical coupling term, and the determinant of the Jacobian times the quadrature weights over the Gauss points.\n- Use the constitutive matrix for plane strain with $E$ and $\\nu$.\n\nPhysical units: interpret $E$ in Pascals ($\\text{Pa}$), coordinates and displacements in meters ($\\text{m}$), and evaluate the residual entries in Joules ($\\text{J}$), assuming unit thickness of $1$ meter.\n\nAngle unit: not applicable.\n\nPercentages: not applicable.\n\nTest suite and parameters:\n\nLet the node ordering be $1$ (lower-left), $2$ (lower-right), $3$ (upper-right), $4$ (upper-left). For all test cases below, use $E = 2.10 \\times 10^{11}$ $\\text{Pa}$ and $\\nu = 0.30$, and adopt $\\kappa = 1.0 \\times 10^{-6}$ (dimensionless). The Gaussian quadrature uses points $(\\xi,\\eta) = (\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$ with unit weights.\n\n- Test case $1$ (uniform axial strain on unit square, moderate $\\phi$):\n  - Node coordinates in meters: $\\left[(0,0), (1,0), (1,1), (0,1)\\right]$.\n  - Displacements in meters: prescribe $u_x = \\alpha x$, $u_y = 0$, with $\\alpha = 1.0 \\times 10^{-4}$, giving nodal displacements $\\left[(0,0), (\\alpha,0), (\\alpha,0), (0,0)\\right]$.\n  - Nodal $\\phi$: $\\left[0.20, 0.20, 0.20, 0.20\\right]$.\n\n- Test case $2$ (zero strain on unit square, arbitrary $\\phi$):\n  - Node coordinates in meters: $\\left[(0,0), (1,0), (1,1), (0,1)\\right]$.\n  - Displacements in meters: $\\left[(0,0), (0,0), (0,0), (0,0)\\right]$.\n  - Nodal $\\phi$: $\\left[0.50, 0.50, 0.50, 0.50\\right]$.\n\n- Test case $3$ (distorted element with shear-type displacement and varying $\\phi$):\n  - Node coordinates in meters: $\\left[(0.0,0.0), (1.5,0.2), (1.4,1.3), (-0.1,0.9)\\right]$.\n  - Displacements in meters: prescribe $u_x = 0$, $u_y = \\beta x$, with $\\beta = 2.0 \\times 10^{-4}$, giving nodal displacements $\\left[(0,0), (0, 3.0 \\times 10^{-4}), (0, 2.8 \\times 10^{-4}), (0, -2.0 \\times 10^{-5})\\right]$.\n  - Nodal $\\phi$: $\\left[0.10, 0.40, 0.70, 0.20\\right]$.\n\n- Test case $4$ (uniform axial strain on unit square, $\\phi$ near unity):\n  - Node coordinates in meters: $\\left[(0,0), (1,0), (1,1), (0,1)\\right]$.\n  - Displacements in meters: same as Test case $1$ with $\\alpha = 1.0 \\times 10^{-4}$.\n  - Nodal $\\phi$: $\\left[0.99, 0.99, 0.99, 0.99\\right]$.\n\nFinal output format:\n\nYour program should produce a single line of output containing a comma-separated list of the element residual coupling vectors (mechanical contribution only) for the $\\phi$-equation for all test cases, with each residual vector represented as a comma-separated list of four floating-point numbers. The entire output should be a single list of lists enclosed in square brackets, for example, $\\left[[r_{1,1}, r_{1,2}, r_{1,3}, r_{1,4}], [r_{2,1}, \\dots], \\dots \\right]$. Print exactly this single line.",
            "solution": "The problem is scientifically grounded, well-posed, and all necessary parameters are provided. It is a standard application of the Finite Element Method to a coupled chemo-mechanical or damage-mechanical problem. Therefore, the problem is deemed valid.\n\nThe task is to compute the element-level residual vector for the phase-field equation, specifically the contribution arising from the mechanical stored energy. This vector, denoted $\\mathbf{r}_{\\phi,\\text{mech}}^e$, represents the nodal forces thermodynamically conjugate to the nodal phase-field variables, driven by the mechanical strain state.\n\nThe starting point is the total internal energy density, which includes the degraded mechanical energy term $g(\\phi)\\psi_e(\\boldsymbol{\\varepsilon})$. The variational derivative of this term with respect to the phase field $\\phi$ gives the mechanical source term in the phase-field evolution equation:\n$$\nS_{\\text{mech}} = \\frac{\\partial (g(\\phi)\\psi_e(\\boldsymbol{\\varepsilon}))}{\\partial \\phi} = g'(\\phi)\\psi_e(\\boldsymbol{\\varepsilon})\n$$\nThe degradation function is given as $g(\\phi) = (1 - \\phi)^2 + \\kappa$, so its derivative with respect to $\\phi$ is:\n$$\ng'(\\phi) = -2(1 - \\phi)\n$$\nThe mechanical free energy density, for linear elasticity, is $\\psi_e(\\boldsymbol{\\varepsilon}) = \\frac{1}{2} \\boldsymbol{\\varepsilon}^T \\mathbf{C} \\boldsymbol{\\varepsilon}$. In the context of the Finite Element Method, the contribution to the weak form is obtained by integrating the source term against a test function $v_{\\phi}$ over the element domain $\\Omega_e$. Using the Bubnov-Galerkin method, the test functions are the same as the shape functions, $N_i$. The $i$-th component of the element residual vector is thus:\n$$\nr_i = \\int_{\\Omega_e} N_i S_{\\text{mech}} \\, dV = \\int_{\\Omega_e} N_i \\, g'(\\phi) \\, \\psi_e(\\boldsymbol{\\varepsilon}) \\, dV\n$$\nFor a two-dimensional element with unit thickness $t=1$, the volume integral becomes an area integral, $dV = t \\, dA = 1 \\cdot dA$. The integral is evaluated numerically using $2 \\times 2$ Gaussian quadrature. The transformation from physical coordinates $(x,y)$ to parent coordinates $(\\xi, \\eta)$ introduces the Jacobian determinant, $\\det(\\mathbf{J})$, where $dA = \\det(\\mathbf{J}) d\\xi d\\eta$. The residual vector components are approximated as a sum over the $N_{gp}=4$ Gauss points:\n$$\nr_i \\approx \\sum_{q=1}^{N_{gp}} w_q N_i(\\boldsymbol{\\xi}_q) \\, g'(\\phi(\\boldsymbol{\\xi}_q)) \\, \\psi_e(\\boldsymbol{\\varepsilon}(\\boldsymbol{\\xi}_q)) \\det(\\mathbf{J}(\\boldsymbol{\\xi}_q))\n$$\nwhere $\\boldsymbol{\\xi}_q$ are the coordinates of the $q$-th Gauss point, and $w_q$ is the corresponding weight. For this problem, $w_q = 1$ for all $q$.\n\nThe procedure at each Gauss point $\\boldsymbol{\\xi}_q = (\\xi_q, \\eta_q)$ is as follows:\n1.  **Interpolate Fields**: The phase field $\\phi$ is interpolated from its nodal values $\\phi_j$ using the shape functions $N_j(\\boldsymbol{\\xi}_q)$:\n    $$\n    \\phi(\\boldsymbol{\\xi}_q) = \\sum_{j=1}^4 N_j(\\boldsymbol{\\xi}_q) \\phi_j\n    $$\n    The shape functions for a bilinear quadrilateral element with nodes ordered counter-clockwise starting from $(\\xi,\\eta)=(-1,-1)$ are:\n    $N_1 = \\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_2 = \\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_3 = \\frac{1}{4}(1+\\xi)(1+\\eta)$, $N_4 = \\frac{1}{4}(1-\\xi)(1+\\eta)$.\n\n2.  **Compute Geometric Mapping**: The Jacobian matrix of the isoparametric mapping from parent to physical coordinates is calculated:\n    $$\n    \\mathbf{J} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix} = \\begin{bmatrix} \\sum_j \\frac{\\partial N_j}{\\partial \\xi} x_j & \\sum_j \\frac{\\partial N_j}{\\partial \\xi} y_j \\\\ \\sum_j \\frac{\\partial N_j}{\\partial \\eta} x_j & \\sum_j \\frac{\\partial N_j}{\\partial \\eta} y_j \\end{bmatrix}\n    $$\n\n3.  **Compute Strain**: The strain vector is computed from the nodal displacements $\\mathbf{d}^e = [u_{x1}, u_{y1}, \\dots, u_{x4}, u_{y4}]^T$ via the strain-displacement matrix $\\mathbf{B}$:\n    $$\n    \\boldsymbol{\\varepsilon} = \\mathbf{B} \\mathbf{d}^e\n    $$\n    The problem statement specifies an engineering strain vector as $\\boldsymbol{\\varepsilon} = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^T$. The matrix $\\mathbf{B}$ relates these strains to nodal displacements and contains spatial derivatives of the shape functions, $\\frac{\\partial N_j}{\\partial x}$ and $\\frac{\\partial N_j}{\\partial y}$, which are found using the inverse of the Jacobian:\n    $$\n    \\begin{Bmatrix} \\frac{\\partial N_j}{\\partial x} \\\\ \\frac{\\partial N_j}{\\partial y} \\end{Bmatrix} = \\mathbf{J}^{-1} \\begin{Bmatrix} \\frac{\\partial N_j}{\\partial \\xi} \\\\ \\frac{\\partial N_j}{\\partial \\eta} \\end{Bmatrix}\n    $$\n    The $\\mathbf{B}$ matrix for node $j$ is $\\mathbf{B}_j = \\begin{bmatrix} \\frac{\\partial N_j}{\\partial x} & 0 \\\\ 0 & \\frac{\\partial N_j}{\\partial y} \\\\ \\frac{\\partial N_j}{\\partial y} & \\frac{\\partial N_j}{\\partial x} \\end{bmatrix}$, and the full $\\mathbf{B}$ matrix is $\\mathbf{B} = [\\mathbf{B}_1, \\mathbf{B}_2, \\mathbf{B}_3, \\mathbf{B}_4]$.\n\n4.  **Compute Energy Density**: The constitutive matrix $\\mathbf{C}$ for plane strain is:\n    $$\n    \\mathbf{C} = \\frac{E}{(1+\\nu)(1-2\\nu)} \\begin{bmatrix} 1-\\nu & \\nu & 0 \\\\ \\nu & 1-\\nu & 0 \\\\ 0 & 0 & \\frac{1-2\\nu}{2} \\end{bmatrix}\n    $$\n    The elastic energy density is then calculated as $\\psi_e = \\frac{1}{2} (\\mathbf{B} \\mathbf{d}^e)^T \\mathbf{C} (\\mathbf{B} \\mathbf{d}^e)$.\n\n5.  **Assemble Residual**: All terms are combined at each Gauss point and summed to compute the final element residual vector $\\mathbf{r}_{\\phi,\\text{mech}}^e = [r_1, r_2, r_3, r_4]^T$.\n\nThis procedure is implemented for each test case using the provided material properties ($E = 2.10 \\times 10^{11} \\text{ Pa}$, $\\nu = 0.30$, $\\kappa = 1.0 \\times 10^{-6}$), geometry, and field values.",
            "answer": "```python\nimport numpy as np\n\ndef calculate_residual_vector(coords, displacements, phis, E, nu, kappa):\n    \"\"\"\n    Computes the element-level residual coupling vector for the phi-equation.\n    \n    Args:\n        coords (list of tuples): Nodal coordinates [(x1,y1), (x2,y2), ...].\n        displacements (list of tuples): Nodal displacements [(ux1,uy1), (ux2,uy2), ...].\n        phis (list): Nodal phase-field values [phi1, phi2, ...].\n        E (float): Young's modulus.\n        nu (float): Poisson's ratio.\n        kappa (float): Residual stiffness constant.\n\n    Returns:\n        np.array: The 4-component element residual vector.\n    \"\"\"\n    # Material properties and constitutive matrix for plane strain\n    C = np.zeros((3, 3))\n    factor = E / ((1 + nu) * (1 - 2 * nu))\n    C[0, 0] = factor * (1 - nu)\n    C[1, 1] = factor * (1 - nu)\n    C[0, 1] = factor * nu\n    C[1, 0] = factor * nu\n    C[2, 2] = E / (2 * (1 + nu)) # Shear modulus G\n\n    # Gaussian quadrature points and weights for 2x2 scheme\n    a = 1.0 / np.sqrt(3.0)\n    gauss_points = [(-a, -a), (a, -a), (a, a), (-a, a)]\n    gauss_weights = [1.0, 1.0, 1.0, 1.0]\n\n    # Nodal data vectors\n    nodal_coords = np.array(coords, dtype=float)\n    nodal_displacements = np.array(displacements, dtype=float).flatten()\n    nodal_phis = np.array(phis, dtype=float)\n\n    residual_vec = np.zeros(4, dtype=float)\n\n    for q_idx in range(len(gauss_points)):\n        xi, eta = gauss_points[q_idx]\n        weight = gauss_weights[q_idx]\n\n        # Shape functions and their derivatives in parent domain\n        N = 0.25 * np.array([\n            (1 - xi) * (1 - eta),\n            (1 + xi) * (1 - eta),\n            (1 + xi) * (1 + eta),\n            (1 - xi) * (1 + eta)\n        ])\n        dN_dxi = 0.25 * np.array([\n            -(1 - eta), (1 - eta), (1 + eta), -(1 + eta)\n        ])\n        dN_deta = 0.25 * np.array([\n            -(1 - xi), -(1 + xi), (1 + xi), (1 - xi)\n        ])\n\n        # Jacobian matrix\n        J = np.zeros((2, 2))\n        J[0, 0] = np.dot(dN_dxi, nodal_coords[:, 0])\n        J[0, 1] = np.dot(dN_dxi, nodal_coords[:, 1])\n        J[1, 0] = np.dot(dN_deta, nodal_coords[:, 0])\n        J[1, 1] = np.dot(dN_deta, nodal_coords[:, 1])\n\n        detJ = np.linalg.det(J)\n        if detJ <= 0:\n            raise ValueError(\"Jacobian determinant is non-positive.\")\n        invJ = np.linalg.inv(J)\n\n        # Derivatives of shape functions in physical domain\n        dN_dx_dy = invJ @ np.vstack((dN_dxi, dN_deta))\n        dN_dx = dN_dx_dy[0, :]\n        dN_dy = dN_dx_dy[1, :]\n\n        # Strain-displacement matrix (B)\n        B = np.zeros((3, 8))\n        B[0, 0::2] = dN_dx\n        B[1, 1::2] = dN_dy\n        B[2, 0::2] = dN_dy\n        B[2, 1::2] = dN_dx\n\n        # Strain vector at Gauss point\n        strain = B @ nodal_displacements\n\n        # Elastic energy density\n        psi_e = 0.5 * strain.T @ C @ strain\n        \n        # If strain is zero, no mechanical contribution\n        if np.isclose(psi_e, 0.0):\n            continue\n\n        # Phase-field value at Gauss point\n        phi_q = np.dot(N, nodal_phis)\n\n        # Derivative of degradation function\n        g_prime = -2.0 * (1.0 - phi_q)\n\n        # Accumulate residual vector\n        # Integrand = N_i * g'(phi) * psi_e. Integral over area = sum(w * integrand * detJ * t)\n        # with thickness t=1.\n        integrand_val = g_prime * psi_e * detJ * weight\n        residual_vec += N * integrand_val\n\n    return residual_vec\n\ndef solve():\n    \"\"\"\n    Main solver function to run all test cases and print the results.\n    \"\"\"\n    E = 2.10e11\n    nu = 0.30\n    kappa = 1.0e-6\n\n    alpha = 1.0e-4\n    beta = 2.0e-4\n\n    test_cases = [\n        # Case 1\n        (\n            [(0.0, 0.0), (1.0, 0.0), (1.0, 1.0), (0.0, 1.0)],\n            [(0.0, 0.0), (alpha, 0.0), (alpha, 0.0), (0.0, 0.0)],\n            [0.20, 0.20, 0.20, 0.20]\n        ),\n        # Case 2\n        (\n            [(0.0, 0.0), (1.0, 0.0), (1.0, 1.0), (0.0, 1.0)],\n            [(0.0, 0.0), (0.0, 0.0), (0.0, 0.0), (0.0, 0.0)],\n            [0.50, 0.50, 0.50, 0.50]\n        ),\n        # Case 3\n        (\n            [(0.0, 0.0), (1.5, 0.2), (1.4, 1.3), (-0.1, 0.9)],\n            [(0.0, 0.0), (0.0, beta * 1.5), (0.0, beta * 1.4), (0.0, beta * -0.1)],\n            [0.10, 0.40, 0.70, 0.20]\n        ),\n        # Case 4\n        (\n            [(0.0, 0.0), (1.0, 0.0), (1.0, 1.0), (0.0, 1.0)],\n            [(0.0, 0.0), (alpha, 0.0), (alpha, 0.0), (0.0, 0.0)],\n            [0.99, 0.99, 0.99, 0.99]\n        )\n    ]\n\n    results = []\n    for case_data in test_cases:\n        coords, displacements, phis = case_data\n        result_vector = calculate_residual_vector(coords, displacements, phis, E, nu, kappa)\n        results.append(result_vector)\n\n    # Format output as a list of lists of floats, without spaces.\n    list_of_strings = []\n    for vec in results:\n        inner_str = f\"[{','.join(f'{x:.8e}' for x in vec)}]\"\n        list_of_strings.append(inner_str)\n    \n    print(f\"[{','.join(list_of_strings)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "For robust implicit solvers, we must understand not only the driving forces (residuals) but also how these forces change as the solution evolves. This practice moves beyond the residual to the system Jacobian, which is essential for Newton-type solvers. You will derive and compute a key off-diagonal block of the Jacobian, quantifying the sensitivity of the mechanical equilibrium to changes in the phase field and revealing the structure of the two-way coupling at the tangent level .",
            "id": "3746990",
            "problem": "Consider a one-dimensional small-strain hyperelastic bar occupying a domain of length $L$ and cross-sectional area $A$. Let the displacement field be $u(x)$ with small strain defined by $\\epsilon(x) = \\partial u / \\partial x$. Introduce a scalar phase field $ \\phi(x) \\in [0,1] $ modeling stiffness degradation through a dimensionless degradation function $g(\\phi)$ and a small regularization parameter $\\kappa > 0$. Assume the elastic energy density is given by $W(\\phi,\\epsilon) = g(\\phi)\\,\\frac{1}{2}\\,\\epsilon\\,\\mathbb{C}\\,\\epsilon$, where $\\mathbb{C}$ denotes the fourth-order elasticity tensor. In one dimension, choose isotropic elasticity so that $\\mathbb{C}$ reduces to the Young's modulus $E$, and define $g(\\phi)$ by $g(\\phi) = (1-\\phi)^2 + \\kappa$. The Cauchy stress $\\sigma$ is defined from hyperelasticity by $\\sigma = \\partial W / \\partial \\epsilon$. Using the Finite Element Method (FEM) with a single two-node linear element, let the shape functions be $N_1(x) = 1 - x/L$ and $N_2(x) = x/L$, and the corresponding strain-displacement matrix entries be $B_1 = \\partial N_1/\\partial x = -1/L$ and $B_2 = \\partial N_2/\\partial x = +1/L$. Assume the current state is such that the phase field $\\phi$ and the strain $\\epsilon$ are uniform over the element.\n\nUsing the above definitions and starting from the principle of virtual work for mechanical equilibrium with traction-free boundary conditions, derive from first principles the expression for the derivative $\\partial_{\\phi} \\sigma$ and then the contribution to the mixed displacement–phase Jacobian block entry $K_{u\\phi}^{(i,j)}$ corresponding to the test function associated with the displacement degree of freedom at node $i \\in \\{1,2\\}$ and the trial function associated with the phase degree of freedom at node $j \\in \\{1,2\\}$. The contribution should be expressed as a domain integral involving $B_i$, $N_j$, $\\partial_{\\phi}\\sigma$, $A$, and appropriate constants under the stated assumptions.\n\nYour task is to implement a program that computes, for each provided test case, the scalar value of the single-element mixed Jacobian block entry $K_{u\\phi}^{(i,j)}$ under the assumption of uniform $\\phi$ and uniform $\\epsilon$. Use $g(\\phi) = (1-\\phi)^2 + \\kappa$ and treat $E$, $\\phi$, $\\epsilon$, $A$, $L$, $i$, $j$, and $\\kappa$ as given inputs per test case. All outputs must be expressed in Newtons (N), rounded to three decimal places. The program must aggregate the results for all test cases into one line of output formatted as a comma-separated Python-style list enclosed in square brackets.\n\nTest suite:\n1. $E = 30 \\times 10^9$ Pa, $\\phi = 0.25$, $\\epsilon = 1.0 \\times 10^{-3}$, $A = 1.0$ m$^2$, $L = 1.0$ m, $i = 1$, $j = 2$, $\\kappa = 1.0 \\times 10^{-6}$.\n2. $E = 70 \\times 10^9$ Pa, $\\phi = 1.0$, $\\epsilon = 5.0 \\times 10^{-4}$, $A = 0.5$ m$^2$, $L = 2.0$ m, $i = 2$, $j = 1$, $\\kappa = 1.0 \\times 10^{-6}$.\n3. $E = 50 \\times 10^9$ Pa, $\\phi = 0.6$, $\\epsilon = 0.0$, $A = 2.0$ m$^2$, $L = 3.0$ m, $i = 1$, $j = 1$, $\\kappa = 1.0 \\times 10^{-6}$.\n4. $E = 200 \\times 10^9$ Pa, $\\phi = 0.0$, $\\epsilon = 2.0 \\times 10^{-3}$, $A = 3.0$ m$^2$, $L = 0.5$ m, $i = 2$, $j = 2$, $\\kappa = 1.0 \\times 10^{-6}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"), where each result is a float in Newtons rounded to three decimal places.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of continuum mechanics, phase-field modeling, and the Finite Element Method. All parameters, functions, and assumptions are clearly defined, constituting a self-contained and well-posed problem. There are no contradictions, ambiguities, or factual inaccuracies. We may therefore proceed with a formal derivation and solution.\n\nThe objective is to derive the expression for the mixed Jacobian block entry $K_{u\\phi}^{(i,j)}$ for a single two-node linear element. This term represents the sensitivity of the mechanical residual at node $i$ to a change in the phase-field degree of freedom at node $j$.\n\nThe derivation begins with the principle of virtual work (PVW), which provides the weak form of the mechanical equilibrium equations. In the absence of body forces and with traction-free boundaries, the PVW states that the internal virtual work is zero for any kinematically admissible virtual displacement field $\\delta u(x)$:\n$$\n\\mathcal{R}_u = \\int_0^L \\sigma(x) \\delta\\epsilon(x) A \\, dx = 0\n$$\nHere, $\\sigma(x)$ is the Cauchy stress, $\\delta\\epsilon(x) = \\partial(\\delta u)/\\partial x$ is the virtual strain, $A$ is the cross-sectional area, and the integration is over the element length $L$.\n\nUsing the Finite Element Method, we discretize the displacement field $u(x)$ and the phase field $\\phi(x)$ using shape functions $N_k(x)$ and nodal degrees of freedom $u_k$ and $\\phi_k$:\n$$\nu(x) = \\sum_{k=1}^2 N_k(x) u_k \\quad \\text{and} \\quad \\phi(x) = \\sum_{k=1}^2 N_k(x) \\phi_k\n$$\nThe strain field $\\epsilon(x)$ is then given by:\n$$\n\\epsilon(x) = \\frac{\\partial u}{\\partial x} = \\sum_{k=1}^2 \\frac{\\partial N_k}{\\partial x} u_k = \\sum_{k=1}^2 B_k(x) u_k\n$$\nThe virtual displacement and strain fields are similarly discretized for a virtual displacement $\\delta u_i$ at a single node $i$:\n$$\n\\delta u(x) = N_i(x) \\delta u_i \\quad \\implies \\quad \\delta\\epsilon(x) = \\frac{\\partial N_i}{\\partial x} \\delta u_i = B_i(x) \\delta u_i\n$$\nSubstituting the virtual strain into the PVW, we obtain the $i$-th component of the mechanical residual vector, $R_{u,i}$:\n$$\nR_{u,i} = \\frac{\\partial \\mathcal{R}_u}{\\partial (\\delta u_i)} = \\int_0^L \\sigma(x) B_i(x) A \\, dx\n$$\nThe system is at equilibrium when $R_{u,i} = 0$ for all $i$.\n\nThe mixed Jacobian block entry $K_{u\\phi}^{(i,j)}$ is defined as the partial derivative of the $i$-th mechanical residual component with respect to the $j$-th phase-field nodal degree of freedom, $\\phi_j$:\n$$\nK_{u\\phi}^{(i,j)} = \\frac{\\partial R_{u,i}}{\\partial \\phi_j} = \\frac{\\partial}{\\partial \\phi_j} \\left( \\int_0^L \\sigma(\\phi(x), \\epsilon(x)) B_i(x) A \\, dx \\right)\n$$\nAssuming sufficient regularity, we can move the derivative inside the integral:\n$$\nK_{u\\phi}^{(i,j)} = \\int_0^L \\frac{\\partial \\sigma}{\\partial \\phi_j} B_i(x) A \\, dx\n$$\nUsing the chain rule, we express the derivative of stress $\\sigma$ with respect to the nodal variable $\\phi_j$ as:\n$$\n\\frac{\\partial \\sigma}{\\partial \\phi_j} = \\frac{\\partial \\sigma}{\\partial \\phi} \\frac{\\partial \\phi(x)}{\\partial \\phi_j}\n$$\nFrom the discretization $\\phi(x) = \\sum_{k=1}^2 N_k(x) \\phi_k$, we find that $\\frac{\\partial \\phi(x)}{\\partial \\phi_j} = N_j(x)$. Substituting this into the Jacobian expression yields:\n$$\nK_{u\\phi}^{(i,j)} = \\int_0^L \\frac{\\partial \\sigma}{\\partial \\phi} N_j(x) B_i(x) A \\, dx\n$$\nThis is the general integral form for the Jacobian contribution.\n\nNext, we derive the term $\\frac{\\partial \\sigma}{\\partial \\phi}$. The elastic energy density $W$ and Cauchy stress $\\sigma$ are given by:\n$$\nW(\\phi, \\epsilon) = g(\\phi) \\frac{1}{2} E \\epsilon^2 = \\left( (1-\\phi)^2 + \\kappa \\right) \\frac{1}{2} E \\epsilon^2\n$$\n$$\n\\sigma = \\frac{\\partial W}{\\partial \\epsilon} = g(\\phi) E \\epsilon = \\left( (1-\\phi)^2 + \\kappa \\right) E \\epsilon\n$$\nWe take the partial derivative of $\\sigma$ with respect to $\\phi$, treating $\\epsilon$ as an independent variable (since $u$ and $\\phi$ are independent fields in the coupled problem):\n$$\n\\frac{\\partial \\sigma}{\\partial \\phi} = \\frac{\\partial}{\\partial \\phi} \\left[ \\left( (1-\\phi)^2 + \\kappa \\right) E \\epsilon \\right] = E \\epsilon \\left[ \\frac{\\partial}{\\partial \\phi} ((1-\\phi)^2 + \\kappa) \\right]\n$$\n$$\n\\frac{\\partial \\sigma}{\\partial \\phi} = E \\epsilon \\left[ 2(1-\\phi)(-1) + 0 \\right] = -2(1-\\phi)E\\epsilon\n$$\nNow, we substitute this derivative back into the integral for $K_{u\\phi}^{(i,j)}$:\n$$\nK_{u\\phi}^{(i,j)} = \\int_0^L \\left[ -2(1-\\phi(x))E\\epsilon(x) \\right] N_j(x) B_i(x) A \\, dx\n$$\nThe problem states the critical assumption that the phase field $\\phi$ and strain $\\epsilon$ are uniform over the element. Thus, $\\phi(x) = \\phi$ and $\\epsilon(x) = \\epsilon$ are constants with respect to the integration variable $x$. We can therefore move all constant terms outside the integral:\n$$\nK_{u\\phi}^{(i,j)} = -2(1-\\phi)E\\epsilon B_i A \\int_0^L N_j(x) \\, dx\n$$\nThe strain-displacement matrix entries $B_i$ are also constant for a linear element: $B_1 = -1/L$ and $B_2 = 1/L$.\n\nThe remaining task is to evaluate the integral of the shape functions over the element length $L$.\nFor node $j=1$, $N_1(x) = 1 - x/L$:\n$$\n\\int_0^L N_1(x) \\, dx = \\int_0^L \\left(1 - \\frac{x}{L}\\right) \\, dx = \\left[x - \\frac{x^2}{2L}\\right]_0^L = L - \\frac{L^2}{2L} = \\frac{L}{2}\n$$\nFor node $j=2$, $N_2(x) = x/L$:\n$$\n\\int_0^L N_2(x) \\, dx = \\int_0^L \\frac{x}{L} \\, dx = \\left[\\frac{x^2}{2L}\\right]_0^L = \\frac{L^2}{2L} = \\frac{L}{2}\n$$\nThe integral evaluates to $L/2$ regardless of the value of $j$. This implies that the resulting expression for $K_{u\\phi}^{(i,j)}$ will be independent of the index $j$.\n\nSubstituting the integral result back into the expression for $K_{u\\phi}^{(i,j)}$:\n$$\nK_{u\\phi}^{(i,j)} = -2(1-\\phi)E\\epsilon B_i A \\left(\\frac{L}{2}\\right) = -(1-\\phi)E\\epsilon A L B_i\n$$\nNow, we substitute the specific values for $B_i$:\nFor $i=1$:\n$$\nK_{u\\phi}^{(1,j)} = -(1-\\phi)E\\epsilon A L \\left(-\\frac{1}{L}\\right) = (1-\\phi)E\\epsilon A\n$$\nFor $i=2$:\n$$\nK_{u\\phi}^{(2,j)} = -(1-\\phi)E\\epsilon A L \\left(+\\frac{1}{L}\\right) = -(1-\\phi)E\\epsilon A\n$$\nThe final formula is independent of the element length $L$, the phase-field node index $j$, and the regularization parameter $\\kappa$. This is a direct consequence of the 1D linear element formulation and the specific form of the degradation function.\n\nThe final formula for computation is:\n$$\nK_{u\\phi}^{(i,j)} = \\begin{cases} (1-\\phi) E \\epsilon A & \\text{if } i=1 \\\\ -(1-\\phi) E \\epsilon A & \\text{if } i=2 \\end{cases}\n$$\nThe units are $(\\text{dimensionless}) \\times (\\text{N}/\\text{m}^2) \\times (\\text{dimensionless}) \\times (\\text{m}^2) = \\text{N}$, as required.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the mixed displacement-phase Jacobian block entry K_uφ^(i,j)\n    for a single two-node linear finite element based on a phase-field model.\n    \"\"\"\n\n    test_cases = [\n        # (E, phi, epsilon, A, L, i, j, kappa)\n        (30e9, 0.25, 1.0e-3, 1.0, 1.0, 1, 2, 1.0e-6),\n        (70e9, 1.0, 5.0e-4, 0.5, 2.0, 2, 1, 1.0e-6),\n        (50e9, 0.6, 0.0, 2.0, 3.0, 1, 1, 1.0e-6),\n        (200e9, 0.0, 2.0e-3, 3.0, 0.5, 2, 2, 1.0e-6),\n    ]\n\n    results = []\n    for case in test_cases:\n        E, phi, epsilon, A, L, i, j, kappa = case\n\n        # The derived formula for the mixed Jacobian block entry is:\n        # K_uφ^(i,j) = (1-phi) * E * epsilon * A   for i = 1\n        # K_uφ^(i,j) = -(1-phi) * E * epsilon * A  for i = 2\n        # The result is independent of j, L, and kappa under the given assumptions.\n\n        common_term = (1 - phi) * E * epsilon * A\n\n        if i == 1:\n            result = common_term\n        elif i == 2:\n            result = -common_term\n        else:\n            # This case should not occur based on the problem statement (i ∈ {1,2})\n            raise ValueError(f\"Invalid node index i: {i}\")\n\n        results.append(result)\n\n    # Format the results to three decimal places as strings\n    formatted_results = [f\"{r:.3f}\" for r in results]\n\n    # Print the final output in the required single-line format\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Effective modeling requires moving beyond numerical mechanics to critically assess how modeling choices impact physical predictions. This exercise uses a simplified analytical model to investigate a crucial issue in fracture simulation: the influence of boundary conditions on phase-field evolution and predicted crack initiation. By analytically solving for the phase-field profile under different constraints, we gain insight into how unphysical boundary artifacts can arise and develop strategies to ensure our simulations are physically meaningful .",
            "id": "3746965",
            "problem": "Consider a one-dimensional elastic bar of length $L$ subjected to small-strain uniaxial tension. Let $x \\in [0,L]$ denote the spatial coordinate, and let the displacement field be $u(x)$ with prescribed boundary displacements $u(0) = 0$ and $u(L) = \\varepsilon_{0} L$ so that the strain is $\\varepsilon(x) = \\varepsilon_{0}$ for all $x \\in [0, L]$. The bar is characterized by a Young's modulus $E$ (in $\\mathrm{Pa}$). Fracture is modeled by a phase-field $\\phi(x) \\in [0,1]$ with internal length scale $l$ (in $\\mathrm{m}$) and fracture toughness $G_{c}$ (in $\\mathrm{N}/\\mathrm{m}$). We consider the standard tension-compression split where the tensile elastic energy density is $\\psi_{+} = \\frac{1}{2} E \\varepsilon_{0}^{2}$ and is coupled to the phase-field fracture energy functional.\n\nAssume a quasi-static, small-damage, linearized regime where the stiffness degradation function can be approximated to first order as $g(\\phi) \\approx 1$. Starting from the principle of minimum potential energy and the Euler-Lagrange equations, the linearized phase-field stationarity condition in one dimension reduces to the following forced diffusion-reaction ordinary differential equation:\n$$\nG_{c} l \\phi''(x) - \\frac{G_{c}}{l} \\phi(x) = -2 \\psi_{+} \\quad \\text{for } x \\in (0,L),\n$$\nwhere $\\psi_{+} = \\frac{1}{2} E \\varepsilon_{0}^{2}$. This expression is valid in the early stage of damage where $\\phi \\ll 1$ and the irreversibility constraint has not yet led to a nonlinearity that invalidates linearization. Consider three types of boundary conditions for the phase-field $\\phi$ at $x=0$ and $x=L$:\n\n- Dirichlet boundary condition (essential condition): $\\phi(0) = 0$ and $\\phi(L) = 0$.\n- Neumann boundary condition (natural condition): $\\phi'(0) = 0$ and $\\phi'(L) = 0$.\n- Robin boundary condition (mixed condition): $l \\phi'(0) + \\beta \\phi(0) = 0$ and $l \\phi'(L) + \\beta \\phi(L) = 0$, where $\\beta$ is a dimensionless parameter.\n\nLet the particular solution of the inhomogeneous equation be denoted by $\\phi_{p}$, where $\\phi_{p}$ is constant across the bar. Define the artifact sensitivity metric as the ratio of the phase-field at the bar center to the bulk particular solution:\n$$\nr = \\frac{\\phi\\left(\\frac{L}{2}\\right)}{\\phi_{p}},\n$$\nwhich quantifies the suppression or amplification of damage at the center due to boundary conditions relative to the bulk value. In the linearized regime, the particular solution is $\\phi_{p} = \\dfrac{2 \\psi_{+} l}{G_{c}} = \\dfrac{E \\varepsilon_{0}^{2} l}{G_{c}}$.\n\nDefine a practical crack initiation threshold as the smallest strain $\\varepsilon_{\\mathrm{init}}$ at which the center phase-field reaches a prescribed threshold $\\phi_{\\mathrm{th}} \\in (0,1)$:\n$$\n\\phi\\left(\\frac{L}{2}\\right) = \\phi_{\\mathrm{th}}.\n$$\nUnder the linearized relation $\\phi\\left(\\frac{L}{2}\\right) = r \\phi_{p} = r \\dfrac{E \\varepsilon_{0}^{2} l}{G_{c}}$, this yields the initiation strain\n$$\n\\varepsilon_{\\mathrm{init}} = \\sqrt{ \\frac{ \\phi_{\\mathrm{th}} G_{c} }{ E l r } }.\n$$\nThe corresponding initiation stress is $\\sigma_{\\mathrm{init}} = E \\varepsilon_{\\mathrm{init}}$ and should be expressed in $\\mathrm{Pa}$.\n\nYour tasks:\n1. Derive, from first principles (variational formulation of the coupled phase-field fracture with linearized mechanics), the above ordinary differential equation for $\\phi(x)$, the form of the particular solution $\\phi_{p}$, and the expressions for $r$, $\\varepsilon_{\\mathrm{init}}$, and $\\sigma_{\\mathrm{init}}$ for each boundary condition type.\n2. Implement a program that, for each test case below, computes $r$, $\\varepsilon_{\\mathrm{init}}$, and $\\sigma_{\\mathrm{init}}$ using the exact solution of the linear ordinary differential equation and boundary conditions. The solution must be computed analytically, not numerically discretized, to isolate and quantify boundary-condition-induced artifacts in the early-damage regime.\n\nPhysical units and output requirements:\n- $E$ is in $\\mathrm{Pa}$.\n- $G_{c}$ is in $\\mathrm{N}/\\mathrm{m}$.\n- $l$ and $L$ are in $\\mathrm{m}$.\n- $\\varepsilon_{\\mathrm{init}}$ is dimensionless.\n- $\\sigma_{\\mathrm{init}}$ must be reported in $\\mathrm{Pa}$.\n\nTest suite:\n- Case 1 (happy path, Dirichlet with moderate internal length): $\\text{BC} = \\text{D}$, $L = 0.1\\, \\mathrm{m}$, $l = 0.01\\, \\mathrm{m}$, $E = 70 \\times 10^{9}\\, \\mathrm{Pa}$, $G_{c} = 2.7 \\times 10^{3}\\, \\mathrm{N}/\\mathrm{m}$, $\\phi_{\\mathrm{th}} = 0.01$.\n- Case 2 (Neumann boundary condition baseline): $\\text{BC} = \\text{N}$, $L = 0.1\\, \\mathrm{m}$, $l = 0.01\\, \\mathrm{m}$, $E = 70 \\times 10^{9}\\, \\mathrm{Pa}$, $G_{c} = 2.7 \\times 10^{3}\\, \\mathrm{N}/\\mathrm{m}$, $\\phi_{\\mathrm{th}} = 0.01$.\n- Case 3 (Dirichlet, small internal length minimizing boundary layer): $\\text{BC} = \\text{D}$, $L = 0.1\\, \\mathrm{m}$, $l = 0.001\\, \\mathrm{m}$, $E = 70 \\times 10^{9}\\, \\mathrm{Pa}$, $G_{c} = 2.7 \\times 10^{3}\\, \\mathrm{N}/\\mathrm{m}$, $\\phi_{\\mathrm{th}} = 0.01$.\n- Case 4 (Dirichlet, large internal length accentuating boundary effects): $\\text{BC} = \\text{D}$, $L = 0.1\\, \\mathrm{m}$, $l = 0.05\\, \\mathrm{m}$, $E = 70 \\times 10^{9}\\, \\mathrm{Pa}$, $G_{c} = 2.7 \\times 10^{3}\\, \\mathrm{N}/\\mathrm{m}$, $\\phi_{\\mathrm{th}} = 0.01$.\n- Case 5 (Robin boundary condition, mixed constraint): $\\text{BC} = \\text{R}$ with $\\beta = 0.5$, $L = 0.1\\, \\mathrm{m}$, $l = 0.01\\, \\mathrm{m}$, $E = 70 \\times 10^{9}\\, \\mathrm{Pa}$, $G_{c} = 2.7 \\times 10^{3}\\, \\mathrm{N}/\\mathrm{m}$, $\\phi_{\\mathrm{th}} = 0.01$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists, each inner list being $[r, \\varepsilon_{\\mathrm{init}}, \\sigma_{\\mathrm{init}}]$ for the corresponding test case, enclosed in square brackets, for example: $[[r_{1}, \\varepsilon_{\\mathrm{init},1}, \\sigma_{\\mathrm{init},1}], [r_{2}, \\varepsilon_{\\mathrm{init},2}, \\sigma_{\\mathrm{init},2}], \\ldots]$.",
            "solution": "We begin with the standard phase-field formulation for brittle fracture in a one-dimensional elastic body. The total potential energy functional in a tension-compression split with a small-damage linearization can be written as\n$$\n\\Pi[u,\\phi] \\;=\\; \\int_{0}^{L} \\left( g(\\phi)\\, \\psi_{+}(u) + G_{c} \\left[ \\frac{ \\phi^{2} }{ 2\\, l } + \\frac{ l }{ 2 } \\left( \\phi'(x) \\right)^{2} \\right] \\right)\\, \\mathrm{d}x,\n$$\nwhere $g(\\phi)$ is the degradation function and $ \\psi_{+}(u) $ is the tensile elastic energy density. For small strains in one dimension,\n$$\n\\varepsilon(x) = \\varepsilon_{0}, \\quad \\psi_{+}(u) = \\frac{1}{2}\\, E\\, \\varepsilon_{0}^{2}.\n$$\nAt the onset of damage when $ \\phi \\ll 1 $, we linearize $ g(\\phi) \\approx 1 $ so that the elastic field $u$ remains homogeneous and decoupled, while the fracture phase-field $ \\phi $ satisfies the Euler-Lagrange equation obtained from stationarity of $ \\Pi $ with respect to variations in $ \\phi $:\n$$\n\\delta \\Pi = 0 \\;\\;\\Rightarrow\\;\\; G_{c}\\, l\\, \\phi''(x) - \\frac{ G_{c} }{ l }\\, \\phi(x) = -\\, \\frac{ \\partial \\left( g(\\phi)\\,\\psi_{+} \\right) }{ \\partial \\phi } \\bigg|_{\\phi \\approx 0}.\n$$\nFor the common quadratic degradation $ g(\\phi) = (1 - \\phi)^{2} $ in standard formulations, $ \\partial (g\\,\\psi_{+}) / \\partial \\phi \\big|_{\\phi=0} = - 2\\, \\psi_{+} $; this yields the forced diffusion-reaction equation\n$$\nG_{c}\\, l\\, \\phi''(x) - \\frac{ G_{c} }{ l }\\, \\phi(x) = -\\, 2\\, \\psi_{+}, \\qquad \\psi_{+} = \\frac{1}{2} E \\varepsilon_{0}^{2}.\n$$\nThis is a linear ordinary differential equation with constant coefficients and a constant forcing term. Dividing by $ G_{c} $,\n$$\nl\\, \\phi''(x) - \\frac{ 1 }{ l }\\, \\phi(x) = -\\, \\frac{ 2\\, \\psi_{+} }{ G_{c} }.\n$$\nThe general solution is the sum of the homogeneous solution and a constant particular solution. The homogeneous solution solves\n$$\nl\\, \\phi_{h}''(x) - \\frac{ 1 }{ l }\\, \\phi_{h}(x) = 0 \\;\\;\\Rightarrow\\;\\; \\phi_{h}(x) = A\\, \\cosh\\!\\left( \\frac{x}{l} \\right) + B\\, \\sinh\\!\\left( \\frac{x}{l} \\right),\n$$\nwhere $A$ and $B$ are constants determined by boundary conditions. A constant particular solution $ \\phi_{p} $ satisfies\n$$\n- \\frac{ 1 }{ l }\\, \\phi_{p} = -\\, \\frac{ 2\\, \\psi_{+} }{ G_{c} } \\;\\;\\Rightarrow\\;\\; \\phi_{p} = \\frac{ 2\\, \\psi_{+}\\, l }{ G_{c} } = \\frac{ E\\, \\varepsilon_{0}^{2}\\, l }{ G_{c} }.\n$$\nThus the full solution is\n$$\n\\phi(x) = A\\, \\cosh\\!\\left( \\frac{x}{l} \\right) + B\\, \\sinh\\!\\left( \\frac{x}{l} \\right) + \\phi_{p}.\n$$\n\nWe now enforce boundary conditions to determine $A$ and $B$ for three cases:\n\n1. Dirichlet boundary condition: $ \\phi(0) = 0 $ and $ \\phi(L) = 0 $. Evaluating at $ x=0 $ gives\n$$\n\\phi(0) = A + \\phi_{p} = 0 \\;\\;\\Rightarrow\\;\\; A = -\\, \\phi_{p}.\n$$\nAt $ x = L $ with $ s = \\frac{L}{l} $,\n$$\n\\phi(L) = A\\, \\cosh(s) + B\\, \\sinh(s) + \\phi_{p} = 0 \\;\\;\\Rightarrow\\;\\; -\\, \\phi_{p}\\, \\cosh(s) + B\\, \\sinh(s) + \\phi_{p} = 0,\n$$\nwhich yields\n$$\nB = \\phi_{p}\\, \\frac{ \\cosh(s) - 1 }{ \\sinh(s) }.\n$$\nThe ratio at the center $ x = \\frac{L}{2} $ with $ m = \\frac{ L }{ 2\\, l } $ is\n$$\nr_{\\mathrm{D}} = \\frac{ \\phi\\!\\left( \\frac{L}{2} \\right) }{ \\phi_{p} } = -\\, \\cosh(m) + \\frac{ \\cosh(s) - 1 }{ \\sinh(s) }\\, \\sinh(m) + 1.\n$$\n\n2. Neumann boundary condition: $ \\phi'(0) = 0 $ and $ \\phi'(L) = 0 $. The derivative is\n$$\n\\phi'(x) = \\frac{1}{l} \\left( A\\, \\sinh\\!\\left( \\frac{x}{l} \\right) + B\\, \\cosh\\!\\left( \\frac{x}{l} \\right) \\right).\n$$\nAt $ x=0 $,\n$$\n\\phi'(0) = \\frac{ B }{ l } = 0 \\;\\;\\Rightarrow\\;\\; B = 0.\n$$\nAt $ x=L $,\n$$\n\\phi'(L) = \\frac{1}{l} \\left( A\\, \\sinh(s) + B\\, \\cosh(s) \\right) = \\frac{ A }{ l }\\, \\sinh(s) = 0 \\;\\;\\Rightarrow\\;\\; A = 0.\n$$\nTherefore $ \\phi(x) = \\phi_{p} $ is constant and\n$$\nr_{\\mathrm{N}} = \\frac{ \\phi\\!\\left( \\frac{L}{2} \\right) }{ \\phi_{p} } = 1.\n$$\n\n3. Robin boundary condition: $ l\\, \\phi'(0) + \\beta\\, \\phi(0) = 0 $ and $ l\\, \\phi'(L) + \\beta\\, \\phi(L) = 0 $, with $ \\beta $ dimensionless. In terms of $A$ and $B$,\n$$\nl\\, \\phi'(0) + \\beta\\, \\phi(0) = B + \\beta\\,(A + \\phi_{p}) = 0,\n$$\n$$\nl\\, \\phi'(L) + \\beta\\, \\phi(L) = A\\, \\sinh(s) + B\\, \\cosh(s) + \\beta \\left( A\\, \\cosh(s) + B\\, \\sinh(s) + \\phi_{p} \\right) = 0.\n$$\nIt is convenient to non-dimensionalize by $ \\phi_{p} $ and solve for $ a = \\frac{A}{\\phi_{p}} $ and $ b = \\frac{B}{\\phi_{p}} $. The linear system becomes\n$$\n\\begin{aligned}\n\\beta\\, a + b &= -\\, \\beta, \\\\\n\\left( \\sinh(s) + \\beta\\, \\cosh(s) \\right)\\, a + \\left( \\cosh(s) + \\beta\\, \\sinh(s) \\right)\\, b &= -\\, \\beta.\n\\end{aligned}\n$$\nSolving this $ 2 \\times 2 $ system yields $ a $ and $ b $ for given $ s $ and $ \\beta $. The ratio at the center is\n$$\nr_{\\mathrm{R}} = a\\, \\cosh(m) + b\\, \\sinh(m) + 1.\n$$\n\nWith the ratio $ r $ computed for each boundary condition, the practical initiation strain and stress are obtained by requiring $ r\\, \\phi_{p} = \\phi_{\\mathrm{th}} $:\n$$\n\\varepsilon_{\\mathrm{init}} = \\sqrt{ \\frac{ \\phi_{\\mathrm{th}}\\, G_{c} }{ E\\, l\\, r } }, \\qquad \\sigma_{\\mathrm{init}} = E\\, \\varepsilon_{\\mathrm{init}}.\n$$\n\nAlgorithmic design:\n- Inputs: $ L $, $ l $, $ E $, $ G_{c} $, $ \\phi_{\\mathrm{th}} $, boundary condition type, and $ \\beta $ for Robin.\n- Compute $ s = \\frac{ L }{ l } $ and $ m = \\frac{ L }{ 2\\, l } $.\n- For Dirichlet: use $ r_{\\mathrm{D}} $ formula in terms of hyperbolic functions $ \\sinh(\\cdot) $ and $ \\cosh(\\cdot) $.\n- For Neumann: set $ r_{\\mathrm{N}} = 1 $.\n- For Robin: assemble and solve the $ 2 \\times 2 $ linear system for $ a $ and $ b $, then evaluate $ r_{\\mathrm{R}} $.\n- Compute $ \\varepsilon_{\\mathrm{init}} $ and $ \\sigma_{\\mathrm{init}} $ using the above formulae.\n- Return the triple $ [r, \\varepsilon_{\\mathrm{init}}, \\sigma_{\\mathrm{init}}] $ for each test case.\n\nPhysical interpretation and mitigation strategies:\n- Dirichlet boundary conditions suppress $ \\phi $ at the boundaries, creating boundary layers that can artificially delay the attainment of a finite damage threshold at the center for large $ l/L $, reflected by $ r < 1 $. This may lead to boundary-induced artifacts in damage initiation.\n- Neumann boundary conditions yield a uniform $ \\phi $ equal to the particular solution, i.e., $ r = 1 $, minimizing boundary artifacts for early damage onset.\n- Robin boundary conditions interpolate between Dirichlet and Neumann and can be tuned via $ \\beta $ to reduce boundary suppression while maintaining control over $ \\phi $ near the boundary.\n\nTo mitigate boundary artifacts in coupled phase-field mechanics simulations:\n- Prefer natural (Neumann) boundary conditions for $ \\phi $ on external boundaries where no physical constraint on damage should be imposed.\n- Use mixed (Robin) boundary conditions with calibrated $ \\beta $ to approximate traction-free conditions for $ \\phi $ if Dirichlet is unavoidable due to numerical constraints.\n- Employ domain padding or periodic boundary conditions to move artificial boundaries away from regions of interest.\n- Choose the internal length $ l $ consistent with material microstructure and mesh resolution to confine boundary layers relative to $ L $.\n- Consider phase-field variants with an elastic threshold (e.g., the so-called AT1 model with linear crack density) to avoid immediate nucleation in homogeneous tension when appropriate for the material.\n\nFor the provided test suite, the program evaluates $ r $, $ \\varepsilon_{\\mathrm{init}} $ (dimensionless), and $ \\sigma_{\\mathrm{init}} $ in $ \\mathrm{Pa} $, and prints them as a single list of lists on one line.",
            "answer": "```python\nimport numpy as np\n\ndef center_ratio(bc_type, L, l, beta=None):\n    \"\"\"\n    Compute r = phi(L/2)/phi_p for the linearized 1D phase-field ODE\n    under specified boundary conditions.\n    \"\"\"\n    s = L / l\n    m = L / (2.0 * l)\n    if bc_type == 'D':\n        # Dirichlet: phi(0)=0, phi(L)=0 implies A = -phi_p and\n        # B = phi_p * (cosh(s) - 1) / sinh(s)\n        cosh_s = np.cosh(s)\n        sinh_s = np.sinh(s)\n        cosh_m = np.cosh(m)\n        sinh_m = np.sinh(m)\n        r = -cosh_m + ((cosh_s - 1.0) / sinh_s) * sinh_m + 1.0\n        return r\n    elif bc_type == 'N':\n        # Neumann: phi'(0)=phi'(L)=0 => A=B=0, phi(x)=phi_p\n        return 1.0\n    elif bc_type == 'R':\n        if beta is None:\n            raise ValueError(\"Robin BC requires beta.\")\n        # Solve 2x2 system for a=A/phi_p and b=B/phi_p:\n        # Eq1: beta*a + b = -beta\n        # Eq2: (sinh(s)+beta*cosh(s))*a + (cosh(s)+beta*sinh(s))*b = -beta\n        sinh_s = np.sinh(s)\n        cosh_s = np.cosh(s)\n        M = np.array([[beta, 1.0],\n                      [sinh_s + beta * cosh_s, cosh_s + beta * sinh_s]], dtype=float)\n        rhs = np.array([-beta, -beta], dtype=float)\n        # Solve the linear system\n        a, b = np.linalg.solve(M, rhs)\n        cosh_m = np.cosh(m)\n        sinh_m = np.sinh(m)\n        r = a * cosh_m + b * sinh_m + 1.0\n        return r\n    else:\n        raise ValueError(\"Unknown boundary condition type.\")\n\ndef initiation_metrics(E, Gc, l, r, phi_th):\n    \"\"\"\n    Compute epsilon_init (dimensionless) and sigma_init (Pa)\n    from threshold condition r * phi_p = phi_th,\n    where phi_p = (E * epsilon^2 * l) / Gc.\n    \"\"\"\n    # epsilon_init = sqrt(phi_th * Gc / (E * l * r))\n    eps_init = np.sqrt(phi_th * Gc / (E * l * r))\n    sigma_init = E * eps_init\n    return eps_init, sigma_init\n\ndef solve():\n    # Define the test cases: (bc_type, L [m], l [m], E [Pa], Gc [N/m], phi_th [-], beta or None)\n    test_cases = [\n        ('D', 0.1, 0.01, 70e9, 2.7e3, 0.01, None),\n        ('N', 0.1, 0.01, 70e9, 2.7e3, 0.01, None),\n        ('D', 0.1, 0.001, 70e9, 2.7e3, 0.01, None),\n        ('D', 0.1, 0.05, 70e9, 2.7e3, 0.01, None),\n        ('R', 0.1, 0.01, 70e9, 2.7e3, 0.01, 0.5),\n    ]\n\n    results = []\n    for case in test_cases:\n        bc_type, L, l, E, Gc, phi_th, beta = case\n        r = center_ratio(bc_type, L, l, beta)\n        eps_init, sigma_init = initiation_metrics(E, Gc, l, r, phi_th)\n        results.append([float(r), float(eps_init), float(sigma_init)])\n\n    # Final print statement in the exact required format.\n    print(f\"{results}\")\n\nsolve()\n```"
        }
    ]
}