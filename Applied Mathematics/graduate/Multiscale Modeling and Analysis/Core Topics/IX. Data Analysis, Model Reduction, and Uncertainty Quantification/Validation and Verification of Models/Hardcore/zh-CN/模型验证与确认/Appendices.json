{
    "hands_on_practices": [
        {
            "introduction": "网格收敛性研究是解验证的基石，它确保数值解在网格细化时能逼近真实解。理查森外推法 (Richardson extrapolation) 是此过程中一个强大的数学工具。本练习将指导您推导相关公式，利用不同网格分辨率下的模拟输出，来估计数值方法的精度阶数 $p$，并计算出真实解 $Q_0$ 的一个更精确、更高阶的估计值。",
            "id": "3829626",
            "problem": "考虑一个多尺度模拟，其中一个连续介质尺度的目标量（表示为 $Q$）是通过一个耦合的原子-连续介质模型在一系列特征间距为 $h$ 的网格上计算得出的。在渐进网格加密的情况下，假设离散化误差具有以下形式的主阶展开：$Q(h)=Q_{0}+C h^{p}+\\mathcal{O}(h^{p+1})$，其中 $Q_{0}$ 是与网格无关的值，$C$ 是一个常数，$p$ 是数值离散的精度阶。在验证与确认 (VV) 的背景下，网格验证的目的是从在连续加密的网格上计算出的 $Q(h)$ 值来估计 $Q_{0}$ 和 $p$。\n\n任务：\n1) 从精度阶的定义和主阶截断误差形式为 $C h^{p}$ 的假设出发，推导 Richardson 外推公式。该公式使用两个具有均匀加密因子 $r1$ 的网格层级来估计 $Q_{0}$，并消除主阶误差。你的推导必须从展开式 $Q(h)=Q_{0}+C h^{p}+\\mathcal{O}(h^{p+1})$ 开始，并通过代数消元法消除未知常数 $C$。\n2) 使用三个网格层级 $h$、$h/r$ 和 $h/r^{2}$（具有相同的加密因子 $r1$），推导一个精度阶 $p$ 的估计量，该估计量仅依赖于在三个网格上计算出的 $Q$ 值的差。然后，给出相应的用于估计 $Q_{0}$ 的 Richardson 外推估计量，该估计量使用最密的两个网格和你估计的 $p$ 值。你的推导必须只使用给定的渐进展开式和精度阶的定义。\n3) 将你的推导应用于以下数据，这些数据来自一个混合原子-连续介质应力计算，在三个网格层级上，均匀加密因子 $r=2$：粗网格 $h=10^{-1}$ 得到 $Q(h)=0.51$，中等网格 $h/2$ 得到 $Q(h/2)=0.5025$，细网格 $h/4$ 得到 $Q(h/4)=0.500625$。从三个网格层级计算估计的 $p$ 值，然后使用最密的两个网格和你估计的 $p$ 值计算 $Q_{0}$ 的 Richardson 外推估计值。将最终的外推值 $Q_{0}$ 表示为无量纲数，并将你的最终答案四舍五入到六位有效数字。",
            "solution": "该问题是有效的。这是一个数值分析中适定的问题，具体涉及用于网格验证的 Richardson 外推法，这是计算科学与工程中的一个标准程序。该问题具有科学依据、客观，并为其解决提供了所有必要的信息。\n\n解题过程按顺序解决这三个任务。\n\n**1) Richardson 外推公式的推导**\n\n给定目标量 $Q$ 在特征间距为 $h$ 的网格上计算时，其离散化误差的渐进展开式为：\n$$Q(h) = Q_{0} + C h^{p} + \\mathcal{O}(h^{p+1})$$\n其中 $Q_{0}$ 是精确值，$C$ 是一个常数，$p$ 是精度阶。\n\n我们考虑两个网格层级，一个间距为 $h$，另一个加密后的网格间距为 $h/r$，其中 $r  1$ 是均匀加密因子。在这些网格上计算出的量为：\n$$Q(h) = Q_{0} + C h^{p} + \\mathcal{O}(h^{p+1}) \\quad (*)$$\n$$Q(h/r) = Q_{0} + C \\left(\\frac{h}{r}\\right)^{p} + \\mathcal{O}\\left(\\left(\\frac{h}{r}\\right)^{p+1}\\right) = Q_{0} + \\frac{C h^{p}}{r^{p}} + \\mathcal{O}(h^{p+1}) \\quad (**)$$\n为了消除与 $C h^{p}$ 成正比的主阶误差项，我们可以将这两个方程视为一个关于未知数 $Q_0$ 和 $C h^p$ 的方程组。我们将第二个方程 $(**)$ 乘以 $r^{p}$：\n$$r^{p} Q(h/r) = r^{p} Q_{0} + C h^{p} + \\mathcal{O}(h^{p+1}) \\quad (***)$$\n现在，我们从这个新方程 $(***)$ 中减去第一个方程 $(*)$：\n$$r^{p} Q(h/r) - Q(h) = (r^{p} Q_{0} - Q_{0}) + (C h^{p} - C h^{p}) + \\mathcal{O}(h^{p+1})$$\n$$r^{p} Q(h/r) - Q(h) = (r^{p} - 1) Q_{0} + \\mathcal{O}(h^{p+1})$$\n解出 $Q_{0}$ 可得：\n$$Q_{0} = \\frac{r^{p} Q(h/r) - Q(h)}{r^{p} - 1} + \\mathcal{O}(h^{p+1})$$\nRichardson 外推估计量，我们记为 $Q_{RE}$，是此表达式的主项。该公式消除了 $\\mathcal{O}(h^p)$ 误差项，从而得到一个更精确的 $Q_0$ 估计值，其误差为 $\\mathcal{O}(h^{p+1})$。该公式的一个常见重排形式是：\n$$Q_{RE} = \\frac{(r^{p} - 1) Q(h/r) + Q(h/r) - Q(h)}{r^{p} - 1} = Q(h/r) + \\frac{Q(h/r) - Q(h)}{r^{p} - 1}$$\n这种形式将外推值表示为更精细网格上更准确的值 $Q(h/r)$，加上一个作为剩余主阶误差估计的修正项。\n\n**2) 精度阶 $p$ 和 $Q_{0}$ 的估计量的推导**\n\n现在我们使用三个网格层级，间距分别为 $h$、$h/r$ 和 $h/r^{2}$。为了推导估计量，我们忽略高阶项，写出方程组：\n$$Q_1 \\equiv Q(h) \\approx Q_{0} + C h^{p}$$\n$$Q_2 \\equiv Q(h/r) \\approx Q_{0} + C \\frac{h^{p}}{r^{p}}$$\n$$Q_3 \\equiv Q(h/r^2) \\approx Q_{0} + C \\frac{h^{p}}{r^{2p}}$$\n为了找到 $p$ 的估计量，我们首先通过计算连续解之间的差来消除 $Q_0$：\n$$\\text{diff}_1 = Q_1 - Q_2 = Q(h) - Q(h/r) \\approx (Q_{0} + C h^{p}) - \\left(Q_{0} + C \\frac{h^{p}}{r^{p}}\\right) = C h^{p} \\left(1 - \\frac{1}{r^{p}}\\right)$$\n$$\\text{diff}_2 = Q_2 - Q_3 = Q(h/r) - Q(h/r^2) \\approx \\left(Q_{0} + C \\frac{h^{p}}{r^{p}}\\right) - \\left(Q_{0} + C \\frac{h^{p}}{r^{2p}}\\right) = C \\frac{h^{p}}{r^{p}} \\left(1 - \\frac{1}{r^{p}}\\right)$$\n接下来，我们计算这两个差值的比率，以消除常数 $C$ 和项 $h^{p}$：\n$$\\frac{\\text{diff}_1}{\\text{diff}_2} = \\frac{Q(h) - Q(h/r)}{Q(h/r) - Q(h/r^2)} \\approx \\frac{C h^{p} \\left(1 - \\frac{1}{r^{p}}\\right)}{C \\frac{h^{p}}{r^{p}} \\left(1 - \\frac{1}{r^{p}}\\right)} = r^{p}$$\n这个比率通常被称为收敛率。设 $\\hat{p}$ 为估计的精度阶。我们可以通过对两边取自然对数来解出 $\\hat{p}$：\n$$\\ln\\left(\\frac{Q(h) - Q(h/r)}{Q(h/r) - Q(h/r^2)}\\right) \\approx \\ln(r^{p}) = p \\ln(r)$$\n因此，精度阶的估计量为：\n$$\\hat{p} = \\frac{\\ln\\left(\\frac{Q(h) - Q(h/r)}{Q(h/r) - Q(h/r^2)}\\right)}{\\ln(r)}$$\n使用最密的两个网格（间距为 $h/r$ 和 $h/r^2$）和估计的阶数 $\\hat{p}$，相应的 $Q_{0}$ 的 Richardson 外推估计量可以通过应用第 1 部分的公式得到。我们将较粗的网格间距标识为 $h' = h/r$，较细的网格间距标识为 $h'/r = h/r^2$。\n$$Q_{0, \\text{est}} = Q(h/r^2) + \\frac{Q(h/r^2) - Q(h/r)}{r^{\\hat{p}} - 1}$$\n\n**3) 应用于数值数据**\n\n给定以下数据，加密因子 $r=2$：\n- 粗网格 ($h$): $Q_1 = Q(h) = 0.51$\n- 中等网格 ($h/2$): $Q_2 = Q(h/2) = 0.5025$\n- 细网格 ($h/4$): $Q_3 = Q(h/4) = 0.500625$\n\n首先，我们计算估计的精度阶 $\\hat{p}$。\n差值为：\n$$Q_1 - Q_2 = 0.51 - 0.5025 = 0.0075$$\n$$Q_2 - Q_3 = 0.5025 - 0.500625 = 0.001875$$\n收敛率为：\n$$\\frac{Q_1 - Q_2}{Q_2 - Q_3} = \\frac{0.0075}{0.001875} = 4$$\n现在，我们使用 $r=2$ 计算 $\\hat{p}$：\n$$\\hat{p} = \\frac{\\ln(4)}{\\ln(2)} = \\frac{\\ln(2^2)}{\\ln(2)} = \\frac{2 \\ln(2)}{\\ln(2)} = 2$$\n估计的精度阶恰好为 2。\n\n接下来，我们使用最密的两个网格（$Q_2$ 和 $Q_3$）和我们估计的阶数 $\\hat{p}=2$ 来计算 $Q_0$ 的 Richardson 外推估计值：\n$$Q_{0, \\text{est}} = Q_3 + \\frac{Q_3 - Q_2}{r^{\\hat{p}} - 1}$$\n代入数值：\n$$Q_{0, \\text{est}} = 0.500625 + \\frac{0.500625 - 0.5025}{2^2 - 1}$$\n$$Q_{0, \\text{est}} = 0.500625 + \\frac{-0.001875}{4 - 1}$$\n$$Q_{0, \\text{est}} = 0.500625 + \\frac{-0.001875}{3}$$\n$$Q_{0, \\text{est}} = 0.500625 - 0.000625$$\n$$Q_{0, \\text{est}} = 0.5$$\n问题要求最终答案四舍五入到六位有效数字。\n$$Q_{0, \\text{est}} = 0.500000$$\n最终计算出的值是估计的精度阶 $\\hat{p}=2$ 和外推值 $Q_{0, \\text{est}}=0.500000$。问题要求的是最终的外推值 $Q_0$。",
            "answer": "$$\\boxed{0.500000}$$"
        },
        {
            "introduction": "“制造解法”（Method of Manufactured Solutions, MMS）是代码验证中最严谨的技术之一，旨在确认程序是否正确地求解了其所声称的方程。其核心思想是选择一个光滑的解析函数作为“制造”解，然后修改控制方程（例如，通过添加一个源项），使得该函数成为修正后方程的精确解。本实践操作聚焦于该方法的关键第一步：针对给定的偏微分方程和制造解，推导出所需的源项。",
            "id": "3829627",
            "problem": "在一维多尺度框架内，热量输运的宏观尺度扩散模型由偏微分方程 (PDE) $u_{t}-\\alpha u_{xx}=f(x,t)$ 控制，其空间域为 $x\\in[0,1]$，时间为 $t\\geq 0$，其中 $\\alpha0$ 是热扩散系数。为了通过制造解法 (MMS) 进行严格的代码验证，考虑制造的场 $u(x,t)=\\sin(\\pi x)\\exp(-\\pi^{2}\\alpha t)$。从该偏微分方程和偏导数的核心定义出发，推导使 $u(x,t)$ 成为精确解的强迫项 $f(x,t)$。指明与该 $u(x,t)$ 选择完全一致且适用于 $[0,1]\\times[0,\\infty)$ 上适定的初边值问题的边界条件和初始条件。不要使用启发式捷径；从第一性原理出发证明你的推导过程。将强迫项 $f(x,t)$ 作为最终答案。最终表达式无需四舍五入，也无需物理单位。",
            "solution": "问题陈述经评估有效。它具有科学依据、适定、客观且自洽。该任务是制造解法（MMS）的一个标准应用，MMS是科学与工程领域中验证数值代码的一项基石技术。问题要求为给定的偏微分方程（PDE）和指定的制造解推导源项，这是一个数学上严谨且定义明确的过程。\n\n宏观尺度扩散模型的控制偏微分方程如下：\n$$\nu_{t} - \\alpha u_{xx} = f(x,t)\n$$\n其中 $u(x,t)$ 是场变量（例如温度），$u_t = \\frac{\\partial u}{\\partial t}$，$u_{xx} = \\frac{\\partial^2 u}{\\partial x^2}$，$\\alpha  0$ 是恒定的热扩散系数，$f(x,t)$ 是强迫项或源项。空间域为 $x \\in [0,1]$，时间域为 $t \\geq 0$。\n\n给定的制造解为：\n$$\nu(x,t) = \\sin(\\pi x) \\exp(-\\pi^{2}\\alpha t)\n$$\n为了求出使该函数成为偏微分方程精确解的强迫项 $f(x,t)$，我们必须计算 $u(x,t)$ 的必要偏导数，并将它们代入方程中。强迫项被分离为 $f(x,t) = u_t - \\alpha u_{xx}$。\n\n首先，我们计算 $u(x,t)$ 关于时间 $t$ 的偏导数。根据偏导数的定义，我们将 $x$ 视为常数。\n$$\nu_t = \\frac{\\partial}{\\partial t} \\left[ \\sin(\\pi x) \\exp(-\\pi^{2}\\alpha t) \\right]\n$$\n项 $\\sin(\\pi x)$ 在对 $t$ 微分时充当常数系数。对指数函数应用链式法则 $\\frac{d}{dt} \\exp(g(t)) = g'(t) \\exp(g(t))$，其中 $g(t) = -\\pi^{2}\\alpha t$，我们得到 $g'(t) = -\\pi^{2}\\alpha$。\n因此，时间导数为：\n$$\nu_t = \\sin(\\pi x) \\cdot \\left( -\\pi^{2}\\alpha \\right) \\exp(-\\pi^{2}\\alpha t) = -\\pi^{2}\\alpha \\sin(\\pi x) \\exp(-\\pi^{2}\\alpha t)\n$$\n\n接下来，我们计算 $u(x,t)$ 关于空间变量 $x$ 的二阶偏导数。我们从一阶导数 $u_x$ 开始。在这里，项 $\\exp(-\\pi^{2}\\alpha t)$ 被视为常数。\n$$\nu_x = \\frac{\\partial}{\\partial x} \\left[ \\sin(\\pi x) \\exp(-\\pi^{2}\\alpha t) \\right] = \\exp(-\\pi^{2}\\alpha t) \\cdot \\frac{\\partial}{\\partial x} \\left[ \\sin(\\pi x) \\right]\n$$\n使用链式法则，可得：\n$$\nu_x = \\exp(-\\pi^{2}\\alpha t) \\cdot \\left( \\pi \\cos(\\pi x) \\right) = \\pi \\cos(\\pi x) \\exp(-\\pi^{2}\\alpha t)\n$$\n现在，我们将 $u_x$ 对 $x$ 求导以求得 $u_{xx}$：\n$$\nu_{xx} = \\frac{\\partial}{\\partial x} \\left[ u_x \\right] = \\frac{\\partial}{\\partial x} \\left[ \\pi \\cos(\\pi x) \\exp(-\\pi^{2}\\alpha t) \\right]\n$$\n项 $\\pi \\exp(-\\pi^{2}\\alpha t)$ 相对于 $x$ 是一个常数。\n$$\nu_{xx} = \\pi \\exp(-\\pi^{2}\\alpha t) \\cdot \\frac{\\partial}{\\partial x} \\left[ \\cos(\\pi x) \\right]\n$$\n再次应用链式法则：\n$$\nu_{xx} = \\pi \\exp(-\\pi^{2}\\alpha t) \\cdot \\left( -\\pi \\sin(\\pi x) \\right) = -\\pi^{2} \\sin(\\pi x) \\exp(-\\pi^{2}\\alpha t)\n$$\n\n现在我们将 $u_t$ 和 $u_{xx}$ 的表达式代入强迫项的公式 $f(x,t) = u_t - \\alpha u_{xx}$。\n$$\nf(x,t) = \\left( -\\pi^{2}\\alpha \\sin(\\pi x) \\exp(-\\pi^{2}\\alpha t) \\right) - \\alpha \\left( -\\pi^{2} \\sin(\\pi x) \\exp(-\\pi^{2}\\alpha t) \\right)\n$$\n化简该表达式：\n$$\nf(x,t) = -\\pi^{2}\\alpha \\sin(\\pi x) \\exp(-\\pi^{2}\\alpha t) + \\pi^{2}\\alpha \\sin(\\pi x) \\exp(-\\pi^{2}\\alpha t)\n$$\n这两项大小相同但符号相反，因此它们完全抵消。\n$$\nf(x,t) = 0\n$$\n这个结果表明，所选的制造解 $u(x,t) = \\sin(\\pi x)\\exp(-\\pi^{2}\\alpha t)$ 实际上是齐次热方程 $u_t - \\alpha u_{xx} = 0$ 的一个精确解。虽然这是 MMS 中的一个特例（通常构造的解会产生一个非零的强迫项），但它是该过程的一个完全有效的结果。\n\n问题还要求指明一致的边界条件和初始条件。这些条件是通过在时空域的边界上计算制造解 $u(x,t)$ 来推导的。\n初始条件设定在 $t=0$，对于 $x \\in [0,1]$：\n$$\nu(x,0) = \\sin(\\pi x) \\exp(-\\pi^{2}\\alpha \\cdot 0) = \\sin(\\pi x) \\exp(0) = \\sin(\\pi x)\n$$\n边界条件设定在 $x=0$ 和 $x=1$，对于所有 $t \\geq 0$。我们将指定狄利克雷边界条件。\n在 $x=0$ 处：\n$$\nu(0,t) = \\sin(\\pi \\cdot 0) \\exp(-\\pi^{2}\\alpha t) = \\sin(0) \\exp(-\\pi^{2}\\alpha t) = 0\n$$\n在 $x=1$ 处：\n$$\nu(1,t) = \\sin(\\pi \\cdot 1) \\exp(-\\pi^{2}\\alpha t) = \\sin(\\pi) \\exp(-\\pi^{2}\\alpha t) = 0\n$$\n因此，该制造解求解了由偏微分方程 $u_t - \\alpha u_{xx} = 0$、初始条件 $u(x,0) = \\sin(\\pi x)$ 以及齐次狄利克雷边界条件 $u(0,t) = 0$ 和 $u(1,t)=0$ 所定义的初边值问题。\n\n该具体问题要求的是强迫项 $f(x,t)$。根据我们的严谨推导，强迫项为 $0$。",
            "answer": "$$\n\\boxed{0}\n$$"
        }
    ]
}