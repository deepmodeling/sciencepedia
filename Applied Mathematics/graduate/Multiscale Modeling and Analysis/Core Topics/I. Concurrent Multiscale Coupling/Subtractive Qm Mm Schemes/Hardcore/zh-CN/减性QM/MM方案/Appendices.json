{
    "hands_on_practices": [
        {
            "introduction": "掌握减去法 QM/MM 方案的关键在于理解其核心的能量表达式。本练习将引导你通过一个理想化的简单模型，剖析该方案的能量构成 。通过这个推导，你将清晰地看到减去项 $E_{\\mathrm{MM}}(Q)$ 如何精确地消除对 QM 区域内部相互作用的双重计算，并进一步探讨在更真实的复杂系统中，这种理想的抵消为何会变得不完全。",
            "id": "3811417",
            "problem": "考虑一个由原子 $1$–$2$–$3$–$4$ 标记的线性四原子片段，其中原子 $2$ 和 $3$ 构成量子力学区域 $Q=\\{2,3\\}$，原子 $1$ 和 $4$ 构成分子力学区域 $M=\\{1,4\\}$。经典的分子力学描述采用标准的、经过充分检验的能量分解方法，将能量分解为键合、键角和二面角贡献，其函数形式如下：\n- 直接键合原子对 $(i,j)$ 的键合项：$E_{\\mathrm{bond}}(i,j)=\\frac{1}{2}k_{ij}\\left(r_{ij}-r_{ij}^{0}\\right)^{2}$。\n- 原子三元组 $(i,j,k)$ 的键角项：$E_{\\mathrm{angle}}(i,j,k)=\\frac{1}{2}k_{ijk}\\left(\\alpha_{ijk}-\\alpha_{ijk}^{0}\\right)^{2}$。\n- 原子四元组 $(i,j,k,\\ell)$ 的二面角项：$E_{\\mathrm{dihedral}}(i,j,k,\\ell)=\\sum_{m=1}^{p}\\frac{V_{m}}{2}\\left[1+\\cos\\!\\left(m\\,\\phi_{ijkl}-\\gamma_{m}\\right)\\right]$，其中对 $m$ 的求和表示一个标准的傅里叶级数扭转参数化，其振幅为 $V_{m}$，周期性为 $m$，相位偏移为 $\\gamma_{m}$。\n\n假设该分子的拓扑结构具有键 $(1,2)$、$(2,3)$、$(3,4)$，键角 $(1,2,3)$、$(2,3,4)$ 和二面角 $(1,2,3,4)$。在减法量子力学/分子力学 (QM/MM) 方案中，混合能量的构建方法是：用量子力学处理取代量子力学区域的分子力学描述，同时保留整个系统的分子力学描述，并移除纯粹对量子力学区域的分子力学描述。从这一规范以及将经典能量分解为 $Q$ 内部、 $M$ 内部和混合 $Q$–$M$ 相互作用类别出发。仅使用这些基础，推导减去量子力学区域的分子力学能量 $E_{\\mathrm{MM}}(Q)$ 对跨越 QM/MM 边界的键合项、键角项和二面角项的净效应。\n\n计算并提供一个单一的闭式解析表达式，表示在此四原子体系中，减去 $E_{\\mathrm{MM}}(Q)$ 后剩余的、源自跨边界的键合、键角和二面角项的残余贡献。该表达式需用 $r_{12}$、 $r_{34}$、 $\\alpha_{123}$、 $\\alpha_{234}$、 $\\phi_{1234}$ 以及相应的参数 $k_{12}$、 $r_{12}^{0}$、 $k_{34}$、 $r_{34}^{0}$、 $k_{123}$、 $\\alpha_{123}^{0}$、 $k_{234}$、 $\\alpha_{234}^{0}$、 $\\{V_{m},\\gamma_{m}\\}_{m=1}^{p}$ 来表示。最终表达式中不应包含单位。无需进行数值评估。\n\n然后，在你的推导过程中，识别并解释在减法 QM/MM 方案中，跨界项的抵消在何种条件下会不完全，重点关注物理上现实的特征，例如多原子跨界耦合、加帽/连接原子修饰，以及非加和性或拓扑依赖的函数形式。你的最终答案必须是一个单一的解析表达式。",
            "solution": "问题陈述已经过验证，被认为是有效的。它在科学上基于多尺度建模的原理，特别是减法 QM/MM 方案。该问题是良定的、客观的，并包含进行形式推导所需的所有信息。\n\n减法 QM/MM 方案的核心是系统总能量 $E_{\\mathrm{QM/MM}}$ 的表达式。对于一个划分为量子力学区域 $Q$ 和分子力学区域 $M$ 的系统，其能量由下式给出：\n$$E_{\\mathrm{QM/MM}} = E_{\\mathrm{MM}}(Q+M) - E_{\\mathrm{MM}}(Q) + E_{\\mathrm{QM}}(Q)$$\n此处，$E_{\\mathrm{MM}}(Q+M)$ 是整个系统的 MM 能量，$E_{\\mathrm{QM}}(Q)$ 是孤立 QM 区域的 QM 能量，而 $E_{\\mathrm{MM}}(Q)$ 是孤立 QM 区域的 MM 能量。减去 $E_{\\mathrm{MM}}(Q)$ 的目的是为了修正对 $Q$ 区域内相互作用的双重计算，因为 $E_{\\mathrm{MM}}(Q+M)$ 和 $E_{\\mathrm{QM}}(Q)$ 都描述了这些相互作用。\n\n问题要求的是从 $E_{\\mathrm{MM}}(Q+M)$ 中减去 $E_{\\mathrm{MM}}(Q)$ 后，跨界项所产生的残余贡献。这对应于总混合能量中的经典力学部分，即 $E_{\\mathrm{MM}}(Q+M) - E_{\\mathrm{MM}}(Q)$。\n\n首先，我们根据所提供的拓扑结构，识别出完整的四原子系统 $1$–$2$–$3$–$4$（表示为 $Q+M$）的所有 MM 能量项。QM 区域为 $Q=\\{2,3\\}$，MM 区域为 $M=\\{1,4\\}$。\n\n总 MM 能量 $E_{\\mathrm{MM}}(Q+M)$ 是所有已定义的键合和非键合相互作用的总和。问题指定了键 $(1,2)$、$(2,3)$、$(3,4)$；键角 $(1,2,3)$、$(2,3,4)$；以及二面角 $(1,2,3,4)$。相应的能量为：\n$$E_{\\mathrm{MM}}(Q+M) = E_{\\mathrm{bond}}(1,2) + E_{\\mathrm{bond}}(2,3) + E_{\\mathrm{bond}}(3,4) + E_{\\mathrm{angle}}(1,2,3) + E_{\\mathrm{angle}}(2,3,4) + E_{\\mathrm{dihedral}}(1,2,3,4)$$\n我们可以根据这些项是位于 $Q$ 区域内部、 $M$ 区域内部，还是跨越边界（混合 $Q-M$ 项）来进行分类。\n- **Q 内部项：** 这些项只涉及来自 $Q=\\{2,3\\}$ 的原子。唯一的此类项是原子 $2$ 和 $3$ 之间的键。\n  $$E_{\\mathrm{MM}}^{\\mathrm{int-Q}} = E_{\\mathrm{bond}}(2,3)$$\n- **M 内部项：** 这些项只涉及来自 $M=\\{1,4\\}$ 的原子。在这种线性拓扑结构中，不存在只涉及原子 $1$ 和 $4$ 的键、键角或二面角。\n  $$E_{\\mathrm{MM}}^{\\mathrm{int-M}} = 0$$\n- **混合 Q-M（跨界）项：** 这些项涉及来自 $Q$ 和 $M$ 的原子。\n  - 键：$(1,2)$ 键连接 $M$ 和 $Q$。$(3,4)$ 键连接 $Q$ 和 $M$。\n  - 键角：$(1,2,3)$ 键角涉及来自 $M$ 和 $Q$ 的原子。$(2,3,4)$ 键角涉及来自 $Q$ 和 $M$ 的原子。\n  - 二面角：$(1,2,3,4)$ 二面角涉及来自 $M$ 和 $Q$ 的原子。\n  因此，所有跨界项的集合为：\n  $$E_{\\mathrm{MM}}^{\\mathrm{mixed}} = E_{\\mathrm{bond}}(1,2) + E_{\\mathrm{bond}}(3,4) + E_{\\mathrm{angle}}(1,2,3) + E_{\\mathrm{angle}}(2,3,4) + E_{\\mathrm{dihedral}}(1,2,3,4)$$\n\n接下来，我们定义减去项 $E_{\\mathrm{MM}}(Q)$。这是使用相同的 MM 力场计算的孤立 QM 区域 $\\{2,3\\}$ 的能量。根据提供的拓扑规则，唯一能用原子 $2$ 和 $3$ 定义的相互作用项是它们之间的键。\n$$E_{\\mathrm{MM}}(Q) = E_{\\mathrm{bond}}(2,3)$$\n显而易见，对于这个简单的加和性力场， $E_{\\mathrm{MM}}(Q) = E_{\\mathrm{MM}}^{\\mathrm{int-Q}}$。\n\n现在我们通过执行减法来计算混合能量的经典部分：\n$$E_{\\mathrm{MM}}(Q+M) - E_{\\mathrm{MM}}(Q) = (E_{\\mathrm{MM}}^{\\mathrm{int-Q}} + E_{\\mathrm{MM}}^{\\mathrm{int-M}} + E_{\\mathrm{MM}}^{\\mathrm{mixed}}) - E_{\\mathrm{MM}}^{\\mathrm{int-Q}}$$\n$$E_{\\mathrm{MM}}(Q+M) - E_{\\mathrm{MM}}(Q) = E_{\\mathrm{MM}}^{\\mathrm{int-M}} + E_{\\mathrm{MM}}^{\\mathrm{mixed}}$$\n由于 $E_{\\mathrm{MM}}^{\\mathrm{int-M}}$ 为零，结果就是所有混合 Q-M 项的总和：\n$$E_{\\mathrm{MM}}(Q+M) - E_{\\mathrm{MM}}(Q) = E_{\\mathrm{MM}}^{\\mathrm{mixed}}$$\n减去 $E_{\\mathrm{MM}}(Q)$ 完全移除了对 QM 区域的纯经典描述，而未触及跨界项。问题要求的是“源自跨界……项的残余贡献”。因此，这个贡献就是这些项本身的总和。\n\n代入问题陈述中提供的函数形式：\n- $E_{\\mathrm{bond}}(1,2) = \\frac{1}{2}k_{12}(r_{12}-r_{12}^{0})^{2}$\n- $E_{\\mathrm{bond}}(3,4) = \\frac{1}{2}k_{34}(r_{34}-r_{34}^{0})^{2}$\n- $E_{\\mathrm{angle}}(1,2,3) = \\frac{1}{2}k_{123}(\\alpha_{123}-\\alpha_{123}^{0})^{2}$\n- $E_{\\mathrm{angle}}(2,3,4) = \\frac{1}{2}k_{234}(\\alpha_{234}-\\alpha_{234}^{0})^{2}$\n- $E_{\\mathrm{dihedral}}(1,2,3,4) = \\sum_{m=1}^{p}\\frac{V_{m}}{2}\\left[1+\\cos\\!\\left(m\\,\\phi_{1234}-\\gamma_{m}\\right)\\right]$\n\n这些跨界项的总残余贡献是它们的和：\n$$E_{\\text{residual}} = \\frac{1}{2}k_{12}(r_{12}-r_{12}^{0})^{2} + \\frac{1}{2}k_{34}(r_{34}-r_{34}^{0})^{2} + \\frac{1}{2}k_{123}(\\alpha_{123}-\\alpha_{123}^{0})^{2} + \\frac{1}{2}k_{234}(\\alpha_{234}-\\alpha_{234}^{0})^{2} + \\sum_{m=1}^{p}\\frac{V_{m}}{2}\\left[1+\\cos\\!\\left(m\\,\\phi_{1234}-\\gamma_{m}\\right)\\right]$$\n这就是所要求的解析表达式。\n\n问题的第二部分要求识别并解释在更普遍的减法 QM/MM 方案中，抵消在何种条件下会不完全。上述推导假设了一个非常简单的模型，其中抵消是完美的。在实际应用中，由于多种因素，情况往往并非如此。\n\n1.  **加帽/连接原子修饰：** 当在 QM/MM 边界处切断共价键时（此处为 $1$-$2$ 和 $3$-$4$ 键），边界 QM 原子（$2$ 和 $3$）的原子价会处于不饱和状态。这对于 QM 计算来说是不符合物理实际的。为了弥补这一点，会添加一个“连接原子”（通常是氢原子 $H$）来对悬挂键进行“加帽”，从而为 QM 计算创造一个更真实的化学环境。对于我们的系统，可以用连接原子 $H_{L1}$ 对原子 $2$ 进行加帽，用 $H_{L2}$ 对原子 $3$ 进行加帽。然后，对这个修改后的 QM 子系统 $Q' = \\{H_{L1}, 2, 3, H_{L2}\\}$ 执行 QM 计算和减法项计算。\n    混合能量表达式变为 $E_{\\mathrm{QM/MM}} = E_{\\mathrm{MM}}(Q+M) - E_{\\mathrm{MM}}(Q') + E_{\\mathrm{QM}}(Q')$。关键问题在于 $E_{\\mathrm{MM}}(Q')$ 并非 $E_{\\mathrm{MM}}(Q+M)$ 中各项的简单子集。例如，$E_{\\mathrm{MM}}(Q+M)$ 包含依赖于原子 $1$ 的键角项 $E_{\\mathrm{angle}}(1,2,3)$。而减去项 $E_{\\mathrm{MM}}(Q')$ 包含一个相应的键角项 $E_{\\mathrm{angle}}(H_{L1},2,3)$，它依赖于连接原子 $H_{L1}$。这两项涉及不同的原子，并且很可能具有不同的力场参数（$k_{123}$ 对比 $k_{H_{L1},2,3}$）。它们不会相互抵消。这种不匹配会在边界处引入人为误差，因为减法不再是“干净”的。该方案寄希望于 $E_{\\mathrm{QM}}(Q')$ 能隐式地捕捉原子 $1$ 环境的影响，但 MM 项的不完美减法会污染能量和力。\n\n2.  **多原子跨界耦合和非加和性形式：** 许多现代力场并非严格的对加和性，而是包含耦合不同内坐标（如键-角或角-角）的交叉项。考虑一个假设项 $E_{\\mathrm{cross}} = k_{\\mathrm{cross}}(\\alpha_{123}-\\alpha_{123}^0)(\\alpha_{234}-\\alpha_{234}^0)$。该项是 $E_{\\mathrm{MM}}(Q+M)$ 的一部分，并跨越边界。在构建 $E_{\\mathrm{MM}}(Q)$（或带连接原子的 $E_{\\mathrm{MM}}(Q')$）时，由于需要同时使用边界两侧的原子，因此无法形成此类项。于是，它在减法后会像其他边界项一样保留下来。更微妙的问题是，当一个项在形式上同时存在于全系统和子系统的计算中，但其参数却依赖于上下文。例如，如果中心键的力常数 $k_{23}$ 依赖于化学环境（例如，通过键级形式），其在全系统（$Q+M$）中的值可能与在加帽子系统（$Q'$）中的值不同。这会导致即使是像 $E_{\\mathrm{bond}}(2,3)$ 这样的项也无法完全抵消，即 $E_{\\mathrm{bond}}(2,3)|_{Q+M} \\neq E_{\\mathrm{bond}}(2,3)|_{Q'}$。\n\n3.  **拓扑依赖的参数：** MM 力场中的部分原子电荷是另一个导致抵消不完全的来源。在一个简单的方案中，原子 $2$ 在所有计算中都具有电荷 $q_2$。然而，如果电荷是由对整体分子拓扑敏感的算法确定的，那么为全系统 $Q+M$ 计算的电荷 $q_2$ 可能与在孤立子系统 $Q'$ 中分配给原子 $2$ 的电荷不同。这样，涉及原子 $2$ 的静电相互作用能量项就无法正确抵消，从而导致误差。这突显了减法方案的一个根本弱点：它们含蓄地假设力场项可以在全系统和人工构建的子系统之间完美转移，而这个假设在边界处常常不成立。",
            "answer": "$$\n\\boxed{\\frac{1}{2}k_{12}(r_{12}-r_{12}^{0})^{2} + \\frac{1}{2}k_{34}(r_{34}-r_{34}^{0})^{2} + \\frac{1}{2}k_{123}(\\alpha_{123}-\\alpha_{123}^{0})^{2} + \\frac{1}{2}k_{234}(\\alpha_{234}-\\alpha_{234}^{0})^{2} + \\sum_{m=1}^{p}\\frac{V_{m}}{2}\\left[1+\\cos\\!\\left(m\\,\\phi_{1234}-\\gamma_{m}\\right)\\right]}\n$$"
        },
        {
            "introduction": "在QM/MM模拟中，一个核心问题是QM区域如何“感受”到MM环境的存在，这引出了不同的“嵌入”方案。本练习将重点比较两种最基本的方案：机械嵌入和静电嵌入 。通过对一个受MM点电荷环境影响的QM水二聚体进行具体计算，你将亲手量化由MM环境引起的QM波函数极化所带来的能量变化，从而深刻理解静电嵌入对于提升模型精度的重要性。",
            "id": "3811451",
            "problem": "为水二聚体设置了一个双尺度量子力学/分子力学 (QM/MM) 计算，该水二聚体在量子力学水平上进行处理，并嵌入到一个由模拟邻近水分子的固定点电荷所代表的分子力学环境中。在减法 QM/MM 方案中，复合体系的总能量通过将 QM 区域的量子力学计算与完整体系的经典分子力学评估相结合，然后减去 QM 区域的经典能量来定义，以消除对区域内相互作用的重复计算。考虑了两种嵌入方案：力学嵌入，它对 QM 区域使用裸量子力学哈密顿量；以及静电嵌入，它将 MM 点电荷的外部静电势添加到 QM 哈密顿量中，从而允许 MM 环境对 QM 电子密度进行极化。\n\n从第一性原理出发，使用电场的库仑定律和 QM 区域极化的线性响应理论，推导在减法方案中静电嵌入和力学嵌入之间的总能量差异。然后，计算下面给出的特定构型的该能量差异，并报告因忽略极化而产生的误差量级（即静电嵌入和力学嵌入之间差异的量级）。将您的答案四舍五入到四位有效数字，并以 kJ·mol$^{-1}$ 为单位表示最终能量。\n\n基本原理：\n- 点电荷产生的电场的库仑定律：位于 $\\mathbf{r}_i$ 的电荷 $q$ 在位置 $\\mathbf{r}$ 处产生的电场为\n$$\n\\mathbf{E}(\\mathbf{r}) \\;=\\; \\frac{1}{4\\pi \\varepsilon_0} \\, q \\, \\frac{\\mathbf{r}-\\mathbf{r}_i}{\\left\\lvert \\mathbf{r}-\\mathbf{r}_i \\right\\rvert^{3}},\n$$\n其中 $\\varepsilon_0$ 是真空介电常数。\n- 各向同性可极化系统的线性响应：对于大小为 $F$ 的均匀外场，基态能量的主要（二阶）变化为\n$$\n\\Delta E_{\\mathrm{pol}} \\;=\\; -\\frac{1}{2}\\,\\alpha\\,F^{2},\n$$\n其中 $\\alpha$ 是沿场方向的各向同性极化率。\n\n定义：\n- 量子力学/分子力学 (QM/MM) 减法能量：对于嵌入在 MM 环境中的 QM 区域，总能量为\n$$\nE_{\\mathrm{tot}} \\;=\\; E_{\\mathrm{QM}}(\\text{QM}) \\;+\\; E_{\\mathrm{MM}}(\\text{full}) \\;-\\; E_{\\mathrm{MM}}(\\text{QM}).\n$$\n- 力学嵌入：$E_{\\mathrm{QM}}(\\text{QM})$ 使用裸量子力学哈密顿量（无外部 MM 静电）进行评估。\n- 静电嵌入：$E_{\\mathrm{QM}}(\\text{QM})$ 在量子力学哈密顿量中包含 MM 点电荷的外部静电势的情况下进行评估。\n\n构型与数据：\n- 将 QM 水二聚体的质心置于原点，其主偶极轴与 $y$ 轴对齐。\n- MM 环境由相对于原点的三个固定位置（单位为 nm）的点电荷表示：\n  - 两个氢原子：$q_{\\mathrm{H}} = +0.417\\,e$，位于 $\\mathbf{r}_{\\mathrm{H}_1} = (0.30,\\,0,\\,0)\\,\\mathrm{nm}$ 和 $\\mathbf{r}_{\\mathrm{H}_2} = (-0.30,\\,0,\\,0)\\,\\mathrm{nm}$。\n  - 一个氧原子：$q_{\\mathrm{O}} = -0.834\\,e$，位于 $\\mathbf{r}_{\\mathrm{O}} = (0,\\,0.40,\\,0)\\,\\mathrm{nm}$。\n- 假设 QM 水二聚体的诱导响应沿 $y$ 轴是线性和各向同性的，其极化率为\n$$\n\\alpha_{\\mathrm{d}} \\;=\\; 0.20 \\,\\mathrm{kJ\\,mol^{-1}\\,(V/nm)^{-2}}.\n$$\n- 常数：真空介电常数 $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F\\,m^{-1}}$，库仑常数 $k_e = \\frac{1}{4\\pi \\varepsilon_0}$，元电荷 $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$。\n\n任务：\n1. 使用上述减法 QM/MM 定义，用 QM 能量因 MM 静电场而产生的变化来表示总能量差异 $E_{\\mathrm{EE}} - E_{\\mathrm{ME}}$。\n2. 计算由三个 MM 电荷在原点产生的净电场，并以 $\\mathrm{V/nm}$ 为单位表示其大小 $F$。\n3. 使用线性响应公式，计算静电嵌入和力学嵌入之间能量差异的量级 $|E_{\\mathrm{EE}} - E_{\\mathrm{ME}}|$，单位为 $\\mathrm{kJ\\,mol^{-1}}$。\n将您的最终数值答案四舍五入到四位有效数字，并以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位表示。",
            "solution": "该问题要求计算静电嵌入 (EE) 和力学嵌入 (ME) 的减法量子力学/分子力学 (QM/MM) 计算之间的总能量差异的量级。\n\n首先，我们根据所提供的定义推导能量差异的表达式 $E_{\\mathrm{EE}} - E_{\\mathrm{ME}}$。\n在减法 QM/MM 方案中，总能量由以下公式给出：\n$$\nE_{\\mathrm{tot}} = E_{\\mathrm{QM}}(\\text{QM}) + E_{\\mathrm{MM}}(\\text{full}) - E_{\\mathrm{MM}}(\\text{QM})\n$$\n在力学嵌入中，量子力学能量项 $E_{\\mathrm{QM}}(\\text{QM})$ 是针对具有其裸哈密顿量的 QM 区域，我们将其表示为 $E_{\\mathrm{QM}}^{\\mathrm{bare}}$。因此，ME 的总能量为：\n$$\nE_{\\mathrm{ME}} = E_{\\mathrm{QM}}^{\\mathrm{bare}}(\\text{QM}) + E_{\\mathrm{MM}}(\\text{full}) - E_{\\mathrm{MM}}(\\text{QM})\n$$\n在静电嵌入中，QM 哈密顿量包含来自 MM 点电荷的外部静电势。这会极化 QM 电子密度，所得的 QM 能量表示为 $E_{\\mathrm{QM}}^{\\mathrm{pol}}$。EE 的总能量为：\n$$\nE_{\\mathrm{EE}} = E_{\\mathrm{QM}}^{\\mathrm{pol}}(\\text{QM}) + E_{\\mathrm{MM}}(\\text{full}) - E_{\\mathrm{MM}}(\\text{QM})\n$$\n通过从 $E_{\\mathrm{EE}}$ 的表达式中减去 $E_{\\mathrm{ME}}$ 的表达式，可以得到两种方案之间的总能量差异：\n$$\nE_{\\mathrm{EE}} - E_{\\mathrm{ME}} = \\left( E_{\\mathrm{QM}}^{\\mathrm{pol}}(\\text{QM}) + E_{\\mathrm{MM}}(\\text{full}) - E_{\\mathrm{MM}}(\\text{QM}) \\right) - \\left( E_{\\mathrm{QM}}^{\\mathrm{bare}}(\\text{QM}) + E_{\\mathrm{MM}}(\\text{full}) - E_{\\mathrm{MM}}(\\text{QM}) \\right)\n$$\n涉及分子力学能量的项，$E_{\\mathrm{MM}}(\\text{full})$ 和 $E_{\\mathrm{MM}}(\\text{QM})$，相互抵消，剩下：\n$$\nE_{\\mathrm{EE}} - E_{\\mathrm{ME}} = E_{\\mathrm{QM}}^{\\mathrm{pol}}(\\text{QM}) - E_{\\mathrm{QM}}^{\\mathrm{bare}}(\\text{QM})\n$$\n这个差异，$E_{\\mathrm{QM}}^{\\mathrm{pol}}(\\text{QM}) - E_{\\mathrm{QM}}^{\\mathrm{bare}}(\\text{QM})$，表示 QM 区域在受到 MM 环境产生的外部电场作用时基态能量的变化。问题指出，对于线性的、各向同性的响应，这个能量变化由以下公式给出：\n$$\n\\Delta E_{\\mathrm{pol}} = -\\frac{1}{2} \\alpha F^2\n$$\n其中 $\\alpha$ 是极化率，$F$ 是外部均匀场的大小。因此，总能量差异等于极化能：\n$$\nE_{\\mathrm{EE}} - E_{\\mathrm{ME}} = \\Delta E_{\\mathrm{pol}} = -\\frac{1}{2} \\alpha_{\\mathrm{d}} F^2\n$$\n因忽略极化而产生的误差量级为 $|E_{\\mathrm{EE}} - E_{\\mathrm{ME}}| = \\frac{1}{2} \\alpha_{\\mathrm{d}} F^2$。\n\n接下来，我们计算位于原点的净电场大小 $F$，原点是 QM 水二聚体的位置。电场是来自 3 个 MM 点电荷的场的矢量和。\n位于 $\\mathbf{r}_i$ 的点电荷 $q_i$ 在位置 $\\mathbf{r}$ 处产生的电场为 $\\mathbf{E}_i(\\mathbf{r}) = \\frac{1}{4\\pi\\varepsilon_0} q_i \\frac{\\mathbf{r}-\\mathbf{r}_i}{|\\mathbf{r}-\\mathbf{r}_i|^3}$。在原点（$\\mathbf{r}=0$），该式简化为 $\\mathbf{E}_i(0) = -\\frac{1}{4\\pi\\varepsilon_0} q_i \\frac{\\mathbf{r}_i}{|\\mathbf{r}_i|^3}$。\n给定的 MM 电荷是：\n1.  $q_{\\mathrm{H}_1} = +0.417e$，位于 $\\mathbf{r}_{\\mathrm{H}_1} = (0.30, 0, 0)\\,\\mathrm{nm} = 0.30\\,\\mathbf{\\hat{i}}\\,\\mathrm{nm}$\n2.  $q_{\\mathrm{H}_2} = +0.417e$，位于 $\\mathbf{r}_{\\mathrm{H}_2} = (-0.30, 0, 0)\\,\\mathrm{nm} = -0.30\\,\\mathbf{\\hat{i}}\\,\\mathrm{nm}$\n3.  $q_{\\mathrm{O}} = -0.834e$，位于 $\\mathbf{r}_{\\mathrm{O}} = (0, 0.40, 0)\\,\\mathrm{nm} = 0.40\\,\\mathbf{\\hat{j}}\\,\\mathrm{nm}$\n\n来自两个氢电荷的贡献是：\n$$\n\\mathbf{E}_{\\mathrm{H}_1}(0) = -\\frac{1}{4\\pi\\varepsilon_0} \\frac{(+0.417e)(0.30\\,\\mathbf{\\hat{i}})}{|0.30|^3} = -\\frac{0.417e}{4\\pi\\varepsilon_0(0.30)^2} \\mathbf{\\hat{i}}\n$$\n$$\n\\mathbf{E}_{\\mathrm{H}_2}(0) = -\\frac{1}{4\\pi\\varepsilon_0} \\frac{(+0.417e)(-0.30\\,\\mathbf{\\hat{i}})}{|-0.30|^3} = +\\frac{0.417e}{4\\pi\\varepsilon_0(0.30)^2} \\mathbf{\\hat{i}}\n$$\n这两个场的和为 $\\mathbf{E}_{\\mathrm{H}_1}(0) + \\mathbf{E}_{\\mathrm{H}_2}(0) = \\mathbf{0}$。\n来自氧电荷的贡献是：\n$$\n\\mathbf{E}_{\\mathrm{O}}(0) = -\\frac{1}{4\\pi\\varepsilon_0} \\frac{(-0.834e)(0.40\\,\\mathbf{\\hat{j}})}{|0.40|^3} = +\\frac{0.834e}{4\\pi\\varepsilon_0(0.40)^2} \\mathbf{\\hat{j}}\n$$\n在原点的总电场为 $\\mathbf{E}_{\\mathrm{tot}} = \\mathbf{E}_{\\mathrm{O}}(0)$。为了计算它，我们使用常数组合 $k_e e = \\frac{e}{4\\pi\\varepsilon_0}$，其中 $k_e$ 是库仑常数。使用所提供的基本常数：\n$$\nk_e e = \\frac{1.602176634 \\times 10^{-19}\\,\\mathrm{C}}{4\\pi(8.8541878128 \\times 10^{-12}\\,\\mathrm{F\\,m^{-1}})} \\approx 1.4399645 \\times 10^{-9}\\,\\mathrm{V\\,m}\n$$\n由于 $1\\,\\mathrm{m} = 10^9\\,\\mathrm{nm}$，这个常数是 $k_e e \\approx 1.4399645\\,\\mathrm{V\\,nm}$。\n总场为：\n$$\n\\mathbf{E}_{\\mathrm{tot}} = \\frac{0.834}{(0.40)^2} (k_e e) \\frac{1}{\\mathrm{nm}^2} \\mathbf{\\hat{j}} = \\frac{0.834}{0.16} (k_e e) \\frac{1}{\\mathrm{nm}^2} \\mathbf{\\hat{j}} = 5.2125 \\times (1.4399645\\,\\mathrm{V\\,nm}) \\frac{1}{\\mathrm{nm}^2} \\mathbf{\\hat{j}}\n$$\n$$\n\\mathbf{E}_{\\mathrm{tot}} \\approx 7.50579\\,\\mathrm{V\\,nm^{-1}}\\,\\mathbf{\\hat{j}}\n$$\n场的大小为 $F = |\\mathbf{E}_{\\mathrm{tot}}| \\approx 7.50579\\,\\mathrm{V\\,nm^{-1}}$。\n\n最后，我们使用给定的极化率 $\\alpha_{\\mathrm{d}} = 0.20\\,\\mathrm{kJ\\,mol^{-1}\\,(V/nm)^{-2}}$ 计算能量差异的量级。\n$$\n|E_{\\mathrm{EE}} - E_{\\mathrm{ME}}| = \\frac{1}{2} \\alpha_{\\mathrm{d}} F^2 = \\frac{1}{2} \\left( 0.20\\,\\mathrm{kJ\\,mol^{-1}\\,(V/nm)^{-2}} \\right) \\left( 7.50579\\,\\mathrm{V\\,nm^{-1}} \\right)^2\n$$\n$$\n|E_{\\mathrm{EE}} - E_{\\mathrm{ME}}| = 0.10 \\times (7.50579)^2 \\,\\mathrm{kJ\\,mol^{-1}} \\approx 0.10 \\times 56.33688 \\,\\mathrm{kJ\\,mol^{-1}}\n$$\n$$\n|E_{\\mathrm{EE}} - E_{\\mathrm{ME}}| \\approx 5.633688\\,\\mathrm{kJ\\,mol^{-1}}\n$$\n将结果四舍五入到四位有效数字，我们得到 $5.634\\,\\mathrm{kJ\\,mol^{-1}}$。",
            "answer": "$$\n\\boxed{5.634}\n$$"
        },
        {
            "introduction": "当QM/MM边界需要切断化学键时，减去法方案面临着最大的挑战，这通常需要引入“连接原子”（link atom）来饱和QM区域的化学价。然而，这种处理方式本身是一种近似，会引入误差。在这个高级计算练习中，你将使用一个简化的紧束缚模型来模拟这一过程，通过编写程序来量化用一个氢连接原子替代一个碳原子片段所引入的电子结构误差 ，从而深入理解处理共价边界的复杂性与关键。",
            "id": "3811381",
            "problem": "考虑一个共价体系的减去法量子力学/分子力学 (QM/MM) 分区，其中一个量子力学 (QM) 区域在边界碳-碳键处由一个连接原子封端。在减去法方案中，分子力学 (MM) 环境在经典水平上描述，QM 区域单独计算，边界共价键由连接原子饱和以避免悬空键。一个已知的误差来源是用连接原子（例如氢原子）替换一个显式的 MM 片段（例如边界碳原子）。在此问题中，您将通过比较为两个模型计算的简化 QM 能量，来量化用连接原子替换单个边界碳-碳键所引入的误差：一个模型在 QM 哈密顿量中包含一个显式的 MM 碳片段，另一个模型中该片段被一个氢连接原子替换。\n\n采用 Born–Oppenheimer (BO) 近似，其中原子核被视为固定的，电子能量是相关的量。为了形式化 QM 能量，对包含边界键及其封端/片段的小簇使用单轨道紧束缚哈密顿量。每个原子位点由一个轨道表示，具有在位能和最近邻跃迁。哈密顿矩阵的构建如下：\n- 对于连接原子模型，定义一个由 QM 碳 $C_1$、边界 QM 碳 $C_2$ 和一个氢连接原子 $H_{\\text{link}}$ 组成的三位点系统。哈密顿量 $H_{\\text{link}}$ 是一个 $3 \\times 3$ 的对称矩阵，其对角元素为 $H_{00} = \\varepsilon_C$，$H_{11} = \\varepsilon_C$，$H_{22} = \\varepsilon_H$，非对角元素为 $H_{01} = H_{10} = t_{CC}(R_{C_1C_2})$，$H_{12} = H_{21} = t_{CH}(R_{C_2H})$，所有其他元素等于 $0$。\n- 对于显式 MM 片段模型，定义一个由 $C_1$、$C_2$ 和一个 MM 碳片段 $C_{\\text{MM}}$ 组成的三位点系统。哈密顿量 $H_{\\text{exp}}$ 是一个 $3 \\times 3$ 的对称矩阵，其对角元素为 $H_{00} = \\varepsilon_C$，$H_{11} = \\varepsilon_C$，$H_{22} = \\varepsilon_C + \\Delta_{\\text{MM}}$，非对角元素为 $H_{01} = H_{10} = t_{CC}(R_{C_1C_2})$，$H_{12} = H_{21} = t_{CC}(R_{C_2C_{\\text{MM}}})$，所有其他元素等于 $0$。\n\n假设依赖于距离的跃迁函数具有指数形式\n$$t_{XY}(R) = t_{0,XY} \\exp\\left(-\\beta_{XY} \\left(R - R^{\\text{ref}}_{XY}\\right)\\right),$$\n其中 $X,Y \\in \\{C,H\\}$ 表示原子类型，$R$ 是以埃 (Å) 为单位的键长。在位能对于碳是 $\\varepsilon_C$，对于氢是 $\\varepsilon_H$，单位均为电子伏特 (eV)。MM 片段在 MM 碳的在位能上引入一个位移 $\\Delta_{\\text{MM}}$（单位 eV），以模拟经典环境引起的极化。\n\n在化学势 $\\mu$ 下，定义零温巨正则系综电子能量为填充所有严格低于 $\\mu$ 的单电子能级 $\\varepsilon_k$（即，只有 $\\varepsilon_k  \\mu$ 的能级被占据），自旋简并因子为 $g_s = 2$。因此，对于一个哈密顿量 $H$，其 QM 能量为\n$$E(\\mu; H) = g_s \\sum_{\\varepsilon_k(H)  \\mu} \\varepsilon_k(H),$$\n其中 $\\{\\varepsilon_k(H)\\}$ 是 $H$ 的本征值。因边界碳-碳键的连接原子替换而产生的误差则定义为\n$$\\Delta E(\\mu) = E(\\mu; H_{\\text{link}}) - E(\\mu; H_{\\text{exp}}),$$\n单位为电子伏特 (eV)。一个正的 $\\Delta E$ 表示在相同的 $\\mu$ 下，连接原子模型产生的 QM 能量高于显式片段模型。\n\n您的任务是实现一个程序，对于一组参数化的测试用例，构建两个哈密顿量，计算它们的本征值，为每个模型评估 $E(\\mu)$，并报告每个用例的 $\\Delta E(\\mu)$。所有能量必须以电子伏特 (eV) 为单位，作为浮点数报告。此问题不涉及角度，因此不需要角度单位。距离单位为埃 (Å)。当本征值恰好等于 $\\mu$ 时，必须将其视为未占据，因为占据条件是严格的 $\\varepsilon_k  \\mu$。所有用例的自旋简并因子均为 $g_s = 2$。\n\n使用以下测试套件，所有数值参数以电子伏特 (eV) 和埃 (Å) 给出，$\\beta$ 参数以反埃 (Å$^{-1}$) 给出。在所有用例中，QM 内部键长为 $R_{C_1C_2}$，边界键如所示为 $R_{C_2H}$ 或 $R_{C_2C_{\\text{MM}}}$。\n\n测试用例 1（典型的共价距离，中等化学势）：\n- $\\varepsilon_C = 0.0$ eV, $\\varepsilon_H = -3.5$ eV, $\\Delta_{\\text{MM}} = +0.4$ eV\n- $R_{C_1C_2} = 1.54$ Å, $R_{C_2H} = 1.09$ Å, $R_{C_2C_{\\text{MM}}} = 1.54$ Å\n- $t_{0,CC} = -2.7$ eV, $\\beta_{CC} = 2.0$ Å$^{-1}$, $R^{\\text{ref}}_{CC} = 1.40$ Å\n- $t_{0,CH} = -3.2$ eV, $\\beta_{CH} = 2.5$ Å$^{-1}$, $R^{\\text{ref}}_{CH} = 1.10$ Å\n- $\\mu = -0.5$ eV\n\n测试用例 2（与 MM 碳的边界耦合较弱，化学势位于碳的在位能处）：\n- $\\varepsilon_C = 0.0$ eV, $\\varepsilon_H = -3.5$ eV, $\\Delta_{\\text{MM}} = +0.1$ eV\n- $R_{C_1C_2} = 1.54$ Å, $R_{C_2H} = 1.09$ Å, $R_{C_2C_{\\text{MM}}} = 2.20$ Å\n- $t_{0,CC} = -2.7$ eV, $\\beta_{CC} = 2.0$ Å$^{-1}$, $R^{\\text{ref}}_{CC} = 1.40$ Å\n- $t_{0,CH} = -3.2$ eV, $\\beta_{CH} = 2.5$ Å$^{-1}$, $R^{\\text{ref}}_{CH} = 1.10$ Å\n- $\\mu = 0.0$ eV\n\n测试用例 3（强边界耦合，MM 极化降低了 MM 碳能级）：\n- $\\varepsilon_C = 0.0$ eV, $\\varepsilon_H = -3.5$ eV, $\\Delta_{\\text{MM}} = -0.3$ eV\n- $R_{C_1C_2} = 1.54$ Å, $R_{C_2H} = 1.09$ Å, $R_{C_2C_{\\text{MM}}} = 1.34$ Å\n- $t_{0,CC} = -2.7$ eV, $\\beta_{CC} = 2.0$ Å$^{-1}$, $R^{\\text{ref}}_{CC} = 1.40$ Å\n- $t_{0,CH} = -3.2$ eV, $\\beta_{CH} = 2.5$ Å$^{-1}$, $R^{\\text{ref}}_{CH} = 1.10$ Å\n- $\\mu = -1.0$ eV\n\n测试用例 4（边界几乎断裂：极弱的 MM 耦合，化学势位于碳的在位能处）：\n- $\\varepsilon_C = 0.0$ eV, $\\varepsilon_H = -3.5$ eV, $\\Delta_{\\text{MM}} = 0.0$ eV\n- $R_{C_1C_2} = 1.54$ Å, $R_{C_2H} = 1.09$ Å, $R_{C_2C_{\\text{MM}}} = 3.00$ Å\n- $t_{0,CC} = -2.7$ eV, $\\beta_{CC} = 2.0$ Å$^{-1}$, $R^{\\text{ref}}_{CC} = 1.40$ Å\n- $t_{0,CH} = -3.2$ eV, $\\beta_{CH} = 2.5$ Å$^{-1}$, $R^{\\text{ref}}_{CH} = 1.10$ Å\n- $\\mu = 0.0$ eV\n\n测试用例 5（修改了连接键长和更高的化学势）：\n- $\\varepsilon_C = 0.0$ eV, $\\varepsilon_H = -2.0$ eV, $\\Delta_{\\text{MM}} = 0.0$ eV\n- $R_{C_1C_2} = 1.54$ Å, $R_{C_2H} = 1.50$ Å, $R_{C_2C_{\\text{MM}}} = 1.54$ Å\n- $t_{0,CC} = -2.7$ eV, $\\beta_{CC} = 2.0$ Å$^{-1}$, $R^{\\text{ref}}_{CC} = 1.40$ Å\n- $t_{0,CH} = -3.2$ eV, $\\beta_{CH} = 2.5$ Å$^{-1}$, $R^{\\text{ref}}_{CH} = 1.10$ Å\n- $\\mu = +1.0$ eV\n\n您的程序应生成单行输出，其中包含一个以逗号分隔的列表，并用方括号括起来的结果（例如，$[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5]$），其中每个条目是 $\\Delta E(\\mu)$ 的浮点值，单位为电子伏特 (eV)。每个浮点数应四舍五入到六位小数。不应打印任何其他输出。",
            "solution": "用户请求了一个计算化学问题的解决方案，具体是使用简化的紧束缚模型来量化减去法量子力学/分子力学 (QM/MM) 方案中的误差。\n\n### 步骤 1：问题验证\n\n首先，我将仔细验证问题陈述。\n\n#### 提取的已知条件\n- **模型**:\n    1.  **连接原子模型**：一个三位点系统 $C_1, C_2, H_{\\text{link}}$。哈密顿量 $H_{\\text{link}}$ 是一个 $3 \\times 3$ 的对称矩阵：\n        $$\n        H_{\\text{link}} = \\begin{pmatrix}\n        \\varepsilon_C  t_{CC}(R_{C_1C_2})  0 \\\\\n        t_{CC}(R_{C_1C_2})  \\varepsilon_C  t_{CH}(R_{C_2H}) \\\\\n        0  t_{CH}(R_{C_2H})  \\varepsilon_H\n        \\end{pmatrix}\n        $$\n    2.  **显式片段模型**：一个三位点系统 $C_1, C_2, C_{\\text{MM}}$。哈密顿量 $H_{\\text{exp}}$ 是一个 $3 \\times 3$ 的对称矩阵：\n        $$\n        H_{\\text{exp}} = \\begin{pmatrix}\n        \\varepsilon_C  t_{CC}(R_{C_1C2})  0 \\\\\n        t_{CC}(R_{C_1C_2})  \\varepsilon_C  t_{CC}(R_{C_2C_{\\text{MM}}}) \\\\\n        0  t_{CC}(R_{C_2C_{\\text{MM}}})  \\varepsilon_C + \\Delta_{\\text{MM}}\n        \\end{pmatrix}\n        $$\n- **在位能**：$\\varepsilon_C$ 和 $\\varepsilon_H$，单位为电子伏特 (eV)。\n- **MM 势位移**：$\\Delta_{\\text{MM}}$，单位为 eV。\n- **跃迁积分函数**：$t_{XY}(R) = t_{0,XY} \\exp\\left(-\\beta_{XY} \\left(R - R^{\\text{ref}}_{XY}\\right)\\right)$，其中 $R$ 的单位是埃 (Å)，$t_0$ 的单位是 eV，$\\beta$ 的单位是 Å$^{-1}$。\n- **QM 能量计算**：零温巨正则系综电子能量定义为 $E(\\mu; H) = g_s \\sum_{\\varepsilon_k(H)  \\mu} \\varepsilon_k(H)$，其中 $\\{\\varepsilon_k(H)\\}$ 是哈密顿量 $H$ 的本征值。\n- **自旋简并度**：$g_s = 2$。\n- **占据条件**：仅当本征态的能量 $\\varepsilon_k$ 严格小于化学势 $\\mu$ 时，该本征态才被占据。\n- **误差定义**：误差为 $\\Delta E(\\mu) = E(\\mu; H_{\\text{link}}) - E(\\mu; H_{\\text{exp}})$。\n- **参数**：提供了五个完整的测试用例，每个用例都指定了能量、距离、跃迁参数和化学势所需的所有数值。\n\n#### 使用提取的已知条件进行验证\n- **科学依据**：该问题基于紧束缚近似，这是固态物理和量子化学中的一个标准且有效的简化方法。其背景是 QM/MM 建模，这是计算化学的一个主要领域。连接原子、哈密顿量、作为能级的本征值以及巨正则系综能量等概念都是基础且应用正确的。该问题在科学上是合理的。\n- **适定性**：该问题是完全适定的。对于每个测试用例，所有参数都已定义。计算结果的步骤清晰明确：\n    1.  计算跃迁积分。\n    2.  构建两个 $3 \\times 3$ 矩阵。\n    3.  求每个矩阵的本征值。\n    4.  将严格小于 $\\mu$ 的本征值相加，并乘以 $g_s=2$。\n    5.  计算差值。\n    这个过程保证了一个唯一的、稳定的、有意义的数值答案。\n- **客观性**：该问题以精确、客观、数学化的语言陈述，没有任何主观性。\n- **缺陷清单**：该问题没有表现出任何列出的缺陷。它科学合理、可形式化、完整、现实、适定且并非无足轻重。条件 $\\varepsilon_k  \\mu$ 是一个关键细节，需要仔细实现，特别是当本征值可能与 $\\mu$ 相等时。\n\n#### 结论\n该问题是**有效的**。我将继续制定解决方案。\n\n### 步骤 2：解决方案制定\n\n任务是为五个给定的参数集计算能量差 $\\Delta E(\\mu) = E(\\mu; H_{\\text{link}}) - E(\\mu; H_{\\text{exp}})$。解决方案通过实现所描述的物理模型来推进。\n\n#### 算法设计\n每个测试用例的总体流程如下：\n1.  **计算跃迁积分**：对于每个需要的键，我们使用提供的指数公式计算跃迁积分 $t_{XY}$：\n    $$\n    t_{XY}(R) = t_{0,XY} \\exp\\left(-\\beta_{XY} \\left(R - R^{\\text{ref}}_{XY}\\right)\\right)\n    $$\n    我们需要计算 $t_{CC}(R_{C_1C_2})$、$t_{CH}(R_{C_2H})$ 和 $t_{CC}(R_{C_2C_{\\text{MM}}})$。\n\n2.  **构建哈密顿量**：我们通过将给定的在位能和计算出的跃迁积分代入其定义的矩阵形式，来组装两个 $3 \\times 3$ 的实对称哈密顿矩阵 $H_{\\text{link}}$ 和 $H_{\\text{exp}}$。令 $t_1 = t_{CC}(R_{C_1C_2})$，$t_{\\text{link}} = t_{CH}(R_{C_2H})$，以及 $t_{\\text{exp}} = t_{CC}(R_{C_2C_{\\text{MM}}})$。\n    $$\n    H_{\\text{link}} = \\begin{pmatrix}\n    \\varepsilon_C  t_1  0 \\\\\n    t_1  \\varepsilon_C  t_{\\text{link}} \\\\\n    0  t_{\\text{link}}  \\varepsilon_H\n    \\end{pmatrix}\n    $$\n    $$\n    H_{\\text{exp}} = \\begin{pmatrix}\n    \\varepsilon_C  t_1  0 \\\\\n    t_1  \\varepsilon_C  t_{\\text{exp}} \\\\\n    0  t_{\\text{exp}}  \\varepsilon_C + \\Delta_{\\text{MM}}\n    \\end{pmatrix}\n    $$\n\n3.  **计算本征值**：对于每个哈密顿矩阵，我们求出其三个实数本征值 $\\{\\varepsilon_k\\}$。由于矩阵是实对称的，这是一个标准的数值线性代数问题。我们可以将 $H_{\\text{link}}$ 的本征值集表示为 $\\{\\varepsilon_{k, \\text{link}}\\}$，将 $H_{\\text{exp}}$ 的本征值集表示为 $\\{\\varepsilon_{k, \\text{exp}}\\}$。\n\n4.  **计算巨正则系综能量**：对于每个模型，我们通过将所有严格小于化学势 $\\mu$ 的本征值相加，并乘以自旋简并因子 $g_s=2$，来计算总电子能量 $E(\\mu)$。\n    $$\n    E(\\mu; H_{\\text{link}}) = 2 \\sum_{\\varepsilon_{k, \\text{link}}  \\mu} \\varepsilon_{k, \\text{link}}\n    $$\n    $$\n    E(\\mu; H_{\\text{exp}}) = 2 \\sum_{\\varepsilon_{k, \\text{exp}}  \\mu} \\varepsilon_{k, \\text{exp}}\n    $$\n    严格不等式至关重要，必须正确处理，特别是在本征值可能等于 $\\mu$ 的情况下。\n\n5.  **计算能量误差**：最后一步是计算两种能量之间的差值，这代表了该模型中连接原子近似所引入的误差。\n    $$\n    \\Delta E(\\mu) = E(\\mu; H_{\\text{link}}) - E(\\mu; H_{\\text{exp}})\n    $$\n对于问题陈述中提供的所有五个测试用例，将重复此过程。最终结果将被收集并以指定格式呈现。实现将使用 `numpy` 库进行高效准确的矩阵运算，特别是使用 `numpy.linalg.eigvalsh` 来对厄米矩阵（在本例中为实对称矩阵）进行对角化。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the energy error due to link atom substitution in a subtractive QM/MM scheme\n    for a series of test cases using a tight-binding model.\n    \"\"\"\n\n    test_cases = [\n        {\n            # Test Case 1\n            \"params\": {\"eps_C\": 0.0, \"eps_H\": -3.5, \"delta_MM\": 0.4, \"mu\": -0.5},\n            \"geo\": {\"R_C1C2\": 1.54, \"R_C2H\": 1.09, \"R_C2CMM\": 1.54},\n            \"hopping_CC\": {\"t0\": -2.7, \"beta\": 2.0, \"Rref\": 1.40},\n            \"hopping_CH\": {\"t0\": -3.2, \"beta\": 2.5, \"Rref\": 1.10}\n        },\n        {\n            # Test Case 2\n            \"params\": {\"eps_C\": 0.0, \"eps_H\": -3.5, \"delta_MM\": 0.1, \"mu\": 0.0},\n            \"geo\": {\"R_C1C2\": 1.54, \"R_C2H\": 1.09, \"R_C2CMM\": 2.20},\n            \"hopping_CC\": {\"t0\": -2.7, \"beta\": 2.0, \"Rref\": 1.40},\n            \"hopping_CH\": {\"t0\": -3.2, \"beta\": 2.5, \"Rref\": 1.10}\n        },\n        {\n            # Test Case 3\n            \"params\": {\"eps_C\": 0.0, \"eps_H\": -3.5, \"delta_MM\": -0.3, \"mu\": -1.0},\n            \"geo\": {\"R_C1C2\": 1.54, \"R_C2H\": 1.09, \"R_C2CMM\": 1.34},\n            \"hopping_CC\": {\"t0\": -2.7, \"beta\": 2.0, \"Rref\": 1.40},\n            \"hopping_CH\": {\"t0\": -3.2, \"beta\": 2.5, \"Rref\": 1.10}\n        },\n        {\n            # Test Case 4\n            \"params\": {\"eps_C\": 0.0, \"eps_H\": -3.5, \"delta_MM\": 0.0, \"mu\": 0.0},\n            \"geo\": {\"R_C1C2\": 1.54, \"R_C2H\": 1.09, \"R_C2CMM\": 3.00},\n            \"hopping_CC\": {\"t0\": -2.7, \"beta\": 2.0, \"Rref\": 1.40},\n            \"hopping_CH\": {\"t0\": -3.2, \"beta\": 2.5, \"Rref\": 1.10}\n        },\n        {\n            # Test Case 5\n            \"params\": {\"eps_C\": 0.0, \"eps_H\": -2.0, \"delta_MM\": 0.0, \"mu\": 1.0},\n            \"geo\": {\"R_C1C2\": 1.54, \"R_C2H\": 1.50, \"R_C2CMM\": 1.54},\n            \"hopping_CC\": {\"t0\": -2.7, \"beta\": 2.0, \"Rref\": 1.40},\n            \"hopping_CH\": {\"t0\": -3.2, \"beta\": 2.5, \"Rref\": 1.10}\n        }\n    ]\n\n    results = []\n    g_s = 2.0  # Spin degeneracy factor\n\n    def hopping_integral(R, t0, beta, Rref):\n        \"\"\"Calculates the distance-dependent hopping integral.\"\"\"\n        return t0 * np.exp(-beta * (R - Rref))\n\n    def calculate_grand_canonical_energy(H, mu):\n        \"\"\"Calculates the zero-temperature grand-canonical electronic energy.\"\"\"\n        eigenvalues = np.linalg.eigvalsh(H)\n        occupied_energy = sum(eig for eig in eigenvalues if eig  mu)\n        return g_s * occupied_energy\n\n    for case in test_cases:\n        p = case[\"params\"]\n        g = case[\"geo\"]\n        h_cc = case[\"hopping_CC\"]\n        h_ch = case[\"hopping_CH\"]\n\n        # Calculate hopping integrals\n        t_C1C2 = hopping_integral(g[\"R_C1C2\"], h_cc[\"t0\"], h_cc[\"beta\"], h_cc[\"Rref\"])\n        t_C2H = hopping_integral(g[\"R_C2H\"], h_ch[\"t0\"], h_ch[\"beta\"], h_ch[\"Rref\"])\n        t_C2CMM = hopping_integral(g[\"R_C2CMM\"], h_cc[\"t0\"], h_cc[\"beta\"], h_cc[\"Rref\"])\n\n        # Construct H_link Hamiltonian\n        H_link = np.zeros((3, 3))\n        H_link[0, 0] = p[\"eps_C\"]\n        H_link[1, 1] = p[\"eps_C\"]\n        H_link[2, 2] = p[\"eps_H\"]\n        H_link[0, 1] = H_link[1, 0] = t_C1C2\n        H_link[1, 2] = H_link[2, 1] = t_C2H\n\n        # Construct H_exp Hamiltonian\n        H_exp = np.zeros((3, 3))\n        H_exp[0, 0] = p[\"eps_C\"]\n        H_exp[1, 1] = p[\"eps_C\"]\n        H_exp[2, 2] = p[\"eps_C\"] + p[\"delta_MM\"]\n        H_exp[0, 1] = H_exp[1, 0] = t_C1C2\n        H_exp[1, 2] = H_exp[2, 1] = t_C2CMM\n\n        # Calculate energies\n        E_link = calculate_grand_canonical_energy(H_link, p[\"mu\"])\n        E_exp = calculate_grand_canonical_energy(H_exp, p[\"mu\"])\n\n        # Calculate and store the error\n        delta_E = E_link - E_exp\n        results.append(round(delta_E, 6))\n    \n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}