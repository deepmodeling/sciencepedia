{
    "hands_on_practices": [
        {
            "introduction": "在力基耦合方案中，一个核心挑战是“幽灵力”（ghost force）的产生，它源于原子和连续介质区域之间非保守的力混合。本练习通过一个一维谐波链模型，从第一性原理出发，推导了这种非物理力的主导项表达式。通过分析计算，您将深入理解幽灵力是如何在应变场不均匀时，由原子应力与柯西-玻恩（Cauchy-Born）应力之间的不匹配以及混合函数的梯度共同产生的。",
            "id": "3760812",
            "problem": "考虑一个无限长的一维晶体链，其参考原子位置为 $X_{i} = i a$，其中 $a > 0$ 是晶格间距。该链具有直至次近邻的线性谐波对相互作用：每个最近邻键的刚度为 $k_{1} > 0$，静止长度为 $a$；每个次近邻键的刚度为 $k_{2} > 0$，静止长度为 $2 a$。设形变由一个光滑映射 $y(X)$ 给出，其形变梯度为 $F(X) = \\frac{d y}{d X}(X)$。假设 $F$ 在远大于 $a$ 的长度尺度上变化，因此关于 $a$ 的幂次的渐近泰勒展开是有效的。\n\n定义从Cauchy–Born能量密度得到的连续介质Cauchy–Born应力为 $\\sigma_{\\text{CB}}(X)$，并定义原子应力 $\\sigma_{\\text{A}}(X)$ 为穿过位置 $i$ 和 $i+1$ 之间键中切割面的Irving–Kirkwood牵引力，即穿过该切割面的所有键中作用力的总和。设 $b(X)$ 为一个光滑的混合函数，其在原子区域等于1，在连续介质区域等于0，并带有一个光滑的过渡区。\n\n准连续介质(QC)方法接受两种常见的耦合方式：\n- 基于能量的准连续介质(EQC)耦合，它以守恒方式混合应力，即 $\\sigma_{\\text{mix}}(X) = b(X) \\sigma_{\\text{A}}(X) + \\bigl(1 - b(X)\\bigr) \\sigma_{\\text{CB}}(X)$，并通过 $f_{\\text{EQC}}(X) = - \\frac{d}{d X} \\sigma_{\\text{mix}}(X)$ 定义力。\n- 基于力的准连续介质(QCF)耦合，它以非守恒方式混合节点力残差，即 $f_{\\text{QCF}}(X) = b(X) f_{\\text{A}}(X) + \\bigl(1 - b(X)\\bigr) f_{\\text{CB}}(X)$，其中 $f_{\\text{A}}(X) = - \\frac{d}{d X} \\sigma_{\\text{A}}(X)$ 且 $f_{\\text{CB}}(X) = - \\frac{d}{d X} \\sigma_{\\text{CB}}(X)$。\n\n从静力平衡下的牛顿第二定律($f(X) = 0$)、一维链的Irving–Kirkwood牵引力定义以及谐波对相互作用的Cauchy–Born法则出发，推导在光滑变化的应变场中由非守恒力混合产生的局部QCF应力误差的领头阶渐近表达式。此处，该误差定义为QCF残差与混合应力散度之间的不匹配，\n$$\n\\mathcal{E}_{\\text{QCF}}(X) := f_{\\text{QCF}}(X) + \\frac{d}{d X} \\sigma_{\\text{mix}}(X),\n$$\n该表达式用 $a$、$k_{1}$、$k_{2}$、$b'(X)$ 以及 $F(X)$ 的导数表示，并截断至 $a$ 的最低非零阶。然后，计算类似定义的EQC耦合误差的相应领头阶表达式\n$$\n\\mathcal{E}_{\\text{EQC}}(X) := f_{\\text{EQC}}(X) + \\frac{d}{d X} \\sigma_{\\text{mix}}(X),\n$$\n并比较两者。\n\n你的最终答案必须是 $\\mathcal{E}_{\\text{QCF}}(X) - \\mathcal{E}_{\\text{EQC}}(X)$ 在 $a$ 的领头阶上的单个闭式解析表达式，用 $a$、$k_{1}$、$k_{2}$、$b'(X)$ 和 $F(X)$ 的导数表示。无需进行数值计算。如果引入任何量，请明确定义它们。除了光滑性和相对于 $a$ 的缓慢变化外，不要对 $F(X)$ 或 $b(X)$ 的形式做任何特殊假设。在方框内以无单位形式表达最终答案。",
            "solution": "用户希望推导基于力的(QCF)和基于能量的(EQC)准连续介质方法之间耦合误差之差 $\\mathcal{E}_{\\text{QCF}}(X) - \\mathcal{E}_{\\text{EQC}}(X)$ 的领头阶表达式。\n\n问题为误差项提供了以下定义：\n$$\n\\mathcal{E}_{\\text{QCF}}(X) := f_{\\text{QCF}}(X) + \\frac{d}{d X} \\sigma_{\\text{mix}}(X)\n$$\n$$\n\\mathcal{E}_{\\text{EQC}}(X) := f_{\\text{EQC}}(X) + \\frac{d}{d X} \\sigma_{\\text{mix}}(X)\n$$\n其中混合应力 $\\sigma_{\\text{mix}}(X)$ 和耦合力 $f_{\\text{EQC}}(X)$ 及 $f_{\\text{QCF}}(X)$ 定义为：\n$$\n\\sigma_{\\text{mix}}(X) = b(X) \\sigma_{\\text{A}}(X) + \\bigl(1 - b(X)\\bigr) \\sigma_{\\text{CB}}(X)\n$$\n$$\nf_{\\text{EQC}}(X) = - \\frac{d}{d X} \\sigma_{\\text{mix}}(X)\n$$\n$$\nf_{\\text{QCF}}(X) = b(X) f_{\\text{A}}(X) + \\bigl(1 - b(X)\\bigr) f_{\\text{CB}}(X)\n$$\n原子力和连续介质力定义为它们各自应力的负散度：\n$$\nf_{\\text{A}}(X) = - \\frac{d}{d X} \\sigma_{\\text{A}}(X)\n$$\n$$\nf_{\\text{CB}}(X) = - \\frac{d}{d X} \\sigma_{\\text{CB}}(X)\n$$\n首先，我们分析基于能量的耦合误差 $\\mathcal{E}_{\\text{EQC}}(X)$。通过将 $f_{\\text{EQC}}(X)$ 的定义代入 $\\mathcal{E}_{\\text{EQC}}(X)$ 的表达式中：\n$$\n\\mathcal{E}_{\\text{EQC}}(X) = \\left( - \\frac{d}{d X} \\sigma_{\\text{mix}}(X) \\right) + \\frac{d}{d X} \\sigma_{\\text{mix}}(X) = 0\n$$\n这个结果是定义性的。EQC耦合的构造是守恒的，意味着力场恰好是某个能量泛函的负梯度，而该泛函对应的应力是 $\\sigma_{\\text{mix}}(X)$。因此，如此定义的误差恒为零。\n\n接下来，我们分析基于力的耦合误差 $\\mathcal{E}_{\\text{QCF}}(X)$。我们代入 $f_{\\text{QCF}}(X)$、$f_{\\text{A}}(X)$ 和 $f_{\\text{CB}}(X)$ 的定义：\n$$\n\\mathcal{E}_{\\text{QCF}}(X) = \\left( b(X) \\left[- \\frac{d \\sigma_{\\text{A}}}{d X}\\right] + \\bigl(1 - b(X)\\bigr) \\left[- \\frac{d \\sigma_{\\text{CB}}}{d X}\\right] \\right) + \\frac{d}{d X} \\sigma_{\\text{mix}}(X)\n$$\n现在，我们使用乘法法则展开混合应力 $\\sigma_{\\text{mix}}(X) = b(X) \\sigma_{\\text{A}}(X) + (1-b(X)) \\sigma_{\\text{CB}}(X)$ 的导数：\n$$\n\\frac{d}{d X} \\sigma_{\\text{mix}}(X) = \\frac{d}{d X} \\left[ b(X) (\\sigma_{\\text{A}}(X) - \\sigma_{\\text{CB}}(X)) + \\sigma_{\\text{CB}}(X) \\right]\n$$\n$$\n\\frac{d}{d X} \\sigma_{\\text{mix}}(X) = \\frac{d b}{d X} (\\sigma_{\\text{A}}(X) - \\sigma_{\\text{CB}}(X)) + b(X) \\left(\\frac{d \\sigma_{\\text{A}}}{d X} - \\frac{d \\sigma_{\\text{CB}}}{d X}\\right) + \\frac{d \\sigma_{\\text{CB}}}{d X}\n$$\n我们用撇号表示关于 $X$ 的导数，例如 $b' = db/dX$。\n$$\n\\sigma'_{\\text{mix}} = b' (\\sigma_{\\text{A}} - \\sigma_{\\text{CB}}) + b (\\sigma'_{\\text{A}} - \\sigma'_{\\text{CB}}) + \\sigma'_{\\text{CB}}\n$$\n将此代回 $\\mathcal{E}_{\\text{QCF}}(X)$ 的表达式中：\n$$\n\\mathcal{E}_{\\text{QCF}}(X) = \\left( -b \\sigma'_{\\text{A}} - (1-b)\\sigma'_{\\text{CB}} \\right) + \\left( b' (\\sigma_{\\text{A}} - \\sigma_{\\text{CB}}) + b \\sigma'_{\\text{A}} - b \\sigma'_{\\text{CB}} + \\sigma'_{\\text{CB}} \\right)\n$$\n合并各项：\n$$\n\\mathcal{E}_{\\text{QCF}}(X) = (-b \\sigma'_{\\text{A}} + b \\sigma'_{\\text{A}}) + (-\\sigma'_{\\text{CB}} + b \\sigma'_{\\text{CB}} - b \\sigma'_{\\text{CB}} + \\sigma'_{\\text{CB}}) + b' (\\sigma_{\\text{A}} - \\sigma_{\\text{CB}})\n$$\n除一项外，所有项都抵消了：\n$$\n\\mathcal{E}_{\\text{QCF}}(X) = b'(X) \\bigl( \\sigma_{\\text{A}}(X) - \\sigma_{\\text{CB}}(X) \\bigr)\n$$\n这是非守恒耦合方案中著名的伪“鬼力”表达式。为了找到其领头阶表达式，我们必须求出原子应力 $\\sigma_{\\text{A}}(X)$ 和Cauchy-Born应力 $\\sigma_{\\text{CB}}(X)$ 之间的领头阶差异。\n\n**1. Cauchy–Born应力 $\\sigma_{\\text{CB}}(X)$**\n在均匀形变梯度 $F$ 下，每个原子的势能是通过对其发出的键的能量求和得到的，每个键带有一个 $1/2$ 的因子以避免重复计算。\n$$\nE_{\\text{atom}}(F) = \\frac{1}{2} k_1 (aF-a)^2 + \\frac{1}{2} k_2 (2aF-2a)^2 = \\frac{1}{2} a^2 (k_1 + 4k_2) (F-1)^2\n$$\nCauchy-Born能量密度 $W_{\\text{CB}}(F)$ 是单位参考长度的能量，$W_{\\text{CB}}(F) = E_{\\text{atom}}(F)/a$。\n$$\nW_{\\text{CB}}(F) = \\frac{1}{2} a (k_1+4k_2)(F-1)^2\n$$\n应力（第一Piola-Kirchhoff应力）是能量密度对形变梯度的导数：\n$$\n\\sigma_{\\text{CB}}(F) = \\frac{d W_{\\text{CB}}}{dF} = a (k_1+4k_2)(F-1)\n$$\n因此，对于一个缓慢变化的场 $F(X)$，有 $\\sigma_{\\text{CB}}(X) = a(k_1+4k_2)(F(X)-1)$。\n\n**2. 原子应力 $\\sigma_{\\text{A}}(X)$**\n在键中切割面 $X = (i+1/2)a$ 处的原子应力 $\\sigma_{\\text{A}}(X)$ 是所有穿过该平面的键中的力（张力）的总和。这些键是最近邻键 $(i, i+1)$ 和次近邻键 $(i, i+2)$ 及 $(i-1, i+1)$。\n$$\n\\sigma_{\\text{A}}(X) = k_1(y_{i+1} - y_i - a) + k_2(y_{i+2} - y_i - 2a) + k_2(y_{i+1} - y_{i-1} - 2a)\n$$\n我们围绕评估点 $X_c = (i+1/2)a$ 对光滑位移场 $y(X)$ 进行泰勒级数展开。设 $y^{(n)} = d^n y / dX^n$。\n原子位置为 $X_i = X_c-a/2$, $X_{i+1} = X_c+a/2$, $X_{i-1} = X_c-3a/2$, $X_{i+2} = X_c+3a/2$。\n位置差展开为：\n$y_{i+1} - y_{i} = y(X_c+\\frac{a}{2}) - y(X_c-\\frac{a}{2}) = a y'(X_c) + \\frac{a^3}{24} y'''(X_c) + \\mathcal{O}(a^5)$\n$y_{i+2} - y_{i} = y(X_c+\\frac{3a}{2}) - y(X_c-\\frac{a}{2}) = 2a y'(X_c) + a^2 y''(X_c) + \\frac{7a^3}{12} y'''(X_c) + \\mathcal{O}(a^4)$\n$y_{i+1} - y_{i-1} = y(X_c+\\frac{a}{2}) - y(X_c-\\frac{3a}{2}) = 2a y'(X_c) - a^2 y''(X_c) + \\frac{7a^3}{12} y'''(X_c) + \\mathcal{O}(a^4)$\n\n将这些代入 $\\sigma_{\\text{A}}(X_c)$ 的表达式，并使用 $F(X) = y'(X)$, $F'(X)=y''(X)$, $F''(X)=y'''(X)$：\n$$\n\\sigma_{\\text{A}}(X) = k_1 \\left( aF + \\frac{a^3}{24}F'' - a \\right) + k_2 \\left( 2aF + a^2 F' + \\frac{7a^3}{12}F'' - 2a \\right) + k_2 \\left( 2aF - a^2 F' + \\frac{7a^3}{12}F'' - 2a \\right) + \\mathcal{O}(a^5)\n$$\n按 $a$ 的幂次和 $F$ 的导数对各项进行分组：\n$$\n\\sigma_{\\text{A}}(X) = a(k_1 + 2k_2 + 2k_2)(F-1) + a^2(k_2 - k_2)F' + a^3\\left(\\frac{k_1}{24} + \\frac{7k_2}{12} + \\frac{7k_2}{12}\\right)F'' + \\mathcal{O}(a^5)\n$$\n$$\n\\sigma_{\\text{A}}(X) = a(k_1+4k_2)(F-1) + a^3\\left(\\frac{k_1}{24} + \\frac{14k_2}{12}\\right)F'' + \\mathcal{O}(a^5)\n$$\n第一项恰好是 $\\sigma_{\\text{CB}}(X)$。简化第二项得到：\n$$\n\\sigma_{\\text{A}}(X) = \\sigma_{\\text{CB}}(X) + a^3\\left(\\frac{k_1}{24} + \\frac{7k_2}{6}\\right)F''(X) + \\mathcal{O}(a^5)\n$$\n\n**3. 最终误差计算**\n我们现在可以找到应力差的领头阶表达式：\n$$\n\\sigma_{\\text{A}}(X) - \\sigma_{\\text{CB}}(X) = a^3\\left(\\frac{k_1}{24} + \\frac{7k_2}{6}\\right)F''(X) + \\mathcal{O}(a^5)\n$$\n我们感兴趣的量是 $\\mathcal{E}_{\\text{QCF}}(X) - \\mathcal{E}_{\\text{EQC}}(X)$。由于 $\\mathcal{E}_{\\text{EQC}}(X)=0$，这恰好就是 $\\mathcal{E}_{\\text{QCF}}(X)$。\n$$\n\\mathcal{E}_{\\text{QCF}}(X) = b'(X) \\bigl( \\sigma_{\\text{A}}(X) - \\sigma_{\\text{CB}}(X) \\bigr)\n$$\n代入领头阶应力差：\n$$\n\\mathcal{E}_{\\text{QCF}}(X) = b'(X) \\left[ a^3\\left(\\frac{k_1}{24} + \\frac{7k_2}{6}\\right)F''(X) + \\mathcal{O}(a^5) \\right]\n$$\n领头阶项的阶数为 $a^3$。因此，所求的表达式是：\n$$\n\\mathcal{E}_{\\text{QCF}}(X) - \\mathcal{E}_{\\text{EQC}}(X) = a^3 b'(X) F''(X) \\left(\\frac{k_1}{24} + \\frac{7k_2}{6}\\right)\n$$\n该表达式表示在QCF模拟的混合区域中产生的伪力，它与混合函数 $b'(X)$ 的梯度、位移场 $y'''(X) = F''(X)$ 的三阶导数以及晶格参数 $a^3$ 的立方成正比。这个力是来自不同物理模型（原子和连续介质）的力进行非守恒混合的直接后果。",
            "answer": "$$\\boxed{a^{3} b'(X) F''(X) \\left(\\frac{k_{1}}{24} + \\frac{7k_{2}}{6}\\right)}$$"
        },
        {
            "introduction": "理论上理解幽灵力的来源后，下一步是在实际的数值模拟中诊断并量化它们。本练习将指导您设计并实现一个数值“补丁测试”（patch test），这是验证多尺度耦合方案一致性的标准方法。通过在一个施加了均匀应变的简化一维晶格模型中计算界面原子上的残余力，您将学会如何识别因模型不一致而产生的非物理力，并将其与理想情况（零残余力）进行比较。",
            "id": "3760785",
            "problem": "你的任务是设计并实现一种数值诊断方法，用于检测多尺度建模中使用的一维基于力的耦合方案中的鬼力。考虑一个由$N$个原子组成的一维晶格，其位置为 $x_i = i\\,a$，$i \\in \\{0,1,\\dots,N-1\\}$，其中 $a$ 是晶格间距。最近邻相互作用由刚度为 $k$、参考长度为 $a$ 的线性弹簧建模。施加一个均匀位移场 $u(x) = \\epsilon x$，其中 $\\epsilon$ 是一个 MACHINIST 小应变参数。在一个物理上一致的基于力的耦合方法（例如，准连续介质力基方法 (QCF)）中，残余力在均匀应变测试（也称为补丁测试）下应为零。然而，在原子-连续介质界面处不一致的处理会引入非物理力，通常称为鬼力。\n\n从牛顿第二定律和线性弹簧的胡克定律出发，将原子 $i$ 上的合力定义为其最近邻原子对其施加的弹簧力的总和。对于刚度为 $k_{i,i+1}$ 的原子 $i$ 和 $i+1$ 之间的一个键，其弹簧力的贡献取决于伸长量 $(u_{i+1} - u_i)$。考虑一个位于索引 $I$ 和 $I+1$ 之间的原子区和连续介质区之间的界面。通过将界面键的刚度乘以一个因子 $s$ 来模拟一个潜在的不一致性，即 $k_{I,I+1} = s\\,k$，同时保持所有其他键的刚度等于 $k$。\n\n将残余界面力矢量 $\\mathbf{r}$ 定义为界面相邻两个原子上的合力矢量，即 $\\mathbf{r} = [f_I, f_{I+1}]^\\top$，其中 $f_I$ 和 $f_{I+1}$ 分别是原子 $I$ 和 $I+1$ 上的合力。你的诊断程序必须在给定的均匀位移场 $u_i = \\epsilon x_i$ 下计算欧几里得范数 $\\|\\mathbf{r}\\|_2$。\n\n你的程序应该：\n- 从第一性原理出发，仅使用最近邻弹簧模型和指定的界面修正 $k_{I,I+1} = s\\,k$ 来实现 $f_I$ 和 $f_{I+1}$ 的计算。\n- 构建 $\\mathbf{r}$ 并计算 $\\|\\mathbf{r}\\|_2$。\n- 使用无量纲量（不需要物理单位），并假设开放边界，但仅计算界面原子 $I$ 和 $I+1$ 上的力，以避免边界伪影。\n- 陈述一致性的可接受阈值：对于一个无鬼力的耦合，数值舍入误差是产生非零残余的唯一来源。一个可接受的绝对阈值是\n$$\n\\tau_{\\mathrm{abs}} = c_{\\mathrm{tol}}\\, k\\, a\\, |\\epsilon|\\, \\sqrt{2},\n$$\n其中 $c_{\\mathrm{tol}} = 10^{-10}$。如果 $\\|\\mathbf{r}\\|_2 \\le \\tau_{\\mathrm{abs}}$，则方案通过诊断。\n\n测试套件：\n为以下参数集计算 $\\|\\mathbf{r}\\|_2$，每个参数集以 $(N,a,k,\\epsilon,I,s)$ 的形式给出：\n- 情况A（一般不一致界面）：$(100,\\, 1,\\, 5,\\, 10^{-3},\\, 49,\\, 0.9)$。\n- 情况B（一致界面）：$(100,\\, 1,\\, 5,\\, 10^{-3},\\, 49,\\, 1)$。\n- 情况C（不同尺度，不一致）：$(50,\\, 0.5,\\, 3,\\, 2\\times 10^{-4},\\, 20,\\, 1.3)$。\n- 情况D（零应变边界情况）：$(60,\\, 1,\\, 2,\\, 0,\\, 30,\\, 1.5)$。\n\n最终输出格式：\n- 你的程序应生成单行输出，包含四个结果 $\\left[\\|\\mathbf{r}\\|_2^{(A)}, \\|\\mathbf{r}\\|_2^{(B)}, \\|\\mathbf{r}\\|_2^{(C)}, \\|\\mathbf{r}\\|_2^{(D)}\\right]$，这是一个用方括号括起来的逗号分隔列表，按 A–D 的顺序排列，每个条目都打印为浮点数。",
            "solution": "问题陈述已经过严格审查，并被确定为有效。该问题在科学上基于固体力学和多尺度建模的原理，是良定的，并提供了一套完整且一致的定义和参数。任务是推导并实现一种诊断方法，用于检测原子-连续介质界面上的非物理“鬼”力。\n\n该诊断方法的核心是计算作用在界面相邻原子上的残余力矢量 $\\mathbf{r}$ 的欧几里得范数 $\\|\\mathbf{r}\\|_2$。所考虑的系统是一个由 $N$ 个原子组成的一维晶格。原子 $i$ 的平衡位置是 $x_i = i\\,a$，其中 $a$ 是晶格常数。原子通过刚度为 $k$、参考长度为 $a$ 的最近邻线性弹簧相互作用。施加一个均匀位移场 $u(x) = \\epsilon x$，这导致每个原子 $i$ 产生位移 $u_i = \\epsilon x_i = \\epsilon i a$。\n\n原子 $i$ 上的合力来自于连接它与其邻居 $i-1$ 和 $i+1$ 的弹簧。设原子 $j$ 位移后的位置为 $x'_j = x_j + u_j$。根据胡克定律，连接原子 $i$ 和 $i+1$ 的弹簧对原子 $i$ 施加的力与弹簧超出其参考长度 $a$ 的伸长量成正比。从原子 $i$ 指向 $i+1$ 的矢量方向为正方向。该弹簧对原子 $i$ 的力为 $F_{i \\leftarrow i+1} = k_{i,i+1} ( (x'_{i+1} - x'_i) - a )$。类似地，连接原子 $i$ 和 $i-1$ 的弹簧对原子 $i$ 的力为 $F_{i \\leftarrow i-1} = -k_{i-1,i} ( (x'_i - x'_{i-1}) - a )$。\n\n对于 $i \\in \\{1, \\dots, N-2\\}$，原子 $i$ 上的合力是这些贡献的总和：\n$$\nf_i = F_{i \\leftarrow i+1} + F_{i \\leftarrow i-1} = k_{i,i+1} \\left( (x'_{i+1} - x'_i) - a \\right) - k_{i-1,i} \\left( (x'_i - x'_{i-1}) - a \\right)\n$$\n我们可以用位移 $u_j$ 来表示核间距的变化：\n$$\n(x'_{j+1} - x'_j) - a = ( (x_{j+1} + u_{j+1}) - (x_j + u_j) ) - a = ( (x_{j+1} - x_j) + (u_{j+1} - u_j) ) - a\n$$\n由于初始晶格间距为 $x_{j+1} - x_j = (j+1)a - ja = a$，该表达式简化为：\n$$\n(x'_{j+1} - x'_j) - a = (a + (u_{j+1} - u_j)) - a = u_{j+1} - u_j\n$$\n将此代回力方程，得到以位移场表示的原子 $i$ 上合力的通用表达式：\n$$\nf_i = k_{i,i+1} (u_{i+1} - u_i) - k_{i-1,i} (u_i - u_{i-1})\n$$\n问题给定了一个均匀位移场 $u_j = \\epsilon j a$。因此，任意两个相邻原子之间的位移差是恒定的：\n$$\nu_{j+1} - u_j = \\epsilon(j+1)a - \\epsilon j a = \\epsilon a (j+1 - j) = \\epsilon a\n$$\n将这个恒定的差值代入力方程，得出：\n$$\nf_i = k_{i,i+1} (\\epsilon a) - k_{i-1,i} (\\epsilon a) = \\epsilon a (k_{i,i+1} - k_{i-1,i})\n$$\n这个方程揭示了，对于一个所有弹簧刚度都相等（$k_{i,i+1} = k_{i-1,i} = k$）的均匀晶格，任何原子上的合力都是 $f_i = \\epsilon a (k - k) = 0$。这是补丁测试的预期结果：均匀应变不应在均匀材料中引起合力。\n\n当模型中存在不一致性时，就会产生鬼力。在这里，不一致性位于原子 $I$ 和 $I+1$ 之间的界面处，该处的弹簧刚度被修改为 $k_{I,I+1} = s k$。所有其他弹簧保留常规刚度 $k$。\n\n我们现在计算界面两侧原子上的残余力 $f_I$ 和 $f_{I+1}$。\n对于原子 $I$，相关的刚度是 $k_{I,I+1} = s k$（在其右侧）和 $k_{I-1,I} = k$（在其左侧）。其合力为：\n$$\nf_I = \\epsilon a (k_{I,I+1} - k_{I-1,I}) = \\epsilon a (s k - k) = k \\epsilon a (s-1)\n$$\n对于原子 $I+1$，相关的刚度是 $k_{I+1,I+2} = k$（在其右侧）和 $k_{I,I+1} = s k$（在其左侧）。其合力为：\n$$\nf_{I+1} = \\epsilon a (k_{I+1,I+2} - k_{I,I+1}) = \\epsilon a (k - s k) = k \\epsilon a (1-s)\n$$\n这些非零力 $f_I$ 和 $f_{I+1}$ 就是鬼力。注意 $f_I = -f_{I+1}$，在界面处形成一个力偶极子，这与牛顿第三定律的预期相符。\n\n残余界面力矢量为 $\\mathbf{r} = [f_I, f_{I+1}]^\\top$。诊断量是其欧几里得范数 $\\|\\mathbf{r}\\|_2$：\n$$\n\\|\\mathbf{r}\\|_2 = \\sqrt{f_I^2 + f_{I+1}^2} = \\sqrt{(k \\epsilon a (s-1))^2 + (k \\epsilon a (1-s))^2}\n$$\n由于 $(1-s)^2 = (-(s-1))^2 = (s-1)^2$，该表达式变为：\n$$\n\\|\\mathbf{r}\\|_2 = \\sqrt{(k \\epsilon a (s-1))^2 + (k \\epsilon a (s-1))^2} = \\sqrt{2 (k \\epsilon a (s-1))^2}\n$$\n开平方根后得到鬼力诊断的最终公式：\n$$\n\\|\\mathbf{r}\\|_2 = \\sqrt{2} |k \\epsilon a (s-1)|\n$$\n由于 $k > 0$ 且 $a > 0$，我们可以将其写为：\n$$\n\\|\\mathbf{r}\\|_2 = \\sqrt{2}\\, k\\, a\\, |\\epsilon (s-1)|\n$$\n这个推导出的公式是为指定的测试用例实现的。它正确地表明，如果耦合是一致的（$s=1$）或者系统未应变（$\\epsilon=0$），残余力就会消失。参数 $N$ 和 $I$ 没有出现在最终公式中，因为均匀应变和不一致性的局域化使得结果与系统大小或界面位置无关，前提是界面不在区域的边界上。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Euclidean norm of the residual interfacial force vector\n    to detect ghost forces in a 1D multiscale model.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (N, a, k, epsilon, I, s)\n    test_cases = [\n        # Case A (general inconsistent interface)\n        (100, 1.0, 5.0, 1e-3, 49, 0.9),\n        # Case B (consistent interface)\n        (100, 1.0, 5.0, 1e-3, 49, 1.0),\n        # Case C (different scales, inconsistent)\n        (50, 0.5, 3.0, 2e-4, 20, 1.3),\n        # Case D (zero strain edge case)\n        (60, 1.0, 2.0, 0.0, 30, 1.5),\n    ]\n\n    results = []\n\n    # The derived formula for the Euclidean norm of the residual force vector is:\n    # ||r||_2 = sqrt(2) * k * a * |epsilon * (s - 1)|\n    # Parameters N and I are not needed for this specific calculation, as the\n    # residual force depends only on local properties at the interface under\n    # uniform strain.\n\n    for case in test_cases:\n        _N, a, k, epsilon, _I, s = case\n        \n        # Calculate the norm of the residual force vector using the derived formula.\n        residual_norm = np.sqrt(2) * k * a * abs(epsilon * (s - 1))\n        results.append(residual_norm)\n\n    # Final print statement in the exact required format.\n    # The map(str, results) converts each float result to its string representation.\n    # The ','.join(...) concatenates these strings with a comma separator.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "除了确保物理一致性（如消除幽灵力），实现稳定高效的动态模拟是力基耦合的另一大挑战。不同尺度模型的耦合往往会引入数值刚度（stiffness），限制了显式时间积分方法的稳定性。本练习通过分析一个简化的耦合系统（SPH-FEM），让您推导显式欧拉积分格式的最大稳定时间步长，从而揭示耦合系数和材料参数如何直接影响模拟的时间步长限制。",
            "id": "3760758",
            "problem": "考虑在简单剪切流下，光滑粒子流体动力学（SPH）与有限元法（FEM）之间基于力的最小耦合的线性稳定性。光滑粒子流体动力学（SPH）和有限元法（FEM）通过一个界面耦合，界面上作用着大小相等、方向相反的界面力，该力惩罚跨界面的剪切速度失配。专注于一个代表性的界面对，该界面对由一个SPH粒子剪切速度自由度和一个同位的FEM节点剪切速度自由度组成，分别表示为 $u(t)$ 和 $v(t)$。假设一个具有恒定剪切率 $\\dot{\\gamma}$ 的基础简单剪切流，并分析围绕该基础流的小扰动 $(u,v)$ 的线性化动力学。在随动坐标系中进行分析，以便基础流的平流不会显式地进入这些扰动的线性化算子。\n\n假设以下源自牛顿第二定律的、具有物理动机的模型。与SPH和FEM自由度相关的集总质量为 $m_{s}>0$ 和 $m_{f}>0$。对于波数 $k>0$ 的单个剪切傅里叶模式，在每个子域中的主阶内部（粘性）力是线性的，其形式对于SPH为 $- \\mu_{s} k^{2} u$，对于FEM为 $- \\mu_{f} k^{2} v$，其中 $\\mu_{s}>0$ 和 $\\mu_{f}>0$ 是有效粘性系数。界面力被建模为一个线性惩罚项，以基于力的方式强制速度连续性：SPH自由度受到 $- \\kappa (u - v)$ 的力，而FEM自由度受到 $+ \\kappa (u - v)$ 的力，其中耦合系数 $\\kappa>0$。因此，线性化的齐次扰动动力学为\n$$\nm_{s} \\,\\frac{d u}{d t} \\;=\\; - \\mu_{s} k^{2} \\, u \\;-\\; \\kappa (u - v), \n\\qquad\nm_{f} \\,\\frac{d v}{d t} \\;=\\; - \\mu_{f} k^{2} \\, v \\;+\\; \\kappa (u - v).\n$$\n\n您将分析应用于此耦合系统的显式前向欧拉时间积分器的稳定性。定义状态向量 $y(t) = \\begin{pmatrix} u(t) \\\\ v(t) \\end{pmatrix}$ 并将系统写成 $\\dot{y} = A y$ 的形式，识别出依赖于参数 $(m_{s}, m_{f}, \\mu_{s}, \\mu_{f}, k, \\kappa)$ 的常数 $2 \\times 2$ 矩阵 $A$。然后，通过评估与前向欧拉稳定性相关的离散算子的特征值（对于这个线性时不变系统，等价于 $A$ 的特征值），确定一个保证该耦合系统的前向欧拉方法线性稳定性的最大时间步长的闭式解析表达式。假设所有参数都严格为正，并且系统在没有额外稳定化的情况下进行积分。\n\n请以 $m_{s}, m_{f}, \\mu_{s}, \\mu_{f}, k$ 和 $\\kappa$ 的形式，给出最大稳定时间步长 $\\Delta t_{\\max}$ 的单个闭式表达式。在您的最终方框答案中不要包含单位。不需要进行数值评估；期望得到一个精确的解析表达式。",
            "solution": "用户要求分析基于力的耦合系统的线性稳定性，并推导前向欧拉法的最大稳定时间步长。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件：**\n- 系统包含两个自由度，一个SPH粒子剪切速度 $u(t)$ 和一个FEM节点剪切速度 $v(t)$。\n- 小扰动 $(u, v)$ 的线性化动力学由以下耦合常微分方程（ODE）给出：\n$$ m_{s} \\,\\frac{d u}{d t} \\;=\\; - \\mu_{s} k^{2} \\, u \\;-\\; \\kappa (u - v) $$\n$$ m_{f} \\,\\frac{d v}{d t} \\;=\\; - \\mu_{f} k^{2} \\, v \\;+\\; \\kappa (u - v) $$\n- 参数为：\n    - 集总质量：$m_{s} > 0$, $m_{f} > 0$。\n    - 有效粘性系数：$\\mu_{s} > 0$, $\\mu_{f} > 0$。\n    - 波数：$k > 0$。\n    - 耦合系数：$\\kappa > 0$。\n- 任务是分析该系统显式前向欧拉时间积分器的稳定性。\n- 状态向量定义为 $y(t) = \\begin{pmatrix} u(t) \\\\ v(t) \\end{pmatrix}$。\n- 目标是根据给定参数，找到最大稳定时间步长 $\\Delta t_{\\max}$ 的闭式解析表达式。\n\n**1.2. 依据标准进行验证：**\n- **科学性：** 该问题提出了一个耦合物理系统（SPH-FEM）的线性化模型，这是多尺度建模中的一种标准方法。方程表示了具有线性粘性力和惩罚力的牛顿第二定律。对此类系统的数值方法进行稳定性分析是计算科学与工程中的一个基本课题。其前提在物理上和数学上都是合理的。\n- **适定性：** 该问题是适定的。它指定了一个线性时不变常微分方程组，并要求解一个标准数值积分器（前向欧拉法）的稳定性极限。所有必需的参数都已定义，且其正性确保了系统的非退化性。存在一个唯一的、有意义的 $\\Delta t_{\\max}$ 解，并且可以被推导出来。\n- **客观性：** 问题以精确、无偏见和正式的语言陈述。所有术语都得到了清晰的定义。\n- **结论：** 该问题是有效的。它在科学上是合理的，是适定的，并且是客观的。它不包含任何矛盾、歧义或致命缺陷。\n\n### 步骤 2：求解推导\n\n分析过程首先将常微分方程组重写为标准矩阵形式 $\\dot{y} = A y$，然后基于系统矩阵 $A$ 的特征值来确定前向欧拉法的稳定性极限。\n\n给定的方程组是：\n$$ m_{s} \\frac{du}{dt} = - (\\mu_{s} k^{2} + \\kappa) u + \\kappa v $$\n$$ m_{f} \\frac{dv}{dt} = \\kappa u - (\\mu_{f} k^{2} + \\kappa) v $$\n\n等式两边分别除以各自的质量，我们得到 $\\dot{y} = A y$ 形式的系统：\n$$ \\frac{d}{dt} \\begin{pmatrix} u \\\\ v \\end{pmatrix} = \\begin{pmatrix} -\\frac{\\mu_{s} k^{2} + \\kappa}{m_{s}} & \\frac{\\kappa}{m_{s}} \\\\ \\frac{\\kappa}{m_{f}} & -\\frac{\\mu_{f} k^{2} + \\kappa}{m_{f}} \\end{pmatrix} \\begin{pmatrix} u \\\\ v \\end{pmatrix} $$\n\n因此，系统矩阵 $A$ 为：\n$$ A = \\begin{pmatrix} -\\frac{\\mu_{s} k^{2} + \\kappa}{m_{s}} & \\frac{\\kappa}{m_{s}} \\\\ \\frac{\\kappa}{m_{f}} & -\\frac{\\mu_{f} k^{2} + \\kappa}{m_{f}} \\end{pmatrix} $$\n\n前向欧拉数值积分格式为 $y_{n+1} = y_n + \\Delta t A y_n = (I + \\Delta t A) y_n$。该格式稳定的充分必要条件是，放大矩阵 $G = I + \\Delta t A$ 的所有特征值的模都小于或等于1。$G$ 的特征值，记为 $\\lambda_G$，与 $A$ 的特征值，记为 $\\lambda_A$，通过 $\\lambda_G = 1 + \\Delta t \\lambda_A$ 相关联。因此，稳定性条件是对于 $A$ 的所有特征值 $\\lambda_A$，都有 $|1 + \\Delta t \\lambda_A| \\le 1$。\n\n为了确定特征值 $\\lambda_A$ 的性质，我们考察 $A$ 的迹和行列式。\n令 $a_s = \\frac{\\mu_{s} k^{2} + \\kappa}{m_{s}}$ 和 $a_f = \\frac{\\mu_{f} k^{2} + \\kappa}{m_{f}}$。由于所有参数均为正，所以 $a_s$ 和 $a_f$ 都严格为正。\n$A$ 的迹为 $\\text{tr}(A) = -a_s - a_f < 0$。\n$A$ 的行列式为：\n$$ \\det(A) = (-a_s)(-a_f) - \\left(\\frac{\\kappa}{m_{s}}\\right)\\left(\\frac{\\kappa}{m_{f}}\\right) = a_s a_f - \\frac{\\kappa^2}{m_s m_f} $$\n代入 $a_s$ 和 $a_f$ 的表达式：\n$$ \\det(A) = \\frac{(\\mu_{s} k^{2} + \\kappa)(\\mu_{f} k^{2} + \\kappa)}{m_{s} m_{f}} - \\frac{\\kappa^2}{m_s m_f} = \\frac{\\mu_s \\mu_f k^4 + \\kappa(\\mu_s + \\mu_f)k^2 + \\kappa^2 - \\kappa^2}{m_s m_f} = \\frac{k^2(\\mu_s \\mu_f k^2 + \\kappa(\\mu_s + \\mu_f))}{m_s m_f} > 0 $$\n由于 $\\text{tr}(A)^2 - 4\\det(A) = (-(a_s + a_f))^2 - 4(a_s a_f - \\frac{\\kappa^2}{m_s m_f}) = (a_s - a_f)^2 + \\frac{4\\kappa^2}{m_s m_f} > 0$，特征值是实数且不相等。因为它们的和 $\\text{tr}(A)$ 是负的，它们的积 $\\det(A)$ 是正的，所以两个特征值都必须是实数且为负。这对应于一个物理上稳定（耗散）的系统。\n\n对于一个实的负特征值 $\\lambda_A < 0$，稳定性条件 $|1 + \\Delta t \\lambda_A| \\le 1$ 变为 $ -1 \\le 1 + \\Delta t \\lambda_A \\le 1$。这可以简化为 $-2 \\le \\Delta t \\lambda_A \\le 0$。因为 $\\Delta t > 0$ 且 $\\lambda_A < 0$，右边的不等式总是满足的。左边的不等式给出 $\\Delta t \\le -2/\\lambda_A$。为确保所有模式的稳定性，时间步长必须受最大模（即最负的）特征值的限制。令 $\\rho(A) = \\max_i|\\lambda_{A,i}|$ 为 $A$ 的谱半径。稳定性极限是：\n$$ \\Delta t_{\\max} = \\frac{2}{\\rho(A)} $$\n\n特征值 $\\lambda_A$ 是特征方程 $\\lambda_A^2 - \\text{tr}(A)\\lambda_A + \\det(A) = 0$ 的根：\n$$ \\lambda_A = \\frac{\\text{tr}(A) \\pm \\sqrt{\\text{tr}(A)^2 - 4\\det(A)}}{2} $$\n模最大的特征值是平方根前带负号的那个：\n$$ \\lambda_{A, \\min} = \\frac{\\text{tr}(A) - \\sqrt{\\text{tr}(A)^2 - 4\\det(A)}}{2} $$\n谱半径为 $\\rho(A) = |\\lambda_{A, \\min}| = -\\lambda_{A, \\min}$。\n$$ \\rho(A) = -\\frac{\\text{tr}(A) - \\sqrt{\\text{tr}(A)^2 - 4\\det(A)}}{2} = \\frac{-\\text{tr}(A) + \\sqrt{\\text{tr}(A)^2 - 4\\det(A)}}{2} $$\n用 $a_s$ 和 $a_f$ 代入迹和行列式的表达式：\n$$ \\rho(A) = \\frac{(a_s+a_f) + \\sqrt{(-(a_s+a_f))^2 - 4(a_s a_f - \\frac{\\kappa^2}{m_s m_f})}}{2} = \\frac{(a_s+a_f) + \\sqrt{(a_s-a_f)^2 + \\frac{4\\kappa^2}{m_s m_f}}}{2} $$\n那么最大稳定时间步长是：\n$$ \\Delta t_{\\max} = \\frac{2}{\\rho(A)} = \\frac{4}{(a_s+a_f) + \\sqrt{(a_s-a_f)^2 + \\frac{4\\kappa^2}{m_s m_f}}} $$\n最后，我们代回 $a_s$ 和 $a_f$ 的定义：\n$$ a_s+a_f = \\frac{\\mu_{s} k^{2} + \\kappa}{m_{s}} + \\frac{\\mu_{f} k^{2} + \\kappa}{m_{f}} $$\n$$ a_s-a_f = \\frac{\\mu_{s} k^{2} + \\kappa}{m_{s}} - \\frac{\\mu_{f} k^{2} + \\kappa}{m_{f}} $$\n将这些代入 $\\Delta t_{\\max}$ 的表达式中，就得到了最终的闭式解。\n\n$$ \\Delta t_{\\max} = \\frac{4}{\\left(\\frac{\\mu_{s} k^{2} + \\kappa}{m_{s}} + \\frac{\\mu_{f} k^{2} + \\kappa}{m_{f}}\\right) + \\sqrt{\\left(\\frac{\\mu_{s} k^{2} + \\kappa}{m_{s}} - \\frac{\\mu_{f} k^{2} + \\kappa}{m_{f}}\\right)^{2} + \\frac{4\\kappa^{2}}{m_{s}m_{f}}}} $$\n该表达式表示对于给定的耦合系统，前向欧拉积分保持线性稳定的最大时间步长。",
            "answer": "$$\\boxed{\\frac{4}{\\left(\\frac{\\mu_{s} k^{2} + \\kappa}{m_{s}} + \\frac{\\mu_{f} k^{2} + \\kappa}{m_{f}}\\right) + \\sqrt{\\left(\\frac{\\mu_{s} k^{2} + \\kappa}{m_{s}} - \\frac{\\mu_{f} k^{2} + \\kappa}{m_{f}}\\right)^{2} + \\frac{4\\kappa^{2}}{m_{s}m_{f}}}}}$$"
        }
    ]
}