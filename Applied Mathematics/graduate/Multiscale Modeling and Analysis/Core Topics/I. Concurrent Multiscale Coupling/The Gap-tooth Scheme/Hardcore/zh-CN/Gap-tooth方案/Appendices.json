{
    "hands_on_practices": [
        {
            "introduction": "对于任何显式时间积分方案，数值稳定性都是首要问题。在间齿格式的背景下，这意味着要确保宏观时间步不会放大误差，导致模拟发散。本练习将引导你推导一个类似于著名的CFL条件，但适用于粗粒度模拟的稳定性约束，从而揭示宏观时间步长、微观物理过程和斑块尺寸之间的基本关系 。",
            "id": "3819099",
            "problem": "考虑一个一维 (1D) 扩散过程的间隙齿方案（gap-tooth scheme），该过程在微观上由偏微分方程（PDE）$\\partial_{t} u = D \\,\\partial_{xx} u$ 控制，其中 $D$ 是常数扩散系数。宏观求解器使用一个大小为 $\\Delta t$ 的前向欧拉宏观步长来推进一个粗化变量 $U$（定义为片区平均的微观场），其使用的“斜率”由在每个物理宽度为 $\\delta$ 的片区内对一个短暂的微观时间 $\\tau$ 进行微观时间积分得到。在每个片区内，微观求解器施加与粗化场一致的狄利克雷（Dirichlet）型边界条件，并抑制伪影性的片区间瞬态；假设片区内的微观谱与长度为 $\\delta$ 的区间上的拉普拉斯算子的谱相同。Courant-Friedrichs-Lewy (CFL) 条件是偏微分方程显式时间步进的一个经典稳定性准则。\n\n从扩散的第一性原理出发，并利用在片区层面的适当谱或能量论证，推导出一个类似粗化 CFL 的稳定性要求，该要求用 $D$ 和 $\\delta$ 来约束 $\\Delta t$，以使显式粗化前向欧拉更新对于片区闭包所支持的最快可粗化解析的扩散模式是线性稳定的。假设粗化更新忠实地表示了傅里叶模式的扩散衰减率，直至片区几何结构所支持的最高波数。\n\n请以 $D$ 和 $\\delta$ 的单个闭式解析表达式的形式，给出允许的最大宏观时间步长 $\\Delta t_{\\max}$。用秒表示你的最终答案。没有提供数值；你的推导必须仅依赖于扩散方程、区间上拉普拉斯算子本征谱的标准性质，以及线性衰减的显式欧拉稳定性。除了这些基础要素外，不要引用任何快捷公式。你的最终答案必须是单个表达式，而不是不等式或句子。",
            "solution": "本题要求推导应用于一维扩散过程 $\\partial_{t} u = D \\,\\partial_{xx} u$ 的间隙齿方案的宏观时间步长 $\\Delta t$ 的稳定性条件。该方案对粗化变量 $U$ 使用前向欧拉更新。\n\n在给定时间 $t$，对粗化变量 $U$ 的前向欧拉更新形式如下：\n$$ U(t + \\Delta t) = U(t) + \\Delta t \\cdot \\mathcal{F}(U(t)) $$\n其中 $\\mathcal{F}(U(t))$ 表示由微观求解器估计的 $U$ 的时间导数。由于底层过程是线性的，我们可以通过考虑该数值方案对粗化场的单个傅里叶模式的作用来分析其稳定性。设粗化空间变量为 $X$，粗化网格的间距等于片区宽度 $\\delta$。此粗化网格上的一个傅里叶模式可以写为 $U(X,t) = \\hat{U}(k, t) e^{i k X}$，其中 $k$ 是粗化波数。\n\n对于一个扩散过程，该模式预计会随时间指数衰减，形式为 $\\hat{U}(k, t) = \\hat{U}(k, 0) e^{-\\lambda(k) t}$，其中 $\\lambda(k)$ 是与波数 $k$ 相关的衰减率。因此，时间导数为 $\\frac{d\\hat{U}}{dt} = -\\lambda(k) \\hat{U}$。该模式振幅的前向欧拉更新为：\n$$ \\hat{U}(k, t + \\Delta t) = \\hat{U}(k, t) - \\Delta t \\cdot \\lambda(k) \\hat{U}(k,t) = (1 - \\Delta t \\lambda(k)) \\hat{U}(k,t) $$\n此更新的放大因子为 $g(k) = 1 - \\Delta t \\lambda(k)$。为了线性稳定性，我们需要对所有相关波数 $k$ 都有 $|g(k)| \\leq 1$。由于 $\\lambda(k)$ 代表一个被动系统的物理衰减率，它必须是非负的，即 $\\lambda(k) \\ge 0$。因此，条件 $|1 - \\Delta t \\lambda(k)| \\leq 1$ 等价于：\n$$ -1 \\leq 1 - \\Delta t \\lambda(k) \\leq 1 $$\n上界 $1 - \\Delta t \\lambda(k) \\leq 1$ 意味着 $-\\Delta t \\lambda(k) \\leq 0$，对于 $\\Delta t > 0$ 和 $\\lambda(k) \\ge 0$ 总是成立的。下界 $-1 \\leq 1 - \\Delta t \\lambda(k)$ 产生了稳定性约束：\n$$ \\Delta t \\lambda(k) \\leq 2 $$\n这必须对方案设计要解析的所有模式 $k$ 都成立。最严格的条件是由具有最大衰减率 $\\lambda_{\\max}$ 的模式施加的：\n$$ \\Delta t \\leq \\frac{2}{\\lambda_{\\max}} $$\n问题在于确定这个 $\\lambda_{\\max}$。我们已知两个关键信息。\n首先，题目指出“粗化更新忠实地表示了傅里叶模式的扩散衰减率，直至片区几何结构所支持的最高波数。” 对于连续扩散偏微分方程 $\\partial_{t} u = D \\,\\partial_{xx} u$，一个傅里叶模式 $e^{ikx}$ 以衰减率 $\\lambda(k) = D k^2$ 演化。忠实表示的假设意味着有效的粗粒化动力学也具有此色散关系 $\\lambda(k) = D k^2$。\n\n其次，我们必须确定“最快可粗化解析的扩散模式”。粗化网格由宽度为 $\\delta$ 的片区组成，这意味着有效网格间距为 $\\delta$。根据奈奎斯特-香农（Nyquist-Shannon）采样定理，间距为 $\\delta$ 的网格可以解析的最小波长为 $2\\delta$。这对应于最大波数（奈奎斯特频率）：\n$$ k_{\\max} = \\frac{2\\pi}{2\\delta} = \\frac{\\pi}{\\delta} $$\n该模式代表了粗化网格可以支持的最振荡模式，其中 $U$ 的值在相邻片区之间交替变号。\n\n结合这些事实，粗化前向欧拉方案必须处理的最大衰减率是在最大可解析波数下评估的连续偏微分方程的衰减率：\n$$ \\lambda_{\\max} = \\lambda(k_{\\max}) = D k_{\\max}^2 = D \\left(\\frac{\\pi}{\\delta}\\right)^2 = \\frac{D\\pi^2}{\\delta^2} $$\n将这个 $\\lambda_{\\max}$ 的表达式代入前向欧拉步长的稳定性条件，得到：\n$$ \\Delta t \\leq \\frac{2}{\\frac{D\\pi^2}{\\delta^2}} = \\frac{2\\delta^2}{D\\pi^2} $$\n这个结果代表了对宏观时间步长的类似粗化 CFL 的稳定性要求。允许的最大时间步长 $\\Delta t_{\\max}$ 是此不等式的上限。\n\n我们可以通过“片区内的微观谱与长度为 $\\delta$ 的区间上的拉普拉斯算子的谱相同”这一陈述来验证该结果的一致性。这意味着在片区级别的问题上施加了狄利克雷边界条件。在长度为 $\\delta$ 的区间上，带有狄利克雷边界条件的拉普拉斯算子 $\\partial_{xx}$ 的本征函数是 $\\phi_n(x) = \\sin(n\\pi x/\\delta)$，对应的 $-\\partial_{xx}$ 的本征值是 $(n\\pi/\\delta)^2$，其中 $n=1, 2, 3, \\ldots$。片区内微观扩散方程 $\\partial_t u = D \\partial_{xx} u$ 的衰减率是 $\\mu_n = D(n\\pi/\\delta)^2$。这些微观衰减率中最慢的一个（基模，$n=1$）是 $\\mu_1 = D(\\pi/\\delta)^2$。间隙齿方案的构建方式是，粗化变量的演化由片区内部与粗化数据一致的最慢弛豫过程所控制。最快的粗化模式 ($k_{\\max} = \\pi/\\delta$) 激发了一个与片区的基模 ($n=1$) 非常相似的微观场分布，这证实了粗化求解器所看到的衰减率 $\\lambda_{\\max}$ 确实是 $\\mu_1 = D(\\pi/\\delta)^2$。\n\n因此，允许的最大宏观时间步长是：\n$$ \\Delta t_{\\max} = \\frac{2\\delta^2}{D\\pi^2} $$\n此表达式的单位是 $[\\text{长度}]^2 / ([\\text{长度}]^2 / [\\text{时间}]) = [\\text{时间}]$，这与题目要求以秒为单位作答是一致的，前提是假设 $D$ 和 $\\delta$ 使用国际单位制（SI）的基本单位。",
            "answer": "$$\\boxed{\\frac{2\\delta^{2}}{D\\pi^{2}}}$$"
        },
        {
            "introduction": "多尺度建模的核心挑战之一是在不同尺度之间传递信息，而“限制”算子正是将细尺度数据映射回粗尺度变量的关键。本练习探讨了限制算子的一个关键设计抉择：在存在未解析的微观振荡时，不同的算子选择（如逐点取值与体积平均）如何影响粗尺度模型的可靠性。通过分析偏差和方差，你将深入理解如何构建稳健的多尺度算子 。",
            "id": "3819081",
            "problem": "考虑一个用于空间光滑宏观场的一维齿隙式粗时间步进器。假设在一个中心位于位置 $X$、宽度为 $h$ 的单齿内部，微观解表现出波长为 $O(\\epsilon)$ 的亚齿级振荡，在齿上的主导阶上可以由以下公式建模：\n$$\nu_{\\epsilon}(x) \\;=\\; U \\;+\\; a \\,\\cos\\!\\left(\\frac{2\\pi}{\\epsilon}\\,x \\;+\\; \\Theta\\right),\n$$\n其中 $U$ 和 $a$ 是在该齿上近似恒定的宏观量，$\\epsilon>0$ 满足 $\\epsilon \\ll h$，并且 $\\Theta$ 是一个未知的微观相位，被建模为一个在 $[0,2\\pi)$ 上均匀分布且在各次实现中独立的随机变量。定义两个限制算子，将齿内的微观解映射到一个粗观测量：\n- 齒中心的点态限制：$R_{\\mathrm{pt}} \\,=\\, u_{\\epsilon}(X)$。\n- 齿上的体平均限制：$R_{\\mathrm{av}} \\,=\\, \\dfrac{1}{h}\\,\\displaystyle\\int_{X-\\frac{h}{2}}^{X+\\frac{h}{2}} u_{\\epsilon}(x)\\,dx$。\n\n仅使用期望和方差的定义以及标准微积分恒等式，通过对微观相位 $\\Theta$ 进行平均，计算每个限制相对于宏观量 $U$ 的偏差和方差。具体地，计算\n$$\nb_{\\mathrm{pt}} \\;=\\; \\mathbb{E}[R_{\\mathrm{pt}}] - U,\\quad b_{\\mathrm{av}} \\;=\\; \\mathbb{E}[R_{\\mathrm{av}}] - U,\\quad v_{\\mathrm{pt}} \\;=\\; \\mathrm{Var}(R_{\\mathrm{pt}}),\\quad v_{\\mathrm{av}} \\;=\\; \\mathrm{Var}(R_{\\mathrm{av}}),\n$$\n作为 $a$、$h$ 和 $\\epsilon$ 的函数。\n\n请将最终结果以单行矩阵的形式按 $\\bigl[b_{\\mathrm{pt}},\\, b_{\\mathrm{av}},\\, v_{\\mathrm{pt}},\\, v_{\\mathrm{av}}\\bigr]$ 的顺序给出。不需要进行数值近似或舍入，也不涉及物理单位。请精确表示三角函数项；在最终答案中不要对小的 $\\epsilon/h$ 值进行近似。",
            "solution": "该问题是有效的，因为它在多尺度分析领域内具有科学依据、是适定的、客观的且自洽的。我们可以开始求解。\n\n问题的核心是计算随机变量 $\\Theta$ 的函数的期望和方差，该随机变量在区间 $[0, 2\\pi)$ 上均匀分布。$\\Theta$ 的概率密度函数 (PDF) 为 $f(\\theta) = \\frac{1}{2\\pi}$（当 $\\theta \\in [0, 2\\pi)$ 时）以及 $f(\\theta) = 0$（其他情况）。任意函数 $g(\\Theta)$ 的期望由下式给出：\n$$\n\\mathbb{E}[g(\\Theta)] \\;=\\; \\int_{0}^{2\\pi} g(\\theta) f(\\theta) \\,d\\theta \\;=\\; \\frac{1}{2\\pi} \\int_{0}^{2\\pi} g(\\theta) \\,d\\theta.\n$$\n方差由 $\\mathrm{Var}(g(\\Theta)) = \\mathbb{E}[g(\\Theta)^2] - (\\mathbb{E}[g(\\Theta)])^2$ 给出。\n\n我们将使用两个在 $2\\pi$ 周期上的基本积分恒等式：\n对于任意整数 $n \\neq 0$ 和任意常数相位 $\\phi$，\n$$\n\\int_{0}^{2\\pi} \\cos(n\\theta + \\phi) \\,d\\theta = 0\n$$\n$$\n\\int_{0}^{2\\pi} \\cos^2(\\theta + \\phi) \\,d\\theta = \\int_{0}^{2\\pi} \\frac{1+\\cos(2(\\theta+\\phi))}{2} \\,d\\theta = \\frac{1}{2} \\left[ \\theta \\right]_{0}^{2\\pi} + \\frac{1}{2}\\int_{0}^{2\\pi} \\cos(2\\theta+2\\phi) \\, d\\theta = \\pi.\n$$\n由此，我们推导出期望值：\n$\\mathbb{E}[\\cos(n\\Theta + \\phi)] = \\frac{1}{2\\pi} \\cdot 0 = 0$ (对于 $n \\in \\mathbb{Z}, n \\neq 0$)。\n$\\mathbb{E}[\\cos^2(\\Theta + \\phi)] = \\frac{1}{2\\pi} \\cdot \\pi = \\frac{1}{2}$。\n\n### 点态限制 $R_{\\mathrm{pt}}$ 的分析\n\n点态限制定义为 $R_{\\mathrm{pt}} = u_{\\epsilon}(X)$。代入 $u_{\\epsilon}(x)$ 的表达式：\n$$\nR_{\\mathrm{pt}} = U \\;+\\; a \\,\\cos\\!\\left(\\frac{2\\pi}{\\epsilon}\\,X \\;+\\; \\Theta\\right)\n$$\n我们定义一个常数相位 $\\phi_X = \\frac{2\\pi}{\\epsilon}X$。那么，$R_{\\mathrm{pt}} = U + a \\cos(\\phi_X + \\Theta)$。\n\n**偏差 $b_{\\mathrm{pt}}$：**\n偏差为 $b_{\\mathrm{pt}} = \\mathbb{E}[R_{\\mathrm{pt}}] - U$。我们首先计算 $R_{\\mathrm{pt}}$ 的期望：\n$$\n\\mathbb{E}[R_{\\mathrm{pt}}] = \\mathbb{E}[U + a \\cos(\\phi_X + \\Theta)] = \\mathbb{E}[U] + a \\mathbb{E}[\\cos(\\phi_X + \\Theta)]\n$$\n由于 $U$ 和 $a$ 相对于关于 $\\Theta$ 的系综是常数，并且使用恒等式 $\\mathbb{E}[\\cos(\\Theta+\\phi_X)]=0$，我们得到：\n$$\n\\mathbb{E}[R_{\\mathrm{pt}}] = U + a \\cdot 0 = U\n$$\n因此，偏差为：\n$$\nb_{\\mathrm{pt}} = U - U = 0\n$$\n\n**方差 $v_{\\mathrm{pt}}$：**\n方差为 $v_{\\mathrm{pt}} = \\mathrm{Var}(R_{\\mathrm{pt}})$。\n$$\nv_{\\mathrm{pt}} = \\mathrm{Var}(U + a \\cos(\\phi_X + \\Theta))\n$$\n对于常数 $C$ 和 $k$，使用性质 $\\mathrm{Var}(C+kY) = k^2\\mathrm{Var}(Y)$，我们有：\n$$\nv_{\\mathrm{pt}} = a^2 \\mathrm{Var}(\\cos(\\phi_X + \\Theta))\n$$\n$\\cos(\\phi_X + \\Theta)$ 的方差为：\n$$\n\\mathrm{Var}(\\cos(\\phi_X + \\Theta)) = \\mathbb{E}[\\cos^2(\\phi_X + \\Theta)] - (\\mathbb{E}[\\cos(\\phi_X + \\Theta)])^2\n$$\n我们已经求得 $\\mathbb{E}[\\cos(\\phi_X + \\Theta)] = 0$。使用恒等式 $\\mathbb{E}[\\cos^2(\\Theta+\\phi_X)]=\\frac{1}{2}$：\n$$\n\\mathrm{Var}(\\cos(\\phi_X + \\Theta)) = \\frac{1}{2} - 0^2 = \\frac{1}{2}\n$$\n将此代回 $v_{\\mathrm{pt}}$ 的表达式中：\n$$\nv_{\\mathrm{pt}} = a^2 \\cdot \\frac{1}{2} = \\frac{a^2}{2}\n$$\n\n### 体平均限制 $R_{\\mathrm{av}}$ 的分析\n\n体平均限制定义为 $R_{\\mathrm{av}} = \\frac{1}{h}\\,\\displaystyle\\int_{X-\\frac{h}{2}}^{X+\\frac{h}{2}} u_{\\epsilon}(x)\\,dx$。\n$$\nR_{\\mathrm{av}} = \\frac{1}{h}\\,\\displaystyle\\int_{X-\\frac{h}{2}}^{X+\\frac{h}{2}} \\left[ U + a \\cos\\!\\left(\\frac{2\\pi}{\\epsilon}\\,x \\;+\\; \\Theta\\right) \\right] \\,dx\n$$\n我们可以拆分这个积分：\n$$\nR_{\\mathrm{av}} = \\frac{1}{h} \\left( \\int_{X-\\frac{h}{2}}^{X+\\frac{h}{2}} U \\,dx + a \\int_{X-\\frac{h}{2}}^{X+\\frac{h}{2}} \\cos\\!\\left(\\frac{2\\pi}{\\epsilon}\\,x \\;+\\; \\Theta\\right) \\,dx \\right)\n$$\n第一个积分是 $\\int_{X-\\frac{h}{2}}^{X+\\frac{h}{2}} U \\,dx = U \\cdot h$。对于第二个积分，令 $k = \\frac{2\\pi}{\\epsilon}$：\n$$\n\\int_{X-\\frac{h}{2}}^{X+\\frac{h}{2}} \\cos(kx + \\Theta) \\,dx = \\left[ \\frac{1}{k} \\sin(kx+\\Theta) \\right]_{X-\\frac{h}{2}}^{X+\\frac{h}{2}} = \\frac{1}{k} \\left( \\sin\\left(k\\left(X+\\frac{h}{2}\\right) + \\Theta\\right) - \\sin\\left(k\\left(X-\\frac{h}{2}\\right) + \\Theta\\right) \\right)\n$$\n使用三角恒等式 $\\sin(A) - \\sin(B) = 2\\cos\\left(\\frac{A+B}{2}\\right)\\sin\\left(\\frac{A-B}{2}\\right)$，令 $A = kX+\\frac{kh}{2}+\\Theta$ 且 $B = kX-\\frac{kh}{2}+\\Theta$，我们得到：$\\frac{A+B}{2} = kX+\\Theta$ 以及 $\\frac{A-B}{2} = \\frac{kh}{2}$。\n该积分变为：\n$$\n\\frac{1}{k} \\left( 2 \\cos(kX+\\Theta) \\sin\\left(\\frac{kh}{2}\\right) \\right)\n$$\n將此代回 $R_{\\mathrm{av}}$ 的表达式中：\n$$\nR_{\\mathrm{av}} = \\frac{1}{h} \\left( Uh + a \\cdot \\frac{2}{k} \\cos(kX+\\Theta) \\sin\\left(\\frac{kh}{2}\\right) \\right) = U + a \\frac{2}{kh} \\sin\\left(\\frac{kh}{2}\\right) \\cos(kX+\\Theta)\n$$\n代入 $k = \\frac{2\\pi}{\\epsilon}$，项 $\\frac{kh}{2} = \\frac{2\\pi}{\\epsilon}\\frac{h}{2} = \\frac{\\pi h}{\\epsilon}$。乘以余弦的因子变为：\n$$\na \\frac{2}{\\frac{2\\pi h}{\\epsilon}} \\sin\\left(\\frac{\\pi h}{\\epsilon}\\right) = a \\frac{\\epsilon}{\\pi h} \\sin\\left(\\frac{\\pi h}{\\epsilon}\\right)\n$$\n所以，我们可以将 $R_{\\mathrm{av}}$ 写为：\n$$\nR_{\\mathrm{av}} = U + \\left(a \\frac{\\epsilon}{\\pi h} \\sin\\left(\\frac{\\pi h}{\\epsilon}\\right)\\right) \\cos\\!\\left(\\frac{2\\pi}{\\epsilon}\\,X \\;+\\; \\Theta\\right)\n$$\n\n**偏差 $b_{\\mathrm{av}}$：**\n$R_{\\mathrm{av}}$ 的结构与 $R_{\\mathrm{pt}}$ 相同，只是振幅 $a$ 被一个新的常数振幅 $a' = a \\frac{\\epsilon}{\\pi h} \\sin\\left(\\frac{\\pi h}{\\epsilon}\\right)$ 替代。\n$$\n\\mathbb{E}[R_{\\mathrm{av}}] = \\mathbb{E}\\left[ U + a' \\cos(\\phi_X + \\Theta) \\right] = U + a' \\mathbb{E}[\\cos(\\phi_X+\\Theta)] = U + a' \\cdot 0 = U\n$$\n因此，偏差为：\n$$\nb_{\\mathrm{av}} = \\mathbb{E}[R_{\\mathrm{av}}] - U = U - U = 0\n$$\n\n**方差 $v_{\\mathrm{av}}$：**\n类似地，方差的计算与 $v_{\\mathrm{pt}}$ 的计算相同，只是将 $a$ 替换为 $a'$：\n$$\nv_{\\mathrm{av}} = \\mathrm{Var}(U + a' \\cos(\\phi_X + \\Theta)) = (a')^2 \\mathrm{Var}(\\cos(\\phi_X+\\Theta)) = (a')^2 \\cdot \\frac{1}{2}\n$$\n代入 $a'$ 的表达式：\n$$\nv_{\\mathrm{av}} = \\frac{1}{2} \\left( a \\frac{\\epsilon}{\\pi h} \\sin\\left(\\frac{\\pi h}{\\epsilon}\\right) \\right)^2 = \\frac{a^2 \\epsilon^2}{2 \\pi^2 h^2} \\sin^2\\left(\\frac{\\pi h}{\\epsilon}\\right)\n$$\n\n所求的四个量是：\n$b_{\\mathrm{pt}} = 0$\n$b_{\\mathrm{av}} = 0$\n$v_{\\mathrm{pt}} = \\frac{a^2}{2}$\n$v_{\\mathrm{av}} = \\frac{a^2 \\epsilon^2}{2 \\pi^2 h^2} \\sin^2\\left(\\frac{\\pi h}{\\epsilon}\\right)$\n我们将这些整合为所需的最终格式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 0 & \\frac{a^2}{2} & \\frac{a^2 \\epsilon^2}{2 \\pi^2 h^2} \\sin^2\\left(\\frac{\\pi h}{\\epsilon}\\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在保证了稳定性和信息传递的稳健性之后，下一个关键问题就是精度。间齿格式的整体精度取决于宏观时间步长与用于估计时间导数的微观模拟时长之间的精妙平衡。本练习将深入探讨这种权衡关系，揭示如何通过恰当选择微观模拟时长，来保持高级宏观积分器（如龙格-库塔法）所预期的整体计算精度 。",
            "id": "3819086",
            "problem": "考虑一个一维宏观可观测量 $u(x,t)$，它在一个封闭的宏观模型 $\\partial_t u = F(u)$ 下演化，其中 $F$ 对其自变量是足够光滑的。在使用齿隙格式的无方程多尺度计算中，右端项 $F(u)$ 无法通过解析方式获得。取而代之的是，通过在不相交的片区中将 $u$ 提升到一致的微观状态，将这些微观状态演化一个持续时间为 $\\tau_b$ 的短暂微观爆发，并限制其结果来估计粗时间导数，从而在粗网格点上对其进行近似。宏观时间步进由一个形式阶为 $r$ 的 $s$ 级显式 Runge–Kutta 方法执行，宏观时间步长为 $\\Delta t$，其中 Runge–Kutta 各个阶段中对 $F$ 的每次求值都被上述基于微观爆发的估计器所替代。\n\n假设如下：\n- 每个片区内的微观模拟器忠实地再现细尺度动力学，并由一个提升算子进行初始化，该算子是一致的，即它在初始时刻再现了片区中心的粗糙可观测量 $u$。\n- 限制算子在微观爆发后返回片区中心的粗糙可观测量。\n- 在给定阶段，基于微观爆发的时间导数估计器具有一个确定性偏差，其大小与 $\\beta\\,\\tau_b^{\\alpha}$ 成比例，其中 $\\beta \\neq 0$ 为某个未知常数，$\\alpha \\geq 1$ 为某个已知的收敛阶参数，该偏差独立于 $\\Delta t$、$u$ 和阶段索引，并且高阶偏差项在 $\\tau_b$ 上是严格更高阶的。\n- 由片区大小、缓冲区边界条件或宏观网格间距引起的空间耦合误差与时间误差相比可以忽略不计，并且爆发期间的微观演化足够短，以至于粗糙状态在爆发期间内没有明显变化。\n- 随机涨落（如果存在）通过系综平均来控制，因此由方差引起的误差与确定性偏差相比可以忽略不计。\n\n从显式 Runge–Kutta 方法的基本性质（一致性和阶条件）和上述假设出发，对得到的粗糙投影 Runge–Kutta 步进行局部截断误差分析。推导局部截断误差关于 $\\Delta t$ 和 $\\tau_b$ 的主阶表达式，然后确定 $\\tau_b$ 和 $\\Delta t$ 之间的一个尺度关系，该关系能使局部截断误差达到预期的 Runge–Kutta 阶 $r+1$。具体来说，假设选择 $\\tau_b$ 与 $\\Delta t$ 的尺度关系为 $\\tau_b = c\\,\\Delta t^{s}$，其中 $c>0$ 为常数，指数 $s>0$，请确定能确保总局部截断误差为 $\\mathcal{O}(\\Delta t^{r+1})$ 的最小指数 $s$。\n\n您的最终答案应该是指数 $s$ 关于 $r$ 和 $\\alpha$ 的单一闭式解析表达式。不包含任何单位。不要报告不等式。不要报告方程。不要四舍五入。",
            "solution": "任务是确定关系式 $\\tau_b = c\\Delta t^s$ 中的尺度指数 $s$，以确保粗糙投影 Runge-Kutta (RK) 方法能保持其形式精度阶。这需要对该数值格式的局部截断误差 (LTE) 进行分析。\n\n设精确的宏观演化方程为 $\\frac{du}{dt} = F(u)$。题目指出，该方程使用一个形式阶为 $r$ 的 $s$ 级显式 RK 方法进行积分。这种方法从时间 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 的一个通用步骤定义如下：\n$$k_i = F\\left(u_n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} k_j\\right), \\quad i=1, \\dots, s$$\n$$u_{n+1} = u_n + \\Delta t \\sum_{i=1}^{s} b_i k_i$$\n假设 $u_n$ 是精确解 $u(t_n)$，则该方法的局部截断误差为 $L_{rk} = u(t_{n+1}) - u_{n+1} = \\mathcal{O}(\\Delta t^{r+1})$。\n\n在齿隙格式中，精确函数 $F(u)$ 是不可用的。它被一个从持续时间为 $\\tau_b$ 的微观模拟爆发中获得的估计器 $\\hat{F}(u)$ 所替代。根据题目陈述，该估计器具有一个确定性偏差：\n$$\\hat{F}(u) = F(u) + E$$\n其中偏差的主阶项为 $E = \\beta \\tau_b^{\\alpha} + \\text{h.o.t.}$，并且假设该偏差 $E$ 独立于 $u$ 和阶段索引 $i$。\n\n因此，投影 RK 格式为：\n$$\\hat{k}_i = \\hat{F}\\left(u_n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} \\hat{k}_j\\right) = F\\left(u_n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} \\hat{k}_j\\right) + E, \\quad i=1, \\dots, s$$\n$$u_{n+1,p} = u_n + \\Delta t \\sum_{i=1}^{s} b_i \\hat{k}_i$$\n这里，下标 $p$ 表示投影格式。\n\n我们希望找到总局部截断误差 $L_{total} = u(t_{n+1}) - u_{n+1,p}$，假设 $u_n = u(t_n)$。我们可以将此误差分解为两部分：\n$$L_{total} = \\left(u(t_{n+1}) - u_{n+1}\\right) + \\left(u_{n+1} - u_{n+1,p}\\right)$$\n第一部分 $(u(t_{n+1}) - u_{n+1})$ 是原始 RK 方法的内在局部截断误差，即 $L_{rk} = \\mathcal{O}(\\Delta t^{r+1})$。\n第二部分是由 $F$ 中的偏差引入的误差：\n$$u_{n+1} - u_{n+1,p} = \\left(u_n + \\Delta t \\sum_{i=1}^{s} b_i k_i\\right) - \\left(u_n + \\Delta t \\sum_{i=1}^{s} b_i \\hat{k}_i\\right) = \\Delta t \\sum_{i=1}^{s} b_i (k_i - \\hat{k}_i)$$\n让我们分析阶段值之间的差异，$\\delta_i = \\hat{k}_i - k_i$。\n对于第一阶段，$i=1$，自变量中的求和项为空：\n$$k_1 = F(u_n)$$\n$$\\hat{k}_1 = F(u_n) + E$$\n所以，$\\delta_1 = \\hat{k}_1 - k_1 = E$。\n\n对于后续阶段，我们有：\n$$\\delta_i = \\hat{k}_i - k_i = F\\left(u_n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} \\hat{k}_j\\right) + E - F\\left(u_n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} k_j\\right)$$\n$$\\delta_i = E + \\left[ F\\left(u_n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} k_j + \\Delta t \\sum_{j=1}^{i-1} a_{ij} \\delta_j\\right) - F\\left(u_n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} k_j\\right) \\right]$$\n对 $F$ 在 $k_i$ 的自变量周围进行泰勒展开，并且由于 $\\delta_j$ 的阶将为 $E$，因此差异项的阶为 $\\mathcal{O}(\\Delta t)$。\n$$\\delta_i = E + \\mathcal{O}(\\Delta t)$$\n因此，来自偏差的误差贡献为：\n$$u_{n+1,p} - u_{n+1} = \\Delta t \\sum_{i=1}^{s} b_i \\delta_i = \\Delta t \\sum_{i=1}^{s} b_i (E + \\mathcal{O}(\\Delta t)) = E \\Delta t \\sum_{i=1}^{s} b_i + \\mathcal{O}(\\Delta t^2)$$\n对于任何阶数 $r \\geq 1$ 的 RK 方法，其一致性的一个必要条件是权重之和为一：\n$$\\sum_{i=1}^{s} b_i = 1$$\n因此，来自偏差的主阶误差贡献为：\n$$u_{n+1,p} - u_{n+1} = E \\Delta t + \\mathcal{O}(\\Delta t^2)$$\n总局部截断误差为：\n$$L_{total} = L_{rk} - (u_{n+1,p} - u_{n+1}) = \\mathcal{O}(\\Delta t^{r+1}) - (E \\Delta t + \\mathcal{O}(\\Delta t^2))$$\n代入给定的偏差形式 $E \\approx \\beta \\tau_b^\\alpha$：\n$$L_{total} = \\mathcal{O}(\\Delta t^{r+1}) - \\mathcal{O}(\\Delta t \\tau_b^\\alpha)$$\n方法的整体阶数由 $\\Delta t$ 的最低次幂项决定。为确保总 LTE 为 $\\mathcal{O}(\\Delta t^{r+1})$，由偏差产生的误差项的阶数必须至少与 $r+1$ 一样高。也就是说，我们要求：\n$$\\Delta t \\tau_b^\\alpha = \\mathcal{O}(\\Delta t^{r+1})$$\n题目指明了一个尺度关系 $\\tau_b = c \\Delta t^s$，其中 $c>0$ 且 $s>0$。将此代入要求中：\n$$\\Delta t (c \\Delta t^s)^\\alpha = \\mathcal{O}(\\Delta t^{r+1})$$\n$$c^\\alpha \\Delta t^{1+s\\alpha} = \\mathcal{O}(\\Delta t^{r+1})$$\n这意味着左侧 $\\Delta t$ 的指数必须大于或等于右侧的指数：\n$$1 + s\\alpha \\geq r+1$$\n题目要求满足此条件的最小指数 $s$。当两个误差源达到平衡时，即对应于以下等式时，可以获得最小值：\n$$1 + s\\alpha = r+1$$\n解出 $s$：\n$$s\\alpha = r$$\n$$s = \\frac{r}{\\alpha}$$\n这个结果表明，为了保持高阶 ($r$) 的宏观积分，微观爆发持续时间 $\\tau_b$ 必须作为宏观步长 $\\Delta t$ 的一个幂函数递减。所需的指数 $s$ 与期望的宏观阶 $r$ 成正比，与微观估计器的精度阶 $\\alpha$ 成反比。",
            "answer": "$$\\boxed{\\frac{r}{\\alpha}}$$"
        }
    ]
}