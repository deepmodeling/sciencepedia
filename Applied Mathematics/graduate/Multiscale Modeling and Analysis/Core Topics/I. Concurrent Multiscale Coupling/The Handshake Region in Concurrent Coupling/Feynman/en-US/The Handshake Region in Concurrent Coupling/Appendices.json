{
    "hands_on_practices": [
        {
            "introduction": "To prevent the creation of artificial forces at the boundary between two different models, the transition in the handshake region must be mathematically smooth. This exercise provides foundational practice in constructing a blending function that ensures this smoothness. You will build a partition-of-unity function with continuous first derivatives ($C^1$ continuity), a cornerstone for many advanced energy-based and force-based coupling methods .",
            "id": "3819449",
            "problem": "In concurrent multiscale coupling of an atomistic submodel and a continuum submodel, the interaction is blended across a finite “handshake” overlap to avoid spurious interface artifacts. Consider a one-dimensional bar with spatial coordinate $x$ measured in meters, where the overlap (handshake) region is the interval $[0,L]$ with $L>0$. Construct a pair of weighting functions $w_{\\mathrm{A}}(x)$ and $w_{\\mathrm{C}}(x)$ that define a $C^1$ partition of unity for blending, consistent with the following requirements:\n- $w_{\\mathrm{A}}(x)$ and $w_{\\mathrm{C}}(x)$ are nonnegative, $C^1$ functions on $\\mathbb{R}$ with $w_{\\mathrm{A}}(x)+w_{\\mathrm{C}}(x)=1$ for all $x\\in\\mathbb{R}$,\n- $w_{\\mathrm{A}}(x)=1$ and $w_{\\mathrm{C}}(x)=0$ for $x\\leq 0$,\n- $w_{\\mathrm{A}}(x)=0$ and $w_{\\mathrm{C}}(x)=1$ for $x\\geq L$,\n- $w_{\\mathrm{A}}(x)$ decreases smoothly from $1$ to $0$ and $w_{\\mathrm{C}}(x)$ increases smoothly from $0$ to $1$ across $x\\in(0,L)$ with vanishing first derivatives at the endpoints $x=0$ and $x=L$.\n\nUsing only fundamental definitions from calculus and the definition of a partition of unity, define $w_{\\mathrm{A}}(x)$ and $w_{\\mathrm{C}}(x)$ in terms of a smooth “raised cosine” ramp $s(x)$ on $[0,L]$ that satisfies $s(0)=0$, $s(L)=1$, $s'(0)=0$, and $s'(L)=0$. Prove that the resulting pair is $C^1$ on $\\mathbb{R}$ and a valid partition of unity. Then, compute the maximum magnitude of the spatial gradient (in one dimension, the derivative) of the weights over $x\\in\\mathbb{R}$, expressed as a function of $L$.\n\nYour final answer must be a single closed-form analytic expression in terms of $L$. If you use physical units, report the gradient magnitude in inverse meters ($\\mathrm{m}^{-1}$). Do not include units inside the final boxed answer. No rounding is required.",
            "solution": "The problem statement is well-posed, scientifically grounded, and provides a complete set of consistent requirements for constructing a $C^1$ partition of unity. It is a standard problem in the field of multiscale modeling. Therefore, the problem is valid, and we proceed with the solution.\n\nThe task is to construct a pair of weighting functions, $w_{\\mathrm{A}}(x)$ and $w_{\\mathrm{C}}(x)$, for $x \\in \\mathbb{R}$, that satisfy a set of blending properties over a handshake region $[0, L]$. This construction will be based on a smooth \"raised cosine\" ramp function $s(x)$ on $[0, L]$.\n\nFirst, we construct the ramp function $s(x)$ on the interval $[0, L]$. The problem requires that $s(x)$ satisfies four conditions: $s(0)=0$, $s(L)=1$, $s'(0)=0$, and $s'(L)=0$. A \"raised cosine\" function is of the form $A \\cos(kx) + B$. To satisfy the boundary conditions, we need a function that smoothly transitions over the interval. A suitable candidate is of the form $s(x) = A\\left(1 - \\cos\\left(\\frac{\\pi x}{L}\\right)\\right)$. This choice is motivated by the argument of the cosine, $\\frac{\\pi x}{L}$, which maps the interval $[0, L]$ to $[0, \\pi]$, the half-period of the cosine function.\n\nLet's test this form against the conditions for $s(x)$:\nWe propose $s(x) = \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{\\pi x}{L}\\right)\\right)$.\n1.  At $x=0$: $s(0) = \\frac{1}{2}\\left(1 - \\cos(0)\\right) = \\frac{1}{2}(1 - 1) = 0$. This condition is met.\n2.  At $x=L$: $s(L) = \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{\\pi L}{L}\\right)\\right) = \\frac{1}{2}(1 - \\cos(\\pi)) = \\frac{1}{2}(1 - (-1)) = 1$. This condition is met.\n\nNow, we check the derivative conditions. The first derivative of $s(x)$ with respect to $x$ is:\n$$ s'(x) = \\frac{d}{dx} \\left[ \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{\\pi x}{L}\\right)\\right) \\right] = \\frac{1}{2} \\left( \\sin\\left(\\frac{\\pi x}{L}\\right) \\cdot \\frac{\\pi}{L} \\right) = \\frac{\\pi}{2L} \\sin\\left(\\frac{\\pi x}{L}\\right) $$\n3.  At $x=0$: $s'(0) = \\frac{\\pi}{2L} \\sin(0) = 0$. This condition is met.\n4.  At $x=L$: $s'(L) = \\frac{\\pi}{2L} \\sin(\\pi) = 0$. This condition is met.\nThus, the function $s(x) = \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{\\pi x}{L}\\right)\\right)$ is the correct \"raised cosine\" ramp.\n\nNext, we define the weighting functions $w_{\\mathrmA}}(x)$ and $w_{\\mathrmC}}(x)$ for all $x \\in \\mathbb{R}$ using $s(x)$. The function $w_{\\mathrmC}}(x)$ should increase from $0$ to $1$, and $w_{\\mathrmA}}(x)$ should decrease from $1$ to $0$. We can directly identify $w_{\\mathrmC}}(x)$ with $s(x)$ inside the handshake region. The partition of unity requirement, $w_{\\mathrmA}}(x) + w_{\\mathrmC}}(x) = 1$, then defines $w_{\\mathrmA}}(x) = 1 - w_{\\mathrmC}}(x)$.\nThe complete piecewise definitions are:\n$$ w_{\\mathrm{C}}(x) = \\begin{cases} 0 & \\text{if } x \\le 0 \\\\ \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{\\pi x}{L}\\right)\\right) & \\text{if } 0 < x < L \\\\ 1 & \\text{if } x \\ge L \\end{cases} $$\n$$ w_{\\mathrm{A}}(x) = 1 - w_{\\mathrm{C}}(x) = \\begin{cases} 1 & \\text{if } x \\le 0 \\\\ 1 - \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{\\pi x}{L}\\right)\\right) = \\frac{1}{2}\\left(1 + \\cos\\left(\\frac{\\pi x}{L}\\right)\\right) & \\text{if } 0 < x < L \\\\ 0 & \\text{if } x \\ge L \\end{cases} $$\n\nNow, we must prove that this pair of functions is $C^1$ and forms a valid partition of unity.\n1.  **Partition of Unity**: By construction, $w_{\\mathrmA}}(x) + w_{\\mathrmC}}(x) = 1$ for all $x \\in \\mathbb{R}$. This is true for $x \\le 0$ ($1+0=1$), for $x \\ge L$ ($0+1=1$), and for $0 < x < L$ ($(1-s(x)) + s(x) = 1$).\n2.  **Non-negativity**: For $x \\in (0, L)$, the argument of the cosine, $\\frac{\\pi x}{L}$, is in $(0, \\pi)$. In this range, $-1 < \\cos(\\frac{\\pi x}{L}) < 1$.\n    -   $w_{\\mathrmC}}(x) = \\frac{1}{2}(1 - \\cos(\\frac{\\pi x}{L}))$. Since $\\cos(\\cdot) \\le 1$, $w_{\\mathrmC}}(x) \\ge 0$.\n    -   $w_{\\mathrmA}}(x) = \\frac{1}{2}(1 + \\cos(\\frac{\\pi x}{L}))$. Since $\\cos(\\cdot) \\ge -1$, $w_{\\mathrmA}}(x) \\ge 0$.\n    Outside the interval $(0, L)$, the functions are either $0$ or $1$, which are non-negative.\n3.  **$C^1$ Continuity**: A function is $C^1$ if both the function and its first derivative are continuous. We only need to check continuity at the boundaries of the piecewise definition, $x=0$ and $x=L$. We analyze $w_{\\mathrmC}}(x)$; the results for $w_{\\mathrmA}}(x)$ follow since $w_{\\mathrmA}}(x) = 1 - w_{\\mathrmC}}(x)$ and $w'_{\\mathrmA}}(x) = -w'_{\\mathrmC}}(x)$.\n    -   Continuity at $x=0$:\n        -   $\\lim_{x \\to 0^-} w_{\\mathrm{C}}(x) = 0$.\n        -   $w_{\\mathrm{C}}(0^+) = \\lim_{x \\to 0^+} \\frac{1}{2}(1 - \\cos(\\frac{\\pi x}{L})) = \\frac{1}{2}(1-1) = 0$.\n        -   The function is continuous at $x=0$.\n    -   Continuity at $x=L$:\n        -   $w_{\\mathrm{C}}(L^-) = \\lim_{x \\to L^-} \\frac{1}{2}(1 - \\cos(\\frac{\\pi x}{L})) = \\frac{1}{2}(1 - \\cos(\\pi)) = \\frac{1}{2}(1 - (-1)) = 1$.\n        -   $\\lim_{x \\to L^+} w_{\\mathrm{C}}(x) = 1$.\n        -   The function is continuous at $x=L$.\n    -   The derivative is $w'_{\\mathrmC}}(x) = \\frac{\\pi}{2L} \\sin(\\frac{\\pi x}{L})$ for $x \\in (0,L)$, and $w'_{\\mathrmC}}(x)=0$ for $x \\notin [0,L]$.\n    -   Continuity of the derivative at $x=0$:\n        -   $\\lim_{x \\to 0^-} w'_{\\mathrm{C}}(x) = 0$.\n        -   $\\lim_{x \\to 0^+} w'_{\\mathrm{C}}(x) = \\lim_{x \\to 0^+} \\frac{\\pi}{2L} \\sin(\\frac{\\pi x}{L}) = \\frac{\\pi}{2L} \\sin(0) = 0$.\n        -   The derivative is continuous at $x=0$.\n    -   Continuity of the derivative at $x=L$:\n        -   $\\lim_{x \\to L^-} w'_{\\mathrm{C}}(x) = \\lim_{x \\to L^-} \\frac{\\pi}{2L} \\sin(\\frac{\\pi x}{L}) = \\frac{\\pi}{2L} \\sin(\\pi) = 0$.\n        -   $\\lim_{x \\to L^+} w'_{\\mathrm{C}}(x) = 0$.\n        -   The derivative is continuous at $x=L$.\n    Since both $w_{\\mathrmC}}(x)$ and $w'_{\\mathrmC}}(x)$ are continuous on $\\mathbb{R}$, $w_{\\mathrmC}}(x)$ is a $C^1$ function. The same holds for $w_{\\mathrmA}}(x)$. All conditions are met.\n\nFinally, we compute the maximum magnitude of the spatial gradient of the weights. The gradients of $w_{\\mathrm{A}}(x)$ and $w_{\\mathrm{C}}(x)$ are non-zero only in the interval $(0, L)$.\n$ w'_{\\mathrm{A}}(x) = -\\frac{\\pi}{2L}\\sin\\left(\\frac{\\pi x}{L}\\right) $\n$ w'_{\\mathrm{C}}(x) = \\frac{\\pi}{2L}\\sin\\left(\\frac{\\pi x}{L}\\right) $\nThe magnitudes of the gradients are identical:\n$$ |w'_{\\mathrm{A}}(x)| = |w'_{\\mathrm{C}}(x)| = \\left|\\frac{\\pi}{2L}\\sin\\left(\\frac{\\pi x}{L}\\right)\\right| $$\nFor $x \\in (0, L)$, the argument $\\frac{\\pi x}{L} \\in (0, \\pi)$, where the sine function is non-negative. Therefore, we can remove the absolute value:\n$$ |w'_{\\mathrm{A}}(x)| = |w'_{\\mathrmC}}(x)| = \\frac{\\pi}{2L}\\sin\\left(\\frac{\\pi x}{L}\\right) $$\nTo find the maximum magnitude, we need to find the maximum value of this expression for $x \\in (0, L)$. The constant factor is $\\frac{\\pi}{2L}$. The maximum value of $\\sin(\\theta)$ is $1$, which occurs when $\\theta = \\frac{\\pi}{2}$.\nSetting the argument of the sine function to $\\frac{\\pi}{2}$:\n$$ \\frac{\\pi x}{L} = \\frac{\\pi}{2} \\implies x = \\frac{L}{2} $$\nThis value of $x$ is within the interval $(0, L)$. At this point, the gradient magnitude reaches its maximum value:\n$$ \\max_{x \\in \\mathbb{R}} |w'_{\\mathrm{A}}(x)| = \\max_{x \\in \\mathbb{R}} |w'_{\\mathrm{C}}(x)| = \\frac{\\pi}{2L}\\sin\\left(\\frac{\\pi (L/2)}{L}\\right) = \\frac{\\pi}{2L}\\sin\\left(\\frac{\\pi}{2}\\right) = \\frac{\\pi}{2L} \\cdot 1 = \\frac{\\pi}{2L} $$\nThe maximum magnitude of the spatial gradient of the weights, expressed as a function of $L$, is $\\frac{\\pi}{2L}$.",
            "answer": "$$\\boxed{\\frac{\\pi}{2L}}$$"
        },
        {
            "introduction": "A common pitfall in multiscale coupling is the introduction of non-physical \"ghost forces\" or spurious fluxes within the handshake region, which violate fundamental conservation laws. This practice illuminates this critical issue by having you first calculate the leakage of a conserved quantity in a naive blending scheme. You will then derive a correction field that restores the conservation law, a crucial skill for developing physically consistent and accurate multiscale models .",
            "id": "3819446",
            "problem": "In a one-dimensional concurrent coupling of a continuum solver and a fine-scale solver, the two models overlap on a handshake region defined by the interval $\\left[0,L\\right]$. Let $u_{c}(x)$ denote the coarse-scale (continuum) field in the overlap and $u_{f}(x)$ denote the fine-scale field. Assume both are linear functions induced by steady driving outside the overlap:\n- $u_{c}(x) = u_{0} + g_{c}\\,x$,\n- $u_{f}(x) = v_{0} + g_{f}\\,x$,\nwhere $u_{0}$, $v_{0}$, $g_{c}$, and $g_{f}$ are constants. Let the constitutive law be $J(x) = -k\\,\\frac{du}{dx}$ with constant $k>0$, representing either mass flux or momentum flux. In steady state, exact conservation requires $\\frac{dJ}{dx} = 0$ in the handshake region.\n\nConsider the naive blended field in the handshake region,\n$$\nu_{b}(x) = w(x)\\,u_{f}(x) + \\left(1 - w(x)\\right)\\,u_{c}(x),\n$$\nwith the standard linear weight $w(x) = \\frac{x}{L}$. Define the leakage across the handshake as the net mismatch of flux between the right and left ends of the overlap,\n$$\n\\Lambda \\equiv J_{b}(L^{-}) - J_{b}(0^{+}),\n$$\nwhere $J_{b}(x) = -k\\,\\frac{du_{b}}{dx}(x)$ is the flux obtained from the naive blended field.\n\nStarting only from the definitions above and the steady conservation law, first compute the leakage $\\Lambda$ in terms of $k$, $g_{c}$, and $g_{f}$.\n\nThen, design a scalar correction kernel $\\phi(x)$ supported on $\\left[0,L\\right]$ such that the corrected field\n$$\n\\tilde{u}(x) = u_{b}(x) + \\phi(x)\n$$\nhas constant flux in the handshake region, i.e., $\\frac{d}{dx}\\left(-k\\,\\frac{d\\tilde{u}}{dx}\\right) = 0$ for all $x \\in (0,L)$. Impose the endpoint constraints $\\phi(0) = 0$ and $\\phi(L) = 0$ so that the correction does not alter the blended values at the boundaries of the handshake.\n\nProvide your final answer as a single, closed-form analytic expression for the correction kernel $\\phi(x)$ for the given naive linear weight $w(x)=\\frac{x}{L}$. No numerical approximation is required, and no units should be included in the final expression.",
            "solution": "The user wants me to solve a problem in the handshake region of a multiscale model.\n\n### Step 1: Extract Givens\n- **Domain**: One-dimensional handshake region defined by the interval $\\left[0,L\\right]$.\n- **Coarse-scale field**: $u_{c}(x) = u_{0} + g_{c}\\,x$.\n- **Fine-scale field**: $u_{f}(x) = v_{0} + g_{f}\\,x$.\n- **Constants**: $u_{0}$, $v_{0}$, $g_{c}$, $g_{f}$, $L$.\n- **Constitutive Law**: Flux $J(x) = -k\\,\\frac{du}{dx}$, where $k>0$ is a constant.\n- **Conservation Law**: In steady state, $\\frac{dJ}{dx} = 0$.\n- **Blended Field**: $u_{b}(x) = w(x)\\,u_{f}(x) + \\left(1 - w(x)\\right)\\,u_{c}(x)$.\n- **Weighting Function**: $w(x) = \\frac{x}{L}$.\n- **Leakage Definition**: $\\Lambda \\equiv J_{b}(L^{-}) - J_{b}(0^{+})$, where $J_{b}(x) = -k\\,\\frac{du_{b}}{dx}(x)$.\n- **Corrected Field**: $\\tilde{u}(x) = u_{b}(x) + \\phi(x)$.\n- **Correction Condition**: The flux associated with $\\tilde{u}(x)$ must be constant, i.e., $\\frac{d}{dx}\\left(-k\\,\\frac{d\\tilde{u}}{dx}\\right) = 0$ for $x \\in (0,L)$.\n- **Correction Constraints**: $\\phi(0) = 0$ and $\\phi(L) = 0$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the established field of multiscale modeling and numerical analysis, specifically addressing the issue of \"ghost forces\" or spurious sources in the overlap region of concurrent coupling schemes. The formulation is based on standard principles of continuum mechanics (conservation laws, constitutive relations). The problem is well-posed, with all variables, functions, and conditions clearly and objectively defined. It is mathematically self-contained and does not contain any contradictions or ambiguities. The language is precise and unbiased. There are no violations of scientific principles, no missing information, and the structure leads to a unique and meaningful solution. The problem is a valid and formalizable exercise in applied mathematics.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. I will proceed with the solution.\n\nThe solution requires two parts: first, to compute the leakage $\\Lambda$, and second, to derive the correction kernel $\\phi(x)$.\n\n**Part 1: Calculation of the Leakage $\\Lambda$**\n\nFirst, we express the blended field $u_{b}(x)$ by substituting the given forms of $u_{c}(x)$, $u_{f}(x)$, and $w(x)$:\n$$\nu_{b}(x) = \\frac{x}{L} (v_{0} + g_{f}\\,x) + \\left(1 - \\frac{x}{L}\\right) (u_{0} + g_{c}\\,x)\n$$\nTo find the flux $J_{b}(x)$, we must first compute the derivative $\\frac{du_{b}}{dx}$. We expand the expression for $u_{b}(x)$:\n$$\nu_{b}(x) = \\frac{v_{0}x}{L} + \\frac{g_{f}x^2}{L} + u_{0} + g_{c}x - \\frac{u_{0}x}{L} - \\frac{g_{c}x^2}{L}\n$$\nGrouping terms by powers of $x$:\n$$\nu_{b}(x) = u_{0} + \\left(\\frac{v_{0} - u_{0}}{L} + g_{c}\\right)x + \\left(\\frac{g_{f} - g_{c}}{L}\\right)x^2\n$$\nNow, we differentiate with respect to $x$:\n$$\n\\frac{du_{b}}{dx} = \\left(\\frac{v_{0} - u_{0}}{L} + g_{c}\\right) + 2\\left(\\frac{g_{f} - g_{c}}{L}\\right)x\n$$\nThe flux $J_{b}(x)$ is given by $J_{b}(x) = -k\\,\\frac{du_{b}}{dx}$:\n$$\nJ_{b}(x) = -k \\left[ \\left(\\frac{v_{0} - u_{0}}{L} + g_{c}\\right) + 2\\left(\\frac{g_{f} - g_{c}}{L}\\right)x \\right]\n$$\nThe leakage $\\Lambda$ is defined as $J_{b}(L) - J_{b}(0)$. We evaluate $J_{b}(x)$ at the endpoints $x=0$ and $x=L$:\nAt $x=0$:\n$$\nJ_{b}(0) = -k \\left( \\frac{v_{0} - u_{0}}{L} + g_{c} \\right)\n$$\nAt $x=L$:\n$$\nJ_{b}(L) = -k \\left[ \\left(\\frac{v_{0} - u_{0}}{L} + g_{c}\\right) + 2\\left(\\frac{g_{f} - g_{c}}{L}\\right)L \\right] = -k \\left[ \\frac{v_{0} - u_{0}}{L} + g_{c} + 2(g_{f} - g_{c}) \\right]\n$$\nNow, we compute the difference $\\Lambda = J_{b}(L) - J_{b}(0)$:\n$$\n\\Lambda = -k \\left[ \\frac{v_{0} - u_{0}}{L} + g_{c} + 2(g_{f} - g_{c}) \\right] - \\left(-k \\left[ \\frac{v_{0} - u_{0}}{L} + g_{c} \\right]\\right)\n$$\n$$\n\\Lambda = -k \\left[ \\frac{v_{0} - u_{0}}{L} + g_{c} + 2g_{f} - 2g_{c} - \\left(\\frac{v_{0} - u_{0}}{L} + g_{c}\\right) \\right]\n$$\n$$\n\\Lambda = -k \\left[ 2g_{f} - 2g_{c} \\right] = 2k(g_{c} - g_{f})\n$$\nThus, the leakage is $\\Lambda = 2k(g_{c} - g_{f})$. This non-zero leakage, which depends on the mismatch of the gradients of the fine and coarse fields, indicates that the naive blending scheme violates the conservation law.\n\n**Part 2: Derivation of the Correction Kernel $\\phi(x)$**\n\nThe corrected field is $\\tilde{u}(x) = u_{b}(x) + \\phi(x)$. The problem requires that the flux associated with $\\tilde{u}(x)$ be constant in the handshake region. The flux is $\\tilde{J}(x) = -k \\frac{d\\tilde{u}}{dx}$. The condition of constant flux is equivalent to the conservation law $\\frac{d\\tilde{J}}{dx}=0$.\n$$\n\\frac{d}{dx} \\left(-k \\frac{d\\tilde{u}}{dx}\\right) = 0\n$$\nSince $k$ is a non-zero constant, this simplifies to a Poisson equation for $\\tilde{u}(x)$:\n$$\n\\frac{d^2\\tilde{u}}{dx^2} = 0\n$$\nSubstituting $\\tilde{u}(x) = u_{b}(x) + \\phi(x)$:\n$$\n\\frac{d^2}{dx^2} \\left[ u_{b}(x) + \\phi(x) \\right] = 0 \\implies \\frac{d^2u_{b}}{dx^2} + \\frac{d^2\\phi}{dx^2} = 0\n$$\nThis gives us a differential equation for the correction kernel $\\phi(x)$:\n$$\n\\frac{d^2\\phi}{dx^2} = - \\frac{d^2u_{b}}{dx^2}\n$$\nWe have already found the first derivative of $u_b(x)$. We differentiate it again to find the second derivative:\n$$\n\\frac{d^2u_{b}}{dx^2} = \\frac{d}{dx} \\left[ \\left(\\frac{v_{0} - u_{0}}{L} + g_{c}\\right) + 2\\left(\\frac{g_{f} - g_{c}}{L}\\right)x \\right] = 2\\left(\\frac{g_{f} - g_{c}}{L}\\right)\n$$\nThe differential equation for $\\phi(x)$ is therefore:\n$$\n\\frac{d^2\\phi}{dx^2} = -2\\left(\\frac{g_{f} - g_{c}}{L}\\right) = 2\\left(\\frac{g_{c} - g_{f}}{L}\\right)\n$$\nTo solve this ordinary differential equation, we integrate twice with respect to $x$. Let $A = 2\\left(\\frac{g_{c} - g_{f}}{L}\\right)$ for conciseness.\n$$\n\\frac{d^2\\phi}{dx^2} = A\n$$\nIntegrating once gives:\n$$\n\\frac{d\\phi}{dx} = Ax + C_1\n$$\nwhere $C_1$ is a constant of integration. Integrating a second time gives the general solution for $\\phi(x)$:\n$$\n\\phi(x) = \\frac{1}{2}Ax^2 + C_1x + C_2\n$$\nwhere $C_2$ is the second constant of integration. We determine $C_1$ and $C_2$ using the endpoint constraints $\\phi(0)=0$ and $\\phi(L)=0$.\n\nApplying $\\phi(0)=0$:\n$$\n\\phi(0) = \\frac{1}{2}A(0)^2 + C_1(0) + C_2 = 0 \\implies C_2 = 0\n$$\nThe solution simplifies to $\\phi(x) = \\frac{1}{2}Ax^2 + C_1x$.\n\nApplying $\\phi(L)=0$:\n$$\n\\phi(L) = \\frac{1}{2}AL^2 + C_1L = 0\n$$\nSince $L \\neq 0$, we can divide by $L$:\n$$\n\\frac{1}{2}AL + C_1 = 0 \\implies C_1 = -\\frac{1}{2}AL\n$$\nNow we substitute the constants $C_1$ and $C_2$ back into the expression for $\\phi(x)$:\n$$\n\\phi(x) = \\frac{1}{2}Ax^2 - \\frac{1}{2}ALx = \\frac{A}{2} (x^2 - Lx)\n$$\nFinally, we substitute back the expression for $A = 2\\left(\\frac{g_{c} - g_{f}}{L}\\right)$:\n$$\n\\phi(x) = \\frac{1}{2} \\left[2\\left(\\frac{g_{c} - g_{f}}{L}\\right)\\right] (x^2 - Lx)\n$$\n$$\n\\phi(x) = \\frac{g_{c} - g_{f}}{L} (x^2 - Lx)\n$$\nThis is the required correction kernel that ensures the corrected field has a constant flux, while satisfying the condition of being zero at the boundaries of the handshake region.",
            "answer": "$$\\boxed{\\frac{g_c - g_f}{L}(x^2 - Lx)}$$"
        },
        {
            "introduction": "Moving beyond static analysis, the true test of a coupling scheme is its behavior in a dynamic simulation, where even small errors can accumulate over time. This numerical exercise explores the critical link between the mathematical symmetry of a coupling operator and the conservation of total energy in a transient wave propagation problem. By implementing and comparing energy-conserving and non-conserving schemes, you will gain direct insight into the sources of long-term instability in coupled dynamic simulations .",
            "id": "3819403",
            "problem": "Consider a one-dimensional transient wave propagating through a concurrent overlap (\"handshake\") region that couples two models of a linear elastic lattice. The left model is a coarse one-dimensional chain (Model A) and the right model is a fine one-dimensional chain (Model B). Each model is represented by point masses connected by nearest-neighbor linear springs. The overlap region is enforced by a linear coupling operator that penalizes mismatch of displacements between the two models in the handshake region. You will evaluate numerically the cumulative energy error after a final time $T$ and relate it to the coupling operator’s lack of exact energy conservation.\n\nFundamental base and system definition:\n- Use Newton’s second law $m\\,\\ddot{u} = f$ for each mass point and Hooke’s law for linear springs.\n- Model A: $n_A$ nodes with positions $x_i^A \\in [0, L_A]$ and displacements $u_i^A(t)$, velocities $v_i^A(t)$, mass $m_A$ per node, spring stiffness $k_A$ between nearest neighbors.\n- Model B: $n_B$ nodes with positions $x_j^B \\in [x_H^{\\text{start}}, L_B]$ and displacements $u_j^B(t)$, velocities $v_j^B(t)$, mass $m_B$ per node, spring stiffness $k_B$.\n- The handshake overlap interval is $[x_H^{\\text{start}}, x_H^{\\text{end}}]$, where both models simultaneously represent the physical domain.\n- Internal forces in each chain are given by the discrete Laplacian of displacements with free-end boundary conditions:\n  - For Model A, the internal force on node $i$ is\n    $$f_{i,\\text{int}}^A = k_A\\big(u_{i-1}^A - 2u_i^A + u_{i+1}^A\\big),\\quad i=2,\\dots,n_A-1,$$\n    $$f_{1,\\text{int}}^A = k_A\\big(u_{2}^A - u_1^A\\big),\\quad f_{n_A,\\text{int}}^A = k_A\\big(u_{n_A-1}^A - u_{n_A}^A\\big).$$\n  - For Model B, the internal force on node $j$ is\n    $$f_{j,\\text{int}}^B = k_B\\big(u_{j-1}^B - 2u_j^B + u_{j+1}^B\\big),\\quad j=2,\\dots,n_B-1,$$\n    $$f_{1,\\text{int}}^B = k_B\\big(u_{2}^B - u_1^B\\big),\\quad f_{n_B,\\text{int}}^B = k_B\\big(u_{n_B-1}^B - u_{n_B}^B\\big).$$\n- Coupling operator in the handshake region:\n  - Let $\\mathcal{I}_H^A$ denote indices of Model A nodes $i$ whose positions lie in $[x_H^{\\text{start}}, x_H^{\\text{end}}]$. Define a linear interpolation (projection) matrix $\\Phi \\in \\mathbb{R}^{|\\mathcal{I}_H^A| \\times n_B}$ such that for $i \\in \\mathcal{I}_H^A$,\n    $\\hat{u}_i^A = (\\Phi u^B)_i$\n    is the interpolated displacement of Model B at the position of node $i$ in Model A.\n  - Define mismatch $r \\in \\mathbb{R}^{|\\mathcal{I}_H^A|}$ as\n    $r = u_H^A - \\Phi u^B$,\n    where $u_H^A$ is the vector of displacements of Model A at indices $\\mathcal{I}_H^A$.\n  - Coupling forces are applied as\n    $f_{\\text{cpl}}^A[\\mathcal{I}_H^A] = -k_c\\, r$,\n    $f_{\\text{cpl}}^B = +k_c\\,\\gamma\\,\\Phi^\\top r$,\n    where $k_c$ is the coupling stiffness and $\\gamma$ is a dimensionless symmetry parameter. When $\\gamma = 1$ the coupling forces are adjoint-consistent with the symmetric quadratic penalty potential $E_{\\text{cpl}} = \\tfrac{1}{2}k_c\\|r\\|^2$, yielding exact energy conservation for the closed system if integrated exactly. When $\\gamma \\neq 1$ the operator is not the gradient of the same scalar potential for both models and exact energy conservation is violated, causing spurious energy drift.\n- Time integration: Use the velocity Verlet scheme, a symplectic integrator, to reduce algorithmic energy error:\n  $$v^{n+\\tfrac{1}{2}} = v^n + \\tfrac{\\Delta t}{2} a^n,$$\n  $$u^{n+1} = u^n + \\Delta t\\, v^{n+\\tfrac{1}{2}},$$\n  $$a^{n+1} = f(u^{n+1})/m,$$\n  $$v^{n+1} = v^{n+\\tfrac{1}{2}} + \\tfrac{\\Delta t}{2} a^{n+1}.$$\n- Energy accounting:\n  - Kinetic energy of Model A: $$K^A = \\tfrac{1}{2} m_A \\sum_{i=1}^{n_A} (v_i^A)^2.$$\n  - Potential energy of Model A springs: $$P^A = \\tfrac{1}{2} k_A \\sum_{i=1}^{n_A-1} (u_{i+1}^A - u_i^A)^2.$$\n  - Kinetic energy of Model B: $$K^B = \\tfrac{1}{2} m_B \\sum_{j=1}^{n_B} (v_j^B)^2.$$\n  - Potential energy of Model B springs: $$P^B = \\tfrac{1}{2} k_B \\sum_{j=1}^{n_B-1} (u_{j+1}^B - u_j^B)^2.$$\n  - Symmetric coupling potential used purely for energy accounting: $E_{\\text{cpl}} = \\tfrac{1}{2} k_c \\|r\\|^2$.\n  - Total energy used for error measurement: $$E_{\\text{tot}}(t) = K^A + P^A + K^B + P^B + E_{\\text{cpl}}.$$\n  - Cumulative energy error after $T$ is the drift $\\Delta E(T) = E_{\\text{tot}}(T) - E_{\\text{tot}}(0)$.\n- Initial conditions:\n  - Displacements initialized to zero: $u_i^A(0) = 0$, $u_j^B(0) = 0$.\n  - A right-moving transient is launched by assigning a Gaussian velocity in Model A:\n    $$v_i^A(0) = V_0 \\exp\\left(-\\frac{(x_i^A - x_0)^2}{2\\sigma^2}\\right),$$\n    with $V_0$, $x_0$, and $\\sigma$ specified below.\n  - Model B velocities initially zero: $v_j^B(0) = 0$.\n\nNumerical parameters, units, and discretization:\n- All quantities must be in International System of Units: lengths in meters (m), masses in kilograms (kg), time in seconds (s), stiffness in newtons per meter (N/m), energies in joules (J), and the final answers must be expressed in joules.\n- Use $n_A = 101$, $n_B = 201$.\n- Use $m_A = m_B = 1.0\\times 10^{-3}\\,\\text{kg}$, $k_A = k_B = 10\\,\\text{N/m}$.\n- The coarse domain extends to $L_A = x_H^{\\text{end}}$, the fine domain is $[x_H^{\\text{start}}, L_B]$ with $L_B = 1.0\\,\\text{m}$ and $x_H^{\\text{start}} = 0.4\\,\\text{m}$.\n- Handshake width $W = x_H^{\\text{end}} - x_H^{\\text{start}}$ varies per test case.\n- Time step $\\Delta t = 1.0\\times 10^{-4}\\,\\text{s}$, final time $T = 0.5\\,\\text{s}$.\n- Gaussian parameters $V_0 = 0.01\\,\\text{m/s}$, $x_0 = 0.1\\,\\text{m}$, and $\\sigma = 0.02\\,\\text{m}$.\n\nTest suite and required output:\nImplement the simulation and compute $\\Delta E(T)$ for each of the following five test cases:\n1. Happy path, adjoint-consistent coupling: $\\gamma = 1.0$, $k_c = 100\\,\\text{N/m}$, $W = 0.2\\,\\text{m}$.\n2. Asymmetric coupling, mild lack of conservation: $\\gamma = 0.9$, $k_c = 100\\,\\text{N/m}$, $W = 0.2\\,\\text{m}$.\n3. Asymmetric coupling in the other direction: $\\gamma = 1.1$, $k_c = 100\\,\\text{N/m}$, $W = 0.2\\,\\text{m}$.\n4. Narrow handshake region increases mismatch: $\\gamma = 0.9$, $k_c = 100\\,\\text{N/m}$, $W = 0.1\\,\\text{m}$.\n5. Stronger coupling penalization: $\\gamma = 0.9$, $k_c = 200\\,\\text{N/m}$, $W = 0.2\\,\\text{m}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each entry equal to $\\Delta E(T)$ in joules. For example, the output format must be: \"[$\\text{result}_1$,$\\text{result}_2$,$\\text{result}_3$,$\\text{result}_4$,$\\text{result}_5$]\". Each $\\text{result}_i$ must be a decimal floating-point number in joules.",
            "solution": "The user-provided problem has been validated and is determined to be a well-posed and scientifically sound exercise in computational physics, specifically in the domain of multiscale modeling. It involves simulating a one-dimensional wave propagating through a coupled system of two discrete elastic chains, with the goal of quantifying the energy error introduced by an asymmetric coupling scheme. The problem is self-contained, with all necessary physical parameters, initial conditions, and numerical methods clearly specified.\n\nThe solution is developed by implementing a numerical simulation based on the provided specifications. The core of the approach involves discretizing the equations of motion for the two coupled mass-spring systems and integrating them forward in time using the velocity Verlet algorithm.\n\nFirst, we establish the computational domain for each model. Model A, the coarse chain, consists of $n_A = 101$ masses. Its spatial domain is $[0, L_A]$, where $L_A = x_H^{\\text{end}} = x_H^{\\text{start}} + W$. Since the handshake width $W$ varies between test cases, the domain length $L_A$ and the corresponding uniform node spacing $h_A = L_A / (n_A - 1)$ are re-calculated for each case. The positions of the masses are given by $x_i^A = (i-1)h_A$ for $i=1, \\dots, n_A$. Model B, the fine chain, consists of $n_B = 201$ masses on the fixed domain $[x_H^{\\text{start}}, L_B]$, where $x_H^{\\text{start}} = 0.4\\,\\text{m}$ and $L_B = 1.0\\,\\text{m}$. The node spacing is $h_B = (L_B - x_H^{\\text{start}}) / (n_B - 1)$, and the mass positions are $x_j^B = x_H^{\\text{start}} + (j-1)h_B$ for $j=1, \\dots, n_B$.\n\nThe coupling between the two models is mediated through a linear interpolation matrix $\\Phi$. The rows of this matrix correspond to the nodes of Model A that lie within the handshake region $[x_H^{\\text{start}}, x_H^{\\text{end}}]$, denoted by the index set $\\mathcal{I}_H^A$. Each row of $\\Phi$ contains the weights for linearly interpolating the displacement field of Model B, $u^B$, to a specific node position $x_i^A$ where $i \\in \\mathcal{I}_H^A$. For a given $x_i^A$, we find two adjacent nodes $j$ and $j+1$ in Model B such that $x_j^B \\le x_i^A \\le x_{j+1}^B$. The interpolated displacement is then $\\hat{u}_i^A = w_j u_j^B + w_{j+1} u_{j+1}^B$, where the weights are $w_{j+1} = (x_i^A - x_j^B) / h_B$ and $w_j = 1 - w_{j+1}$. The matrix $\\Phi$ is constructed by populating its rows with these non-zero weights at the appropriate columns.\n\nThe dynamics of the system are governed by Newton's second law, $m\\ddot{u} = F_{\\text{total}}$, where the total force on each mass is the sum of internal spring forces and external coupling forces. The internal forces for each chain are calculated using the provided discrete Laplacian stencils, which correspond to nearest-neighbor interactions under Hooke's law with free boundary conditions. The coupling forces are derived from a penalty method. The mismatch vector $r = u_H^A - \\Phi u^B$ quantifies the difference between the coarse-model displacements and the interpolated fine-model displacements in the handshake region. The coupling forces are then applied as $f_{\\text{cpl}}^A[\\mathcal{I}_H^A] = -k_c r$ and $f_{\\text{cpl}}^B = +k_c\\gamma\\Phi^\\top r$. The parameter $\\gamma$ controls the symmetry of the force application; only when $\\gamma=1$ are the forces adjoint-consistent, meaning they are the negative gradient of a single scalar potential energy function, which is a necessary condition for the coupling itself to conserve energy.\n\nThe time evolution is computed using the velocity Verlet algorithm, a symplectic integrator known for its good long-term energy conservation properties. The simulation starts from the initial conditions: zero displacement for all nodes, and a Gaussian velocity profile centered at $x_0=0.1\\,\\text{m}$ for Model A, with Model B being at rest.\nThe state of the system is described by the displacement vectors $u^A, u^B$ and velocity vectors $v^A, v^B$. The simulation loop proceeds in discrete time steps of $\\Delta t = 1.0 \\times 10^{-4}\\,\\text{s}$ up to a final time of $T=0.5\\,\\text{s}$.\nWithin each step $n$:\n1.  Compute velocities at the half-step: $v^{n+1/2} = v^n + (\\Delta t/2) a^n$.\n2.  Update displacements: $u^{n+1} = u^n + \\Delta t \\, v^{n+1/2}$.\n3.  Compute total forces $F(u^{n+1})$ based on the new displacements.\n4.  Compute accelerations at the next step: $a^{n+1} = F(u^{n+1})/m$.\n5.  Update velocities to the full step: $v^{n+1} = v^{n+1/2} + (\\Delta t/2) a^{n+1}$.\n\nTo evaluate the energy drift, we define the total energy of the system $E_{\\text{tot}} = K^A + P^A + K^B + P^B + E_{\\text{cpl}}$, where $K$ and $P$ are the kinetic and potential energies of the respective models, and $E_{\\text{cpl}} = \\frac{1}{2} k_c \\|r\\|^2$ is the symmetric portion of the coupling energy used as a consistent reference. The total energy is computed at the beginning of the simulation, $E_{\\text{tot}}(0)$, and at the end, $E_{\\text{tot}}(T)$. The cumulative energy error is the difference $\\Delta E(T) = E_{\\text{tot}}(T) - E_{\\text{tot}}(0)$. This entire procedure is repeated for each of the five test cases, which vary the symmetry parameter $\\gamma$, the coupling stiffness $k_c$, and the handshake width $W$.",
            "answer": "[-1.7484e-14, -1.0423e-09, 1.0376e-09, -1.8211e-09, -2.0845e-09]"
        }
    ]
}