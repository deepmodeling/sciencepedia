{
    "hands_on_practices": [
        {
            "introduction": "要真正理解“鬼力”，最好的方法是从第一性原理出发，亲手推导它的存在。本练习提供了一个基础场景：一个简单的一维谐振子原子链与一个连续介质单元耦合。通过直接从能量泛函计算节点力，您将揭示在均匀应变状态下，本应处于平衡的界面处出现的不平衡力，从而理解鬼力的根本来源 。",
            "id": "3765543",
            "problem": "考虑一个一维谐振原子链，其原子索引为 $i \\in \\{-N_{\\mathrm{a}},\\ldots,-1,0,1,\\ldots,M\\}$，参考晶格间距为 $a>0$。设形变后的位置为 $y_i \\in \\mathbb{R}$，并假设存在最近邻相互作用，其二次键能为 $\\frac{k}{2}\\big((y_{i+1}-y_i)-a\\big)^2$，其中 $k>0$ 为弹簧刚度。该链被划分为左侧的原子次区域 $\\mathcal{A}=\\{-N_{\\mathrm{a}},\\ldots,0\\}$ 和右侧的连续介质次区域 $\\mathcal{C}=\\{1,\\ldots,M\\}$，后者被粗化为单个有限元，其节点位于原子 $i=1$ 和 $i=M$ 处。连续介质能量通过 Cauchy–Born 法则建模：单位参考长度的应变能密度为 $W(F)=\\frac{k a}{2}(F-1)^2$，其中 $F$ 是一维形变梯度。原子-连续介质耦合由基于能量的准连续介质 (QCE) 泛函定义\n$$\n\\mathcal{E}_{\\mathrm{QCE}}(y) \\;=\\; \\sum_{i=-N_{\\mathrm{a}}}^{-1} \\frac{k}{2}\\big((y_{i+1}-y_i)-a\\big)^2 \\;+\\; \\int_{X=a}^{X=M a} W(F)\\,\\mathrm{d}X,\n$$\n其中连续介质单元应变 $F$ 通过连续介质节点之间的线性插值在 $\\mathcal{C}$ 上取为分段常数，即\n$$\nF \\;=\\; \\frac{y_M - y_1}{(M-1)a}.\n$$\n在此耦合中，跨界面键 $(0,1)$ 未包含在原子能量中，也没有特殊的界面修正。\n\n(a) 从能量最小化和静力平衡（外部体力为零）的基本原理出发，通过计算 $\\mathcal{E}_{\\mathrm{QCE}}(y)$ 关于原子自由度 $y_i$（其中 $i\\in\\{-N_{\\mathrm{a}}+1,\\ldots,0\\}$）和连续介质节点自由度 $y_1$ 及 $y_M$ 的一阶变分，推导 QCE 模型的平稳性（平衡）方程。\n\n(b) 考虑均匀形变 $y_i=(1+\\epsilon)\\, i\\, a$，其应变为恒定值 $\\epsilon \\in \\mathbb{R}$，该形变由施加在最外层原子 $y_{-N_{\\mathrm{a}}}=-(1+\\epsilon)N_{\\mathrm{a}}a$ 和 $y_M=(1+\\epsilon) M a$ 上的 Dirichlet 边界条件以及无外力条件所确定。使用 (a) 部分推导的 QCE 平衡方程，解析计算在这种均匀应变状态下，第一个连续介质节点 $i=1$ 处的残余内力（伪力）。以牛顿 (N) 为单位表示伪力的最终答案。无需四舍五入；请提供以 $k$、$a$ 和 $\\epsilon$ 表示的精确闭式表达式。",
            "solution": "该问题是有效的，因为它的科学基础在于计算多尺度建模的原理，特别是准连续介质 (QC) 方法。该问题是适定的、客观的、自洽的，并描述了一个标准的（尽管简化的）场景，用于演示在原子-连续介质界面上由不一致的基于能量的耦合引起的众所周知的赝象——“伪力”。其推导和计算在数学上是合理的，并阐述了该领域的一个核心概念。\n\n按照要求，解答分为两部分。\n\n(a) 平稳性（平衡）方程的推导\n\n基于能量的准连续介质 (QCE) 泛函由下式给出\n$$\n\\mathcal{E}_{\\mathrm{QCE}}(y) \\;=\\; \\sum_{i=-N_{\\mathrm{a}}}^{-1} \\frac{k}{2}\\big((y_{i+1}-y_i)-a\\big)^2 \\;+\\; \\int_{X=a}^{X=M a} W(F)\\,\\mathrm{d}X\n$$\n其中 $y$ 是所有原子位置 $y_i$ 的向量，应变能密度为 $W(F)=\\frac{k a}{2}(F-1)^2$，形变梯度 $F$ 在连续介质单元上是常数，$F = \\frac{y_M - y_1}{(M-1)a}$。由于被积函数在长度为 $(M-1)a$ 的积分域 $[a, Ma]$ 上是常数，该积分可以直接计算：\n$$\n\\int_{X=a}^{X=M a} W(F)\\,\\mathrm{d}X = (M-1)a \\cdot W(F) = (M-1)a \\cdot \\frac{k a}{2}(F-1)^2 = \\frac{ka^2(M-1)}{2} \\left( \\frac{y_M-y_1}{(M-1)a} - 1 \\right)^2.\n$$\n因此，总能量泛函可以写为：\n$$\n\\mathcal{E}_{\\mathrm{QCE}}(y) = \\sum_{i=-N_{\\mathrm{a}}}^{-1} \\frac{k}{2}(y_{i+1}-y_i-a)^2 + \\frac{ka^2(M-1)}{2} \\left( \\frac{y_M-y_1}{(M-1)a} - 1 \\right)^2.\n$$\n静力平衡方程是通过要求能量的一阶变分为零来获得的，对于离散系统，这对应于将能量对每个无约束自由度的偏导数设为零。原子 $j$ 上的力为 $f_j = -\\frac{\\partial \\mathcal{E}_{\\mathrm{QCE}}}{\\partial y_j}$。在无外力平衡状态下，$f_j=0$，因此 $\\frac{\\partial \\mathcal{E}_{\\mathrm{QCE}}}{\\partial y_j} = 0$。\n\n我们计算指定节点的这些导数。\n\n对于内部原子节点 $j \\in \\{-N_{\\mathrm{a}}+1, \\ldots, -1\\}$：\n位置 $y_j$ 出现在原子求和项中的两项里：键 $(j-1, j)$ 和键 $(j, j+1)$。\n$$\n\\frac{\\partial \\mathcal{E}_{\\mathrm{QCE}}}{\\partial y_j} = \\frac{\\partial}{\\partial y_j} \\left[ \\frac{k}{2}(y_j-y_{j-1}-a)^2 + \\frac{k}{2}(y_{j+1}-y_j-a)^2 \\right]\n$$\n$$\n\\frac{\\partial \\mathcal{E}_{\\mathrm{QCE}}}{\\partial y_j} = k(y_j-y_{j-1}-a)(1) + k(y_{j+1}-y_j-a)(-1) = k(y_j-y_{j-1}-a) - k(y_{j+1}-y_j-a).\n$$\n平衡方程为：$k(y_j-y_{j-1}-a) - k(y_{j+1}-y_j-a) = 0$。\n\n对于原子界面节点 $j=0$：\n位置 $y_0$ 仅出现在原子求和中的键 $(-1,0)$ 里，因为求和索引 $i$ 的上限为 $-1$。连续介质能量不依赖于 $y_0$。\n$$\n\\frac{\\partial \\mathcal{E}_{\\mathrm{QCE}}}{\\partial y_0} = \\frac{\\partial}{\\partial y_0} \\left[ \\frac{k}{2}(y_0-y_{-1}-a)^2 \\right] = k(y_0-y_{-1}-a).\n$$\n平衡方程为：$k(y_0-y_{-1}-a) = 0$。\n\n对于连续介质界面节点 $j=1$：\n位置 $y_1$ 仅出现在连续介质能量项中。\n$$\n\\frac{\\partial \\mathcal{E}_{\\mathrm{QCE}}}{\\partial y_1} = \\frac{\\partial}{\\partial y_1} \\left[ \\frac{ka^2(M-1)}{2} \\left( \\frac{y_M-y_1}{(M-1)a} - 1 \\right)^2 \\right]\n$$\n使用链式法则：\n$$\n\\frac{\\partial \\mathcal{E}_{\\mathrm{QCE}}}{\\partial y_1} = \\frac{ka^2(M-1)}{2} \\cdot 2 \\left( \\frac{y_M-y_1}{(M-1)a} - 1 \\right) \\cdot \\frac{\\partial}{\\partial y_1}\\left( \\frac{y_M-y_1}{(M-1)a} \\right)\n$$\n$$\n\\frac{\\partial \\mathcal{E}_{\\mathrm{QCE}}}{\\partial y_1} = ka^2(M-1) \\left( \\frac{y_M-y_1}{(M-1)a} - 1 \\right) \\left( \\frac{-1}{(M-1)a} \\right) = -ka \\left( \\frac{y_M-y_1}{(M-1)a} - 1 \\right).\n$$\n平衡方程为：$-ka \\left( \\frac{y_M-y_1}{(M-1)a} - 1 \\right) = 0$。\n\n对于连续介质边界节点 $j=M$：\n位置 $y_M$ 也仅出现在连续介质能量项中。\n$$\n\\frac{\\partial \\mathcal{E}_{\\mathrm{QCE}}}{\\partial y_M} = \\frac{\\partial}{\\partial y_M} \\left[ \\frac{ka^2(M-1)}{2} \\left( \\frac{y_M-y_1}{(M-1)a} - 1 \\right)^2 \\right]\n$$\n$$\n\\frac{\\partial \\mathcal{E}_{\\mathrm{QCE}}}{\\partial y_M} = ka^2(M-1) \\left( \\frac{y_M-y_1}{(M-1)a} - 1 \\right) \\left( \\frac{1}{(M-1)a} \\right) = ka \\left( \\frac{y_M-y_1}{(M-1)a} - 1 \\right).\n$$\n平衡方程为：$ka \\left( \\frac{y_M-y_1}{(M-1)a} - 1 \\right) = 0$。\n\n(b) 节点 $i=1$ 处伪力的计算\n\n节点 $j$ 处的残余内力，或称伪力，是当系统处于一个本应对应于自然平衡态的均匀形变状态时，该节点上的合力 $f_j = -\\frac{\\partial \\mathcal{E}_{\\mathrm{QCE}}}{\\partial y_j}$。我们针对均匀形变 $y_i=(1+\\epsilon)ia$ 计算节点 $j=1$ 处的这个力。\n\n从 (a) 部分可知，能量对 $y_1$ 的偏导数为：\n$$\n\\frac{\\partial \\mathcal{E}_{\\mathrm{QCE}}}{\\partial y_1} = -ka \\left( \\frac{y_M-y_1}{(M-1)a} - 1 \\right).\n$$\n因此，节点 1 处的伪力为：\n$$\nf_{\\text{ghost},1} = - \\frac{\\partial \\mathcal{E}_{\\mathrm{QCE}}}{\\partial y_1} \\Bigg|_{y_i=(1+\\epsilon)ia} = ka \\left( \\frac{y_M-y_1}{(M-1)a} - 1 \\right) \\Bigg|_{y_i=(1+\\epsilon)ia}.\n$$\n我们将均匀形变的位置代入此表达式。相关节点位置为：\n$$\ny_1 = (1+\\epsilon)(1)a = (1+\\epsilon)a\n$$\n$$\ny_M = (1+\\epsilon)Ma\n$$\n将这些代入伪力的表达式中：\n$$\nf_{\\text{ghost},1} = ka \\left( \\frac{(1+\\epsilon)Ma - (1+\\epsilon)a}{(M-1)a} - 1 \\right)\n$$\n提出分子中的公因子：\n$$\nf_{\\text{ghost},1} = ka \\left( \\frac{(1+\\epsilon)(M-1)a}{(M-1)a} - 1 \\right)\n$$\n消去 $(M-1)a$ 项：\n$$\nf_{\\text{ghost},1} = ka \\left( (1+\\epsilon) - 1 \\right)\n$$\n这可简化为：\n$$\nf_{\\text{ghost},1} = ka\\epsilon.\n$$\n对于 $\\epsilon \\neq 0$，这个非零力就是第一个连续介质节点上的伪力。它表明，由于界面处不一致的力平衡，均匀形变并非 QCE 模型的一个平衡态。该力的产生是由于原子 0 和 1 之间的相互作用在能量泛函中没有被一个离散的原子键所表示，而是被连续介质模型隐式且不一致地加以考虑。该表达式的单位是刚度（$k$，力/长度）乘以长度（$a$），这正确地得出了力的单位，与要求以牛顿 (N) 作答相符。",
            "answer": "$$\\boxed{ka\\epsilon}$$"
        },
        {
            "introduction": "上一个练习展示了特定情况下的鬼力，而本练习将介绍一个更通用、更强大的工具——“补丁测试”（patch test），它是验证多尺度方法一致性的标准。您将把这个测试应用于一个包含更复杂的次近邻相互作用的模型中，以进一步理解朴素的能量耦合方案为何会失效，并学会如何系统地检验模型的可靠性 。",
            "id": "3765615",
            "problem": "考虑一个一维晶体链，其参考晶格位置为 $X_{i} = i a$, $i \\in \\mathbb{Z}$，其中 $a$ 是参考晶格间距。该链通过最近邻和次近邻对势相互作用。通过设置 $a=1$ 并用适当的常数缩放能量和力进行无量纲化后，对相互作用能为\n$$\n\\phi_{1}(r) = \\frac{k_{1}}{2} (r - 1)^{2}, \\qquad \\phi_{2}(r) = \\frac{k_{2}}{2} (r - 2)^{2},\n$$\n其中 $k_{1} > 0$ 和 $k_{2} \\ge 0$ 是无量纲刚度参数，$r$ 表示两个位点之间变形后的键长。\n\n通过将链划分为原子子域 $\\mathcal{A} = \\{ i \\le 0 \\}$ 和连续介质子域 $\\mathcal{C} = \\{ i \\ge 1 \\}$ 来构建多尺度耦合。连续介质子域采用 Cauchy-Born 法则建模，其能量密度为\n$$\nW(F) = \\phi_{1}(F) + \\phi_{2}(2F),\n$$\n其中 $F$ 是（无量纲的）恒定变形梯度，并在标准有限元设置中使用线性形函数进行离散化。耦合能量定义如下：\n- 在原子子域 $\\mathcal{A}$ 中，能量是完全位于 $\\mathcal{A}$ 内部的键的对相互作用之和。\n- 在连续介质子域 $\\mathcal{C}$ 中，能量为 $\\int_{\\Omega_{\\mathcal{C}}} W(F) \\,\\mathrm{d}x$，其中 $\\Omega_{\\mathcal{C}}$ 被视为对应于 $\\{ x \\ge 1 \\}$ 的参考连续介质区域，并且场 $y(x)$ 由线性形函数表示。\n- 所有跨越 $\\mathcal{A}$ 和 $\\mathcal{C}$ 之间界面的键都从能量计算中省略。\n\n补丁测试要求，在均匀变形 $y(x) = F x$ 下，内力（能量相对于所有自由度的负梯度）恒为零。令 $y_{i} = y(X_{i})$ 表示位点 $i$ 的变形后位置，并令 $R_{0}(F)$ 表示界面原子自由度 $y_{0}$ 上的残余内力，其定义为\n$$\nR_{0}(F) = -\\frac{\\partial E^{\\mathrm{cpl}}(y)}{\\partial y_{0}},\n$$\n其中 $E^{\\mathrm{cpl}}(y)$ 是上述的总耦合能量。\n\n在均匀变形 $y(x) = F x$ 和无量纲化 $a=1$ 的条件下，计算 $R_{0}(F)$ 关于 $F$、$k_{1}$ 和 $k_{2}$ 的闭式表达式，并用它来评估该耦合是否满足补丁测试一致性。请以 $R_{0}(F)$ 的单个解析表达式的形式提供您的最终答案。不需要数值计算或四舍五入，所有量都是无量纲的，因此不需要单位。",
            "solution": "该问题要求计算在均匀变形下，特定一维原子-连续介质耦合系统中，界面原子（位于位点 $i=0$）上所受的残余内力。这个残余力通常被称为“伪力”。\n\n首先，我们根据问题给出的定义进行设定。该系统是一个一维原子链，其参考位置为 $X_i = i$（对于 $i \\in \\mathbb{Z}$），因为晶格间距 $a$ 已设为 $1$。原子子域为 $\\mathcal{A} = \\{ i \\le 0 \\}$，连续介质子域为 $\\mathcal{C} = \\{ i \\ge 1 \\}$。原子 $i$ 的变形后位置用 $y_i$ 表示。\n\n耦合系统的总能量 $E^{\\mathrm{cpl}}$ 是原子区域能量 $E_{\\mathcal{A}}$ 和连续介质区域能量 $E_{\\mathcal{C}}$ 的和。问题定义的一个关键部分是，所有跨越 $\\mathcal{A}$ 和 $\\mathcal{C}$ 之间界面的相互作用键都从能量计算中省略。\n\n原子区域的能量 $E_{\\mathcal{A}}$ 是完全位于 $\\mathcal{A}$ 内部的键的所有对相互作用之和。给出的相互作用势为最近邻（NN）和次近邻（NNN）：\nNN 的势为 $\\phi_1(r) = \\frac{k_1}{2}(r-1)^2$，参考长度为 $1$。\nNNN 的势为 $\\phi_2(r) = \\frac{k_2}{2}(r-2)^2$，参考长度为 $2$。\n\n连续介质区域的能量 $E_{\\mathcal{C}}$ 基于能量密度为 $W(F) = \\phi_1(F) + \\phi_2(2F)$ 的连续介质的有限元离散化。$E_{\\mathcal{C}}$ 的自由度是节点位置 $\\{y_i | i \\ge 1\\}$。\n\n界面原子 $y_0$ 上的残余内力定义为 $R_0(F) = -\\frac{\\partial E^{\\mathrm{cpl}}(y)}{\\partial y_0}$，在均匀变形场 $y_i = F X_i = F i$ 下进行计算。\n\n让我们分析总能量 $E^{\\mathrm{cpl}}(y) = E_{\\mathcal{A}}(y) + E_{\\mathcal{C}}(y)$。连续介质能量 $E_{\\mathcal{C}}$ 仅是连续介质节点位置 $\\{y_i | i \\ge 1 \\}$ 的函数。它不依赖于原子自由度 $y_0$。因此，它对 $y_0$ 的偏导数为零：$\\frac{\\partial E_{\\mathcal{C}}}{\\partial y_0} = 0$。\n\n因此，作用在原子 $0$ 上的力完全来自原子能量 $E_{\\mathcal{A}}$：\n$$\n-\\frac{\\partial E^{\\mathrm{cpl}}}{\\partial y_0} = -\\frac{\\partial E_{\\mathcal{A}}}{\\partial y_0}\n$$\n为了计算这个导数，我们需要识别出 $E_{\\mathcal{A}}$ 中所有依赖于 $y_0$ 的项。根据定义，$E_{\\mathcal{A}}$ 包含原子对 $(i, j)$ 之间的相互作用，其中 $i, j$ 均属于 $\\mathcal{A}$，即 $i, j \\le 0$。位置 $y_0$ 涉及到 $\\mathcal{A}$ 内的以下键：\n1.  原子 $0$ 和原子 $-1$ 之间的 NN 键。其能量为 $\\phi_1(y_0 - y_{-1})$。\n2.  原子 $0$ 和原子 $-2$ 之间的 NNN 键。其能量为 $\\phi_2(y_0 - y_{-2})$。\n\n其他任何 $i \\le 0$ 的原子 $i$ 都不与原子 $0$ 形成 NN 或 NNN 键。因此，$E_{\\mathcal{A}}$ 中依赖于 $y_0$ 的部分是 $E_{\\mathcal{A},0} = \\phi_1(y_0 - y_{-1}) + \\phi_2(y_0 - y_{-2})$。$E_{\\mathcal{A}}$ 的完整表达式包含许多其他项，但它们不依赖于 $y_0$，因此它们对 $y_0$ 的导数为零。\n\n$E_{\\mathcal{A}}$ 对 $y_0$ 的偏导数为：\n$$\n\\frac{\\partial E_{\\mathcal{A}}}{\\partial y_0} = \\frac{\\partial}{\\partial y_0} \\left( \\phi_1(y_0 - y_{-1}) + \\phi_2(y_0 - y_{-2}) \\right) = \\phi_1'(y_0 - y_{-1}) + \\phi_2'(y_0 - y_{-2})\n$$\n其中 $\\phi'$ 表示 $\\phi$ 对其自变量的导数。\n\n原子 $0$ 上的内力为 $f_0 = -\\frac{\\partial E_{\\mathcal{A}}}{\\partial y_0} = - \\left( \\phi_1'(y_0 - y_{-1}) + \\phi_2'(y_0 - y_{-2}) \\right)$。\n\n为了求得残余力 $R_0(F)$，我们在均匀变形 $y_i = F i$ 下计算此表达式。键长变为：\n-   NN 键长：$y_0 - y_{-1} = F(0) - F(-1) = F$。\n-   NNN 键长：$y_0 - y_{-2} = F(0) - F(-2) = 2F$。\n\n将这些代入力表达式，得到：\n$$\nR_0(F) = - \\left( \\phi_1'(F) + \\phi_2'(2F) \\right)\n$$\n接下来，我们计算势函数的导数：\n-   $\\phi_1(r) = \\frac{k_1}{2}(r-1)^2 \\implies \\phi_1'(r) = k_1(r-1)$。\n-   $\\phi_2(r) = \\frac{k_2}{2}(r-2)^2 \\implies \\phi_2'(r) = k_2(r-2)$。\n\n在变形后的键长 $F$ 和 $2F$ 处计算这些导数：\n-   $\\phi_1'(F) = k_1(F-1)$。\n-   $\\phi_2'(2F) = k_2(2F-2) = 2k_2(F-1)$。\n\n现在，我们将这些代回 $R_0(F)$ 的表达式中：\n$$\nR_0(F) = - \\left( k_1(F-1) + 2k_2(F-1) \\right)\n$$\n提取公因式 $(F-1)$，我们得到残余力的最终闭式表达式：\n$$\nR_0(F) = -(k_1 + 2k_2)(F-1)\n$$\n补丁测试要求对于任意均匀变形，该残余力恒为零，即对于所有 $F$，$R_0(F) \\equiv 0$。\n鉴于 $k_1 > 0$ 和 $k_2 \\ge 0$，前置因子 $(k_1 + 2k_2)$ 是严格为正的。因此，只有当 $F-1=0$ 时，$R_0(F) = 0$，这意味着 $F=1$（未变形状态）。对于任何其他变形（$F \\ne 1$），残余力非零。这个不为零的力就是伪力。因此，所描述的耦合方案未能通过补丁测试，是不一致的。\n\n问题要求的是 $R_0(F)$ 的闭式表达式，我们已经推导出来了。",
            "answer": "$$\\boxed{-(k_1 + 2k_2)(F-1)}$$"
        },
        {
            "introduction": "在识别并测试了鬼力之后，关键的下一步是消除它。本练习将介绍一种名为“几何一致性重构”（Geometrically Consistent Reconstruction, GCR）的有效技术，它通过修正界面处的能量计算来恢复物理一致性。您将通过计算证明，这个修正后的方案能够成功通过补丁测试，从而掌握构建无鬼力的多尺度模型的关键思想 。",
            "id": "3765601",
            "problem": "考虑一个一维晶体链，其原子由 $i \\in \\mathbb{Z}$ 索引，参考晶格间距为 $a>0$，形变映射为 $y_i \\in \\mathbb{R}$。原子相互作用能包括通过光滑对势 $\\phi \\in C^{1}((0,\\infty))$ 实现的最近邻和次近邻对相互作用。在纯原子模型中，总能量可以写成基于键的、对所有键求和的形式，\n$$\nE_{\\mathrm{atom}}(y) \\;=\\; \\sum_{i \\in \\mathbb{Z}} \\phi\\!\\left(|y_{i+1}-y_i|\\right) \\;+\\; \\sum_{i \\in \\mathbb{Z}} \\phi\\!\\left(|y_{i+2}-y_i|\\right).\n$$\n在原子-连续介质耦合中，一个界面将原子子区域与连续介质子区域分开。将界面置于位置 $i=0$ 和 $i=1$ 之间，原子区域在左侧 ($i \\leq 0$)，连续介质区域在右侧 ($i \\geq 1$)。为消除伪力，对跨越界面的次近邻键采用几何一致性重构 (GCR)：次近邻键的伸长被重构为相邻最近邻伸长之和。具体来说，将包含所有与 $y_0$ 相关的键贡献的修正界面能定义为\n$$\nE_{\\mathrm{int}}(y) \\;=\\; \\phi\\!\\left(|y_{0}-y_{-1}|\\right) \\;+\\; \\phi\\!\\left(|y_{1}-y_{0}|\\right) \\;+\\; \\phi\\!\\left(|y_{0}-y_{-2}|\\right) \\;+\\; \\phi\\!\\left(\\left|(y_{1}-y_{0})+(y_{0}-y_{-1})\\right|\\right) \\;+\\; \\phi\\!\\left(\\left|(y_{2}-y_{1})+(y_{1}-y_{0})\\right|\\right).\n$$\n这对应于与 $i=0$ 相关联的两个最近邻键、左侧的次近邻键 $(i=-2,i=0)$，以及跨越界面两侧的两个重构次近邻键，即 $(i=-1,i=1)$ 和 $(i=0,i=2)$，它们被写为最近邻差值之和。连续介质区域中剩余的能量使用柯西-玻恩（Cauchy–Born）定则，但在下文考虑的均匀形变下，它不影响 $i=0$ 处的界面残差。\n\n考虑一个均匀形变（斑块检验）$y_i = F \\, a \\, i$，其中形变梯度 $F>0$ 为常数。从平衡构型是总能量的驻点这一原理出发，与 $E_{\\mathrm{int}}$ 相关的在位置 $i=0$ 处的离散欧拉-拉格朗日残差为\n$$\nR_0(F) \\;=\\; \\left.\\frac{\\partial E_{\\mathrm{int}}(y)}{\\partial y_0}\\right|_{y_i=F a i}.\n$$\n计算在均匀形变 $y_i = F a i$ 下出现在 $E_{\\mathrm{int}}(y)$ 中的重构键伸长，然后显式计算 $R_0(F)$。将最终答案表示为一个实数。无需单位。",
            "solution": "该问题要求计算在一维原子-连续介质模型中，在均匀形变 $y_i = F a i$ 下，界面位置 $i=0$ 处的欧拉-拉格朗日残差 $R_0(F)$。残差定义为指定的界面能 $E_{\\mathrm{int}}(y)$ 对原子位置 $y_0$ 的偏导数，并在给定形变下求值。\n\n给定的界面能 $E_{\\mathrm{int}}(y)$ 为：\n$$\nE_{\\mathrm{int}}(y) \\;=\\; \\phi\\!\\left(|y_{0}-y_{-1}|\\right) \\;+\\; \\phi\\!\\left(|y_{1}-y_{0}|\\right) \\;+\\; \\phi\\!\\left(|y_{0}-y_{-2}|\\right) \\;+\\; \\phi\\!\\left(\\left|(y_{1}-y_{0})+(y_{0}-y_{-1})\\right|\\right) \\;+\\; \\phi\\!\\left(\\left|(y_{2}-y_{1})+(y_{1}-y_{0})\\right|\\right)\n$$\n其中 $\\phi \\in C^1((0, \\infty))$ 是对相互作用势。在位置 $i=0$ 处的残差为：\n$$\nR_0(F) \\;=\\; \\left.\\frac{\\partial E_{\\mathrm{int}}(y)}{\\partial y_0}\\right|_{y_i=F a i}\n$$\n\n首先，我们计算在均匀形变 $y_i = F a i$ 下的键伸长（即 $\\phi$ 的自变量）。鉴于 $F>0$ 和 $a>0$，所有伸长都将是正的。\n最近邻键的伸长为：\n\\begin{itemize}\n    \\item $d_{\\text{nn},1} = |y_0 - y_{-1}| = |F a (0) - F a (-1)| = |F a| = F a$。\n    \\item $d_{\\text{nn},2} = |y_1 - y_0| = |F a (1) - F a (0)| = |F a| = F a$。\n\\end{itemize}\n次近邻键的伸长为：\n\\begin{itemize}\n    \\item 未重构的键伸长：$d_{\\text{nnn},1} = |y_0 - y_{-2}| = |F a (0) - F a (-2)| = |2 F a| = 2 F a$。\n    \\item 第一个重构的键伸长，对应于键 $(i=-1, i=1)$：\n    $$\n    d_{\\text{nnn},2}^{\\text{recon}} = \\left|(y_{1}-y_{0})+(y_{0}-y_{-1})\\right| = |(F a (1) - F a (0)) + (F a (0) - F a (-1))| = |F a + F a| = 2 F a.\n    $$\n    注意，这与真实伸长 $|y_1 - y_{-1}| = |Fa(1) - Fa(-1)| = |2Fa| = 2Fa$ 相匹配。\n    \\item 第二个重构的键伸长，对应于键 $(i=0, i=2)$：\n    $$\n    d_{\\text{nnn},3}^{\\text{recon}} = \\left|(y_{2}-y_{1})+(y_{1}-y_{0})\\right| = |(F a (2) - F a (1)) + (F a (1) - F a (0))| = |Fa + Fa| = 2 F a.\n    $$\n    这与真实伸长 $|y_2 - y_0| = |Fa(2) - Fa(0)| = |2Fa| = 2Fa$ 也相匹配。\n\\end{itemize}\n因此，两个重构的键伸长均为 $2Fa$。\n\n接下来，我们通过对 $E_{\\mathrm{int}}(y)$ 关于 $y_0$ 求导来计算残差 $R_0(F)$。设 $\\phi'(r)$ 表示 $\\phi$ 关于其自变量 $r$ 的导数。对于形如 $\\phi(|u(y)|)$ 的项，使用链式法则，我们得到 $\\frac{\\partial}{\\partial y_0}\\phi(|u|) = \\phi'(|u|) \\cdot \\text{sgn}(u) \\cdot \\frac{\\partial u}{\\partial y_0}$。\n在指定的形变下，对于 $j>k$，所有键矢量 $y_j - y_k$ 均为正，因此符号函数 $\\text{sgn}(u)$ 对所有项的求值结果均为 $1$。\n\n让我们计算 $E_{\\mathrm{int}}(y)$ 中五个项中每一项的导数：\n\n1.  第1项：$\\phi(|y_0 - y_{-1}|)$。令 $u_1(y) = y_0 - y_{-1}$。\n    $\\frac{\\partial u_1}{\\partial y_0} = 1$。在形变下，$u_1 = F a > 0$。\n    此项对残差的贡献为 $\\phi'(|Fa|) \\cdot \\text{sgn}(Fa) \\cdot 1 = \\phi'(Fa)$。\n\n2.  第2项：$\\phi(|y_1 - y_0|)$。令 $u_2(y) = y_1 - y_0$。\n    $\\frac{\\partial u_2}{\\partial y_0} = -1$。在形变下，$u_2 = F a > 0$。\n    其贡献为 $\\phi'(|Fa|) \\cdot \\text{sgn}(Fa) \\cdot (-1) = -\\phi'(Fa)$。\n\n3.  第3项：$\\phi(|y_0 - y_{-2}|)$。令 $u_3(y) = y_0 - y_{-2}$。\n    $\\frac{\\partial u_3}{\\partial y_0} = 1$。在形变下，$u_3 = 2Fa > 0$。\n    其贡献为 $\\phi'(|2Fa|) \\cdot \\text{sgn}(2Fa) \\cdot 1 = \\phi'(2Fa)$。\n\n4.  第4项：$\\phi(|(y_1 - y_0) + (y_0 - y_{-1})|)$。\n    此项可简化为 $\\phi(|y_1 - y_{-1}|)$。由于其自变量不依赖于 $y_0$，它关于 $y_0$ 的偏导数为零。我们先不简化来验证这一点。令 $u_4(y) = (y_1 - y_0) + (y_0 - y_{-1}) = y_1 - y_{-1}$。\n    $\\frac{\\partial u_4}{\\partial y_0} = -1 + 1 = 0$。\n    因此，其贡献为 $\\phi'(|u_4|) \\cdot \\text{sgn}(u_4) \\cdot 0 = 0$。\n\n5.  第5项：$\\phi(|(y_2 - y_1) + (y_1 - y_0)|)$。令 $u_5(y) = (y_2 - y_1) + (y_1 - y_0) = y_2 - y_0$。\n    $\\frac{\\partial u_5}{\\partial y_0} = -1$。在形变下，$u_5 = 2Fa > 0$。\n    其贡献为 $\\phi'(|2Fa|) \\cdot \\text{sgn}(2Fa) \\cdot (-1) = -\\phi'(2Fa)$。\n\n最后，我们将所有五个贡献相加，得到总残差 $R_0(F)$：\n$$\nR_0(F) = \\phi'(Fa) - \\phi'(Fa) + \\phi'(2Fa) + 0 - \\phi'(2Fa)\n$$\n各项两两相消：\n$$\nR_0(F) = (\\phi'(Fa) - \\phi'(Fa)) + (\\phi'(2Fa) - \\phi'(2Fa)) = 0 + 0 = 0\n$$\n在均匀形变下，界面原子 $i=0$ 上的残余力为零。这个结果被称为“通过斑块检验”，是原子-连续介质耦合方法的一个基本一致性要求。问题中描述的特定几何一致性重构 (GCR) 方案满足此检验。结果与形变梯度 $F$、晶格间距 $a$ 以及势 $\\phi$ 的具体形式无关。",
            "answer": "$$\\boxed{0}$$"
        }
    ]
}