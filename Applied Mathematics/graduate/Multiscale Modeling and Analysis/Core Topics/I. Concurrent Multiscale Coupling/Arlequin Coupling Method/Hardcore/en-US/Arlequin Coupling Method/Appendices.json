{
    "hands_on_practices": [
        {
            "introduction": "A crucial step in applying any physical model is understanding the interplay between its parameters. For the Arlequin method, a key practical question is how to select the penalty parameter $\\gamma$ in a way that is physically meaningful. This exercise guides you through the process of nondimensionalization, a fundamental technique in engineering and physics, to reveal the essential dimensionless groups that govern the behavior of the coupled elastic system . By completing this analysis, you will derive a critical parameter that connects the abstract penalty term to concrete material properties and geometric scales, providing a robust foundation for designing and interpreting simulations.",
            "id": "3733235",
            "problem": "Consider two small-strain linear elastic models defined on overlapping subdomains $\\Omega_{1}$ and $\\Omega_{2}$ in three-dimensional space, with an overlap region $\\Omega_{o}=\\Omega_{1}\\cap\\Omega_{2}$. Let $\\Gamma_{c}\\subset\\Omega_{o}$ be a smooth coupling interface of characteristic size comparable to the overlap, with characteristic length scale $L>0$. The models are coupled using the Arlequin method, in which the total energy functional is taken as a weighted superposition of the elastic energies together with a penalty enforcing kinematic compatibility on $\\Gamma_{c}$. Specifically, let the total energy functional be\n$$\n\\Pi(\\boldsymbol{u}_{1},\\boldsymbol{u}_{2}) \\;=\\; \\int_{\\Omega_{1}} \\alpha_{1}(\\boldsymbol{x})\\, W\\!\\left(\\boldsymbol{\\varepsilon}(\\boldsymbol{u}_{1}(\\boldsymbol{x}))\\right)\\,\\mathrm{d}\\boldsymbol{x} \\;+\\; \\int_{\\Omega_{2}} \\alpha_{2}(\\boldsymbol{x})\\, W\\!\\left(\\boldsymbol{\\varepsilon}(\\boldsymbol{u}_{2}(\\boldsymbol{x}))\\right)\\,\\mathrm{d}\\boldsymbol{x} \\;+\\; \\frac{\\gamma}{2}\\int_{\\Gamma_{c}} w_{c}(\\boldsymbol{x})\\, \\left\\|\\boldsymbol{u}_{1}(\\boldsymbol{x})-\\boldsymbol{u}_{2}(\\boldsymbol{x})\\right\\|^{2}\\,\\mathrm{d}s,\n$$\nwhere $\\boldsymbol{u}_{i}:\\Omega_{i}\\to\\mathbb{R}^{3}$ are displacement fields, $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}_{i})=\\frac{1}{2}\\left(\\nabla\\boldsymbol{u}_{i}+\\nabla\\boldsymbol{u}_{i}^{\\top}\\right)$ is the small-strain tensor, $W(\\boldsymbol{\\varepsilon})=\\frac{1}{2}\\lambda\\left(\\mathrm{tr}\\,\\boldsymbol{\\varepsilon}\\right)^{2}+\\mu\\,\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon}$ is the elastic energy density, and $(\\lambda,\\mu)$ are Lamé parameters satisfying standard relations with a representative Young’s modulus $E>0$ and Poisson’s ratio $\\nu\\in(-1,1/2)$. The weighting functions $\\alpha_{1},\\alpha_{2}$ and $w_{c}$ are dimensionless and bounded, and $\\gamma>0$ is a penalty parameter controlling the coupling strength on $\\Gamma_{c}$.\n\nUsing a characteristic displacement scale $U_{0}>0$ and the length scale $L$, perform a nondimensionalization of $\\Pi(\\boldsymbol{u}_{1},\\boldsymbol{u}_{2})$ by introducing dimensionless variables $\\tilde{\\boldsymbol{x}}=\\boldsymbol{x}/L$ and $\\tilde{\\boldsymbol{u}}_{i}=\\boldsymbol{u}_{i}/U_{0}$. Express the resulting nondimensional functional in the form\n$$\n\\Pi(\\boldsymbol{u}_{1},\\boldsymbol{u}_{2}) \\;=\\; E\\,U_{0}^{2}\\,L \\;\\tilde{\\Pi}(\\tilde{\\boldsymbol{u}}_{1},\\tilde{\\boldsymbol{u}}_{2}),\n$$\nand identify the single dimensionless parameter that multiplies the coupling penalty term in $\\tilde{\\Pi}$. Your final answer must be a closed-form analytic expression for this dimensionless coupling number in terms of $\\gamma$, $L$, and $E$. Do not use any numerical values. If you introduce any additional intermediate scales, you must eliminate them so that the final expression depends only on $\\gamma$, $L$, and $E$.",
            "solution": "The problem requires the nondimensionalization of the given energy functional $\\Pi(\\boldsymbol{u}_{1},\\boldsymbol{u}_{2})$ to identify a dimensionless coupling parameter. The functional is given by:\n$$\n\\Pi(\\boldsymbol{u}_{1},\\boldsymbol{u}_{2}) \\;=\\; \\int_{\\Omega_{1}} \\alpha_{1}(\\boldsymbol{x})\\, W\\!\\left(\\boldsymbol{\\varepsilon}(\\boldsymbol{u}_{1}(\\boldsymbol{x}))\\right)\\,\\mathrm{d}\\boldsymbol{x} \\;+\\; \\int_{\\Omega_{2}} \\alpha_{2}(\\boldsymbol{x})\\, W\\!\\left(\\boldsymbolvarepsilon}(\\boldsymbol{u}_{2}(\\boldsymbol{x}))\\right)\\,\\mathrm{d}\\boldsymbol{x} \\;+\\; \\frac{\\gamma}{2}\\int_{\\Gamma_{c}} w_{c}(\\boldsymbol{x})\\, \\left\\|\\boldsymbol{u}_{1}(\\boldsymbol{x})-\\boldsymbol{u}_{2}(\\boldsymbol{x})\\right\\|^{2}\\,\\mathrm{d}s\n$$\nThe nondimensionalization is performed using the characteristic length scale $L>0$ and displacement scale $U_{0}>0$. The dimensionless variables are defined as:\n$$\n\\tilde{\\boldsymbol{x}} = \\frac{\\boldsymbol{x}}{L} \\quad \\implies \\quad \\boldsymbol{x} = L\\tilde{\\boldsymbol{x}}\n$$\n$$\n\\tilde{\\boldsymbol{u}}_{i} = \\frac{\\boldsymbol{u}_{i}}{U_{0}} \\quad \\implies \\quad \\boldsymbol{u}_{i} = U_{0}\\tilde{\\boldsymbol{u}}_{i}\n$$\nfor $i=1,2$. We will transform each component of the functional $\\Pi$ in terms of these dimensionless variables.\n\nFirst, we transform the gradient operator $\\nabla$ (with respect to $\\boldsymbol{x}$) to the dimensionless gradient operator $\\tilde{\\nabla}$ (with respect to $\\tilde{\\boldsymbol{x}}$). The chain rule gives:\n$$\n\\nabla = \\frac{\\partial}{\\partial \\boldsymbol{x}} = \\frac{\\partial \\tilde{\\boldsymbol{x}}}{\\partial \\boldsymbol{x}} \\frac{\\partial}{\\partial \\tilde{\\boldsymbol{x}}} = \\frac{1}{L} \\tilde{\\nabla}\n$$\n\nNext, we transform the small-strain tensor $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}_{i})$:\n$$\n\\boldsymbol{\\varepsilon}(\\boldsymbol{u}_{i}) = \\frac{1}{2}\\left(\\nabla\\boldsymbol{u}_{i}+\\nabla\\boldsymbol{u}_{i}^{\\top}\\right) = \\frac{1}{2}\\left(\\nabla(U_{0}\\tilde{\\boldsymbol{u}}_{i})+(\\nabla(U_{0}\\tilde{\\boldsymbol{u}}_{i}))^{\\top}\\right)\n$$\n$$\n\\boldsymbol{\\varepsilon}(\\boldsymbol{u}_{i}) = \\frac{U_{0}}{2}\\left(\\nabla\\tilde{\\boldsymbol{u}}_{i}+(\\nabla\\tilde{\\boldsymbol{u}}_{i})^{\\top}\\right) = \\frac{U_{0}}{2}\\left(\\frac{1}{L}\\tilde{\\nabla}\\tilde{\\boldsymbol{u}}_{i}+\\left(\\frac{1}{L}\\tilde{\\nabla}\\tilde{\\boldsymbol{u}}_{i}\\right)^{\\top}\\right) = \\frac{U_{0}}{L} \\left[ \\frac{1}{2}\\left(\\tilde{\\nabla}\\tilde{\\boldsymbol{u}}_{i}+\\tilde{\\nabla}\\tilde{\\boldsymbol{u}}_{i}^{\\top}\\right) \\right]\n$$\nLet $\\tilde{\\boldsymbol{\\varepsilon}}(\\tilde{\\boldsymbol{u}}_{i}) = \\frac{1}{2}\\left(\\tilde{\\nabla}\\tilde{\\boldsymbol{u}}_{i}+\\tilde{\\nabla}\\tilde{\\boldsymbol{u}}_{i}^{\\top}\\right)$ be the dimensionless strain tensor. Then, the relationship is:\n$$\n\\boldsymbol{\\varepsilon}(\\boldsymbol{u}_{i}) = \\frac{U_{0}}{L} \\tilde{\\boldsymbol{\\varepsilon}}(\\tilde{\\boldsymbol{u}}_{i})\n$$\n\nNow, we transform the elastic energy density $W(\\boldsymbol{\\varepsilon}) = \\frac{1}{2}\\lambda\\left(\\mathrm{tr}\\,\\boldsymbol{\\varepsilon}\\right)^{2}+\\mu\\,\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon}$.\n$$\nW(\\boldsymbol{\\varepsilon}(\\boldsymbol{u}_{i})) = \\frac{1}{2}\\lambda\\left(\\mathrm{tr}\\left(\\frac{U_{0}}{L}\\tilde{\\boldsymbol{\\varepsilon}}(\\tilde{\\boldsymbol{u}}_{i})\\right)\\right)^{2} + \\mu\\left(\\frac{U_{0}}{L}\\tilde{\\boldsymbol{\\varepsilon}}(\\tilde{\\boldsymbol{u}}_{i})\\right):\\left(\\frac{U_{0}}{L}\\tilde{\\boldsymbol{\\varepsilon}}(\\tilde{\\boldsymbol{u}}_{i})\\right)\n$$\n$$\nW(\\boldsymbol{\\varepsilon}(\\boldsymbol{u}_{i})) = \\left(\\frac{U_{0}}{L}\\right)^{2} \\left( \\frac{1}{2}\\lambda\\left(\\mathrm{tr}\\,\\tilde{\\boldsymbol{\\varepsilon}}(\\tilde{\\boldsymbol{u}}_{i})\\right)^{2}+\\mu\\,\\tilde{\\boldsymbol{\\varepsilon}}(\\tilde{\\boldsymbol{u}}_{i}):\\tilde{\\boldsymbol{\\varepsilon}}(\\tilde{\\boldsymbol{u}}_{i}) \\right)\n$$\nThe Lamé parameters $\\lambda$ and $\\mu$ are related to the Young's modulus $E$ and Poisson's ratio $\\nu$. Specifically, $\\lambda$ and $\\mu$ are both linearly proportional to $E$, i.e., $\\lambda=E f_{\\lambda}(\\nu)$ and $\\mu=E f_{\\mu}(\\nu)$ for some dimensionless functions $f_{\\lambda}, f_{\\mu}$ of $\\nu$. Thus, we can factor out $E$:\n$$\nW(\\boldsymbol{\\varepsilon}(\\boldsymbol{u}_{i})) = E \\left(\\frac{U_{0}}{L}\\right)^{2} \\left[ \\frac{1}{2}f_{\\lambda}(\\nu)\\left(\\mathrm{tr}\\,\\tilde{\\boldsymbol{\\varepsilon}}(\\tilde{\\boldsymbol{u}}_{i})\\right)^{2}+f_{\\mu}(\\nu)\\,\\tilde{\\boldsymbol{\\varepsilon}}(\\tilde{\\boldsymbol{u}}_{i}):\\tilde{\\boldsymbol{\\varepsilon}}(\\tilde{\\boldsymbol{u}}_{i}) \\right] = E \\left(\\frac{U_{0}}{L}\\right)^{2} \\tilde{W}(\\tilde{\\boldsymbol{\\varepsilon}}(\\tilde{\\boldsymbol{u}}_{i}))\n$$\nwhere $\\tilde{W}(\\tilde{\\boldsymbol{\\varepsilon}})$ is the dimensionless energy density function, dependent on $\\nu$.\n\nWe now transform the integral terms. For the volume integrals over $\\Omega_{1}$ and $\\Omega_{2}$ (which are $3$-dimensional domains), the volume element scales as $\\mathrm{d}\\boldsymbol{x} = L^{3}\\,\\mathrm{d}\\tilde{\\boldsymbol{x}}$. The domains transform to $\\tilde{\\Omega}_{1}$ and $\\tilde{\\Omega}_{2}$. Let us examine the first term:\n$$\n\\int_{\\Omega_{1}} \\alpha_{1}(\\boldsymbol{x})\\, W\\!\\left(\\boldsymbol{\\varepsilon}(\\boldsymbol{u}_{1}(\\boldsymbol{x}))\\right)\\,\\mathrm{d}\\boldsymbol{x} = \\int_{\\tilde{\\Omega}_{1}} \\alpha_{1}(L\\tilde{\\boldsymbol{x}}) \\left[ E \\left(\\frac{U_{0}}{L}\\right)^{2} \\tilde{W}(\\tilde{\\boldsymbol{\\varepsilon}}(\\tilde{\\boldsymbol{u}}_{1})) \\right] (L^{3}\\,\\mathrm{d}\\tilde{\\boldsymbol{x}})\n$$\n$$\n= E U_{0}^{2} L \\int_{\\tilde{\\Omega}_{1}} \\tilde{\\alpha}_{1}(\\tilde{\\boldsymbol{x}}) \\tilde{W}(\\tilde{\\boldsymbol{\\varepsilon}}(\\tilde{\\boldsymbol{u}}_{1})) \\,\\mathrm{d}\\tilde{\\boldsymbol{x}}\n$$\nwhere $\\tilde{\\alpha}_{1}(\\tilde{\\boldsymbol{x}}) = \\alpha_{1}(L\\tilde{\\boldsymbol{x}})$. Since $\\alpha_{1}$ is dimensionless, $\\tilde{\\alpha}_{1}$ is also dimensionless. An identical result holds for the integral over $\\Omega_{2}$.\n\nFinally, we transform the coupling penalty term, which is an integral over the $2$-dimensional surface $\\Gamma_{c}$. The surface element scales as $\\mathrm{d}s = L^{2}\\,\\mathrm{d}\\tilde{s}$. The surface transforms to $\\tilde{\\Gamma}_{c}$.\n$$\n\\frac{\\gamma}{2}\\int_{\\Gamma_{c}} w_{c}(\\boldsymbol{x})\\, \\left\\|\\boldsymbol{u}_{1}(\\boldsymbol{x})-\\boldsymbol{u}_{2}(\\boldsymbol{x})\\right\\|^{2}\\,\\mathrm{d}s = \\frac{\\gamma}{2}\\int_{\\tilde{\\Gamma}_{c}} w_{c}(L\\tilde{\\boldsymbol{x}})\\, \\left\\|U_{0}\\tilde{\\boldsymbol{u}}_{1}(\\tilde{\\boldsymbol{x}})-U_{0}\\tilde{\\boldsymbol{u}}_{2}(\\tilde{\\boldsymbol{x}})\\right\\|^{2}\\,(L^{2}\\,\\mathrm{d}\\tilde{s})\n$$\n$$\n= \\frac{\\gamma U_{0}^{2} L^{2}}{2}\\int_{\\tilde{\\Gamma}_{c}} \\tilde{w}_{c}(\\tilde{\\boldsymbol{x}})\\, \\left\\|\\tilde{\\boldsymbol{u}}_{1}(\\tilde{\\boldsymbol{x}})-\\tilde{\\boldsymbol{u}}_{2}(\\tilde{\\boldsymbol{x}})\\right\\|^{2}\\,\\mathrm{d}\\tilde{s}\n$$\nwhere $\\tilde{w}_{c}(\\tilde{\\boldsymbol{x}}) = w_{c}(L\\tilde{\\boldsymbol{x}})$, which is dimensionless.\n\nCombining all transformed parts, the total energy functional $\\Pi$ becomes:\n$$\n\\Pi = E U_{0}^{2} L \\left[ \\int_{\\tilde{\\Omega}_{1}} \\tilde{\\alpha}_{1} \\tilde{W}(\\tilde{\\boldsymbol{\\varepsilon}}_{1}) \\,\\mathrm{d}\\tilde{\\boldsymbol{x}} + \\int_{\\tilde{\\Omega}_{2}} \\tilde{\\alpha}_{2} \\tilde{W}(\\tilde{\\boldsymbol{\\varepsilon}}_{2}) \\,\\mathrm{d}\\tilde{\\boldsymbol{x}} \\right] + \\frac{\\gamma U_{0}^{2} L^{2}}{2}\\int_{\\tilde{\\Gamma}_{c}} \\tilde{w}_{c} \\left\\|\\tilde{\\boldsymbol{u}}_{1}-\\tilde{\\boldsymbol{u}}_{2}\\right\\|^{2}\\,\\mathrm{d}\\tilde{s}\n$$\nThe problem requires expressing this in the form $\\Pi = E U_{0}^{2} L \\, \\tilde{\\Pi}$. To achieve this, we must factor $E U_{0}^{2} L$ from the entire expression, including the coupling term.\n$$\n\\frac{\\gamma U_{0}^{2} L^{2}}{2} = (E U_{0}^{2} L) \\left( \\frac{\\gamma L}{2E} \\right)\n$$\nSubstituting this back into the expression for $\\Pi$:\n$$\n\\Pi = E U_{0}^{2} L \\left[ \\int_{\\tilde{\\Omega}_{1}} \\tilde{\\alpha}_{1} \\tilde{W}(\\tilde{\\boldsymbol{\\varepsilon}}_{1}) \\,\\mathrm{d}\\tilde{\\boldsymbol{x}} + \\int_{\\tilde{\\Omega}_{2}} \\tilde{\\alpha}_{2} \\tilde{W}(\\tilde{\\boldsymbol{\\varepsilon}}_{2}) \\,\\mathrm{d}\\tilde{\\boldsymbol{x}} + \\frac{\\gamma L}{2E} \\int_{\\tilde{\\Gamma}_{c}} \\tilde{w}_{c} \\left\\|\\tilde{\\boldsymbol{u}}_{1}-\\tilde{\\boldsymbol{u}}_{2}\\right\\|^{2}\\,\\mathrm{d}\\tilde{s} \\right]\n$$\nThis gives the dimensionless functional $\\tilde{\\Pi}(\\tilde{\\boldsymbol{u}}_{1},\\tilde{\\boldsymbol{u}}_{2})$:\n$$\n\\tilde{\\Pi}(\\tilde{\\boldsymbol{u}}_{1},\\tilde{\\boldsymbol{u}}_{2}) = \\int_{\\tilde{\\Omega}_{1}} \\tilde{\\alpha}_{1} \\tilde{W}(\\tilde{\\boldsymbol{\\varepsilon}}_{1}) \\,\\mathrm{d}\\tilde{\\boldsymbol{x}} + \\int_{\\tilde{\\Omega}_{2}} \\tilde{\\alpha}_{2} \\tilde{W}(\\tilde{\\boldsymbol{\\varepsilon}}_{2}) \\,\\mathrm{d}\\tilde{\\boldsymbol{x}} + \\frac{\\gamma L}{2E} \\int_{\\tilde{\\Gamma}_{c}} \\tilde{w}_{c} \\left\\|\\tilde{\\boldsymbol{u}}_{1}-\\tilde{\\boldsymbol{u}}_{2}\\right\\|^{2}\\,\\mathrm{d}\\tilde{s}\n$$\nThe coupling penalty term in the original functional has the form $\\frac{\\gamma}{2} \\times (\\text{integral})$. The corresponding term in the dimensionless functional $\\tilde{\\Pi}$ is $\\frac{1}{2} \\left(\\frac{\\gamma L}{E}\\right) \\times (\\text{integral})$. Therefore, the original penalty parameter $\\gamma$ has been replaced by the dimensionless group $\\frac{\\gamma L}{E}$.\n\nTo confirm this result, we perform a dimensional analysis on the identified parameter. The units of the physical quantities are denoted by $[\\cdot]$. The energy functional term has units of energy, $[ \\text{Force} \\times \\text{Length} ]$.\nFrom the penalty term, $[\\gamma] \\times [\\text{dimensionless}] \\times [\\text{Length}]^{2} \\times [\\text{Length}]^{2} = [\\text{Force}] \\times [\\text{Length}]$.\n$$\n[\\gamma] L^{4} = F L \\implies [\\gamma] = \\frac{F}{L^{3}}\n$$\nThe Young's modulus $E$ has units of stress, which is force per area: $[E] = \\frac{F}{L^{2}}$.\nThe characteristic length $L$ has units of length, $[L]$.\nThe dimensionless number is thus:\n$$\n\\left[\\frac{\\gamma L}{E}\\right] = \\frac{[\\gamma][L]}{[E]} = \\frac{(F/L^{3})(L)}{(F/L^{2})} = \\frac{F/L^{2}}{F/L^{2}} = 1\n$$\nThe parameter is indeed dimensionless. This is the single dimensionless parameter that multiplies the coupling penalty term in $\\tilde{\\Pi}$ in a manner analogous to $\\gamma$ in $\\Pi$.\nThe final expression depends only on $\\gamma$, $L$, and $E$, as required.",
            "answer": "$$\n\\boxed{\\frac{\\gamma L}{E}}\n$$"
        },
        {
            "introduction": "An effective coupling method should be as non-invasive as possible, connecting different models without introducing spurious physical effects. In wave propagation problems, this means the coupling region should be transparent to passing waves, minimizing artificial reflections. This practice explores this very concept by asking you to analyze how the choice of blending function $\\alpha(x)$ affects the transparency of the Arlequin overlap region . Using the powerful Wentzel-Kramers-Brillouin (WKB) approximation, you will quantify and compare the reflections generated by two common blending profiles, offering direct insight into how thoughtful design of the coupling can enhance the accuracy of a multiscale simulation.",
            "id": "3733191",
            "problem": "Consider one-dimensional scalar wave propagation governed by the Partial Differential Equation (PDE) $u_{tt}(x,t) = c(x)^{2} u_{xx}(x,t)$, where $u(x,t)$ is the displacement, $c(x)$ is the local wave speed, and subscripts denote partial derivatives. Two physics models are coupled via the Arlequin coupling method over an overlap region $x \\in [0,L]$: a left model with constant wave speed $c_{1}$ for $x < 0$, and a right model with constant wave speed $c_{2}$ for $x > L$. In the overlap, the Arlequin blending weights are $\\alpha(x)$ for the left model and $1 - \\alpha(x)$ for the right. Assume kinematic compatibility in the overlap is enforced strongly, and consider a time-harmonic ansatz $u(x,t) = \\Re\\{\\hat{u}(x) \\exp(- i \\omega t)\\}$ of angular frequency $\\omega$, which leads to the frequency-domain equation $\\hat{u}''(x) + k(x)^{2} \\hat{u}(x) = 0$, where $k(x) = \\omega / c(x)$ is the local wavenumber. Model the effective operator in the overlap by the convex blending $k(x)^{2} = \\alpha(x) k_{1}^{2} + \\left(1 - \\alpha(x)\\right) k_{2}^{2}$, with $k_{j} = \\omega / c_{j}$ for $j \\in \\{1,2\\}$.\n\nA right-going plane wave of unit amplitude with wavenumber $k_{1}$ is incident from $x \\ll 0$. Suppose the mismatch $\\Delta = k_{2}^{2} - k_{1}^{2}$ satisfies $|\\Delta| \\ll k_{1}^{2}$. Using the leading-order Wentzel-Kramers-Brillouin (WKB) approximation in the small-mismatch regime and neglecting higher-order terms, derive the amplitude reflection coefficient $R$ generated by the graded overlap and express it in terms of the spatial gradient of $k(x)$ and a rapidly oscillatory phase. Then, under the approximation that the local phase in the overlap is dominated by the left wavenumber $k_{1}$, reduce $R$ to a form depending only on $\\alpha'(x)$.\n\nFinally, for the two ramp designs\n- linear ramp: $\\alpha_{\\mathrm{lin}}(x) = 1 - x/L$ for $x \\in [0,L]$,\n- cosine ramp: $\\alpha_{\\mathrm{cos}}(x) = \\frac{1}{2}\\left(1 + \\cos\\left(\\pi x / L\\right)\\right)$ for $x \\in [0,L]$,\ncompute the leading-order reflectance $|R|^{2}$ in each case and provide, as your final answer, the closed-form analytical expression for the ratio $|R_{\\mathrm{cos}}|^{2} / |R_{\\mathrm{lin}}|^{2}$ in terms of $k_{1}$ and $L$. Express your final answer as a single analytic expression. No numerical rounding is required.",
            "solution": "The problem requires finding the ratio of reflectances $|R_{\\mathrm{cos}}|^{2} / |R_{\\mathrm{lin}}|^{2}$ for two different blending function profiles, $\\alpha_{\\mathrm{lin}}(x)$ and $\\alpha_{\\mathrm{cos}}(x)$.\n\nFirst, we establish the formula for the reflection coefficient $R$ using the leading-order WKB approximation for a weakly varying medium. The governing equation is $\\hat{u}''(x) + k(x)^{2} \\hat{u}(x) = 0$. The reflection coefficient generated by the graded region $[0, L]$ is given by:\n$$\nR \\approx \\int_{0}^{L} \\frac{k'(x)}{2k(x)} \\exp\\left(2i \\int_0^x k(s) ds\\right) dx\n$$\nWe are given the small-mismatch approximation, where $\\Delta = k_{2}^{2} - k_{1}^{2}$ is small. The effective wavenumber squared is $k(x)^{2} = k_{1}^{2} + (1-\\alpha(x))\\Delta$.\nDifferentiating this expression gives $2k(x)k'(x) = -\\alpha'(x)\\Delta$.\nThe amplitude term in the integrand is thus $\\frac{k'(x)}{2k(x)} = \\frac{-\\alpha'(x)\\Delta}{4k(x)^2}$. Given the small mismatch, we can approximate $k(x)^2 \\approx k_1^2$.\nThe phase term in the integrand is approximated as requested: $\\int_0^x k(s)ds \\approx \\int_0^x k_1 ds = k_1 x$.\nSubstituting these approximations into the integral for $R$ yields a form dependent on $\\alpha'(x)$:\n$$\nR \\approx -\\frac{\\Delta}{4k_1^2} \\int_0^L \\alpha'(x) e^{2ik_1 x} dx\n$$\nThis is our master formula for computing the reflection coefficient for any given blending function profile $\\alpha(x)$ that satisfies $\\alpha(0)=1$ and $\\alpha(L)=0$.\n\n**Case 1: Linear Ramp**\nFor $\\alpha_{\\mathrm{lin}}(x) = 1 - x/L$, the derivative is $\\alpha'_{\\mathrm{lin}}(x) = -1/L$.\n$$\nR_{\\mathrm{lin}} = -\\frac{\\Delta}{4k_1^2} \\int_0^L \\left(-\\frac{1}{L}\\right) e^{2ik_1 x} dx = \\frac{\\Delta}{4k_1^2 L} \\left[ \\frac{e^{2ik_1 x}}{2ik_1} \\right]_0^L = \\frac{\\Delta}{8ik_1^3 L} (e^{2ik_1 L}-1)\n$$\nThe reflectance is $|R_{\\mathrm{lin}}|^2$. Using $|e^{i\\theta}-1|^2 = 4\\sin^2(\\theta/2)$:\n$$\n|R_{\\mathrm{lin}}|^2 = \\left| \\frac{\\Delta}{8ik_1^3 L} \\right|^2 |e^{2ik_1 L}-1|^2 = \\frac{\\Delta^2}{64k_1^6 L^2} \\cdot 4\\sin^2(k_1 L) = \\frac{\\Delta^2 \\sin^2(k_1 L)}{16k_1^6 L^2}\n$$\n\n**Case 2: Cosine Ramp**\nFor $\\alpha_{\\mathrm{cos}}(x) = \\frac{1}{2}(1 + \\cos(\\pi x / L))$, the derivative is $\\alpha'_{\\mathrm{cos}}(x) = -\\frac{\\pi}{2L} \\sin(\\pi x / L)$.\n$$\nR_{\\mathrm{cos}} = -\\frac{\\Delta}{4k_1^2} \\int_0^L \\left(-\\frac{\\pi}{2L} \\sin\\left(\\frac{\\pi x}{L}\\right)\\right) e^{2ik_1 x} dx = \\frac{\\pi\\Delta}{8k_1^2 L} \\int_0^L \\sin\\left(\\frac{\\pi x}{L}\\right) e^{2ik_1 x} dx\n$$\nThe integral can be evaluated using integration by parts. The result is:\n$$\n\\int_0^L \\sin\\left(\\frac{\\pi x}{L}\\right) e^{2ik_1 x} dx = \\frac{\\pi L (1+e^{i2k_1 L})}{\\pi^2 - 4k_1^2 L^2}\n$$\nSubstituting this back into the expression for $R_{\\mathrm{cos}}$:\n$$\nR_{\\mathrm{cos}} = \\frac{\\pi\\Delta}{8k_1^2 L} \\cdot \\frac{\\pi L (1+e^{i2k_1 L})}{\\pi^2 - 4k_1^2 L^2} = -\\frac{\\pi^2 \\Delta (1+e^{i2k_1 L})}{8k_1^2 (4k_1^2 L^2 - \\pi^2)}\n$$\nThe reflectance is $|R_{\\mathrm{cos}}|^2$. Using $|1+e^{i\\theta}|^2 = 4\\cos^2(\\theta/2)$:\n$$\n|R_{\\mathrm{cos}}|^2 = \\left| -\\frac{\\pi^2 \\Delta}{8k_1^2 (4k_1^2 L^2 - \\pi^2)} \\right|^2 |1+e^{i2k_1 L}|^2 = \\frac{\\pi^4 \\Delta^2}{64k_1^4(4k_1^2 L^2 - \\pi^2)^2} \\cdot 4\\cos^2(k_1 L) = \\frac{\\pi^4 \\Delta^2 \\cos^2(k_1 L)}{16k_1^4(4k_1^2 L^2 - \\pi^2)^2}\n$$\n\n**Ratio of Reflectances**\nFinally, we compute the ratio $|R_{\\mathrm{cos}}|^2 / |R_{\\mathrm{lin}}|^2$:\n$$\n\\frac{|R_{\\mathrm{cos}}|^2}{|R_{\\mathrm{lin}}|^2} = \\frac{\\frac{\\pi^4 \\Delta^2 \\cos^2(k_1 L)}{16 k_1^4 (4k_1^2 L^2 - \\pi^2)^2}}{\\frac{\\Delta^2 \\sin^2(k_1 L)}{16 k_1^6 L^2}} = \\frac{\\pi^4 \\cos^2(k_1 L)}{k_1^4 (4k_1^2 L^2 - \\pi^2)^2} \\cdot \\frac{k_1^6 L^2}{\\sin^2(k_1 L)}\n$$\nSimplifying the expression gives:\n$$\n\\frac{|R_{\\mathrm{cos}}|^2}{|R_{\\mathrm{lin}}|^2} = \\frac{\\pi^4 k_1^2 L^2 \\cos^2(k_1 L)}{(4k_1^2 L^2 - \\pi^2)^2 \\sin^2(k_1 L)} = \\frac{\\pi^4 k_1^2 L^2 \\cot^2(k_1 L)}{(4k_1^2 L^2 - \\pi^2)^2}\n$$\nThis is the final analytical expression for the ratio.",
            "answer": "$$\n\\boxed{\\frac{\\pi^{4} k_{1}^{2} L^{2} \\cot^{2}(k_{1} L)}{(4 k_{1}^{2} L^{2} - \\pi^{2})^{2}}}\n$$"
        },
        {
            "introduction": "Ultimately, the theoretical elegance of the Arlequin method must be translated into a robust and efficient computational algorithm. When Lagrange multipliers are used to enforce constraints, the finite element discretization yields a distinctive saddle-point linear system. This final practice provides a comprehensive, hands-on dive into the numerical engine required to solve such systems . You will derive the Schur complement system, analyze its mathematical properties, and implement a preconditioned Conjugate Gradient (PCG) solver, bridging the gap between the method's variational formulation and its practical, high-performance implementation.",
            "id": "3733205",
            "problem": "Consider the Arlequin coupling method for overlapping models in linear elasticity, where consistency across the overlap is enforced by Lagrange multipliers. After finite-dimensional discretization, this leads to a symmetric saddle-point linear system for the primal variables and multipliers. Let the assembled stiffness matrix be $K \\in \\mathbb{R}^{n \\times n}$, the constraint matrix be $B \\in \\mathbb{R}^{m \\times n}$, the Lagrange multipliers be $\\lambda \\in \\mathbb{R}^{m}$, and the load vector be $f \\in \\mathbb{R}^{n}$. The discrete saddle-point system is\n$$\n\\begin{bmatrix}\nK & B^{\\top} \\\\\nB & 0\n\\end{bmatrix}\n\\begin{bmatrix}\nu \\\\\n\\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nf \\\\\nc\n\\end{bmatrix},\n$$\nwith $c \\in \\mathbb{R}^{m}$ the constraint target in the overlap, typically $c = 0$ to enforce continuity in the overlap. Assume $K$ is symmetric positive definite and $B$ has full row rank. Eliminating the primal variables reduces the problem to the Schur complement system in the multiplier space:\n$$\nS \\lambda = g, \\quad \\text{where} \\quad S := B K^{-1} B^{\\top} \\in \\mathbb{R}^{m \\times m}, \\quad g := B K^{-1} f \\in \\mathbb{R}^{m}.\n$$\nYou must implement a Krylov subspace solver, specifically the preconditioned Conjugate Gradient method (Conjugate Gradient (CG)), for the multiplier-space system $S \\lambda = g$ with a constraint preconditioner $\\widetilde{S}$, and then compute and report the convergence bounds derived from spectral properties of the preconditioned operator in the multiplier space.\n\nStarting from the fundamental base of linear algebra and the saddle-point elimination, derive the multiplier-space problem, justify that $S$ is symmetric positive definite (Symmetric Positive Definite (SPD)) under the given assumptions, and show that the convergence of preconditioned Conjugate Gradient depends only on the spectrum of $\\widetilde{S}^{-1} S$. You must derive a bound of the form\n$$\n\\|e_k\\|_{S} \\leq \\rho(\\kappa)^{k} C \\|e_0\\|_{S},\n$$\nwhere $e_k := \\lambda_k - \\lambda^{\\star}$ is the error after $k$ iterations, $\\lambda^{\\star}$ is the exact solution of $S \\lambda = g$, $\\kappa$ is a condition number extracted from the eigenvalues of $\\widetilde{S}^{-1} S$, $\\rho(\\kappa)$ is a convergence factor depending on $\\kappa$, and $C$ is a constant that you must justify. Your implementation must:\n- Construct the multiplier-space Schur complement $S$ and right-hand side $g$ from specified $(K, B, f)$.\n- Implement preconditioned Conjugate Gradient for $S \\lambda = g$ using an SPD preconditioner $\\widetilde{S}$.\n- Compute the eigenvalues of $\\widetilde{S}^{-1} S$ and then the associated condition number $\\kappa$ and use it to evaluate the theoretical bound for $\\|e_k\\|_{S}$ at the attained iteration count $k$.\n- Report, for each test case, the final number of iterations $k$, the final error norm $\\|e_k\\|_{S}$, and the theoretical bound value evaluated at $k$.\n\nFor all calculations, use purely mathematical quantities; there are no physical units involved. Angles do not appear. Express all numeric results in standard decimal form, not as percentages.\n\nUse the following test suite with explicit matrices. In each case, define $K := \\operatorname{diag}(K_1, K_2)$, $B$ as below, $f$ as below, and choose $\\widetilde{S}$ as specified.\n\nTest case $1$ (ideal preconditioner, well-conditioned stiffness):\n- $K_1 = \\begin{bmatrix} 4 & 1 \\\\ 1 & 3 \\end{bmatrix}$, $K_2 = \\begin{bmatrix} 5 & 0 \\\\ 0 & 2 \\end{bmatrix}$,\n- $B = \\begin{bmatrix} 1 & 0 & -1 & 0 \\\\ 0 & 1 & 0 & -1 \\end{bmatrix}$,\n- $f = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 1 \\end{bmatrix}$,\n- $\\widetilde{S} = S$.\n\nTest case $2$ (diagonal preconditioner, moderate conditioning):\n- $K_1 = \\begin{bmatrix} 4 & 1 \\\\ 1 & 3 \\end{bmatrix}$, $K_2 = \\begin{bmatrix} 5 & 0 \\\\ 0 & 2 \\end{bmatrix}$,\n- $B = \\begin{bmatrix} 1 & 0 & -1 & 0 \\\\ 0 & 1 & 0 & -1 \\end{bmatrix}$,\n- $f = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 1 \\end{bmatrix}$,\n- $\\widetilde{S} = \\operatorname{diag}(S)$, i.e., the diagonal of $S$ assembled into a diagonal matrix.\n\nTest case $3$ (diagonal preconditioner, strong stiffness contrast):\n- $K_1 = \\begin{bmatrix} 1000 & 0 \\\\ 0 & 0.001 \\end{bmatrix}$, $K_2 = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}$,\n- $B = \\begin{bmatrix} 1 & 0 & -1 & 0 \\\\ 0 & 1 & 0 & -1 \\end{bmatrix}$,\n- $f = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 1 \\end{bmatrix}$,\n- $\\widetilde{S} = \\operatorname{diag}(S)$.\n\nAlgorithmic requirements:\n- Implement preconditioned Conjugate Gradient with initial guess $\\lambda_0 = 0$, stopping when the Euclidean norm of the residual $\\|r_k\\|_2$ falls below $10^{-10}$ or when $k$ reaches $m$, whichever comes first, where $m$ is the number of constraints (the dimension of $\\lambda$).\n- After convergence, compute $\\|e_k\\|_{S} = \\sqrt{e_k^{\\top} S e_k}$ using the exact solution $\\lambda^{\\star} = S^{-1} g$.\n- Compute the eigenvalues $\\{\\mu_i\\}$ of $\\widetilde{S}^{-1} S$, then set $\\kappa = \\frac{\\max_i \\mu_i}{\\min_i \\mu_i}$, and evaluate the bound $\\|e_k\\|_{S} \\leq 2 \\left(\\frac{\\sqrt{\\kappa} - 1}{\\sqrt{\\kappa} + 1}\\right)^{k} \\|e_0\\|_{S}$ at the attained iteration count $k$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one entry per test case, each entry itself being a list of the form $[k, \\|e_k\\|_{S}, \\text{bound}]$. For example: $[[k_1,\\|e_{k_1}\\|_{S},b_1],[k_2,\\|e_{k_2}\\|_{S},b_2],[k_3,\\|e_{k_3}\\|_{S},b_3]]$.\n\nNo external input is allowed; all data must be generated inside your program from the test suite provided above.",
            "solution": "The problem requires the analysis and implementation of a preconditioned conjugate gradient solver for a Schur complement system derived from a linear elasticity problem.\n\n**1. Derivation and Properties of the Schur Complement System**\n\nThe governing discrete saddle-point system is:\n$$\n\\begin{bmatrix}\nK & B^{\\top} \\\\\nB & 0\n\\end{bmatrix}\n\\begin{bmatrix}\nu \\\\\n\\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nf \\\\\nc\n\\end{bmatrix}\n$$\nThis represents two coupled equations:\n$$\n\\begin{align*}\nK u + B^{\\top} \\lambda &= f \\quad &(1) \\\\\nB u &= c \\quad &(2)\n\\end{align*}\n$$\nSince $K$ is SPD, it is invertible. From (1), we express $u = K^{-1} (f - B^{\\top} \\lambda)$. Substituting this into (2) yields:\n$$\nB \\left( K^{-1} (f - B^{\\top} \\lambda) \\right) = c \\implies (B K^{-1} B^{\\top}) \\lambda = B K^{-1} f - c\n$$\nThis is the Schur complement system $S \\lambda = g$, with $S := B K^{-1} B^{\\top}$ and $g := B K^{-1} f - c$. Given $c=0$, $g = B K^{-1} f$.\n\nThe matrix $S$ is symmetric positive definite (SPD):\n- **Symmetry:** $S^{\\top} = (B K^{-1} B^{\\top})^{\\top} = (B^{\\top})^{\\top} (K^{-1})^{\\top} B^{\\top} = B K^{-1} B^{\\top} = S$, since $K$ and thus $K^{-1}$ are symmetric.\n- **Positive Definiteness:** For any non-zero $x \\in \\mathbb{R}^{m}$, let $y = B^{\\top} x$. Since $B$ has full row rank, $B^{\\top}$ has full column rank, so $x \\neq 0 \\implies y \\neq 0$. Then $x^{\\top} S x = (B^{\\top} x)^{\\top} K^{-1} (B^{\\top} x) = y^{\\top} K^{-1} y > 0$, because $K^{-1}$ is SPD and $y \\neq 0$.\n\n**2. Preconditioned Conjugate Gradient (PCG) and Convergence**\n\nThe convergence of CG for solving $S\\lambda=g$ depends on the condition number $\\kappa(S)$. PCG accelerates convergence by solving the equivalent system $\\widetilde{S}^{-1} S \\lambda = \\widetilde{S}^{-1} g$, where $\\widetilde{S}$ is an SPD preconditioner. The convergence rate is governed by the condition number of the preconditioned operator $\\kappa(\\widetilde{S}^{-1}S)$. The error $e_k = \\lambda_k - \\lambda^\\star$ after $k$ iterations is bounded in the $S$-norm $\\|v\\|_S = \\sqrt{v^{\\top} S v}$ as:\n$$\n\\|e_k\\|_{S} \\leq 2 \\left( \\frac{\\sqrt{\\kappa} - 1}{\\sqrt{\\kappa} + 1} \\right)^{k} \\|e_0\\|_{S}\n$$\nHere, $\\kappa = \\kappa(\\widetilde{S}^{-1}S) = \\frac{\\mu_{\\max}}{\\mu_{\\min}}$, where $\\mu_i$ are the eigenvalues of $\\widetilde{S}^{-1}S$. The constant $C=2$ is a standard result from the analysis of CG convergence using Chebyshev polynomials.\n\n**3. Numerical Implementation**\n\nThe following Python code implements the required steps for each test case: constructing the matrices, solving the system with PCG, and calculating the final error and theoretical bound.\n\n```python\nimport numpy as np\n\ndef solve_pcg(S, g, S_tilde, tol=1e-10):\n    \"\"\"\n    Solves the system S*lambda = g using the Preconditioned Conjugate Gradient method.\n    \"\"\"\n    m = S.shape[0]\n    lmbda = np.zeros(m)\n    r = g - S @ lmbda\n\n    if np.linalg.norm(r)  tol:\n        return lmbda, 0\n\n    S_tilde_inv = np.linalg.inv(S_tilde)\n    z = S_tilde_inv @ r\n    \n    p = z.copy()\n    rho_old = r.T @ z\n\n    for k in range(m):\n        Sp = S @ p\n        alpha = rho_old / (p.T @ Sp)\n        \n        lmbda_new = lmbda + alpha * p\n        r_new = r - alpha * Sp\n        \n        if np.linalg.norm(r_new)  tol:\n            return lmbda_new, k + 1\n            \n        z_new = S_tilde_inv @ r_new\n\n        rho_new = r_new.T @ z_new\n        beta = rho_new / rho_old\n        \n        p = z_new + beta * p\n        rho_old = rho_new\n        r = r_new\n        lmbda = lmbda_new\n\n    return lmbda, m\n\n\ndef run_tests():\n    \"\"\"\n    Main function to run the test cases and return the results.\n    \"\"\"\n    test_cases = [\n        {'K1': np.array([[4, 1], [1, 3]]), 'K2': np.array([[5, 0], [0, 2]]), \n         'B': np.array([[1, 0, -1, 0], [0, 1, 0, -1]]), 'f': np.array([1, 0, 0, 1]), 'precond_type': 'ideal'},\n        {'K1': np.array([[4, 1], [1, 3]]), 'K2': np.array([[5, 0], [0, 2]]), \n         'B': np.array([[1, 0, -1, 0], [0, 1, 0, -1]]), 'f': np.array([1, 0, 0, 1]), 'precond_type': 'diag'},\n        {'K1': np.array([[1000, 0], [0, 0.001]]), 'K2': np.array([[1, 0], [0, 1]]), \n         'B': np.array([[1, 0, -1, 0], [0, 1, 0, -1]]), 'f': np.array([1, 0, 0, 1]), 'precond_type': 'diag'}\n    ]\n\n    results = []\n\n    for case in test_cases:\n        K = np.block([[case['K1'], np.zeros((2, 2))], [np.zeros((2, 2)), case['K2']]])\n        B = case['B']\n        f = case['f']\n\n        K_inv = np.linalg.inv(K)\n        S = B @ K_inv @ B.T\n        g = B @ K_inv @ f\n\n        if case['precond_type'] == 'ideal':\n            S_tilde = S.copy()\n        elif case['precond_type'] == 'diag':\n            S_tilde = np.diag(np.diag(S))\n        \n        lmbda_k, k_final = solve_pcg(S, g, S_tilde)\n        lmbda_star = np.linalg.solve(S, g)\n        e_k = lmbda_k - lmbda_star\n        norm_ek_S = np.sqrt(e_k.T @ S @ e_k)\n\n        S_tilde_inv = np.linalg.inv(S_tilde)\n        preconditioned_op = S_tilde_inv @ S\n        eigenvalues = np.linalg.eigvals(preconditioned_op)\n        kappa = np.max(eigenvalues.real) / np.min(eigenvalues.real)\n\n        e_0 = -lmbda_star\n        norm_e0_S = np.sqrt(e_0.T @ S @ e_0)\n        \n        if abs(kappa - 1.0)  1e-14:\n            rho_factor = 0.0\n        else:\n            rho_factor = (np.sqrt(kappa) - 1) / (np.sqrt(kappa) + 1)\n        \n        bound = 2.0 * (rho_factor ** k_final) * norm_e0_S\n        results.append([k_final, norm_ek_S, bound])\n    \n    return results\n\n# The numerical results are generated by running the code above.\n# results = run_tests()\n# print(results)\n```",
            "answer": "[[1, 4.440892098500626e-16, 0.0], [2, 2.960594732333751e-16, 0.00847243952136034], [2, 1.3524623724810015e-13, 0.012301138850614066]]"
        }
    ]
}