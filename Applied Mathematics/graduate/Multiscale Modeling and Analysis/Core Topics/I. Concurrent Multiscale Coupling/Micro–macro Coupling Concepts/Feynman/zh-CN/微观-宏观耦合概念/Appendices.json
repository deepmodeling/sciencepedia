{
    "hands_on_practices": [
        {
            "introduction": "任何微观-宏观耦合模型，尤其是均质化理论，其有效性都取决于微观和宏观长度尺度之间的明确分离。这项练习提供了一种具体的方法，通过一个简单的无量纲参数来量化这种尺度分离 。通过这个实践，你将学会如何从问题描述中识别相关的长度尺度，并评估均质化理论的适用性。",
            "id": "3779103",
            "problem": "一根长度为 $L$、具有周期性微观结构的非均匀弹性杆，受到一个空间变化的宏观体力作用，其特征波长记为 $\\lambda$。杆的非均匀刚度由一个系数 $A(y)$ 建模，该系数在其自变量 $y$ 上是光滑、有界且周期为 $1$ 的。微观非均匀性通过标度关系 $y = x / \\ell$ 进入静态平衡的强形式，其中 $\\ell$ 是特征晶粒尺寸。准静态位移场 $u(x)$ 由以下一维椭圆边值问题控制\n$$\n- \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( A\\!\\left(\\frac{x}{\\ell}\\right) \\frac{\\mathrm{d}u(x)}{\\mathrm{d}x} \\right) = f(x),\n$$\n其中 $f(x)$ 是宏观作用力，其空间变化由波长 $\\lambda$ 表征，因此 $f$ 在 $\\lambda$ 量级的距离上发生显著变化。在均匀化理论中，用等效均匀介质替代非均匀介质的有效性，取决于是否存在一个小的无量纲参数，该参数表达了微观和宏观长度尺度之间的明确分离。\n\n从该控制方程出发，并使用基于宏观波长 $\\lambda$（而非杆长 $L$）的无量纲化方法，推导在该情况下量化微观-宏观尺度分离的恰当小无量纲参数。然后，使用给定数据 $L = 10\\,\\mathrm{mm}$、$\\ell = 10\\,\\mu\\mathrm{m}$ 和外加场的 $\\lambda = 1\\,\\mathrm{mm}$，计算其数值。最后，通过解释所推导参数的量级，从尺度分离的角度评估均匀化的渐近有效性，但最终报告结果只提供该无量纲参数的值。\n\n将最终数值四舍五入到四位有效数字。答案以无量纲数的形式表示。",
            "solution": "该问题要求推导量化一维非均匀弹性杆微观-宏观尺度分离的小无量纲参数，并进行数值计算。\n\n杆的静态平衡控制方程如下：\n$$\n- \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( A\\!\\left(\\frac{x}{\\ell}\\right) \\frac{\\mathrm{d}u(x)}{\\mathrm{d}x} \\right) = f(x)\n$$\n此处，$x$ 是沿杆的空间坐标。该问题涉及三个不同的长度尺度：\n1.  微观非均匀性的特征尺寸，或称晶粒尺寸，$\\ell$。\n2.  宏观体力的特征波长 $\\lambda$，它决定了宏观场（如作用力 $f(x)$ 和由此产生的位移 $u(x)$）发生显著变化的长度尺度。\n3.  杆的总长度，$L$。\n\n在均匀化理论中，用等效均匀介质替代非均匀介质的可能性取决于明确的尺度分离。这在数学上通过一个小的无量纲参数（通常记为 $\\epsilon$）来表示，该参数是特征微观长度尺度与特征宏观长度尺度之比。\n\n在本问题中，微观长度尺度明确为 $\\ell$。如题所述，宏观长度尺度是所施加载荷的特征波长 $\\lambda$。因此，无量纲参数 $\\epsilon$ 定义为：\n$$\n\\epsilon = \\frac{\\ell}{\\lambda}\n$$\n均匀化有效的条件是该参数必须远小于 1，即 $\\epsilon \\ll 1$。\n\n为了从控制方程中正式推导出这一点，我们按照指示，基于宏观长度尺度 $\\lambda$ 进行无量纲化。我们引入一个无量纲空间坐标 $\\bar{x}$，定义为：\n$$\n\\bar{x} = \\frac{x}{\\lambda} \\implies x = \\lambda \\bar{x}\n$$\n使用链式法则，关于 $x$ 的导数可以变换为关于 $\\bar{x}$ 的导数：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x} = \\frac{\\mathrm{d}\\bar{x}}{\\mathrm{d}x} \\frac{\\mathrm{d}}{\\mathrm{d}\\bar{x}} = \\frac{1}{\\lambda} \\frac{\\mathrm{d}}{\\mathrm{d}\\bar{x}}\n$$\n接下来，我们考察快速振荡的刚度系数 $A(x/\\ell)$ 的自变量。用新的无量纲坐标 $\\bar{x}$ 表示，该自变量变为：\n$$\n\\frac{x}{\\ell} = \\frac{\\lambda \\bar{x}}{\\ell} = \\frac{1}{\\ell/\\lambda} \\bar{x}\n$$\n代入我们的定义 $\\epsilon = \\ell/\\lambda$，自变量为 $\\bar{x}/\\epsilon$。这代表“快”空间变量，它相对于“慢”宏观变量 $\\bar{x}$ 变化迅速（变化因子为 $1/\\epsilon$）。\n\n将这些变换代入控制微分方程，得到：\n$$\n- \\left( \\frac{1}{\\lambda} \\frac{\\mathrm{d}}{\\mathrm{d}\\bar{x}} \\right) \\left( A\\!\\left(\\frac{\\bar{x}}{\\epsilon}\\right) \\left( \\frac{1}{\\lambda} \\frac{\\mathrm{d}u}{\\mathrm{d}\\bar{x}} \\right) \\right) = f(\\lambda\\bar{x})\n$$\n两边同乘以 $\\lambda^2$ 得：\n$$\n- \\frac{\\mathrm{d}}{\\mathrm{d}\\bar{x}} \\left( A\\!\\left(\\frac{\\bar{x}}{\\epsilon}\\right) \\frac{\\mathrm{d}u}{\\mathrm{d}\\bar{x}} \\right) = \\lambda^2 f(\\lambda\\bar{x})\n$$\n这个重新标度的方程突出了问题的双尺度性质。解 $u$ 和右侧的作用力项在 $\\bar{x}$ 为 $1$ 量级的宏观尺度上变化。相反，刚度系数 $A$ 在由快变量 $\\bar{y} = \\bar{x}/\\epsilon$ 控制的微观尺度上变化。参数 $\\epsilon = \\ell/\\lambda$ 正是形式化这种尺度分离的无量纲量。一个小的 $\\epsilon$ 值表明，在宏观场发生显著变化的距离内，材料属性振荡了许多次，这是均匀化理论的基本假设。\n\n问题要求使用提供的数据计算该参数的数值：\n- 微观长度尺度：$\\ell = 10 \\, \\mu\\mathrm{m}$\n- 宏观长度尺度：$\\lambda = 1 \\, \\mathrm{mm}$\n杆的长度 $L = 10 \\, \\mathrm{mm}$ 是问题物理描述的一部分，但计算尺度分离参数 $\\epsilon$ 并不需要它，因为宏观尺度是由作用力定义的，而不是由域的大小定义的。\n\n为了计算无量纲比率 $\\epsilon$，我们首先将长度转换为统一单位，例如米 (m)：\n$$\n\\ell = 10 \\, \\mu\\mathrm{m} = 10 \\times 10^{-6} \\, \\mathrm{m} = 1 \\times 10^{-5} \\, \\mathrm{m}\n$$\n$$\n\\lambda = 1 \\, \\mathrm{mm} = 1 \\times 10^{-3} \\, \\mathrm{m}\n$$\n现在，我们计算该比率：\n$$\n\\epsilon = \\frac{\\ell}{\\lambda} = \\frac{1 \\times 10^{-5} \\, \\mathrm{m}}{1 \\times 10^{-3} \\, \\mathrm{m}} = 1 \\times 10^{-5 - (-3)} = 1 \\times 10^{-2}\n$$\n所以，$\\epsilon = 0.01$。\n\n问题要求将最终数值四舍五入到四位有效数字。\n$$\n\\epsilon = 0.01000\n$$\n用标准科学记数法表示，这是 $1.000 \\times 10^{-2}$。该参数的量级为 $0.01 \\ll 1$，证实了存在显著的尺度分离，因此在这种情况下应用均匀化技术是完全合理的。",
            "answer": "$$\\boxed{1.000 \\times 10^{-2}}$$"
        },
        {
            "introduction": "一旦确认了尺度分离的条件，下一步便是推导宏观等效属性。本练习将引导你完成周期性均质化的规范流程，通过求解“胞元问题”来获得等效属性 。通过这个层状介质的例子，你将看到一个微观上各向同性但非均质的材料如何在宏观尺度上表现出各向异性，这是均质化理论的一个关键洞见。",
            "id": "3779116",
            "problem": "考虑一个二维周期性分层介质，其标量电导率场 $A(y)$ 仅依赖于第一个微观尺度坐标 $y_1$ 并且周期为 $1$。宏观场 $u^{\\varepsilon}(x)$ 求解椭圆型偏微分方程 (PDE)\n$$\n-\\nabla \\cdot \\big(A\\big(\\tfrac{x}{\\varepsilon}\\big)\\,\\nabla u^{\\varepsilon}(x)\\big) \\;=\\; f(x)\n$$\n在一个有界域中，具有适当的边界条件且 $0  \\varepsilon \\ll 1$。假设 $A(y_1)$ 严格为正且足够光滑以使均匀化方法有效。由于分层结构，预计均匀化模型是各向异性的。\n\n从周期性均匀化的第一性原理以及通过胞元问题建立的微观-宏观耦合出发，推导在特殊情况\n$$\nA(y_1) \\;=\\; a_0 \\;+\\; \\delta \\,\\sin(2\\pi y_1),\n$$\n下的均匀化电导率张量 $A^{\\mathrm{hom}}$，其中参数 $a_0 > 0$ 且 $|\\delta|  a_0$。\n\n以一个矩阵的形式给出你的最终答案，不要包含任何中间计算步骤。",
            "solution": "该问题要求推导电导率为 $A(y_1) = a_0 + \\delta \\sin(2\\pi y_1)$ 的二维分层介质的均匀化电导率张量 $A^{\\mathrm{hom}}$。控制偏微分方程 (PDE) 为\n$$\n-\\nabla \\cdot \\left(A\\left(\\frac{x}{\\varepsilon}\\right) \\nabla u^{\\varepsilon}(x)\\right) = f(x)\n$$\n其中 $y = x/\\varepsilon$ 代表微观尺度坐标。\n\n我们从解 $u^{\\varepsilon}(x)$ 的标准双尺度渐近展开拟设开始：\n$$\nu^{\\varepsilon}(x) = u_0(x) + \\varepsilon u_1(x, y) + \\varepsilon^2 u_2(x, y) + \\dots\n$$\n其中函数 $u_i(x,y)$ 假定在微观尺度变量 $y$ 上是周期的。梯度算子变换为 $\\nabla \\to \\nabla_x + \\frac{1}{\\varepsilon}\\nabla_y$。将该展开式代入偏微分方程，并合并 $\\varepsilon$ 的同次幂项，得到一个方程组。\n\n最高阶项，即 $\\varepsilon^{-2}$ 阶，为：\n$$\n-\\nabla_y \\cdot (A(y) \\nabla_y u_0(x)) = 0\n$$\n由于 $u_0$ 仅依赖于宏观变量 $x$，其关于 $y$ 的梯度为零，即 $\\nabla_y u_0 = 0$，因此该方程被平凡满足。这证实了主阶项 $u_0$ 不依赖于微观尺度变量 $y$。\n\n$\\varepsilon^{-1}$ 阶的项为：\n$$\n-\\nabla_y \\cdot (A(y) \\nabla_y u_1(x,y)) - \\nabla_y \\cdot (A(y) \\nabla_x u_0(x)) = 0\n$$\n我们可以重新整理它以得到 $u_1$ 的方程：\n$$\n-\\nabla_y \\cdot (A(y) \\nabla_y u_1) = \\nabla_y \\cdot (A(y) \\nabla_x u_0)\n$$\n由于此方程在 $\\nabla_x u_0$ 上是线性的，我们寻求以下形式的解：\n$$\nu_1(x,y) = -\\sum_{j=1}^{2} \\chi_j(y) \\frac{\\partial u_0}{\\partial x_j}(x) + C(x)\n$$\n其中 $\\chi_j(y)$ 是 $Y$-周期校正子函数，而 $Y=[0,1]^2$ 是单位胞元。将此 $u_1$ 的拟设代入其控制偏微分方程，我们得到每个 $\\chi_j$ 的胞元问题：\n$$\n-\\nabla_y \\cdot (A(y) \\nabla_y \\chi_j(y)) = -\\nabla_y \\cdot (A(y) e_j)\n$$\n其中 $e_j$ 是 $\\mathbb{R}^2$ 中的第 $j$ 个标准基向量。必须在 $Y$ 上的周期性边界条件和归一化条件 $\\int_Y \\chi_j(y) dy = 0$ 下求解 $\\chi_j$。\n\n$u_0(x)$ 的均匀化方程是通过考虑 $\\varepsilon^0$ 阶项并在单位胞元 $Y$ 上取平均得到的。这个过程产生均匀化方程：\n$$\n-\\nabla_x \\cdot (A^{\\mathrm{hom}} \\nabla_x u_0(x)) = f(x)\n$$\n均匀化张量 $A^{\\mathrm{hom}}$ 的分量由以下公式给出：\n$$\nA^{\\mathrm{hom}}_{ij} = \\left\\langle A(y) \\left(\\delta_{ij} - \\frac{\\partial \\chi_j}{\\partial y_i}\\right) \\right\\rangle_Y = \\int_Y A(y) \\left(\\delta_{ij} - \\frac{\\partial \\chi_j}{\\partial y_i}(y)\\right) dy\n$$\n其中 $\\delta_{ij}$ 是克罗内克 δ。\n\n在这个具体问题中，电导率 $A(y) = A(y_1)$ 仅依赖于 $y_1$ 坐标。让我们来解胞元问题。\n\n对于 $j=2$，胞元问题是：\n$$\n-\\nabla_y \\cdot (A(y_1) \\nabla_y \\chi_2) = -\\nabla_y \\cdot (A(y_1) e_2) = -\\frac{\\partial}{\\partial y_2}(A(y_1)) = 0\n$$\n$\\chi_2$ 的一个有效的周期解是 $\\chi_2(y) = 0$。\n\n对于 $j=1$，胞元问题是：\n$$\n-\\nabla_y \\cdot (A(y_1) \\nabla_y \\chi_1) = -\\nabla_y \\cdot (A(y_1) e_1) = -\\frac{\\partial}{\\partial y_1}(A(y_1))\n$$\n由于右侧仅依赖于 $y_1$，我们寻找一个解 $\\chi_1(y) = \\chi_1(y_1)$。该方程简化为一个常微分方程：\n$$\n-\\frac{d}{d y_1}\\left(A(y_1) \\frac{d\\chi_1}{dy_1}\\right) = -\\frac{d}{dy_1}(A(y_1))\n$$\n对 $y_1$ 积分一次得到：\n$$\nA(y_1) \\frac{d\\chi_1}{dy_1} = A(y_1) - C_1\n$$\n其中 $C_1$ 是一个积分常数。因此，$\\frac{d\\chi_1}{dy_1} = 1 - \\frac{C_1}{A(y_1)}$。\n为使 $\\chi_1(y_1)$ 是周期的，其导数在周期区间 $[0,1]$ 上的平均值必须为零。\n$$\n\\int_0^1 \\frac{d\\chi_1}{dy_1} dy_1 = \\chi_1(1) - \\chi_1(0) = 0\n$$\n$$\n\\int_0^1 \\left(1 - \\frac{C_1}{A(y_1)}\\right) dy_1 = 1 - C_1 \\int_0^1 \\frac{1}{A(y_1)} dy_1 = 0\n$$\n这决定了常数 $C_1$：\n$$\nC_1 = \\left(\\int_0^1 \\frac{1}{A(y_1)} dy_1\\right)^{-1} = \\langle A^{-1} \\rangle^{-1}\n$$\n$C_1$ 是 $A$ 的调和平均值。注意 $\\frac{\\partial \\chi_1}{\\partial y_2} = 0$。\n\n现在我们计算 $A^{\\mathrm{hom}}$ 的分量。由于所有函数仅依赖于 $y_1$，在单位胞元 $Y=[0,1]^2$ 上的平均简化为在 $[0,1]$ 上的积分。\n$$\nA^{\\mathrm{hom}}_{11} = \\left\\langle A(y_1) \\left(1 - \\frac{\\partial\\chi_1}{\\partial y_1}\\right)\\right\\rangle = \\int_0^1 A(y_1) \\left(1 - \\left(1 - \\frac{C_1}{A(y_1)}\\right)\\right) dy_1 = \\int_0^1 C_1 dy_1 = C_1 = \\langle A^{-1} \\rangle^{-1}\n$$\n$$\nA^{\\mathrm{hom}}_{12} = \\left\\langle A(y_1) \\left(0 - \\frac{\\partial\\chi_2}{\\partial y_1}\\right)\\right\\rangle = \\langle A(y_1) \\cdot 0 \\rangle = 0\n$$\n$$\nA^{\\mathrm{hom}}_{21} = \\left\\langle A(y_1) \\left(0 - \\frac{\\partial\\chi_1}{\\partial y_2}\\right)\\right\\rangle = \\langle A(y_1) \\cdot 0 \\rangle = 0\n$$\n$$\nA^{\\mathrm{hom}}_{22} = \\left\\langle A(y_1) \\left(1 - \\frac{\\partial\\chi_2}{\\partial y_2}\\right)\\right\\rangle = \\langle A(y_1) \\cdot 1 \\rangle = \\int_0^1 A(y_1) dy_1 = \\langle A \\rangle\n$$\n所以，均匀化张量是对角的：\n$$\nA^{\\mathrm{hom}} = \\begin{pmatrix} \\langle A^{-1} \\rangle^{-1}  0 \\\\ 0  \\langle A \\rangle \\end{pmatrix}\n$$\n分量 $A^{\\mathrm{hom}}_{11}$ 是 $A(y_1)$ 的调和平均值，而 $A^{\\mathrm{hom}}_{22}$ 是算术平均值。\n\n现在，我们为给定的电导率 $A(y_1) = a_0 + \\delta \\sin(2\\pi y_1)$ 计算这些平均值。\n\n算术平均值为：\n$$\nA^{\\mathrm{hom}}_{22} = \\langle A \\rangle = \\int_0^1 (a_0 + \\delta \\sin(2\\pi y_1)) dy_1 = \\left[ a_0 y_1 - \\frac{\\delta}{2\\pi}\\cos(2\\pi y_1) \\right]_0^1 = \\left(a_0 - \\frac{\\delta}{2\\pi}\\right) - \\left(0 - \\frac{\\delta}{2\\pi}\\right) = a_0\n$$\n调和平均值是倒数的平均值的倒数：\n$$\n\\langle A^{-1} \\rangle = \\int_0^1 \\frac{1}{a_0 + \\delta \\sin(2\\pi y_1)} dy_1\n$$\n令 $t = 2\\pi y_1$，则 $dy_1 = \\frac{dt}{2\\pi}$。积分区间变为 $[0, 2\\pi]$。\n$$\n\\langle A^{-1} \\rangle = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\frac{1}{a_0 + \\delta \\sin(t)} dt\n$$\n这是一个标准的定积分。对于 $a > |b|$，公式为 $\\int_0^{2\\pi} \\frac{d\\theta}{a+b\\sin\\theta} = \\frac{2\\pi}{\\sqrt{a^2-b^2}}$。此处，$a=a_0$ 且 $b=\\delta$。条件 $|\\delta|  a_0$ 确保了分母始终为正。\n$$\n\\langle A^{-1} \\rangle = \\frac{1}{2\\pi} \\left(\\frac{2\\pi}{\\sqrt{a_0^2 - \\delta^2}}\\right) = \\frac{1}{\\sqrt{a_0^2 - \\delta^2}}\n$$\n因此，调和平均值为：\n$$\nA^{\\mathrm{hom}}_{11} = \\langle A^{-1} \\rangle^{-1} = \\sqrt{a_0^2 - \\delta^2}\n$$\n最终，均匀化电导率张量为：\n$$\nA^{\\mathrm{hom}} = \\begin{pmatrix} \\sqrt{a_0^2 - \\delta^2}  0 \\\\ 0  a_0 \\end{pmatrix}\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sqrt{a_0^{2} - \\delta^{2}}  0 \\\\\n0  a_0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在多尺度分析中，连接理论与计算至关重要。本练习演示了如何将均质化原理嵌入到一个数值框架——多尺度有限元方法 (MsFEM) 中 。通过构建 MsFEM 的基函数并分析得到的数值解，你将发现这种先进的数值方法与解析均质化模型之间的深刻联系，特别是在周期性介质的背景下。",
            "id": "3779099",
            "problem": "考虑单位区间上的一个一维椭圆边值问题，该问题具有快速振荡的分层传导率，它模拟了一个典型的微观-宏观耦合系统。物理通量由 $j(x) = - a\\!\\left(\\frac{x}{\\varepsilon}\\right) \\, u'(x)$ 给出，质量守恒定律要求 $- \\frac{d}{dx}\\!\\left( a\\!\\left(\\frac{x}{\\varepsilon}\\right) \\, u'(x) \\right) = f(x)$，其中 $f(x)$ 是一个给定的源项，$\\varepsilon > 0$ 是小尺度周期。假设 $a(y)$ 是周期为1的周期函数，并且在每个周期上是分段常数：在一个周期中比例为 $\\theta \\in (0,1)$ 的部分上 $a(y) = a_{1}  0$，在剩余的比例为 $1 - \\theta$ 的部分上 $a(y) = a_{2}  0$。设宏观强迫项为 $f(x) = 1$，并施加齐次狄利克雷边界条件 $u(0) = 0$ 和 $u(1) = 0$。\n\n你将构造多尺度有限元方法 (MsFEM) 的单元级基函数，然后将MsFEM近似解与均匀化解进行比较。使用一个包含 $N \\geq 2$ 个单元的均匀粗网格，节点为 $x_{j} = j h$, $j = 0,1,\\dots,N$，其中 $h = 1/N$。假设粗单元尺寸是微观周期的整数倍，即 $h = k \\varepsilon$（对于某个整数 $k \\geq 1$），因此每个粗单元恰好由 $k$ 个完整的微观周期组成。\n\n任务：\n1. 在单个粗单元 $K = [x_{L}, x_{R}]$ 上，通过建立并求解局部问题 $- \\frac{d}{dx}\\!\\left( a\\!\\left(\\frac{x}{\\varepsilon}\\right) \\, \\frac{d \\phi_{L}^{K}}{dx} \\right) = 0$（在 $K$ 上）及边界条件 $\\phi_{L}^{K}(x_{L}) = 1$ 和 $\\phi_{L}^{K}(x_{R}) = 0$，推导与左端点 $x_{L}$ 相关联的 MsFEM 节点基函数 $\\phi_{L}^{K}(x)$。请用 $1/a$ 在 $K$ 上的积分来表示其闭式表达式。\n2. 使用推导出的 $\\phi_{L}^{K}(x)$ 和与之类似的 $\\phi_{R}^{K}(x)$，证明单元刚度可简化为 $1/a$ 在 $K$ 上积分的倒数，并得出结论：MsFEM 粗尺度离散化与一个具有等效单元传导率 $a_{K}^{\\ast} = \\frac{h}{\\int_{K} \\frac{1}{a\\!\\left(\\frac{x}{\\varepsilon}\\right)} \\, dx}$ 的标准线性有限元方法相一致。在 $h = k \\varepsilon$ 和周期性分层的假设下，推断 $a_{K}^{\\ast}$ 在所有单元上是常数，并且等于调和平均值 $a^{\\ast} = \\left( \\frac{\\theta}{a_{1}} + \\frac{1 - \\theta}{a_{2}} \\right)^{-1}$。\n3. 求解均匀化极限问题 $- \\frac{d}{dx}\\!\\left( a^{\\ast} \\, \\frac{d u_{\\text{hom}}}{dx} \\right) = 1$ 及边界条件 $u_{\\text{hom}}(0) = 0$ 和 $u_{\\text{hom}}(1) = 0$，并确定精确的均匀化解 $u_{\\text{hom}}(x)$。\n4. 令 $u_{\\text{MsFEM}}(x)$ 表示在包含 $N$ 个均匀单元的粗网格上的 MsFEM 解。计算 $u_{\\text{MsFEM}}$ 和 $u_{\\text{hom}}$ 之间误差的 $L^{2}(0,1)$ 范数，即 $\\| u_{\\text{MsFEM}} - u_{\\text{hom}} \\|_{L^{2}(0,1)}$，并给出最终答案，该答案应为一个仅用 $a_{1}$、$a_{2}$、$\\theta$ 和 $N$ 表示的单一闭式解析表达式。\n\n将最终误差表示为单个解析表达式。无需四舍五入，也无需单位。",
            "solution": "### 第 1 部分：MsFEM 基函数的推导\n单元 $K = [x_{L}, x_{R}]$ 上的基函数 $\\phi_{L}^{K}(x)$ 的局部问题为：\n$$\n- \\frac{d}{dx}\\!\\left( a\\!\\left(\\frac{x}{\\varepsilon}\\right) \\, \\frac{d \\phi_{L}^{K}}{dx} \\right) = 0, \\quad x \\in (x_L, x_R)\n$$\n边界条件为 $\\phi_{L}^{K}(x_{L}) = 1$ 和 $\\phi_{L}^{K}(x_{R}) = 0$。\n对微分方程积分一次，得到：\n$$\na\\!\\left(\\frac{x}{\\varepsilon}\\right) \\frac{d \\phi_{L}^{K}}{dx} = C_{1}\n$$\n其中 $C_{1}$ 是一个积分常数。整理得：\n$$\n\\frac{d \\phi_{L}^{K}}{dx} = \\frac{C_{1}}{a\\!\\left(\\frac{x}{\\varepsilon}\\right)}\n$$\n再次从 $x_{L}$ 到 $x$ 积分，得到：\n$$\n\\phi_{L}^{K}(x) - \\phi_{L}^{K}(x_{L}) = C_{1} \\int_{x_{L}}^{x} \\frac{1}{a\\!\\left(\\frac{s}{\\varepsilon}\\right)} \\, ds\n$$\n使用边界条件 $\\phi_{L}^{K}(x_{L}) = 1$，我们得到：\n$$\n\\phi_{L}^{K}(x) = 1 + C_{1} \\int_{x_{L}}^{x} \\frac{1}{a\\!\\left(\\frac{s}{\\varepsilon}\\right)} \\, ds\n$$\n现在，我们使用第二个边界条件 $\\phi_{L}^{K}(x_{R}) = 0$：\n$$\n0 = 1 + C_{1} \\int_{x_{L}}^{x_{R}} \\frac{1}{a\\!\\left(\\frac{s}{\\varepsilon}\\right)} \\, ds\n$$\n这使我们可以解出 $C_{1}$：\n$$\nC_{1} = - \\left( \\int_{x_{L}}^{x_{R}} \\frac{1}{a\\!\\left(\\frac{s}{\\varepsilon}\\right)} \\, ds \\right)^{-1}\n$$\n将 $C_{1}$ 代回 $\\phi_{L}^{K}(x)$ 的表达式，我们得到闭式表达式：\n$$\n\\phi_{L}^{K}(x) = 1 - \\frac{\\int_{x_{L}}^{x} \\frac{1}{a\\!\\left(\\frac{s}{\\varepsilon}\\right)} \\, ds}{\\int_{x_{L}}^{x_{R}} \\frac{1}{a\\!\\left(\\frac{s}{\\varepsilon}\\right)} \\, ds}\n$$\n这可以重写为：\n$$\n\\phi_{L}^{K}(x) = \\frac{\\int_{x}^{x_{R}} \\frac{1}{a\\!\\left(\\frac{s}{\\varepsilon}\\right)} \\, ds}{\\int_{x_{L}}^{x_{R}} \\frac{1}{a\\!\\left(\\frac{s}{\\varepsilon}\\right)} \\, ds}\n$$\n这就是用 $1/a$ 在 $K$ 上的积分表示的所求表达式。\n\n### 第 2 部分：单元刚度和等效传导率\n单元刚度矩阵 $S^{K}$ 的元素由 $S_{ij}^{K} = \\int_{K} a\\!\\left(\\frac{x}{\\varepsilon}\\right) \\frac{d\\phi_i^K}{dx} \\frac{d\\phi_j^K}{dx} dx$ 给出。单元 $K$ 上的基函数是 $\\phi_L^K$ 和 $\\phi_R^K$。根据对称性，$\\phi_R^K(x) = 1 - \\phi_L^K(x)$。\n根据第 1 部分，$\\phi_{L}^{K}(x)$ 的导数为：\n$$\n\\frac{d \\phi_{L}^{K}}{dx} = \\frac{C_1}{a\\!\\left(\\frac{x}{\\varepsilon}\\right)} = - \\frac{1}{a\\!\\left(\\frac{x}{\\varepsilon}\\right) \\int_{K} \\frac{1}{a\\!\\left(\\frac{s}{\\varepsilon}\\right)} \\, ds}\n$$\n$\\phi_{R}^{K}(x)$ 的导数为 $\\frac{d \\phi_{R}^{K}}{dx} = - \\frac{d \\phi_{L}^{K}}{dx}$。令 $I_{K} = \\int_{K} \\frac{1}{a\\!\\left(\\frac{s}{\\varepsilon}\\right)} \\, ds$。\n刚度矩阵的元素为：\n$$\nS_{LL}^{K} = \\int_{K} a\\!\\left(\\frac{x}{\\varepsilon}\\right) \\left(\\frac{d \\phi_{L}^{K}}{dx}\\right)^2 dx = \\int_{K} a\\!\\left(\\frac{x}{\\varepsilon}\\right) \\left(-\\frac{1}{a\\!\\left(\\frac{x}{\\varepsilon}\\right) I_K}\\right)^2 dx = \\frac{1}{I_K^2} \\int_{K} \\frac{1}{a\\!\\left(\\frac{x}{\\varepsilon}\\right)} dx = \\frac{I_K}{I_K^2} = \\frac{1}{I_K}\n$$\n$$\nS_{RR}^{K} = \\int_{K} a\\!\\left(\\frac{x}{\\varepsilon}\\right) \\left(\\frac{d \\phi_{R}^{K}}{dx}\\right)^2 dx = \\int_{K} a\\!\\left(\\frac{x}{\\varepsilon}\\right) \\left(\\frac{1}{a\\!\\left(\\frac{x}{\\varepsilon}\\right) I_K}\\right)^2 dx = \\frac{1}{I_K}\n$$\n$$\nS_{LR}^{K} = \\int_{K} a\\!\\left(\\frac{x}{\\varepsilon}\\right) \\frac{d \\phi_{L}^{K}}{dx} \\frac{d \\phi_{R}^{K}}{dx} dx = \\int_{K} a\\!\\left(\\frac{x}{\\varepsilon}\\right) \\left(\\frac{-1}{a\\!\\left(\\frac{x}{\\varepsilon}\\right) I_K}\\right) \\left(\\frac{1}{a\\!\\left(\\frac{x}{\\varepsilon}\\right) I_K}\\right) dx = -\\frac{1}{I_K^2} \\int_{K} \\frac{1}{a\\!\\left(\\frac{x}{\\varepsilon}\\right)} dx = -\\frac{1}{I_K}\n$$\n单元刚度矩阵为 $S^K = \\frac{1}{I_K} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$。这与长度为 $h$ 的单元上常数传导率为 $a_K^*$ 的标准线性有限元刚度矩阵 $\\frac{a_K^*}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$ 相同。令两者相等，得到：\n$$\n\\frac{a_K^*}{h} = \\frac{1}{I_K} \\quad \\implies \\quad a_{K}^{\\ast} = \\frac{h}{I_K} = \\frac{h}{\\int_{K} \\frac{1}{a\\!\\left(\\frac{x}{\\varepsilon}\\right)} \\, dx}\n$$\n现在我们计算这个等效传导率。积分是在长度为 $h = k\\varepsilon$ 的单元 $K$ 上进行的。因此，该积分恰好覆盖了微观结构的 $k$ 个周期。\n$$\n\\int_{K} \\frac{1}{a\\!\\left(\\frac{x}{\\varepsilon}\\right)} \\, dx = k \\int_{0}^{\\varepsilon} \\frac{1}{a\\!\\left(\\frac{x}{\\varepsilon}\\right)} \\, dx\n$$\n使用换元法 $y = x/\\varepsilon$，$dx = \\varepsilon dy$：\n$$\n\\int_{0}^{\\varepsilon} \\frac{1}{a\\!\\left(\\frac{x}{\\varepsilon}\\right)} \\, dx = \\varepsilon \\int_{0}^{1} \\frac{1}{a(y)} \\, dy\n$$\n利用其分段常数的定义，计算 $a(y)$ 在一个周期上的积分：\n$$\n\\int_{0}^{1} \\frac{1}{a(y)} \\, dy = \\theta \\cdot \\frac{1}{a_1} + (1-\\theta) \\cdot \\frac{1}{a_2}\n$$\n所以，$\\int_{K} \\frac{1}{a\\!\\left(\\frac{x}{\\varepsilon}\\right)} \\, dx = k \\varepsilon \\left(\\frac{\\theta}{a_1} + \\frac{1-\\theta}{a_2}\\right) = h \\left(\\frac{\\theta}{a_1} + \\frac{1-\\theta}{a_2}\\right)$。\n将此代入 $a_K^*$ 的表达式中：\n$$\na_{K}^{\\ast} = \\frac{h}{h \\left(\\frac{\\theta}{a_1} + \\frac{1-\\theta}{a_2}\\right)} = \\left(\\frac{\\theta}{a_1} + \\frac{1-\\theta}{a_2}\\right)^{-1}\n$$\n该值对所有单元都是常数，并且等于调和平均值 $a^*$。\n\n### 第 3 部分：均匀化解\n均匀化问题是 $-a^* u_{\\text{hom}}''(x) = 1$，边界条件为 $u_{\\text{hom}}(0) = 0$ 和 $u_{\\text{hom}}(1) = 0$。\n积分一次，得到：\n$$\n-a^* u_{\\text{hom}}'(x) = x + C_1\n$$\n再积分一次，得到：\n$$\n-a^* u_{\\text{hom}}(x) = \\frac{x^2}{2} + C_1 x + C_2\n$$\n应用边界条件：\n- $u_{\\text{hom}}(0) = 0 \\implies -a^* \\cdot 0 = 0 + 0 + C_2 \\implies C_2=0$。\n- $u_{\\text{hom}}(1) = 0 \\implies -a^* \\cdot 0 = \\frac{1}{2} + C_1 \\cdot 1 \\implies C_1 = -\\frac{1}{2}$。\n将常数代回，我们求得精确的均匀化解：\n$$\n-a^* u_{\\text{hom}}(x) = \\frac{x^2}{2} - \\frac{x}{2} \\implies u_{\\text{hom}}(x) = \\frac{x(1-x)}{2a^*}\n$$\n\n### 第 4 部分：$L^2$ 误差计算\nMsFEM 粗尺度系统是 $A_{\\text{MsFEM}} U = F_{\\text{MsFEM}}$，其中 $U$ 是节点值的向量。如第 2 部分所示，MsFEM 刚度矩阵 $A_{\\text{MsFEM}}$ 与传导率为 $a^*$ 的均匀化问题的标准 FEM 刚度矩阵相同。\n内部节点 $j$ 的 MsFEM 载荷向量项为 $F_{\\text{MsFEM},j} = \\int_{0}^{1} f(x) \\phi_j(x) dx$，其中 $\\phi_j(x)$ 是全局 MsFEM 基函数。当 $f(x)=1$ 时，这变为 $F_{\\text{MsFEM},j} = \\int_{x_{j-1}}^{x_{j+1}} \\phi_j(x) dx$。由于 $\\phi_j(x)$ 由 $[x_{j-1}, x_j]$ 上的 $\\phi_R^K$ 和 $[x_j, x_{j+1}]$ 上的 $\\phi_L^K$ 组成，且由于对称性 $\\int_K \\phi_L^K dx = \\int_K \\phi_R^K dx = h/2$，因此载荷向量分量为 $F_{\\text{MsFEM},j} = h/2 + h/2 = h$。这与强迫项为 $f(x)=1$ 的均匀化问题的标准 FEM 载荷向量相同。\n因此，MsFEM 的节点值 $u_{\\text{MsFEM}}(x_j)$ 与均匀化问题的标准线性 FEM 解的节点值相同。对于这个一维问题，线性 FEM 解是节点精确的，意味着对所有节点 $j=0, \\dots, N$ 都有 $u_{\\text{MsFEM}}(x_j) = u_{\\text{hom}}(x_j)$。\nMsFEM 解 $u_{\\text{MsFEM}}(x)$ 是这些节点值的分段线性插值。我们需要计算插值误差的 $L^2$ 范数，$e(x) = u_{\\text{MsFEM}}(x) - u_{\\text{hom}}(x)$。\n$$\n\\| u_{\\text{MsFEM}} - u_{\\text{hom}} \\|_{L^2}^2 = \\int_0^1 (u_{\\text{MsFEM}}(x) - u_{\\text{hom}}(x))^2 dx = \\sum_{j=0}^{N-1} \\int_{x_j}^{x_{j+1}} e(x)^2 dx\n$$\n在任何单元 $K_j = [x_j, x_{j+1}]$ 上，$e(x_j)=0$ 且 $e(x_{j+1})=0$。函数 $u_{\\text{hom}}(x) = \\frac{-1}{2a^*}x^2 + \\frac{1}{2a^*}x$ 是一个二次函数。二次函数 $P(x)=c_2 x^2 + c_1 x + c_0$ 与其在区间 $[a, b]$ 上的线性插值之间的误差为 $e(x) = P(x) - L(x) = c_2(x-a)(x-b)$。在这里，误差是 $u_{\\text{hom}}(x) - u_{\\text{MsFEM}}(x) = \\frac{-1}{2a^*}(x-x_j)(x-x_{j+1})$。注意符号取决于定义的顺序，但其平方是相同的。\n长度为 $h=b-a$ 的单元上误差平方的积分是一个标准结果：\n$$\n\\int_a^b e(x)^2 dx = \\int_a^b \\left(c_2(x-a)(x-b)\\right)^2 dx = c_2^2 \\frac{h^5}{30}\n$$\n在我们的情况下，$c_2 = -1/(2a^*)$ 且 $h=1/N$。单个单元上的误差平方为：\n$$\n\\int_{x_j}^{x_{j+1}} e(x)^2 dx = \\left(-\\frac{1}{2a^*}\\right)^2 \\frac{h^5}{30} = \\frac{1}{4(a^*)^2} \\frac{(1/N)^5}{30} = \\frac{1}{120(a^*)^2 N^5}\n$$\n总误差平方是所有 $N$ 个单元上误差之和：\n$$\n\\| u_{\\text{MsFEM}} - u_{\\text{hom}} \\|_{L^2}^2 = N \\cdot \\frac{1}{120(a^*)^2 N^5} = \\frac{1}{120(a^*)^2 N^4}\n$$\n取平方根得到误差的 $L^2$ 范数：\n$$\n\\| u_{\\text{MsFEM}} - u_{\\text{hom}} \\|_{L^2} = \\sqrt{\\frac{1}{120(a^*)^2 N^4}} = \\frac{1}{\\sqrt{120} a^* N^2} = \\frac{1}{2\\sqrt{30} a^* N^2}\n$$\n代入 $a^* = \\left( \\frac{\\theta}{a_1} + \\frac{1-\\theta}{a_2} \\right)^{-1}$：\n$$\n\\| u_{\\text{MsFEM}} - u_{\\text{hom}} \\|_{L^2} = \\frac{1}{2\\sqrt{30}N^2} \\left( \\frac{\\theta}{a_1} + \\frac{1-\\theta}{a_2} \\right)\n$$\n为了将其写成单个分数形式：\n$$\n\\| u_{\\text{MsFEM}} - u_{\\text{hom}} \\|_{L^2} = \\frac{1}{2\\sqrt{30}N^2} \\left( \\frac{\\theta a_2 + (1-\\theta)a_1}{a_1 a_2} \\right) = \\frac{a_1(1-\\theta) + a_2\\theta}{2\\sqrt{30} N^2 a_1 a_2}\n$$",
            "answer": "$$\n\\boxed{\\frac{a_{1}(1-\\theta) + a_{2}\\theta}{2\\sqrt{30} N^{2} a_{1} a_{2}}}\n$$"
        }
    ]
}