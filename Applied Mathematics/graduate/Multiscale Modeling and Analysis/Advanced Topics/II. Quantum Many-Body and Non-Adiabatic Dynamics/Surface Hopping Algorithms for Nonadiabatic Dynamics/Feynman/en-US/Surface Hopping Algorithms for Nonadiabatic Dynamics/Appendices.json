{
    "hands_on_practices": [
        {
            "introduction": "Model systems are essential for developing and validating theories of chemical dynamics. The linear vibronic coupling (LVC) model, in particular, provides a canonical framework for studying nonadiabatic processes near conical intersections. This hands-on programming exercise  challenges you to compute the nonadiabatic coupling vector, $\\mathbf{d}_{12}$, which is the fundamental quantity that drives transitions between electronic states. By mapping out the regions where this coupling is strong, you will build crucial intuition for where surface hops are most likely to occur in a simulation.",
            "id": "3811646",
            "problem": "You are to implement a program that analyzes nonadiabatic derivative couplings in a two-dimensional linear vibronic coupling model. The underlying physical model is defined by two diabatic electronic states linearly coupled to nuclear coordinates. The program must compute, on a Cartesian grid, the set of points where the magnitude of the nonadiabatic derivative coupling vector between the two adiabatic states is large, and output the count of such points for each test case.\n\nModel specification and definitions:\n- Consider nuclear coordinates $(x,y)$ in Angstroms (Å).\n- The diabatic electronic Hamiltonian $\\mathbf{H}(x,y)$ is a $2\\times 2$ matrix with elements\n$$\nH_{11}(x,y) = \\kappa_x x + \\kappa_y y,\\quad\nH_{22}(x,y) = -\\kappa_x x - \\kappa_y y,\\quad\nH_{12}(x,y) = H_{21}(x,y) = V,\n$$\nwhere $\\kappa_x$ and $\\kappa_y$ are slopes with units electronvolt per Angstrom (eV/Å), and $V$ is a constant diabatic coupling with units electronvolt (eV).\n- The adiabatic states $\\lvert \\phi_1(x,y)\\rangle$ and $\\lvert \\phi_2(x,y)\\rangle$ are the normalized eigenvectors of $\\mathbf{H}(x,y)$.\n- The nonadiabatic derivative coupling vector between the adiabatic states $1$ and $2$ is defined by the foundational expression\n$$\n\\mathbf{d}_{12}(x,y) = \\langle \\phi_1(x,y) \\lvert \\nabla_{\\mathbf{R}} \\rvert \\phi_2(x,y) \\rangle,\n$$\nwith $\\nabla_{\\mathbf{R}} = \\left(\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y}\\right)$ acting on nuclear coordinates. The magnitude $\\lVert \\mathbf{d}_{12}(x,y) \\rVert$ has units inverse Angstrom ($\\mathrm{Å}^{-1}$).\n\nComputational task:\n- For each test case, construct a uniform grid in $(x,y)$ over the specified rectangular domain and spacing.\n- At each grid point, form $\\mathbf{H}(x,y)$, obtain the adiabatic states, and compute $\\lVert \\mathbf{d}_{12}(x,y) \\rVert$ based on the above definitions.\n- Identify the set of grid points for which $\\lVert \\mathbf{d}_{12}(x,y) \\rVert \\ge \\tau$, where $\\tau$ is a threshold specified for each test case in units $\\mathrm{Å}^{-1}$.\n- For each test case, report the integer count of such grid points.\n\nPhysical units and numerical requirements:\n- Coordinates $(x,y)$ must be in Å.\n- Parameters $\\kappa_x,\\kappa_y$ must be in eV/Å and $V$ in eV.\n- The threshold $\\tau$ must be in $\\mathrm{Å}^{-1}$.\n- All computations must be carried out with numerical consistency in these units.\n\nTest suite:\nImplement your program to evaluate the following test cases, each specified by a tuple $(\\kappa_x,\\kappa_y,V,\\tau,x_{\\max},y_{\\max},\\Delta)$ where $x\\in[-x_{\\max},x_{\\max}]$, $y\\in[-y_{\\max},y_{\\max}]$, and the grid spacing is $\\Delta$ in Å:\n1. $(0.1, 0.1, 0.05, 1.0, 10.0, 10.0, 0.05)$\n2. $(0.1, 0.1, 0.05, 1.5, 10.0, 10.0, 0.05)$\n3. $(0.2, 0.05, 0.05, 0.5, 10.0, 10.0, 0.05)$\n4. $(0.0, 0.0, 0.05, 0.01, 10.0, 10.0, 0.05)$\n5. $(0.1, 0.1, 0.005, 10.0, 10.0, 10.0, 0.05)$\n\nOutput format:\nYour program should produce a single line of output containing the five integer results as a comma-separated list enclosed in square brackets (for example, \"[n1,n2,n3,n4,n5]\"). No other text should be printed.\n\nScientific and algorithmic bases to use:\n- Use first principles of electronic structure in mixed quantum-classical dynamics: adiabatic states are defined by diagonalization of $\\mathbf{H}(x,y)$, and nonadiabatic derivative couplings arise from the coordinate gradient of the adiabatic states.\n- You may use well-established identities for two-state systems to express the derivative coupling in terms of quantities derived from $\\mathbf{H}(x,y)$, provided they follow from the above definitions and remain consistent with the specified units; do not assume or import shortcut formulas not derivable from the fundamental definitions stated.\n\nEnsure scientific realism: The chosen parameters and domains are consistent with typical linear vibronic coupling models used in surface hopping algorithms for nonadiabatic dynamics. The program should be self-contained and numerically robust over the specified grid and parameter ranges.",
            "solution": "The objective is to compute the number of grid points in a specified two-dimensional domain where the magnitude of the nonadiabatic derivative coupling vector, $\\lVert \\mathbf{d}_{12}(x,y) \\rVert$, exceeds a given threshold $\\tau$. The solution involves an analytical derivation of $\\lVert \\mathbf{d}_{12}(x,y) \\rVert$ from the provided diabatic Hamiltonian, followed by a numerical implementation to evaluate this quantity over the grid and count the qualifying points.\n\nFirst, we establish the analytical expression for the nonadiabatic coupling vector. The diabatic Hamiltonian $\\mathbf{H}(x,y)$ is given by:\n$$\n\\mathbf{H}(x,y) = \\begin{pmatrix} H_{11}(x,y)  H_{12}(x,y) \\\\ H_{21}(x,y)  H_{22}(x,y) \\end{pmatrix} = \\begin{pmatrix} \\kappa_x x + \\kappa_y y  V \\\\ V  -(\\kappa_x x + \\kappa_y y) \\end{pmatrix}\n$$\nFor convenience, let $U(x,y) = \\kappa_x x + \\kappa_y y$. The Hamiltonian simplifies to:\n$$\n\\mathbf{H}(x,y) = \\begin{pmatrix} U(x,y)  V \\\\ V  -U(x,y) \\end{pmatrix}\n$$\nThe adiabatic states $\\lvert \\phi_1(x,y)\\rangle$ and $\\lvert \\phi_2(x,y)\\rangle$ are the eigenvectors of $\\mathbf{H}(x,y)$, with corresponding eigenvalues (adiabatic energies) $E_1(x,y)$ and $E_2(x,y)$. These eigenvalues are found by solving the characteristic equation:\n$$\n(U-E)(-U-E) - V^2 = 0 \\implies E^2 - U^2 - V^2 = 0 \\implies E = \\pm \\sqrt{U^2+V^2}\n$$\nWe assign the lower energy to $E_1$ and the higher energy to $E_2$:\n$$\nE_1 = -\\sqrt{U^2+V^2}, \\quad E_2 = +\\sqrt{U^2+V^2}\n$$\nThe energy difference is $\\Delta E = E_2 - E_1 = 2\\sqrt{U^2+V^2}$. Since $V0$ for all test cases, this difference is never zero, and the states are non-degenerate.\n\nThe nonadiabatic derivative coupling vector is defined as $\\mathbf{d}_{12} = \\langle \\phi_1 \\lvert \\nabla_{\\mathbf{R}} \\rvert \\phi_2 \\rangle$. A standard result derived from the Hellmann-Feynman theorem for off-diagonal elements provides a more computationally convenient form:\n$$\n\\mathbf{d}_{12}(x,y) = \\frac{\\langle \\phi_1(x,y) \\lvert (\\nabla_{\\mathbf{R}} \\mathbf{H}(x,y)) \\rvert \\phi_2(x,y) \\rangle}{E_2(x,y) - E_1(x,y)}\n$$\nwhere $\\nabla_{\\mathbf{R}} = (\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y})$. We need to compute the matrix elements of the Hamiltonian gradient, $\\nabla_{\\mathbf{R}}\\mathbf{H}$. The gradient components are:\n$$\n\\frac{\\partial \\mathbf{H}}{\\partial x} = \\begin{pmatrix} \\kappa_x  0 \\\\ 0  -\\kappa_x \\end{pmatrix}, \\quad \\frac{\\partial \\mathbf{H}}{\\partial y} = \\begin{pmatrix} \\kappa_y  0 \\\\ 0  -\\kappa_y \\end{pmatrix}\n$$\nTo evaluate the matrix element $\\langle \\phi_1 \\lvert \\frac{\\partial \\mathbf{H}}{\\partial q} \\rvert \\phi_2 \\rangle$ for $q \\in \\{x,y\\}$, we can express the adiabatic states in terms of the diabatic states via a rotation with mixing angle $\\theta$. The eigenvectors of $\\mathbf{H}$ are:\n$$\n\\lvert \\phi_1 \\rangle = \\begin{pmatrix} -\\sin \\theta \\\\ \\cos \\theta \\end{pmatrix}, \\quad \\lvert \\phi_2 \\rangle = \\begin{pmatrix} \\cos \\theta \\\\ \\sin \\theta \\end{pmatrix}\n$$\nwhere the mixing angle is defined by $\\tan(2\\theta) = H_{12} / \\frac{1}{2}(H_{11}-H_{22}) = V/U$. From this, we have $\\sin(2\\theta) = V/\\sqrt{U^2+V^2}$ and $\\cos(2\\theta) = U/\\sqrt{U^2+V^2}$.\n\nThe required matrix element for the $x$-component is:\n$$\n\\langle \\phi_1 \\lvert \\frac{\\partial \\mathbf{H}}{\\partial x} \\rvert \\phi_2 \\rangle = \\begin{pmatrix} -\\sin \\theta  \\cos \\theta \\end{pmatrix} \\begin{pmatrix} \\kappa_x  0 \\\\ 0  -\\kappa_x \\end{pmatrix} \\begin{pmatrix} \\cos \\theta \\\\ \\sin \\theta \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} -\\sin \\theta  \\cos \\theta \\end{pmatrix} \\begin{pmatrix} \\kappa_x \\cos \\theta \\\\ -\\kappa_x \\sin \\theta \\end{pmatrix} = -\\kappa_x \\sin\\theta\\cos\\theta - \\kappa_x \\cos\\theta\\sin\\theta = -\\kappa_x \\sin(2\\theta)\n$$\nSubstituting $\\sin(2\\theta) = V/\\sqrt{U^2+V^2}$, we get:\n$$\n\\langle \\phi_1 \\lvert \\frac{\\partial \\mathbf{H}}{\\partial x} \\rvert \\phi_2 \\rangle = -\\kappa_x \\frac{V}{\\sqrt{U^2+V^2}}\n$$\nThe $x$-component of the coupling vector is then:\n$$\nd_{12,x} = \\frac{-\\kappa_x V / \\sqrt{U^2+V^2}}{2\\sqrt{U^2+V^2}} = \\frac{-\\kappa_x V}{2(U^2+V^2)}\n$$\nBy an identical procedure, the $y$-component is:\n$$\nd_{12,y} = \\frac{-\\kappa_y V}{2(U^2+V^2)}\n$$\nThe magnitude squared of the coupling vector is:\n$$\n\\lVert \\mathbf{d}_{12} \\rVert^2 = d_{12,x}^2 + d_{12,y}^2 = \\left( \\frac{-\\kappa_x V}{2(U^2+V^2)} \\right)^2 + \\left( \\frac{-\\kappa_y V}{2(U^2+V^2)} \\right)^2 = \\frac{(\\kappa_x^2 + \\kappa_y^2)V^2}{4(U^2+V^2)^2}\n$$\nTaking the square root and substituting back $U = \\kappa_x x + \\kappa_y y$, we arrive at the final analytical expression for the magnitude of the nonadiabatic derivative coupling:\n$$\n\\lVert \\mathbf{d}_{12}(x,y) \\rVert = \\frac{\\sqrt{\\kappa_x^2 + \\kappa_y^2} |V|}{2\\left( (\\kappa_x x + \\kappa_y y)^2 + V^2 \\right)}\n$$\nSince $V$ is given as positive in all test cases, $|V|=V$.\n\nThe numerical implementation proceeds as follows. For each test case:\n1.  A uniform Cartesian grid for the coordinates $(x,y)$ is constructed over the domain $[-x_{\\max}, x_{\\max}] \\times [-y_{\\max}, y_{\\max}]$ with spacing $\\Delta$. This is efficiently done using `numpy.linspace` to generate the coordinate arrays and `numpy.meshgrid` to create the 2D grid.\n2.  The expression for $\\lVert \\mathbf{d}_{12}(x,y) \\rVert$ is evaluated at every point on the grid. This calculation is vectorized for efficiency: the grid arrays `X` and `Y` are used to compute an array of $U$ values, which in turn are used to compute an array of $\\lVert \\mathbf{d}_{12} \\rVert$ values.\n3.  A boolean mask is created by comparing the resulting array of magnitudes with the threshold $\\tau$.\n4.  The number of points satisfying the condition $\\lVert \\mathbf{d}_{12}(x,y) \\rVert \\ge \\tau$ is found by summing the elements of the boolean mask.\n5.  The final integer count is stored for each test case.\n\nThis approach is numerically stable because the denominator $((\\kappa_x x + \\kappa_y y)^2 + V^2)$ is strictly positive for $V0$. It is also computationally efficient due to the use of a direct analytical formula and vectorized operations.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the number of grid points where the magnitude of the nonadiabatic\n    derivative coupling exceeds a threshold for several test cases of a linear\n    vibronic coupling model.\n    \"\"\"\n    \n    # Test cases are tuples of the form:\n    # (kappa_x, kappa_y, V, tau, x_max, y_max, delta)\n    test_cases = [\n        (0.1, 0.1, 0.05, 1.0, 10.0, 10.0, 0.05),\n        (0.1, 0.1, 0.05, 1.5, 10.0, 10.0, 0.05),\n        (0.2, 0.05, 0.05, 0.5, 10.0, 10.0, 0.05),\n        (0.0, 0.0, 0.05, 0.01, 10.0, 10.0, 0.05),\n        (0.1, 0.1, 0.005, 10.0, 10.0, 10.0, 0.05),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        kappa_x, kappa_y, V, tau, x_max, y_max, delta = case\n\n        # Set up the computational grid.\n        # The number of points is calculated to ensure the spacing is delta.\n        # This is robust for cases where 2*x_max/delta is an integer.\n        nx = int(round(2 * x_max / delta)) + 1\n        ny = int(round(2 * y_max / delta)) + 1\n        x_coords = np.linspace(-x_max, x_max, nx)\n        y_coords = np.linspace(-y_max, y_max, ny)\n        \n        X, Y = np.meshgrid(x_coords, y_coords, indexing='ij')\n\n        # The analytical formula for the magnitude of the derivative coupling vector is:\n        # ||d_12|| = (sqrt(kappa_x^2 + kappa_y^2) * |V|) / (2 * ((kappa_x*x + kappa_y*y)^2 + V^2))\n        \n        # Vectorized calculation over the entire grid.\n        # Term U simplifies the expression\n        U = kappa_x * X + kappa_y * Y\n        \n        # Numerator is constant over the grid\n        numerator = np.sqrt(kappa_x**2 + kappa_y**2) * V\n        \n        # Denominator depends on grid position\n        denominator = 2 * (U**2 + V**2)\n        \n        # Handle the case where the numerator is zero to prevent 0/0 if V=0.\n        # This also correctly handles the kappa_x = kappa_y = 0 case.\n        if numerator == 0.0:\n            d_mag = np.zeros_like(X)\n        else:\n            d_mag = numerator / denominator\n        \n        # Count the number of grid points where the magnitude exceeds the threshold\n        count = np.sum(d_mag = tau)\n        \n        results.append(int(count))\n\n    # Print the final list of counts in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "When a molecular trajectory enters a region of significant nonadiabatic coupling, the electronic wavefunction no longer remains on a single adiabatic state but evolves into a superposition. The FSSH algorithm captures this by integrating the time-dependent Schrödinger equation for the electronic coefficients. This practice problem  focuses on the very beginning of this process, asking you to calculate the population transferred to a target state over a single, short time step. Mastering this calculation is key to understanding how FSSH determines the probability of a surface hop.",
            "id": "3811679",
            "problem": "A two-state molecular system is propagated with the Fewest Switches Surface Hopping (FSSH) algorithm, in which nuclei follow classical trajectories while electronic amplitudes evolve quantum mechanically along the trajectory. Consider the adiabatic representation with electronic states $\\{|\\phi_{1}(\\mathbf{R})\\rangle, |\\phi_{2}(\\mathbf{R})\\rangle\\}$, adiabatic energies $E_{1}=0$ and $E_{2}=0.1$ eV, and an initial electronic state specified by coefficients $c_{1}(0)=1$ and $c_{2}(0)=0$. The nuclear velocity magnitude is $|\\mathbf{v}|=0.5 \\text{ \\AA}/\\text{fs}$. The nonadiabatic coupling vector is defined by $\\mathbf{d}_{jk}(\\mathbf{R})=\\langle \\phi_{j}(\\mathbf{R})|\\nabla_{\\mathbf{R}}|\\phi_{k}(\\mathbf{R})\\rangle$, and its projection along the trajectory satisfies $\\mathbf{v}\\cdot\\mathbf{d}_{12}=0.02 \\text{ fs}^{-1}$ over the time window considered. Assume the adiabatic electronic states are chosen real so that $\\mathbf{d}_{jk}\\in\\mathbb{R}$ and $\\mathbf{d}_{jk}=-\\mathbf{d}_{kj}$, and that both the adiabatic energies and the nonadiabatic couplings are constant over the short time interval $\\Delta t=0.2$ fs.\n\nStarting from the time-dependent Schrödinger equation for the electronic amplitudes along the classical trajectory, and working to the leading nontrivial order in $\\Delta t$, derive an expression for the change in the electronic population of state $2$, $\\Delta |c_{2}|^{2}=|c_{2}(\\Delta t)|^{2}-|c_{2}(0)|^{2}$, and compute its value using the given data. Express your final answer as a dimensionless number. If you approximate your final numerical value, use standard scientific notation without rounding instructions beyond what is necessary to represent the computed value clearly.",
            "solution": "### Step 1: Extract Givens\n- System: A $2$-state molecular system.\n- Algorithm: Fewest Switches Surface Hopping (FSSH).\n- Adiabatic representation: Electronic states $\\{|\\phi_{1}(\\mathbf{R})\\rangle, |\\phi_{2}(\\mathbf{R})\\rangle\\}$.\n- Adiabatic energies: $E_{1}=0$ eV, $E_{2}=0.1$ eV.\n- Initial electronic state coefficients: $c_{1}(0)=1$, $c_{2}(0)=0$.\n- Nuclear velocity magnitude: $|\\mathbf{v}|=0.5$ Å/fs.\n- Nonadiabatic coupling vector definition: $\\mathbf{d}_{jk}(\\mathbf{R})=\\langle \\phi_{j}(\\mathbf{R})|\\nabla_{\\mathbf{R}}|\\phi_{k}(\\mathbf{R})\\rangle$.\n- Projected nonadiabatic coupling: $\\mathbf{v}\\cdot\\mathbf{d}_{12}=0.02$ fs$^{-1}$.\n- Properties of coupling: $\\mathbf{d}_{jk}\\in\\mathbb{R}$ and $\\mathbf{d}_{jk}=-\\mathbf{d}_{kj}$.\n- Time interval: $\\Delta t=0.2$ fs.\n- Assumption: Adiabatic energies and nonadiabatic couplings are constant over $\\Delta t$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded. It describes the evolution of electronic state amplitudes along a classical nuclear trajectory, which is a central concept in nonadiabatic molecular dynamics, specifically within the framework of surface hopping algorithms. The governing equation, the time-dependent Schrödinger equation (TDSE) in the adiabatic basis, and the definition of the nonadiabatic coupling vector are standard in this field.\n\nThe problem is well-posed. It provides a complete set of initial conditions, parameters, and simplifying assumptions (constancy of energies and couplings over the time step) that allow for the calculation of a unique, meaningful quantity, $\\Delta |c_{2}|^{2}$, to the requested order of approximation.\n\nThe problem is objective. The language is technical and precise, free from any subjective or ambiguous statements. All terms are well-defined within the context of theoretical chemistry and physics. The provided numerical values are physically plausible for a molecular system undergoing a nonadiabatic event.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a standard exercise in applying the short-time approximation to the TDSE for electronic amplitudes, a core skill in understanding nonadiabatic dynamics simulations. I will proceed with the solution.\n\nThe evolution of the electronic state amplitudes $c_{j}(t)$ along a classical nuclear trajectory $\\mathbf{R}(t)$ is governed by the time-dependent Schrödinger equation in the adiabatic basis:\n$$ i\\hbar \\frac{dc_j(t)}{dt} = \\sum_k c_k(t) \\left( E_k(\\mathbf{R}(t)) \\delta_{jk} - i\\hbar \\dot{\\mathbf{R}} \\cdot \\mathbf{d}_{jk}(\\mathbf{R}(t)) \\right) $$\nwhere $\\hbar$ is the reduced Planck constant, $E_k$ are the adiabatic electronic energies, $\\delta_{jk}$ is the Kronecker delta, $\\dot{\\mathbf{R}} = \\mathbf{v}$ is the nuclear velocity, and $\\mathbf{d}_{jk}(\\mathbf{R})=\\langle \\phi_{j}(\\mathbf{R})|\\nabla_{\\mathbf{R}}|\\phi_{k}(\\mathbf{R})\\rangle$ is the nonadiabatic coupling vector between states $j$ and $k$.\n\nFor the given $2$-state system, with $j, k \\in \\{1, 2\\}$, the coupled equations are:\n$$ i\\hbar \\frac{dc_1}{dt} = c_1 E_1 - i\\hbar c_2 (\\mathbf{v}\\cdot\\mathbf{d}_{12}) $$\n$$ i\\hbar \\frac{dc_2}{dt} = c_2 E_2 - i\\hbar c_1 (\\mathbf{v}\\cdot\\mathbf{d}_{21}) $$\nUsing the property that for real wavefunctions $\\mathbf{d}_{21} = -\\mathbf{d}_{12}$, and dividing by $i\\hbar$, we obtain:\n$$ \\frac{dc_1}{dt} = -\\frac{i}{\\hbar}E_1 c_1 - c_2 (\\mathbf{v}\\cdot\\mathbf{d}_{12}) $$\n$$ \\frac{dc_2}{dt} = -\\frac{i}{\\hbar}E_2 c_2 + c_1 (\\mathbf{v}\\cdot\\mathbf{d}_{12}) $$\nWe need to solve for the coefficients over a short time interval $\\Delta t$, starting from the initial conditions $c_1(0)=1$ and $c_2(0)=0$. The problem asks for the solution to the leading nontrivial order in $\\Delta t$. This can be obtained by a first-order forward Euler integration of the differential equations, which is equivalent to a first-order Taylor series expansion of the solution.\n\nLet's integrate the equation for $c_2(t)$ from $t=0$ to $t=\\Delta t$:\n$$ \\int_{0}^{\\Delta t} \\frac{dc_2}{dt} dt = \\int_{0}^{\\Delta t} \\left(-\\frac{i}{\\hbar}E_2 c_2(t) + c_1(t) (\\mathbf{v}\\cdot\\mathbf{d}_{12})\\right) dt $$\n$$ c_2(\\Delta t) - c_2(0) = \\int_{0}^{\\Delta t} \\left(-\\frac{i}{\\hbar}E_2 c_2(t) + c_1(t) (\\mathbf{v}\\cdot\\mathbf{d}_{12})\\right) dt $$\nFor a small time step $\\Delta t$, we can approximate the integrand using the values of the coefficients at $t=0$. This corresponds to the leading order term in the expansion. We are given that $E_2$ and $\\mathbf{v}\\cdot\\mathbf{d}_{12}$ are constant over this interval.\n$$ c_2(\\Delta t) - c_2(0) \\approx \\left(-\\frac{i}{\\hbar}E_2 c_2(0) + c_1(0) (\\mathbf{v}\\cdot\\mathbf{d}_{12})\\right) \\Delta t $$\nSubstituting the initial conditions $c_1(0)=1$ and $c_2(0)=0$:\n$$ c_2(\\Delta t) - 0 \\approx \\left(-\\frac{i}{\\hbar}E_2 \\cdot 0 + 1 \\cdot (\\mathbf{v}\\cdot\\mathbf{d}_{12})\\right) \\Delta t $$\n$$ c_2(\\Delta t) \\approx (\\mathbf{v}\\cdot\\mathbf{d}_{12}) \\Delta t $$\nThis is the expression for $c_2(\\Delta t)$ to the leading nontrivial order (first order in $\\Delta t$).\n\nThe quantity of interest is the change in the population of state $2$, which is $\\Delta |c_{2}|^{2} = |c_{2}(\\Delta t)|^{2} - |c_{2}(0)|^{2}$.\nGiven $c_2(0)=0$, we have $|c_2(0)|^2 = 0$. So,\n$$ \\Delta |c_2|^2 = |c_2(\\Delta t)|^2 $$\nUsing our leading-order expression for $c_2(\\Delta t)$:\n$$ \\Delta |c_2|^2 \\approx |(\\mathbf{v}\\cdot\\mathbf{d}_{12}) \\Delta t|^2 $$\nThe problem states that $\\mathbf{d}_{jk} \\in \\mathbb{R}$, which implies $\\mathbf{v}\\cdot\\mathbf{d}_{12}$ is a real number. The time step $\\Delta t$ is also real. Therefore, the expression is real, and its modulus squared is simply its square:\n$$ \\Delta |c_2|^2 \\approx ((\\mathbf{v}\\cdot\\mathbf{d}_{12}) \\Delta t)^2 $$\nThis expression represents the leading nontrivial order for the change in population, which is of order $(\\Delta t)^2$. The adiabatic energies $E_1$ and $E_2$ do not contribute to this leading order term; they would first appear in higher-order corrections to $c_2(\\Delta t)$ and consequently in terms of order $(\\Delta t)^4$ or higher for the population change.\n\nNow we substitute the given numerical values:\n- $\\mathbf{v}\\cdot\\mathbf{d}_{12} = 0.02$ fs$^{-1}$\n- $\\Delta t = 0.2$ fs\n\nThe product $(\\mathbf{v}\\cdot\\mathbf{d}_{12}) \\Delta t$ is:\n$$ (\\mathbf{v}\\cdot\\mathbf{d}_{12}) \\Delta t = (0.02 \\text{ fs}^{-1}) \\times (0.2 \\text{ fs}) = 0.004 $$\nThis product is dimensionless, as expected for an electronic state coefficient.\nThe change in population is then:\n$$ \\Delta |c_2|^2 \\approx (0.004)^2 = 0.000016 $$\nExpressing this value in standard scientific notation gives $1.6 \\times 10^{-5}$.\nThe final derived expression for the change in population is $\\Delta |c_{2}|^{2} = ((\\mathbf{v}\\cdot\\mathbf{d}_{12})\\Delta t)^{2}$.\nThe computed value is $(0.02 \\times 0.2)^{2} = 1.6 \\times 10^{-5}$.",
            "answer": "$$\\boxed{1.6 \\times 10^{-5}}$$"
        },
        {
            "introduction": "A defining feature of the FSSH algorithm is the discrete, stochastic hop that moves the classical trajectory from one potential energy surface to another. To maintain physical consistency, this event must conserve the total energy of the system. This exercise  drills down into the mechanics of this critical step, focusing on how to determine if an upward hop is energetically feasible and how to rescale the nuclear momentum to account for the change in electronic potential energy. Properly handling these 'frustrated hops' and momentum adjustments is essential for any stable and accurate FSSH implementation.",
            "id": "3811686",
            "problem": "Consider a two-state nonadiabatic transition within the Fewest Switches Surface Hopping (FSSH) framework, where classical nuclei of mass $M$ move on adiabatic electronic surfaces $E_1(\\mathbf{R})$ and $E_2(\\mathbf{R})$. A hop from state $1$ to state $2$ at fixed nuclear positions $\\mathbf{R}$ changes the electronic energy by $\\Delta E \\equiv E_2(\\mathbf{R}) - E_1(\\mathbf{R})$. In FSSH, total energy conservation at the instant of the hop is enforced by rescaling only the component of the nuclear momentum along the nonadiabatic coupling direction. Let the nonadiabatic coupling direction be aligned with the current nuclear momentum $\\mathbf{P}$ so that the rescaling acts entirely along $\\mathbf{P}$.\n\nStarting from the definitions of classical kinetic energy $K = \\frac{|\\mathbf{P}|^2}{2M}$ and the requirement of total energy conservation at the hop, determine whether the hop $1 \\to 2$ is energetically allowed for the following parameters:\n- $\\Delta E = 0.08\\,\\mathrm{eV}$,\n- $M = 10\\,\\mathrm{amu}$,\n- $|\\mathbf{P}| = 5\\,\\mathrm{amu}\\cdot\\text{\\AA}/\\mathrm{fs}$,\n- nonadiabatic coupling direction aligned with $\\mathbf{P}$.\n\nAssume that the hop is allowed if and only if the kinetic energy available along the rescaling direction is sufficient to compensate the electronic energy increase, and that, if allowed, the new momentum magnitude $|\\mathbf{P}'|$ is obtained by energy conservation with rescaling along the coupling direction only. Use the fundamental constants $1\\,\\mathrm{amu} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$, $1\\,\\text{\\AA} = 1.0 \\times 10^{-10}\\,\\mathrm{m}$, $1\\,\\mathrm{fs} = 1.0 \\times 10^{-15}\\,\\mathrm{s}$, and $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$.\n\nExpress your final answer as a row matrix $\\begin{pmatrix} a  b \\end{pmatrix}$ where $a$ is $1$ if the hop is allowed and $0$ otherwise, and $b$ is the rescaled momentum magnitude $|\\mathbf{P}'|$ in $\\mathrm{amu}\\cdot\\text{\\AA}/\\mathrm{fs}$. Round $b$ to four significant figures. Do not include any units in the final boxed answer.",
            "solution": "The problem statement is first subjected to validation.\n\n**Step 1: Extract Givens**\n- **System**: Two-state nonadiabatic transition.\n- **Algorithm**: Fewest Switches Surface Hopping (FSSH).\n- **Particles**: Classical nuclei of mass $M$.\n- **Surfaces**: Adiabatic electronic surfaces $E_1(\\mathbf{R})$ and $E_2(\\mathbf{R})$.\n- **Transition**: Hop from state $1$ to state $2$.\n- **Electronic Energy Change**: $\\Delta E \\equiv E_2(\\mathbf{R}) - E_1(\\mathbf{R}) = 0.08\\,\\mathrm{eV}$.\n- **Mass**: $M = 10\\,\\mathrm{amu}$.\n- **Initial Momentum**: $|\\mathbf{P}| = 5\\,\\mathrm{amu}\\cdot\\text{\\AA}/\\mathrm{fs}$.\n- **Momentum Rescaling Rule**: Total energy is conserved by rescaling the nuclear momentum component along the nonadiabatic coupling direction.\n- **Special Condition**: The nonadiabatic coupling direction is aligned with the current nuclear momentum $\\mathbf{P}$.\n- **Hop Condition**: A hop is allowed if and only if the kinetic energy along the rescaling direction is sufficient to cover the electronic energy increase $\\Delta E$.\n- **Constants**: $1\\,\\mathrm{amu} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$, $1\\,\\text{\\AA} = 1.0 \\times 10^{-10}\\,\\mathrm{m}$, $1\\,\\mathrm{fs} = 1.0 \\times 10^{-15}\\,\\mathrm{s}$, and $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$.\n- **Required Output**: A row matrix $\\begin{pmatrix} a  b \\end{pmatrix}$, where $a=1$ if the hop is allowed ($a=0$ otherwise), and $b$ is the final momentum magnitude $|\\mathbf{P}'|$ in $\\mathrm{amu}\\cdot\\text{\\AA}/\\mathrm{fs}$ rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is well-grounded in the theory of computational chemistry, specifically nonadiabatic molecular dynamics. FSSH is a standard and widely used algorithm. The principles of energy conservation and momentum rescaling are central to its formulation.\n- **Well-Posedness**: The problem is well-posed. It provides all necessary data and a clear, unambiguous criterion to determine the outcome. A unique solution can be calculated.\n- **Objectivity**: The problem is stated in objective, quantitative terms, free of subjective or ambiguous language.\n- **Completeness and Consistency**: The set of givens is complete and internally consistent. The special condition of parallel momentum and coupling vectors simplifies the calculation but does not introduce a contradiction.\n- **Realism**: The parameters provided for mass, momentum, and energy are within a realistic range for molecular simulations.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A solution will be provided.\n\n**Solution Derivation**\nThe total energy of the system before the hop, when the electronic state is $1$, is the sum of the potential energy $E_1(\\mathbf{R})$ and the nuclear kinetic energy $K_1$:\n$$E_{tot, 1} = E_1(\\mathbf{R}) + K_1$$\nThe kinetic energy is given by $K_1 = \\frac{|\\mathbf{P}|^2}{2M}$.\n\nAfter a successful hop to state $2$, the total energy is:\n$$E_{tot, 2} = E_2(\\mathbf{R}) + K_2$$\nwhere $K_2 = \\frac{|\\mathbf{P}'|^2}{2M}$ is the new kinetic energy corresponding to the rescaled momentum $\\mathbf{P}'$.\n\nThe FSSH algorithm enforces conservation of total energy at the instant of the hop, so $E_{tot, 1} = E_{tot, 2}$.\n$$E_1(\\mathbf{R}) + K_1 = E_2(\\mathbf{R}) + K_2$$\nRearranging for the final kinetic energy $K_2$:\n$$K_2 = K_1 - (E_2(\\mathbf{R}) - E_1(\\mathbf{R})) = K_1 - \\Delta E$$\nA hop to a state of higher potential energy ($\\Delta E  0$) is energetically possible only if the final kinetic energy $K_2$ is non-negative. This gives the condition for an allowed hop:\n$$K_2 \\ge 0 \\implies K_1 - \\Delta E \\ge 0 \\implies K_1 \\ge \\Delta E$$\nThe problem states that the kinetic energy available along the rescaling direction must be sufficient. Since the nonadiabatic coupling direction is aligned with the momentum $\\mathbf{P}$, the entire kinetic energy $K_1$ is available for this exchange.\n\nTo check this condition, we must calculate the initial kinetic energy $K_1$ and compare it to $\\Delta E$. The units must be consistent. We will convert all quantities to a consistent energy unit, electron-volts ($\\mathrm{eV}$).\n\nFirst, we calculate $K_1$ in its native units of $\\mathrm{amu}\\cdot(\\text{\\AA}/\\mathrm{fs})^2$:\n$$K_1 = \\frac{|\\mathbf{P}|^2}{2M} = \\frac{(5\\,\\mathrm{amu}\\cdot\\text{\\AA}/\\mathrm{fs})^2}{2(10\\,\\mathrm{amu})} = \\frac{25}{20}\\,\\mathrm{amu}\\cdot(\\text{\\AA}/\\mathrm{fs})^2 = 1.25\\,\\mathrm{amu}\\cdot(\\text{\\AA}/\\mathrm{fs})^2$$\n\nNext, we find the conversion factor from $\\mathrm{amu}\\cdot(\\text{\\AA}/\\mathrm{fs})^2$ to Joules ($\\mathrm{J}$), and then to electron-volts ($\\mathrm{eV}$).\n$$1\\,\\text{\\AA}/\\mathrm{fs} = \\frac{10^{-10}\\,\\mathrm{m}}{10^{-15}\\,\\mathrm{s}} = 10^5\\,\\mathrm{m/s}$$\n$$1\\,\\mathrm{amu}\\cdot(\\text{\\AA}/\\mathrm{fs})^2 = (1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}) \\cdot (10^5\\,\\mathrm{m/s})^2$$\n$$= 1.66053906660 \\times 10^{-17}\\,\\mathrm{J}$$\nNow, convert this to $\\mathrm{eV}$ using $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$:\n$$\\frac{1.66053906660 \\times 10^{-17}\\,\\mathrm{J}}{1.602176634 \\times 10^{-19}\\,\\mathrm{J/eV}} \\approx 103.642696\\,\\mathrm{eV}$$\nSo, $1\\,\\mathrm{amu}\\cdot(\\text{\\AA}/\\mathrm{fs})^2 \\approx 103.642696\\,\\mathrm{eV}$.\n\nNow, we can express $K_1$ in $\\mathrm{eV}$:\n$$K_1 = 1.25 \\times 103.642696\\,\\mathrm{eV} \\approx 129.55337\\,\\mathrm{eV}$$\n\nWe compare this to the required energy increase $\\Delta E$:\n$$K_1 \\approx 129.55\\,\\mathrm{eV}$$\n$$\\Delta E = 0.08\\,\\mathrm{eV}$$\nSince $K_1  \\Delta E$, the hop is energetically allowed. Therefore, the first part of the answer is $a=1$.\n\nNext, we calculate the magnitude of the rescaled momentum, $|\\mathbf{P}'|$. From the energy conservation relation:\n$$K_2 = K_1 - \\Delta E$$\nSince $K \\propto |\\mathbf{P}|^2$, we can write:\n$$\\frac{|\\mathbf{P}'|^2}{2M} = \\frac{|\\mathbf{P}|^2}{2M} - \\Delta E$$\nThis leads to:\n$$\\frac{|\\mathbf{P}'|^2}{|\\mathbf{P}|^2} = 1 - \\frac{\\Delta E}{K_1}$$\n$$|\\mathbf{P}'| = |\\mathbf{P}| \\sqrt{1 - \\frac{\\Delta E}{K_1}}$$\nSubstituting the values in $\\mathrm{eV}$:\n$$|\\mathbf{P}'| = 5 \\sqrt{1 - \\frac{0.08}{129.55337}} \\,\\, \\mathrm{amu}\\cdot\\text{\\AA}/\\mathrm{fs}$$\n$$|\\mathbf{P}'| = 5 \\sqrt{1 - 0.00061750...} \\,\\, \\mathrm{amu}\\cdot\\text{\\AA}/\\mathrm{fs}$$\n$$|\\mathbf{P}'| = 5 \\sqrt{0.99938249...} \\,\\, \\mathrm{amu}\\cdot\\text{\\AA}/\\mathrm{fs}$$\n$$|\\mathbf{P}'| = 5 \\times 0.99969119... \\,\\, \\mathrm{amu}\\cdot\\text{\\AA}/\\mathrm{fs}$$\n$$|\\mathbf{P}'| \\approx 4.9984559... \\,\\, \\mathrm{amu}\\cdot\\text{\\AA}/\\mathrm{fs}$$\nRounding this result to four significant figures gives $b = 4.998$.\n\nThe final answer is the row matrix $\\begin{pmatrix} a  b \\end{pmatrix} = \\begin{pmatrix} 1  4.998 \\end{pmatrix}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  4.998\n\\end{pmatrix}\n}\n$$"
        }
    ]
}