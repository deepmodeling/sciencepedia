{
    "hands_on_practices": [
        {
            "introduction": "任何非绝热模拟的基础是理解非绝热耦合向量 $\\mathbf{d}_{jk}$。这个向量量化了由核运动引起的电子态之间的相互作用，其大小直接关系到跃迁的概率。此练习  涉及一项在研究非绝热过程中的常见任务：为一个标准的线性振动耦合模型计算并绘制这种耦合的大小，从而识别出非绝热跃迁最可能发生的“热点”区域，这为理解和预测化学反应路径提供了基础。",
            "id": "3811646",
            "problem": "您需要实现一个程序，用于分析二维线性振动耦合模型中的非绝热导数耦合。其基本物理模型由两个与核坐标线性耦合的透热电子态定义。程序必须在一个笛卡尔网格上计算出两个绝热态之间的非绝热导数耦合矢量模值较大的点的集合，并为每个测试用例输出这些点的数量。\n\n模型规格与定义：\n- 考虑核坐标 $(x,y)$，单位为埃 (Å)。\n- 透热电子哈密顿量 $\\mathbf{H}(x,y)$ 是一个 $2\\times 2$ 矩阵，其元素为\n$$\nH_{11}(x,y) = \\kappa_x x + \\kappa_y y,\\quad\nH_{22}(x,y) = -\\kappa_x x - \\kappa_y y,\\quad\nH_{12}(x,y) = H_{21}(x,y) = V,\n$$\n其中 $\\kappa_x$ 和 $\\kappa_y$ 是斜率，单位为电子伏特每埃 (eV/Å)，$V$ 是一个恒定的透热耦合，单位为电子伏特 (eV)。\n- 绝热态 $\\lvert \\phi_1(x,y)\\rangle$ 和 $\\lvert \\phi_2(x,y)\\rangle$ 是 $\\mathbf{H}(x,y)$ 的归一化本征向量。\n- 绝热态 1 和 2 之间的非绝热导数耦合矢量由以下基本表达式定义\n$$\n\\mathbf{d}_{12}(x,y) = \\langle \\phi_1(x,y) \\lvert \\nabla_{\\mathbf{R}} \\rvert \\phi_2(x,y) \\rangle,\n$$\n其中 $\\nabla_{\\mathbf{R}} = \\left(\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y}\\right)$ 作用于核坐标。模 $\\lVert \\mathbf{d}_{12}(x,y) \\rVert$ 的单位是埃的倒数 ($\\mathrm{Å}^{-1}$)。\n\n计算任务：\n- 对每个测试用例，在指定的矩形域和间距上构建一个均匀的 $(x,y)$ 网格。\n- 在每个网格点上，构建 $\\mathbf{H}(x,y)$，获得绝热态，并根据上述定义计算 $\\lVert \\mathbf{d}_{12}(x,y) \\rVert$。\n- 找出满足 $\\lVert \\mathbf{d}_{12}(x,y) \\rVert \\ge \\tau$ 的网格点集合，其中 $\\tau$ 是为每个测试用例指定的阈值，单位为 $\\mathrm{Å}^{-1}$。\n- 对每个测试用例，报告此类网格点的整数数量。\n\n物理单位与数值要求：\n- 坐标 $(x,y)$ 必须以 Å 为单位。\n- 参数 $\\kappa_x, \\kappa_y$ 必须以 eV/Å 为单位，$V$ 必须以 eV 为单位。\n- 阈值 $\\tau$ 必须以 $\\mathrm{Å}^{-1}$ 为单位。\n- 所有计算必须在这些单位下保持数值一致性。\n\n测试套件：\n实现您的程序以评估以下测试用例，每个用例由一个元组 $(\\kappa_x,\\kappa_y,V,\\tau,x_{\\max},y_{\\max},\\Delta)$ 指定，其中 $x\\in[-x_{\\max},x_{\\max}]$，$y\\in[-y_{\\max},y_{\\max}]$，网格间距为 $\\Delta$ (单位 Å)：\n1. $(0.1, 0.1, 0.05, 1.0, 10.0, 10.0, 0.05)$\n2. $(0.1, 0.1, 0.05, 1.5, 10.0, 10.0, 0.05)$\n3. $(0.2, 0.05, 0.05, 0.5, 10.0, 10.0, 0.05)$\n4. $(0.0, 0.0, 0.05, 0.01, 10.0, 10.0, 0.05)$\n5. $(0.1, 0.1, 0.005, 10.0, 10.0, 10.0, 0.05)$\n\n输出格式：\n您的程序应生成单行输出，包含五个整数结果，以逗号分隔并用方括号括起来（例如，“[n1,n2,n3,n4,n5]”）。不应打印任何其他文本。\n\n使用的科学和算法基础：\n- 使用混合量子-经典动力学中电子结构的第一性原理：绝热态通过对角化 $\\mathbf{H}(x,y)$ 来定义，非绝热导数耦合源于绝热态的坐标梯度。\n- 您可以使用成熟的双态系统恒等式，将导数耦合表示为从 $\\mathbf{H}(x,y)$ 导出的量，前提是这些恒等式遵循上述定义并与指定单位保持一致；不要假设或引入无法从所述基本定义推导出的简化公式。\n\n确保科学真实性：所选的参数和域与用于非绝热动力学的表面跳跃算法中典型的线性振动耦合模型一致。程序应自成体系，并在指定的网格和参数范围内具有数值鲁棒性。",
            "solution": "目标是计算在指定的二维域中，非绝热导数耦合矢量模值 $\\lVert \\mathbf{d}_{12}(x,y) \\rVert$ 超过给定阈值 $\\tau$ 的网格点数量。解决方案包括从给定的透热哈密顿量解析推导 $\\lVert \\mathbf{d}_{12}(x,y) \\rVert$，然后通过数值实现来在网格上评估此量并统计符合条件的点。\n\n首先，我们建立非绝热耦合矢量的解析表达式。透热哈密顿量 $\\mathbf{H}(x,y)$ 如下：\n$$\n\\mathbf{H}(x,y) = \\begin{pmatrix} H_{11}(x,y)  H_{12}(x,y) \\\\ H_{21}(x,y)  H_{22}(x,y) \\end{pmatrix} = \\begin{pmatrix} \\kappa_x x + \\kappa_y y  V \\\\ V  -(\\kappa_x x + \\kappa_y y) \\end{pmatrix}\n$$\n为方便起见，设 $U(x,y) = \\kappa_x x + \\kappa_y y$。哈密顿量简化为：\n$$\n\\mathbf{H}(x,y) = \\begin{pmatrix} U(x,y)  V \\\\ V  -U(x,y) \\end{pmatrix}\n$$\n绝热态 $\\lvert \\phi_1(x,y)\\rangle$ 和 $\\lvert \\phi_2(x,y)\\rangle$ 是 $\\mathbf{H}(x,y)$ 的本征向量，对应的本征值（绝热能）为 $E_1(x,y)$ 和 $E_2(x,y)$。这些本征值通过求解特征方程得到：\n$$\n(U-E)(-U-E) - V^2 = 0 \\implies E^2 - U^2 - V^2 = 0 \\implies E = \\pm \\sqrt{U^2+V^2}\n$$\n我们将较低的能量赋给 $E_1$，较高的能量赋给 $E_2$：\n$$\nE_1 = -\\sqrt{U^2+V^2}, \\quad E_2 = +\\sqrt{U^2+V^2}\n$$\n能量差为 $\\Delta E = E_2 - E_1 = 2\\sqrt{U^2+V^2}$。由于所有测试用例中 $V>0$，该差值永不为零，因此态是非简并的。\n\n非绝热导数耦合矢量定义为 $\\mathbf{d}_{12} = \\langle \\phi_1 \\lvert \\nabla_{\\mathbf{R}} \\rvert \\phi_2 \\rangle$。从 Hellmann-Feynman 定理的非对角元推导出的一个标准结果提供了一个计算上更方便的形式：\n$$\n\\mathbf{d}_{12}(x,y) = \\frac{\\langle \\phi_1(x,y) \\lvert (\\nabla_{\\mathbf{R}} \\mathbf{H}(x,y)) \\rvert \\phi_2(x,y) \\rangle}{E_2(x,y) - E_1(x,y)}\n$$\n其中 $\\nabla_{\\mathbf{R}} = (\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y})$。我们需要计算哈密顿量梯度 $\\nabla_{\\mathbf{R}}\\mathbf{H}$ 的矩阵元。梯度分量为：\n$$\n\\frac{\\partial \\mathbf{H}}{\\partial x} = \\begin{pmatrix} \\kappa_x  0 \\\\ 0  -\\kappa_x \\end{pmatrix}, \\quad \\frac{\\partial \\mathbf{H}}{\\partial y} = \\begin{pmatrix} \\kappa_y  0 \\\\ 0  -\\kappa_y \\end{pmatrix}\n$$\n为了计算矩阵元 $\\langle \\phi_1 \\lvert \\frac{\\partial \\mathbf{H}}{\\partial q} \\rvert \\phi_2 \\rangle$ (对于 $q \\in \\{x,y\\}$)，我们可以通过一个混合角 $\\theta$ 的旋转，用透热态来表示绝热态。$\\mathbf{H}$ 的本征向量为：\n$$\n\\lvert \\phi_1 \\rangle = \\begin{pmatrix} -\\sin \\theta \\\\ \\cos \\theta \\end{pmatrix}, \\quad \\lvert \\phi_2 \\rangle = \\begin{pmatrix} \\cos \\theta \\\\ \\sin \\theta \\end{pmatrix}\n$$\n其中混合角由 $\\tan(2\\theta) = H_{12} / \\frac{1}{2}(H_{11}-H_{22}) = V/U$ 定义。由此可得 $\\sin(2\\theta) = V/\\sqrt{U^2+V^2}$ 和 $\\cos(2\\theta) = U/\\sqrt{U^2+V^2}$。\n\n所需的 $x$ 分量矩阵元为：\n$$\n\\langle \\phi_1 \\lvert \\frac{\\partial \\mathbf{H}}{\\partial x} \\rvert \\phi_2 \\rangle = \\begin{pmatrix} -\\sin \\theta  \\cos \\theta \\end{pmatrix} \\begin{pmatrix} \\kappa_x  0 \\\\ 0  -\\kappa_x \\end{pmatrix} \\begin{pmatrix} \\cos \\theta \\\\ \\sin \\theta \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} -\\sin \\theta  \\cos \\theta \\end{pmatrix} \\begin{pmatrix} \\kappa_x \\cos \\theta \\\\ -\\kappa_x \\sin \\theta \\end{pmatrix} = -\\kappa_x \\sin\\theta\\cos\\theta - \\kappa_x \\cos\\theta\\sin\\theta = -\\kappa_x \\sin(2\\theta)\n$$\n代入 $\\sin(2\\theta) = V/\\sqrt{U^2+V^2}$，我们得到：\n$$\n\\langle \\phi_1 \\lvert \\frac{\\partial \\mathbf{H}}{\\partial x} \\rvert \\phi_2 \\rangle = -\\kappa_x \\frac{V}{\\sqrt{U^2+V^2}}\n$$\n耦合矢量的 $x$ 分量则为：\n$$\nd_{12,x} = \\frac{-\\kappa_x V / \\sqrt{U^2+V^2}}{2\\sqrt{U^2+V^2}} = \\frac{-\\kappa_x V}{2(U^2+V^2)}\n$$\n通过相同的步骤，得到 $y$ 分量为：\n$$\nd_{12,y} = \\frac{-\\kappa_y V}{2(U^2+V^2)}\n$$\n耦合矢量的模平方为：\n$$\n\\lVert \\mathbf{d}_{12} \\rVert^2 = d_{12,x}^2 + d_{12,y}^2 = \\left( \\frac{-\\kappa_x V}{2(U^2+V^2)} \\right)^2 + \\left( \\frac{-\\kappa_y V}{2(U^2+V^2)} \\right)^2 = \\frac{(\\kappa_x^2 + \\kappa_y^2)V^2}{4(U^2+V^2)^2}\n$$\n取平方根并代回 $U = \\kappa_x x + \\kappa_y y$，我们得到非绝热导数耦合模值的最终解析表达式：\n$$\n\\lVert \\mathbf{d}_{12}(x,y) \\rVert = \\frac{\\sqrt{\\kappa_x^2 + \\kappa_y^2} |V|}{2\\left( (\\kappa_x x + \\kappa_y y)^2 + V^2 \\right)}\n$$\n由于在所有测试用例中给定的 $V$ 都是正数，所以 $|V|=V$。\n\n数值实现步骤如下。对每个测试用例：\n1.  在域 $[-x_{\\max}, x_{\\max}] \\times [-y_{\\max}, y_{\\max}]$ 上以间距 $\\Delta$ 构建一个均匀的笛卡尔坐标 $(x,y)$ 网格。这可以通过使用 `numpy.linspace` 生成坐标数组和 `numpy.meshgrid` 创建二维网格来高效完成。\n2.  在网格的每个点上计算 $\\lVert \\mathbf{d}_{12}(x,y) \\rVert$ 的表达式。为提高效率，此计算是向量化的：使用网格数组 `X` 和 `Y` 来计算 $U$ 值的数组，然后用它来计算 $\\lVert \\mathbf{d}_{12} \\rVert$ 值的数组。\n3.  通过将得到的模值数组与阈值 $\\tau$ 进行比较，创建一个布尔掩码。\n4.  通过对布尔掩码的元素求和，找到满足条件 $\\lVert \\mathbf{d}_{12}(x,y) \\rVert \\ge \\tau$ 的点的数量。\n5.  对每个测试用例，存储最终的整数计数。\n\n这种方法是数值稳定的，因为当 $V>0$ 时，分母 $((\\kappa_x x + \\kappa_y y)^2 + V^2)$ 恒为正。由于使用了直接的解析公式和向量化操作，它在计算上也是高效的。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the number of grid points where the magnitude of the nonadiabatic\n    derivative coupling exceeds a threshold for several test cases of a linear\n    vibronic coupling model.\n    \"\"\"\n    \n    # Test cases are tuples of the form:\n    # (kappa_x, kappa_y, V, tau, x_max, y_max, delta)\n    test_cases = [\n        (0.1, 0.1, 0.05, 1.0, 10.0, 10.0, 0.05),\n        (0.1, 0.1, 0.05, 1.5, 10.0, 10.0, 0.05),\n        (0.2, 0.05, 0.05, 0.5, 10.0, 10.0, 0.05),\n        (0.0, 0.0, 0.05, 0.01, 10.0, 10.0, 0.05),\n        (0.1, 0.1, 0.005, 10.0, 10.0, 10.0, 0.05),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        kappa_x, kappa_y, V, tau, x_max, y_max, delta = case\n\n        # Set up the computational grid.\n        # The number of points is calculated to ensure the spacing is delta.\n        # This is robust for cases where 2*x_max/delta is an integer.\n        nx = int(round(2 * x_max / delta)) + 1\n        ny = int(round(2 * y_max / delta)) + 1\n        x_coords = np.linspace(-x_max, x_max, nx)\n        y_coords = np.linspace(-y_max, y_max, ny)\n        \n        X, Y = np.meshgrid(x_coords, y_coords, indexing='ij')\n\n        # The analytical formula for the magnitude of the derivative coupling vector is:\n        # ||d_12|| = (sqrt(kappa_x^2 + kappa_y^2) * |V|) / (2 * ((kappa_x*x + kappa_y*y)^2 + V^2))\n        \n        # Vectorized calculation over the entire grid.\n        # Term U simplifies the expression\n        U = kappa_x * X + kappa_y * Y\n        \n        # Numerator is constant over the grid\n        numerator = np.sqrt(kappa_x**2 + kappa_y**2) * V\n        \n        # Denominator depends on grid position\n        denominator = 2 * (U**2 + V**2)\n        \n        # Handle the case where the numerator is zero to prevent 0/0 if V=0.\n        # This also correctly handles the kappa_x = kappa_y = 0 case.\n        if numerator == 0.0:\n            d_mag = np.zeros_like(X)\n        else:\n            d_mag = numerator / denominator\n        \n        # Count the number of grid points where the magnitude exceeds the threshold\n        count = np.sum(d_mag >= tau)\n        \n        results.append(int(count))\n\n    # Print the final list of counts in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "一旦轨迹进入非绝热耦合显著的区域，电子波函数就不再局限于单个绝热态，而是演化为多个态的叠加。此练习  聚焦于 FSSH 算法的核心量子力学方面：通过积分含时薛定谔方程来计算短时间内电子布居数在不同态之间的转移。这个计算是决定何时以及以多大概率进行曲面跃迁的基础，是连接量子演化与经典轨迹的关键一步。",
            "id": "3811679",
            "problem": "一个双态分子系统通过最少切换表面跳跃 (FSSH) 算法进行传播，在该算法中，原子核遵循经典轨迹，而电子振幅则沿着轨迹进行量子力学演化。考虑绝热表象，其电子态为 $\\{|\\phi_{1}(\\mathbf{R})\\rangle, |\\phi_{2}(\\mathbf{R})\\rangle\\}$，绝热能为 $E_{1}=0$ 和 $E_{2}=0.1$ eV，初始电子态由系数 $c_{1}(0)=1$ 和 $c_{2}(0)=0$ 指定。原子核速度大小为 $|\\mathbf{v}|=0.5$ Å/fs。非绝热耦合矢量的定义为 $\\mathbf{d}_{jk}(\\mathbf{R})=\\langle \\phi_{j}(\\mathbf{R})|\\nabla_{\\mathbf{R}}|\\phi_{k}(\\mathbf{R})\\rangle$，并且在所考虑的时间窗口内，其沿轨迹的投影满足 $\\mathbf{v}\\cdot\\mathbf{d}_{12}=0.02$ fs$^{-1}$。假设绝热电子态波函数为实函数，因此 $\\mathbf{d}_{jk}$ 是一个实向量且满足 $\\mathbf{d}_{jk}=-\\mathbf{d}_{kj}$，并假设在短时间间隔 $\\Delta t=0.2$ fs 内，绝热能和非绝热耦合均为常数。\n\n从经典轨迹上电子振幅的含时薛定谔方程出发，并计算到 $\\Delta t$ 的领头非平庸阶，推导态2的电子布居数变化量 $\\Delta |c_{2}|^{2}=|c_{2}(\\Delta t)|^{2}-|c_{2}(0)|^{2}$ 的表达式，并使用给定数据计算其值。将最终答案表示为一个无量纲数。如果对最终数值进行近似，请使用标准科学记数法，除了为清晰表示计算值所必需的取舍外，不要进行额外的舍入。",
            "solution": "### 步骤 1：提取已知条件\n- 系统：一个双态分子系统。\n- 算法：最少切换表面跳跃 (FSSH)。\n- 绝热表象：电子态 $\\{|\\phi_{1}(\\mathbf{R})\\rangle, |\\phi_{2}(\\mathbf{R})\\rangle\\}$。\n- 绝热能：$E_{1}=0$ eV, $E_{2}=0.1$ eV。\n- 初始电子态系数：$c_{1}(0)=1$, $c_{2}(0)=0$。\n- 原子核速度大小：$|\\mathbf{v}|=0.5$ Å/fs。\n- 非绝热耦合矢量定义：$\\mathbf{d}_{jk}(\\mathbf{R})=\\langle \\phi_{j}(\\mathbf{R})|\\nabla_{\\mathbf{R}}|\\phi_{k}(\\mathbf{R})\\rangle$。\n- 投影的非绝热耦合：$\\mathbf{v}\\cdot\\mathbf{d}_{12}=0.02$ fs$^{-1}$。\n- 耦合的性质：$\\mathbf{d}_{jk}$ 是一个实向量且 $\\mathbf{d}_{jk}=-\\mathbf{d}_{kj}$。\n- 时间间隔：$\\Delta t=0.2$ fs。\n- 假设：在 $\\Delta t$ 时间内，绝热能和非绝热耦合为常数。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据。它描述了电子态振幅沿经典原子核轨迹的演化，这是非绝热分子动力学中的一个核心概念，特别是在表面跳跃算法的框架内。\n\n控制方程，即绝热基下的含时薛定谔方程 (TDSE)，以及非绝热耦合矢量的定义，都是该领域的标准内容。\n\n该问题是适定的。它提供了一套完整的初始条件、参数和简化假设（在时间步长内能量和耦合的恒定性），从而能够以所要求的近似阶数计算出唯一且有意义的量 $\\Delta |c_{2}|^{2}$。\n\n该问题是客观的。其语言技术性强且精确，没有任何主观或模棱两可的陈述。所有术语在理论化学和物理学的背景下都有明确的定义。所提供的数值对于经历非绝热事件的分子系统来说是物理上合理的。\n\n### 步骤 3：结论与行动\n该问题是有效的。这是一个将短时近似应用于电子振幅的TDSE的标准练习，是理解非绝热动力学模拟的一项核心技能。我将继续进行求解。\n\n电子态振幅 $c_{j}(t)$ 沿经典原子核轨迹 $\\mathbf{R}(t)$ 的演化由绝热基下的含时薛定谔方程决定：\n$$ i\\hbar \\frac{dc_j(t)}{dt} = \\sum_k c_k(t) \\left( E_k(\\mathbf{R}(t)) \\delta_{jk} - i\\hbar \\dot{\\mathbf{R}} \\cdot \\mathbf{d}_{jk}(\\mathbf{R}(t)) \\right) $$\n其中 $\\hbar$ 是约化普朗克常数，$E_k$ 是绝热电子能，$\\delta_{jk}$ 是克罗内克δ函数，$\\dot{\\mathbf{R}} = \\mathbf{v}$ 是原子核速度，$\\mathbf{d}_{jk}(\\mathbf{R})=\\langle \\phi_{j}(\\mathbf{R})|\\nabla_{\\mathbf{R}}|\\phi_{k}(\\mathbf{R})\\rangle$ 是态 $j$ 和 $k$ 之间的非绝热耦合矢量。\n\n对于给定的双态系统，其中 $j, k \\in \\{1, 2\\}$，耦合方程为：\n$$ i\\hbar \\frac{dc_1}{dt} = c_1 E_1 - i\\hbar c_2 (\\mathbf{v}\\cdot\\mathbf{d}_{12}) $$\n$$ i\\hbar \\frac{dc_2}{dt} = c_2 E_2 - i\\hbar c_1 (\\mathbf{v}\\cdot\\mathbf{d}_{21}) $$\n利用实波函数的性质 $\\mathbf{d}_{21} = -\\mathbf{d}_{12}$，并两边除以 $i\\hbar$，我们得到：\n$$ \\frac{dc_1}{dt} = -\\frac{i}{\\hbar}E_1 c_1 - c_2 (\\mathbf{v}\\cdot\\mathbf{d}_{12}) $$\n$$ \\frac{dc_2}{dt} = -\\frac{i}{\\hbar}E_2 c_2 + c_1 (\\mathbf{v}\\cdot\\mathbf{d}_{12}) $$\n我们需要在短时间间隔 $\\Delta t$ 内求解这些系数，初始条件为 $c_1(0)=1$ 和 $c_2(0)=0$。问题要求解到 $\\Delta t$ 的领头非平庸阶。这可以通过对微分方程进行一阶前向欧拉积分得到，这等价于解的一阶泰勒级数展开。\n\n让我们对 $c_2(t)$ 的方程从 $t=0$ 积分到 $t=\\Delta t$：\n$$ \\int_{0}^{\\Delta t} \\frac{dc_2}{dt} dt = \\int_{0}^{\\Delta t} \\left(-\\frac{i}{\\hbar}E_2 c_2(t) + c_1(t) (\\mathbf{v}\\cdot\\mathbf{d}_{12})\\right) dt $$\n$$ c_2(\\Delta t) - c_2(0) = \\int_{0}^{\\Delta t} \\left(-\\frac{i}{\\hbar}E_2 c_2(t) + c_1(t) (\\mathbf{v}\\cdot\\mathbf{d}_{12})\\right) dt $$\n对于一个很小的时间步长 $\\Delta t$，我们可以使用 $t=0$ 时的系数值来近似被积函数。这对应于展开式中的领头阶项。已知在该区间内 $E_2$ 和 $\\mathbf{v}\\cdot\\mathbf{d}_{12}$ 是常数。\n$$ c_2(\\Delta t) - c_2(0) \\approx \\left(-\\frac{i}{\\hbar}E_2 c_2(0) + c_1(0) (\\mathbf{v}\\cdot\\mathbf{d}_{12})\\right) \\Delta t $$\n代入初始条件 $c_1(0)=1$ 和 $c_2(0)=0$：\n$$ c_2(\\Delta t) - 0 \\approx \\left(-\\frac{i}{\\hbar}E_2 \\cdot 0 + 1 \\cdot (\\mathbf{v}\\cdot\\mathbf{d}_{12})\\right) \\Delta t $$\n$$ c_2(\\Delta t) \\approx (\\mathbf{v}\\cdot\\mathbf{d}_{12}) \\Delta t $$\n这是 $c_2(\\Delta t)$ 在领头非平庸阶（$\\Delta t$ 的一阶）的表达式。\n\n我们感兴趣的量是态2的布居数变化，即 $\\Delta |c_{2}|^{2} = |c_{2}(\\Delta t)|^{2} - |c_{2}(0)|^{2}$。\n已知 $c_2(0)=0$，我们有 $|c_2(0)|^2 = 0$。因此，\n$$ \\Delta |c_2|^2 = |c_2(\\Delta t)|^2 $$\n使用我们得到的 $c_2(\\Delta t)$ 的领头阶表达式：\n$$ \\Delta |c_2|^2 \\approx |(\\mathbf{v}\\cdot\\mathbf{d}_{12}) \\Delta t|^2 $$\n问题中说明了 $\\mathbf{d}_{jk}$ 是一个实向量，这意味着 $\\mathbf{v}\\cdot\\mathbf{d}_{12}$ 是一个实数。时间步长 $\\Delta t$ 也是实数。因此，该表达式是实数，其模的平方就是其自身的平方：\n$$ \\Delta |c_2|^2 \\approx ((\\mathbf{v}\\cdot\\mathbf{d}_{12}) \\Delta t)^2 $$\n这个表达式代表了布居数变化的领头非平庸阶，它是 $(\\Delta t)^2$ 阶的。绝热能 $E_1$ 和 $E_2$ 对这个领头阶项没有贡献；它们将首先出现在 $c_2(\\Delta t)$ 的高阶修正项中，因此对布居数变化的贡献是 $(\\Delta t)^4$ 阶或更高阶的项。\n\n现在我们代入给定的数值：\n- $\\mathbf{v}\\cdot\\mathbf{d}_{12} = 0.02$ fs$^{-1}$\n- $\\Delta t = 0.2$ fs\n\n乘积 $(\\mathbf{v}\\cdot\\mathbf{d}_{12}) \\Delta t$ 是：\n$$ (\\mathbf{v}\\cdot\\mathbf{d}_{12}) \\Delta t = (0.02 \\text{ fs}^{-1}) \\times (0.2 \\text{ fs}) = 0.004 $$\n这个乘积是无量纲的，正如对电子态系数的期望一样。\n那么布居数的变化是：\n$$ \\Delta |c_2|^2 \\approx (0.004)^2 = 0.000016 $$\n用标准科学记数法表示该值为 $1.6 \\times 10^{-5}$。\n最终推导出的布居数变化表达式为 $\\Delta |c_{2}|^{2} = ((\\mathbf{v}\\cdot\\mathbf{d}_{12})\\Delta t)^{2}$。\n计算值为 $(0.02 \\times 0.2)^{2} = 1.6 \\times 10^{-5}$。",
            "answer": "$$\\boxed{1.6 \\times 10^{-5}}$$"
        },
        {
            "introduction": "“跃迁”是曲面跃迁轨迹中的决定性时刻，此时经典核从一个势能面切换到另一个势能面。这个关键步骤必须严格遵守总能量守恒，这直接影响轨迹的后续路径。此练习  提供了对 FSSH 算法一个核心机制的实践：判断向更高能量态的跃迁是否在能量上被允许（即所谓的“受阻跃迁”），并在跃迁成功时，如何正确地调整核动量以确保系统的总能量在跃迁前后保持不变。",
            "id": "3811686",
            "problem": "考虑在最少开关表面跳跃（FSSH）框架下的一个双态非绝热跃迁，其中质量为 $M$ 的经典原子核在绝热电子势能面 $E_1(\\mathbf{R})$ 和 $E_2(\\mathbf{R})$ 上运动。在固定的原子核位置 $\\mathbf{R}$，从态1到态2的跳跃使电子能量改变 $\\Delta E \\equiv E_2(\\mathbf{R}) - E_1(\\mathbf{R})$。在FSSH中，跳跃瞬间的总能量守恒是通过仅重标度原子核动量沿非绝热耦合方向的分量来强制执行的。设非绝热耦合方向与当前的原子核动量 $\\mathbf{P}$ 对齐，因此重标度完全作用于 $\\mathbf{P}$ 方向。\n\n根据经典动能 $K = \\frac{|\\mathbf{P}|^2}{2M}$ 的定义和跳跃时总能量守恒的要求，确定对于以下参数，跃迁 $1 \\to 2$ 在能量上是否允许：\n- $\\Delta E = 0.08\\,\\mathrm{eV}$,\n- $M = 10\\,\\mathrm{amu}$,\n- $|\\mathbf{P}| = 5\\,\\mathrm{amu}\\cdot\\mathrm{\\AA}/\\mathrm{fs}$,\n- 非绝热耦合方向与 $\\mathbf{P}$ 对齐。\n\n假设跳跃被允许的充分必要条件是，沿重标度方向可用的动能足以补偿电子能量的增加，并且如果允许，新的动量大小 $|\\mathbf{P}'|$ 是通过仅在耦合方向上重标度并满足能量守恒来获得的。使用基本常数 $1\\,\\mathrm{amu} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$，$1\\,\\mathrm{\\AA} = 1.0 \\times 10^{-10}\\,\\mathrm{m}$，$1\\,\\mathrm{fs} = 1.0 \\times 10^{-15}\\,\\mathrm{s}$，以及 $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$。\n\n将您的最终答案表示为行矩阵 $\\begin{pmatrix} a  b \\end{pmatrix}$，其中如果跳跃被允许，则 $a$ 为 $1$，否则为 $0$；$b$ 是重标度后的动量大小 $|\\mathbf{P}'|$，单位为 $\\mathrm{amu}\\cdot\\mathrm{\\AA}/\\mathrm{fs}$。将 $b$ 四舍五入至四位有效数字。最终的方框答案中不要包含任何单位。",
            "solution": "首先对问题陈述进行验证。\n\n**第一步：提取已知条件**\n- **系统**：双态非绝热跃迁。\n- **算法**：最少开关表面跳跃（FSSH）。\n- **粒子**：质量为 $M$ 的经典原子核。\n- **势能面**：绝热电子势能面 $E_1(\\mathbf{R})$ 和 $E_2(\\mathbf{R})$。\n- **跃迁**：从态1到态2的跳跃。\n- **电子能量变化**：$\\Delta E \\equiv E_2(\\mathbf{R}) - E_1(\\mathbf{R}) = 0.08\\,\\mathrm{eV}$。\n- **质量**：$M = 10\\,\\mathrm{amu}$。\n- **初始动量**：$|\\mathbf{P}| = 5\\,\\mathrm{amu}\\cdot\\mathrm{\\AA}/\\mathrm{fs}$。\n- **动量重标度规则**：通过重标度原子核动量沿非绝热耦合方向的分量来保持总能量守恒。\n- **特殊条件**：非绝热耦合方向与当前原子核动量 $\\mathbf{P}$ 对齐。\n- **跳跃条件**：当且仅当沿重标度方向的动能足以弥补电子能量增加 $\\Delta E$ 时，才允许跳跃。\n- **常数**：$1\\,\\mathrm{amu} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$，$1\\,\\mathrm{\\AA} = 1.0 \\times 10^{-10}\\,\\mathrm{m}$，$1\\,\\mathrm{fs} = 1.0 \\times 10^{-15}\\,\\mathrm{s}$，以及 $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$。\n- **要求输出**：一个行矩阵 $\\begin{pmatrix} a  b \\end{pmatrix}$，其中如果跳跃被允许则 $a=1$（否则 $a=0$），$b$ 是最终动量大小 $|\\mathbf{P}'|$，单位为 $\\mathrm{amu}\\cdot\\mathrm{\\AA}/\\mathrm{fs}$，四舍五入到四位有效数字。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学基础**：该问题在计算化学理论，特别是非绝热分子动力学方面有坚实的基础。FSSH是一种标准且广泛使用的算法。能量守恒和动量重标度原则是其表述的核心。\n- **良态性**：该问题是良态的。它提供了所有必要的数据和明确无误的判据来确定结果。可以计算出唯一的解。\n- **客观性**：该问题以客观、定量的术语陈述，没有主观或含糊不清的语言。\n- **完整性和一致性**：给定的条件集合是完整的且内部一致。动量和耦合矢量平行的特殊条件简化了计算，但没有引入矛盾。\n- **现实性**：所提供的质量、动量和能量参数在分子模拟的现实范围内。\n\n**第三步：结论与行动**\n问题被判定为有效。将提供解答。\n\n**解题过程**\n在跳跃之前，当电子态为1时，系统的总能量是势能 $E_1(\\mathbf{R})$ 和原子核动能 $K_1$ 的和：\n$$E_{tot, 1} = E_1(\\mathbf{R}) + K_1$$\n动能由 $K_1 = \\frac{|\\mathbf{P}|^2}{2M}$ 给出。\n\n成功跳跃到态2后，总能量为：\n$$E_{tot, 2} = E_2(\\mathbf{R}) + K_2$$\n其中 $K_2 = \\frac{|\\mathbf{P}'|^2}{2M}$ 是对应于重标度后动量 $\\mathbf{P}'$ 的新动能。\n\nFSSH算法要求在跳跃瞬间总能量守恒，因此 $E_{tot, 1} = E_{tot, 2}$。\n$$E_1(\\mathbf{R}) + K_1 = E_2(\\mathbf{R}) + K_2$$\n整理可得最终动能 $K_2$：\n$$K_2 = K_1 - (E_2(\\mathbf{R}) - E_1(\\mathbf{R})) = K_1 - \\Delta E$$\n只有当最终动能 $K_2$ 为非负时，向更高势能的态（$\\Delta E > 0$）的跳跃在能量上才是可能的。这给出了允许跳跃的条件：\n$$K_2 \\ge 0 \\implies K_1 - \\Delta E \\ge 0 \\implies K_1 \\ge \\Delta E$$\n问题陈述指出，沿重标度方向可用的动能必须足够。由于非绝热耦合方向与动量 $\\mathbf{P}$ 对齐，因此全部动能 $K_1$ 都可用于此能量交换。\n\n为了检验此条件，我们必须计算初始动能 $K_1$ 并将其与 $\\Delta E$ 比较。单位必须一致。我们将所有量转换为一致的能量单位——电子伏特（$\\mathrm{eV}$）。\n\n首先，我们以其原生单位 $\\mathrm{amu}\\cdot(\\mathrm{\\AA}/\\mathrm{fs})^2$ 计算 $K_1$：\n$$K_1 = \\frac{|\\mathbf{P}|^2}{2M} = \\frac{(5\\,\\mathrm{amu}\\cdot\\mathrm{\\AA}/\\mathrm{fs})^2}{2(10\\,\\mathrm{amu})} = \\frac{25}{20}\\,\\mathrm{amu}\\cdot(\\mathrm{\\AA}/\\mathrm{fs})^2 = 1.25\\,\\mathrm{amu}\\cdot(\\mathrm{\\AA}/\\mathrm{fs})^2$$\n\n接下来，我们找出从 $\\mathrm{amu}\\cdot(\\mathrm{\\AA}/\\mathrm{fs})^2$ 到焦耳（$\\mathrm{J}$），再到电子伏特（$\\mathrm{eV}$）的转换因子。\n$$1\\,\\mathrm{\\AA}/\\mathrm{fs} = \\frac{10^{-10}\\,\\mathrm{m}}{10^{-15}\\,\\mathrm{s}} = 10^5\\,\\mathrm{m/s}$$\n$$1\\,\\mathrm{amu}\\cdot(\\mathrm{\\AA}/\\mathrm{fs})^2 = (1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}) \\cdot (10^5\\,\\mathrm{m/s})^2$$\n$$= 1.66053906660 \\times 10^{-17}\\,\\mathrm{J}$$\n现在，使用 $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$ 将其转换为 $\\mathrm{eV}$：\n$$\\frac{1.66053906660 \\times 10^{-17}\\,\\mathrm{J}}{1.602176634 \\times 10^{-19}\\,\\mathrm{J/eV}} \\approx 103.642696\\,\\mathrm{eV}$$\n所以，$1\\,\\mathrm{amu}\\cdot(\\mathrm{\\AA}/\\mathrm{fs})^2 \\approx 103.642696\\,\\mathrm{eV}$。\n\n现在，我们可以用 $\\mathrm{eV}$ 表示 $K_1$：\n$$K_1 = 1.25 \\times 103.642696\\,\\mathrm{eV} \\approx 129.55337\\,\\mathrm{eV}$$\n\n我们将此与所需的能量增量 $\\Delta E$ 进行比较：\n$$K_1 \\approx 129.55\\,\\mathrm{eV}$$\n$$\\Delta E = 0.08\\,\\mathrm{eV}$$\n由于 $K_1 > \\Delta E$，该跳跃在能量上是允许的。因此，答案的第一部分是 $a=1$。\n\n接下来，我们计算重标度后动量的大小 $|\\mathbf{P}'|$。根据能量守恒关系：\n$$K_2 = K_1 - \\Delta E$$\n由于 $K \\propto |\\mathbf{P}|^2$，我们可以写出：\n$$\\frac{|\\mathbf{P}'|^2}{2M} = \\frac{|\\mathbf{P}|^2}{2M} - \\Delta E$$\n这可以导出：\n$$\\frac{|\\mathbf{P}'|^2}{|\\mathbf{P}|^2} = 1 - \\frac{\\Delta E}{K_1}$$\n$$|\\mathbf{P}'| = |\\mathbf{P}| \\sqrt{1 - \\frac{\\Delta E}{K_1}}$$\n代入以 $\\mathrm{eV}$ 为单位的数值：\n$$|\\mathbf{P}'| = 5 \\sqrt{1 - \\frac{0.08}{129.55337}} \\,\\, \\mathrm{amu}\\cdot\\mathrm{\\AA}/\\mathrm{fs}$$\n$$|\\mathbf{P}'| = 5 \\sqrt{1 - 0.00061750...} \\,\\, \\mathrm{amu}\\cdot\\mathrm{\\AA}/\\mathrm{fs}$$\n$$|\\mathbf{P}'| = 5 \\sqrt{0.99938249...} \\,\\, \\mathrm{amu}\\cdot\\mathrm{\\AA}/\\mathrm{fs}$$\n$$|\\mathbf{P}'| = 5 \\times 0.99969119... \\,\\, \\mathrm{amu}\\cdot\\mathrm{\\AA}/\\mathrm{fs}$$\n$$|\\mathbf{P}'| \\approx 4.9984559... \\,\\, \\mathrm{amu}\\cdot\\mathrm{\\AA}/\\mathrm{fs}$$\n将此结果四舍五入到四位有效数字，得到 $b = 4.998$。\n\n最终答案是行矩阵 $\\begin{pmatrix} a  b \\end{pmatrix} = \\begin{pmatrix} 1  4.998 \\end{pmatrix}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  4.998\n\\end{pmatrix}\n}\n$$"
        }
    ]
}