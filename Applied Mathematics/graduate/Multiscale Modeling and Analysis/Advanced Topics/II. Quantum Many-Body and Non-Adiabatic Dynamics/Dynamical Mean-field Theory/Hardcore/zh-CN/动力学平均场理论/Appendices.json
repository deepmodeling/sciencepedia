{
    "hands_on_practices": [
        {
            "introduction": "在深入研究与无限大“浴”耦合的杂质这一复杂问题之前，理解杂质本身的性质至关重要。本练习将杂质问题独立出来，置于所谓的“原子极限”（$\\Delta(i\\omega_n)=0$）中，从而精确计算其格林函数。通过这项基础实践，你将清晰地看到局域哈伯德相互作用$U$如何产生不同的能量尺度和谱特征，这是理解莫特绝缘体等关联电子现象的基石。",
            "id": "2983234",
            "problem": "考虑在动力学平均场理论（DMFT）中出现的单点杂质问题，处于原子极限情况下，此时杂化函数满足 $\\Delta(i\\omega_{n}) = 0$。该杂质由单轨道哈伯德原子描述，其哈密顿量为\n$$\nH_{\\text{imp}} = U\\, n_{\\uparrow} n_{\\downarrow} - \\mu \\left(n_{\\uparrow} + n_{\\downarrow}\\right),\n$$\n其中 $U$ 是在位相互作用，$\\mu$ 是化学势，而 $n_{\\sigma} = c^{\\dagger}_{\\sigma} c_{\\sigma}$ 是自旋为 $\\sigma \\in \\{\\uparrow,\\downarrow\\}$ 的粒子数算符。设温度为 $T$，逆温度为 $\\beta = 1/(k_{B} T)$，并使用费米子松原频率 $i\\omega_{n}$，其中 $\\omega_{n} = (2n+1)\\pi/\\beta$。\n\n从巨正则配分函数和松原格林函数的基本定义出发，\n$$\nZ_{\\text{imp}} = \\mathrm{Tr}\\left[\\exp\\left(-\\beta H_{\\text{imp}}\\right)\\right], \\qquad G_{\\text{imp},\\sigma}(\\tau) = -\\left\\langle \\mathcal{T}_{\\tau}\\, c_{\\sigma}(\\tau)\\, c_{\\sigma}^{\\dagger}(0)\\right\\rangle,\n$$\n以及 $G_{\\text{imp},\\sigma}(i\\omega_{n})$ 的莱曼表示，计算杂质配分函数 $Z_{\\text{imp}}$，并获得顺磁情况下杂质格林函数 $G_{\\text{imp}}(i\\omega_{n})$ 的显式闭合形式表达式。将您的最终答案 $G_{\\text{imp}}(i\\omega_{n})$ 仅用 $U$、$\\mu$、$\\beta$ 和 $\\omega_{n}$ 表示。无需四舍五入，也无需单位。最终答案必须是单一的解析表达式。",
            "solution": "该问题是计算单轨道哈伯德原子在原子极限（即与热库没有杂化，$\\Delta(i\\omega_{n}) = 0$）下的巨正则配分函数 $Z_{\\text{imp}}$ 和松原格林函数 $G_{\\text{imp}}(i\\omega_{n})$。哈密顿量由 $H_{\\text{imp}} = U\\, n_{\\uparrow} n_{\\downarrow} - \\mu \\left(n_{\\uparrow} + n_{\\downarrow}\\right)$ 给出。\n\n首先，我们建立哈密顿量的希尔伯特空间和谱。该单点可以处于以下四种状态之一：\n1.  空态，记作 $\\left|0\\right\\rangle$，有零个电子（$n_{\\uparrow}=0, n_{\\downarrow}=0$）。\n2.  自旋向上的单占据态，$\\left|\\uparrow\\right\\rangle = c_{\\uparrow}^{\\dagger}\\left|0\\right\\rangle$，有一个电子（$n_{\\uparrow}=1, n_{\\downarrow}=0$）。\n3.  自旋向下的单占据态，$\\left|\\downarrow\\right\\rangle = c_{\\downarrow}^{\\dagger}\\left|0\\right\\rangle$，有一个电子（$n_{\\uparrow}=0, n_{\\downarrow}=1$）。\n4.  双占据态，$\\left|\\uparrow\\downarrow\\right\\rangle = c_{\\uparrow}^{\\dagger}c_{\\downarrow}^{\\dagger}\\left|0\\right\\rangle$，有两个电子（$n_{\\uparrow}=1, n_{\\downarrow}=1$）。\n\n哈密顿量 $H_{\\text{imp}}$ 在该占据数表象中是对角的。我们可以计算每个状态的能量本征值：\n-   对于 $\\left|0\\right\\rangle$：$H_{\\text{imp}}\\left|0\\right\\rangle = \\left[U(0)(0) - \\mu(0+0)\\right]\\left|0\\right\\rangle = 0$。能量为 $E_{0} = 0$。\n-   对于 $\\left|\\uparrow\\right\\rangle$：$H_{\\text{imp}}\\left|\\uparrow\\right\\rangle = \\left[U(1)(0) - \\mu(1+0)\\right]\\left|\\uparrow\\right\\rangle = -\\mu\\left|\\uparrow\\right\\rangle$。能量为 $E_{\\uparrow} = -\\mu$。\n-   对于 $\\left|\\downarrow\\right\\rangle$：$H_{\\text{imp}}\\left|\\downarrow\\right\\rangle = \\left[U(0)(1) - \\mu(0+1)\\right]\\left|\\downarrow\\right\\rangle = -\\mu\\left|\\downarrow\\right\\rangle$。能量为 $E_{\\downarrow} = -\\mu$。\n-   对于 $\\left|\\uparrow\\downarrow\\right\\rangle$：$H_{\\text{imp}}\\left|\\uparrow\\downarrow\\right\\rangle = \\left[U(1)(1) - \\mu(1+1)\\right]\\left|\\uparrow\\downarrow\\right\\rangle = (U-2\\mu)\\left|\\uparrow\\downarrow\\right\\rangle$。能量为 $E_{\\uparrow\\downarrow} = U-2\\mu$。\n\n接下来，我们计算巨正则配分函数 $Z_{\\text{imp}} = \\mathrm{Tr}\\left[\\exp\\left(-\\beta H_{\\text{imp}}\\right)\\right]$。迹是对希尔伯特空间中所有状态的玻尔兹曼因子的求和。\n$$\nZ_{\\text{imp}} = \\exp(-\\beta E_{0}) + \\exp(-\\beta E_{\\uparrow}) + \\exp(-\\beta E_{\\downarrow}) + \\exp(-\\beta E_{\\uparrow\\downarrow})\n$$\n代入能量本征值：\n$$\nZ_{\\text{imp}} = \\exp(-\\beta \\cdot 0) + \\exp(-\\beta (-\\mu)) + \\exp(-\\beta (-\\mu)) + \\exp(-\\beta (U-2\\mu))\n$$\n$$\nZ_{\\text{imp}} = 1 + 2\\exp(\\beta\\mu) + \\exp(-\\beta(U-2\\mu))\n$$\n\n现在我们开始计算杂质格林函数。问题要求的是顺磁情况下的格林函数。由于哈密顿量是自旋对称的，解自然也是顺磁的，即 $G_{\\text{imp},\\uparrow} = G_{\\text{imp},\\downarrow}$。我们将计算一个普适自旋 $\\sigma$ 的 $G_{\\text{imp},\\sigma}(i\\omega_{n})$，然后省略下标。费米子松原格林函数的莱曼表示为：\n$$\nG_{\\text{imp},\\sigma}(i\\omega_{n}) = \\frac{1}{Z_{\\text{imp}}} \\sum_{m,n} \\frac{\\langle m | c_{\\sigma} | n \\rangle \\langle n | c_{\\sigma}^{\\dagger} | m \\rangle}{i\\omega_{n} - (E_{n} - E_{m})}\\left(\\exp(-\\beta E_{m}) + \\exp(-\\beta E_{n})\\right)\n$$\n其中 $|m\\rangle$ 和 $|n\\rangle$ 是 $H_{\\text{imp}}$ 的本征态。矩阵元 $\\langle n | c_{\\sigma}^{\\dagger} | m \\rangle$ 仅当态 $|n\\rangle$ 可以通过在态 $|m\\rangle$ 中产生一个自旋为 $\\sigma$ 的电子得到时才非零。我们必须找出所有这样的态对 $(m, n)$。对于一个特定的自旋，比如 $\\sigma=\\uparrow$，算符 $c_{\\uparrow}^{\\dagger}$ 可以作用于不含自旋向上电子的态，即 $\\left|0\\right\\rangle$ 和 $\\left|\\downarrow\\right\\rangle$。\n\n1.  从 $|m\\rangle = \\left|0\\right\\rangle$ 到 $|n\\rangle = \\left|\\uparrow\\right\\rangle$ 的跃迁：\n    - 矩阵元的平方为 $|\\langle \\uparrow | c_{\\uparrow}^{\\dagger} | 0 \\rangle|^{2} = 1$。\n    - 能量差为 $E_{n} - E_{m} = E_{\\uparrow} - E_{0} = -\\mu - 0 = -\\mu$。\n    - 玻尔兹曼因子为 $\\exp(-\\beta E_{m}) = \\exp(-\\beta E_{0}) = 1$ 和 $\\exp(-\\beta E_{n}) = \\exp(-\\beta E_{\\uparrow}) = \\exp(\\beta\\mu)$。\n    - 对求和的贡献是：\n    $$\n    \\frac{1}{Z_{\\text{imp}}} \\frac{1}{i\\omega_{n} - (-\\mu)} \\left(1 + \\exp(\\beta\\mu)\\right) = \\frac{1}{Z_{\\text{imp}}} \\frac{1 + \\exp(\\beta\\mu)}{i\\omega_{n} + \\mu}\n    $$\n\n2.  从 $|m\\rangle = \\left|\\downarrow\\right\\rangle$ 到 $|n\\rangle = \\left|\\uparrow\\downarrow\\right\\rangle$ 的跃迁：\n    - 矩阵元的平方为 $|\\langle \\uparrow\\downarrow | c_{\\uparrow}^{\\dagger} | \\downarrow \\rangle|^{2} = 1$。此处费米子算符的相位约定得出一个正号。\n    - 能量差为 $E_{n} - E_{m} = E_{\\uparrow\\downarrow} - E_{\\downarrow} = (U-2\\mu) - (-\\mu) = U-\\mu$。\n    - 玻尔兹曼因子为 $\\exp(-\\beta E_{m}) = \\exp(-\\beta E_{\\downarrow}) = \\exp(\\beta\\mu)$ 和 $\\exp(-\\beta E_{n}) = \\exp(-\\beta E_{\\uparrow\\downarrow}) = \\exp(-\\beta(U-2\\mu))$。\n    - 对求和的贡献是：\n    $$\n    \\frac{1}{Z_{\\text{imp}}} \\frac{1}{i\\omega_{n} - (U-\\mu)} \\left(\\exp(\\beta\\mu) + \\exp(-\\beta(U-2\\mu))\\right) = \\frac{1}{Z_{\\text{imp}}} \\frac{\\exp(\\beta\\mu) + \\exp(-\\beta(U-2\\mu))}{i\\omega_{n} - U + \\mu}\n    $$\n\n没有其他可能产生自旋向上电子的跃迁。将这两个贡献相加，得到自旋 $\\sigma=\\uparrow$ 的格林函数。由于自旋对称性，这与 $\\sigma=\\downarrow$ 的情况相同。因此，我们可以省略自旋下标，将结果表示为 $G_{\\text{imp}}(i\\omega_n)$。\n$$\nG_{\\text{imp}}(i\\omega_{n}) = \\frac{1}{Z_{\\text{imp}}} \\left( \\frac{1 + \\exp(\\beta\\mu)}{i\\omega_{n} + \\mu} + \\frac{\\exp(\\beta\\mu) + \\exp(-\\beta(U-2\\mu))}{i\\omega_{n} - U + \\mu} \\right)\n$$\n代入 $Z_{\\text{imp}}$ 的表达式，我们得到杂质格林函数的最终闭合形式表达式。\n$$\nG_{\\text{imp}}(i\\omega_{n}) = \\frac{1}{1 + 2\\exp(\\beta\\mu) + \\exp(-\\beta(U-2\\mu))} \\left( \\frac{1 + \\exp(\\beta\\mu)}{i\\omega_{n} + \\mu} + \\frac{\\exp(\\beta\\mu) + \\exp(-\\beta(U-2\\mu))}{i\\omega_{n} - U + \\mu} \\right)\n$$\n此表达式仅依赖于 $U$、$\\mu$、$\\beta$ 和 $\\omega_{n}$，符合要求。这两项对应于涉及增加一个电子的两种可能的原子跃迁：第一项对应于从空态跃迁到单占据态，激发能为 $-\\mu$；第二项对应于从单占据态跃迁到双占据态，激发能为 $U-\\mu$。",
            "answer": "$$\n\\boxed{\\frac{1}{1 + 2\\exp(\\beta\\mu) + \\exp(-\\beta(U-2\\mu))} \\left( \\frac{1 + \\exp(\\beta\\mu)}{i\\omega_{n} + \\mu} + \\frac{\\exp(\\beta\\mu) + \\exp(-\\beta(U-2\\mu))}{i\\omega_{n} - U + \\mu} \\right)}\n$$"
        },
        {
            "introduction": "这项实践在最简单的情景——无相互作用极限（$U=0$）下，为你架起从杂质到格点的桥梁。你将通过对无相互作用态密度（DOS）进行积分，来推导局域格林函数，这是任何DMFT计算中的一个基本步骤。通过为半圆形态密度精确求解这个问题，你将获得处理希尔伯特变换的实践经验，并了解格点结构如何直接影响局域电子性质。",
            "id": "3752268",
            "problem": "考虑一个晶格上的单带哈伯德模型，其无相互作用色散为 $\\epsilon_{\\mathbf{k}}$，归一化的无相互作用态密度为 $\\rho(\\epsilon)$，其中 $\\int_{-\\infty}^{\\infty} d\\epsilon\\,\\rho(\\epsilon)=1$。在无相互作用极限 $U=0$ 下，使用动力学平均场理论 (DMFT; Dynamical Mean-Field Theory) 中的空腔构造法，证明在松原频率 $i\\omega_{n}$ 和化学势 $\\mu$ 下，杂质格林函数与局域晶格格林函数一致。从晶格格林函数和局域格林函数的定义出发，推导局域格林函数作为态密度的希尔伯特变换的表示。然后，对于一个半圆形无相互作用态密度的晶格，其态密度由 $\\rho(\\epsilon)=\\frac{2}{\\pi D^{2}}\\sqrt{D^{2}-\\epsilon^{2}}$（对于 $|\\epsilon|\\leq D$）给出，其他情况下 $\\rho(\\epsilon)=0$（其中 $D0$ 是半带宽），精确计算该希尔伯特变换，以获得局域格林函数 $G_{\\mathrm{loc}}(i\\omega_{n})$ 作为 $i\\omega_{n}$、$\\mu$ 和 $D$ 的函数的闭合形式表达式。最后，通过确定在 $|\\omega_{n}|\\to\\infty$ 时渐近展开 $G_{\\mathrm{loc}}(i\\omega_{n})\\sim \\frac{c}{i\\omega_{n}}+\\mathcal{O}\\!\\left(\\frac{1}{\\omega_{n}^{2}}\\right)$ 中的领头高频系数 $c$ 来验证其归一化。请以半圆形态密度下 $G_{\\mathrm{loc}}(i\\omega_{n})$ 的闭合形式表达式作为最终答案。无需四舍五入。",
            "solution": "该问题要求对无相互作用极限 ($U=0$) 下的单带哈伯德模型进行多步推导和计算。\n\n**第一步：在 $U=0$ 时证明 $G_{\\mathrm{loc}}(i\\omega_n) = \\mathcal{G}(i\\omega_n)$**\n\n在DMFT框架中，自能被假设为纯局域的，即与动量无关：$\\Sigma_{\\mathbf{k}}(i\\omega_n) = \\Sigma(i\\omega_n)$。\n晶格格林函数由戴森方程给出：\n$$ G(\\mathbf{k}, i\\omega_n) = \\frac{1}{i\\omega_n + \\mu - \\epsilon_{\\mathbf{k}} - \\Sigma(i\\omega_n)} $$\n局域格林函数 $G_{\\mathrm{loc}}(i\\omega_n)$ 是对所有动量求平均：\n$$ G_{\\mathrm{loc}}(i\\omega_n) = \\frac{1}{N} \\sum_{\\mathbf{k}} G(\\mathbf{k}, i\\omega_n) $$\n等效的单杂质问题也由其自身的戴森方程描述：\n$$ \\mathcal{G}(i\\omega_n)^{-1} = \\mathcal{G}_0(i\\omega_n)^{-1} - \\Sigma(i\\omega_n) $$\nDMFT的自洽条件是 $\\mathcal{G}(i\\omega_n) = G_{\\mathrm{loc}}(i\\omega_n)$。这个条件，结合两个戴森方程，引出了所谓的“空腔构造法”关系式，用于定义魏斯场 $\\mathcal{G}_0(i\\omega_n)$：\n$$ \\mathcal{G}_0(i\\omega_n)^{-1} = G_{\\mathrm{loc}}(i\\omega_n)^{-1} + \\Sigma(i\\omega_n) $$\n在无相互作用极限下，$U=0$，因此自能为零，$\\Sigma(i\\omega_n) = 0$。将此代入杂质戴森方程，得到 $\\mathcal{G}(i\\omega_n)^{-1} = \\mathcal{G}_0(i\\omega_n)^{-1}$，即 $\\mathcal{G}(i\\omega_n) = \\mathcal{G}_0(i\\omega_n)$。再将 $\\Sigma(i\\omega_n)=0$ 代入空腔构造方程，得到 $\\mathcal{G}_0(i\\omega_n)^{-1} = G_{\\mathrm{loc}}(i\\omega_n)^{-1}$，即 $\\mathcal{G}_0(i\\omega_n) = G_{\\mathrm{loc}}(i\\omega_n)$。结合这两个结果，我们证明了在无相互作用时，$\\mathcal{G}(i\\omega_n) = G_{\\mathrm{loc}}(i\\omega_n)$。\n\n**第二步：推导希尔伯特变换表示**\n\n在无相互作用极限下（$\\Sigma=0$），局域格林函数为：\n$$ G_{\\mathrm{loc}}(i\\omega_n) = \\frac{1}{N} \\sum_{\\mathbf{k}} \\frac{1}{i\\omega_n + \\mu - \\epsilon_{\\mathbf{k}}} $$\n在热力学极限下，对动量 $\\mathbf{k}$ 的求和可以转换为对能量 $\\epsilon$ 的积分，并以无相互作用态密度 $\\rho(\\epsilon) = \\frac{1}{N}\\sum_{\\mathbf{k}}\\delta(\\epsilon-\\epsilon_{\\mathbf{k}})$ 作为权重：\n$$ G_{\\mathrm{loc}}(i\\omega_n) = \\int_{-\\infty}^{\\infty} d\\epsilon \\, \\frac{\\rho(\\epsilon)}{i\\omega_n + \\mu - \\epsilon} $$\n这个积分正是函数 $\\rho(\\epsilon)$ 在复变量 $z=i\\omega_n+\\mu$ 处的希尔伯特变换。\n\n**第三步：为半圆形态密度计算积分**\n\n对于给定的半圆形态密度 $\\rho(\\epsilon) = \\frac{2}{\\pi D^2} \\sqrt{D^2 - \\epsilon^2}$（$|\\epsilon| \\le D$），我们计算上述积分。令 $z = i\\omega_n + \\mu$。\n$$ G_{\\mathrm{loc}}(z) = \\int_{-D}^{D} d\\epsilon \\left( \\frac{2}{\\pi D^2} \\sqrt{D^2 - \\epsilon^2} \\right) \\frac{1}{z - \\epsilon} $$\n使用变量代换 $\\epsilon = D\\cos\\theta$，则 $d\\epsilon = -D\\sin\\theta d\\theta$。积分限从 $\\epsilon \\in [-D, D]$ 变为 $\\theta \\in [\\pi, 0]$。\n$$ G_{\\mathrm{loc}}(z) = \\frac{2}{\\pi D^2} \\int_{\\pi}^{0} (D\\sin\\theta) \\frac{1}{z - D\\cos\\theta} (-D\\sin\\theta d\\theta) = \\frac{2}{\\pi} \\int_{0}^{\\pi} d\\theta \\frac{\\sin^2\\theta}{z - D\\cos\\theta} $$\n利用恒等式 $\\sin^2\\theta = 1 - \\cos^2\\theta$ 和分式分解 $\\frac{1-x^2}{z-Dx} = \\frac{x}{D} + \\frac{z}{D^2} + \\frac{1-z^2/D^2}{z-Dx}$（其中 $x=\\cos\\theta$），积分变为：\n$$ G_{\\mathrm{loc}}(z) = \\frac{2}{\\pi} \\int_{0}^{\\pi} d\\theta \\left( \\frac{\\cos\\theta}{D} + \\frac{z}{D^2} + \\frac{1 - z^2/D^2}{z - D\\cos\\theta} \\right) $$\n逐项积分：\n$$ \\int_0^\\pi \\frac{\\cos\\theta}{D} d\\theta = \\frac{1}{D}[\\sin\\theta]_0^\\pi = 0 $$\n$$ \\int_0^\\pi \\frac{z}{D^2} d\\theta = \\frac{z\\pi}{D^2} $$\n$$ \\int_0^\\pi \\frac{d\\theta}{z - D\\cos\\theta} = \\frac{\\pi}{\\sqrt{z^2-D^2}} \\quad (\\text{标准积分结果})$$\n将各项结果组合：\n$$ G_{\\mathrm{loc}}(z) = \\frac{2}{\\pi} \\left( 0 + \\frac{z\\pi}{D^2} + (1 - z^2/D^2)\\frac{\\pi}{\\sqrt{z^2-D^2}} \\right) $$\n$$ G_{\\mathrm{loc}}(z) = \\frac{2z}{D^2} + \\frac{2(D^2-z^2)}{D^2\\sqrt{z^2-D^2}} = \\frac{2z}{D^2} - \\frac{2\\sqrt{z^2-D^2}}{D^2} $$\n这简化为闭合形式表达式：\n$$ G_{\\mathrm{loc}}(z) = \\frac{2}{D^2}\\left( z - \\sqrt{z^2 - D^2} \\right) $$\n代入 $z = i\\omega_n + \\mu$ 得到松原频率下的最终表达式：\n$$ G_{\\mathrm{loc}}(i\\omega_n) = \\frac{2}{D^2}\\left(i\\omega_n + \\mu - \\sqrt{(i\\omega_n+\\mu)^2 - D^2}\\right) $$\n其中平方根的分支选择需保证当 $|\\omega_n| \\to \\infty$ 时，$G_{\\mathrm{loc}}(i\\omega_n) \\to 0$。\n\n**第四步：归一化验证**\n\n我们考察高频极限（$|\\omega_n| \\to \\infty$ 或等价地 $|z| \\to \\infty$）。\n$$ G_{\\mathrm{loc}}(z) = \\frac{2}{D^2}\\left( z - z\\sqrt{1-\\frac{D^2}{z^2}} \\right) $$\n对平方根项进行泰勒展开 $\\sqrt{1-x} \\approx 1 - \\frac{1}{2}x$：\n$$ G_{\\mathrm{loc}}(z) \\approx \\frac{2}{D^2}\\left( z - z\\left(1 - \\frac{D^2}{2z^2}\\right) \\right) = \\frac{2}{D^2}\\left( z - z + \\frac{D^2}{2z} \\right) = \\frac{1}{z} $$\n这表明 $G_{\\mathrm{loc}}(i\\omega_n) \\approx \\frac{1}{i\\omega_n+\\mu} \\approx \\frac{1}{i\\omega_n} + \\mathcal{O}\\!\\left(\\frac{1}{\\omega_{n}^{2}}\\right)$。领头高频系数是 $c=1$，这与归一化的态密度 $\\int \\rho(\\epsilon)d\\epsilon = 1$ 相符，从而验证了我们的计算。",
            "answer": "$$\\boxed{\\frac{2}{D^{2}}\\left(i\\omega_{n} + \\mu - \\sqrt{(i\\omega_{n}+\\mu)^{2} - D^{2}}\\right)}$$"
        },
        {
            "introduction": "尽管解析解能提供深刻的物理洞见，但实际的DMFT计算本质上是数值的。这项实践将带你进入计算领域，任务是为具有高斯态密度的超立方格点实现DMFT自洽循环中的一个关键步骤。你将学习使用数值积分来计算局域格林函数，这是一种稳健的技术，对于求解任意格点类型和自能下的DMFT方程至关重要。",
            "id": "3752261",
            "problem": "您的任务是严格推导并数值实现超立方晶格在无穷空间维度极限下的动力学平均场理论 (DMFT) 自洽更新，并在虚构频率轴上进行求值。请从以下基本要素开始：\n\n1. 动力学平均场理论 (DMFT) 中局域格林函数的定义，即无相互作用晶格态密度的 Hilbert 变换。\n2. 连接相互作用局域格林函数、自能和 Weiss 场（也称为无相互作用杂质格林函数）的 Dyson 方程。\n3. 对于具有标度化最近邻跃迁的超立方晶格，当维度增加时，其方差保持有限，此时无相互作用态密度是高斯型的。设标度跃迁振幅为 $t^{\\ast}$，态密度为 $\\rho(\\epsilon)$，它在实轴上归一化为1，且其方差由 $t^{\\ast}$ 设定。\n\n您的任务是：\n\na) 从上述基本要素出发，推导局域格林函数 $G_{\\mathrm{loc}}(i\\omega_{n})$ 作为对无相互作用态密度的 Hilbert 变换的表达式，并在费米子 Matsubara 频率 $i\\omega_{n}$（其中 $\\omega_{n}=(2n+1)\\pi/\\beta$，$\\beta$ 是逆温度）上求值。您必须在虚构频率轴上进行计算，并使用化学势 $\\mu$ 和给定的自能 $\\Sigma(i\\omega_{n})$。\n\nb) 从应用于 DMFT 的 Dyson 方程出发，推导 Weiss 场更新 $\\mathcal{G}_{0}^{-1}(i\\omega_{n})$，用 $\\Sigma(i\\omega_{n})$ 和 $G_{\\mathrm{loc}}(i\\omega_{n})$ 表示。\n\nc) 实现一个数值稳定的求积方案，该方案专为适用于无穷维超立方晶格的高斯态密度而设计，并且不以简单的方式截断无限积分限。使用适合高斯权重的变量代换和能够精确积分以高斯函数为权重函数的多项式的求积法则，来近似定义 $G_{\\mathrm{loc}}(i\\omega_{n})$ 的 Hilbert 变换。\n\nd) 使用您的推导和实现，计算下述每个测试用例在最低费米子 Matsubara 频率（$n=0$）下的 Weiss 场 $\\mathcal{G}_{0}^{-1}(i\\omega_{n})$。对于每个案例，返回 $\\mathcal{G}_{0}^{-1}(i\\omega_{0})$ 的实部和虚部（以无量纲单位表示），结果为浮点数。\n\n您必须遵循以下模型和参数化：\n\n- 无穷维超立方晶格的高斯型无相互作用态密度形式为 $\\rho(\\epsilon)=\\frac{1}{t^{\\ast}\\sqrt{\\pi}}\\exp\\left[-\\left(\\frac{\\epsilon}{t^{\\ast}}\\right)^{2}\\right]$，归一化使得 $\\int_{-\\infty}^{\\infty}\\rho(\\epsilon)\\,d\\epsilon=1$。\n- 费米子 Matsubara 频率为 $i\\omega_{n}$，其中 $\\omega_{n}=(2n+1)\\pi/\\beta$。\n- 用于测试套件的复数自能模型为：\n  1. 零自能：$\\Sigma(i\\omega_{n})=0$。\n  2. 纯虚常数散射率：$\\Sigma(i\\omega_{n})=i\\Gamma$，其中 $\\Gamma0$。\n  3. 频率依赖的有理模型：$\\Sigma(i\\omega_{n})=\\frac{U^{2}}{i\\omega_{n}+a}$，其中实数 $U0$ 且 $a0$。\n- 化学势 $\\mu$ 是实数。\n\n数值要求：\n\n- 通过将能量积分映射到一个关于无量纲变量的高斯权重积分，并使用能够积分以 $e^{-x^{2}}$ 为权重函数的目标函数的合适高斯求积法则，来实现高斯权重求积。不要对 $\\epsilon$ 使用有限截断；使用与高斯权重匹配的无限范围求积。\n- 为保证数值精度，至少使用 $N=100$ 个求积节点；更高的 $N$ 是可接受的。\n- 在每个测试中仅计算最低 Matsubara 频率 $n=0$ 的情况。\n\n测试套件（四个案例）：\n\n- 案例 A（无相互作用基线）：$\\beta=10$, $\\mu=0.0$, $t^{\\ast}=1.0$, $\\Sigma(i\\omega_{n})=0$。\n- 案例 B（有限散射）：$\\beta=10$, $\\mu=0.0$, $t^{\\ast}=1.0$, $\\Sigma(i\\omega_{n})=i\\Gamma$，其中 $\\Gamma=0.5$。\n- 案例 C（化学势偏移）：$\\beta=10$, $\\mu=2.0$, $t^{\\ast}=1.0$, $\\Sigma(i\\omega_{n})=0$。\n- 案例 D（低温下频率依赖的自能）：$\\beta=100$, $\\mu=0.0$, $t^{\\ast}=0.5$, $\\Sigma(i\\omega_{n})=\\frac{U^{2}}{i\\omega_{n}+a}$，其中 $U=1.0$ 且 $a=0.5$。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，该列表包含八个浮点数，顺序为：$\\left[\\Re\\mathcal{G}_{0}^{-1}(i\\omega_{0})_{\\text{A}},\\Im\\mathcal{G}_{0}^{-1}(i\\omega_{0})_{\\text{A}},\\Re\\mathcal{G}_{0}^{-1}(i\\omega_{0})_{\\text{B}},\\Im\\mathcal{G}_{0}^{-1}(i\\omega_{0})_{\\text{B}},\\Re\\mathcal{G}_{0}^{-1}(i\\omega_{0})_{\\text{C}},\\Im\\mathcal{G}_{0}^{-1}(i\\omega_{0})_{\\text{C}},\\Re\\mathcal{G}_{0}^{-1}(i\\omega_{0})_{\\text{D}},\\Im\\mathcal{G}_{0}^{-1}(i\\omega_{0})_{\\text{D}}\\right]$。",
            "solution": "本解答分为三个阶段：首先，解析推导所需表达式；其次，设计数值积分方案；最后，将这些应用于指定的测试用例。\n\n### a) 局域格林函数 $G_{\\mathrm{loc}}(i\\omega_{n})$ 的推导\n\n在DMFT中，相互作用局域格林函数 $G_{\\mathrm{loc}}(z)$ 是通过对无相互作用态密度 (DOS) $\\rho(\\epsilon)$ 进行积分得到的。晶格格林函数由晶格戴森方程给出，其中自能 $\\Sigma(z)$ 被假定为纯局域的（与动量无关）：\n$$ G_{\\mathrm{lattice}}(\\epsilon, z) = \\frac{1}{z - (\\epsilon - \\mu) - \\Sigma(z)} = \\frac{1}{z + \\mu - \\Sigma(z) - \\epsilon} $$\n此处，$\\mu$ 是化学势。在虚（松原）频率轴上（$z=i\\omega_n$，其中对于费米子 $\\omega_{n}=(2n+1)\\pi/\\beta$）对此式求值，并对 DOS 进行积分，得到局域格林函数：\n$$ G_{\\mathrm{loc}}(i\\omega_{n}) = \\int_{-\\infty}^{\\infty} d\\epsilon \\, \\rho(\\epsilon) G_{\\mathrm{lattice}}(\\epsilon, i\\omega_n) $$\n代入 $G_{\\mathrm{lattice}}$ 的表达式，得到所需的希尔伯特变换：\n$$ G_{\\mathrm{loc}}(i\\omega_{n}) = \\int_{-\\infty}^{\\infty}d\\epsilon \\, \\frac{\\rho(\\epsilon)}{i\\omega_{n} + \\mu - \\Sigma(i\\omega_{n}) - \\epsilon} $$\n该表达式构成了DMFT自洽循环的核心，它将给定的自能 $\\Sigma(i\\omega_n)$ 与由此产生的局域格林函数联系起来。\n\n### b) 魏斯场更新 $\\mathcal{G}_{0}^{-1}(i\\omega_{n})$ 的推导\n\nDMFT将原始晶格问题映射到一个有效的量子杂质问题上，该问题能自洽地再现晶格的局域物理性质。该杂质问题的核心量是其相互作用格林函数（与晶格的 $G_{\\mathrm{loc}}(i\\omega_n)$ 相同）、其自能 $\\Sigma(i\\omega_n)$，以及其无相互作用格林函数，即所谓的魏斯场 $\\mathcal{G}_{0}(i\\omega_{n})$。这些量通过杂质戴森方程相互关联：\n$$ G_{\\mathrm{loc}}(i\\omega_{n})^{-1} = \\mathcal{G}_{0}(i\\omega_{n})^{-1} - \\Sigma(i\\omega_{n}) $$\nDMFT自洽循环涉及根据当前对晶格量的估计来更新魏斯场。为了推导魏斯场的更新公式，我们只需重新整理杂质戴森方程：\n$$ \\mathcal{G}_{0}^{-1}(i\\omega_{n}) = G_{\\mathrm{loc}}(i\\omega_{n})^{-1} + \\Sigma(i\\omega_{n}) $$\n在DMFT循环的一次迭代中，首先会使用 (a) 部分的表达式和当前的 $\\Sigma(i\\omega_{n})$ 计算 $G_{\\mathrm{loc}}(i\\omega_{n})$，然后使用上述方程求出新的 $\\mathcal{G}_{0}^{-1}(i\\omega_{n})$。这个新的魏斯场随后将被用作杂质求解器的输入，以生成新的自能，并重复此循环直至收敛。\n\n### c) 数值求积方案\n\n任务是使用指定的高斯型DOS $\\rho(\\epsilon)=\\frac{1}{t^{\\ast}\\sqrt{\\pi}}\\exp\\left[-\\left(\\frac{\\epsilon}{t^{\\ast}}\\right)^{2}\\right]$ 计算 $G_{\\mathrm{loc}}(i\\omega_{n})$ 的积分。\n$$ G_{\\mathrm{loc}}(i\\omega_{n}) = \\int_{-\\infty}^{\\infty} \\frac{1}{t^{\\ast}\\sqrt{\\pi}}e^{-(\\epsilon/t^{\\ast})^2} \\frac{1}{i\\omega_{n} + \\mu - \\Sigma(i\\omega_{n}) - \\epsilon} d\\epsilon $$\n让我们定义复有效频率 $\\tilde{z}_n = i\\omega_{n} + \\mu - \\Sigma(i\\omega_{n})$。积分变为：\n$$ G_{\\mathrm{loc}}(i\\omega_{n}) = \\frac{1}{t^{\\ast}\\sqrt{\\pi}} \\int_{-\\infty}^{\\infty} e^{-(\\epsilon/t^{\\ast})^2} \\frac{1}{\\tilde{z}_n - \\epsilon} d\\epsilon $$\n为了利用为高斯权重定制的求积法则，我们进行变量代换，$x = \\epsilon/t^{\\ast}$，因此 $d\\epsilon = t^{\\ast}dx$。积分限仍为 $(-\\infty, \\infty)$。\n$$ G_{\\mathrm{loc}}(i\\omega_{n}) = \\frac{1}{t^{\\ast}\\sqrt{\\pi}} \\int_{-\\infty}^{\\infty} e^{-x^2} \\frac{1}{\\tilde{z}_n - t^{\\ast}x} (t^{\\ast}dx) $$\n$$ G_{\\mathrm{loc}}(i\\omega_{n}) = \\frac{1}{\\sqrt{\\pi}} \\int_{-\\infty}^{\\infty} e^{-x^2} \\frac{1}{\\tilde{z}_n - t^{\\ast}x} dx $$\n该积分的形式为 $\\int_{-\\infty}^{\\infty} e^{-x^2} f(x) dx$，非常适合使用高斯-埃尔米特求积法。此方法将积分近似为在 $N$ 个特定点（节点）上的加权和，并且当被积函数 $f(x)$ 是一个次数最高为 $2N-1$ 的多项式时，该方法是精确的。求积法则为：\n$$ \\int_{-\\infty}^{\\infty} e^{-x^2} f(x) dx \\approx \\sum_{k=1}^{N} w_k f(x_k) $$\n其中 $x_k$ 是 $N$ 阶埃尔米特多项式 $H_N(x)$ 的根，$w_k$ 是相应的权重。将此应用于我们的积分，我们得到 $G_{\\mathrm{loc}}(i\\omega_{n})$ 的数值近似：\n$$ G_{\\mathrm{loc}}(i\\omega_{n}) \\approx \\frac{1}{\\sqrt{\\pi}} \\sum_{k=1}^{N} \\frac{w_k}{\\tilde{z}_n - t^{\\ast}x_k} $$\n该方案避免了截断无限积分范围，并能在节点数 $N$ 足够大时为光滑的被积函数提供高精度。问题指定 $N \\geq 100$；为了保证稳健的精度，将使用 $N=200$。\n\n### d) 测试用例的实现\n\n最后一步是结合推导出的表达式和数值方案，为四个测试用例中的每一个计算最低松原频率（$n=0$）下的 $\\mathcal{G}_{0}^{-1}(i\\omega_{0})$。每个案例的步骤如下：\n1.  按规定设置参数 $\\beta$、$\\mu$ 和 $t^{\\ast}$。\n2.  计算最低松原频率 $i\\omega_0 = i\\pi/\\beta$。\n3.  根据案例指定的模型（零、常数或有理模型）计算自能 $\\Sigma(i\\omega_0)$。\n4.  计算复有效频率 $\\tilde{z}_0 = i\\omega_0 + \\mu - \\Sigma(i\\omega_0)$。\n5.  获取 $N=200$ 的高斯-埃尔米特节点 $x_k$ 和权重 $w_k$。\n6.  使用 (c) 部分推导的求积和计算 $G_{\\mathrm{loc}}(i\\omega_0)$。\n7.  最后，使用 (b) 部分的公式 $\\mathcal{G}_{0}^{-1}(i\\omega_0) = G_{\\mathrm{loc}}(i\\omega_0)^{-1} + \\Sigma(i\\omega_0)$ 计算目标量 $\\mathcal{G}_{0}^{-1}(i\\omega_0)$。\n8.  这个复数的实部和虚部就是该案例的最终结果。\n\n在代码中实现的这一过程直接解决了问题陈述。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the DMFT Weiss field update for a hypercubic lattice in d - infinity.\n    This involves evaluating the Hilbert transform of a Gaussian DOS using\n    Gauss-Hermite quadrature and applying the DMFT Dyson equation.\n    \"\"\"\n\n    def calculate_G_loc(z_tilde, t_star, N_quad=200):\n        \"\"\"\n        Calculates the local Green's function G_loc(i*omega_n) using Gauss-Hermite quadrature.\n\n        Args:\n            z_tilde (complex): The complex effective frequency i*omega_n + mu - Sigma(i*omega_n).\n            t_star (float): The scaled hopping amplitude.\n            N_quad (int): The number of quadrature nodes.\n\n        Returns:\n            complex: The value of the local Green's function G_loc.\n        \"\"\"\n        # Get Gauss-Hermite quadrature points (x_k) and weights (w_k).\n        # These are used to approximate integrals of the form integral(e^(-x^2) * f(x)) dx from -inf to inf.\n        x_k, w_k = np.polynomial.hermite.hermgauss(N_quad)\n        \n        # The function to be integrated (without the e^(-x^2) weight) is 1 / (z_tilde - t_star * x).\n        # We evaluate this at the quadrature nodes x_k.\n        integrand_values = 1.0 / (z_tilde - t_star * np.array(x_k))\n        \n        # Perform the quadrature sum: sum(w_k * f(x_k))\n        integral_sum = np.sum(w_k * integrand_values)\n        \n        # The full expression for G_loc has a prefactor of 1/sqrt(pi).\n        # G_loc = (1/sqrt(pi)) * integral(e^(-x^2) * [1 / (z_tilde - t_star * x)] dx)\n        g_loc = (1.0 / np.sqrt(np.pi)) * integral_sum\n        \n        return g_loc\n\n    # Define the test cases from the problem statement.\n    # Format: (beta, mu, t_star, sigma_type, sigma_params_dict)\n    test_cases = [\n        # Case A: Noninteracting baseline\n        (10.0, 0.0, 1.0, \"zero\", {}),\n        # Case B: Finite scattering\n        (10.0, 0.0, 1.0, \"const\", {\"Gamma\": 0.5}),\n        # Case C: Chemical potential shift\n        (10.0, 2.0, 1.0, \"zero\", {}),\n        # Case D: Low temperature with frequency-dependent self-energy\n        (100.0, 0.0, 0.5, \"rational\", {\"U\": 1.0, \"a\": 0.5}),\n    ]\n\n    results = []\n    for case in test_cases:\n        beta, mu, t_star, sigma_type, sigma_params = case\n        \n        # 1. Calculate the lowest fermionic Matsubara frequency (n=0)\n        omega_0 = np.pi / beta\n        i_omega_0 = 1j * omega_0\n        \n        # 2. Calculate the self-energy Sigma(i*omega_0) for the current case\n        self_energy = 0.0 + 0.0j\n        if sigma_type == \"const\":\n            self_energy = 1j * sigma_params[\"Gamma\"]\n        elif sigma_type == \"rational\":\n            U = sigma_params[\"U\"]\n            a = sigma_params[\"a\"]\n            self_energy = U**2 / (i_omega_0 + a)\n        \n        # 3. Compute the effective frequency z_tilde = i*omega_0 + mu - Sigma\n        z_tilde = i_omega_0 + mu - self_energy\n        \n        # 4. Calculate the local Green's function G_loc using the quadrature scheme\n        G_loc_val = calculate_G_loc(z_tilde, t_star, N_quad=200)\n        \n        # 5. Compute the Weiss field G_0^-1 using the DMFT Dyson equation\n        G0_inv = 1.0 / G_loc_val + self_energy\n        \n        # 6. Store the real and imaginary parts of the result\n        results.append(G0_inv.real)\n        results.append(G0_inv.imag)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{x:.10f}' for x in results)}]\")\n\nsolve()\n```"
        }
    ]
}