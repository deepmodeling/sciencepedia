{
    "hands_on_practices": [
        {
            "introduction": "主动物质研究的一个核心任务是从单个粒子的微观运动规则推导出宏观的集体行为和输运性质。本练习将引导你完成一个经典推导：计算“运动-翻滚粒子”（Run-and-Tumble Particle, RTP）的均方位移（Mean-Squared Displacement, MSD）。通过这个实践，你将亲手揭示主动粒子如何从短时间内的弹道式运动（ballistic motion）过渡到长时间下的扩散行为（diffusive behavior），并最终得到决定其宏观迁移能力的关键参数——有效扩散系数 $D_{\\mathrm{eff}}$。",
            "id": "3780854",
            "problem": "考虑一个二维“运动-翻滚”粒子（RTP），它被定义为一个点状活性粒子，沿着一个随时间分段恒定的方向单位矢量 $\\mathbf{e}(t)$ 以恒定速率 $v_0$ 运动，并在速率为 $\\alpha0$ 的齐次泊松过程的事件点上发生瞬时、无记忆、各向同性的重新定向（“翻滚”）。假设没有被动平移噪声，系统是稳态且各向同性的，粒子从原点 $\\mathbf{r}(0)=\\mathbf{0}$ 开始运动，其初始方向 $\\mathbf{e}(0)$ 从单位圆上均匀随机抽取，并且翻滚将方向重置为一个独立的、在二维空间中均匀分布的方向。\n\n从第一性原理出发——即位移是速度的时间积分的定义、泊松过程和各向同性的性质，以及均方位移和速度自相关之间的关系——推导对于所有 $t\\ge 0$ 的精确的、随时间变化的均方位移 $\\langle|\\Delta\\mathbf{r}(t)|^2\\rangle$。然后，通过将均方位移的线性增长与适用于二维的形式进行匹配，确定有效长时扩散系数 $D_{\\mathrm{eff}}$。请以 $\\langle|\\Delta\\mathbf{r}(t)|^2\\rangle$ 和 $D_{\\mathrm{eff}}$ 的闭式解析表达式的形式给出您的最终答案。无需进行数值计算或四舍五入。",
            "solution": "将首先根据指定标准验证问题陈述。\n\n### 步骤1：提取已知条件\n- 一个二维“运动-翻滚”粒子（RTP）。\n- 粒子以恒定速率 $v_0$ 运动。\n- 方向单位矢量 $\\mathbf{e}(t)$ 是分段恒定的。\n- 翻滚是瞬时、无记忆、各向同性的重新定向。\n- 翻滚作为速率为 $\\alpha  0$ 的齐次泊松过程发生。\n- 无被动平移噪声。\n- 系统是稳态且各向同性的。\n- 粒子从原点开始：$\\mathbf{r}(0) = \\mathbf{0}$。\n- 初始方向 $\\mathbf{e}(0)$ 从单位圆上均匀随机抽取。\n- 翻滚将方向重置为一个独立的、均匀分布的方向。\n- 任务是推导对于所有 $t \\ge 0$ 的精确的、随时间变化的均方位移（MSD）$\\langle|\\Delta\\mathbf{r}(t)|^2\\rangle$。\n- 任务是确定有效长时扩散系数 $D_{\\mathrm{eff}}$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：**“运动-翻滚”粒子（RTP）是活性物质领域的一个典型模型，用于描述诸如大肠杆菌等各种微生物的运动。该模型基于随机过程（泊松过程）和统计力学的既定原理。该问题在科学上是合理的。\n- **适定性：** 所有必要的参数（$v_0$, $\\alpha$）、初始条件（$\\mathbf{r}(0)=\\mathbf{0}$）以及方向动力学的统计特性（各向同性翻滚、均匀初始分布）都已提供。问题要求求解具体、明确定义的物理量（MSD和有效扩散系数），预计存在唯一解。\n- **客观性：** 问题使用理论物理学中常见的精确技术语言进行表述。它没有主观或含糊不清的陈述。\n- **完整性与一致性：** 问题是自洽的。所提供的信息对于推导所求量是充分且一致的。平稳性假设与初始方向从更新过程的平稳分布（圆上均匀分布）中抽取的设定是一致的。\n\n### 步骤3：结论与行动\n该问题是有效的，因为它具有科学依据、适定、客观且自洽。现在开始推导解。\n\n在时间 $t$ 时粒子的位移由 $\\Delta\\mathbf{r}(t) = \\mathbf{r}(t) - \\mathbf{r}(0)$ 给出。在初始条件 $\\mathbf{r}(0)=\\mathbf{0}$ 下，位移就是 $\\mathbf{r}(t)$。粒子的速度是 $\\mathbf{v}(t) = v_0 \\mathbf{e}(t)$，其中 $v_0$ 是恒定速率，$\\mathbf{e}(t)$ 是随时间变化的方向单位矢量。位置是速度的时间积分：\n$$\n\\mathbf{r}(t) = \\int_0^t \\mathbf{v}(t') dt' = v_0 \\int_0^t \\mathbf{e}(t') dt'\n$$\n均方位移（MSD）是位移矢量模的平方的系综平均：\n$$\n\\langle|\\Delta\\mathbf{r}(t)|^2\\rangle = \\langle |\\mathbf{r}(t)|^2 \\rangle = \\langle \\mathbf{r}(t) \\cdot \\mathbf{r}(t) \\rangle\n$$\n代入 $\\mathbf{r}(t)$ 的表达式：\n$$\n\\langle|\\mathbf{r}(t)|^2\\rangle = \\left\\langle \\left( v_0 \\int_0^t \\mathbf{e}(t') dt' \\right) \\cdot \\left( v_0 \\int_0^t \\mathbf{e}(t'') dt'' \\right) \\right\\rangle\n$$\n根据期望算子的线性性质，我们可以将平均运算移到积分内部：\n$$\n\\langle|\\mathbf{r}(t)|^2\\rangle = v_0^2 \\int_0^t dt' \\int_0^t dt'' \\langle \\mathbf{e}(t') \\cdot \\mathbf{e}(t'') \\rangle\n$$\n项 $\\langle \\mathbf{e}(t') \\cdot \\mathbf{e}(t'') \\rangle$ 是方向自相关函数。由于底层的随机过程（翻滚的齐次泊松过程）在时间上是稳态的，该相关函数仅依赖于时间差 $\\tau = |t' - t''|$。我们来计算 $C(\\tau) = \\langle \\mathbf{e}(0) \\cdot \\mathbf{e}(\\tau) \\rangle$。\n\n当且仅当在时间间隔 $[0, \\tau]$ 内没有发生翻滚时，方向 $\\mathbf{e}(\\tau)$ 才与 $\\mathbf{e}(0)$ 相同。此时间间隔内的翻滚次数服从均值为 $\\alpha\\tau$ 的泊松分布。零次翻滚的概率是 $P(0, \\tau) = \\exp(-\\alpha\\tau)$。\n如果发生一次或多次翻滚，由于新方向是各向同性地且独立于前一个方向选择的，因此初始方向的记忆会丢失。我们将翻滚后的新方向表示为 $\\mathbf{e}_{\\text{new}}$。由于各向同性，它与任何固定矢量（例如 $\\mathbf{e}(0)$）的点积的平均值为零：$\\langle \\mathbf{e}(0) \\cdot \\mathbf{e}_{\\text{new}} \\rangle = 0$。\n\n因此，我们可以通过对 $[0, \\tau]$ 内的翻滚次数进行条件化来表示相关函数：\n$$\n\\langle \\mathbf{e}(0) \\cdot \\mathbf{e}(\\tau) \\rangle = \\langle \\mathbf{e}(0) \\cdot \\mathbf{e}(\\tau) | \\text{无翻滚} \\rangle P(\\text{无翻滚}) + \\langle \\mathbf{e}(0) \\cdot \\mathbf{e}(\\tau) | \\text{至少一次翻滚} \\rangle P(\\text{至少一次翻滚})\n$$\n如果没有翻滚，$\\mathbf{e}(\\tau) = \\mathbf{e}(0)$，所以 $\\mathbf{e}(0) \\cdot \\mathbf{e}(\\tau) = |\\mathbf{e}(0)|^2 = 1$。发生这种情况的概率是 $\\exp(-\\alpha\\tau)$。\n如果至少有一次翻滚，时间 $\\tau$ 时的方向与 $\\mathbf{e}(0)$ 无关，因此点积的期望值为 $0$。\n因此，方向自相关函数为：\n$$\nC(\\tau) = \\langle \\mathbf{e}(0) \\cdot \\mathbf{e}(\\tau) \\rangle = (1) \\cdot \\exp(-\\alpha\\tau) + (0) \\cdot (1 - \\exp(-\\alpha\\tau)) = \\exp(-\\alpha\\tau)\n$$\n所以，$\\langle \\mathbf{e}(t') \\cdot \\mathbf{e}(t'') \\rangle = \\exp(-\\alpha|t' - t''|)$。\n\n现在我们回到MSD积分：\n$$\n\\langle|\\mathbf{r}(t)|^2\\rangle = v_0^2 \\int_0^t dt' \\int_0^t dt'' \\exp(-\\alpha|t' - t''|)\n$$\n我们可以将积分的方形区域 $t', t'' \\in [0, t]$ 分成两个三角形：一个区域是 $t'  t''$，另一个区域是 $t''  t'$。根据对称性，这两个区域上的积分是相等的。\n$$\n\\langle|\\mathbf{r}(t)|^2\\rangle = 2 v_0^2 \\int_0^t dt' \\int_0^{t'} dt'' \\exp(-\\alpha(t' - t''))\n$$\n首先，我们计算关于 $t''$ 的内层积分：\n$$\n\\int_0^{t'} \\exp(-\\alpha(t' - t'')) dt'' = \\exp(-\\alpha t') \\int_0^{t'} \\exp(\\alpha t'') dt'' = \\exp(-\\alpha t') \\left[ \\frac{1}{\\alpha} \\exp(\\alpha t'') \\right]_0^{t'}\n$$\n$$\n= \\frac{\\exp(-\\alpha t')}{\\alpha} (\\exp(\\alpha t') - \\exp(0)) = \\frac{1}{\\alpha}(1 - \\exp(-\\alpha t'))\n$$\n接下来，我们计算关于 $t'$ 的外层积分：\n$$\n\\langle|\\mathbf{r}(t)|^2\\rangle = 2 v_0^2 \\int_0^t \\frac{1}{\\alpha}(1 - \\exp(-\\alpha t')) dt' = \\frac{2v_0^2}{\\alpha} \\int_0^t (1 - \\exp(-\\alpha t')) dt'\n$$\n$$\n= \\frac{2v_0^2}{\\alpha} \\left[ t' - \\left(-\\frac{1}{\\alpha}\\right)\\exp(-\\alpha t') \\right]_0^t = \\frac{2v_0^2}{\\alpha} \\left[ t' + \\frac{1}{\\alpha}\\exp(-\\alpha t') \\right]_0^t\n$$\n$$\n= \\frac{2v_0^2}{\\alpha} \\left( \\left(t + \\frac{1}{\\alpha}\\exp(-\\alpha t)\\right) - \\left(0 + \\frac{1}{\\alpha}\\exp(0)\\right) \\right) = \\frac{2v_0^2}{\\alpha} \\left( t + \\frac{1}{\\alpha}(\\exp(-\\alpha t) - 1) \\right)\n$$\n整理后得到MSD的最终表达式：\n$$\n\\langle|\\Delta\\mathbf{r}(t)|^2\\rangle = \\frac{2v_0^2}{\\alpha^2}(\\alpha t - 1 + \\exp(-\\alpha t))\n$$\n为了求得有效长时扩散系数 $D_{\\mathrm{eff}}$，我们考察当 $t \\to \\infty$ 时MSD的行为。在此极限下，$\\exp(-\\alpha t)$ 项消失：\n$$\n\\langle|\\Delta\\mathbf{r}(t)|^2\\rangle \\sim \\frac{2v_0^2}{\\alpha^2}(\\alpha t - 1) = \\frac{2v_0^2}{\\alpha}t - \\frac{2v_0^2}{\\alpha^2} \\quad \\text{当 } t \\to \\infty \\text{ 时}\n$$\n长时行为与 $t$呈线性关系，这是扩散运动的特征。对于 $d$ 维空间中的扩散，MSD的形式为 $\\langle|\\Delta\\mathbf{r}(t)|^2\\rangle \\sim 2d D_{\\mathrm{eff}} t$。在我们的例子中，维度是 $d=2$。因此，我们将主导项与 $4D_{\\mathrm{eff}}t$ 进行匹配：\n$$\n4 D_{\\mathrm{eff}} t = \\frac{2v_0^2}{\\alpha} t\n$$\n求解 $D_{\\mathrm{eff}}$ 可得：\n$$\nD_{\\mathrm{eff}} = \\frac{2v_0^2}{4\\alpha} = \\frac{v_0^2}{2\\alpha}\n$$\n两个所求的量都已从第一性原理推导得出。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2v_0^2}{\\alpha^2} (\\alpha t - 1 + \\exp(-\\alpha t))  \\frac{v_0^2}{2\\alpha} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "除了RTP模型，主动奥恩斯坦-乌伦贝克粒子（Active Ornstein-Uhlenbeck Particle, AOUP）是研究活性物质的另一个核心模型。由于其数学上的复杂性，我们常常采用近似方法来简化分析，其中统一色噪声近似（Unified Colored Noise Approximation, UCNA）是一种强有力的工具。这个练习不仅仅是应用一个近似，更关键的是通过理论推导和编程实践，去探索其有效性的边界，特别是在生物和物理系统中常见的非凸势（non-convex potentials）中，理解近似方法为何以及何时会失效。",
            "id": "3780830",
            "problem": "考虑一个一维的活性 Ornstein–Uhlenbeck 粒子 (AOUPs) 群体，其位形坐标 $x(t)$ 遵循过阻尼动力学方程 $ \\dot{x}(t) = -\\mu \\, U'(x(t)) + \\eta(t)$，其中 $U(x)$ 是一个确定性势，$\\mu$ 是迁移率，$\\eta(t)$ 是一个相关时间为 $\\tau$、强度为 $D$ 的 Ornstein–Uhlenbeck 色噪声，由随机微分方程 $\\tau \\, \\dot{\\eta}(t) = -\\eta(t) + \\sqrt{2D} \\, \\xi(t)$ 定义，其中 $\\xi(t)$ 是零均值、delta 相关的 高斯白噪声。统一色噪声近似 (UCNA) 旨在通过绝热消除快色噪声并将动力学映射到乘性噪声形式，来寻求一种基于变换后的漂移和扩散的有效描述。在一维情况下，UCNA 引入了用于变量替换的雅可比行列式，以及有效漂移中依赖于势的二阶导数的曲率驱动修正。在非凸势或多稳态势中，这些修正可能导致破坏条件，其标志为雅可比行列式的符号以及有效漂移中的奇点。\n\n从上述 AOUP 方程和定义出发，推导出一维 UCNA 中有效漂移和雅可比行列式关于势曲率的表达式。解释为什么非凸区域（其中 $U''(x)  0$）会使该近似失效，并确定标志着近似破坏的精确数学条件。然后，实现一个程序，通过在指定域上评估雅可比行列式 $J(x)$ 和有效漂移中的曲率修正，来检验 UCNA 在几种不同势函数下的破坏情况。\n\n所有量均为无量纲；角度必须以弧度处理。\n\n您的程序必须：\n- 使用推导的一维 UCNA 表达式，在指定域上的一个包含 $N=10001$ 个点的均匀网格上，为每个测试用例计算以下内容：\n    1. 一个布尔有效性标志，指示雅可比行列式是否在整个域上严格为正，即 $\\min_{x} J(x)  0$ 是否成立。\n    2. 雅可比行列式的最小值，即 $\\min_{x} J(x)$。\n    3. $J(x) \\le 0$ 成立的网格点的整数数量。\n    4. 最大绝对曲率修正量 $\\max_{x} |\\kappa(x)|$，其中 $\\kappa(x)$ 是您推导中定义的曲率修正参数。\n    5. 有效漂移乘子与 1 的最大绝对偏差，计算公式为 $\\max_{x: J(x)  0} \\left| m(x) - 1 \\right|$，其中 $m(x)$ 是您推导的有效漂移中的乘性修正因子。此量必须仅在 $J(x)  0$ 的点上计算。\n- 将所有测试用例的结果汇总到单行输出中，该输出包含一个列表的列表，格式完全如下：$[[\\text{valid}_1,\\min J_1,\\text{count}_1,\\max|\\kappa|_1,\\max|m-1|_1],\\ldots]$，其中每个内部列表按下面提供的顺序对应一个测试用例。\n\n测试套件（角度以弧度为单位，所有参数均为无量纲）：\n- 案例 1 (凸势参考): $U(x) = \\frac{k}{2} x^2$，参数 $k = 1$，域 $x \\in [-5,5]$，$\\mu = 1$，$\\tau = 0.1$。\n- 案例 2 (双阱边界): $U(x) = \\frac{a}{4} x^4 - \\frac{b}{2} x^2$，参数 $a = 1$，$b = 2$，域 $x \\in [-2,2]$，$\\mu = 1$，$\\tau = 0.5$。\n- 案例 3 (双阱破坏): $U(x) = \\frac{a}{4} x^4 - \\frac{b}{2} x^2$，参数 $a = 1$，$b = 2$，域 $x \\in [-2,2]$，$\\mu = 1$，$\\tau = 0.8$。\n- 案例 4 (周期性凸区间): $U(x) = V_0 \\left(1 - \\cos(q x)\\right)$，参数 $V_0 = 1$，$q = 2$，域 $x \\in [-\\pi,\\pi]$，$\\mu = 1$，$\\tau = 0.2$。\n- 案例 5 (周期性破坏区间): $U(x) = V_0 \\left(1 - \\cos(q x)\\right)$，参数 $V_0 = 1$，$q = 2$，域 $x \\in [-\\pi,\\pi]$，$\\mu = 1$，$\\tau = 0.6$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，如下所示：$[[\\text{valid}_1,\\min J_1,\\text{count}_1,\\max|\\kappa|_1,\\max|m-1|_1],[\\text{valid}_2,\\min J_2,\\text{count}_2,\\max|\\kappa|_2,\\max|m-1|_2],\\ldots]$。",
            "solution": "该问题要求推导一维活性 Ornstein-Uhlenbeck 粒子 (AOUP) 的统一色噪声近似 (UCNA) 表达式，并实现一个程序来分析该近似在几种势函数下的破坏情况。\n\n### 步骤 1：问题验证\n\n**1.1. 提取给定条件**\n\n物理系统是一个一维 AOUP，其位置 $x(t)$ 由以下随机微分方程 (SDEs) 组控制：\n- 位置动力学：$ \\dot{x}(t) = -\\mu \\, U'(x(t)) + \\eta(t) $\n- 活性噪声动力学：$ \\tau \\, \\dot{\\eta}(t) = -\\eta(t) + \\sqrt{2D} \\, \\xi(t) $\n\n参数为：\n- $U(x)$: 一个确定性势。\n- $\\mu$: 一个迁移率常数。\n- $\\eta(t)$: 一个 Ornstein-Uhlenbeck (OU) 色噪声过程。\n- $\\tau$: OU 噪声的相关时间。\n- $D$: OU 噪声的强度。\n- $\\xi(t)$: 一个零均值、delta 相关的高斯白噪声，即 $\\langle \\xi(t) \\rangle = 0$ 和 $\\langle \\xi(t) \\xi(s) \\rangle = \\delta(t-s)$。\n\n数值和编程要求：\n- 网格点：在指定域上有 $N=10001$ 个点。\n- 提供了具有特定势函数 $U(x)$、定义域以及参数 $\\mu, \\tau$ 的测试用例。所有量均为无量纲。\n- 程序必须为每个测试用例计算并输出一个包含五个量的列表的列表：\n    1. 布尔有效性标志：$\\min_{x} J(x)  0$。\n    2. 最小雅可比行列式值：$\\min_{x} J(x)$。\n    3. $J(x) \\le 0$ 的网格点的整数计数。\n    4. 最大绝对曲率修正量：$\\max_{x} |\\kappa(x)|$。\n    5. 有效漂移乘子的最大绝对偏差：$\\max_{x: J(x)  0} |m(x) - 1|$。\n\n**1.2. 使用提取的给定条件进行验证**\n\n- **科学依据：** 该问题描述了活性物质统计物理学中的一个标准模型 (AOUPs)。UCNA 是一个成熟的理论工具，用于近似此类系统的动力学。控制方程和概念植根于随机过程和非平衡统计力学的基本原理。该问题在科学上是合理的。\n- **良构性：** 问题定义清晰。推导是该领域的标准程序，数值任务也指定了所有必需的参数、域和输出格式。存在唯一且有意义的解。\n- **客观性：** 语言精确、技术性强，没有偏见或主观陈述。\n\n**1.3. 结论与行动**\n\n问题是有效的。这是计算统计物理学中一个明确定义的任务，既涉及理论推导，也涉及数值实现。\n\n### 步骤 2：UCNA 表达式和破坏条件的推导\n\n统一色噪声近似 (UCNA) 是一种从随机微分方程组中绝热消除“快”色噪声变量以获得有效的一维 Fokker-Planck 或 Langevin 方程的技术。其出发点是 AOUP 的耦合系统：\n$$\n\\dot{x}(t) = -\\mu U'(x) + \\eta(t) \\quad \\text{(1)}\n$$\n$$\n\\tau \\dot{\\eta}(t) = -\\eta(t) + \\sqrt{2D} \\xi(t) \\quad \\text{(2)}\n$$\n该系统描述了一个粒子在势场力 $F(x) = -\\mu U'(x)$ 和活性力 $\\eta(t)$ 作用下的运动，其中 $\\eta(t)$ 本身是一个具有有限记忆时间 $\\tau$ 的随机过程。\n\nUCNA 提供了一个在 $\\tau$ 很小但不为零时有效的近似描述。在此近似下，$x(t)$ 的动力学可以用一个有效的 Stratonovich Langevin 方程来描述：\n$$\n\\dot{x}(t) = v_{eff}(x) + \\sqrt{2 D_{eff}(x)} \\, \\zeta(t)\n$$\n其中 $\\zeta(t)$ 是一个单位强度的高斯白噪声。有效漂移 $v_{eff}(x)$ 和有效扩散系数 $D_{eff}(x)$ 封装了色噪声的影响。\n\n将 UCNA 应用于系统 (1)-(2) 的标准结果会产生以下有效漂移和扩散的表达式。让我们将方程 (1) 中的漂移项定义为 $f(x) = -\\mu U'(x)$。其导数为 $f'(x) = -\\mu U''(x)$。UCNA 提供的有效漂移为：\n$$\nv_{eff}(x) = \\frac{f(x)}{1 - \\tau f'(x)} = \\frac{-\\mu U'(x)}{1 + \\tau \\mu U''(x)}\n$$\n这里我们直接使用了针对 AOUP 模型的文献中已建立的正确形式。\n\n**雅可比行列式，$J(x)$：**\n该表达式的分母 $J(x)$ 来自 UCNA 推导中使用的坐标变换的雅可比行列式。其表达式为：\n$$\nJ(x) = 1 + \\tau \\mu U''(x)\n$$\n\n**曲率修正参数，$\\kappa(x)$：**\n项 $\\tau \\mu U''(x)$ 引入了对势的局部曲率 $U''(x)$ 的依赖。我们将其定义为曲率修正参数：\n$$\n\\kappa(x) = \\tau \\mu U''(x)\n$$\n根据此定义，雅可比行列式就是 $J(x) = 1 + \\kappa(x)$。\n\n**有效漂移和乘性因子，$m(x)$：**\n有效漂移可以重写以突显对原始漂移的修正：\n$$\nv_{eff}(x) = \\left( \\frac{1}{1 + \\tau \\mu U''(x)} \\right) (-\\mu U'(x)) = m(x) \\cdot (-\\mu U'(x))\n$$\n此处，$m(x)$ 是乘性修正因子：\n$$\nm(x) = \\frac{1}{J(x)} = \\frac{1}{1 + \\tau \\mu U''(x)}\n$$\n\n**UCNA 的破坏：**\nUCNA 是一个基于保持良性行为的坐标变换的近似。如果雅可比行列式 $J(x)$ 变为零或负数，该近似就会破坏。这便是标志着破坏的数学条件：\n$$\nJ(x) \\le 0 \\quad \\Leftrightarrow \\quad 1 + \\tau \\mu U''(x) \\le 0\n$$\n这个条件可以重新排列为 $\\tau \\mu U''(x) \\le -1$。由于 $\\tau$ 和 $\\mu$ 是正常数，这个不等式只有在 $U''(x)$ 为负时才能满足。$U''(x)  0$ 的区域是势的一个**非凸**区域（例如，双阱势中两个阱之间的区域）。\n\n在 $U''(x) \\ge 0$ 的凸区域中，曲率项 $\\kappa(x) = \\tau \\mu U''(x)$ 是非负的，因此雅可比行列式 $J(x) = 1 + \\kappa(x)$ 总是大于或等于 1。在这些区域中，UCNA 总是良定义的。\n\n破坏特别发生在负曲率足够大的非凸区域，即 $U''(x) \\le -1/(\\tau \\mu)$。在 $J(x) \\to 0$ 的点，有效漂移 $v_{eff}(x)$ 和有效扩散系数 $D_{eff}(x) = D\\tau/J(x)^2$ 都会发散。这些奇点标志着绝热消除过程的失败，因为粒子动力学不能再用一个简单的有效势景来描述。\n\n### 步骤 3：数值实现\n\n程序将实现推导出的公式，以分析五个给定测试用例的 UCNA。对于每个案例，我们将：\n1.  定义势函数 $U(x)$ 及其二阶导数 $U''(x)$。\n2.  在指定域上为变量 $x$ 创建一个包含 $N=10001$ 个点的均匀网格。\n3.  在此网格上计算 $U''(x)$。\n4.  计算曲率修正参数 $\\kappa(x) = \\tau \\mu U''(x)$。\n5.  计算雅可比行列式 $J(x) = 1 + \\kappa(x)$。\n6.  从 $J(x)$ 和 $\\kappa(x)$ 计算所需的五个量：\n    - $\\min_{x} J(x)  0$\n    - $\\min_{x} J(x)$\n    - $J(x) \\le 0$ 的网格点数\n    - $\\max_{x} |\\kappa(x)|$\n    - $\\max_{x: J(x)  0} |m(x) - 1|$，其中 $m(x)=1/J(x)$。\n\n结果将被收集并以指定格式打印。代码被设计为自包含且可直接执行的。",
            "answer": "```python\nimport numpy as np\n\ndef analyze_ucna(potential_func, domain, params):\n    \"\"\"\n    Analyzes the breakdown of UCNA for a given potential.\n\n    Args:\n        potential_func (callable): A function that takes x and potential parameters,\n                                  and returns the second derivative U''(x).\n        domain (tuple): A tuple (x_min, x_max) for the analysis domain.\n        params (dict): A dictionary containing parameters for the potential,\n                       as well as mu and tau.\n\n    Returns:\n        list: A list containing the five required analysis results.\n              [validity_flag, min_J, count_J_le_0, max_abs_kappa, max_abs_m_minus_1]\n    \"\"\"\n    N = 10001\n    x_min, x_max = domain\n    x_grid = np.linspace(x_min, x_max, N)\n\n    mu = params['mu']\n    tau = params['tau']\n\n    # Calculate U''(x) on the grid\n    U_double_prime = potential_func(x_grid, params)\n\n    # 1. Curvature correction parameter kappa(x)\n    kappa = tau * mu * U_double_prime\n\n    # 2. Jacobian determinant J(x)\n    J = 1 + kappa\n\n    # 3. Multiplicative factor m(x)\n    # Use np.divide with a where clause to avoid division by zero warnings.\n    # The result for J=0 will be infinity, which is handled later.\n    m = np.divide(1.0, J, where=(J != 0))\n\n    # --- Compute the five required quantities ---\n\n    # Quantity 1: validity_flag\n    min_J = np.min(J)\n    validity_flag = min_J > 0\n\n    # Quantity 2: min_J\n    # Already computed as min_J\n\n    # Quantity 3: count_J_le_0\n    count_J_le_0 = np.sum(J = 0)\n\n    # Quantity 4: max_abs_kappa\n    max_abs_kappa = np.max(np.abs(kappa))\n\n    # Quantity 5: max_abs_m_minus_1\n    valid_J_mask = J > 0\n    if np.any(valid_J_mask):\n        m_valid = m[valid_J_mask]\n        max_abs_m_minus_1 = np.max(np.abs(m_valid - 1))\n    else:\n        # If J is non-positive everywhere, there are no valid points.\n        # The deviation is infinite in principle.\n        max_abs_m_minus_1 = float('inf')\n\n    return [validity_flag, min_J, int(count_J_le_0), max_abs_kappa, max_abs_m_minus_1]\n\n# --- Potential Function Definitions ---\n\ndef U_quadratic_d2(x, params):\n    \"\"\"Second derivative of U(x) = k/2 * x^2\"\"\"\n    k = params['k']\n    return k * np.ones_like(x)\n\ndef U_double_well_d2(x, params):\n    \"\"\"Second derivative of U(x) = a/4 * x^4 - b/2 * x^2\"\"\"\n    a = params['a']\n    b = params['b']\n    return 3 * a * x**2 - b\n\ndef U_periodic_d2(x, params):\n    \"\"\"Second derivative of U(x) = V0 * (1 - cos(q*x))\"\"\"\n    V0 = params['V0']\n    q = params['q']\n    return V0 * q**2 * np.cos(q * x)\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        {\n            \"potential_func\": U_quadratic_d2,\n            \"domain\": (-5.0, 5.0),\n            \"params\": {'k': 1.0, 'mu': 1.0, 'tau': 0.1}\n        },\n        {\n            \"potential_func\": U_double_well_d2,\n            \"domain\": (-2.0, 2.0),\n            \"params\": {'a': 1.0, 'b': 2.0, 'mu': 1.0, 'tau': 0.5}\n        },\n        {\n            \"potential_func\": U_double_well_d2,\n            \"domain\": (-2.0, 2.0),\n            \"params\": {'a': 1.0, 'b': 2.0, 'mu': 1.0, 'tau': 0.8}\n        },\n        {\n            \"potential_func\": U_periodic_d2,\n            \"domain\": (-np.pi, np.pi),\n            \"params\": {'V0': 1.0, 'q': 2.0, 'mu': 1.0, 'tau': 0.2}\n        },\n        {\n            \"potential_func\": U_periodic_d2,\n            \"domain\": (-np.pi, np.pi),\n            \"params\": {'V0': 1.0, 'q': 2.0, 'mu': 1.0, 'tau': 0.6}\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_ucna(case[\"potential_func\"], case[\"domain\"], case[\"params\"])\n        results.append(result)\n\n    # Format the output string exactly as required\n    # Convert each inner list to a string\n    inner_lists_str = [f\"[{res[0]},{res[1]},{res[2]},{res[3]},{res[4]}]\" for res in results]\n    # Join them into a single string\n    final_output = f\"[{','.join(inner_lists_str)}]\"\n\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "理论模型的价值最终体现在其预测能力上，而这往往需要精确的数值模拟来验证。然而，直接对随机微分方程进行离散化可能会不经意地破坏系统蕴含的基本物理原理。这个练习将带你直面这一挑战：你将首先分析标准的欧拉-丸山（Euler-Maruyama）方法为何在被动极限下无法正确再现热平衡态，然后设计一种改进的数值格式，使其在任何时间步长下都能精确满足涨落-耗散定理。掌握这种技能对于构建可靠的、具有物理一致性的模拟至关重要。",
            "id": "3780795",
            "problem": "考虑一个二维活性布朗粒子 (ABP)，其位置为 $\\mathbf{x}(t) \\in \\mathbb{R}^2$，方向角为 $\\theta(t) \\in \\mathbb{R}$，其动力学由具有自驱动和旋转噪声的过阻尼朗之万方程建模。其基本基础是过阻尼力平衡和爱因斯坦平动扩散关系。具体假设如下：\n- 过阻尼平动动力学由下式给出：\n$$\n\\frac{d\\mathbf{x}}{dt} \\;=\\; -\\mu \\nabla U(\\mathbf{x}) \\;+\\; v_0 \\mathbf{n}(\\theta) \\;+\\; \\sqrt{2 D_t} \\,\\boldsymbol{\\xi}(t),\n$$\n其中 $\\mu$ 是迁移率，$U(\\mathbf{x})$ 是势能，$v_0$ 是自驱动速度，$\\mathbf{n}(\\theta) = (\\cos\\theta, \\sin\\theta)$，$D_t$ 是平动扩散系数，$\\boldsymbol{\\xi}(t)$ 是二维标准高斯白噪声。爱因斯坦关系成立：$D_t = \\mu k_{\\mathrm{B}} T$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是温度。\n- 旋转动力学由下式给出：\n$$\n\\frac{d\\theta}{dt} \\;=\\; \\sqrt{2 D_r} \\,\\eta(t),\n$$\n其中 $D_r$ 是旋转扩散系数，$\\eta(t)$ 是标准高斯白噪声。角度必须以弧度处理。\n\n在无源极限 $v_0 \\to 0$ 下，ABP 简化为在势能 $U(\\mathbf{x})$ 中的过阻尼布朗粒子。对于特定且科学上一致的情况 $U(\\mathbf{x}) = \\tfrac{k}{2} \\|\\mathbf{x}\\|^2$（刚度为 $k$ 的谐波陷阱），连续时间稳态分布是玻尔兹曼分布，其高斯协方差满足每个笛卡尔分量 $x_i$ 的 $\\mathrm{Var}[x_i] = \\frac{k_{\\mathrm{B}} T}{k}$。该平衡源于涨落-耗散平衡以及谐波势中过阻尼朗之万方程的线性特性。\n\n任务：\n1. 从上述基本基础和定义出发，分析将 Euler–Maruyama 方法应用于 ABP 时引入的离散化误差。重点关注谐波势 $U(\\mathbf{x}) = \\tfrac{k}{2} \\|\\mathbf{x}\\|^2$ 下的无源极限 $v_0 \\to 0$，并推导由离散时间 Euler–Maruyama 格式产生的单个笛卡尔分量的稳态方差，作为时间步长 $\\Delta t$、刚度 $k$ 和迁移率 $\\mu$ 的函数。用弛豫率 $\\lambda = \\mu k$ 和平动扩散系数 $D_t = \\mu k_{\\mathrm{B}} T$ 表示你的结果。\n2. 为 ABP 设计一个时间离散的数值格式，该格式在谐波势 $U(\\mathbf{x}) = \\tfrac{k}{2} \\|\\mathbf{x}\\|^2$ 的条件下，对于任意有限时间步长 $\\Delta t$，在极限 $v_0 \\to 0$ 下能重现正确的无源平衡。该格式必须在物理和数学上都合理，并且必须从线性无源动力学的精确解结合单个时间步长内对活性漂移的一致处理推导得出。清楚说明如何更新方向（角度单位必须是弧度），以及如何在单个时间步长内近似自驱动贡献，以保持无源极限。\n3. 实现一个程序，用于计算在无源极限下比较 Euler–Maruyama 格式和您设计的格式的定量指标。使用以下测试套件，均为二维，并采用无量纲参数：\n   - 平动迁移率 $\\mu = 1$，温度满足 $k_{\\mathrm{B}} T = 1$，因此 $D_t = 1$。\n   - 谐波刚度 $k = 1$，因此弛豫率 $\\lambda = 1$。\n   - 旋转扩散系数 $D_r = 2$。\n   - 时间步长 $\\Delta t \\in \\{0.01, 0.5, 1.9\\}$。\n   - 通过设置 $v_0 = 0$ 来精确强制无源极限。\n   对于每个 $\\Delta t$，计算：\n   - 在无源极限下，Euler–Maruyama 方法下单个笛卡尔分量的相对稳态方差偏差，定义为\n   $$\n   \\varepsilon_{\\mathrm{EM}}(\\Delta t) \\;=\\; \\frac{\\mathrm{Var}_{\\mathrm{EM}}}{\\mathrm{Var}_{\\mathrm{eq}}} - 1,\n   $$\n   其中 $\\mathrm{Var}_{\\mathrm{eq}} = \\frac{k_{\\mathrm{B}} T}{k}$ 是平衡方差，$\\mathrm{Var}_{\\mathrm{EM}}$ 是 Euler–Maruyama 方法在时间步长 $\\Delta t$ 下产生的稳态方差。\n   - 在相同条件下，您设计的格式对应的相对稳态方差偏差 $\\varepsilon_{\\mathrm{scheme}}(\\Delta t)$。\n   另外，包括一个自由扩散边界情况，以测试在没有约束情况下的离散化的另一个方面：\n   - 设置 $k = 0$，同时保持 $\\mu = 1$，$k_{\\mathrm{B}} T = 1$，因此 $D_t = 1$，并考虑单个时间步长 $\\Delta t = 1$ 且 $v_0 = 0$。计算 Euler–Maruyama 和您设计的格式中，每步的均方位移与其二维理论值 $4 D_t \\Delta t$ 的比值，即\n   $$\n   r_{\\mathrm{EM}} = \\frac{\\mathrm{MSD}_{\\mathrm{EM}}}{4 D_t \\Delta t}, \\quad r_{\\mathrm{scheme}} = \\frac{\\mathrm{MSD}_{\\mathrm{scheme}}}{4 D_t \\Delta t}.\n   $$\n4. 您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，并按上述测试套件的以下顺序排列：\n   $$\n   [\\varepsilon_{\\mathrm{EM}}(0.01), \\varepsilon_{\\mathrm{scheme}}(0.01), \\varepsilon_{\\mathrm{EM}}(0.5), \\varepsilon_{\\mathrm{scheme}}(0.5), \\varepsilon_{\\mathrm{EM}}(1.9), \\varepsilon_{\\mathrm{scheme}}(1.9), r_{\\mathrm{EM}}, r_{\\mathrm{scheme}}].\n   $$\n所有角度必须以弧度处理。所有输出必须是无量纲数。不允许使用百分比；请使用小数。",
            "solution": "在尝试解答之前，对问题进行验证。\n\n### 步骤1：提取已知条件\n问题提供了以下信息：\n- 一个二维活性布朗粒子 (ABP)，其位置为 $\\mathbf{x}(t) \\in \\mathbb{R}^2$，方向为 $\\theta(t) \\in \\mathbb{R}$。\n- 平动动力学：$\\frac{d\\mathbf{x}}{dt} = -\\mu \\nabla U(\\mathbf{x}) + v_0 \\mathbf{n}(\\theta) + \\sqrt{2 D_t} \\,\\boldsymbol{\\xi}(t)$，其中 $\\mu$ 是迁移率，$U(\\mathbf{x})$ 是一个势能，$v_0$ 是自驱动速度，$\\mathbf{n}(\\theta) = (\\cos\\theta, \\sin\\theta)$，$D_t$ 是平动扩散系数，$\\boldsymbol{\\xi}(t)$ 是二维标准高斯白噪声。\n- 旋转动力学：$\\frac{d\\theta}{dt} = \\sqrt{2 D_r} \\,\\eta(t)$，其中 $D_r$ 是旋转扩散系数，$\\eta(t)$ 是标准高斯白噪声。\n- 爱因斯坦关系：$D_t = \\mu k_{\\mathrm{B}} T$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是温度。\n- 给定一个特定的势能：刚度为 $k$ 的谐波陷阱 $U(\\mathbf{x}) = \\tfrac{k}{2} \\|\\mathbf{x}\\|^2$。\n- 对于该势能，在无源极限 ($v_0 \\to 0$) 下，每个笛卡尔分量的平衡方差被表述为 $\\mathrm{Var}[x_i] = \\frac{k_{\\mathrm{B}} T}{k}$。\n- 弛豫率定义为 $\\lambda = \\mu k$。\n- 任务1：在谐波势的无源极限下，推导 Euler–Maruyama 格式下单个笛卡尔分量的稳态方差，作为 $\\Delta t$、$k$ 和 $\\mu$（或 $\\lambda$ 和 $D_t$）的函数。\n- 任务2：设计一个时间离散的数值格式，对于任何有限的 $\\Delta t  0$，该格式都能重现正确的无源平衡方差。\n- 任务3：实现一个程序，用以计算给定参数下的特定定量指标：\n    - 参数：$\\mu = 1$，$k_{\\mathrm{B}} T = 1$（$D_t = 1$），$k = 1$（$\\lambda = 1$），$D_r = 2$，$v_0 = 0$。\n    - 谐波陷阱的时间步长：$\\Delta t \\in \\{0.01, 0.5, 1.9\\}$。\n    - 指标：相对方差偏差 $\\varepsilon_{\\mathrm{EM}}(\\Delta t) = \\frac{\\mathrm{Var}_{\\mathrm{EM}}}{\\mathrm{Var}_{\\mathrm{eq}}} - 1$ 以及所设计格式的 $\\varepsilon_{\\mathrm{scheme}}(\\Delta t)$。\n    - 自由扩散边界情况：$k = 0$，$\\Delta t = 1$。\n    - 指标：两种格式的 MSD 比率 $r = \\frac{\\mathrm{MSD}}{4 D_t \\Delta t}$。\n- 任务4：程序输出必须是单行：`[$\\varepsilon_{\\mathrm{EM}}(0.01), \\varepsilon_{\\mathrm{scheme}}(0.01), \\varepsilon_{\\mathrm{EM}}(0.5), \\varepsilon_{\\mathrm{scheme}}(0.5), \\varepsilon_{\\mathrm{EM}}(1.9), \\varepsilon_{\\mathrm{scheme}}(1.9), r_{\\mathrm{EM}}, r_{\\mathrm{scheme}}$]`。\n- 所有角度均以弧度为单位。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准评估问题。\n- **科学基础：** 该问题牢固地植根于统计力学，特别是随机过程理论（朗之万方程）及其数值积分，这是计算物理和多尺度建模中一个标准且基础的课题。活性布朗粒子模型是活性物质领域的经典模型。\n- **定义明确：** 问题提供了所有必要的定义、方程和参数。任务以数学精度指定，从而得出一组唯一且有意义的分析和数值结果。\n- **客观性：** 问题使用正式、客观的科学语言陈述，没有歧义或主观论断。\n\n该问题没有任何无效性缺陷。它在计算科学的一个相关子领域中，是一个科学上合理、定义明确且可形式化的练习。\n\n### 步骤3：结论与行动\n问题是 **有效的**。将提供完整解答。\n\n### 解答\n\n解答分为三部分，对应于问题陈述中定义的任务。\n\n#### 第1部分：Euler–Maruyama 格式的稳态方差\n\n我们考虑在谐波势 $U(\\mathbf{x}) = \\frac{k}{2} \\|\\mathbf{x}\\|^2$ 中的无源极限 ($v_0 \\to 0$)。力为 $\\mathbf{F} = -\\nabla U(\\mathbf{x}) = -k\\mathbf{x}$。位置 $\\mathbf{x}$ 的朗之万方程变为：\n$$\n\\frac{d\\mathbf{x}}{dt} = -\\mu k \\mathbf{x} + \\sqrt{2 D_t} \\boldsymbol{\\xi}(t)\n$$\n这个矢量方程解耦为两个相同且独立的关于笛卡尔分量 $x$ 和 $y$ 的方程。我们来分析一个分量，$x(t)$：\n$$\n\\frac{dx}{dt} = -\\lambda x + \\sqrt{2 D_t} \\xi_x(t)\n$$\n其中 $\\lambda = \\mu k$ 是弛豫率，$\\xi_x(t)$是一维标准高斯白噪声。这是一个 Ornstein-Uhlenbeck 过程。\n\n这个随机微分方程使用时间步长 $\\Delta t$ 的 Euler–Maruyama 离散化是：\n$$\nx_{n+1} = x_n - \\lambda x_n \\Delta t + \\sqrt{2 D_t \\Delta t} \\mathcal{N}_n\n$$\n其中 $\\mathcal{N}_n$ 是从标准正态分布 $\\mathcal{N}(0, 1)$ 中抽取的随机数。我们可以将其重写为：\n$$\nx_{n+1} = (1 - \\lambda \\Delta t) x_n + \\sqrt{2 D_t \\Delta t} \\mathcal{N}_n\n$$\n为了找到稳态方差 $\\mathrm{Var}_{\\mathrm{EM}}$，我们假设过程已达到稳态，使得 $\\mathrm{Var}[x_{n+1}] = \\mathrm{Var}[x_n] = \\mathrm{Var}_{\\mathrm{EM}}$。均值为 $\\mathrm{E}[x_n] = 0$。\n对两边取方差，并利用 $x_n$ 和噪声项 $\\mathcal{N}_n$ 相互独立的事实：\n$$\n\\mathrm{Var}[x_{n+1}] = \\mathrm{Var}[(1 - \\lambda \\Delta t) x_n] + \\mathrm{Var}[\\sqrt{2 D_t \\Delta t} \\mathcal{N}_n]\n$$\n$$\n\\mathrm{Var}_{\\mathrm{EM}} = (1 - \\lambda \\Delta t)^2 \\mathrm{Var}[x_n] + (2 D_t \\Delta t) \\mathrm{Var}[\\mathcal{N}_n]\n$$\n由于 $\\mathrm{Var}[\\mathcal{N}_n] = 1$ 且 $\\mathrm{Var}[x_n] = \\mathrm{Var}_{\\mathrm{EM}}$：\n$$\n\\mathrm{Var}_{\\mathrm{EM}} = (1 - \\lambda \\Delta t)^2 \\mathrm{Var}_{\\mathrm{EM}} + 2 D_t \\Delta t\n$$\n求解 $\\mathrm{Var}_{\\mathrm{EM}}$：\n$$\n\\mathrm{Var}_{\\mathrm{EM}} \\left[ 1 - (1 - \\lambda \\Delta t)^2 \\right] = 2 D_t \\Delta t\n$$\n$$\n\\mathrm{Var}_{\\mathrm{EM}} \\left[ 1 - (1 - 2\\lambda \\Delta t + \\lambda^2 \\Delta t^2) \\right] = 2 D_t \\Delta t\n$$\n$$\n\\mathrm{Var}_{\\mathrm{EM}} \\left[ 2\\lambda \\Delta t - \\lambda^2 \\Delta t^2 \\right] = 2 D_t \\Delta t\n$$\n假设 $\\Delta t  0$，我们可以除以 $\\Delta t$：\n$$\n\\mathrm{Var}_{\\mathrm{EM}} (2\\lambda - \\lambda^2 \\Delta t) = 2 D_t\n$$\n这给出了由 Euler–Maruyama 格式产生的稳态方差：\n$$\n\\mathrm{Var}_{\\mathrm{EM}} = \\frac{2 D_t}{2\\lambda - \\lambda^2 \\Delta t} = \\frac{D_t}{\\lambda (1 - \\frac{\\lambda \\Delta t}{2})}\n$$\n该格式仅在 $1 - \\frac{\\lambda \\Delta t}{2}  0$ 时稳定，即 $\\Delta t  2/\\lambda$。\n精确的平衡方差是 $\\mathrm{Var}_{\\mathrm{eq}} = \\frac{k_{\\mathrm{B}} T}{k}$。使用给定的关系 $D_t = \\mu k_{\\mathrm{B}} T$ 和 $\\lambda = \\mu k$，我们可以写出 $\\mathrm{Var}_{\\mathrm{eq}} = \\frac{D_t/\\mu}{\\lambda/\\mu} = \\frac{D_t}{\\lambda}$。\n因此，Euler-Maruyama 格式的方差为 $\\mathrm{Var}_{\\mathrm{EM}} = \\frac{\\mathrm{Var}_{\\mathrm{eq}}}{1 - \\frac{\\lambda \\Delta t}{2}}$。\n\n#### 第2部分：修正格式的设计\n为了设计一个对于任何有限 $\\Delta t$ 都能保持正确无源平衡的格式，我们使用线性 Ornstein-Uhlenbeck 过程在一个时间步长上的精确解。从时间 $t$到 $t+\\Delta t$，$dx = -\\lambda x dt + \\sqrt{2 D_t} dW_t$ 的形式解是：\n$$\nx(t+\\Delta t) = x(t) e^{-\\lambda \\Delta t} + \\int_t^{t+\\Delta t} e^{-\\lambda(t+\\Delta t - s)} \\sqrt{2 D_t} dW_s\n$$\n积分项表示一个均值为 $0$ 的高斯随机变量，其方差由 Itō 等距性质给出：\n$$\n\\mathrm{Var}_{\\mathrm{noise}} = \\int_t^{t+\\Delta t} \\left( e^{-\\lambda(t+\\Delta t - s)} \\sqrt{2 D_t} \\right)^2 ds = 2 D_t \\int_t^{t+\\Delta t} e^{-2\\lambda(t+\\Delta t - s)} ds\n$$\n执行积分得到：\n$$\n\\mathrm{Var}_{\\mathrm{noise}} = 2 D_t \\left[ \\frac{e^{-2\\lambda(t+\\Delta t - s)}}{2\\lambda} \\right]_t^{t+\\Delta t} = \\frac{D_t}{\\lambda} (1 - e^{-2\\lambda \\Delta t})\n$$\n这导出了谐波陷阱中无源粒子的精确更新规则：\n$$\n\\mathbf{x}_{n+1} = \\mathbf{x}_n e^{-\\lambda \\Delta t} + \\sqrt{\\frac{D_t}{\\lambda} (1 - e^{-2\\lambda \\Delta t})} \\boldsymbol{\\mathcal{N}}_n\n$$\n其中 $\\boldsymbol{\\mathcal{N}}_n$ 是一个二维标准正态随机向量。根据构造，该格式的稳态方差对于任何 $\\Delta t  0$ 都精确地为 $\\frac{D_t}{\\lambda} = \\mathrm{Var}_{\\mathrm{eq}}$。\n\n为了引入活性自驱动项 $v_0 \\mathbf{n}(\\theta)$，我们必须在时间步长内对其进行一致的积分。完整的方程是 $d\\mathbf{x} = (-\\lambda\\mathbf{x} + v_0\\mathbf{n}(\\theta(t)))dt + \\sqrt{2 D_t} d\\mathbf{W}_t$。使用积分因子方法，可以通过假设在 $s \\in [t_n, t_{n+1}]$ 区间内方向 $\\theta$ 是常数，即 $\\theta(s) \\approx \\theta_n$，来近似一个步长 $\\Delta t$ 内的活性漂移贡献。积分项是：\n$$\n\\int_{t_n}^{t_{n+1}} e^{-\\lambda(t_{n+1}-s)} v_0 \\mathbf{n}(\\theta_n) ds = v_0 \\mathbf{n}(\\theta_n) \\int_{0}^{\\Delta t} e^{-\\lambda u} du = \\frac{v_0}{\\lambda} (1 - e^{-\\lambda \\Delta t}) \\mathbf{n}(\\theta_n)\n$$\n方向本身通过纯旋转扩散演化，对此 Euler-Maruyama 更新是精确的：\n$$\n\\theta_{n+1} = \\theta_n + \\sqrt{2 D_r \\Delta t} \\zeta_n\n$$\n其中 $\\zeta_n \\sim\\mathcal{N}(0,1)$。\n\n因此，提议的格式是：\n1.  更新方向：$\\theta_{n+1} = \\theta_n + \\sqrt{2 D_r \\Delta t} \\zeta_n$\n2.  更新位置：\n    $$\n    \\mathbf{x}_{n+1} = \\mathbf{x}_n e^{-\\lambda \\Delta t} + \\frac{v_0}{\\lambda} (1 - e^{-\\lambda \\Delta t}) \\mathbf{n}(\\theta_n) + \\sqrt{\\frac{D_t}{\\lambda} (1 - e^{-2\\lambda \\Delta t})} \\boldsymbol{\\mathcal{N}}_n\n    $$\n对于所有 $\\Delta t  0$，该格式在 $v_0 \\to 0$ 时正确地简化为无源平衡，并且在极限 $\\lambda \\to 0$（自由扩散）下，它正确地恢复为 ABP 的标准 Euler-Maruyama 格式。\n\n#### 第3部分：定量指标的计算\n\n我们现在使用推导的公式和提供的无量纲参数来计算所要求的量。\n\n**A. 谐波陷阱情况** ($\\mu=1, k_{\\mathrm{B}}T=1, k=1 \\implies D_t=1, \\lambda=1$)\n平衡方差为 $\\mathrm{Var}_{\\mathrm{eq}} = \\frac{k_{\\mathrm{B}} T}{k} = \\frac{1}{1} = 1$。\n\n- 对于 $\\Delta t = 0.01$:\n    - $\\varepsilon_{\\mathrm{EM}}(0.01) = \\frac{\\mathrm{Var}_{\\mathrm{EM}}}{\\mathrm{Var}_{\\mathrm{eq}}} - 1 = \\frac{1}{1 - \\frac{\\lambda \\Delta t}{2}} - 1 = \\frac{1}{1 - \\frac{1 \\cdot 0.01}{2}} - 1 = \\frac{1}{0.995} - 1 = \\frac{0.005}{0.995} \\approx 0.0050251$\n    - $\\varepsilon_{\\mathrm{scheme}}(0.01) = \\frac{\\mathrm{Var}_{\\mathrm{scheme}}}{\\mathrm{Var}_{\\mathrm{eq}}} - 1 = \\frac{\\mathrm{Var}_{\\mathrm{eq}}}{\\mathrm{Var}_{\\mathrm{eq}}} - 1 = 0$\n\n- 对于 $\\Delta t = 0.5$:\n    - $\\varepsilon_{\\mathrm{EM}}(0.5) = \\frac{1}{1 - \\frac{1 \\cdot 0.5}{2}} - 1 = \\frac{1}{0.75} - 1 = \\frac{1}{3} \\approx 0.333333$\n    - $\\varepsilon_{\\mathrm{scheme}}(0.5) = 0$\n\n- 对于 $\\Delta t = 1.9$:\n    - $\\varepsilon_{\\mathrm{EM}}(1.9) = \\frac{1}{1 - \\frac{1 \\cdot 1.9}{2}} - 1 = \\frac{1}{1 - 0.95} - 1 = \\frac{1}{0.05} - 1 = 20 - 1 = 19$\n    - $\\varepsilon_{\\mathrm{scheme}}(1.9) = 0$\n\n**B. 自由扩散边界情况** ($k=0 \\implies \\lambda=0$；同时 $\\mu=1, k_{\\mathrm{B}}T=1, \\Delta t=1, v_0=0$)\n动力学为 $d\\mathbf{x} = \\sqrt{2 D_t} d\\mathbf{W}_t$。二维理论均方位移 (MSD) 为 $\\mathrm{MSD}_{\\mathrm{theory}} = 4 D_t \\Delta t$。当 $D_t=1$ 且 $\\Delta t=1$ 时，$\\mathrm{MSD}_{\\mathrm{theory}} = 4$。\n\n- 对于 Euler–Maruyama：$k=0$ 时的格式为 $\\mathbf{x}_{n+1} = \\mathbf{x}_n + \\sqrt{2 D_t \\Delta t} \\boldsymbol{\\mathcal{N}}_n$。一步的位移为 $\\Delta\\mathbf{x} = \\mathbf{x}_{1} - \\mathbf{x}_{0} = \\sqrt{2 D_t \\Delta t} \\boldsymbol{\\mathcal{N}}_0$。\n    - MSD 为 $\\mathrm{MSD}_{\\mathrm{EM}} = \\langle \\|\\Delta\\mathbf{x}\\|^2 \\rangle = \\langle (\\sqrt{2 D_t \\Delta t})^2 \\|\\boldsymbol{\\mathcal{N}}_0\\|^2 \\rangle = 2 D_t \\Delta t \\langle \\mathcal{N}_x^2 + \\mathcal{N}_y^2 \\rangle$。\n    - 由于 $\\langle\\mathcal{N}_x^2\\rangle = \\langle\\mathcal{N}_y^2\\rangle = 1$，我们得到 $\\mathrm{MSD}_{\\mathrm{EM}} = 2 D_t \\Delta t (1+1) = 4 D_t \\Delta t$。\n    - 比值为 $r_{\\mathrm{EM}} = \\frac{\\mathrm{MSD}_{\\mathrm{EM}}}{\\mathrm{MSD}_{\\mathrm{theory}}} = \\frac{4 D_t \\Delta t}{4 D_t \\Delta t} = 1$。\n\n- 对于设计的格式：我们必须取 $\\lambda \\to 0$ 的极限。\n    - 漂移因子为 $e^{-\\lambda \\Delta t} \\approx 1 - \\lambda \\Delta t$。\n    - 噪声项的方差为 $\\frac{D_t}{\\lambda}(1 - e^{-2\\lambda\\Delta t}) \\approx \\frac{D_t}{\\lambda}(1 - (1 - 2\\lambda\\Delta t)) = 2 D_t \\Delta t$。\n    - 在极限 $\\lambda=0$ 时，该格式变为 $\\mathbf{x}_{n+1} = \\mathbf{x}_n + \\sqrt{2 D_t \\Delta t} \\boldsymbol{\\mathcal{N}}_n$，这与本例中的 Euler-Maruyama 格式相同。\n    - 因此，$\\mathrm{MSD}_{\\mathrm{scheme}} = 4 D_t \\Delta t$，比值为 $r_{\\mathrm{scheme}} = 1$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes quantitative measures comparing the Euler-Maruyama scheme and\n    a corrected scheme for Active Brownian Particle dynamics in a passive limit.\n    \"\"\"\n\n    # Define test cases based on the problem statement.\n    # The parameters are dimensionless.\n    # Case 1-3: Harmonic Trap (k=1) with varying time steps.\n    # Case 4: Free Diffusion (k=0).\n    test_cases = [\n        # (mu, k_B*T, k, dt)\n        (1.0, 1.0, 1.0, 0.01),\n        (1.0, 1.0, 1.0, 0.5),\n        (1.0, 1.0, 1.0, 1.9),\n        (1.0, 1.0, 0.0, 1.0)\n    ]\n\n    results = []\n\n    # Process harmonic trap cases\n    for i in range(3):\n        mu, k_B_T, k, dt = test_cases[i]\n        \n        # Calculate derived parameters\n        lambda_val = mu * k\n        \n        # --- Euler-Maruyama Bias ---\n        # Formula derived as: Var_EM/Var_eq - 1 = (1 / (1 - lambda*dt/2)) - 1\n        denominator = 1.0 - lambda_val * dt / 2.0\n        \n        if denominator = 0:\n            eps_em = float('inf')  \n        else:\n            eps_em = 1.0 / denominator - 1.0\n        results.append(eps_em)\n\n        # --- Designed Scheme Bias ---\n        # The designed scheme reproduces the correct equilibrium variance for any dt > 0.\n        # Thus, its stationary variance is Var_eq, and the bias is 0.\n        eps_scheme = 0.0\n        results.append(eps_scheme)\n\n    # Process free diffusion case\n    mu, k_B_T, k, dt = test_cases[3]\n    D_t = mu * k_B_T\n    \n    # Theoretical Mean-Squared Displacement in 2D for one step\n    msd_theory = 4.0 * D_t * dt\n\n    # --- Euler-Maruyama MSD Ratio ---\n    # For k=0, the EM scheme gives MSD_EM = 4 * D_t * dt.\n    msd_em = 4.0 * D_t * dt\n    r_em = msd_em / msd_theory\n    results.append(r_em)\n\n    # --- Designed Scheme MSD Ratio ---\n    # In the limit k -> 0 (lambda -> 0), the designed scheme reduces\n    # to the Euler-Maruyama scheme.\n    # Therefore, it also gives MSD_scheme = 4 * D_t * dt.\n    msd_scheme = 4.0 * D_t * dt\n    r_scheme = msd_scheme / msd_theory\n    results.append(r_scheme)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{results[0]},{results[1]},{results[2]},{results[3]},{results[4]},{results[5]},{results[6]},{results[7]}]\")\n\nsolve()\n```"
        }
    ]
}