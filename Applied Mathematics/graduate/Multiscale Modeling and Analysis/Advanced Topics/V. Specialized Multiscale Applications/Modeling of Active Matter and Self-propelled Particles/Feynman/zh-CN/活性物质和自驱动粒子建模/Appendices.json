{
    "hands_on_practices": [
        {
            "introduction": "自驱动粒子的一个基本特征是其运动模式在不同时间尺度上会发生变化。本练习将引导你通过第一性原理，推导“运行-翻滚粒子”（Run-and-Tumble Particle, RTP）这一典型模型在二维空间中的均方位移（Mean-Squared Displacement, MSD）。通过这个练习，你将亲手揭示粒子如何从短时间内的弹道式直线运动，过渡到长时间尺度下的有效扩散行为，并计算出其有效的扩散系数 $D_{\\mathrm{eff}}$。",
            "id": "3780854",
            "problem": "考虑一个二维的游动-翻滚粒子（Run-and-Tumble Particle, RTP），其定义为一个点状活性粒子，以恒定速率 $v_0$ 沿着一个方向单位矢量 $\\mathbf{e}(t)$ 运动。该方向矢量在时间上是分段恒定的，并在一个速率为 $\\alpha>0$ 的齐次泊松过程的事件点上发生瞬时的、无记忆的、各向同性的重新定向（即“翻滚”）。假设没有被动平移噪声，系统是平稳且各向同性的，粒子从原点 $\\mathbf{r}(0)=\\mathbf{0}$ 开始运动，其初始方向 $\\mathbf{e}(0)$ 从单位圆上均匀随机抽取，并且翻滚会将方向重置为一个独立的、在二维空间中均匀分布的方向。\n\n从第一性原理出发——即位移的定义是速度的时间积分、泊松过程和各向同性的性质，以及均方位移与速度自相关之间的关系——推导所有 $t\\ge 0$ 时精确的、随时间变化的均方位移 $\\langle|\\Delta\\mathbf{r}(t)|^2\\rangle$。然后，通过将均方位移的线性增长与适用于二维情况的形式相匹配，确定有效的长时扩散系数 $D_{\\mathrm{eff}}$。请以闭式解析表达式的形式给出 $\\langle|\\Delta\\mathbf{r}(t)|^2\\rangle$ 和 $D_{\\mathrm{eff}}$ 的最终答案。无需进行数值计算或四舍五入。",
            "solution": "首先将根据指定标准验证问题陈述。\n\n### 步骤1：提取给定条件\n- 一个二维的游动-翻滚粒子 (RTP)。\n- 粒子以恒定速率 $v_0$ 运动。\n- 方向单位矢量 $\\mathbf{e}(t)$ 是分段恒定的。\n- 翻滚是瞬时的、无记忆的、各向同性的重新定向。\n- 翻滚作为速率为 $\\alpha > 0$ 的齐次泊松过程发生。\n- 没有被动平移噪声。\n- 系统是平稳且各向同性的。\n- 粒子从原点开始：$\\mathbf{r}(0) = \\mathbf{0}$。\n- 初始方向 $\\mathbf{e}(0)$ 从单位圆上均匀随机抽取。\n- 翻滚将方向重置为一个独立且均匀分布的方向。\n- 任务是推导所有 $t \\ge 0$ 时精确的、随时间变化的均方位移 (MSD)，$\\langle|\\Delta\\mathbf{r}(t)|^2\\rangle$。\n- 任务是确定有效的长时扩散系数 $D_{\\mathrm{eff}}$。\n\n### 步骤2：使用提取的给定条件进行验证\n- **科学基础：** 游动-翻滚粒子 (RTP) 是活性物质领域中的一个经典模型，用于描述诸如大肠杆菌等各种微生物的运动。该模型基于随机过程（泊松过程）和统计力学的既定原理。该问题具有科学合理性。\n- **良态问题：** 所有必要的参数（$v_0$, $\\alpha$）、初始条件（$\\mathbf{r}(0)=\\mathbf{0}$）以及方向动力学的统计特性（各向同性翻滚、均匀初始分布）都已提供。问题要求的是特定的、明确定义的物理量（MSD 和有效扩散系数），预期有唯一解。\n- **客观性：** 问题使用理论物理学中常见的精确、技术性语言表述。它没有主观或含糊的陈述。\n- **完整性与一致性：** 问题是自洽的。所提供的信息对于推导所要求的量是充分且一致的。平稳性假设与初始方向从更新过程的平稳分布（圆上的均匀分布）中抽取是一致的。\n\n### 步骤3：结论与行动\n该问题是有效的，因为它具有科学基础、是良态问题、客观且自洽。现在开始推导解。\n\n粒子在时间 $t$ 的位移由 $\\Delta\\mathbf{r}(t) = \\mathbf{r}(t) - \\mathbf{r}(0)$ 给出。在初始条件 $\\mathbf{r}(0)=\\mathbf{0}$ 下，位移就是 $\\mathbf{r}(t)$。粒子的速度为 $\\mathbf{v}(t) = v_0 \\mathbf{e}(t)$，其中 $v_0$ 是恒定速率，$\\mathbf{e}(t)$ 是随时间变化的方向单位矢量。位置是速度的时间积分：\n$$\n\\mathbf{r}(t) = \\int_0^t \\mathbf{v}(t') dt' = v_0 \\int_0^t \\mathbf{e}(t') dt'\n$$\n均方位移 (MSD) 是位移矢量模平方的系综平均：\n$$\n\\langle|\\Delta\\mathbf{r}(t)|^2\\rangle = \\langle |\\mathbf{r}(t)|^2 \\rangle = \\langle \\mathbf{r}(t) \\cdot \\mathbf{r}(t) \\rangle\n$$\n代入 $\\mathbf{r}(t)$ 的表达式：\n$$\n\\langle|\\mathbf{r}(t)|^2\\rangle = \\left\\langle \\left( v_0 \\int_0^t \\mathbf{e}(t') dt' \\right) \\cdot \\left( v_0 \\int_0^t \\mathbf{e}(t'') dt'' \\right) \\right\\rangle\n$$\n根据期望算子的线性性质，我们可以将平均运算移到积分内部：\n$$\n\\langle|\\mathbf{r}(t)|^2\\rangle = v_0^2 \\int_0^t dt' \\int_0^t dt'' \\langle \\mathbf{e}(t') \\cdot \\mathbf{e}(t'') \\rangle\n$$\n项 $\\langle \\mathbf{e}(t') \\cdot \\mathbf{e}(t'') \\rangle$ 是方向自相关函数。由于底层的随机过程（翻滚的齐次泊松过程）在时间上是平稳的，该相关函数仅依赖于时间差 $\\tau = |t' - t''|$。我们来计算 $C(\\tau) = \\langle \\mathbf{e}(0) \\cdot \\mathbf{e}(\\tau) \\rangle$。\n\n当且仅当在时间间隔 $[0, \\tau]$ 内没有发生翻滚时，方向 $\\mathbf{e}(\\tau)$ 才与 $\\mathbf{e}(0)$ 相同。此时间间隔内的翻滚次数服从均值为 $\\alpha\\tau$ 的泊松分布。零次翻滚的概率是 $P(0, \\tau) = \\exp(-\\alpha\\tau)$。\n如果发生一次或多次翻滚，初始方向的记忆就会丢失，因为新方向是各向同性地、独立于前一个方向选择的。我们用 $\\mathbf{e}_{\\text{new}}$ 表示翻滚后的新方向。由于各向同性，其与任何固定矢量（如 $\\mathbf{e}(0)$）的点积的平均值为零：$\\langle \\mathbf{e}(0) \\cdot \\mathbf{e}_{\\text{new}} \\rangle = 0$。\n\n因此，我们可以通过以 $[0, \\tau]$ 内的翻滚次数为条件来表示相关函数：\n$$\n\\langle \\mathbf{e}(0) \\cdot \\mathbf{e}(\\tau) \\rangle = \\langle \\mathbf{e}(0) \\cdot \\mathbf{e}(\\tau) | \\text{没有翻滚} \\rangle P(\\text{没有翻滚}) + \\langle \\mathbf{e}(0) \\cdot \\mathbf{e}(\\tau) | \\text{至少一次翻滚} \\rangle P(\\text{至少一次翻滚})\n$$\n如果没有翻滚，$\\mathbf{e}(\\tau) = \\mathbf{e}(0)$，所以 $\\mathbf{e}(0) \\cdot \\mathbf{e}(\\tau) = |\\mathbf{e}(0)|^2 = 1$。这种情况的概率是 $\\exp(-\\alpha\\tau)$。\n如果至少有一次翻滚，时间 $\\tau$ 时的方向与 $\\mathbf{e}(0)$ 无关，所以点积的期望值为 $0$。\n因此，方向自相关函数为：\n$$\nC(\\tau) = \\langle \\mathbf{e}(0) \\cdot \\mathbf{e}(\\tau) \\rangle = (1) \\cdot \\exp(-\\alpha\\tau) + (0) \\cdot (1 - \\exp(-\\alpha\\tau)) = \\exp(-\\alpha\\tau)\n$$\n所以，$\\langle \\mathbf{e}(t') \\cdot \\mathbf{e}(t'') \\rangle = \\exp(-\\alpha|t' - t''|)$。\n\n现在我们回到 MSD 的积分：\n$$\n\\langle|\\mathbf{r}(t)|^2\\rangle = v_0^2 \\int_0^t dt' \\int_0^t dt'' \\exp(-\\alpha|t' - t''|)\n$$\n我们可以将积分的方形区域 $t', t'' \\in [0, t]$ 分成两个三角形：一个区域 $t' > t''$，另一个区域 $t'' > t'$。根据对称性，这两个区域上的积分是相等的。\n$$\n\\langle|\\mathbf{r}(t)|^2\\rangle = 2 v_0^2 \\int_0^t dt' \\int_0^{t'} dt'' \\exp(-\\alpha(t' - t''))\n$$\n首先，我们计算关于 $t''$ 的内层积分：\n$$\n\\int_0^{t'} \\exp(-\\alpha(t' - t'')) dt'' = \\exp(-\\alpha t') \\int_0^{t'} \\exp(\\alpha t'') dt'' = \\exp(-\\alpha t') \\left[ \\frac{1}{\\alpha} \\exp(\\alpha t'') \\right]_0^{t'}\n$$\n$$\n= \\frac{\\exp(-\\alpha t')}{\\alpha} (\\exp(\\alpha t') - \\exp(0)) = \\frac{1}{\\alpha}(1 - \\exp(-\\alpha t'))\n$$\n接下来，我们计算关于 $t'$ 的外层积分：\n$$\n\\langle|\\mathbf{r}(t)|^2\\rangle = 2 v_0^2 \\int_0^t \\frac{1}{\\alpha}(1 - \\exp(-\\alpha t')) dt' = \\frac{2v_0^2}{\\alpha} \\int_0^t (1 - \\exp(-\\alpha t')) dt'\n$$\n$$\n= \\frac{2v_0^2}{\\alpha} \\left[ t' - \\left(-\\frac{1}{\\alpha}\\right)\\exp(-\\alpha t') \\right]_0^t = \\frac{2v_0^2}{\\alpha} \\left[ t' + \\frac{1}{\\alpha}\\exp(-\\alpha t') \\right]_0^t\n$$\n$$\n= \\frac{2v_0^2}{\\alpha} \\left( \\left(t + \\frac{1}{\\alpha}\\exp(-\\alpha t)\\right) - \\left(0 + \\frac{1}{\\alpha}\\exp(0)\\right) \\right) = \\frac{2v_0^2}{\\alpha} \\left( t + \\frac{1}{\\alpha}(\\exp(-\\alpha t) - 1) \\right)\n$$\n整理后得到 MSD 的最终表达式：\n$$\n\\langle|\\Delta\\mathbf{r}(t)|^2\\rangle = \\frac{2v_0^2}{\\alpha^2}(\\alpha t - 1 + \\exp(-\\alpha t))\n$$\n为了求有效长时扩散系数 $D_{\\mathrm{eff}}$，我们考察当 $t \\to \\infty$ 时 MSD 的行为。在此极限下，$\\exp(-\\alpha t)$ 项趋于零：\n$$\n\\langle|\\Delta\\mathbf{r}(t)|^2\\rangle \\sim \\frac{2v_0^2}{\\alpha^2}(\\alpha t - 1) = \\frac{2v_0^2}{\\alpha}t - \\frac{2v_0^2}{\\alpha^2} \\quad \\text{for } t \\to \\infty\n$$\n长时行为与 $t$ 呈线性关系，这是扩散运动的特征。对于 $d$ 维空间中的扩散，MSD 的形式为 $\\langle|\\Delta\\mathbf{r}(t)|^2\\rangle \\sim 2d D_{\\mathrm{eff}} t$。在我们的情况中，维度 $d=2$。因此，我们将主导项与 $4D_{\\mathrm{eff}}t$ 进行匹配：\n$$\n4 D_{\\mathrm{eff}} t = \\frac{2v_0^2}{\\alpha} t\n$$\n解出 $D_{\\mathrm{eff}}$ 可得：\n$$\nD_{\\mathrm{eff}} = \\frac{2v_0^2}{4\\alpha} = \\frac{v_0^2}{2\\alpha}\n$$\n这两个所求的量已经从第一性原理推导得出。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2v_0^2}{\\alpha^2} (\\alpha t - 1 + \\exp(-\\alpha t))  \\frac{v_0^2}{2\\alpha} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "将理论模型转化为计算机模拟是研究复杂系统的关键一步，但这其中充满了挑战。本练习聚焦于“活性布朗粒子”（Active Brownian Particle, ABP）模型的数值积分，揭示了朴素的欧拉-丸山（Euler–Maruyama）方法为何在模拟处于谐振子势阱中的粒子时，无法正确再现其无源极限下的热力学平衡态。你将通过分析其误差来源，并设计一个更精确的数值方案，来深刻理解如何构建既高效又尊重基本物理定律（如涨落-耗散定理）的模拟算法。",
            "id": "3780795",
            "problem": "考虑一个二维活性布朗粒子 (ABP)，其位置为 $\\mathbf{x}(t) \\in \\mathbb{R}^2$，取向角为 $\\theta(t) \\in \\mathbb{R}$，其动力学由包含自驱动和旋转噪声的过阻尼朗之万方程建模。其基本依据是过阻尼力平衡以及平动扩散的爱因斯坦关系式。具体而言，假设如下：\n- 过阻尼平动动力学由下式给出\n$$\n\\frac{d\\mathbf{x}}{dt} \\;=\\; -\\mu \\nabla U(\\mathbf{x}) \\;+\\; v_0 \\mathbf{n}(\\theta) \\;+\\; \\sqrt{2 D_t} \\,\\boldsymbol{\\xi}(t),\n$$\n其中 $\\mu$ 是迁移率，$U(\\mathbf{x})$ 是势，$v_0$ 是自驱动速度，$\\mathbf{n}(\\theta) = (\\cos\\theta, \\sin\\theta)$，$D_t$ 是平动扩散系数，$\\boldsymbol{\\xi}(t)$ 是二维标准高斯白噪声。爱因斯坦关系式成立：$D_t = \\mu k_{\\mathrm{B}} T$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是温度。\n- 旋转动力学由下式给出\n$$\n\\frac{d\\theta}{dt} \\;=\\; \\sqrt{2 D_r} \\,\\eta(t),\n$$\n其中 $D_r$ 是旋转扩散系数，$\\eta(t)$ 是标准高斯白噪声。角度必须以弧度处理。\n\n在无源极限 $v_0 \\to 0$ 下，ABP 简化为在势 $U(\\mathbf{x})$ 中的过阻尼布朗粒子。对于 $U(\\mathbf{x}) = \\tfrac{k}{2} \\|\\mathbf{x}\\|^2$ (刚度为 $k$ 的谐波陷阱) 这一具体且科学上一致的情况，连续时间稳态分布是玻尔兹曼分布，其高斯协方差对每个笛卡尔分量 $x_i$ 均满足 $\\mathrm{Var}[x_i] = \\frac{k_{\\mathrm{B}} T}{k}$。该平衡态源于涨落-耗散平衡以及谐波势中过阻尼朗之万方程的线性特性。\n\n任务：\n1. 从上述基本依据和定义出发，分析将 Euler–Maruyama 方法应用于 ABP 时引入的离散化误差。重点关注在谐波势 $U(\\mathbf{x}) = \\tfrac{k}{2} \\|\\mathbf{x}\\|^2$ 下的无源极限 $v_0 \\to 0$，并推导由离散时间 Euler–Maruyama 格式产生的单个笛卡尔分量的稳态方差，将其表示为时间步长 $\\Delta t$、刚度 $k$ 和迁移率 $\\mu$ 的函数。用弛豫率 $\\lambda = \\mu k$ 和平动扩散系数 $D_t = \\mu k_{\\mathrm{B}} T$ 来表示您的结果。\n2. 为 ABP 设计一个时间离散数值格式，该格式对于谐波势 $U(\\mathbf{x}) = \\tfrac{k}{2} \\|\\mathbf{x}\\|^2$，在 $v_0 \\to 0$ 的极限下，对于任意有限时间步长 $\\Delta t$ 都能复现正确的无源平衡态。该格式必须在物理和数学上是合理的，并且必须从线性无源动力学的精确解，结合对单个时间步长内活性漂移的一致处理推导得出。请清楚地说明如何更新取向（角度单位必须是弧度），以及如何在单个时间步长内近似自驱动贡献，以保持无源极限。\n3. 实现一个程序，用于计算比较 Euler–Maruyama 格式和您设计的格式在无源极限下的量化指标。使用以下测试套件，均为二维情况，采用无量纲参数：\n   - 平动迁移率 $\\mu = 1$，温度满足 $k_{\\mathrm{B}} T = 1$，因此 $D_t = 1$。\n   - 谐波刚度 $k = 1$，因此弛豫率 $\\lambda = 1$。\n   - 旋转扩散系数 $D_r = 2$。\n   - 时间步长 $\\Delta t \\in \\{0.01, 0.5, 1.9\\}$。\n   - 通过设置 $v_0 = 0$ 精确强制无源极限。\n   对于每个 $\\Delta t$，计算：\n   - 在无源极限下，Euler–Maruyama 格式下单个笛卡尔分量的相对稳态方差偏差，定义为\n   $$\n   \\varepsilon_{\\mathrm{EM}}(\\Delta t) \\;=\\; \\frac{\\mathrm{Var}_{\\mathrm{EM}}}{\\mathrm{Var}_{\\mathrm{eq}}} - 1,\n   $$\n   其中 $\\mathrm{Var}_{\\mathrm{eq}} = \\frac{k_{\\mathrm{B}} T}{k}$ 是平衡态方差，$\\mathrm{Var}_{\\mathrm{EM}}$ 是 Euler–Maruyama 在时间步长 $\\Delta t$ 下产生的稳态方差。\n   - 在相同条件下，您设计的格式对应的相对稳态方差偏差 $\\varepsilon_{\\mathrm{scheme}}(\\Delta t)$。\n   此外，包括一个自由扩散边界情况，以测试在没有约束的情况下离散化的另一方面：\n   - 设置 $k = 0$，同时保持 $\\mu = 1$，$k_{\\mathrm{B}} T = 1$，因此 $D_t = 1$，并考虑单个时间步长 $\\Delta t = 1$ 且 $v_0 = 0$。对于 Euler–Maruyama 和您设计的格式，计算每步的均方位移与其理论值 $4 D_t \\Delta t$（在二维情况下）的比值，即\n   $$\n   r_{\\mathrm{EM}} = \\frac{\\mathrm{MSD}_{\\mathrm{EM}}}{4 D_t \\Delta t}, \\quad r_{\\mathrm{scheme}} = \\frac{\\mathrm{MSD}_{\\mathrm{scheme}}}{4 D_t \\Delta t}.\n   $$\n4. 您的程序应生成单行输出，包含一个逗号分隔的列表，用方括号括起，并按以下顺序排列上述测试套件的结果：\n   $$\n   [\\varepsilon_{\\mathrm{EM}}(0.01), \\varepsilon_{\\mathrm{scheme}}(0.01), \\varepsilon_{\\mathrm{EM}}(0.5), \\varepsilon_{\\mathrm{scheme}}(0.5), \\varepsilon_{\\mathrm{EM}}(1.9), \\varepsilon_{\\mathrm{scheme}}(1.9), r_{\\mathrm{EM}}, r_{\\mathrm{scheme}}].\n   $$\n所有角度必须以弧度处理。所有输出必须是无量纲数。不允许使用百分比；请使用小数。",
            "solution": "在尝试解答之前，对问题进行了验证。\n\n### 步骤 1：提取已知条件\n问题提供了以下信息：\n- 一个二维活性布朗粒子 (ABP)，其位置为 $\\mathbf{x}(t) \\in \\mathbb{R}^2$，取向为 $\\theta(t) \\in \\mathbb{R}$。\n- 平动动力学：$\\frac{d\\mathbf{x}}{dt} = -\\mu \\nabla U(\\mathbf{x}) + v_0 \\mathbf{n}(\\theta) + \\sqrt{2 D_t} \\,\\boldsymbol{\\xi}(t)$，其中 $\\mu$ 是迁移率，$U(\\mathbf{x})$ 是势，$v_0$ 是自驱动速度，$\\mathbf{n}(\\theta) = (\\cos\\theta, \\sin\\theta)$，$D_t$ 是平动扩散系数，$\\boldsymbol{\\xi}(t)$ 是二维标准高斯白噪声。\n- 旋转动力学：$\\frac{d\\theta}{dt} = \\sqrt{2 D_r} \\,\\eta(t)$，其中 $D_r$ 是旋转扩散系数，$\\eta(t)$ 是标准高斯白噪声。\n- 爱因斯坦关系式：$D_t = \\mu k_{\\mathrm{B}} T$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是温度。\n- 给定一个具体势：谐波陷阱 $U(\\mathbf{x}) = \\tfrac{k}{2} \\|\\mathbf{x}\\|^2$，刚度为 $k$。\n- 对于该势，在无源极限 ($v_0 \\to 0$) 下的平衡态方差被表述为 $\\mathrm{Var}[x_i] = \\frac{k_{\\mathrm{B}} T}{k}$（对每个笛卡尔分量）。\n- 弛豫率定义为 $\\lambda = \\mu k$。\n- 任务 1：推导 Euler–Maruyama 格式在无源极限和谐波势下单个笛卡尔分量的稳态方差，作为 $\\Delta t$、$k$ 和 $\\mu$（或 $\\lambda$ 和 $D_t$）的函数。\n- 任务 2：设计一个时间离散数值格式，对于任意有限 $\\Delta t > 0$，该格式都能复现正确的无源平衡态方差。\n- 任务 3：实现一个程序，为给定参数计算特定的量化指标：\n    - 参数：$\\mu = 1$，$k_{\\mathrm{B}} T = 1$ ($D_t = 1$)，$k = 1$ ($\\lambda = 1$)，$D_r = 2$，$v_0 = 0$。\n    - 谐波陷阱的时间步长：$\\Delta t \\in \\{0.01, 0.5, 1.9\\}$。\n    - 量化指标：相对方差偏差 $\\varepsilon_{\\mathrm{EM}}(\\Delta t) = \\frac{\\mathrm{Var}_{\\mathrm{EM}}}{\\mathrm{Var}_{\\mathrm{eq}}} - 1$ 和为所设计格式计算的 $\\varepsilon_{\\mathrm{scheme}}(\\Delta t)$。\n    - 自由扩散边界情况：$k = 0$，$\\Delta t = 1$。\n    - 量化指标：均方位移比值 $r = \\frac{\\mathrm{MSD}}{4 D_t \\Delta t}$，用于两种格式。\n- 任务 4：程序输出必须是单行：`[$\\varepsilon_{\\mathrm{EM}}(0.01), \\varepsilon_{\\mathrm{scheme}}(0.01), \\varepsilon_{\\mathrm{EM}}(0.5), \\varepsilon_{\\mathrm{scheme}}(0.5), \\varepsilon_{\\mathrm{EM}}(1.9), \\varepsilon_{\\mathrm{scheme}}(1.9), r_{\\mathrm{EM}}, r_{\\mathrm{scheme}}$]`。\n- 所有角度均为弧度。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学基础：** 该问题牢固地植根于统计力学，特别是随机过程理论（朗之万方程）及其数值积分，这是计算物理和多尺度建模中一个标准且基础的课题。活性布朗粒子模型是活性物质领域的经典模型。\n- **适定性：** 问题提供了所有必要的定义、方程和参数。任务以数学精度指定，可以得出一组唯一且有意义的解析和数值结果。\n- **客观性：** 问题使用正式、客观的科学语言陈述，没有歧义或主观论断。\n\n该问题未表现出任何无效性缺陷。这是计算科学相关子领域中一个科学合理、适定且可形式化的问题。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供完整解答。\n\n### 解答\n\n解答分为三个部分，与问题陈述中定义的任务相对应。\n\n#### 第一部分：Euler–Maruyama 格式的稳态方差\n\n我们考虑在谐波势 $U(\\mathbf{x}) = \\frac{k}{2} \\|\\mathbf{x}\\|^2$ 中的无源极限 ($v_0 \\to 0$)。力为 $\\mathbf{F} = -\\nabla U(\\mathbf{x}) = -k\\mathbf{x}$。位置 $\\mathbf{x}$ 的朗之万方程变为：\n$$\n\\frac{d\\mathbf{x}}{dt} = -\\mu k \\mathbf{x} + \\sqrt{2 D_t} \\boldsymbol{\\xi}(t)\n$$\n这个向量方程可以解耦为两个相同且独立的关于笛卡尔分量 $x$ 和 $y$ 的方程。我们来分析一个分量 $x(t)$：\n$$\n\\frac{dx}{dt} = -\\lambda x + \\sqrt{2 D_t} \\xi_x(t)\n$$\n其中 $\\lambda = \\mu k$ 是弛豫率，$\\xi_x(t)$ 是一维标准高斯白噪声。这是一个 Ornstein-Uhlenbeck 过程。\n\n该随机微分方程使用时间步长 $\\Delta t$ 的 Euler–Maruyama 离散化为：\n$$\nx_{n+1} = x_n - \\lambda x_n \\Delta t + \\sqrt{2 D_t \\Delta t} \\mathcal{N}_n\n$$\n其中 $\\mathcal{N}_n$ 是从标准正态分布 $\\mathcal{N}(0, 1)$ 中抽取的随机数。我们可以将其重写为：\n$$\nx_{n+1} = (1 - \\lambda \\Delta t) x_n + \\sqrt{2 D_t \\Delta t} \\mathcal{N}_n\n$$\n为了找到稳态方差 $\\mathrm{Var}_{\\mathrm{EM}}$，我们假设过程已达到稳态，使得 $\\mathrm{Var}[x_{n+1}] = \\mathrm{Var}[x_n] = \\mathrm{Var}_{\\mathrm{EM}}$。均值为 $\\mathrm{E}[x_n] = 0$。\n对两边取方差，并利用 $x_n$ 和噪声项 $\\mathcal{N}_n$ 相互独立的事实：\n$$\n\\mathrm{Var}[x_{n+1}] = \\mathrm{Var}[(1 - \\lambda \\Delta t) x_n] + \\mathrm{Var}[\\sqrt{2 D_t \\Delta t} \\mathcal{N}_n]\n$$\n$$\n\\mathrm{Var}_{\\mathrm{EM}} = (1 - \\lambda \\Delta t)^2 \\mathrm{Var}[x_n] + (2 D_t \\Delta t) \\mathrm{Var}[\\mathcal{N}_n]\n$$\n由于 $\\mathrm{Var}[\\mathcal{N}_n] = 1$ 且 $\\mathrm{Var}[x_n] = \\mathrm{Var}_{\\mathrm{EM}}$：\n$$\n\\mathrm{Var}_{\\mathrm{EM}} = (1 - \\lambda \\Delta t)^2 \\mathrm{Var}_{\\mathrm{EM}} + 2 D_t \\Delta t\n$$\n求解 $\\mathrm{Var}_{\\mathrm{EM}}$：\n$$\n\\mathrm{Var}_{\\mathrm{EM}} \\left[ 1 - (1 - \\lambda \\Delta t)^2 \\right] = 2 D_t \\Delta t\n$$\n$$\n\\mathrm{Var}_{\\mathrm{EM}} \\left[ 1 - (1 - 2\\lambda \\Delta t + \\lambda^2 \\Delta t^2) \\right] = 2 D_t \\Delta t\n$$\n$$\n\\mathrm{Var}_{\\mathrm{EM}} \\left[ 2\\lambda \\Delta t - \\lambda^2 \\Delta t^2 \\right] = 2 D_t \\Delta t\n$$\n假设 $\\Delta t > 0$，我们可以除以 $\\Delta t$：\n$$\n\\mathrm{Var}_{\\mathrm{EM}} (2\\lambda - \\lambda^2 \\Delta t) = 2 D_t\n$$\n这给出了 Euler–Maruyama 格式产生的稳态方差：\n$$\n\\mathrm{Var}_{\\mathrm{EM}} = \\frac{2 D_t}{2\\lambda - \\lambda^2 \\Delta t} = \\frac{D_t}{\\lambda (1 - \\frac{\\lambda \\Delta t}{2})}\n$$\n该格式仅在 $1 - \\frac{\\lambda \\Delta t}{2} > 0$ 时稳定，即 $\\Delta t < 2/\\lambda$。\n精确的平衡态方差为 $\\mathrm{Var}_{\\mathrm{eq}} = \\frac{k_{\\mathrm{B}} T}{k}$。使用给定的关系式 $D_t = \\mu k_{\\mathrm{B}} T$ 和 $\\lambda = \\mu k$，我们可以写出 $\\mathrm{Var}_{\\mathrm{eq}} = \\frac{D_t/\\mu}{\\lambda/\\mu} = \\frac{D_t}{\\lambda}$。\n因此，Euler-Maruyama 格式的方差为 $\\mathrm{Var}_{\\mathrm{EM}} = \\frac{\\mathrm{Var}_{\\mathrm{eq}}}{1 - \\frac{\\lambda \\Delta t}{2}}$。\n\n#### 第二部分：设计修正格式\n为了设计一个在任意有限 $\\Delta t$ 下都能保持正确无源平衡态的格式，我们使用线性 Ornstein-Uhlenbeck 过程在一个时间步长上的精确解。从时间 $t$ 到 $t+\\Delta t$，方程 $dx = -\\lambda x dt + \\sqrt{2 D_t} dW_t$ 的形式解为：\n$$\nx(t+\\Delta t) = x(t) e^{-\\lambda \\Delta t} + \\int_t^{t+\\Delta t} e^{-\\lambda(t+\\Delta t - s)} \\sqrt{2 D_t} dW_s\n$$\n积分项表示一个均值为 $0$ 的高斯随机变量，其方差由 Itō 等距给出：\n$$\n\\mathrm{Var}_{\\mathrm{noise}} = \\int_t^{t+\\Delta t} \\left( e^{-\\lambda(t+\\Delta t - s)} \\sqrt{2 D_t} \\right)^2 ds = 2 D_t \\int_t^{t+\\Delta t} e^{-2\\lambda(t+\\Delta t - s)} ds\n$$\n进行积分得到：\n$$\n\\mathrm{Var}_{\\mathrm{noise}} = 2 D_t \\left[ \\frac{e^{-2\\lambda(t+\\Delta t - s)}}{2\\lambda} \\right]_t^{t+\\Delta t} = \\frac{D_t}{\\lambda} (1 - e^{-2\\lambda \\Delta t})\n$$\n这导出了谐波陷阱中无源粒子的精确更新规则：\n$$\n\\mathbf{x}_{n+1} = \\mathbf{x}_n e^{-\\lambda \\Delta t} + \\sqrt{\\frac{D_t}{\\lambda} (1 - e^{-2\\lambda \\Delta t})} \\boldsymbol{\\mathcal{N}}_n\n$$\n其中 $\\boldsymbol{\\mathcal{N}}_n$ 是一个二维标准正态随机向量。根据构造，该格式的稳态方差对于任何 $\\Delta t > 0$ 都精确地是 $\\frac{D_t}{\\lambda} = \\mathrm{Var}_{\\mathrm{eq}}$。\n\n为了并入活性自驱动项 $v_0 \\mathbf{n}(\\theta)$，我们必须在一个时间步长上对其进行一致的积分。完整方程为 $d\\mathbf{x} = (-\\lambda\\mathbf{x} + v_0\\mathbf{n}(\\theta(t)))dt + \\sqrt{2 D_t} d\\mathbf{W}_t$。使用积分因子法，可以近似计算在一个时间步长 $\\Delta t$ 内的活性漂移贡献，方法是假设取向 $\\theta$ 是常数，$\\theta(s) \\approx \\theta_n$，对于 $s \\in [t_n, t_{n+1}]$。积分项为：\n$$\n\\int_{t_n}^{t_{n+1}} e^{-\\lambda(t_{n+1}-s)} v_0 \\mathbf{n}(\\theta_n) ds = v_0 \\mathbf{n}(\\theta_n) \\int_{0}^{\\Delta t} e^{-\\lambda u} du = \\frac{v_0}{\\lambda} (1 - e^{-\\lambda \\Delta t}) \\mathbf{n}(\\theta_n)\n$$\n取向本身通过纯旋转扩散演化，对此 Euler-Maruyama 更新是精确的：\n$$\n\\theta_{n+1} = \\theta_n + \\sqrt{2 D_r \\Delta t} \\zeta_n\n$$\n其中 $\\zeta_n \\sim\\mathcal{N}(0,1)$。\n\n因此，所提出的格式是：\n1.  更新取向：$\\theta_{n+1} = \\theta_n + \\sqrt{2 D_r \\Delta t} \\zeta_n$\n2.  更新位置：\n    $$\n    \\mathbf{x}_{n+1} = \\mathbf{x}_n e^{-\\lambda \\Delta t} + \\frac{v_0}{\\lambda} (1 - e^{-\\lambda \\Delta t}) \\mathbf{n}(\\theta_n) + \\sqrt{\\frac{D_t}{\\lambda} (1 - e^{-2\\lambda \\Delta t})} \\boldsymbol{\\mathcal{N}}_n\n    $$\n该格式对于所有 $\\Delta t > 0$，在 $v_0 \\to 0$ 时能正确地简化为无源平衡态；在 $\\lambda \\to 0$ （自由扩散）的极限下，它能正确地恢复为标准的 ABP Euler-Maruyama 格式。\n\n#### 第三部分：量化指标的计算\n\n现在我们使用推导出的公式和提供的无量纲参数来计算所要求的量。\n\n**A. 谐波陷阱情况** ($\\mu=1, k_{\\mathrm{B}}T=1, k=1 \\implies D_t=1, \\lambda=1$)\n平衡态方差为 $\\mathrm{Var}_{\\mathrm{eq}} = \\frac{k_{\\mathrm{B}} T}{k} = \\frac{1}{1} = 1$。\n\n- 对于 $\\Delta t = 0.01$：\n    - $\\varepsilon_{\\mathrm{EM}}(0.01) = \\frac{\\mathrm{Var}_{\\mathrm{EM}}}{\\mathrm{Var}_{\\mathrm{eq}}} - 1 = \\frac{1}{1 - \\frac{\\lambda \\Delta t}{2}} - 1 = \\frac{1}{1 - \\frac{1 \\cdot 0.01}{2}} - 1 = \\frac{1}{0.995} - 1 = \\frac{0.005}{0.995} \\approx 0.0050251$\n    - $\\varepsilon_{\\mathrm{scheme}}(0.01) = \\frac{\\mathrm{Var}_{\\mathrm{scheme}}}{\\mathrm{Var}_{\\mathrm{eq}}} - 1 = \\frac{\\mathrm{Var}_{\\mathrm{eq}}}{\\mathrm{Var}_{\\mathrm{eq}}} - 1 = 0$\n\n- 对于 $\\Delta t = 0.5$：\n    - $\\varepsilon_{\\mathrm{EM}}(0.5) = \\frac{1}{1 - \\frac{1 \\cdot 0.5}{2}} - 1 = \\frac{1}{0.75} - 1 = \\frac{1}{3} \\approx 0.333333$\n    - $\\varepsilon_{\\mathrm{scheme}}(0.5) = 0$\n\n- 对于 $\\Delta t = 1.9$：\n    - $\\varepsilon_{\\mathrm{EM}}(1.9) = \\frac{1}{1 - \\frac{1 \\cdot 1.9}{2}} - 1 = \\frac{1}{1 - 0.95} - 1 = \\frac{1}{0.05} - 1 = 20 - 1 = 19$\n    - $\\varepsilon_{\\mathrm{scheme}}(1.9) = 0$\n\n**B. 自由扩散边界情况** ($k=0 \\implies \\lambda=0$；以及 $\\mu=1, k_{\\mathrm{B}}T=1, \\Delta t=1, v_0=0$)\n动力学方程为 $d\\mathbf{x} = \\sqrt{2 D_t} d\\mathbf{W}_t$。在二维空间中，理论均方位移 (MSD) 为 $\\mathrm{MSD}_{\\mathrm{theory}} = 4 D_t \\Delta t$。当 $D_t=1$ 和 $\\Delta t=1$ 时，$\\mathrm{MSD}_{\\mathrm{theory}} = 4$。\n\n- 对于 Euler–Maruyama 格式：当 $k=0$ 时，格式为 $\\mathbf{x}_{n+1} = \\mathbf{x}_n + \\sqrt{2 D_t \\Delta t} \\boldsymbol{\\mathcal{N}}_n$。一步内的位移为 $\\Delta\\mathbf{x} = \\mathbf{x}_{1} - \\mathbf{x}_{0} = \\sqrt{2 D_t \\Delta t} \\boldsymbol{\\mathcal{N}}_0$。\n    - MSD 为 $\\mathrm{MSD}_{\\mathrm{EM}} = \\langle \\|\\Delta\\mathbf{x}\\|^2 \\rangle = \\langle (\\sqrt{2 D_t \\Delta t})^2 \\|\\boldsymbol{\\mathcal{N}}_0\\|^2 \\rangle = 2 D_t \\Delta t \\langle \\mathcal{N}_x^2 + \\mathcal{N}_y^2 \\rangle$。\n    - 由于 $\\langle\\mathcal{N}_x^2\\rangle = \\langle\\mathcal{N}_y^2\\rangle = 1$，我们得到 $\\mathrm{MSD}_{\\mathrm{EM}} = 2 D_t \\Delta t (1+1) = 4 D_t \\Delta t$。\n    - 比值为 $r_{\\mathrm{EM}} = \\frac{\\mathrm{MSD}_{\\mathrm{EM}}}{\\mathrm{MSD}_{\\mathrm{theory}}} = \\frac{4 D_t \\Delta t}{4 D_t \\Delta t} = 1$。\n\n- 对于设计的格式：我们必须取 $\\lambda \\to 0$ 的极限。\n    - 漂移因子为 $e^{-\\lambda \\Delta t} \\approx 1 - \\lambda \\Delta t$。\n    - 噪声项的方差为 $\\frac{D_t}{\\lambda}(1 - e^{-2\\lambda\\Delta t}) \\approx \\frac{D_t}{\\lambda}(1 - (1 - 2\\lambda\\Delta t)) = 2 D_t \\Delta t$。\n    - 在 $\\lambda=0$ 的极限下，该格式变为 $\\mathbf{x}_{n+1} = \\mathbf{x}_n + \\sqrt{2 D_t \\Delta t} \\boldsymbol{\\mathcal{N}}_n$，这与此情况下的 Euler-Maruyama 格式相同。\n    - 因此，$\\mathrm{MSD}_{\\mathrm{scheme}} = 4 D_t \\Delta t$，比值为 $r_{\\mathrm{scheme}} = 1$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes quantitative measures comparing the Euler-Maruyama scheme and\n    a corrected scheme for Active Brownian Particle dynamics in a passive limit.\n    \"\"\"\n\n    # Define test cases based on the problem statement.\n    # The parameters are dimensionless.\n    # Case 1-3: Harmonic Trap (k=1) with varying time steps.\n    # Case 4: Free Diffusion (k=0).\n    test_cases = [\n        # (mu, k_B*T, k, dt)\n        (1.0, 1.0, 1.0, 0.01),\n        (1.0, 1.0, 1.0, 0.5),\n        (1.0, 1.0, 1.0, 1.9),\n        (1.0, 1.0, 0.0, 1.0)\n    ]\n\n    results = []\n\n    # Process harmonic trap cases\n    for i in range(3):\n        mu, k_B_T, k, dt = test_cases[i]\n        \n        # Calculate derived parameters\n        D_t = mu * k_B_T\n        lambda_val = mu * k\n        \n        # Equilibrium variance (analytical)\n        # Var_eq = k_B_T / k, but here lambda_val and D_t are more direct.\n        # Var_eq = D_t / lambda_val\n        \n        # --- Euler-Maruyama Bias ---\n        # Formula derived as: eps_EM = (lambda * dt / 2) / (1 - lambda * dt / 2)\n        # This is Var_EM / Var_eq - 1, where Var_EM is stationary variance of EM.\n        denominator = 1.0 - lambda_val * dt / 2.0\n        \n        # The scheme is stable only if the denominator is positive.\n        if denominator <= 0:\n            # Stationary variance diverges, so bias is infinite\n            eps_em = float('inf')  \n        else:\n            eps_em = (lambda_val * dt / 2.0) / denominator\n        results.append(eps_em)\n\n        # --- Designed Scheme Bias ---\n        # The designed scheme reproduces the correct equilibrium variance for any dt > 0.\n        # Thus, its stationary variance is Var_eq, and the bias is 0.\n        eps_scheme = 0.0\n        results.append(eps_scheme)\n\n    # Process free diffusion case\n    mu, k_B_T, k, dt = test_cases[3]\n    D_t = mu * k_B_T\n    \n    # Theoretical Mean-Squared Displacement in 2D\n    msd_theory = 4.0 * D_t * dt\n\n    # --- Euler-Maruyama MSD Ratio ---\n    # For k=0, the EM scheme gives MSD_EM = 4 * D_t * dt.\n    msd_em = 4.0 * D_t * dt\n    r_em = msd_em / msd_theory\n    results.append(r_em)\n\n    # --- Designed Scheme MSD Ratio ---\n    # In the limit k -> 0 (lambda -> 0), the designed scheme reduces\n    # to the Euler-Maruyama scheme.\n    # Therefore, it also gives MSD_scheme = 4 * D_t * dt.\n    msd_scheme = 4.0 * D_t * dt\n    r_scheme = msd_scheme / msd_theory\n    results.append(r_scheme)\n    \n    # Final print statement in the exact required format.\n    # The map(str, ...) ensures float representation without trailing zeros for integers.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在处理复杂势场中的活性粒子时，精确解往往难以获得，我们不得不依赖于“统一色噪声近似”（Unified Colored Noise Approximation, UCNA）等近似方法。然而，理解一个近似方法的适用边界，与掌握其应用同样重要。这个理论与编程相结合的练习，将引导你推导出UCNA方法的失效条件，并通过编写程序在非凸势中直观地再现这一理论预测，从而深刻理解这一强大工具在何种物理情境下会失效。",
            "id": "3780830",
            "problem": "考虑一个一维活性奥恩斯坦-乌伦贝克粒子（AOUPs）群体，其位形坐标 $x(t)$ 遵循过阻尼动力学方程 $ \\dot{x}(t) = -\\mu \\, U'(x(t)) + \\eta(t)$。其中，$U(x)$ 是一个确定性势，$\\mu$ 是迁移率，$\\eta(t)$ 是一个奥恩斯坦-乌伦贝克有色噪声，其相关时间为 $\\tau$，强度为 $D$，由随机微分方程 $\\tau \\, \\dot{\\eta}(t) = -\\eta(t) + \\sqrt{2D} \\, \\xi(t)$ 定义。$\\xi(t)$ 是一个零均值、delta相关的高斯白噪声。\n\n统一有色噪声近似（UCNA）通过绝热消除快速有色噪声并将动力学映射到乘性噪声形式，来寻求一种基于变换后的漂移和扩散的有效描述。\n\n在一维情况下，UCNA 为变量替换引入了一个雅可比行列式，并在有效漂移中引入了依赖于势的二阶导数的曲率驱动修正。\n\n在非凸势或多稳态势中，这些修正可能导致破缺条件，其标志是雅可比行列式的符号以及有效漂移中的奇点。\n\n从上述AOUP方程和定义出发，推导出一维UCNA中以势曲率表示的有效漂移和雅可比行列式的表达式。解释为什么非凸区域（其中 $U''(x) < 0$）会使该近似失效，并确定标志近似破缺的精确数学条件。然后，实现一个程序，通过在指定定义域上评估雅可比行列式 $J(x)$ 和有效漂移中的曲率修正，来检验UCNA在几种势中的破缺情况。\n\n所有量均为无量纲；角度必须以弧度处理。\n\n您的程序必须：\n- 对每个测试用例，使用推导的一维UCNA表达式，在指定定义域上的一个包含 $N=10001$ 个点的均匀网格上计算以下内容：\n    1. 一个布尔有效性标志，指示雅可比行列式在整个定义域上是否严格为正，即 $\\min_{x} J(x) > 0$。\n    2. 雅可比行列式的最小值，即 $\\min_{x} J(x)$。\n    3. $J(x) \\le 0$ 的网格点整数计数。\n    4. 最大绝对曲率修正幅度 $\\max_{x} |\\kappa(x)|$，其中 $\\kappa(x)$ 是您推导中定义的曲率修正参数。\n    5. 有效漂移乘子与1的最大绝对偏差，计算公式为 $\\max_{x: J(x) > 0} \\left| m(x) - 1 \\right|$，其中 $m(x)$ 是您推导的有效漂移中的乘性修正因子。该量必须仅在 $J(x) > 0$ 的点上计算。\n- 将所有测试用例的结果汇总到单行输出中，该输出包含一个列表的列表，格式完全如下：$[[\\text{valid}_1,\\min J_1,\\text{count}_1,\\max|\\kappa|_1,\\max|m-1|_1],\\ldots]$，其中每个内部列表按以下提供的顺序对应一个测试用例。\n\n测试套件（角度以弧度为单位，所有参数均无量纲）：\n- 用例 1（凸势参考）：$U(x) = \\frac{k}{2} x^2$，其中 $k = 1$，定义域 $x \\in [-5,5]$，$\\mu = 1$，$\\tau = 0.1$。\n- 用例 2（双势阱边界）：$U(x) = \\frac{a}{4} x^4 - \\frac{b}{2} x^2$，其中 $a = 1$，$b = 2$，定义域 $x \\in [-2,2]$，$\\mu = 1$，$\\tau = 0.5$。\n- 用例 3（双势阱破缺）：$U(x) = \\frac{a}{4} x^4 - \\frac{b}{2} x^2$，其中 $a = 1$，$b = 2$，定义域 $x \\in [-2,2]$，$\\mu = 1$，$\\tau = 0.8$。\n- 用例 4（周期性凸区域）：$U(x) = V_0 \\left(1 - \\cos(q x)\\right)$，其中 $V_0 = 1$，$q = 2$，定义域 $x \\in [-\\pi,\\pi]$，$\\mu = 1$，$\\tau = 0.2$。\n- 用例 5（周期性破缺区域）：$U(x) = V_0 \\left(1 - \\cos(q x)\\right)$，其中 $V_0 = 1$，$q = 2$，定义域 $x \\in [-\\pi,\\pi]$，$\\mu = 1$，$\\tau = 0.6$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，格式如下：$[[\\text{valid}_1,\\min J_1,\\text{count}_1,\\max|\\kappa|_1,\\max|m-1|_1],[\\text{valid}_2,\\min J_2,\\text{count}_2,\\max|\\kappa|_2,\\max|m-1|_2],\\ldots]$。",
            "solution": "该问题要求推导活性奥恩斯坦-乌伦贝克粒子（AOUP）的一维统一有色噪声近似（UCNA）表达式，并实现一个程序来分析该近似在几种势下的破缺情况。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n\n物理系统是一个一维AOUP，其位置 $x(t)$ 由以下随机微分方程（SDE）组控制：\n- 位置动力学：$ \\dot{x}(t) = -\\mu \\, U'(x(t)) + \\eta(t) $\n- 活性噪声动力学：$ \\tau \\, \\dot{\\eta}(t) = -\\eta(t) + \\sqrt{2D} \\, \\xi(t) $\n\n参数如下：\n- $U(x)$: 确定性势。\n- $\\mu$: 迁移率常数。\n- $\\eta(t)$: 奥恩斯坦-乌伦贝克（OU）有色噪声过程。\n- $\\tau$: OU噪声的相关时间。\n- $D$: OU噪声的强度。\n- $\\xi(t)$: 零均值、delta相关的高斯白噪声，即 $\\langle \\xi(t) \\rangle = 0$ 和 $\\langle \\xi(t) \\xi(s) \\rangle = \\delta(t-s)$。\n\n数值和编程要求：\n- 网格点数：在指定定义域上 $N=10001$。\n- 提供了具有特定势 $U(x)$、定义域和参数 $\\mu, \\tau$ 的测试用例。所有量均为无量纲。\n- 程序必须为每个测试用例计算并输出一个包含五个量的列表的列表：\n    1. 布尔有效性标志：$\\min_{x} J(x) > 0$。\n    2. 最小雅可比行列式值：$\\min_{x} J(x)$。\n    3. $J(x) \\le 0$ 的网格点整数计数。\n    4. 最大绝对曲率修正幅度：$\\max_{x} |\\kappa(x)|$。\n    5. 有效漂移乘子的最大绝对偏差：$\\max_{x: J(x) > 0} |m(x) - 1|$。\n\n**1.2. 使用提取的已知条件进行验证**\n\n- **科学依据：** 该问题描述了活性物质（AOUPs）统计物理学中的一个标准模型。UCNA是用于近似此类系统动力学的成熟理论工具。控制方程和概念植根于随机过程和非平衡统计力学的基本原理。该问题在科学上是合理的。\n- **适定性：** 问题定义清晰。推导是该领域的标准程序，数值任务指定了所有必要的参数、定义域和输出格式。存在唯一且有意义的解。\n- **客观性：** 语言精确、技术性强，没有偏见或主观陈述。\n\n**1.3. 结论与行动**\n\n该问题是有效的。这是计算统计物理学中一个定义明确的任务，涉及理论推导和数值实现。\n\n### 步骤 2：UCNA表达式和破缺条件的推导\n\n统一有色噪声近似（UCNA）是一种从随机微分方程组中绝热消除“快速”有色噪声变量，以获得有效的一维福克-普朗克或朗之万方程的技术。出发点是AOUP的耦合系统：\n$$\n\\dot{x}(t) = -\\mu U'(x) + \\eta(t) \\quad \\text{(1)}\n$$\n$$\n\\tau \\dot{\\eta}(t) = -\\eta(t) + \\sqrt{2D} \\xi(t) \\quad \\text{(2)}\n$$\n该系统描述了一个粒子在势场力 $F(x) = -\\mu U'(x)$ 和活性力 $\\eta(t)$ 作用下的运动，其中活性力本身是一个具有有限记忆时间 $\\tau$ 的随机过程。\n\nUCNA提供了一个在 $\\tau$ 较小但不为零时有效的近似描述。在此近似下，$x(t)$ 的动力学可以用一个有效的斯特拉托诺维奇-朗之万方程来描述：\n$$\n\\dot{x}(t) = v_{eff}(x) + \\sqrt{2 D_{eff}(x)} \\, \\zeta(t)\n$$\n其中 $\\zeta(t)$ 是一个单位强度的高斯白噪声。有效漂移 $v_{eff}(x)$ 和有效扩散系数 $D_{eff}(x)$ 包含了有色噪声的影响。\n\n将UCNA应用于系统(1)-(2)的标准结果产生以下有效漂移和扩散的表达式。我们定义方程(1)中的漂移项为 $f(x) = -\\mu U'(x)$。其导数为 $f'(x) = -\\mu U''(x)$。一个仔细的推导，例如通过投影算子方法或变量替换（如Maggi等人（2015）和Sharma & Brader（2017）针对此特定AOUP模型的详细推导），在分母中给出了正确的符号。由此得到的有效漂移是：\n$$\nv_{eff}(x) = \\frac{-\\mu U'(x)}{1 + \\tau \\mu U''(x)}\n$$\n问题要求从这个表达式中识别出几个项。\n\n**雅可比行列式, $J(x)$:**\n这个表达式的分母 $J(x)$ 源于UCNA推导过程中使用的坐标变换的雅可比行列式。其表达式为：\n$$\nJ(x) = 1 + \\tau \\mu U''(x)\n$$\n\n**曲率修正参数, $\\kappa(x)$:**\n项 $\\tau \\mu U''(x)$ 引入了对势的局部曲率 $U''(x)$ 的依赖。我们将其定义为曲率修正参数：\n$$\n\\kappa(x) = \\tau \\mu U''(x)\n$$\n根据这个定义，雅可比行列式就是 $J(x) = 1 + \\kappa(x)$。\n\n**有效漂移和乘性因子, $m(x)$:**\n有效漂移可以重写以突出对原始漂移的修正：\n$$\nv_{eff}(x) = \\left( \\frac{1}{1 + \\tau \\mu U''(x)} \\right) (-\\mu U'(x)) = m(x) \\cdot (-\\mu U'(x))\n$$\n这里，$m(x)$ 是乘性修正因子：\n$$\nm(x) = \\frac{1}{J(x)} = \\frac{1}{1 + \\tau \\mu U''(x)}\n$$\n\n**UCNA的破缺：**\nUCNA是基于一个保持良好行为的坐标变换的近似。如果雅可比行列式 $J(x)$ 变为零或负数，该近似就会破缺。这标志着破缺的数学条件是：\n$$\nJ(x) \\le 0 \\quad \\Leftrightarrow \\quad 1 + \\tau \\mu U''(x) \\le 0\n$$\n这个条件可以重排为 $\\tau \\mu U''(x) \\le -1$。由于 $\\tau$ 和 $\\mu$ 是正常数，这个不等式只有在 $U''(x)$ 为负时才能满足。$U''(x) < 0$ 的区域是势的**非凸**区域（例如，双势阱势中两个阱之间的区域）。\n\n在 $U''(x) \\ge 0$ 的凸区域，曲率项 $\\kappa(x) = \\tau \\mu U''(x)$ 是非负的，因此雅可比行列式 $J(x) = 1 + \\kappa(x)$ 总是大于或等于1。在这些区域，UCNA始终是良定义的。\n\n破缺特别发生在负曲率足够大的非凸区域，即 $U''(x) \\le -1/(\\tau \\mu)$。在 $J(x) \\to 0$ 的点，有效漂移 $v_{eff}(x)$ 和有效扩散系数 $D_{eff}(x) = D\\tau/J(x)^2$ 都会发散。这些奇点标志着绝热消除程序的失败，因为粒子的动力学不能再用一个简单的有效势景观来描述。\n\n### 步骤 3：数值实现\n\n程序将实现推导出的公式，以分析五个给定测试用例的UCNA。对于每个用例，我们将：\n1.  定义势 $U(x)$ 及其二阶导数 $U''(x)$。\n2.  在指定定义域上为变量 $x$ 创建一个包含 $N=10001$ 个点的均匀网格。\n3.  在此网格上计算 $U''(x)$。\n4.  计算曲率修正参数 $\\kappa(x) = \\tau \\mu U''(x)$。\n5.  计算雅可比行列式 $J(x) = 1 + \\kappa(x)$。\n6.  根据 $J(x)$ 和 $\\kappa(x)$，计算五个所需的量：\n    - $\\min_{x} J(x) > 0$\n    - $\\min_{x} J(x)$\n    - $J(x) \\le 0$ 的网格点数\n    - $\\max_{x} |\\kappa(x)|$\n    - $\\max_{x: J(x) > 0} |m(x) - 1|$，其中 $m(x)=1/J(x)$。\n\n结果将被收集并按指定格式打印。代码设计为自包含且可直接执行。",
            "answer": "```python\nimport numpy as np\n\ndef analyze_ucna(potential_func, domain, params):\n    \"\"\"\n    Analyzes the breakdown of UCNA for a given potential.\n\n    Args:\n        potential_func (callable): A function that takes x and potential parameters,\n                                  and returns the second derivative U''(x).\n        domain (tuple): A tuple (x_min, x_max) for the analysis domain.\n        params (dict): A dictionary containing parameters for the potential,\n                       as well as mu and tau.\n\n    Returns:\n        list: A list containing the five required analysis results.\n              [validity_flag, min_J, count_J_le_0, max_abs_kappa, max_abs_m_minus_1]\n    \"\"\"\n    N = 10001\n    x_min, x_max = domain\n    x_grid = np.linspace(x_min, x_max, N)\n\n    mu = params['mu']\n    tau = params['tau']\n\n    # Calculate U''(x) on the grid\n    U_double_prime = potential_func(x_grid, params)\n\n    # 1. Curvature correction parameter kappa(x)\n    kappa = tau * mu * U_double_prime\n\n    # 2. Jacobian determinant J(x)\n    J = 1 + kappa\n\n    # 3. Multiplicative factor m(x)\n    # Use np.divide with a where clause to avoid division by zero warnings.\n    # The result for J=0 will be infinity, which is handled later.\n    m = np.divide(1.0, J, where=(J != 0))\n\n    # --- Compute the five required quantities ---\n\n    # Quantity 1: validity_flag\n    min_J = np.min(J)\n    validity_flag = min_J > 0\n\n    # Quantity 2: min_J\n    # Already computed as min_J\n\n    # Quantity 3: count_J_le_0\n    count_J_le_0 = np.sum(J <= 0)\n\n    # Quantity 4: max_abs_kappa\n    max_abs_kappa = np.max(np.abs(kappa))\n\n    # Quantity 5: max_abs_m_minus_1\n    valid_J_mask = J > 0\n    if np.any(valid_J_mask):\n        m_valid = m[valid_J_mask]\n        max_abs_m_minus_1 = np.max(np.abs(m_valid - 1))\n    else:\n        # If J is non-positive everywhere, there are no valid points.\n        # This case is unlikely for the given problems but is handled for robustness.\n        # The deviation is infinite in principle.\n        max_abs_m_minus_1 = float('inf')\n\n    return [validity_flag, min_J, int(count_J_le_0), max_abs_kappa, max_abs_m_minus_1]\n\n# --- Potential Function Definitions ---\n\ndef U_quadratic_d2(x, params):\n    \"\"\"Second derivative of U(x) = k/2 * x^2\"\"\"\n    k = params['k']\n    return k * np.ones_like(x)\n\ndef U_double_well_d2(x, params):\n    \"\"\"Second derivative of U(x) = a/4 * x^4 - b/2 * x^2\"\"\"\n    a = params['a']\n    b = params['b']\n    return 3 * a * x**2 - b\n\ndef U_periodic_d2(x, params):\n    \"\"\"Second derivative of U(x) = V0 * (1 - cos(q*x))\"\"\"\n    V0 = params['V0']\n    q = params['q']\n    return V0 * q**2 * np.cos(q * x)\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        {\n            \"potential_func\": U_quadratic_d2,\n            \"domain\": (-5.0, 5.0),\n            \"params\": {'k': 1.0, 'mu': 1.0, 'tau': 0.1}\n        },\n        {\n            \"potential_func\": U_double_well_d2,\n            \"domain\": (-2.0, 2.0),\n            \"params\": {'a': 1.0, 'b': 2.0, 'mu': 1.0, 'tau': 0.5}\n        },\n        {\n            \"potential_func\": U_double_well_d2,\n            \"domain\": (-2.0, 2.0),\n            \"params\": {'a': 1.0, 'b': 2.0, 'mu': 1.0, 'tau': 0.8}\n        },\n        {\n            \"potential_func\": U_periodic_d2,\n            \"domain\": (-np.pi, np.pi),\n            \"params\": {'V0': 1.0, 'q': 2.0, 'mu': 1.0, 'tau': 0.2}\n        },\n        {\n            \"potential_func\": U_periodic_d2,\n            \"domain\": (-np.pi, np.pi),\n            \"params\": {'V0': 1.0, 'q': 2.0, 'mu': 1.0, 'tau': 0.6}\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_ucna(case[\"potential_func\"], case[\"domain\"], case[\"params\"])\n        results.append(result)\n\n    # Format the output string exactly as required\n    # Convert each inner list to a string\n    inner_lists_str = [f\"[{res[0]},{res[1]},{res[2]},{res[3]},{res[4]}]\" for res in results]\n    # Join them into a single string\n    final_output = f\"[{','.join(inner_lists_str)}]\"\n\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}