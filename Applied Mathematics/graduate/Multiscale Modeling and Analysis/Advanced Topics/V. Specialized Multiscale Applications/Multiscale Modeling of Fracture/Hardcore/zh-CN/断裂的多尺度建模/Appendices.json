{
    "hands_on_practices": [
        {
            "introduction": "在晶体材料中，断裂的发生并非各向同性；其路径强烈依赖于晶体学取向。本练习将引导你应用Griffith断裂准则来处理一个各向异性的场景，通过最小化表面能来预测脆性单晶中的首选解理面。这个计算实践清晰地揭示了原子尺度的性质（表面能）如何直接决定宏观的断裂行为。",
            "id": "3785454",
            "problem": "一个具有立方对称性的脆性单晶表现出各向异性的解理面表面能。考虑一个在晶体参考系中与晶体学 $\\langle 100 \\rangle$ 轴对齐的初始直的、原子级尖锐的裂纹。潜在解理面的取向由一个从 $\\langle 100 \\rangle$ 轴测量的面内角 $\\theta$ 描述，其中 $0 \\leq \\theta  \\pi$。单位面积的解理表面能的晶体学各向异性由下式给出\n$$\n\\gamma(\\theta) = \\gamma_{0}\\left[1 + c_{4}\\cos(4\\theta) + c_{8}\\cos(8\\theta)\\right],\n$$\n其中 $\\gamma_{0}$、$c_{4}$ 和 $c_{8}$ 是反映立方对称性的材料参数。\n\n假设晶格陷阱效应和非弹性耗散可以忽略，因此临界能量释放率遵循 Griffith 准则 $G_{c}(\\theta) = 2\\,\\gamma(\\theta)$。在远程加载下，裂纹承受纯 I 型载荷，应力强度因子为 $K_{I}$，无 II 型载荷。为了近尖端能量平衡的目的，在平面应变条件下，将弹性响应视为均匀且各向同性。因此，远场热力学驱动能量释放率为\n$$\nG = \\frac{(1-\\nu^{2})}{E}K_{I}^{2},\n$$\n其中 $E$ 是杨氏模量，$\\nu$ 是泊松比。\n\n给定材料参数 $\\gamma_{0} = 1.2\\,\\mathrm{J/m^{2}}$，$c_{4} = 0.3$，$c_{8} = 0.05$，弹性性能 $E = 200\\,\\mathrm{GPa}$，$\\nu = 0.30$，以及载荷 $K_{I} = 1.0\\,\\mathrm{MPa}\\sqrt{\\mathrm{m}}$，通过最小化 $G_{c}(\\theta)$ 来确定优选的解理面，并验证裂纹扩展在能量上是允许的，即对于最小值点 $\\theta^{\\ast}$，满足 $G \\geq G_{c}(\\theta^{\\ast})$。将最终的裂纹方向报告为从 $\\langle 100 \\rangle$ 轴测量的最小正最小化角 $\\theta^{\\ast}$（以弧度为单位）。以弧度为单位，用精确形式（不要四舍五入）表示 $\\theta^{\\ast}$ 的最终答案。",
            "solution": "该问题要求确定在 I 型加载下脆性单晶的优选解理面。这可以通过找到使临界能量释放率 $G_c(\\theta)$ 最小化的角度 $\\theta$ 来实现。随后，必须验证可用的能量释放率 $G$ 是否足以驱动裂纹沿此优选路径扩展。\n\n首先，我们对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 晶体具有立方对称性。\n- 初始直裂纹与晶体学 $\\langle 100 \\rangle$ 轴对齐。\n- 潜在解理面的取向由从 $\\langle 100 \\rangle$ 轴测量的角度 $\\theta$ 描述，其中 $0 \\leq \\theta  \\pi$。\n- 单位面积的解理表面能由 $\\gamma(\\theta) = \\gamma_{0}\\left[1 + c_{4}\\cos(4\\theta) + c_{8}\\cos(8\\theta)\\right]$ 给出。\n- 临界能量释放率由 Griffith 准则定义：$G_{c}(\\theta) = 2\\,\\gamma(\\theta)$。\n- 加载为纯 I 型，应力强度因子为 $K_{I}$，无 II 型。\n- 在平面应变条件下，弹性响应被视为均匀且各向同性。\n- 远场热力学驱动能量释放率为 $G = \\frac{(1-\\nu^{2})}{E}K_{I}^{2}$。\n- 材料参数：$\\gamma_{0} = 1.2\\,\\mathrm{J/m^{2}}$，$c_{4} = 0.3$，$c_{8} = 0.05$。\n- 弹性性能：$E = 200\\,\\mathrm{GPa}$，$\\nu = 0.30$。\n- 载荷：$K_{I} = 1.0\\,\\mathrm{MPa}\\sqrt{\\mathrm{m}}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，采用了线性弹性断裂力学（LEFM）的标准原理，特别是 Griffith 的脆性断裂理论。各向异性表面能的表达式是针对立方对称性的有效唯象模型。平面应变条件下的能量释放率 $G$ 的表达式是正确的。所提供的材料性能和加载值对于脆性材料和金属来说在物理上是现实的。该问题是自洽的，提供了所有必要的数据和方程。作为一个微积分优化问题，后面跟着一个比较，这个问题是适定的。没有科学缺陷、歧义或矛盾。\n\n### 步骤 3：结论和行动\n该问题被认为是有效的。将制定解决方案。\n\n优选的解理面对应于使抗断裂性最小化的方向 $\\theta$。抗断裂性由临界能量释放率 $G_{c}(\\theta)$ 给出。因此，我们必须找到使 $G_{c}(\\theta)$ 最小化的角度 $\\theta^{\\ast}$。\n需要最小化的函数是：\n$$G_{c}(\\theta) = 2\\gamma(\\theta) = 2\\gamma_{0}\\left[1 + c_{4}\\cos(4\\theta) + c_{8}\\cos(8\\theta)\\right]$$\n为了找到极值，我们计算 $G_{c}(\\theta)$ 关于 $\\theta$ 的一阶导数，并令其为零。\n$$\\frac{dG_{c}}{d\\theta} = 2\\gamma_{0} \\frac{d}{d\\theta}\\left[1 + c_{4}\\cos(4\\theta) + c_{8}\\cos(8\\theta)\\right]$$\n$$\\frac{dG_{c}}{d\\theta} = 2\\gamma_{0}\\left[-4c_{4}\\sin(4\\theta) - 8c_{8}\\sin(8\\theta)\\right]$$\n令 $\\frac{dG_{c}}{d\\theta} = 0$：\n$$-4c_{4}\\sin(4\\theta) - 8c_{8}\\sin(8\\theta) = 0$$\n我们使用二倍角恒等式 $\\sin(8\\theta) = 2\\sin(4\\theta)\\cos(4\\theta)$：\n$$-4c_{4}\\sin(4\\theta) - 8c_{8}\\left(2\\sin(4\\theta)\\cos(4\\theta)\\right) = 0$$\n$$-4\\sin(4\\theta)\\left[c_{4} + 4c_{8}\\cos(4\\theta)\\right] = 0$$\n这个方程为驻点提供了两种可能性：\n1. $\\sin(4\\theta) = 0$\n2. $c_{4} + 4c_{8}\\cos(4\\theta) = 0$\n\n我们来分析第一种情况，$\\sin(4\\theta) = 0$。这意味着对于任意整数 $n$，$4\\theta = n\\pi$。因此，$\\theta = \\frac{n\\pi}{4}$。在指定域 $0 \\leq \\theta  \\pi$ 内，$\\theta$ 的可能值为：\n- $n=0: \\theta = 0$\n- $n=1: \\theta = \\frac{\\pi}{4}$\n- $n=2: \\theta = \\frac{2\\pi}{4} = \\frac{\\pi}{2}$\n- $n=3: \\theta = \\frac{3\\pi}{4}$\n\n现在，我们来分析第二种情况，$c_{4} + 4c_{8}\\cos(4\\theta) = 0$。\n$$\\cos(4\\theta) = -\\frac{c_{4}}{4c_{8}}$$\n代入给定的材料参数 $c_{4} = 0.3$ 和 $c_{8} = 0.05$：\n$$\\cos(4\\theta) = -\\frac{0.3}{4(0.05)} = -\\frac{0.3}{0.2} = -1.5$$\n由于余弦函数的值必须在 $[-1, 1]$ 范围内，因此第二种情况没有 $\\theta$ 的实数解。唯一的驻点是第一种情况下找到的那些。\n\n为了确定这些驻点中哪些是极小值点，我们采用二阶导数检验。$G_{c}(\\theta)$ 的二阶导数是：\n$$\\frac{d^2G_{c}}{d\\theta^2} = \\frac{d}{d\\theta} \\left( 2\\gamma_{0}\\left[-4c_{4}\\sin(4\\theta) - 8c_{8}\\sin(8\\theta)\\right] \\right)$$\n$$\\frac{d^2G_{c}}{d\\theta^2} = 2\\gamma_{0}\\left[-16c_{4}\\cos(4\\theta) - 64c_{8}\\cos(8\\theta)\\right]$$\n$$\\frac{d^2G_{c}}{d\\theta^2} = -32\\gamma_{0}\\left[c_{4}\\cos(4\\theta) + 4c_{8}\\cos(8\\theta)\\right]$$\n当 $\\frac{d^2G_{c}}{d\\theta^2} > 0$ 时，出现局部极小值。由于 $\\gamma_{0}$ 是一个正常数，该条件等价于 $c_{4}\\cos(4\\theta) + 4c_{8}\\cos(8\\theta)  0$。我们用 $c_4=0.3$ 和 $c_8=0.05$ 来检验每个驻点：\n\n- 对于 $\\theta = 0$：$\\cos(0)=1$，$\\cos(0)=1$。表达式为 $c_{4} + 4c_{8} = 0.3 + 4(0.05) = 0.5 > 0$。因此，$\\frac{d^2G_{c}}{d\\theta^2}  0$，这表明是一个局部极大值。\n- 对于 $\\theta = \\frac{\\pi}{4}$：$\\cos(\\pi)=-1$，$\\cos(2\\pi)=1$。表达式为 $c_{4}(-1) + 4c_{8}(1) = -c_{4} + 4c_{8} = -0.3 + 4(0.05) = -0.1  0$。因此，$\\frac{d^2G_{c}}{d\\theta^2} > 0$，这表明是一个局部极小值。\n- 对于 $\\theta = \\frac{\\pi}{2}$：$\\cos(2\\pi)=1$，$\\cos(4\\pi)=1$。表达式为 $c_{4} + 4c_{8} = 0.5 > 0$。因此，$\\frac{d^2G_{c}}{d\\theta^2}  0$，这表明是一个局部极大值。\n- 对于 $\\theta = \\frac{3\\pi}{4}$：$\\cos(3\\pi)=-1$，$\\cos(6\\pi)=1$。表达式为 $c_{4}(-1) + 4c_{8}(1) = -c_{4} + 4c_{8} = -0.1  0$。因此，$\\frac{d^2G_{c}}{d\\theta^2} > 0$，这表明是一个局部极小值。\n\n局部极小值出现在 $\\theta = \\frac{\\pi}{4}$ 和 $\\theta = \\frac{3\\pi}{4}$ 处。为了找到全局最小值，我们计算 $G_{c}(\\theta)$ 在这两个角度的值。\n对于 $\\theta = \\frac{\\pi}{4}$：\n$$G_{c}\\left(\\frac{\\pi}{4}\\right) = 2\\gamma_{0}\\left[1 + c_{4}\\cos\\left(4\\frac{\\pi}{4}\\right) + c_{8}\\cos\\left(8\\frac{\\pi}{4}\\right)\\right] = 2\\gamma_{0}\\left[1 + c_{4}\\cos(\\pi) + c_{8}\\cos(2\\pi)\\right]$$\n$$G_{c}\\left(\\frac{\\pi}{4}\\right) = 2\\gamma_{0}(1 - c_{4} + c_{8})$$\n对于 $\\theta = \\frac{3\\pi}{4}$：\n$$G_{c}\\left(\\frac{3\\pi}{4}\\right) = 2\\gamma_{0}\\left[1 + c_{4}\\cos\\left(4\\frac{3\\pi}{4}\\right) + c_{8}\\cos\\left(8\\frac{3\\pi}{4}\\right)\\right] = 2\\gamma_{0}\\left[1 + c_{4}\\cos(3\\pi) + c_{8}\\cos(6\\pi)\\right]$$\n$$G_{c}\\left(\\frac{3\\pi}{4}\\right) = 2\\gamma_{0}(1 - c_{4} + c_{8})$$\n两个极小值点的 $G_{c}$ 值是相同的。问题要求的是最小的正最小化角 $\\theta^{\\ast}$。比较 $\\frac{\\pi}{4}$ 和 $\\frac{3\\pi}{4}$，最小的正角是 $\\theta^{\\ast} = \\frac{\\pi}{4}$。\n\n接下来，我们必须验证裂纹扩展在能量上是允许的，即 $G \\geq G_{c}(\\theta^{\\ast})$。\n首先，计算远场能量释放率 $G$：\n$$G = \\frac{(1-\\nu^{2})}{E}K_{I}^{2}$$\n给定的值必须使用一致的国际单位制（SI）单位：$E = 200\\,\\mathrm{GPa} = 200 \\times 10^{9}\\,\\mathrm{Pa}$，$\\nu = 0.30$，以及 $K_{I} = 1.0\\,\\mathrm{MPa}\\sqrt{\\mathrm{m}} = 1.0 \\times 10^{6}\\,\\mathrm{Pa}\\sqrt{\\mathrm{m}}$。\n$$G = \\frac{1 - (0.30)^{2}}{200 \\times 10^{9}\\,\\mathrm{Pa}} \\left(1.0 \\times 10^{6}\\,\\mathrm{Pa}\\sqrt{\\mathrm{m}}\\right)^{2}$$\n$$G = \\frac{1 - 0.09}{200 \\times 10^{9}} \\left(1.0 \\times 10^{12}\\right)\\,\\mathrm{J/m^{2}}$$\n$$G = \\frac{0.91}{200} \\times 10^{3}\\,\\mathrm{J/m^{2}} = 4.55\\,\\mathrm{J/m^{2}}$$\n\n接下来，计算最小临界能量释放率 $G_{c}(\\theta^{\\ast})$：\n$$G_{c}(\\theta^{\\ast}) = G_{c}\\left(\\frac{\\pi}{4}\\right) = 2\\gamma_{0}(1 - c_{4} + c_{8})$$\n使用给定值 $\\gamma_{0} = 1.2\\,\\mathrm{J/m^{2}}$，$c_{4} = 0.3$ 和 $c_{8} = 0.05$：\n$$G_{c}(\\theta^{\\ast}) = 2(1.2\\,\\mathrm{J/m^{2}})(1 - 0.3 + 0.05)$$\n$$G_{c}(\\theta^{\\ast}) = 2.4(0.75)\\,\\mathrm{J/m^{2}} = 1.8\\,\\mathrm{J/m^{2}}$$\n\n最后，我们比较 $G$ 和 $G_{c}(\\theta^{\\ast})$：\n$$G = 4.55\\,\\mathrm{J/m^{2}}$$\n$$G_{c}(\\theta^{\\ast}) = 1.8\\,\\mathrm{J/m^{2}}$$\n由于 $4.55 > 1.8$，条件 $G \\geq G_{c}(\\theta^{\\ast})$ 得到满足。沿 $\\theta^{\\ast}$ 方向的裂纹扩展在能量上是允许的。\n\n优选的解理面由最小化 $G_c(\\theta)$ 的最小正角给出，即 $\\theta^{\\ast} = \\frac{\\pi}{4}$。",
            "answer": "$$\\boxed{\\frac{\\pi}{4}}$$"
        },
        {
            "introduction": "$J$-积分是断裂力学中一个用以量化能量释放率的强大工具，其一个关键的理论特性是路径无关性。本练习提供了一个动手编程的挑战，要求你基于近尖端渐近场来实现$J$-积分的数值计算。通过在不同积分路径上进行计算，你将能够数值化地验证路径无关性，从而在理论和计算实践之间建立起一座桥梁。",
            "id": "3785413",
            "problem": "给定一个线性弹性断裂力学（LEFM）场景，研究对象为包含尖锐裂纹的各向同性、均质材料，处于小应变、准静态条件下。裂纹尖端表现出近尖端奇异场。目标是计算能量释放率，即 $J$ 积分，并通过在围绕裂纹尖端的多个闭合围线上计算 $J$ 值来评估其路径无关性。\n\n从基本原理出发：\n- 应变能密度定义为 $W = \\tfrac{1}{2} \\,\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}\\left(\\sigma_{xx}\\,\\varepsilon_{xx} + \\sigma_{yy}\\,\\varepsilon_{yy} + 2\\,\\sigma_{xy}\\,\\varepsilon_{xy}\\right)$。\n- 在具有单位外法向量 $\\boldsymbol{n}$ 的围线上的牵引力矢量为 $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\cdot\\boldsymbol{n}$。\n- $J$ 积分表示沿裂纹扩展方向 $x_1$ 单位厚度上流入裂纹尖端的能量通量，由能量-动量守恒定律推导出的围线积分表示。\n\n对于数值计算，使用围绕裂纹尖端的圆形围线参数化，半径为 $R$，极角为 $\\theta$，其中外法向量为 $\\boldsymbol{n} = [\\cos\\theta,\\sin\\theta]$，线元为 $ds = R\\,d\\theta$。通过 I 型近尖端位移渐近解 $\\boldsymbol{u} = [u_x,u_y]$ 计算围线上的场量，然后通过线性弹性理论获得位移梯度 $\\partial u_i/\\partial x_j$、应变 $\\boldsymbol{\\varepsilon}$ 和应力 $\\boldsymbol{\\sigma}$，最后利用围线定义沿每条围线组装 $J$ 积分。\n\n您的程序必须：\n1. 实现上述基于原理的数值方法，在以裂纹尖端为中心的多个不同半径 $R$ 的圆形围线上计算 $J$ 值。\n2. 根据每个测试用例的指定，使用平面应力或平面应变假设。对于平面应变，使用 Lamé 参数 $\\lambda$ 和 $\\mu$；对于平面应力，使用二维弹性关系。\n3. 通过计算不同围线上 $J$ 值的变异系数来量化路径无关性，定义为 $\\mathrm{CV} = \\sigma_J / \\overline{J}$，其中 $\\sigma_J$ 是这组 $J$ 值的标准差，$\\overline{J}$ 是这组 $J$ 值的平均值。\n\n物理和数值设置：\n- 材料是各向同性的，具有杨氏模量 $E$ 和泊松比 $\\nu$。\n- 指定了 I 型应力强度因子 $K_I$。\n- 厚度为单位1；内部以 $\\mathrm{N}/\\mathrm{m}$ 为单位报告 $J$ 值，但最终程序输出应仅为每个测试用例的无量纲变异系数值。\n- 角度以弧度为单位。\n\n测试套件：\n- 用例 1：平面应变，其中 $E = 210\\,\\mathrm{GPa}$，$\\nu = 0.3$，$K_I = 50\\,\\mathrm{MPa}\\sqrt{\\mathrm{m}}$，围线半径 $R = [0.01, 0.02, 0.04]\\,\\mathrm{m}$，使用 $N_\\theta = 400$ 个求积点。\n- 用例 2：平面应力，其中 $E = 70\\,\\mathrm{GPa}$，$\\nu = 0.33$，$K_I = 30\\,\\mathrm{MPa}\\sqrt{\\mathrm{m}}$，围线半径 $R = [0.005, 0.015, 0.03]\\,\\mathrm{m}$，使用 $N_\\theta = 240$ 个求积点。\n- 用例 3：平面应变，其中 $E = 100\\,\\mathrm{GPa}$，$\\nu = 0.45$，$K_I = 10\\,\\mathrm{MPa}\\sqrt{\\mathrm{m}}$，围线半径 $R = [0.002, 0.004, 0.008]\\,\\mathrm{m}$，使用 $N_\\theta = 120$ 个求积点。\n\n您的程序应生成单行输出，其中包含三个用例的变异系数值，格式为方括号内的逗号分隔列表，例如 $[v_1,v_2,v_3]$，其中每个 $v_i$ 是一个浮点数。\n\n单位约定和转换：\n- 将 $E$ 从 $\\mathrm{GPa}$ 转换为 $\\mathrm{Pa}$。\n- 将 $K_I$ 从 $\\mathrm{MPa}\\sqrt{\\mathrm{m}}$ 转换为 $\\mathrm{Pa}\\sqrt{\\mathrm{m}}$。\n- 内部以 $\\mathrm{N}/\\mathrm{m}$ 为单位计算 $J$；然而，最终输出是每个用例的无量纲变异系数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔结果列表（例如，$[result1,result2,result3]$）。",
            "solution": "我们推导了一个数值方法，用于计算裂纹尖端周围的 $J$ 积分，并使用多个围线来评估其路径无关性。该推导从能量守恒和 $J$ 积分作为能量通量数量的定义开始。\n\n基本原理和定义：\n1. 考虑一个在各向同性、均质、线性弹性材料中的裂纹，处于小应变和准静态条件下，如线性弹性断裂力学（LEFM）所述。应变张量为 $\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}\\left(\\nabla\\boldsymbol{u} + (\\nabla\\boldsymbol{u})^\\top\\right)$，柯西应力张量 $\\boldsymbol{\\sigma}$ 通过各向同性弹性的 Hooke 定律与应变相关。应变能密度为 $W = \\tfrac{1}{2}\\,\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}$。\n2. 在具有单位外法向量 $\\boldsymbol{n}$ 的围线上的牵引力矢量为 $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\cdot\\boldsymbol{n}$。\n3. $J$ 积分定义为沿 $x_1$（裂纹扩展）方向单位扩展长度上流入裂纹尖端的能量通量。根据能量-动量张量推导（由 Eshelby/Rice 提出），可得到一个路径无关的围线积分：\n$$\nJ \\;=\\; \\oint_\\Gamma \\left( W\\,n_1 \\;-\\; \\sigma_{ij}\\,\\frac{\\partial u_i}{\\partial x_1}\\,n_j \\right) \\, ds,\n$$\n其中 $n_1$ 是单位法向量 $\\boldsymbol{n}$ 的第一个分量，索引 $i,j\\in\\{1,2\\}$ 指的是笛卡尔分量，$ds$ 是环绕裂纹尖端的围线 $\\Gamma$ 上的线元。\n\nI 型近尖端渐近场：\n我们使用经典的 I 型位移近尖端渐近解，该解在以裂纹尖端为中心的极坐标系 $(r,\\theta)$ 中表示，裂纹沿负 x 轴分布，$x$ 方向为裂纹扩展方向。位移分量 $u_x(r,\\theta)$ 和 $u_y(r,\\theta)$ 由下式给出：\n$$\nu_x(r,\\theta) \\;=\\; \\frac{K_I}{E'}\\,\\sqrt{\\frac{r}{2\\pi}}\\,\\cos\\!\\left(\\frac{\\theta}{2}\\right)\\,\\left(\\kappa \\;-\\; \\cos\\theta\\right),\n$$\n$$\nu_y(r,\\theta) \\;=\\; \\frac{K_I}{E'}\\,\\sqrt{\\frac{r}{2\\pi}}\\,\\sin\\!\\left(\\frac{\\theta}{2}\\right)\\,\\left(\\kappa \\;-\\; \\cos\\theta\\right),\n$$\n其中 $K_I$ 是 I 型应力强度因子，$E'$ 是有效模量，$\\kappa$ 是 Kolosov 常数。对于平面应变，$E' = \\dfrac{E}{1-\\nu^2}$ 且 $\\kappa = 3 - 4\\nu$；对于平面应力，$E' = E$ 且 $\\kappa = \\dfrac{3 - \\nu}{1 + \\nu}$。这些表达式经过了充分检验，是 LEFM 中近尖端近似法的基础。\n\n场梯度和本构关系：\n为了计算围线积分，我们需要位移的空间导数。我们先计算在极坐标系下的偏导数，然后通过链式法则将其映射到笛卡尔坐标系下的导数。令\n$$\nA(r) \\;=\\; \\frac{K_I}{E'}\\,\\sqrt{\\frac{r}{2\\pi}}, \\quad \\frac{\\partial A}{\\partial r} \\;=\\; \\frac{K_I}{E'}\\,\\frac{1}{2\\sqrt{2\\pi r}},\n$$\n并定义公因子 $C(\\theta) = \\kappa - \\cos\\theta$。极坐标偏导数为\n$$\n\\frac{\\partial u_x}{\\partial r} \\;=\\; \\frac{\\partial A}{\\partial r} \\,\\cos\\!\\left(\\frac{\\theta}{2}\\right)\\,C(\\theta),\n\\quad\n\\frac{\\partial u_x}{\\partial \\theta} \\;=\\; A(r)\\,\\left(\\,-\\tfrac{1}{2}\\sin\\!\\left(\\frac{\\theta}{2}\\right) C(\\theta) \\;+\\; \\cos\\!\\left(\\frac{\\theta}{2}\\right)\\sin\\theta \\right),\n$$\n$$\n\\frac{\\partial u_y}{\\partial r} \\;=\\; \\frac{\\partial A}{\\partial r} \\,\\sin\\!\\left(\\frac{\\theta}{2}\\right)\\,C(\\theta),\n\\quad\n\\frac{\\partial u_y}{\\partial \\theta} \\;=\\; A(r)\\,\\left(\\,\\tfrac{1}{2}\\cos\\!\\left(\\frac{\\theta}{2}\\right) C(\\theta) \\;+\\; \\sin\\!\\left(\\frac{\\theta}{2}\\right)\\sin\\theta \\right).\n$$\n极坐标到笛卡尔坐标的导数转换使用\n$$\n\\frac{\\partial r}{\\partial x} \\;=\\; \\cos\\theta, \\quad \\frac{\\partial r}{\\partial y} \\;=\\; \\sin\\theta,\n\\quad\n\\frac{\\partial \\theta}{\\partial x} \\;=\\; -\\frac{\\sin\\theta}{r}, \\quad \\frac{\\partial \\theta}{\\partial y} \\;=\\; \\frac{\\cos\\theta}{r}.\n$$\n因此，\n$$\n\\frac{\\partial u_x}{\\partial x} \\;=\\; \\frac{\\partial u_x}{\\partial r}\\,\\cos\\theta \\;+\\; \\frac{\\partial u_x}{\\partial \\theta}\\,\\left(-\\frac{\\sin\\theta}{r}\\right),\n\\quad\n\\frac{\\partial u_x}{\\partial y} \\;=\\; \\frac{\\partial u_x}{\\partial r}\\,\\sin\\theta \\;+\\; \\frac{\\partial u_x}{\\partial \\theta}\\,\\left(\\frac{\\cos\\theta}{r}\\right),\n$$\n$$\n\\frac{\\partial u_y}{\\partial x} \\;=\\; \\frac{\\partial u_y}{\\partial r}\\,\\cos\\theta \\;+\\; \\frac{\\partial u_y}{\\partial \\theta}\\,\\left(-\\frac{\\sin\\theta}{r}\\right),\n\\quad\n\\frac{\\partial u_y}{\\partial y} \\;=\\; \\frac{\\partial u_y}{\\partial r}\\,\\sin\\theta \\;+\\; \\frac{\\partial u_y}{\\partial \\theta}\\,\\left(\\frac{\\cos\\theta}{r}\\right).\n$$\n\n应变分量则为\n$$\n\\varepsilon_{xx} \\;=\\; \\frac{\\partial u_x}{\\partial x}, \\quad\n\\varepsilon_{yy} \\;=\\; \\frac{\\partial u_y}{\\partial y}, \\quad\n\\varepsilon_{xy} \\;=\\; \\tfrac{1}{2}\\left(\\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x}\\right).\n$$\n对于平面应变，我们使用限制于平面应变的三维各向同性线性弹性理论：\n$$\n\\mu \\;=\\; \\frac{E}{2(1+\\nu)}, \\quad \\lambda \\;=\\; \\frac{E\\nu}{(1+\\nu)(1-2\\nu)},\n$$\n以及\n$$\n\\sigma_{xx} \\;=\\; 2\\mu\\,\\varepsilon_{xx} + \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy}), \\quad\n\\sigma_{yy} \\;=\\; 2\\mu\\,\\varepsilon_{yy} + \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy}), \\quad\n\\sigma_{xy} \\;=\\; 2\\mu\\,\\varepsilon_{xy}.\n$$\n对于平面应力，本构关系为\n$$\n\\sigma_{xx} \\;=\\; \\frac{E}{1-\\nu^2}\\left(\\varepsilon_{xx} + \\nu\\,\\varepsilon_{yy}\\right), \\quad\n\\sigma_{yy} \\;=\\; \\frac{E}{1-\\nu^2}\\left(\\varepsilon_{yy} + \\nu\\,\\varepsilon_{xx}\\right), \\quad\n\\sigma_{xy} \\;=\\; \\frac{E}{1+\\nu}\\,\\varepsilon_{xy}.\n$$\n应变能密度为\n$$\nW \\;=\\; \\tfrac{1}{2}\\left(\\sigma_{xx}\\,\\varepsilon_{xx} + \\sigma_{yy}\\,\\varepsilon_{yy} + 2\\,\\sigma_{xy}\\,\\varepsilon_{xy}\\right).\n$$\n\n围线积分的组装：\n对于半径为 $R$ 的圆形围线，通过 $\\theta\\in[-\\pi,\\pi)$ 进行参数化，单位法向量为 $\\boldsymbol{n} = [\\cos\\theta,\\sin\\theta]$，线元为 $ds = R\\,d\\theta$。牵引力矢量为\n$$\nt_x \\;=\\; \\sigma_{xx}\\cos\\theta + \\sigma_{xy}\\sin\\theta, \\quad\nt_y \\;=\\; \\sigma_{xy}\\cos\\theta + \\sigma_{yy}\\sin\\theta.\n$$\n$J$ 积分的被积函数是\n$$\n\\mathcal{I}(\\theta) \\;=\\; W\\,n_1 \\;-\\; \\left(t_x\\,\\frac{\\partial u_x}{\\partial x} + t_y\\,\\frac{\\partial u_y}{\\partial x}\\right),\n$$\n使用含 $N_\\theta$ 个点的梯形法则进行的数值近似为\n$$\nJ(R) \\;\\approx\\; \\sum_{k=1}^{N_\\theta} \\mathcal{I}(\\theta_k)\\,R\\,\\Delta\\theta, \\quad \\Delta\\theta = \\frac{2\\pi}{N_\\theta}, \\quad \\theta_k = -\\pi + (k-1)\\Delta\\theta.\n$$\n\n路径无关性评估：\n对指定集合中的每个半径 $R$ 计算 $J(R)$，并通过变异系数来量化其变化：\n$$\n\\mathrm{CV} \\;=\\; \\frac{\\sqrt{\\frac{1}{N}\\sum_{i=1}^N\\left(J(R_i) - \\overline{J}\\right)^2}}{\\overline{J}}, \\quad \\overline{J} = \\frac{1}{N}\\sum_{i=1}^N J(R_i).\n$$\n\n算法设计：\n1. 将 $E$ 从 $\\mathrm{GPa}$ 转换为 $\\mathrm{Pa}$，将 $K_I$ 从 $\\mathrm{MPa}\\sqrt{\\mathrm{m}}$ 转换为 $\\mathrm{Pa}\\sqrt{\\mathrm{m}}$。\n2. 对于每个测试用例和每个围线半径 $R$：\n   - 以 $N_\\theta$ 个均匀间隔的点遍历 $\\theta$。\n   - 使用近尖端渐近解在 $r=R$ 处计算 $u_x(r,\\theta)$ 和 $u_y(r,\\theta)$。\n   - 计算 $\\partial u_i/\\partial r$ 和 $\\partial u_i/\\partial \\theta$，然后通过链式法则映射到笛卡尔导数 $\\partial u_i/\\partial x$ 和 $\\partial u_i/\\partial y$。\n   - 使用相应的平面应力或平面应变本构关系组装应变和应力。\n   - 计算 $W$、$\\boldsymbol{t}$ 和被积函数 $\\mathcal{I}(\\theta)$。\n   - 沿围线进行数值积分以获得 $J(R)$。\n3. 对于每个测试用例，计算所有 $J(R)$ 值的变异系数。\n4. 将三个测试用例的变异系数值以单个列表的形式输出。\n\n关于真实性和边界情况的说明：\n- 非常小的半径 $R$ 会因梯度更强而增加对数值求积的敏感性；粗糙的角向离散化 $N_\\theta$ 可能会增加变异。\n- 平面应变中的高泊松比（例如 $\\nu = 0.45$）接近不可压缩行为，给数值计算带来挑战。\n\n最终程序为所提供的测试套件实现了此过程，并按要求格式打印用例 1、2 和 3 的变异系数。",
            "answer": "```python\nimport numpy as np\n\ndef kappa(mode: str, nu: float) - float:\n    \"\"\"Kolosov constant.\"\"\"\n    if mode == 'plane_stress':\n        return (3.0 - nu) / (1.0 + nu)\n    elif mode == 'plane_strain':\n        return 3.0 - 4.0 * nu\n    else:\n        raise ValueError(\"mode must be 'plane_stress' or 'plane_strain'\")\n\ndef effective_modulus(mode: str, E: float, nu: float) - float:\n    \"\"\"Effective modulus E' for Mode I scaling.\"\"\"\n    if mode == 'plane_stress':\n        return E\n    elif mode == 'plane_strain':\n        return E / (1.0 - nu**2)\n    else:\n        raise ValueError(\"mode must be 'plane_stress' or 'plane_strain'\")\n\ndef displacement_mode_I(K: float, Eprime: float, nu: float, mode: str, r: float, th: float):\n    \"\"\"Near-tip Mode I displacement field u_x, u_y in polar coordinates.\"\"\"\n    kap = kappa(mode, nu)\n    A = (K / Eprime) * np.sqrt(r / (2.0 * np.pi))\n    common = kap - np.cos(th)\n    ux = A * np.cos(th / 2.0) * common\n    uy = A * np.sin(th / 2.0) * common\n    return ux, uy\n\ndef displacement_partials(K: float, Eprime: float, nu: float, mode: str, r: float, th: float):\n    \"\"\"Partial derivatives of u_x and u_y w.r.t r and theta.\"\"\"\n    kap = kappa(mode, nu)\n    A = (K / Eprime) * np.sqrt(r / (2.0 * np.pi))\n    dA_dr = (K / Eprime) * (1.0 / (2.0 * np.sqrt(2.0 * np.pi * r)))\n    common = kap - np.cos(th)\n    # u_x\n    ux_r = dA_dr * np.cos(th / 2.0) * common\n    ux_th = A * (-0.5 * np.sin(th / 2.0) * common + np.cos(th / 2.0) * np.sin(th))\n    # u_y\n    uy_r = dA_dr * np.sin(th / 2.0) * common\n    uy_th = A * (0.5 * np.cos(th / 2.0) * common + np.sin(th / 2.0) * np.sin(th))\n    return ux_r, ux_th, uy_r, uy_th\n\ndef spatial_gradients(K: float, Eprime: float, nu: float, mode: str, r: float, th: float):\n    \"\"\"Compute spatial gradients: ux_x, ux_y, uy_x, uy_y at (r,theta).\"\"\"\n    ux_r, ux_th, uy_r, uy_th = displacement_partials(K, Eprime, nu, mode, r, th)\n    cos_th = np.cos(th)\n    sin_th = np.sin(th)\n    dr_dx, dr_dy = cos_th, sin_th\n    dth_dx = -sin_th / r\n    dth_dy = cos_th / r\n    ux_x = ux_r * dr_dx + ux_th * dth_dx\n    ux_y = ux_r * dr_dy + ux_th * dth_dy\n    uy_x = uy_r * dr_dx + uy_th * dth_dx\n    uy_y = uy_r * dr_dy + uy_th * dth_dy\n    return ux_x, ux_y, uy_x, uy_y\n\ndef strains_from_gradients(ux_x: float, ux_y: float, uy_x: float, uy_y: float):\n    \"\"\"Compute strain components from displacement gradients.\"\"\"\n    exx = ux_x\n    eyy = uy_y\n    exy = 0.5 * (ux_y + uy_x)\n    return exx, eyy, exy\n\ndef stresses_plane_strain(E: float, nu: float, exx: float, eyy: float, exy: float):\n    \"\"\"Plane strain stresses from strains.\"\"\"\n    mu = E / (2.0 * (1.0 + nu))\n    lam = E * nu / ((1.0 + nu) * (1.0 - 2.0 * nu))\n    tr = exx + eyy\n    sxx = 2.0 * mu * exx + lam * tr\n    syy = 2.0 * mu * eyy + lam * tr\n    sxy = 2.0 * mu * exy\n    return sxx, syy, sxy\n\ndef stresses_plane_stress(E: float, nu: float, exx: float, eyy: float, exy: float):\n    \"\"\"Plane stress stresses from strains.\"\"\"\n    Eps = E / (1.0 - nu**2)\n    sxx = Eps * (exx + nu * eyy)\n    syy = Eps * (eyy + nu * exx)\n    sxy = E / (1.0 + nu) * exy\n    return sxx, syy, sxy\n\ndef energy_density(sxx: float, syy: float, sxy: float, exx: float, eyy: float, exy: float):\n    \"\"\"Compute strain energy density W.\"\"\"\n    return 0.5 * (sxx * exx + syy * eyy + 2.0 * sxy * exy)\n\ndef traction_on_circle(sxx: float, syy: float, sxy: float, th: float):\n    \"\"\"Compute traction components on a circular contour with outward normal n=[cos, sin].\"\"\"\n    c = np.cos(th)\n    s = np.sin(th)\n    tx = sxx * c + sxy * s\n    ty = sxy * c + syy * s\n    return tx, ty\n\ndef compute_J_for_radius(E: float, nu: float, K: float, mode: str, R: float, n_theta: int):\n    \"\"\"Compute J integral around a circular contour of radius R.\"\"\"\n    Eprime = effective_modulus(mode, E, nu)\n    dth = 2.0 * np.pi / n_theta\n    J_sum = 0.0\n    # Loop over theta points\n    for k in range(n_theta):\n        th = -np.pi + k * dth\n        # Displacement gradients at (r=R,theta=th)\n        ux_x, ux_y, uy_x, uy_y = spatial_gradients(K, Eprime, nu, mode, R, th)\n        # Strains\n        exx, eyy, exy = strains_from_gradients(ux_x, ux_y, uy_x, uy_y)\n        # Stresses\n        if mode == 'plane_strain':\n            sxx, syy, sxy = stresses_plane_strain(E, nu, exx, eyy, exy)\n        else:\n            sxx, syy, sxy = stresses_plane_stress(E, nu, exx, eyy, exy)\n        # Energy density\n        W = energy_density(sxx, syy, sxy, exx, eyy, exy)\n        # Traction and integrand\n        tx, ty = traction_on_circle(sxx, syy, sxy, th)\n        nx = np.cos(th)\n        integrand = W * nx - (tx * ux_x + ty * uy_x)\n        J_sum += integrand\n    J = J_sum * R * dth\n    return J\n\ndef coefficient_of_variation(values: np.ndarray) - float:\n    mean = float(np.mean(values))\n    std = float(np.std(values))\n    # Avoid divide by zero; if mean is zero, return 0.0 if all values are zero, else inf.\n    if mean == 0.0:\n        return 0.0 if np.allclose(values, 0.0) else float('inf')\n    return std / mean\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: plane strain, E=210 GPa, nu=0.3, K_I=50 MPa sqrt(m), R=[0.01,0.02,0.04] m, N_theta=400\n        {\n            \"mode\": \"plane_strain\",\n            \"E_GPa\": 210.0,\n            \"nu\": 0.3,\n            \"K_MPa_sqrt_m\": 50.0,\n            \"radii_m\": [0.01, 0.02, 0.04],\n            \"n_theta\": 400,\n        },\n        # Case 2: plane stress, E=70 GPa, nu=0.33, K_I=30 MPa sqrt(m), R=[0.005,0.015,0.03] m, N_theta=240\n        {\n            \"mode\": \"plane_stress\",\n            \"E_GPa\": 70.0,\n            \"nu\": 0.33,\n            \"K_MPa_sqrt_m\": 30.0,\n            \"radii_m\": [0.005, 0.015, 0.03],\n            \"n_theta\": 240,\n        },\n        # Case 3: plane strain, E=100 GPa, nu=0.45, K_I=10 MPa sqrt(m), R=[0.002,0.004,0.008] m, N_theta=120\n        {\n            \"mode\": \"plane_strain\",\n            \"E_GPa\": 100.0,\n            \"nu\": 0.45,\n            \"K_MPa_sqrt_m\": 10.0,\n            \"radii_m\": [0.002, 0.004, 0.008],\n            \"n_theta\": 120,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        mode = case[\"mode\"]\n        E = case[\"E_GPa\"] * 1e9  # Pa\n        nu = case[\"nu\"]\n        K = case[\"K_MPa_sqrt_m\"] * 1e6  # Pa * sqrt(m)\n        radii = case[\"radii_m\"]\n        n_theta = case[\"n_theta\"]\n\n        J_values = []\n        for R in radii:\n            J_R = compute_J_for_radius(E, nu, K, mode, R, n_theta)\n            J_values.append(J_R)\n        J_values = np.array(J_values, dtype=float)\n        cv = coefficient_of_variation(J_values)\n        results.append(cv)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "经典的线性弹性断裂力学（LEFM）预测了一种特定的尺寸效应，即强度与特征尺寸$D$的-1/2次方成比例（$\\sigma \\propto D^{-1/2}$）。然而，这种关系在结构非常小或非常大时会失效，而非局部模型能够更好地捕捉这种过渡行为。本练习将通过一个包含材料内禀长度尺度$\\ell$的非局部损伤模型，让你探索尺寸效应，并揭示该模型如何弥合LEFM和与尺寸无关的强度准则之间的鸿沟。",
            "id": "3785435",
            "problem": "考虑一个特征尺寸为 $D$、承受远场均匀拉伸的几何相似单边缺口拉伸试件族。假设材料遵循小应变线弹性，其杨氏模量为 $E$，并采用一个基于非局部等效应变阈值的标量非局部损伤起始准则。目标是使用非局部损伤模型计算不同试件尺寸下的表观抗拉强度（即缺口根部开始发生损伤时的远场应力），并将该尺寸依赖性与线性弹性断裂力学（LEFM）预测的标度律进行比较。\n\n基本和模型假设：\n\n- 线弹性本构关系：局部应变 $ \\varepsilon $ 通过 $ \\sigma = E \\varepsilon $ 与局部应力 $ \\sigma $ 相关联，其中 $ E  0 $ 为常数。损伤起始由下文定义的非局部应变量控制。在损伤起始前，$ d = 0 $，因此材料响应是弹性的。\n- 非局部等效应变 $ \\bar{\\varepsilon}(\\mathbf{x}) $ 定义为局部等效应变 $ \\varepsilon(\\mathbf{y}) $ 在整个物体 $ \\Omega $ 上的空间平均，使用一个正的、径向衰减的核函数 $ w(r) $ 进行归一化，其中 $ r = \\lVert \\mathbf{x} - \\mathbf{y} \\rVert $。具体而言，\n$$\n\\bar{\\varepsilon}(\\mathbf{x}) = \\frac{\\int_{\\Omega} w(\\lVert \\mathbf{x} - \\mathbf{y} \\rVert) \\, \\varepsilon(\\mathbf{y}) \\, \\mathrm{d}\\mathbf{y}}{\\int_{\\Omega} w(\\lVert \\mathbf{x} - \\mathbf{y} \\rVert) \\, \\mathrm{d}\\mathbf{y}}.\n$$\n- 设非局部核函数为特征材料长度为 $ \\ell  0 $ 的指数函数，并且为了在缺口根部邻域内具有解析易处理性，将问题近似为沿缺口根部径向 $ r \\ge 0 $ 的一维问题。然后使用\n$$\nw(r) = \\frac{1}{\\ell} \\exp\\left(-\\frac{r}{\\ell}\\right), \\quad r \\ge 0,\n$$\n并将平均积分限制在缺口侧面的 $ r \\in [0,\\infty) $ 范围内。\n- 对于根部半径为 $ \\rho = \\eta D $（其中 $ \\eta \\in (0,1) $ 为固定的尖锐度参数）的几何相似缺口，在远场应力 $ \\sigma $ 作用下，沿缺口侧面的局部应变场可近似为\n$$\n\\varepsilon(r;D,\\sigma) = \\frac{\\sigma}{E} K_t \\, g\\!\\left(\\frac{r}{\\rho}\\right),\n$$\n其中 $ K_t  0 $ 是弹性应力集中系数（对于几何相似缺口，该值与 $ D $ 无关），$ g(\\xi) $ 是一个无量纲衰减函数，满足 $ g(0) = 1 $ 且 $ g(\\xi) $ 随 $ \\xi $ 单调递减。使用以下特定形式\n$$\ng\\!\\left(\\frac{r}{\\rho}\\right) = \\left(1 + \\frac{r}{\\rho}\\right)^{-\\frac{1}{2}},\n$$\n该形式对根部附近的场进行正则化，并产生有限的缺口根部应变。\n- 损伤起始准则为 $ \\bar{\\varepsilon}(0;D,\\sigma) = \\varepsilon_f $，其中 $ \\varepsilon_f  0 $ 是材料发生损伤的非局部应变阈值，$ \\bar{\\varepsilon}(0;D,\\sigma) $ 是在缺口根部 $ r = 0 $ 处计算的非局部等效应变。\n\n任务要求：\n\n1. 从上述定义出发，通过计算缺口根部处的一维非局部平均积分，推导表观抗拉强度 $ \\sigma_{\\text{app}}(D) $ 关于 $ E $、$ K_t $、$ \\varepsilon_f $、$ \\ell $、$ \\eta $ 和 $ D $ 的可计算表达式。您的推导必须基于带有指定核函数和衰减函数的积分表示，不得引入任何特设的简化公式。\n\n2. 为了进行比较，推导基于LEFM的几何相似裂纹试件的表观强度标度律，该试件裂纹长度为 $ a = \\alpha D $，应力强度因子（SIF）几何系数为 $ Y $，断裂韧性为 $ K_{IC} $。LEFM的预测为\n$$\n\\sigma_{\\text{LEFM}}(D) = \\frac{K_{IC}}{Y \\sqrt{\\pi a}} = \\frac{K_{IC}}{Y \\sqrt{\\pi \\alpha D}},\n$$\n其中 $ K_{IC} $ 是 I 型断裂韧性。\n\n3. 实现一个程序，对于所提供测试套件中的每个试件尺寸，计算：\n   - 非局部损伤模型的表观抗拉强度 $ \\sigma_{\\text{app}}(D) $，单位为兆帕（MPa）。\n   - LEFM预测的表观抗拉强度 $ \\sigma_{\\text{LEFM}}(D) $，单位为兆帕（MPa）。\n   程序应稳健地数值计算任何所需的积分，并能处理试件尺寸相对于材料长度 $ \\ell $ 很小或很大的情况。\n\n4. 在您的计算中使用以下科学上合理的材料和几何参数：\n   - 杨氏模量：$ E = 30000 $ MPa。\n   - 非局部应变阈值：$ \\varepsilon_f = 0.0002 $ (无量纲)。\n   - 非局部特征长度：$ \\ell = 0.05 $ m。\n   - 缺口尖锐度参数：$ \\eta = 0.01 $ (无量纲)，因此 $ \\rho = \\eta D $。\n   - 应力集中系数：$ K_t = 3.0 $ (无量纲)。\n   - LEFM参数：断裂韧性 $ K_{IC} = 1.0 $ MPa$\\sqrt{\\mathrm{m}}$，几何因子 $ Y = 1.12 $ (无量纲)，裂纹长度比例 $ \\alpha = 0.25 $ (无量纲)。\n\n5. 测试套件（试件尺寸，单位为米）：\n   - 小尺寸极端：$ D = 0.001 $ m。\n   - 小尺寸：$ D = 0.005 $ m。\n   - 接近材料长度：$ D = 0.05 $ m。\n   - 中等尺寸：$ D = 0.5 $ m。\n   - 大尺寸：$ D = 5.0 $ m。\n   - 非常大尺寸：$ D = 10.0 $ m。\n\n6. 输出规范：\n   - 将每个计算出的表观强度以兆帕（MPa）为单位表示为浮点数。\n   - 您的程序应生成单行输出，包含一个逗号分隔的列表的列表形式的结果，其中每个内部列表对应一个测试用例，形式为 $ [\\sigma_{\\text{app}}(D), \\sigma_{\\text{LEFM}}(D)] $。例如：$ [[x_1,y_1],[x_2,y_2],\\dots] $。\n   - 不应打印额外的文本或注释。\n\n科学真实性与讨论要求：\n\n- 在您的解决方案中，从第一性原理出发，解释非局部平均如何改变缺口附近的应变并引入材料长度 $ \\ell $，并分析 $ \\sigma_{\\text{app}}(D) $ 在 $ D \\ll \\ell $ 和 $ D \\gg \\ell $ 时的渐近行为。讨论其与经典线性弹性断裂力学（LEFM）标度律的偏差，并着重说明非局部预测在哪种范围内恢复 $ D^{-\\frac{1}{2}} $ 行为，以及在何处偏离为近似与尺寸无关的强度。",
            "solution": "该问题陈述经评估是有效的。它在科学上基于连续介质损伤力学和线性弹性断裂力学的原理，其定义和参数完整且一致，问题是适定的，并且以客观、正式的语言表述。该任务具有一定难度，需要进行数学推导、数值实现以及对结果的科学分析。\n\n### 1. 非局部表观强度 $\\sigma_{\\text{app}}(D)$ 的推导\n\n分析始于损伤起始准则，该准则指出，当缺口根部（$r=0$）的非局部等效应变 $\\bar{\\varepsilon}$ 达到临界材料阈值 $\\varepsilon_f$ 时，失效开始。\n$$\n\\bar{\\varepsilon}(0;D,\\sigma_{\\text{app}}) = \\varepsilon_f\n$$\n非局部等效应变 $\\bar{\\varepsilon}(\\mathbf{x})$ 定义为局部等效应变场 $\\varepsilon(\\mathbf{y})$ 的加权平均。对于沿缺口根部侧面（$r \\ge 0$）的一维近似，设 $\\mathbf{x}=0$ 和 $\\mathbf{y}=r$，表达式变为：\n$$\n\\bar{\\varepsilon}(0) = \\frac{\\int_{0}^{\\infty} w(r) \\, \\varepsilon(r) \\, dr}{\\int_{0}^{\\infty} w(r) \\, dr}\n$$\n指定的权重函数是指数核函数 $w(r) = \\frac{1}{\\ell} \\exp\\left(-\\frac{r}{\\ell}\\right)$。首先，我们计算分母中的归一化积分：\n$$\n\\int_{0}^{\\infty} w(r) \\, dr = \\int_{0}^{\\infty} \\frac{1}{\\ell} \\exp\\left(-\\frac{r}{\\ell}\\right) \\, dr = \\left[ -\\exp\\left(-\\frac{r}{\\ell}\\right) \\right]_{0}^{\\infty} = 0 - (-1) = 1\n$$\n由于核函数已恰当归一化，缺口根部的非局部应变简化为：\n$$\n\\bar{\\varepsilon}(0) = \\int_{0}^{\\infty} w(r) \\, \\varepsilon(r) \\, dr\n$$\n现在我们代入核函数 $w(r)$ 和局部应变场 $\\varepsilon(r;D,\\sigma) = \\frac{\\sigma}{E} K_t (1 + \\frac{r}{\\rho})^{-\\frac{1}{2}}$ 的表达式，其中 $\\rho = \\eta D$：\n$$\n\\bar{\\varepsilon}(0;D,\\sigma) = \\int_{0}^{\\infty} \\frac{1}{\\ell} \\exp\\left(-\\frac{r}{\\ell}\\right) \\left[ \\frac{\\sigma}{E} K_t \\left(1 + \\frac{r}{\\rho}\\right)^{-\\frac{1}{2}} \\right] dr\n$$\n提出相对于积分变量 $r$ 为常数的项，我们得到：\n$$\n\\bar{\\varepsilon}(0;D,\\sigma) = \\frac{\\sigma K_t}{E \\ell} \\int_{0}^{\\infty} \\exp\\left(-\\frac{r}{\\ell}\\right) \\left(1 + \\frac{r}{\\rho}\\right)^{-\\frac{1}{2}} dr\n$$\n设该积分为 $I(\\rho, \\ell)$。为了求解它，我们进行变量替换。令 $u^2 = 1 + \\frac{r}{\\rho}$。这意味着 $r = \\rho(u^2 - 1)$ 且 $dr = 2\\rho u \\, du$。积分限从 $r \\in [0, \\infty)$ 变为 $u \\in [1, \\infty)$。\n$$\nI(\\rho, \\ell) = \\int_{1}^{\\infty} \\exp\\left(-\\frac{\\rho(u^2 - 1)}{\\ell}\\right) (u^2)^{-\\frac{1}{2}} (2\\rho u \\, du)\n$$\n$$\nI(\\rho, \\ell) = \\int_{1}^{\\infty} \\exp\\left(\\frac{\\rho}{\\ell}\\right) \\exp\\left(-\\frac{\\rho u^2}{\\ell}\\right) u^{-1} (2\\rho u \\, du) = 2\\rho \\exp\\left(\\frac{\\rho}{\\ell}\\right) \\int_{1}^{\\infty} \\exp\\left(-\\frac{\\rho u^2}{\\ell}\\right) du\n$$\n剩余的积分与互补误差函数 $\\text{erfc}(x) = \\frac{2}{\\sqrt{\\pi}} \\int_x^{\\infty} e^{-t^2} dt$ 相关。我们引入另一个替换：令 $t = u \\sqrt{\\frac{\\rho}{\\ell}}$，则 $du = \\sqrt{\\frac{\\ell}{\\rho}} dt$。积分下限变为 $u=1 \\implies t=\\sqrt{\\frac{\\rho}{\\ell}}$。\n$$\n\\int_{1}^{\\infty} \\exp\\left(-\\frac{\\rho u^2}{\\ell}\\right) du = \\int_{\\sqrt{\\rho/\\ell}}^{\\infty} \\exp(-t^2) \\sqrt{\\frac{\\ell}{\\rho}} dt = \\sqrt{\\frac{\\ell}{\\rho}} \\left( \\frac{\\sqrt{\\pi}}{2} \\text{erfc}\\left(\\sqrt{\\frac{\\rho}{\\ell}}\\right) \\right)\n$$\n将此代回 $I(\\rho, \\ell)$ 的表达式中：\n$$\nI(\\rho, \\ell) = 2\\rho \\exp\\left(\\frac{\\rho}{\\ell}\\right) \\left[ \\sqrt{\\frac{\\ell}{\\rho}} \\frac{\\sqrt{\\pi}}{2} \\text{erfc}\\left(\\sqrt{\\frac{\\rho}{\\ell}}\\right) \\right] = \\sqrt{\\pi \\rho \\ell} \\exp\\left(\\frac{\\rho}{\\ell}\\right) \\text{erfc}\\left(\\sqrt{\\frac{\\rho}{\\ell}}\\right)\n$$\n现在，我们应用损伤起始准则 $\\bar{\\varepsilon}(0;D,\\sigma_{\\text{app}}) = \\varepsilon_f$，并设 $\\sigma = \\sigma_{\\text{app}}(D)$：\n$$\n\\varepsilon_f = \\frac{\\sigma_{\\text{app}}(D) K_t}{E \\ell} I(\\rho, \\ell)\n$$\n求解表观强度 $\\sigma_{\\text{app}}(D)$：\n$$\n\\sigma_{\\text{app}}(D) = \\frac{E \\varepsilon_f \\ell}{K_t I(\\rho, \\ell)} = \\frac{E \\varepsilon_f \\ell}{K_t \\sqrt{\\pi \\rho \\ell} \\exp\\left(\\frac{\\rho}{\\ell}\\right) \\text{erfc}\\left(\\sqrt{\\frac{\\rho}{\\ell}}\\right)}\n$$\n代入 $\\rho = \\eta D$ 并化简，我们得到基于非局部模型的表观强度的最终表达式：\n$$\n\\sigma_{\\text{app}}(D) = \\frac{E \\varepsilon_f}{K_t} \\frac{\\sqrt{\\ell / (\\pi \\eta D)}}{ \\exp\\left(\\frac{\\eta D}{\\ell}\\right) \\text{erfc}\\left(\\sqrt{\\frac{\\eta D}{\\ell}}\\right)}\n$$\n为了数值稳定性，使用标度互补误差函数 $\\text{erfcx}(x) = \\exp(x^2)\\text{erfc}(x)$ 是有利的。令 $x = \\sqrt{\\eta D/\\ell}$，表达式变为：\n$$\n\\sigma_{\\text{app}}(D) = \\frac{E \\varepsilon_f}{K_t} \\frac{\\sqrt{\\ell / (\\pi \\eta D)}}{\\text{erfcx}\\left(\\sqrt{\\frac{\\eta D}{\\ell}}\\right)}\n$$\n\n### 2. LEFM 表观强度标度律 $\\sigma_{\\text{LEFM}}(D)$\n\n线性弹性断裂力学（LEFM）假定，当应力强度因子 $K_I$ 达到临界材料属性，即断裂韧性 $K_{IC}$ 时，发生断裂。对于一个包含长度为 $a$ 的裂纹并在远场应力 $\\sigma$ 下的试件，应力强度因子由 $K_I = \\sigma Y \\sqrt{\\pi a}$ 给出，其中 $Y$ 是一个无量纲的几何因子。对于几何相似的试件，我们有 $a = \\alpha D$。\nLEFM 的失效准则是 $K_I = K_{IC}$，这导致：\n$$\n\\sigma_{\\text{LEFM}}(D) Y \\sqrt{\\pi (\\alpha D)} = K_{IC}\n$$\n求解表观强度 $\\sigma_{\\text{LEFM}}(D)$，得到著名的标度律：\n$$\n\\sigma_{\\text{LEFM}}(D) = \\frac{K_{IC}}{Y \\sqrt{\\pi \\alpha D}}\n$$\n这预测了强度与特征尺寸的平方根成反比，即 $\\sigma_{\\text{LEFM}} \\propto D^{-1/2}$。\n\n### 3. 科学讨论与渐近分析\n\n引入具有特征长度 $\\ell$ 的非局部平均，对应力集中处的断裂起始问题进行了正则化。失效不再由无限应力的奇点（如尖锐裂纹）或某一点的最大应力（如局部缺口分析）决定，而是由一个有限材料体积内的应变状态控制。这种物理正则化引入了与结构尺寸 $D$ 相竞争的材料长度尺度 $\\ell$，从而产生了尺寸效应。\n\n我们通过考察自变量 $x = \\sqrt{\\eta D/\\ell}$ 来分析 $\\sigma_{\\text{app}}(D)$ 的渐近行为。\n\n**情况1：大试件 ($D \\gg \\ell/\\eta \\implies x \\to \\infty$)**\n对于大自变量，标度互补误差函数具有渐近展开 $\\text{erfcx}(x) \\sim \\frac{1}{x\\sqrt{\\pi}}$。\n$$\n\\lim_{D\\to\\infty} \\sigma_{\\text{app}}(D) = \\frac{E \\varepsilon_f}{K_t} \\lim_{x\\to\\infty} \\frac{1/(x\\sqrt{\\pi})}{1/(x\\sqrt{\\pi})} = \\frac{E \\varepsilon_f}{K_t}\n$$\n在此极限下，表观强度变得与尺寸无关。这对应于经典的材料强度准则，即当最大局部应力 $\\sigma_{\\text{max}} = K_t \\sigma_{\\text{app}}$ 达到材料强度极限 $\\sigma_0 = E\\varepsilon_f$ 时发生失效。对于非常大的结构，非局部区域 $\\ell$ 与几何尺寸相比可以忽略不计，模型收敛到局部失效理论。\n\n**情况2：小试件 ($D \\ll \\ell/\\eta \\implies x \\to 0$)**\n对于小自变量，$\\text{erfcx}(x) \\approx 1$。\n$$\n\\lim_{D\\to 0} \\sigma_{\\text{app}}(D) \\approx \\frac{E \\varepsilon_f}{K_t} \\frac{\\sqrt{\\ell / (\\pi \\eta D)}}{1} = \\left( \\frac{E \\varepsilon_f}{K_t} \\sqrt{\\frac{\\ell}{\\pi \\eta}} \\right) D^{-1/2}\n$$\n在此极限下，非局部表观强度表现出 $D^{-1/2}$ 的标度律，这是LEFM的特征标志。当试件相对于材料长度尺度很小时，钝缺口的行为等效于尖锐裂纹，模型恢复了LEFM的尺寸效应。\n\n总之，非局部损伤模型提供了一个统一的框架，弥合了两种经典失效理论之间的差距。它从适用于小结构的类LEFM行为过渡到适用于大结构的与尺寸无关的强度准则。这一过渡由一个依赖于几何的长度尺度 $\\rho = \\eta D$ 与内禀材料长度尺度 $\\ell$ 的无量纲比值控制。",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import erfcx\n\ndef solve():\n    \"\"\"\n    Computes apparent tensile strength using a nonlocal damage model and LEFM\n    for a range of specimen sizes.\n    \"\"\"\n    # Material and geometry parameters\n    E = 30000.0   # Young's modulus [MPa]\n    eps_f = 0.0002  # Nonlocal strain threshold [dimensionless]\n    l = 0.05      # Nonlocal characteristic length [m]\n    eta = 0.01      # Notch acuity parameter [dimensionless]\n    K_t = 3.0       # Stress concentration factor [dimensionless]\n    \n    # LEFM parameters\n    K_IC = 1.0    # Fracture toughness [MPa*m^0.5]\n    Y = 1.12      # SIF geometry coefficient [dimensionless]\n    alpha = 0.25    # Crack-length proportion [dimensionless]\n\n    # Test suite of specimen sizes [m]\n    test_cases = [0.001, 0.005, 0.05, 0.5, 5.0, 10.0]\n\n    results = []\n\n    for D in test_cases:\n        # --- Nonlocal Damage Model Calculation ---\n        \n        # Derived expression for apparent strength sigma_app(D)\n        # sigma_app(D) = (E * eps_f / K_t) * (sqrt(l / (pi * eta * D)) / erfcx(sqrt(eta * D / l)))\n        \n        rho = eta * D\n        \n        # Argument for the scaled complementary error function\n        x = np.sqrt(rho / l)\n        \n        # Numerator term from the derived formula\n        numerator_term = np.sqrt(l / (np.pi * rho))\n        \n        # The scaled complementary error function erfcx(x) = exp(x^2)*erfc(x)\n        # is used for numerical stability, especially for large x where exp(x^2)\n        # would overflow and erfc(x) would underflow.\n        erfcx_val = erfcx(x)\n        \n        sigma_app = (E * eps_f / K_t) * (numerator_term / erfcx_val)\n        \n        # --- LEFM Calculation ---\n        \n        # LEFM predicted apparent strength sigma_lefm(D)\n        # sigma_lefm(D) = K_IC / (Y * sqrt(pi * alpha * D))\n        \n        a = alpha * D\n        sigma_lefm = K_IC / (Y * np.sqrt(np.pi * a))\n        \n        results.append([sigma_app, sigma_lefm])\n\n    # Format the output as a string representation of a list of lists.\n    # e.g., [[val1_1, val1_2], [val2_1, val2_2]]\n    output_str = \"[\" + \",\".join([f\"[{res[0]},{res[1]}]\" for res in results]) + \"]\"\n\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}