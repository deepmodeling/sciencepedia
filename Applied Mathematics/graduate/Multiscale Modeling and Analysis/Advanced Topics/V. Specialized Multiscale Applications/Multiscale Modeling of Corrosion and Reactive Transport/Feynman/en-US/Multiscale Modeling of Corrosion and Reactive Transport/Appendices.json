{
    "hands_on_practices": [
        {
            "introduction": "A foundational concept in electrochemistry is the direct relationship between the flow of charge and the extent of chemical transformation. This practice grounds this principle in the context of passivation, where a protective oxide film grows on a metal surface. By applying fundamental laws under galvanostatic (constant current) conditions, you will derive the time required to grow a film of a specific thickness and the associated electrical potential drop across it, reinforcing the quantitative link between macroscopic control and microscopic evolution .",
            "id": "3785072",
            "problem": "A planar iron electrode in an aqueous environment is driven galvanostatically at a constant anodic current density such that a compact hematite passive film (chemical formula iron(III) oxide, $\\mathrm{Fe_{2}O_{3}}$) grows uniformly on its surface. Assume one-dimensional growth, isothermal conditions, negligible space-charge effects, and $100\\%$ current efficiency for oxide formation (no concurrent dissolution or gas evolution). The film is fully dense with constant properties and the solution ohmic drop is negligible relative to the film.\n\nStarting only from Faraday’s law of electrolysis and mass conservation, and from Ohm’s law for electronic conduction in the passive film, derive a relation for the time to reach a prescribed film thickness and for the ohmic overpotential across the film at that thickness. Then evaluate both for the following data:\n\n- Applied current density: $i_{\\mathrm{app}} = 5~\\mathrm{mA/cm^{2}}$.\n- Target film thickness: $L^{\\star} = 5~\\mathrm{nm}$.\n- Film molar mass (hematite): $M_{\\mathrm{ox}} = 0.1597~\\mathrm{kg/mol}$.\n- Film mass density: $\\rho_{\\mathrm{ox}} = 5.240 \\times 10^{3}~\\mathrm{kg/m^{3}}$.\n- Electrons per mole of $\\mathrm{Fe_{2}O_{3}}$ formed: $n = 6$.\n- Faraday constant: $F = 96485~\\mathrm{C/mol}$.\n- Film electrical resistivity (effective, homogeneous): $\\varrho_{f} = 1.0 \\times 10^{6}~\\Omega \\cdot \\mathrm{m}$.\n\nInstructions:\n- Use Faraday’s law and mass conservation to obtain an expression for the time $t(L)$ to reach thickness $L$ under constant $i_{\\mathrm{app}}$, and compute $t(L^{\\star})$ in seconds.\n- Use Ohm’s law to obtain the expression for the additional overpotential due to the film, $\\eta_{\\mathrm{film}}(L)$, and compute $\\eta_{\\mathrm{film}}(L^{\\star})$ in volts.\n- Express the final reported answer as the overpotential increase $\\eta_{\\mathrm{film}}(L^{\\star})$ in volts, rounded to four significant figures. If you choose to report the time as an intermediate result, express it in seconds, but only the overpotential increase should be reported as the final answer.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in the principles of electrochemistry (Faraday's law, Ohm's law) and mass conservation. The problem is well-posed, providing all necessary data and clear, objective instructions to derive a unique solution for the specified physical scenario of galvanostatic film growth. The provided parameters are physically realistic for the corrosion and passivation of iron.\n\nThe solution is developed in two parts as requested: first, the derivation of the time $t$ to grow a film of thickness $L$, and second, the derivation of the ohmic overpotential $\\eta_{\\mathrm{film}}$ across that film.\n\n**Part 1: Time to Reach a Prescribed Film Thickness**\n\nThe growth of the oxide film is an electrochemical reaction governed by Faraday's law of electrolysis, which relates the amount of substance produced to the total electric charge passed. Faraday's law is given by:\n$$\nQ = n F N_{\\mathrm{ox}}\n$$\nwhere $Q$ is the total charge passed, $n$ is the number of moles of electrons transferred per mole of oxide formed (given as $n=6$), $F$ is the Faraday constant, and $N_{\\mathrm{ox}}$ is the number of moles of the oxide ($\\mathrm{Fe_{2}O_{3}}$) formed.\n\nThe process is galvanostatic, meaning it occurs at a constant applied current density, $i_{\\mathrm{app}}$. For a planar electrode of area $A$, the total current is $I = i_{\\mathrm{app}} A$. The total charge passed over a time $t$ is:\n$$\nQ(t) = I t = i_{\\mathrm{app}} A t\n$$\nEquating the two expressions for $Q$ gives:\n$$\ni_{\\mathrm{app}} A t = n F N_{\\mathrm{ox}}\n$$\nNext, we use mass conservation to relate the number of moles of oxide, $N_{\\mathrm{ox}}$, to the film thickness, $L$. Assuming a uniform film of thickness $L$ grown on the area $A$, the volume of the oxide film is $V_{\\mathrm{ox}} = A L$.\n\nThe mass of the oxide, $m_{\\mathrm{ox}}$, is the product of its volume and mass density, $\\rho_{\\mathrm{ox}}$:\n$$\nm_{\\mathrm{ox}} = \\rho_{\\mathrm{ox}} V_{\\mathrm{ox}} = \\rho_{\\mathrm{ox}} A L\n$$\nThe number of moles of oxide is the mass divided by the molar mass of the oxide, $M_{\\mathrm{ox}}$:\n$$\nN_{\\mathrm{ox}} = \\frac{m_{\\mathrm{ox}}}{M_{\\mathrm{ox}}} = \\frac{\\rho_{\\mathrm{ox}} A L}{M_{\\mathrm{ox}}}\n$$\nSubstituting this expression for $N_{\\mathrm{ox}}$ back into the equation derived from Faraday's law:\n$$\ni_{\\mathrm{app}} A t = n F \\left( \\frac{\\rho_{\\mathrm{ox}} A L}{M_{\\mathrm{ox}}} \\right)\n$$\nThe area $A$ is a common factor on both sides and cancels out. This is expected as the problem is one-dimensional and all intensive quantities are defined per unit area.\n$$\ni_{\\mathrm{app}} t = \\frac{n F \\rho_{\\mathrm{ox}} L}{M_{\\mathrm{ox}}}\n$$\nSolving for the time $t$ as a function of thickness $L$, we obtain the desired relation:\n$$\nt(L) = \\left( \\frac{n F \\rho_{\\mathrm{ox}}}{M_{\\mathrm{ox}}} \\right) \\frac{L}{i_{\\mathrm{app}}}\n$$\nThis linear relationship between $t$ and $L$ indicates a constant growth rate, $dL/dt$, under galvanostatic conditions.\n\nWe now compute the time $t(L^{\\star})$ to reach the target thickness $L^{\\star} = 5~\\mathrm{nm}$. First, all given parameters must be converted to a consistent system of units (SI units):\n- $i_{\\mathrm{app}} = 5~\\mathrm{mA/cm^{2}} = 5 \\times 10^{-3}~\\mathrm{A/(10^{-2}~m)^{2}} = 5 \\times 10^{-3}~\\mathrm{A/10^{-4}~m^{2}} = 50~\\mathrm{A/m^{2}}$\n- $L^{\\star} = 5~\\mathrm{nm} = 5 \\times 10^{-9}~\\mathrm{m}$\n- $M_{\\mathrm{ox}} = 0.1597~\\mathrm{kg/mol}$\n- $\\rho_{\\mathrm{ox}} = 5.240 \\times 10^{3}~\\mathrm{kg/m^{3}}$\n- $n = 6$\n- $F = 96485~\\mathrm{C/mol}$\n\nSubstituting these values into the expression for $t(L^{\\star})$:\n$$\nt(L^{\\star}) = \\frac{(6)(96485~\\mathrm{C/mol})(5.240 \\times 10^{3}~\\mathrm{kg/m^{3}})(5 \\times 10^{-9}~\\mathrm{m})}{(0.1597~\\mathrm{kg/mol})(50~\\mathrm{A/m^{2}})}\n$$\n$$\nt(L^{\\star}) = \\frac{15.167502~\\mathrm{C \\cdot kg \\cdot m / (mol \\cdot m^3)}}{7.985~\\mathrm{A \\cdot kg / (mol \\cdot m^2)}} = \\frac{15.167502~\\mathrm{C/m^2}}{7.985~\\mathrm{A/m^2}}\n$$\nSince $1~\\mathrm{C} = 1~\\mathrm{A \\cdot s}$:\n$$\nt(L^{\\star}) = \\frac{15.167502}{7.985}~\\mathrm{s} \\approx 1.89950~\\mathrm{s}\n$$\nAs an intermediate result, the time to reach the target thickness is approximately $1.900~\\mathrm{s}$.\n\n**Part 2: Ohmic Overpotential Across the Film**\n\nThe ohmic overpotential, $\\eta_{\\mathrm{film}}$, is the potential drop across the resistive passive film due to the flow of current. It can be derived from Ohm's law in its continuum form:\n$$\n\\vec{E} = \\varrho_{f} \\vec{j}\n$$\nwhere $\\vec{E}$ is the electric field vector, $\\varrho_{f}$ is the electrical resistivity of the film, and $\\vec{j}$ is the current density vector.\n\nThe problem assumptions simplify this relation. With one-dimensional current flow perpendicular to the planar electrode surface and constant film properties, the vectors become scalars:\n$$\nE = \\varrho_{f} i_{\\mathrm{app}}\n$$\nThe electric field $E$ is uniform throughout the film thickness. The potential drop (overpotential) across a film of thickness $L$ is the integral of the electric field over the path length, which for a uniform field simplifies to:\n$$\n\\eta_{\\mathrm{film}}(L) = E \\cdot L\n$$\nSubstituting the expression for $E$, we get the relation for the overpotential as a function of film thickness:\n$$\n\\eta_{\\mathrm{film}}(L) = \\varrho_{f} i_{\\mathrm{app}} L\n$$\nWe can now compute the overpotential $\\eta_{\\mathrm{film}}(L^{\\star})$ for the target thickness $L^{\\star}$. The required parameters in SI units are:\n- $\\varrho_{f} = 1.0 \\times 10^{6}~\\Omega \\cdot \\mathrm{m}$\n- $i_{\\mathrm{app}} = 50~\\mathrm{A/m^{2}}$\n- $L^{\\star} = 5 \\times 10^{-9}~\\mathrm{m}$\n\nSubstituting these values:\n$$\n\\eta_{\\mathrm{film}}(L^{\\star}) = (1.0 \\times 10^{6}~\\Omega \\cdot \\mathrm{m}) (50~\\mathrm{A/m^{2}}) (5 \\times 10^{-9}~\\mathrm{m})\n$$\n$$\n\\eta_{\\mathrm{film}}(L^{\\star}) = (1.0 \\times 10^{6}) (50) (5 \\times 10^{-9})~\\mathrm{V}\n$$\n$$\n\\eta_{\\mathrm{film}}(L^{\\star}) = 250 \\times 10^{-3}~\\mathrm{V} = 0.250~\\mathrm{V}\n$$\nThe problem requires the answer to be rounded to four significant figures. Therefore, the value is $0.2500~\\mathrm{V}$.",
            "answer": "$$\n\\boxed{0.2500}\n$$"
        },
        {
            "introduction": "Localized corrosion, such as pitting, is a critical failure mechanism often governed by the transport of reactive species through the electrolyte. This exercise guides you through modeling this transport-limited process by solving the quasi-steady diffusion equation for the concentration field around an idealized hemispherical pit. By connecting the resulting diffusive flux to the rate of metal dissolution at the interface, you will derive the classic parabolic growth law, $R(t) \\propto t^{1/2}$, a cornerstone result in the analysis of localized corrosion .",
            "id": "3785096",
            "problem": "Consider corrosion of a metallic substrate in an aqueous electrolyte producing a single, axisymmetric hemispherical pit of time-dependent radius $R(t)$ carved into the substrate. Assume the dissolution is entirely diffusion-controlled by the transport of a single oxidizing reactant species $A$ in the electrolyte, with bulk concentration $c_{\\infty}$ far from the pit. The molar diffusivity of species $A$ is $D$, and its concentration field $c(\\mathbf{x})$ in the electrolyte is governed at the microscale by quasi-steady diffusion with no homogeneous reactions, so that the concentration satisfies the Laplace equation $\\nabla^{2} c = 0$ in the electrolyte domain exterior to the pit. The pit surface is perfectly reactive so that the concentration of $A$ at the metal-electrolyte interface is $c = 0$, the planar substrate outside the pit is impermeable (reflecting) so that the normal diffusive flux there is zero, and $c \\to c_{\\infty}$ as $|\\mathbf{x}| \\to \\infty$.\n\nLet species $A$ be consumed at the pit surface with stoichiometric coefficient $\\nu$ moles of $A$ per mole of metal dissolved. Let the molar volume of the metal be $\\Omega$, and assume local microscale mass conservation at the moving dissolution front, so that the normal interface velocity $v_{n}$ equals the molar volume times the molar dissolution rate of the metal per unit area. Adopt the constitutive description of diffusion via Fick’s law of diffusion, $\\mathbf{J} = - D \\nabla c$, where $\\mathbf{J}$ is the molar flux of $A$.\n\nModel the hemispherical pit as a hemisphere of radius $R(t)$ in a half-space electrolyte above a planar, reflecting substrate. Treat the concentration problem as axisymmetric and invoke scientific realism to justify the quasi-steady assumption and the half-space reflection condition.\n\nStarting from the governing equation $\\nabla^{2} c = 0$, the boundary conditions described above, Fick’s law, and the interfacial mass conservation relation, derive a closed-form expression for the pit radius $R(t)$ as a function of time, given the initial radius $R(0) = R_{0}$. Your final answer must be a single closed-form analytic expression in terms of $R_{0}$, $D$, $c_{\\infty}$, $\\nu$, $\\Omega$, and $t$. No numerical evaluation is required and no rounding should be performed. Express the final radius–time law $R(t)$ explicitly.",
            "solution": "The problem requires the derivation of the time-dependent radius, $R(t)$, of a hemispherical corrosion pit under diffusion-controlled growth. The solution proceeds by first solving for the concentration field of the reactant species under a quasi-steady assumption, then calculating the reactant flux to the pit surface, relating this flux to the pit's growth rate, and finally integrating the resulting differential equation for the radius.\n\nThe concentration field $c(\\mathbf{x})$ of the reactant species $A$ in the electrolyte is governed by the quasi-steady diffusion equation, which is the Laplace equation:\n$$\n\\nabla^{2} c = 0\n$$\nThe boundary conditions are:\n$1$. $c=0$ on the surface of the hemispherical pit of radius $R(t)$.\n$2$. The normal diffusive flux is zero on the planar substrate outside the pit.\n$3$. $c \\to c_{\\infty}$ far from the pit.\n\nThe geometry of a hemispherical sink on an infinite insulating plane is best handled using the method of images. The problem is equivalent to solving for the concentration field around a full spherical sink of radius $R$ in an infinite, unrestricted medium, where the concentration on the sphere's surface is $c=0$ and the concentration far from the sphere is $c=c_{\\infty}$. By symmetry, the concentration field for the full sphere problem will have a zero normal gradient component across the equatorial plane that corresponds to the substrate plane in the original problem. The flux vector, $\\mathbf{J} = -D \\nabla c$, is parallel to the gradient $\\nabla c$. The gradient vector is everywhere normal to the surfaces of constant concentration. For a spherically symmetric problem, the constant concentration surfaces are spheres concentric with the sink, and the gradient is purely radial. Thus, the flux is purely radial. The normal vector to the substrate plane, say the $z=0$ plane, is $\\hat{\\mathbf{k}}$. The normal component of the flux on this plane is $\\mathbf{J} \\cdot \\hat{\\mathbf{k}}$. For any point on the plane $z=0$ away from the origin, the radial vector $\\mathbf{r}$ is perpendicular to $\\hat{\\mathbf{k}}$, and so is the flux $\\mathbf{J}$. This satisfies the zero-flux (reflecting) boundary condition $\\mathbf{J} \\cdot \\hat{\\mathbf{n}} = 0$ on the substrate.\n\nFor the equivalent full-sphere problem, we adopt spherical coordinates $(r, \\theta, \\phi)$. Due to the spherical symmetry of the boundary conditions, the concentration $c$ will only be a function of the radial distance $r$, i.e., $c=c(r)$. The Laplace equation simplifies to:\n$$\n\\frac{1}{r^{2}} \\frac{d}{dr} \\left( r^{2} \\frac{dc}{dr} \\right) = 0\n$$\nIntegrating this equation twice yields the general solution:\n$$\nc(r) = A + \\frac{B}{r}\n$$\nwhere $A$ and $B$ are constants of integration. We determine these constants using the boundary conditions for the full-sphere problem:\n$1$. At infinity, $c \\to c_{\\infty}$ as $r \\to \\infty$. This gives $c_{\\infty} = A + 0$, so $A = c_{\\infty}$.\n$2$. On the sphere surface, $c=0$ at $r=R(t)$. For a given instant in time $t$, $R(t)$ is treated as a fixed radius $R$. So, $0 = A + \\frac{B}{R} = c_{\\infty} + \\frac{B}{R}$, which gives $B = -c_{\\infty}R$.\n\nSubstituting the constants $A$ and $B$ back into the general solution, we obtain the quasi-steady concentration field around the pit for $r \\geq R(t)$:\n$$\nc(r) = c_{\\infty} \\left( 1 - \\frac{R(t)}{r} \\right)\n$$\n\nNext, we calculate the molar flux of species $A$ onto the pit surface using Fick's law, $\\mathbf{J} = -D \\nabla c$. The gradient of the concentration field is:\n$$\n\\nabla c = \\frac{dc}{dr} \\hat{\\mathbf{r}} = \\frac{d}{dr} \\left[ c_{\\infty} \\left( 1 - \\frac{R}{r} \\right) \\right] \\hat{\\mathbf{r}} = \\frac{c_{\\infty}R}{r^{2}} \\hat{\\mathbf{r}}\n$$\nThe flux vector is then:\n$$\n\\mathbf{J} = -D \\frac{c_{\\infty}R}{r^{2}} \\hat{\\mathbf{r}}\n$$\nThe negative sign indicates that the flux is directed inward, toward the center of the pit, which is expected as species $A$ is consumed at the surface. The rate of consumption of $A$ per unit area at the pit surface, $J_{n}$, is the magnitude of the flux evaluated at $r=R(t)$:\n$$\nJ_{n} = |\\mathbf{J}|_{r=R} = \\left| -D \\frac{c_{\\infty}R}{R^{2}} \\hat{\\mathbf{r}} \\right| = \\frac{D c_{\\infty}}{R}\n$$\n\nThe problem states that the normal interface velocity, $v_{n}$, is equal to the molar volume of the metal, $\\Omega$, multiplied by the molar dissolution rate of the metal per unit area. The interface velocity is the rate of change of the pit radius, $v_{n} = \\frac{dR}{dt}$. The molar dissolution rate of the metal is related to the consumption rate of species $A$ by the stoichiometric coefficient $\\nu$, which is defined as moles of $A$ consumed per mole of metal dissolved. Thus, the molar rate of metal dissolution per unit area is $\\frac{J_{n}}{\\nu}$. The interface moves according to the mass conservation relation:\n$$\nv_{n} = \\frac{dR}{dt} = \\Omega \\left( \\frac{J_{n}}{\\nu} \\right)\n$$\nSubstituting the derived expression for $J_{n}$:\n$$\n\\frac{dR}{dt} = \\frac{\\Omega}{\\nu} \\left( \\frac{D c_{\\infty}}{R} \\right)\n$$\nThis is a first-order ordinary differential equation for $R(t)$. It can be solved by separation of variables:\n$$\nR \\, dR = \\left( \\frac{\\Omega D c_{\\infty}}{\\nu} \\right) dt\n$$\nWe integrate this equation from the initial condition $R(0) = R_{0}$ at time $t=0$ to $R(t)$ at time $t$:\n$$\n\\int_{R_{0}}^{R(t)} R' \\, dR' = \\int_{0}^{t} \\frac{\\Omega D c_{\\infty}}{\\nu} \\, dt'\n$$\nPerforming the integration gives:\n$$\n\\left[ \\frac{(R')^{2}}{2} \\right]_{R_{0}}^{R(t)} = \\left( \\frac{\\Omega D c_{\\infty}}{\\nu} \\right) [t']_{0}^{t}\n$$\n$$\n\\frac{R(t)^{2}}{2} - \\frac{R_{0}^{2}}{2} = \\frac{\\Omega D c_{\\infty}}{\\nu} t\n$$\nNow, we solve for $R(t)^{2}$:\n$$\nR(t)^{2} = R_{0}^{2} + \\frac{2 \\Omega D c_{\\infty} t}{\\nu}\n$$\nTaking the square root of both sides yields the final expression for the pit radius as a function of time. Since the radius must be a positive quantity, we take the positive root:\n$$\nR(t) = \\left( R_{0}^{2} + \\frac{2 \\Omega D c_{\\infty} t}{\\nu} \\right)^{1/2}\n$$\nThis is the closed-form analytic expression for the pit radius evolution under diffusion-controlled conditions.",
            "answer": "$$\n\\boxed{\\left(R_{0}^{2} + \\frac{2 \\Omega D c_{\\infty} t}{\\nu}\\right)^{1/2}}\n$$"
        },
        {
            "introduction": "A central challenge in multiscale modeling is to derive robust parameters for macroscopic models from the complex dynamics of microscopic simulations. This advanced practice provides a hands-on example of such a scale-bridging procedure, where a deterministic reaction rate is systematically coarse-grained from a stochastic surface process. You will implement a model based on a Continuous-Time Markov Chain and use Mean First-Passage Time analysis to compute an effective dissolution rate from a Kinetic Monte Carlo simulation, directly linking atomic-scale events to a continuum-level flux parameter .",
            "id": "3785135",
            "problem": "You are asked to derive and implement a coarse-grained dissolution reaction rate from a microscopic Kinetic Monte Carlo (KMC) model by computing a Mean First-Passage Time (MFPT) and relating it to a macroscopic flux. The microscopic model is a continuous-time random walk for a single vacancy on a one-dimensional lattice representing a reactive surface segment. The lattice consists of $N$ interior sites labeled $1$ through $N$, and two boundary sites labeled $0$ and $N+1$. The vacancy hops between nearest neighbors at a rate $k_h$ (in per second). At each boundary site, the vacancy can either return to the interior at a rate $k_h$ or trigger a dissolution event (absorption into a macroscopic sink) at a rate $k_d$ (in per second). A dissolution event corresponds to the removal of one surface atom from the solid to the solution.\n\nFundamental base to be used:\n- The Kinetic Monte Carlo (KMC) dynamics are modeled as a Continuous-Time Markov Chain (CTMC) on a finite state space of transient states with an absorbing sink. The infinitesimal generator matrix $\\mathbf{Q}$ of the transient states governs the evolution of the probability vector $\\mathbf{p}(t)$ through the chemical master equation $\\mathrm{d}\\mathbf{p}(t)/\\mathrm{d}t = \\mathbf{p}(t)\\mathbf{Q}$.\n- The Mean First-Passage Time (MFPT) vector $\\mathbf{t}$ to absorption for a CTMC satisfies the linear system $\\mathbf{Q}\\,\\mathbf{t} = -\\mathbf{1}$, where $\\mathbf{1}$ is a vector of ones, provided that the set of transient states includes all non-absorbing states and there is a positive total absorption rate.\n- The coarse-grained per-site reaction rate $k_{\\mathrm{eff}}$ (in per second) is related to the MFPT by $k_{\\mathrm{eff}} = 1/\\langle \\tau \\rangle$, where $\\langle \\tau \\rangle$ is the MFPT averaged over the initial distribution of microscopic states for a single vacancy introduction.\n- The macroscopic molar flux $J$ (in mol per square meter per second) can be obtained by multiplying the per-site event frequency by the active site density and converting atoms to moles using Avogadro's number.\n\nMicroscopic model specification:\n- States and transitions:\n  - Interior states are $i \\in \\{1,2,\\dots,N\\}$. From each $i$, transitions occur to $i-1$ and $i+1$ at rate $k_h$ each.\n  - Boundary states are $0$ and $N+1$. From each boundary, transitions occur to its adjacent interior state at rate $k_h$, and to an absorbing sink at rate $k_d$. The absorbing sink is not included in the transient state space.\n- Generator $\\mathbf{Q}$ on the transient states $\\{0,1,2,\\dots,N,N+1\\}$:\n  - For interior $i \\in \\{1,\\dots,N\\}$: $Q_{i,i} = -2k_h$, $Q_{i,i-1} = k_h$, $Q_{i,i+1} = k_h$.\n  - For boundary $0$: $Q_{0,0} = -(k_h + k_d)$, $Q_{0,1} = k_h$.\n  - For boundary $N+1$: $Q_{N+1,N+1} = -(k_h + k_d)$, $Q_{N+1,N} = k_h$.\n- Initial microscopic distribution for the MFPT: uniform over interior sites, that is $p_0(i) = 1/N$ for $i \\in \\{1,\\dots,N\\}$ and $p_0(0) = p_0(N+1) = 0$.\n- MFPT computation: Solve $\\mathbf{Q}\\,\\mathbf{t} = -\\mathbf{1}$ for $\\mathbf{t}$ and then compute $\\langle \\tau \\rangle = \\sum_{i} p_0(i)\\,t_i$.\n- Coarse-grained quantities:\n  - Per-site dissolution rate: $k_{\\mathrm{eff}} = 1/\\langle \\tau \\rangle$ in per second.\n  - Molar flux: $J = S \\, k_{\\mathrm{eff}} / N_A$ in mol per square meter per second, where $S$ is the active site density in sites per square meter and $N_A$ is Avogadro's number.\n\nPhysical constants and units:\n- Use Avogadro's number $N_A = 6.02214076 \\times 10^{23}$ per mole.\n- Express $k_h$ and $k_d$ in per second, $S$ in sites per square meter, $k_{\\mathrm{eff}}$ in per second, and $J$ in mol per square meter per second.\n- All angles are not applicable in this problem.\n\nYour task:\n- Implement a program that constructs $\\mathbf{Q}$, solves for $\\mathbf{t}$, computes $\\langle \\tau \\rangle$, then returns $k_{\\mathrm{eff}}$ and $J$ for each test case.\n- Numerical output requirements: For each test case, output a pair $[k_{\\mathrm{eff}}, J]$ with both values formatted as floating-point numbers.\n\nTest suite:\n- Case A (general): $N = 10$, $k_h = 1.0 \\times 10^{6}$ per second, $k_d = 1.0 \\times 10^{5}$ per second, $S = 1.0 \\times 10^{16}$ sites per square meter.\n- Case B (reaction-limited): $N = 10$, $k_h = 1.0 \\times 10^{6}$ per second, $k_d = 1.0 \\times 10^{2}$ per second, $S = 1.0 \\times 10^{16}$ sites per square meter.\n- Case C (transport-limited): $N = 100$, $k_h = 1.0 \\times 10^{4}$ per second, $k_d = 1.0 \\times 10^{8}$ per second, $S = 5.0 \\times 10^{15}$ sites per square meter.\n- Case D (boundary case): $N = 1$, $k_h = 1.0 \\times 10^{5}$ per second, $k_d = 1.0 \\times 10^{5}$ per second, $S = 1.0 \\times 10^{16}$ sites per square meter.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a two-element list in the form $[k_{\\mathrm{eff}},J]$ corresponding to the test cases in the given order. For example, the output should look like $[[x_1,y_1],[x_2,y_2],[x_3,y_3],[x_4,y_4]]$ with no additional text. Round each floating-point number to six significant figures in the printed representation.",
            "solution": "The problem statement is critically examined and found to be valid. It is scientifically grounded in the principles of statistical mechanics and stochastic processes, specifically the theory of Continuous-Time Markov Chains (CTMCs). The problem is well-posed, providing all necessary parameters, constants, and a complete, self-consistent description of the microscopic model. The task is to formalize this model computationally, which is a standard and meaningful exercise in multiscale modeling. There are no ambiguities, contradictions, or scientifically unsound premises.\n\nThe solution proceeds by implementing the theoretical framework provided. The core of the problem is to compute the mean time to a dissolution event for a vacancy introduced onto a reactive surface, and from this, to derive a macroscopic reaction rate and flux. This is accomplished through the following steps.\n\nFirst, we model the system as a CTMC. The state space $\\mathcal{S}$ for the vacancy's position consists of $N+2$ transient states, labeled $\\{0, 1, \\dots, N, N+1\\}$. States $i \\in \\{1, \\dots, N\\}$ are interior sites, while states $0$ and $N+1$ are boundary sites. Dissolution is treated as a transition from a boundary site to an absorbing sink state, which is not included in the transient state space $\\mathcal{S}$.\n\nSecond, we construct the infinitesimal generator matrix $\\mathbf{Q}$ for the transient states. This $(N+2) \\times (N+2)$ matrix encodes the transition rates between the states in $\\mathcal{S}$. The elements $Q_{ij}$ for $i \\neq j$ represent the rate of transition from state $i$ to state $j$, and the diagonal elements $Q_{ii}$ are the negative sum of rates out of state $i$, including transitions to the absorbing sink. Based on the problem description, the non-zero elements of $\\mathbf{Q}$ are:\n- For boundary state $i=0$:\n  $$ Q_{0,0} = -(k_h + k_d), \\quad Q_{0,1} = k_h $$\n- For interior states $i \\in \\{1, \\dots, N\\}$:\n  $$ Q_{i,i-1} = k_h, \\quad Q_{i,i} = -2k_h, \\quad Q_{i,i+1} = k_h $$\n- For boundary state $i=N+1$:\n  $$ Q_{N+1,N} = k_h, \\quad Q_{N+1,N+1} = -(k_h + k_d) $$\nAll other elements of $\\mathbf{Q}$ are $0$.\n\nThird, we compute the Mean First-Passage Time (MFPT) to absorption. Let $\\mathbf{t}$ be a column vector of size $N+2$, where each element $t_i$ is the expected time to reach the absorbing sink, given that the process starts in state $i$. This vector $\\mathbf{t}$ is the solution to the system of linear equations:\n$$ \\mathbf{Q} \\mathbf{t} = -\\mathbf{1} $$\nwhere $\\mathbf{1}$ is a column vector of ones of the same dimension. This system can be solved using standard numerical linear algebra techniques.\n\nFourth, we calculate the average MFPT, denoted $\\langle \\tau \\rangle$, based on the specified initial distribution of the vacancy. The vacancy is introduced with a uniform probability across the $N$ interior sites. The initial probability vector $\\mathbf{p}_0$ is thus given by $p_0(i) = 1/N$ for $i \\in \\{1, \\dots, N\\}$ and $p_0(i) = 0$ for $i \\in \\{0, N+1\\}$. The average MFPT is the expectation of the MFPTs $t_i$ with respect to this initial distribution:\n$$ \\langle \\tau \\rangle = \\sum_{i=0}^{N+1} p_0(i) t_i = \\frac{1}{N} \\sum_{i=1}^{N} t_i $$\n\nFifth, we derive the coarse-grained quantities. The effective per-site dissolution rate, $k_{\\mathrm{eff}}$, is the reciprocal of the average time it takes for a dissolution event to occur after a vacancy is introduced.\n$$ k_{\\mathrm{eff}} = \\frac{1}{\\langle \\tau \\rangle} $$\nThis rate has units of per second (s⁻¹). The macroscopic molar flux, $J$, represents the number of moles of substance dissolving per unit area per unit time. It is obtained by scaling $k_{\\mathrm{eff}}$ by the active site density $S$ and converting from a particle-based rate to a molar rate using Avogadro's number, $N_A = 6.02214076 \\times 10^{23}$ mol⁻¹.\n$$ J = \\frac{S \\cdot k_{\\mathrm{eff}}}{N_A} $$\nThe units of $J$ are mol m⁻² s⁻¹.\n\nThe computational algorithm proceeds as follows for each test case:\n1.  Define the parameters $N$, $k_h$, $k_d$, and $S$.\n2.  Construct the $(N+2) \\times (N+2)$ matrix $\\mathbf{Q}$ as described above.\n3.  Define the column vector $\\mathbf{b} = -\\mathbf{1}$ of size $N+2$.\n4.  Solve the linear system $\\mathbf{Q} \\mathbf{t} = \\mathbf{b}$ for the MFPT vector $\\mathbf{t}$.\n5.  Calculate $\\langle \\tau \\rangle$ by averaging the elements $t_1$ through $t_N$ of the solution vector.\n6.  Compute $k_{\\mathrm{eff}} = 1/\\langle \\tau \\rangle$.\n7.  Compute $J = S \\cdot k_{\\mathrm{eff}} / N_A$.\n8.  Store the pair $[k_{\\mathrm{eff}}, J]$ for the final output.\nThis procedure is applied to each of the four test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for all specified test cases and prints the results.\n    \"\"\"\n\n    # Physical constant\n    NA = 6.02214076e23  # Avogadro's number in per mole\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (general)\n        {'N': 10, 'kh': 1.0e6, 'kd': 1.0e5, 'S': 1.0e16},\n        # Case B (reaction-limited)\n        {'N': 10, 'kh': 1.0e6, 'kd': 1.0e2, 'S': 1.0e16},\n        # Case C (transport-limited)\n        {'N': 100, 'kh': 1.0e4, 'kd': 1.0e8, 'S': 5.0e15},\n        # Case D (boundary case)\n        {'N': 1, 'kh': 1.0e5, 'kd': 1.0e5, 'S': 1.0e16},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_flux(**case)\n        results.append(result)\n\n    # Format the final output string as specified\n    results_str = [f\"[{res[0]:.6g},{res[1]:.6g}]\" for res in results]\n    print(f\"[{','.join(results_str)}]\")\n\ndef calculate_flux(N, kh, kd, S):\n    \"\"\"\n    Calculates the effective rate and molar flux for a single test case.\n\n    Args:\n        N (int): Number of interior lattice sites.\n        kh (float): Hopping rate between nearest neighbors (per second).\n        kd (float): Dissolution rate at boundaries (per second).\n        S (float): Active site density (sites per square meter).\n\n    Returns:\n        A list containing [k_eff, J].\n    \"\"\"\n    # Total number of transient states in the CTMC model is N interior + 2 boundary\n    num_states = N + 2\n\n    # Initialize the infinitesimal generator matrix Q\n    Q = np.zeros((num_states, num_states))\n\n    # --- Construct the Q matrix ---\n\n    # Row 0: boundary state at index 0\n    Q[0, 0] = -(kh + kd)\n    Q[0, 1] = kh\n\n    # Rows 1 to N: interior states\n    for i in range(1, N + 1):\n        Q[i, i] = -2.0 * kh\n        Q[i, i-1] = kh\n        Q[i, i+1] = kh\n\n    # Row N+1: boundary state at index N+1\n    Q[N + 1, N + 1] = -(kh + kd)\n    Q[N + 1, N] = kh\n    \n    # --- Solve for Mean First-Passage Time (MFPT) ---\n\n    # The system to solve is Q * t = -1\n    # where t is the vector of MFPTs starting from each state.\n    b = -np.ones(num_states)\n    \n    # Solve the linear system for t\n    t = np.linalg.solve(Q, b)\n    \n    # --- Calculate average MFPT and coarse-grained quantities ---\n\n    # The initial distribution is uniform over the N interior sites {1, ..., N}.\n    # We need to average the MFPTs for these starting states.\n    # The indices in the t vector corresponding to these states are 1 to N.\n    mean_tau = np.mean(t[1 : N + 1])\n    \n    # The effective per-site dissolution rate is the inverse of the average MFPT.\n    k_eff = 1.0 / mean_tau\n    \n    # NA (Avogadro's number)\n    NA = 6.02214076e23\n\n    # The macroscopic molar flux J.\n    J = (S * k_eff) / NA\n    \n    return [k_eff, J]\n\nsolve()\n```"
        }
    ]
}