{
    "hands_on_practices": [
        {
            "introduction": "Understanding the interplay between chemical reactions and mass transport is fundamental to modeling corrosion, especially within the porous product layers that often form on a metal's surface. This exercise provides a foundational analysis of this coupling by examining a classic problem in chemical reaction engineering applied to corrosion. By deriving the dimensionless Thiele modulus and the associated effectiveness factor, you will develop a quantitative framework for determining when a corrosion process is limited by the intrinsic reaction kinetics versus the diffusion of reactive species through the porous layer .",
            "id": "3785100",
            "problem": "A spherical porous corrosion product particle of radius $R$ is immersed in an aqueous electrolyte containing an oxidizing species with bulk concentration $c_{\\infty}$. The oxidizing species diffuses through the pore network with an effective diffusion coefficient $D$ and is consumed by a dissolution reaction of the solid with a rate per unit pore volume described by a first-order law $r(c)=k\\,c$, where $k$ is the intrinsic first-order rate constant and $c(r)$ is the concentration of the oxidizing species at radial position $r$. Assume steady state, isothermal conditions, uniform porosity, and negligible external mass-transfer resistance so that $c(R)=c_{s}$, with $c_{s}$ the surface concentration equal to $c_{\\infty}$. The process is representative of dissolution-limited corrosion at the pore scale when the intrinsic kinetics are slow compared to transport, but the internal diffusion-reaction balance can still affect the macroscopic corrosion rate.\n\nStarting from Fick’s law and the species continuity equation, formulate the governing Partial Differential Equation (PDE) for $c(r)$ under spherical symmetry. Non-dimensionalize the PDE using a characteristic length $L$ and show how a dimensionless group comparing reaction to diffusion naturally emerges. Define the Thiele modulus in terms of the material and geometric parameters.\n\nThen, solve the boundary-value problem for $c(r)$ and derive an expression for the overall volumetric reaction rate integrated over the particle. Define the effectiveness factor $\\eta$ for dissolution-limited corrosion as the ratio of the actual integrated rate to the hypothetical rate if the entire particle were at the surface concentration $c_{s}$, and obtain a closed-form expression for $\\eta$ as a function of the Thiele modulus.\n\nExpress your final answer as a single closed-form analytic expression for the effectiveness factor in terms of the Thiele modulus. No rounding is required, and no units should be included in the final expression.",
            "solution": "The problem statement is a valid and well-posed problem in transport phenomena and chemical reaction engineering, specifically concerning diffusion and reaction in a porous medium. It is scientifically grounded, internally consistent, and contains all necessary information to derive a unique, meaningful solution. We may therefore proceed with the solution.\n\nThe fundamental principle governing the concentration of a species at steady state is the species continuity equation. For a species being consumed by a reaction, this is expressed as:\n$$\n\\nabla \\cdot \\mathbf{J} + \\mathcal{R} = 0\n$$\nwhere $\\mathbf{J}$ is the molar flux vector of the species and $\\mathcal{R}$ is the volumetric rate of consumption.\n\nThe molar flux due to diffusion is described by Fick's first law:\n$$\n\\mathbf{J} = -D \\nabla c\n$$\nwhere $D$ is the effective diffusion coefficient and $c$ is the species concentration.\n\nThe problem states that the rate of consumption per unit pore volume is $r(c) = k\\,c$. In the context of a porous medium, the continuity equation is applied to a control volume that includes both the solid and pore space. Therefore, the rate of consumption per unit total volume of the medium, $\\mathcal{R}$, is the rate per unit pore volume multiplied by the porosity, $\\epsilon$. However, it is standard practice in this field to define an effective rate constant, which we will also denote by $k$ for simplicity, that describes the rate per unit total volume. Thus, we set $\\mathcal{R} = k c$.\n\nSubstituting Fick's law and the reaction rate into the continuity equation, we obtain:\n$$\n\\nabla \\cdot (-D \\nabla c) + k c = 0\n$$\nAssuming the effective diffusion coefficient $D$ is constant, this simplifies to:\n$$\n-D \\nabla^2 c + k c = 0 \\implies \\nabla^2 c = \\frac{k}{D} c\n$$\nFor a spherically symmetric system where concentration $c$ depends only on the radial position $r$, the Laplacian operator $\\nabla^2$ is given by:\n$$\n\\nabla^2 c(r) = \\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 \\frac{dc}{dr} \\right)\n$$\nThus, the governing ordinary differential equation (ODE) for the concentration profile $c(r)$ is:\n$$\n\\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 \\frac{dc}{dr} \\right) = \\frac{k}{D} c\n$$\nThis can be expanded to:\n$$\n\\frac{d^2c}{dr^2} + \\frac{2}{r} \\frac{dc}{dr} - \\frac{k}{D} c = 0\n$$\nTo non-dimensionalize this equation, we introduce a characteristic length, which for a sphere is naturally its radius, $L=R$. We define the dimensionless radius $\\rho$ and dimensionless concentration $\\psi$:\n$$\n\\rho = \\frac{r}{R}, \\quad \\psi = \\frac{c}{c_s}\n$$\nwhere $c_s = c_{\\infty}$ is the concentration at the surface of the particle. The derivatives transform as:\n$$\n\\frac{dc}{dr} = \\frac{c_s}{R} \\frac{d\\psi}{d\\rho}, \\quad \\frac{d^2c}{dr^2} = \\frac{c_s}{R^2} \\frac{d^2\\psi}{d\\rho^2}\n$$\nSubstituting these into the governing ODE yields:\n$$\n\\frac{c_s}{R^2} \\frac{d^2\\psi}{d\\rho^2} + \\frac{2}{\\rho R} \\left(\\frac{c_s}{R} \\frac{d\\psi}{d\\rho}\\right) - \\frac{k}{D} (c_s \\psi) = 0\n$$\nDividing through by $c_s/R^2$ gives the dimensionless ODE:\n$$\n\\frac{d^2\\psi}{d\\rho^2} + \\frac{2}{\\rho} \\frac{d\\psi}{d\\rho} - \\left(\\frac{k R^2}{D}\\right) \\psi = 0\n$$\nA dimensionless group naturally emerges, which is conventionally defined as the square of the Thiele modulus, $\\phi$. The Thiele modulus is defined as:\n$$\n\\phi = R \\sqrt{\\frac{k}{D}}\n$$\nThis modulus compares the characteristic rate of reaction ($k c_s R^3$) to the characteristic rate of diffusion ($D c_s R$). A large $\\phi$ indicates that the reaction is fast relative to diffusion, leading to significant concentration gradients within the particle. Conversely, a small $\\phi$ indicates that diffusion is fast compared to the reaction, resulting in a nearly uniform concentration profile.\n\nThe dimensionless problem is now a boundary-value problem (BVP):\n$$\n\\frac{d^2\\psi}{d\\rho^2} + \\frac{2}{\\rho} \\frac{d\\psi}{d\\rho} - \\phi^2 \\psi = 0\n$$\nwith boundary conditions:\n1. At the surface ($r=R$, so $\\rho=1$): $c(R) = c_s$, which means $\\psi(1) = 1$.\n2. At the center ($r=0$, so $\\rho=0$): Due to symmetry, the concentration gradient must be zero, $\\frac{dc}{dr}|_{r=0} = 0$, which implies $\\frac{d\\psi}{d\\rho}|_{\\rho=0} = 0$. An equivalent condition is that the concentration must be finite at the center.\n\nTo solve this ODE, we use the substitution $\\psi(\\rho) = \\frac{u(\\rho)}{\\rho}$. The derivatives of $\\psi$ are:\n$$\n\\frac{d\\psi}{d\\rho} = \\frac{u'}{\\rho} - \\frac{u}{\\rho^2}, \\quad \\frac{d^2\\psi}{d\\rho^2} = \\frac{u''}{\\rho} - \\frac{2u'}{\\rho^2} + \\frac{2u}{\\rho^3}\n$$\nSubstituting these into the dimensionless ODE simplifies it to:\n$$\n\\frac{d^2u}{d\\rho^2} - \\phi^2 u = 0\n$$\nThe general solution for $u(\\rho)$ is $u(\\rho) = A \\cosh(\\phi \\rho) + B \\sinh(\\phi \\rho)$. Therefore, the solution for $\\psi(\\rho)$ is:\n$$\n\\psi(\\rho) = \\frac{A \\cosh(\\phi \\rho) + B \\sinh(\\phi \\rho)}{\\rho}\n$$\nApplying the boundary condition at $\\rho=0$: for $\\psi(0)$ to be finite, we must have $A=0$, since $\\lim_{\\rho\\to 0} \\frac{\\cosh(\\phi \\rho)}{\\rho} \\to \\infty$. Thus, the solution is of the form $\\psi(\\rho) = B \\frac{\\sinh(\\phi \\rho)}{\\rho}$.\nApplying the boundary condition at $\\rho=1$: $\\psi(1) = 1$, which gives $1 = B \\frac{\\sinh(\\phi)}{1}$, so $B = \\frac{1}{\\sinh(\\phi)}$.\nThe dimensionless concentration profile is:\n$$\n\\psi(\\rho) = \\frac{\\sinh(\\phi \\rho)}{\\rho \\sinh(\\phi)}\n$$\nAnd the dimensional concentration profile is $c(r) = c_s \\frac{\\sinh(\\phi r/R)}{(r/R) \\sinh(\\phi)}$.\n\nNext, we calculate the overall volumetric reaction rate, $W_{actual}$, by integrating the local rate over the particle's volume $V$:\n$$\nW_{actual} = \\int_{V} k c(r) dV = \\int_{0}^{R} k c(r) (4\\pi r^2) dr\n$$\n$$\nW_{actual} = 4\\pi k \\int_{0}^{R} \\left(c_s \\frac{\\sinh(\\phi r/R)}{(r/R) \\sinh(\\phi)}\\right) r^2 dr = \\frac{4\\pi k c_s R}{\\sinh(\\phi)} \\int_{0}^{R} r \\sinh(\\phi r/R) dr\n$$\nThe integral can be solved using integration by parts, yielding:\n$$\n\\int_{0}^{R} r \\sinh(\\phi r/R) dr = \\frac{R^2}{\\phi^2} [\\phi \\cosh(\\phi) - \\sinh(\\phi)]\n$$\nSubstituting this result back into the expression for $W_{actual}$:\n$$\nW_{actual} = \\frac{4\\pi k c_s R}{\\sinh(\\phi)} \\frac{R^2}{\\phi^2} (\\phi \\cosh(\\phi) - \\sinh(\\phi)) = \\frac{4\\pi k c_s R^3}{\\phi^2} \\left(\\phi \\frac{\\cosh(\\phi)}{\\sinh(\\phi)} - 1\\right)\n$$\n$$\nW_{actual} = \\frac{4\\pi k c_s R^3}{\\phi^2} (\\phi \\coth(\\phi) - 1)\n$$\nThe problem defines the effectiveness factor, $\\eta$, as the ratio of the actual rate to the hypothetical rate if the entire particle were at the surface concentration $c_s$. This maximum possible rate, $W_{max}$, is:\n$$\nW_{max} = k c_s V = k c_s \\left(\\frac{4}{3}\\pi R^3\\right)\n$$\nThe effectiveness factor $\\eta$ is therefore:\n$$\n\\eta = \\frac{W_{actual}}{W_{max}} = \\frac{\\frac{4\\pi k c_s R^3}{\\phi^2} (\\phi \\coth(\\phi) - 1)}{k c_s \\frac{4}{3}\\pi R^3}\n$$\nSimplifying the expression, we get:\n$$\n\\eta = \\frac{3}{\\phi^2} (\\phi \\coth(\\phi) - 1)\n$$\nThis is the closed-form expression for the effectiveness factor for a first-order reaction in a spherical particle as a function of the Thiele modulus $\\phi$.",
            "answer": "$$\\boxed{\\frac{3}{\\phi^2} \\left( \\phi \\coth(\\phi) - 1 \\right)}$$"
        },
        {
            "introduction": "Localized corrosion, such as pitting, is particularly insidious as it can lead to rapid structural failure with minimal overall material loss. This practice focuses on modeling the growth of a single corrosion pit, assuming the process is controlled by the diffusion of a reactant from the bulk electrolyte to the pit surface. Solving this problem will demonstrate the application of the quasi-steady-state approximation to a moving boundary problem and reveal the characteristic diffusion-controlled growth law, where the pit radius increases with the square root of time, $R(t) \\propto \\sqrt{t}$ .",
            "id": "3785096",
            "problem": "Consider corrosion of a metallic substrate in an aqueous electrolyte producing a single, axisymmetric hemispherical pit of time-dependent radius $R(t)$ carved into the substrate. Assume the dissolution is entirely diffusion-controlled by the transport of a single oxidizing reactant species $A$ in the electrolyte, with bulk concentration $c_{\\infty}$ far from the pit. The molar diffusivity of species $A$ is $D$, and its concentration field $c(\\mathbf{x})$ in the electrolyte is governed at the microscale by quasi-steady diffusion with no homogeneous reactions, so that the concentration satisfies the Laplace equation $\\nabla^{2} c = 0$ in the electrolyte domain exterior to the pit. The pit surface is perfectly reactive so that the concentration of $A$ at the metal-electrolyte interface is $c = 0$, the planar substrate outside the pit is impermeable (reflecting) so that the normal diffusive flux there is zero, and $c \\to c_{\\infty}$ as $|\\mathbf{x}| \\to \\infty$.\n\nLet species $A$ be consumed at the pit surface with stoichiometric coefficient $\\nu$ moles of $A$ per mole of metal dissolved. Let the molar volume of the metal be $\\Omega$, and assume local microscale mass conservation at the moving dissolution front, so that the normal interface velocity $v_{n}$ equals the molar volume times the molar dissolution rate of the metal per unit area. Adopt the constitutive description of diffusion via Fick’s law of diffusion, $\\mathbf{J} = - D \\nabla c$, where $\\mathbf{J}$ is the molar flux of $A$.\n\nModel the hemispherical pit as a hemisphere of radius $R(t)$ in a half-space electrolyte above a planar, reflecting substrate. Treat the concentration problem as axisymmetric and invoke scientific realism to justify the quasi-steady assumption and the half-space reflection condition.\n\nStarting from the governing equation $\\nabla^{2} c = 0$, the boundary conditions described above, Fick’s law, and the interfacial mass conservation relation, derive a closed-form expression for the pit radius $R(t)$ as a function of time, given the initial radius $R(0) = R_{0}$. Your final answer must be a single closed-form analytic expression in terms of $R_{0}$, $D$, $c_{\\infty}$, $\\nu$, $\\Omega$, and $t$. No numerical evaluation is required and no rounding should be performed. Express the final radius–time law $R(t)$ explicitly.",
            "solution": "The problem requires the derivation of the time-dependent radius, $R(t)$, of a hemispherical corrosion pit under diffusion-controlled growth. The solution proceeds by first solving for the concentration field of the reactant species under a quasi-steady assumption, then calculating the reactant flux to the pit surface, relating this flux to the pit's growth rate, and finally integrating the resulting differential equation for the radius.\n\nThe concentration field $c(\\mathbf{x})$ of the reactant species $A$ in the electrolyte is governed by the quasi-steady diffusion equation, which is the Laplace equation:\n$$\n\\nabla^{2} c = 0\n$$\nThe boundary conditions are:\n$1$. $c=0$ on the surface of the hemispherical pit of radius $R(t)$.\n$2$. The normal diffusive flux is zero on the planar substrate outside the pit.\n$3$. $c \\to c_{\\infty}$ far from the pit.\n\nThe geometry of a hemispherical sink on an infinite insulating plane is best handled using the method of images. The problem is equivalent to solving for the concentration field around a full spherical sink of radius $R$ in an infinite, unrestricted medium, where the concentration on the sphere's surface is $c=0$ and the concentration far from the sphere is $c=c_{\\infty}$. By symmetry, the concentration field for the full sphere problem will have a zero normal gradient component across the equatorial plane that corresponds to the substrate plane in the original problem. The flux vector, $\\mathbf{J} = -D \\nabla c$, is parallel to the gradient $\\nabla c$. The gradient vector is everywhere normal to the surfaces of constant concentration. For a spherically symmetric problem, the constant concentration surfaces are spheres concentric with the sink, and the gradient is purely radial. Thus, the flux is purely radial. The normal vector to the substrate plane, say the $z=0$ plane, is $\\hat{\\mathbf{k}}$. The normal component of the flux on this plane is $\\mathbf{J} \\cdot \\hat{\\mathbf{k}}$. For any point on the plane $z=0$ away from the origin, the radial vector $\\mathbf{r}$ is perpendicular to $\\hat{\\mathbf{k}}$, and so is the flux $\\mathbf{J}$. This satisfies the zero-flux (reflecting) boundary condition $\\mathbf{J} \\cdot \\hat{\\mathbf{n}} = 0$ on the substrate.\n\nFor the equivalent full-sphere problem, we adopt spherical coordinates $(r, \\theta, \\phi)$. Due to the spherical symmetry of the boundary conditions, the concentration $c$ will only be a function of the radial distance $r$, i.e., $c=c(r)$. The Laplace equation simplifies to:\n$$\n\\frac{1}{r^{2}} \\frac{d}{dr} \\left( r^{2} \\frac{dc}{dr} \\right) = 0\n$$\nIntegrating this equation twice yields the general solution:\n$$\nc(r) = A + \\frac{B}{r}\n$$\nwhere $A$ and $B$ are constants of integration. We determine these constants using the boundary conditions for the full-sphere problem:\n$1$. At infinity, $c \\to c_{\\infty}$ as $r \\to \\infty$. This gives $c_{\\infty} = A + 0$, so $A = c_{\\infty}$.\n$2$. On the sphere surface, $c=0$ at $r=R(t)$. For a given instant in time $t$, $R(t)$ is treated as a fixed radius $R$. So, $0 = A + \\frac{B}{R} = c_{\\infty} + \\frac{B}{R}$, which gives $B = -c_{\\infty}R$.\n\nSubstituting the constants $A$ and $B$ back into the general solution, we obtain the quasi-steady concentration field around the pit for $r \\geq R(t)$:\n$$\nc(r) = c_{\\infty} \\left( 1 - \\frac{R(t)}{r} \\right)\n$$\n\nNext, we calculate the molar flux of species $A$ onto the pit surface using Fick's law, $\\mathbf{J} = -D \\nabla c$. The gradient of the concentration field is:\n$$\n\\nabla c = \\frac{dc}{dr} \\hat{\\mathbf{r}} = \\frac{d}{dr} \\left[ c_{\\infty} \\left( 1 - \\frac{R}{r} \\right) \\right] \\hat{\\mathbf{r}} = \\frac{c_{\\infty}R}{r^{2}} \\hat{\\mathbf{r}}\n$$\nThe flux vector is then:\n$$\n\\mathbf{J} = -D \\frac{c_{\\infty}R}{r^{2}} \\hat{\\mathbf{r}}\n$$\nThe negative sign indicates that the flux is directed inward, toward the center of the pit, which is expected as species $A$ is consumed at the surface. The rate of consumption of $A$ per unit area at the pit surface, $J_{n}$, is the magnitude of the flux evaluated at $r=R(t)$:\n$$\nJ_{n} = |\\mathbf{J}|_{r=R} = \\left| -D \\frac{c_{\\infty}R}{R^{2}} \\hat{\\mathbf{r}} \\right| = \\frac{D c_{\\infty}}{R}\n$$\n\nThe problem states that the normal interface velocity, $v_{n}$, is equal to the molar volume of the metal, $\\Omega$, multiplied by the molar dissolution rate of the metal per unit area. The interface velocity is the rate of change of the pit radius, $v_{n} = \\frac{dR}{dt}$. The molar dissolution rate of the metal is related to the consumption rate of species $A$ by the stoichiometric coefficient $\\nu$, which is defined as moles of $A$ consumed per mole of metal dissolved. Thus, the molar rate of metal dissolution per unit area is $\\frac{J_{n}}{\\nu}$. The interface moves according to the mass conservation relation:\n$$\nv_{n} = \\frac{dR}{dt} = \\Omega \\left( \\frac{J_{n}}{\\nu} \\right)\n$$\nSubstituting the derived expression for $J_{n}$:\n$$\n\\frac{dR}{dt} = \\frac{\\Omega}{\\nu} \\left( \\frac{D c_{\\infty}}{R} \\right)\n$$\nThis is a first-order ordinary differential equation for $R(t)$. It can be solved by separation of variables:\n$$\nR \\, dR = \\left( \\frac{\\Omega D c_{\\infty}}{\\nu} \\right) dt\n$$\nWe integrate this equation from the initial condition $R(0) = R_{0}$ at time $t=0$ to $R(t)$ at time $t$:\n$$\n\\int_{R_{0}}^{R(t)} R' \\, dR' = \\int_{0}^{t} \\frac{\\Omega D c_{\\infty}}{\\nu} \\, dt'\n$$\nPerforming the integration gives:\n$$\n\\left[ \\frac{(R')^{2}}{2} \\right]_{R_{0}}^{R(t)} = \\left( \\frac{\\Omega D c_{\\infty}}{\\nu} \\right) [t']_{0}^{t}\n$$\n$$\n\\frac{R(t)^{2}}{2} - \\frac{R_{0}^{2}}{2} = \\frac{\\Omega D c_{\\infty}}{\\nu} t\n$$\nNow, we solve for $R(t)^{2}$:\n$$\nR(t)^{2} = R_{0}^{2} + \\frac{2 \\Omega D c_{\\infty} t}{\\nu}\n$$\nTaking the square root of both sides yields the final expression for the pit radius as a function of time. Since the radius must be a positive quantity, we take the positive root:\n$$\nR(t) = \\left( R_{0}^{2} + \\frac{2 \\Omega D c_{\\infty} t}{\\nu} \\right)^{1/2}\n$$\nThis is the closed-form analytic expression for the pit radius evolution under diffusion-controlled conditions.",
            "answer": "$$\n\\boxed{\\left(R_{0}^{2} + \\frac{2 \\Omega D c_{\\infty} t}{\\nu}\\right)^{1/2}}\n$$"
        },
        {
            "introduction": "A predictive model is only as good as its parameters, but how do we determine these parameters from real-world data? This practice shifts our focus from forward modeling to the inverse problem of parameter estimation, a critical skill in computational science. You will use a powerful statistical framework, Bayesian inference, to estimate key electrochemical kinetic parameters—the exchange current density $i_0$ and Tafel slopes $s_a$ and $s_c$—from simulated polarization data, learning how to rigorously quantify model parameters and their uncertainties in the presence of measurement noise .",
            "id": "3785083",
            "problem": "Consider a corrosion system where interfacial electrochemical kinetics at the metal-electrolyte interface are modeled by the Butler–Volmer relation, which links the current density to the overpotential through exponentials of activation-controlled terms. At sufficiently large magnitude of overpotential, the anodic and cathodic branches are well approximated by Tafel behavior. In a piecewise model that is asymptotically consistent with Butler–Volmer, define the natural-logarithm Tafel slopes as $s_a$ for the anodic branch and $s_c$ for the cathodic branch, both measured in $\\mathrm{V^{-1}}$, and define the exchange current density $i_0$ in $\\mathrm{A/m^2}$. For an overpotential $\\eta_j$ at index $j$, assume the following forward model using the magnitude of current density:\n$$\ny_j \\equiv \\ln\\left(\\lvert i_j \\rvert\\right) = \n\\begin{cases}\n\\ln(i_0) + s_a\\,\\eta_j + \\varepsilon_j,  \\text{if } \\eta_j \\ge 0,\\\\\n\\ln(i_0) - s_c\\,\\eta_j + \\varepsilon_j,  \\text{if } \\eta_j  0,\n\\end{cases}\n$$\nwhere $\\varepsilon_j \\sim \\mathcal{N}(0,\\sigma^2)$ are independent and identically distributed measurement noise terms. This model reflects that anodic polarization increases the magnitude of current exponentially with positive overpotential and cathodic polarization increases the magnitude with negative overpotential, using a natural-logarithm scaling that is linear in parameters. Assemble the parameter vector $\\boldsymbol{\\theta} = [\\ln(i_0),\\,s_a,\\,s_c]^\\top$. For $N$ measurements, define a design matrix $\\mathbf{X} \\in \\mathbb{R}^{N \\times 3}$ with rows\n$$\n\\mathbf{x}_j^\\top = \\big[1,\\; \\max(\\eta_j,0),\\; \\max(-\\eta_j,0)\\big],\n$$\nsuch that the forward model is written compactly as\n$$\n\\mathbf{y} = \\mathbf{X}\\,\\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon}, \\quad \\boldsymbol{\\varepsilon} \\sim \\mathcal{N}\\!\\left(\\mathbf{0},\\,\\sigma^2\\,\\mathbf{I}\\right).\n$$\nAssume a Gaussian prior on $\\boldsymbol{\\theta}$, $\\boldsymbol{\\theta} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_0,\\mathbf{\\Sigma}_0)$, where $\\boldsymbol{\\mu}_0 \\in \\mathbb{R}^3$ and $\\mathbf{\\Sigma}_0 \\in \\mathbb{R}^{3 \\times 3}$ are given. Construct the Bayesian inverse problem to infer $\\ln(i_0)$, $s_a$, and $s_c$ from polarization data $\\{(\\eta_j, \\lvert i_j \\rvert)\\}_{j=1}^N$ under the specified noise model, and derive the posterior distribution $p(\\boldsymbol{\\theta}\\mid \\mathbf{y})$.\n\nYour task is to:\n- Derive, from first principles and the model definitions above, the analytical form of the posterior distribution $p(\\boldsymbol{\\theta}\\mid \\mathbf{y})$ and its mean and covariance.\n- Explain the transformation to obtain a posterior characterization of $i_0$ itself from the posterior on $\\ln(i_0)$, making clear any assumptions made in the transformation.\n- Implement a program that, for each test case below, computes the posterior mean of $i_0$ (expressed in $\\mathrm{A/m^2}$) and the posterior means of $s_a$ and $s_c$ (expressed in $\\mathrm{V^{-1}}$). For $i_0$, use the posterior expectation under the log-normal mapping implied by the Gaussian posterior on $\\ln(i_0)$. Numerical answers should be real-valued floats.\n\nFundamental starting point: use the Butler–Volmer relation as the physical basis and its Tafel asymptotics to justify the piecewise-linear natural-logarithm model. Use the definition of Gaussian likelihood and Gaussian prior to derive the posterior via Bayes' rule without invoking any shortcut formulas not derived from first principles.\n\nPhysical units and angle units: current density must be treated in $\\mathrm{A/m^2}$, overpotential in $\\mathrm{V}$, and there are no angles in this problem.\n\nTest suite:\n- Test case $1$ (mixed anodic and cathodic data, moderate noise): $\\boldsymbol{\\mu}_0 = [\\ln(10^{-4}),\\,15,\\,15]^\\top$, $\\mathbf{\\Sigma}_0 = \\mathrm{diag}([1.0^2,\\,8.0^2,\\,8.0^2])$, $\\sigma = 0.1$, $\\boldsymbol{\\eta} = [-0.05,\\,-0.03,\\,-0.01,\\,0.01,\\,0.03,\\,0.05]$, measured magnitudes of current density $\\lvert \\mathbf{i} \\rvert = [0.00356,\\,0.002096,\\,0.001284,\\,0.001239,\\,0.001784,\\,0.002734]$ in $\\mathrm{A/m^2}$.\n- Test case $2$ (anodic-only data, low noise): $\\boldsymbol{\\mu}_0 = [\\ln(10^{-4}),\\,15,\\,15]^\\top$, $\\mathbf{\\Sigma}_0 = \\mathrm{diag}([1.0^2,\\,8.0^2,\\,8.0^2])$, $\\sigma = 0.05$, $\\boldsymbol{\\eta} = [0.01,\\,0.02,\\,0.03,\\,0.04,\\,0.05,\\,0.06,\\,0.07,\\,0.08,\\,0.09]$, measured magnitudes of current density $\\lvert \\mathbf{i} \\rvert = [0.000604,\\,0.000713,\\,0.000866,\\,0.001015,\\,0.001231,\\,0.001479,\\,0.001754,\\,0.002124,\\,0.002519]$ in $\\mathrm{A/m^2}$.\n- Test case $3$ (mixed data, high noise, few points): $\\boldsymbol{\\mu}_0 = [\\ln(10^{-4}),\\,15,\\,15]^\\top$, $\\mathbf{\\Sigma}_0 = \\mathrm{diag}([1.0^2,\\,8.0^2,\\,8.0^2])$, $\\sigma = 0.3$, $\\boldsymbol{\\eta} = [-0.04,\\,-0.02,\\,0.02,\\,0.04]$, measured magnitudes of current density $\\lvert \\mathbf{i} \\rvert = [0.00749,\\,0.002726,\\,0.003611,\\,0.003573]$ in $\\mathrm{A/m^2}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the posterior means for each test case, with each case reported as a list $[i_{0,\\mathrm{mean}},\\,s_{a,\\mathrm{mean}},\\,s_{c,\\mathrm{mean}}]$ and the overall output as a comma-separated list enclosed in square brackets. For example, an output with three test cases must look like: $[[r_{11},r_{12},r_{13}],[r_{21},r_{22},r_{23}],[r_{31},r_{32},r_{33}]]$, where each $r_{ij}$ is a float.",
            "solution": "The problem is valid. It is scientifically grounded in established principles of electrochemistry (Butler-Volmer kinetics and Tafel approximation), well-posed as a standard Bayesian linear regression problem, and objectively formulated with all necessary data provided. I will now proceed with the solution.\n\nThe task is to derive the posterior distribution for the parameter vector $\\boldsymbol{\\theta} = [\\ln(i_0),\\,s_a,\\,s_c]^\\top$ and then use it to compute the posterior means of $i_0$, $s_a$, and $s_c$. The derivation will start from first principles using Bayes' rule.\n\nThe physical basis for the model is the Butler-Volmer equation, which describes the current density $i$ as a function of the overpotential $\\eta$. For large overpotentials ($|\\eta| \\gg RT/(\\alpha F)$), this relationship simplifies to the Tafel equation, where the logarithm of the current density is linearly proportional to the overpotential. The provided piecewise model is a direct mathematical formulation of this Tafel behavior for both anodic ($\\eta  0$) and cathodic ($\\eta  0$) polarization, expressed in terms of the natural logarithm of the current density magnitude, which linearizes the model with respect to the parameters $\\ln(i_0)$, $s_a$, and $s_c$.\n\nThe Bayesian inference framework updates our knowledge of the parameters $\\boldsymbol{\\theta}$ from a prior belief $p(\\boldsymbol{\\theta})$ to a posterior belief $p(\\boldsymbol{\\theta}\\mid \\mathbf{y})$ after observing data $\\mathbf{y}$. This update is governed by Bayes' rule:\n$$\np(\\boldsymbol{\\theta}\\mid \\mathbf{y}) = \\frac{p(\\mathbf{y}\\mid \\boldsymbol{\\theta})\\,p(\\boldsymbol{\\theta})}{p(\\mathbf{y})} \\propto p(\\mathbf{y}\\mid \\boldsymbol{\\theta})\\,p(\\boldsymbol{\\theta})\n$$\nwhere $p(\\mathbf{y} \\mid \\boldsymbol{\\theta})$ is the likelihood, $p(\\boldsymbol{\\theta})$ is the prior, and $p(\\mathbf{y})$ is the evidence, which serves as a normalization constant.\n\nFirst, we define the likelihood function. The problem states the forward model as $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon}$, with noise $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0},\\,\\sigma^2\\mathbf{I})$. This implies that the conditional distribution of $\\mathbf{y}$ given $\\boldsymbol{\\theta}$ is a multivariate Gaussian:\n$$\n\\mathbf{y} \\mid \\boldsymbol{\\theta} \\sim \\mathcal{N}(\\mathbf{X}\\boldsymbol{\\theta},\\, \\sigma^2\\mathbf{I})\n$$\nThe probability density function (PDF) for the likelihood is therefore:\n$$\np(\\mathbf{y}\\mid \\boldsymbol{\\theta}) = \\frac{1}{(2\\pi\\sigma^2)^{N/2}} \\exp\\left(-\\frac{1}{2\\sigma^2}(\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta})^\\top(\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta})\\right)\n$$\nwhere $N$ is the number of measurements.\n\nNext, we define the prior distribution. The problem specifies a Gaussian prior on $\\boldsymbol{\\theta}$:\n$$\n\\boldsymbol{\\theta} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_0,\\,\\mathbf{\\Sigma}_0)\n$$\nThe PDF for the prior is:\n$$\np(\\boldsymbol{\\theta}) = \\frac{1}{(2\\pi)^{3/2}|\\mathbf{\\Sigma}_0|^{1/2}} \\exp\\left(-\\frac{1}{2}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0)^\\top \\mathbf{\\Sigma}_0^{-1}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0)\\right)\n$$\n\nNow, we combine the likelihood and prior to find the unnormalized posterior distribution:\n$$\np(\\boldsymbol{\\theta}\\mid \\mathbf{y}) \\propto \\exp\\left(-\\frac{1}{2\\sigma^2}(\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta})^\\top(\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta})\\right) \\exp\\left(-\\frac{1}{2}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0)^\\top \\mathbf{\\Sigma}_0^{-1}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0)\\right)\n$$\nWe can combine the exponents:\n$$\np(\\boldsymbol{\\theta}\\mid \\mathbf{y}) \\propto \\exp\\left(-\\frac{1}{2}\\left[\\frac{1}{\\sigma^2}(\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta})^\\top(\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\theta}) + (\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0)^\\top \\mathbf{\\Sigma}_0^{-1}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0)\\right]\\right)\n$$\nThe posterior is proportional to the exponential of a quadratic function of $\\boldsymbol{\\theta}$, which means the posterior distribution is also a Gaussian, say $\\mathcal{N}(\\boldsymbol{\\mu}_N, \\mathbf{\\Sigma}_N)$. To find its mean $\\boldsymbol{\\mu}_N$ and covariance $\\mathbf{\\Sigma}_N$, we must complete the square for $\\boldsymbol{\\theta}$ in the exponent. Let $L$ be the term inside the square brackets in the exponent:\n$$\nL = \\frac{1}{\\sigma^2}(\\mathbf{y}^\\top\\mathbf{y} - 2\\mathbf{y}^\\top\\mathbf{X}\\boldsymbol{\\theta} + \\boldsymbol{\\theta}^\\top\\mathbf{X}^\\top\\mathbf{X}\\boldsymbol{\\theta}) + (\\boldsymbol{\\theta}^\\top\\mathbf{\\Sigma}_0^{-1}\\boldsymbol{\\theta} - 2\\boldsymbol{\\mu}_0^\\top\\mathbf{\\Sigma}_0^{-1}\\boldsymbol{\\theta} + \\boldsymbol{\\mu}_0^\\top\\mathbf{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0)\n$$\nWe group terms based on their power of $\\boldsymbol{\\theta}$:\n$$\nL = \\boldsymbol{\\theta}^\\top \\left(\\frac{1}{\\sigma^2}\\mathbf{X}^\\top\\mathbf{X} + \\mathbf{\\Sigma}_0^{-1}\\right) \\boldsymbol{\\theta} - 2\\left(\\frac{1}{\\sigma^2}\\mathbf{y}^\\top\\mathbf{X} + \\boldsymbol{\\mu}_0^\\top\\mathbf{\\Sigma}_0^{-1}\\right)\\boldsymbol{\\theta} + \\text{const.}\n$$\nwhere `const.` includes terms not dependent on $\\boldsymbol{\\theta}$.\nThe general form for the exponent of a multivariate Gaussian $\\mathcal{N}(\\boldsymbol{\\mu}_N, \\mathbf{\\Sigma}_N)$ is proportional to $\\exp\\left(-\\frac{1}{2}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_N)^\\top \\mathbf{\\Sigma}_N^{-1}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_N)\\right)$. Expanding this gives:\n$$\n-\\frac{1}{2} \\left[ \\boldsymbol{\\theta}^\\top\\mathbf{\\Sigma}_N^{-1}\\boldsymbol{\\theta} - 2\\boldsymbol{\\mu}_N^\\top\\mathbf{\\Sigma}_N^{-1}\\boldsymbol{\\theta} + \\text{const.} \\right]\n$$\nBy comparing the quadratic term in $\\boldsymbol{\\theta}$ from our derived exponent with the general form, we can identify the inverse posterior covariance (or posterior precision matrix), $\\mathbf{\\Sigma}_N^{-1}$:\n$$\n\\mathbf{\\Sigma}_N^{-1} = \\mathbf{\\Sigma}_0^{-1} + \\frac{1}{\\sigma^2}\\mathbf{X}^\\top\\mathbf{X}\n$$\nThe posterior covariance matrix is the inverse of this expression:\n$$\n\\mathbf{\\Sigma}_N = \\left(\\mathbf{\\Sigma}_0^{-1} + \\frac{1}{\\sigma^2}\\mathbf{X}^\\top\\mathbf{X}\\right)^{-1}\n$$\nNext, by comparing the linear term in $\\boldsymbol{\\theta}$, we find:\n$$\n\\boldsymbol{\\mu}_N^\\top\\mathbf{\\Sigma}_N^{-1} = \\frac{1}{\\sigma^2}\\mathbf{y}^\\top\\mathbf{X} + \\boldsymbol{\\mu}_0^\\top\\mathbf{\\Sigma}_0^{-1}\n$$\nTaking the transpose of both sides and solving for the posterior mean $\\boldsymbol{\\mu}_N$:\n$$\n\\mathbf{\\Sigma}_N^{-1}\\boldsymbol{\\mu}_N = \\frac{1}{\\sigma^2}\\mathbf{X}^\\top\\mathbf{y} + \\mathbf{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0\n$$\n$$\n\\boldsymbol{\\mu}_N = \\mathbf{\\Sigma}_N \\left(\\mathbf{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0 + \\frac{1}{\\sigma^2}\\mathbf{X}^\\top\\mathbf{y}\\right)\n$$\nThus, the posterior distribution is proven to be Gaussian:\n$$\np(\\boldsymbol{\\theta}\\mid \\mathbf{y}) = \\mathcal{N}(\\boldsymbol{\\mu}_N, \\mathbf{\\Sigma}_N)\n$$\nThe posterior means of the parameters $s_a$ and $s_c$ are the second and third elements of $\\boldsymbol{\\mu}_N$, respectively.\n\nThe final step is to find the posterior mean of the exchange current density $i_0$. The first component of $\\boldsymbol{\\theta}$ is $\\theta_1 = \\ln(i_0)$. From the marginal properties of the multivariate normal distribution, the posterior distribution of $\\theta_1$ is also Gaussian:\n$$\n\\theta_1 \\mid \\mathbf{y} \\sim \\mathcal{N}(\\mu_{N,1}, \\Sigma_{N,11})\n$$\nwhere $\\mu_{N,1}$ is the first element of $\\boldsymbol{\\mu}_N$ and $\\Sigma_{N,11}$ is the first diagonal element of $\\mathbf{\\Sigma}_N$.\nThe relationship between $i_0$ and $\\theta_1$ is $i_0 = \\exp(\\theta_1)$. A variable that is the exponential of a normally distributed variable follows a log-normal distribution. The posterior mean of $i_0$ is its expectation with respect to the posterior distribution:\n$$\nE[i_0 \\mid \\mathbf{y}] = E[\\exp(\\theta_1) \\mid \\mathbf{y}]\n$$\nFor a normally distributed variable $Z \\sim \\mathcal{N}(\\mu, \\sigma^2)$, the expectation of its exponential is $E[\\exp(Z)] = \\exp(\\mu + \\sigma^2/2)$. Applying this property, we find the posterior mean of $i_0$:\n$$\nE[i_0 \\mid \\mathbf{y}] = \\exp(\\mu_{N,1} + \\Sigma_{N,11}/2)\n$$\nThis completes the derivation of all required quantities. The implementation will follow these derived formulas.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Bayesian inverse problem for electrochemical Tafel kinetics.\n    Computes the posterior means for i0, sa, and sc for given test cases.\n    \"\"\"\n    \n    test_cases = [\n        # Test case 1 (mixed anodic and cathodic data, moderate noise)\n        {\n            \"mu_0\": np.array([np.log(1e-4), 15.0, 15.0]),\n            \"Sigma_0\": np.diag([1.0**2, 8.0**2, 8.0**2]),\n            \"sigma\": 0.1,\n            \"eta\": np.array([-0.05, -0.03, -0.01, 0.01, 0.03, 0.05]),\n            \"i_mag\": np.array([0.00356, 0.002096, 0.001284, 0.001239, 0.001784, 0.002734]),\n        },\n        # Test case 2 (anodic-only data, low noise)\n        {\n            \"mu_0\": np.array([np.log(1e-4), 15.0, 15.0]),\n            \"Sigma_0\": np.diag([1.0**2, 8.0**2, 8.0**2]),\n            \"sigma\": 0.05,\n            \"eta\": np.array([0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09]),\n            \"i_mag\": np.array([0.000604, 0.000713, 0.000866, 0.001015, 0.001231, 0.001479, 0.001754, 0.002124, 0.002519]),\n        },\n        # Test case 3 (mixed data, high noise, few points)\n        {\n            \"mu_0\": np.array([np.log(1e-4), 15.0, 15.0]),\n            \"Sigma_0\": np.diag([1.0**2, 8.0**2, 8.0**2]),\n            \"sigma\": 0.3,\n            \"eta\": np.array([-0.04, -0.02, 0.02, 0.04]),\n            \"i_mag\": np.array([0.00749, 0.002726, 0.003611, 0.003573]),\n        },\n    ]\n\n    all_results = []\n    for case in test_cases:\n        mu_0 = case[\"mu_0\"]\n        Sigma_0 = case[\"Sigma_0\"]\n        sigma = case[\"sigma\"]\n        eta = case[\"eta\"]\n        i_mag = case[\"i_mag\"]\n\n        # 1. Construct the data vector y and design matrix X\n        y = np.log(i_mag)\n        N = len(eta)\n        # The design matrix X has rows [1, max(eta_j, 0), max(-eta_j, 0)]\n        X = np.zeros((N, 3))\n        X[:, 0] = 1.0\n        X[:, 1] = np.maximum(eta, 0)\n        X[:, 2] = np.maximum(-eta, 0)\n\n        # 2. Calculate posterior distribution parameters\n        #    p(theta|y) is N(mu_N, Sigma_N)\n        \n        # Prior precision matrix\n        Sigma_0_inv = np.linalg.inv(Sigma_0)\n        \n        # Likelihood precision\n        sigma_sq = sigma**2\n        \n        # Posterior precision matrix: Sigma_N_inv = Sigma_0_inv + (1/sigma^2) * X^T * X\n        Sigma_N_inv = Sigma_0_inv + (1.0 / sigma_sq) * (X.T @ X)\n        \n        # Posterior covariance matrix: Sigma_N = (Sigma_N_inv)^-1\n        Sigma_N = np.linalg.inv(Sigma_N_inv)\n        \n        # Posterior mean vector: mu_N = Sigma_N * (Sigma_0_inv * mu_0 + (1/sigma^2) * X^T * y)\n        mu_N = Sigma_N @ (Sigma_0_inv @ mu_0 + (1.0 / sigma_sq) * (X.T @ y))\n        \n        # 3. Extract the required values\n        \n        # Posterior means of theta = [ln(i0), sa, sc]\n        # mu_N[0] is the posterior mean of ln(i0)\n        # mu_N[1] is the posterior mean of sa\n        # mu_N[2] is the posterior mean of sc\n        sa_mean = mu_N[1]\n        sc_mean = mu_N[2]\n\n        # The posterior for ln(i0) is N(mu_N[0], Sigma_N[0,0])\n        # The posterior for i0 is log-normal. Its mean is exp(mu + var/2).\n        mu_ln_i0 = mu_N[0]\n        var_ln_i0 = Sigma_N[0, 0]\n        i0_mean = np.exp(mu_ln_i0 + var_ln_i0 / 2.0)\n        \n        all_results.append([i0_mean, sa_mean, sc_mean])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}