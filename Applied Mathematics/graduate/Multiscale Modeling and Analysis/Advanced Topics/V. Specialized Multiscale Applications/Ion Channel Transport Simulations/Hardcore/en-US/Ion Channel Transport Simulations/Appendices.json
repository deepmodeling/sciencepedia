{
    "hands_on_practices": [
        {
            "introduction": "This practice establishes the bedrock of continuum electrodiffusion theory. By solving the one-dimensional Nernst-Planck equation for a simple linear potential, you will derive the celebrated Goldman-Hodgkin-Katz (GHK) flux equation, a cornerstone for understanding how concentration gradients and electric fields jointly drive ionic current . This exercise sharpens your skills in solving differential equations in a physical context and provides intuition for the interplay between diffusion and drift.",
            "id": "3771120",
            "problem": "Consider a single-species ionic transport through a one-dimensional channel of length $L$ connecting two well-stirred reservoirs. The left reservoir at $z=0$ has fixed concentration $c_{L}$ and the right reservoir at $z=L$ has fixed concentration $c_{R}$. The temperature is $T$, the ion valence is $z$, the elementary charge is $e$, and the diffusion coefficient is spatially constant $D$. Assume steady state, so the particle flux $J$ is independent of $z$. The electrostatic potential inside the channel is prescribed and consists only of the applied voltage drop $V$ distributed linearly across the channel, namely $\\phi(z)=\\phi_{0}-V z/L$, where $\\phi_{0}$ is a constant offset. Ignore space-charge coupling and treat $\\phi(z)$ as given. Starting from the one-dimensional Nernst-Planck (NP) equation and the Einstein relation linking drift mobility to diffusion, derive the steady-state concentration profile $c(z)$ and the constant flux $J$ under the boundary conditions $c(0)=c_{L}$ and $c(L)=c_{R}$. Identify the limiting forms of $J$ corresponding to diffusion-dominated transport (small applied voltage) and drift-dominated transport (large applied voltage), making the dependence on $c_{L}$ and $c_{R}$ explicit. Define the dimensionless voltage $U = z e V/(k_{B} T)$, where $k_{B}$ is the Boltzmann constant.\n\nProvide as your final answer a single closed-form analytic expression for the steady-state flux $J$ in terms of $D$, $L$, $c_{L}$, $c_{R}$, and $U$. No numerical evaluation is required.",
            "solution": "The problem is evaluated as scientifically sound, well-posed, and objective. It presents a standard, solvable problem in physical chemistry and biophysics. All necessary parameters and conditions are provided, and no contradictions are present.\n\nThe starting point for this problem is the one-dimensional steady-state Nernst-Planck (NP) equation, which describes the flux $J$ of an ionic species under the influence of both a concentration gradient and an electric field. The flux $J$ is considered constant in steady state. The NP equation is:\n$$J = -D \\frac{dc}{dz} + J_{\\text{drift}}$$\nwhere $D$ is the diffusion coefficient, $c(z)$ is the ion concentration at position $z$, and $J_{\\text{drift}}$ is the drift flux component due to an external force. The drift flux is given by $J_{\\text{drift}} = c v_{\\text{drift}}$, where the drift velocity $v_{\\text{drift}}$ is related to the applied force $F$ by the mobility $\\mu$, such that $v_{\\text{drift}} = \\mu F$. The force on an ion is the negative gradient of its potential energy, $F = -\\frac{d\\Phi_{tot}}{dz}$. Therefore, the drift flux is $J_{\\text{drift}} = -c \\mu \\frac{d\\Phi_{tot}}{dz}$, and the full NP equation is:\n$$J = -D \\frac{dc}{dz} - c \\mu \\frac{d\\Phi_{tot}}{dz}$$\nThe Einstein relation connects the mobility $\\mu$ and the diffusion coefficient $D$ via $\\mu = D/(k_B T)$, where $k_B$ is the Boltzmann constant and $T$ is the absolute temperature. Substituting this into the NP equation yields:\n$$J = -D \\left( \\frac{dc}{dz} + \\frac{c}{k_B T} \\frac{d\\Phi_{tot}}{dz} \\right)$$\nThe potential energy $\\Phi_{tot}(z)$ of an ion with valence (charge number) $z$ and elementary charge $e$ in an electrostatic potential $\\phi(z)$ is $\\Phi_{tot}(z) = ze\\phi(z)$. The problem prescribes a linear potential profile:\n$$\\phi(z) = \\phi_{0} - \\frac{Vz}{L}$$\nwhere $V$ is the applied voltage drop across the channel of length $L$. The gradient of the potential energy is therefore:\n$$\\frac{d\\Phi_{tot}}{dz} = \\frac{d}{dz} \\left( ze \\left(\\phi_{0} - \\frac{Vz}{L}\\right) \\right) = - \\frac{zeV}{L}$$\nSubstituting this into the NP equation gives:\n$$J = -D \\left( \\frac{dc}{dz} - \\frac{zeV}{k_B T L} c(z) \\right)$$\nUsing the definition of the dimensionless voltage $U = zeV/(k_B T)$, the equation simplifies to:\n$$-\\frac{J}{D} = \\frac{dc}{dz} - \\frac{U}{L} c(z)$$\nThis is a first-order linear ordinary differential equation for the concentration profile $c(z)$:\n$$\\frac{dc}{dz} - \\frac{U}{L} c(z) = -\\frac{J}{D}$$\nTo solve this ODE, we use an integrating factor $I(z)$, which is given by:\n$$I(z) = \\exp \\left( \\int -\\frac{U}{L} dz \\right) = \\exp \\left(-\\frac{Uz}{L}\\right)$$\nMultiplying the ODE by $I(z)$:\n$$\\exp\\left(-\\frac{Uz}{L}\\right) \\frac{dc}{dz} - \\frac{U}{L} \\exp\\left(-\\frac{Uz}{L}\\right) c(z) = -\\frac{J}{D} \\exp\\left(-\\frac{Uz}{L}\\right)$$\nThe left side is the derivative of a product:\n$$\\frac{d}{dz} \\left( c(z) \\exp\\left(-\\frac{Uz}{L}\\right) \\right) = -\\frac{J}{D} \\exp\\left(-\\frac{Uz}{L}\\right)$$\nWe integrate both sides from $z=0$ to an arbitrary position $z$ within the channel, assuming $U \\neq 0$:\n$$\\int_{0}^{z} \\frac{d}{d\\zeta} \\left( c(\\zeta) \\exp\\left(-\\frac{U\\zeta}{L}\\right) \\right) d\\zeta = \\int_{0}^{z} -\\frac{J}{D} \\exp\\left(-\\frac{U\\zeta}{L}\\right) d\\zeta$$\n$$c(z)\\exp\\left(-\\frac{Uz}{L}\\right) - c(0)\\exp(0) = -\\frac{J}{D} \\left[-\\frac{L}{U} \\exp\\left(-\\frac{U\\zeta}{L}\\right)\\right]_{0}^{z}$$\nApplying the boundary condition $c(0) = c_L$:\n$$c(z)\\exp\\left(-\\frac{Uz}{L}\\right) - c_L = \\frac{JL}{DU} \\left( \\exp\\left(-\\frac{Uz}{L}\\right) - 1 \\right)$$\nSolving for the concentration profile $c(z)$:\n$$c(z) = c_L \\exp\\left(\\frac{Uz}{L}\\right) + \\frac{JL}{DU} \\left( 1 - \\exp\\left(\\frac{Uz}{L}\\right) \\right)$$\nThis is the steady-state concentration profile $c(z)$ inside the channel.\n\nTo find the constant flux $J$, we apply the second boundary condition, $c(L) = c_R$:\n$$c_R = c_L \\exp\\left(\\frac{UL}{L}\\right) + \\frac{JL}{DU} \\left( 1 - \\exp\\left(\\frac{UL}{L}\\right) \\right)$$\n$$c_R = c_L \\exp(U) + \\frac{JL}{DU} (1 - \\exp(U))$$\nNow, we solve for $J$:\n$$c_R - c_L \\exp(U) = \\frac{JL}{DU} (1 - \\exp(U))$$\n$$J = \\frac{DU}{L} \\frac{c_R - c_L \\exp(U)}{1 - \\exp(U)}$$\nMultiplying the numerator and denominator by $-1$ gives the more common form:\n$$J = \\frac{DU}{L} \\frac{c_L \\exp(U) - c_R}{\\exp(U) - 1}$$\nThis is the Goldman-Hodgkin-Katz (GHK) flux equation, which is the required expression for the steady-state flux $J$.\n\nFinally, we analyze the limiting forms of $J$.\n\n1.  **Diffusion-dominated transport (small voltage, $U \\to 0$):**\n    As $U \\to 0$, the expression for $J$ becomes an indeterminate form $0/0$. We use L'Hôpital's rule on the part of the expression that depends on $U$. Let $f(U) = U(c_L \\exp(U) - c_R)$ and $g(U) = \\exp(U) - 1$.\n    $$J = \\frac{D}{L} \\lim_{U \\to 0} \\frac{f(U)}{g(U)} = \\frac{D}{L} \\lim_{U \\to 0} \\frac{f'(U)}{g'(U)}$$\n    The derivatives are:\n    $$f'(U) = (c_L \\exp(U) - c_R) + U(c_L \\exp(U))$$\n    $$g'(U) = \\exp(U)$$\n    Taking the limit:\n    $$\\lim_{U \\to 0} \\frac{f'(U)}{g'(U)} = \\frac{(c_L \\exp(0) - c_R) + 0}{\\exp(0)} = c_L - c_R$$\n    So, the limiting flux is:\n    $$J_{U \\to 0} = \\frac{D}{L} (c_L - c_R)$$\n    This is Fick's first law of diffusion, where the flux is driven by the concentration difference $(c_L - c_R)$.\n\n2.  **Drift-dominated transport (large voltage, $|U| \\to \\infty$):**\n    a. For large positive voltage ($U \\to +\\infty$): $\\exp(U)$ becomes very large, so $\\exp(U)-1 \\approx \\exp(U)$.\n    $$J_{U \\to +\\infty} \\approx \\frac{DU}{L} \\frac{c_L \\exp(U)}{\\exp(U)} = \\frac{DU c_L}{L}$$\n    The flux is proportional to the concentration $c_L$ at the source reservoir and the applied voltage (since $U \\propto V$). This represents ions being swept from the high-concentration side by a strong electric field.\n\n    b. For large negative voltage ($U \\to -\\infty$): $\\exp(U) \\to 0$.\n    $$J_{U \\to -\\infty} \\approx \\frac{DU}{L} \\frac{c_L(0) - c_R}{0 - 1} = \\frac{DU c_R}{L}$$\n    The flux is now proportional to the concentration $c_R$ at the other reservoir and the applied voltage. The negative sign of $U$ indicates the flux is in the opposite direction, driven by the field pulling ions from the reservoir at $z=L$.\n\nIn both drift-dominated cases, the flux is linear with voltage $V$ and with the concentration of the source reservoir.",
            "answer": "$$\\boxed{\\frac{DU}{L} \\frac{c_{L} \\exp(U) - c_{R}}{\\exp(U) - 1}}$$"
        },
        {
            "introduction": "Real ions have finite size, a feature ignored in the simple Nernst-Planck model. This practice introduces the Bikerman model to account for steric effects, demonstrating how ionic crowding leads to the experimentally observed phenomenon of current saturation at high concentrations . Through both derivation and coding, you will explore how this crucial physical refinement corrects the unrealistic predictions of ideal models and connects to modern statistical mechanical theories like DFT.",
            "id": "3771085",
            "problem": "You will implement and analyze how the inclusion of a Bikerman steric term in a one-dimensional Nernst–Planck (NP) model modifies the high-concentration behavior of ionic current in a narrow ion channel, and connect the modification to predictions from Density Functional Theory (DFT). Begin from the following fundamental base:\n\n- The Nernst–Planck (NP) expression for the flux of an ionic species $i$ under an electrochemical potential gradient is $J_i = -\\dfrac{D_i}{k_{\\mathrm{B}} T} C_i \\dfrac{d \\mu_i}{dx}$, where $D_i$ is the diffusion coefficient, $C_i$ is the number density, $k_{\\mathrm{B}}$ is the Boltzmann constant, and $T$ is the absolute temperature.\n- The electrochemical potential includes an electrostatic contribution, $z_i e \\phi$, where $z_i$ is the valence, $e$ is the elementary charge, and $\\phi$ is the electric potential.\n- The Bikerman lattice-gas steric contribution to the chemical potential arises from the configurational entropy of finite-sized ions occupying a lattice. For equal-sized ions with particle volume $v_i = v$, the dimensionless occupancy fraction is $\\theta = \\sum_i v C_i$, and the excess term enters the chemical potential through the mixing entropy implied by a lattice-gas free energy.\n\nAssume a symmetric binary electrolyte with $z_+ = +1$ and $z_- = -1$, equal diffusion coefficients $D_+ = D_- = D$, and equal-sized ions of volume $v_+ = v_- = v$. Consider a uniform electric field $E = V/L$ over a channel of length $L$ and cross-sectional area $A$ with no spatial variation of $D$ or $v$. Work in the number density representation (particles per cubic meter), so that $v$ is in $\\mathrm{m}^3$ per particle and the occupancy fraction is $\\theta = 2 v C$ for equal concentrations $C_+ = C_- = C$.\n\nTasks:\n\n1. Derive, from first principles using the Nernst–Planck flux definition and the lattice-gas steric modification to the chemical potential, how the classical current density $j_{\\mathrm{np}}$ depends on $C$ and $E$, and separately how the Bikerman-modified current density $j_{\\mathrm{bik}}$ depends on $C$, $E$, and the free-volume fraction associated with $\\theta$. Do not assume any shortcut formulas; explicitly carry the thermodynamic factors implied by the lattice-gas model through the transport argument. Express the total electrical current $I$ in amperes as $I = A j$.\n2. Identify the mechanism by which the steric term changes the saturation behavior of current at high concentration. Explain what saturates and why, and compare that behavior to what Density Functional Theory (DFT) of lattice gases predicts about transport in crowded environments.\n3. Implement a program that computes $I_{\\mathrm{np}}$ and $I_{\\mathrm{bik}}$ for the following test suite of parameter values. All physical constants must be used explicitly with their values, and all quantities must be computed and reported in consistent physical units:\n   - Boltzmann constant $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$.\n   - Elementary charge $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$.\n   - Absolute temperature $T = 298\\,\\mathrm{K}$.\n   - Diffusion coefficient $D = 10^{-9}\\,\\mathrm{m^2/s}$.\n   - Channel length $L = 5 \\times 10^{-9}\\,\\mathrm{m}$.\n   - Cross-sectional area $A = 2 \\times 10^{-18}\\,\\mathrm{m^2}$.\n   - Valence magnitude $|z| = 1$.\n   - The test suite consists of six cases, each given by $(C, v, V)$ with $C$ in $\\mathrm{m^{-3}}$ (number density), $v$ in $\\mathrm{m^3}$ (per particle), and $V$ in volts:\n     1. $(1.0 \\times 10^{25}, 1.0 \\times 10^{-28}, 0.05)$, a dilute case.\n     2. $(2.5 \\times 10^{27}, 1.0 \\times 10^{-28}, 0.05)$, intermediate case near the predicted peak of Bikerman-modified conduction.\n     3. $(4.95 \\times 10^{27}, 1.0 \\times 10^{-28}, 0.05)$, near the packing limit.\n     4. $(2.5 \\times 10^{27}, 5.0 \\times 10^{-29}, 0.05)$, smaller ion volume at the same concentration.\n     5. $(2.5 \\times 10^{27}, 1.0 \\times 10^{-28}, 0.15)$, higher applied voltage at the intermediate concentration.\n     6. $(0.0, 1.0 \\times 10^{-28}, 0.05)$, zero concentration boundary case.\n4. For each case, compute:\n   - The classical NP current $I_{\\mathrm{np}}$ in $\\mathrm{A}$.\n   - The Bikerman-modified current $I_{\\mathrm{bik}}$ in $\\mathrm{A}$.\n   - The ratio $r = I_{\\mathrm{bik}}/I_{\\mathrm{np}}$ as a decimal, with the convention that if $I_{\\mathrm{np}} = 0$ then $r = 0.0$.\n5. Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as\n   $[I_{\\mathrm{np}}^{(1)}, I_{\\mathrm{bik}}^{(1)}, r^{(1)}, I_{\\mathrm{np}}^{(2)}, I_{\\mathrm{bik}}^{(2)}, r^{(2)}, \\dots, I_{\\mathrm{np}}^{(6)}, I_{\\mathrm{bik}}^{(6)}, r^{(6)}]$.\nAll currents must be expressed in amperes, as floating-point numbers, using SI units throughout.\n\nThe problem requires a derivation that starts from the NP flux and the lattice-gas steric free-energy contribution, explains the physical mechanism of saturation at high $C$, and connects this mechanism to Density Functional Theory (DFT) predictions for crowded ionic systems. The numerical implementation must reflect this derivation and compute the specified quantities for the test suite. The solution should not introduce or rely on any shortcut formulas not justified from the stated base.",
            "solution": "The problem requires the derivation and analysis of ionic current in a nanochannel, comparing the classical Nernst–Planck (NP) model with a modified version incorporating steric effects as described by the Bikerman model for crowded systems. The analysis must be grounded in first principles, and the derived expressions must be implemented numerically.\n\nThe fundamental expression for the flux of an ionic species $i$ is given by the Nernst–Planck equation, which relates the flux $J_i$ to the gradient of the electrochemical potential $\\tilde{\\mu}_i$:\n$$J_i = -\\frac{D_i C_i}{k_{\\mathrm{B}} T} \\frac{d\\tilde{\\mu}_i}{dx}$$\nHere, $D_i$ is the diffusion coefficient, $C_i$ is the number density, $k_{\\mathrm{B}}$ is the Boltzmann constant, and $T$ is the temperature. The total electrical current density $j$ is the sum of the partial currents from each species, $j = \\sum_i z_i e J_i$, where $z_i$ is the valence and $e$ is the elementary charge. The total current $I$ through a channel of area $A$ is $I = jA$.\n\n**1. Derivation of Classical and Bikerman-Modified Currents**\n\nWe consider a symmetric binary electrolyte with $z_+ = +1$, $z_- = -1$, equal concentrations $C_+ = C_- = C$, and equal diffusion coefficients $D_+ = D_- = D$. The channel has a uniform electric field $E = V/L$ and the concentration $C$ is assumed to be uniform along the channel length $L$.\n\n**Classical Nernst–Planck (NP) Current**\n\nIn the classical model, ions are treated as point particles. The electrochemical potential $\\tilde{\\mu}_i$ is the sum of the ideal chemical potential and the electrostatic potential:\n$$\\tilde{\\mu}_i^{\\mathrm{ideal}} = \\mu_i^0 + k_{\\mathrm{B}} T \\ln(C_i) + z_i e \\phi(x)$$\nwhere $\\mu_i^0$ is a standard state potential. The gradient of the electrochemical potential is:\n$$\\frac{d\\tilde{\\mu}_i^{\\mathrm{ideal}}}{dx} = k_{\\mathrm{B}} T \\frac{1}{C_i} \\frac{dC_i}{dx} + z_i e \\frac{d\\phi}{dx}$$\nUnder the stated condition of uniform concentration, $\\frac{dC_i}{dx} = 0$. The electric field is uniform, $E = - \\frac{d\\phi}{dx}$, so $\\frac{d\\phi}{dx} = -E$. The gradient simplifies to:\n$$\\frac{d\\tilde{\\mu}_i^{\\mathrm{ideal}}}{dx} = -z_i e E$$\nSubstituting this into the flux equation for cations ($i=+$) and anions ($i=-$):\n$$J_+ = -\\frac{D C}{k_{\\mathrm{B}} T} (-z_+ e E) = \\frac{D C e E}{k_{\\mathrm{B}} T}$$\n$$J_- = -\\frac{D C}{k_{\\mathrm{B}} T} (-z_- e E) = \\frac{D C (-e) E}{k_{\\mathrm{B}} T} = -\\frac{D C e E}{k_{\\mathrm{B}} T}$$\nThe total electrical current density $j_{\\mathrm{np}}$ is:\n$$j_{\\mathrm{np}} = z_+ e J_+ + z_- e J_- = (+1)e J_+ + (-1)e J_- = e(J_+ - J_-)$$\n$$j_{\\mathrm{np}} = e \\left( \\frac{D C e E}{k_{\\mathrm{B}} T} - \\left(-\\frac{D C e E}{k_{\\mathrm{B}} T}\\right) \\right) = \\frac{2 D e^2 C E}{k_{\\mathrm{B}} T}$$\nThe total current $I_{\\mathrm{np}}$ is obtained by multiplying by the area $A$ and substituting $E=V/L$:\n$$I_{\\mathrm{np}} = A j_{\\mathrm{np}} = \\frac{2 A D e^2 V C}{k_{\\mathrm{B}} T L}$$\nThis classical result predicts that the current increases linearly and without bound with concentration $C$.\n\n**Bikerman-Modified Current**\n\nThe Bikerman model accounts for the finite volume of ions. This steric repulsion is introduced through the lattice-gas concept. In a crowded environment, the movement of an ion is hindered by its neighbors. The probability of an ion successfully moving to an adjacent position is proportional to the probability that the target position is vacant. This introduces a kinetic slowdown. The simplest mean-field approximation for this effect is to modify the diffusion coefficient by a factor equal to the fraction of available free volume, $(1-\\theta)$, where $\\theta$ is the total volume fraction occupied by ions.\nGiven equal-sized ions of volume $v$, the occupancy fraction is $\\theta = vC_+ + vC_- = 2vC$. The effective diffusion coefficient becomes concentration-dependent:\n$$D_{\\text{eff}}(C) = D(1-\\theta) = D(1-2vC)$$\nwhere $D$ is the diffusion coefficient at infinite dilution. This modification is a direct consequence of the configurational entropy term in the lattice-gas free energy, which, when carried through a kinetic theory or DFT framework, results in a transport coefficient that vanishes as the system approaches close packing ($\\theta \\to 1$).\n\nWe replace $D$ in the classical derivation with $D_{\\text{eff}}(C)$. All other steps remain the same, as the assumption of uniform concentration still isolates the drift component of the current, which is proportional to the mobility, and hence to the diffusion coefficient.\nThe Bikerman-modified current density $j_{\\mathrm{bik}}$ is therefore:\n$$j_{\\mathrm{bik}} = \\frac{2 D_{\\text{eff}}(C) e^2 C E}{k_{\\mathrm{B}} T} = \\frac{2 D(1-2vC) e^2 C E}{k_{\\mathrm{B}} T}$$\nThe total Bikerman-modified current $I_{\\mathrm{bik}}$ is:\n$$I_{\\mathrm{bik}} = A j_{\\mathrm{bik}} = \\frac{2 A D e^2 V C(1-2vC)}{k_{\\mathrm{B}} T L}$$\n\n**2. Mechanism of Saturation and Connection to Density Functional Theory (DFT)**\n\nThe classical NP model predicts $I_{\\mathrm{np}} \\propto C$, a monotonically increasing function. This is physically unrealistic at high concentrations. The Bikerman modification introduces the factor $C(1-2vC)$, which is a parabolic function of $C$.\n- At low concentrations ($2vC \\ll 1$), $I_{\\mathrm{bik}} \\approx I_{\\mathrm{np}}$, showing linear behavior.\n- As $C$ increases, the term $(1-2vC)$ decreases, representing the reduction in ionic mobility due to crowding. The current is a product of the number of charge carriers ($C$) and their effective mobility (proportional to $D(1-2vC)$).\n- This competition leads to a maximum current at a specific concentration. By taking the derivative of $C(1-2vC)$ with respect to $C$ and setting it to zero ($1-4vC=0$), we find the peak current occurs at $C = 1/(4v)$, which corresponds to an occupancy of $\\theta = 2vC = 0.5$.\n- Beyond this peak, adding more ions hinders transport more than it adds charge carriers, causing the total current to *decrease*.\n- As $C$ approaches the physical packing limit $C \\to 1/(2v)$ (i.e., $\\theta \\to 1$), the term $(1-2vC) \\to 0$, and the current $I_{\\mathrm{bik}} \\to 0$. The channel becomes completely clogged, and macroscopic transport ceases. This phenomenon is known as ionic current saturation and blockade.\n\nThis behavior aligns with the predictions of Density Functional Theory (DFT). DFT provides a more rigorous framework than the simple mean-field Bikerman model for describing fluids with hard-core repulsion and other interactions. DFT calculations for transport in crowded systems confirm that conductivity is a non-monotonic function of density. While the simple $(1-\\theta)$ factor is a first-order approximation, DFT would yield a more complex thermodynamic factor that captures the detailed structural correlations of the fluid, but the qualitative result—a turnover and subsequent decrease in current at high density—remains a fundamental feature of transport in crowded environments.\n\n**3.  4. Computational Implementation**\n\nThe formulas derived above will be used for the numerical computation.\n$$I_{\\mathrm{np}} = \\left( \\frac{2 A D e^2 V}{k_{\\mathrm{B}} T L} \\right) C$$\n$$I_{\\mathrm{bik}} = I_{\\mathrm{np}} \\times (1-2vC)$$\nThe ratio is $r = I_{\\mathrm{bik}}/I_{\\mathrm{np}} = (1-2vC)$. If $C=0$, then $I_{\\mathrm{np}}=0$ and $r$ is defined as $0.0$.\nAll parameters will be used in base SI units.\n- $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$\n- $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$\n- $T = 298\\,\\mathrm{K}$\n- $D = 10^{-9}\\,\\mathrm{m^2/s}$\n- $L = 5 \\times 10^{-9}\\,\\mathrm{m}$\n- $A = 2 \\times 10^{-18}\\,\\mathrm{m^2}$\n\nThe test suite will be processed according to these expressions. For any case where $2vC \\ge 1$, the Bikerman model predicts a zero or unphysical negative current; we will adhere to the formula, which reflects the model's prediction of transport cessation. However, for the given test cases, the occupancy $\\theta = 2vC$ does not exceed $1$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes classical Nernst-Planck (NP) and Bikerman-modified ionic currents\n    for a symmetric binary electrolyte in a narrow channel.\n    \"\"\"\n    # Physical constants in SI units\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    \n    # System parameters in SI units\n    T = 298.0  # Absolute temperature in K\n    D = 1.0e-9   # Diffusion coefficient in m^2/s\n    L = 5.0e-9   # Channel length in m\n    A = 2.0e-18  # Cross-sectional area in m^2\n    \n    # Test suite: (C, v, V)\n    # C: number density in m^-3\n    # v: ion volume in m^3\n    # V: applied voltage in V\n    test_cases = [\n        (1.0e25, 1.0e-28, 0.05),\n        (2.5e27, 1.0e-28, 0.05),\n        (4.95e27, 1.0e-28, 0.05),\n        (2.5e27, 5.0e-29, 0.05),\n        (2.5e27, 1.0e-28, 0.15),\n        (0.0, 1.0e-28, 0.05),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        C, v, V = case\n        \n        # Calculate the common prefactor for current calculation\n        # This prefactor groups all constants and system parameters\n        # Prefactor = (2 * A * D * e^2 * V) / (k_B * T * L)\n        # Note: I_np = prefactor * C\n        if K_B * T * L == 0:\n            prefactor = 0.0 # Avoid division by zero, though parameters prevent this\n        else:\n            prefactor = (2 * A * D * E_CHARGE**2 * V) / (K_B * T * L)\n\n        # 1. Classical Nernst-Planck current (I_np)\n        # I_np = prefactor * C\n        i_np = prefactor * C\n        \n        # 2. Bikerman-modified current (I_bik)\n        # The modification is a steric factor (1 - theta), where theta = 2*v*C\n        occupancy_fraction = 2 * v * C\n        \n        # The model assumes theta  1 for physical validity. All test cases satisfy this.\n        steric_factor = 1.0 - occupancy_fraction\n        \n        # I_bik = prefactor * C * (1 - 2*v*C) = I_np * (1 - 2*v*C)\n        i_bik = i_np * steric_factor\n        \n        # 3. Ratio r = I_bik / I_np\n        # According to the problem, if I_np is 0, r is 0.0.\n        if i_np == 0.0:\n            ratio = 0.0\n        else:\n            ratio = i_bik / i_np\n            \n        results.extend([i_np, i_bik, ratio])\n\n    # Format the final output as a comma-separated list in brackets\n    # Example: [I_np_1, I_bik_1, r_1, I_np_2, I_bik_2, r_2, ...]\n    formatted_results = [f\"{res:.6e}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "An ion's electrostatic environment inside a channel is profoundly shaped by the low-dielectric protein and lipid membrane surrounding it. This practice delves into this dielectric boundary effect, using the method of images to calculate the repulsive force an ion experiences near the channel wall . Mastering this calculation is essential for understanding the energetic barriers to permeation and for building accurate electrostatic models in both continuum and particle-based simulations.",
            "id": "3771094",
            "problem": "An ion channel is modeled as a long cylindrical pore of radius $a$ filled with water, embedded in a low-dielectric medium representing the protein or lipid wall. In multiscale modeling and analysis of ion channel transport simulations, dielectric boundary effects arise because the electric displacement must be continuous across material interfaces, reshaping the electrostatic potential near the water–wall boundary and inducing effective forces on ions due to polarization charges. Starting from classical electrostatics, where the electrostatic potential $\\phi$ satisfies $\\nabla \\cdot \\left( \\epsilon(\\mathbf{r}) \\nabla \\phi(\\mathbf{r}) \\right) = -\\rho(\\mathbf{r})$ and, at an interface between two linear dielectrics, $\\phi$ is continuous and $\\epsilon \\,\\partial \\phi/\\partial n$ is continuous, define the dielectric boundary effect for an ion near the wall and compute the image-charge force induced by the wall on a monovalent ion located near the pore boundary.\n\nConsider an infinite cylindrical pore of radius $a = 0.5\\,\\mathrm{nm}$ filled with water of relative permittivity $\\epsilon_{\\mathrm{w}} = 80$, surrounded by a low-dielectric medium of relative permittivity $\\epsilon_{\\mathrm{m}} = 2$. A point ion of charge $q = e$ (elementary charge) is placed at radial position $r_0 = 0.45\\,\\mathrm{nm}$ along the cylinder axis, so that its shortest distance to the wall is $d = a - r_0$. Assume $d \\ll a$ so that the curvature of the cylindrical boundary can be neglected locally and the dielectric boundary may be treated as planar for the purpose of computing the image-charge force. Use the vacuum permittivity $\\epsilon_0 = 8.854\\,187\\,817 \\times 10^{-12}\\,\\mathrm{F/m}$ and the elementary charge $e = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{C}$. Under these conditions, derive from the electrostatic boundary conditions the appropriate image-charge representation of the dielectric boundary effect for a planar interface and compute the magnitude of the radial force on the ion due to this effect. Express the final force in Newtons and round your answer to four significant figures.",
            "solution": "The problem requires the calculation of the image-charge force on a monovalent ion near the boundary of a cylindrical pore. The problem statement has been validated and is found to be scientifically grounded, well-posed, and internally consistent.\n\nThe dielectric boundary effect refers to the modification of the electrostatic potential and field of a charge when it is near an interface between two materials with different dielectric permittivities. Due to the boundary conditions of classical electrostatics, polarization charges are induced at the interface. The collective electric field from these polarization charges, often called the reaction field, exerts a force on the original charge. The method of images is a powerful technique to calculate this reaction field by replacing the complex distribution of polarization charges with a small number of fictitious point charges, or \"image charges\".\n\nThe problem specifies an ion channel modeled as an infinite cylinder of radius $a = 0.5\\,\\mathrm{nm}$ filled with water (relative permittivity $\\epsilon_{\\mathrm{w}} = 80$) and surrounded by a protein/lipid medium (relative permittivity $\\epsilon_{\\mathrm{m}} = 2$). An ion of charge $q = e$ is at a radial position $r_0 = 0.45\\,\\mathrm{nm}$. The distance of the ion to the boundary is $d = a - r_0 = 0.5\\,\\mathrm{nm} - 0.45\\,\\mathrm{nm} = 0.05\\,\\mathrm{nm}$. Since $d \\ll a$, we can approximate the cylindrical boundary locally as a planar interface.\n\nLet us set up a coordinate system where the planar interface lies on the $y-z$ plane at $x=0$. Region $1$ ($x0$) corresponds to the water-filled pore, having permittivity $\\epsilon_1 = \\epsilon_{\\mathrm{w}}\\epsilon_0$. Region $2$ ($x0$) corresponds to the protein medium, with permittivity $\\epsilon_2 = \\epsilon_{\\mathrm{m}}\\epsilon_0$. The ion with charge $q$ is located at position $\\mathbf{r}_0 = (-d, 0, 0)$ in Region $1$.\n\nTo solve for the electrostatic potential $\\phi$ that satisfies Poisson's equation $\\nabla \\cdot (\\epsilon \\nabla \\phi) = -\\rho$ and the boundary conditions, we use the method of images.\nThe potential in Region $1$ ($x0$), $\\phi_1$, is modeled as the sum of the potential from the real charge $q$ at $x=-d$ and an image charge $q'$ located at the mirror position $x=+d$ in Region $2$. Let $\\rho^2 = y^2+z^2$.\n$$ \\phi_1(x, y, z) = \\frac{1}{4\\pi\\epsilon_1} \\left( \\frac{q}{\\sqrt{(x+d)^2 + \\rho^2}} + \\frac{q'}{\\sqrt{(x-d)^2 + \\rho^2}} \\right) $$\nThe potential in Region $2$ ($x0$), $\\phi_2$, is modeled as the potential from a single effective charge $q''$ located at the position of the original charge $q$.\n$$ \\phi_2(x, y, z) = \\frac{1}{4\\pi\\epsilon_2} \\frac{q''}{\\sqrt{(x+d)^2 + \\rho^2}} $$\nNote that we use $\\epsilon_2$ in the expression for $\\phi_2$ as the potential is being evaluated in that medium. This form correctly ensures there are no charge sources in Region $2$, i.e., $\\nabla^2\\phi_2 = 0$ for $x0$. The values of the image charges $q'$ and $q''$ are determined by the boundary conditions at the interface $x=0$.\n\nBoundary Condition 1: Continuity of potential, $\\phi_1(0, \\rho) = \\phi_2(0, \\rho)$.\n$$ \\frac{1}{4\\pi\\epsilon_1} \\frac{q+q'}{\\sqrt{d^2+\\rho^2}} = \\frac{1}{4\\pi\\epsilon_2} \\frac{q''}{\\sqrt{d^2+\\rho^2}} $$\nThis simplifies to:\n$$ \\frac{q+q'}{\\epsilon_1} = \\frac{q''}{\\epsilon_2} \\quad (1) $$\n\nBoundary Condition 2: Continuity of the normal component of the electric displacement field, $\\epsilon_1 \\frac{\\partial\\phi_1}{\\partial n}|_{x=0} = \\epsilon_2 \\frac{\\partial\\phi_2}{\\partial n}|_{x=0}$. The normal vector $\\mathbf{n}$ is in the $x$-direction.\nFirst, we compute the partial derivatives with respect to $x$:\n$$ \\frac{\\partial\\phi_1}{\\partial x} = \\frac{1}{4\\pi\\epsilon_1} \\left[ -q\\frac{x+d}{((x+d)^2+\\rho^2)^{3/2}} - q'\\frac{x-d}{((x-d)^2+\\rho^2)^{3/2}} \\right] $$\n$$ \\frac{\\partial\\phi_2}{\\partial x} = \\frac{1}{4\\pi\\epsilon_2} \\left[ -q''\\frac{x+d}{((x+d)^2+\\rho^2)^{3/2}} \\right] $$\nEvaluating at $x=0$:\n$$ \\frac{\\partial\\phi_1}{\\partial x}\\bigg|_{x=0} = \\frac{1}{4\\pi\\epsilon_1} \\frac{-qd+q'd}{(d^2+\\rho^2)^{3/2}} $$\n$$ \\frac{\\partial\\phi_2}{\\partial x}\\bigg|_{x=0} = \\frac{1}{4\\pi\\epsilon_2} \\frac{-q''d}{(d^2+\\rho^2)^{3/2}} $$\nApplying the boundary condition $\\epsilon_1 \\frac{\\partial\\phi_1}{\\partial x}|_{x=0} = \\epsilon_2 \\frac{\\partial\\phi_2}{\\partial x}|_{x=0}$:\n$$ \\epsilon_1 \\left( \\frac{d(q'-q)}{4\\pi\\epsilon_1(d^2+\\rho^2)^{3/2}} \\right) = \\epsilon_2 \\left( \\frac{-q''d}{4\\pi\\epsilon_2(d^2+\\rho^2)^{3/2}} \\right) $$\nThis simplifies to:\n$$ q'-q = -q'' \\quad \\text{or} \\quad q'' = q-q' \\quad (2) $$\n\nNow we solve the system of two linear equations for $q'$ and $q''$. Substituting $(2)$ into $(1)$:\n$$ \\frac{q+q'}{\\epsilon_1} = \\frac{q-q'}{\\epsilon_2} $$\n$$ \\epsilon_2(q+q') = \\epsilon_1(q-q') $$\n$$ \\epsilon_2 q + \\epsilon_2 q' = \\epsilon_1 q - \\epsilon_1 q' $$\n$$ (\\epsilon_1 + \\epsilon_2)q' = (\\epsilon_1 - \\epsilon_2)q $$\n$$ q' = \\left(\\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2}\\right) q $$\n\nThe force experienced by the real charge $q$ is due to the electric field produced by the image charge $q'$. The charge $q$ is at $x=-d$ and the image charge $q'$ is at $x=+d$. The distance between them is $2d$. The force is calculated using Coulomb's law for a charge in a medium with permittivity $\\epsilon_1$:\n$$ \\mathbf{F} = \\frac{1}{4\\pi\\epsilon_1} \\frac{q q'}{(2d)^2} \\hat{\\mathbf{r}} $$\nwhere $\\hat{\\mathbf{r}}$ is the unit vector pointing from $q'$ to $q$, which is the $-\\hat{\\mathbf{x}}$ direction. The force is repulsive since for $\\epsilon_1  \\epsilon_2$, $q'$ has the same sign as $q$. Thus, the force pushes the ion away from the low-dielectric wall. The magnitude of the force is:\n$$ F = \\frac{1}{4\\pi\\epsilon_1} \\frac{|q q'|}{(2d)^2} = \\frac{|q'|q}{16\\pi\\epsilon_1 d^2} $$\nSubstituting the expression for $q'$:\n$$ F = \\frac{q^2}{16\\pi\\epsilon_1 d^2} \\left| \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2} \\right| $$\nUsing relative permittivities, $\\epsilon_1 = \\epsilon_{\\mathrm{w}}\\epsilon_0$ and $\\epsilon_2 = \\epsilon_{\\mathrm{m}}\\epsilon_0$, the expression becomes:\n$$ F = \\frac{e^2}{16\\pi \\epsilon_{\\mathrm{w}} \\epsilon_0 d^2} \\left| \\frac{\\epsilon_{\\mathrm{w}} - \\epsilon_{\\mathrm{m}}}{\\epsilon_{\\mathrm{w}} + \\epsilon_{\\mathrm{m}}} \\right| $$\nWe are given the following values:\n$e = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{C}$\n$\\epsilon_0 = 8.854\\,187\\,817 \\times 10^{-12}\\,\\mathrm{F/m}$\n$\\epsilon_{\\mathrm{w}} = 80$\n$\\epsilon_{\\mathrm{m}} = 2$\n$d = 0.05\\,\\mathrm{nm} = 5 \\times 10^{-11}\\,\\mathrm{m}$\n\nFirst, we calculate the dimensionless factor:\n$$ \\frac{\\epsilon_{\\mathrm{w}} - \\epsilon_{\\mathrm{m}}}{\\epsilon_{\\mathrm{w}} + \\epsilon_{\\mathrm{m}}} = \\frac{80 - 2}{80 + 2} = \\frac{78}{82} $$\nSince this term is positive, the absolute value is not needed.\n\nNow we compute the magnitude of the force:\n$$ F = \\frac{(1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{C})^2}{16\\pi (80) (8.854\\,187\\,817 \\times 10^{-12}\\,\\mathrm{F/m}) (5 \\times 10^{-11}\\,\\mathrm{m})^2} \\times \\frac{78}{82} $$\nLet's calculate the terms:\n$e^2 \\approx 2.566970 \\times 10^{-38}\\,\\mathrm{C^2}$\n$d^2 = 25 \\times 10^{-22}\\,\\mathrm{m^2} = 2.5 \\times 10^{-21}\\,\\mathrm{m^2}$\nDenominator term: $16\\pi \\epsilon_{\\mathrm{w}} \\epsilon_0 d^2 \\approx 16\\pi (80) (8.854 \\times 10^{-12}) (2.5 \\times 10^{-21}) \\approx 8.900033 \\times 10^{-29}\\,\\mathrm{N \\cdot m^2}$\nSo, the force is:\n$$ F \\approx \\frac{2.566970 \\times 10^{-38}}{8.900033 \\times 10^{-29}} \\times \\frac{78}{82} \\,\\mathrm{N} $$\n$$ F \\approx (2.88422 \\times 10^{-10}) \\times (0.9512195) \\,\\mathrm{N} $$\n$$ F \\approx 2.74363 \\times 10^{-10} \\,\\mathrm{N} $$\nRounding to four significant figures, the magnitude of the force is $2.744 \\times 10^{-10}\\,\\mathrm{N}$.\nThis radial force is directed away from the pore wall, toward the central axis of the channel.",
            "answer": "$$ \\boxed{2.744 \\times 10^{-10}} $$"
        }
    ]
}