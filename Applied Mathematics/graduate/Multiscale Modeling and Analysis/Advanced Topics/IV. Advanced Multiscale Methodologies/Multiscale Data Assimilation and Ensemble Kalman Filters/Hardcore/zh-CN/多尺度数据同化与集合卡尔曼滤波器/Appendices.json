{
    "hands_on_practices": [
        {
            "introduction": "任何集合卡尔曼滤波（EnKF）应用的第一步都是生成一个初始集合，该集合必须准确反映我们对系统初始状态的先验知识。一个不尊重已知统计关系（如不同尺度之间的相关性）的集合可能会导致虚假的调整瞬变和较长的“spin-up”时间。此练习提供了一种从简单的标准正态随机样本构建具有统计平衡性的初始集合的实践方法，确保集合从一开始就体现了系统内在的多尺度结构。",
            "id": "3784267",
            "problem": "考虑一种多尺度状态表示，其中系统状态在一个尺度分离的正交归一基中表示为一个双分量向量 $x = (x_{L}, x_{S})^{\\top} \\in \\mathbb{R}^{2}$，其中 $x_{L}$ 和 $x_{S}$ 分别是大尺度和小尺度振幅。假设初始状态的先验统计模型是均值为零的联合高斯分布。该多尺度协方差模型规定了不同的尺度方差和一个非零的跨尺度协方差：\n$$\n\\operatorname{Var}(x_{L}) = \\sigma_{L}^{2}, \\quad \\operatorname{Var}(x_{S}) = \\sigma_{S}^{2}, \\quad \\operatorname{Cov}(x_{L}, x_{S}) = \\rho\\, \\sigma_{L}\\sigma_{S},\n$$\n其中 $\\sigma_{L} > 0$、$\\sigma_{S} > 0$ 且 $|\\rho|  1$。这捕捉了尺度之间物理上合理的平衡，并与集合卡尔曼滤波 (Ensemble Kalman Filter, EnKF) 启动过程中的多尺度动力学一致，在启动过程中，初始集合必须反映正确的跨尺度结构，以避免虚假的调整瞬变过程。\n\n您需要设计一个线性采样过程，通过变换独立的标准正态样本 $\\xi^{(j)} \\sim \\mathcal{N}(0, I_{2})$ 来生成一个初始集合 $\\{x^{(j)}\\}_{j=1}^{N}$，其中 $x^{(j)} = L\\, \\xi^{(j)}$。必须选择矩阵 $L \\in \\mathbb{R}^{2 \\times 2}$，以使生成的集合均值为零，大尺度方差为 $\\sigma_{L}^{2}$，小尺度方差为 $\\sigma_{S}^{2}$，且跨尺度相关性等于 $\\rho$。\n\n从高斯随机向量、协方差、相关性和条件高斯分布的核心定义出发，推导一个采样变换 $L$，该变换能确保初始集合具有所需的的多尺度协方差和跨尺度相关性，同时保持科学上的真实性和平衡性。请以 $\\sigma_{L}$、$\\sigma_{S}$ 和 $\\rho$ 表示的单个闭式解析表达式形式给出您的最终答案。无需进行数值计算，答案中也不涉及单位。",
            "solution": "这个问题提法明确且有科学依据。它解决的是统计建模和数据同化中的一个基本任务：从一组独立的标准正态随机向量中生成一组具有指定协方差结构的随机向量（一个集合）。这是初始化集合卡尔曼滤波 (Ensemble Kalman Filter, EnKF) 的一个标准流程，该流程遵循系统状态不同分量之间（在本例中为大尺度和小尺度）已知的统计关系。\n\n设状态向量为 $x = (x_{L}, x_{S})^{\\top} \\in \\mathbb{R}^{2}$。我们已知 $x$ 所需的统计特性是零均值，即 $E[x] = 0$，以及一个特定的协方差矩阵 $C_x$。该协方差矩阵的分量可从问题陈述中推导得出：\n$$\nC_x = \\begin{pmatrix} \\operatorname{Cov}(x_{L}, x_{L})  \\operatorname{Cov}(x_{L}, x_{S}) \\\\ \\operatorname{Cov}(x_{S}, x_{L})  \\operatorname{Cov}(x_{S}, x_{S}) \\end{pmatrix}\n$$\n根据定义，$\\operatorname{Cov}(x_{L}, x_{L}) = \\operatorname{Var}(x_{L})$ 且 $\\operatorname{Cov}(x_{S}, x_{S}) = \\operatorname{Var}(x_{S})$。协方差矩阵也是对称的，所以 $\\operatorname{Cov}(x_{S}, x_{L}) = \\operatorname{Cov}(x_{L}, x_{S})$。使用给定的定义：\n$\\operatorname{Var}(x_{L}) = \\sigma_{L}^{2}$\n$\\operatorname{Var}(x_{S}) = \\sigma_{S}^{2}$\n$\\operatorname{Cov}(x_{L}, x_{S}) = \\rho \\sigma_{L} \\sigma_{S}$\n将这些代入矩阵结构，得到目标协方差矩阵：\n$$\nC_x = \\begin{pmatrix} \\sigma_{L}^{2}  \\rho \\sigma_{L} \\sigma_{S} \\\\ \\rho \\sigma_{L} \\sigma_{S}  \\sigma_{S}^{2} \\end{pmatrix}\n$$\n问题要求设计一个线性变换 $x = L\\xi$，其中 $\\xi \\sim \\mathcal{N}(0, I_{2})$ 是一个由两个独立的标准正态随机变量组成的向量，而 $L \\in \\mathbb{R}^{2 \\times 2}$ 是我们需要寻找的变换矩阵。$\\xi$ 的协方差矩阵，记为 $C_{\\xi}$，是 $2 \\times 2$ 的单位矩阵 $I_{2}$。\n\n我们可以推导 $x$ 的协方差与 $\\xi$ 的协方差之间的关系。$x$ 的均值为 $E[x] = E[L\\xi] = L E[\\xi] = L \\cdot 0 = 0$，这正确地得出了 $x$ 的零均值分布。$x$ 的协方差矩阵由下式给出：\n$$\nC_x = E[(x - E[x])(x - E[x])^{\\top}] = E[x x^{\\top}]\n$$\n代入 $x = L\\xi$：\n$$\nC_x = E[(L\\xi)(L\\xi)^{\\top}] = E[L\\xi\\xi^{\\top}L^{\\top}]\n$$\n由于 $L$ 是一个确定性矩阵，它可以从期望中提出来：\n$$\nC_x = L E[\\xi\\xi^{\\top}] L^{\\top}\n$$\n项 $E[\\xi\\xi^{\\top}]$ 是 $\\xi$ 的协方差矩阵，即 $C_{\\xi} = I_2$。因此，我们有以下核心关系：\n$$\nC_x = L I_2 L^{\\top} = LL^{\\top}\n$$\n我们的目标是找到一个矩阵 $L$，使得 $LL^{\\top}$ 等于目标协方差矩阵 $C_x$。这是一个矩阵分解问题。一个常见且具有构造性的方法是 Cholesky 分解。对于一个正定对称矩阵 $C_x$，Cholesky 分解可以找到一个唯一的、对角元素为正的下三角矩阵 $L$，使得 $LL^{\\top} = C_x$。条件 $|\\rho|  1$ 确保了 $C_x$ 确实是正定的，因为其行列式为 $\\det(C_x) = \\sigma_{L}^{2}\\sigma_{S}^{2} - (\\rho \\sigma_{L} \\sigma_{S})^2 = \\sigma_{L}^{2}\\sigma_{S}^{2}(1-\\rho^2) > 0$。\n\n让我们假设 $L$ 是一个形如下式的下三角矩阵：\n$$\nL = \\begin{pmatrix} l_{11}  0 \\\\ l_{21}  l_{22} \\end{pmatrix}\n$$\n现在，我们计算 $LL^{\\top}$：\n$$\nLL^{\\top} = \\begin{pmatrix} l_{11}  0 \\\\ l_{21}  l_{22} \\end{pmatrix} \\begin{pmatrix} l_{11}  l_{21} \\\\ 0  l_{22} \\end{pmatrix} = \\begin{pmatrix} l_{11}^{2}  l_{11} l_{21} \\\\ l_{11} l_{21}  l_{21}^{2} + l_{22}^{2} \\end{pmatrix}\n$$\n我们将其与目标协方差矩阵 $C_x$ 相等：\n$$\n\\begin{pmatrix} l_{11}^{2}  l_{11} l_{21} \\\\ l_{11} l_{21}  l_{21}^{2} + l_{22}^{2} \\end{pmatrix} = \\begin{pmatrix} \\sigma_{L}^{2}  \\rho \\sigma_{L} \\sigma_{S} \\\\ \\rho \\sigma_{L} \\sigma_{S}  \\sigma_{S}^{2} \\end{pmatrix}\n$$\n现在我们可以通过令对应的矩阵元素相等来解出 $L$ 的元素。\n\n从 (1,1) 位置的元素可得：\n$l_{11}^{2} = \\sigma_{L}^{2}$。由于 $\\sigma_{L} > 0$ 且 Cholesky 因子的对角元素为正，我们有 $l_{11} = \\sigma_{L}$。\n\n从 (2,1) 位置的元素（或 (1,2) 位置的元素）可得：\n$l_{11} l_{21} = \\rho \\sigma_{L} \\sigma_{S}$。\n代入 $l_{11} = \\sigma_{L}$：\n$\\sigma_{L} l_{21} = \\rho \\sigma_{L} \\sigma_{S}$。\n由于 $\\sigma_{L} > 0$，我们可以两边同除以它来求得 $l_{21}$：\n$l_{21} = \\rho \\sigma_{S}$。\n\n从 (2,2) 位置的元素可得：\n$l_{21}^{2} + l_{22}^{2} = \\sigma_{S}^{2}$。\n代入 $l_{21}$ 的值：\n$(\\rho \\sigma_{S})^{2} + l_{22}^{2} = \\sigma_{S}^{2}$\n$\\rho^{2} \\sigma_{S}^{2} + l_{22}^{2} = \\sigma_{S}^{2}$\n$l_{22}^{2} = \\sigma_{S}^{2} - \\rho^{2} \\sigma_{S}^{2} = \\sigma_{S}^{2}(1 - \\rho^{2})$。\n由于 $\\sigma_{S} > 0$ 且 $|\\rho|  1$，我们有 $1-\\rho^2 > 0$。我们取对角元素的正平方根：\n$l_{22} = \\sqrt{\\sigma_{S}^{2}(1 - \\rho^{2})} = \\sigma_{S}\\sqrt{1 - \\rho^{2}}$。\n\n将 $L$ 的各分量组合成矩阵，便得到采样变换的最终表达式：\n$$\nL = \\begin{pmatrix} \\sigma_{L}  0 \\\\ \\rho \\sigma_{S}  \\sigma_{S} \\sqrt{1 - \\rho^{2}} \\end{pmatrix}\n$$\n将此矩阵应用于一个由独立的标准正态样本组成的向量，将生成一个具有所需多尺度方差和跨尺度相关结构的新随机向量，适用于初始化一个集合。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sigma_{L}  0 \\\\\n\\rho \\sigma_{S}  \\sigma_{S} \\sqrt{1 - \\rho^{2}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在初始化集合之后，下一步便是进行数据同化。为了在多尺度背景下理解卡尔曼滤波的核心机制，考虑一个理想化的场景是很有帮助的。本练习通过一个简化的系统，揭示了滤波器如何根据不同尺度上的先验知识和新观测各自的不确定性来对其进行最优加权，从而为理解集合卡尔曼滤波在多尺度系统中的信息融合方式提供了清晰的直觉。",
            "id": "3784259",
            "problem": "考虑一个有限维状态向量 $x \\in \\mathbb{R}^{n}$，它在一个具有三个尺度的标准正交多分辨率基中表示。这些尺度的维数分别为 $m_{1} = 4$，$m_{2} = 2$ 和 $m_{3} = 1$，因此 $n = m_{1} + m_{2} + m_{3} = 7$。将多分辨率系数向量记为 $c \\in \\mathbb{R}^{7}$，其中 $c$ 按尺度划分为 $c = (c^{(1)}, c^{(2)}, c^{(3)})$，且 $c^{(s)} \\in \\mathbb{R}^{m_{s}}$ (对于 $s \\in \\{1,2,3\\}$)。假设多分辨率基是标准正交的，因此 $x$ 和 $c$ 之间的变换是酉变换。\n\n一个多分辨率观测网络直接测量每个尺度的所有系数，因此系数空间中的观测算子是 $H = I_{7}$（单位矩阵）。观测误差在尺度之间和尺度内部都是独立的，其方差分别为 $r_{1}$、$r_{2}$ 和 $r_{3}$，对应于尺度 $s = 1, 2, 3$。预报（先验）系数协方差矩阵是跨尺度的块对角矩阵，其各尺度块为 $\\sigma_{1}^{2} I_{m_{1}}$、$\\sigma_{2}^{2} I_{m_{2}}$ 和 $\\sigma_{3}^{2} I_{m_{3}}$，其中 $I_{k}$ 表示 $k \\times k$ 单位矩阵。假设集合卡尔曼滤波器（EnKF; Ensemble Kalman Filter）在系数空间中实现，由于正交性，这等价于在状态空间中实现。\n\n(a) 构建观测误差协方差矩阵 $R \\in \\mathbb{R}^{7 \\times 7}$，使其成为与多分辨率结构和给定的各尺度误差方差一致的块对角矩阵。\n\n(b) 从贝叶斯线性高斯数据同化设定出发，其中先验为高斯分布 $c \\sim \\mathcal{N}(c_{f}, P_{f})$，观测模型为高斯模型 $y = H c + \\varepsilon$，且 $\\varepsilon \\sim \\mathcal{N}(0, R)$，推导EnKF增益中嵌入的各尺度新息权重的表达式。也就是说，当 $P_{f}$ 和 $R$ 具有所述的块对角多尺度结构时，识别在分析更新中乘以新息分量 $(y - H c_{f})$ 的每个尺度上的标量因子。\n\n(c) 使用具体数值 $\\sigma_{1}^{2} = 2$, $\\sigma_{2}^{2} = \\frac{1}{2}$, $\\sigma_{3}^{2} = 3$ 和 $r_{1} = 1$, $r_{2} = \\frac{1}{10}$, $r_{3} = 4$，计算在(b)部分中推导的各尺度新息权重因子向量。请以包含三个尺度权重的单行向量形式给出最终答案。无需四舍五入，此计算不涉及单位。",
            "solution": "在尝试任何解答之前，需对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 状态向量：$x \\in \\mathbb{R}^{n}$\n- 具有三个尺度的标准正交多分辨率基。\n- 尺度维数：$m_{1} = 4$, $m_{2} = 2$, $m_{3} = 1$。\n- 总维数：$n = m_{1} + m_{2} + m_{3} = 7$。\n- 系数向量：$c \\in \\mathbb{R}^{7}$，划分为 $c = (c^{(1)}, c^{(2)}, c^{(3)})$，其中 $c^{(s)} \\in \\mathbb{R}^{m_{s}}$ (对于 $s \\in \\{1,2,3\\}$)。\n- $x$ 和 $c$ 之间的变换：酉变换。\n- 系数空间中的观测算子：$H = I_{7}$。\n- 观测误差：在尺度之间和尺度内部均独立。\n- 观测误差方差：对于尺度 $s=1, s=2, s=3$，分别为 $r_{1}, r_{2}, r_{3}$。\n- 预报（先验）系数协方差矩阵 $P_f$：跨尺度块对角。\n- 预报协方差块：$\\sigma_{1}^{2} I_{m_{1}}$、$\\sigma_{2}^{2} I_{m_{2}}$ 和 $\\sigma_{3}^{2} I_{m_{3}}$。\n- 数据同化设定：Bayesian线性高斯，先验为 $c \\sim \\mathcal{N}(c_{f}, P_{f})$，观测模型为 $y = H c + \\varepsilon$，其中 $\\varepsilon \\sim \\mathcal{N}(0, R)$。\n- (c)部分的具体数值：$\\sigma_{1}^{2} = 2$, $\\sigma_{2}^{2} = \\frac{1}{2}$, $\\sigma_{3}^{2} = 3$ 和 $r_{1} = 1$, $r_{2} = \\frac{1}{10}$, $r_{3} = 4$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，提法恰当且客观。这是多尺度数据同化领域的一个标准理论练习，特别涉及集合卡尔曼滤波器（EnKF）的使用。诸如块对角协方差结构和系数空间中的单位观测算子等假设，是用于分析滤波器在不同尺度上行为的常见简化假设。该问题是自洽的，数学上一致，并且没有事实错误或逻辑矛盾。所用术语是该领域的标准术语。提供了唯一解所需的所有信息。\n\n### 步骤3：结论与行动\n问题有效。将提供一个完整且论证充分的解答。\n\n### 解答\n\n问题按要求分三部分解答。\n\n**(a) 构建观测误差协方差矩阵 $R$**\n\n问题陈述指出，观测误差在尺度之间和尺度内部都是独立的。这意味着观测误差协方差矩阵 $R$ 是一个对角矩阵。对角线上的元素是系数向量 $c$ 的每个相应分量的观测误差方差。\n\n系数向量 $c$ 按尺度划分：$c = (c^{(1)}, c^{(2)}, c^{(3)})$。\n- 对于尺度 $s=1$，有 $m_1 = 4$ 个系数。每个系数的观测误差方差为 $r_1$。\n- 对于尺度 $s=2$，有 $m_2 = 2$ 个系数。每个系数的观测误差方差为 $r_2$。\n- 对于尺度 $s=3$，有 $m_3 = 1$ 个系数。其观测误差方差为 $r_3$。\n\n由于误差的独立性，$R$ 的所有非对角元素均为零。对应于尺度 $s$ 的对角元素都等于 $r_s$。这种结构形成一个块对角矩阵，其中每个块是单位矩阵的标量倍。\n\n矩阵 $R \\in \\mathbb{R}^{7 \\times 7}$ 构建如下：\n$$\nR = \\begin{pmatrix}\nR^{(1)}  0  0 \\\\\n0  R^{(2)}  0 \\\\\n0  0  R^{(3)}\n\\end{pmatrix}\n$$\n其中 $R^{(s)}$ 是尺度 $s$ 的观测误差协方差矩阵。根据给定的方差，这些块为：\n- $R^{(1)} = r_1 I_{m_1} = r_1 I_4 \\in \\mathbb{R}^{4 \\times 4}$\n- $R^{(2)} = r_2 I_{m_2} = r_2 I_2 \\in \\mathbb{R}^{2 \\times 2}$\n- $R^{(3)} = r_3 I_{m_3} = r_3 I_1 = r_3 \\in \\mathbb{R}^{1 \\times 1}$\n\n因此，完整的观测误差协方差矩阵是：\n$$\nR = \\begin{pmatrix}\nr_1 I_4  0  0 \\\\\n0  r_2 I_2  0 \\\\\n0  0  r_3\n\\end{pmatrix} = \\text{diag}(r_1, r_1, r_1, r_1, r_2, r_2, r_3)\n$$\n\n**(b) 各尺度新息权重的推导**\n\n卡尔曼滤波器中的分析更新由下式给出：\n$$ c_a = c_f + K (y - H c_f) $$\n其中 $c_a$ 是分析（后验）状态估计，$c_f$ 是预报（先验）状态估计，$y$ 是观测向量，$K$ 是卡尔曼增益。项 $(y - H c_f)$ 是新息。“新息权重”即为卡尔曼增益矩阵 $K$。\n\n卡尔曼增益定义为：\n$$ K = P_f H^T (H P_f H^T + R)^{-1} $$\n我们已知 $P_f$、$H$ 和 $R$ 的结构：\n- $H = I_7$ ($7 \\times 7$ 单位矩阵)\n- $P_f = \\text{diag}(\\sigma_1^2 I_{m_1}, \\sigma_2^2 I_{m_2}, \\sigma_3^2 I_{m_3})$\n- $R = \\text{diag}(r_1 I_{m_1}, r_2 I_{m_2}, r_3 I_{m_3})$\n\n将 $H=I_7$ 代入增益公式，可大大简化：\n$$ K = P_f (I_7)^T (I_7 P_f (I_7)^T + R)^{-1} = P_f (P_f + R)^{-1} $$\n由于 $P_f$ 和 $R$ 都是具有相同块结构的块对角矩阵，它们的和 $P_f + R$ 也是块对角的：\n$$\nP_f + R = \\begin{pmatrix}\n\\sigma_1^2 I_{m_1} + r_1 I_{m_1}  0  0 \\\\\n0  \\sigma_2^2 I_{m_2} + r_2 I_{m_2}  0 \\\\\n0  0  \\sigma_3^2 I_{m_3} + r_3 I_{m_3}\n\\end{pmatrix}\n= \\begin{pmatrix}\n(\\sigma_1^2 + r_1) I_{m_1}  0  0 \\\\\n0  (\\sigma_2^2 + r_2) I_{m_2}  0 \\\\\n0  0  (\\sigma_3^2 + r_3) I_{m_3}\n\\end{pmatrix}\n$$\n块对角矩阵的逆是其各块的逆组成的块对角矩阵。单位矩阵的标量倍 $(\\alpha)I$ 的逆是 $(\\frac{1}{\\alpha})I$。因此：\n$$\n(P_f + R)^{-1} = \\begin{pmatrix}\n\\frac{1}{\\sigma_1^2 + r_1} I_{m_1}  0  0 \\\\\n0  \\frac{1}{\\sigma_2^2 + r_2} I_{m_2}  0 \\\\\n0  0  \\frac{1}{\\sigma_3^2 + r_3} I_{m_3}\n\\end{pmatrix}\n$$\n现在我们计算增益 $K = P_f (P_f + R)^{-1}$。作为两个具有相同结构的块对角矩阵的乘积，结果是一个块对角矩阵，其中每个块是相应块的乘积：\n$$\nK = \\begin{pmatrix}\n(\\sigma_1^2 I_{m_1}) (\\frac{1}{\\sigma_1^2 + r_1} I_{m_1})  0  0 \\\\\n0  (\\sigma_2^2 I_{m_2}) (\\frac{1}{\\sigma_2^2 + r_2} I_{m_2})  0 \\\\\n0  0  (\\sigma_3^2 I_{m_3}) (\\frac{1}{\\sigma_3^2 + r_3} I_{m_3})\n\\end{pmatrix}\n$$\n$$\nK = \\begin{pmatrix}\n\\frac{\\sigma_1^2}{\\sigma_1^2 + r_1} I_{m_1}  0  0 \\\\\n0  \\frac{\\sigma_2^2}{\\sigma_2^2 + r_2} I_{m_2}  0 \\\\\n0  0  \\frac{\\sigma_3^2}{\\sigma_3^2 + r_3} I_{m_3}\n\\end{pmatrix}\n$$\n特定尺度 $s$ 的系数 $c^{(s)}$ 的分析更新由下式给出：\n$$ c_a^{(s)} = c_f^{(s)} + \\left( \\frac{\\sigma_s^2}{\\sigma_s^2 + r_s} I_{m_s} \\right) (y^{(s)} - c_f^{(s)}) = c_f^{(s)} + \\frac{\\sigma_s^2}{\\sigma_s^2 + r_s} (y^{(s)} - c_f^{(s)}) $$\n“各尺度新息权重”是在每个尺度上乘以新息向量的标量因子。对于尺度 $s$，该因子为：\n$$ k_s = \\frac{\\sigma_s^2}{\\sigma_s^2 + r_s} $$\n\n**(c) 各尺度权重的计算**\n\n使用提供的具体数值：\n- $\\sigma_{1}^{2} = 2$, $r_{1} = 1$\n- $\\sigma_{2}^{2} = \\frac{1}{2}$, $r_{2} = \\frac{1}{10}$\n- $\\sigma_{3}^{2} = 3$, $r_{3} = 4$\n\n我们计算每个尺度 $s \\in \\{1, 2, 3\\}$ 的权重因子 $k_s$。\n\n对于尺度 $s=1$：\n$$ k_1 = \\frac{\\sigma_1^2}{\\sigma_1^2 + r_1} = \\frac{2}{2 + 1} = \\frac{2}{3} $$\n\n对于尺度 $s=2$：\n$$ k_2 = \\frac{\\sigma_2^2}{\\sigma_2^2 + r_2} = \\frac{\\frac{1}{2}}{\\frac{1}{2} + \\frac{1}{10}} = \\frac{\\frac{1}{2}}{\\frac{5}{10} + \\frac{1}{10}} = \\frac{\\frac{1}{2}}{\\frac{6}{10}} = \\frac{1}{2} \\cdot \\frac{10}{6} = \\frac{10}{12} = \\frac{5}{6} $$\n\n对于尺度 $s=3$：\n$$ k_3 = \\frac{\\sigma_3^2}{\\sigma_3^2 + r_3} = \\frac{3}{3 + 4} = \\frac{3}{7} $$\n\n各尺度新息权重因子的向量是 $(k_1, k_2, k_3)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2}{3}  \\frac{5}{6}  \\frac{3}{7}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "虽然前面的练习展示了理想情况，但现实世界的应用常常会带来挑战，可能导致基本的集合卡尔曼滤波（EnKF）失败。本练习构建了一个精心设计的反例，以展示最重大的风险之一：在有限规模的集合中出现虚假相关性。通过解决这个问题，您将揭示为何像协方差局域化这样的技术不仅仅是改进，而是可靠数据同化所必需的。",
            "id": "3784250",
            "problem": "考虑一个具有快速不稳定模式和慢速稳定模式的双尺度线性、时间离散系统，旨在模拟多尺度动力学。状态为 $x_k \\in \\mathbb{R}^2$，动力学和观测为\n$$\nx_{k+1} = A\\,x_k, \\quad A = \\begin{pmatrix} \\alpha  0 \\\\ 0  \\beta \\end{pmatrix}, \\qquad y_k = H\\,x_k + v_k, \\quad H = \\begin{pmatrix} 0  1 \\end{pmatrix},\n$$\n其中 $v_k$ 是协方差为 $R$ 的零均值观测噪声。假设没有过程噪声。取 $\\alpha = \\tfrac{3}{2}$，$\\beta = \\tfrac{1}{2}$，$R = 1$。在同化周期 $k = 0$ 时，令真实状态为 $x_0^{\\mathrm{t}} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，实现的观测无噪声，因此 $y_0 = H x_0^{\\mathrm{t}}$。假设集合卡尔曼滤波器 (EnKF) 使用非局地化的、有限集合的样本协方差。$k = 0$ 时的预报集合均值为 $\\bar{x}_0^{\\mathrm{f}} = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}$。集合大小为 $m = 2$，关于均值的扰动为 $\\pm a$，其中 $a = \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}$，因此样本预报协方差是秩亏的，由 $\\widehat{P}_0^{\\mathrm{f}} = a a^{\\top}$ 给出。\n\n使用标准的线性高斯集合卡尔曼滤波器 (EnKF) 分析步骤和非局地化的样本协方差 $\\widehat{P}_0^{\\mathrm{f}}$，计算单周期欧几里得平方误差放大因子\n$$\n\\gamma \\equiv \\frac{\\left\\| \\bar{x}_1^{\\mathrm{f}} - x_1^{\\mathrm{t}} \\right\\|_2^2}{\\left\\| \\bar{x}_0^{\\mathrm{f}} - x_0^{\\mathrm{t}} \\right\\|_2^2},\n$$\n其中 $\\bar{x}_1^{\\mathrm{f}} = A\\,\\bar{x}_0^{\\mathrm{a}}$ 是将分析均值 $\\bar{x}_0^{\\mathrm{a}}$ 传播一步后的预报均值，而 $x_1^{\\mathrm{t}} = A\\,x_0^{\\mathrm{t}}$ 是传播后的真值。您的答案必须是一个精确值（无四舍五入）。该构造展示了一个反例，其中非局地化、秩亏的样本协方差导致未观测到的不稳定模式发散。请以单个数字或封闭形式表达式的形式提供 $\\gamma$ 的精确值。",
            "solution": "我们从双尺度线性模型和观测算子开始。在线性高斯集合卡尔曼滤波器 (EnKF) 中，均值的分析步骤使用与经典卡尔曼滤波器均值更新相同的形式，但使用的是集合样本预报协方差。具体来说，对于 $y_0 = H x_0^{\\mathrm{t}}$（无噪声实现）和非局地化的样本预报协方差，分析均值为\n$$\n\\bar{x}_0^{\\mathrm{a}} = \\bar{x}_0^{\\mathrm{f}} + K_0 \\left( y_0 - H \\bar{x}_0^{\\mathrm{f}} \\right),\n$$\n其中 $K_0$ 是根据样本协方差计算出的卡尔曼增益。定义预报均值误差 $e_0^{\\mathrm{f}} \\equiv \\bar{x}_0^{\\mathrm{f}} - x_0^{\\mathrm{t}}$。使用 $y_0 = H x_0^{\\mathrm{t}}$，新息为 $y_0 - H \\bar{x}_0^{\\mathrm{f}} = H x_0^{\\mathrm{t}} - H \\bar{x}_0^{\\mathrm{f}} = - H e_0^{\\mathrm{f}}$。因此，分析均值误差为\n$$\ne_0^{\\mathrm{a}} \\equiv \\bar{x}_0^{\\mathrm{a}} - x_0^{\\mathrm{t}} = \\left( I - K_0 H \\right) e_0^{\\mathrm{f}}.\n$$\n传播一步后的单步预报均值误差为\n$$\ne_1^{\\mathrm{f}} \\equiv \\bar{x}_1^{\\mathrm{f}} - x_1^{\\mathrm{t}} = A \\bar{x}_0^{\\mathrm{a}} - A x_0^{\\mathrm{t}} = A e_0^{\\mathrm{a}} = A \\left( I - K_0 H \\right) e_0^{\\mathrm{f}}.\n$$\n\n我们现在计算指定反例所需的所有量。样本预报协方差由两个成员的集合构成，其扰动为 $\\pm a$，其中 $a = \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}$。当 $m = 2$ 时，无偏样本协方差为\n$$\n\\widehat{P}_0^{\\mathrm{f}} = a a^{\\top} = \\begin{pmatrix} 1  -2 \\\\ -2  4 \\end{pmatrix}.\n$$\n该矩阵是秩亏的，因为 $\\det(\\widehat{P}_0^{\\mathrm{f}}) = 1 \\cdot 4 - (-2)\\cdot(-2) = 4 - 4 = 0$，因此 $\\operatorname{rank}(\\widehat{P}_0^{\\mathrm{f}}) = 1$。\n\n基于 $\\widehat{P}_0^{\\mathrm{f}}$ 的卡尔曼增益是\n$$\nK_0 = \\widehat{P}_0^{\\mathrm{f}} H^{\\top} \\left( H \\widehat{P}_0^{\\mathrm{f}} H^{\\top} + R \\right)^{-1}.\n$$\n计算所需分量：\n$$\n\\widehat{P}_0^{\\mathrm{f}} H^{\\top} = \\begin{pmatrix} 1  -2 \\\\ -2  4 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ 4 \\end{pmatrix}, \\qquad\nH \\widehat{P}_0^{\\mathrm{f}} H^{\\top} = \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} 1  -2 \\\\ -2  4 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = 4.\n$$\n由于 $R = 1$，标量分母为 $4 + 1 = 5$。因此，\n$$\nK_0 = \\frac{1}{5} \\begin{pmatrix} -2 \\\\ 4 \\end{pmatrix}.\n$$\n计算矩阵 $I - K_0 H$：\n$$\nK_0 H = \\frac{1}{5} \\begin{pmatrix} -2 \\\\ 4 \\end{pmatrix} \\begin{pmatrix} 0  1 \\end{pmatrix}\n= \\frac{1}{5} \\begin{pmatrix} 0  -2 \\\\ 0  4 \\end{pmatrix}, \\quad\nI - K_0 H = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\frac{1}{5} \\begin{pmatrix} 0  -2 \\\\ 0  4 \\end{pmatrix}\n= \\begin{pmatrix} 1  \\tfrac{2}{5} \\\\ 0  \\tfrac{1}{5} \\end{pmatrix}.\n$$\n$k=0$ 时的预报均值误差为\n$$\ne_0^{\\mathrm{f}} = \\bar{x}_0^{\\mathrm{f}} - x_0^{\\mathrm{t}} = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}.\n$$\n因此，分析均值误差为\n$$\ne_0^{\\mathrm{a}} = \\left( I - K_0 H \\right) e_0^{\\mathrm{f}} = \\begin{pmatrix} 1  \\tfrac{2}{5} \\\\ 0  \\tfrac{1}{5} \\end{pmatrix} \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}\n= \\begin{pmatrix} -1 - \\tfrac{2}{5} \\\\ - \\tfrac{1}{5} \\end{pmatrix} = \\begin{pmatrix} -\\tfrac{7}{5} \\\\ -\\tfrac{1}{5} \\end{pmatrix}.\n$$\n使用 $A = \\operatorname{diag}(\\alpha, \\beta) = \\operatorname{diag}\\!\\left( \\tfrac{3}{2}, \\tfrac{1}{2} \\right)$ 传播一步，得到\n$$\ne_1^{\\mathrm{f}} = A e_0^{\\mathrm{a}} = \\begin{pmatrix} \\tfrac{3}{2}  0 \\\\ 0  \\tfrac{1}{2} \\end{pmatrix} \\begin{pmatrix} -\\tfrac{7}{5} \\\\ -\\tfrac{1}{5} \\end{pmatrix}\n= \\begin{pmatrix} -\\tfrac{21}{10} \\\\ -\\tfrac{1}{10} \\end{pmatrix}.\n$$\n计算 $\\gamma$ 所需的欧几里得范数的平方：\n$$\n\\left\\| e_0^{\\mathrm{f}} \\right\\|_2^2 = (-1)^2 + (-1)^2 = 2, \\quad\n\\left\\| e_1^{\\mathrm{f}} \\right\\|_2^2 = \\left( \\tfrac{21}{10} \\right)^2 + \\left( \\tfrac{1}{10} \\right)^2 = \\tfrac{441}{100} + \\tfrac{1}{100} = \\tfrac{442}{100} = \\tfrac{221}{50}.\n$$\n因此，单周期欧几里得平方误差放大因子为\n$$\n\\gamma = \\frac{ \\left\\| e_1^{\\mathrm{f}} \\right\\|_2^2 }{ \\left\\| e_0^{\\mathrm{f}} \\right\\|_2^2 } = \\frac{ \\tfrac{221}{50} }{ 2 } = \\tfrac{221}{100}.\n$$\n该值满足 $\\gamma  1$，这表明，在一个由双成员集合和伪交叉协方差引起的非局地化、秩亏的样本协方差下，EnKF 分析将误差注入到未观测到的不稳定模式中，该误差随后在动力学作用下被放大，从而提供了所要求的反例。",
            "answer": "$$\\boxed{\\frac{221}{100}}$$"
        }
    ]
}