{
    "hands_on_practices": [
        {
            "introduction": "This first exercise provides a foundational calculation at the heart of linear response theory. By analyzing a particle governed by the Generalized Langevin Equation (GLE), you will derive the connection between the memory of the thermal environment and the system's frequency-dependent response. This practice is essential for understanding how dissipation, represented by a memory kernel, is intrinsically linked to the absorptive part of the susceptibility, which is a direct manifestation of the Fluctuation-Dissipation Theorem .",
            "id": "3759313",
            "problem": "Consider a single coarse-grained coordinate $x(t)$ of mass $m$ evolving under a harmonic restoring force with bare stiffness $k$, linearly coupled to an equilibrium thermal environment whose friction exhibits memory. The dynamics are modeled by the Generalized Langevin Equation (GLE)\n$$\nm\\,\\ddot{x}(t) + \\int_{0}^{t} \\Gamma(t - t')\\,\\dot{x}(t')\\,\\mathrm{d}t' + k\\,x(t) = f(t),\n$$\nwhere the causal memory kernel $\\Gamma(t)$ is zero for $t0$ and for $t \\ge 0$ is given by\n$$\n\\Gamma(t) = \\gamma\\,\\exp(-\\alpha t),\n$$\nwith $\\gamma0$ and $\\alpha0$. Assume a small external driving $f(t) = \\Re\\{f_{0}\\,\\exp(-i\\omega t)\\}$ is applied for $t\\ge 0$, and take the system to be stationary and in equilibrium prior to the drive. Use the one-sided causal Fourier transform convention for the kernel, \n$$\n\\Gamma(\\omega) \\equiv \\int_{0}^{\\infty} \\Gamma(t)\\,\\exp(i\\omega t)\\,\\mathrm{d}t,\n$$\nand the standard Fourier transform convention for dynamical variables $g(t)$,\n$$\n\\hat{g}(\\omega) \\equiv \\int_{-\\infty}^{\\infty} g(t)\\,\\exp(i\\omega t)\\,\\mathrm{d}t,\n$$\nso that $\\widehat{\\dot{g}}(\\omega) = -i\\omega\\,\\hat{g}(\\omega)$. Denote the linear susceptibility by $\\chi(\\omega)$, defined via $\\hat{x}(\\omega) = \\chi(\\omega)\\,\\hat{f}(\\omega)$ in the regime of linear response.\n\nStarting from these definitions and the GLE, derive the frequency-dependent friction $\\Gamma(\\omega)$, express the susceptibility $\\chi(\\omega)$, and determine the dissipative part of the response, namely the imaginary part $\\chi''(\\omega)$. Briefly explain how the form of $\\Gamma(\\omega)$ influences dissipation across frequencies in terms of the structure of $\\chi''(\\omega)$.\n\nProvide, as your final answer, the single closed-form analytic expression for $\\chi''(\\omega)$ in terms of $m$, $k$, $\\gamma$, $\\alpha$, and $\\omega$. No rounding is required. No units are required for the final expression.",
            "solution": "The problem is valid. It presents a standard model in statistical physics—the Generalized Langevin Equation for a harmonic oscillator coupled to a thermal bath with memory—and asks for a derivation of a key physical quantity, the dissipative part of the linear susceptibility. The problem is scientifically grounded, well-posed, and all necessary definitions and parameters are provided.\n\nThe starting point is the Generalized Langevin Equation (GLE) for the coarse-grained coordinate $x(t)$:\n$$\nm\\,\\ddot{x}(t) + \\int_{0}^{t} \\Gamma(t - t')\\,\\dot{x}(t')\\,\\mathrm{d}t' + k\\,x(t) = f(t).\n$$\nWe are interested in the linear response of the system to a weak external driving force $f(t)$. The linear susceptibility $\\chi(\\omega)$ is defined in the frequency domain by the relation $\\hat{x}(\\omega) = \\chi(\\omega)\\,\\hat{f}(\\omega)$. To find $\\chi(\\omega)$, we Fourier transform the GLE. Using the provided Fourier transform convention $\\hat{g}(\\omega) = \\int_{-\\infty}^{\\infty} g(t)\\,\\exp(i\\omega t)\\,\\mathrm{d}t$, and the property for the derivative $\\widehat{\\dot{g}}(\\omega) = -i\\omega\\,\\hat{g}(\\omega)$, we have $\\widehat{\\ddot{g}}(\\omega) = (-i\\omega)^2 \\hat{g}(\\omega) = -\\omega^2 \\hat{g}(\\omega)$.\n\nThe Fourier transform of the terms are:\n1.  Inertial term: $\\mathcal{F}\\{m\\,\\ddot{x}(t)\\} = -m\\omega^2 \\hat{x}(\\omega)$.\n2.  Restoring force term: $\\mathcal{F}\\{k\\,x(t)\\} = k\\,\\hat{x}(\\omega)$.\n3.  External force term: $\\mathcal{F}\\{f(t)\\} = \\hat{f}(\\omega)$.\n\nThe friction term is a convolution of the memory kernel $\\Gamma(t)$ and the velocity $\\dot{x}(t)$. The problem states that the system is stationary and the response is linear. This implies we are looking for the steady-state response. In this context, the convolution integral can be extended to range from $-\\infty$ to $\\infty$ by recognizing that $\\Gamma(\\tau)$ is causal ($\\Gamma(\\tau)=0$ for $\\tau  0$). The convolution theorem states that the Fourier transform of a convolution is the product of the individual Fourier transforms.\n$$\n\\mathcal{F}\\left\\{\\int_{-\\infty}^{\\infty} \\Gamma(t - t')\\,\\dot{x}(t')\\,\\mathrm{d}t'\\right\\} = \\hat{\\Gamma}(\\omega)\\,\\widehat{\\dot{x}}(\\omega).\n$$\nThe problem defines a one-sided transform for the causal kernel, $\\Gamma(\\omega) \\equiv \\int_{0}^{\\infty} \\Gamma(t)\\,\\exp(i\\omega t)\\,\\mathrm{d}t$, which is equivalent to the standard two-sided transform $\\hat{\\Gamma}(\\omega)$ since $\\Gamma(t)=0$ for $t0$. Using this and $\\widehat{\\dot{x}}(\\omega) = -i\\omega\\,\\hat{x}(\\omega)$, the friction term in the frequency domain becomes $-i\\omega\\Gamma(\\omega)\\hat{x}(\\omega)$.\n\nCombining all terms, the Fourier-transformed GLE is:\n$$\n-m\\omega^2 \\hat{x}(\\omega) - i\\omega\\Gamma(\\omega)\\hat{x}(\\omega) + k\\hat{x}(\\omega) = \\hat{f}(\\omega).\n$$\nFactoring out $\\hat{x}(\\omega)$:\n$$\n\\hat{x}(\\omega)\\left[k - m\\omega^2 - i\\omega\\Gamma(\\omega)\\right] = \\hat{f}(\\omega).\n$$\nFrom the definition of the susceptibility, $\\chi(\\omega) = \\hat{x}(\\omega)/\\hat{f}(\\omega)$, we obtain:\n$$\n\\chi(\\omega) = \\frac{1}{k - m\\omega^2 - i\\omega\\Gamma(\\omega)}.\n$$\nNext, we must calculate the frequency-dependent friction coefficient $\\Gamma(\\omega)$ for the given exponential memory kernel $\\Gamma(t) = \\gamma\\,\\exp(-\\alpha t)$ for $t \\ge 0$.\n$$\n\\Gamma(\\omega) = \\int_{0}^{\\infty} \\gamma\\,\\exp(-\\alpha t)\\,\\exp(i\\omega t)\\,\\mathrm{d}t = \\gamma \\int_{0}^{\\infty} \\exp(-(\\alpha - i\\omega)t)\\,\\mathrm{d}t.\n$$\nSince $\\alpha  0$, the integral converges:\n$$\n\\Gamma(\\omega) = \\gamma \\left[ \\frac{\\exp(-(\\alpha-i\\omega)t)}{-(\\alpha-i\\omega)} \\right]_{0}^{\\infty} = \\gamma \\left( 0 - \\frac{1}{-(\\alpha-i\\omega)} \\right) = \\frac{\\gamma}{\\alpha-i\\omega}.\n$$\nNow, we substitute this expression for $\\Gamma(\\omega)$ into the equation for $\\chi(\\omega)$:\n$$\n\\chi(\\omega) = \\frac{1}{k - m\\omega^2 - i\\omega\\left(\\frac{\\gamma}{\\alpha-i\\omega}\\right)}.\n$$\nTo find the imaginary part, we first simplify the denominator:\n$$\nk - m\\omega^2 - \\frac{i\\omega\\gamma}{\\alpha-i\\omega} = k - m\\omega^2 - \\frac{i\\omega\\gamma(\\alpha+i\\omega)}{(\\alpha-i\\omega)(\\alpha+i\\omega)} = k - m\\omega^2 - \\frac{i\\omega\\gamma\\alpha + (i\\omega)^2\\gamma}{\\alpha^2 + \\omega^2}\n$$\n$$\n= k - m\\omega^2 - \\frac{i\\omega\\gamma\\alpha - \\omega^2\\gamma}{\\alpha^2 + \\omega^2} = \\left( k - m\\omega^2 + \\frac{\\gamma\\omega^2}{\\alpha^2 + \\omega^2} \\right) - i \\left( \\frac{\\gamma\\alpha\\omega}{\\alpha^2 + \\omega^2} \\right).\n$$\nThe susceptibility is of the form $\\chi(\\omega) = \\frac{1}{A - iB}$, where $A = k - m\\omega^2 + \\frac{\\gamma\\omega^2}{\\alpha^2 + \\omega^2}$ and $B = \\frac{\\gamma\\alpha\\omega}{\\alpha^2 + \\omega^2}$. The susceptibility can be written as $\\chi(\\omega) = \\chi'(\\omega) + i\\chi''(\\omega)$. The imaginary part, $\\chi''(\\omega)$, is given by:\n$$\n\\chi''(\\omega) = \\Im\\left(\\frac{1}{A-iB}\\right) = \\Im\\left(\\frac{A+iB}{A^2+B^2}\\right) = \\frac{B}{A^2+B^2}.\n$$\nSubstituting the expressions for $A$ and $B$:\n$$\n\\chi''(\\omega) = \\frac{\\frac{\\gamma\\alpha\\omega}{\\alpha^2 + \\omega^2}}{\\left(k - m\\omega^2 + \\frac{\\gamma\\omega^2}{\\alpha^2 + \\omega^2}\\right)^2 + \\left(\\frac{\\gamma\\alpha\\omega}{\\alpha^2 + \\omega^2}\\right)^2}.\n$$\nTo simplify this expression, we can multiply the numerator and denominator by $(\\alpha^2 + \\omega^2)^2$:\n$$\n\\chi''(\\omega) = \\frac{\\gamma\\alpha\\omega(\\alpha^2 + \\omega^2)}{\\left( (k - m\\omega^2)(\\alpha^2 + \\omega^2) + \\gamma\\omega^2 \\right)^2 + (\\gamma\\alpha\\omega)^2}.\n$$\nThis is the final closed-form expression for the dissipative part of the response.\n\nThe form of $\\Gamma(\\omega) = \\frac{\\gamma}{\\alpha-i\\omega} = \\frac{\\gamma\\alpha}{\\alpha^2+\\omega^2} + i\\frac{\\gamma\\omega}{\\alpha^2+\\omega^2}$ directly controls the dissipation. The dissipative part of the response, $\\chi''(\\omega)$, is proportional to the energy dissipated per cycle. A general expression for $\\chi''(\\omega)$ is $\\omega\\Re\\{\\Gamma(\\omega)\\}$ divided by the squared-modulus of the denominator of $\\chi(\\omega)$. Here, $\\Re\\{\\Gamma(\\omega)\\} = \\frac{\\gamma\\alpha}{\\alpha^2+\\omega^2}$ is the real (dissipative) part of the frequency-dependent friction. This is a Lorentzian centered at $\\omega=0$, indicating that the friction is strongest at low frequencies and decays as $1/\\omega^2$ at high frequencies. The term $\\omega\\Re\\{\\Gamma(\\omega)\\} = \\frac{\\gamma\\alpha\\omega}{\\alpha^2+\\omega^2}$ represents the power absorbed by the bath. This absorption capability is frequency-dependent, peaking at $\\omega=\\alpha$, the inverse of the memory time of the kernel. The overall dissipation spectrum $\\chi''(\\omega)$ is shaped by this frequency-dependent energy transfer to the environment, modulated by the resonant denominator which reflects the oscillator's own mechanical properties (with a natural frequency near $\\sqrt{k/m}$). This contrasts with the simple Markovian case (where $\\alpha \\to \\infty$ and $\\Gamma(\\omega)$ is constant), in which the environment can absorb energy equally at all frequencies.",
            "answer": "$$\n\\boxed{\\frac{\\gamma\\alpha\\omega(\\alpha^2 + \\omega^2)}{\\left( (k - m\\omega^2)(\\alpha^2 + \\omega^2) + \\gamma\\omega^2 \\right)^2 + (\\gamma\\alpha\\omega)^2}}\n$$"
        },
        {
            "introduction": "Building on the concept of correlation functions, this practice delves into a celebrated result of statistical physics: the hydrodynamic long-time tail. You will use the principles of fluctuating hydrodynamics to show that in two dimensions, the velocity autocorrelation function decays as a power law, leading to a surprising logarithmic divergence of the diffusion coefficient with system size. This exercise highlights the crucial role of collective, long-wavelength fluctuations in determining transport properties, a phenomenon not captured by simple kinetic models .",
            "id": "3759308",
            "problem": "Consider an equilibrium, isothermal, two-dimensional Newtonian fluid of mass density $\\rho$ and shear viscosity $\\eta$ at temperature $T$. Assume incompressibility at the scales of interest and describe the transverse velocity field $\\mathbf{u}(\\mathbf{r},t)$ using linearized Landau–Lifshitz fluctuating hydrodynamics (LLFH): conservation of momentum, linear viscous dissipation, and Gaussian white noise consistent with the fluctuation–dissipation theorem. A single tagged particle is immersed in the fluid; at long times its velocity is slaved to the local transverse hydrodynamic velocity at its location.\n\nStarting only from the conservation of momentum, linear response, and fluctuation–dissipation, and working in Fourier space for the transverse velocity modes, derive the asymptotic long-time form of the single-component velocity autocorrelation function $C_{x}(t)=\\langle v_{x}(t)\\,v_{x}(0)\\rangle$ in the infinite-system limit. Then use the Green–Kubo relation for self-diffusion, $D=\\displaystyle\\int_{0}^{\\infty}C_{x}(t)\\,\\mathrm{d}t$, to determine the leading system-size dependence of the self-diffusion coefficient $D$ in a periodic square of side $L$, assuming that hydrodynamics becomes valid only after a microscopic cutoff time $\\tau_{0}$ and that the longest hydrodynamic timescale in the box is set by the smallest nonzero wave number $k_{\\min}=2\\pi/L$. Let $\\nu=\\eta/\\rho$ denote the kinematic viscosity and parameterize the microscopic cutoff time via $\\tau_{0}=\\ell^{2}/\\nu$, where $\\ell$ is a microscopic length (for example, a mean free path or particle diameter). Define $D_{0}=\\displaystyle\\int_{0}^{\\tau_{0}}C_{x}(t)\\,\\mathrm{d}t$ as the short-time contribution, which is independent of $L$.\n\nYour task is to obtain a closed-form analytical expression for $D(L)$ in terms of $k_{B}$, $T$, $\\eta$, $L$, and $\\ell$, keeping $D_{0}$ explicit. Use only physically justified approximations consistent with LLFH and linear response, and justify each step from the stated foundational principles. Express the final diffusion coefficient in $\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$. No numerical substitution is required, and no intermediate formulas should be assumed beyond the stated physical principles. The final answer must be a single closed-form expression.",
            "solution": "The problem requires the derivation of the system-size dependence of the self-diffusion coefficient $D$ in a two-dimensional fluid, starting from the principles of linearized fluctuating hydrodynamics.\n\nThe governing equation for the transverse velocity field $\\mathbf{u}(\\mathbf{r},t)$ of an incompressible, isothermal Newtonian fluid is the linearized Landau-Lifshitz fluctuating hydrodynamics (LLFH) equation for momentum conservation:\n$$\n\\rho \\frac{\\partial \\mathbf{u}(\\mathbf{r},t)}{\\partial t} = -\\nabla p(\\mathbf{r},t) + \\eta \\nabla^2 \\mathbf{u}(\\mathbf{r},t) - \\nabla \\cdot \\mathbf{\\Pi}^s(\\mathbf{r},t)\n$$\nwhere $\\rho$ is the mass density, $\\eta$ is the shear viscosity, $p$ is the pressure, and $\\mathbf{\\Pi}^s$ is the stochastic stress tensor that models thermal fluctuations. This is coupled with the incompressibility condition, $\\nabla \\cdot \\mathbf{u} = 0$.\n\nWe analyze the system in Fourier space, where the velocity field is written as $\\mathbf{u}(\\mathbf{r},t) = \\sum_{\\mathbf{k}} \\mathbf{u}_{\\mathbf{k}}(t) \\exp(i\\mathbf{k}\\cdot\\mathbf{r})$. The incompressibility condition becomes $i\\mathbf{k} \\cdot \\mathbf{u}_{\\mathbf{k}}(t) = 0$, which signifies that the velocity modes $\\mathbf{u}_{\\mathbf{k}}$ are transverse to the wavevector $\\mathbf{k}$. Applying a Fourier transform to the momentum equation and projecting it onto the transverse direction (using the projector $\\delta_{ij} - k_i k_j / k^2$) eliminates the pressure gradient term. This results in a Langevin equation for each transverse mode $\\mathbf{u}_{\\mathbf{k}}$:\n$$\n\\rho \\frac{d\\mathbf{u}_{\\mathbf{k}}(t)}{dt} = -\\eta k^2 \\mathbf{u}_{\\mathbf{k}}(t) + \\mathbf{f}_{\\mathbf{k}}(t)\n$$\nwhere $k=|\\mathbf{k}|$ and $\\mathbf{f}_{\\mathbf{k}}(t)$ is the transverse component of the stochastic force term. Rearranging, we get:\n$$\n\\frac{d\\mathbf{u}_{\\mathbf{k}}(t)}{dt} = -\\nu k^2 \\mathbf{u}_{\\mathbf{k}}(t) + \\frac{1}{\\rho}\\mathbf{f}_{\\mathbf{k}}(t)\n$$\nwith $\\nu = \\eta/\\rho$ being the kinematic viscosity.\n\nThe problem asks for the single-component velocity autocorrelation function (VACF), $C_x(t) = \\langle v_x(t) v_x(0) \\rangle$. For a tagged particle slaved to the fluid flow at long times, this is approximated by the fluid VACF at a fixed point, $C_x(t) = \\langle u_x(\\mathbf{0},t)u_x(\\mathbf{0},0)\\rangle$. Using the Fourier series representation:\n$$\nC_x(t) = \\left\\langle \\left( \\sum_{\\mathbf{k}} u_{x,\\mathbf{k}}(t) \\right) \\left( \\sum_{\\mathbf{k'}} u_{x,\\mathbf{k'}}(0) \\right) \\right\\rangle\n$$\nDue to the statistical independence of modes in a homogeneous system, $\\langle u_{i, \\mathbf{k}} u_{j, \\mathbf{k'}} \\rangle=0$ unless $\\mathbf{k'} = -\\mathbf{k}$. Thus, the VACF is a sum over all modes:\n$$\nC_x(t) = \\sum_{\\mathbf{k}} \\langle u_{x,\\mathbf{k}}(t) u_{x,-\\mathbf{k}}(0) \\rangle\n$$\nFor a system in thermal equilibrium, the time evolution of the correlation is governed by the deterministic part of the Langevin equation. This yields:\n$$\n\\langle u_{x,\\mathbf{k}}(t) u_{x,-\\mathbf{k}}(0) \\rangle = \\langle u_{x,\\mathbf{k}}(0) u_{x,-\\mathbf{k}}(0) \\rangle \\exp(-\\nu k^2 t)\n$$\nThe initial static correlation $\\langle u_{x,\\mathbf{k}}(0) u_{x,-\\mathbf{k}}(0) \\rangle$ is determined by the equipartition theorem, a direct consequence of the fluctuation-dissipation theorem. For a 2D system of area $A=L^2$, there is one transverse degree of freedom per wavevector $\\mathbf{k}$. The average kinetic energy of this mode is $\\frac{1}{2}k_B T$.\n$$\n\\frac{1}{2}\\rho A \\langle |\\mathbf{u}_{\\mathbf{k}}|^2 \\rangle = \\frac{1}{2} k_B T \\implies \\langle u_{i,\\mathbf{k}} u_{j,-\\mathbf{k}} \\rangle = \\frac{k_B T}{\\rho A} \\left(\\delta_{ij} - \\frac{k_i k_j}{k^2}\\right)\n$$\nFor the $x$-component, this gives $\\langle u_{x,\\mathbf{k}}(0) u_{x,-\\mathbf{k}}(0) \\rangle = \\frac{k_B T}{\\rho A} (1 - \\cos^2\\phi_{\\mathbf{k}}) = \\frac{k_B T}{\\rho A} \\sin^2\\phi_{\\mathbf{k}}$, where $\\phi_{\\mathbf{k}}$ is the angle of $\\mathbf{k}$.\n\nTo find the asymptotic long-time form of $C_x(t)$, we take the infinite-system limit ($A\\to\\infty$) where the sum over $\\mathbf{k}$ becomes an integral: $\\sum_{\\mathbf{k}} \\to \\frac{A}{(2\\pi)^2}\\int d^2k$.\n$$\nC_x(t) = \\frac{k_B T}{\\rho (2\\pi)^2} \\int \\exp(-\\nu k^2 t) \\sin^2\\phi \\, d^2k\n$$\nIn polar coordinates ($d^2k = k dk d\\phi$), the integral becomes:\n$$\nC_x(t) = \\frac{k_B T}{\\rho (2\\pi)^2} \\left( \\int_0^{2\\pi} \\sin^2\\phi \\, d\\phi \\right) \\left( \\int_0^\\infty k \\exp(-\\nu k^2 t) \\, dk \\right)\n$$\nThe integrals evaluate to $\\int_0^{2\\pi} \\sin^2\\phi \\, d\\phi = \\pi$ and $\\int_0^\\infty k \\exp(-\\nu k^2 t) \\, dk = \\frac{1}{2\\nu t}$. Substituting these results yields the celebrated long-time tail:\n$$\nC_x(t) = \\frac{k_B T}{\\rho (2\\pi)^2} (\\pi) \\frac{1}{2\\nu t} = \\frac{k_B T}{8\\pi \\rho \\nu t} = \\frac{k_B T}{8\\pi \\eta t}\n$$\nThe self-diffusion coefficient $D$ is given by the Green-Kubo relation. The problem specifies a partition into a short-time contribution $D_0$ and a long-time hydrodynamic contribution $D_{hydro}(L)$:\n$$\nD(L) = \\int_0^\\infty C_x(t) \\, dt = \\int_0^{\\tau_0} C_x(t) \\, dt + \\int_{\\tau_0}^\\infty C_x(t) \\, dt = D_0 + D_{hydro}(L)\n$$\nThe long-time part exhibits a logarithmic divergence characteristic of 2D systems. This divergence is regularized by the finite system size $L$. As stated in the problem, the longest hydrodynamic timescale is set by the smallest non-zero wavevector, $k_{\\min} = 2\\pi/L$. This imposes a long-time cutoff on the integral, $t_{max} = (\\nu k_{\\min}^2)^{-1}$. We can thus calculate the hydrodynamic contribution by integrating the asymptotic form of $C_x(t)$ from the microscopic time $\\tau_0$ to this maximum timescale $t_{max}$:\n$$\nD_{hydro}(L) = \\int_{\\tau_0}^{t_{max}} \\frac{k_B T}{8\\pi \\eta t} \\, dt = \\frac{k_B T}{8\\pi \\eta} [\\ln(t)]_{\\tau_0}^{t_{max}} = \\frac{k_B T}{8\\pi \\eta} \\ln\\left(\\frac{t_{max}}{\\tau_0}\\right)\n$$\nWe are given the time cutoffs:\n- Lower cutoff: $\\tau_0 = \\ell^2/\\nu$\n- Upper cutoff: $t_{max} = \\frac{1}{\\nu k_{\\min}^2} = \\frac{1}{\\nu(2\\pi/L)^2} = \\frac{L^2}{4\\pi^2\\nu}$\n\nThe ratio of these timescales is:\n$$\n\\frac{t_{max}}{\\tau_0} = \\frac{L^2 / (4\\pi^2\\nu)}{\\ell^2/\\nu} = \\frac{L^2}{4\\pi^2 \\ell^2} = \\left(\\frac{L}{2\\pi\\ell}\\right)^2\n$$\nSubstituting this ratio into the expression for $D_{hydro}(L)$:\n$$\nD_{hydro}(L) = \\frac{k_B T}{8\\pi \\eta} \\ln\\left( \\left(\\frac{L}{2\\pi\\ell}\\right)^2 \\right) = \\frac{2 k_B T}{8\\pi \\eta} \\ln\\left(\\frac{L}{2\\pi\\ell}\\right) = \\frac{k_B T}{4\\pi \\eta} \\ln\\left(\\frac{L}{2\\pi\\ell}\\right)\n$$\nThe total diffusion coefficient is the sum of the short-time part $D_0$ and this size-dependent hydrodynamic contribution:\n$$\nD(L) = D_0 + \\frac{k_B T}{4\\pi \\eta} \\ln\\left(\\frac{L}{2\\pi\\ell}\\right)\n$$\nThis expression provides the closed-form analytical result for $D(L)$ in terms of the specified parameters and confirms the logarithmic dependence on system size, a hallmark of 2D hydrodynamics.",
            "answer": "$$\n\\boxed{D_0 + \\frac{k_B T}{4\\pi \\eta} \\ln\\left(\\frac{L}{2\\pi\\ell}\\right)}\n$$"
        },
        {
            "introduction": "This final practice bridges the gap between analytical theory and computational practice, a crucial skill in modern multiscale modeling. You will implement a computational experiment to estimate the self-diffusion coefficient from a model velocity autocorrelation function that incorporates both short-time decay and the long-time tail from the previous exercise. This hands-on problem will guide you through correcting for the inevitable finite-time and finite-size effects present in any real simulation, demonstrating how theoretical insights are applied to obtain accurate results from numerical data .",
            "id": "3759296",
            "problem": "You are tasked with implementing a computational experiment grounded in the principles of equilibrium statistical mechanics, linear response theory, and the fluctuation-dissipation theorem to estimate the self-diffusion coefficient from the velocity autocorrelation function. The focus is to elucidate how finite-time and finite-size effects influence the Green–Kubo integral estimate of diffusion. The experiment must be implementable as a standalone, deterministic program. Do not use external files or user input.\n\nContext and definitions:\n- Equilibrium Molecular Dynamics (EMD) refers to simulation or modeling at equilibrium to extract transport coefficients from time correlations.\n- Velocity Autocorrelation Function (VACF) denotes the equilibrium time correlation $C_{x}(t) = \\langle v_{x}(0)v_{x}(t)\\rangle$ for one Cartesian component in an isotropic fluid, where $\\mathbf{v}(t)$ is the particle velocity.\n- The Green–Kubo (GK) relation from linear response theory connects the self-diffusion coefficient $D$ to a time integral of the VACF.\n- The fluctuation-dissipation theorem (FDT) relates equilibrium fluctuations (here, the VACF) to transport coefficients (here, $D$).\n- Periodic boundary conditions in a cubic simulation box of edge length $L$ induce a finite-size bias in diffusion that can be corrected using hydrodynamic theory.\n\nModel and numerical tasks:\n1. Construct a parametric model for the component VACF $C_{x}(t)$ with two physically motivated contributions:\n   - A kinetic (short-time) exponential decay characterized by a friction rate $\\gamma$: $$C_{\\mathrm{kin}}(t) = \\frac{k_{B}T}{m}\\exp(-\\gamma t),$$ where $k_{B}$ is the Boltzmann constant, $T$ is the absolute temperature, and $m$ is the particle mass.\n   - A hydrodynamic long-time tail starting at a cutoff time $t_{0}$: $$C_{\\mathrm{tail}}(t) = A\\,t^{-3/2}\\,\\Theta(t-t_{0}),$$ with amplitude $A$ and the Heaviside step function $\\Theta(\\cdot)$.\n   The total model is $C_{x}(t) = C_{\\mathrm{kin}}(t) + C_{\\mathrm{tail}}(t)$.\n\n2. For each test case, discretize time as $t_{n} = n\\,\\Delta t$ for $n=0,1,\\dots,N$ up to a measurement window $T_{\\mathrm{end}} = N\\,\\Delta t$, compute $C_{x}(t_{n})$, and approximate the Green–Kubo integral for $D$ by a numerically stable quadrature over $[0,T_{\\mathrm{end}}]$. Explicitly account for:\n   - Finite-time truncation: The missing contribution beyond $T_{\\mathrm{end}}$ should be extrapolated by fitting a power law $C_{x}(t)\\sim A_{\\mathrm{est}}\\,t^{-3/2}$ over a tail-dominated region to estimate $A_{\\mathrm{est}}$ and then adding $$\\Delta D_{\\mathrm{tail}} = \\int_{T_{\\mathrm{end}}}^{\\infty} A_{\\mathrm{est}} t^{-3/2}\\,dt = 2 A_{\\mathrm{est}} T_{\\mathrm{end}}^{-1/2}.$$\n   Use a robust fallback that leverages the last available point if a tail-fit region is too short.\n   - Finite-size correction for a cubic box of size $L$ under periodic boundary conditions: Add $$\\Delta D_{\\mathrm{fs}}(L) = \\frac{k_{B}T\\,\\xi}{6\\pi\\eta\\,L},$$ where $\\xi\\approx 2.837297$ and $\\eta$ is the shear viscosity.\n\n3. Provide, for each test case, four numerical outputs:\n   - $D_{\\mathrm{naive}}$: the direct quadrature estimate over $[0,T_{\\mathrm{end}}]$ without tail extrapolation or finite-size correction.\n   - $D_{\\mathrm{tail}}$: the estimate after adding $\\Delta D_{\\mathrm{tail}}$.\n   - $D_{\\mathrm{fs}}$: the estimate after both tail extrapolation and finite-size correction.\n   - $D_{\\mathrm{true}}$: the analytic infinite-size benchmark from the model parameters, given by $$D_{\\infty} = \\int_{0}^{\\infty} C_{x}(t)\\,dt = \\frac{k_{B}T}{m\\gamma} + 2A\\,t_{0}^{-1/2}.$$\n\nPhysical units and output requirements:\n- Express all diffusion coefficients $D$ in meters squared per second ($\\mathrm{m}^{2}/\\mathrm{s}$). The printed numbers should be the raw floating-point values in these units.\n- Your program should produce a single line of output containing the results as a comma-separated list of per-test-case sublists, where each sublist is $[D_{\\mathrm{naive}},D_{\\mathrm{tail}},D_{\\mathrm{fs}},D_{\\mathrm{true}}]$. For example: $[[d_{1}^{(n)},d_{1}^{(t)},d_{1}^{(f)},d_{1}^{(\\infty)}],[d_{2}^{(n)},d_{2}^{(t)},d_{2}^{(f)},d_{2}^{(\\infty)}],\\dots]$.\n\nTest suite:\nUse Boltzmann constant $k_{B} = 1.380649\\times 10^{-23}\\,\\mathrm{J}/\\mathrm{K}$ and viscosity $\\eta=10^{-3}\\,\\mathrm{Pa}\\cdot\\mathrm{s}$ in all cases. The dimensionless constant is $\\xi=2.837297$.\n\nProvide four test cases with the following parameters (all in SI units):\n- Case 1 (happy path, well-resolved tail and moderate box): $T=300$, $m=3.0\\times 10^{-26}$, $\\gamma=5.0\\times 10^{11}$, $A=1.0\\times 10^{-15}$, $t_{0}=1.0\\times 10^{-11}$, $\\Delta t=1.0\\times 10^{-12}$, $T_{\\mathrm{end}}=5.0\\times 10^{-9}$, $L=5.0\\times 10^{-9}$.\n- Case 2 (finite-time and coarse discretization stress test): $T=300$, $m=3.0\\times 10^{-26}$, $\\gamma=5.0\\times 10^{11}$, $A=1.0\\times 10^{-15}$, $t_{0}=1.0\\times 10^{-11}$, $\\Delta t=5.0\\times 10^{-12}$, $T_{\\mathrm{end}}=2.0\\times 10^{-10}$, $L=5.0\\times 10^{-9}$.\n- Case 3 (finite-size stress test with smaller box): $T=300$, $m=3.0\\times 10^{-26}$, $\\gamma=5.0\\times 10^{11}$, $A=1.0\\times 10^{-15}$, $t_{0}=1.0\\times 10^{-11}$, $\\Delta t=1.0\\times 10^{-12}$, $T_{\\mathrm{end}}=5.0\\times 10^{-9}$, $L=2.0\\times 10^{-9}$.\n- Case 4 (edge case: short window just above tail onset): $T=300$, $m=3.0\\times 10^{-26}$, $\\gamma=5.0\\times 10^{11}$, $A=1.0\\times 10^{-15}$, $t_{0}=1.0\\times 10^{-11}$, $\\Delta t=1.0\\times 10^{-12}$, $T_{\\mathrm{end}}=2.0\\times 10^{-11}$, $L=1.0\\times 10^{-8}$.\n\nAlgorithmic constraints:\n- Use deterministic computation based on the model $C_{x}(t)$; do not simulate stochastic trajectories.\n- Use numerically stable quadrature (e.g., trapezoidal rule) for the time integral.\n- Implement a robust tail-fitting routine that defaults to a last-point-based amplitude estimate $A_{\\mathrm{est}} \\approx C_{x}(T_{\\mathrm{end}})\\,T_{\\mathrm{end}}^{3/2}$ if a meaningful fit region cannot be formed.\n- Ensure the computation completes quickly and fits within the constraints of standard desktop execution.\n\nFinal output format:\nYour program should produce a single line of output containing the list of four-element lists described above, printed exactly as a Python list representation with no extra text, for example: $[[d_{1}^{(n)},d_{1}^{(t)},d_{1}^{(f)},d_{1}^{(\\infty)}],[d_{2}^{(n)},d_{2}^{(t)},d_{2}^{(f)},d_{2}^{(\\infty)}],[d_{3}^{(n)},d_{3}^{(t)},d_{3}^{(f)},d_{3}^{(\\infty)}],[d_{4}^{(n)},d_{4}^{(t)},d_{4}^{(f)},d_{4}^{(\\infty)}]]$.",
            "solution": "The problem is valid as it is scientifically grounded in established principles of statistical mechanics, well-posed with a complete and consistent set of parameters, and objective in its formulation. It presents a standard computational physics task that is both non-trivial and verifiable.\n\nThe primary objective is to compute the self-diffusion coefficient, $D$, from a model of the single-particle velocity autocorrelation function (VACF), $C_x(t)$, and to analyze the impact of finite-time and finite-size artifacts inherent in computational simulations. The theoretical foundation for this task is the Green-Kubo relation, a cornerstone of linear response theory, which connects equilibrium time correlation functions to transport coefficients. For self-diffusion in a three-dimensional isotropic system, this relation is:\n$$D = \\int_{0}^{\\infty} C_x(t) \\, dt$$\nwhere $C_x(t) = \\langle v_x(0) v_x(t) \\rangle$ is the VACF for one Cartesian component of a particle's velocity.\n\nThe problem provides a parametric model for $C_x(t)$ consisting of two additive components:\n1.  A short-time kinetic contribution, $C_{\\mathrm{kin}}(t)$, representing rapid molecular interactions, which is modeled as an exponential decay:\n    $$C_{\\mathrm{kin}}(t) = \\frac{k_{B}T}{m}\\exp(-\\gamma t)$$\n    Here, $k_B$ is the Boltzmann constant, $T$ is the temperature, $m$ is the particle mass, and $\\gamma$ is a friction rate characterizing the decay of velocity correlations. The prefactor $\\frac{k_{B}T}{m}$ is the equipartition theorem result for $\\langle v_x^2 \\rangle$.\n\n2.  A long-time hydrodynamic contribution, $C_{\\mathrm{tail}}(t)$, which arises from collective fluid motion and is known to decay as a power law. This component is modeled as:\n    $$C_{\\mathrm{tail}}(t) = A\\,t^{-3/2}\\,\\Theta(t-t_{0})$$\n    where $A$ is the tail amplitude, $\\Theta(\\cdot)$ is the Heaviside step function, and $t_0$ is a cutoff time marking the onset of hydrodynamic behavior.\n\nThe total model VACF is $C_x(t) = C_{\\mathrm{kin}}(t) + C_{\\mathrm{tail}}(t)$.\n\nFor each test case, we are required to calculate four distinct estimates of the diffusion coefficient:\n\n**1. True Diffusion Coefficient ($D_{\\mathrm{true}}$ or $D_{\\infty}$)**\nThis is the analytical, exact value for an infinite system size and infinite time integration, obtained by integrating the model $C_x(t)$ from $t=0$ to $\\infty$:\n$$D_{\\infty} = \\int_{0}^{\\infty} \\left( C_{\\mathrm{kin}}(t) + C_{\\mathrm{tail}}(t) \\right) dt = \\int_{0}^{\\infty} \\frac{k_{B}T}{m}e^{-\\gamma t} dt + \\int_{t_0}^{\\infty} A t^{-3/2} dt$$\nEvaluating the integrals yields:\n$$D_{\\infty} = \\frac{k_{B}T}{m\\gamma} + \\left[ -2At^{-1/2} \\right]_{t_0}^{\\infty} = \\frac{k_{B}T}{m\\gamma} + 2At_0^{-1/2}$$\nThis serves as the benchmark against which the numerical estimates are compared.\n\n**2. Naive Numerical Estimate ($D_{\\mathrm{naive}}$)**\nIn a computational experiment, the VACF is only known up to a finite time, $T_{\\mathrm{end}}$. This estimate involves numerically integrating the model VACF over the available time window $[0, T_{\\mathrm{end}}]$ without any corrections.\n$$D_{\\mathrm{naive}} = \\int_{0}^{T_{\\mathrm{end}}} C_x(t) \\, dt$$\nWe will use the trapezoidal rule for this numerical quadrature, as it is robust and specified as a suitable method. For a time series discretized as $t_n = n\\Delta t$, the integral is approximated by:\n$$D_{\\mathrm{naive}} \\approx \\sum_{n=0}^{N-1} \\frac{C_x(t_n) + C_x(t_{n+1})}{2} \\Delta t$$\nwhere $T_{\\mathrm{end}} = N\\Delta t$.\n\n**3. Tail-Corrected Estimate ($D_{\\mathrm{tail}}$)**\nThe naive estimate systematically underestimates the true diffusion coefficient by truncating the integral at $T_{\\mathrm{end}}$. The missing contribution, $\\Delta D_{\\mathrm{tail}}$, is the integral of the long-time tail from $T_{\\mathrm{end}}$ to $\\infty$. To estimate this, we first estimate the tail amplitude, $A_{\\mathrm{est}}$, from the available data. The problem specifies fitting the functional form $A_{\\mathrm{est}}t^{-3/2}$ to the tail of the computed $C_x(t)$. We define a fitting region, for instance, $[ \\max(t_0, 0.75 \\cdot T_{\\mathrm{end}}), T_{\\mathrm{end}} ]$. A robust estimate for $A_{\\mathrm{est}}$ is the average value of $C_x(t_n)t_n^{3/2}$ over all points $t_n$ in this region. If this region contains fewer than two points, we use the fallback of estimating $A_{\\mathrm{est}}$ from the last data point: $A_{\\mathrm{est}} = C_x(T_{\\mathrm{end}})T_{\\mathrm{end}}^{3/2}$.\n\nThe tail correction is then calculated as the analytical integral:\n$$\\Delta D_{\\mathrm{tail}} = \\int_{T_{\\mathrm{end}}}^{\\infty} A_{\\mathrm{est}}t^{-3/2} dt = 2A_{\\mathrm{est}}T_{\\mathrm{end}}^{-1/2}$$\nThe tail-corrected diffusion coefficient is:\n$$D_{\\mathrm{tail}} = D_{\\mathrm{naive}} + \\Delta D_{\\mathrm{tail}}$$\n\n**4. Finite-Size Corrected Estimate ($D_{\\mathrm{fs}}$)**\nSimulations in a finite box of size $L$ with periodic boundary conditions introduce a systematic error in the diffusion coefficient due to the suppression of long-wavelength hydrodynamic modes. Hydrodynamic theory provides a leading-order correction for this effect in a cubic box:\n$$\\Delta D_{\\mathrm{fs}}(L) = \\frac{k_{B}T\\xi}{6\\pi\\eta L}$$\nwhere $\\eta$ is the shear viscosity of the fluid and $\\xi \\approx 2.837297$ is a constant related to the Ewald sum for the periodic lattice. This correction is added to the tail-corrected value.\nThe fully corrected diffusion coefficient is:\n$$D_{\\mathrm{fs}} = D_{\\mathrm{tail}} + \\Delta D_{\\mathrm{fs}}(L)$$\n\nThe implementation will proceed by first defining the physical constants and test case parameters. For each case, we will generate the discretized VACF, then sequentially compute $D_{\\mathrm{naive}}$, $D_{\\mathrm{tail}}$, $D_{\\mathrm{fs}}$, and the analytical $D_{\\mathrm{true}}$ following the logic outlined above. The final output will be a list containing the four calculated values for each test case.",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes diffusion coefficients based on a model VACF, accounting for\n    finite-time and finite-size effects, as specified in the problem.\n    \"\"\"\n    \n    # Physical constants\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    ETA = 1.0e-3        # Shear viscosity in Pa*s\n    XI = 2.837297     # Dimensionless constant for finite-size correction\n\n    test_cases = [\n        # Case 1: Happy path\n        {'T': 300, 'm': 3.0e-26, 'gamma': 5.0e11, 'A': 1.0e-15, 't0': 1.0e-11,\n         'dt': 1.0e-12, 'Tend': 5.0e-9, 'L': 5.0e-9},\n        # Case 2: Finite-time and coarse discretization stress test\n        {'T': 300, 'm': 3.0e-26, 'gamma': 5.0e11, 'A': 1.0e-15, 't0': 1.0e-11,\n         'dt': 5.0e-12, 'Tend': 2.0e-10, 'L': 5.0e-9},\n        # Case 3: Finite-size stress test with smaller box\n        {'T': 300, 'm': 3.0e-26, 'gamma': 5.0e11, 'A': 1.0e-15, 't0': 1.0e-11,\n         'dt': 1.0e-12, 'Tend': 5.0e-9, 'L': 2.0e-9},\n        # Case 4: Edge case: short window just above tail onset\n        {'T': 300, 'm': 3.0e-26, 'gamma': 5.0e11, 'A': 1.0e-15, 't0': 1.0e-11,\n         'dt': 1.0e-12, 'Tend': 2.0e-11, 'L': 1.0e-8},\n    ]\n\n    results = []\n\n    for params in test_cases:\n        T = params['T']\n        m = params['m']\n        gamma = params['gamma']\n        A = params['A']\n        t0 = params['t0']\n        dt = params['dt']\n        Tend = params['Tend']\n        L = params['L']\n\n        # 1. Define the model VACF and discretize time\n        def vacf_model(t, k_b, T, m, gamma, A, t0):\n            c_kin = (k_b * T / m) * np.exp(-gamma * t)\n            # Heaviside step function implemented with a boolean mask\n            c_tail = A * np.power(t, -1.5, where=t > 0, out=np.zeros_like(t)) * (t >= t0)\n            return c_kin + c_tail\n\n        t_points = np.arange(0, Tend + dt/2, dt)\n        if t_points[-1] > Tend:\n             t_points = t_points[:-1]\n        \n        c_values = vacf_model(t_points, K_B, T, m, gamma, A, t0)\n\n        # 2. Calculate D_naive: direct quadrature over [0, T_end]\n        d_naive = integrate.trapezoid(c_values, t_points)\n\n        # 3. Calculate D_tail: apply tail extrapolation correction\n        # Define the region for fitting the tail amplitude A_est\n        fit_start_time = max(t0, 0.75 * Tend)\n        \n        #\n        # Handle the edge case where Tend is close to t0.\n        # Ensure fit_start_time is not beyond the simulation window.\n        if fit_start_time >= Tend:\n             fit_indices = np.array([], dtype=int)\n        else:\n             fit_indices = np.where(t_points >= fit_start_time)[0]\n\n        # Use robust fallback if the fit region is too small ( 2 points)\n        if len(fit_indices)  2:\n            c_end = vacf_model(Tend, K_B, T, m, gamma, A, t0)\n            A_est = c_end * (Tend**1.5)\n        else:\n            t_fit = t_points[fit_indices]\n            c_fit = c_values[fit_indices]\n            # Estimate A_est by averaging C(t) * t^(3/2) over the fit region\n            A_est_values = c_fit * np.power(t_fit, 1.5)\n            A_est = np.mean(A_est_values)\n\n        delta_d_tail = 2 * A_est * (Tend**-0.5) if Tend > 0 else 0\n        d_tail = d_naive + delta_d_tail\n\n        # 4. Calculate D_fs: apply finite-size correction\n        delta_d_fs = (K_B * T * XI) / (6 * np.pi * ETA * L)\n        d_fs = d_tail + delta_d_fs\n\n        # 5. Calculate D_true: the analytical infinite-size benchmark\n        d_true_kin = (K_B * T) / (m * gamma)\n        d_true_tail = 2 * A * (t0**-0.5) if t0 > 0 else 0\n        d_true = d_true_kin + d_true_tail\n\n        results.append([d_naive, d_tail, d_fs, d_true])\n\n    # Final print statement in the exact required format.\n    print(str(results).replace(\"], [\", \"],\\n [\"))\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}