{
    "hands_on_practices": [
        {
            "introduction": "The Mori-Zwanzig formalism elegantly recasts classical dynamics within the framework of a Hilbert space of observables. A crucial first step in any application is defining this space and constructing a suitable basis for the chosen resolved variables. This exercise provides foundational practice in this procedure by guiding you through the construction of an orthonormal basis from a set of nonlinear observables using the Gram-Schmidt process, governed by the Mori inner product derived from an equilibrium ensemble. By then calculating the frequency matrix and the initial value of the memory kernel, you will gain direct experience with the core mathematical machinery of the formalism. ",
            "id": "3731357",
            "problem": "Consider a classical one-dimensional harmonic oscillator with Hamiltonian $H(x,p)=\\frac{p^{2}}{2m}+\\frac{k}{2}x^{2}$ in equilibrium at inverse temperature $\\beta$. Let the equilibrium canonical expectation be denoted by $\\langle \\cdot \\rangle_{\\mathrm{eq}}$ with respect to the properly normalized Boltzmann weight $\\rho(x,p)\\propto \\exp(-\\beta H)$. Define the Mori inner product for classical observables $A$ and $B$ as $(A,B)\\equiv \\langle A B \\rangle_{\\mathrm{eq}}$. The Liouvillian operator $i\\mathcal{L}$ acts on phase-space functions by the Poisson bracket with the Hamiltonian, $i\\mathcal{L}A=\\{A,H\\}$.\n\nLet the initial (non-orthonormal) set of resolved observables be the nonlinear set $\\mathcal{A}_{0}=\\{x, x^{3}\\}$. Starting from the definitions above and using only equilibrium properties of the canonical ensemble and Hamiltonian dynamics:\n\n1. Construct an orthonormal basis $\\{A_{1},A_{2}\\}$ from $\\mathcal{A}_{0}$ using the Gram-Schmidt procedure under the inner product $(\\cdot,\\cdot)$. Your derivation should explicitly use the equilibrium Gaussian statistics of $x$ and $p$ implied by the harmonic Hamiltonian.\n\n2. Using the resulting orthonormal $\\{A_{1},A_{2}\\}$ and the Liouvillian $i\\mathcal{L}$, derive the frequency matrix elements $\\Omega_{ij}=(A_{i}, i\\mathcal{L} A_{j})$ and explain, based on symmetry, which elements vanish and why. Do not assume any result about $\\Omega_{ij}$ without derivation from the fundamental definitions given.\n\n3. In the projection-operator formulation of the Mori-Zwanzig Generalized Langevin Equation (GLE), for an orthonormal resolved basis, the fluctuating force is $F_{i}(t)=\\exp(t\\,Q\\,i\\mathcal{L})\\,Q\\,i\\mathcal{L}A_{i}$, where $Q$ is the orthogonal projector $Q=I-P$ onto the unresolved subspace and $P$ is the projector onto ${\\rm span}\\{A_{1},A_{2}\\}$. Using these definitions, derive from first principles an expression for the short-time memory kernel element $K_{11}(0)$ in terms of $(\\cdot,\\cdot)$ and $i\\mathcal{L}$, and then compute $K_{11}(0)$ explicitly for this system.\n\nReport as your final answer the single closed-form expression for $K_{11}(0)$ in terms of $m$ and $k$. No numerical substitution or rounding is required.",
            "solution": "The problem requires a three-part derivation within the Mori-Zwanzig formalism for a classical one-dimensional harmonic oscillator. We will address each part systematically. The Hamiltonian is $H(x,p) = \\frac{p^{2}}{2m} + \\frac{k}{2}x^{2}$. The Mori inner product is $(A,B) \\equiv \\langle AB \\rangle_{\\mathrm{eq}}$, where $\\langle \\cdot \\rangle_{\\mathrm{eq}}$ denotes an average over the canonical ensemble with distribution $\\rho(x,p) \\propto \\exp(-\\beta H)$.\n\nThe phase-space distribution is a product of two independent Gaussian distributions for $x$ and $p$:\n$$\n\\rho(x,p) = \\frac{1}{Z_{x}} \\exp\\left(-\\frac{\\beta k}{2} x^{2}\\right) \\cdot \\frac{1}{Z_{p}} \\exp\\left(-\\frac{\\beta}{2m} p^{2}\\right)\n$$\nwhere $Z_x$ and $Z_p$ are normalization constants. The moments of these distributions are crucial. For any integer $n \\geq 0$:\n$\\langle x^{2n+1} \\rangle_{\\mathrm{eq}} = 0$ and $\\langle p^{2n+1} \\rangle_{\\mathrm{eq}} = 0$ due to symmetry.\nThe non-zero even moments are given by the properties of Gaussian distributions:\n$$\n\\langle x^{2} \\rangle_{\\mathrm{eq}} = \\frac{1}{\\beta k}\n$$\n$$\n\\langle p^{2} \\rangle_{\\mathrm{eq}} = \\frac{m}{\\beta}\n$$\nHigher even moments can be found using Wick's theorem for classical variables, for instance, $\\langle x^{2n} \\rangle_{\\mathrm{eq}} = (2n-1)!! (\\langle x^{2} \\rangle_{\\mathrm{eq}})^{n}$, where $(2n-1)!! = (2n-1)(2n-3)\\cdots 1$. Specifically, we will need:\n$$\n\\langle x^{4} \\rangle_{\\mathrm{eq}} = 3 (\\langle x^{2} \\rangle_{\\mathrm{eq}})^{2} = \\frac{3}{(\\beta k)^{2}}\n$$\n$$\n\\langle x^{6} \\rangle_{\\mathrm{eq}} = 15 (\\langle x^{2} \\rangle_{\\mathrm{eq}})^{3} = \\frac{15}{(\\beta k)^{3}}\n$$\n\n**Part 1: Gram-Schmidt Orthogonalization**\n\nWe start with the non-orthonormal set of observables $\\mathcal{A}_{0} = \\{x, x^{3}\\}$. Let's denote these as $v_{1} = x$ and $v_{2} = x^{3}$. We construct an orthonormal basis $\\{ A_{1}, A_{2} \\}$ using the Gram-Schmidt procedure with the inner product $(A,B) = \\langle AB \\rangle_{\\mathrm{eq}}$.\n\nFirst, we construct the first basis vector $A_{1}$. Let $u_{1} = v_{1} = x$. We normalize it:\n$$\n||u_{1}||^{2} = (u_{1}, u_{1}) = (x, x) = \\langle x^{2} \\rangle_{\\mathrm{eq}} = \\frac{1}{\\beta k}\n$$\nThe norm is $||u_{1}|| = \\sqrt{\\frac{1}{\\beta k}}$. The first orthonormal vector is:\n$$\nA_{1} = \\frac{u_{1}}{||u_{1}||} = \\sqrt{\\beta k} \\, x\n$$\n\nNext, we construct the second basis vector $A_{2}$. We first find the component of $v_{2}$ orthogonal to $A_{1}$:\n$$\nu_{2} = v_{2} - (v_{2}, A_{1}) A_{1}\n$$\nWe compute the inner product $(v_{2}, A_{1})$:\n$$\n(v_{2}, A_{1}) = (x^{3}, \\sqrt{\\beta k} \\, x) = \\sqrt{\\beta k} \\langle x^{4} \\rangle_{\\mathrm{eq}} = \\sqrt{\\beta k} \\frac{3}{(\\beta k)^{2}} = \\frac{3}{\\beta k \\sqrt{\\beta k}}\n$$\nNow we can write $u_{2}$:\n$$\nu_{2} = x^{3} - \\left( \\frac{3}{\\beta k \\sqrt{\\beta k}} \\right) (\\sqrt{\\beta k} \\, x) = x^{3} - \\frac{3}{\\beta k} x\n$$\nTo obtain $A_{2}$, we normalize $u_{2}$. We compute its norm squared:\n$$\n||u_{2}||^{2} = (u_{2}, u_{2}) = \\left\\langle \\left( x^{3} - \\frac{3}{\\beta k} x \\right)^{2} \\right\\rangle_{\\mathrm{eq}} = \\left\\langle x^{6} - \\frac{6}{\\beta k} x^{4} + \\frac{9}{(\\beta k)^{2}} x^{2} \\right\\rangle_{\\mathrm{eq}}\n$$\nUsing linearity of the expectation and substituting the moments calculated earlier:\n$$\n||u_{2}||^{2} = \\langle x^{6} \\rangle_{\\mathrm{eq}} - \\frac{6}{\\beta k} \\langle x^{4} \\rangle_{\\mathrm{eq}} + \\frac{9}{(\\beta k)^{2}} \\langle x^{2} \\rangle_{\\mathrm{eq}} = \\frac{15}{(\\beta k)^{3}} - \\frac{6}{\\beta k} \\frac{3}{(\\beta k)^{2}} + \\frac{9}{(\\beta k)^{2}} \\frac{1}{\\beta k} = \\frac{15 - 18 + 9}{(\\beta k)^{3}} = \\frac{6}{(\\beta k)^{3}}\n$$\nThe norm is $||u_{2}|| = \\sqrt{\\frac{6}{(\\beta k)^{3}}}$. The second orthonormal vector is:\n$$\nA_{2} = \\frac{u_{2}}{||u_{2}||} = \\sqrt{\\frac{(\\beta k)^{3}}{6}} \\left( x^{3} - \\frac{3}{\\beta k} x \\right)\n$$\nSo, the orthonormal basis is $\\{A_{1}, A_{2}\\} = \\left\\{ \\sqrt{\\beta k} \\, x, \\sqrt{\\frac{(\\beta k)^{3}}{6}} \\left( x^{3} - \\frac{3}{\\beta k} x \\right) \\right\\}$.\n\n**Part 2: Frequency Matrix $\\Omega_{ij}$**\n\nThe frequency matrix elements are defined as $\\Omega_{ij} = (A_{i}, i\\mathcal{L} A_{j})$. The Liouvillian operator acts via the Poisson bracket: $i\\mathcal{L}A = \\{A, H\\}$.\n$$\ni\\mathcal{L}A = \\frac{\\partial A}{\\partial x}\\frac{\\partial H}{\\partial p} - \\frac{\\partial A}{\\partial p}\\frac{\\partial H}{\\partial x} = \\frac{\\partial A}{\\partial x}\\frac{p}{m} - \\frac{\\partial A}{\\partial p}(-kx) = \\frac{p}{m}\\frac{\\partial A}{\\partial x} + kx\\frac{\\partial A}{\\partial p}\n$$\nSince both $A_{1}$ and $A_{2}$ are functions of $x$ only, $\\frac{\\partial A_{i}}{\\partial p} = 0$. The action of $i\\mathcal{L}$ simplifies to:\n$$\ni\\mathcal{L}A_{i}(x) = \\frac{p}{m}\\frac{dA_{i}}{dx}\n$$\nLet's compute $i\\mathcal{L}A_{1}$ and $i\\mathcal{L}A_{2}$:\n$$\ni\\mathcal{L}A_{1} = \\frac{p}{m}\\frac{d}{dx}(\\sqrt{\\beta k} \\, x) = \\frac{\\sqrt{\\beta k}}{m} p\n$$\n$$\ni\\mathcal{L}A_{2} = \\frac{p}{m}\\frac{d}{dx}\\left(\\sqrt{\\frac{(\\beta k)^{3}}{6}} \\left( x^{3} - \\frac{3}{\\beta k} x \\right)\\right) = \\frac{p}{m}\\sqrt{\\frac{(\\beta k)^{3}}{6}} \\left( 3x^{2} - \\frac{3}{\\beta k} \\right)\n$$\nNow we compute the matrix elements $\\Omega_{ij} = \\langle A_{i} (i\\mathcal{L} A_{j}) \\rangle_{\\mathrm{eq}}$.\nA crucial symmetry arises here. Both $A_{1}(x)$ and $A_{2}(x)$ are functions of $x$ only. Both $i\\mathcal{L}A_{1}$ and $i\\mathcal{L}A_{2}$ are separable into a function of $x$ and the first power of $p$. For any $i, j \\in \\{1,2\\}$, the integrand for $\\Omega_{ij}$ will have the form $f(x)p$.\n$$\n\\Omega_{ij} = \\langle A_{i}(x) \\cdot (g(x)p) \\rangle_{\\mathrm{eq}} = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} A_{i}(x) g(x) p \\, \\rho(x,p) \\, dx \\, dp\n$$\nSince $\\rho(x,p)$ separates into $\\rho_{x}(x)\\rho_{p}(p)$ and the variables are independent, this becomes:\n$$\n\\Omega_{ij} = \\left( \\int_{-\\infty}^{\\infty} A_{i}(x)g(x) \\rho_{x}(x) dx \\right) \\left( \\int_{-\\infty}^{\\infty} p \\, \\rho_{p}(p) dp \\right) = \\langle A_{i}(x)g(x) \\rangle_{\\mathrm{eq}} \\langle p \\rangle_{\\mathrm{eq}}\n$$\nThe equilibrium distribution for momentum, $\\rho_{p}(p)$, is an even function of $p$. Therefore, the average of $p$ is zero: $\\langle p \\rangle_{\\mathrm{eq}} = 0$. Consequently, all elements of the frequency matrix vanish:\n$$\n\\Omega_{ij} = 0 \\quad \\text{for all } i, j \\in \\{1,2\\}\n$$\nThis is a direct consequence of the fact that our chosen coarse-grained variables $A_{i}$ are all even functions of momentum, while the Liouvillian maps even functions of momentum to odd functions of momentum. The inner product between an even and an odd function of $p$ is zero.\n\n**Part 3: Short-Time Memory Kernel $K_{11}(0)$**\n\nThe memory kernel is defined as $K_{ij}(t) = (F_{i}(t), F_{j}(0))$, where the fluctuating force is $F_{i}(t) = \\exp(t Q i\\mathcal{L}) Q i\\mathcal{L} A_{i}$. We need to compute $K_{11}(0)$.\n$$\nK_{11}(0) = (F_{1}(0), F_{1}(0))\n$$\nThe fluctuating force at time $t=0$ is $F_{1}(0) = Q i\\mathcal{L} A_{1}$. So,\n$$\nK_{11}(0) = (Q i\\mathcal{L} A_{1}, Q i\\mathcal{L} A_{1})\n$$\nThe projector $Q$ is Hermitian with respect to the Mori inner product, i.e., $(Q A, B)=(A, Q B)$, and idempotent, $Q^{2}=Q$. Therefore:\n$$\nK_{11}(0) = (i\\mathcal{L} A_{1}, Q^{2} i\\mathcal{L} A_{1}) = (i\\mathcal{L} A_{1}, Q i\\mathcal{L} A_{1})\n$$\nUsing the definition $Q=I-P$:\n$$\nK_{11}(0) = (i\\mathcal{L} A_{1}, (I-P) i\\mathcal{L} A_{1}) = (i\\mathcal{L} A_{1}, i\\mathcal{L} A_{1}) - (i\\mathcal{L} A_{1}, P i\\mathcal{L} A_{1})\n$$\nThe projector $P$ onto the space spanned by $\\{A_{1}, A_{2}\\}$ acts on an observable $B$ as $P B = \\sum_{j=1}^{2} (B, A_{j}) A_{j}$. Applying this to $B=i\\mathcal{L}A_1$:\n$$\nP(i\\mathcal{L}A_{1}) = (i\\mathcal{L} A_{1}, A_{1}) A_{1} + (i\\mathcal{L} A_{1}, A_{2}) A_{2}\n$$\nThe coefficients are related to the frequency matrix. The inner product is symmetric for real observables, so $(i\\mathcal{L} A_{1}, A_{j}) = (A_{j}, i\\mathcal{L} A_{1}) = \\Omega_{j1}$.\n$$\nP(i\\mathcal{L}A_{1}) = \\Omega_{11} A_{1} + \\Omega_{21} A_{2}\n$$\nFrom Part 2, we found that all elements of $\\Omega$ are zero. Thus, $\\Omega_{11}=0$ and $\\Omega_{21}=0$, which implies $P(i\\mathcal{L}A_{1}) = 0$.\nThe expression for $K_{11}(0)$ simplifies significantly:\n$$\nK_{11}(0) = (i\\mathcal{L} A_{1}, i\\mathcal{L} A_{1}) - (i\\mathcal{L} A_{1}, 0) = (i\\mathcal{L} A_{1}, i\\mathcal{L} A_{1}) = ||i\\mathcal{L} A_{1}||^{2}\n$$\nThis means that the \"time derivative\" of $A_{1}$, which is $i\\mathcal{L}A_{1}$, is completely orthogonal to the subspace spanned by $\\{A_{1}, A_{2}\\}$, and thus lies entirely in the \"unresolved\" subspace. The random force is identical to this time derivative.\n\nWe now compute the value of $K_{11}(0)$ using the expression for $i\\mathcal{L}A_1$ from Part 2:\n$$\ni\\mathcal{L}A_{1} = \\frac{\\sqrt{\\beta k}}{m} p\n$$\n$$\nK_{11}(0) = \\left\\langle \\left( \\frac{\\sqrt{\\beta k}}{m} p \\right)^{2} \\right\\rangle_{\\mathrm{eq}} = \\frac{\\beta k}{m^{2}} \\langle p^{2} \\rangle_{\\mathrm{eq}}\n$$\nSubstituting the equilibrium moment $\\langle p^{2} \\rangle_{\\mathrm{eq}} = \\frac{m}{\\beta}$:\n$$\nK_{11}(0) = \\frac{\\beta k}{m^{2}} \\left( \\frac{m}{\\beta} \\right) = \\frac{k}{m}\n$$\nThe final result for the short-time memory kernel element $K_{11}(0)$ is $\\frac{k}{m}$.",
            "answer": "$$\\boxed{\\frac{k}{m}}$$"
        },
        {
            "introduction": "A robust theoretical framework must be consistent with fundamental physical principles, such as conservation laws. This practice offers a powerful conceptual check on the Mori-Zwanzig formalism by examining its application to an invariant of motion—an observable that remains constant throughout the system's evolution. By analyzing a simple planar rotation system with a clear conserved quantity, you will demonstrate how the key components of the Generalized Langevin Equation—the instantaneous drift, the memory term, and the orthogonal \"random\" force—all vanish. This confirms that the formalism correctly reproduces the trivial dynamics of a conserved quantity, thereby deepening your understanding of the distinct role each term plays in the coarse-grained description. ",
            "id": "3731397",
            "problem": "Consider the planar rotation system given by the autonomous ordinary differential equation\n$$\n\\dot{x}=-y,\\qquad \\dot{y}=x,\n$$\nwith state vector $z=(x,y)$. Let $L$ denote the Liouville operator (the Koopman generator) associated with this flow, acting on sufficiently smooth observables $g:\\mathbb{R}^{2}\\to\\mathbb{R}$. Define the observable $g(x,y)=x^2+y^2$. Starting from first principles of dynamical systems and operator-based coarse-graining, and without invoking any pre-derived shortcut formulas, derive the explicit expression for $Lg$ and verify that it is identically zero for all $(x,y)\\in\\mathbb{R}^{2}$. Then, explain the implications of this invariance for projected dynamics under the Mori–Zwanzig formalism (define the acronym on first use), particularly how an invariant observable that lies in the resolved subspace influences the instantaneous drift, orthogonal dynamics, and memory term in the generalized Langevin representation.\n\nProvide the single, simplified closed-form value of $Lg$ as your final answer. No units are required. If you find a numerical value, do not round; if symbolic, present an exact expression.",
            "solution": "The solution is presented in two parts as requested: first, the derivation and verification of the value of $Lg$, and second, the explanation of the implications for the Mori-Zwanzig formalism.\n\n**Part 1: Derivation of $Lg$**\n\nThe Liouville operator $L$, also known as the generator of the Koopman operator semigroup, describes the infinitesimal time evolution of an observable $g(z)$ along the flow of a dynamical system $\\dot{z} = F(z)$. It is defined from first principles by the action of the vector field on the observable:\n$$\nLg(z) = \\frac{d}{dt} g(z(t)) \\bigg|_{t=0}\n$$\nUsing the chain rule, this can be expressed as the dot product of the vector field $F(z)$ and the gradient of the observable $\\nabla g(z)$:\n$$\nLg(z) = F(z) \\cdot \\nabla g(z)\n$$\nFor the given planar rotation system, the state vector is $z=(x,y)$ and the vector field is $F(x,y) = (\\dot{x}, \\dot{y}) = (-y, x)$.\nThe observable is $g(x,y) = x^{2}+y^{2}$.\n\nFirst, we compute the gradient of $g(x,y)$:\n$$\n\\nabla g(x,y) = \\left(\\frac{\\partial g}{\\partial x}, \\frac{\\partial g}{\\partial y}\\right)\n$$\nThe partial derivatives are:\n$$\n\\frac{\\partial g}{\\partial x} = \\frac{\\partial}{\\partial x}(x^{2}+y^{2}) = 2x\n$$\n$$\n\\frac{\\partial g}{\\partial y} = \\frac{\\partial}{\\partial y}(x^{2}+y^{2}) = 2y\n$$\nSo, the gradient is:\n$$\n\\nabla g(x,y) = (2x, 2y)\n$$\nNow, we can compute $Lg$ by taking the dot product of $F(x,y)$ and $\\nabla g(x,y)$:\n$$\nLg(x,y) = F(x,y) \\cdot \\nabla g(x,y) = (-y, x) \\cdot (2x, 2y)\n$$\nPerforming the dot product gives:\n$$\nLg(x,y) = (-y)(2x) + (x)(2y) = -2xy + 2xy = 0\n$$\nThis result holds for all $(x,y) \\in \\mathbb{R}^{2}$. Thus, we have verified that $Lg$ is identically zero. This is expected, as $g(x,y) = x^{2}+y^{2}$ represents the squared radius of the particle's position, which is a conserved quantity (an integral of motion) for this rotation system. An observable is an invariant of motion if and only if it is in the null space of the Liouville operator, i.e., $Lg = 0$.\n\n**Part 2: Implications for the Mori–Zwanzig Formalism**\n\nThe Mori–Zwanzig (MZ) formalism is a projection operator technique used in non-equilibrium statistical mechanics to derive a coarse-grained description of a system's dynamics. It formally partitions the full dynamics into a resolved part (the \"slow\" variables of interest) and an unresolved part (the remaining \"fast\" degrees of freedom).\n\nLet the space of observables be a Hilbert space. We define a projection operator $P$ that projects any observable onto the subspace spanned by our chosen set of resolved variables. The complementary operator $Q=I-P$ projects onto the orthogonal subspace. The Liouville equation, $\\frac{d}{dt}A(t) = LA(t)$, can be manipulated using these operators to yield a Generalized Langevin Equation (GLE) for the resolved dynamics.\n\nThe GLE for a resolved observable $A(t)$ has the general structure:\n$$\n\\frac{d}{dt}A(t) = \\text{(Instantaneous Drift)} + \\text{(Memory Term)} + \\text{(Orthogonal Dynamics)}\n$$\nLet's analyze each term in the context of our observable $g(x,y)$, which we assume is a member of the resolved subspace (i.e., $Pg = g$). The fact that $g$ is an invariant of motion, $Lg = 0$, has profound implications for each component of the GLE.\n\n1.  **Instantaneous Drift**: This term describes the part of the dynamics that maps the resolved subspace onto itself. It is given by $PLA$. For our observable $g$, this term is $PLg$. Since we have proven that $Lg=0$, the drift term is:\n    $$\n    PLg = P(0) = 0\n    $$\n    The instantaneous drift for the invariant observable $g$ is identically zero. This means there is no systematic, instantaneous tendency for $g$ to change its value due to dynamics within the resolved subspace.\n\n2.  **Orthogonal Dynamics (Random Force)**: This term, often denoted $R(t)$, represents the influence of the unresolved degrees of freedom on the resolved ones. It is defined as $R(t) = \\exp(QLt)QLA$. For our observable $g$, the force at time $t=0$ is $R(0) = QLg$. Since $Lg=0$, we have:\n    $$\n    QLg = Q(0) = 0\n    $$\n    Because the initial force is zero, the time-evolved force $R(t) = \\exp(QLt)(0)$ is also zero for all $t \\ge 0$. This means the invariant observable $g$ experiences no fluctuating \"force\" from the orthogonal part of the system.\n\n3.  **Memory Term**: This term describes the delayed response of the resolved variables to their own past history, mediated by the unresolved dynamics. The memory kernel, $K(t)$, is given by an expression of the form $K(t) = PL\\exp(QLt)QLA \\dots$. A crucial component of this kernel is the term $QLA$, which couples the resolved dynamics to the orthogonal subspace. For our observable $g$, this coupling is $QLg$. As shown above, $QLg=0$. Consequently, the entire memory kernel is identically zero:\n    $$\n    K(t) = 0 \\quad \\text{for all } t \\ge 0\n    $$\n    This implies that the evolution of $g$ has no dependence on its past values; there are no memory effects.\n\nIn summary, if an invariant of motion $g$ (where $Lg=0$) is included in the set of resolved variables, the GLE for that observable collapses completely. The drift, memory, and random force terms all vanish. The resulting equation of motion is simply:\n$$\n\\frac{d}{dt}g(t) = 0 + 0 + 0 = 0\n$$\nThis demonstrates that the Mori-Zwanzig formalism is consistent: it correctly reproduces the trivial dynamics of a conserved quantity. The inclusion of such an observable in the resolved set effectively decouples it from the rest of the system's dynamics within the coarse-grained description, reflecting its inherent invariance.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "One of the central challenges in coarse-graining is dealing with memory effects, where the future evolution of a system depends on its past. While a clear separation of timescales often allows for memoryless (Markovian) approximations, this is not always valid. This exercise explores a critical scenario where such approximations fail, involving a slow variable coupled to an undamped, periodic fast subsystem. You will derive an exact, non-decaying memory kernel from first principles, demonstrating how the Mori-Zwanzig formalism correctly captures persistent memory effects that naive homogenization techniques would miss. This practice highlights the unique power of the framework to provide rigorous descriptions for complex, non-Markovian systems. ",
            "id": "3731361",
            "problem": "Consider a three-dimensional deterministic dynamical system that separates into a single slow variable and a two-dimensional fast subsystem. The slow variable is $x(t)$ and the fast subsystem is an undamped planar oscillator with coordinates $y(t)$ and $z(t)$. The dynamics are given by\n$$\n\\dot{x}(t) = -\\lambda\\, x(t) + c\\, y(t),\n$$\n$$\n\\dot{y}(t) = \\kappa\\, x(t) + \\omega\\, z(t),\n$$\n$$\n\\dot{z}(t) = -\\omega\\, y(t),\n$$\nwhere $\\lambda > 0$ is the slow relaxation rate, $\\omega > 0$ is the oscillator frequency, and $c, \\kappa$ are constant coupling coefficients. The fast subsystem is periodic, and its intrinsic dynamics do not include any damping.\n\nStarting from the fundamental base of projection operator methods and the Liouville operator approach, derive the exact non-Markovian evolution for the resolved slow coordinate $x(t)$ under the Mori-Zwanzig (MZ) formalism, where the resolved observable is the coordinate function $A(X)=x$ of the full state $X=(x,y,z)$. In particular, use the following foundational elements without invoking any pre-derived compact formulas:\n\n- The Liouville operator $L$ acting on smooth observables $f(X)$ by $L f = \\nabla f(X) \\cdot \\dot{X}$, where $\\dot{X}$ is given by the system above.\n- A projection operator $P$ onto the resolved observable $A(X)=x$ that removes dependence on $(y,z)$ and closes the dynamics for $x(t)$.\n- The decomposition into resolved and orthogonal subspaces via $P$ and $Q = I - P$, where $I$ is the identity operator.\n\nFrom first principles, eliminate the fast variables to obtain an exact Generalized Langevin Equation (GLE) for $x(t)$ of the form\n$$\n\\dot{x}(t) = -\\lambda\\, x(t) + \\int_{0}^{t} K(t-s)\\, x(s)\\, ds + F(t),\n$$\nwhere $K(t)$ is the memory kernel and $F(t)$ is a fluctuating term determined by the initial conditions of the fast subsystem and the orthogonal dynamics. Then, identify the closed-form analytic expression for the memory kernel $K(t)$ for this system, and explain why it does not decay in time. Finally, discuss why naive homogenization that relies on rapidly decaying fast correlations fails to produce a valid Markovian closure here, and briefly indicate how the Mori-Zwanzig formalism captures the non-decaying memory through the orthogonal dynamics.\n\nProvide your final answer as the explicit closed-form expression $K(t) = \\dots$. No numerical evaluation is required. Do not include units. No rounding is needed.",
            "solution": "The evolution of any observable $f(X)$ is governed by the Liouville operator $L$. For a state vector $X(t)$, an observable $f(X(t))$ evolves as $\\frac{d}{dt} f(X(t)) = (L f)(X(t))$, where $L \\equiv \\dot{X} \\cdot \\nabla_X$.\nFor the given system, the Liouville operator is:\n$$\nL = (-\\lambda x + c y)\\frac{\\partial}{\\partial x} + (\\kappa x + \\omega z)\\frac{\\partial}{\\partial y} + (-\\omega y)\\frac{\\partial}{\\partial z}\n$$\nWe are interested in the evolution of the observable $A(X) = x$. Its equation of motion is:\n$$\n\\dot{x}(t) = (L x)(X(t)) = -\\lambda x(t) + c y(t)\n$$\nThe goal is to eliminate the fast variables $y(t)$ and $z(t)$ to obtain a closed equation for $x(t)$. The Mori-Zwanzig formalism provides a systematic way to do this. We define a projection operator $P$ that projects any observable onto the subspace of observables that are functions of the resolved variable $x$. For this linear system, we can work within the vector space of observables spanned by $\\{x, y, z\\}$. A natural choice for the projection operator $P$ that \"removes dependence on $(y,z)$\" is one that acts as follows on the basis observables:\n$$\nPx = x, \\quad Py = 0, \\quad Pz = 0\n$$\nThe orthogonal operator is $Q = I - P$, which gives:\n$$\nQx = 0, \\quad Qy = y, \\quad Qz = z\n$$\nThe equation of motion for an observable $A$ can be formally solved as $A(t) = e^{Lt}A(0)$, where $A(0)$ is the function $A$ evaluated at the initial state $X(0)$. The time evolution operator $e^{Lt}$ can be exactly decomposed using the Dyson identity, leading to the Nakajima-Zwanzig equation. For the variable $x(t)$, which is already a projected variable ($x=Px$), its evolution is given by the exact GLE:\n$$\n\\dot{x}(t) = (e^{Lt} L x)(X_0) = (PLx)(t) + \\int_0^t ds\\, (PL e^{QLs} QLx)(t-s) + (e^{QLt} QLx)(X_0)\n$$\nHere, $(f)(t)$ and $(f)(t-s)$ denote evaluating the resulting observable $f$ at the state $X(t)$ and $X(t-s)$ respectively. The three terms correspond to the Markovian drift, the memory integral, and the fluctuating force.\n\nLet us evaluate each component.\n1.  **Drift (Markovian) Term:** The first term in the GLE corresponds to the part of the dynamics that can be expressed instantaneously in terms of $x(t)$.\n    $$\n    PLx = P(-\\lambda x + c y) = -\\lambda (Px) + c (Py) = -\\lambda x\n    $$\n    So, the drift term is $(PLx)(t) = -\\lambda x(t)$, which matches the first term in the target GLE form.\n\n2.  **Memory Kernel Term:** This term contains the memory effects. It is given by $\\int_0^t K(t-s)x(s) ds$. The formal expression from MZ is $\\int_0^t ds\\, (PL e^{QLs} QLx)(X(t-s))$.\n    First, we find the \"flux\" into the orthogonal subspace, $QLx$:\n    $$\n    QLx = Q(-\\lambda x + c y) = -\\lambda (Qx) + c (Qy) = c y\n    $$\n    Next, we need to evolve this term $cy$ with the orthogonal dynamics propagator $e^{QLt}$. The generator of these dynamics is $QL$. Let's find its action on the basis of the orthogonal subspace, $\\{y, z\\}$:\n    $$\n    QLy = Q(Ly) = Q(\\kappa x + \\omega z) = \\kappa (Qx) + \\omega (Qz) = \\omega z\n    $$\n    $$\n    QLz = Q(Lz) = Q(-\\omega y) = -\\omega (Qy) = -\\omega y\n    $$\n    The operator $QL$ restricted to the subspace spanned by $\\{y, z\\}$ is equivalent to the matrix operator $\\begin{pmatrix} 0 & \\omega \\\\ -\\omega & 0 \\end{pmatrix}$. The dynamics it generates is a simple harmonic oscillation (rotation in the $y$-$z$ plane):\n    $$\n    \\frac{d}{dt} \\begin{pmatrix} y \\\\ z \\end{pmatrix}_{\\text{ortho}} = \\begin{pmatrix} 0 & \\omega \\\\ -\\omega & 0 \\end{pmatrix} \\begin{pmatrix} y \\\\ z \\end{pmatrix}_{\\text{ortho}}\n    $$\n    The evolution operator $e^{QLt}$ acting on the function $y$ is therefore:\n    $$\n    e^{QLt} y = y \\cos(\\omega t) + z \\sin(\\omega t)\n    $$\n    Now we can compute the full expression inside the memory integral's time-convolution: $PL e^{QLs} (QLx)$.\n    $$\n    PL e^{QLs} (cy) = PL [c(y \\cos(\\omega s) + z \\sin(\\omega s))] = c \\cos(\\omega s) (PLy) + c \\sin(\\omega s) (PLz)\n    $$\n    We need to compute $PLy$ and $PLz$:\n    $$\n    PLy = P(Ly) = P(\\kappa x + \\omega z) = \\kappa (Px) + \\omega (Pz) = \\kappa x\n    $$\n    $$\n    PLz = P(Lz) = P(-\\omega y) = -\\omega (Py) = 0\n    $$\n    Substituting these back, we get:\n    $$\n    PL e^{QLs} QLx = c \\cos(\\omega s) (\\kappa x) + c \\sin(\\omega s) (0) = c\\kappa \\cos(\\omega s) x\n    $$\n    The memory integral term is therefore:\n    $$\n    \\int_0^t ds\\, (c\\kappa \\cos(\\omega s) x)(X(t-s)) = \\int_0^t ds\\, c\\kappa \\cos(\\omega s) x(t-s)\n    $$\n    By a change of variables $\\tau = t-s$, this becomes $\\int_0^t d\\tau\\, c\\kappa \\cos(\\omega(t-\\tau)) x(\\tau)$.\n    Comparing this to the form $\\int_0^t K(t-s) x(s) ds$, we identify the memory kernel as:\n    $$\n    K(t) = c\\kappa \\cos(\\omega t)\n    $$\n\n3.  **Fluctuating Force Term:** The final term is the fluctuating (or projected) force, $F(t) = (e^{QLt} QLx)(X_0)$. This term represents the evolution of the initial state of the fast variables projected onto the slow dynamics.\n    $$\n    F(t) = (e^{QLt} (cy))(X_0) = c(e^{QLt} y)(X_0)\n    $$\n    Using our result for the orthogonal propagator:\n    $$\n    F(t) = c (y(0) \\cos(\\omega t) + z(0) \\sin(\\omega t))\n    $$\n    This term depends only on the initial conditions of the fast subsystem, $y(0)$ and $z(0)$.\n\nCombining all terms, the exact GLE for $x(t)$ is:\n$$\n\\dot{x}(t) = -\\lambda x(t) + \\int_0^t c\\kappa \\cos(\\omega(t-s)) x(s) ds + c(y(0)\\cos(\\omega t) + z(0)\\sin(\\omega t))\n$$\nThis matches the required form with $K(t) = c\\kappa \\cos(\\omega t)$ and $F(t) = c(y(0)\\cos(\\omega t) + z(0)\\sin(\\omega t))$.\n\n### Step 3: Analysis of the Memory Kernel and Homogenization\n\n**Memory Kernel Behavior:**\nThe derived memory kernel is $K(t) = c\\kappa \\cos(\\omega t)$. This function is periodic and does not decay as $t \\to \\infty$. Its amplitude, $|c\\kappa|$, remains constant. This non-decaying memory is a direct consequence of the physics of the fast subsystem. The variables $(y,z)$ constitute an undamped harmonic oscillator. Any influence from the slow variable $x(t)$ (via the $\\kappa x(t)$ term in $\\dot{y}$) transfers energy to this oscillator, which then persists indefinitely, oscillating with frequency $\\omega$. This \"memory\" of past states of $x(t)$ is encoded in the phase and amplitude of the $(y,z)$ oscillator and is fed back into the evolution of $x(t)$ via the $cy(t)$ term. Without any damping mechanism in the fast subsystem, the memory never fades.\n\n**Failure of Naive Homogenization:**\nNaive homogenization techniques are typically employed when there is a clear separation of timescales and the fast variables' correlations decay rapidly. These methods seek a simplified, Markovian description for the slow variable.\nA common approach is to assume the fast subsystem is always in a \"quasi-steady state\" determined by the current value of the slow variable. For the fast dynamics:\n$$\n\\dot{y} = \\kappa x + \\omega z, \\quad \\dot{z} = -\\omega y\n$$\nSetting the time derivatives to zero ($\\dot{y}=0, \\dot{z}=0$) yields $y=0$ and $\\kappa x + \\omega z = 0$. Substituting $y=0$ into the equation for $x$ gives $\\dot{x} = -\\lambda x$. This approximation completely decouples the subsystems and discards the crucial feedback captured by the $c\\kappa$ term. It is fundamentally incorrect because the fast system is oscillatory, not relaxing to a fixed point.\nAnother approach might involve averaging over the fast oscillations. Assuming $y(t)$ oscillates rapidly around zero, one might replace $y(t)$ with its average value, $\\langle y \\rangle = 0$, in the equation for $\\dot{x}$. This again leads to the incorrect equation $\\dot{x} = -\\lambda x$.\nThese methods fail because their core assumption—that the influence of the fast variables can be represented by an instantaneous function of the slow variable (or simply averaged away)—is violated. This assumption is mathematically equivalent to stating that the memory kernel $K(t)$ is proportional to a Dirac delta function, $K(t) \\propto \\delta(t)$. This requires the time integral of the kernel to converge, which in turn requires the kernel to decay sufficiently fast. Our kernel $K(t) = c\\kappa \\cos(\\omega t)$ does not decay at all, and its integral $\\int_0^\\infty K(t) dt$ does not converge.\nThe Mori-Zwanzig formalism, being an exact reformulation, does not make such approximations. It correctly identifies the nature of the memory through the orthogonal propagator $e^{QLt}$. The fact that the generator of orthogonal dynamics $QL$ has purely imaginary eigenvalues $(\\pm i\\omega)$ directly leads to a purely oscillatory, non-decaying propagator and thus a non-decaying memory kernel. The formalism correctly shows that a valid coarse-grained model for this system must be non-Markovian.",
            "answer": "$$\n\\boxed{K(t) = c\\kappa \\cos(\\omega t)}\n$$"
        }
    ]
}