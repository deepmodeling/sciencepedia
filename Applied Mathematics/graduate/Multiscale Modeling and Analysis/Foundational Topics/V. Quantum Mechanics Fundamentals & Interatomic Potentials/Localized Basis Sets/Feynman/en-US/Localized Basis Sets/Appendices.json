{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of any calculation involving localized, non-orthogonal basis sets is the overlap matrix, which defines the metric of the vector space spanned by the basis functions. This exercise provides essential practice in calculating the overlap integral, the fundamental measure of interaction between two basis functions. By deriving the result for two simple Gaussian primitives from first principles, you will gain a core skill required for building the Hamiltonian and overlap matrices in any Gaussian-based quantum chemistry code.",
            "id": "3776054",
            "problem": "In multiscale modeling and analysis of fields on $\\mathbb{R}^3$, localized basis sets built from Gaussian primitives are frequently employed to resolve features across scales. Consider two unnormalized, isotropic Gaussian primitives centered at the origin,\n$$\\phi_{\\alpha}(\\mathbf{r})=\\exp\\!\\big(-\\alpha\\,|\\mathbf{r}|^2\\big),\\qquad \\phi_{\\beta}(\\mathbf{r})=\\exp\\!\\big(-\\beta\\,|\\mathbf{r}|^2\\big),$$\nwith $\\alpha>0$ and $\\beta>0$, where $\\mathbf{r}\\in\\mathbb{R}^3$ and $|\\mathbf{r}|$ denotes the Euclidean norm.\n\nStarting only from well-tested facts about Gaussian integrals in one dimension and basic properties of separability for Cartesian integrals, derive the exact closed-form expression for the overlap integral\n$$S(\\alpha,\\beta)=\\int_{\\mathbb{R}^3}\\phi_{\\alpha}(\\mathbf{r})\\,\\phi_{\\beta}(\\mathbf{r})\\,\\mathrm{d}^3\\mathbf{r}.$$\nThen, explain briefly (in one or two sentences) how the choice of the exponents $\\alpha$ and $\\beta$ controls the degree of spatial localization and overlap in such a localized basis.\n\nProvide your final answer for $S(\\alpha,\\beta)$ as a single closed-form analytic expression in terms of $\\alpha$ and $\\beta$. No rounding is required.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and complete. It presents a standard, verifiable calculation fundamental to computational quantum chemistry and physics, asking for the derivation of the overlap integral between two s-type Gaussian functions centered at the origin. All conditions are clearly specified, and no contradictions or ambiguities are present. Therefore, the problem is valid.\n\nThe overlap integral $S(\\alpha,\\beta)$ is defined as:\n$$S(\\alpha,\\beta)=\\int_{\\mathbb{R}^3}\\phi_{\\alpha}(\\mathbf{r})\\,\\phi_{\\beta}(\\mathbf{r})\\,\\mathrm{d}^3\\mathbf{r}$$\nSubstituting the definitions of the Gaussian primitives $\\phi_{\\alpha}(\\mathbf{r})=\\exp(-\\alpha\\,|\\mathbf{r}|^2)$ and $\\phi_{\\beta}(\\mathbf{r})=\\exp(-\\beta\\,|\\mathbf{r}|^2)$, we have:\n$$S(\\alpha,\\beta)=\\int_{\\mathbb{R}^3} \\exp(-\\alpha\\,|\\mathbf{r}|^2) \\, \\exp(-\\beta\\,|\\mathbf{r}|^2) \\,\\mathrm{d}^3\\mathbf{r}$$\nThe product of two exponential functions is the exponential of the sum of their arguments. Thus, we can combine the exponents:\n$$S(\\alpha,\\beta) = \\int_{\\mathbb{R}^3} \\exp\\big(-(\\alpha + \\beta)|\\mathbf{r}|^2\\big) \\,\\mathrm{d}^3\\mathbf{r}$$\nLet us define a new positive constant $\\gamma = \\alpha + \\beta$, where $\\gamma > 0$ since $\\alpha > 0$ and $\\beta > 0$. The integral becomes:\n$$S(\\alpha,\\beta) = \\int_{\\mathbb{R}^3} \\exp(-\\gamma|\\mathbf{r}|^2) \\,\\mathrm{d}^3\\mathbf{r}$$\nTo solve this three-dimensional integral, we express the position vector $\\mathbf{r}$ and the volume element $\\mathrm{d}^3\\mathbf{r}$ in Cartesian coordinates. Let $\\mathbf{r} = (x, y, z)$, so that its squared Euclidean norm is $|\\mathbf{r}|^2 = x^2 + y^2 + z^2$. The volume element is $\\mathrm{d}^3\\mathbf{r} = \\mathrm{d}x\\,\\mathrm{d}y\\,\\mathrm{d}z$. The integral can be written as:\n$$S(\\alpha,\\beta) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\exp\\big(-\\gamma(x^2+y^2+z^2)\\big) \\,\\mathrm{d}x\\,\\mathrm{d}y\\,\\mathrm{d}z$$\nThe exponential of a sum can be separated into a product of exponentials. This allows for the separation of the multidimensional integral into a product of three one-dimensional integrals:\n$$S(\\alpha,\\beta) = \\int_{-\\infty}^{\\infty} \\exp(-\\gamma x^2) \\,\\mathrm{d}x \\cdot \\int_{-\\infty}^{\\infty} \\exp(-\\gamma y^2) \\,\\mathrm{d}y \\cdot \\int_{-\\infty}^{\\infty} \\exp(-\\gamma z^2) \\,\\mathrm{d}z$$\nThese three integrals are identical in form. Let's evaluate the general one-dimensional Gaussian integral:\n$$I(\\gamma) = \\int_{-\\infty}^{\\infty} \\exp(-\\gamma t^2) \\,\\mathrm{d}t$$\nThis is a standard, well-known integral. The definite integral of a Gaussian function $\\exp(-at^2)$ over the entire real line is given by the formula:\n$$\\int_{-\\infty}^{\\infty} \\exp(-at^2) \\,\\mathrm{d}t = \\sqrt{\\frac{\\pi}{a}} \\quad \\text{for } a > 0$$\nApplying this established result with $a = \\gamma$, we find:\n$$I(\\gamma) = \\sqrt{\\frac{\\pi}{\\gamma}}$$\nSince the three-dimensional integral $S(\\alpha,\\beta)$ is the product of three such one-dimensional integrals, we have:\n$$S(\\alpha,\\beta) = [I(\\gamma)]^3 = \\left(\\sqrt{\\frac{\\pi}{\\gamma}}\\right)^3 = \\left(\\frac{\\pi}{\\gamma}\\right)^{3/2}$$\nFinally, we substitute $\\gamma = \\alpha + \\beta$ back into the expression to obtain the final result in terms of the original parameters:\n$$S(\\alpha,\\beta) = \\left(\\frac{\\pi}{\\alpha + \\beta}\\right)^{3/2}$$\nRegarding the role of the exponents, a larger exponent (e.g., $\\alpha$) causes the Gaussian function $\\phi_{\\alpha}$ to decay more rapidly, resulting in a more spatially contracted or \"localized\" basis function. The overlap integral $S(\\alpha,\\beta)$ decreases as the sum $\\alpha+\\beta$ increases, indicating that more localized (larger $\\alpha$, $\\beta$) or dissimilar functions have smaller spatial overlap.",
            "answer": "$$\\boxed{\\left(\\frac{\\pi}{\\alpha + \\beta}\\right)^{3/2}}$$"
        },
        {
            "introduction": "Once the overlap matrix is constructed, a critical next step is often to transform the non-orthogonal localized basis into an orthonormal one to simplify the generalized eigenvalue problem. This practice explores Löwdin symmetric orthogonalization, a widely used method that treats all basis functions democratically. By deriving the transformation matrix and analyzing its behavior as basis functions become nearly linearly dependent, you will develop a deep understanding of the numerical challenges inherent in using overcomplete or poorly conditioned basis sets .",
            "id": "3776084",
            "problem": "Consider two normalized, localized Gaussian-type basis functions $\\phi_{1}(\\mathbf{r})$ and $\\phi_{2}(\\mathbf{r})$ used to represent a subsystem in a multiscale model. Their overlap matrix $S$ is defined by $S_{ij}=\\langle \\phi_{i}|\\phi_{j}\\rangle$, and for this two-function subsystem takes the symmetric form\n$$\nS=\\begin{pmatrix}\n1 & s \\\\\ns & 1\n\\end{pmatrix},\n$$\nwhere $s\\in(0,1)$ is the real-valued overlap integral $\\langle \\phi_{1}|\\phi_{2}\\rangle$ arising from spatial localization. Assume the basis is linearly independent, so that $S$ is symmetric positive definite (SPD).\n\nStarting from the definition of the overlap matrix and properties of SPD matrices, derive the Löwdin symmetric orthogonalization operator, which is the inverse square root of the overlap matrix, $S^{-1/2}$, and provide it explicitly in closed form as a function of the overlap parameter $s$. Then, analyze the stability of this orthogonalization for ill-conditioned $S$ by characterizing how the conditioning of $S$ influences the conditioning of $S^{-1/2}$ and explaining the behavior as $s\\to 1^{-}$ in terms of amplification of numerical errors and sensitivity of the orthogonalization.\n\nAnswer form requirement: Provide the final explicit closed-form analytic expression for $S^{-1/2}$ in terms of $s$. Do not round; an exact symbolic expression is required.",
            "solution": "The problem requires the derivation of the Löwdin symmetric orthogonalization operator, $S^{-1/2}$, for a given $2 \\times 2$ overlap matrix $S$, and an analysis of its numerical stability.\n\nThe overlap matrix is given as:\n$$\nS = \\begin{pmatrix} 1 & s \\\\ s & 1 \\end{pmatrix}\n$$\nwhere $s \\in (0,1)$ is the overlap integral. The Löwdin orthogonalization matrix $S^{-1/2}$ is a function of the matrix $S$. For a diagonalizable matrix, a function $f(S)$ can be computed using its spectral decomposition $S = U \\Lambda U^T$, where $U$ is the orthogonal matrix of eigenvectors and $\\Lambda$ is the diagonal matrix of eigenvalues. The matrix function is then given by $f(S) = U f(\\Lambda) U^T$. In this case, the function is $f(\\lambda) = \\lambda^{-1/2}$.\n\n**Step 1: Eigenvalue Decomposition of S**\n\nFirst, we find the eigenvalues ($\\lambda$) of $S$ by solving the characteristic equation $\\det(S - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix} 1-\\lambda & s \\\\ s & 1-\\lambda \\end{pmatrix} = (1-\\lambda)^{2} - s^{2} = 0\n$$\nThis gives $1-\\lambda = \\pm s$, so the eigenvalues are:\n$$\n\\lambda_{1} = 1+s\n$$\n$$\n\\lambda_{2} = 1-s\n$$\nSince $s \\in (0,1)$, both eigenvalues are positive, which confirms that $S$ is positive definite as stated.\n\nNext, we find the corresponding normalized eigenvectors.\nFor $\\lambda_{1} = 1+s$, the eigenvector $\\mathbf{v}_{1} = \\begin{pmatrix} x \\\\ y \\end{pmatrix}$ satisfies:\n$$\n(S - (1+s)I)\\mathbf{v}_{1} = \\begin{pmatrix} -s & s \\\\ s & -s \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\nThis leads to $-sx + sy = 0$, or $x = y$. The normalized eigenvector is $\\mathbf{v}_{1} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$.\n\nFor $\\lambda_{2} = 1-s$, the eigenvector $\\mathbf{v}_{2} = \\begin{pmatrix} x \\\\ y \\end{pmatrix}$ satisfies:\n$$\n(S - (1-s)I)\\mathbf{v}_{2} = \\begin{pmatrix} s & s \\\\ s & s \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\nThis leads to $sx + sy = 0$, or $x = -y$. The normalized eigenvector is $\\mathbf{v}_{2} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$.\n\nThe matrix of eigenvectors $U$ and the diagonal matrix of eigenvalues $\\Lambda$ are:\n$$\nU = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix}, \\quad \\Lambda = \\begin{pmatrix} 1+s & 0 \\\\ 0 & 1-s \\end{pmatrix}\n$$\nSince $S$ is real and symmetric, $U$ is an orthogonal matrix, satisfying $U^{-1} = U^T$. In this specific case, $U$ is also symmetric, so $U^T = U$.\n\n**Step 2: Calculation of $S^{-1/2}$**\n\nWe now compute $S^{-1/2} = U \\Lambda^{-1/2} U^T$. The matrix $\\Lambda^{-1/2}$ is obtained by taking the inverse square root of each diagonal element of $\\Lambda$:\n$$\n\\Lambda^{-1/2} = \\begin{pmatrix} (1+s)^{-1/2} & 0 \\\\ 0 & (1-s)^{-1/2} \\end{pmatrix}\n$$\nPerforming the matrix multiplication:\n$$\nS^{-1/2} = U \\Lambda^{-1/2} U^T = \\left( \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix} \\right) \\begin{pmatrix} (1+s)^{-1/2} & 0 \\\\ 0 & (1-s)^{-1/2} \\end{pmatrix} \\left( \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix} \\right)\n$$\n$$\nS^{-1/2} = \\frac{1}{2} \\begin{pmatrix} (1+s)^{-1/2} & (1-s)^{-1/2} \\\\ (1+s)^{-1/2} & -(1-s)^{-1/2} \\end{pmatrix} \\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix}\n$$\n$$\nS^{-1/2} = \\frac{1}{2} \\begin{pmatrix} (1+s)^{-1/2} + (1-s)^{-1/2} & (1+s)^{-1/2} - (1-s)^{-1/2} \\\\ (1+s)^{-1/2} - (1-s)^{-1/2} & (1+s)^{-1/2} + (1-s)^{-1/2} \\end{pmatrix}\n$$\nThis is the explicit closed-form expression for the Löwdin orthogonalization matrix $S^{-1/2}$.\n\n**Step 3: Stability Analysis**\n\nThe stability of the orthogonalization process is related to the conditioning of the matrices involved. The condition number of a symmetric positive definite matrix $A$, denoted $\\kappa(A)$, is the ratio of its largest to its smallest eigenvalue: $\\kappa(A) = \\lambda_{\\max}/\\lambda_{\\min}$.\n\nFor the overlap matrix $S$, the eigenvalues are $\\lambda_{\\max} = 1+s$ and $\\lambda_{\\min} = 1-s$. Its condition number is:\n$$\n\\kappa(S) = \\frac{1+s}{1-s}\n$$\nThe eigenvalues of $S^{-1/2}$ are the inverse square roots of the eigenvalues of $S$. The largest eigenvalue of $S^{-1/2}$ is $(1-s)^{-1/2}$ (from the smallest eigenvalue of $S$) and the smallest is $(1+s)^{-1/2}$ (from the largest eigenvalue of $S$). The condition number of $S^{-1/2}$ is:\n$$\n\\kappa(S^{-1/2}) = \\frac{(1-s)^{-1/2}}{(1+s)^{-1/2}} = \\sqrt{\\frac{1+s}{1-s}}\n$$\nFrom these expressions, we see that $\\kappa(S^{-1/2}) = \\sqrt{\\kappa(S)}$.\n\nWe now analyze the behavior as $s \\to 1^{-}$. This limit corresponds to the basis functions $\\phi_{1}$ and $\\phi_{2}$ becoming nearly linearly dependent.\nAs $s \\to 1^{-}$, the denominator $1-s \\to 0^{+}$, causing the condition numbers to diverge:\n$$\n\\lim_{s\\to 1^{-}} \\kappa(S) = \\infty \\quad\\text{and}\\quad \\lim_{s\\to 1^{-}} \\kappa(S^{-1/2}) = \\infty\n$$\nA large condition number indicates that the problem is ill-conditioned, meaning that small relative errors in the input data can be amplified into large relative errors in the output. Here, any numerical uncertainty in the value of $s$ (e.g., from finite-precision computation of the overlap integral) will be magnified in the calculation of $S^{-1/2}$.\n\nThis instability is also evident from the elements of $S^{-1/2}$. Let the diagonal element be $A$ and the off-diagonal element be $B$. As $s \\to 1^{-}$:\n$$\nA = \\frac{1}{2}\\left((1+s)^{-1/2} + (1-s)^{-1/2}\\right) \\approx \\frac{1}{2}(1-s)^{-1/2} \\to +\\infty\n$$\n$$\nB = \\frac{1}{2}\\left((1+s)^{-1/2} - (1-s)^{-1/2}\\right) \\approx -\\frac{1}{2}(1-s)^{-1/2} \\to -\\infty\n$$\nThe elements of the transformation matrix diverge. The orthogonalization transforms the original basis $\\{\\phi_i\\}$ into an orthonormal basis $\\{\\psi_i\\}$ via $\\psi_i = \\sum_j (S^{-1/2})_{ji} \\phi_j$. For our system:\n$$\n\\psi_1 = A\\phi_1 + B\\phi_2 \\quad \\text{and} \\quad \\psi_2 = B\\phi_1 + A\\phi_2\n$$\nSince $s \\to 1^{-}$, we have $\\phi_1 \\approx \\phi_2$, and $A \\approx -B$. The calculation of the new basis functions involves operations like $A(\\phi_1 - \\phi_2)$. This is a product of a very large number ($A$) and a very small number ($\\phi_1 - \\phi_2$). In floating-point arithmetic, the subtraction of two nearly equal numbers, $\\phi_1$ and $\\phi_2$, leads to a loss of significant figures, an effect known as catastrophic cancellation. The subsequent multiplication by the large coefficient $A$ amplifies this loss of precision, making the resulting vectors $\\psi_1$ and $\\psi_2$ numerically unreliable and highly sensitive to initial errors.\n\nIn conclusion, as the overlap $s$ approaches $1$, the Löwdin orthogonalization becomes numerically unstable due to the ill-conditioning of the $S^{-1/2}$ matrix, which manifests as diverging matrix elements and extreme sensitivity to numerical errors.",
            "answer": "$$\n\\boxed{\\frac{1}{2} \\begin{pmatrix} (1+s)^{-1/2} + (1-s)^{-1/2} & (1+s)^{-1/2} - (1-s)^{-1/2} \\\\ (1+s)^{-1/2} - (1-s)^{-1/2} & (1+s)^{-1/2} + (1-s)^{-1/2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "This final hands-on practice moves from theoretical derivations to a full computational implementation, addressing a crucial artifact of using incomplete localized bases: the Basis Set Superposition Error (BSSE). This error introduces an artificial stabilization in interaction energy calculations, and this exercise guides you through implementing the standard Boys-Bernardi counterpoise correction to quantify and remove it. Successfully completing this coding challenge demonstrates a comprehensive understanding of how to correctly compute molecular interaction energies using localized basis sets .",
            "id": "3776101",
            "problem": "Consider a one-electron Hamiltonian modeled in atomic units, where the electronic kinetic energy operator is $-\\frac{1}{2}\\nabla^2$ and the electron interacts with fixed nuclei by Coulomb attraction $-\\sum_{C} \\frac{Z_C}{\\lVert \\mathbf{r} - \\mathbf{R}_C \\rVert}$, with $Z_C$ the nuclear charge and $\\mathbf{R}_C$ the nuclear position. Use localized Gaussian-type basis functions to approximate the lowest (ground-state) eigenvalue of this Hamiltonian via a variational generalized eigenvalue problem. To focus on basis set effects and ensure an interaction energy definition that is additive across monomers, consider a simplified two-electron model in which two non-interacting electrons of opposite spin occupy the same spatial orbital (so the total electronic energy is twice the lowest one-electron eigenvalue). This approximation removes electron-electron repulsion and correlation to isolate basis set superposition phenomena.\n\nYou must:\n- Construct a localized Gaussian basis consisting of $s$-type primitive Gaussian functions centered on each nucleus. Each basis function is $\\phi_i(\\mathbf{r}) = N(\\alpha_i)\\exp(-\\alpha_i \\lVert \\mathbf{r}-\\mathbf{A}_i\\rVert^2)$, where $\\alpha_i$ is the exponent and $\\mathbf{A}_i$ is the center. The normalization $N(\\alpha_i)$ ensures $\\langle \\phi_i | \\phi_i \\rangle = 1$.\n- Derive and implement from first principles the matrix elements required to form the overlap matrix $S_{ij}=\\langle \\phi_i | \\phi_j \\rangle$ and the one-electron Hamiltonian matrix $H_{ij}=\\langle \\phi_i | -\\frac{1}{2}\\nabla^2 - \\sum_C \\frac{Z_C}{\\lVert \\mathbf{r}-\\mathbf{R}_C\\rVert} | \\phi_j \\rangle$. You must use the Gaussian product theorem and appropriate special functions to obtain closed-form expressions for these integrals. Clearly, $H_{ij}$ comprises the kinetic term and nuclear attraction terms. Your derivation should rely on well-tested results for Gaussian integrals, including the use of the Boys function at order zero.\n- Solve the generalized eigenvalue problem $H\\mathbf{c} = E S \\mathbf{c}$ to obtain the lowest eigenvalue $E_{\\mathrm{AB}}$ for the dimer (both nuclei present). The total electronic energy in the adopted two-electron non-interacting approximation is $E_{\\mathrm{tot}}^{\\mathrm{AB}} = 2 E_{\\mathrm{AB}}$.\n- Quantify Basis Set Superposition Error (BSSE) using the Boys–Bernardi counterpoise correction. Define:\n  - The naive interaction energy as $E_{\\mathrm{int}}^{\\mathrm{naive}} = 2E_{\\mathrm{AB}} - (E_{\\mathrm{A}}^{\\mathrm{A}} + E_{\\mathrm{B}}^{\\mathrm{B}})$, where $E_{\\mathrm{A}}^{\\mathrm{A}}$ is the lowest eigenvalue of the monomer A Hamiltonian computed in the basis containing only the Gaussian centered on A (likewise for B).\n  - The counterpoise-corrected interaction energy as $E_{\\mathrm{int}}^{\\mathrm{CP}} = 2E_{\\mathrm{AB}} - (E_{\\mathrm{A}}^{\\mathrm{AB}} + E_{\\mathrm{B}}^{\\mathrm{AB}})$, where $E_{\\mathrm{A}}^{\\mathrm{AB}}$ is the lowest eigenvalue of the monomer A Hamiltonian computed in the full dimer basis (including the ghost basis function centered on B, but omitting B’s nuclear potential), and $E_{\\mathrm{B}}^{\\mathrm{AB}}$ is defined analogously. Basis Set Superposition Error (BSSE) is then $E_{\\mathrm{int}}^{\\mathrm{naive}} - E_{\\mathrm{int}}^{\\mathrm{CP}}$.\n- All positions must be specified in bohr, exponents in inverse bohr squared, charges as dimensionless atomic numbers, and all energies must be reported in Hartree. Round every reported energy to six decimal places.\n\nYou must implement a single program that computes $E_{\\mathrm{int}}^{\\mathrm{naive}}$ and $E_{\\mathrm{int}}^{\\mathrm{CP}}$ for the following test suite of dimers. Each dimer is collinear along the $x$-axis with nuclei placed at $\\mathbf{R}_{\\mathrm{A}}=(0,0,0)$ and $\\mathbf{R}_{\\mathrm{B}}=(R,0,0)$:\n1. Happy path (homonuclear, balanced basis): $\\alpha_{\\mathrm{A}}=1.0$, $\\alpha_{\\mathrm{B}}=1.0$, $Z_{\\mathrm{A}}=1.0$, $Z_{\\mathrm{B}}=1.0$, $R=1.4$ bohr.\n2. Large separation (edge case for vanishing interaction): $\\alpha_{\\mathrm{A}}=1.0$, $\\alpha_{\\mathrm{B}}=1.0$, $Z_{\\mathrm{A}}=1.0$, $Z_{\\mathrm{B}}=1.0$, $R=6.0$ bohr.\n3. Asymmetric exponents (basis imbalance): $\\alpha_{\\mathrm{A}}=0.5$, $\\alpha_{\\mathrm{B}}=2.0$, $Z_{\\mathrm{A}}=1.0$, $Z_{\\mathrm{B}}=1.0$, $R=2.0$ bohr.\n4. Short separation (near-coalescence boundary): $\\alpha_{\\mathrm{A}}=1.5$, $\\alpha_{\\mathrm{B}}=1.5$, $Z_{\\mathrm{A}}=1.0$, $Z_{\\mathrm{B}}=1.0$, $R=0.2$ bohr.\n5. Asymmetric nuclear charges (heteronuclear): $\\alpha_{\\mathrm{A}}=1.0$, $\\alpha_{\\mathrm{B}}=1.0$, $Z_{\\mathrm{A}}=1.0$, $Z_{\\mathrm{B}}=0.5$, $R=1.5$ bohr.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a two-element list $[E_{\\mathrm{int}}^{\\mathrm{naive}},E_{\\mathrm{int}}^{\\mathrm{CP}}]$ for the corresponding test case, for example, \"[[e1_naive,e1_cp],[e2_naive,e2_cp],...]\". Energies must be in Hartree and rounded to six decimal places.",
            "solution": "The problem is a well-posed exercise in computational quantum chemistry, specifically designed to illustrate the concept and calculation of Basis Set Superposition Error (BSSE). It is scientifically grounded in the principles of quantum mechanics, namely the variational method for approximating the ground-state solution to the time-independent Schrödinger equation. The problem statement is self-contained, providing all necessary definitions, constants, and computational scenarios. The use of a simplified non-interacting two-electron model is an appropriate and clearly stated approximation to isolate the basis set effects from electron correlation effects. The definitions for interaction energies and the counterpoise correction are standard. The problem is therefore deemed valid.\n\nThe core of the problem is to solve the generalized eigenvalue equation $H\\mathbf{c} = E S \\mathbf{c}$ for the lowest eigenvalue $E$. The matrices $S$ and $H$ are constructed in a basis of $s$-type primitive Gaussian functions, $\\phi_i$.\n\nA primitive Gaussian basis function centered at $\\mathbf{A}_i$ with exponent $\\alpha_i$ is given by:\n$$\n\\phi_i(\\mathbf{r}) = N_i \\exp(-\\alpha_i \\lVert \\mathbf{r}-\\mathbf{A}_i\\rVert^2)\n$$\nwhere $N_i$ is the normalization constant. The condition $\\langle \\phi_i | \\phi_i \\rangle = 1$ leads to $N_i = (2\\alpha_i/\\pi)^{3/4}$.\n\nThe Hamiltonian for the one-electron system is:\n$$\n\\hat{H} = -\\frac{1}{2}\\nabla^2 - \\sum_{C} \\frac{Z_C}{\\lVert \\mathbf{r} - \\mathbf{R}_C \\rVert} = \\hat{T} + \\hat{V}_{\\text{ne}}\n$$\nThe matrix elements are $S_{ij} = \\langle \\phi_i | \\phi_j \\rangle$ for the overlap matrix and $H_{ij} = \\langle \\phi_i | \\hat{H} | \\phi_j \\rangle = T_{ij} + V_{ij}$ for the Hamiltonian matrix. To derive closed-form expressions for these integrals, we employ the Gaussian Product Theorem. The product of two $s$-type Gaussians, $\\phi_i$ and $\\phi_j$, is another Gaussian function:\n$$\n\\exp(-\\alpha_i \\lVert \\mathbf{r}-\\mathbf{A}_i\\rVert^2) \\exp(-\\alpha_j \\lVert \\mathbf{r}-\\mathbf{A}_j\\rVert^2) = K_{ij} \\exp(-p \\lVert \\mathbf{r}-\\mathbf{P}\\rVert^2)\n$$\nwhere:\n- $p = \\alpha_i + \\alpha_j$ is the new exponent.\n- $\\mathbf{P} = \\frac{\\alpha_i\\mathbf{A}_i + \\alpha_j\\mathbf{A}_j}{p}$ is the new center.\n- $K_{ij} = \\exp\\left(-\\frac{\\alpha_i\\alpha_j}{p}\\lVert\\mathbf{A}_i - \\mathbf{A}_j\\rVert^2\\right)$ is a prefactor.\n\nUsing this theorem, the required matrix elements can be calculated.\n\n**1. Overlap Matrix Element $S_{ij}$**\nThe overlap integral is given by:\n$$\nS_{ij} = \\langle \\phi_i | \\phi_j \\rangle = N_i N_j \\int \\exp(-\\alpha_i \\lVert \\mathbf{r}-\\mathbf{A}_i\\rVert^2) \\exp(-\\alpha_j \\lVert \\mathbf{r}-\\mathbf{A}_j\\rVert^2) d^3\\mathbf{r}\n$$\nIntegrating the resulting Gaussian gives the standard result:\n$$\nS_{ij} = \\left(\\frac{2\\sqrt{\\alpha_i\\alpha_j}}{\\alpha_i+\\alpha_j}\\right)^{3/2} \\exp\\left(-\\frac{\\alpha_i\\alpha_j}{\\alpha_i+\\alpha_j}\\lVert\\mathbf{A}_i - \\mathbf{A}_j\\rVert^2\\right)\n$$\nNote that for $i=j$, this correctly yields $S_{ii}=1$.\n\n**2. Kinetic Energy Matrix Element $T_{ij}$**\nThe kinetic energy element is $T_{ij} = \\langle \\phi_i | -\\frac{1}{2}\\nabla^2 | \\phi_j \\rangle$. A standard result relates this integral to the overlap integral:\n$$\nT_{ij} = \\frac{\\alpha_i\\alpha_j}{\\alpha_i+\\alpha_j}\\left(3 - \\frac{2\\alpha_i\\alpha_j}{\\alpha_i+\\alpha_j}\\lVert\\mathbf{A}_i - \\mathbf{A}_j\\rVert^2\\right) S_{ij}\n$$\nFor a single function ($i=j$), $\\mathbf{A}_i = \\mathbf{A}_j$, this simplifies to $T_{ii} = \\frac{\\alpha_i^2}{2\\alpha_i}(3) S_{ii} = \\frac{3}{2}\\alpha_i$.\n\n**3. Nuclear Attraction Matrix Element $V_{ij}$**\nThe nuclear attraction element is the sum of attractions to all nuclei $C$:\n$$\nV_{ij} = \\langle \\phi_i | \\sum_C -\\frac{Z_C}{\\lVert \\mathbf{r}-\\mathbf{R}_C\\rVert} | \\phi_j \\rangle = \\sum_C V_{ij}^C\n$$\nThe integral for a single nucleus at $\\mathbf{R}_C$ is:\n$$\nV_{ij}^C = -Z_C N_i N_j \\int \\frac{\\exp(-\\alpha_i \\lVert \\mathbf{r}-\\mathbf{A}_i\\rVert^2) \\exp(-\\alpha_j \\lVert \\mathbf{r}-\\mathbf{A}_j\\rVert^2)}{\\lVert \\mathbf{r}-\\mathbf{R}_C\\rVert} d^3\\mathbf{r}\n$$\nThis integral evaluates to an expression involving the Boys function of order zero, $F_0(t) = \\int_0^1 e^{-tu^2} du$.\n$$\nV_{ij}^C = -Z_C N_i N_j K_{ij} \\frac{2\\pi}{p} F_0(p \\lVert \\mathbf{P}-\\mathbf{R}_C\\rVert^2)\n$$\nThe Boys function can be computed via the error function, $F_0(t) = \\frac{1}{2}\\sqrt{\\frac{\\pi}{t}}\\text{erf}(\\sqrt{t})$ for $t>0$, and using a Taylor series for small $t$ to avoid numerical instability. For $t=0$, $F_0(0)=1$.\n\n**Computational Steps for BSSE**\nFor each test case, five separate energy calculations are performed:\n1.  $E_{\\mathrm{AB}}$: The lowest eigenvalue for the dimer. Basis set is $\\{\\phi_A, \\phi_B\\}$ and nuclei are $\\{A, B\\}$. This requires solving a $2 \\times 2$ generalized eigenvalue problem.\n2.  $E_{\\mathrm{A}}^{\\mathrm{A}}$: The energy of monomer A. Basis set is $\\{\\phi_A\\}$ and nucleus is $\\{A\\}$. This is a $1 \\times 1$ problem, where $E_{\\mathrm{A}}^{\\mathrm{A}} = H_{11}/S_{11} = T_{AA} + V_{AA}^A = \\frac{3}{2}\\alpha_A - 2Z_A\\sqrt{2\\alpha_A/\\pi}$.\n3.  $E_{\\mathrm{B}}^{\\mathrm{B}}$: The energy of monomer B, calculated analogously to $E_{\\mathrm{A}}^{\\mathrm{A}}$.\n4.  $E_{\\mathrm{A}}^{\\mathrm{AB}}$: The energy of monomer A in the dimer basis. Basis is $\\{\\phi_A, \\phi_B\\}$ but only nucleus $A$ is present. The basis function $\\phi_B$ is a \"ghost\" orbital. This is a $2 \\times 2$ problem.\n5.  $E_{\\mathrm{B}}^{\\mathrm{AB}}$: The energy of monomer B in the dimer basis, analogous to the previous step.\n\nFrom these energies, the naive and counterpoise-corrected interaction energies are computed as defined:\n$$\nE_{\\mathrm{int}}^{\\mathrm{naive}} = 2E_{\\mathrm{AB}} - (E_{\\mathrm{A}}^{\\mathrm{A}} + E_{\\mathrm{B}}^{\\mathrm{B}})\n$$\n$$\nE_{\\mathrm{int}}^{\\mathrm{CP}} = 2E_{\\mathrm{AB}} - (E_{\\mathrm{A}}^{\\mathrm{AB}} + E_{\\mathrm{B}}^{\\mathrm{AB}})\n$$\nThe implementation will construct and solve these eigenvalue problems for each case in the test suite.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh\nfrom scipy.special import erf\n\ndef boys_F0(t):\n    \"\"\"\n    Computes the Boys function F_0(t).\n    Uses a Taylor series for small t to avoid numerical instability.\n    F_0(t) = integral(exp(-t*u^2), u=0..1)\n    \"\"\"\n    if t < 1e-8:\n        # Taylor expansion around t=0: 1 - t/3 + t^2/10 - t^3/42 + ...\n        return 1.0 - t / 3.0 + t**2 / 10.0 - t**3 / 42.0\n    else:\n        return 0.5 * np.sqrt(np.pi / t) * erf(np.sqrt(t))\n\ndef calculate_eigenvalue(alphas, centers, nuclei_charges, nuclei_centers):\n    \"\"\"\n    Calculates the lowest eigenvalue of the one-electron Hamiltonian for a given\n    set of Gaussian basis functions and nuclei.\n    \"\"\"\n    n_basis = len(alphas)\n\n    if n_basis == 0:\n        return 0.0\n\n    if n_basis == 1:\n        # 1x1 case, direct calculation\n        alpha = alphas[0]\n        T = 1.5 * alpha\n        V = 0.0\n        if len(nuclei_charges) > 0:\n            Z = nuclei_charges[0]\n            # Assumes the single nucleus is at the center of the single basis function\n            V = -Z * 2.0 * np.sqrt(2.0 * alpha / np.pi)\n        return T + V\n\n    S = np.zeros((n_basis, n_basis))\n    H = np.zeros((n_basis, n_basis))\n\n    for i in range(n_basis):\n        for j in range(i, n_basis):\n            ai, aj = alphas[i], alphas[j]\n            Ai, Aj = centers[i], centers[j]\n\n            p = ai + aj\n            dist_sq_ij = np.sum((Ai - Aj)**2)\n            \n            # Normalization constants and prefactor\n            Ni = (2 * ai / np.pi)**0.75\n            Nj = (2 * aj / np.pi)**0.75\n            Kij = np.exp(-ai * aj / p * dist_sq_ij)\n\n            # Overlap matrix element\n            S[i, j] = Ni * Nj * Kij * (np.pi / p)**1.5\n            \n            # Kinetic energy matrix element\n            Tij = ai * aj / p * (3.0 - 2.0 * ai * aj / p * dist_sq_ij) * S[i, j]\n            \n            # Nuclear attraction matrix element\n            P = (ai * Ai + aj * Aj) / p\n            Vij = 0.0\n            for k in range(len(nuclei_charges)):\n                Zk = nuclei_charges[k]\n                Rk = nuclei_centers[k]\n                dist_sq_PC = np.sum((P - Rk)**2)\n                F0 = boys_F0(p * dist_sq_PC)\n                Vij += -Zk * Ni * Nj * Kij * (2.0 * np.pi / p) * F0\n            \n            H[i, j] = Tij + Vij\n\n            # Symmetrize matrices\n            if i != j:\n                S[j, i] = S[i, j]\n                H[j, i] = H[i, j]\n    \n    evals = eigh(H, S, eigvals_only=True)\n    return evals[0]\n\ndef solve():\n    \"\"\"\n    Main solver function that iterates through test cases and calculates interaction energies.\n    \"\"\"\n    test_cases = [\n        # alpha_A, alpha_B, Z_A, Z_B, R\n        (1.0, 1.0, 1.0, 1.0, 1.4), # Case 1: Happy path\n        (1.0, 1.0, 1.0, 1.0, 6.0), # Case 2: Large separation\n        (0.5, 2.0, 1.0, 1.0, 2.0), # Case 3: Asymmetric exponents\n        (1.5, 1.5, 1.0, 1.0, 0.2), # Case 4: Short separation\n        (1.0, 1.0, 1.0, 0.5, 1.5), # Case 5: Asymmetric charges\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        alpha_A, alpha_B, Z_A, Z_B, R = case\n        \n        R_A = np.array([0.0, 0.0, 0.0])\n        R_B = np.array([R, 0.0, 0.0])\n\n        # 1. Dimer energy E_AB\n        E_AB = calculate_eigenvalue(\n            alphas=[alpha_A, alpha_B],\n            centers=[R_A, R_B],\n            nuclei_charges=[Z_A, Z_B],\n            nuclei_centers=[R_A, R_B]\n        )\n\n        # 2. Monomer A energy E_A^A\n        E_A_A = calculate_eigenvalue(\n            alphas=[alpha_A],\n            centers=[R_A],\n            nuclei_charges=[Z_A],\n            nuclei_centers=[R_A]\n        )\n        \n        # 3. Monomer B energy E_B^B\n        E_B_B = calculate_eigenvalue(\n            alphas=[alpha_B],\n            centers=[R_B],\n            nuclei_charges=[Z_B],\n            nuclei_centers=[R_B]\n        )\n\n        # 4. Monomer A energy in dimer basis E_A^AB\n        E_A_AB = calculate_eigenvalue(\n            alphas=[alpha_A, alpha_B],\n            centers=[R_A, R_B],\n            nuclei_charges=[Z_A],\n            nuclei_centers=[R_A]\n        )\n\n        # 5. Monomer B energy in dimer basis E_B^AB\n        E_B_AB = calculate_eigenvalue(\n            alphas=[alpha_A, alpha_B],\n            centers=[R_A, R_B],\n            nuclei_charges=[Z_B],\n            nuclei_centers=[R_B]\n        )\n        \n        # Calculate interaction energies\n        E_int_naive = 2.0 * E_AB - (E_A_A + E_B_B)\n        E_int_cp = 2.0 * E_AB - (E_A_AB + E_B_AB)\n        \n        # Format results\n        result_pair = [round(E_int_naive, 6), round(E_int_cp, 6)]\n        all_results.append(str(result_pair))\n        \n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```"
        }
    ]
}