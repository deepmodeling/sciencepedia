{
    "hands_on_practices": [
        {
            "introduction": "The heart of the Hartree-Fock method is the Fock matrix, $F$, which represents the effective one-electron Hamiltonian. Before we can implement the full self-consistent cycle, it is crucial to understand how this matrix is constructed from its fundamental components: the core Hamiltonian and the two-electron integrals, weighted by the electron density. This exercise  provides a foundational, hands-on derivation for an off-diagonal element of $F$, reinforcing your grasp of the Coulomb and exchange terms and the importance of integral symmetries.",
            "id": "531507",
            "problem": "This problem deals with the construction of the Fock matrix, a central quantity in the Hartree-Fock (HF) self-consistent field (SCF) method for approximating the electronic structure of atoms and molecules. Consider the $\\text{HeH}^+$ molecular cation, a two-electron system. We will work within a minimal basis set consisting of two real-valued, normalized atomic basis functions: $\\chi_1$ centered on the Helium nucleus and $\\chi_2$ centered on the Hydrogen nucleus.\n\nIn the Restricted Hartree-Fock (RHF) framework for a closed-shell system, the elements of the Fock matrix $F$ in the atomic orbital basis are given by:\n$$\nF_{\\mu\\nu} = H_{\\mu\\nu}^{\\text{core}} + G_{\\mu\\nu} = H_{\\mu\\nu}^{\\text{core}} + \\sum_{\\lambda,\\sigma} P_{\\lambda\\sigma} \\left[ (\\mu\\nu|\\lambda\\sigma) - \\frac{1}{2}(\\mu\\lambda|\\nu\\sigma) \\right]\n$$\nHere, $H_{\\mu\\nu}^{\\text{core}}$ are the core Hamiltonian matrix elements, representing the kinetic energy and electron-nuclear attraction. $P_{\\lambda\\sigma}$ are the elements of the density matrix from the previous SCF iteration. The two-electron repulsion integrals are given in chemist's notation as:\n$$\n(\\mu\\nu|\\lambda\\sigma) = \\iint \\chi_\\mu^*(r_1)\\chi_\\nu(r_1) \\frac{1}{|\\mathbf{r}_1 - \\mathbf{r}_2|} \\chi_\\lambda^*(r_2)\\chi_\\sigma(r_2) d^3r_1 d^3r_2\n$$\n\nYou are given the following symbolic values for the necessary matrix elements and integrals:\n- The off-diagonal core Hamiltonian element: $H_{12}^{\\text{core}} = h$\n- The unique elements of the symmetric density matrix from the prior SCF iteration: $P_{11} = p_{11}$, $P_{12} = p_{12}$, $P_{22} = p_{22}$\n- The necessary unique two-electron integrals:\n    - $(11|22) = I_C$\n    - $(12|11) = I_{H1}$\n    - $(12|22) = I_{H2}$\n    - $(12|12) = I_X$\n\nYour task is to calculate the off-diagonal Fock matrix element $F_{12}$. Express your answer as a single closed-form analytic expression in terms of the provided symbolic quantities $h, p_{11}, p_{12}, p_{22}, I_C, I_{H1}, I_{H2}, I_X$. You will need to use the permutational symmetries of the two-electron integrals for real basis functions.",
            "solution": "The problem asks for the off-diagonal Fock matrix element $F_{12}$. We start with the given general expression for an RHF Fock matrix element:\n$$\nF_{\\mu\\nu} = H_{\\mu\\nu}^{\\text{core}} + \\sum_{\\lambda,\\sigma} P_{\\lambda\\sigma} \\left[ (\\mu\\nu|\\lambda\\sigma) - \\frac{1}{2}(\\mu\\lambda|\\nu\\sigma) \\right]\n$$\nTo find $F_{12}$, we set $\\mu=1$ and $\\nu=2$. The basis functions $\\chi_1$ and $\\chi_2$ are real, which implies the density matrix is symmetric, $P_{12} = P_{21}$.\n$$\nF_{12} = H_{12}^{\\text{core}} + \\sum_{\\lambda=1,2} \\sum_{\\sigma=1,2} P_{\\lambda\\sigma} \\left[ (12|\\lambda\\sigma) - \\frac{1}{2}(1\\lambda|2\\sigma) \\right]\n$$\nLet's expand the summation over the four pairs of indices $(\\lambda, \\sigma)$:\n\n1.  Term for $(\\lambda, \\sigma) = (1, 1)$:\n    $$\n    T_1 = P_{11} \\left[ (12|11) - \\frac{1}{2}(11|21) \\right]\n    $$\n2.  Term for $(\\lambda, \\sigma) = (1, 2)$:\n    $$\n    T_2 = P_{12} \\left[ (12|12) - \\frac{1}{2}(11|22) \\right]\n    $$\n3.  Term for $(\\lambda, \\sigma) = (2, 1)$:\n    $$\n    T_3 = P_{21} \\left[ (12|21) - \\frac{1}{2}(12|21) \\right] = P_{12} \\left[ \\frac{1}{2}(12|21) \\right]\n    $$\n4.  Term for $(\\lambda, \\sigma) = (2, 2)$:\n    $$\n    T_4 = P_{22} \\left[ (12|22) - \\frac{1}{2}(12|22) \\right] = P_{22} \\left[ \\frac{1}{2}(12|22) \\right]\n    $$\n\nNow, we must simplify the two-electron integrals using their permutational symmetries for real orbitals. The key symmetries are:\n- $(\\mu\\nu|\\lambda\\sigma) = (\\nu\\mu|\\lambda\\sigma)$: Swapping indices within the first pair.\n- $(\\mu\\nu|\\lambda\\sigma) = (\\mu\\nu|\\sigma\\lambda)$: Swapping indices within the second pair.\n- $(\\mu\\nu|\\lambda\\sigma) = (\\lambda\\sigma|\\mu\\nu)$: Swapping the two pairs.\n\nLet's analyze the integrals in our terms:\n- For $T_1$, we have $(12|11)$ and $(11|21)$. By swapping the electron coordinates $r_1 \\leftrightarrow r_2$, we have $(\\mu\\nu|\\lambda\\sigma) = (\\lambda\\sigma|\\mu\\nu)$. Thus, $(11|21) = (21|11)$. By swapping indices within the first pair, $(21|11) = (12|11)$. So, $(11|21) = (12|11)$.\n    $$\n    T_1 = P_{11} \\left[ (12|11) - \\frac{1}{2}(12|11) \\right] = \\frac{1}{2} P_{11} (12|11)\n    $$\n- For $T_2$, the integrals are $(12|12)$ and $(11|22)$. These are generally different and correspond to unique types of interactions ($I_X$ and $I_C$). This term does not simplify further.\n    $$\n    T_2 = P_{12} \\left[ (12|12) - \\frac{1}{2}(11|22) \\right]\n    $$\n- For $T_3$, we have the integral $(12|21)$. Since the basis functions are real, $\\chi_1(r)\\chi_2(r) = \\chi_2(r)\\chi_1(r)$.\n    $(12|21) = \\iint \\chi_1(r_1)\\chi_2(r_1) \\frac{1}{r_{12}} \\chi_2(r_2)\\chi_1(r_2) d^3r_1 d^3r_2 = \\iint \\chi_1(r_1)\\chi_2(r_1) \\frac{1}{r_{12}} \\chi_1(r_2)\\chi_2(r_2) d^3r_1 d^3r_2 = (12|12)$.\n    $$\n    T_3 = \\frac{1}{2} P_{12} (12|12)\n    $$\n- For $T_4$, the integral is $(12|22)$. This is already in the list of unique integrals provided.\n    $$\n    T_4 = \\frac{1}{2} P_{22} (12|22)\n    $$\n\nNow, we sum these four terms to get the two-electron contribution to $F_{12}$, which we denote as $G_{12}$:\n$$\nG_{12} = T_1 + T_2 + T_3 + T_4\n$$\n$$\nG_{12} = \\frac{1}{2} P_{11} (12|11) + P_{12} \\left[ (12|12) - \\frac{1}{2}(11|22) \\right] + \\frac{1}{2} P_{12} (12|12) + \\frac{1}{2} P_{22} (12|22)\n$$\nLet's group the terms by the density matrix elements:\n$$\nG_{12} = \\frac{1}{2} P_{11} (12|11) + \\left( P_{12}(12|12) + \\frac{1}{2}P_{12}(12|12) \\right) - \\frac{1}{2}P_{12}(11|22) + \\frac{1}{2}P_{22}(12|22)\n$$\n$$\nG_{12} = \\frac{1}{2} P_{11} (12|11) + \\frac{3}{2} P_{12} (12|12) - \\frac{1}{2} P_{12} (11|22) + \\frac{1}{2} P_{22} (12|22)\n$$\nFinally, we add the core Hamiltonian contribution $H_{12}^{\\text{core}}$ to obtain $F_{12}$:\n$$\nF_{12} = H_{12}^{\\text{core}} + G_{12} = H_{12}^{\\text{core}} + \\frac{1}{2} P_{11} (12|11) + \\frac{3}{2} P_{12} (12|12) - \\frac{1}{2} P_{12} (11|22) + \\frac{1}{2} P_{22} (12|22)\n$$\nNow, substitute the provided symbolic names for the matrix elements and integrals:\n- $H_{12}^{\\text{core}} = h$\n- $P_{11} = p_{11}$, $P_{12} = p_{12}$, $P_{22} = p_{22}$\n- $(11|22) = I_C$\n- $(12|11) = I_{H1}$\n- $(12|22) = I_{H2}$\n- $(12|12) = I_X$\nThe final expression for $F_{12}$ becomes:\n$$\nF_{12} = h + \\frac{1}{2} p_{11} I_{H1} + \\frac{3}{2} p_{12} I_X - \\frac{1}{2} p_{12} I_C + \\frac{1}{2} p_{22} I_{H2}\n$$",
            "answer": "$$ \\boxed{h + \\frac{1}{2} p_{11} I_{H1} - \\frac{1}{2} p_{12} I_C + \\frac{3}{2} p_{12} I_X + \\frac{1}{2} p_{22} I_{H2}} $$"
        },
        {
            "introduction": "The Fock matrix depends on the molecular orbitals, which are themselves found by diagonalizing the Fock matrix. This circular dependence necessitates an iterative self-consistent field (SCF) procedure. This practice  moves from theory to computation, guiding you to implement a complete RHF-SCF algorithm for a model system. By doing so, you will not only see the iterative process in action but also learn to compute important physical quantities like the ionization potential, comparing the approximation of Koopmans' theorem to the more rigorous $\\Delta$SCF approach.",
            "id": "3766866",
            "problem": "Consider a closed-shell Restricted Hartree-Fock (RHF) treatment of a two-orbital molecular model within the Born-Oppenheimer approximation, using an orthonormal basis with two spatial basis functions. Let the one-electron Hamiltonian matrix be $h \\in \\mathbb{R}^{2 \\times 2}$ with elements $h_{\\mu\\nu}$, and let the two-electron repulsion integrals be given in chemist’s notation as $(\\mu\\nu|\\lambda\\sigma)$ for $\\mu,\\nu,\\lambda,\\sigma \\in \\{0,1\\}$. Assume real-valued basis functions and neglect overlap beyond orthonormality. Use the variational principle with a single-determinant ansatz to construct the RHF self-consistent field and compute the orbital energies. The electron count for the neutral system is $N=2$ (closed shell, one doubly occupied molecular orbital). Define the ionization potential predicted by Koopmans’ theorem as $I_{\\mathrm{K}} = -\\varepsilon_{\\mathrm{HOMO}}$, where $\\varepsilon_{\\mathrm{HOMO}}$ is the RHF eigenvalue of the highest occupied molecular orbital of the neutral system. Define the $\\Delta$ Self-Consistent Field ($\\Delta$SCF) ionization potential as $I_{\\Delta} = E(N-1) - E(N)$, where $E(N)$ is the converged RHF total energy of the neutral system and $E(N-1)$ is the total energy of the cation with one electron removed, treated as a one-electron problem (thus having no electron-electron contributions). Use electronvolts as the unit for all energies and report all outputs in electronvolts.\n\nStarting from the fundamental variational formulation for Hartree-Fock, implement the RHF procedure for the neutral system as follows:\n- The spin-summed density matrix is $P_{\\mu\\nu} = 2 \\sum_{i \\in \\mathrm{occ}} C_{\\mu i} C_{\\nu i}$ with one doubly occupied orbital. The Fock matrix is $F_{\\mu\\nu} = h_{\\mu\\nu} + \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma} \\left[ (\\mu\\nu|\\lambda\\sigma) - \\tfrac{1}{2} (\\mu\\sigma|\\lambda\\nu) \\right]$. The molecular orbitals are obtained by diagonalizing $F$; the occupied orbital coefficients define $P$.\n- The RHF total energy of the neutral system is $E(N) = \\sum_{\\mu\\nu} P_{\\mu\\nu} h_{\\mu\\nu} + \\tfrac{1}{2} \\sum_{\\mu\\nu\\lambda\\sigma} P_{\\mu\\nu} P_{\\lambda\\sigma} \\left[ (\\mu\\nu|\\lambda\\sigma) - \\tfrac{1}{2} (\\mu\\sigma|\\lambda\\nu) \\right]$.\n- The cation with $N-1=1$ electron has total energy $E(N-1)$ equal to the lowest eigenvalue of $h$, since there is no electron-electron term.\n\nFor each test case, compute $I_{\\mathrm{K}}$, $I_{\\Delta}$, and the relaxation error defined as $\\delta I = I_{\\mathrm{K}} - I_{\\Delta}$. Use self-consistent iteration with sensible damping to ensure convergence for the neutral system. Angles do not appear in this problem. The final output format is a single line containing a list of results for all test cases, where each result is a triple $[I_{\\mathrm{K}}, I_{\\Delta}, \\delta I]$ in electronvolts. The program should produce exactly one line, in the form \"[[IK1,ID1,dI1],[IK2,ID2,dI2],...]\" with all values as Python floats.\n\nTest suite (all energies in electronvolts):\n- Case 1 (moderate interaction, typical bound case):\n  $$h = \\begin{bmatrix} -20.0 & -1.0 \\\\ -1.0 & -15.0 \\end{bmatrix},$$\n  - $(00|00) = 12.0$, $(11|11) = 10.0$, $(00|11) = (11|00) = 8.0$, $(01|01) = (10|10) = (01|10) = (10|01) = 2.0$, all other $(\\mu\\nu|\\lambda\\sigma) = 0$.\n- Case 2 (non-interacting limit):\n  $$h = \\begin{bmatrix} -18.0 & -0.5 \\\\ -0.5 & -14.0 \\end{bmatrix},$$\n  - All $(\\mu\\nu|\\lambda\\sigma) = 0$.\n- Case 3 (near-degenerate one-electron spectrum with stronger repulsion):\n  $$h = \\begin{bmatrix} -25.0 & -0.2 \\\\ -0.2 & -24.8 \\end{bmatrix},$$\n  - $(00|00) = 15.0$, $(11|11) = 14.5$, $(00|11) = (11|00) = 12.0$, $(01|01) = (10|10) = (01|10) = (10|01) = 3.0$, all other $(\\mu\\nu|\\lambda\\sigma) = 0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the triple for one test case (e.g., \"[[IK1,ID1,dI1],[IK2,ID2,dI2],[IK3,ID3,dI3]]\"). Express all energies in electronvolts as floats.",
            "solution": "The problem is validated as scientifically sound, well-posed, and complete. All provided information is consistent with the standard formulation of the Restricted Hartree-Fock (RHF) method in quantum chemistry. The task is to implement this method for a two-electron, two-orbital model system and compute specific energy-related quantities.\n\nThe core of the problem lies in solving the RHF equations iteratively through a Self-Consistent Field (SCF) procedure. For a system described by a set of $K$ orthonormal basis functions $\\{\\phi_{\\mu}\\}_{\\mu=0}^{K-1}$, the RHF equations in the absence of overlap take the form of a matrix eigenvalue problem:\n$$\nFC = C\\epsilon\n$$\nHere, $F$ is the Fock matrix, $C$ is the matrix of molecular orbital (MO) coefficients, and $\\epsilon$ is a diagonal matrix of orbital energies. For the given two-orbital model, all matrices are $2 \\times 2$.\n\nThe Fock matrix $F$ is the effective one-electron Hamiltonian, accounting for the kinetic energy of an electron, its attraction to the nuclei, and its average repulsion from the other electrons. Its elements are given by:\n$$\nF_{\\mu\\nu} = h_{\\mu\\nu} + G_{\\mu\\nu} = h_{\\mu\\nu} + \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma} \\left[ (\\mu\\nu|\\lambda\\sigma) - \\frac{1}{2} (\\mu\\sigma|\\lambda\\nu) \\right]\n$$\nwhere $h_{\\mu\\nu}$ are the elements of the one-electron Hamiltonian matrix (kinetic and nuclear attraction energy), and $G_{\\mu\\nu}$ is the two-electron part, composed of Coulomb and exchange terms. The quantities $(\\mu\\nu|\\lambda\\sigma)$ are the two-electron repulsion integrals.\n\nThe electron density is represented by the density matrix $P$. For a closed-shell system of $N=2$ electrons, there is one doubly occupied molecular orbital. If this occupied MO has coefficients $C_0 = (C_{00}, C_{10})^T$, the density matrix elements are:\n$$\nP_{\\mu\\nu} = 2 C_{\\mu 0} C_{\\nu 0}\n$$\nThe Fock matrix depends on the density matrix, which in turn is constructed from the eigenvectors of the Fock matrix. This circular dependence requires an iterative SCF solution:\n1.  An initial guess is made for the density matrix $P^{(0)}$. A standard approach is to diagonalize the core Hamiltonian $h$ and use its lowest-energy eigenvector to construct $P^{(0)}$.\n2.  In each iteration $k$, the Fock matrix $F^{(k)}$ is constructed using the current density matrix $P^{(k-1)}$.\n3.  The eigenvalue problem $F^{(k)} C^{(k)} = C^{(k)} \\epsilon^{(k)}$ is solved.\n4.  A new density matrix, $P^{(\\text{new})}$, is constructed from the eigenvector corresponding to the lowest orbital energy (the new occupied MO).\n5.  To improve convergence stability, the density matrix for the next iteration is formed by mixing the old and new matrices: $P^{(k)} = \\alpha P^{(\\text{new})} + (1-\\alpha)P^{(k-1)}$, where $\\alpha \\in (0,1]$ is a damping factor.\n6.  This process is repeated until the difference between successive density matrices is smaller than a given convergence threshold.\n\nOnce the SCF procedure has converged, the final quantities are calculated:\n-   **Total RHF Energy ($E(N)$)**: The total electronic energy of the neutral $N=2$ electron system is computed using the converged density matrix $P$ and Fock matrix $F$:\n    $$\n    E(N) = \\frac{1}{2} \\sum_{\\mu\\nu} P_{\\mu\\nu} (h_{\\mu\\nu} + F_{\\mu\\nu})\n    $$\n-   **Koopmans' Ionization Potential ($I_{\\mathrm{K}}$)**: Koopmans' theorem states that the ionization potential can be approximated as the negative of the HOMO energy. For this system, the HOMO is the single occupied orbital, which has the lowest energy, $\\varepsilon_{\\mathrm{HOMO}}$.\n    $$\n    I_{\\mathrm{K}} = -\\varepsilon_{\\mathrm{HOMO}}\n    $$\n-   **$\\Delta$SCF Ionization Potential ($I_{\\Delta}$)**: This method calculates the ionization potential as the direct difference between the total energy of the cation ($N-1=1$ electron) and the neutral system ($N=2$ electrons).\n    $$\n    I_{\\Delta} = E(N-1) - E(N)\n    $$\n    The energy of the one-electron cation, $E(N-1)$, has no electron-electron repulsion and is simply the lowest eigenvalue of the core Hamiltonian matrix $h$.\n-   **Relaxation Error ($\\delta I$)**: The difference between the two ionization potential estimates, $\\delta I = I_{\\mathrm{K}} - I_{\\Delta}$, is the relaxation error. It represents the energy lowering in the cation due to the contraction (relaxation) of the remaining electron's orbital, an effect which is neglected in Koopmans' theorem.\n\nThe following implementation applies this procedure to the three test cases provided. The two-electron integrals are stored in a rank-$4$ tensor, and matrix operations are handled using NumPy.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the RHF calculations for all test cases and print the results.\n    \"\"\"\n    # Define test cases as specified in the problem statement.\n    test_cases = [\n        # Case 1: Moderate interaction, typical bound case\n        {\n            \"h\": np.array([[-20.0, -1.0], [-1.0, -15.0]]),\n            \"V_dict\": {\n                (0, 0, 0, 0): 12.0, (1, 1, 1, 1): 10.0,\n                (0, 0, 1, 1): 8.0, (1, 1, 0, 0): 8.0,\n                (0, 1, 0, 1): 2.0, (1, 0, 1, 0): 2.0,\n                (0, 1, 1, 0): 2.0, (1, 0, 0, 1): 2.0,\n            }\n        },\n        # Case 2: Non-interacting limit\n        {\n            \"h\": np.array([[-18.0, -0.5], [-0.5, -14.0]]),\n            \"V_dict\": {}\n        },\n        # Case 3: Near-degenerate one-electron spectrum with stronger repulsion\n        {\n            \"h\": np.array([[-25.0, -0.2], [-0.2, -24.8]]),\n            \"V_dict\": {\n                (0, 0, 0, 0): 15.0, (1, 1, 1, 1): 14.5,\n                (0, 0, 1, 1): 12.0, (1, 1, 0, 0): 12.0,\n                (0, 1, 0, 1): 3.0, (1, 0, 1, 0): 3.0,\n                (0, 1, 1, 0): 3.0, (1, 0, 0, 1): 3.0,\n            }\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        h = case[\"h\"]\n        V_dict = case[\"V_dict\"]\n        \n        # Build the four-dimensional two-electron integral tensor V.\n        n_basis = h.shape[0]\n        V = np.zeros((n_basis, n_basis, n_basis, n_basis))\n        if V_dict:\n            for key, value in V_dict.items():\n                V[key] = value\n\n        # Solve the RHF equations for the current case.\n        result_tuple = run_rhf_scf(h, V)\n        results.append(list(result_tuple))\n\n    # Print the final results in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\n\ndef run_rhf_scf(h, V, N=2, max_iter=100, conv_thresh=1e-10, damping=0.5):\n    \"\"\"\n    Solves the RHF equations using a self-consistent field (SCF) procedure.\n    \n    Args:\n        h (np.ndarray): The one-electron Hamiltonian matrix.\n        V (np.ndarray): The two-electron repulsion integral tensor.\n        N (int): The number of electrons (must be even for RHF).\n        max_iter (int): Maximum number of SCF iterations.\n        conv_thresh (float): Convergence threshold for the density matrix.\n        damping (float): Damping factor for mixing density matrices.\n\n    Returns:\n        tuple: A tuple containing (I_K, I_Delta, delta_I).\n    \"\"\"\n    n_basis = h.shape[0]\n    num_occ_orbitals = N // 2\n    \n    # Initial guess for density matrix P from the core Hamiltonian h.\n    _, C = np.linalg.eigh(h)\n    P = np.zeros_like(h, dtype=float)\n    for i in range(num_occ_orbitals):\n        C_occ = C[:, i]\n        P += 2.0 * np.outer(C_occ, C_occ)\n\n    # SCF iteration loop.\n    for i in range(max_iter):\n        P_old = P\n\n        # Build the Fock matrix F = h + G(P).\n        J = np.einsum('ls,mnls->mn', P, V, optimize=True) # Coulomb term\n        K = np.einsum('ls,mlsn->mn', P, V, optimize=True) # Exchange term\n        F = h + J - 0.5 * K\n\n        # Solve the eigenvalue problem FC = C*epsilon.\n        eps, C = np.linalg.eigh(F)\n        \n        # Form new density matrix from the occupied orbitals.\n        P_new = np.zeros_like(h, dtype=float)\n        for j in range(num_occ_orbitals):\n            C_occ = C[:, j]\n            P_new += 2.0 * np.outer(C_occ, C_occ)\n\n        # Apply damping to stabilize convergence.\n        P = damping * P_new + (1.0 - damping) * P_old\n\n        # Check for convergence based on the change in the density matrix.\n        delta = np.max(np.abs(P - P_old))\n        if delta < conv_thresh:\n            break\n            \n    # After convergence, calculate final properties with the converged density.\n    J = np.einsum('ls,mnls->mn', P, V, optimize=True)\n    K = np.einsum('ls,mlsn->mn', P, V, optimize=True)\n    F = h + J - 0.5 * K\n    eps, _ = np.linalg.eigh(F)\n\n    # RHF total energy for the neutral system (N electrons).\n    E_N = 0.5 * np.sum(P * (h + F))\n\n    # Koopmans' theorem ionization potential (I_K) from HOMO energy.\n    eps_homo = eps[num_occ_orbitals - 1]\n    I_K = -eps_homo\n\n    # Delta SCF ionization potential (I_Delta).\n    # Energy of the cation (N-1=1 electron) is the lowest eigenvalue of h.\n    e_h, _ = np.linalg.eigh(h)\n    E_N_minus_1 = e_h[0]\n    I_Delta = E_N_minus_1 - E_N\n\n    # Relaxation error.\n    delta_I = I_K - I_Delta\n\n    return I_K, I_Delta, delta_I\n\nsolve()\n```"
        },
        {
            "introduction": "While powerful, the Restricted Hartree-Fock (RHF) method, which assumes electrons of opposite spin share the same spatial orbital, has notable failures. A classic example is the incorrect description of bond dissociation. This exercise  uses a two-site Hubbard model to demonstrate this limitation and introduces the Unrestricted Hartree-Fock (UHF) method as a solution. By comparing RHF and UHF results as a bond is 'stretched', you will gain a deep, practical understanding of symmetry breaking and its crucial role in obtaining a qualitatively correct description of chemical processes.",
            "id": "3766854",
            "problem": "Consider a two-site, two-electron model that serves as a coarse-grained, physically motivated representation of the bond dissociation of a diatomic molecule within the Hartree-Fock self-consistent field framework. The model is the two-site Hubbard Hamiltonian written in second quantization for spin-$\\alpha$ and spin-$\\beta$ electrons:\n$$\n\\hat{H}(R) \\;=\\; -\\,t(R)\\sum_{\\sigma\\in\\{\\alpha,\\beta\\}}\\left(\\hat{a}_{A\\sigma}^\\dagger\\hat{a}_{B\\sigma} + \\hat{a}_{B\\sigma}^\\dagger\\hat{a}_{A\\sigma}\\right) \\;+\\; U\\,\\sum_{i\\in\\{A,B\\}}\\hat{n}_{i\\alpha}\\,\\hat{n}_{i\\beta},\n$$\nwhere $R$ is the internuclear separation, $t(R)$ is a distance-dependent nearest-neighbor hopping (kinetic) parameter, $U$ is an on-site Coulomb repulsion parameter, $\\hat{a}_{i\\sigma}^\\dagger$ and $\\hat{a}_{i\\sigma}$ are fermionic creation and annihilation operators at site $i\\in\\{A,B\\}$ with spin $\\sigma\\in\\{\\alpha,\\beta\\}$, and $\\hat{n}_{i\\sigma}=\\hat{a}_{i\\sigma}^\\dagger\\hat{a}_{i\\sigma}$ is the number operator. For the two-electron case ($1$ spin-$\\alpha$ electron and $1$ spin-$\\beta$ electron), adopt the Hartree-Fock mean-field decoupling of the interaction term, which yields a spin-resolved $2\\times 2$ Fock matrix for each spin channel $\\sigma$ in the site basis $\\{|A\\rangle,|B\\rangle\\}$:\n$$\nF^{(\\sigma)}(R) \\;=\\; \\begin{pmatrix}\nU\\,n_{A,-\\sigma} & -\\,t(R) \\\\\n-\\,t(R) & U\\,n_{B,-\\sigma}\n\\end{pmatrix},\n$$\nwhere $n_{i,\\sigma}$ is the mean-field site occupation for spin $\\sigma$, and $-\\sigma$ denotes the opposite spin channel.\n\nDefine the one-body kinetic operator matrix\n$$\nh(R) \\;=\\; \\begin{pmatrix}\n0 & -\\,t(R)\\\\\n-\\,t(R) & 0\n\\end{pmatrix}.\n$$\nIn a self-consistent field iteration, the occupied spin-$\\sigma$ orbital $|\\phi_\\sigma\\rangle$ is the normalized eigenvector corresponding to the lowest eigenvalue of $F^{(\\sigma)}(R)$, with site amplitudes $\\big(c_{A,\\sigma},\\,c_{B,\\sigma}\\big)$, so that the site densities follow from $n_{A,\\sigma} = |c_{A,\\sigma}|^2$ and $n_{B,\\sigma} = |c_{B,\\sigma}|^2$. The total Hartree-Fock energy for a given set of mean-field densities is\n$$\nE_{\\mathrm{HF}}(R) \\;=\\; \\sum_{\\sigma\\in\\{\\alpha,\\beta\\}} \\langle \\phi_\\sigma | h(R) | \\phi_\\sigma \\rangle \\;+\\; U \\sum_{i\\in\\{A,B\\}} n_{i,\\alpha}\\,n_{i,\\beta}.\n$$\nImplement two variants:\n- Restricted Hartree-Fock (RHF): enforce $n_{i,\\alpha} = n_{i,\\beta}$ for each site $i$ at all self-consistent iterations.\n- Unrestricted Hartree-Fock (UHF): allow $n_{i,\\alpha}$ and $n_{i,\\beta}$ to differ, permitting spin and spatial symmetry breaking if it lowers the energy.\n\nStarting from the fundamental Hamiltonian and mean-field construction above, design and implement a robust self-consistent algorithm that converges the densities for both RHF and UHF, then computes the final total energies, the occupied orbital energies (lowest eigenvalues of $F^{(\\alpha)}(R)$ and $F^{(\\beta)}(R)$), and the spin magnetizations at each site\n$$\nm_A \\;=\\; n_{A,\\alpha} - n_{A,\\beta}, \\quad m_B \\;=\\; n_{B,\\alpha} - n_{B,\\beta}.\n$$\n\nUse the following scientifically plausible parameters and distance-dependent kinetic coupling:\n- On-site Coulomb repulsion: $U = 6.0\\,\\mathrm{eV}$.\n- Hopping prefactor: $t_0 = 8.0\\,\\mathrm{eV}$.\n- Exponential decay rate: $a = 1.0\\,\\mathrm{\\AA}^{-1}$.\n- Distance dependence: $t(R) = t_0\\,\\exp\\!\\big(-a\\,R\\big)$.\n\nConstruct a numerical test suite consisting of the following internuclear separations:\n- $R = 0.5\\,\\mathrm{\\AA}$ (short bond, kinetic term dominant),\n- $R = 0.8\\,\\mathrm{\\AA}$ (moderately short bond),\n- $R = 1.2\\,\\mathrm{\\AA}$ (near the onset of symmetry breaking),\n- $R = 2.0\\,\\mathrm{\\AA}$ (stretched bond),\n- $R = 3.0\\,\\mathrm{\\AA}$ (dissociated limit).\n\nFor each $R$ in the test suite:\n- Perform RHF and UHF self-consistent field calculations as specified.\n- Report the RHF total energy $E_{\\mathrm{RHF}}(R)$ in $\\mathrm{eV}$, the UHF total energy $E_{\\mathrm{UHF}}(R)$ in $\\mathrm{eV}$, the site magnetizations $m_A$ and $m_B$ (dimensionless), and the occupied orbital energies $\\varepsilon_{\\alpha}(R)$ and $\\varepsilon_{\\beta}(R)$ (the lowest eigenvalues of $F^{(\\alpha)}(R)$ and $F^{(\\beta)}(R)$, respectively) in $\\mathrm{eV}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element of this top-level list corresponds to one $R$ in the order listed above and must itself be a list of six floats rounded to six decimal places in the exact order:\n$$\n\\big[E_{\\mathrm{RHF}}(R),\\; E_{\\mathrm{UHF}}(R),\\; m_A,\\; m_B,\\; \\varepsilon_{\\alpha}(R),\\; \\varepsilon_{\\beta}(R)\\big].\n$$\nFor example, the overall output must have the form\n$$\n\\big[\\,[x_{1,1},x_{1,2},x_{1,3},x_{1,4},x_{1,5},x_{1,6}],\\,[x_{2,1},\\dots,x_{2,6}],\\,\\dots,\\, [x_{5,1},\\dots,x_{5,6}]\\,\\big],\n$$\nwith all energies expressed in $\\mathrm{eV}$ and all magnetizations dimensionless.\n\nIn addition to computing the numerical results, your implementation must be based only on the definitions and constructions stated above and should not assume or use any pre-derived shortcut formulas. The numerical algorithm must be designed to converge from physically reasonable initial guesses using damping or mixing if needed and must be robust across the full test suite. The goal is to compare Restricted Hartree-Fock (RHF) and Unrestricted Hartree-Fock (UHF) orbital energies and densities for bond dissociation and to demonstrate, by explicit computation, how spin and spatial symmetry breaking in UHF can lower the energy relative to RHF as $R$ increases. No angles are involved in this problem, and therefore no angle units are required. All outputs must be floats in the units and order specified, and the final output must contain only the single line described above with no additional text.",
            "solution": "The problem requires the implementation of the Restricted Hartree-Fock (RHF) and Unrestricted Hartree-Fock (UHF) self-consistent field (SCF) methods for a two-site, two-electron Hubbard model. The goal is to compute the ground state energies and properties for a range of internuclear separations $R$.\n\nThe system is described by the Hubbard Hamiltonian:\n$$\n\\hat{H}(R) \\;=\\; -\\,t(R)\\sum_{\\sigma\\in\\{\\alpha,\\beta\\}}\\left(\\hat{a}_{A\\sigma}^\\dagger\\hat{a}_{B\\sigma} + \\hat{a}_{B\\sigma}^\\dagger\\hat{a}_{A\\sigma}\\right) \\;+\\; U\\,\\sum_{i\\in\\{A,B\\}}\\hat{n}_{i\\alpha}\\,\\hat{n}_{i\\beta}\n$$\nHere, the first term represents the kinetic energy of electrons \"hopping\" between sites $A$ and $B$, with a distance-dependent hopping integral $t(R) = t_0\\,\\exp(-a\\,R)$. The second term represents the potential energy cost $U$ of having two electrons with opposite spins occupy the same site.\n\nThe Hartree-Fock method approximates the many-body problem by assuming each electron moves in an average, or mean, field created by all other electrons. This decouples the Hamiltonian into a set of one-electron problems. For this model, the mean-field approximation leads to a spin-dependent Fock matrix $F^{(\\sigma)}(R)$ for each spin channel $\\sigma \\in \\{\\alpha, \\beta\\}$:\n$$\nF^{(\\sigma)}(R) \\;=\\; \\begin{pmatrix}\nU\\,n_{A,-\\sigma} & -\\,t(R) \\\\\n-\\,t(R) & U\\,n_{B,-\\sigma}\n\\end{pmatrix}\n$$\nThe diagonal elements represent the on-site energy, which for an electron with spin $\\sigma$ at site $i$ depends on the average occupation (density) $n_{i,-\\sigma}$ of an electron with the opposite spin $-\\sigma$ at that same site. The off-diagonal elements are simply the hopping terms from the kinetic operator matrix $h(R)$.\n\nThe core of the problem is to find a self-consistent solution for the densities $n_{i,\\sigma}$. An SCF procedure is an iterative algorithm to achieve this:\n1.  **Initialization**: Start with an initial guess for the site densities $\\{n_{A,\\alpha}, n_{B,\\alpha}, n_{A,\\beta}, n_{B,\\beta}\\}$. For a two-electron system ($1\\alpha$, $1\\beta$), we must satisfy the constraints $\\sum_i n_{i,\\alpha} = 1$ and $\\sum_i n_{i,\\beta} = 1$.\n2.  **Iteration**:\n    a.  **Build Fock matrices**: Construct $F^{(\\alpha)}(R)$ using the beta-spin densities $\\{n_{A,\\beta}, n_{B,\\beta}\\}$ and $F^{(\\beta)}(R)$ using the alpha-spin densities $\\{n_{A,\\alpha}, n_{B,\\alpha}\\}$.\n    b.  **Solve the Eigenproblem**: For each spin $\\sigma$, solve the eigenvalue equation $F^{(\\sigma)}(R) |\\phi_\\sigma\\rangle = \\varepsilon_\\sigma |\\phi_\\sigma\\rangle$. This yields a set of eigenvalues (orbital energies) and eigenvectors (orbitals). Since each spin channel contains one electron, the occupied orbital $|\\phi_\\sigma\\rangle$ is the eigenvector corresponding to the lowest eigenvalue $\\varepsilon_\\sigma$.\n    c.  **Update Densities**: The eigenvector for the occupied orbital $|\\phi_\\sigma\\rangle$ is given by its components $(c_{A,\\sigma}, c_{B,\\sigma})$ in the site basis. New densities are computed as $n'_{A,\\sigma} = |c_{A,\\sigma}|^2$ and $n'_{B,\\sigma} = |c_{B,\\sigma}|^2$.\n    d.  **Mixing**: To ensure smooth convergence and prevent oscillations, the densities for the next iteration are formed by mixing the old and new densities, for example, via linear mixing with a parameter $\\alpha_{\\text{mix}} \\in (0, 1)$: $n_{\\text{next}} = (1-\\alpha_{\\text{mix}})n_{\\text{old}} + \\alpha_{\\text{mix}}n'_{\\text{new}}$.\n    e.  **Check for Convergence**: The loop is terminated when the change in densities between successive iterations falls below a predefined tolerance.\n\nThe RHF and UHF methods differ in the constraints applied to the densities:\n-   **RHF (Restricted Hartree-Fock)**: This method imposes the constraint that spatial orbitals for spin-$\\alpha$ and spin-$\\beta$ electrons are identical. This implies $n_{i,\\alpha} = n_{i,\\beta}$ for each site $i$. In practice, one solves a single Fock matrix (as they become identical) and enforces the density equality at each iteration. This method correctly describes systems with closed-shell electronic structures but often fails for bond dissociation, where it incorrectly maintains spatial symmetry, leading to an unphysically high energy.\n-   **UHF (Unrestricted Hartree-Fock)**: This method allows spin-$\\alpha$ and spin-$\\beta$ electrons to occupy different spatial orbitals. Consequently, $n_{i,\\alpha}$ and $n_{i,\\beta}$ can differ. This additional flexibility allows the system to break spatial and spin symmetry if doing so lowers the total energy. To find such a broken-symmetry solution, the SCF process is typically initiated with a guess that breaks the symmetry, e.g., by slightly localizing the $\\alpha$ and $\\beta$ electrons on different sites. For large $R$, UHF correctly describes the dissociation into two neutral atoms, each with one electron (e.g., $n_{A,\\alpha} \\to 1, n_{B,\\beta} \\to 1, n_{A,\\beta} \\to 0, n_{B,\\alpha} \\to 0$), yielding a site magnetization $m_A = n_{A,\\alpha} - n_{A,\\beta} = 1$ and $m_B = n_{B,\\alpha} - n_{B,\\beta} = -1$.\n\nOnce the densities $\\{n_{i,\\sigma}\\}$ and orbitals $\\{|\\phi_\\sigma\\rangle\\}$ have converged, the final properties are calculated:\n-   **Total Hartree-Fock Energy**:\n    $$\n    E_{\\mathrm{HF}}(R) \\;=\\; \\sum_{\\sigma\\in\\{\\alpha,\\beta\\}} \\langle \\phi_\\sigma | h(R) | \\phi_\\sigma \\rangle \\;+\\; U \\sum_{i\\in\\{A,B\\}} n_{i,\\alpha}\\,n_{i,\\beta}\n    $$\n    The term $\\langle \\phi_\\sigma | h(R) | \\phi_\\sigma \\rangle$ represents the kinetic energy of the electron in orbital $|\\phi_\\sigma\\rangle$ and is computed as $-2t(R)c_{A,\\sigma}^* c_{B,\\sigma}$. The second term is the mean-field potential energy from electron-electron repulsion.\n-   **Site Magnetization**: $m_A = n_{A,\\alpha} - n_{A,\\beta}$ and $m_B = n_{B,\\alpha} - n_{B,\\beta}$.\n-   **Occupied Orbital Energies**: $\\varepsilon_{\\alpha}(R)$ and $\\varepsilon_{\\beta}(R)$, which are the lowest eigenvalues of the converged Fock matrices $F^{(\\alpha)}(R)$ and $F^{(\\beta)}(R)$, respectively.\n\nThe algorithm is implemented for each value of $R$ in the test suite to calculate the required quantities for both RHF and UHF.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the two-site Hubbard model using RHF and UHF SCF methods\n    for a given set of parameters and internuclear distances.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    U = 6.0   # On-site Coulomb repulsion (eV)\n    t0 = 8.0  # Hopping prefactor (eV)\n    a = 1.0   # Exponential decay rate (1/Angstrom)\n    \n    # --- Numerical SCF Parameters ---\n    TOLERANCE = 1e-9\n    MAX_ITER = 500\n    MIXING_ALPHA = 0.5  # Damping/mixing parameter\n    \n    # --- Test Suite ---\n    R_values = [0.5, 0.8, 1.2, 2.0, 3.0]\n\n    def scf_calculation(R, is_rhf):\n        \"\"\"\n        Performs a self-consistent field calculation for a given R.\n        \n        Args:\n            R (float): The internuclear separation in Angstroms.\n            is_rhf (bool): If True, performs an RHF calculation. Otherwise, UHF.\n        \n        Returns:\n            A dictionary containing the converged results.\n        \"\"\"\n        \n        t = t0 * np.exp(-a * R)\n        h = np.array([[0.0, -t], [-t, 0.0]])\n\n        # --- Initial Guess ---\n        # For UHF, break symmetry to find the lower-energy broken-symmetry solution.\n        # For RHF, start with a symmetric guess.\n        delta = 0.01 if not is_rhf else 0.0\n        n_A_alpha = 0.5 + delta\n        n_B_alpha = 0.5 - delta\n        n_A_beta = 0.5 - delta\n        n_B_beta = 0.5 + delta\n\n        for _ in range(MAX_ITER):\n            # Store old densities for convergence check\n            densities_old = np.array([n_A_alpha, n_B_alpha, n_A_beta, n_B_beta])\n\n            # --- Build Fock Matrices ---\n            F_alpha = np.array([[U * n_A_beta, -t], [-t, U * n_B_beta]])\n            F_beta = np.array([[U * n_A_alpha, -t], [-t, U * n_B_alpha]])\n            \n            # --- Solve Eigenproblem ---\n            # np.linalg.eigh returns sorted eigenvalues and corresponding eigenvectors\n            eigvals_alpha, eigvecs_alpha = np.linalg.eigh(F_alpha)\n            eigvals_beta, eigvecs_beta = np.linalg.eigh(F_beta)\n\n            # Occupied orbitals are those with the lowest energy\n            eps_alpha_occ = eigvals_alpha[0]\n            phi_alpha = eigvecs_alpha[:, 0]\n            \n            eps_beta_occ = eigvals_beta[0]\n            phi_beta = eigvecs_beta[:, 0]\n\n            # --- Update Densities ---\n            new_n_A_alpha = phi_alpha[0]**2\n            new_n_B_alpha = phi_alpha[1]**2\n            new_n_A_beta = phi_beta[0]**2\n            new_n_B_beta = phi_beta[1]**2\n\n            # --- Enforce RHF constraint if applicable ---\n            if is_rhf:\n                avg_n_A = (new_n_A_alpha + new_n_A_beta) / 2.0\n                avg_n_B = (new_n_B_alpha + new_n_B_beta) / 2.0\n                new_n_A_alpha = new_n_A_beta = avg_n_A\n                new_n_B_alpha = new_n_B_beta = avg_n_B\n\n            # --- Mixing ---\n            n_A_alpha = (1 - MIXING_ALPHA) * n_A_alpha + MIXING_ALPHA * new_n_A_alpha\n            n_B_alpha = (1 - MIXING_ALPHA) * n_B_alpha + MIXING_ALPHA * new_n_B_alpha\n            n_A_beta = (1 - MIXING_ALPHA) * n_A_beta + MIXING_ALPHA * new_n_A_beta\n            n_B_beta = (1 - MIXING_ALPHA) * n_B_beta + MIXING_ALPHA * new_n_B_beta\n            \n            # --- Renormalize densities to ensure conservation ---\n            norm_alpha = n_A_alpha + n_B_alpha\n            n_A_alpha /= norm_alpha\n            n_B_alpha /= norm_alpha\n            \n            norm_beta = n_A_beta + n_B_beta\n            n_A_beta /= norm_beta\n            n_B_beta /= norm_beta\n\n            # --- Check for Convergence ---\n            densities_new = np.array([n_A_alpha, n_B_alpha, n_A_beta, n_B_beta])\n            if np.max(np.abs(densities_new - densities_old)) < TOLERANCE:\n                break\n        \n        # --- Post-SCF Calculations ---\n        # Kinetic energy contribution from each occupied orbital\n        E_kin_alpha = phi_alpha.T @ h @ phi_alpha\n        E_kin_beta = phi_beta.T @ h @ phi_beta\n\n        # Potential energy from mean-field densities\n        E_pot = U * (n_A_alpha * n_A_beta + n_B_alpha * n_B_beta)\n\n        # Total HF energy\n        E_HF = E_kin_alpha + E_kin_beta + E_pot\n        \n        # Site magnetizations\n        m_A = n_A_alpha - n_A_beta\n        m_B = n_B_alpha - n_B_beta\n\n        return {\n            'E_HF': E_HF,\n            'm_A': m_A,\n            'm_B': m_B,\n            'eps_alpha': eps_alpha_occ,\n            'eps_beta': eps_beta_occ\n        }\n\n    # --- Main Loop ---\n    all_results = []\n    for R in R_values:\n        rhf_results = scf_calculation(R, is_rhf=True)\n        uhf_results = scf_calculation(R, is_rhf=False)\n        \n        # If UHF converges to the symmetric RHF solution, its energy will be higher\n        # or equal. The true UHF solution is the minimum of symmetric and\n        # broken-symmetry possibilities.\n        if uhf_results['E_HF'] > rhf_results['E_HF']:\n            # This can happen at small R where the RHF solution is the true minimum.\n            # The broken-symmetry guess might converge to a saddle point.\n            # We take the RHF solution as the correct UHF result in this case.\n            uhf_results = scf_calculation(R, is_rhf=True)\n\n        case_results = [\n            round(rhf_results['E_HF'], 6),\n            round(uhf_results['E_HF'], 6),\n            round(uhf_results['m_A'], 6),\n            round(uhf_results['m_B'], 6),\n            round(uhf_results['eps_alpha'], 6),\n            round(uhf_results['eps_beta'], 6)\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string\n    # e.g., [[-9.529, ...], [-7.54, ...]]\n    output_str = '[' + ','.join([str(res) for res in all_results]) + ']'\n    \n    # The problem asks for the exact format with spaces after commas inside inner lists\n    output_str = output_str.replace(\" \", \"\")\n    output_str = output_str.replace(\",\", \", \")\n    output_str = output_str.replace(\"],[\", \"], [\")\n    \n    print(output_str)\n\nsolve()\n```"
        }
    ]
}