{
    "hands_on_practices": [
        {
            "introduction": "理论上，平面波基组是一个无限集合，但在实际计算中必须将其截断为一个有限大小的基组。动能截断 ($E_{\\text{cut}}$) 是实现这一目标的核心标准。本练习将理论付诸实践，要求您通过编程来确定，对于给定的动能截断值，哪些倒格矢（即哪些平面波）应被包含在基组中，这是任何平面波计算的第一个基本步骤 ()。",
            "id": "3833123",
            "problem": "考虑一个具有边长 $(L_x,L_y,L_z)$ 的正交周期性模拟晶胞，其中的平面波基组由倒格矢 $\\mathbf{G} = \\left(G_x,G_y,G_z\\right)$ 索引。这些倒格矢通过倒易空间定义 $G_i = \\frac{2\\pi n_i}{L_i}$ 与整数三元组 $(n_x,n_y,n_z)\\in\\mathbb{Z}^3$ 相关联，适用于每个笛卡尔方向 $i\\in\\{x,y,z\\}$。在玻恩-冯·卡门周期性边界条件下，平面波 $\\exp\\left(i\\,\\mathbf{G}\\cdot \\mathbf{r}\\right)$ 是质量为 $m$ 的自由电子的动能算符 $-\\frac{\\hbar^2}{2m}\\nabla^2$ 的本征函数，其本征值取决于 $|\\mathbf{G}|^2$，其中 $\\hbar$ 是约化普朗克常数。动能随 $|\\mathbf{G}|^2$ 单调增加，并由此定义了基函数按动能递增的一种自然排序。\n\n任务：对于每个指定的测试用例，生成所有满足条件的整数三元组 $(n_x,n_y,n_z)$ 的完整集合，使得在$\\Gamma$点（即晶体波矢 $\\mathbf{k}=\\mathbf{0}$）对应的平面波动能不超过给定的能量截断值 $E_{\\mathrm{cut}}$。然后，按动能递增的顺序对这些三元组进行排序；对于动能完全相等的三元组，则通过对 $(n_x,n_y,n_z)$ 进行升序字典序排序来打破僵局。计算满足截断条件的三元组数量，并按指定顺序将它们列出。\n\n推导和实现的基本依据包括以下经过充分检验的事实：\n- 对于每个 $i\\in\\{x,y,z\\}$ 和 $(n_x,n_y,n_z)\\in\\mathbb{Z}^3$，倒格矢分量满足 $G_i=\\frac{2\\pi n_i}{L_i}$。\n- 自由电子的动能算符为 $-\\frac{\\hbar^2}{2m}\\nabla^2$。\n- 平面波是拉普拉斯算子的本征函数，其动能取决于 $|\\mathbf{G}|^2$。\n- 按动能递增排序等价于按 $|\\mathbf{G}|^2$ 递增排序。\n\n单位与常数：\n- 使用国际单位制 (SI)。晶胞长度必须以米 (m) 为单位，能量截断值以焦耳 (J) 为单位。\n- 使用电子静止质量 $m = 9.1093837015\\times 10^{-31}$ kg 和约化普朗克常数 $\\hbar = 1.054571817\\times 10^{-34}$ J·s。\n\n数值的包容性和鲁棒性：\n- 如果一个平面波计算出的动能小于或等于 $E_{\\mathrm{cut}}$，则它被包含在内。为避免在相等情况下因浮点数计算而错误地排除，请将比较实现为 $E \\le E_{\\mathrm{cut}}\\,(1+\\delta_{\\mathrm{rel}}) + \\delta_{\\mathrm{abs}}$，其中 $\\delta_{\\mathrm{rel}}=10^{-12}$，$\\delta_{\\mathrm{abs}}=10^{-32}$ J。\n\n对于每个测试用例，你的程序必须返回：\n- 符合条件的三元组的整数数量。\n- 所有符合条件的三元组的有序列表，形式为列表的列表 $[n_x,n_y,n_z]$。\n\n你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果格式为 $[\\,\\text{count},\\,\\text{ordered\\_triplets}\\,]$。\n\n测试套件（每个元组为 $(L_x,L_y,L_z,E_{\\mathrm{cut}})$，其中 $L$ 的单位为米， $E_{\\mathrm{cut}}$ 的单位为焦耳）：\n- 用例A（通用各向同性晶胞）：$(L_x,L_y,L_z,E_{\\mathrm{cut}})=\\left(1.0\\times 10^{-9},\\,1.0\\times 10^{-9},\\,1.0\\times 10^{-9},\\,3.0\\times 10^{-19}\\right)$。\n- 用例B（截断值在零的边界）：$(L_x,L_y,L_z,E_{\\mathrm{cut}})=\\left(1.0\\times 10^{-9},\\,1.0\\times 10^{-9},\\,1.0\\times 10^{-9},\\,0\\right)$。\n- 用例C（各向异性晶胞）：$(L_x,L_y,L_z,E_{\\mathrm{cut}})=\\left(1.0\\times 10^{-9},\\,2.0\\times 10^{-9},\\,3.0\\times 10^{-9},\\,1.0\\times 10^{-19}\\right)$。\n- 用例D（在相等时包含简并壳层）：$(L_x,L_y,L_z,E_{\\mathrm{cut}})=\\left(1.0\\times 10^{-9},\\,1.0\\times 10^{-9},\\,1.0\\times 10^{-9},\\,4.820\\times 10^{-19}\\right)$。\n\n你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，例如：$[[\\text{count}_A,\\text{list}_A],[\\text{count}_B,\\text{list}_B],[\\text{count}_C,\\text{list}_C],[\\text{count}_D,\\text{list}_D]]$。",
            "solution": "该问题是有效的。它在科学上基于适用于周期性体系的量子力学原理，这是计算材料科学的基石。该问题是适定的，提供了所有必要的物理常数、数学定义和数值公差，以确定一个唯一的、可验证的解。语言客观，要求明确。\n\n主要目标是识别由整数三元组 $(n_x, n_y, n_z)$ 索引的平面波基函数集合，这些基函数满足给定的动能截断值 $E_{\\mathrm{cut}}$。这些基函数是在布里渊区的$\\Gamma$点上考虑的，对应于晶体波矢 $\\mathbf{k}=\\mathbf{0}$。\n\n首先，我们建立平面波的动能与其对应的整数三元组之间的关系。质量为 $m$ 的自由电子的不含时薛定谔方程由动能算符 $\\hat{T} = -\\frac{\\hbar^2}{2m}\\nabla^2$ 控制。平面波，形式为 $\\psi_{\\mathbf{G}}(\\mathbf{r}) \\propto \\exp(i\\,\\mathbf{G}\\cdot \\mathbf{r})$，是该算符的本征函数。这里，$\\mathbf{G}$ 是一个倒格矢。应用该算符可得：\n$$\n\\hat{T} \\psi_{\\mathbf{G}}(\\mathbf{r}) = -\\frac{\\hbar^2}{2m}\\nabla^2 \\exp(i\\,\\mathbf{G}\\cdot \\mathbf{r}) = -\\frac{\\hbar^2}{2m}}(i\\mathbf{G})\\cdot(i\\mathbf{G}) \\exp(i\\,\\mathbf{G}\\cdot \\mathbf{r}) = \\frac{\\hbar^2|\\mathbf{G}|^2}{2m} \\exp(i\\,\\mathbf{G}\\cdot \\mathbf{r})\n$$\n因此，动能本征值 $E_{\\mathbf{G}}$ 为：\n$$\nE_{\\mathbf{G}} = \\frac{\\hbar^2|\\mathbf{G}|^2}{2m}\n$$\n对于边长为 $(L_x, L_y, L_z)$ 的正交模拟晶胞，倒格矢 $\\mathbf{G} = (G_x, G_y, G_z)$ 的分量由整数三元组 $(n_x, n_y, n_z) \\in \\mathbb{Z}^3$ 定义为 $G_i = \\frac{2\\pi n_i}{L_i}$，其中 $i \\in \\{x, y, z\\}$。其模长的平方 $|\\mathbf{G}|^2$ 为：\n$$\n|\\mathbf{G}|^2 = G_x^2 + G_y^2 + G_z^2 = \\left(\\frac{2\\pi n_x}{L_x}\\right)^2 + \\left(\\frac{2\\pi n_y}{L_y}\\right)^2 + \\left(\\frac{2\\pi n_z}{L_z}\\right)^2 = 4\\pi^2 \\left(\\frac{n_x^2}{L_x^2} + \\frac{n_y^2}{L_y^2} + \\frac{n_z^2}{L_z^2}\\right)\n$$\n将此代入能量本征值表达式，得到特定三元组的动能 $E_{n_x,n_y,n_z}$：\n$$\nE_{n_x,n_y,n_z} = \\frac{\\hbar^2}{2m} \\left[ 4\\pi^2 \\left(\\frac{n_x^2}{L_x^2} + \\frac{n_y^2}{L_y^2} + \\frac{n_z^2}{L_z^2}\\right) \\right] = \\frac{2\\pi^2\\hbar^2}{m} \\left(\\frac{n_x^2}{L_x^2} + \\frac{n_y^2}{L_y^2} + \\frac{n_z^2}{L_z^2}\\right)\n$$\n任务是找到所有满足 $E_{n_x,n_y,n_z} \\le E_{\\mathrm{cut}}$ 的整数三元组 $(n_x, n_y, n_z)$。为处理边界上的浮点精度问题，该条件使用一个容差来实现：\n$$\nE_{n_x,n_y,n_z} \\le E_{\\mathrm{cut,eff}} \\quad \\text{其中} \\quad E_{\\mathrm{cut,eff}} = E_{\\mathrm{cut}}(1 + \\delta_{\\mathrm{rel}}) + \\delta_{\\mathrm{abs}}\n$$\n其中 $\\delta_{\\mathrm{rel}}=10^{-12}$ 且 $\\delta_{\\mathrm{abs}}=10^{-32}$ J。\n\n解决每个测试用例问题的算法流程如下：\n$1$. **初始化**：对于给定的测试用例 $(L_x, L_y, L_z, E_{\\mathrm{cut}})$，计算有效能量截断值 $E_{\\mathrm{cut,eff}}$。同时计算常数前置因子 $C_{\\text{factor}} = \\frac{2\\pi^2\\hbar^2}{m}$。包含一个三元组的条件变为：\n$$\n\\frac{n_x^2}{L_x^2} + \\frac{n_y^2}{L_y^2} + \\frac{n_z^2}{L_z^2} \\le \\frac{E_{\\mathrm{cut,eff}}}{C_{\\text{factor}}}\n$$\n该不等式在 $(n_x, n_y, n_z)$ 空间中描述了一个椭球，它界定了有效整数三元组的搜索范围。\n\n$2$. **椭球搜索**：通过迭代执行嵌套循环进行高效搜索，循环的边界由椭球条件动态约束。这避免了在更大的矩形体积中进行搜索。\n- 通过设置 $n_y=0$ 和 $n_z=0$ 来找到 $|n_x|$ 的最大可能值：$n_{x,\\max} = \\lfloor L_x \\sqrt{E_{\\mathrm{cut,eff}} / C_{\\text{factor}}} \\rfloor$。我们从 $-n_{x,\\max}$ 到 $n_{x,\\max}$ 迭代 $n_x$。\n- 对于每个 $n_x$，通过设置 $n_z=0$ 来找到 $|n_y|$ 的最大可能值：$n_{y,\\max}(n_x) = \\lfloor L_y \\sqrt{E_{\\mathrm{cut,eff}}/C_{\\text{factor}} - n_x^2/L_x^2} \\rfloor$。我们从 $-n_{y,\\max}(n_x)$ 到 $n_{y,\\max}(n_x)$ 迭代 $n_y$。\n- 对于每对 $(n_x, n_y)$， $|n_z|$ 的最大可能值为：$n_{z,\\max}(n_x, n_y) = \\lfloor L_z \\sqrt{E_{\\mathrm{cut,eff}}/C_{\\text{factor}} - n_x^2/L_x^2 - n_y^2/L_y^2} \\rfloor$。我们从 $-n_{z,\\max}(n_x, n_y)$ 到 $n_{z,\\max}(n_x, n_y)$ 迭代 $n_z$。\n通过此过程生成的每个三元组 $(n_x, n_y, n_z)$ 都保证满足能量截断条件。将这些有效三元组收集起来。\n\n$3$. **排序**：收集到的三元组必须根据指定的标准进行排序。\n- **主排序键**：精确的动能 $E_{n_x,n_y,n_z}$（不使用容差因子计算），按升序排列。\n- **次排序键**：对于能量简并（相同）的三元组，通过按 $(n_x, n_y, n_z)$ 的升序字典序排序来打破僵局。\n这可以通过为每个有效三元组创建一个形式为 $(E_{n_x,n_y,n_z}, n_x, n_y, n_z)$ 的元组列表，然后对该列表进行标准排序来实现。\n\n$4$. **最终处理**：排序后，提取有序的三元组列表。该测试用例的最终结果包括有效三元组的总数和这些三元组的有序列表。对所有提供的测试用例重复此过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the plane-wave basis set problem for a suite of test cases.\n    For each case, it finds all integer triplets (nx, ny, nz) whose\n    corresponding kinetic energy is below a cutoff, then sorts them\n    by energy and lexicographically.\n    \"\"\"\n\n    # --- Constants and Tolerances ---\n    # Electron rest mass in kg\n    m_e = 9.1093837015e-31\n    # Reduced Planck constant in J·s\n    hbar = 1.054571817e-34\n    # Relative and absolute tolerances for energy comparison\n    delta_rel = 1e-12\n    delta_abs = 1e-32\n\n    # --- Test Suite ---\n    # Each tuple is (Lx, Ly, Lz, E_cut) in SI units (m, J)\n    test_cases = [\n        # Case A (general isotropic cell)\n        (1.0e-9, 1.0e-9, 1.0e-9, 3.0e-19),\n        # Case B (boundary cutoff at zero)\n        (1.0e-9, 1.0e-9, 1.0e-9, 0.0),\n        # Case C (anisotropic cell)\n        (1.0e-9, 2.0e-9, 3.0e-9, 1.0e-19),\n        # Case D (degenerate shell inclusion at equality)\n        (1.0e-9, 1.0e-9, 1.0e-9, 4.820e-19),\n    ]\n\n    # List to store final results for all test cases\n    all_results = []\n\n    # --- Main Logic ---\n    # Pre-calculate the constant factor in the energy equation\n    C_factor = (2 * (np.pi**2) * (hbar**2)) / m_e\n\n    for case in test_cases:\n        Lx, Ly, Lz, E_cut = case\n\n        # Apply numerical tolerance to the energy cutoff\n        E_cut_eff = E_cut * (1 + delta_rel) + delta_abs\n        \n        # A list to store tuples of (energy, nx, ny, nz) for sorting\n        found_triplets_with_energy = []\n        \n        # Handle the E_cut  0 case explicitly to avoid sqrt of negative\n        if E_cut_eff  0:\n            all_results.append([0, []])\n            continue\n            \n        # Determine the search range for nx (outermost loop)\n        # We use a try-except block for sqrt(negative) arising from float precision\n        try:\n            nx_max = int(np.floor(Lx * np.sqrt(E_cut_eff / C_factor)))\n        except (ValueError, RuntimeWarning):\n            nx_max = 0\n\n        # Efficiently search the ellipsoid of valid (nx, ny, nz) triplets\n        for nx in range(-nx_max, nx_max + 1):\n            E_rem_y = E_cut_eff - C_factor * ((nx / Lx)**2)\n            if E_rem_y  0:\n                continue\n            \n            try:\n                ny_max = int(np.floor(Ly * np.sqrt(E_rem_y / C_factor)))\n            except (ValueError, RuntimeWarning):\n                ny_max = 0\n\n            for ny in range(-ny_max, ny_max + 1):\n                E_rem_z = E_cut_eff - C_factor * (((nx / Lx)**2) + ((ny / Ly)**2))\n                if E_rem_z  0:\n                    continue\n\n                try:\n                    nz_max = int(np.floor(Lz * np.sqrt(E_rem_z / C_factor)))\n                except (ValueError, RuntimeWarning):\n                    nz_max = 0\n                \n                for nz in range(-nz_max, nz_max + 1):\n                    # For a valid triplet, calculate its precise energy for sorting\n                    energy = C_factor * (((nx / Lx)**2) + ((ny / Ly)**2) + ((nz / Lz)**2))\n                    # The search guarantees energy = E_cut_eff. No re-check needed.\n                    found_triplets_with_energy.append((energy, nx, ny, nz))\n        \n        # Sort the results: primary key is energy, secondary is lexicographical (nx,ny,nz)\n        found_triplets_with_energy.sort(key=lambda item: (item[0], item[1], item[2], item[3]))\n        \n        # Extract the sorted triplets, discarding the energy values\n        sorted_triplets = [[t[1], t[2], t[3]] for t in found_triplets_with_energy]\n        \n        # Get the count of found triplets\n        count = len(sorted_triplets)\n        \n        # Append the result for the current case to the main results list\n        all_results.append([count, sorted_triplets])\n\n    # Format the final output string exactly as required, removing all spaces from the string representation\n    # of the list of lists.\n    final_output = str(all_results).replace(\" \", \"\")\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "在倒易空间中定义了基组后，计算过程常需要在倒易空间和实空间之间来回切换，例如，在计算电子密度时。这种转换通常通过在离散网格上使用快速傅里叶变换 (FFT) 来高效完成，但这会引入潜在的数值误差。本练习探讨了奈奎斯特-香农采样定理在密度泛函理论计算中的应用，旨在推导出防止在计算电荷密度时产生混叠误差 (aliasing error) 所需的最小 FFT 网格大小 ()，这对于保证自洽场计算的准确性至关重要。",
            "id": "3833072",
            "problem": "考虑一个正交（orthorhombic）周期性模拟晶胞，其在实空间中的边长分别为 $L_x$、$L_y$ 和 $L_z$。电子波函数采用平面波基组，并在动能截断能 $E_{\\mathrm{cut}}$（以哈特里原子单位计）处进行截断。电荷密度由波函数的乘积构成，并在一个维度为 $(N_x,N_y,N_z)$ 的三维快速傅里叶变换 (FFT) 网格上进行求值。请仅使用傅里叶变换的基本定义、奈奎斯特-香annon采样定理以及原子单位制下平面波的动能，来确定在形成电荷密度时是否会发生混叠（环绕）误差，并计算在每个笛卡尔轴向上避免此类误差所需的最小整数网格维度。\n\n假设如下：\n- 在哈特里原子单位制中，具有波矢 $\\mathbf{G}$ 的平面波的动能为 $E_{\\mathrm{kin}}(\\mathbf{G}) = \\frac{1}{2}|\\mathbf{G}|^{2}$。\n- 波函数平面波基组包含所有由 $E_{\\mathrm{cut}}$ 所隐含的、满足 $|\\mathbf{G}| \\leq G_{\\mathrm{cut}}$ 的波矢 $\\mathbf{G}$。\n- 正交晶胞的边长为 $L_x = 8$ 玻尔，$L_y = 10$ 玻尔，$L_z = 12$ 玻尔。\n- FFT 网格维度为 $(N_x,N_y,N_z) = (36,48,64)$。\n\n你的任务：\n1. 从第一性原理推导出一个准则，以保证在 FFT 网格上对电荷密度进行采样时不会出现混叠。该准则应表示为与 $(N_x,N_y,N_z)$、$(L_x,L_y,L_z)$ 和 $E_{\\mathrm{cut}}$ 相关的条件。\n2. 使用 $E_{\\mathrm{cut}} = 30$ 哈特里，评估在给定的 $(N_x,N_y,N_z)$条件下是否会发生混叠。\n3. 计算在这些条件下，沿每个轴向避免混叠所需的最小整数三元组 $(N_x',N_y',N_z')$。\n\n将你的最终答案表示为一个单行矩阵，其中包含三元组 $(N_x',N_y',N_z')$。除了选择满足所推导准则的最小整数外，不需要其他取整说明。最终答案中不要包含任何单位。",
            "solution": "所述问题具有科学依据，定义明确，客观，并包含获得唯一解所需的所有必要信息。这是计算材料科学中的一个标准问题。因此，该问题被认为是有效的，可以构建一个完整的解决方案。\n\n根据要求，解决方案分三部分展开：首先，推导避免混叠的一般准则；其次，根据此准则评估给定设置；最后，计算所需的最小网格维度。\n\n### 1. 混叠准则的推导\n\n设正交模拟晶胞由沿笛卡尔轴的实空间格矢定义，其长度分别为 $L_x$、$L_y$ 和 $L_z$。相应的原胞倒易格矢为 $\\mathbf{b}_1 = (2\\pi/L_x, 0, 0)$、$\\mathbf{b}_2 = (0, 2\\pi/L_y, 0)$ 和 $\\mathbf{b}_3 = (0, 0, 2\\pi/L_z)$。任何一个倒易格矢 $\\mathbf{G}$ 都是这些原胞格矢的整数组合：$\\mathbf{G} = n_x \\mathbf{b}_1 + n_y \\mathbf{b}_2 + n_z \\mathbf{b}_3$，其中 $n_x, n_y, n_z$ 为整数。\n\n晶胞内的电子波函数 $\\psi(\\mathbf{r})$ 在一个平面波基组中展开：\n$$ \\psi(\\mathbf{r}) = \\sum_{\\mathbf{G}} c_{\\mathbf{G}} e^{i\\mathbf{G}\\cdot\\mathbf{r}} $$\n该基组通过一个动能截断能 $E_{\\mathrm{cut}}$ 进行截断，即只包含动能小于或等于 $E_{\\mathrm{cut}}$ 的平面波。具有波矢 $\\mathbf{G}$ 的平面波的动能由 $E_{\\mathrm{kin}}(\\mathbf{G}) = \\frac{1}{2}|\\mathbf{G}|^2$（哈特里原子单位）给出。这对所包含波矢的大小施加了一个条件：\n$$ \\frac{1}{2}|\\mathbf{G}|^2 \\leq E_{\\mathrm{cut}} \\implies |\\mathbf{G}| \\leq \\sqrt{2E_{\\mathrm{cut}}} \\equiv G_{\\mathrm{cut}} $$\n因此，波函数的求和仅限于倒易空间中半径为 $G_{\\mathrm{cut}}$ 的球内的所有 $\\mathbf{G}$ 矢量。\n\n电荷密度 $\\rho(\\mathbf{r})$ 由波函数的乘积构成。对于单个轨道，密度为 $\\rho_{\\psi}(\\mathbf{r}) = \\psi^*(\\mathbf{r})\\psi(\\mathbf{r})$。\n$$ \\rho(\\mathbf{r}) = \\left( \\sum_{\\mathbf{G'}} c_{\\mathbf{G'}}^{*} e^{-i\\mathbf{G'}\\cdot\\mathbf{r}} \\right) \\left( \\sum_{\\mathbf{G}} c_{\\mathbf{G}} e^{i\\mathbf{G}\\cdot\\mathbf{r}} \\right) = \\sum_{\\mathbf{G}, \\mathbf{G'}} c_{\\mathbf{G}} c_{\\mathbf{G'}}^{*} e^{i(\\mathbf{G}-\\mathbf{G'})\\cdot\\mathbf{r}} $$\n这个表达式是电荷密度的傅里叶级数。令 $\\mathbf{K} = \\mathbf{G} - \\mathbf{G'}$。密度可以写成：\n$$ \\rho(\\mathbf{r}) = \\sum_{\\mathbf{K}} \\rho_{\\mathbf{K}} e^{i\\mathbf{K}\\cdot\\mathbf{r}} $$\n其中 $\\rho_{\\mathbf{K}}$ 是密度的傅里叶系数。一个非零系数 $\\rho_{\\mathbf{K}}$ 存在的条件是 $\\mathbf{K}$ 可以表示为 $\\mathbf{G} - \\mathbf{G'}$ 的差，其中 $|\\mathbf{G}| \\leq G_{\\mathrm{cut}}$ 且 $|\\mathbf{G'}| \\leq G_{\\mathrm{cut}}$。\n\n使用三角不等式，我们可以找到密度展开中波矢 $\\mathbf{K}$ 的最大模长：\n$$ |\\mathbf{K}| = |\\mathbf{G} - \\mathbf{G'}| \\leq |\\mathbf{G}| + |-\\mathbf{G'}| = |\\mathbf{G}| + |\\mathbf{G'}| \\leq G_{\\mathrm{cut}} + G_{\\mathrm{cut}} = 2G_{\\mathrm{cut}} $$\n这意味着电荷密度的所有傅里叶分量都包含在倒易空间中半径为 $2G_{\\mathrm{cut}}$ 的球内。\n\n电荷密度在一个维度为 $(N_x, N_y, N_z)$ 的离散快速傅里叶变换 (FFT) 网格上进行求值。对于 $x$ 维度，此网格由 $N_x$ 个点组成，间距为 $\\Delta x = L_x/N_x$。根据奈奎斯特-香农采样定理，要无混叠（环绕误差）地表示一个信号，采样频率必须至少是信号中最高频率的两倍。在波矢方面，最高波矢分量的模长必须小于或等于网格的奈奎斯特波矢。\n\n对于一个实空间网格，其间距为 $\\Delta x = L_x/N_x$，其在倒易空间中对应的 FFT 可以表示的波矢分量最大值（奈奎斯特极限）为：\n$$ k_{x, \\mathrm{Nyquist}} = \\frac{\\pi}{\\Delta x} = \\frac{\\pi N_x}{L_x} $$\n为避免混叠，密度的最大波矢分量 $K_{x, \\mathrm{max}}$ 必须满足 $|K_{x, \\mathrm{max}}| \\leq k_{x, \\mathrm{Nyquist}}$。在 $|\\mathbf{K}| \\leq 2G_{\\mathrm{cut}}$ 的球内，矢量 $\\mathbf{K}$ 的最大可能 $x$ 分量是 $2G_{\\mathrm{cut}}$。因此，防止沿 $x$ 轴发生混叠的条件是：\n$$ 2G_{\\mathrm{cut}} \\leq \\frac{\\pi N_x}{L_x} $$\n对 $N_x$ 进行整理，并代入 $G_{\\mathrm{cut}} = \\sqrt{2E_{\\mathrm{cut}}}$，我们得到每个笛卡尔轴 $i \\in \\{x, y, z\\}$ 的通用准则：\n$$ N_i \\ge \\frac{2L_i G_{\\mathrm{cut}}}{\\pi} = \\frac{2L_i \\sqrt{2E_{\\mathrm{cut}}}}{\\pi} $$\n该条件保证了FFT网格足够精细，可以无混叠误差地表示电荷密度。\n\n### 2. 针对给定参数的混叠评估\n\n给定参数如下：\n- $E_{\\mathrm{cut}} = 30$ 哈特里\n- $L_x = 8$ 玻尔, $L_y = 10$ 玻尔, $L_z = 12$ 玻尔\n- FFT 网格 $(N_x, N_y, N_z) = (36, 48, 64)$\n\n首先，我们计算截断波矢 $G_{\\mathrm{cut}}$：\n$$ G_{\\mathrm{cut}} = \\sqrt{2E_{\\mathrm{cut}}} = \\sqrt{2 \\times 30} = \\sqrt{60} \\text{ bohr}^{-1} $$\n现在，我们使用推导出的准则计算每个轴所需的最小网格点数 ($N'_{i}$)，并检查给定的 $N_i$ 是否足够。\n$x$ 轴的最小值：\n$$ N_x' = \\frac{2 L_x \\sqrt{60}}{\\pi} = \\frac{2 \\times 8 \\times \\sqrt{60}}{\\pi} = \\frac{16\\sqrt{60}}{\\pi} \\approx 39.45 $$\n给定的网格有 $N_x = 36$。由于 $36  39.45$，网格不充分，将沿 $x$ 轴发生混叠。\n\n$y$ 轴的最小值：\n$$ N_y' = \\frac{2 L_y \\sqrt{60}}{\\pi} = \\frac{2 \\times 10 \\times \\sqrt{60}}{\\pi} = \\frac{20\\sqrt{60}}{\\pi} \\approx 49.31 $$\n给定的网格有 $N_y = 48$。由于 $48  49.31$，网格不充分，将沿 $y$ 轴也发生混叠。\n\n$z$ 轴的最小值：\n$$ N_z' = \\frac{2 L_z \\sqrt{60}}{\\pi} = \\frac{2 \\times 12 \\times \\sqrt{60}}{\\pi} = \\frac{24\\sqrt{60}}{\\pi} \\approx 59.17 $$\n给定的网格有 $N_z = 64$。由于 $64 > 59.17$，网格沿 $z$ 轴是充分的。\n\n因为 FFT 网格维度在 $x$ 和 $y$ 轴上不充分，混叠误差将污染电荷密度的计算。\n\n### 3. 最小网格维度的计算\n\n为避免混叠，沿每个轴的网格点数必须是大于或等于上述计算出的最小值的整数。我们通过对每个所需值向上取整来找到最小整数维度 $(N_x', N_y', N_z')$。\n\n最小 $N_x'$:\n$$ N_x' = \\lceil \\frac{16\\sqrt{60}}{\\pi} \\rceil = \\lceil 39.45 \\rceil = 40 $$\n最小 $N_y'$:\n$$ N_y' = \\lceil \\frac{20\\sqrt{60}}{\\pi} \\rceil = \\lceil 49.31 \\rceil = 50 $$\n最小 $N_z'$:\n$$ N_z' = \\lceil \\frac{24\\sqrt{60}}{\\pi} \\rceil = \\lceil 59.17 \\rceil = 60 $$\n因此，在给定条件下避免混叠误差的最小整数网格维度为 $(40, 50, 60)$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 40  50  60 \\end{pmatrix}}$$"
        },
        {
            "introduction": "平面波方法内在地假定了系统的周期性。为了模拟非周期性系统（如单个原子、分子或缺陷），我们采用了“超胞近似” (supercell approximation)，即将孤立系统置于一个大的周期性盒子中。本练习是一个批判性思维挑战，旨在探索当这种近似失效时（即当周期性镜像彼此过近时）会产生的后果。通过分析各种可能出现的“有限尺寸误差”，您可以更深刻地理解平面波计算的内在局限性及其适用范围 ()。",
            "id": "2460238",
            "problem": "要求你使用平面波基组，在周期性边界条件下，计算一个孤立中性原子的基态性质。设置如下：将一个带有核电荷 $+Ze$ 和 $Z$ 个电子的单个中性原子放置在边长为 $L$ 的立方超胞中，对离子势采用模守恒赝势，将 Kohn–Sham 轨道用平面波展开至动能截断 $E_{\\mathrm{cut}}$，使用 $\\Gamma$ 点（即 $\\mathbf{k}=\\mathbf{0}$）进行布里渊区采样，并用 Ewald 求和方法计算静电相互作用。假设在保持 $E_{\\mathrm{cut}}$ 不变的情况下，使 $L$ 变得非常小。下列哪个陈述正确描述了此计算中出现的问题？选择所有适用的选项。\n\nA. 计算不再代表一个孤立原子，而是描述了一个周期性的原子晶体；周期性镜像之间的重叠会产生称成键/反键分裂和能带色散，因此 Kohn–Sham 本征值和总能量对 $L$ 产生强烈且不符合物理的依赖性。\n\nB. 在固定的 $E_{\\mathrm{cut}}$ 下减小 $L$ 会使平面波基组过完备，导致线性相关和数值不稳定性。\n\nC. 即使对于中性原子，Ewald 求和的 Hartree 能量也会发散，除非引入一个补偿性的均匀背景电荷密度。\n\nD. 在小超胞中，静电势的任意常数偏移变得具有物理意义，并破坏了总能量的准确性。\n\nE. 即使原子是中性的，周期性镜像之间的相互作用也会引入有限尺寸误差；对于非零的多极矩，这些误差会随 $L$ 按代数形式衰减（例如，对于偶极子，按 $L^{-3}$ 衰减），而对于球对称的闭壳层原子，主要误差来自于与镜像的交换/重叠，并随 $L$ 按指数形式衰减。",
            "solution": "问题陈述描述了量子化学和凝聚态物理中的一个标准计算设置：使用平面波基组和周期性边界条件在超胞内模拟一个孤立系统（一个中性原子）。这种方法被称为超胞近似，其有效性取决于超胞是否足够大，以使系统与其周期性镜像之间的相互作用可以忽略不计。问题要求在超胞尺寸 $L$ 变得非常小的情况下，识别该方法的失效模式。\n\n该问题在科学上是适定的，并且基于平面波密度泛函理论计算的既定原则。所使用的所有术语都是该领域的标准术语，所描述的场景是讨论有限尺寸误差的常见背景。该设置是自洽的，没有矛盾。因此，我们可以着手解答。\n\n问题的核心在于超胞近似的失效。我们将分析使 $L$ 变小对物理模型、基组和静电计算造成的影响。\n\n基函数是形式为 $\\psi_{\\mathbf{G}}(\\mathbf{r}) = \\frac{1}{\\sqrt{V}} e^{i\\mathbf{G}\\cdot\\mathbf{r}}$ 的平面波，其中 $V=L^3$ 是超胞的体积。倒格矢 $\\mathbf{G}$ 定义为 $\\mathbf{G} = n_x \\mathbf{b}_1 + n_y \\mathbf{b}_2 + n_z \\mathbf{b}_3$，其中对于边长为 $L$ 的立方晶胞，$\\mathbf{b}_1 = \\frac{2\\pi}{L}(1,0,0)$，$\\mathbf{b}_2 = \\frac{2\\pi}{L}(0,1,0)$，$\\mathbf{b}_3 = \\frac{2\\pi}{L}(0,0,1)$，$n_x, n_y, n_z$ 为整数。基组通过动能截断 $E_{\\mathrm{cut}}$ 被截断，包含所有满足 $\\frac{\\hbar^2 |\\mathbf{G}|^2}{2m_e} \\leq E_{\\mathrm{cut}}$ 的平面波。\n\n我们现在来评估每个选项。\n\n**A. 计算不再代表一个孤立原子，而是描述了一个周期性的原子晶体；周期性镜像之间的重叠会产生称成键/反键分裂和能带色散，因此 Kohn–Sham 本征值和总能量对 $L$ 产生强烈且不符合物理的依赖性。**\n\n这个陈述正确地指出了主要的理论性错误。周期性边界条件意味着系统不是真空中的单个原子，而是在晶格常数为 $L$ 的晶格上无限周期性排列的原子阵列。\n1.  **物理模型：** 当 $L$ 很大时，原子与其镜像之间的距离很大，它们的相互作用可以忽略。该模型是对孤立原子的良好近似。当 $L$ 变小时，相邻原子之间的距离变得与原子轨道的延展范围相当。所模拟的系统不再是孤立原子，而是一种致密的晶体固体。\n2.  **电子结构：** 在孤立原子中，电子态是离散的能级。在固体中，原子间的轨道重叠导致这些能级展宽成能带。这是 Bloch 定理的直接结果。即使我们只在 $\\Gamma$ 点（$\\mathbf{k}=\\mathbf{0}$）进行采样，这个单点的态能量 $E(\\mathbf{k}=\\mathbf{0})$ 也会受到与相邻晶胞相互作用的影响。系统的总能量将包括这些被人为紧密堆积的原子之间的虚假相互作用能。\n3.  **对 $L$ 的依赖性：** 当 $L$ 变小时，Kohn–Sham 本征值和总能量都会表现出对 $L$ 的强烈依赖性。这种依赖性是不符合物理的相互作用所造成的假象，而不是我们意图研究的孤立原子的性质。\n因此，这个陈述是对问题所在的正确且根本的描述。\n**结论：正确**\n\n**B. 在固定的 $E_{\\mathrm{cut}}$ 下减小 $L$ 会使平面波基组过完备，导致线性相关和数值不稳定性。**\n\n基组中平面波的数量 $N_{\\mathrm{PW}}$ 由满足 $\\frac{\\hbar^2 |\\mathbf{G}|^2}{2m_e} \\leq E_{\\mathrm{cut}}$ 的倒格矢 $\\mathbf{G}$ 的数量决定。代入 $|\\mathbf{G}|^2 = (\\frac{2\\pi}{L})^2 (n_x^2 + n_y^2 + n_z^2)$，该条件变为 $(n_x^2 + n_y^2 + n_z^2) \\leq \\frac{2m_e E_{\\mathrm{cut}}}{\\hbar^2} (\\frac{L}{2\\pi})^2$。半径为 $R \\propto L \\sqrt{E_{\\mathrm{cut}}}$ 的球内的整数点 $(n_x, n_y, n_z)$ 的数量约等于该球的体积，因此 $N_{\\mathrm{PW}} \\propto (L \\sqrt{E_{\\mathrm{cut}}})^3$。\n对于固定的 $E_{\\mathrm{cut}}$，当 $L$ 减小时，平面波的数量 $N_{\\mathrm{PW}}$ *减少*。基组变得更稀疏，描述原子轨道尖锐特征（尤其是在原子核附近）的能力变差。这是一个*不完备*或*不充分*基组的问题，而不是*过完备*基组的问题。过完备基组可能导致数值问题，它是由基函数数量非常多引起的，这与这里发生的情况相反。\n**结论：不正确**\n\n**C. 即使对于中性原子，Ewald 求和的 Hartree 能量也会发散，除非引入一个补偿性的均匀背景电荷密度。**\n\n这个陈述混淆了对中性系统和带电系统的处理。周期性系统中的长程库仑相互作用由 Ewald 求和方法处理。\n1.  **中性系统：** 问题指定了一个中性原子，意味着超胞的净电荷为零（$Q_{\\mathrm{cell}}=0$）。对于中性原胞，总静电能的 Ewald 和是良定义且收敛的。不存在发散。\n2.  **带电系统：** 如果原胞带电（$Q_{\\mathrm{cell}} \\neq 0$），静电能和静电势确实会发散。在这种情况下，一个标准的补救措施是添加一个均匀的背景电荷密度 $-\\frac{Q_{\\mathrm{cell}}}{V}$ 来中和原胞，执行 Ewald 求和，然后应用校正项来消除由该背景电荷引入的假象。\n由于问题处理的是中性原子，这个问题不会出现。\n**结论：不正确**\n\n**D. 在小超胞中，静电势的任意常数偏移变得具有物理意义，并破坏了总能量的准确性。**\n\n在任何周期性计算中，静电势的平均值都不是唯一确定的；人们可以在整个空间中为电势增加任意常数 $V_0$ 而不改变物理电场 $\\mathbf{E} = -\\nabla V$。在这种偏移下，总能量的变化为 $\\Delta E = \\int_V \\rho_{\\mathrm{total}}(\\mathbf{r}) V_0 d^3\\mathbf{r} = V_0 Q_{\\mathrm{total}}$，其中 $Q_{\\mathrm{total}}$ 是原胞中的总电荷。\n对于中性系统，$Q_{\\mathrm{total}} = 0$，因此 $\\Delta E = 0$。总能量对这种偏移是不变的。这个偏移确实是任意的，不影响总能量或任何能量差。对齐电势偏移的问题仅在比较*带电*系统的总能量时才变得重要（例如，不同超胞中或不同电荷态下的带电缺陷）。对于中性系统，无论 $L$ 的大小如何，这都不是一个问题。\n**结论：不正确**\n\n**E. 即使原子是中性的，周期性镜像之间的相互作用也会引入有限尺寸误差；对于非零的多极矩，这些误差会随 $L$ 按代数形式衰减（例如，对于偶极子，按 $L^{-3}$ 衰减），而对于球对称的闭壳层原子，主要误差来自于与镜像的交换/重叠，并随 $L$ 按指数形式衰减。**\n\n这个陈述对选项 A 中提到的有限尺寸误差进行了更详细和定量的分析。这些误差有两个主要组成部分：\n1.  **静电误差：** 这是中心原胞中的电荷分布与其所有周期性镜像之间的经典静电相互作用。这种相互作用可以用多极展开来表示。如果原胞中的电荷分布具有净偶极矩 $\\mathbf{p}$，则能量中的主要误差项是偶极-偶极相互作用，其与$L^{-3}$成正比。如果 $\\mathbf{p}=0$ 但四极矩 $\\mathbf{Q}$ 不为零，则主要误差与$L^{-5}$成正比，依此类推。对于一般的非球对称原子或在晶胞中偏离中心放置的原子，这样的多极矩将会存在。这种代数衰减是正确的。\n2.  **波函数重叠误差：** 这种量子力学效应源于一个原子的 Kohn–Sham 轨道与其镜像的轨道之间的直接重叠。这导致了 A 中描述的能带形成。由于原子波函数随离核距离呈指数衰减（$\\psi(r) \\sim e^{-\\alpha r}$），相距为 $L$ 的原子之间的重叠积分也随 $L$ 呈指数衰减。因此，由此效应产生的能量误差与$\\sim e^{-\\beta L}$成正比。\n对于一个位于立方晶胞中心的球对称原子（例如，惰性气体原子）的特殊情况，根据对称性，所有多极矩均为零。在这种情况下，缓慢衰减的代数静电误差消失，剩下的主要误差是指数衰减的重叠误差。\n这个陈述准确地描述了有限尺寸误差的不同来源及其随 $L$ 的标度关系。\n**结论：正确**\n\n陈述 A 和 E 都正确描述了当 $L$ 过小时出现的问题。陈述 A 提供了定性的物理图像，而陈述 E 提供了相关能量误差的更定量的分析。两者都准确地描述了问题所在。",
            "answer": "$$\\boxed{AE}$$"
        }
    ]
}