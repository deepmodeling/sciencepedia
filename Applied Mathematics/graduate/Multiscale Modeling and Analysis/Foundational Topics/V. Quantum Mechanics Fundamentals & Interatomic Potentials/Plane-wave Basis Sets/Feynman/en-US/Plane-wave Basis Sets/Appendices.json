{
    "hands_on_practices": [
        {
            "introduction": "The kinetic energy cutoff, $E_{\\text{cut}}$, is the single most important parameter controlling the accuracy and cost of a plane-wave calculation. This exercise provides direct, hands-on practice in generating the set of reciprocal lattice vectors, $\\mathbf{G}$, that constitute the basis for a given cutoff. By implementing this procedure, you will gain a concrete understanding of how the basis set is constructed and how its size depends on both $E_{\\text{cut}}$ and the simulation cell dimensions .",
            "id": "3833123",
            "problem": "Consider an orthorhombic periodic simulation cell with side lengths $(L_x,L_y,L_z)$, where the plane-wave basis is indexed by reciprocal lattice vectors $\\mathbf{G} = \\left(G_x,G_y,G_z\\right)$ associated with integer triplets $(n_x,n_y,n_z)\\in\\mathbb{Z}^3$ via the reciprocal-space definition $G_i = \\frac{2\\pi n_i}{L_i}$ for each Cartesian direction $i\\in\\{x,y,z\\}$. Under Born–von Karman periodic boundary conditions, plane waves $\\exp\\left(i\\,\\mathbf{G}\\cdot \\mathbf{r}\\right)$ are eigenfunctions of the kinetic-energy operator $-\\frac{\\hbar^2}{2m}\\nabla^2$ for a free electron of mass $m$, with eigenvalues depending on $|\\mathbf{G}|^2$, where $\\hbar$ is the reduced Planck constant. The kinetic energy increases monotonically with $|\\mathbf{G}|^2$ and defines a natural ordering of basis functions by increasing kinetic energy.\n\nTask: For each specified test case, generate the complete set of integer triplets $(n_x,n_y,n_z)$ such that the corresponding plane-wave kinetic energy at the $\\Gamma$-point (i.e., with the crystal wavevector $\\mathbf{k}=\\mathbf{0}$) does not exceed a given energy cutoff $E_{\\mathrm{cut}}$. Then order the triplets by increasing kinetic energy; for triplets having exactly equal kinetic energy, break ties by lexicographic ordering of $(n_x,n_y,n_z)$ in ascending order. Count how many triplets satisfy the cutoff, and list them in the specified order.\n\nFundamental base for the derivation and implementation consists of the following well-tested facts:\n- The reciprocal vector components satisfy $G_i=\\frac{2\\pi n_i}{L_i}$ for each $i\\in\\{x,y,z\\}$ and $(n_x,n_y,n_z)\\in\\mathbb{Z}^3$.\n- The kinetic-energy operator for a free electron is $-\\frac{\\hbar^2}{2m}\\nabla^2$.\n- Plane waves are eigenfunctions of the Laplacian and their kinetic energy depends on $|\\mathbf{G}|^2$.\n- The ordering by increasing kinetic energy is equivalent to ordering by increasing $|\\mathbf{G}|^2$.\n\nUnits and constants:\n- Use the International System of Units (SI). Cell lengths must be in meters (m), energy cutoffs in Joules (J).\n- Use the electron rest mass $m = 9.1093837015\\times 10^{-31}$ kg and the reduced Planck constant $\\hbar = 1.054571817\\times 10^{-34}$ J·s.\n\nNumerical inclusivity and robustness:\n- A plane wave is included if its computed kinetic energy is less than or equal to $E_{\\mathrm{cut}}$. To avoid floating-point under-inclusion at equality, implement the comparison as $E \\le E_{\\mathrm{cut}}\\,(1+\\delta_{\\mathrm{rel}}) + \\delta_{\\mathrm{abs}}$, with $\\delta_{\\mathrm{rel}}=10^{-12}$ and $\\delta_{\\mathrm{abs}}=10^{-32}$ J.\n\nYour program must, for each test case, return:\n- The integer count of included triplets.\n- The ordered list of all included triplets as a list of lists $[n_x,n_y,n_z]$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is of the form $[\\,\\text{count},\\,\\text{ordered\\_triplets}\\,]$.\n\nTest suite (each tuple is $(L_x,L_y,L_z,E_{\\mathrm{cut}})$, with $L$ in meters and $E_{\\mathrm{cut}}$ in Joules):\n- Case A (general isotropic cell): $(L_x,L_y,L_z,E_{\\mathrm{cut}})=\\left(1.0\\times 10^{-9},\\,1.0\\times 10^{-9},\\,1.0\\times 10^{-9},\\,3.0\\times 10^{-19}\\right)$.\n- Case B (boundary cutoff at zero): $(L_x,L_y,L_z,E_{\\mathrm{cut}})=\\left(1.0\\times 10^{-9},\\,1.0\\times 10^{-9},\\,1.0\\times 10^{-9},\\,0\\right)$.\n- Case C (anisotropic cell): $(L_x,L_y,L_z,E_{\\mathrm{cut}})=\\left(1.0\\times 10^{-9},\\,2.0\\times 10^{-9},\\,3.0\\times 10^{-9},\\,1.0\\times 10^{-19}\\right)$.\n- Case D (degenerate shell inclusion at equality): $(L_x,L_y,L_z,E_{\\mathrm{cut}})=\\left(1.0\\times 10^{-9},\\,1.0\\times 10^{-9},\\,1.0\\times 10^{-9},\\,4.820\\times 10^{-19}\\right)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example: $[[\\text{count}_A,\\text{list}_A],[\\text{count}_B,\\text{list}_B],[\\text{count}_C,\\text{list}_C],[\\text{count}_D,\\text{list}_D]]$.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of quantum mechanics as applied to periodic systems, a cornerstone of computational materials science. The problem is well-posed, providing all necessary physical constants, mathematical definitions, and numerical tolerances to determine a unique, verifiable solution. The language is objective and the requirements are unambiguous.\n\nThe primary objective is to identify the set of plane-wave basis functions, indexed by integer triplets $(n_x, n_y, n_z)$, that satisfy a given kinetic energy cutoff, $E_{\\mathrm{cut}}$. The basis functions are considered at the $\\Gamma$-point of the Brillouin zone, corresponding to a crystal wavevector $\\mathbf{k}=\\mathbf{0}$.\n\nFirst, we establish the relationship between the kinetic energy of a plane wave and its corresponding integer triplet. The time-independent Schrödinger equation for a free electron of mass $m$ is governed by the kinetic-energy operator $\\hat{T} = -\\frac{\\hbar^2}{2m}\\nabla^2$. The plane waves, given as $\\psi_{\\mathbf{G}}(\\mathbf{r}) \\propto \\exp(i\\,\\mathbf{G}\\cdot \\mathbf{r})$, are eigenfunctions of this operator. Here, $\\mathbf{G}$ is a reciprocal lattice vector. Applying the operator yields:\n$$\n\\hat{T} \\psi_{\\mathbf{G}}(\\mathbf{r}) = -\\frac{\\hbar^2}{2m}\\nabla^2 \\exp(i\\,\\mathbf{G}\\cdot \\mathbf{r}) = -\\frac{\\hbar^2}{2m}}(i\\mathbf{G})\\cdot(i\\mathbf{G}) \\exp(i\\,\\mathbf{G}\\cdot \\mathbf{r}) = \\frac{\\hbar^2|\\mathbf{G}|^2}{2m} \\exp(i\\,\\mathbf{G}\\cdot \\mathbf{r})\n$$\nThe kinetic energy eigenvalue $E_{\\mathbf{G}}$ is therefore:\n$$\nE_{\\mathbf{G}} = \\frac{\\hbar^2|\\mathbf{G}|^2}{2m}\n$$\nFor an orthorhombic simulation cell with side lengths $(L_x, L_y, L_z)$, the components of the reciprocal lattice vector $\\mathbf{G} = (G_x, G_y, G_z)$ are defined in terms of the integer triplet $(n_x, n_y, n_z) \\in \\mathbb{Z}^3$ as $G_i = \\frac{2\\pi n_i}{L_i}$ for $i \\in \\{x, y, z\\}$. The squared magnitude $|\\mathbf{G}|^2$ is:\n$$\n|\\mathbf{G}|^2 = G_x^2 + G_y^2 + G_z^2 = \\left(\\frac{2\\pi n_x}{L_x}\\right)^2 + \\left(\\frac{2\\pi n_y}{L_y}\\right)^2 + \\left(\\frac{2\\pi n_z}{L_z}\\right)^2 = 4\\pi^2 \\left(\\frac{n_x^2}{L_x^2} + \\frac{n_y^2}{L_y^2} + \\frac{n_z^2}{L_z^2}\\right)\n$$\nSubstituting this into the energy eigenvalue expression gives the kinetic energy $E_{n_x,n_y,n_z}$ for a specific triplet:\n$$\nE_{n_x,n_y,n_z} = \\frac{\\hbar^2}{2m} \\left[ 4\\pi^2 \\left(\\frac{n_x^2}{L_x^2} + \\frac{n_y^2}{L_y^2} + \\frac{n_z^2}{L_z^2}\\right) \\right] = \\frac{2\\pi^2\\hbar^2}{m} \\left(\\frac{n_x^2}{L_x^2} + \\frac{n_y^2}{L_y^2} + \\frac{n_z^2}{L_z^2}\\right)\n$$\nThe task is to find all integer triplets $(n_x, n_y, n_z)$ such that $E_{n_x,n_y,n_z} \\le E_{\\mathrm{cut}}$. To handle floating-point precision at the boundary, this condition is implemented using a tolerance:\n$$\nE_{n_x,n_y,n_z} \\le E_{\\mathrm{cut,eff}} \\quad \\text{where} \\quad E_{\\mathrm{cut,eff}} = E_{\\mathrm{cut}}(1 + \\delta_{\\mathrm{rel}}) + \\delta_{\\mathrm{abs}}\n$$\nwith $\\delta_{\\mathrm{rel}}=10^{-12}$ and $\\delta_{\\mathrm{abs}}=10^{-32}$ J.\n\nThe algorithmic procedure to solve the problem for each test case is as follows:\n$1$. **Initialization**: For a given test case $(L_x, L_y, L_z, E_{\\mathrm{cut}})$, the effective energy cutoff $E_{\\mathrm{cut,eff}}$ is computed. The constant prefactor $C_{\\text{factor}} = \\frac{2\\pi^2\\hbar^2}{m}$ is also calculated. The condition for including a triplet becomes:\n$$\n\\frac{n_x^2}{L_x^2} + \\frac{n_y^2}{L_y^2} + \\frac{n_z^2}{L_z^2} \\le \\frac{E_{\\mathrm{cut,eff}}}{C_{\\text{factor}}}\n$$\nThis inequality describes an ellipsoid in $(n_x, n_y, n_z)$ space, which bounds the search for valid integer triplets.\n\n$2$. **Ellipsoidal Search**: An efficient search is conducted by iterating through nested loops whose bounds are dynamically constrained by the ellipsoidal condition. This avoids searching a much larger rectangular volume.\n- The maximum possible value for $|n_x|$ is found by setting $n_y=0$ and $n_z=0$: $n_{x,\\max} = \\lfloor L_x \\sqrt{E_{\\mathrm{cut,eff}} / C_{\\text{factor}}} \\rfloor$. We iterate $n_x$ from $-n_{x,\\max}$ to $n_{x,\\max}$.\n- For each $n_x$, the maximum possible value for $|n_y|$ is found by setting $n_z=0$: $n_{y,\\max}(n_x) = \\lfloor L_y \\sqrt{E_{\\mathrm{cut,eff}}/C_{\\text{factor}} - n_x^2/L_x^2} \\rfloor$. We iterate $n_y$ from $-n_{y,\\max}(n_x)$ to $n_{y,\\max}(n_x)$.\n- For each pair $(n_x, n_y)$, the maximum possible value for $|n_z|$ is: $n_{z,\\max}(n_x, n_y) = \\lfloor L_z \\sqrt{E_{\\mathrm{cut,eff}}/C_{\\text{factor}} - n_x^2/L_x^2 - n_y^2/L_y^2} \\rfloor$. We iterate $n_z$ from $-n_{z,\\max}(n_x, n_y)$ to $n_{z,\\max}(n_x, n_y)$.\nEvery triplet $(n_x, n_y, n_z)$ generated by this procedure is guaranteed to satisfy the energy cutoff condition. These valid triplets are collected.\n\n$3$. **Sorting**: The collected triplets must be sorted according to the specified criteria.\n- **Primary key**: The exact kinetic energy $E_{n_x,n_y,n_z}$ (calculated without the tolerance factors), in ascending order.\n- **Secondary key**: For triplets with degenerate (identical) energies, a tie is broken by sorting them in ascending lexicographical order of $(n_x, n_y, n_z)$.\nThis is achieved by creating a list of tuples of the form $(E_{n_x,n_y,n_z}, n_x, n_y, n_z)$ for each valid triplet and then performing a standard sort on this list.\n\n$4$. **Finalization**: After sorting, the ordered list of triplets is extracted. The final result for the test case consists of the total count of the valid triplets and the ordered list of these triplets. This process is repeated for all test cases provided.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the plane-wave basis set problem for a suite of test cases.\n    For each case, it finds all integer triplets (nx, ny, nz) whose\n    corresponding kinetic energy is below a cutoff, then sorts them\n    by energy and lexicographically.\n    \"\"\"\n\n    # --- Constants and Tolerances ---\n    # Electron rest mass in kg\n    m_e = 9.1093837015e-31\n    # Reduced Planck constant in J·s\n    hbar = 1.054571817e-34\n    # Relative and absolute tolerances for energy comparison\n    delta_rel = 1e-12\n    delta_abs = 1e-32\n\n    # --- Test Suite ---\n    # Each tuple is (Lx, Ly, Lz, E_cut) in SI units (m, J)\n    test_cases = [\n        # Case A (general isotropic cell)\n        (1.0e-9, 1.0e-9, 1.0e-9, 3.0e-19),\n        # Case B (boundary cutoff at zero)\n        (1.0e-9, 1.0e-9, 1.0e-9, 0.0),\n        # Case C (anisotropic cell)\n        (1.0e-9, 2.0e-9, 3.0e-9, 1.0e-19),\n        # Case D (degenerate shell inclusion at equality)\n        (1.0e-9, 1.0e-9, 1.0e-9, 4.820e-19),\n    ]\n\n    # List to store final results for all test cases\n    all_results = []\n\n    # --- Main Logic ---\n    # Pre-calculate the constant factor in the energy equation\n    C_factor = (2 * (np.pi**2) * (hbar**2)) / m_e\n\n    for case in test_cases:\n        Lx, Ly, Lz, E_cut = case\n\n        # Apply numerical tolerance to the energy cutoff\n        E_cut_eff = E_cut * (1 + delta_rel) + delta_abs\n        \n        # A list to store tuples of (energy, nx, ny, nz) for sorting\n        found_triplets_with_energy = []\n        \n        # Handle the E_cut < 0 case explicitly to avoid sqrt of negative\n        if E_cut_eff < 0:\n            all_results.append([0, []])\n            continue\n            \n        # Determine the search range for nx (outermost loop)\n        # We use a try-except block for sqrt(negative) arising from float precision\n        try:\n            nx_max = int(np.floor(Lx * np.sqrt(E_cut_eff / C_factor)))\n        except (ValueError, RuntimeWarning):\n            nx_max = 0\n\n        # Efficiently search the ellipsoid of valid (nx, ny, nz) triplets\n        for nx in range(-nx_max, nx_max + 1):\n            E_rem_y = E_cut_eff - C_factor * ((nx / Lx)**2)\n            if E_rem_y < 0:\n                continue\n            \n            try:\n                ny_max = int(np.floor(Ly * np.sqrt(E_rem_y / C_factor)))\n            except (ValueError, RuntimeWarning):\n                ny_max = 0\n\n            for ny in range(-ny_max, ny_max + 1):\n                E_rem_z = E_cut_eff - C_factor * (((nx / Lx)**2) + ((ny / Ly)**2))\n                if E_rem_z < 0:\n                    continue\n\n                try:\n                    nz_max = int(np.floor(Lz * np.sqrt(E_rem_z / C_factor)))\n                except (ValueError, RuntimeWarning):\n                    nz_max = 0\n                \n                for nz in range(-nz_max, nz_max + 1):\n                    # For a valid triplet, calculate its precise energy for sorting\n                    energy = C_factor * (((nx / Lx)**2) + ((ny / Ly)**2) + ((nz / Lz)**2))\n                    # The search guarantees energy <= E_cut_eff. No re-check needed.\n                    found_triplets_with_energy.append((energy, nx, ny, nz))\n        \n        # Sort the results: primary key is energy, secondary is lexicographical (nx,ny,nz)\n        found_triplets_with_energy.sort(key=lambda item: (item[0], item[1], item[2], item[3]))\n        \n        # Extract the sorted triplets, discarding the energy values\n        sorted_triplets = [[t[1], t[2], t[3]] for t in found_triplets_with_energy]\n        \n        # Get the count of found triplets\n        count = len(sorted_triplets)\n        \n        # Append the result for the current case to the main results list\n        all_results.append([count, sorted_triplets])\n\n    # Format the final output string exactly as required, removing all spaces from the string representation\n    # of the list of lists.\n    final_output = str(all_results).replace(\" \", \"\")\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "A key advantage of the plane-wave basis is its natural description of electrons in a periodic crystal. This practice delves into the nearly-free electron model to reveal the physical consequences of this periodicity. By constructing and diagonalizing a small Hamiltonian matrix, you will see precisely how a periodic potential $V(\\mathbf{r})$ couples plane-wave states and opens a band gap at the Brillouin zone boundary, a foundational concept in solid-state physics .",
            "id": "3833109",
            "problem": "An electron of mass $m$ moves in one spatial dimension under a periodic potential $V(x)=2V_{G}\\cos(Gx)$, where $G$ is the magnitude of a reciprocal lattice vector (so that the lattice spacing is $a=2\\pi/G$), and $V_{G}$ is a real constant setting the Fourier amplitude of the potential. Starting from the time-independent Schrödinger equation $-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}\\psi(x)+V(x)\\psi(x)=E\\psi(x)$ and the plane-wave basis $\\{\\exp(\\mathrm{i}kx)\\}$, use the Fourier-series representation of $V(x)$ to construct the truncated nearly-free electron Hamiltonian in the plane-wave basis $\\{|k-G\\rangle,|k\\rangle,|k+G\\rangle\\}$, retaining only couplings generated by the nonzero Fourier components of $V(x)$. Then, using this Hamiltonian, determine the energy band gap between the lowest two bands at the boundary of the first Brillouin zone (defined by $k=G/2$) within degenerate perturbation theory, assuming $|V_{G}|$ is small compared to free-electron kinetic energies away from the degeneracy. Express your final answer as a single closed-form analytic expression in terms of $V_{G}$ only. No numerical evaluation is required, and no units need be reported because the answer is symbolic.",
            "solution": "The problem requires the determination of the energy band gap at the first Brillouin zone boundary for a one-dimensional nearly-free electron model with a specific periodic potential.\n\nFirst, we validate the problem statement.\n\n### Step 1: Extract Givens\n- Electron mass: $m$\n- Spatial dimension: $1$\n- Periodic potential: $V(x) = 2V_{G}\\cos(Gx)$\n- Reciprocal lattice vector magnitude: $G$\n- Lattice spacing: $a=2\\pi/G$\n- Potential Fourier amplitude: $V_{G}$ is a real constant\n- Time-independent Schrödinger equation (TISE): $-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}\\psi(x)+V(x)\\psi(x)=E\\psi(x)$\n- Basis set for truncation: $\\{|k-G\\rangle,|k\\rangle,|k+G\\rangle\\}$, which corresponds to plane waves $\\{\\exp(\\mathrm{i}(k-G)x), \\exp(\\mathrm{i}kx), \\exp(\\mathrm{i}(k+G)x)\\}$\n- Point of interest: boundary of the first Brillouin zone, $k=G/2$\n- Method: degenerate perturbation theory\n- Assumption: $|V_{G}|$ is small compared to free-electron kinetic energies away from the degeneracy.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem describes the nearly-free electron model, a fundamental concept in solid-state physics used to explain electronic band structures. It utilizes the Schrödinger equation, Fourier analysis, and perturbation theory, all of which are standard, well-established theoretical tools. The potential $V(x) = 2V_{G}\\cos(Gx)$ is a canonical example of a simple periodic potential. The problem is scientifically sound.\n- **Well-Posed:** All necessary information is provided. The potential, the basis set, the Hamiltonian, the specific point in k-space ($k=G/2$), and the theoretical framework (degenerate perturbation theory) are explicitly defined. This allows for the derivation of a unique, meaningful solution for the band gap.\n- **Objective:** The problem is stated in precise, formal, and unbiased language, free from any subjective or speculative content.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically grounded, well-posed, and objective. I will now proceed with the solution.\n\nThe Hamiltonian operator is $H = T + V$, where $T = -\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}$ is the kinetic energy operator and $V(x)$ is the potential energy operator. We need to find the matrix representation of $H$ in the given basis $\\{|k-G\\rangle, |k\\rangle, |k+G\\rangle\\}$. Let's denote the basis states as $|1\\rangle = |k-G\\rangle$, $|2\\rangle = |k\\rangle$, and $|3\\rangle = |k+G\\rangle$. The matrix elements are $H_{ij} = \\langle i | H | j \\rangle$.\n\nThe kinetic energy operator $T$ is diagonal in the plane-wave basis. A plane wave $|\\kappa\\rangle = \\exp(\\mathrm{i}\\kappa x)$ is an eigenstate of $T$ with eigenvalue $E_{\\kappa}^{0} = \\frac{\\hbar^{2}\\kappa^{2}}{2m}$. Therefore, the kinetic part of the Hamiltonian matrix is:\n$$\n\\mathbf{T} = \n\\begin{pmatrix}\n\\frac{\\hbar^{2}(k-G)^{2}}{2m} & 0 & 0 \\\\\n0 & \\frac{\\hbar^{2}k^{2}}{2m} & 0 \\\\\n0 & 0 & \\frac{\\hbar^{2}(k+G)^{2}}{2m}\n\\end{pmatrix}\n$$\n\nNext, we evaluate the matrix elements of the potential $V(x)$. The potential is given by $V(x) = 2V_{G}\\cos(Gx)$. We can express this using complex exponentials:\n$$\nV(x) = 2V_{G} \\left(\\frac{\\exp(\\mathrm{i}Gx) + \\exp(-\\mathrm{i}Gx)}{2}\\right) = V_{G}\\exp(\\mathrm{i}Gx) + V_{G}\\exp(-\\mathrm{i}Gx)\n$$\nThe matrix element $V_{ij} = \\langle k_i | V(x) | k_j \\rangle$ is given by the integral (ignoring normalization factors which cancel):\n$$\nV_{ij} \\propto \\int V(x) \\exp(-\\mathrm{i}k_i x) \\exp(\\mathrm{i}k_j x) dx = \\int V(x) \\exp(\\mathrm{i}(k_j - k_i)x) dx\n$$\nThis integral is proportional to the Fourier coefficient of $V(x)$ at the wavevector $q = k_i - k_j$. From the form of $V(x)$, the only non-zero Fourier coefficients correspond to $q = G$ and $q = -G$, and both are equal to $V_{G}$ (since $V_G$ is real).\nLet's compute the elements of the potential matrix $\\mathbf{V}$:\n- Diagonal elements: $V_{11}$, $V_{22}$, $V_{33}$ correspond to $q = 0$. Since the $q=0$ Fourier component of $V(x)$ is zero, these elements are zero.\n- Off-diagonal elements:\n    - $V_{12} = \\langle k-G | V | k \\rangle$: The wavevector difference is $k - (k-G) = G$. The Fourier coefficient is $V_G$.\n    - $V_{21} = \\langle k | V | k-G \\rangle$: The wavevector difference is $(k-G) - k = -G$. The Fourier coefficient is $V_{-G} = V_G$.\n    - $V_{23} = \\langle k | V | k+G \\rangle$: The wavevector difference is $(k+G) - k = G$. The Fourier coefficient is $V_G$.\n    - $V_{32} = \\langle k+G | V | k \\rangle$: The wavevector difference is $k - (k+G) = -G$. The Fourier coefficient is $V_{-G} = V_G$.\n    - $V_{13} = \\langle k-G | V | k+G \\rangle$: The wavevector difference is $(k+G) - (k-G) = 2G$. The corresponding Fourier coefficient is zero.\n    - $V_{31} = \\langle k+G | V | k-G \\rangle$: The wavevector difference is $(k-G) - (k+G) = -2G$. The corresponding Fourier coefficient is zero.\n\nSo, the potential matrix is:\n$$\n\\mathbf{V} = \n\\begin{pmatrix}\n0 & V_{G} & 0 \\\\\nV_{G} & 0 & V_{G} \\\\\n0 & V_{G} & 0\n\\end{pmatrix}\n$$\n\nThe full Hamiltonian matrix $\\mathbf{H} = \\mathbf{T} + \\mathbf{V}$ is:\n$$\n\\mathbf{H} = \n\\begin{pmatrix}\n\\frac{\\hbar^{2}(k-G)^{2}}{2m} & V_{G} & 0 \\\\\nV_{G} & \\frac{\\hbar^{2}k^{2}}{2m} & V_{G} \\\\\n0 & V_{G} & \\frac{\\hbar^{2}(k+G)^{2}}{2m}\n\\end{pmatrix}\n$$\n\nThe problem asks for the band gap at the boundary of the first Brillouin zone, which occurs at $k=G/2$. At this point, the unperturbed free-electron energies (the diagonal elements of $\\mathbf{H}$) are:\n- $E_{k-G}^{0} = \\frac{\\hbar^{2}(G/2-G)^{2}}{2m} = \\frac{\\hbar^{2}(-G/2)^{2}}{2m} = \\frac{\\hbar^{2}G^{2}}{8m}$\n- $E_{k}^{0} = \\frac{\\hbar^{2}(G/2)^{2}}{2m} = \\frac{\\hbar^{2}G^{2}}{8m}$\n- $E_{k+G}^{0} = \\frac{\\hbar^{2}(G/2+G)^{2}}{2m} = \\frac{\\hbar^{2}(3G/2)^{2}}{2m} = \\frac{9\\hbar^{2}G^{2}}{8m}$\n\nWe observe that the unperturbed states $|k-G\\rangle = |-G/2\\rangle$ and $|k\\rangle = |G/2\\rangle$ are degenerate in energy: $E_{-G/2}^{0} = E_{G/2}^{0} = \\frac{\\hbar^{2}G^{2}}{8m}$. The state $|k+G\\rangle = |3G/2\\rangle$ has a much higher energy and is not part of this degeneracy.\n\nAccording to degenerate perturbation theory, we must diagonalize the Hamiltonian within the degenerate subspace spanned by $\\{|k-G\\rangle, |k\\rangle\\}$. The relevant $2\\times2$ submatrix of $\\mathbf{H}$ at $k=G/2$ is:\n$$\n\\mathbf{H}_{\\text{deg}} = \n\\begin{pmatrix}\n\\frac{\\hbar^{2}G^{2}}{8m} & V_{G} \\\\\nV_{G} & \\frac{\\hbar^{2}G^{2}}{8m}\n\\end{pmatrix}\n$$\nTo find the energy eigenvalues $E$, we solve the characteristic equation $\\det(\\mathbf{H}_{\\text{deg}} - E\\mathbf{I}) = 0$:\n$$\n\\det \\begin{pmatrix}\n\\frac{\\hbar^{2}G^{2}}{8m} - E & V_{G} \\\\\nV_{G} & \\frac{\\hbar^{2}G^{2}}{8m} - E\n\\end{pmatrix} = 0\n$$\n$$\n\\left(\\frac{\\hbar^{2}G^{2}}{8m} - E\\right)^{2} - V_{G}^{2} = 0\n$$\n$$\n\\frac{\\hbar^{2}G^{2}}{8m} - E = \\pm \\sqrt{V_G^2} = \\pm |V_{G}|\n$$\nThis gives two energy eigenvalues, which are the energies of the states at the Brillouin zone boundary after the perturbation has been applied:\n$$\nE_{\\pm} = \\frac{\\hbar^{2}G^{2}}{8m} \\pm |V_{G}|\n$$\nThe perturbation lifts the degeneracy, splitting the single energy level into two. The lower energy, $E_{-} = \\frac{\\hbar^{2}G^{2}}{8m} - |V_{G}|$, corresponds to the top of the first (lowest) energy band. The higher energy, $E_{+} = \\frac{\\hbar^{2}G^{2}}{8m} + |V_{G}|$, corresponds to the bottom of the second energy band.\n\nThe energy band gap, $E_g$, is the difference between these two energy levels:\n$$\nE_g = E_{+} - E_{-} = \\left(\\frac{\\hbar^{2}G^{2}}{8m} + |V_{G}|\\right) - \\left(\\frac{\\hbar^{2}G^{2}}{8m} - |V_{G}|\\right)\n$$\n$$\nE_g = |V_{G}| - (-|V_{G}|) = 2|V_{G}|\n$$\nThe final answer is expressed solely in terms of the given parameter $V_G$. The absolute value is necessary because an energy gap is a non-negative quantity, and $V_G$ is defined only as a real constant, which could be negative.",
            "answer": "$$\\boxed{2|V_{G}|}$$"
        },
        {
            "introduction": "Modern plane-wave codes owe their efficiency to the dual-space approach, where the kinetic and potential energy operators are applied in the domains where they are diagonal—reciprocal and real space, respectively. The Fast Fourier Transform (FFT) is the bridge between these two domains. This exercise guides you through the crucial task of determining the minimum real-space grid density required to represent the electronic charge density accurately, thereby avoiding the numerical artifact known as aliasing or wrap-around error .",
            "id": "3833072",
            "problem": "Consider an orthorhombic periodic simulation cell with real-space edge lengths $L_x$, $L_y$, and $L_z$, and a plane-wave basis set for electronic wavefunctions truncated at a kinetic energy cutoff $E_{\\mathrm{cut}}$ (in Hartree atomic units). The charge density is formed from products of the wavefunctions and evaluated on a three-dimensional Fast Fourier Transform (FFT) grid of dimensions $(N_x,N_y,N_z)$. Using only fundamental definitions of Fourier transforms, the Nyquist-Shannon sampling theorem, and the kinetic energy of a plane wave in atomic units, determine whether aliasing (wrap-around) errors will occur in forming the charge density, and compute the minimal integer grid dimensions that avoid such errors along each Cartesian axis.\n\nAssume the following:\n- The kinetic energy of a plane wave with wavevector $\\mathbf{G}$ is $E_{\\mathrm{kin}}(\\mathbf{G}) = \\frac{1}{2}|\\mathbf{G}|^{2}$ in Hartree atomic units.\n- The wavefunction plane-wave basis includes all $\\mathbf{G}$ with $|\\mathbf{G}| \\leq G_{\\mathrm{cut}}$ implied by $E_{\\mathrm{cut}}$.\n- The orthorhombic cell has edge lengths $L_x = 8$ bohr, $L_y = 10$ bohr, and $L_z = 12$ bohr.\n- The FFT grid dimensions are $(N_x,N_y,N_z) = (36,48,64)$.\n\nYour task:\n1. Derive from first principles a criterion that guarantees the absence of aliasing when sampling the charge density on the FFT grid, expressed as a condition relating $(N_x,N_y,N_z)$, $(L_x,L_y,L_z)$, and $E_{\\mathrm{cut}}$.\n2. Using $E_{\\mathrm{cut}} = 30$ Hartree, evaluate whether aliasing will occur with the given $(N_x,N_y,N_z)$.\n3. Compute the minimal integer triple $(N_x',N_y',N_z')$ that avoids aliasing along each axis under these conditions.\n\nExpress your final answer as a single row matrix containing the triple $(N_x',N_y',N_z')$. No rounding instruction is required beyond choosing the smallest integers that satisfy the derived criterion. Do not include any units in your final answer.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. It is a standard problem in computational materials science. Therefore, the problem is deemed valid and a full solution can be constructed.\n\nThe solution is developed in three parts as requested: first, a derivation of the general criterion for avoiding aliasing; second, an evaluation of the given setup against this criterion; and third, the calculation of the minimal grid dimensions required.\n\n### 1. Derivation of the Aliasing Criterion\n\nLet the orthorhombic simulation cell be defined by real-space lattice vectors of lengths $L_x$, $L_y$, and $L_z$ along the Cartesian axes. The corresponding primitive reciprocal lattice vectors are $\\mathbf{b}_1 = (2\\pi/L_x, 0, 0)$, $\\mathbf{b}_2 = (0, 2\\pi/L_y, 0)$, and $\\mathbf{b}_3 = (0, 0, 2\\pi/L_z)$. Any reciprocal lattice vector $\\mathbf{G}$ is an integer linear combination of these primitive vectors: $\\mathbf{G} = n_x \\mathbf{b}_1 + n_y \\mathbf{b}_2 + n_z \\mathbf{b}_3$, where $n_x, n_y, n_z$ are integers.\n\nAn electronic wavefunction $\\psi(\\mathbf{r})$ within the cell is expanded in a plane-wave basis set:\n$$ \\psi(\\mathbf{r}) = \\sum_{\\mathbf{G}} c_{\\mathbf{G}} e^{i\\mathbf{G}\\cdot\\mathbf{r}} $$\nThe basis set is truncated by a kinetic energy cutoff $E_{\\mathrm{cut}}$, such that only plane waves with a kinetic energy less than or equal to $E_{\\mathrm{cut}}$ are included. The kinetic energy of a plane wave with wavevector $\\mathbf{G}$ is given as $E_{\\mathrm{kin}}(\\mathbf{G}) = \\frac{1}{2}|\\mathbf{G}|^2$ in Hartree atomic units. This imposes a condition on the magnitude of the included wavevectors:\n$$ \\frac{1}{2}|\\mathbf{G}|^2 \\leq E_{\\mathrm{cut}} \\implies |\\mathbf{G}| \\leq \\sqrt{2E_{\\mathrm{cut}}} \\equiv G_{\\mathrm{cut}} $$\nThus, the sum for the wavefunction is restricted to all $\\mathbf{G}$ vectors lying within a sphere of radius $G_{\\mathrm{cut}}$ in reciprocal space.\n\nThe charge density $\\rho(\\mathbf{r})$ is constructed from products of wavefunctions. For a single orbital, the density is $\\rho_{\\psi}(\\mathbf{r}) = \\psi^*(\\mathbf{r})\\psi(\\mathbf{r})$.\n$$ \\rho(\\mathbf{r}) = \\left( \\sum_{\\mathbf{G'}} c_{\\mathbf{G'}}^{*} e^{-i\\mathbf{G'}\\cdot\\mathbf{r}} \\right) \\left( \\sum_{\\mathbf{G}} c_{\\mathbf{G}} e^{i\\mathbf{G}\\cdot\\mathbf{r}} \\right) = \\sum_{\\mathbf{G}, \\mathbf{G'}} c_{\\mathbf{G}} c_{\\mathbf{G'}}^{*} e^{i(\\mathbf{G}-\\mathbf{G'})\\cdot\\mathbf{r}} $$\nThis expression is a Fourier series for the charge density. Let $\\mathbf{K} = \\mathbf{G} - \\mathbf{G'}$. The density can be written as:\n$$ \\rho(\\mathbf{r}) = \\sum_{\\mathbf{K}} \\rho_{\\mathbf{K}} e^{i\\mathbf{K}\\cdot\\mathbf{r}} $$\nwhere $\\rho_{\\mathbf{K}}$ are the Fourier coefficients of the density. A non-zero coefficient $\\rho_{\\mathbf{K}}$ exists only if $\\mathbf{K}$ can be expressed as a difference $\\mathbf{G} - \\mathbf{G'}$ where both $|\\mathbf{G}| \\leq G_{\\mathrm{cut}}$ and $|\\mathbf{G'}| \\leq G_{\\mathrm{cut}}$.\n\nUsing the triangle inequality, we can find the maximum magnitude of a wavevector $\\mathbf{K}$ in the density expansion:\n$$ |\\mathbf{K}| = |\\mathbf{G} - \\mathbf{G'}| \\leq |\\mathbf{G}| + |-\\mathbf{G'}| = |\\mathbf{G}| + |\\mathbf{G'}| \\leq G_{\\mathrm{cut}} + G_{\\mathrm{cut}} = 2G_{\\mathrm{cut}} $$\nThis means that all Fourier components of the charge density are contained within a sphere of radius $2G_{\\mathrm{cut}}$ in reciprocal space.\n\nThe charge density is evaluated on a discrete Fast Fourier Transform (FFT) grid of dimensions $(N_x, N_y, N_z)$. For the $x$-dimension, this grid consists of $N_x$ points with a spacing of $\\Delta x = L_x/N_x$. According to the Nyquist-Shannon sampling theorem, to represent a signal without aliasing (wrap-around error), the sampling frequency must be at least twice the highest frequency present in the signal. In terms of wavevectors, the magnitude of the highest wavevector component must be less than or equal to the Nyquist wavevector of the grid.\n\nFor a real-space grid with spacing $\\Delta x = L_x/N_x$, the corresponding FFT in reciprocal space can represent wavevector components up to a maximum (the Nyquist limit) of:\n$$ k_{x, \\mathrm{Nyquist}} = \\frac{\\pi}{\\Delta x} = \\frac{\\pi N_x}{L_x} $$\nTo avoid aliasing, the maximum wavevector component of the density, $K_{x, \\mathrm{max}}$, must satisfy $|K_{x, \\mathrm{max}}| \\leq k_{x, \\mathrm{Nyquist}}$. The maximum possible $x$-component of a vector $\\mathbf{K}$ within the sphere $|\\mathbf{K}| \\leq 2G_{\\mathrm{cut}}$ is $2G_{\\mathrm{cut}}$. Therefore, the condition to prevent aliasing along the $x$-axis is:\n$$ 2G_{\\mathrm{cut}} \\leq \\frac{\\pi N_x}{L_x} $$\nRearranging for $N_x$ and substituting $G_{\\mathrm{cut}} = \\sqrt{2E_{\\mathrm{cut}}}$, we obtain the general criterion for each Cartesian axis $i \\in \\{x, y, z\\}$:\n$$ N_i \\ge \\frac{2L_i G_{\\mathrm{cut}}}{\\pi} = \\frac{2L_i \\sqrt{2E_{\\mathrm{cut}}}}{\\pi} $$\nThis condition guarantees that the FFT grid is fine enough to represent the charge density without aliasing errors.\n\n### 2. Evaluation of Aliasing for the Given Parameters\n\nWe are given:\n- $E_{\\mathrm{cut}} = 30$ Hartree\n- $L_x = 8$ bohr, $L_y = 10$ bohr, $L_z = 12$ bohr\n- FFT grid $(N_x, N_y, N_z) = (36, 48, 64)$\n\nFirst, we compute the cutoff wavevector $G_{\\mathrm{cut}}$:\n$$ G_{\\mathrm{cut}} = \\sqrt{2E_{\\mathrm{cut}}} = \\sqrt{2 \\times 30} = \\sqrt{60} \\text{ bohr}^{-1} $$\nNow we calculate the minimum required grid points ($N'_{i}$) for each axis using the derived criterion and check if the given $N_i$ are sufficient.\nMinimum for $x$-axis:\n$$ N_x' = \\frac{2 L_x \\sqrt{60}}{\\pi} = \\frac{2 \\times 8 \\times \\sqrt{60}}{\\pi} = \\frac{16\\sqrt{60}}{\\pi} \\approx 39.45 $$\nThe given grid has $N_x = 36$. Since $36 < 39.45$, the grid is insufficient, and aliasing will occur along the $x$-axis.\n\nMinimum for $y$-axis:\n$$ N_y' = \\frac{2 L_y \\sqrt{60}}{\\pi} = \\frac{2 \\times 10 \\times \\sqrt{60}}{\\pi} = \\frac{20\\sqrt{60}}{\\pi} \\approx 49.31 $$\nThe given grid has $N_y = 48$. Since $48 < 49.31$, the grid is insufficient, and aliasing will also occur along the $y$-axis.\n\nMinimum for $z$-axis:\n$$ N_z' = \\frac{2 L_z \\sqrt{60}}{\\pi} = \\frac{2 \\times 12 \\times \\sqrt{60}}{\\pi} = \\frac{24\\sqrt{60}}{\\pi} \\approx 59.17 $$\nThe given grid has $N_z = 64$. Since $64 > 59.17$, the grid is sufficient along the $z$-axis.\n\nBecause the FFT grid dimensions are insufficient along the $x$ and $y$ axes, aliasing errors will contaminate the calculation of the charge density.\n\n### 3. Computation of Minimal Grid Dimensions\n\nTo avoid aliasing, the number of grid points along each axis must be an integer greater than or equal to the minimum values calculated above. We find the minimal integer dimensions $(N_x', N_y', N_z')$ by taking the ceiling of each required value.\n\nMinimal $N_x'$:\n$$ N_x' = \\lceil \\frac{16\\sqrt{60}}{\\pi} \\rceil = \\lceil 39.45 \\rceil = 40 $$\nMinimal $N_y'$:\n$$ N_y' = \\lceil \\frac{20\\sqrt{60}}{\\pi} \\rceil = \\lceil 49.31 \\rceil = 50 $$\nMinimal $N_z'$:\n$$ N_z' = \\lceil \\frac{24\\sqrt{60}}{\\pi} \\rceil = \\lceil 59.17 \\rceil = 60 $$\nTherefore, the minimal integer grid dimensions that avoid aliasing errors under the given conditions are $(40, 50, 60)$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 40 & 50 & 60 \\end{pmatrix}}$$"
        }
    ]
}