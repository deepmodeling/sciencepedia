{
    "hands_on_practices": [
        {
            "introduction": "In many molecular systems, the behavior is dominated by the interaction between just a few quantum states. This exercise explores the fundamental principle of \"avoided crossing\" using a simple yet powerful two-level model. By diagonalizing the Hamiltonian of two coupled states, you will derive how their interaction prevents their energy levels from becoming degenerate, forcing them to repel each other. This phenomenon is a cornerstone for understanding potential energy surfaces and non-adiabatic transitions in chemistry and materials science .",
            "id": "3770498",
            "problem": "Consider a two-level subsystem that emerges as the effective quantum mechanical description of a multiscale model near a conical intersection of two adiabatic energy surfaces. Let a slow control parameter $x$ represent the coarse-grained state of the environment, and suppose that, within a local window near $x=x_{0}$, the uncoupled diabatic energies are well-approximated by the linearizations $E_{1}(x)=E_{0}+\\alpha\\,(x-x_{0})$ and $E_{2}(x)=E_{0}-\\beta\\,(x-x_{0})$, where $E_{0}$, $\\alpha$, and $\\beta$ are real constants with $\\alpha0$ and $\\beta0$. A nonzero real constant coupling $\\,\\Delta\\,$ mixes the two diabatic states, leading to the $2\\times 2$ Hermitian Hamiltonian\n$$\nH(x)=\\begin{pmatrix}\nE_{1}(x)  \\Delta \\\\\n\\Delta  E_{2}(x)\n\\end{pmatrix}.\n$$\nStarting only from the time-independent Schrödinger equation $H(x)\\,\\psi=\\varepsilon(x)\\,\\psi$ and the properties of Hermitian operators, perform the following steps:\n1. Derive the exact expressions for the two eigenvalues $\\varepsilon_{+}(x)$ and $\\varepsilon_{-}(x)$ of $H(x)$.\n2. Using these expressions, explain why two quasi-degenerate levels (that is, $E_{1}(x)\\approx E_{2}(x)$) do not cross when $\\Delta\\neq 0$, thereby demonstrating the avoided crossing phenomenon in this model.\n3. Define the level repulsion as the minimum value, over all real $x$, of the energy gap $\\varepsilon_{+}(x)-\\varepsilon_{-}(x)$, and compute this minimum exactly as a closed-form symbolic expression in terms of $\\Delta$.\n\nProvide only the final symbolic expression for the level repulsion as your answer. No numerical evaluation is required, and no units are required for the final expression.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- A two-level quantum subsystem is described by a $2\\times 2$ Hermitian Hamiltonian $H(x)$.\n- $x$ is a slow control parameter.\n- The uncoupled diabatic energies near a point $x_{0}$ are approximated by linear functions: $E_{1}(x)=E_{0}+\\alpha\\,(x-x_{0})$ and $E_{2}(x)=E_{0}-\\beta\\,(x-x_{0})$.\n- $E_{0}$, $\\alpha$, and $\\beta$ are real constants.\n- The constraints on the constants are $\\alpha0$ and $\\beta0$.\n- A nonzero real constant coupling $\\Delta$ mixes the diabatic states.\n- The Hamiltonian matrix is given by $H(x)=\\begin{pmatrix} E_{1}(x)  \\Delta \\\\ \\Delta  E_{2}(x) \\end{pmatrix}$.\n- The governing equation is the time-independent Schrödinger equation, $H(x)\\,\\psi=\\varepsilon(x)\\,\\psi$, where $\\varepsilon(x)$ represents the eigenvalues.\n- The problem asks for three tasks: (1) derive the eigenvalues $\\varepsilon_{\\pm}(x)$, (2) explain the avoided crossing phenomenon for $\\Delta \\neq 0$, and (3) compute the level repulsion, defined as the minimum value of the energy gap $\\varepsilon_{+}(x) - \\varepsilon_{-}(x)$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem describes a Landau-Zener-type two-level system, which is a fundamental and canonical model in quantum mechanics and quantum chemistry. It is used to describe a vast range of phenomena, including charge transfer, non-adiabatic transitions, and, as mentioned, behavior near conical intersections. The description is entirely consistent with established physical principles.\n- **Well-Posed:** The problem is mathematically well-posed. It requires finding the eigenvalues of a $2 \\times 2$ matrix and then finding the minimum of a function derived from these eigenvalues. These are standard procedures in linear algebra and calculus, which yield a unique and meaningful solution.\n- **Objective:** The problem is stated using precise, standard, and objective terminology from physics and mathematics. There are no subjective or ambiguous statements.\n- **Completeness and Consistency:** All necessary information is provided. The functional forms, constants, and constraints are explicitly defined. There are no contradictions in the setup. The condition $\\Delta \\neq 0$ is critical and is used consistently.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a standard, well-posed problem grounded in fundamental quantum mechanics. I will proceed with the solution.\n\n**Solution Derivation**\n\nThe solution proceeds by following the three steps outlined in the problem statement.\n\n**1. Derivation of the Eigenvalues $\\varepsilon(x)$**\n\nThe eigenvalues $\\varepsilon(x)$ of the Hamiltonian $H(x)$ are found by solving the characteristic equation, $\\det(H(x) - \\varepsilon I) = 0$, where $I$ is the $2 \\times 2$ identity matrix.\n\nThe matrix $H(x) - \\varepsilon I$ is:\n$$\nH(x) - \\varepsilon I = \\begin{pmatrix}\nE_{1}(x) - \\varepsilon  \\Delta \\\\\n\\Delta  E_{2}(x) - \\varepsilon\n\\end{pmatrix}\n$$\nIts determinant is:\n$$\n\\det(H(x) - \\varepsilon I) = (E_{1}(x) - \\varepsilon)(E_{2}(x) - \\varepsilon) - \\Delta^{2} = 0\n$$\nExpanding this equation gives a quadratic equation for the eigenvalue $\\varepsilon$:\n$$\n\\varepsilon^{2} - (E_{1}(x) + E_{2}(x))\\varepsilon + E_{1}(x)E_{2}(x) - \\Delta^{2} = 0\n$$\nWe solve for $\\varepsilon$ using the quadratic formula:\n$$\n\\varepsilon = \\frac{(E_{1}(x) + E_{2}(x)) \\pm \\sqrt{(-(E_{1}(x) + E_{2}(x)))^{2} - 4(1)(E_{1}(x)E_{2}(x) - \\Delta^{2})}}{2}\n$$\n$$\n\\varepsilon = \\frac{E_{1}(x) + E_{2}(x)}{2} \\pm \\frac{1}{2} \\sqrt{(E_{1}(x) + E_{2}(x))^{2} - 4E_{1}(x)E_{2}(x) + 4\\Delta^{2}}\n$$\nThe term under the square root can be simplified using the algebraic identity $(a+b)^{2} - 4ab = (a-b)^{2}$:\n$$\n\\varepsilon = \\frac{E_{1}(x) + E_{2}(x)}{2} \\pm \\frac{1}{2} \\sqrt{(E_{1}(x) - E_{2}(x))^{2} + 4\\Delta^{2}}\n$$\nThis gives the two eigenvalues, which we label $\\varepsilon_{+}(x)$ and $\\varepsilon_{-}(x)$:\n$$\n\\varepsilon_{\\pm}(x) = \\frac{E_{1}(x) + E_{2}(x)}{2} \\pm \\frac{1}{2} \\sqrt{(E_{1}(x) - E_{2}(x))^{2} + 4\\Delta^{2}}\n$$\nWe can substitute the given expressions for $E_{1}(x)$ and $E_{2}(x)$:\n$E_{1}(x) = E_{0}+\\alpha(x-x_{0})$\n$E_{2}(x) = E_{0}-\\beta(x-x_{0})$\nThe sum and difference are:\n$E_{1}(x) + E_{2}(x) = 2E_{0} + (\\alpha-\\beta)(x-x_{0})$\n$E_{1}(x) - E_{2}(x) = (\\alpha+\\beta)(x-x_{0})$\nSubstituting these into the eigenvalue expression yields the full form:\n$$\n\\varepsilon_{\\pm}(x) = E_{0} + \\frac{\\alpha-\\beta}{2}(x-x_{0}) \\pm \\frac{1}{2} \\sqrt{((\\alpha+\\beta)(x-x_{0}))^2 + 4\\Delta^2}\n$$\n\n**2. Explanation of the Avoided Crossing**\n\nAn energy level crossing occurs if the two energy levels become degenerate at some value of the parameter $x$, meaning $\\varepsilon_{+}(x) = \\varepsilon_{-}(x)$. This is equivalent to the energy gap between the levels being zero: $\\varepsilon_{+}(x) - \\varepsilon_{-}(x) = 0$.\n\nFrom the derived expression for the eigenvalues, the energy gap $\\Delta\\varepsilon(x)$ is:\n$$\n\\Delta\\varepsilon(x) = \\varepsilon_{+}(x) - \\varepsilon_{-}(x) = \\sqrt{(E_{1}(x) - E_{2}(x))^{2} + 4\\Delta^{2}}\n$$\nFor a crossing to occur, we must have $\\Delta\\varepsilon(x)=0$, which implies:\n$$\n(E_{1}(x) - E_{2}(x))^{2} + 4\\Delta^{2} = 0\n$$\nSince $E_{1}(x)$, $E_{2}(x)$, and $\\Delta$ are all real, the terms $(E_{1}(x) - E_{2}(x))^{2}$ and $4\\Delta^{2}$ are both non-negative. The sum of two non-negative terms can only be zero if both terms are individually zero. This requires two conditions to be met simultaneously:\n1. $(E_{1}(x) - E_{2}(x))^{2} = 0 \\implies E_{1}(x) = E_{2}(x)$\n2. $4\\Delta^{2} = 0 \\implies \\Delta = 0$\n\nThe problem statement specifies that the coupling $\\Delta$ is a *nonzero* real constant. Therefore, the second condition, $\\Delta=0$, is never met. Since $4\\Delta^{2}$ is strictly positive, the energy gap $\\Delta\\varepsilon(x) = \\sqrt{(E_{1}(x) - E_{2}(x))^{2} + 4\\Delta^{2}}$ is always strictly greater than zero for all real $x$.\nThe energy levels can approach each other, but they can never become degenerate. This phenomenon, where a nonzero coupling term prevents the energy levels from crossing, is known as the avoided crossing. The diabatic levels $E_1(x)$ and $E_2(x)$, which would cross at $x=x_0$ if $\\Delta$ were zero, are \"repelled\" from each other by the coupling.\n\n**3. Computation of the Level Repulsion**\n\nThe level repulsion is defined as the minimum value of the energy gap $\\Delta\\varepsilon(x)$ over all real $x$. We need to find:\n$$\n\\min_{x \\in \\mathbb{R}} \\left( \\Delta\\varepsilon(x) \\right) = \\min_{x \\in \\mathbb{R}} \\left( \\sqrt{((\\alpha+\\beta)(x-x_{0}))^2 + 4\\Delta^2} \\right)\n$$\nThe square root function $\\sqrt{y}$ is a strictly increasing function for $y \\ge 0$. Therefore, minimizing $\\Delta\\varepsilon(x)$ is equivalent to minimizing its argument (the expression under the square root). Let $f(x) = ((\\alpha+\\beta)(x-x_{0}))^2 + 4\\Delta^2$.\n\nThe term $4\\Delta^{2}$ is a positive constant. The term $((\\alpha+\\beta)(x-x_{0}))^2$ depends on $x$. Since $\\alpha  0$ and $\\beta  0$, their sum $\\alpha+\\beta$ is a positive constant. The expression $((\\alpha+\\beta)(x-x_{0}))^2$ is the square of a real number, so its value is always non-negative.\nThe minimum value of $((\\alpha+\\beta)(x-x_{0}))^2$ is $0$, which occurs when its base is zero:\n$$\n(\\alpha+\\beta)(x-x_{0}) = 0\n$$\nSince $\\alpha+\\beta  0$, this minimum occurs precisely at $x = x_{0}$.\n\nAt this point $x=x_0$, the function $f(x)$ attains its minimum value:\n$$\nf_{\\min} = f(x_{0}) = ((\\alpha+\\beta)(x_{0}-x_{0}))^2 + 4\\Delta^2 = 0 + 4\\Delta^2 = 4\\Delta^2\n$$\nThe minimum value of the energy gap, the level repulsion, is the square root of this minimum value:\n$$\n\\text{Level Repulsion} = \\sqrt{f_{\\min}} = \\sqrt{4\\Delta^2}\n$$\nSince $\\Delta$ is a real number, $\\Delta^2 \\ge 0$. The square root of $4\\Delta^2$ is conventionally the positive root, which is $|2\\Delta|$. As an energy gap, level repulsion is a positive-definite quantity.\n$$\n\\text{Level Repulsion} = 2|\\Delta|\n$$\nThe problem asks for this value as a symbolic expression in terms of $\\Delta$.",
            "answer": "$$\\boxed{2|\\Delta|}$$"
        },
        {
            "introduction": "Multiscale methods like QM/MM are built on the idea of partitioning a large system into a quantum subsystem and a classical environment. This raises a crucial question: how do we mathematically describe the state of the subsystem alone? This practice introduces the concept of the reduced density operator, which is obtained by \"tracing out\" the environmental degrees of freedom. By working through the canonical example of a maximally entangled Bell state, you will see how a subsystem can be in a mixed state with quantifiable entropy, even when the composite system is in a pure state, a direct consequence of quantum entanglement .",
            "id": "3770460",
            "problem": "In multiscale modeling, an open quantum subsystem is obtained by coarse-graining a composite system through the partial trace over environmental degrees of freedom. Consider a bipartite system composed of a subsystem $S$ and an environment $E$, each a two-level system with Hilbert space $\\mathcal{H}_{S} \\cong \\mathbb{C}^{2}$ and $\\mathcal{H}_{E} \\cong \\mathbb{C}^{2}$. Let the composite system $SE$ be prepared in the pure Bell state\n$$\n|\\Phi^{+}\\rangle = \\frac{1}{\\sqrt{2}}\\big(|0\\rangle_{S}\\otimes|0\\rangle_{E} + |1\\rangle_{S}\\otimes|1\\rangle_{E}\\big),\n$$\nwith the standard computational basis $\\{|0\\rangle,|1\\rangle\\}$ on each factor. Use the following fundamental definitions as your starting point:\n- The density operator of a pure state $|\\Psi\\rangle$ is $\\rho_{SE} = |\\Psi\\rangle\\langle\\Psi|$.\n- The reduced density operator of $S$ is $\\rho_{S} = \\operatorname{Tr}_{E}(\\rho_{SE})$, where the partial trace over $E$ is defined by $\\operatorname{Tr}_{E}(X) = \\sum_{e\\in\\{0,1\\}}\\langle e|_{E}\\,X\\,|e\\rangle_{E}$ for any operator $X$ on $\\mathcal{H}_{S}\\otimes\\mathcal{H}_{E}$ and any orthonormal basis $\\{|e\\rangle_{E}\\}$ of $\\mathcal{H}_{E}$.\n- The von Neumann entropy (using the natural logarithm) is $S(\\rho_{S}) = -\\operatorname{Tr}(\\rho_{S}\\ln\\rho_{S})$.\n\nTasks:\n- Construct $\\rho_{SE}$ explicitly in the product basis $\\{|0\\rangle_{S}\\otimes|0\\rangle_{E},\\,|0\\rangle_{S}\\otimes|1\\rangle_{E},\\,|1\\rangle_{S}\\otimes|0\\rangle_{E},\\,|1\\rangle_{S}\\otimes|1\\rangle_{E}\\}$.\n- Compute the reduced density operator $\\rho_{S} = \\operatorname{Tr}_{E}(\\rho_{SE})$ by explicitly performing the partial trace in the computational basis on $E$.\n- Determine the eigenvalues of $\\rho_{S}$ and evaluate the entanglement entropy $S(\\rho_{S})$.\n\nExpress your final answer as an exact analytical expression using the natural logarithm. If you refer to units, interpret the entropy in nats. Your final answer must be a single closed-form expression.",
            "solution": "The problem requires the calculation of the entanglement entropy of a subsystem described by a reduced density operator, starting from a pure entangled state of a composite system. The problem statement is scientifically grounded, well-posed, objective, and contains all necessary information. Thus, it is a valid problem, and we proceed with the solution.\n\nThe composite system $SE$ is in the pure Bell state:\n$$\n|\\Phi^{+}\\rangle = \\frac{1}{\\sqrt{2}}\\big(|0\\rangle_{S}\\otimes|0\\rangle_{E} + |1\\rangle_{S}\\otimes|1\\rangle_{E}\\big)\n$$\nFor brevity, we will use the notation $|ij\\rangle \\equiv |i\\rangle_{S}\\otimes|j\\rangle_{E}$. So, the state is $|\\Phi^{+}\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$.\n\nThe first task is to construct the density operator $\\rho_{SE}$ for the composite system. The density operator for a pure state $|\\Psi\\rangle$ is defined as $\\rho = |\\Psi\\rangle\\langle\\Psi|$. For the given state $|\\Phi^{+}\\rangle$, the corresponding bra vector is $\\langle\\Phi^{+}| = \\frac{1}{\\sqrt{2}}(\\langle 00| + \\langle 11|)$.\nThus, the density operator is:\n$$\n\\rho_{SE} = |\\Phi^{+}\\rangle\\langle\\Phi^{+}| = \\left( \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle) \\right) \\left( \\frac{1}{\\sqrt{2}}(\\langle 00| + \\langle 11|) \\right)\n$$\n$$\n\\rho_{SE} = \\frac{1}{2} \\big( |00\\rangle\\langle 00| + |00\\rangle\\langle 11| + |11\\rangle\\langle 00| + |11\\rangle\\langle 11| \\big)\n$$\nIn the ordered product basis $\\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\}$, this operator has the matrix representation:\n$$\n\\rho_{SE} = \\frac{1}{2}\n\\begin{pmatrix}\n1  0  0  1 \\\\\n0  0  0  0 \\\\\n0  0  0  0 \\\\\n1  0  0  1\n\\end{pmatrix}\n$$\n\nThe second task is to compute the reduced density operator of the subsystem $S$, denoted $\\rho_{S}$. This is obtained by performing a partial trace over the environmental degrees of freedom, $\\rho_{S} = \\operatorname{Tr}_{E}(\\rho_{SE})$. Using the definition $\\operatorname{Tr}_{E}(X) = \\sum_{e\\in\\{0,1\\}}\\langle e|_{E}\\,X\\,|e\\rangle_{E}$ with the orthonormal basis $\\{|0\\rangle_E, |1\\rangle_E\\}$ for the environment:\n$$\n\\rho_{S} = \\langle 0|_{E} \\rho_{SE} |0\\rangle_{E} + \\langle 1|_{E} \\rho_{SE} |1\\rangle_{E}\n$$\nTo evaluate this, we can express $\\rho_{SE}$ in terms of tensor products of operators on $\\mathcal{H}_{S}$ and $\\mathcal{H}_{E}$:\n$$\n\\rho_{SE} = \\frac{1}{2} \\Big[ (|0\\rangle_{S}\\langle 0|_{S}) \\otimes (|0\\rangle_{E}\\langle 0|_{E}) + (|0\\rangle_{S}\\langle 1|_{S}) \\otimes (|0\\rangle_{E}\\langle 1|_{E}) + (|1\\rangle_{S}\\langle 0|_{S}) \\otimes (|1\\rangle_{E}\\langle 0|_{E}) + (|1\\rangle_{S}\\langle 1|_{S}) \\otimes (|1\\rangle_{E}\\langle 1|_{E}) \\Big]\n$$\nUsing the property $\\operatorname{Tr}_{E}(A_{S} \\otimes B_{E}) = A_{S} \\operatorname{Tr}(B_{E})$, we can compute $\\rho_{S}$:\n$$\n\\rho_{S} = \\frac{1}{2} \\Big[ (|0\\rangle_{S}\\langle 0|_{S}) \\operatorname{Tr}(|0\\rangle_{E}\\langle 0|_{E}) + (|0\\rangle_{S}\\langle 1|_{S}) \\operatorname{Tr}(|0\\rangle_{E}\\langle 1|_{E}) + (|1\\rangle_{S}\\langle 0|_{S}) \\operatorname{Tr}(|1\\rangle_{E}\\langle 0|_{E}) + (|1\\rangle_{S}\\langle 1|_{S}) \\operatorname{Tr}(|1\\rangle_{E}\\langle 1|_{E}) \\Big]\n$$\nThe traces of the operators on $\\mathcal{H}_{E}$ are calculated as $\\operatorname{Tr}(|i\\rangle\\langle j|) = \\sum_{k=0,1} \\langle k|i\\rangle\\langle j|k\\rangle = \\delta_{ij}$.\n$$\n\\operatorname{Tr}(|0\\rangle_{E}\\langle 0|_{E}) = 1\n$$\n$$\n\\operatorname{Tr}(|0\\rangle_{E}\\langle 1|_{E}) = 0\n$$\n$$\n\\operatorname{Tr}(|1\\rangle_{E}\\langle 0|_{E}) = 0\n$$\n$$\n\\operatorname{Tr}(|1\\rangle_{E}\\langle 1|_{E}) = 1\n$$\nSubstituting these values back into the expression for $\\rho_{S}$:\n$$\n\\rho_{S} = \\frac{1}{2} \\Big[ (|0\\rangle_{S}\\langle 0|_{S}) \\cdot 1 + (|0\\rangle_{S}\\langle 1|_{S}) \\cdot 0 + (|1\\rangle_{S}\\langle 0|_{S}) \\cdot 0 + (|1\\rangle_{S}\\langle 1|_{S}) \\cdot 1 \\Big]\n$$\n$$\n\\rho_{S} = \\frac{1}{2} \\big( |0\\rangle_{S}\\langle 0|_{S} + |1\\rangle_{S}\\langle 1|_{S} \\big)\n$$\nThis shows that the reduced state of the subsystem $S$ is a mixed state. In the computational basis $\\{|0\\rangle_{S}, |1\\rangle_{S}\\}$, this operator has the matrix representation:\n$$\n\\rho_{S} = \\frac{1}{2} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\frac{1}{2} \\mathbb{I}\n$$\nwhere $\\mathbb{I}$ is the $2 \\times 2$ identity matrix. This is a maximally mixed state.\n\nThe third task is to find the eigenvalues of $\\rho_{S}$ and compute the von Neumann entropy $S(\\rho_{S})$.\nThe matrix for $\\rho_{S}$ is diagonal, so its eigenvalues are the diagonal elements. The eigenvalues are $\\lambda_{1} = \\frac{1}{2}$ and $\\lambda_{2} = \\frac{1}{2}$.\nThe von Neumann entropy is defined as $S(\\rho_{S}) = -\\operatorname{Tr}(\\rho_{S}\\ln \\rho_{S})$. In the basis of its eigenvectors, this is given by the formula:\n$$\nS(\\rho_{S}) = -\\sum_{i} \\lambda_{i} \\ln(\\lambda_{i})\n$$\nSubstituting the eigenvalues we found:\n$$\nS(\\rho_{S}) = -\\left( \\frac{1}{2} \\ln\\left(\\frac{1}{2}\\right) + \\frac{1}{2} \\ln\\left(\\frac{1}{2}\\right) \\right)\n$$\n$$\nS(\\rho_{S}) = -2 \\left( \\frac{1}{2} \\ln\\left(\\frac{1}{2}\\right) \\right) = -\\ln\\left(\\frac{1}{2}\\right)\n$$\nUsing the logarithmic identity $\\ln(1/x) = -\\ln(x)$:\n$$\nS(\\rho_{S}) = -(-\\ln(2)) = \\ln(2)\n$$\nThis positive entropy quantifies the entanglement between the subsystem $S$ and the environment $E$. The pure state of the composite system $SE$ has zero entropy, but the subsystem $S$ is in a mixed state with maximum possible entropy for a two-level system, which is a hallmark of maximal entanglement.",
            "answer": "$$\n\\boxed{\\ln(2)}\n$$"
        },
        {
            "introduction": "Bridging quantum theory to practical computation requires confronting a fundamental challenge: representing infinite-dimensional Hilbert spaces with finite resources. This is typically handled by expanding wavefunctions in a finite basis set, which must be systematically converged. This coding exercise provides hands-on experience with this crucial process by examining the convergence of the kinetic energy of a model wavefunction with respect to the plane-wave energy cutoff, $E_{\\text{cut}}$. By writing a program to quantify the error introduced by basis set truncation, you will develop a practical understanding of the trade-off between accuracy and computational cost that underlies all modern quantum simulations .",
            "id": "3770500",
            "problem": "You are given a one-dimensional periodic cell of length $L$ with Born–von Kármán (BvK) boundary conditions, so that any admissible quantum-mechanical wavefunction $\\psi(x)$ satisfies $\\psi(x + L) = \\psi(x)$. The plane-wave functions $\\phi_n(x) = e^{i G_n x} / \\sqrt{L}$ with $G_n = 2\\pi n / L$ for all integers $n$ form an orthonormal basis in the space of square-integrable functions on $[0,L]$. Consider a model normalized state $\\psi(x)$ whose plane-wave expansion coefficients are given by $c_n = \\mathcal{C} \\, e^{-\\alpha n^2}$, where $\\alpha  0$ and $\\mathcal{C}$ is the normalization constant that ensures $\\sum_{n=-\\infty}^{\\infty} |c_n|^2 = 1$. In atomic units (with reduced Planck constant $\\hbar = 1$ and electron mass $m = 1$), the kinetic energy operator is $\\hat{T} = -\\frac{1}{2} \\frac{d^2}{dx^2}$, and the kinetic energy of a plane wave with wavevector $G_n$ is $(1/2) |G_n|^2$, expressed in Hartree.\n\nThe goal is to quantitatively assess the convergence of the expectation value of the kinetic energy observable $\\langle \\hat{T} \\rangle$ with respect to the kinetic energy cutoff $E_{\\text{cut}}$. The cutoff defines a truncated plane-wave subspace by including only those basis functions with $(1/2)|G_n|^2 \\leq E_{\\text{cut}}$. Let $n_{\\max} = \\left\\lfloor \\sqrt{2 E_{\\text{cut}}} \\, L / (2\\pi) \\right\\rfloor$ be the maximum integer index included by the cutoff. The truncated wavefunction is renormalized within this subspace by keeping coefficients $c_n$ for $|n| \\leq n_{\\max}$ and then dividing by the square root of the truncated norm $\\sum_{|n| \\leq n_{\\max}} |c_n|^2$. The truncated expectation value of the kinetic energy, expressed in Hartree, is the renormalized average of $(1/2)|G_n|^2$ weighted by $|c_n|^2$ over $|n| \\leq n_{\\max}$. The reference (true) expectation value is the corresponding infinite sum over all $n \\in \\mathbb{Z}$.\n\nStarting from the fundamental completeness of Fourier series on a finite interval and the definition of the kinetic energy operator in atomic units, write a program that:\n- Computes the absolute error $\\Delta_T = \\left| \\langle \\hat{T} \\rangle_{\\text{trunc}} - \\langle \\hat{T} \\rangle_{\\text{ref}} \\right|$ for several test cases. Here $\\langle \\hat{T} \\rangle_{\\text{trunc}}$ is the truncated expectation value at a given $E_{\\text{cut}}$, while $\\langle \\hat{T} \\rangle_{\\text{ref}}$ is the reference expectation value obtained by summing the infinite series to numerical convergence.\n- Uses a numerical tolerance $\\varepsilon = 10^{-12}$ to determine a finite summation bound $N_{\\text{ref}}$ satisfying $e^{-2 \\alpha N_{\\text{ref}}^2}  \\varepsilon$, and then approximates $\\langle \\hat{T} \\rangle_{\\text{ref}}$ by summing over $n = -N_{\\text{ref}}, \\ldots, N_{\\text{ref}}$. This ensures the reference sum is converged to within the specified tolerance.\n- Performs all calculations in atomic units, with $L$ given in bohr and all energies in Hartree.\n\nYour program should evaluate the following test suite of parameter values $(L, \\alpha, E_{\\text{cut}})$, expressed in $(\\text{bohr}, \\text{unitless}, \\text{Hartree})$:\n1. $(10.0, 0.3, 5.0)$ as a general case.\n2. $(10.0, 0.3, 0.0)$ as a boundary case where only the zero mode is included.\n3. $(10.0, 0.05, 5.0)$ as a slow-decay case requiring more plane waves for convergence.\n4. $(5.0, 0.3, 5.0)$ to assess the effect of cell size on the cutoff mapping.\n5. $(10.0, 0.3, 100.0)$ as a near-complete case with a very large cutoff.\n\nFor each test case, compute the single float value $\\Delta_T$ in Hartree. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"), where each entry is the absolute error for the corresponding test case, expressed in Hartree as a floating-point number. Angles are not used in this problem, so no angle unit applies. Percentages are not used; all results are floats in Hartree.",
            "solution": "The setting is a one-dimensional periodic cell of length $L$ with Born–von Kármán (BvK) boundary conditions. The Hilbert space is $L^2([0,L])$ with the inner product $\\langle f, g \\rangle = \\int_0^L f^*(x) g(x) \\, dx$. The plane waves $\\phi_n(x) = e^{i G_n x} / \\sqrt{L}$ with $G_n = 2\\pi n / L$ are orthonormal, since\n$$\n\\int_0^L \\frac{e^{-i G_n x}}{\\sqrt{L}} \\frac{e^{i G_m x}}{\\sqrt{L}} \\, dx\n= \\frac{1}{L} \\int_0^L e^{i (G_m - G_n) x} \\, dx\n= \\delta_{mn},\n$$\nwhere $\\delta_{mn}$ is the Kronecker delta and the last equality uses the periodicity of the exponential. The completeness follows from the Fourier series theorem on finite intervals: for any $f \\in L^2([0,L])$, its Fourier coefficients $f_n = \\frac{1}{\\sqrt{L}} \\int_0^L f(x) e^{-i G_n x} \\, dx$ provide an expansion $f(x) = \\sum_{n \\in \\mathbb{Z}} f_n \\phi_n(x)$ in the $L^2$ sense, and Parseval’s identity ensures $\\|f\\|_2^2 = \\sum_{n \\in \\mathbb{Z}} |f_n|^2$, meaning the span of $\\{\\phi_n\\}_{n \\in \\mathbb{Z}}$ is dense in $L^2([0,L])$.\n\nWe adopt atomic units, so reduced Planck constant $\\hbar = 1$ and electron mass $m = 1$, giving the kinetic energy operator $\\hat{T} = -\\frac{1}{2} \\frac{d^2}{dx^2}$. Acting on a plane wave $\\phi_n(x)$ yields $\\hat{T} \\phi_n = \\frac{|G_n|^2}{2} \\phi_n$, hence each plane wave is an energy eigenfunction with eigenvalue $(1/2)|G_n|^2$ in Hartree. For a general state $\\psi(x) = \\sum_{n \\in \\mathbb{Z}} c_n \\phi_n(x)$ with $\\sum_{n} |c_n|^2 = 1$, the expectation value of $\\hat{T}$ is\n$$\n\\langle \\hat{T} \\rangle = \\sum_{n \\in \\mathbb{Z}} |c_n|^2 \\frac{|G_n|^2}{2},\n$$\nby orthonormality, since cross terms vanish.\n\nWe choose a model state with coefficients $c_n = \\mathcal{C} \\, e^{-\\alpha n^2}$, with $\\alpha  0$ controlling the decay rate. The normalization constant is\n$$\n\\mathcal{C} = \\left( \\sum_{n=-\\infty}^{\\infty} e^{-2 \\alpha n^2} \\right)^{-1/2}.\n$$\nIn practice, we compute the reference expectation $\\langle \\hat{T} \\rangle_{\\text{ref}}$ by truncating the infinite sum symmetrically at $\\pm N_{\\text{ref}}$, chosen so that $e^{-2 \\alpha N_{\\text{ref}}^2}  \\varepsilon$, where $\\varepsilon = 10^{-12}$ is a numerical tolerance. This ensures the omitted tail is below the tolerance. Note that the normalization cancels in the expectation because it appears both in the numerator and denominator of the weighted average; explicitly,\n$$\n\\langle \\hat{T} \\rangle_{\\text{ref}} \\approx \\frac{\\sum_{n=-N_{\\text{ref}}}^{N_{\\text{ref}}} e^{-2 \\alpha n^2} \\frac{|G_n|^2}{2}}{\\sum_{n=-N_{\\text{ref}}}^{N_{\\text{ref}}} e^{-2 \\alpha n^2}},\n\\qquad G_n = \\frac{2 \\pi n}{L}.\n$$\n\nTo assess convergence with respect to the kinetic energy cutoff $E_{\\text{cut}}$, we restrict to the subspace comprised of plane waves satisfying $(1/2)|G_n|^2 \\leq E_{\\text{cut}}$. Solving $(1/2)(2\\pi n/L)^2 \\leq E_{\\text{cut}}$ for $n$ gives\n$$\n|n| \\leq n_{\\max} = \\left\\lfloor \\frac{L}{2\\pi} \\sqrt{2 E_{\\text{cut}}} \\right\\rfloor.\n$$\nWe then renormalize the truncated state by the truncated norm $S_{\\text{trunc}} = \\sum_{|n|\\leq n_{\\max}} e^{-2 \\alpha n^2}$. The truncated expectation value is thus\n$$\n\\langle \\hat{T} \\rangle_{\\text{trunc}}\n= \\frac{\\sum_{n=-n_{\\max}}^{n_{\\max}} e^{-2 \\alpha n^2} \\frac{|G_n|^2}{2}}{\\sum_{n=-n_{\\max}}^{n_{\\max}} e^{-2 \\alpha n^2}},\n\\qquad G_n = \\frac{2 \\pi n}{L}.\n$$\nThe absolute error is\n$$\n\\Delta_T = \\left| \\langle \\hat{T} \\rangle_{\\text{trunc}} - \\langle \\hat{T} \\rangle_{\\text{ref}} \\right|,\n$$\nexpressed in Hartree.\n\nAlgorithmically:\n1. For each test case $(L, \\alpha, E_{\\text{cut}})$, compute $n_{\\max}$ from $E_{\\text{cut}}$ and $L$. This defines the truncated summation range.\n2. Choose $N_{\\text{ref}}$ such that $e^{-2 \\alpha N_{\\text{ref}}^2}  \\varepsilon$, with $\\varepsilon = 10^{-12}$. One can invert the bound, giving $N_{\\text{ref}} \\ge \\sqrt{-\\ln(\\varepsilon)/(2\\alpha)}$, and then take the ceiling to an integer.\n3. Compute the truncated expectation $\\langle \\hat{T} \\rangle_{\\text{trunc}}$ by forming the weighted average over $n = -n_{\\max}, \\ldots, n_{\\max}$ of $(1/2)|G_n|^2$ with weights $e^{-2 \\alpha n^2}$, using $G_n = 2\\pi n / L$.\n4. Compute the reference expectation $\\langle \\hat{T} \\rangle_{\\text{ref}}$ similarly over $n = -N_{\\text{ref}}, \\ldots, N_{\\text{ref}}$.\n5. Report $\\Delta_T$ for each test case in Hartree.\n\nThis procedure rests on the completeness of the plane-wave basis in the periodic cell, ensuring that the truncated subspace approximates the full expectation value as $E_{\\text{cut}}$ increases and $n_{\\max}$ grows. The choice of $c_n$ with Gaussian decay in $n$ yields a smooth test state whose kinetic energy expectation is well-defined and rapidly convergent under the specified tolerance. The final program implements this sequence exactly and outputs the list of absolute errors for the provided test suite in the required format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef n_max_from_Ecut(L_bohr: float, Ecut_hartree: float) - int:\n    \"\"\"\n    Compute n_max from kinetic energy cutoff E_cut in Hartree for a 1D cell of length L in bohr.\n    In atomic units, T_n = (1/2) * G_n^2, with G_n = 2*pi*n / L.\n    Include modes with (1/2)*G_n^2 = Ecut = |n| = n_max.\n    \"\"\"\n    if Ecut_hartree = 0.0:\n        return 0\n    return int(np.floor((L_bohr / (2.0 * np.pi)) * np.sqrt(2.0 * Ecut_hartree)))\n\ndef N_ref_from_alpha(alpha: float, tol: float = 1e-12) - int:\n    \"\"\"\n    Choose N_ref such that exp(-2*alpha*N_ref^2)  tol.\n    Invert bound: N_ref = sqrt(-ln(tol)/(2*alpha)).\n    \"\"\"\n    if alpha = 0.0:\n        raise ValueError(\"alpha must be positive.\")\n    # Handle extremely small tol to avoid overflow; use logs\n    target = -np.log(tol)\n    N_ref = int(np.ceil(np.sqrt(target / (2.0 * alpha))))\n    return max(N_ref, 0)\n\ndef kinetic_energy_expectation_truncated(L: float, alpha: float, n_max: int) - float:\n    \"\"\"\n    Compute truncated, renormalized expectation of kinetic energy for c_n ~ exp(-alpha*n^2).\n    Returns value in Hartree.\n    \"\"\"\n    if n_max  0:\n        n_max = 0\n    n_vals = np.arange(-n_max, n_max + 1, dtype=int)\n    # Weights are |c_n|^2 up to a constant that cancels in the ratio.\n    weights = np.exp(-2.0 * alpha * (n_vals.astype(float) ** 2))\n    G = (2.0 * np.pi * n_vals.astype(float)) / L\n    energies = 0.5 * (G ** 2)\n    denom = np.sum(weights)\n    # Avoid division by zero (only possible if n_max=-1, which we disallow, or pathological alpha)\n    if denom == 0.0:\n        return 0.0\n    numer = np.sum(weights * energies)\n    return numer / denom\n\ndef kinetic_energy_expectation_reference(L: float, alpha: float, tol: float = 1e-12) - float:\n    \"\"\"\n    Compute reference expectation by summing symmetrically to N_ref determined by tolerance.\n    Returns value in Hartree.\n    \"\"\"\n    N_ref = N_ref_from_alpha(alpha, tol=tol)\n    n_vals = np.arange(-N_ref, N_ref + 1, dtype=int)\n    weights = np.exp(-2.0 * alpha * (n_vals.astype(float) ** 2))\n    G = (2.0 * np.pi * n_vals.astype(float)) / L\n    energies = 0.5 * (G ** 2)\n    denom = np.sum(weights)\n    if denom == 0.0:\n        return 0.0\n    numer = np.sum(weights * energies)\n    return numer / denom\n\ndef absolute_error_energy(L: float, alpha: float, Ecut: float, tol: float = 1e-12) - float:\n    \"\"\"\n    Compute absolute error |E_trunc - E_ref| in Hartree for given parameters.\n    \"\"\"\n    nmax = n_max_from_Ecut(L, Ecut)\n    E_trunc = kinetic_energy_expectation_truncated(L, alpha, nmax)\n    E_ref = kinetic_energy_expectation_reference(L, alpha, tol=tol)\n    return float(abs(E_trunc - E_ref))\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple is (L in bohr, alpha unitless (0), E_cut in Hartree)\n    test_cases = [\n        (10.0, 0.3, 5.0),    # General case\n        (10.0, 0.3, 0.0),    # Boundary case: only n=0 included\n        (10.0, 0.05, 5.0),   # Slow-decay case\n        (5.0, 0.3, 5.0),     # Different cell size\n        (10.0, 0.3, 100.0),  # Very large cutoff (near-complete)\n    ]\n\n    results = []\n    for L, alpha, Ecut in test_cases:\n        err = absolute_error_energy(L, alpha, Ecut, tol=1e-12)\n        results.append(err)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}