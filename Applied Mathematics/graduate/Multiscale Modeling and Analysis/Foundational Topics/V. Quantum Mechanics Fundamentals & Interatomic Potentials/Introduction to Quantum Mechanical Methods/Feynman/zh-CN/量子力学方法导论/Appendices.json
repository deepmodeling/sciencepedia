{
    "hands_on_practices": [
        {
            "introduction": "在多尺度建模中，我们常常需要将一个大系统划分为一个量子力学（QM）子系统和其所处的环境。当量子子系统与环境发生纠缠时，它的状态便不能再用一个纯态波函数来描述，而必须借助约化密度矩阵。这个练习  将通过一个具体的例子来阐明这一核心概念：我们将从一个最大纠缠的贝尔态出发，通过对环境自由度求偏迹，推导出子系统的状态，并计算其冯·诺依曼熵。这个过程清晰地展示了如何从一个整体的纯态中得到一个混合的子系统态，以及如何用熵来量化这种纠缠。",
            "id": "3770460",
            "problem": "在多尺度建模中，通过对环境自由度取偏迹，对复合系统进行粗粒化，可以得到一个开放量子子系统。考虑一个由子系统 $S$ 和环境 $E$ 组成的二分系统，每个都是二能级系统，其希尔伯特空间分别为 $\\mathcal{H}_{S} \\cong \\mathbb{C}^{2}$ 和 $\\mathcal{H}_{E} \\cong \\mathbb{C}^{2}$。假设复合系统 $SE$ 被制备在纯贝尔态\n$$\n|\\Phi^{+}\\rangle = \\frac{1}{\\sqrt{2}}\\big(|0\\rangle_{S}\\otimes|0\\rangle_{E} + |1\\rangle_{S}\\otimes|1\\rangle_{E}\\big),\n$$\n其中每个因子上的标准计算基为 $\\{|0\\rangle,|1\\rangle\\}$。使用以下基本定义作为出发点：\n- 纯态 $|\\Psi\\rangle$ 的密度算符为 $\\rho_{SE} = |\\Psi\\rangle\\langle\\Psi|$。\n- $S$ 的约化密度算符为 $\\rho_{S} = \\operatorname{Tr}_{E}(\\rho_{SE})$，其中对 $E$ 的偏迹定义为 $\\operatorname{Tr}_{E}(X) = \\sum_{e\\in\\{0,1\\}}\\langle e|_{E}\\,X\\,|e\\rangle_{E}$，适用于 $\\mathcal{H}_{S}\\otimes\\mathcal{H}_{E}$ 上的任意算符 $X$ 和 $\\mathcal{H}_{E}$ 的任意标准正交基 $\\{|e\\rangle_{E}\\}$。\n- 冯·诺依曼熵（使用自然对数）为 $S(\\rho_{S}) = -\\operatorname{Tr}(\\rho_{S}\\ln \\rho_{S})$。\n\n任务：\n- 在乘积基 $\\{|0\\rangle_{S}\\otimes|0\\rangle_{E},\\,|0\\rangle_{S}\\otimes|1\\rangle_{E},\\,|1\\rangle_{S}\\otimes|0\\rangle_{E},\\,|1\\rangle_{S}\\otimes|1\\rangle_{E}\\}$ 中显式地构造 $\\rho_{SE}$。\n- 通过在 $E$ 的计算基上显式地执行偏迹，计算约化密度算符 $\\rho_{S} = \\operatorname{Tr}_{E}(\\rho_{SE})$。\n- 确定 $\\rho_{S}$ 的本征值并计算纠缠熵 $S(\\rho_{S})$。\n\n用自然对数将你的最终答案表示为一个精确的解析表达式。如果涉及单位，请将熵的单位解释为奈特。你的最终答案必须是单个的闭合形式表达式。",
            "solution": "该问题要求从复合系统的纯纠缠态出发，计算由约化密度算符描述的子系统的纠缠熵。问题陈述具有科学依据、适定、客观，并包含所有必要信息。因此，这是一个有效的问题，我们着手求解。\n\n复合系统 $SE$ 处于纯贝尔态：\n$$\n|\\Phi^{+}\\rangle = \\frac{1}{\\sqrt{2}}\\big(|0\\rangle_{S}\\otimes|0\\rangle_{E} + |1\\rangle_{S}\\otimes|1\\rangle_{E}\\big)\n$$\n为简洁起见，我们使用记法 $|ij\\rangle \\equiv |i\\rangle_{S}\\otimes|j\\rangle_{E}$。因此，该态为 $|\\Phi^{+}\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$。\n\n第一个任务是构造复合系统的密度算符 $\\rho_{SE}$。纯态 $|\\Psi\\rangle$ 的密度算符定义为 $\\rho = |\\Psi\\rangle\\langle\\Psi|$。对于给定的态 $|\\Phi^{+}\\rangle$，对应的左矢为 $\\langle\\Phi^{+}| = \\frac{1}{\\sqrt{2}}(\\langle 00| + \\langle 11|)$。\n因此，密度算符为：\n$$\n\\rho_{SE} = |\\Phi^{+}\\rangle\\langle\\Phi^{+}| = \\left( \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle) \\right) \\left( \\frac{1}{\\sqrt{2}}(\\langle 00| + \\langle 11|) \\right)\n$$\n$$\n\\rho_{SE} = \\frac{1}{2} \\big( |00\\rangle\\langle 00| + |00\\rangle\\langle 11| + |11\\rangle\\langle 00| + |11\\rangle\\langle 11| \\big)\n$$\n在有序乘积基 $\\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\}$ 中，该算符的矩阵表示为：\n$$\n\\rho_{SE} = \\frac{1}{2}\n\\begin{pmatrix}\n1  0  0  1 \\\\\n0  0  0  0 \\\\\n0  0  0  0 \\\\\n1  0  0  1\n\\end{pmatrix}\n$$\n\n第二个任务是计算子系统 $S$ 的约化密度算符，记为 $\\rho_{S}$。这通过对环境自由度取偏迹得到，即 $\\rho_{S} = \\operatorname{Tr}_{E}(\\rho_{SE})$。使用定义 $\\operatorname{Tr}_{E}(X) = \\sum_{e\\in\\{0,1\\}}\\langle e|_{E}\\,X\\,|e\\rangle_{E}$ 以及环境的标准正交基 $\\{|0\\rangle_E, |1\\rangle_E\\}$：\n$$\n\\rho_{S} = \\langle 0|_{E} \\rho_{SE} |0\\rangle_{E} + \\langle 1|_{E} \\rho_{SE} |1\\rangle_{E}\n$$\n为计算此式，我们可以将 $\\rho_{SE}$ 表示为 $\\mathcal{H}_{S}$ 和 $\\mathcal{H}_{E}$ 上算符的张量积形式：\n$$\n\\rho_{SE} = \\frac{1}{2} \\Big[ (|0\\rangle_{S}\\langle 0|_{S}) \\otimes (|0\\rangle_{E}\\langle 0|_{E}) + (|0\\rangle_{S}\\langle 1|_{S}) \\otimes (|0\\rangle_{E}\\langle 1|_{E}) + (|1\\rangle_{S}\\langle 0|_{S}) \\otimes (|1\\rangle_{E}\\langle 0|_{E}) + (|1\\rangle_{S}\\langle 1|_{S}) \\otimes (|1\\rangle_{E}\\langle 1|_{E}) \\Big]\n$$\n利用性质 $\\operatorname{Tr}_{E}(A_{S} \\otimes B_{E}) = A_{S} \\operatorname{Tr}(B_{E})$，我们可以计算 $\\rho_{S}$：\n$$\n\\rho_{S} = \\frac{1}{2} \\Big[ (|0\\rangle_{S}\\langle 0|_{S}) \\operatorname{Tr}(|0\\rangle_{E}\\langle 0|_{E}) + (|0\\rangle_{S}\\langle 1|_{S}) \\operatorname{Tr}(|0\\rangle_{E}\\langle 1|_{E}) + (|1\\rangle_{S}\\langle 0|_{S}) \\operatorname{Tr}(|1\\rangle_{E}\\langle 0|_{E}) + (|1\\rangle_{S}\\langle 1|_{S}) \\operatorname{Tr}(|1\\rangle_{E}\\langle 1|_{E}) \\Big]\n$$\n$\\mathcal{H}_{E}$ 上算符的迹计算如下：$\\operatorname{Tr}(|i\\rangle\\langle j|) = \\sum_{k=0,1} \\langle k|i\\rangle\\langle j|k\\rangle = \\delta_{ij}$。\n$$\n\\operatorname{Tr}(|0\\rangle_{E}\\langle 0|_{E}) = 1\n$$\n$$\n\\operatorname{Tr}(|0\\rangle_{E}\\langle 1|_{E}) = 0\n$$\n$$\n\\operatorname{Tr}(|1\\rangle_{E}\\langle 0|_{E}) = 0\n$$\n$$\n\\operatorname{Tr}(|1\\rangle_{E}\\langle 1|_{E}) = 1\n$$\n将这些值代回 $\\rho_{S}$ 的表达式中：\n$$\n\\rho_{S} = \\frac{1}{2} \\Big[ (|0\\rangle_{S}\\langle 0|_{S}) \\cdot 1 + (|0\\rangle_{S}\\langle 1|_{S}) \\cdot 0 + (|1\\rangle_{S}\\langle 0|_{S}) \\cdot 0 + (|1\\rangle_{S}\\langle 1|_{S}) \\cdot 1 \\Big]\n$$\n$$\n\\rho_{S} = \\frac{1}{2} \\big( |0\\rangle_{S}\\langle 0|_{S} + |1\\rangle_{S}\\langle 1|_{S} \\big)\n$$\n这表明子系统 $S$ 的约化态是一个混合态。在计算基 $\\{|0\\rangle_{S}, |1\\rangle_{S}\\}$ 中，该算符的矩阵表示为：\n$$\n\\rho_{S} = \\frac{1}{2} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\frac{1}{2} \\mathbb{I}\n$$\n其中 $\\mathbb{I}$ 是 $2 \\times 2$ 单位矩阵。这是一个最大混合态。\n\n第三个任务是求出 $\\rho_{S}$ 的本征值并计算冯·诺依曼熵 $S(\\rho_{S})$。\n$\\rho_{S}$ 的矩阵是对角矩阵，因此其本征值即为对角元。本征值为 $\\lambda_{1} = \\frac{1}{2}$ 和 $\\lambda_{2} = \\frac{1}{2}$。\n冯·诺依曼熵定义为 $S(\\rho_{S}) = -\\operatorname{Tr}(\\rho_{S}\\ln \\rho_{S})$。在其本征矢量基中，它由以下公式给出：\n$$\nS(\\rho_{S}) = -\\sum_{i} \\lambda_{i} \\ln(\\lambda_{i})\n$$\n代入我们求得的本征值：\n$$\nS(\\rho_{S}) = -\\left( \\frac{1}{2} \\ln\\left(\\frac{1}{2}\\right) + \\frac{1}{2} \\ln\\left(\\frac{1}{2}\\right) \\right)\n$$\n$$\nS(\\rho_{S}) = -2 \\left( \\frac{1}{2} \\ln\\left(\\frac{1}{2}\\right) \\right) = -\\ln\\left(\\frac{1}{2}\\right)\n$$\n使用对数恒等式 $\\ln(1/x) = -\\ln(x)$：\n$$\nS(\\rho_{S}) = -(-\\ln(2)) = \\ln(2)\n$$\n这个正的熵量化了子系统 $S$ 与环境 $E$ 之间的纠缠。复合系统 $SE$ 的纯态熵为零，但子系统 $S$ 处于一个混合态，其熵对于一个二能级系统达到了最大可能值，这是最大纠缠的一个标志。",
            "answer": "$$\n\\boxed{\\ln(2)}\n$$"
        },
        {
            "introduction": "定义了量子子系统之后，下一步是理解它如何与环境相互作用。在许多模型中，环境的“慢”自由度（如原子核坐标）可以被看作是调控量子子系统哈密顿量的参数。本练习  采用一个简洁而强大的二能级模型，来演示“避免交叉”这一关键现象。你将看到，当量子态之间存在耦合时，它们的能级会相互“排斥”而不会交叉，这一概念对于理解分子中的化学反应、光物理过程以及非绝热动力学至关重要。",
            "id": "3770498",
            "problem": "考虑一个双能级子系统，它是在两个绝热能面的锥形交叉点附近，作为多尺度模型的有效量子力学描述而出现的。令一个慢变控制参数 $x$ 代表环境的粗粒化状态，并假设在 $x=x_{0}$ 附近的一个局部窗口内，未耦合的非绝热能量可以很好地通过线性化 $E_{1}(x)=E_{0}+\\alpha\\,(x-x_{0})$ 和 $E_{2}(x)=E_{0}-\\beta\\,(x-x_{0})$ 来近似，其中 $E_{0}$、$\\alpha$ 和 $\\beta$ 是实常数，且 $\\alpha0$ 和 $\\beta0$。一个非零实常数耦合 $\\,\\Delta\\,$ 使这两个非绝热态混合，得到 $2\\times 2$ 的厄米哈密顿量\n$$\nH(x)=\\begin{pmatrix}\nE_{1}(x)  \\Delta \\\\\n\\Delta  E_{2}(x)\n\\end{pmatrix}.\n$$\n仅从定态薛定谔方程 $H(x)\\,\\psi=\\varepsilon(x)\\,\\psi$ 和厄米算符的性质出发，执行以下步骤：\n1. 推导 $H(x)$ 的两个本征值 $\\varepsilon_{+}(x)$ 和 $\\varepsilon_{-}(x)$ 的精确表达式。\n2. 使用这些表达式，解释为什么当 $\\Delta\\neq 0$ 时，两个准简并能级（即 $E_{1}(x)\\approx E_{2}(x)$）不会交叉，从而证明该模型中的避免交叉现象。\n3. 将能级排斥定义为能量间隙 $\\varepsilon_{+}(x)-\\varepsilon_{-}(x)$ 在所有实数 $x$ 上的最小值，并以 $\\Delta$ 的闭式符号表达式精确计算该最小值。\n\n只需提供能级排斥的最终符号表达式作为您的答案。不需要进行数值计算，最终表达式也不需要单位。",
            "solution": "首先验证问题，确保其具有科学依据、良定性和客观性。\n\n**步骤 1：提取已知条件**\n- 一个双能级量子子系统由一个 $2\\times 2$ 的厄米哈密顿量 $H(x)$ 描述。\n- $x$ 是一个慢变控制参数。\n- 在点 $x_{0}$ 附近，未耦合的非绝热能量由线性函数近似：$E_{1}(x)=E_{0}+\\alpha\\,(x-x_{0})$ 和 $E_{2}(x)=E_{0}-\\beta\\,(x-x_{0})$。\n- $E_{0}$、$\\alpha$ 和 $\\beta$ 是实常数。\n- 常数的约束条件是 $\\alpha0$ 和 $\\beta0$。\n- 一个非零实常数耦合 $\\Delta$ 使非绝热态混合。\n- 哈密顿矩阵由 $H(x)=\\begin{pmatrix} E_{1}(x)  \\Delta \\\\ \\Delta  E_{2}(x) \\end{pmatrix}$ 给出。\n- 控制方程是定态薛定谔方程 $H(x)\\,\\psi=\\varepsilon(x)\\,\\psi$，其中 $\\varepsilon(x)$ 代表本征值。\n- 问题要求完成三项任务：(1) 推导本征值 $\\varepsilon_{\\pm}(x)$，(2) 解释当 $\\Delta \\neq 0$ 时的避免交叉现象，以及 (3) 计算能级排斥，其定义为能量间隙 $\\varepsilon_{+}(x) - \\varepsilon_{-}(x)$ 的最小值。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 问题描述了一个 Landau-Zener 型双能级系统，这是量子力学和量子化学中的一个基本且典型的模型。它被用来描述广泛的现象，包括电荷转移、非绝热跃遷，以及如前所述的锥形交叉点附近的行为。该描述完全符合已建立的物理原理。\n- **良定性：** 问题在数学上是良定的。它要求找到一个 $2 \\times 2$ 矩阵的本征值，然后找到从这些本征值导出的函数的最小值。这些是线性代数和微积分中的标准程序，能够产生唯一且有意义的解。\n- **客观性：** 问题使用物理学和数学中精确、标准和客观的术语来陈述。没有主观或模糊的陈述。\n- **完整性与一致性：** 提供了所有必要的信息。函数形式、常数和约束都已明确定义。设置中没有矛盾。条件 $\\Delta \\neq 0$ 至关重要，并得到了一致的使用。\n\n**步骤 3：结论与行动**\n问题是有效的。这是一个基于基本量子力学的标准、良定的问题。我将继续进行求解。\n\n**求解推导**\n\n求解过程遵循问题陈述中概述的三个步骤。\n\n**1. 推导本征值 $\\varepsilon(x)$**\n\n哈密顿量 $H(x)$ 的本征值 $\\varepsilon(x)$ 通过求解特征方程 $\\det(H(x) - \\varepsilon I) = 0$ 得到，其中 $I$ 是 $2 \\times 2$ 单位矩阵。\n\n矩阵 $H(x) - \\varepsilon I$ 是：\n$$\nH(x) - \\varepsilon I = \\begin{pmatrix}\nE_{1}(x) - \\varepsilon  \\Delta \\\\\n\\Delta  E_{2}(x) - \\varepsilon\n\\end{pmatrix}\n$$\n其行列式为：\n$$\n\\det(H(x) - \\varepsilon I) = (E_{1}(x) - \\varepsilon)(E_{2}(x) - \\varepsilon) - \\Delta^{2} = 0\n$$\n展开此方程得到关于本征值 $\\varepsilon$ 的二次方程：\n$$\n\\varepsilon^{2} - (E_{1}(x) + E_{2}(x))\\varepsilon + E_{1}(x)E_{2}(x) - \\Delta^{2} = 0\n$$\n我们使用二次公式求解 $\\varepsilon$：\n$$\n\\varepsilon = \\frac{(E_{1}(x) + E_{2}(x)) \\pm \\sqrt{(-(E_{1}(x) + E_{2}(x)))^{2} - 4(1)(E_{1}(x)E_{2}(x) - \\Delta^{2})}}{2}\n$$\n$$\n\\varepsilon = \\frac{E_{1}(x) + E_{2}(x)}{2} \\pm \\frac{1}{2} \\sqrt{(E_{1}(x) + E_{2}(x))^{2} - 4E_{1}(x)E_{2}(x) + 4\\Delta^{2}}\n$$\n平方根下的项可以使用代数恒等式 $(a+b)^{2} - 4ab = (a-b)^{2}$ 来简化：\n$$\n\\varepsilon = \\frac{E_{1}(x) + E_{2}(x)}{2} \\pm \\frac{1}{2} \\sqrt{(E_{1}(x) - E_{2}(x))^{2} + 4\\Delta^{2}}\n$$\n这给出了两个本征值，我们将其标记为 $\\varepsilon_{+}(x)$ 和 $\\varepsilon_{-}(x)$：\n$$\n\\varepsilon_{\\pm}(x) = \\frac{E_{1}(x) + E_{2}(x)}{2} \\pm \\frac{1}{2} \\sqrt{(E_{1}(x) - E_{2}(x))^{2} + 4\\Delta^{2}}\n$$\n我们可以代入给定的 $E_{1}(x)$ 和 $E_{2}(x)$ 的表达式：\n$E_{1}(x) = E_{0}+\\alpha(x-x_{0})$\n$E_{2}(x) = E_{0}-\\beta(x-x_{0})$\n它们的和与差是：\n$E_{1}(x) + E_{2}(x) = 2E_{0} + (\\alpha-\\beta)(x-x_{0})$\n$E_{1}(x) - E_{2}(x) = (\\alpha+\\beta)(x-x_{0})$\n将这些代入本征值表达式，得到完整形式：\n$$\n\\varepsilon_{\\pm}(x) = E_{0} + \\frac{\\alpha-\\beta}{2}(x-x_{0}) \\pm \\frac{1}{2} \\sqrt{((\\alpha+\\beta)(x-x_{0}))^2 + 4\\Delta^2}\n$$\n\n**2. 避免交叉的解释**\n\n如果两个能级在参数 $x$ 的某个值处变得简并，即 $\\varepsilon_{+}(x) = \\varepsilon_{-}(x)$，则发生能级交叉。这等价于能级之间的能量间隙为零：$\\varepsilon_{+}(x) - \\varepsilon_{-}(x) = 0$。\n\n从推导出的本征值表达式，能量间隙 $\\Delta\\varepsilon(x)$ 为：\n$$\n\\Delta\\varepsilon(x) = \\varepsilon_{+}(x) - \\varepsilon_{-}(x) = \\sqrt{(E_{1}(x) - E_{2}(x))^{2} + 4\\Delta^{2}}\n$$\n要发生交叉，必须有 $\\Delta\\varepsilon(x)=0$，这意味着：\n$$\n(E_{1}(x) - E_{2}(x))^{2} + 4\\Delta^{2} = 0\n$$\n由于 $E_{1}(x)$、$E_{2}(x)$ 和 $\\Delta$ 都是实数，$(E_{1}(x) - E_{2}(x))^{2}$ 和 $4\\Delta^{2}$ 这两项都是非负的。两个非负项之和仅在两项各自为零时才为零。这要求同时满足两个条件：\n1. $(E_{1}(x) - E_{2}(x))^{2} = 0 \\implies E_{1}(x) = E_{2}(x)$\n2. $4\\Delta^{2} = 0 \\implies \\Delta = 0$\n\n问题陈述指明耦合 $\\Delta$ 是一个*非零*实常数。因此，第二个条件 $\\Delta=0$ 永远不会满足。由于 $4\\Delta^{2}$ 是严格正的，能量间隙 $\\Delta\\varepsilon(x) = \\sqrt{(E_{1}(x) - E_{2}(x))^{2} + 4\\Delta^{2}}$ 对所有实数 $x$ 始终严格大于零。\n能级可以相互靠近，但永远不会变得简并。这种非零耦合项阻止能级交叉的现象被称为避免交叉。如果 $\\Delta$ 为零，非绝热能级 $E_1(x)$ 和 $E_2(x)$ 会在 $x=x_0$ 处交叉，但由于耦合的存在，它们相互“排斥”。\n\n**3. 能级排斥的计算**\n\n能级排斥定义为能量间隙 $\\Delta\\varepsilon(x)$ 在所有实数 $x$ 上的最小值。我们需要找到：\n$$\n\\min_{x \\in \\mathbb{R}} \\left( \\Delta\\varepsilon(x) \\right) = \\min_{x \\in \\mathbb{R}} \\left( \\sqrt{((\\alpha+\\beta)(x-x_{0}))^2 + 4\\Delta^2} \\right)\n$$\n平方根函数 $\\sqrt{y}$对于 $y \\ge 0$ 是一个严格递增函数。因此，最小化 $\\Delta\\varepsilon(x)$ 等价于最小化其自变量（平方根下的表达式）。令 $f(x) = ((\\alpha+\\beta)(x-x_{0}))^2 + 4\\Delta^2$。\n\n$4\\Delta^{2}$ 项是一个正常数。$((\\alpha+\\beta)(x-x_{0}))^2$ 项依赖于 $x$。因为 $\\alpha  0$ 且 $\\beta  0$，它们的和 $\\alpha+\\beta$ 是一个正常数。表达式 $((\\alpha+\\beta)(x-x_{0}))^2$ 是一个实数的平方，所以它的值总是非负的。\n$((\\alpha+\\beta)(x-x_{0}))^2$ 的最小值是 $0$，这发生在它的底数为零时：\n$$\n(\\alpha+\\beta)(x-x_{0}) = 0\n$$\n由于 $\\alpha+\\beta  0$，这个最小值恰好在 $x = x_{0}$ 时出现。\n\n在 $x=x_0$这一点，函数 $f(x)$ 达到其最小值：\n$$\nf_{\\min} = f(x_{0}) = ((\\alpha+\\beta)(x_{0}-x_{0}))^2 + 4\\Delta^2 = 0 + 4\\Delta^2 = 4\\Delta^2\n$$\n能量间隙的最小值，即能级排斥，是这个最小值的平方根：\n$$\n\\text{能级排斥} = \\sqrt{f_{\\min}} = \\sqrt{4\\Delta^2}\n$$\n由于 $\\Delta$ 是一个实数，所以 $\\Delta^2 \\ge 0$。$4\\Delta^2$ 的平方根通常取正根，即 $|2\\Delta|$。作为能量间隙，能级排斥是一个正定数量。\n$$\n\\text{能级排斥} = 2|\\Delta|\n$$\n问题要求以 $\\Delta$ 的符号表达式给出这个值。",
            "answer": "$$\\boxed{2|\\Delta|}$$"
        },
        {
            "introduction": "从解析模型到实际计算，我们需要解决一个核心的实践问题：如何在计算机上表示和求解量子子系统的状态？这通常需要选择一组完备的基函数来展开波函数。本练习  聚焦于周期性体系中常用的平面波基组，它要求你通过编程来研究计算结果的收敛性。你将具体探索动能期望值如何依赖于基组的截断能（$E_{\\text{cut}}$），这是每一位计算科学家在进行电子结构计算时都必须面对的基础任务，它深刻揭示了理论与计算实践之间的联系。",
            "id": "3770500",
            "problem": "给定一个长度为 $L$ 的一维周期性晶胞，其具有 Born–von Kármán (BvK) 边界条件，因此任何允许的量子力学波函数 $\\psi(x)$ 都满足 $\\psi(x + L) = \\psi(x)$。对于所有整数 $n$，平面波函数 $\\phi_n(x) = e^{i G_n x} / \\sqrt{L}$（其中 $G_n = 2\\pi n / L$）在 $[0,L]$ 上的平方可积函数空间中构成一个标准正交基。考虑一个模型化的归一化态 $\\psi(x)$，其平面波展开系数由 $c_n = \\mathcal{C} \\, e^{-\\alpha n^2}$ 给出，其中 $\\alpha  0$ 且 $\\mathcal{C}$ 是确保 $\\sum_{n=-\\infty}^{\\infty} |c_n|^2 = 1$ 的归一化常数。在原子单位制中（约化普朗克常数 $\\hbar = 1$ 且电子质量 $m = 1$），动能算符为 $\\hat{T} = -\\frac{1}{2} \\frac{d^2}{dx^2}$，具有波矢 $G_n$ 的平面波的动能为 $(1/2) |G_n|^2$，以 Hartree 为单位表示。\n\n目标是定量评估动能可观测量 $\\langle \\hat{T} \\rangle$ 的期望值相对于动能截断 $E_{\\text{cut}}$ 的收敛性。该截断通过只包含那些满足 $(1/2)|G_n|^2 \\leq E_{\\text{cut}}$ 的基函数，来定义一个截断的平面波子空间。令 $n_{\\max} = \\left\\lfloor \\sqrt{2 E_{\\text{cut}}} \\, L / (2\\pi) \\right\\rfloor$ 为截断所包含的最大整数索引。截断波函数在此子空间内被重新归一化，方法是保留 $|n| \\leq n_{\\max}$ 的系数 $c_n$，然后除以截断范数 $\\sum_{|n| \\leq n_{\\max}} |c_n|^2$ 的平方根。以 Hartree 为单位表示的动能截断期望值，是在 $|n| \\leq n_{\\max}$ 范围内，由 $|c_n|^2$ 加权的 $(1/2)|G_n|^2$ 的重新归一化平均值。参考（真实）期望值是对应于所有 $n \\in \\mathbb{Z}$ 的无穷级数求和。\n\n从有限区间上傅里叶级数的基本完备性以及原子单位制中动能算符的定义出发，编写一个程序，该程序：\n- 计算几个测试用例的绝对误差 $\\Delta_T = \\left| \\langle \\hat{T} \\rangle_{\\text{trunc}} - \\langle \\hat{T} \\rangle_{\\text{ref}} \\right|$。其中 $\\langle \\hat{T} \\rangle_{\\text{trunc}}$ 是在给定 $E_{\\text{cut}}$ 下的截断期望值，而 $\\langle \\hat{T} \\rangle_{\\text{ref}}$ 是通过对无穷级数求和直至数值收敛得到的参考期望值。\n- 使用数值公差 $\\varepsilon = 10^{-12}$ 来确定一个满足 $e^{-2 \\alpha N_{\\text{ref}}^2}  \\varepsilon$ 的有限求和界限 $N_{\\text{ref}}$，然后通过对 $n = -N_{\\text{ref}}, \\ldots, N_{\\text{ref}}$ 求和来近似计算 $\\langle \\hat{T} \\rangle_{\\text{ref}}$。这确保了参考求和在指定的公差范围内收敛。\n- 所有计算均以原子单位制进行，$L$ 以 bohr 为单位，所有能量以 Hartree 为单位。\n\n您的程序应评估以下参数值测试套件 $(L, \\alpha, E_{\\text{cut}})$，单位为 $(\\text{bohr}, \\text{无量纲}, \\text{Hartree})$：\n1. $(10.0, 0.3, 5.0)$ 作为一般情况。\n2. $(10.0, 0.3, 0.0)$ 作为边界情况，只包含零模。\n3. $(10.0, 0.05, 5.0)$ 作为慢衰减情况，需要更多平面波才能收敛。\n4. $(5.0, 0.3, 5.0)$ 用于评估晶胞尺寸对截断映射的影响。\n5. $(10.0, 0.3, 100.0)$ 作为具有非常大截断的近乎完备的情况。\n\n对于每个测试用例，计算以 Hartree 为单位的单个浮点数值 $\\Delta_T$。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3,result4,result5]”），列表中的每个条目是相应测试用例的绝对误差，以 Hartree 为单位表示为浮点数。本问题中不使用角度，因此没有角度单位适用。不使用百分比；所有结果都是以 Hartree 为单位的浮点数。",
            "solution": "设定是一个长度为 $L$ 的一维周期性晶胞，具有 Born–von Kármán (BvK) 边界条件。希尔伯特空间是 $L^2([0,L])$，其内积为 $\\langle f, g \\rangle = \\int_0^L f^*(x) g(x) \\, dx$。平面波 $\\phi_n(x) = e^{i G_n x} / \\sqrt{L}$（其中 $G_n = 2\\pi n / L$）是标准正交的，因为\n$$\n\\int_0^L \\frac{e^{-i G_n x}}{\\sqrt{L}} \\frac{e^{i G_m x}}{\\sqrt{L}} \\, dx\n= \\frac{1}{L} \\int_0^L e^{i (G_m - G_n) x} \\, dx\n= \\delta_{mn},\n$$\n其中 $\\delta_{mn}$ 是克罗内克 $\\delta$，最后一个等式利用了指数函数的周期性。完备性源于有限区间上的傅里叶级数定理：对于任何 $f \\in L^2([0,L])$，其傅里叶系数 $f_n = \\frac{1}{\\sqrt{L}} \\int_0^L f(x) e^{-i G_n x} \\, dx$ 在 $L^2$ 意义下提供了一个展开式 $f(x) = \\sum_{n \\in \\mathbb{Z}} f_n \\phi_n(x)$，并且帕塞瓦尔恒等式确保了 $\\|f\\|_2^2 = \\sum_{n \\in \\mathbb{Z}} |f_n|^2$，这意味着 $\\{\\phi_n\\}_{n \\in \\mathbb{Z}}$ 的张成空间在 $L^2([0,L])$ 中是稠密的。\n\n我们采用原子单位制，因此约化普朗克常数 $\\hbar = 1$ 且电子质量 $m = 1$，这给出了动能算符 $\\hat{T} = -\\frac{1}{2} \\frac{d^2}{dx^2}$。将其作用于平面波 $\\phi_n(x)$ 得到 $\\hat{T} \\phi_n = \\frac{|G_n|^2}{2} \\phi_n$，因此每个平面波都是一个能量本征函数，其本征值为 $(1/2)|G_n|^2$，以 Hartree 为单位。对于一个一般态 $\\psi(x) = \\sum_{n \\in \\mathbb{Z}} c_n \\phi_n(x)$，其中 $\\sum_{n} |c_n|^2 = 1$，$\\hat{T}$ 的期望值为\n$$\n\\langle \\hat{T} \\rangle = \\sum_{n \\in \\mathbb{Z}} |c_n|^2 \\frac{|G_n|^2}{2},\n$$\n这是根据标准正交性得出的，因为交叉项会消失。\n\n我们选择一个模型态，其系数为 $c_n = \\mathcal{C} \\, e^{-\\alpha n^2}$，其中 $\\alpha  0$ 控制衰减率。归一化常数为\n$$\n\\mathcal{C} = \\left( \\sum_{n=-\\infty}^{\\infty} e^{-2 \\alpha n^2} \\right)^{-1/2}.\n$$\n在实践中，我们通过在 $\\pm N_{\\text{ref}}$ 处对称地截断无穷级数来计算参考期望值 $\\langle \\hat{T} \\rangle_{\\text{ref}}$，$N_{\\text{ref}}$ 的选择使得 $e^{-2 \\alpha N_{\\text{ref}}^2}  \\varepsilon$，其中 $\\varepsilon = 10^{-12}$ 是一个数值公差。这确保了被忽略的尾部小于该公差。注意到归一化常数在期望值计算中被抵消了，因为它同时出现在加权平均的分子和分母中；具体来说，\n$$\n\\langle \\hat{T} \\rangle_{\\text{ref}} \\approx \\frac{\\sum_{n=-N_{\\text{ref}}}^{N_{\\text{ref}}} e^{-2 \\alpha n^2} \\frac{|G_n|^2}{2}}{\\sum_{n=-N_{\\text{ref}}}^{N_{\\text{ref}}} e^{-2 \\alpha n^2}},\n\\qquad G_n = \\frac{2 \\pi n}{L}.\n$$\n\n为了评估相对于动能截断 $E_{\\text{cut}}$ 的收敛性，我们将计算限制在由满足 $(1/2)|G_n|^2 \\leq E_{\\text{cut}}$ 的平面波组成的子空间内。对 $(1/2)(2\\pi n/L)^2 \\leq E_{\\text{cut}}$ 求解 $n$ 得到\n$$\n|n| \\leq n_{\\max} = \\left\\lfloor \\frac{L}{2\\pi} \\sqrt{2 E_{\\text{cut}}} \\right\\rfloor.\n$$\n然后我们用截断范数 $S_{\\text{trunc}} = \\sum_{|n|\\leq n_{\\max}} e^{-2 \\alpha n^2}$ 来重新归一化截断态。因此，截断期望值为\n$$\n\\langle \\hat{T} \\rangle_{\\text{trunc}}\n= \\frac{\\sum_{n=-n_{\\max}}^{n_{\\max}} e^{-2 \\alpha n^2} \\frac{|G_n|^2}{2}}{\\sum_{n=-n_{\\max}}^{n_{\\max}} e^{-2 \\alpha n^2}},\n\\qquad G_n = \\frac{2 \\pi n}{L}.\n$$\n绝对误差为\n$$\n\\Delta_T = \\left| \\langle \\hat{T} \\rangle_{\\text{trunc}} - \\langle \\hat{T} \\rangle_{\\text{ref}} \\right|,\n$$\n以 Hartree 为单位表示。\n\n算法步骤如下：\n1. 对于每个测试用例 $(L, \\alpha, E_{\\text{cut}})$，从 $E_{\\text{cut}}$ 和 $L$ 计算 $n_{\\max}$。这定义了截断求和的范围。\n2. 选择 $N_{\\text{ref}}$ 使得 $e^{-2 \\alpha N_{\\text{ref}}^2}  \\varepsilon$，其中 $\\varepsilon = 10^{-12}$。可以反解该界限，得到 $N_{\\text{ref}} \\ge \\sqrt{-\\ln(\\varepsilon)/(2\\alpha)}$，然后向上取整为整数。\n3. 通过对 $(1/2)|G_n|^2$ 在 $n = -n_{\\max}, \\ldots, n_{\\max}$ 范围内使用权重 $e^{-2 \\alpha n^2}$ 进行加权平均，来计算截断期望值 $\\langle \\hat{T} \\rangle_{\\text{trunc}}$，其中 $G_n = 2\\pi n / L$。\n4. 类似地，在 $n = -N_{\\text{ref}}, \\ldots, N_{\\text{ref}}$ 范围内计算参考期望值 $\\langle \\hat{T} \\rangle_{\\text{ref}}$。\n5. 报告每个测试用例的 $\\Delta_T$，以 Hartree 为单位。\n\n此过程依赖于周期性晶胞中平面波基的完备性，这确保了随着 $E_{\\text{cut}}$ 增加和 $n_{\\max}$ 增长，截断子空间能近似完整的期望值。选择在 $n$ 上呈高斯衰减的 $c_n$ 会产生一个平滑的测试态，其动能期望值是良定义的，并在指定的公差下快速收敛。最终的程序精确地实现了这个序列，并以要求的格式为提供的测试套件输出绝对误差列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef n_max_from_Ecut(L_bohr: float, Ecut_hartree: float) -> int:\n    \"\"\"\n    Compute n_max from kinetic energy cutoff E_cut in Hartree for a 1D cell of length L in bohr.\n    In atomic units, T_n = (1/2) * G_n^2, with G_n = 2*pi*n / L.\n    Include modes with (1/2)*G_n^2 = Ecut => |n| = n_max.\n    \"\"\"\n    if Ecut_hartree == 0.0:\n        return 0\n    return int(np.floor((L_bohr / (2.0 * np.pi)) * np.sqrt(2.0 * Ecut_hartree)))\n\ndef N_ref_from_alpha(alpha: float, tol: float = 1e-12) -> int:\n    \"\"\"\n    Choose N_ref such that exp(-2*alpha*N_ref^2)  tol.\n    Invert bound: N_ref >= sqrt(-ln(tol)/(2*alpha)).\n    \"\"\"\n    if alpha == 0.0:\n        raise ValueError(\"alpha must be positive.\")\n    # Handle extremely small tol to avoid overflow; use logs\n    target = -np.log(tol)\n    N_ref = int(np.ceil(np.sqrt(target / (2.0 * alpha))))\n    return max(N_ref, 0)\n\ndef kinetic_energy_expectation_truncated(L: float, alpha: float, n_max: int) -> float:\n    \"\"\"\n    Compute truncated, renormalized expectation of kinetic energy for c_n ~ exp(-alpha*n^2).\n    Returns value in Hartree.\n    \"\"\"\n    if n_max  0:\n        n_max = 0\n    n_vals = np.arange(-n_max, n_max + 1, dtype=int)\n    # Weights are |c_n|^2 up to a constant that cancels in the ratio.\n    weights = np.exp(-2.0 * alpha * (n_vals.astype(float) ** 2))\n    G = (2.0 * np.pi * n_vals.astype(float)) / L\n    energies = 0.5 * (G ** 2)\n    denom = np.sum(weights)\n    # Avoid division by zero (only possible if n_max=-1, which we disallow, or pathological alpha)\n    if denom == 0.0:\n        return 0.0\n    numer = np.sum(weights * energies)\n    return numer / denom\n\ndef kinetic_energy_expectation_reference(L: float, alpha: float, tol: float = 1e-12) -> float:\n    \"\"\"\n    Compute reference expectation by summing symmetrically to N_ref determined by tolerance.\n    Returns value in Hartree.\n    \"\"\"\n    N_ref = N_ref_from_alpha(alpha, tol=tol)\n    n_vals = np.arange(-N_ref, N_ref + 1, dtype=int)\n    weights = np.exp(-2.0 * alpha * (n_vals.astype(float) ** 2))\n    G = (2.0 * np.pi * n_vals.astype(float)) / L\n    energies = 0.5 * (G ** 2)\n    denom = np.sum(weights)\n    if denom == 0.0:\n        return 0.0\n    numer = np.sum(weights * energies)\n    return numer / denom\n\ndef absolute_error_energy(L: float, alpha: float, Ecut: float, tol: float = 1e-12) -> float:\n    \"\"\"\n    Compute absolute error |E_trunc - E_ref| in Hartree for given parameters.\n    \"\"\"\n    nmax = n_max_from_Ecut(L, Ecut)\n    E_trunc = kinetic_energy_expectation_truncated(L, alpha, nmax)\n    E_ref = kinetic_energy_expectation_reference(L, alpha, tol=tol)\n    return float(abs(E_trunc - E_ref))\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple is (L in bohr, alpha unitless (>0), E_cut in Hartree)\n    test_cases = [\n        (10.0, 0.3, 5.0),    # General case\n        (10.0, 0.3, 0.0),    # Boundary case: only n=0 included\n        (10.0, 0.05, 5.0),   # Slow-decay case\n        (5.0, 0.3, 5.0),     # Different cell size\n        (10.0, 0.3, 100.0),  # Very large cutoff (near-complete)\n    ]\n\n    results = []\n    for L, alpha, Ecut in test_cases:\n        err = absolute_error_energy(L, alpha, Ecut, tol=1e-12)\n        results.append(err)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}