{
    "hands_on_practices": [
        {
            "introduction": "随机游走的一个核心特征是其均方位移（Mean Squared Displacement, MSD）。这个量度描述了粒子偏离其起点的平均“距离”的平方随时间如何增长。通过计算一个简单的二维晶格上的随机游走模型的均方位移 ，我们可以亲手揭示正常扩散过程的标志性特征——MSD与步数（或时间）成正比。这一基本关系是连接离散随机游走和宏观扩散现象的桥梁。",
            "id": "1330646",
            "problem": "一个简化的晶格粒子扩散模型将其运动描述为二维笛卡尔网格上的随机游走。粒子从原点 $(0,0)$ 开始。在每个离散时间步，粒子从其当前位置移动到相邻的格点。每一步从沿网格轴的四个单位长度的可能移动中等概率地选择：沿x轴正方向、x轴负方向、y轴正方向或y轴负方向。经过总共 $N$ 步这样的移动后，粒子位于最终位置 $(X_N, Y_N)$。\n\n计算 $N$ 步后粒子与原点之间欧几里得距离平方的期望值。将你的答案表示为 $N$ 的函数。",
            "solution": "设在时间 $t$ 的移动步长为随机向量 $(\\Delta X_{t}, \\Delta Y_{t})$，其中\n$$\n(\\Delta X_{t}, \\Delta Y_{t})=\\begin{cases}\n(1,0)  \\text{概率为 } \\frac{1}{4},\\\\\n(-1,0)  \\text{概率为 } \\frac{1}{4},\\\\\n(0,1)  \\text{概率为 } \\frac{1}{4},\\\\\n(0,-1)  \\text{概率为 } \\frac{1}{4}。\n\\end{cases}\n$$\n$N$ 步之后的位置是\n$$\nX_{N}=\\sum_{t=1}^{N}\\Delta X_{t}, \\qquad Y_{N}=\\sum_{t=1}^{N}\\Delta Y_{t}.\n$$\n我们要求解 $\\mathbb{E}[X_{N}^{2}+Y_{N}^{2}]$，根据期望的线性性，它等于\n$$\n\\mathbb{E}[X_{N}^{2}+Y_{N}^{2}]=\\mathbb{E}[X_{N}^{2}]+\\mathbb{E}[Y_{N}^{2}].\n$$\n对于x分量，计算单步增量的前两阶矩：\n$$\n\\mathbb{E}[\\Delta X_{t}]=\\left(1\\right)\\frac{1}{4}+\\left(-1\\right)\\frac{1}{4}+\\left(0\\right)\\frac{1}{2}=0,\n$$\n$$\n\\mathbb{E}[\\Delta X_{t}^{2}]=\\left(1^{2}\\right)\\frac{1}{4}+\\left((-1)^{2}\\right)\\frac{1}{4}+\\left(0^{2}\\right)\\frac{1}{2}=\\frac{1}{2}.\n$$\n因此 $\\mathrm{Var}(\\Delta X_{t})=\\mathbb{E}[\\Delta X_{t}^{2}]-\\left(\\mathbb{E}[\\Delta X_{t}]\\right)^{2}=\\frac{1}{2}$。由于各步是独立同分布的，\n$$\n\\mathrm{Var}(X_{N})=\\sum_{t=1}^{N}\\mathrm{Var}(\\Delta X_{t})=N\\cdot\\frac{1}{2}=\\frac{N}{2}.\n$$\n此外，$\\mathbb{E}[X_{N}]=\\sum_{t=1}^{N}\\mathbb{E}[\\Delta X_{t}]=0$，所以\n$$\n\\mathbb{E}[X_{N}^{2}]=\\mathrm{Var}(X_{N})+\\left(\\mathbb{E}[X_{N}]\\right)^{2}=\\frac{N}{2}.\n$$\n根据对称性，对 $Y_{N}$ 也同样成立：\n$$\n\\mathbb{E}[\\Delta Y_{t}]=0, \\qquad \\mathbb{E}[\\Delta Y_{t}^{2}]=\\frac{1}{2}, \\qquad \\mathbb{E}[Y_{N}^{2}]=\\frac{N}{2}.\n$$\n因此，\n$$\n\\mathbb{E}[X_{N}^{2}+Y_{N}^{2}]=\\frac{N}{2}+\\frac{N}{2}=N.\n$$\n这就是 $N$ 步后与原点之间欧几里得距离平方的期望值。",
            "answer": "$$\\boxed{N}$$"
        },
        {
            "introduction": "在理解了随机游走“走多远”之后，一个更深刻的问题是关于其探索的性质：“它会回家吗？”。这个问题引出了随机过程理论中的一个核心概念——常返性（recurrence）。此练习  引导我们通过精确的组合路径计数，计算一维对称随机游走在偶数步后返回原点的概率，并利用斯特林公式（Stirling's formula）进行渐近分析，以推断其长期行为。这个过程展示了如何从微观的离散步骤推导出宏观的、几乎必然发生的常返现象。",
            "id": "3800177",
            "problem": "考虑一个离散时间一维对称随机游走 $\\{S_{k}\\}_{k \\geq 0}$，其定义为 $S_{0} = 0$ 和 $S_{k} = \\sum_{j=1}^{k} X_{j}$，其中 $\\{X_{j}\\}_{j \\geq 1}$ 是独立同分布的随机变量，分别以 $1/2$ 的概率取值 $+1$ 和 $-1$。该游走被看作是格点层面上的单尺度模型，其粗粒化行为在扩散尺度变换下与布朗运动相关。从独立性、同分布和离散时间马尔可夫性质的基本定义出发，完成以下任务：\n\n1. 通过计算可行路径数并除以总路径数进行归一化，计算出精确概率 $P(S_{2n} = 0)$，即游走在时间 $2n$ 返回原点的概率。请用一个关于 $n$ 的闭式解析表达式表示你的答案。\n\n2. 使用基于斯特林公式的渐近分析和离散时间马尔可夫链的常返判据，推断一维对称随机游走是否是常返的。你的推理必须从基本的离散路径计数角度开始，可以引用马尔可夫链理论中经过充分检验的渐近近似和标准常返判据。将最终结论表述为随机游走无限次返回原点的概率。\n\n你的最终答案必须是 $P(S_{2n} = 0)$ 的一个闭式解析表达式和表示常返结论的一个实数，两者共同写成一个双元素行矩阵。不需要四舍五入，也不涉及物理单位。",
            "solution": "问题分为两部分。第一部分要求计算一维对称随机游走的精确概率。第二部分要求使用渐近分析对此游走的常返性得出结论。\n\n第1部分：$P(S_{2n} = 0)$ 的计算\n\n一维对称随机游走 $\\{S_k\\}_{k \\geq 0}$ 定义为 $S_0 = 0$ 和 $S_k = \\sum_{j=1}^{k} X_j$，其中 $X_j$ 是独立同分布（i.i.d.）的随机变量，满足 $P(X_j = +1) = P(X_j = -1) = 1/2$。\n\n为使游走者在时间 $k$ 位于原点，其位置 $S_k$ 必须为 $0$。由于每一步 $X_j$ 不是 $+1$ 就是 $-1$，所以 $k$ 步之后的位置 $S_k$ 与 $k$ 具有相同的奇偶性。也就是说，如果 $k$ 是奇数，则 $S_k$ 必定是奇数；如果 $k$ 是偶数，则 $S_k$ 必定是偶数。为了使 $S_k$ 为 $0$，$k$ 必须是偶数。因此，我们考虑某个非负整数 $n$ 在时间 $k=2n$ 的位置。\n\n设在长度为 $2n$ 的路径中，向右（值为 $+1$）的步数为 $n_+$，向左（值为 $-1$）的步数为 $n_-$。\n总步数为 $2n$，因此我们有关系式：\n$$n_+ + n_- = 2n$$\n最终位置是所有步数的总和：\n$$S_{2n} = (+1)n_+ + (-1)n_- = n_+ - n_-$$\n为使游走返回原点，必须有 $S_{2n} = 0$，这意味着：\n$$n_+ - n_- = 0 \\implies n_+ = n_-$$\n将 $n_+ = n_-$ 代入第一个方程，得到 $n_+ + n_+ = 2n$，即 $2n_+ = 2n$，因此 $n_+ = n$。从而 $n_- = n$。\n这意味着，长度为 $2n$ 的路径要在原点结束，它必须恰好包含 $n$ 步 $+1$ 和 $n$ 步 $-1$。\n\n长度为 $2n$ 的不同路径总数为 $2^{2n}$，因为在 $2n$ 步中的每一步都有两种选择，且每种选择都是独立的。\n任何一条特定路径（例如，先走 $n$ 步 $+1$ 再走 $n$ 步 $-1$）的概率是 $(\\frac{1}{2})^{2n}$，因为这些步是独立同分布的随机变量。\n\n在原点结束的可行路径数，是在长度为 $2n$ 的序列中排列 $n$ 个“$+1$”符号和 $n$ 个“$-1$”符号的方法数。这是一个组合问题，这种排列的数量由二项式系数 $\\binom{2n}{n}$ 给出。\n$$\\text{可行路径数} = \\binom{2n}{n} = \\frac{(2n)!}{n!n!}$$\n事件 $S_{2n} = 0$ 的概率是可行路径数与任意单条路径概率的乘积：\n$$P(S_{2n} = 0) = (\\text{可行路径数}) \\times (\\text{单条路径的概率})$$\n$$P(S_{2n} = 0) = \\binom{2n}{n} \\left(\\frac{1}{2}\\right)^{2n}$$\n这就是游走在时间 $2n$ 返回原点概率的闭式解析表达式。\n\n第2部分：一维对称随机游走的常返性\n\n根据离散时间马尔可夫链的理论，如果从状态 $i$ 出发，最终返回状态 $i$ 的概率为 $1$，则状态 $i$ 被定义为常返的。对于一个不可约马尔可夫链（其中任何状态都可以从任何其他状态到达），所有状态都属于同一类型：要么全部是常返的，要么全部是暂留的。整数集 $\\mathbb{Z}$ 上的一维对称随机游走是不可约的。\n\n判断状态 $i$ 是否常返的一个标准判据是，返回状态 $i$ 的期望次数是无限的。这等价于在时间 $k$ 处于状态 $i$ 的概率之和（对所有 $k \\geq 1$ 求和）发散：\n$$\\text{状态 } i \\text{ 是常返的} \\iff \\sum_{k=1}^{\\infty} p_{ii}^{(k)} = \\infty$$\n其中 $p_{ii}^{(k)}$ 是从状态 $i$ 出发后，在时间 $k$ 处于状态 $i$ 的概率。在我们的例子中，状态是原点 $i=0$，且 $p_{00}^{(k)} = P(S_k = 0 \\mid S_0 = 0) = P(S_k=0)$。如前所述，当 $k$ 为奇数时，$P(S_k = 0) = 0$。因此，该判据变为：\n$$\\text{状态 } 0 \\text{ 是常返的} \\iff \\sum_{n=1}^{\\infty} P(S_{2n} = 0) = \\infty$$\n为了分析此级数的收敛性，我们使用斯特林近似公式 $m! \\sim \\sqrt{2\\pi m} \\left(\\frac{m}{e}\\right)^m$ 来研究当 $n$ 很大时 $P(S_{2n} = 0)$ 的渐近行为。\n\n让我们将此应用于 $P(S_{2n} = 0)$ 的表达式：\n$$P(S_{2n} = 0) = \\frac{(2n)!}{(n!)^2} \\left(\\frac{1}{2}\\right)^{2n}$$\n二项式系数 $\\binom{2n}{n}$ 的近似值为：\n$$\\binom{2n}{n} = \\frac{(2n)!}{(n!)^2} \\sim \\frac{\\sqrt{2\\pi(2n)} \\left(\\frac{2n}{e}\\right)^{2n}}{\\left(\\sqrt{2\\pi n} \\left(\\frac{n}{e}\\right)^n\\right)^2} = \\frac{\\sqrt{4\\pi n} \\left(\\frac{2n}{e}\\right)^{2n}}{2\\pi n \\left(\\frac{n}{e}\\right)^{2n}}$$\n化简该表达式：\n$$\\binom{2n}{n} \\sim \\frac{2\\sqrt{\\pi n}}{2\\pi n} \\frac{(2n)^{2n}}{(n)^{2n}} \\frac{e^{-2n}}{e^{-2n}} = \\frac{1}{\\sqrt{\\pi n}} \\frac{2^{2n}n^{2n}}{n^{2n}} = \\frac{2^{2n}}{\\sqrt{\\pi n}}$$\n现在我们将其代回概率表达式中：\n$$P(S_{2n} = 0) = \\binom{2n}{n} \\left(\\frac{1}{2}\\right)^{2n} \\sim \\frac{2^{2n}}{\\sqrt{\\pi n}} \\left(\\frac{1}{2}\\right)^{2n} = \\frac{1}{\\sqrt{\\pi n}}$$\n因此，级数 $\\sum_{n=1}^{\\infty} P(S_{2n} = 0)$ 的行为与级数 $\\sum_{n=1}^{\\infty} \\frac{1}{\\sqrt{\\pi n}}$ 类似。这是一个形式为 $\\sum_{n=1}^{\\infty} c \\cdot n^{-p}$ 的p-级数，其中 $c = 1/\\sqrt{\\pi}$ 且 $p=1/2$。p-级数审敛法表明，如果 $p \\leq 1$ 该级数发散，如果 $p > 1$ 则收敛。由于 $p = 1/2 \\leq 1$，该级数发散。\n$$\\sum_{n=1}^{\\infty} P(S_{2n} = 0) = \\infty$$\n因此，状态 $0$ 是常返的。由于该随机游走是不可约的，所有状态都是常返的。\n\n马尔可夫链理论中的一个基本定理指出，如果一个状态是常返的，那么从该状态出发，无限次访问该状态的概率是 $1$。这是将第二Borel-Cantelli引理应用于返回原点事件的结果。\n因此，一维对称随机游走无限次返回原点的概率是 $1$。\n\n最终答案的两部分是 $P(S_{2n} = 0)$ 的表达式和表示无限次返回原点概率的值 $1$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\binom{2n}{n} \\left(\\frac{1}{2}\\right)^{2n}  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "随机游走向布朗运动的过渡是多尺度建模中的一个经典范例，但这并非普适的唯一结局。这个极限过程的性质深刻地依赖于单步位移的统计特性。本练习  通过特征函数这一强大工具，直接对比了两种尺度变换下的极限行为：一种是基于有限方差步长的随机游走，其极限是经典的布朗运动；另一种是基于具有无限方差的柯西分布（Cauchy distribution）步长，其极限导向了被称为 Lévy 飞行的异常扩散过程。通过这个对比，我们能够深刻理解中心极限定理的作用及其失效的条件，从而认识到布朗运动普适性的边界。",
            "id": "1330635",
            "problem": "考虑两个不同的一维随机游走模型，用于描述一个粒子在 $n$ 个离散时间步后的位置 $S_n = \\sum_{i=1}^{n} \\xi_i$，其中每一步 $\\xi_i$ 都是一个独立同分布的随机变量。\n\n在一个**正常扩散**的理论模型中，粒子在宏观时间 $t$ 的位置由一个标度化随机游走的连续极限来描述。设此过程为 $W(t) = \\lim_{N \\to \\infty} W_N(t)$，其中 $N$ 是一个大的标度因子。其离散时间近似由下式给出\n$$W_N(t) = \\frac{1}{\\sqrt{N}} \\sum_{i=1}^{\\lfloor Nt \\rfloor} X_i$$\n这里，单步 $X_i$ 从一个概率分布中抽取，该分布具有零均值（$\\langle X \\rangle = 0$）和有限方差（$\\langle X^2 \\rangle = \\sigma^2$）。\n\n相比之下，考虑一个**异常扩散**模型，其中罕见的大步长主导了粒子的轨迹。这个过程 $L(t) = \\lim_{N \\to \\infty} L_N(t)$，采用不同的标度方式建模：\n$$L_N(t) = \\frac{1}{N} \\sum_{i=1}^{\\lfloor Nt \\rfloor} Y_i$$\n步长 $Y_i$ 从对称柯西分布中抽取，其概率密度函数 (PDF) 为 $p(y) = \\frac{1}{\\pi} \\frac{\\gamma}{y^2 + \\gamma^2}$，其中 $\\gamma$ 是一个正的尺度参数。值得注意的是，该分布的均值未定义，方差为无穷大。\n\n对于一个随机过程 $Z(t)$，其统计性质可以通过其特征函数 $\\phi_Z(k, t) = \\langle \\exp(ikZ(t)) \\rangle$ 来捕捉，其中 $k$ 是一个对应于空间频率的实数。\n\n您的任务是比较这两个极限过程的统计性质。具体来说，对于给定的正时间 $t_0 > 0$ 和正空间频率 $k_0 > 0$，计算比率 $R = \\frac{\\ln|\\phi_W(k_0, t_0)|}{\\ln|\\phi_L(k_0, t_0)|}$。请用 $\\sigma$、$\\gamma$ 和 $k_0$ 的符号表达式给出您的答案。",
            "solution": "我们从正常扩散过程开始。对于标度化游走\n$$\nW_{N}(t)=\\frac{1}{\\sqrt{N}}\\sum_{i=1}^{\\lfloor Nt\\rfloor}X_{i},\n$$\n利用独立性，其特征函数为\n$$\n\\phi_{W_{N}}(k,t)=\\left\\langle \\exp\\!\\left(ik\\,W_{N}(t)\\right)\\right\\rangle=\\left[\\phi_{X}\\!\\left(\\frac{k}{\\sqrt{N}}\\right)\\right]^{\\lfloor Nt\\rfloor},\n$$\n其中 $\\phi_{X}(u)=\\langle \\exp(iuX)\\rangle$ 是 $X$ 的特征函数。由于 $\\langle X\\rangle=0$ 且 $\\langle X^{2}\\rangle=\\sigma^{2}  \\infty$，小 $u$ 的展开式为\n$$\n\\phi_{X}(u)=1-\\frac{1}{2}\\sigma^{2}u^{2}+o(u^{2}).\n$$\n因此，\n$$\n\\ln \\phi_{W_{N}}(k,t)=\\lfloor Nt\\rfloor \\ln\\!\\left(1-\\frac{1}{2}\\sigma^{2}\\frac{k^{2}}{N}+o\\!\\left(\\frac{1}{N}\\right)\\right)\n= -\\frac{1}{2}\\sigma^{2}t\\,k^{2}+o(1),\n$$\n所以在 $N\\to\\infty$ 的极限下，\n$$\n\\phi_{W}(k,t)=\\lim_{N\\to\\infty}\\phi_{W_{N}}(k,t)=\\exp\\!\\left(-\\frac{1}{2}\\sigma^{2}t\\,k^{2}\\right).\n$$\n因此\n$$\n\\ln|\\phi_{W}(k_{0},t_{0})|=-\\frac{1}{2}\\sigma^{2}t_{0}\\,k_{0}^{2}.\n$$\n\n接下来考虑异常扩散过程\n$$\nL_{N}(t)=\\frac{1}{N}\\sum_{i=1}^{\\lfloor Nt\\rfloor}Y_{i},\n$$\n其中 $Y_{i}$ 是独立同分布的对称柯西变量，尺度参数为 $\\gamma$，其特征函数为\n$$\n\\phi_{Y}(u)=\\exp(-\\gamma|u|).\n$$\n根据独立性，\n$$\n\\phi_{L_{N}}(k,t)=\\left[\\phi_{Y}\\!\\left(\\frac{k}{N}\\right)\\right]^{\\lfloor Nt\\rfloor}\n=\\exp\\!\\left(-\\lfloor Nt\\rfloor\\,\\gamma\\,\\frac{|k|}{N}\\right).\n$$\n取 $N\\to\\infty$ 极限得到\n$$\n\\phi_{L}(k,t)=\\exp\\!\\left(-\\gamma t\\,|k|\\right),\n$$\n所以\n$$\n\\ln|\\phi_{L}(k_{0},t_{0})|=-\\gamma t_{0}\\,|k_{0}|.\n$$\n\n因此，所求的比率为\n$$\nR=\\frac{\\ln|\\phi_{W}(k_{0},t_{0})|}{\\ln|\\phi_{L}(k_{0},t_{0})|}\n=\\frac{-\\frac{1}{2}\\sigma^{2}t_{0}k_{0}^{2}}{-\\gamma t_{0}|k_{0}|}\n=\\frac{\\sigma^{2}k_{0}^{2}}{2\\gamma |k_{0}|}.\n$$\n对于 $k_{0}>0$，我们有 $|k_{0}|=k_{0}$，所以\n$$\nR=\\frac{\\sigma^{2}k_{0}}{2\\gamma}.\n$$\n该表达式按要求仅依赖于 $\\sigma$、$\\gamma$ 和 $k_{0}$，而 $t_{0}$ 被消掉了。",
            "answer": "$$\\boxed{\\frac{\\sigma^{2}k_{0}}{2\\gamma}}$$"
        }
    ]
}