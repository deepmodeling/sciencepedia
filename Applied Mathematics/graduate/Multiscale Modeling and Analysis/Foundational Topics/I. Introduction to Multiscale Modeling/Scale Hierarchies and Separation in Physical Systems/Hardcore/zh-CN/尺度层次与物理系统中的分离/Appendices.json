{
    "hands_on_practices": [
        {
            "introduction": "本练习将探讨一个经典的奇异摄动问题，其中不同的物理效应在区域的不同部分呈现主导地位。通过分析一个对流远大于扩散的输运模型 ，您将练习使用主导平衡、坐标伸展和渐近匹配等核心技术。掌握这些方法对于构建在所有相关尺度上都统一有效的近似解至关重要。",
            "id": "3804929",
            "problem": "考虑一个稳定的一维对流-扩散模型的奇异摄动边值问题，\n$$\n-\\epsilon\\,u''(x) + u'(x) = 1,\\quad x \\in (0,1),\n$$\n其边界条件为\n$$\nu(0) = 0,\\quad u(1) = 0,\n$$\n其中 $0  \\epsilon \\ll 1$ 是一个小的无量纲参数，表示扩散效应与对流效应之比。仅从控制方程和边界条件出发：\n\n- 使用主导平衡法推断，确定任何边界层的位置和厚度标度。\n- 推导外（正则）展开式，直至并包含 $\\epsilon$ 阶项。\n- 使用适当的拉伸坐标，在正确的边界处推导相同代数阶的内（边界层）展开式，并通过在重叠区域展开外解来建立匹配条件。\n- 构建一个在 $\\epsilon$ 中渐近有效到一阶代数阶的一致有效复合近似解。\n\n将最终的复合近似解表述为关于 $x$ 和 $\\epsilon$ 的单个闭式表达式。无需单位。无需四舍五入。您的最终答案必须是单个解析表达式。",
            "solution": "所述问题是应用数学领域（特别是奇异摄动理论）中的一个标准的、适定的、有科学依据的边值问题。它模拟了一个稳态一维对流-扩散过程，其中对流作用远大于扩散作用（$0  \\epsilon \\ll 1$）。该问题提供了明确的微分方程、定义清晰的边界条件和一组精确的任务。因此，该问题被认为是有效的，并将按照要求的步骤构建解答。\n\n控制方程为\n$$-\\epsilon\\,u''(x) + u'(x) = 1, \\quad x \\in (0,1)$$\n边界条件为\n$$u(0) = 0, \\quad u(1) = 0$$\n\n**1. 主导平衡与边界层分析**\n\n在远离任何边界层的外部区域，我们假设 $u(x)$ 及其导数的标度为 $O(1)$。在极限 $\\epsilon \\to 0$ 下，项 $-\\epsilon u''$ 与 $u'$ 相比可以忽略不计。因此，主导平衡存在于对流项和源项之间：\n$$u'(x) \\approx 1$$\n这就是外方程。积分得到领先阶的外解：\n$$u_{\\text{out}}(x) = x + C$$\n这个一阶方程只能满足两个边界条件中的一个。小参数 $\\epsilon$ 乘以最高阶导数 $u''$ 是这种奇异性的来源，并使得在被忽略的项变得重要的区域必须存在一个边界层。\n\n为了确定边界层的位置，我们考虑外解应该满足哪个边界条件。对于对流占主导且流向为正 $x$ 方向（如 $u'$ 的正系数所示）的问题，信息从左向右传递。因此，外解通常由下游边界 $x=1$ 处的条件决定。然而，信息是从左向右传播的，外解应该满足上游边界条件 $x=0$。将 $u(0)=0$ 应用于 $u_{\\text{out}}(x) = x+C$ 得到 $C=0$。因此，领先阶的外解为 $u_{0}(x) = x$。该解满足 $u_{0}(0)=0$ 但在下游边界处不成立，因为 $u_{0}(1) = 1 \\neq 0$。在 $x=1$ 处的差异表明，必须在该处存在一个边界层来修正解并强制满足条件 $u(1)=0$。\n\n为了确定该边界层的厚度，我们引入一个以 $x=1$ 为中心的拉伸坐标 $X$。设边界层厚度为 $\\delta(\\epsilon)$。我们定义 $X = \\frac{1-x}{\\delta}$。\n导数变换如下：\n$$\\frac{d}{dx} = \\frac{dX}{dx}\\frac{d}{dX} = -\\frac{1}{\\delta}\\frac{d}{dX}$$\n$$\\frac{d^2}{dx^2} = \\frac{d}{dx}\\left(-\\frac{1}{\\delta}\\frac{d}{dX}\\right) = \\left(-\\frac{1}{\\delta}\\frac{d}{dX}\\right)^2 = \\frac{1}{\\delta^2}\\frac{d^2}{dX^2}$$\n将这些代入原常微分方程，得到以内变量 $X$ 表示的内方程：\n$$-\\epsilon\\left(\\frac{1}{\\delta^2}\\frac{d^2u}{dX^2}\\right) + \\left(-\\frac{1}{\\delta}\\frac{du}{dX}\\right) = 1$$\n在边界层内，奇异项 $-\\epsilon u''$ 必须与至少一个其他项同等重要。我们寻求主导平衡。\n\\begin{itemize}\n    \\item 平衡扩散项和对流项：$\\frac{\\epsilon}{\\delta^2} \\sim \\frac{1}{\\delta} \\implies \\delta \\sim \\epsilon$。\n    \\item 平衡扩散项和源项：$\\frac{\\epsilon}{\\delta^2} \\sim 1 \\implies \\delta \\sim \\sqrt{\\epsilon}$。\n\\end{itemize}\n如果我们选择 $\\delta=\\epsilon$，方程变为 $-\\frac{d^2u}{dX^2} - \\frac{du}{dX} = \\epsilon$。在领先阶（$O(1)$），我们有 $-u_{XX}-u_X=0$，这是一个有效的平衡。被忽略的项是 $O(\\epsilon)$。\n如果我们选择 $\\delta=\\sqrt{\\epsilon}$，方程变为 $-\\frac{d^2u}{dX^2} - \\frac{1}{\\sqrt{\\epsilon}}\\frac{du}{dX} = 1$。对流项的阶为 $1/\\sqrt{\\epsilon}$，远大于其他两个 $O(1)$ 项，这与平衡的前提相矛盾。\n因此，边界层厚度的正确标度是 $\\delta=\\epsilon$。边界层位于 $x=1$ 处，厚度为 $O(\\epsilon)$。\n\n**2. 外展开**\n\n我们寻求形式为 $u^{\\text{out}}(x) = u_0(x) + \\epsilon u_1(x) + O(\\epsilon^2)$ 的外解。代入常微分方程：\n$$-\\epsilon(u_0'' + \\epsilon u_1'' + \\dots) + (u_0' + \\epsilon u_1' + \\dots) = 1$$\n令 $\\epsilon$ 的各次幂系数相等：\n$O(1): u_0' = 1$\n$O(\\epsilon): u_1' = u_0''$\n\n外解必须满足 $x=0$ 处的边界条件，所以 $u^{\\text{out}}(0)=0$。这意味着 $u_0(0)=0$ 和 $u_1(0)=0$。\n由 $u_0'=1$ 和 $u_0(0)=0$，积分可得 $u_0(x) = x$。\n然后，对于 $O(\\epsilon)$ 项，有 $u_1' = u_0'' = \\frac{d^2}{dx^2}(x) = 0$。\n在条件 $u_1(0)=0$ 下积分 $u_1'=0$ 得到 $u_1(x) = 0$。\n因此，直到 $\\epsilon$ 阶的外展开式为：\n$$u^{\\text{out}}(x) = x + \\epsilon(0) = x$$\n\n**3. 内展开与匹配**\n\n边界层位于 $x=1$。我们使用拉伸坐标 $X = \\frac{1-x}{\\epsilon}$。常微分方程变换为：\n$$-\\frac{d^2u}{dX^2} - \\frac{du}{dX} = \\epsilon$$\n设内解为 $U^{\\text{in}}(X) = U_0(X) + \\epsilon U_1(X) + O(\\epsilon^2)$。代入变换后的常微分方程：\n$$-(U_0'' + \\epsilon U_1'' + \\dots) - (U_0' + \\epsilon U_1' + \\dots) = \\epsilon$$\n令 $\\epsilon$ 的各次幂系数相等：\n$O(1): -U_0'' - U_0' = 0 \\implies U_0'' + U_0' = 0$\n$O(\\epsilon): -U_1'' - U_1' = 1 \\implies U_1'' + U_1' = -1$\n\n内解必须满足 $x=1$ ($X=0$) 处的边界条件，所以 $U^{\\text{in}}(0)=0$。这意味着 $U_0(0)=0$ 和 $U_1(0)=0$。\n\n求解 $U_0(X)$：通解为 $U_0(X) = A_0 + B_0 e^{-X}$。条件 $U_0(0)=0$ 给出 $A_0+B_0=0$，所以 $B_0=-A_0$。因此，$U_0(X) = A_0(1-e^{-X})$。\n\n求解 $U_1(X)$：齐次解为 $A_1 + B_1 e^{-X}$。一个特解为 $U_{1,p}(X) = -X$。通解为 $U_1(X) = -X + A_1 + B_1 e^{-X}$。条件 $U_1(0)=0$ 给出 $A_1+B_1=0$，所以 $B_1=-A_1$。因此，$U_1(X) = -X + A_1(1-e^{-X})$。\n\n为了找到未知常数 $A_0$ 和 $A_1$，我们使用渐近匹配法。外解的内展开必须与内解的外展开在一个中间重叠区域中相匹配。\n\n外解的内展开（用 $X$ 表示 $u^{\\text{out}}$）：\n$$u^{\\text{out}}(x) = x = 1 - \\epsilon X$$\n这是一个到 $O(\\epsilon)$ 阶的展开式。\n\n内解的外展开（对于 $X \\to \\infty$ 的 $U^{\\text{in}}$）：\n$$U^{\\text{in}}(X) = U_0(X) + \\epsilon U_1(X) = A_0(1-e^{-X}) + \\epsilon[-X + A_1(1-e^{-X})]$$\n当 $X \\to \\infty$ 时，$e^{-X} \\to 0$。我们得到外展开式：\n$$\\lim_{X\\to\\infty} U^{\\text{in}}(X) \\approx A_0 + \\epsilon(-X + A_1) = A_0 + \\epsilon A_1 - \\epsilon X$$\n令两个展开式相等：\n$$1 - \\epsilon X = A_0 + \\epsilon A_1 - \\epsilon X$$\n比较 $\\epsilon$ 各次幂的系数：\n$O(1): 1 = A_0$\n$O(\\epsilon): -X = A_1 - X \\implies A_1 = 0$\n\n利用这些常数，内展开式被确定：\n$A_0=1 \\implies B_0 = -1$，所以 $U_0(X) = 1 - e^{-X}$。\n$A_1=0 \\implies B_1 = 0$，所以 $U_1(X) = -X$。\n直到 $O(\\epsilon)$ 阶的内展开式为：\n$$U^{\\text{in}}(X) = (1 - e^{-X}) - \\epsilon X$$\n\n**4. 一致有效复合近似**\n\n一个一致有效的复合近似解 $u_{\\text{comp}}(x)$，可以通过将外解和内解相加，再减去它们的公共部分（以避免重复计算）来构建。\n$$u_{\\text{comp}}(x) = u^{\\text{out}}(x) + U^{\\text{in}}(X) - (\\text{公共部分})$$\n该近似解应在一阶代数阶上有效，因此我们使用上面推导出的展开式。\n- 外解：$u^{\\text{out}}(x) = x$。\n- 内解：$U^{\\text{in}}(X) = (1-e^{-X}) - \\epsilon X$。\n- 公共部分：公共部分是两个解之间匹配的部分，即外解的内展开，$1 - \\epsilon X$。\n\n合并这些：\n$$u_{\\text{comp}}(x) = x + \\left[ (1 - e^{-X}) - \\epsilon X \\right] - (1 - \\epsilon X)$$\n$$u_{\\text{comp}}(x) = x + 1 - e^{-X} - \\epsilon X - 1 + \\epsilon X$$\n$$u_{\\text{comp}}(x) = x - e^{-X}$$\n最后，我们使用 $X=\\frac{1-x}{\\epsilon}$ 将原变量 $x$ 代回：\n$$u_{\\text{comp}}(x) = x - \\exp\\left(-\\frac{1-x}{\\epsilon}\\right)$$\n这是复合近似解，在 $x \\in [0,1]$ 上对 $\\epsilon$ 一阶一致有效。",
            "answer": "$$\\boxed{x - \\exp\\left(\\frac{x-1}{\\epsilon}\\right)}$$"
        },
        {
            "introduction": "与尺度分离发生在空间上隔离区域的边界层问题不同，许多系统具有遍布整个区域的微观结构。本练习  将介绍强大的均匀化方法，该方法使我们能够推导出描述复杂微结构介质平均行为的“有效”宏观方程。这是材料科学和多孔介质流动中的一个关键概念，用于从微观结构预测复合材料的整体属性。",
            "id": "3804884",
            "problem": "考虑散度形式的二阶椭圆偏微分方程（PDE）\n$$\n-\\nabla \\cdot \\left(A\\left(\\frac{x}{\\epsilon}\\right)\\nabla u^{\\epsilon}(x)\\right)= f(x)\\quad \\text{in }\\Omega,\\qquad u^{\\epsilon}(x)=0\\quad \\text{on }\\partial\\Omega,\n$$\n其中 $\\Omega\\subset\\mathbb{R}^{2}$ 是一个有界 Lipschitz 区域，$f\\in L^{2}(\\Omega)$，$\\epsilon>0$ 是一个小的无量纲尺度分离参数，$A(y)$ 是一个 $\\mathbb{R}^{2\\times 2}$ 的、以 $\\mathbb{Y}=(0,1)^{2}$ 为周期的系数。假设 $A(y)$ 是对称、有界且一致椭圆的：存在常数 $0  \\alpha \\leq \\beta  \\infty$，使得对于所有 $\\xi\\in\\mathbb{R}^{2}$ 和几乎所有 $y\\in\\mathbb{Y}$，\n$$\n\\alpha |\\xi|^{2}\\leq \\xi^{\\top}A(y)\\,\\xi\\leq \\beta |\\xi|^{2}.\n$$\n从该偏微分方程的弱形式和一个考虑了 $A(y)$ 周期性的形式化双尺度渐近展开出发，推导在极限 $\\epsilon\\to 0$ 下的均匀化方程，并构建用于刻画有效张量 $A^{\\text{eff}}$ 的相关周期性胞元问题。\n\n然后，将问题特殊化到以下简单的分层周期性介质：设 $A(y)$ 是对角阵，并且仅依赖于快变量 $y_{1}$，\n$$\nA(y)=\\begin{pmatrix}\na(y_{1})  0\\\\\n0  b(y_{1})\n\\end{pmatrix},\n$$\n在 $y_{1}$ 方向上周期为 1，其中\n$$\na(y_{1})=\\begin{cases}\na_{1},  0  y_{1}  \\theta,\\\\\na_{2},  \\theta  y_{1}  1,\n\\end{cases}\n\\qquad\nb(y_{1})=\\begin{cases}\nb_{1},  0  y_{1}  \\theta,\\\\\nb_{2},  \\theta  y_{1}  1,\n\\end{cases}\n$$\n其中参数 $\\theta\\in(0,1)$ 和正常数 $a_{1},a_{2},b_{1},b_{2}$ 是固定的，且满足 $0  \\alpha \\leq \\min\\{a_{1},a_{2},b_{1},b_{2}\\} \\leq \\max\\{a_{1},a_{2},b_{1},b_{2}\\} \\leq \\beta  \\infty$。针对此分层介质，显式地求解胞元问题，并计算有效张量 $A^{\\text{eff}}$ 的闭合形式解。\n\n请给出 $2\\times 2$ 矩阵 $A^{\\text{eff}}$ 关于 $a_{1}$, $a_{2}$, $b_{1}$, $b_{2}$ 和 $\\theta$ 的解析表达式作为最终答案。无需四舍五入；请报告一个精确的、无单位的符号表达式。",
            "solution": "该偏微分方程是散度形式，并带有快速振荡的周期性系数。目标是推导当 $\\epsilon\\to 0$ 时的均匀化极限，并通过胞元问题来刻画有效张量。推导过程从弱形式和形式化双尺度渐近展开开始。\n\n弱形式和一致有界。对于每个固定的 $\\epsilon0$，弱形式为：求 $u^{\\epsilon}\\in H_{0}^{1}(\\Omega)$，使得对于所有 $v\\in H_{0}^{1}(\\Omega)$，\n$$\n\\int_{\\Omega} A\\!\\left(\\frac{x}{\\epsilon}\\right)\\nabla u^{\\epsilon}(x)\\cdot \\nabla v(x)\\,dx = \\int_{\\Omega} f(x)\\,v(x)\\,dx.\n$$\n根据 Lax–Milgram 定理和 $A$ 的一致椭圆性，序列 $\\{u^{\\epsilon}\\}$ 在 $H_{0}^{1}(\\Omega)$ 中是有界的，因此存在弱收敛的子列。周期性介质的均匀化定理断言，$u^{\\epsilon}\\rightharpoonup u^{0}$ 于 $H_{0}^{1}(\\Omega)$ 中，且 $u^{\\epsilon}\\to u^{0}$ 于 $L^{2}(\\Omega)$ 中，其中 $u^{0}$ 是一个具有有效的、常系数张量 $A^{\\text{eff}}$ 的均匀化偏微分方程的解。\n\n形式化双尺度展开和胞元问题。引入快变量 $y=x/\\epsilon\\in\\mathbb{Y}$，并寻求一个渐近展开\n$$\nu^{\\epsilon}(x)=u_{0}(x)+\\epsilon\\,u_{1}(x,y)+\\epsilon^{2}\\,u_{2}(x,y)+\\cdots,\n$$\n其中 $u_{k}(x,y)$ 关于 $y$ 是 $\\mathbb{Y}$-周期的。梯度算子分裂为 $\\nabla_{x}\\mapsto \\nabla_{x}+\\epsilon^{-1}\\nabla_{y}$。代入偏微分方程并按 $\\epsilon$ 的幂次整理，在 $\\epsilon^{-2}$ 阶得到：\n$$\n-\\nabla_{y}\\cdot\\left(A(y)\\nabla_{y} u_{1}(x,y)\\right)=0.\n$$\n在 $\\epsilon^{-1}$ 阶：\n$$\n-\\nabla_{y}\\cdot\\left(A(y)\\left(\\nabla_{x} u_{0}(x)+\\nabla_{y} u_{1}(x,y)\\right)\\right)=0.\n$$\n这表明 $u_{1}$ 通过校正函数与 $\\nabla_{x}u_{0}$ 呈线性关系。设 $u_{1}(x,y)=\\sum_{i=1}^{2} w^{i}(y)\\,\\partial_{x_{i}} u_{0}(x)$，其中 $w^{i}$ 是 $\\mathbb{Y}$-周期且均值为零。于是，$\\epsilon^{-1}$ 阶的方程解耦为针对每个方向 $i\\in\\{1,2\\}$ 的胞元问题：\n$$\n-\\nabla_{y}\\cdot\\left(A(y)\\left(e_{i}+\\nabla_{y} w^{i}(y)\\right)\\right)=0\\quad \\text{in }\\mathbb{Y},\\qquad w^{i}\\ \\text{$\\mathbb{Y}$-periodic},\\ \\ \\int_{\\mathbb{Y}} w^{i}(y)\\,dy=0,\n$$\n其中 $e_{i}$ 是 $\\mathbb{R}^{2}$ 中的标准基向量。对 $\\epsilon^{0}$ 阶方程进行平均，或使用经典的通量平均原理，得到均匀化方程\n$$\n-\\nabla\\cdot\\left(A^{\\text{eff}}\\nabla u_{0}(x)\\right)=f(x)\\quad \\text{in }\\Omega,\\qquad u_{0}(x)=0\\quad \\text{on }\\partial\\Omega,\n$$\n其有效张量由下式刻画\n$$\nA^{\\text{eff}}_{ij}=\\int_{\\mathbb{Y}} \\left[A(y)\\left(e_{i}+\\nabla_{y} w^{i}(y)\\right)\\right]\\cdot e_{j}\\,dy,\\qquad i,j\\in\\{1,2\\}.\n$$\n因为 $|\\mathbb{Y}|=1$，该积分等于在 $\\mathbb{Y}$ 上的平均值。\n\n特殊化到分层对角介质。设\n$$\nA(y)=\\begin{pmatrix} a(y_{1})  0\\\\ 0  b(y_{1})\\end{pmatrix},\\qquad a(y_{1}),b(y_{1})\\ \\text{$1$-periodic in }y_{1}.\n$$\n由于系数仅依赖于 $y_{1}$ 且为对角结构，校正函数可选择为仅依赖于 $y_{1}$。记 $w^{i}(y)=w^{i}(y_{1})$。胞元问题变为关于 $y_{1}$ 的常微分方程。\n\n方向 $i=1$。胞元问题是\n$$\n-\\nabla_{y}\\cdot\\left(A(y)\\left(e_{1}+\\nabla_{y} w^{1}(y)\\right)\\right)=0\n\\ \\Longleftrightarrow\\ \n-\\frac{d}{dy_{1}}\\left(a(y_{1})\\left(1+\\frac{dw^{1}}{dy_{1}}(y_{1})\\right)\\right)-\\frac{d}{dy_{2}}\\left(b(y_{1})\\frac{\\partial w^{1}}{\\partial y_{2}}\\right)=0.\n$$\n选择 $w^{1}$ 与 $y_{2}$ 无关会使第二项为零，方程简化为\n$$\n-\\frac{d}{dy_{1}}\\left(a(y_{1})\\left(1+\\frac{dw^{1}}{dy_{1}}(y_{1})\\right)\\right)=0.\n$$\n因此存在一个常数 $C_{1}$ 使得\n$$\na(y_{1})\\left(1+\\frac{dw^{1}}{dy_{1}}(y_{1})\\right)=C_{1}.\n$$\n根据周期性和零均值条件，我们有 $\\int_{0}^{1}\\frac{dw^{1}}{dy_{1}}(y_{1})\\,dy_{1}=0$。将该关系在一个周期上积分得到\n$$\n\\int_{0}^{1}\\left(\\frac{C_{1}}{a(y_{1})}-1\\right)\\,dy_{1}=0\n\\ \\Longrightarrow\\\nC_{1}\\int_{0}^{1}\\frac{1}{a(y_{1})}\\,dy_{1}=1\n\\ \\Longrightarrow\\\nC_{1}=\\left(\\int_{0}^{1}\\frac{1}{a(y_{1})}\\,dy_{1}\\right)^{-1}.\n$$\n相应的微观通量在 $y$ 中是常数：\n$$\nA(y)\\left(e_{1}+\\nabla_{y} w^{1}\\right)=\\begin{pmatrix} a(y_{1})\\left(1+\\frac{dw^{1}}{dy_{1}}\\right)\\\\ 0\\end{pmatrix}=\\begin{pmatrix} C_{1}\\\\ 0\\end{pmatrix}.\n$$\n因此，\n$$\nA^{\\text{eff}} e_{1}=\\int_{\\mathbb{Y}} A(y)\\left(e_{1}+\\nabla_{y} w^{1}\\right)\\,dy=\\begin{pmatrix} C_{1}\\\\ 0\\end{pmatrix},\n$$\n由此可得\n$$\nA^{\\text{eff}}_{11}=C_{1}=\\left(\\int_{0}^{1}\\frac{1}{a(y_{1})}\\,dy_{1}\\right)^{-1},\\qquad A^{\\text{eff}}_{21}=0.\n$$\n\n方向 $i=2$。胞元问题是\n$$\n-\\nabla_{y}\\cdot\\left(A(y)\\left(e_{2}+\\nabla_{y} w^{2}(y)\\right)\\right)=0\n\\ \\Longleftrightarrow\\\n-\\frac{d}{dy_{1}}\\left(a(y_{1})\\frac{dw^{2}}{dy_{1}}(y_{1})\\right)-\\frac{d}{dy_{2}}\\left(b(y_{1})\\left(1+\\frac{\\partial w^{2}}{\\partial y_{2}}\\right)\\right)=0.\n$$\n选择 $w^{2}$ 与 $y_{2}$ 无关；那么第二个散度项消失，因为 $b(y_{1})$ 与 $y_{2}$ 无关，我们得到\n$$\n-\\frac{d}{dy_{1}}\\left(a(y_{1})\\frac{dw^{2}}{dy_{1}}(y_{1})\\right)=0\n\\ \\Longrightarrow\\\na(y_{1})\\frac{dw^{2}}{dy_{1}}(y_{1})=C_{2}.\n$$\n在一个周期上积分并利用周期性，常数必须为 $C_{2}=0$，因此 $\\frac{dw^{2}}{dy_{1}}(y_{1})=0$，我们取 $w^{2}\\equiv 0$（均值为零）。此时通量为\n$$\nA(y)\\left(e_{2}+\\nabla_{y} w^{2}\\right)=\\begin{pmatrix} 0\\\\ b(y_{1})\\end{pmatrix}.\n$$\n在 $\\mathbb{Y}$ 上平均得到\n$$\nA^{\\text{eff}} e_{2}=\\int_{\\mathbb{Y}} \\begin{pmatrix} 0\\\\ b(y_{1})\\end{pmatrix}dy=\\begin{pmatrix} 0\\\\ \\int_{0}^{1} b(y_{1})\\,dy_{1}\\end{pmatrix},\n$$\n所以\n$$\nA^{\\text{eff}}_{12}=0,\\qquad A^{\\text{eff}}_{22}=\\int_{0}^{1} b(y_{1})\\,dy_{1}.\n$$\n\n因此，对于一般的 1-周期函数 $a(y_{1})$ 和 $b(y_{1})$，\n$$\nA^{\\text{eff}}=\\begin{pmatrix}\n\\left(\\displaystyle\\int_{0}^{1}\\frac{1}{a(y_{1})}\\,dy_{1}\\right)^{-1}  0\\\\\n0  \\displaystyle\\int_{0}^{1} b(y_{1})\\,dy_{1}\n\\end{pmatrix}.\n$$\n\n两相分层介质的闭合形式表达式。取\n$$\na(y_{1})=\\begin{cases}\na_{1},  0  y_{1}  \\theta,\\\\\na_{2},  \\theta  y_{1}  1,\n\\end{cases}\n\\quad\nb(y_{1})=\\begin{cases}\nb_{1},  0  y_{1}  \\theta,\\\\\nb_{2},  \\theta  y_{1}  1,\n\\end{cases}\n$$\n其中 $\\theta\\in(0,1)$。那么\n$$\n\\int_{0}^{1}\\frac{1}{a(y_{1})}\\,dy_{1}=\\frac{\\theta}{a_{1}}+\\frac{1-\\theta}{a_{2}},\n\\qquad\n\\int_{0}^{1} b(y_{1})\\,dy_{1}=\\theta\\,b_{1}+(1-\\theta)\\,b_{2}.\n$$\n因此有效张量为\n$$\nA^{\\text{eff}}=\n\\begin{pmatrix}\n\\left(\\dfrac{\\theta}{a_{1}}+\\dfrac{1-\\theta}{a_{2}}\\right)^{-1}  0\\\\\n0  \\theta\\,b_{1}+(1-\\theta)\\,b_{2}\n\\end{pmatrix}.\n$$\n至此完成了推导和计算。均匀化后的偏微分方程为 $-\\nabla\\cdot\\left(A^{\\text{eff}}\\nabla u^{0}\\right)=f$ 于 $\\Omega$ 中，且在 $\\partial\\Omega$ 上 $u^{0}=0$，而所要求的最终答案即为上述的 $2\\times 2$ 矩阵的闭合形式。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\left(\\dfrac{\\theta}{a_{1}}+\\dfrac{1-\\theta}{a_{2}}\\right)^{-1}  0\\\\[10pt] 0  \\theta\\,b_{1}+(1-\\theta)\\,b_{2}\\end{pmatrix}}$$"
        },
        {
            "introduction": "在掌握了推导简化模型的方法之后，一个至关重要的问题是如何验证它们，尤其是当模型是数据驱动或“学习”得到的时候。本练习  展示了如何运用经典的多尺度思想来解决这个现代挑战。通过从第一性原理推导反应扩散波前的标度律，我们将学习如何设计一个跨尺度的验证程序，以确保任何简化模型在正确的渐近极限下都遵守物理定律。",
            "id": "3804937",
            "problem": "一个带有逻辑斯谛源项的反应-扩散系统会展现出行波前，其宏观动力学行为源于微观输运和反应尺度的相互作用。考虑在一个长度为 $L$ 的有限区间上，标量场 $u(x,t)$ 的一维费希尔-科尔莫戈罗夫-彼得罗夫斯基-皮斯库诺夫（Fisher–KPP）方程，\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} + r\\, u \\left(1 - u\\right),\n$$\n其中 $D$ 是扩散系数，$r$ 是内禀增长率。假设一个单调波前从阶跃式初始数据演化并向右传播，并且一个学习到的降阶模型已被训练用于预测两个宏观量：渐进行波速度 $c$ 和波前厚度尺度 $\\delta$。\n\n从基本的输运和反应平衡论证以及在波前前缘的线性化出发，推导 $c$ 和 $\\delta$ 相对于 $D$ 和 $r$ 的渐进标度律。定义一个无量纲域尺度丹姆科勒数（Da）为\n$$\n\\mathrm{Da} = \\frac{r L^2}{D}.\n$$\n一个学习到的降阶模型返回形式如下的预测值 $c_{\\mathrm{hat}}(D,r,L)$ 和 $\\delta_{\\mathrm{hat}}(D,r,L)$\n$$\nc_{\\mathrm{hat}}(D,r,L) = \\kappa_c \\sqrt{D r}\\, f(\\mathrm{Da}), \\quad \\delta_{\\mathrm{hat}}(D,r,L) = \\kappa_{\\delta} \\sqrt{\\frac{D}{r}}\\, g(\\mathrm{Da}),\n$$\n其中\n$$\nf(\\mathrm{Da}) = 1 + \\alpha \\frac{\\mathrm{Da}^{\\beta}}{1 + \\mathrm{Da}^{\\beta}}, \\quad g(\\mathrm{Da}) = 1 + b \\frac{1}{1 + \\mathrm{Da}^{\\gamma}},\n$$\n固定的学习参数为 $\\kappa_c = 1.95$，$\\kappa_{\\delta} = 1.00$，$\\alpha = 0.02$，$\\beta = 0.5$，$b = 0.05$ 和 $\\gamma = 0.5$。目标是设计一个跨尺度验证程序，用以测试学习到的降阶模型是否在不同的 $\\mathrm{Da}$ 范围内再现了所推导的渐进标度律，并计算与无量纲群相关的差异度量。\n\n您的程序必须：\n- 从第一性原理出发，推导 $c$ 和 $\\delta$ 的适当渐进标度律，并用它们构成无量纲验证量\n$$\nS_{\\mathrm{hat}} = \\frac{c_{\\mathrm{hat}}}{\\sqrt{D r}}, \\quad T_{\\mathrm{hat}} = \\frac{\\delta_{\\mathrm{hat}}}{\\sqrt{D/r}},\n$$\n其期望值为您的推导所隐含的常数。\n- 对每个测试用例，计算绝对差异\n$$\n\\Delta_S = \\left| S_{\\mathrm{hat}} - S_{\\mathrm{expected}} \\right|, \\quad \\Delta_T = \\left| T_{\\mathrm{hat}} - T_{\\mathrm{expected}} \\right|,\n$$\n其中 $S_{\\mathrm{expected}}$ 和 $T_{\\mathrm{expected}}$ 是从您的推导中获得的常数。\n- 定义一个尺度感知验证阈值 $\\tau(\\mathrm{Da})$ 为\n$$\n\\tau(\\mathrm{Da}) =\n\\begin{cases}\n0.05  \\text{如果 } \\mathrm{Da} \\le 0.1 \\text{ 或 } \\mathrm{Da} \\ge 10, \\\\\n0.20  \\text{其他情况},\n\\end{cases}\n$$\n并且，对每个测试用例，如果 $\\Delta_S \\le \\tau(\\mathrm{Da})$ 和 $\\Delta_T \\le \\tau(\\mathrm{Da})$ 同时成立，则生成一个布尔值的通过/失败指示符为 $true$，否则为 $false$。\n- 汇总整个测试套件的全局度量：所有用例中 $\\Delta_S$ 的最大值、$\\Delta_S$ 的均方根、$\\Delta_T$ 的最大值以及 $\\Delta_T$ 的均方根。\n\n使用以下明确指定了物理单位且科学上合理的测试套件：\n- 用例 $1$：$(D,r,L) = \\left(10^{-3}\\,\\mathrm{m^2/s},\\,10^{-2}\\,\\mathrm{s^{-1}},\\,10^{-2}\\,\\mathrm{m}\\right)$,\n- 用例 $2$：$(D,r,L) = \\left(10^{-6}\\,\\mathrm{m^2/s},\\,1\\,\\mathrm{s^{-1}},\\,10^{-1}\\,\\mathrm{m}\\right)$,\n- 用例 $3$：$(D,r,L) = \\left(10^{-4}\\,\\mathrm{m^2/s},\\,10^{-2}\\,\\mathrm{s^{-1}},\\,1\\,\\mathrm{m}\\right)$,\n- 用例 $4$：$(D,r,L) = \\left(10^{-3}\\,\\mathrm{m^2/s},\\,10^{-3}\\,\\mathrm{s^{-1}},\\,10^{-2}\\,\\mathrm{m}\\right)$,\n- 用例 $5$：$(D,r,L) = \\left(10^{-4}\\,\\mathrm{m^2/s},\\,10^{-6}\\,\\mathrm{s^{-1}},\\,1\\,\\mathrm{m}\\right)$,\n- 用例 $6$：$(D,r,L) = \\left(10^{-6}\\,\\mathrm{m^2/s},\\,10^{-3}\\,\\mathrm{s^{-1}},\\,5\\times 10^{-1}\\,\\mathrm{m}\\right)$,\n- 用例 $7$：$(D,r,L) = \\left(10^{-3}\\,\\mathrm{m^2/s},\\,10^{-2}\\,\\mathrm{s^{-1}},\\,10^{-1}\\,\\mathrm{m}\\right)$,\n- 用例 $8$：$(D,r,L) = \\left(5\\times 10^{-5}\\,\\mathrm{m^2/s},\\,5\\times 10^{-3}\\,\\mathrm{s^{-1}},\\,2\\times 10^{-1}\\,\\mathrm{m}\\right)$,\n- 用例 $9$：$(D,r,L) = \\left(2\\times 10^{-3}\\,\\mathrm{m^2/s},\\,5\\times 10^{-4}\\,\\mathrm{s^{-1}},\\,5\\times 10^{-2}\\,\\mathrm{m}\\right)$.\n\n所有关于 $c_{\\mathrm{hat}}$ 的中间计算结果必须是速度，单位为 $\\mathrm{m/s}$，所有关于 $\\delta_{\\mathrm{hat}}$ 的中间计算结果必须是长度，单位为 $\\mathrm{m}$，但差异度量和最终验证输出是无量纲和无单位的。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按顺序包含以下五个条目：最大标度化速度差异、均方根标度化速度差异、最大标度化厚度差异、均方根标度化厚度差异，以及一个指示每个测试用例通过或失败的布尔值列表，例如\n$$\n[\\Delta S_{\\max}, \\Delta S_{\\mathrm{rms}}, \\Delta T_{\\max}, \\Delta T_{\\mathrm{rms}}, [b_1,b_2,\\ldots,b_9]].\n$$",
            "solution": "该问题是有效的，因为它科学地基于已建立的反应-扩散系统理论，特别是 Fisher-KPP 方程，并提出了一个良定的、客观的任务，即根据推导出的渐进标度律来验证一个学习模型。所有必需的数据、定义和参数都已提供，且设置是内部一致和物理上合理的。\n\n第一步是从 Fisher-KPP 方程推导行波前速度 $c$ 和厚度 $\\delta$ 的渐进标度律：\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} + r\\, u \\left(1 - u\\right)\n$$\n我们寻求一个形式为 $u(x,t) = U(z)$ 的行波解，其中 $z = x - c t$ 是在以恒定速度 $c$ 随波移动的坐标系中的坐标。偏导数变换如下：\n$\\frac{\\partial u}{\\partial t} = -c \\frac{dU}{dz}$，$\\frac{\\partial u}{\\partial x} = \\frac{dU}{dz}$，以及 $\\frac{\\partial^2 u}{\\partial x^2} = \\frac{d^2U}{dz^2}$。\n将这些代入 Fisher-KPP 方程，得到关于波形 $U(z)$ 的二阶常微分方程：\n$$\n-c \\frac{dU}{dz} = D \\frac{d^2U}{dz^2} + r\\, U(1-U)\n$$\n重新整理得到行波方程：\n$$\nD \\frac{d^2U}{dz^2} + c \\frac{dU}{dz} + r\\, U(1-U) = 0\n$$\n对于一个传播到未侵入区域（$u=0$）的波前，波形 $U(z)$ 的边界条件是，当 $z \\to -\\infty$ 时（波前之后），$U(z) \\to 1$；当 $z \\to +\\infty$ 时（波前之前），$U(z) \\to 0$。\n\n为了确定渐进速度 $c$，我们分析波前前缘的行为，此处 $z \\to +\\infty$ 且 $u \\ll 1$。在此极限下，非线性反应项 $r\\,U(1-U)$ 可以线性化为 $r\\,U$。行波方程简化为：\n$$\nD \\frac{d^2U}{dz^2} + c \\frac{dU}{dz} + r\\, U = 0\n$$\n这是一个线性常系数常微分方程。我们寻求一个形式为 $U(z) \\propto e^{-\\lambda z}$ 的指数衰减解，只要 $\\lambda > 0$，该解就满足当 $z \\to +\\infty$ 时 $U(z) \\to 0$ 的边界条件。将此形式代入线性化的常微分方程，得到关于 $\\lambda$ 的特征方程：\n$$\nD \\lambda^2 - c \\lambda + r = 0\n$$\n$\\lambda$ 的解由二次公式给出：\n$$\n\\lambda = \\frac{c \\pm \\sqrt{c^2 - 4Dr}}{2D}\n$$\n对于一个实的正衰减率 $\\lambda$，判别式必须为非负：$c^2 - 4Dr \\ge 0$。这意味着波速 $c$ 必须满足 $c \\ge \\sqrt{4Dr} = 2\\sqrt{Dr}$。因此，行波前存在一个最小可能速度 $c_{\\min} = 2\\sqrt{Dr}$。Kolmogorov、Petrovsky 和 Piskunov 的著名结果指出，对于衰减足够快的初始条件（如前述的阶跃式数据），系统会选择这个最小可能速度。因此，渐进行波速度为：\n$$\nc = 2\\sqrt{Dr}\n$$\n波前厚度尺度 $\\delta$ 可以定义为前缘指数衰减的特征长度，即 $1/\\lambda$。在最小速度 $c = 2\\sqrt{Dr}$ 时，判别式为零，从而得到一个唯一的 $\\lambda$ 值：\n$$\n\\lambda = \\frac{c}{2D} = \\frac{2\\sqrt{Dr}}{2D} = \\sqrt{\\frac{r}{D}}\n$$\n由此，厚度尺度 $\\delta$ 推导为：\n$$\n\\delta = \\frac{1}{\\lambda} = \\sqrt{\\frac{D}{r}}\n$$\n这些推导出的标度律为我们的验证提供了基础。无量纲验证量为 $S = c/\\sqrt{Dr}$ 和 $T = \\delta/\\sqrt{D/r}$。根据我们的推导，它们的期望常数值是：\n$$\nS_{\\mathrm{expected}} = \\frac{2\\sqrt{Dr}}{\\sqrt{Dr}} = 2\n$$\n$$\nT_{\\mathrm{expected}} = \\frac{\\sqrt{D/r}}{\\sqrt{D/r}} = 1\n$$\n学习到的降阶模型为归一化量 $S_{\\mathrm{hat}}$ 和 $T_{\\mathrm{hat}}$ 提供了预测，我们可以直接计算它们。其形式由下式给出：\n$$\nS_{\\mathrm{hat}} = \\frac{c_{\\mathrm{hat}}}{\\sqrt{Dr}} = \\frac{\\kappa_c \\sqrt{Dr}\\, f(\\mathrm{Da})}{\\sqrt{Dr}} = \\kappa_c f(\\mathrm{Da})\n$$\n$$\nT_{\\mathrm{hat}} = \\frac{\\delta_{\\mathrm{hat}}}{\\sqrt{D/r}} = \\frac{\\kappa_{\\delta} \\sqrt{D/r}\\, g(\\mathrm{Da})}{\\sqrt{D/r}} = \\kappa_{\\delta} g(\\mathrm{Da})\n$$\n然后，绝对差异计算如下：\n$$\n\\Delta_S = |S_{\\mathrm{hat}} - S_{\\mathrm{expected}}| = |\\kappa_c f(\\mathrm{Da}) - 2|\n$$\n$$\n\\Delta_T = |T_{\\mathrm{hat}} - T_{\\mathrm{expected}}| = |\\kappa_{\\delta} g(\\mathrm{Da}) - 1|\n$$\n对每个测试用例评估这些差异。如果 $\\Delta_S$ 和 $\\Delta_T$ 均小于或等于指定的尺度感知阈值 $\\tau(\\mathrm{Da})$，则该用例通过验证。最后，汇总所有测试用例中这些差异的最大值和均方根值，以提供对模型准确性的全局评估。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Validates a learned reduced model for the Fisher-KPP equation against\n    first-principles asymptotic scalings.\n    \"\"\"\n    \n    # Learned model parameters\n    kappa_c = 1.95\n    kappa_delta = 1.00\n    alpha = 0.02\n    beta = 0.5\n    b = 0.05\n    gamma = 0.5\n\n    # Expected dimensionless scaling constants from derivation\n    s_expected = 2.0\n    t_expected = 1.0\n\n    # Test suite (D in m^2/s, r in s^-1, L in m)\n    test_cases = [\n        (1e-3, 1e-2, 1e-2),    # Case 1\n        (1e-6, 1.0, 1e-1),     # Case 2\n        (1e-4, 1e-2, 1.0),     # Case 3\n        (1e-3, 1e-3, 1e-2),    # Case 4\n        (1e-4, 1e-6, 1.0),     # Case 5\n        (1e-6, 1e-3, 5e-1),    # Case 6\n        (1e-3, 1e-2, 1e-1),    # Case 7\n        (5e-5, 5e-3, 2e-1),    # Case 8\n        (2e-3, 5e-4, 5e-2),    # Case 9\n    ]\n\n    delta_s_values = []\n    delta_t_values = []\n    pass_fail_results = []\n    \n    for D, r, L in test_cases:\n        # Calculate the dimensionless Damköhler number\n        Da = (r * L**2) / D\n        \n        # Calculate the learned model's correction functions\n        f_da = 1.0 + alpha * (Da**beta) / (1.0 + Da**beta)\n        g_da = 1.0 + b / (1.0 + Da**gamma)\n        \n        # Calculate the model's predicted dimensionless quantities\n        s_hat = kappa_c * f_da\n        t_hat = kappa_delta * g_da\n        \n        # Compute the absolute discrepancies\n        delta_s = abs(s_hat - s_expected)\n        delta_t = abs(t_hat - t_expected)\n        \n        delta_s_values.append(delta_s)\n        delta_t_values.append(delta_t)\n        \n        # Determine the validation threshold based on Da\n        if Da = 0.1 or Da = 10:\n            tau = 0.05\n        else:\n            tau = 0.20\n            \n        # Perform the pass/fail check\n        is_pass = (delta_s = tau) and (delta_t = tau)\n        pass_fail_results.append(is_pass)\n\n    # Convert lists to numpy arrays for vectorized calculations\n    delta_s_array = np.array(delta_s_values)\n    delta_t_array = np.array(delta_t_values)\n    \n    # Calculate global metrics\n    delta_s_max = np.max(delta_s_array)\n    delta_s_rms = np.sqrt(np.mean(delta_s_array**2))\n    delta_t_max = np.max(delta_t_array)\n    delta_t_rms = np.sqrt(np.mean(delta_t_array**2))\n    \n    # Format the final output string as specified\n    final_output = (\n        f\"[{delta_s_max},{delta_s_rms},{delta_t_max},{delta_t_rms},\"\n        f\"{pass_fail_results}]\"\n    )\n    \n    # Replace spaces added by list-to-string conversion for exact formatting\n    final_output = final_output.replace(\" \", \"\")\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}