{
    "hands_on_practices": [
        {
            "introduction": "The primary utility of the Bhatnagar-Gross-Krook (BGK) operator lies in its ability to connect microscopic particle dynamics to macroscopic fluid behavior. This first practice demonstrates this connection by using the Chapman-Enskog expansion, a systematic method for deriving continuum transport equations from the underlying kinetic theory. By completing this derivation , you will see how a key transport coefficient, the thermal conductivity $k$, is directly determined by the model's single relaxation time $\\tau$, thereby solidifying its physical interpretation as the timescale for returning to local equilibrium.",
            "id": "3737230",
            "problem": "Consider a dilute, monatomic ideal gas described at the kinetic level by the Boltzmann equation with the Bhatnagar-Gross-Krook (BGK) collision operator. The BGK model approximates the collision integral by relaxing the distribution function $f(\\mathbf{x},\\mathbf{v},t)$ toward the local Maxwellian $f_M(\\mathbf{x},\\mathbf{v},t)$ with a single relaxation time $\\tau$, according to\n$$\n\\partial_t f + \\mathbf{v}\\cdot\\nabla_{\\mathbf{x}} f \\;=\\; -\\frac{1}{\\tau}\\big(f - f_M\\big).\n$$\nAssume a steady, weakly non-isothermal, quiescent state with $\\mathbf{u}(\\mathbf{x})=\\mathbf{0}$, no body forces, and spatially slowly varying fields. The local Maxwellian is\n$$\nf_M(\\mathbf{x},\\mathbf{v}) \\;=\\; n(\\mathbf{x})\\left(\\frac{m}{2\\pi k_B T(\\mathbf{x})}\\right)^{3/2}\\exp\\!\\left(-\\frac{m|\\mathbf{v}|^2}{2 k_B T(\\mathbf{x})}\\right),\n$$\nwhere $n(\\mathbf{x})$ is the number density, $T(\\mathbf{x})$ is the temperature, $m$ is the particle mass, and $k_B$ is the Boltzmann constant. The ideal gas law holds locally: $p(\\mathbf{x}) = n(\\mathbf{x}) k_B T(\\mathbf{x})$. Define the heat flux by\n$$\n\\mathbf{q}(\\mathbf{x}) \\;=\\; \\int_{\\mathbb{R}^3} \\frac{1}{2} m |\\mathbf{v}|^2 \\,\\mathbf{v}\\, f(\\mathbf{x},\\mathbf{v})\\, d\\mathbf{v}.\n$$\nUsing a first-order Chapman–Enskog expansion about $f_M$ and assuming constant pressure (so that $\\nabla p = \\mathbf{0}$ while $\\nabla T \\neq \\mathbf{0}$), derive the Fourier law $\\mathbf{q} = -k\\,\\nabla T$ and compute the thermal conductivity $k$ implied by the BGK model. Express your final $k$ solely in terms of the pressure $p$, the relaxation time $\\tau$, and the specific heat at constant pressure $c_p$ (per unit mass) of a monatomic ideal gas. \n\nThermal conductivity has SI units of $\\mathrm{W\\,m^{-1}\\,K^{-1}}$, but you must express your final answer as a closed-form symbolic expression without units.",
            "solution": "The problem requires the derivation of the Fourier law of heat conduction and the calculation of the thermal conductivity, $k$, for a dilute monatomic ideal gas using the Bhatnagar-Gross-Krook (BGK) kinetic model. The final expression for $k$ must be in terms of pressure $p$, relaxation time $\\tau$, and the specific heat at constant pressure per unit mass, $c_p$.\n\nWe begin with the BGK equation provided:\n$$\n\\partial_t f + \\mathbf{v}\\cdot\\nabla_{\\mathbf{x}} f = -\\frac{1}{\\tau}\\big(f - f_M\\big)\n$$\nThe problem specifies a steady ($\\partial_t f = 0$), quiescent ($\\mathbf{u}(\\mathbf{x}) = \\mathbf{0}$), and weakly non-uniform state. Under these conditions, the BGK equation simplifies to:\n$$\n\\mathbf{v}\\cdot\\nabla_{\\mathbf{x}} f = -\\frac{1}{\\tau}\\big(f - f_M\\big)\n$$\nThis can be rearranged to express the distribution function $f$ as:\n$$\nf = f_M - \\tau (\\mathbf{v}\\cdot\\nabla_{\\mathbf{x}} f)\n$$\nThe Chapman-Enskog expansion procedure assumes that the system is close to local equilibrium, meaning the distribution function $f$ is only a small perturbation from the local Maxwellian $f_M$. The expansion is performed in powers of a small parameter (the Knudsen number), which is proportional to the relaxation time $\\tau$ and the spatial gradients. For a first-order approximation, we can replace $f$ with its zeroth-order approximation, $f_M$, inside the gradient term on the right-hand side. This yields the first-order correction to the distribution function, $f_1 = f - f_M$:\n$$\nf_1(\\mathbf{x}, \\mathbf{v}) \\approx -\\tau (\\mathbf{v}\\cdot\\nabla_{\\mathbf{x}} f_M)\n$$\nThus, the distribution function to first order is $f \\approx f_M + f_1 = f_M - \\tau (\\mathbf{v}\\cdot\\nabla_{\\mathbf{x}} f_M)$.\n\nTo proceed, we must compute the spatial gradient of the local Maxwellian, $\\nabla_{\\mathbf{x}} f_M$. The local Maxwellian is given by:\n$$\nf_M(\\mathbf{x},\\mathbf{v}) = n(\\mathbf{x})\\left(\\frac{m}{2\\pi k_B T(\\mathbf{x})}\\right)^{3/2}\\exp\\left(-\\frac{m|\\mathbf{v}|^2}{2 k_B T(\\mathbf{x})}\\right)\n$$\nIt is convenient to compute the gradient of its logarithm, $\\ln(f_M)$:\n$$\n\\ln(f_M) = \\ln(n) - \\frac{3}{2}\\ln(T) - \\frac{m|\\mathbf{v}|^2}{2k_B T} + \\text{constant}\n$$\nTaking the spatial gradient, $\\nabla_{\\mathbf{x}}$, gives:\n$$\n\\frac{\\nabla_{\\mathbf{x}} f_M}{f_M} = \\frac{\\nabla_{\\mathbf{x}} n}{n} - \\frac{3}{2}\\frac{\\nabla_{\\mathbf{x}} T}{T} - \\frac{m|\\mathbf{v}|^2}{2k_B}\\nabla_{\\mathbf{x}}\\left(\\frac{1}{T}\\right) = \\frac{\\nabla_{\\mathbf{x}} n}{n} - \\frac{3}{2}\\frac{\\nabla_{\\mathbf{x}} T}{T} + \\frac{m|\\mathbf{v}|^2}{2k_B T^2}\\nabla_{\\mathbf{x}} T\n$$\nSo,\n$$\n\\nabla_{\\mathbf{x}} f_M = f_M \\left[ \\frac{\\nabla_{\\mathbf{x}} n}{n} + \\left(\\frac{m|\\mathbf{v}|^2}{2k_B T^2} - \\frac{3}{2T}\\right)\\nabla_{\\mathbf{x}} T \\right]\n$$\nThe problem states that the pressure $p = n k_B T$ is constant, so $\\nabla_{\\mathbf{x}} p = \\mathbf{0}$. Applying the product rule:\n$$\n\\nabla_{\\mathbf{x}} p = k_B(T \\nabla_{\\mathbf{x}} n + n \\nabla_{\\mathbf{x}} T) = \\mathbf{0}\n$$\nThis provides a relationship between the gradients of density and temperature: $T \\nabla_{\\mathbf{x}} n = -n \\nabla_{\\mathbf{x}} T$, which can be written as $\\frac{\\nabla_{\\mathbf{x}} n}{n} = -\\frac{\\nabla_{\\mathbf{x}} T}{T}$. Substituting this into the expression for $\\nabla_{\\mathbf{x}} f_M$:\n$$\n\\nabla_{\\mathbf{x}} f_M = f_M \\left[ -\\frac{\\nabla_{\\mathbf{x}} T}{T} + \\left(\\frac{m|\\mathbf{v}|^2}{2k_B T^2} - \\frac{3}{2T}\\right)\\nabla_{\\mathbf{x}} T \\right] = f_M \\left(\\frac{m|\\mathbf{v}|^2}{2k_B T^2} - \\frac{5}{2T}\\right)\\nabla_{\\mathbf{x}} T\n$$\nNow we can write the first-order correction $f_1$:\n$$\nf_1 = -\\tau (\\mathbf{v}\\cdot\\nabla_{\\mathbf{x}} f_M) = -\\tau f_M \\left(\\frac{m|\\mathbf{v}|^2}{2k_B T} - \\frac{5}{2}\\right) \\frac{1}{T} (\\mathbf{v}\\cdot\\nabla_{\\mathbf{x}} T)\n$$\nThe heat flux vector $\\mathbf{q}$ is defined as the third moment of the distribution function with respect to peculiar velocity (which is just $\\mathbf{v}$ since $\\mathbf{u}=\\mathbf{0}$):\n$$\n\\mathbf{q}(\\mathbf{x}) = \\int_{\\mathbb{R}^3} \\frac{1}{2} m |\\mathbf{v}|^2 \\,\\mathbf{v}\\, f(\\mathbf{x},\\mathbf{v})\\, d\\mathbf{v} = \\int \\frac{1}{2} m |\\mathbf{v}|^2 \\,\\mathbf{v}\\, (f_M + f_1)\\, d\\mathbf{v}\n$$\nThe integral involving $f_M$ is zero because $f_M$ is an even function of $\\mathbf{v}$, while the rest of the integrand contains a single factor of $\\mathbf{v}$, making the overall integrand odd. The integral of an odd function over the symmetric domain $\\mathbb{R}^3$ is zero. Therefore, the heat flux is determined entirely by the first-order correction $f_1$:\n$$\n\\mathbf{q} = \\int \\frac{1}{2} m |\\mathbf{v}|^2 \\,\\mathbf{v}\\, f_1\\, d\\mathbf{v} = -\\frac{\\tau}{T} \\int \\frac{1}{2} m |\\mathbf{v}|^2 \\,\\mathbf{v}\\, f_M \\left(\\frac{m|\\mathbf{v}|^2}{2k_B T} - \\frac{5}{2}\\right) (\\mathbf{v}\\cdot\\nabla_{\\mathbf{x}} T) \\, d\\mathbf{v}\n$$\nThis expression is of the form $\\mathbf{q} = -\\mathbf{K} \\cdot \\nabla_{\\mathbf{x}} T$, where $\\mathbf{K}$ is the thermal conductivity tensor. The term $(\\mathbf{v}\\cdot\\nabla_{\\mathbf{x}} T)$ can be written as $(\\mathbf{v} \\otimes \\mathbf{v}) \\cdot \\nabla_{\\mathbf{x}} T$. The integral can be written as:\n$$\n\\mathbf{q} = -\\left[ \\frac{\\tau}{T} \\int \\frac{1}{2} m |\\mathbf{v}|^2 f_M \\left(\\frac{m|\\mathbf{v}|^2}{2k_B T} - \\frac{5}{2}\\right) (\\mathbf{v} \\otimes \\mathbf{v}) \\, d\\mathbf{v} \\right] \\cdot \\nabla_{\\mathbf{x}} T\n$$\nSince the integrand is isotropic in $\\mathbf{v}$, the tensor integral simplifies: $\\int (\\dots) (\\mathbf{v} \\otimes \\mathbf{v}) \\, d\\mathbf{v} = \\frac{1}{3} \\mathbf{I} \\int (\\dots) |\\mathbf{v}|^2 \\, d\\mathbf{v}$. Thus, the conductivity tensor is diagonal, $\\mathbf{K} = k \\mathbf{I}$, and we recover Fourier's law, $\\mathbf{q} = -k\\,\\nabla_{\\mathbf{x}} T$, with the scalar thermal conductivity $k$ given by:\n$$\nk = \\frac{\\tau}{3T} \\int \\frac{1}{2} m |\\mathbf{v}|^4 f_M \\left(\\frac{m|\\mathbf{v}|^2}{2k_B T} - \\frac{5}{2}\\right) d\\mathbf{v}\n$$\nTo evaluate the integral, we can express it in terms of moments of the Maxwellian distribution, defined as $\\langle A \\rangle = \\frac{1}{n} \\int A f_M d\\mathbf{v}$:\n$$\nk = \\frac{n\\tau}{3T} \\left\\langle \\frac{1}{2} m |\\mathbf{v}|^4 \\left(\\frac{m|\\mathbf{v}|^2}{2k_B T} - \\frac{5}{2}\\right) \\right\\rangle = \\frac{nm\\tau}{6T} \\left\\langle |\\mathbf{v}|^4 \\left(\\frac{m|\\mathbf{v}|^2}{2k_B T} - \\frac{5}{2}\\right) \\right\\rangle\n$$\n$$\nk = \\frac{nm\\tau}{6T} \\left[ \\frac{m}{2k_B T} \\langle |\\mathbf{v}|^6 \\rangle - \\frac{5}{2} \\langle |\\mathbf{v}|^4 \\rangle \\right]\n$$\nThe general formula for the moments of velocity magnitude for a Maxwellian distribution is $\\langle |\\mathbf{v}|^{2j} \\rangle = (2j+1)!! \\left(\\frac{k_B T}{m}\\right)^j$, where $(2j+1)!! = (2j+1)(2j-1)\\dots 1$.\nFor $j=2$, we need $\\langle |\\mathbf{v}|^4 \\rangle$:\n$$\n\\langle |\\mathbf{v}|^4 \\rangle = (5)!! \\left(\\frac{k_B T}{m}\\right)^2 = (5 \\cdot 3 \\cdot 1) \\left(\\frac{k_B T}{m}\\right)^2 = 15 \\left(\\frac{k_B T}{m}\\right)^2\n$$\nFor $j=3$, we need $\\langle |\\mathbf{v}|^6 \\rangle$:\n$$\n\\langle |\\mathbf{v}|^6 \\rangle = (7)!! \\left(\\frac{k_B T}{m}\\right)^3 = (7 \\cdot 5 \\cdot 3 \\cdot 1) \\left(\\frac{k_B T}{m}\\right)^3 = 105 \\left(\\frac{k_B T}{m}\\right)^3\n$$\nSubstituting these moments into the expression for $k$:\n$$\nk = \\frac{nm\\tau}{6T} \\left[ \\frac{m}{2k_B T} \\left(105 \\frac{k_B^3 T^3}{m^3}\\right) - \\frac{5}{2} \\left(15 \\frac{k_B^2 T^2}{m^2}\\right) \\right]\n$$\n$$\nk = \\frac{nm\\tau}{6T} \\left[ \\frac{105}{2} \\frac{k_B^2 T^2}{m^2} - \\frac{75}{2} \\frac{k_B^2 T^2}{m^2} \\right] = \\frac{nm\\tau}{6T} \\left[ \\frac{30}{2} \\frac{k_B^2 T^2}{m^2} \\right]\n$$\n$$\nk = \\frac{nm\\tau}{6T} \\left(15 \\frac{k_B^2 T^2}{m^2}\\right) = \\frac{15}{6} \\frac{n \\tau k_B^2 T}{m} = \\frac{5}{2} \\frac{n k_B^2 T \\tau}{m}\n$$\nThe final step is to express this result in terms of $p$, $\\tau$, and $c_p$. Using the ideal gas law $p = n k_B T$, we can write:\n$$\nk = \\frac{5}{2} \\frac{(n k_B T) k_B \\tau}{m} = \\frac{5}{2} \\frac{p k_B \\tau}{m}\n$$\nFor a monatomic ideal gas, the internal energy per particle is $\\frac{3}{2} k_B T$. The internal energy per unit mass is $e = \\frac{3}{2} \\frac{k_B T}{m}$. The specific heat at constant volume per unit mass is $c_v = (\\partial e / \\partial T)_V = \\frac{3}{2}\\frac{k_B}{m}$. For an ideal gas, Mayer's relation for specific heats per unit mass is $c_p - c_v = R_s$, where $R_s = k_B/m$ is the specific gas constant.\nTherefore, the specific heat at constant pressure per unit mass is:\n$$\nc_p = c_v + \\frac{k_B}{m} = \\frac{3}{2}\\frac{k_B}{m} + \\frac{k_B}{m} = \\frac{5}{2}\\frac{k_B}{m}\n$$\nSubstituting this expression for $c_p$ into our result for $k$:\n$$\nk = p \\tau \\left(\\frac{5}{2}\\frac{k_B}{m}\\right) = p \\tau c_p\n$$\nThis is the final expression for the thermal conductivity implied by the BGK model under the given assumptions.",
            "answer": "$$\n\\boxed{p \\tau c_{p}}\n$$"
        },
        {
            "introduction": "Transitioning from the continuous BGK equation to a practical computational tool, such as the Lattice Boltzmann Method (LBM), requires a carefully designed discretization of velocity space. This exercise focuses on the core principle of this process: replacing the continuous Maxwellian distribution with a finite set of discrete velocities and weights. This fundamental practice in LBM development  illustrates how to use moment-matching to ensure that the simplified discrete model preserves the essential symmetries and conservation laws of the continuous system, a necessary condition for recovering the correct macroscopic hydrodynamics.",
            "id": "3737196",
            "problem": "Consider a two-dimensional isothermal kinetic model with the Bhatnagar-Gross-Krook (BGK) collision operator, where the collision term relaxes the distribution function toward a local equilibrium characterized by a Maxwell-Boltzmann density in velocity space. In multiscale modeling, a discrete-velocity quadrature must reproduce continuous velocity moments of the Maxwell-Boltzmann equilibrium to guarantee correct recovery of the hydrodynamic limit. You are to construct a minimal, symmetric discrete velocity set and associated weights that reproduce isotropy in velocity space up to fourth order.\n\nAdopt a discrete velocity set composed of three symmetry-equivalent shells in two spatial dimensions: a rest vector with velocity $(0,0)$, four axial vectors $(\\pm 1,0)$ and $(0,\\pm 1)$, and four diagonal vectors $(\\pm 1,\\pm 1)$. Let the weights associated with these three shells be $w_{0}$, $w_{1}$, and $w_{2}$, respectively. Assume the lattice velocities are given in nondimensional lattice units with unit lattice speed, and let $c_{s}^{2}$ denote the squared lattice sound speed emerging from the quadrature.\n\nStarting from first principles, impose that the discrete quadrature reproduces the zeroth, second, and fourth central moments of a two-dimensional, zero-mean, isotropic Gaussian in velocity space with variance $c_{s}^{2}$ in each component. Use only fundamental properties of isotropy and standard Gaussian moment relations derivable from the factorization of independent components to set up the necessary moment-matching conditions for the weights and $c_{s}^{2}$. Solve for $w_{0}$, $w_{1}$, $w_{2}$, and $c_{s}^{2}$ exactly, and verify that the resulting discrete moments produce an isotropic second-order tensor and an isotropic fourth-order tensor in the sense of Kronecker-delta constructions.\n\nProvide your final answer as the $1 \\times 4$ row matrix containing $(w_{0}, w_{1}, w_{2}, c_{s}^{2})$. No rounding is required; give exact values.",
            "solution": "The problem requires the construction of a discrete velocity quadrature for a two-dimensional kinetic model that correctly reproduces the moments of the equilibrium distribution up to the fourth order. This is a fundamental step in ensuring that the resulting numerical scheme, such as a lattice Boltzmann model, recovers the correct hydrodynamic equations in the macroscopic limit.\n\nFirst, we define the discrete velocity set and the associated weights. The set consists of $N=9$ velocities, partitioned into three shells based on symmetry and speed. Let the discrete velocity vectors be denoted by $\\vec{c}_i$, where $i=0, \\dots, 8$.\n- Shell 0: A single rest particle, $\\vec{c}_0 = (0, 0)$, with weight $w_0$.\n- Shell 1: Four \"axial\" particles with speed $1$, $\\vec{c}_i \\in \\{(\\pm 1, 0), (0, \\pm 1)\\}$, each with weight $w_1$.\n- Shell 2: Four \"diagonal\" particles with speed $\\sqrt{2}$, $\\vec{c}_i \\in \\{(\\pm 1, \\pm 1)\\}$, each with weight $w_2$.\n\nThe discrete moments of a distribution function are calculated as a weighted sum over the discrete velocity set. For a general tensor moment of rank $k$, this is given by:\n$$\nM_{\\alpha_1 \\alpha_2 \\dots \\alpha_k} = \\sum_{i=0}^{8} w_i c_{i, \\alpha_1} c_{i, \\alpha_2} \\dots c_{i, \\alpha_k}\n$$\nwhere $\\alpha_j \\in \\{x, y\\}$.\n\nNext, we define the continuous moments of the target equilibrium distribution, which is a two-dimensional, zero-mean, isotropic Gaussian (Maxwell-Boltzmann distribution) with variance $c_s^2$ in each velocity component. The normalized probability density function is:\n$$\ng(\\vec{\\xi}) = \\frac{1}{2\\pi c_s^2} \\exp\\left(-\\frac{\\xi_x^2 + \\xi_y^2}{2 c_s^2}\\right)\n$$\nwhere $\\vec{\\xi} = (\\xi_x, \\xi_y)$ is the continuous velocity vector. The continuous moments are given by the integral:\n$$\n\\langle \\xi_{\\alpha_1} \\xi_{\\alpha_2} \\dots \\xi_{\\alpha_k} \\rangle = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\xi_{\\alpha_1} \\xi_{\\alpha_2} \\dots \\xi_{\\alpha_k} g(\\vec{\\xi}) \\,d\\xi_x \\,d\\xi_y\n$$\n\nWe must now equate the discrete and continuous moments up to fourth order to find the four unknowns: $w_0, w_1, w_2$, and $c_s^2$.\n\n**Zeroth Moment (Normalization):**\nThe zeroth moment corresponds to the total probability, which must be $1$.\n- Discrete: $\\sum_{i=0}^{8} w_i = w_0 \\cdot 1 + w_1 \\cdot 4 + w_2 \\cdot 4 = w_0 + 4w_1 + 4w_2$.\n- Continuous: $\\int g(\\vec{\\xi}) \\,d\\vec{\\xi} = 1$.\n- Equation (1): $w_0 + 4w_1 + 4w_2 = 1$.\n\nAll odd-order moments are zero for both the discrete set (due to its symmetry) and the continuous Gaussian (due to its evenness), so they are automatically satisfied.\n\n**Second Moment (Isotropy of Momentum Flux):**\nThe second-moment tensor is $M_{ab} = \\sum_i w_i c_{i,a} c_{i,b}$.\n- Discrete components:\n  - $M_{xx} = \\sum_i w_i c_{i,x}^2 = w_1(1^2) + w_1(-1)^2 + w_2(1^2) + w_2(-1)^2 + w_2(1^2) + w_2(-1)^2 = 2w_1 + 4w_2$.\n  - By symmetry, $M_{yy} = 2w_1 + 4w_2$.\n  - $M_{xy} = \\sum_i w_i c_{i,x} c_{i,y} = w_2(1)(1) + w_2(1)(-1) + w_2(-1)(1) + w_2(-1)(-1) = 0$.\n- Continuous components: The second moments of the specified Gaussian are given by its covariance matrix. Since the components are independent and have variance $c_s^2$, we have $\\langle \\xi_a \\xi_b \\rangle = c_s^2 \\delta_{ab}$, where $\\delta_{ab}$ is the Kronecker delta.\n  - $\\langle \\xi_x^2 \\rangle = c_s^2$.\n  - $\\langle \\xi_y^2 \\rangle = c_s^2$.\n  - $\\langle \\xi_x \\xi_y \\rangle = 0$.\n- Equating the non-trivial components gives Equation (2): $2w_1 + 4w_2 = c_s^2$.\n\n**Fourth Moment (Isotropy of Fourth-Order Tensor):**\nThe fourth-moment tensor is $M_{abcd} = \\sum_i w_i c_{i,a} c_{i,b} c_{i,c} c_{i,d}$.\n- Discrete components: We only need to compute the unique non-zero components.\n  - $M_{xxxx} = \\sum_i w_i c_{i,x}^4 = w_1(1^4) + w_1(-1)^4 + w_2(1^4) + w_2(-1)^4 + w_2(1^4) + w_2(-1)^4 = 2w_1 + 4w_2$.\n  - $M_{xxyy} = \\sum_i w_i c_{i,x}^2 c_{i,y}^2 = w_2(1^2)(1^2) + w_2(1^2)(-1)^2 + w_2(-1)^2(1^2) + w_2(-1)^2(-1)^2 = 4w_2$.\n- Continuous components: For a zero-mean multivariate Gaussian, the fourth-order central moments are given by Isserlis' (or Wick's) theorem: $\\langle \\xi_a \\xi_b \\xi_c \\xi_d \\rangle = \\langle \\xi_a \\xi_b \\rangle \\langle \\xi_c \\xi_d \\rangle + \\langle \\xi_a \\xi_c \\rangle \\langle \\xi_b \\xi_d \\rangle + \\langle \\xi_a \\xi_d \\rangle \\langle \\xi_b \\xi_c \\rangle$.\n  - $\\langle \\xi_x^4 \\rangle = \\langle \\xi_x \\xi_x \\rangle \\langle \\xi_x \\xi_x \\rangle \\times 3 = 3(c_s^2)^2 = 3c_s^4$.\n  - $\\langle \\xi_x^2 \\xi_y^2 \\rangle = \\langle \\xi_x^2 \\rangle \\langle \\xi_y^2 \\rangle + 2\\langle \\xi_x \\xi_y \\rangle^2 = (c_s^2)(c_s^2) + 2(0)^2 = c_s^4$.\n- Equating components gives two more equations:\n  - Equation (3): $2w_1 + 4w_2 = 3c_s^4$.\n  - Equation (4): $4w_2 = c_s^4$.\n\nWe now have a system of four equations for the four unknowns:\n1. $w_0 + 4w_1 + 4w_2 = 1$\n2. $2w_1 + 4w_2 = c_s^2$\n3. $2w_1 + 4w_2 = 3c_s^4$\n4. $4w_2 = c_s^4$\n\nFrom (2) and (3), we equate the left-hand sides:\n$c_s^2 = 3c_s^4$\nSince a physically meaningful temperature requires $c_s^2 > 0$, we can divide by $c_s^2$:\n$1 = 3c_s^2 \\implies c_s^2 = \\frac{1}{3}$.\n\nNow we can solve for the weights by back-substitution.\nSubstitute $c_s^2=1/3$ into (4):\n$4w_2 = c_s^4 = (c_s^2)^2 = \\left(\\frac{1}{3}\\right)^2 = \\frac{1}{9}$\n$w_2 = \\frac{1}{36}$.\n\nSubstitute $w_2=1/36$ and $c_s^2=1/3$ into (2):\n$2w_1 + 4\\left(\\frac{1}{36}\\right) = \\frac{1}{3}$\n$2w_1 + \\frac{1}{9} = \\frac{1}{3}$\n$2w_1 = \\frac{3}{9} - \\frac{1}{9} = \\frac{2}{9}$\n$w_1 = \\frac{1}{9}$.\n\nFinally, substitute $w_1=1/9$ and $w_2=1/36$ into (1):\n$w_0 + 4\\left(\\frac{1}{9}\\right) + 4\\left(\\frac{1}{36}\\right) = 1$\n$w_0 + \\frac{4}{9} + \\frac{1}{9} = 1$\n$w_0 + \\frac{5}{9} = 1$\n$w_0 = 1 - \\frac{5}{9} = \\frac{4}{9}$.\n\nThe solution is: $w_0 = 4/9$, $w_1 = 1/9$, $w_2 = 1/36$, and $c_s^2=1/3$.\n\nTo complete the task, we verify the isotropy of the resulting discrete moment tensors.\n- **Second-order tensor:**\n$M_{ab} = \\sum_i w_i c_{i,a} c_{i,b}$. We found $M_{xx}=M_{yy}=2w_1+4w_2 = 2(1/9)+4(1/36)=2/9+1/9=3/9=1/3$, and $M_{xy}=0$.\nThus, $M_{ab} = \\frac{1}{3}\\delta_{ab} = c_s^2 \\delta_{ab}$. This is the general form of an isotropic second-order tensor, so the condition is satisfied.\n\n- **Fourth-order tensor:**\n$M_{abcd} = \\sum_i w_i c_{i,a} c_{i,b} c_{i,c} c_{i,d}$. We need to show this matches the form for an isotropic tensor derived from a Gaussian, which is $\\langle \\xi_a \\xi_b \\xi_c \\xi_d \\rangle = c_s^4(\\delta_{ab}\\delta_{cd} + \\delta_{ac}\\delta_{bd} + \\delta_{ad}\\delta_{bc})$.\nWith our derived values, $c_s^4 = (1/3)^2 = 1/9$. So we need to show $M_{abcd} = \\frac{1}{9}(\\delta_{ab}\\delta_{cd} + \\delta_{ac}\\delta_{bd} + \\delta_{ad}\\delta_{bc})$.\nLet's check the unique non-zero components of $M_{abcd}$:\n  - $M_{xxxx} = 2w_1 + 4w_2 = 1/3$. The isotropic form gives $c_s^4(\\delta_{xx}\\delta_{xx} + \\delta_{xx}\\delta_{xx} + \\delta_{xx}\\delta_{xx}) = c_s^4(1+1+1) = 3c_s^4 = 3(1/9) = 1/3$. This matches.\n  - $M_{xxyy} = 4w_2 = 4(1/36) = 1/9$. The isotropic form gives $c_s^4(\\delta_{xx}\\delta_{yy} + \\delta_{xy}\\delta_ {xy} + \\delta_{xy}\\delta_{yx}) = c_s^4(1 \\cdot 1 + 0 + 0) = c_s^4 = 1/9$. This matches.\n  - $M_{xyxy} = \\sum_i w_i c_{i,x} c_{i,y} c_{i,x} c_{i,y} = \\sum_i w_i c_{i,x}^2 c_{i,y}^2 = M_{xxyy} = 1/9$. The isotropic form gives $c_s^4(\\delta_{xy}\\delta_{xy} + \\delta_{xx}\\delta_{yy} + \\delta_{xy}\\delta_{yx}) = c_s^4(0 + 1 \\cdot 1 + 0) = c_s^4 = 1/9$. This matches.\nAll other components can be shown to match by symmetry. The fourth-order moment tensor is indeed isotropic in the required sense.\n\nThe final values for the weights and the squared lattice sound speed are $(w_0, w_1, w_2, c_s^2) = (4/9, 1/9, 1/36, 1/3)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{4}{9} & \\frac{1}{9} & \\frac{1}{36} & \\frac{1}{3}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A numerical algorithm is only useful if it is stable, and the Lattice BGK (LBGK) scheme is no exception. This final practice explores the crucial issue of numerical stability by applying a Fourier-von Neumann analysis to the linearized LBGK update rule. This analysis  will reveal the critical stability constraint on the relaxation parameter, $0 \\le \\omega \\le 2$, a universally known rule for LBM practitioners, and will highlight how the numerical discretization imposes its own constraints on the model parameters, independent of the underlying physics.",
            "id": "3737247",
            "problem": "Consider a single-relaxation-time Lattice Bhatnagar-Gross-Krook (LBGK) scheme for the Lattice Boltzmann Method (LBM), derived from the Bhatnagar-Gross-Krook (BGK) collision operator. The BGK operator acts on a particle distribution $f(\\boldsymbol{x},\\boldsymbol{\\xi},t)$ through\n$$\n\\mathcal{Q}(f) \\;=\\; -\\frac{1}{\\tau}\\,\\big(f - f^{\\mathrm{eq}}\\big),\n$$\nwhere $\\tau$ is the relaxation time and $f^{\\mathrm{eq}}$ is the local Maxwellian equilibrium consistent with the conserved moments. In a standard stream–collide discretization with time step $\\Delta t$, the collision parameter is defined by $\\omega = \\Delta t/\\tau$. Assume a regular lattice with discrete velocities $\\{\\boldsymbol{c}_i\\}$, weights $\\{w_i\\}$, and an equilibrium that exactly preserves the mass and momentum moments, ensuring that the collision step leaves conserved moments invariant.\n\nLinearize the LBGK dynamics about a spatially uniform equilibrium with constant mass density and zero macroscopic velocity, consider periodic boundary conditions, and perform a Fourier–von Neumann analysis of small perturbations. Treat the streaming operator as unitary on the space of Fourier modes and separate the dynamics into conserved and nonconserved subspaces induced by the linearized collision operator. Using only the fundamental properties that (i) conserved moments are unchanged by collision and (ii) nonconserved moments relax toward equilibrium at the rate determined by the BGK operator, derive the one-step amplification factor for nonconserved modes in terms of $\\omega$ and impose the nonexpansivity condition (spectral radius not exceeding unity) uniformly in wavenumber to avoid numerical instabilities due to overrelaxation.\n\nReport the maximal admissible relaxation parameter $\\omega$ that guarantees nonexpansivity of the linearized LBGK update for all Fourier modes. Your final answer must be a single real number. No rounding is required and no units should be included in the final answer.",
            "solution": "The problem asks for the maximal admissible value of the relaxation parameter $\\omega$ in a single-relaxation-time Lattice Bhatnagar-Gross-Krook (LBGK) scheme that ensures numerical stability. The stability is to be assessed using a Fourier-von Neumann analysis of the dynamics linearized about a uniform, zero-velocity equilibrium state.\n\nThe LBGK scheme consists of a collision and a streaming step. For a set of discrete populations $\\{f_i(\\boldsymbol{x},t)\\}$, the evolution from time $t$ to $t+\\Delta t$ is given by:\n$$\nf_i(\\boldsymbol{x}+\\boldsymbol{c}_i \\Delta t, t+\\Delta t) = f_i(\\boldsymbol{x},t) - \\frac{1}{\\tau} \\Delta t \\left(f_i(\\boldsymbol{x},t) - f_i^{\\mathrm{eq}}(\\boldsymbol{x},t)\\right)\n$$\nIntroducing the collision parameter $\\omega = \\Delta t/\\tau$, this equation becomes:\n$$\nf_i(\\boldsymbol{x}+\\boldsymbol{c}_i \\Delta t, t+\\Delta t) = f_i(\\boldsymbol{x},t) - \\omega \\left(f_i(\\boldsymbol{x},t) - f_i^{\\mathrm.eq}}(\\boldsymbol{x},t)\\right) = (1-\\omega)f_i(\\boldsymbol{x},t) + \\omega f_i^{\\mathrm{eq}}(\\boldsymbol{x},t)\n$$\nWe linearize this equation around a constant equilibrium state $f_i^{\\mathrm{eq},0}$, which corresponds to a constant density $\\rho_0$ and zero macroscopic velocity $\\boldsymbol{u}=\\boldsymbol{0}$. Let $f_i = f_i^{\\mathrm{eq},0} + \\delta f_i$. The local equilibrium distribution $f_i^{\\mathrm{eq}}$ is a function of the local macroscopic moments (e.g., density $\\rho$ and momentum $\\boldsymbol{j}$), which are themselves linear functions of the populations $f_i$. Therefore, the perturbation in the equilibrium distribution, $\\delta f_i^{\\mathrm{eq}} = f_i^{\\mathrm{eq}} - f_i^{\\mathrm{eq},0}$, is a linear function of the population perturbations $\\delta f_j$. This can be written in vector form as $|\\delta f^{\\mathrm{eq}}\\rangle = \\mathbf{M} |\\delta f\\rangle$, where $\\mathbf{M}$ is the linearized equilibrium-projection matrix.\n\nThe linearized LBGK equation for the perturbation $|\\delta f\\rangle$ is:\n$$\n|\\delta f(\\boldsymbol{x}+\\boldsymbol{c}\\Delta t, t+\\Delta t)\\rangle = (1-\\omega) |\\delta f(\\boldsymbol{x},t)\\rangle + \\omega |\\delta f^{\\mathrm{eq}}(\\boldsymbol{x},t)\\rangle = \\left((1-\\omega)\\mathbf{I} + \\omega\\mathbf{M}\\right) |\\delta f(\\boldsymbol{x},t)\\rangle\n$$\nLet $\\mathbf{L} = (1-\\omega)\\mathbf{I} + \\omega\\mathbf{M}$ be the linearized collision operator. The equation is $|\\delta f(\\boldsymbol{x}+\\boldsymbol{c}\\Delta t, t+\\Delta t)\\rangle = \\mathbf{L} |\\delta f(\\boldsymbol{x},t)\\rangle$.\n\nFor the Fourier-von Neumann analysis, we consider a single Fourier mode, $|\\delta f(\\boldsymbol{x},t)\\rangle = |\\widehat{\\delta f}_{\\boldsymbol{k}}(t)\\rangle e^{i\\boldsymbol{k}\\cdot\\boldsymbol{x}}$. Substituting this into the linearized equation yields:\n$$\n|\\widehat{\\delta f}_{\\boldsymbol{k}}(t+\\Delta t)\\rangle e^{i\\boldsymbol{k}\\cdot(\\boldsymbol{x}+\\boldsymbol{c}\\Delta t)} = \\mathbf{L} |\\widehat{\\delta f}_{\\boldsymbol{k}}(t)\\rangle e^{i\\boldsymbol{k}\\cdot\\boldsymbol{x}}\n$$\nFactoring out $e^{i\\boldsymbol{k}\\cdot\\boldsymbol{x}}$ and bringing the streaming-related phase factor to the right side, we get the one-step amplification equation:\n$$\n|\\widehat{\\delta f}_{\\boldsymbol{k}}(t+\\Delta t)\\rangle = \\mathbf{S}(\\boldsymbol{k}) \\mathbf{L} |\\widehat{\\delta f}_{\\boldsymbol{k}}(t)\\rangle\n$$\nHere, $\\mathbf{S}(\\boldsymbol{k})$ is the diagonal streaming matrix in Fourier space, with entries $(\\mathbf{S}(\\boldsymbol{k}))_{ij} = \\delta_{ij} e^{-i\\boldsymbol{k}\\cdot\\boldsymbol{c}_i\\Delta t}$. The problem states that the streaming operator is unitary, which is consistent with this form since $|e^{-i\\boldsymbol{k}\\cdot\\boldsymbol{c}_i\\Delta t}|=1$, making $\\mathbf{S}(\\boldsymbol{k})$ a unitary matrix. The one-step amplification matrix is $\\mathbf{G}(\\boldsymbol{k}) = \\mathbf{S}(\\boldsymbol{k})\\mathbf{L}$.\n\nThe problem requires imposing a nonexpansivity condition, which means the spectral radius of the amplification matrix, $\\rho(\\mathbf{G}(\\boldsymbol{k}))$, must not exceed unity for any wavenumber $\\boldsymbol{k}$. That is, $\\rho(\\mathbf{G}(\\boldsymbol{k})) \\le 1$ for all $\\boldsymbol{k}$.\n\nTo determine the properties of $\\mathbf{L}$, we follow the problem's guidance to separate the dynamics into conserved and nonconserved subspaces.\n1.  **Conserved Subspace**: The BGK collision operator is constructed to conserve mass and momentum. This means that if $|\\psi_c\\rangle$ is a vector in the space of populations corresponding to a conserved quantity (a \"conserved mode\"), the collision step does not change its macroscopic value. For the linearized operator, this means that conserved modes are eigenvectors of $\\mathbf{L}$ with eigenvalue $1$.\n    $$ \\mathbf{L} |\\psi_c\\to = 1 \\cdot |\\psi_c\\to $$\n    This is because for a conserved mode, the perturbation is already \"at equilibrium\" in that mode, so $\\mathbf{M}|\\psi_c\\rangle = |\\psi_c\\rangle$, which gives $\\mathbf{L}|\\psi_c\\rangle = ((1-\\omega)\\mathbf{I} + \\omega\\mathbf{M})|\\psi_c\\rangle = (1-\\omega)|\\psi_c\\rangle + \\omega|\\psi_c\\rangle = |\\psi_c\\rangle$.\n\n2.  **Nonconserved Subspace**: The problem states that nonconserved moments relax toward equilibrium at the rate determined by the BGK operator. The BGK operator is $\\mathcal{Q}(f) = -(f-f^{\\mathrm{eq}})/\\tau$. A mode $|\\psi_{nc}\\rangle$ in the nonconserved subspace represents a deviation from equilibrium in a nonconserved moment. The governing equation for this deviation is $\\frac{d}{dt}|\\psi_{nc}\\rangle = -\\frac{1}{\\tau}|\\psi_{nc}\\rangle$. A first-order explicit time-discretization of this equation gives:\n    $$ |\\psi_{nc}(t+\\Delta t)\\rangle = |\\psi_{nc}(t)\\rangle - \\frac{\\Delta t}{\\tau}|\\psi_{nc}(t)\\rangle = \\left(1 - \\frac{\\Delta t}{\\tau}\\right)|\\psi_{nc}(t)\\rangle = (1-\\omega)|\\psi_{nc}(t)\\rangle $$\n    This is precisely the action of the collision step on a nonconserved mode. Therefore, vectors in the nonconserved subspace are eigenvectors of $\\mathbf{L}$ with eigenvalue $(1-\\omega)$. This is the one-step amplification factor for nonconserved modes.\n\nThe eigenvalues of the linearized collision operator $\\mathbf{L}$ are thus $1$ (for conserved modes) and $1-\\omega$ (for nonconserved modes).\n\nThe stability condition $\\rho(\\mathbf{G}(\\boldsymbol{k})) \\le 1$ must hold for all wavenumbers $\\boldsymbol{k}$. A necessary condition for this uniform stability is that the system must be stable for the long-wavelength limit, i.e., for $\\boldsymbol{k}=\\boldsymbol{0}$.\nFor $\\boldsymbol{k}=\\boldsymbol{0}$, the streaming matrix becomes the identity matrix, $\\mathbf{S}(\\boldsymbol{0})=\\mathbf{I}$, since $e^{-i\\boldsymbol{0}\\cdot\\boldsymbol{c}_i\\Delta t} = 1$.\nThe amplification matrix for this mode is $\\mathbf{G}(\\boldsymbol{0}) = \\mathbf{S}(\\boldsymbol{0})\\mathbf{L} = \\mathbf{I}\\mathbf{L} = \\mathbf{L}$.\nThe stability condition for $\\boldsymbol{k}=\\boldsymbol{0}$ is therefore $\\rho(\\mathbf{L}) \\le 1$.\n\nThe spectral radius of $\\mathbf{L}$ is the maximum of the absolute values of its eigenvalues:\n$$\n\\rho(\\mathbf{L}) = \\max\\left\\{|1|, |1-\\omega|\\right\\}\n$$\nFor $\\rho(\\mathbf{L}) \\le 1$, we must have:\n$$\n\\max\\left\\{1, |1-\\omega|\\right\\} \\le 1\n$$\nThis is equivalent to the condition $|1-\\omega| \\le 1$. This inequality can be decomposed into two parts:\n1.  $1-\\omega \\le 1 \\implies -\\omega \\le 0 \\implies \\omega \\ge 0$.\n2.  $1-\\omega \\ge -1 \\implies 2 \\ge \\omega \\implies \\omega \\le 2$.\n\nCombining these, the necessary condition for stability is $0 \\le \\omega \\le 2$.\nIf $\\omega > 2$, then $|1-\\omega| > 1$, which means $\\rho(\\mathbf{L}) > 1$. The scheme is unstable for the $\\boldsymbol{k}=\\boldsymbol{0}$ mode, and thus the nonexpansivity condition is violated. Therefore, no value of $\\omega > 2$ is admissible.\n\nThe maximal admissible value for the relaxation parameter $\\omega$ that guarantees nonexpansivity is the upper bound of this valid range.",
            "answer": "$$\n\\boxed{2}\n$$"
        }
    ]
}