{
    "hands_on_practices": [
        {
            "introduction": "此练习将从E.T. Jaynes所倡导的最大熵原理这一基本原则出发。它提供了一种严谨的方法来推导正则系综和巨正则系综的概率分布，揭示了它们并非任意的假设，而是与宏观约束相符的最无偏见的统计描述。通过这个推导过程，你将加深对信息论与统计力学之间深刻联系的理解 。",
            "id": "3779384",
            "problem": "考虑一个处于固定体积 $V$ 中的经典多粒子系统，其微观态由一个相空间点 $\\Gamma$ 和粒子数 $N$ 共同指定。假设哈密顿量为 $H(\\Gamma,N)$，并且相空间已被粗粒化为等权重的微单元，从而使微观态空间等效可数；令 $p(\\Gamma,N)$ 表示这些微观态上的概率质量函数。宏观（粗略）描述由对平均能量 $\\bar{E}$ 以及（在适用时）对平均粒子数 $\\bar{N}$ 的约束来指定。吉布斯熵为 $S_G[p] = -k_B \\sum_{N} \\sum_{\\Gamma} p(\\Gamma,N) \\ln p(\\Gamma,N)$，其中 $k_B$ 是玻尔兹曼常数。\n\n(a) 从 $S_G[p]$ 的基本定义出发，仅施加归一化和固定平均能量约束，推导在给定固定粒子数 $N$ 的情况下，使 $S_G[p]$ 最大化的微观态概率分布。用自由的拉格朗日乘子表示你的结果，并通过将所得的最大熵热力学与基本关系式 $dS = \\frac{1}{T}\\,dE + \\frac{p}{T}\\,dV - \\frac{\\mu}{T}\\,dN$进行比较，确定对于正则系综，哪个乘子等于 $\\beta \\equiv \\frac{1}{k_B T}$。\n\n(b) 现在允许系统与一个源进行粒子交换，从而只有 $V$ 是固定的，而约束条件是归一化、固定平均能量 $\\bar{E}$ 和固定平均粒子数 $\\bar{N}$。在这些约束下最大化 $S_G[p]$，以获得关于微观态 $(\\Gamma,N)$ 的概率分布，同样用拉格朗日乘子表示。利用与上述基本关系式的热力学一致性，证明与能量约束关联的乘子是 $\\beta = \\frac{1}{k_B T}$，而与粒子数约束关联的乘子是 $-\\beta \\mu$，其中 $\\mu$ 是化学势，$T$ 是绝对温度。\n\n在您的推导中，将 $p(\\Gamma,N)$ 视为相对于微单元上的粗粒化计数测度的概率（这样任何单元尺寸依赖性在 $S_G[p]$ 中都表现为一个加性常数，并且不影响最优化分布）。您可以用 $Z_N(\\beta,V)$ 和 $\\Xi(\\beta,\\mu,V)$ 分别表示正则系综和巨正则系综情形下的归一化常数（配分函数），而无需显式地计算它们。作为您的最终答案，请报告巨正则情形下最优分布 $p^{\\star}(\\Gamma,N)$ 的一个单一闭式解析表达式，用 $\\beta$、$\\mu$ 和 $H(\\Gamma,N)$ 表示。不需要进行数值计算，最终报告的表达式中也不应包含单位。",
            "solution": "该问题要求通过在特定约束条件下最大化吉布斯熵，来推导正则系综和巨正则系综的概率分布。这是使用拉格朗日乘子法的变分法的一个经典应用。该问题是良定的，并具有坚实的科学基础，建立在统计力学的基础原理之上。\n\n(a) 部分：正则系综分布的推导\n\n我们的任务是对于一个粒子数 $N$ 固定的系统，最大化吉布斯熵 $S_G[p] = -k_B \\sum_{\\Gamma} p(\\Gamma) \\ln p(\\Gamma)$。在 $S_G$ 的一般定义中，对 $N$ 的求和变成了一项，概率分布仅是相空间点 $\\Gamma$ 的函数，我们记为 $p(\\Gamma)$。最大化过程受两个约束条件限制：\n1.  归一化：$\\sum_{\\Gamma} p(\\Gamma) = 1$。\n2.  固定平均能量：$\\sum_{\\Gamma} p(\\Gamma) H(\\Gamma,N) = \\bar{E}$，其中 $H(\\Gamma,N)$ 是固定粒子数 $N$ 下的哈密顿量。\n\n为了解决这个约束最优化问题，我们引入拉格朗日乘子。我们来最大化泛函 $\\mathcal{L}[p]$，它是熵除以 $k_B$ 再加上约束项：\n$$\n\\mathcal{L}[p] = -\\sum_{\\Gamma} p(\\Gamma) \\ln p(\\Gamma) - (\\alpha-1) \\left( \\sum_{\\Gamma} p(\\Gamma) - 1 \\right) - \\beta \\left( \\sum_{\\Gamma} p(\\Gamma) H(\\Gamma,N) - \\bar{E} \\right)\n$$\n这里，$\\alpha-1$ 和 $\\beta$ 是拉格朗日乘子。我们寻求使泛函 $\\mathcal{L}[p]$ 驻定的分布 $p(\\Gamma)$。为了找到它，我们对任意微观态 $\\Gamma'$ 计算关于 $p(\\Gamma')$ 的泛函导数，并令其为零：\n$$\n\\frac{\\delta \\mathcal{L}}{\\delta p(\\Gamma')} = \\frac{\\partial}{\\partial p(\\Gamma')} \\left( -p(\\Gamma') \\ln p(\\Gamma') - (\\alpha-1)p(\\Gamma') - \\beta p(\\Gamma') H(\\Gamma',N) \\right) = 0\n$$\n$$\n-\\ln p(\\Gamma') - 1 - (\\alpha-1) - \\beta H(\\Gamma',N) = 0\n$$\n$$\n\\ln p(\\Gamma') = -\\alpha - \\beta H(\\Gamma',N)\n$$\n解出 $p(\\Gamma')$，我们得到：\n$$\np(\\Gamma') = \\exp(-\\alpha) \\exp(-\\beta H(\\Gamma',N))\n$$\n乘子 $\\alpha$ 由归一化约束确定：\n$$\n\\sum_{\\Gamma'} p(\\Gamma') = \\sum_{\\Gamma'} \\exp(-\\alpha) \\exp(-\\beta H(\\Gamma',N)) = 1\n$$\n$$\n\\exp(-\\alpha) \\sum_{\\Gamma'} \\exp(-\\beta H(\\Gamma',N)) = 1\n$$\n这个求和是具有 $N$ 个粒子的系统的正则配分函数，题目要求我们将其表示为 $Z_N(\\beta,V)$。\n$$\nZ_N(\\beta,V) = \\sum_{\\Gamma} \\exp(-\\beta H(\\Gamma,N))\n$$\n因此，$\\exp(-\\alpha) = \\frac{1}{Z_N(\\beta,V)}$。使熵最大化的概率分布是：\n$$\np^{\\star}(\\Gamma) = \\frac{1}{Z_N(\\beta,V)} \\exp(-\\beta H(\\Gamma,N))\n$$\n为了确定乘子 $\\beta$ 的物理意义，我们将得到的热力学结果与基本关系式 $dS = \\frac{1}{T} dE + \\frac{p}{T} dV - \\frac{\\mu}{T} dN$ 进行比较。对于一个恒定体积 $V$ 和粒子数 $N$ 的过程，该关系式简化为 $dS = \\frac{1}{T} dE$，这意味着 $(\\frac{\\partial S}{\\partial E})_{V,N} = \\frac{1}{T}$。\n\n让我们从统计力学的结果中计算这个导数。最大熵为 $S_{\\text{max}} = -k_B \\sum_{\\Gamma} p^{\\star}(\\Gamma) \\ln p^{\\star}(\\Gamma)$。\n使用 $\\ln p^{\\star}(\\Gamma) = -\\ln Z_N - \\beta H(\\Gamma,N)$，我们将其代入熵的表达式中：\n$$\nS_{\\text{max}} = -k_B \\sum_{\\Gamma} p^{\\star}(\\Gamma) (-\\ln Z_N - \\beta H(\\Gamma,N)) = k_B \\ln Z_N \\sum_{\\Gamma} p^{\\star}(\\Gamma) + k_B \\beta \\sum_{\\Gamma} p^{\\star}(\\Gamma) H(\\Gamma,N)\n$$\n使用约束条件 $\\sum p^{\\star} = 1$ 和 $\\sum p^{\\star} H = \\bar{E}$，我们发现：\n$$\nS_{\\text{max}} = k_B \\ln Z_N + k_B \\beta \\bar{E}\n$$\n现在我们计算 $S_{\\text{max}}$ 的全微分，将其视为 $\\bar{E}$ 的函数（而 $\\bar{E}$ 本身又依赖于 $\\beta$）：\n$$\ndS_{\\text{max}} = k_B \\frac{dZ_N}{Z_N} + k_B \\beta d\\bar{E} + k_B \\bar{E} d\\beta\n$$\n配分函数 $dZ_N$ 关于 $\\beta$ 的微分是：\n$$\ndZ_N = \\sum_{\\Gamma} \\frac{d}{d\\beta} \\exp(-\\beta H(\\Gamma,N)) d\\beta = \\sum_{\\Gamma} -H(\\Gamma,N) \\exp(-\\beta H(\\Gamma,N)) d\\beta = -Z_N \\bar{E} d\\beta\n$$\n因此，$\\frac{dZ_N}{Z_N} = -\\bar{E} d\\beta$。将此代回 $dS_{\\text{max}}$ 的表达式中：\n$$\ndS_{\\text{max}} = k_B(-\\bar{E} d\\beta) + k_B \\beta d\\bar{E} + k_B \\bar{E} d\\beta = k_B \\beta d\\bar{E}\n$$\n由此，我们得到偏导数 $(\\frac{\\partial S_{\\text{max}}}{\\partial \\bar{E}})_{V,N} = k_B \\beta$。\n将此与热力学恒等式 $(\\frac{\\partial S}{\\partial E})_{V,N} = \\frac{1}{T}$ 进行比较，我们得出结论：\n$$\nk_B \\beta = \\frac{1}{T} \\implies \\beta = \\frac{1}{k_B T}\n$$\n这确定了拉格朗日乘子 $\\beta$ 为逆温度，差一个玻尔兹曼常数因子。\n\n(b) 部分：巨正则系综分布的推导\n\n现在我们允许粒子数 $N$ 涨落。我们必须在三个约束条件下最大化 $S_G[p] = -k_B \\sum_{N} \\sum_{\\Gamma} p(\\Gamma,N) \\ln p(\\Gamma,N)$：\n1.  归一化：$\\sum_N \\sum_{\\Gamma} p(\\Gamma,N) = 1$。\n2.  固定平均能量：$\\sum_N \\sum_{\\Gamma} p(\\Gamma,N) H(\\Gamma,N) = \\bar{E}$。\n3.  固定平均粒子数：$\\sum_N \\sum_{\\Gamma} p(\\Gamma,N) N = \\bar{N}$。\n\n我们建立一个新的包含三个乘子的拉格朗日函数，我们将其记为 $(\\alpha_G-1)$、$\\beta$ 和 $\\gamma$：\n$$\n\\mathcal{L}[p] = -\\sum_{N,\\Gamma} p \\ln p - (\\alpha_G-1)(\\sum_{N,\\Gamma} p - 1) - \\beta(\\sum_{N,\\Gamma} p H - \\bar{E}) - \\gamma(\\sum_{N,\\Gamma} p N - \\bar{N})\n$$\n对 $p(\\Gamma',N')$ 求导并令其为零，可得：\n$$\n-\\ln p(\\Gamma',N') - 1 - (\\alpha_G-1) - \\beta H(\\Gamma',N') - \\gamma N' = 0\n$$\n$$\n\\ln p(\\Gamma',N') = -\\alpha_G - \\beta H(\\Gamma',N') - \\gamma N'\n$$\n$$\np(\\Gamma',N') = \\exp(-\\alpha_G) \\exp(-\\beta H(\\Gamma',N') - \\gamma N')\n$$\n归一化要求 $\\sum_{N'}\\sum_{\\Gamma'} p(\\Gamma',N') = 1$，这给出：\n$$\n\\exp(-\\alpha_G) \\sum_{N'} \\sum_{\\Gamma'} \\exp(-\\beta H(\\Gamma',N') - \\gamma N') = 1\n$$\n该求和定义了巨正则配分函数，记为 $\\Xi(\\beta, \\gamma, V)$：\n$$\n\\Xi(\\beta, \\gamma, V) = \\sum_N \\sum_{\\Gamma} \\exp(-\\beta H(\\Gamma,N) - \\gamma N)\n$$\n因此，$\\exp(-\\alpha_G) = 1/\\Xi$。熵最大化分布为：\n$$\np^{\\star}(\\Gamma,N) = \\frac{1}{\\Xi(\\beta, \\gamma, V)} \\exp(-\\beta H(\\Gamma,N) - \\gamma N)\n$$\n为了确定 $\\beta$ 和 $\\gamma$，我们遵循类似的过程。最大熵为：\n$$\nS_{\\text{max}} = -k_B \\sum_{N,\\Gamma} p^{\\star} \\ln p^{\\star} = k_B \\ln \\Xi + k_B \\beta \\bar{E} + k_B \\gamma \\bar{N}\n$$\n$S_{\\text{max}}$ 的全微分是：\n$$\ndS_{\\text{max}} = k_B d(\\ln \\Xi) + k_B \\beta d\\bar{E} + k_B \\bar{E} d\\beta + k_B \\gamma d\\bar{N} + k_B \\bar{N} d\\gamma\n$$\n$\\ln \\Xi$ 的微分可以从 $\\Xi$ 的定义中找到：\n$$\nd(\\ln \\Xi) = \\frac{d\\Xi}{\\Xi} = \\frac{1}{\\Xi} \\sum_{N,\\Gamma} \\exp(-\\beta H - \\gamma N) (-H d\\beta - N d\\gamma) = -\\bar{E} d\\beta - \\bar{N} d\\gamma\n$$\n将此代入 $dS_{\\text{max}}$ 的表达式中：\n$$\ndS_{\\text{max}} = k_B(-\\bar{E} d\\beta - \\bar{N} d\\gamma) + k_B \\beta d\\bar{E} + k_B \\bar{E} d\\beta + k_B \\gamma d\\bar{N} + k_B \\bar{N} d\\gamma\n$$\n包含 $d\\beta$ 和 $d\\gamma$ 的项相互抵消，剩下：\n$$\ndS_{\\text{max}} = k_B \\beta d\\bar{E} + k_B \\gamma d\\bar{N}\n$$\n我们将此结果与恒定体积 $V$ 下的基本热力学关系式 $dS = \\frac{1}{T} dE - \\frac{\\mu}{T} dN$ 进行比较。通过比较微分 $d\\bar{E}$ 和 $d\\bar{N}$ 的系数，我们得到两个恒等式：\n1.  从 $d\\bar{E}$ 的系数可得：$k_B \\beta = \\frac{1}{T}$，这给出 $\\beta = \\frac{1}{k_B T}$。这证实了 $\\beta$ 的确定结果与正则系综中的情况相同。\n2.  从 $d\\bar{N}$ 的系数可得：$k_B \\gamma = -\\frac{\\mu}{T}$。利用 $\\beta$ 的结果，我们可以写出 $\\frac{1}{T} = k_B \\beta$，因此 $k_B \\gamma = -\\mu k_B \\beta$，简化后得到 $\\gamma = -\\beta \\mu$。\n\n这就完成了对拉格朗日乘子的确定。因此，巨正则系综情形下的最优分布 $p^{\\star}(\\Gamma,N)$，用 $\\beta$、$\\mu$ 和 $H(\\Gamma,N)$ 表示为：\n$$\np^{\\star}(\\Gamma,N) = \\frac{1}{\\Xi(\\beta,\\mu,V)} \\exp(-\\beta(H(\\Gamma,N) - \\mu N))\n$$\n其中配分函数现在写为变量 $\\beta$ 和 $\\mu$ 的函数：\n$$\n\\Xi(\\beta,\\mu,V) = \\sum_N \\sum_\\Gamma \\exp(-\\beta(H(\\Gamma,N) - \\mu N))\n$$\n这就是所要求的表达式。",
            "answer": "$$\n\\boxed{\\frac{\\exp(-\\beta(H(\\Gamma,N)-\\mu N))}{\\Xi(\\beta,\\mu,V)}}\n$$"
        },
        {
            "introduction": "在统计系综的基础上，此练习将探索微观涨落与宏观响应之间的深刻关系。你将推导涨落-耗散定理的一个版本，它将系统的磁化率（或称易感性）与其两点关联函数联系起来。这项实践对于理解微观尺度上的集体行为如何引发可观测现象（如临界乳光和相变点附近的发散）至关重要 。",
            "id": "3779455",
            "problem": "考虑一个处于逆温度 $\\beta$ 的均匀平衡系统，其微观状态为 $\\mathbb{R}^{3}$ 上的标量场构型 $\\phi(\\mathbf{x})$，相空间由所有平方可积场构成的空间给出。该系统受到一个空间均匀的外部场 $h$ 的作用，该场与宏观序参量密度线性耦合。在该场下的能量泛函为 $\\mathcal{H}_{h}[\\phi]=\\mathcal{H}_{0}[\\phi]-h\\int_{\\mathbb{R}^{3}}\\phi(\\mathbf{x})\\,\\mathrm{d}^{3}\\mathbf{x}$，吉布斯测度为 $\\mathrm{d}\\mu_{h}(\\phi)\\propto \\exp(-\\beta\\,\\mathcal{H}_{h}[\\phi])\\mathcal{D}\\phi$。将宏观态序参量定义为一个大体积 $V$ 上的空间平均 $\\Phi[\\phi]=\\frac{1}{V}\\int_{V}\\phi(\\mathbf{x})\\,\\mathrm{d}^{3}\\mathbf{x}$，磁化率定义为 $\\chi=\\left.\\frac{\\partial\\langle\\Phi\\rangle}{\\partial h}\\right|_{h=0}$，其中 $\\langle\\cdot\\rangle$ 表示相对于 $\\mathrm{d}\\mu_{h}(\\phi)$ 的系综平均。假设 $V$ 足够大，以至于边界效应可以忽略不计，并且在 $h=0$ 时平移不变性成立。\n\n仅从上述基本定义出发，且不引入任何额外的未经检验的假设，推导一个用在 $h=0$ 处计算的连通两点关联函数 $C(\\mathbf{r})=\\langle\\phi(\\mathbf{x})\\phi(\\mathbf{x}+\\mathbf{r})\\rangle-\\langle\\phi(\\mathbf{x})\\rangle\\langle\\phi(\\mathbf{x}+\\mathbf{r})\\rangle$ 表示的 $\\chi$ 的表达式。\n\n然后，在一个无量纲的重标定下，其中长度 $\\mathbf{r}$ 和 $\\xi$ 以微观截断为单位进行测量，且 $\\phi$ 是无量纲的，假设在临界点附近，三维空间中的连通两点关联函数具有 Ornstein–Zernike 形式，\n$$\nC(r)=\\frac{A}{4\\pi r}\\,\\exp\\left(-\\frac{r}{\\xi}\\right),\n$$\n其中 $A>0$ 与 $r$ 无关，$\\xi>0$ 是关联长度。请以 $\\beta$、 $A$ 和 $\\xi$ 的形式，计算磁化率 $\\chi$ 的显式闭合解析表达式。不需要进行数值取整。最后，解释当 $\\xi\\to\\infty$ 时 $\\chi$ 的发散如何反映了由集体微观态关联引起的宏观态涨落的放大，但最终答案仅需以所要求的解析表达式给出。",
            "solution": "首先对问题陈述进行验证过程。\n\n### 步骤1：提取已知条件\n- 系统：处于逆温度 $\\beta$ 的均匀平衡系统。\n- 微观状态：$\\mathbb{R}^{3}$ 上的标量场构型 $\\phi(\\mathbf{x})$。\n- 相空间：所有平方可积场构成的空间。\n- 外部场：空间均匀的 $h$。\n- 能量泛函：$\\mathcal{H}_{h}[\\phi]=\\mathcal{H}_{0}[\\phi]-h\\int_{\\mathbb{R}^{3}}\\phi(\\mathbf{x})\\,\\mathrm{d}^{3}\\mathbf{x}$。\n- 吉布斯测度：$\\mathrm{d}\\mu_{h}(\\phi)\\propto \\exp(-\\beta\\,\\mathcal{H}_{h}[\\phi])\\mathcal{D}\\phi$。\n- 宏观态序参量：$\\Phi[\\phi]=\\frac{1}{V}\\int_{V}\\phi(\\mathbf{x})\\,\\mathrm{d}^{3}\\mathbf{x}$，于一个大体积 $V$ 上。\n- 磁化率：$\\chi=\\left.\\frac{\\partial\\langle\\Phi\\rangle}{\\partial h}\\right|_{h=0}$。\n- 系综平均：$\\langle\\cdot\\rangle$ 表示相对于 $\\mathrm{d}\\mu_{h}(\\phi)$ 的平均。\n- 假设：$V$ 很大，边界效应可以忽略，且在 $h=0$ 时平移不变性成立。\n- $h=0$ 时的连通两点关联函数：$C(\\mathbf{r})=\\langle\\phi(\\mathbf{x})\\phi(\\mathbf{x}+\\mathbf{r})\\rangle-\\langle\\phi(\\mathbf{x})\\rangle\\langle\\phi(\\mathbf{x}+\\mathbf{r})\\rangle$。\n- $C(r)$ 的具体形式：$C(r)=\\frac{A}{4\\pi r}\\,\\exp(-\\frac{r}{\\xi})$，对于三维空间中的 $r=|\\mathbf{r}|$，其中 $A>0$ 且 $\\xi>0$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题是统计场论中的一个标准练习，涉及线性响应理论（涨落-耗散定理）和临界现象。能量泛函、吉布斯测度、磁化率和 Ornstein-Zernike 关联函数的定义在该领域都是经典的。该问题是科学合理的。\n- **适定性**：该问题要求推导一个一般关系，然后使用一个给定的函数进行特定计算。步骤定义清晰，能导出一个唯一且有意义的解。\n- **客观性**：问题以精确的数学语言陈述，没有歧义或主观论断。\n- **不完整或矛盾的设定**：问题是自洽的。大体积 $V$ 和平移不变性的假设是标准的，并且是推导所必需的。没有矛盾之处。在哈密顿量中使用 $\\int_{\\mathbb{R}^3}$ 和在序参量中使用 $\\int_V$ 是标准做法，其中 $V$ 被理解为系统的大而有限的体积，在热力学极限下可视为整个空间。\n- **不切实际或不可行**：该设定是一个理论模型（Ginzburg-Landau 型理论），是现代统计物理学的基石。它在物理上是合理的，在理论上是可行的。\n- **所有其他标准**：问题结构良好、具有一定深度且可验证。\n\n### 步骤3：结论与行动\n该问题有效。将提供详细的解答。\n\n***\n\n解答过程分两个阶段。首先，我们推导磁化率 $\\chi$ 以连通两点关联函数 $C(\\mathbf{r})$ 表示的一般表达式。其次，我们针对给定的 Ornstein-Zernike 形式的 $C(\\mathbf{r})$ 计算该表达式的值。\n\n在存在外部场 $h$ 的情况下，序参量 $\\Phi$ 的系综平均由下式给出\n$$\n\\langle\\Phi\\rangle_h = \\frac{\\int \\left(\\frac{1}{V}\\int_V \\phi(\\mathbf{x})\\,\\mathrm{d}^3\\mathbf{x}\\right) \\exp(-\\beta\\mathcal{H}_h[\\phi]) \\mathcal{D}\\phi}{\\int \\exp(-\\beta\\mathcal{H}_h[\\phi]) \\mathcal{D}\\phi}\n$$\n配分函数为 $Z_h = \\int \\exp(-\\beta\\mathcal{H}_h[\\phi]) \\mathcal{D}\\phi$。能量泛函为 $\\mathcal{H}_h[\\phi] = \\mathcal{H}_0[\\phi] - h M[\\phi]$，其中 $M[\\phi] = \\int_V \\phi(\\mathbf{y})\\,\\mathrm{d}^3\\mathbf{y}$ 是总序参量。对于一个大体积 $V$，我们将哈密顿量中的积分视为在 $V$ 上进行。\n\n总序参量的平均值 $\\langle M \\rangle_h$ 可以与配分函数相关联：\n$$\n\\langle M \\rangle_h = \\frac{\\int M[\\phi] \\exp(-\\beta(\\mathcal{H}_0 - hM[\\phi])) \\mathcal{D}\\phi}{Z_h} = \\frac{1}{\\beta Z_h} \\frac{\\partial Z_h}{\\partial h} = \\frac{1}{\\beta} \\frac{\\partial \\ln Z_h}{\\partial h}\n$$\n平均宏观态序参量为 $\\langle\\Phi\\rangle_h = \\frac{1}{V}\\langle M \\rangle_h$。磁化率 $\\chi$ 定义为\n$$\n\\chi = \\left.\\frac{\\partial\\langle\\Phi\\rangle_h}{\\partial h}\\right|_{h=0} = \\left.\\frac{1}{V} \\frac{\\partial\\langle M \\rangle_h}{\\partial h}\\right|_{h=0} = \\left.\\frac{1}{V\\beta} \\frac{\\partial^2 \\ln Z_h}{\\partial h^2}\\right|_{h=0}\n$$\n我们计算二阶导数：\n$$\n\\frac{\\partial^2 \\ln Z_h}{\\partial h^2} = \\frac{\\partial}{\\partial h}\\left(\\frac{1}{Z_h}\\frac{\\partial Z_h}{\\partial h}\\right) = -\\frac{1}{Z_h^2}\\left(\\frac{\\partial Z_h}{\\partial h}\\right)^2 + \\frac{1}{Z_h}\\frac{\\partial^2 Z_h}{\\partial h^2}\n$$\n我们有 $\\frac{\\partial Z_h}{\\partial h} = \\beta Z_h \\langle M \\rangle_h$。$Z_h$ 的二阶导数是\n$$\n\\frac{\\partial^2 Z_h}{\\partial h^2} = \\frac{\\partial}{\\partial h}\\left(\\int \\beta M[\\phi] \\exp(-\\beta\\mathcal{H}_h[\\phi]) \\mathcal{D}\\phi\\right) = \\int \\beta M[\\phi] (\\beta M[\\phi]) \\exp(-\\beta\\mathcal{H}_h[\\phi]) \\mathcal{D}\\phi = \\beta^2 Z_h \\langle M^2 \\rangle_h\n$$\n将这些代入 $\\frac{\\partial^2 \\ln Z_h}{\\partial h^2}$ 的表达式中：\n$$\n\\frac{\\partial^2 \\ln Z_h}{\\partial h^2} = -\\frac{1}{Z_h^2}(\\beta Z_h \\langle M \\rangle_h)^2 + \\frac{1}{Z_h}(\\beta^2 Z_h \\langle M^2 \\rangle_h) = \\beta^2 \\left( \\langle M^2 \\rangle_h - \\langle M \\rangle_h^2 \\right)\n$$\n这个量是总序参量 $M$ 的方差乘以 $\\beta^2$。因此，磁化率为\n$$\n\\chi = \\frac{1}{V\\beta} \\left[ \\beta^2 \\left( \\langle M^2 \\rangle_h - \\langle M \\rangle_h^2 \\right) \\right]_{h=0} = \\frac{\\beta}{V} \\left( \\langle M^2 \\rangle_0 - \\langle M \\rangle_0^2 \\right)\n$$\n其中 $\\langle \\cdot \\rangle_0$ 表示在 $h=0$ 时的平均值。我们现在用场关联函数来表示 $M$ 的方差。\n$$\n\\langle M^2 \\rangle_0 - \\langle M \\rangle_0^2 = \\left\\langle \\left(\\int_V \\phi(\\mathbf{x})\\,\\mathrm{d}^3\\mathbf{x}\\right)^2 \\right\\rangle_0 - \\left\\langle \\int_V \\phi(\\mathbf{x})\\,\\mathrm{d}^3\\mathbf{x} \\right\\rangle_0^2\n$$\n$$\n= \\int_V \\mathrm{d}^3\\mathbf{x} \\int_V \\mathrm{d}^3\\mathbf{y} \\left( \\langle \\phi(\\mathbf{x})\\phi(\\mathbf{y}) \\rangle_0 - \\langle\\phi(\\mathbf{x})\\rangle_0 \\langle\\phi(\\mathbf{y})\\rangle_0 \\right)\n$$\n根据 $h=0$ 时平移不变性的假设，$\\langle\\phi(\\mathbf{x})\\phi(\\mathbf{y})\\rangle_0$ 仅依赖于相对位移矢量 $\\mathbf{r} = \\mathbf{y}-\\mathbf{x}$。此外，$\\langle\\phi(\\mathbf{x})\\rangle_0$ 是一个常数。括号中的项正是连通两点关联函数 $C(\\mathbf{y}-\\mathbf{x})$ 的定义。\n$$\n\\langle M^2 \\rangle_0 - \\langle M \\rangle_0^2 = \\int_V \\mathrm{d}^3\\mathbf{x} \\int_V \\mathrm{d}^3\\mathbf{y} \\, C(\\mathbf{y}-\\mathbf{x})\n$$\n我们更换变量为 $\\mathbf{r} = \\mathbf{y}-\\mathbf{x}$ 和质心坐标（可以取为 $\\mathbf{x}$）。对于大体积 $V$ 和衰减足够快的关联函数 $C(\\mathbf{r})$，我们可以近似该积分。对于远离 $V$ 边界的任何点 $\\mathbf{x}$，对 $\\mathbf{y}$ 的积分覆盖了 $C(\\mathbf{y}-\\mathbf{x})$ 不可忽略的整个区域。因此，我们可以将对 $\\mathbf{r}$ 的积分扩展到整个 $\\mathbb{R}^3$。\n$$\n\\int_V \\mathrm{d}^3\\mathbf{y} \\, C(\\mathbf{y}-\\mathbf{x}) \\approx \\int_{\\mathbb{R}^3} \\mathrm{d}^3\\mathbf{r} \\, C(\\mathbf{r})\n$$\n这个结果与 $\\mathbf{x}$ 无关。剩下对 $\\mathbf{x}$ 的积分得到体积 $V$。\n$$\n\\langle M^2 \\rangle_0 - \\langle M \\rangle_0^2 \\approx \\int_V \\mathrm{d}^3\\mathbf{x} \\left( \\int_{\\mathbb{R}^3} \\mathrm{d}^3\\mathbf{r} \\, C(\\mathbf{r}) \\right) = V \\int_{\\mathbb{R}^3} C(\\mathbf{r})\\,\\mathrm{d}^3\\mathbf{r}\n$$\n将此结果代入磁化率的表达式中，我们得到 $\\chi$ 的涨落-耗散定理：\n$$\n\\chi = \\frac{\\beta}{V} \\left( V \\int_{\\mathbb{R}^3} C(\\mathbf{r})\\,\\mathrm{d}^3\\mathbf{r} \\right) = \\beta \\int_{\\mathbb{R}^3} C(\\mathbf{r})\\,\\mathrm{d}^3\\mathbf{r}\n$$\n这就是所要求的用 $C(\\mathbf{r})$ 表示的 $\\chi$ 的表达式。\n\n接下来，我们对给定的 Ornstein-Zernike 形式 $C(r)=\\frac{A}{4\\pi r}\\,\\exp(-\\frac{r}{\\xi})$（其中 $r=|\\mathbf{r}|$）计算这个积分。最好在球坐标中进行积分，其中 $\\mathrm{d}^3\\mathbf{r} = r^2\\sin\\theta\\,\\mathrm{d}r\\,\\mathrm{d}\\theta\\,\\mathrm{d}\\phi$。\n$$\n\\int_{\\mathbb{R}^3} C(\\mathbf{r})\\,\\mathrm{d}^3\\mathbf{r} = \\int_{0}^{2\\pi}\\mathrm{d}\\phi \\int_{0}^{\\pi}\\mathrm{d}\\theta\\,\\sin\\theta \\int_{0}^{\\infty}\\mathrm{d}r\\,r^2 C(r)\n$$\n角向积分的结果是 $4\\pi$。\n$$\n\\int_{\\mathbb{R}^3} C(\\mathbf{r})\\,\\mathrm{d}^3\\mathbf{r} = 4\\pi \\int_{0}^{\\infty} r^2 \\left( \\frac{A}{4\\pi r}\\,\\exp\\left(-\\frac{r}{\\xi}\\right) \\right) \\mathrm{d}r = A \\int_{0}^{\\infty} r \\exp\\left(-\\frac{r}{\\xi}\\right) \\mathrm{d}r\n$$\n这个积分可以使用分部积分法求解，$\\int u\\,\\mathrm{d}v = uv - \\int v\\,\\mathrm{d}u$。令 $u=r$ 且 $\\mathrm{d}v = \\exp(-r/\\xi)\\,\\mathrm{d}r$。则 $\\mathrm{d}u = \\mathrm{d}r$ 且 $v = -\\xi\\exp(-r/\\xi)$。\n$$\n\\int_{0}^{\\infty} r \\exp\\left(-\\frac{r}{\\xi}\\right) \\mathrm{d}r = \\left[-r\\xi\\exp\\left(-\\frac{r}{\\xi}\\right)\\right]_{0}^{\\infty} - \\int_{0}^{\\infty} (-\\xi)\\exp\\left(-\\frac{r}{\\xi}\\right)\\mathrm{d}r\n$$\n边界项在两个极限处均为零：$\\lim_{r\\to\\infty} r\\exp(-r/\\xi) = 0$ 且 $0\\exp(0)=0$。剩下的积分为：\n$$\n\\xi \\int_{0}^{\\infty} \\exp\\left(-\\frac{r}{\\xi}\\right)\\mathrm{d}r = \\xi \\left[-\\xi\\exp\\left(-\\frac{r}{\\xi}\\right)\\right]_{0}^{\\infty} = \\xi \\left( 0 - (-\\xi) \\right) = \\xi^2\n$$\n所以，关联函数的全空间积分是 $A\\xi^2$。\n最后，磁化率为：\n$$\n\\chi = \\beta \\left( A\\xi^2 \\right) = \\beta A \\xi^2\n$$\n这就是磁化率的最终闭合形式解析表达式。",
            "answer": "$$\\boxed{\\beta A \\xi^2}$$"
        },
        {
            "introduction": "哈密顿动力学的理论优美性，特别是刘维尔定理所描述的相空间体积守恒特性，在计算机模拟中具有至关重要的实际意义。这个动手编程练习对比了辛与非辛数值积分器，让你能够直接观察到看似微小的数值误差如何导致非物理的人为现象，如能量漂移和微观态分布的扭曲。这项实践强调了在多尺度建模中选择保结构算法的重要性 。",
            "id": "3779467",
            "problem": "考虑一个一维谐振子的微观状态系综，其广义坐标为 $q$，共轭动量为 $p$。哈密顿量为 $H(q,p) = \\frac{p^{2}}{2 m} + \\frac{k q^{2}}{2}$，其中质量为 $m$，刚度为 $k$。根据刘维尔定理，精确的哈密顿流是辛的，并保持相空间体积。在多尺度建模中，诸如平均能量之类的宏观统计量是通过在相空间中对微观状态进行采样而得出的。本问题要求您比较几种非辛时间积分器，并量化相空间压缩或膨胀如何影响微观状态采样和宏观统计量。在整个过程中请使用无量纲单位。\n\n基本基础：\n- 哈密顿方程：$\\dot{q} = \\frac{\\partial H}{\\partial p} = \\frac{p}{m}$ 和 $\\dot{p} = -\\frac{\\partial H}{\\partial q} = -k q$，它们定义了一个线性常微分方程（ODE）系统 $\\dot{x} = A x$，其中 $x = \\begin{bmatrix} q \\\\ p \\end{bmatrix}$ 且 $A = \\begin{bmatrix} 0 & \\frac{1}{m} \\\\ -k & 0 \\end{bmatrix}$。\n- 哈密顿动力学的刘维尔定理：精确流保持相空间体积，因此精确时间-$\\Delta t$ 映射的雅可比行列式为 $1$。\n- 逆温度 $\\beta$ 下的正则（玻尔兹曼-吉布斯）系综：微观状态呈零均值高斯分布，其协方差为 $\\Sigma_{0} = \\mathrm{diag}\\left(\\frac{1}{\\beta k}, \\frac{m}{\\beta}\\right)$。\n\n需要从第一性原理解决的目标任务：\n1. 对于线性 ODE 系统 $\\dot{x} = A x$，为以下每个时间积分器（以时间步长 $\\Delta t$ 应用）构建单步离散时间映射 $x_{n+1} = M x_{n}$：\n   - 前向（显式）欧拉法。\n   - 后向（隐式）欧拉法。\n   - 经典四阶龙格-库塔法（RK4; Runge–Kutta）。\n2. 对每个积分器，计算单步雅可比行列式 $\\det(M)$ 和 $N$ 步相空间体积因子 $\\det(M)^{N}$。\n3. 对每个积分器，通过线性协方差前推 $\\Sigma_{N} = M^{N} \\Sigma_{0} (M^{N})^{\\top}$ 传播正则协方差 $N$ 步，并计算 $N$ 步后的宏观平均能量，\n   $$E_{N} = \\frac{1}{2} \\left( k \\, \\Sigma_{N,11} + \\frac{1}{m} \\, \\Sigma_{N,22} \\right),$$\n   以及初始平均能量 $E_{0} = \\frac{1}{\\beta}$。报告能量比 $E_{N} / E_{0}$。\n4. 通过计算形变的高斯分布 $N(0,\\Sigma_{N})$ 与初始高斯分布 $N(0,\\Sigma_{0})$ 之间的库尔贝克-莱布勒散度（KLD; Kullback–Leibler divergence），量化由相空间压缩/膨胀引起的微观状态采样的失真，\n   $$D_{\\mathrm{KL}}( \\mathcal{N}(0,\\Sigma_{N}) \\Vert \\mathcal{N}(0,\\Sigma_{0}) ) = \\frac{1}{2} \\left( \\mathrm{tr}(\\Sigma_{0}^{-1} \\Sigma_{N}) - d - \\ln \\det( \\Sigma_{N} \\Sigma_{0}^{-1} ) \\right),$$\n   其中 $d = 2$。\n\n科学真实性和推导约束：\n- 直接根据每个积分器应用于线性系统 $\\dot{x} = A x$ 的标准定义来构建 $M$。不要假设任何预先计算的 $M$ 的快捷公式；用 $A$、$\\Delta t$、$m$ 和 $k$ 来推导 $M$。\n- 使用 $\\Sigma_{N} = M^{N} \\Sigma_{0} (M^{N})^{\\top}$ 来传播正则协方差。除了线性映射下的高斯协方差前推之外，不要依赖任何外部统计恒等式。\n\n角度单位：不适用。物理单位：无量纲。\n\n测试套件和输出规范：\n- 对于下面的每个参数集 $(m,k,\\beta,\\Delta t,N)$，为每个积分器计算以下四个量：\n  - 单步雅可比行列式 $\\det(M)$。\n  - $N$ 步体积因子 $\\det(M)^{N}$。\n  - 能量比 $E_{N}/E_{0}$。\n  - 上述的库尔贝克-莱布勒散度 $D_{\\mathrm{KL}}$。\n- 在最终输出中将每个浮点数四舍五入到六位小数。\n- 测试套件参数集：\n  1. $(m,k,\\beta,\\Delta t,N) = (1.0, 1.0, 1.0, 0.2, 200)$。\n  2. $(m,k,\\beta,\\Delta t,N) = (1.0, 1.0, 1.0, 0.01, 2000)$。\n  3. $(m,k,\\beta,\\Delta t,N) = (0.5, 4.0, 1.0, 0.1, 500)$。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。每个参数集的结果本身必须是一个包含十二个浮点数的列表，顺序固定如下：\n  $$[\\det(M)_{\\mathrm{FE}}, \\det(M)_{\\mathrm{FE}}^{N}, (E_{N}/E_{0})_{\\mathrm{FE}}, D_{\\mathrm{KL}}_{\\mathrm{FE}}, \\det(M)_{\\mathrm{BE}}, \\det(M)_{\\mathrm{BE}}^{N}, (E_{N}/E_{0})_{\\mathrm{BE}}, D_{\\mathrm{KL}}_{\\mathrm{BE}}, \\det(M)_{\\mathrm{RK4}}, \\det(M)_{\\mathrm{RK4}}^{N}, (E_{N}/E_{0})_{\\mathrm{RK4}}, D_{\\mathrm{KL}}_{\\mathrm{RK4}}].$$\n- 将每个参数集的三个列表聚合到一个顶层列表中。例如，输出格式为 $[[\\ldots 12\\ \\text{floats}\\ \\ldots],[\\ldots 12\\ \\text{floats}\\ \\ldots],[\\ldots 12\\ \\text{floats}\\ \\ldots]]$，打印在单行上。",
            "solution": "提交分析的问题陈述被认为是有效的。它在科学上基于哈密顿力学、统计力学和数值分析的原理。目标是适定的，提供了所有必要的数据、定义和方程。语言是客观的，约束是明确的，允许一个唯一且可验证的解。\n\n该问题要求对三种数值积分器——前向欧拉法、后向欧拉法和经典四阶龙格-库塔法（RK4）——应用于一维谐振子的运动方程进行比较分析。分析的重点是这些非辛积分器如何影响相空间体积以及正则系综微观状态的统计特性。\n\n系统由哈密顿量 $H(q,p) = \\frac{p^{2}}{2 m} + \\frac{k q^{2}}{2}$ 描述。状态向量为 $x = \\begin{bmatrix} q \\\\ p \\end{bmatrix}$。哈密顿方程 $\\dot{q} = p/m$ 和 $\\dot{p} = -kq$ 可以写成线性形式 $\\dot{x} = A x$，其中矩阵 $A$ 是：\n$$\nA = \\begin{bmatrix} 0 & \\frac{1}{m} \\\\ -k & 0 \\end{bmatrix}\n$$\n这个线性常微分方程（ODE）系统在时间步长 $\\Delta t$ 后的解可以通过离散映射 $x_{n+1} = M x_n$ 来近似，其中矩阵 $M$ 是单步传播子，或时间-$\\Delta t$ 映射。我们将为每个指定的积分器推导 $M$。\n\n**1. 传播矩阵 $M$ 的推导**\n\n**a) 前向（显式）欧拉法 (FE)**\n前向欧拉法使用当前时间步的导数来近似下一个时间步的解：\n$$\nx_{n+1} = x_n + \\Delta t \\, \\dot{x}_n = x_n + \\Delta t \\, A x_n = (I + \\Delta t \\, A) x_n\n$$\n其中 $I$ 是 $2 \\times 2$ 单位矩阵。因此，前向欧拉法的传播矩阵 $M_{\\mathrm{FE}}$ 是：\n$$\nM_{\\mathrm{FE}} = I + \\Delta t \\, A = \\begin{bmatrix} 1 & \\frac{\\Delta t}{m} \\\\ -k \\Delta t & 1 \\end{bmatrix}\n$$\n\n**b) 后向（隐式）欧拉法 (BE)**\n后向欧拉法使用*下一个*时间步的导数，这使其成为一种隐式方法：\n$$\nx_{n+1} = x_n + \\Delta t \\, \\dot{x}_{n+1} = x_n + \\Delta t \\, A x_{n+1}\n$$\n我们必须求解 $x_{n+1}$：\n$$\n(I - \\Delta t \\, A) x_{n+1} = x_n \\implies x_{n+1} = (I - \\Delta t \\, A)^{-1} x_n\n$$\n后向欧拉法的传播矩阵 $M_{\\mathrm{BE}}$ 是：\n$$\nM_{\\mathrm{BE}} = (I - \\Delta t \\, A)^{-1} = \\left( \\begin{bmatrix} 1 & -\\frac{\\Delta t}{m} \\\\ k \\Delta t & 1 \\end{bmatrix} \\right)^{-1}\n$$\n待求逆矩阵的行列式是 $1 + \\frac{k}{m} \\Delta t^2$。其逆矩阵为：\n$$\nM_{\\mathrm{BE}} = \\frac{1}{1 + \\frac{k}{m} \\Delta t^2} \\begin{bmatrix} 1 & \\frac{\\Delta t}{m} \\\\ -k \\Delta t & 1 \\end{bmatrix}\n$$\n\n**c) 经典四阶龙格-库塔法 (RK4)**\n对于线性系统 $\\dot{x} = A x$，RK4 更新可以表示为矩阵指数级数的截断：\n$$\nx_{n+1} = \\left( I + \\Delta t \\, A + \\frac{(\\Delta t \\, A)^2}{2!} + \\frac{(\\Delta t \\, A)^3}{3!} + \\frac{(\\Delta t \\, A)^4}{4!} \\right) x_n\n$$\n因此，$M_{\\mathrm{RK4}} = I + \\Delta t \\, A + \\frac{\\Delta t^2}{2} A^2 + \\frac{\\Delta t^3}{6} A^3 + \\frac{\\Delta t^4}{24} A^4$。\n为了简化这个表达式，我们计算 $A$ 的幂。令 $\\omega_0^2 = k/m$。\n$$\nA^2 = \\begin{bmatrix} 0 & \\frac{1}{m} \\\\ -k & 0 \\end{bmatrix} \\begin{bmatrix} 0 & \\frac{1}{m} \\\\ -k & 0 \\end{bmatrix} = \\begin{bmatrix} -\\frac{k}{m} & 0 \\\\ 0 & -\\frac{k}{m} \\end{bmatrix} = -\\omega_0^2 I\n$$\n更高次的幂为：$A^3 = -\\omega_0^2 A$ 和 $A^4 = (-\\omega_0^2 I)^2 = \\omega_0^4 I$。\n将这些代入 $M_{\\mathrm{RK4}}$ 的表达式中：\n$$\nM_{\\mathrm{RK4}} = I + \\Delta t \\, A + \\frac{\\Delta t^2}{2} (-\\omega_0^2 I) + \\frac{\\Delta t^3}{6} (-\\omega_0^2 A) + \\frac{\\Delta t^4}{24} (\\omega_0^4 I)\n$$\n$$\nM_{\\mathrm{RK4}} = \\left( 1 - \\frac{\\omega_0^2 \\Delta t^2}{2} + \\frac{\\omega_0^4 \\Delta t^4}{24} \\right) I + \\left( \\Delta t - \\frac{\\omega_0^2 \\Delta t^3}{6} \\right) A\n$$\n\n**2. 派生量的计算**\n\n对于每个积分器，我们计算以下四个量。\n\n**a) 单步雅可比行列式和 $N$ 步体积因子**\n映射 $x \\mapsto M x$ 的雅可比矩阵就是矩阵 $M$ 本身。单步体积变化由其行列式 $\\det(M)$ 给出。经过 $N$ 步后，总体积变化因子为 $\\det(M^N) = (\\det(M))^N$。\n- **FE:** $\\det(M_{\\mathrm{FE}}) = 1 \\cdot 1 - (\\frac{\\Delta t}{m})(-k \\Delta t) = 1 + \\frac{k}{m}\\Delta t^2$。这大于 $1$，表示相空间膨胀。\n- **BE:** $\\det(M_{\\mathrm{BE}}) = \\det((I - \\Delta t \\, A)^{-1}) = \\frac{1}{\\det(I - \\Delta t \\, A)} = \\frac{1}{1 + \\frac{k}{m}\\Delta t^2}$。这小于 $1$，表示相空间压缩。\n- **RK4:** 令 $c_1 = (1 - \\frac{\\omega_0^2 \\Delta t^2}{2} + \\frac{\\omega_0^4 \\Delta t^4}{24})$ 且 $c_2 = (\\Delta t - \\frac{\\omega_0^2 \\Delta t^3}{6})$。则 $M_{\\mathrm{RK4}} = \\begin{bmatrix} c_1 & c_2/m \\\\ -k c_2 & c_1 \\end{bmatrix}$。行列式为 $\\det(M_{\\mathrm{RK4}}) = c_1^2 + \\frac{k}{m} c_2^2 = c_1^2 + \\omega_0^2 c_2^2$。这是 $1 + O(\\Delta t^6)$，比欧拉方法更接近 $1$。\n\n**b) 传播的协方差与能量比**\n初始状态是一个零均值高斯分布，其协方差为 $\\Sigma_0 = \\mathrm{diag}(\\frac{1}{\\beta k}, \\frac{m}{\\beta})$。经过线性映射 $M$ 的 $N$ 步后，分布仍然是一个零均值高斯分布，其新协方差 $\\Sigma_N$ 由前推法则给出：\n$$\n\\Sigma_N = M^N \\Sigma_0 (M^N)^{\\top}\n$$\n$N$ 步后的宏观平均能量为 $E_N = \\frac{1}{2} \\left( k \\, \\Sigma_{N,11} + \\frac{1}{m} \\, \\Sigma_{N,22} \\right)$。\n初始能量为 $E_0 = \\frac{1}{2} \\left( k \\, \\Sigma_{0,11} + \\frac{1}{m} \\, \\Sigma_{0,22} \\right) = \\frac{1}{2} \\left( k \\frac{1}{\\beta k} + \\frac{1}{m} \\frac{m}{\\beta} \\right) = \\frac{1}{\\beta}$。\n我们计算比率 $E_N / E_0$。偏离 $1$ 的能量比表示数值积分器违反了能量守恒。\n\n**c) 库尔贝克-莱布勒（KL）散度**\nKL 散度量化了微观状态概率分布的失真。对于最终分布 $\\mathcal{N}(0, \\Sigma_N)$ 相对于初始分布 $\\mathcal{N}(0, \\Sigma_0)$，公式为：\n$$\nD_{\\mathrm{KL}}( \\mathcal{N}(0,\\Sigma_{N}) \\Vert \\mathcal{N}(0,\\Sigma_{0}) ) = \\frac{1}{2} \\left( \\mathrm{tr}(\\Sigma_{0}^{-1} \\Sigma_{N}) - d - \\ln \\det( \\Sigma_{N} \\Sigma_{0}^{-1} ) \\right)\n$$\n其中维度 $d=2$。初始协方差的逆是 $\\Sigma_0^{-1} = \\mathrm{diag}(\\beta k, \\frac{\\beta}{m})$。项 $\\det(\\Sigma_N \\Sigma_0^{-1})$ 简化为 $\\det(\\Sigma_N) \\det(\\Sigma_0^{-1})$。\n\n以下代码实现了这些推导，以计算指定测试用例所需的量。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes numerical artifacts for non-symplectic integrators on a harmonic oscillator.\n\n    This function iterates through a set of test cases, each defined by physical\n    parameters (m, k, beta) and numerical parameters (dt, N). For each case, it\n    analyzes three integrators: Forward Euler (FE), Backward Euler (BE), and\n    classical fourth-order Runge-Kutta (RK4).\n\n    For each integrator, it calculates:\n    1. det(M): The one-step Jacobian determinant, indicating volume change.\n    2. det(M)^N: The N-step volume factor.\n    3. E_N / E_0: The ratio of final to initial mean energy.\n    4. D_KL: The Kullback-Leibler divergence from the initial to the final state\n       distribution.\n\n    The results are aggregated and printed in the specified format.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 1.0, 1.0, 0.2, 200),\n        (1.0, 1.0, 1.0, 0.01, 2000),\n        (0.5, 4.0, 1.0, 0.1, 500)\n    ]\n\n    all_results = []\n    \n    for m, k, beta, dt, N in test_cases:\n        case_results = []\n        \n        # System matrix A for dx/dt = Ax\n        A = np.array([[0.0, 1.0 / m], [-k, 0.0]])\n        \n        # Initial covariance matrix Sigma_0 and its inverse\n        Sigma0 = np.array([[1.0 / (beta * k), 0.0], [0.0, m / beta]])\n        Sigma0_inv = np.array([[beta * k, 0.0], [0.0, beta / m]])\n        \n        # Initial energy E_0\n        E0 = 1.0 / beta\n\n        # --- Integrator Definitions ---\n        # Identity matrix\n        I = np.identity(2)\n\n        # 1. Forward Euler\n        M_fe = I + dt * A\n        \n        # 2. Backward Euler\n        M_be = np.linalg.inv(I - dt * A)\n        \n        # 3. RK4 for linear system\n        A2 = A @ A\n        A3 = A2 @ A\n        A4 = A3 @ A\n        M_rk4 = I + dt * A + (dt**2 / 2.0) * A2 + (dt**3 / 6.0) * A3 + (dt**4 / 24.0) * A4\n        \n        integrators = {\n            'FE': M_fe,\n            'BE': M_be,\n            'RK4': M_rk4\n        }\n        \n        # The problem specifies a fixed order of results\n        integrator_order = ['FE', 'BE', 'RK4']\n\n        for name in integrator_order:\n            M = integrators[name]\n            \n            # 1. One-step Jacobian determinant\n            det_M = np.linalg.det(M)\n            \n            # 2. N-step volume factor\n            vol_factor_N = det_M ** N\n            \n            # Propagate for N steps\n            MN = np.linalg.matrix_power(M, N)\n            \n            # Covariance propagation: Sigma_N = M^N * Sigma_0 * (M^N)^T\n            SigmaN = MN @ Sigma0 @ MN.T\n            \n            # 3. Energy ratio\n            EN = 0.5 * (k * SigmaN[0, 0] + (1.0 / m) * SigmaN[1, 1])\n            energy_ratio = EN / E0\n            \n            # 4. KL Divergence\n            # KLD = 0.5 * (tr(Sigma0_inv * SigmaN) - d - log(det(SigmaN * Sigma0_inv)))\n            # where d=2\n            trace_term = np.trace(Sigma0_inv @ SigmaN)\n            det_term = np.linalg.det(SigmaN @ Sigma0_inv)\n            # Handle potential negative or zero determinant from numerical precision issues\n            if det_term = 0:\n                # This should not happen for the given integrators and small dt.\n                # If it does, KLD is ill-defined. Set to a large number or error flag.\n                # In this specific problem context, this case is not expected.\n                kld = np.inf \n            else:\n                log_det_term = np.log(det_term)\n                kld = 0.5 * (trace_term - 2.0 - log_det_term)\n\n            case_results.extend([det_M, vol_factor_N, energy_ratio, kld])\n            \n        all_results.append(case_results)\n\n    # Format the final output string\n    output_str = \"[\"\n    for i, res_list in enumerate(all_results):\n        formatted_list = [f\"{val:.6f}\" for val in res_list]\n        output_str += f\"[{','.join(formatted_list)}]\"\n        if i  len(all_results) - 1:\n            output_str += \",\"\n    output_str += \"]\"\n    \n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}