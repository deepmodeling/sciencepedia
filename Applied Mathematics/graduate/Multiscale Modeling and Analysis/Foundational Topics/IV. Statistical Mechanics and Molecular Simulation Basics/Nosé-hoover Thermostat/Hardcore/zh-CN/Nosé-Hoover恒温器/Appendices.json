{
    "hands_on_practices": [
        {
            "introduction": "Nosé-Hoover 恒温器的一个关键目标是生成正确的正则系综。本次练习旨在建立恒温器动力学与其旨在模拟的统计系综基本性质之间的联系 。通过推导动能的期望方差以及恒温器本身的特征频率，你将掌握评估恒温器性能和理解其参数物理意义的核心理论基础。",
            "id": "3788475",
            "problem": "考虑一个具有 $f$ 个独立二次型自由度的经典系统，该系统与温度为 $T$ 的 Nosé–Hoover 恒温器接触。令 $K$ 表示瞬时动能。假设在平衡态时实现了正则采样。从正则系综和麦克斯韦-玻尔兹曼分布的第一性原理出发，推导方差 $\\mathrm{Var}(K)$ 关于 $f$、玻尔兹曼常数 $k_{B}$ 和 $T$ 的闭合形式表达式。接下来，考虑一个系统的标准 Nosé–Hoover 運動方程，该系统具有坐标 $q_{i}$、动量 $p_{i}$、质量 $m_{i}$、力 $F_{i}$，以及恒温器摩擦变量 $\\xi$ 和恒温器质量参数 $Q$：\n$$\n\\dot{q}_{i}=\\frac{p_{i}}{m_{i}},\\qquad\n\\dot{p}_{i}=F_{i}-\\xi\\,p_{i},\\qquad\n\\dot{\\xi}=\\frac{1}{Q}\\left(2K-f\\,k_{B}T\\right).\n$$\n将这些方程在热平衡点（其中 $K=\\langle K\\rangle$ 且 $\\xi=0$）附近进行线性化，以获得控制系统与恒温器之间动能小振幅交换的特征角频率 $\\omega_{Q}$。将可逆维里项 $\\sum_{i} v_{i}F_{i}$ 视为快速涨落项，在恒温器的时间尺度上其平均值为零，因此 $K$ 与 $\\xi$ 的主导阶耦合主导了慢包络动力学。用 $f$、$k_{B}$、$T$ 和 $Q$ 表示 $\\omega_{Q}$。简要解释 $Q$ 如何通过设定交换时间尺度，在多尺度意义上过滤动能涨落。\n\n将您的最终答案表示为一个二元行矩阵 $\\big[\\mathrm{Var}(K),\\ \\omega_{Q}\\big]$。报告 $\\mathrm{Var}(K)$ 的单位为能量平方，$\\omega_{Q}$ 的单位为弧度每单位时间。方框内的答案不应包含单位。无需进行数值代入；仅提供精确的符号表达式。",
            "solution": "该问题包含两个部分。首先，我们推导正则系综中系统的动能方差 $\\mathrm{Var}(K)$。其次，我们线性化 Nosé-Hoover 运动方程，以求出能量交换的特征频率 $\\omega_{Q}$。\n\n第一部分：动能方差 $\\mathrm{Var}(K)$ 的推导\n\n我们从正则系综的原理开始。对于一个具有 $f$ 个独立二次型自由度的经典系统，其总动能由 $K = \\sum_{j=1}^{f} \\epsilon_j$ 给出，其中每个 $\\epsilon_j$ 是与一个自由度相关联的动能（例如 $\\frac{p_x^2}{2m}$）。\n\n在温度为 $T$ 的正则系综中，单个自由度的动量概率分布由麦克斯韦-玻尔兹曼分布给出，这是一个高斯分布。该自由度对应的动能 $\\epsilon$ 的概率分布可以从动量分布导出。该分布是一个伽马分布 $\\Gamma(k, \\theta)$，其形状参数为 $k = 1/2$，尺度参数为 $\\theta = k_B T$。$\\epsilon$ 的概率密度函数为：\n$$\nP(\\epsilon) = \\frac{1}{\\Gamma(1/2)(k_B T)^{1/2}} \\epsilon^{1/2 - 1} \\exp\\left(-\\frac{\\epsilon}{k_B T}\\right)\n$$\n其中 $\\Gamma(1/2) = \\sqrt{\\pi}$。\n\n总动能 $K$是 $f$ 个这样的独立同分布随机变量之和。伽马分布的一个关键性质是，具有相同尺度参数 $\\theta$ 的独立伽马分布变量之和，其本身也服从伽马分布。新的形状参数是个体形状参数之和。因此，$K$ 服从一个伽马分布，其形状参数为 $k_K = \\sum_{j=1}^{f} (1/2) = f/2$，尺度参数为 $\\theta_K = k_B T$。$K$ 的概率密度函数为：\n$$\nP(K) = \\frac{1}{\\Gamma(f/2)(k_B T)^{f/2}} K^{f/2 - 1} \\exp\\left(-\\frac{K}{k_B T}\\right)\n$$\n对于伽马分布 $\\Gamma(k, \\theta)$，其均值为 $\\langle X \\rangle = k\\theta$，方差为 $\\mathrm{Var}(X) = k\\theta^2$。将此应用于 $K$ 的分布，我们求得平均动能为：\n$$\n\\langle K \\rangle = k_K \\theta_K = \\left(\\frac{f}{2}\\right)(k_B T) = \\frac{f}{2}k_B T\n$$\n这个结果就是著名的能量均分定理。动能的方差为：\n$$\n\\mathrm{Var}(K) = k_K \\theta_K^2 = \\left(\\frac{f}{2}\\right)(k_B T)^2 = \\frac{f}{2}k_B^2 T^2\n$$\n该表达式给出了用自由度数 $f$、玻尔兹曼常数 $k_B$ 和温度 $T$ 表示的动能方差。\n\n第二部分：特征频率 $\\omega_{Q}$ 的推导\n\n我们已知标准的 Nosé-Hoover 运动方程：\n$$\n\\dot{q}_{i}=\\frac{p_{i}}{m_{i}}, \\qquad \\dot{p}_{i}=F_{i}-\\xi p_{i}, \\qquad \\dot{\\xi}=\\frac{1}{Q}\\left(2K-f k_{B}T\\right)\n$$\n我们需要找出动能 $K = \\sum_{i} \\frac{p_{i}^2}{2m_{i}}$ 的运动方程。对 $K$ 求时间导数：\n$$\n\\dot{K} = \\sum_{i} \\frac{p_{i}}{m_{i}} \\dot{p}_{i} = \\sum_{i} v_{i} \\dot{p}_{i}\n$$\n代入 $\\dot{p}_{i}$ 的表达式：\n$$\n\\dot{K} = \\sum_{i} v_{i} (F_{i} - \\xi p_{i}) = \\sum_{i} v_{i}F_{i} - \\xi \\sum_{i} v_{i}p_{i}\n$$\n注意到 $v_{i} = p_{i}/m_{i}$，第二项变为 $\\xi \\sum_{i} p_{i}^2/m_{i} = 2\\xi \\sum_{i} p_{i}^2/(2m_{i}) = 2\\xi K$。因此，$K$ 和 $\\xi$ 的动力学由以下耦合系统描述：\n$$\n\\dot{K} = \\sum_{i} v_{i}F_{i} - 2\\xi K\n$$\n$$\n\\dot{\\xi} = \\frac{1}{Q}(2K - f k_B T)\n$$\n我们围绕热平衡不动点（其特征为 $\\langle \\xi \\rangle = 0$ 和 $\\langle K \\rangle = \\frac{f}{2}k_B T$）对此系统进行线性化。令该点附近的涨落为 $\\delta\\xi = \\xi - \\langle \\xi \\rangle = \\xi$ 和 $\\delta K = K - \\langle K \\rangle$。\n涨落的方程为：\n$$\n\\dot{(\\delta K)} = \\dot{K} = \\sum_{i} v_{i}F_{i} - 2(\\delta\\xi)(\\delta K + \\langle K \\rangle)\n$$\n$$\n\\dot{(\\delta\\xi)} = \\dot{\\xi} = \\frac{1}{Q}(2(\\delta K + \\langle K \\rangle) - f k_B T) = \\frac{1}{Q}(2\\delta K + 2\\langle K \\rangle - f k_B T)\n$$\n将 $\\langle K \\rangle = \\frac{f}{2}k_B T$ 代入第二个方程，可简化为：\n$$\n\\dot{(\\delta\\xi)} = \\frac{1}{Q}(2\\delta K + f k_B T - f k_B T) = \\frac{2}{Q}\\delta K\n$$\n这是第一个线性化方程。对于 $\\dot{(\\delta K)}$ 方程，我们通过忽略涨落中的二阶项（即 $-2(\\delta\\xi)(\\delta K)$ 项）来进行线性化。题目还指出，将可逆维里项 $\\sum_{i} v_{i}F_{i}$ 视为一个快速涨落项，在分析恒温器的慢动力学时可以忽略。这得到：\n$$\n\\dot{(\\delta K)} \\approx -2\\langle K \\rangle \\delta\\xi\n$$\n代入 $\\langle K \\rangle$ 的值：\n$$\n\\dot{(\\delta K)} = -2\\left(\\frac{f}{2}k_B T\\right)\\delta\\xi = -f k_B T \\delta\\xi\n$$\n我们现在有一个由两个耦合的线性常微分方程组成的系统：\n$$\n(1) \\qquad \\dot{(\\delta K)} = -f k_B T \\delta\\xi\n$$\n$$\n(2) \\qquad \\dot{(\\delta \\xi)} = \\frac{2}{Q} \\delta K\n$$\n为了求出特征频率，我们将它们合并成一个二阶方程。将方程 (2) 对时间求导得到：\n$$\n\\ddot{(\\delta \\xi)} = \\frac{2}{Q} \\dot{(\\delta K)}\n$$\n将方程 (1) 代入此表达式：\n$$\n\\ddot{(\\delta \\xi)} = \\frac{2}{Q}(-f k_B T \\delta\\xi) = -\\left(\\frac{2f k_B T}{Q}\\right)\\delta\\xi\n$$\n这是简谐振子方程的标准形式 $\\ddot{x} = -\\omega^2 x$。通过比较，特征角频率的平方为：\n$$\n\\omega_{Q}^2 = \\frac{2f k_B T}{Q}\n$$\n因此，特征角频率为：\n$$\n\\omega_{Q} = \\sqrt{\\frac{2f k_B T}{Q}}\n$$\n参数 $Q$（常被称为恒温器“质量”）控制着能量交换的时间尺度。较大的 $Q$ 值会导致较小的 $\\omega_{Q}$ 和较长的振荡周期，这意味着系统与恒温器之间的能量交换很慢。恒温器是“重的”，不会紧密跟随系统动能的快速涨落。相反地，较小的 $Q$ 值会导致较大的 $\\omega_{Q}$ 和快速的响应，从而将系统与恒温器紧密耦合。在多尺度模拟中，选择 $Q$ 值是为了设定恒温器的响应时间尺度 $\\tau_Q \\sim 1/\\omega_Q$，使其慢于系统中最快的物理运动，但快于所研究现象的时间尺度，从而在所需频率上有效地过滤动能涨落。\n\n将两部分结果合并成所要求的矩阵形式，即可得到最终答案。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{f}{2}k_{B}^{2}T^{2} & \\sqrt{\\frac{2f k_{B} T}{Q}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在实际的分子动力学模拟中，合理设定恒温器参数是确保模拟结果物理真实性的关键一步。本练习将理论付诸实践，指导你如何将一个具体的物理需求——期望的能量弛豫时间——转化为恒温器质量参数 $Q$ 的确定值 。掌握这种参数化方法对于有效调节系统温度，同时避免引入非物理的人为振荡至关重要。",
            "id": "3827427",
            "problem": "在一个并行多尺度材料模拟中，一个三维单原子材料的分子动力学子区域与一个连续介质模型弱耦合。该分子区域由一个单变量Nosé–Hoover温控器进行恒温控制，以维持目标温度，同时允许适当的正则涨落。考虑一个由$N$个相同原子组成的子系统，其位置为$\\{\\mathbf{r}_i\\}$，动量为$\\{\\mathbf{p}_i\\}$，质量为$m$，且质心总动量约束为零。Nosé–Hoover温控器的运动方程为\n$$\n\\dot{\\mathbf{r}}_i = \\frac{\\mathbf{p}_i}{m}, \\quad\n\\dot{\\mathbf{p}}_i = \\mathbf{F}_i - \\xi \\,\\mathbf{p}_i, \\quad\n\\dot{\\xi} = \\frac{2K - g k_B T}{Q},\n$$\n其中$K = \\sum_{i=1}^{N} \\frac{\\mathbf{p}_i^2}{2m}$是瞬时动能，$g$是有效恒温的二次自由度数目，$k_B$是玻尔兹曼常数，$T$是目标温度，$Q$是温控器质量参数。对于一个质心动量受约束的三维系统，取$g = 3N - 3$。\n\n假设您有兴趣选择$Q$以获得动能涨落的期望特征弛豫时间。将特征弛豫时间$\\tau$定义为$\\xi$和$K$围绕其平衡值的小振荡的线性化角频率的倒数。\n\n仅从(i)牛顿第二定律，(ii)上述运动方程，以及(iii)二次自由度的能量均分定理出发，围绕正则平衡点对动力学进行线性化，并推导出一个用$g$、$k_B$、$T$和$\\tau$表示的$Q$的解析表达式。在你的推导中，请论证在提取特征频率时，为何在温控器的时间尺度上，将瞬时功率$\\sum_i \\mathbf{v}_i \\cdot \\mathbf{F}_i$处理为一阶可忽略的量是合理的。\n\n然后对你的表达式进行数值计算，使用$N = 100$，$T = 300\\,\\mathrm{K}$，和$\\tau = 0.1\\,\\mathrm{ps}$，并取$k_B = 1.380\\,649 \\times 10^{-23}\\,\\mathrm{J/K}$。将$Q$的最终值以焦耳-秒平方（J·s$^2$）为单位表示，并将你的数值答案四舍五入到四位有效数字。",
            "solution": "本题要求推导Nosé-Hoover温控器质量参数$Q$的表达式并进行数值计算。推导首先要建立系统动能$K$和温控器变量$\\xi$的运动方程。\n\n系统的瞬时动能定义为$K = \\sum_{i=1}^{N} \\frac{\\mathbf{p}_i^2}{2m}$。我们通过微分求其随时间的演化：\n$$\n\\dot{K} = \\frac{dK}{dt} = \\sum_{i=1}^{N} \\frac{d}{dt} \\left( \\frac{\\mathbf{p}_i \\cdot \\mathbf{p}_i}{2m} \\right) = \\sum_{i=1}^{N} \\frac{2 \\mathbf{p}_i \\cdot \\dot{\\mathbf{p}}_i}{2m} = \\sum_{i=1}^{N} \\frac{\\mathbf{p}_i}{m} \\cdot \\dot{\\mathbf{p}}_i = \\sum_{i=1}^{N} \\mathbf{v}_i \\cdot \\dot{\\mathbf{p}}_i\n$$\n代入动量的运动方程$\\dot{\\mathbf{p}}_i = \\mathbf{F}_i - \\xi \\mathbf{p}_i$，我们得到：\n$$\n\\dot{K} = \\sum_{i=1}^{N} \\mathbf{v}_i \\cdot (\\mathbf{F}_i - \\xi \\mathbf{p}_i) = \\sum_{i=1}^{N} \\mathbf{v}_i \\cdot \\mathbf{F}_i - \\xi \\sum_{i=1}^{N} \\mathbf{v}_i \\cdot \\mathbf{p}_i\n$$\n由于$\\mathbf{p}_i = m\\mathbf{v}_i$，第二项变为$\\xi \\sum_{i=1}^{N} m \\mathbf{v}_i^2 = \\xi \\sum_{i=1}^{N} 2 \\left(\\frac{m\\mathbf{v}_i^2}{2}\\right) = 2\\xi \\sum_{i=1}^{N} \\frac{\\mathbf{p}_i^2}{2m} = 2\\xi K$。\n因此，$K$和$\\xi$的耦合运动方程为：\n$$\n\\dot{K} = \\sum_{i=1}^{N} \\mathbf{v}_i \\cdot \\mathbf{F}_i - 2\\xi K\n$$\n$$\n\\dot{\\xi} = \\frac{2K - g k_B T}{Q}\n$$\n我们在正则平衡点附近对这些方程进行线性化。在平衡状态下，系统在统计意义上是稳态的。根据能量均分定理，平均动能为$\\langle K \\rangle = K_0 = \\frac{g}{2} k_B T$。为了使温控器维持此平衡，温控器变量的平均值必须为零，即$\\langle \\xi \\rangle = \\xi_0 = 0$。\n\n我们考虑围绕此平衡点的小涨落：\n$$\nK(t) = K_0 + \\delta K(t)\n$$\n$$\n\\xi(t) = \\xi_0 + \\delta \\xi(t) = \\delta \\xi(t)\n$$\n将这些代入$\\dot{\\xi}$的方程：\n$$\n\\dot{\\delta \\xi} = \\frac{2(K_0 + \\delta K) - g k_B T}{Q} = \\frac{2K_0 - g k_B T + 2\\delta K}{Q}\n$$\n由于$2K_0 = 2(\\frac{g}{2} k_B T) = g k_B T$，方程简化为：\n$$\n\\dot{\\delta \\xi} = \\frac{2\\delta K}{Q}\n$$\n此方程已经是关于涨落变量的线性方程。\n\n接下来，我们对$\\dot{K}$的方程进行线性化。对$K(t) = K_0 + \\delta K(t)$求时间导数得到$\\dot{K} = \\dot{\\delta K}$，因为$K_0$是常数。\n$$\n\\dot{\\delta K} = \\sum_{i=1}^{N} \\mathbf{v}_i \\cdot \\mathbf{F}_i - 2(\\delta \\xi)(K_0 + \\delta K)\n$$\n为了线性化，我们只保留小量$\\delta K$和$\\delta \\xi$的一阶项。项$2(\\delta \\xi)(\\delta K)$是二阶的，因此被忽略。\n$$\n\\dot{\\delta K} \\approx \\sum_{i=1}^{N} \\mathbf{v}_i \\cdot \\mathbf{F}_i - 2K_0 \\delta \\xi\n$$\n项$P_F = \\sum_i \\mathbf{v}_i \\cdot \\mathbf{F}_i$是内力所做的瞬时功率。这个量在原子振动的特征时间尺度（飞秒）上非常迅速地涨落。而温控器被设计用于在更长的特征时间尺度$\\tau$上运行。我们感兴趣的是耦合的$K$-$\\xi$系统的缓慢集体振荡，这决定了该时间尺度。在分析这些慢动力学时，我们可以对快速的微观涨落进行平均。项$P_F$在平衡点附近以零为均值涨落，并且与慢变量$\\delta K$和$\\delta \\xi$基本不相关。因此，在慢动力学的一阶近似中，这个快速涨落的项充当噪声源，在确定系统响应的确定性部分的特征频率时可以忽略不计。因此，$\\delta K$的线性化方程变为：\n$$\n\\dot{\\delta K} \\approx -2K_0 \\delta \\xi\n$$\n我们现在得到一个由两个耦合的线性常微分方程组成的系统：\n1. $\\dot{\\delta K} = -2K_0 \\delta \\xi$\n2. $\\dot{\\delta \\xi} = \\frac{2}{Q} \\delta K$\n\n为求解该方程组，我们可以将方程(1)对时间求导：\n$$\n\\ddot{\\delta K} = -2K_0 \\dot{\\delta \\xi}\n$$\n现在将方程(2)代入此表达式：\n$$\n\\ddot{\\delta K} = -2K_0 \\left(\\frac{2}{Q} \\delta K\\right) = -\\frac{4K_0}{Q} \\delta K\n$$\n这是一个简谐振子方程，$\\ddot{x} = -\\omega^2 x$，其中$x$对应于$\\delta K$，角频率的平方$\\omega^2$为：\n$$\n\\omega^2 = \\frac{4K_0}{Q}\n$$\n题目将特征弛豫时间$\\tau$定义为此角频率的倒数，即$\\tau = \\frac{1}{\\omega}$。因此，$\\omega^2 = \\frac{1}{\\tau^2}$。\n$$\n\\frac{1}{\\tau^2} = \\frac{4K_0}{Q}\n$$\n求解$Q$并代入$K_0 = \\frac{g}{2} k_B T$：\n$$\nQ = 4K_0 \\tau^2 = 4\\left(\\frac{g}{2} k_B T\\right)\\tau^2 = 2g k_B T \\tau^2\n$$\n这就是所求的$Q$的解析表达式。\n\n对于数值计算，我们有以下给定值：\n- 原子数 $N = 100$\n- 目标温度 $T = 300\\,\\mathrm{K}$\n- 弛豫时间 $\\tau = 0.1\\,\\mathrm{ps} = 0.1 \\times 10^{-12}\\,\\mathrm{s} = 10^{-13}\\,\\mathrm{s}$\n- 玻尔兹曼常数 $k_B = 1.380\\,649 \\times 10^{-23}\\,\\mathrm{J/K}$\n\n首先，我们计算自由度$g$：\n$$\ng = 3N - 3 = 3(100) - 3 = 297\n$$\n现在，将这些数值代入$Q$的表达式中：\n$$\nQ = 2 \\cdot (297) \\cdot (1.380\\,649 \\times 10^{-23}\\,\\mathrm{J/K}) \\cdot (300\\,\\mathrm{K}) \\cdot (10^{-13}\\,\\mathrm{s})^2\n$$\n$$\nQ = (2 \\cdot 297 \\cdot 300) \\cdot (1.380\\,649 \\times 10^{-23}) \\cdot (10^{-26})\\,\\mathrm{J \\cdot s^2}\n$$\n$$\nQ = (178\\,200) \\cdot (1.380\\,649 \\times 10^{-49})\\,\\mathrm{J \\cdot s^2}\n$$\n$$\nQ = (1.782 \\times 10^5) \\cdot (1.380\\,649 \\times 10^{-49})\\,\\mathrm{J \\cdot s^2}\n$$\n$$\nQ = (1.782 \\cdot 1.380\\,649) \\times 10^{5-49}\\,\\mathrm{J \\cdot s^2}\n$$\n$$\nQ = 2.460\\,316518 \\times 10^{-44}\\,\\mathrm{J \\cdot s^2}\n$$\n四舍五入到四位有效数字，我们得到：\n$$\nQ \\approx 2.460 \\times 10^{-44}\\,\\mathrm{J \\cdot s^2}\n$$",
            "answer": "$$\\boxed{2.460 \\times 10^{-44}}$$"
        },
        {
            "introduction": "理论上的运动方程必须通过稳定且精确的数值算法才能在计算机上求解。这项高级练习深入探讨了分子动力学模拟的数值核心，展示了如何使用算符分裂方法为 Nosé-Hoover 动力学构建一个时间可逆且二阶精确的积分器 。理解这一过程将揭示模拟中连续的动力学是如何被离散化并可靠地在时间上推进的。",
            "id": "3788516",
            "problem": "考虑一个包含 $N$ 个粒子的系统，其位置为 $\\mathbf{r}_i$，动量为 $\\mathbf{p}_i$，质量为 $m_i$，以及一个光滑、不随时间变化的势能 $U(\\mathbf{r}_1,\\dots,\\mathbf{r}_N)$。力为 $\\mathbf{F}_i(\\mathbf{r}) = -\\nabla_{\\mathbf{r}_i} U(\\mathbf{r})$。该系统与一个 Nosé-Hoover 恒温器耦合，其变量为 $\\eta$ 和 $\\xi$，恒温器质量为 $Q$，目标温度为 $T$。令 $g$ 表示动能自由度数，$k_B$ 表示玻尔兹曼常数。其扩展相空间动力学由以下方程组给出：\n$$\n\\frac{d \\mathbf{r}_i}{dt} = \\frac{\\mathbf{p}_i}{m_i}, \\quad\n\\frac{d \\mathbf{p}_i}{dt} = \\mathbf{F}_i(\\mathbf{r}) - \\xi \\mathbf{p}_i, \\quad\n\\frac{d \\eta}{dt} = \\xi, \\quad\n\\frac{d \\xi}{dt} = \\frac{1}{Q}\\left( \\sum_{i=1}^{N} \\frac{\\mathbf{p}_i \\cdot \\mathbf{p}_i}{m_i} - g k_B T \\right).\n$$\n令 $\\mathcal{L}$ 为刘维尔算符，该算符在可观测量 $A(\\{\\mathbf{r}_i\\},\\{\\mathbf{p}_i\\},\\eta,\\xi)$ 上生成此流动，由应用于上述方程的链式法则定义。在分子动力学（MD）中，二阶精确且可逆的积分器通常通过将 $\\mathcal{L}$ 对称 Trotter (Strang) 分裂为子算符来构建，这些子算符的流动可以被精确积分。\n\n从第一性原理出发，并基于上述动力学系统：\n- 将 $\\mathcal{L}$ 分解为 $\\mathcal{L} = \\mathcal{L}_A + \\mathcal{L}_B + \\mathcal{L}_C$，使其成为分别与位置漂移、保守力引起的“踢动”以及恒温器耦合相关联的、具有物理意义的子算符。\n- 将 $\\mathcal{L}_C$ 进一步分解为两个可精确求解的子算符 $\\mathcal{L}_{C1}$ 和 $\\mathcal{L}_{C2}$，它们分别隔离出由 $\\xi$ 引起的动量的乘法缩放，以及在动量保持不变的情况下 $(\\eta,\\xi)$ 的演化。\n- 使用对称 Trotter (Strang) 组合定理，推导一个在一个时间步长 $\\Delta t$ 内的可逆、二阶精确的传播子，其形式为子算符指数的有序乘积。然后，明确写出在一个时间步长 $\\Delta t$ 内对 $(\\mathbf{r}_i,\\mathbf{p}_i,\\eta,\\xi)$ 进行更新的相应序列，确保每个子流动都被精确积分。\n\n在你的最终答案中，提供对称 Trotter 传播子的单一闭式解析表达式，以子算符的 $\\exp(\\cdot)$ 形式表示。不需要进行数值计算；你的最终答案必须仅为解析表达式。",
            "solution": "该问题经验证具有科学依据、提法恰当且客观。它描述了计算统计物理学中的一项标准且重要的任务：为 Nosé-Hoover 恒温器动力学推导一个可逆的数值积分器。所提供的运动方程是正确的，并且所要求的分解以及 Trotter-Strang 分裂的应用是实现这一目标的典型方法。\n\n任何可观测量 $A(\\{\\mathbf{r}_i\\},\\{\\mathbf{p}_i\\},\\eta,\\xi)$ 的演化都由刘维尔方程 $\\frac{dA}{dt} = \\mathcal{L}A$ 所支配，其中 $\\mathcal{L}$ 是刘维尔算符。应用链式法则并代入给定的运动方程，我们得到：\n$$\n\\frac{dA}{dt} = \\sum_{i=1}^{N} \\left( \\nabla_{\\mathbf{r}_i} A \\cdot \\frac{d\\mathbf{r}_i}{dt} + \\nabla_{\\mathbf{p}_i} A \\cdot \\frac{d\\mathbf{p}_i}{dt} \\right) + \\frac{\\partial A}{\\partial \\eta} \\frac{d\\eta}{dt} + \\frac{\\partial A}{\\partial \\xi} \\frac{d\\xi}{dt}\n$$\n$$\n\\frac{dA}{dt} = \\sum_{i=1}^{N} \\left( \\nabla_{\\mathbf{r}_i} A \\cdot \\frac{\\mathbf{p}_i}{m_i} + \\nabla_{\\mathbf{p}_i} A \\cdot (\\mathbf{F}_i(\\mathbf{r}) - \\xi \\mathbf{p}_i) \\right) + \\frac{\\partial A}{\\partial \\eta} \\xi + \\frac{\\partial A}{\\partial \\xi} \\frac{1}{Q}\\left( \\sum_{j=1}^{N} \\frac{\\mathbf{p}_j \\cdot \\mathbf{p}_j}{m_j} - g k_B T \\right)\n$$\n由此，我们可以确定刘维尔算符 $\\mathcal{L}$ 为：\n$$\n\\mathcal{L} = \\sum_{i=1}^{N} \\frac{\\mathbf{p}_i}{m_i} \\cdot \\nabla_{\\mathbf{r}_i} + \\sum_{i=1}^{N} \\mathbf{F}_i(\\mathbf{r}) \\cdot \\nabla_{\\mathbf{p}_i} - \\sum_{i=1}^{N} \\xi \\mathbf{p}_i \\cdot \\nabla_{\\mathbf{p}_i} + \\xi \\frac{\\partial}{\\partial \\eta} + \\frac{1}{Q}\\left( \\sum_{j=1}^{N} \\frac{\\mathbf{p}_j^2}{m_j} - g k_B T \\right) \\frac{\\partial}{\\partial \\xi}\n$$\n在一个时间步长 $\\Delta t$ 内，刘维尔方程的形式解由传播子 $\\exp(\\Delta t \\mathcal{L})$ 的作用给出。由于完整的算符 $\\mathcal{L}$ 很复杂，我们将其分解为更简单的子算符，这些子算符的流动可以解析地计算。\n\n按照问题的要求，我们定义分解 $\\mathcal{L} = \\mathcal{L}_A + \\mathcal{L}_B + \\mathcal{L}_C$：\n-   $\\mathcal{L}_A = \\sum_{i=1}^{N} \\frac{\\mathbf{p}_i}{m_i} \\cdot \\nabla_{\\mathbf{r}_i}$，对应于粒子位置的自由漂移。\n-   $\\mathcal{L}_B = \\sum_{i=1}^{N} \\mathbf{F}_i(\\mathbf{r}) \\cdot \\nabla_{\\mathbf{p}_i}$，对应于由保守力引起的动量更新（一次“踢动”）。\n-   $\\mathcal{L}_C = - \\sum_{i=1}^{N} \\xi \\mathbf{p}_i \\cdot \\nabla_{\\mathbf{p}_i} + \\xi \\frac{\\partial}{\\partial \\eta} + \\frac{1}{Q}\\left( \\sum_{j=1}^{N} \\frac{\\mathbf{p}_j^2}{m_j} - g k_B T \\right) \\frac{\\partial}{\\partial \\xi}$，包含了与恒温器耦合相关的所有项。\n\n接下来，我们将恒温器算符 $\\mathcal{L}_C$ 分解为两部分，$\\mathcal{L}_C = \\mathcal{L}_{C1} + \\mathcal{L}_{C2}$：\n-   $\\mathcal{L}_{C1} = - \\sum_{i=1}^{N} \\xi \\mathbf{p}_i \\cdot \\nabla_{\\mathbf{p}_i}$，对应于恒温器变量 $\\xi$ 对动量的乘法缩放（阻尼/加热）。\n-   $\\mathcal{L}_{C2} = \\xi \\frac{\\partial}{\\partial \\eta} + G(\\mathbf{p}) \\frac{\\partial}{\\partial \\xi}$，其中 $G(\\mathbf{p}) = \\frac{1}{Q}\\left( \\sum_{j=1}^{N} \\frac{\\mathbf{p}_j^2}{m_j} - g k_B T \\right)$，对应于恒温器自身变量 $(\\eta, \\xi)$ 的演化。\n\n子算符 $\\mathcal{L}_A$、$\\mathcal{L}_B$、$\\mathcal{L}_{C1}$ 和 $\\mathcal{L}_{C2}$ 彼此不对易。因此，$\\exp(\\Delta t \\mathcal{L}) \\neq \\exp(\\Delta t \\mathcal{L}_A) \\exp(\\Delta t \\mathcal{L}_B) \\exp(\\Delta t \\mathcal{L}_{C1}) \\exp(\\Delta t \\mathcal{L}_{C2})$。为了构建一个二阶精确且可逆的积分器，我们采用对称 Trotter（或 Strang）分裂定理，该定理指出，对于算符 $\\mathcal{X}$ 和 $\\mathcal{Y}$，$\\exp(\\tau (\\mathcal{X}+\\mathcal{Y})) = \\exp(\\frac{\\tau}{2}\\mathcal{X}) \\exp(\\tau \\mathcal{Y}) \\exp(\\frac{\\tau}{2}\\mathcal{X}) + \\mathcal{O}(\\tau^3)$。\n\n我们递归地应用此定理。首先，我们分裂完整的刘维尔算符 $\\mathcal{L} = (\\mathcal{L}_A + \\mathcal{L}_B) + \\mathcal{L}_C$。一种常见的对称排列方式，类似于速度 Verlet 算法，是将力/恒温器的更新置于两个位置半步之间。这表明一个形如 $\\mathcal{L} = \\mathcal{L}_A + (\\mathcal{L}_B + \\mathcal{L}_C)$ 的主要分裂。应用 Strang 分裂得到：\n$$\n\\exp(\\Delta t \\mathcal{L}) \\approx \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_A\\right) \\exp\\left(\\Delta t (\\mathcal{L}_B + \\mathcal{L}_C)\\right) \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_A\\right)\n$$\n我们进一步分裂中心项 $\\exp(\\Delta t (\\mathcal{L}_B + \\mathcal{L}_C))$。一个对称分裂将恒温器部分与保守力部分分开：\n$$\n\\exp\\left(\\Delta t (\\mathcal{L}_B + \\mathcal{L}_C)\\right) \\approx \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_B\\right) \\exp(\\Delta t \\mathcal{L}_C) \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_B\\right)\n$$\n最后，我们按照要求分裂恒温器算符 $\\mathcal{L}_C = \\mathcal{L}_{C1} + \\mathcal{L}_{C2}$：\n$$\n\\exp(\\Delta t \\mathcal{L}_C) \\approx \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_{C1}\\right) \\exp(\\Delta t \\mathcal{L}_{C2}) \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_{C1}\\right)\n$$\n结合这些结果，得到二阶精确、可逆传播子的最终表达式：\n$$\n\\exp(\\Delta t \\mathcal{L}) \\approx \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_A\\right) \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_B\\right) \\left[ \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_{C1}\\right) \\exp(\\Delta t \\mathcal{L}_{C2}) \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_{C1}\\right) \\right] \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_B\\right) \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_A\\right)\n$$\n通过从右到左应用这些算符，可以获得在一个时间步长 $\\Delta t$ 内对相空间坐标的更新序列。设时间 $t$ 的状态为 $(\\{\\mathbf{r}_i(t)\\}, \\{\\mathbf{p}_i(t)\\}, \\eta(t), \\xi(t))$。每个子流动按如下方式精确积分：\n\n1.  **应用 $\\exp(\\frac{\\Delta t}{2} \\mathcal{L}_A)$**：这将在 $d\\mathbf{r}_i/dt' = \\mathbf{p}_i/m_i$ 的作用下演化系统，持续时间为 $\\Delta t/2$。\n    $\\mathbf{r}_i \\leftarrow \\mathbf{r}_i(t) + \\frac{\\mathbf{p}_i(t)}{m_i} \\frac{\\Delta t}{2}$。\n\n2.  **应用 $\\exp(\\frac{\\Delta t}{2} \\mathcal{L}_B)$**：这将在 $d\\mathbf{p}_i/dt' = \\mathbf{F}_i(\\mathbf{r})$ 的作用下演化动量，持续时间为 $\\Delta t/2$。\n    首先，在新的位置上计算力 $\\mathbf{F}_i$。\n    $\\mathbf{p}_i \\leftarrow \\mathbf{p}_i(t) + \\mathbf{F}_i \\frac{\\Delta t}{2}$。\n\n3.  **应用 $\\exp(\\frac{\\Delta t}{2} \\mathcal{L}_{C1})$**：这将在 $d\\mathbf{p}_i/dt' = -\\xi \\mathbf{p}_i$ 的作用下演化动量，持续时间为 $\\Delta t/2$。其精确解是一个指数缩放。\n    $\\mathbf{p}_i \\leftarrow \\mathbf{p}_i \\exp\\left(-\\xi(t) \\frac{\\Delta t}{2}\\right)$。\n\n4.  **应用 $\\exp(\\Delta t \\mathcal{L}_{C2})$**：这将演化恒温器变量 $(\\eta, \\xi)$，持续一个完整的时间步长 $\\Delta t$，期间粒子动量保持恒定。方程为 $d\\eta/dt' = \\xi$ 和 $d\\xi/dt' = G(\\mathbf{p})$，其中 $G(\\mathbf{p})$ 在此子步骤中为常数。\n    首先，使用当前动量计算恒温器的“力”：$G = \\frac{1}{Q}\\left( \\sum_{j=1}^{N} \\frac{\\mathbf{p}_j \\cdot \\mathbf{p}_j}{m_j} - g k_B T \\right)$。\n    存储当前值 $\\xi_{old} = \\xi$。\n    更新 $\\xi$：$\\xi \\leftarrow \\xi_{old} + G \\Delta t$。令其为 $\\xi_{new}$。\n    更新 $\\eta$：$\\eta \\leftarrow \\eta(t) + \\frac{1}{2}(\\xi_{old} + \\xi_{new}) \\Delta t = \\eta(t) + \\xi_{old} \\Delta t + \\frac{1}{2} G (\\Delta t)^2$。\n\n5.  **应用 $\\exp(\\frac{\\Delta t}{2} \\mathcal{L}_{C1})$**：这是动量缩放的第二个半步，现在使用更新后的 $\\xi$ 值。\n    $\\mathbf{p}_i \\leftarrow \\mathbf{p}_i \\exp\\left(-\\xi \\frac{\\Delta t}{2}\\right)$。\n\n6.  **应用 $\\exp(\\frac{\\Delta t}{2} \\mathcal{L}_B)$**：这是力“踢动”的第二个半步。由于位置此后未变，力 $\\mathbf{F}_i$ 与步骤2中相同。\n    $\\mathbf{p}_i \\leftarrow \\mathbf{p}_i + \\mathbf{F}_i \\frac{\\Delta t}{2}$。\n\n7.  **应用 $\\exp(\\frac{\\Delta t}{2} \\mathcal{L}_A)$**：这是位置漂移的最后半步，使用完全更新后的动量。\n    $\\mathbf{r}_i \\leftarrow \\mathbf{r}_i + \\frac{\\mathbf{p}_i}{m_i} \\frac{\\Delta t}{2}$。\n\n该序列完成了一个时间步长 $\\Delta t$ 的更新。所得状态 $(\\{\\mathbf{r}_i(t+\\Delta t)\\}, \\{\\mathbf{p}_i(t+\\Delta t)\\}, \\eta(t+\\Delta t), \\xi(t+\\Delta t))$ 是真实动力学的一个二阶精确近似，并且该积分器由于其对称构造而是时间可逆的。\n最终答案是此传播子的符号表示。",
            "answer": "$$\n\\boxed{\\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_A\\right) \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_B\\right) \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_{C1}\\right) \\exp(\\Delta t \\mathcal{L}_{C2}) \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_{C1}\\right) \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_B\\right) \\exp\\left(\\frac{\\Delta t}{2} \\mathcal{L}_A\\right)}\n$$"
        }
    ]
}