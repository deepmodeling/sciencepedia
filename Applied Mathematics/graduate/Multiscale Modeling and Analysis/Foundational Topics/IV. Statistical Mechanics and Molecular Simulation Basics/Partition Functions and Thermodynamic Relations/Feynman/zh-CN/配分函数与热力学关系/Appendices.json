{
    "hands_on_practices": [
        {
            "introduction": "这项基础练习旨在建立理论的基石。我们将从一个具有离散能级的量子力学系统出发，明确构建其正则配分函数 $Z(\\beta)$。此过程将揭示配分函数与系统能谱及其态简并度之间的深刻联系，阐明配分函数如何通过对玻尔兹曼加权的微观态求和，成为推导热力学性质的生成函数。",
            "id": "3792672",
            "problem": "考虑一个有限量子系统，其哈密顿量 $\\hat{H}$ 作用于一个有限维希尔伯特空间上。$\\hat{H}$ 的谱由一组有限的分立能量值 $\\{E_i\\}_{i=1}^{M}$ 构成，其中每个 $E_i$ 都具有有限的简并度 $g_i \\in \\mathbb{N}$，表示能量为 $E_i$ 的正交归一本征态的数量。令 $\\beta$ 表示正则系综中的逆温度。从多尺度建模的角度来看，可以将固定能量下的微观态集合视为一个细尺度流形，它被粗粒化为一个由 $E_i$ 标记的单一宏观态，微观态的多重性由简并度 $g_i$ 捕捉。\n\n从微正则计数诠释和正则系综定义出发，在不预先假设任何联系态密度与配分函数的公式的情况下，完成以下任务：\n\n- 将微正则态密度 $\\Omega(E)$ 表示为一个广义函数，该函数计算能量为 $E$ 时的微观态数量，用支撑在分立能量 $\\{E_i\\}$ 上的狄拉克δ分布来表示，并明确解释简并度因子 $\\{g_i\\}$ 如何进入此表示。\n\n- 使用正则系综定义，推导正则配分函数 $Z(\\beta)$ 的一个显式表达式，该表达式仅用分立能量集 $\\{E_i\\}$ 及其简по度 $\\{g_i\\}$ 表示，且不含任何积分。\n\n请以一个仅含 $\\{E_i\\}$、$\\{g_i\\}$ 和 $\\beta$ 的单一闭合形式解析表达式提供您的最终答案。不要包含单位。如果引入任何额外记号，请明确定义。最终答案必须是单一表达式。",
            "solution": "该问题要求针对一个在统计力学框架内描述的有限量子系统，进行两项相关的推导。该系统有一组分立的能量本征值 $\\{E_i\\}_{i=1}^{M}$，以及相应的有限简并度 $\\{g_i\\}_{i=1}^{M}$。我们的任务是表示微正则态密度 $\\Omega(E)$ 并推导正则配分函数 $Z(\\beta)$。\n\n首先，我们处理微正则态密度 $\\Omega(E)$ 的表示。函数 $\\Omega(E)$ 量化了能量 $E$ 处单位能量间隔内的微观态数量。对于一个具有分立能谱的量子系统，在允许的能量本征值 $E_i$ 之间不存在可用态。这些态只精确地存在于这些分立的能量值上。特定能量 $E_i$ 处的态数量由其简并度 $g_i$ 给出。\n\n为了在数学上表示这种结构，我们使用狄拉克δ分布 $\\delta(x)$。狄拉克δ是一个广义函数，具有以下性质：对于所有 $x \\neq a$，$\\delta(x-a) = 0$，且其在任何包含 $a$ 的区域上的积分为1，即对于在 $x=a$ 处连续的函数 $f(x)$，有 $\\int f(x) \\delta(x-a) dx = f(a)$。一个加权δ函数 $c \\cdot \\delta(x-a)$ 表示一个位于 $x=a$、大小为 $c$ 的“点质量”。\n\n在我们这里，能量 $E$ 是变量。对于每个允许的能级 $E_i$，都有 $g_i$ 个态的“集中”。我们可以用一个中心在 $E_i$、并由简并度 $g_i$ 加权的狄拉克δ函数来表示这种集中。因此，能级 $E_i$ 对态密度的贡献是 $g_i \\delta(E - E_i)$。因为总态密度是所有可能能级贡献的总和，我们必须对所有分立的能量本征值 $E_i$ 求和。这就给出了微正则态密度作为广义函数之和的表示：\n$$\n\\Omega(E) = \\sum_{i=1}^{M} g_i \\delta(E - E_i)\n$$\n这个表达式正确地体现了谱的分立性质。在任意能量区间 $[E_a, E_b]$ 内的态数 $N(E_a, E_b)$ 由 $\\Omega(E)$ 在该区间上的积分给出。如果区间 $[E_a, E_b]$ 只包含一个能级 $E_k$，那么 $\\int_{E_a}^{E_b} \\Omega(E) dE = \\int_{E_a}^{E_b} \\sum_{i=1}^{M} g_i \\delta(E - E_i) dE = g_k$，这是正确的态数。\n\n接下来，我们推导正则配分函数 $Z(\\beta)$。正则配分函数的定义是对系统的所有可及微观态 $s$ 的玻尔兹曼因子 $\\exp(-\\beta E_s)$ 求和。设所有微观态的集合用 $\\mathcal{S}$ 表示。微观态 $s$ 的能量是 $E_s$。其定义为：\n$$\nZ(\\beta) = \\sum_{s \\in \\mathcal{S}} \\exp(-\\beta E_s)\n$$\n问题指出，该系统有一组有限的分立能量值 $\\{E_i\\}_{i=1}^{M}$，对于每个这样的值 $E_i$，存在 $g_i$ 个正交归一的本征态。这 $g_i$ 个态是具有相同能量 $E_i$ 的微观态。我们可以将所有微观态的集合 $\\mathcal{S}$ 划分为 $M$ 个不相交的子集，其中第 $i$ 个子集 $\\mathcal{S}_i$ 包含所有能量为 $E_i$ 的微观态。集合 $\\mathcal{S}_i$ 的大小就是简并度 $g_i$。\n\n通过这种划分，对所有态的求和可以重写为先对能级求和，再对每个能级内的简并态求和：\n$$\nZ(\\beta) = \\sum_{i=1}^{M} \\sum_{s \\in \\mathcal{S}_i} \\exp(-\\beta E_s)\n$$\n对于子集 $\\mathcal{S}_i$ 中的任何微观态 $s$，其能量 $E_s$ 根据定义等于 $E_i$。因此，玻尔兹曼因子 $\\exp(-\\beta E_s)$ 对于内层求和中的所有态都是常数，等于 $\\exp(-\\beta E_i)$。我们可以将此项从内层求和中提出来：\n$$\nZ(\\beta) = \\sum_{i=1}^{M} \\left( \\exp(-\\beta E_i) \\sum_{s \\in \\mathcal{S}_i} 1 \\right)\n$$\n剩下的内层求和 $\\sum_{s \\in \\mathcal{S}_i} 1$ 只是计算子集 $\\mathcal{S}_i$ 中的态数。这个数量就是能级 $E_i$ 的简并度，即 $g_i$。\n$$\n\\sum_{s \\in \\mathcal{S}_i} 1 = g_i\n$$\n将此结果代回 $Z(\\beta)$ 的表达式，我们得到该系统正则配分函数的最终形式：\n$$\nZ(\\beta) = \\sum_{i=1}^{M} g_i \\exp(-\\beta E_i)\n$$\n该表达式仅用系统能谱的基本性质——分立的能量值 $\\{E_i\\}$ 及其对应的简并度 $\\{g_i\\}$——来表示配分函数。此推导从正则系综的第一性原理出发，并未假定任何先验的积分关系。",
            "answer": "$$\n\\boxed{\\sum_{i=1}^{M} g_i \\exp(-\\beta E_i)}\n$$"
        },
        {
            "introduction": "真实物理系统通常包含大量粒子，使得精确计算几乎不可行。本练习将介绍一种强大的分析工具——拉普拉斯方法，用以对大系统 ($N \\to \\infty$) 的配分函数进行渐近分析。通过比较能量最低点位于区域内部与位于边界的两种情形，我们将量化边界效应对有限尺寸修正的贡献，这是多尺度建模中的一个关键概念。",
            "id": "3792668",
            "problem": "考虑一个尺寸为 $N$ 的大系统的粗粒化单自由度介观模型，其中慢序参量 $x$ 被约束在区间 $x \\in [-1,1]$。每个微观单元的有效自由能为 $u(x)$，在逆温度 $\\beta$（其中 $\\beta = 1/(k_B T)$，$k_B$ 是玻尔兹曼常数，$T$ 是温度）下的正则配分函数定义为\n$$\nZ_N = \\int_{-1}^{1} \\exp\\!\\big(-N \\beta\\, u(x)\\big)\\, dx.\n$$\n假设两个模型在极小值点附近具有相同的局部曲率，但极小值点位置不同：\n(i) 内部鞍点模型 $u_{\\mathrm{int}}(x) = \\frac{a}{2}\\, x^2$，其极小值点位于定义域内部的 $x=0$ 处；\n(ii) 边界鞍点模型 $u_{\\mathrm{bnd}}(x) = \\frac{a}{2}\\, (x-1)^2$，其极小值点位于边界点 $x=1$ 处。\n此处 $a>0$ 和 $\\beta>0$ 是与 $N$ 无关的固定参数。\n\n仅从配分函数的定义和标准微积分（泰勒展开和高斯积分）出发，对两种模型推导 $\\ln Z_N$ 的大 $N$ 渐近行为，直至并包含 $O(1)$ 项。然后，通过计算在相同 $(a,\\beta)$ 条件下，边界鞍点情况和内部鞍点情况的 $\\ln Z_N$ 中 $O(1)$ 项之间的差值 $\\Delta$，来量化由边界鞍点引起的有限尺寸效应，即：\n$$\n\\Delta \\equiv \\Big[\\ln Z_N\\Big]_{\\mathrm{bnd}} - \\Big[\\ln Z_N\\Big]_{\\mathrm{int}}.\n$$\n请以单一的精确闭式表达式给出你的最终答案。无需四舍五入，最终表达式中不应包含任何物理单位。",
            "solution": "该问题要求推导两种不同有效自由能模型的正则配分函数 $Z_N$ 的大 $N$ 渐近行为，然后计算它们对数形式之间的差值。配分函数由下式给出\n$$\nZ_N = \\int_{-1}^{1} \\exp\\!\\big(-N \\beta\\, u(x)\\big)\\, dx\n$$\n其中 $N$ 是一个大参数。这个积分可以使用拉普拉斯方法进行渐近求值。该方法的原理是，对于大的 $N$，积分的值主要由积分定义域内函数 $u(x)$ 达到其全局最小值的点 $x_0$ 附近的贡献所主导。\n\n让我们定义 $f(x) = \\beta u(x)$。积分变为 $Z_N = \\int_{-1}^{1} \\exp(-N f(x)) dx$。\n\n首先，我们分析内部鞍点模型，$u_{\\mathrm{int}}(x) = \\frac{a}{2}\\, x^2$。\n函数 $f_{\\mathrm{int}}(x) = \\frac{a\\beta}{2} x^2$ 在 $x_0=0$ 处有一个全局最小值，这是定义域 $[-1, 1]$ 的一个内点。在这个极小值点上，$f_{\\mathrm{int}}(0) = 0$。我们在 $x_0=0$ 附近对 $f_{\\mathrm{int}}(x)$ 进行泰勒展开。在这种情况下，该函数已经是一个二次型，因此展开到二阶是精确的：\n$$\nf_{\\mathrm{int}}(x) = f_{\\mathrm{int}}(0) + f'_{\\mathrm{int}}(0)(x-0) + \\frac{1}{2}f''_{\\mathrm{int}}(0)(x-0)^2 + \\dots\n$$\n由于 $f'_{\\mathrm{int}}(x) = a\\beta x$ 和 $f''_{\\mathrm{int}}(x) = a\\beta$，我们有 $f'_{\\mathrm{int}}(0)=0$ 和 $f''_{\\mathrm{int}}(0)=a\\beta$。\n该模型的配分函数是：\n$$\nZ_N^{\\mathrm{int}} = \\int_{-1}^{1} \\exp\\left(-N \\frac{a\\beta}{2} x^2\\right) dx\n$$\n对于大的 $N$，被积函数 $\\exp(-N \\frac{a\\beta}{2} x^2)$ 在 $x=0$ 附近形成一个尖峰，并迅速衰减。远离 $x=0$ 的区域，特别是靠近边界 $x=\\pm 1$ 的区域，对积分的贡献可以忽略不计。因此，我们可以将积分限扩展到 $(-\\infty, \\infty)$，其误差随 $N$ 呈指数级减小。\n$$\nZ_N^{\\mathrm{int}} \\approx \\int_{-\\infty}^{\\infty} \\exp\\left(-N \\frac{a\\beta}{2} x^2\\right) dx\n$$\n这是一个形式为 $\\int_{-\\infty}^{\\infty} \\exp(-cx^2) dx = \\sqrt{\\frac{\\pi}{c}}$ 的标准高斯积分。当 $c = N \\frac{a\\beta}{2}$ 时，我们得到：\n$$\nZ_N^{\\mathrm{int}} \\approx \\sqrt{\\frac{\\pi}{N \\frac{a\\beta}{2}}} = \\sqrt{\\frac{2\\pi}{N a\\beta}}\n$$\n配分函数的自然对数则为：\n$$\n\\ln Z_N^{\\mathrm{int}} \\approx \\ln\\left(\\sqrt{\\frac{2\\pi}{N a\\beta}}\\right) = \\frac{1}{2}\\ln\\left(\\frac{2\\pi}{a\\beta}\\right) - \\frac{1}{2}\\ln N\n$$\n这是 $\\ln Z_N^{\\mathrm{int}}$ 的渐近表达式，精确到当 $N \\to \\infty$ 时消失的项。$O(1)$ 项，即此表达式的常数部分，是 $\\frac{1}{2}\\ln\\left(\\frac{2\\pi}{a\\beta}\\right)$。\n\n接下来，我们分析边界鞍点模型，$u_{\\mathrm{bnd}}(x) = \\frac{a}{2}(x-1)^2$。\n函数 $f_{\\mathrm{bnd}}(x) = \\frac{a\\beta}{2}(x-1)^2$ 的全局最小值在 $x_0=1$ 处，这是定义域 $[-1, 1]$ 的一个边界点。在这个极小值点上，$f_{\\mathrm{bnd}}(1) = 0$。二阶导数 $f''_{\\mathrm{bnd}}(x) = a\\beta$ 是一个常数。\n配分函数是：\n$$\nZ_N^{\\mathrm{bnd}} = \\int_{-1}^{1} \\exp\\left(-N \\frac{a\\beta}{2} (x-1)^2\\right) dx\n$$\n为了分析这个积分，我们进行变量替换 $y = x-1$，这意味着 $dx=dy$。$y$ 的积分区间变为 $[-2, 0]$：\n$$\nZ_N^{\\mathrm{bnd}} = \\int_{-2}^{0} \\exp\\left(-N \\frac{a\\beta}{2} y^2\\right) dy\n$$\n与前一种情况类似，对于大的 $N$，被积函数在 $y=0$ 的最大值附近呈尖峰状。来自下限 $y=-2$ 的贡献是指数级小的。因此，我们可以将积分下限扩展到 $-\\infty$ 而不引入显著误差。\n$$\nZ_N^{\\mathrm{bnd}} \\approx \\int_{-\\infty}^{0} \\exp\\left(-N \\frac{a\\beta}{2} y^2\\right) dy\n$$\n这个积分恰好是为内部鞍点情况计算的积分的一半，因为被积函数是一个偶函数。\n$$\nZ_N^{\\mathrm{bnd}} \\approx \\frac{1}{2} \\int_{-\\infty}^{\\infty} \\exp\\left(-N \\frac{a\\beta}{2} y^2\\right) dy = \\frac{1}{2} \\sqrt{\\frac{2\\pi}{N a\\beta}}\n$$\n取自然对数，我们得到 $\\ln Z_N^{\\mathrm{bnd}}$ 的渐近表达式：\n$$\n\\ln Z_N^{\\mathrm{bnd}} \\approx \\ln\\left(\\frac{1}{2} \\sqrt{\\frac{2\\pi}{N a\\beta}}\\right) = \\ln\\left(\\frac{1}{2}\\right) + \\ln\\left(\\sqrt{\\frac{2\\pi}{N a\\beta}}\\right)\n$$\n$$\n\\ln Z_N^{\\mathrm{bnd}} \\approx -\\ln 2 + \\frac{1}{2}\\ln\\left(\\frac{2\\pi}{a\\beta}\\right) - \\frac{1}{2}\\ln N\n$$\n这种情况下的 $O(1)$ 项是 $\\frac{1}{2}\\ln\\left(\\frac{2\\pi}{a\\beta}\\right) - \\ln 2$。\n\n最后一步是计算差值 $\\Delta \\equiv \\big[\\ln Z_N\\big]_{\\mathrm{bnd}} - \\big[\\ln Z_N\\big]_{\\mathrm{int}}$。使用推导出的渐近表达式：\n$$\n\\Delta \\approx \\left(-\\ln 2 + \\frac{1}{2}\\ln\\left(\\frac{2\\pi}{a\\beta}\\right) - \\frac{1}{2}\\ln N\\right) - \\left(\\frac{1}{2}\\ln\\left(\\frac{2\\pi}{a\\beta}\\right) - \\frac{1}{2}\\ln N\\right)\n$$\n涉及 $N$、$a$ 和 $\\beta$ 的项相互抵消，剩下：\n$$\n\\Delta = -\\ln 2\n$$\n这个结果量化了由势能最小值位置不同引起的领头阶有限尺寸修正的差异。配分函数中 $1/2$ 的因子差异，是由于在边界处对高斯峰的一半进行积分而产生的，这在配分函数的对数中体现为一个加法项 $\\ln(1/2) = -\\ln 2$。只要 $a>0$ 和 $\\beta>0$，这个差值就是一个与系统参数 $a$ 和 $\\beta$ 无关的常数。",
            "answer": "$$\\boxed{-\\ln(2)}$$"
        },
        {
            "introduction": "最后的这项练习提供了一个完整的多尺度建模范例，将原子相互作用的微观世界与可测量的宏观性质联系起来。我们将从一个基本的对势（如Lennard-Jones势）出发，推导作为理想气体行为首个修正项的第二维里系数 $B_2(T)$。这项练习不仅涉及理论推导，还要求动手进行计算实践，包括数值积分和求根，以预测玻意耳温度等热力学行为。",
            "id": "3792638",
            "problem": "考虑一种稀薄经典气体，由全同粒子组成，它们通过在原子尺度上具有代表性的成对相加的各向同性势相互作用，其宏观压缩因子由维里展开确定。在多尺度建模与分析中，通过将第二维里系数与由正则配分函数构建的构型积分相关联，可以从微观相互作用势桥接到宏观状态方程。从正则配分函数和维里展开出发，推导对于各向同性系统，连接第二维里系数 $B_2(T)$ 与微观对相互作用的积分表达式，然后实现一个数值求积方法来计算 Lennard-Jones (LJ) 势下的该积分。Lennard-Jones (LJ) 势定义为 $u(r)=4\\,\\epsilon\\left[(\\sigma/r)^{12}-(\\sigma/r)^{6}\\right]$，其中 $\\epsilon$ 是能量尺度，$\\sigma$ 是长度尺度。\n\n您必须从以下基本基础出发：\n- N个经典粒子的正则配分函数及其通过统计平均与热力学可观测量之间的关系。\n- 稀薄气体压缩因子 Z 的维里展开，其中第二维里系数用构型积分量化了对理想气体行为的主导修正。\n- 从对势和 Boltzmann 权重定义的 Mayer 函数，及其在将 $B_2(T)$ 表示为三维各向同性相互作用中相对距离的积分中的作用。\n\n在推导出积分表达式后，使用约化温度 $T^* = k_B T / \\epsilon$ 和约化距离 $r^* = r / \\sigma$ 对您的公式进行无量纲化，其中 $k_B$ 是 Boltzmann 常数。实现一个适用于 $r^* \\in [0,\\infty)$ 上反常积分的稳健数值积分方案，并用它来计算约化第二维里系数 $B_2^*(T^*) = B_2(T) / \\sigma^3$。通过估算 $B_2^*(T_B^*) = 0$ 时的约化 Boyle 温度 $T_B^*$，分析 $B_2^*(T^*)$ 随温度的符号变化。\n\n物理和数值单位：以 $\\sigma^3$ 为单位报告所有 $B_2^*(T^*)$ 的值（即，$B_2(T)$ 除以 $\\sigma^3$ 是无量纲的）。本问题不涉及角度。使用上文定义的约化温度 $T^*$ 表示所有温度。将所有报告的浮点数四舍五入到6位小数。\n\n测试套件和输出规范：\n- 使用以下约化温度 $T^*$ 的测试套件：$\\{\\,0.5,\\,1.0,\\,3.0,\\,3.5,\\,10.0\\,\\}$。\n- 对于测试套件中的每个 $T^*$，通过您的数值求积方法计算 $B_2^*(T^*)$。\n- 通过在一个足够大的 $T^*$ 区间上对 $B_2^*(T^*)$ 使用区间套和二分法来估算约化 Boyle 温度 $T_B^*$，返回一个四舍五入到6位小数的浮点数。\n- 您的程序应产生单行输出，其中包含一个逗号分隔的列表形式的结果，并用方括号括起来，各项排序为 $[B_2^*(0.5),B_2^*(1.0),B_2^*(3.0),B_2^*(3.5),B_2^*(10.0),T_B^*]$。\n\n通过在 $r^*=0$ 附近和 $r^*\\to\\infty$ 时对被积函数进行数值稳定的处理，并提供一个有原则的区间套策略来定位 $B_2^*(T^*)$ 的符号变化，以确保科学真实性。",
            "solution": "该问题要求从统计力学的基本原理出发，推导第二维里系数 $B_2(T)$ 的积分表达式，并随后对 Lennard-Jones 势进行数值计算。\n\n出发点是在温度 T、体积 V 中，由 N 个全同、经典、无相互作用的粒子组成的系统的正则配分函数 $Q_N$：\n$$Q_N = \\frac{1}{N! h^{3N}} \\int e^{-\\beta H(\\mathbf{p}^N, \\mathbf{r}^N)} d\\mathbf{p}^N d\\mathbf{r}^N$$\n其中 $\\beta = 1 / (k_B T)$，$h$ 是 Planck 常数，$H(\\mathbf{p}^N, \\mathbf{r}^N)$ 是经典哈密顿量。哈密顿量是动能 $K(\\mathbf{p}^N)$ 和势能 $U(\\mathbf{r}^N)$ 的总和。对动量的积分可以独立进行，得到热德布罗意波长 $\\Lambda = h / \\sqrt{2\\pi m k_B T}$。配分函数变为：\n$$Q_N = \\frac{1}{N! \\Lambda^{3N}} Z_N$$\n其中 $Z_N$ 是构型积分：\n$$Z_N = \\int_V \\dots \\int_V e^{-\\beta U(\\mathbf{r}^N)} d\\mathbf{r}^N$$\n对于成对相加势，$U(\\mathbf{r}^N) = \\sum_{1 \\le i  j \\le N} u(r_{ij})$，其中 $u(r_{ij})$ 是粒子 i 和 j 之间的对势，它们相距 $r_{ij} = |\\mathbf{r}_i - \\mathbf{r}_j|$。\n\n压强 P 可从 Helmholtz 自由能 $A = -k_B T \\ln Q_N$ 通过 $P = -(\\partial A / \\partial V)_{T,N} = k_B T (\\partial \\ln Q_N / \\partial V)_{T,N}$ 得到。由于只有 $Z_N$ 依赖于体积，这可简化为 $P = k_B T (\\partial \\ln Z_N / \\partial V)_{T,N}$。压缩因子定义为 $Z = PV/(Nk_B T)$。维里展开将 Z 表示为数密度 $\\rho = N/V$ 的幂级数：\n$$Z = 1 + B_2(T) \\rho + B_3(T) \\rho^2 + \\dots$$\n为求得 $B_2(T)$，我们使用 $Z_N$ 的集团展开。我们引入 Mayer 函数，$f_{ij} = e^{-\\beta u(r_{ij})} - 1$。$Z_N$ 的被积函数可以写为：\n$$e^{-\\beta U(\\mathbf{r}^N)} = \\prod_{1 \\le i  j \\le N} e^{-\\beta u(r_{ij})} = \\prod_{1 \\le i  j \\le N} (1 + f_{ij})$$\n对于稀薄气体，我们展开这个乘积并保留主导项：\n$$Z_N = \\int_V \\dots \\int_V \\left(1 + \\sum_{1 \\le i  j \\le N} f_{ij} + \\dots\\right) d\\mathbf{r}^N$$\n第一项给出 $\\int d\\mathbf{r}^N = V^N$。第二项包含 $\\binom{N}{2}$ 个相同的积分之和。我们考虑含有 $f_{12}$ 的项：\n$$\\int_V \\dots \\int_V f_{12} d\\mathbf{r}_1 \\dots d\\mathbf{r}_N = V^{N-2} \\int_V \\int_V f(r_{12}) d\\mathbf{r}_1 d\\mathbf{r}_2$$\n变换到质心坐标和相对坐标（$\\mathbf{R} = (\\mathbf{r}_1 + \\mathbf{r}_2)/2, \\mathbf{r} = \\mathbf{r}_2 - \\mathbf{r}_1$），对 $\\mathbf{r}_1, \\mathbf{r}_2$ 的积分变为 $V \\int_V f(r) d\\mathbf{r}$。因此：\n$$Z_N \\approx V^N + \\binom{N}{2} V^{N-1} \\int f(r) d\\mathbf{r}$$\n取对数，并在 x 很小时使用 $\\ln(1+x) \\approx x$，在 N 很大时使用 $N(N-1)/2 \\approx N^2/2$：\n$$\\ln Z_N \\approx \\ln(V^N) + \\ln\\left(1 + \\frac{N(N-1)}{2V} \\int f(r) d\\mathbf{r}\\right) \\approx N \\ln V + \\frac{N^2}{2V} \\int f(r) d\\mathbf{r}$$\n压强则为：\n$$P = k_B T \\frac{\\partial}{\\partial V} \\left(N \\ln V + \\frac{N^2}{2V} \\int f(r) d\\mathbf{r}\\right) = k_B T \\left(\\frac{N}{V} - \\frac{N^2}{2V^2} \\int f(r) d\\mathbf{r}\\right)$$\n整理得到压缩因子：\n$$Z = \\frac{PV}{Nk_B T} = 1 - \\frac{N}{2V} \\int f(r) d\\mathbf{r} = 1 + \\left(-\\frac{1}{2}\\int f(r) d\\mathbf{r}\\right)\\rho$$\n将此与维里展开式比较，我们确定第二维里系数：\n$$B_2(T) = -\\frac{1}{2} \\int (e^{-\\beta u(r)} - 1) d\\mathbf{r}$$\n对于各向同性势，我们在球坐标中积分，$d\\mathbf{r} = 4\\pi r^2 dr$：\n$$B_2(T) = -\\frac{1}{2} \\int_0^\\infty (e^{-\\beta u(r)} - 1) 4\\pi r^2 dr = -2\\pi \\int_0^\\infty (e^{-u(r)/(k_B T)} - 1) r^2 dr$$\n这就是连接对势与第二维里系数的一般积分表达式。\n\n接下来，我们对此表达式进行无量纲化。Lennard-Jones 势为 $u(r) = 4\\epsilon [(\\sigma/r)^{12} - (\\sigma/r)^6]$。我们使用约化距离 $r^* = r/\\sigma$ 和约化温度 $T^* = k_B T / \\epsilon$。约化势为 $u^*(r^*) = u(r)/\\epsilon = 4[(r^*)^{-12} - (r^*)^{-6}]$。指数的参数变为 $\\beta u(r) = u(r)/(k_B T) = (u(r)/\\epsilon) / (k_B T/\\epsilon) = u^*(r^*)/T^*$。代入 $r = \\sigma r^*$ 和 $dr = \\sigma dr^*$：\n$$B_2(T) = -2\\pi \\int_0^\\infty (e^{-u^*(r^*)/T^*} - 1) (\\sigma r^*)^2 (\\sigma dr^*) = -2\\pi \\sigma^3 \\int_0^\\infty (e^{-u^*(r^*)/T^*} - 1) (r^*)^2 dr^*$$\n约化第二维里系数为 $B_2^*(T^*) = B_2(T) / \\sigma^3$：\n$$B_2^*(T^*) = -2\\pi \\int_0^\\infty \\left(e^{-4[(r^*)^{-12} - (r^*)^{-6}]/T^*} - 1\\right) (r^*)^2 dr^*$$\n这是需要进行数值计算的最终表达式。该积分为反常积分，积分上限为 $r^*=\\infty$。被积函数在极限处表现良好。当 $r^* \\to 0$ 时，$u^*(r^*) \\to +\\infty$，因此 $e^{-u^*/T^*} \\to 0$，被积函数趋近于 $-(r^*)^2$，即为 0。当 $r^* \\to \\infty$ 时，$u^*(r^*) \\to 0$，并且 $e^{-u^*/T^*} - 1 \\approx -u^*/T^* \\approx -4(r^*)^{-6}/T^*$。被积函数趋近于 $-4(r^*)^{-4}/T^*$，其衰减速度足以使积分收敛。我们将使用一个数值求积程序 `scipy.integrate.quad`，它适用于此类反常积分。\n\nBoyle 温度 $T_B$ 是第二维里系数为零时的温度，即 $B_2(T_B) = 0$。这对应于长程吸引和短程排斥效应相互抵消的温度。在约化单位中，我们寻求使 $B_2^*(T_B^*) = 0$ 的约化 Boyle 温度 $T_B^*$。在低温下，LJ 势的吸引势阱占主导地位，使得 $B_2^*(T^*)$ 为负。在高温下，排斥核占主导地位，使得 $B_2^*(T^*)$ 为正。因此，必然存在一个根。我们将通过首先确定一个温度区间 $[T_a^*, T_b^*]$ 来找到这个根，在该区间内 $B_2^*(T_a^*)$ 和 $B_2^*(T_b^*)$ 符号相反。测试套件中的值 $T^*=3.0$ 和 $T^*=3.5$ 是一个很好的区间。然后，我们采用求根算法 `scipy.optimize.root_scalar`，并使用 `brentq` 方法（一种结合了二分法、割线法和逆二次插值的稳健方法）来在该区间内找到 $T_B^*$。\n\n该实现将包括一个定义被积函数的函数，一个使用数值求积计算给定 $T^*$ 下的 $B_2^*(T^*)$ 的函数，以及一个用于计算测试套件的 $B_2^*$ 并找到 $T_B^*$ 的主程序。所有浮点结果将按要求四舍五入到6位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate, optimize\n\ndef solve():\n    \"\"\"\n    Derives, calculates, and analyzes the second virial coefficient for a Lennard-Jones fluid.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases_t_star = [0.5, 1.0, 3.0, 3.5, 10.0]\n\n    def lj_potential_reduced(r_star: float) -> float:\n        \"\"\"\n        Calculates the reduced Lennard-Jones potential u*(r*) = u(r)/epsilon.\n        \n        Args:\n            r_star (float): The reduced distance r* = r/sigma.\n        \n        Returns:\n            float: The reduced potential energy.\n        \"\"\"\n        if r_star == 0:\n            return np.inf\n        # Using r_star_6 to avoid recomputing the power\n        r_star_6 = r_star**-6\n        return 4.0 * (r_star_6**2 - r_star_6)\n\n    def b2_star_integrand(r_star: float, t_star: float) -> float:\n        \"\"\"\n        Calculates the integrand for the reduced second virial coefficient B2*.\n        \n        Args:\n            r_star (float): The reduced distance r* = r/sigma.\n            t_star (float): The reduced temperature T* = k_B*T/epsilon.\n        \n        Returns:\n            float: The value of the integrand at r_star.\n        \"\"\"\n        u_star = lj_potential_reduced(r_star)\n        \n        # np.exp handles the u_star -> inf case correctly, returning 0.\n        mayer_f = np.exp(-u_star / t_star) - 1.0\n        \n        return mayer_f * r_star**2\n\n    def calculate_b2_star(t_star: float) -> float:\n        \"\"\"\n        Calculates the reduced second virial coefficient B2* for a given reduced temperature T*.\n        \n        Args:\n            t_star (float): The reduced temperature T*.\n        \n        Returns:\n            float: The reduced second virial coefficient B2*(T*).\n        \"\"\"\n        # The integral is computed from 0 to infinity.\n        integral, _ = integrate.quad(b2_star_integrand, 0, np.inf, args=(t_star,))\n        \n        return -2.0 * np.pi * integral\n\n    results = []\n    # Calculate B2* for each test case temperature\n    for t_star_val in test_cases_t_star:\n        b2_star_val = calculate_b2_star(t_star_val)\n        results.append(round(b2_star_val, 6))\n\n    # Estimate the reduced Boyle Temperature T_B*\n    # We need to find the root of the function B2*(T*) = 0.\n    # From the test cases, B2*(3.0) will be negative and B2*(3.5) will be positive,\n    # so [3.0, 3.5] is a valid bracket.\n    try:\n        # The function for the root-finder is calculate_b2_star itself.\n        boyle_temp_result = optimize.root_scalar(\n            calculate_b2_star, \n            bracket=[3.0, 3.5], \n            method='brentq'\n        )\n        if boyle_temp_result.converged:\n            t_b_star = round(boyle_temp_result.root, 6)\n        else:\n            # Fallback in case of convergence failure, though unlikely for this problem.\n            t_b_star = \"NaN\" \n            \n    except ValueError:\n        # This will be raised if the initial bracket is not valid (i.e. f(a)*f(b) >= 0).\n        t_b_star = \"Error: Invalid Bracket\"\n\n    results.append(t_b_star)\n\n    # Format the final output string exactly as specified.\n    # Convert each numeric result to a string with 6 decimal places.\n    formatted_results = [f\"{res:.6f}\" if isinstance(res, (float, np.floating)) else str(res) for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}