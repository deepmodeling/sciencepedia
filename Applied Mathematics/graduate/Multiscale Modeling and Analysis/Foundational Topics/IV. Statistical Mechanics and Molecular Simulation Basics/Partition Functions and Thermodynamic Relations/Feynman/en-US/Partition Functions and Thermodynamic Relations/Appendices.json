{
    "hands_on_practices": [
        {
            "introduction": "This exercise returns to the first principles of statistical mechanics, providing a foundational practice in constructing the canonical partition function, $Z(\\beta)$. By building it directly from the microcanonical picture of a system with discrete, degenerate energy levels, you will solidify the connection between the microscopic description (energy levels $E_i$, degeneracies $g_i$) and the central object of the canonical ensemble. This practice reinforces how the structure of the energy spectrum fundamentally determines the system's thermodynamic properties. ",
            "id": "3792672",
            "problem": "Consider a finite quantum system with Hamiltonian $\\hat{H}$ acting on a finite-dimensional Hilbert space. The spectrum of $\\hat{H}$ consists of a finite set of distinct energy values $\\{E_i\\}_{i=1}^{M}$, where each $E_i$ has a finite degeneracy $g_i \\in \\mathbb{N}$ counting the number of orthonormal eigenstates with energy $E_i$. Let $\\beta$ denote the inverse temperature in the canonical ensemble. In a multiscale modeling perspective, one may regard the set of microstates at fixed energy as a fine-scale manifold that is coarse-grained into a single macrostate labeled by $E_i$, with the multiplicity of microstates captured by the degeneracy $g_i$.\n\nStarting from the microcanonical counting interpretation and the canonical ensemble definition, carry out the following tasks without assuming any pre-specified formula relating the density of states to the partition function:\n\n- Represent the microcanonical density of states $\\Omega(E)$ as a generalized function that counts the number of microstates at energy $E$, expressed in terms of Dirac delta distributions supported at the discrete energies $\\{E_i\\}$, and explain explicitly how the degeneracy factors $\\{g_i\\}$ enter this representation.\n\n- Using the canonical ensemble definition, derive an explicit expression for the canonical partition function $Z(\\beta)$ purely in terms of the set of distinct energies $\\{E_i\\}$ and their degeneracies $\\{g_i\\}$, with no remaining integrals.\n\nProvide your final answer as a single closed-form analytical expression for $Z(\\beta)$ in terms of $\\{E_i\\}$, $\\{g_i\\}$, and $\\beta$ only. Do not include units. If you introduce any additional notation, define it clearly. The final answer must be a single expression.",
            "solution": "The problem asks for two related derivations concerning a finite quantum system described within the framework of statistical mechanics. The system has a discrete set of energy eigenvalues $\\{E_i\\}_{i=1}^{M}$ with corresponding finite degeneracies $\\{g_i\\}_{i=1}^{M}$. We are tasked with representing the microcanonical density of states $\\Omega(E)$ and deriving the canonical partition function $Z(\\beta)$.\n\nFirst, we address the representation of the microcanonical density of states, $\\Omega(E)$. The function $\\Omega(E)$ quantifies the number of microstates per unit energy interval at energy $E$. For a quantum system with a discrete energy spectrum, there are no available states between the allowed energy eigenvalues $E_i$. The states only exist precisely at these discrete energy values. The number of states at a specific energy $E_i$ is given by its degeneracy, $g_i$.\n\nTo represent this structure mathematically, we employ the Dirac delta distribution, $\\delta(x)$. The Dirac delta is a generalized function with the property that $\\delta(x-a) = 0$ for all $x \\neq a$, and its integral over any domain containing $a$ is unity, i.e., $\\int f(x) \\delta(x-a) dx = f(a)$ for a function $f(x)$ continuous at $x=a$. A weighted delta function, $c \\cdot \\delta(x-a)$, represents a \"point mass\" of magnitude $c$ located at $x=a$.\n\nIn our context, the energy $E$ is the variable. For each allowed energy level $E_i$, there is a \"concentration\" of $g_i$ states. We can represent this concentration using a Dirac delta function centered at $E_i$ and weighted by the degeneracy $g_i$. The contribution to the density of states from the energy level $E_i$ is thus $g_i \\delta(E - E_i)$. Since the total density of states is the sum of contributions from all possible energy levels, we must sum over all distinct energy eigenvalues $E_i$. This gives the representation of the microcanonical density of states as a sum of generalized functions:\n$$\n\\Omega(E) = \\sum_{i=1}^{M} g_i \\delta(E - E_i)\n$$\nThis expression correctly captures the discrete nature of the spectrum. The number of states $N(E_a, E_b)$ in an arbitrary energy interval $[E_a, E_b]$ is given by the integral of $\\Omega(E)$ over that interval. If the interval $[E_a, E_b]$ contains a single energy level $E_k$, then $\\int_{E_a}^{E_b} \\Omega(E) dE = \\int_{E_a}^{E_b} \\sum_{i=1}^{M} g_i \\delta(E - E_i) dE = g_k$, which is the correct count of states.\n\nNext, we derive the canonical partition function $Z(\\beta)$. The canonical partition function is defined by summing the Boltzmann factor, $\\exp(-\\beta E_s)$, over all accessible microstates $s$ of the system. Let the set of all microstates be denoted by $\\mathcal{S}$. The energy of a microstate $s$ is $E_s$. The definition is:\n$$\nZ(\\beta) = \\sum_{s \\in \\mathcal{S}} \\exp(-\\beta E_s)\n$$\nThe problem states that the system has a finite set of distinct energy values $\\{E_i\\}_{i=1}^{M}$, and for each such value $E_i$, there are $g_i$ orthonormal eigenstates. These $g_i$ states are the microstates that share the same energy $E_i$. We can partition the total set of microstates $\\mathcal{S}$ into $M$ disjoint subsets, where the $i$-th subset, $\\mathcal{S}_i$, contains all the microstates with energy $E_i$. The size of the set $\\mathcal{S}_i$ is the degeneracy $g_i$.\n\nWith this partitioning, the sum over all states can be rewritten as a sum over the energy levels, followed by a sum over the degenerate states within each level:\n$$\nZ(\\beta) = \\sum_{i=1}^{M} \\sum_{s \\in \\mathcal{S}_i} \\exp(-\\beta E_s)\n$$\nFor any microstate $s$ in the subset $\\mathcal{S}_i$, its energy $E_s$ is, by definition, equal to $E_i$. Therefore, the Boltzmann factor $\\exp(-\\beta E_s)$ is constant for all states within the inner sum and is equal to $\\exp(-\\beta E_i)$. We can factor this term out of the inner summation:\n$$\nZ(\\beta) = \\sum_{i=1}^{M} \\left( \\exp(-\\beta E_i) \\sum_{s \\in \\mathcal{S}_i} 1 \\right)\n$$\nThe remaining inner sum, $\\sum_{s \\in \\mathcal{S}_i} 1$, simply counts the number of states in the subset $\\mathcal{S}_i$. This number is the degeneracy of the energy level $E_i$, which is $g_i$.\n$$\n\\sum_{s \\in \\mathcal{S}_i} 1 = g_i\n$$\nSubstituting this result back into the expression for $Z(\\beta)$, we obtain the final form of the canonical partition function for this system:\n$$\nZ(\\beta) = \\sum_{i=1}^{M} g_i \\exp(-\\beta E_i)\n$$\nThis expression gives the partition function purely in terms of the fundamental properties of the system's energy spectrum: the distinct energy values $\\{E_i\\}$ and their corresponding degeneracies $\\{g_i\\}$. This derivation starts from the first principles of the canonical ensemble and does not assume any prior integral relationships.",
            "answer": "$$\n\\boxed{\\sum_{i=1}^{M} g_i \\exp(-\\beta E_i)}\n$$"
        },
        {
            "introduction": "In many coarse-grained models, the system's state is described by a continuous order parameter, and direct summation over states is replaced by integration. This practice introduces a powerful analytical tool, Laplace's method, for approximating the partition function of such continuous systems in the limit of large system size $N$. You will explore how the location of a free energy minimum—whether in the interior of the domain or at a boundary—introduces distinct finite-size corrections, a subtle but critical effect in the study of mesoscopic systems and phase transitions. ",
            "id": "3792668",
            "problem": "Consider a coarse-grained single-degree-of-freedom mesoscopic model for a large system of size $N$, in which the slow order parameter $x$ is constrained to the interval $x \\in [-1,1]$. The effective free energy per microscopic unit is $u(x)$, and the canonical partition function at inverse temperature $\\beta$ (with $\\beta = 1/(k_B T)$, where $k_B$ is Boltzmann’s constant and $T$ is temperature) is defined by\n$$\nZ_N = \\int_{-1}^{1} \\exp\\!\\big(-N \\beta\\, u(x)\\big)\\, dx.\n$$\nAssume two models with identical local curvature near the minimum but different minimizer location:\n(i) the interior-saddle model $u_{\\mathrm{int}}(x) = \\frac{a}{2}\\, x^2$, which has its minimum at $x=0$ inside the domain;\n(ii) the boundary-saddle model $u_{\\mathrm{bnd}}(x) = \\frac{a}{2}\\, (x-1)^2$, which has its minimum at the boundary point $x=1$.\nHere $a>0$ and $\\beta>0$ are fixed parameters independent of $N$.\n\nStarting only from the partition function definition and standard calculus (Taylor expansions and Gaussian integrals), derive the large-$N$ asymptotics of $\\ln Z_N$ up to and including the $O(1)$ term for both models. Then, quantify the finite-size effect due to the boundary saddle by computing the difference $\\Delta$ between the $O(1)$ terms in $\\ln Z_N$ for the boundary-saddle and interior-saddle cases at the same $(a,\\beta)$, i.e.,\n$$\n\\Delta \\equiv \\Big[\\ln Z_N\\Big]_{\\mathrm{bnd}} - \\Big[\\ln Z_N\\Big]_{\\mathrm{int}}.\n$$\nProvide your final answer as a single exact closed-form expression. No rounding is required and no physical units should be included in the final expression.",
            "solution": "The problem requires the derivation of the large-$N$ asymptotics for the canonical partition function $Z_N$ for two different effective free energy models, and then to compute the difference between their logarithmic forms. The partition function is given by\n$$\nZ_N = \\int_{-1}^{1} \\exp\\!\\big(-N \\beta\\, u(x)\\big)\\, dx\n$$\nwhere $N$ is a large parameter. This integral can be evaluated asymptotically using Laplace's method. The principle of this method is that for large $N$, the value of the integral is dominated by the contribution from the neighborhood of the point $x_0$ where the function $u(x)$ attains its global minimum within the domain of integration.\n\nLet us define $f(x) = \\beta u(x)$. The integral becomes $Z_N = \\int_{-1}^{1} \\exp(-N f(x)) dx$.\n\nFirst, we analyze the interior-saddle model, $u_{\\mathrm{int}}(x) = \\frac{a}{2}\\, x^2$.\nThe function $f_{\\mathrm{int}}(x) = \\frac{a\\beta}{2} x^2$ has a global minimum at $x_0=0$, which is an interior point of the domain $[-1, 1]$. At this minimum, $f_{\\mathrm{int}}(0) = 0$. We perform a Taylor expansion of $f_{\\mathrm{int}}(x)$ around $x_0=0$. In this case, the function is already a quadratic form, so the expansion is exact up to the second order:\n$$\nf_{\\mathrm{int}}(x) = f_{\\mathrm{int}}(0) + f'_{\\mathrm{int}}(0)(x-0) + \\frac{1}{2}f''_{\\mathrm{int}}(0)(x-0)^2 + \\dots\n$$\nWith $f'_{\\mathrm{int}}(x) = a\\beta x$ and $f''_{\\mathrm{int}}(x) = a\\beta$, we have $f'_{\\mathrm{int}}(0)=0$ and $f''_{\\mathrm{int}}(0)=a\\beta$.\nThe partition function for this model is:\n$$\nZ_N^{\\mathrm{int}} = \\int_{-1}^{1} \\exp\\left(-N \\frac{a\\beta}{2} x^2\\right) dx\n$$\nFor large $N$, the integrand $\\exp(-N \\frac{a\\beta}{2} x^2)$ forms a sharp peak around $x=0$ and decays very rapidly. The contributions to the integral from regions away from $x=0$, particularly near the boundaries $x=\\pm 1$, are negligible. Therefore, we can extend the limits of integration to $(-\\infty, \\infty)$ with an error that is exponentially small in $N$.\n$$\nZ_N^{\\mathrm{int}} \\approx \\int_{-\\infty}^{\\infty} \\exp\\left(-N \\frac{a\\beta}{2} x^2\\right) dx\n$$\nThis is a standard Gaussian integral of the form $\\int_{-\\infty}^{\\infty} \\exp(-cx^2) dx = \\sqrt{\\frac{\\pi}{c}}$. With $c = N \\frac{a\\beta}{2}$, we obtain:\n$$\nZ_N^{\\mathrm{int}} \\approx \\sqrt{\\frac{\\pi}{N \\frac{a\\beta}{2}}} = \\sqrt{\\frac{2\\pi}{N a\\beta}}\n$$\nThe natural logarithm of the partition function is then:\n$$\n\\ln Z_N^{\\mathrm{int}} \\approx \\ln\\left(\\sqrt{\\frac{2\\pi}{N a\\beta}}\\right) = \\frac{1}{2}\\ln\\left(\\frac{2\\pi}{a\\beta}\\right) - \\frac{1}{2}\\ln N\n$$\nThis is the asymptotic expression for $\\ln Z_N^{\\mathrm{int}}$ up to terms that vanish as $N \\to \\infty$. The $O(1)$ term, which is the constant part of this expression, is $\\frac{1}{2}\\ln\\left(\\frac{2\\pi}{a\\beta}\\right)$.\n\nNext, we analyze the boundary-saddle model, $u_{\\mathrm{bnd}}(x) = \\frac{a}{2}(x-1)^2$.\nThe function $f_{\\mathrm{bnd}}(x) = \\frac{a\\beta}{2}(x-1)^2$ has its global minimum at $x_0=1$, which is a boundary point of the domain $[-1, 1]$. At this minimum, $f_{\\mathrm{bnd}}(1) = 0$. The second derivative is $f''_{\\mathrm{bnd}}(x) = a\\beta$, which is constant.\nThe partition function is:\n$$\nZ_N^{\\mathrm{bnd}} = \\int_{-1}^{1} \\exp\\left(-N \\frac{a\\beta}{2} (x-1)^2\\right) dx\n$$\nTo analyze this integral, we perform a change of variables $y = x-1$, which implies $dx=dy$. The integration interval for $y$ becomes $[-2, 0]$:\n$$\nZ_N^{\\mathrm{bnd}} = \\int_{-2}^{0} \\exp\\left(-N \\frac{a\\beta}{2} y^2\\right) dy\n$$\nSimilar to the previous case, for large $N$, the integrand is sharply peaked around its maximum at $y=0$. The contribution from the lower limit $y=-2$ is exponentially small. Thus, we can extend the lower limit of integration to $-\\infty$ without significant error.\n$$\nZ_N^{\\mathrm{bnd}} \\approx \\int_{-\\infty}^{0} \\exp\\left(-N \\frac{a\\beta}{2} y^2\\right) dy\n$$\nThis integral is exactly half of the integral evaluated for the interior-saddle case, because the integrand is an even function.\n$$\nZ_N^{\\mathrm{bnd}} \\approx \\frac{1}{2} \\int_{-\\infty}^{\\infty} \\exp\\left(-N \\frac{a\\beta}{2} y^2\\right) dy = \\frac{1}{2} \\sqrt{\\frac{2\\pi}{N a\\beta}}\n$$\nTaking the natural logarithm, we find the asymptotic expression for $\\ln Z_N^{\\mathrm{bnd}}$:\n$$\n\\ln Z_N^{\\mathrm{bnd}} \\approx \\ln\\left(\\frac{1}{2} \\sqrt{\\frac{2\\pi}{N a\\beta}}\\right) = \\ln\\left(\\frac{1}{2}\\right) + \\ln\\left(\\sqrt{\\frac{2\\pi}{N a\\beta}}\\right)\n$$\n$$\n\\ln Z_N^{\\mathrm{bnd}} \\approx -\\ln 2 + \\frac{1}{2}\\ln\\left(\\frac{2\\pi}{a\\beta}\\right) - \\frac{1}{2}\\ln N\n$$\nThe $O(1)$ term in this case is $\\frac{1}{2}\\ln\\left(\\frac{2\\pi}{a\\beta}\\right) - \\ln 2$.\n\nThe final step is to compute the difference $\\Delta \\equiv \\big[\\ln Z_N\\big]_{\\mathrm{bnd}} - \\big[\\ln Z_N\\big]_{\\mathrm{int}}$. Using the derived asymptotic expressions:\n$$\n\\Delta \\approx \\left(-\\ln 2 + \\frac{1}{2}\\ln\\left(\\frac{2\\pi}{a\\beta}\\right) - \\frac{1}{2}\\ln N\\right) - \\left(\\frac{1}{2}\\ln\\left(\\frac{2\\pi}{a\\beta}\\right) - \\frac{1}{2}\\ln N\\right)\n$$\nThe terms involving $N$, $a$, and $\\beta$ cancel out, leaving:\n$$\n\\Delta = -\\ln 2\n$$\nThis result quantifies the difference in the leading-order finite-size corrections due to the location of the potential minimum. The factor of $1/2$ difference in the partition functions, arising from integrating over half of the Gaussian peak at a boundary, manifests as an additive term of $\\ln(1/2) = -\\ln 2$ in the logarithm of the partition function. This difference is a constant independent of the system parameters $a$ and $\\beta$, as long as $a>0$ and $\\beta>0$.",
            "answer": "$$\\boxed{-\\ln(2)}$$"
        },
        {
            "introduction": "This practice provides a complete, hands-on computational exercise that bridges the microscopic and macroscopic worlds. You will derive the statistical mechanical expression for the second virial coefficient, $B_2(T)$, which quantifies the first correction to ideal gas behavior, from a fundamental pair potential. By implementing a numerical solution for the Lennard-Jones potential, you will directly observe how temperature-dependent interactions at the atomic scale determine a measurable equation of state for a real gas, a core task in multiscale modeling. ",
            "id": "3792638",
            "problem": "Consider a dilute classical gas of identical particles interacting via a pairwise additive isotropic potential that is representative at the atomistic scale, with the macroscopic compressibility factor determined by a virial expansion. In multiscale modeling and analysis, one bridges from a microscopic interaction potential to a macroscopic equation of state by relating the second virial coefficient to the configurational integral built from the canonical partition function. Starting from the canonical partition function and the virial expansion, derive the integral expression that connects the second virial coefficient $B_2(T)$ to the microscopic pair interaction for an isotropic system, and then implement a numerical quadrature to evaluate it for a Lennard-Jones (LJ) potential. The Lennard-Jones (LJ) potential is defined as $u(r)=4\\,\\epsilon\\left[(\\sigma/r)^{12}-(\\sigma/r)^{6}\\right]$, where $\\epsilon$ is the energy scale and $\\sigma$ is the length scale.\n\nYou must proceed from the following fundamental base:\n- The canonical partition function for $N$ classical particles and its relation to thermodynamic observables through statistical averages.\n- The virial expansion of the compressibility factor $Z$ for a dilute gas, with the second virial coefficient quantifying the leading correction to ideal-gas behavior in terms of the configurational integrals.\n- The Mayer function defined from the pair potential and Boltzmann weight, and its role in expressing $B_2(T)$ as an integral over relative separations for isotropic interactions in three dimensions.\n\nAfter deriving the integral expression, non-dimensionalize your formulation using the reduced temperature $T^* = k_B T / \\epsilon$ and reduced distance $r^* = r / \\sigma$, where $k_B$ is the Boltzmann constant. Implement a robust numerical integration scheme suitable for an improper integral over $r^* \\in [0,\\infty)$, and use it to compute the reduced second virial coefficient $B_2^*(T^*) = B_2(T) / \\sigma^3$. Analyze the sign change of $B_2^*(T^*)$ with temperature by estimating the reduced Boyle temperature $T_B^*$ at which $B_2^*(T_B^*) = 0$.\n\nPhysical and numerical units: Report all values of $B_2^*(T^*)$ in units of $\\sigma^3$ (that is, $B_2(T)$ divided by $\\sigma^3$ is dimensionless). Angles do not appear in this problem. Express all temperatures using the reduced temperature $T^*$ as defined above. Round all reported floats to $6$ decimal places.\n\nTest suite and output specification:\n- Use the following test suite of reduced temperatures $T^*$: $\\{\\,0.5,\\,1.0,\\,3.0,\\,3.5,\\,10.0\\,\\}$.\n- For each $T^*$ in the test suite, compute $B_2^*(T^*)$ via your numerical quadrature.\n- Estimate the reduced Boyle temperature $T_B^*$ by bracketing and bisection on $B_2^*(T^*)$ over a sufficiently large interval of $T^*$, returning a float rounded to $6$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with entries ordered as $[B_2^*(0.5),B_2^*(1.0),B_2^*(3.0),B_2^*(3.5),B_2^*(10.0),T_B^*]$.\n\nEnsure scientific realism by using numerically stable handling of the integrand near $r^*=0$ and as $r^*\\to\\infty$, and by providing a principled bracketing strategy to locate the sign change in $B_2^*(T^*)$.",
            "solution": "The problem requires the derivation of the integral expression for the second virial coefficient, $B_2(T)$, from fundamental principles of statistical mechanics, and its subsequent numerical evaluation for a Lennard-Jones potential.\n\nThe starting point is the canonical partition function $Q_N$ for a system of $N$ identical, classical, non-interacting particles in a volume $V$ at temperature $T$:\n$$Q_N = \\frac{1}{N! h^{3N}} \\int e^{-\\beta H(\\mathbf{p}^N, \\mathbf{r}^N)} d\\mathbf{p}^N d\\mathbf{r}^N$$\nwhere $\\beta = 1 / (k_B T)$, $h$ is Planck's constant, and $H(\\mathbf{p}^N, \\mathbf{r}^N)$ is the classical Hamiltonian. The Hamiltonian is the sum of kinetic energy $K(\\mathbf{p}^N)$ and potential energy $U(\\mathbf{r}^N)$. The integral over momenta can be performed independently, yielding the thermal de Broglie wavelength $\\Lambda = h / \\sqrt{2\\pi m k_B T}$. The partition function becomes:\n$$Q_N = \\frac{1}{N! \\Lambda^{3N}} Z_N$$\nwhere $Z_N$ is the configurational integral:\n$$Z_N = \\int_V \\dots \\int_V e^{-\\beta U(\\mathbf{r}^N)} d\\mathbf{r}^N$$\nFor a pairwise additive potential, $U(\\mathbf{r}^N) = \\sum_{1 \\le i < j \\le N} u(r_{ij})$, where $u(r_{ij})$ is the pair potential between particles $i$ and $j$ separated by a distance $r_{ij} = |\\mathbf{r}_i - \\mathbf{r}_j|$.\n\nThe pressure $P$ is obtained from the Helmholtz free energy $A = -k_B T \\ln Q_N$ as $P = -(\\partial A / \\partial V)_{T,N} = k_B T (\\partial \\ln Q_N / \\partial V)_{T,N}$. Since only $Z_N$ depends on volume, this simplifies to $P = k_B T (\\partial \\ln Z_N / \\partial V)_{T,N}$. The compressibility factor is defined as $Z = PV/(Nk_B T)$. The virial expansion expresses $Z$ as a power series in the number density $\\rho = N/V$:\n$$Z = 1 + B_2(T) \\rho + B_3(T) \\rho^2 + \\dots$$\nTo find $B_2(T)$, we use the cluster expansion of $Z_N$. We introduce the Mayer function, $f_{ij} = e^{-\\beta u(r_{ij})} - 1$. The integrand of $Z_N$ can then be written as:\n$$e^{-\\beta U(\\mathbf{r}^N)} = \\prod_{1 \\le i < j \\le N} e^{-\\beta u(r_{ij})} = \\prod_{1 \\le i < j \\le N} (1 + f_{ij})$$\nFor a dilute gas, we expand this product and keep the leading terms:\n$$Z_N = \\int_V \\dots \\int_V \\left(1 + \\sum_{1 \\le i < j \\le N} f_{ij} + \\dots\\right) d\\mathbf{r}^N$$\nThe first term gives $\\int d\\mathbf{r}^N = V^N$. The second term involves a sum of $\\binom{N}{2}$ identical integrals. We consider the term with $f_{12}$:\n$$\\int_V \\dots \\int_V f_{12} d\\mathbf{r}_1 \\dots d\\mathbf{r}_N = V^{N-2} \\int_V \\int_V f(r_{12}) d\\mathbf{r}_1 d\\mathbf{r}_2$$\nChanging to center-of-mass and relative coordinates ($\\mathbf{R} = (\\mathbf{r}_1 + \\mathbf{r}_2)/2, \\mathbf{r} = \\mathbf{r}_2 - \\mathbf{r}_1$), the integral over $\\mathbf{r}_1, \\mathbf{r}_2$ becomes $V \\int_V f(r) d\\mathbf{r}$. Thus:\n$$Z_N \\approx V^N + \\binom{N}{2} V^{N-1} \\int f(r) d\\mathbf{r}$$\nTaking the logarithm and using $\\ln(1+x) \\approx x$ for small $x$, and $N(N-1) \\approx N^2$ for large $N$:\n$$\\ln Z_N \\approx \\ln(V^N) + \\ln\\left(1 + \\frac{N(N-1)}{2V} \\int f(r) d\\mathbf{r}\\right) \\approx N \\ln V + \\frac{N^2}{2V} \\int f(r) d\\mathbf{r}$$\nThe pressure is then:\n$$P = k_B T \\frac{\\partial}{\\partial V} \\left(N \\ln V + \\frac{N^2}{2V} \\int f(r) d\\mathbf{r}\\right) = k_B T \\left(\\frac{N}{V} - \\frac{N^2}{2V^2} \\int f(r) d\\mathbf{r}\\right)$$\nRearranging to get the compressibility factor:\n$$Z = \\frac{PV}{Nk_B T} = 1 - \\frac{N}{2V} \\int f(r) d\\mathbf{r} = 1 + \\left(-\\frac{1}{2}\\int f(r) d\\mathbf{r}\\right)\\rho$$\nComparing this to the virial expansion, we identify the second virial coefficient:\n$$B_2(T) = -\\frac{1}{2} \\int (e^{-\\beta u(r)} - 1) d\\mathbf{r}$$\nFor an isotropic potential, we integrate in spherical coordinates, $d\\mathbf{r} = 4\\pi r^2 dr$:\n$$B_2(T) = -\\frac{1}{2} \\int_0^\\infty (e^{-\\beta u(r)} - 1) 4\\pi r^2 dr = -2\\pi \\int_0^\\infty (e^{-u(r)/(k_B T)} - 1) r^2 dr$$\nThis is the general integral expression connecting the pair potential to the second virial coefficient.\n\nNext, we non-dimensionalize this expression. The Lennard-Jones potential is $u(r) = 4\\epsilon [(\\sigma/r)^{12} - (\\sigma/r)^6]$. We use reduced distance $r^* = r/\\sigma$ and reduced temperature $T^* = k_B T / \\epsilon$. The reduced potential is $u^*(r^*) = u(r)/\\epsilon = 4[(r^*)^{-12} - (r^*)^{-6}]$. The argument of the exponential becomes $\\beta u(r) = u(r)/(k_B T) = (u(r)/\\epsilon) / (k_B T/\\epsilon) = u^*(r^*)/T^*$. Substituting $r = \\sigma r^*$ and $dr = \\sigma dr^*$:\n$$B_2(T) = -2\\pi \\int_0^\\infty (e^{-u^*(r^*)/T^*} - 1) (\\sigma r^*)^2 (\\sigma dr^*) = -2\\pi \\sigma^3 \\int_0^\\infty (e^{-u^*(r^*)/T^*} - 1) (r^*)^2 dr^*$$\nThe reduced second virial coefficient is $B_2^*(T^*) = B_2(T) / \\sigma^3$:\n$$B_2^*(T^*) = -2\\pi \\int_0^\\infty \\left(e^{-4[(r^*)^{-12} - (r^*)^{-6}]/T^*} - 1\\right) (r^*)^2 dr^*$$\nThis is the final expression to be evaluated numerically. The integral is improper, extending to $r^*=\\infty$. The integrand is well-behaved at the limits. As $r^* \\to 0$, $u^*(r^*) \\to +\\infty$, so $e^{-u^*/T^*} \\to 0$, and the integrand approaches $-(r^*)^2$, which is $0$. As $r^* \\to \\infty$, $u^*(r^*) \\to 0$, and $e^{-u^*/T^*} - 1 \\approx -u^*/T^* \\approx 4(r^*)^{-6}/T^*$. The integrand approaches $4(r^*)^{-4}/T^*$, which decays sufficiently fast for the integral to converge. We will use a numerical quadrature routine, `scipy.integrate.quad`, which is suitable for such improper integrals.\n\nThe Boyle temperature, $T_B$, is the temperature at which the second virial coefficient is zero, i.e., $B_2(T_B) = 0$. This corresponds to the temperature where the effects of long-range attraction and short-range repulsion cancel out. In reduced units, we seek the reduced Boyle temperature $T_B^*$ for which $B_2^*(T_B^*) = 0$. At low temperatures, the attractive well of the LJ potential dominates, making $B_2^*(T^*)$ negative. At high temperatures, the repulsive core dominates, making $B_2^*(T^*)$ positive. Therefore, a root must exist. We will find this root by first identifying a temperature interval $[T_a^*, T_b^*]$ where $B_2^*(T_a^*)$ and $B_2^*(T_b^*)$ have opposite signs. The values from the test suite, $T^*=3.0$ and $T^*=3.5$, serve as an excellent bracket. We then employ a root-finding algorithm, `scipy.optimize.root_scalar` with the `brentq` method (a robust combination of bisection, secant, and inverse quadratic interpolation), to find $T_B^*$ within this bracket.\n\nThe implementation will consist of a function to define the integrand, a function to compute $B_2^*(T^*)$ for a given $T^*$ using numerical quadrature, and a main routine to compute $B_2^*$ for the test suite and to find $T_B^*$. All floating-point results will be rounded to $6$ decimal places as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate, optimize\n\ndef solve():\n    \"\"\"\n    Derives, calculates, and analyzes the second virial coefficient for a Lennard-Jones fluid.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases_t_star = [0.5, 1.0, 3.0, 3.5, 10.0]\n\n    def lj_potential_reduced(r_star: float) -> float:\n        \"\"\"\n        Calculates the reduced Lennard-Jones potential u*(r*) = u(r)/epsilon.\n        \n        Args:\n            r_star (float): The reduced distance r* = r/sigma.\n        \n        Returns:\n            float: The reduced potential energy.\n        \"\"\"\n        if r_star = 0:\n            return np.inf\n        # Using r_star_6 to avoid recomputing the power\n        r_star_6 = r_star**-6\n        return 4.0 * (r_star_6**2 - r_star_6)\n\n    def b2_star_integrand(r_star: float, t_star: float) - float:\n        \"\"\"\n        Calculates the integrand for the reduced second virial coefficient B2*.\n        \n        Args:\n            r_star (float): The reduced distance r* = r/sigma.\n            t_star (float): The reduced temperature T* = k_B*T/epsilon.\n        \n        Returns:\n            float: The value of the integrand at r_star.\n        \"\"\"\n        u_star = lj_potential_reduced(r_star)\n        \n        # np.exp handles the u_star -> inf case correctly, returning 0.\n        mayer_f = np.exp(-u_star / t_star) - 1.0\n        \n        return mayer_f * r_star**2\n\n    def calculate_b2_star(t_star: float) - float:\n        \"\"\"\n        Calculates the reduced second virial coefficient B2* for a given reduced temperature T*.\n        \n        Args:\n            t_star (float): The reduced temperature T*.\n        \n        Returns:\n            float: The reduced second virial coefficient B2*(T*).\n        \"\"\"\n        # The integral is computed from 0 to infinity.\n        integral, _ = integrate.quad(b2_star_integrand, 0, np.inf, args=(t_star,))\n        \n        return -2.0 * np.pi * integral\n\n    results = []\n    # Calculate B2* for each test case temperature\n    for t_star_val in test_cases_t_star:\n        b2_star_val = calculate_b2_star(t_star_val)\n        results.append(round(b2_star_val, 6))\n\n    # Estimate the reduced Boyle Temperature T_B*\n    # We need to find the root of the function B2*(T*) = 0.\n    # From the test cases, B2*(3.0) will be negative and B2*(3.5) will be positive,\n    # so [3.0, 3.5] is a valid bracket.\n    try:\n        # The function for the root-finder is calculate_b2_star itself.\n        boyle_temp_result = optimize.root_scalar(\n            calculate_b2_star, \n            bracket=[3.0, 3.5], \n            method='brentq'\n        )\n        if boyle_temp_result.converged:\n            t_b_star = round(boyle_temp_result.root, 6)\n        else:\n            # Fallback in case of convergence failure, though unlikely for this problem.\n            t_b_star = \"NaN\" \n            \n    except ValueError:\n        # This will be raised if the initial bracket is not valid (i.e. f(a)*f(b) >= 0).\n        t_b_star = \"Error: Invalid Bracket\"\n\n    results.append(t_b_star)\n\n    # Format the final output string exactly as specified.\n    # Convert each numeric result to a string with 6 decimal places.\n    formatted_results = [f\"{res:.6f}\" if isinstance(res, (float, np.floating)) else str(res) for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}