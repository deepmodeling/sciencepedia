{
    "hands_on_practices": [
        {
            "introduction": "计算单元刚度矩阵是有限元方法 (FEM) 的基础。本练习将引导你完成从参考单元到物理单元的映射、通过雅可比矩阵变换梯度以及执行积分以获得刚度矩阵项的完整过程。掌握这些核心步骤对于深入理解有限元法的内在机制至关重要。",
            "id": "3818783",
            "problem": "考虑一个二维空间中的标量扩散问题，其扩散张量 $A(x)$ 是对称正定的，定义在有界多边形域 $\\Omega \\subset \\mathbb{R}^{2}$ 上。在标准的伽辽金方法中，有限元法（FEM）在分片多项式子空间中求解 $u_{h}$，使得对于同一子空间中的所有测试函数 $v_{h}$，涉及 $\\nabla v$ 和 $\\nabla u$ 的双线性形式与载荷项相平衡。在多尺度建模的背景下，假设在每个网格单元 $K$ 上，快速振荡的 $A(x)$ 被一个常数的、单元有效的张量 $\\bar{A}_{K}$ 所取代，该张量通过局部于 $K$ 的代表性体积元（RVE）程序计算得出。\n\n在一个顶点为 $x_{1}=(2,1)$、$x_{2}=(5,2)$ 和 $x_{3}=(3,4)$ 的三角形单元 $K$ 上，考虑通过仿射变换 $F(\\hat{x})=x_{1}+B\\hat{x}$ 将顶点为 $(0,0)$、$(1,0)$、$(0,1)$ 的参考三角形 $\\hat{K}=\\{(\\xi,\\eta): \\xi \\ge 0,\\ \\eta \\ge 0,\\ \\xi+\\eta \\le 1\\}$ 映射到 $K$ 所获得的 $P_{1}$（线性）形函数，其中 $B$ 是由边向量构成的 $2\\times 2$ 矩阵。令 $\\hat{\\phi}_{1}$、$\\hat{\\phi}_{2}$、$\\hat{\\phi}_{3}$ 为在 $\\hat{K}$ 上的 $P_{1}$ 形函数，它们在参考顶点处满足克罗内克-德尔塔性质，并令 $\\phi_{i}=\\hat{\\phi}_{i}\\circ F^{-1}$ 为在 $K$ 上的相应形函数。\n\n假设在 $K$ 上，有效扩散张量是常数，并由 $\\bar{A}_{K}=\\begin{pmatrix}2  1\\\\ 1  3\\end{pmatrix}$ 给出。从伽辽金方法的弱形式定义和 $\\hat{K}$ 上的 $P_{1}$ 形函数定义出发，完成以下任务：\n\n1. 为给定的 $K$ 构造在 $\\hat{K}$ 上的形函数 $\\hat{\\phi}_{1}$、$\\hat{\\phi}_{2}$、$\\hat{\\phi}_{3}$ 以及仿射映射 $F$ 及其雅可比矩阵 $B$。\n2. 使用 $B$ 推导从 $\\nabla_{\\hat{x}}\\hat{\\phi}_{i}$ 到 $\\nabla_{x}\\phi_{i}$ 的梯度变换规则，并将单元刚度矩阵项 $K_{ij}^{(K)}$ 表示为在参考三角形 $\\hat{K}$ 上的积分。\n3. 对给定的 $K$ 和 $\\bar{A}_{K}$，精确计算该积分以获得特定的矩阵项 $K_{12}^{(K)}$。\n\n请给出 $K_{12}^{(K)}$ 的精确值作为一个实数，不要四舍五入。",
            "solution": "首先评估问题的有效性。提取所有给定信息，并分析其一致性、完整性和科学合理性。\n\n**已知条件：**\n- 一个在域 $\\Omega \\subset \\mathbb{R}^{2}$ 上的二维标量扩散问题。\n- 扩散张量是一个对称正定矩阵 $A(x)$。\n- 一种多尺度方法在每个单元 $K$ 上用一个常数有效张量 $\\bar{A}_{K}$ 替换 $A(x)$。\n- 具体单元是一个三角形 $K$，其顶点为 $x_{1}=(2,1)$、$x_{2}=(5,2)$ 和 $x_{3}=(3,4)$。\n- 有限元空间由 $P_{1}$（分片线性）函数组成。\n- 参考三角形为 $\\hat{K}=\\{(\\xi,\\eta): \\xi \\ge 0,\\ \\eta \\ge 0,\\ \\xi+\\eta \\le 1\\}$，其顶点为 $\\hat{x}_{1}=(0,0)$、$\\hat{x}_{2}=(1,0)$、$\\hat{x}_{3}=(0,1)$。\n- 从参考单元到物理单元的仿射映射为 $F(\\hat{x})=x_{1}+B\\hat{x}$。\n- 参考形函数 $\\hat{\\phi}_{i}$ 满足克罗内克-德尔塔性质 $\\hat{\\phi}_{i}(\\hat{x}_{j})=\\delta_{ij}$。\n- 物理形函数为 $\\phi_{i}=\\hat{\\phi}_{i}\\circ F^{-1}$。这意味着对于 $i \\in \\{1,2,3\\}$，映射关系为 $F(\\hat{x}_i) = x_i$。\n- 在 $K$ 上的有效扩散张量为 $\\bar{A}_{K}=\\begin{pmatrix}2  1\\\\ 1  3\\end{pmatrix}$。该矩阵是对称的，其行列式为 $(2)(3)-(1)(1)=5 > 0$，迹为 $2+3=5>0$，因此按要求是正定的。\n- 问题要求计算单元刚度矩阵项 $K_{12}^{(K)}$。\n\n**验证：**\n该问题定义明确且科学合理。它描述了有限元法中计算单元刚度矩阵的标准过程。所有必要的数据都已提供，并且没有内部矛盾。映射约定 $F(\\hat{x}_i)=x_i$ 是标准的，并解决了构造雅可比矩阵 $B$ 时的任何潜在歧义。因此，该问题被认为是有效的。\n\n解答过程遵循问题陈述中列出的三个任务。\n\n**任务1：构造形函数和仿射映射**\n\n参考单元 $\\hat{K}$ 上的 $P_{1}$ 形函数是形式为 $\\hat{\\phi}(\\xi, \\eta) = a + b\\xi + c\\eta$ 的线性多项式。通过在参考顶点 $\\hat{x}_{1}=(0,0)$、$\\hat{x}_{2}=(1,0)$ 和 $\\hat{x}_{3}=(0,1)$ 处强制执行克罗内克-德尔塔性质 $\\hat{\\phi}_{i}(\\hat{x}_{j}) = \\delta_{ij}$，我们得到：\n- 对于 $\\hat{\\phi}_{1}$：$\\hat{\\phi}_{1}(0,0)=1$，$\\hat{\\phi}_{1}(1,0)=0$，$\\hat{\\phi}_{1}(0,1)=0$，得到 $\\hat{\\phi}_{1}(\\xi,\\eta) = 1 - \\xi - \\eta$。\n- 对于 $\\hat{\\phi}_{2}$：$\\hat{\\phi}_{2}(0,0)=0$，$\\hat{\\phi}_{2}(1,0)=1$，$\\hat{\\phi}_{2}(0,1)=0$，得到 $\\hat{\\phi}_{2}(\\xi,\\eta) = \\xi$。\n- 对于 $\\hat{\\phi}_{3}$：$\\hat{\\phi}_{3}(0,0)=0$，$\\hat{\\phi}_{3}(1,0)=0$，$\\hat{\\phi}_{3}(0,1)=1$，得到 $\\hat{\\phi}_{3}(\\xi,\\eta) = \\eta$。\n\n仿射映射为 $x = F(\\hat{x}) = x_{1} + B\\hat{x}$。雅可比矩阵 $B$ 由顶点映射 $F(\\hat{x}_i) = x_i$ 确定。\n原点 $\\hat{x}_1=(0,0)$ 的映射给出 $F(0,0) = x_1$，这与公式一致。\n其他顶点的映射确定了 $B$ 的列：\n$F(\\hat{x}_{2}) = F(1,0) = x_{1} + B\\begin{pmatrix}1 \\\\ 0\\end{pmatrix} = x_{2} \\implies B\\begin{pmatrix}1 \\\\ 0\\end{pmatrix} = x_{2} - x_{1}$。\n$F(\\hat{x}_{3}) = F(0,1) = x_{1} + B\\begin{pmatrix}0 \\\\ 1\\end{pmatrix} = x_{3} \\implies B\\begin{pmatrix}0 \\\\ 1\\end{pmatrix} = x_{3} - x_{1}$。\n$B$ 的列向量是三角形 $K$ 从顶点 $x_{1}$ 出发的边向量。\n给定 $x_{1}=(2,1)$、$x_{2}=(5,2)$ 和 $x_{3}=(3,4)$，边向量为：\n$x_{2} - x_{1} = (5-2, 2-1) = (3,1)$。\n$x_{3} - x_{1} = (3-2, 4-1) = (1,3)$。\n因此，雅可比矩阵为 $B = \\begin{pmatrix} 3  1 \\\\ 1  3 \\end{pmatrix}$。\n\n**任务2：梯度变换和刚度矩阵积分**\n\n单元刚度矩阵项 $K_{ij}^{(K)}$ 由单元 $K$ 上的双线性形式定义：\n$$K_{ij}^{(K)} = \\int_{K} (\\nabla_{x}\\phi_{i})^{T} \\bar{A}_{K} (\\nabla_{x}\\phi_{j}) \\, dV_{x}$$\n为了计算这个积分，我们将其转换到参考单元 $\\hat{K}$ 上。微分的链式法则给出了物理坐标 $x=(x,y)$ 和参考坐标 $\\hat{x}=(\\xi,\\eta)$ 中梯度之间的关系。对于任何标量函数 $\\psi(x) = \\hat{\\psi}(\\hat{x}(x))$，我们有 $\\nabla_{\\hat{x}}\\hat{\\psi} = B^{T}\\nabla_{x}\\psi$。因此，梯度变换规则是：\n$$\\nabla_{x}\\phi_{i} = (B^{T})^{-1}\\nabla_{\\hat{x}}\\hat{\\phi}_{i} = (B^{-1})^{T}\\nabla_{\\hat{x}}\\hat{\\phi}_{i}$$\n微分面积元变换为 $dV_{x} = |\\det(B)| \\, dV_{\\hat{x}}$。\n将这些代入 $K_{ij}^{(K)}$ 的积分中：\n$$K_{ij}^{(K)} = \\int_{\\hat{K}} \\left((B^{-1})^{T}\\nabla_{\\hat{x}}\\hat{\\phi}_{i}\\right)^{T} \\bar{A}_{K} \\left((B^{-1})^{T}\\nabla_{\\hat{x}}\\hat{\\phi}_{j}\\right) |\\det(B)| \\, dV_{\\hat{x}}$$\n$$K_{ij}^{(K)} = \\int_{\\hat{K}} (\\nabla_{\\hat{x}}\\hat{\\phi}_{i})^{T} B^{-1} \\bar{A}_{K} (B^{-1})^{T} (\\nabla_{\\hat{x}}\\hat{\\phi}_{j}) |\\det(B)| \\, dV_{\\hat{x}}$$\n对于 $P_{1}$ 单元，形函数梯度 $\\nabla_{\\hat{x}}\\hat{\\phi}_{i}$ 是常数向量。因此，整个被积函数是常数，可以移到积分之外：\n$$K_{ij}^{(K)} = |\\det(B)| (\\nabla_{\\hat{x}}\\hat{\\phi}_{i})^{T} \\left( B^{-1} \\bar{A}_{K} (B^{-1})^{T} \\right) (\\nabla_{\\hat{x}}\\hat{\\phi}_{j}) \\int_{\\hat{K}} dV_{\\hat{x}}$$\n参考三角形的面积是 $\\text{Area}(\\hat{K}) = \\int_{\\hat{K}} dV_{\\hat{x}} = \\frac{1}{2}$。这导出了最终表达式：\n$$K_{ij}^{(K)} = \\frac{|\\det(B)|}{2} (\\nabla_{\\hat{x}}\\hat{\\phi}_{i})^{T} \\left( B^{-1} \\bar{A}_{K} (B^{-1})^{T} \\right) (\\nabla_{\\hat{x}}\\hat{\\phi}_{j})$$\n\n**任务3：计算矩阵项 $K_{12}^{(K)}$**\n\n我们需要计算 $K_{12}^{(K)}$ 的具体分量。\n雅可比矩阵是 $B = \\begin{pmatrix} 3  1 \\\\ 1  3 \\end{pmatrix}$。其行列式为 $\\det(B) = (3)(3) - (1)(1) = 8$。所以，$|\\det(B)| = 8$。\n$B$ 的逆矩阵是 $B^{-1} = \\frac{1}{8}\\begin{pmatrix} 3  -1 \\\\ -1  3 \\end{pmatrix}$。由于 $B$ 是对称的，所以 $(B^{-1})^{T} = B^{-1}$。\n给定的有效扩散张量为 $\\bar{A}_{K} = \\begin{pmatrix} 2  1 \\\\ 1  3 \\end{pmatrix}$。\n参考形函数的梯度为：\n$\\nabla_{\\hat{x}}\\hat{\\phi}_{1} = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}$ 和 $\\nabla_{\\hat{x}}\\hat{\\phi}_{2} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n\n首先，计算中心矩阵乘积 $C = B^{-1} \\bar{A}_{K} B^{-1}$：\n$$C = \\left(\\frac{1}{8}\\begin{pmatrix} 3  -1 \\\\ -1  3 \\end{pmatrix}\\right) \\begin{pmatrix} 2  1 \\\\ 1  3 \\end{pmatrix} \\left(\\frac{1}{8}\\begin{pmatrix} 3  -1 \\\\ -1  3 \\end{pmatrix}\\right)$$\n$$C = \\frac{1}{64} \\begin{pmatrix} 3(2)-1(1)  3(1)-1(3) \\\\ -1(2)+3(1)  -1(1)+3(3) \\end{pmatrix} \\begin{pmatrix} 3  -1 \\\\ -1  3 \\end{pmatrix}$$\n$$C = \\frac{1}{64} \\begin{pmatrix} 5  0 \\\\ 1  8 \\end{pmatrix} \\begin{pmatrix} 3  -1 \\\\ -1  3 \\end{pmatrix} = \\frac{1}{64} \\begin{pmatrix} 5(3)+0(-1)  5(-1)+0(3) \\\\ 1(3)+8(-1)  1(-1)+8(3) \\end{pmatrix}$$\n$$C = \\frac{1}{64} \\begin{pmatrix} 15  -5 \\\\ -5  23 \\end{pmatrix}$$\n现在，我们可以计算 $K_{12}^{(K)}$：\n$$K_{12}^{(K)} = \\frac{8}{2} (\\nabla_{\\hat{x}}\\hat{\\phi}_{1})^{T} C (\\nabla_{\\hat{x}}\\hat{\\phi}_{2})$$\n$$K_{12}^{(K)} = 4 \\begin{pmatrix} -1  -1 \\end{pmatrix} \\left( \\frac{1}{64} \\begin{pmatrix} 15  -5 \\\\ -5  23 \\end{pmatrix} \\right) \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$$\n$$K_{12}^{(K)} = \\frac{4}{64} \\begin{pmatrix} -1  -1 \\end{pmatrix} \\begin{pmatrix} 15  -5 \\\\ -5  23 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$$\n我们来计算矩阵-向量乘积：\n$$\\begin{pmatrix} 15  -5 \\\\ -5  23 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 15 \\\\ -5 \\end{pmatrix}$$\n$$\\begin{pmatrix} -1  -1 \\end{pmatrix} \\begin{pmatrix} 15 \\\\ -5 \\end{pmatrix} = (-1)(15) + (-1)(-5) = -15 + 5 = -10$$\n将此结果代回 $K_{12}^{(K)}$ 的表达式中：\n$$K_{12}^{(K)} = \\frac{4}{64} (-10) = \\frac{1}{16} (-10) = -\\frac{10}{16} = -\\frac{5}{8}$$\n刚度矩阵项 $K_{12}^{(K)}$ 的精确值为 $-\\frac{5}{8}$。",
            "answer": "$$\\boxed{-\\frac{5}{8}}$$"
        },
        {
            "introduction": "有限元法的强大之处在于其灵活性，它不仅限于简单的线性单元。本练习将前一个实践中的概念推广到能够提供更高精度的二阶 (P2) 拉格朗日单元。通过使用重心坐标来定义和积分二阶基函数，你将学习如何构建和处理这些更复杂的单元，并计算单元质量矩阵的一个对角项。",
            "id": "3818768",
            "problem": "考虑标准参考三角形 $K \\subset \\mathbb{R}^{2}$，其顶点为 $(0,0)$、$(1,0)$ 和 $(0,1)$。令 $(\\lambda_{1},\\lambda_{2},\\lambda_{3})$ 表示 $K$ 上的重心坐标，其中 $\\lambda_{1}=x$、$\\lambda_{2}=y$ 且 $\\lambda_{3}=1-x-y$。在有限元方法 (FEM) 的伽辽金法背景下，考虑 $K$ 上的二次拉格朗日单元（也称为 $P_{2}$ 单元），其具有以下六个节点：三个顶点和三条边的中点。\n\n(a) 用重心坐标定义 $K$ 上的六个节点基函数 $\\{\\phi_{i}\\}_{i=1}^{6}$，包括三个边中点基函数。\n\n(b) 使用伽辽金法中的单元质量矩阵定义 $M_{ij}=\\int_{K}\\phi_{i}\\phi_{j}\\,dx$，以及足以确保精确性的最小阶精确多项式求积法则，计算单个标量项 $M_{44}=\\int_{K}\\phi_{4}\\phi_{4}\\,dx$，其中 $\\phi_{4}$ 是与顶点 $(1,0)$ 和 $(0,1)$ 之间的边相关联的边中点基函数。\n\n以精确实数形式给出最终答案。不要四舍五入。",
            "solution": "该问题陈述经核实具有科学依据，是适定且客观的。它为有限元方法中的一个标准问题提供了完整且一致的设定。所有术语都有明确定义，并且存在唯一、有意义的解。没有发现任何缺陷。我们可以开始求解。\n\n该问题分为两部分。部分(a)要求定义参考三角形 $K$ 上的 $6$ 个二次拉格朗日基函数。部分(b)要求计算单元质量矩阵中的一个特定项 $M_{44}$，其定义为 $M_{ij}=\\int_{K}\\phi_{i}\\phi_{j}\\,dx$。\n\n首先，我们确定节点及其与给定重心坐标的关系。参考三角形 $K$ 的顶点为 $(0,0)$、$(1,0)$ 和 $(0,1)$。重心坐标由 $\\lambda_{1}=x$、$\\lambda_{2}=y$ 和 $\\lambda_{3}=1-x-y$ 给出。这些坐标之和始终为 $1$，即 $\\lambda_1+\\lambda_2+\\lambda_3=1$。\n\n$P_2$ 单元的 $6$ 个节点是 $3$ 个顶点和 $3$ 个边的中点。我们来确定每个节点的重心坐标：\n1.  顶点 $V_1 = (1,0)$：此处 $x=1$ 且 $y=0$，所以 $\\lambda_1=1, \\lambda_2=0, \\lambda_3=0$。\n2.  顶点 $V_2 = (0,1)$：此处 $x=0$ 且 $y=1$，所以 $\\lambda_1=0, \\lambda_2=1, \\lambda_3=0$。\n3.  顶点 $V_3 = (0,0)$：此处 $x=0$ 且 $y=0$，所以 $\\lambda_1=0, \\lambda_2=0, \\lambda_3=1$。\n\n边中点节点为：\n4.  节点 $N_4$：顶点 $V_1=(1,0)$ 和 $V_2=(0,1)$ 之间边的中点。其笛卡尔坐标为 $(\\frac{1+0}{2}, \\frac{0+1}{2}) = (\\frac{1}{2}, \\frac{1}{2})$。其重心坐标为 $\\lambda_1=\\frac{1}{2}, \\lambda_2=\\frac{1}{2}, \\lambda_3=1-\\frac{1}{2}-\\frac{1}{2}=0$。\n5.  节点 $N_5$：顶点 $V_2=(0,1)$ 和 $V_3=(0,0)$ 之间边的中点。其笛卡尔坐标为 $(\\frac{0+0}{2}, \\frac{1+0}{2}) = (0, \\frac{1}{2})$。其重心坐标为 $\\lambda_1=0, \\lambda_2=\\frac{1}{2}, \\lambda_3=1-0-\\frac{1}{2}=\\frac{1}{2}$。\n6.  节点 $N_6$：顶点 $V_3=(0,0)$ 和 $V_1=(1,0)$ 之间边的中点。其笛卡尔坐标为 $(\\frac{0+1}{2}, \\frac{0+0}{2}) = (\\frac{1}{2}, 0)$。其重心坐标为 $\\lambda_1=\\frac{1}{2}, \\lambda_2=0, \\lambda_3=1-\\frac{1}{2}-0=\\frac{1}{2}$。\n\n(a) 定义节点基函数 $\\{\\phi_{i}\\}_{i=1}^{6}$。\n\n拉格朗日基函数 $\\phi_i$ 是一个二次多项式，具有性质 $\\phi_i(N_j) = \\delta_{ij}$，其中 $N_j$ 是第 $j$ 个节点，$\\delta_{ij}$ 是克罗内克 delta 符号。$P_2$ 基函数在重心坐标中的一般形式为：\n- 对于与 $\\lambda_k$ 相关联的顶点节点（其中 $\\lambda_k=1$）：$\\phi_k = \\lambda_k(2\\lambda_k - 1)$。\n- 对于与 $\\lambda_k$ 和 $\\lambda_m$ 相关联的顶点之间的边中点节点：$\\phi_{km} = 4\\lambda_k\\lambda_m$。\n\n我们根据上面的节点编号来编号基函数。$\\phi_1, \\phi_2, \\phi_3$ 对应于顶点 $V_1, V_2, V_3$，而 $\\phi_4, \\phi_5, \\phi_6$ 对应于边中点节点 $N_4, N_5, N_6$。\n\n$6$ 个基函数是：\n-   节点 $V_1=(1,0)$ 的基函数，与 $\\lambda_1$ 相关联：\n    $\\phi_1 = \\lambda_1(2\\lambda_1 - 1)$\n-   节点 $V_2=(0,1)$ 的基函数，与 $\\lambda_2$ 相关联：\n    $\\phi_2 = \\lambda_2(2\\lambda_2 - 1)$\n-   节点 $V_3=(0,0)$ 的基函数，与 $\\lambda_3$ 相关联：\n    $\\phi_3 = \\lambda_3(2\\lambda_3 - 1)$\n-   边中点节点 $N_4$（在 $V_1$ 和 $V_2$ 之间）的基函数：\n    $\\phi_4 = 4\\lambda_1\\lambda_2$\n-   边中点节点 $N_5$（在 $V_2$ 和 $V_3$ 之间）的基函数：\n    $\\phi_5 = 4\\lambda_2\\lambda_3$\n-   边中点节点 $N_6$（在 $V_3$ 和 $V_1$ 之间）的基函数：\n    $\\phi_6 = 4\\lambda_3\\lambda_1$\n\n(b) 计算质量矩阵项 $M_{44}=\\int_{K}\\phi_{4}\\phi_{4}\\,dx$。\n\n问题将 $\\phi_4$ 确定为顶点 $(1,0)$ 和 $(0,1)$ 之间边中点节点的基函数。这对应于我们的函数 $\\phi_4 = 4\\lambda_1\\lambda_2$。我们需要计算：\n$$ M_{44} = \\int_{K} \\phi_4^2 \\,dx\\,dy = \\int_{K} (4\\lambda_1\\lambda_2)^2 \\,dx\\,dy = 16 \\int_{K} \\lambda_1^2 \\lambda_2^2 \\,dx\\,dy $$\n通过执行精确的解析积分，可以满足使用最小阶精确多项式求积法则的条件。被积函数 $\\phi_4^2 = 16(xy)^2$ 是一个 $4$ 次多项式。对于数值计算，需要一个对 $4$ 次多项式精确的三角形求积法则。但是，我们可以使用精确公式来计算重心坐标乘积在面积为 $A$ 的三角形 $K$ 上的积分：\n$$ \\int_K \\lambda_1^a \\lambda_2^b \\lambda_3^c \\,dA = 2A \\frac{a! b! c!}{(a+b+c+2)!} $$\n具有顶点 $(0,0)$、$(1,0)$ 和 $(0,1)$ 的标准参考三角形 $K$ 的面积是 $A = \\frac{1}{2}$。将此代入公式可得：\n$$ \\int_K \\lambda_1^a \\lambda_2^b \\lambda_3^c \\,dA = 2\\left(\\frac{1}{2}\\right) \\frac{a! b! c!}{(a+b+c+2)!} = \\frac{a! b! c!}{(a+b+c+2)!} $$\n我们的积分是 $\\int_{K} \\lambda_1^2 \\lambda_2^2 \\,dx\\,dy$。这对应于 $a=2$、$b=2$ 和 $c=0$ 的情况（因为 $\\lambda_3^0=1$）。应用该公式：\n$$ \\int_{K} \\lambda_1^2 \\lambda_2^2 \\lambda_3^0 \\,dx\\,dy = \\frac{2! \\, 2! \\, 0!}{(2+2+0+2)!} = \\frac{2 \\cdot 2 \\cdot 1}{6!} = \\frac{4}{720} = \\frac{1}{180} $$\n现在我们可以计算 $M_{44}$：\n$$ M_{44} = 16 \\int_{K} \\lambda_1^2 \\lambda_2^2 \\,dx\\,dy = 16 \\left(\\frac{1}{180}\\right) = \\frac{16}{180} $$\n通过将分子和分母除以它们的最大公约数 $4$ 来简化分数：\n$$ M_{44} = \\frac{16 \\div 4}{180 \\div 4} = \\frac{4}{45} $$\n这是质量矩阵项的精确值。",
            "answer": "$$\\boxed{\\frac{4}{45}}$$"
        },
        {
            "introduction": "从理论到实践的转换中，我们常常会遇到无法解析求解的积分，尤其是在处理弯曲单元时，此时必须依赖数值求积。本计算练习揭示了其中一个关键的陷阱：不恰当的积分（降阶积分）可能导致非物理的“沙漏”不稳定模式，从而破坏解的稳定性。通过这个练习，你将通过一个具体的编码实例，直观地理解为何为保证模拟的稳健性，选择合适的求积规则是至关重要的。",
            "id": "3134563",
            "problem": "考虑在单个二维等参四边形单元上，使用伽辽金法求解标量扩散算子。边值问题的弱形式由一个双线性形式定义，该形式映射试探函数和检验函数：对于一个标量场 $u(x,y)$ 和一个检验函数 $v(x,y)$，单元刚度矩阵项定义为积分\n$$\nK_{ij} \\;=\\; \\int_{\\Omega_e} a(x,y)\\,\\nabla N_i(x,y)\\cdot\\nabla N_j(x,y)\\,\\mathrm{d}\\Omega,\n$$\n其中 $a(x,y)$ 是一个给定的正标量扩散系数，$\\Omega_e$ 是单元的物理域，而 $N_i(x,y)$ 是单元形函数。假设在整个单元中 $a(x,y)=1$。从参考正方形 $[-1,1]\\times[-1,1]$（局部坐标为 $(\\xi,\\eta)$）到物理单元 $(x(\\xi,\\eta),y(\\xi,\\eta))$ 的等参映射，使用八节点 serendipity 形函数和相应的八个物理节点坐标来定义。\n\n使用的基本原理：\n- 扩散问题的伽辽金法：刚度矩阵项由上述梯度内积的积分定义。\n- 等参有限元：几何和场近似共享相同的形函数；梯度通过映射的雅可比矩阵进行变换。具体来说，如果 $F(\\xi,\\eta)$ 是映射的雅可比矩阵，则 $\\nabla N_i(x,y) = F(\\xi,\\eta)^{-\\top}\\,\\nabla_{\\xi} N_i(\\xi,\\eta)$ 且 $\\mathrm{d}\\Omega = \\det F(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$。\n- 参考域上的数值积分：在 $[-1,1]\\times[-1,1]$ 上的张量积高斯-勒让德法则通过在积分节点处对被积函数求值的加权和来近似积分。\n\n您的任务是构建一个弯曲的八节点 serendipity 四边形单元，并评估积分阶数不足（欠积分）对单元刚度矩阵稳定性的影响。请使用以下几何规格。设角节点的物理坐标为\n$$\n(0,0),\\quad(1,0),\\quad(1,1),\\quad(0,1),\n$$\n按逆时针顺序排列。设边中节点的物理坐标由一个曲率参数 $s\\in[0,1)$ 和一个固定的向内偏移量 $\\delta=0.3$ 定义如下：\n- 底部边中节点：$(0.5,\\; s\\,\\delta)$。\n- 右侧边中节点：$(1 - s\\,\\delta,\\; 0.5)$。\n- 顶部边中节点：$(0.5,\\; 1 - s\\,\\delta)$。\n- 左侧边中节点：$(s\\,\\delta,\\; 0.5)$。\n这种选择产生了一族弯曲单元，随着 $s$ 的增加，单元变得越来越受挤压，同时对于足够小的 $s$ 值，映射的雅可比行列式保持为正。\n\n使用八节点 serendipity 形函数 $N_i(\\xi,\\eta)$ 及其参考梯度 $\\nabla_{\\xi} N_i(\\xi,\\eta)$ 定义单元刚度矩阵 $K\\in\\mathbb{R}^{8\\times 8}$，并计算几何雅可比矩阵 $F(\\xi,\\eta)$ 及其在积分节点处的行列式 $\\det F(\\xi,\\eta)$。通过使用阶数为 $q\\times q$ 的张量积高斯-勒让德积分对变换后的被积函数进行数值积分来组装 $K$。\n\n评估两种积分方案：\n- 欠积分：单点高斯-勒让德积分，即每个方向 $q=1$（节点在 $0$，权重为 $2$）。\n- 精确积分：三点高斯-勒让德积分，即每个方向 $q=3$（节点在 $0$ 处，权重为 $8/9$；在 $\\pm\\sqrt{3/5}$ 处，权重为 $5/9$）。\n\n科学真实性要求：\n- 使用梯度的变换法则和行列式因子，确保积分具有物理意义。\n- 确保在测试案例中雅可比行列式保持为正（选择不会导致单元反转的 $s$ 值）。\n\n定量稳定性评估：\n- 对于每种积分方案和每个曲率 $s$，计算 $K$ 的特征值。当施加本质边界条件时，扩散算子的刚度矩阵在全局层面上是对称正定的（SPD），但在单元层面上没有边界条件时，它是对称半正定的（SPSD），并且至少有一个对应于常数模态的零特征值。欠积分会引入额外的伪假的近零能量模态（沙漏不稳定性）。定义一个近零模态为满足 $\\lambda \\le \\tau\\,\\lambda_{\\max}$ 的任何特征值 $\\lambda$，其中 $\\lambda_{\\max}$ 是 $K$ 的最大特征值，$\\tau=10^{-8}$。\n- 对于每个 $s$，测量欠积分（$q=1$）和精确积分（$q=3$）之间近零模态数量的差异，即计算 $\\Delta n_{\\text{zero}}(s) = n_{\\text{zero}}^{(q=1)}(s) - n_{\\text{zero}}^{(q=3)}(s)$。\n\n测试套件：\n为以下三个曲率参数计算 $\\Delta n_{\\text{zero}}(s)$：\n- 案例1：$s=0$（直边单元；基准）。\n- 案例2：$s=0.3$（中等曲率）。\n- 案例3：$s=0.44$（接近挤压但没有反转的强曲率）。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如：\n$$\n[\\Delta n_{\\text{zero}}(0),\\;\\Delta n_{\\text{zero}}(0.3),\\;\\Delta n_{\\text{zero}}(0.44)].\n$$\n每个条目必须是一个整数。不涉及角度，也不需要物理单位。所有计算都是无量纲的。",
            "solution": "该问题要求分析一个八节点 serendipity 四边形有限元的数值稳定性，特别是检验积分阶数对单元刚度矩阵特征值的影响。通过计算由欠积分引起的伪零能模态（沙漏不稳定性）的数量来评估稳定性。\n\n### 基于原理的方法分解\n\n#### 1. 伽辽金法与单元刚度矩阵\n该问题的基础是针对标量扩散问题的伽辽金法。单元刚度矩阵 $K \\in \\mathbb{R}^{8\\times 8}$ 表示试探函数 $u$ 和检验函数 $v$ 的节点值之间的离散关系。对于扩散系数 $a(x,y)$，其矩阵项 $K_{ij}$ 由双线性形式给出：\n$$\nK_{ij} = \\int_{\\Omega_e} a(x,y)\\,\\nabla N_i(x,y)\\cdot\\nabla N_j(x,y)\\,\\mathrm{d}\\Omega\n$$\n这里，$N_i$ 是形函数（或基函数），$\\Omega_e$ 是单元的物理域，$\\nabla$ 是物理坐标 $(x,y)$ 中的梯度算子。问题指定了常数扩散系数 $a(x,y)=1$。\n\n#### 2. 等参映射\n单元几何由一个从参考正方形域 $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ 到物理域 $(x, y) \\in \\Omega_e$ 的等参映射描述。“等参”一词意味着用于插值解场的形函数同样用于定义几何：\n$$\nx(\\xi, \\eta) = \\sum_{k=1}^{8} N_k(\\xi, \\eta) x_k, \\quad y(\\xi, \\eta) = \\sum_{k=1}^{8} N_k(\\xi, \\eta) y_k\n$$\n其中 $(x_k, y_k)$ 是单元八个节点的物理坐标。此映射需要变换微分算子和积分测度。该变换由映射的雅可比矩阵 $F(\\xi, \\eta)$ 控制：\n$$\nF = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n物理梯度 $\\nabla N_i$ 与参考梯度 $\\nabla_{\\xi} N_i$ 的关系为：\n$$\n\\nabla N_i = F^{-\\top} \\nabla_{\\xi} N_i\n$$\n微分面积元变换为：\n$$\n\\mathrm{d}\\Omega = \\det(F) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta\n$$\n将这些代入刚度矩阵积分，得到一个在参考域上的积分：\n$$\nK_{ij} = \\int_{-1}^{1} \\int_{-1}^{1} \\left( (F^{-\\top} \\nabla_{\\xi} N_i) \\cdot (F^{-\\top} \\nabla_{\\xi} N_j) \\right) \\det(F) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta\n$$\n\n#### 3. 数值积分\n该积分使用 $q \\times q$ 张量积高斯-勒让德积分法则进行数值近似。积分被替换为在离散积分点集 $(\\xi_k, \\eta_l)$ 及其相应权重 $w_k, w_l$ 上对被积函数求值的加权和：\n$$\nK_{ij} \\approx \\sum_{k=1}^{q} \\sum_{l=1}^{q} w_k w_l \\left[ (F^{-\\top} \\nabla_{\\xi} N_i) \\cdot (F^{-\\top} \\nabla_{\\xi} N_j) \\right]_{(\\xi_k, \\eta_l)} \\det(F(\\xi_k, \\eta_l))\n$$\n评估了两种方案：\n- **欠积分 ($q=1$)**：在 $(\\xi,\\eta)=(0,0)$ 处使用单点，权重为 $w_1 w_1 = 4$。这种方法计算成本低，但众所周知其精度不足，并且可能无法检测到某些变形模态，导致单元过于柔性。\n- **精确积分 ($q=3$)**：一个 $3 \\times 3$ 的九点网格。此方案能精确积分高达 5 次的多项式，通常足以计算出此类型单元的稳定刚度矩阵，能够精确捕捉所有有效变形模态的能量。\n\n#### 4. 通过特征值进行稳定性分析\n对于没有边界条件的单元，其刚度矩阵 $K$ 是对称半正定（SPSD）的。它必须至少有一个零特征值，对应于常数场模态（在弹性力学中是刚体模态，或在扩散问题中是常数值模态），因为常数场的梯度为零，因此应变能也为零。\n当积分法则不足以“看到”与某些模态相关的变形时，**沙漏不稳定性**就会出现。这些非物理的零能模态表现为 $K$ 中额外的零（或近零）特征值。\n稳定性通过计算有效为零的特征值 $\\lambda$ 的数量来定量评估，定义条件为 $\\lambda \\le \\tau \\lambda_{\\max}$，其中 $\\lambda_{\\max}$ 是最大特征值，$\\tau=10^{-8}$ 是一个小容差。\n最终的度量指标 $\\Delta n_{\\text{zero}}(s) = n_{\\text{zero}}^{(q=1)}(s) - n_{\\text{zero}}^{(q=3)}(s)$，衡量了对于曲率参数为 $s$ 的单元，由欠积分引入的伪模态数量。\n\n#### 5. 实现策略\n对于每个测试案例 $s$，算法按以下步骤进行：\n1.  根据 $s$ 和固定的偏移量 $\\delta=0.3$ 定义八个节点的物理坐标。\n2.  对于每种积分方案（$q=1$ 和 $q=3$）：\n    a. 为 $K$ 初始化一个 $8 \\times 8$ 的零矩阵。\n    b. 遍历所有积分点 $(\\xi_k, \\eta_l)$ 和权重 $w_k w_l$。\n    c. 在每个点上，计算所有 $i=1,\\dots,8$ 的参考梯度 $\\nabla_{\\xi} N_i$。\n    d. 计算雅可比矩阵 $F$ 及其行列式 $\\det(F)$。\n    e. 计算物理梯度 $\\nabla N_i = F^{-\\top} \\nabla_{\\xi} N_i$。\n    f. 形成内积矩阵 $(\\nabla N_i \\cdot \\nabla N_j)$，并将其乘以 $\\det(F)$ 和积分权重后的贡献加到 $K$ 上。\n3.  对于每个得到的矩阵 $K^{(q)}$，计算其特征值。\n4.  使用指定的阈值计算近零特征值的数量 $n_{\\text{zero}}^{(q)}$。\n5.  计算并存储差异 $\\Delta n_{\\text{zero}}$。\n\n该过程在以下 Python 代码中实现。\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef get_quadrature_rule(q):\n    \"\"\"\n    Returns tensor-product Gauss-Legendre quadrature points and weights\n    for a [-1, 1] x [-1, 1] domain.\n    \"\"\"\n    if q == 1:\n        points_1d = np.array([0.0])\n        weights_1d = np.array([2.0])\n    elif q == 3:\n        points_1d = np.array([-np.sqrt(3.0/5.0), 0.0, np.sqrt(3.0/5.0)])\n        weights_1d = np.array([5.0/9.0, 8.0/9.0, 5.0/9.0])\n    else:\n        raise ValueError(\"Unsupported quadrature order q.\")\n    \n    quad_points = []\n    quad_weights = []\n    for i in range(q):\n        for j in range(q):\n            quad_points.append([points_1d[j], points_1d[i]])\n            quad_weights.append(weights_1d[j] * weights_1d[i])\n    \n    return np.array(quad_points), np.array(quad_weights)\n\ndef get_serendipity_grads(xi, eta):\n    \"\"\"\n    Computes the reference gradients (dN/dxi, dN/deta) for the 8-node\n    serendipity element at a point (xi, eta).\n    Node ordering: 4 corners, then 4 midsides, counter-clockwise from (-1,-1).\n    \"\"\"\n    grad_N_ref = np.zeros((2, 8))\n    \n    # Corner nodes (indices 0-3 correspond to nodes 1-4)\n    xis = np.array([-1.0, 1.0, 1.0, -1.0])\n    etas = np.array([-1.0, -1.0, 1.0, 1.0])\n    for i in range(4):\n        xi_i, eta_i = xis[i], etas[i]\n        term1 = 1.0 + xi_i * xi\n        term2 = 1.0 + eta_i * eta\n        grad_N_ref[0, i] = 0.25 * xi_i * term2 * (2.0 * xi_i * xi + eta_i * eta)\n        grad_N_ref[1, i] = 0.25 * eta_i * term1 * (xi_i * xi + 2.0 * eta_i * eta)\n\n    # Midside nodes (indices 4-7 correspond to nodes 5-8)\n    # Node 4 (ref (0, -1)): bottom edge\n    grad_N_ref[0, 4] = -xi * (1.0 - eta)\n    grad_N_ref[1, 4] = -0.5 * (1.0 - xi**2)\n    \n    # Node 5 (ref (1, 0)): right edge\n    grad_N_ref[0, 5] = 0.5 * (1.0 - eta**2)\n    grad_N_ref[1, 5] = -eta * (1.0 + xi)\n\n    # Node 6 (ref (0, 1)): top edge\n    grad_N_ref[0, 6] = -xi * (1.0 + eta)\n    grad_N_ref[1, 6] = 0.5 * (1.0 - xi**2)\n\n    # Node 7 (ref (-1, 0)): left edge\n    grad_N_ref[0, 7] = -0.5 * (1.0 - eta**2)\n    grad_N_ref[1, 7] = -eta * (1.0 - xi)\n\n    return grad_N_ref\n\ndef compute_n_zero(s, q):\n    \"\"\"\n    Computes the number of near-zero eigenvalues for the stiffness matrix\n    of an element with curvature s, using a q x q quadrature rule.\n    \"\"\"\n    delta = 0.3\n    tau = 1e-8\n    \n    # 1. Define physical node coordinates based on s\n    node_coords = np.zeros((8, 2))\n    # Map reference corners (-1,-1), (1,-1), (1,1), (-1,1)\n    node_coords[0, :] = [0.0, 0.0]        # Corner 1\n    node_coords[1, :] = [1.0, 0.0]        # Corner 2\n    node_coords[2, :] = [1.0, 1.0]        # Corner 3\n    node_coords[3, :] = [0.0, 1.0]        # Corner 4\n    \n    s_delta = s * delta\n    # Map reference midsides (0,-1), (1,0), (0,1), (-1,0)\n    node_coords[4, :] = [0.5, s_delta]        # Midside 5 (bottom)\n    node_coords[5, :] = [1.0 - s_delta, 0.5]  # Midside 6 (right)\n    node_coords[6, :] = [0.5, 1.0 - s_delta]  # Midside 7 (top)\n    node_coords[7, :] = [s_delta, 0.5]        # Midside 8 (left)\n\n    # 2. Get quadrature rule\n    quad_points, quad_weights = get_quadrature_rule(q)\n\n    # 3. Assemble elemental stiffness matrix K\n    K = np.zeros((8, 8))\n    for qp, qw in zip(quad_points, quad_weights):\n        xi, eta = qp[0], qp[1]\n        \n        grad_N_ref = get_serendipity_grads(xi, eta)\n        \n        # Jacobian matrix F_ij = dx_i / d(xi_j)\n        F = np.zeros((2, 2))\n        F[0, 0] = np.dot(grad_N_ref[0, :], node_coords[:, 0]) # dx/dxi\n        F[0, 1] = np.dot(grad_N_ref[1, :], node_coords[:, 0]) # dx/deta\n        F[1, 0] = np.dot(grad_N_ref[0, :], node_coords[:, 1]) # dy/dxi\n        F[1, 1] = np.dot(grad_N_ref[1, :], node_coords[:, 1]) # dy/deta\n\n        detF = np.linalg.det(F)\n        if detF = 1e-12:\n            raise ValueError(f\"Non-positive Jacobian determinant found: {detF}\")\n        \n        # Physical gradients B = F^{-T} G, where G = grad_N_ref\n        F_inv = np.linalg.inv(F)\n        B = np.dot(F_inv.T, grad_N_ref)\n        \n        # Contribution to stiffness matrix integrand\n        integrand_matrix = np.dot(B.T, B)\n        \n        K += integrand_matrix * detF * qw\n    \n    # 4. Eigenvalue analysis\n    try:\n        eigenvalues = np.linalg.eigh(K)[0]\n    except np.linalg.LinAlgError:\n        # This case should not be reached with valid inputs\n        return -1\n\n    # Use absolute values for robustness against floating-point noise\n    eigenvalues = np.sort(np.abs(eigenvalues))\n    lambda_max = eigenvalues[-1]\n\n    if lambda_max  1e-12: # Handles case where K is the zero matrix\n        return 8\n    \n    threshold = tau * lambda_max\n    n_zero = np.sum(eigenvalues = threshold)\n    \n    return int(n_zero)\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the specified test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        0.0,    # Case 1: Straight-sided element\n        0.3,    # Case 2: Moderate curvature\n        0.44    # Case 3: Strong curvature\n    ]\n\n    results = []\n    for s_param in test_cases:\n        # Calculate number of near-zero modes for each quadrature scheme\n        n_zero_q1 = compute_n_zero(s_param, 1)  # Under-integration\n        n_zero_q3 = compute_n_zero(s_param, 3)  # Accurate integration\n        \n        # Compute the difference\n        delta_n_zero = n_zero_q1 - n_zero_q3\n        results.append(delta_n_zero)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# This block is commented out to comply with the execution environment,\n# which calls solve() directly.\n# if __name__ == \"__main__\":\n#     solve()\n\n```",
            "answer": "[3,3,3]"
        }
    ]
}