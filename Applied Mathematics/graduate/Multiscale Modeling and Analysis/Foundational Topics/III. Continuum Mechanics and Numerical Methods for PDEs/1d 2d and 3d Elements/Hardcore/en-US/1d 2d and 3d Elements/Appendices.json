{
    "hands_on_practices": [
        {
            "introduction": "The power of the isoparametric formulation in the Finite Element Method (FEM) lies in its ability to model complex geometries using simple, regular \"parent\" elements. This transformation from a reference square to a physical quadrilateral is governed by the Jacobian matrix, whose determinant, $|J|$, measures the local change in area. This exercise provides hands-on practice in calculating the Jacobian, a crucial skill for verifying the validity of a mesh and for performing numerical integration within the element .",
            "id": "3728980",
            "problem": "A two-dimensional, bilinear, isoparametric quadrilateral finite element is used in a multiscale finite element method (FEM) micro-to-macro coupling step to map a reference square in parametric coordinates $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ to a distorted quadrilateral in the physical plane. For numerical integration, Gauss–Legendre Quadrature (GLQ) with two points per direction is employed, so the integration points are $(\\xi,\\eta)=(\\pm 1/\\sqrt{3},\\pm 1/\\sqrt{3})$. The physical nodal coordinates are dimensionless and given in counterclockwise order consistent with the standard bilinear shape functions:\n$(x_1,y_1)=(0,0)$,\n$(x_2,y_2)=(2.0,0.3)$,\n$(x_3,y_3)=(2.2,1.8)$,\n$(x_4,y_4)=(-0.2,1.5)$.\nStarting from the isoparametric mapping with the standard bilinear shape functions for a quadrilateral element, compute the Jacobian determinant $|J(\\xi,\\eta)|$ at each of the four GLQ points. Using these values, assess whether the mapping is valid everywhere on the element in the sense that $|J(\\xi,\\eta)|>0$ at all GLQ points. Report, as your final answer, the minimum value of $|J(\\xi,\\eta)|$ among the four GLQ points, expressed in an exact analytic form (no rounding).",
            "solution": "The user has provided a valid, well-posed problem from the field of computational mechanics, specifically the Finite Element Method (FEM). All necessary data are provided, and the objective is clearly defined. The problem is scientifically grounded and can be solved using standard principles of isoparametric element formulation.\n\nThe isoparametric mapping relates the physical coordinates $(x, y)$ to the parametric coordinates $(\\xi, \\eta)$ using the same shape functions that are used to interpolate the displacement field. The mapping is given by:\n$$x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i$$\n$$y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i$$\nwhere $(x_i, y_i)$ are the coordinates of the $i$-th node, and $N_i(\\xi, \\eta)$ are the bilinear shape functions for a 4-node quadrilateral element, defined on the reference square $[-1, 1] \\times [-1, 1]$. The shape functions are, in standard counterclockwise order starting from the node at $(\\xi, \\eta) = (-1, -1)$:\n$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n\nThe Jacobian matrix of this transformation is defined as:\n$$J(\\xi, \\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}$$\nThe components of the Jacobian matrix are found by differentiating the mapping equations:\n$\\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} x_i$\n$\\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} x_i$\n$\\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} y_i$\n$\\frac{\\partial y}{\\partial \\eta} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} y_i$\n\nThe derivatives of the shape functions are:\n$\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta)$, $\\frac{\\partial N_2}{\\partial \\xi} = \\frac{1}{4}(1-\\eta)$, $\\frac{\\partial N_3}{\\partial \\xi} = \\frac{1}{4}(1+\\eta)$, $\\frac{\\partial N_4}{\\partial \\xi} = -\\frac{1}{4}(1+\\eta)$\n$\\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi)$, $\\frac{\\partial N_2}{\\partial \\eta} = -\\frac{1}{4}(1+\\xi)$, $\\frac{\\partial N_3}{\\partial \\eta} = \\frac{1}{4}(1+\\xi)$, $\\frac{\\partial N_4}{\\partial \\eta} = \\frac{1}{4}(1-\\xi)$\n\nUsing these derivatives and the given nodal coordinates $(x_1,y_1)=(0,0)$, $(x_2,y_2)=(2, 0.3)$, $(x_3,y_3)=(2.2, 1.8)$, and $(x_4,y_4)=(-0.2, 1.5)$, we compute the four components of the Jacobian matrix. We will convert the decimal values to fractions to preserve exactness: $2.0 = 2$, $0.3 = \\frac{3}{10}$, $2.2 = \\frac{11}{5}$, $1.8 = \\frac{9}{5}$, $-0.2 = -\\frac{1}{5}$, $1.5 = \\frac{3}{2}$.\n\n$\\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4}[-x_1(1-\\eta) + x_2(1-\\eta) + x_3(1+\\eta) - x_4(1+\\eta)]$\n$= \\frac{1}{4}[0 + 2(1-\\eta) + \\frac{11}{5}(1+\\eta) - (-\\frac{1}{5})(1+\\eta)] = \\frac{1}{4}[2 - 2\\eta + \\frac{11}{5} + \\frac{11}{5}\\eta + \\frac{1}{5} + \\frac{1}{5}\\eta]$\n$= \\frac{1}{4}[ (2 + \\frac{12}{5}) + (-2 + \\frac{12}{5})\\eta ] = \\frac{1}{4}[ \\frac{22}{5} + \\frac{2}{5}\\eta ] = \\frac{11}{10} + \\frac{1}{10}\\eta$\n\n$\\frac{\\partial x}{\\partial \\eta} = \\frac{1}{4}[-x_1(1-\\xi) - x_2(1+\\xi) + x_3(1+\\xi) + x_4(1-\\xi)]$\n$= \\frac{1}{4}[0 - 2(1+\\xi) + \\frac{11}{5}(1+\\xi) + (-\\frac{1}{5})(1-\\xi)] = \\frac{1}{4}[(-2 + \\frac{11}{5})(1+\\xi) - \\frac{1}{5}(1-\\xi)]$\n$= \\frac{1}{4}[\\frac{1}{5}(1+\\xi) - \\frac{1}{5}(1-\\xi)] = \\frac{1}{20}[1+\\xi - 1+\\xi] = \\frac{2\\xi}{20} = \\frac{1}{10}\\xi$\n\n$\\frac{\\partial y}{\\partial \\xi} = \\frac{1}{4}[-y_1(1-\\eta) + y_2(1-\\eta) + y_3(1+\\eta) - y_4(1+\\eta)]$\n$= \\frac{1}{4}[0 + \\frac{3}{10}(1-\\eta) + \\frac{9}{5}(1+\\eta) - \\frac{3}{2}(1+\\eta)] = \\frac{1}{4}[\\frac{3}{10} - \\frac{3}{10}\\eta + (\\frac{9}{5} - \\frac{3}{2})(1+\\eta)]$\n$= \\frac{1}{4}[\\frac{3}{10} - \\frac{3}{10}\\eta + \\frac{3}{10}(1+\\eta)] = \\frac{1}{4}[\\frac{3}{10} - \\frac{3}{10}\\eta + \\frac{3}{10} + \\frac{3}{10}\\eta] = \\frac{1}{4}(\\frac{6}{10}) = \\frac{3}{20}$\n\n$\\frac{\\partial y}{\\partial \\eta} = \\frac{1}{4}[-y_1(1-\\xi) - y_2(1+\\xi) + y_3(1+\\xi) + y_4(1-\\xi)]$\n$= \\frac{1}{4}[0 - \\frac{3}{10}(1+\\xi) + \\frac{9}{5}(1+\\xi) + \\frac{3}{2}(1-\\xi)] = \\frac{1}{4}[(-\\frac{3}{10} + \\frac{18}{10})(1+\\xi) + \\frac{3}{2}(1-\\xi)]$\n$= \\frac{1}{4}[\\frac{15}{10}(1+\\xi) + \\frac{3}{2}(1-\\xi)] = \\frac{1}{4}[\\frac{3}{2}(1+\\xi) + \\frac{3}{2}(1-\\xi)] = \\frac{1}{4}\\frac{3}{2}[1+\\xi+1-\\xi] = \\frac{3}{8}(2) = \\frac{3}{4}$\n\nThe Jacobian matrix is thus:\n$$J(\\xi, \\eta) = \\begin{pmatrix} \\frac{11}{10} + \\frac{1}{10}\\eta & \\frac{1}{10}\\xi \\\\ \\frac{3}{20} & \\frac{3}{4} \\end{pmatrix}$$\nThe determinant of the Jacobian, $|J|$, is:\n$$|J(\\xi, \\eta)| = \\det(J) = \\left(\\frac{11}{10} + \\frac{1}{10}\\eta\\right)\\left(\\frac{3}{4}\\right) - \\left(\\frac{1}{10}\\xi\\right)\\left(\\frac{3}{20}\\right)$$\n$$|J(\\xi, \\eta)| = \\frac{33}{40} + \\frac{3}{40}\\eta - \\frac{3}{200}\\xi$$\nA valid mapping requires $|J| > 0$ throughout the element. We check this condition at the four Gauss-Legendre Quadrature (GLQ) points $(\\xi, \\eta) = (\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$. Let $a = 1/\\sqrt{3}$. The four points are $(a, a)$, $(-a, a)$, $(-a, -a)$, and $(a, -a)$.\n\n1.  At $(\\xi, \\eta) = (\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}})$:\n    $|J_1| = \\frac{33}{40} + \\frac{3}{40}\\frac{1}{\\sqrt{3}} - \\frac{3}{200}\\frac{1}{\\sqrt{3}} = \\frac{33}{40} + \\frac{1}{\\sqrt{3}}(\\frac{15}{200} - \\frac{3}{200}) = \\frac{33}{40} + \\frac{12}{200\\sqrt{3}}$\n\n2.  At $(\\xi, \\eta) = (-\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}})$:\n    $|J_2| = \\frac{33}{40} + \\frac{3}{40}\\frac{1}{\\sqrt{3}} - \\frac{3}{200}(-\\frac{1}{\\sqrt{3}}) = \\frac{33}{40} + \\frac{1}{\\sqrt{3}}(\\frac{15}{200} + \\frac{3}{200}) = \\frac{33}{40} + \\frac{18}{200\\sqrt{3}}$\n\n3.  At $(\\xi, \\eta) = (-\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}})$:\n    $|J_3| = \\frac{33}{40} - \\frac{3}{40}\\frac{1}{\\sqrt{3}} - \\frac{3}{200}(-\\frac{1}{\\sqrt{3}}) = \\frac{33}{40} + \\frac{1}{\\sqrt{3}}(-\\frac{15}{200} + \\frac{3}{200}) = \\frac{33}{40} - \\frac{12}{200\\sqrt{3}}$\n\n4.  At $(\\xi, \\eta) = (\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}})$:\n    $|J_4| = \\frac{33}{40} - \\frac{3}{40}\\frac{1}{\\sqrt{3}} - \\frac{3}{200}\\frac{1}{\\sqrt{3}} = \\frac{33}{40} - \\frac{1}{\\sqrt{3}}(\\frac{15}{200} + \\frac{3}{200}) = \\frac{33}{40} - \\frac{18}{200\\sqrt{3}}$\n\nThe constant term $\\frac{33}{40}$ is positive and significantly larger than the variable terms. For instance, $\\frac{18}{200\\sqrt{3}} = \\frac{9}{100\\sqrt{3}} \\approx \\frac{9}{173.2} \\approx 0.052$, while $\\frac{33}{40} = 0.825$. All four Jacobian determinant values are positive, so the mapping is valid at all GLQ points.\n\nTo find the minimum value among these four, we compare them. Since $\\frac{18}{200\\sqrt{3}}$ is a positive quantity, the minimum value is $|J_4|$.\n$|J|_{min} = \\frac{33}{40} - \\frac{18}{200\\sqrt{3}} = \\frac{33}{40} - \\frac{9}{100\\sqrt{3}}$.\nTo express this as a single fraction with a rational denominator, we first rationalize the second term:\n$\\frac{9}{100\\sqrt{3}} = \\frac{9\\sqrt{3}}{100 \\cdot 3} = \\frac{3\\sqrt{3}}{100}$.\nSo, $|J|_{min} = \\frac{33}{40} - \\frac{3\\sqrt{3}}{100}$.\nFinding a common denominator of $200$:\n$|J|_{min} = \\frac{33 \\cdot 5}{200} - \\frac{3\\sqrt{3} \\cdot 2}{200} = \\frac{165}{200} - \\frac{6\\sqrt{3}}{200} = \\frac{165 - 6\\sqrt{3}}{200}$.\nThis is the final exact analytic value for the minimum of the Jacobian determinant at the specified GLQ points.",
            "answer": "$$\\boxed{\\frac{165 - 6\\sqrt{3}}{200}}$$"
        },
        {
            "introduction": "After defining an element's geometry, the next step is to formulate its physical behavior, which is encapsulated in the element stiffness matrix, $\\mathbf{K}_e$. This matrix relates nodal forces to nodal displacements and is computed by integrating a product involving the strain-displacement matrix, $\\mathbf{B}$, and the material constitutive matrix, $\\mathbf{C}$. This practice guides you through the detailed calculation of a stiffness matrix entry, demonstrating how the isoparametric mapping and numerical quadrature work in concert . By comparing the result of Gauss quadrature to the exact analytical integral for an undistorted element, you will gain insight into the accuracy and efficiency of this fundamental FEM procedure.",
            "id": "3728961",
            "problem": "Consider a single two-dimensional bilinear isoparametric quadrilateral finite element in plane stress from the Finite Element Method (FEM). The element occupies a rectangle in physical coordinates with corner nodes at $(0,0)$, $(L_x,0)$, $(L_x,L_y)$, and $(0,L_y)$, where $L_x>0$ and $L_y>0$. The material is homogeneous, isotropic, and linearly elastic with Young’s modulus $E>0$ and Poisson’s ratio $\\nu \\in (-1,0.5)$ under plane stress conditions, and the element thickness is $t>0$. Let $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ denote the natural coordinates, and adopt the standard bilinear shape functions\n$$\nN_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta),\\quad\nN_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta).\n$$\nAssume the usual isoparametric mapping $x(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,x_i$ and $y(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,y_i$, which, for this rectangular element, is affine with a constant Jacobian matrix. In plane stress, use the constitutive law $\\boldsymbol{\\sigma} = \\mathbf{C}\\,\\boldsymbol{\\varepsilon}$ with\n$$\n\\mathbf{C} = \\frac{E}{1-\\nu^2}\n\\begin{pmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{pmatrix},\n$$\ntaking the strain vector in the engineering form $\\boldsymbol{\\varepsilon} = (\\varepsilon_{xx},\\,\\varepsilon_{yy},\\,\\gamma_{xy})^{\\mathsf{T}}$. Let $\\mathbf{B}(\\xi,\\eta)$ denote the strain–displacement matrix for this element. Consider the scalar stiffness entry $k_{11}$ corresponding to the $x$-displacement degree of freedom at node $1$, defined as the $(1,1)$ component of the element stiffness matrix\n$$\nk_{11} = \\int_{\\Omega_e} \\left[ \\mathbf{B}(\\mathbf{x})^{\\mathsf{T}} \\mathbf{C}\\, \\mathbf{B}(\\mathbf{x}) \\right]_{(u_1,u_1)}\\, d\\Omega,\n$$\nwhere the subscript $(u_1,u_1)$ denotes the scalar entry associated with the $x$-displacement of node $1$ interacting with itself.\n\nStarting only from the definitions above and the kinematics of small-strain linear elasticity, perform the following:\n- Derive the strain–displacement column of $\\mathbf{B}$ associated with the $x$-displacement at node $1$ in terms of $L_x$, $L_y$, $\\xi$, and $\\eta$.\n- Use two-point Gauss quadrature in each direction (that is, $2\\times 2$ Gauss points with $\\xi,\\eta = \\pm 1/\\sqrt{3}$ and unit weights) to evaluate $k_{11}$ via the isoparametric mapping and show that this numerical quadrature yields the exact value for this affine mapping.\n- Compute the same integral exactly by analytical integration over $[-1,1]\\times[-1,1]$ and demonstrate the equality with the Gauss quadrature result by identifying the polynomial degree of the integrand.\n\nExpress your final answer as a single closed-form symbolic expression for $k_{11}$ in terms of $E$, $\\nu$, $t$, $L_x$, and $L_y$. Report only the symbolic expression and do not include units. No numerical rounding is required.",
            "solution": "The user has provided a problem from the domain of the Finite Element Method (FEM) in solid mechanics. The task is to compute a specific element stiffness matrix entry, $k_{11}$, for a bilinear quadrilateral element under plane stress conditions. The problem requires a multi-step derivation, including the use of both numerical quadrature and analytical integration, and a justification for their equivalence.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens:**\n- **Element Type**: A single two-dimensional ($2$D) bilinear isoparametric quadrilateral finite element.\n- **Physical Coordinates**: Corner nodes at $(x_1, y_1)=(0,0)$, $(x_2, y_2)=(L_x,0)$, $(x_3, y_3)=(L_x,L_y)$, and $(x_4, y_4)=(0,L_y)$, with $L_x > 0$ and $L_y > 0$.\n- **Natural Coordinates**: $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$.\n- **Shape Functions**:\n  - $N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n  - $N_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n  - $N_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n  - $N_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n- **Material Properties**: Homogeneous, isotropic, linearly elastic material with Young's modulus $E > 0$, Poisson's ratio $\\nu \\in (-1, 0.5)$, and thickness $t > 0$.\n- **Constitutive Law**: Plane stress condition, $\\boldsymbol{\\sigma} = \\mathbf{C}\\,\\boldsymbol{\\varepsilon}$, with the strain vector $\\boldsymbol{\\varepsilon} = (\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy})^{\\mathsf{T}}$ and the constitutive matrix\n$$\n\\mathbf{C} = \\frac{E}{1-\\nu^2}\n\\begin{pmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{pmatrix}\n$$\n- **Stiffness Matrix Entry**: The $(1,1)$ component of the element stiffness matrix $\\mathbf{K}_e$, denoted as $k_{11}$, is given by\n$$\nk_{11} = \\int_{\\Omega_e} \\left[ \\mathbf{B}(\\mathbf{x})^{\\mathsf{T}} \\mathbf{C}\\, \\mathbf{B}(\\mathbf{x}) \\right]_{(u_1,u_1)}\\, d\\Omega\n$$\nwhere the integration is over the element domain $\\Omega_e$.\n\n**1.2. Validate Using Extracted Givens:**\n- **Scientifically Grounded**: The problem is formulated entirely within the standard, well-established theory of linear elasticity and the Finite Element Method. All provided equations (shape functions, constitutive matrix, stiffness integral) are textbook definitions.\n- **Well-Posed**: The problem provides all necessary data and relationships to uniquely determine the value of $k_{11}$. The instructions are clear and lead to a single, deterministic result.\n- **Objective**: The problem is stated using formal, unambiguous mathematical and engineering language.\n- **Completeness**: The setup is complete. The geometry, material model, kinematic assumptions (isoparametric mapping), and the specific quantity to be calculated are all explicitly defined.\n- **Conclusion**: The problem is valid. It is a standard, albeit detailed, exercise in computational mechanics.\n\n### Step 2: Derivation and Solution\n\nThe solution will proceed by first deriving the strain-displacement matrix $\\mathbf{B}$, then calculating the stiffness entry $k_{11}$ using both Gauss quadrature and analytical integration, and finally confirming their equivalence.\n\n**2.1. Isoparametric Mapping and Jacobian**\n\nThe isoparametric mapping relates physical coordinates $(x,y)$ to natural coordinates $(\\xi,\\eta)$:\n$x(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) x_i$ and $y(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) y_i$.\nSubstituting the nodal coordinates:\n$x(\\xi,\\eta) = N_2(\\xi,\\eta) L_x + N_3(\\xi,\\eta) L_x = \\frac{L_x}{4}[(1+\\xi)(1-\\eta) + (1+\\xi)(1+\\eta)] = \\frac{L_x}{4}(1+\\xi)(2) = \\frac{L_x}{2}(1+\\xi)$.\n$y(\\xi,\\eta) = N_3(\\xi,\\eta) L_y + N_4(\\xi,\\eta) L_y = \\frac{L_y}{4}[(1+\\xi)(1+\\eta) + (1-\\xi)(1+\\eta)] = \\frac{L_y}{4}(1+\\eta)(2) = \\frac{L_y}{2}(1+\\eta)$.\nThis is an affine mapping. The Jacobian matrix $\\mathbf{J}$ of this transformation is:\n$$\n\\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{L_x}{2} & 0 \\\\ 0 & \\frac{L_y}{2} \\end{pmatrix}\n$$\nThe Jacobian matrix is constant, which simplifies the calculations considerably. The determinant is $\\det(\\mathbf{J}) = \\frac{L_x L_y}{4}$. The inverse Jacobian is:\n$$\n\\mathbf{J}^{-1} = \\begin{pmatrix} \\frac{2}{L_x} & 0 \\\\ 0 & \\frac{2}{L_y} \\end{pmatrix}\n$$\n\n**2.2. Strain-Displacement Matrix Column for $u_1$**\n\nThe strain vector $\\boldsymbol{\\varepsilon} = (\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy})^{\\mathsf{T}}$ is related to the nodal displacement vector $\\mathbf{d}$ by $\\boldsymbol{\\varepsilon} = \\mathbf{B} \\mathbf{d}$. The matrix $\\mathbf{B}$ is composed of blocks $\\mathbf{B}_i$ for each node $i$: $\\mathbf{B} = [\\mathbf{B}_1, \\mathbf{B}_2, \\mathbf{B}_3, \\mathbf{B}_4]$. The block for node $i$ is:\n$$\n\\mathbf{B}_i = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} & 0 \\\\ 0 & \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x} \\end{pmatrix}\n$$\nWe need the first column of $\\mathbf{B}_1$, which is associated with the degree of freedom $u_1$. Let's call this column $\\mathbf{b}_{u_1}$:\n$$\n\\mathbf{b}_{u_1} = \\begin{pmatrix} \\frac{\\partial N_1}{\\partial x} \\\\ 0 \\\\ \\frac{\\partial N_1}{\\partial y} \\end{pmatrix}\n$$\nTo find the derivatives with respect to physical coordinates, we use the chain rule:\n$$\n\\begin{pmatrix} \\frac{\\partial N_1}{\\partial x} \\\\ \\frac{\\partial N_1}{\\partial y} \\end{pmatrix} = \\mathbf{J}^{-T} \\begin{pmatrix} \\frac{\\partial N_1}{\\partial \\xi} \\\\ \\frac{\\partial N_1}{\\partial \\eta} \\end{pmatrix}\n$$\nFirst, we compute the derivatives of $N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$:\n$\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta)$ and $\\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi)$.\nNow, applying the inverse Jacobian (note that $\\mathbf{J}$ is symmetric so $\\mathbf{J}^{-T} = \\mathbf{J}^{-1}$):\n$$\n\\begin{pmatrix} \\frac{\\partial N_1}{\\partial x} \\\\ \\frac{\\partial N_1}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{L_x} & 0 \\\\ 0 & \\frac{2}{L_y} \\end{pmatrix} \\begin{pmatrix} -\\frac{1}{4}(1-\\eta) \\\\ -\\frac{1}{4}(1-\\xi) \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{2L_x}(1-\\eta) \\\\ -\\frac{1}{2L_y}(1-\\xi) \\end{pmatrix}\n$$\nThus, the required column of the strain-displacement matrix is:\n$$\n\\mathbf{b}_{u_1}(\\xi,\\eta) = \\begin{pmatrix} -\\frac{1}{2L_x}(1-\\eta) \\\\ 0 \\\\ -\\frac{1}{2L_y}(1-\\xi) \\end{pmatrix}\n$$\n\n**2.3. Calculation of $k_{11}$**\n\nThe stiffness coefficient $k_{11}$ is given by the integral of the $(1,1)$ component of the integrand matrix $\\mathbf{B}^{\\mathsf{T}} \\mathbf{C} \\mathbf{B}$. This component is $\\mathbf{b}_{u_1}^{\\mathsf{T}} \\mathbf{C} \\mathbf{b}_{u_1}$. The integral is performed over the element volume:\n$$\nk_{11} = \\int_{\\Omega_e} \\mathbf{b}_{u_1}^{\\mathsf{T}} \\mathbf{C} \\mathbf{b}_{u_1} \\, d\\Omega = \\int_{-1}^{1}\\int_{-1}^{1} \\mathbf{b}_{u_1}^{\\mathsf{T}}(\\xi,\\eta) \\mathbf{C} \\mathbf{b}_{u_1}(\\xi,\\eta) \\, t \\det(\\mathbf{J}) \\, d\\xi d\\eta\n$$\nLet's first compute the quadratic form $\\mathbf{b}_{u_1}^{\\mathsf{T}} \\mathbf{C} \\mathbf{b}_{u_1}$:\n$$\n\\mathbf{b}_{u_1}^{\\mathsf{T}} \\mathbf{C} \\mathbf{b}_{u_1} = \\begin{pmatrix} -\\frac{1-\\eta}{2L_x} & 0 & -\\frac{1-\\xi}{2L_y} \\end{pmatrix} \\frac{E}{1-\\nu^2} \\begin{pmatrix} 1 & \\nu & 0 \\\\ \\nu & 1 & 0 \\\\ 0 & 0 & \\frac{1-\\nu}{2} \\end{pmatrix} \\begin{pmatrix} -\\frac{1-\\eta}{2L_x} \\\\ 0 \\\\ -\\frac{1-\\xi}{2L_y} \\end{pmatrix}\n$$\n$$\n= \\frac{E}{1-\\nu^2} \\left[ \\left(-\\frac{1-\\eta}{2L_x}\\right)^2 \\cdot 1 + \\left(-\\frac{1-\\xi}{2L_y}\\right)^2 \\cdot \\frac{1-\\nu}{2} \\right] = \\frac{E}{1-\\nu^2} \\left[ \\frac{(1-\\eta)^2}{4L_x^2} + \\frac{(1-\\xi)^2(1-\\nu)}{8L_y^2} \\right]\n$$\nNow, let $I(\\xi, \\eta)$ be the full integrand for the stiffness coefficient:\n$$\nI(\\xi, \\eta) = \\mathbf{b}_{u_1}^{\\mathsf{T}} \\mathbf{C} \\mathbf{b}_{u_1} \\cdot t \\det(\\mathbf{J}) = \\frac{E t}{1-\\nu^2} \\left[ \\frac{(1-\\eta)^2}{4L_x^2} + \\frac{(1-\\xi)^2(1-\\nu)}{8L_y^2} \\right] \\frac{L_x L_y}{4}\n$$\n$$\nI(\\xi, \\eta) = \\frac{E t L_x L_y}{4(1-\\nu^2)} \\left[ \\frac{(1-\\eta)^2}{4L_x^2} + \\frac{(1-\\xi)^2(1-\\nu)}{8L_y^2} \\right]\n$$\n\n**2.4. Evaluation by Gauss Quadrature**\n\nWe use a $2 \\times 2$ Gauss quadrature rule. The integration points $(\\xi_i, \\eta_j)$ are $(\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$, and all weights are $w_i w_j = 1$.\n$$\nk_{11} \\approx \\sum_{i=1}^{2} \\sum_{j=1}^{2} w_i w_j I(\\xi_i, \\eta_j) = I(-\\frac{1}{\\sqrt{3}},-\\frac{1}{\\sqrt{3}}) + I(\\frac{1}{\\sqrt{3}},-\\frac{1}{\\sqrt{3}}) + I(-\\frac{1}{\\sqrt{3}},\\frac{1}{\\sqrt{3}}) + I(\\frac{1}{\\sqrt{3}},\\frac{1}{\\sqrt{3}})\n$$\nLet's evaluate the sum of the polynomial terms at the Gauss points:\nFor any function $f(\\zeta) = (1-c\\zeta)^2$, the sum over the Gauss points $\\zeta_k = \\pm 1/\\sqrt{3}$ is:\n$\\sum_{k=1}^2 f(\\zeta_k) = (1 - c(-1/\\sqrt{3}))^2 + (1 - c(1/\\sqrt{3}))^2 = (1+c/\\sqrt{3})^2 + (1-c/\\sqrt{3})^2 = (1+2c/\\sqrt{3}+c^2/3) + (1-2c/\\sqrt{3}+c^2/3) = 2 + 2c^2/3$.\nFor our terms, we have $(1-\\eta)^2$ with $c=1$ and $(1-\\xi)^2$ with $c=1$.\nThe sum $\\sum_{j=1}^{2} (1-\\eta_j)^2 = 2 + 2/3 = 8/3$.\nThe sum $\\sum_{i=1}^{2} (1-\\xi_i)^2 = 2 + 2/3 = 8/3$.\nLet $K = \\frac{E t L_x L_y}{4(1-\\nu^2)}$. The quadrature sum is:\n$$\nk_{11} = \\sum_{j=1}^{2} \\sum_{i=1}^{2} K \\left[ \\frac{(1-\\eta_j)^2}{4L_x^2} + \\frac{(1-\\xi_i)^2(1-\\nu)}{8L_y^2} \\right]\n$$\n$$\n= K \\left[ \\frac{2}{4L_x^2} \\sum_{j=1}^{2} (1-\\eta_j)^2 + \\frac{2(1-\\nu)}{8L_y^2} \\sum_{i=1}^{2} (1-\\xi_i)^2 \\right] = K \\left[ \\frac{1}{2L_x^2} \\left(\\frac{8}{3}\\right) + \\frac{1-\\nu}{4L_y^2} \\left(\\frac{8}{3}\\right) \\right]\n$$\n$$\n= K \\left[ \\frac{4}{3L_x^2} + \\frac{2(1-\\nu)}{3L_y^2} \\right] = \\frac{E t L_x L_y}{4(1-\\nu^2)} \\left[ \\frac{4}{3L_x^2} + \\frac{2(1-\\nu)}{3L_y^2} \\right]\n$$\n$$\n= \\frac{E t}{12(1-\\nu^2)} \\left[ \\frac{4L_x L_y}{L_x^2} + \\frac{2(1-\\nu)L_x L_y}{L_y^2} \\right] = \\frac{E t}{6(1-\\nu^2)} \\left[ \\frac{2L_y}{L_x} + \\frac{(1-\\nu)L_x}{L_y} \\right]\n$$\n\n**2.5. Evaluation by Analytical Integration**\n\nWe now compute the integral analytically:\n$$\nk_{11} = \\int_{-1}^{1}\\int_{-1}^{1} I(\\xi, \\eta) \\, d\\xi d\\eta = \\frac{E t L_x L_y}{4(1-\\nu^2)} \\int_{-1}^{1}\\int_{-1}^{1} \\left[ \\frac{(1-\\eta)^2}{4L_x^2} + \\frac{(1-\\xi)^2(1-\\nu)}{8L_y^2} \\right] d\\xi d\\eta\n$$\nWe integrate each term separately. We need the integral $\\int_{-1}^{1} (1-z)^2 dz$:\n$$\n\\int_{-1}^{1} (1-2z+z^2) dz = \\left[ z - z^2 + \\frac{z^3}{3} \\right]_{-1}^{1} = \\left(1-1+\\frac{1}{3}\\right) - \\left(-1-1-\\frac{1}{3}\\right) = \\frac{1}{3} - (-\\frac{7}{3}) = \\frac{8}{3}\n$$\nNow for the double integrals:\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} (1-\\eta)^2 d\\xi d\\eta = \\left( \\int_{-1}^{1} d\\xi \\right) \\left( \\int_{-1}^{1} (1-\\eta)^2 d\\eta \\right) = 2 \\cdot \\frac{8}{3} = \\frac{16}{3}\n$$\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} (1-\\xi)^2 d\\xi d\\eta = \\left( \\int_{-1}^{1} d\\eta \\right) \\left( \\int_{-1}^{1} (1-\\xi)^2 d\\xi \\right) = 2 \\cdot \\frac{8}{3} = \\frac{16}{3}\n$$\nSubstituting these results back into the expression for $k_{11}$:\n$$\nk_{11} = \\frac{E t L_x L_y}{4(1-\\nu^2)} \\left[ \\frac{1}{4L_x^2}\\left(\\frac{16}{3}\\right) + \\frac{1-\\nu}{8L_y^2}\\left(\\frac{16}{3}\\right) \\right] = \\frac{E t L_x L_y}{4(1-\\nu^2)} \\left[ \\frac{4}{3L_x^2} + \\frac{2(1-\\nu)}{3L_y^2} \\right]\n$$\nThis is the same expression obtained from the Gauss quadrature calculation, which simplifies to:\n$$\nk_{11} = \\frac{E t}{6(1-\\nu^2)} \\left( \\frac{2L_y}{L_x} + \\frac{(1-\\nu)L_x}{L_y} \\right)\n$$\n\n**2.6. Equivalence of Quadrature and Analytical Integration**\n\nThe integrand $I(\\xi, \\eta)$ is a polynomial in $\\xi$ and $\\eta$. Specifically, it is a sum of a quadratic polynomial in $\\eta$ (of degree $2$) and a quadratic polynomial in $\\xi$ (of degree $2$). A $2$-point Gauss quadrature rule in one dimension integrates polynomials of degree up to $2n-1 = 2(2)-1 = 3$ exactly. A $2 \\times 2$ Gauss product rule therefore exactly integrates any polynomial of the form $P(\\xi, \\eta) = \\sum_{i=0}^3 \\sum_{j=0}^3 a_{ij} \\xi^i \\eta^j$. Since our integrand is of degree $2$ in each variable, it falls within the class of polynomials that are integrated exactly by the $2 \\times 2$ Gauss rule. This is a direct consequence of the element having a constant Jacobian, which ensures the integrand is a polynomial rather than a more complex rational function. Thus, the numerical quadrature yields the exact analytical result.",
            "answer": "$$\\boxed{\\frac{E t}{6(1-\\nu^2)} \\left( \\frac{2L_y}{L_x} + \\frac{(1-\\nu)L_x}{L_y} \\right)}$$"
        },
        {
            "introduction": "While the isoparametric formulation accommodates distorted elements, severe distortion can degrade the accuracy and stability of the numerical solution. The geometric quality of an element is directly reflected in the conditioning of its stiffness matrix; a highly skewed element leads to an ill-conditioned matrix that is sensitive to numerical errors. In this culminating practice, you will computationally investigate the relationship between element distortion and numerical stability by calculating the matrix condition number for a series of increasingly skewed elements, developing a practical understanding of why maintaining good mesh quality is critical in finite element analysis .",
            "id": "3728939",
            "problem": "Consider the scalar diffusion problem in two dimensions defined by the partial differential equation $-\\nabla \\cdot (\\kappa \\nabla u) = f$ on a domain $\\Omega \\subset \\mathbb{R}^2$ with homogeneous Dirichlet boundary conditions on a portion of the boundary. Use the standard Galerkin finite element method with bilinear quadrilateral elements (also called $Q_4$ elements) in an isoparametric formulation. Assume constant scalar conductivity $\\kappa = 1$.\n\nYou are to analyze how geometric distortion of a single $Q_4$ element affects the conditioning of its stiffness matrix. Start from the energy principle for diffusion, which states that the weak form arises from the stationary point of the functional $E(u) = \\frac{1}{2} \\int_{\\Omega} \\kappa (\\nabla u \\cdot \\nabla u) \\, d\\Omega - \\int_{\\Omega} f u \\, d\\Omega$ under admissible variations. Derive the discrete form using bilinear shape functions defined over the reference square element with natural coordinates $(\\xi,\\eta) \\in [-1, 1] \\times [-1, 1]$, and map to the physical element via isoparametric interpolation. The stiffness matrix for a single element is given by the integral $K_{ij} = \\int_{\\Omega_e} \\kappa \\, \\nabla N_i \\cdot \\nabla N_j \\, d\\Omega$, where $N_i$ are the bilinear shape functions. Evaluate this integral numerically using tensor-product Gaussian quadrature with $2\\times 2$ points, and compute gradients via the chain rule using the Jacobian matrix of the isoparametric mapping.\n\nTo prevent the known nullspace associated with the partition of unity of shape functions (which makes the element-level stiffness matrix singular), impose a homogeneous Dirichlet boundary condition at node $1$ by eliminating the corresponding degree of freedom. That is, form the reduced stiffness matrix by removing the row and column associated with node $1$.\n\nDefine a family of increasingly skewed quadrilateral elements by fixing three nodes and moving the top-right node horizontally by a skew parameter $d$. Specifically, set nodal coordinates\n- $x_1 = 0$, $y_1 = 0$,\n- $x_2 = 1$, $y_2 = 0$,\n- $x_3 = 1 + d$, $y_3 = 1$,\n- $x_4 = 0$, $y_4 = 1$.\nFor each given $d$, compute the reduced element stiffness matrix $K_{\\text{red}}$ via $2\\times 2$ Gaussian quadrature on the reference square, and then compute its spectral condition number defined as $\\kappa_2(K_{\\text{red}}) = \\|K_{\\text{red}}\\|_2 \\cdot \\|K_{\\text{red}}^{-1}\\|_2$. If the mapping becomes invalid at any quadrature point (that is, if the determinant of the Jacobian $\\det J$ is nonpositive or smaller than a small tolerance indicating near-degeneracy), treat the stiffness matrix as singular and return the condition number as $\\infty$.\n\nYour program must implement the following steps for each test case:\n- Construct $K$ by numerical quadrature using bilinear shape functions on the reference element and the isoparametric mapping to the physical element with the specified nodal coordinates.\n- Apply the homogeneous Dirichlet boundary condition at node $1$ by removing the corresponding row and column to obtain $K_{\\text{red}}$.\n- Compute the spectral condition number $\\kappa_2(K_{\\text{red}})$; if the matrix is singular or the mapping is invalid based on the Jacobian determinant check, output $\\infty$ for that case.\n\nUse the following test suite of skew parameters:\n- $d = 0.0$ (baseline square element),\n- $d = 0.3$ (moderate skew),\n- $d = 0.6$ (high skew),\n- $d = 0.9$ (very high skew),\n- $d = -0.8$ (negative skew near degeneracy but still convex).\n\nAll calculations are strictly dimensionless in this setup. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[r_1,r_2,r_3,r_4,r_5]$), where each $r_i$ is the condition number for the corresponding $d$ value, rounded to six decimal places. If a case is deemed singular or invalid based on the Jacobian determinant criterion, print the literal infinity as produced by the programming language for floating-point values in place of the number (for example, $[\\infty, \\dots]$).",
            "solution": "The user-provided problem requires an analysis of the effect of geometric distortion on the conditioning of the finite element stiffness matrix for a 2D scalar diffusion problem. The problem is well-posed, scientifically sound, and provides all necessary data for a unique solution. We will proceed with a full derivation and implementation.\n\nThe analysis is based on the weak form of the diffusion equation, $-\\nabla \\cdot (\\kappa \\nabla u) = f$, discretized using the Galerkin finite element method with isoparametric bilinear quadrilateral ($Q_4$) elements.\n\n### 1. Weak Form and Galerkin Discretization\n\nThe governing partial differential equation is the stationary point of the energy functional:\n$$\nE(u) = \\frac{1}{2} \\int_{\\Omega} \\kappa (\\nabla u \\cdot \\nabla u) \\, d\\Omega - \\int_{\\Omega} f u \\, d\\Omega\n$$\nThe weak form is found by taking the first variation of $E(u)$ with respect to a test function $v$ and setting it to zero:\n$$\n\\delta E = \\int_{\\Omega} \\kappa (\\nabla u \\cdot \\nabla v) \\, d\\Omega - \\int_{\\Omega} f v \\, d\\Omega = 0\n$$\nIn the Galerkin method, we approximate the solution $u(x,y)$ over the domain by a linear combination of basis functions $N_i(x,y)$:\n$$\nu(x,y) \\approx u_h(x,y) = \\sum_{j=1}^{n} u_j N_j(x,y)\n$$\nwhere $u_j$ are the unknown coefficients (nodal values) and $n$ is the number of nodes in the element. The test functions $v$ are chosen from the same space as the basis functions, i.e., $v = N_i(x,y)$. Substituting this into the weak form for a single element domain $\\Omega_e$ yields the element-level system of equations:\n$$\n\\sum_{j=1}^{n} \\left( \\int_{\\Omega_e} \\kappa \\nabla N_i \\cdot \\nabla N_j \\, d\\Omega \\right) u_j = \\int_{\\Omega_e} f N_i \\, d\\Omega\n$$\nThis is of the form $K^e \\mathbf{u} = \\mathbf{f}^e$, where the element stiffness matrix $K^e$ has entries:\n$$\nK_{ij}^e = \\int_{\\Omega_e} \\kappa \\nabla N_i \\cdot \\nabla N_j \\, d\\Omega\n$$\nFor this problem, the conductivity $\\kappa$ is a constant set to $1$.\n\n### 2. Isoparametric Bilinear Element\n\nWe use a $Q_4$ element, which is a quadrilateral with four nodes. The formulation is isoparametric, meaning the same basis functions are used to interpolate both the geometry and the solution field.\n\n**Reference Element:**\nThe calculations are performed on a reference square element defined in a natural coordinate system $(\\xi, \\eta)$, where $\\xi, \\eta \\in [-1, 1]$. The four nodes are at $(\\pm 1, \\pm 1)$. The bilinear shape functions are:\n\\begin{align*}\nN_1(\\xi, \\eta) &= \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_2(\\xi, \\eta) &= \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_3(\\xi, \\eta) &= \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_4(\\xi, \\eta) &= \\frac{1}{4}(1-\\xi)(1+\\eta)\n\\end{align*}\n\n**Coordinate Mapping:**\nThe physical coordinates $(x,y)$ of any point within the element are mapped from the natural coordinates $(\\xi, \\eta)$ using the nodal coordinates $(x_i, y_i)$:\n$$\nx(\\xi, \\eta) = \\sum_{i=1}^{4} x_i N_i(\\xi, \\eta) \\quad \\text{and} \\quad y(\\xi, \\eta) = \\sum_{i=1}^{4} y_i N_i(\\xi, \\eta)\n$$\n\n**Gradient Transformation:**\nTo evaluate the stiffness matrix, we need the gradients of the shape functions with respect to the physical coordinates $(x,y)$. These are obtained from the gradients with respect to the natural coordinates $(\\xi, \\eta)$ using the chain rule:\n$$\n\\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix} = \\mathbf{J} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix}\n$$\nwhere $\\mathbf{J}$ is the Jacobian matrix of the transformation. Inverting this relationship gives the physical gradients:\n$$\n\\nabla_{x,y} N_i = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix} = \\mathbf{J}^{-1} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{pmatrix} = \\mathbf{J}^{-1} \\nabla_{\\xi, \\eta} N_i\n$$\nNote that the problem states the Jacobian as $J_{ij} = \\partial x_i / \\partial \\xi_j$, which is standard. The formula above for the gradient transformation is often written with $J^{-T}$, but given the definition in the solution code, this formulation is consistent.\n\n### 3. Stiffness Matrix Calculation and Numerical Quadrature\n\nThe integral for the stiffness matrix must be transformed to the reference coordinate system. The differential area element transforms as $d\\Omega = dx\\,dy = \\det(\\mathbf{J}) \\, d\\xi\\, d\\eta$. The stiffness matrix entry becomes:\n$$\nK_{ij}^e = \\int_{-1}^{1} \\int_{-1}^{1} \\kappa \\left( \\nabla_{x,y} N_i \\cdot \\nabla_{x,y} N_j \\right) \\det(\\mathbf{J}) \\, d\\xi \\, d\\eta\n$$\nThe dot product can be written as $(\\nabla_{x,y} N_i)^T (\\nabla_{x,y} N_j)$. The integral is generally too complex to be evaluated analytically for a distorted element and is thus approximated using numerical quadrature. The problem specifies a $2 \\times 2$ tensor-product Gaussian quadrature scheme. The integral is approximated as a weighted sum of the integrand evaluated at specific Gauss points $(\\xi_k, \\eta_k)$:\n$$\nK_{ij}^e \\approx \\sum_{k=1}^{4} w_k \\kappa \\left[ (\\nabla_{x,y} N_i)^T (\\nabla_{x,y} N_j) \\det(\\mathbf{J}) \\right]_{(\\xi_k, \\eta_k)}\n$$\nFor a $2 \\times 2$ scheme, the four Gauss points are $(\\pm a, \\pm a)$ where $a=1/\\sqrt{3}$, and all weights $w_k$ are equal to $1$.\n\nThe geometric validity of the mapping depends on the sign of the Jacobian determinant, $\\det(\\mathbf{J})$. If $\\det(\\mathbf{J}) \\le 0$ at any point inside the element, the mapping is degenerate or orientation-reversed, rendering the element invalid. We check this condition at each Gauss point.\n\n### 4. Boundary Conditions, Matrix Reduction, and Conditioning\n\nThe element stiffness matrix $K^e$ is always singular for a diffusion problem because it has a nullspace corresponding to a constant potential (i.e., $K^e \\mathbf{c} = 0$ if $\\mathbf{c}$ is a vector of ones). To obtain a solvable system, boundary conditions must be applied. The problem prescribes a homogeneous Dirichlet condition at node $1$ ($u_1 = 0$). This is implemented by eliminating the first row and first column of the $4 \\times 4$ matrix $K^e$ to form a $3 \\times 3$ reduced stiffness matrix, $K_{\\text{red}}$.\n\nFor a non-degenerate element, $K_{\\text{red}}$ is symmetric and positive definite, and thus invertible. The conditioning of this matrix is a measure of its sensitivity to perturbations. We use the spectral condition number, $\\kappa_2(A)$, defined as:\n$$\n\\kappa_2(K_{\\text{red}}) = \\|K_{\\text{red}}\\|_2 \\cdot \\|K_{\\text{red}}^{-1}\\|_2 = \\frac{\\sigma_{\\max}(K_{\\text{red}})}{\\sigma_{\\min}(K_{\\text{red}})}\n$$\nwhere $\\sigma$ denotes the singular values of the matrix. For a symmetric positive definite matrix, this is the ratio of the largest to the smallest eigenvalue. A high condition number indicates that the element is poorly shaped, which can lead to large numerical errors in a full FEM simulation.\n\nThe algorithm for each skew parameter $d$ is:\n1.  Define the physical nodal coordinates based on $d$.\n2.  Initialize a $4 \\times 4$ element stiffness matrix $K^e$ to zeros.\n3.  Loop through the four $2 \\times 2$ Gauss points $(\\xi_k, \\eta_k)$:\n    a.  Evaluate the derivatives of the shape functions, $\\nabla_{\\xi, \\eta} N_i$, at the current Gauss point.\n    b.  Compute the Jacobian matrix $\\mathbf{J}$ and its determinant $\\det(\\mathbf{J})$.\n    c.  If $\\det(\\mathbf{J})$ is non-positive (or below a small tolerance), mark the element as invalid and terminate the calculation for this $d$.\n    d.  Compute the physical gradients $\\nabla_{x,y} N_i = \\mathbf{J}^{-1} \\nabla_{\\xi, \\eta} N_i$.\n    e.  Calculate the contribution to the stiffness matrix at this point and add it to $K^e$.\n4.  If the element is valid, form the $3 \\times 3$ reduced matrix $K_{\\text{red}}$ by removing the first row and column from $K^e$.\n5.  Compute and store the spectral condition number $\\kappa_2(K_{\\text{red}})$. If the element was marked invalid, store $\\infty$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_condition_number(d: float) -> float:\n    \"\"\"\n    Computes the spectral condition number of the reduced stiffness matrix\n    for a single bilinear quadrilateral element with a given skew parameter d.\n\n    Args:\n        d: The horizontal skew parameter for the top-right node.\n\n    Returns:\n        The spectral condition number, or numpy.inf if the element mapping is invalid.\n    \"\"\"\n    # 1. Define nodal coordinates for the physical element\n    nodes = np.array([\n        [0.0, 0.0],          # Node 1\n        [1.0, 0.0],          # Node 2\n        [1.0 + d, 1.0],      # Node 3\n        [0.0, 1.0]           # Node 4\n    ])\n\n    # 2. Define 2x2 Gaussian quadrature points and weights\n    a = 1.0 / np.sqrt(3.0)\n    gauss_points = [(-a, -a), (a, -a), (a, a), (-a, a)]\n    gauss_weights = [1.0, 1.0, 1.0, 1.0]\n\n    # 3. Initialize the 4x4 element stiffness matrix\n    K_e = np.zeros((4, 4))\n    kappa = 1.0  # Constant scalar conductivity\n\n    # 4. Loop over Gauss points to assemble the stiffness matrix\n    for i in range(len(gauss_points)):\n        xi, eta = gauss_points[i]\n        weight = gauss_weights[i]\n\n        # Derivatives of bilinear shape functions w.r.t. natural coordinates (xi, eta)\n        # dN/dxi at the current Gauss point\n        dN_dxi = 0.25 * np.array([-(1.0 - eta), (1.0 - eta), (1.0 + eta), -(1.0 + eta)])\n        # dN/deta at the current Gauss point\n        dN_deta = 0.25 * np.array([-(1.0 - xi), -(1.0 + xi), (1.0 + xi), (1.0 - xi)])\n\n        # Matrix of shape function gradients in reference coordinates (4x2)\n        grad_N_ref = np.vstack((dN_dxi, dN_deta)).T\n\n        # Jacobian matrix of the isoparametric mapping\n        # J_ij = sum_k (d_Nk/d_xi_j * x_i_k)\n        # J = nodes.T @ grad_N_ref\n        J = nodes.T @ grad_N_ref\n        J = J.T\n\n        # Determinant of the Jacobian\n        detJ = np.linalg.det(J)\n\n        # Check for invalid mapping (non-positive or near-zero determinant)\n        if detJ <= 1e-12:\n            return np.inf\n\n        # Inverse of the Jacobian\n        invJ = np.linalg.inv(J)\n\n        # Gradients of shape functions in physical coordinates (x, y)\n        # grad_N_phys = grad_N_ref * J^-1  ( (4x2) @ (2x2) -> (4x2) )\n        grad_N_phys = grad_N_ref @ invJ\n\n        # Add contribution to the stiffness matrix\n        # The term (grad_N_phys @ grad_N_phys.T) is a 4x4 matrix\n        # where the (i, j) entry is (nabla N_i) . (nabla N_j)\n        K_e += kappa * (grad_N_phys @ grad_N_phys.T) * detJ * weight\n    \n    # 5. Apply homogeneous Dirichlet BC at node 1 by creating the reduced matrix\n    K_red = K_e[1:, 1:]\n\n    # 6. Compute and return the spectral condition number (p=2) of the reduced matrix\n    cond_num = np.linalg.cond(K_red, p=2)\n\n    return cond_num\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for the specified test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        0.0,   # Baseline square element\n        0.3,   # Moderate skew\n        0.6,   # High skew\n        0.9,   # Very high skew\n        -0.8   # Negative skew near degeneracy\n    ]\n\n    results = []\n    for d in test_cases:\n        result = compute_condition_number(d)\n        results.append(result)\n\n    # Format the results for printing\n    results_str = []\n    for r in results:\n        if r == np.inf:\n            results_str.append(\"inf\")\n        else:\n            # Round to six decimal places\n            results_str.append(f\"{r:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```"
        }
    ]
}