{
    "hands_on_practices": [
        {
            "introduction": "This practice grounds the abstract theory of the finite element method in a concrete calculation. You will derive the stiffness matrix for a single constant-strain triangular element from first principles, connecting nodal coordinates and material properties directly to the element's mechanical response . This exercise is fundamental for understanding how the geometry and material behavior of the smallest discrete unit contribute to the overall system.",
            "id": "3733548",
            "problem": "Consider the two-dimensional small-strain linear elasticity problem discretized by the Finite Element Method (FEM) using a single linear constant-strain triangular element under plane stress. The three nodes of the element have Cartesian coordinates $((x_1,y_1),(x_2,y_2),(x_3,y_3)) = ((0,0),(2,0),(0,1))$ in $\\text{m}$. The material is homogeneous and isotropic with Young’s modulus $E = 210 \\,\\text{GPa}$ and Poisson’s ratio $\\nu = 0.3$, and the element has uniform thickness $t = 0.01 \\,\\text{m}$. Use the standard nodal displacement ordering $\\left[u_1, v_1, u_2, v_2, u_3, v_3\\right]$ for the element degrees of freedom.\n\nStarting from the Principle of Virtual Work and the small-strain kinematics and isotropic linear elastic constitutive relations, derive the constant strain-displacement matrix $B$ for this element by computing the geometric coefficients and the element area $A$ from the given nodal coordinates. Then obtain the constitutive matrix $D$ for plane stress. Using these, form the element stiffness matrix $k_e$ via the standard bilinear form over the element domain. Finally, report the scalar value of the $(1,1)$ entry of $k_e$ corresponding to the $u_1$–$u_1$ degree of freedom interaction.\n\nRound your final numerical value to four significant figures. Express your final result in $\\text{N/m}$.\n\nYou may comment on how this element stiffness would be mapped into the global stiffness matrix and, analogously, how a consistent element force vector due to a uniform body force would be assembled into the global force vector, but only the scalar $(1,1)$ entry of $k_e$ is required as the final answer.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, objective, and complete. It presents a standard application of the Finite Element Method to a linear elasticity problem, with all necessary data provided. We shall proceed with the derivation.\n\nThe element stiffness matrix, $k_e$, for a finite element is derived from the Principle of Virtual Work. For a linear elastic material, it relates the nodal displacement vector, $\\mathbf{d}$, to the nodal force vector, $\\mathbf{f}_e$, as $\\mathbf{f}_e = k_e \\mathbf{d}$. The matrix $k_e$ is given by the expression:\n$$\nk_e = \\int_V B^T D B \\, dV\n$$\nwhere $B$ is the strain-displacement matrix, $D$ is the constitutive (material stiffness) matrix, and the integral is taken over the volume $V$ of the element. For an element with constant thickness $t$, this can be written as:\n$$\nk_e = t \\int_A B^T D B \\, dA\n$$\nwhere $A$ is the area of the element. For a constant-strain triangle, both $B$ and $D$ are constant throughout the element, so the integral simplifies to:\n$$\nk_e = (A \\cdot t) B^T D B\n$$\n\nFirst, we determine the geometric properties of the element. The nodal coordinates are given as $(x_1, y_1) = (0,0)$, $(x_2, y_2) = (2,0)$, and $(x_3, y_3) = (0,1)$, all in units of meters ($\\text{m}$). The area $A$ of the triangle can be computed using the determinant formula:\n$$\nA = \\frac{1}{2} \\left| \\det \\begin{pmatrix} 1  x_1  y_1 \\\\ 1  x_2  y_2 \\\\ 1  x_3  y_3 \\end{pmatrix} \\right| = \\frac{1}{2} |1(x_2 y_3 - x_3 y_2) - 1(x_1 y_3 - x_3 y_1) + 1(x_1 y_2 - x_2 y_1)|\n$$\n$$\nA = \\frac{1}{2} |x_1(y_2-y_3) + x_2(y_3-y_1) + x_3(y_1-y_2)| = \\frac{1}{2} |0(0-1) + 2(1-0) + 0(0-0)| = \\frac{1}{2}|2| = 1 \\, \\text{m}^2\n$$\n\nNext, we derive the strain-displacement matrix $B$. For a linear triangular element, the displacement field $(u,v)$ is interpolated from the nodal displacements $(u_i,v_i)$ using linear shape functions $N_i(x,y)$. The small-strain components are $\\epsilon_{xx} = \\frac{\\partial u}{\\partial x}$, $\\epsilon_{yy} = \\frac{\\partial v}{\\partial y}$, and $\\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}$. This relationship is expressed in matrix form as $\\boldsymbol{\\epsilon} = B \\mathbf{d}$, where $\\boldsymbol{\\epsilon} = [\\epsilon_{xx}, \\epsilon_{yy}, \\gamma_{xy}]^T$ and $\\mathbf{d} = [u_1, v_1, u_2, v_2, u_3, v_3]^T$. The matrix $B$ is given by:\n$$\nB = \\frac{1}{2A} \\begin{pmatrix} b_1  0  b_2  0  b_3  0 \\\\ 0  c_1  0  c_2  0  c_3 \\\\ c_1  b_1  c_2  b_2  c_3  b_3 \\end{pmatrix}\n$$\nwhere the coefficients $b_i$ and $c_i$ are functions of the nodal coordinates: $b_i = y_j - y_k$ and $c_i = x_k - x_j$ for $(i,j,k)$ in cyclic order $(1,2,3), (2,3,1), (3,1,2)$. We compute these coefficients:\n$b_1 = y_2 - y_3 = 0 - 1 = -1$\n$c_1 = x_3 - x_2 = 0 - 2 = -2$\n$b_2 = y_3 - y_1 = 1 - 0 = 1$\n$c_2 = x_1 - x_3 = 0 - 0 = 0$\n$b_3 = y_1 - y_2 = 0 - 0 = 0$\n$c_3 = x_2 - x_1 = 2 - 0 = 2$\n\nSubstituting these values and $A=1$, the $B$ matrix is:\n$$\nB = \\frac{1}{2} \\begin{pmatrix} -1  0  1  0  0  0 \\\\ 0  -2  0  0  0  2 \\\\ -2  -1  0  1  2  0 \\end{pmatrix}\n$$\n\nNext, we define the constitutive matrix $D$ for plane stress. For a homogeneous and isotropic material, this matrix is:\n$$\nD = \\frac{E}{1 - \\nu^2} \\begin{pmatrix} 1  \\nu  0 \\\\ \\nu  1  0 \\\\ 0  0  \\frac{1-\\nu}{2} \\end{pmatrix}\n$$\nThe problem provides Young's modulus $E = 210 \\, \\text{GPa} = 210 \\times 10^9 \\, \\text{N/m}^2$ and Poisson's ratio $\\nu = 0.3$.\n\nWe need to compute the $(1,1)$ entry of the element stiffness matrix $k_e$, which corresponds to the $u_1$ degree of freedom. The stiffness matrix $k_e$ is a $6 \\times 6$ matrix. The entry $k_{e,11}$ is given by:\n$$\nk_{e,11} = (A \\cdot t) \\left( B^T D B \\right)_{11}\n$$\nThe $(1,1)$ entry of the matrix product $B^T D B$ is found by multiplying the first row of $B^T$ by $D$ and then by the first column of $B$. The first row of $B^T$ is the transpose of the first column of $B$, let's call it $B_1^T$.\n$$\nB_1 = \\frac{1}{2A} \\begin{pmatrix} b_1 \\\\ 0 \\\\ c_1 \\end{pmatrix}\n$$\nThe product is $(B^T D B)_{11} = B_1^T D B_1$. Let's compute this:\n$$\n(B^T D B)_{11} = \\left( \\frac{1}{2A} \\begin{pmatrix} b_1  0  c_1 \\end{pmatrix} \\right) \\left( \\frac{E}{1-\\nu^2} \\begin{pmatrix} 1  \\nu  0 \\\\ \\nu  1  0 \\\\ 0  0  \\frac{1-\\nu}{2} \\end{pmatrix} \\right) \\left( \\frac{1}{2A} \\begin{pmatrix} b_1 \\\\ 0 \\\\ c_1 \\end{pmatrix} \\right)\n$$\n$$\n(B^T D B)_{11} = \\frac{E}{4A^2(1-\\nu^2)} \\begin{pmatrix} b_1  0  c_1 \\end{pmatrix} \\begin{pmatrix} b_1 \\\\ \\nu b_1 \\\\ \\frac{1-\\nu}{2} c_1 \\end{pmatrix} = \\frac{E}{4A^2(1-\\nu^2)} \\left( b_1^2 + \\frac{1-\\nu}{2} c_1^2 \\right)\n$$\nNow, we can find $k_{e,11}$ by multiplying by $A \\cdot t$:\n$$\nk_{e,11} = (A \\cdot t) \\frac{E}{4A^2(1-\\nu^2)} \\left( b_1^2 + \\frac{1-\\nu}{2} c_1^2 \\right) = \\frac{E t}{4A(1-\\nu^2)} \\left( b_1^2 + \\frac{1-\\nu}{2} c_1^2 \\right)\n$$\nWe now substitute the numerical values: $E_s = 210 \\times 10^9 \\, \\text{N/m}^2$, $\\nu_s = 0.3$, $t=0.01 \\, \\text{m}$, $A=1 \\, \\text{m}^2$, $b_1 = -1$, and $c_1 = -2$.\n$$\nk_{e,11} = \\frac{(210 \\times 10^9)(0.01)}{4(1)(1 - 0.3^2)} \\left( (-1)^2 + \\frac{1-0.3}{2} (-2)^2 \\right)\n$$\n$$\nk_{e,11} = \\frac{2.1 \\times 10^9}{4(1 - 0.09)} \\left( 1 + \\frac{0.7}{2} (4) \\right)\n$$\n$$\nk_{e,11} = \\frac{2.1 \\times 10^9}{4(0.91)} (1 + 1.4) = \\frac{2.1 \\times 10^9}{3.64} (2.4)\n$$\n$$\nk_{e,11} = \\frac{5.04 \\times 10^9}{3.64} \\approx 1.38461538... \\times 10^9 \\, \\text{N/m}\n$$\nRounding the result to four significant figures, we get $1.385 \\times 10^9 \\, \\text{N/m}$.\n\nAs a brief comment on assembly, the $6 \\times 6$ element stiffness matrix $k_e$ is assembled into the global stiffness matrix $K$. If the global node numbers corresponding to local nodes $1, 2, 3$ are $I, J, K$, the local degrees of freedom $(u_1, v_1)$ map to global degrees of freedom $(u_I, v_I)$, and so on. The entry $k_{e,ij}$ is added to the entry of $K$ at the row and column corresponding to the global degrees of freedom. For instance, $k_{e,11}$ would be added to the global stiffness matrix entry $K_{2I-1, 2I-1}$, assuming a standard $(u,v)$ ordering of global degrees of freedom. Similarly, an element force vector, such as one from a uniform body force $\\mathbf{f}_b$, is computed as $f_e = \\int_V N^T \\mathbf{f}_b dV$, where $N$ is the matrix of shape functions. For a constant strain triangle and uniform body force, this results in $f_e = \\frac{A t}{3} [f_{bx}, f_{by}, f_{bx}, f_{by}, f_{bx}, f_{by}]^T$. This vector's components are then added to the corresponding entries in the global force vector.",
            "answer": "$$\n\\boxed{1.385 \\times 10^9}\n$$"
        },
        {
            "introduction": "Building upon the concept of an individual element matrix, this exercise guides you through the \"scatter-gather\" process of assembling a global stiffness matrix for a simple structure. By connecting multiple one-dimensional elements with varying, homogenized material properties, you will see how local stiffness contributions are mapped and summed into a global system . This practice is crucial for understanding how to model heterogeneous materials and apply boundary conditions to solve for system-wide behavior.",
            "id": "3733559",
            "problem": "Consider a one-dimensional heterogeneous bar occupying the interval $[0,L]$ that has been nondimensionalized so that all quantities are unitless. The bar is discretized using the Finite Element Method (FEM) with three linear two-node elements and four global nodes located at positions $x_{1}=0$, $x_{2}=1$, $x_{3}=2$, and $x_{4}=4$, so that the element lengths are $h_{1}=1$, $h_{2}=1$, and $h_{3}=2$. Each element is associated with a two-phase Representative Volume Element (RVE) that is layered along the axial direction, with phase moduli $E_{a}=6$ and $E_{b}=3$, and phase body-force densities $b_{a}=2$ and $b_{b}=0$. The volume fractions for the $e$-th element are $v_{1}=\\frac{1}{2}$, $v_{2}=\\frac{1}{3}$, and $v_{3}=\\frac{2}{3}$. Assume unit cross-sectional area $A=1$.\n\nUse the following physically justified base:\n- For layered media loaded in series along the axial direction, the effective modulus in each element is the harmonic average $E_{e}=\\left(\\frac{v_{e}}{E_{a}}+\\frac{1-v_{e}}{E_{b}}\\right)^{-1}$.\n- The effective volumetric body force in each element is the arithmetic average $b_{e}=v_{e}b_{a}+(1-v_{e})b_{b}$.\n- The element stiffness matrix for a one-dimensional linear element is $k^{(e)}=\\frac{A E_{e}}{h_{e}}\\begin{pmatrix}1  -1 \\\\ -1  1\\end{pmatrix}$.\n- The element consistent load vector under a constant body force $b_{e}$ is $f^{(e)}=\\frac{b_{e} h_{e}}{2}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}$.\n\nImpose the essential (Dirichlet) boundary condition $u(x_{1})=0$ at the left end and no traction at the right end $x_{4}$. Explicitly carry out the scatter-gather assembly steps to form the global stiffness matrix $K$ and global force vector $f$ with the correct sparsity structure, and then impose the essential boundary condition by eliminating the constrained degree of freedom to obtain the reduced $3\\times 3$ global stiffness matrix. Your final task is to compute the determinant of this reduced global stiffness matrix. Express your final answer as an exact rational number with no units.",
            "solution": "The solution proceeds in several steps:\n1.  Calculate the effective properties for each of the three elements.\n2.  Formulate the element stiffness matrices.\n3.  Assemble the global stiffness matrix from the element matrices.\n4.  Apply the boundary condition to obtain the reduced stiffness matrix.\n5.  Compute the determinant of the reduced matrix.\n\n**Step 1: Calculate Effective Element Properties**\n\nWe calculate the effective Young's modulus $E_{e}$ and effective body force $b_{e}$ for each element $e \\in \\{1, 2, 3\\}$.\n\nFor element $1$ ($e=1$): $v_{1}=\\frac{1}{2}$\n$$E_{1} = \\left(\\frac{v_{1}}{E_{a}}+\\frac{1-v_{1}}{E_{b}}\\right)^{-1} = \\left(\\frac{1/2}{6}+\\frac{1-1/2}{3}\\right)^{-1} = \\left(\\frac{1}{12}+\\frac{1/2}{3}\\right)^{-1} = \\left(\\frac{1}{12}+\\frac{1}{6}\\right)^{-1} = \\left(\\frac{3}{12}\\right)^{-1} = \\left(\\frac{1}{4}\\right)^{-1} = 4$$\n$$b_{1} = v_{1}b_{a}+(1-v_{1})b_{b} = \\frac{1}{2}(2)+\\left(1-\\frac{1}{2}\\right)(0) = 1$$\n\nFor element $2$ ($e=2$): $v_{2}=\\frac{1}{3}$\n$$E_{2} = \\left(\\frac{v_{2}}{E_{a}}+\\frac{1-v_{2}}{E_{b}}\\right)^{-1} = \\left(\\frac{1/3}{6}+\\frac{1-2/3}{3}\\right)^{-1} = \\left(\\frac{1}{18}+\\frac{2/3}{3}\\right)^{-1} = \\left(\\frac{1}{18}+\\frac{2}{9}\\right)^{-1} = \\left(\\frac{5}{18}\\right)^{-1} = \\frac{18}{5}$$\n$$b_{2} = v_{2}b_{a}+(1-v_{2})b_{b} = \\frac{1}{3}(2)+\\left(1-\\frac{1}{3}\\right)(0) = \\frac{2}{3}$$\n\nFor element $3$ ($e=3$): $v_{3}=\\frac{2}{3}$\n$$E_{3} = \\left(\\frac{v_{3}}{E_{a}}+\\frac{1-v_{3}}{E_{b}}\\right)^{-1} = \\left(\\frac{2/3}{6}+\\frac{1-2/3}{3}\\right)^{-1} = \\left(\\frac{2}{18}+\\frac{1/3}{3}\\right)^{-1} = \\left(\\frac{1}{9}+\\frac{1}{9}\\right)^{-1} = \\left(\\frac{2}{9}\\right)^{-1} = \\frac{9}{2}$$\n$$b_{3} = v_{3}b_{a}+(1-v_{3})b_{b} = \\frac{2}{3}(2)+\\left(1-\\frac{2}{3}\\right)(0) = \\frac{4}{3}$$\n\n**Step 2: Formulate Element Stiffness Matrices**\n\nUsing the formula $k^{(e)}=\\frac{A E_{e}}{h_{e}}\\begin{pmatrix}1  -1 \\\\ -1  1\\end{pmatrix}$ with $A=1$.\n\nFor element $1$ ($h_{1}=1$, connects nodes $1, 2$):\n$$k^{(1)} = \\frac{(1)(4)}{1}\\begin{pmatrix}1  -1 \\\\ -1  1\\end{pmatrix} = \\begin{pmatrix}4  -4 \\\\ -4  4\\end{pmatrix}$$\n\nFor element $2$ ($h_{2}=1$, connects nodes $2, 3$):\n$$k^{(2)} = \\frac{(1)(18/5)}{1}\\begin{pmatrix}1  -1 \\\\ -1  1\\end{pmatrix} = \\begin{pmatrix}\\frac{18}{5}  -\\frac{18}{5} \\\\ -\\frac{18}{5}  \\frac{18}{5}\\end{pmatrix}$$\n\nFor element $3$ ($h_{3}=2$, connects nodes $3, 4$):\n$$k^{(3)} = \\frac{(1)(9/2)}{2}\\begin{pmatrix}1  -1 \\\\ -1  1\\end{pmatrix} = \\begin{pmatrix}\\frac{9}{4}  -\\frac{9}{4} \\\\ -\\frac{9}{4}  \\frac{9}{4}\\end{pmatrix}$$\n(The force vectors are not required for the final answer, but are assembled as part of the full procedure. For completeness: $f^{(1)} = \\frac{(1)(1)}{2}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix} = \\begin{pmatrix}1/2 \\\\ 1/2\\end{pmatrix}$, $f^{(2)} = \\frac{(2/3)(1)}{2}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix} = \\begin{pmatrix}1/3 \\\\ 1/3\\end{pmatrix}$, $f^{(3)} = \\frac{(4/3)(2)}{2}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix} = \\begin{pmatrix}4/3 \\\\ 4/3\\end{pmatrix}$.)\n\n**Step 3: Assemble the Global Stiffness Matrix**\n\nThe global stiffness matrix $K$ is a $4 \\times 4$ matrix. The assembly is performed by adding the element stiffness contributions to the corresponding global degrees of freedom.\n$K_{11} = k^{(1)}_{11} = 4$\n$K_{12} = K_{21} = k^{(1)}_{12} = -4$\n$K_{22} = k^{(1)}_{22} + k^{(2)}_{11} = 4 + \\frac{18}{5} = \\frac{20}{5} + \\frac{18}{5} = \\frac{38}{5}$\n$K_{23} = K_{32} = k^{(2)}_{12} = -\\frac{18}{5}$\n$K_{33} = k^{(2)}_{22} + k^{(3)}_{11} = \\frac{18}{5} + \\frac{9}{4} = \\frac{72}{20} + \\frac{45}{20} = \\frac{117}{20}$\n$K_{34} = K_{43} = k^{(3)}_{12} = -\\frac{9}{4}$\n$K_{44} = k^{(3)}_{22} = \\frac{9}{4}$\nAll other entries are zero.\n\nThe assembled global stiffness matrix is:\n$$K = \\begin{pmatrix} 4  -4  0  0 \\\\ -4  \\frac{38}{5}  -\\frac{18}{5}  0 \\\\ 0  -\\frac{18}{5}  \\frac{117}{20}  -\\frac{9}{4} \\\\ 0  0  -\\frac{9}{4}  \\frac{9}{4} \\end{pmatrix}$$\n\n**Step 4: Apply Boundary Condition and Obtain Reduced Matrix**\n\nThe essential boundary condition is $u(x_{1})=0$, which corresponds to the displacement $u_{1}=0$. To enforce this condition, we eliminate the first row and first column of the global stiffness matrix $K$. The remaining submatrix corresponds to the unknown degrees of freedom $u_{2}$, $u_{3}$, and $u_{4}$. This is the reduced $3 \\times 3$ stiffness matrix, which we will denote as $K_{red}$.\n\n$$K_{red} = \\begin{pmatrix} \\frac{38}{5}  -\\frac{18}{5}  0 \\\\ -\\frac{18}{5}  \\frac{117}{20}  -\\frac{9}{4} \\\\ 0  -\\frac{9}{4}  \\frac{9}{4} \\end{pmatrix}$$\n\n**Step 5: Compute the Determinant of the Reduced Matrix**\n\nWe compute the determinant of $K_{red}$ using the cofactor expansion along the first row:\n$$\\det(K_{red}) = \\left(\\frac{38}{5}\\right) \\det\\begin{pmatrix} \\frac{117}{20}  -\\frac{9}{4} \\\\ -\\frac{9}{4}  \\frac{9}{4} \\end{pmatrix} - \\left(-\\frac{18}{5}\\right) \\det\\begin{pmatrix} -\\frac{18}{5}  -\\frac{9}{4} \\\\ 0  \\frac{9}{4} \\end{pmatrix} + (0) \\det(\\ldots)$$\n\nFirst, calculate the determinants of the $2 \\times 2$ submatrices:\n$$\\det\\begin{pmatrix} \\frac{117}{20}  -\\frac{9}{4} \\\\ -\\frac{9}{4}  \\frac{9}{4} \\end{pmatrix} = \\left(\\frac{117}{20}\\right)\\left(\\frac{9}{4}\\right) - \\left(-\\frac{9}{4}\\right)\\left(-\\frac{9}{4}\\right) = \\frac{1053}{80} - \\frac{81}{16} = \\frac{1053}{80} - \\frac{405}{80} = \\frac{648}{80} = \\frac{81}{10}$$\n$$\\det\\begin{pmatrix} -\\frac{18}{5}  -\\frac{9}{4} \\\\ 0  \\frac{9}{4} \\end{pmatrix} = \\left(-\\frac{18}{5}\\right)\\left(\\frac{9}{4}\\right) - (0)\\left(-\\frac{9}{4}\\right) = -\\frac{162}{20} = -\\frac{81}{10}$$\n\nNow substitute these back into the expression for $\\det(K_{red})$:\n$$\\det(K_{red}) = \\left(\\frac{38}{5}\\right)\\left(\\frac{81}{10}\\right) + \\left(\\frac{18}{5}\\right)\\left(-\\frac{81}{10}\\right)$$\n$$\\det(K_{red}) = \\frac{3078}{50} - \\frac{1458}{50} = \\frac{3078 - 1458}{50} = \\frac{1620}{50} = \\frac{162}{5}$$\nAlternatively, we can factor out common terms:\n$$\\det(K_{red}) = \\frac{81}{50}(38 - 18) = \\frac{81}{50}(20) = \\frac{81 \\times 2}{5} = \\frac{162}{5}$$\nThe determinant of the reduced global stiffness matrix is an exact rational number.",
            "answer": "$$\\boxed{\\frac{162}{5}}$$"
        },
        {
            "introduction": "This advanced practice transitions from manual calculation to computational implementation, a vital step for any practitioner of computational mechanics. You will implement a constant-strain patch test, a cornerstone verification method that ensures a finite element formulation can exactly reproduce a state of constant strain. This exercise will solidify your understanding of isoparametric mapping, numerical quadrature for both stiffness and force vector assembly, and the formal process of code verification .",
            "id": "2615751",
            "problem": "Consider small-strain, linear-elastic, two-dimensional solids discretized by isoparametric bilinear quadrilateral elements. Start from the kinematics of infinitesimal strain, where the symmetric strain tensor is given by $\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\tfrac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}}\\right)$, and the Cauchy stress tensor satisfies the linear elastic constitutive law $\\boldsymbol{\\sigma} = \\mathbb{C} : \\boldsymbol{\\varepsilon}$, with $\\mathbb{C}$ denoting the fourth-order elasticity tensor (expressed in Voigt notation as a matrix $\\mathbf{D}$). The static equilibrium in the absence of body forces is $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$ in the domain and $\\boldsymbol{\\sigma}\\mathbf{n} = \\mathbf{t}$ on the boundary, where $\\mathbf{n}$ is the outward unit normal and $\\mathbf{t}$ is the prescribed traction. Using the principle of virtual work, the finite element discretization with isoparametric bilinear quadrilaterals and the associated bilinear shape functions leads to a global linear system $\\mathbf{K}\\mathbf{u} = \\mathbf{f}$, where $\\mathbf{K}$ is the assembled global stiffness matrix and $\\mathbf{f}$ is the assembled global force vector due to boundary tractions.\n\nYour task is to implement a constant-strain patch test entirely from first principles, without relying on any pre-derived element matrices, by assembling the global stiffness matrix $\\mathbf{K}$ and the global traction vector $\\mathbf{f}$ for several small meshes. You must verify that when a uniform exact displacement field corresponding to a prescribed constant engineering strain vector $\\boldsymbol{\\varepsilon}^{\\mathrm{eng}} = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^{\\mathsf{T}}$ is imposed as the nodal displacement field, the residual $\\mathbf{r} = \\mathbf{K}\\mathbf{u}_{\\mathrm{exact}} - \\mathbf{f}$ is numerically zero up to a specified tolerance. The exact displacement field consistent with the prescribed constant engineering strain is defined by\n$$\nu_x(x,y) = \\varepsilon_{xx}\\,x + \\tfrac{1}{2}\\gamma_{xy}\\,y,\\qquad\nu_y(x,y) = \\varepsilon_{yy}\\,y + \\tfrac{1}{2}\\gamma_{xy}\\,x,\n$$\nso that the engineering shear strain satisfies $\\,\\gamma_{xy} = \\dfrac{\\partial u_x}{\\partial y} + \\dfrac{\\partial u_y}{\\partial x}\\,$. The boundary traction must be taken as $\\mathbf{t} = \\boldsymbol{\\sigma}\\mathbf{n}$, where $\\boldsymbol{\\sigma}$ is the constant stress tensor obtained from the constant strain and the constitutive law. No body forces are present. Use Gaussian quadrature of appropriate order for both the element stiffness integration and the line integration of boundary tractions; the outward normal $\\mathbf{n}$ must be consistent with the geometry. You must assemble the mesh using isoparametric bilinear shape functions on the reference square with coordinates $(\\xi,\\eta)\\in[-1,1]^2$ mapped to each physical element.\n\nConstitutive behavior must be implemented for both plane stress and plane strain:\n- Plane stress: the Voigt matrix $\\mathbf{D}$ depends on Young’s modulus $E$ and Poisson’s ratio $\\nu$ in the standard way for plane stress.\n- Plane strain: the Voigt matrix $\\mathbf{D}$ depends on $E$ and $\\nu$ in the standard way for plane strain.\n\nAll physical quantities must be in International System of Units (SI): lengths in meters ($\\mathrm{m}$), tractions in Newtons per square meter ($\\mathrm{Pa}$), and Young’s modulus in Pascals ($\\mathrm{Pa}$). Strain components are dimensionless. Your final outputs are booleans indicating whether the residual norm is below the tolerance for each case; these booleans are dimensionless and unitless.\n\nImplement the following test suite. For each case, define a rectangular domain $[0,L_x]\\times[0,L_y]$, a structured mesh of $n_x\\times n_y$ bilinear quadrilateral elements, isotropic elastic constants $(E,\\nu)$, the plane condition (plane stress or plane strain), and a constant engineering strain vector $\\boldsymbol{\\varepsilon}^{\\mathrm{eng}} = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^{\\mathsf{T}}$. Construct the exact nodal displacement vector $\\mathbf{u}_{\\mathrm{exact}}$ from the exact field above, assemble $\\mathbf{K}$ and $\\mathbf{f}$ (traction-only loading), compute $\\mathbf{r}=\\mathbf{K}\\mathbf{u}_{\\mathrm{exact}}-\\mathbf{f}$, and check the relative residual\n$$\n\\rho = \\frac{\\|\\mathbf{r}\\|_2}{\\|\\mathbf{K}\\mathbf{u}_{\\mathrm{exact}}\\|_2+\\|\\mathbf{f}\\|_2},\n$$\nwith the convention that if the denominator is zero, then set $\\rho=0$. Report whether $\\rho \\le \\text{tol}$.\n\nTest suite:\n- Case $1$: $L_x=1\\,\\mathrm{m}$, $L_y=1\\,\\mathrm{m}$, $n_x=2$, $n_y=2$, plane stress, $E=210\\times 10^{9}\\,\\mathrm{Pa}$, $\\nu=0.3$, $\\boldsymbol{\\varepsilon}^{\\mathrm{eng}}=[10^{-3},\\,2\\times 10^{-3},\\,5\\times 10^{-4}]^{\\mathsf{T}}$, $\\text{tol}=5\\times 10^{-10}$.\n- Case $2$: $L_x=2\\,\\mathrm{m}$, $L_y=1\\,\\mathrm{m}$, $n_x=3$, $n_y=1$, plane strain, $E=70\\times 10^{9}\\,\\mathrm{Pa}$, $\\nu=0.25$, $\\boldsymbol{\\varepsilon}^{\\mathrm{eng}}=[10^{-4},\\,-10^{-4},\\,3\\times 10^{-4}]^{\\mathsf{T}}$, $\\text{tol}=5\\times 10^{-10}$.\n- Case $3$: $L_x=0.3\\,\\mathrm{m}$, $L_y=0.7\\,\\mathrm{m}$, $n_x=1$, $n_y=1$, plane stress, $E=10\\times 10^{9}\\,\\mathrm{Pa}$, $\\nu=0.33$, $\\boldsymbol{\\varepsilon}^{\\mathrm{eng}}=[0,\\,0,\\,10^{-3}]^{\\mathsf{T}}$, $\\text{tol}=10^{-10}$.\n- Case $4$: $L_x=1\\,\\mathrm{m}$, $L_y=1\\,\\mathrm{m}$, $n_x=4$, $n_y=4$, plane strain, $E=10^{6}\\,\\mathrm{Pa}$, $\\nu=0.499$, $\\boldsymbol{\\varepsilon}^{\\mathrm{eng}}=[10^{-5},\\,2\\times 10^{-5},\\,3\\times 10^{-5}]^{\\mathsf{T}}$, $\\text{tol}=10^{-9}$.\n\nYour program must:\n- Assemble the global stiffness matrix $\\mathbf{K}$ by integrating $\\mathbf{B}^{\\mathsf{T}}\\mathbf{D}\\mathbf{B}$ over each element with appropriate Gaussian quadrature on the parent domain and Jacobian mapping to physical coordinates, where $\\mathbf{B}$ is the strain-displacement matrix built from bilinear shape function derivatives.\n- Assemble the global traction vector $\\mathbf{f}$ by integrating $\\mathbf{N}^{\\mathsf{T}}\\mathbf{t}$ over every boundary edge, where $\\mathbf{N}$ is the vector of bilinear shape functions restricted to the edge, and $\\mathbf{t}=\\boldsymbol{\\sigma}\\mathbf{n}$ with constant $\\boldsymbol{\\sigma}$ corresponding to the prescribed constant engineering strain and the chosen plane condition. Use Gaussian quadrature along edges and the correct outward unit normal $\\mathbf{n}$ for the boundary of the rectangle.\n- Construct $\\mathbf{u}_{\\mathrm{exact}}$ by evaluating the exact displacement field at all nodes.\n- Compute the relative residual $\\rho$ for each case and compare it to the specified tolerance.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[r_1,r_2,r_3,r_4]$, where each $r_i$ is a boolean indicating whether the residual check passed for case $i$. No other text should be printed.",
            "solution": "The problem requires the implementation of a constant-strain patch test for a two-dimensional, linear-elastic solid discretized with isoparametric bilinear quadrilateral elements. This is a fundamental verification procedure in computational mechanics to ensure that the finite element formulation can reproduce a constant strain state exactly, which is a necessary condition for convergence. The solution involves assembling the global stiffness matrix $\\mathbf{K}$ and the global force vector $\\mathbf{f}$ from first principles and verifying that the residual $\\mathbf{r} = \\mathbf{K}\\mathbf{u}_{\\mathrm{exact}} - \\mathbf{f}$ is numerically zero when an exact displacement field $\\mathbf{u}_{\\mathrm{exact}}$ corresponding to a constant strain is applied.\n\nThe theoretical foundation is the principle of virtual work, which states that for a body in equilibrium, the virtual work done by internal stresses equals the virtual work done by external forces. For a domain $\\Omega$ with boundary $\\partial \\Omega$, this is expressed as:\n$$\n\\int_{\\Omega} \\delta\\boldsymbol{\\varepsilon} : \\boldsymbol{\\sigma} \\, dV = \\int_{\\partial \\Omega_t} \\delta\\mathbf{u} \\cdot \\mathbf{t} \\, dS\n$$\nwhere $\\delta\\mathbf{u}$ is a kinematically admissible virtual displacement, $\\delta\\boldsymbol{\\varepsilon}$ is the corresponding virtual strain, $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor, and $\\mathbf{t}$ is the prescribed traction vector on the boundary portion $\\partial \\Omega_t$. Body forces are neglected as per the problem statement.\n\nIn the finite element method, the displacement field $\\mathbf{u}(\\mathbf{x})$ within an element `e` is approximated by interpolating nodal displacements $\\mathbf{d}^e$ using shape functions $\\mathbf{N}(\\boldsymbol{\\xi})$ defined on a reference domain (parent element), where $\\boldsymbol{\\xi} = (\\xi, \\eta) \\in [-1, 1]^2$:\n$$\n\\mathbf{u}(\\boldsymbol{\\xi}) = \\mathbf{N}(\\boldsymbol{\\xi}) \\mathbf{d}^e = \\sum_{i=1}^{4} N_i(\\boldsymbol{\\xi}) \\begin{pmatrix} u_{ix} \\\\ u_{iy} \\end{pmatrix}\n$$\nThe shape function matrix $\\mathbf{N}$ for a $4$-node element is a $2 \\times 8$ matrix. The strain field is then derived from the displacement field using the strain-displacement matrix $\\mathbf{B}$:\n$$\n\\boldsymbol{\\varepsilon}(\\boldsymbol{\\xi}) = \\mathbf{B}(\\boldsymbol{\\xi}) \\mathbf{d}^e\n$$\nThe $\\mathbf{B}$ matrix is a $3 \\times 8$ matrix derived from the spatial derivatives of the shape functions. The relationship between derivatives in physical coordinates $(x,y)$ and parent coordinates $(\\xi,\\eta)$ is given by the Jacobian matrix $\\mathbf{J}$:\n$$\n\\begin{pmatrix} \\partial/\\partial x \\\\ \\partial/\\partial y \\end{pmatrix} = \\mathbf{J}^{-1} \\begin{pmatrix} \\partial/\\partial \\xi \\\\ \\partial/\\partial \\eta \\end{pmatrix}, \\quad \\text{where} \\quad \\mathbf{J} = \\begin{pmatrix} \\partial x/\\partial \\xi  \\partial y/\\partial \\xi \\\\ \\partial x/\\partial \\eta  \\partial y/\\partial \\eta \\end{pmatrix}\n$$\nThe constitutive law is the linear elastic relation $\\boldsymbol{\\sigma} = \\mathbf{D} \\boldsymbol{\\varepsilon}$, where $\\mathbf{D}$ is the elasticity matrix in Voigt notation, defined for either plane stress or plane strain.\n\nSubstituting these discrete forms into the principle of virtual work and recognizing that the relation must hold for any virtual displacement $\\delta\\mathbf{d}^e$ leads to the element-level system $\\mathbf{k}^e \\mathbf{d}^e = \\mathbf{f}^e$, where the element stiffness matrix $\\mathbf{k}^e$ and element force vector $\\mathbf{f}^e$ are given by:\n$$\n\\mathbf{k}^e = \\int_{\\Omega^e} \\mathbf{B}^T \\mathbf{D} \\mathbf{B} \\, dV \\quad \\text{and} \\quad \\mathbf{f}^e = \\int_{\\partial \\Omega_t^e} \\mathbf{N}^T \\mathbf{t} \\, dS\n$$\nThese integrals are evaluated numerically using Gaussian quadrature over the parent element. For the area integral defining $\\mathbf{k}^e$, we transform the volume element $dV = |\\det(\\mathbf{J})| \\, d\\xi d\\eta$ (assuming unit thickness). The integrand $\\mathbf{B}^T\\mathbf{D}\\mathbf{B}$ is a polynomial of degree $2$ in $\\xi$ and $\\eta$ for a general quadrilateral element. A $2 \\times 2$ Gaussian quadrature rule (4 points) integrates polynomials up to degree $3$ and is therefore sufficient.\n$$\n\\mathbf{k}^e = \\sum_{i=1}^{N_{gp}} w_i \\, \\mathbf{B}(\\boldsymbol{\\xi}_i)^T \\mathbf{D} \\mathbf{B}(\\boldsymbol{\\xi}_i) |\\det(\\mathbf{J}(\\boldsymbol{\\xi}_i))|\n$$\nFor the line integral defining $\\mathbf{f}^e$, we parameterize the boundary edge by $s \\in [-1, 1]$. The surface element is $dS = \\frac{L_{\\text{edge}}}{2} ds$, where $L_{\\text{edge}}$ is the length of the edge. The shape functions $\\mathbf{N}$ become linear functions of $s$ along the edge. The traction $\\mathbf{t} = \\boldsymbol{\\sigma}\\mathbf{n}$ is constant for this problem, as $\\boldsymbol{\\sigma}$ is constant (from the constant prescribed strain) and the domain is a rectangle (so the outward normal $\\mathbf{n}$ is constant along each edge). The integrand is linear, so a $2$-point 1D Gaussian quadrature is sufficient (and exact for higher-order polynomials too).\n$$\n\\mathbf{f}^e = \\frac{L_{\\text{edge}}}{2} \\sum_{j=1}^{M_{gp}} w_j \\, \\mathbf{N}(s_j)^T \\mathbf{t}\n$$\nThe global stiffness matrix $\\mathbf{K}$ and force vector $\\mathbf{f}$ are constructed by assembling the contributions from all element matrices $\\mathbf{k}^e$ and vectors $\\mathbf{f}^e$ based on the mesh connectivity.\n\nFor the patch test, we proceed as follows:\n1.  For each test case, generate the mesh node coordinates and element connectivity for the specified $n_x \\times n_y$ structured grid on the domain $[0,L_x]\\times[0,L_y]$.\n2.  Construct the elasticity matrix $\\mathbf{D}$ based on the material properties ($E, \\nu$) and the specified plane condition.\n3.  Calculate the constant stress Voigt vector $\\boldsymbol{\\sigma}_{\\text{voigt}} = \\mathbf{D} \\boldsymbol{\\varepsilon}^{\\mathrm{eng}}$.\n4.  Construct the exact nodal displacement vector $\\mathbf{u}_{\\mathrm{exact}}$ by evaluating the given analytical displacement field at each node's coordinates.\n5.  Assemble the global stiffness matrix $\\mathbf{K}$ by looping through all elements, computing each $\\mathbf{k}^e$ via $2 \\times 2$ Gaussian quadrature, and summing them into $\\mathbf{K}$.\n6.  Assemble the global force vector $\\mathbf{f}$ by identifying all boundary edges, calculating the constant traction $\\mathbf{t}=\\boldsymbol{\\sigma}\\mathbf{n}$ on each edge, integrating via $2$-point 1D Gaussian quadrature to find the edge's force contribution, and assembling these contributions into $\\mathbf{f}$.\n7.  Compute the vectors $\\mathbf{K}\\mathbf{u}_{\\mathrm{exact}}$ and $\\mathbf{f}$.\n8.  Calculate the residual vector $\\mathbf{r} = \\mathbf{K}\\mathbf{u}_{\\mathrm{exact}} - \\mathbf{f}$.\n9.  Compute the relative residual norm $\\rho = \\frac{\\|\\mathbf{r}\\|_2}{\\|\\mathbf{K}\\mathbf{u}_{\\mathrm{exact}}\\|_2+\\|\\mathbf{f}\\|_2}$. If the denominator is zero, $\\rho$ is taken as $0$.\n10. The patch test is passed if $\\rho$ is less than or equal to the specified tolerance `tol`. This confirms that the element formulation and assembly procedure can exactly represent the constant strain state, as required.\n\nThe implementation will systematically follow these steps for each case in the test suite.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the patch test for all specified cases.\n    \"\"\"\n    test_cases = [\n        {'Lx': 1.0, 'Ly': 1.0, 'nx': 2, 'ny': 2, 'type': 'stress', 'E': 210e9, 'nu': 0.3, 'eps_eng': np.array([1e-3, 2e-3, 5e-4]), 'tol': 5e-10},\n        {'Lx': 2.0, 'Ly': 1.0, 'nx': 3, 'ny': 1, 'type': 'strain', 'E': 70e9, 'nu': 0.25, 'eps_eng': np.array([1e-4, -1e-4, 3e-4]), 'tol': 5e-10},\n        {'Lx': 0.3, 'Ly': 0.7, 'nx': 1, 'ny': 1, 'type': 'stress', 'E': 10e9, 'nu': 0.33, 'eps_eng': np.array([0.0, 0.0, 1e-3]), 'tol': 1e-10},\n        {'Lx': 1.0, 'Ly': 1.0, 'nx': 4, 'ny': 4, 'type': 'strain', 'E': 1e6, 'nu': 0.499, 'eps_eng': np.array([1e-5, 2e-5, 3e-5]), 'tol': 1e-9},\n    ]\n\n    results = []\n    for params in test_cases:\n        passed = run_patch_test(**params)\n        results.append(str(passed).lower())\n\n    print(f\"[{','.join(results)}]\")\n\ndef run_patch_test(Lx, Ly, nx, ny, type, E, nu, eps_eng, tol):\n    \"\"\"\n    Executes a single patch test case.\n    \"\"\"\n    # 1. Mesh Generation\n    num_nodes_x, num_nodes_y = nx + 1, ny + 1\n    num_nodes = num_nodes_x * num_nodes_y\n    num_elems = nx * ny\n    \n    nodes = np.zeros((num_nodes, 2))\n    for j in range(num_nodes_y):\n        for i in range(num_nodes_x):\n            node_idx = j * num_nodes_x + i\n            nodes[node_idx, 0] = i * Lx / nx\n            nodes[node_idx, 1] = j * Ly / ny\n\n    elements = np.zeros((num_elems, 4), dtype=int)\n    for j in range(ny):\n        for i in range(nx):\n            elem_idx = j * nx + i\n            n1 = j * num_nodes_x + i\n            n2 = j * num_nodes_x + i + 1\n            n3 = (j + 1) * num_nodes_x + i + 1\n            n4 = (j + 1) * num_nodes_x + i\n            elements[elem_idx, :] = [n1, n2, n3, n4]\n\n    # 2. Constitutive Matrix\n    if type == 'stress':\n        c = E / (1 - nu**2)\n        D = c * np.array([[1, nu, 0], [nu, 1, 0], [0, 0, (1 - nu) / 2]])\n    elif type == 'strain':\n        c = E / ((1 + nu) * (1 - 2 * nu))\n        D = c * np.array([[1 - nu, nu, 0], [nu, 1 - nu, 0], [0, 0, (1 - 2 * nu) / 2]])\n    \n    # 3. Exact stress tensor and nodal displacements\n    sigma_voigt = D @ eps_eng\n    sigma_tensor = np.array([[sigma_voigt[0], sigma_voigt[2]],\n                             [sigma_voigt[2], sigma_voigt[1]]])\n\n    u_exact = np.zeros(2 * num_nodes)\n    for i in range(num_nodes):\n        x, y = nodes[i]\n        u_exact[2 * i] = eps_eng[0] * x + 0.5 * eps_eng[2] * y\n        u_exact[2 * i + 1] = eps_eng[1] * y + 0.5 * eps_eng[2] * x\n\n    # 4. Initialize global K and f\n    K = np.zeros((2 * num_nodes, 2 * num_nodes))\n    f = np.zeros(2 * num_nodes)\n\n    # 5. Gauss Quadrature Data\n    gp_1d = 1.0 / np.sqrt(3.0)\n    gauss_points_1d = np.array([-gp_1d, gp_1d])\n    gauss_weights_1d = np.array([1.0, 1.0])\n    \n    gauss_points_2d = np.array([[-gp_1d, -gp_1d], [gp_1d, -gp_1d], [gp_1d, gp_1d], [-gp_1d, gp_1d]])\n    gauss_weights_2d = np.array([1.0, 1.0, 1.0, 1.0])\n\n    # 6. Assembly Loop\n    for e in range(num_elems):\n        node_indices = elements[e]\n        elem_coords = nodes[node_indices]\n        ke = np.zeros((8, 8))\n\n        # Stiffness matrix (K) assembly\n        for i in range(len(gauss_weights_2d)):\n            xi, eta = gauss_points_2d[i]\n            w = gauss_weights_2d[i]\n            \n            dNdxieta = 0.25 * np.array([[-(1 - eta), (1 - eta), (1 + eta), -(1 + eta)],\n                                        [-(1 - xi), -(1 + xi), (1 + xi), (1 - xi)]])\n\n            J = dNdxieta @ elem_coords\n            detJ = np.linalg.det(J)\n            invJ = np.linalg.inv(J)\n            \n            dNdxdy = invJ @ dNdxieta\n            \n            B = np.zeros((3, 8))\n            for k in range(4):\n                B[0, 2 * k] = dNdxdy[0, k]\n                B[1, 2 * k + 1] = dNdxdy[1, k]\n                B[2, 2 * k] = dNdxdy[1, k]\n                B[2, 2 * k + 1] = dNdxdy[0, k]\n            \n            ke += B.T @ D @ B * detJ * w\n        \n        dof_map = np.array([[2*n, 2*n+1] for n in node_indices]).flatten()\n        K[np.ix_(dof_map, dof_map)] += ke\n    \n    # Force vector (f) assembly\n    boundary_map = {\n        'bottom': {'normal': np.array([0, -1]), 'edge_nodes': (0, 1)},\n        'right':  {'normal': np.array([1, 0]), 'edge_nodes': (1, 2)},\n        'top':    {'normal': np.array([0, 1]), 'edge_nodes': (2, 3)},\n        'left':   {'normal': np.array([-1, 0]), 'edge_nodes': (3, 0)}\n    }\n\n    for j in range(ny):\n        for i in range(nx):\n            elem_idx = j * nx + i\n            elem_nodes = elements[elem_idx]\n            elem_coords = nodes[elem_nodes]\n\n            is_boundary = {'bottom': j == 0, 'right': i == nx - 1, 'top': j == ny - 1, 'left': i == 0}\n\n            for side, on_boundary in is_boundary.items():\n                if on_boundary:\n                    normal = boundary_map[side]['normal']\n                    traction = sigma_tensor @ normal\n                    \n                    local_n1_idx, local_n2_idx = boundary_map[side]['edge_nodes']\n                    \n                    n1_global_idx = elem_nodes[local_n1_idx]\n                    n2_global_idx = elem_nodes[local_n2_idx]\n                    \n                    coord1 = nodes[n1_global_idx]\n                    coord2 = nodes[n2_global_idx]\n                    edge_length = np.linalg.norm(coord2 - coord1)\n\n                    fe_edge = np.zeros(4)\n                    for gp_idx in range(len(gauss_points_1d)):\n                        s = gauss_points_1d[gp_idx]\n                        w = gauss_weights_1d[gp_idx]\n                        \n                        N1D = np.array([(1-s)/2, (1+s)/2])\n                        fe_edge[0:2] += N1D[0] * traction * w\n                        fe_edge[2:4] += N1D[1] * traction * w\n\n                    fe_edge *= edge_length / 2.0\n\n                    f[2*n1_global_idx : 2*n1_global_idx+2] += fe_edge[0:2]\n                    f[2*n2_global_idx : 2*n2_global_idx+2] += fe_edge[2:4]\n\n    # 7. Verification\n    ku = K @ u_exact\n    r = ku - f\n    norm_r = np.linalg.norm(r)\n    norm_den = np.linalg.norm(ku) + np.linalg.norm(f)\n    \n    rho = 0.0 if norm_den  1e-15 else norm_r / norm_den\n    \n    return rho = tol\n\nsolve()\n```"
        }
    ]
}