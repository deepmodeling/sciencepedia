{
    "hands_on_practices": [
        {
            "introduction": "等参映射是有限元方法中处理复杂几何形状的基石，而双线性四边形单元则是其中最常用的单元之一。一个有效的映射必须是单射的，这一性质由处处为正的雅可比行列式来保证。这项练习将通过一个具体案例，让您亲手剖析违反此条件所带来的后果。通过分析一个节点共线的退化情形 ()，您将直接看到映射如何产生奇异性，以及为何这种情况对于数值分析是灾难性的。",
            "id": "3771511",
            "problem": "考虑一种在有限元法（FEM）中用于在参考正方形和物理域之间传递场的等参双线性四边形映射，这在多尺度建模与分析中很常见。参考单元是父坐标（或自然坐标）$(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$中的正方形，其标准的双线性形函数 $N_{1}(\\xi,\\eta)$、$N_{2}(\\xi,\\eta)$、$N_{3}(\\xi,\\eta)$ 和 $N_{4}(\\xi,\\eta)$ 分别与参考节点 $(-1,-1)$、$(1,-1)$、$(1,1)$ 和 $(-1,1)$ 相关联。物理空间中的节点位置由坐标 $\\mathbf{X}_{1}=(0,0)$、$\\mathbf{X}_{2}=(1,0)$、$\\mathbf{X}_{3}=(2,0)$ 和 $\\mathbf{X}_{4}=(0,1)$ 指定，因此三个节点 $\\mathbf{X}_{1}$、$\\mathbf{X}_{2}$、$\\mathbf{X}_{3}$ 是共线的。\n \n仅使用等参映射和雅可比变换的核心定义，完成以下任务：\n \n1) 使用双线性形函数和给定的节点位置，推导从参考正方形到物理域的等参映射 $(x(\\xi,\\eta),y(\\xi,\\eta))$。\n \n2) 计算此映射的雅可比矩阵 $\\mathbf{J}(\\xi,\\eta)$ 及其行列式 $J(\\xi,\\eta)=\\det\\mathbf{J}(\\xi,\\eta)$，以 $(\\xi,\\eta)$ 的函数表示的解析形式。\n \n3) 通过在参考正方形上求解 $J(\\xi,\\eta)=0$，确定该映射是否以及在何处变得奇异。从第一性原理出发，解释这种奇异性对多尺度环境下的场传递和刚度组装所隐含的几何和分析失效模式，包括面积映射、梯度变换以及刚度被积函数在奇异集附近的可积性如何受到影响。\n \n提供雅可比行列式 $J(\\xi,\\eta)$ 的解析表达式作为您的最终答案。",
            "solution": "问题陈述已经过验证，被认为是合理、适定且有科学依据的。它提出了对一个退化的等参单元的标准分析，这是有限元法（FEM）研究中的一个相关学术练习。\n\n解答按要求分为三部分进行：推导等参映射、计算雅可比行列式，以及分析映射的奇异性及其后果。\n\n**第一部分：等参映射**\n\n等参格式使用相同的形函数来插值单元的几何形状和插值单元内的场变量。从参考坐标 $(\\xi, \\eta)$ 到物理坐标 $(x, y)$ 的映射由下式给出：\n$$\n\\mathbf{x}(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) \\mathbf{X}_i\n$$\n其中 $\\mathbf{x}(\\xi, \\eta) = (x(\\xi, \\eta), y(\\xi, \\eta))$ 是物理坐标，$\\mathbf{X}_i = (x_i, y_i)$ 是物理节点的坐标，而 $N_i(\\xi, \\eta)$ 是在参考单元上定义的形函数。\n\n参考单元是由 $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ 定义的正方形。与节点 $1:(-1,-1)$、$2:(1,-1)$、$3:(1,1)$ 和 $4:(-1,1)$ 相关联的四节点双线性形函数为：\n$$\nN_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)\n$$\n$$\nN_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)\n$$\n$$\nN_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)\n$$\n$$\nN_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n$$\n物理节点的坐标为 $\\mathbf{X}_1=(0,0)$、$\\mathbf{X}_2=(1,0)$、$\\mathbf{X}_3=(2,0)$ 和 $\\mathbf{X}_4=(0,1)$。\n\n对 $x$ 坐标的映射为：\n$$\nx(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i = N_1(0) + N_2(1) + N_3(2) + N_4(0)\n$$\n$$\nx(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) + \\frac{2}{4}(1+\\xi)(1+\\eta)\n$$\n$$\nx(\\xi, \\eta) = \\frac{1}{4} [ (1+\\xi-\\eta-\\xi\\eta) + (2+2\\xi+2\\eta+2\\xi\\eta) ]\n$$\n$$\nx(\\xi, \\eta) = \\frac{1}{4} (3 + 3\\xi + \\eta + \\xi\\eta)\n$$\n对 $y$ 坐标的映射为：\n$$\ny(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i = N_1(0) + N_2(0) + N_3(0) + N_4(1)\n$$\n$$\ny(\\xi, \\eta) = N_4(\\xi, \\eta) = \\frac{1}{4}(1+\\eta-\\xi-\\xi\\eta)\n$$\n因此，等参映射由函数对 $(x(\\xi, \\eta), y(\\xi, \\eta))$ 定义。\n\n**第二部分：雅可比矩阵和行列式**\n\n从 $(\\xi, \\eta)$ 到 $(x, y)$ 的变换的雅可比矩阵定义为：\n$$\n\\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n我们从上面推导的映射函数计算必要的偏导数：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left[ \\frac{1}{4} (3 + 3\\xi + \\eta + \\xi\\eta) \\right] = \\frac{1}{4}(3 + \\eta)\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left[ \\frac{1}{4} (3 + 3\\xi + \\eta + \\xi\\eta) \\right] = \\frac{1}{4}(1 + \\xi)\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left[ \\frac{1}{4} (1 + \\eta - \\xi - \\xi\\eta) \\right] = \\frac{1}{4}(-1 - \\eta)\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left[ \\frac{1}{4} (1 + \\eta - \\xi - \\xi\\eta) \\right] = \\frac{1}{4}(1 - \\xi)\n$$\n组装雅可比矩阵：\n$$\n\\mathbf{J}(\\xi, \\eta) = \\frac{1}{4} \\begin{pmatrix} 3 + \\eta & 1 + \\xi \\\\ -1 - \\eta & 1 - \\xi \\end{pmatrix}\n$$\n雅可比矩阵的行列式，记为 $J(\\xi, \\eta)$，是：\n$$\nJ(\\xi, \\eta) = \\det\\mathbf{J}(\\xi, \\eta) = \\left( \\frac{\\partial x}{\\partial \\xi} \\right) \\left( \\frac{\\partial y}{\\partial \\eta} \\right) - \\left( \\frac{\\partial x}{\\partial \\eta} \\right) \\left( \\frac{\\partial y}{\\partial \\xi} \\right)\n$$\n$$\nJ(\\xi, \\eta) = \\left( \\frac{1}{4} \\right)^2 [ (3 + \\eta)(1 - \\xi) - (1 + \\xi)(-1 - \\eta) ]\n$$\n$$\nJ(\\xi, \\eta) = \\frac{1}{16} [ (3 - 3\\xi + \\eta - \\xi\\eta) - (-1 - \\eta - \\xi - \\xi\\eta) ]\n$$\n$$\nJ(\\xi, \\eta) = \\frac{1}{16} [ 3 - 3\\xi + \\eta - \\xi\\eta + 1 + \\eta + \\xi + \\xi\\eta ]\n$$\n$$\nJ(\\xi, \\eta) = \\frac{1}{16} (4 - 2\\xi + 2\\eta)\n$$\n简化表达式得到雅可比行列式的最终解析形式：\n$$\nJ(\\xi, \\eta) = \\frac{1}{8} (2 - \\xi + \\eta)\n$$\n\n**第三部分：奇异性分析**\n\n在雅可比行列式为零的点，等参映射变得奇异。为找到这些点，我们在参考域 $[-1, 1] \\times [-1, 1]$ 上求解方程 $J(\\xi, \\eta) = 0$。\n$$\n\\frac{1}{8} (2 - \\xi + \\eta) = 0 \\implies 2 - \\xi + \\eta = 0 \\implies \\xi - \\eta = 2\n$$\n我们必须确定这个条件在正方形 $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ 内的何处成立。函数 $f(\\xi,\\eta) = \\xi - \\eta$ 在此域上的最大值在 $\\xi$ 取最大值且 $\\eta$ 取最小值时达到，即在 $(\\xi, \\eta) = (1, -1)$ 处。在该点，$\\xi - \\eta = 1 - (-1) = 2$。这是参考域中满足该条件的唯一点。奇异性恰好发生在参考节点 2 处。此节点映射到物理节点 $\\mathbf{X}_2 = (1,0)$。\n\n这种奇异性的存在对任何使用该单元的数值分析都有深远的影响，尤其是在需要精确场传递的多尺度建模中。\n\n**几何和分析失效模式：**\n1.  **面积映射失效（几何方面）：** 雅可比行列式 $J$ 关联了物理域和参考域之间的微分面积元：$dA_{xy} = J \\, d\\xi d\\eta$。在奇异点处，$J=0$，这意味着参考域中的一个非零微分面积 $d\\xi d\\eta$ 被映射到物理域中的一个零面积元。几何上，单元已经塌陷。物理节点 $\\mathbf{X}_1=(0,0)$、$\\mathbf{X}_2=(1,0)$ 和 $\\mathbf{X}_3=(2,0)$ 是共线的，这意味着在 $\\mathbf{X}_2$ 处的“角”的内角为 $\\pi$ 弧度（$180^\\circ$）。参考正方形中位于角点 $(\\xi, \\eta)=(1, -1)$ 处的 $90^\\circ$ 角被映射为一个 $180^\\circ$ 的角，实际上是将局部几何形状压扁成一条线。这违反了有效映射所需的一一对应（双射）性质。\n\n2.  **梯度变换失效（分析方面）：** 在有限元法中，物理坐标中场变量 $u$ 的梯度是通过逆雅可比矩阵从参考坐标中的梯度计算得出的：$\\nabla_{\\mathbf{x}} u = \\mathbf{J}^{-1} \\nabla_{\\boldsymbol{\\xi}} u$。逆矩阵由 $\\mathbf{J}^{-1} = \\frac{1}{J} \\text{adj}(\\mathbf{J})$ 给出。当 $J=0$ 时，逆雅可比矩阵未定义。因此，无法在该点计算物理梯度（例如，应变、热流）。任何依赖此类梯度的物理模型都会完全失效。\n\n3.  **刚度被积函数与可积性失效（分析方面）：** 单元刚度矩阵是通过在单元体积（或面积）上对量进行积分来计算的。对于一个二维问题，刚度矩阵示意性地表示为 $\\mathbf{K}^e = \\int_A \\mathbf{B}^T \\mathbf{D} \\mathbf{B} \\, dA$。转换到参考域，这变为 $\\mathbf{K}^e = \\int_{-1}^{1}\\int_{-1}^{1} \\mathbf{B}^T \\mathbf{D} \\mathbf{B} \\, J \\, d\\xi d\\eta$。矩阵 $\\mathbf{B}$ 包含形函数对物理坐标的导数，这些导数是使用 $\\mathbf{J}^{-1}$ 获得的。因此，$\\mathbf{B}$ 中的项与 $1/J$ 成正比。刚度矩阵的总被积函数包含表现为 $(1/J)^2 \\times J = 1/J$ 的项。在这个具体问题中，被积函数与 $1/(2-\\xi+\\eta)$ 成正比。此函数在 $(\\xi, \\eta) = (1, -1)$ 处是奇异的（无界的）。对无界函数的积分是广义积分，可能不收敛。标准的数值求积方案（假定被积函数是光滑的）将无法为 $\\mathbf{K}^e$ 产生准确的结果，从而破坏整个有限元解。在多尺度背景下，这种局部数值失效将妨碍均匀化属性的准确确定或细尺度场信息的正确传递。",
            "answer": "$$\n\\boxed{\\frac{1}{8}(2 - \\xi + \\eta)}\n$$"
        },
        {
            "introduction": "虽然第一个练习探讨了一种失效模式，但等参映射的真正优势在于精确表示弯曲几何形状，而高阶单元是实现这一目标的关键。附加节点（如二次单元中的边中点）的位置可以精确控制单元边缘的形状。本练习将引导您推导边中点位置与边缘曲率之间的关系 ()。这将揭示我们如何利用等参单元作为一种强大的设计工具，来构建能够贴合复杂边界的网格。",
            "id": "3771394",
            "problem": "考虑一个三角形有限元的参考单元，该单元由重心（面积）坐标 $(L_1,L_2,L_3)$ 定义，满足 $L_1 \\ge 0$，$L_2 \\ge 0$，$L_3 \\ge 0$ 和 $L_1 + L_2 + L_3 = 1$。一个二次等参三角形单元有 $6$ 个节点：$3$ 个顶点节点（标记为 $1,2,3$）和 $3$ 个边中节点（标记为 $4,5,6$）。这些节点的物理坐标由 $(x_i,y_i)$ 给出，其中 $i=1,\\dots,6$。在等参映射中，定义在参考三角形上的相同二次 Lagrange 形函数被用来插值几何形状和场。\n\n从重心坐标的定义和三角形上的 Lagrange 插值性质出发，构建二次等参映射 $\\boldsymbol{x}(L_1,L_2,L_3)$，该映射将参考三角形映射到物理曲边三角形。然后，通过设置 $L_3=0$ 将此映射限制到连接节点 $1$ 和 $2$ 的物理边上，并通过 $L_1=1-s$，$L_2=s$ 将该边用 $s \\in [0,1]$ 参数化。使用平面参数曲线 $\\boldsymbol{r}(s)$ 的有符号曲率 $\\kappa(s)$ 的定义，\n$$\n\\kappa(s) \\;=\\; \\frac{\\det\\!\\big(\\boldsymbol{r}'(s),\\,\\boldsymbol{r}''(s)\\big)}{\\big\\|\\boldsymbol{r}'(s)\\big\\|^{3}},\n$$\n推导该边物理中点处（即 $s=\\tfrac{1}{2}$ 处）的有符号曲率的闭式表达式，该表达式仅用节点坐标 $(x_1,y_1)$、$(x_2,y_2)$ 和 $(x_4,y_4)$ 表示。此处，$\\det(\\boldsymbol{a},\\boldsymbol{b})$ 表示向量 $\\boldsymbol{a}$ 和 $\\boldsymbol{b}$ 的二维叉积的标量（平面外）$z$ 分量，而 $\\|\\cdot\\|$ 表示欧几里得范数。根据你的推导，解释边中节点 $4$ 的位置如何控制物理边 $(1,2)$ 的曲率。\n\n你的最终答案必须是 $s=\\tfrac{1}{2}$ 处有符号曲率的单一闭式解析表达式，且仅用 $x_1$、$y_1$、$x_2$、$y_2$、$x_4$ 和 $y_4$ 表示。不需要进行数值计算，也不需要单位。",
            "solution": "用户提供了一个需要解决的问题。根据指示，第一步是验证问题陈述。\n\n### 步骤 1：提取已知条件\n- **参考单元**：一个由重心坐标 $(L_1, L_2, L_3)$ 定义的三角形有限元，其中 $L_1 \\ge 0$、$L_2 \\ge 0$、$L_3 \\ge 0$ 且 $L_1 + L_2 + L_3 = 1$。\n- **单元类型**：一个包含 $6$ 个节点的二次等参三角形单元。\n- **节点标记**：节点 $1, 2, 3$ 是顶点节点。节点 $4, 5, 6$ 是边中节点。节点 $4$ 位于节点 $1$ 和 $2$ 之间的边上。\n- **节点坐标**：节点的物理坐标为 $(x_i, y_i)$，其中 $i=1, \\dots, 6$。\n- **映射**：等参映射 $\\boldsymbol{x}(L_1, L_2, L_3)$ 使用二次 Lagrange 形函数来插值几何形状。\n- **边参数化**：连接节点 $1$ 和 $2$ 的物理边通过设置 $L_3=0$ 并通过 $L_1=1-s$ 和 $L_2=s$ 以 $s \\in [0,1]$ 进行参数化得到。设此曲线为 $\\boldsymbol{r}(s)$。\n- **曲率定义**：平面参数曲线 $\\boldsymbol{r}(s)$ 的有符号曲率 $\\kappa(s)$ 由公式 $\\kappa(s) = \\frac{\\det(\\boldsymbol{r}'(s), \\boldsymbol{r}''(s))}{\\|\\boldsymbol{r}'(s)\\|^{3}}$ 给出。\n- **目标**：\n    1. 构建映射并将其限制为边 $(1,2)$ 的曲线 $\\boldsymbol{r}(s)$。\n    2. 推导该边物理中点处的曲率 $\\kappa(s=\\tfrac{1}{2})$ 的闭式表达式，用节点 $1, 2, 4$ 的坐标 $(x_1,y_1)$、$(x_2,y_2)$ 和 $(x_4,y_4)$ 表示。\n    3. 解释节点 $4$ 的位置如何控制曲率。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题牢固地植根于有限元法，这是工程和应用数学中一个标准且成熟的数值技术。等参映射、重心坐标和 Lagrange 形函数的概念是该领域的基础。曲率公式是微分几何中的一个标准定义。该问题在科学上和数学上都是合理的。\n2.  **适定性**：该问题提供了推导所需表达式的所有必要定义和数据。二次形函数的使用和指定的参数化导出了一个唯一的、定义明确的曲线，因此其在给定点的曲率也具有唯一值。解存在且相对于输入的节点坐标是稳定的。\n3.  **客观性**：该问题以精确、客观的语言陈述。所有术语如“重心坐标”、“等参映射”和“有符号曲率”在其各自领域都有清晰、普适的定义。没有主观或基于意见的陈述。\n4.  **完整性和一致性**：该问题是自洽的。它提供了要使用的曲率定义和参数化。约束 $L_3=0$，$L_1=1-s$，$L_2=s$ 是一致的，并正确定义了参考单元的边。\n5.  **其他缺陷**：该问题没有表现出任何其他列出的缺陷，例如不可形式化、不切实际、不适定、伪深刻或无法验证。\n\n### 步骤 3：结论和行动\n问题是有效的。现在开始求解过程。\n\n### 求解推导\n\n等参映射将物理单元中一点的坐标 $\\boldsymbol{x} = (x,y)$ 与参考单元中的重心坐标 $(L_1, L_2, L_3)$ 关联起来。该映射由下式给出：\n$$ \\boldsymbol{x}(L_1, L_2, L_3) = \\sum_{i=1}^{6} N_i(L_1, L_2, L_3) \\boldsymbol{x}_i $$\n其中 $\\boldsymbol{x}_i = (x_i, y_i)$ 是第 $i$ 个节点的物理坐标，$N_i$ 是二次 Lagrange 形函数。一个 6 节点三角形的形函数为：\n-   顶点节点 ($i=1,2,3$)：$N_i = L_i(2L_i-1)$\n-   边中节点 ($i=4,5,6$)：$N_4 = 4L_1L_2$，$N_5 = 4L_2L_3$，$N_6 = 4L_3L_1$\n\n我们关心连接节点 $1$ 和 $2$ 的边。在参考单元的这条边上，$L_3=0$。约束 $L_1+L_2+L_3=1$ 简化为 $L_1+L_2=1$。问题指定了用 $s \\in [0,1]$ 进行参数化，其中 $L_1 = 1-s$ 且 $L_2 = s$。\n-   当 $s=0$ 时，$(L_1, L_2, L_3) = (1,0,0)$，对应节点 $1$。\n-   当 $s=1$ 时，$(L_1, L_2, L_3) = (0,1,0)$，对应节点 $2$。\n-   当 $s=\\tfrac{1}{2}$ 时，$(L_1, L_2, L_3) = (\\tfrac{1}{2},\\tfrac{1}{2},0)$，对应边中节点 $4$。\n\n让我们计算这条边上的形函数。任何涉及 $L_3$ 的形函数都将为零。这些是 $N_3$、$N_5$ 和 $N_6$。非零的形函数是：\n-   $N_1(s) = L_1(2L_1-1) = (1-s)(2(1-s)-1) = (1-s)(1-2s)$\n-   $N_2(s) = L_2(2L_2-1) = s(2s-1)$\n-   $N_4(s) = 4L_1L_2 = 4s(1-s)$\n\n描述物理边的参数曲线 $\\boldsymbol{r}(s)$ 由限制后的映射给出：\n$$ \\boldsymbol{r}(s) = N_1(s)\\boldsymbol{x}_1 + N_2(s)\\boldsymbol{x}_2 + N_4(s)\\boldsymbol{x}_4 $$\n$$ \\boldsymbol{r}(s) = (1-3s+2s^2)\\boldsymbol{x}_1 + (2s^2-s)\\boldsymbol{x}_2 + (4s-4s^2)\\boldsymbol{x}_4 $$\n\n为计算曲率，我们需要 $\\boldsymbol{r}(s)$ 关于 $s$ 的一阶和二阶导数：\n$$ \\boldsymbol{r}'(s) = \\frac{d\\boldsymbol{r}}{ds} = (-3+4s)\\boldsymbol{x}_1 + (4s-1)\\boldsymbol{x}_2 + (4-8s)\\boldsymbol{x}_4 $$\n$$ \\boldsymbol{r}''(s) = \\frac{d^2\\boldsymbol{r}}{ds^2} = 4\\boldsymbol{x}_1 + 4\\boldsymbol{x}_2 - 8\\boldsymbol{x}_4 $$\n注意到 $\\boldsymbol{r}''(s)$ 是一个常向量，这对于二次多项式曲线是符合预期的。\n\n我们需要计算这些导数在边的中点 $s=\\tfrac{1}{2}$ 处的值：\n$$ \\boldsymbol{r}'(\\tfrac{1}{2}) = (-3+4(\\tfrac{1}{2}))\\boldsymbol{x}_1 + (4(\\tfrac{1}{2})-1)\\boldsymbol{x}_2 + (4-8(\\tfrac{1}{2}))\\boldsymbol{x}_4 $$\n$$ \\boldsymbol{r}'(\\tfrac{1}{2}) = (-3+2)\\boldsymbol{x}_1 + (2-1)\\boldsymbol{x}_2 + (4-4)\\boldsymbol{x}_4 = -\\boldsymbol{x}_1 + \\boldsymbol{x}_2 = \\boldsymbol{x}_2 - \\boldsymbol{x}_1 $$\n这是曲线在其参数中点处的切向量，即连接节点 $1$ 和 $2$ 的弦。\n\n$$ \\boldsymbol{r}''(\\tfrac{1}{2}) = 4\\boldsymbol{x}_1 + 4\\boldsymbol{x}_2 - 8\\boldsymbol{x}_4 = 4(\\boldsymbol{x}_1 + \\boldsymbol{x}_2 - 2\\boldsymbol{x}_4) $$\n这个向量与边中节点 $\\boldsymbol{x}_4$ 相对于弦的直线中点 $\\frac{\\boldsymbol{x}_1+\\boldsymbol{x}_2}{2}$ 的偏离有关。具体来说，$\\boldsymbol{r}''(\\tfrac{1}{2}) = -8(\\boldsymbol{x}_4 - \\frac{\\boldsymbol{x}_1+\\boldsymbol{x}_2}{2})$。\n\n现在我们计算曲率公式 $\\kappa(s) = \\frac{\\det(\\boldsymbol{r}', \\boldsymbol{r}'')}{\\|\\boldsymbol{r}'\\|^{3}}$ 在 $s=\\tfrac{1}{2}$ 处的各项。\n分子是行列式 $\\det(\\boldsymbol{r}'(\\tfrac{1}{2}), \\boldsymbol{r}''(\\tfrac{1}{2}))$。对于两个向量 $\\boldsymbol{a}=(a_x, a_y)$ 和 $\\boldsymbol{b}=(b_x, b_y)$，$\\det(\\boldsymbol{a}, \\boldsymbol{b}) = a_x b_y - a_y b_x$。\n设 $\\boldsymbol{r}'(\\tfrac{1}{2}) = (x_2-x_1, y_2-y_1)$ 且 $\\boldsymbol{r}''(\\tfrac{1}{2}) = (4(x_1+x_2-2x_4), 4(y_1+y_2-2y_4))$。\n$$ \\det(\\boldsymbol{r}'(\\tfrac{1}{2}), \\boldsymbol{r}''(\\tfrac{1}{2})) = (x_2-x_1) \\cdot 4(y_1+y_2-2y_4) - (y_2-y_1) \\cdot 4(x_1+x_2-2x_4) $$\n$$ = 4 [ (x_2-x_1)(y_1+y_2) - 2y_4(x_2-x_1) - ((y_2-y_1)(x_1+x_2) - 2x_4(y_2-y_1)) ] $$\n让我们简化这一项 $(x_2-x_1)(y_1+y_2) - (y_2-y_1)(x_1+x_2) = (x_2y_1+x_2y_2-x_1y_1-x_1y_2) - (y_2x_1+y_2x_2-y_1x_1-y_1x_2) = 2x_2y_1 - 2x_1y_2 = -2(x_1y_2-x_2y_1)$。\n所以行列式变为：\n$$ = 4 [ -2(x_1y_2-x_2y_1) - 2y_4(x_2-x_1) + 2x_4(y_2-y_1) ] $$\n$$ = -8 [ (x_1y_2-x_2y_1) + y_4(x_2-x_1) - x_4(y_2-y_1) ] $$\n$$ = -8 [ x_1y_2-x_2y_1 + x_2y_4-x_1y_4 - x_4y_2+x_4y_1 ] $$\n$$ = -8 [ (x_2y_4 - x_4y_2) + (x_4y_1 - x_1y_4) + (x_1y_2 - x_2y_1) ] $$\n这个表达式与由节点 $1$、$2$ 和 $4$ 构成的三角形的有符号面积成正比。一种更简洁的写法是：\n$$ \\det(\\boldsymbol{r}'(\\tfrac{1}{2}), \\boldsymbol{r}''(\\tfrac{1}{2})) = \\det(\\boldsymbol{x}_2 - \\boldsymbol{x}_1, -8(\\boldsymbol{x}_4 - \\frac{\\boldsymbol{x}_1+\\boldsymbol{x}_2}{2})) $$\n$$ = -8 \\left[ (x_2-x_1)(y_4 - \\frac{y_1+y_2}{2}) - (y_2-y_1)(x_4 - \\frac{x_1+x_2}{2}) \\right] $$\n展开此表达式得到：\n$$ = -8 \\left[ (x_2-x_1)y_4 - (y_2-y_1)x_4 + \\frac{1}{2}(-(x_2-x_1)(y_1+y_2) + (y_2-y_1)(x_1+x_2)) \\right] $$\n$$ = -8 \\left[ (x_2-x_1)y_4 - (y_2-y_1)x_4 + \\frac{1}{2}(2x_1y_2 - 2x_2y_1) \\right] $$\n$$ = -8 \\left[ (x_2-x_1)y_4 - (y_2-y_1)x_4 + x_1y_2 - x_2y_1 \\right] $$\n这证实了展开的结果。\n\n分母是 $\\|\\boldsymbol{r}'(\\tfrac{1}{2})\\|^3$。\n$$ \\|\\boldsymbol{r}'(\\tfrac{1}{2})\\| = \\|\\boldsymbol{x}_2 - \\boldsymbol{x}_1\\| = \\sqrt{(x_2-x_1)^2 + (y_2-y_1)^2} $$\n因此，\n$$ \\|\\boldsymbol{r}'(\\tfrac{1}{2})\\|^3 = \\left( (x_2-x_1)^2 + (y_2-y_1)^2 \\right)^{3/2} $$\n\n结合分子和分母，在 $s=\\tfrac{1}{2}$ 处的有符号曲率为：\n$$ \\kappa(\\tfrac{1}{2}) = \\frac{-8 \\left( (x_2-x_1)y_4 - (y_2-y_1)x_4 + x_1y_2 - x_2y_1 \\right)}{\\left( (x_2-x_1)^2 + (y_2-y_1)^2 \\right)^{3/2}} $$\n\n### 几何解释与控制\n推导出的曲率表达式揭示了边中节点 $\\boldsymbol{x}_4=(x_4,y_4)$ 的位置如何控制物理边的形状。\n分母 $\\left( \\|\\boldsymbol{x}_2 - \\boldsymbol{x}_1\\| \\right)^3$ 仅取决于顶点节点 $\\boldsymbol{x}_1$ 和 $\\boldsymbol{x}_2$ 的位置。它是连接这些节点的直弦长度的立方。\n因此，对曲率的控制完全包含在分子中。分子是数量 $Q = (x_2-x_1)y_4 - (y_2-y_1)x_4 + x_1y_2 - x_2y_1$ 的 $-8$ 倍。这个量有明确的几何意义。它等价于行列式 $\\det(\\boldsymbol{x}_2-\\boldsymbol{x}_1, \\boldsymbol{x}_4 - \\frac{\\boldsymbol{x}_1+\\boldsymbol{x}_2}{2})$。设 $\\boldsymbol{v} = \\boldsymbol{x}_2 - \\boldsymbol{x}_1$ 为弦向量，$\\boldsymbol{h} = \\boldsymbol{x}_4 - \\frac{\\boldsymbol{x}_1+\\boldsymbol{x}_2}{2}$ 为表示边中节点 $\\boldsymbol{x}_4$ 从弦的中点位移的向量。那么分子就是 $-8 \\det(\\boldsymbol{v}, \\boldsymbol{h})$。\n\n1.  **零曲率（直边）**：如果边中节点 $\\boldsymbol{x}_4$ 位于连接 $\\boldsymbol{x}_1$ 和 $\\boldsymbol{x}_2$ 的直线段上，则向量 $\\boldsymbol{h}$ 与向量 $\\boldsymbol{v}$ 平行。在这种情况下，$\\det(\\boldsymbol{v}, \\boldsymbol{h})=0$，因此曲率 $\\kappa(\\tfrac{1}{2})=0$。物理边是一条直线。例如，通过将 $\\boldsymbol{x}_4$ 放置在几何中点 $\\frac{\\boldsymbol{x}_1+\\boldsymbol{x}_2}{2}$ 处即可实现，这使得 $\\boldsymbol{h}=\\boldsymbol{0}$。\n\n2.  **非零曲率（曲边）**：如果 $\\boldsymbol{x}_4$ 移出弦，$\\boldsymbol{h}$ 将不再与 $\\boldsymbol{v}$ 平行，曲率变为非零。曲率的大小 $|\\kappa(\\tfrac{1}{2})|$ 与 $|\\det(\\boldsymbol{v}, \\boldsymbol{h})|$ 成正比。几何上， $|\\det(\\boldsymbol{v}, \\boldsymbol{h})|$ 是由向量 $\\boldsymbol{v}$ 和 $\\boldsymbol{h}$ 张成的平行四边形的面积。这个面积等于 $\\|\\boldsymbol{v}\\| d_{\\perp}$，其中 $d_{\\perp}$ 是 $\\boldsymbol{h}$ 的顶端到包含 $\\boldsymbol{v}$ 的直线的垂直距离。由于 $\\boldsymbol{h}$ 的基点在弦上，$d_{\\perp}$ 就是节点 $\\boldsymbol{x}_4$ 到线段 $(1,2)$ 的垂直距离。因此，中点处的曲率大小与边中节点到弦的垂直距离成正比。\n\n3.  **曲率的符号**：$\\kappa(\\tfrac{1}{2})$ 的符号由 $-\\det(\\boldsymbol{v}, \\boldsymbol{h})$ 的符号决定。这表示边向弦的哪一侧弯曲。按照惯例，$\\det(\\boldsymbol{v}, \\boldsymbol{h})$ 的正号意味着 $\\boldsymbol{h}$ 在 $\\boldsymbol{v}$ 的“左侧”（逆时针方向）。因此，将 $\\boldsymbol{x}_4$ 移动到弦的一侧会产生正曲率，移动到另一侧则产生负曲率。\n\n总而言之，边中节点 $\\boldsymbol{x}_4$ 的位置提供了对单元边曲率的直接而直观的控制：将其放置在弦上会产生一条直边，而它与弦的垂直距离则线性地控制了中点处曲率的大小。",
            "answer": "$$ \\boxed{\\frac{-8 \\left( (x_2-x_1)y_4 - (y_2-y_1)x_4 + x_1y_2 - x_2y_1 \\right)}{\\left( (x_2-x_1)^{2} + (y_2-y_1)^{2} \\right)^{3/2}}} $$"
        },
        {
            "introduction": "我们已经了解了等参映射如何塑造一个单元，现在我们必须考虑这种几何变换如何影响在该单元上执行的数值计算，特别是积分。积分的变量替换公式将雅可比行列式引入被积函数，从而改变了其多项式次数。最后的这项练习 () 要求您推导出一个普适法则，该法则将映射的复杂性、被积函数的性质与所需数值求积的精度联系起来。这个结论对于保证有限元计算的准确性和效率至关重要。",
            "id": "3771507",
            "problem": "考虑一个从参考元 $\\hat{K} \\subset \\mathbb{R}^{n}$ 通过等参映射 $F : \\hat{K} \\to K$ 获得的单个物理有限元 $K \\subset \\mathbb{R}^{n}$。该等参映射由次数为 $m$ 的多项式形函数构造，因此 $F$ 的每个分量 $F_{i}$ 是关于 $n$ 个参考坐标的总次数为 $m$ 的多项式。假设 $F$ 是保定向的，并且是在 $\\hat{K}$ 上雅可比行列式不为零的双射。设 $f : K \\to \\mathbb{R}$ 是一个在 $K$ 上关于物理坐标的总次数为 $p$ 的多项式。我们希望通过变量替换定理将积分拉回到参考元上，然后在 $\\hat{K}$ 上应用一个 $n$ 维求积法则来计算积分\n$$\nI \\;=\\; \\int_{K} f(x) \\, dx\n$$\n该求积法则对 $\\hat{K}$ 上所有总次数至多为 $r$ 的多项式都是精确的，即该法则的多项式精确度为 $r$。\n\n从变量替换定理以及多项式复合和行列式形成下总次数的基本性质出发，确定在 $\\hat{K}$ 上的最小多项式精确度 $r_{\\min}$，该精确度能保证对 $K$ 上任意次数为 $p$ 的多项式 $f$ 都能精确计算 $I$。$r_{\\min}$ 应表示为空间维度 $n$、$f$ 的多项式次数 $p$ 以及映射次数 $m$ 的函数。你的表达式必须同时涵盖仿射情形（其中 $m = 1$）和非仿射等参情形（其中 $m > 1$）。请以 $n$、$p$ 和 $m$ 的单个闭式代数表达式形式给出 $r_{\\min}$ 的最终结果。",
            "solution": "目标是确定最小多项式精确度 $r_{\\min}$，使得一个在参考元 $\\hat{K}$ 上对所有总次数至多为 $r_{\\min}$ 的多项式都精确的 $n$ 维求积法则，能够对 $K$ 上任意总次数为 $p$ 的多项式 $f$ 精确计算物理积分\n$$\nI \\;=\\; \\int_{K} f(x) \\, dx\n$$\n\n我们从变量替换定理开始。设 $\\xi \\in \\hat{K}$ 表示参考坐标，并记 $x = F(\\xi)$。变量替换定理表明\n$$\nI \\;=\\; \\int_{K} f(x) \\, dx \\;=\\; \\int_{\\hat{K}} f(F(\\xi)) \\, \\left|\\det J_{F}(\\xi)\\right| \\, d\\xi,\n$$\n其中 $J_{F}(\\xi)$ 是 $F$ 在 $\\xi$ 处的雅可比矩阵，$\\det J_{F}(\\xi)$ 是其行列式。因为 $F$ 是保定向的且雅可比行列式不为零，所以 $\\left|\\det J_{F}(\\xi)\\right| = \\det J_{F}(\\xi)$，绝对值不改变多项式的次数。因此，$\\hat{K}$ 上的被积函数是\n$$\ng(\\xi) \\;=\\; f(F(\\xi)) \\, \\det J_{F}(\\xi).\n$$\n\n为保证求积对 $I$ 精确，求积法则只需对 $\\hat{K}$ 上所有次数不超过 $g(\\xi)$ 总次数的多项式精确即可。因此，我们必须根据 $n$、$p$ 和 $m$ 来确定 $g(\\xi)$ 总次数的一个上界（并且，为保证最小性，确定其能达到的最大次数）。\n\n我们现在使用关于多项式次数的熟知事实：\n\n1. 根据构造（使用次数为 $m$ 的形函数的等参几何），等参映射 $F$ 的每个分量 $F_{i}(\\xi)$ 是关于 $n$ 个参考坐标的总次数为 $m$ 的多项式。\n\n2. 一个总次数为 $p$ 的多项式 $f$ 与一个总次数为 $m$ 的多项式映射 $F$ 的复合，会得到一个关于 $\\xi$ 的多项式 $f \\circ F$，其总次数上限为 $p m$。这是因为将每个物理坐标 $x_i$（它是关于 $\\xi$ 的 $m$ 次多项式）代入 $f$ 的每个总次数至多为 $p$ 的单项式中。具体来说，如果 $f(x) = \\sum_{|\\alpha|\\leq p} c_{\\alpha} x^{\\alpha}$，其中多重指标 $\\alpha = (\\alpha_{1},\\dots,\\alpha_{n})$ 且 $|\\alpha| = \\sum_{i=1}^{n} \\alpha_{i}$，那么 $x_{i} = F_{i}(\\xi)$ 的次数为 $m$，而 $x^{\\alpha} = \\prod_{i=1}^{n} F_{i}(\\xi)^{\\alpha_{i}}$ 的总次数至多为 $\\sum_{i=1}^{n} \\alpha_{i} \\cdot m = m |\\alpha| \\leq m p$。因此，$\\deg\\big(f(F(\\xi))\\big) \\leq p m$。\n\n3. 雅可比矩阵 $J_{F}(\\xi)$ 的元素为 $[J_{F}(\\xi)]_{ij} = \\partial F_{i} / \\partial \\xi_{j}$。由于每个 $F_i$ 的总次数为 $m$，每个偏导数 $\\partial F_{i} / \\partial \\xi_{j}$ 是一个总次数为 $m-1$ 的多项式。行列式 $\\det J_{F}(\\xi)$ 是 $n!$ 项之和，每一项是 $J_{F}(\\xi)$ 中 $n$ 个元素的乘积，这些元素分别来自不同的行和列。每个这样的乘积的总次数为 $n (m - 1)$，因为它是 $n$ 个次数为 $m-1$ 的多项式的乘积。因此，$\\det J_{F}(\\xi)$ 是一个总次数至多为 $n (m - 1)$ 的多项式。在一般的非退化映射中，最高次项不会抵消，所以 $\\deg\\big(\\det J_{F}(\\xi)\\big) = n (m - 1)$。\n\n结合这些事实，被积函数 $g(\\xi)$ 是两个多项式的乘积，一个次数至多为 $p m$，另一个次数至多为 $n (m - 1)$。因此，\n$$\n\\deg\\big(g(\\xi)\\big) \\;\\leq\\; p m + n (m - 1).\n$$\n此外，对于达到上述最大次数的一般选择的 $f$ 和 $F$ （例如，$f$ 的一个主单项式满足 $|\\alpha| = p$，以及映射 $F$ 的分量具有不为零的 $m$ 次主齐次部分），其乘积将包含一个总次数恰好为 $p m + n (m - 1)$ 且不会被抵消的项。因此，这个界是紧的，即我们无法用一个小于 $p m + n (m - 1)$ 的求积阶数来保证对所有这样的 $f$ 和 $F$ 的精确性。\n\n根据 $\\hat{K}$ 上多项式精确度 $r$ 的定义（对所有总次数至多为 $r$ 的多项式精确），我们得出结论，在 $n$ 维空间中，对于次数为 $m$ 的等参映射，保证对 $K$ 上任意次数为 $p$ 的多项式 $f$ 精确计算 $I$ 所需的最小精确度为\n$$\nr_{\\min} \\;=\\; p m + n (m - 1).\n$$\n\n这个单一表达式同时涵盖了仿射和非仿射情形。在仿射情形下，$m = 1$，公式简化为\n$$\nr_{\\min} \\;=\\; p \\cdot 1 + n (1 - 1) \\;=\\; p,\n$$\n这与仿射映射产生常数雅可比行列式并在复合下保持多项式次数的事实相一致。在非仿射情形下，$m > 1$，附加项 $n (m - 1)$ 解释了由物理单元的曲率引入的雅可比行列式的变化。\n\n因此，在 $\\mathbb{R}^n$ 中，对于次数为 $m$ 的等参映射，要在 $\\hat{K}$ 上精确积分 $K$ 上的所有 $p$ 次多项式，所需的最小多项式精确度为\n$$\nr_{\\min} \\;=\\; p m + n (m - 1).\n$$",
            "answer": "$$\\boxed{p\\,m + n\\,(m - 1)}$$"
        }
    ]
}