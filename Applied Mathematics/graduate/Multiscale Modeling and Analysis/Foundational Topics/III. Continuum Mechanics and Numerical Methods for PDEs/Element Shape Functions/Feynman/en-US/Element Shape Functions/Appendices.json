{
    "hands_on_practices": [
        {
            "introduction": "This exercise provides a foundational starting point for working with shape functions. By deriving the one-dimensional quadratic shape functions from first principles, specifically the Kronecker-delta property, you will solidify your understanding of how Lagrange polynomials are constructed to serve as a basis for interpolation within an element. This practice  is essential for building the intuition needed to tackle more complex, higher-dimensional elements.",
            "id": "3753697",
            "problem": "In the setting of Multiscale Finite Element Method (MsFEM) within Multiscale Modeling and Analysis, consider a one-dimensional isoparametric element on the reference interval $\\xi \\in [-1,1]$ with three nodes located at $\\xi_{-1}=-1$, $\\xi_{0}=0$, and $\\xi_{1}=1$. The macroscale approximation uses element shape functions that are polynomials of degree at most $2$ in the reference coordinate $\\xi$, and must satisfy the following fundamental requirements used for scale-bridging and the patch test: the Kronecker-delta interpolation property at nodes, the partition of unity, and reproduction of any linear field on the element when nodal values are sampled from that field.\n\nUsing only these principles and the standard definition of Lagrange interpolation, derive the explicit quadratic shape functions $N_{-1}(\\xi)$, $N_{0}(\\xi)$, and $N_{1}(\\xi)$ associated with the nodes $\\xi_{-1}=-1$, $\\xi_{0}=0$, and $\\xi_{1}=1$. Your derivation must start from the Kronecker-delta conditions $N_{i}(\\xi_{j})=\\delta_{ij}$, where $\\delta_{ij}$ denotes the Kronecker delta, and produce closed-form expressions for each $N_{i}(\\xi)$ as polynomials in $\\xi$.\n\nExpress your final answer as a single row matrix containing the three shape functions in terms of $\\xi$. No rounding is required. No units are required.",
            "solution": "The problem statement is evaluated and found to be valid. It is a well-posed, scientifically grounded problem from the field of finite element analysis, which is a core component of multiscale modeling. The problem provides all necessary information to derive the required shape functions and contains no contradictions or ambiguities.\n\nThe objective is to derive the quadratic shape functions $N_i(\\xi)$ for a three-node one-dimensional element defined on the reference domain $\\xi \\in [-1, 1]$. The nodes are located at $\\xi_{-1} = -1$, $\\xi_0 = 0$, and $\\xi_1 = 1$. The shape functions are required to be polynomials of at most degree $2$ and must satisfy the Kronecker-delta property at the nodes, $N_i(\\xi_j) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta, defined as 1 if $i=j$ and 0 if $i \\neq j$.\n\nThe most direct and systematic method for constructing polynomial shape functions that satisfy the Kronecker-delta property is to use the general formula for Lagrange interpolation polynomials. For a set of $n+1$ nodes $\\{\\xi_k\\}_{k=0}^n$, the Lagrange basis polynomial $N_i(\\xi)$ associated with node $\\xi_i$ is given by:\n$$\nN_i(\\xi) = \\prod_{j \\neq i} \\frac{\\xi - \\xi_j}{\\xi_i - \\xi_j}\n$$\nBy construction, this formula yields a polynomial of degree $n$ that evaluates to $1$ at $\\xi = \\xi_i$ and $0$ at all other nodes $\\xi_j$ where $j \\neq i$, thus satisfying the condition $N_i(\\xi_j) = \\delta_{ij}$.\n\nIn this problem, we have three nodes ($\\xi_{-1} = -1$, $\\xi_0 = 0$, $\\xi_1 = 1$), so the shape functions will be quadratic polynomials ($n=2$). We apply the Lagrange formula to derive each of the three shape functions.\n\nDerivation of $N_{-1}(\\xi)$:\nThe shape function for the node at $\\xi_{-1} = -1$ must be zero at $\\xi_0 = 0$ and $\\xi_1 = 1$. The indices for the product are $j=0, 1$.\n$$\nN_{-1}(\\xi) = \\frac{\\xi - \\xi_0}{\\xi_{-1} - \\xi_0} \\cdot \\frac{\\xi - \\xi_1}{\\xi_{-1} - \\xi_1}\n$$\nSubstituting the nodal coordinate values:\n$$\nN_{-1}(\\xi) = \\frac{\\xi - 0}{-1 - 0} \\cdot \\frac{\\xi - 1}{-1 - 1} = \\left(\\frac{\\xi}{-1}\\right) \\cdot \\left(\\frac{\\xi - 1}{-2}\\right) = \\frac{\\xi(\\xi - 1)}{2}\n$$\nThis can be expanded to $N_{-1}(\\xi) = \\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi$, which is a quadratic polynomial.\n\nDerivation of $N_0(\\xi)$:\nThe shape function for the node at $\\xi_0 = 0$ must be zero at $\\xi_{-1} = -1$ and $\\xi_1 = 1$. The indices for the product are $j=-1, 1$.\n$$\nN_0(\\xi) = \\frac{\\xi - \\xi_{-1}}{\\xi_0 - \\xi_{-1}} \\cdot \\frac{\\xi - \\xi_1}{\\xi_0 - \\xi_1}\n$$\nSubstituting the nodal coordinate values:\n$$\nN_0(\\xi) = \\frac{\\xi - (-1)}{0 - (-1)} \\cdot \\frac{\\xi - 1}{0 - 1} = \\left(\\frac{\\xi + 1}{1}\\right) \\cdot \\left(\\frac{\\xi - 1}{-1}\\right) = -(\\xi + 1)(\\xi - 1) = -(\\xi^2 - 1) = 1 - \\xi^2\n$$\nThis is also a quadratic polynomial.\n\nDerivation of $N_1(\\xi)$:\nThe shape function for the node at $\\xi_1 = 1$ must be zero at $\\xi_{-1} = -1$ and $\\xi_0 = 0$. The indices for the product are $j=-1, 0$.\n$$\nN_1(\\xi) = \\frac{\\xi - \\xi_{-1}}{\\xi_1 - \\xi_{-1}} \\cdot \\frac{\\xi - \\xi_0}{\\xi_1 - \\xi_0}\n$$\nSubstituting the nodal coordinate values:\n$$\nN_1(\\xi) = \\frac{\\xi - (-1)}{1 - (-1)} \\cdot \\frac{\\xi - 0}{1 - 0} = \\left(\\frac{\\xi + 1}{2}\\right) \\cdot \\left(\\frac{\\xi}{1}\\right) = \\frac{\\xi(\\xi + 1)}{2}\n$$\nThis can be expanded to $N_1(\\xi) = \\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi$, which is a quadratic polynomial.\n\nThe derived shape functions are:\n$N_{-1}(\\xi) = \\frac{1}{2}\\xi(\\xi - 1)$\n$N_0(\\xi) = 1 - \\xi^2$\n$N_1(\\xi) = \\frac{1}{2}\\xi(\\xi + 1)$\n\nAs a matter of verification, these functions also satisfy the partition of unity property, which is another fundamental requirement mentioned in the problem statement. The sum of the shape functions must equal $1$ everywhere on the element:\n$$\n\\sum_{i} N_i(\\xi) = N_{-1}(\\xi) + N_0(\\xi) + N_1(\\xi) = \\left(\\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi\\right) + (1 - \\xi^2) + \\left(\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi\\right)\n$$\n$$\n\\sum_{i} N_i(\\xi) = \\left(\\frac{1}{2} - 1 + \\frac{1}{2}\\right)\\xi^2 + \\left(-\\frac{1}{2} + \\frac{1}{2}\\right)\\xi + 1 = 0 \\cdot \\xi^2 + 0 \\cdot \\xi + 1 = 1\n$$\nThe partition of unity is satisfied. The linear reproduction property is also satisfied by construction for Lagrange polynomials. The derivation based on the Kronecker-delta property via the Lagrange interpolation formula is thus complete and correct.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2}\\xi(\\xi - 1) & 1 - \\xi^2 & \\frac{1}{2}\\xi(\\xi + 1) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Building on the foundational 1D case, this practice moves into two dimensions by tackling the six-node quadratic triangular element. The key skill developed here is the use of barycentric (or area) coordinates, which provide a natural and elegant framework for defining shape functions on simplices like triangles. Mastering this technique  is crucial for working with unstructured meshes, which are predominantly composed of triangular or tetrahedral elements.",
            "id": "2635668",
            "problem": "Consider a nondegenerate triangle in the plane. Define the barycentric (also called area) coordinates $\\{L_{1},L_{2},L_{3}\\}$ associated with its three vertices, which satisfy $L_{1}+L_{2}+L_{3}=1$ everywhere in the triangle, and take the nodal values $(L_{1},L_{2},L_{3})=(1,0,0)$ at vertex $1$, $(0,1,0)$ at vertex $2$, and $(0,0,1)$ at vertex $3$. A six-node quadratic Lagrange finite element on this triangle has the three additional midside nodes located at the midpoints of edges $(2,3)$, $(3,1)$, and $(1,2)$, whose barycentric coordinates are $(0,\\tfrac{1}{2},\\tfrac{1}{2})$, $(\\tfrac{1}{2},0,\\tfrac{1}{2})$, and $(\\tfrac{1}{2},\\tfrac{1}{2},0)$, respectively. Let the nodal ordering be $1,2,3$ for the vertices and $4,5,6$ for the midsides opposite vertices $1,2,3$, respectively (i.e., node $4$ is on edge $(2,3)$, node $5$ is on edge $(3,1)$, and node $6$ is on edge $(1,2)$).\n\nStarting only from the defining properties of barycentric coordinates and the nodal interpolation (Kronecker delta) property for quadratic Lagrange shape functions on a simplex, construct the six quadratic shape functions $\\{N_{i}(L_{1},L_{2},L_{3})\\}_{i=1}^{6}$ explicitly in terms of $L_{1},L_{2},L_{3}$. Then verify, by direct evaluation, that at each midside node the corresponding shape function takes the value $1$ while all other shape functions vanish.\n\nExpress your final answer as the ordered row vector $\\big(N_{1},N_{2},N_{3},N_{4},N_{5},N_{6}\\big)$ in terms of $L_{1},L_{2},L_{3}$. No numerical rounding is required. No units are involved.",
            "solution": "The problem statement is assessed as valid. It is scientifically grounded in the theory of finite element analysis, presents a well-posed mathematical task with all necessary data, and is formulated with objective, unambiguous language. We shall proceed with the derivation.\n\nThe objective is to construct six quadratic shape functions $N_i(L_1, L_2, L_3)$ for a six-node triangular element. These functions must satisfy the Kronecker delta property at the six nodes of the element, i.e., $N_i(\\text{node } j) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta. The nodes are defined by their barycentric coordinates:\n- Vertex 1: $(1, 0, 0)$\n- Vertex 2: $(0, 1, 0)$\n- Vertex 3: $(0, 0, 1)$\n- Midside 4 (opposite vertex 1): $(0, \\tfrac{1}{2}, \\tfrac{1}{2})$\n- Midside 5 (opposite vertex 2): $(\\tfrac{1}{2}, 0, \\tfrac{1}{2})$\n- Midside 6 (opposite vertex 3): $(\\tfrac{1}{2}, \\tfrac{1}{2}, 0)$\n\nThe shape functions must be quadratic polynomials in the barycentric coordinates. A general approach for constructing Lagrange interpolation polynomials on a simplex is to form products of linear functions that vanish at the appropriate nodes.\n\nFirst, we construct the shape functions for the vertex nodes, $N_1$, $N_2$, and $N_3$.\n\nConsider the shape function $N_1$, associated with vertex 1. It must be equal to $1$ at node 1 and $0$ at nodes 2, 3, 4, 5, and 6.\nThe nodes 2, 3, and 4 lie on the line defined by $L_1 = 0$.\nThe nodes 5 and 6 lie on the line defined by $L_1 = \\tfrac{1}{2}$. This line passes through $(\\tfrac{1}{2}, 0, \\tfrac{1}{2})$ and $(\\tfrac{1}{2}, \\tfrac{1}{2}, 0)$.\nTherefore, the function $N_1$ must vanish on the lines $L_1=0$ and $L_1=\\tfrac{1}{2}$. A quadratic polynomial that satisfies this condition is of the form $C \\cdot L_1 \\cdot (L_1 - \\tfrac{1}{2})$.\nWe write $N_1 = C \\cdot L_1 (L_1 - \\tfrac{1}{2})$.\nTo determine the constant $C$, we use the condition $N_1(1,0,0) = 1$.\n$N_1(1,0,0) = C \\cdot 1 \\cdot (1 - \\tfrac{1}{2}) = \\tfrac{1}{2} C$.\nSetting $\\tfrac{1}{2} C = 1$ gives $C = 2$.\nThus, the shape function for node 1 is:\n$N_1 = 2 L_1 (L_1 - \\tfrac{1}{2}) = L_1(2L_1 - 1)$.\nUsing the fundamental property $L_1+L_2+L_3=1$, we can also express this as $N_1 = L_1(L_1 - L_2 - L_3)$.\n\nBy symmetry, the shape functions for the other two vertex nodes, 2 and 3, are:\n$N_2 = L_2(2L_2 - 1)$\n$N_3 = L_3(2L_3 - 1)$\n\nNext, we construct the shape functions for the midside nodes, $N_4$, $N_5$, and $N_6$.\n\nConsider the shape function $N_4$, associated with the midside node 4. It must equal $1$ at node 4 and $0$ at all other nodes.\nNode 4 has coordinates $(0, \\tfrac{1}{2}, \\tfrac{1}{2})$.\nThe nodes at which $N_4$ must vanish are 1, 2, 3, 5, 6.\nNodes 1, 5, 3 lie on the line $L_2=0$.\nNodes 1, 6, 2 lie on the line $L_3=0$.\nThe product of these two linear functions, $L_2 L_3$, is a quadratic polynomial that vanishes at all nodes except node 4.\nSo, we can propose a form for $N_4$ as $N_4 = C \\cdot L_2 L_3$.\nTo determine the constant $C$, we use the condition $N_4(0, \\tfrac{1}{2}, \\tfrac{1}{2}) = 1$.\n$N_4(0, \\tfrac{1}{2}, \\tfrac{1}{2}) = C \\cdot (\\tfrac{1}{2}) \\cdot (\\tfrac{1}{2}) = \\tfrac{1}{4} C$.\nSetting $\\tfrac{1}{4} C = 1$ gives $C = 4$.\nThus, the shape function for node 4 is:\n$N_4 = 4L_2 L_3$.\n\nBy symmetry, the shape functions for the other two midside nodes, 5 and 6, are:\n$N_5 = 4L_3 L_1$ (vanishes on $L_3=0$ and $L_1=0$)\n$N_6 = 4L_1 L_2$ (vanishes on $L_1=0$ and $L_2=0$)\n\nThe complete set of six quadratic shape functions is:\n$N_1 = L_1(2L_1-1)$\n$N_2 = L_2(2L_2-1)$\n$N_3 = L_3(2L_3-1)$\n$N_4 = 4L_2L_3$\n$N_5 = 4L_1L_3$\n$N_6 = 4L_1L_2$\n\nAs required, we now verify the interpolation property at the midside nodes.\n\nVerification at node 4, with coordinates $(L_1, L_2, L_3) = (0, \\tfrac{1}{2}, \\tfrac{1}{2})$:\n$N_1 = 0 \\cdot (2 \\cdot 0 - 1) = 0$\n$N_2 = \\tfrac{1}{2} \\cdot (2 \\cdot \\tfrac{1}{2} - 1) = \\tfrac{1}{2} \\cdot (1-1) = 0$\n$N_3 = \\tfrac{1}{2} \\cdot (2 \\cdot \\tfrac{1}{2} - 1) = \\tfrac{1}{2} \\cdot (1-1) = 0$\n$N_4 = 4 \\cdot \\tfrac{1}{2} \\cdot \\tfrac{1}{2} = 1$\n$N_5 = 4 \\cdot 0 \\cdot \\tfrac{1}{2} = 0$\n$N_6 = 4 \\cdot 0 \\cdot \\tfrac{1}{2} = 0$\nThe property is satisfied for node 4.\n\nVerification at node 5, with coordinates $(L_1, L_2, L_3) = (\\tfrac{1}{2}, 0, \\tfrac{1}{2})$:\n$N_1 = \\tfrac{1}{2} \\cdot (2 \\cdot \\tfrac{1}{2} - 1) = \\tfrac{1}{2} \\cdot (1-1) = 0$\n$N_2 = 0 \\cdot (2 \\cdot 0 - 1) = 0$\n$N_3 = \\tfrac{1}{2} \\cdot (2 \\cdot \\tfrac{1}{2} - 1) = \\tfrac{1}{2} \\cdot (1-1) = 0$\n$N_4 = 4 \\cdot 0 \\cdot \\tfrac{1}{2} = 0$\n$N_5 = 4 \\cdot \\tfrac{1}{2} \\cdot \\tfrac{1}{2} = 1$\n$N_6 = 4 \\cdot \\tfrac{1}{2} \\cdot 0 = 0$\nThe property is satisfied for node 5.\n\nVerification at node 6, with coordinates $(L_1, L_2, L_3) = (\\tfrac{1}{2}, \\tfrac{1}{2}, 0)$:\n$N_1 = \\tfrac{1}{2} \\cdot (2 \\cdot \\tfrac{1}{2} - 1) = \\tfrac{1}{2} \\cdot (1-1) = 0$\n$N_2 = \\tfrac{1}{2} \\cdot (2 \\cdot \\tfrac{1}{2} - 1) = \\tfrac{1}{2} \\cdot (1-1) = 0$\n$N_3 = 0 \\cdot (2 \\cdot 0 - 1) = 0$\n$N_4 = 4 \\cdot \\tfrac{1}{2} \\cdot 0 = 0$\n$N_5 = 4 \\cdot 0 \\cdot \\tfrac{1}{2} = 0$\n$N_6 = 4 \\cdot \\tfrac{1}{2} \\cdot \\tfrac{1}{2} = 1$\nThe property is satisfied for node 6.\n\nThe verification is complete. The derived functions are correct. As a final check of rigor, we can verify the partition of unity property, $\\sum_{i=1}^{6} N_i = 1$:\n$\\sum N_i = (2L_1^2 - L_1) + (2L_2^2 - L_2) + (2L_3^2 - L_3) + 4L_1L_2 + 4L_2L_3 + 4L_1L_3$\n$= 2(L_1^2 + L_2^2 + L_3^2 + 2L_1L_2 + 2L_2L_3 + 2L_1L_3) - (L_1+L_2+L_3)$\n$= 2(L_1+L_2+L_3)^2 - (L_1+L_2+L_3)$\nUsing the identity $L_1+L_2+L_3=1$, we get:\n$\\sum N_i = 2(1)^2 - 1 = 1$.\nThe partition of unity is satisfied, confirming the correctness of the shape functions. The ordered vector of the six shape functions is the required result.",
            "answer": "$$\\boxed{\\begin{pmatrix} L_1(2L_1-1) & L_2(2L_2-1) & L_3(2L_3-1) & 4L_2 L_3 & 4L_1 L_3 & 4L_1 L_2 \\end{pmatrix}}$$"
        },
        {
            "introduction": "This final practice bridges the gap between the idealized reference element and the practical reality of distorted elements in a physical mesh. By analyzing the isoparametric mapping for a bilinear quadrilateral, you will uncover the critical link between element geometry and approximation accuracy, specifically how non-parallelogram shapes can compromise an element's ability to reproduce even simple linear fields. This exercise  illuminates the importance of the Jacobian determinant as a measure of mapping quality and introduces fundamental concepts behind mesh quality metrics.",
            "id": "3753715",
            "problem": "Consider a single isoparametric bilinear quadrilateral element with reference coordinates $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ and physical corner nodes $\\boldsymbol{X}_i=(x_i,y_i)$ for $i=1,2,3,4$, ordered counterclockwise starting at the image of $(-1,-1)$. Let the bilinear shape functions be $N_1(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_2(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_3(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta)$, and $N_4(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta)$. The isoparametric mapping is $\\boldsymbol{x}(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)\\,\\boldsymbol{X}_i$. Let a physical linear field be given by $f(x,y)=a\\,x+b\\,y+c$ with $a$, $b$, and $c$ constants, and define its nodal samples $f_i=f(x_i,y_i)$ for $i=1,2,3,4$. Consider the $Q_1$ interpolant $u_h(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)\\,f_i$.\n\nStarting only from the definitions above and without invoking any element-specific shortcut formulas, do the following:\n\n1. Expand $u_h(\\xi,\\eta)$ as a polynomial in $\\xi$ and $\\eta$ and identify the coefficient of the mixed term $\\xi\\,\\eta$ in closed form in terms of $a$, $b$, and the node coordinates $\\{(x_i,y_i)\\}_{i=1}^{4}$. Express this coefficient as a single analytic expression.\n2. Using the result of part 1 and fundamental properties of affine maps, explain under what geometric condition on $\\{\\boldsymbol{X}_i\\}_{i=1}^{4}$ the interpolant $u_h$ represents a linear function of the physical coordinates $(x,y)$, and interpret this condition geometrically.\n3. Let $\\boldsymbol{J}(\\xi,\\eta)$ denote the Jacobian of the isoparametric mapping, and let $\\det \\boldsymbol{J}(\\xi,\\eta)$ denote its determinant. The Jacobian is given by:\n$$ \\boldsymbol{J}(\\xi,\\eta)=\\begin{pmatrix}\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta}\\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\\end{pmatrix} $$\nDerive the dependence of $\\det \\boldsymbol{J}(\\xi,\\eta)$ on $\\xi$ and $\\eta$ and use this to justify two scalar mesh quality metrics that, if enforced with positive lower bounds at appropriate sampling points, guarantee $\\det \\boldsymbol{J}(\\xi,\\eta)>0$ everywhere in the element. Provide explicit formulas for these metrics in terms of the nodal coordinates and edge vectors, and justify their sufficiency using only basic properties of linear functions over convex domains.\n\nThe final answer you provide must be only the coefficient of the mixed term $\\xi\\,\\eta$ from part 1, expressed as a single closed-form analytic expression. Do not include any units. No numerical rounding is required.",
            "solution": "The problem statement is a standard exercise in the theory of isoparametric finite elements and is scientifically grounded, well-posed, objective, and internally consistent. It is therefore deemed valid and a solution is provided below.\n\nThe solution will address the three parts of the problem in sequence, starting from the provided definitions.\n\n### Part 1: Coefficient of the Mixed Term $\\xi\\eta$\n\nThe $Q_1$ interpolant $u_h(\\xi,\\eta)$ is defined as:\n$$\nu_h(\\xi,\\eta) = \\sum_{i=1}^{4}N_i(\\xi,\\eta)\\,f_i\n$$\nThe shape functions $N_i(\\xi,\\eta)$ and nodal values $f_i$ are given. We expand this summation:\n$$\nu_h(\\xi,\\eta) = N_1(\\xi,\\eta)f_1 + N_2(\\xi,\\eta)f_2 + N_3(\\xi,\\eta)f_3 + N_4(\\xi,\\eta)f_4\n$$\nSubstituting the expressions for the bilinear shape functions $N_i$:\n$$\nu_h(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)f_1 + \\frac{1}{4}(1+\\xi)(1-\\eta)f_2 + \\frac{1}{4}(1+\\xi)(1+\\eta)f_3 + \\frac{1}{4}(1-\\xi)(1+\\eta)f_4\n$$\nTo find the coefficient of the $\\xi\\eta$ term, we expand each product and collect the terms containing $\\xi\\eta$:\n\\begin{itemize}\n    \\item From the first term: $\\frac{1}{4}(1-\\xi-\\eta+\\xi\\eta)f_1$, the $\\xi\\eta$ contribution is $\\frac{1}{4}f_1\\xi\\eta$.\n    \\item From the second term: $\\frac{1}{4}(1+\\xi-\\eta-\\xi\\eta)f_2$, the $\\xi\\eta$ contribution is $-\\frac{1}{4}f_2\\xi\\eta$.\n    \\item From the third term: $\\frac{1}{4}(1+\\xi+\\eta+\\xi\\eta)f_3$, the $\\xi\\eta$ contribution is $\\frac{1}{4}f_3\\xi\\eta$.\n    \\item From the fourth term: $\\frac{1}{4}(1-\\xi+\\eta-\\xi\\eta)f_4$, the $\\xi\\eta$ contribution is $-\\frac{1}{4}f_4\\xi\\eta$.\n\\end{itemize}\nSumming these contributions, the total coefficient of the $\\xi\\eta$ term, which we denote as $C_{\\xi\\eta}$, is:\n$$\nC_{\\xi\\eta} = \\frac{1}{4}(f_1 - f_2 + f_3 - f_4)\n$$\nThe problem requires this coefficient to be expressed in terms of the constants $a$, $b$ and the nodal coordinates $(x_i, y_i)$. The nodal samples are defined by $f_i = f(x_i,y_i) = a\\,x_i+b\\,y_i+c$. Substituting these into the expression for $C_{\\xi\\eta}$:\n$$\nC_{\\xi\\eta} = \\frac{1}{4} \\left[ (a\\,x_1+b\\,y_1+c) - (a\\,x_2+b\\,y_2+c) + (a\\,x_3+b\\,y_3+c) - (a\\,x_4+b\\,y_4+c) \\right]\n$$\nThe constant $c$ terms cancel out: $c-c+c-c=0$. We can group the remaining terms by the coefficients $a$ and $b$:\n$$\nC_{\\xi\\eta} = \\frac{1}{4} \\left[ a(x_1 - x_2 + x_3 - x_4) + b(y_1 - y_2 + y_3 - y_4) \\right]\n$$\nThis is the final expression for the coefficient of the $\\xi\\eta$ term.\n\n### Part 2: Geometric Condition for Linearity\n\nThe interpolant $u_h$ represents a linear function of the physical coordinates $(x,y)$ if the interpolated field, when expressed in terms of $(x,y)$, has the form $A\\,x+B\\,y+C$ for some constants $A$, $B$, $C$.\n\nBy construction of the isoparametric method, the interpolant of a linear function reproduces the function's values at all points within the element, i.e., $u_h(\\xi(\\boldsymbol{x}),\\eta(\\boldsymbol{x})) = f(x,y) = a\\,x+b\\,y+c$. This identity holds for any quadrilateral, and means that the value of the interpolant at a physical point $\\boldsymbol{x}$ is exactly the value of the original linear function $f$ at that point. Thus, by definition, $u_h$ *is* the linear function $f(x,y)$.\n\nHowever, the problem implicitly asks for the condition under which the *functional form* of the interpolant trivializes appropriately. Let us analyze the mapping. The interpolant is a bilinear polynomial in $(\\xi, \\eta)$: $u_h(\\xi, \\eta) = c_0 + c_\\xi\\xi + c_\\eta\\eta + C_{\\xi\\eta}\\xi\\eta$. The physical coordinates are also given by a bilinear mapping: $\\boldsymbol{x}(\\xi, \\eta) = \\sum_{i=1}^4 N_i(\\xi, \\eta) \\boldsymbol{X}_i$. For $u_h$ to be a linear function of $(x,y)$, we require a compatibility between these two representations.\n\nAn affine map $\\boldsymbol{x} = \\boldsymbol{A} \\boldsymbol{\\xi} + \\boldsymbol{d}$ preserves linearity; that is, a linear function of $\\boldsymbol{\\xi}$ becomes a linear function of $\\boldsymbol{x}$. If the isoparametric map $\\boldsymbol{x}(\\xi,\\eta)$ is affine, its inverse $\\boldsymbol{\\xi}(\\boldsymbol{x})$ is also affine.\nLet's expand the isoparametric map $\\boldsymbol{x}(\\xi,\\eta)$ just as we expanded $u_h$:\n$$\n\\boldsymbol{x}(\\xi,\\eta) = \\frac{1}{4} \\left[ (\\boldsymbol{X}_1+\\boldsymbol{X}_2+\\boldsymbol{X}_3+\\boldsymbol{X}_4) + (-\\boldsymbol{X}_1+\\boldsymbol{X}_2+\\boldsymbol{X}_3-\\boldsymbol{X}_4)\\xi + (-\\boldsymbol{X}_1-\\boldsymbol{X}_2+\\boldsymbol{X}_3+\\boldsymbol{X}_4)\\eta + (\\boldsymbol{X}_1-\\boldsymbol{X}_2+\\boldsymbol{X}_3-\\boldsymbol{X}_4)\\xi\\eta \\right]\n$$\nFor this map to be affine, the coefficient of the non-linear term $\\xi\\eta$ must be zero. This gives the geometric condition:\n$$\n\\boldsymbol{X}_1 - \\boldsymbol{X}_2 + \\boldsymbol{X}_3 - \\boldsymbol{X}_4 = \\boldsymbol{0}\n$$\nThis vector equation can be rearranged as $\\boldsymbol{X}_1 + \\boldsymbol{X}_3 = \\boldsymbol{X}_2 + \\boldsymbol{X}_4$. Dividing by $2$ gives:\n$$\n\\frac{\\boldsymbol{X}_1+\\boldsymbol{X}_3}{2} = \\frac{\\boldsymbol{X}_2+\\boldsymbol{X}_4}{2}\n$$\nThis equation states that the midpoint of the diagonal connecting nodes $1$ and $3$ must coincide with the midpoint of the diagonal connecting nodes $2$ and $4$. **This is the defining geometric property of a parallelogram.**\n\nIf the element is a parallelogram, this condition holds. Consequently, the coefficient $C_{\\xi\\eta}$ of the $\\xi\\eta$ term in $u_h$ becomes:\n$$\nC_{\\xi\\eta} = \\frac{1}{4} \\left[ a(x_1 - x_2 + x_3 - x_4) + b(y_1 - y_2 + y_3 - y_4) \\right] = \\frac{1}{4} \\left[ a(0) + b(0) \\right] = 0\n$$\nSince $C_{\\xi\\eta}=0$, the interpolant $u_h(\\xi, \\eta)$ becomes linear in $(\\xi, \\eta)$. As the mapping from physical to reference coordinates $\\boldsymbol{\\xi}(\\boldsymbol{x})$ is affine for a parallelogram, substituting $\\xi(x,y)$ and $\\eta(x,y)$ into a linear function of $(\\xi, \\eta)$ results in a function that is linear in $(x,y)$. Therefore, for the interpolant $u_h$ of *any* linear field to be a linear function of $(x,y)$, the quadrilateral element must be a parallelogram.\n\n### Part 3: Jacobian Determinant and Mesh Quality Metrics\n\nThe Jacobian of the isoparametric mapping is $\\boldsymbol{J}(\\xi,\\eta) = \\begin{pmatrix} \\frac{\\partial\\boldsymbol{x}}{\\partial\\xi} & \\frac{\\partial\\boldsymbol{x}}{\\partial\\eta} \\end{pmatrix}$. The columns are the tangent vectors.\n$$\n\\frac{\\partial\\boldsymbol{x}}{\\partial\\xi} = \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial\\xi} \\boldsymbol{X}_i \\quad \\text{and} \\quad \\frac{\\partial\\boldsymbol{x}}{\\partial\\eta} = \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial\\eta} \\boldsymbol{X}_i\n$$\nThe derivatives of the shape functions are linear in $\\xi$ or $\\eta$. For example, $\\frac{\\partial N_1}{\\partial\\xi} = -\\frac{1}{4}(1-\\eta)$ and $\\frac{\\partial N_1}{\\partial\\eta} = -\\frac{1}{4}(1-\\xi)$. As a result, the tangent vectors $\\frac{\\partial\\boldsymbol{x}}{\\partial\\xi}$ and $\\frac{\\partial\\boldsymbol{x}}{\\partial\\eta}$ are linear functions of $\\eta$ and $\\xi$, respectively.\nLet's assemble the tangent vectors:\n$$\n\\frac{\\partial\\boldsymbol{x}}{\\partial\\xi} = \\frac{1}{4} [ (\\boldsymbol{X}_2-\\boldsymbol{X}_1)(1-\\eta) + (\\boldsymbol{X}_3-\\boldsymbol{X}_4)(1+\\eta) ]\n$$\n$$\n\\frac{\\partial\\boldsymbol{x}}{\\partial\\eta} = \\frac{1}{4} [ (\\boldsymbol{X}_4-\\boldsymbol{X}_1)(1-\\xi) + (\\boldsymbol{X}_3-\\boldsymbol{X}_2)(1+\\xi) ]\n$$\nThe determinant, $\\det\\boldsymbol{J}(\\xi,\\eta) = \\det(\\frac{\\partial\\boldsymbol{x}}{\\partial\\xi}, \\frac{\\partial\\boldsymbol{x}}{\\partial\\eta})$, is a polynomial in $\\xi$ and $\\eta$. Expanding the determinant using its bilinearity reveals that cross-terms like $\\xi^2$, $\\eta^2$, $\\xi^2\\eta$, etc., are not generated. The highest order term is $\\xi\\eta$, but upon calculation, its coefficient is zero. The resulting expression is linear in $\\xi$ and $\\eta$:\n$$\n\\det\\boldsymbol{J}(\\xi,\\eta) = J_0 + J_\\xi \\xi + J_\\eta \\eta\n$$\nfor some constants $J_0, J_\\xi, J_\\eta$ that depend on the nodal coordinates. A linear function defined on a convex domain, such as the reference square $[-1,1]\\times[-1,1]$, attains its minimum and maximum values at the vertices of the domain. In this case, the vertices are the four corner points $(\\xi, \\eta) \\in \\{(-1,-1), (1,-1), (1,1), (-1,1)\\}$.\n\nTherefore, a sufficient condition to guarantee $\\det\\boldsymbol{J}(\\xi,\\eta)>0$ everywhere in the element is to ensure that $\\det\\boldsymbol{J}(\\xi,\\eta)$ is positive at these four corner points. This leads to the following proposed metrics.\n\n**Metric 1: Minimum Corner Jacobian ($J_{min}$)**\nThis metric is the minimum of the Jacobian determinant evaluated at the four corners of the reference element.\n$$\nJ_{min} = \\min \\{ \\det\\boldsymbol{J}(-1,-1), \\det\\boldsymbol{J}(1,-1), \\det\\boldsymbol{J}(1,1), \\det\\boldsymbol{J}(-1,1) \\}\n$$\nLet's provide explicit formulas. Let $\\boldsymbol{E}_{ij} = \\boldsymbol{X}_j - \\boldsymbol{X}_i$ be the edge vector from node $i$ to node $j$. The Jacobian determinants at the corners are:\n\\begin{itemize}\n    \\item $\\det\\boldsymbol{J}(-1,-1) = \\det(\\frac{1}{2}\\boldsymbol{E}_{12}, \\frac{1}{2}\\boldsymbol{E}_{14}) = \\frac{1}{4}\\det(\\boldsymbol{E}_{12}, \\boldsymbol{E}_{14})$. This is half the signed area of the triangle formed by nodes $1$, $2$, and $4$.\n    \\item $\\det\\boldsymbol{J}(1,-1) = \\det(\\frac{1}{2}\\boldsymbol{E}_{12}, \\frac{1}{2}\\boldsymbol{E}_{23}) = \\frac{1}{4}\\det(\\boldsymbol{E}_{12}, \\boldsymbol{E}_{23})$.\n    \\item $\\det\\boldsymbol{J}(1,1) = \\det(\\frac{1}{2}\\boldsymbol{E}_{43}, \\frac{1}{2}\\boldsymbol{E}_{23}) = \\frac{1}{4}\\det(\\boldsymbol{E}_{43}, \\boldsymbol{E}_{23})$.\n    \\item $\\det\\boldsymbol{J}(-1,1) = \\det(\\frac{1}{2}\\boldsymbol{E}_{43}, \\frac{1}{2}\\boldsymbol{E}_{14}) = \\frac{1}{4}\\det(\\boldsymbol{E}_{43}, \\boldsymbol{E}_{14})$.\n\\end{itemize}\nEnforcing the condition $J_{min} > \\epsilon > 0$ for some small positive $\\epsilon$ guarantees that $\\det\\boldsymbol{J}(\\xi,\\eta) > 0$ everywhere within the element.\n\n**Metric 2: Center Jacobian ($J_{center}$)**\nThis metric is the Jacobian determinant evaluated at the center of the reference element, $(\\xi,\\eta) = (0,0)$.\n$$\nJ_{center} = \\det\\boldsymbol{J}(0,0)\n$$\nThe tangent vectors at the center are:\n$$\n\\frac{\\partial\\boldsymbol{x}}{\\partial\\xi}(0,0) = \\frac{1}{2}\\left(\\frac{\\boldsymbol{X}_2+\\boldsymbol{X}_3}{2} - \\frac{\\boldsymbol{X}_1+\\boldsymbol{X}_4}{2}\\right) \\quad \\text{and} \\quad \\frac{\\partial\\boldsymbol{x}}{\\partial\\eta}(0,0) = \\frac{1}{2}\\left(\\frac{\\boldsymbol{X}_3+\\boldsymbol{X}_4}{2} - \\frac{\\boldsymbol{X}_1+\\boldsymbol{X}_2}{2}\\right)\n$$\nThese vectors connect the midpoints of opposite sides of the quadrilateral. $J_{center}$ is the determinant of these two vectors. Enforcing $J_{center} > \\delta > 0$ is a necessary but not sufficient condition for a valid element, as it does not prevent folding near the boundaries.\n\n**Justification:**\nThe question asks for two metrics that, when enforced, guarantee positivity. The single metric $J_{min} > \\epsilon$ is mathematically sufficient on its own. However, in practice, mesh generation algorithms often rely on multiple criteria. A common practice is to monitor both the Jacobian at the element center (as a measure of average element size and orientation) and a measure of distortion. The combination of enforcing positive lower bounds on both $J_{center}$ and $J_{min}$ constitutes a valid and practical set of two metrics. If $J_{min} > \\epsilon_1 > 0$ is enforced, then $J_{center}$ is guaranteed to be positive. Therefore, the pair of conditions $\\{J_{min} > \\epsilon_1 > 0, J_{center} > \\epsilon_2 > 0\\}$ is a robust set that guarantees a valid mapping, with the first condition being the stronger and sufficient one. These are computed at well-defined sampling points (corners and center).",
            "answer": "$$ \\boxed{\\frac{1}{4} \\left[ a(x_1 - x_2 + x_3 - x_4) + b(y_1 - y_2 + y_3 - y_4) \\right]} $$"
        }
    ]
}