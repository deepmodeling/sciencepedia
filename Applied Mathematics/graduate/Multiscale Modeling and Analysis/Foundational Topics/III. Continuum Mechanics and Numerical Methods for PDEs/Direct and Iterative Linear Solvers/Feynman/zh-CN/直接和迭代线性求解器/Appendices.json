{
    "hands_on_practices": [
        {
            "introduction": "雅可比（Jacobi）法是一种基础的迭代求解器，但其收敛性并非总是得到保证。本练习通过分析一个导致雅可比法失效的矩阵，来探讨其核心收敛条件。你将进一步研究如何通过对角扰动（一种正则化形式）来稳定该方法并确保其收敛，从而深入理解迭代矩阵谱半径在收敛判据中的关键作用。",
            "id": "3749921",
            "problem": "考虑一个线性系统 $A x = b$，该系统源于多尺度离散化中的双尺度耦合，其中粗尺度消元产生了一个具有强节点间耦合的稠密、对称半正定算子。设该粗尺度算子由以下矩阵建模\n$$\nA \\in \\mathbb{R}^{3 \\times 3}, \\quad\nA = \\begin{pmatrix}\n1  2  2 \\\\\n2  1  2 \\\\\n2  2  1\n\\end{pmatrix}.\n$$\n通过矩阵分裂 $A = D + L + U$ 定义标准雅可比方法，其中 $D$ 是 $A$ 的对角部分，$L$ 是其严格下三角部分，$U$ 是其严格上三角部分。雅可比迭代为 $x^{(k+1)} = D^{-1}(b - (L+U) x^{(k)})$，其迭代矩阵为 $G_{J} = -D^{-1}(L+U)$。雅可比方法的收敛性由谱半径（SR）准则决定，即雅可比方法收敛当且仅当 $\\rho(G_{J})  1$，其中 $\\rho(\\cdot)$ 表示谱半径。\n\n任务：\n- 通过计算 $\\rho(G_{J})$，构造并明确证明上述矩阵 $A$ 是一个雅可比方法不收敛的反例。\n- 现在考虑一个受粗尺度惩罚正则化启发的对角稳定化：定义扰动算子 $A_{\\gamma} = A + \\gamma I$，其中 $I$ 是单位矩阵，$\\gamma \\in \\mathbb{R}$ 是一个标量。对于应用于 $A_{\\gamma}$ 的雅可比方法，推导确保 $\\rho(G_{J}(\\gamma))  1$ 的关于 $\\gamma$ 的确切条件，并确定临界阈值 $\\gamma_{\\star}$，使得对于所有 $\\gamma > \\gamma_{\\star}$，雅可比方法均收敛。\n\n以临界阈值 $\\gamma_{\\star}$ 的精确解析值的形式提供最终答案。无需四舍五入，不涉及物理单位。",
            "solution": "该问题要求分析给定矩阵 $A$ 及其扰动版本 $A_{\\gamma}$ 的雅可比方法的收敛性。该问题提法恰当，具有科学依据，并包含了求解所需的全部信息。\n\n问题分为两个任务。第一，证明雅可比方法对矩阵 $A$ 不收敛。第二，找出当该方法应用于扰动矩阵 $A_{\\gamma}$ 时，使其收敛的稳定化参数 $\\gamma$ 所需满足的条件。\n\n**第一部分：矩阵 $A$ 的收敛性分析**\n\n给定矩阵为：\n$$\nA = \\begin{pmatrix}\n1  2  2 \\\\\n2  1  2 \\\\\n2  2  1\n\\end{pmatrix}\n$$\n雅可比方法由矩阵分裂 $A = D + L + U$ 定义，其中 $D$ 是 $A$ 的对角部分，$L$ 是严格下三角部分，$U$ 是严格上三角部分。\n对于给定的矩阵 $A$，我们有：\n$$\nD = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix} = I\n$$\n$$\nL + U = \\begin{pmatrix}\n0  2  2 \\\\\n2  0  2 \\\\\n2  2  0\n\\end{pmatrix}\n$$\n雅可比迭代矩阵 $G_{J}$ 由 $G_{J} = -D^{-1}(L+U)$ 给出。\n由于 $D = I$，其逆矩阵为 $D^{-1} = I$。因此，迭代矩阵为：\n$$\nG_{J} = -I (L+U) = -(L+U) = \\begin{pmatrix}\n0  -2  -2 \\\\\n-2  0  -2 \\\\\n-2  -2  0\n\\end{pmatrix}\n$$\n雅可比方法的收敛性由迭代矩阵的谱半径 $\\rho(G_{J})$ 决定。该方法收敛当且仅当 $\\rho(G_{J})  1$。谱半径是 $G_{J}$ 的特征值的最大绝对值。\n\n为求出 $G_{J}$ 的特征值 $\\lambda$，我们求解特征方程 $\\det(G_{J} - \\lambda I) = 0$：\n$$\n\\det \\begin{pmatrix}\n-\\lambda  -2  -2 \\\\\n-2  -\\lambda  -2 \\\\\n-2  -2  -\\lambda\n\\end{pmatrix} = 0\n$$\n展开行列式：\n$$\n(-\\lambda)((-\\lambda)(-\\lambda) - (-2)(-2)) - (-2)((-2)(-\\lambda) - (-2)(-2)) + (-2)((-2)(-2) - (-\\lambda)(-2)) = 0\n$$\n$$\n-\\lambda(\\lambda^2 - 4) + 2(2\\lambda - 4) - 2(4 - 2\\lambda) = 0\n$$\n$$\n-\\lambda^3 + 4\\lambda + 4\\lambda - 8 - 8 + 4\\lambda = 0\n$$\n$$\n-\\lambda^3 + 12\\lambda - 16 = 0\n$$\n两边乘以 $-1$，我们得到特征多项式：\n$$\n\\lambda^3 - 12\\lambda + 16 = 0\n$$\n我们可以求出该多项式的根。根据有理根定理，我们可以测试 $16$ 的整数因子。\n当 $\\lambda = 2$ 时：$2^3 - 12(2) + 16 = 8 - 24 + 16 = 0$。因此，$\\lambda = 2$ 是一个根。\n我们可以用 $(\\lambda - 2)$ 进行多项式除法：\n$$\n\\frac{\\lambda^3 - 12\\lambda + 16}{\\lambda - 2} = \\lambda^2 + 2\\lambda - 8\n$$\n这个二次因子可以被进一步分解：$\\lambda^2 + 2\\lambda - 8 = (\\lambda + 4)(\\lambda - 2)$。\n所以，特征方程为 $(\\lambda - 2)(\\lambda + 4)(\\lambda - 2) = 0$，可简化为 $(\\lambda - 2)^2(\\lambda + 4) = 0$。\n$G_{J}$ 的特征值为 $\\lambda_1 = -4$，$\\lambda_2 = 2$ 和 $\\lambda_3 = 2$。\n\n谱半径为 $\\rho(G_{J}) = \\max \\{|\\lambda_1|, |\\lambda_2|, |\\lambda_3|\\} = \\max \\{|-4|, |2|, |2|\\} = 4$。\n由于 $\\rho(G_{J}) = 4 \\ge 1$，应用于矩阵 $A$ 的雅可比方法不收敛。这就完成了第一个任务。\n\n**第二部分：扰动矩阵 $A_{\\gamma}$ 的收敛性分析**\n\n现在，我们考虑扰动矩阵 $A_{\\gamma} = A + \\gamma I$，其中 $\\gamma \\in \\mathbb{R}$。\n$$\nA_{\\gamma} = \\begin{pmatrix}\n1  2  2 \\\\\n2  1  2 \\\\\n2  2  1\n\\end{pmatrix} + \\gamma \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix} = \\begin{pmatrix}\n1+\\gamma  2  2 \\\\\n2  1+\\gamma  2 \\\\\n2  2  1+\\gamma\n\\end{pmatrix}\n$$\n我们将雅可比方法应用于系统 $A_{\\gamma}x = b$。$A_{\\gamma}$ 的分裂为 $A_{\\gamma} = D_{\\gamma} + L_{\\gamma} + U_{\\gamma}$。\n$$\nD_{\\gamma} = \\begin{pmatrix}\n1+\\gamma  0  0 \\\\\n0  1+\\gamma  0 \\\\\n0  0  1+\\gamma\n\\end{pmatrix} = (1+\\gamma)I\n$$\n非对角部分保持不变，因此 $L_{\\gamma} + U_{\\gamma} = L+U$。\n新的雅可比迭代矩阵 $G_{J}(\\gamma)$ 为：\n$$\nG_{J}(\\gamma) = -D_{\\gamma}^{-1}(L_{\\gamma}+U_{\\gamma})\n$$\n为使 $D_{\\gamma}$ 可逆，必须有 $1+\\gamma \\neq 0$。假设此条件成立，则 $D_{\\gamma}^{-1} = \\frac{1}{1+\\gamma}I$。\n$$\nG_{J}(\\gamma) = -\\left(\\frac{1}{1+\\gamma}I\\right)(L+U) = \\frac{1}{1+\\gamma} \\left( - (L+U) \\right) = \\frac{1}{1+\\gamma} G_{J}\n$$\n如果 $\\lambda$ 是 $G_{J}$ 的一个特征值，其对应的特征向量为 $v$，则 $G_{J}v = \\lambda v$。\n对于新的迭代矩阵，我们有：\n$$\nG_{J}(\\gamma)v = \\frac{1}{1+\\gamma} G_{J}v = \\frac{\\lambda}{1+\\gamma} v\n$$\n因此，$G_{J}(\\gamma)$ 的特征值（我们称之为 $\\mu$）与 $G_{J}$ 的特征值 $\\lambda$ 之间的关系为 $\\mu = \\frac{\\lambda}{1+\\gamma}$。\n$G_{J}(\\gamma)$ 的特征值为：\n$$\n\\mu_1 = \\frac{-4}{1+\\gamma}, \\quad \\mu_2 = \\frac{2}{1+\\gamma}, \\quad \\mu_3 = \\frac{2}{1+\\gamma}\n$$\n$G_{J}(\\gamma)$ 的谱半径为：\n$$\n\\rho(G_{J}(\\gamma)) = \\max \\left\\{ \\left|\\frac{-4}{1+\\gamma}\\right|, \\left|\\frac{2}{1+\\gamma}\\right| \\right\\} = \\frac{1}{|1+\\gamma|} \\max\\{4, 2\\} = \\frac{4}{|1+\\gamma|}\n$$\n收敛的条件是 $\\rho(G_{J}(\\gamma))  1$。\n$$\n\\frac{4}{|1+\\gamma|}  1\n$$\n这等价于 $|1+\\gamma| > 4$。这个不等式在 $1+\\gamma > 4$ 或 $1+\\gamma  -4$ 时成立。\n情况1：$1+\\gamma > 4 \\implies \\gamma > 3$。\n情况2：$1+\\gamma  -4 \\implies \\gamma  -5$。\n因此，应用于 $A_{\\gamma}$ 的雅可比方法收敛当且仅当 $\\gamma > 3$ 或 $\\gamma  -5$。\n\n问题要求找到临界阈值 $\\gamma_{\\star}$，使得对于所有 $\\gamma > \\gamma_{\\star}$，雅可比方法都收敛。这对应于区间 $(3, \\infty)$。该区间的下界定义了临界阈值。\n因此，临界阈值为 $\\gamma_{\\star} = 3$。",
            "answer": "$$\n\\boxed{3}\n$$"
        },
        {
            "introduction": "对于实际问题，简单的迭代方法通常收敛过慢，因此预处理技术至关重要。本练习将介绍一种强大的预处理技术——不完全 LU（ILU）分解。通过一个涉及舍弃容差 $\\tau$ 的具体例子，你将直接分析预处理器在提高精度（影响收敛速度）和维持稀疏性（影响计算成本）之间的根本性权衡。",
            "id": "3749911",
            "problem": "考虑一个源于双尺度扩散模型的对称正定稀疏矩阵 $A(\\delta) \\in \\mathbb{R}^{3 \\times 3}$。在该模型中，细尺度的最近邻相互作用由三对角线元素编码，而一个粗尺度的非局部相互作用被均质化为第一个和第三个节点之间大小为 $\\delta > 0$ 的弱长程耦合：\n$$\nA(\\delta) \\;=\\; \\begin{pmatrix}\n2  -1  \\delta \\\\\n-1  2  -1 \\\\\n\\delta  -1  2\n\\end{pmatrix}.\n$$\n我们通过执行填充级别为 $k=0$ 的不完全LU分解（ILU），并结合一个绝对丢弃容差 $\\tau > 0$ 来构造一个预处理器 $M$。该容差应用于 $k=0$ 模式所允许的所有元素。规则是：任何原始的或中间的填充元素，其绝对值严格小于 $\\tau$，在分解前都将被设为零。特别地，如果 $\\delta  \\tau$，则位置 $(1,3)$ 和 $(3,1)$ 处的非局部元素被丢弃，从而产生三对角矩阵\n$$\n\\tilde{A} \\;=\\; A(0) \\;=\\; \\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix},\n$$\n并且 $M$ 被取为 $\\tilde{A}$ 在 $k=0$ 模式下的精确LU因子；否则，当 $\\delta \\ge \\tau$ 时，$M$ 被取为 $A(\\delta)$ 在相同 $k=0$ 模式下的精确LU因子。\n\n从分解和预处理的核心定义出发，分析 $\\tau$ 的选择如何影响 $M$ 的稀疏性以及预处理后系统的谱条件。然后，对于一个 $\\delta = 0.2$ 和 $\\tau = 0.3$ 的具体实例，计算谱条件数\n$$\n\\kappa_{2}\\!\\left(M^{-1}A(\\delta)\\right) \\;=\\; \\frac{\\lambda_{\\max}\\!\\left(M^{-1}A(\\delta)\\right)}{\\lambda_{\\min}\\!\\left(M^{-1}A(\\delta)\\right)}\n$$\n其中 $\\lambda_{\\max}$ 和 $\\lambda_{\\min}$ 分别表示最大和最小特征值。将最终数值答案四舍五入到四位有效数字。最终答案表示为一个不带单位的纯数字。",
            "solution": "该问题被评估为有效。它在科学上基于数值线性代数的原理，特别是源于物理模型的稀疏线性系统的预处理技术。该问题是适定的，提供了所有必要的矩阵、参数和定义，从而可以得出一个唯一的解。它的陈述客观，不含矛盾或歧义。\n\n该问题要求对一种特定的预处理策略进行分析，并具体计算一个谱条件数。\n\n第1部分：预处理器分析\n\n预处理器 $M$ 是基于填充级别为 $k=0$ 的不完全LU分解（ILU(0)）和一个丢弃容差 $\\tau$ 构建的。被预处理的矩阵是 $A(\\delta)$。$M$ 的构造取决于 $\\delta$ 和 $\\tau$ 之间的比较。\n\n1.  对稀疏性的影响：预处理器 $M$ 的稀疏性取决于被分解矩阵的稀疏性。根据定义，ILU(0) 过程只允许在原始矩阵非零元素的位置上，因子 $L$ 和 $U$ 中才出现非零元素。\n    *   如果 $\\delta  \\tau$，元素 $A_{13}$ 和 $A_{31}$（都等于 $\\delta$）被丢弃。分解在三对角矩阵 $\\tilde{A} = A(0)$ 上执行。三对角矩阵的LU因子是双对角矩阵，保留了三对角稀疏模式。因此，$M$（代表 $\\tilde{A}$ 的不完全因子）更稀疏。具体来说，其因子的存储对应于一个三对角结构。\n    *   如果 $\\delta \\ge \\tau$，则不会从 $A(\\delta)$ 中丢弃任何元素。ILU(0)分解在 $A(\\delta)$ 上执行，该矩阵在位置 $(1,3)$ 和 $(3,1)$ 处有非零元素。因子 $L$ 和 $U$ 将在这些位置有非零值。因此，得到的预处理器 $M$ 比前一种情况更稠密，因为它保留了 $A(\\delta)$ 的完整稀疏模式。\n\n    总之，相对于 $\\delta$，一个较大的 $\\tau$ 值会通过丢弃弱长程耦合来促进 $M$ 的稀疏性。\n\n2.  对谱条件的影响：预处理器 $M$ 的目标是成为 $A(\\delta)$ 的一个良好近似，使得 $M^{-1}A(\\delta)$ 接近单位矩阵 $I$。$M^{-1}A(\\delta)$ 越接近 $I$，其特征值就越接近 $1$，其谱条件数 $\\kappa_2(M^{-1}A(\\delta))$ 就越小。\n    *   如果 $\\delta  \\tau$，$M$ 由 $\\tilde{A}=A(0)$ 构建。预处理后的矩阵是 $M^{-1}A(\\delta)$。在这种情况下，如果 $\\delta$ 不可忽略，$M^{-1}$ 并不是 $A(\\delta)^{-1}$ 的一个良好近似，因为 $M$ 完全忽略了耦合 $\\delta$。差 $A(\\delta) - M = A(\\delta) - A(0)$ 引入了一个误差，这个误差可能使 $M^{-1}A(\\delta)$ 的特征值偏离 $1$，从而可能增大条件数。\n    *   如果 $\\delta \\ge \\tau$，$M$ 是 $A(\\delta)$ 的 ILU(0) 分解。对于一个具有给定稀疏模式的 $3 \\times 3$ 矩阵，LU分解不会引入任何填充。因此，ILU(0)分解就是精确的LU分解，这意味着 $M = A(\\delta)$。在这种理想情况下，预处理后的矩阵是 $M^{-1}A(\\delta) = (A(\\delta))^{-1}A(\\delta) = I$。所有特征值都为 $1$，条件数为 $\\kappa_2(I) = 1$，这是最优值。\n\n    总之，相对于 $\\delta$，一个较小的 $\\tau$ 值会导致一个更精确的预处理器和一个更好（更小）的条件数，其代价是需要一个更稠密的分解。\n\n第2部分：对于 $\\delta = 0.2$ 和 $\\tau = 0.3$ 的计算\n\n我们得到具体值 $\\delta = 0.2$ 和 $\\tau = 0.3$。由于 $0.2  0.3$，我们有 $\\delta  \\tau$。这对应于我们分析中的第一种情况。\n\n需要预处理的矩阵是：\n$$\nA(\\delta) \\;=\\; A(0.2) \\;=\\; \\begin{pmatrix}\n2  -1  0.2 \\\\\n-1  2  -1 \\\\\n0.2  -1  2\n\\end{pmatrix}\n$$\n根据题目中对于 $\\delta  \\tau$ 的规则，大小为 $\\delta$ 的非对角线元素被丢棄。所得矩阵记为 $\\tilde{A}$，用于构造预处理器 $M$。题目指出，$M$ 被取为 $\\tilde{A}$ 在 $k=0$ 模式下的精确LU因子。对于三对角矩阵 $\\tilde{A}$，精确LU分解不产生任何填充，因此这意味着我们可以取 $M = \\tilde{A}$。\n$$\nM \\;=\\; \\tilde{A} \\;=\\; A(0) \\;=\\; \\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}\n$$\n我们需要计算 $M^{-1}A(0.2)$ 的谱条件数。首先，我们计算 $M$ 的逆矩阵。$M$ 的行列式为：\n$$\n\\det(M) = 2(2 \\cdot 2 - (-1)(-1)) - (-1)(-1 \\cdot 2 - (-1) \\cdot 0) = 2(3) - (-1)(-2) = 6 - 2 = 4\n$$\n逆矩阵 $M^{-1}$ 由 $\\frac{1}{\\det(M)}\\text{adj}(M)$ 给出。伴随矩阵，即代数余子式矩阵的转置，为：\n$$\n\\text{adj}(M) = \\begin{pmatrix}\n3  2  1 \\\\\n2  4  2 \\\\\n1  2  3\n\\end{pmatrix}\n$$\n所以，逆矩阵为：\n$$\nM^{-1} = \\frac{1}{4} \\begin{pmatrix}\n3  2  1 \\\\\n2  4  2 \\\\\n1  2  3\n\\end{pmatrix}\n$$\n接下来，我们计算预处理后的矩阵 $C = M^{-1}A(0.2)$:\n$$\nC = \\frac{1}{4} \\begin{pmatrix}\n3  2  1 \\\\\n2  4  2 \\\\\n1  2  3\n\\end{pmatrix}\n\\begin{pmatrix}\n2  -1  0.2 \\\\\n-1  2  -1 \\\\\n0.2  -1  2\n\\end{pmatrix}\n$$\n执行矩阵乘法：\n$$\n4C = \\begin{pmatrix}\n3(2)+2(-1)+1(0.2)   3(-1)+2(2)+1(-1)   3(0.2)+2(-1)+1(2) \\\\\n2(2)+4(-1)+2(0.2)   2(-1)+4(2)+2(-1)   2(0.2)+4(-1)+2(2) \\\\\n1(2)+2(-1)+3(0.2)   1(-1)+2(2)+3(-1)   1(0.2)+2(-1)+3(2)\n\\end{pmatrix}\n$$\n$$\n4C = \\begin{pmatrix}\n6-2+0.2   -3+4-1   0.6-2+2 \\\\\n4-4+0.4   -2+8-2   0.4-4+4 \\\\\n2-2+0.6   -1+4-3   0.2-2+6\n\\end{pmatrix}\n= \\begin{pmatrix}\n4.2   0   0.6 \\\\\n0.4   4   0.4 \\\\\n0.6   0   4.2\n\\end{pmatrix}\n$$\n除以 $4$:\n$$\nC = \\begin{pmatrix}\n1.05   0   0.15 \\\\\n0.1   1   0.1 \\\\\n0.15   0   1.05\n\\end{pmatrix}\n$$\n为了求出条件数，我们需要矩阵 $C$ 的特征值。我们求解特征方程 $\\det(C - \\lambda I) = 0$:\n$$\n\\det\\begin{pmatrix}\n1.05 - \\lambda   0   0.15 \\\\\n0.1   1 - \\lambda   0.1 \\\\\n0.15   0   1.05 - \\lambda\n\\end{pmatrix} = 0\n$$\n我们沿着第二列展开行列式：\n$$\n(1 - \\lambda) \\det\\begin{pmatrix}\n1.05 - \\lambda   0.15 \\\\\n0.15   1.05 - \\lambda\n\\end{pmatrix} = 0\n$$\n这得到 $(1 - \\lambda) [ (1.05 - \\lambda)^2 - (0.15)^2 ] = 0$。$\\lambda$ 的解可从两个因子中求得：\n1.  $1 - \\lambda = 0 \\implies \\lambda_1 = 1$。\n2.  $(1.05 - \\lambda)^2 - (0.15)^2 = 0 \\implies (1.05 - \\lambda)^2 = (0.15)^2$。\n    两边取平方根得到 $1.05 - \\lambda = \\pm 0.15$。\n    这得到另外两个特征值：\n    $\\lambda_2 = 1.05 - 0.15 = 0.9$。\n    $\\lambda_3 = 1.05 + 0.15 = 1.2$。\n\n预处理矩阵 $C$ 的特征值为 $\\{0.9, 1.0, 1.2\\}$。\n最大特征值是 $\\lambda_{\\max} = 1.2$。\n最小特征值是 $\\lambda_{\\min} = 0.9$。\n\n谱条件数是最大特征值与最小特征值之比：\n$$\n\\kappa_2(M^{-1}A(\\delta)) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{1.2}{0.9} = \\frac{12}{9} = \\frac{4}{3}\n$$\n以小数表示，其值为 $1.3333\\ldots$。四舍五入到四位有效数字得到 $1.333$。",
            "answer": "$$\\boxed{1.333}$$"
        },
        {
            "introduction": "不完全分解（如 ILU 或不完全 Cholesky 分解 IC）虽然功能强大，但可能存在数值不稳定性，即使对于对称正定（SPD）等良态矩阵也可能分解失败。本练习展示了一个对 SPD 矩阵进行 IC 分解时，因出现负主元而中断的案例。你将推导为稳定分解所需的最小对角位移，这种技术被称为修正不完全 Cholesky 分解（MIC），这突显了求解器设计中鲁棒性的重要性。",
            "id": "3749898",
            "problem": "设 $A \\in \\mathbb{R}^{4 \\times 4}$ 是对称矩阵\n$$\nA \\;=\\; \\begin{pmatrix}\n3  1  0  2 \\\\\n1  3  \\sqrt{7}  0 \\\\\n0  \\sqrt{7}  3  -1 \\\\\n2  0  -1  3\n\\end{pmatrix}.\n$$\n你将分析在矩阵 $A$ 的稀疏模式上不进行任何重排序执行的零填充不完全 Cholesky 分解 (IC$(0)$)。从 Cholesky 分解的定义、对称正定 (SPD) 矩阵的概念以及 IC$(0)$ 的算法定义开始：对于一个 SPD 矩阵 $A$，精确的 Cholesky 分解满足 $A = L L^{\\top}$，其中 $L$ 是下三角矩阵；IC$(0)$ 通过相同的递推关系计算 $L$，但会丢弃任何落在 $A$ 的下三角稀疏模式之外的填充元素。\n\n任务：\n1. 通过验证 $A$ 的所有顺序主子式都严格为正，证明 $A$ 是对称正定 (SPD) 矩阵。\n2. 在自然排序 $(1,2,3,4)$ 下，对 $A$ 符号化地执行 IC$(0)$ 算法，并证明分解在最后一个主元处失败，因为计算得到的 $(4,4)$ 位置元素平方根下的数值变为负数。\n3. 一种简单且广泛使用的稳定化方法是带有均匀对角位移的修正不完全 Cholesky (MIC) 分解：用 $A + \\tau I$ 替换 $A$（其中 $\\tau \\ge 0$），并在相同排序下对 $A+\\tau I$ 运行 IC$(0)$。从第一性原理出发，推导出一个关于 $\\tau$ 的显式条件，在该条件下所有 IC$(0)$ 主元都严格为正，并以闭合形式确定满足条件的最小 $\\tau$。\n\n请给出保证对 $A+\\tau I$ 的 IC$(0)$ 分解不会失败的最小 $\\tau$ 值作为最终答案。不要四舍五入；请给出精确的闭合形式解析表达式。",
            "solution": "该问题被评估为有效，因为它在数值线性代数领域有科学依据，问题提出得当、客观且自洽。它是在不完全分解方法分析中的一个标准但详细的练习。我们按顺序解决这三个任务，开始解答。\n\n给定矩阵为\n$$\nA \\;=\\; \\begin{pmatrix}\n3  1  0  2 \\\\\n1  3  \\sqrt{7}  0 \\\\\n0  \\sqrt{7}  3  -1 \\\\\n2  0  -1  3\n\\end{pmatrix}.\n$$\n\n_任务1：证明 $A$ 是对称正定 (SPD) 矩阵_\n\n一个对称矩阵是正定的，当且仅当其所有顺序主子式都严格为正。设 $A_k$ 是大小为 $k \\times k$ 的顺序主子矩阵。我们必须计算 $k \\in \\{1, 2, 3, 4\\}$ 时 $\\det(A_k)$ 的值。\n\n对于 $k=1$：\n第一个顺序主子式为 $\\det(A_1) = |3| = 3$。因为 $3 > 0$，此条件满足。\n\n对于 $k=2$：\n第二个顺序主子式为 $\\det(A_2) = \\det \\begin{pmatrix} 3  1 \\\\ 1  3 \\end{pmatrix} = (3)(3) - (1)(1) = 9 - 1 = 8$。因为 $8 > 0$，此条件满足。\n\n对于 $k=3$：\n第三个顺序主子式为 $\\det(A_3) = \\det \\begin{pmatrix} 3  1  0 \\\\ 1  3  \\sqrt{7} \\\\ 0  \\sqrt{7}  3 \\end{pmatrix}$。\n沿第一行展开：\n$$ \\det(A_3) = 3 \\det \\begin{pmatrix} 3  \\sqrt{7} \\\\ \\sqrt{7}  3 \\end{pmatrix} - 1 \\det \\begin{pmatrix} 1  \\sqrt{7} \\\\ 0  3 \\end{pmatrix} = 3(3 \\cdot 3 - \\sqrt{7} \\cdot \\sqrt{7}) - 1(1 \\cdot 3 - 0 \\cdot \\sqrt{7}) = 3(9-7) - 3 = 3(2) - 3 = 3. $$\n因为 $3 > 0$，此条件满足。\n\n对于 $k=4$：\n第四个顺序主子式为 $\\det(A_4) = \\det(A)$。沿第一行展开：\n$$ \\det(A) = 3 \\det \\begin{pmatrix} 3  \\sqrt{7}  0 \\\\ \\sqrt{7}  3  -1 \\\\ 0  -1  3 \\end{pmatrix} - 1 \\det \\begin{pmatrix} 1  \\sqrt{7}  0 \\\\ 0  3  -1 \\\\ 2  -1  3 \\end{pmatrix} + 0 - 2 \\det \\begin{pmatrix} 1  3  \\sqrt{7} \\\\ 0  \\sqrt{7}  3 \\\\ 2  0  -1 \\end{pmatrix}. $$\n我们计算这些 $3 \\times 3$ 子矩阵的行列式：\n$$ \\det \\begin{pmatrix} 3  \\sqrt{7}  0 \\\\ \\sqrt{7}  3  -1 \\\\ 0  -1  3 \\end{pmatrix} = 3(9-1) - \\sqrt{7}(3\\sqrt{7}-0) = 24-21=3.$$\n$$ \\det \\begin{pmatrix} 1  \\sqrt{7}  0 \\\\ 0  3  -1 \\\\ 2  -1  3 \\end{pmatrix} = 1(9-1) - \\sqrt{7}(0 - (-2)) = 8 - 2\\sqrt{7}. $$\n$$ \\det \\begin{pmatrix} 1  3  \\sqrt{7} \\\\ 0  \\sqrt{7}  3 \\\\ 2  0  -1 \\end{pmatrix} = 1(-\\sqrt{7}-0) - 3(0-6) + \\sqrt{7}(0-2\\sqrt{7}) = -\\sqrt{7} + 18 - 14 = 4-\\sqrt{7}. $$\n将这些代回：\n$$ \\det(A) = 3(3) - 1(8-2\\sqrt{7}) - 2(4-\\sqrt{7}) = 9 - 8 + 2\\sqrt{7} - 8 + 2\\sqrt{7} = -7 + 4\\sqrt{7}. $$\n为了检查符号，我们比较 $4\\sqrt{7}$ 和 $7$。这等价于比较 $(4\\sqrt{7})^2=16 \\cdot 7 = 112$ 和 $7^2=49$。因为 $112 > 49$，我们有 $4\\sqrt{7} > 7$，所以 $\\det(A) = -7+4\\sqrt{7} > 0$。\n所有四个顺序主子式 ($3, 8, 3, -7+4\\sqrt{7}$) 都严格为正。因此，矩阵 $A$ 是对称正定的。\n\n_任务2：执行 IC$(0)$ 并证明其失败_\n\nIC$(0)$ 分解计算一个下三角矩阵 $L$，其稀疏模式与 $A$ 的下三角部分相同。$L$ 的非零元素通过标准的 Cholesky 递推关系计算。设 $L$ 是 IC$(0)$ 因子。所要求的稀疏模式是 $L_{31}=0$ 和 $L_{42}=0$。\n递推关系为：\n$$ L_{ii} = \\sqrt{A_{ii} - \\sum_{k=1}^{i-1} L_{ik}^2} $$\n$$ L_{ij} = \\frac{1}{L_{jj}} \\left( A_{ij} - \\sum_{k=1}^{j-1} L_{ik}L_{jk} \\right) \\quad \\text{for } i>j \\text{ and } A_{ij} \\ne 0 $$\n\n第 1 列 ($j=1$):\n$L_{11} = \\sqrt{A_{11}} = \\sqrt{3}$。\n$L_{21} = A_{21}/L_{11} = 1/\\sqrt{3}$。\n$L_{31} = 0$ (由于稀疏性约束)。\n$L_{41} = A_{41}/L_{11} = 2/\\sqrt{3}$。\n\n第 2 列 ($j=2$):\n$L_{22} = \\sqrt{A_{22} - L_{21}^2} = \\sqrt{3 - (1/\\sqrt{3})^2} = \\sqrt{3 - 1/3} = \\sqrt{8/3}$。\n$L_{32} = \\frac{1}{L_{22}}(A_{32} - L_{31}L_{21}) = \\frac{1}{\\sqrt{8/3}}(\\sqrt{7} - 0 \\cdot 1/\\sqrt{3}) = \\sqrt{7 \\cdot 3/8} = \\sqrt{21/8}$。\n$L_{42} = 0$ (由于稀疏性约束)。\n\n第 3 列 ($j=3$):\n$L_{33} = \\sqrt{A_{33} - L_{31}^2 - L_{32}^2} = \\sqrt{3 - 0^2 - (\\sqrt{21/8})^2} = \\sqrt{3 - 21/8} = \\sqrt{(24-21)/8} = \\sqrt{3/8}$。\n$L_{43} = \\frac{1}{L_{33}}(A_{43} - L_{41}L_{31} - L_{42}L_{32}) = \\frac{1}{\\sqrt{3/8}}(-1 - (2/\\sqrt{3}) \\cdot 0 - 0 \\cdot \\sqrt{21/8}) = -1/\\sqrt{3/8} = -\\sqrt{8/3}$。\n\n第 4 列 ($j=4$):\n我们计算 $L_{44}$ 平方根下的项：\n$$ L_{44}^2 = A_{44} - \\sum_{k=1}^{3} L_{4k}^2 = A_{44} - L_{41}^2 - L_{42}^2 - L_{43}^2 $$\n$$ L_{44}^2 = 3 - (2/\\sqrt{3})^2 - 0^2 - (-\\sqrt{8/3})^2 = 3 - 4/3 - 8/3 = 3 - 12/3 = 3 - 4 = -1. $$\n由于 $L_{44}^2 = -1  0$，其平方根 $L_{44}$ 不是实数。IC$(0)$ 分解在最后一个主元处失败。\n\n_任务3：修正不完全 Cholesky (MIC) 分解和最小位移 $\\tau$_\n\n我们将 IC$(0)$ 应用于 $A' = A + \\tau I$，其中 $\\tau \\ge 0$。对角元素变为 $A'_{ii} = A_{ii} + \\tau = 3+\\tau$。非对角元素保持不变。稀疏模式不改变。我们重新计算因子对角元素的平方，现在记为 $L_{ii}^2(\\tau)$，并强制要求它们都为正。\n\n$L_{11}^2(\\tau) = A'_{11} = 3+\\tau$。对于 $\\tau \\ge 0$，这是正的。\n\n$L_{22}^2(\\tau) = A'_{22} - L_{21}(\\tau)^2 = (3+\\tau) - (A_{21}/L_{11}(\\tau))^2 = (3+\\tau) - 1^2/(3+\\tau) = \\frac{(3+\\tau)^2-1}{3+\\tau} = \\frac{\\tau^2+6\\tau+8}{3+\\tau} = \\frac{(\\tau+2)(\\tau+4)}{3+\\tau}$。对于 $\\tau \\ge 0$，这是正的。\n\n$L_{33}^2(\\tau) = A'_{33} - L_{31}(\\tau)^2 - L_{32}(\\tau)^2 = (3+\\tau) - 0 - (A_{32}/L_{22}(\\tau))^2 = (3+\\tau) - (\\sqrt{7})^2/L_{22}^2(\\tau)$。\n$$ L_{33}^2(\\tau) = (3+\\tau) - \\frac{7(3+\\tau)}{(\\tau+2)(\\tau+4)} = (3+\\tau) \\left( 1 - \\frac{7}{(\\tau+2)(\\tau+4)} \\right) = (3+\\tau) \\frac{\\tau^2+6\\tau+8-7}{\\tau^2+6\\tau+8} = (3+\\tau)\\frac{\\tau^2+6\\tau+1}{\\tau^2+6\\tau+8}. $$\n对于 $\\tau \\ge 0$，项 $3+\\tau$ 和 $\\tau^2+6\\tau+8$ 均为正。项 $\\tau^2+6\\tau+1$ 的根在 $\\tau=-3\\pm\\sqrt{8}$，两者都为负。因此，对于 $\\tau \\ge 0$，$\\tau^2+6\\tau+1 > 0$，且 $L_{33}^2(\\tau)$ 为正。\n\n$L_{44}^2(\\tau) = A'_{44} - L_{41}(\\tau)^2 - L_{42}(\\tau)^2 - L_{43}(\\tau)^2$。\n使用 $L_{41}(\\tau) = A_{41}/L_{11}(\\tau)$，$L_{42}(\\tau)=0$ 和 $L_{43}(\\tau) = A_{43}/L_{33}(\\tau)$：\n$$ L_{44}^2(\\tau) = (3+\\tau) - \\frac{A_{41}^2}{L_{11}^2(\\tau)} - \\frac{A_{43}^2}{L_{33}^2(\\tau)} = (3+\\tau) - \\frac{4}{3+\\tau} - \\frac{1}{L_{33}^2(\\tau)}. $$\n$$ L_{44}^2(\\tau) = \\frac{(3+\\tau)^2-4}{3+\\tau} - \\frac{\\tau^2+6\\tau+8}{(3+\\tau)(\\tau^2+6\\tau+1)} = \\frac{\\tau^2+6\\tau+5}{3+\\tau} - \\frac{\\tau^2+6\\tau+8}{(3+\\tau)(\\tau^2+6\\tau+1)}. $$\n$$ L_{44}^2(\\tau) = \\frac{1}{3+\\tau} \\left( (\\tau^2+6\\tau+5) - \\frac{\\tau^2+6\\tau+8}{\\tau^2+6\\tau+1} \\right). $$\n为使分解不失败，我们需要 $L_{44}^2(\\tau) > 0$。由于 $\\tau \\ge 0$，$3+\\tau > 0$。条件变为：\n$$ (\\tau^2+6\\tau+5) - \\frac{\\tau^2+6\\tau+8}{\\tau^2+6\\tau+1} > 0. $$\n令 $y = \\tau^2+6\\tau$。对于 $\\tau \\ge 0$，我们有 $y \\ge 0$。不等式为：\n$$ (y+5) - \\frac{y+8}{y+1} > 0 \\implies \\frac{(y+5)(y+1) - (y+8)}{y+1} > 0 \\implies \\frac{y^2+6y+5-y-8}{y+1} > 0 \\implies \\frac{y^2+5y-3}{y+1} > 0. $$\n分母是 $y+1 = \\tau^2+6\\tau+1$，我们已经证明了当 $\\tau \\ge 0$ 时它为正。因此，我们需要分子严格为正：\n$$ y^2+5y-3 > 0. $$\n$y^2+5y-3=0$ 的根是 $y = \\frac{-5 \\pm \\sqrt{25-4(1)(-3)}}{2} = \\frac{-5 \\pm \\sqrt{37}}{2}$。\n由于 $y \\ge 0$，我们必须满足 $y > \\frac{-5+\\sqrt{37}}{2}$。\n将 $y=\\tau^2+6\\tau$ 代回：\n$$ \\tau^2+6\\tau > \\frac{\\sqrt{37}-5}{2} \\implies \\tau^2+6\\tau - \\frac{\\sqrt{37}-5}{2} > 0. $$\n为了找到使此不等式成立的 $\\tau$，我们求解二次方程 $\\tau^2+6\\tau - \\frac{\\sqrt{37}-5}{2} = 0$ 的根。\n$$ \\tau = \\frac{-6 \\pm \\sqrt{36 - 4(1)(-\\frac{\\sqrt{37}-5}{2})}}{2} = \\frac{-6 \\pm \\sqrt{36 + 2(\\sqrt{37}-5)}}{2} = \\frac{-6 \\pm \\sqrt{26+2\\sqrt{37}}}{2}. $$\n$$ \\tau = -3 \\pm \\frac{\\sqrt{26+2\\sqrt{37}}}{2} = -3 \\pm \\sqrt{\\frac{26+2\\sqrt{37}}{4}} = -3 \\pm \\sqrt{\\frac{13+\\sqrt{37}}{2}}. $$\n该二次函数在 $\\tau$ 大于较大根或小于较小根时为正。由于我们要求 $\\tau \\ge 0$，我们必须取由正根定义的区域：\n$$ \\tau > -3 + \\sqrt{\\frac{13+\\sqrt{37}}{2}}. $$\n$\\tau$ 的最小值是这个集合的下确界。这个阈值就是问题所求的。",
            "answer": "$$\\boxed{-3 + \\sqrt{\\frac{13+\\sqrt{37}}{2}}}$$"
        }
    ]
}