{
    "hands_on_practices": [
        {
            "introduction": "Before defining complex material behaviors, we must master the language of continuum mechanics. This exercise provides practice with the essential tools for describing large deformations: the relationships between different stress measures (Cauchy, 1st and 2nd Piola-Kirchhoff) and strain rates. By deriving these transformations and verifying the power conjugacy principle, you will solidify your understanding of the energetically consistent framework required for any valid constitutive model.",
            "id": "3745557",
            "problem": "A heterogeneous hyperelastic solid is modeled at the macroscale by a homogenized constitutive response obtained from a Representative Volume Element (RVE). At an instant $t_{0}$, the macroscopic deformation gradient $\\mathbf{F}(t_{0})$ and its material time derivative $\\dot{\\mathbf{F}}(t_{0})$ are measured, and the homogenized Second Piola–Kirchhoff (PK2) stress $\\mathbf{S}(t_{0})$ is reported from the RVE. You may assume the balance of angular momentum holds, the Cauchy stress $\\boldsymbol{\\sigma}$ is symmetric, and the internal power is frame-indifferent. The data are\n$$\n\\mathbf{F}(t_{0})=\\begin{pmatrix}\n1.2 & 0 & 0 \\\\\n0 & 0.8 & 0 \\\\\n0 & 0 & \\frac{25}{24}\n\\end{pmatrix},\\quad\n\\dot{\\mathbf{F}}(t_{0})=\\begin{pmatrix}\n0.06 & 0 & 0 \\\\\n0 & -0.024 & 0 \\\\\n0 & 0 & -\\frac{1}{48}\n\\end{pmatrix},\\quad\n\\mathbf{S}(t_{0})=\\begin{pmatrix}\n150 & 40 & -10 \\\\\n40 & 110 & 20 \\\\\n-10 & 20 & 90\n\\end{pmatrix}\\ \\text{MPa}.\n$$\nIt is known that by construction, the deformation at $t_{0}$ is isochoric, so $\\det(\\mathbf{F}(t_{0}))=1$.\n\nStarting from the fundamental power-conjugacy definitions between stress measures and kinematic rates in continuum mechanics, and without invoking any pre-stated target formulas, derive the relations needed to compute the First Piola–Kirchhoff (PK1) stress $\\mathbf{P}(t_{0})$ and the Cauchy stress $\\boldsymbol{\\sigma}(t_{0})$ from $\\mathbf{F}(t_{0})$ and $\\mathbf{S}(t_{0})$. Then, compute $\\mathbf{P}(t_{0})$ and $\\boldsymbol{\\sigma}(t_{0})$ explicitly for the given data, and verify the energy consistency through the instantaneous equality $\\mathbf{P}:\\dot{\\mathbf{F}}=\\boldsymbol{\\sigma}:\\mathbf{d}$, where the rate-of-deformation tensor is defined by $\\mathbf{d}=\\operatorname{sym}(\\dot{\\mathbf{F}}\\mathbf{F}^{-1})$.\n\nFinally, report the scalar value of the internal mechanical power per unit current volume at $t_{0}$, namely $\\boldsymbol{\\sigma}(t_{0}):\\mathbf{d}(t_{0})$, expressed in $\\text{W}/\\text{m}^{3}$. Round your final result to six significant figures.",
            "solution": "The problem is well-posed and scientifically sound, set within the standard framework of continuum mechanics. All necessary data are provided, and the stated conditions are consistent. We can therefore proceed with the solution.\n\nThe solution requires a three-part process:\n1.  Derive the fundamental relationships between the Cauchy ($\\boldsymbol{\\sigma}$), First Piola-Kirchhoff ($\\mathbf{P}$), and Second Piola-Kirchhoff ($\\mathbf{S}$) stress tensors starting from the principle of power-conjugacy.\n2.  Apply these relationships to the given data to compute $\\mathbf{P}(t_{0})$ and $\\boldsymbol{\\sigma}(t_{0})$.\n3.  Verify the energy consistency by calculating the internal power using two different but equivalent formulations and then compute the final required value.\n\n### Part 1: Derivation of Stress Tensor Relationships\n\nThe internal mechanical power per unit of current (spatial) volume, $p$, is given by the double contraction of the Cauchy stress tensor, $\\boldsymbol{\\sigma}$, and the spatial velocity gradient, $\\mathbf{l} = \\nabla_{\\mathbf{x}} \\mathbf{v}$.\n$$p = \\boldsymbol{\\sigma} : \\mathbf{l}$$\nThe balance of angular momentum implies that $\\boldsymbol{\\sigma}$ is symmetric. The velocity gradient can be decomposed into a symmetric part, the rate-of-deformation tensor $\\mathbf{d} = \\frac{1}{2}(\\mathbf{l} + \\mathbf{l}^T)$, and a skew-symmetric part, the spin tensor $\\mathbf{w} = \\frac{1}{2}(\\mathbf{l} - \\mathbf{l}^T)$. The power expression becomes:\n$$p = \\boldsymbol{\\sigma} : (\\mathbf{d} + \\mathbf{w}) = \\boldsymbol{\\sigma} : \\mathbf{d} + \\boldsymbol{\\sigma} : \\mathbf{w}$$\nSince the double contraction of a symmetric tensor ($\\boldsymbol{\\sigma}$) and a skew-symmetric tensor ($\\mathbf{w}$) is zero, we have $\\boldsymbol{\\sigma} : \\mathbf{w} = 0$. Thus, the spatial power density is:\n$$p = \\boldsymbol{\\sigma} : \\mathbf{d}$$\nTo relate stress measures defined in the reference configuration, we consider the power per unit of reference (material) volume, $P_0$. This is related to $p$ by $P_0 = p J$, where $J = \\det(\\mathbf{F})$ is the determinant of the deformation gradient $\\mathbf{F}$.\nThe spatial velocity gradient is related to the material time derivative of $\\mathbf{F}$, denoted $\\dot{\\mathbf{F}}$, by $\\mathbf{l} = \\dot{\\mathbf{F}}\\mathbf{F}^{-1}$.\nSubstituting this into the expression for $P_0$:\n$$P_0 = J (\\boldsymbol{\\sigma} : (\\dot{\\mathbf{F}}\\mathbf{F}^{-1}))$$\nUsing the tensor identity $\\mathbf{A}:(\\mathbf{B}\\mathbf{C}) = (\\mathbf{A}\\mathbf{C}^T):\\mathbf{B}$, we can rewrite the power as:\n$$P_0 = J \\left( (\\boldsymbol{\\sigma}(\\mathbf{F}^{-1})^T) : \\dot{\\mathbf{F}} \\right)$$\nThe First Piola-Kirchhoff (PK1) stress tensor, $\\mathbf{P}$, is defined as the stress measure that is power-conjugate to $\\dot{\\mathbf{F}}$, such that $P_0 = \\mathbf{P}:\\dot{\\mathbf{F}}$. By comparing the two expressions for $P_0$, we identify the relationship between $\\mathbf{P}$ and $\\boldsymbol{\\sigma}$:\n$$\\mathbf{P} = J \\boldsymbol{\\sigma} (\\mathbf{F}^{-1})^T$$\nFrom this, we can express $\\boldsymbol{\\sigma}$ in terms of $\\mathbf{P}$:\n$$\\boldsymbol{\\sigma} = \\frac{1}{J} \\mathbf{P} \\mathbf{F}^T$$\nThe Second Piola-Kirchhoff (PK2) stress tensor, $\\mathbf{S}$, is symmetric and defined as the work conjugate to the rate of the Green-Lagrange strain tensor $\\dot{\\mathbf{E}}$, where $\\mathbf{E} = \\frac{1}{2}(\\mathbf{F}^T\\mathbf{F} - \\mathbf{I})$. The rate is $\\dot{\\mathbf{E}} = \\frac{1}{2}(\\dot{\\mathbf{F}}^T\\mathbf{F} + \\mathbf{F}^T\\dot{\\mathbf{F}})$. The power per unit reference volume is thus also $P_0 = \\mathbf{S}:\\dot{\\mathbf{E}}$.\n$$P_0 = \\mathbf{S}:\\dot{\\mathbf{E}} = \\mathbf{S} : \\left( \\frac{1}{2}(\\dot{\\mathbf{F}}^T\\mathbf{F} + \\mathbf{F}^T\\dot{\\mathbf{F}}) \\right) = \\frac{1}{2} \\left( \\mathbf{S}:(\\dot{\\mathbf{F}}^T\\mathbf{F}) + \\mathbf{S}:(\\mathbf{F}^T\\dot{\\mathbf{F}}) \\right)$$\nUsing trace properties and the symmetry of $\\mathbf{S}$, it can be shown that both terms inside the parentheses are equal to $(\\mathbf{F}\\mathbf{S}):\\dot{\\mathbf{F}}$. For instance: $\\mathbf{S}:(\\mathbf{F}^T\\dot{\\mathbf{F}}) = \\mathrm{tr}(\\mathbf{S}^T \\mathbf{F}^T \\dot{\\mathbf{F}}) = \\mathrm{tr}((\\mathbf{F S})^T \\dot{\\mathbf{F}}) = (\\mathbf{F}\\mathbf{S}):\\dot{\\mathbf{F}}$.\nThis leads to:\n$$P_0 = \\frac{1}{2}\\left( (\\mathbf{F}\\mathbf{S}):\\dot{\\mathbf{F}} + (\\mathbf{F}\\mathbf{S}):\\dot{\\mathbf{F}} \\right) = (\\mathbf{F}\\mathbf{S}):\\dot{\\mathbf{F}}$$\nComparing this with $P_0 = \\mathbf{P}:\\dot{\\mathbf{F}}$, we find the relationship between $\\mathbf{P}$ and $\\mathbf{S}$:\n$$\\mathbf{P} = \\mathbf{F}\\mathbf{S}$$\nCombining the relations yields the transformation from $\\mathbf{S}$ to $\\boldsymbol{\\sigma}$:\n$$\\boldsymbol{\\sigma} = \\frac{1}{J} (\\mathbf{F}\\mathbf{S})\\mathbf{F}^T = \\frac{1}{J} \\mathbf{F}\\mathbf{S}\\mathbf{F}^T$$\nThe problem states that the deformation is isochoric, so $J = \\det(\\mathbf{F}(t_0)) = 1$. The relations at time $t_0$ simplify to:\n$$\\mathbf{P}(t_0) = \\mathbf{F}(t_0)\\mathbf{S}(t_0)$$\n$$\\boldsymbol{\\sigma}(t_0) = \\mathbf{F}(t_0)\\mathbf{S}(t_0)\\mathbf{F}(t_0)^T$$\n\n### Part 2: Computation of Stress Tensors\n\nGiven data:\n$$\n\\mathbf{F}(t_{0})=\\begin{pmatrix} 1.2 & 0 & 0 \\\\ 0 & 0.8 & 0 \\\\ 0 & 0 & \\frac{25}{24} \\end{pmatrix},\\quad\n\\mathbf{S}(t_{0})=\\begin{pmatrix} 150 & 40 & -10 \\\\ 40 & 110 & 20 \\\\ -10 & 20 & 90 \\end{pmatrix}\\ \\text{MPa}\n$$\nFirst, we compute the PK1 stress $\\mathbf{P}(t_0)$:\n$$\n\\mathbf{P}(t_{0}) = \\begin{pmatrix} 1.2 & 0 & 0 \\\\ 0 & 0.8 & 0 \\\\ 0 & 0 & \\frac{25}{24} \\end{pmatrix} \\begin{pmatrix} 150 & 40 & -10 \\\\ 40 & 110 & 20 \\\\ -10 & 20 & 90 \\end{pmatrix}\n$$\n$$\n\\mathbf{P}(t_{0}) = \\begin{pmatrix} 1.2 \\times 150 & 1.2 \\times 40 & 1.2 \\times (-10) \\\\ 0.8 \\times 40 & 0.8 \\times 110 & 0.8 \\times 20 \\\\ \\frac{25}{24} \\times (-10) & \\frac{25}{24} \\times 20 & \\frac{25}{24} \\times 90 \\end{pmatrix} = \\begin{pmatrix} 180 & 48 & -12 \\\\ 32 & 88 & 16 \\\\ -\\frac{125}{12} & \\frac{125}{6} & \\frac{375}{4} \\end{pmatrix}\\ \\text{MPa}\n$$\nNext, we compute the Cauchy stress $\\boldsymbol{\\sigma}(t_0)$. Since $\\mathbf{F}(t_0)$ is diagonal, $\\mathbf{F}(t_0)^T = \\mathbf{F}(t_0)$.\n$$\n\\boldsymbol{\\sigma}(t_0) = \\mathbf{P}(t_0)\\mathbf{F}(t_0)^T = \\begin{pmatrix} 180 & 48 & -12 \\\\ 32 & 88 & 16 \\\\ -\\frac{125}{12} & \\frac{125}{6} & \\frac{375}{4} \\end{pmatrix} \\begin{pmatrix} 1.2 & 0 & 0 \\\\ 0 & 0.8 & 0 \\\\ 0 & 0 & \\frac{25}{24} \\end{pmatrix}\n$$\n$$\n\\boldsymbol{\\sigma}(t_0) = \\begin{pmatrix} 180 \\times 1.2 & 48 \\times 0.8 & -12 \\times \\frac{25}{24} \\\\ 32 \\times 1.2 & 88 \\times 0.8 & 16 \\times \\frac{25}{24} \\\\ -\\frac{125}{12} \\times 1.2 & \\frac{125}{6} \\times 0.8 & \\frac{375}{4} \\times \\frac{25}{24} \\end{pmatrix} = \\begin{pmatrix} 216 & 38.4 & -12.5 \\\\ 38.4 & 70.4 & \\frac{50}{3} \\\\ -12.5 & \\frac{50}{3} & \\frac{3125}{32} \\end{pmatrix}\\ \\text{MPa}\n$$\nAs expected, $\\boldsymbol{\\sigma}(t_0)$ is symmetric.\n\n### Part 3: Energy Consistency and Final Calculation\n\nWe need to verify the equality $\\mathbf{P}:\\dot{\\mathbf{F}} = \\boldsymbol{\\sigma}:\\mathbf{d}$. First, we compute the rate-of-deformation tensor $\\mathbf{d} = \\operatorname{sym}(\\dot{\\mathbf{F}}\\mathbf{F}^{-1})$.\n$$\n\\dot{\\mathbf{F}}(t_{0})=\\begin{pmatrix} 0.06 & 0 & 0 \\\\ 0 & -0.024 & 0 \\\\ 0 & 0 & -\\frac{1}{48} \\end{pmatrix},\\quad\n\\mathbf{F}(t_0)^{-1} = \\begin{pmatrix} \\frac{1}{1.2} & 0 & 0 \\\\ 0 & \\frac{1}{0.8} & 0 \\\\ 0 & 0 & \\frac{24}{25} \\end{pmatrix} = \\begin{pmatrix} \\frac{5}{6} & 0 & 0 \\\\ 0 & \\frac{5}{4} & 0 \\\\ 0 & 0 & \\frac{24}{25} \\end{pmatrix}\n$$\nThe spatial velocity gradient $\\mathbf{l} = \\dot{\\mathbf{F}}\\mathbf{F}^{-1}$ is:\n$$\n\\mathbf{l}(t_0) = \\begin{pmatrix} 0.06 \\times \\frac{5}{6} & 0 & 0 \\\\ 0 & -0.024 \\times \\frac{5}{4} & 0 \\\\ 0 & 0 & -\\frac{1}{48} \\times \\frac{24}{25} \\end{pmatrix} = \\begin{pmatrix} 0.05 & 0 & 0 \\\\ 0 & -0.03 & 0 \\\\ 0 & 0 & -0.02 \\end{pmatrix}\n$$\nSince $\\mathbf{l}(t_0)$ is symmetric, $\\mathbf{d}(t_0) = \\mathbf{l}(t_0)$. Note that $\\operatorname{tr}(\\mathbf{d}) = 0.05 - 0.03 - 0.02 = 0$, consistent with the isochoric deformation rate.\n\nNow we compute the power densities. The power per unit reference volume is:\n$$\nP_0 = \\mathbf{P}(t_0):\\dot{\\mathbf{F}}(t_0) = \\sum_{ij} P_{ij} \\dot{F}_{ij} = P_{11}\\dot{F}_{11} + P_{22}\\dot{F}_{22} + P_{33}\\dot{F}_{33}\n$$\n$$\nP_0 = (180)(0.06) + (88)(-0.024) + (\\frac{375}{4})(-\\frac{1}{48}) = 10.8 - 2.112 - \\frac{375}{192} = 8.688 - 1.953125 = 6.734875\\ \\text{MPa/s}\n$$\nThe power per unit current volume is:\n$$\np = \\boldsymbol{\\sigma}(t_0):\\mathbf{d}(t_0) = \\sum_{ij} \\sigma_{ij} d_{ij} = \\sigma_{11}d_{11} + \\sigma_{22}d_{22} + \\sigma_{33}d_{33}\n$$\n$$\np = (216)(0.05) + (70.4)(-0.03) + (\\frac{3125}{32})(-0.02) = 10.8 - 2.112 - \\frac{3125}{1600} = 8.688 - \\frac{125}{64} = 8.688 - 1.953125 = 6.734875\\ \\text{MPa/s}\n$$\nThe values are identical, verifying the energy consistency relation $P_0 = p J$ (with $J=1$).\n\nThe final task is to report the internal mechanical power per unit current volume, $p$, in units of $\\text{W}/\\text{m}^3$.\n$$\np = 6.734875\\ \\text{MPa/s} = 6.734875 \\times 10^6\\ \\text{Pa/s} = 6.734875 \\times 10^6\\ (\\text{J}/\\text{m}^3)/\\text{s} = 6.734875 \\times 10^6\\ \\text{W}/\\text{m}^3\n$$\nRounding to six significant figures, the value is $6.73488 \\times 10^6\\ \\text{W}/\\text{m}^3$.",
            "answer": "$$\\boxed{6.73488 \\times 10^6}$$"
        },
        {
            "introduction": "Having established the kinematic foundations, we now turn to constructing a specific material model from a thermodynamic potential. This practice delves into hyperelasticity, focusing on an anisotropic material like a fiber-reinforced composite. You will learn to derive the stress and material stiffness directly from a given strain-energy function, gaining hands-on experience with the use of kinematic invariants to capture material symmetries.",
            "id": "3745587",
            "problem": "Consider a fiber-reinforced composite modeled as a compressible transversely isotropic hyperelastic material in the reference configuration. Let the fiber direction be the unit vector $\\,\\boldsymbol{a}_{0} = \\boldsymbol{e}_{1}\\,$ and the deformation be a homogeneous transverse tension along the $\\,\\boldsymbol{e}_{2}\\,$-direction given by the deformation gradient $\\,\\boldsymbol{F} = \\mathrm{diag}(1,\\lambda,1)\\,$ with $\\,\\lambda > 0\\,$. Define the right Cauchy-Green deformation tensor as $\\,\\boldsymbol{C} = \\boldsymbol{F}^{\\top}\\boldsymbol{F}\\,$, its first invariant as $\\,I_{1} = \\mathrm{tr}(\\boldsymbol{C})\\,$, the Jacobian determinant as $\\,J = \\det(\\boldsymbol{F})\\,$, and the fiber invariant as $\\,I_{4} = \\boldsymbol{a}_{0} \\cdot \\boldsymbol{C}\\,\\boldsymbol{a}_{0}\\,$. The strain-energy density is specified as\n$$\nW(\\boldsymbol{C}) = \\frac{\\mu}{2}\\,(I_{1} - 3)\\;-\\;\\mu\\,\\ln J\\;+\\;\\frac{\\kappa}{2}\\,(\\ln J)^{2}\\;+\\;\\frac{k}{2}\\,(I_{4} - 1)^{2},\n$$\nwhere $\\,\\mu > 0\\,$ is a shear modulus, $\\,\\kappa > 0\\,$ is a bulk modulus, and $\\,k > 0\\,$ is a fiber stiffness parameter. Using the hyperelastic framework, the Second Piola-Kirchhoff (SPK) stress $\\,\\boldsymbol{S}\\,$ is defined by the energetic conjugacy $\\,\\boldsymbol{S} = 2\\,\\partial W/\\partial \\boldsymbol{C}\\,$ and the Lagrangian elasticity tensor (material stiffness) $\\,\\mathbb{C}_{0}\\,$ is defined by $\\,\\mathbb{C}_{0} = 4\\,\\partial^{2} W/\\partial \\boldsymbol{C}\\,\\partial \\boldsymbol{C}\\,$. Starting from these definitions and appropriate tensor calculus identities, derive the SPK stress components under the given transverse tension, and determine the anisotropic (fiber) contribution to the Lagrangian elasticity components. Specifically, compute the quantities $\\,S_{11}\\,$, $\\,S_{22}\\,$, $\\,S_{33}\\,$ and the fiber-contributed stiffness components $\\,\\mathbb{C}_{0,1111}^{\\mathrm{fib}}\\,$, $\\,\\mathbb{C}_{0,2222}^{\\mathrm{fib}}\\,$, and $\\,\\mathbb{C}_{0,1122}^{\\mathrm{fib}}\\,$, expressed in terms of $\\,\\mu\\,$, $\\,\\kappa\\,$, $\\,k\\,$, and $\\,\\lambda\\,$. Assume $\\,\\boldsymbol{a}_{0} = \\boldsymbol{e}_{1}\\,$ exactly, and express stress and stiffness in Pascals. The final answer must be provided as a single row matrix listing $\\,(S_{11}, S_{22}, S_{33}, \\mathbb{C}_{0,1111}^{\\mathrm{fib}}, \\mathbb{C}_{0,2222}^{\\mathrm{fib}}, \\mathbb{C}_{0,1122}^{\\mathrm{fib}})\\,$. No rounding is required.",
            "solution": "The problem requires the derivation of specific components of the Second Piola-Kirchhoff (SPK) stress tensor $\\boldsymbol{S}$ and the fiber contribution to the Lagrangian elasticity tensor $\\mathbb{C}_{0}^{\\mathrm{fib}}$ for a compressible transversely isotropic hyperelastic material under a specified deformation.\n\nFirst, we establish the kinematic quantities based on the given homogeneous deformation. The deformation gradient $\\boldsymbol{F}$ is given as:\n$$\n\\boldsymbol{F} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\lambda & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\nThe Jacobian determinant $J$ is the determinant of $\\boldsymbol{F}$:\n$$\nJ = \\det(\\boldsymbol{F}) = (1)(\\lambda)(1) = \\lambda\n$$\nThe right Cauchy-Green deformation tensor $\\boldsymbol{C}$ is defined as $\\boldsymbol{C} = \\boldsymbol{F}^{\\top}\\boldsymbol{F}$:\n$$\n\\boldsymbol{C} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\lambda & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}^{\\top} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\lambda & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\lambda^2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\nThe inverse of $\\boldsymbol{C}$ is:\n$$\n\\boldsymbol{C}^{-1} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\lambda^{-2} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\nThe first invariant of $\\boldsymbol{C}$ is its trace, $I_1 = \\mathrm{tr}(\\boldsymbol{C})$:\n$$\nI_1 = 1 + \\lambda^2 + 1 = 2 + \\lambda^2\n$$\nThe fiber direction is given by the unit vector $\\boldsymbol{a}_0 = \\boldsymbol{e}_1$. The fiber invariant $I_4$ is defined as $I_4 = \\boldsymbol{a}_0 \\cdot \\boldsymbol{C}\\boldsymbol{a}_0$:\n$$\nI_4 = \\begin{pmatrix} 1 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\lambda^2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = C_{11} = 1\n$$\nNext, we derive the expression for the SPK stress tensor $\\boldsymbol{S}$ from the given strain-energy density function $W$. The constitutive relation is $\\boldsymbol{S} = 2 \\frac{\\partial W}{\\partial \\boldsymbol{C}}$.\nThe strain-energy density is:\n$$\nW(\\boldsymbol{C}) = \\frac{\\mu}{2}(I_{1} - 3) - \\mu\\ln J + \\frac{\\kappa}{2}(\\ln J)^{2} + \\frac{k}{2}(I_{4} - 1)^{2}\n$$\nTo compute the derivative, we need the derivatives of the invariants with respect to $\\boldsymbol{C}$:\n$$\n\\frac{\\partial I_1}{\\partial \\boldsymbol{C}} = \\boldsymbol{I} \\quad (\\text{Identity tensor})\n$$\n$$\n\\frac{\\partial (\\ln J)}{\\partial \\boldsymbol{C}} = \\frac{\\partial}{\\partial \\boldsymbol{C}} \\left( \\frac{1}{2} \\ln(\\det(\\boldsymbol{C})) \\right) = \\frac{1}{2\\det(\\boldsymbol{C})} \\frac{\\partial(\\det(\\boldsymbol{C}))}{\\partial \\boldsymbol{C}} = \\frac{1}{2J^2} (J^2 \\boldsymbol{C}^{-1}) = \\frac{1}{2}\\boldsymbol{C}^{-1}\n$$\n$$\n\\frac{\\partial I_4}{\\partial \\boldsymbol{C}} = \\frac{\\partial}{\\partial \\boldsymbol{C}} (\\boldsymbol{a}_0 \\cdot \\boldsymbol{C}\\boldsymbol{a}_0) = \\boldsymbol{a}_0 \\otimes \\boldsymbol{a}_0\n$$\nApplying the chain rule to $W$:\n$$\n\\frac{\\partial W}{\\partial \\boldsymbol{C}} = \\frac{\\partial W}{\\partial I_1}\\frac{\\partial I_1}{\\partial \\boldsymbol{C}} + \\frac{\\partial W}{\\partial (\\ln J)}\\frac{\\partial (\\ln J)}{\\partial \\boldsymbol{C}} + \\frac{\\partial W}{\\partial I_4}\\frac{\\partial I_4}{\\partial \\boldsymbol{C}}\n$$\nThe partial derivatives of $W$ with respect to its arguments are:\n$$\n\\frac{\\partial W}{\\partial I_1} = \\frac{\\mu}{2}\n$$\n$$\n\\frac{\\partial W}{\\partial (\\ln J)} = -\\mu + \\kappa \\ln J\n$$\n$$\n\\frac{\\partial W}{\\partial I_4} = k(I_4 - 1)\n$$\nSubstituting these into the expression for $\\partial W/\\partial \\boldsymbol{C}$:\n$$\n\\frac{\\partial W}{\\partial \\boldsymbol{C}} = \\frac{\\mu}{2}\\boldsymbol{I} + (-\\mu + \\kappa \\ln J)\\left(\\frac{1}{2}\\boldsymbol{C}^{-1}\\right) + k(I_4 - 1)(\\boldsymbol{a}_0 \\otimes \\boldsymbol{a}_0)\n$$\nThe SPK stress is $\\boldsymbol{S} = 2 \\frac{\\partial W}{\\partial \\boldsymbol{C}}$:\n$$\n\\boldsymbol{S} = \\mu\\boldsymbol{I} + (-\\mu + \\kappa \\ln J)\\boldsymbol{C}^{-1} + 2k(I_4 - 1)(\\boldsymbol{a}_0 \\otimes \\boldsymbol{a}_0)\n$$\nNow, we substitute the kinematic quantities for the given deformation: $J=\\lambda$, $I_4=1$, and $\\boldsymbol{C}^{-1} = \\mathrm{diag}(1, \\lambda^{-2}, 1)$. Also $\\boldsymbol{a}_0 \\otimes \\boldsymbol{a}_0 = \\boldsymbol{e}_1 \\otimes \\boldsymbol{e}_1$.\n$$\n\\boldsymbol{S} = \\mu \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} + (-\\mu + \\kappa \\ln\\lambda) \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\lambda^{-2} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} + 2k(1-1) (\\boldsymbol{e}_1 \\otimes \\boldsymbol{e}_1)\n$$\nThe fiber contribution term vanishes since $I_4=1$.\n$$\n\\boldsymbol{S} = \\begin{pmatrix} \\mu - \\mu + \\kappa\\ln\\lambda & 0 & 0 \\\\ 0 & \\mu + \\lambda^{-2}(-\\mu + \\kappa\\ln\\lambda) & 0 \\\\ 0 & 0 & \\mu - \\mu + \\kappa\\ln\\lambda \\end{pmatrix}\n$$\nThe diagonal components of the SPK stress tensor simplify to:\n$S_{11} = \\kappa\\ln\\lambda$\n$S_{22} = \\mu(1 - \\lambda^{-2}) + \\kappa\\lambda^{-2}\\ln\\lambda$\n$S_{33} = \\kappa\\ln\\lambda$\n\nNext, we compute the anisotropic (fiber) contribution to the Lagrangian elasticity tensor $\\mathbb{C}_{0}$. This contribution, $\\mathbb{C}_{0}^{\\mathrm{fib}}$, arises from the fiber-dependent part of the strain energy, $W^{\\mathrm{fib}} = \\frac{k}{2}(I_4 - 1)^2$. The elasticity tensor is defined by $\\mathbb{C}_0 = 4 \\frac{\\partial^2 W}{\\partial \\boldsymbol{C} \\partial \\boldsymbol{C}}$. Thus, the fiber contribution is:\n$$\n\\mathbb{C}_{0}^{\\mathrm{fib}} = 4 \\frac{\\partial^2 W^{\\mathrm{fib}}}{\\partial \\boldsymbol{C} \\partial \\boldsymbol{C}} = 4 \\frac{\\partial}{\\partial \\boldsymbol{C}} \\left( \\frac{\\partial W^{\\mathrm{fib}}}{\\partial \\boldsymbol{C}} \\right)\n$$\nFirst, we find the first derivative:\n$$\n\\frac{\\partial W^{\\mathrm{fib}}}{\\partial \\boldsymbol{C}} = \\frac{\\partial W^{\\mathrm{fib}}}{\\partial I_4} \\frac{\\partial I_4}{\\partial \\boldsymbol{C}} = k(I_4 - 1) (\\boldsymbol{a}_0 \\otimes \\boldsymbol{a}_0)\n$$\nNow, we compute the second derivative, applying the product rule for differentiation with respect to $\\boldsymbol{C}$:\n$$\n\\frac{\\partial^2 W^{\\mathrm{fib}}}{\\partial \\boldsymbol{C} \\partial \\boldsymbol{C}} = \\frac{\\partial}{\\partial \\boldsymbol{C}} \\left[ k(I_4 - 1) \\right] \\otimes (\\boldsymbol{a}_0 \\otimes \\boldsymbol{a}_0) + k(I_4-1) \\frac{\\partial (\\boldsymbol{a}_0 \\otimes \\boldsymbol{a}_0)}{\\partial \\boldsymbol{C}}\n$$\nSince $\\boldsymbol{a}_0$ is a constant vector, the tensor $\\boldsymbol{a}_0 \\otimes \\boldsymbol{a}_0$ is constant with respect to $\\boldsymbol{C}$, so its derivative is zero. The expression simplifies to:\n$$\n\\frac{\\partial^2 W^{\\mathrm{fib}}}{\\partial \\boldsymbol{C} \\partial \\boldsymbol{C}} = \\left( k \\frac{\\partial I_4}{\\partial \\boldsymbol{C}} \\right) \\otimes (\\boldsymbol{a}_0 \\otimes \\boldsymbol{a}_0) = k (\\boldsymbol{a}_0 \\otimes \\boldsymbol{a}_0) \\otimes (\\boldsymbol{a}_0 \\otimes \\boldsymbol{a}_0)\n$$\nTherefore, the fiber contribution to the elasticity tensor is:\n$$\n\\mathbb{C}_{0}^{\\mathrm{fib}} = 4k (\\boldsymbol{a}_0 \\otimes \\boldsymbol{a}_0) \\otimes (\\boldsymbol{a}_0 \\otimes \\boldsymbol{a}_0)\n$$\nIn component form, this fourth-order tensor is $(\\mathbb{C}_{0}^{\\mathrm{fib}})_{ijkl} = 4k (a_{0i}a_{0j})(a_{0k}a_{0l})$.\nGiven $\\boldsymbol{a}_0 = \\boldsymbol{e}_1$, we have $a_{0i} = \\delta_{i1}$ (Kronecker delta). We can now find the specific components required:\n$$\n\\mathbb{C}_{0,1111}^{\\mathrm{fib}} = 4k (\\delta_{11}\\delta_{11})(\\delta_{11}\\delta_{11}) = 4k (1 \\cdot 1)(1 \\cdot 1) = 4k\n$$\n$$\n\\mathbb{C}_{0,2222}^{\\mathrm{fib}} = 4k (\\delta_{21}\\delta_{21})(\\delta_{21}\\delta_{21}) = 4k (0 \\cdot 0)(0 \\cdot 0) = 0\n$$\n$$\n\\mathbb{C}_{0,1122}^{\\mathrm{fib}} = 4k (\\delta_{11}\\delta_{11})(\\delta_{21}\\delta_{21}) = 4k (1 \\cdot 1)(0 \\cdot 0) = 0\n$$\nThe required quantities are $(S_{11}, S_{22}, S_{33}, \\mathbb{C}_{0,1111}^{\\mathrm{fib}}, \\mathbb{C}_{0,2222}^{\\mathrm{fib}}, \\mathbb{C}_{0,1122}^{\\mathrm{fib}})$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\kappa \\ln(\\lambda) & \\mu(1 - \\lambda^{-2}) + \\kappa \\lambda^{-2} \\ln(\\lambda) & \\kappa \\ln(\\lambda) & 4k & 0 & 0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While elasticity describes reversible behavior, many materials deform irreversibly, a phenomenon captured by plasticity. Modeling this requires tracking the evolution of internal state variables, which presents a significant numerical challenge. This exercise explores the crucial task of integrating the plastic flow rule at finite strains, contrasting a simple forward Euler scheme with the robust exponential map algorithm to highlight the importance of numerical accuracy and the preservation of physical constraints.",
            "id": "3745524",
            "problem": "Consider a finite-strain plasticity setting in which the plastic deformation gradient, denoted by $\\mathbf{F}_{\\mathrm{p}}(t)$, evolves according to the plastic velocity gradient $\\mathbf{L}_{\\mathrm{p}}(t)$ through the kinematic definition $\\mathbf{L}_{\\mathrm{p}}(t) = \\dot{\\mathbf{F}}_{\\mathrm{p}}(t)\\,\\mathbf{F}_{\\mathrm{p}}^{-1}(t)$. Assume a rate-independent flow rule of the form $\\mathbf{L}_{\\mathrm{p}}(t) = \\dot{\\lambda}(t)\\,\\mathbf{N}$, where $\\dot{\\lambda}(t)$ is a nonnegative scalar plastic multiplier rate and $\\mathbf{N}$ is a constant flow direction tensor (held fixed over a given time step), with $\\mathrm{tr}(\\mathbf{N}) = 0$ to represent plastic incompressibility. Starting from this fundamental base and standard properties of linear ordinary differential equations, derive a time-stepping update of $\\mathbf{F}_{\\mathrm{p}}$ from time $t_n$ to time $t_{n+1}$ over a time increment $\\Delta t = t_{n+1} - t_n$ in terms of the plastic increment $\\Delta \\lambda = \\int_{t_n}^{t_{n+1}} \\dot{\\lambda}(t)\\,\\mathrm{d}t$. Then, implement and compare two numerical updates over the same time step: an exponential-map update and a forward Euler update. Discuss numerical stability and plastic incompressibility of each method using quantifiable metrics.\n\nYour program must do the following, strictly in linear algebraic terms:\n- Use the exact exponential-map update derived from first principles for the case of constant $\\mathbf{N}$ over the step, and treat the plastic increment $\\Delta \\lambda$ as given. Denote the corresponding updated tensor by $\\mathbf{F}_{\\mathrm{p}}^{\\exp}$.\n- Use a single forward Euler update based on the same kinematics and flow rule, assuming $\\dot{\\lambda}$ is constant over the step so that $\\Delta \\lambda = \\dot{\\lambda}\\,\\Delta t$. Denote the corresponding updated tensor by $\\mathbf{F}_{\\mathrm{p}}^{\\mathrm{Eul}}$.\n- For each test case, compute the following four scalars:\n  $1.$ the Frobenius-norm discrepancy $e_{\\mathrm{F}} = \\lVert \\mathbf{F}_{\\mathrm{p}}^{\\mathrm{Eul}} - \\mathbf{F}_{\\mathrm{p}}^{\\exp} \\rVert_{\\mathrm{F}}$,\n  $2.$ the plastic volume error of the exponential-map update $v_{\\exp} = \\det(\\mathbf{F}_{\\mathrm{p}}^{\\exp}) - 1$,\n  $3.$ the plastic volume error of the Euler update $v_{\\mathrm{Eul}} = \\det(\\mathbf{F}_{\\mathrm{p}}^{\\mathrm{Eul}}) - 1$,\n  $4.$ the determinant of the Euler update $d_{\\mathrm{Eul}} = \\det(\\mathbf{F}_{\\mathrm{p}}^{\\mathrm{Eul}})$.\n- All quantities are nondimensional; no physical units are required. Any angle must be in radians.\n\nUse the following test suite of three cases to exercise general behavior, small-step behavior, and large-step behavior. All matrices are of size $3 \\times 3$:\n- Case A (general \"happy path\"): $\\mathbf{N}_1 = \\mathrm{diag}(1,-\\tfrac{1}{2},-\\tfrac{1}{2})$, $\\Delta \\lambda = 0.2$, and $\\mathbf{F}_{\\mathrm{p}}^n = \\mathbf{I}$.\n- Case B (small increment edge case): $\\mathbf{N}_1 = \\mathrm{diag}(1,-\\tfrac{1}{2},-\\tfrac{1}{2})$, $\\Delta \\lambda = 10^{-8}$, and $\\mathbf{F}_{\\mathrm{p}}^n = \\mathbf{I}$.\n- Case C (large increment with shear-like flow and initial rotation): $\\mathbf{N}_2 = \\begin{bmatrix} 0 & 1 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}$, $\\Delta \\lambda = 3.0$, and $\\mathbf{F}_{\\mathrm{p}}^n = \\mathbf{R}_z(\\theta)$ with $\\theta = 0.3$ radians and\n  $\\mathbf{R}_z(\\theta) = \\begin{bmatrix} \\cos \\theta & -\\sin \\theta & 0 \\\\ \\sin \\theta & \\cos \\theta & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}$.\n\nFor each test case, your program must compute $\\mathbf{F}_{\\mathrm{p}}^{\\exp}$ and $\\mathbf{F}_{\\mathrm{p}}^{\\mathrm{Eul}}$, then evaluate and collect the four scalars $[e_{\\mathrm{F}}, v_{\\exp}, v_{\\mathrm{Eul}}, d_{\\mathrm{Eul}}]$ in that order. Aggregate the results for the three cases into a single list of lists.\n\nFinal output format requirement:\n- Your program should produce a single line of output containing the results as a comma-separated list of the three per-case lists enclosed in a single pair of square brackets, for example\n  $[\\,[r_{11},r_{12},r_{13},r_{14}],[r_{21},r_{22},r_{23},r_{24}],[r_{31},r_{32},r_{33},r_{34}]\\,]$,\n  where each $r_{ij}$ is a floating-point number.",
            "solution": "The problem requires the derivation, implementation, and comparison of two time-stepping schemes for the evolution of the plastic deformation gradient, $\\mathbf{F}_{\\mathrm{p}}$, in a finite-strain plasticity context. The schemes are the exponential map and the forward Euler method.\n\n### Theoretical Derivation\n\nThe evolution of the plastic deformation gradient $\\mathbf{F}_{\\mathrm{p}}(t)$ is governed by the kinematic relation involving the plastic velocity gradient $\\mathbf{L}_{\\mathrm{p}}(t)$:\n$$\n\\dot{\\mathbf{F}}_{\\mathrm{p}}(t) = \\mathbf{L}_{\\mathrm{p}}(t)\\,\\mathbf{F}_{\\mathrm{p}}(t)\n$$\nThe problem specifies a rate-independent flow rule $\\mathbf{L}_{\\mathrm{p}}(t) = \\dot{\\lambda}(t)\\,\\mathbf{N}$, where $\\dot{\\lambda}(t) \\geq 0$ is the plastic multiplier rate and $\\mathbf{N}$ is a constant flow-direction tensor over the time increment $\\Delta t = t_{n+1} - t_n$. The condition $\\mathrm{tr}(\\mathbf{N})=0$ ensures that the plastic flow is volume-preserving (isochoric). Substituting the flow rule into the kinematic equation gives the governing ordinary differential equation (ODE):\n$$\n\\dot{\\mathbf{F}}_{\\mathrm{p}}(t) = \\dot{\\lambda}(t)\\,\\mathbf{N}\\,\\mathbf{F}_{\\mathrm{p}}(t)\n$$\n\n**1. Exponential-Map Update**\n\nSince $\\mathbf{N}$ is constant over the time step $[t_n, t_{n+1}]$, this linear ODE can be solved exactly. Integrating from $t_n$ to $t_{n+1}$ yields:\n$$\n\\mathbf{F}_{\\mathrm{p}}(t_{n+1}) = \\exp\\left( \\int_{t_n}^{t_{n+1}} \\dot{\\lambda}(\\tau)\\,\\mathbf{N}\\,\\mathrm{d}\\tau \\right) \\mathbf{F}_{\\mathrm{p}}(t_n)\n$$\nThe constancy of $\\mathbf{N}$ allows it to be factored out of the integral. Defining the plastic increment over the step as $\\Delta\\lambda = \\int_{t_n}^{t_{n+1}} \\dot{\\lambda}(\\tau)\\,\\mathrm{d}\\tau$, the update rule for $\\mathbf{F}_{\\mathrm{p}}$ from its value at time $t_n$, denoted $\\mathbf{F}_{\\mathrm{p}}^n$, becomes:\n$$\n\\mathbf{F}_{\\mathrm{p}}^{\\exp} = \\exp(\\Delta\\lambda\\,\\mathbf{N})\\,\\mathbf{F}_{\\mathrm{p}}^n\n$$\nThis is the exponential-map update. It is the exact solution to the ODE under the given assumptions. Computationally, this requires evaluating the matrix exponential, for which robust numerical algorithms exist.\n\n**2. Forward Euler Update**\n\nThe forward Euler method is a first-order explicit numerical integration scheme. It approximates the solution at $t_{n+1}$ by extrapolating from $t_n$ using the rate at $t_n$:\n$$\n\\frac{\\mathbf{F}_{\\mathrm{p}}(t_{n+1}) - \\mathbf{F}_{\\mathrm{p}}(t_n)}{\\Delta t} \\approx \\dot{\\mathbf{F}}_{\\mathrm{p}}(t_n) = \\mathbf{L}_{\\mathrm{p}}(t_n)\\,\\mathbf{F}_{\\mathrm{p}}(t_n)\n$$\nSolving for $\\mathbf{F}_{\\mathrm{p}}(t_{n+1})$:\n$$\n\\mathbf{F}_{\\mathrm{p}}(t_{n+1}) \\approx \\mathbf{F}_{\\mathrm{p}}^n + \\Delta t\\,\\mathbf{L}_{\\mathrm{p}}(t_n)\\,\\mathbf{F}_{\\mathrm{p}}^n = (\\mathbf{I} + \\Delta t\\,\\mathbf{L}_{\\mathrm{p}}(t_n))\\,\\mathbf{F}_{\\mathrm{p}}^n\n$$\nwhere $\\mathbf{I}$ is the $3 \\times 3$ identity matrix. For this scheme, we assume $\\dot{\\lambda}$ is constant over the step, so $\\dot{\\lambda}(t) = \\dot{\\lambda}_{\\mathrm{const}}$. This implies $\\mathbf{L}_{\\mathrm{p}}(t_n) = \\dot{\\lambda}_{\\mathrm{const}}\\,\\mathbf{N}$ and $\\Delta\\lambda = \\dot{\\lambda}_{\\mathrm{const}}\\,\\Delta t$. Substituting $\\Delta t\\,\\mathbf{L}_{\\mathrm{p}}(t_n) = \\Delta\\lambda\\,\\mathbf{N}$ into the update formula, we get the forward Euler approximation:\n$$\n\\mathbf{F}_{\\mathrm{p}}^{\\mathrm{Eul}} = (\\mathbf{I} + \\Delta\\lambda\\,\\mathbf{N})\\,\\mathbf{F}_{\\mathrm{p}}^n\n$$\nThis is equivalent to a first-order Taylor expansion of the exponential map: $\\exp(\\Delta\\lambda\\,\\mathbf{N}) \\approx \\mathbf{I} + \\Delta\\lambda\\,\\mathbf{N}$.\n\n### Analysis of Numerical Properties\n\n**1. Plastic Incompressibility**\n\nThe condition $\\det(\\mathbf{F}_{\\mathrm{p}}) = 1$ must be preserved. We start with $\\det(\\mathbf{F}_{\\mathrm{p}}^n) = 1$.\n- **Exponential Map**: The determinant of the updated tensor is $\\det(\\mathbf{F}_{\\mathrm{p}}^{\\exp}) = \\det(\\exp(\\Delta\\lambda\\,\\mathbf{N}))\\,\\det(\\mathbf{F}_{\\mathrm{p}}^n)$. Using Jacobi's formula, $\\det(\\exp(\\mathbf{A})) = \\exp(\\mathrm{tr}(\\mathbf{A}))$, we have $\\det(\\exp(\\Delta\\lambda\\,\\mathbf{N})) = \\exp(\\mathrm{tr}(\\Delta\\lambda\\,\\mathbf{N})) = \\exp(\\Delta\\lambda\\,\\mathrm{tr}(\\mathbf{N}))$. Since $\\mathrm{tr}(\\mathbf{N})=0$, this becomes $\\exp(0)=1$. Thus, $\\det(\\mathbf{F}_{\\mathrm{p}}^{\\exp}) = 1 \\cdot 1 = 1$. The exponential map exactly preserves plastic volume, so the volume error $v_{\\exp} = \\det(\\mathbf{F}_{\\mathrm{p}}^{\\exp}) - 1$ is zero (within numerical precision).\n- **Forward Euler**: The determinant is $\\det(\\mathbf{F}_{\\mathrm{p}}^{\\mathrm{Eul}}) = \\det(\\mathbf{I} + \\Delta\\lambda\\,\\mathbf{N})\\,\\det(\\mathbf{F}_{\\mathrm{p}}^n)$. In general, $\\det(\\mathbf{I} + \\Delta\\lambda\\,\\mathbf{N}) \\neq 1$. It can be shown that $\\det(\\mathbf{I} + \\Delta\\lambda\\,\\mathbf{N}) = 1 + O((\\Delta\\lambda)^2)$. Therefore, the forward Euler method does not preserve plastic volume, and the volume error $v_{\\mathrm{Eul}} = \\det(\\mathbf{F}_{\\mathrm{p}}^{\\mathrm{Eul}}) - 1$ is non-zero.\n\n**2. Numerical Stability and Accuracy**\n\n- **Exponential Map**: As the exact solution to the underlying ODE, this method is unconditionally stable in the context of integrating this equation. Its accuracy is limited only by the physical validity of assuming a constant $\\mathbf{N}$ over the step. For this problem, it serves as the ground truth.\n- **Forward Euler**: This is a first-order accurate method. The error, quantified by $e_{\\mathrm{F}} = \\lVert \\mathbf{F}_{\\mathrm{p}}^{\\mathrm{Eul}} - \\mathbf{F}_{\\mathrm{p}}^{\\exp} \\rVert_{\\mathrm{F}}$, is expected to be of order $O((\\Delta\\lambda)^2)$ for small $\\Delta\\lambda$. The method is only conditionally stable. Stability requires the eigenvalues of the amplification matrix $(\\mathbf{I} + \\Delta\\lambda\\,\\mathbf{N})$ to have a magnitude no greater than $1$. If $\\mathbf{N}$ has any eigenvalue $\\nu_i$ with a positive real part, the scheme becomes unstable for any $\\Delta\\lambda > 0$, as $|1 + \\Delta\\lambda\\,\\nu_i| > 1$. This instability is severe for large step sizes, and can lead to unphysical results, such as a negative determinant, as seen in Case C.\n\nThe program below will implement these two updates and compute the four specified metrics for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Derives, implements, and compares exponential-map and forward Euler updates\n    for the plastic deformation gradient in finite-strain plasticity.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    I = np.identity(3)\n    N1 = np.diag([1.0, -0.5, -0.5])\n\n    N2 = np.array([\n        [0.0, 1.0, 0.0],\n        [1.0, 0.0, 0.0],\n        [0.0, 0.0, 0.0]\n    ])\n\n    theta = 0.3\n    c, s = np.cos(theta), np.sin(theta)\n    Rz = np.array([\n        [c, -s, 0.0],\n        [s,  c, 0.0],\n        [0.0, 0.0, 1.0]\n    ])\n\n    test_cases = [\n        # Case A: N, delta_lambda, Fp_n\n        (N1, 0.2, I),\n        # Case B: N, delta_lambda, Fp_n\n        (N1, 1e-8, I),\n        # Case C: N, delta_lambda, Fp_n\n        (N2, 3.0, Rz)\n    ]\n\n    results = []\n    for case in test_cases:\n        N, delta_lambda, Fp_n = case\n\n        # 1. Exponential-map update\n        # Fp_exp = exp(delta_lambda * N) * Fp_n\n        # The expm function computes the matrix exponential.\n        exp_mat = expm(delta_lambda * N)\n        Fp_exp = exp_mat @ Fp_n\n\n        # 2. Forward Euler update\n        # Fp_eul = (I + delta_lambda * N) * Fp_n\n        Fp_eul = (I + delta_lambda * N) @ Fp_n\n\n        # 3. Compute the four required scalar metrics\n        \n        # Metric 1: Frobenius-norm discrepancy\n        # e_F = ||Fp_eul - Fp_exp||_F\n        e_F = np.linalg.norm(Fp_eul - Fp_exp, 'fro')\n\n        # Metric 2: Plastic volume error of the exponential-map update\n        # v_exp = det(Fp_exp) - 1\n        det_exp = np.linalg.det(Fp_exp)\n        v_exp = det_exp - 1.0\n\n        # Metric 3 & 4: Plastic volume error and determinant of the Euler update\n        # d_eul = det(Fp_eul)\n        # v_eul = d_eul - 1\n        d_eul = np.linalg.det(Fp_eul)\n        v_eul = d_eul - 1.0\n        \n        case_results = [e_F, v_exp, v_eul, d_eul]\n        results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The formatting requires a specific string representation of the list of lists.\n    # Example: [[r11,r12,r13,r14],[r21,r22,r23,r24],[r31,r32,r33,r34]]\n    # We build this string manually to ensure compliance.\n    list_of_strings = []\n    for R in results:\n        list_of_strings.append(f\"[{','.join(f'{v:.15f}' for v in R)}]\")\n    \n    final_output_string = f\"[{','.join(list_of_strings)}]\"\n    print(final_output_string)\n\n\nsolve()\n```"
        }
    ]
}