{
    "hands_on_practices": [
        {
            "introduction": "The first step in any finite element analysis is to define the discrete problem space. This exercise takes us back to first principles, focusing on how the number of unconstrained degrees of freedom—the ultimate size of our computational problem—is determined. By comparing two minimal meshes for a unit square, we will see how the choice of element type and the enforcement of boundary conditions interact to define the discrete solution space .",
            "id": "3744622",
            "problem": "Let the computational domain be the unit square $\\Omega = [0,1] \\times [0,1]$. Consider a scalar boundary value problem posed in the Sobolev space $H^{1}(\\Omega)$ with homogeneous Dirichlet boundary conditions $u=0$ on $\\partial \\Omega$. You will discretize $\\Omega$ using the Finite Element Method (FEM) with conforming Lagrange spaces on two meshes: a triangular mesh with piecewise linear shape functions (denoted $P_{1}$) and a quadrilateral mesh with piecewise bilinear shape functions (denoted $Q_{1}$).\n\nDefine the following two conforming meshes:\n\n- Triangular mesh $\\mathcal{T}_{h}^{\\triangle}$: the unit square is partitioned into two triangles by a single diagonal segment from $(0,0)$ to $(1,1)$.\n- Quadrilateral mesh $\\mathcal{T}_{h}^{\\square}$: the unit square is treated as a single quadrilateral element.\n\nFor each mesh, consider the conforming nodal Lagrange finite element space $V_{h} \\subset H^{1}(\\Omega)$ appropriate to the element type: continuous piecewise linear functions on $\\mathcal{T}_{h}^{\\triangle}$ for $P_{1}$, and continuous piecewise bilinear functions on $\\mathcal{T}_{h}^{\\square}$ for $Q_{1}$. Enforce the homogeneous Dirichlet boundary condition $u=0$ on $\\partial \\Omega$ by the standard approach of essential boundary condition imposition, i.e., by constraining nodal values on $\\partial \\Omega$.\n\nStarting from the core definitions of conforming finite element spaces and the enforcement of essential (Dirichlet) boundary conditions, determine the number of unconstrained algebraic degrees of freedom (the dimension of the discrete trial space after boundary conditions) for each discretization. Then compute the difference\n$$\n\\Delta \\;=\\; N_{\\text{free}}^{P_{1}} \\;-\\; N_{\\text{free}}^{Q_{1}} \\, ,\n$$\nwhere $N_{\\text{free}}^{P_{1}}$ and $N_{\\text{free}}^{Q_{1}}$ denote the counts of unconstrained degrees of freedom for the $P_{1}$ and $Q_{1}$ discretizations, respectively, on the meshes described above.\n\nProvide the numerical value of $\\Delta$. No rounding is required. Express your final answer as a pure number without units.",
            "solution": "The problem is valid as it is scientifically grounded, self-contained, and objective, representing a standard exercise in the Finite Element Method (FEM).\n\nThe core of this problem is to determine the dimension of the discrete trial space for a finite element problem after the imposition of homogeneous Dirichlet boundary conditions. In the context of conforming nodal Lagrange finite elements, the degrees of freedom (DoFs) are the values of the solution at a discrete set of points called nodes. The total number of DoFs is the total number of unique nodes in the mesh.\n\nThe problem specifies homogeneous Dirichlet boundary conditions, $u=0$, on the entire boundary $\\partial \\Omega$ of the domain $\\Omega = [0,1] \\times [0,1]$. When using the standard method of essential boundary condition imposition, any node that lies on the Dirichlet-prescribed portion of the boundary has its corresponding DoF constrained. In this case, since the condition applies to the entire boundary $\\partial \\Omega$, all nodes on $\\partial \\Omega$ are constrained. Their values are fixed to $0$.\n\nThe number of unconstrained or \"free\" algebraic degrees of freedom, $N_{\\text{free}}$, is therefore equal to the number of nodes that lie in the interior of the domain, $\\Omega^{\\circ} = (0,1) \\times (0,1)$. We will now determine this number for each of the two specified discretizations.\n\nFirst, we analyze the $P_{1}$ triangular mesh discretization.\nThe finite element space consists of continuous piecewise linear functions. For a $P_{1}$ triangular element, the nodes are located at the three vertices of the triangle. The mesh, denoted $\\mathcal{T}_{h}^{\\triangle}$, partitions the unit square into two triangles using the diagonal from the vertex $(0,0)$ to the vertex $(1,1)$. The two triangular elements are $T_{1}$ with vertices $\\{(0,0), (1,0), (1,1)\\}$ and $T_{2}$ with vertices $\\{(0,0), (0,1), (1,1)\\}$.\nThe set of all unique nodes for this mesh is the union of the vertex sets of these two triangles:\n$$\n\\mathcal{N}^{P_{1}} = \\{(0,0), (1,0), (1,1)\\} \\cup \\{(0,0), (0,1), (1,1)\\} = \\{(0,0), (1,0), (0,1), (1,1)\\}\n$$\nTo find $N_{\\text{free}}^{P_{1}}$, we must count how many of these nodes are in the interior of $\\Omega$, which is the open set $(0,1) \\times (0,1)$.\n- The node $(0,0)$ is on the boundary $\\partial\\Omega$.\n- The node $(1,0)$ is on the boundary $\\partial\\Omega$.\n- The node $(0,1)$ is on the boundary $\\partial\\Omega$.\n- The node $(1,1)$ is on the boundary $\\partial\\Omega$.\nAll four nodes lie on the boundary of the domain. There are no interior nodes. Therefore, the number of unconstrained degrees of freedom is $N_{\\text{free}}^{P_{1}} = 0$.\n\nSecond, we analyze the $Q_{1}$ quadrilateral mesh discretization.\nThe finite element space consists of continuous piecewise bilinear functions. For a $Q_{1}$ quadrilateral element, the nodes are located at the four vertices of the quadrilateral. The mesh, denoted $\\mathcal{T}_{h}^{\\square}$, consists of a single element, which is the unit square $\\Omega$ itself.\nThe set of nodes for this one-element mesh is simply the set of its vertices:\n$$\n\\mathcal{N}^{Q_{1}} = \\{(0,0), (1,0), (0,1), (1,1)\\}\n$$\nThis is the same set of nodes as in the $P_{1}$ case. As established previously, all four of these nodes lie on the boundary $\\partial\\Omega$. None of them are in the interior $(0,1) \\times (0,1)$.\nConsequently, there are no interior nodes for this discretization either. The number of unconstrained degrees of freedom is $N_{\\text{free}}^{Q_{1}} = 0$.\n\nFinally, we compute the requested difference, $\\Delta$.\n$$\n\\Delta = N_{\\text{free}}^{P_{1}} - N_{\\text{free}}^{Q_{1}}\n$$\nSubstituting the values we determined:\n$$\n\\Delta = 0 - 0 = 0\n$$\nFor both of these extremely coarse discretizations, the trial space of functions satisfying the homogeneous boundary conditions contains only the trivial zero function, meaning the dimension of the space of unconstrained degrees of freedom is zero in both cases.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "Moving from conceptual setup to computational mechanics, this practice delves into the heart of the finite element method: the assembly of the global stiffness and mass matrices. Using higher-order quadratic ($P_2$) elements, you will compute the elemental contributions by integrating basis functions defined in barycentric coordinates . This exercise is crucial for understanding how the continuous PDE is translated into a discrete algebraic system, forming the backbone of the solution process.",
            "id": "3744597",
            "problem": "Consider the homogeneous Poisson equation $-\\Delta u = 0$ posed on the unit square $\\Omega = [0,1] \\times [0,1]$ with homogeneous Dirichlet boundary condition $u = 0$ on $\\partial \\Omega$. Discretize $\\Omega$ by a conforming simplicial mesh comprised of two triangles obtained by splitting the square along the diagonal from $(0,0)$ to $(1,1)$; that is, triangles $T_1$ with vertices $(0,0)$, $(1,0)$, $(1,1)$ and $T_2$ with vertices $(0,0)$, $(0,1)$, $(1,1)$. Use the quadratic Lagrange (degree-two) finite element space on triangles, commonly denoted as $P_2$, whose nodal basis consists of one function per vertex and one function per edge midpoint. Let the interior edge be the diagonal connecting $(0,0)$ and $(1,1)$; the degree-two basis function associated with the midpoint of this interior edge on a triangle with barycentric coordinates $(\\lambda_1,\\lambda_2,\\lambda_3)$ is the canonical edge function $4 \\lambda_i \\lambda_j$ for the pair of vertices $(i,j)$ that define the edge.\n\nDefine the elemental mass and stiffness matrices for a general triangle $T$ with $P_2$ basis functions $\\{\\varphi_\\alpha\\}_{\\alpha=1}^{6}$ by the standard finite element method (FEM) integrals\n$$\nM^{(T)}_{\\alpha\\beta} = \\int_{T} \\varphi_\\alpha \\varphi_\\beta \\, \\mathrm{d}\\Omega, \\quad\nK^{(T)}_{\\alpha\\beta} = \\int_{T} \\nabla \\varphi_\\alpha \\cdot \\nabla \\varphi_\\beta \\, \\mathrm{d}\\Omega.\n$$\nUse triangle quadrature rules that are exact for polynomials of total degree up to $4$ for mass and up to $2$ for stiffness to evaluate these integrals. Assemble the global mass and stiffness matrices by summing the elemental contributions, and then impose the homogeneous Dirichlet boundary condition by eliminating all boundary degrees of freedom. For the given mesh, the only remaining global degree of freedom corresponds to the interior edge midpoint on the diagonal. Denote its globally assembled mass and stiffness scalars by $M_{\\mathrm{int}}$ and $K_{\\mathrm{int}}$, respectively.\n\nStarting from the definitions above and the properties of barycentric coordinates on affine triangles, compute:\n- the contributions of each triangle to the elemental mass and stiffness matrix entries associated with the interior edge midpoint basis function,\n- the assembled scalars $M_{\\mathrm{int}}$ and $K_{\\mathrm{int}}$ for the interior degree of freedom.\n\nThen verify that the assembled global mass and stiffness matrices (restricted to the interior degree of freedom space) are symmetric and positive definite. Finally, report the single scalar value of the ratio\n$$\nR = \\frac{K_{\\mathrm{int}}}{M_{\\mathrm{int}}}.\n$$\nExpress the final answer as an exact value; no rounding is required, and no units are associated with this ratio.",
            "solution": "The problem is first validated.\n\n### Step 1: Extract Givens\n-   **Equation**: Homogeneous Poisson equation, $-\\Delta u = 0$.\n-   **Domain**: Unit square, $\\Omega = [0,1] \\times [0,1]$.\n-   **Boundary Condition**: Homogeneous Dirichlet, $u = 0$ on $\\partial \\Omega$.\n-   **Mesh**: The domain $\\Omega$ is discretized into two triangles, $T_1$ and $T_2$, by splitting the square along the diagonal from $(0,0)$ to $(1,1)$.\n    -   $T_1$ has vertices $(0,0)$, $(1,0)$, $(1,1)$.\n    -   $T_2$ has vertices $(0,0)$, $(0,1)$, $(1,1)$.\n-   **Finite Element Space**: Quadratic Lagrange finite element space, $P_2$, on triangles. The nodal basis consists of functions associated with vertices and edge midpoints.\n-   **Basis Function:** The basis function for the midpoint of an edge defined by vertices $i$ and $j$ is given by $4\\lambda_i \\lambda_j$ in barycentric coordinates $(\\lambda_1, \\lambda_2, \\lambda_3)$.\n-   **Interior Degree of Freedom (DOF)**: The only non-boundary DOF is associated with the midpoint of the interior edge, which is the diagonal from $(0,0)$ to $(1,1)$.\n-   **Elemental Matrices**:\n    -   Mass: $M^{(T)}_{\\alpha\\beta} = \\int_{T} \\varphi_\\alpha \\varphi_\\beta \\, \\mathrm{d}\\Omega$.\n    -   Stiffness: $K^{(T)}_{\\alpha\\beta} = \\int_{T} \\nabla \\varphi_\\alpha \\cdot \\nabla \\varphi_\\beta \\, \\mathrm{d}\\Omega$.\n-   **Quadrature Rules**:\n    -   Mass matrix integrals are evaluated using a rule exact for polynomials of total degree up to $4$.\n    -   Stiffness matrix integrals are evaluated using a rule exact for polynomials of total degree up to $2$.\n-   **Assembly**: Global matrices are formed by summing elemental contributions. Boundary DOFs are eliminated. Let $M_{\\mathrm{int}}$ and $K_{\\mathrm{int}}$ be the resulting global scalars for the single interior DOF.\n-   **Objective**: Compute the ratio $R = \\frac{K_{\\mathrm{int}}}{M_{\\mathrm{int}}}$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is a standard application of the Finite Element Method (FEM) to a classic elliptic partial differential equation. All concepts (Poisson's equation, $P_2$ elements, barycentric coordinates, elemental matrices) are fundamental to computational mathematics and engineering.\n-   **Well-Posed**: The problem is specified with sufficient detail. The geometry, element type, basis functions, and assembly procedure are clearly defined, leading to a unique, computable result.\n-   **Objective**: The problem is stated in precise mathematical language, free from subjectivity.\n\nThe problem is self-contained, scientifically sound, and well-posed. No flaws are identified.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\n### Solution Derivation\n\nThe problem asks for the ratio of the assembled stiffness to the assembled mass for the single interior degree of freedom. This DOF corresponds to the midpoint of the diagonal edge connecting $(0,0)$ and $(1,1)$. The global assembled scalars, $M_{\\mathrm{int}}$ and $K_{\\mathrm{int}}$, are the sums of the contributions from the two triangles $T_1$ and $T_2$.\n\nLet the vertices of the square be $V_1=(0,0)$, $V_2=(1,0)$, $V_3=(1,1)$, and $V_4=(0,1)$.\nThe two triangles are $T_1$ with vertices $V_1, V_2, V_3$ and $T_2$ with vertices $V_1, V_4, V_3$.\nThe area of each triangle is $|T_1| = |T_2| = \\frac{1}{2}$. The interior edge is the common edge between $T_1$ and $T_2$, connecting $V_1$ and $V_3$. The basis function associated with the midpoint of this edge is the only one that survives after imposing homogeneous Dirichlet boundary conditions. Let's call this basis function $\\varphi_{\\mathrm{int}}$.\n\n**Analysis on Triangle $T_1$**\nLet the local vertices of $T_1$ be $v_1=(0,0)$, $v_2=(1,0)$, and $v_3=(1,1)$. The interior edge connects $v_1$ and $v_3$. Let the corresponding barycentric coordinates be $\\lambda_1, \\lambda_2, \\lambda_3$. The restriction of $\\varphi_{\\mathrm{int}}$ to $T_1$, denoted $\\varphi_{\\mathrm{int}}^{(1)}$, is the basis function associated with the midpoint of the edge $(v_1, v_3)$. According to the problem definition, this is:\n$$\n\\varphi_{\\mathrm{int}}^{(1)} = 4 \\lambda_1 \\lambda_3\n$$\nThe elemental mass matrix entry for this DOF is the integral of its square:\n$$\nM_{\\mathrm{int,int}}^{(T_1)} = \\int_{T_1} (\\varphi_{\\mathrm{int}}^{(1)})^2 \\, \\mathrm{d}\\Omega = \\int_{T_1} (4 \\lambda_1 \\lambda_3)^2 \\, \\mathrm{d}\\Omega = 16 \\int_{T_1} \\lambda_1^2 \\lambda_3^2 \\, \\mathrm{d}\\Omega\n$$\nThe integrand $\\lambda_1^2 \\lambda_3^2$ is a polynomial of degree $4$ in barycentric coordinates, and thus also in Cartesian coordinates. The specified quadrature rule is exact for this integral. We use the exact integration formula for powers of barycentric coordinates:\n$$\n\\int_T \\lambda_1^a \\lambda_2^b \\lambda_3^c \\, \\mathrm{d}\\Omega = 2|T| \\frac{a!b!c!}{(a+b+c+2)!}\n$$\nFor our integral, $a=2$, $b=0$, $c=2$, and $|T_1|=\\frac{1}{2}$.\n$$\n\\int_{T_1} \\lambda_1^2 \\lambda_3^2 \\, \\mathrm{d}\\Omega = 2\\left(\\frac{1}{2}\\right) \\frac{2!0!2!}{(2+0+2+2)!} = 1 \\cdot \\frac{2 \\cdot 1 \\cdot 2}{6!} = \\frac{4}{720} = \\frac{1}{180}\n$$\nSo, the elemental mass contribution from $T_1$ is:\n$$\nM_{\\mathrm{int,int}}^{(T_1)} = 16 \\cdot \\frac{1}{180} = \\frac{4}{45}\n$$\nFor the stiffness matrix, we need the gradient of $\\varphi_{\\mathrm{int}}^{(1)}$. The gradient of a barycentric coordinate $\\lambda_i$ on a triangle with vertices $(x_j, y_j)$ is a constant vector given by $\\nabla \\lambda_i = \\frac{1}{2|T|} \\begin{pmatrix} y_{i+1} - y_{i+2} \\\\ x_{i+2} - x_{i+1} \\end{pmatrix}$ (indices are cyclic).\nFor $T_1$ with $v_1(0,0), v_2(1,0), v_3(1,1)$ and $|T_1|=1/2$:\n$$\n\\nabla \\lambda_1 = \\frac{1}{2(1/2)} \\begin{pmatrix} y_2 - y_3 \\\\ x_3 - x_2 \\end{pmatrix} = \\begin{pmatrix} 0-1 \\\\ 1-1 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\nabla \\lambda_3 = \\frac{1}{1} \\begin{pmatrix} y_1 - y_2 \\\\ x_2 - x_1 \\end{pmatrix} = \\begin{pmatrix} 0-0 \\\\ 1-0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\nThe gradient of the basis function is:\n$$\n\\nabla \\varphi_{\\mathrm{int}}^{(1)} = \\nabla(4 \\lambda_1 \\lambda_3) = 4(\\lambda_3 \\nabla \\lambda_1 + \\lambda_1 \\nabla \\lambda_3) = 4\\left(\\lambda_3 \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} + \\lambda_1 \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\\right) = 4 \\begin{pmatrix} -\\lambda_3 \\\\ \\lambda_1 \\end{pmatrix}\n$$\nThe integrand for the stiffness matrix is the squared norm of this gradient:\n$$\n\\nabla \\varphi_{\\mathrm{int}}^{(1)} \\cdot \\nabla \\varphi_{\\mathrm{int}}^{(1)} = 16 \\left( (-\\lambda_3)^2 + (\\lambda_1)^2 \\right) = 16 (\\lambda_1^2 + \\lambda_3^2)\n$$\nThe elemental stiffness matrix entry is the integral of this quantity. This integrand is a degree-$2$ polynomial, so the specified quadrature is exact.\n$$\nK_{\\mathrm{int,int}}^{(T_1)} = \\int_{T_1} 16 (\\lambda_1^2 + \\lambda_3^2) \\, \\mathrm{d}\\Omega = 16 \\left( \\int_{T_1} \\lambda_1^2 \\, \\mathrm{d}\\Omega + \\int_{T_1} \\lambda_3^2 \\, \\mathrm{d}\\Omega \\right)\n$$\nUsing the integration formula with $a=2, b=0, c=0$:\n$$\n\\int_{T_1} \\lambda_1^2 \\, \\mathrm{d}\\Omega = 2\\left(\\frac{1}{2}\\right) \\frac{2!0!0!}{(2+0+0+2)!} = 1 \\cdot \\frac{2}{4!} = \\frac{2}{24} = \\frac{1}{12}\n$$\nBy symmetry, $\\int_{T_1} \\lambda_3^2 \\, \\mathrm{d}\\Omega = \\frac{1}{12}$.\nSo, the elemental stiffness contribution from $T_1$ is:\n$$\nK_{\\mathrm{int,int}}^{(T_1)} = 16 \\left( \\frac{1}{12} + \\frac{1}{12} \\right) = 16 \\left( \\frac{2}{12} \\right) = 16 \\left( \\frac{1}{6} \\right) = \\frac{8}{3}\n$$\n\n**Analysis on Triangle $T_2$**\nTriangle $T_2$ has vertices $V_1(0,0), V_4(0,1), V_3(1,1)$. It is geometrically congruent to $T_1$ (it is its reflection across the line $y=x$). By symmetry, the results for the elemental mass and stiffness matrices for the analogous basis function must be identical.\nLet's verify this for completeness. Let the local vertices of $T_2$ be $v_1'=(0,0)$, $v_2'=(0,1)$, and $v_3'=(1,1)$. The interior edge connects $v_1'$ and $v_3'$. The basis function is $\\varphi_{\\mathrm{int}}^{(2)} = 4 \\lambda_1' \\lambda_3'$. The area is $|T_2|=1/2$. The mass integral is identical in form, yielding $M_{\\mathrm{int,int}}^{(T_2)} = \\frac{4}{45}$.\nFor stiffness, we compute the gradients of barycentric coordinates on $T_2$:\n$$\n\\nabla \\lambda_1' = \\frac{1}{2(1/2)} \\begin{pmatrix} y_2' - y_3' \\\\ x_3' - x_2' \\end{pmatrix} = \\begin{pmatrix} 1-1 \\\\ 1-0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n$$\n\\nabla \\lambda_3' = \\frac{1}{1} \\begin{pmatrix} y_1' - y_2' \\\\ x_2' - x_1' \\end{pmatrix} = \\begin{pmatrix} 0-1 \\\\ 0-0 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\nabla \\varphi_{\\mathrm{int}}^{(2)} = 4(\\lambda_3' \\nabla \\lambda_1' + \\lambda_1' \\nabla \\lambda_3') = 4\\left(\\lambda_3' \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} + \\lambda_1' \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}\\right) = 4 \\begin{pmatrix} -\\lambda_1' \\\\ \\lambda_3' \\end{pmatrix}\n$$\nThe integrand is $\\nabla \\varphi_{\\mathrm{int}}^{(2)} \\cdot \\nabla \\varphi_{\\mathrm{int}}^{(2)} = 16 ((-\\lambda_1')^2 + (\\lambda_3')^2) = 16 (\\lambda_1'^2 + \\lambda_3'^2)$. The integral is identical to the one for $T_1$, so $K_{\\mathrm{int,int}}^{(T_2)} = \\frac{8}{3}$.\n\n**Assembly and Final Calculation**\nThe global mass and stiffness are scalars, obtained by summing the contributions from each element that contains the interior DOF.\n$$\nM_{\\mathrm{int}} = M_{\\mathrm{int,int}}^{(T_1)} + M_{\\mathrm{int,int}}^{(T_2)} = \\frac{4}{45} + \\frac{4}{45} = \\frac{8}{45}\n$$\n$$\nK_{\\mathrm{int}} = K_{\\mathrm{int,int}}^{(T_1)} + K_{\\mathrm{int,int}}^{(T_2)} = \\frac{8}{3} + \\frac{8}{3} = \\frac{16}{3}\n$$\nThe problem asks to verify that the assembled matrices are symmetric and positive definite. As they are $1 \\times 1$ matrices (scalars), symmetry is trivial. For positive definiteness, we check if the values are positive. $M_{\\mathrm{int}} = 8/45 > 0$ and $K_{\\mathrm{int}} = 16/3 > 0$. Both are positive, as expected from their definitions as integrals of squared functions. The properties are verified.\n\nFinally, we compute the ratio $R$:\n$$\nR = \\frac{K_{\\mathrm{int}}}{M_{\\mathrm{int}}} = \\frac{16/3}{8/45} = \\frac{16}{3} \\times \\frac{45}{8}\n$$\n$$\nR = \\frac{16}{8} \\times \\frac{45}{3} = 2 \\times 15 = 30\n$$\nThe final value of the ratio is $30$.",
            "answer": "$$\n\\boxed{30}\n$$"
        },
        {
            "introduction": "A truly powerful simulation is not just about solving a problem once, but about efficiently and reliably achieving a desired accuracy. This practice introduces the concept of a posteriori error estimation and adaptive mesh refinement, which closes the loop between solving and meshing . By calculating residual-based error indicators from a computed solution, you will learn how to identify regions where the discretization is insufficient and apply a systematic strategy to mark elements for refinement, paving the way for automated and efficient simulations.",
            "id": "3744598",
            "problem": "Consider the one-dimensional Poisson problem on the interval $[0,1]$ with homogeneous Dirichlet boundary conditions,\n$$\n- u''(x) = f(x), \\quad x \\in (0,1), \\qquad u(0) = 0, \\quad u(1) = 0,\n$$\nwhere $f(x) = 1$. Let $V$ denote the Sobolev space $H_{0}^{1}(0,1)$, and let $V_h \\subset V$ be the standard continuous, piecewise-linear finite element space associated with the mesh $\\mathcal{T}_h = \\{[0,0.5],[0.5,1]\\}$.\n\nUsing the Finite Element Method (FEM), the discrete weak formulation seeks $u_h \\in V_h$ such that for all $v_h \\in V_h$,\n$$\n\\int_{0}^{1} u_h'(x) \\, v_h'(x) \\, dx \\;=\\; \\int_{0}^{1} f(x) \\, v_h(x) \\, dx.\n$$\n\nYour tasks are:\n\n1. Solve for the finite element solution $u_h$ on the given mesh by determining its nodal value(s).\n\n2. Starting from the weak formulation above and using elementwise integration by parts together with standard trace and inverse inequalities on intervals, derive a residual-based a posteriori error indicator on each element $K \\in \\mathcal{T}_h$ that is a sum of:\n   - an interior residual term depending on $f$ restricted to $K$, and\n   - a face term depending on the jump of $u_h'$ at the interior node $x=0.5$.\n   Specialize your expressions to the given mesh and $f(x)=1$.\n\n3. Evaluate your derived error indicators numerically on each element of $\\mathcal{T}_h$.\n\n4. Apply the bulk-chasing marking strategy of Dörfler with parameter $\\theta = 0.6$, where the goal is to select a minimal subset $\\mathcal{M} \\subset \\mathcal{T}_h$ such that the sum of the squared indicators over $\\mathcal{M}$ is at least $\\theta$ times the sum over $\\mathcal{T}_h$. Determine the minimal number of elements that must be marked to satisfy the Dörfler criterion. Provide your final answer as a single integer, with no units.\n\nNo rounding is required in this problem. Express all intermediate mathematical derivations using LaTeX notation.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded, well-posed, objective, self-contained, and consistent. It represents a standard application of the Finite Element Method and a posteriori error analysis for the one-dimensional Poisson equation.\n\nThe given problem is:\n$$\n- u''(x) = f(x), \\quad x \\in (0,1)\n$$\nwith boundary conditions $u(0) = 0$ and $u(1) = 0$, and source term $f(x)=1$. The discrete weak formulation on a finite element space $V_h \\subset H_0^1(0,1)$ is to find $u_h \\in V_h$ such that:\n$$\na(u_h, v_h) = L(v_h) \\quad \\forall v_h \\in V_h\n$$\nwhere $a(u,v) = \\int_{0}^{1} u'(x) v'(x) dx$ and $L(v) = \\int_{0}^{1} f(x) v(x) dx$.\n\nThe specified finite element space $V_h$ consists of continuous, piecewise-linear functions on the mesh $\\mathcal{T}_h = \\{K_1, K_2\\}$ with $K_1 = [0, 0.5]$ and $K_2 = [0.5, 1]$. The nodes of the mesh are $x_0=0$, $x_1=0.5$, and $x_2=1$.\n\n### Task 1: Solve for the finite element solution $u_h$\n\nThe finite element solution $u_h(x)$ is a linear combination of basis functions, $u_h(x) = \\sum_{j=0}^{2} U_j \\phi_j(x)$, where $\\phi_j(x)$ are the standard linear \"hat\" functions satisfying $\\phi_j(x_i) = \\delta_{ij}$. The coefficients $U_j = u_h(x_j)$ are the nodal values.\nThe homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(1)=0$ are imposed on $u_h$, so $U_0 = 0$ and $U_2 = 0$. The only unknown nodal value is $U_1 = u_h(0.5)$.\nThe solution is $u_h(x) = U_1 \\phi_1(x)$.\nThe space of test functions $V_h$ is spanned by functions that are zero at the boundaries, so we only need to test with $v_h = \\phi_1(x)$. The weak formulation becomes a single linear equation:\n$$\na(U_1 \\phi_1, \\phi_1) = L(\\phi_1) \\implies U_1 \\int_{0}^{1} (\\phi_1'(x))^2 dx = \\int_{0}^{1} f(x) \\phi_1(x) dx\n$$\nThe basis function $\\phi_1(x)$ and its derivative $\\phi_1'(x)$ are:\n$$\n\\phi_1(x) = \\begin{cases} \\frac{x - 0}{0.5 - 0} = 2x & x \\in [0, 0.5] \\\\ \\frac{1 - x}{1 - 0.5} = 2(1-x) & x \\in [0.5, 1] \\end{cases}\n\\qquad\n\\phi_1'(x) = \\begin{cases} 2 & x \\in (0, 0.5) \\\\ -2 & x \\in (0.5, 1) \\end{cases}\n$$\nThe stiffness term is:\n$$\n\\int_{0}^{1} (\\phi_1'(x))^2 dx = \\int_{0}^{0.5} (2)^2 dx + \\int_{0.5}^{1} (-2)^2 dx = \\int_0^1 4 dx = 4\n$$\nThe load term with $f(x)=1$ is:\n$$\n\\int_{0}^{1} f(x) \\phi_1(x) dx = \\int_{0}^{1} \\phi_1(x) dx = \\int_{0}^{0.5} 2x dx + \\int_{0.5}^{1} 2(1-x) dx = \\left[x^2\\right]_0^{0.5} + \\left[2x - x^2\\right]_{0.5}^{1}\n$$\n$$\n= (0.5^2 - 0) + ((2-1) - (2(0.5) - 0.5^2)) = 0.25 + (1 - (1 - 0.25)) = 0.25 + 0.25 = 0.5 = \\frac{1}{2}\n$$\nSolving for $U_1$:\n$$\n4 U_1 = \\frac{1}{2} \\implies U_1 = \\frac{1}{8}\n$$\nThe nodal value is $u_h(0.5) = 1/8$. The finite element solution is:\n$$\nu_h(x) = \\begin{cases} \\frac{1}{8}(2x) = \\frac{x}{4} & x \\in [0, 0.5] \\\\ \\frac{1}{8}(2(1-x)) = \\frac{1-x}{4} & x \\in [0.5, 1] \\end{cases}\n$$\n\n### Task 2: Derive a residual-based a posteriori error indicator\n\nLet $e(x) = u(x) - u_h(x)$ be the error. For any test function $v \\in H_0^1(0,1)$, the error satisfies the Galerkin orthogonality: $a(e, v_h) = 0$ for all $v_h \\in V_h$. The error equation is found by subtracting the discrete weak form from the continuous one:\n$$\na(e, v) = \\int_0^1 e'(x)v'(x)dx = \\int_0^1 f(x)v(x)dx - \\int_0^1 u_h'(x)v'(x)dx\n$$\nWe perform element-wise integration by parts on the second term on the right:\n$$\n\\int_0^1 e'v'dx = \\sum_{K \\in \\mathcal{T}_h} \\left( \\int_K fv dx - \\left( \\left[ u_h'v \\right]_{\\partial K} - \\int_K u_h'' v dx \\right) \\right)\n$$\n$$\n\\int_0^1 e'v'dx = \\sum_{K \\in \\mathcal{T}_h} \\int_K (f + u_h'')v dx - \\sum_{K \\in \\mathcal{T}_h} \\left[ u_h'v \\right]_{\\partial K}\n$$\nThe term $R_K = f + u_h''$ is the element interior residual. The boundary sum can be reorganized as a sum over faces (nodes in 1D). As $v(0)=v(1)=0$, terms at the domain boundary vanish. For an interior node $z$ shared by elements $K_L$ and $K_R$, the contribution is $u_h'|_{K_R}(z)v(z) - u_h'|_{K_L}(z)v(z) = [u_h']_z v(z)$, using the jump definition $[w]_z = w(z^+) - w(z^-)$. Conventionally, the jump term in the error equation appears as a sum over interior faces, with a change of sign.\n$$\n\\int_0^1 e'v'dx = \\sum_{K \\in \\mathcal{T}_h} \\int_K R_K v dx + \\sum_{\\text{interior nodes } z} J_z v(z)\n$$\nwhere $J_z = u_h'(z^-) - u_h'(z^+)$ is the jump in the flux.\nStandard a posteriori error analysis shows that the energy norm of the error is bounded above and below by a quantity composed of these residuals. The squared error indicator on an element $K$ is a sum of terms corresponding to the interior residual and the flux jumps over its faces. For the 1D Poisson problem, the standard definition is:\n$$\n\\eta_K^2 = C_1 h_K^2 \\|f + u_h''\\|_{L^2(K)}^2 + C_2 \\sum_{z \\in \\partial K, z \\text{ interior}} \\frac{1}{2} |[u_h']_z|^2\n$$\nThe constants $C_1, C_2$ depend on the interpolation operator and stability estimates, but are typically taken as $1$. The factor $1/2$ distributes the jump residual at a face to the two elements sharing it. The derived indicator formula is thus:\n$$\n\\eta_K^2 = h_K^2 \\int_K(f(x) + u_h''(x))^2 dx + \\frac{1}{2} \\sum_{z \\in \\partial K, z \\in (0,1)} ([u_h']_z)^2\n$$\nThis indicator $\\eta_K$ is composed of an interior residual term and a face jump term, as requested.\n\n### Task 3: Evaluate the error indicators\n\nWe apply the derived formula to our specific problem.\nThe mesh is $\\mathcal{T}_h = \\{K_1, K_2\\}$ where $K_1=[0, 0.5]$ and $K_2=[0.5, 1]$. The element sizes are $h_{K_1}=0.5$ and $h_{K_2}=0.5$.\nThe source term is $f(x)=1$.\nFrom Task 1, the FEM solution's second derivative is $u_h''(x) = 0$ inside each element.\nThe interior residual is $R_K = f+u_h'' = 1+0=1$ for both $K_1$ and $K_2$.\nThe only interior node is at $z=0.5$. The derivatives are $u_h'|_{K_1} = 1/4$ and $u_h'|_{K_2} = -1/4$.\nThe jump in the derivative at $z=0.5$ is $[u_h']_{0.5} = u_h'(0.5^+) - u_h'(0.5^-) = (-1/4) - (1/4) = -1/2$.\n\nFor element $K_1=[0, 0.5]$:\nThe interior boundary is at $z=0.5$.\n$$\n\\eta_{K_1}^2 = h_{K_1}^2 \\int_0^{0.5} (1)^2 dx + \\frac{1}{2} \\left( [u_h']_{0.5} \\right)^2\n$$\n$$\n\\eta_{K_1}^2 = (0.5)^2 \\cdot (0.5) + \\frac{1}{2} \\left(-\\frac{1}{2}\\right)^2 = \\left(\\frac{1}{4}\\right)\\left(\\frac{1}{2}\\right) + \\frac{1}{2}\\left(\\frac{1}{4}\\right) = \\frac{1}{8} + \\frac{1}{8} = \\frac{2}{8} = \\frac{1}{4}\n$$\nSo, the indicator is $\\eta_{K_1} = \\sqrt{1/4} = 1/2$.\n\nFor element $K_2=[0.5, 1]$:\nThe interior boundary is at $z=0.5$.\n$$\n\\eta_{K_2}^2 = h_{K_2}^2 \\int_{0.5}^1 (1)^2 dx + \\frac{1}{2} \\left( [u_h']_{0.5} \\right)^2\n$$\n$$\n\\eta_{K_2}^2 = (0.5)^2 \\cdot (0.5) + \\frac{1}{2} \\left(-\\frac{1}{2}\\right)^2 = \\left(\\frac{1}{4}\\right)\\left(\\frac{1}{2}\\right) + \\frac{1}{2}\\left(\\frac{1}{4}\\right) = \\frac{1}{8} + \\frac{1}{8} = \\frac{2}{8} = \\frac{1}{4}\n$$\nSo, the indicator is $\\eta_{K_2} = \\sqrt{1/4} = 1/2$.\nThe numerical values of the squared indicators are $\\eta_{K_1}^2 = 1/4$ and $\\eta_{K_2}^2 = 1/4$.\n\n### Task 4: Apply the Dörfler marking strategy\n\nThe Dörfler marking strategy with parameter $\\theta$ requires finding a minimal set of marked elements $\\mathcal{M} \\subset \\mathcal{T}_h$ such that:\n$$\n\\sum_{K \\in \\mathcal{M}} \\eta_K^2 \\ge \\theta \\sum_{K \\in \\mathcal{T}_h} \\eta_K^2\n$$\nGiven $\\theta = 0.6$.\nFirst, calculate the total sum of squared indicators:\n$$\n\\sum_{K \\in \\mathcal{T}_h} \\eta_K^2 = \\eta_{K_1}^2 + \\eta_{K_2}^2 = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}\n$$\nThe target threshold for the sum over the marked set $\\mathcal{M}$ is:\n$$\n\\theta \\sum_{K \\in \\mathcal{T}_h} \\eta_K^2 = 0.6 \\times \\frac{1}{2} = 0.3\n$$\nThe strategy is to sort the elements by their indicator values in descending order and add them to $\\mathcal{M}$ until the threshold is met.\nThe indicators are $\\eta_{K_1}^2 = 0.25$ and $\\eta_{K_2}^2 = 0.25$. They are equal.\n1. Mark the element with the largest indicator. We can choose $K_1$.\n   $\\mathcal{M} = \\{K_1\\}$. The sum over $\\mathcal{M}$ is $\\eta_{K_1}^2 = 0.25$.\n   Check the condition: $0.25 \\ge 0.3$ is false.\n\n2. Mark the element with the next largest indicator, which is $K_2$.\n   $\\mathcal{M} = \\{K_1, K_2\\}$. The sum over $\\mathcal{M}$ is $\\eta_{K_1}^2 + \\eta_{K_2}^2 = 0.25 + 0.25 = 0.5$.\n   Check the condition: $0.5 \\ge 0.3$ is true.\n\nThe condition is satisfied. The minimal set of elements required is $\\mathcal{M} = \\{K_1, K_2\\}$. The number of elements in this set is $2$.\nTherefore, the minimal number of elements that must be marked is $2$.",
            "answer": "$$\\boxed{2}$$"
        }
    ]
}