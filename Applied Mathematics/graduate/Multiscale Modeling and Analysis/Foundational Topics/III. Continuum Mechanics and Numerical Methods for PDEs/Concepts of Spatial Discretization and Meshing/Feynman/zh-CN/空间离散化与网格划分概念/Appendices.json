{
    "hands_on_practices": [
        {
            "introduction": "在模拟复杂几何形状时，我们常常需要使用弯曲的网格单元来精确贴合边界。等参映射是实现这一目标的核心技术，它将一个简单的参考单元（如标准三角形）映射到物理空间中的弯曲单元。然而，不恰当的节点排布可能导致映射扭曲，产生无效的“翻转”单元，本练习  将指导你通过计算雅可比行列式来检验单元的有效性，这是衡量映射质量和确保数值模拟稳定性的一个基本步骤。",
            "id": "3744605",
            "problem": "一个等参六节点二次三角形用于将参数平面中坐标为 $(\\xi,\\eta)$（其中 $0 \\le \\xi$、$0 \\le \\eta$ 且 $\\xi + \\eta \\le 1$）的参考三角形，映射到物理平面中坐标为 $(x,y)$ 的曲边三角形。该等参映射使用了三角形上的标准二次拉格朗日形函数。令 $L_{1} = 1 - \\xi - \\eta$，$L_{2} = \\xi$ 及 $L_{3} = \\eta$。六个二次形函数定义如下\n$$\nN_{1} = L_{1}(2L_{1} - 1),\\quad\nN_{2} = L_{2}(2L_{2} - 1),\\quad\nN_{3} = L_{3}(2L_{3} - 1),\\quad\nN_{4} = 4L_{1}L_{2},\\quad\nN_{5} = 4L_{2}L_{3},\\quad\nN_{6} = 4L_{3}L_{1}.\n$$\n物理坐标 $(x(\\xi,\\eta),y(\\xi,\\eta))$ 由以下等参插值给出\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{6} N_{i}(\\xi,\\eta)\\,x_{i},\\qquad\ny(\\xi,\\eta) = \\sum_{i=1}^{6} N_{i}(\\xi,\\eta)\\,y_{i},\n$$\n节点坐标为\n$$\n(x_{1},y_{1}) = (0,0),\\quad (x_{2},y_{2}) = (0,2),\\quad (x_{3},y_{3}) = (2,0),\\\\\n(x_{4},y_{4}) = (-0.1,1.1),\\quad (x_{5},y_{5}) = (1.2,1.1),\\quad (x_{6},y_{6}) = (0.9,-0.2).\n$$\n离散雅可比行列式为 $J(\\xi,\\eta) = \\det\\!\\left(\\partial(x,y)/\\partial(\\xi,\\eta)\\right)$，其中\n$$\n\\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} =\n\\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix}.\n$$\n使用对三角形上最高为2次的多项式精确的三点对称高斯求积法则，在三个高斯点 $(\\xi,\\eta) = (1/6,1/6)$、$(2/3,1/6)$ 和 $(1/6,2/3)$ 处计算 $J(\\xi,\\eta)$ 的值。然后，根据这些值的符号，判断单元是否在这些求积点附近出现局部反转。\n\n仅报告 $J$ 在这三个高斯点上的最小值作为最终答案。将答案表示为一个纯数（无量纲），并四舍五入到四位有效数字。",
            "solution": "用户希望我按照给定的说明来解决这个问题。\n\n### 第一步：提取已知条件\n- **单元类型**：等参六节点二次三角形。\n- **参数坐标**：参考三角形中的 $(\\xi, \\eta)$，由 $0 \\le \\xi$，$0 \\le \\eta$ 和 $\\xi + \\eta \\le 1$ 定义。\n- **面积坐标**：$L_{1} = 1 - \\xi - \\eta$，$L_{2} = \\xi$，$L_{3} = \\eta$。\n- **形函数**：\n  $N_{1} = L_{1}(2L_{1} - 1)$\n  $N_{2} = L_{2}(2L_{2} - 1)$\n  $N_{3} = L_{3}(2L_{3} - 1)$\n  $N_{4} = 4L_{1}L_{2}$\n  $N_{5} = 4L_{2}L_{3}$\n  $N_{6} = 4L_{3}L_{1}$\n- **等参映射**：\n  $x(\\xi,\\eta) = \\sum_{i=1}^{6} N_{i}(\\xi,\\eta)x_{i}$\n  $y(\\xi,\\eta) = \\sum_{i=1}^{6} N_{i}(\\xi,\\eta)y_{i}$\n- **节点坐标**：\n  $(x_{1},y_{1}) = (0,0)$\n  $(x_{2},y_{2}) = (0,2)$\n  $(x_{3},y_{3}) = (2,0)$\n  $(x_{4},y_{4}) = (-0.1,1.1)$\n  $(x_{5},y_{5}) = (1.2,1.1)$\n  $(x_{6},y_{6}) = (0.9,-0.2)$\n- **雅可比矩阵**：$\\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}$\n- **雅可比行列式**：$J(\\xi,\\eta) = \\det(\\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)})$\n- **求值点**：$(\\xi,\\eta) = (1/6,1/6)$、$(2/3,1/6)$ 和 $(1/6,2/3)$。\n- **任务**：在三个给定点处计算 $J(\\xi,\\eta)$，评论其符号，并报告 $J$ 的最小值，四舍五入到四位有效数字。\n\n### 第二步：使用提取的已知条件进行验证\n该问题具有科学依据，植根于有限元法的标准理论。它是适定的，因为所有计算所需量的数据和定义都已提供。语言客观而精确。节点坐标虽然定义了一个扭曲的单元，但在数学上与问题的提法是一致的。没有矛盾、信息缺失或不切实际的物理假设。该问题是等参映射原理的一个直接应用，尽管计算量较大。\n\n### 第三步：结论与行动\n问题有效。将提供完整解答。\n\n问题要求在参数域的三个特定点上计算雅可比行列式 $J(\\xi,\\eta) = \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial x}{\\partial \\eta}\\frac{\\partial y}{\\partial \\xi}$。雅可比矩阵的分量通过对等参映射方程求导得到：\n$$ \\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi} x_i, \\quad \\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta} x_i $$\n$$ \\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi} y_i, \\quad \\frac{\\partial y}{\\partial \\eta} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta} y_i $$\n首先，我们求形函数 $N_i$ 相对于参数坐标 $(\\xi, \\eta)$ 的导数。使用链式法则和面积坐标 $L_1, L_2, L_3$ 来完成此操作最为方便。面积坐标的导数是：\n$$ \\frac{\\partial L_1}{\\partial \\xi} = -1, \\quad \\frac{\\partial L_1}{\\partial \\eta} = -1 $$\n$$ \\frac{\\partial L_2}{\\partial \\xi} = 1, \\quad \\frac{\\partial L_2}{\\partial \\eta} = 0 $$\n$$ \\frac{\\partial L_3}{\\partial \\xi} = 0, \\quad \\frac{\\partial L_3}{\\partial \\eta} = 1 $$\n形函数 $N_i(L_1, L_2, L_3)$ 的导数是：\n$$\n\\begin{aligned}\n\\frac{\\partial N_1}{\\partial \\xi} = (4L_1-1)\\frac{\\partial L_1}{\\partial \\xi} = 1-4L_1,  \\frac{\\partial N_1}{\\partial \\eta} = (4L_1-1)\\frac{\\partial L_1}{\\partial \\eta} = 1-4L_1 \\\\\n\\frac{\\partial N_2}{\\partial \\xi} = (4L_2-1)\\frac{\\partial L_2}{\\partial \\xi} = 4L_2-1,  \\frac{\\partial N_2}{\\partial \\eta} = (4L_2-1)\\frac{\\partial L_2}{\\partial \\eta} = 0 \\\\\n\\frac{\\partial N_3}{\\partial \\xi} = (4L_3-1)\\frac{\\partial L_3}{\\partial \\xi} = 0,  \\frac{\\partial N_3}{\\partial \\eta} = (4L_3-1)\\frac{\\partial L_3}{\\partial \\eta} = 4L_3-1 \\\\\n\\frac{\\partial N_4}{\\partial \\xi} = 4\\left(L_1\\frac{\\partial L_2}{\\partial \\xi} + L_2\\frac{\\partial L_1}{\\partial \\xi}\\right) = 4(L_1-L_2),  \\frac{\\partial N_4}{\\partial \\eta} = 4\\left(L_1\\frac{\\partial L_2}{\\partial \\eta} + L_2\\frac{\\partial L_1}{\\partial \\eta}\\right) = -4L_2 \\\\\n\\frac{\\partial N_5}{\\partial \\xi} = 4\\left(L_2\\frac{\\partial L_3}{\\partial \\xi} + L_3\\frac{\\partial L_2}{\\partial \\xi}\\right) = 4L_3,  \\frac{\\partial N_5}{\\partial \\eta} = 4\\left(L_2\\frac{\\partial L_3}{\\partial \\eta} + L_3\\frac{\\partial L_2}{\\partial \\eta}\\right) = 4L_2 \\\\\n\\frac{\\partial N_6}{\\partial \\xi} = 4\\left(L_3\\frac{\\partial L_1}{\\partial \\xi} + L_1\\frac{\\partial L_3}{\\partial \\xi}\\right) = -4L_3,  \\frac{\\partial N_6}{\\partial \\eta} = 4\\left(L_3\\frac{\\partial L_1}{\\partial \\eta} + L_1\\frac{\\partial L_3}{\\partial \\eta}\\right) = 4(L_1-L_3)\n\\end{aligned}\n$$\n\n我们现在在三个指定的高斯点处分别计算雅可比行列式。\n\n**1. 在点 1 计算：$(\\xi, \\eta) = (1/6, 1/6)$**\n面积坐标为 $L_1 = 1 - 1/6 - 1/6 = 4/6 = 2/3$，$L_2 = 1/6$，$L_3 = 1/6$。\n在该点，形函数的导数为：\n$\\frac{\\partial N_1}{\\partial\\xi} = 1 - 4(2/3) = -5/3$, $\\frac{\\partial N_1}{\\partial\\eta} = -5/3$\n$\\frac{\\partial N_2}{\\partial\\xi} = 4(1/6) - 1 = -1/3$, $\\frac{\\partial N_2}{\\partial\\eta} = 0$\n$\\frac{\\partial N_3}{\\partial\\xi} = 0$, $\\frac{\\partial N_3}{\\partial\\eta} = 4(1/6) - 1 = -1/3$\n$\\frac{\\partial N_4}{\\partial\\xi} = 4(2/3 - 1/6) = 2$, $\\frac{\\partial N_4}{\\partial\\eta} = -4(1/6) = -2/3$\n$\\frac{\\partial N_5}{\\partial\\xi} = 4(1/6) = 2/3$, $\\frac{\\partial N_5}{\\partial\\eta} = 4(1/6) = 2/3$\n$\\frac{\\partial N_6}{\\partial\\xi} = -4(1/6) = -2/3$, $\\frac{\\partial N_6}{\\partial\\eta} = 4(2/3 - 1/6) = 2$\n\n使用节点坐标 $(x_i) = (0, 0, 2, -0.1, 1.2, 0.9)$ 和 $(y_i) = (0, 2, 0, 1.1, 1.1, -0.2)$：\n$\\frac{\\partial x}{\\partial \\xi} = (-\\frac{5}{3})\\cdot 0 + (-\\frac{1}{3})\\cdot 0 + 0\\cdot 2 + 2\\cdot(-0.1) + (\\frac{2}{3})\\cdot 1.2 + (-\\frac{2}{3})\\cdot 0.9 = -0.2 + 0.8 - 0.6 = 0$\n$\\frac{\\partial x}{\\partial \\eta} = (-\\frac{5}{3})\\cdot 0 + 0\\cdot 0 + (-\\frac{1}{3})\\cdot 2 + (-\\frac{2}{3})\\cdot(-0.1) + \\frac{2}{3}\\cdot 1.2 + 2\\cdot 0.9 = -2/3 + 0.2/3 + 2.4/3 + 1.8 = 0.6/3 + 1.8 = 2$\n$\\frac{\\partial y}{\\partial \\xi} = (-\\frac{5}{3})\\cdot 0 + (-\\frac{1}{3})\\cdot 2 + 0\\cdot 0 + 2\\cdot 1.1 + (\\frac{2}{3})\\cdot 1.1 + (-\\frac{2}{3})\\cdot(-0.2) = -2/3 + 2.2 + 2.2/3 + 0.4/3 = 2.4$\n$\\frac{\\partial y}{\\partial \\eta} = (-\\frac{5}{3})\\cdot 0 + 0\\cdot 2 + (-\\frac{1}{3})\\cdot 0 + (-\\frac{2}{3})\\cdot 1.1 + (\\frac{2}{3})\\cdot 1.1 + 2\\cdot(-0.2) = -0.4$\n雅可比行列式为 $J(1/6, 1/6) = (0)(-0.4) - (2)(2.4) = -4.8$。\n\n**2. 在点 2 计算：$(\\xi, \\eta) = (2/3, 1/6)$**\n面积坐标为 $L_1 = 1 - 2/3 - 1/6 = 1/6$，$L_2 = 2/3$，$L_3 = 1/6$。\n在该点，形函数的导数为：\n$\\frac{\\partial N_1}{\\partial\\xi} = 1 - 4(1/6) = 1/3$, $\\frac{\\partial N_1}{\\partial\\eta} = 1/3$\n$\\frac{\\partial N_2}{\\partial\\xi} = 4(2/3) - 1 = 5/3$, $\\frac{\\partial N_2}{\\partial\\eta} = 0$\n$\\frac{\\partial N_3}{\\partial\\xi} = 0$, $\\frac{\\partial N_3}{\\partial\\eta} = 4(1/6) - 1 = -1/3$\n$\\frac{\\partial N_4}{\\partial\\xi} = 4(1/6 - 2/3) = -2$, $\\frac{\\partial N_4}{\\partial\\eta} = -4(2/3) = -8/3$\n$\\frac{\\partial N_5}{\\partial\\xi} = 4(1/6) = 2/3$, $\\frac{\\partial N_5}{\\partial\\eta} = 4(2/3) = 8/3$\n$\\frac{\\partial N_6}{\\partial\\xi} = -4(1/6) = -2/3$, $\\frac{\\partial N_6}{\\partial\\eta} = 4(1/6 - 1/6) = 0$\n\n$\\frac{\\partial x}{\\partial \\xi} = (\\frac{1}{3})\\cdot 0 + (\\frac{5}{3})\\cdot 0 + 0\\cdot 2 + (-2)\\cdot(-0.1) + (\\frac{2}{3})\\cdot 1.2 + (-\\frac{2}{3})\\cdot 0.9 = 0.2 + 0.8 - 0.6 = 0.4$\n$\\frac{\\partial x}{\\partial \\eta} = (\\frac{1}{3})\\cdot 0 + 0\\cdot 0 + (-\\frac{1}{3})\\cdot 2 + (-\\frac{8}{3})\\cdot(-0.1) + (\\frac{8}{3})\\cdot 1.2 + 0\\cdot 0.9 = -2/3 + 0.8/3 + 9.6/3 = 8.4/3 = 2.8$\n$\\frac{\\partial y}{\\partial \\xi} = (\\frac{1}{3})\\cdot 0 + (\\frac{5}{3})\\cdot 2 + 0\\cdot 0 + (-2)\\cdot 1.1 + (\\frac{2}{3})\\cdot 1.1 + (-\\frac{2}{3})\\cdot(-0.2) = 10/3 - 2.2 + 2.2/3 + 0.4/3 = 2$\n$\\frac{\\partial y}{\\partial \\eta} = (\\frac{1}{3})\\cdot 0 + 0\\cdot 2 + (-\\frac{1}{3})\\cdot 0 + (-\\frac{8}{3})\\cdot 1.1 + (\\frac{8}{3})\\cdot 1.1 + 0\\cdot(-0.2) = 0$\n雅可比行列式为 $J(2/3, 1/6) = (0.4)(0) - (2.8)(2) = -5.6$。\n\n**3. 在点 3 计算：$(\\xi, \\eta) = (1/6, 2/3)$**\n面积坐标为 $L_1 = 1 - 1/6 - 2/3 = 1/6$，$L_2 = 1/6$，$L_3 = 2/3$。\n在该点，形函数的导数为：\n$\\frac{\\partial N_1}{\\partial\\xi} = 1 - 4(1/6) = 1/3$, $\\frac{\\partial N_1}{\\partial\\eta} = 1/3$\n$\\frac{\\partial N_2}{\\partial\\xi} = 4(1/6) - 1 = -1/3$, $\\frac{\\partial N_2}{\\partial\\eta} = 0$\n$\\frac{\\partial N_3}{\\partial\\xi} = 0$, $\\frac{\\partial N_3}{\\partial\\eta} = 4(2/3) - 1 = 5/3$\n$\\frac{\\partial N_4}{\\partial\\xi} = 4(1/6 - 1/6) = 0$, $\\frac{\\partial N_4}{\\partial\\eta} = -4(1/6) = -2/3$\n$\\frac{\\partial N_5}{\\partial\\xi} = 4(2/3) = 8/3$, $\\frac{\\partial N_5}{\\partial\\eta} = 4(1/6) = 2/3$\n$\\frac{\\partial N_6}{\\partial\\xi} = -4(2/3) = -8/3$, $\\frac{\\partial N_6}{\\partial\\eta} = 4(1/6 - 2/3) = -2$\n\n$\\frac{\\partial x}{\\partial \\xi} = (\\frac{1}{3})\\cdot 0 + (-\\frac{1}{3})\\cdot 0 + 0\\cdot 2 + 0\\cdot(-0.1) + (\\frac{8}{3})\\cdot 1.2 + (-\\frac{8}{3})\\cdot 0.9 = 9.6/3 - 7.2/3 = 2.4/3 = 0.8$\n$\\frac{\\partial x}{\\partial \\eta} = (\\frac{1}{3})\\cdot 0 + 0\\cdot 0 + (\\frac{5}{3})\\cdot 2 + (-\\frac{2}{3})\\cdot(-0.1) + (\\frac{2}{3})\\cdot 1.2 + (-2)\\cdot 0.9 = 10/3 + 0.2/3 + 2.4/3 - 1.8 = 12.6/3 - 1.8 = 4.2 - 1.8 = 2.4$\n$\\frac{\\partial y}{\\partial \\xi} = (\\frac{1}{3})\\cdot 0 + (-\\frac{1}{3})\\cdot 2 + 0\\cdot 0 + 0\\cdot 1.1 + (\\frac{8}{3})\\cdot 1.1 + (-\\frac{8}{3})\\cdot(-0.2) = -2/3 + 8.8/3 + 1.6/3 = 8.4/3 = 2.8$\n$\\frac{\\partial y}{\\partial \\eta} = (\\frac{1}{3})\\cdot 0 + 0\\cdot 2 + (\\frac{5}{3})\\cdot 0 + (-\\frac{2}{3})\\cdot 1.1 + (\\frac{2}{3})\\cdot 1.1 + (-2)\\cdot(-0.2) = 0.4$\n雅可比行列式为 $J(1/6, 2/3) = (0.8)(0.4) - (2.4)(2.8) = 0.32 - 6.72 = -6.4$。\n\n**结论**\n在三个求积点处的雅可比行列式值分别为 $J_1 = -4.8$、$J_2 = -5.6$ 和 $J_3 = -6.4$。这三个点处雅可比行列式均为负值，表明等参映射在这些点附近发生了局部反转。对于大多数物理模拟，这样的单元被认为是几何无效的。\n\n在这三个点上，$J$ 的最小值为 $\\min(-4.8, -5.6, -6.4) = -6.4$。\n四舍五入到四位有效数字，最小值为 $-6.400$。",
            "answer": "$$ \\boxed{-6.400} $$"
        },
        {
            "introduction": "确保网格有效性之后，下一步是构建近似控制偏微分方程的代数方程组。此过程的核心是计算单元矩阵，例如质量矩阵和刚度矩阵，它们分别代表了系统的惯性（或容量）和刚度特性。本练习  提供了这一关键步骤的动手实践，重点关注能提供更高精度的 $P_2$ 高阶单元，你将应用重心坐标和数值积分等技术，深入理解从连续介质力学模型到离散数值系统的转化过程。",
            "id": "3744597",
            "problem": "考虑在单位正方形 $\\Omega = [0,1] \\times [0,1]$ 上定义的齐次泊松方程 $-\\Delta u = 0$，其边界条件为齐次狄利克雷边界条件 $u = 0$ on $\\partial \\Omega$。通过沿从 $(0,0)$ 到 $(1,1)$ 的对角线分割正方形，将 $\\Omega$ 离散化为一个由两个三角形组成的协调单纯剖分；也就是说，三角形 $T_1$ 的顶点为 $(0,0)$, $(1,0)$, $(1,1)$，三角形 $T_2$ 的顶点为 $(0,0)$, $(0,1)$, $(1,1)$。在三角形上使用二次拉格朗日（二次）有限元空间，通常表示为 $P_2$，其节点基由每个顶点一个函数和每个边中点一个函数组成。设内部边为连接 $(0,0)$ 和 $(1,1)$ 的对角线；在重心坐标为 $(\\lambda_1,\\lambda_2,\\lambda_3)$ 的三角形上，与该内部边中点相关的二次基函数是定义该边的顶点对 $(i,j)$ 的典范边函数 $4 \\lambda_i \\lambda_j$。\n\n对于一个具有 $P_2$ 基函数 $\\{\\varphi_\\alpha\\}_{\\alpha=1}^{6}$ 的一般三角形 $T$，通过标准的有限元方法（FEM）积分来定义其单元质量矩阵和刚度矩阵\n$$\nM^{(T)}_{\\alpha\\beta} = \\int_{T} \\varphi_\\alpha \\varphi_\\beta \\, \\mathrm{d}\\Omega, \\quad\nK^{(T)}_{\\alpha\\beta} = \\int_{T} \\nabla \\varphi_\\alpha \\cdot \\nabla \\varphi_\\beta \\, \\mathrm{d}\\Omega.\n$$\n使用对质量矩阵总次数最高为 $4$ 的多项式、对刚度矩阵总次数最高为 $2$ 的多项式精确的三角形求积法则来计算这些积分。通过对单元贡献求和来组装全局质量矩阵和刚度矩阵，然后通过消除所有边界自由度来施加齐次狄利克雷边界条件。对于给定的网格，唯一剩下的全局自由度对应于对角线上的内部边中点。将其全局组装的质量和刚度标量分别表示为 $M_{\\mathrm{int}}$ 和 $K_{\\mathrm{int}}$。\n\n从上述定义和仿射三角形上重心坐标的性质出发，计算：\n- 每个三角形对与内部边中点基函数相关的单元质量和刚度矩阵项的贡献，\n- 针对内部自由度组装的标量 $M_{\\mathrm{int}}$ 和 $K_{\\mathrm{int}}$。\n\n然后验证组装的全局质量和刚度矩阵（限制在内部自由度空间上）是对称正定的。最后，报告比值的单个标量值\n$$\nR = \\frac{K_{\\mathrm{int}}}{M_{\\mathrm{int}}}.\n$$\n将最终答案表示为精确值；无需四舍五入，该比值没有单位。",
            "solution": "首先对问题进行验证。\n\n### 步骤 1：提取已知条件\n-   **方程**：齐次泊松方程，$-\\Delta u = 0$。\n-   **区域**：单位正方形，$\\Omega = [0,1] \\times [0,1]$。\n-   **边界条件**：齐次狄利克雷条件，$u = 0$ on $\\partial \\Omega$。\n-   **网格**：区域 $\\Omega$ 被沿从 $(0,0)$ 到 $(1,1)$ 的对角线分割，离散为两个三角形 $T_1$ 和 $T_2$。\n    -   $T_1$ 的顶点为 $(0,0)$, $(1,0)$, $(1,1)$。\n    -   $T_2$ 的顶点为 $(0,0)$, $(0,1)$, $(1,1)$。\n-   **有限元空间**：三角形上的二次拉格朗日有限元空间，$P_2$。节点基由与顶点和边中点相关的函数组成。\n-   **基函数**：由顶点 $i$ 和 $j$ 定义的边的中点的基函数在重心坐标 $(\\lambda_1, \\lambda_2, \\lambda_3)$ 中由 $4\\lambda_i \\lambda_j$ 给出。\n-   **内部自由度 (DOF)**：唯一的非边界自由度与内部边（即从 $(0,0)$ 到 $(1,1)$ 的对角线）的中点相关联。\n-   **单元矩阵**：\n    -   质量矩阵：$M^{(T)}_{\\alpha\\beta} = \\int_{T} \\varphi_\\alpha \\varphi_\\beta \\, \\mathrm{d}\\Omega$。\n    -   刚度矩阵：$K^{(T)}_{\\alpha\\beta} = \\int_{T} \\nabla \\varphi_\\alpha \\cdot \\nabla \\varphi_\\beta \\, \\mathrm{d}\\Omega$。\n-   **求积法则**：\n    -   质量矩阵积分使用对总次数最高为 $4$ 的多项式精确的法则进行计算。\n    -   刚度矩阵积分使用对总次数最高为 $2$ 的多项式精确的法则进行计算。\n-   **组装**：通过对单元贡献求和来形成全局矩阵。边界自由度被消除。令 $M_{\\mathrm{int}}$ 和 $K_{\\mathrm{int}}$ 为单个内部自由度得到的全局标量。\n-   **目标**：计算比值 $R = \\frac{K_{\\mathrm{int}}}{M_{\\mathrm{int}}}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题是有限元方法（FEM）在经典椭圆偏微分方程上的标准应用。所有概念（泊松方程、$P_2$ 单元、重心坐标、单元矩阵）都是计算数学和工程学的基础。\n-   **适定性**：问题的阐述足够详细。几何形状、单元类型、基函数和组装过程都已明确定义，从而可以得到一个唯一、可计算的结果。\n-   **客观性**：问题以精确的数学语言陈述，没有主观性。\n\n问题是自洽的、科学上合理的且适定的。未发现任何缺陷。\n\n### 步骤 3：结论与行动\n问题是 **有效的**。将提供解答。\n\n### 解答推导\n\n该问题要求计算单个内部自由度的组装刚度与组装质量之比。此自由度对应于连接 $(0,0)$ 和 $(1,1)$ 的对角线边的中点。全局组装标量 $M_{\\mathrm{int}}$ 和 $K_{\\mathrm{int}}$ 是来自两个三角形 $T_1$ 和 $T_2$ 的贡献之和。\n\n设正方形的顶点为 $V_1=(0,0)$、$V_2=(1,0)$、$V_3=(1,1)$ 和 $V_4=(0,1)$。\n两个三角形分别是 $T_1$（顶点为 $V_1, V_2, V_3$）和 $T_2$（顶点为 $V_1, V_4, V_3$）。\n每个三角形的面积是 $|T_1| = |T_2| = \\frac{1}{2}$。内部边是 $T_1$ 和 $T_2$ 之间的公共边，连接 $V_1$ 和 $V_3$。与该边中点相关的基函数是施加齐次狄利克雷边界条件后唯一保留下来的基函数。我们称此基函数为 $\\varphi_{\\mathrm{int}}$。\n\n**对三角形 $T_1$ 的分析**\n设 $T_1$ 的局部顶点为 $v_1=(0,0)$、$v_2=(1,0)$ 和 $v_3=(1,1)$。内部边连接 $v_1$ 和 $v_3$。设相应的重心坐标为 $\\lambda_1, \\lambda_2, \\lambda_3$。$\\varphi_{\\mathrm{int}}$ 在 $T_1$ 上的限制，记作 $\\varphi_{\\mathrm{int}}^{(1)}$，是与边 $(v_1, v_3)$ 中点相关的基函数。根据问题定义，它为：\n$$\n\\varphi_{\\mathrm{int}}^{(1)} = 4 \\lambda_1 \\lambda_3\n$$\n该自由度的单元质量矩阵项是其平方的积分：\n$$\nM_{\\mathrm{int,int}}^{(T_1)} = \\int_{T_1} (\\varphi_{\\mathrm{int}}^{(1)})^2 \\, \\mathrm{d}\\Omega = \\int_{T_1} (4 \\lambda_1 \\lambda_3)^2 \\, \\mathrm{d}\\Omega = 16 \\int_{T_1} \\lambda_1^2 \\lambda_3^2 \\, \\mathrm{d}\\Omega\n$$\n被积函数 $\\lambda_1^2 \\lambda_3^2$ 是重心坐标下的一个4次多项式，因此在笛卡尔坐标下也是如此。指定的求积法则对此积分是精确的。我们使用重心坐标幂的精确积分公式：\n$$\n\\int_T \\lambda_1^a \\lambda_2^b \\lambda_3^c \\, \\mathrm{d}\\Omega = 2|T| \\frac{a!b!c!}{(a+b+c+2)!}\n$$\n对于我们的积分，$a=2$，$b=0$，$c=2$，且 $|T_1|=\\frac{1}{2}$。\n$$\n\\int_{T_1} \\lambda_1^2 \\lambda_3^2 \\, \\mathrm{d}\\Omega = 2\\left(\\frac{1}{2}\\right) \\frac{2!0!2!}{(2+0+2+2)!} = 1 \\cdot \\frac{2 \\cdot 1 \\cdot 2}{6!} = \\frac{4}{720} = \\frac{1}{180}\n$$\n因此，来自 $T_1$ 的单元质量贡献为：\n$$\nM_{\\mathrm{int,int}}^{(T_1)} = 16 \\cdot \\frac{1}{180} = \\frac{4}{45}\n$$\n对于刚度矩阵，我们需要 $\\varphi_{\\mathrm{int}}^{(1)}$ 的梯度。在顶点为 $(x_j, y_j)$ 的三角形上，重心坐标 $\\lambda_i$ 的梯度是一个常向量，由 $\\nabla \\lambda_i = \\frac{1}{2|T|} \\begin{pmatrix} y_{i+1} - y_{i+2} \\\\ x_{i+2} - x_{i+1} \\end{pmatrix}$ 给出（下标是循环的）。\n对于顶点为 $v_1(0,0), v_2(1,0), v_3(1,1)$ 且 $|T_1|=1/2$ 的 $T_1$：\n$$\n\\nabla \\lambda_1 = \\frac{1}{2(1/2)} \\begin{pmatrix} y_2 - y_3 \\\\ x_3 - x_2 \\end{pmatrix} = \\begin{pmatrix} 0-1 \\\\ 1-1 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\nabla \\lambda_3 = \\frac{1}{1} \\begin{pmatrix} y_1 - y_2 \\\\ x_2 - x_1 \\end{pmatrix} = \\begin{pmatrix} 0-0 \\\\ 1-0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n基函数的梯度为：\n$$\n\\nabla \\varphi_{\\mathrm{int}}^{(1)} = \\nabla(4 \\lambda_1 \\lambda_3) = 4(\\lambda_3 \\nabla \\lambda_1 + \\lambda_1 \\nabla \\lambda_3) = 4\\left(\\lambda_3 \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} + \\lambda_1 \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\\right) = 4 \\begin{pmatrix} -\\lambda_3 \\\\ \\lambda_1 \\end{pmatrix}\n$$\n刚度矩阵的被积函数是该梯度的范数平方：\n$$\n\\nabla \\varphi_{\\mathrm{int}}^{(1)} \\cdot \\nabla \\varphi_{\\mathrm{int}}^{(1)} = 16 \\left( (-\\lambda_3)^2 + (\\lambda_1)^2 \\right) = 16 (\\lambda_1^2 + \\lambda_3^2)\n$$\n单元刚度矩阵项是该量的积分。被积函数是一个2次多项式，因此指定的求积法则是精确的。\n$$\nK_{\\mathrm{int,int}}^{(T_1)} = \\int_{T_1} 16 (\\lambda_1^2 + \\lambda_3^2) \\, \\mathrm{d}\\Omega = 16 \\left( \\int_{T_1} \\lambda_1^2 \\, \\mathrm{d}\\Omega + \\int_{T_1} \\lambda_3^2 \\, \\mathrm{d}\\Omega \\right)\n$$\n使用积分公式，$a=2, b=0, c=0$：\n$$\n\\int_{T_1} \\lambda_1^2 \\, \\mathrm{d}\\Omega = 2\\left(\\frac{1}{2}\\right) \\frac{2!0!0!}{(2+0+0+2)!} = 1 \\cdot \\frac{2}{4!} = \\frac{2}{24} = \\frac{1}{12}\n$$\n根据对称性，$\\int_{T_1} \\lambda_3^2 \\, \\mathrm{d}\\Omega = \\frac{1}{12}$。\n因此，来自 $T_1$ 的单元刚度贡献为：\n$$\nK_{\\mathrm{int,int}}^{(T_1)} = 16 \\left( \\frac{1}{12} + \\frac{1}{12} \\right) = 16 \\left( \\frac{2}{12} \\right) = 16 \\left( \\frac{1}{6} \\right) = \\frac{8}{3}\n$$\n\n**对三角形 $T_2$ 的分析**\n三角形 $T_2$ 的顶点为 $V_1(0,0), V_4(0,1), V_3(1,1)$。它在几何上与 $T_1$ 全等（它是 $T_1$ 关于直线 $y=x$ 的反射）。根据对称性，对于类似的基函数，单元质量和刚度矩阵的结果必定相同。\n为完整起见，我们来验证一下。设 $T_2$ 的局部顶点为 $v_1'=(0,0)$、$v_2'=(0,1)$ 和 $v_3'=(1,1)$。内部边连接 $v_1'$ 和 $v_3'$。基函数为 $\\varphi_{\\mathrm{int}}^{(2)} = 4 \\lambda_1' \\lambda_3'$。面积为 $|T_2|=1/2$。质量积分形式相同，得出 $M_{\\mathrm{int,int}}^{(T_2)} = \\frac{4}{45}$。\n对于刚度，我们计算 $T_2$ 上重心坐标的梯度：\n$$\n\\nabla \\lambda_1' = \\frac{1}{2(1/2)} \\begin{pmatrix} y_2' - y_3' \\\\ x_3' - x_2' \\end{pmatrix} = \\begin{pmatrix} 1-1 \\\\ 1-0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n$$\n\\nabla \\lambda_3' = \\frac{1}{1} \\begin{pmatrix} y_1' - y_2' \\\\ x_2' - x_1' \\end{pmatrix} = \\begin{pmatrix} 0-1 \\\\ 0-0 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\nabla \\varphi_{\\mathrm{int}}^{(2)} = 4(\\lambda_3' \\nabla \\lambda_1' + \\lambda_1' \\nabla \\lambda_3') = 4\\left(\\lambda_3' \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} + \\lambda_1' \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}\\right) = 4 \\begin{pmatrix} -\\lambda_1' \\\\ \\lambda_3' \\end{pmatrix}\n$$\n被积函数为 $\\nabla \\varphi_{\\mathrm{int}}^{(2)} \\cdot \\nabla \\varphi_{\\mathrm{int}}^{(2)} = 16 ((-\\lambda_1')^2 + (\\lambda_3')^2) = 16 (\\lambda_1'^2 + \\lambda_3'^2)$。该积分与 $T_1$ 的积分相同，因此 $K_{\\mathrm{int,int}}^{(T_2)} = \\frac{8}{3}$。\n\n**组装与最终计算**\n全局质量和刚度是标量，通过对包含内部自由度的每个单元的贡献求和得到。\n$$\nM_{\\mathrm{int}} = M_{\\mathrm{int,int}}^{(T_1)} + M_{\\mathrm{int,int}}^{(T_2)} = \\frac{4}{45} + \\frac{4}{45} = \\frac{8}{45}\n$$\n$$\nK_{\\mathrm{int}} = K_{\\mathrm{int,int}}^{(T_1)} + K_{\\mathrm{int,int}}^{(T_2)} = \\frac{8}{3} + \\frac{8}{3} = \\frac{16}{3}\n$$\n问题要求验证组装后的矩阵是对称正定的。由于它们是 $1 \\times 1$ 矩阵（标量），对称性是平凡的。对于正定性，我们检查这些值是否为正。$M_{\\mathrm{int}} = 8/45 > 0$ 且 $K_{\\mathrm{int}} = 16/3 > 0$。两者均为正数，正如其定义为平方函数的积分所预期的那样。性质得到验证。\n\n最后，我们计算比值 $R$：\n$$\nR = \\frac{K_{\\mathrm{int}}}{M_{\\mathrm{int}}} = \\frac{16/3}{8/45} = \\frac{16}{3} \\times \\frac{45}{8}\n$$\n$$\nR = \\frac{16}{8} \\times \\frac{45}{3} = 2 \\times 15 = 30\n$$\n比值的最终值为 30。",
            "answer": "$$\n\\boxed{30}\n$$"
        },
        {
            "introduction": "均匀的网格划分通常不是最优选择，因为计算资源应当集中在解变化最剧烈的区域。自适应网格加密 (Adaptive Mesh Refinement, AMR) 是一种强大的技术，它利用数值解自身的信息来指导网格的优化。本练习  将引导你实践这一高级概念，你将学会计算基于残差的后验误差指示子，并使用标准的 Dörfler 标记策略来决定哪些单元需要被加密，从而形成求解与网格优化之间的闭环。",
            "id": "3744598",
            "problem": "考虑在区间 $[0,1]$ 上具有齐次狄利克雷边界条件的一维泊松问题，\n$$\n- u''(x) = f(x), \\quad x \\in (0,1), \\qquad u(0) = 0, \\quad u(1) = 0,\n$$\n其中 $f(x) = 1$。令 $V$ 表示索博列夫空间 $H_{0}^{1}(0,1)$，并令 $V_h \\subset V$ 为与网格 $\\mathcal{T}_h = \\{[0,0.5],[0.5,1]\\}$ 相关联的标准连续分片线性有限元空间。\n\n使用有限元方法 (FEM)，离散弱形式旨在寻求 $u_h \\in V_h$，使得对于所有 $v_h \\in V_h$，\n$$\n\\int_{0}^{1} u_h'(x) \\, v_h'(x) \\, dx \\;=\\; \\int_{0}^{1} f(x) \\, v_h(x) \\, dx.\n$$\n\n您的任务是：\n\n1. 通过确定其节点值，求解给定网格上的有限元解 $u_h$。\n\n2. 从上述弱形式出发，使用逐单元分部积分，并结合区间上的标准迹不等式和反不等式，为每个单元 $K \\in \\mathcal{T}_h$ 推导一个基于残差的后验误差指示子，该指示子是以下各项的和：\n   - 一个取决于限制在 $K$ 上的 $f$ 的内部残差项，以及\n   - 一个取决于内部节点 $x=0.5$ 处 $u_h'$ 跳跃的边项。\n   将您的表达式具体化到给定的网格和 $f(x)=1$ 上。\n\n3. 在 $\\mathcal{T}_h$ 的每个单元上数值计算您推导出的误差指示子。\n\n4. 应用参数 $\\theta = 0.6$ 的 Dörfler 体量追踪标记策略，其目标是选择一个最小子集 $\\mathcal{M} \\subset \\mathcal{T}_h$，使得 $\\mathcal{M}$ 上的指示子平方和至少是 $\\mathcal{T}_h$ 上指示子平方和的 $\\theta$ 倍。确定为满足 Dörfler 准则必须标记的最小单元数。请以单个整数形式提供最终答案，不带单位。\n\n本问题无需四舍五入。所有中间数学推导请使用 LaTeX 表示法。",
            "solution": "该问题被评估为有效，因为它具有科学依据、是适定的、客观的、自洽的且一致的。它代表了有限元方法和后验误差分析在一维泊松方程上的一个标准应用。\n\n给定的问题是：\n$$\n- u''(x) = f(x), \\quad x \\in (0,1)\n$$\n边界条件为 $u(0) = 0$ 和 $u(1) = 0$，源项为 $f(x)=1$。在有限元空间 $V_h \\subset H_0^1(0,1)$ 上的离散弱形式是找到 $u_h \\in V_h$，使得：\n$$\na(u_h, v_h) = L(v_h) \\quad \\forall v_h \\in V_h\n$$\n其中 $a(u,v) = \\int_{0}^{1} u'(x) v'(x) dx$ 且 $L(v) = \\int_{0}^{1} f(x) v(x) dx$。\n\n指定的有限元空间 $V_h$ 由网格 $\\mathcal{T}_h = \\{K_1, K_2\\}$ 上的连续分片线性函数组成，其中 $K_1 = [0, 0.5]$ 且 $K_2 = [0.5, 1]$。网格的节点为 $x_0=0$，$x_1=0.5$ 和 $x_2=1$。\n\n### 任务1：求解有限元解 $u_h$\n\n有限元解 $u_h(x)$ 是基函数的线性组合，$u_h(x) = \\sum_{j=0}^{2} U_j \\phi_j(x)$，其中 $\\phi_j(x)$ 是满足 $\\phi_j(x_i) = \\delta_{ij}$ 的标准线性“帽子”函数。系数 $U_j = u_h(x_j)$ 是节点值。\n齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$ 被施加于 $u_h$，因此 $U_0 = 0$ 且 $U_2 = 0$。唯一未知的节点值是 $U_1 = u_h(0.5)$。\n解为 $u_h(x) = U_1 \\phi_1(x)$。\n测试函数空间 $V_h$ 由在边界处为零的函数张成，所以我们只需要用 $v_h = \\phi_1(x)$ 来测试。弱形式变成一个单一的线性方程：\n$$\na(U_1 \\phi_1, \\phi_1) = L(\\phi_1) \\implies U_1 \\int_{0}^{1} (\\phi_1'(x))^2 dx = \\int_{0}^{1} f(x) \\phi_1(x) dx\n$$\n基函数 $\\phi_1(x)$ 及其导数 $\\phi_1'(x)$ 为：\n$$\n\\phi_1(x) = \\begin{cases} \\frac{x - 0}{0.5 - 0} = 2x & x \\in [0, 0.5] \\\\ \\frac{1 - x}{1 - 0.5} = 2(1-x) & x \\in [0.5, 1] \\end{cases}\n\\qquad\n\\phi_1'(x) = \\begin{cases} 2 & x \\in (0, 0.5) \\\\ -2 & x \\in (0.5, 1) \\end{cases}\n$$\n刚度项为：\n$$\n\\int_{0}^{1} (\\phi_1'(x))^2 dx = \\int_{0}^{0.5} (2)^2 dx + \\int_{0.5}^{1} (-2)^2 dx = \\int_0^1 4 dx = 4\n$$\n当 $f(x)=1$ 时的载荷项为：\n$$\n\\int_{0}^{1} f(x) \\phi_1(x) dx = \\int_{0}^{1} \\phi_1(x) dx = \\int_{0}^{0.5} 2x dx + \\int_{0.5}^{1} 2(1-x) dx = \\left[x^2\\right]_0^{0.5} + \\left[2x - x^2\\right]_{0.5}^{1}\n$$\n$$\n= (0.5^2 - 0) + ((2-1) - (2(0.5) - 0.5^2)) = 0.25 + (1 - (1 - 0.25)) = 0.25 + 0.25 = 0.5 = \\frac{1}{2}\n$$\n求解 $U_1$：\n$$\n4 U_1 = \\frac{1}{2} \\implies U_1 = \\frac{1}{8}\n$$\n节点值为 $u_h(0.5) = 1/8$。有限元解为：\n$$\nu_h(x) = \\begin{cases} \\frac{1}{8}(2x) = \\frac{x}{4} & x \\in [0, 0.5] \\\\ \\frac{1}{8}(2(1-x)) = \\frac{1-x}{4} & x \\in [0.5, 1] \\end{cases}\n$$\n\n### 任务2：推导基于残差的后验误差指示子\n\n令 $e(x) = u(x) - u_h(x)$ 为误差。对于任意测试函数 $v \\in H_0^1(0,1)$，误差满足伽辽金正交性：$a(e, v_h) = 0$ 对所有 $v_h \\in V_h$ 成立。误差方程可以通过将连续弱形式减去离散弱形式得到：\n$$\na(e, v) = \\int_0^1 e'(x)v'(x)dx = \\int_0^1 f(x)v(x)dx - \\int_0^1 u_h'(x)v'(x)dx\n$$\n我们对右边的第二项进行逐单元分部积分：\n$$\n\\int_0^1 e'v'dx = \\sum_{K \\in \\mathcal{T}_h} \\left( \\int_K fv dx - \\left( \\left[ u_h'v \\right]_{\\partial K} - \\int_K u_h'' v dx \\right) \\right)\n$$\n$$\n\\int_0^1 e'v'dx = \\sum_{K \\in \\mathcal{T}_h} \\int_K (f + u_h'')v dx - \\sum_{K \\in \\mathcal{T}_h} \\left[ u_h'v \\right]_{\\partial K}\n$$\n项 $R_K = f + u_h''$ 是单元内部残差。边界和可以重组为对边（在一维中是节点）的求和。由于 $v(0)=v(1)=0$，在区域边界上的项消失。对于由单元 $K_L$ 和 $K_R$ 共享的内部节点 $z$，其贡献为 $u_h'|_{K_R}(z)v(z) - u_h'|_{K_L}(z)v(z) = [u_h']_z v(z)$，这里使用了跳跃定义 $[w]_z = w(z^+) - w(z^-)$。通常，误差方程中的跳跃项表现为对内部面的求和，并带有一个符号变化。\n$$\n\\int_0^1 e'v'dx = \\sum_{K \\in \\mathcal{T}_h} \\int_K R_K v dx + \\sum_{\\text{interior nodes } z} J_z v(z)\n$$\n其中 $J_z = u_h'(z^-) - u_h'(z^+)$ 是通量的跳跃。\n标准的后验误差分析表明，误差的能量范数由一个由这些残差组成的量从上下界定。单元 $K$ 上的误差指示子平方是对应于内部残差和其各边上的通量跳跃的项之和。对于一维泊松问题，标准定义是：\n$$\n\\eta_K^2 = C_1 h_K^2 \\|f + u_h''\\|_{L^2(K)}^2 + C_2 \\sum_{z \\in \\partial K, z \\text{ interior}} \\frac{1}{2} |[u_h']_z|^2\n$$\n常数 $C_1, C_2$ 取决于插值算子和稳定性估计，但通常取为 1。因子 $1/2$ 将一个面上的跳跃残差分配给共享该面的两个单元。因此，推导出的指示子公式为：\n$$\n\\eta_K^2 = h_K^2 \\int_K(f(x) + u_h''(x))^2 dx + \\frac{1}{2} \\sum_{z \\in \\partial K, z \\in (0,1)} ([u_h']_z)^2\n$$\n该指示子 $\\eta_K$ 由一个内部残差项和一个边跳跃项组成，符合要求。\n\n### 任务3：计算误差指示子\n\n我们将推导出的公式应用于我们的具体问题。\n网格为 $\\mathcal{T}_h = \\{K_1, K_2\\}$，其中 $K_1=[0, 0.5]$ 且 $K_2=[0.5, 1]$。单元尺寸为 $h_{K_1}=0.5$ 和 $h_{K_2}=0.5$。\n源项为 $f(x)=1$。\n根据任务1，有限元解在每个单元内部的二阶导数为 $u_h''(x) = 0$。\n对于 $K_1$ 和 $K_2$ 两者，内部残差均为 $R_K = f+u_h'' = 1+0=1$。\n唯一的内部节点位于 $z=0.5$。导数分别为 $u_h'|_{K_1} = 1/4$ 和 $u_h'|_{K_2} = -1/4$。\n在 $z=0.5$ 处导数的跳跃为 $[u_h']_{0.5} = u_h'(0.5^+) - u_h'(0.5^-) = (-1/4) - (1/4) = -1/2$。\n\n对于单元 $K_1=[0, 0.5]$：\n内部边界位于 $z=0.5$。\n$$\n\\eta_{K_1}^2 = h_{K_1}^2 \\int_0^{0.5} (1)^2 dx + \\frac{1}{2} \\left( [u_h']_{0.5} \\right)^2\n$$\n$$\n\\eta_{K_1}^2 = (0.5)^2 \\cdot (0.5) + \\frac{1}{2} \\left(-\\frac{1}{2}\\right)^2 = \\left(\\frac{1}{4}\\right)\\left(\\frac{1}{2}\\right) + \\frac{1}{2}\\left(\\frac{1}{4}\\right) = \\frac{1}{8} + \\frac{1}{8} = \\frac{2}{8} = \\frac{1}{4}\n$$\n所以，指示子为 $\\eta_{K_1} = \\sqrt{1/4} = 1/2$。\n\n对于单元 $K_2=[0.5, 1]$：\n内部边界位于 $z=0.5$。\n$$\n\\eta_{K_2}^2 = h_{K_2}^2 \\int_{0.5}^1 (1)^2 dx + \\frac{1}{2} \\left( [u_h']_{0.5} \\right)^2\n$$\n$$\n\\eta_{K_2}^2 = (0.5)^2 \\cdot (0.5) + \\frac{1}{2} \\left(-\\frac{1}{2}\\right)^2 = \\left(\\frac{1}{4}\\right)\\left(\\frac{1}{2}\\right) + \\frac{1}{2}\\left(\\frac{1}{4}\\right) = \\frac{1}{8} + \\frac{1}{8} = \\frac{2}{8} = \\frac{1}{4}\n$$\n所以，指示子为 $\\eta_{K_2} = \\sqrt{1/4} = 1/2$。\n指示子平方的数值为 $\\eta_{K_1}^2 = 1/4$ 和 $\\eta_{K_2}^2 = 1/4$。\n\n### 任务4：应用 Dörfler 标记策略\n\n参数为 $\\theta$ 的 Dörfler 标记策略要求找到一个最小的标记单元集 $\\mathcal{M} \\subset \\mathcal{T}_h$，使得：\n$$\n\\sum_{K \\in \\mathcal{M}} \\eta_K^2 \\ge \\theta \\sum_{K \\in \\mathcal{T}_h} \\eta_K^2\n$$\n给定 $\\theta = 0.6$。\n首先，计算指示子平方的总和：\n$$\n\\sum_{K \\in \\mathcal{T}_h} \\eta_K^2 = \\eta_{K_1}^2 + \\eta_{K_2}^2 = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}\n$$\n标记集 $\\mathcal{M}$ 上和的目标阈值为：\n$$\n\\theta \\sum_{K \\in \\mathcal{T}_h} \\eta_K^2 = 0.6 \\times \\frac{1}{2} = 0.3\n$$\n策略是按指示子值的降序对单元进行排序，并将它们添加到 $\\mathcal{M}$ 中，直到满足阈值为止。\n指示子为 $\\eta_{K_1}^2 = 0.25$ 和 $\\eta_{K_2}^2 = 0.25$。它们相等。\n1. 标记具有最大指示子的单元。我们可以选择 $K_1$。\n   $\\mathcal{M} = \\{K_1\\}$。$\\mathcal{M}$ 上的和为 $\\eta_{K_1}^2 = 0.25$。\n   检查条件：$0.25 \\ge 0.3$ 为假。\n\n2. 标记具有次大指示子的单元，即 $K_2$。\n   $\\mathcal{M} = \\{K_1, K_2\\}$。$\\mathcal{M}$ 上的和为 $\\eta_{K_1}^2 + \\eta_{K_2}^2 = 0.25 + 0.25 = 0.5$。\n   检查条件：$0.5 \\ge 0.3$ 为真。\n\n条件满足。所需的最小单元集是 $\\mathcal{M} = \\{K_1, K_2\\}$。此集合中的单元数量为 2。\n因此，必须标记的最小单元数是 2。",
            "answer": "$$\\boxed{2}$$"
        }
    ]
}