{
    "hands_on_practices": [
        {
            "introduction": "在有限元分析中，自由度 (Degrees of Freedom, DoFs) 的正确识别是构建离散系统的第一步。本练习旨在通过一个极简的计算域，帮助您巩固对自由度、边界条件以及不同类型单元（$P_1$ 三角形与 $Q_1$ 四边形）之间关系的理解。通过直接从定义出发计算有效自由度的数量，您可以清晰地看到边界条件是如何约束模型并最终决定求解问题规模的。",
            "id": "3744622",
            "problem": "设计算域为单位正方形 $\\Omega = [0,1] \\times [0,1]$。考虑一个在 Sobolev 空间 $H^{1}(\\Omega)$ 中提出的标量边值问题，其在边界 $\\partial \\Omega$ 上具有齐次 Dirichlet 边界条件 $u=0$。您将使用有限元方法 (FEM) 对 $\\Omega$ 进行离散化，在两种网格上使用协调的 Lagrange 空间：一种是带有分片线性形函数（记为 $P_{1}$）的三角形网格，另一种是带有分片双线性形函数（记为 $Q_{1}$）的四边形网格。\n\n定义以下两种协调网格：\n\n- 三角形网格 $\\mathcal{T}_{h}^{\\triangle}$：单位正方形通过从 $(0,0)$ 到 $(1,1)$ 的一条对角线段被分割成两个三角形。\n- 四边形网格 $\\mathcal{T}_{h}^{\\square}$：单位正方形被视为一个单独的四边形单元。\n\n对于每种网格，考虑与单元类型相适应的协调节点 Lagrange 有限元空间 $V_{h} \\subset H^{1}(\\Omega)$：对于 $P_{1}$，是在 $\\mathcal{T}_{h}^{\\triangle}$ 上的连续分片线性函数；对于 $Q_{1}$，是在 $\\mathcal{T}_{h}^{\\square}$ 上的连续分片双线性函数。通过施加本质边界条件（essential boundary condition）的标准方法，即约束 $\\partial \\Omega$ 上的节点值，来强制施加齐次 Dirichlet 边界条件 $u=0$。\n\n从协调有限元空间的核心定义和本质（Dirichlet）边界条件的施加出发，确定每种离散化方案中无约束代数自由度（施加边界条件后离散试探空间的维度）的数量。然后计算差值\n$$\n\\Delta \\;=\\; N_{\\text{free}}^{P_{1}} \\;-\\; N_{\\text{free}}^{Q_{1}} \\, ,\n$$\n其中 $N_{\\text{free}}^{P_{1}}$ 和 $N_{\\text{free}}^{Q_{1}}$ 分别表示在上述网格上，$P_{1}$ 和 $Q_{1}$ 离散化方案的无约束自由度数量。\n\n给出 $\\Delta$ 的数值。无需四舍五入。请将最终答案表示为一个不带单位的纯数字。",
            "solution": "此问题是有效的，因为它具有科学依据、自成体系且客观，是有限元方法（FEM）中的一个标准练习。\n\n这个问题的核心是在施加齐次 Dirichlet 边界条件后，确定有限元问题的离散试探空间的维度。在协调节点 Lagrange 有限元的背景下，自由度（DoF）是解在一组称为节点的离散点上的值。总自由度数是网格中唯一节点的总数。\n\n问题指定了在域 $\\Omega = [0,1] \\times [0,1]$ 的整个边界 $\\partial \\Omega$ 上施加齐次 Dirichlet 边界条件 $u=0$。当使用施加本质边界条件的标准方法时，任何位于指定了 Dirichlet 条件的边界部分上的节点，其对应的自由度都会受到约束。在本例中，由于该条件适用于整个边界 $\\partial \\Omega$，因此所有位于 $\\partial \\Omega$ 上的节点都受到约束。它们的值被固定为 $0$。\n\n因此，无约束或“自由”代数自由度的数量 $N_{\\text{free}}$ 等于位于域内部 $\\Omega^{\\circ} = (0,1) \\times (0,1)$ 的节点数量。我们现在将为两种指定的离散化方案分别确定这个数量。\n\n首先，我们分析 $P_{1}$ 三角形网格离散化。\n该有限元空间由连续分片线性函数组成。对于一个 $P_{1}$ 三角形单元，节点位于三角形的三个顶点上。该网格记为 $\\mathcal{T}_{h}^{\\triangle}$，通过从顶点 $(0,0)$ 到顶点 $(1,1)$ 的对角线将单位正方形分割成两个三角形。这两个三角形单元分别是顶点为 $\\{(0,0), (1,0), (1,1)\\}$ 的 $T_{1}$ 和顶点为 $\\{(0,0), (0,1), (1,1)\\}$ 的 $T_{2}$。\n此网格所有唯一节点的集合是这两个三角形顶点集的并集：\n$$\n\\mathcal{N}^{P_{1}} = \\{(0,0), (1,0), (1,1)\\} \\cup \\{(0,0), (0,1), (1,1)\\} = \\{(0,0), (1,0), (0,1), (1,1)\\}\n$$\n为了求得 $N_{\\text{free}}^{P_{1}}$，我们必须计算这些节点中有多少位于 $\\Omega$ 的内部，即开集 $(0,1) \\times (0,1)$ 中。\n- 节点 $(0,0)$ 位于边界 $\\partial\\Omega$ 上。\n- 节点 $(1,0)$ 位于边界 $\\partial\\Omega$ 上。\n- 节点 $(0,1)$ 位于边界 $\\partial\\Omega$ 上。\n- 节点 $(1,1)$ 位于边界 $\\partial\\Omega$ 上。\n所有四个节点都位于域的边界上。没有内部节点。因此，无约束自由度的数量为 $N_{\\text{free}}^{P_{1}} = 0$。\n\n其次，我们分析 $Q_{1}$ 四边形网格离散化。\n该有限元空间由连续分片双线性函数组成。对于一个 $Q_{1}$ 四边形单元，节点位于四边形的四个顶点上。该网格记为 $\\mathcal{T}_{h}^{\\square}$，由一个单一单元组成，即单位正方形 $\\Omega$ 本身。\n这个单单元网格的节点集就是其顶点的集合：\n$$\n\\mathcal{N}^{Q_{1}} = \\{(0,0), (1,0), (0,1), (1,1)\\}\n$$\n这与 $P_{1}$ 情况下的节点集相同。如前所述，这四个节点都位于边界 $\\partial\\Omega$ 上。它们中没有一个位于内部 $(0,1) \\times (0,1)$。\n因此，这种离散化方案也没有内部节点。无约束自由度的数量为 $N_{\\text{free}}^{Q_{1}} = 0$。\n\n最后，我们计算所要求的差值 $\\Delta$。\n$$\n\\Delta = N_{\\text{free}}^{P_{1}} - N_{\\text{free}}^{Q_{1}}\n$$\n代入我们确定的值：\n$$\n\\Delta = 0 - 0 = 0\n$$\n对于这两种极其粗糙的离散化方案，满足齐次边界条件的试探函数空间仅包含平凡的零函数，这意味着两种情况下无约束自由度空间的维度均为零。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "为了拟合复杂几何形状，工程实践中广泛使用等参元。然而，将简单的参考单元映射到物理空间中的弯曲单元时，必须保证映射的有效性，即单元内部没有发生“翻转”或“折叠”。本练习将带您亲手计算一个二次等参三角形单元的关键质量指标——雅可比行列式 $J$。通过在单元内部特定点计算 $J$ 的值，您将学会如何判断一个单元的几何有效性，这是保证数值计算稳定性和物理真实性的前提。",
            "id": "3744605",
            "problem": "一个等参六节点二次三角形用于将参数平面中坐标为 $(\\xi,\\eta)$ 的参考三角形（其中 $0 \\le \\xi$，$0 \\le \\eta$ 且 $\\xi + \\eta \\le 1$）映射到物理平面中坐标为 $(x,y)$ 的曲边三角形。该等参映射使用三角形上的标准二次拉格朗日形函数。令 $L_{1} = 1 - \\xi - \\eta$，$L_{2} = \\xi$ 且 $L_{3} = \\eta$。六个二次形函数定义如下\n$$\nN_{1} = L_{1}(2L_{1} - 1),\\quad\nN_{2} = L_{2}(2L_{2} - 1),\\quad\nN_{3} = L_{3}(2L_{3} - 1),\\quad\nN_{4} = 4L_{1}L_{2},\\quad\nN_{5} = 4L_{2}L_{3},\\quad\nN_{6} = 4L_{3}L_{1}.\n$$\n物理坐标 $(x(\\xi,\\eta),y(\\xi,\\eta))$ 由等参插值给出\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{6} N_{i}(\\xi,\\eta)\\,x_{i},\\qquad\ny(\\xi,\\eta) = \\sum_{i=1}^{6} N_{i}(\\xi,\\eta)\\,y_{i},\n$$\n节点坐标为\n$$\n(x_{1},y_{1}) = (0,0),\\quad (x_{2},y_{2}) = (0,2),\\quad (x_{3},y_{3}) = (2,0),\\\\\n(x_{4},y_{4}) = (-0.1,1.1),\\quad (x_{5},y_{5}) = (1.2,1.1),\\quad (x_{6},y_{6}) = (0.9,-0.2).\n$$\n离散雅可比行列式为 $J(\\xi,\\eta) = \\det\\!\\left(\\partial(x,y)/\\partial(\\xi,\\eta)\\right)$，其中\n$$\n\\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} =\n\\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix}.\n$$\n使用对三角形上最高2次多项式精确的三点对称高斯求积法则，在三个高斯点 $(\\xi,\\eta) = (1/6,1/6)$, $(2/3,1/6)$ 和 $(1/6,2/3)$ 处计算 $J(\\xi,\\eta)$。然后，根据这些值的符号，判断单元在这些求積點附近是否表现出任何局部反转。\n\n最终答案仅报告这三个高斯点上 $J$ 的最小值。将答案表示为一个纯数（无量纲），并四舍五入到四位有效数字。",
            "solution": "用户希望我按照给定的说明解决问题。\n\n### 步骤1：提取已知条件\n- **单元类型**：等参六节点二次三角形。\n- **参数坐标**：$(\\xi, \\eta)$，在由 $0 \\le \\xi$，$0 \\le \\eta$ 和 $\\xi + \\eta \\le 1$ 定义的参考三角形内。\n- **面积坐标**：$L_{1} = 1 - \\xi - \\eta$, $L_{2} = \\xi$, $L_{3} = \\eta$。\n- **形函数**：\n  $N_{1} = L_{1}(2L_{1} - 1)$\n  $N_{2} = L_{2}(2L_{2} - 1)$\n  $N_{3} = L_{3}(2L_{3} - 1)$\n  $N_{4} = 4L_{1}L_{2}$\n  $N_{5} = 4L_{2}L_{3}$\n  $N_{6} = 4L_{3}L_{1}$\n- **等参映射**：\n  $x(\\xi,\\eta) = \\sum_{i=1}^{6} N_{i}(\\xi,\\eta)x_{i}$\n  $y(\\xi,\\eta) = \\sum_{i=1}^{6} N_{i}(\\xi,\\eta)y_{i}$\n- **节点坐标**：\n  $(x_{1},y_{1}) = (0,0)$\n  $(x_{2},y_{2}) = (0,2)$\n  $(x_{3},y_{3}) = (2,0)$\n  $(x_{4},y_{4}) = (-0.1,1.1)$\n  $(x_{5},y_{5}) = (1.2,1.1)$\n  $(x_{6},y_{6}) = (0.9,-0.2)$\n- **雅可比矩阵**：$\\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}$\n- **雅可比行列式**：$J(\\xi,\\eta) = \\det(\\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)})$\n- **计算点**：$(\\xi,\\eta) = (1/6,1/6)$, $(2/3,1/6)$ 和 $(1/6,2/3)$。\n- **任务**：在三个给定点处计算 $J(\\xi,\\eta)$ 的值，评论其符号，并报告四舍五入到四位有效数字的 $J$ 的最小值。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，植根于有限元法的标准理论。问题是适定的，因为计算所需量所需的所有必要数据和定义均已提供。语言客观而精确。节点坐标虽然定义了一个扭曲的单元，但在数学上与问题的公式一致。没有矛盾、缺失信息或不切实际的物理假设。该问题是等参映射原理的一个直接应用，尽管计算量较大。\n\n### 步骤3：结论与行动\n问题有效。将提供完整解答。\n\n该问题要求在参数域的三个特定点上计算雅可比行列式 $J(\\xi,\\eta) = \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial x}{\\partial \\eta}\\frac{\\partial y}{\\partial \\xi}$。雅可比矩阵的分量通过对等参映射方程求导得到：\n$$ \\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi} x_i, \\quad \\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta} x_i $$\n$$ \\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\xi} y_i, \\quad \\frac{\\partial y}{\\partial \\eta} = \\sum_{i=1}^{6} \\frac{\\partial N_i}{\\partial \\eta} y_i $$\n首先，我们求形函数 $N_i$ 相对于参数坐标 $(\\xi, \\eta)$ 的导数。最方便的方法是使用链式法则和面积坐标 $L_1, L_2, L_3$。面积坐标的导数是：\n$$ \\frac{\\partial L_1}{\\partial \\xi} = -1, \\quad \\frac{\\partial L_1}{\\partial \\eta} = -1 $$\n$$ \\frac{\\partial L_2}{\\partial \\xi} = 1, \\quad \\frac{\\partial L_2}{\\partial \\eta} = 0 $$\n$$ \\frac{\\partial L_3}{\\partial \\xi} = 0, \\quad \\frac{\\partial L_3}{\\partial \\eta} = 1 $$\n形函数 $N_i(L_1, L_2, L_3)$ 的导数是：\n$$\n\\begin{aligned}\n\\frac{\\partial N_1}{\\partial \\xi} = (4L_1-1)\\frac{\\partial L_1}{\\partial \\xi} = 1-4L_1, & \\quad \\frac{\\partial N_1}{\\partial \\eta} = (4L_1-1)\\frac{\\partial L_1}{\\partial \\eta} = 1-4L_1 \\\\\n\\frac{\\partial N_2}{\\partial \\xi} = (4L_2-1)\\frac{\\partial L_2}{\\partial \\xi} = 4L_2-1, & \\quad \\frac{\\partial N_2}{\\partial \\eta} = (4L_2-1)\\frac{\\partial L_2}{\\partial \\eta} = 0 \\\\\n\\frac{\\partial N_3}{\\partial \\xi} = (4L_3-1)\\frac{\\partial L_3}{\\partial \\xi} = 0, & \\quad \\frac{\\partial N_3}{\\partial \\eta} = (4L_3-1)\\frac{\\partial L_3}{\\partial \\eta} = 4L_3-1 \\\\\n\\frac{\\partial N_4}{\\partial \\xi} = 4\\left(L_1\\frac{\\partial L_2}{\\partial \\xi} + L_2\\frac{\\partial L_1}{\\partial \\xi}\\right) = 4(L_1-L_2), & \\quad \\frac{\\partial N_4}{\\partial \\eta} = 4\\left(L_1\\frac{\\partial L_2}{\\partial \\eta} + L_2\\frac{\\partial L_1}{\\partial \\eta}\\right) = -4L_2 \\\\\n\\frac{\\partial N_5}{\\partial \\xi} = 4\\left(L_2\\frac{\\partial L_3}{\\partial \\xi} + L_3\\frac{\\partial L_2}{\\partial \\xi}\\right) = 4L_3, & \\quad \\frac{\\partial N_5}{\\partial \\eta} = 4\\left(L_2\\frac{\\partial L_3}{\\partial \\eta} + L_3\\frac{\\partial L_2}{\\partial \\eta}\\right) = 4L_2 \\\\\n\\frac{\\partial N_6}{\\partial \\xi} = 4\\left(L_3\\frac{\\partial L_1}{\\partial \\xi} + L_1\\frac{\\partial L_3}{\\partial \\xi}\\right) = -4L_3, & \\quad \\frac{\\partial N_6}{\\partial \\eta} = 4\\left(L_3\\frac{\\partial L_1}{\\partial \\eta} + L_1\\frac{\\partial L_3}{\\partial \\eta}\\right) = 4(L_1-L_3)\n\\end{aligned}\n$$\n\n我们现在在三个指定的高斯点上计算雅可比行列式。\n\n**1. 在点 1: $(\\xi, \\eta) = (1/6, 1/6)$ 处计算**\n面积坐标为 $L_1 = 1 - 1/6 - 1/6 = 4/6 = 2/3$, $L_2 = 1/6$, $L_3 = 1/6$。\n在此点，形函数的导数为：\n$\\frac{\\partial N_1}{\\partial\\xi} = 1 - 4(2/3) = -5/3$, $\\frac{\\partial N_1}{\\partial\\eta} = -5/3$\n$\\frac{\\partial N_2}{\\partial\\xi} = 4(1/6) - 1 = -1/3$, $\\frac{\\partial N_2}{\\partial\\eta} = 0$\n$\\frac{\\partial N_3}{\\partial\\xi} = 0$, $\\frac{\\partial N_3}{\\partial\\eta} = 4(1/6) - 1 = -1/3$\n$\\frac{\\partial N_4}{\\partial\\xi} = 4(2/3 - 1/6) = 2$, $\\frac{\\partial N_4}{\\partial\\eta} = -4(1/6) = -2/3$\n$\\frac{\\partial N_5}{\\partial\\xi} = 4(1/6) = 2/3$, $\\frac{\\partial N_5}{\\partial\\eta} = 4(1/6) = 2/3$\n$\\frac{\\partial N_6}{\\partial\\xi} = -4(1/6) = -2/3$, $\\frac{\\partial N_6}{\\partial\\eta} = 4(2/3 - 1/6) = 2$\n\n使用节点坐标 $(x_i) = (0, 0, 2, -0.1, 1.2, 0.9)$ 和 $(y_i) = (0, 2, 0, 1.1, 1.1, -0.2)$：\n$\\frac{\\partial x}{\\partial \\xi} = (-\\frac{5}{3})\\cdot 0 + (-\\frac{1}{3})\\cdot 0 + 0\\cdot 2 + 2\\cdot(-0.1) + (\\frac{2}{3})\\cdot 1.2 + (-\\frac{2}{3})\\cdot 0.9 = -0.2 + 0.8 - 0.6 = 0$\n$\\frac{\\partial x}{\\partial \\eta} = (-\\frac{5}{3})\\cdot 0 + 0\\cdot 0 + (-\\frac{1}{3})\\cdot 2 + (-\\frac{2}{3})\\cdot(-0.1) + \\frac{2}{3}\\cdot 1.2 + 2\\cdot 0.9 = -2/3 + 0.2/3 + 2.4/3 + 1.8 = 0.6/3 + 1.8 = 2$\n$\\frac{\\partial y}{\\partial \\xi} = (-\\frac{5}{3})\\cdot 0 + (-\\frac{1}{3})\\cdot 2 + 0\\cdot 0 + 2\\cdot 1.1 + (\\frac{2}{3})\\cdot 1.1 + (-\\frac{2}{3})\\cdot(-0.2) = -2/3 + 2.2 + 2.2/3 + 0.4/3 = 2.4$\n$\\frac{\\partial y}{\\partial \\eta} = (-\\frac{5}{3})\\cdot 0 + 0\\cdot 2 + (-\\frac{1}{3})\\cdot 0 + (-\\frac{2}{3})\\cdot 1.1 + (\\frac{2}{3})\\cdot 1.1 + 2\\cdot(-0.2) = -0.4$\n雅可比行列式为 $J(1/6, 1/6) = (0)(-0.4) - (2)(2.4) = -4.8$。\n\n**2. 在点 2: $(\\xi, \\eta) = (2/3, 1/6)$ 处计算**\n面积坐标为 $L_1 = 1 - 2/3 - 1/6 = 1/6$, $L_2 = 2/3$, $L_3 = 1/6$。\n在此点，形函数的导数为：\n$\\frac{\\partial N_1}{\\partial\\xi} = 1 - 4(1/6) = 1/3$, $\\frac{\\partial N_1}{\\partial\\eta} = 1/3$\n$\\frac{\\partial N_2}{\\partial\\xi} = 4(2/3) - 1 = 5/3$, $\\frac{\\partial N_2}{\\partial\\eta} = 0$\n$\\frac{\\partial N_3}{\\partial\\xi} = 0$, $\\frac{\\partial N_3}{\\partial\\eta} = 4(1/6) - 1 = -1/3$\n$\\frac{\\partial N_4}{\\partial\\xi} = 4(1/6 - 2/3) = -2$, $\\frac{\\partial N_4}{\\partial\\eta} = -4(2/3) = -8/3$\n$\\frac{\\partial N_5}{\\partial\\xi} = 4(1/6) = 2/3$, $\\frac{\\partial N_5}{\\partial\\eta} = 4(2/3) = 8/3$\n$\\frac{\\partial N_6}{\\partial\\xi} = -4(1/6) = -2/3$, $\\frac{\\partial N_6}{\\partial\\eta} = 4(1/6 - 1/6) = 0$\n\n$\\frac{\\partial x}{\\partial \\xi} = (\\frac{1}{3})\\cdot 0 + (\\frac{5}{3})\\cdot 0 + 0\\cdot 2 + (-2)\\cdot(-0.1) + (\\frac{2}{3})\\cdot 1.2 + (-\\frac{2}{3})\\cdot 0.9 = 0.2 + 0.8 - 0.6 = 0.4$\n$\\frac{\\partial x}{\\partial \\eta} = (\\frac{1}{3})\\cdot 0 + 0\\cdot 0 + (-\\frac{1}{3})\\cdot 2 + (-\\frac{8}{3})\\cdot(-0.1) + (\\frac{8}{3})\\cdot 1.2 + 0\\cdot 0.9 = -2/3 + 0.8/3 + 9.6/3 = 8.4/3 = 2.8$\n$\\frac{\\partial y}{\\partial \\xi} = (\\frac{1}{3})\\cdot 0 + (\\frac{5}{3})\\cdot 2 + 0\\cdot 0 + (-2)\\cdot 1.1 + (\\frac{2}{3})\\cdot 1.1 + (-\\frac{2}{3})\\cdot(-0.2) = 10/3 - 2.2 + 2.2/3 + 0.4/3 = 2$\n$\\frac{\\partial y}{\\partial \\eta} = (\\frac{1}{3})\\cdot 0 + 0\\cdot 2 + (-\\frac{1}{3})\\cdot 0 + (-\\frac{8}{3})\\cdot 1.1 + (\\frac{8}{3})\\cdot 1.1 + 0\\cdot(-0.2) = 0$\n雅可比行列式为 $J(2/3, 1/6) = (0.4)(0) - (2.8)(2) = -5.6$。\n\n**3. 在点 3: $(\\xi, \\eta) = (1/6, 2/3)$ 处计算**\n面积坐标为 $L_1 = 1 - 1/6 - 2/3 = 1/6$, $L_2 = 1/6$, $L_3 = 2/3$。\n在此点，形函数的导数为：\n$\\frac{\\partial N_1}{\\partial\\xi} = 1 - 4(1/6) = 1/3$, $\\frac{\\partial N_1}{\\partial\\eta} = 1/3$\n$\\frac{\\partial N_2}{\\partial\\xi} = 4(1/6) - 1 = -1/3$, $\\frac{\\partial N_2}{\\partial\\eta} = 0$\n$\\frac{\\partial N_3}{\\partial\\xi} = 0$, $\\frac{\\partial N_3}{\\partial\\eta} = 4(2/3) - 1 = 5/3$\n$\\frac{\\partial N_4}{\\partial\\xi} = 4(1/6 - 1/6) = 0$, $\\frac{\\partial N_4}{\\partial\\eta} = -4(1/6) = -2/3$\n$\\frac{\\partial N_5}{\\partial\\xi} = 4(2/3) = 8/3$, $\\frac{\\partial N_5}{\\partial\\eta} = 4(1/6) = 2/3$\n$\\frac{\\partial N_6}{\\partial\\xi} = -4(2/3) = -8/3$, $\\frac{\\partial N_6}{\\partial\\eta} = 4(1/6 - 2/3) = -2$\n\n$\\frac{\\partial x}{\\partial \\xi} = (\\frac{1}{3})\\cdot 0 + (-\\frac{1}{3})\\cdot 0 + 0\\cdot 2 + 0\\cdot(-0.1) + (\\frac{8}{3})\\cdot 1.2 + (-\\frac{8}{3})\\cdot 0.9 = 9.6/3 - 7.2/3 = 2.4/3 = 0.8$\n$\\frac{\\partial x}{\\partial \\eta} = (\\frac{1}{3})\\cdot 0 + 0\\cdot 0 + (\\frac{5}{3})\\cdot 2 + (-\\frac{2}{3})\\cdot(-0.1) + (\\frac{2}{3})\\cdot 1.2 + (-2)\\cdot 0.9 = 10/3 + 0.2/3 + 2.4/3 - 1.8 = 12.6/3 - 1.8 = 4.2 - 1.8 = 2.4$\n$\\frac{\\partial y}{\\partial \\xi} = (\\frac{1}{3})\\cdot 0 + (-\\frac{1}{3})\\cdot 2 + 0\\cdot 0 + 0\\cdot 1.1 + (\\frac{8}{3})\\cdot 1.1 + (-\\frac{8}{3})\\cdot(-0.2) = -2/3 + 8.8/3 + 1.6/3 = 8.4/3 = 2.8$\n$\\frac{\\partial y}{\\partial \\eta} = (\\frac{1}{3})\\cdot 0 + 0\\cdot 2 + (\\frac{5}{3})\\cdot 0 + (-\\frac{2}{3})\\cdot 1.1 + (\\frac{2}{3})\\cdot 1.1 + (-2)\\cdot(-0.2) = 0.4$\n雅可比行列式为 $J(1/6, 2/3) = (0.8)(0.4) - (2.4)(2.8) = 0.32 - 6.72 = -6.4$。\n\n**结论**\n三个求积点处的雅可比行列式值为 $J_1 = -4.8$, $J_2 = -5.6$, 和 $J_3 = -6.4$。三个点的雅可比行列式均为负值，表明等参映射在这些点附近发生了局部反转。对于大多数物理模拟，这样的单元被认为是几何无效的。\n\n在这三个点上 $J$ 的最小值为 $\\min(-4.8, -5.6, -6.4) = -6.4$。\n四舍五入到四位有效数字，最小值为 $-6.400$。",
            "answer": "$$ \\boxed{-6.400} $$"
        },
        {
            "introduction": "一个好的网格不仅应具备高质量的单元，还应能高效地捕捉解的关键特征。本练习将引导您进入自适应网格细化 (Adaptive Mesh Refinement, AMR) 的核心领域，学习如何使用“后验”误差估计来评估解在给定网格上的质量。通过推导并计算基于残差的误差指示子，并应用 Dörfler 标记策略，您将模拟一个智能的网格细化过程，即只在“需要”的地方加密网格，从而以最小的计算成本达到目标精度。",
            "id": "3744598",
            "problem": "考虑在区间 $[0,1]$ 上带有齐次狄利克雷边界条件的一维泊松问题，\n$$\n- u''(x) = f(x), \\quad x \\in (0,1), \\qquad u(0) = 0, \\quad u(1) = 0,\n$$\n其中 $f(x) = 1$。设 $V$ 表示索博列夫空间 $H_{0}^{1}(0,1)$，并设 $V_h \\subset V$ 是与网格 $\\mathcal{T}_h = \\{[0,0.5],[0.5,1]\\}$ 相关联的标准连续分片线性有限元空间。\n\n使用有限元法 (FEM)，离散弱形式旨在寻求 $u_h \\in V_h$，使得对于所有 $v_h \\in V_h$，\n$$\n\\int_{0}^{1} u_h'(x) \\, v_h'(x) \\, dx \\;=\\; \\int_{0}^{1} f(x) \\, v_h(x) \\, dx.\n$$\n\n你的任务是：\n\n1. 通过确定其节点值，在给定网格上求解有限元解 $u_h$。\n\n2. 从上述弱形式出发，结合逐单元分部积分以及区间上的标准迹不等式和反不等式，为每个单元 $K \\in \\mathcal{T}_h$ 推导一个基于残差的后验误差指示子，该指示子是以下各项之和：\n   - 一个依赖于限制在 $K$ 上的 $f$ 的内部残差项，以及\n   - 一个依赖于 $u_h'$ 在内部节点 $x=0.5$ 处跳跃的界面项。\n   将你的表达式具体化到给定的网格和 $f(x)=1$ 的情况。\n\n3. 在 $\\mathcal{T}_h$ 的每个单元上数值计算你推导出的误差指示子。\n\n4. 应用参数为 $\\theta = 0.6$ 的 Dörfler 体标记策略，其目标是选择一个最小子集 $\\mathcal{M} \\subset \\mathcal{T}_h$，使得在 $\\mathcal{M}$ 上的指示子平方和至少是在 $\\mathcal{T}_h$ 上总和的 $\\theta$ 倍。确定为满足 Dörfler 准则必须标记的最小单元数。请以单个整数形式提供最终答案，不带单位。\n\n本题无需四舍五入。请使用 LaTeX 符号表示所有中间的数学推导。",
            "solution": "该问题被评估为有效，因为它具有科学依据、适定、客观、自洽且一致。它代表了有限元法和后验误差分析在一维泊松方程上的一个标准应用。\n\n给定的问题是：\n$$\n- u''(x) = f(x), \\quad x \\in (0,1)\n$$\n边界条件为 $u(0) = 0$ 和 $u(1) = 0$，源项为 $f(x)=1$。在有限元空间 $V_h \\subset H_0^1(0,1)$ 上的离散弱形式是找到 $u_h \\in V_h$ 使得：\n$$\na(u_h, v_h) = L(v_h) \\quad \\forall v_h \\in V_h\n$$\n其中 $a(u,v) = \\int_{0}^{1} u'(x) v'(x) dx$ 且 $L(v) = \\int_{0}^{1} f(x) v(x) dx$。\n\n指定的有限元空间 $V_h$ 由网格 $\\mathcal{T}_h = \\{K_1, K_2\\}$ 上的连续分片线性函数组成，其中 $K_1 = [0, 0.5]$ 且 $K_2 = [0.5, 1]$。网格的节点为 $x_0=0$, $x_1=0.5$ 和 $x_2=1$。\n\n### 任务1：求解有限元解 $u_h$\n\n有限元解 $u_h(x)$ 是基函数的线性组合，$u_h(x) = \\sum_{j=0}^{2} U_j \\phi_j(x)$，其中 $\\phi_j(x)$ 是满足 $\\phi_j(x_i) = \\delta_{ij}$ 的标准线性“帽”函数。系数 $U_j = u_h(x_j)$ 是节点值。\n齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$ 被施加到 $u_h$ 上，因此 $U_0 = 0$ 且 $U_2 = 0$。唯一未知的节点值是 $U_1 = u_h(0.5)$。\n解为 $u_h(x) = U_1 \\phi_1(x)$。\n测试函数空间 $V_h$ 由在边界上为零的函数张成，所以我们只需要用 $v_h = \\phi_1(x)$ 进行测试。弱形式变为一个单一的线性方程：\n$$\na(U_1 \\phi_1, \\phi_1) = L(\\phi_1) \\implies U_1 \\int_{0}^{1} (\\phi_1'(x))^2 dx = \\int_{0}^{1} f(x) \\phi_1(x) dx\n$$\n基函数 $\\phi_1(x)$ 及其导数 $\\phi_1'(x)$ 为：\n$$\n\\phi_1(x) = \\begin{cases} \\frac{x - 0}{0.5 - 0} = 2x & x \\in [0, 0.5] \\\\ \\frac{1 - x}{1 - 0.5} = 2(1-x) & x \\in [0.5, 1] \\end{cases}\n\\qquad\n\\phi_1'(x) = \\begin{cases} 2 & x \\in (0, 0.5) \\\\ -2 & x \\in (0.5, 1) \\end{cases}\n$$\n刚度项是：\n$$\n\\int_{0}^{1} (\\phi_1'(x))^2 dx = \\int_{0}^{0.5} (2)^2 dx + \\int_{0.5}^{1} (-2)^2 dx = \\int_0^1 4 dx = 4\n$$\n源项 $f(x)=1$ 对应的载荷项是：\n$$\n\\int_{0}^{1} f(x) \\phi_1(x) dx = \\int_{0}^{1} \\phi_1(x) dx = \\int_{0}^{0.5} 2x dx + \\int_{0.5}^{1} 2(1-x) dx = \\left[x^2\\right]_0^{0.5} + \\left[2x - x^2\\right]_{0.5}^{1}\n$$\n$$\n= (0.5^2 - 0) + ((2-1) - (2(0.5) - 0.5^2)) = 0.25 + (1 - (1 - 0.25)) = 0.25 + 0.25 = 0.5 = \\frac{1}{2}\n$$\n求解 $U_1$：\n$$\n4 U_1 = \\frac{1}{2} \\implies U_1 = \\frac{1}{8}\n$$\n节点值为 $u_h(0.5) = 1/8$。有限元解为：\n$$\nu_h(x) = \\begin{cases} \\frac{x}{4} & x \\in [0, 0.5] \\\\ \\frac{1-x}{4} & x \\in [0.5, 1] \\end{cases}\n$$\n\n### 任务2：推导基于残差的后验误差指示子\n\n设 $e(x) = u(x) - u_h(x)$ 为误差。对于任何测试函数 $v \\in H_0^1(0,1)$，误差满足伽辽金正交性：对于所有 $v_h \\in V_h$，$a(e, v_h) = 0$。误差方程通过从连续弱形式中减去离散弱形式得到：\n$$\na(e, v) = \\int_0^1 e'(x)v'(x)dx = \\int_0^1 f(x)v(x)dx - \\int_0^1 u_h'(x)v'(x)dx\n$$\n我们对右侧第二项进行逐单元分部积分：\n$$\n\\int_0^1 e'v'dx = \\sum_{K \\in \\mathcal{T}_h} \\left( \\int_K fv dx - \\left( \\left[ u_h'v \\right]_{\\partial K} - \\int_K u_h'' v dx \\right) \\right)\n$$\n$$\n\\int_0^1 e'v'dx = \\sum_{K \\in \\mathcal{T}_h} \\int_K (f + u_h'')v dx - \\sum_{K \\in \\mathcal{T}_h} \\left[ u_h'v \\right]_{\\partial K}\n$$\n项 $R_K = f + u_h''$ 是单元内部残差。边界和可以重组为对所有边（在1D中是节点）的求和。由于 $v(0)=v(1)=0$，在区域边界上的项消失。对于由单元 $K_L$ 和 $K_R$ 共享的内部节点 $z$，其贡献为 $u_h'|_{K_R}(z)v(z) - u_h'|_{K_L}(z)v(z) = [u_h']_z v(z)$，使用跳跃定义 $[w]_z = w(z^+) - w(z^-)$。通常，误差方程中的跳跃项以内部界面求和的形式出现，并带有一个变号。\n$$\n\\int_0^1 e'v'dx = \\sum_{K \\in \\mathcal{T}_h} \\int_K R_K v dx + \\sum_{\\text{interior nodes } z} J_z v(z)\n$$\n其中 $J_z = u_h'(z^-) - u_h'(z^+)$ 是通量的跳跃。\n标准的后验误差分析表明，误差的能量范数由这些残差组成的量从上界和下界限定。单元 $K$ 上的误差指示子平方是对应于内部残差和其界面上通量跳跃的项之和。对于一维泊松问题，标准定义是：\n$$\n\\eta_K^2 = C_1 h_K^2 \\|f + u_h''\\|_{L^2(K)}^2 + C_2 \\sum_{z \\in \\partial K, z \\text{ interior}} \\frac{1}{2} |[u_h']_z|^2\n$$\n常数 $C_1, C_2$ 依赖于插值算子和稳定性估计，但通常取为1。因子 $1/2$ 将界面上的跳跃残差分配给共享该界面的两个单元。因此，推导出的指示子公式为：\n$$\n\\eta_K^2 = h_K^2 \\int_K(f(x) + u_h''(x))^2 dx + \\frac{1}{2} \\sum_{z \\in \\partial K, z \\in (0,1)} ([u_h']_z)^2\n$$\n该指示子 $\\eta_K$ 由一个内部残差项和一个界面跳跃项组成，符合要求。\n\n### 任务3：评估误差指示子\n\n我们将推导出的公式应用于我们的具体问题。\n网格为 $\\mathcal{T}_h = \\{K_1, K_2\\}$，其中 $K_1=[0, 0.5]$ 且 $K_2=[0.5, 1]$。单元尺寸为 $h_{K_1}=0.5$ 和 $h_{K_2}=0.5$。\n源项为 $f(x)=1$。\n从任务1可知，有限元解的二阶导数在每个单元内部为 $u_h''(x) = 0$。\n对于 $K_1$ 和 $K_2$，内部残差均为 $R_K = f+u_h'' = 1+0=1$。\n唯一的内部节点在 $z=0.5$ 处。导数分别为 $u_h'|_{K_1} = 1/4$ 和 $u_h'|_{K_2} = -1/4$。\n在 $z=0.5$ 处导数的跳跃为 $[u_h']_{0.5} = u_h'(0.5^+) - u_h'(0.5^-) = (-1/4) - (1/4) = -1/2$。\n\n对于单元 $K_1=[0, 0.5]$：\n内部边界在 $z=0.5$ 处。\n$$\n\\eta_{K_1}^2 = h_{K_1}^2 \\int_0^{0.5} (1)^2 dx + \\frac{1}{2} \\left( [u_h']_{0.5} \\right)^2\n$$\n$$\n\\eta_{K_1}^2 = (0.5)^2 \\cdot (0.5) + \\frac{1}{2} \\left(-\\frac{1}{2}\\right)^2 = \\left(\\frac{1}{4}\\right)\\left(\\frac{1}{2}\\right) + \\frac{1}{2}\\left(\\frac{1}{4}\\right) = \\frac{1}{8} + \\frac{1}{8} = \\frac{2}{8} = \\frac{1}{4}\n$$\n因此，指示子为 $\\eta_{K_1} = \\sqrt{1/4} = 1/2$。\n\n对于单元 $K_2=[0.5, 1]$：\n内部边界在 $z=0.5$ 处。\n$$\n\\eta_{K_2}^2 = h_{K_2}^2 \\int_{0.5}^1 (1)^2 dx + \\frac{1}{2} \\left( [u_h']_{0.5} \\right)^2\n$$\n$$\n\\eta_{K_2}^2 = (0.5)^2 \\cdot (0.5) + \\frac{1}{2} \\left(-\\frac{1}{2}\\right)^2 = \\left(\\frac{1}{4}\\right)\\left(\\frac{1}{2}\\right) + \\frac{1}{2}\\left(\\frac{1}{4}\\right) = \\frac{1}{8} + \\frac{1}{8} = \\frac{2}{8} = \\frac{1}{4}\n$$\n因此，指示子为 $\\eta_{K_2} = \\sqrt{1/4} = 1/2$。\n指示子平方的数值为 $\\eta_{K_1}^2 = 1/4$ 和 $\\eta_{K_2}^2 = 1/4$。\n\n### 任务4：应用 Dörfler 标记策略\n\n带有参数 $\\theta$ 的 Dörfler 标记策略要求找到一个最小的标记单元集 $\\mathcal{M} \\subset \\mathcal{T}_h$，使得：\n$$\n\\sum_{K \\in \\mathcal{M}} \\eta_K^2 \\ge \\theta \\sum_{K \\in \\mathcal{T}_h} \\eta_K^2\n$$\n给定 $\\theta = 0.6$。\n首先，计算指示子平方的总和：\n$$\n\\sum_{K \\in \\mathcal{T}_h} \\eta_K^2 = \\eta_{K_1}^2 + \\eta_{K_2}^2 = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}\n$$\n标记集 $\\mathcal{M}$ 上的和的目标阈值为：\n$$\n\\theta \\sum_{K \\in \\mathcal{T}_h} \\eta_K^2 = 0.6 \\times \\frac{1}{2} = 0.3\n$$\n该策略是将单元按其指示子值降序排序，然后将它们添加到 $\\mathcal{M}$ 中，直到满足阈值。\n指示子为 $\\eta_{K_1}^2 = 0.25$ 和 $\\eta_{K_2}^2 = 0.25$。它们是相等的。\n1. 标记具有最大指示子的单元。我们可以选择 $K_1$。\n   $\\mathcal{M} = \\{K_1\\}$。在 $\\mathcal{M}$ 上的和为 $\\eta_{K_1}^2 = 0.25$。\n   检查条件：$0.25 \\ge 0.3$ 为假。\n\n2. 标记下一个最大指示子的单元，即 $K_2$。\n   $\\mathcal{M} = \\{K_1, K_2\\}$。在 $\\mathcal{M}$ 上的和为 $\\eta_{K_1}^2 + \\eta_{K_2}^2 = 0.25 + 0.25 = 0.5$。\n   检查条件：$0.5 \\ge 0.3$ 为真。\n\n条件已满足。所需的最小单元集为 $\\mathcal{M} = \\{K_1, K_2\\}$。该集合中的单元数量为2。\n因此，必须标记的最小单元数为2。",
            "answer": "$$\\boxed{2}$$"
        }
    ]
}