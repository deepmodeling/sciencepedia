{
    "hands_on_practices": [
        {
            "introduction": "这第一个练习通过比较两种基本的格式——中心差分和迎风格式，深入探讨了数值通量计算的核心。通过推导它们的截断误差并分析其稳定性，你将对数值精度和鲁棒性之间的内在权衡有一个至关重要的理解。这个练习为你理解为什么需要更复杂的格式奠定了基础。",
            "id": "3759508",
            "problem": "考虑一个被动标量 $\\phi(x,t)$ 在恒定正速度 $a>0$ 下的一维线性平流，其控制方程为守恒律 $\\partial_t \\phi + \\partial_x (a \\phi) = 0$。在一个均匀的笛卡尔网格上，网格中心位于 $x_i$，网格面位于 $x_{i\\pm \\frac{1}{2}}$，网格尺寸为 $\\Delta x$。采用一种有限体积格式，其中网格平均值 $\\phi_i(t)$ 的半离散演化由通过网格面的净对流通量确定。假设网格面值 $\\phi_{i+\\frac{1}{2}}$ 是通过二阶中心插值或一阶迎风插值（适用于 $a0$）从相邻的网格中心值重构的。\n\n任务：\n- 从积分守恒律和网格面通量 $F_{i+\\frac{1}{2}} = a\\,\\phi_{i+\\frac{1}{2}}$ 的定义出发，推导每种重构方法的半离散对流算子，并利用在 $x_i$ 点的泰勒展开，求出在均匀网格上，每种方法对应的修正方程中的主阶项（即由通量散度的空间离散化引入到 $a\\,\\partial_x \\phi$ 中的主阶截断误差项）。\n- 对每种半离散空间离散格式应用显式前向欧拉时间积分，进行 von Neumann 傅里叶稳定性分析，以推导放大因子 $G(\\kappa)$ 作为无量纲波数 $\\kappa$ 和 Courant–Friedrichs–Lewy (CFL) 数 $C = a\\,\\Delta t / \\Delta x$ 的函数。对于每种方法，确定最大值 $C_{\\max}$，使得对所有 $\\kappa \\in [0,\\pi]$ 均有 $|G(\\kappa)| \\leq 1$。\n\n将最终答案以单行矩阵的形式给出，依次包含：二阶中心重构的主阶截断误差项、一阶迎风重构（对于 $a0$）的主阶截断误差项、采用前向欧拉法的二阶中心格式的最大稳定 CFL 数，以及采用前向欧拉法的一阶迎风格式的最大稳定 CFL 数。无需四舍五入，最终答案中不包含单位。",
            "solution": "该问题具有科学基础、提法明确且客观，因此是有效的。它代表了偏微分方程数值分析中的一个标准任务。我们将进行推导。\n\n控制方程为一维线性平流方程，由守恒律给出：\n$$ \\partial_t \\phi + \\partial_x (a \\phi) = 0 $$\n其中速度 $a$ 是一个正常数 ($a0$)。对于有限体积格式，我们将此方程在一个控制体（网格单元）$i$上积分，该控制体从网格面 $x_{i-\\frac{1}{2}}$ 延伸到 $x_{i+\\frac{1}{2}}$。网格宽度为 $\\Delta x = x_{i+\\frac{1}{2}} - x_{i-\\frac{1}{2}}$。\n$$ \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} \\partial_t \\phi \\,dx + \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} \\partial_x (a \\phi) \\,dx = 0 $$\n定义网格平均值为 $\\phi_i(t) = \\frac{1}{\\Delta x} \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} \\phi(x,t) \\,dx$，方程变为：\n$$ \\frac{d}{dt}(\\Delta x \\phi_i) + [a \\phi]_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} = 0 $$\n$$ \\frac{d\\phi_i}{dt} = - \\frac{1}{\\Delta x} \\left( a\\phi(x_{i+\\frac{1}{2}}, t) - a\\phi(x_{i-\\frac{1}{2}}, t) \\right) $$\n有限体积法使用从相邻网格平均值 $\\phi_j(t)$ 重构的值来近似精确的网格面值 $\\phi(x_{i\\pm\\frac{1}{2}}, t)$。在网格面 $x_{i+\\frac{1}{2}}$ 处的数值通量定义为 $F_{i+\\frac{1}{2}} = a\\,\\phi_{i+\\frac{1}{2}}$，其中 $\\phi_{i+\\frac{1}{2}}$ 是重构值。半离散有限体积格式为：\n$$ \\frac{d\\phi_i}{dt} = - \\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x} $$\n等式右侧的项是半离散对流算子。括号内的项 $F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}$ 表示流出网格单元 $i$ 的净通量。算子 $\\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x}$ 是对精确通量散度 $a\\,\\partial_x \\phi$ 的数值近似。\n\n第一部分：截断误差分析\n\n我们通过将网格平均值的泰勒级数展开代入数值通量散度的表达式 $\\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x}$，并将其与精确项 $a\\,\\partial_x\\phi$ 进行比较，来找到主阶截断误差。我们使用以下围绕 $x_i$ 的展开式：\n$$ \\phi_{i\\pm1} = \\phi(x_i \\pm \\Delta x) = \\phi_i \\pm \\Delta x (\\partial_x \\phi)_i + \\frac{(\\Delta x)^2}{2} (\\partial_x^2 \\phi)_i \\pm \\frac{(\\Delta x)^3}{6} (\\partial_x^3 \\phi)_i + \\mathcal{O}((\\Delta x)^4) $$\n\n二阶中心重构：\n网格面值是两个相邻网格中心值的平均值：$\\phi_{i+\\frac{1}{2}} = \\frac{\\phi_i + \\phi_{i+1}}{2}$。\n数值通量为 $F_{i+\\frac{1}{2}} = a \\frac{\\phi_i + \\phi_{i+1}}{2}$。\n网格单元 $i$ 的数值通量散度为：\n$$ \\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x} = \\frac{a}{\\Delta x} \\left( \\frac{\\phi_i + \\phi_{i+1}}{2} - \\frac{\\phi_{i-1} + \\phi_i}{2} \\right) = \\frac{a}{2\\Delta x}(\\phi_{i+1} - \\phi_{i-1}) $$\n代入 $\\phi_{i+1}$ 和 $\\phi_{i-1}$ 的泰勒级数：\n$$ \\phi_{i+1} - \\phi_{i-1} = \\left(\\phi_i + \\Delta x \\partial_x \\phi_i + \\frac{(\\Delta x)^2}{2} \\partial_x^2 \\phi_i + \\frac{(\\Delta x)^3}{6} \\partial_x^3 \\phi_i\\right) - \\left(\\phi_i - \\Delta x \\partial_x \\phi_i + \\frac{(\\Delta x)^2}{2} \\partial_x^2 \\phi_i - \\frac{(\\Delta x)^3}{6} \\partial_x^3 \\phi_i\\right) + \\mathcal{O}((\\Delta x)^5) $$\n$$ \\phi_{i+1} - \\phi_{i-1} = 2\\Delta x \\partial_x \\phi_i + \\frac{(\\Delta x)^3}{3} \\partial_x^3 \\phi_i + \\mathcal{O}((\\Delta x)^5) $$\n数值通量散度则为：\n$$ \\frac{a}{2\\Delta x} \\left( 2\\Delta x \\partial_x \\phi_i + \\frac{(\\Delta x)^3}{3} \\partial_x^3 \\phi_i + \\dots \\right) = a\\,\\partial_x \\phi_i + \\frac{a(\\Delta x)^2}{6} \\partial_x^3 \\phi_i + \\dots $$\n精确项为 $a\\,\\partial_x \\phi$。由离散化引入的主阶项是主误差项，这是一个色散项：\n$$ \\text{误差项 (中心格式)} = \\frac{a(\\Delta x)^2}{6} \\partial_x^3 \\phi $$\n\n一阶迎风重构：\n对于 $a0$，流动方向从左到右，因此网格面 $x_{i+\\frac{1}{2}}$ 的迎风或“施主”单元是单元 $i$。重构为 $\\phi_{i+\\frac{1}{2}} = \\phi_i$。\n数值通量为 $F_{i+\\frac{1}{2}} = a\\,\\phi_i$。\n网格单元 $i$ 的数值通量散度为：\n$$ \\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x} = \\frac{a\\phi_i - a\\phi_{i-1}}{\\Delta x} $$\n代入 $\\phi_{i-1}$ 的泰勒级数：\n$$ \\phi_{i-1} = \\phi_i - \\Delta x \\partial_x \\phi_i + \\frac{(\\Delta x)^2}{2} \\partial_x^2 \\phi_i + \\mathcal{O}((\\Delta x)^3) $$\n数值通量散度则为：\n$$ \\frac{a}{\\Delta x} \\left( \\phi_i - \\left( \\phi_i - \\Delta x \\partial_x \\phi_i + \\frac{(\\Delta x)^2}{2} \\partial_x^2 \\phi_i + \\dots \\right) \\right) = \\frac{a}{\\Delta x} \\left( \\Delta x \\partial_x \\phi_i - \\frac{(\\Delta x)^2}{2} \\partial_x^2 \\phi_i + \\dots \\right) $$\n$$ = a\\,\\partial_x \\phi_i - \\frac{a\\Delta x}{2} \\partial_x^2 \\phi_i + \\dots $$\n添加到 $a\\,\\partial_x \\phi$ 的主阶项是主误差项，这是一个扩散项：\n$$ \\text{误差项 (迎风格式)} = - \\frac{a\\Delta x}{2} \\partial_x^2 \\phi $$\n\n第二部分：Von Neumann 稳定性分析\n\n我们通过应用显式前向欧拉时间积分来分析全离散格式的稳定性。CFL 数为 $C = a\\,\\Delta t/\\Delta x$。我们寻求形式为 $\\phi_j^n = G^n(\\kappa) \\exp(Ij\\kappa)$ 的解，其中 $I$ 是虚数单位，$n$ 是时间层索引，$j$ 是空间索引，$\\kappa = k \\Delta x$ 是无量纲波数。如果放大因子 $G(\\kappa)$ 对所有 $\\kappa \\in [0, \\pi]$ 都满足 $|G(\\kappa)| \\leq 1$，则该格式是稳定的。\n\n采用前向欧拉法的二阶中心格式：\n全离散方程为：\n$$ \\frac{\\phi_i^{n+1} - \\phi_i^n}{\\Delta t} = - \\frac{a}{2\\Delta x}(\\phi_{i+1}^n - \\phi_{i-1}^n) $$\n$$ \\phi_i^{n+1} = \\phi_i^n - \\frac{a\\Delta t}{2\\Delta x}(\\phi_{i+1}^n - \\phi_{i-1}^n) = \\phi_i^n - \\frac{C}{2}(\\phi_{i+1}^n - \\phi_{i-1}^n) $$\n代入傅里叶模式：\n$$ G^{n+1}\\exp(Ii\\kappa) = G^n\\exp(Ii\\kappa) - \\frac{C}{2} \\left( G^n\\exp(I(i+1)\\kappa) - G^n\\exp(I(i-1)\\kappa) \\right) $$\n两边同除以 $G^n\\exp(Ii\\kappa)$：\n$$ G(\\kappa) = 1 - \\frac{C}{2}(\\exp(I\\kappa) - \\exp(-I\\kappa)) = 1 - \\frac{C}{2}(2I \\sin(\\kappa)) = 1 - IC\\sin(\\kappa) $$\n放大因子的模平方为：\n$$ |G(\\kappa)|^2 = (\\text{Re}(G))^2 + (\\text{Im}(G))^2 = 1^2 + (-C\\sin(\\kappa))^2 = 1 + C^2\\sin^2(\\kappa) $$\n稳定性条件 $|G(\\kappa)|^2 \\leq 1$ 要求 $1 + C^2\\sin^2(\\kappa) \\leq 1$，这意味着 $C^2\\sin^2(\\kappa) \\leq 0$。由于 $C^2$ 和 $\\sin^2(\\kappa)$ 都是非负的，这只在 $C\\sin(\\kappa) = 0$ 时才可能成立。对于任何不是 $\\pi$ 整数倍的波数 $\\kappa$，这都要求 $C=0$。因此，对于任何非零时间步长，该格式都是无条件不稳定的。\n$$ C_{\\max} = 0 $$\n\n采用前向欧拉法的一阶迎风格式：\n全离散方程为：\n$$ \\frac{\\phi_i^{n+1} - \\phi_i^n}{\\Delta t} = - \\frac{a}{\\Delta x}(\\phi_i^n - \\phi_{i-1}^n) $$\n$$ \\phi_i^{n+1} = \\phi_i^n - \\frac{a\\Delta t}{\\Delta x}(\\phi_i^n - \\phi_{i-1}^n) = \\phi_i^n - C(\\phi_i^n - \\phi_{i-1}^n) $$\n代入傅里叶模式：\n$$ G^{n+1}\\exp(Ii\\kappa) = G^n\\exp(Ii\\kappa) - C \\left( G^n\\exp(Ii\\kappa) - G^n\\exp(I(i-1)\\kappa) \\right) $$\n两边同除以 $G^n\\exp(Ii\\kappa)$:\n$$ G(\\kappa) = 1 - C(1 - \\exp(-I\\kappa)) = 1 - C(1 - (\\cos(\\kappa) - I\\sin(\\kappa))) $$\n$$ G(\\kappa) = (1 - C + C\\cos(\\kappa)) + I(C\\sin(\\kappa)) $$\n模平方为：\n$$ |G(\\kappa)|^2 = (1 - C + C\\cos(\\kappa))^2 + (C\\sin(\\kappa))^2 $$\n$$ |G(\\kappa)|^2 = 1 - 2C + C^2 + 2C(1-C)\\cos(\\kappa) + C^2\\cos^2(\\kappa) + C^2\\sin^2(\\kappa) $$\n$$ |G(\\kappa)|^2 = 1 - 2C + 2C^2 + 2C(1-C)\\cos(\\kappa) = 1 - 2C(1-C)(1-\\cos(\\kappa)) $$\n使用恒等式 $1 - \\cos(\\kappa) = 2\\sin^2(\\kappa/2)$：\n$$ |G(\\kappa)|^2 = 1 - 4C(1-C)\\sin^2(\\kappa/2) $$\n稳定性条件 $|G(\\kappa)|^2 \\leq 1$ 要求：\n$$ 1 - 4C(1-C)\\sin^2(\\kappa/2) \\leq 1 \\implies -4C(1-C)\\sin^2(\\kappa/2) \\leq 0 \\implies C(1-C)\\sin^2(\\kappa/2) \\geq 0 $$\n由于 $C \\geq 0$ 且 $\\sin^2(\\kappa/2) \\geq 0$，稳定性要求 $C(1-C) \\geq 0$。该不等式在 $0 \\leq C \\leq 1$ 时成立。此外，我们必须有 $|G(\\kappa)|^2 \\ge 0$。$|G(\\kappa)|^2$ 的最小值出现在 $\\sin^2(\\kappa/2)$ 取最大值（$1$）时，此时值为 $1 - 4C(1-C)$。在 $[0,1]$ 区间上，$4C(1-C)$ 的最大值为 $1$（在 $C=1/2$ 时），所以 $|G(\\kappa)|^2 \\ge 1-1=0$。两个条件都满足。因此，该格式是有条件稳定的。最大稳定 CFL 数为：\n$$ C_{\\max} = 1 $$\n\n所要求的四个量是：\n1. 中心格式的主截断误差：$\\frac{a(\\Delta x)^2}{6} \\partial_x^3 \\phi$\n2. 迎风格式的主截断误差：$- \\frac{a\\Delta x}{2} \\partial_x^2 \\phi$\n3. 采用前向欧拉法的中心格式的 $C_{\\max}$：$0$\n4. 采用前向欧拉法的迎风格式的 $C_{\\max}$：$1$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{a(\\Delta x)^2}{6} \\partial_x^3 \\phi  - \\frac{a\\Delta x}{2} \\partial_x^2 \\phi  0  1 \\end{pmatrix} } $$"
        },
        {
            "introduction": "在简单的一阶格式之上，这个练习将指导你完成构建一个高阶、无振荡通量的具体步骤。你将把带有斜率限制器的单调上游中心守恒律格式（Monotonic Upstream-centered Scheme for Conservation Laws, MUSCL）应用于一个二维问题。这个练习使斜率限制和有界重构等抽象概念变得具体化，展示了如何在防止非物理振荡的同时实现更高的精度。",
            "id": "3759523",
            "problem": "考虑一个二维均匀笛卡尔网格上的标量平流问题，其中索引为 $i$ 的控制体中心位于 $\\mathbf{x}_i = (0,0)$，其边心面位置分别为 $\\mathbf{x}_e = (0.5,0)$（东面）、$\\mathbf{x}_w = (-0.5,0)$（西面）、$\\mathbf{x}_n = (0,0.5)$（北面）和 $\\mathbf{x}_s = (0,-0.5)$（南面）。网格间距为 $\\Delta x = 1$ 和 $\\Delta y = 1$。相邻单元的中心位于 $\\mathbf{x}_E = (1,0)$、$\\mathbf{x}_W = (-1,0)$、$\\mathbf{x}_N = (0,1)$ 和 $\\mathbf{x}_S = (0,-1)$。标量场的单元中心值为 $\\phi_i = 2.0$、$\\phi_E = 2.6$、$\\phi_W = 1.4$、$\\phi_N = 2.2$ 和 $\\phi_S = 1.8$。假设平流速度恒定，其东面法向分量为 $(\\mathbf{u}\\cdot\\mathbf{n}_e) = u_n = 1.3$，东面面积为 $A_e = \\Delta y = 1$。将密度视为单位1，因此东面的平流输运通量为 $F_e = u_n\\,\\phi_e\\,A_e$。\n\n从输运标量的积分守恒形式和有限体积法范式（其中面通量由单元中心数据重构的面值计算得出）出发，推导一个与守恒律的单调上游中心格式 (Monotonic Upstream-centered Scheme for Conservation Laws, MUSCL) 一致的线性有界重构。该重构以单元中心为基准，并用斜率向量表示。通过构建一个斜率限制器来强制执行有界性要求，即在面上不产生新的极值。该限制器通过比较沿坐标方向的单边差分，并返回一个与单调性一致的斜率。应用此构造方法，根据给定的相邻单元值和网格间距，计算单元 $i$ 的受限斜率向量，然后在东面中心 $\\mathbf{x}_e$ 处评估重构的标量值，最后计算东面的对流通量 $F_e$。\n\n将最终通量 $F_e$ 报告为一个无量纲数，并将答案四舍五入到四位有效数字。",
            "solution": "该问题要求使用守恒律的单调上游中心格式 (Monotonic Upstream-centered Scheme for Conservation Laws, MUSCL) 计算控制体东面上的对流通量。这涉及一个多步骤过程：确定控制体内标量场的受限斜率，在面中心重构标量值，然后使用该值计算通量。\n\n有限体积法的基础是标量 $\\phi$ 在控制体 $V_i$ 上的守恒律积分形式：\n$$\n\\frac{d}{dt} \\int_{V_i} \\phi \\, dV + \\oint_{\\partial V_i} (\\mathbf{u}\\phi) \\cdot \\mathbf{n} \\, dA = \\int_{V_i} S_\\phi \\, dV\n$$\n对于没有源项的稳态平流问题，这简化为穿过控制体边界 $\\partial V_i$ 的净通量为零。通过单个面 $f$ 的通量为 $F_f = \\int_{A_f} (\\rho \\mathbf{u}\\phi) \\cdot \\mathbf{n} \\, dA$。在有限体积近似中，这被近似为 $F_f \\approx (\\rho_f \\mathbf{u}_f \\cdot \\mathbf{n}_f A_f) \\phi_f$。鉴于密度 $\\rho$ 为单位1，东面通量为 $F_e = (\\mathbf{u} \\cdot \\mathbf{n}_e) A_e \\phi_e = u_n A_e \\phi_e$。关键的挑战是确定面值 $\\phi_e$。\n\nMUSCL 格式通过在每个控制体内线性重构标量场，提供了二阶空间离散精度。在单元 $i$ 内部或边界上任意点 $\\mathbf{x}$ 处 $\\phi$ 的重构值为：\n$$\n\\phi(\\mathbf{x}) = \\phi_i + \\nabla\\phi_i \\cdot (\\mathbf{x} - \\mathbf{x}_i)\n$$\n其中 $\\phi_i$ 是单元 $i$ 的单元中心值，$\\mathbf{x}_i$ 是单元中心，$\\nabla\\phi_i$ 是单元 $i$ 中标量场的受限梯度（或斜率）。\n\n斜率 $\\nabla\\phi_i = \\left( \\frac{\\partial\\phi}{\\partial x}\\bigg|_i, \\frac{\\partial\\phi}{\\partial y}\\bigg|_i \\right)$ 必须被“限制”，以满足有界性原则，该原则防止重构产生新的局部最大值或最小值。这是通过使用斜率限制器来实现的。问题指定通过比较单边差分来构造斜率。\n\n让我们计算单元 $i$ 的斜率。给定的相邻单元中心值为 $\\phi_i = 2.0$、$\\phi_E = 2.6$、$\\phi_W = 1.4$、$\\phi_N = 2.2$ 和 $\\phi_S = 1.8$。网格间距是均匀的，$\\Delta x = 1$ 和 $\\Delta y = 1$。\n\n首先，我们计算单元 $i$ 在 $x$ 方向上的单边斜率：\n后向斜率（使用单元 $W$）：\n$$\ns_{x, \\text{bwd}} = \\frac{\\phi_i - \\phi_W}{\\mathbf{x}_i_x - \\mathbf{x}_W_x} = \\frac{2.0 - 1.4}{0 - (-1)} = \\frac{0.6}{1} = 0.6\n$$\n前向斜率（使用单元 $E$）：\n$$\ns_{x, \\text{fwd}} = \\frac{\\phi_E - \\phi_i}{\\mathbf{x}_E_x - \\mathbf{x}_i_x} = \\frac{2.6 - 2.0}{1 - 0} = \\frac{0.6}{1} = 0.6\n$$\n由于两个单边斜率符号相同 ($s_{x, \\text{bwd}} \\cdot s_{x, \\text{fwd}}  0$)，该区域的剖面是单调的。当单边斜率相同时，任何标准的对称斜率限制器（例如，minmod, van Leer, superbee）都会返回此值作为受限斜率。因此，受限梯度的 $x$ 分量为：\n$$\n\\frac{\\partial\\phi}{\\partial x}\\bigg|_i = 0.6\n$$\n\n接下来，我们计算单元 $i$ 在 $y$ 方向上的单边斜率：\n后向斜率（使用单元 $S$）：\n$$\ns_{y, \\text{bwd}} = \\frac{\\phi_i - \\phi_S}{\\mathbf{x}_i_y - \\mathbf{x}_S_y} = \\frac{2.0 - 1.8}{0 - (-1)} = \\frac{0.2}{1} = 0.2\n$$\n前向斜率（使用单元 $N$）：\n$$\ns_{y, \\text{fwd}} = \\frac{\\phi_N - \\phi_i}{\\mathbf{x}_N_y - \\mathbf{x}_i_y} = \\frac{2.2 - 2.0}{1 - 0} = \\frac{0.2}{1} = 0.2\n$$\n同样，单边斜率相同且为正。受限梯度的 $y$ 分量为：\n$$\n\\frac{\\partial\\phi}{\\partial y}\\bigg|_i = 0.2\n$$\n因此，单元 $i$ 的受限斜率向量为 $\\nabla\\phi_i = (0.6, 0.2)$。\n\n下一步是在东面中心 $\\mathbf{x}_e = (0.5, 0)$ 处评估重构的标量值。给定的东面法向速度分量为 $u_n = 1.3$，是正值。这表明流动方向是从单元 $i$ 到单元 $E$。对于像 MUSCL 这样的迎风格式，面值 $\\phi_e$ 由迎风单元（即单元 $i$）中的重构确定。\n使用线性重构公式，其中 $\\mathbf{x}_i = (0,0)$：\n$$\n\\phi_e = \\phi(\\mathbf{x}_e) = \\phi_i + \\nabla\\phi_i \\cdot (\\mathbf{x}_e - \\mathbf{x}_i)\n$$\n$$\n\\phi_e = 2.0 + (0.6, 0.2) \\cdot ((0.5, 0) - (0,0))\n$$\n$$\n\\phi_e = 2.0 + (0.6 \\times 0.5) + (0.2 \\times 0) = 2.0 + 0.3 = 2.3\n$$\n这个重构值 $\\phi_e = 2.3$ 介于相邻单元值 $\\phi_i = 2.0$ 和 $\\phi_E = 2.6$ 之间，证实了有界性判据得到满足。\n\n最后，我们使用提供的公式和数据计算东面的对流通量 $F_e$：$F_e = u_n \\phi_e A_e$。\n给定的值为 $u_n = 1.3$ 和 $A_e = \\Delta y = 1$：\n$$\nF_e = 1.3 \\times 2.3 \\times 1 = 2.99\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nF_e = 2.990\n$$",
            "answer": "$$\\boxed{2.990}$$"
        },
        {
            "introduction": "对于守恒律方程组，例如气体动力学的欧拉方程，简单地对单个标量进行迎风处理是不够的。这最后一个练习介绍了近似黎曼求解器的概念，这是现代计算流体动力学的基石。你将推导著名的 Harten-Lax-van Leer (HLL) 通量，从而深入了解如何对双曲系统的波结构进行建模，以创建一个鲁棒且物理上一致的数值通量。",
            "id": "3759519",
            "problem": "考虑一个在 $d$ 维空间中的双曲守恒律方程组，其守恒形式写作 $\\partial_t U + \\nabla \\cdot F(U) = 0$，其中 $U \\in \\mathbb{R}^m$ 是守恒变量向量，$F(U) \\in \\mathbb{R}^{m \\times d}$ 是通量张量。在用于多尺度建模和分析的有限体积离散化中，穿过单位法向量为 $\\boldsymbol{n}$ 的控制体表面的通量，是通过求解沿法线方向的局部一维黎曼问题来计算的。令 $f_n(U) := F(U)\\,\\boldsymbol{\\cdot}\\,\\boldsymbol{n} \\in \\mathbb{R}^m$ 表示表面法向通量向量，并假设在表面上存在一个间断，其左右状态分别为 $U_L$ 和 $U_R$。Harten–Lax–van Leer (HLL) 近似黎曼求解器通过一个双波结构来模拟解，该结构具有沿法线方向的最小和最大信号速度 $s_L$ 和 $s_R$，这两个波界定了一个单一的中间常数状态。\n\n从与表面法线对齐的时空控制体上的积分守恒律以及穿过每个波的 Rankine–Hugoniot 跳跃条件出发，构建以 $U_L$、$U_R$、$f_n(U_L)$、$f_n(U_R)$、$s_L$ 和 $s_R$ 表示的表面上的 HLL 数值通量。特别地，推导在 HLL 模型中出现在两个边界波之间的中间表面法向通量状态 $f_n^{*}$ 的闭式解析表达式。将您的最终答案表示为单个解析表达式。",
            "solution": "问题陈述经解析后被确定为有效。这是一个偏微分方程数值分析领域中适定的问题，具体涉及 Harten–Lax–van Leer (HLL) 数值通量的推导。该问题具有科学依据、自洽且客观。因此，我们可以进行形式推导。\n\n该问题考虑了一个 $d$ 维守恒律方程组，$\\partial_t U + \\nabla \\cdot F(U) = 0$。在有限体积的背景下，穿过单元表面的通量是通过求解沿表面法线 $\\boldsymbol{n}$ 方向的一维黎曼问题来确定的。设 $x$ 是沿 $\\boldsymbol{n}$ 方向的空间坐标。局部一维守恒律由下式给出：\n$$\n\\partial_t U + \\partial_x f_n(U) = 0\n$$\n其中 $f_n(U) = F(U) \\cdot \\boldsymbol{n}$ 是法向通量向量。该黎曼问题的初始条件是在 $x=0$ 处的一个间断，它分开了左状态 $U_L$ 和右状态 $U_R$。\n\nHLL 近似黎曼求解器用一个简化的波结构来模拟这个问题的解。它假设解由三个常数状态组成：原始左状态 $U_L$、一个中间状态 $U^*$ 和原始右状态 $U_R$。这些状态被两个波分开，这两个波以最小和最大信号速度 $s_L$ 和 $s_R$（其中 $s_L  s_R$）从初始间断 $x=0$ 处传播开来。解的结构是：\n$$\nU(x, t) =\n\\begin{cases}\nU_L  \\text{若 } x/t  s_L \\\\\nU^*  \\text{若 } s_L  x/t  s_R \\\\\nU_R  \\text{若 } x/t  s_R\n\\end{cases}\n$$\n问题要求推导中间表面法向通量状态，我们将其记为 $f_n^* \\equiv f_n(U^*)$。这可以通过在两个波上分别应用 Rankine–Hugoniot 跳跃条件来完成。对于以速度 $s$ 移动的间断，Rankine–Hugoniot 条件是 $s \\Delta U = \\Delta f_n$，其中 $\\Delta(\\cdot)$ 表示物理量穿过间断的跳跃（右状态减去左状态）。\n\n将此条件应用于速度为 $s_L$ 的向左移动的波，跳跃是从状态 $U_L$ 到状态 $U^*$。因此，我们有：\n$$\ns_L (U^* - U_L) = f_n(U^*) - f_n(U_L)\n$$\n使用我们的定义 $f_n^* = f_n(U^*)$，上式变为：\n$$\ns_L (U^* - U_L) = f_n^* - f_n(U_L) \\quad (1)\n$$\n\n将此条件应用于速度为 $s_R$ 的向右移动的波，跳跃是从状态 $U^*$ 到状态 $U_R$。这得到：\n$$\ns_R (U_R - U^*) = f_n(U_R) - f_n(U^*)\n$$\n可以写成：\n$$\ns_R (U_R - U^*) = f_n(U_R) - f_n^* \\quad (2)\n$$\n\n方程 $(1)$ 和 $(2)$ 构成了一个关于两个未知向量 $U^*$ 和 $f_n^*$ 的线性向量方程组。我们的目标是求解 $f_n^*$。我们可以通过先重新整理两个方程以分离出含 $U^*$ 的项，然后消去 $U^*$ 来实现这一点。\n\n从方程 $(1)$：\n$$\ns_L U^* - f_n^* = s_L U_L - f_n(U_L)\n$$\n从方程 $(2)$：\n$$\n-s_R U^* + f_n^* = f_n(U_R) - s_R U_R \\implies s_R U^* - f_n^* = s_R U_R - f_n(U_R)\n$$\n我们现在得到方程组：\n$$\n\\begin{cases}\ns_L U^* - f_n^* = s_L U_L - f_n(U_L)  (1') \\\\\ns_R U^* - f_n^* = s_R U_R - f_n(U_R)  (2')\n\\end{cases}\n$$\n为了消去 $U^*$，我们可以将方程 $(1')$ 乘以 $s_R$，将方程 $(2')$ 乘以 $s_L$：\n$$\n\\begin{cases}\ns_R s_L U^* - s_R f_n^* = s_R (s_L U_L - f_n(U_L)) \\\\\ns_L s_R U^* - s_L f_n^* = s_L (s_R U_R - f_n(U_R))\n\\end{cases}\n$$\n将新的第二个方程从第一个方程中减去，即可消去 $s_L s_R U^*$ 项：\n$$\n(-s_R f_n^*) - (-s_L f_n^*) = s_R (s_L U_L - f_n(U_L)) - s_L (s_R U_R - f_n(U_R))\n$$\n$$\n(s_L - s_R) f_n^* = s_R s_L U_L - s_R f_n(U_L) - s_L s_R U_R + s_L f_n(U_R)\n$$\n将右侧的项进行分组：\n$$\n(s_L - s_R) f_n^* = (s_L f_n(U_R) - s_R f_n(U_L)) - s_L s_R (U_R - U_L)\n$$\n最后，假设 $s_L \\neq s_R$，通过除以 $(s_L - s_R)$ 来求解 $f_n^*$：\n$$\nf_n^* = \\frac{s_L f_n(U_R) - s_R f_n(U_L) - s_L s_R (U_R - U_L)}{s_L - s_R}\n$$\n为了得到更常规的形式，我们可以将分子和分母同乘以 $-1$：\n$$\nf_n^* = \\frac{-(s_L f_n(U_R) - s_R f_n(U_L) - s_L s_R (U_R - U_L))}{-(s_L - s_R)} = \\frac{s_R f_n(U_L) - s_L f_n(U_R) + s_L s_R (U_R - U_L)}{s_R - s_L}\n$$\n这就是 HLL 近似黎曼求解器中中间表面法向通量状态 $f_n^*$ 的闭式解析表达式，它由初始状态 $U_L$ 和 $U_R$、它们对应的法向通量 $f_n(U_L)$ 和 $f_n(U_R)$ 以及信号速度 $s_L$ 和 $s_R$ 构建。对于 $s_L \\le 0 \\le s_R$ 的常见情况，此通量 $f_n^*$ 被用作界面上的数值通量。",
            "answer": "$$\n\\boxed{\\frac{s_R f_n(U_L) - s_L f_n(U_R) + s_L s_R (U_R - U_L)}{s_R - s_L}}\n$$"
        }
    ]
}