{
    "hands_on_practices": [
        {
            "introduction": "多重网格方法的魔力在于其平滑器的有效性，即它能够衰减误差中的高频分量，为粗网格校正留下平滑的误差。本练习  将使用局部傅里叶分析（Local Fourier Analysis, LFA）—— 一种分析迭代方法的强大理论工具 —— 来量化这种“平滑”特性。通过为加权雅可比法推导最优松弛参数 $\\omega$，您将深入理解高效平滑器的工作原理。",
            "id": "3783291",
            "problem": "考虑在一维周期性均匀网格上离散化的泊松方程，网格间距为 $h$，有 $N$ 个点，其中 $N$ 很大。离散算子是标准的二阶有限差分拉普拉斯算子，它作用于网格函数 $\\{u_{j}\\}$ 的形式为 $$A u_{j} = \\frac{1}{h^{2}}(-u_{j-1} + 2 u_{j} - u_{j+1})$$ 在为区域分解设计的并行双网格多重网格方法中，采用点态加权雅可比（Jacobi）光滑子，其松弛参数为 $\\omega \\in (0,1)$，并在每个子域上独立操作（这种局部性可实现高效的并行化）。设加权雅可比迭代的误差传播矩阵为 $E = I - \\omega D^{-1} A$，其中 $D$ 是 $A$ 的对角部分。\n\n使用局部傅里叶分析（Local Fourier Analysis, LFA），其中傅里叶模式 $e^{\\mathrm{i} \\theta j}$ 可将周期性网格上的常系数循环算子对角化，请从第一性原理出发，推导迭代矩阵 $E$ 的傅里叶符号 $\\mu(\\theta)$，然后计算平滑因子 $\\rho(\\omega)$。平滑因子定义为 $|\\mu(\\theta)|$ 在相对于 $2h$ 粗网格的高频集 $\\theta \\in [\\pi/2,\\pi]$ 上的最大值。最后，确定使 $\\rho(\\omega)$ 最小化的 $\\omega \\in (0,1)$ 的值，并以一个实数形式报告最小化的平滑因子。不要对最终答案进行四舍五入。",
            "solution": "该问题要求分析周期性网格上一维离散泊松方程的加权雅可比光滑子。分析的核心将使用局部傅里叶分析（LFA）进行。\n\n首先，我们确定加权雅可比迭代的误差传播矩阵 $E = I - \\omega D^{-1} A$ 的组成部分。\n离散算子由下式给出\n$$A u_{j} = \\frac{1}{h^{2}}(-u_{j-1} + 2 u_{j} - u_{j+1})$$\n由于周期性边界条件，矩阵 $A$ 是一个循环矩阵。$A$ 的对角部分（记为 $D$）由 $u_j$ 的系数组成。从表达式中可以看出，$A$ 的对角线元素均为 $2/h^2$。因此，$D$ 是单位矩阵的标量倍，即 $D = \\frac{2}{h^2} I$。\n$D$ 的逆矩阵为 $D^{-1} = \\frac{h^2}{2} I$。\n\n分析过程是通过检验算子对傅里叶模式 $\\phi_j(\\theta) = e^{\\mathrm{i} \\theta j}$ 的作用来进行的，其中 $\\theta$ 是角频率。这些模式是周期性网格上任何线性常系数算子的特征向量。相应的特征值称为该算子的傅里叶符号。\n\n我们首先推导算子 $A$ 的符号，记为 $\\tilde{A}(\\theta)$。\n$$\n\\begin{aligned}\nA \\phi_j(\\theta) &= A e^{\\mathrm{i} \\theta j} \\\\\n&= \\frac{1}{h^{2}}(-e^{\\mathrm{i} \\theta (j-1)} + 2 e^{\\mathrm{i} \\theta j} - e^{\\mathrm{i} \\theta (j+1)}) \\\\\n&= \\frac{e^{\\mathrm{i} \\theta j}}{h^{2}}(-e^{-\\mathrm{i} \\theta} + 2 - e^{\\mathrm{i} \\theta}) \\\\\n&= \\frac{e^{\\mathrm{i} \\theta j}}{h^{2}}(2 - (e^{\\mathrm{i} \\theta} + e^{-\\mathrm{i} \\theta}))\n\\end{aligned}\n$$\n使用欧拉（Euler）公式 $\\cos(\\theta) = \\frac{e^{\\mathrm{i} \\theta} + e^{-\\mathrm{i} \\theta}}{2}$，我们得到：\n$$\nA \\phi_j(\\theta) = \\frac{e^{\\mathrm{i} \\theta j}}{h^{2}}(2 - 2\\cos(\\theta)) = \\frac{2}{h^2}(1 - \\cos(\\theta)) e^{\\mathrm{i} \\theta j}\n$$\n使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\frac{\\theta}{2})$，表达式简化为：\n$$\nA \\phi_j(\\theta) = \\frac{4}{h^2}\\sin^2\\left(\\frac{\\theta}{2}\\right) e^{\\mathrm{i} \\theta j}\n$$\n因此，$A$ 的傅里叶符号是 $\\tilde{A}(\\theta) = \\frac{4}{h^2}\\sin^2(\\frac{\\theta}{2})$。\n\n接下来，我们推导迭代矩阵 $E = I - \\omega D^{-1} A$ 的符号，记为 $\\mu(\\theta)$。单位矩阵 $I$ 的符号是 $1$。$D^{-1}$ 的符号是标量 $\\frac{h^2}{2}$。\n$$\n\\begin{aligned}\n\\mu(\\theta) &= \\tilde{I}(\\theta) - \\omega \\tilde{D}^{-1}(\\theta) \\tilde{A}(\\theta) \\\\\n&= 1 - \\omega \\left(\\frac{h^2}{2}\\right) \\left(\\frac{4}{h^2}\\sin^2\\left(\\frac{\\theta}{2}\\right)\\right) \\\\\n&= 1 - 2\\omega \\sin^2\\left(\\frac{\\theta}{2}\\right)\n\\end{aligned}\n$$\n这是加权雅可比方法对于频率为 $\\theta$ 的模式的放大因子。\n\n平滑因子 $\\rho(\\omega)$ 定义为放大因子在所有高频上的最大模。对于粗化到间距为 $2h$ 的网格，高频集为 $\\theta \\in [\\frac{\\pi}{2}, \\pi]$。\n$$\n\\rho(\\omega) = \\max_{\\theta \\in [\\pi/2, \\pi]} |\\mu(\\theta)| = \\max_{\\theta \\in [\\pi/2, \\pi]} \\left| 1 - 2\\omega \\sin^2\\left(\\frac{\\theta}{2}\\right) \\right|\n$$\n为了找到这个最大值，我们分析函数 $f(\\theta) = \\sin^2(\\frac{\\theta}{2})$ 在 $\\theta \\in [\\frac{\\pi}{2}, \\pi]$ 上的值域。\n自变量 $\\frac{\\theta}{2}$ 位于区间 $[\\frac{\\pi}{4}, \\frac{\\pi}{2}]$。在此区间内，$\\sin(x)$ 是一个单调递增函数。\n当 $\\theta = \\frac{\\pi}{2}$ 时，我们有 $\\sin^2(\\frac{\\pi}{4}) = (\\frac{\\sqrt{2}}{2})^2 = \\frac{1}{2}$。\n当 $\\theta = \\pi$ 时，我们有 $\\sin^2(\\frac{\\pi}{2}) = 1^2 = 1$。\n令 $x = \\sin^2(\\frac{\\theta}{2})$。$x$ 的值域是 $[\\frac{1}{2}, 1]$。\n平滑因子的表达式变为：\n$$ \\rho(\\omega) = \\max_{x \\in [1/2, 1]} |1 - 2\\omega x| $$\n函数 $g(x) = 1 - 2\\omega x$ 是关于 $x$ 的线性函数。其绝对值在闭区间上的最大值必然出现在区间的端点之一。因此，我们在 $x = \\frac{1}{2}$ 和 $x=1$ 处计算 $|g(x)|$ 的值。\n在 $x = \\frac{1}{2}$ 处：$|1 - 2\\omega (\\frac{1}{2})| = |1 - \\omega|$。\n在 $x = 1$ 处：$|1 - 2\\omega (1)| = |1 - 2\\omega|$。\n\n所以，平滑因子为 $\\rho(\\omega) = \\max(|1-\\omega|, |1-2\\omega|)$。\n考虑到松弛参数 $\\omega$ 在区间 $(0,1)$ 内，项 $1-\\omega$ 总是正的，所以 $|1-\\omega| = 1-\\omega$。\n表达式简化为 $\\rho(\\omega) = \\max(1-\\omega, |1-2\\omega|)$。\n\n最后一步是找到使 $\\rho(\\omega)$ 最小的 $\\omega \\in (0,1)$ 的值。两个连续函数的最大值的最小值通常在两个函数相等时取得。我们令 $\\max$ 函数的两个参数相等：\n$$ 1 - \\omega = |1 - 2\\omega| $$\n我们考虑绝对值项的两种情况：\n情况1：$1 - 2\\omega \\geq 0$，这意味着 $\\omega \\leq \\frac{1}{2}$。方程变为 $1 - \\omega = 1 - 2\\omega$，解得 $\\omega = 0$。这不在指定的定义域 $\\omega \\in (0,1)$ 内。\n情况2：$1 - 2\\omega  0$，这意味着 $\\omega > \\frac{1}{2}$。方程变为 $1 - \\omega = -(1 - 2\\omega) = 2\\omega - 1$。\n求解 $\\omega$：\n$$ 2 = 3\\omega \\implies \\omega = \\frac{2}{3} $$\n这个值 $\\omega = \\frac{2}{3}$ 在定义域 $(0,1)$ 内，并且满足条件 $\\omega > \\frac{1}{2}$，因此它是最优松弛参数，$\\omega_{opt} = \\frac{2}{3}$。\n\n将 $\\omega_{opt}$ 代入 $\\rho(\\omega)$ 的表达式中，即可求得最小化的平滑因子：\n$$ \\rho_{min} = \\rho\\left(\\frac{2}{3}\\right) = \\max\\left(1-\\frac{2}{3}, \\left|1-2\\left(\\frac{2}{3}\\right)\\right|\\right) $$\n$$ \\rho_{min} = \\max\\left(\\frac{1}{3}, \\left|1-\\frac{4}{3}\\right|\\right) = \\max\\left(\\frac{1}{3}, \\left|-\\frac{1}{3}\\right|\\right) = \\max\\left(\\frac{1}{3}, \\frac{1}{3}\\right) = \\frac{1}{3} $$\n最小平滑因子为 $\\frac{1}{3}$。",
            "answer": "$$ \\boxed{\\frac{1}{3}} $$"
        },
        {
            "introduction": "在分析了单个组件之后，下一步是将它们组合起来构建一个完整的算法。本练习  要求您通过编程实现一个双网格求解器。通过具体构造离散算子、平滑器、延长和限制算子的矩阵，您将能够计算出该方法的实际收敛因子。这个练习将抽象的解析公式与具体的数值结果联系起来，让您亲手验证多重网格方法的卓越效率。",
            "id": "3783314",
            "problem": "考虑一维泊松边界值问题 $-u''(x)=f(x)$，定义在区间 $(0,1)$ 上，并带有齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$。使用标准的二阶中心有限差分法，在具有 $n$ 个内部点的均匀网格上对该问题进行离散化，得到线性系统 $A u = b$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是由离散化产生的对称正定三对角矩阵。\n\n您的任务是构建一个两网格（TG）多重网格误差传播算子，并数值计算其收敛因子，该收敛因子定义为TG误差传播矩阵的谱半径。请使用以下组件：\n\n- 用于前光滑和后光滑的加权雅可比光滑子，松弛参数为 $\\omega$，用作前光滑时应用 $\\nu_1$ 次，用作后光滑时应用 $\\nu_2$ 次。\n- 用于延拓（从粗网格到细网格）的线性插值。\n- 全加权限制（从细网格到粗网格），通过伽辽金粗网格算子 $A_c = R A P$ 进行一致性定义，其中 $P$ 表示延拓矩阵，$R$ 表示限制矩阵。\n\n从以下基本定义和建模假设开始：\n- 对于网格间距为 $h = \\frac{1}{n+1}$ 的均匀网格上带狄利克雷边界条件的一维泊松问题，其离散算子 $A$ 是一个三对角矩阵，其对角线元素为 $\\frac{2}{h^2}$，次对角线和超对角线元素为 $-\\frac{1}{h^2}$。\n- 用于求解 $A u = b$ 的加权雅可比迭代更新公式为 $u^{(k+1)} = u^{(k)} + \\omega D^{-1}(b - A u^{(k)})$，其中 $D$ 是 $A$ 的对角部分。\n- 对于误差 $e^{(k)} = u - u^{(k)}$，加权雅可比误差传播矩阵为 $S = I - \\omega D^{-1} A$。\n- 延拓矩阵 $P \\in \\mathbb{R}^{n \\times n_c}$ 由线性插值给出，其中 $n_c = \\lfloor n/2 \\rfloor$ 是粗网格上的内部点数。具体来说，当索引在范围内时，索引为 $j$ 的粗网格变量以权重 $\\frac{1}{2}$、$1$ 和 $\\frac{1}{2}$ 分别映射到细网格索引 $2j-1$、$2j$ 和 $2j+1$。\n- 限制矩阵是全加权算子 $R = \\frac{1}{2} P^\\top$，确保伽辽金粗网格算子 $A_c = R A P$ 的对称性。\n- 对于一次前光滑和一次后光滑扫描，两网格误差传播算子为\n$$\nE_{\\mathrm{TG}} = S_{\\text{post}}^{\\nu_2} \\left(I - P A_c^{-1} R A\\right) S_{\\text{pre}}^{\\nu_1},\n$$\n其中 $S_{\\text{pre}} = S_{\\text{post}} = S$ 是加权雅可比误差传播矩阵。两网格收敛因子是谱半径 $\\rho(E_{\\mathrm{TG}})$。\n\n实现一个程序，对于给定的参数 $(n, \\omega, \\nu_1, \\nu_2)$，构建 $A$、$P$、$R$、$A_c$ 和 $E_{\\mathrm{TG}}$，并将 $\\rho(E_{\\mathrm{TG}})$ 计算为 $E_{\\mathrm{TG}}$ 特征值的最大模。计算必须完全是数值的、自包含的，并且不需要外部输入。\n\n使用以下参数集测试套件来评估计算的不同方面：\n- 案例 1：$n=31$, $\\omega=\\frac{2}{3}$, $\\nu_1=1$, $\\nu_2=1$（基准要求配置）。\n- 案例 2：$n=3$, $\\omega=\\frac{2}{3}$, $\\nu_1=1$, $\\nu_2=1$（最小的非平凡粗网格）。\n- 案例 3：$n=63$, $\\omega=\\frac{2}{3}$, $\\nu_1=1$, $\\nu_2=1$（更大的网格以评估渐进行为）。\n- 案例 4：$n=31$, $\\omega=\\frac{1}{2}$, $\\nu_1=1$, $\\nu_2=1$（不同松弛参数的影响）。\n- 案例 5：$n=31$, $\\omega=\\frac{2}{3}$, $\\nu_1=2$, $\\nu_2=2$（更强光滑的影响）。\n\n在此公式中，所有计算都是无量纲的；不需要物理单位。您的程序应生成单行输出，其中包含一个用方括号括起来的、按上述案例排序的逗号分隔列表。每个结果都必须是格式化为小数点后恰好六位的浮点数，例如 $[\\rho_1,\\rho_2,\\rho_3,\\rho_4,\\rho_5]$，其中每个 $\\rho_i$ 是对应于案例 $i$ 的计算出的谱半径。",
            "solution": "该问题在科学上基于偏微分方程数值分析的原理，是客观的，并提供了一套完整且一致的定义来构建数值解。所有组成部分——泊松问题、有限差分离散化、加权雅可比光滑子以及两网格循环组件（延拓、限制、伽辽金算子）——都是多重网格方法领域的标准课题。该问题是适定的，要求对一个明确定义的误差传播矩阵的谱半径进行数值计算。解决方案的流程是为每个给定的参数集 $(n, \\omega, \\nu_1, \\nu_2)$ 构建两网格分析所需的矩阵。\n\n**步骤 1：离散化和细网格算子 $A$**\n在具有 $n$ 个内部点 $x_i = i h$（$i=1, \\dots, n$）的均匀网格上离散化一维泊松方程 $-u''(x) = f(x)$（在 $(0, 1)$ 上，且 $u(0)=u(1)=0$），其中网格间距为 $h = \\frac{1}{n+1}$。二阶导数 $u''(x_i)$ 使用二阶中心有限差分进行近似：\n$$\nu''(x_i) \\approx \\frac{u(x_{i-1}) - 2u(x_i) + u(x_{i+1})}{h^2}\n$$\n将此应用于每个内部点 $x_i$ 处的方程，并结合边界条件 $u(x_0)=u_0=0$ 和 $u(x_{n+1})=u_{n+1}=0$，即可得到线性系统 $A\\mathbf{u} = \\mathbf{b}$。矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 是一个对称正定三对角矩阵，定义如下：\n$$\nA = \\frac{1}{h^2} \\begin{pmatrix}\n2  -1        \\\\\n-1  2  -1    \\\\\n  \\ddots  \\ddots  \\ddots  \\\\\n   -1  2  -1 \\\\\n     -1  2\n\\end{pmatrix}\n$$\n对角线元素为 $A_{i,i} = \\frac{2}{h^2}$，次对角线和超对角线元素为 $A_{i,i\\pm1} = -\\frac{1}{h^2}$。\n\n**步骤 2：加权雅可比光滑子和误差传播矩阵 $S$**\n用于求解 $A\\mathbf{u}=\\mathbf{b}$ 的加权雅可比方法是一种迭代格式。误差 $\\mathbf{e}^{(k)} = \\mathbf{u} - \\mathbf{u}^{(k)}$ 根据矩阵 $S = I - \\omega D^{-1} A$ 进行传播，其中 $D$ 是 $A$ 的对角部分，$I$ 是单位矩阵，$\\omega$ 是松弛参数。对于我们特定的矩阵 $A$，其对角线是常数：$D = \\frac{2}{h^2} I$。因此，$D^{-1} = \\frac{h^2}{2} I$，光滑子矩阵简化为：\n$$\nS = I - \\omega \\left(\\frac{h^2}{2} I\\right) A = I - \\frac{\\omega h^2}{2} A\n$$\n\n**步骤 3：网格间传递算子：延拓 $P$ 和限制 $R$**\n网格传递算子在细网格（有 $n$ 个点）和粗网格（有 $n_c = \\lfloor n/2 \\rfloor$ 个点）之间映射向量。\n延拓（或插值）算子 $P \\in \\mathbb{R}^{n \\times n_c}$ 将粗网格向量映射到细网格向量。\n限制算子 $R \\in \\mathbb{R}^{n_c \\times n}$ 将细网格向量映射到粗网格向量。它被定义为延拓算子的缩放转置，以确保伽辽金粗网格算子是对称的：\n$$\nR = \\frac{1}{2} P^\\top\n$$\n\n**步骤 4：粗网格算子 $A_c$**\n粗网格算子 $A_c$ 应该在粗网格上近似细网格算子 $A$。伽辽金方法通过网格间传递算子来定义 $A_c$：\n$$\nA_c = R A P = \\left(\\frac{1}{2} P^\\top\\right) A P\n$$\n对于给定的问题，如果 $A$ 是对称正定的，则 $A_c$ 也将是对称正定的，因此是可逆的。$A_c$ 是一个 $n_c \\times n_c$ 矩阵。\n\n**步骤 5：两网格误差传播算子 $E_{\\mathrm{TG}}$**\n一个两网格 V 循环包括前光滑、粗网格校正和后光滑。此完整循环的误差传播由以下算子给出：\n$$\nE_{\\mathrm{TG}} = S^{\\nu_2} \\left(I - P A_c^{-1} R A\\right) S^{\\nu_1}\n$$\n在这里，$S^{\\nu_1}$ 表示 $\\nu_1$ 次前光滑步骤的效果。括号中的项表示粗网格校正步骤，该步骤涉及限制残差、在粗网格上求解误差方程（$A_c e_c = r_c$），并将校正量延拓回细网格。$S^{\\nu_2}$ 表示 $\\nu_2$ 次后光滑步骤的效果。\n\n**步骤 6：收敛因子计算**\n两网格方法的渐进收敛因子是误差传播算子的谱半径 $\\rho(E_{\\mathrm{TG}})$。谱半径定义为 $E_{\\mathrm{TG}}$ 特征值绝对值的最大值：\n$$\n\\rho(E_{\\mathrm{TG}}) = \\max \\{|\\lambda| : \\lambda \\text{ is an eigenvalue of } E_{\\mathrm{TG}}\\}\n$$\n通过构建矩阵 $E_{\\mathrm{TG}}$ 然后找到其特征值，为每组参数 $(n, \\omega, \\nu_1, \\nu_2)$ 数值计算该值。\n\n实现将针对提供的每个测试案例精确地遵循这些步骤。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_spectral_radius(n, omega, nu1, nu2):\n    \"\"\"\n    Constructs the Two-Grid error-propagation operator and computes its spectral radius.\n\n    Args:\n        n (int): Number of interior grid points on the fine grid.\n        omega (float): Relaxation parameter for the weighted Jacobi smoother.\n        nu1 (int): Number of pre-smoothing steps.\n        nu2 (int): Number of post-smoothing steps.\n\n    Returns:\n        float: The spectral radius of the Two-Grid operator.\n    \"\"\"\n    # Step 1: Construct Fine-Grid Operator A\n    h = 1.0 / (n + 1)\n    diag_val = 2.0 / h**2\n    offdiag_val = -1.0 / h**2\n    \n    A = np.diag(np.full(n, diag_val))\n    A += np.diag(np.full(n - 1, offdiag_val), k=1)\n    A += np.diag(np.full(n - 1, offdiag_val), k=-1)\n\n    # Step 2: Construct Weighted Jacobi Smoother S\n    # D is diag(A), which is a constant diagonal matrix (diag_val * I).\n    # D_inv is (1/diag_val) * I = (h^2 / 2) * I.\n    # S = I - omega * D_inv @ A\n    S = np.identity(n) - omega * (h**2 / 2.0) * A\n\n    # Step 3: Construct Prolongation Operator P\n    n_c = n // 2\n    if n_c == 0:\n        # Trivial case: no coarse grid, so no correction. Factor is rho(S).\n        eigvals_S = np.linalg.eigvals(np.linalg.matrix_power(S, nu1 + nu2))\n        return np.max(np.abs(eigvals_S))\n        \n    P = np.zeros((n, n_c))\n    \n    # Using 0-based indexing for arrays. The problem statement gives a 1-based stencil.\n    # \"coarse grid variable at index j maps with weights 1/2, 1, 1/2\n    # to fine grid indices 2j-1, 2j, and 2j+1\"\n    # Translating to 0-based: coarse index j_c maps to fine indices\n    # 2*(j_c+1)-2 = 2*j_c, 2*(j_c+1)-1 = 2*j_c+1, 2*(j_c+1) = 2*j_c+2\n    for jc in range(n_c):\n        # Fine index 2*jc\n        if (2 * jc)  n:\n            P[2 * jc, jc] = 0.5\n        # Fine index 2*jc+1\n        if (2 * jc + 1)  n:\n            P[2 * jc + 1, jc] = 1.0\n        # Fine index 2*jc+2\n        if (2 * jc + 2)  n:\n            P[2 * jc + 2, jc] = 0.5\n            \n    # Step 4: Construct Restriction Operator R\n    R = 0.5 * P.T\n    \n    # Step 5: Construct Coarse-Grid Operator Ac\n    A_c = R @ A @ P\n    \n    # Step 6: Construct Two-Grid Error Propagation Operator E_TG\n    A_c_inv = np.linalg.inv(A_c)\n    \n    # Coarse-grid correction operator\n    CGC = np.identity(n) - P @ A_c_inv @ R @ A\n    \n    # Smoothing operators\n    S_pre = np.linalg.matrix_power(S, nu1)\n    S_post = np.linalg.matrix_power(S, nu2)\n    \n    E_tg = S_post @ CGC @ S_pre\n    \n    # Step 7: Compute Spectral Radius\n    eigenvalues = np.linalg.eigvals(E_tg)\n    spectral_radius = np.max(np.abs(eigenvalues))\n    \n    return spectral_radius\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: (n=31, omega=2/3, nu1=1, nu2=1)\n        (31, 2.0/3.0, 1, 1),\n        # Case 2: (n=3, omega=2/3, nu1=1, nu2=1)\n        (3, 2.0/3.0, 1, 1),\n        # Case 3: (n=63, omega=2/3, nu1=1, nu2=1)\n        (63, 2.0/3.0, 1, 1),\n        # Case 4: (n=31, omega=1/2, nu1=1, nu2=1)\n        (31, 0.5, 1, 1),\n        # Case 5: (n=31, omega=2/3, nu1=2, nu2=2)\n        (31, 2.0/3.0, 2, 2)\n    ]\n\n    results = []\n    for params in test_cases:\n        n, omega, nu1, nu2 = params\n        rho = compute_spectral_radius(n, omega, nu1, nu2)\n        results.append(rho)\n\n    # Final print statement in the exact required format.\n    # Format each result to exactly six decimal places.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "最后的练习将焦点转向并行计算的另一个关键策略：区域分解法。本练习  为经典的加性施瓦茨（Additive Schwarz）方法提供了一个实际的性能模型，突出了算法收敛速度与并行开销之间的核心权衡。通过对一个描述总求解时间的函数进行优化，以确定最佳的子区域重叠大小，您将体验到开发高效大规模科学计算程序时至关重要的性能工程分析。",
            "id": "3783303",
            "problem": "考虑一个对称正定线性系统，该系统由单位正方形上的泊松方程 $-\\nabla^{2} u = f$ 在齐次狄利克雷边界条件下，通过标准五点有限差分格式离散化得到。细网格间距为 $h$，区域被划分为一个 $8 \\times 8$ 的不重叠正方形子区域阵列，每个子区域的边长为 $H = 1/8$，因此 $H/h = 64$。在预条件共轭梯度 (PCG) 方法中，使用了一个两层的加性 Schwarz 区域分解 (ASDD) 预条件子。\n\n您可以使用以下广为接受的事实作为建模基础：\n\n- 在形状规则的划分和粗糙空间的标准假设下，ASDD 预条件算子的条件数 $\\kappa$ 在二维空间中其上界为\n$$\n\\kappa(\\delta) \\leq C_{\\mathrm{AS}} \\left( 1 + \\frac{H}{\\delta} \\right)^{2},\n$$\n其中 $\\delta$ 是物理重叠大小，$C_{\\mathrm{AS}}  0$ 是一个与网格无关的常数。\n- 对于应用于对称正定系统的 PCG 方法，将误差的某个固定范数减小一个指定因子所需的迭代次数 $n(\\delta)$ 满足如下关系\n$$\nn(\\delta) \\propto \\sqrt{\\kappa(\\delta)}.\n$$\n\n假设在并行系统上每次 PCG 迭代的执行时间模型如下：\n\n- 每次迭代的挂钟时间是基准成本和与重叠相关的成本之和，\n$$\nT_{\\mathrm{iter}}(\\delta) = A + B \\,\\frac{\\delta}{h},\n$$\n其中 $A  0$ 表示延迟和基础计算成本，$B  0$ 表示与细网格重叠层数成正比的带宽和额外计算成本。定义无量纲重叠为 $x = \\delta/h$（细网格层数）。\n\n对于一个固定的容差目标，总求解时间可以建模为（在不影响最小值点的情况下，可忽略一个总的正乘法常数）：\n$$\nT_{\\mathrm{tot}}(x) = \\left( 1 + \\frac{H/h}{x} \\right)\\, \\left( A + B x \\right),\n$$\n这体现了一种权衡关系：增加重叠 $x$ 会减小条件数（从而减少迭代次数），但会增加每次迭代的通信和计算量。\n\n给定 $H/h = 64$，$A = 0.005$ 秒，$B = 0.005$ 秒，确定在 $x > 0$ 的范围内使 $T_{\\mathrm{tot}}(x)$ 最小化的值 $x^{\\star}$。将您的最终答案表示为细网格重叠层数 $x^{\\star}$（无量纲）。如果结果是精确值，则无需四舍五-入；否则，将答案四舍五入到四位有效数字。",
            "solution": "该问题是有效的，提供了一个用于分析求解偏微分方程的并行区域分解方法的标准性能模型，可以形式化为一个标准的微积分优化问题。\n\n目标是找到在 $x  0$ 时使总求解时间函数 $T_{\\mathrm{tot}}(x)$ 最小化的值 $x^{\\star}$。该函数由下式给出：\n$$\nT_{\\mathrm{tot}}(x) = \\left( 1 + \\frac{H/h}{x} \\right) (A + Bx)\n$$\n给定参数为 $H/h = 64$，$A = 0.005$ 和 $B = 0.005$。将这些值代入 $T_{\\mathrm{tot}}(x)$ 的表达式中：\n$$\nT_{\\mathrm{tot}}(x) = \\left( 1 + \\frac{64}{x} \\right) (0.005 + 0.005x)\n$$\n为求此函数的最小值，我们首先求它关于 $x$ 的导数，然后将导数设为零以找到临界点。让我们展开 $T_{\\mathrm{tot}}(x)$ 的表达式：\n$$\nT_{\\mathrm{tot}}(x) = 1 \\cdot (A + Bx) + \\frac{H/h}{x} \\cdot (A + Bx)\n$$\n$$\nT_{\\mathrm{tot}}(x) = A + Bx + \\frac{A(H/h)}{x} + B(H/h)\n$$\n现在，我们计算 $T_{\\mathrm{tot}}(x)$ 关于 $x$ 的一阶导数：\n$$\n\\frac{d T_{\\mathrm{tot}}}{dx} = \\frac{d}{dx} \\left( A + Bx + \\frac{A(H/h)}{x} + B(H/h) \\right)\n$$\n项 $A$ 和 $B(H/h)$ 是常数，因此它们的导数为零。$Bx$ 的导数是 $B$。$A(H/h)x^{-1}$ 的导数是 $-A(H/h)x^{-2}$。因此，\n$$\n\\frac{d T_{\\mathrm{tot}}}{dx} = B - \\frac{A(H/h)}{x^2}\n$$\n为了找到临界点，我们将一阶导数设为零：\n$$\nB - \\frac{A(H/h)}{x^2} = 0\n$$\n$$\nB = \\frac{A(H/h)}{x^2}\n$$\n解出 $x^2$：\n$$\nx^2 = \\frac{A(H/h)}{B}\n$$\n现在，我们代入给定的数值 $A = 0.005$，$B = 0.005$ 和 $H/h = 64$：\n$$\nx^2 = \\frac{0.005 \\cdot 64}{0.005}\n$$\n$$\nx^2 = 64\n$$\n因为 $x$ 代表细网格重叠的层数，它必须是一个正数 ($x > 0$)。对两边取正平方根：\n$$\nx = \\sqrt{64} = 8\n$$\n因此，在定义域 $x > 0$ 内唯一的临界点是 $x = 8$。为了验证这对应一个最小值，我们使用二阶导数检验。我们计算 $T_{\\mathrm{tot}}(x)$ 的二阶导数：\n$$\n\\frac{d^2 T_{\\mathrm{tot}}}{dx^2} = \\frac{d}{dx} \\left( B - A(H/h)x^{-2} \\right) = -A(H/h)(-2)x^{-3} = \\frac{2A(H/h)}{x^3}\n$$\n由于 $A = 0.005 > 0$ 且 $H/h = 64 > 0$，二阶导数对于所有 $x > 0$ 都是正的。因此，函数 $T_{\\mathrm{tot}}(x)$ 在 $x = 8$ 处有一个全局最小值。\n\n使 $T_{\\mathrm{tot}}(x)$ 最小化的值 $x^{\\star}$ 是 $8$。这是一个精确的整数，因此无需四舍五入。",
            "answer": "$$\n\\boxed{8}\n$$"
        }
    ]
}