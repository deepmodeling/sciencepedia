{
    "hands_on_practices": [
        {
            "introduction": "将控制微分方程转化为计算机可以求解的代数方程组，是应用有限体积法的第一步。本练习将引导你对一个一维稳态扩散反应问题进行离散化，让你亲手构建线性方程组 $[A][\\Phi] = [b]$ 中的系数矩阵 $[A]$。通过这个实践，你将掌握将连续的物理定律转化为离散数学模型的核心技能，这是所有计算流体动力学分析的基础。",
            "id": "1749401",
            "problem": "考虑一个长度为 $L$ 的狭窄静止流体通道中化学物质的一维稳态输运。该物质的浓度用 $\\phi(x)$ 表示，由以下扩散方程控制：\n$$\n\\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right) + S = 0\n$$\n其中 $\\Gamma$ 是恒定的扩散系数。该物质发生一级化学反应，产生一个源/汇项 $S$，它是当地浓度的线性函数：\n$$\nS = S_C + S_P \\phi\n$$\n此处，$S_C$ 和 $S_P$ 是常系数。\n\n通道范围从 $x=0$ 到 $x=L$。边界上的浓度保持为已知的恒定值：$\\phi(0) = \\phi_A$ 和 $\\phi(L) = \\phi_B$。\n\n为了求解浓度分布，将计算域离散化为一个包含五个等间距节点（$x_0, x_1, x_2, x_3, x_4$）的均匀网格，其中 $x_0=0$ 且 $x_4=L$。三个内部节点处的浓度 $\\phi(x_1) \\equiv \\phi_1$、$\\phi(x_2) \\equiv \\phi_2$ 和 $\\phi(x_3) \\equiv \\phi_3$ 是未知的。\n\n对每个内部节点处的控制方程应用基于中心差分的有限体积法，会得到一个用于求解三个未知浓度的三元线性代数方程组。该方程组可以写成矩阵形式 $[A][\\Phi] = [b]$，其中 $[\\Phi]$ 是未知浓度的列向量，$[\\Phi] = \\begin{pmatrix} \\phi_1  \\phi_2  \\phi_3 \\end{pmatrix}^T$。\n\n确定 $3 \\times 3$ 的系数矩阵 $[A]$。你的答案应以 $\\Gamma$、$L$ 和 $S_P$ 表示。",
            "solution": "为了应用有限体积法，我们将控制方程在以节点 $i$ 为中心的控制体积（宽度为 $h=L/4$）上积分：\n$$\n\\int_{w}^{e} \\left( \\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right) + S \\right) dx = 0\n$$\n这得到通量平衡方程：\n$$\n\\left(\\Gamma \\frac{d\\phi}{dx}\\right)_e - \\left(\\Gamma \\frac{d\\phi}{dx}\\right)_w + \\int_{w}^{e} (S_C + S_P \\phi) dx = 0\n$$\n对于均匀网格，我们使用中心差分来近似界面梯度，并将源项在控制体积中心点 $\\phi_i$ 处求值：\n$$\n\\Gamma \\frac{\\phi_{i+1} - \\phi_i}{h} - \\Gamma \\frac{\\phi_i - \\phi_{i-1}}{h} + (S_C + S_P \\phi_i)h = 0\n$$\n整理方程，将未知数置于一侧，使其符合标准有限体积形式 $a_P \\phi_i = a_W \\phi_{i-1} + a_E \\phi_{i+1} + b'$：\n$$\n\\left(\\frac{2\\Gamma}{h} - S_P h\\right)\\phi_i = \\left(\\frac{\\Gamma}{h}\\right)\\phi_{i-1} + \\left(\\frac{\\Gamma}{h}\\right)\\phi_{i+1} - S_C h\n$$\n这个方程的系数为：\n$$\na_P = \\frac{2\\Gamma}{h} - S_P h, \\quad a_W = \\frac{\\Gamma}{h}, \\quad a_E = \\frac{\\Gamma}{h}.\n$$\n为了构建矩阵方程 $[A][\\Phi] = [b]$，我们将所有未知项移到左侧：$a_P \\phi_i - a_W \\phi_{i-1} - a_E \\phi_{i+1} = - S_C h$。因此，矩阵 $[A]$ 的对角元为 $a_P$，非对角元为 $-a_W$ 和 $-a_E$。\n\n代入 $h=L/4$：\n$$\na_P = \\frac{2\\Gamma}{L/4} - S_P\\frac{L}{4} = \\frac{8\\Gamma}{L} - \\frac{S_P L}{4}.\n$$\n$$\n-a_W = -a_E = -\\frac{\\Gamma}{L/4} = -\\frac{4\\Gamma}{L}.\n$$\n对于 $[\\Phi] = (\\phi_1,\\phi_2,\\phi_3)^{T}$ 的 $3 \\times 3$ 矩阵，边界项（涉及 $\\phi_0$ 和 $\\phi_4$）被移到右侧的向量 $[b]$ 中。因此，系数矩阵 $[A]$ 为：\n$$\n[A] =\n\\begin{pmatrix}\n\\frac{8\\Gamma}{L} - \\frac{S_P L}{4}   -\\frac{4\\Gamma}{L}   0 \\\\\n-\\frac{4\\Gamma}{L}   \\frac{8\\Gamma}{L} - \\frac{S_P L}{4}   -\\frac{4\\Gamma}{L} \\\\\n0   -\\frac{4\\Gamma}{L}   \\frac{8\\Gamma}{L} - \\frac{S_P L}{4}\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\n\\frac{8\\Gamma}{L} - \\frac{S_{P} L}{4}   -\\frac{4\\Gamma}{L}  0 \\\\\n-\\frac{4\\Gamma}{L}   \\frac{8\\Gamma}{L} - \\frac{S_{P} L}{4}  -\\frac{4\\Gamma}{L} \\\\\n0   -\\frac{4\\Gamma}{L}  \\frac{8\\Gamma}{L} - \\frac{S_{P} L}{4}\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "在成功地将一个问题离散化之后，评估我们所做近似的准确性变得至关重要。这个练习深入探讨了截断误差的概念，这是衡量数值解与真实解之间差异的关键指标。你将通过推导一个标准的扩散通量离散格式，并将其与特定温度分布下的精确通量进行比较，从而量化截断误差。这项技能对于评估和选择适用于特定物理问题的数值格式至关重要。",
            "id": "3964743",
            "problem": "针对一个导热系数 $k$ 恒定、横截面积 $A_f$ 均匀的均质板，提出了一个一维稳态热传导问题。在有限体积法 (FVM) 中，考虑两个相邻的有限体积控制体，标记为 $P$ 和 $N$，其中心分别位于 $x$ 轴上的 $x_P$ 和 $x_N$ 位置。$P$ 和 $N$ 之间的共享界面是平面 $f$，其单位法向量从 $P$ 指向 $N$。设中心线距离为 $d_{PN} = x_N - x_P  0$。存储在单元中心的局部温度值分别为 $T_P$ 和 $T_N$。假设温度仅在 $x$ 方向上变化，且网格是均匀的，因此面 $f$ 的位置为 $x_f = \\frac{x_P + x_N}{2}$。\n\n请从傅里叶热传导定律和通过一个面的扩散热通率的定义出发，推导通过面 $f$ 的离散扩散热通率。该离散值是通过在 $x_P$ 和 $x_N$ 之间沿中心线对温度进行线性插值得到的。然后，对于上述均匀网格上的精确温度场 $T(x) = x^2$，通过将此离散面通量与在 $x_f$ 处求值的精确面通量进行比较，来量化其截断误差。\n\n请将最终答案以一个双元素行矩阵的形式报告，其中：\n- 第一个元素是用 $k$、$A_f$、$T_P$、$T_N$ 和 $d_{PN}$ 表示的、通过面 $f$ 的推导出的离散扩散热通率。\n- 第二个元素是在上述均匀网格上，对于 $T(x) = x^2$ 的截断误差。\n\n热通率以瓦特为单位，但最终的方框答案内不应包含单位。无需进行数值取整；请提供精确的解析表达式。",
            "solution": "该问题陈述经核实具有科学依据、提法恰当且客观。它提出了计算热工学领域内一个标准的推导和分析任务，特别与有限体积法 (FVM) 相关。所有必要信息均已提供，问题没有矛盾或含糊之处。\n\n按照要求，解答分为两部分：首先，推导离散扩散热通率；其次，计算特定温度分布下的截断误差。\n\n第一部分：离散扩散热通率的推导\n\n此问题的基础是傅里叶热传导定律。对于一维系统，$x$ 方向的热通量 $q_x$（单位面积的热通率）与温度梯度的负值成正比：\n$$\nq_x = -k \\frac{dT}{dx}\n$$\n其中 $k$ 是材料的导热系数，$T$ 是温度。\n\n通过一个垂直于 $x$ 方向、横截面积均匀为 $A_f$ 的面 $f$ 的总扩散热通率 $\\dot{Q}_f$，由该面上的热通量与面面积的乘积给出：\n$$\n\\dot{Q}_f = q_{x,f} A_f = -k A_f \\left(\\frac{dT}{dx}\\right)_f\n$$\n这里，$\\left(\\frac{dT}{dx}\\right)_f$ 表示在面 $f$ 的位置 $x_f$ 处求得的精确温度梯度。\n\n在有限体积法中，连续温度场 $T(x)$ 由存储在控制体中心的离散值表示。控制体之间界面处的梯度必须使用这些离散节点值来近似。问题指明，温度应在分别位于 $x_P$ 和 $x_N$ 的单元中心 $P$ 和 $N$ 之间进行线性插值。\n\n线性插值意味着点 $P$ 和 $N$ 之间的温度梯度是恒定的，可以使用有限差分近似来计算。使用单元中心的温度 $T_P$ 和 $T_N$，插值出的线性分布的梯度为：\n$$\n\\left(\\frac{dT}{dx}\\right)_{\\text{approx}} = \\frac{T_N - T_P}{x_N - x_P}\n$$\n该近似用于计算位于 $P$ 和 $N$ 之间的面 $f$ 处的梯度。问题将中心线距离定义为 $d_{PN} = x_N - x_P$。将其代入梯度近似式，可得：\n$$\n\\left(\\frac{dT}{dx}\\right)_f \\approx \\frac{T_N - T_P}{d_{PN}}\n$$\n我们将这个梯度的离散近似代入热通率方程，以获得离散扩散热通率，我们将其记为 $\\dot{Q}_{f, \\text{disc}}$：\n$$\n\\dot{Q}_{f, \\text{disc}} = -k A_f \\left( \\frac{T_N - T_P}{d_{PN}} \\right)\n$$\n按照惯例，从高温区域流向低温区域的热流为正。面 $f$ 处的单位法向量从 $P$ 指向 $N$。因此，我们正在计算从 $P$ 到 $N$ 的热通率。如果 $T_P  T_N$，我们期望热通率为正值。为了使表达式与此物理惯例一致，我们可以写成：\n$$\n\\dot{Q}_{f, \\text{disc}} = k A_f \\frac{T_P - T_N}{d_{PN}}\n$$\n此表达式是所需答案的第一部分。\n\n第二部分：$T(x) = x^2$ 的截断误差\n\n截断误差定义为精确解析值与离散数值近似得到的值之间的差。对于面通量，截断误差 $E_T$ 为：\n$$\nE_T = \\dot{Q}_{f, \\text{exact}} - \\dot{Q}_{f, \\text{disc}}\n$$\n我们已知精确温度场为 $T(x) = x^2$。\n\n首先，我们计算精确热通率 $\\dot{Q}_{f, \\text{exact}}$。我们需要温度场的精确梯度：\n$$\n\\frac{dT}{dx} = \\frac{d}{dx}(x^2) = 2x\n$$\n在面位置 $x_f$ 处的精确梯度是：\n$$\n\\left(\\frac{dT}{dx}\\right)_f = 2x_f\n$$\n将此代入热通率方程，得到通过面 $f$ 的精确热通率：\n$$\n\\dot{Q}_{f, \\text{exact}} = -k A_f (2x_f)\n$$\n接下来，我们计算此特定温度分布下的离散热通率 $\\dot{Q}_{f, \\text{disc}}$。单元中心的温度为 $T_P = T(x_P) = x_P^2$ 和 $T_N = T(x_N) = x_N^2$。将这些值代入推导出的离散热通率表达式中：\n$$\n\\dot{Q}_{f, \\text{disc}} = k A_f \\frac{T_P - T_N}{d_{PN}} = k A_f \\frac{x_P^2 - x_N^2}{x_N - x_P}\n$$\n我们可以将分子中的项因式分解为平方差：$x_P^2 - x_N^2 = (x_P - x_N)(x_P + x_N) = -(x_N - x_P)(x_P + x_N)$。\n$$\n\\dot{Q}_{f, \\text{disc}} = k A_f \\frac{-(x_N - x_P)(x_P + x_N)}{x_N - x_P} = -k A_f (x_P + x_N)\n$$\n问题陈述网格是均匀的，因此面 $f$ 精确位于单元中心 $x_P$ 和 $x_N$ 的中点。这表示为 $x_f = \\frac{x_P + x_N}{2}$，意味着 $x_P + x_N = 2x_f$。\n\n将此关系代入我们关于 $\\dot{Q}_{f, \\text{disc}}$ 的表达式中：\n$$\n\\dot{Q}_{f, \\text{disc}} = -k A_f (2x_f)\n$$\n现在我们有了精确热通率和离散热通率的表达式：\n$$\n\\dot{Q}_{f, \\text{exact}} = -k A_f (2x_f)\n$$\n$$\n\\dot{Q}_{f, \\text{disc}} = -k A_f (2x_f)\n$$\n这两个表达式是相同的。因此，截断误差为：\n$$\nE_T = \\dot{Q}_{f, \\text{exact}} - \\dot{Q}_{f, \\text{disc}} = (-k A_f (2x_f)) - (-k A_f (2x_f)) = 0\n$$\n截断误差恰好为零。这个结果是预料之中的，因为用于梯度的数值格式（在均匀网格上进行线性插值并在中点求值）是一个二阶中心差分格式。对于一阶导数 $f'(x)$ 的中心差分近似，其截断误差的主导项与三阶导数 $f'''(x)$ 成正比。对于给定的温度分布 $T(x) = x^2$，其三阶导数为 $T'''(x) = 0$，这导致主导误差项和所有更高阶的项都消失。因此，该近似对于次数为2或更低的多项式是精确的。\n\n最终答案由两个推导出的量组成。\n- 第一个元素：离散扩散热通率，$\\dot{Q}_{f, \\text{disc}} = k A_f \\frac{T_P - T_N}{d_{PN}}$。\n- 第二个元素：截断误差，$E_T = 0$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nk A_f \\frac{T_P - T_N}{d_{PN}}  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "一个直观上合理的数值格式在特定的物理条件下可能会失效，从而产生非物理的、错误的解。本练习探讨了计算流体动力学中一个经典的警示案例：中心差分格式在处理高佩克莱数（$Pe$）的对流主导问题时的局限性。你将通过分析离散方程的特征，发现并量化导致非物理振荡的根本原因，从而深刻理解数值稳定性在模拟对流输运现象中的核心重要性。",
            "id": "3818511",
            "problem": "考虑区间 $[0,L]$ 上具有恒定材料性质的一维稳态对流-扩散方程，\n$$\\frac{d}{dx}\\Big(\\Gamma \\frac{d\\phi}{dx}\\Big) - \\rho u \\frac{d\\phi}{dx} = 0,$$\n该方程服从狄利克雷边界条件 $\\phi(0) = 1$ 和 $\\phi(L) = 0$，其中 $\\Gamma$ 是扩散系数，$\\rho$ 是密度，$u  0$ 是均匀速度。假设一个由宽度为 $\\Delta x$、横截面积恒为 $A$ 的控制体积组成的均匀网格。令 $D = \\Gamma A / \\Delta x$ 表示扩散导率，$F = \\rho u A$ 表示对流质量通量。无量纲佩克莱数定义为 $\\mathrm{Pe} = F / D$。\n\n使用有限体积法（FVM），通过在内部控制体积上强制西面和东面的扩散通量和对流通量守恒来离散化该方程。对于扩散通量，使用标准的两点近似。对于对流通量，对面值使用中心插值。推导控制均匀网格上内部单元值 $\\phi_i$ 的齐次线性递推关系，并分析其特征因子。然后，通过计算 $\\mathrm{Pe} = 4$ 时的非平凡特征因子，提供一个对应于高佩克莱数情况的具体反例。\n\n将此特征因子的值报告为一个纯数字。无需四舍五入。",
            "solution": "由于 $\\rho$ 和 $u$ 是常数，控制方程可以写成守恒形式：\n$$\\frac{d}{dx}\\Big(\\Gamma \\frac{d\\phi}{dx}\\Big) - \\frac{d}{dx}(\\rho u \\phi) = 0.$$\n在有限体积法（FVM）中，我们将此方程在一个以节点 $i$ 为中心的控制体积上积分，得到净通量为零：\n$$ \\left( \\Gamma A \\frac{d\\phi}{dx} - \\rho u A \\phi \\right)_e - \\left( \\Gamma A \\frac{d\\phi}{dx} - \\rho u A \\phi \\right)_w = 0 $$\n扩散通量项的离散化为：\n$$ \\left(\\Gamma A \\frac{d\\phi}{dx}\\right)_e - \\left(\\Gamma A \\frac{d\\phi}{dx}\\right)_w \\approx D(\\phi_{i+1} - \\phi_i) - D(\\phi_i - \\phi_{i-1}) = D(\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}) $$\n其中 $D = \\Gamma A/\\Delta x$ 是扩散导率。对流通量项的离散化，使用中心插值计算面值 $\\phi_e \\approx (\\phi_i + \\phi_{i+1})/2$ 和 $\\phi_w \\approx (\\phi_{i-1} + \\phi_i)/2$：\n$$ (\\rho u A \\phi)_e - (\\rho u A \\phi)_w \\approx F\\frac{\\phi_i + \\phi_{i+1}}{2} - F\\frac{\\phi_{i-1} + \\phi_i}{2} = \\frac{F}{2}(\\phi_{i+1} - \\phi_{i-1}) $$\n其中 $F = \\rho u A$ 是对流质量通量。将离散的扩散和对流通量代入通量平衡方程：\n$$ D(\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}) - \\frac{F}{2}(\\phi_{i+1} - \\phi_{i-1}) = 0 $$\n整理后，我们得到齐次线性递推关系：\n$$(D + \\frac{F}{2})\\phi_{i-1} - 2D\\,\\phi_i + (D - \\frac{F}{2})\\phi_{i+1} = 0.$$\n为了方便，将 $\\phi_{i+1}$ 用 $\\phi_i$ 和 $\\phi_{i-1}$ 表示：\n$$(D - \\frac{F}{2})\\phi_{i+1} = 2D\\,\\phi_i - (D + \\frac{F}{2})\\phi_{i-1},$$\n$$\\phi_{i+1} = \\frac{2D}{D - \\frac{F}{2}}\\,\\phi_i - \\frac{D + \\frac{F}{2}}{D - \\frac{F}{2}}\\,\\phi_{i-1}.$$\n引入无量纲参数\n$$r = \\frac{F}{2D} = \\frac{\\mathrm{Pe}}{2},$$\n可写作\n$$\\phi_{i+1} = \\frac{2}{1 - r}\\,\\phi_i - \\frac{1 + r}{1 - r}\\,\\phi_{i-1}.$$\n假设一个形如 $\\phi_i = z^i$ 的模，特征方程为\n$$z^2 - \\frac{2}{1 - r}z + \\frac{1 + r}{1 - r} = 0.$$\n判别式为\n$$\\Delta = \\left(\\frac{2}{1 - r}\\right)^2 - 4\\frac{1 + r}{1 - r} = \\frac{4}{(1 - r)^2} - \\frac{4(1 + r)(1 - r)}{(1 - r)^2} = \\frac{4 - 4(1 - r^2)}{(1 - r)^2} = \\frac{4r^2}{(1 - r)^2},$$\n所以两个特征因子是\n$$z = \\frac{\\frac{2}{1 - r} \\pm \\frac{2r}{1 - r}}{2} = \\frac{1 \\pm r}{1 - r}.$$\n因此，\n$$z_1 = \\frac{1 + r}{1 - r}, \\qquad z_2 = 1.$$\n因子 $z_2 = 1$ 对应于中性模，而 $z_1$ 是非平凡模，由所选中心插值下的对流与扩散相互作用决定。对于高佩克莱数，即 $r = \\mathrm{Pe}/2 > 1$，分母 $1 - r$ 为负， $z_1$ 变为负值，这预示着离散解中会出现非物理振荡（符号交替行为）。\n\n为了提供一个具体反例，设 $\\mathrm{Pe} = 4$，这意味着 $r = \\mathrm{Pe}/2 = 2$。那么\n$$z_1 = \\frac{1 + r}{1 - r} = \\frac{1 + 2}{1 - 2} = \\frac{3}{-1} = -3.$$\n这个负特征因子展示了在高佩克莱数下中心通量离散化的非单调性，并解释了离散解中非物理振荡的出现。",
            "answer": "$$\\boxed{-3}$$"
        }
    ]
}