{
    "hands_on_practices": [
        {
            "introduction": "将偏微分控制方程转化为代数方程组是有限体积法的核心步骤。本练习将通过一个简单的一维稳态扩散-反应问题，带你实践如何离散控制方程并组装系数矩阵。掌握这一基本技能是使用有限体积法求解任何物理场问题的基础。",
            "id": "1749401",
            "problem": "考虑一个长度为 $L$ 的狭窄静止流体通道中，某种化学物质的一维稳态输运。该物质的浓度记为 $\\phi(x)$，由以下扩散方程控制：\n$$\n\\frac{d}{dx}\\left(\\Gamma \\frac{d\\phi}{dx}\\right) + S = 0\n$$\n其中 $\\Gamma$ 是常数扩散系数。该物质经历一级化学反应，产生一个源/汇项 $S$，它是当地浓度的线性函数：\n$$\nS = S_C + S_P \\phi\n$$\n这里，$S_C$ 和 $S_P$ 是常系数。\n\n通道从 $x=0$ 延伸到 $x=L$。边界上的浓度保持为已知的恒定值：$\\phi(0) = \\phi_A$ 和 $\\phi(L) = \\phi_B$。\n\n为了求解浓度分布，将计算域离散化为一个包含五个等距节点的均匀网格：$x_0, x_1, x_2, x_3, x_4$，其中 $x_0=0$ 且 $x_4=L$。三个内部节点处的浓度 $\\phi(x_1) \\equiv \\phi_1$、$\\phi(x_2) \\equiv \\phi_2$ 和 $\\phi(x_3) \\equiv \\phi_3$ 是未知的。\n\n对每个内部节点处的控制方程应用基于中心差分的有限体积法，会得到一个关于三个未知浓度的三元线性代数方程组。该方程组可以写成矩阵形式 $[A][\\Phi] = [b]$，其中 $[\\Phi]$ 是未知浓度的列向量，$[\\Phi] = \\begin{pmatrix} \\phi_1 \\\\ \\phi_2 \\\\ \\phi_3 \\end{pmatrix}$。\n\n确定 $3 \\times 3$ 的系数矩阵 $[A]$。您的答案应以 $\\Gamma$、$L$ 和 $S_P$ 表示。",
            "solution": "扩散系数为常数时，控制方程为\n$$\n\\Gamma \\frac{d^{2}\\phi}{dx^{2}} + S_C + S_P \\phi = 0.\n$$\n将计算域离散化为五个等距节点，间距为 $h = \\frac{L}{4}$。对围绕内部节点 $i \\in \\{1,2,3\\}$、宽度为 $h$ 的控制体使用有限体积法，将方程在控制体上积分，并用中心差分近似面上的梯度：\n$$\n\\Gamma \\left[\\left.\\frac{d\\phi}{dx}\\right|_{e} - \\left.\\frac{d\\phi}{dx}\\right|_{w}\\right] + S_P \\phi_i h + S_C h = 0,\n$$\n其中\n$$\n\\left.\\frac{d\\phi}{dx}\\right|_{e} \\approx \\frac{\\phi_{i+1} - \\phi_i}{h}, \\qquad \\left.\\frac{d\\phi}{dx}\\right|_{w} \\approx \\frac{\\phi_i - \\phi_{i-1}}{h}.\n$$\n将这些代入平衡方程，得到\n$$\n\\Gamma \\left[\\frac{\\phi_{i+1} - \\phi_i}{h} - \\frac{\\phi_i - \\phi_{i-1}}{h}\\right] + S_P \\phi_i h + S_C h = 0,\n$$\n化简后得到\n$$\n\\frac{\\Gamma}{h}\\phi_{i-1} + \\left(-\\frac{2\\Gamma}{h} + S_P h\\right)\\phi_i + \\frac{\\Gamma}{h}\\phi_{i+1} = - S_C h.\n$$\n整理成标准线性系统形式 $[A][\\Phi]=[b]$，将相邻项移到左侧，将常数源项和边界贡献移到右侧。任意内部节点的有限体积系数为\n$$\na_W = \\frac{\\Gamma}{h}, \\qquad a_E = \\frac{\\Gamma}{h}, \\qquad a_P = \\frac{2\\Gamma}{h} - S_P h.\n$$\n对于作用于 $[\\Phi] = (\\phi_1,\\phi_2,\\phi_3)^{T}$ 的 $3 \\times 3$ 矩阵，各行对应于节点 $i=1,2,3$。对于 $i=1$，西侧相邻节点是边界节点 $\\phi_0=\\phi_A$（已移至右侧），因此左侧只出现 $\\phi_1$ 和 $\\phi_2$。对于 $i=2$，两个相邻节点都是未知数。对于 $i=3$，东侧相邻节点是边界节点 $\\phi_4=\\phi_B$（已移至右侧）。代入 $h=\\frac{L}{4}$ 得到\n$$\na_W = a_E = \\frac{\\Gamma}{h} = \\frac{4\\Gamma}{L}, \\qquad a_P = \\frac{2\\Gamma}{h} - S_P h = \\frac{8\\Gamma}{L} - \\frac{S_P L}{4}.\n$$\n因此，系数矩阵为\n$$\n[A] =\n\\begin{pmatrix}\n\\frac{8\\Gamma}{L} - \\frac{S_P L}{4}  -\\frac{4\\Gamma}{L}  0 \\\\\n-\\frac{4\\Gamma}{L}  \\frac{8\\Gamma}{L} - \\frac{S_P L}{4}  -\\frac{4\\Gamma}{L} \\\\\n0  -\\frac{4\\Gamma}{L}  \\frac{8\\Gamma}{L} - \\frac{S_P L}{4}\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\n\\frac{8\\Gamma}{L} - \\frac{S_{P} L}{4}  -\\frac{4\\Gamma}{L}  0 \\\\\n-\\frac{4\\Gamma}{L}  \\frac{8\\Gamma}{L} - \\frac{S_{P} L}{4}  -\\frac{4\\Gamma}{L} \\\\\n0  -\\frac{4\\Gamma}{L}  \\frac{8\\Gamma}{L} - \\frac{S_{P} L}{4}\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "在扩散问题的基础上，我们引入对流项，这在流体力学中至关重要，但同时也带来了数值上的挑战。本练习旨在揭示一个看似直接的离散格式（中心差分）为何会在对流主导的情况下（即高佩克莱数, $\\mathrm{Pe}$）导致非物理的数值振荡。通过这个练习，你将深刻理解为保证数值解的物理真实性，选择与问题物理特性相适应的离散格式是多么重要。",
            "id": "3818511",
            "problem": "考虑在区间 $[0,L]$ 上具有恒定材料属性的一维稳态对流扩散方程，\n$$\\frac{d}{dx}\\Big(\\Gamma \\frac{d\\phi}{dx}\\Big) - \\rho u \\frac{d\\phi}{dx} = 0,$$\n其边界条件为狄利克雷边界条件 $\\phi(0) = 1$ 和 $\\phi(L) = 0$，其中 $\\Gamma$ 是扩散系数，$\\rho$ 是密度，$u > 0$ 是均匀速度。假设使用宽度为 $\\Delta x$、横截面积为常数 $A$ 的均匀控制体网格。令 $D = \\Gamma A / \\Delta x$ 表示扩散导度，$F = \\rho u A$ 表示对流质量通量。无量纲佩克莱数定义为 $\\mathrm{Pe} = F / D$。\n\n使用有限体积法 (FVM)，通过在内部控制体的西面和东面强制扩散通量和对流通量守恒，来离散化该方程。对于扩散通量，使用标准的两点近似。对于对流通量，使用中心插值计算面上的值。推导控制均匀网格上内部单元值 $\\phi_i$ 的齐次线性递推关系，并分析其特征因子。然后，通过计算 $\\mathrm{Pe} = 4$ 时的非平凡特征因子，提供一个对应于高佩克莱数情况的具体反例。\n\n将此特征因子的值报告为一个纯数。无需四舍五入。",
            "solution": "具有恒定系数的控制稳态一维对流扩散方程为\n$$\\frac{d}{dx}\\Big(\\Gamma \\frac{d\\phi}{dx}\\Big) - \\rho u \\frac{d\\phi}{dx} = 0.$$\n在有限体积法 (FVM) 中，我们将此方程在以索引 $i$ 为中心、面位于 $x_{w}$ 和 $x_{e}$ 的控制体上积分，应用散度定理，并强制稳态下通过这些面的净通量为零：\n$$\\underbrace{\\Big[-\\Gamma A \\frac{d\\phi}{dx}\\Big]_{w}^{e}}_{\\text{扩散通量}} + \\underbrace{\\Big[\\rho u A \\,\\phi\\Big]_{w}^{e}}_{\\text{对流通量}} = 0.$$\n在间距为 $\\Delta x$ 的均匀网格上，对面上的扩散通量的标准两点近似给出\n$$\\Big[-\\Gamma A \\frac{d\\phi}{dx}\\Big]_{w}^{e} \\approx -\\Gamma A \\frac{\\phi_{i+1} - \\phi_i}{\\Delta x} - \\Big(-\\Gamma A \\frac{\\phi_i - \\phi_{i-1}}{\\Delta x}\\Big) = \\Gamma A \\frac{\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}}{\\Delta x} = D(\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}),$$\n其中 $D = \\Gamma A/\\Delta x$ 是扩散导度。对于对流通量，使用中心插值计算面上的值，\n$$\\phi_w \\approx \\frac{\\phi_{i-1} + \\phi_i}{2}, \\qquad \\phi_e \\approx \\frac{\\phi_i + \\phi_{i+1}}{2},$$\n且质量通量为 $F = \\rho u A$，因此净对流贡献为\n$$\\Big[\\rho u A \\,\\phi\\Big]_{w}^{e} \\approx F\\left(\\frac{\\phi_{i-1} + \\phi_i}{2} - \\frac{\\phi_i + \\phi_{i+1}}{2}\\right) = \\frac{F}{2}(\\phi_{i-1} - \\phi_{i+1}).$$\n对内部控制体 $i$ 施加通量平衡，得到\n$$D(\\phi_{i-1} - 2\\phi_i + \\phi_{i+1}) + \\frac{F}{2}(\\phi_{i-1} - \\phi_{i+1}) = 0.$$\n整理后，我们得到齐次线性递推关系\n$$(D + \\frac{F}{2})\\phi_{i-1} - 2D\\,\\phi_i + (D - \\frac{F}{2})\\phi_{i+1} = 0.$$\n将 $\\phi_{i+1}$ 用 $\\phi_i$ 和 $\\phi_{i-1}$ 表示会很方便：\n$$(D - \\frac{F}{2})\\phi_{i+1} = 2D\\,\\phi_i - (D + \\frac{F}{2})\\phi_{i-1},$$\n$$\\phi_{i+1} = \\frac{2D}{D - \\frac{F}{2}}\\,\\phi_i - \\frac{D + \\frac{F}{2}}{D - \\frac{F}{2}}\\,\\phi_{i-1}.$$\n引入无量纲参数\n$$r = \\frac{F}{2D} = \\frac{\\mathrm{Pe}}{2},$$\n来写出\n$$\\phi_{i+1} = \\frac{2}{1 - r}\\,\\phi_i - \\frac{1 + r}{1 - r}\\,\\phi_{i-1}.$$\n假设一个形如 $\\phi_i = z^i$ 的模态，其特征方程为\n$$z^2 - \\frac{2}{1 - r}z + \\frac{1 + r}{1 - r} = 0.$$\n判别式为\n$$\\Delta = \\left(\\frac{2}{1 - r}\\right)^2 - 4\\frac{1 + r}{1 - r} = \\frac{4}{(1 - r)^2} - \\frac{4(1 + r)}{1 - r} = \\frac{4 - 4(1 - r^2)}{(1 - r)^2} = \\frac{4r^2}{(1 - r)^2},$$\n因此两个特征因子是\n$$z = \\frac{\\frac{2}{1 - r} \\pm \\frac{2r}{1 - r}}{2} = \\frac{1 \\pm r}{1 - r}.$$\n因此，\n$$z_1 = \\frac{1 + r}{1 - r}, \\qquad z_2 = 1.$$\n因子 $z_2 = 1$ 对应于中性模态，而 $z_1$ 是在所选中心插值下由对流和扩散相互作用控制的非平凡模态。对于高佩克莱数，有 $r = \\mathrm{Pe}/2 > 1$，分母 $1 - r$ 为负，且 $z_1$ 变为负值，这预示着离散解中会出现非物理振荡（符号交替行为）。\n\n为了提供一个具体的反例，设 $\\mathrm{Pe} = 4$，这意味着 $r = \\mathrm{Pe}/2 = 2$。于是\n$$z_1 = \\frac{1 + r}{1 - r} = \\frac{1 + 2}{1 - 2} = \\frac{3}{-1} = -3.$$\n这个负的特征因子展示了高佩克莱数下中心通量离散格式的非单调性，并解释了离散解中非物理振荡的出现。",
            "answer": "$$\\boxed{-3}$$"
        },
        {
            "introduction": "真实世界的工程问题往往涉及复杂几何，需要使用非结构网格。本练习将带你从简单的一维均匀网格，迈向更通用、更实际的多维非结构网格问题，解决从离散的单元中心值重构梯度 $\\nabla \\phi_i$ 这一核心任务。理解基于最小二乘法的梯度重构过程及其数值条件数，对于开发能够处理复杂几何的稳健有限体积法程序至关重要。",
            "id": "3818526",
            "problem": "考虑一个定义在二维域上的标量场 $\\phi(\\boldsymbol{x})$，该域通过以单元为中心的有限体积法（FVM）进行离散化。设单元 $i$ 的几何中心为 $\\boldsymbol{x}_i \\in \\mathbb{R}^{2}$，其相邻单元集合的索引为 $\\mathcal{N}(i)$，中心为 $\\boldsymbol{x}_j$，并记 $\\boldsymbol{r}_{ij} = \\boldsymbol{x}_j - \\boldsymbol{x}_i$。假设可用的离散数据是单元中心值 $\\phi_j$（其中 $j \\in \\{i\\} \\cup \\mathcal{N}(i)$），并且局部光滑性允许在 $\\boldsymbol{x}_i$ 处对 $\\phi$ 进行一阶泰勒展开。\n\n以泰勒展开为基本出发点，利用相邻单元的值在单元 $i$ 处构造一个最小二乘梯度重构 $\\nabla \\phi_i$。具体来说，定义一个加权最小二乘（WLS）目标函数，该函数惩罚线性化差分 $\\nabla \\phi_i \\cdot \\boldsymbol{r}_{ij}$ 与观测差分 $\\phi_j - \\phi_i$ 之间的不匹配，其中对角权重 $w_{ij} > 0$。推导最小化子的正规方程，并用 $\\{\\boldsymbol{r}_{ij}\\}$、$\\{\\phi_j - \\phi_i\\}$ 和 $\\{w_{ij}\\}$ 显式表示 $\\nabla \\phi_i$。\n\n然后，通过考虑对称正定正规矩阵的 2-范数条件数，分析在不规则网格上所得正规方程的条件性。对于一个二维空间中具有相等权重 $w_{ij} = 1$ 的特定不规则构型，设相邻偏移量为\n$\\boldsymbol{r}_{i1} = (1, 0)$、$\\boldsymbol{r}_{i2} = (-1, 0)$ 和 $\\boldsymbol{r}_{i3} = (0, 0.2)$。计算此构型下正规矩阵的 2-范数条件数，其定义为最大特征值与最小特征值之比。将最终答案表示为单个实数。无需四舍五入，最终答案中不应使用单位。",
            "solution": "目标是在局部光滑性假设下，在以单元为中心的有限体积法（FVM）中，利用相邻单元的值重构梯度 $\\nabla \\phi_i$。基本出发点是在 $\\boldsymbol{x}_i$ 处对 $\\phi$ 进行的一阶泰勒展开：\n$$\n\\phi(\\boldsymbol{x}_j) \\approx \\phi(\\boldsymbol{x}_i) + \\nabla \\phi(\\boldsymbol{x}_i) \\cdot (\\boldsymbol{x}_j - \\boldsymbol{x}_i) = \\phi_i + \\nabla \\phi_i \\cdot \\boldsymbol{r}_{ij},\n$$\n其中 $\\phi_i$ 表示 $\\phi(\\boldsymbol{x}_i)$，$\\phi_j$ 同理。整理可得相邻差分的线性代理模型：\n$$\n\\phi_j - \\phi_i \\approx \\nabla \\phi_i \\cdot \\boldsymbol{r}_{ij}.\n$$\n\n为了构造一个加权最小二乘（WLS）估计量，将每个相邻单元 $j \\in \\mathcal{N}(i)$ 的残差定义为\n$$\n\\varepsilon_{ij}(\\nabla \\phi_i) = \\nabla \\phi_i \\cdot \\boldsymbol{r}_{ij} - (\\phi_j - \\phi_i).\n$$\n设 $w_{ij} > 0$ 为给定的对角权重，这些权重可以编码几何或多尺度因素（例如，面面积、距离或局部各向异性）。WLS 目标函数为\n$$\nJ(\\nabla \\phi_i) = \\sum_{j \\in \\mathcal{N}(i)} w_{ij} \\left( \\nabla \\phi_i \\cdot \\boldsymbol{r}_{ij} - (\\phi_j - \\phi_i) \\right)^{2}.\n$$\n引入矩阵-向量表示法。在二维空间中，将未知梯度写成列向量\n$$\n\\boldsymbol{g}_i = \\begin{pmatrix} g_x \\\\ g_y \\end{pmatrix} = \\nabla \\phi_i.\n$$\n定义设计矩阵 $A \\in \\mathbb{R}^{m \\times 2}$（其中 $m = |\\mathcal{N}(i)|$），其第 $j$ 行为 $\\boldsymbol{r}_{ij}^{\\top}$：\n$$\nA = \\begin{pmatrix} \\boldsymbol{r}_{i1}^{\\top} \\\\ \\boldsymbol{r}_{i2}^{\\top} \\\\ \\vdots \\\\ \\boldsymbol{r}_{im}^{\\top} \\end{pmatrix}.\n$$\n定义数据差分向量 $b \\in \\mathbb{R}^{m}$，其第 $j$ 个元素为 $\\phi_j - \\phi_i$：\n$$\nb = \\begin{pmatrix} \\phi_1 - \\phi_i \\\\ \\phi_2 - \\phi_i \\\\ \\vdots \\\\ \\phi_m - \\phi_i \\end{pmatrix}.\n$$\n设 $W \\in \\mathbb{R}^{m \\times m}$ 为一个对角矩阵，其对角元为 $W_{jj} = w_{ij}$。目标函数可以写成\n$$\nJ(\\boldsymbol{g}_i) = \\left\\| W^{1/2} (A \\boldsymbol{g}_i - b) \\right\\|_{2}^{2}.\n$$\n通过将 $J$ 对 $\\boldsymbol{g}_i$ 的梯度设为零，可以得到最小化子的正规方程：\n$$\n\\nabla_{\\boldsymbol{g}_i} J = 2 A^{\\top} W (A \\boldsymbol{g}_i - b) = \\boldsymbol{0}.\n$$\n因此，正规方程为\n$$\nA^{\\top} W A \\, \\boldsymbol{g}_i = A^{\\top} W b.\n$$\n假设 $A$ 具有满列秩（即相邻偏移量 $\\{\\boldsymbol{r}_{ij}\\}$ 张成 $\\mathbb{R}^{2}$）且 $W$ 是正对角阵，则对称矩阵 $A^{\\top} W A$ 是正定且可逆的。则显式的 WLS 梯度重构为\n$$\n\\boldsymbol{g}_i = (A^{\\top} W A)^{-1} A^{\\top} W b.\n$$\n\n为了分析条件性，注意到正规方程的条件性由对称正定矩阵决定\n$$\nM := A^{\\top} W A = \\sum_{j \\in \\mathcal{N}(i)} w_{ij} \\, \\boldsymbol{r}_{ij} \\boldsymbol{r}_{ij}^{\\top}.\n$$\n在二维空间中，为简洁起见，记 $\\boldsymbol{r}_{ij} = (x_j, y_j)$。则\n$$\nM = \\begin{pmatrix}\n\\sum_{j} w_{ij} x_j^{2}  \\sum_{j} w_{ij} x_j y_j \\\\\n\\sum_{j} w_{ij} x_j y_j  \\sum_{j} w_{ij} y_j^{2}\n\\end{pmatrix} = \\begin{pmatrix}\nS_{xx}  S_{xy} \\\\\nS_{xy}  S_{yy}\n\\end{pmatrix}.\n$$\n$M$ 的 2-范数条件数为\n$$\n\\kappa_{2}(M) = \\frac{\\lambda_{\\max}(M)}{\\lambda_{\\min}(M)},\n$$\n其中 $\\lambda_{\\max}(M)$ 和 $\\lambda_{\\min}(M)$ 分别是 $M$ 的最大和最小特征值。对于 $2 \\times 2$ 的对称矩阵，特征值可以用矩阵的迹和行列式表示：\n$$\n\\lambda_{\\pm} = \\frac{\\operatorname{tr}(M) \\pm \\sqrt{\\operatorname{tr}(M)^{2} - 4 \\det(M)}}{2}.\n$$\n网格的不规则性和各向异性体现在相邻偏移量 $\\boldsymbol{r}_{ij}$ 的分布上。如果这些偏移量沿某条直线聚集，或在正交方向上的大小高度不平衡，那么 $S_{xx}$ 或 $S_{yy}$ 中的一个（或当 $S_{xy} \\neq 0$ 时的某个适当旋转后的变体）会变小，这会使 $\\lambda_{\\min}(M)$趋向于零，从而增大 $\\kappa_{2}(M)$，导致正规方程的条件性变差，梯度重构变得敏感。\n\n现在我们计算在给定权重 $w_{ij} = 1$ 且相邻偏移量为\n$$\n\\boldsymbol{r}_{i1} = (1, 0), \\quad \\boldsymbol{r}_{i2} = (-1, 0), \\quad \\boldsymbol{r}_{i3} = (0, 0.2)\n$$\n的情况下 $\\kappa_{2}(M)$ 的值。\n计算各项和：\n$$\nS_{xx} = 1^{2} + (-1)^{2} + 0^{2} = 2, \\quad S_{yy} = 0^{2} + 0^{2} + (0.2)^{2} = 0.04, \\quad S_{xy} = (1)(0) + (-1)(0) + (0)(0.2) = 0.\n$$\n因此\n$$\nM = \\begin{pmatrix} 2  0 \\\\ 0  0.04 \\end{pmatrix}.\n$$\n由于 $M$ 是对角矩阵，其特征值即为对角线上的元素：\n$$\n\\lambda_{\\max}(M) = 2, \\quad \\lambda_{\\min}(M) = 0.04.\n$$\n因此，2-范数条件数为\n$$\n\\kappa_{2}(M) = \\frac{2}{0.04} = 50.\n$$\n这个较大的值反映了相邻偏移量中显著的各向异性，即在 $x$ 方向采样强，而在 $y$ 方向采样弱。这是不规则网格方向覆盖性差的典型表现，并导致用于梯度重构的正规方程组是病态的。",
            "answer": "$$\\boxed{50}$$"
        }
    ]
}