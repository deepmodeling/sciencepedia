{
    "hands_on_practices": [
        {
            "introduction": "A fundamental challenge in numerical simulations is balancing accuracy, stability, and computational cost. This first exercise provides a classic yet essential analysis of this trade-off for the explicit finite difference discretization of the heat equation . By deriving the stringent stability condition relating the time step $\\Delta t$ to the spatial step $h$, you will see firsthand how stability constraints can dominate the computational budget and influence the optimal strategy for error reduction.",
            "id": "3750560",
            "problem": "Consider the one-dimensional heat equation on a bounded interval with homogeneous Dirichlet boundary conditions,\n$$\nu_{t} = \\kappa\\,u_{xx}, \\quad x \\in (0,L), \\quad t \\in (0,T], \\qquad u(0,t)=u(L,t)=0,\\qquad u(x,0)=u_{0}(x)\n$$\nwhere $\\kappa>0$, $L>0$, and $T>0$. Discretize $(0,L)$ by a uniform grid with spacing $h$ and approximate $u_{xx}$ by the standard second-order central difference. Advance in time with the forward (explicit) Euler method with time step $\\Delta t$. Denote by $u_{i}^{n}$ the numerical solution at grid point $x_{i}=i h$ and time $t_{n}=n\\,\\Delta t$.\n\na) Starting from the linear constant-coefficient ordinary differential equation model for Fourier modes of the discrete Laplacian and the forward Euler stability condition for the scalar test problem $y'=\\lambda y$, use von Neumann analysis to derive the largest stable time step in terms of $h$ and $\\kappa$. Show that there exists a constant $C>0$ such that the scheme is stable only if\n$$\n\\Delta t \\le C\\,h^{2},\n$$\nand identify the sharp constant $C$ in this setting.\n\nb) Suppose the exact solution $u$ is sufficiently smooth so that the global error at time $T$ in the $L^{2}(0,L)$ norm satisfies the asymptotic bound\n$$\n\\|u(\\cdot,T)-u_{h}^{N}\\|_{L^{2}(0,L)} \\approx C_{s}\\,h^{2} + C_{t}\\,\\Delta t,\n$$\nfor small $h$ and $\\Delta t$, where $C_{s}>0$ and $C_{t}>0$ depend on derivatives of $u$ and on $T$ but not on $h$ or $\\Delta t$, and $N=T/\\Delta t$.\n\nAssume a computational budget measured by the total number of degree-of-freedom updates,\n$$\nB = \\gamma \\,\\frac{T}{\\Delta t}\\,\\frac{L}{h},\n$$\nwith a known constant $\\gamma>0$ representing a problem-independent per-update cost. To maximize accuracy under the budget constraint, you decide to operate at the explicit stability threshold found in part (a), i.e., you choose $\\Delta t$ equal to the largest value that still satisfies stability for a given $h$.\n\nUnder these assumptions, optimize over $h$ subject to the budget constraint and the stability threshold choice to obtain the asymptotically minimal attainable $L^{2}(0,L)$ global error at time $T$ as a function of $B$, $\\kappa$, $L$, $T$, $C_{s}$, $C_{t}$, and $\\gamma$. Express your final answer as a single closed-form analytic expression in terms of these parameters. Do not include units in your final expression.",
            "solution": "The user has provided a two-part problem concerning the numerical solution of the one-dimensional heat equation. The first part requires a von Neumann stability analysis of the Forward-Time Central-Space (FTCS) scheme to determine the stability-limiting time step. The second part involves an optimization problem to find the minimum global error achievable for a given computational budget, under the constraint that the time step is chosen at the stability limit derived in the first part.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Governing Equation:** $u_{t} = \\kappa\\,u_{xx}$ for $x \\in (0,L)$ and $t \\in (0,T]$.\n- **Parameters:** $\\kappa > 0$, $L > 0$, $T > 0$.\n- **Boundary Conditions:** $u(0,t)=u(L,t)=0$.\n- **Initial Condition:** $u(x,0)=u_{0}(x)$.\n- **Numerical Scheme:**\n    - Spatial Discretization: Uniform grid with spacing $h$ ($x_i=ih$), using the second-order central difference for $u_{xx}$.\n    - Temporal Discretization: Forward Euler method with time step $\\Delta t$ ($t_n=n\\Delta t$).\n- **Numerical Solution Notation:** $u_{i}^{n} \\approx u(x_i, t_n)$.\n- **Part (a) Objective:** Derive the stability condition $\\Delta t \\le C\\,h^{2}$ and find the sharp constant $C$.\n- **Part (b) Assumptions:**\n    - **Global Error Form:** $\\|u(\\cdot,T)-u_{h}^{N}\\|_{L^{2}(0,L)} \\approx C_{s}\\,h^{2} + C_{t}\\,\\Delta t$, where $N=T/\\Delta t$. Constants $C_s > 0, C_t > 0$ are independent of $h, \\Delta t$.\n    - **Computational Budget:** $B = \\gamma \\,\\frac{T}{\\Delta t}\\,\\frac{L}{h}$, where $\\gamma > 0$ is a constant.\n    - **Operating Condition:** The scheme is operated at the stability threshold from part (a), i.e., $\\Delta t$ is set to its maximum stable value for a given $h$.\n- **Part (b) Objective:** Find the asymptotically minimal $L^{2}(0,L)$ global error as a function of $B$, $\\kappa$, $L$, $T$, $C_{s}$, $C_{t}$, and $\\gamma$.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is assessed against the validation criteria.\n- **Scientifically Grounded:** The problem is a classic exercise in numerical analysis, concerning the stability and convergence of the FTCS scheme for the heat equation. All concepts (von Neumann analysis, error bounds, computational budget) are standard and well-established. It is scientifically valid.\n- **Well-Posed:** Part (a) asks for a standard derivation with a unique, well-known result. Part (b) is a constrained optimization problem. The constraints and objective function are clearly defined, and the instruction to operate at the stability threshold removes any ambiguity, leading to a unique solution. The problem is well-posed.\n- **Objective:** The problem is stated using precise, unambiguous mathematical language. It is objective.\n- **Completeness and Consistency:** All necessary parameters and relationships are provided. There are no missing data or internal contradictions.\n\n**Step 3: Verdict and Action**\n\nThe problem is valid. It is a well-structured problem in numerical analysis that tests the understanding of stability, accuracy, and computational cost. A complete solution will be provided.\n\n### Part (a): Stability Analysis\n\nThe FTCS discretization of the heat equation $u_t = \\kappa u_{xx}$ is given by:\n$$\n\\frac{u_{i}^{n+1} - u_{i}^{n}}{\\Delta t} = \\kappa \\frac{u_{i-1}^{n} - 2u_{i}^{n} + u_{i+1}^{n}}{h^2}\n$$\nThe problem suggests using a modal analysis based on the ordinary differential equation (ODE) for the Fourier modes. First, we perform a semi-discretization in space, which gives a system of ODEs for the grid-point values $u_i(t)$:\n$$\n\\frac{d u_i}{d t} = \\kappa \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2}\n$$\nIn von Neumann analysis, we consider the evolution of a single Fourier mode, $u_i(t) = v_k(t) e^{\\mathrm{i} k x_i}$, where $x_i = ih$, $k$ is the wavenumber, and $v_k(t)$ is the time-dependent amplitude of the mode. Substituting this into the semi-discretized equation yields:\n$$\n\\frac{d v_k}{d t} e^{\\mathrm{i} k i h} = \\kappa v_k(t) \\frac{e^{\\mathrm{i} k (i-1) h} - 2e^{\\mathrm{i} k i h} + e^{\\mathrm{i} k (i+1) h}}{h^2}\n$$\nDividing by $e^{\\mathrm{i} k i h}$, we get an ODE for the amplitude $v_k(t)$:\n$$\n\\frac{d v_k}{d t} = \\kappa v_k(t) \\frac{e^{-\\mathrm{i} k h} - 2 + e^{\\mathrm{i} k h}}{h^2} = \\kappa v_k(t) \\frac{2\\cos(kh) - 2}{h^2}\n$$\nUsing the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, this simplifies to:\n$$\n\\frac{d v_k}{d t} = - \\frac{4\\kappa}{h^2} \\sin^2\\left(\\frac{kh}{2}\\right) v_k(t)\n$$\nThis is a scalar linear ODE of the form $\\frac{dy}{dt} = \\lambda y$, where the eigenvalue $\\lambda_k$ for the mode with wavenumber $k$ is:\n$$\n\\lambda_k = -\\frac{4\\kappa}{h^2} \\sin^2\\left(\\frac{kh}{2}\\right)\n$$\nApplying the forward Euler method to this ODE gives the time-stepping rule for the mode amplitude:\n$$\nv_k^{n+1} = v_k^n + \\Delta t (\\lambda_k v_k^n) = \\left(1 + \\Delta t \\lambda_k\\right) v_k^n\n$$\nThe amplification factor for one time step is $G(k) = 1 + \\Delta t \\lambda_k$. For stability, the magnitude of the amplification factor must not exceed $1$ for all possible wavenumbers, i.e., $|G(k)| \\le 1$.\n$$\n\\left|1 - \\frac{4\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{kh}{2}\\right)\\right| \\le 1\n$$\nSince $\\kappa, \\Delta t, h^2$ are positive, the term $\\frac{4\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{kh}{2}\\right)$ is non-negative. Let this term be $P$. The condition is $|1-P| \\le 1$, which is equivalent to $-1 \\le 1-P \\le 1$.\nThe right-hand inequality, $1-P \\le 1$, implies $-P \\le 0$, which is always true.\nThe left-hand inequality, $-1 \\le 1-P$, implies $P \\le 2$.\n$$\n\\frac{4\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{kh}{2}\\right) \\le 2\n$$\nSolving for $\\Delta t$ gives:\n$$\n\\Delta t \\le \\frac{2 h^2}{4\\kappa \\sin^2\\left(\\frac{kh}{2}\\right)} = \\frac{h^2}{2\\kappa \\sin^2\\left(\\frac{kh}{2}\\right)}\n$$\nThis condition must hold for all wavenumbers $k$ that the grid can represent. The most restrictive constraint (i.e., the smallest upper bound on $\\Delta t$) occurs when the denominator is minimized, which corresponds to the term $\\sin^2\\left(\\frac{kh}{2}\\right)$ being maximized. The maximum value of $\\sin^2\\left(\\frac{kh}{2}\\right)$ is $1$. This corresponds to the highest frequency mode the grid can resolve, where $kh = \\pi$.\nSubstituting this maximum value gives the necessary condition for stability:\n$$\n\\Delta t \\le \\frac{h^2}{2\\kappa}\n$$\nThis matches the form $\\Delta t \\le C\\,h^{2}$, where the sharp constant $C$ is identified as:\n$$\nC = \\frac{1}{2\\kappa}\n$$\n\n### Part (b): Error Optimization under Budget Constraint\n\nWe are tasked with minimizing the global error, given by $E \\approx C_{s}\\,h^{2} + C_{t}\\,\\Delta t$, subject to a fixed computational budget $B$ and the choice to operate at the stability threshold.\n\nThe relationships are:\n1.  Error: $E = C_{s}\\,h^{2} + C_{t}\\,\\Delta t$\n2.  Budget: $B = \\gamma \\,\\frac{T L}{h \\Delta t}$\n3.  Stability Threshold: $\\Delta t = C h^2 = \\frac{1}{2\\kappa} h^2$ (using the result from part (a))\n\nThe problem is to find the minimal error $E$ as a function of the budget $B$ and other system parameters. We can achieve this by expressing $h$ and $\\Delta t$ in terms of $B$ and substituting them into the error formula.\n\nFirst, substitute the stability condition (3) into the budget equation (2) to relate the spatial step $h$ to the budget $B$:\n$$\nB = \\gamma \\frac{T L}{h \\left(\\frac{1}{2\\kappa} h^2\\right)} = \\frac{2\\kappa\\gamma T L}{h^3}\n$$\nFrom this, we can solve for $h^3$:\n$$\nh^3 = \\frac{2\\kappa\\gamma T L}{B}\n$$\nThe error expression depends on $h^2$. We find $h^2$ by raising the expression for $h^3$ to the power of $2/3$:\n$$\nh^2 = \\left(h^3\\right)^{2/3} = \\left(\\frac{2\\kappa\\gamma T L}{B}\\right)^{2/3}\n$$\nNext, we express the error $E$ solely in terms of $h$ by substituting the stability condition (3) into the error formula (1):\n$$\nE = C_s h^2 + C_t \\left(\\frac{1}{2\\kappa} h^2\\right) = \\left(C_s + \\frac{C_t}{2\\kappa}\\right) h^2\n$$\nFinally, we substitute the expression for $h^2$ in terms of the budget $B$ into this new error expression to find the minimum attainable error for that budget:\n$$\nE = \\left(C_s + \\frac{C_t}{2\\kappa}\\right) \\left(\\frac{2\\kappa\\gamma T L}{B}\\right)^{2/3}\n$$\nThis is the minimal global error as a function of the budget $B$ and the given parameters, under the specified operating conditions.",
            "answer": "$$\n\\boxed{\\left(C_{s} + \\frac{C_{t}}{2\\kappa}\\right) \\left(\\frac{2\\kappa\\gamma TL}{B}\\right)^{2/3}}\n$$"
        },
        {
            "introduction": "The Finite Element Method (FEM) offers a powerful and flexible framework for solving partial differential equations, and understanding its convergence properties is key to its effective use. This practice delves into the core theory of FEM error analysis for a representative elliptic problem . You will apply standard interpolation theory and the classic Aubin-Nitsche duality argument to explain the important result that the error converges faster in the $L^2$ norm than in the energy ($H^1$) norm, a cornerstone of a priori error estimation.",
            "id": "3750597",
            "problem": "Consider the one-dimensional homogeneous Dirichlet boundary value problem on the unit interval: find a function $u$ such that $-u'' = f$ in $(0,1)$ and $u(0) = u(1) = 0$, where the right-hand side $f$ is selected so that the exact solution is\n$$\nu(x) = \\sin(\\pi x) + \\frac{1}{10}\\sin(10\\pi x).\n$$\nThis exact solution contains a coarse-scale component $\\sin(\\pi x)$ and a fine-scale component $\\sin(10\\pi x)$, which is representative of multiscale behavior. Let $V$ be the Sobolev space of square-integrable functions with square-integrable first derivatives that vanish at the endpoints, and let $a(\\cdot,\\cdot)$ be the symmetric bilinear form associated with the weak formulation of the problem. Let $V_h \\subset V$ be the conforming subspace of continuous, piecewise linear functions on a uniform mesh of step size $h$ that vanish at the endpoints, and let $u_h \\in V_h$ denote the Galerkin approximation obtained by the standard Finite Element Method (FEM).\n\nStarting from the variational formulation and the definitions of the norms on $V$ and $L^2(0,1)$, use interpolation theory for conforming piecewise linear elements and the coercivity and boundedness of the bilinear form to establish the asymptotic convergence rates of the FEM errors in the $H^1(0,1)$ norm and the $L^2(0,1)$ norm as $h \\to 0$. Construct the argument explicitly for the given $u$, justifying any regularity requirements needed to derive the rates. Your derivation should make clear why the $L^2(0,1)$ error converges faster than the $H^1(0,1)$ error in this example.\n\nWhat are the exact exponents $p_{H^1}$ and $p_{L^2}$ such that, for sufficiently small $h$, the leading-order behavior of the errors satisfies\n$$\n\\|u - u_h\\|_{H^1(0,1)} = \\mathcal{O}(h^{p_{H^1}}) \\quad \\text{and} \\quad \\|u - u_h\\|_{L^2(0,1)} = \\mathcal{O}(h^{p_{L^2}})?\n$$\nProvide your final answer as a row matrix containing $(p_{H^1}, p_{L^2})$.",
            "solution": "The problem requires the derivation of the asymptotic convergence rates for the finite element approximation of a specific one-dimensional boundary value problem. We will first validate the problem setup and then proceed with the derivation based on standard finite element theory.\n\nThe problem is stated as:\n$$\n-u'' = f \\quad \\text{in } (0,1)\n$$\n$$\nu(0) = u(1) = 0\n$$\nThe exact solution is given by $u(x) = \\sin(\\pi x) + \\frac{1}{10}\\sin(10\\pi x)$. From this, we can determine the forcing function $f(x)$:\n$$\nu'(x) = \\pi\\cos(\\pi x) + \\pi\\cos(10\\pi x)\n$$\n$$\nu''(x) = -\\pi^2\\sin(\\pi x) - 100\\pi^2\\sin(10\\pi x)\n$$\nThus, $f(x) = -u''(x) = \\pi^2\\sin(\\pi x) + 100\\pi^2\\sin(10\\pi x)$. The function $u(x)$ and its derivatives up to any order are continuous and therefore square-integrable on $[0,1]$. This means $u \\in C^\\infty([0,1])$, which implies $u \\in H^k(0,1)$ for any integer $k \\ge 0$. This high regularity is essential for the subsequent analysis.\n\nThe weak formulation is derived by multiplying the PDE by a test function $v \\in V = H_0^1(0,1)$ and integrating over the domain $(0,1)$. The space $H_0^1(0,1)$ is the Sobolev space of functions that are in $L^2(0,1)$, have a weak first derivative in $L^2(0,1)$, and satisfy the homogeneous Dirichlet boundary conditions.\n$$\n-\\int_0^1 u''(x)v(x) dx = \\int_0^1 f(x)v(x) dx\n$$\nIntegration by parts on the left-hand side yields:\n$$\n\\int_0^1 u'(x)v'(x) dx - [u'(x)v(x)]_0^1 = \\int_0^1 f(x)v(x) dx\n$$\nSince $v \\in H_0^1(0,1)$, $v(0)=v(1)=0$, and the boundary term vanishes. This gives the weak formulation: Find $u \\in V$ such that\n$$\na(u,v) = L(v) \\quad \\forall v \\in V\n$$\nwhere the bilinear form is $a(u,v) = \\int_0^1 u'(x)v'(x) dx$ and the linear functional is $L(v) = \\int_0^1 f(x)v(x) dx$.\n\nThe finite element method seeks an approximate solution $u_h$ in a finite-dimensional subspace $V_h \\subset V$. Here, $V_h$ is the space of continuous, piecewise linear functions on a uniform mesh of size $h$, with $u_h(0) = u_h(1) = 0$. The Galerkin problem is: Find $u_h \\in V_h$ such that\n$$\na(u_h, v_h) = L(v_h) \\quad \\forall v_h \\in V_h\n$$\nBy subtracting the Galerkin problem from the weak formulation (evaluated with a test function $v_h \\in V_h \\subset V$), we obtain the Galerkin orthogonality property for the error $e = u - u_h$:\n$$\na(u - u_h, v_h) = a(u, v_h) - a(u_h, v_h) = L(v_h) - L(v_h) = 0 \\quad \\forall v_h \\in V_h\n$$\n\n**$H^1(0,1)$ Norm Error Analysis**\n\nThe analysis of the error in the $H^1$ norm relies on Céa's lemma. The bilinear form $a(v,v) = \\int_0^1 (v'(x))^2 dx = \\|v'\\|_{L^2}^2$. On the space $V=H_0^1(0,1)$, the Poincaré inequality states that there exists a constant $C_P$ such that $\\|v\\|_{L^2} \\le C_P \\|v'\\|_{L^2}$. This implies that the $H^1$ norm, $\\|v\\|_{H^1} = (\\|v\\|_{L^2}^2 + \\|v'\\|_{L^2}^2)^{1/2}$, is equivalent to the seminorm induced by $a(\\cdot,\\cdot)$, i.e., $\\|v'\\|_{L^2}$. Consequently, the bilinear form $a(\\cdot,\\cdot)$ is coercive on $V$. It is also bounded, as $|a(u,v)| = |\\int_0^1 u'v' dx| \\le \\|u'\\|_{L^2}\\|v'\\|_{L^2} \\le \\|u\\|_{H^1}\\|v\\|_{H^1}$.\n\nCéa's lemma states that for a coercive and bounded bilinear form, the Galerkin approximation is quasi-optimal in the energy norm. For our problem, this translates to the $H^1$ norm:\n$$\n\\|u - u_h\\|_{H^1} \\le C \\inf_{v_h \\in V_h} \\|u - v_h\\|_{H^1}\n$$\nfor some constant $C$ that is independent of $h$ and $u$. The term on the right is the error of the best approximation of $u$ in the subspace $V_h$. This error can be bounded by the error of a specific choice of $v_h$, namely the nodal interpolant of $u$, denoted $\\Pi_h u$.\n$$\n\\inf_{v_h \\in V_h} \\|u - v_h\\|_{H^1} \\le \\|u - \\Pi_h u\\|_{H^1}\n$$\nStandard interpolation theory for conforming, piecewise linear ($P_1$) finite elements provides the following estimate, provided the solution $u$ has sufficient regularity (specifically, $u \\in H^2(0,1)$):\n$$\n\\|u - \\Pi_h u\\|_{H^1(0,1)} \\le C_I h \\|u\\|_{H^2(0,1)}\n$$\nAs established earlier, our exact solution $u(x) = \\sin(\\pi x) + \\frac{1}{10}\\sin(10\\pi x)$ is in $C^\\infty([0,1])$, so it is certainly in $H^2(0,1)$. Therefore, the condition is met. Combining the inequalities, we get the final estimate for the $H^1$ norm of the error:\n$$\n\\|u - u_h\\|_{H^1(0,1)} \\le C \\cdot C_I h \\|u\\|_{H^2(0,1)}\n$$\nSince $\\|u\\|_{H^2(0,1)}$ is a fixed constant for the given problem, the error behaves as:\n$$\n\\|u - u_h\\|_{H^1(0,1)} = \\mathcal{O}(h^1)\n$$\nThis establishes that the exponent for the convergence rate in the $H^1$ norm is $p_{H^1} = 1$.\n\n**$L^2(0,1)$ Norm Error Analysis**\n\nTo obtain the convergence rate in the $L^2$ norm, we employ the Aubin-Nitsche duality argument. Let the error be $e = u - u_h$. We want to estimate $\\|e\\|_{L^2}$. We introduce an auxiliary (dual) problem: Find $\\phi \\in V = H_0^1(0,1)$ such that\n$$\n-\\phi'' = e \\quad \\text{in } (0,1)\n$$\nwith boundary conditions $\\phi(0) = \\phi(1) = 0$. The weak formulation of this dual problem is: Find $\\phi \\in V$ such that\n$$\na(v, \\phi) = \\int_0^1 v' \\phi' dx = \\int_0^1 e v dx = (e, v)_{L^2} \\quad \\forall v \\in V\n$$\nFor a one-dimensional problem (or more generally, for a problem on a convex domain), this elliptic PDE exhibits full regularity. This means that for a right-hand side in $L^2(0,1)$, the solution is in $H^2(0,1)$, and there exists a constant $C_R$ such that:\n$$\n\\|\\phi\\|_{H^2(0,1)} \\le C_R \\|e\\|_{L^2(0,1)}\n$$\nNow, we express the squared $L^2$ norm of the error by setting $v=e$ in the dual weak form:\n$$\n\\|e\\|_{L^2}^2 = (e,e)_{L^2} = a(e, \\phi)\n$$\nUsing the Galerkin orthogonality property, $a(e, v_h) = a(u-u_h, v_h) = 0$ for any $v_h \\in V_h$. We can subtract this null term:\n$$\n\\|e\\|_{L^2}^2 = a(e, \\phi - v_h) \\quad \\forall v_h \\in V_h\n$$\nUsing the boundedness of the bilinear form (Cauchy-Schwarz inequality on the derivatives):\n$$\n\\|e\\|_{L^2}^2 = \\int_0^1 e'(\\phi - v_h)' dx \\le \\|e'\\|_{L^2} \\|\\phi' - v_h'\\|_{L^2} \\le \\|e\\|_{H^1} \\|\\phi - v_h\\|_{H^1}\n$$\nThis inequality holds for any $v_h \\in V_h$. We make the judicious choice $v_h = \\Pi_h \\phi$, the piecewise linear interpolant of the dual solution $\\phi$.\n$$\n\\|e\\|_{L^2}^2 \\le \\|e\\|_{H^1} \\|\\phi - \\Pi_h \\phi\\|_{H^1}\n$$\nWe apply the interpolation error estimate to $\\|\\phi - \\Pi_h \\phi\\|_{H^1}$. Since the elliptic regularity guarantees that $\\phi \\in H^2(0,1)$, we have:\n$$\n\\|\\phi - \\Pi_h \\phi\\|_{H^1} \\le C_I h \\|\\phi\\|_{H^2}\n$$\nSubstituting this into the inequality for $\\|e\\|_{L^2}^2$:\n$$\n\\|e\\|_{L^2}^2 \\le \\|e\\|_{H^1} (C_I h \\|\\phi\\|_{H^2})\n$$\nNow, substitute the elliptic regularity estimate $\\|\\phi\\|_{H^2} \\le C_R \\|e\\|_{L^2}$:\n$$\n\\|e\\|_{L^2}^2 \\le \\|e\\|_{H^1} (C_I h C_R \\|e\\|_{L^2})\n$$\nAssuming $\\|e\\|_{L^2} \\neq 0$, we can divide by $\\|e\\|_{L^2}$:\n$$\n\\|e\\|_{L^2} \\le (C_I C_R) h \\|e\\|_{H^1}\n$$\nFinally, we substitute the result from our $H^1$ error analysis, $\\|e\\|_{H^1} = \\|u-u_h\\|_{H^1} = \\mathcal{O}(h)$:\n$$\n\\|u - u_h\\|_{L^2} \\le (\\text{const} \\cdot h) \\cdot \\mathcal{O}(h) = \\mathcal{O}(h^2)\n$$\nThis establishes the convergence rate in the $L^2$ norm, with the exponent $p_{L^2} = 2$.\n\nThe faster convergence in the $L^2$ norm is a direct consequence of the duality argument. The core idea is that the $L^2$ norm of the error can be related to the $H^1$ norm of the error multiplied by the interpolation error of the dual solution. This interpolation error introduces an additional factor of $h$, leading to an order of convergence that is one higher than the $H^1$ convergence rate. This relies critically on the $H^2$ regularity of the dual problem, which holds for this specific problem.\n\nThe derived convergence rates $p_{H^1}=1$ and $p_{L^2}=2$ are the standard optimal rates for continuous piecewise linear finite element approximations of second-order elliptic problems when the solution is sufficiently regular, as is the case here.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While asymptotic convergence rates describe ideal behavior, practical implementations often involve approximations that can introduce unexpected numerical artifacts. This exercise explores one of the most famous pathologies in computational mechanics: the emergence of spurious 'hourglass' modes from reduced integration in finite elements . By explicitly constructing a zero-energy mode and analyzing a stabilization scheme, you will gain a concrete understanding of how quadrature choices impact matrix rank and why robust numerical methods must control these non-physical instabilities.",
            "id": "3750617",
            "problem": "Consider plane strain linear elasticity on a single isoparametric bilinear quadrilateral element (often denoted $Q_1$) occupying a square domain with side length $L$ and constant thickness $t$. The material is homogeneous with Lamé parameters $\\lambda$ and $\\mu$, and the displacement field is approximated by the Finite Element Method (FEM) using the standard bilinear shape functions $N_i(\\xi,\\eta)$ on the parent square $[-1,1] \\times [-1,1]$, mapped to physical coordinates by $x = \\frac{L}{2} \\xi$ and $y = \\frac{L}{2} \\eta$. The weak form of linear elasticity yields the element stiffness matrix as $K_e = \\int_{\\Omega_e} B^{\\top} D B \\, d\\Omega$, where $B$ is the strain-displacement matrix and $D$ is the elasticity matrix for plane strain in terms of $\\lambda$ and $\\mu$.\n\nUnder reduced integration, the element stiffness is approximated with a single Gauss point at the center $(\\xi,\\eta)=(0,0)$ as $K_e^{\\mathrm{RI}} = B(0,0)^{\\top} D B(0,0) \\, A$, where $A = L^2$ is the element area. It is known that this under-integration can introduce spurious zero-energy modes (hourglass modes). \n\n1. Construct explicitly a nodal displacement pattern with eight components $d = [u_1^x, u_1^y, u_2^x, u_2^y, u_3^x, u_3^y, u_4^x, u_4^y]^{\\top}$ that produces zero strain energy under $K_e^{\\mathrm{RI}}$, and verify at the level of $B(0,0)$ that it is a zero-energy mode. Use only the fundamental definitions of the bilinear shape functions and their derivatives at $(0,0)$, together with the isoparametric mapping described above.\n\n2. To remove hourglass modes, consider the following stabilization energy added at the element level:\n$$\nE_s(d) = \\alpha \\, t \\, \\frac{1}{L^2} \\left( \\left(u_1^x - u_2^x + u_3^x - u_4^x\\right)^2 + \\left(u_1^y - u_4^y + u_3^y - u_2^y\\right)^2 \\right),\n$$\nwhere $\\alpha>0$ is a stabilization parameter with units chosen so that $E_s$ has units of energy. Denote the corresponding stabilization stiffness by $K_s$ defined via $E_s(d) = \\frac{1}{2} d^{\\top} K_s d$.\n\nCompute, in closed form, the smallest positive eigenvalue of the stabilized stiffness $K_e^{\\mathrm{RI}} + K_s$ restricted to the hourglass subspace spanned by the two spurious patterns you constructed in part 1. Express your final answer as a symbolic analytical expression in terms of $\\alpha$, $t$, and $L$.\n\nFinally, briefly explain, using first principles, why reduced integration admits the spurious modes you constructed and how either the above stabilization or selective integration resolves the issue by altering the discrete operator so that the hourglass subspace acquires positive stiffness.\n\nYour final answer must be a single closed-form analytic expression. No rounding is required, and no units should be included inside the final expression.",
            "solution": "The posed problem is valid as it is scientifically grounded in the principles of continuum mechanics and the Finite Element Method (FEM), is well-posed, objective, and self-contained. It represents a canonical problem in computational mechanics concerning the numerical artifact of \"hourglassing\" in under-integrated elements and its stabilization. We proceed with the solution.\n\nThe problem is addressed in three parts: first, constructing a spurious zero-energy (hourglass) mode; second, calculating the eigenvalue of a stabilized stiffness matrix on the hourglass subspace; and third, providing a conceptual explanation.\n\n**Part 1: Construction of a Zero-Energy Hourglass Mode**\n\nThe displacement field $\\{u^x, u^y\\}$ within the element is interpolated from the nodal displacements $d = [u_1^x, u_1^y, u_2^x, u_2^y, u_3^x, u_3^y, u_4^x, u_4^y]^{\\top}$ using bilinear shape functions $N_i(\\xi, \\eta)$:\n$$\nu^x(\\xi, \\eta) = \\sum_{i=1}^4 N_i(\\xi, \\eta) u_i^x \\quad , \\quad u^y(\\xi, \\eta) = \\sum_{i=1}^4 N_i(\\xi, \\eta) u_i^y\n$$\nThe standard counter-clockwise node ordering for the parent element $[-1,1] \\times [-1,1]$ is assumed: node 1 at $( -1, -1)$, node 2 at $(1, -1)$, node 3 at $(1, 1)$, and node 4 at $(-1, 1)$. The shape functions are:\n$N_1 = \\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_2 = \\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_3 = \\frac{1}{4}(1+\\xi)(1+\\eta)$, $N_4 = \\frac{1}{4}(1-\\xi)(1+\\eta)$.\n\nThe mapping from parent coordinates $(\\xi, \\eta)$ to physical coordinates $(x, y)$ is given as $x = \\frac{L}{2} \\xi$ and $y = \\frac{L}{2} \\eta$. The Jacobian matrix of this transformation is constant:\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{L}{2} & 0 \\\\ 0 & \\frac{L}{2} \\end{pmatrix}\n$$\nThe inverse Jacobian is $J^{-1} = \\begin{pmatrix} \\frac{2}{L} & 0 \\\\ 0 & \\frac{2}{L} \\end{pmatrix}$. The derivatives of the shape functions with respect to physical coordinates are found using the chain rule: $\\left( \\frac{\\partial N_i}{\\partial x}, \\frac{\\partial N_i}{\\partial y} \\right)^\\top = J^{-1} \\left( \\frac{\\partial N_i}{\\partial \\xi}, \\frac{\\partial N_i}{\\partial \\eta} \\right)^\\top$.\n\nThe strain-displacement matrix $B$ relates the strain vector $\\varepsilon = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^{\\top}$ to the nodal displacement vector $d$ via $\\varepsilon = B d$. Reduced integration evaluates $B$ at the element center $(\\xi, \\eta) = (0,0)$. We require the derivatives of $N_i$ at this point:\n$$\n\\left. \\frac{\\partial N_1}{\\partial \\xi} \\right|_{(0,0)} = -\\frac{1}{4}, \\quad \\left. \\frac{\\partial N_1}{\\partial \\eta} \\right|_{(0,0)} = -\\frac{1}{4}\n$$\n$$\n\\left. \\frac{\\partial N_2}{\\partial \\xi} \\right|_{(0,0)} = \\frac{1}{4}, \\quad \\left. \\frac{\\partial N_2}{\\partial \\eta} \\right|_{(0,0)} = -\\frac{1}{4}\n$$\n$$\n\\left. \\frac{\\partial N_3}{\\partial \\xi} \\right|_{(0,0)} = \\frac{1}{4}, \\quad \\left. \\frac{\\partial N_3}{\\partial \\eta} \\right|_{(0,0)} = \\frac{1}{4}\n$$\n$$\n\\left. \\frac{\\partial N_4}{\\partial \\xi} \\right|_{(0,0)} = -\\frac{1}{4}, \\quad \\left. \\frac{\\partial N_4}{\\partial \\eta} \\right|_{(0,0)} = \\frac{1}{4}\n$$\nThe components of the strain vector at the center are:\n$$\n\\varepsilon_{xx}(0,0) = \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial x}(0,0) u_i^x = \\frac{2}{L} \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial \\xi}(0,0) u_i^x = \\frac{1}{2L}(-u_1^x + u_2^x + u_3^x - u_4^x)\n$$\n$$\n\\varepsilon_{yy}(0,0) = \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial y}(0,0) u_i^y = \\frac{2}{L} \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial \\eta}(0,0) u_i^y = \\frac{1}{2L}(-u_1^y - u_2^y + u_3^y + u_4^y)\n$$\n$$\n\\gamma_{xy}(0,0) = \\sum_{i=1}^4 \\left( \\frac{\\partial N_i}{\\partial y}(0,0) u_i^x + \\frac{\\partial N_i}{\\partial x}(0,0) u_i^y \\right) = \\frac{1}{2L}[(-u_1^x - u_2^x + u_3^x + u_4^x) + (-u_1^y + u_2^y + u_3^y - u_4^y)]\n$$\nA zero-energy mode is a non-rigid-body displacement vector $d$ that results in zero strain at the integration point, i.e., $\\varepsilon(0,0) = B(0,0)d=0$. This requires all three strain components above to be zero.\n\nThe canonical hourglass patterns are known to be orthogonal to the constant and linear fields sampled at the nodes. Let us construct a displacement pattern $d^h$ corresponding to the x-displacements taking values proportional to $\\xi\\eta$ on the parent element, and zero y-displacements. The nodal values for $u^x \\propto \\xi\\eta$ are $[1, -1, 1, -1]^\\top$ for a scaling factor of $1$ and nodes $1, 2, 3, 4$. So we test the nodal displacement vector:\n$$\nd = [1, 0, -1, 0, 1, 0, -1, 0]^{\\top}\n$$\nVerifying that this is a zero-energy mode:\n$$\n\\varepsilon_{xx}(0,0) \\propto -u_1^x + u_2^x + u_3^x - u_4^x = -1 + (-1) + 1 - (-1) = 0\n$$\n$$\n\\varepsilon_{yy}(0,0) \\propto -u_1^y - u_2^y + u_3^y + u_4^y = 0 \\text{ (since all } u_i^y=0)\n$$\n$$\n\\gamma_{xy}(0,0) \\propto (-u_1^x - u_2^x + u_3^x + u_4^x) + (-u_1^y + u_2^y + u_3^y - u_4^y) = (-1 - (-1) + 1 + (-1)) + 0 = 0\n$$\nAll three strain components at the center are zero. This is a non-rigid body motion, so it is a spurious zero-energy mode. A second, orthogonal hourglass mode can be constructed similarly for the y-displacements: $[0, 1, 0, -1, 0, 1, 0, -1]^\\top$. The problem asks for one such pattern, and we have constructed it.\n\n**Part 2: Eigenvalue of the Stabilized Stiffness Matrix**\n\nThe hourglass subspace $S$ is spanned by the two modes identified above. Let us define the basis vectors for this subspace:\n$$\nv_1 = [1, 0, -1, 0, 1, 0, -1, 0]^{\\top}\n$$\n$$\nv_2 = [0, 1, 0, -1, 0, 1, 0, -1]^{\\top}\n$$\nThese vectors are orthogonal, $v_1^{\\top} v_2 = 0$, and have squared norms $\\|v_1\\|^2 = v_1^{\\top}v_1 = 4$ and $\\|v_2\\|^2 = v_2^{\\top}v_2 = 4$.\n\nThe stabilized stiffness matrix is $K_{stab} = K_e^{\\mathrm{RI}} + K_s$. We are interested in its eigenvalues when restricted to the subspace $S$. For any vector $d \\in S$, $d$ is in the null space of $K_e^{\\mathrm{RI}}$, which means $K_e^{\\mathrm{RI}}d = 0$. Therefore, the eigenvalue problem on the subspace $S$ reduces to:\n$$\nK_s d = \\lambda d \\quad \\text{for } d \\in S\n$$\nThe stabilization energy is given as $E_s(d) = \\frac{1}{2} d^{\\top} K_s d$. The problem provides the expression for $E_s(d)$:\n$$\nE_s(d) = \\alpha \\, t \\, \\frac{1}{L^2} \\left( \\left(u_1^x - u_2^x + u_3^x - u_4^x\\right)^2 + \\left(u_1^y - u_4^y + u_3^y - u_2^y\\right)^2 \\right)\n$$\nThe term $u_1^y - u_4^y + u_3^y - u_2^y$ is a reordering of $u_1^y - u_2^y + u_3^y - u_4^y$. The two components can be written as inner products with our basis vectors:\n$$\nu_1^x - u_2^x + u_3^x - u_4^x = v_1^{\\top} d\n$$\n$$\nu_1^y - u_2^y + u_3^y - u_4^y = v_2^{\\top} d\n$$\nThus, the stabilization energy is:\n$$\nE_s(d) = \\frac{\\alpha t}{L^2} \\left( (v_1^{\\top} d)^2 + (v_2^{\\top} d)^2 \\right)\n$$\nFrom the definition $E_s(d) = \\frac{1}{2} d^{\\top} K_s d$, we can identify the stabilization stiffness matrix $K_s$:\n$$\n\\frac{1}{2} d^{\\top} K_s d = \\frac{\\alpha t}{L^2} \\left( d^{\\top}v_1 v_1^{\\top}d + d^{\\top}v_2 v_2^{\\top}d \\right) = d^{\\top} \\left[ \\frac{\\alpha t}{L^2} (v_1 v_1^{\\top} + v_2 v_2^{\\top}) \\right] d\n$$\nWe must be careful with the factor of $1/2$. The provided $E_s$ does not have it, so $K_s$ must be derived from $d^\\top K_s d = 2 E_s$:\n$$\nd^\\top K_s d=2E_s \\implies K_s = \\frac{2\\alpha t}{L^2} (v_1 v_1^{\\top} + v_2 v_2^{\\top})\n$$\nLet's find the action of $K_s$ on the basis vectors $v_1$ and $v_2$.\n$$\nK_s v_1 = \\frac{2\\alpha t}{L^2} (v_1 v_1^{\\top} + v_2 v_2^{\\top}) v_1 = \\frac{2\\alpha t}{L^2} (v_1(v_1^{\\top}v_1) + v_2(v_2^{\\top}v_1))\n$$\nUsing $v_1^{\\top}v_1 = 4$ and $v_2^{\\top}v_1 = 0$:\n$$\nK_s v_1 = \\frac{2\\alpha t}{L^2} (v_1 \\cdot 4 + v_2 \\cdot 0) = \\frac{8\\alpha t}{L^2} v_1\n$$\nThis shows that $v_1$ is an eigenvector of $K_s$ with eigenvalue $\\lambda_1 = \\frac{8\\alpha t}{L^2}$.\nSimilarly, for $v_2$:\n$$\nK_s v_2 = \\frac{2\\alpha t}{L^2} (v_1 v_1^{\\top} + v_2 v_2^{\\top}) v_2 = \\frac{2\\alpha t}{L^2} (v_1(v_1^{\\top}v_2) + v_2(v_2^{\\top}v_2))\n$$\nUsing $v_1^{\\top}v_2 = 0$ and $v_2^{\\top}v_2 = 4$:\n$$\nK_s v_2 = \\frac{2\\alpha t}{L^2} (v_1 \\cdot 0 + v_2 \\cdot 4) = \\frac{8\\alpha t}{L^2} v_2\n$$\nThis shows that $v_2$ is an eigenvector of $K_s$ with eigenvalue $\\lambda_2 = \\frac{8\\alpha t}{L^2}$.\nSince both basis vectors of the subspace $S$ are eigenvectors with the same eigenvalue, any vector $d \\in S$ is also an eigenvector with that eigenvalue. The hourglass subspace is a 2-dimensional eigenspace of $K_s$ corresponding to the single eigenvalue $\\frac{8\\alpha t}{L^2}$. As $\\alpha > 0$, this eigenvalue is positive. It is therefore the smallest (and only) positive eigenvalue of $K_s$ restricted to $S$.\n\n**Part 3: Conceptual Explanation**\n\nReduced integration causes spurious zero-energy modes because it fails to accurately sense certain deformation patterns. The strain energy of an element is the integral of the strain energy density over the element's volume. A non-zero deformation should produce positive strain energy, unless it is a rigid body motion. Numerical quadrature approximates this integral as a weighted sum of the integrand evaluated at a few Gauss points. With reduced integration (e.g., a single point for a bilinear quadrilateral), the condition for zero energy is relaxed from requiring zero strain everywhere to requiring zero strain only at that single point. The hourglass modes are special deformation patterns, such as the one constructed in Part 1, whose corresponding strain field is non-zero over the element domain but happens to be exactly zero at the center point used for integration. The numerical integration scheme is \"blind\" to these modes, assigning them zero strain energy, which makes the global stiffness matrix singular (after accounting for boundary conditions) and permits uncontrolled, physically meaningless oscillations in the solution.\n\nStabilization methods correct this deficiency. The method described in the problem is a form of hourglass control. It works by adding a penalty energy term $E_s$ to the element's potential energy. This term is carefully constructed to be zero for all well-behaved deformation modes (rigid body motion and constant strain states) but positive for the spurious hourglass modes. This is achieved by creating a discrete operator (e.g., $v_1^{\\top} d$) that measures the magnitude of the hourglass pattern in the nodal displacements. The added energy term results in an additional stiffness matrix, $K_s$, which is positive definite on the hourglass subspace but zero on the subspace of \"good\" modes. When added to the original rank-deficient reduced-integration stiffness matrix $K_e^{\\mathrm{RI}}$, the combined matrix $K_e^{\\mathrm{RI}} + K_s$ becomes positive definite for all non-rigid body modes, thereby restoring the stability of the element and eliminating the spurious solutions.\n\nSelective integration is an alternative approach. It involves using different quadrature rules for different terms in the strain energy expression. Typically, terms that cause volumetric \"locking\" are under-integrated, while terms controlling shear deformation (which are linked to hourglassing) are fully integrated. This selectively stiffens only the necessary deformation modes to suppress hourglassing without reintroducing locking, providing an elegant solution without the need for an arbitrary stabilization parameter $\\alpha$.",
            "answer": "$$\n\\boxed{\\frac{8 \\alpha t}{L^2}}\n$$"
        }
    ]
}