{"hands_on_practices": [{"introduction": "这项练习是埃伦费斯特定理的一个基本应用，它让我们能够计算波包质心的初速度。通过计算无限深势阱中一个叠加态的动量期望值，我们可以直接求得 $\\frac{d\\langle x \\rangle}{dt}$，从而将抽象的定理与一个具体的物理预测联系起来。这个练习可以帮助你熟练掌握在量子力学中如何计算一个物理量的瞬时变化率。[@problem_id:1404578]", "problem": "一个质量为 $m$ 的粒子被限制在宽度为 $L$ 的一维无限深势阱中。当 $0 < x < L$ 时，其势能 $V(x)$ 为零，其他区域为无穷大。该系统的归一化能量本征态由 $\\psi_n(x) = \\sqrt{\\frac{2}{L}} \\sin\\left(\\frac{n\\pi x}{L}\\right)$ 给出，其中 $n=1, 2, 3, \\dots$ 是主量子数。\n\n在时刻 $t=0$，粒子的状态由以下归一化波函数描述：\n$$ \\Psi(x,0) = \\frac{1}{\\sqrt{2}} \\left( \\psi_1(x) + i \\psi_2(x) \\right) $$\n计算该粒子位置期望值的初始变化率 $\\left.\\frac{d\\langle x \\rangle}{dt}\\right|_{t=0}$。请用 $m$、$L$ 和约化普朗克常数 $\\hbar$ 表示你的答案。", "solution": "我们使用位置算符的 Ehrenfest 定理，该定理指出，对于具有势能 $V(x)$ 的不含时哈密顿量，\n$$\n\\frac{d\\langle x\\rangle}{dt}=\\frac{i}{\\hbar}\\langle[H,x]\\rangle=\\frac{\\langle p\\rangle}{m},\n$$\n因为 $H=\\frac{p^2}{2m}+V(x)$ 且 $[p^2,x]=-2i\\hbar p$，而 $[V(x),x]=0$。因此，在 $t=0$ 时，\n$$\n\\left.\\frac{d\\langle x\\rangle}{dt}\\right|_{t=0}=\\frac{1}{m}\\langle p\\rangle_{t=0}.\n$$\n我们使用 $p=-i\\hbar\\,\\partial_{x}$ 和给定的初始态 $\\Psi(x,0)=\\frac{1}{\\sqrt{2}}(\\psi_{1}(x)+i\\psi_{2}(x))$（其中 $\\psi_{n}(x)$ 为实函数）来计算 $\\langle p\\rangle_{t=0}$：\n$$\n\\langle p\\rangle_{t=0}=\\int_{0}^{L}\\Psi^{*}(x,0)\\left(-i\\hbar\\frac{\\partial}{\\partial x}\\right)\\Psi(x,0)\\,dx.\n$$\n利用 $\\Psi^{*}(x,0)=\\frac{1}{\\sqrt{2}}(\\psi_{1}(x)-i\\psi_{2}(x))$ 和 $\\partial_{x}\\Psi=\\frac{1}{\\sqrt{2}}(\\partial_{x}\\psi_{1}+i\\partial_{x}\\psi_{2})$，展开得到：\n$$\n\\langle p\\rangle_{t=0}=\\frac{-i\\hbar}{2}\\int_{0}^{L}\\left[\\psi_{1}\\,\\partial_{x}\\psi_{1}+\\psi_{2}\\,\\partial_{x}\\psi_{2}+i\\left(\\psi_{1}\\,\\partial_{x}\\psi_{2}-\\psi_{2}\\,\\partial_{x}\\psi_{1}\\right)\\right]dx.\n$$\n前两项积分为零，因为\n$$\n\\int_{0}^{L}\\psi_{n}\\,\\partial_{x}\\psi_{n}\\,dx=\\frac{1}{2}\\left[\\psi_{n}^{2}(x)\\right]_{0}^{L}=0,\n$$\n这里用到了 $\\psi_{n}(0)=\\psi_{n}(L)=0$。因此\n$$\n\\langle p\\rangle_{t=0}=\\frac{\\hbar}{2}\\int_{0}^{L}\\left(\\psi_{1}\\,\\partial_{x}\\psi_{2}-\\psi_{2}\\,\\partial_{x}\\psi_{1}\\right)dx.\n$$\n对第一项进行分部积分（边界项为零）得到\n$$\n\\int_{0}^{L}\\left(\\psi_{1}\\,\\partial_{x}\\psi_{2}-\\psi_{2}\\,\\partial_{x}\\psi_{1}\\right)dx=-2\\int_{0}^{L}\\psi_{2}\\,\\partial_{x}\\psi_{1}\\,dx,\n$$\n所以\n$$\n\\langle p\\rangle_{t=0}=-\\hbar\\int_{0}^{L}\\psi_{2}(x)\\,\\partial_{x}\\psi_{1}(x)\\,dx.\n$$\n使用 $\\psi_{n}(x)=\\sqrt{\\frac{2}{L}}\\sin\\!\\left(\\frac{n\\pi x}{L}\\right)$，我们有\n$$\n\\psi_{2}(x)\\,\\partial_{x}\\psi_{1}(x)=\\left(\\sqrt{\\frac{2}{L}}\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\right)\\left(\\sqrt{\\frac{2}{L}}\\frac{\\pi}{L}\\cos\\!\\left(\\frac{\\pi x}{L}\\right)\\right)=\\frac{2\\pi}{L^{2}}\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\cos\\!\\left(\\frac{\\pi x}{L}\\right).\n$$\n使用恒等式 $\\sin(2a)\\cos(a)=\\frac{1}{2}\\left[\\sin(3a)+\\sin(a)\\right]$，并令 $a=\\frac{\\pi x}{L}$ 来进行积分：\n$$\n\\int_{0}^{L}\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\cos\\!\\left(\\frac{\\pi x}{L}\\right)dx=\\frac{1}{2}\\int_{0}^{L}\\left[\\sin\\!\\left(\\frac{3\\pi x}{L}\\right)+\\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\right]dx=\\frac{4L}{3\\pi}.\n$$\n因此，\n$$\n\\int_{0}^{L}\\psi_{2}\\,\\partial_{x}\\psi_{1}\\,dx=\\frac{2\\pi}{L^{2}}\\cdot\\frac{4L}{3\\pi}=\\frac{8}{3L},\n$$\n所以\n$$\n\\langle p\\rangle_{t=0}=-\\hbar\\cdot\\frac{8}{3L}=-\\frac{8\\hbar}{3L}.\n$$\n最后，\n$$\n\\left.\\frac{d\\langle x\\rangle}{dt}\\right|_{t=0}=\\frac{\\langle p\\rangle_{t=0}}{m}=-\\frac{8\\hbar}{3mL}.\n$$", "answer": "$$\\boxed{-\\frac{8\\hbar}{3mL}}$$", "id": "1404578"}, {"introduction": "在瞬时变化这一概念的基础上，这个问题进一步探究了粒子平均位置的完整时间演化。通过求解 $\\langle x \\rangle(t)$，我们可以形象地看到波包的量子“晃动”行为，这为我们提供了一幅动态的图景，将埃伦费斯特定理所描述的微分关系在时间上积分起来。这项练习展示了期望值的动力学行为是如何从量子态的叠加和时间演化中产生的。[@problem_id:2089747]", "problem": "一个质量为 $m$ 的粒子被束缚在长度为 $L$ 的一维无限深势阱中。势能函数为：当 $0 < x < L$ 时，$V(x) = 0$，其他情况下 $V(x) = \\infty$。该系统的归一化、实值定态波函数由 $\\psi_n(x) = \\sqrt{\\frac{2}{L}} \\sin\\left(\\frac{n\\pi x}{L}\\right)$ 给出，其中 $n=1, 2, 3, \\ldots$。\n\n在 $t=0$ 时刻，粒子被制备在一个非定态上，其归一化的波函数为：\n$$\n\\Psi(x,0) = \\frac{1}{\\sqrt{2}} \\left( \\psi_1(x) + \\psi_2(x) \\right)\n$$\n其中 $\\psi_1(x)$ 和 $\\psi_2(x)$ 分别是基态和第一激发态。\n\n确定对于任意时刻 $t > 0$，粒子位置的期望值 $\\langle x \\rangle(t)$。请将您的答案表示为一个用参数 $L$、$m$、$t$ 和约化普朗克常数 $\\hbar$ 表示的闭合形式解析表达式。", "solution": "无限深势阱中的含时状态是通过时间演化算符由定态构造出来的。对于能量本征值为 $E_{n}$ 的定态，其时间演化由幺正演化原理给出：\n$$\n\\Psi(x,t)=\\sum_{n} c_{n}\\,\\psi_{n}(x)\\,\\exp\\!\\left(-\\frac{i E_{n} t}{\\hbar}\\right).\n$$\n给定 $\\Psi(x,0)=\\frac{1}{\\sqrt{2}}\\left(\\psi_{1}(x)+\\psi_{2}(x)\\right)$，系数为 $c_{1}=c_{2}=1/\\sqrt{2}$，其他情况下 $c_{n}=0$。因此，\n$$\n\\Psi(x,t)=\\frac{1}{\\sqrt{2}}\\left[\\psi_{1}(x)\\,\\exp\\!\\left(-\\frac{i E_{1} t}{\\hbar}\\right)+\\psi_{2}(x)\\,\\exp\\!\\left(-\\frac{i E_{2} t}{\\hbar}\\right)\\right],\n$$\n其中，对于无限深势阱，$E_{n}=\\frac{n^{2}\\pi^{2}\\hbar^{2}}{2 m L^{2}}$。\n\n位置的期望值为\n$$\n\\langle x\\rangle(t)=\\int_{0}^{L}\\Psi^{*}(x,t)\\,x\\,\\Psi(x,t)\\,dx.\n$$\n代入 $\\Psi(x,t)$ 并利用 $\\psi_{n}(x)$ 的实值性，得到\n$$\n\\langle x\\rangle(t)=\\frac{1}{2}\\left[\\langle 1|x|1\\rangle+\\langle 2|x|2\\rangle+\\exp\\!\\left(-\\frac{i\\Delta E\\, t}{\\hbar}\\right)\\langle 1|x|2\\rangle+\\exp\\!\\left(\\frac{i\\Delta E\\, t}{\\hbar}\\right)\\langle 2|x|1\\rangle\\right],\n$$\n其中 $\\Delta E=E_{2}-E_{1}$ 且 $\\langle n|x|m\\rangle=\\int_{0}^{L}\\psi_{n}(x)\\,x\\,\\psi_{m}(x)\\,dx$。由于 $x$ 是厄米的且基是实数的，所以 $\\langle 2|x|1\\rangle=\\langle 1|x|2\\rangle$，交叉项合并为 $2\\langle 1|x|2\\rangle\\cos\\!\\left(\\frac{\\Delta E\\, t}{\\hbar}\\right)$：\n$$\n\\langle x\\rangle(t)=\\frac{1}{2}\\left[\\langle 1|x|1\\rangle+\\langle 2|x|2\\rangle\\right]+\\langle 1|x|2\\rangle\\,\\cos\\!\\left(\\frac{\\Delta E\\, t}{\\hbar}\\right).\n$$\n\n计算对角元 $\\langle n|x|n\\rangle$：\n$$\n\\langle n|x|n\\rangle=\\frac{2}{L}\\int_{0}^{L}x\\sin^{2}\\!\\left(\\frac{n\\pi x}{L}\\right)\\,dx.\n$$\n使用 $\\sin^{2}\\theta=\\frac{1}{2}(1-\\cos 2\\theta)$ 以及积分 $J(k)=\\int_{0}^{L}x\\cos(kx)\\,dx=\\left[\\frac{x\\sin(kx)}{k}+\\frac{\\cos(kx)-1}{k^{2}}\\right]_{0}^{L}$，其中 $k=\\frac{2n\\pi}{L}$ 使得 $\\sin(kL)=0$ 且 $\\cos(kL)=1$，我们得到 $J(k)=0$。因此，\n$$\n\\langle n|x|n\\rangle=\\frac{2}{L}\\cdot\\frac{1}{2}\\int_{0}^{L}x\\,dx=\\frac{2}{L}\\cdot\\frac{1}{2}\\cdot\\frac{L^{2}}{2}=\\frac{L}{2}.\n$$\n于是 $\\frac{1}{2}\\left[\\langle 1|x|1\\rangle+\\langle 2|x|2\\rangle\\right]=\\frac{L}{2}$。\n\n现在计算非对角元 $\\langle 1|x|2\\rangle$：\n$$\n\\langle 1|x|2\\rangle=\\frac{2}{L}\\int_{0}^{L}x\\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)dx.\n$$\n使用 $\\sin\\alpha\\sin\\beta=\\frac{1}{2}[\\cos(\\alpha-\\beta)-\\cos(\\alpha+\\beta)]$。令 $a=\\frac{\\pi}{L}$ 和 $b=\\frac{2\\pi}{L}$。则\n$$\n\\int_{0}^{L}x\\sin(ax)\\sin(bx)\\,dx=\\frac{1}{2}\\left[J(a-b)-J(a+b)\\right],\n$$\n其中 $J(k)$ 如上所示。对于 $k_{1}=a-b=-\\frac{\\pi}{L}$，$k_{1}L=-\\pi$，所以 $\\sin(k_{1}L)=0$ 且 $\\cos(k_{1}L)=-1$，得到 $J(k_{1})=-\\frac{2}{k_{1}^{2}}=-\\frac{2L^{2}}{\\pi^{2}}$。对于 $k_{2}=a+b=\\frac{3\\pi}{L}$，$k_{2}L=3\\pi$，给出 $J(k_{2})=-\\frac{2}{k_{2}^{2}}=-\\frac{2L^{2}}{9\\pi^{2}}$。因此，\n$$\n\\int_{0}^{L}x\\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)dx=\\frac{1}{2}\\left(-\\frac{2L^{2}}{\\pi^{2}}+\\frac{2L^{2}}{9\\pi^{2}}\\right)=-\\frac{8L^{2}}{9\\pi^{2}},\n$$\n从而\n$$\n\\langle 1|x|2\\rangle=\\frac{2}{L}\\left(-\\frac{8L^{2}}{9\\pi^{2}}\\right)=-\\frac{16L}{9\\pi^{2}}.\n$$\n\n能量差为\n$$\n\\Delta E=E_{2}-E_{1}=\\frac{(4-1)\\pi^{2}\\hbar^{2}}{2 m L^{2}}=\\frac{3\\pi^{2}\\hbar^{2}}{2 m L^{2}},\n$$\n所以 $\\frac{\\Delta E}{\\hbar}=\\frac{3\\pi^{2}\\hbar}{2 m L^{2}}$。将所有结果合并，\n$$\n\\langle x\\rangle(t)=\\frac{L}{2}-\\frac{16L}{9\\pi^{2}}\\cos\\!\\left(\\frac{3\\pi^{2}\\hbar}{2 m L^{2}}\\,t\\right).\n$$\n这就是所要求的用 $L$、$m$、$t$ 和 $\\hbar$ 表示的闭合形式表达式。", "answer": "$$\\boxed{\\frac{L}{2}-\\frac{16L}{9\\pi^{2}}\\cos\\!\\left(\\frac{3\\pi^{2}\\hbar}{2 m L^{2}}\\,t\\right)}$$", "id": "2089747"}, {"introduction": "从解析理论转向计算实践，这项任务要求你通过直接模拟来验证埃伦费斯特定理。通过在一个线性势场中演化一个波包并追踪其平均动量，你将用数值方法证实 $\\langle p \\rangle$ 的变化率等于力的期望值。这项实践不仅能加深对定理的理解，也能培养宝贵的计算物理技能。[@problem_id:2450185]", "problem": "您需要编写一个完整、可运行的程序，该程序模拟一维非相对论量子波包在线性斜坡势下的时间演化，并对动量期望值定量验证 Ehrenfest 定理。在一个无量纲单位制中进行计算，其中约化普朗克常数 $\\hbar$ 等于 $1$，粒子质量 $m$ 等于 $1$。动力学由含时 Schrödinger 方程描述\n$$\ni \\,\\partial_t \\psi(x,t) \\;=\\; \\left[-\\tfrac{1}{2}\\,\\partial_{x}^2 \\;+\\; V(x)\\right]\\psi(x,t),\n$$\n其中线性势为\n$$\nV(x) \\;=\\; \\alpha\\,x,\n$$\n其中 $\\alpha$ 是一个实常数。在时间 $t=0$ 时，波包应为一个归一化的高斯最小不确定度态，中心位于位置 $x_0$，均方根宽度为 $\\sigma$，平均波数为 $k_0$，\n$$\n\\psi(x,0) \\;\\propto\\; \\exp\\!\\left(-\\frac{(x-x_0)^2}{4\\sigma^2} + i\\,k_0\\,x\\right),\n$$\n归一化以满足\n$$\n\\int_{-\\infty}^{\\infty} |\\psi(x,0)|^2\\,dx \\;=\\; 1.\n$$\n在一个长度为 $L$、离散为 $N$ 个等间距格点的有限、周期性一维空间域上，从给定的初始状态开始，以均匀的时间步长 $\\Delta t$ 模拟总时间为 $T = N_t\\,\\Delta t$ 的演化。在每个时间 $t$，动量期望值由内积定义：\n$$\n\\langle p \\rangle(t) \\;=\\; \\int_{-L/2}^{L/2} \\psi^*(x,t)\\, \\left(-i\\,\\partial_x\\right)\\,\\psi(x,t)\\,dx.\n$$\nEhrenfest 定理意味着\n$$\n\\frac{d}{dt}\\langle p \\rangle(t) \\;=\\; -\\left\\langle \\frac{\\partial V}{\\partial x} \\right\\rangle(t).\n$$\n对于线性势 $V(x)=\\alpha x$，我们有 $\\partial_x V(x)=\\alpha$，因此\n$$\n\\frac{d}{dt}\\langle p \\rangle(t) \\;=\\; -\\alpha.\n$$\n对于每个指定的测试用例，您的程序必须通过线性最小二乘法，在整个模拟区间 $[0,T]$ 上，估计函数 $\\langle p \\rangle(t)$ 相对于 $t$ 的最佳拟合斜率 $s$，然后将 $s$ 与理论值 $-\\alpha$ 进行比较。对于每个测试，报告一个布尔值，该值指示绝对偏差是否满足\n$$\n|\\,s - (-\\alpha)\\,| \\;\\le\\; \\tau,\n$$\n其中 $\\tau$ 是一个给定的容差。\n\n请使用以下参数集测试套件。所有符号的定义如上，所有数值均为无量纲。空间域在 $[-L/2,\\,L/2)$ 上是周期的，并且所有测试都使用相同的网格和时间参数。\n- 公共模拟参数：$L = 200$, $N = 1024$, $\\Delta t = 0.002$, $N_t = 1500$, $\\sigma = 5$, $x_0 = -50$。\n- 测试集 A (一般情况)：$\\alpha = 0.2$, $k_0 = 3.0$, 容差 $\\tau = 0.03$。\n- 测试集 B (自由演化边界情况)：$\\alpha = 0.0$, $k_0 = 2.0$, 容差 $\\tau = 0.02$。\n- 测试集 C (负斜坡情况)：$\\alpha = -0.3$, $k_0 = 0.0$, 容差 $\\tau = 0.03$。\n\n您的程序必须输出单行，其中包含一个布尔值列表，按 A、B、C 的顺序对应于三个测试。如果某个测试满足条件，则其对应的布尔值为 true，否则为 false。精确的所需输出格式为一行，形式如下：\n$$\n[\\text{result\\_A},\\text{result\\_B},\\text{result\\_C}],\n$$\n例如，`[{\\rm True},{\\rm False},{\\rm True}]`。", "solution": "所述问题是有效的。这是一个在计算量子力学中定义明确的问题，基于可靠的物理和数学原理，并为完整的数值解提供了所有必要的参数。我们将着手构建解决方案。\n\n任务是模拟由含时 Schrödinger 方程控制的一维量子波包 $\\psi(x,t)$ 的时间演化。在指定的约化普朗克常数 $\\hbar=1$ 和粒子质量 $m=1$ 的无量纲单位制中，该方程为：\n$$\ni \\,\\frac{\\partial \\psi(x,t)}{\\partial t} = \\hat{H}\\psi(x,t) = \\left[-\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} + V(x)\\right]\\psi(x,t)\n$$\n势是一个线性斜坡，$V(x) = \\alpha x$。在时间间隔 $\\Delta t$ 内演化的形式解由时间演化算符的作用给出，$\\psi(x, t+\\Delta t) = e^{-i\\hat{H}\\Delta t} \\psi(x,t)$。\n\n为了数值实现这一点，我们采用分步傅里叶方法，该方法对此类问题非常高效和稳定。哈密顿算符 $\\hat{H}$ 是动能算符 $\\hat{T} = -\\frac{1}{2}\\partial_x^2$ 和势能算符 $\\hat{V} = V(x)$ 的和。由于 $\\hat{T}$ 和 $\\hat{V}$ 不对易，它们的和的指数需要近似处理。我们使用二阶精度的对称 Strang 分裂：\n$$\ne^{-i(\\hat{T}+\\hat{V})\\Delta t} \\approx e^{-i\\hat{V}\\Delta t/2} \\, e^{-i\\hat{T}\\Delta t} \\, e^{-i\\hat{V}\\Delta t/2} + O(\\Delta t^3)\n$$\n这种分解使我们能够在各自的首选基中处理每个算符。$e^{-i\\hat{V}\\Delta t/2}$ 的作用是在位置空间中的简单乘法。$e^{-i\\hat{T}\\Delta t}$ 的作用是在动量（傅里叶）空间中的简单乘法。这些空间之间的转换通过快速傅里叶变换 (FFT) 高效处理。\n\n将波函数从时间 $t_n$ 推进到 $t_{n+1} = t_n + \\Delta t$ 的算法包括以下步骤：\n1.  在位置空间中应用第一步势算符的半步演化：$\\psi' = e^{-iV(x)\\Delta t/2} \\psi(x,t_n)$。\n2.  使用 FFT 变换到动量空间：$\\tilde{\\psi}' = \\mathcal{F}\\{\\psi'\\}$。\n3.  在动量空间中应用动能算符的完整一步演化：$\\tilde{\\psi}'' = e^{-i k^2 \\Delta t/2} \\tilde{\\psi}'$，其中 $k$ 是波数。\n4.  使用逆 FFT 变换回位置空间：$\\psi'' = \\mathcal{F}^{-1}\\{\\tilde{\\psi}''\\}$。\n5.  应用第二步势算符的半步演化：$\\psi(x,t_{n+1}) = e^{-iV(x)\\Delta t/2} \\psi''$。\n\n此过程重复 $N_t$ 次，以模拟在总时间 $T = N_t \\Delta t$ 内的演化。\n\n模拟在一个离散网格上设置。空间域 $[-L/2, L/2)$ 被离散为 $N$ 个点，得到网格间距 $\\Delta x = L/N$。$t=0$ 时的初始状态是一个归一化高斯波包，定义为：\n$$\n\\psi(x,0) = A \\cdot \\exp\\left(-\\frac{(x-x_0)^2}{4\\sigma^2} + i k_0 x\\right)\n$$\n归一化常数 $A = (2\\pi\\sigma^2)^{-1/4}$ 确保 $\\int|\\psi|^2 dx = 1$。在数值实现中，波函数在离散网格上初始化，然后进行数值重新归一化，以强制满足 $\\sum_j |\\psi_j|^2 \\Delta x = 1$。\n\n主要目标是验证关于动量期望值 $\\langle p \\rangle(t)$ 的 Ehrenfest 定理：\n$$\n\\frac{d}{dt}\\langle p \\rangle(t) = \\left\\langle -\\frac{\\partial V}{\\partial x} \\right\\rangle(t)\n$$\n对于势 $V(x)=\\alpha x$，力是恒定的，$-\\partial V/\\partial x = -\\alpha$。这意味着动量期望值应随时间线性变化，斜率为 $-\\alpha$：\n$$\n\\frac{d}{dt}\\langle p \\rangle(t) = -\\alpha\n$$\n在每个时间步 $t_n$，我们必须计算 $\\langle p \\rangle(t_n)$。它由以下积分给出：\n$$\n\\langle p \\rangle(t) = \\int \\psi^*(x,t) \\hat{p} \\psi(x,t) dx = \\int \\psi^*(x,t) \\left(-i\\frac{\\partial}{\\partial x}\\right) \\psi(x,t) dx\n$$\n为了最大化精度并与谱演化方法保持一致，空间导数 $\\partial_x \\psi$ 通过 FFT 计算：$\\partial_x \\psi = \\mathcal{F}^{-1}\\{ i k \\mathcal{F}\\{\\psi\\} \\}$。然后，积分作为对格点的求和来计算。对于像动量这样的 Hermitian 算符，其期望值 $\\langle p \\rangle$ 必须是实数；由数值不精确性产生的任何微小虚部都将被丢弃。\n\n模拟结束后，获得一个动量期望值的时间序列 $\\{(t_n, \\langle p \\rangle(t_n))\\}$（其中 $n=0, \\ldots, N_t$）。对这些数据执行线性最小二乘回归，以确定数值斜率 $s$。`numpy.polyfit` 函数适用于此任务。\n\n最后，对于每个测试用例，将计算出的斜率 $s$ 与理论值 $-\\alpha$ 进行比较。对布尔条件 $|\\,s - (-\\alpha)\\,| \\leq \\tau$ 进行评估，并将所有测试的结果汇总到指定的输出格式中。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the simulation for all test cases and print the results.\n    \"\"\"\n\n    def run_simulation(L, N, dt, Nt, sigma, x0, alpha, k0, tau):\n        \"\"\"\n        Simulates the time evolution of a 1D Gaussian wave packet in a linear potential\n        and quantitatively verifies Ehrenfest's theorem for momentum.\n\n        Args:\n            L (float): Length of the periodic spatial domain.\n            N (int): Number of grid points.\n            dt (float): Time step for the simulation.\n            Nt (int): Total number of time steps.\n            sigma (float): Initial root-mean-square width of the wave packet.\n            x0 (float): Initial center position of the wave packet.\n            alpha (float): Slope of the linear potential V(x) = alpha * x.\n            k0 (float): Initial mean wavenumber of the wave packet.\n            tau (float): Tolerance for comparing the theoretical and numerical slopes.\n\n        Returns:\n            bool: True if the absolute deviation between the measured slope and the\n                  theoretical slope (-alpha) is within the tolerance tau, False otherwise.\n        \"\"\"\n        # 1. Setup of Computational Grids\n        # Spatial grid (domain from -L/2 to L/2)\n        dx = L / N\n        x = np.linspace(-L / 2.0, L / 2.0 - dx, N)\n        # Wavenumber (momentum) grid for FFT\n        k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n        # 2. Initialization of the Wave Packet\n        # Analytic normalization constant for an infinite domain\n        norm_factor = (2 * np.pi * sigma**2)**(-0.25)\n        # Initial wave function (Gaussian packet)\n        psi = norm_factor * np.exp(-(x - x0)**2 / (4 * sigma**2) + 1j * k0 * x)\n        # Numerical normalization on the discrete periodic grid\n        psi /= np.sqrt(np.sum(np.abs(psi)**2) * dx)\n\n        # 3. Preparation of Time Evolution Operators\n        # These are pre-calculated for efficiency in the loop.\n        # Potential operator for a half time step in position space\n        V_op_half = np.exp(-0.5j * (alpha * x) * dt)\n        # Kinetic operator for a full time step in momentum space\n        T_op_full = np.exp(-0.5j * k**2 * dt)\n\n        # Arrays for storing data at each time step for final analysis\n        times = np.zeros(Nt + 1)\n        p_expectations = np.zeros(Nt + 1)\n\n        # 4. Time Evolution via Split-Step Fourier Method\n        for i in range(Nt + 1):\n            # Store current time\n            times[i] = i * dt\n\n            # Calculate and store the expectation value of momentum <p>\n            # <p> = integral(psi* (-i * d/dx) psi) dx\n            # The derivative is computed spectrally for consistency.\n            dpsi_dx = np.fft.ifft(1j * k * np.fft.fft(psi))\n            p_integrand = np.conj(psi) * (-1j * dpsi_dx)\n            p_exp = np.sum(p_integrand) * dx\n            p_expectations[i] = np.real(p_exp) # Must be real, np.real handles numerical noise.\n\n            # Evolve the wave function by one time step dt (if not the last point)\n            if i < Nt:\n                # First half-step in potential\n                psi *= V_op_half\n                # Full step in kinetic energy (in k-space)\n                psi_k = np.fft.fft(psi)\n                psi_k *= T_op_full\n                psi = np.fft.ifft(psi_k)\n                # Second half-step in potential\n                psi *= V_op_half\n\n        # 5. Analysis and Verification of Ehrenfest's Theorem\n        # Perform a linear least-squares fit on <p>(t) vs t to find the slope.\n        # This finds coefficients [slope, intercept] for the best-fit line.\n        slope, _ = np.polyfit(times, p_expectations, 1)\n\n        # According to Ehrenfest's theorem, the theoretical slope is -alpha.\n        theoretical_slope = -alpha\n\n        # Check if the absolute deviation is within the specified tolerance.\n        return np.abs(slope - theoretical_slope) <= tau\n\n    # Common simulation parameters for all test cases\n    L = 200.0\n    N = 1024\n    dt = 0.002\n    Nt = 1500\n    sigma = 5.0\n    x0 = -50.0\n\n    # Definition of test cases from the problem statement\n    # Each tuple is (alpha, k0, tolerance)\n    test_cases = [\n        (0.2, 3.0, 0.03),   # Test set A (general case)\n        (0.0, 2.0, 0.02),   # Test set B (free evolution)\n        (-0.3, 0.0, 0.03),  # Test set C (negative ramp)\n    ]\n\n    # Run simulation for each case and collect boolean results\n    results = []\n    for alpha, k0, tau in test_cases:\n        is_verified = run_simulation(L, N, dt, Nt, sigma, x0, alpha, k0, tau)\n        results.append(is_verified)\n\n    # Final print statement in the exact required format: [result_A,result_B,result_C]\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the main function to run the program.\nsolve()\n```", "id": "2450185"}]}