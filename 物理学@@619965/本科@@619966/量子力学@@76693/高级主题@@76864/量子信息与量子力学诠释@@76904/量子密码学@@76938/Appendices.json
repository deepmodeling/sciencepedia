{"hands_on_practices": [{"introduction": "量子密钥分发（QKD）的安全性核心在于能够探测到任何窃听行为。本练习将引导您分析最直接的“拦截-重发”攻击，并计算这种攻击在BB84协议中引入的理论量子比特错误率（Quantum Bit Error Rate, QBER）。通过这个计算，您将亲身体会到量子力学原理是如何让窃听行为“无所遁形”的，这是理解量子密码安全性的第一步 [@problem_id:2111556]。", "problem": "Alice 和 Bob 希望利用量子力学原理建立一个安全通信信道。他们采用了一种简化版的 Bennett-Brassard 1984 (BB84) 量子密钥分发协议。该协议使用两个互不相关的基（mutually unbiased bases）在单个量子比特（qubit）上编码信息：计算基（$Z$基），其标准正交态为 $|0\\rangle$ 和 $|1\\rangle$；以及对角基（$X$基），其标准正交态为 $|+\\rangle$ 和 $|-\\rangle$。这些基通过表达式 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$ 和 $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$ 相互关联。\n\n协议流程如下：对于一个长序列中的每个量子比特，Alice 随机选择一个要发送的比特（0 或 1）和一个用于编码的基（$Z$ 或 $X$）。例如，要在 $X$ 基中发送“1”，她会制备一个处于 $|-\\rangle$ 态的量子比特。Bob 在不知道 Alice 选择的情况下，随机选择一个基（$Z$ 或 $X$）来测量每个传入的量子比特。\n\n一个窃听者 Eve 对每个传输的量子比特执行“拦截-重发”攻击。对于她从 Alice 处拦截的每个量子比特，Eve 随机选择在 $Z$ 基或 $X$ 基中进行测量，每个基被选择的概率为 $1/2$。然后，她根据自己的测量结果，制备一个新的量子比特并发送给 Bob。\n\n在整个序列传输完毕后，Alice 和 Bob 公开宣布他们为每个量子比特使用的基。他们丢弃所有基不匹配的情况。然后，他们比较剩下情况（基匹配的情况）中的一部分结果样本，以检查是否存在窃听。在这个基匹配的子集中，对于任何给定的量子比特，出现分歧（错误）的期望概率是多少？\n\n请用精确分数表示你的答案。", "solution": "问题要求在 Eve 进行拦截-重发攻击的情况下，对于 Alice 和 Bob 选择了相同基的那些情形，Alice 发送的比特与 Bob 测量的比特之间出现分歧的期望概率。这个概率通常被称为量子比特错误率（Quantum Bit Error Rate, QBER）。\n\n我们需要考虑 Alice 的基选择 $B_A$ 与 Bob 的基选择 $B_B$ 相同的那部分通信。对于这种基匹配的条件，有两种情况：\n1.  Alice 和 Bob 都使用 $Z$ 基（$B_A = B_B = Z$）。\n2.  Alice 和 Bob 都使用 $X$ 基（$B_A = B_B = X$）。\n\n由于 Alice 和 Bob 的基选择是随机且独立的，因此在基匹配的子集中，这两种情况发生的可能性相等。我们可以计算每种情况下的错误概率。让我们将 Eve 随机选择的基表示为 $B_E$。\n\n**情况 1：Alice 和 Bob 都使用 $Z$ 基（$B_A = B_B = Z$）。**\n\nAlice 发送 $|0\\rangle$ 或 $|1\\rangle$。不失一般性，我们假设 Alice 通过制备一个处于 $|0\\rangle$ 态的量子比特来发送比特“0”。如果 Bob 测量到“1”，则发生错误。\n\nEve 拦截了 $|0\\rangle$ 态。\n- **子情况 1a：** Eve 以 $1/2$ 的概率选择 $Z$ 基（$B_E=Z$）。\n  她在 $\\{|0\\rangle, |1\\rangle\\}$ 基中测量 $|0\\rangle$ 态。她的测量结果将为“0”，概率为 $|\\langle 0 | 0 \\rangle|^2 = 1$。然后她将一个新制备的处于 $|0\\rangle$ 态的量子比特发送给 Bob。Bob 在 $Z$ 基中测量这个态，并以概率 1 正确地得到“0”。此子情况下的错误概率为 0。\n\n- **子情况 1b：** Eve 以 $1/2$ 的概率选择 $X$ 基（$B_E=X$）。\n  她在 $\\{|+\\rangle, |-\\rangle\\}$ 基中测量 $|0\\rangle$ 态。\n  测量到“+”的概率为 $P_E(+) = |\\langle + | 0 \\rangle|^2 = |\\frac{1}{\\sqrt{2}}(\\langle 0| + \\langle 1|)|0\\rangle|^2 = |\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$。然后她发送 $|+\\rangle$ 给 Bob。\n  测量到“-”的概率为 $P_E(-) = |\\langle - | 0 \\rangle|^2 = |\\frac{1}{\\sqrt{2}}(\\langle 0| - \\langle 1|)|0\\rangle|^2 = |\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$。然后她发送 $|-\\rangle$ 给 Bob。\n  Bob 收到来自 Eve 的量子比特，并在 $Z$ 基中进行测量。如果他测量到“1”，则发生错误。\n  - 如果 Bob 收到 $|+\\rangle$，测量到“1”的概率为 $P_B(1|+) = |\\langle 1 | + \\rangle|^2 = |\\langle 1 | \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle) \\rangle|^2 = |\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$。\n  - 如果 Bob 收到 $|-\\rangle$，测量到“1”的概率为 $P_B(1|-) = |\\langle 1 | - \\rangle|^2 = |\\langle 1 | \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle) \\rangle|^2 = |-\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$。\n  此子情况下发生错误的总概率，是 Eve 发送了一个导致 Bob 测量出错的态的概率，即 $\\frac{1}{2}$。\n\n情况 1 的总错误概率为各子情况错误概率的加权和：\n$P(\\text{error}|B_A=B_B=Z) = P(B_E=Z) \\times P(\\text{error}|B_E=Z) + P(B_E=X) \\times P(\\text{error}|B_E=X)$\n$P(\\text{error}|B_A=B_B=Z) = \\left(\\frac{1}{2}\\right) \\times 0 + \\left(\\frac{1}{2}\\right) \\times \\left(\\frac{1}{2}\\right) = \\frac{1}{4}$。\n\n**情况 2：Alice 和 Bob 都使用 $X$ 基（$B_A = B_B = X$）。**\n\nAlice 发送 $|+\\rangle$ 或 $|-\\rangle$。不失一般性，我们假设 Alice 在此基中发送比特“0”，对应于 $|+\\rangle$ 态。如果 Bob 测量到“-”，则发生错误。\n\nEve 拦截了 $|+\\rangle$ 态。\n- **子情况 2a：** Eve 以 $1/2$ 的概率选择 $X$ 基（$B_E=X$）。\n  她在 $\\{|+\\rangle, |-\\rangle\\}$ 基中测量 $|+\\rangle$ 态。她将以概率 $|\\langle + | + \\rangle|^2 = 1$ 得到“+”。她发送 $|+\\rangle$ 给 Bob。Bob 在 $X$ 基中测量，并以概率 1 正确地得到“+”。错误概率为 0。\n\n- **子情况 2b：** Eve 以 $1/2$ 的概率选择 $Z$ 基（$B_E=Z$）。\n  她在 $\\{|0\\rangle, |1\\rangle\\}$ 基中测量 $|+\\rangle$ 态。\n  测量到“0”的概率为 $P_E(0) = |\\langle 0 | + \\rangle|^2 = |\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$。然后她发送 $|0\\rangle$ 给 Bob。\n  测量到“1”的概率为 $P_E(1) = |\\langle 1 | + \\rangle|^2 = |\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$。然后她发送 $|1\\rangle$ 给 Bob。\n  Bob 收到来自 Eve 的量子比特，并在 $X$ 基中进行测量。如果他测量到“-”，则发生错误。\n  - 如果 Bob 收到 $|0\\rangle$，测量到“-”的概率为 $P_B(-|0) = |\\langle - | 0 \\rangle|^2 = |\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$。\n  - 如果 Bob 收到 $|1\\rangle$，测量到“-”的概率为 $P_B(-|1) = |\\langle - | 1 \\rangle|^2 = |-\\frac{1}{\\sqrt{2}}|^2 = \\frac{1}{2}$。\n  此子情况下的总错误概率为 $\\frac{1}{2}$。\n\n情况 2 的总错误概率为：\n$P(\\text{error}|B_A=B_B=X) = P(B_E=X) \\times P(\\text{error}|B_E=X) + P(B_E=Z) \\times P(\\text{error}|B_E=Z)$\n$P(\\text{error}|B_A=B_B=X) = \\left(\\frac{1}{2}\\right) \\times 0 + \\left(\\frac{1}{2}\\right) \\times \\left(\\frac{1}{2}\\right) = \\frac{1}{4}$。\n\n**结论：**\n在 Alice 和 Bob 的基匹配的两种可能情况（均为 $Z$ 基或均为 $X$ 基）下，由 Eve 的窃听导致的错误概率恰好为 $\\frac{1}{4}$。因此，在基匹配的子集中，出现分歧的总期望概率为 $\\frac{1}{4}$。", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "2111556"}, {"introduction": "在了解了基本的拦截-重发攻击后，一个自然的问题是：一个更“聪明”的窃听者能否通过改变其测量策略来更好地隐藏自己？本练习探讨了窃听者采用非均匀（有偏）的测量基选择策略时的情景。通过计算这种情况下产生的QBER，您将发现BB84协议在面对特定攻击类型时所具有的内在稳健性 [@problem_id:2236843]。", "problem": "在一个使用BB84协议的量子密钥分发（QKD）系统的简化模型中，发送方Alice向接收方Bob传输一个单光子序列。对于每次传输，Alice独立且等概率地选择一个比特值（0或1）和一个编码基：直线基（$+$）或对角基（$\\times$）。\n\n编码规则如下：\n- 在直线基（$+$）中：比特“0”编码为水平偏振态$|H\\rangle$，比特“1”编码为垂直偏振态$|V\\rangle$。\n- 在对角基（$\\times$）中：比特“0”编码为对角偏振态$|D\\rangle = \\frac{1}{\\sqrt{2}}(|H\\rangle + |V\\rangle)$，比特“1”编码为反对角偏振态$|A\\rangle = \\frac{1}{\\sqrt{2}}(|H\\rangle - |V\\rangle)$。\n\n一个窃听者Eve在量子信道上执行拦截重发攻击。对于Alice发送的每一个光子，Eve都会拦截它，测量其偏振，然后制备一个处于她刚测量得到的状态的新光子发送给Bob。Eve的测量策略是有偏的：对每个拦截的光子，她以概率$p_E = 3/4$随机选择在直线基（$+$）中测量，或以概率$1-p_E = 1/4$在对角基（$\\times$）中测量。\n\nBob不知道Eve的存在，他接收来自Eve的光子。对于每个接收到的光子，Bob独立且等概率地选择在直线基（$+$）或对角基（$\\times$）中进行测量。\n\n在整个传输过程结束后，Alice和Bob通过一个公共信道进行通信，以比较他们用于每个光子的基。他们丢弃所有基选择不匹配的测量结果。剩余的比特构成了筛选密钥。量子比特误码率（QBER）被定义为筛选密钥中Alice和Bob之间不一致的比特所占的比例。\n\n假设存在此协议和Eve的特定攻击策略，计算期望的QBER。请用精确分数表示你的答案。", "solution": "设Alice的基为$A \\in \\{+, \\times\\}$，其中$P(A=+)=P(A=\\times)=\\frac{1}{2}$。Eve在基$E \\in \\{+, \\times\\}$中测量，其中$P(E=+)=p_{E}=\\frac{3}{4}$且$P(E=\\times)=1-p_{E}=\\frac{1}{4}$。Bob的基为$B \\in \\{+, \\times\\}$，其中$P(B=+)=P(B=\\times)=\\frac{1}{2}$，且与$A$和$E$无关。\n\n筛选密钥由基匹配的事件组成，即$S=\\{B=A\\}$。由于$B$与$A$无关，我们有\n$$\nP(S)=P(B=A)=\\frac{1}{2}\n$$\n\n我们将QBER计算为$P(\\text{error}\\mid S)=\\frac{P(\\text{error}\\wedge S)}{P(S)}$。错误概率取决于Eve是否在与Alice相同的基中进行测量：\n- 如果$E=A$（Eve匹配了Alice的基），Eve的投影测量会确定性地得到Alice的比特，并且她会重发相同的本征态。当Bob在相同的基（$S$）中测量时，他会确定性地得到Alice的比特。因此，条件错误概率为$0$。\n- 如果$E\\neq A$（Eve使用了共轭基），根据Born法则，Eve的测量结果是随机的，并且她会重发一个错误基的本征态。当Bob在Alice的基（$S$）中测量时，他的结果与Alice的比特匹配或不匹配的概率是相等的。因此，条件错误概率为$\\frac{1}{2}$。\n\n因此，\n$$\nP(\\text{error}\\wedge S)=P(S\\wedge E\\neq A)\\cdot \\frac{1}{2}\n$$\n我们通过对$A$取条件来计算$P(S\\wedge E\\neq A)$：\n$$\nP(S\\wedge E\\neq A)=\\sum_{b\\in\\{+,\\times\\}} P(A=b)\\,P(B=b)\\,P(E\\neq b)\n=\\frac{1}{2}\\cdot\\frac{1}{2}\\left[(1-p_{E})+p_{E}\\right]\n=\\frac{1}{4}\n$$\n因此，\n$$\nP(\\text{error}\\wedge S)=\\frac{1}{2}\\cdot\\frac{1}{4}=\\frac{1}{8},\n\\qquad\n\\text{QBER}=P(\\text{error}\\mid S)=\\frac{P(\\text{error}\\wedge S)}{P(S)}=\\frac{\\frac{1}{8}}{\\frac{1}{2}}=\\frac{1}{4}\n$$\n这个结果与偏置$p_{E}$无关；特别是，对于$p_{E}=\\frac{3}{4}$，期望的QBER为$\\frac{1}{4}$。", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "2236843"}, {"introduction": "在真实世界中，通信信道并非完美，错误不仅可能来自窃听者，也可能源于环境噪声。本练习将视角从主动攻击转向被动的信道噪声，通过一个被称为“纯退相干”的实际噪声模型，来分析其对QKD系统性能的影响。计算由环境噪声引起的QBER，可以帮助您理解如何区分恶意窃听与不可避免的物理过程，这是实现可靠量子通信的关键一步 [@problem_id:2111559]。", "problem": "在一个量子通信系统中，Alice 希望使用 BB84 协议将一个密钥发送给 Bob。Alice 在两种基中的一种来制备量子比特：直线（$Z$）基，其状态为 $|0\\rangle$ 和 $|1\\rangle$；或对角（$X$）基，其状态为 $|+\\rangle$ 和 $|-\\rangle$。对于每次传输，她以相等的概率随机选择四个状态 $|0\\rangle, |1\\rangle, |+\\rangle, |-\\rangle$ 中的一个。\n\n这些状态定义如下：\n$|0\\rangle = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$， $|1\\rangle = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$\n$|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$， $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$\n\n量子比特通过一个引入纯退相干的噪声量子信道从 Alice 传输到 Bob。该信道对量子比特密度矩阵 $\\rho$ 的影响由 Kraus 算符和表示法 $\\mathcal{E}(\\rho) = E_0 \\rho E_0^\\dagger + E_1 \\rho E_1^\\dagger$ 描述，其 Kraus 算符为：\n$E_0 = \\sqrt{1-p} \\cdot I$\n$E_1 = \\sqrt{p} \\cdot Z$\n\n这里，$p$ 是发生退相干错误的概率，$I$ 是 $2 \\times 2$ 单位矩阵，$Z$ 是泡利-Z 矩阵，$Z = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}$。\n\n在接收到每个量子比特后，Bob 随机选择在 $Z$ 基或 $X$ 基中进行测量。传输完成后，Alice 和 Bob 公开宣布他们用于每个量子比特的基序列，并丢弃所有基不匹配的情况。\n\n协议的性能由量子比特错误率（QBER）来量化，即在筛选密钥（他们在其中使用相同测量基的比特子集）中，Alice 和 Bob 的比特值不同的比特所占的比例。\n\n计算该协议的 QBER，作为退相干概率 $p$ 的函数。", "solution": "Alice 以等概率发送四种 BB84 状态中的每一种。噪声信道是相位翻转（纯退相干），由 Kraus 算符 $E_{0}=\\sqrt{1-p}\\,I$ 和 $E_{1}=\\sqrt{p}\\,Z$ 描述，因此对于任何量子比特密度矩阵 $\\rho$，\n$$\n\\mathcal{E}(\\rho)=E_{0}\\rho E_{0}^{\\dagger}+E_{1}\\rho E_{1}^{\\dagger}=(1-p)\\rho+p\\,Z\\rho Z\n$$\nBob 在 $Z$ 基或 $X$ 基中进行测量，筛选密钥只保留 Alice 和 Bob 的基匹配的事件。\n\n首先考虑 $Z$ 基输入。对于 $|0\\rangle$ 和 $|1\\rangle$，密度矩阵为 $\\rho_{0}=|0\\rangle\\langle 0|$ 和 $\\rho_{1}=|1\\rangle\\langle 1|$。使用 $Z|0\\rangle=|0\\rangle$ 和 $Z|1\\rangle=-|1\\rangle$，我们有\n$$\nZ\\rho_{0}Z=\\rho_{0},\\qquad Z\\rho_{1}Z=\\rho_{1}\n$$\n因此，\n$$\n\\mathcal{E}(\\rho_{0})=(1-p)\\rho_{0}+p\\rho_{0}=\\rho_{0},\\qquad \\mathcal{E}(\\rho_{1})=\\rho_{1}\n$$\n在 $Z$ 基中进行投影测量，可以确定地得到 Alice 发送的比特值，因此在 $Z$ 基匹配的条件下，错误概率为 $0$。\n\n接下来考虑 $X$ 基输入。密度矩阵为\n$$\n\\rho_{+}=|+\\rangle\\langle +|=\\frac{1}{2}\\begin{pmatrix}1  1 \\\\ 1  1\\end{pmatrix},\\qquad\n\\rho_{-}=|-\\rangle\\langle -|=\\frac{1}{2}\\begin{pmatrix}1  -1 \\\\ -1  1\\end{pmatrix}\n$$\n使用 $Z|+\\rangle=|-\\rangle$ 和 $Z|-\\rangle=|+\\rangle$，我们得到\n$$\nZ\\rho_{+}Z=\\rho_{-},\\qquad Z\\rho_{-}Z=\\rho_{+}\n$$\n因此\n$$\n\\mathcal{E}(\\rho_{+})=(1-p)\\rho_{+}+p\\rho_{-},\\qquad \\mathcal{E}(\\rho_{-})=(1-p)\\rho_{-}+p\\rho_{+}\n$$\n对于一个使用投影算符 $P_{+}=\\rho_{+}$ 和 $P_{-}=\\rho_{-}$ 的 $X$ 基测量，从 $\\mathcal{E}(\\rho_{+})$ 中获得正确结果的概率是\n$$\n\\operatorname{Pr}(+|\\rho_{+})=\\operatorname{tr}(P_{+}\\mathcal{E}(\\rho_{+}))=(1-p)\\operatorname{tr}(P_{+}\\rho_{+})+p\\,\\operatorname{tr}(P_{+}\\rho_{-})=(1-p)\\cdot 1+p\\cdot 0=1-p\n$$\n所以错误概率是 $p$。从 $\\rho_{-}$ 开始，结果也是一样的。因此，在 $X$ 基匹配的条件下，错误概率是 $p$。\n\n筛选密钥由所有基匹配的事件组成。Alice 以各 $\\tfrac{1}{2}$ 的概率选择 $Z$ 基或 $X$ 基，Bob 也独立地以各 $\\tfrac{1}{2}$ 的概率选择每个基。在基匹配的条件下，匹配的基是 $Z$ 的概率等于它是 $X$ 的概率，即 $\\tfrac{1}{2}$。因此，定义为筛选密钥中错误比特分数的量子比特错误率（QBER）是加权平均值\n$$\n\\mathrm{QBER}=\\frac{1}{2}\\cdot 0+\\frac{1}{2}\\cdot p=\\frac{p}{2}\n$$", "answer": "$$\\boxed{\\frac{p}{2}}$$", "id": "2111559"}]}