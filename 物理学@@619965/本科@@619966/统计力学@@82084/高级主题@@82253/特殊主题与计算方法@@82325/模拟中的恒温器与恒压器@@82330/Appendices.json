{"hands_on_practices": [{"introduction": "在分子动力学模拟中，一个核心任务是维持系统在特定的目标温度。Berendsen恒温器通过一种称为“弱耦合”的方法来实现这一点，它在每个时间步中轻微地调整粒子速度，将系统与外部热浴联系起来。此练习将帮助你通过具体计算，直观地理解耦合时间常数 $\\tau_T$ 如何决定温度向目标值弛豫的速度，从而将这一抽象参数与可观察到的系统行为联系起来 [@problem_id:2013279]。", "problem": "在分子动力学 (MD) 模拟中，恒温器是一种用于控制模拟体系温度的算法。一种常见的方法是 Berendsen 恒温器，它将体系与一个具有固定目标温度 $T_0$ 的外部热浴弱耦合。这是通过在每个时间步 $\\Delta t$ 用一个公共因子 $\\lambda$ 重标定所有粒子的速度来实现的。\n\n体系的温度与其总动能成正比。因此，用 $\\lambda$ 重标定速度会使动能变为原来的 $\\lambda^2$ 倍，从而温度也变为原来的 $\\lambda^2$ 倍。该标度因子使用以下公式计算：\n$$ \\lambda^2 = 1 + \\frac{\\Delta t}{\\tau_T} \\left( \\frac{T_0}{T} - 1 \\right) $$\n其中 $T$ 是时间步开始时体系的瞬时温度，而 $\\tau_T$ 是时间耦合常数，它决定了体系温度向目标温度弛豫的速度。较小的 $\\tau_T$ 意味着与热浴的耦合更强，温度弛豫更快。\n\n一位研究人员正在模拟一个氩原子体系。在模拟的某个特定时刻，测得体系的温度为 $T = 360.0 \\text{ K}$。目标温度设定为 $T_0 = 300.0 \\text{ K}$，模拟时间步为 $\\Delta t = 2.0 \\text{ fs}$。作为参考，1 皮秒 (ps) = 1000 飞秒 (fs)。\n\n该研究人员想了解耦合常数的选择如何影响温度的演化。他们考虑两种情况：$\\tau_T^{\\text{strong}} = 0.4 \\text{ ps}$ 的“强”耦合和 $\\tau_T^{\\text{weak}} = 4.0 \\text{ ps}$ 的“弱”耦合。计算在强耦合和弱耦合两种情况下，体系在一个时间步后的预期温度 $T(t+\\Delta t)$。\n\n以下哪个选项正确地给出了这对温度 $(T_{\\text{strong}}(t+\\Delta t), T_{\\text{weak}}(t+\\Delta t))$？所有温度单位均为开尔文 (K)。\n\nA. (359.7 K, 359.97 K)\n\nB. (360.3 K, 360.03 K)\n\nC. (300.0 K, 300.0 K)\n\nD. (363.0 K, 360.3 K)\n\nE. (357.0 K, 359.7 K)", "solution": "问题要求计算在两种不同的恒温器耦合常数 $\\tau_T^{\\text{strong}}$ 和 $\\tau_T^{\\text{weak}}$ 条件下，体系在一个时间步后的温度 $T(t+\\Delta t)$。\n\n新时间步的温度 $T(t+\\Delta t)$ 是通过将当前温度 $T(t)$ 乘以 Berendsen 标度因子 $\\lambda^2$ 得到的。\n$$ T(t+\\Delta t) = \\lambda^2 T(t) $$\n标度因子的公式如下所示：\n$$ \\lambda^2 = 1 + \\frac{\\Delta t}{\\tau_T} \\left( \\frac{T_0}{T(t)} - 1 \\right) $$\n将 $\\lambda^2$ 的表达式代入温度更新方程，我们得到：\n$$ T(t+\\Delta t) = T(t) \\left[ 1 + \\frac{\\Delta t}{\\tau_T} \\left( \\frac{T_0}{T(t)} - 1 \\right) \\right] $$\n将 $T(t)$ 乘进去可以简化此表达式：\n$$ T(t+\\Delta t) = T(t) + T(t) \\frac{\\Delta t}{\\tau_T} \\left( \\frac{T_0}{T(t)} - 1 \\right) $$\n$$ T(t+\\Delta t) = T(t) + \\frac{\\Delta t}{\\tau_T} \\left( T(t) \\frac{T_0}{T(t)} - T(t) \\right) $$\n$$ T(t+\\Delta t) = T(t) + \\frac{\\Delta t}{\\tau_T} (T_0 - T(t)) $$\n这个简化后的公式直接通过温差给出新温度。我们现在使用这个公式并代入给定参数进行计算。\n\n给定参数如下：\n当前温度，$T(t) = 360.0 \\text{ K}$\n目标温度，$T_0 = 300.0 \\text{ K}$\n时间步，$\\Delta t = 2.0 \\text{ fs}$\n\n我们需要确保时间单位一致。给定的 $\\tau_T$ 以皮秒 (ps) 为单位，而 $\\Delta t$ 以飞秒 (fs) 为单位。我们使用换算关系 1 ps = 1000 fs。所以，$\\Delta t = 2.0 \\text{ fs} = 0.0020 \\text{ ps}$。\n\n**情况1：强耦合**\n对于强耦合情况，$\\tau_T^{\\text{strong}} = 0.4 \\text{ ps}$。\n首先，我们计算无量纲比率 $\\frac{\\Delta t}{\\tau_T^{\\text{strong}}}$：\n$$ \\frac{\\Delta t}{\\tau_T^{\\text{strong}}} = \\frac{0.0020 \\text{ ps}}{0.4 \\text{ ps}} = 0.005 $$\n现在，我们计算下一步的温度 $T_{\\text{strong}}(t+\\Delta t)$：\n$$ T_{\\text{strong}}(t+\\Delta t) = T(t) + \\frac{\\Delta t}{\\tau_T^{\\text{strong}}} (T_0 - T(t)) $$\n$$ T_{\\text{strong}}(t+\\Delta t) = 360.0 \\text{ K} + 0.005 \\times (300.0 \\text{ K} - 360.0 \\text{ K}) $$\n$$ T_{\\text{strong}}(t+\\Delta t) = 360.0 \\text{ K} + 0.005 \\times (-60.0 \\text{ K}) $$\n$$ T_{\\text{strong}}(t+\\Delta t) = 360.0 \\text{ K} - 0.3 \\text{ K} $$\n$$ T_{\\text{strong}}(t+\\Delta t) = 359.7 \\text{ K} $$\n\n**情况2：弱耦合**\n对于弱耦合情况，$\\tau_T^{\\text{weak}} = 4.0 \\text{ ps}$。\n首先，我们计算无量纲比率 $\\frac{\\Delta t}{\\tau_T^{\\text{weak}}}$：\n$$ \\frac{\\Delta t}{\\tau_T^{\\text{weak}}} = \\frac{0.0020 \\text{ ps}}{4.0 \\text{ ps}} = 0.0005 $$\n现在，我们计算下一步的温度 $T_{\\text{weak}}(t+\\Delta t)$：\n$$ T_{\\text{weak}}(t+\\Delta t) = T(t) + \\frac{\\Delta t}{\\tau_T^{\\text{weak}}} (T_0 - T(t)) $$\n$$ T_{\\text{weak}}(t+\\Delta t) = 360.0 \\text{ K} + 0.0005 \\times (300.0 \\text{ K} - 360.0 \\text{ K}) $$\n$$ T_{\\text{weak}}(t+\\Delta t) = 360.0 \\text{ K} + 0.0005 \\times (-60.0 \\text{ K}) $$\n$$ T_{\\text{weak}}(t+\\Delta t) = 360.0 \\text{ K} - 0.03 \\text{ K} $$\n$$ T_{\\text{weak}}(t+\\Delta t) = 359.97 \\text{ K} $$\n\n计算出的温度对是 $(359.7 \\text{ K}, 359.97 \\text{ K})$。这对应于选项 A。正如预期的那样，更强的耦合（较小的 $\\tau_T$）在单个时间步内导致了更大的温度变化，使体系的温度更快地趋向目标温度。", "answer": "$$\\boxed{A}$$", "id": "2013279"}, {"introduction": "除了简单的速度重缩放，随机恒温器为模拟热浴提供了一个更符合物理实际的模型。Langevin恒温器通过引入代表能量耗散的摩擦项和代表随机碰撞的随机力项来模拟溶剂分子的影响。本练习探讨了连接这两个项的一个深刻物理原理——涨落-耗散定理——并让你亲自推导它如何确保系统最终能达到正确的平衡温度 [@problem_id:2013289]。", "problem": "一个质量为 $m$ 的球形纳米粒子悬浮在静止流体中。研究其沿x轴的一维运动。系统保持在恒定的平衡温度 $T$ 下。该纳米粒子的速度 $v(t)$ 可以很好地用朗之万方程描述：$m \\frac{dv}{dt} = F_{drag} + F_{stochastic}$。\n\n来自流体的阻力由 $F_{drag} = -\\gamma v$ 给出，其中 $\\gamma$ 是一个称为摩擦系数的正常数。项 $F_{stochastic}(t)$ 代表由于与流体分子的随机碰撞而产生的快速波动的随机力。该力的均值为零，即对所有 $t$ 都有 $\\langle F_{stochastic}(t) \\rangle = 0$。\n\n随机力的一个关键性质是其时间自相关。实验测量已经确定了积分自相关的值，其定义为：\n$$ \\Sigma = \\int_{-\\infty}^{\\infty} \\langle F_{stochastic}(0) F_{stochastic}(\\tau) \\rangle d\\tau $$\n其中 $\\langle \\dots \\rangle$ 表示系综平均。\n\n假设系统处于热平衡状态，求平衡温度 $T$ 的解析表达式。你的答案应该用 $\\gamma$、$\\Sigma$ 和玻尔兹曼常数 $k_B$ 来表示。", "solution": "我们从一维朗之万方程出发\n$$\nm \\frac{dv}{dt}=-\\gamma v+F(t),\n$$\n其中 $F(t)\\equiv F_{stochastic}(t)$ 是一个零均值平稳随机力，其自相关为 $C_{F}(\\tau)=\\langle F(0)F(\\tau)\\rangle$，积分自相关为\n$$\n\\Sigma=\\int_{-\\infty}^{\\infty}C_{F}(\\tau)\\,d\\tau.\n$$\n我们求解稳态、因果形式的线性随机微分方程。确定性部分的脉冲响应为 $h(t)=\\frac{1}{m}\\exp\\!\\left(-\\frac{\\gamma}{m}t\\right)H(t)$，其中 $H$ 是亥维赛阶跃函数，因此速度为\n$$\nv(t)=\\int_{-\\infty}^{t}h(t-s)F(s)\\,ds=\\frac{1}{m}\\int_{-\\infty}^{t}\\exp\\!\\left(-\\frac{\\gamma}{m}(t-s)\\right)F(s)\\,ds.\n$$\n为了进行能量平衡，将朗之万方程乘以 $v(t)$ 并取系综平均：\n$$\nm\\,\\Big\\langle v\\frac{dv}{dt}\\Big\\rangle=-\\gamma\\langle v^{2}\\rangle+\\langle F(t)v(t)\\rangle.\n$$\n由于 $\\frac{d}{dt}\\left(\\frac{1}{2}m\\langle v^{2}\\rangle\\right)=m\\langle v\\,\\frac{dv}{dt}\\rangle$，稳态意味着 $\\frac{d}{dt}\\langle v^{2}\\rangle=0$，因此\n$$\n\\gamma\\langle v^{2}\\rangle=\\langle F(t)v(t)\\rangle.\n$$\n使用 $v(t)$ 的线性解，\n$$\n\\langle F(t)v(t)\\rangle=\\frac{1}{m}\\int_{-\\infty}^{t}\\exp\\!\\left(-\\frac{\\gamma}{m}(t-s)\\right)\\langle F(t)F(s)\\rangle\\,ds.\n$$\n根据平稳性，$\\langle F(t)F(s)\\rangle=C_{F}(t-s)$。令 $\\tau=t-s\\geq 0$，则 $ds=-d\\tau$，积分限映射为 $\\tau\\in[0,\\infty)$。于是\n$$\n\\langle F(t)v(t)\\rangle=\\frac{1}{m}\\int_{0}^{\\infty}\\exp\\!\\left(-\\frac{\\gamma}{m}\\tau\\right)C_{F}(\\tau)\\,d\\tau.\n$$\n因此，\n$$\n\\gamma\\langle v^{2}\\rangle=\\frac{1}{m}\\int_{0}^{\\infty}\\exp\\!\\left(-\\frac{\\gamma}{m}\\tau\\right)C_{F}(\\tau)\\,d\\tau.\n$$\n在热平衡时，能量均分定理给出\n$$\n\\frac{1}{2}m\\langle v^{2}\\rangle=\\frac{1}{2}k_{B}T\\quad\\Rightarrow\\quad \\langle v^{2}\\rangle=\\frac{k_{B}T}{m}.\n$$\n将此代入平衡关系式并将两边同乘以 $m$ 得到\n$$\n\\gamma k_{B}T=\\int_{0}^{\\infty}\\exp\\!\\left(-\\frac{\\gamma}{m}\\tau\\right)C_{F}(\\tau)\\,d\\tau.\n$$\n力被描述为快速波动的，因此其相关时间远小于弛豫时间 $m/\\gamma$。在此极限下，在 $C_F(\\tau)$ 显著不为零的区域内，指数因子可以近似为 1：\n$$\n\\int_{0}^{\\infty}\\exp\\!\\left(-\\frac{\\gamma}{m}\\tau\\right)C_{F}(\\tau)\\,d\\tau\\approx\\int_{0}^{\\infty}C_{F}(\\tau)\\,d\\tau.\n$$\n由于对于一个实平稳过程，$C_{F}(\\tau)$ 是一个偶函数，我们有\n$$\n\\Sigma=\\int_{-\\infty}^{\\infty}C_{F}(\\tau)\\,d\\tau=2\\int_{0}^{\\infty}C_{F}(\\tau)\\,d\\tau.\n$$\n因此，\n$$\n\\gamma k_{B}T\\approx\\frac{\\Sigma}{2}.\n$$\n等价地，在白噪声极限 $C_{F}(\\tau)=2\\gamma k_{B}T\\,\\delta(\\tau)$ 下，$C_{F}$ 在所有 $\\tau$ 上的积分恰好是 $\\Sigma=2\\gamma k_{B}T$，这导致了相同的结果。对 $T$ 求解得到平衡温度\n$$\nT=\\frac{\\Sigma}{2\\gamma k_{B}}.\n$$", "answer": "$$\\boxed{\\frac{\\Sigma}{2\\gamma k_{B}}}$$", "id": "2013289"}, {"introduction": "掌握了温度控制后，我们转向对压力的控制，这对于模拟许多恒压下的真实物理和化学过程至关重要。Parrinello-Rahman恒压器将模拟盒的体积视为一个具有自身“质量”或惯性的动态变量。通过将体积涨落建模为一个简谐振子，这个练习为你提供了一个关于“活塞质量”参数 $W$ 的直观物理图像，并帮助你理解它如何影响系统体积对内外压差的动态响应 [@problem_id:2013246]。", "problem": "在许多分子动力学模拟中，系统通过使用恒压器来维持恒定压力，恒压器会动态地调节模拟盒子的体积。其中一种受 Parrinello-Rahman 方法启发的方法，将盒子体积 $V$ 建模为一个动力学变量，并为其关联一个“活塞质量”$W$。对于一个处于各向同性 NPT（恒定粒子数、压力和温度）系综中的系统，其体积在平衡体积 $V_0$ 附近的小涨落 $\\delta V(t) = V(t) - V_0$ 的有效运动方程可以写为：\n$$W \\frac{d^2(\\delta V)}{dt^2} = P_{int}(V) - P_{ext}$$\n其中 $P_{ext}$ 是目标外部压力，$P_{int}(V)$ 是系统的瞬时内部压力。当偏离平衡态很小时，内部压力可以通过其平衡值附近的线性展开来近似：\n$$P_{int}(V) \\approx P_{int}(V_0) - \\frac{1}{V_0 \\kappa_T} (V - V_0)$$\n在平衡状态下，平均内部压力等于外部压力，即 $P_{int}(V_0) = P_{ext}$。参数 $\\kappa_T$ 是被模拟物质的等温压缩率。\n\n假设体积涨落的行为如同一个简谐振子，推导出这些涨落的特征角频率 $\\omega$ 的表达式。请用活塞质量 $W$、平衡体积 $V_0$ 和等温压缩率 $\\kappa_T$ 来表示你的答案。", "solution": "我们从给定的关于小体积涨落 $\\delta V(t)=V(t)-V_{0}$ 的恒压器运动方程开始：\n$$\nW \\frac{d^{2}(\\delta V)}{dt^{2}} = P_{int}(V) - P_{ext}.\n$$\n对于 $V_{0}$ 附近的小偏离，内部压力线性近似为\n$$\nP_{int}(V) \\approx P_{int}(V_{0}) - \\frac{1}{V_{0}\\kappa_{T}}(V - V_{0}) = P_{int}(V_{0}) - \\frac{1}{V_{0}\\kappa_{T}}\\delta V.\n$$\n在平衡状态下，$P_{int}(V_{0}) = P_{ext}$，因此将其代入运动方程可得\n$$\nW \\frac{d^{2}(\\delta V)}{dt^{2}} = \\left[P_{int}(V_{0}) - \\frac{1}{V_{0}\\kappa_{T}}\\delta V\\right] - P_{ext} = - \\frac{1}{V_{0}\\kappa_{T}}\\delta V.\n$$\n重新整理，我们得到简谐振子形式\n$$\nW \\frac{d^{2}(\\delta V)}{dt^{2}} + \\frac{1}{V_{0}\\kappa_{T}}\\,\\delta V = 0,\n$$\n该方程与 $m \\ddot{x} + k x = 0$ 的形式相匹配，其中有效质量 $m = W$，劲度系数 $k = \\frac{1}{V_{0}\\kappa_{T}}$。因此，特征角频率为\n$$\n\\omega = \\sqrt{\\frac{k}{m}} = \\sqrt{\\frac{1}{W V_{0} \\kappa_{T}}}.\n$$", "answer": "$$\\boxed{\\sqrt{\\frac{1}{W V_{0} \\kappa_{T}}}}$$", "id": "2013246"}]}