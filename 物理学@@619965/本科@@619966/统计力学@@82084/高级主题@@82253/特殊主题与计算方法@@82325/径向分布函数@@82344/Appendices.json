{"hands_on_practices": [{"introduction": "在我们深入复杂的计算之前，首先必须巩固我们对径向分布函数基本性质的理解。第一个练习提供了一个基于计算机模拟中假设情景的概念性检验 [@problem_id:2007503]。通过分析为何 $g(r)$ 不能为负值，你将加深对其作为局部粒子密度量度的核心定义的掌握。", "problem": "在统计力学中，由相同粒子组成的简单流体的结构可以用径向分布函数 $g(r)$ 来描述。该函数的定义为：对于一个平均数密度为 $\\rho = N/V$ 的系统，量 $\\rho g(r)$ 表示距离任意一个中心粒子 $r$ 处粒子的局域数密度。因此，在以某个粒子为中心、半径为 $r$、无穷小厚度为 $dr$ 的薄球壳内，找到的平均粒子数为 $dN = \\rho g(r) 4 \\pi r^2 dr$。\n\n一名本科生正在对液态氩进行分子动力学模拟。在对粒子轨迹进行后处理后，该学生绘制了计算出的径向分布函数 $g(r)$。令他惊讶的是，绘图显示 $g(r)$ 在一个很小的距离范围内变为负值，具体来说，是在 $r$ 处于 $0.5$ nm 和 $0.6$ nm 之间时。尽管该学生怀疑其分析代码中存在错误，但他想先确定这样的结果是否在根本上是非物理的。\n\n下列哪个陈述为该学生得到的负值 $g(r)$ 结果必然是错误的提供了最根本和最直接的理由？\n\nA. $g(r)$ 为负值意味着在特定空间区域内的平均粒子数为负，这在物理上是不可能的。\n\nB. 负的 $g(r)$ 会违反 $g(r)$ 与平均力势 $W(r)$ 之间的关系 $g(r) = \\exp(-W(r)/(k_B T))$，因为指数函数不能为负。\n\nC. 该结果与流体中径向分布函数的已知渐近行为不一致，该行为要求当 $r$ 趋于无穷大时 $g(r)$ 必须趋于 1。\n\nD. 这样的结果会违反维里状态方程，该方程将压力与 $r \\frac{du(r)}{dr} g(r)$ 的积分联系起来，因为它将意味着对压力的非物理贡献。\n\nE. 负的 $g(r)$ 将意味着对关联函数 $h(r) = g(r) - 1$ 小于 -1，这是结构因子 $S(k)$ 的归一化条件所不允许的。", "solution": "根据定义，在数密度为 $\\rho$ 的均匀流体中，引入径向分布函数 $g(r)$，使得距离一个标记粒子 $r$ 处的局域平均数密度为 $\\rho g(r)$。因此，在半径为 $r$、厚度为 $dr$ 的薄球壳中的平均粒子数为\n$$\ndN=\\rho\\,g(r)\\,4\\pi r^{2}\\,dr.\n$$\n对于任何空间区域，该区域内的粒子数是一个非负整数值的随机变量。因此，其期望值必须满足\n$$\ndN \\ge 0.\n$$\n由于 $\\rho>0$，对于 $r>0$ 有 $4\\pi r^{2}>0$，并且 $dr>0$，因此要使 $dN$ 对所有 $r$ 都为非负的唯一方式是\n$$\ng(r)\\ge 0 \\quad \\text{for all } r>0.\n$$\n因此，$g(r)$ 的负值将意味着该球壳的 $dN<0$，这与 $dN$ 作为平均计数的其基本概率意义直接矛盾。这就是负的 $g(r)$ 是非物理的最根本和最直接的原因。\n\n为了完整起见，我们将其余陈述进行比较：\n- 陈述 B 援引了 $g(r)=\\exp(-W(r)/(k_{B}T))$。虽然这种形式保证了 $g(r)>0$，但它依赖于通过 $W(r)=-k_{B}T\\,\\ln g(r)$ 定义平均力势，而这预设了 $g(r)>0$。因此，与上述的计数论证相比，它作为证明其为正值的理由不那么根本。\n- 陈述 C 涉及当 $r\\to\\infty$ 时 $g(r)\\to 1$ 的渐近极限，这并不排除 $g(r)$ 在中间的 $r$ 值处变为负值，因此它不是一个直接的矛盾。\n- 陈述 D 引用了维里状态方程。即使 $g(r)$ 在一个小的范围内为负，维里方程中的积分原则上仍可能产生一个有限的压力，所以这不是最直接或最根本的理由。\n- 陈述 E 提及了 $h(r)=g(r)-1$ 和结构因子约束。最直接的约束就是来自计数论证的 $g(r)\\ge 0$；诉诸 $S(k)$ 归一化则更为间接，不是主要原因。\n\n因此，最根本和最直接的理由由陈述 A 给出。", "answer": "$$\\boxed{A}$$", "id": "2007503"}, {"introduction": "径向分布函数为物质的不同状态提供了独特的标志。对于一个完美的晶体，这个函数表现为一系列尖锐的峰。这个练习邀请你通过计算简立方晶格中相邻原子壳层的位置来探索这种理想情况 [@problem_id:1820799]，从而将抽象的 $g(r)$ 函数与具体的晶体几何结构联系起来。", "problem": "在凝聚态物质的研究中，径向分布函数（表示为 $g(r)$）是描述粒子系统平均结构的有力工具。对于绝对零度下的完美晶体固体，该函数简化为一系列离散的、无限尖锐的峰。每个峰的位置 $r$ 对应于从一个参考原子到特定邻近原子壳层的距离。\n\n考虑一种单原子元素的假设单晶，它形成一个完美的简单立方（SC）晶格。在SC晶格中，原子位于一个在整个晶体中重复的概念立方体的顶点上。我们可以将此立方体的边长定义为晶格常数 $a$。通过将一个参考原子置于笛卡尔坐标系的原点 $(0, 0, 0)$，晶格中所有其他原子的位置可以用坐标向量 $(ia, ja, ka)$ 来描述，其中 $i, j, k$ 是整数，且三者不能同时为零。\n\n该晶格的径向分布函数中的第一个峰出现在距离 $r_1$ 处，对应于第一近邻原子集。第二个峰出现在距离 $r_2$ 处，对应于第二近邻原子集。\n\n确定该简单立方晶格的比率 $\\frac{r_2}{r_1}$ 的精确值。", "solution": "问题要求计算简单立方（SC）晶格中，第二近邻距离与第一近邻距离之比。\n\n我们建立一个坐标系，将一个参考原子置于原点 $(0, 0, 0)$。在晶格常数为 $a$ 的SC晶格中，所有其他原子的位置由向量 $\\vec{r} = (ia, ja, ka)$ 给出，其中 $i, j, k$ 是整数，且不全为零。\n\n从原点到任何其他原子的距离 $d$ 是该位置向量的模：\n$$d = |\\vec{r}| = \\sqrt{(ia)^2 + (ja)^2 + (ka)^2}$$\n$$d = a \\sqrt{i^2 + j^2 + k^2}$$\n为了找到到连续原子壳层的距离，我们需要找到 $d$ 的最小可能值。由于 $a$ 是一个常数，这等价于找到整数平方和 $S = i^2 + j^2 + k^2$ 的最小非零值。\n\n**第一近邻（距离 $r_1$）：**\n当整数（$i, j, k$）中的一个为 $\\pm 1$ 而另外两个为0时，平方和 $S = i^2 + j^2 + k^2$ 取得最小的非零值。\n例如，我们可以选择 $(i, j, k) = (1, 0, 0)$。\n平方和为 $S_1 = 1^2 + 0^2 + 0^2 = 1$。\n因此，到这些第一近邻的距离是：\n$$r_1 = a \\sqrt{S_1} = a \\sqrt{1} = a$$\n这些近邻位于诸如 $(\\pm a, 0, 0)$、$(0, \\pm a, 0)$ 和 $(0, 0, \\pm a)$ 的位置。\n\n**第二近邻（距离 $r_2$）：**\n为了找到第二近邻，我们必须找到平方和 $S = i^2 + j^2 + k^2$ 的下一个最小值。让我们检查接下来几个 $(i, j, k)$ 的整数组合：\n1.  如果两个整数为 $\\pm 1$，一个为 0（例如 $(1, 1, 0)$），则平方和为 $S = 1^2 + 1^2 + 0^2 = 2$。\n2.  如果三个整数都为 $\\pm 1$（例如 $(1, 1, 1)$），则平方和为 $S = 1^2 + 1^2 + 1^2 = 3$。\n3.  如果一个整数为 $\\pm 2$，其他为 0（例如 $(2, 0, 0)$），则平方和为 $S = 2^2 + 0^2 + 0^2 = 4$。\n\n比较这些可能的和，继 $S_1=1$ 之后的最小值为 $S_2=2$。这对应于第二近邻壳层。\n到这些第二近邻的距离是：\n$$r_2 = a \\sqrt{S_2} = a \\sqrt{2}$$\n这些近邻位于诸如 $(\\pm a, \\pm a, 0)$、$(\\pm a, 0, \\pm a)$ 和 $(0, \\pm a, \\pm a)$ 的位置，即沿着立方晶胞的面-对角线。\n\n**计算比率：**\n问题要求计算比率 $\\frac{r_2}{r_1}$。使用我们推导出的 $r_1$ 和 $r_2$ 的表达式：\n$$\\frac{r_2}{r_1} = \\frac{a \\sqrt{2}}{a}$$\n晶格常数 $a$ 被消去，剩下：\n$$\\frac{r_2}{r_1} = \\sqrt{2}$$\n因此，对于SC晶格，径向分布函数中第二个峰与第一个峰的位置之比为 $\\sqrt{2}$。", "answer": "$$\\boxed{\\sqrt{2}}$$", "id": "1820799"}, {"introduction": "除了理想化的模型，我们如何从真实的实验或模拟数据中确定径向分布函数呢？这最后一个练习提供了一个关于数值计算的动手实践 [@problem_id:2007519]。通过使用一小组粒子坐标，你将学习分步算法来计算 $g(r)$ 的分箱估计值，从而弥合理论概念与实际数据分析之间的差距。", "problem": "径向分布函数 $g(r)$ 描述了一个粒子系统中密度如何随与一个参考粒子的距离而变化。对于一个面积为 $A$、包含 $N$ 个粒子的二维系统，在任意给定粒子周围半径为 $r$、厚度为 $dr$ 的环带中发现的平均粒子数 $dN$ 由 $dN = \\rho_0 g(r) (2\\pi r dr)$ 给出，其中 $\\rho_0 = N/A$ 是平均数密度。\n\n我们来分析一个二维流体计算机模拟的单张快照。该模拟包含 $N=5$ 个粒子，位于边长 $L=10$ 任意单位的正方形盒子中。为简便起见，在距离计算中忽略周期性边界条件。这五个粒子的坐标 $(x,y)$ 如下：\nP1: (1, 2)\nP2: (3, 4)\nP3: (7, 6)\nP4: (8, 1)\nP5: (4, 8)\n\n根据这一单个构型，计算距离区间为 $4 \\le r < 5$ 的径向分布函数 $g(r)$ 的数值估计。\n\n将您的答案表示为封闭形式的解析表达式。", "solution": "题目要求基于单个粒子位置快照，计算特定距离区间的径向分布函数 $g(r)$ 的数值估计。\n\n首先，我们必须从给定的 $g(r)$ 定义中推导出区间估计值 $g_{est}$ 的公式。定义指出，在中心粒子周围半径为 $r$、宽度为 $dr$ 的无限小环带中的平均粒子数 $dN$ 为 $dN = \\rho_0 g(r) (2\\pi r dr)$。\n\n为了找到从 $r_{min}$ 到 $r_{max}$ 的有限环带（一个区间）中的粒子数 $\\Delta N$，我们对该表达式进行积分：\n$$ \\Delta N = \\int_{r_{min}}^{r_{max}} \\rho_0 g(r) 2\\pi r dr $$\n对于一个小的区间，我们可以将区间内的 $g(r)$ 近似为一个常数值 $g_{est}$。\n$$ \\Delta N \\approx \\rho_0 g_{est} \\int_{r_{min}}^{r_{max}} 2\\pi r dr $$\n$$ \\Delta N \\approx \\rho_0 g_{est} \\left[ \\pi r^2 \\right]_{r_{min}}^{r_{max}} = \\rho_0 g_{est} \\pi(r_{max}^2 - r_{min}^2) $$\n项 $\\pi(r_{max}^2 - r_{min}^2)$ 是环带的面积 $A_{annulus}$。因此，$\\Delta N \\approx \\rho_0 g_{est} A_{annulus}$。我们可以重新整理这个式子来求解我们想要的量 $g_{est}$：\n$$ g_{est} = \\frac{\\Delta N}{\\rho_0 A_{annulus}} $$\n此处，$\\Delta N$ 是在环带中找到的粒子*平均*数，该平均值是对所有可能的中心粒子选择进行平均得到的。在我们这个包含 $N$ 个粒子的单张快照中，我们可以通过计算每个粒子的邻居数然后求平均来估计这个平均值。设 $N_i$ 是粒子 $i$ 周围指定环带内的粒子 $j$（其中 $j \\neq i$）的数量。$\\Delta N$ 的估计值是这些计数的平均值：\n$$ \\Delta N_{est} = \\frac{1}{N} \\sum_{i=1}^{N} N_i $$\n求和项 $\\sum_{i=1}^{N} N_i$ 将每个间距在区间内的粒子对 $\\{i,j\\}$ 计数了两次（一次以 $i$ 为中心，一次以 $j$ 为中心）。设 $N_p$ 是其间距落在该区间内的唯一粒子对的总数。那么 $\\sum_{i=1}^{N} N_i = 2 N_p$。因此，\n$$ \\Delta N_{est} = \\frac{2 N_p}{N} $$\n将此结果以及正方形盒子中的数密度定义 $\\rho_0 = N/A = N/L^2$ 代入 $g_{est}$ 的表达式中，我们得到：\n$$ g_{est} = \\frac{2 N_p / N}{(N/L^2) A_{annulus}} = \\frac{2 N_p L^2}{N^2 A_{annulus}} $$\n\n现在，我们将此公式应用于给定的数据。\n参数如下：\n- 粒子数，$N=5$。\n- 盒子边长，$L=10$ 单位。\n- 距离区间为 $[4, 5)$，因此 $r_{min}=4$ 且 $r_{max}=5$。\n\n首先，计算环带的面积 $A_{annulus}$：\n$$ A_{annulus} = \\pi(r_{max}^2 - r_{min}^2) = \\pi(5^2 - 4^2) = \\pi(25 - 16) = 9\\pi $$\n\n接下来，我们必须为所有唯一的粒子对计算其对间距 $d_{ij} = \\sqrt{(x_i-x_j)^2 + (y_i-y_j)^2}$，并计算有多少个（即 $N_p$）落在 $4 \\le d_{ij} < 5$ 的范围内。共有 $\\frac{N(N-1)}{2} = \\frac{5(4)}{2} = 10$ 个唯一粒子对。\n粒子坐标为：P1(1,2), P2(3,4), P3(7,6), P4(8,1), P5(4,8)。\n\n1.  $d_{12} = \\sqrt{(3-1)^2 + (4-2)^2} = \\sqrt{2^2 + 2^2} = \\sqrt{8} \\approx 2.828$\n2.  $d_{13} = \\sqrt{(7-1)^2 + (6-2)^2} = \\sqrt{6^2 + 4^2} = \\sqrt{52} \\approx 7.211$\n3.  $d_{14} = \\sqrt{(8-1)^2 + (1-2)^2} = \\sqrt{7^2 + (-1)^2} = \\sqrt{50} \\approx 7.071$\n4.  $d_{15} = \\sqrt{(4-1)^2 + (8-2)^2} = \\sqrt{3^2 + 6^2} = \\sqrt{45} \\approx 6.708$\n5.  $d_{23} = \\sqrt{(7-3)^2 + (6-4)^2} = \\sqrt{4^2 + 2^2} = \\sqrt{20}$。由于 $16 < 20 < 25$，我们有 $4 < \\sqrt{20} < 5$。该对在区间内。（$\\sqrt{20} \\approx 4.472$）\n6.  $d_{24} = \\sqrt{(8-3)^2 + (1-4)^2} = \\sqrt{5^2 + (-3)^2} = \\sqrt{34} \\approx 5.831$\n7.  $d_{25} = \\sqrt{(4-3)^2 + (8-4)^2} = \\sqrt{1^2 + 4^2} = \\sqrt{17}$。由于 $16 < 17 < 25$，我们有 $4 < \\sqrt{17} < 5$。该对在区间内。（$\\sqrt{17} \\approx 4.123$）\n8.  $d_{34} = \\sqrt{(8-7)^2 + (1-6)^2} = \\sqrt{1^2 + (-5)^2} = \\sqrt{26} \\approx 5.099$\n9.  $d_{35} = \\sqrt{(4-7)^2 + (8-6)^2} = \\sqrt{(-3)^2 + 2^2} = \\sqrt{13} \\approx 3.606$\n10. $d_{45} = \\sqrt{(4-8)^2 + (8-1)^2} = \\sqrt{(-4)^2 + 7^2} = \\sqrt{65} \\approx 8.062$\n\n通过检查所有距离，我们发现有两对，即 {P2, P3} 和 {P2, P5}，其间距 $d$ 满足 $4 \\le d < 5$。因此，区间内的粒子对数量为 $N_p=2$。\n\n最后，将所有值代入估计公式：\n$$ g_{est} = \\frac{2 N_p L^2}{N^2 A_{annulus}} = \\frac{2 \\cdot 2 \\cdot (10)^2}{5^2 \\cdot (9\\pi)} = \\frac{4 \\cdot 100}{25 \\cdot 9\\pi} = \\frac{400}{225\\pi} $$\n化简分数：\n$$ g_{est} = \\frac{16 \\cdot 25}{9 \\cdot 25 \\cdot \\pi} = \\frac{16}{9\\pi} $$", "answer": "$$\\boxed{\\frac{16}{9\\pi}}$$", "id": "2007519"}]}