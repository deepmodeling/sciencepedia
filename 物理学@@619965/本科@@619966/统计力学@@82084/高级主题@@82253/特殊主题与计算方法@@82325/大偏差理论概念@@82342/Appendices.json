{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式莫过于动手实践。本节我们将从几个核心问题出发，加深对大偏差理论的理解。第一个练习将引导我们运用大偏差理论的基本“配方”——克拉默定理（Cramér's theorem），来为一个连续随机变量系统计算率函数。这个练习 [@problem_id:1976167] 模拟了放射性衰变等随机事件的时间间隔，通过计算其样本均值的率函数，你可以掌握从累积量生成函数（CGF）出发，通过勒让德-芬切尔变换（Legendre-Fenchel transform）求解率函数的标准流程。", "problem": "开发了一个计算机模拟程序，用于模拟间歇性事件的计时，例如放射性样本中连续两次粒子衰变之间的时间间隔。这些时间间隔记为 $T_1, T_2, \\ldots, T_N$，是作为 $N$ 个独立同分布的随机变量序列生成的。\n\n每个变量 $T_i$ 均从率参数为 $\\lambda_0 > 0$ 的指数分布中抽取。每个 $T_i$ 的概率密度函数为：当 $t \\ge 0$ 时，$p(t) = \\lambda_0 \\exp(-\\lambda_0 t)$；当 $t < 0$ 时，$p(t)=0$。\n\n该模拟的主要关注点是这些时间间隔的长期平均值，即样本均值，其定义为 $M_N = \\frac{1}{N} \\sum_{i=1}^{N} T_i$。对于非常大的样本数 $N$，该样本均值取一个与其期望值不同的值 $a$（其中 $a > 0$）的概率，可以使用大偏差原理进行估计。该原理指出，此概率具有以下渐近形式：\n$$P(M_N \\approx a) \\sim \\exp(-N I(a))$$\n在这里，$I(a)$ 是一个称为率函数的非负函数，它量化了观察到样本均值 $M_N$ 为值 $a$ 的指数级不可能性。\n\n求率函数 $I(a)$ 的解析表达式。你的答案应以变量 $a$ 和常数参数 $\\lambda_0$ 表示。", "solution": "我们有独立同分布的变量 $T_i$，其指数密度函数为 $p(t)=\\lambda_0\\exp(-\\lambda_0 t)$（$t\\geq 0$）。根据 Cramér 定理，样本均值 $M_N$ 的率函数是单个 $T$ 的累积量生成函数的 Legendre-Fenchel 变换：\n$$\nI(a)=\\sup_{\\theta\\lambda_0}\\{\\theta a-\\Lambda(\\theta)\\},\n$$\n其中 $\\Lambda(\\theta)=\\ln \\mathbb{E}[\\exp(\\theta T)]$，定义域限制 $\\theta\\lambda_0$ 确保了可积性。\n\n计算矩生成函数：\n$$\n\\mathbb{E}[\\exp(\\theta T)]=\\int_{0}^{\\infty}\\lambda_0\\exp(-\\lambda_0 t)\\exp(\\theta t)\\,dt=\\int_{0}^{\\infty}\\lambda_0\\exp\\bigl(-( \\lambda_0-\\theta)t\\bigr)\\,dt=\\frac{\\lambda_0}{\\lambda_0-\\theta},\n$$\n在 $\\theta\\lambda_0$ 时有效。因此，累积量生成函数是\n$$\n\\Lambda(\\theta)=\\ln\\left(\\frac{\\lambda_0}{\\lambda_0-\\theta}\\right)=\\ln(\\lambda_0)-\\ln(\\lambda_0-\\theta)=-\\ln\\left(1-\\frac{\\theta}{\\lambda_0}\\right),\\quad \\theta\\lambda_0.\n$$\n\n因此，\n$$\nI(a)=\\sup_{\\theta\\lambda_0}\\left\\{\\theta a+\\ln\\left(1-\\frac{\\theta}{\\lambda_0}\\right)\\right\\}.\n$$\n令 $f(\\theta)=\\theta a+\\ln\\left(1-\\frac{\\theta}{\\lambda_0}\\right)$。则\n$$\nf'(\\theta)=a-\\frac{1}{\\lambda_0-\\theta},\\qquad f''(\\theta)=-\\frac{1}{(\\lambda_0-\\theta)^{2}}0,\n$$\n因此，上确界在满足 $f'(\\theta)=0$ 的唯一驻点处取得：\n$$\na=\\frac{1}{\\lambda_0-\\theta^{*}}\\quad\\Longrightarrow\\quad \\theta^{*}=\\lambda_0-\\frac{1}{a}.\n$$\n将 $\\theta^{*}$ 代回 $f$ 中：\n$$\nI(a)=f(\\theta^{*})=a\\left(\\lambda_0-\\frac{1}{a}\\right)+\\ln\\left(1-\\frac{\\lambda_0-\\frac{1}{a}}{\\lambda_0}\\right)=\\lambda_0 a-1+\\ln\\left(\\frac{1}{a\\lambda_0}\\right).\n$$\n因此，对于 $a0$，\n$$\nI(a)=\\lambda_0 a-1-\\ln(\\lambda_0 a),\n$$\n该函数非负，并且在 $a=\\frac{1}{\\lambda_0}$ 处为零，这符合大偏差原理对指数变量样本均值的要求。", "answer": "$$\\boxed{\\lambda_0 a - 1 - \\ln(\\lambda_0 a)}$$", "id": "1976167"}, {"introduction": "除了通过累积量生成函数进行变换，我们还可以采用一种更直接、在物理学中非常普遍的方法来推导率函数。当我们可以直接写出观察到某个宏观状态的概率时，尤其是在涉及阶乘的组合计数问题中，斯特林近似（Stirling's approximation）便成为一个强有力的工具。这个练习 [@problem_id:1976169] 以泊松过程为背景，模拟了探测器中粒子到达的计数问题。通过对泊松概率质量函数取对数并应用斯特林公式，你将直接推导出经验平均速率的率函数，从而直观地理解大偏差原理如何从基本的概率分布中“涌现”出来。", "problem": "一个深空探测器的粒子探测器监测高能宇宙射线μ子的到达。这些μ子的随机到达可以被精确地描述为一个泊松过程。根据长期观测，已确定的平均探测率是每个单位时间 $r$ 个μ子。\n\n对于一个泊松过程，在平均率为 $r$ 的条件下，在时间间隔 $T$ 内计得恰好 $k$ 个事件的概率为：\n$$ P(k; r, T) = \\frac{(rT)^k \\exp(-rT)}{k!} $$\n\n大偏差理论为理解罕见涨落的概率提供了一个框架。当观测时间 $T$ 很大时，经验测量率 $a = k/T$ 偏离真实平均率 $r$ 的概率预期遵循以下标度形式：\n$$ P \\sim \\exp(-T \\cdot I(a)) $$\n此处，$I(a)$ 是“率函数”，它与 $T$ 无关，并刻画了观测到率为 $a$ 的概率的指数衰减。\n\n假设 $T$ 足够大，使得观测到的计数 $k=aT$ 也是一个大数，请推导出率函数 $I(a)$。在推导过程中，你可能会发现，对于大数 $n$ 的阶乘的自然对数的Stirling近似 $\\ln(n!) \\approx n \\ln n - n$ 会很有用。\n\n将你的 $I(a)$ 答案表示为关于真实率 $r$ 和观测率 $a$ 的解析函数。", "solution": "我们将时间间隔 $T$ 内的计数建模为参数为 $rT$ 的泊松分布，因此观测到恰好 $k$ 个事件的概率为\n$$\nP(k; r, T) = \\frac{(rT)^{k}\\exp(-rT)}{k!}.\n$$\n对于经验率 $a = k/T$ 的大偏差，假设 $T$ 很大，从而 $k = aT$ 也很大。取 $P$ 的自然对数：\n$$\n\\ln P = k \\ln(rT) - rT - \\ln(k!).\n$$\n对于大的 $k$，使用Stirling近似，\n$$\n\\ln(k!) \\approx k \\ln k - k,\n$$\n我们得到\n$$\n\\ln P \\approx k \\ln(rT) - rT - \\big(k \\ln k - k\\big) = k\\big[\\ln(rT) - \\ln k\\big] - rT + k.\n$$\n两边除以 $T$ 并代入 $k = aT$：\n$$\n\\frac{1}{T}\\ln P \\approx a\\big[\\ln(rT) - \\ln(aT)\\big] - r + a.\n$$\n化简对数项：\n$$\n\\ln(rT) - \\ln(aT) = \\ln r + \\ln T - \\ln a - \\ln T = \\ln\\!\\left(\\frac{r}{a}\\right),\n$$\n于是\n$$\n\\frac{1}{T}\\ln P \\approx a \\ln\\!\\left(\\frac{r}{a}\\right) - r + a = -\\Big[a \\ln\\!\\left(\\frac{a}{r}\\right) - a + r\\Big].\n$$\n因此，对于大的 $T$，\n$$\nP \\sim \\exp\\!\\left(-T I(a)\\right), \\quad \\text{其中} \\quad I(a) = a \\ln\\!\\left(\\frac{a}{r}\\right) - a + r.\n$$\n这个 $I(a)$ 是非负、凸的，并且满足 $I(r)=0$。在 $a=0$ 处，其连续延拓给出 $I(0)=r$，这与 $P(k=0)=\\exp(-rT)$ 一致。", "answer": "$$\\boxed{a \\ln\\!\\left(\\frac{a}{r}\\right) - a + r}$$", "id": "1976169"}, {"introduction": "计算出率函数后，探索其性质能够为我们提供更深刻的物理洞见。率函数 $I(a)$ 在期望值 $a=E[X]$ 处达到其最小值零，其在该点附近的曲率则描述了系统偏离平均行为的“成本”。这个练习 [@problem_id:1976174] 通过一个加载了的骰子的思想实验，让你计算率函数在期望值处的二阶导数。你会发现一个深刻的联系：率函数的曲率与原始概率分布的方差成反比，即 $I''(E[X]) = 1/\\operatorname{Var}(X)$。这揭示了一个核心物理直觉：一个系统的内禀随机性（方差）越大，其发生小幅涨落的可能性就越大，相应的“成本”（率函数曲率）就越小。", "problem": "进行一系列共 $N$ 次的实验，每次实验都包括掷一个特殊的六面骰子。设第 $i$ 次投掷的结果为随机变量 $X_i$，它可以取 1 到 6 之间的整数值。该骰子是不均匀的，掷出点数为 $k$ 的面的概率与 $k$ 成正比。这些投掷的结果 $\\{X_1, X_2, \\dots, X_N\\}$ 是独立同分布的。\n\n我们关心的是这些结果的样本均值，$S_N = \\frac{1}{N}\\sum_{i=1}^N X_i$。根据大偏差理论的原理，当投掷次数非常大时（$N \\to \\infty$），该样本均值接近某个特定值 $a$ 的概率，记作 $P(S_N \\approx a)$，遵循渐近关系 $P(S_N \\approx a) \\propto \\exp(-N \\cdot I(a))$。函数 $I(a)$ 被称为速率函数 (rate function)，它量化了观察到样本均值偏离真实期望值的指数稀有性。\n\n设 $X$ 表示单次投掷结果的随机变量。您的任务是计算速率函数的二阶导数 $\\frac{d^2I}{da^2}$ 在点 $a$ 等于单次投掷的期望值 $E[X]$ 时的值。请用精确分数表示您的答案。", "solution": "骰子掷出各点数的概率与点数值成正比，因此对于 $k \\in \\{1,2,3,4,5,6\\}$，\n$$\nP(X=k)=\\frac{k}{\\sum_{j=1}^{6} j}=\\frac{k}{21}.\n$$\n计算均值和二阶矩：\n$$\nE[X]=\\sum_{k=1}^{6} k \\cdot \\frac{k}{21}=\\frac{1}{21}\\sum_{k=1}^{6} k^{2}=\\frac{91}{21}=\\frac{13}{3},\n$$\n$$\nE[X^{2}]=\\sum_{k=1}^{6} k^{2} \\cdot \\frac{k}{21}=\\frac{1}{21}\\sum_{k=1}^{6} k^{3}=\\frac{441}{21}=21.\n$$\n因此方差为\n$$\n\\operatorname{Var}(X)=E[X^{2}]-(E[X])^{2}=21-\\left(\\frac{13}{3}\\right)^{2}=\\frac{20}{9}.\n$$\n\n对于样本均值的大偏差，定义对数矩生成函数\n$$\n\\Lambda(t)=\\ln E[\\exp(tX)].\n$$\nCramér 速率函数是 Legendre-Fenchel 变换\n$$\nI(a)=\\sup_{t\\in\\mathbb{R}}\\{t a-\\Lambda(t)\\}.\n$$\n在标准的平滑性和凸性条件下（此处成立），上确界在唯一的 $t$ 处取得，该 $t$ 满足\n$$\n\\Lambda'(t)=a,\n$$\n并且我们有 $I'(a)=t$。将 $\\Lambda'(t)=a$ 对 $a$ 求导，得到\n$$\n\\Lambda''(t)\\,\\frac{dt}{da}=1 \\quad\\Longrightarrow\\quad \\frac{dt}{da}=\\frac{1}{\\Lambda''(t)}.\n$$\n因此，\n$$\n\\frac{d^{2}I}{da^{2}}=\\frac{d}{da}\\big(I'(a)\\big)=\\frac{dt}{da}=\\frac{1}{\\Lambda''(t)}.\n$$\n在 $a=E[X]$ 处，使表达式取最大值的 $t$ 是 $t=0$，因为\n$$\n\\Lambda'(0)=E[X],\n$$\n并且\n$$\n\\Lambda''(0)=\\operatorname{Var}(X).\n$$\n因此，\n$$\n\\left.\\frac{d^{2}I}{da^{2}}\\right|_{a=E[X]}=\\frac{1}{\\operatorname{Var}(X)}=\\frac{1}{20/9}=\\frac{9}{20}.\n$$", "answer": "$$\\boxed{\\frac{9}{20}}$$", "id": "1976174"}]}