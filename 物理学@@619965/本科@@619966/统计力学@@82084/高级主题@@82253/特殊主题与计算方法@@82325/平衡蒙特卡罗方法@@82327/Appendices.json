{"hands_on_practices": [{"introduction": "伊辛模型是理解多体系统中相变和集体行为的基石。在使用蒙特卡洛方法探索其动力学之前，我们必须首先掌握一个基本技能：计算给定自旋构型的能量。这个练习将指导你手动计算一个小尺寸晶格的总能量，以巩固对最近邻相互作用和周期性边界条件的理解。", "problem": "考虑一个3x3方形晶格上的二维伊辛模型。每个晶格点 $i$ 都有一个自旋 $s_i$，其取值可以为+1（自旋向上）或-1（自旋向下）。一个自旋构型的总能量 $E$ 由哈密顿量 $E = -J \\sum_{\\langle i,j \\rangle} s_i s_j$ 给出，其中 $J$ 是一个正的铁磁耦合常数，求和遍历所有唯一的最近邻自旋对。\n\n该系统服从周期性边界条件。这意味着晶格呈环状卷曲：最右列的自旋被视为与最左列的自旋是最近邻，最底行的自旋被视为与最顶行的自旋是最近邻。\n\n给定一个特定的自旋构型如下，从上到下逐行描述，每行内的自旋从左到右排列：\n- 第1行：+1, -1, +1\n- 第2行：+1, +1, -1\n- 第3行：-1, +1, -1\n\n计算这个特定构型的总能量 $E$。请用耦合常数 $J$ 的单位表示你的答案，并将其写成一个单独的数值。", "solution": "哈密顿量为 $E=-J\\sum_{\\langle i,j\\rangle}s_{i}s_{j}$，其中求和遍历所有唯一的最近邻键。在一个具有周期性边界条件的 $3\\times 3$ 方形晶格上，有 $2L^{2}=18$ 个唯一的键：$9$ 个水平键和 $9$ 个竖直键。\n\n用 $s_{r,c}$ 标记自旋，其中 $r,c\\in\\{1,2,3\\}$，并使用给定的构型：\n$s_{1,1}=+1$, $s_{1,2}=-1$, $s_{1,3}=+1$;\n$s_{2,1}=+1$, $s_{2,2}=+1$, $s_{2,3}=-1$;\n$s_{3,1}=-1$, $s_{3,2}=+1$, $s_{3,3}=-1$。\n\n逐行计算水平键的和，利用每行内的周期性：\n$H_{1}=s_{1,1}s_{1,2}+s_{1,2}s_{1,3}+s_{1,3}s_{1,1}=(+1)(-1)+(-1)(+1)+(+1)(+1)=-1-1+1=-1$\n$H_{2}=s_{2,1}s_{2,2}+s_{2,2}s_{2,3}+s_{2,3}s_{2,1}=(+1)(+1)+(+1)(-1)+(-1)(+1)=1-1-1=-1$\n$H_{3}=s_{3,1}s_{3,2}+s_{3,2}s_{3,3}+s_{3,3}s_{3,1}=(-1)(+1)+(+1)(-1)+(-1)(-1)=-1-1+1=-1$\n因此 $\\sum_{\\text{horizontal}}s_{i}s_{j}=H_{1}+H_{2}+H_{3}=-3$。\n\n逐列计算竖直键的和，利用每列内的周期性：\n$V_{1}=s_{1,1}s_{2,1}+s_{2,1}s_{3,1}+s_{3,1}s_{1,1}=(+1)(+1)+(+1)(-1)+(-1)(+1)=1-1-1=-1$\n$V_{2}=s_{1,2}s_{2,2}+s_{2,2}s_{3,2}+s_{3,2}s_{1,2}=(-1)(+1)+(+1)(+1)+(+1)(-1)=-1+1-1=-1$\n$V_{3}=s_{1,3}s_{2,3}+s_{2,3}s_{3,3}+s_{3,3}s_{1,3}=(+1)(-1)+(-1)(-1)+(-1)(+1)=-1+1-1=-1$\n因此 $\\sum_{\\text{vertical}}s_{i}s_{j}=V_{1}+V_{2}+V_{3}=-3$。\n\n因此，最近邻总和为\n$$\n\\sum_{\\langle i,j\\rangle}s_{i}s_{j}=(-3)+(-3)=-6,\n$$\n能量为\n$$\nE=-J\\left(-6\\right)=6J.\n$$\n以 $J$ 为单位表示，可得 $E/J=6$。", "answer": "$$\\boxed{6}$$", "id": "1964969"}, {"introduction": "蒙特卡洛模拟通过提出微小的局部变化（例如翻转单个自旋）来逐步演化系统。算法的效率关键在于快速计算由此产生的能量变化 $\\Delta E$，而不是从头重新计算整个系统的总能量。这个练习聚焦于这一核心步骤，要求你计算一维伊辛链中单个自旋翻转所引起的能量变化。[@problem_id:1964969]", "problem": "考虑一个一维（1D）经典伊辛模型，它由一个包含 $N=8$ 个自旋的链组成，标记为 $s_1, s_2, \\dots, s_8$。每个自旋 $s_i$ 的取值可以是 $+1$（上）或 $-1$（下）。该系统采用周期性边界条件，这意味着自旋 $s_8$ 被视为自旋 $s_1$ 的最近邻。系统的总能量，即哈密顿量，由下式给出：\n$$H = -J \\sum_{\\langle i,j \\rangle} s_i s_j$$\n其中 $J$ 是一个正常数，代表铁磁相互作用强度，求和遍及所有唯一的最近邻对。\n\n假设系统初始处于由以下序列描述的特定微观构型：\n$$s = (+1, -1, +1, -1, +1, -1, +1, -1)$$\n其中序列中的第 $i$ 个元素对应于自旋 $s_i$ 的状态。现提议进行一次单自旋翻转，其中只有自旋 $s_1$ 从其初始状态翻转到相反状态，而所有其他自旋（$s_2$ 到 $s_8$）保持不变。\n\n由于这次单自旋翻转，系统的总能量变化 $\\Delta E = E_{\\text{final}} - E_{\\text{initial}}$ 是多少？\n\nA. $4J$\n\nB. $2J$\n\nC. $0$\n\nD. $-2J$\n\nE. $-4J$", "solution": "哈密顿量为 $H=-J\\sum_{\\langle i,j\\rangle}s_{i}s_{j}$，且具有周期性边界条件，因此在翻转 $s_{1}$ 时，只有涉及 $s_{1}$ 的两个键，即 $(s_8,s_1)$ 和 $(s_1,s_2)$，会发生变化。所有其他键的贡献在能量差中被抵消。\n\n来自这两个键的初始局域能量为\n$$\nE_{\\text{initial, local}}=-J\\left(s_{8}s_{1}+s_{1}s_{2}\\right).\n$$\n在翻转 $s_{1}\\to -s_{1}$ 后，最终的局域能量为\n$$\nE_{\\text{final, local}}=-J\\left(s_{8}(-s_{1})+(-s_{1})s_{2}\\right)=J\\left(s_{8}s_{1}+s_{1}s_{2}\\right).\n$$\n因此，总能量的变化为\n$$\n\\Delta E=E_{\\text{final}}-E_{\\text{initial}}=E_{\\text{final, local}}-E_{\\text{initial, local}}=2J\\left(s_{8}s_{1}+s_{1}s_{2}\\right)=2J\\,s_{1}\\left(s_{8}+s_{2}\\right).\n$$\n对于给定的构型，$s_{1}=+1$，$s_{2}=-1$ 和 $s_{8}=-1$，所以\n$$\n\\Delta E=2J\\cdot(+1)\\cdot\\left((-1)+(-1)\\right)=-4J.\n$$\n这对应于选项E。", "answer": "$$\\boxed{E}$$", "id": "1964946"}, {"introduction": "计算出能量变化 $\\Delta E$ 后，Metropolis 算法会根据一个特定的概率准则来接受或拒绝提议的变化。虽然该准则在理论上常用 $\\min$ 函数表示，但在代码中的实现可以非常简洁。这个问题挑战你分析一种常见的一行代码实现，并验证它是否正确地包含了 Metropolis 准则的完整逻辑，从而确保系统能够正确地对正则系综进行抽样。[@problem_id:1964946]", "problem": "一位名叫 Alex 的学生正在为一个简单的二维晶格气体模型编写梅特罗波利斯蒙特卡洛（Metropolis Monte Carlo）模拟程序。在这个模型中，粒子占据网格上的格点，系统的总能量 $E$ 基于相邻粒子间的相互作用来计算。模拟的目标是在给定温度 $T$ 下，从正则系综中抽样组态。\n\nAlex 的模拟按步进行。在每一步中，都会提议一个试探移动（例如，将单个粒子移动到随机的相邻空格点上）。设当前组态的能量为 $E_{old}$，提议的新组态的能量为 $E_{new}$。能量变化为 $\\Delta E = E_{new} - E_{old}$。\n\nAlex 使用下面这行伪代码实现核心的接受/拒绝逻辑，其中 `rand()` 是一个返回区间 $[0, 1)$ 上均匀分布的随机浮点数的函数。如果条件为真，则接受该移动。\n\n`if rand()  exp(-ΔE / (k_B * T))`\n\n此处，$k_B$ 是玻尔兹曼常数。Alex 运行模拟后发现，系统似乎正在达到一个合理的平衡态。然而，他们担心的是，他们的代码没有包含一个显式的 `if/else` 结构来区分增加能量的移动（$\\Delta E > 0$）和减少能量的移动（$\\Delta E \\le 0$），而他们的教科书中正是这样介绍该算法的。\n\n以下哪个陈述对 Alex 的实现给出了最准确的分析？\n\nA. 该代码存在根本性缺陷，因为它永远不会接受降低系统能量的移动（$\\Delta E \\le 0$）。\n\nB. 该代码存在根本性缺陷，因为它会接受所有提议的移动，无论能量如何变化，这会阻止系统达到热平衡。\n\nC. 该代码能正常工作，因为对于任何降低能量的移动（$\\Delta E \\le 0$），项 $\\exp(-\\Delta E / (k_B T))$ 的计算结果是一个大于或等于1的值，从而确保接受条件总是被满足。\n\nD. 该代码仅在高温极限（$k_B T \\gg |\\Delta E|$）下是正确的，此时指数项可以近似为1，但在低温下会失效。\n\nE. 该代码存在根本性缺陷，因为它没有以1的接受概率显式处理 $\\Delta E \\le 0$ 的情况，从而违反了细致平衡原理。", "solution": "令 $\\beta$ 表示逆温，$\\beta = \\frac{1}{k_{B}T}$。在采用对称提议分布的梅特罗波利斯算法中，能确保从正则系综中抽样并满足细致平衡的接受概率是\n$$\nA(\\Delta E) = \\min\\!\\left(1,\\exp(-\\beta \\Delta E)\\right).\n$$\nAlex 的代码在一个服从 $[0,1)$ 均匀分布的随机变量 $r \\sim \\text{Uniform}[0,1)$ 满足以下条件时接受该移动\n$$\nr  \\exp(-\\beta \\Delta E).\n$$\n由此规则实现的接受概率是事件 $\\{r  \\exp(-\\beta \\Delta E)\\}$ 发生的概率（相对于 $r$ 而言）。由于 $r$ 在 $[0,1)$ 上是均匀分布的，\n$$\nP(\\text{accept}) = \\int_{0}^{1} \\mathbf{1}\\{r  \\exp(-\\beta \\Delta E)\\} \\, dr.\n$$\n该积分根据 $\\exp(-\\beta \\Delta E)$ 相对于 $1$ 的值分段计算：\n\n1) 如果 $\\Delta E \\le 0$，那么 $-\\beta \\Delta E \\ge 0$，因此\n$$\n\\exp(-\\beta \\Delta E) \\ge 1.\n$$\n因为 $r \\in [0,1)$ 并且 $\\exp(-\\beta \\Delta E) \\ge 1$，所以不等式 $r  \\exp(-\\beta \\Delta E)$ 对 $[0,1)$ 中的所有 $r$ 都成立。因此，\n$$\nP(\\text{accept}) = 1 = \\min\\!\\left(1,\\exp(-\\beta \\Delta E)\\right).\n$$\n特别是，当 $\\Delta E = 0$ 时，$\\exp(0) = 1$，并且由于对于 $r \\in [0,1)$ 几乎必然有 $r  1$，所以接受概率为 $1$，这符合要求。\n\n2) 如果 $\\Delta E  0$，那么 $-\\beta \\Delta E  0$，因此\n$$\n\\exp(-\\beta \\Delta E)  1,\n$$\n事件 $\\{r  \\exp(-\\beta \\Delta E)\\}$ 发生的概率恰好是 $\\exp(-\\beta \\Delta E)$，因为区间 $\\{r \\in [0,1) : r  \\exp(-\\beta \\Delta E)\\}$ 的长度是 $\\exp(-\\beta \\Delta E)$。所以，\n$$\nP(\\text{accept}) = \\exp(-\\beta \\Delta E) = \\min\\!\\left(1,\\exp(-\\beta \\Delta E)\\right).\n$$\n\n综合这两种情况，\n$$\nP(\\text{accept}) = \\min\\!\\left(1,\\exp(-\\beta \\Delta E)\\right),\n$$\n这恰好就是用于对称提议分布、满足细致平衡条件的梅特罗波利斯接受准则。因此，Alex 的单行条件隐式地实现了 $\\min$ 操作，因为 $r$ 被限制在 $[0,1)$ 区间内。它以概率 $1$ 接受所有降低能量或能量不变的移动，并以概率 $\\exp(-\\beta \\Delta E)$ 接受增加能量的移动。结果是：\n- 降低能量的移动并不会被拒绝（排除A）。\n- 它不会接受所有移动（排除B）。\n- 它不局限于高温区（排除D）。\n- 它没有违反细致平衡；正确的接受概率得以实现（排除E）。\n\n因此，最准确的陈述是，该代码在所有温度下都能正常工作，因为当 $\\Delta E \\le 0$ 时，$\\exp(-\\Delta E/(k_{B}T)) \\ge 1$，确保了移动被接受，而当 $\\Delta E  0$ 时，它能产生正确的概率性接受。", "answer": "$$\\boxed{C}$$", "id": "1964945"}]}