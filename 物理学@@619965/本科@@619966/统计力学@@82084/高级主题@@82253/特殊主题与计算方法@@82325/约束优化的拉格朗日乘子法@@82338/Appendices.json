{"hands_on_practices": [{"introduction": "本次练习将带你回到统计力学的基石：通过最大化多重数（或熵）来寻找一个系统的最概然分布。我们将处理一个简化的离散能级模型，并在粒子数和总能量守恒的约束下，运用拉格朗日乘数法来确定粒子在不同能态上的分布情况。这个基本练习清晰地展示了该方法如何将宏观约束与微观态的最可几分布联系起来。[@problem_id:1980271]", "problem": "一个封闭系统由大量（$N$个）可分辨、无相互作用的粒子组成。粒子可以分布在两个概念上的“区域”中，即区域0和区域1。\n\n- 在区域0中的粒子只有一个能量状态，能量为 $E_0 = 0$。\n- 在区域1中的粒子有两个不同的能量状态，一个能量为 $E_1 = \\epsilon$ 的较低状态和一个能量为 $E_2 = 2\\epsilon$ 的较高状态，其中 $\\epsilon$ 是一个正常数。\n\n系统是孤立的，总粒子数固定为 $N$，总内能固定为特定值 $E = N\\epsilon$。你的任务是找到粒子在可用能量状态中的最概然分布。\n\n假设 $N$ 足够大，使得斯特林近似对阶乘有效，使用拉格朗日乘数法来确定占据区域0中基态（即能量为 $E_0=0$ 的状态）的粒子分数 $f_0 = N_0/N$。\n\n将你的最终答案表示为一个有理数。", "solution": "令 $N_{0}$、$N_{1}$ 和 $N_{2}$ 分别表示处于单粒子能态 $E_{0}=0$、$E_{1}=\\epsilon$ 和 $E_{2}=2\\epsilon$ 的粒子数。约束条件为\n$$\nN_{0}+N_{1}+N_{2}=N, \\quad \\epsilon N_{1}+2\\epsilon N_{2}=N\\epsilon.\n$$\n对于具有这三个非简并能级的可分辨、无相互作用的粒子，一个宏观态的多重性是\n$$\n\\Omega=\\frac{N!}{N_{0}!\\,N_{1}!\\,N_{2}!}.\n$$\n使用斯特林近似 $\\ln n!\\approx n\\ln n-n$，用拉格朗日乘子 $\\lambda$ 和 $\\beta$ 要求解最大值的函数是\n$$\n\\Phi=\\ln \\Omega+\\lambda\\left(N-N_{0}-N_{1}-N_{2}\\right)+\\beta\\left(N\\epsilon-\\epsilon N_{1}-2\\epsilon N_{2}\\right).\n$$\n计算平稳条件：\n$$\n\\frac{\\partial \\Phi}{\\partial N_{0}}=-\\ln N_{0}-\\lambda=0,\\qquad\n\\frac{\\partial \\Phi}{\\partial N_{1}}=-\\ln N_{1}-\\lambda-\\beta\\epsilon=0,\\qquad\n\\frac{\\partial \\Phi}{\\partial N_{2}}=-\\ln N_{2}-\\lambda-2\\beta\\epsilon=0.\n$$\n求解得，\n$$\nN_{0}=\\exp(-\\lambda),\\quad N_{1}=\\exp(-\\lambda-\\beta\\epsilon),\\quad N_{2}=\\exp(-\\lambda-2\\beta\\epsilon).\n$$\n定义 $x=\\exp(-\\beta\\epsilon)>0$。则\n$$\nN_{1}=x\\,N_{0},\\qquad N_{2}=x^{2}N_{0}.\n$$\n应用约束条件：\n$$\nN_{0}(1+x+x^{2})=N,\\qquad N_{0}(x+2x^{2})=N.\n$$\n令等式右边相等，可得\n$$\nx+2x^{2}=1+x+x^{2}\\;\\Rightarrow\\;x^{2}=1\\;\\Rightarrow\\;x=1,\n$$\n因为 $x>0$。因此，\n$$\nN_{0}=\\frac{N}{1+1+1}=\\frac{N}{3},\\qquad f_{0}=\\frac{N_{0}}{N}=\\frac{1}{3}.\n$$", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "1980271"}, {"introduction": "在上一个练习的基础上，我们现在将问题从离散能级推广到连续空间分布。我们将探索如何确定被限制在一维盒子中的大量粒子的最可几空间密度函数 $\\rho(x)$。这个过程依然遵循熵最大化原理，但此时的熵和约束条件都变成了对密度函数的积分（泛函），需要使用变分法来求解。通过引入一个很有物理意义的约束——系统质心位置固定——这个练习展示了拉格朗日乘数法在处理连续系统和更复杂物理约束时的强大能力。[@problem_id:1980252]", "problem": "考虑一个由$N$个经典的、无相互作用的点状粒子组成的系统，它们被限制在一个长度为$L$的一维盒子中。盒子的范围从位置$x=0$到$x=L$。系统处于热力学平衡状态，并受到两个宏观约束。首先，粒子总数固定为$N$。其次，$N$个粒子的集体质心精确地固定在盒子的中点，即 $x_{CM} = L/2$。\n\n粒子的“最概然”空间分布是使系统构型熵最大的分布。令$\\rho(x)$表示粒子的线数密度，其中$\\rho(x)dx$是无穷小区间$[x, x+dx]$内的粒子数。因此，粒子总数由$\\int_0^L \\rho(x) dx = N$给出。\n\n你的任务是确定这个最概然密度$\\rho(x)$的函数形式。将你的答案表示为给定参数$N$和$L$的函数。", "solution": "我们寻求在粒子总数$N$固定和质心位于$x_{CM}=L/2$的约束下，使构型熵最大化的粒子数密度$\\rho(x)$。将区间$[0,L]$离散化为宽度为$a$、中心在$x_{j}$的小格子，其占据数为$n_{j}\\approx \\rho(x_{j})a$，满足$\\sum_{j} n_{j}=N$和$\\sum_{j} x_{j} n_{j}=N L/2$。具有给定$\\{n_{j}\\}$的微观态数目为$W = \\frac{N!}{\\prod_{j} n_{j}!}$。对于大的占据数，使用斯特林近似，熵$S=k_{B}\\ln W$ 在不考虑与$\\rho$形状无关的常数的情况下，由下式给出：\n$$\nS[\\rho] \\propto -\\sum_{j} n_{j}\\ln n_{j} \\;\\to\\; -\\int_{0}^{L} \\rho(x)\\ln \\rho(x)\\,dx,\n$$\n这里已经取了连续极限，并且加法常数（包括任何来自格子尺寸$a$的常数）被吸收到拉格朗日乘子中。\n\n因此，我们最大化泛函\n$$\n\\mathcal{F}[\\rho] \\equiv -\\int_{0}^{L} \\rho(x)\\ln \\rho(x)\\,dx - \\lambda\\left(\\int_{0}^{L} \\rho(x)\\,dx - N\\right) - \\mu\\left(\\int_{0}^{L} x\\,\\rho(x)\\,dx - \\frac{N L}{2}\\right),\n$$\n相对于变分$\\delta \\rho(x)$进行最大化，并满足约束$\\rho(x)\\ge 0$。一阶变分得到\n$$\n\\delta \\mathcal{F} = -\\int_{0}^{L} \\left(\\ln \\rho(x) + 1 + \\lambda + \\mu x\\right)\\delta \\rho(x)\\,dx = 0\n$$\n对于任意的$\\delta \\rho(x)$，这意味着欧拉-拉格朗日条件为\n$$\n\\ln \\rho(x) + 1 + \\lambda + \\mu x = 0.\n$$\n因此，\n$$\n\\rho(x) = C\\,\\exp(-\\mu x), \\quad C \\equiv \\exp(-1-\\lambda).\n$$\n\n施加约束以确定$C$和$\\mu$。归一化条件给出\n$$\nN = \\int_{0}^{L} \\rho(x)\\,dx = C \\int_{0}^{L} \\exp(-\\mu x)\\,dx =\n\\begin{cases}\nC\\,\\frac{1 - \\exp(-\\mu L)}{\\mu}, & \\mu \\neq 0,\\\\\nC\\,L, & \\mu = 0.\n\\end{cases}\n$$\n质心约束意味着\n$$\n\\frac{1}{N}\\int_{0}^{L} x\\,\\rho(x)\\,dx = \\frac{L}{2}.\n$$\n对于$\\mu \\neq 0$，\n$$\n\\int_{0}^{L} x\\,\\exp(-\\mu x)\\,dx = \\frac{1 - (1+\\mu L)\\exp(-\\mu L)}{\\mu^{2}},\n$$\n所以\n$$\n\\langle x \\rangle \\equiv \\frac{1}{N}\\int_{0}^{L} x\\,\\rho(x)\\,dx\n= \\frac{\\frac{1 - (1+\\mu L)\\exp(-\\mu L)}{\\mu^{2}}}{\\frac{1 - \\exp(-\\mu L)}{\\mu}}\n= \\frac{1}{\\mu}\\,\\frac{1 - (1+\\mu L)\\exp(-\\mu L)}{1 - \\exp(-\\mu L)}.\n$$\n要求$\\langle x \\rangle = L/2$给出，设$t \\equiv \\mu L$：\n$$\n\\frac{1}{t}\\,\\frac{1 - (1+t)\\exp(-t)}{1 - \\exp(-t)} = \\frac{1}{2}.\n$$\n这等价于\n$$\n2\\left[1 - (1+t)\\exp(-t)\\right] = t\\left[1 - \\exp(-t)\\right]\n\\;\\;\\Longleftrightarrow\\;\\; (t - 2) + (t + 2)\\exp(-t) = 0.\n$$\n定义函数 $h(t) \\equiv (t - 2) + (t + 2)\\exp(-t)$。我们寻找方程 $h(t)=0$ 的解。我们注意到当 $t=0$ 时，$h(0) = (0-2) + (0+2)\\exp(0) = -2+2 = 0$，所以 $t=0$ 是一个解。为检验其唯一性，我们分析 $h(t)$ 的导数。一阶导数为 $h'(t) = 1 - (t+1)\\exp(-t)$。二阶导数为 $h''(t) = -[1 \\cdot \\exp(-t) + (t+1)(-\\exp(-t))] = t \\exp(-t)$。因为对于所有实数 $t$，$\\exp(-t) > 0$ 恒成立，所以 $h''(t)$ 的符号与 $t$ 的符号相同。这意味着 $h(t)$ 在 $t=0$ 处有唯一的全局最小值。既然 $h(t)$ 的最小值为 $h(0)=0$，那么 $t=0$ 就是方程 $h(t)=0$ 的唯一实数解。因此，平均值约束的唯一解是 $t=\\mu L=0$，这意味着 $\\mu=0$。\n\n因此，使熵最大化的密度具有$\\mu=0$，所以它在$[0,L]$上是均匀的。归一化条件接着确定了$C$：\n$$\nN = C L \\quad \\Longrightarrow \\quad C = \\frac{N}{L}.\n$$\n因此最概然密度是\n$$\n\\rho(x) = \\frac{N}{L} \\quad \\text{for } 0 \\le x \\le L,\n$$\n它既满足$\\int_{0}^{L} \\rho(x)\\,dx = N$又满足$\\frac{1}{N}\\int_{0}^{L} x\\,\\rho(x)\\,dx = L/2$，并且最大化了构型熵。", "answer": "$$\\boxed{\\frac{N}{L}}$$", "id": "1980252"}, {"introduction": "这个高级练习将拉格朗日乘数法的应用推向了更广阔的舞台——相空间。我们的目标是推导出一个二维气体在平衡状态下的相空间分布函数 $f(\\vec{r}, \\vec{v})$。通过最大化吉布斯熵，并同时满足粒子数、总能量和总角动量这三个守恒定律的约束，我们可以看到一个物理系统的平衡态是如何由其所有守恒量共同决定的。这个练习不仅揭示了麦克斯韦-玻尔兹曼分布等基本物理规律的起源，也展示了如何通过增加约束（如角动量）来描述更复杂的物理现象，例如气体的整体旋转。[@problem_id:1980237]", "problem": "一个由大量质量为 $m$ 的全同、无相互作用的粒子组成的经典气体被限制在一个二维平面内。该气体的微观状态由相空间分布函数 $f(\\vec{r}, \\vec{v})$ 描述，它给出了在位置 $\\vec{r}=(x,y)$ 处速度为 $\\vec{v}=(v_x, v_y)$ 的粒子密度。\n\n平衡分布是使 Gibbs 熵的连续形式最大化的分布，该熵由以下泛函给出：\n$$S[f] = -k_B \\iint f(\\vec{r}, \\vec{v}) \\ln[C f(\\vec{r}, \\vec{v})] \\, d^2r \\, d^2v$$\n其中 $k_B$ 是 Boltzmann 常数，$C$ 是一个具有适当单位的常数，以使对数的自变量无量纲。\n\n这种最大化受到三个宏观约束：\n1.  总粒子数是固定的： $N = \\iint f(\\vec{r}, \\vec{v}) \\, d^2r \\, d^2v$。\n2.  总动能是固定的： $E = \\iint \\left(\\frac{1}{2} m v^2\\right) f(\\vec{r}, \\vec{v}) \\, d^2r \\, d^2v$，其中 $v^2 = v_x^2 + v_y^2$。\n3.  关于原点的总角动量的 z 分量是固定的： $L_z = \\iint m(x v_y - y v_x) f(\\vec{r}, \\vec{v}) \\, d^2r \\, d^2v$。\n\n使用 Lagrange 乘数法，求出平衡分布函数 $f(\\vec{r}, \\vec{v})$ 的泛函形式。用 $m$、位置分量 $x$ 和 $y$、速度分量 $v_x$ 和 $v_y$、常数 $C$ 以及分别与粒子数、能量和角动量约束相关的 Lagrange 乘数 $\\alpha$、$\\beta$ 和 $\\omega$ 来表示你的答案。", "solution": "我们通过引入 Lagrange 乘数，在约束条件下最大化 Gibbs 熵泛函。由于最大化 $S[f]$ 等价于最大化 $S[f]/k_{B}$，我们考虑\n$$\\mathcal{J}[f] \\equiv - \\iint f(\\vec{r},\\vec{v}) \\ln\\!\\big(C f(\\vec{r},\\vec{v})\\big)\\, d^{2}r\\, d^{2}v - \\alpha\\left(\\iint f\\, d^{2}r\\, d^{2}v - N\\right) - \\beta\\left(\\iint \\frac{1}{2} m v^{2} f\\, d^{2}r\\, d^{2}v - E\\right) - \\omega\\left(\\iint m(x v_{y} - y v_{x}) f\\, d^{2}r\\, d^{2}v - L_{z}\\right).$$\n在任意变分 $\\delta f$ 下的驻点满足 $\\delta \\mathcal{J}=0$。对积分号下的 $f$ 进行变分，并舍去常数约束项 $N$、$E$ 和 $L_{z}$，我们得到\n$$\\delta \\mathcal{J} = \\iint \\left[-\\big(\\ln(C f)+1\\big) - \\alpha - \\beta \\frac{m v^{2}}{2} - \\omega m (x v_{y} - y v_{x})\\right]\\delta f \\, d^{2}r\\, d^{2}v.$$\n由于这对任意 $\\delta f$ 都必须为零，因此方括号内的表达式必须逐点为零：\n$$-(\\ln(C f)+1) - \\alpha - \\beta \\frac{m v^{2}}{2} - \\omega m (x v_{y} - y v_{x}) = 0.$$\n解出 $\\ln(C f)$ 可得\n$$\\ln(C f) = -1 - \\alpha - \\beta \\frac{m v^{2}}{2} - \\omega m (x v_{y} - y v_{x}).$$\n对两边取指数，得到平衡分布\n$$f(\\vec{r},\\vec{v}) = \\frac{1}{C}\\,\\exp\\!\\left(-1 - \\alpha - \\beta \\frac{m}{2}(v_{x}^{2}+v_{y}^{2}) - \\omega m (x v_{y} - y v_{x})\\right).$$\n这个 $f(\\vec{r},\\vec{v})$ 在固定的 $N$、$E$ 和 $L_{z}$ 约束下使熵最大化，其中乘数 $\\alpha$、$\\beta$ 和 $\\omega$ 分别与粒子数、能量和角动量相关。", "answer": "$$\\boxed{\\frac{1}{C}\\,\\exp\\!\\left(-1-\\alpha-\\beta\\,\\frac{m}{2}\\left(v_{x}^{2}+v_{y}^{2}\\right)-\\omega\\,m\\left(x\\,v_{y}-y\\,v_{x}\\right)\\right)}$$", "id": "1980237"}]}