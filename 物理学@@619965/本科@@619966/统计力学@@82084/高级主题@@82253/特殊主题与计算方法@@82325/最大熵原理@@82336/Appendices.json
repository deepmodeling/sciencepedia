{"hands_on_practices": [{"introduction": "我们将从一个直观的非物理学例子开始，将最大熵原理应用于一个简化的经济模型。这个练习旨在阐明，在给定系统平均值（例如，平均财富）的条件下，如何推导出最无偏见的离散概率分布。通过这个实践，你将掌握在离散系统上应用拉格朗日乘子法来最大化信息熵的核心技巧。[@problem_id:2006942]", "problem": "一个封闭社会的经济模型将其人口划分为三个不同且不重叠的收入阶层：低收入阶层 ($L$)、中等收入阶层 ($M$) 和高收入阶层 ($H$)。为简化模型，为每个阶层分配一个代表性的财富值。设这些财富值分别为 $W_L = 0$、$W_M = 1$ 和 $W_H = 2$，以抽象的“财富单位”衡量。\n\n一项全面的人口普查显示，整个人口的个人平均财富为 $\\langle W \\rangle = 0.5$ 财富单位。\n\n根据最大熵原理（该原理断言，在已知约束条件下，最可能的分布是使信息熵最大化的分布），确定一个随机选择的个体分别属于低、中、高收入阶层的概率 $p_L$、$p_M$ 和 $p_H$。\n\n将这三个概率按 $(p_L, p_M, p_H)$ 的顺序以行矩阵的形式呈现。将每个概率四舍五入到四位有效数字。", "solution": "我们用财富值 $W_{L}=0$、$W_{M}=1$ 和 $W_{H}=2$ 来为这三个收入阶层建模。设其相关概率为 $p_{L}$、$p_{M}$ 和 $p_{H}$，满足约束条件 $\\sum_{i} p_{i} = 1$ 和平均财富条件 $\\sum_{i} p_{i} W_{i} = \\langle W \\rangle = \\frac{1}{2}$。\n\n根据具有固定均值的离散分布的最大熵原理，我们使用拉格朗日乘子 $\\alpha$ 和 $\\beta$ 在两个约束条件下最大化香农熵 $S = -\\sum_{i} p_{i} \\ln p_{i}$。平稳性条件可从拉格朗日函数\n$$\n\\mathcal{L} = -\\sum_{i} p_{i} \\ln p_{i} - \\alpha \\left(\\sum_{i} p_{i} - 1\\right) - \\beta \\left(\\sum_{i} p_{i} W_{i} - \\frac{1}{2}\\right).\n$$\n得到。对 $p_{i}$ 求导并令其为零可得\n$$\n-\\left(\\ln p_{i} + 1\\right) - \\alpha - \\beta W_{i} = 0 \\quad \\Rightarrow \\quad p_{i} = \\exp(-1 - \\alpha) \\exp(-\\beta W_{i}).\n$$\n记 $Z = \\sum_{i} \\exp(-\\beta W_{i})$ 为归一化因子，概率呈吉布斯 (Gibbs) 形式\n$$\np_{i} = \\frac{\\exp(-\\beta W_{i})}{Z}, \\quad Z = \\exp(0) + \\exp(-\\beta) + \\exp(-2\\beta) = 1 + r + r^{2},\n$$\n其中 $r \\equiv \\exp(-\\beta) > 0$。因此\n$$\np_{L} = \\frac{1}{1 + r + r^{2}}, \\quad p_{M} = \\frac{r}{1 + r + r^{2}}, \\quad p_{H} = \\frac{r^{2}}{1 + r + r^{2}}.\n$$\n应用平均值约束 $\\langle W \\rangle = \\frac{1}{2}$ 可得\n$$\n\\frac{0 \\cdot p_{L} + 1 \\cdot p_{M} + 2 \\cdot p_{H}}{1} = \\frac{r + 2 r^{2}}{1 + r + r^{2}} = \\frac{1}{2}.\n$$\n交叉相乘并化简可得\n$$\n2(r + 2 r^{2}) = 1 + r + r^{2} \\quad \\Rightarrow \\quad 3 r^{2} + r - 1 = 0.\n$$\n解关于 $r$ 的二次方程可得\n$$\nr = \\frac{-1 + \\sqrt{1 + 12}}{6} = \\frac{-1 + \\sqrt{13}}{6},\n$$\n由于 $r > 0$，我们选择正根。将 $r$ 代入概率表达式，即可得到最大熵分布。对于四舍五入到四位有效数字的数值，首先我们计算 $r \\approx 0.4342585459$，因此\n$$\np_{L} = \\frac{1}{1 + r + r^{2}}, \\quad p_{M} = \\frac{r}{1 + r + r^{2}} = r \\, p_{L}, \\quad p_{H} = \\frac{r^{2}}{1 + r + r^{2}} = r^{2} \\, p_{L}.\n$$\n使用二次方程的关系式 $r^{2} = \\frac{1 - r}{3}$，可以精确计算得到\n$$\np_{L} \\approx 0.6162, \\quad p_{M} \\approx 0.2676, \\quad p_{H} \\approx 0.1162,\n$$\n每个值都四舍五入到四位有效数字。在所述精度下，这些值满足归一化条件和给定的平均值。", "answer": "$$\\boxed{\\begin{pmatrix}0.6162 & 0.2676 & 0.1162\\end{pmatrix}}$$", "id": "2006942"}, {"introduction": "接下来，我们将把最大熵原理从离散变量推广到连续变量。这个问题探讨了一个平稳随机过程，这是信号处理和统计学中的一个核心概念。通过这个练习，你将看到对系统二阶矩（方差和协方差）的约束如何自然地导出在科学和工程中无处不在的多元正态分布。[@problem_id:2006959]", "problem": "一个平稳随机过程 $X(t)$ 是一个随机变量序列，其统计特性不随时间改变。考虑从这样一个过程中抽样的两个数据点 $x_1$ 和 $x_2$。由于平稳性，我们可以假设该过程的均值为零，即 $\\langle x_1 \\rangle = \\langle x_2 \\rangle = 0$。根据经验测量，我们确定了以下性质：每个数据点的方差为 $\\langle x_1^2 \\rangle = \\langle x_2^2 \\rangle = \\sigma^2$，它们之间的协方差为 $\\langle x_1 x_2 \\rangle = C$。常数 $\\sigma^2$ 和 $C$ 是已知的，且满足 $\\sigma^2 > 0$ 和 $\\sigma^4 > C^2$。\n\n使用最大熵原理，确定与此有限信息最一致的联合概率密度函数 $p(x_1, x_2)$。最大熵原理指出，在一组约束条件下，最无偏的概率分布是使信息熵最大化的那个分布。\n\n请用 $x_1, x_2, \\sigma$ 和 $C$ 表示您的答案，形式为单个闭式解析表达式。", "solution": "我们有两个从平稳随机过程中抽样的实值随机变量 $x_{1}$ 和 $x_{2}$，其约束条件为\n$$\\langle x_{1} \\rangle = 0, \\quad \\langle x_{2} \\rangle = 0, \\quad \\langle x_{1}^{2} \\rangle = \\sigma^{2}, \\quad \\langle x_{2}^{2} \\rangle = \\sigma^{2}, \\quad \\langle x_{1} x_{2} \\rangle = C,$$\n其中 $\\sigma^{2} > 0$ 且 $\\sigma^{4} > C^{2}$。\n\n根据连续变量的最大熵原理，使微分熵\n$$H[p] = - \\int_{\\mathbb{R}^{2}} p(x_{1},x_{2}) \\ln p(x_{1},x_{2}) \\, dx_{1} dx_{2}$$\n在归一化约束和上述矩约束条件下最大化的密度，具有通过拉格朗日乘子法得到的指数族形式。为归一化、均值、方差和协方差引入乘子，该变分问题产生一个极值密度，其形式为\n$$p(x_{1},x_{2}) = Z^{-1} \\exp\\!\\left( - a x_{1}^{2} - b x_{2}^{2} - 2 d x_{1} x_{2} - u x_{1} - v x_{2} \\right),$$\n其中 $a$、$b$、$d$、$u$ 和 $v$ 是由约束条件决定的常数，$Z$ 是归一化常数。将此写成矩阵形式\n$$p(\\mathbf{x}) = Z^{-1} \\exp\\!\\left( - \\mathbf{x}^{T} K \\mathbf{x} - \\mathbf{h}^{T} \\mathbf{x} \\right), \\quad \\mathbf{x} = \\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix}, \\quad K = \\begin{pmatrix} a & d \\\\ d & b \\end{pmatrix}, \\quad \\mathbf{h} = \\begin{pmatrix} u \\\\ v \\end{pmatrix},$$\n我们使用配方法：\n$$- \\mathbf{x}^{T} K \\mathbf{x} - \\mathbf{h}^{T} \\mathbf{x} = - (\\mathbf{x} - \\boldsymbol{\\mu})^{T} K (\\mathbf{x} - \\boldsymbol{\\mu}) + \\boldsymbol{\\mu}^{T} K \\boldsymbol{\\mu}, \\quad \\boldsymbol{\\mu} = - \\tfrac{1}{2} K^{-1} \\mathbf{h}.$$\n因此均值为 $\\langle \\mathbf{x} \\rangle = \\boldsymbol{\\mu}$。施加约束 $\\langle x_{1} \\rangle = 0$ 和 $\\langle x_{2} \\rangle = 0$ 要求 $\\boldsymbol{\\mu} = \\mathbf{0}$，这意味着 $\\mathbf{h} = \\mathbf{0}$。因此，最大熵密度简化为一个零均值高斯分布，\n$$p(\\mathbf{x}) = Z^{-1} \\exp\\!\\left( - \\mathbf{x}^{T} K \\mathbf{x} \\right).$$\n对于这样的密度，协方差矩阵与 $K$ 的关系为\n$$\\langle \\mathbf{x} \\mathbf{x}^{T} \\rangle = \\tfrac{1}{2} K^{-1},$$\n因此，为了匹配给定的协方差矩阵 $\\Sigma$，我们必须设置 $K = \\tfrac{1}{2} \\Sigma^{-1}$。接着，通常将中心多元正态分布写成标准形式\n$$p(\\mathbf{x}) = \\frac{1}{(2 \\pi)^{n/2} \\sqrt{\\det \\Sigma}} \\exp\\!\\left( - \\tfrac{1}{2} \\mathbf{x}^{T} \\Sigma^{-1} \\mathbf{x} \\right), \\quad n=2.$$\n根据给定的二阶矩，协方差矩阵为\n$$\\Sigma = \\begin{pmatrix} \\sigma^{2} & C \\\\ C & \\sigma^{2} \\end{pmatrix}, \\quad \\det \\Sigma = \\sigma^{4} - C^{2} > 0,$$\n根据假设 $\\sigma^{4} > C^{2}$，该矩阵是正定的。其逆矩阵为\n$$\\Sigma^{-1} = \\frac{1}{\\sigma^{4} - C^{2}} \\begin{pmatrix} \\sigma^{2} & -C \\\\ -C & \\sigma^{2} \\end{pmatrix}.$$\n因此，最大熵联合密度是零均值二元正态分布\n$$p(x_{1},x_{2}) = \\frac{1}{2 \\pi \\sqrt{\\sigma^{4} - C^{2}}} \\exp\\!\\left( - \\frac{1}{2(\\sigma^{4} - C^{2})} \\left[ \\sigma^{2} \\left( x_{1}^{2} + x_{2}^{2} \\right) - 2 C x_{1} x_{2} \\right] \\right),$$\n它唯一地满足给定的约束条件，并在此条件下使熵最大化。", "answer": "$$\\boxed{\\frac{1}{2 \\pi \\sqrt{\\sigma^{4} - C^{2}}}\\,\\exp\\!\\left(-\\frac{\\sigma^{2}\\!\\left(x_{1}^{2}+x_{2}^{2}\\right)-2 C x_{1} x_{2}}{2\\left(\\sigma^{4}-C^{2}\\right)}\\right)}$$", "id": "2006959"}, {"introduction": "最后一个练习将我们带入一个更抽象但功能强大的领域：随机矩阵理论，它在现代物理学中用于为复杂的量子系统建模。这个问题展示了如何利用对系统宏观可观测量（矩阵的迹及其平方的迹）的约束来推断其微观组分（特征值）的统计分布。这个实践揭示了信息论、统计力学和随机矩阵理论之间的深刻联系。[@problem_id:2006940]", "problem": "考虑一个由 $2 \\times 2$ 实对称矩阵 $M$ 构成的系综。在物理学中，此类矩阵常用于为那些具体相互作用未知的复杂量子系统建立简化的哈密顿量模型。该系综的统计性质可以通过这些矩阵的特征值 $p(\\lambda_1, \\lambda_2)$ 的联合概率分布来描述。对于实对称矩阵，其特征值总是实数。\n\n假设关于此系综的唯一已知信息是：矩阵迹的平均值为一个常数 $c_1$，矩阵平方的迹的平均值为另一个常数 $c_2$。具体来说，这些约束条件是：\n1. $\\langle \\text{Tr}(M) \\rangle = c_1$\n2. $\\langle \\text{Tr}(M^2) \\rangle = c_2$\n\n假设特征值 $\\lambda_1$ 和 $\\lambda_2$ 可以取任何实数值。请使用最大熵原理来确定与这些约束条件相符的最无偏的联合概率分布 $p(\\lambda_1, \\lambda_2)$。最大熵原理指出，最能代表当前知识状态的概率分布是在满足已知约束条件下熵最大的那个分布。请找出 $p(\\lambda_1, \\lambda_2)$ 关于 $\\lambda_1$、$\\lambda_2$、$c_1$ 和 $c_2$ 的解析表达式。已知常数 $c_1$ 和 $c_2$ 满足条件 $2c_2 > c_1^2$。", "solution": "我们在以下约束条件下最大化 $\\mathbb{R}^{2}$ 上联合密度 $p(\\lambda_{1},\\lambda_{2})$ 的微分熵：\n$$\n\\int_{\\mathbb{R}^{2}} p(\\lambda_{1},\\lambda_{2})\\,d\\lambda_{1}\\,d\\lambda_{2}=1,\\quad \\int_{\\mathbb{R}^{2}}(\\lambda_{1}+\\lambda_{2})\\,p\\,d\\lambda_{1}\\,d\\lambda_{2}=c_{1},\\quad \\int_{\\mathbb{R}^{2}}(\\lambda_{1}^{2}+\\lambda_{2}^{2})\\,p\\,d\\lambda_{1}\\,d\\lambda_{2}=c_{2}.\n$$\n熵为 $S[p]=-\\int p\\ln p$。为三个约束条件引入拉格朗日乘子 $\\alpha$、$\\mu$ 和 $\\nu$，我们建立变分泛函：\n$$\n\\mathcal{L}[p]=-\\int p\\ln p\\,d\\lambda_{1}\\,d\\lambda_{2}-\\alpha\\left(\\int p-1\\right)-\\mu\\left(\\int(\\lambda_{1}+\\lambda_{2})\\,p-c_{1}\\right)-\\nu\\left(\\int(\\lambda_{1}^{2}+\\lambda_{2}^{2})\\,p-c_{2}\\right).\n$$\n在变分 $\\delta p$ 下的平稳性条件得出：\n$$\n-\\left(\\ln p+1\\right)-\\alpha-\\mu(\\lambda_{1}+\\lambda_{2})-\\nu(\\lambda_{1}^{2}+\\lambda_{2}^{2})=0,\n$$\n因此，使熵最大化的密度具有以下指数族形式：\n$$\np(\\lambda_{1},\\lambda_{2})=\\frac{1}{Z(\\mu,\\nu)}\\exp\\!\\left(-\\mu(\\lambda_{1}+\\lambda_{2})-\\nu(\\lambda_{1}^{2}+\\lambda_{2}^{2})\\right),\n$$\n其中配分函数为：\n$$\nZ(\\mu,\\nu)=\\int_{\\mathbb{R}^{2}}\\exp\\!\\left(-\\mu(\\lambda_{1}+\\lambda_{2})-\\nu(\\lambda_{1}^{2}+\\lambda_{2}^{2})\\right)\\,d\\lambda_{1}\\,d\\lambda_{2}.\n$$\n该积分可以因式分解，通过配方法，对于 $\\nu>0$ 可得：\n$$\n\\int_{-\\infty}^{\\infty}\\exp\\!\\left(-\\nu \\lambda^{2}-\\mu \\lambda\\right)\\,d\\lambda=\\sqrt{\\frac{\\pi}{\\nu}}\\exp\\!\\left(\\frac{\\mu^{2}}{4\\nu}\\right),\n$$\n因此\n$$\nZ(\\mu,\\nu)=\\left(\\sqrt{\\frac{\\pi}{\\nu}}\\exp\\!\\left(\\frac{\\mu^{2}}{4\\nu}\\right)\\right)^{2}=\\frac{\\pi}{\\nu}\\exp\\!\\left(\\frac{\\mu^{2}}{2\\nu}\\right).\n$$\n等价地，该密度可以分解为两个相同的一维高斯分布：\n$$\np(\\lambda_{1},\\lambda_{2})=\\left(\\sqrt{\\frac{\\nu}{\\pi}}\\exp\\!\\left(-\\nu \\lambda_{1}^{2}-\\mu \\lambda_{1}\\right)\\right)\\left(\\sqrt{\\frac{\\nu}{\\pi}}\\exp\\!\\left(-\\nu \\lambda_{2}^{2}-\\mu \\lambda_{2}\\right)\\right).\n$$\n约束条件决定了 $\\mu$ 和 $\\nu$。使用标准关系式 $E[\\lambda_{1}+\\lambda_{2}]=-\\,\\partial_{\\mu}\\ln Z$ 和 $E[\\lambda_{1}^{2}+\\lambda_{2}^{2}]=-\\,\\partial_{\\nu}\\ln Z$，以及\n$$\n\\ln Z(\\mu,\\nu)=\\ln \\pi-\\ln \\nu+\\frac{\\mu^{2}}{2\\nu},\n$$\n我们得到\n$$\nE[\\lambda_{1}+\\lambda_{2}]=-\\,\\frac{\\partial \\ln Z}{\\partial \\mu}=-\\frac{\\mu}{\\nu}=c_{1}\\quad\\Rightarrow\\quad \\mu=-\\nu\\,c_{1},\n$$\n以及\n$$\nE[\\lambda_{1}^{2}+\\lambda_{2}^{2}]=-\\,\\frac{\\partial \\ln Z}{\\partial \\nu}=\\frac{1}{\\nu}+\\frac{\\mu^{2}}{2\\nu^{2}}=c_{2}.\n$$\n将 $\\mu=-\\nu c_{1}$ 代入第二个方程，可得\n$$\nc_{2}=\\frac{1}{\\nu}+\\frac{c_{1}^{2}}{2}\\quad\\Rightarrow\\quad \\nu=\\frac{1}{c_{2}-\\frac{c_{1}^{2}}{2}}.\n$$\n给定条件 $2c_{2}>c_{1}^{2}$ 确保了 $\\nu>0$，从而保证了分布的可归一性。将 $\\mu=-\\nu c_{1}$ 代入指数部分并进行配方，可以得到更清晰的形式：\n$$\np(\\lambda_{1},\\lambda_{2})=\\frac{\\nu}{\\pi}\\exp\\!\\left(-\\nu\\left[(\\lambda_{1}-\\tfrac{c_{1}}{2})^{2}+(\\lambda_{2}-\\tfrac{c_{1}}{2})^{2}\\right]\\right),\n$$\n再代入 $\\nu=\\left(c_{2}-\\frac{c_{1}^{2}}{2}\\right)^{-1}$，最终得到\n$$\np(\\lambda_{1},\\lambda_{2})=\\frac{1}{\\pi\\left(c_{2}-\\frac{c_{1}^{2}}{2}\\right)}\\exp\\!\\left(-\\frac{\\left(\\lambda_{1}-\\frac{c_{1}}{2}\\right)^{2}+\\left(\\lambda_{2}-\\frac{c_{1}}{2}\\right)^{2}}{c_{2}-\\frac{c_{1}^{2}}{2}}\\right).\n$$\n这便是在给定约束条件下 $\\mathbb{R}^{2}$ 上的最大熵联合密度。它在交换 $\\lambda_{1}$ 和 $\\lambda_{2}$ 时是对称的，并且具有独立同分布的高斯边缘分布，其均值为 $\\frac{c_{1}}{2}$，方差为 $\\frac{1}{2}\\left(c_{2}-\\frac{c_{1}^{2}}{2}\\right)$。", "answer": "$$\\boxed{\\frac{1}{\\pi\\left(c_{2}-\\frac{c_{1}^{2}}{2}\\right)}\\,\\exp\\!\\left(-\\frac{\\left(\\lambda_{1}-\\frac{c_{1}}{2}\\right)^{2}+\\left(\\lambda_{2}-\\frac{c_{1}}{2}\\right)^{2}}{c_{2}-\\frac{c_{1}^{2}}{2}}\\right)}$$", "id": "2006940"}]}