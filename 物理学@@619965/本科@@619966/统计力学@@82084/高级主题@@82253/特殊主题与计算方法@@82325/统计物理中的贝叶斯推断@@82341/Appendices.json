{"hands_on_practices": [{"introduction": "贝叶斯推断的核心在于利用新证据更新我们对世界的信念。这个练习将通过一个经典的物理场景——黑体辐射——来展示这一过程。我们将探讨如何仅凭探测到的一个光子的频率，就能更新我们对一个热腔温度的两种相互竞争的假设的相对置信度 [@problem_id:1949232]。", "problem": "一位研究人员正在研究一个可以完美近似为黑体辐射体的热腔。他们不确定其真实的平衡温度 $T$。在进行任何测量之前，该研究人员考虑了关于温度的两个竞争假设 $T_A$ 和 $T_B$。他们对这些假设的初始评估由其概率之比量化，即 $P(T_A)/P(T_B) = R$。\n\n为了获取更多信息，该研究人员使用高灵敏度光谱仪从腔体的一个孔穴中探测到一个光子。测得该光子的频率精确为 $\\nu_0$。在单位时间内，从温度为 $T$ 的黑体中探测到给定频率 $\\nu$ 的光子的概率与腔内光子的谱数密度 $n(\\nu, T)$ 成正比。$n(\\nu, T)$ 的形式由普朗克分布确定。\n\n基于这次单光子测量提供的证据，这两个温度的新的、更新后的概率之比 $P(T_A | \\text{data}) / P(T_B | \\text{data})$ 是多少？其中数据为观测到频率为 $\\nu_0$ 的光子。请用 $R$、$T_A$、$T_B$、$\\nu_0$、普朗克常数 $h$ 和玻尔兹曼常数 $k_B$ 将你的答案表示为一个符号表达式。", "solution": "我们有两个温度假设 $T_{A}$ 和 $T_{B}$，其先验几率为 $P(T_{A})/P(T_{B})=R$。从腔体中观测到一个频率为 $\\nu_{0}$ 的单光子后，根据贝叶斯定理的几率形式可得\n$$\n\\frac{P(T_{A}\\,|\\,\\text{data})}{P(T_{B}\\,|\\,\\text{data})}\n= \\frac{P(\\text{data}\\,|\\,T_{A})}{P(\\text{data}\\,|\\,T_{B})}\\,\\frac{P(T_{A})}{P(T_{B})}\n= R \\,\\frac{P(\\text{data}\\,|\\,T_{A})}{P(\\text{data}\\,|\\,T_{B})}.\n$$\n问题陈述，单位时间内探测到频率为 $\\nu$ 的光子的概率与腔内光子的谱数密度 $n(\\nu,T)$ 成正比。对于黑体，其谱数密度由普朗克分布给出\n$$\nn(\\nu,T)=\\frac{8\\pi \\nu^{2}}{c^{3}}\\frac{1}{\\exp\\!\\left(\\frac{h\\nu}{k_{B}T}\\right)-1}.\n$$\n将测量到频率为 $\\nu_{0}$ 的光子这一事件解释为在某个固定的（仪器的）带宽和时间窗口内发生的，那么对于温度 $T$ 的似然与 $n(\\nu_{0},T)$ 成正比，乘以一个与 $T$ 无关的常数，该常数在比率中被消去。因此，\n$$\n\\frac{P(\\text{data}\\,|\\,T_{A})}{P(\\text{data}\\,|\\,T_{B})}\n=\\frac{n(\\nu_{0},T_{A})}{n(\\nu_{0},T_{B})}\n=\\frac{\\dfrac{8\\pi \\nu_{0}^{2}}{c^{3}}\\dfrac{1}{\\exp\\!\\left(\\frac{h\\nu_{0}}{k_{B}T_{A}}\\right)-1}}\n{\\dfrac{8\\pi \\nu_{0}^{2}}{c^{3}}\\dfrac{1}{\\exp\\!\\left(\\frac{h\\nu_{0}}{k_{B}T_{B}}\\right)-1}}\n=\\frac{\\exp\\!\\left(\\frac{h\\nu_{0}}{k_{B}T_{B}}\\right)-1}{\\exp\\!\\left(\\frac{h\\nu_{0}}{k_{B}T_{A}}\\right)-1}.\n$$\n将此代入几率更新公式，可得\n$$\n\\frac{P(T_{A}\\,|\\,\\text{data})}{P(T_{B}\\,|\\,\\text{data})}\n= R \\,\\frac{\\exp\\!\\left(\\frac{h\\nu_{0}}{k_{B}T_{B}}\\right)-1}{\\exp\\!\\left(\\frac{h\\nu_{0}}{k_{B}T_{A}}\\right)-1}.\n$$\n这仅用 $R$、$T_{A}$、$T_{B}$、$\\nu_{0}$、$h$ 和 $k_{B}$ 表示了后验几率，符合题目要求。", "answer": "$$\\boxed{R\\,\\frac{\\exp\\!\\left(\\frac{h \\nu_{0}}{k_{B} T_{B}}\\right)-1}{\\exp\\!\\left(\\frac{h \\nu_{0}}{k_{B} T_{A}}\\right)-1}}$$", "id": "1949232"}, {"introduction": "除了估计参数，贝叶斯方法在模型选择中也扮演着至关重要的角色，即在多个竞争的理论假设之间进行权衡。在这个问题中，你将扮演一位材料科学家的角色，通过实验数据来推断一个晶体中原子激发态的简并度 [@problem_id:1949277]。这个练习将帮助你理解贝叶斯因子或似然比是如何量化支持不同物理模型的证据的。", "problem": "一位材料科学家正在研究一种新合成的绝缘晶体。该晶体中原子的量子力学行为可以被建模为一个由 $N=10$ 个独立、可区分的实体组成的系统。每个实体可以处于两个能级之一：能量为 $E_0=0$、简并度为 $g_0=1$ 的基态，或者能量为 $E_1=\\epsilon$、简并度为未知整数 $g$ 的激发态。\n\n基于理论考虑，这位科学家对激发态的简并度提出了三种相互竞争的假设：$H_1: g=1$、$H_2: g=2$ 和 $H_3: g=3$。在进行任何测量之前，她假设这三种假设是等可能的。\n\n该晶体与恒定温度 $T$ 的热浴达到热平衡。温度 $T$ 使得无量纲项 $\\frac{\\epsilon}{k_B T}$ 恰好等于 $\\ln(2)$，其中 $k_B$ 是玻尔兹曼常数。然后，一种先进的成像技术使得科学家能够同时确定这 $N=10$ 个实体中每一个的能态。测量结果显示，恰好有 $k=4$ 个实体处于激发态。\n\n基于这一实验结果，进行贝叶斯分析以更新这三种假设的概率。设 $P(g=1|D)$、$P(g=2|D)$ 和 $P(g=3|D)$ 表示在给定数据 $D$（即观察到 $k=4$ 个实体被激发）的情况下，这些假设的后验概率。下列哪项正确描述了这些后验概率之间的关系？\n\nA. $P(g=1|D) > P(g=2|D) > P(g=3|D)$\n\nB. $P(g=2|D) > P(g=1|D) > P(g=3|D)$\n\nC. $P(g=3|D) > P(g=2|D) > P(g=1|D)$\n\nD. $P(g=1|D) = P(g=2|D) > P(g=3|D)$\n\nE. $P(g=2|D) > P(g=3|D) > P(g=1|D)$", "solution": "对于处于温度 $T$ 热平衡中的单个实体，定义 $\\beta \\equiv \\frac{1}{k_{B}T}$。单个实体的配分函数为\n$$\nZ_{1}=g_{0}\\exp(-\\beta E_{0})+g\\exp(-\\beta E_{1})=1+g\\exp(-\\beta\\epsilon).\n$$\n因此单个实体的激发概率为\n$$\np(g)=\\frac{g\\exp(-\\beta\\epsilon)}{1+g\\exp(-\\beta\\epsilon)}.\n$$\n已知 $\\frac{\\epsilon}{k_{B}T}=\\ln(2)$，我们有 $\\beta\\epsilon=\\ln(2)$，因此 $\\exp(-\\beta\\epsilon)=\\exp(-\\ln 2)=\\frac{1}{2}$。所以\n$$\np(g)=\\frac{g\\left(\\frac{1}{2}\\right)}{1+g\\left(\\frac{1}{2}\\right)}=\\frac{g}{g+2},\\quad 1-p(g)=\\frac{2}{g+2}.\n$$\n\n对于 $N=10$ 个独立、可区分的实体，观察到恰好 $k=4$ 个被激发的概率服从二项分布：\n$$\nP(D\\mid g)=\\binom{10}{4}\\left[p(g)\\right]^{4}\\left[1-p(g)\\right]^{6}=\\binom{10}{4}\\left(\\frac{g}{g+2}\\right)^{4}\\left(\\frac{2}{g+2}\\right)^{6}.\n$$\n\n三种假设 $H_{1}:g=1$、$H_{2}:g=2$、$H_{3}:g=3$ 具有相等的先验概率 $P(H_{i})=\\frac{1}{3}$。根据贝叶斯定理，\n$$\nP(g\\mid D)\\propto P(D\\mid g)P(g),\n$$\n因此，在先验概率相等的情况下，后验概率的排序与似然度的排序一致。\n\n计算似然度，忽略公共因子 $\\binom{10}{4}$：\n- 对于 $g=1$：$p=\\frac{1}{3}$，所以\n$$\nL_{1}=\\left(\\frac{1}{3}\\right)^{4}\\left(\\frac{2}{3}\\right)^{6}=\\frac{2^{6}}{3^{10}}.\n$$\n- 对于 $g=2$：$p=\\frac{1}{2}$，所以\n$$\nL_{2}=\\left(\\frac{1}{2}\\right)^{4}\\left(\\frac{1}{2}\\right)^{6}=\\left(\\frac{1}{2}\\right)^{10}.\n$$\n- 对于 $g=3$：$p=\\frac{3}{5}$，所以\n$$\nL_{3}=\\left(\\frac{3}{5}\\right)^{4}\\left(\\frac{2}{5}\\right)^{6}.\n$$\n\n比较比值：\n$$\n\\frac{L_{2}}{L_{1}}=\\frac{\\left(\\frac{1}{2}\\right)^{10}}{\\frac{2^{6}}{3^{10}}}=\\frac{3^{10}}{2^{16}}<1\\quad\\Rightarrow\\quad L_{2}<L_{1},\n$$\n$$\n\\frac{L_{3}}{L_{2}}=\\frac{\\left(\\frac{3}{5}\\right)^{4}\\left(\\frac{2}{5}\\right)^{6}}{\\left(\\frac{1}{2}\\right)^{10}}=\\frac{3^{4}2^{16}}{5^{10}}<1\\quad\\Rightarrow\\quad L_{3}<L_{2}.\n$$\n因此 $L_{1}>L_{2}>L_{3}$，并且在先验概率相等的情况下，这意味着\n$$\nP(g=1\\mid D)>P(g=2\\mid D)>P(g=3\\mid D).\n$$\n这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "1949277"}, {"introduction": "在许多物理问题中，我们不仅关心不同假设的相对可能性，还希望找到参数的最可能值。这个问题将我们带入量子计算的前沿，研究一个与电子库相连的量子点，并应用巨正则系综的知识 [@problem_id:1949268]。通过一次对系统微观状态的精确测量，你将学习如何计算化学势的最大后验 (MAP) 估计，这是在给定数据下最可信的参数值。", "problem": "一个纳米尺度的量子点被设计用作量子计算电路中的一个组件。该量子点可以被建模为一个系统，其中一个电子有两个不同的单粒子能级：能量为 $\\epsilon_0$ 的基态和能量为 $\\epsilon_1$ 的激发态。由于强的库仑排斥和泡利不相容原理，该量子点最多可以容纳两个电子，每个能级一个。\n\n该量子点与一个大的电子库相连，使其保持在恒定的温度 $T$ 和化学势 $\\mu$。玻尔兹曼常数用 $k_B$ 表示。\n\n对该量子点进行了一次实验测量，发现其中恰好含有一个电子，该电子占据了基态能级 $\\epsilon_0$。在这次测量之前，对于化学势 $\\mu$ 在一个非常宽的物理上可能的值范围内没有偏好的值。这种先验知识最好用均匀概率分布来描述。\n\n根据这次单一的实验观察，确定化学势 $\\mu$ 的最可能值。该值被称为最大后验 (MAP) 估计。用包含 $\\epsilon_0$ 和 $\\epsilon_1$ 的符号表达式来表示你的答案。", "solution": "该量子点与温度为 $T$、化学势为 $\\mu$ 的粒子库交换粒子，因此每个构型 $(n_{0},n_{1})$（其中 $n_{i}\\in\\{0,1\\}$）的巨正则权重正比于 $\\exp\\!\\left(-\\beta(E-\\mu N)\\right)$，这里 $\\beta=\\frac{1}{k_{B}T}$，$E=n_{0}\\epsilon_{0}+n_{1}\\epsilon_{1}$，$N=n_{0}+n_{1}$。允许的构型及其权重如下：\n- $(0,0)$：$E=0$，$N=0$，权重 $w_{00}=1$，\n- $(1,0)$：$E=\\epsilon_{0}$，$N=1$，权重 $w_{10}=\\exp\\!\\left(-\\beta(\\epsilon_{0}-\\mu)\\right)$，\n- $(0,1)$：$E=\\epsilon_{1}$，$N=1$，权重 $w_{01}=\\exp\\!\\left(-\\beta(\\epsilon_{1}-\\mu)\\right)$，\n- $(1,1)$：$E=\\epsilon_{0}+\\epsilon_{1}$，$N=2$，权重 $w_{11}=\\exp\\!\\left(-\\beta(\\epsilon_{0}+\\epsilon_{1}-2\\mu)\\right)$。\n\n配分函数为\n$$\nZ= w_{00}+w_{10}+w_{01}+w_{11}\n=1+\\exp\\!\\left(-\\beta(\\epsilon_{0}-\\mu)\\right)+\\exp\\!\\left(-\\beta(\\epsilon_{1}-\\mu)\\right)+\\exp\\!\\left(-\\beta(\\epsilon_{0}+\\epsilon_{1}-2\\mu)\\right).\n$$\n观察到的构型（一个电子在基态，即 $(1,0)$）的概率是\n$$\nP_{10}(\\mu)=\\frac{w_{10}}{Z}=\\frac{\\exp\\!\\left(-\\beta(\\epsilon_{0}-\\mu)\\right)}{1+\\exp\\!\\left(-\\beta(\\epsilon_{0}-\\mu)\\right)+\\exp\\!\\left(-\\beta(\\epsilon_{1}-\\mu)\\right)+\\exp\\!\\left(-\\beta(\\epsilon_{0}+\\epsilon_{1}-2\\mu)\\right)}.\n$$\n由于 $\\mu$ 在一个非常宽的范围内服从均匀先验分布，后验概率正比于似然函数 $P_{10}(\\mu)$，因此 MAP 估计即使得 $P_{10}(\\mu)$ 最大化。引入\n$$\nx=\\exp(\\beta\\mu),\\quad a_{0}=\\exp(-\\beta\\epsilon_{0}),\\quad a_{1}=\\exp(-\\beta\\epsilon_{1}),\n$$\n这样\n$$\nP_{10}(x)=\\frac{a_{0}x}{1+(a_{0}+a_{1})x+a_{0}a_{1}x^{2}}.\n$$\n对 $x$ 求导：\n$$\n\\frac{dP_{10}}{dx}=\\frac{a_{0}\\left[1+(a_{0}+a_{1})x+a_{0}a_{1}x^{2}-x\\left((a_{0}+a_{1})+2a_{0}a_{1}x\\right)\\right]}{\\left(1+(a_{0}+a_{1})x+a_{0}a_{1}x^{2}\\right)^{2}}\n=\\frac{a_{0}\\left(1-a_{0}a_{1}x^{2}\\right)}{\\left(1+(a_{0}+a_{1})x+a_{0}a_{1}x^{2}\\right)^{2}}.\n$$\n令 $\\frac{dP_{10}}{dx}=0$ 得到 $1-a_{0}a_{1}x^{2}=0$，即\n$$\nx^{2}=\\frac{1}{a_{0}a_{1}}=\\exp\\!\\left(\\beta(\\epsilon_{0}+\\epsilon_{1})\\right).\n$$\n因为 $x>0$，我们取 $x=\\exp\\!\\left(\\frac{\\beta}{2}(\\epsilon_{0}+\\epsilon_{1})\\right)$，这意味着\n$$\n\\exp(\\beta\\mu)=\\exp\\!\\left(\\frac{\\beta}{2}(\\epsilon_{0}+\\epsilon_{1})\\right)\\quad\\Rightarrow\\quad \\mu=\\frac{\\epsilon_{0}+\\epsilon_{1}}{2}.\n$$\n导数的符号表明，当 $x<\\exp\\!\\left(\\frac{\\beta}{2}(\\epsilon_{0}+\\epsilon_{1})\\right)$ 时 $P_{10}$ 增加，当 $x$ 更大时 $P_{10}$ 减小，因此这个临界点是唯一的全局最大值点。因此，MAP 估计值为\n$$\n\\mu_{\\text{MAP}}=\\frac{\\epsilon_{0}+\\epsilon_{1}}{2}.\n$$", "answer": "$$\\boxed{\\frac{\\epsilon_{0}+\\epsilon_{1}}{2}}$$", "id": "1949268"}]}