{"hands_on_practices": [{"introduction": "我们的第一个练习将我们带入一个生物物理学的场景，探讨一个具有离散能量状态的系统。如果我们只知道整个系统的平均能量，我们该如何预测粒子在每个能量状态中的分布概率？这个问题 [@problem_id:1963872] 是一个典型的应用，它将展示在能量约束下最大化熵如何自然地导出了玻尔兹曼-吉布斯分布，这是统计力学的基石。", "problem": "一个生物系统中资源竞争的简化模型考虑了一个微生物菌落，该菌落分布在三个不同的生态位中，用索引 $x \\in \\{1, 2, 3\\}$ 标记。占据索引为 $x$ 的生态位会给微生物带来特定的代谢能量成本，由函数 $E(x) = \\epsilon_0 x$ 给出，其中 $\\epsilon_0$ 是一个代表基本能量单位的正常数。\n\n该系统已达到稳态，实验测量表明，整个菌落中每个微生物的平均代谢能量成本恰好为 $\\langle E \\rangle = 1.5 \\epsilon_0$。\n\n假设该菌落处于最概然宏观态，根据统计力学原理，这对应于在给定约束条件下使系统香农熵 $S = -C \\sum_{x=1}^{3} p(x) \\ln(p(x))$ 最大化的概率分布 $\\{p(x)\\}$。此处，$p(x)$ 是在生态位 $x$ 中找到一个随机选取的微生物的概率，$C$ 是一个正常数。\n\n遵循此最大熵原理，确定在生态位 1 中找到一个微生物的概率 $p(1)$。将您的最终答案四舍五入到四位有效数字。", "solution": "我们在归一化和平均能量固定的约束下最大化香农熵。熵为 $S=-C\\sum_{x=1}^{3}p(x)\\ln p(x)$，约束条件为 $\\sum_{x=1}^{3}p(x)=1$ 和 $\\sum_{x=1}^{3}p(x)E(x)=\\langle E\\rangle=1.5\\,\\epsilon_{0}$，其中 $E(x)=\\epsilon_{0}x$。引入拉格朗日乘子 $\\alpha$ 和 $\\beta$ 并定义拉格朗日量\n$$\n\\mathcal{L}=-C\\sum_{x=1}^{3}p(x)\\ln p(x)-\\alpha\\left(\\sum_{x=1}^{3}p(x)-1\\right)-\\beta\\left(\\sum_{x=1}^{3}p(x)E(x)-1.5\\,\\epsilon_{0}\\right).\n$$\n相对于 $p(x)$ 的平稳性条件给出\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial p(x)}=-C\\left(\\ln p(x)+1\\right)-\\alpha-\\beta E(x)=0,\n$$\n所以\n$$\n\\ln p(x)=-1-\\frac{\\alpha}{C}-\\frac{\\beta}{C}E(x)\\quad\\Longrightarrow\\quad p(x)=A\\,\\exp\\!\\left(-\\lambda E(x)\\right),\n$$\n其中 $A=\\exp\\!\\left(-1-\\frac{\\alpha}{C}\\right)$ 且 $\\lambda=\\frac{\\beta}{C}$。归一化得到吉布斯形式\n$$\np(x)=\\frac{\\exp\\!\\left(-\\lambda E(x)\\right)}{Z(\\lambda)},\\qquad Z(\\lambda)=\\sum_{y=1}^{3}\\exp\\!\\left(-\\lambda E(y)\\right).\n$$\n当 $E(x)=\\epsilon_{0}x$ 时，定义 $a\\equiv \\exp\\!\\left(-\\lambda\\epsilon_{0}\\right)>0$，则\n$$\np(x)=\\frac{a^{x}}{\\sum_{y=1}^{3}a^{y}}=\\frac{a^{x}}{a+a^{2}+a^{3}}.\n$$\n能量约束 $\\langle E\\rangle=\\epsilon_{0}\\langle x\\rangle=1.5\\,\\epsilon_{0}$ 给出 $\\langle x\\rangle=1.5$，即\n$$\n\\frac{a+2a^{2}+3a^{3}}{a+a^{2}+a^{3}}=1.5.\n$$\n去分母并化简，\n$$\na+2a^{2}+3a^{3}=1.5(a+a^{2}+a^{3})\\;\\Longrightarrow\\;1.5a^3 + 0.5a^2 - 0.5a = 0\\;\\Longrightarrow\\;a\\left(3a^{2}+a-1\\right)=0.\n$$\n由于 $a>0$，解方程 $3a^{2}+a-1=0$ 可得\n$$\na=\\frac{-1+\\sqrt{13}}{6}.\n$$\n则\n$$\np(1)=\\frac{a}{a+a^{2}+a^{3}}=\\frac{1}{1+a+a^{2}}.\n$$\n使用 $3a^{2}+a-1=0\\Rightarrow a^{2}=\\frac{1-a}{3}$，\n$$\n1+a+a^{2}=1+a+\\frac{1-a}{3}=\\frac{4}{3}+\\frac{2}{3}a=\\frac{2}{3}(2+a),\n$$\n所以\n$$\np(1)=\\frac{1}{\\frac{2}{3}(2+a)}=\\frac{3}{2(2+a)}.\n$$\n代入 $a=\\frac{\\sqrt{13}-1}{6}$：\n$$\n2+a=\\frac{11+\\sqrt{13}}{6}\\quad\\Longrightarrow\\quad p(1)=\\frac{3}{2}\\cdot\\frac{6}{11+\\sqrt{13}}=\\frac{9}{11+\\sqrt{13}}=\\frac{11-\\sqrt{13}}{12}.\n$$\n数值计算上，$\\sqrt{13}\\approx 3.605551275$，因此 $p(1)\\approx \\frac{11-3.605551275}{12}\\approx 0.616204060$，四舍五入到四位有效数字是 $0.6162$。", "answer": "$$\\boxed{0.6162}$$", "id": "1963872"}, {"introduction": "接下来，我们将探讨范围从离散世界扩展到连续领域。想象一个场景，我们正在监控一条高速公路上的车流，但由于技术限制，我们只能获得所有车辆的平均速度，那么单个车辆的速度遵循什么样的概率分布呢？这个练习 [@problem_id:1963861] 将指导我们将熵最大化原理应用于连续变量，并最终推导出指数分布，这个分布在描述等待时间、放射性衰变等随机过程中扮演着至关重要的角色。", "problem": "一套新的交通监控系统正在一条很长、很直的高速公路上进行测试。由于数据带宽的限制，该系统只记录一个单一值：所有观测到的汽车速度的算术平均值，记为 $\\bar{v}$。单个的速度测量值会被丢弃。我们的任务是仅根据此信息，为汽车速度 $v$ 的分布创建一个统计模型。我们假设汽车速度可以建模为一个连续的非负变量，因此速度的定义域为 $v \\in [0, \\infty)$。\n\n您的任务是确定与给定的平均速度 $\\bar{v}$ 一致的最无偏的概率密度函数 $p(v)$。最无偏的分布是在满足所有已知约束的同时，对未知信息做出最少假设的分布。\n\n请用速度 $v$ 和平均速度 $\\bar{v}$ 来表示 $p(v)$ 的解析表达式。", "solution": "我们已知的条件仅有平均速度 $\\bar{v}$，以及速度是定义在 $[0, \\infty)$ 上的连续变量。在这种矩约束下，最无偏的分布是通过在已知约束条件下最大化微分熵来获得的。设 $p(v)$ 是 $[0, \\infty)$ 上的密度函数。\n\n我们最大化香农微分熵\n$$\nS[p] = -\\int_{0}^{\\infty} p(v)\\,\\ln p(v)\\,dv\n$$\n其约束条件为归一化和固定均值：\n$$\n\\int_{0}^{\\infty} p(v)\\,dv = 1, \\quad \\int_{0}^{\\infty} v\\,p(v)\\,dv = \\bar{v}.\n$$\n引入拉格朗日乘子 $\\alpha$ 和 $\\beta$，并定义拉格朗日泛函\n$$\n\\mathcal{L}[p] = -\\int_{0}^{\\infty} p(v)\\,\\ln p(v)\\,dv - \\alpha\\left(\\int_{0}^{\\infty} p(v)\\,dv - 1\\right) - \\beta\\left(\\int_{0}^{\\infty} v\\,p(v)\\,dv - \\bar{v}\\right).\n$$\n对 $p(v)$ 求泛函导数，并令其为零以获得最优解：\n$$\n\\frac{\\delta \\mathcal{L}}{\\delta p(v)} = -\\left(\\ln p(v) + 1\\right) - \\alpha - \\beta v = 0.\n$$\n这得到\n$$\n\\ln p(v) = -1 - \\alpha - \\beta v \\quad \\Rightarrow \\quad p(v) = \\exp(-1-\\alpha)\\,\\exp(-\\beta v).\n$$\n令 $A = \\exp(-1-\\alpha)$；则\n$$\np(v) = A\\,\\exp(-\\beta v), \\quad v \\ge 0.\n$$\n施加归一化约束：\n$$\n\\int_{0}^{\\infty} A\\,\\exp(-\\beta v)\\,dv = \\frac{A}{\\beta} = 1 \\quad \\Rightarrow \\quad A = \\beta,\n$$\n这要求 $\\beta > 0$ 以保证可积性。接下来施加均值约束：\n$$\n\\int_{0}^{\\infty} v\\,A\\,\\exp(-\\beta v)\\,dv = \\frac{A}{\\beta^{2}} = \\bar{v}.\n$$\n代入 $A = \\beta$ 可得\n$$\n\\frac{\\beta}{\\beta^{2}} = \\frac{1}{\\beta} = \\bar{v} \\quad \\Rightarrow \\quad \\beta = \\frac{1}{\\bar{v}}.\n$$\n因此，在给定均值 $\\bar{v}$ 的情况下，$[0,\\infty)$ 上的最大熵（最无偏）密度函数是指数分布\n$$\np(v) = \\frac{1}{\\bar{v}}\\,\\exp\\!\\left(-\\frac{v}{\\bar{v}}\\right), \\quad v \\in [0,\\infty).\n$$\n该函数满足非负性、归一化和指定的均值，并且根据其构造过程，它在这些约束下最大化了熵。", "answer": "$$\\boxed{\\frac{1}{\\bar{v}}\\,\\exp\\!\\left(-\\frac{v}{\\bar{v}}\\right)}$$", "id": "1963861"}, {"introduction": "最后的这个练习将揭示熵最大化原理最深刻且应用最广泛的结果之一。如果我们不仅知道一个连续变量的平均值 $\\mu$，还知道它的方差 $\\sigma^2$（即数据偏离平均值的程度），我们能确定它的概率分布吗？这个问题 [@problem_id:1963846] 将一步步引导我们推导出这个分布，最终得到著名的高斯（或正态）分布。这从根本上解释了为什么高斯分布在自然科学和社会科学中无处不在——因为它是在给定均值和方差的情况下最“随机”或最无偏见的分布。", "problem": "在统计力学中，最大熵原理指出，在已知约束条件下，为系统建模最合适的概率分布是使信息熵最大化的那一个。这确保了模型尽可能无偏，仅包含由约束给定的信息。\n\n考虑一个定义在整个实数轴（从 $-\\infty$ 到 $\\infty$）上的连续随机变量 $x$。其概率密度函数 $p(x)$ 的信息含量由微分熵量化，该微分熵由以下泛函给出：\n$$S[p] = -\\int_{-\\infty}^{\\infty} p(x) \\ln(p(x)) \\, dx$$\n\n我们寻求能够最大化此熵 $S[p]$，同时满足以下三个约束条件的特定概率分布 $p(x)$：\n1.  归一化：在整个定义域上的总概率必须为一。\n    $$\\int_{-\\infty}^{\\infty} p(x) \\, dx = 1$$\n2.  固定均值：该分布必须具有指定的均值 $\\mu$。\n    $$\\int_{-\\infty}^{\\infty} x p(x) \\, dx = \\mu$$\n3.  固定方差：该分布必须具有指定的非零方差 $\\sigma^2$。\n    $$\\int_{-\\infty}^{\\infty} (x-\\mu)^2 p(x) \\, dx = \\sigma^2$$\n\n确定此最大随机性概率分布 $p(x)$ 的函数形式。你的最终答案应为 $p(x)$ 关于变量 $x$、均值 $\\mu$ 和标准差 $\\sigma$ 的闭式解析表达式。", "solution": "我们使用泛函的 Lagrange 乘子法，来应用带约束的最大熵原理。为归一化、均值和方差分别引入乘子 $\\lambda_{0}$、$\\lambda_{1}$ 和 $\\lambda_{2}$，并定义增广泛函\n$$\n\\mathcal{J}[p] = -\\int_{-\\infty}^{\\infty} p(x)\\ln p(x)\\,dx - \\lambda_{0}\\left(\\int_{-\\infty}^{\\infty} p(x)\\,dx - 1\\right) - \\lambda_{1}\\left(\\int_{-\\infty}^{\\infty} x\\,p(x)\\,dx - \\mu\\right) - \\lambda_{2}\\left(\\int_{-\\infty}^{\\infty} (x-\\mu)^{2} p(x)\\,dx - \\sigma^{2}\\right).\n$$\n在变分 $\\delta p(x)$（满足 $p(x)\\ge 0$）下的驻定性，从泛函导数为零可得到 Euler–Lagrange 条件：\n$$\n\\frac{\\delta \\mathcal{J}}{\\delta p(x)} = -\\left(\\ln p(x) + 1\\right) - \\lambda_{0} - \\lambda_{1} x - \\lambda_{2} (x-\\mu)^{2} = 0.\n$$\n解出 $p(x)$ 可得\n$$\n\\ln p(x) = -1 - \\lambda_{0} - \\lambda_{1} x - \\lambda_{2} (x-\\mu)^{2},\n\\quad\\text{so}\\quad\np(x) = A\\,\\exp\\left(-\\lambda_{1} x - \\lambda_{2} (x-\\mu)^{2}\\right),\n$$\n其中 $A = \\exp(-1-\\lambda_{0})$ 吸收了常数项。为使 $p(x)$ 在 $(-\\infty,\\infty)$ 上可归一化，必须有 $\\lambda_{2} > 0$；否则积分发散。\n\n对指数部分使用配方法，以确定其隐含的均值。写出\n$$\n-\\lambda_{1} x - \\lambda_{2} (x-\\mu)^{2} = -\\lambda_{2}\\left[x^{2} - 2\\mu x + \\mu^{2}\\right] - \\lambda_{1} x\n= -\\lambda_{2}\\left(x - m\\right)^{2} - \\lambda_{2}\\mu^{2} + \\lambda_{2} m^{2},\n$$\n其中 $m$ 的选择使 $2\\lambda_{2} m = 2\\lambda_{2}\\mu - \\lambda_{1}$，即，\n$$\nm = \\mu - \\frac{\\lambda_{1}}{2\\lambda_{2}}.\n$$\n因此，\n$$\np(x) \\propto \\exp\\left(-\\lambda_{2} (x - m)^{2}\\right),\n$$\n这是一个均值为 $m$ 的高斯分布。施加均值约束 $\\int x\\,p(x)\\,dx = \\mu$ 意味着 $m = \\mu$，因此\n$$\n\\lambda_{1} = 0.\n$$\n当 $\\lambda_{1}=0$ 时，该密度函数变为\n$$\np(x) = A\\,\\exp\\left(-\\lambda_{2} (x-\\mu)^{2}\\right).\n$$\n归一化条件确定了 $A$：\n$$\n1 = \\int_{-\\infty}^{\\infty} p(x)\\,dx = A \\int_{-\\infty}^{\\infty} \\exp\\left(-\\lambda_{2} (x-\\mu)^{2}\\right)\\,dx = A\\,\\sqrt{\\frac{\\pi}{\\lambda_{2}}},\n\\quad\\Rightarrow\\quad\nA = \\sqrt{\\frac{\\lambda_{2}}{\\pi}}.\n$$\n方差约束确定了 $\\lambda_{2}$。计算\n$$\n\\sigma^{2} = \\int_{-\\infty}^{\\infty} (x-\\mu)^{2} p(x)\\,dx\n= A \\int_{-\\infty}^{\\infty} (x-\\mu)^{2} \\exp\\left(-\\lambda_{2} (x-\\mu)^{2}\\right)\\,dx\n= \\sqrt{\\frac{\\lambda_{2}}{\\pi}} \\cdot \\frac{\\sqrt{\\pi}}{2 \\lambda_{2}^{3/2}} = \\frac{1}{2\\lambda_{2}}.\n$$\n因此，\n$$\n\\lambda_{2} = \\frac{1}{2\\sigma^{2}},\n\\quad\\text{and}\\quad\nA = \\sqrt{\\frac{1}{2\\sigma^{2}\\pi}} = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}.\n$$\n将这些值代入 $p(x)$ 得\n$$\np(x) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\left(-\\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\right).\n$$\n由于微分熵泛函相对于 $p$ 是严格凹的，并且约束是线性的，所以这个驻定解是唯一的全局最大值点。因此，在给定约束下，具有最大随机性的分布是均值为 $\\mu$、方差为 $\\sigma^{2}$ 的高斯分布。", "answer": "$$\\boxed{\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\left(-\\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\right)}$$", "id": "1963846"}]}