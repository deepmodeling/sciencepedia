{"hands_on_practices": [{"introduction": "在统计力学中，核心任务之一是计算一个宏观状态对应的微观状态数量。这个练习将 Stirling 近似直接应用于一个大规模的组合问题，你将计算一个由大量可区分个体组成的系统的构型复杂性，即微观状态总数 $W$ 的自然对数 $\\ln(W)$。这个量与玻尔兹曼熵直接相关，是连接微观组合与宏观热力学性质的桥梁[@problem_id:1994083]。", "problem": "在一个大规模数据处理系统中，一个包含 $N$ 个唯一且可区分的记录的数据集必须被分配到三个计算集群中。记录总数为 $N = 1.5 \\times 10^6$。工作负载必须按照特定比例进行划分：集群1接收 $N_1 = 0.25 N$ 条记录，集群2接收 $N_2 = 0.40 N$ 条记录，集群3接收剩余的 $N_3$ 条记录。每一种将记录分配到集群的具体方案都构成系统的一个不同的“微观状态”。\n\n可能的微观状态总数 $W$ 是该分布组合复杂性的一个度量。由于 $N$ 的值巨大，计算该数量的自然对数 $\\ln(W)$ 更为实用，它与系统的构型信息内容直接相关。\n\n计算 $\\ln(W)$ 的值。在计算中，您必须使用Stirling近似的标准形式 $\\ln(n!) \\approx n \\ln(n) - n$，该公式对大的 $n$ 有效。将您的最终答案以实数形式报告，并四舍五入到四位有效数字。", "solution": "将 $N$ 个可区分的记录分配到三个具有固定数量 $N_{1}$、$N_{2}$、$N_{3}$ 的标记集群中的每一种不同分配方式，都可以通过多项式系数来计算\n$$\nW=\\frac{N!}{N_{1}!\\,N_{2}!\\,N_{3}!},\n$$\n其中 $N_{1}=0.25\\,N$，$N_{2}=0.40\\,N$，$N_{3}=N-N_{1}-N_{2}=0.35\\,N$。取自然对数并对每个阶乘应用Stirling近似 $\\ln(n!)\\approx n\\ln(n)-n$ 可得\n$$\n\\ln(W)\\approx \\left[N\\ln N - N\\right]-\\left[N_{1}\\ln N_{1}-N_{1}\\right]-\\left[N_{2}\\ln N_{2}-N_{2}\\right]-\\left[N_{3}\\ln N_{3}-N_{3}\\right].\n$$\n利用 $N_{1}+N_{2}+N_{3}=N$，线性项相互抵消，得到\n$$\n\\ln(W)\\approx N\\ln N - N_{1}\\ln N_{1} - N_{2}\\ln N_{2} - N_{3}\\ln N_{3}.\n$$\n令 $N_{i}=f_{i}N$，其中 $f_{1}=0.25$，$f_{2}=0.40$，$f_{3}=0.35$，我们可得\n$$\n\\ln(W)\\approx N\\ln N - \\sum_{i=1}^{3} f_{i}N \\ln(f_{i}N)\n= N\\ln N - N\\sum_{i=1}^{3} f_{i}\\left[\\ln f_{i}+\\ln N\\right]\n= -\\,N\\sum_{i=1}^{3} f_{i}\\ln f_{i}.\n$$\n代入分数和 $N=1.5\\times 10^{6}$，\n$$\n\\sum_{i=1}^{3} f_{i}\\ln f_{i}\n= 0.25\\ln(0.25)+0.40\\ln(0.40)+0.35\\ln(0.35)\n\\approx -0.34657359028 - 0.36651629275 - 0.36743774357\n\\approx -1.08052762660,\n$$\n因此\n$$\n\\ln(W)\\approx -N\\left(-1.08052762660\\right)\n= \\left(1.08052762660\\right)\\left(1.5\\times 10^{6}\\right)\n\\approx 1.62079143991\\times 10^{6}.\n$$\n四舍五入到四位有效数字，得到\n$$\n\\ln(W)\\approx 1.621\\times 10^{6}.\n$$", "answer": "$$\\boxed{1.621 \\times 10^{6}}$$", "id": "1994083"}, {"introduction": "接下来，我们将从抽象的组合问题转向一个具体的物理模型。这个练习将引导你计算“晶格气体”的构型熵，这在表面化学和材料科学中是一个非常重要的模型。通过解决这个问题，你将学会处理不可区分粒子在可区分格点上排列的计数问题，并进一步理解熵是如何从微观排列中涌现出来的[@problem_id:1994048]。", "problem": "考虑一个与清洁燃料生产相关的催化表面化学模型。大量的（$N$个）相同的双原子分子被放置在一个带有特殊催化表面的容器中。该表面被建模为一个由$M$个不同且无相互作用的吸附位点组成的网格，其中$M > 2N$。在催化剂的作用下，每个双原子分子解离成两个独立的、不可区分的原子。随后，所有这$2N$个原子都吸附到表面上，每个原子占据一个吸附位点。假设原子可以在这些位点上以任何构型排列，并且$N$和$M$是非常大的数（在热力学极限下），请确定分布在$M$个表面位点上的$2N$个原子系统的总构型熵$S$。\n\n请用$N$、$M$和玻尔兹曼常数$k_B$表示你的最终答案的解析表达式。", "solution": "题目要求我们计算$2N$个不可区分的原子吸附在$M$个不同且无相互作用的位点上的构型熵，每个位点仅能被单个原子占据，且$M>2N$。在这种情况下，一个微观状态完全由（$M$个位点中）哪$2N$个位点被占据来确定。由于原子是不可区分的，且每个位点要么为空，要么恰好被一个原子占据，因此不同构型（微观状态）的数量就是从$M$个位点中选择$2N$个位点的方式数：\n$$\n\\Omega=\\binom{M}{2N}=\\frac{M!}{(2N)!\\,(M-2N)!}.\n$$\n构型熵由玻尔兹曼公式定义：\n$$\nS=k_{B}\\ln\\Omega=k_{B}\\ln\\binom{M}{2N}.\n$$\n在热力学极限下，$M$和$N$非常大，我们使用斯特林近似$\\ln n!\\approx n\\ln n-n$来得到\n$$\n\\ln\\binom{M}{2N}\\approx \\left(M\\ln M - M\\right)-\\left[(2N)\\ln(2N)-2N\\right]-\\left[(M-2N)\\ln(M-2N)-(M-2N)\\right].\n$$\n线性项 $-M, +2N,$ 和 $+(M-2N)$ 相互抵消：\n$$\n-M + 2N + (M-2N)=0,\n$$\n剩下\n$$\n\\ln\\binom{M}{2N}\\approx M\\ln M-(2N)\\ln(2N)-(M-2N)\\ln(M-2N).\n$$\n因此，在热力学极限下的总构型熵为\n$$\nS \\approx k_{B}\\left[M\\ln M-(2N)\\ln(2N)-(M-2N)\\ln(M-2N)\\right].\n$$\n这是用$N$、$M$和$k_{B}$表示的主导阶解析表达式。", "answer": "$$\\boxed{k_{B}\\left[M \\ln M - (2N)\\ln(2N) - (M - 2N)\\ln(M - 2N)\\right]}$$", "id": "1994048"}, {"introduction": "在掌握了如何计算系统总熵之后，我们来探讨一个更深入的概念：涨落。这个练习将展示 Stirling 近似的强大威力，它不仅能计算最概然状态的熵，还能推导出在一个大系统的局部区域中，观测到偏离平均值的涨落的概率。你将亲手推导出著名的正态分布（高斯分布）形式，这是统计物理中描述涨落现象的基石[@problem_id:1994094]。", "problem": "考虑一个气体分子吸附到大的催化表面上的简化模型。该表面由数量巨大 ($M$) 的离散且等效的吸附位点组成。总共有 $N$ 个相同且无相互作用的分子吸附在这些位点上，每个位点最多只能吸附一个分子。分子总数固定，使得恰好一半的位点被占据，即 $N = M/2$。假定 $N$ 个分子在 $M$ 个位点上的所有可能微观排列都是等概率的。\n\n我们关心的是这个表面上一个包含 $m$ 个位点的小连续区域的统计性质。假设 $M \\gg m \\gg 1$。设 $n$ 是在这个区域内找到的分子数。该区域内分子的期望数是 $\\langle n \\rangle = m/2$。\n\n问题是要找到观测到涨落，即与该平均值的偏差，的概率。具体来说，设该区域内的分子数为 $n = m/2 + \\delta$，其中 $\\delta$ 是一个满足 $|\\delta| \\ll m/2$ 的整数。\n\n推导在该区域内恰好找到 $n$ 个分子的概率 $P(n)$ 的近似解析表达式。你的最终表达式应该是 $m$ 和 $\\delta$ 的函数。在此推导中，你应该使用 Stirling 近似来处理阶乘的自然对数，即对于大的 $k$，有 $\\ln(k!) \\approx k \\ln k - k$。你可能也会发现，对于小的 $|x|$，Taylor 级数展开 $\\ln(1+x) \\approx x - x^2/2$ 会很有用。\n\n请用 $m$ 和 $\\delta$ 表示 $P(n)$ 的最终表达式。", "solution": "在全局约束 $N=M/2$ 下，位点的随机占据意味着在一个包含 $m$ 个位点的区域内，被占据的位点数 $n$ 服从超几何分布，\n$$\nP(n)=\\frac{\\binom{M/2}{n}\\binom{M/2}{m-n}}{\\binom{M}{m}}.\n$$\n当 $M\\gg m$ 时，无放回抽样可以很好地被有放回抽样所近似，因此 $P(n)$ 简化为参数 $p=N/M=1/2$ 的二项分布形式：\n$$\nP(n)\\approx 2^{-m}\\binom{m}{n}.\n$$\n令 $n=m/2+\\delta$，其中 $|\\delta|\\ll m/2$。我们现在对阶乘使用 Stirling 近似，并展开到 $\\delta/m$ 的二阶。写出\n$$\n\\ln P(n)=\\ln\\binom{m}{m/2+\\delta}-m\\ln 2=\\ln m!-\\ln\\left(\\left(\\frac{m}{2}+\\delta\\right)!\\right)-\\ln\\left(\\left(\\frac{m}{2}-\\delta\\right)!\\right)-m\\ln 2.\n$$\n使用包含次领头项的 Stirling 形式，\n$$\n\\ln k!\\approx k\\ln k-k+\\frac{1}{2}\\ln(2\\pi k),\n$$\n得到\n$$\n\\ln\\binom{m}{m/2+\\delta}\\approx m\\ln m-\\left(\\frac{m}{2}+\\delta\\right)\\ln\\left(\\frac{m}{2}+\\delta\\right)-\\left(\\frac{m}{2}-\\delta\\right)\\ln\\left(\\frac{m}{2}-\\delta\\right)+\\frac{1}{2}\\left[\\ln(2\\pi m)-\\ln\\left(2\\pi\\left(\\frac{m}{2}+\\delta\\right)\\right)-\\ln\\left(2\\pi\\left(\\frac{m}{2}-\\delta\\right)\\right)\\right].\n$$\n定义 $a\\equiv m/2$。那么\n$$\n\\ln\\binom{m}{a+\\delta}\\approx m\\ln m-(a+\\delta)\\ln(a+\\delta)-(a-\\delta)\\ln(a-\\delta)+\\frac{1}{2}\\left[\\ln(2\\pi m)-\\ln(2\\pi(a+\\delta))-\\ln(2\\pi(a-\\delta))\\right].\n$$\n使用 $\\ln(1+x)\\approx x-\\frac{x^{2}}{2}$ 在 $\\delta=0$ 附近展开：\n$$\n\\ln(a\\pm\\delta)=\\ln a+\\ln\\left(1\\pm\\frac{\\delta}{a}\\right)\\approx\\ln a\\pm\\frac{\\delta}{a}-\\frac{1}{2}\\frac{\\delta^{2}}{a^{2}},\n$$\n并且\n$$\n(a\\pm\\delta)\\ln(a\\pm\\delta)\\approx a\\ln a\\pm\\delta\\ln a\\pm\\delta+\\frac{1}{2}\\frac{\\delta^{2}}{a}.\n$$\n将 $+$ 和 $-$ 的贡献相加，得到\n$$\n(a+\\delta)\\ln(a+\\delta)+(a-\\delta)\\ln(a-\\delta)\\approx 2a\\ln a+\\frac{\\delta^{2}}{a}.\n$$\n因此，\n$$\nm\\ln m-(a+\\delta)\\ln(a+\\delta)-(a-\\delta)\\ln(a-\\delta)\\approx m\\ln m-2a\\ln a-\\frac{\\delta^{2}}{a}=m\\ln\\left(\\frac{m}{a}\\right)-\\frac{\\delta^{2}}{a}.\n$$\n当 $a=m/2$ 时，上式变为\n$$\nm\\ln 2-\\frac{2\\delta^{2}}{m}.\n$$\n现在处理对数前置因子。使用上述展开式，\n$$\n\\ln(2\\pi m)-\\ln(2\\pi(a+\\delta))-\\ln(2\\pi(a-\\delta))=\\ln m-\\ln(a+\\delta)-\\ln(a-\\delta)-\\ln(2\\pi).\n$$\n到二阶，\n$$\n\\ln(a+\\delta)+\\ln(a-\\delta)\\approx 2\\ln a-\\frac{\\delta^{2}}{a^{2}},\n$$\n所以\n$$\n\\ln m-\\ln(a+\\delta)-\\ln(a-\\delta)\\approx \\ln\\left(\\frac{m}{a^{2}}\\right)+\\frac{\\delta^{2}}{a^{2}}.\n$$\n当 $a=m/2$ 时，$\\ln(m/a^{2})=\\ln(4/m)$ 且 $\\delta^{2}/a^{2}=4\\delta^{2}/m^{2}$，后者是比保留项 $2\\delta^{2}/m$ 更高阶的项；因此我们将其舍去。因此前置因子贡献了\n$$\n\\frac{1}{2}\\left[\\ln(2\\pi m)-\\ln(2\\pi(a+\\delta))-\\ln(2\\pi(a-\\delta))\\right]\\approx \\frac{1}{2}\\ln\\left(\\frac{2}{\\pi m}\\right).\n$$\n汇总所有项，\n$$\n\\ln\\binom{m}{m/2+\\delta}\\approx m\\ln 2-\\frac{2\\delta^{2}}{m}+\\frac{1}{2}\\ln\\left(\\frac{2}{\\pi m}\\right).\n$$\n最后，\n$$\n\\ln P(n)=\\ln\\binom{m}{m/2+\\delta}-m\\ln 2\\approx -\\frac{2\\delta^{2}}{m}+\\frac{1}{2}\\ln\\left(\\frac{2}{\\pi m}\\right),\n$$\n取指数后得到所需的高斯涨落公式，\n$$\nP(n)\\approx \\sqrt{\\frac{2}{\\pi m}}\\;\\exp\\!\\left(-\\frac{2\\delta^{2}}{m}\\right),\n$$\n该公式在 $M\\gg m\\gg 1$ 和 $|\\delta|\\ll m$ 时有效。", "answer": "$$\\boxed{\\sqrt{\\frac{2}{\\pi m}}\\,\\exp\\!\\left(-\\frac{2\\delta^{2}}{m}\\right)}$$", "id": "1994094"}]}