{"hands_on_practices": [{"introduction": "自洽场 (Self-Consistent Field, SCF) 方法是一个迭代过程，正如任何此类旅程一样，它必须从第一步开始。这第一步是为电子轨道提供一个合理的初始猜测。本练习 [@problem_id:2031975] 将挑战您运用您对基本原子结构的知识，例如构造原理 (Aufbau principle)，为一个多电子原子构建最合理的初始构型，为整个迭代计算奠定基础。", "problem": "Hartree方法是一种迭代程序，用于近似求解多电子原子的基态波函数和能量。这个迭代过程，常被称为自洽场（Self-Consistent Field, SCF）程序，必须从一个物理上合理的、关于电子所占据的单粒子波函数（轨道）集合的初始猜测开始。一种标准的方法是使用类氢原子波函数作为初始猜测，这些波函数是只有一个电子和电荷为$+Ze$的原子核的体系的精确解。\n\n考虑一个中性硼原子，其核电荷数为$Z=5$。你的任务是确定为该原子的基态启动SCF计算所需的最合适的*不同已占据空间轨道*集合的初始猜测。类氢原子波函数用$\\psi_{n,l,m_l}$表示，其中$n$、$l$和$m_l$分别是主量子数、角量子数和磁量子数。\n\n下列哪项代表了用于初始猜测的最物理上合理的的不同空间波函数集合？\n\nA. $\\{ \\psi_{1,0,0}, \\psi_{1,0,0}, \\psi_{1,0,0}, \\psi_{1,0,0}, \\psi_{1,0,0} \\}$\n\nB. $\\{ \\psi_{1,0,0}, \\psi_{2,0,0}, \\psi_{2,1,0} \\}$\n\nC. $\\{ \\psi_{1,0,0}, \\psi_{2,0,0}, \\psi_{3,0,0} \\}$\n\nD. $\\{ \\psi_{2,1,-1}, \\psi_{2,1,0}, \\psi_{2,1,1}, \\psi_{3,0,0} \\}$\n\nE. $\\{ \\psi_{5,0,0}, \\psi_{5,1,0}, \\psi_{5,2,0} \\}$", "solution": "对于一个中性硼原子，其电子数为$Z=5$。在Hartree SCF的独立粒子起点，我们根据构造原理（Aufbau principle）、Pauli不相容原理和Hund规则来填充类氢原子空间轨道。Pauli不相容原理指出，最多两个电子（自旋相反）可以占据同一个空间轨道。对于标记为$\\psi_{n,l,m_{l}}$的类氢原子轨道，亚层的容量是$2(2l+1)$，因为每个空间轨道有$2l+1$个$m_{l}$值和两种自旋态。\n\n遵循多电子原子的构造顺序，5个电子的最低能量排布是$1s^2 2s^2 2p^1$。这使用了：\n- $1s$空间轨道$\\psi_{1,0,0}$，它可以容纳两个自旋相反的电子；\n- $2s$空间轨道$\\psi_{2,0,0}$，它可以容纳两个自旋相反的电子；\n- 三个简并的$2p$空间轨道$\\psi_{2,1,m_{l}}$（其中$m_{l}\\in\\{-1,0,1\\}$）之一，它容纳了第五个电子（Hund规则指出，在配对之前，应先单个占据一个$2p$轨道）。\n\n问题要求的是不同的已占据空间轨道的集合，即不考虑自旋多重性，每个空间函数只计算一次。因此，合适的初始集合是$\\{\\psi_{1,0,0},\\ \\psi_{2,0,0},\\ \\psi_{2,1,m_{l}}\\}$，其中$m_l$可以是任何一个允许的值。在给定的选项中，这由选择$m_{l}=0$来表示，即$\\{\\psi_{1,0,0},\\ \\psi_{2,0,0},\\ \\psi_{2,1,0}\\}$，这与选项B相匹配。所有其他选项要么多次重复同一个空间轨道，要么省略了必需的较低能量轨道，要么选择了与基态构型不符的、对应更高主量子数的轨道。", "answer": "$$\\boxed{B}$$", "id": "2031975"}, {"introduction": "有了初始猜测之后，我们现在将深入探讨自洽场方法的核心引擎：迭代本身。关键是从由前一组轨道产生的势场中，计算出一套新的、经过改进的轨道。本练习 [@problem_id:2031953] 侧重于为单个电子构建有效势，这要求您仔细考虑来自所有其他电子的贡献，并正确应用迭代更新的逻辑。", "problem": "考虑一个针对中性铍原子 (Be) 的自洽场 (SCF) 计算，该原子的核电荷为 $Z=4$，电子构型为 $1s^2 2s^2$。基于 Hartree 模型的 SCF 过程是一种迭代方法，用于求解近似的单粒子电子轨道。\n\n该过程始于对轨道的初始猜测，记为 $\\psi_{nl}^{(0)}(r)$。这些是“第零次迭代”的轨道。根据这些轨道，构建一个有效势，用于在第一次迭代中求解一组新的轨道 $\\psi_{nl}^{(1)}$。此过程不断重复，直到轨道及其能量收敛为止。\n\n为此问题设定如下记法：\n-   主量子数为 $n$、角动量量子数为 $l$ 的状态中的电子，在第 $k$ 次迭代后的轨道为 $\\psi_{nl}^{(k)}(r_j)$，其中 $r_j$ 是该电子的位置。\n-   位于 $r_i$ 处的电子因原子核而产生的势能为 $V_{\\text{nuc}}(r_i) = -Z e^2 / (4\\pi\\varepsilon_0 r_i)$。\n-   在轨道 $\\psi_{nl}^{(k)}$ 中的单个电子（位于 $r_j$）的时间平均电荷分布，对位置 $r_i$ 产生的势能贡献由以下积分给出：\n$$ U_{nl}^{(k)}(r_i) = \\int |\\psi_{nl}^{(k)}(r_j)|^2 \\frac{e^2}{4\\pi\\varepsilon_0 |r_i - r_j|} d^3 r_j $$\n\n任务是确定在计算的特定阶段，作用于某一特定电子的有效势。下列哪个表达式表示总有效势能算符 $V(r_i)$？该算符用于不含时薛定谔方程中，以计算某个 2s 电子的*第二次迭代*轨道，即 $\\psi_{2s}^{(2)}(r_i)$。\n\nA. $V(r_i) = V_{nuc}(r_i) + 2 U_{1s}^{(0)}(r_i) + U_{2s}^{(0)}(r_i)$\n\nB. $V(r_i) = V_{nuc}(r_i) + 2 U_{1s}^{(1)}(r_i) + U_{2s}^{(1)}(r_i)$\n\nC. $V(r_i) = V_{nuc}(r_i) + 2 U_{1s}^{(1)}(r_i) + 2 U_{2s}^{(1)}(r_i)$\n\nD. $V(r_i) = V_{nuc}(r_i) + U_{1s}^{(1)}(r_i) + U_{2s}^{(1)}(r_i)$\n\nE. $V(r_i) = V_{nuc}(r_i) + 2 U_{1s}^{(2)}(r_i) + U_{2s}^{(2)}(r_i)$", "solution": "在 Hartree SCF 方法中，第 $k$ 次迭代的每个轨道 $\\psi_{nl}^{(k)}(r)$ 都是通过求解单粒子薛定谔方程得到的，方程中的有效势是根据前一次迭代中所有其他电子的平均电荷密度构建的。对于 2s 轨道，在第 $k=2$ 次迭代时的不含时薛定谔方程为\n$$\n\\left[-\\frac{\\hbar^{2}}{2m}\\nabla_{i}^{2} + V^{(2)}(r_{i})\\right]\\psi_{2s}^{(2)}(r_{i}) = \\varepsilon_{2s}^{(2)}\\psi_{2s}^{(2)}(r_{i}).\n$$\n作用于电子 $i$ 的有效势包含：(i) 核的吸引作用，以及 (ii) 所有其他电子的库仑排斥作用。根据所提供的定义，\n$$\nV_{nuc}(r_{i}) = -\\frac{Z e^{2}}{4\\pi\\varepsilon_{0} r_{i}}, \\qquad U_{nl}^{(k)}(r_{i}) = \\int |\\psi_{nl}^{(k)}(r_{j})|^{2}\\frac{e^{2}}{4\\pi\\varepsilon_{0}|r_{i}-r_{j}|}\\,d^{3}r_{j}.\n$$\n因为 $U_{nl}^{(k)}$ 定义为第 $k$ 次迭代时，处于轨道 $(n,l)$ 的单个电子的时间平均电荷分布所产生的势，所以一个已占据亚层的贡献为其占据数乘以 $U_{nl}^{(k)}$。然而，在为给定电子构建势时，必须排除自相互作用：对于所考虑的这个 2s 电子，只有另一个 2s 电子对其有贡献。\n\n对于电子构型为 $1s^2 2s^2$ 的铍原子，某个特定的 2s 电子所感受到的其他电子是两个 1s 电子和另一个 2s 电子。在 SCF 迭代中，用于计算 $\\psi_{2s}^{(2)}$ 的势必须由前一次迭代（即第 $k=1$ 次迭代）中获得的轨道来构建。因此，\n$$\nV^{(2)}(r_{i}) = V_{nuc}(r_{i}) + 2\\,U_{1s}^{(1)}(r_{i}) + 1\\,U_{2s}^{(1)}(r_{i}).\n$$\n这与选项 B 相符。选项 A 和 E 使用了错误的迭代密度；选项 C 因包含自相互作用而重复计算了 2s 电子的贡献；选项 D 忽略了一个 1s 电子。", "answer": "$$\\boxed{B}$$", "id": "2031953"}, {"introduction": "在科学计算的真实世界中，理论算法常常面临实际的障碍。简单的自洽场迭代有时可能无法收敛，计算出的电子密度会来回振荡而不是稳定下来。这个问题 [@problem_id:2031988] 向您介绍了这种常见的数值不稳定性，并促使您像计算物理学家一样思考，设计一种简单而强大的数值技术来抑制这些振荡，引导计算走向稳定、自洽的解。", "problem": "在多电子原子的 Hartree 模型中，目标是为电子结构找到一个自洽解。该过程是迭代的，是自洽场 (SCF) 方法的一个基础范例。让我们定义一次迭代的核心步骤，用 $k$ (其中 $k=0, 1, 2, ...$) 作为索引：\n\n1.  从一个输入电子密度 $\\rho^{(k)}(\\mathbf{r})$ 开始。\n2.  计算电子所感受到的平均场势（例如 Hartree 势）$V^{(k)}(\\mathbf{r})$，该势是 $\\rho^{(k)}(\\mathbf{r})$ 的一个泛函。\n3.  在势 $V^{(k)}(\\mathbf{r})$ 下求解单电子 Schrödinger 方程组，以获得一组新的单粒子轨道 $\\{\\phi_i^{(k)}\\}$ 及其对应的能量。\n4.  从轨道集 $\\{\\phi_i^{(k)}\\}$ 中的已占据轨道构建一个输出电子密度 $\\rho_{\\text{out}}^{(k)}(\\mathbf{r})$。\n5.  使用该输出密度生成下一次迭代的输入密度 $\\rho^{(k+1)}(\\mathbf{r})$。\n\n最简单的更新方案是直接代入：$\\rho^{(k+1)}(\\mathbf{r}) = \\rho_{\\text{out}}^{(k)}(\\mathbf{r})$。重复此过程，直到输入和输出密度足够接近，即对于某个很小的容差 $\\epsilon$，满足 $||\\rho^{(k+1)} - \\rho^{(k)}||  \\epsilon$。\n\n然而，对于最高已占轨道和最低未占轨道之间能隙很小的系统，这种直接代入方法通常无法收敛。相反，它会进入一种持续振荡的状态，其中电子密度在连续的迭代中于两种（或多种）构型之间来回切换，这种现象有时被称为“电荷振荡”(charge sloshing)。例如，连续迭代密度之差 $||\\rho^{(k+1)} - \\rho^{(k)}||$ 可能会收敛到一个较大的非零常数，而不是趋近于零。\n\n为解决这种不稳定性，请为步骤 5 提出一种改进的更新规则。你的新规则应引入一个无量纲实数参数 $\\alpha$（其中 $0  \\alpha \\leq 1$）来控制更新速率。目标是朝着新的输出密度迈出更保守的一步，而不是完全采用它。请用当前迭代的输入密度 $\\rho^{(k)}(\\mathbf{r})$、当前迭代的输出密度 $\\rho_{\\text{out}}^{(k)}(\\mathbf{r})$以及你引入的参数 $\\alpha$ 来构建下一次迭代的输入密度 $\\rho^{(k+1)}(\\mathbf{r})$ 的表达式。", "solution": "我们寻求一个稳定的不动点迭代方法来处理从输入密度到输出密度的 SCF 映射：定义一个非线性映射 $F$，其满足 $F[\\rho^{(k)}](\\mathbf{r}) \\equiv \\rho_{\\text{out}}^{(k)}(\\mathbf{r})$。SCF 解是一个满足 $F[\\rho^{\\ast}](\\mathbf{r})=\\rho^{\\ast}(\\mathbf{r})$ 的不动点 $\\rho^{\\ast}(\\mathbf{r})$。直接代入方案即为 Picard 迭代 $\\rho^{(k+1)}(\\mathbf{r})=F[\\rho^{(k)}](\\mathbf{r})$，当映射 $F$ 在不动点附近的雅可比矩阵的特征值的模接近或大于 1 时，该迭代会变得不稳定和振荡。\n\n为抑制这些振荡，我们引入一个弛豫参数 $0\\alpha\\leq 1$，并从 $\\rho^{(k)}$ 朝着 $F[\\rho^{(k)}]$ 迈出一个欠松弛步。改进的更新规则为\n$$\n\\rho^{(k+1)}(\\mathbf{r})=\\rho^{(k)}(\\mathbf{r})+\\alpha\\big(F[\\rho^{(k)}](\\mathbf{r})-\\rho^{(k)}(\\mathbf{r})\\big).\n$$\n将 $F[\\rho^{(k)}](\\mathbf{r})=\\rho_{\\text{out}}^{(k)}(\\mathbf{r})$ 代入，上式变为线性混合规则\n$$\n\\rho^{(k+1)}(\\mathbf{r})=(1-\\alpha)\\,\\rho^{(k)}(\\mathbf{r})+\\alpha\\,\\rho_{\\text{out}}^{(k)}(\\mathbf{r}).\n$$\n此规则保留了不动点：如果 $\\rho^{(k)}=\\rho^{\\ast}$ 并且 $F[\\rho^{\\ast}]=\\rho^{\\ast}$，那么 $\\rho^{(k+1)}=\\rho^{\\ast}$。当 $\\alpha=1$ 时，它也简化为直接代入。如果 $\\rho^{(k)}(\\mathbf{r})$ 和 $\\rho_{\\text{out}}^{(k)}(\\mathbf{r})$ 都是非负的，且积分后得到相同的粒子数 $N$，那么 $\\rho^{(k+1)}(\\mathbf{r})$ 是一个凸组合，它也保持非负，并且积分后仍为 $N$，因为\n$$\n\\int \\rho^{(k+1)}(\\mathbf{r})\\,d\\mathbf{r}=(1-\\alpha)\\int \\rho^{(k)}(\\mathbf{r})\\,d\\mathbf{r}+\\alpha\\int \\rho_{\\text{out}}^{(k)}(\\mathbf{r})\\,d\\mathbf{r}=N.\n$$\n在不动点 $\\rho^{\\ast}$ 附近进行线性稳定性分析，其雅可比矩阵为 $J=\\delta F/\\delta \\rho|_{\\rho^{\\ast}}$，对于误差 $\\delta \\rho^{(k)}=\\rho^{(k)}-\\rho^{\\ast}$，我们得到：\n$$\n\\delta \\rho^{(k+1)}=\\big((1-\\alpha)I+\\alpha J\\big)\\,\\delta \\rho^{(k)},\n$$\n因此，选择足够小的 $\\alpha$ 可以将 $(1-\\alpha)I+\\alpha J$ 的谱半径减小到 1 以下，从而在保持正确不动点的前提下，抑制振荡并改善收敛性。", "answer": "$$\\boxed{\\rho^{(k+1)}(\\mathbf{r})=(1-\\alpha)\\,\\rho^{(k)}(\\mathbf{r})+\\alpha\\,\\rho_{\\text{out}}^{(k)}(\\mathbf{r})}$$", "id": "2031988"}]}