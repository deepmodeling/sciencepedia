{"hands_on_practices": [{"introduction": "密度泛函理论的基石是Hohenberg-Kohn变分原理，它为我们通过电子密度计算基态能量提供了理论保证。然而，任何强大的定理都有其应用的边界条件。本练习通过一个看似矛盾的计算结果，引导我们深入探究该变分原理成立的一个关键前提，从而加深对理论形式结构的理解。", "problem": "一名本科生正在探索密度泛函理论（DFT）的基础。他们决定在最简单的体系上检验 Hohenberg-Kohn (HK) 变分原理：一个单一的、非相对论性的氢原子。\n\n在原子单位下，氢原子的外势由 $v_{ext}(\\vec{r}) = -1/r$ 给出。已知的精确基态能量为 $E_0 = -0.5$ 哈特里。对于单电子体系，总能量可以表示为电子密度 $n(\\vec{r})$ 的一个精确泛函：\n$$E[n] = T_s[n] + \\int v_{ext}(\\vec{r}) n(\\vec{r}) d^3\\vec{r}$$\n其中 $T_s[n]$ 是密度为 $n(\\vec{r})$ 的单个无相互作用电子的动能泛函。\n\n该学生使用两种不同的试探电子密度 $n_A(\\vec{r})$ 和 $n_B(\\vec{r})$ 进行了两次计算。\n1.  使用试探密度 $n_A(\\vec{r})$，计算出的能量为 $E[n_A] = -0.46$ 哈特里。\n2.  使用试探密度 $n_B(\\vec{r})$，计算出的能量为 $E[n_B] = -0.53$ 哈特里。\n\n第二个结果，$E[n_B] < E_0$，似乎直接违反了第二 Hohenberg-Kohn 定理（变分原理），该原理指出任何有效的试探密度所得到的能量都必须大于或等于真实的基态能量。假设动能泛函 $T_s[n]$ 的计算是精确的，并且所有数值积分都没有误差，那么造成这个矛盾结果的最根本的理论原因是什么？\n\nA. Hohenberg-Kohn 定理是为多电子体系推导的，并且已知在像氢原子这样的单电子体系特例中会失效。\n\nB. DFT 中的变分原理本身只是一个近似，并不能保证能量的下界。\n\nC. 这个结果必定是由于使用了近似的动能泛函 $T_s[n]$，因为即使对于单电子，该泛函的精确形式也是未知的。\n\nD. 试探密度 $n_B(\\vec{r})$ 对于单电子体系而言不是一个物理上有效的密度（即，它不是“N-可表示的”），因此违反了变分原理应用的一个关键先决条件。\n\nE. 计算 B 发现了一个比之前已知的更稳定的氢原子电子态，这表明 $E_0 = -0.5$ 哈特里不是真正的基态。", "solution": "我们从 Levy-Lieb 约束搜索形式的精确 Hohenberg-Kohn 变分表述开始。对于给定的外势 $v(\\vec r)$ 和粒子数 $N$，定义普适泛函\n$$\nF[n] = \\min_{\\Psi \\to n} \\langle \\Psi | \\hat T + \\hat V_{ee} | \\Psi \\rangle,\n$$\n其中最小化是针对所有能产生密度 $n(\\vec r)$ 的反对称 $N$ 电子波函数 $\\Psi$ 进行的。对于任何 N-可表示的密度 $n$（即，至少来自一个这样的 $\\Psi$），DFT 能量泛函为\n$$\nE_{v}[n] = F[n] + \\int v(\\vec r) \\, n(\\vec r) \\, d^{3}\\vec r.\n$$\n设 $\\Psi_{n}$ 是一个在 $F[n]$ 定义中达到（或任意接近）最小值的波函数。那么\n$$\nE_{v}[n] = \\langle \\Psi_{n} | \\hat T + \\hat V_{ee} | \\Psi_{n} \\rangle + \\int v \\, n\n= \\langle \\Psi_{n} | \\hat T + \\hat V_{ee} + \\hat V | \\Psi_{n} \\rangle \\ge E_{0},\n$$\n其中 $E_{0}$ 是精确的基态能量，不等式遵循 Rayleigh-Ritz 原理。因此，对于每一个 N-可表示的密度 $n$，我们有\n$$\nE_{v}[n] \\ge E_{0}.\n$$\n\n具体到单电子体系，$\\hat V_{ee} = 0$ 且\n$$\nF[n] = T_{s}[n] = \\min_{\\psi \\to n} \\langle \\psi | \\hat T | \\psi \\rangle = T_{W}[n],\n$$\n其精确形式为 Weizsäcker 泛函\n$$\nT_{W}[n] = \\frac{1}{8} \\int \\frac{|\\nabla n(\\vec r)|^{2}}{n(\\vec r)} \\, d^{3}\\vec r,\n$$\n前提是 $n$ 是 N-可表示的，并且足够正则以至于 $\\sqrt{n} \\in H^{1}(\\mathbb{R}^{3})$（确保动能是有限的）。因此，对于任何物理上有效的单电子密度 $n$，\n$$\nE[n] = T_{s}[n] + \\int v_{ext}(\\vec r) \\, n(\\vec r) \\, d^{3}\\vec r \\ge E_{0}.\n$$\n\n在题目中，我们在假设 $T_{s}[n]$ 被精确计算且积分也是精确的前提下，得到了 $E[n_{B}] < E_{0}$。上述不等式表明，对于任何 N-可表示的单电子密度，这样的结果都不可能发生。因此，唯一剩下的逻辑可能性是，$n_{B}$ 不是一个物理上可接受的单电子密度（不满足 N-可表示性，或者等价地说，对于通过约束搜索得到的 HK 变分界，它位于 $F[n]$ 的定义域之外）。典型的违规情况包括非负性缺失、未能正确归一化到 $N=1$，或者正则性不足，以至于不存在动能有限且满足 $|\\psi|^{2} = n_{B}$ 的波函数 $\\psi$。\n\n评估各个选项：\n- A 是错误的：HK 定理适用于任何 $N$，并且对于 $N=1$，泛函是精确已知的。\n- B 是错误的：对于在其定义域内的约束搜索泛函，DFT 变分原理是严格的。\n- C 是错误的：对于 $N=1$，$T_{s}[n]$ 精确地等于 $T_{W}[n]$。\n- D 是正确的：这个矛盾之所以产生，是因为 $n_{B}$ 不是 N-可表示的，从而使得变分界无效。\n- E 是错误的：氢原子的 $E_{0}$ 是精确已知的，不可能被一个物理上有效的密度所突破（得到更低的能量）。\n\n因此，最根本的理论原因是试探密度 $n_{B}$ 不是 N-可表示的。", "answer": "$$\\boxed{D}$$", "id": "1407256"}, {"introduction": "Kohn-Sham有效势 $v_s(\\vec{r})$ 是Kohn-Sham DFT方法的核心，它将复杂的多电子问题巧妙地转化为可解的单电子问题。本练习将引导你分析一个真实原子（氖原子）的有效势在两个物理极限下的行为。通过这种分析，你将对电子屏蔽、交换和相关效应如何共同塑造原子内部的势场建立起直观的物理图像。", "problem": "在密度泛函理论（DFT）的框架中，复杂的多电子问题被映射到一个在有效势中运动的无相互作用电子的更简单系统上。对于球对称原子，这个有效势就是Kohn-Sham有效势 $v_s(r)$，它是距离原子核的距离 $r$ 的函数。它被定义为三项之和：\n$v_s(r) = v_{ext}(r) + v_H(r) + v_{xc}(r)$\n其中：\n- $v_{ext}(r)$ 是由电荷为 $+Ze$ 的原子核所产生的外势，其中 $Z$ 是原子序数，$e$ 是元电荷。\n- $v_H(r)$ 是Hartree势，表示来自总电子密度分布 $n(r)$ 的经典静电排斥。\n- $v_{xc}(r)$ 是交换相关势，它包含了除经典Hartree排斥之外的所有多体量子效应。\n\n考虑一个处于基态的、孤立的、中性的氖原子。氖的原子序数是 $Z=10$。分析Kohn-Sham有效势 $v_s(r)$ 在两种极限情况下的数学行为：非常靠近原子核时（$r \\to 0$）和距离原子核非常远时（$r \\to \\infty$）。\n\n为了简化表达式，所有量均以原子单位给出，其中元电荷 $e$、电子质量 $m_e$、约化普朗克常数 $\\hbar$ 以及库仑常数 $k_e = 1/(4\\pi\\varepsilon_0)$ 均设为1。在这些单位中，距离为 $r$ 的点电荷 $q$ 产生的势就是 $q/r$。\n\n下列哪个陈述正确描述了中性氖原子中 $v_s(r)$ 的渐近行为？\n\nA. 当 $r \\to 0$ 时，$v_s(r)$ 的行为类似于 $-10/r$。当 $r \\to \\infty$ 时，$v_s(r)$ 趋近于 $0$。\n\nB. 当 $r \\to 0$ 时，$v_s(r)$ 的行为类似于 $-9/r$。当 $r \\to \\infty$ 时，$v_s(r)$ 的行为类似于 $-1/r$。\n\nC. 当 $r \\to 0$ 时，$v_s(r)$ 的行为类似于 $-10/r$。当 $r \\to \\infty$ 时，$v_s(r)$ 的行为类似于 $-1/r$。\n\nD. 当 $r \\to 0$ 时，$v_s(r)$ 趋近于一个有限的负常数值。当 $r \\to \\infty$ 时，$v_s(r)$ 趋近于 $0$。\n\nE. 当 $r \\to 0$ 时，$v_s(r)$ 的行为类似于 $-10/r$。当 $r \\to \\infty$ 时，$v_s(r)$ 的行为类似于 $-1/r^2$。", "solution": "在Kohn-Sham密度泛函理论中，有效势是以下各项之和\n$$\nv_{s}(r)=v_{\\text{ext}}(r)+v_{H}(r)+v_{xc}(r).\n$$\n在原子单位下，对于原点处电荷为 $+Z$ 的原子核，\n$$\nv_{\\text{ext}}(r)=-\\frac{Z}{r}.\n$$\n对于球对称电子密度 $n(r)$，Hartree势可以写为\n$$\nv_{H}(r)=4\\pi\\left(\\frac{1}{r}\\int_{0}^{r}n(r')\\,r'^{2}\\,dr'+\\int_{r}^{\\infty}n(r')\\,r'\\,dr'\\right).\n$$\n\n极限 $r\\to 0$。第一个Hartree项的行为如下\n$$\n\\frac{4\\pi}{r}\\int_{0}^{r}n(r')\\,r'^{2}\\,dr'=\\frac{4\\pi n(0)}{r}\\int_{0}^{r}r'^{2}\\,dr'+\\text{higher orders}=\\frac{4\\pi n(0)}{3}r^{2}+O(r^{3}),\n$$\n此项在 $r\\to 0$ 时趋于零。第二个Hartree项趋于一个有限常数，\n$$\n4\\pi\\int_{0}^{\\infty}n(r')\\,r'\\,dr',\n$$\n因为 $n(r')$ 在原点是有限的，并且在大的 $r$ 处迅速衰减。因此 $v_{H}(r)$ 在 $r=0$ 处是有限的。精确的交换相关势 $v_{xc}(r)$ 在原子核处也是有限的；电子-原子核Kato尖点条件确保了 $v_{s}(r)$ 中唯一的 $1/r$ 奇点来自于 $v_{\\text{ext}}(r)$。因此，\n$$\nv_{s}(r)=-\\frac{Z}{r}+O(1)\\quad\\text{as }r\\to 0.\n$$\n对于氖，$Z=10$，因此\n$$\nv_{s}(r)\\sim -\\frac{10}{r}\\quad\\text{as }r\\to 0.\n$$\n\n极限 $r\\to\\infty$。使用上述球形表达式，对于大的 $r$，\n$$\nv_{H}(r)=\\frac{1}{r}\\left[4\\pi\\int_{0}^{r}n(r')\\,r'^{2}\\,dr'\\right]+4\\pi\\int_{r}^{\\infty}n(r')\\,r'\\,dr'.\n$$\n令 $N=4\\pi\\int_{0}^{\\infty}n(r')\\,r'^{2}\\,dr'$ 为总电子数。那么当 $r\\to\\infty$ 时，包裹的电荷趋于 $N$，尾部积分比 $1/r$ 更快地消失，所以\n$$\nv_{H}(r)=\\frac{N}{r}+o\\!\\left(\\frac{1}{r}\\right).\n$$\n因此\n$$\nv_{\\text{ext}}(r)+v_{H}(r)=-\\frac{Z}{r}+\\frac{N}{r}+o\\!\\left(\\frac{1}{r}\\right)=\\frac{N-Z}{r}+o\\!\\left(\\frac{1}{r}\\right).\n$$\n对于中性原子，$N=Z$，所以首要的 $1/r$ 项被抵消，且 $v_{\\text{ext}}(r)+v_{H}(r)=o(1/r)$。精确的交换相关势为有限体系提供了正确的渐近行为，它遵循交换相关空穴求和规则 $\\int n_{xc}(\\mathbf{r},\\mathbf{r}')\\,d\\mathbf{r}'=-1$，这得到\n$$\nv_{xc}(r)\\sim -\\frac{1}{r}\\quad\\text{as }r\\to\\infty.\n$$\n因此，完整的Kohn-Sham势的行为是\n$$\nv_{s}(r)=v_{\\text{ext}}(r)+v_{H}(r)+v_{xc}(r)\\sim -\\frac{1}{r}\\quad\\text{as }r\\to\\infty.\n$$\n\n综合两种极限情况，对于中性氖原子，当 $r\\to 0$ 时有 $v_{s}(r)\\sim -10/r$，当 $r\\to\\infty$ 时有 $v_{s}(r)\\sim -1/r$，这对应于选项 C。", "answer": "$$\\boxed{C}$$", "id": "1999050"}, {"introduction": "在接触Kohn-Sham DFT的初期，一个常见的误区是将Kohn-Sham轨道能量之和等同于体系的总电子能量。本练习直接挑战了这一误解，它通过一个具体的原子计算案例，揭示了这两个量之间的精确关系。理解这一点对于正确解读DFT计算结果至关重要，能帮助我们避免对电子-电子相互作用能的重复计算和误用。", "problem": "在科恩-沈（Kohn-Sham, KS）密度泛函理论（DFT）的框架下，一个基态 N 电子系统的总电子能量由以下泛函给出：\n$$E[\\rho] = T_s[\\rho] + E_{ext}[\\rho] + E_H[\\rho] + E_{xc}[\\rho]$$\n在此式中，$T_s[\\rho]$ 是与真实系统具有相同密度 $\\rho$ 的无相互作用参考系统的动能，$E_{ext}[\\rho]$ 是由外势（通常来自原子核）产生的势能，$E_H[\\rho]$ 是经典的电子-电子库仑排斥能（哈特里能量），而 $E_{xc}[\\rho]$ 是交换相关能，它包含了所有非经典的量子多体效应。\n\n电子密度 $\\rho(\\mathbf{r})$ 由一组单粒子轨道 $\\phi_i$ 构成，即 $\\rho(\\mathbf{r}) = \\sum_{i=1}^{N} |\\phi_i(\\mathbf{r})|^2$。这些轨道是 KS 方程的解：\n$$ \\left( -\\frac{\\hbar^2}{2m} \\nabla^2 + v_{eff}(\\mathbf{r}) \\right) \\phi_i(\\mathbf{r}) = \\epsilon_i \\phi_i(\\mathbf{r}) $$\n其中 $\\epsilon_i$ 是 KS 本征值（轨道能量）。\n\n对于一个中性氮原子（N，原子序数 Z=7），一次 DFT 计算得到以下已占据 KS 轨道的本征值：\n$\\epsilon_{1s} = -381.5$ eV\n$\\epsilon_{2s} = -18.6$ eV\n$\\epsilon_{2p_x} = \\epsilon_{2p_y} = \\epsilon_{2p_z} = -8.1$ eV\n\n同一次计算给出的总电子能量为 $E[\\rho] = -1483.2$ eV。已占据 KS 轨道本征值的总和为 $\\sum_{i}^{occ} \\epsilon_i = 2 \\times (-381.5) + 2 \\times (-18.6) + 3 \\times (-8.1) = -824.5$ eV。这个总和显然不等于总电子能量。\n\n下列哪个陈述为此差异提供了正确的物理解释？\n\nA. 本征值之和没有物理意义，其与总能量的差异是所使用的特定交换相关泛函带来的计算赝象。\n\nB. 本征值之和未能正确地计入电子-电子相互作用；具体而言，它重复计算了经典的哈特里排斥能，并且未能正确地表示交换相关能的贡献。\n\nC. 本征值之和仅代表电子的势能，差异源于完全忽略了电子动能。\n\nD. 本征值之和准确地代表了所有的电子-电子和动能贡献，但完全忽略了电子与原子核之间的相互作用能。\n\nE. 总能量的计算是有缺陷的，因为根据 Hellmann-Feynman 定理，对于任何自洽计算，总能量必须等于轨道能量之和。", "solution": "这个问题的核心是理解 Kohn-Sham (KS) 总能量 $E[\\rho]$ 与已占据 KS 轨道本征值之和 $\\sum_i^{occ} \\epsilon_i$ 之间的关系。\n\n我们从 KS-DFT 中的总电子能量表达式开始：\n$$E[\\rho] = T_s[\\rho] + E_{ext}[\\rho] + E_H[\\rho] + E_{xc}[\\rho]$$\n其中 $T_s$ 是无相互作用动能，$E_{ext}$ 是电子-原子核吸引能，$E_H$ 是经典的电子-电子（哈特里）排斥能，而 $E_{xc}$ 是交换相关能。\n\n现在，我们来分析已占据轨道本征值的总和。KS 本征值 $\\epsilon_i$ 从 KS 方程得到：\n$$H_{KS} \\phi_i = \\epsilon_i \\phi_i$$\n其中 $H_{KS}$ 是 KS 哈密顿算符。本征值 $\\epsilon_i$ 是 KS 哈密顿算符对于轨道 $\\phi_i$ 的期望值：\n$$ \\epsilon_i = \\langle \\phi_i | H_{KS} | \\phi_i \\rangle $$\nKS 哈密顿算符定义为 $H_{KS} = T_{op} + v_{eff}(\\mathbf{r})$，其中 $T_{op} = -\\frac{\\hbar^2}{2m} \\nabla^2$ 是动能算符，$v_{eff}$ 是有效势。有效势由下式给出：\n$$ v_{eff}(\\mathbf{r}) = v_{ext}(\\mathbf{r}) + v_H(\\mathbf{r}) + v_{xc}(\\mathbf{r}) $$\n在此，$v_{ext}$ 是外势，$v_H(\\mathbf{r}) = \\frac{\\delta E_H}{\\delta \\rho}$ 是哈特里势，$v_{xc}(\\mathbf{r}) = \\frac{\\delta E_{xc}}{\\delta \\rho}$ 是交换相关势。\n\n因此，已占据轨道本征值的总和为：\n$$ \\sum_{i=1}^{N} \\epsilon_i = \\sum_{i=1}^{N} \\langle \\phi_i | T_{op} + v_{ext} + v_H + v_{xc} | \\phi_i \\rangle $$\n我们可以将各项分离开来：\n$$ \\sum_{i=1}^{N} \\epsilon_i = \\sum_{i=1}^{N} \\langle \\phi_i | T_{op} | \\phi_i \\rangle + \\sum_{i=1}^{N} \\langle \\phi_i | v_{ext} | \\phi_i \\rangle + \\sum_{i=1}^{N} \\langle \\phi_i | v_H | \\phi_i \\rangle + \\sum_{i=1}^{N} \\langle \\phi_i | v_{xc} | \\phi_i \\rangle $$\n\n让我们将这些加和项与总能量泛函的各分量进行对应：\n1.  $\\sum_{i=1}^{N} \\langle \\phi_i | T_{op} | \\phi_i \\rangle = T_s[\\rho]$，即无相互作用动能。\n2.  $\\sum_{i=1}^{N} \\langle \\phi_i | v_{ext} | \\phi_i \\rangle = \\int \\sum_{i=1}^{N} |\\phi_i(\\mathbf{r})|^2 v_{ext}(\\mathbf{r}) d\\mathbf{r} = \\int \\rho(\\mathbf{r}) v_{ext}(\\mathbf{r}) d\\mathbf{r} = E_{ext}[\\rho]$，即电子-原子核吸引能。\n3.  $\\sum_{i=1}^{N} \\langle \\phi_i | v_H | \\phi_i \\rangle = \\int \\rho(\\mathbf{r}) v_H(\\mathbf{r}) d\\mathbf{r}$。哈特里能量泛函为 $E_H[\\rho] = \\frac{1}{2} \\int \\rho(\\mathbf{r}) v_H(\\mathbf{r}) d\\mathbf{r}$。这个 $\\frac{1}{2}$ 的因子至关重要；它避免了对电子对之间相互作用的重复计算。因此，本征值总和中的这一项恰好是哈特里能量的两倍：$\\int \\rho(\\mathbf{r}) v_H(\\mathbf{r}) d\\mathbf{r} = 2E_H[\\rho]$。\n4.  $\\sum_{i=1}^{N} \\langle \\phi_i | v_{xc} | \\phi_i \\rangle = \\int \\rho(\\mathbf{r}) v_{xc}(\\mathbf{r}) d\\mathbf{r}$。这一项是交换相关势的期望值，通常不等于交换相关能量泛函 $E_{xc}[\\rho]$。\n\n所以，本征值之和为：\n$$ \\sum_{i=1}^{N} \\epsilon_i = T_s[\\rho] + E_{ext}[\\rho] + 2E_H[\\rho] + \\int \\rho(\\mathbf{r}) v_{xc}(\\mathbf{r}) d\\mathbf{r} $$\n\n现在，我们将其与总能量表达式进行比较：\n$$ E[\\rho] = T_s[\\rho] + E_{ext}[\\rho] + E_H[\\rho] + E_{xc}[\\rho] $$\n\n差异源于与电子-电子相互作用相关的两项：\n- 本征值之和包含 $2E_H[\\rho]$，而总能量包含 $E_H[\\rho]$。本征值之和重复计算了经典的库仑排斥能。\n- 本征值之和包含 $\\int \\rho v_{xc} d\\mathbf{r}$ 项，而总能量包含交换相关能 $E_{xc}[\\rho]$。这两者不相等。\n\n因此，总能量与本征值之和的关系是：\n$$ E[\\rho] = \\sum_{i=1}^{N} \\epsilon_i - E_H[\\rho] + (E_{xc}[\\rho] - \\int \\rho(\\mathbf{r}) v_{xc}(\\mathbf{r}) d\\mathbf{r}) $$\n\n本征值之和不是总能量，因为它未能正确地处理电子-电子相互作用。我们来评估给出的选项：\nA. 错误。本征值之和具有物理意义（通过上述方程与总能量相关联），而不仅仅是计算赝象。\nB. 正确。该陈述准确地指出了本征值之和重复计算了哈特里能量，并且未能正确处理交换相关能的贡献。这正是产生差异的精确原因。\nC. 错误。本征值之和明确包含了动能项 $T_s[\\rho]$。\nD. 错误。本征值之和明确包含了电子-原子核相互作用能 $E_{ext}[\\rho]$。\nE. 错误。Hellmann-Feynman 定理关联的是总能量的导数与哈密顿算符导数的期望值，这是一个不同的概念。没有普适的定理表明在 KS-DFT 中总能量必须等于轨道能量之和（这仅对无相互作用粒子成立，或者在哈特里-福克理论中，Koopmans' 定理提供了某种联系，但即便在那里，轨道能量之和也不是总能量）。", "answer": "$$\\boxed{B}$$", "id": "1999063"}]}