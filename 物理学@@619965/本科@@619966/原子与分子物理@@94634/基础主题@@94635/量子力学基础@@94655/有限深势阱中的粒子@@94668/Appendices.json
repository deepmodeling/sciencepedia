{"hands_on_practices": [{"introduction": "掌握有限深势阱的关键一步是理解它与更简单的无限深势阱有何不同。一个常见的错误是假设它们的波函数是相同的。本练习 [@problem_id:2036033] 直接针对这一点，探讨了为什么一个对于无限深势阱完全有效的波函数，对于有限深势阱而言却不是一个物理上可接受的解。通过这个练习，你将巩固对关键边界条件的理解——即波函数 $\\psi(x)$ 及其导数 $\\psi'(x)$ 的连续性，这是量子力学的基石。", "problem": "一名本科生正在研究一个一维量子系统，该系统包含一个质量为 $m$ 的粒子，处于一个对称的有限势阱中。其势能 $V(x)$ 定义如下：\n$$\nV(x) = \\begin{cases} 0 & \\text{for } |x| < a \\\\ V_0 & \\text{for } |x| \\ge a \\end{cases}\n$$\n其中 $V_0$ 是一个正常数。\n\n借鉴其在无限深势阱问题中学到的知识，该学生为这个有限势阱提出了一个可能的能量本征态的波函数：\n$$\n\\psi_{\\text{guess}}(x) = \\begin{cases} C \\sin\\left(\\frac{\\pi x}{a}\\right) & \\text{for } |x| \\le a \\\\ 0 & \\text{for } |x| > a \\end{cases}\n$$\n其中 $C$ 是一个归一化常数。虽然这个函数看起来像一个本征态，但它对于有限势阱问题而言，并不是一个物理上有效的解。\n\n对于一个物理上可接受的波函数，$\\psi_{\\text{guess}}(x)$ 违背了以下哪项基本要求？\n\nA. 波函数必须是可归一化的。\n\nB. 在势能为零的区域，波函数必须是不含时薛定谔方程 (TISE) 的解。\n\nC. 波函数必须处处连续。\n\nD. 在势能为有限值的任意地方，波函数的一阶导数必须是连续的。\n\nE. 与波函数对应的能量本征值必须小于势垒 $V_0$。", "solution": "我们给定一个有限方势阱\n$$\nV(x)=\\begin{cases}\n0 & \\text{for } |x|<a\\\\\nV_{0} & \\text{for } |x|\\ge a\n\\end{cases}\n$$\n以及所提出的波函数\n$$\n\\psi_{\\text{guess}}(x)=\\begin{cases}\nC\\sin\\!\\left(\\frac{\\pi x}{a}\\right) & \\text{for } |x|\\le a\\\\\n0 & \\text{for } |x|>a\n\\end{cases}.\n$$\n一个物理上可接受的一维定态波函数必须满足以下条件：\n- 它必须是可归一化的，即 $\\int_{-\\infty}^{\\infty}|\\psi(x)|^{2}\\,dx<\\infty$。\n- 在每个区域，它都必须满足不含时薛定谔方程 (TISE)：\n$$\n-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}\\psi}{dx^{2}}+V(x)\\psi=E\\psi.\n$$\n- 它必须处处连续。\n- 在 $V(x)$ 为有限值的每一点（等价于没有delta函数那样的奇异点），它的一阶导数必须是连续的。这一点可以通过对TISE在一个点周围的一个小区间上积分得到。\n\n我们现在用每个要求来检验 $\\psi_{\\text{guess}}$。\n\n1) 可归一性：\n由于当 $|x|>a$ 时 $\\psi_{\\text{guess}}(x)=0$，且当 $|x|\\le a$ 时有界，我们有\n$$\n\\int_{-\\infty}^{\\infty}|\\psi_{\\text{guess}}(x)|^{2}\\,dx\n=|C|^{2}\\int_{-a}^{a}\\sin^{2}\\!\\left(\\frac{\\pi x}{a}\\right)\\,dx<\\infty,\n$$\n所以存在一个有限的归一化常数 $C$。因此，可归一性要求得到满足。\n\n2) 在 $V=0$ 的区域 $|x|<a$ 满足TISE：\n对于 $|x|\\le a$，计算\n$$\n\\frac{d^{2}}{dx^{2}}\\left[\\sin\\!\\left(\\frac{\\pi x}{a}\\right)\\right]\n=-\\left(\\frac{\\pi}{a}\\right)^{2}\\sin\\!\\left(\\frac{\\pi x}{a}\\right).\n$$\n因此\n$$\n-\\frac{\\hbar^{2}}{2m}\\psi_{\\text{guess}}''(x)\n=-\\frac{\\hbar^{2}}{2m}\\left[-\\left(\\frac{\\pi}{a}\\right)^{2}\\right]C\\sin\\!\\left(\\frac{\\pi x}{a}\\right)\n=\\frac{\\hbar^{2}\\pi^{2}}{2ma^{2}}\\psi_{\\text{guess}}(x).\n$$\n所以，在区域 $|x|<a$ 内，TISE 得到满足，其能量为\n$$\nE=\\frac{\\hbar^{2}\\pi^{2}}{2ma^{2}}.\n$$\n\n3) 波函数的连续性：\n在边界处取值。在 $x=a$ 处，内部的值是 $C\\sin(\\pi)=0$，外部的值是 $0$，所以 $\\psi$ 在 $x=a$ 处是连续的。类似地，在 $x=-a$ 处，$C\\sin(-\\pi)=0$ 与外部的值 $0$ 相匹配。因此，连续性成立。\n\n4) 在有限势阶处一阶导数的连续性：\n根据 TISE，\n$$\n-\\frac{\\hbar^{2}}{2m}\\psi''+(V-E)\\psi=0\\quad\\Rightarrow\\quad\n\\psi''=\\frac{2m}{\\hbar^{2}}(V-E)\\psi.\n$$\n从 $a-\\epsilon$ 积分到 $a+\\epsilon$：\n$$\n\\psi'(a+\\epsilon)-\\psi'(a-\\epsilon)\n=\\int_{a-\\epsilon}^{a+\\epsilon}\\frac{2m}{\\hbar^{2}}(V-E)\\psi\\,dx.\n$$\n如果 $V$ 是有限的，并且 $\\psi$ 在 $x=a$ 处是有限的，那么被积函数是有界的，当 $\\epsilon\\to 0$ 时，积分趋于 $0$。因此，\n$$\n\\psi'(a^{+})=\\psi'(a^{-}),\n$$\n同样的情况也适用于 $x=-a$。因此，对于有限势阶，$\\psi'$ 在 $x=\\pm a$ 处必须是连续的。\n\n对于 $\\psi_{\\text{guess}}$，\n- 对于 $|x|<a$ 的内部导数：\n$$\n\\psi_{\\text{guess}}'(x)=C\\frac{\\pi}{a}\\cos\\!\\left(\\frac{\\pi x}{a}\\right).\n$$\n因此\n$$\n\\psi_{\\text{guess}}'(a^{-})=C\\frac{\\pi}{a}\\cos(\\pi)=-C\\frac{\\pi}{a},\\quad\n\\psi_{\\text{guess}}'((-a)^{+})=C\\frac{\\pi}{a}\\cos(-\\pi)=-C\\frac{\\pi}{a}.\n$$\n- 对于 $|x|>a$ 的外部，$\\psi_{\\text{guess}}(x)$ 恒等于 $0$，所以\n$$\n\\psi_{\\text{guess}}'(a^{+})=0,\\quad \\psi_{\\text{guess}}'((-a)^{-})=0.\n$$\n因此，在 $x=\\pm a$ 处，一阶导数存在跳变，这违背了在有限势能点 $\\psi'$ 必须连续的要求。\n\n5) 关于条件 $E<V_{0}$：\n对于这个有限势阱中的束缚态，确实要求 $E<V_{0}$。由内部的正弦函数所蕴含的能量是 $E=\\hbar^{2}\\pi^{2}/(2ma^{2})$，这个值是否小于 $V_{0}$ 取决于具体参数；因此，这并非所提出函数中根本的、普遍的违规之处。此外，即使 $E<V_{0}$，导数的不连续性依然存在。\n\n结论：被违背的要求是在势能为有限值的点上，一阶导数必须连续，即选项 D。", "answer": "$$\\boxed{D}$$", "id": "2036033"}, {"introduction": "现实世界中的量子系统很少符合教科书中完美的对称势阱模型。检验你是否真正理解了核心原理的一个有效方法，是将其应用于修正的或不对称的势阱中。本练习 [@problem_id:2036008] 提出了一个不对称势阱的情景——一侧是无限高墙，另一侧是有限的势垒——这可以用来模拟材料表面附近的电子。解决这个问题需要你从第一性原理出发，重新推导量子化条件，从而提高你的分析能力以及将薛定谔方程应用于新物理情境的灵活性。", "problem": "一个质量为 $m$ 的电子被限制在一个一维势 $V(x)$ 中，其定义如下：\n$$\nV(x) = \\begin{cases} \n\\infty & \\text{对于 } x \\le 0 \\\\\n0 & \\text{对于 } 0 < x < L \\\\\nV_0 & \\text{对于 } x \\ge L \n\\end{cases}\n$$\n其中 $L$ 和 $V_0$ 是正常数。这个势可以作为描述材料表面附近电子的一个简化模型，其中一个无限高的势垒阻止电子进入 $x \\le 0$ 的区域。\n\n表征该势阱“强度”的一个关键无量纲参数由 $\\gamma = \\frac{L}{\\hbar}\\sqrt{2mV_0}$ 给出，其中 $\\hbar$ 是约化普朗克常数。该势阱能支持的离散束缚能态数量关键地取决于 $\\gamma$ 的值。\n\n确定能使该势阱恰好支持两个不同束缚能态的 $\\gamma$ 的最小值。将最终答案四舍五入到四位有效数字。", "solution": "对于能量为 $0<E<V_{0}$ 的束缚态，在每个区域写出不含时薛定谔方程。在 $V(x)=0$ 的 $0<x<L$ 区域，通解为\n$$\n\\psi_{I}(x)=A\\sin(kx)+B\\cos(kx), \\quad k=\\frac{\\sqrt{2mE}}{\\hbar}.\n$$\n$x=0$ 处的无限高势垒要求 $\\psi(0)=0$，因此 $B=0$ 且\n$$\n\\psi_{I}(x)=A\\sin(kx).\n$$\n对于 $V(x)=V_{0}$ 且 $E<V_{0}$ 的 $x\\geq L$ 区域，衰减解为\n$$\n\\psi_{II}(x)=C\\exp\\!\\big[-\\kappa(x-L)\\big], \\quad \\kappa=\\frac{\\sqrt{2m(V_{0}-E)}}{\\hbar}.\n$$\n$\\psi$ 和 $\\psi'$ 在 $x=L$ 处的连续性条件给出\n$$\nA\\sin(kL)=C, \\quad Ak\\cos(kL)=-\\kappa C.\n$$\n消去 $A$ 和 $C$ 得到量子化条件\n$$\nk\\cot(kL)=-\\kappa.\n$$\n引入无量纲变量 $z=kL$ 和 $t=\\kappa L$。使用 $k^{2}+\\kappa^{2}=\\frac{2mV_{0}}{\\hbar^{2}}$ 以及 $\\gamma=\\frac{L}{\\hbar}\\sqrt{2mV_{0}}$ 的定义，我们得到\n$$\nz^{2}+t^{2}=\\gamma^{2},\n$$\n以及\n$$\nt=-z\\cot z.\n$$\n因此，束缚态对应于以下方程的解 $z$\n$$\n\\gamma^{2}=z^{2}+\\big(z\\cot z\\big)^{2},\n$$\n并满足约束条件 $\\kappa>0\\Rightarrow -\\cot z>0$，即对于 $n=1,2,\\dots$，$z$ 位于区间 $z\\in\\big((2n-1)\\frac{\\pi}{2},\\,n\\pi\\big)$ 内。\n\n对于给定的分支 $n$，允许存在解的最小 $\\gamma$ 值出现在 $\\kappa\\to 0^{+}$（即 $t\\to 0^{+}$）的极限情况下，这对应于 $E\\to V_{0}^{-}$。根据 $t=-z\\cot z$，这要求 $\\cot z\\to 0$，因此\n$$\nz\\to \\left(2n-1\\right)\\frac{\\pi}{2}.\n$$\n在这个阈值上，\n$$\n\\gamma_{\\min,n}=\\sqrt{z^{2}+t^{2}}=\\left(2n-1\\right)\\frac{\\pi}{2}.\n$$\n因此，第 $n$ 个束缚态存在的充分必要条件是 $\\gamma>\\left(2n-1\\right)\\frac{\\pi}{2}$。该势阱恰好支持两个束缚态的条件是 $\\gamma$ 超过第二个阈值但未超过第三个阈值，即对于 $\\gamma \\in \\left(\\frac{3\\pi}{2},\\,\\frac{5\\pi}{2}\\right)$。能使该势阱恰好存在两个束缚态的最小 $\\gamma$ 值是第二个态出现时的临界值：\n$$\n\\gamma_{\\text{min for two states}}=\\frac{3\\pi}{2}.\n$$\n四舍五入到四位有效数字得到 $4.712$。", "answer": "$$\\boxed{4.712}$$", "id": "2036008"}, {"introduction": "有限深势阱问题中一个具有挑战性又引人入胜的方面是，其能量量子化条件是超越方程，没有简单的封闭解。那么我们如何找到实际的能级呢？本练习 [@problem_id:2434189] 将引导你从纯理论过渡到实际应用，使用数值方法求解束缚态能量。这个练习不仅为特定的物理参数提供了具体的答案，还向你介绍了计算物理中用于解决那些无法解析求解问题的基本技术。", "problem": "给定一个一维对称有限深度方势阱，其定义为\n$$\nV(x) = \\begin{cases}\n- V_0, & |x| \\le a,\\\\\n0, & |x| > a,\n\\end{cases}\n$$\n其中 $V_0 > 0$ 是势阱深度，$a > 0$ 是势阱半宽。一个质量为 $m$ 的非相对论量子粒子，其束缚态能量本征值 $E$ 满足 $-V_0 < E < 0$。对于这样的 $E$，定义内部波数 $k$ 和外部衰减常数 $\\kappa$ 为\n$$\nk = \\frac{\\sqrt{2 m (E + V_0)}}{\\hbar}, \\quad \\kappa = \\frac{\\sqrt{2 m (-E)}}{\\hbar}.\n$$\n通过在 $x = \\pm a$ 处施加波函数的连续性和可微性条件，能量本征值 $E$ 可由以下超越方程确定\n$$\n\\text{偶宇称:}\\quad k \\tan(k a) = \\kappa,\n$$\n$$\n\\text{奇宇称:}\\quad -k \\cot(k a) = \\kappa.\n$$\n引入无量纲变量 $x = k a$ 和 $\\zeta = a \\sqrt{2 m V_0} / \\hbar$。这样，上述方程可以重写为\n$$\n\\text{偶:}\\quad x \\tan(x) = \\sqrt{\\zeta^2 - x^2}, \\quad \\text{for } x \\in \\big( m \\pi,\\, m \\pi + \\tfrac{\\pi}{2} \\big), \\, m \\in \\mathbb{Z}_{\\ge 0}, \\, x < \\zeta,\n$$\n$$\n\\text{奇:}\\quad -x \\cot(x) = \\sqrt{\\zeta^2 - x^2}, \\quad \\text{for } x \\in \\big( m \\pi + \\tfrac{\\pi}{2},\\, (m + 1) \\pi \\big), \\, m \\in \\mathbb{Z}_{\\ge 0}, \\, x < \\zeta,\n$$\n其中所有三角函数参数均为弧度制。每个允许的解 $x$ 对应一个束缚态能量\n$$\nE = \\frac{\\hbar^2}{2 m a^2} x^2 - V_0,\n$$\n根据构造，该能量必须满足 $-V_0 < E < 0$。\n\n常数与单位：\n- 使用约化普朗克常数 $\\hbar = 1.054571817 \\times 10^{-34}\\,\\text{J}\\cdot\\text{s}$。\n- 使用元电荷 $q_e = 1.602176634 \\times 10^{-19}\\,\\text{C}$ 进行焦耳和电子伏特之间的转换：$1\\,\\text{eV} = q_e\\,\\text{J}$。\n- 所有输入的长度单位为米；所有质量单位为千克；最终输出的所有能量必须以电子伏特 (eV) 表示。\n- 所有三角函数的参数都必须解释为弧度。\n\n任务：\n对于下面测试套件中的每一组参数，确定满足上述超越方程的所有束缚态能量本征值 $E$，并以电子伏特为单位，作为四舍五入到 $6$ 位小数的浮点数报告。按升序报告能量（即从最负到最不负）。如果没有束缚态，则在该情况下报告一个空列表。\n\n测试套件（每个案例是一个三元组 $(m, V_0, a)$）：\n- 案例 $1$：$m = m_e$，$V_0 = 10.0\\,\\text{eV}$，$a = 0.5 \\times 10^{-9}\\,\\text{m}$，\n- 案例 $2$：$m = 0.067\\, m_e$，$V_0 = 0.3\\,\\text{eV}$，$a = 5.0 \\times 10^{-9}\\,\\text{m}$，\n- 案例 $3$：$m = m_e$，$V_0 = 2.0\\,\\text{eV}$，$a = 0.2 \\times 10^{-9}\\,\\text{m}$，\n\n其中 $m_e = 9.1093837015 \\times 10^{-31}\\,\\text{kg}$ 是电子静止质量。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素本身是对应测试案例的束缚态能量（单位为电子伏特）的方括号逗号分隔列表，四舍五入到 $6$ 位小数。例如，一个有效的结构格式是\n$$\n\\big[ [E_{1,1}, E_{1,2}, \\dots], [E_{2,1}, \\dots], [E_{3,1}, \\dots] \\big],\n$$\n并且必须打印确切的输出，不带任何空格或解释性文本，例如\n$$\n[[E_{1,1},E_{1,2}],[E_{2,1},E_{2,2},E_{2,3}],[E_{3,1}]].\n$$", "solution": "所呈现的问题是量子力学中的一个标准练习：确定一维有限深度方势阱中粒子的束缚态能量本征值。该任务在科学上是合理的、定义明确的，并且提供了所有必要的物理常数和参数。其表述是自洽的，在数学上是一致的。因此，该问题是有效的，并将提供一个解决方案。\n\n问题的核心是求解两个超越方程，这些方程是通过将边界条件应用于不含时薛定谔方程的解而得到的。这些方程分别描述了偶宇称和奇宇称态的允许能量。\n\n势能由下式给出\n$$\nV(x) = \\begin{cases}\n-V_0, & |x| \\le a \\\\\n0, & |x| > a\n\\end{cases}\n$$\n对于一个质量为 $m$ 的粒子，其中 $V_0 > 0$ 且 $a > 0$。对于束缚态，能量 $E$ 必须在范围 $-V_0 < E < 0$ 内。\n\n通过引入无量纲变量 $x = ka$ 和 $\\zeta = a \\sqrt{2 m V_0} / \\hbar$，分析过程得以大大简化，其中 $k = \\sqrt{2m(E+V_0)}/\\hbar$ 是阱内的波数。参数 $\\zeta$ 代表势阱的“强度”，它结合了势阱深度 $V_0$ 和半宽 $a$。使用这些变量，超越方程变为：\n$$\n\\text{偶宇称态:}\\quad x \\tan(x) = \\sqrt{\\zeta^2 - x^2}\n$$\n$$\n\\text{奇宇称态:}\\quad -x \\cot(x) = \\sqrt{\\zeta^2 - x^2}\n$$\n能量约束 $-V_0 < E < 0$ 转化为条件 $0 < x < \\zeta$。每个解 $x$ 对应一个唯一的能量本征值，由下式给出：\n$$\nE = \\frac{\\hbar^2 x^2}{2 m a^2} - V_0\n$$\n我们的任务是为每组给定的参数 $(m, V_0, a)$ 找到所有的解 $x$，然后计算相应的能量 $E$。\n\n解决这个问题的算法步骤如下：\n\n1.  **参数计算**：对于每个测试用例，我们首先计算无量纲的势阱强度 $\\zeta$。所有输入参数（$m, V_0, a$）和物理常数（$\\hbar, q_e, m_e$）在计算前必须转换为一个一致的单位制，即国际单位制（SI）。以电子伏特（eV）给出的势阱深度 $V_0$ 需要使用元电荷 $q_e$ 转换为焦耳（J）。\n\n2.  **求根策略**：$x$ 的解是函数 $f_e(x) = x \\tan(x) - \\sqrt{\\zeta^2 - x^2}$ 和 $f_o(x) = -x \\cot(x) - \\sqrt{\\zeta^2 - x^2}$ 的根。图形分析表明，解是有序的，且位于不同的区间内。第 $n$ 个能态（$n=1$ 为基态）对应的无量纲波数 $x_n$ 位于区间 $((n-1)\\pi/2, n\\pi/2)$ 内。\n    - 奇数索引 $n = 1, 3, 5, \\dots$ 的态是偶宇称态，是 $f_e(x) = 0$ 的解。\n    - 偶数索引 $n = 2, 4, 6, \\dots$ 的态是奇宇称态，是 $f_o(x) = 0$ 的解。\n\n    我们可以通过迭代态索引 $n=1, 2, 3, \\ldots$ 并在适当的区间内搜索根来系统地找到所有根，只要区间的起点 $(n-1)\\pi/2$ 小于 $\\zeta$。对根 $x$ 的搜索被限制在范围 $[(n-1)\\pi/2, \\min(n\\pi/2, \\zeta)]$ 内。\n\n3.  **数值方法**：需要一个稳健的数值求根算法。Brent-Dekker 方法（在 SciPy 中可用作 `brentq`）是一个绝佳的选择。它是一种混合的区间法，如果搜索区间端点的函数值符号相反，它能保证收敛。\n    - 对于偶宇称态，函数 $f_e(x)$ 在区间 $(m\\pi, m\\pi+\\pi/2)$ 上从负变到正，其中 $m = (n-1)/2$。\n    - 对于奇宇称态，函数 $f_o(x)$ 在区间 $(m\\pi+\\pi/2, (m+1)\\pi)$ 上从负变到正，其中 $m=(n-2)/2$。\n    这个符号变化的特性确保了 `brentq` 方法的可靠性。为避免在区间边界处出现 $\\tan(x)$ 和 $\\cot(x)$ 的奇点，搜索区间被略微收缩，例如，收缩一个很小的量 $\\epsilon$。\n\n4.  **能量计算与最终处理**：对于找到的每个根 $x_n$，使用前面导出的公式以焦耳为单位计算相应的能量 $E_n$。然后将该能量除以 $q_e$ 转换为电子伏特。每个测试用例得到的结果能量按升序排序（这在按递增的 $n$ 查找根 $x_n$ 时自然产生），并按要求四舍五入到 $6$ 位小数。最终输出被格式化为列表的列表。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Finds the bound-state energy eigenvalues for a 1D finite square well.\n    \"\"\"\n    # Physical constants in SI units\n    hbar = 1.054571817e-34  # Reduced Planck constant (J*s)\n    m_e = 9.1093837015e-31   # Electron rest mass (kg)\n    q_e = 1.602176634e-19    # Elementary charge (C)\n\n    test_cases = [\n        # Case 1: (m, V0, a)\n        (m_e, 10.0, 0.5e-9),\n        # Case 2: (m, V0, a)\n        (0.067 * m_e, 0.3, 5.0e-9),\n        # Case 3: (m, V0, a)\n        (m_e, 2.0, 0.2e-9),\n    ]\n\n    all_results = []\n    for m, V0_eV, a in test_cases:\n        energies = find_bound_state_energies(m, V0_eV, a, hbar, q_e)\n        all_results.append(energies)\n\n    # Format the final output string as per problem specification\n    results_str = []\n    for res_list in all_results:\n        formatted_list = [f\"{e:.6f}\" for e in res_list]\n        results_str.append(f\"[{','.join(formatted_list)}]\")\n    final_output = f\"[{','.join(results_str)}]\"\n    print(final_output)\n\ndef find_bound_state_energies(m, V0_eV, a, hbar, q_e):\n    \"\"\"\n    Calculates all bound state energies for a given set of parameters.\n    \"\"\"\n    if V0_eV <= 0:\n        return []\n\n    V0_J = V0_eV * q_e\n    \n    # Calculate the dimensionless well strength parameter zeta\n    zeta = (a * np.sqrt(2 * m * V0_J)) / hbar\n\n    solutions_x = []\n    n = 1\n    epsilon = 1e-12  # Small offset to avoid singularities\n\n    while True:\n        lower_bound = (n - 1) * np.pi / 2\n        upper_bound = n * np.pi / 2\n\n        if lower_bound >= zeta:\n            break\n\n        # Define search bracket, ensuring it's within [0, zeta] and avoids singularities\n        bracket_start = lower_bound + epsilon\n        bracket_end = min(upper_bound - epsilon, zeta - epsilon)\n\n        if bracket_start >= bracket_end:\n            # If the search interval is invalid or too small, stop for this n\n            # This can happen if upper_bound is very close to or less than lower_bound\n            # or if zeta is reached.\n            n += 1\n            if bracket_end < zeta - epsilon: # Case where upper_bound is reached earlier\n                continue\n            else: # Case where zeta limit is reached\n                break\n\n        try:\n            if n % 2 == 1:  # Even parity states (n=1, 3, 5, ...)\n                # Equation: x * tan(x) - sqrt(zeta^2 - x^2) = 0\n                func = lambda x: x * np.tan(x) - np.sqrt(zeta**2 - x**2)\n                sol = root_scalar(func, bracket=[bracket_start, bracket_end], method='brentq')\n                if sol.converged:\n                    solutions_x.append(sol.root)\n            else:  # Odd parity states (n=2, 4, 6, ...)\n                # Equation: -x * cot(x) - sqrt(zeta^2 - x^2) = 0\n                # Use cot(x) = 1/tan(x)\n                # This check ensures we don't divide by zero near multiples of pi,\n                # which are avoided by the epsilon-contracted bracket.\n                func = lambda x: -x / np.tan(x) - np.sqrt(zeta**2 - x**2)\n                sol = root_scalar(func, bracket=[bracket_start, bracket_end], method='brentq')\n                if sol.converged:\n                    solutions_x.append(sol.root)\n        except ValueError:\n            # This can happen if the function does not cross zero in the bracket,\n            # which might occur at the last possible state near x=zeta.\n            # We can check this scenario manually.\n            h_start = func(bracket_start)\n            h_end = func(bracket_end)\n            if h_start * h_end > 0:\n                # No root in this interval, and since it's the last one, we're done.\n                pass\n            else:\n                 # Another issue occurred; for this problem we can assume it means no more roots\n                 pass\n        \n        n += 1\n\n    # Calculate energies from solutions x\n    energies_eV = []\n    if solutions_x:\n        # Precompute the energy conversion constant\n        energy_const = hbar**2 / (2 * m * a**2 * q_e)\n        for x_sol in solutions_x:\n            E = energy_const * x_sol**2 - V0_eV\n            energies_eV.append(E)\n\n    # Energies are naturally sorted as x is found in increasing order.\n    # We round them as the final step.\n    return [round(e, 6) for e in energies_eV]\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "2434189"}]}