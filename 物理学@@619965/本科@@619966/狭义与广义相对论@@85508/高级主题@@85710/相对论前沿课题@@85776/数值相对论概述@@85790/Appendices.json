{"hands_on_practices": [{"introduction": "在数值相对论中，模拟像双黑洞合并这样的事件面临着一个巨大的挑战：尺度差异。引力波需要在远离源的广阔空间中被精确测量，而黑洞本身及其周围的强引力场则需要在极小的尺度上被解析。这个练习将通过一个简化的模型，让你亲手计算并体会自适应网格加密（AMR）技术相比于均匀网格，在计算资源上带来的巨大优势。[@problem_id:1814393]", "problem": "广义相对论中的数值模拟，特别是涉及双黑洞并合的模拟，必须处理发生在巨大差异长度尺度上的物理现象。计算网格必须足够精细，以解析黑洞附近的强引力场，同时又必须足够大，以覆盖整个系统并在远场提取向外传播的引力波。这构成了一个巨大的计算挑战。\n\n为了分析这个问题，我们考虑一个双星系统三维模拟的简化模型。该模拟在一个边长为 $L$ 的巨大立方计算区域内进行。在整个模拟过程中必须解析的最小动力学重要特征尺寸为 $\\delta$。\n\n我们将比较两种不同的策略来对该区域进行离散化：\n\n1.  **均匀网格 (Uniform Grid)：**一个直接的方法是使用覆盖整个区域的单一、均匀的立方网格。为了在所有地方都能解析最小特征尺寸 $\\delta$，在整个边长为 $L$ 的区域内，网格间距必须设置为 $\\Delta x = \\delta$。设此情况下网格单元的总数为 $N_{unif}$。\n\n2.  **自适应网格加密 (AMR) 网格 (Adaptive Mesh Refinement (AMR) Grid)：**一种更精妙的方法是自适应网格加密 (AMR)，它使用具有不同分辨率的嵌套网格层次结构。考虑一个具有三个加密层级的设置：\n    *   **第0层 (Level 0)：**一个间距为 $\\Delta x_0$ 的粗糙基础网格，覆盖整个边长为 $L$ 的区域。\n    *   **第1层 (Level 1)：**一个间距为 $\\Delta x_1$ 的中等精度立方网格，覆盖位于区域中心、边长为 $L/C_1$ 的较小区域。\n    *   **第2层 (Level 2)：**一个间距为 $\\Delta x_2$ 的精细立方网格，覆盖黑洞所在的、边长为 $L/C_2$ 的最内层区域。\n\n    相邻层级之间的网格间距通过一个恒定的加密因子 $r$ 相关联，使得 $\\Delta x_{k+1} = \\Delta x_k / r$。最精细的网格必须能解析最小的物理尺度，因此我们设置 $\\Delta x_2 = \\delta$。就本问题而言，假设 AMR 网格中的网格单元总数 $N_{AMR}$ 是三个独立网格层级上单元数量的总和。\n\n给定无量纲参数 $r=2$、$C_1=4$ 和 $C_2=32$，计算比率 $N_{unif} / N_{AMR}$。与均匀网格相比，该比率代表了通过使用这种特定的 AMR 策略所减少的计算单元总数的倍数。将最终答案四舍五入至三位有效数字。", "solution": "我们需要计算每种策略下三维网格单元的总数。\n\n均匀网格：\n为了在所有地方都能解析最小特征尺寸，设置 $\\Delta x=\\delta$。每条边上的单元数量为 $L/\\delta$，因此单元总数为\n$$\nN_{unif}=\\left(\\frac{L}{\\delta}\\right)^{3}.\n$$\n\nAMR网格：\n加密关系为 $\\Delta x_{k+1}=\\Delta x_{k}/r$，且有 $\\Delta x_{2}=\\delta$。因此\n$$\n\\Delta x_{1}=r\\,\\delta,\\qquad \\Delta x_{0}=r^{2}\\delta.\n$$\n每个层级的单元数量是该区域边长除以该层级网格间距，然后取立方：\n$$\nN_{0}=\\left(\\frac{L}{\\Delta x_{0}}\\right)^{3}=\\left(\\frac{L}{r^{2}\\delta}\\right)^{3}=r^{-6}\\left(\\frac{L}{\\delta}\\right)^{3},\n$$\n$$\nN_{1}=\\left(\\frac{L/C_{1}}{\\Delta x_{1}}\\right)^{3}=\\left(\\frac{L}{C_{1}r\\delta}\\right)^{3}=C_{1}^{-3}r^{-3}\\left(\\frac{L}{\\delta}\\right)^{3},\n$$\n$$\nN_{2}=\\left(\\frac{L/C_{2}}{\\Delta x_{2}}\\right)^{3}=\\left(\\frac{L}{C_{2}\\delta}\\right)^{3}=C_{2}^{-3}\\left(\\frac{L}{\\delta}\\right)^{3}.\n$$\n将各层级的单元数相加（如题中所述），\n$$\nN_{AMR}=N_{0}+N_{1}+N_{2}=\\left[r^{-6}+C_{1}^{-3}r^{-3}+C_{2}^{-3}\\right]\\left(\\frac{L}{\\delta}\\right)^{3}.\n$$\n因此，比率为\n$$\n\\frac{N_{unif}}{N_{AMR}}=\\frac{\\left(L/\\delta\\right)^{3}}{\\left[r^{-6}+C_{1}^{-3}r^{-3}+C_{2}^{-3}\\right]\\left(L/\\delta\\right)^{3}}=\\frac{1}{r^{-6}+C_{1}^{-3}r^{-3}+C_{2}^{-3}}.\n$$\n代入 $r=2$，$C_{1}=4$，$C_{2}=32$，\n$$\nr^{-6}=\\frac{1}{64},\\quad C_{1}^{-3}r^{-3}=\\frac{1}{64}\\cdot\\frac{1}{8}=\\frac{1}{512},\\quad C_{2}^{-3}=\\frac{1}{32768},\n$$\n那么\n$$\n\\frac{N_{unif}}{N_{AMR}}=\\frac{1}{\\frac{1}{64}+\\frac{1}{512}+\\frac{1}{32768}}=\\frac{1}{\\frac{577}{32768}}=\\frac{32768}{577}\\approx 56.790\\ldots\n$$\n四舍五入到三位有效数字，该比率为 $56.8$。", "answer": "$$\\boxed{56.8}$$", "id": "1814393"}, {"introduction": "爱因斯坦方程组不仅包含描述时空演化的方程，还包含一组必须始终满足的约束方程。在数值模拟中，微小的计算误差会累积，导致解偏离这些物理约束，造成模拟不稳定甚至崩溃。这个练习通过一个简化的玩具模型，让你推导并理解“约束阻尼”这一关键技术是如何像一个“修正力”一样，主动地将这些违背约束的误差从系统中清除出去的。[@problem_id:1814401]", "problem": "在数值相对论中，爱因斯坦场方程通常被转化为一个描述几何量时间演化的一阶偏微分方程组。这些方程的一个关键特征是存在约束方程，例如哈密顿约束和动量约束，它们必须在所有时刻都得到满足。然而，数值方法会引入误差，导致解偏离这些约束为零的“约束面”。这种现象被称为约束违背。\n\n为了解决这个问题，现代演化格式通常会引入“约束阻尼”项。这些是对演化方程的精心选择的附加项，旨在主动将约束违背驱动回零。\n\n考虑一个模拟这种行为的简化一维玩具模型。该系统由三个场描述：$\\phi(x,t)$、$\\Pi(x,t)$ 和一个辅助场 $K(x,t)$。此模型中的“约束”定义为量 $C(x,t) = K(x,t) - \\frac{\\partial \\phi}{\\partial x}(x,t)$。对于一个物理上的精确解，这个约束必须在所有时间和空间上都为零。\n\n为保证稳定性，场的演化方程通过阻尼项修改如下：\n1.  $\\frac{\\partial \\phi}{\\partial t} = \\Pi + \\alpha C$\n2.  $\\frac{\\partial \\Pi}{\\partial t} = \\frac{\\partial K}{\\partial x}$\n3.  $\\frac{\\partial K}{\\partial t} = \\frac{\\partial \\Pi}{\\partial x} - \\beta C$\n\n这里，$\\alpha$ 和 $\\beta$ 是正常数，分别代表约束的阻尼强度和传播。\n\n假设在时间 $t=0$ 时，一个微小的、局域的数值误差导致了一个由高斯分布给出的初始约束违背：\n$$C(x,0) = C_0 \\exp\\left(-\\frac{x^2}{w^2}\\right)$$\n其中 $C_0$ 是违背的初始振幅，$w$ 是其特征宽度。\n\n推导在所有后续时间 $t > 0$ 下，约束违背 $C(x,t)$ 的解析表达式。", "solution": "我们从约束的定义 $C(x,t) = K(x,t) - \\frac{\\partial \\phi}{\\partial x}(x,t)$ 开始。对其关于时间求导，并使用给定的演化方程，得到一个关于 $C$ 的封闭方程。\n\n计算时间导数：\n$$\n\\frac{\\partial C}{\\partial t} = \\frac{\\partial K}{\\partial t} - \\frac{\\partial}{\\partial t}\\left(\\frac{\\partial \\phi}{\\partial x}\\right).\n$$\n代入演化方程 $\\frac{\\partial K}{\\partial t} = \\frac{\\partial \\Pi}{\\partial x} - \\beta C$ 和 $\\frac{\\partial \\phi}{\\partial t} = \\Pi + \\alpha C$：\n$$\n\\frac{\\partial C}{\\partial t} = \\left(\\frac{\\partial \\Pi}{\\partial x} - \\beta C\\right) - \\frac{\\partial}{\\partial x}\\left(\\Pi + \\alpha C\\right).\n$$\n展开空间导数：\n$$\n\\frac{\\partial C}{\\partial t} = \\frac{\\partial \\Pi}{\\partial x} - \\beta C - \\frac{\\partial \\Pi}{\\partial x} - \\alpha \\frac{\\partial C}{\\partial x}.\n$$\n消去 $\\frac{\\partial \\Pi}{\\partial x}$ 项，得到线性一阶偏微分方程：\n$$\n\\frac{\\partial C}{\\partial t} + \\alpha \\frac{\\partial C}{\\partial x} = -\\beta C.\n$$\n\n用特征线法求解该方程。沿着由下式定义的特征曲线\n$$\n\\frac{d x}{d t} = \\alpha,\n$$\n约束满足常微分方程\n$$\n\\frac{d C}{d t} = -\\beta C.\n$$\n对特征方程积分得到 $x(t) = x_{0} + \\alpha t$ 和\n$$\nC(x(t),t) = C(x_{0},0)\\exp\\left(-\\beta t\\right).\n$$\n使用 $x_{0} = x - \\alpha t$ 消去 $x_{0}$，写出通解：\n$$\nC(x,t) = \\exp\\left(-\\beta t\\right) C(x - \\alpha t,0).\n$$\n\n应用给定的初始条件 $C(x,0) = C_{0} \\exp\\left(-\\frac{x^{2}}{w^{2}}\\right)$ 来确定\n$$\nC(x,t) = C_{0} \\exp\\left(-\\beta t\\right) \\exp\\left(-\\frac{(x - \\alpha t)^{2}}{w^{2}}\\right).\n$$\n该表达式表明，初始的高斯型约束违背以速度 $\\alpha$ 平流，并以速率 $\\beta$ 阻尼，在所有 $t > 0$ 的时间内保持其高斯形状和宽度 $w$。", "answer": "$$\\boxed{C_{0}\\,\\exp\\left(-\\beta t\\right)\\,\\exp\\left(-\\frac{(x-\\alpha t)^{2}}{w^{2}}\\right)}$$", "id": "1814401"}, {"introduction": "当模拟中可能形成黑洞时，一个核心任务就是确定黑洞的边界。在动态变化的时空中，我们使用“视界”（apparent horizon）这个概念来追踪黑洞的表面。这个练习将向你展示“视界搜寻器”算法的基本原理：通过寻找一个向外的光线膨胀率为零的球面，从而定位黑洞。[@problem_id:1814403]", "problem": "在一个塌缩星的数值相对论模拟中，使用了一个简化模型来描述特定时间切片上的时空。在此模型中，从坐标半径为 $r$ 的测试球面出射的光线的膨胀 $\\theta$ 由下列表达式近似给出：\n$$\n\\theta(r) = \\frac{2}{r}\\left(1 - \\frac{M}{r}\\right) - K\n$$\n此处，$M$ 是一个与塌缩核心质量相关的正参数，$K$ 是一个与时空几何动力学相关的正常数。视界（apparent horizon）是一个球状表面，在该表面上，这些出射光线的膨胀为零。在数值模拟中，“视界搜寻器”是一种搜寻此类表面半径 $r_{AH}$ 的算法。\n\n基于此模型，下列哪个表达式给出了视界的半径 $r_{AH}$？你可以假设参数 $M$ 和 $K$ 的取值保证了半径至少存在一个实数正解。\n\nA. $r_{AH} = \\frac{1 \\pm \\sqrt{1 - 2 K M}}{K}$\n\nB. $r_{AH} = \\frac{1 + \\sqrt{1 + 2 K M}}{K}$\n\nC. $r_{AH} = M$\n\nD. $r_{AH} = \\frac{2}{K}$\n\nE. $r_{AH} = \\frac{1 \\pm \\sqrt{1 - 4 K M}}{2K}$", "solution": "视界被定义为出射光线膨胀为零的表面，因此我们令 $\\theta(r)=0$。给定\n$$\n\\theta(r)=\\frac{2}{r}\\left(1-\\frac{M}{r}\\right)-K,\n$$\n视界半径 $r_{AH}$ 满足\n$$\n\\frac{2}{r}\\left(1-\\frac{M}{r}\\right)-K=0.\n$$\n两边同时加上 $K$：\n$$\n\\frac{2}{r}\\left(1-\\frac{M}{r}\\right)=K.\n$$\n两边同时乘以 $r^{2}$（对于 $r>0$ 有效）：\n$$\n2r-2M=Kr^{2}.\n$$\n整理成关于 $r$ 的标准一元二次方程形式：\n$$\nKr^{2}-2r+2M=0.\n$$\n应用二次方程求根公式，其中 $a=K$，$b=-2$，$c=2M$：\n$$\nr=\\frac{2\\pm\\sqrt{(-2)^{2}-4K(2M)}}{2K}=\\frac{2\\pm\\sqrt{4-8KM}}{2K}=\\frac{1\\pm\\sqrt{1-2KM}}{K}.\n$$\n假设参数能得到至少一个实数正解，这对应于判别式条件 $1-2KM\\geq 0$。最终得到的表达式与选项 A 匹配。", "answer": "$$\\boxed{A}$$", "id": "1814403"}]}