{"hands_on_practices": [{"introduction": "计算电磁学的核心在于求解偏微分方程，而有限差分法（Finite Difference Method）是最直观的方法之一。它将连续的物理场和控制方程离散化为一系列网格点上的代数值。本练习将引导你将一个连续的物理问题——二维泊松方程——转化为一个可解的线性方程组，这是掌握基于网格的数值方法的基础。[@problem_id:1802423]", "problem": "一块特殊的半导体材料方形薄板占据了由 $0 \\le x \\le 0.3 \\text{ m}$ 和 $0 \\le y \\le 0.3 \\text{ m}$ 定义的二维区域。材料内部的静电势 $V(x,y)$ 遵循泊松方程 $\\nabla^2 V = -\\rho(x,y) / \\epsilon$，其中 $\\rho(x,y)$ 是随空间变化的电荷密度，$\\epsilon$ 是材料的电容率。由于非均匀的掺杂分布，电荷密度与电容率之比由函数 $\\rho(x,y)/\\epsilon = Kxy$ 给出，其中常数 $K = 400.0 \\text{ V/m}^4$。在板的所有四个外边缘上，电势保持恒定为 $V=0 \\text{ V}$。\n\n为了分析电势分布，该区域在 $x$ 和 $y$ 方向上被离散化为一个间距为 $h=0.1 \\text{ m}$ 的均匀网格。因此，网格点位于坐标 $(ih, jh)$ 处，其中整数 $i, j$ 的取值范围为0到3。\n\n使用导数的二阶有限差分近似，计算位置 $(x,y) = (0.2 \\text{ m}, 0.2 \\text{ m})$ 处的静电势。答案以伏特(V)为单位，并四舍五入到三位有效数字。", "solution": "给定的是具有狄利克雷边界条件的二维泊松方程：\n$$\n\\nabla^{2} V(x,y) = -\\frac{\\rho(x,y)}{\\epsilon} = -Kxy,\n$$\n在方形区域 $0 \\leq x \\leq 0.3$ 和 $0 \\leq y \\leq 0.3$ 上，四个边界上 $V=0$。该区域用网格间距 $h=0.1$ 进行离散化，因此网格点为 $(x_{i},y_{j})=(ih,jh)$，其中 $i,j \\in \\{0,1,2,3\\}$。内部的未知数位于 $(i,j)\\in\\{(1,1),(1,2),(2,1),(2,2)\\}$，对应于 $(0.1,0.1)$、$(0.1,0.2)$、$(0.2,0.1)$、$(0.2,0.2)$。\n使用标准的五点、二阶有限差分格式，\n$$\n\\frac{V_{i+1,j}+V_{i-1,j}+V_{i,j+1}+V_{i,j-1}-4V_{i,j}}{h^{2}}=-K x_{i} y_{j},\n$$\n或等价地，\n$$\nV_{i+1,j}+V_{i-1,j}+V_{i,j+1}+V_{i,j-1}-4V_{i,j}=-K x_{i} y_{j} h^{2}.\n$$\n设 $a=V_{1,1}$，$b=V_{1,2}$，$c=V_{2,1}$ 和 $d=V_{2,2}$。边界值为零。当 $h=0.1$ 时，我们有 $h^{2}=0.01$。对于每个内部节点：\n- 在点 $(1,1)$ 处：$x_{1}y_{1}=(0.1)(0.1)=0.01$，所以\n$$\nc+b-4a=-K(0.01)(0.01)=-0.0001\\,K.\n$$\n- 在点 $(2,1)$ 处：$x_{2}y_{1}=(0.2)(0.1)=0.02$，所以\n$$\na+d-4c=-K(0.02)(0.01)=-0.0002\\,K.\n$$\n- 在点 $(1,2)$ 处：$x_{1}y_{2}=(0.1)(0.2)=0.02$，所以\n$$\na+d-4b=-0.0002\\,K.\n$$\n- 在点 $(2,2)$ 处：$x_{2}y_{2}=(0.2)(0.2)=0.04$，所以\n$$\nb+c-4d=-K(0.04)(0.01)=-0.0004\\,K.\n$$\n为简洁起见，定义 $s=0.0001\\,K$。该方程组变为\n$$\n\\begin{aligned}\n&c+b-4a=-s,\\\\\n&a+d-4c=-2s,\\\\\n&a+d-4b=-2s,\\\\\n&b+c-4d=-4s.\n\\end{aligned}\n$$\n从第二个和第三个方程可知，$a+d-4c=a+d-4b$ 意味着 $b=c$。设 $t=b=c$。那么第一个方程给出\n$$\n2t-4a=-s \\quad \\Rightarrow \\quad t=2a-\\frac{s}{2}.\n$$\n第四个方程给出\n$$\n2t-4d=-4s \\quad \\Rightarrow \\quad t=2d-2s.\n$$\n令这两个关于 $t$ 的表达式相等，\n$$\n2a-\\frac{s}{2}=2d-2s \\quad \\Rightarrow \\quad d=a+\\frac{3}{4}s.\n$$\n使用 $t=2a-\\frac{s}{2}$ 和第二个方程 $a+d-4t=-2s$：\n$$\na+d-4\\left(2a-\\frac{s}{2}\\right)=-2s \\quad \\Rightarrow \\quad a+d-8a+2s=-2s,\n$$\n$$\n-7a+d=-4s \\quad \\Rightarrow \\quad d=7a-4s.\n$$\n令这两个关于 $d$ 的表达式相等，\n$$\n7a-4s=a+\\frac{3}{4}s \\quad \\Rightarrow \\quad 6a=\\frac{19}{4}s \\quad \\Rightarrow \\quad a=\\frac{19}{24}s.\n$$\n那么\n$$\nd=a+\\frac{3}{4}s=\\frac{19}{24}s+\\frac{18}{24}s=\\frac{37}{24}s,\n$$\n且\n$$\nb=c=t=2a-\\frac{s}{2}=2\\cdot\\frac{19}{24}s-\\frac{1}{2}s=\\frac{38}{24}s-\\frac{12}{24}s=\\frac{26}{24}s=\\frac{13}{12}s.\n$$\n当 $K=400.0$ 时，我们有 $s=0.0001\\times 400.0=0.04$。因此，\n$$\nV(0.2,0.2)=d=\\frac{37}{24}\\times 0.04=0.061666\\ldots\n$$\n四舍五入到三位有效数字，$(0.2,0.2)$ 处的电势是 $0.0617$ V。", "answer": "$$\\boxed{0.0617}$$", "id": "1802423"}, {"introduction": "从静态场到动态波的模拟是计算电磁学的一大步。虽然前一个练习处理的是不随时间变化的静电场，但更多有趣的电磁现象，如无线通信和雷达，都涉及电磁波的传播。本实践深入探讨了时域有限差分法（FDTD）的核心，展示了我们如何逐步推进麦克斯韦方程组在时间上的演化，并学习如何将现实世界中的材料损耗（电导率 $\\sigma$）等效应融入到数值算法中。[@problem_id:1802437]", "problem": "在计算电磁学中，时域有限差分 (FDTD) 方法是模拟波传播的一种强大工具。考虑一个一维问题，其中电磁波沿 z 轴传播。唯有的非零场分量是电场 $E_x$ 和磁场 $H_y$。传播介质是一种简单的非磁性 ($\\mu = \\mu_0$) 有耗介电材料，其特征是具有恒定的介电常数 $\\epsilon$ 和恒定的电导率 $\\sigma$。\n\nFDTD 方法分别使用步长 $\\Delta z$ 和 $\\Delta t$ 对空间和时间进行离散化。场值在交错网格 (Yee 晶格) 上进行计算，对于整数索引 $k$ 和时间步 $n$，我们将 $E_x(k\\Delta z, n\\Delta t)$ 记为 $E_x^n(k)$，并将 $H_y((k+1/2)\\Delta z, (n+1/2)\\Delta t)$ 记为 $H_y^{n+1/2}(k+1/2)$。\n\n对于无耗介质 ($\\sigma = 0$)，电场的标准 FDTD 更新方程为：\n$$E_x^{n+1}(k) = E_x^n(k) - \\frac{\\Delta t}{\\epsilon \\Delta z} \\left( H_y^{n+1/2}(k+1/2) - H_y^{n+1/2}(k-1/2) \\right)$$\n\n当介质为有耗介质时 ($\\sigma > 0$)，必须修改此方程以计入传导电流。电场的新更新方程形式如下：\n$$E_x^{n+1}(k) = C_a E_x^n(k) - C_b \\left( \\frac{H_y^{n+1/2}(k+1/2) - H_y^{n+1/2}(k-1/2)}{\\Delta z} \\right)$$\n其中 $C_a$ 和 $C_b$ 是取决于 $\\epsilon$、$\\sigma$ 和时间步长 $\\Delta t$ 的新常数。\n\n假设使用标准的半隐式中心差分格式对麦克斯韦方程组进行离散化，请确定系数的乘积 $C_a C_b$ 的解析表达式。请用 $\\epsilon$、$\\sigma$ 和 $\\Delta t$ 来表示你的答案。", "solution": "我们从包含传导电流的一维情况下的安培-麦克斯韦定律开始，该定律与给定的无耗更新方程所隐含的符号约定一致（即磁场空间差分前有一个负号）：\n$$\n\\epsilon \\frac{\\partial E_{x}}{\\partial t} + \\sigma E_{x} = -\\,\\frac{\\partial H_{y}}{\\partial z}.\n$$\n对传导项使用标准的半隐式中心差分 (Crank–Nicolson) 格式，并采用 Yee 时间和空间交错格式，我们按如下方式进行离散化：\n- 将时间导数替换为 $E_{x}$ 的中心差分：\n$$\n\\frac{\\partial E_{x}}{\\partial t} \\Big|^{n+1/2} \\approx \\frac{E_{x}^{n+1}(k) - E_{x}^{n}(k)}{\\Delta t}.\n$$\n- 将传导项替换为时间上的平均值：\n$$\nE_{x}\\Big|^{n+1/2} \\approx \\frac{E_{x}^{n+1}(k) + E_{x}^{n}(k)}{2}.\n$$\n- 使用交错空间差分替换半个时间步长处的 $H_{y}$ 的空间导数：\n$$\n\\frac{\\partial H_{y}}{\\partial z} \\Big|^{n+1/2} \\approx \\frac{H_{y}^{n+1/2}(k+1/2) - H_{y}^{n+1/2}(k-1/2)}{\\Delta z}.\n$$\n将这些代入连续方程可得\n$$\n\\epsilon \\frac{E_{x}^{n+1}(k) - E_{x}^{n}(k)}{\\Delta t} + \\sigma \\frac{E_{x}^{n+1}(k) + E_{x}^{n}(k)}{2}\n= -\\,\\frac{H_{y}^{n+1/2}(k+1/2) - H_{y}^{n+1/2}(k-1/2)}{\\Delta z}.\n$$\n将 $E_{x}^{n+1}(k)$ 的项收集到左侧：\n$$\n\\left(\\frac{\\epsilon}{\\Delta t} + \\frac{\\sigma}{2}\\right) E_{x}^{n+1}(k)\n= \\left(\\frac{\\epsilon}{\\Delta t} - \\frac{\\sigma}{2}\\right) E_{x}^{n}(k)\n- \\frac{H_{y}^{n+1/2}(k+1/2) - H_{y}^{n+1/2}(k-1/2)}{\\Delta z}.\n$$\n两边同除以 $\\left(\\frac{\\epsilon}{\\Delta t} + \\frac{\\sigma}{2}\\right)$，得到问题陈述中所给形式的更新方程：\n$$\nE_{x}^{n+1}(k) = C_{a} E_{x}^{n}(k)\n- C_{b} \\left(\\frac{H_{y}^{n+1/2}(k+1/2) - H_{y}^{n+1/2}(k-1/2)}{\\Delta z}\\right),\n$$\n其中\n$$\nC_{a} = \\frac{\\frac{\\epsilon}{\\Delta t} - \\frac{\\sigma}{2}}{\\frac{\\epsilon}{\\Delta t} + \\frac{\\sigma}{2}},\n\\qquad\nC_{b} = \\frac{1}{\\frac{\\epsilon}{\\Delta t} + \\frac{\\sigma}{2}}.\n$$\n因此，乘积为\n$$\nC_{a} C_{b} = \\frac{\\frac{\\epsilon}{\\Delta t} - \\frac{\\sigma}{2}}{\\left(\\frac{\\epsilon}{\\Delta t} + \\frac{\\sigma}{2}\\right)^{2}}.\n$$\n为了仅用 $\\epsilon$、$\\sigma$ 和 $\\Delta t$ 来表示该式，对其进行整理可得：\n$$\nC_{a} C_{b}\n= \\frac{\\Delta t}{\\epsilon}\\,\\frac{1 - \\frac{\\sigma \\Delta t}{2 \\epsilon}}{\\left(1 + \\frac{\\sigma \\Delta t}{2 \\epsilon}\\right)^{2}}.\n$$\n这就是所求的解析表达式。", "answer": "$$\\boxed{\\frac{\\Delta t}{\\epsilon}\\,\\frac{1-\\frac{\\sigma \\Delta t}{2\\epsilon}}{\\left(1+\\frac{\\sigma \\Delta t}{2\\epsilon}\\right)^{2}}}$$", "id": "1802437"}, {"introduction": "在进行电磁波仿真时，我们面临一个实际的挑战：计算机的计算区域是有限的，但我们常常需要模拟无限开放空间中的问题。简单地截断计算边界会产生虚假的反射，干扰仿真结果。本练习旨在探索一种巧妙的解决方案：在计算网格的边缘创建一种人工“吸收”材料，以模拟无反射的开放空间，这种高级技术被称为完美匹配层（PML）。[@problem_id:1802456]", "problem": "在电磁波传播的数值模拟中，例如使用时域有限差分 (FDTD) 方法，为了模拟开放的无界空间，在计算域的边界吸收出射波是至关重要的。这通常通过使用完美匹配层 (PML) 来实现，它是一种人工吸收介质。\n\n考虑一个一维情景，其中区域 $x < 0$ 是自由空间，其特征是介电常数为 $\\epsilon_0$ 和磁导率为 $\\mu_0$。PML 占据区域 $0 \\le x \\le d$。该层被建模为一种非磁性材料 ($\\mu = \\mu_0$)，介电常数为 $\\epsilon_0$，但其人工的、与位置相关的电导率由下式给出：\n$$\n\\sigma(x) = \\sigma_m \\left(\\frac{x}{d}\\right)^{2}\n$$\n其中 $\\sigma_m$ 是一个常数，表示在该层末端的最大电导率。\n\n一列角频率为 $\\omega$ 的单色平面电磁波沿 $+x$ 方向传播。它在 $x=0$ 处正入射到 PML 界面上。假设 PML 的设计使其在整个厚度范围内都可被视为良介质，这意味着对于在 $[0, d]$ 范围内的所有 $x$，条件 $\\sigma(x) \\ll \\omega \\epsilon_0$ 都成立。\n\n基于此模型，请确定 PML 末端（$x=d$）与起始端（$x=0$）的电场振幅之比 $R$ 的闭式解析表达式。答案请用 $\\sigma_m$、$d$、$\\epsilon_0$ 和 $\\mu_0$ 表示。", "solution": "考虑时谐场，采用 $\\exp(j \\omega t)$ 的约定。在线性、各向同性、导电介质中，其介电常数为 $\\epsilon$，电导率为 $\\sigma(x)$，麦克斯韦方程组可推导出一维平面波的标量亥姆霍兹方程，\n$$\n\\frac{d^{2}E}{dx^{2}} + k^{2}(x)\\,E = 0,\n$$\n其中复波数定义为\n$$\nk^{2}(x) = \\omega^{2} \\mu \\epsilon - j \\omega \\mu \\sigma(x) = \\omega^{2} \\mu \\left(\\epsilon - j \\frac{\\sigma(x)}{\\omega}\\right) \\equiv \\omega^{2} \\mu \\epsilon_{c}(x),\n$$\n其中 $\\epsilon_{c}(x) = \\epsilon - j \\sigma(x)/\\omega$。在本问题中，$\\mu=\\mu_{0}$ 且 $\\epsilon=\\epsilon_{0}$。\n\n在“良介质”（弱损耗）假设 $\\sigma(x) \\ll \\omega \\epsilon_{0}$ 下，将平方根展开至一阶：\n$$\nk(x) = \\omega \\sqrt{\\mu_{0} \\epsilon_{0}} \\sqrt{1 - j \\frac{\\sigma(x)}{\\omega \\epsilon_{0}}}\n\\approx \\omega \\sqrt{\\mu_{0} \\epsilon_{0}} \\left(1 - \\frac{j}{2} \\frac{\\sigma(x)}{\\omega \\epsilon_{0}}\\right)\n= k_{0} - j\\,\\alpha(x),\n$$\n其中\n$$\nk_{0} \\equiv \\omega \\sqrt{\\mu_{0} \\epsilon_{0}},\\qquad \\alpha(x) \\equiv \\frac{\\sigma(x)}{2}\\sqrt{\\frac{\\mu_{0}}{\\epsilon_{0}}}.\n$$\n那么，一个前向传播波的解具有以下形式\n$$\nE(x) \\approx E(0)\\,\\exp\\!\\left(-j \\int_{0}^{x} k_{0}\\,dx'\\right)\\exp\\!\\left(-\\int_{0}^{x} \\alpha(x')\\,dx'\\right),\n$$\n因此，电场振幅按如下规律衰减\n$$\n\\frac{|E(x)|}{|E(0)|} = \\exp\\!\\left(-\\int_{0}^{x} \\alpha(x')\\,dx'\\right).\n$$\n因此, 在 $x=d$ 处所求的比值 $R$ 为\n$$\nR = \\exp\\!\\left(-\\int_{0}^{d} \\alpha(x)\\,dx\\right) = \\exp\\!\\left(-\\frac{1}{2}\\sqrt{\\frac{\\mu_{0}}{\\epsilon_{0}}}\\int_{0}^{d} \\sigma(x)\\,dx\\right).\n$$\n对于给定的分布 $\\sigma(x) = \\sigma_{m} \\left(\\frac{x}{d}\\right)^{2}$，\n$$\n\\int_{0}^{d} \\sigma(x)\\,dx = \\sigma_{m} \\int_{0}^{d} \\left(\\frac{x}{d}\\right)^{2} dx = \\sigma_{m} \\frac{1}{d^{2}} \\left[\\frac{x^{3}}{3}\\right]_{0}^{d} = \\frac{\\sigma_{m} d}{3}.\n$$\n因此，\n$$\nR = \\exp\\!\\left(-\\frac{1}{2}\\sqrt{\\frac{\\mu_{0}}{\\epsilon_{0}}}\\,\\frac{\\sigma_{m} d}{3}\\right) = \\exp\\!\\left(-\\frac{\\sigma_{m} d}{6}\\sqrt{\\frac{\\mu_{0}}{\\epsilon_{0}}}\\right).\n$$\n因为 PML 在 $x=0$ 处是匹配的，且损耗很弱，所以反射可以忽略不计，上述表达式即为穿过该层的振幅比。", "answer": "$$\\boxed{\\exp\\!\\left(-\\frac{\\sigma_{m} d}{6}\\sqrt{\\frac{\\mu_{0}}{\\epsilon_{0}}}\\right)}$$", "id": "1802456"}]}