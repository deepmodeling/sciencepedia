{"hands_on_practices": [{"introduction": "在经典密度泛函理论中，粒子数密度 $\\rho(\\mathbf{r})$ 是描述系统的核心变量。这个练习将作为一个基础起点，演示如何通过对密度和外势的乘积进行积分，来计算一个宏观物理量——整个系统的总外势能。这是一个基础的计算技能，能帮助我们具体理解密度分布的物理意义。[@problem_id:2059839]", "problem": "考虑一个一维系统，由$N$个无相互作用的经典粒子组成，在恒定的绝对温度$T$下处于热平衡状态。这些粒子受到一个外部谐波势的约束，该势由$V_{\\text{ext}}(x) = \\frac{1}{2} k x^2$给出，其中$k$是一个正常数，$x$是位置。\n\n在经典统计力学的框架下，这些粒子的空间分布可以用粒子数密度$\\rho(x)$来描述，它表示在位置$x$处单位长度内的粒子数。对于此系统，平衡状态下的粒子密度是一个高斯函数：\n$$\n\\rho(x) = N \\sqrt{\\frac{\\beta k}{2\\pi}} \\exp\\left(-\\frac{1}{2}\\beta k x^2\\right)\n$$\n其中$\\beta = \\frac{1}{k_B T}$，$k_B$是玻尔兹曼常数。\n\n计算由于外部约束势，储存在整个粒子系统中的总势能。请用总粒子数$N$、玻尔兹曼常数$k_B$和温度$T$的形式，给出一个闭合形式的解析表达式。", "solution": "在存在外部势$V_{\\text{ext}}(x)$的情况下，由粒子数密度$\\rho(x)$描述的系统的总外部势能$U_{\\text{ext}}$，由能量密度在整个空间上的积分给出。在$x$点的能量密度是粒子密度$\\rho(x)$和每个粒子的势能$V_{\\text{ext}}(x)$的乘积。\n\n其定义积分为：\n$$\nU_{\\text{ext}} = \\int_{-\\infty}^{\\infty} \\rho(x) V_{\\text{ext}}(x) \\, dx\n$$\n\n我们已知粒子密度和外部势的表达式：\n$$\n\\rho(x) = N \\sqrt{\\frac{\\beta k}{2\\pi}} \\exp\\left(-\\frac{1}{2}\\beta k x^2\\right)\n$$\n$$\nV_{\\text{ext}}(x) = \\frac{1}{2} k x^2\n$$\n\n将这些表达式代入$U_{\\text{ext}}$的积分中：\n$$\nU_{\\text{ext}} = \\int_{-\\infty}^{\\infty} \\left( N \\sqrt{\\frac{\\beta k}{2\\pi}} \\exp\\left(-\\frac{1}{2}\\beta k x^2\\right) \\right) \\left( \\frac{1}{2} k x^2 \\right) \\, dx\n$$\n\n我们可以将所有常数项从积分中提出：\n$$\nU_{\\text{ext}} = N \\left( \\sqrt{\\frac{\\beta k}{2\\pi}} \\right) \\left( \\frac{k}{2} \\right) \\int_{-\\infty}^{\\infty} x^2 \\exp\\left(-\\frac{1}{2}\\beta k x^2\\right) \\, dx\n$$\n\n为了计算该积分，我们可以使用形式为$\\int_{-\\infty}^{\\infty} x^{2n} \\exp(-ax^2) \\, dx$的高斯积分的标准结果。首先考虑基本的高斯积分：\n$$\nI_0(a) = \\int_{-\\infty}^{\\infty} \\exp(-ax^2) \\, dx = \\sqrt{\\frac{\\pi}{a}}\n$$\n我们可以通过对参数$a$求导$I_0(a)$来得到我们需要的积分$\\int_{-\\infty}^{\\infty} x^2 \\exp(-ax^2) \\, dx$：\n$$\n\\frac{d}{da} I_0(a) = \\frac{d}{da} \\int_{-\\infty}^{\\infty} \\exp(-ax^2) \\, dx\n$$\n使用莱布尼茨积分法则在积分号下求导：\n$$\n\\frac{d}{da} I_0(a) = \\int_{-\\infty}^{\\infty} \\frac{\\partial}{\\partial a} \\exp(-ax^2) \\, dx = \\int_{-\\infty}^{\\infty} (-x^2) \\exp(-ax^2) \\, dx = - \\int_{-\\infty}^{\\infty} x^2 \\exp(-ax^2) \\, dx\n$$\n我们同样对$I_0(a)$表达式的右侧进行求导：\n$$\n\\frac{d}{da} \\left( \\sqrt{\\frac{\\pi}{a}} \\right) = \\sqrt{\\pi} \\frac{d}{da} (a^{-1/2}) = \\sqrt{\\pi} \\left( -\\frac{1}{2} a^{-3/2} \\right) = -\\frac{1}{2} \\sqrt{\\frac{\\pi}{a^3}}\n$$\n令两个导数结果相等：\n$$\n- \\int_{-\\infty}^{\\infty} x^2 \\exp(-ax^2) \\, dx = -\\frac{1}{2} \\sqrt{\\frac{\\pi}{a^3}}\n$$\n因此，我们需要的积分为：\n$$\n\\int_{-\\infty}^{\\infty} x^2 \\exp(-ax^2) \\, dx = \\frac{1}{2} \\sqrt{\\frac{\\pi}{a^3}}\n$$\n在我们具体的问题中，参数$a$对应于$a = \\frac{1}{2}\\beta k$。将此代入积分结果中：\n$$\n\\int_{-\\infty}^{\\infty} x^2 \\exp\\left(-\\frac{1}{2}\\beta k x^2\\right) \\, dx = \\frac{1}{2} \\sqrt{\\frac{\\pi}{(\\frac{1}{2}\\beta k)^3}} = \\frac{1}{2} \\sqrt{\\frac{8\\pi}{(\\beta k)^3}} = \\frac{1}{2} \\frac{2\\sqrt{2\\pi}}{(\\beta k)^{3/2}} = \\frac{\\sqrt{2\\pi}}{(\\beta k)^{3/2}}\n$$\n现在，我们将这个结果代回$U_{\\text{ext}}$的表达式中：\n$$\nU_{\\text{ext}} = N \\left( \\sqrt{\\frac{\\beta k}{2\\pi}} \\right) \\left( \\frac{k}{2} \\right) \\left( \\frac{\\sqrt{2\\pi}}{(\\beta k)^{3/2}} \\right)\n$$\n让我们简化这个代数表达式：\n$$\nU_{\\text{ext}} = \\frac{Nk}{2} \\left( \\frac{(\\beta k)^{1/2}}{(2\\pi)^{1/2}} \\right) \\left( \\frac{(2\\pi)^{1/2}}{(\\beta k)^{3/2}} \\right)\n$$\n$\\sqrt{2\\pi}$项相互抵消：\n$$\nU_{\\text{ext}} = \\frac{Nk}{2} \\frac{(\\beta k)^{1/2}}{(\\beta k)^{3/2}} = \\frac{Nk}{2} (\\beta k)^{1/2 - 3/2} = \\frac{Nk}{2} (\\beta k)^{-1}\n$$\n$$\nU_{\\text{ext}} = \\frac{Nk}{2} \\frac{1}{\\beta k} = \\frac{N}{2\\beta}\n$$\n最后，我们代入定义$\\beta = \\frac{1}{k_B T}$：\n$$\nU_{\\text{ext}} = \\frac{N}{2(1/k_B T)} = \\frac{1}{2} N k_B T\n$$\n这个结果与能量均分定理一致，该定理指出，每个二次自由度（如此处的势能$V \\propto x^2$）对系统的平均能量贡献为$\\frac{1}{2}k_B T$。对于$N$个粒子，总势能为$N \\times \\frac{1}{2}k_B T$。", "answer": "$$\\boxed{\\frac{1}{2} N k_{B} T}$$", "id": "2059839"}, {"introduction": "经典密度泛函理论的一个强大应用是解决所谓的“逆向问题”。这个练习将引导我们超越标准的“正向问题”（即从给定的势函数预测密度），去探索如何设计一个特定的外势 $V_{\\text{ext}}(x)$ 来稳定一个我们预先设定的目标密度分布 $\\rho_{\\text{target}}(x)$。这个过程不仅展示了变分原理的实际应用，也揭示了该理论在材料设计和系统控制方面的巨大潜力。[@problem_id:2059864]", "problem": "在经典密度泛函理论 (DFT) 的框架内，流体的平衡性质由其单体密度分布 $\\rho(\\mathbf{r})$ 描述。考虑一个在恒定温度 $T$ 下，被限制在 $x$ 轴上的一维相互作用粒子流体。该流体的内禀亥姆霍兹自由能泛函 $F[\\rho]$ 由一个模型近似，该模型在局域平均场水平上同时包含了理想气体贡献和对相互作用：\n$$F[\\rho] = k_B T \\int_{-\\infty}^{\\infty} \\rho(x) \\left[\\ln(\\rho(x) \\Lambda) - 1\\right] dx + \\frac{A}{2} \\int_{-\\infty}^{\\infty} [\\rho(x)]^2 dx$$\n此处，$k_B$ 是玻尔兹曼常数，$\\Lambda$ 是代表理想气体贡献的热德布罗意波长，$A$ 是一个量化粒子间排斥相互作用强度的正常数。\n\nDFT 的 Hohenberg-Kohn 定理指出，对于一个处于固定温度和化学势 $\\mu$ 的体系，存在一个唯一的外势 $V_{\\text{ext}}(x)$，它可以稳定任何给定的非简并基态密度分布 $\\rho(x)$。这个平衡密度是使巨势泛函 $\\Omega[\\rho] = F[\\rho] + \\int \\rho(x) [V_{\\text{ext}}(x) - \\mu] dx$ 最小化的密度。\n\n您的任务是解决这个逆问题：确定稳定一个由高斯函数给出的特定目标密度分布所需的外势 $V_{\\text{ext}}(x)$：\n$$\\rho_{\\text{target}}(x) = \\rho_0 \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right)$$\n其中 $\\rho_0$ 是 $x=0$ 处的峰值密度，$\\sigma$ 是特征宽度。\n\n由于势的定义只差一个任意的加性常数，请用 $k_B, T, A, \\rho_0, \\sigma$ 和坐标 $x$ 来表示您的最终答案，即势差 $V_{\\text{ext}}(x) - V_{\\text{ext}}(0)$。", "solution": "我们从固定温度和化学势下的巨势泛函出发，\n$$\n\\Omega[\\rho] = F[\\rho] + \\int_{-\\infty}^{\\infty} \\rho(x) \\left[V_{\\text{ext}}(x) - \\mu \\right] dx,\n$$\n平衡分布满足欧拉-拉格朗日条件\n$$\n\\frac{\\delta \\Omega}{\\delta \\rho(x)} = 0 \\quad \\Rightarrow \\quad \\frac{\\delta F}{\\delta \\rho(x)} + V_{\\text{ext}}(x) - \\mu = 0.\n$$\n对于给定的泛函，\n$$\nF[\\rho] = k_{B} T \\int_{-\\infty}^{\\infty} \\rho(x) \\left[\\ln\\!\\big(\\rho(x)\\Lambda\\big) - 1\\right] dx + \\frac{A}{2} \\int_{-\\infty}^{\\infty} \\left[\\rho(x)\\right]^{2} dx,\n$$\n我们局域地计算每个泛函导数。对于理想气体部分，使用 $f(\\rho)=\\rho\\left[\\ln(\\rho\\Lambda)-1\\right]$，\n$$\n\\frac{d f}{d \\rho} = \\ln(\\rho \\Lambda) + \\rho \\frac{1}{\\rho} - 1 = \\ln(\\rho \\Lambda),\n$$\n所以\n$$\n\\frac{\\delta F_{\\text{id}}}{\\delta \\rho(x)} = k_{B} T \\ln\\!\\big(\\rho(x)\\Lambda\\big).\n$$\n对于相互作用项，\n$$\n\\frac{\\delta}{\\delta \\rho(x)} \\left[\\frac{A}{2} \\int \\rho^{2}(x') dx' \\right] = A \\rho(x).\n$$\n因此，\n$$\n\\frac{\\delta F}{\\delta \\rho(x)} = k_{B} T \\ln\\!\\big(\\rho(x)\\Lambda\\big) + A \\rho(x).\n$$\n欧拉-拉格朗日方程得出\n$$\nV_{\\text{ext}}(x) = \\mu - k_{B} T \\ln\\!\\big(\\rho(x)\\Lambda\\big) - A \\rho(x).\n$$\n势的定义相差一个加性常数，因此我们考虑其差值\n$$\nV_{\\text{ext}}(x) - V_{\\text{ext}}(0) = - k_{B} T \\left[\\ln\\!\\big(\\rho(x)\\Lambda\\big) - \\ln\\!\\big(\\rho(0)\\Lambda\\big)\\right] - A \\left[\\rho(x) - \\rho(0)\\right].\n$$\n因子 $\\Lambda$ 在对数内相互抵消，得到\n$$\nV_{\\text{ext}}(x) - V_{\\text{ext}}(0) = - k_{B} T \\ln\\!\\left(\\frac{\\rho(x)}{\\rho(0)}\\right) - A \\left[\\rho(x) - \\rho(0)\\right].\n$$\n对于目标高斯密度分布\n$$\n\\rho_{\\text{target}}(x) = \\rho_{0} \\exp\\!\\left(-\\frac{x^{2}}{2 \\sigma^{2}}\\right),\n$$\n我们有 $\\rho(0)=\\rho_{0}$ 以及\n$$\n\\ln\\!\\left(\\frac{\\rho(x)}{\\rho(0)}\\right) = -\\frac{x^{2}}{2 \\sigma^{2}}, \\qquad \\rho(x) - \\rho(0) = \\rho_{0} \\left[\\exp\\!\\left(-\\frac{x^{2}}{2 \\sigma^{2}}\\right) - 1\\right].\n$$\n代入势差表达式中，得到\n$$\nV_{\\text{ext}}(x) - V_{\\text{ext}}(0) = k_{B} T \\frac{x^{2}}{2 \\sigma^{2}} + A \\rho_{0} \\left[1 - \\exp\\!\\left(-\\frac{x^{2}}{2 \\sigma^{2}}\\right)\\right].\n$$\n这就将所需的外势差完全用 $k_{B}, T, A, \\rho_{0}, \\sigma$ 和 $x$ 表示了出来。", "answer": "$$\\boxed{\\frac{k_{B} T}{2 \\sigma^{2}} x^{2} + A \\rho_{0} \\left[1 - \\exp\\left(-\\frac{x^{2}}{2 \\sigma^{2}}\\right)\\right]}$$", "id": "2059864"}, {"introduction": "本练习从计算转向了概念推理，旨在加深对密度泛函理论基本原理的理解。我们将通过一个思想实验来探讨系统对称性之间的深刻联系：即外势 $V_{ext}(\\mathbf{r})$ 的对称性如何决定了基态密度 $\\rho_0(\\mathbf{r})$ 的对称性。解决这个问题不依赖于复杂的计算，而是需要严谨的逻辑论证，这有助于我们巩固对 Hohenberg-Kohn 定理背后逻辑的认识。[@problem_id:2059872]", "problem": "在经典密度泛函理论（DFT）的框架下，一个由许多相互作用的粒子组成的系统在固定温度下的状态，完全由其单体粒子数密度 $\\rho(\\mathbf{r})$ 来描述。系统的总能量是该密度的一个唯一泛函 $E[\\rho]$。根据一个与第一 Hohenberg-Kohn 定理类似的基本原理，对于给定类型的粒子相互作用，粒子所处的外势 $V_{ext}(\\mathbf{r})$ 由系统的基态密度 $\\rho_0(\\mathbf{r})$ 唯一确定。反之，该外势 $V_{ext}(\\mathbf{r})$ 也唯一地确定了基态密度 $\\rho_0(\\mathbf{r})$。\n\n总能量泛函可以写为 $E[\\rho] = F[\\rho] + \\int \\rho(\\mathbf{r}) V_{ext}(\\mathbf{r})d\\mathbf{r}$，其中 $F[\\rho]$ 是一个普适泛函，代表动能和粒子间相互作用势能之和，第二项是与外势相互作用的能量。泛函 $F[\\rho]$ 独立于外势，并且在密度分布的刚性空间变换（如平移或旋转）下保持不变。基态是使该能量泛函最小化的状态。\n\n考虑一个系统，其外势相对于原点反演对称，即对所有位置矢量 $\\mathbf{r}$，都有 $V_{ext}(\\mathbf{r}) = V_{ext}(-\\mathbf{r})$。假设该系统的基态是非简并的（即，只有一个唯一的密度分布 $\\rho_0(\\mathbf{r})$ 能使能量最小化），下列哪个陈述为基态密度 $\\rho_0(\\mathbf{r})$ 也必须是反演对称的，即 $\\rho_0(\\mathbf{r}) = \\rho_0(-\\mathbf{r})$，提供了正确且完整的逻辑论证？\n\nA. 假设基态密度 $\\rho_0(\\mathbf{r})$ 不是对称的。可以构造一个新的密度 $\\rho'(\\mathbf{r}) = \\rho_0(-\\mathbf{r})$。因为普适泛函 $F[\\rho]$ 和外势 $V_{ext}(\\mathbf{r})$ 在反演操作下都是对称的，这个新密度 $\\rho'(\\mathbf{r})$ 产生的总能量与 $\\rho_0(\\mathbf{r})$ 完全相同。由于 $\\rho_0(\\mathbf{r})$ 是基态， $\\rho'(\\mathbf{r})$ 也必然是基态密度。由于基态是非简并的， $\\rho'(\\mathbf{r})$ 必须与 $\\rho_0(\\mathbf{r})$ 相同，这迫使密度必须是对称的，与初始假设矛盾。\n\nB. 粒子受到的力由势的负梯度给出，$\\mathbf{F}(\\mathbf{r}) = -\\nabla V_{ext}(\\mathbf{r})$。如果势是对称的，$V_{ext}(\\mathbf{r}) = V_{ext}(-\\mathbf{r})$，那么力必然是反对称的，$\\mathbf{F}(\\mathbf{r}) = -\\mathbf{F}(-\\mathbf{r})$。这意味着处于相反位置的粒子受到大小相等、方向相反的推力，自然导致基态下的对称分布。\n\nC. 物理学的一项基本原理指出，果的对称性必须包含因的对称性。在这个系统中，外势 $V_{ext}(\\mathbf{r})$ 是因，基态密度 $\\rho_0(\\mathbf{r})$ 是果。因此，由于势具有反演对称性，密度也必须具有反演对称性。\n\nD. 基态密度 $\\rho_0(\\mathbf{r})$ 唯一确定外势 $V_{ext}(\\mathbf{r})$。如果密度是不对称的，$\\rho_0(\\mathbf{r}) \\neq \\rho_0(-\\mathbf{r})$，它将产生一个不对称的势。既然已知势是对称的，那么决定它的密度也必须是对称的。\n\nE. 密度中的任何不对称性，如 $\\rho(\\mathbf{r}) \\neq \\rho(-\\mathbf{r})$，必然会因为 $V_{ext}(\\mathbf{r})$ 是对称的而破坏积分 $\\int \\rho(\\mathbf{r}) V_{ext}(\\mathbf{r})d\\mathbf{r}$ 的对称性。与对称密度相比，这将导致更高的势能，因此该状态不可能是基态。", "solution": "令 $\\mathcal{I}:\\mathbf{r}\\mapsto -\\mathbf{r}$ 表示通过原点的反演，并定义反演后的密度为 $\\rho'(\\mathbf{r}) \\equiv \\rho_{0}(-\\mathbf{r})$。根据假设，$F[\\rho]$ 是普适的，并且在刚性空间变换下保持不变。特别地，对于任何正交变换 $R$（包括反演 $R=-I$，满足 $R^{\\mathrm{T}}R=I$），有\n$$\nF[\\rho\\circ R]=F[\\rho],\n$$\n因此\n$$\nF[\\rho']=F[\\rho_{0}].\n$$\n对于外势的贡献项，使用变量替换。从下式开始\n$$\n\\int \\rho'(\\mathbf{r})\\,V_{ext}(\\mathbf{r})\\,d\\mathbf{r}=\\int \\rho_{0}(-\\mathbf{r})\\,V_{ext}(\\mathbf{r})\\,d\\mathbf{r}.\n$$\n令 $\\mathbf{r}'=-\\mathbf{r}$。由于雅可比行列式的绝对值为1，有 $d\\mathbf{r}'=d\\mathbf{r}$，且全空间映射到全空间，因此\n$$\n\\int \\rho_{0}(-\\mathbf{r})\\,V_{ext}(\\mathbf{r})\\,d\\mathbf{r}=\\int \\rho_{0}(\\mathbf{r}')\\,V_{ext}(-\\mathbf{r}')\\,d\\mathbf{r}'.\n$$\n因为 $V_{ext}$ 是偶函数，所以 $V_{ext}(-\\mathbf{r}')=V_{ext}(\\mathbf{r}')$，因此\n$$\n\\int \\rho'(\\mathbf{r})\\,V_{ext}(\\mathbf{r})\\,d\\mathbf{r}=\\int \\rho_{0}(\\mathbf{r}')\\,V_{ext}(\\mathbf{r}')\\,d\\mathbf{r}'.\n$$\n结合 $F$ 的不变性，总能量相等：\n$$\nE[\\rho'] \\equiv F[\\rho']+\\int \\rho' V_{ext} d\\mathbf{r} = F[\\rho_{0}]+\\int \\rho_{0} V_{ext} d\\mathbf{r} \\equiv E[\\rho_{0}].\n$$\n由于 $\\rho_{0}$ 使 $E[\\rho]$ 最小化，对于所有允许的 $\\rho$，都有 $E[\\rho]\\geq E[\\rho_{0}]$。等式 $E[\\rho']=E[\\rho_{0}]$ 表明 $\\rho'$ 也是一个基态密度。根据非简并假设，基态密度是唯一的，所以 $\\rho'(\\mathbf{r})=\\rho_{0}(\\mathbf{r})$ 几乎处处成立。因此\n$$\n\\rho_{0}(\\mathbf{r})=\\rho_{0}(-\\mathbf{r}),\n$$\n即，基态密度是反演对称的。这正是选项A中给出的推理过程。其他选项要么依赖于启发式的力学论证（B），要么引用了一个无效的普遍准则，忽略了可能的对称性破缺和非简并性的必要性（C），要么在没有必要的能量不变性步骤的情况下误用了密度-势的唯一性（D），要么错误地声称不对称性必然会提高外势能项（E）。", "answer": "$$\\boxed{A}$$", "id": "2059872"}]}