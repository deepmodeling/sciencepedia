{"hands_on_practices": [{"introduction": "理解任何动力系统的第一步都是观察其如何从一个初始状态演化。本练习通过直接应用标准映射的迭代规则，让你亲身体验一个“被踢的转子”是如何随时间步进的。通过计算前两次迭代，你将熟悉这个重要的离散时间系统在相空间中的基本运动方式。", "problem": "标准映射是一个强大而简单的模型，用于研究哈密顿系统中混沌的产生。它描述了一个“受踢转子”的动力学，即一个环上的粒子受到周期性的踢力。转子的状态由有序对 $(\\theta_n, p_n)$ 描述，其中 $\\theta_n$ 是其角位置，$p_n$ 是其在第 $(n+1)$ 次踢力作用前的无量纲角动量。从一次踢力到下一次踢力，状态的演化由以下离散时间映射给出：\n\n$$p_{n+1} = p_n + K \\sin(\\theta_n)$$\n$$\\theta_{n+1} = (\\theta_n + p_{n+1}) \\pmod{2\\pi}$$\n\n此处，$K$ 是一个代表踢力强度的无量纲参数。\n\n考虑一个受踢转子系统，其踢力强度为 $K = \\frac{\\pi}{2}$。转子初始处于静止状态（$p_0=0$），角位置为 $\\theta_0=\\frac{\\pi}{2}$。\n\n确定该映射经过两次完整迭代后（即在第三次踢力作用前）转子的状态 $(\\theta_2, p_2)$。将角度 $\\theta_2$ 以弧度表示，并确保其值位于主区间 $[0, 2\\pi)$ 内。你的最终答案应为有序对 $(\\theta_2, p_2)$。", "solution": "我们使用标准映射\n$$p_{n+1}=p_{n}+K\\sin(\\theta_{n}), \\quad \\theta_{n+1}=(\\theta_{n}+p_{n+1}) \\pmod{2\\pi},$$\n初始条件为 $p_{0}=0$，$\\theta_{0}=\\frac{\\pi}{2}$，且 $K=\\frac{\\pi}{2}$。\n\n第一次迭代（$n=0$）：\n$$p_{1}=p_{0}+K\\sin(\\theta_{0})=0+\\frac{\\pi}{2}\\sin\\!\\left(\\frac{\\pi}{2}\\right)=\\frac{\\pi}{2},$$\n$$\\theta_{1}=(\\theta_{0}+p_{1}) \\pmod{2\\pi}=\\left(\\frac{\\pi}{2}+\\frac{\\pi}{2}\\right) \\pmod{2\\pi}=\\pi.$$\n\n第二次迭代（$n=1$）：\n$$p_{2}=p_{1}+K\\sin(\\theta_{1})=\\frac{\\pi}{2}+\\frac{\\pi}{2}\\sin(\\pi)=\\frac{\\pi}{2},$$\n$$\\theta_{2}=(\\theta_{1}+p_{2}) \\pmod{2\\pi}=\\left(\\pi+\\frac{\\pi}{2}\\right) \\pmod{2\\pi}=\\frac{3\\pi}{2}.$$\n\n因此，经过两次迭代后，状态为 $(\\theta_{2},p_{2})=\\left(\\frac{3\\pi}{2},\\frac{\\pi}{2}\\right)$，其中 $\\theta_{2}\\in[0,2\\pi)$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{3\\pi}{2} & \\frac{\\pi}{2}\\end{pmatrix}}$$", "id": "2085860"}, {"introduction": "在掌握了如何迭代映射之后，一个更深入的问题是：是否存在系统会保持不变的特殊状态？这些状态被称为不动点，它们是理解系统长期行为的基石。本练习将引导你分析一个不动点附近的动力学行为，通过线性化技术来判断其稳定性，这是揭示相空间局部结构和通向混沌之路的关键一步。", "problem": "一个周期性受踢转子的简化动力学模型由标准映射给出。系统在时间步 $n$ 的状态由无量纲角 $\\theta_n$和无量纲角动量 $p_n$ 描述。系统从一次踢动到下一次的演化由以下离散时间方程描述：\n$$p_{n+1} = p_n + K \\sin(\\theta_n)$$\n$$\\theta_{n+1} = (\\theta_n + p_{n+1}) \\pmod{2\\pi}$$\n其中，$K$ 是一个称为踢动强度的正常数、无量纲参数。角度定义在一个圆上，因此对于任意整数 $m$，$\\theta$ 和 $\\theta+2\\pi m$ 被认为是相同的。\n\n该映射的一个不动点 $(\\theta^*, p^*)$ 是一个点，当 $(\\theta_n, p_n) = (\\theta^*, p^*)$ 时，它满足 $(\\theta_{n+1}, p_{n+1}) = (\\theta^*, p^*)$。可以验证，对于任意 $K$ 值，点 $(\\theta^*, p^*) = (\\pi, 0)$ 都是标准映射的一个不动点。\n\n为了理解这个不动点附近的动力学，我们可以研究小偏离是如何演化的。假设在时间步 $n$ 的状态与不动点有微小偏离，使得 $(\\theta_n, p_n) = (\\pi + \\delta\\theta_n, 0 + \\delta p_n)$，其中 $\\delta\\theta_n$ 和 $\\delta p_n$ 是非常小的量。对于小偏离，下一步的状态 $(\\theta_{n+1}, p_{n+1}) = (\\pi + \\delta\\theta_{n+1}, 0 + \\delta p_{n+1})$ 可以通过一个线性变换与初始偏离联系起来：\n$$\n\\begin{pmatrix} \\delta\\theta_{n+1} \\\\ \\delta p_{n+1} \\end{pmatrix} = M \\begin{pmatrix} \\delta\\theta_n \\\\ \\delta p_n \\end{pmatrix}\n$$\n其中 $M$ 是一个 $2 \\times 2$ 矩阵，其元素可能依赖于 $K$。求此变换矩阵 $M$ 的迹。", "solution": "标准映射可以写成如下变换\n$$\np' = p + K \\sin(\\theta), \\quad \\theta' = \\theta + p' = \\theta + p + K \\sin(\\theta),\n$$\n其中撇号表示下一步的变量。一个不动点满足 $p' = p^{*}$ 和 $\\theta' \\equiv \\theta^{*} \\pmod{2\\pi}$。对于 $(\\theta^{*}, p^{*}) = (\\pi, 0)$，我们有 $\\sin(\\pi) = 0$，所以 $p' = 0$ 且 $\\theta' = \\pi$，这证实了它是一个不动点。对于不动点周围的小偏离 $(\\delta\\theta, \\delta p)$，线性化的演化由在 $(\\pi, 0)$ 处求值的映射的雅可比矩阵 $M$ 给出：\n$$\nM = \\begin{pmatrix}\n\\frac{\\partial \\theta'}{\\partial \\theta} & \\frac{\\partial \\theta'}{\\partial p} \\\\\n\\frac{\\partial p'}{\\partial \\theta} & \\frac{\\partial p'}{\\partial p}\n\\end{pmatrix}_{(\\theta^{*},p^{*})}.\n$$\n从 $p' = p + K \\sin(\\theta)$，我们有\n$$\n\\frac{\\partial p'}{\\partial \\theta} = K \\cos(\\theta), \\quad \\frac{\\partial p'}{\\partial p} = 1.\n$$\n从 $\\theta' = \\theta + p + K \\sin(\\theta)$，我们有\n$$\n\\frac{\\partial \\theta'}{\\partial \\theta} = 1 + K \\cos(\\theta), \\quad \\frac{\\partial \\theta'}{\\partial p} = 1.\n$$\n在 $\\theta^{*} = \\pi$ 处求值得到 $\\cos(\\pi) = -1$，因此\n$$\nM = \\begin{pmatrix}\n1 + K \\cos(\\pi) & 1 \\\\\nK \\cos(\\pi) & 1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 - K & 1 \\\\\n- K & 1\n\\end{pmatrix}.\n$$\n因此 $M$ 的迹是\n$$\n\\operatorname{tr}(M) = (1 - K) + 1 = 2 - K.\n$$\n模运算不影响小偏离的线性化，因为恒等映射的导数为1，并且在 $\\theta^{*} = \\pi$ 周围的无穷小扰动不会遇到不连续性。", "answer": "$$\\boxed{2 - K}$$", "id": "2085801"}, {"introduction": "除了不动点，周期轨道是构成复杂动力学行为（包括混沌）的另一类基本骨架。解析地寻找周期轨道通常非常困难，因此我们常常依赖计算机进行数值搜索。本练习要求你设计一个算法来检验一个点是否位于周期轨道上，这不仅考验你对周期性定义的精确理解，也让你直面数值计算中必须考虑的实际问题，例如浮点数精度。", "problem": "标准映射，也称为 Chirikov-Taylor 映射，是研究哈密顿混沌的一个基本模型。它描述了一个“受踢转子”的动力学，这是一个被周期性踢动的旋转杆的理想化系统。系统在时间步 $n$ 的状态由相空间中的一个点 $(\\theta_n, p_n)$ 给出，其中 $\\theta_n$是角度，$p_n$是角动量。从一个时间步到下一个时间步的演化由离散映射 $M$ 控制：\n\n$$\n(\\theta_{n+1}, p_{n+1}) = M(\\theta_n, p_n)\n$$\n\n其方程为：\n\n$$\np_{n+1} = p_n + K \\sin(\\theta_n)\n$$\n$$\n\\theta_{n+1} = \\theta_n + p_{n+1}\n$$\n\n这里，$K$ 是一个常数参数，代表踢的强度。角度 $\\theta$ 通常被视为模 $2\\pi$。一条轨道是由初始条件 $(\\theta_0, p_0)$ 开始，通过重复应用映射 $M$ 生成的点序列 $\\{(\\theta_n, p_n)\\}_{n=0}^\\infty$。\n\n如果一个点 $(\\theta_0, p_0)$ 在精确地 $N$ 次映射应用后返回其初始状态，并且在此之前没有返回，则称该点在一条周期为 $N$ 的轨道上。也就是说，$M^N(\\theta_0, p_0) = (\\theta_0, p_0)$ 且对于所有整数 $1 \\le k  N$，$M^k(\\theta_0, p_0) \\neq (\\theta_0, p_0)$。注意，$M^k$ 表示连续应用映射 $M$ 共 $k$ 次。\n\n一位程序员的任务是编写一个数值算法，以确定对于给定的 $K$，一个给定的初始条件 $(\\theta_0, p_0)$ 是否位于一条周期为3的轨道上。由于浮点运算，直接进行相等性检查是不可靠的。因此，该算法必须通过验证 $|a_1 - a_2|  \\epsilon$ 和 $|b_1 - b_2|  \\epsilon$ 是否成立，来检查两个点 $(a_1, b_1)$ 和 $(a_2, b_2)$ 是否“足够接近”，其中 $\\epsilon  0$ 是一个很小的容差。在比较角度时，其差值应为圆上的最短距离，例如， $|\\theta_1 - \\theta_2|$ 实际上是 $\\min(|\\theta_1 - \\theta_2|, 2\\pi - |\\theta_1 - \\theta_2|)$。\n\n以下哪项概述了测试 $(\\theta_0, p_0)$ 是否在周期为3的轨道上的正确计算流程？\n\nA. 计算 $(\\theta_1, p_1) = M(\\theta_0, p_0)$，然后计算 $(\\theta_2, p_2) = M(\\theta_1, p_1)$，最后计算 $(\\theta_3, p_3) = M(\\theta_2, p_2)$。如果 $(\\theta_3, p_3)$ 与 $(\\theta_0, p_0)$ 足够接近，则该点在周期为3的轨道上。\n\nB. 计算 $(\\theta_1, p_1) = M(\\theta_0, p_0)$。如果 $(\\theta_1, p_1)$ 与 $(3\\theta_0, 3p_0)$ 足够接近，则该点在周期为3的轨道上。\n\nC. 计算 $(\\theta_1, p_1) = M(\\theta_0, p_0)$。如果 $(\\theta_1, p_1)$ 与 $(\\theta_0, p_0)$ 足够接近，则该点在周期为3的轨道上。\n\nD. 计算 $(\\theta_1, p_1) = M(\\theta_0, p_0)$。如果条件 $p_1 = p_0 + K \\sin(\\theta_0)$ 简化为 $p_1 = 3 p_0$，则该点在周期为3的轨道上。\n\nE. 计算 $(\\theta_1, p_1) = M(\\theta_0, p_0)$ 和 $(\\theta_2, p_2) = M(\\theta_1, p_1)$，然后计算 $(\\theta_3, p_3) = M(\\theta_2, p_2)$。如果 $(\\theta_3, p_3)$ 与 $(\\theta_0, p_0)$ 足够接近，并且 $(\\theta_1, p_1)$ 与 $(\\theta_0, p_0)$ 不足够接近，并且 $(\\theta_2, p_2)$ 与 $(\\theta_0, p_0)$ 不足够接近，则该点在周期为3的轨道上。", "solution": "我们已知标准映射\n$$\np_{n+1} = p_{n} + K \\sin(\\theta_{n}), \\quad \\theta_{n+1} = \\theta_{n} + p_{n+1},\n$$\n其中 $\\theta$ 取模 $2\\pi$。一个初始条件 $(\\theta_{0},p_{0})$ 在周期为 $N$ 的轨道上，当且仅当 $M^{N}(\\theta_{0},p_{0}) = (\\theta_{0},p_{0})$ 且对于所有整数 $1 \\leq k  N$，$M^{k}(\\theta_{0},p_{0}) \\neq (\\theta_{0},p_{0})$。因为数值计算使用容差，我们用一个使用容差 $\\epsilon  0$ 的“足够接近”测试来代替相等性判断，其中角度差使用圆上的最短弧长。定义角距离\n$$\nd_{\\mathbb{S}^{1}}(\\theta_{a},\\theta_{b}) = \\min\\big(|\\theta_{a}-\\theta_{b}|, \\, 2\\pi - |\\theta_{a}-\\theta_{b}|\\big),\n$$\n并称 $(\\theta_{a},p_{a})$ 与 $(\\theta_{b},p_{b})$ 足够接近，如果\n$$\nd_{\\mathbb{S}^{1}}(\\theta_{a},\\theta_{b})  \\epsilon \\quad \\text{and} \\quad |p_{a}-p_{b}|  \\epsilon.\n$$\n\n为了测试周期为3的情况，我们必须计算三个连续的迭代点，并检查在第3步时返回，但在此之前不返回。从 $(\\theta_{0},p_{0})$ 开始，计算\n$$\np_{1} = p_{0} + K \\sin(\\theta_{0}), \\quad \\theta_{1} = \\theta_{0} + p_{1},\n$$\n$$\np_{2} = p_{1} + K \\sin(\\theta_{1}), \\quad \\theta_{2} = \\theta_{1} + p_{2},\n$$\n$$\np_{3} = p_{2} + K \\sin(\\theta_{2}), \\quad \\theta_{3} = \\theta_{2} + p_{3},\n$$\n其中 $\\theta_{n}$ 使用上述的 $d_{\\mathbb{S}^{1}}$ 进行比较。周期为3的正确数值判据是：\n- $(\\theta_{3},p_{3})$ 与 $(\\theta_{0},p_{0})$ 足够接近（$M^{3}(\\theta_{0},p_{0}) = (\\theta_{0},p_{0})$ 的数值版本），并且\n- $(\\theta_{1},p_{1})$ 与 $(\\theta_{0},p_{0})$ 不足够接近，并且\n- $(\\theta_{2},p_{2})$ 与 $(\\theta_{0},p_{0})$ 不足够接近，\n这在数值上强制执行了对于 $k=1,2$ 的“在此之前没有返回”部分。\n\n评估各个选项：\n- A 计算了三次迭代，并且只测试了 $(\\theta_{3},p_{3})$ 是否接近 $(\\theta_{0},p_{0})$，但它没有排除 $k=1$ 的情况（一个不动点），这种情况也会满足在第3步返回的条件。因此A是不充分的。\n- B 将 $(\\theta_{1},p_{1})$ 与 $(3\\theta_{0},3p_{0})$ 比较，这没有反映映射的非线性动力学，是错误的。\n- C 只测试了周期为1（不动点）的情况，而不是周期为3。\n- D 断言从 $p_{1} = p_{0} + K \\sin(\\theta_{0})$ 可以得到一个线性简化 $p_{1}=3p_{0}$，这是错误的。\n- E 计算了三次迭代，并检查在第3步返回，同时明确排除了在第1步和第2步返回的情况，这与使用规定的数值容差和环形角度比较的定义完全匹配。\n\n因此，正确的计算流程是选项 E。", "answer": "$$\\boxed{E}$$", "id": "2085863"}]}