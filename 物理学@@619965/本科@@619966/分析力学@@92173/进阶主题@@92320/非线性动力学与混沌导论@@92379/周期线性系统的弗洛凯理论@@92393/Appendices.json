{"hands_on_practices": [{"introduction": "弗洛凯理论是线性时不变 (LTI) 系统理论的推广。为建立这种联系，我们的第一个练习将探讨一个常系数矩阵系统，并计算其传单矩阵。这个练习将展示弗洛凯理论的框架如何自然地包含我们熟悉的更简单的情况，并巩固计算矩阵指数的核心技能 [@problem_id:2050330]。", "problem": "考虑一个二维线性动力学系统，其状态向量为 $\\mathbf{x}(t) = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}$。系统的演化由矩阵微分方程 $\\dot{\\mathbf{x}} = A\\mathbf{x}$ 所支配，其中常数矩阵 $A$ 由下式给出：\n$$\nA = \\begin{pmatrix} \\alpha & -\\beta \\\\ \\beta & \\alpha \\end{pmatrix}\n$$\n其中 $\\alpha$ 和 $\\beta$ 为实值常数。\n\n在弗洛凯理论 (Floquet theory) 的背景下，一个具有常系数矩阵 $A$ 的系统是一个具有时周期矩阵 $A(t)$ 的系统的特例，该时周期矩阵满足 $A(t+T) = A(t)$ 对于任意周期 $T > 0$。你的任务是将此框架应用于给定的常系数系统。\n\n确定与该系统相关的、对于任意周期 $T$ 的传单矩阵 $M$。", "solution": "我们考虑线性时不变系统 $\\dot{\\mathbf{x}} = A \\mathbf{x}$，其中 $A$ 为常数矩阵。初始条件为 $\\Phi(0) = I$ 的基本矩阵 $\\Phi(t)$ 由矩阵指数给出：\n$$\n\\Phi(t) = \\exp(A t),\n$$\n因为它满足 $\\frac{d}{dt}\\Phi(t) = A \\Phi(t)$ 和 $\\Phi(0) = I$。在弗洛凯理论中，周期 $T$ 上的传单矩阵 $M$ 定义为\n$$\nM = \\Phi(T) = \\exp(A T).\n$$\n\n为了计算\n$$\nA = \\begin{pmatrix} \\alpha & -\\beta \\\\ \\beta & \\alpha \\end{pmatrix}\n$$\n的 $\\exp(A T)$，我们将 $A$ 分解为\n$$\nA = \\alpha I + \\beta J, \\quad I = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}, \\quad J = \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix}.\n$$\n由于 $I$ 和 $J$ 可交换，我们使用可交换矩阵的性质 $\\exp(B+C) = \\exp(B)\\exp(C)$ 来写出\n$$\n\\exp(A T) = \\exp(\\alpha T I + \\beta T J) = \\exp(\\alpha T I)\\exp(\\beta T J) = \\exp(\\alpha T) I \\cdot \\exp(\\beta T J).\n$$\n我们使用级数和恒等式 $J^{2} = -I$，$J^{3} = -J$，$J^{4} = I$ 来计算 $\\exp(\\beta T J)$：\n$$\n\\exp(\\beta T J) = \\sum_{k=0}^{\\infty} \\frac{(\\beta T)^{k}}{k!} J^{k} = \\left(\\sum_{m=0}^{\\infty} \\frac{(-1)^{m} (\\beta T)^{2m}}{(2m)!}\\right) I + \\left(\\sum_{m=0}^{\\infty} \\frac{(-1)^{m} (\\beta T)^{2m+1}}{(2m+1)!}\\right) J = \\cos(\\beta T) I + \\sin(\\beta T) J.\n$$\n将 $J$ 显式代入，\n$$\n\\exp(\\beta T J) = \\cos(\\beta T) \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} + \\sin(\\beta T) \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix} = \\begin{pmatrix} \\cos(\\beta T) & -\\sin(\\beta T) \\\\ \\sin(\\beta T) & \\cos(\\beta T) \\end{pmatrix}.\n$$\n因此，\n$$\nM = \\exp(A T) = \\exp(\\alpha T) \\begin{pmatrix} \\cos(\\beta T) & -\\sin(\\beta T) \\\\ \\sin(\\beta T) & \\cos(\\beta T) \\end{pmatrix}.\n$$\n这就是对于任意周期 $T$ 的传单矩阵。", "answer": "$$\\boxed{\\exp(\\alpha T)\\begin{pmatrix}\\cos(\\beta T)&-\\sin(\\beta T)\\\\ \\sin(\\beta T)&\\cos(\\beta T)\\end{pmatrix}}$$", "id": "2050330"}, {"introduction": "许多周期系统的系数矩阵并非恒定，而是随时间分段变化的。这个练习模拟了一个由周期性方波驱动的系统，其系统矩阵在两个不同状态之间切换。通过这个练习，你将学会如何通过组合每个时间段的演化来计算整个周期的传单矩阵，这是分析分段常数系统的关键技巧 [@problem_id:2050331]。", "problem": "考虑一个由$\\frac{d\\mathbf{x}}{dt} = A(t)\\mathbf{x}$描述的二维线性常微分方程组，其中$\\mathbf{x}(t) = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}$是状态向量。该系统由一个周期为$T > 0$的时间周期矩阵$A(t)$驱动。在一个周期内，$0 \\le t < T$，矩阵$A(t)$被分段定义如下：\n\n$$\nA(t) = \\begin{cases}\nA_1 & \\text{for } 0 \\le t < \\frac{T}{2} \\\\\nA_2 & \\text{for } \\frac{T}{2} \\le t < T\n\\end{cases}\n$$\n\n其中$A_1$和$A_2$是给定的常数矩阵：\n\n$$\nA_1 = \\begin{pmatrix} 0 & \\alpha \\\\ 0 & 0 \\end{pmatrix}, \\quad A_2 = \\begin{pmatrix} 0 & 0 \\\\ \\alpha & 0 \\end{pmatrix}\n$$\n\n这里，$\\alpha$是一个非零实常数。根据弗洛凯定理，系统经过一个完整周期后的状态通过一个称为传单矩阵的常数矩阵$M$与其初始状态相关联，即$\\mathbf{x}(T) = M \\mathbf{x}(0)$。\n\n确定该系统的传单矩阵$M$的显式形式。", "solution": "本问题要求解系统$\\frac{d\\mathbf{x}}{dt} = A(t)\\mathbf{x}$的传单矩阵$M$，其中$A(t)$是一个周期为$T$的分段常数矩阵。传单矩阵$M$通过$\\mathbf{x}(T) = M\\mathbf{x}(0)$将$t=0$时刻的解与$t=T$时刻的解联系起来。\n\n我们可以通过将系统在一个完整周期内（从$t=0$到$t=T$）积分来求得传单矩阵。由于矩阵$A(t)$是分段常数的，我们可以分别求解每个区间上的系统，然后将解复合起来。\n\n**步骤1：在区间 $0 \\le t < T/2$ 上求解系统。**\n在此区间上，系统为$\\frac{d\\mathbf{x}}{dt} = A_1\\mathbf{x}$，其中$A_1 = \\begin{pmatrix} 0 & \\alpha \\\\ 0 & 0 \\end{pmatrix}$。这是一个常系数线性系统。其解由$\\mathbf{x}(t) = \\exp(A_1 t) \\mathbf{x}(0)$给出。\n为了求得此区间末端（$t=T/2$）的状态，我们需要计算矩阵指数$\\exp(A_1 T/2)$。\n我们来计算$A_1$的幂：\n$A_1^2 = \\begin{pmatrix} 0 & \\alpha \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} 0 & \\alpha \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}$。\n由于$A_1^2$是零矩阵，所以$A_1$是幂零矩阵，所有$n \\ge 2$的高阶幂$A_1^n$也都是零矩阵。矩阵指数的泰勒级数会截断：\n$\\exp(A_1 t) = I + A_1 t + \\frac{(A_1 t)^2}{2!} + \\dots = I + A_1 t$。\n代入矩阵$A_1$和$t=T/2$：\n$\\exp\\left(A_1 \\frac{T}{2}\\right) = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} + \\begin{pmatrix} 0 & \\alpha \\\\ 0 & 0 \\end{pmatrix} \\frac{T}{2} = \\begin{pmatrix} 1 & \\frac{\\alpha T}{2} \\\\ 0 & 1 \\end{pmatrix}$。\n因此，系统在$t=T/2$时的状态为：\n$\\mathbf{x}(T/2) = \\exp\\left(A_1 \\frac{T}{2}\\right) \\mathbf{x}(0) = \\begin{pmatrix} 1 & \\frac{\\alpha T}{2} \\\\ 0 & 1 \\end{pmatrix} \\mathbf{x}(0)$。\n\n**步骤2：在区间 $T/2 \\le t < T$ 上求解系统。**\n在此区间上，系统为$\\frac{d\\mathbf{x}}{dt} = A_2\\mathbf{x}$，其中$A_2 = \\begin{pmatrix} 0 & 0 \\\\ \\alpha & 0 \\end{pmatrix}$。解将时刻$t$的状态与区间起点$t_0 = T/2$的状态联系起来：\n$\\mathbf{x}(t) = \\exp(A_2 (t - T/2)) \\mathbf{x}(T/2)$。\n为了求得$t=T$时的状态，我们在上述表达式中令$t=T$：\n$\\mathbf{x}(T) = \\exp(A_2 (T - T/2)) \\mathbf{x}(T/2) = \\exp\\left(A_2 \\frac{T}{2}\\right) \\mathbf{x}(T/2)$。\n我们需要计算矩阵指数$\\exp(A_2 T/2)$。我们来计算$A_2$的幂：\n$A_2^2 = \\begin{pmatrix} 0 & 0 \\\\ \\alpha & 0 \\end{pmatrix} \\begin{pmatrix} 0 & 0 \\\\ \\alpha & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}$。\n与$A_1$类似，$A_2$也是幂零的。其指数的级数会截断：\n$\\exp(A_2 t) = I + A_2 t$。\n代入$t=T/2$：\n$\\exp\\left(A_2 \\frac{T}{2}\\right) = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} + \\begin{pmatrix} 0 & 0 \\\\ \\alpha & 0 \\end{pmatrix} \\frac{T}{2} = \\begin{pmatrix} 1 & 0 \\\\ \\frac{\\alpha T}{2} & 1 \\end{pmatrix}$。\n\n**步骤3：组合解以求得传单矩阵。**\n现在我们将两个区间的结果组合起来。我们有：\n$\\mathbf{x}(T) = \\exp\\left(A_2 \\frac{T}{2}\\right) \\mathbf{x}(T/2)$\n以及\n$\\mathbf{x}(T/2) = \\exp\\left(A_1 \\frac{T}{2}\\right) \\mathbf{x}(0)$。\n将第二个方程代入第一个方程，得到$\\mathbf{x}(T)$和$\\mathbf{x}(0)$之间的关系：\n$\\mathbf{x}(T) = \\left( \\exp\\left(A_2 \\frac{T}{2}\\right) \\exp\\left(A_1 \\frac{T}{2}\\right) \\right) \\mathbf{x}(0)$。\n根据传单矩阵的定义，$\\mathbf{x}(T) = M\\mathbf{x}(0)$，我们可以确定$M$是两个矩阵指数的乘积：\n$M = \\exp\\left(A_2 \\frac{T}{2}\\right) \\exp\\left(A_1 \\frac{T}{2}\\right)$。\n现在，我们进行矩阵乘法：\n$M = \\begin{pmatrix} 1 & 0 \\\\ \\frac{\\alpha T}{2} & 1 \\end{pmatrix} \\begin{pmatrix} 1 & \\frac{\\alpha T}{2} \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} (1)(1) + (0)(0) & (1)\\left(\\frac{\\alpha T}{2}\\right) + (0)(1) \\\\ \\left(\\frac{\\alpha T}{2}\\right)(1) + (1)(0) & \\left(\\frac{\\alpha T}{2}\\right)\\left(\\frac{\\alpha T}{2}\\right) + (1)(1) \\end{pmatrix}$。\n$M = \\begin{pmatrix} 1 & \\frac{\\alpha T}{2} \\\\ \\frac{\\alpha T}{2} & 1 + \\frac{\\alpha^2 T^2}{4} \\end{pmatrix}$。\n\n这就是给定系统的传单矩阵。", "answer": "$$\\boxed{\\begin{pmatrix} 1 & \\frac{\\alpha T}{2} \\\\ \\frac{\\alpha T}{2} & 1 + \\frac{\\alpha^{2} T^{2}}{4} \\end{pmatrix}}$$", "id": "2050331"}, {"introduction": "对于许多复杂的真实世界系统，通常无法找到传单矩阵的精确解析解，此时我们必须依赖数值方法。这个练习将指导你如何利用数值模拟数据来构建传单矩阵，并进而计算弗洛凯乘子。这个过程将抽象的理论与实际的计算问题联系起来，展示了当解析方法不可行时，如何进行稳定性分析 [@problem_id:2050306]。", "problem": "一个二维线性动力学系统被用来模拟一对耦合的阻尼振荡器。系统的状态由向量 $\\mathbf{x}(t) = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}$ 给出。其演化由矩阵微分方程 $\\frac{d\\mathbf{x}}{dt} = A(t) \\mathbf{x}$ 控制，其中时变矩阵 $A(t)$ 由以下公式给出：\n$$\nA(t) = \\begin{pmatrix} -\\gamma & \\alpha \\cos(\\omega t) \\\\ \\alpha \\cos(\\omega t) & -\\gamma \\end{pmatrix}\n$$\n系统参数为 $\\gamma = 0.1$，$\\alpha = 0.5$ 和 $\\omega = 2$。\n\n系统的自然周期为 $T = \\frac{2\\pi}{\\omega}$。系统经过一个完整周期后的状态 $\\mathbf{x}(T)$ 与初始状态 $\\mathbf{x}(0)$ 通过一个常数 $2 \\times 2$ 矩阵 $M$ 相关联，使得 $\\mathbf{x}(T) = M \\mathbf{x}(0)$。系统长期行为的稳定性由该矩阵 $M$ 的特征值决定，这些特征值被称为弗洛凯乘子 (Floquet multipliers)。\n\n为了确定矩阵 $M$，通过将系统在一个周期 $T$ 上进行积分，进行了两次数值模拟。\n1.  对于初始条件 $\\mathbf{x}_a(0) = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，在时间 $T$ 时的状态被发现是 $\\mathbf{x}_a(T) = \\begin{pmatrix} 0.7000 \\\\ -0.4825 \\end{pmatrix}$。\n2.  对于初始条件 $\\mathbf{x}_b(0) = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$，在时间 $T$ 时的状态被发现是 $\\mathbf{x}_b(T) = \\begin{pmatrix} -0.2000 \\\\ 0.9000 \\end{pmatrix}$。\n\n使用这些信息，确定系统的两个弗洛凯乘子。将两个乘子表示为一对，较大值在前。将您的最终答案四舍五入到四位有效数字。", "solution": "该系统是线性的，周期为 $T=\\frac{2\\pi}{\\omega}$。设 $\\Phi(t)$ 是满足 $\\frac{d\\Phi}{dt}=A(t)\\Phi$ 且 $\\Phi(0)=I$ 的基本矩阵。传单矩阵是 $M=\\Phi(T)$，对于任何初始条件 $\\mathbf{x}(0)$，一个周期后的状态是 $\\mathbf{x}(T)=M\\mathbf{x}(0)$。因此，$M$ 的列是通过将标准基向量演化一个周期得到的：\n$$\nM=\\begin{pmatrix} \\mathbf{x}_{a}(T) & \\mathbf{x}_{b}(T) \\end{pmatrix}\n=\\begin{pmatrix} 0.7000 & -0.2000 \\\\ -0.4825 & 0.9000 \\end{pmatrix}.\n$$\n弗洛凯乘子是 $M$ 的特征值，即特征多项式的根\n$$\np(\\lambda)=\\det(M-\\lambda I)=\\lambda^{2}-(\\operatorname{tr}M)\\lambda+\\det M.\n$$\n计算迹和行列式：\n$$\n\\operatorname{tr}M=0.7000+0.9000=1.6000,\\quad\n\\det M=(0.7000)(0.9000)-(-0.2000)(-0.4825)=0.6300-0.0965=0.5335.\n$$\n因此特征值满足\n$$\n\\lambda^{2}-1.6\\lambda+0.5335=0,\n$$\n所以\n$$\n\\lambda=\\frac{1.6\\pm\\sqrt{1.6^{2}-4\\cdot 0.5335}}{2}\n=\\frac{1.6\\pm\\sqrt{2.56-2.134}}{2}\n=\\frac{1.6\\pm\\sqrt{0.426}}{2}.\n$$\n计算平方根得出 $\\sqrt{0.426}\\approx 0.65268675$，因此\n$$\n\\lambda_{1}=\\frac{1.6+0.65268675}{2}\\approx 1.126343375,\\quad\n\\lambda_{2}=\\frac{1.6-0.65268675}{2}\\approx 0.473656625.\n$$\n从大到小排序并四舍五入到四位有效数字，得到弗洛凯乘子 $1.126$ 和 $0.4737$。", "answer": "$$\\boxed{(1.126, 0.4737)}$$", "id": "2050306"}]}