{"hands_on_practices": [{"introduction": "本练习为使用辛积分器提供了一个具体的起点。通过手动计算辛欧拉B法（Symplectic Euler B method）的一个时间步，您将亲身体验位置和动量是如何以一种顺序、半隐式的方式更新的。这种基础练习对于建立数值积分机制的直观理解至关重要。[@problem_id:2060449]", "problem": "一个粒子在一维相空间中的状态由其位置 $q$ 和动量 $p$ 描述。该系统的演化方程为：\n$$ \\frac{dq}{dt} = p $$\n$$ \\frac{dp}{dt} = -\\sin(q) $$\n为了数值近似粒子的轨迹，我们使用一种辛积分格式。根据辛欧拉B方法，将状态从时间 $t_n$ 的 $(q_n, p_n)$ 推进到时间 $t_{n+1} = t_n + \\Delta t$ 的 $(q_{n+1}, p_{n+1})$ 的更新规则如下：\n1.  更新位置：$q_{n+1} = q_n + \\Delta t \\cdot p_n$\n2.  更新动量：$p_{n+1} = p_n - \\Delta t \\cdot \\sin(q_{n+1})$\n\n请注意，动量更新使用了新计算出的位置 $q_{n+1}$。\n\n给定粒子的初始状态为 $(q_0, p_0) = (0, 1)$，请确定经过一个时长为 $\\Delta t$ 的时间步长后系统的状态 $(q_1, p_1)$。请将您的答案表示为 $q_1$ 和 $p_1$ 关于 $\\Delta t$ 的表达式对。", "solution": "我们已知该系统的演化方程为 $dq/dt=p$ 和 $dp/dt=-\\sin(q)$，以及辛欧拉B方法的更新规则：\n$$q_{n+1}=q_{n}+\\Delta t\\, p_{n},$$\n$$p_{n+1}=p_{n}-\\Delta t\\, \\sin(q_{n+1}).$$\n对于初始状态 $(q_{0},p_{0})=(0,1)$，将 $n=0$ 代入位置更新公式：\n$$q_{1}=q_{0}+\\Delta t\\, p_{0}=0+\\Delta t \\cdot 1=\\Delta t.$$\n接下来，使用新计算出的 $q_{1}$ 进行动量更新：\n$$p_{1}=p_{0}-\\Delta t\\, \\sin(q_{1})=1-\\Delta t\\, \\sin(\\Delta t).$$\n因此，经过一个时长为 $\\Delta t$ 的时间步长后，系统状态为 $(q_{1},p_{1})=(\\Delta t,\\;1-\\Delta t\\, \\sin(\\Delta t))$。", "answer": "$$\\boxed{\\begin{pmatrix}\\Delta t & 1-\\Delta t \\sin(\\Delta t)\\end{pmatrix}}$$", "id": "2060449"}, {"introduction": "在学习了基本机理之后，我们现在来探索辛积分器的决定性特征：相空间面积守恒。本练习将非辛的前向欧拉法（Forward Euler method）与辛欧拉A法（Symplectic Euler A method）的行为进行对比，展示它们如何变换相空间中的一个区域。计算面积的变化为我们提供了一个直接的、定量的证据，说明了为什么辛方法对于保持哈密顿系统的几何结构至关重要。[@problem_id:2060446]", "problem": "在哈密顿系统的数值模拟中，一个基本概念是相空间体积的守恒，这一性质被称为辛性。本问题通过研究非辛积分格式和辛积分格式如何变换相空间中的面积元，来探讨它们之间的差异。\n\n考虑一个一维谐振子，其动力学由无量纲哈密顿量 $H(q, p) = \\frac{1}{2}(p^2 + q^2)$ 决定，其中 $q$ 是位置，$p$ 是动量。相应的运动方程为 $\\dot{q} = p$ 和 $\\dot{p} = -q$。\n\n我们将使用两种不同的数值积分格式，以固定的时间步长 $\\Delta t$ 来分析该系统的演化。\n\n**方法1（前向欧拉法）：**\n在时间步 $n+1$ 的状态 $(q_{n+1}, p_{n+1})$ 是通过使用前向欧拉法，从时间步 $n$ 的状态 $(q_n, p_n)$ 计算得出的：\n$$q_{n+1} = q_n + \\Delta t \\cdot p_n$$\n$$p_{n+1} = p_n - \\Delta t \\cdot q_n$$\n\n**方法2（辛欧拉A法）：**\n该状态使用如下的半隐式或辛欧拉格式进行更新：\n$$p_{n+1} = p_n - \\Delta t \\cdot q_n$$\n$$q_{n+1} = q_n + \\Delta t \\cdot p_{n+1}$$\n\n相空间中一个初始的小方形区域由其四个顶点定义，中心位于 $(q_c, p_c) = (1.2, 0.5)$。这些顶点位于 $(1.2 \\pm 0.01, 0.5 \\pm 0.01)$。\n\n使用方法1和方法2，对这四个顶点应用大小为 $\\Delta t = 0.15$ 的单个时间步。这将初始的正方形变换为两个不同的平行四边形。设 $A_{FE}$ 为方法1得到的平行四边形的面积，$A_{SEA}$ 为方法2得到的平行四边形的面积。\n\n计算比率 $\\frac{A_{FE}}{A_{SEA}}$。将你的答案以四舍五入到四位有效数字的形式给出。", "solution": "我们考虑每种方法单步演化所引起的线性映射。对于一个线性更新 $(q_{n+1},p_{n+1})^{T} = M (q_{n},p_{n})^{T}$，任何小区域的面积都会乘以 $|\\det M|$。由于谐振子和这两种积分格式都是关于 $(q,p)$ 线性的，雅可比矩阵在整个相平面上是常数，因此面积的缩放对于整个区域都是相同的，与其中心和大小无关。\n\n设 $h=\\Delta t$。\n\n方法1（前向欧拉法）：更新方式为\n$$\n\\begin{pmatrix}\nq_{n+1}\\\\\np_{n+1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & h\\\\\n-h & 1\n\\end{pmatrix}\n\\begin{pmatrix}\nq_{n}\\\\\np_{n}\n\\end{pmatrix}.\n$$\n因此 $M_{FE}=\\begin{pmatrix}1 & h\\\\ -h & 1\\end{pmatrix}$ 且\n$$\n\\det M_{FE} = 1\\cdot 1 - (h)(-h) = 1 + h^{2}.\n$$\n因此，面积缩放为 $A_{FE} = (1+h^{2})A_{0}$，其中 $A_{0}$ 是初始正方形的面积。\n\n方法2（辛欧拉A法）：更新方式为\n$$\np_{n+1}=p_{n}-h q_{n},\\qquad q_{n+1}=q_{n}+h p_{n+1}=q_{n}+h p_{n}-h^{2} q_{n}=(1-h^{2})q_{n}+h p_{n}.\n$$\n因此\n$$\n\\begin{pmatrix}\nq_{n+1}\\\\\np_{n+1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1-h^{2} & h\\\\\n-h & 1\n\\end{pmatrix}\n\\begin{pmatrix}\nq_{n}\\\\\np_{n}\n\\end{pmatrix},\n$$\n所以 $M_{SEA}=\\begin{pmatrix}1-h^{2} & h\\\\ -h & 1\\end{pmatrix}$ 且\n$$\n\\det M_{SEA}=(1-h^{2})\\cdot 1 - h(-h) = 1-h^{2}+h^{2}=1.\n$$\n因此 $A_{SEA}=A_{0}$。\n\n所求的比率为\n$$\n\\frac{A_{FE}}{A_{SEA}}=\\frac{(1+h^{2})A_{0}}{A_{0}}=1+h^{2}.\n$$\n当 $h=\\Delta t=0.15$ 时，我们得到\n$$\n\\frac{A_{FE}}{A_{SEA}}=1+0.15^{2}=1.0225,\n$$\n四舍五入到四位有效数字后为 $1.023$。", "answer": "$$\\boxed{1.023}$$", "id": "2060446"}, {"introduction": "相空间结构的保持带来了卓越的长期稳定性，但这种稳定性并非没有限制。本练习深入探讨了数值稳定性的关键概念，通过分析应用于简谐振子的辛欧拉A法来实现。确定使模拟保持有界的允许最大时间步长 $\\Delta t$，是有效实现任何数值积分器的一项至关重要的技能。[@problem_id:2060479]", "problem": "辛积分器是一类为求解哈密顿运动方程而设计的数值方法，对于天体力学等保守系统的长期模拟尤为有效。其主要优点是能保持相空间的辛结构，这带来了优异的长期能量守恒特性。\n\n考虑一个位置为 $q$、角频率为常数 $\\omega$ 的一维简谐振子。其运动方程由下式给出：\n$$\n\\frac{d^2q}{dt^2} = -\\omega^2 q\n$$\n我们希望使用辛欧拉A算法对此方程进行数值求解。该方法将系统离散化为大小为 $\\Delta t > 0$ 的时间步。给定在时刻 $t_n$ 的状态 $(q_n, v_n)$，其中 $v_n = \\frac{dq}{dt}|_{t=t_n}$，在时刻 $t_{n+1} = t_n + \\Delta t$ 的状态通过以下两步计算得出：\n1.  更新速度：$v_{n+1} = v_n - \\omega^2 q_n \\Delta t$\n2.  更新位置：$q_{n+1} = q_n + v_{n+1} \\Delta t$\n\n如果计算出的量（在此例中为位置和速度）在所有积分步中都保持有界，则该数值积分格式被认为是稳定的。此要求对时间步长 $\\Delta t$ 的最大允许值施加了一个约束。\n\n确定当辛欧拉A方法应用于简谐振子时，能使其保持稳定的最大时间步长 $\\Delta t_{\\text{max}}$（作为 $\\omega$ 的函数）。", "solution": "我们将辛欧拉A算法的更新步骤写成矩阵形式。根据\n$$\nv_{n+1} = v_n - \\omega^{2} q_n \\Delta t, \\qquad q_{n+1} = q_n + v_{n+1} \\Delta t,\n$$\n将 $v_{n+1}$ 代入 $q_{n+1}$ 中可得\n$$\nq_{n+1} = \\left(1 - \\omega^{2} \\Delta t^{2}\\right) q_n + \\Delta t\\, v_n, \\qquad v_{n+1} = -\\omega^{2} \\Delta t\\, q_n + v_n.\n$$\n定义状态向量 $y_n = \\begin{pmatrix} q_n \\\\ v_n \\end{pmatrix}$。则单步映射是线性的：\n$$\ny_{n+1} = M\\, y_n, \\quad M = \\begin{pmatrix} 1 - \\omega^{2} \\Delta t^{2} & \\Delta t \\\\ -\\omega^{2} \\Delta t & 1 \\end{pmatrix}.\n$$\n该线性递推关系的稳定性由矩阵 $M$ 的特征值决定。计算其行列式和迹：\n$$\n\\det(M) = \\left(1 - \\omega^{2} \\Delta t^{2}\\right)\\cdot 1 - \\Delta t \\cdot \\left(-\\omega^{2} \\Delta t\\right) = 1, \\qquad \\operatorname{tr}(M) = \\left(1 - \\omega^{2} \\Delta t^{2}\\right) + 1 = 2 - \\omega^{2} \\Delta t^{2}.\n$$\n由于 $\\det(M)=1$，特征多项式为\n$$\n\\lambda^{2} - \\operatorname{tr}(M)\\, \\lambda + 1 = 0.\n$$\n为使迭代值在所有步数和所有初始条件下都保持有界，特征值必须位于单位圆上，并且映射必须是非亏损的。对于一个 $\\det(M)=1$ 的 $2 \\times 2$ 实矩阵，这当且仅当 $|\\operatorname{tr}(M)| < 2$ 时发生，这确保了特征值为模为1的共轭复数。根据 $\\operatorname{tr}(M) = 2 - \\omega^{2} \\Delta t^{2}$，条件\n$$\n|\\operatorname{tr}(M)| < 2\n$$\n等价于\n$$\n|2 - \\omega^{2} \\Delta t^{2}| < 2 \\quad \\Longleftrightarrow \\quad 0 < \\omega^{2} \\Delta t^{2} < 4.\n$$\n因为 $\\Delta t > 0$，可得出\n$$\n\\Delta t < \\frac{2}{\\omega}.\n$$\n因此，保证稳定性的最大允许时间步长为\n$$\n\\Delta t_{\\text{max}} = \\frac{2}{\\omega}.\n$$\n在端点 $\\Delta t = \\frac{2}{\\omega}$ 处，迹等于 $-2$，得到一个重特征值 $-1$ 和一个亏损矩阵（不等于 $-I$），这会导致线性增长，从而失去有界性。因此，需要严格不等式，最大允许时间步长是 $\\frac{2}{\\omega}$。", "answer": "$$\\boxed{\\frac{2}{\\omega}}$$", "id": "2060479"}]}