{"hands_on_practices": [{"introduction": "我们的实践始于图像传感器本身。焦深（Depth of Focus）是景深（Depth of Field）在图像空间的对应概念，它描述了传感器可以沿光轴移动多大距离而图像模糊仍在可接受范围内。这个练习将焦深与一个非常实际的工程参数——数码相机的像素尺寸——直接联系起来，帮助你理解光学公差如何由成像系统的物理硬件决定。[@problem_id:2225440]", "problem": "我们正在设计一台用于天文摄影的数码相机，其拍摄对象（恒星和遥远的星系）实际上距离相机无限远。该相机使用一个焦距为 $f$ 的简单薄透镜。透镜的光圈可以调节，其有效直径由f数 $N$ 描述，f数是焦距与光圈直径的比值。相机的传感器是一个平面，由方形像素网格组成，每个像素的边长为 $p$。\n\n为了使图像被认为是可接受的清晰对焦，来自无限远处点光源的模糊（称为弥散圆）的直径不得大于单个像素的宽度。焦深是指在保持这种可接受清晰度的情况下，传感器可以沿光轴向着透镜或远离透镜移动的总距离。\n\n假设相机对无限远处的物体完美对焦，请推导总焦深 $\\delta_{focus}$ 的表达式，用f数 $N$ 和像素宽度 $p$ 表示。", "solution": "对于一个对焦于无限远的薄透镜，像平面位于焦距处，因此最佳对焦传感器位置距离透镜为 $f$。设透镜光圈直径为 $D$。根据f数的定义，$N = f/D$，因此\n$$\nD = \\frac{f}{N}.\n$$\n当传感器沿光轴从最佳对焦平面（正向或负向）位移一个微小距离 $s$ 时，来自无限远一点的光束形成一个以焦点为顶点的圆锥体。在距离顶点为 $f$ 的透镜平面上，该圆锥体的直径为 $D$。根据相似三角形原理，在距离顶点 $|s|$ 的平面上，离焦模糊圆的直径 $c$ 为\n$$\nc = D \\frac{|s|}{f}.\n$$\n可接受的清晰度条件要求弥散圆不超过像素宽度 $p$，即：\n$$\nc \\leq p \\quad \\Rightarrow \\quad D \\frac{|s|}{f} \\leq p.\n$$\n求解最大允许位移的大小，\n$$\n|s|_{\\max} = \\frac{p f}{D} = \\frac{p f}{f/N} = p N.\n$$\n总焦深是传感器朝向和远离透镜的全部允许移动距离，这是单侧容差的两倍：\n$$\n\\delta_{focus} = 2 |s|_{\\max} = 2 N p.\n$$", "answer": "$$\\boxed{2 N p}$$", "id": "2225440"}, {"introduction": "掌握了图像空间的公差后，我们现在转向物空间，探索摄影师更熟悉的景深概念。在许多场景下，例如风景或监视摄影，目标是最大化清晰对焦的范围。这个练习将向你介绍超焦距这一强大技术，通过将焦点设置在特定距离上，可以使从某个最近点到无穷远的整个场景都保持在可接受的清晰度内。[@problem_id:2225441]", "problem": "一台高分辨率监控摄像头被安装用于监视一条狭长笔直的小巷。该摄像头的镜头系统可以被建模为一个焦距为 $f = 85.0$ mm 的单薄透镜。操作员将镜头光圈调整至 f 值（光圈系数）为 $N = 5.60$。对于该摄像头的传感器，任何模糊成直径小于或等于“弥散圆”直径 $c = 0.0250$ mm 的图像特征，都被认为是“可接受的清晰”。\n\n为了最大化被监控区域的整体景深，摄像头以一种特殊方式对焦，使得可接受清晰度的最远极限延伸至无穷远。请确定一个物体在保持可接受清晰度的前提下，可以离摄像头最近的距离。\n\n以米为单位表示最终答案，并四舍五入到三位有效数字。", "solution": "我们将镜头建模为薄透镜，并使用近轴光学。设 $f$ 为焦距，$N$ 为 f 值，$c$ 为传感器上可接受的弥散圆直径，$D$ 为光圈直径。根据 f 值的定义，$D = \\frac{f}{N}$。\n\n为了使可接受清晰度的远极限在无穷远处，对焦距离必须是超焦距。当镜头对焦于物距为 $s_{0}$ 的物体时，其像距为 $b_{0}$，此时位于无穷远处的物体会在像距 $b = f$ 处形成清晰的像。对于无穷远处的物体，其在像距为 $b_{0}$ 的传感器平面上形成的弥散圆直径可由相似三角形得出：\n$$\nc = D \\frac{b_{0} - f}{f}.\n$$\n代入 $D = \\frac{f}{N}$ 可得\n$$\nc = \\frac{f}{N} \\cdot \\frac{b_{0} - f}{f} = \\frac{b_{0} - f}{N} \\quad \\Rightarrow \\quad b_{0} = f + N c.\n$$\n薄透镜公式关联了 $s_{0}$ 和 $b_{0}$：\n$$\n\\frac{1}{s_{0}} + \\frac{1}{b_{0}} = \\frac{1}{f} \\quad \\Rightarrow \\quad \\frac{1}{s_{0}} = \\frac{1}{f} - \\frac{1}{b_{0}} = \\frac{b_{0} - f}{f b_{0}} = \\frac{N c}{f b_{0}}.\n$$\n因此\n$$\ns_{0} = \\frac{f b_{0}}{N c} = \\frac{f(f + N c)}{N c} = \\frac{f^{2}}{N c} + f \\equiv H,\n$$\n此即超焦距 $H$ （从透镜处测量）。\n\n接下来，确定当对焦在 $s_{0} = H$ 时，仍能保持可接受清晰度的最近物距 $s_{n}$。对于位于 $s_{n}$ 处的物体，其像距为 $b = \\frac{f s_{n}}{s_{n} - f}$，而传感器位置保持在 $b_{0} = \\frac{f s_{0}}{s_{0} - f}$。在传感器上的弥散圆直径为\n$$\nc = D \\frac{b - b_{0}}{b} = \\frac{f}{N} \\left(1 - \\frac{b_{0}}{b}\\right) = \\frac{f}{N} \\left(1 - \\frac{\\frac{f s_{0}}{s_{0} - f}}{\\frac{f s_{n}}{s_{n} - f}}\\right) = \\frac{f}{N} \\left(1 - \\frac{s_{0}(s_{n} - f)}{s_{n}(s_{0} - f)}\\right).\n$$\n代数化简后得到\n$$\nc = \\frac{f^{2}}{N} \\cdot \\frac{s_{0} - s_{n}}{s_{n}(s_{0} - f)}.\n$$\n求解 $s_{n}$ 可得\n$$\nc N \\, s_{n} (s_{0} - f) = f^{2} (s_{0} - s_{n})\n\\quad \\Rightarrow \\quad\ns_{n} \\left[f^{2} + c N (s_{0} - f)\\right] = f^{2} s_{0}\n\\quad \\Rightarrow \\quad\ns_{n} = \\frac{f^{2} s_{0}}{f^{2} + c N (s_{0} - f)}.\n$$\n使用 $H = \\frac{f^{2}}{N c} + f$ 意味着 $N c = \\frac{f^{2}}{H - f}$，并代入 $s_{0} = H$ 可得\n$$\ns_{n} = \\frac{f^{2} H}{f^{2} + \\frac{f^{2}}{H - f} (H - f)} = \\frac{f^{2} H}{2 f^{2}} = \\frac{H}{2}.\n$$\n因此，当对焦在超焦距 $H$ 时，可接受清晰度的最近物距等于 $\\frac{H}{2}$。\n\n使用 $f = 85.0 \\text{ mm}$，$N = 5.60$ 和 $c = 0.0250 \\text{ mm}$ 进行数值计算 $H$：\n$$\nH = \\frac{f^{2}}{N c} + f = \\frac{(85.0)^{2}}{5.60 \\times 0.0250} + 85.0 \\text{ mm}.\n$$\n计算：\n$$\n\\frac{(85.0)^{2}}{5.60 \\times 0.0250} = \\frac{7225}{0.14} = 51607.142857\\ldots \\text{ mm},\n\\quad\nH = 51692.142857\\ldots \\text{ mm}.\n$$\n因此最近距离是\n$$\ns_{n} = \\frac{H}{2} = 25846.0714285\\ldots \\text{ mm} = 25.8460714285\\ldots \\text{ m}.\n$$\n以米为单位，四舍五入到三位有效数字，结果是 $25.8$。", "answer": "$$\\boxed{25.8}$$", "id": "2225441"}, {"introduction": "在处理了具体应用和实用近似之后，现在是时候从第一性原理出发，建立一个普遍适用的景深模型了。这个终极练习要求你推导出一个严格、无近似的景深完整表达式，只依赖于焦距 $f$、物距 $s_o$、光圈直径 $D$ 和弥散圆直径 $c$ 这些基本参数。完成这个推导不仅能巩固你对所有相关概念的理解，还能让你深入洞察这些变量之间复杂的相互作用。[@problem_id:2225413]", "problem": "一台相机配备了高质量的齐焦变焦镜头，该镜头可在焦距变化时保持对固定距离处主体的对焦。\n\n为进行此分析，该镜头可被建模为一个具有可变焦距 $f$ 和恒定物理光圈直径 $D$ 的简单薄透镜。\n\n该镜头完美地对焦在距其前主平面固定距离 $s_o$ 处的主体上。图像的可接受清晰度由像方传感器上允许的最大弥散圆（Circle of Confusion, CoC）直径 $c$ 定义。\n\n请推导一个严格、无近似的总景深（Depth of Field, DOF）表达式，景深是指被认为清晰对焦的最近点与最远点之间的距离。您的表达式应给出总景深作为焦距 $f$ 的函数，并且必须仅用 $f$、$s_o$、$D$ 和 $c$ 来表示。", "solution": "对于物距 $s_{o}$ 和像距 $s_{i}$，使用薄透镜方程：\n$$\n\\frac{1}{f}=\\frac{1}{s_{o}}+\\frac{1}{s_{i}}.\n$$\n当镜头对焦在 $s_{o}$ 处时，传感器位于\n$$\ns_{i0}=\\frac{f s_{o}}{s_{o}-f}.\n$$\n对于距离为 $s$ 的物体，其清晰成像平面将位于\n$$\ns_{i}(s)=\\frac{f s}{s-f}.\n$$\n在传感器固定于 $s_{i0}$ 的情况下，传感器上的离焦模糊（弥散圆）直径可通过会聚光锥的相似三角形得到：\n$$\nd=D\\,\\frac{|s_{i0}-s_{i}(s)|}{s_{i}(s)}.\n$$\n可接受的极限为 $d=c$，因此\n$$\n\\frac{|s_{i0}-s_{i}|}{s_{i}}=\\frac{c}{D}\\quad\\Longrightarrow\\quad\\left|\\frac{s_{i0}}{s_{i}}-1\\right|=\\frac{c}{D}.\n$$\n于是\n$$\n\\frac{s_{i0}}{s_{i}}=1\\pm\\frac{c}{D}\\quad\\Longrightarrow\\quad s_{i}=\\frac{s_{i0}}{1\\pm c/D}.\n$$\n正号给出远景限（较小的 $s_{i}$），负号给出近景限（较大的 $s_{i}$）。通过薄透镜共轭关系 $s=f s_{i}/(s_{i}-f)$，将这些像距转换回物距：\n$$\ns_{\\text{near}}=\\frac{f\\,\\dfrac{s_{i0}}{1-c/D}}{\\dfrac{s_{i0}}{1-c/D}-f},\\qquad\ns_{\\text{far}}=\\frac{f\\,\\dfrac{s_{i0}}{1+c/D}}{\\dfrac{s_{i0}}{1+c/D}-f}.\n$$\n代入 $s_{i0}=f s_{o}/(s_{o}-f)$ 和 $t=c/D$，这些表达式可简化为\n$$\ns_{\\text{near}}=\\frac{f s_{o}}{f+t\\,(s_{o}-f)},\\qquad\ns_{\\text{far}}=\\frac{f s_{o}}{f-t\\,(s_{o}-f)}.\n$$\n因此，总景深为\n$$\n\\text{DOF}=s_{\\text{far}}-s_{\\text{near}}=f s_{o}\\left[\\frac{1}{f-t\\,(s_{o}-f)}-\\frac{1}{f+t\\,(s_{o}-f)}\\right].\n$$\n使用恒等式 $\\frac{1}{a-b}-\\frac{1}{a+b}=\\frac{2b}{a^{2}-b^{2}}$，令 $a=f$ 和 $b=t\\,(s_{o}-f)$，并代入 $t=c/D$ 可得\n$$\n\\text{DOF}=\\frac{2 f s_{o}(s_{o}-f)\\,(c/D)}{f^{2}-\\left(c/D\\right)^{2}(s_{o}-f)^{2}}=\\frac{2 c D\\, f s_{o}(s_{o}-f)}{f^{2} D^{2}-c^{2}(s_{o}-f)^{2}}.\n$$\n在薄透镜模型下，此表达式是精确的，并且仅依赖于 $f$、$s_{o}$、$D$ 和 $c$。", "answer": "$$\\boxed{\\frac{2 c D\\, f s_{o}\\left(s_{o}-f\\right)}{f^{2} D^{2}-c^{2}\\left(s_{o}-f\\right)^{2}}}$$", "id": "2225413"}]}