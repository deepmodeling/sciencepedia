{"hands_on_practices": [{"introduction": "在我们能够使用空间滤波来操控图像之前，我们必须首先理解傅里叶平面中包含了哪些信息。本练习将探讨一种常见物体——荣奇光栅（Ronchi ruling）——的衍射图样，以揭示物体的物理结构是如何被编码为一组离散的空间频率的。通过确定哪些频率分量天然存在或缺失，我们为设计有效的空间滤波器奠定了基础 [@problem_id:2216612]。", "problem": "在一个利用空间滤波的相干成像实验中，所成像的物体是一个一维二元振幅光栅，称为荣奇光栅。该光栅由透明基底上一系列等间距、平行的不透明条纹组成。每个透明狭缝的宽度恰好等于每个不透明条纹的宽度。该光栅由一束单色光的正入射平面波照射。在系统物镜的傅里叶平面上，形成了远场衍射图样，该图样由一系列离散的亮点组成，这些亮点对应于用整数 $m$ 索引的不同衍射级次。观察发现，这些衍射级次中的一个特定集合在该图样中系统性地缺失了。下列哪个选项正确地指出了所有缺失衍射级次的完整集合？\n\nA. 所有奇数级次 ($m = \\pm 1, \\pm 3, \\pm 5, \\dots$)。\n\nB. 所有非零偶数级次 ($m = \\pm 2, \\pm 4, \\pm 6, \\dots$)。\n\nC. 仅零级 ($m=0$)。\n\nD. 除零级外 ($m \\neq 0$) 的所有奇数和偶数级次。\n\nE. 所有偶数级次，包括零级 ($m = 0, \\pm 2, \\pm 4, \\dots$)。\n\nF. 没有级次缺失；所有整数级次都存在。", "solution": "考虑一个周期为 $d$、透光狭缝宽度为 $a=d/2$ 的一维周期性二元振幅光栅（荣奇光栅）。在相干、正入射的单色光照射下，傅里叶平面（远场）中的复振幅场正比于光栅透射函数 $t(x)$ 在以整数 $m$ 索引的空间频率下的傅里叶级数系数。衍射级次 $m$ 缺失的充分必要条件是其对应的傅里叶系数 $c_{m}$ 为零。\n\n定义以原点为中心的一个周期内的透射函数为：当 $|x|<a/2$ 时，$t(x)=1$；在其他情况下，$t(x)=0$。并以周期 $d$ 进行周期性延拓。复傅里叶级数系数为\n$$\nc_{m}=\\frac{1}{d}\\int_{-a/2}^{a/2}\\exp\\!\\left(-i\\frac{2\\pi m}{d}x\\right)\\,dx.\n$$\n对于 $m\\neq 0$，直接积分：\n$$\nc_{m}=\\frac{1}{d}\\left[\\frac{\\exp\\!\\left(-i\\frac{2\\pi m}{d}x\\right)}{-i\\frac{2\\pi m}{d}}\\right]_{x=-a/2}^{x=a/2}\n=\\frac{1}{-i2\\pi m}\\left(\\exp\\!\\left(-i\\pi m\\frac{a}{d}\\right)-\\exp\\!\\left(i\\pi m\\frac{a}{d}\\right)\\right)\n=\\frac{1}{\\pi m}\\sin\\!\\left(\\pi m\\frac{a}{d}\\right).\n$$\n对于 $m=0$，系数是一个周期内的平均透射率：\n$$\nc_{0}=\\frac{1}{d}\\int_{-a/2}^{a/2}dx=\\frac{a}{d}=\\frac{1}{2}.\n$$\n当 $a=d/2$ 时，非零级次的系数变为\n$$\nc_{m}=\\frac{1}{\\pi m}\\sin\\!\\left(\\frac{\\pi m}{2}\\right),\\quad m\\neq 0,\n$$\n且 $c_{0}=1/2$。级次缺失的条件是 $c_{m}=0$。对于 $m\\neq 0$，这种情况发生在\n$$\n\\sin\\!\\left(\\frac{\\pi m}{2}\\right)=0\\quad\\Longleftrightarrow\\quad \\frac{\\pi m}{2}=n\\pi,\\; n\\in\\mathbb{Z}\\quad\\Longleftrightarrow\\quad m=2n,\n$$\n即，所有偶数整数。$m=0$ 的特殊情况不会消失，因为 $c_{0}=1/2\\neq 0$。因此，所有非零偶数级次都缺失，而零级和奇数级次都存在。\n\n这组级次对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "2216612"}, {"introduction": "阿贝的理论告诉我们，图像是由衍射光波的干涉形成的。这个练习将这一理论付诸实践，通过一个思想实验，我们只允许特定的衍射级次——零级和 $\\pm 2$ 级——通过滤波器来重构图像。通过分析最终的图像，我们将亲眼见证一个有趣的现象：最终图像的周期性结构会发生怎样的改变，从而揭示了空间滤波在图像处理中的基本能力 [@problem_id:2216575]。", "problem": "在一个为材料分析而设计的相干光学成像系统中，使用傅里叶光学的原理来检测一个一维周期性物体。该物体是一个振幅光栅，其基本空间周期为 $L$。该光栅的结构使其夫琅禾费衍射图样包含多个分立的级次，其中包括零级 ($n=0$) 和二级 ($n=\\pm 2$) 的非零强度。\n\n该光栅被一束单色平面波照射。透射光通过一个用作4f空间滤波装置的透镜系统。在该系统的傅里叶平面（即衍射图样形成的平面）中，插入一个定制的空间滤波器。该滤波器被设计用来完全阻挡所有的衍射级次，除了三个级次：中心的零级 ($n=0$) 和一对二级 ($n=+2$ 和 $n=-2$) 。\n\n来自这三个选定级次的光随后由透镜系统的第二部分重新组合以形成像。这个从其空间频率分量的子集中重建像的过程，被称为空间滤波。确定最终得到的像的强度图样的基本空间周期与原始物体光栅的基本空间周期 $L$ 之比。将您的答案表示为一个实数。", "solution": "根据Abbe理论，相干系统中的成像原理涉及两次连续的傅里叶变换。物体首先被变换为其空间频率谱（衍射图样），然后被滤波并反变换回来形成像。\n\n步骤 1：表示物体的透射函数。\n一个空间周期为 $L$ 的一维周期性物体可以用一个复透射函数 $t_{obj}(x)$ 来描述，该函数可以展开成傅里叶级数：\n$$t_{obj}(x) = \\sum_{n=-\\infty}^{\\infty} c_n \\exp\\left(i n \\frac{2 \\pi x}{L}\\right)$$\n在这里，$c_n$ 是对应于不同衍射级次的傅里叶系数，$n$ 是级次的整数索引。项 $k_g = \\frac{2\\pi}{L}$ 代表了光栅的基本角空间频率。该表达式可以写成：\n$$t_{obj}(x) = \\sum_{n=-\\infty}^{\\infty} c_n \\exp(i n k_g x)$$\n\n步骤 2：对空间滤波过程进行建模。\n4f系统的第一个透镜对 $t_{obj}(x)$ 进行傅里叶变换，在傅里叶平面上产生衍射图样。物体的每一项 $c_n \\exp(i n k_g x)$ 都会在傅里叶平面上，位于与其空间频率 $n k_g$ 成正比的位置处，产生一个光点（一个衍射级次）。第 $n$ 级光点的复振幅与 $c_n$ 成正比。\n\n此平面中的空间滤波器是一个掩模，只允许 $n=0$、$n=+2$ 和 $n=-2$ 级次通过。因此，紧随滤波器之后的光场的复振幅分布是这三个选定分量的和：\n$$A_{filt}(x') \\propto c_0 \\delta(x') + c_2 \\delta(x' - x'_2) + c_{-2} \\delta(x' - x'_{-2})$$\n其中 $x'$ 是傅里叶平面中的空间坐标，$x'_{n}$ 是第 $n$ 级的位置。关键信息是只有傅里叶系数 $c_0, c_2, c_{-2}$ 对最终的像有贡献。\n\n步骤 3：重建像。\n第二个透镜对滤波后的场进行逆傅里叶变换以形成像。最终像的复振幅 $A_{img}(x)$ 是与通过的级次相对应的波分量的和：\n$$A_{img}(x) \\propto c_0 \\exp(i \\cdot 0 \\cdot k_g x) + c_2 \\exp(i \\cdot 2 \\cdot k_g x) + c_{-2} \\exp(i \\cdot (-2) \\cdot k_g x)$$\n$$A_{img}(x) \\propto c_0 + c_2 \\exp(i 2 k_g x) + c_{-2} \\exp(-i 2 k_g x)$$\n\n步骤 4：简化像的振幅表达式。\n对于振幅光栅，其透射函数 $t_{obj}(x)$ 是一个实值函数。对于任何实函数，其傅里叶系数必须满足厄米共轭条件 $c_{-n} = c_n^*$，其中 $c_n^*$ 是 $c_n$ 的复共轭。在本例中，由于物体是一个简单的振幅光栅（不透明背景上的透明部分），其透射函数不仅是实的，而且是正的，这导致傅里叶系数为实数。因此，我们有 $c_{-2} = c_2$。\n将此代入像的振幅表达式中：\n$$A_{img}(x) \\propto c_0 + c_2 (\\exp(i 2 k_g x) + \\exp(-i 2 k_g x))$$\n使用欧拉公式 $\\cos(\\theta) = \\frac{e^{i\\theta} + e^{-i\\theta}}{2}$，表达式简化为：\n$$A_{img}(x) \\propto c_0 + 2c_2 \\cos(2 k_g x)$$\n\n步骤 5：确定最终像的强度的周期。\n观察到的像是强度图样 $I_{img}(x)$，它与复振幅的模的平方成正比：\n$$I_{img}(x) \\propto |A_{img}(x)|^2 \\propto (c_0 + 2c_2 \\cos(2 k_g x))^2$$\n为了找到该强度图样的基本周期，我们需要找到最小的正值 $L'$，使得对于所有的 $x$ 都有 $I_{img}(x+L') = I_{img}(x)$。强度的空间依赖性由项 $\\cos(2k_g x)$ 决定。我们通过代入 $k_g = 2\\pi/L$ 来分析余弦函数的自变量：\n$$2 k_g x = 2 \\left(\\frac{2\\pi}{L}\\right) x = \\frac{4\\pi x}{L}$$\n函数为 $I_{img}(x) \\propto (c_0 + 2c_2 \\cos(\\frac{4\\pi x}{L}))^2$。令新周期为 $L'$。形式为 $\\cos(\\alpha x)$ 的函数的周期是 $2\\pi/\\alpha$。\n这里，余弦项的角频率是 $\\alpha = \\frac{4\\pi}{L}$。\n余弦项本身的周期是：\n$$L'_{cos} = \\frac{2\\pi}{\\alpha} = \\frac{2\\pi}{4\\pi/L} = \\frac{L}{2}$$\n由于总的强度函数 $I_{img}(x)$ 涉及这个余弦（而不是像 $\\cos^2(x)$ 这样会再次将周期减半的更高对称性的函数），其基本周期由 $\\cos(\\frac{4\\pi x}{L})$ 的周期决定。常数偏移 $c_0$ 和平方运算在这种情况下不会改变基本周期（除非 $c_0=0$，而这通常不成立）。\n因此，像的强度图样的基本周期是 $L' = L/2$。\n\n步骤 6：计算所求的比率。\n问题要求新周期 $L'$ 与原始周期 $L$ 的比率。\n$$\\text{Ratio} = \\frac{L'}{L} = \\frac{L/2}{L} = \\frac{1}{2}$$\n最终得到的像的空间周期是原始物体周期的一半。这种现象被称为倍频。\n\n最终答案检查：原始物体光栅具有空间频率 $n/L$。滤波后的像是从空间频率为 $0$ 和 $\\pm 2/L$ 的分量构建的。在强度上，$+2/L$ 和 $-2/L$ 分量之间的干涉产生了一个空间频率为 $(+2/L) - (-2/L) = 4/L$ 的正弦图样，或者更准确地说，波矢为 $\\pm 2k_g$ 的平面波的干涉产生了一个波矢为 $2k_g$ 的驻波，其空间周期为 $2\\pi/(2k_g) = \\pi/k_g = \\pi/(2\\pi/L) = L/2$。零级分量（一个恒定的直流偏置）的加入会调制该图样的对比度，但不会改变其基本周期。结果是可靠的。", "answer": "$$\\boxed{0.5}$$", "id": "2216575"}, {"introduction": "许多物体，例如生物活细胞，几乎是完全透明的；它们对光的振幅影响很小，但会显著改变其相位。本练习模拟了相衬显微镜的核心原理，这是一种能使这些“相位物体”可见的革命性技术。通过使用一个非对称滤波器，我们将探索如何将不可见的相位变化转换成可观测的强度变化，从而将相位信息可视化，这展示了空间滤波在高级显微技术中的强大力量 [@problem_id:2216603]。", "problem": "一个4f光学成像系统被用来观察一个透明物体。该系统由两个相同的薄透镜组成，每个透镜的焦距为$f$，它们之间的距离为$2f$。物体被放置在第一个透镜的前焦平面上，并被一束沿光轴传播的波长为$\\lambda$的相干单色平面波照亮。最终的像形成在第二个透镜的后焦平面上。\n\n该物体是一个弱正弦相位光栅，其一维透射函数为 $t(x) = \\exp[i \\phi_m \\sin(\\frac{2\\pi x}{d})]$，其中$d$是光栅的周期，$\\phi_m$是最大相位调制。您可以假设$\\phi_m$非常小，从而可以使用近似式 $\\exp(i\\alpha) \\approx 1 + i\\alpha$（对于小的$\\alpha$）。\n\n一个空间滤波器被放置在傅里叶平面上，该平面是两个透镜之间的公共焦平面。该滤波器是一个不透明的屏，设计用于仅透射来自光栅的0级（未衍射）和+1级衍射级，并阻挡所有其他级次。\n\n所得到的像强度分布 $I(x')$（其中 $x'$ 是像平面中的坐标）被发现是正弦形的。然而，像中强度最大的位置与原始物体中相位最大的位置并不对齐。这种未对齐可以描述为一种空间位移。求出物体中相位最大值位置与像中最近的强度最大值位置之间的空间位移大小 $\\Delta x$。用光栅周期$d$的函数表示您的答案。", "solution": "入射场是单位振幅的平面波，因此物平面的场等于透射函数。对于一个弱正弦相位光栅，\n$$\nt(x)=\\exp\\!\\left[i\\,\\phi_{m}\\sin\\!\\left(\\frac{2\\pi x}{d}\\right)\\right]\\approx 1+i\\,\\phi_{m}\\sin\\!\\left(\\frac{2\\pi x}{d}\\right),\n$$\n使用了当$\\alpha$很小时 $\\exp(i\\alpha)\\approx 1+i\\alpha$ 的近似。将 $\\sin(\\kappa x)$（其中 $\\kappa=\\frac{2\\pi}{d}$）写成复指数形式，\n$$\ni\\sin(\\kappa x)=\\frac{1}{2}\\left(\\exp(i\\kappa x)-\\exp(-i\\kappa x)\\right),\n$$\n因此\n$$\nt(x)\\approx 1+\\frac{\\phi_{m}}{2}\\exp(i\\kappa x)-\\frac{\\phi_{m}}{2}\\exp(-i\\kappa x).\n$$\n在4f系统中，第一个透镜在傅里叶平面上产生空间频谱，该频谱由位于$k=0,\\pm\\kappa$的三个离散级次组成，其振幅分别与$1$、$\\frac{\\phi_{m}}{2}$ 和 $-\\frac{\\phi_{m}}{2}$ 成正比。空间滤波器仅透射0级和+1级，并阻挡其余级次。因此，滤波后的频谱可以写为\n$$\nU_{F}(k)=A_{0}\\,\\delta(k)+A_{1}\\,\\delta(k-\\kappa),\n$$\n其中 $A_{0}\\propto 1$ 且 $A_{1}\\propto \\frac{\\phi_{m}}{2}$。第二个透镜执行另一次傅里叶变换，因此像平面的场（不计一个总的常数因子）为\n$$\nU(x')=\\int_{-\\infty}^{\\infty}U_{F}(k)\\exp(-ikx')\\,dk=A_{0}+A_{1}\\exp(-i\\kappa x').\n$$\n选择总相位使得 $A_{0}$ 和 $A_{1}$ 为实数且为正（不透明的滤波器不引入附加相位），像强度关于 $\\phi_{m}$ 的一阶近似为\n$$\nI(x')=|U(x')|^{2}=\\left|A_{0}+A_{1}\\exp(-i\\kappa x')\\right|^{2}=A_{0}^{2}+2A_{0}A_{1}\\cos(\\kappa x')+O(\\phi_{m}^{2}).\n$$\n因此，到一阶近似，\n$$\nI(x')\\propto 1+\\phi_{m}\\cos\\!\\left(\\frac{2\\pi x'}{d}\\right).\n$$\n$I(x')$ 的最大值出现在 $\\cos\\left(\\frac{2\\pi x'}{d}\\right)=1$ 处，即，\n$$\nx' = m\\,d,\\quad m\\in\\mathbb{Z}.\n$$\n物体是相位为 $\\phi(x)=\\phi_{m}\\sin\\left(\\frac{2\\pi x}{d}\\right)$ 的相位光栅。相位的最大值出现在\n$$\n\\sin\\left(\\frac{2\\pi x}{d}\\right)=1\\quad\\Rightarrow\\quad x=\\frac{d}{4}+n\\,d,\\quad n\\in\\mathbb{Z}.\n$$\n一个由相同透镜组成的对称4f系统，其放大倍率的绝对值为1，因此在未滤波的情况下，位置以 $x'\\sim -x$ 的方式进行反转映射。滤波过程保留了图案的周期 $d$。因此，对于物体上$x=\\frac{d}{4}$处的相位最大值（其像映射到$x'=-\\frac{d}{4}$），像中最近的强度最大值位于$x'=0$处。因此，空间位移的大小为\n$$\n\\Delta x=\\left|0-(-\\tfrac{d}{4})\\right|=\\frac{d}{4}.\n$$\n根据周期性，这个结果对任何整数$n$都成立。", "answer": "$$\\boxed{\\frac{d}{4}}$$", "id": "2216603"}]}