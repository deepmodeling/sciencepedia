{"hands_on_practices": [{"introduction": "在光学成像中，卷积描述了一个光学系统的固有模糊（由其点扩散函数 $PSF$ 表征）如何影响一个延展物体的图像。这个练习将卷积积分直观地解释为两个形状的重叠面积，将抽象的数学运算变得具体可感。通过计算一个方形光源被具有方形点扩散函数的系统成像后的结果，你可以亲手体验卷积在最基本层面上的运作方式。[@problem_id:2260452]", "problem": "一个非相干成像系统被用于观察一个微观光源。被成像的物体是一个理想的正方形发光元件，位于物平面的原点。这个正方形的边长为 $L$，并在其整个表面上发出强度均匀为 $I_0$ 的光。物体的强度分布可以描述为：当 $|x| \\le L/2$ 且 $|y| \\le L/2$ 时，$O(x, y) = I_0$；其他情况下 $O(x, y) = 0$。\n\n该成像系统的放大率为1。其性能由其点扩展函数 (PSF) 来表征，该函数描述了由一个理想点光源所形成的图像。由于系统光学元件中有一个方形光阑，其PSF也是一个正方形，位于像平面的原点。PSF由下式给出：当 $|x| \\le L/2$ 且 $|y| \\le L/2$ 时，$h(x, y) = C$；其他情况下 $h(x, y) = 0$。常数 $C$ 的取值应使PSF在整个像平面上的总积分等于1。\n\n对于非相干光源，所得到的图像强度分布 $I_{img}(x, y)$ 是物体的强度分布与系统PSF的卷积。你的任务是确定图像中心水平线（即x轴）上的图像强度剖面的数学表达式。请给出 $I_{img}(x,0)$ 作为 $x$ 的函数的表达式，该表达式在强度非零的范围内有效。", "solution": "对于非相干系统，图像强度是物体强度与PSF的卷积：\n$$\nI_{\\mathrm{img}}(x,y)=\\iint_{-\\infty}^{\\infty}O(\\xi,\\eta)\\,h(x-\\xi,y-\\eta)\\,d\\xi\\,d\\eta.\n$$\n物体是一个边长为 $L$、中心在原点的均匀正方形：\n$$\nO(x,y)=I_{0}\\quad\\text{for }|x|\\le \\frac{L}{2},\\ |y|\\le \\frac{L}{2},\\quad\\text{and }0\\text{ otherwise}.\n$$\nPSF是一个边长为 $L$、中心在原点且总积分为1的均匀正方形：\n$$\nh(x,y)=C\\quad\\text{for }|x|\\le \\frac{L}{2},\\ |y|\\le \\frac{L}{2},\\quad\\text{and }0\\text{ otherwise},\n$$\n其中 $C$ 由归一化条件确定：\n$$\n\\iint h(x,y)\\,dx\\,dy=C\\int_{-L/2}^{L/2}\\int_{-L/2}^{L/2}dy\\,dx=C\\,L^{2}=1\\;\\;\\Rightarrow\\;\\;C=\\frac{1}{L^{2}}.\n$$\n将支撑域正方形写为集合 $S_{0}=\\{(\\xi,\\eta):|\\xi|\\le L/2,\\ |\\eta|\\le L/2\\}$ 和 $S_{x,y}=\\{(\\xi,\\eta):|x-\\xi|\\le L/2,\\ |y-\\eta|\\le L/2\\}$。由于 $O=I_{0}\\,\\chi_{S_{0}}$ 且 $h(x-\\xi,y-\\eta)=C\\,\\chi_{S_{x,y}}(\\xi,\\eta)$，卷积简化为\n$$\nI_{\\mathrm{img}}(x,y)=I_{0}C\\iint \\chi_{S_{0}}(\\xi,\\eta)\\,\\chi_{S_{x,y}}(\\xi,\\eta)\\,d\\xi\\,d\\eta\n=I_{0}C\\,\\mathrm{Area}\\big(S_{0}\\cap S_{x,y}\\big).\n$$\n因为这两个正方形是轴对齐的，所以重叠面积可以分解为沿 $x$ 和 $y$ 方向的重叠长度的乘积。$x$ 区间 $[-L/2,L/2]$ 和 $[x-L/2,x+L/2]$ 的交集长度在 $|x|\\le L$ 时为 $L-|x|$，其他情况下为0。$y$ 方向同理。因此\n$$\nI_{\\mathrm{img}}(x,y)=\\frac{I_{0}}{L^{2}}\\max\\{0,L-|x|\\}\\,\\max\\{0,L-|y|\\}.\n$$\n在中心水平线 $y=0$ 上，我们有 $\\max\\{0,L-|0|\\}=L$，因此对于 $|x|\\le L$，\n$$\nI_{\\mathrm{img}}(x,0)=\\frac{I_{0}}{L^{2}}\\,(L-|x|)\\,L=I_{0}\\left(1-\\frac{|x|}{L}\\right),\n$$\n而当 $|x|>L$ 时 $I_{\\mathrm{img}}(x,0)=0$。因此，在非零范围 $|x|\\le L$ 内有效的所求表达式为 $I_{0}\\left(1-\\frac{|x|}{L}\\right)$。", "answer": "$$\\boxed{I_{0}\\left(1-\\frac{|x|}{L}\\right)}$$", "id": "2260452"}, {"introduction": "卷积的概念远不止应用于空间成像。任何测量仪器都有其“仪器响应函数”，测得的输出是真实信号与该响应函数的卷积，这种效应通常被称为仪器展宽。本练习将此概念应用于光谱学，通过分析一个理想化的钠双线光谱如何被具有高斯响应函数的光谱仪记录，来帮助你理解分辨率在光谱测量中的关键作用。[@problem_id:2260428]", "problem": "一台高分辨率光谱仪被用于分析钠蒸气灯的光发射。该灯的光谱主要由众所周知、被称为钠D谱线的双线主导，在本问题中，我们将其建模为两条强度相等的理想化、无限窄的光谱线。这两条谱线的波长分别为 $\\lambda_1 = 589.0$ nm 和 $\\lambda_2 = 589.6$ nm。\n\n任何真实的光谱仪都具有有限的分辨率，这会导致观测到的任何光谱线发生“展宽”。对于这台特定的仪器，任何波长为 $\\lambda_{in}$ 的完美单色输入被记录为遵循高斯分布的光谱强度分布 $I(\\lambda)$：\n$$I(\\lambda) = I_{max} \\exp\\left(-\\frac{(\\lambda - \\lambda_{in})^2}{2\\sigma^2}\\right)$$\n此处，$I_{max}$ 是峰值强度，参数 $\\sigma$ 表征了仪器展宽。对于此光谱仪，展宽参数为 $\\sigma = 0.25$ nm。\n\n在观测钠双线时，光谱仪记录的是由两条发射谱线共同产生的单一组合光谱。请计算在第二条谱线的波长 $\\lambda_2$ 处的测量光谱强度与恰好在两条谱线正中间波长处的测量光谱强度之比。将您的答案以数值形式报告，并四舍五入到三位有效数字。", "solution": "位于 $\\lambda_{1}$ 和 $\\lambda_{2}$ 的两条等强度谱线的测量光谱是仪器对每条谱线响应的线性叠加。对于宽度为 $\\sigma$ 的高斯仪器轮廓，波长 $\\lambda$ 处的总强度为\n$$\nI(\\lambda)=A\\left[\\exp\\!\\left(-\\frac{(\\lambda-\\lambda_{1})^{2}}{2\\sigma^{2}}\\right)+\\exp\\!\\left(-\\frac{(\\lambda-\\lambda_{2})^{2}}{2\\sigma^{2}}\\right)\\right],\n$$\n其中 $A$ 是一个公共的振幅因子（由于两条谱线的固有强度相等，因此该因子对两条谱线是相同的）。\n\n在 $\\lambda=\\lambda_{2}$ 处，强度为\n$$\nI(\\lambda_{2})=A\\left[\\exp\\!\\left(-\\frac{(\\lambda_{2}-\\lambda_{1})^{2}}{2\\sigma^{2}}\\right)+\\exp(0)\\right]=A\\left[1+\\exp\\!\\left(-\\frac{\\Delta^{2}}{2\\sigma^{2}}\\right)\\right],\n$$\n其中 $\\Delta=\\lambda_{2}-\\lambda_{1}$。\n\n在中点 $\\lambda_{m}=\\frac{\\lambda_{1}+\\lambda_{2}}{2}$ 处，每条谱线的贡献相等，间隔为 $\\delta=\\frac{\\Delta}{2}$，因此\n$$\nI(\\lambda_{m})=A\\left[2\\exp\\!\\left(-\\frac{\\delta^{2}}{2\\sigma^{2}}\\right)\\right]=2A\\exp\\!\\left(-\\frac{\\Delta^{2}}{8\\sigma^{2}}\\right).\n$$\n因此，所求的比值为\n$$\nR=\\frac{I(\\lambda_{2})}{I(\\lambda_{m})}=\\frac{1+\\exp\\!\\left(-\\frac{\\Delta^{2}}{2\\sigma^{2}}\\right)}{2\\exp\\!\\left(-\\frac{\\Delta^{2}}{8\\sigma^{2}}\\right)}.\n$$\n已知 $\\lambda_{1}=589.0\\,\\text{nm}$，$\\lambda_{2}=589.6\\,\\text{nm}$，以及 $\\sigma=0.25\\,\\text{nm}$，我们得到 $\\Delta=0.6\\,\\text{nm}$ 和 $\\Delta/\\sigma=2.4$。于是\n$$\nR=\\frac{1+\\exp(-2.88)}{2\\exp(-0.72)}=\\frac{1+0.0561348}{2\\times 0.486752}\\approx\\frac{1.0561348}{0.973504}\\approx 1.08488.\n$$\n四舍五入到三位有效数字，比值为 $1.08$。", "answer": "$$\\boxed{1.08}$$", "id": "2260428"}, {"introduction": "最后这个练习将直接利用卷积定理本身的威力。当遇到一个在实空间中难以计算的卷积时，我们可以利用傅里叶变换将其转换到频域，在那里卷积运算简化为简单的乘法。本题将研究一个其自身透过率函数就由卷积定义的光阑的远场衍射图样，以此展示卷积定理在傅里叶光学中的简洁与实用性。[@problem_id:2260464]", "problem": "在先进光学系统的研究中，人们会设计具有定制透射特性的孔径，以塑造通过它们的光。考虑一个一维孔径，其透射函数 $t(x)$ 定义为一个三角形函数和一个矩形函数的卷积。具体来说，透射函数由 $t(x) = \\Lambda(x/a) * \\Pi(x/b)$ 给出，其中星号 $*$ 表示卷积运算。\n\n标准化的三角形函数定义为：当 $|y| \\leq 1$ 时，$\\Lambda(y) = 1 - |y|$；其他情况下为零。标准化的矩形函数定义为：当 $|y| \\leq 1/2$ 时，$\\Pi(y) = 1$；其他情况下为零。参数 $a$ 和 $b$ 是具有长度单位的正实数常量。\n\n此孔径被放置在透镜的前焦平面，并由一束平行于光轴传播的单色平面波照射。在夫琅禾费近似下，后焦平面中的光的复振幅 $U(k_x)$ 与孔径透射函数的傅里叶变换成正比。此处，$k_x$ 是空间频率。求振幅 $U(k_x)$ 作为 $k_x$、$a$ 和 $b$ 的函数的表达式。你的表达式应包含一个总的比例常数 $C$。", "solution": "给定一维孔径的透射函数为卷积形式\n$$\nt(x) = \\Lambda\\!\\left(\\frac{x}{a}\\right) * \\Pi\\!\\left(\\frac{x}{b}\\right),\n$$\n其中，当 $|y| \\leq 1$ 时 $\\Lambda(y) = 1 - |y|$，其他情况下为 $0$；当 $|y| \\leq \\frac{1}{2}$ 时 $\\Pi(y) = 1$，其他情况下为 $0$。在平面波照射且孔径置于透镜前焦平面的夫琅禾费近似下，后焦平面中的复振幅与 $t(x)$ 的傅里叶变换成正比。我们采用如下傅里叶变换约定\n$$\n\\mathcal{F}\\{f\\}(k_{x}) = \\int_{-\\infty}^{\\infty} f(x)\\,\\exp(-i k_{x} x)\\,dx,\n$$\n并将所有与系统相关的常数（包括任何 $2\\pi$ 约定因子）吸收到一个常数 $C$ 中。那么\n$$\nU(k_{x}) = C\\,\\mathcal{F}\\{t\\}(k_{x}).\n$$\n根据卷积定理 $\\mathcal{F}\\{f*g\\} = \\mathcal{F}\\{f\\}\\,\\mathcal{F}\\{g\\}$，我们有\n$$\n\\mathcal{F}\\{t\\}(k_{x}) = \\mathcal{F}\\!\\left\\{\\Lambda\\!\\left(\\frac{x}{a}\\right)\\right\\}(k_{x})\\;\\mathcal{F}\\!\\left\\{\\Pi\\!\\left(\\frac{x}{b}\\right)\\right\\}(k_{x}).\n$$\n\n现在我们利用定义和缩放性质来计算每个因子。\n\n1) 缩放矩形函数的傅里叶变换：\n$$\n\\mathcal{F}\\!\\left\\{\\Pi\\!\\left(\\frac{x}{b}\\right)\\right\\}(k_{x})\n= \\int_{-\\infty}^{\\infty} \\Pi\\!\\left(\\frac{x}{b}\\right)\\exp(-i k_{x} x)\\,dx.\n$$\n令 $y = \\frac{x}{b}$，则 $x = b y$ 且 $dx = b\\,dy$。由于 $\\Pi(y)$ 仅在 $|y|\\leq \\frac{1}{2}$ 时非零，\n$$\n\\mathcal{F}\\!\\left\\{\\Pi\\!\\left(\\frac{x}{b}\\right)\\right\\}(k_{x})\n= b \\int_{-1/2}^{1/2} \\exp(-i k_{x} b y)\\,dy\n= b \\left[\\frac{\\exp(-i k_{x} b y)}{-i k_{x} b}\\right]_{-1/2}^{1/2}\n= \\frac{2 \\sin\\!\\left(\\frac{k_{x} b}{2}\\right)}{k_{x}}.\n$$\n等价地，\n$$\n\\mathcal{F}\\!\\left\\{\\Pi\\!\\left(\\frac{x}{b}\\right)\\right\\}(k_{x})\n= b\\,\\frac{\\sin\\!\\left(\\frac{k_{x} b}{2}\\right)}{\\frac{k_{x} b}{2}}.\n$$\n\n2) 缩放三角形函数的傅里叶变换：\n$$\n\\mathcal{F}\\!\\left\\{\\Lambda\\!\\left(\\frac{x}{a}\\right)\\right\\}(k_{x})\n= \\int_{-\\infty}^{\\infty} \\Lambda\\!\\left(\\frac{x}{a}\\right)\\exp(-i k_{x} x)\\,dx.\n$$\n令 $y = \\frac{x}{a}$，则 $x = a y$ 且 $dx = a\\,dy$。由于 $\\Lambda(y)$ 仅在 $|y| \\leq 1$ 时非零，\n$$\n\\mathcal{F}\\!\\left\\{\\Lambda\\!\\left(\\frac{x}{a}\\right)\\right\\}(k_{x})\n= a \\int_{-1}^{1} \\left(1 - |y|\\right)\\exp(-i k_{x} a y)\\,dy.\n$$\n因为取实部后，被积函数是关于 $y$ 的偶函数，所以这等于\n$$\na \\cdot 2 \\int_{0}^{1} (1 - y)\\cos(k_{x} a y)\\,dy.\n$$\n计算该积分：\n$$\n\\int_{0}^{1} (1 - y)\\cos(K y)\\,dy\n= \\int_{0}^{1} \\cos(K y)\\,dy - \\int_{0}^{1} y \\cos(K y)\\,dy,\n$$\n其中 $K = k_{x} a$。使用\n$$\n\\int_{0}^{1} \\cos(K y)\\,dy = \\frac{\\sin K}{K},\\qquad\n\\int_{0}^{1} y \\cos(K y)\\,dy = \\frac{\\sin K}{K} + \\frac{\\cos K - 1}{K^{2}},\n$$\n我们得到\n$$\n\\int_{0}^{1} (1 - y)\\cos(K y)\\,dy = -\\frac{\\cos K - 1}{K^{2}} = \\frac{1 - \\cos K}{K^{2}}.\n$$\n因此，\n$$\n\\mathcal{F}\\!\\left\\{\\Lambda\\!\\left(\\frac{x}{a}\\right)\\right\\}(k_{x})\n= 2 a \\cdot \\frac{1 - \\cos(k_{x} a)}{(k_{x} a)^{2}}\n= a \\left(\\frac{\\sin\\!\\left(\\frac{k_{x} a}{2}\\right)}{\\frac{k_{x} a}{2}}\\right)^{2}.\n$$\n\n将两个变换结果相乘，并包含总的比例常数 $C$，我们得到\n$$\nU(k_{x}) = C\\,\\mathcal{F}\\{t\\}(k_{x})\n= C \\left[ a \\left(\\frac{\\sin\\!\\left(\\frac{k_{x} a}{2}\\right)}{\\frac{k_{x} a}{2}}\\right)^{2} \\right]\n\\left[ b \\left(\\frac{\\sin\\!\\left(\\frac{k_{x} b}{2}\\right)}{\\frac{k_{x} b}{2}}\\right) \\right].\n$$\n等价地，使用三角恒等式，这可以写成\n$$\nU(k_{x}) = C\\,\\frac{8\\,\\sin^{2}\\!\\left(\\frac{k_{x} a}{2}\\right)\\,\\sin\\!\\left(\\frac{k_{x} b}{2}\\right)}{a\\,k_{x}^{3}},\n$$\n这在代数上是等价的。两种形式都展示了对 $k_{x}$、$a$ 和 $b$ 的依赖关系。", "answer": "$$\\boxed{C\\,a\\,b\\left(\\frac{\\sin\\!\\left(\\frac{a k_{x}}{2}\\right)}{\\frac{a k_{x}}{2}}\\right)^{2}\\left(\\frac{\\sin\\!\\left(\\frac{b k_{x}}{2}\\right)}{\\frac{b k_{x}}{2}}\\right)}$$", "id": "2260464"}]}