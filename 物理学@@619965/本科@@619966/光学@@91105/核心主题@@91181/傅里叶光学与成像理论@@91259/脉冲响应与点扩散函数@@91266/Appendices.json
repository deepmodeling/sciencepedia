{"hands_on_practices": [{"introduction": "点扩散函数（PSF）的一个核心应用是预测成像系统如何模糊一个物体。通过将物体的光强分布与系统的 $h(x)$ 进行卷积，我们可以精确计算出最终的图像 $i(x)$。本练习将通过一个一维双星系统的简化模型，带你亲手实践卷积运算，直观地理解PSF是如何将理想的点源“扩散”成模糊的像斑的 [@problem_id:2264542]。", "problem": "一个用于天文观测的一维成像系统，对准一个遥远的双星系统。这两颗恒星亮度相同，且间距很近。物体的空间强度分布 $o(x)$ 可以建模为两个点源之和，每个点源发射的总功率（通量）为 $F_0$。恒星位于 $x = -d/2$ 和 $x = +d/2$ 的位置。因此，物体分布由 $o(x) = F_0 \\left[ \\delta(x + d/2) + \\delta(x - d/2) \\right]$ 给出，其中 $\\delta(x)$ 是狄拉克δ函数。\n\n由于光学系统的不完美，成像系统会使点源模糊。这种模糊由系统的一维点扩展函数（PSF）来表征，记为 $h(x)$。PSF被归一化，使其总面积为1，以确保探测到的总功率等于发射的总功率。该系统PSF的具体形式是一个三角函数：\n$$\nh(x) = \\begin{cases} \\frac{1}{W} \\left(1 - \\frac{|x|}{W}\\right) & \\text{for } |x| \\le W \\\\ 0 & \\text{for } |x| > W \\end{cases}\n$$\n其中 $W$ 是一个表示模糊程度的参数。最终的图像强度分布 $i(x)$ 是物体分布与PSF的卷积。\n\n给定以下参数：\n- 每颗恒星的总通量, $F_0 = 1.00 \\times 10^{-7}$ W\n- 恒星之间的间距, $d = 6.00$ 微米\n- PSF宽度参数, $W = 10.0$ 微米\n\n计算所得图像在两颗恒星像的几何中心之间的中点处（即 $x=0$ 处）的强度。答案以 W/m 为单位，并四舍五入到三位有效数字。", "solution": "物体的一维强度分布为 $o(x) = F_{0}\\left[\\delta(x+d/2)+\\delta(x-d/2)\\right]$。图像强度是 $o(x)$ 与PSF $h(x)$ 的卷积：\n$$\ni(x) = \\int_{-\\infty}^{\\infty} o(\\xi)\\,h(x-\\xi)\\,d\\xi.\n$$\n利用狄拉克δ函数的筛选特性和卷积的线性性质，\n$$\ni(x) = F_{0}\\left[h\\left(x+\\frac{d}{2}\\right) + h\\left(x-\\frac{d}{2}\\right)\\right].\n$$\n在中点 $x=0$ 处，\n$$\ni(0) = F_{0}\\left[h\\left(\\frac{d}{2}\\right) + h\\left(-\\frac{d}{2}\\right)\\right] = 2F_{0}\\,h\\left(\\frac{d}{2}\\right),\n$$\n因为 $h(x)$ 是偶函数。PSF为\n$$\nh(x) = \\begin{cases}\n\\frac{1}{W}\\left(1-\\frac{|x|}{W}\\right), & |x|\\leq W,\\\\\n0, & |x|>W,\n\\end{cases}\n$$\n并且由于 $\\frac{d}{2} < W$，我们有\n$$\nh\\left(\\frac{d}{2}\\right) = \\frac{1}{W}\\left(1-\\frac{d}{2W}\\right).\n$$\n因此，\n$$\ni(0) = 2F_{0}\\,\\frac{1}{W}\\left(1-\\frac{d}{2W}\\right) = \\frac{2F_{0}}{W} - \\frac{F_{0}d}{W^{2}}.\n$$\n代入给定值，并将单位转换为米：$F_{0} = 1.00\\times 10^{-7}\\ \\text{W}$，$d = 6.00\\times 10^{-6}\\ \\text{m}$，$W = 1.00\\times 10^{-5}\\ \\text{m}$：\n$$\n\\frac{2F_{0}}{W} = \\frac{2\\times 1.00\\times 10^{-7}}{1.00\\times 10^{-5}} = 2.00\\times 10^{-2}\\ \\text{W/m},\n$$\n$$\n\\frac{F_{0}d}{W^{2}} = \\frac{1.00\\times 10^{-7}\\times 6.00\\times 10^{-6}}{\\left(1.00\\times 10^{-5}\\right)^{2}} = 6.00\\times 10^{-3}\\ \\text{W/m}.\n$$\n因此，\n$$\ni(0) = 2.00\\times 10^{-2} - 6.00\\times 10^{-3} = 1.40\\times 10^{-2}\\ \\text{W/m}.\n$$\n四舍五入到三位有效数字，$x=0$ 处的强度为 $1.40\\times 10^{-2}$ W/m。", "answer": "$$\\boxed{1.40 \\times 10^{-2}}$$", "id": "2264542"}, {"introduction": "点扩散函数的形状并非随意，它从根本上源于光波通过系统光瞳时发生的衍射。PSF与光瞳函数之间存在深刻的傅里叶变换关系，这意味着我们可以通过设计光瞳的形状来定制PSF。这个练习将让你像光学工程师一样思考，通过选择合适的光瞳来获得特定形状（拉长的）的PSF，从而加深对衍射与成像之间联系的理解 [@problem_id:2264538]。", "problem": "在一个理想化的、无像差的光学成像系统中，来自单个点光源的光在像平面中的分布由点扩散函数（Point Spread Function, PSF）描述。PSF由光从系统出射光瞳的衍射决定。光瞳的透射函数 $P(x_p, y_p)$ 与焦平面中光的复振幅 $U(x_f, y_f)$ 之间的关系由一个二维傅里叶变换给出。在开放孔径内的坐标 $(x_p, y_p)$ 处，光瞳函数 $P(x_p, y_p)$ 等于1，其他地方则为0。PSF是该复振幅的平方模：$\\text{PSF}(x_f, y_f) = |U(x_f, y_f)|^2$。\n\n考虑这样一个系统的光瞳形状。下列哪种光瞳形状会产生一个其中心亮斑区域在水平轴（$x_f$轴）上明显拉长，而在垂直轴（$y_f$轴）上受压缩的PSF？\n\nA. 半径为 $R$ 的圆形光瞳。\n\nB. 边长为 $L$ 的正方形光瞳。\n\nC. 水平宽度为 $W$，垂直高度为 $2W$ 的矩形光瞳。\n\nD. 水平宽度为 $2W$，垂直高度为 $W$ 的矩形光瞳。\n\nE. 等边三角形光瞳。", "solution": "Fraunhofer衍射原理指出，焦平面中的复振幅与光瞳透射函数的傅里叶变换成正比。使用焦距 $f$ 和波长 $\\lambda$，标量衍射积分给出\n$$\nU(x_{f},y_{f}) \\propto \\iint P(x_{p},y_{p}) \\exp\\!\\left(-i 2\\pi \\frac{x_{p}x_{f}+y_{p}y_{f}}{\\lambda f}\\right)\\,dx_{p}\\,dy_{p}.\n$$\n点扩散函数是光强\n$$\n\\text{PSF}(x_{f},y_{f}) = |U(x_{f},y_{f})|^{2}.\n$$\n\n对于可分离的矩形光瞳，设水平宽度为 $a$，垂直高度为 $b$。将光瞳写为 $P(x_{p},y_{p}) = \\Pi(x_{p}/a)\\,\\Pi(y_{p}/b)$，其中 $\\Pi$ 是单位矩形函数。傅里叶变换可以因式分解，得到\n$$\nU(x_{f},y_{f}) \\propto \\operatorname{sinc}\\!\\left(\\frac{a\\,x_{f}}{\\lambda f}\\right)\\,\\operatorname{sinc}\\!\\left(\\frac{b\\,y_{f}}{\\lambda f}\\right),\n$$\n其中 $\\operatorname{sinc}(\\xi) = \\frac{\\sin(\\pi \\xi)}{\\pi \\xi}$。主瓣的第一个零点出现在\n$$\n\\frac{a\\,x_{f}}{\\lambda f} = \\pm 1 \\quad\\Rightarrow\\quad |x_{f}|=\\frac{\\lambda f}{a}, \n\\qquad\n\\frac{b\\,y_{f}}{\\lambda f} = \\pm 1 \\quad\\Rightarrow\\quad |y_{f}|=\\frac{\\lambda f}{b}.\n$$\n因此，中心瓣沿 $x_{f}$ 的宽度与 $\\lambda f/a$ 成正比，沿 $y_{f}$ 的宽度与 $\\lambda f/b$ 成正比。因此：\n- 在给定光瞳坐标上较大的光瞳范围，会在相应的焦平面坐标上产生较窄的主瓣。\n- 较小的光瞳范围会产生较宽的主瓣。\n\n将此应用于各个选项：\n\nA. 半径为 $R$ 的圆形光瞳。其振幅为 $U \\propto \\frac{J_{1}(kR\\rho)}{kR\\rho}$，其中 $k=2\\pi/\\lambda$ 且 $\\rho=\\sqrt{x_{f}^{2}+y_{f}^{2}}/f$，产生一个各向同性的艾里斑（Airy pattern）。中心亮斑是圆形的，没有被拉长。\n\nB. 边长为 $L$ 的正方形光瞳。这是矩形在 $a=b=L$ 时的特例，因此沿 $x_{f}$ 和 $y_{f}$ 的主瓣宽度相等。没有拉长。\n\nC. 水平宽度为 $W$，垂直高度为 $2W$ 的矩形光瞳。这里 $a=W$ 且 $b=2W$，所以主瓣宽度沿 $x_{f}$ 为 $\\lambda f/W$，沿 $y_{f}$ 为 $\\lambda f/(2W)$。因此，中心亮斑沿 $x_{f}$ 方向更宽，沿 $y_{f}$ 方向更窄，即按要求水平拉长、垂直压缩。\n\nD. 水平宽度为 $2W$，垂直高度为 $W$ 的矩形光瞳。这里 $a=2W$ 且 $b=W$，得出水平宽度为 $\\lambda f/(2W)$，垂直宽度为 $\\lambda f/W$。这会产生相反的效果：水平压缩、垂直拉长。\n\nE. 等边三角形光瞳。其傅里叶变换表现出三重旋转对称性；中心瓣没有按照描述的方式在水平轴上被特别拉长并在垂直轴上被压缩。它不符合所述的拉长方式。\n\n因此，只有选项C能产生中心亮斑沿 $x_{f}$ 拉长、沿 $y_{f}$ 压缩的PSF。", "answer": "$$\\boxed{C}$$", "id": "2264538"}, {"introduction": "真实的成像系统通常由多个子系统串联而成，例如透镜和数字传感器，每个子系统都会引入一定程度的模糊。对于线性系统，一个优雅而强大的原则是，整个系统的总点扩散函数是其各个独立子系统PSF的卷积。本练习将引导你计算一个由透镜和传感器组成的系统的总PSF，展示如何将多个模糊源合并成一个等效的系统PSF [@problem_id:2264567]。", "problem": "一位光学工程师正在对一个新的数字成像系统进行特性分析。该系统可以建模为两个串联放置的独立光学子系统：一个主透镜和一个数字传感器阵列。对于一个线性空间不变的成像系统，其所成的图像 $I(x, y)$ 是真实物体亮度分布 $O(x, y)$ 与系统点扩散函数 (PSF) $h(x, y)$ 的二维卷积。PSF 代表了系统对一个理想化点光源的响应。\n\n每个子系统的模糊效应由其自身的 PSF 来描述。假设两个子系统都引入了圆对称高斯模糊。\n\n主透镜的 PSF，$h_L(x, y)$，由下式给出：\n$$h_L(x, y) = \\frac{1}{2\\pi \\sigma_L^2} \\exp\\left(-\\frac{x^2+y^2}{2\\sigma_L^2}\\right)$$\n其中 $\\sigma_L$ 是表征透镜模糊的标准差。\n\n数字传感器的内在 PSF，$h_S(x, y)$，考虑了像素间电荷扩散等效应，由下式给出：\n$$h_S(x, y) = \\frac{1}{2\\pi \\sigma_S^2} \\exp\\left(-\\frac{x^2+y^2}{2\\sigma_S^2}\\right)$$\n其中 $\\sigma_S$ 是表征传感器模糊的标准差。\n\n当这两个子系统串联组合时，整个成像系统的总 PSF，$h_{total}(x, y)$，是它们各自 PSF 的卷积。请确定总 PSF $h_{total}(x, y)$ 的解析表达式，该表达式应以 $x$、$y$、$\\sigma_L$ 和 $\\sigma_S$ 表示。", "solution": "对于一个线性空间不变系统，总 PSF 是各独立 PSF 的卷积：\n$$\nh_{total}(x,y) = \\iint_{-\\infty}^{\\infty} h_{L}(x-u,y-v)\\,h_{S}(u,v)\\, \\mathrm{d}u\\,\\mathrm{d}v.\n$$\n每个 PSF 都是圆对称高斯函数：\n$$\nh_{L}(x,y) = \\frac{1}{2\\pi \\sigma_{L}^{2}} \\exp\\!\\left(-\\frac{x^{2}+y^{2}}{2\\sigma_{L}^{2}}\\right), \\quad\nh_{S}(x,y) = \\frac{1}{2\\pi \\sigma_{S}^{2}} \\exp\\!\\left(-\\frac{x^{2}+y^{2}}{2\\sigma_{S}^{2}}\\right).\n$$\n这些函数在 $x$ 和 $y$ 上是可分离的，因为\n$$\nh_{L}(x,y) = \\left[\\frac{1}{\\sqrt{2\\pi}\\sigma_{L}} \\exp\\!\\left(-\\frac{x^{2}}{2\\sigma_{L}^{2}}\\right)\\right]\\left[\\frac{1}{\\sqrt{2\\pi}\\sigma_{L}} \\exp\\!\\left(-\\frac{y^{2}}{2\\sigma_{L}^{2}}\\right)\\right],\n$$\n对于 $h_{S}(x,y)$ 和 $\\sigma_{S}$ 也是如此。因此，二维卷积可以分解为在 $x$ 和 $y$ 上的两个一维卷积的乘积。考虑 $x$ 分量：\n$$\nI_{x}(x) = \\int_{-\\infty}^{\\infty} \\frac{1}{\\sqrt{2\\pi}\\sigma_{L}} \\exp\\!\\left(-\\frac{(x-u)^{2}}{2\\sigma_{L}^{2}}\\right)\\,\\frac{1}{\\sqrt{2\\pi}\\sigma_{S}} \\exp\\!\\left(-\\frac{u^{2}}{2\\sigma_{S}^{2}}\\right)\\,\\mathrm{d}u.\n$$\n合并指数项：\n$$\n-\\frac{(x-u)^{2}}{2\\sigma_{L}^{2}}-\\frac{u^{2}}{2\\sigma_{S}^{2}}=-\\frac{x^{2}}{2\\sigma_{L}^{2}}+\\frac{x}{\\sigma_{L}^{2}}u-\\frac{1}{2}\\left(\\frac{1}{\\sigma_{L}^{2}}+\\frac{1}{\\sigma_{S}^{2}}\\right)u^{2}.\n$$\n定义 $a=\\frac{1}{2}\\left(\\frac{1}{\\sigma_{L}^{2}}+\\frac{1}{\\sigma_{S}^{2}}\\right)$ 以及 $b=\\frac{x}{\\sigma_{L}^{2}}$。配方后得到\n$$\n-\\!a u^{2}+b u-\\frac{x^{2}}{2\\sigma_{L}^{2}}=-a\\left(u-\\frac{b}{2a}\\right)^{2}+a\\left(\\frac{b}{2a}\\right)^{2}-\\frac{x^{2}}{2\\sigma_{L}^{2}}.\n$$\n当 $2a=\\frac{1}{\\sigma_{L}^{2}}+\\frac{1}{\\sigma_{S}^{2}}=\\frac{\\sigma_{L}^{2}+\\sigma_{S}^{2}}{\\sigma_{L}^{2}\\sigma_{S}^{2}}$ 且 $b=\\frac{x}{\\sigma_{L}^{2}}$ 时，我们有\n$$\n\\frac{b}{2a}=\\frac{x\\sigma_{S}^{2}}{\\sigma_{L}^{2}+\\sigma_{S}^{2}}, \\quad a\\left(\\frac{b}{2a}\\right)^{2}-\\frac{x^{2}}{2\\sigma_{L}^{2}}=-\\frac{x^{2}}{2(\\sigma_{L}^{2}+\\sigma_{S}^{2})}.\n$$\n因此\n$$\nI_{x}(x)=\\frac{1}{2\\pi \\sigma_{L}\\sigma_{S}}\\exp\\!\\left(-\\frac{x^{2}}{2(\\sigma_{L}^{2}+\\sigma_{S}^{2})}\\right)\\int_{-\\infty}^{\\infty}\\exp\\!\\left(-a\\left(u-\\frac{b}{2a}\\right)^{2}\\right)\\mathrm{d}u.\n$$\n使用高斯积分 $\\int_{-\\infty}^{\\infty}\\exp(-a(u-\\mu)^{2})\\,\\mathrm{d}u=\\sqrt{\\pi/a}$（其中 $a>0$），并代入 $a=\\frac{\\sigma_{L}^{2}+\\sigma_{S}^{2}}{2\\sigma_{L}^{2}\\sigma_{S}^{2}}$，我们得到\n$$\nI_{x}(x)=\\frac{1}{2\\pi \\sigma_{L}\\sigma_{S}}\\sqrt{\\frac{\\pi}{a}}\\exp\\!\\left(-\\frac{x^{2}}{2(\\sigma_{L}^{2}+\\sigma_{S}^{2})}\\right)=\\frac{1}{\\sqrt{2\\pi}\\sqrt{\\sigma_{L}^{2}+\\sigma_{S}^{2}}}\\exp\\!\\left(-\\frac{x^{2}}{2(\\sigma_{L}^{2}+\\sigma_{S}^{2})}\\right).\n$$\n通过对 $y$ 进行相同的计算，我们得到\n$$\nI_{y}(y)=\\frac{1}{\\sqrt{2\\pi}\\sqrt{\\sigma_{L}^{2}+\\sigma_{S}^{2}}}\\exp\\!\\left(-\\frac{y^{2}}{2(\\sigma_{L}^{2}+\\sigma_{S}^{2})}\\right).\n$$\n因此，将独立的 $x$ 和 $y$ 的结果相乘，得到的总 PSF 为\n$$\nh_{total}(x,y)=I_{x}(x)\\,I_{y}(y)=\\frac{1}{2\\pi(\\sigma_{L}^{2}+\\sigma_{S}^{2})}\\exp\\!\\left(-\\frac{x^{2}+y^{2}}{2(\\sigma_{L}^{2}+\\sigma_{S}^{2})}\\right).\n$$\n这是一个圆对称高斯函数，其方差等于各独立方差之和，这与独立高斯模糊卷积的预期结果一致。", "answer": "$$\\boxed{\\frac{1}{2\\pi\\left(\\sigma_{L}^{2}+\\sigma_{S}^{2}\\right)}\\exp\\!\\left(-\\frac{x^{2}+y^{2}}{2\\left(\\sigma_{L}^{2}+\\sigma_{S}^{2}\\right)}\\right)}$$", "id": "2264567"}]}