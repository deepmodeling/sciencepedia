{"hands_on_practices": [{"introduction": "在光学成像中，光瞳的几何形状直接决定了系统能够分辨多精细的细节。这个练习将引导我们探索一个基本但至关重要的问题：在光通量相同（即面积相同）的情况下，方形光瞳和圆形光瞳哪个能提供更高的分辨率？通过计算并比较它们在特定方向上的截止频率，我们将直观地理解光瞳函数如何塑造相干传递函数（CTF）的边界，从而影响成像性能 [@problem_id:2259626]。", "problem": "在相干光学成像系统中，分辨精细细节的能力从根本上受到系统孔径（通常称为光瞳）衍射的限制。这种限制由相干传递函数（CTF）描述，它指定了系统可以传输到图像的空间频率范围。\n\nCTF，记作 $H(f_x, f_y)$，可以理解为光瞳函数 $P(u, v)$ 的一个缩放版本。光瞳函数在光瞳平面坐标 $(u, v)$ 中定义，在开放孔径内部其值为 1，在外部为 0。空间频率坐标 $(f_x, f_y)$ 与光瞳平面坐标之间的关系由 $f_x = u/(\\lambda d_i)$ 和 $f_y = v/(\\lambda d_i)$ 给出，其中 $\\lambda$ 是相干光的波长， $d_i$ 是从成像透镜到像平面的距离。\n\n在特定方向上的“截止频率”是该方向上 CTF 非零的最大空间频率幅值。这对应于光瞳平面中，光瞳从原点沿相应轴的最大空间范围。\n\n考虑两个除光瞳形状外完全相同的不同相干成像系统。\n- 系统 A 使用半径为 $R$ 的圆形光瞳。\n- 系统 B 使用边长为 $L$ 的方形光瞳。方形的边与 $u$ 轴和 $v$ 轴平行。\n\n两个光瞳的面积被设计为完全相同。\n\n确定圆形光瞳系统（系统 A）的截止频率与方形光瞳系统（系统 B）的截止频率之比，其中两个截止频率都沿 $f_x$ 轴方向测量。请以单个封闭形式的解析表达式给出您的答案。", "solution": "对于相干成像，CTF $H(f_{x},f_{y})$ 是通过映射 $u=\\lambda d_{i} f_{x}$ 和 $v=\\lambda d_{i} f_{y}$ 得到的缩放版光瞳函数 $P(u,v)$。因此，沿 $f_{x}$ 轴（即 $f_{y}=0$），截止频率由光瞳沿 $u$ 轴的最大范围确定，并按 $\\lambda d_{i}$ 进行缩放。具体来说，如果 $u_{\\max}$ 是使 $P(u,0)=1$ 的 $|u|$ 的最大值，那么沿 $f_{x}$ 的截止频率为\n$$\nf_{c}=\\frac{u_{\\max}}{\\lambda d_{i}}.\n$$\n对于系统 A（半径为 $R$ 的圆形光瞳），沿 $u$ 轴的最大范围是 $u_{\\max}^{(A)}=R$，得出\n$$\nf_{c}^{(A)}=\\frac{R}{\\lambda d_{i}}.\n$$\n对于系统 B（边长为 $L$ 的轴对齐方形光瞳），沿 $u$ 轴的最大范围是 $u_{\\max}^{(B)}=\\frac{L}{2}$，得出\n$$\nf_{c}^{(B)}=\\frac{L}{2\\lambda d_{i}}.\n$$\n两者的面积相等：圆形为 $\\pi R^{2}$，方形为 $L^{2}$，因此\n$$\n\\pi R^{2}=L^{2}\\quad\\Rightarrow\\quad L=\\sqrt{\\pi}\\,R.\n$$\n所求比率为\n$$\n\\frac{f_{c}^{(A)}}{f_{c}^{(B)}}=\\frac{\\frac{R}{\\lambda d_{i}}}{\\frac{L}{2\\lambda d_{i}}}=\\frac{2R}{L}=\\frac{2R}{\\sqrt{\\pi}\\,R}=\\frac{2}{\\sqrt{\\pi}}.\n$$\n该比率与 $\\lambda$ 和 $d_{i}$ 无关，因为它们在商中被消掉了。", "answer": "$$\\boxed{\\frac{2}{\\sqrt{\\pi}}}$$", "id": "2259626"}, {"introduction": "实际的光学系统可能采用比简单圆形或方形更复杂的光瞳形状以实现特定功能。本练习将挑战我们分析一个十字形光圈，这是一种复合形状。通过运用“容斥原理”来构建光瞳函数并计算其傅里叶变换，我们将掌握一种处理复杂叠加孔径的强大数学技巧，并加深对光瞳结构与其在频域中对应物之间关系的理解 [@problem_id:2259611]。", "problem": "在一个相干光学成像系统中，瞳面上的孔径光阑由一个在其他部分不透明的屏上的透明十字形开口定义。瞳面由笛卡尔坐标系 $(u, v)$ 描述。该十字形以原点为中心，由两个矩形区域的并集构成：一个宽度为 $w$、高度为 $L$ 的垂直矩形，以及一个宽度为 $L$、高度为 $w$ 的水平矩形。已知 $L > w$。\n\n一束均匀单色平面波正入射到此孔径上。观测其产生的远场（夫琅禾费）衍射图样。请求出远场图样中复振幅分布的表达式，结果可与一个总比例常数有差异。请将答案表示为空间频率 $(f_x, f_y)$ 和孔径尺寸 $L$、$w$ 的函数。\n\n在计算中，请使用未归一化的 sinc 函数，其定义为 $\\text{sinc}(x) = \\frac{\\sin(\\pi x)}{\\pi x}$。", "solution": "远场中的夫琅禾费衍射振幅与孔径透射函数的傅里叶变换成正比。设瞳面坐标为 $(u,v)$，空间频率为 $(f_{x},f_{y})$，则复振幅在不计一个与 $(f_{x},f_{y})$ 无关的总常数的情况下为：\n$$\nU(f_{x},f_{y}) \\propto \\iint T(u,v)\\,\\exp\\!\\left(-i 2\\pi\\left(f_{x}u+f_{y}v\\right)\\right)\\,du\\,dv,\n$$\n其中 $T(u,v)$ 是十字形孔径的特征函数。\n\n该十字形是以下区域的并集：\n- 一个宽度为 $w$（沿 $u$ 轴）、高度为 $L$（沿 $v$ 轴）的垂直矩形，以及\n- 一个宽度为 $L$（沿 $u$ 轴）、高度为 $w$（沿 $v$ 轴）的水平矩形，\n\n两者均以原点为中心。为避免重复计算重叠部分，使用容斥原理，该指示函数为\n$$\nT(u,v)=R_{w,L}(u,v)+R_{L,w}(u,v)-R_{w,w}(u,v),\n$$\n其中，当 $|u|\\leq a/2$ 且 $|v|\\leq b/2$ 时，$R_{a,b}(u,v)$ 等于 $1$，否则等于 $0$。\n\n一个尺寸为 $a\\times b$、中心在原点的矩形的傅里叶变换可以因式分解为：\n$$\n\\iint_{|u|\\leq a/2,\\;|v|\\leq b/2}\\exp\\!\\left(-i 2\\pi\\left(f_{x}u+f_{y}v\\right)\\right)\\,du\\,dv\n=\\left(\\int_{-a/2}^{a/2}\\exp(-i2\\pi f_{x}u)\\,du\\right)\\left(\\int_{-b/2}^{b/2}\\exp(-i2\\pi f_{y}v)\\,dv\\right).\n$$\n每个一维积分的计算结果为\n$$\n\\int_{-a/2}^{a/2}\\exp(-i2\\pi f u)\\,du=a\\,\\text{sinc}(a f),\n$$\n其中 $\\text{sinc}(x)=\\frac{\\sin(\\pi x)}{\\pi x}$。因此，\n$$\n\\mathcal{F}\\{R_{a,b}\\}(f_{x},f_{y})=ab\\,\\text{sinc}(a f_{x})\\,\\text{sinc}(b f_{y}).\n$$\n\n根据线性和容斥原理，\n$$\nU(f_{x},f_{y}) \\propto wL\\,\\text{sinc}(w f_{x})\\,\\text{sinc}(L f_{y})\n+Lw\\,\\text{sinc}(L f_{x})\\,\\text{sinc}(w f_{y})\n-w^{2}\\,\\text{sinc}(w f_{x})\\,\\text{sinc}(w f_{y}).\n$$\n这给出了夫琅禾费区域内复振幅的分布，结果与一个总比例常数相差。等价地，可以提取因子 $wL$ 写成\n$$\nU(f_{x},f_{y}) \\propto wL\\left[\\text{sinc}(w f_{x})\\,\\text{sinc}(L f_{y})\n+\\text{sinc}(L f_{x})\\,\\text{sinc}(w f_{y})\n-\\frac{w}{L}\\,\\text{sinc}(w f_{x})\\,\\text{sinc}(w f_{y})\\right].\n$$\n两种形式都是有效的，因为总比例常数可以吸收 $wL$。", "answer": "$$\\boxed{wL\\,\\text{sinc}(w f_{x})\\,\\text{sinc}(L f_{y})+Lw\\,\\text{sinc}(L f_{x})\\,\\text{sinc}(w f_{y})-w^{2}\\,\\text{sinc}(w f_{x})\\,\\text{sinc}(w f_{y})}$$", "id": "2259611"}, {"introduction": "到目前为止，我们都是从给定的光瞳函数出发去推导系统的光学特性。这个压轴练习将转换视角，模拟一个更接近实验实践的场景：从测得的系统输出——点扩展函数（PSF）——出发，反向推导系统的相干传递函数（CTF）。这个问题不仅强调了PSF和CTF之间深刻的傅里叶变换关系，还引入了“可分离性”这一实用概念，它能极大地简化二维系统的分析过程 [@problem_id:2259613]。", "problem": "一位光学工程师正在表征一个新型相干成像系统。该系统的性能由其相干点扩散函数(PSF)描述，记为$h(x, y)$，它是一个理想点源的像。系统对不同空间频率的响应由相干传递函数(CTF) $H(f_x, f_y)$给出，它通过二维傅里叶变换与PSF相关联。傅里叶变换及其逆变换定义如下：\n$$\nH(f_x, f_y) = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} h(x, y) \\exp(-i 2\\pi (f_x x + f_y y)) \\,dx\\,dy\n$$\n$$\nh(x, y) = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} H(f_x, f_y) \\exp(i 2\\pi (x f_x + y f_y)) \\,df_x\\,df_y\n$$\n根据光学元件的设计，该工程师知道PSF在笛卡尔坐标系中是可分离的，这意味着它可以写成两个一维函数的乘积，$h(x, y) = h_X(x)h_Y(y)$。\n\n通过沿$y$轴放置一个窄缝光阑，然后再沿$x$轴放置，工程师测量了PSF的横截面轮廓。测量得到以下函数：\n- 沿x轴：当$|x| \\le W_x$时，$h(x, 0) = A_0 \\left(1 - \\frac{|x|}{W_x}\\right)$，否则$h(x, 0) = 0$。\n- 沿y轴：当$|y| \\le W_y$时，$h(0, y) = A_0 \\left(1 - \\frac{|y|}{W_y}\\right)$，否则$h(0, y) = 0$。\n\n此处，$A_0$、$W_x$和$W_y$是已知的正常数，分别代表PSF的峰值振幅和空间范围。\n\n基于这些信息，推导出该系统的二维相干传递函数$H(f_x, f_y)$关于给定参数和空间频率$f_x$和$f_y$的完整表达式。", "solution": "我们已知相干PSF是可分离的，故可写为$h(x,y)=h_{X}(x)h_{Y}(y)$。测得的沿轴向横截面为：当$|x|\\leq W_{x}$时，$h(x,0)=A_{0}\\left(1-\\frac{|x|}{W_{x}}\\right)$，否则为$0$；以及当$|y|\\leq W_{y}$时，$h(0,y)=A_{0}\\left(1-\\frac{|y|}{W_{y}}\\right)$，否则为$0$。\n由于$h(x,0)=h_{X}(x)h_{Y}(0)$和$h(0,y)=h_{X}(0)h_{Y}(y)$，且三角形形状在原点有单位峰值，我们可以写出$h_{X}(x)=C_{x}\\,t_{x}(x)$和$h_{Y}(y)=C_{y}\\,t_{y}(y)$，\n其中\n$t_{x}(x)=\\begin{cases}1-\\frac{|x|}{W_{x}},&|x|\\leq W_{x}\\\\0,&\\text{其它}\\end{cases}$ 且 $t_{y}(y)=\\begin{cases}1-\\frac{|y|}{W_{y}},&|y|\\leq W_{y}\\\\0,&\\text{其它}\\end{cases}$，\n并且常数乘积满足$C_{x}C_{y}=A_{0}$，从而与测得的$h(x,0)=A_{0}t_{x}(x)$和$h(0,y)=A_{0}t_{y}(y)$相符。\n\n根据给定的傅里叶变换约定，\n$$\nH(f_{x},f_{y})=\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty}h(x,y)\\exp\\!\\big(-i2\\pi(f_{x}x+f_{y}y)\\big)\\,dx\\,dy,\n$$\n可分离性意味着\n$$\nH(f_{x},f_{y})=\\left(\\int_{-\\infty}^{\\infty}h_{X}(x)\\exp(-i2\\pi f_{x}x)\\,dx\\right)\\left(\\int_{-\\infty}^{\\infty}h_{Y}(y)\\exp(-i2\\pi f_{y}y)\\,dy\\right)\\equiv H_{X}(f_{x})H_{Y}(f_{y}).\n$$\n我们现在计算一维变换。注意，三角形函数可写为矩形函数的归一化卷积：\n$t_{x}(x)=\\frac{1}{W_{x}}\\big(\\mathrm{rect}(x/W_{x})*\\mathrm{rect}(x/W_{x})\\big)$，\n其中当$|u|\\leq \\frac{1}{2}$时$\\mathrm{rect}(u)=1$，否则为$0$。利用卷积定理和标准变换对\n$$\n\\int_{-\\infty}^{\\infty}\\mathrm{rect}(x/W)\\exp(-i2\\pi f x)\\,dx=W\\,\\frac{\\sin(\\pi W f)}{\\pi W f},\n$$\n我们得到\n$$\n\\int_{-\\infty}^{\\infty}t_{x}(x)\\exp(-i2\\pi f_{x}x)\\,dx=W_{x}\\left(\\frac{\\sin(\\pi W_{x} f_{x})}{\\pi W_{x} f_{x}}\\right)^{2}.\n$$\n因此，\n$$\nH_{X}(f_{x})=C_{x}W_{x}\\left(\\frac{\\sin(\\pi W_{x} f_{x})}{\\pi W_{x} f_{x}}\\right)^{2},\\quad\nH_{Y}(f_{y})=C_{y}W_{y}\\left(\\frac{\\sin(\\pi W_{y} f_{y})}{\\pi W_{y} f_{y}}\\right)^{2}.\n$$\n将两者相乘并利用$C_{x}C_{y}=A_{0}$，可得相干传递函数\n$$\nH(f_{x},f_{y})=A_{0}W_{x}W_{y}\\left(\\frac{\\sin(\\pi W_{x} f_{x})}{\\pi W_{x} f_{x}}\\right)^{2}\\left(\\frac{\\sin(\\pi W_{y} f_{y})}{\\pi W_{y} f_{y}}\\right)^{2}.\n$$\n此表达式为实数，关于$f_{x}$和$f_{y}$均为偶函数，并满足$H(0,0)=\\iint h(x,y)\\,dx\\,dy=A_{0}W_{x}W_{y}$，这与变换的定义一致。", "answer": "$$\\boxed{A_{0}W_{x}W_{y}\\left(\\frac{\\sin(\\pi W_{x} f_{x})}{\\pi W_{x} f_{x}}\\right)^{2}\\left(\\frac{\\sin(\\pi W_{y} f_{y})}{\\pi W_{y} f_{y}}\\right)^{2}}$$", "id": "2259613"}]}