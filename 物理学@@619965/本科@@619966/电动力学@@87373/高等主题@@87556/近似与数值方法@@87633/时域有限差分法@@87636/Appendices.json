{"hands_on_practices": [{"introduction": "在开始任何时域有限差分 (FDTD) 模拟之前，首要任务是建立一个稳定可靠的计算框架。本练习将引导您计算保证数值稳定性的关键参数——最大时间步长 $\\Delta t$。掌握 Courant 稳定性条件是进行任何有意义的 FDTD 模拟的基石，因为它直接关系到模拟结果是否物理上真实。[@problem_id:1581145]", "id": "1581145", "problem": "一位研究人员正在开发一个用于模拟光在硅基集成光子电路中传播的数值模型。该模型使用时域有限差分 (FDTD) 方法，沿着对应于直波导核心的一维路径求解麦克斯韦方程组。空间域被离散化为均匀网格，网格尺寸为 $\\Delta z = 1.50 \\, \\mu\\text{m}$。波导核心由硅制成，其可被建模为一种简单的、非磁性的、无损耗的介电介质，相对介电常数为 $\\epsilon_r = 11.68$。\n\n为确保 FDTD 仿真保持数值稳定并产生具有物理意义的结果，仿真中使用的时间步长 $\\Delta t$ 必须被谨慎选择。计算能够保证此一维仿真稳定性的最大可能时间步长 $\\Delta t_{\\text{max}}$。\n\n在您的计算中，使用真空中的光速 $c = 2.998 \\times 10^8 \\, \\text{m/s}$。\n\n将您的最终答案以飞秒 ($fs$) 为单位表示。将您的最终答案四舍五入至三位有效数字。", "solution": "对于一维 Yee FDTD 格式，Courant 稳定性条件要求基于介质中波速的 Courant 数满足\n$$\nS \\equiv \\frac{v\\,\\Delta t}{\\Delta z} \\leq 1,\n$$\n其中 $v$ 是介质中的电磁波速度。因此，最大稳定时间步长为\n$$\n\\Delta t_{\\text{max}}=\\frac{\\Delta z}{v}.\n$$\n在一个相对介电常数为 $\\epsilon_{r}$ 且 $\\mu_{r}=1$ 的简单、非磁性、无损耗介电介质中，波速为\n$$\nv=\\frac{1}{\\sqrt{\\mu \\epsilon}}=\\frac{c}{\\sqrt{\\epsilon_{r}}},\n$$\n所以\n$$\n\\Delta t_{\\text{max}}=\\frac{\\Delta z\\,\\sqrt{\\epsilon_{r}}}{c}.\n$$\n\n代入给定值 $\\Delta z=1.50 \\times 10^{-6}\\ \\text{m}$，$\\epsilon_{r}=11.68$ 和 $c=2.998 \\times 10^{8}\\ \\text{m/s}$，\n$$\n\\Delta t_{\\text{max}}=\\frac{\\left(1.50 \\times 10^{-6}\\right)\\sqrt{11.68}}{2.998 \\times 10^{8}}\\ \\text{s}.\n$$\n计算 $\\sqrt{11.68} \\approx 3.4176$，得到\n$$\n\\Delta t_{\\text{max}}=\\frac{1.50 \\times 10^{-6} \\times 3.4176}{2.998 \\times 10^{8}}\\ \\text{s}\n=\\frac{5.1264 \\times 10^{-6}}{2.998 \\times 10^{8}}\\ \\text{s}\n=\\left(\\frac{5.1264}{2.998}\\right)\\times 10^{-14}\\ \\text{s}\n\\approx 1.70995 \\times 10^{-14}\\ \\text{s}.\n$$\n使用 $1\\ \\text{fs}=10^{-15}\\ \\text{s}$ 换算为飞秒，\n$$\n\\Delta t_{\\text{max}} \\approx 17.0995\\ \\text{fs}.\n$$\n四舍五入至三位有效数字得到 $17.1\\ \\text{fs}$。", "answer": "$$\\boxed{17.1}$$"}, {"introduction": "在确定了模拟的空间分辨率后，一个重要的实际问题是评估所需的计算资源。本练习将帮助您估算一个 FDTD 模拟所需的基本内存，将抽象的网格点数量与具体的硬件需求（RAM）联系起来。通过这个看似简单的计算，您将对计算电磁学的规模和可行性有一个切实的感受，这对于规划和执行更大规模的二维或三维模拟至关重要。[@problem_id:1581133]", "id": "1581133", "problem": "一名研究人员正在使用时域有限差分(FDTD)方法开发一个一维(1D)模拟，以模拟波的传播。该模拟的空间域被离散化为一个由整好1,250,000个单元组成的网格。在这个简化的一维模型中，每个时间步都必须追踪两个不同的场分量（一个电场分量，一个磁场分量）。对于网格中的每个单元，这两个分量的值都必须被存储。每个场值由一个双精度浮点数表示，该浮点数占用8字节的计算机内存。\n\n计算在单个时间步内存储整个网格上这两个场分量的数据所需的最小随机存取存储器(RAM)。为便于计算，定义1兆字节(MB)为整好$10^6$字节。请以兆字节(MB)为单位表示你的最终答案。", "solution": "目标是计算存储一维FDTD模拟网格的场数据所需的总内存。我们已知单元数、每个单元的场分量数、每个场值的内存占用以及字节到兆字节的转换因子。\n\n**步骤1：确定已知量。**\n- 网格单元数, $N_{cells} = 1,250,000$。\n- 每个单元需存储的场分量数, $N_{fields} = 2$。\n- 存储一个场值所需的内存, $M_{value} = 8$ 字节。\n- 转换因子：1兆字节(MB) = $10^6$ 字节。\n\n**步骤2：计算需要存储的数据点总数。**\n该模拟需要为网格中的每个单元存储两个场分量。因此，需要存储在内存中的单个浮点值的总数是单元数与每个单元的场分量数的乘积。\n$$ \\text{Total data points} = N_{cells} \\times N_{fields} $$\n$$ \\text{Total data points} = 1,250,000 \\times 2 = 2,500,000 $$\n\n**步骤3：计算以字节为单位的总内存需求。**\n这些数据点中的每一个都是一个双精度数，占用8个字节。要计算以字节为单位的总内存需求，我们将数据点的总数乘以每个数据点的内存大小。\n$$ \\text{Total memory in bytes} = (\\text{Total data points}) \\times M_{value} $$\n$$ \\text{Total memory in bytes} = 2,500,000 \\times 8 \\text{ bytes} = 20,000,000 \\text{ bytes} $$\n\n**步骤4：将总内存从字节转换为兆字节。**\n题目规定1 MB等于$10^6$字节。我们可以使用这个转换因子将我们的结果表示为所需的单位。\n$$ \\text{Total memory in MB} = \\frac{\\text{Total memory in bytes}}{\\text{Bytes per MB}} $$\n$$ \\text{Total memory in MB} = \\frac{20,000,000 \\text{ bytes}}{10^6 \\text{ bytes/MB}} $$\n$$ \\text{Total memory in MB} = 20 \\text{ MB} $$\n\n因此，要存储模拟单个时间步的指定场数据，至少需要20 MB的RAM。", "answer": "$$\\boxed{20}$$"}, {"introduction": "FDTD 方法的一个强大应用是在单次模拟中获得设备的宽带频率响应。本练习探讨了如何通过巧妙地选择激励源来实现这一目标，比较了高斯脉冲和单频正弦波的效率。理解这一概念可以让您从耗时的“频率扫描”方法中解放出来，体现了从时域数据中通过傅里叶变换提取频域信息的强大能力，是现代电磁仿真中的标准实践。[@problem_id:1581132]", "id": "1581132", "problem": "在计算电磁学中，时域有限差分 (FDTD) 方法是一种强大的数值技术，用于模拟电磁波与复杂结构的相互作用。它的工作原理是对空间和时间进行离散化，并迭代求解麦克斯韦方程组。\n\n一名工程师想要表征一款新型微波滤波器的频率响应，该滤波器设计用于在 1 GHz 到 20 GHz 的宽带宽范围内工作。为此，他们进行了一次 FDTD 仿真：注入一个电磁源信号，让其在滤波器中传播，并记录透射出的信号。然后，便可以根据输入和输出信号确定频率响应。\n\n仿真中考虑使用两种类型的源信号：\n1.  单频正弦波，形式为 $E(t) = E_0 \\sin(2\\pi f_c t)$，其中 $f_c$ 是一个特定的载波频率。\n2.  短时高斯脉冲，形式为 $E(t) = E_0 \\exp\\left(-\\frac{(t-t_0)^2}{2\\sigma^2}\\right)$，其中 $t_0$ 是中心时间，$\\sigma$ 控制脉冲宽度。\n\n为了在整个 1 GHz 至 20 GHz 范围内获得器件的响应，使用单个高斯脉冲比使用一系列正弦波在计算上要高效得多。下列哪项陈述为这种卓越效率提供了正确的物理和计算原因？\n\nA. 使用宽带高斯脉冲进行单次 FDTD 仿真，然后对时域结果进行傅里叶变换，即可一次性获得器件在整个所需频谱范围内的响应。\nB. 与高频正弦波相比，使用高斯脉冲时 FDTD 方法所需的空间网格分辨率可以显著更粗，从而大幅减少总网格单元数和所需内存。\nC. 高斯脉冲具有确定的有限持续时间，使 FDTD 仿真能更快完成；而正弦波是连续的，需要无限长的仿真时间才能进行表征。\nD. 高斯脉冲在仿真的吸收边界条件下引起的数值反射较少，因此比正弦波能产生更稳定且收敛更快的解。\nE. 高斯脉冲的峰值幅度本质上低于可比较的正弦波，这可以防止导致 FDTD 算法减慢的数值溢出和不稳定性问题。", "solution": "核心任务是确定微波滤波器的频率响应，我们称之为 $H(f)$。频率响应是一个函数，描述滤波器如何在每个频率 $f$ 上改变输入信号的幅度和相位。在频域中，输出信号 $Y(f)$ 与输入信号 $X(f)$ 之间通过简单的乘法相关联：$Y(f) = H(f)X(f)$，其中 $X(f)$ 和 $Y(f)$ 分别是时域输入信号 $x(t)$ 和输出信号 $y(t)$ 的傅里叶变换。为了求出滤波器未知的频率响应，我们可以通过计算 $H(f) = \\frac{Y(f)}{X(f)}$ 来得到。\n\nFDTD 方法仿真的是一个线性时不变 (LTI) 系统。这个 LTI 属性至关重要。它意味着叠加原理成立，并且关系式 $H(f) = Y(f)/X(f)$ 是有效的。\n\n我们来分析两种用于在 1 GHz 至 20 GHz 频带上求取 $H(f)$ 的方法。\n\n**方法1：使用正弦波**\n为了求出单个频率（例如 $f_1 = 1$ GHz）处的响应，需要使用正弦输入 $x(t) = \\sin(2\\pi f_1 t)$ 运行一次完整的 FDTD 仿真。仿真必须运行足够长的时间，直到所有初始瞬态效应都衰减消失，系统达到“正弦稳态”。此时，测量输出信号 $y(t)$ 相对于输入的幅度和相位，从而得到 $H(f_1)$ 的值。为了在整个 1-20 GHz 频带上表征该滤波器，必须对频带内的大量离散频率（例如 1.1 GHz, 1.2 GHz, ..., 20 GHz）重复这整个过程。这涉及运行多次独立的、计算密集型的 FDTD 仿真，因此这种方法极为耗时。\n\n**方法2：使用高斯脉冲**\n此方法利用了傅里叶变换的特性。时域中的高斯脉冲的一个关键特性是，其傅里叶变换是频域中的一个高斯函数。通过正确选择脉冲的时域宽度 $\\sigma$，可以创建一个信号，其频谱非常宽，能够覆盖整个 1 GHz 到 20 GHz 的范围（甚至更广）并包含显著的能量。\n\n其步骤如下：\n1.  以宽带高斯脉冲作为输入 $x(t)$，运行*单次* FDTD 仿真。\n2.  仿真运行足够长的时间，以使脉冲穿过滤波器，并使整个仿真域中的场衰减到可忽略的水平。\n3.  在仿真期间，记录输入脉冲 $x(t)$（在滤波器前某点）和输出信号 $y(t)$（在滤波器后某点）的时域数据。\n4.  在单次仿真完成后，对记录的时间序列 $x(t)$ 和 $y(t)$ 进行快速傅里叶变换 (FFT)，以获得它们的频谱 $X(f)$ 和 $Y(f)$。\n5.  使用公式 $H(f) = \\frac{Y(f)}{X(f)}$，一步计算出滤波器在整个目标频带内的频率响应。\n\n这种方法仅需一次仿真即可获得完整的宽带频率响应，与正弦波法需要多次仿真相比，在计算效率上是巨大的提升。因此，陈述 A 正确地指出了效率提升的原因。\n\n现在我们来评估其他选项：\n- **B 是不正确的。** FDTD 网格尺寸取决于是否需要充分分辨仿真中存在的最小波长。最小波长对应于具有显著能量的*最高*频率分量。为了获得高达 20 GHz 的响应，高斯脉冲必须包含高达 20 GHz 的频率分量。因此，网格分辨率必须对 20 GHz 足够精细，这与扫频法中最高频率正弦波的要求相同。\n- **C 是不正确的。** 虽然正弦波确实是连续的，但在实践中，仿真是运行到达到稳态为止，并非无限长。真正的效率增益不在于有限与无限持续时间之争，而在于一次性获得所有频率数据。针对一个频率进行一次长时间的仿真，其效率仍然远低于一次（通常更短）就能产生所有频率结果的仿真。\n- **D 是不正确的。** 吸收边界条件（如完美匹配层，PML）的性能取决于边界本身的属性，而不是从根本上取决于源的类型。虽然某些波的特性（如入射角）会影响 PML 的性能，但没有普遍规律表明高斯脉冲与边界的相互作用比正弦波更有利，从而带来主要的效率增益。\n- **E 是不正确的。** FDTD 中任何源信号的峰值幅度都是一个用户可以设置的参数（即 $E_0$ 项）。可以轻易地将正弦波的峰值幅度设置得很低以避免不稳定性。高斯脉冲的效率优势与其峰值幅度无关。\n\n因此，效率提升的根本原因在于，一次使用宽带脉冲的时域仿真同时包含了所有频率的信息，这些信息可以通过傅里叶变换提取出来。", "answer": "$$\\boxed{A}$$"}]}