{"hands_on_practices": [{"introduction": "在我们能够进行计算之前，我们必须正确地构建问题。这个练习将重点放在关键的第一步：将一个静磁装置的物理描述转化为适用于每个区域的正确偏微分方程。这确保了我们的数值模拟是基于坚实的物理定律，并为有限元分析奠定了基础。[@problem_id:1616428]", "problem": "一位工程师的任务是使用有限元法 (FEM) 对一个长电磁执行器中的磁场分布进行建模。该执行器在 $xy$ 平面内的横截面由三个不同的区域组成：一个中心铁芯 ($\\Omega_{iron}$)，铁芯内一个非同心的圆柱形气隙 ($\\Omega_{air}$)，以及围绕铁芯的铜线圈区域 ($\\Omega_{coil}$)。铁芯由一种具有恒定相对磁导率 $\\mu_r$ 的软磁材料制成，因此其磁导率为 $\\mu_{iron} = \\mu_r \\mu_0$。气隙和铜线圈区域的磁导率假定为真空磁导率 $\\mu_0$。线圈承载着稳定的均匀直流电 (DC)，在区域 $\\Omega_{coil}$ 内产生轴向电流密度 $\\mathbf{J} = J_z \\hat{k}$，而在其他地方电流密度为零。\n\n由于系统的长度很长，该问题可以被视为二维问题。磁场由电流 $J_z$ 产生，需要求解的合适的势是磁矢量势的 $z$ 分量, $A_z(x, y)$。整个执行器在一个大的计算边界框内进行建模，在该边界框的外边界 $\\Gamma_{box}$ 上，假定磁矢量势为零，即 $A_z = 0$。\n\n为了设置仿真，工程师必须为三个区域（$\\Omega_{iron}$、$\\Omega_{air}$、$\\Omega_{coil}$）中的每一个区域定义 $A_z$ 的控制偏微分方程。下列哪组方程正确描述了需要通过 FEM 软件求解的物理问题？\n\nA. 问题在所有区域均由拉普拉斯方程描述：\n- 在 $\\Omega_{iron}$ 中：$-\\nabla^2 A_z = 0$\n- 在 $\\Omega_{air}$ 中：$-\\nabla^2 A_z = 0$\n- 在 $\\Omega_{coil}$ 中：$-\\nabla^2 A_z = 0$\n\nB. 问题由一个泊松方程描述，其中源项 $J_z$ 存在于所有区域：\n- 在 $\\Omega_{iron}$ 中：$-\\nabla \\cdot (\\frac{1}{\\mu_{iron}} \\nabla A_z) = J_z$\n- 在 $\\Omega_{air}$ 中：$-\\nabla \\cdot (\\frac{1}{\\mu_0} \\nabla A_z) = J_z$\n- 在 $\\Omega_{coil}$ 中：$-\\nabla \\cdot (\\frac{1}{\\mu_0} \\nabla A_z) = J_z$\n\nC. 问题由一组方程描述，其中源项 $J_z$ 仅在线圈区域非零：\n- 在 $\\Omega_{iron}$ 中：$-\\nabla \\cdot (\\frac{1}{\\mu_{iron}} \\nabla A_z) = 0$\n- 在 $\\Omega_{air}$ 中：$-\\nabla \\cdot (\\frac{1}{\\mu_0} \\nabla A_z) = 0$\n- 在 $\\Omega_{coil}$ 中：$-\\nabla \\cdot (\\frac{1}{\\mu_0} \\nabla A_z) = J_z$\n\nD. 问题由一个不正确的公式描述，该公式不当地使用了磁导率而非磁阻率：\n- 在 $\\Omega_{iron}$ 中：$-\\nabla \\cdot (\\mu_{iron} \\nabla A_z) = 0$\n- 在 $\\Omega_{air}$ 中：$-\\nabla \\cdot (\\mu_0 \\nabla A_z) = 0$\n- 在 $\\Omega_{coil}$ 中：$-\\nabla \\cdot (\\mu_0 \\nabla A_z) = J_z$\n\nE. 问题由单一形式的泊松方程 $-\\nabla^2 A_z = \\mu J_z$ 描述，并应用于所有区域：\n- 在 $\\Omega_{iron}$ 中：$-\\nabla^2 A_z = \\mu_{iron} J_z$\n- 在 $\\Omega_{air}$ 中：$-\\nabla^2 A_z = \\mu_0 J_z$\n- 在 $\\Omega_{coil}$ 中：$-\\nabla^2 A_z = \\mu_0 J_z$", "solution": "我们在静磁学框架下，使用麦克斯韦方程组和磁矢量势进行求解。控制方程为\n$$\n\\nabla \\times \\mathbf{H} = \\mathbf{J}, \\quad \\nabla \\cdot \\mathbf{B} = 0, \\quad \\mathbf{B} = \\mu \\mathbf{H}, \\quad \\mathbf{B} = \\nabla \\times \\mathbf{A}.\n$$\n在二维设定中，选择仅有非零轴向分量的磁矢量势，我们设 $\\mathbf{A} = A_{z}(x,y)\\,\\hat{k}$。则\n$$\n\\mathbf{B} = \\nabla \\times \\mathbf{A} = \\left(\\frac{\\partial A_{z}}{\\partial y}\\right)\\hat{i} - \\left(\\frac{\\partial A_{z}}{\\partial x}\\right)\\hat{j} + 0\\,\\hat{k}.\n$$\n使用本构关系 $\\mathbf{H} = \\frac{1}{\\mu}\\mathbf{B}$ （其中 $\\mu$ 为标量、分段常数），我们得到\n$$\nH_{x} = \\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial y}, \\quad H_{y} = -\\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial x}.\n$$\n安培定律给出了 $z$ 分量的源方程：\n$$\nJ_{z} = \\left(\\nabla \\times \\mathbf{H}\\right)_{z} = \\frac{\\partial H_{y}}{\\partial x} - \\frac{\\partial H_{x}}{\\partial y}.\n$$\n代入 $H_{x}$ 和 $H_{y}$，\n$$\nJ_{z} = \\frac{\\partial}{\\partial x}\\left(-\\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial x}\\right) - \\frac{\\partial}{\\partial y}\\left(\\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial y}\\right)\n= -\\frac{\\partial}{\\partial x}\\left(\\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial x}\\right) - \\frac{\\partial}{\\partial y}\\left(\\frac{1}{\\mu}\\frac{\\partial A_{z}}{\\partial y}\\right).\n$$\n这可以紧凑地写为\n$$\n-\\nabla \\cdot \\left(\\frac{1}{\\mu}\\nabla A_{z}\\right) = J_{z}.\n$$\n外边界上的边界条件为在 $\\Gamma_{box}$ 上 $A_{z} = 0$。\n\n材料属性是分段常数：\n$$\n\\mu = \\mu_{iron} = \\mu_{r}\\mu_{0} \\text{ in } \\Omega_{iron}, \\quad \\mu = \\mu_{0} \\text{ in } \\Omega_{air}, \\quad \\mu = \\mu_{0} \\text{ in } \\Omega_{coil}.\n$$\n源电流密度是轴向的，并且局限于线圈区域：\n$$\nJ_{z} \\neq 0 \\text{ in } \\Omega_{coil}, \\quad J_{z} = 0 \\text{ in } \\Omega_{iron} \\cup \\Omega_{air}.\n$$\n因此，每个区域的控制偏微分方程为\n$$\n-\\nabla \\cdot \\left(\\frac{1}{\\mu_{iron}}\\nabla A_{z}\\right) = 0 \\quad \\text{in } \\Omega_{iron},\n$$\n$$\n-\\nabla \\cdot \\left(\\frac{1}{\\mu_{0}}\\nabla A_{z}\\right) = 0 \\quad \\text{in } \\Omega_{air},\n$$\n$$\n-\\nabla \\cdot \\left(\\frac{1}{\\mu_{0}}\\nabla A_{z}\\right) = J_{z} \\quad \\text{in } \\Omega_{coil}.\n$$\n这与选项 C 相符。选项 A 忽略了线圈中的源。选项 B 错误地将源应用于所有区域。选项 D 在微分算子中错误地使用了 $\\mu$ 而不是 $1/\\mu$。选项 E 使用 $-\\nabla^{2}A_{z}=\\mu J_{z}$；虽然这在具有恒定 $\\mu$ 的单个均匀区域内是等效的，但它不是跨越具有不同 $\\mu$ 的多个区域所需的正确非均匀公式，并且它还误导性地在必须明确强制 $J_{z}=0$ 的区域中呈现了源项。因此，正确的公式是选项 C。", "answer": "$$\\boxed{C}$$", "id": "1616428"}, {"introduction": "有限元法的核心在于将一个大型的方程组分解为许多简单的、局部的“单元”矩阵，然后再将它们组装起来。这个练习提供了一个亲手计算准静态问题中一个典型单元矩阵项的机会。通过这个过程，你将理解材料属性、几何形状和工作频率是如何被编码进模型的数值核心中。[@problem_id:1616444]", "problem": "在采用有限元法（FEM）对导体中的涡流进行数值建模时，一项关键的计算任务是评估对导体横截面进行网格划分的微小离散三角形单元上的耦合积分。这些积分构成了单元特征矩阵的元。\n\n考虑一个这样的线性三角形单元，它由三个顶点处的节点定义，坐标分别为：节点1位于 $(0, 0)$，节点2位于 $(h, 0)$，节点3位于 $(0, a)$。该单元内的一个物理量使用线性基函数（也称为形函数）$N_1(x,y)$、$N_2(x,y)$和$N_3(x,y)$来近似。基函数$N_i(x,y)$在节点$i$处的值为1，在另外两个节点处的值为0。\n\n你的任务是计算此单元上基函数$N_1$和$N_2$之间的复值耦合积分$Z_{12}$。该积分定义为：\n$$ Z_{12} = \\int_{\\text{element}} \\left( \\frac{1}{\\mu} (\\nabla N_1 \\cdot \\nabla N_2) + j\\omega\\sigma (N_1 N_2) \\right) dA $$\n其中$\\mu$是磁导率，$\\sigma$是电导率，$\\omega$是角频率，$j = \\sqrt{-1}$，积分区域为三角形单元的面积。\n\n使用以下非磁性铜导体的参数来计算$Z_{12}$的数值：\n- 单元尺寸：$h = 1.000$ mm, $a = 2.000$ mm\n- 电导率：$\\sigma = 5.800 \\times 10^7$ S/m\n- 磁导率：$\\mu = 4\\pi \\times 10^{-7}$ H/m\n- 工作频率：$f = 60.00$ Hz\n\n你的答案应以包含$Z_{12}$实部和虚部的行矩阵形式给出，格式为$[\\text{Re}(Z_{12}) \\quad \\text{Im}(Z_{12})]$。数值必须以SI单位$m \\cdot \\Omega^{-1} \\cdot s^{-1}$表示，并四舍五入到四位有效数字。最终答案中不要包含单位。", "solution": "我们使用满足在节点$i$处$N_{i}=1$而在其他节点处为0的线性形函数，来对节点位于$(0,0)$、$(h,0)$和$(0,a)$的线性三角形单元进行建模。对于这个直角三角形，\n$$\nN_{1}(x,y)=1-\\frac{x}{h}-\\frac{y}{a},\\quad N_{2}(x,y)=\\frac{x}{h},\\quad N_{3}(x,y)=\\frac{y}{a}.\n$$\n它们的梯度（在单元上是常数）为\n$$\n\\nabla N_{1}=\\left(-\\frac{1}{h},-\\frac{1}{a}\\right),\\quad \\nabla N_{2}=\\left(\\frac{1}{h},0\\right),\\quad \\nabla N_{3}=\\left(0,\\frac{1}{a}\\right).\n$$\n因此，\n$$\n\\nabla N_{1}\\cdot \\nabla N_{2}=-\\frac{1}{h^{2}}.\n$$\n单元面积为$A=\\frac{1}{2}ah$。耦合积分为\n$$\nZ_{12}=\\int_{\\text{element}}\\left(\\frac{1}{\\mu}\\,\\nabla N_{1}\\cdot \\nabla N_{2}+j\\omega\\sigma\\,N_{1}N_{2}\\right)\\,dA\n=\\frac{1}{\\mu}\\left(\\nabla N_{1}\\cdot \\nabla N_{2}\\right)A+j\\omega\\sigma\\int_{\\text{element}}N_{1}N_{2}\\,dA.\n$$\n对于线性三角形，一致质量矩阵元满足$\\int_{\\text{element}}N_{1}N_{2}\\,dA=\\frac{A}{12}$。我们也可以通过直接积分来验证：\n$$\n\\int_{\\text{element}}N_{1}N_{2}\\,dA=\\int_{0}^{h}\\int_{0}^{a(1-x/h)}\\left(\\frac{x}{h}\\right)\\left(1-\\frac{x}{h}-\\frac{y}{a}\\right)\\,dy\\,dx\n=\\frac{ah}{24}=\\frac{A}{12}.\n$$\n因此，\n$$\nZ_{12}=-\\frac{A}{\\mu h^{2}}+j\\,\\omega\\sigma\\,\\frac{A}{12}\n=-\\frac{a}{2\\mu h}+j\\,\\omega\\sigma\\,\\frac{ah}{24}.\n$$\n代入给定参数，并转换为SI单位：$h=1.000\\times 10^{-3}\\,\\text{m}$，$a=2.000\\times 10^{-3}\\,\\text{m}$，$\\sigma=5.800\\times 10^{7}\\,\\text{S/m}$，$\\mu=4\\pi\\times 10^{-7}\\,\\text{H/m}$，且$\\omega=2\\pi f=2\\pi\\times 60.00=120\\pi\\,\\text{s}^{-1}$。计算实部：\n$$\n\\operatorname{Re}(Z_{12})=-\\frac{a}{2\\mu h}=-\\frac{2.000\\times 10^{-3}}{2\\,(4\\pi\\times 10^{-7})\\,(1.000\\times 10^{-3})}=-\\frac{1}{4\\pi\\times 10^{-7}}.\n$$\n因此 $\\operatorname{Re}(Z_{12})=-\\frac{10^{7}}{4\\pi}\\approx -7.957747\\times 10^{5}$。\n\n计算虚部：\n$$\n\\operatorname{Im}(Z_{12})=\\omega\\sigma\\,\\frac{ah}{24}=\\frac{2\\pi f\\,\\sigma\\,ah}{24}=\\frac{\\pi f\\,\\sigma\\,ah}{12}.\n$$\n当$f=60.00$时，此式简化为\n$$\n\\operatorname{Im}(Z_{12})=5\\pi\\,\\sigma\\,a h=5\\pi\\,(5.800\\times 10^{7})\\,(2.000\\times 10^{-3})(1.000\\times 10^{-3})=5\\pi\\,(116)=580\\pi\\approx 1.822\\times 10^{3}.\n$$\n按要求，两部分的单位均为$\\,\\text{m}\\cdot\\Omega^{-1}\\cdot\\text{s}^{-1}$。四舍五入到四位有效数字得到\n$$\n\\operatorname{Re}(Z_{12})\\approx -7.958\\times 10^{5},\\quad \\operatorname{Im}(Z_{12})\\approx 1.822\\times 10^{3}.\n$$\n因此，所要求的行矩阵如下。", "answer": "$$\\boxed{\\begin{pmatrix}-7.958 \\times 10^{5} & 1.822 \\times 10^{3}\\end{pmatrix}}$$", "id": "1616444"}, {"introduction": "对电势场或磁场的求解通常只是第一步，真正的工程价值来自于从这些场中推导出如力或转矩等物理量。这个练习演示了如何对静电模拟的结果进行“后处理”来计算作用在介电元件上的力。这是设计执行器、传感器和其他机电设备时至关重要的一步。[@problem_id:1616429]", "problem": "在静电学中，不仅非均匀电场可以对电介质材料施加力，当材料本身具有空间变化的介电常数时，即使在均匀场中也会受到力的作用。这种力的物理来源由开尔文力密度描述，$\\mathbf{f}_v = -\\frac{1}{2} |\\mathbf{E}(\\mathbf{r})|^2 \\nabla\\epsilon(\\mathbf{r})$，其中 $\\mathbf{E}(\\mathbf{r})$ 是电场，$\\epsilon(\\mathbf{r})$ 是位置 $\\mathbf{r}$ 处的介电常数。\n\n考虑一个使用有限元法（FEM）建模的二维静电学问题。问题域被离散化为线性三角形单元。我们关注其中一个单元，其厚度为均匀的 $t$。该三角形的顶点（节点）标记为 1、2 和 3，分别位于坐标 $(x_1, y_1)$、$(x_2, y_2)$ 和 $(x_3, y_3)$ 处。三角形面的面积记为 $A$。通过先前的有限元全局求解得到的这些节点上的电势为 $\\phi_1, \\phi_2,$ 和 $\\phi_3$。\n\n在该特定单元内，介电常数梯度被假定为一个恒定矢量，由 $\\mathbf{g} = (g_x, g_y)$ 给出。使用线性单元的一个关键特征是，近似电场 $\\mathbf{E}^h$ 在整个单元内是恒定的。作用在该单元上的合力矢量 $\\mathbf{F}_e$ 是通过对力密度在单元体积上积分得到的，并且可以证明它与介电常数梯度矢量 $\\mathbf{g}$ 成正比，即 $\\mathbf{F}_e = C\\mathbf{g}$。\n\n您的任务是推导标量比例因子 $C$ 的符号表达式。请用节点电势 $\\phi_1, \\phi_2, \\phi_3$、节点坐标 $(x_i, y_i)$、单元面积 $A$ 及其厚度 $t$ 来表示您的答案。", "solution": "开尔文力密度为 $\\mathbf{f}_{v} = -\\frac{1}{2}|\\mathbf{E}(\\mathbf{r})|^{2}\\nabla\\epsilon(\\mathbf{r})$。在线性三角形单元内，介电常数梯度 $\\mathbf{g}=\\nabla\\epsilon$ 和有限元电场 $\\mathbf{E}^{h}$ 都是恒定的。因此，单元力为\n$$\n\\mathbf{F}_{e}=\\int_{V_{e}}\\mathbf{f}_{v}\\,dV=-\\frac{1}{2}\\,|\\mathbf{E}^{h}|^{2}\\,\\mathbf{g}\\int_{V_{e}}dV=-\\frac{1}{2}\\,|\\mathbf{E}^{h}|^{2}\\,A\\,t\\,\\mathbf{g},\n$$\n这表明 $\\mathbf{F}_{e}=C\\,\\mathbf{g}$，其中\n$$\nC=-\\frac{1}{2}\\,A\\,t\\,|\\mathbf{E}^{h}|^{2}.\n$$\n为了用节点数据表示 $|\\mathbf{E}^{h}|^{2}$，我们使用线性插值 $\\phi^{h}(x,y)=\\sum_{i=1}^{3}N_{i}(x,y)\\,\\phi_{i}$ 和线性形函数。对于线性三角形，\n$$\n\\nabla N_{i}=\\frac{1}{2A}\\begin{bmatrix}b_{i}\\\\ c_{i}\\end{bmatrix},\\quad\nb_{1}=y_{2}-y_{3},\\;b_{2}=y_{3}-y_{1},\\;b_{3}=y_{1}-y_{2},\\quad\nc_{1}=x_{3}-x_{2},\\;c_{2}=x_{1}-x_{3},\\;c_{3}=x_{2}-x_{1}.\n$$\n使用 $\\mathbf{E}^{h}=-\\nabla\\phi^{h}=-\\sum_{i=1}^{3}\\phi_{i}\\nabla N_{i}$，其分量为\n$$\nE_{x}^{h}=-\\frac{1}{2A}\\sum_{i=1}^{3}\\phi_{i}b_{i},\\qquad\nE_{y}^{h}=-\\frac{1}{2A}\\sum_{i=1}^{3}\\phi_{i}c_{i},\n$$\n因此\n$$\n|\\mathbf{E}^{h}|^{2}=\\frac{1}{4A^{2}}\\left[\\left(\\sum_{i=1}^{3}\\phi_{i}b_{i}\\right)^{2}+\\left(\\sum_{i=1}^{3}\\phi_{i}c_{i}\\right)^{2}\\right].\n$$\n代入 $C$ 可得\n$$\nC=-\\frac{t}{8A}\\left[\\left(\\phi_{1}b_{1}+\\phi_{2}b_{2}+\\phi_{3}b_{3}\\right)^{2}+\\left(\\phi_{1}c_{1}+\\phi_{2}c_{2}+\\phi_{3}c_{3}\\right)^{2}\\right],\n$$\n即，用节点坐标显式表示为\n$$\nC=-\\frac{t}{8A}\\left[\\left(\\phi_{1}(y_{2}-y_{3})+\\phi_{2}(y_{3}-y_{1})+\\phi_{3}(y_{1}-y_{2})\\right)^{2}+\\left(\\phi_{1}(x_{3}-x_{2})+\\phi_{2}(x_{1}-x_{3})+\\phi_{3}(x_{2}-x_{1})\\right)^{2}\\right].\n$$", "answer": "$$\\boxed{-\\frac{t}{8A}\\left[\\left(\\phi_{1}(y_{2}-y_{3})+\\phi_{2}(y_{3}-y_{1})+\\phi_{3}(y_{1}-y_{2})\\right)^{2}+\\left(\\phi_{1}(x_{3}-x_{2})+\\phi_{2}(x_{1}-x_{3})+\\phi_{3}(x_{2}-x_{1})\\right)^{2}\\right]}$$", "id": "1616429"}]}