{"hands_on_practices": [{"introduction": "将连续模型转化为离散模型是进行计算机仿真的第一步。本练习将从最基础的指数增长模型 $\\dot{P} = rP$ 出发，带你体验这个转化过程。通过应用前向欧拉法，你将把一个描述连续变化的微分方程，改写成一个计算机可以逐步执行的迭代规则，这是连接理论与实践的基础技能 [@problem_id:1669660]。", "problem": "一位计算机科学家正在开发一个简单的人工生命（A-Life）模拟。在这个模拟中，一个自我复制的数字生物的种群在连续时间 $t$ 由 $P(t)$ 表示，其变化遵循微分方程 $\\frac{dP}{dt} = rP$，其中 $r$ 是一个代表净增长率的恒定正常数参数。\n\n该模拟的引擎无法连续地对系统进行建模，而是以固定时长 $h$ 的离散时间步长来更新世界。在时间步长 $n$ 时的种群由 $P_n$ 表示。为了计算下一个时间步长 $P_{n+1}$ 时的种群，引擎使用一个简单的近似方法：它假设在从时间 $t_n$ 到 $t_{n+1} = t_n + h$ 的整个时间区间内，种群变化率是恒定的，并且等于在该区间开始时 $t_n$ 计算出的速率。\n\n基于此离散更新规则，请推导一个用 $P_n$、增长率 $r$ 和步长 $h$ 表示的种群 $P_{n+1}$ 的表达式。", "solution": "我们给定的条件是连续模型 $\\frac{dP}{dt}=rP$（$r>0$为常数），以及引擎以大小为 $h$ 的离散步长（$t_{n+1}=t_{n}+h$）进行更新，并近似认为在区间 $\\left[t_{n},t_{n+1}\\right]$ 上的变化率恒定，且等于其在 $t_n$ 处的值。这意味着我们近似为\n$$\n\\frac{dP}{dt}\\bigg|_{t\\in[t_{n},t_{n+1}]} \\approx \\frac{dP}{dt}\\bigg|_{t=t_{n}}=rP(t_{n})=rP_{n}.\n$$\n使用微积分基本定理，\n$$\nP_{n+1}-P_{n}=\\int_{t_{n}}^{t_{n+1}}\\frac{dP}{dt}\\,dt \\approx \\int_{t_{n}}^{t_{n+1}} rP_{n}\\,dt = rP_{n}\\,(t_{n+1}-t_{n})=rP_{n}\\,h.\n$$\n重新整理得到离散更新规则\n$$\nP_{n+1}=P_{n}+hrP_{n}=(1+rh)P_{n}.\n$$\n这是从所述的恒定斜率近似推导出的前向欧拉更新式。", "answer": "$$\\boxed{(1+rh)P_{n}}$$", "id": "1669660"}, {"introduction": "许多物理系统，如钟摆或弹簧，都由二阶微分方程描述。这个练习将处理一个更复杂的阻尼摆模型，教你如何将其转化为计算机可以模拟的离散时间系统。你需要先将二阶方程降阶为一阶方程组——这是处理高阶系统的标准技巧——然后再应用前向欧拉法进行离散化 [@problem_id:1669637]。", "problem": "一位计算物理学家正在为一个阻尼非线性摆开发一个模拟程序。该摆的运动由以下连续时间微分方程描述：\n$$\n\\frac{d^2\\theta}{dt^2} + b \\frac{d\\theta}{dt} + k \\sin(\\theta) = 0\n$$\n其中 $\\theta(t)$ 是摆在时间 $t$ 时与垂直方向的夹角，$b$ 是一个正的阻尼系数，$k$ 是一个与重力和摆长相关的正常数。\n\n为了在数值上实现这个模型，该物理学家需要将连续方程转换为一组离散时间更新规则。系统在离散时间步 $n$ 的状态由数对 $(\\theta_n, \\omega_n)$ 表示，其中 $\\theta_n$ 是角度，$\\omega_n$ 是角速度。该模拟以时长为 $\\Delta t$ 的固定时间增量进行。\n\n使用时间导数的一阶前向差分近似，其中在时间步 $n$ 的导数 $\\frac{dy}{dt}$ 近似为 $\\frac{y_{n+1} - y_n}{\\Delta t}$，推导出该系统的更新规则。求出在时间步 $n+1$ 时的角度 $\\theta_{n+1}$ 和角速度 $\\omega_{n+1}$ 的表达式。表达式应使用时间步 $n$ 的状态变量（即 $\\theta_n$ 和 $\\omega_n$）、时间步长 $\\Delta t$ 以及系统参数 $b$ 和 $k$ 来表示。\n\n请提供最终得到的表达式对 $(\\theta_{n+1}, \\omega_{n+1})$ 作为你的最终答案。", "solution": "我们从连续时间的二阶方程开始\n$$\n\\frac{d^{2}\\theta}{dt^{2}} + b \\frac{d\\theta}{dt} + k \\sin(\\theta) = 0.\n$$\n引入角速度 $\\omega(t)$，其定义为\n$$\n\\omega(t) = \\frac{d\\theta}{dt}.\n$$\n这将二阶方程转换为一个一阶系统\n$$\n\\frac{d\\theta}{dt} = \\omega, \\qquad \\frac{d\\omega}{dt} = -b\\,\\omega - k \\sin(\\theta).\n$$\n在时间步 $n$ 使用一阶前向差分近似，\n$$\n\\left.\\frac{dy}{dt}\\right|_{t_{n}} \\approx \\frac{y_{n+1} - y_{n}}{\\Delta t},\n$$\n我们将每个方程离散化如下。\n\n对于角度的更新，我们将前向差分应用于 $\\frac{d\\theta}{dt} = \\omega$：\n$$\n\\frac{\\theta_{n+1} - \\theta_{n}}{\\Delta t} = \\omega_{n}\n\\;\\;\\Rightarrow\\;\\;\n\\theta_{n+1} = \\theta_{n} + \\Delta t\\,\\omega_{n}.\n$$\n\n对于角速度的更新，我们将前向差分应用于 $\\frac{d\\omega}{dt} = -b\\,\\omega - k \\sin(\\theta)$：\n$$\n\\frac{\\omega_{n+1} - \\omega_{n}}{\\Delta t} = -b\\,\\omega_{n} - k \\sin(\\theta_{n})\n\\;\\;\\Rightarrow\\;\\;\n\\omega_{n+1} = \\omega_{n} - \\Delta t\\left(b\\,\\omega_{n} + k \\sin(\\theta_{n})\\right).\n$$\n\n因此，将 $(\\theta_{n},\\omega_{n})$ 在一个时间步长 $\\Delta t$ 内推进到 $(\\theta_{n+1},\\omega_{n+1})$ 的显式前向欧拉更新规则是\n$$\n\\theta_{n+1} = \\theta_{n} + \\Delta t\\,\\omega_{n}, \\qquad\n\\omega_{n+1} = \\omega_{n} - \\Delta t\\left(b\\,\\omega_{n} + k \\sin(\\theta_{n})\\right).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\theta_{n} + \\Delta t\\,\\omega_{n} & \\omega_{n} - \\Delta t\\left(b\\,\\omega_{n} + k \\sin(\\theta_{n})\\right)\\end{pmatrix}}$$", "id": "1669637"}, {"introduction": "离散化虽然强大，但也并非万无一失。一个在连续世界里稳定衰减的系统，其离散模拟可能会因为步长选择不当而变得发散。本练习通过分析一个放射性衰变模型，揭示了数值稳定性的重要概念 [@problem_id:1669632]。你将亲自推导出为保证模拟结果收敛，时间步长 $h$ 必须满足的条件，从而深刻理解近似方法背后隐藏的限制。", "problem": "放射性核素群体的衰变可以用以下一阶线性微分方程来建模：\n$$ \\frac{dN}{dt} = -\\lambda N(t) $$\n其中 $N(t)$ 表示在时间 $t$ 尚未衰变的核素数量，$\\lambda$ 是正常数衰变常数。这个连续时间系统是固有稳定的，因为群体 $N(t)$ 会指数衰减至零。\n\n该过程的数值模拟可以通过离散时间近似来实现。应用步长为 $h > 0$ 的前向欧拉法，该连续微分方程被转换为一个形如 $N_{k+1} = G N_k$ 的离散时间更新规则，其中 $N_k$ 是 $N(kh)$ 的近似值，而 $G$ 是一个取决于 $\\lambda$ 和 $h$ 的因子。\n\n为了使数值模拟保持稳定（即，模拟的群体 $N_k$ 衰减至零而不是无界增长），必须适当地选择时间步长 $h$。如果 $h$ 太大，模拟将变得不稳定。\n\n确定使得放射性衰变的前向欧拉模拟保持稳定的最大时间步长 $h_{max}$。用衰变常数 $\\lambda$ 的符号表达式表示你的答案。", "solution": "从线性常微分方程 $ \\frac{dN}{dt} = -\\lambda N(t)$ 开始，其中 $\\lambda > 0$。应用步长为 $h>0$ 的前向欧拉法，得到离散更新\n$$\nN_{k+1} = N_{k} + h\\left(-\\lambda N_{k}\\right) = \\left(1 - \\lambda h\\right) N_{k}.\n$$\n因此，放大因子为 $G = 1 - \\lambda h$，递推关系为 $N_{k+1} = G N_{k}$。通解为 $N_{k} = G^{k} N_{0}$。为了使数值模拟在 $k \\to \\infty$ 时 $N_{k} \\to 0$ 的意义下是稳定的，其充分必要条件是\n$$\n|G| < 1.\n$$\n代入 $G = 1 - \\lambda h$ 得\n$$\n|1 - \\lambda h| < 1.\n$$\n这个双重不等式等价于\n$$\n-1 < 1 - \\lambda h < 1.\n$$\n所有部分都减去 $1$ 得\n$$\n-2 < -\\lambda h < 0.\n$$\n因为 $\\lambda > 0$，所以除以 $-\\lambda$ 会反转不等号，得到\n$$\n0 < h < \\frac{2}{\\lambda}.\n$$\n因此，使前向欧拉法保持稳定的最大允许时间步长是\n$$\nh_{\\text{max}} = \\frac{2}{\\lambda},\n$$\n注意到等号成立会使得 $|G|=1$ 且不发生衰减，因此稳定性条件要求 $h<\\frac{2}{\\lambda}$，其中 $\\frac{2}{\\lambda}$ 是上确界。", "answer": "$$\\boxed{\\frac{2}{\\lambda}}$$", "id": "1669632"}]}