{"hands_on_practices": [{"introduction": "网络结构不仅仅是流行病传播的背景，它在决定疫情的命运中扮演着至关重要的角色。这个练习将通过对比两种简单直观的网络结构——链状图和环状图——来展示网络连接性的微小变化如何影响流行病阈值。我们将运用邻接矩阵谱半径这一关键概念，它将网络结构与动态过程联系起来，从而让你亲手计算和理解拓扑结构对疾病传播的影响。[@problem_id:1674627]", "problem": "一个公共卫生机构正在研究一种新型病毒在两个不同的小型社区中的潜在传播，每个社区有 $N$ 个个体。病毒的传播可以用易感-感染-易感（SIS）模型很好地描述，其中从感染中恢复的个体立即再次变得易感。在这个模型中，一个被感染的个体以速率 $\\beta$ 将疾病传播给其每个易感的邻居，并以速率 $\\gamma$ 恢复。传播的动力学关键性地依赖于社区内社交接触的网络结构。\n\n社区 A 是一个线性定居点，房屋排成一条直线。房屋 $i$（对于 $1 < i < N$）中的个体仅与房屋 $i-1$ 和 $i+1$ 中的直接邻居有社交接触。在线路两端（房屋 1 和 $N$）的个体各自只有一个邻居。这种结构形成一个路径图。\n\n社区 B 是一个圆形定居点，房屋围绕一个中央公共区域排列。每个个体都恰好与两个邻居有社交接触，形成一个闭环。这种结构形成一个循环图。\n\n如果被感染的个体数量可以从一个小的初始种子开始增长，就称之为发生了流行病。当有效传播率（定义为 $\\lambda = \\beta / \\gamma$）超过一个称为流行病阈值的临界值 $\\lambda_c$ 时，就会发生这种情况。对于给定的网络结构，如果 $\\lambda > \\lambda_c$，疾病将成为地方病；否则，它将消亡。\n\n设 $\\lambda_c^A$ 为社区 A 的流行病阈值，$\\lambda_c^B$ 为社区 B 的流行病阈值。确定比率 $R = \\frac{\\lambda_c^A}{\\lambda_c^B}$ 作为个体数量 $N$ 的函数。你的最终答案应该是一个闭式解析表达式。", "solution": "我们在一个固定的、邻接矩阵为 $A$ 的接触网络上对 SIS 动力学进行建模。设 $p_{i}(t)$ 表示节点 $i$ 在时间 $t$ 的感染概率。在淬火平均场（NIMFA）近似下，动力学满足\n$$\n\\frac{d p_{i}}{d t}=-\\gamma p_{i}+\\beta\\left(1-p_{i}\\right)\\sum_{j}A_{ij}p_{j}.\n$$\n在无病状态 $p_{i}=0$（对所有 $i$）附近进行线性化，得到线性系统\n$$\n\\frac{d\\boldsymbol{p}}{d t}=\\left(-\\gamma I+\\beta A\\right)\\boldsymbol{p},\n$$\n其中 $\\boldsymbol{p}=(p_{1},\\dots,p_{N})^{\\top}$。当 $-\\gamma I+\\beta A$ 的最大特征值穿过零时，无病状态失去稳定性，即\n$$\n-\\gamma+\\beta\\,\\rho(A)=0\\quad\\Longrightarrow\\quad \\frac{\\beta}{\\gamma}=\\frac{1}{\\rho(A)}.\n$$\n因此，用有效传播率 $\\lambda=\\beta/\\gamma$ 表示的流行病阈值为\n$$\n\\lambda_{c}=\\frac{1}{\\rho(A)},\n$$\n其中 $\\rho(A)$ 是邻接矩阵的谱半径（最大特征值）。\n\n对于社区 A（路径图 $P_{N}$），其邻接矩阵的特征值已知为\n$$\n\\lambda_{k}^{(P_{N})}=2\\cos\\left(\\frac{k\\pi}{N+1}\\right),\\quad k=1,2,\\dots,N,\n$$\n所以谱半径是\n$$\n\\rho\\!\\left(P_{N}\\right)=2\\cos\\left(\\frac{\\pi}{N+1}\\right),\n$$\n因此\n$$\n\\lambda_{c}^{A}=\\frac{1}{2\\cos\\left(\\frac{\\pi}{N+1}\\right)}.\n$$\n\n对于社区 B（循环图 $C_{N}$），其邻接矩阵的特征值为\n$$\n\\lambda_{k}^{(C_{N})}=2\\cos\\left(\\frac{2\\pi k}{N}\\right),\\quad k=0,1,\\dots,N-1,\n$$\n所以谱半径是\n$$\n\\rho\\!\\left(C_{N}\\right)=2,\n$$\n因此\n$$\n\\lambda_{c}^{B}=\\frac{1}{2}.\n$$\n\n那么所求的比率为\n$$\nR=\\frac{\\lambda_{c}^{A}}{\\lambda_{c}^{B}}=\\frac{\\frac{1}{2\\cos\\left(\\frac{\\pi}{N+1}\\right)}}{\\frac{1}{2}}=\\frac{1}{\\cos\\left(\\frac{\\pi}{N+1}\\right)}.\n$$\n这是一个关于 $N$ 的闭式解析表达式。", "answer": "$$\\boxed{\\frac{1}{\\cos\\left(\\frac{\\pi}{N+1}\\right)}}$$", "id": "1674627"}, {"introduction": "现实世界的接触网络很少是均匀的；它们通常包含连接度极高的“枢纽”节点，即所谓的“超级传播者”。本练习将介绍一种强大的分析工具——下一代矩阵方法，用于计算异质网络中的基本再生数 $R_0$。通过分析一个星形网络，你将学会如何处理网络异质性，并量化中心节点在疫情爆发中的关键作用，这对于理解和控制现实世界中的传播至关重要。[@problem_id:1707340]", "problem": "考虑一个通过区域交通网络传播的传染病的简化模型。该网络由一个中心都会枢纽（节点 0）和 $N$ 个相同的卫星城镇（节点 $i=1, 2, \\dots, N$）组成。出行（从而疾病传播）可以发生在枢纽和任何一个卫星城镇之间，但不能直接发生在任意两个卫星城镇之间。这形成了一个“星形”网络拓扑。\n\n疾病的传播由该网络上的易感-感染-恢复（SIR）模型来描述。设 $P_0$ 为枢纽的人口，$P_p$ 为每个卫星城镇的人口。我们追踪每个节点 $k$ 中易感者（$S_k$）、感染者（$I_k$）和恢复者（$R_k$）的数量。每个节点的总人口保持不变。\n\n感染的动力学由以下传播率决定：\n-   枢纽内部个体之间的有效传播率为 $\\beta_{hh}$。\n-   从枢纽中的感染个体到任意一个给定卫星城镇的易感个体的有效传播率为 $\\beta_{hp}$。\n-   从任意一个给定卫星城镇的感染个体到枢纽中易感个体的有效传播率为 $\\beta_{ph}$。\n-   卫星城镇之间的传播可忽略不计，视为零。\n\n任何节点中的个体一旦感染，会以恒定速率 $\\gamma$ 恢复，并对再次感染产生免疫。该系统的无病平衡点（DFE）是没有感染个体的状态。如果这个平衡点不稳定，就会发生疫情爆发。\n\n你的任务是确定疫情爆发的阈值条件。这个条件由基本再生数 $R_0$ 给出，它被定义为在 DFE 附近线性化的系统的下一代矩阵的谱半径（特征值的最大绝对值）。\n\n推导基本再生数 $R_0$ 的解析闭式表达式，用参数 $N, \\beta_{hh}, \\beta_{hp}, \\beta_{ph}$ 和 $\\gamma$ 表示。", "solution": "在无病平衡点（DFE），所有个体都是易感者，没有感染者。将 SIR 动力学在 DFE 附近线性化并应用下一代矩阵方法，我们将感染子系统写为\n$$\n\\frac{d I_{k}}{d t} = \\sum_{j} F_{kj} I_{j} - \\sum_{j} V_{kj} I_{j},\n$$\n其中 $F$ 汇集了新感染出现的速率，$V$ 汇集了从感染状态转出的速率（此处指恢复）。每个节点的恢复速率为 $\\gamma$，所以 $V=\\gamma I$（单位矩阵乘以标量 $\\gamma$）。根据给定的有效传播率的定义，当人口完全易感时，由节点 $j$ 中的一个感染个体在节点 $i$ 中引起的新感染的发生速率为 $\\beta_{ij}$，因此在 DFE 处新感染项的雅可比矩阵是 $F_{ij}=\\beta_{ij}$。\n\n鉴于星形拓扑和给定的有效传播率，$F$ 的唯一非零元为：\n$$\nF_{00}=\\beta_{hh}, \\quad F_{0p}=\\beta_{ph} \\text{ for } p=1,\\dots,N, \\quad F_{p0}=\\beta_{hp} \\text{ for } p=1,\\dots,N,\n$$\n且对于 $p,q \\geq 1$，所有的 $F_{pq}=0$。下一代矩阵是\n$$\nK = F V^{-1} = \\frac{1}{\\gamma} F.\n$$\n将枢纽索引为 $0$，卫星城镇索引为 $p=1,\\dots,N$，$K$ 具有以下星形形式\n$$\nK_{00}=\\frac{\\beta_{hh}}{\\gamma}, \\quad K_{0p}=\\frac{\\beta_{ph}}{\\gamma}, \\quad K_{p0}=\\frac{\\beta_{hp}}{\\gamma}, \\quad K_{pq}=0 \\text{ for } p,q \\geq 1.\n$$\n\n为了计算 $K$ 的谱半径，我们利用卫星城镇之间的对称性。有 $N-1$ 个特征向量支撑在卫星城镇上，其分量之和为零且枢纽分量为零；这些特征向量对应的特征值为 $0$。由枢纽基向量和均匀卫星向量张成的二维不变子空间上的动力学简化为 $2 \\times 2$ 矩阵\n$$\nM = \\begin{pmatrix}\n\\frac{\\beta_{hh}}{\\gamma} & N \\frac{\\beta_{ph}}{\\gamma} \\\\\n\\frac{\\beta_{hp}}{\\gamma} & 0\n\\end{pmatrix}.\n$$\n$M$ 的特征多项式是\n$$\n\\lambda^{2} - \\frac{\\beta_{hh}}{\\gamma} \\lambda - N \\frac{\\beta_{ph}}{\\gamma} \\frac{\\beta_{hp}}{\\gamma} = 0.\n$$\n因此，两个非零特征值是\n$$\n\\lambda_{\\pm} = \\frac{1}{2} \\left( \\frac{\\beta_{hh}}{\\gamma} \\pm \\sqrt{ \\left( \\frac{\\beta_{hh}}{\\gamma} \\right)^{2} + 4 N \\frac{\\beta_{ph}}{\\gamma} \\frac{\\beta_{hp}}{\\gamma} } \\right)\n= \\frac{1}{2 \\gamma} \\left( \\beta_{hh} \\pm \\sqrt{ \\beta_{hh}^{2} + 4 N \\beta_{ph} \\beta_{hp} } \\right).\n$$\n由于所有速率都是非负的，谱半径是正根，\n$$\nR_{0} = \\rho(K) = \\frac{1}{2 \\gamma} \\left( \\beta_{hh} + \\sqrt{ \\beta_{hh}^{2} + 4 N \\beta_{ph} \\beta_{hp} } \\right).\n$$\n这就是基本再生数的解析闭式表达式，并通过 $R_{0} > 1$ 给出了疫情爆发的阈值。", "answer": "$$\\boxed{\\frac{\\beta_{hh}+\\sqrt{\\beta_{hh}^{2}+4 N \\beta_{hp} \\beta_{ph}}}{2 \\gamma}}$$", "id": "1707340"}, {"introduction": "理论模型只有在能够与真实世界的观测数据联系起来时才显示出其真正的力量。这个练习将带你跨越理论与实践之间的鸿沟。通过对 SIR 模型微分方程进行巧妙的推导，你将学习如何仅根据某个时间点的疫情快照数据（例如，当前的感染和康复人数）来估算至关重要的基本再生数 $R_0$。这项技能模拟了流行病学家和数据分析师的核心工作，展示了数学模型在现实世界中的强大应用价值。[@problem_id:1707354]", "problem": "一种名为“Zerg-ware”的新型自我传播恶意软件正在一个大型企业网络中传播。网络安全分析师正在使用流行病学中的易感-感染-康复 (Susceptible-Infected-Recovered, SIR) 模型来对其传播进行建模。在此模型中，工作站总体被分为三个仓室：易感 (Susceptible, S)，即未被感染但易受攻击的工作站；感染 (Infected, I)，即正在主动运行恶意软件并能传播它的工作站；以及康复 (Recovered, R)，即已被IT团队识别并打上补丁，从而对再次感染免疫的工作站。\n\n此次爆发的动态由以下微分方程组描述：\n$$ \\frac{dS}{dt} = -\\frac{\\beta S I}{N} $$\n$$ \\frac{dI}{dt} = \\frac{\\beta S I}{N} - \\gamma I $$\n$$ \\frac{dR}{dt} = \\gamma I $$\n其中，$N$ 是网络中工作站的总数，$\\beta$ 是恶意软件的有效传播率，$\\gamma$ 是受感染工作站被康复（打上补丁）的速率。工作站总数 $N = S(t) + I(t) + R(t)$ 保持不变。描述此次疫情的一个关键参数是基本再生数 (basic reproduction number)，$R_0 = \\beta / \\gamma$。\n\n该网络包含 $N = 50000$ 个工作站。疫情在时间 $t=0$ 时从一台受感染的机器开始，因此 $I(0) = 1$。在此初始时刻，没有机器被打上补丁，因此 $R(0) = 0$。\n\n在稍后的时间 $t_1$，一次全网扫描完成，结果显示当前有 $I(t_1) = 3500$ 台受感染的工作站，而已康复的工作站累计数量为 $R(t_1) = 8000$。\n\n使用这些信息，计算 Zerg-ware 恶意软件的基本再生数 $R_0$。将您的最终答案四舍五入到三位有效数字。", "solution": "我们使用标准的 SIR 系统：\n$$\n\\frac{dS}{dt}=-\\frac{\\beta S I}{N},\\quad \\frac{dI}{dt}=\\frac{\\beta S I}{N}-\\gamma I,\\quad \\frac{dR}{dt}=\\gamma I,\n$$\n其中总体 $N=S+I+R$ 为常数，基本再生数为 $R_{0}=\\frac{\\beta}{\\gamma}$。\n\n将 $\\frac{dS}{dt}$ 除以 $\\frac{dR}{dt}$ 以消去 $I$：\n$$\n\\frac{dS}{dR}=\\frac{-\\frac{\\beta S I}{N}}{\\gamma I}=-\\frac{\\beta}{\\gamma N}S=-\\frac{R_{0}}{N}S.\n$$\n分离变量并从 $t=0$ 到 $t=t_{1}$ 进行积分：\n$$\n\\int_{S(0)}^{S(t_{1})}\\frac{dS}{S}=-\\frac{R_{0}}{N}\\int_{R(0)}^{R(t_{1})}dR,\n$$\n得到\n$$\n\\ln\\!\\left(\\frac{S(t_{1})}{S(0)}\\right)=-\\frac{R_{0}}{N}\\bigl(R(t_{1})-R(0)\\bigr).\n$$\n根据 $I(0)=1$ 和 $R(0)=0$，我们有 $S(0)=N-1$。给定 $I(t_{1})=3500$ 和 $R(t_{1})=8000$，我们有 $S(t_{1})=N-I(t_{1})-R(t_{1})$。解出 $R_{0}$：\n$$\nR_{0}=-\\frac{N}{R(t_{1})-R(0)}\\ln\\!\\left(\\frac{S(t_{1})}{S(0)}\\right)\n=-\\frac{N}{R(t_{1})}\\ln\\!\\left(\\frac{N-I(t_{1})-R(t_{1})}{N-1}\\right).\n$$\n代入 $N=50000$，$I(t_{1})=3500$，$R(t_{1})=8000$：\n$$\nS(0)=50000-1=49999,\\quad S(t_{1})=50000-3500-8000=38500,\n$$\n所以\n$$\nR_{0}=-\\frac{50000}{8000}\\ln\\!\\left(\\frac{38500}{49999}\\right)\n= -6.25\\,\\ln\\!\\left(\\frac{38500}{49999}\\right).\n$$\n计算对数：\n$$\n\\ln\\!\\left(\\frac{38500}{49999}\\right)\\approx \\ln(0.7700154)\\approx -0.261344,\n$$\n因此\n$$\nR_{0}\\approx -6.25\\times(-0.261344)\\approx 1.6334.\n$$\n四舍五入到三位有效数字，$R_{0}\\approx 1.63$。", "answer": "$$\\boxed{1.63}$$", "id": "1707354"}]}