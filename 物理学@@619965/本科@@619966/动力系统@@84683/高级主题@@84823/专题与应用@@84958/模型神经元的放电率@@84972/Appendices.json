{"hands_on_practices": [{"introduction": "作为计算神经科学的基石，渗漏整合-发放（LIF）模型为我们提供了一个理解神经元如何响应输入的窗口。这项练习将引导你完成一个核心计算：当一个神经元接收到恒定的超阈值电流时，它需要多长时间才能首次放电。通过推导首次放电延迟，你将掌握分析这类动态系统的基本数学技能，为理解更复杂的放电模式和神经编码打下坚实基础。[@problem_id:1675499]", "problem": "计算神经科学中的一个基础模型是渗漏整合-发放（Leaky Integrate-and-Fire, LIF）神经元模型。其膜电位 $V(t)$ 的动力学由以下一阶常微分方程决定：\n$$C \\frac{dV}{dt} = -\\frac{V(t) - V_{rest}}{R} + I(t)$$\n其中，$C$ 是膜电容，$R$ 是膜电阻，$V_{rest}$ 是神经元的静息电位，$I(t)$ 是外部输入电流。\n\n“整合-放电”行为如下：神经元的电位 $V(t)$ 对输入电流随时间进行积分。如果 $V(t)$ 达到一个阈值电位 $V_{th}$，则称该神经元“发放”一个脉冲。发放脉冲后，其电位立即被重置为一个值 $V_{reset}$。为使模型具有物理意义，我们假设 $V_{reset} < V_{th}$。\n\n考虑一个LIF神经元，其初始状态处于重置电位，即 $V(0) = V_{reset}$。在时间 $t=0$ 时，一个恒定的、超阈值的电流 $I(t) = I_0$ 被注入神经元并保持不变。“超阈值”电流是指其强度足以最终使膜电位达到阈值，这在数学上对应于条件 $R I_0 > V_{th} - V_{rest}$。\n\n确定神经元发放其第一个脉冲的时间 $T_{spike}$ 的解析表达式。答案应使用参数 $R, C, V_{rest}, V_{reset}, V_{th},$ 和 $I_0$ 来表示。", "solution": "我们从具有恒定输入的线性一阶常微分方程（ODE）开始：\n$$C \\frac{dV}{dt} = -\\frac{V - V_{rest}}{R} + I_{0}.$$\n两边同除以 $C$，写成标准线性形式：\n$$\\frac{dV}{dt} + \\frac{1}{RC}V = \\frac{V_{rest}}{RC} + \\frac{I_{0}}{C}.$$\n这是一个常系数线性常微分方程。其积分因子为\n$$\\mu(t) = \\exp\\!\\left(\\int \\frac{1}{RC}\\,dt\\right) = \\exp\\!\\left(\\frac{t}{RC}\\right).$$\n两边同乘以 $\\mu(t)$ 得到\n$$\\exp\\!\\left(\\frac{t}{RC}\\right)\\frac{dV}{dt} + \\frac{1}{RC}\\exp\\!\\left(\\frac{t}{RC}\\right)V = \\left(\\frac{V_{rest}}{RC} + \\frac{I_{0}}{C}\\right)\\exp\\!\\left(\\frac{t}{RC}\\right).$$\n等式左边是乘积 $\\exp\\!\\left(\\frac{t}{RC}\\right)V(t)$ 的导数，因此\n$$\\frac{d}{dt}\\!\\left[\\exp\\!\\left(\\frac{t}{RC}\\right)V(t)\\right] = \\left(\\frac{V_{rest}}{RC} + \\frac{I_{0}}{C}\\right)\\exp\\!\\left(\\frac{t}{RC}\\right).$$\n对时间进行积分，并将积分常数吸收到 $V(t)$ 中，可以得到标准弛豫形式的通解。为方便起见，我们首先通过在原始 ODE 中令 $\\frac{dV}{dt}=0$ 来确定恒定输入下的稳态（平衡）电位：\n$$0 = -\\frac{V_{\\infty} - V_{rest}}{R} + I_{0} \\quad \\Rightarrow \\quad V_{\\infty} = V_{rest} + R I_{0}.$$\n使用积分因子法求解，并应用初始条件 $V(0)=V_{reset}$，我们得到\n$$V(t) = V_{\\infty} + \\big(V_{reset} - V_{\\infty}\\big)\\exp\\!\\left(-\\frac{t}{RC}\\right).$$\n第一个脉冲发生在时间 $T_{spike}$，此时 $V(T_{spike})=V_{th}$。应用这个阈值条件可得\n$$V_{th} = V_{\\infty} + \\big(V_{reset} - V_{\\infty}\\big)\\exp\\!\\left(-\\frac{T_{spike}}{RC}\\right).$$\n移项以分离出指数项：\n$$V_{th} - V_{\\infty} = \\big(V_{reset} - V_{\\infty}\\big)\\exp\\!\\left(-\\frac{T_{spike}}{RC}\\right),$$\n$$\\exp\\!\\left(-\\frac{T_{spike}}{RC}\\right) = \\frac{V_{th} - V_{\\infty}}{V_{reset} - V_{\\infty}}.$$\n取自然对数并求解 $T_{spike}$ 得到\n$$-\\frac{T_{spike}}{RC} = \\ln\\!\\left(\\frac{V_{th} - V_{\\infty}}{V_{reset} - V_{\\infty}}\\right), \\quad \\text{所以} \\quad T_{spike} = RC \\ln\\!\\left(\\frac{V_{\\infty} - V_{reset}}{V_{\\infty} - V_{th}}\\right).$$\n代入 $V_{\\infty} = V_{rest} + R I_{0}$ 即可得到所要求的、用模型参数表示的表达式。在超阈值条件 $R I_{0} > V_{th} - V_{rest}$ 下，我们有 $V_{\\infty} > V_{th}$，并且由于 $V_{reset} < V_{th}$，对数的真数大于1，从而保证 $T_{spike} > 0$。", "answer": "$$\\boxed{RC\\,\\ln\\!\\left(\\frac{V_{rest}+R I_{0}-V_{reset}}{V_{rest}+R I_{0}-V_{th}}\\right)}$$", "id": "1675499"}, {"introduction": "神经元的数学模型并非只有一种形式，不同的模型能捕捉神经元行为的不同方面。二次整合-发放（QIF）模型是LIF模型之外的一个重要范例，它通过一个非线性方程来描述膜电位的演化。本练习旨在让你推导QIF模型的放电率与输入电流之间的关系，揭示其特有的函数形式，这与LIF模型的行为有显著不同。[@problem_id:1675521]", "problem": "神经元电活动的一个简化模型是二次整合-发放 (QIF) 模型。在此模型中，神经元的膜电位（记作 $V(t)$）根据以下微分方程演化：\n$$\n\\frac{dV}{dt} = V^2 + I\n$$\n此处，$I$ 是一个恒定的正参数，代表输入到神经元的稳定电流。当神经元的膜电位无限增长时，它会“发放”或“产生脉冲”。对于此模型，我们将一次脉冲定义为 $V(t)$ 发散到正无穷大的时刻。脉冲发生后，电位立即被瞬时重置为负无穷大，然后过程重新开始。连续两次脉冲之间的时间间隔称为峰间期，而发放频率 $f$ 则是该间隔的倒数。\n\n确定该 QIF 神经元的发放频率 $f$，使其为输入电流 $I$ 的函数。你的最终答案应该是一个用 $I$ 和任何必要的数学常数表示的符号表达式。", "solution": "我们考虑自治常微分方程 $dV/dt = V^{2} + I$，其中 $I>0$。在两次脉冲之间，轨迹是连续演化的，并且由于对所有 $V$ 都有 $V^{2} + I > 0$，所以膜电位 $V(t)$ 随时间严格单调递增。当 $V(t) \\to +\\infty$ 时发生一次脉冲，之后 $V$ 被重置为 $-\\infty$。因此，峰间期 $T$ 等于在该流作用下 $V$ 从 $-\\infty$ 移动到 $+\\infty$ 所需的时间。\n\n我们分离变量来计算这个时间：\n$$\n\\frac{dV}{dt} = V^{2} + I \\quad \\Longrightarrow \\quad dt = \\frac{dV}{V^{2} + I}.\n$$\n因此，从 $V_{0}$ 移动到 $V_{1}$ 所需的时间是\n$$\nT(V_{0} \\to V_{1}) = \\int_{V_{0}}^{V_{1}} \\frac{dV}{V^{2} + I}.\n$$\n于是峰间期为\n$$\nT = \\int_{-\\infty}^{+\\infty} \\frac{dV}{V^{2} + I}.\n$$\n\n为了计算该积分，注意到若令 $a = \\sqrt{I}$，\n$$\n\\int \\frac{dV}{V^{2} + I} = \\int \\frac{dV}{V^{2} + a^{2}}.\n$$\n使用标准的原函数，\n$$\n\\int \\frac{dV}{V^{2} + a^{2}} = \\frac{1}{a} \\arctan\\!\\left(\\frac{V}{a}\\right) + C,\n$$\n这也可以通过将表达式写成如下形式来推导\n$$\n\\frac{1}{V^{2} + I} = \\frac{1}{I} \\cdot \\frac{1}{1 + \\left(\\frac{V}{\\sqrt{I}}\\right)^{2}}\n$$\n并进行换元 $u = V/\\sqrt{I}$，$du = dV/\\sqrt{I}$，得到\n$$\n\\int \\frac{dV}{V^{2} + I} = \\frac{1}{\\sqrt{I}} \\arctan\\!\\left(\\frac{V}{\\sqrt{I}}\\right) + C.\n$$\n\n因此，\n$$\nT = \\left.\\frac{1}{\\sqrt{I}} \\arctan\\!\\left(\\frac{V}{\\sqrt{I}}\\right)\\right|_{V=-\\infty}^{V=+\\infty} = \\frac{1}{\\sqrt{I}}\\left(\\frac{\\pi}{2} - \\left(-\\frac{\\pi}{2}\\right)\\right) = \\frac{\\pi}{\\sqrt{I}}.\n$$\n发放频率是峰间期的倒数：\n$$\nf = \\frac{1}{T} = \\frac{\\sqrt{I}}{\\pi}.\n$$", "answer": "$$\\boxed{\\frac{\\sqrt{I}}{\\pi}}$$", "id": "1675521"}, {"introduction": "我们现在回到LIF模型，进行更深入的分析，特别关注系统在临界点附近的行为。当输入电流恰好足以（或略高于）引起神经元放电时，其放电间隔会发生什么变化？这项练习要求你分析当输入电流从上方逼近“基电流”（rheobase current）时，峰间期时间的近似行为，从而揭示神经元动力学在分岔点附近的普适规律。[@problem_id:1675495]", "problem": "渗漏整合-发放（LIF）模型是理解神经动力学的一个基本工具。它描述了神经元的膜电位 $V$ 如何随时间响应输入电流 $I$ 而演化。其动力学由以下微分方程决定：\n$$ \\tau_m \\frac{d V}{d t} = -(V - V_{rest}) + R_m I $$\n在此，$\\tau_m$ 是膜时间常数，$V_{rest}$ 是静息电位，$R_m$ 是膜电阻。所有这些都是正常数。\n\n当神经元的膜电位 $V(t)$ 达到一个阈值 $V_{th}$ 时，它会产生一个动作电位，或称“放电”。放电后，电位立即被重置为一个值 $V_{reset}$。对于这个模型，我们假设 $V_{rest} < V_{reset} < V_{th}$。两次连续放电之间的时间间隔称为峰间期，$T_{ISI}$。\n\n一个恒定电流 $I$ 从时间 $t=0$ 开始施加到神经元上，此时神经元的电位处于重置值，$V(0) = V_{reset}$。基电流 $I_{rh}$ 定义为足以使神经元放电的最小恒定输入电流。\n\n考虑输入电流 $I$ 略大于基电流的情况。令 $\\Delta I = I - I_{rh}$，其中 $\\Delta I$ 是一个小的正量。求出在 $\\Delta I \\to 0$ 时有效的峰间期 $T_{ISI}$ 的近似解析表达式。你的表达式应能捕捉 $T_{ISI}$ 作为 $\\Delta I$ 以及模型参数 $\\tau_m$、$V_{th}$、$V_{reset}$ 和 $R_m$ 的函数的主导阶行为。", "solution": "我们从具有恒定输入电流 $I$ 的渗漏整合-发放动力学开始：\n$$\n\\tau_{m} \\frac{dV}{dt} = -(V - V_{rest}) + R_{m} I.\n$$\n对于恒定的 $I$，定义渐近（不动点）电位 $V_{\\infty} = V_{rest} + R_{m} I$。方程变为\n$$\n\\frac{dV}{dt} = -\\frac{1}{\\tau_{m}}(V - V_{\\infty}),\n$$\n在初始条件 $V(0) = V_{reset}$ 下，其解为\n$$\nV(t) = V_{\\infty} + \\bigl(V_{reset} - V_{\\infty}\\bigr)\\exp\\!\\left(-\\frac{t}{\\tau_{m}}\\right).\n$$\n峰间期 $T_{ISI}$ 是满足 $V(T) = V_{th}$ 的第一个时间 $T$，这给出\n$$\nV_{th} = V_{\\infty} + \\bigl(V_{reset} - V_{\\infty}\\bigr)\\exp\\!\\left(-\\frac{T_{ISI}}{\\tau_{m}}\\right).\n$$\n整理得，\n$$\n\\exp\\!\\left(-\\frac{T_{ISI}}{\\tau_{m}}\\right) = \\frac{V_{th} - V_{\\infty}}{V_{reset} - V_{\\infty}} = \\frac{V_{\\infty} - V_{th}}{V_{\\infty} - V_{reset}},\n$$\n所以\n$$\nT_{ISI} = \\tau_{m} \\ln\\!\\left(\\frac{V_{\\infty} - V_{reset}}{V_{\\infty} - V_{th}}\\right).\n$$\n\n基电流 $I_{rh}$ 由不动点达到阈值的条件定义：\n$$\nV_{rest} + R_{m} I_{rh} = V_{th} \\quad \\Rightarrow \\quad I_{rh} = \\frac{V_{th} - V_{rest}}{R_{m}}.\n$$\n对于 $I = I_{rh} + \\Delta I$ 且 $\\Delta I > 0$ 很小的情况，不动点变为\n$$\nV_{\\infty} = V_{rest} + R_{m}(I_{rh} + \\Delta I) = V_{th} + R_{m}\\Delta I.\n$$\n代入 $T_{ISI}$ 的精确公式：\n$$\nT_{ISI} = \\tau_{m} \\ln\\!\\left(\\frac{V_{th} + R_{m}\\Delta I - V_{reset}}{V_{th} + R_{m}\\Delta I - V_{th}}\\right) = \\tau_{m} \\ln\\!\\left(\\frac{V_{th} - V_{reset} + R_{m}\\Delta I}{R_{m}\\Delta I}\\right).\n$$\n对于 $\\Delta I \\to 0^{+}$，展开对数：\n$$\nT_{ISI} = \\tau_{m} \\left[ \\ln\\!\\left(\\frac{V_{th} - V_{reset}}{R_{m}\\Delta I}\\right) + \\ln\\!\\left(1 + \\frac{R_{m}\\Delta I}{V_{th} - V_{reset}}\\right) \\right].\n$$\n由于 $\\ln(1+x) = x + O(x^{2})$ 并且 $x = \\frac{R_{m}\\Delta I}{V_{th} - V_{reset}} \\to 0$，第二项是 $o\\!\\left(\\ln\\!\\left(\\frac{1}{\\Delta I}\\right)\\right)$，因此主导阶行为是\n$$\nT_{ISI} \\sim \\tau_{m} \\ln\\!\\left(\\frac{V_{th} - V_{reset}}{R_{m}\\Delta I}\\right), \\quad \\text{as } \\Delta I \\to 0^{+}.\n$$\n这捕捉了在基电流附近，峰间期随 $\\tau_{m}$、$V_{th}$、$V_{reset}$、$R_{m}$ 和 $\\Delta I$ 变化的对数发散特性。", "answer": "$$\\boxed{\\tau_{m}\\,\\ln\\!\\left(\\frac{V_{th}-V_{reset}}{R_{m}\\,\\Delta I}\\right)}$$", "id": "1675495"}]}