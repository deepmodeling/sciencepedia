{"hands_on_practices": [{"introduction": "在我们识别非随机模式之前，我们必须首先理解纯随机数据的预期行为。此练习介绍了代理数据分析中的一个基本步骤：在随机性零假设下，计算检验统计量的理论期望值。通过推导一个随机重排序列中的预期转变次数，您将为解释真实世界的检验结果建立坚实的理论基础 [@problem_id:1712308]。", "problem": "在时间序列数据分析中，替代数据方法常用于检验非随机结构。其核心思想是生成大量“替代”数据集，这些数据集与原始数据共享某些统计属性（如均值或数值分布），但在其他方面是随机的。通过将根据原始数据计算出的检验统计量与来自替代数据的同一统计量的分布进行比较，可以评估所观察到的任何模式的统计显著性。\n\n考虑一个简单的二元时间序列 $S$，它表示十次连续试验的结果（其中 1 可以表示‘成功’，0 表示‘失败’）：\n$$ S = \\{1, 0, 0, 1, 1, 0, 1, 0, 0, 0\\} $$\n为了检验时间顺序，我们定义一个检验统计量 $T$，即序列中一个元素与其紧邻的后一个元素不同的总次数。对于一个序列 $\\{s_1, s_2, \\dots, s_N\\}$，这指的是相邻元素之间的“跃迁”（从 0 到 1 或从 1 到 0）次数。\n\n你的任务是，在不存在时间顺序的零假设下，确定该检验统计量的理论期望值 $\\langle T_{surr} \\rangle$。该期望值等同于在序列 $S$ 所有可能的唯一排列的集合上计算出的 $T$ 的平均值。\n\n计算给定序列 $S$ 的 $\\langle T_{surr} \\rangle$ 值。将你的最终答案四舍五入到两位有效数字。", "solution": "设序列长度为 $N$，1 的数量为 $n_{1}$，0 的数量为 $n_{0}$，其中 $N=n_{1}+n_{0}$。将检验统计量定义为\n$$\nT=\\sum_{i=1}^{N-1} I_{i},\n$$\n其中 $I_{i}$ 是 $s_{i}\\neq s_{i+1}$ 的指示函数。根据期望的线性性质，\n$$\n\\langle T_{surr} \\rangle=\\sum_{i=1}^{N-1} \\Pr(s_{i}\\neq s_{i+1})=(N-1)\\,p,\n$$\n其中 $p=\\Pr(s_{i}\\neq s_{i+1})$ 是在包含 $n_{1}$ 个 1 和 $n_{0}$ 个 0 的多重集的均匀随机排列中，两个相邻元素不相同的概率。\n\n根据可交换性，有序的相邻对与从总体中不放回抽取两个样本具有相同的分布，因此\n$$\np=\\Pr(1\\text{ then }0)+\\Pr(0\\text{ then }1)=\\frac{n_{1}}{N}\\cdot\\frac{n_{0}}{N-1}+\\frac{n_{0}}{N}\\cdot\\frac{n_{1}}{N-1}=\\frac{2 n_{1} n_{0}}{N(N-1)}.\n$$\n因此，\n$$\n\\langle T_{surr} \\rangle=(N-1)\\cdot \\frac{2 n_{1} n_{0}}{N(N-1)}=\\frac{2 n_{1} n_{0}}{N}.\n$$\n\n对于给定的序列 $S$，我们有 $N=10$， $n_{1}=4$ 和 $n_{0}=6$，所以\n$$\n\\langle T_{surr} \\rangle=\\frac{2\\cdot 4\\cdot 6}{10}=\\frac{48}{10}=4.8,\n$$\n该值四舍五入到两位有效数字是 $4.8$。", "answer": "$$\\boxed{4.8}$$", "id": "1712308"}, {"introduction": "既然我们了解了随机性的理论基准，让我们将完整的代理检验程序应用于一个物理场景。这个实践将引导您完成假设检验的基本步骤：为原始数据计算检验统计量，将其与来自代理数据集的统计量分布进行比较，并确定统计显著性（p值）。通过研究这个弹跳球动态的例子，您将获得使用随机重排代理来检验时间序列中时间独立性的实践经验 [@problem_id:1712276]。", "problem": "一位物理学家正在研究一个系统，其中一个小而高弹性的球在一个温度被主动但不完美地控制的特殊表面上弹跳。其假设是，连续的弹跳峰值高度序列是一个独立同分布（IID）过程，这意味着连续的弹跳之间没有“记忆”或相关性。为了检验这个零假设，采用了一种代理数据方法。\n\n记录下的连续五次弹跳峰值高度的时间序列（单位：米）如下：\n$$ H_{data} = \\{0.80, 0.60, 0.65, 0.45, 0.50\\} $$\n\n为了在零假设下创建一个参考分布，通过打乱原始数据生成了四个代理时间序列：\n- $S_1 = \\{0.45, 0.50, 0.60, 0.65, 0.80\\}$\n- $S_2 = \\{0.60, 0.80, 0.45, 0.50, 0.65\\}$\n- $S_3 = \\{0.80, 0.45, 0.65, 0.50, 0.60\\}$\n- $S_4 = \\{0.50, 0.80, 0.60, 0.45, 0.65\\}$\n\n用于量化时间相关性的检验统计量是滞后-1自相关系数 $r_1$。对于一个时间序列 $x = \\{x_1, x_2, \\dots, x_N\\}$，其均值为 $\\bar{x}$，滞后-1自相关定义为：\n$$ r_1 = \\frac{\\sum_{i=1}^{N-1} (x_i - \\bar{x})(x_{i+1} - \\bar{x})}{\\sum_{i=1}^{N} (x_i - \\bar{x})^2} $$\n\n你的任务是进行显著性检验。计算 p 值，其定义为所提供的代理数据集中，滞后-1自相关大于或等于原始数据 $H_{data}$ 的滞后-1自相关的代理数据集所占的比例。将你的答案表示为小数，并保留两位有效数字。", "solution": "我们使用滞后-1自相关的定义\n$$\nr_{1}=\\frac{\\sum_{i=1}^{N-1}(x_{i}-\\bar{x})(x_{i+1}-\\bar{x})}{\\sum_{i=1}^{N}(x_{i}-\\bar{x})^{2}},\n$$\n每个序列的 $N=5$。由于所有代理序列都是相同数值的排列，因此每个序列的均值和分母都与原始序列相同。\n\n对于 $H_{data}=\\{0.80,0.60,0.65,0.45,0.50\\}$，其均值为\n$$\n\\bar{x}=\\frac{0.80+0.60+0.65+0.45+0.50}{5}=\\frac{3.00}{5}=0.60.\n$$\n偏差为 $d=\\{0.20,0.00,0.05,-0.15,-0.10\\}$。分母为\n$$\n\\sum_{i=1}^{5}d_{i}^{2}=0.20^{2}+0.00^{2}+0.05^{2}+(-0.15)^{2}+(-0.10)^{2}=0.0750.\n$$\n分子为\n$$\n\\sum_{i=1}^{4}d_{i}d_{i+1}=(0.20)(0.00)+(0.00)(0.05)+(0.05)(-0.15)+(-0.15)(-0.10)=0.0075,\n$$\n所以\n$$\nr_{1}(H_{data})=\\frac{0.0075}{0.0750}=0.10.\n$$\n\n对于每个代理序列，$\\bar{x}=0.60$ 且分母为 $0.0750$。计算分子和 $r_{1}$：\n\n- $S_{1}=\\{0.45,0.50,0.60,0.65,0.80\\}$ 的偏差为 $\\{-0.15,-0.10,0.00,0.05,0.20\\}$，分子为 $0.015+0+0+0.010=0.025$，所以\n$$\nr_{1}(S_{1})=\\frac{0.025}{0.075}=\\frac{1}{3}\\approx 0.333\\dots\n$$\n- $S_{2}=\\{0.60,0.80,0.45,0.50,0.65\\}$ 的偏差为 $\\{0.00,0.20,-0.15,-0.10,0.05\\}$，分子为 $0-0.030+0.015-0.005=-0.020$，所以\n$$\nr_{1}(S_{2})=\\frac{-0.020}{0.075}\\approx-0.266\\dots\n$$\n- $S_{3}=\\{0.80,0.45,0.65,0.50,0.60\\}$ 的偏差为 $\\{0.20,-0.15,0.05,-0.10,0.00\\}$，分子为 $-0.030-0.0075-0.005+0=-0.0425$，所以\n$$\nr_{1}(S_{3})=\\frac{-0.0425}{0.075}\\approx-0.566\\dots\n$$\n- $S_{4}=\\{0.50,0.80,0.60,0.45,0.65\\}$ 的偏差为 $\\{-0.10,0.20,0.00,-0.15,0.05\\}$，分子为 $-0.020+0+0-0.0075=-0.0275$，所以\n$$\nr_{1}(S_{4})=\\frac{-0.0275}{0.075}\\approx-0.366\\dots\n$$\n\n我们与 $r_{1}(H_{data})=0.10$ 进行比较。在这些代理序列中，只有 $S_{1}$ 满足 $r_{1}\\geq 0.10$，即4个中只有1个。因此，p 值为\n$$\np=\\frac{1}{4}=0.25,\n$$\n保留两位有效数字后为 $0.25$。", "answer": "$$\\boxed{0.25}$$", "id": "1712276"}, {"introduction": "执行假设检验是一回事，但我们对其结论的信心有多大呢？答案在于理解检验的统计功效。这个高级练习探讨了可用数据量（时间序列长度 $L$）与代理检验正确检测非线性能力之间的关系。通过分析模拟实验数据并将其拟合到模型中，您将学习如何量化统计检验的性能，这是在任何科学领域设计稳健实验的关键技能 [@problem_id:1712266]。", "problem": "一位非线性动力学领域的研究者正在研究一种区分混沌信号和随机噪声的方法。所提出的“代理数据检验”（surrogate data test）旨在通过检验时间序列中的非线性来实现这一目标。该研究者希望量化此检验的一个关键性能指标：其统计功效。\n\n混沌信号的来源是逻辑斯蒂映射（logistic map），由方程 $x_{n+1} = 4 x_n (1-x_n)$ 描述，初始值为 $x_0 = 0.2$。利用此映射生成一个非常长的时间序列，作为“真实”的混沌信号。\n\n该方法的核心是一个假设检验。原假设 $H_0$ 设定，给定的时间序列片段是由一个平稳、线性、高斯的随机过程生成的，该过程具有与该片段相同的功率谱（因此也具有相同的自相关函数）。为了检验 $H_0$，使用相位随机化傅里叶变换（Phase-Randomized Fourier Transform, PRFT）方法从原始时间序列创建代理数据集。该算法通过其构造，能生成与原假设一致的新时间序列。\n\n一个非线性判别统计量，即立方时间反演不对称统计量 $S$，会分别对原始序列（$S_{orig}$）和每个代理序列（$S_{surr}$）进行计算。该统计量定义为 $S = \\frac{1}{N-1} \\sum_{i=1}^{N-1} (x_{i+1}-x_i)^3$，其中 $N$ 是时间序列的长度。通过生成 $M=99$ 个代理序列来执行该检验。如果 $S_{orig}$ 大于所有 99 个 $S_{surr, j}$ 的值，则拒绝原假设。这构成了一个单边检验，显著性水平为 $\\alpha = 1/(M+1) = 0.01$。\n\n为了确定该检验的统计功效（即正确识别混沌序列的概率），研究者进行了一项数值实验。针对几个不同的时间序列长度 $L$，对逻辑斯蒂映射数据的独立片段重复进行 1000 次检验。对于给定的长度 $L$，统计功效 $P$ 则估计为这 1000 次试验中原假设被正确拒绝的比例。此实验的结果总结在下表中：\n\n| 长度 ($L$) | 功效 ($P$) |\n|--------------|-------------|\n| 100          | 0.05        |\n| 200          | 0.27        |\n| 300          | 0.73        |\n| 400          | 0.95        |\n| 500          | 0.99        |\n\n研究者希望使用以下逻辑斯蒂函数来建模统计功效 $P$ 和时间序列长度 $L$ 之间的关系：\n$$ P(L) = \\frac{1}{1 + \\exp\\left(-\\frac{L - L_{50}}{k}\\right)} $$\n其中 $L_{50}$ 是检验达到 50% 功效时的特征长度，而 $k$ 是一个与功效曲线陡峭程度相关的参数。\n\n通过将此模型线性化，并对所提供的实验数据进行最小二乘线性回归，确定特征长度 $L_{50}$ 的值。将您的答案以数值形式报告，并四舍五入到三位有效数字。", "solution": "我们从逻辑斯蒂功效模型开始\n$$\nP(L)=\\frac{1}{1+\\exp\\!\\left(-\\frac{L-L_{50}}{k}\\right)}.\n$$\n进行 logit 变换，得到一个关于 $L$ 的线性关系：\n$$\n\\ln\\!\\left(\\frac{P}{1-P}\\right)=\\frac{L-L_{50}}{k}.\n$$\n定义 $y=\\ln\\!\\left(\\frac{P}{1-P}\\right)$，因此\n$$\ny=a+bL,\\quad b=\\frac{1}{k},\\quad a=-\\frac{L_{50}}{k},\n$$\n这意味着\n$$\nL_{50}=-\\frac{a}{b}.\n$$\n\n使用所提供的数据，计算 $y_{i}=\\ln\\!\\left(\\frac{P_{i}}{1-P_{i}}\\right)$：\n- 对于 $L=100$，$P=0.05$：$y_{1}=\\ln\\!\\left(\\frac{0.05}{0.95}\\right)=-\\ln(19)=-2.944438979$。\n- 对于 $L=200$，$P=0.27$：$y_{2}=\\ln\\!\\left(\\frac{0.27}{0.73}\\right)=\\ln\\!\\left(\\frac{27}{73}\\right)=-0.994622575$。\n- 对于 $L=300$，$P=0.73$：$y_{3}=\\ln\\!\\left(\\frac{0.73}{0.27}\\right)=\\ln\\!\\left(\\frac{73}{27}\\right)=+0.994622575$。\n- 对于 $L=400$，$P=0.95$：$y_{4}=\\ln\\!\\left(\\frac{0.95}{0.05}\\right)=\\ln(19)=+2.944438979$。\n- 对于 $L=500$，$P=0.99$：$y_{5}=\\ln\\!\\left(\\frac{0.99}{0.01}\\right)=\\ln(99)=+4.595119850$。\n\n对五个点 $(L_{i},y_{i})$ 进行最小二乘回归 $y=a+bL$。令\n$$\n\\bar{L}=\\frac{1}{5}\\sum_{i=1}^{5}L_{i}=300,\\qquad \\bar{y}=\\frac{1}{5}\\sum_{i=1}^{5}y_{i}=0.91902397.\n$$\n计算\n$$\nS_{xx}=\\sum_{i=1}^{5}(L_{i}-\\bar{L})^{2}=100000,\n$$\n$$\nS_{xy}=\\sum_{i=1}^{5}(L_{i}-\\bar{L})(y_{i}-\\bar{y})=1901.817921.\n$$\n因此\n$$\nb=\\frac{S_{xy}}{S_{xx}}=0.0190181792,\\qquad a=\\bar{y}-b\\,\\bar{L}=0.91902397-0.0190181792\\times 300=-4.786429794.\n$$\n最后，\n$$\nL_{50}=-\\frac{a}{b}=\\frac{4.786429794}{0.0190181792}\\approx 251.677.\n$$\n四舍五入到三位有效数字，\n$$\nL_{50}\\approx 252.\n$$", "answer": "$$\\boxed{252}$$", "id": "1712266"}]}