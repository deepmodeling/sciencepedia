{"hands_on_practices": [{"introduction": "任何使用延迟坐标嵌入的分析都始于将一维时间序列转化为高维状态向量。这项练习将通过一个具体的数据集，带你亲手实践这个转化过程。通过为给定的时间序列数据和嵌入参数（$m$ 和 $\\tau$）构建延迟向量，你将掌握这项基本技能 [@problem_id:1671692]。", "problem": "在非线性动力系统分析中，一种常用技术是使用延迟坐标嵌入法从单个时间序列重构相空间。考虑一个单一可观测的时间序列，表示为一系列测量值 $s_1, s_2, s_3, \\dots, s_N$。重构相空间中的一个延迟向量 $\\mathbf{v}_k$ 是通过从时间序列中取 $m$ 个值形成的，这些值之间相隔一个时间延迟 $\\tau$。从测量值 $s_k$ 开始的第 $k$ 个向量定义为：\n$$\n\\mathbf{v}_k = (s_k, s_{k+\\tau}, s_{k+2\\tau}, \\dots, s_{k+(m-1)\\tau})\n$$\n一位环境科学家记录了一年内月平均大气CO2浓度。该时间序列数据，用 $c_k$ 表示第 $k$ 个月的数据，以百万分之几 (ppm) 为单位给出：\n$C = \\{410.5, 411.2, 412.1, 413.0, 412.8, 411.7, 410.1, 408.9, 409.5, 410.8, 412.3, 413.5\\}$\n\n使用嵌入维度 $m=4$ 和时间延迟 $\\tau=2$ 个月，可以构建的前三个有效延迟向量是 $\\mathbf{v}_1$、$\\mathbf{v}_2$ 和 $\\mathbf{v}_3$。\n\n计算向量和 $\\mathbf{V} = \\mathbf{v}_1 + \\mathbf{v}_2 + \\mathbf{v}_3$ 的模（欧几里得范数）。将您的最终答案以 ppm 为单位表示，并四舍五入到五位有效数字。", "solution": "我们给出了月度时间序列 $C=\\{c_{1},c_{2},\\dots,c_{12}\\}$，其中 $c_{1}=410.5$, $c_{2}=411.2$, $c_{3}=412.1$, $c_{4}=413.0$, $c_{5}=412.8$, $c_{6}=411.7$, $c_{7}=410.1$, $c_{8}=408.9$, $c_{9}=409.5$, $c_{10}=410.8$, $c_{11}=412.3$, $c_{12}=413.5$。对于嵌入维度 $m=4$ 和延迟 $\\tau=2$，延迟向量定义为\n$$\n\\mathbf{v}_{k}=(c_{k},c_{k+2},c_{k+4},c_{k+6}).\n$$\n前三个有效向量（对于 $k=1,2,3$）是\n$$\n\\mathbf{v}_{1}=(c_{1},c_{3},c_{5},c_{7})=(410.5,\\,412.1,\\,412.8,\\,410.1),\n$$\n$$\n\\mathbf{v}_{2}=(c_{2},c_{4},c_{6},c_{8})=(411.2,\\,413.0,\\,411.7,\\,408.9),\n$$\n$$\n\\mathbf{v}_{3}=(c_{3},c_{5},c_{7},c_{9})=(412.1,\\,412.8,\\,410.1,\\,409.5).\n$$\n它们的和是按分量计算的：\n$$\n\\mathbf{V}=\\mathbf{v}_{1}+\\mathbf{v}_{2}+\\mathbf{v}_{3}=(410.5+411.2+412.1,\\,412.1+413.0+412.8,\\,412.8+411.7+410.1,\\,410.1+408.9+409.5),\n$$\n$$\n\\mathbf{V}=(1233.8,\\,1237.9,\\,1234.6,\\,1228.5).\n$$\n欧几里得范数是\n$$\n\\|\\mathbf{V}\\|=\\sqrt{(1233.8)^{2}+(1237.9)^{2}+(1234.6)^{2}+(1228.5)^{2}}.\n$$\n计算各项的平方：\n$$\n(1233.8)^{2}=1{,}522{,}262.44,\\quad (1237.9)^{2}=1{,}532{,}396.41,\\quad (1234.6)^{2}=1{,}524{,}237.16,\\quad (1228.5)^{2}=1{,}509{,}212.25.\n$$\n求和：\n$$\n1{,}522{,}262.44+1{,}532{,}396.41+1{,}524{,}237.16+1{,}509{,}212.25=6{,}088{,}108.26.\n$$\n因此\n$$\n\\|\\mathbf{V}\\|=\\sqrt{6{,}088{,}108.26}\\approx 2467.409\\ldots\n$$\n四舍五入到五位有效数字，结果是 $2467.4$ (ppm)。", "answer": "$$\\boxed{2467.4}$$", "id": "1671692"}, {"introduction": "延迟时间 $\\tau$ 的选择对重构相空间的质量至关重要；一个好的 $\\tau$ 可以“展开”动力学，而一个坏的选择则可能使信息模糊。本练习通过一个理想化的周期信号，探讨了 $\\tau$ 与信号周期 $T$ 之间的关系如何决定嵌入后轨道的几何形状。理解这种关系，对于在实际应用中选择合适的延迟时间至关重要 [@problem_id:1671698]。", "problem": "在动力系统的研究中，延迟坐标嵌入是一种用于从单个时间序列测量中重构多维相空间的技术。\n\n考虑一个一维、零均值的周期信号 $x(t)$，其基本周期为 $T > 0$。由此信号构造一个二维延迟坐标嵌入，定义为向量 $\\vec{v}(t) = (x(t), x(t+\\tau))$，其中 $\\tau$ 是一个恒定的时间延迟。\n\n观察到，对于 $\\tau$ 的某些特定选择，向量 $\\vec{v}(t)$ 随时间 $t$ 在二维相空间中描绘的轨迹是一个以原点为中心的正圆。假设周期信号 $x(t)$ 可以被其基本正弦分量很好地近似，那么下列哪个选项描述了能产生这种圆形轨迹的时间延迟 $\\tau$ 和周期 $T$ 之间所有可能的关系？\n\nA. $\\tau = \\frac{nT}{2}$，对于任意整数 $n \\ge 1$。\n\nB. $\\tau = \\frac{nT}{4}$，对于任意整数 $n \\ge 1$。\n\nC. $\\tau = \\frac{(2n+1)T}{4}$，对于任意整数 $n \\ge 0$。\n\nD. $\\tau = \\frac{(2n+1)T}{2}$，对于任意整数 $n \\ge 0$。\n\nE. $\\tau = \\frac{T}{\\pi}$，对于任意整数 $n \\ge 0$。", "solution": "假设零均值周期信号可以被其基本正弦分量很好地近似，故可写为\n$$\nx(t)=A\\cos(\\omega t+\\phi),\n$$\n其中 $A$ 是振幅，$\\omega=\\frac{2\\pi}{T}$ 是角频率，$\\phi$ 是相位。定义\n$$\n\\theta=\\omega t+\\phi,\\qquad \\Delta=\\omega \\tau=\\frac{2\\pi}{T}\\,\\tau,\n$$\n因此，延迟嵌入向量为\n$$\n(x,y)=\\bigl(x(t),x(t+\\tau)\\bigr)=\\bigl(A\\cos\\theta,\\;A\\cos(\\theta+\\Delta)\\bigr).\n$$\n为求出在 $(x,y)$-平面上的轨迹，消去 $\\theta$。使用 $\\cos(\\theta+\\Delta)=\\cos\\theta\\cos\\Delta-\\sin\\theta\\sin\\Delta$，我们有\n$$\n\\frac{y}{A}=\\frac{x}{A}\\cos\\Delta-\\sin\\theta\\,\\sin\\Delta,\n$$\n所以\n$$\n\\sin\\theta=\\frac{\\frac{x}{A}\\cos\\Delta-\\frac{y}{A}}{\\sin\\Delta},\\qquad \\cos\\theta=\\frac{x}{A}.\n$$\n应用 $\\cos^{2}\\theta+\\sin^{2}\\theta=1$：\n$$\n\\left(\\frac{x}{A}\\right)^{2}+\\left(\\frac{\\frac{x}{A}\\cos\\Delta-\\frac{y}{A}}{\\sin\\Delta}\\right)^{2}=1.\n$$\n两边乘以 $A^{2}\\sin^{2}\\Delta$ 并展开：\n$$\nx^{2}\\sin^{2}\\Delta+(x\\cos\\Delta-y)^{2}=A^{2}\\sin^{2}\\Delta,\n$$\n$$\nx^{2}\\sin^{2}\\Delta+x^{2}\\cos^{2}\\Delta-2xy\\cos\\Delta+y^{2}=A^{2}\\sin^{2}\\Delta,\n$$\n$$\nx^{2}-2xy\\cos\\Delta+y^{2}=A^{2}\\sin^{2}\\Delta.\n$$\n这是一个以原点为中心的圆锥曲线的方程。当交叉项消失，即 $\\cos\\Delta=0$ 时，该方程恰好变为一个以原点为中心的圆。此时 $\\sin^{2}\\Delta=1$，方程简化为\n$$\nx^{2}+y^{2}=A^{2},\n$$\n一个半径为 $A$ 的圆。条件 $\\cos\\Delta=0$ 给出\n$$\n\\Delta=\\frac{\\pi}{2}+k\\pi=\\frac{(2k+1)\\pi}{2},\\qquad k\\in\\mathbb{Z}.\n$$\n由于 $\\Delta=\\omega\\tau=\\frac{2\\pi}{T}\\tau$，求解 $\\tau$：\n$$\n\\frac{2\\pi}{T}\\,\\tau=\\frac{(2k+1)\\pi}{2}\\quad\\Longrightarrow\\quad \\tau=\\frac{(2k+1)T}{4}.\n$$\n因此，能产生正圆的延迟是 $T$ 的奇数倍四分之一周期。在各选项中，这恰好由 $\\tau=\\frac{(2n+1)T}{4}$（对于整数 $n\\ge 0$）所描述，即选项C。其他列出的选项族包含不满足 $\\cos\\Delta=0$ 的值（例如，半周期延迟产生的是直线而非圆），因此它们没有专门描述所要求的解集。", "answer": "$$\\boxed{C}$$", "id": "1671698"}, {"introduction": "除了延迟时间 $\\tau$ 之外，选择合适的嵌入维度 $m$ 也是一个关键挑战。本练习将介绍一种名为“伪近邻”（False Nearest Neighbors, FNN）的常用算法，该算法旨在找到足以完全展开吸引子的最小维度。通过将 FNN 算法应用于著名的一维逻辑斯蒂映射，我们将分析该方法的内在逻辑，并学会如何解读其结果以避免对系统维度的误判 [@problem_id:1671708]。", "problem": "延迟坐标嵌入法是一种强大的技术，用于从单个时间序列重构动力系统的状态空间。确定最小充分嵌入维度 $m$ 的一种常用算法是伪最近邻 (FNN) 算法。其核心思想是考察在 $m$ 维嵌入中彼此靠近的点，在 $m+1$ 维中是否仍然靠近。如果它们不再靠近，则被认为是“伪”近邻，这意味着维度 $m$ 太小，不足以展开吸引子。\n\n考虑由一维逻辑斯谛映射生成的时间序列 $\\{x_n\\}_{n=0,1,2,\\dots}$，其定义为迭代方程 $x_{n+1} = f(x_n) = r x_n (1-x_n)$，其中状态 $x_n$ 局限于区间 $[0, 1]$ 内。我们将以 $\\tau=1$ 的时间延迟来分析此时间序列。\n\n在嵌入维度 $m$ 中的延迟向量由 $\\vec{V}_n^{(m)} = (x_n, x_{n+1}, \\dots, x_{n+m-1})$ 给出。FNN 算法按以下步骤进行：\n1. 对于每个向量 $\\vec{V}_i^{(m)}$，在欧几里得距离的意义下找到其最近邻 $\\vec{V}_j^{(m)}$。\n2. 如果当维度增加到 $m+1$ 时，这对向量的间距不成比例地增大，则它们被归类为“伪近邻”。一个标准判据是检查比率\n$$ C_{ij}^{(m)} = \\frac{|x_{i+m} - x_{j+m}|}{||\\vec{V}_i^{(m)} - \\vec{V}_j^{(m)}||} $$\n是否超过某个阈值 $R_{tol}$。项 $|x_{i+m} - x_{j+m}|$ 表示由第 $(m+1)$ 个坐标引入的额外间距。\n\n您的任务是分析 FNN 算法从 $m=1$ 到 $m=2$ 的转变。对于两个无穷接近的点 $x_i$ 和 $x_j$ （即 $|x_i - x_j| \\to 0$），比率 $C_{ij}^{(1)}$ 趋近于一个由该映射的局部动力学决定的值。假设逻辑斯谛映射的参数设置为 $r=4$，请确定此极限比率在整个定义域 $x \\in [0, 1]$ 上的最大可能值。这个值因局部拉伸而为 FNN 检验统计量提供了一个物理上限，并为选择合适的阈值 $R_{tol}$ 以避免将真实近邻错误分类提供了参考。", "solution": "对于嵌入维度 $m=1$，每个延迟向量为 $\\vec{V}_{n}^{(1)}=(x_{n})$，因此两个向量之间的欧几里得距离为 $||\\vec{V}_{i}^{(1)}-\\vec{V}_{j}^{(1)}|| = |x_{i}-x_{j}|$。针对 $m=1$ 的伪最近邻统计量为\n$$\nC_{ij}^{(1)}=\\frac{|x_{i+1}-x_{j+1}|}{|x_{i}-x_{j}|}=\\frac{|f(x_{i})-f(x_{j})|}{|x_{i}-x_{j}|}。\n$$\n对于无穷接近的点，令 $\\Delta=x_{j}-x_{i}\\to 0$。根据中值定理，在 $x_{i}$ 和 $x_{j}$ 之间存在一个 $\\xi$，使得\n$$\nf(x_{j})-f(x_{i})=f'(\\xi)(x_{j}-x_{i}),\n$$\n因此\n$$\n\\lim_{\\Delta\\to 0} C_{ij}^{(1)}=\\lim_{\\Delta\\to 0}\\frac{|f(x_{i})-f(x_{j})|}{|x_{i}-x_{j}|}=\\lim_{\\Delta\\to 0}|f'(\\xi)|=|f'(x)|,\n$$\n其中 $x$ 是 $x_{i}$ 和 $x_{j}$ 的共同极限点。\n\n对于逻辑斯谛映射 $f(x)=r x(1-x)$，其导数为\n$$\nf'(x)=r(1-2x)。\n$$\n当 $r=4$ 时，这变为 $f'(x)=4(1-2x)$，所以极限比率为\n$$\n|f'(x)|=4|1-2x|。\n$$\n在 $x\\in[0,1]$ 上，函数 $|1-2x|$ 在 $x=0$ 和 $x=1$ 处取得其最大值 $1$。因此，该极限比率的最大可能值为\n$$\n\\max_{x\\in[0,1]}|f'(x)|=\\max_{x\\in[0,1]}4|1-2x|=4。\n$$\n这就是在 $r=4$ 的逻辑斯谛映射中，对于 $\\tau=1$ 且从 $m=1$ 过渡到 $m=2$ 的情况，因局部拉伸而对 FNN 检验统计量造成的物理上限。", "answer": "$$\\boxed{4}$$", "id": "1671708"}]}