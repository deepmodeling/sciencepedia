{"hands_on_practices": [{"introduction": "我们从一个简单、具体的模型开始，为时间平均建立直观的认识。本题考察一个具有有限个状态的系统，其演化遵循一个完全可预测的循环。通过直接计算一个可观测量的时间平均值，我们能够对时间平均的概念有一个切实的理解，而无需借助高深的理论。[@problem_id:1447062]", "problem": "考虑一个具有有限个状态的系统，其状态由集合 $X = \\{1, 2, \\dots, N\\}$ 中的整数标记，其中 $N \\ge 2$ 是一个整数。该系统以离散时间步演化。如果系统在时间 $t$ 处于状态 $k$，它将根据变换规则 $T: X \\to X$ 在时间 $t+1$ 转移到一个新状态，该规则定义为 $T(k) = (k \\pmod N) + 1$。\n\n在每个状态下都会测量一个用 $f$ 表示的可观测量。当系统处于状态 $k$ 时，该可观测量的取值由函数 $f(k) = k$ 给出。\n\n对于任意初始状态 $k_0 \\in X$，我们可以定义可观测量 $f$ 沿着从 $k_0$ 开始的轨迹的时间平均值。如果访问的状态序列为 $k_0, k_1, k_2, \\dots$，其中 $k_{m+1} = T(k_m)$，则时间平均值由以下极限给出：\n$$\n\\hat{f}(k_0) = \\lim_{M \\to \\infty} \\frac{1}{M}\\sum_{m=0}^{M-1} f(k_m)\n$$\n可以证明，该极限存在且与初始状态 $k_0$ 无关。计算这个时间平均值。您的答案应该是一个用 $N$ 表示的闭式解析表达式。", "solution": "映射 $T(k)=(k \\bmod N)+1$ 会生成一个遍历 $X=\\{1,2,\\dots,N\\}$ 中所有状态的循环。对于任意初始状态 $k_{0}\\in X$，通过 $k_{m+1}=T(k_{m})$ 定义轨迹。通过归纳法，可以得到其显式形式\n$$\nk_{m}=\\bigl((k_{0}+m-1)\\bmod N\\bigr)+1,\n$$\n因此序列 $\\{k_{m}\\}_{m=0}^{N-1}$ 是 $\\{1,2,\\dots,N\\}$ 的一个排列，并且对于所有 $m$ 都有 $k_{m+N}=k_{m}$，即轨道是周期为 $N$ 的。\n\n令 $S_{N}=\\sum_{j=1}^{N}j$。因为每连续 $N$ 步的序列块都会恰好访问每个状态一次，所以对于任意整数 $\\ell\\ge 0$，\n$$\n\\sum_{m=\\ell N}^{\\ell N+N-1} f(k_{m})=\\sum_{m=\\ell N}^{\\ell N+N-1} k_{m}=S_{N}.\n$$\n对于任意的 $M$，将其写作 $M=qN+r$，其中整数 $q\\ge 0$ 且 $0\\le r<N$。那么\n$$\n\\sum_{m=0}^{M-1} f(k_{m})=\\sum_{m=0}^{qN-1} f(k_{m})+\\sum_{m=qN}^{qN+r-1} f(k_{m})=qS_{N}+R_{r},\n$$\n其中 $R_{r}=\\sum_{m=qN}^{qN+r-1} f(k_{m})$ 满足 $0\\le R_{r}\\le rN$。因此，时间平均值满足\n$$\n\\frac{1}{M}\\sum_{m=0}^{M-1} f(k_{m})=\\frac{qS_{N}+R_{r}}{qN+r}.\n$$\n当 $M\\to\\infty$ 时，必然有 $q\\to\\infty$，而 $0\\le r<N$ 保持有界，所以 $R_{r}/(qN+r)\\to 0$ 并且\n$$\n\\hat{f}(k_{0})=\\lim_{M\\to\\infty}\\frac{1}{M}\\sum_{m=0}^{M-1} f(k_{m})=\\frac{S_{N}}{N}.\n$$\n计算 $S_{N}$ 得\n$$\nS_{N}=\\sum_{j=1}^{N} j=\\frac{N(N+1)}{2},\n$$\n所以，与 $k_{0}$ 无关的时间平均值为\n$$\n\\hat{f}(k_{0})=\\frac{1}{N}\\cdot \\frac{N(N+1)}{2}=\\frac{N+1}{2}.\n$$", "answer": "$$\\boxed{\\frac{N+1}{2}}$$", "id": "1447062"}, {"introduction": "在探索了简单的周期系统之后，我们现在来处理一个更复杂的连续系统：倍增映射，一个经典的混沌例子。对于混沌轨道，直接计算其时间平均通常是不可能的，而这正是伯克霍夫遍历定理大显身手之处。本练习将引导你应用该定理，将难以捉摸的时间平均与更易于处理的空间平均等同起来。[@problem_id:1447114]", "problem": "考虑一个确定性动力系统，其状态是一个数 $x \\in [0,1)$，该状态在离散时间步中演化。状态从时间 $k$到时间 $k+1$的演化由映射 $T: [0,1) \\to [0,1)$ 决定，定义为 $T(x) = 2x \\pmod{1}$。这是 $2x$的小数部分。\n\n对于任意给定的初始状态 $x_0 = x$，系统的轨道是序列 $x_0, x_1, x_2, \\ldots$，其中 $x_{k+1} = T(x_k)$。我们来研究该系统的一个特定可观测量，它就是状态本身的值，由函数 $f(x) = x$ 给出。该可观测量的长期时间平均由以下极限定义：\n$$\nA(x) = \\lim_{n \\to \\infty} \\frac{1}{n} \\sum_{k=0}^{n-1} f(T^k(x))\n$$\n根据遍历理论的一个已知结果，对于这个特定系统，极限 $A(x)$ 存在，并且对于关于标准勒贝格测度的几乎所有初始状态 $x \\in [0,1)$，它都收敛到同一个常数值。\n\n你的任务是确定这个常数值。", "solution": "给定在 $[0,1)$ 上的动力系统，其倍乘映射为 $T(x)=2x \\pmod{1}$，可观测量为 $f(x)=x$。对于 $x \\in [0,1)$，时间平均为\n$$\nA(x)=\\lim_{n \\to \\infty} \\frac{1}{n} \\sum_{k=0}^{n-1} f(T^{k}(x))=\\lim_{n \\to \\infty} \\frac{1}{n} \\sum_{k=0}^{n-1} T^{k}(x).\n$$\n我们使用 Birkhoff 遍历定理：如果 $(X,\\mathcal{B},\\mu,T)$ 是保测且遍历的，并且 $f \\in L^{1}(\\mu)$，那么对于 $\\mu$-几乎处处的 $x \\in X$，\n$$\n\\lim_{n \\to \\infty} \\frac{1}{n} \\sum_{k=0}^{n-1} f(T^{k}(x))=\\int_{X} f \\,\\mathrm{d}\\mu.\n$$\n因此，为了确定对于几乎所有 $x$ 的 $A(x)$，我们只需找到一个不变的遍历概率测度，并计算 $f$ 关于该测度的空间平均。\n\n首先，$[0,1)$ 上的勒贝格测度 $m$ 对于 $T$ 是不变的。为了证明这一点，注意到对于任意区间 $I \\subset [0,1)$，\n$$\nT^{-1}(I)=\\left\\{x \\in [0,1): 2x \\pmod{1} \\in I \\right\\}=\\frac{I}{2} \\cup \\frac{I+1}{2},\n$$\n其中 $\\frac{I}{2}=\\{x: 2x \\in I\\}$ 且 $\\frac{I+1}{2}=\\{x: 2x-1 \\in I\\}$。其长度满足 $m\\!\\left(\\frac{I}{2}\\right)=\\frac{1}{2}m(I)$ 和 $m\\!\\left(\\frac{I+1}{2}\\right)=\\frac{1}{2}m(I)$，因此 $m(T^{-1}(I))=m(I)$。通过从区间到 Borel $\\sigma$-代数的标准扩张，可知 $m$ 是 $T$-不变的。\n\n其次，$T$ 关于测度 $m$ 是遍历的。这可以从二进制展开表示中得出：对于 $x=\\sum_{j=1}^{\\infty} b_{j} 2^{-j}$ (除去具有两种展开的二进有理数构成的零测集)，$T$ 将序列 $(b_{j})$ 向左移动一位，这相当于在 $\\{0,1\\}^{\\mathbb{N}}$ 上的伯努利移位，其乘积测度赋予 $0$ 和 $1$ 相等的权重。伯努利移位是遍历的，因此 $T$ 关于 $m$ 是遍历的。\n\n根据 Birkhoff 定理，将其应用于 $\\mu=m$ 和 $f(x)=x \\in L^{1}(m)$，对于 $m$-几乎处处的 $x$，\n$$\nA(x)=\\int_{0}^{1} x \\,\\mathrm{d}x.\n$$\n计算该积分：\n$$\n\\int_{0}^{1} x \\,\\mathrm{d}x=\\left[\\frac{x^{2}}{2}\\right]_{0}^{1}=\\frac{1}{2}.\n$$\n因此，对于几乎所有初始状态 $x \\in [0,1)$，长期时间平均 $A(x)$ 等于 $\\frac{1}{2}$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1447114"}, {"introduction": "伯克霍夫遍历定理的关键依赖于遍历性这一假设。但如果一个系统不是遍历的，会发生什么呢？本题就探讨了这样一种情况，系统分解为几个相互独立的组成部分。通过计算此时的时间平均，你会发现它不再是一个全局常数，而是依赖于初始状态，这有助于你更深刻地理解遍历性在动力系统中的关键作用。[@problem_id:1447100]", "problem": "设 $X = \\{1, 2, 3, 4, 5\\}$ 是一个离散空间。考虑一个由置换 $T(1)=2$, $T(2)=3$, $T(3)=1$, $T(4)=5$ 及 $T(5)=4$ 定义的变换 $T: X \\to X$。设函数 $f: X \\to \\mathbb{R}$ 定义为 $f(k) = k^2$。\n\n从点 $k \\in X$ 出发的函数 $f$ 的长期时间平均由以下极限定义：\n$$ \\bar{f}(k) = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} f(T^n k) $$\n其中 $T^n k$ 表示将变换 $T$ 应用 $n$ 次，且 $T^0 k = k$。\n\n你的任务是计算函数 $\\bar{f}: X \\to \\mathbb{R}$。下列哪个选项正确地描述了函数 $\\bar{f}$？\n\nA. $\\bar{f}(k) = 11$ 对所有 $k \\in X$ 成立。\n\nB. 当 $k \\in \\{1,2,3\\}$ 时 $\\bar{f}(k) = 2$，当 $k \\in \\{4,5\\}$ 时 $\\bar{f}(k) = 4.5$。\n\nC. 当 $k \\in \\{1,2,3\\}$ 时 $\\bar{f}(k) = \\frac{14}{3}$，当 $k \\in \\{4,5\\}$ 时 $\\bar{f}(k) = \\frac{41}{2}$。\n\nD. 当 $k \\in \\{1,2,3\\}$ 时 $\\bar{f}(k) = \\frac{41}{2}$，当 $k \\in \\{4,5\\}$ 时 $\\bar{f}(k) = \\frac{14}{3}$。\n\nE. 当 $k \\in \\{1,2,3\\}$ 时 $\\bar{f}(k) = \\frac{14}{5}$，当 $k \\in \\{4,5\\}$ 时 $\\bar{f}(k) = \\frac{41}{5}$。", "solution": "因为 $X$ 是有限的且 $T$ 是一个置换，所以每个点 $k \\in X$ 都位于一个周期轨道上。如果 $k$ 的周期是 $m \\in \\mathbb{N}$，那么 $T^{m}k=k$，且序列 $\\{f(T^{n}k)\\}_{n \\geq 0}$ 是周期为 $m$ 的周期序列。对于 $N=qm+r$，其中 $q \\in \\mathbb{N}$ 且 $0 \\leq r < m$，我们有\n$$\n\\sum_{n=0}^{N-1} f(T^{n}k)=q \\sum_{n=0}^{m-1} f(T^{n}k)+\\sum_{n=0}^{r-1} f(T^{n}k).\n$$\n两边除以 $N$ 得到\n$$\n\\frac{1}{N}\\sum_{n=0}^{N-1} f(T^{n}k) = \\frac{q}{N} \\sum_{n=0}^{m-1} f(T^{n}k) + \\frac{1}{N}\\sum_{n=0}^{r-1} f(T^{n}k).\n$$\n当 $N \\to \\infty$ 时，我们有 $\\frac{q}{N} \\to \\frac{1}{m}$，并且因为 $f$ 在有限集 $X$ 上有界，余项趋于 $0$。因此，\n$$\n\\bar{f}(k)=\\lim_{N \\to \\infty} \\frac{1}{N}\\sum_{n=0}^{N-1} f(T^{n}k)=\\frac{1}{m}\\sum_{n=0}^{m-1} f(T^{n}k),\n$$\n即 $f$ 在通过 $k$ 的轨道的一个周期上的平均值。\n\n置换 $T$ 有两个不相交的循环：长度为 3 的 $(1\\,2\\,3)$ 和长度为 2 的 $(4\\,5)$。因此，对于 $k \\in \\{1,2,3\\}$，\n$$\n\\bar{f}(k)=\\frac{1}{3}\\big(f(1)+f(2)+f(3)\\big)=\\frac{1}{3}\\big(1^{2}+2^{2}+3^{2}\\big)=\\frac{1+4+9}{3}=\\frac{14}{3},\n$$\n而对于 $k \\in \\{4,5\\}$，\n$$\n\\bar{f}(k)=\\frac{1}{2}\\big(f(4)+f(5)\\big)=\\frac{1}{2}\\big(4^{2}+5^{2}\\big)=\\frac{16+25}{2}=\\frac{41}{2}.\n$$\n与选项比较，这与选项 C 匹配。", "answer": "$$\\boxed{C}$$", "id": "1447100"}]}