{"hands_on_practices": [{"introduction": "在复杂的动力系统中，我们常常需要借助数值工具来判断运动是规则的（在不变环面上）还是混沌的。最大李雅普诺夫指数 ($\\lambda_{\\max}$) 是诊断混沌的“黄金标准”，它量化了系统对初始条件的敏感性。这个练习将检验你解释计算结果以对轨道行为进行分类的能力，这是区分环面上规则运动和“混沌海”中无序运动的第一步。[@problem_id:1665453]", "problem": "一位等离子体物理研究人员正在研究磁约束场中带电粒子运动的一个简化模型。在某个二维相空间投影中，粒子轨道的动力学由一组方程决定，这些方程依赖于单个可调控制参数 $\\epsilon$。对于较小的 $\\epsilon$ 值，理论工作预测粒子轨道是准周期的，这意味着它们位于相空间中的一个不变环面上。当 $\\epsilon$ 增加超过一个临界值时，这些环面预计会破裂，粒子的运动变得混沌，探索相空间中一个被称为“混沌海”的更大区域。\n\n为了研究这一转变，该研究人员对几个不同的控制参数 $\\epsilon$ 值，数值计算了最大李雅普诺夫指数 $\\lambda_{max}$。最大李雅普诺夫指数用于量化两条初始距离无穷小的轨道之间指数发散的平均速率。正的 $\\lambda_{max}$ 是混沌的一个标志，而对于环面上的规则准周期运动，$\\lambda_{max}$ 为零。由于数值模拟的有限时间和浮点运算，理论上为零的指数将被测量为一个在零附近波动的很小的值。计算出的指数单位是秒的倒数 ($s^{-1}$)。\n\n下面显示了四个计算实验的结果：\n\n| 实验ID | 控制参数 ($\\epsilon$) | 计算出的最大李雅普诺夫指数 ($\\lambda_{max}$)，单位 $s^{-1}$ |\n|---------------|----------------------------------|-----------------------------------------------------------------|\n| 1             | 0.15                             | $0.003$                                                         |\n| 2             | 0.48                             | $0.57$                                                          |\n| 3             | 0.71                             | $-0.008$                                                        |\n| 4             | 0.92                             | $1.14$                                                          |\n\n根据这些数据，以下哪个陈述正确地分类了实验中观察到的运动？\n\nA. 实验1和3显示了不变环面上的运动；实验2和4显示了混沌运动。\n\nB. 实验2和4显示了不变环面上的运动；实验1和3显示了混沌运动。\n\nC. 实验1、2和3显示了不变环面上的运动；实验4显示了混沌运动。\n\nD. 实验1显示了不变环面上的运动；实验2、3和4显示了混沌运动。\n\nE. 所有实验都显示了混沌运动。", "solution": "我们使用最大李雅普诺夫指数的定义属性。对于两条初始间距为 $\\delta x(0)$ 的无穷小近邻轨道，最大李雅普诺夫指数为\n$$\n\\lambda_{\\max}=\\lim_{t\\to\\infty}\\frac{1}{t}\\ln\\left(\\frac{|\\delta x(t)|}{|\\delta x(0)|}\\right).\n$$\n解释规则：\n- 如果 $\\lambda_{\\max}>0$，则存在指数发散，运动是混沌的。\n- 如果 $\\lambda_{\\max}=0$，则运动是规则的（例如，在不变环面上的准周期运动）。\n- 在有限时间的数值计算中，理论上为零的 $\\lambda_{\\max}$ 会表现为一个在零附近波动的很小的值，由于数值误差，它可能略大于零或略小于零。\n\n应用于数据：\n- 实验1: $\\lambda_{\\max}=0.003\\,\\text{s}^{-1}$ 是一个接近零的小值，与环面上的准周期运动一致。\n- 实验2: $\\lambda_{\\max}=0.57\\,\\text{s}^{-1}>0$ 表明是混沌运动。\n- 实验3: $\\lambda_{\\max}=-0.008\\,\\text{s}^{-1}$ 是一个量级接近零的小值；考虑到所述的有限时间效应，这与理论上为零的指数一致，因此是在不变环面上的准周期运动。\n- 实验4: $\\lambda_{\\max}=1.14\\,\\text{s}^{-1}>0$ 表明是混沌运动。\n\n因此，实验1和3显示了不变环面上的运动，而实验2和4显示了混沌运动。这对应于选项A。", "answer": "$$\\boxed{A}$$", "id": "1665453"}, {"introduction": "当一个可积系统受到微扰时，并非所有的环面都会以相同的方式被破坏。KAM 定理告诉我们，具有足够“无理”频率的环面会存活下来，而具有“有理”频率的环面则会破裂成一系列稳定的岛链。这项实践将深入探讨这一过程的核心，要求你分析计算出主共振岛的大小，这是微扰后出现的混合相空间中的一个关键特征。[@problem_id:1665409]", "problem": "考虑一个单自由度哈密顿系统，其未扰动动力学由哈密顿量 $H_0(I) = \\frac{1}{2} \\alpha I^2$ 描述，其中 $I$ 和 $\\theta$ 是正则作用量-角变量，$\\alpha$ 是一个正常数。该系统受到一个弱的时间周期性微扰，得到的总哈密顿量为：\n$$H(I, \\theta, t) = \\frac{1}{2} \\alpha I^2 + \\epsilon V \\cos(k\\theta - m\\Omega t)$$\n此处，$\\epsilon$ 是一个微小的无量纲正常数，$V$ 是一个具有能量单位的正常数，$k$ 和 $m$ 是正整数，$\\Omega$ 是微扰的角频率。\n\n这种微扰可以在相空间中导致共振岛的形成。当系统的未扰动频率 $\\omega(I) = \\frac{dH_0}{dI}$ 与微扰频率 $\\Omega$ 可公度时，会在一个特定的作用量值 $I_r$ 处发生主共振。对于由整数 $k$ 和 $m$ 定义的共振，在原始共振轨道附近会形成一系列被称为“岛”的稳定区域。这一系列岛的边界是一条分界线，它将岛内部的捕获运动与外部的非捕获运动分离开来。\n\n确定该共振区域的全宽度 $\\Delta I$，其定义为作用量变量 $I$ 沿分界线轨道的最大值与最小值之差。将您的答案表示为关于 $\\alpha, \\epsilon,$ 和 $V$ 的符号表达式。", "solution": "未扰动的哈密顿量为 $H_{0}(I)=\\frac{1}{2}\\alpha I^{2}$，因此未扰动频率为\n$$\n\\omega(I)=\\frac{dH_{0}}{dI}=\\alpha I.\n$$\n一个 $(k:m)$ 共振发生在 $I=I_{r}$ 处，使得\n$$\nk\\,\\omega(I_{r})=m\\,\\Omega \\quad \\Rightarrow \\quad k\\,\\alpha I_{r}=m\\,\\Omega \\quad \\Rightarrow \\quad I_{r}=\\frac{m\\,\\Omega}{k\\,\\alpha}.\n$$\n为分析此共振，引入扩展哈密顿量 $K=H+E$ 并使用生成函数进行到共振变量的正则变换\n$$\nF_{2}=(k\\theta - m\\Omega t)\\,J + t\\,P,\n$$\n这得到\n$$\n\\psi = k\\theta - m\\Omega t,\\quad \\chi = t,\\quad I = \\frac{\\partial F_{2}}{\\partial \\theta}=kJ,\\quad E=\\frac{\\partial F_{2}}{\\partial t}=-m\\Omega J + P.\n$$\n在这些变量中，支配 $(J,\\psi)$ 的自治哈密顿量是\n$$\nK_{\\text{res}}(J,\\psi)=H_{0}(kJ)-m\\Omega J+\\epsilon V\\cos\\psi + P,\n$$\n并且由于 $P$ 对于 $(J,\\psi)$ 动力学是可忽略的，我们考虑\n$$\nK_{\\text{res}}(J,\\psi)=H_{0}(kJ)-m\\Omega J+\\epsilon V\\cos\\psi.\n$$\n围绕共振作用量 $J_{r}=I_{r}/k$ 展开到二阶。使用 $dH_{0}/dI=\\alpha I$ 和 $d^{2}H_{0}/dI^{2}=\\alpha$，泰勒展开给出\n$$\nH_{0}(kJ)\\approx H_{0}(kJ_{r})+\\left.\\frac{dH_{0}}{dI}\\right|_{I_{r}}(k\\Delta J)+\\frac{1}{2}\\left.\\frac{d^{2}H_{0}}{dI^{2}}\\right|_{I_{r}}(k\\Delta J)^{2},\n$$\n其中 $\\Delta J=J-J_{r}$。代入 $K_{\\text{res}}$ 中，\n$$\nK_{\\text{res}}\\approx \\left[H_{0}(kJ_{r})-m\\Omega J_{r}\\right]+\\left[\\omega(I_{r})k-m\\Omega\\right]\\Delta J+\\frac{1}{2}\\alpha k^{2}\\Delta J^{2}+\\epsilon V\\cos\\psi.\n$$\n根据共振条件 $k\\,\\omega(I_{r})=m\\,\\Omega$，线性项消失，得到单摆哈密顿量\n$$\nK_{\\text{eff}}(\\Delta J,\\psi)=\\frac{1}{2}\\,\\alpha k^{2}\\,\\Delta J^{2}+\\epsilon V\\cos\\psi.\n$$\n对于 $\\epsilon V>0$ 和 $\\alpha>0$，稳定不动点位于 $(\\Delta J=0,\\psi=\\pi)$，不稳定（鞍）点位于 $(\\Delta J=0,\\psi=0)$。分界线能量等于鞍点处的哈密顿量，\n$$\nE_{\\text{sep}}=\\epsilon V\\cos 0=\\epsilon V.\n$$\n在稳定角 $\\psi=\\pi$ 处，势为 $U(\\pi)=\\epsilon V\\cos\\pi=-\\epsilon V$。沿着经过 $\\psi=\\pi$ 的分界线，动能等于差值 $E_{\\text{sep}}-U(\\pi)=2\\epsilon V$，所以\n$$\n\\frac{1}{2}\\,\\alpha k^{2}\\,(\\Delta J_{\\max})^{2}=2\\,\\epsilon V\n\\quad \\Rightarrow \\quad\n\\Delta J_{\\max}=2\\sqrt{\\frac{\\epsilon V}{\\alpha k^{2}}}.\n$$\n$J$ 的全宽度为 $2\\,\\Delta J_{\\max}=4\\sqrt{\\frac{\\epsilon V}{\\alpha k^{2}}}$。由于 $I=kJ$，$I$ 的全宽度为\n$$\n\\Delta I = k \\times \\left(2\\,\\Delta J_{\\max}\\right)\n= k \\times 4\\sqrt{\\frac{\\epsilon V}{\\alpha k^{2}}}\n= 4\\sqrt{\\frac{\\epsilon V}{\\alpha}}.\n$$\n这个 $\\Delta I$ 是沿分界线的 $I$ 的最大值和最小值之差，对于这个二次哈密顿量 $H_0$，它仅取决于 $\\alpha$、$\\epsilon$ 和 $V$。", "answer": "$$\\boxed{4\\sqrt{\\frac{\\epsilon V}{\\alpha}}}$$", "id": "1665409"}, {"introduction": "现在，让我们将所有概念融会贯通。最后的这项实践是一个计算性的小项目，你将使用著名的模型系统——标准映射（Standard Map），来可视化环面破裂的整个过程。你将通过编程为不同的微扰强度 $K$ 生成庞加莱截面，并使用你在第一个练习中学到的李雅普诺夫指数来量化系统从有序到混沌转变过程中不断增长的“混沌海”。[@problem_id:2426865]", "problem": "你的任务是通过庞加莱截面为一保面积映射构建并分析相空间相图。该映射模拟了一个周期性受踢转子，并且是 Kolmogorov–Arnold–Moser (KAM) 定理的一个典范例子。考虑在二维环面上定义的标准映射，其通过映射 $\\Phi_K : (\\theta_n, p_n) \\mapsto (\\theta_{n+1}, p_{n+1})$ 的迭代给出：\n$$\n\\begin{aligned}\np_{n+1} &= \\left(p_n + K \\sin \\theta_n\\right) \\bmod 2\\pi,\\\\\n\\theta_{n+1} &= \\left(\\theta_n + p_{n+1}\\right) \\bmod 2\\pi,\n\\end{aligned}\n$$\n其中 $K \\ge 0$ 是一个微扰参数，$\\theta \\in [0,2\\pi)$ 是一个角度，而 $p \\in [0,2\\pi)$ 是一个类作用量变量。集合 $\\{(\\theta_n, p_n)\\}_{n \\ge 0}$ 构成了庞加莱截面。所有角度必须以弧度为单位。\n\n将映射 $\\Phi_K$ 在相点 $(\\theta_0,p_0)$ 处的最大李雅普诺夫指数 $\\lambda_{\\max}$ 定义为以下极限：\n$$\n\\lambda_{\\max}(\\theta_0,p_0;K) = \\lim_{N \\to \\infty} \\frac{1}{N}\\,\\ln \\left\\| D\\Phi_K^N(\\theta_0,p_0)\\, v_0 \\right\\|,\n$$\n其中 $D\\Phi_K^N$ 是该映射沿起始于 $(\\theta_0,p_0)$ 的轨道求值的 N 次复合的导数（雅可比矩阵），$\\|\\cdot\\|$ 是欧几里得范数，$v_0 \\ne 0$ 是任意单位切向量。对于标准映射的单步雅可比矩阵 $J_n = D\\Phi_K(\\theta_n,p_n)$，有：\n$$\nJ_n =\n\\begin{pmatrix}\n1 + K \\cos \\theta_n & 1\\\\\nK \\cos \\theta_n & 1\n\\end{pmatrix}.\n$$\n如果一条轨道的有限时间李雅普诺夫指数估计值 $\\hat{\\lambda}_{\\max}$ (沿其轨道计算 N 次迭代得到) 满足 $\\hat{\\lambda}_{\\max} > \\tau$（其中 $\\tau > 0$ 是给定的阈值），则该轨道被认为是混沌的；否则，它被认为是规则的。你的任务是针对每个指定情况，使用上述定义数值近似 $\\hat{\\lambda}_{\\max}$，并确定混沌初始条件的比例。\n\n测试套件和规格：\n- 使用微扰参数集 $K$ 等于四个值 $K \\in \\{\\,0.0,\\,0.2,\\,0.98,\\,1.2\\,\\}$。\n- 使用由 $n_\\theta = 8$ 和 $n_p = 8$ 定义的均匀初始条件网格。具体而言，取\n$$\n\\theta_0(i) = \\frac{2\\pi\\, i}{n_\\theta},\\quad i \\in \\{0,1,\\ldots,7\\}, \\qquad\np_0(j) = \\frac{2\\pi\\, j}{n_p},\\quad j \\in \\{0,1,\\ldots,7\\}.\n$$\n这将在环面 $[0,2\\pi)\\times[0,2\\pi)$ 上产生 $n_\\theta \\times n_p = 64$ 个初始条件 $(\\theta_0(i), p_0(j))$。\n- 对于每个初始条件和每个 $K$ 值，将映射迭代 $N = 3000$ 步以近似 $\\hat{\\lambda}_{\\max}$，并使用混沌分类阈值 $\\tau = 10^{-2}$，即如果 $\\hat{\\lambda}_{\\max} > 10^{-2}$，则将轨道分类为混沌，否则分类为规则。\n- 角度必须以弧度处理，所有计算都是无量纲的。\n\n交付成果：\n- 对于测试套件中的每个 $K$ 值，计算 64 个初始条件中混沌条件的比例。将这四个比例报告为四舍五入到三位小数的小数。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含结果，形式为由方括号括起来的、无空格的四个四舍五入分数的逗号分隔列表。例如，一个可接受的输出格式是\n$$\n[0.000,0.031,0.734,0.953].\n$$", "solution": "所提出的问题是计算非线性动力学中的一个标准练习，并且是有效的。它在科学上植根于成熟的哈密顿混沌理论，特别是使用标准映射作为模型系统。该问题是适定的，提供了所有必要的参数和明确的目标。它没有歧义、主观性或任何事实不一致之处，因此可以被严格地解决。\n\n任务是确定标准映射在指定初始条件网格上，对于几个不同的微扰参数 $K$ 值，混沌轨道的比例。如果一条轨道的数值近似最大李雅普诺夫指数 $\\hat{\\lambda}_{\\max}$ 超过给定的阈值 $\\tau$，则该轨道被分类为混沌。\n\n标准映射在二维环面 $(\\theta, p) \\in [0,2\\pi) \\times [0,2\\pi)$ 上由以下离散时间演化定义：\n$$\n\\begin{aligned}\np_{n+1} &= (p_n + K \\sin \\theta_n) \\bmod 2\\pi, \\\\\n\\theta_{n+1} &= (\\theta_n + p_{n+1}) \\bmod 2\\pi.\n\\end{aligned}\n$$\n在此，$n$ 是离散时间步长，$K \\ge 0$ 是随机性参数。当 $K=0$ 时，系统是可积的，所有轨道都位于由恒定动量 $p$ 定义的不变一维环面上。随着 $K$ 的增加，这些环面逐渐被破坏，让位于相空间中的混沌区域，这一现象由 Kolmogorov–Arnold–Moser (KAM) 定理描述。\n\n最大李雅普诺夫指数 $\\lambda_{\\max}$ 量化了相邻轨道指数发散的平均速率。一个正的 $\\lambda_{\\max}$ 是混沌系统的定义性特征。对于从 $(\\theta_0, p_0)$ 开始的轨道，它被正式定义为：\n$$\n\\lambda_{\\max}(\\theta_0,p_0;K) = \\lim_{N \\to \\infty} \\frac{1}{N}\\,\\ln \\left\\| D\\Phi_K^N(\\theta_0,p_0)\\, v_0 \\right\\|,\n$$\n其中 $D\\Phi_K^N$ 是映射第 N 次迭代的雅可比矩阵，$v_0$ 是一个任意非零切向量。第 N 次迭代的雅可比矩阵是沿轨道各单步雅可比矩阵的乘积：\n$$\nD\\Phi_K^N(\\theta_0, p_0) = J_{N-1} \\cdot J_{N-2} \\cdots J_0, \\quad \\text{其中} \\quad J_n = D\\Phi_K(\\theta_n, p_n).\n$$\n标准映射的单步雅可比矩阵是：\n$$\nJ_n = \\begin{pmatrix} 1 + K \\cos \\theta_n & 1 \\\\ K \\cos \\theta_n & 1 \\end{pmatrix}.\n$$\n\n直接计算 $N$ 个矩阵的乘积在数值上是不稳定的，因为结果矩阵的范数可以指数级增长或缩小，导致上溢或下溢错误。通常采用一种标准的稳定算法来计算 $N$ 次迭代的有限时间近似值 $\\hat{\\lambda}_{\\max}$。该算法将一个切向量与相空间轨道一同演化，并在每一步对其进行重新归一化。\n\n对于给定的初始条件 $(\\theta_0, p_0)$ 和参数 $K$，算法流程如下：\n1. 初始化状态 $(\\theta,p) = (\\theta_0,p_0)$。\n2. 初始化一个切向量为单位向量，例如 $v = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n3. 初始化一个累加器 $S = 0$，用于存放拉伸因子的对数。\n4. 迭代 $n=0, 1, \\dots, N-1$：\n   a. 在当前状态 $(\\theta_n, p_n)$，计算雅可比矩阵 $J_n$。\n   b. 将切向量演化一步：$w = J_n v_n$。\n   c. 计算演化后向量的范数 $d_n = \\|w\\|$。这代表了局部拉伸因子。\n   d. 将拉伸因子的对数加到累加器中：$S = S + \\ln(d_n)$。\n   e. 为下一次迭代重新归一化切向量：$v_{n+1} = w / d_n$。\n   f. 将相空间状态演化到下一步：$(\\theta_{n+1}, p_{n+1}) = \\Phi_K(\\theta_n, p_n)$。\n5. 经过 $N$ 次迭代后，有限时间李雅普诺夫指数被计算为对数拉伸率的平均值：\n$$\n\\hat{\\lambda}_{\\max} = \\frac{S}{N} = \\frac{1}{N} \\sum_{n=0}^{N-1} \\ln(d_n).\n$$\n该方法等同于在每一步对累积的雅可比矩阵乘积应用 QR 分解，从而稳健地提取出最大奇异值的增长率。\n\n为解决此问题，需对指定网格上的 $n_\\theta \\times n_p = 8 \\times 8 = 64$ 个初始条件中的每一个，以及对 $K \\in \\{0.0, 0.2, 0.98, 1.2\\}$ 中的每一个值，执行此过程。迭代次数为 $N = 3000$。对于每条轨道，将得到的 $\\hat{\\lambda}_{\\max}$ 与阈值 $\\tau = 10^{-2}$ 进行比较。如果 $\\hat{\\lambda}_{\\max} > \\tau$，则该轨道被计为混沌。每个 $K$ 值的最终结果是混沌轨道的总数除以 64，并四舍五入到三位小数。当 $K=0$ 时，系统是可积的，雅可比矩阵是常数，导致所有轨道的 $\\lambda_{\\max}=0$；因此，混沌轨道的比例必须是 $0.000$。随着 $K$ 的增加，这个比例预期会上升，反映了规则 KAM 环面的破坏和广泛混沌的出现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the fraction of chaotic initial conditions for the Standard Map\n    for a given set of parameters.\n    \"\"\"\n    # Define the test cases and specifications from the problem statement.\n    test_cases = [0.0, 0.2, 0.98, 1.2]\n    n_theta = 8\n    n_p = 8\n    N = 3000\n    tau = 1e-2\n    two_pi = 2 * np.pi\n\n    # Generate the uniform grid of initial conditions.\n    initial_thetas = (two_pi * np.arange(n_theta)) / n_theta\n    initial_ps = (two_pi * np.arange(n_p)) / n_p\n    total_initial_conditions = n_theta * n_p\n\n    results = []\n    \n    # Iterate over each perturbation parameter K.\n    for K in test_cases:\n        chaotic_count = 0\n        \n        # Iterate over each initial condition on the grid.\n        for theta0 in initial_thetas:\n            for p0 in initial_ps:\n                # Initialize the state and tangent vector for this trajectory.\n                theta, p = theta0, p0\n                # An arbitrary non-zero unit tangent vector.\n                v = np.array([1.0, 0.0])\n                log_sum = 0.0\n\n                # Iterate the map N times to compute the Lyapunov exponent.\n                for _ in range(N):\n                    # Compute the Jacobian at the current state (theta, p).\n                    cos_theta = np.cos(theta)\n                    J = np.array([\n                        [1.0 + K * cos_theta, 1.0],\n                        [K * cos_theta, 1.0]\n                    ])\n\n                    # Evolve the tangent vector using the Jacobian.\n                    w = J @ v\n                    \n                    # Compute the norm (stretching factor) and renormalize.\n                    norm_w = np.linalg.norm(w)\n                    if norm_w > 0:\n                        v = w / norm_w\n                        log_sum += np.log(norm_w)\n                    # If norm_w is zero, stretching is zero, log is -inf.\n                    # This case is unlikely and indicates a fixed point a-la-Lyapunov, \n                    # but robust code would handle it. Let's assume norm_w > 0.\n                    \n                    # Evolve the state using the Standard Map equations.\n                    p_next = (p + K * np.sin(theta)) % two_pi\n                    theta_next = (theta + p_next) % two_pi\n                    theta, p = theta_next, p_next\n                \n                # Calculate the finite-time Lyapunov exponent estimate.\n                lambda_hat_max = log_sum / N\n                \n                # Classify the orbit as chaotic if the exponent exceeds the threshold.\n                if lambda_hat_max > tau:\n                    chaotic_count += 1\n        \n        # Calculate the fraction of chaotic orbits for the current K value.\n        fraction_chaotic = chaotic_count / total_initial_conditions\n        results.append(fraction_chaotic)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2426865"}]}