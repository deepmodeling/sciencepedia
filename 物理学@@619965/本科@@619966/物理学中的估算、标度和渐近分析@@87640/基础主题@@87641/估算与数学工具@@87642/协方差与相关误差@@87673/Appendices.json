{"hands_on_practices": [{"introduction": "在我们开始探索相关误差的复杂世界之前，让我们从一个基本且直观的例子入手。这个练习将向您展示，当两个或多个量都是根据同一个带有不确定性的测量值得出时，它们的误差为何以及如何变得相关。通过计算一个球体的表面积 $A$ 和体积 $V$ 之间的协方差（两者都源于对半径 $r$ 的单次测量），您将掌握使用一阶不确定性传播来量化这种相关性的核心技能 [@problem_id:1892950]。", "problem": "在一次材料科学实验中，一名研究人员合成了一个单一、完美的球形纳米粒子。为表征其性质，需进行一系列测量来确定其半径 $r$。这些测量存在微小的随机误差。对测量数据进行统计分析后，确定其平均半径为 $r_0$，该测量的方差为 $\\sigma_r^2$。\n\n从这一个测得的参数，可以计算出两个关键的几何性质：表面积，由公式 $A = 4\\pi r^2$ 给出；以及体积，由公式 $V = \\frac{4}{3}\\pi r^3$ 给出。由于 $A$ 和 $V$ 都源自同一个不确定量 $r$，因此 $A$ 和 $V$ 的不确定度不是独立的，它们是相关的。\n\n本题要求计算表面积 $A$ 和体积 $V$ 之间的协方差。假设半径的不确定度很小（即 $\\sigma_r \\ll r_0$），因此不确定度传播的线性近似是有效的。\n\n请给出协方差 $\\text{Cov}(A, V)$ 的解析表达式，用平均半径 $r_0$ 和半径的方差 $\\sigma_r^2$ 来表示。", "solution": "设 $r$ 为一个随机变量，其均值为 $r_{0}$，方差为 $\\sigma_{r}^{2}$。定义 $A(r)=4\\pi r^{2}$ 和 $V(r)=\\frac{4}{3}\\pi r^{3}$。对于 $r$ 的微小不确定度，我们使用关于 $r_{0}$ 的一阶泰勒展开。记 $r=r_{0}+\\delta r$，其中 $\\mathbb{E}[\\delta r]=0$ 且 $\\mathbb{V}[\\delta r]=\\sigma_{r}^{2}$。\n\n一阶近似为：\n$$\nA \\approx A(r_{0})+A'(r_{0})\\,\\delta r, \\quad V \\approx V(r_{0})+V'(r_{0})\\,\\delta r.\n$$\n协方差为：\n$$\n\\text{Cov}(A,V)=\\mathbb{E}\\big[(A-\\mathbb{E}[A])(V-\\mathbb{E}[V])\\big]\\approx \\mathbb{E}\\big[A'(r_{0})\\,\\delta r \\cdot V'(r_{0})\\,\\delta r\\big]=A'(r_{0})\\,V'(r_{0})\\,\\mathbb{E}[(\\delta r)^{2}].\n$$\n使用 $\\mathbb{E}[(\\delta r)^{2}]=\\sigma_{r}^{2}$，可得：\n$$\n\\text{Cov}(A,V)\\approx A'(r_{0})\\,V'(r_{0})\\,\\sigma_{r}^{2}.\n$$\n计算导数：\n$$\nA'(r)=\\frac{d}{dr}\\big(4\\pi r^{2}\\big)=8\\pi r, \\quad V'(r)=\\frac{d}{dr}\\bigg(\\frac{4}{3}\\pi r^{3}\\bigg)=4\\pi r^{2}.\n$$\n在 $r_0$ 处求值并代入：\n$$\n\\text{Cov}(A,V)\\approx \\big(8\\pi r_{0}\\big)\\big(4\\pi r_{0}^{2}\\big)\\sigma_{r}^{2}=32\\pi^{2}r_{0}^{3}\\sigma_{r}^{2}.\n$$\n这就是在所述线性近似下的协方差。", "answer": "$$\\boxed{32\\pi^{2}r_{0}^{3}\\sigma_{r}^{2}}$$", "id": "1892950"}, {"introduction": "在许多物理和计算过程中，微小的系统误差会在多个步骤中累积。这个练习将我们的分析从静态计算扩展到一个动态系统：一个二维随机行走。您将研究模拟中的一个微小缺陷如何导致每一步中 $x$ 和 $y$ 方向的位移产生关联，并计算出在大量步数后总位移的协方差 [@problem_id:1892984]。这个例子阐明了协方差在描述随机过程累积效应时的强大作用，这对于理解模拟和时间序列分析中的误差传播至关重要。", "problem": "在一个计算物理模拟中，一个粒子在二维平面上进行随机游走。该游走由 $N$ 个离散的步组成，步的索引为 $i = 1, 2, \\dots, N$。在 $N$ 步之后，粒子的总位移由向量 $\\vec{R}_N = (X_N, Y_N)$ 给出，其中 $X_N = \\sum_{i=1}^{N} \\Delta x_i$ 和 $Y_N = \\sum_{i=1}^{N} \\Delta y_i$ 是最终坐标。\n\n生成每一步位移向量 $\\vec{s}_i = (\\Delta x_i, \\Delta y_i)$ 的过程存在一个微小的系统性偏差。在第 $i$ 步，模拟执行以下子步骤：\n1.  生成两个独立同分布的随机数 $v_{ix}$ 和 $v_{iy}$。这些数从一个均值为零、方差为 $\\sigma_v^2$ 的分布中抽取。\n2.  使用一个有缺陷的耦合规则计算该步的实际位移分量 $\\Delta x_i$ 和 $\\Delta y_i$：\n    $$ \\Delta x_i = v_{ix} + \\alpha v_{iy} $$\n    $$ \\Delta y_i = v_{iy} + \\beta v_{ix} $$\n    此处，$\\alpha$ 和 $\\beta$ 是已知的微小无量纲常数，它们表征了模拟中的系统误差。各步之间是相互独立的；也就是说，为第 $i$ 步生成的随机数 $(v_{ix}, v_{iy})$ 与为任何其他步 $j \\neq i$ 生成的随机数 $(v_{jx}, v_{jy})$ 相互独立。\n\n计算最终 x 和 y 位置之间的协方差 $\\text{Cov}(X_N, Y_N)$。请用参数 $N$、$\\alpha$、$\\beta$ 和 $\\sigma_v^2$ 给出一个单一的闭式解析表达式作为答案。", "solution": "我们记 $X_{N}=\\sum_{i=1}^{N}\\Delta x_{i}$ 和 $Y_{N}=\\sum_{i=1}^{N}\\Delta y_{i}$，其中对于每一步 $i$，\n$$\n\\Delta x_{i}=v_{ix}+\\alpha v_{iy},\\qquad \\Delta y_{i}=v_{iy}+\\beta v_{ix}.\n$$\n此处 $v_{ix}$ 和 $v_{iy}$ 是独立同分布的，其均值为 $0$，方差为 $\\sigma_{v}^{2}$，并且不同步之间的随机数对是相互独立的。\n\n根据协方差的双线性性质，\n$$\n\\operatorname{Cov}(X_{N},Y_{N})=\\operatorname{Cov}\\!\\left(\\sum_{i=1}^{N}\\Delta x_{i},\\sum_{j=1}^{N}\\Delta y_{j}\\right)=\\sum_{i=1}^{N}\\sum_{j=1}^{N}\\operatorname{Cov}(\\Delta x_{i},\\Delta y_{j}).\n$$\n由于各步之间相互独立，当 $i\\neq j$ 时，$\\operatorname{Cov}(\\Delta x_{i},\\Delta y_{j})=0$，因此\n$$\n\\operatorname{Cov}(X_{N},Y_{N})=\\sum_{i=1}^{N}\\operatorname{Cov}(\\Delta x_{i},\\Delta y_{i})=N\\,\\operatorname{Cov}(\\Delta x,\\Delta y),\n$$\n其中 $(\\Delta x,\\Delta y)$ 表示一个通用步。\n\n计算每一步的协方差。由于 $E[v_{x}]=E[v_{y}]=0$，我们有 $E[\\Delta x]=E[v_{x}+\\alpha v_{y}]=0$ 且 $E[\\Delta y]=E[v_{y}+\\beta v_{x}]=0$。因此，\n$$\n\\operatorname{Cov}(\\Delta x,\\Delta y)=E[\\Delta x\\,\\Delta y]=E\\big[(v_{x}+\\alpha v_{y})(v_{y}+\\beta v_{x})\\big].\n$$\n展开并利用 $v_{x}$ 和 $v_{y}$ 的独立性，以及 $E[v_{x}v_{y}]=0$，$E[v_{x}^{2}]=E[v_{y}^{2}]=\\sigma_{v}^{2}$，\n$$\nE[\\Delta x\\,\\Delta y]=E[v_{x}v_{y}]+\\beta E[v_{x}^{2}]+\\alpha E[v_{y}^{2}]+\\alpha\\beta E[v_{y}v_{x}]=\\beta\\sigma_{v}^{2}+\\alpha\\sigma_{v}^{2}=(\\alpha+\\beta)\\sigma_{v}^{2}.\n$$\n所以，\n$$\n\\operatorname{Cov}(X_{N},Y_{N})=N(\\alpha+\\beta)\\sigma_{v}^{2}.\n$$", "answer": "$$\\boxed{N(\\alpha+\\beta)\\sigma_{v}^{2}}$$", "id": "1892984"}, {"introduction": "相关误差不仅仅是理论上的好奇心；它们在日常的科学数据分析中扮演着至关重要的角色。本练习将焦点从定量计算转向建立定性直觉，探讨一个极其常见的情景：线性回归 [@problem_id:1892979]。您将通过一个思想实验来解释，为什么在对远离坐标轴的数据点进行线性拟合时，得到的斜率 $m$ 和截距 $c$ 的估计误差会呈现强烈的反相关性。理解这种现象对于正确解释拟合参数及其不确定性至关重要，这是任何实验科学家都应具备的关键洞察力。", "problem": "一位天文学家正在追踪一颗新发现的小行星。在一个短暂的观测窗口内，该小行星划过天空的轨迹可以很好地用一条直线来近似。天文学家记录了一系列数据点 $(x_i, y_i)$，其中 $x$ 代表观测时间，$y$ 代表小行星的角位置。所有的观测都是在最初发现（时间 $x=0$）之后很久的几个夜晚进行的。因此，所有记录的 $x_i$ 值都很大，并且聚集在远离 $y$ 轴（时间原点）的地方。\n\n天文学家使用最小二乘法将形式为 $y(x) = mx + c$ 的线性模型拟合到这些数据点，以估计斜率 $m$ 和 y 截距 $c$。斜率 $m$ 代表小行星的角速度，而截距 $c$ 代表其在时间 $x=0$ 时的外推角位置。由于测量不确定性，估计出的 $m$ 和 $c$ 值存在统计误差。观察发现，这些误差是强反相关的；也就是说，导致斜率 $m$ 被高估的随机误差，极有可能伴随着对截距 $c$ 的低估，反之亦然。\n\n下列哪个陈述为 $m$ 和 $c$ 误差之间的这种强反相关性提供了最好的定性解释？\n\nA. 最佳拟合线必须穿过数据云的中心。由于数据云远离 $y$ 轴，斜率的微小增加（向上倾斜）会使直线围绕这个远点旋转，从而导致其 $y$ 截距大幅度向下移动。\n\nB. 参数 $m$ 和 $c$ 的误差与数据点 $(x_i, y_i)$ 的误差无关，并且最小二乘法原理要求参数误差的乘积为负。\n\nC. 因为数据远离 $y$ 轴，截距 $c$ 的值是通过长距离外推确定的。这种长距离外推会放大不确定性，根据定义，这会与斜率产生反相关。\n\nD. 任何增加斜率 $m$ 的随机误差都会使拟合线更陡峭。为了保持对远离原点的数据点的最佳拟合，直线必须向上平移，这对应于截距 $c$ 的增加。\n\nE. $m$ 和 $c$ 的标准误差公式都取决于残差平方和。为了保持这个和为最小值，一个参数误差的增加必须由另一个参数误差的减少来抵消。", "solution": "设数据遵循线性模型 $y_{i}=m x_{i}+c+\\epsilon_{i}$，其中 $\\epsilon_{i}$ 独立，均值为零，方差为 $\\sigma^{2}$。普通最小二乘估计量满足\n$$\n\\hat{m}=\\frac{\\sum_{i=1}^{n}(x_{i}-\\bar{x})(y_{i}-\\bar{y})}{\\sum_{i=1}^{n}(x_{i}-\\bar{x})^{2}},\\quad \\hat{c}=\\bar{y}-\\hat{m}\\,\\bar{x},\n$$\n其中 $\\bar{x}$ 和 $\\bar{y}$ 是样本均值，且 $S_{xx}=\\sum_{i=1}^{n}(x_{i}-\\bar{x})^{2}$。\n\n标准的 OLS 方差和协方差公式（对于固定的回归量）给出\n$$\n\\operatorname{Var}(\\hat{m})=\\frac{\\sigma^{2}}{S_{xx}},\\quad \\operatorname{Var}(\\hat{c})=\\sigma^{2}\\left(\\frac{1}{n}+\\frac{\\bar{x}^{2}}{S_{xx}}\\right),\\quad \\operatorname{Cov}(\\hat{m},\\hat{c})=-\\frac{\\sigma^{2}\\bar{x}}{S_{xx}}.\n$$\n等价地，使用 $\\hat{c}=\\bar{y}-\\hat{m}\\bar{x}$，微小扰动满足 $\\delta \\hat{c}=-\\bar{x}\\,\\delta \\hat{m}+\\delta \\bar{y}$。由于 $\\operatorname{Var}(\\bar{y})=\\sigma^{2}/n$ 而 $\\operatorname{Var}(\\hat{m})=\\sigma^{2}/S_{xx}$，当 $|\\bar{x}|$ 相对于尺度 $\\sqrt{S_{xx}/n}$ 很大时，项 $-\\bar{x}\\,\\delta \\hat{m}$ 占主导地位，从而导致 $\\hat{m}$ 和 $\\hat{c}$ 的误差之间存在强的负耦合。相关系数为\n$$\n\\operatorname{Corr}(\\hat{m},\\hat{c})=\\frac{-\\sigma^{2}\\bar{x}/S_{xx}}{\\sqrt{(\\sigma^{2}/S_{xx})\\cdot \\sigma^{2}\\left(\\frac{1}{n}+\\frac{\\bar{x}^{2}}{S_{xx}}\\right)}}=-\\frac{\\bar{x}}{\\sqrt{\\frac{S_{xx}}{n}+\\bar{x}^{2}}},\n$$\n当 $|\\bar{x}|^{2}\\gg S_{xx}/n$ 时，该值趋近于 $-1$。这正是所描述的情况：所有的 $x_i$ 都很大，并且聚集在远离 $y$ 轴的地方，因此直线实际上是围绕着 $(\\bar{x},\\bar{y})$ 附近的数据云旋转的。围绕这个远处的枢轴点，斜率的微小增加会迫使截距减小，以保持拟合线贴近同一数据云，从而产生强烈的反相关性。\n\n从定性上看，这与陈述 A 相符：最佳拟合线穿过数据云的中心附近，当该中心远离 $y$ 轴时，斜率的微小倾斜会导致在 $x=0$ 处的截距发生大的反向变化。陈述 B、C、E 描述了不正确的原理，而陈述 D 则断言了截距变化的错误方向。", "answer": "$$\\boxed{A}$$", "id": "1892979"}]}