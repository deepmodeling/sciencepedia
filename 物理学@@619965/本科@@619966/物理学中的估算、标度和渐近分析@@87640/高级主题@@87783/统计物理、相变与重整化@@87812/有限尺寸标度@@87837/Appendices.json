{"hands_on_practices": [{"introduction": "在有限尺寸标度分析中，第一步是为有限系统获得可靠的物理数据。本练习让你从第一性原理（即系统的哈密顿量 $H$）出发，通过精确枚举一个小型伊辛模型的全部微观态，来亲手计算其宏观热力学性质。这个过程不仅能加深你对微观态与宏观可观测量（如磁化率 $\\chi$）之间联系的理解，还将引导你确定“伪临界温度”$T_c(L)$，为后续的标度分析奠定基础。[@problem_id:2394487]", "problem": "考虑一个 $L\\times L$ 方形晶格上的铁磁二维伊辛模型，其自旋变量为 $s_i\\in\\{-1,+1\\}$，耦合常数 $J>0$，且外场为零。其哈密顿量为\n$$\n\\mathcal{H}(\\{s\\})=-J\\sum_{\\langle i,j\\rangle}s_is_j,\n$$\n其中，求和遍历所有最近邻对 $\\langle i,j\\rangle$，每对只计一次。需要考虑两种边界条件：开放边界条件和周期性边界条件。在开放边界条件下，一个格点的邻居仅限于在 $L\\times L$ 网格内部与其相邻的格点，无任何环绕连接。在周期性边界条件下，邻居包含环绕连接，使得晶格在拓扑上构成一个环面。\n\n对于给定的温度 $T>0$ 和系统尺寸 $L$，定义配分函数为\n$$\nZ(T,L)=\\sum_{\\{s\\}}\\exp\\left(-\\frac{\\mathcal{H}(\\{s\\})}{k_{\\mathrm{B}}T}\\right),\n$$\n总磁化强度 $M(\\{s\\})=\\sum_i s_i$ 的热力学平均值定义为\n$$\n\\langle M\\rangle_{T,L}=\\frac{1}{Z(T,L)}\\sum_{\\{s\\}} M(\\{s\\})\\exp\\left(-\\frac{\\mathcal{H}(\\{s\\})}{k_{\\mathrm{B}}T}\\right),\n$$\n$$\n\\langle M^2\\rangle_{T,L}=\\frac{1}{Z(T,L)}\\sum_{\\{s\\}} M(\\{s\\})^2\\exp\\left(-\\frac{\\mathcal{H}(\\{s\\})}{k_{\\mathrm{B}}T}\\right).\n$$\n零场下的单位自旋磁化率定义为\n$$\n\\chi(T,L)=\\frac{1}{k_{\\mathrm{B}}TN}\\left(\\langle M^2\\rangle_{T,L}-\\langle M\\rangle_{T,L}^2\\right),\\quad N=L^2.\n$$\n\n在本问题中，采用无量纲单位 $J=1$ 和 $k_{\\mathrm{B}}=1$，因此温度的单位是 $J/k_{\\mathrm{B}}$。对于每个指定的 $(L,\\text{边界条件})$ 对，将有限尺寸伪临界温度 $T_c(L)$ 操作性地定义为离散温度集合\n$$\n\\mathcal{T}=\\{T\\,\\mid\\,T=1.00+0.02\\,n,\\ n\\in\\mathbb{Z},\\ 0\\le n\\le 150\\}\n$$\n中使 $\\chi(T,L)$ 达到其最大值的那个元素。如果 $\\chi(T,L)$ 在 $\\mathcal{T}$ 中的多个温度下均达到最大值，则取其中最小的温度作为 $T_c(L)$。\n\n您的任务是为以下测试集中的每种情况计算 $T_c(L)$：\n- 情况 1：$L=2$，开放边界条件。\n- 情况 2：$L=2$，周期性边界条件。\n- 情况 3：$L=3$，开放边界条件。\n- 情况 4：$L=3$，周期性边界条件。\n- 情况 5：$L=4$，开放边界条件。\n- 情况 6：$L=4$，周期性边界条件。\n\n所有结果必须以 $J/k_{\\mathrm{B}}$ 为单位表示，并四舍五入到 $3$ 位小数。您的程序应生成单行输出，其中包含一个逗号分隔的列表，该列表用方括号括起，并按情况 $1$ 到 $6$ 的顺序列出结果（例如 $[x_1,x_2,x_3,x_4,x_5,x_6]$），其中每个 $x_i$ 都是一个符合上述规范的浮点数。", "solution": "问题陈述已经过严格验证。该问题被认定为具有科学依据、问题明确且客观。它植根于统计力学的标准框架，特别是作为该领域基石的二维伊辛模型。所有参数、定义和程序都得到了足够清晰和精确的说明，从而能够得到一个唯一的、可验证的解。因此，该问题被认为是有效的，适合采用直接计算的方法求解。\n\n任务是计算 $L \\times L$ 晶格上铁磁二维伊辛模型的有限尺寸伪临界温度 $T_c(L)$。该温度被定义为在指定的离散集合 $\\mathcal{T}$ 内，使零场单位自旋磁化率 $\\chi(T,L)$ 达到最大值的点。\n\n指定的系统尺寸（$L=2, 3, 4$）很小，使得该问题可以通过精确枚举来解决。可能的自旋构型（或称微观态）总数为 $2^N$，其中 $N=L^2$。对于最大的系统 $L=4$，总状态数为 $2^{16} = 65536$，这个数量在计算上是微不足道的。\n\n系统化的求解方法如下：\n\n首先，对于由系统尺寸 $L$ 和边界条件类型（开放或周期性）定义的每种情况，我们将构建精确的态密度，记为 $g(E, M)$。该函数计算具有特定总能量 $E$ 和特定总磁化强度 $M$ 的不同自旋构型 $\\{\\text{s}\\}$ 的数量。能量由采用无量纲单位 $J=1$ 的哈密顿量计算：\n$$ E = \\mathcal{H}(\\{s\\}) = -\\sum_{\\langle i,j \\rangle} s_i s_j $$\n磁化强度是所有自旋的总和：\n$$ M = \\sum_{i=1}^{N} s_i $$\n通过系统地遍历所有 $2^N$ 种可能的构型，计算每个构型的 $(E,M)$，并对相应的计数器加一，从而计算出态密度。\n\n其次，在确定了态密度 $g(E,M)$ 之后，我们就可以高效地计算出在任意温度 $T$ 下所需的热力学量。配分函数 $Z(T,L)$ 由对所有唯一的能量和磁化强度对的求和给出：\n$$ Z(T,L) = \\sum_{E, M} g(E,M) \\exp\\left(-\\frac{E}{T}\\right) $$\n在这里，我们使用了玻尔兹曼常数 $k_{\\mathrm{B}}=1$ 的无量纲设定。\n\n第三，我们计算单位自旋磁化率 $\\chi(T,L)$。通用定义为：\n$$ \\chi(T,L) = \\frac{1}{T N} \\left( \\langle M^2 \\rangle_{T,L} - \\langle M \\rangle_{T,L}^2 \\right) $$\n由于在零外磁场中哈密顿量具有自旋翻转对称性，对于任何有限系统，在非零温度下，平均磁化强度 $\\langle M \\rangle_{T,L}$ 恒为零。因此，磁化率的表达式简化为：\n$$ \\chi(T,L) = \\frac{1}{T N} \\langle M^2 \\rangle_{T,L} $$\n磁化强度平方的热力学平均值 $\\langle M^2 \\rangle_{T,L}$ 计算如下：\n$$ \\langle M^2 \\rangle_{T,L} = \\frac{1}{Z(T,L)} \\sum_{E, M} g(E,M) M^2 \\exp\\left(-\\frac{E}{T}\\right) $$\n\n最后，为了确定 $T_c(L)$，我们对给定离散集合 $\\mathcal{T} = \\{T \\mid T=1.00+0.02n, n \\in \\{0, 1, \\dots, 150\\}\\}$ 中的每个温度 $T$ 计算 $\\chi(T,L)$。$T_c(L)$ 的值是使 $\\chi(T,L)$ 达到最大值时的温度。问题指定，如果出现平局（即多个温度对应同一个最大磁化率），则选择产生最大磁化率的最小温度。为严格遵守此规则，我们按升序遍历温度，并且仅当发现一个严格更大的 $\\chi$ 值时，才更新 $T_c(L)$ 的候选值。\n\n对六个测试案例中的每一个都执行此完整算法，以生成所需的结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom collections import defaultdict\n\ndef get_dos(L, boundary_type):\n    \"\"\"\n    Computes the exact density of states g(E, M) for an L x L Ising lattice.\n\n    Args:\n        L (int): The linear size of the lattice.\n        boundary_type (str): 'obc' for open or 'pbc' for periodic boundaries.\n\n    Returns:\n        defaultdict: A dictionary mapping (energy, magnetization) tuples to counts.\n    \"\"\"\n    N = L * L\n    dos = defaultdict(int)\n\n    # Iterate through all 2^N possible spin configurations.\n    # Each integer 'i' from 0 to 2^N - 1 represents a unique configuration.\n    for i in range(2**N):\n        # Generate the spin configuration from the integer 'i'.\n        # Bit 'j' of 'i' corresponds to spin s_j. 0 -> -1, 1 -> +1.\n        spins = np.array([2 * ((i >> j) & 1) - 1 for j in range(N)])\n        \n        energy = 0\n        # Calculate energy by summing over nearest-neighbor interactions.\n        # To avoid double counting, we only sum interactions with 'right'\n        # and 'down' neighbors for each spin.\n        for idx in range(N):\n            s_i = spins[idx]\n            y, x = divmod(idx, L)\n\n            # Interaction with the right neighbor\n            if boundary_type == 'pbc':\n                idx_right = y * L + (x + 1) % L\n                energy -= s_i * spins[idx_right]\n            elif x < L - 1: # OBC\n                idx_right = y * L + x + 1\n                energy -= s_i * spins[idx_right]\n\n            # Interaction with the down neighbor\n            if boundary_type == 'pbc':\n                idx_down = ((y + 1) % L) * L + x\n                energy -= s_i * spins[idx_down]\n            elif y < L - 1: # OBC\n                idx_down = (y + 1) * L + x\n                energy -= s_i * spins[idx_down]\n\n        magnetization = np.sum(spins)\n        dos[(energy, magnetization)] += 1\n    \n    return dos\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    test_cases = [\n        (2, 'obc'), (2, 'pbc'),\n        (3, 'obc'), (3, 'pbc'),\n        (4, 'obc'), (4, 'pbc'),\n    ]\n\n    # Define the discrete set of temperatures according to the problem statement.\n    # T = 1.00 + 0.02*n for n from 0 to 150.\n    temperatures = np.linspace(1.0, 1.00 + 0.02 * 150, 151)\n    \n    final_results = []\n\n    for L, bc in test_cases:\n        N = L * L\n        dos = get_dos(L, bc)\n        \n        max_chi = -1.0\n        tc = -1.0\n        \n        for T in temperatures:\n            # Using dimensionless units J=1, k_B=1.\n            Z = 0.0       # Partition function\n            M2_sum = 0.0  # Sum for <M^2> numerator\n            \n            # Sum over the density of states to compute Z and <M^2>\n            for (energy, mag), count in dos.items():\n                boltzmann_factor = np.exp(-energy / T)\n                Z += count * boltzmann_factor\n                M2_sum += count * mag**2 * boltzmann_factor\n            \n            # Avoid division by zero, although not expected here for T > 0.\n            if Z > 0:\n                avg_M2 = M2_sum / Z\n            else:\n                avg_M2 = 0\n            \n            # Susceptibility per spin: chi = (1/(T*N)) * (<M^2> - <M>^2)\n            # In zero field, <M> = 0.\n            chi = avg_M2 / (T * N)\n            \n            # Find T that maximizes chi.\n            # If chi == max_chi, keep the existing tc since it's smaller.\n            # This handles the tie-breaking rule.\n            if chi > max_chi:\n                max_chi = chi\n                tc = T\n\n        # Format result to 3 decimal places as specified.\n        # This ensures outputs like 2.4 are printed as 2.400.\n        final_results.append(f\"{tc:.3f}\")\n\n    # Print the final list of results in the required format.\n    print(f\"[{','.join(final_results)}]\")\n\nsolve()\n```", "id": "2394487"}, {"introduction": "通过计算或模拟，我们得到了一系列依赖于系统尺寸 $L$ 的伪临界温度 $T_c(L)$。下一步的关键便是如何利用这些有限尺寸的数据来推断宏观系统（$L \\to \\infty$）的真实物理行为。本练习将指导你应用一个标准的有限尺寸标度公式，通过两个不同尺寸下的数据点来外推出热力学极限下的真实临界温度 $T_c(\\infty)$，这是一个将原始数据转化为精确物理预测的核心技能。[@problem_id:1901306]", "problem": "在一个研究二维伊辛模型相变的计算物理学项目中，一名学生在大的 $L \\times L$ 方形晶格上模拟了该系统。温度 $T$ 以 $J/k_B$ 为单位进行测量，其中 $J$ 是铁磁耦合常数，$k_B$ 是玻尔兹曼常数。该学生测定了不同晶格尺寸 $L$ 下的赝临界温度 $T_c(L)$，该值是在热力学极限 ($L \\to \\infty$) 下真实临界温度 $T_c(\\infty)$ 的一个估计值。\n\n有限尺寸标度的理论研究表明，对于大的 $L$，赝临界温度与其无限大系统的值的偏差遵循以下关系：\n$$T_c(L) = T_c(\\infty) - C L^{-x}$$\n其中 $C$ 是一个取决于模拟细节的正常数，$x$ 是一个普适临界指数。对于二维伊辛模型，已知该指数为 $x=1$。\n\n该学生的模拟得到了以下两个针对大晶格的高精度测量值：\n- 对于尺寸为 $L_1 = 64$ 的晶格，测得的温度为 $T_c(L_1) = 2.2595$。\n- 对于尺寸为 $L_2 = 128$ 的晶格，测得的温度为 $T_c(L_2) = 2.2643$。\n\n使用这两个数据点和给定的标度关系，确定真实临界温度 $T_c(\\infty)$ 的值。以 $J/k_B$ 为单位，用数值形式给出答案，并保留五位有效数字。", "solution": "问题要求我们使用两个数据点 $(L_1, T_c(L_1))$ 和 $(L_2, T_c(L_2))$ 以及提供的有限尺寸标度关系来求出真实临界温度 $T_c(\\infty)$。二维伊辛模型的标度关系通过设置指数 $x=1$ 给出：\n$$T_c(L) = T_c(\\infty) - C L^{-1}$$\n我们有两个未知数，即真实临界温度 $T_c(\\infty)$ 和常数 $C$。我们可以利用给定的两个数据点写出两个方程。\n\n对于第一个数据点 ($L_1 = 64$，$T_c(L_1) = 2.2595$)：\n$$2.2595 = T_c(\\infty) - \\frac{C}{64} \\quad (1)$$\n\n对于第二个数据点 ($L_2 = 128$，$T_c(L_2) = 2.2643$)：\n$$2.2643 = T_c(\\infty) - \\frac{C}{128} \\quad (2)$$\n\n我们得到了一个包含两个变量 $T_c(\\infty)$ 和 $C$ 的二元线性方程组。我们的目标是解出 $T_c(\\infty)$。我们可以先通过消去常数 $C$ 来实现。让我们对两个方程进行变形，以求解 $C$。\n\n由方程(1)可得：\n$$T_c(\\infty) - 2.2595 = \\frac{C}{64}$$\n$$C = 64 \\left( T_c(\\infty) - 2.2595 \\right)$$\n\n由方程(2)可得：\n$$T_c(\\infty) - 2.2643 = \\frac{C}{128}$$\n$$C = 128 \\left( T_c(\\infty) - 2.2643 \\right)$$\n\n现在，我们可以令这两个关于 $C$ 的表达式相等：\n$$64 \\left( T_c(\\infty) - 2.2595 \\right) = 128 \\left( T_c(\\infty) - 2.2643 \\right)$$\n\n我们可以通过将方程两边同时除以64来简化：\n$$1 \\cdot \\left( T_c(\\infty) - 2.2595 \\right) = 2 \\left( T_c(\\infty) - 2.2643 \\right)$$\n\n现在，我们展开并求解 $T_c(\\infty)$：\n$$T_c(\\infty) - 2.2595 = 2 T_c(\\infty) - 2 \\times 2.2643$$\n$$T_c(\\infty) - 2.2595 = 2 T_c(\\infty) - 4.5286$$\n\n整理各项以分离出 $T_c(\\infty)$：\n$$4.5286 - 2.2595 = 2 T_c(\\infty) - T_c(\\infty)$$\n$$T_c(\\infty) = 2.2691$$\n\n这个结果可以更普遍地推导出来。设两个数据点为 $(L_1, T_1)$ 和 $(L_2, T_2)$。\n$$T_1 = T_c(\\infty) - C L_1^{-1}$$\n$$T_2 = T_c(\\infty) - C L_2^{-1}$$\n由此我们得到：\n$$C = L_1 (T_c(\\infty) - T_1)$$\n$$C = L_2 (T_c(\\infty) - T_2)$$\n令二者相等：\n$$L_1 (T_c(\\infty) - T_1) = L_2 (T_c(\\infty) - T_2)$$\n$$L_1 T_c(\\infty) - L_1 T_1 = L_2 T_c(\\infty) - L_2 T_2$$\n$$L_2 T_2 - L_1 T_1 = (L_2 - L_1) T_c(\\infty)$$\n$$T_c(\\infty) = \\frac{L_2 T_2 - L_1 T_1}{L_2 - L_1}$$\n在我们的具体情况下，$L_2 = 2L_1$。将此代入通用公式会得到一个更简单的表达式：\n$$T_c(\\infty) = \\frac{2L_1 T_2 - L_1 T_1}{2L_1 - L_1} = \\frac{L_1(2 T_2 - T_1)}{L_1} = 2 T_2 - T_1$$\n使用给定值 $T_1 = T_c(L_1) = 2.2595$ 和 $T_2 = T_c(L_2) = 2.2643$：\n$$T_c(\\infty) = 2 \\times 2.2643 - 2.2595 = 4.5286 - 2.2595 = 2.2691$$\n\n计算值为 $2.2691$。问题要求答案保留五位有效数字。我们的结果已经是五位有效数字，因此无需进一步舍入。答案的单位为 $J/k_B$。", "answer": "$$\\boxed{2.2691}$$", "id": "1901306"}, {"introduction": "虽然追踪磁化率或比热峰值的位置是确定伪临界温度的常用方法，但这些峰值的位置会随着系统尺寸 $L$ 而系统性地漂移，为精确确定 $T_c$ 带来困难。一个更精确且优雅的方法是使用宾德累积量（Binder cumulant）$U_L$，一个在临界点附近其数值与系统尺寸无关的巧妙构造量。本练习通过一个唯象模型，清晰地展示了如何通过寻找不同尺寸下 $U_L$ 曲线的交点来准确定位临界点，这在现代计算物理研究中是一种非常重要且可靠的技术。[@problem_id:1901331]", "problem": "在计算物理学中研究相变时，有限尺寸标度法是一种关键技术，用于从有限系统的模拟中推断无限系统的性质。此分析中的一个核心工具是 Binder 累积量 $U_L$，它是一个无量纲量，由系统序参量的矩计算得出。对于经历二阶相变的模型，针对不同系统尺寸 $L$，将 $U_L$ 随控制参数（如温度）变化的曲线绘制出来，这些曲线倾向于相交于一个共同点，该点为临界点 $T_c$ 提供了一个稳健的估计。\n\n一位研究人员正在研究一个“网络相干性模型”，在该模型中，网络的全局结构会随着一个无量纲的随机噪声参数 $T$ 的变化而发生相变。通过大量的蒙特卡洛模拟，他们获得了两种不同网络尺寸 $L_1=32$ 和 $L_2=64$ 下 Binder 累积量的唯象表达式如下：\n\n对于尺寸 $L_1=32$：\n$$ U_{32}(T) = 1 - \\frac{\\alpha_1 T}{1 + \\beta_1 T^2} $$\n其中 $\\alpha_1 = 0.50$ 且 $\\beta_1 = 0.10$。\n\n对于尺寸 $L_2=64$：\n$$ U_{64}(T) = 1 - \\frac{\\alpha_2 T}{1 + \\beta_2 T^2} $$\n其中 $\\alpha_2 = 0.60$ 且 $\\beta_2 = 0.15$。\n\n假设这些表达式能准确地模拟系统行为，请通过找到这两条曲线的交点来确定临界噪声参数 $T_c$ 的非零值。将您的 $T_c$ 答案四舍五入到四位有效数字。", "solution": "给定两种尺寸下 Binder 累积量的模型形式为\n$$\nU_{L}(T)=1-\\frac{\\alpha_{L} T}{1+\\beta_{L} T^{2}}.\n$$\n临界噪声参数由 $L_{1}=32$ 和 $L_{2}=64$ 的相交条件获得：\n$$\nU_{32}(T)=U_{64}(T).\n$$\n代入给定形式，\n$$\n1-\\frac{\\alpha_{1} T}{1+\\beta_{1} T^{2}}=1-\\frac{\\alpha_{2} T}{1+\\beta_{2} T^{2}}.\n$$\n两边消去 $1$ 并假设非零解 $T\\neq 0$，再同除以 $T$ 得到\n$$\n\\frac{\\alpha_{1}}{1+\\beta_{1} T^{2}}=\\frac{\\alpha_{2}}{1+\\beta_{2} T^{2}}.\n$$\n交叉相乘并展开得到\n$$\n\\alpha_{1}\\left(1+\\beta_{2} T^{2}\\right)=\\alpha_{2}\\left(1+\\beta_{1} T^{2}\\right),\n$$\n$$\n\\alpha_{1}+\\alpha_{1}\\beta_{2} T^{2}=\\alpha_{2}+\\alpha_{2}\\beta_{1} T^{2}.\n$$\n整理各项，\n$$\nT^{2}\\left(\\alpha_{1}\\beta_{2}-\\alpha_{2}\\beta_{1}\\right)=\\alpha_{2}-\\alpha_{1},\n$$\n所以\n$$\nT^{2}=\\frac{\\alpha_{2}-\\alpha_{1}}{\\alpha_{1}\\beta_{2}-\\alpha_{2}\\beta_{1}}.\n$$\n使用给定参数 $\\alpha_{1}=0.50$，$\\beta_{1}=0.10$，$\\alpha_{2}=0.60$，$\\beta_{2}=0.15$，计算\n$$\n\\alpha_{2}-\\alpha_{1}=0.60-0.50=0.10,\\quad \\alpha_{1}\\beta_{2}-\\alpha_{2}\\beta_{1}=0.50\\cdot 0.15-0.60\\cdot 0.10=0.075-0.060=0.015,\n$$\n因此\n$$\nT^{2}=\\frac{0.10}{0.015}=\\frac{20}{3},\\quad T=\\sqrt{\\frac{20}{3}}.\n$$\n取噪声参数的正非零解，并四舍五入到四位有效数字，得到\n$$\nT_{c}\\approx 2.582.\n$$", "answer": "$$\\boxed{2.582}$$", "id": "1901331"}]}