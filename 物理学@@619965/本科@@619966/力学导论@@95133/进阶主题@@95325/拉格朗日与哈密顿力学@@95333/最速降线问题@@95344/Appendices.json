{"hands_on_practices": [{"introduction": "我们直觉上可能认为，连接两点的最短路径——直线——也是最快的路径。然而，在重力作用下，情况并非如此。这个练习将通过直接计算来检验这一直觉，让你比较一个质点沿直线和沿摆线（即真正的最速降线）下滑所需的时间，从而量化地理解为何摆线路径更优越。[@problem_id:2082385]", "problem": "一位工程师正在为一个质点设计一个无摩擦的滑道。该滑道连接笛卡尔坐标系的原点 $P_1 = (0, 0)$ 和一个终点 $P_2 = (L, -H)$。y轴竖直向上，重力加速度为常数 $g$，方向竖直向下。质点从 $P_1$ 点静止开始下滑。\n\n工程师考虑了两种可能的滑道形状：\n\n1.  **直线：** 连接 $P_1$ 到 $P_2$ 的简单直轨道。\n2.  **摆线弧：** 由参数方程描述的曲线\n    $$x(\\theta) = r(\\theta - \\sin\\theta)$$\n    $$y(\\theta) = -r(1 - \\cos\\theta)$$\n    其中参数 $\\theta$ 从 $\\theta=0$ 开始。常数 $r$ 和最终参数值 $\\theta_f$ 的选择要使曲线通过特定的终点 $P_2 = (L, -H)$，其中 $L = \\frac{\\pi H}{2}$。\n\n你的任务是计算沿每条路径下滑的总时间，分别记为 $T_{line}$ 和 $T_{cycloid}$。确定沿摆线弧的下滑时间与沿直线的下滑时间之比，即 $\\frac{T_{cycloid}}{T_{line}}$。以单一的闭式解析表达式形式给出最终答案。", "solution": "对于一个从高度 $y=0$ 处静止释放的无摩擦质点，我们使用机械能守恒。在纵坐标为 $y\\le 0$ 的某点，其速度由以下公式确定：\n$$\n\\frac{1}{2} m v^{2} = m g (0 - y) \\quad \\Longrightarrow \\quad v(y) = \\sqrt{2 g (-y)}.\n$$\n\n直线路径：\n直轨道连接 $(0,0)$ 和 $(L,-H)$，因此其长度为\n$$\ns = \\sqrt{L^{2} + H^{2}}.\n$$\n设 $\\alpha$ 为轨道的倾角，则 $\\sin\\alpha = \\frac{H}{s}$。沿轨道的加速度分量为常数，\n$$\na = g \\sin\\alpha = g \\frac{H}{s}.\n$$\n从静止开始，以恒定加速度 $a$ 运动距离 $s$，所需时间由 $s = \\frac{1}{2} a T_{line}^{2}$ 给出，因此\n$$\nT_{line} = \\sqrt{\\frac{2 s}{a}} = \\sqrt{\\frac{2 s}{g H / s}} = s \\sqrt{\\frac{2}{g H}}.\n$$\n当 $L = \\frac{\\pi H}{2}$ 时，我们有 $s = \\sqrt{H^{2} + \\left(\\frac{\\pi H}{2}\\right)^{2}} = H \\sqrt{1 + \\frac{\\pi^{2}}{4}}$，所以\n$$\nT_{line} = \\sqrt{\\frac{2}{g}}\\,\\sqrt{H}\\,\\sqrt{1 + \\frac{\\pi^{2}}{4}}.\n$$\n\n摆线弧路径：\n摆线由 $x(\\theta) = r(\\theta - \\sin\\theta)$，$y(\\theta) = -r(1 - \\cos\\theta)$ 给出，其中 $\\theta$ 从 $0$ 开始。应用终点条件 $x(\\theta_{f}) = L$ 和 $y(\\theta_{f}) = -H$：\n$$\nr\\bigl(1 - \\cos\\theta_{f}\\bigr) = H, \n\\quad\nr\\bigl(\\theta_{f} - \\sin\\theta_{f}\\bigr) = L = \\frac{\\pi H}{2}.\n$$\n使用 $r = \\frac{H}{1 - \\cos\\theta_{f}}$ 消去 $r$ 得到\n$$\n\\frac{\\theta_{f} - \\sin\\theta_{f}}{1 - \\cos\\theta_{f}} = \\frac{\\pi}{2}.\n$$\n当 $\\theta_{f} = \\pi$ 时，我们有 $\\sin\\pi = 0$ 和 $\\cos\\pi = -1$，代入得\n$$\n\\frac{\\pi - 0}{1 - (-1)} = \\frac{\\pi}{2},\n$$\n所以 $\\theta_{f} = \\pi$，且 $r = \\frac{H}{1 - \\cos\\pi} = \\frac{H}{2}$。\n\n弧长元为\n$$\n\\mathrm{d}s = \\sqrt{\\left(\\frac{\\mathrm{d}x}{\\mathrm{d}\\theta}\\right)^{2} + \\left(\\frac{\\mathrm{d}y}{\\mathrm{d}\\theta}\\right)^{2}}\\,\\mathrm{d}\\theta\n= \\sqrt{r^{2}(1 - \\cos\\theta)^{2} + r^{2}\\sin^{2}\\theta}\\,\\mathrm{d}\\theta\n= r \\sqrt{2 - 2\\cos\\theta}\\,\\mathrm{d}\\theta\n= 2 r \\sin\\!\\left(\\frac{\\theta}{2}\\right)\\mathrm{d}\\theta.\n$$\n另外，\n$$\n-y(\\theta) = r\\bigl(1 - \\cos\\theta\\bigr) = 2 r \\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right),\n$$\n所以根据能量守恒，\n$$\nv(\\theta) = \\sqrt{2 g (-y)} = 2 \\sqrt{g r}\\,\\sin\\!\\left(\\frac{\\theta}{2}\\right).\n$$\n因此时间元为\n$$\n\\mathrm{d}t = \\frac{\\mathrm{d}s}{v} = \\frac{2 r \\sin(\\theta/2)\\,\\mathrm{d}\\theta}{2 \\sqrt{g r}\\,\\sin(\\theta/2)} = \\sqrt{\\frac{r}{g}}\\,\\mathrm{d}\\theta,\n$$\n该式与 $\\theta$ 无关。从 $\\theta=0$ 积分到 $\\theta=\\theta_{f}=\\pi$ 得到\n$$\nT_{cycloid} = \\int_{0}^{\\pi} \\sqrt{\\frac{r}{g}}\\,\\mathrm{d}\\theta = \\pi \\sqrt{\\frac{r}{g}} = \\pi \\sqrt{\\frac{H}{2 g}}.\n$$\n\n比率：\n使用 $T_{line} = \\sqrt{\\frac{2}{g}}\\,\\sqrt{H}\\,\\sqrt{1 + \\frac{\\pi^{2}}{4}}$ 和 $T_{cycloid} = \\pi \\sqrt{\\frac{H}{2 g}}$，\n$$\n\\frac{T_{cycloid}}{T_{line}} = \\frac{\\pi \\sqrt{H/(2 g)}}{\\sqrt{2/g}\\,\\sqrt{H}\\,\\sqrt{1 + \\frac{\\pi^{2}}{4}}}\n= \\frac{\\pi}{2 \\sqrt{1 + \\frac{\\pi^{2}}{4}}}\n= \\frac{\\pi}{\\sqrt{4 + \\pi^{2}}}.\n$$\n这是一个仅依赖于 $\\pi$ 的闭式表达式。", "answer": "$$\\boxed{\\frac{\\pi}{\\sqrt{4+\\pi^{2}}}}$$", "id": "2082385"}, {"introduction": "直接推导最速降线的形状需要用到高深的变分法，但我们可以通过一个更简单、更直观的模型来理解其背后的核心思想。在这个练习中，你将用两段直线来近似连续的曲线，并通过优化中间点的位置来最小化总时间。这个过程能帮助你体会到最速降线为何必须在初始阶段更陡峭，以便尽快获得速度的物理原理。[@problem_id:2217638]", "problem": "一个工程团队正在设计一条重力滑道，用于在仓库的两点之间运输小包裹。作为一个简化模型，他们正在考虑一条由两段相连的直线段组成的路径。滑道始于原点 $(0,0)$。一个包裹从该点静止释放。它无摩擦地沿第一段滑至中间点 $P_1 = (L, -y_1)$，然后沿第二段滑至最终目的地 $P_2 = (2L, -H)$。重力加速度为常数 $g$，$y$ 轴竖直向上。\n\n对于一个测试配置，参数设置为 $y_1 = \\frac{L}{2}$ 和 $H = 2L$。您的任务是计算包裹从原点移动到 $P_2$ 所需的总时间。\n\n请将您的答案表示为 $T = C\\sqrt{\\frac{L}{g}}$ 的形式，并给出无量纲常数 $C$ 的数值，保留四位有效数字。", "solution": "包裹沿两段直线无摩擦地运动，因此在每一段上，切向加速度是恒定的，等于重力沿该段的分量。将这些点记为 $O=(0,0)$，$P_{1}=(L,-y_{1})$ 和 $P_{2}=(2L,-H)$。从 $O$ 到任意点 $y<0$ 的高度下降量为 $-y$，因此根据能量守恒，垂直下落高度 $\\Delta y$ 时的速度为 $v=\\sqrt{2 g \\Delta y}$。\n\n对于沿直线段的匀切向加速运动，如果两端的速度分别为 $v_{A}$ 和 $v_{B}$，段长为 $s$，则根据运动学公式 $v_{B}^{2}-v_{A}^{2}=2 a s$ 和 $v_{B}=v_{A}+a t$ 可推导出\n$$\nt=\\frac{2 s}{v_{A}+v_{B}}。\n$$\n\n第一段 $O \\to P_{1}$：\n- 长度 $s_{1}=\\sqrt{L^{2}+y_{1}^{2}}$。\n- 速度：在 $O$ 点为 $v_{0}=0$，在 $P_{1}$ 点为 $v_{1}=\\sqrt{2 g y_{1}}$（下落高度 $y_{1}$）。\n- 时间\n$$\nt_{1}=\\frac{2 s_{1}}{v_{0}+v_{1}}=\\frac{2 \\sqrt{L^{2}+y_{1}^{2}}}{\\sqrt{2 g y_{1}}}.\n$$\n\n第二段 $P_{1} \\to P_{2}$：\n- 长度 $s_{2}=\\sqrt{L^{2}+(H-y_{1})^{2}}$。\n- 速度：在 $P_{1}$ 点为 $v_{1}=\\sqrt{2 g y_{1}}$，在 $P_{2}$ 点为 $v_{2}=\\sqrt{2 g H}$（从 $O$ 点算起的总下落高度为 $H$）。\n- 时间\n$$\nt_{2}=\\frac{2 s_{2}}{v_{1}+v_{2}}=\\frac{2 \\sqrt{L^{2}+(H-y_{1})^{2}}}{\\sqrt{2 g y_{1}}+\\sqrt{2 g H}}.\n$$\n\n总时间为 $T=t_{1}+t_{2}$。对于给定的配置 $y_{1}=\\frac{L}{2}$ 和 $H=2L$：\n- $s_{1}=\\sqrt{L^{2}+\\left(\\frac{L}{2}\\right)^{2}}=\\frac{\\sqrt{5}}{2}L$,\n- $s_{2}=\\sqrt{L^{2}+\\left(2L-\\frac{L}{2}\\right)^{2}}=\\sqrt{L^{2}+\\left(\\frac{3}{2}L\\right)^{2}}=\\frac{\\sqrt{13}}{2}L$,\n- $v_{1}=\\sqrt{2 g \\cdot \\frac{L}{2}}=\\sqrt{g L}$,\n- $v_{2}=\\sqrt{2 g \\cdot 2 L}=2 \\sqrt{g L}$.\n\n因此\n$$\nt_{1}=\\frac{2 \\cdot \\frac{\\sqrt{5}}{2}L}{\\sqrt{g L}}=\\sqrt{5}\\,\\sqrt{\\frac{L}{g}},\n\\qquad\nt_{2}=\\frac{2 \\cdot \\frac{\\sqrt{13}}{2}L}{\\sqrt{g L}+2 \\sqrt{g L}}=\\frac{\\sqrt{13}}{3}\\,\\sqrt{\\frac{L}{g}}.\n$$\n所以\n$$\nT=\\left(\\sqrt{5}+\\frac{\\sqrt{13}}{3}\\right)\\sqrt{\\frac{L}{g}}.\n$$\n无量纲常数是 $C=\\sqrt{5}+\\frac{\\sqrt{13}}{3}$，其数值保留四位有效数字为 $C=3.438$。", "answer": "$$\\boxed{3.438}$$", "id": "2217638"}, {"introduction": "理论上我们知道最速降线是摆线，但在实际工程应用中，如何确定连接任意起点和终点的那条*具体*摆线呢？这个练习将带你从解析理论走向计算实践。你需要建立确定摆线参数$R$和$\\phi$的超越方程，并利用迭代数值方法求解，这是将物理原理应用于具体问题的关键一步，也是计算物理中的一项基本技能。[@problem_id:2394845]", "problem": "您的任务是计算最速降线 (Brachistochrone curve) 的几何参数，该曲线连接均匀引力场中的两点，并使用不动点迭代法进行计算。根据变分法和经典力学的成熟结论，两点之间的最速降线是一条摆线。将坐标系原点置于初始点的摆线尖点处，水平方向为 $x$ 轴，垂直向上方向为 $y$ 轴。假设小珠从静止状态的 $(x,y)=(0,0)$ 点出发，到达终点 $(x,y)=(X,-Y)$，其中 $X&gt;0$ 且 $Y&gt;0$，单位为米。角度必须使用弧度制。\n\n摆线可以通过半径参数 $R&gt;0$ 和角度参数 $\\phi \\in (0,2\\pi)$ 进行参数化，表示为\n$$\nx(\\phi) = R\\left(\\phi - \\sin \\phi\\right), \\qquad y(\\phi) = -R\\left(1 - \\cos \\phi\\right).\n$$\n将 $(x(\\phi),y(\\phi))$ 与 $(X,-Y)$ 相匹配，得到两个约束条件\n$$\nX = R\\left(\\phi - \\sin \\phi\\right), \\qquad Y = R\\left(1 - \\cos \\phi\\right).\n$$\n消去 $R$ 以获得关于 $\\phi$ 的单个非线性标量方程，并使用不动点迭代法求解。定义 $k = X/Y$ 并推导出一个形式如下的映射\n$$\n\\phi = g(\\phi;k),\n$$\n然后应用松弛不动点迭代\n$$\n\\phi_{n+1} = (1-\\lambda)\\,\\phi_n + \\lambda\\, g(\\phi_n;k),\n$$\n其中松弛参数 $\\lambda \\in (0,1]$。为保证本次作业的数值稳定性，请使用 $\\lambda = 1/2$。为改善收敛性，在分母不为零时，对迭代值应用 Aitken's $\\Delta^2$ 加速法：\n$$\n\\hat{\\phi}_n \\;=\\; \\phi_n \\;-\\; \\frac{\\left(\\phi_{n+1}-\\phi_n\\right)^2}{\\phi_{n+2} - 2\\phi_{n+1} + \\phi_n}.\n$$\n使用以下终止准则：当连续迭代值的变化满足 $\\lvert \\phi_{n+1} - \\phi_n \\rvert \\le 10^{-12}$ 且不动点残差满足 $\\lvert \\phi_n - g(\\phi_n;k)\\rvert \\le 10^{-12}$ 时停止，或者当达到最大迭代次数时停止（选择一个合理的上限，如 $10^5$）。\n\n得到 $\\phi$ 后，计算\n$$\nR = \\frac{Y}{1 - \\cos \\phi},\n$$\n并报告 $(\\phi,R)$，其中 $\\phi$ 的单位是弧度，$R$ 的单位是米。\n\n将上述过程实现为一个完整的、可运行的程序，用于评估以下终点 $(X,Y)$（单位为米）的测试套件：\n- 情况 1：$X = 1.0$, $Y = 1.0$。\n- 情况 2：$X = 2.0$, $Y = 1.0$。\n- 情况 3：$X = 0.5$, $Y = 1.0$。\n- 情况 4：$X = 0.1$, $Y = 1.0$。\n\n对于每种情况，输出一个列表 $[\\phi,R]$，其中 $\\phi$ 的单位是弧度，$R$ 的单位是米。您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，每个元素本身是 $[\\phi,R]$ 形式的列表。例如，两个测试用例的有效输出如下所示\n$[[\\phi_1,R_1],[\\phi_2,R_2]]$\n输出仅占一行，不得包含任何额外文本。", "solution": "在尝试求解之前，需对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **任务**：计算连接 $(0,0)$ 与 $(X, -Y)$（其中 $X > 0$, $Y > 0$）的摆线（最速降线）的参数 $(\\phi, R)$。\n- **参数方程**：$x(\\phi) = R(\\phi - \\sin\\phi)$， $y(\\phi) = -R(1 - \\cos\\phi)$。\n- **约束条件**：$X = R(\\phi - \\sin\\phi)$， $Y = R(1 - \\cos\\phi)$。\n- **方法**：\n    1. 消去 $R$，得到一个关于 $\\phi$ 且以 $k = X/Y$ 表示的非线性方程。\n    2. 构建不动点问题 $\\phi = g(\\phi; k)$。\n    3. 使用松弛不动点迭代求解：$\\phi_{n+1} = (1-\\lambda)\\phi_n + \\lambda g(\\phi_n; k)$，其中 $\\lambda = 1/2$。\n    4. 使用 Aitken's $\\Delta^2$ 方法加速收敛：$\\hat{\\phi}_n = \\phi_n - \\frac{(\\phi_{n+1}-\\phi_n)^2}{\\phi_{n+2} - 2\\phi_{n+1} + \\phi_n}$。\n- **终止准则**：当 $|\\phi_{n+1} - \\phi_n| \\le 10^{-12}$ 且 $|\\phi_n - g(\\phi_n; k)| \\le 10^{-12}$ 时停止，或在最多 $10^5$ 次迭代后停止。\n- **后处理**：计算 $R = Y / (1 - \\cos\\phi)$。\n- **测试用例**：$(X, Y)$ 对为 $(1.0, 1.0)$、$(2.0, 1.0)$、$(0.5, 1.0)$ 和 $(0.1, 1.0)$。\n- **输出格式**：单行输出，包含一个 $[\\phi, R]$ 对的列表，例如 `[[\\phi_1,R_1],[\\phi_2,R_2]]`。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题是物理学和数学中的一个经典问题，涉及最速降线。摆线的参数化和物理设置都是标准且正确的。该问题具有科学合理性。\n2.  **适定性**：推导关于 $\\phi$ 的非线性方程是直接的。根据给定的约束条件，我们得到 $R = Y/(1-\\cos\\phi)$。将其代入 $X$ 的方程得到 $X/Y = k = (\\phi - \\sin\\phi)/(1-\\cos\\phi)$。函数 $f(\\phi) = (\\phi - \\sin\\phi)/(1-\\cos\\phi)$ 在区间 $\\phi \\in (0, 2\\pi)$ 上严格单调递增，映射范围从 $0$ 到 $\\infty$。因此，对于任何正数 $k$，在此区间内存在唯一的 $\\phi$ 解。该问题是适定的。\n3.  **客观性**：问题陈述使用了精确、客观的数学语言。\n4.  **不完整或矛盾的设置**：问题没有为迭代求解器指定初始猜测值。这是一个小小的疏漏。在这种情况下，标准做法是根据对问题领域的理解来选择一个合理的起始点。选择如 $\\phi_0 = \\pi$ 这样的值，它位于解空间 $(0, 2\\pi)$ 的中间，是一个稳健的起始点。这并不会使问题无效。\n5.  **不适定或结构不良**：问题结构良好。松弛迭代与 Aitken 加速法（共同构成 Steffensen 方法）的结合是一种强大且定义明确的数值技术，用于解决此类不动点问题。\n\n### 步骤 3：结论与行动\n问题被判定为**有效**。这是一个来自计算物理领域的适定的、有科学依据的问题，可以使用指定的数值方法求解。\n\n---\n\n### 解题推导\n\n分析从定义终点 $(X, -Y)$ 的两个方程开始：\n$$\nX = R(\\phi - \\sin\\phi) \\quad (1)\n$$\n$$\nY = R(1 - \\cos\\phi) \\quad (2)\n$$\n对于 $Y>0$ 和 $\\phi \\in (0, 2\\pi)$，项 $(1 - \\cos\\phi)$ 严格为正。因此，我们可以从方程 $(2)$ 中解出半径参数 $R$：\n$$\nR = \\frac{Y}{1 - \\cos\\phi}\n$$\n将此 $R$ 的表达式代入方程 $(1)$，消去半径参数：\n$$\nX = \\left(\\frac{Y}{1 - \\cos\\phi}\\right)(\\phi - \\sin\\phi)\n$$\n引入指定的常数 $k = X/Y$，我们得到一个关于角度 $\\phi$ 的单一超越方程：\n$$\nk = \\frac{\\phi - \\sin\\phi}{1 - \\cos\\phi}\n$$\n为按要求使用不动点迭代法求解此方程，我们将其重排为 $\\phi = g(\\phi; k)$ 的形式：\n$$\nk(1 - \\cos\\phi) = \\phi - \\sin\\phi \\implies \\phi = \\sin\\phi + k(1 - \\cos\\phi)\n$$\n这定义了不动点映射函数：\n$$\ng(\\phi; k) = \\sin\\phi + k(1 - \\cos\\phi)\n$$\n问题要求使用松弛不动点迭代，松弛参数为 $\\lambda = 1/2$。迭代函数（我们记为 $G(\\phi)$）是：\n$$\nG(\\phi; k) = (1 - \\lambda)\\phi + \\lambda g(\\phi; k) = \\frac{1}{2}\\phi + \\frac{1}{2}\\left(\\sin\\phi + k(1 - \\cos\\phi)\\right)\n$$\n为了加速收敛，问题指定对由 $G(\\phi; k)$ 生成的迭代序列 $\\{\\phi_n\\}$ 应用 Aitken's $\\Delta^2$ 公式。该公式为：\n$$\n\\hat{\\phi}_n = \\phi_n - \\frac{(\\phi_{n+1}-\\phi_n)^2}{\\phi_{n+2} - 2\\phi_{n+1} + \\phi_n}\n$$\n其中 $\\phi_{n+1} = G(\\phi_n; k)$ 且 $\\phi_{n+2} = G(\\phi_{n+1}; k)$。在迭代的每一步应用此变换被称为 Steffensen 方法。该序列的更新规则变为：\n$$\n\\phi_{n+1} = \\phi_n - \\frac{(G(\\phi_n; k) - \\phi_n)^2}{G(G(\\phi_n; k); k) - 2G(\\phi_n; k) + \\phi_n}\n$$\n该方法通常提供二次收敛。实现需要一个初始猜测值 $\\phi_0$。选择 $\\phi_0 = \\pi$ 作为一个稳健的起始点，因为它位于有效定义域 $(0, 2\\pi)$ 的中心。\n\n迭代过程持续进行，直到满足以下两个条件（容差 $\\tau = 10^{-12}$）：\n1.  连续迭代值之间的变化量足够小：$|\\phi_{n+1} - \\phi_n| \\le \\tau$。\n2.  新迭代值处原始不动点方程的残差也足够小：$|\\phi_{n+1} - g(\\phi_{n+1}; k)| \\le \\tau$。第二个条件验证了计算出的解确实是原始问题的一个高质量不动点。\n\n如果 Steffensen 公式中的分母趋近于零，则回退到单步非加速的松弛迭代 $\\phi_{n+1} = G(\\phi_n; k)$，以保持数值稳定性。一旦找到足够精确的 $\\phi$ 值，就使用 $R = Y / (1 - \\cos\\phi)$ 计算半径 $R$。此过程将应用于每个测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the geometric parameters of the Brachistochrone curve for a given\n    set of terminal points using a relaxed, accelerated fixed-point iteration.\n    \"\"\"\n\n    def find_phi_R(X, Y, lambda_val=0.5, tol=1e-12, max_iter=100000):\n        \"\"\"\n        Solves for the cycloid parameters phi and R using Steffensen's method\n        applied to a relaxed fixed-point iteration.\n\n        Args:\n            X (float): The horizontal coordinate of the terminal point.\n            Y (float): The magnitude of the vertical coordinate of the terminal point.\n            lambda_val (float): The relaxation parameter for the iteration.\n            tol (float): The convergence tolerance.\n            max_iter (int): The maximum number of iterations.\n\n        Returns:\n            list: A list containing the computed angle phi (radians) and radius R (meters).\n        \"\"\"\n        k = X / Y\n\n        # The original fixed-point mapping function g(phi)\n        def g(p, k_val):\n            return np.sin(p) + k_val * (1.0 - np.cos(p))\n\n        # The relaxed iteration function G(phi)\n        def G(p, k_val):\n            return (1.0 - lambda_val) * p + lambda_val * g(p, k_val)\n\n        # Initial guess for phi\n        phi = np.pi\n\n        for _ in range(max_iter):\n            phi_old = phi\n\n            # Steffensen's method step:\n            # phi_next = phi_old - (G(phi_old)-phi_old)^2 / (G(G(phi_old)) - 2*G(phi_old) + phi_old)\n            p0 = phi_old\n            p1 = G(p0, k)\n            p2 = G(p1, k)\n            \n            denominator = p2 - 2.0 * p1 + p0\n\n            # Fallback to simple relaxed iteration if denominator is too small\n            if abs(denominator) < 1e-16:\n                phi = p1\n            else:\n                phi = p0 - (p1 - p0)**2 / denominator\n\n            # Termination criteria\n            # 1. Change in successive iterates\n            err_step = abs(phi - phi_old)\n            # 2. Fixed-point residual at the new iterate\n            err_res = abs(phi - g(phi, k))\n            \n            if err_step <= tol and err_res <= tol:\n                R = Y / (1.0 - np.cos(phi))\n                return [phi, R]\n        \n        raise RuntimeError(f\"Failed to converge for (X, Y) = ({X}, {Y})\")\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 1.0),  # Case 1\n        (2.0, 1.0),  # Case 2\n        (0.5, 1.0),  # Case 3\n        (0.1, 1.0),  # Case 4\n    ]\n\n    results = []\n    for X_val, Y_val in test_cases:\n        result = find_phi_R(X_val, Y_val)\n        results.append(result)\n\n    # Format the final output string as specified\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n\nsolve()\n```", "id": "2394845"}]}