{"hands_on_practices": [{"introduction": "在经验赝势方法中，晶体的周期性势可以展开为一系列傅里叶分量。然而，并非所有傅里叶分量都对势有贡献，晶体的几何结构起到了“选择定则”的作用。本练习将通过计算面心立方（FCC）晶格的几何结构因子 $S(\\vec{G})$，来揭示这一基本原理，帮助你理解为什么在实际计算中我们只需要考虑特定的倒格矢。", "problem": "在经验赝势方法中，晶体的弱周期性势 $V(\\vec{r})$ 通常表示为关于倒格矢 $\\vec{G}$ 的傅里叶级数。对于只含一种原子的简单晶体，傅里叶系数 $V(\\vec{G})$ 可以写成晶体的几何结构因子 $S(\\vec{G})$ 和原子形状因子 $V_{atom}(\\vec{G})$ 的乘积。结构因子仅取决于晶胞内原子的排布，并决定了哪些傅里叶分量可以为非零值。\n\n对于一个晶体，其晶胞基元由 $N$ 个位于 $\\vec{r}_j$（其中 $j=1, ..., N$）的原子构成，其结构因子由下式给出：\n$$S(\\vec{G}) = \\sum_{j=1}^{N} \\exp(-i \\vec{G} \\cdot \\vec{r}_j)$$\n考虑一个单原子面心立方（FCC）晶体。其晶格常数为 $a$ 的常规立方晶胞包含四个原子。我们可以选择这四个原子的基矢为：\n$\\vec{r}_1 = (0, 0, 0)$\n$\\vec{r}_2 = a(\\frac{1}{2}, \\frac{1}{2}, 0)$\n$\\vec{r}_3 = a(\\frac{1}{2}, 0, \\frac{1}{2})$\n$\\vec{r}_4 = a(0, \\frac{1}{2}, \\frac{1}{2})$\n\n对于可从中导出FCC晶格的简单立方晶格，一个通用的倒格矢由 $\\vec{G} = \\frac{2\\pi}{a}(h\\hat{x} + k\\hat{y} + l\\hat{z})$ 给出，其中 $h, k, l$ 是称为米勒指数的整数。FCC 晶体所允许的倒格矢是这些矢量的一个子集，由条件 $S(\\vec{G}) \\neq 0$ 确定。\n\n关于米勒指数 $(h, k, l)$ 的下列哪个条件正确地指出了所有使单原子 FCC 晶体的结构因子 $S(\\vec{G})$ 非零的倒格矢？\n\nA. 指数 $h, k, l$ 全为偶数或全为奇数。\n\nB. 指数之和 $h+k+l$ 是一个偶数。\n\nC. 指数 $h, k, l$ 全为偶数。\n\nD. 指数之和 $h+k+l$ 是一个奇数。\n\nE. 指数 $h, k, l$ 可以是任何整数集合，只要不全为零。", "solution": "我们从 FCC 晶体常规立方晶胞中四个原子（位于位置 $\\vec{r}_{j}$）的结构因子定义出发：\n$$\nS(\\vec{G})=\\sum_{j=1}^{4}\\exp\\big(-i\\,\\vec{G}\\cdot\\vec{r}_{j}\\big).\n$$\n对于单原子 FCC 晶体，选择基元为\n$$\n\\vec{r}_{1}=(0,0,0),\\quad \\vec{r}_{2}=a\\left(\\frac{1}{2},\\frac{1}{2},0\\right),\\quad \\vec{r}_{3}=a\\left(\\frac{1}{2},0,\\frac{1}{2}\\right),\\quad \\vec{r}_{4}=a\\left(0,\\frac{1}{2},\\frac{1}{2}\\right),\n$$\n以及简单立方晶格的一个通用倒格矢\n$$\n\\vec{G}=\\frac{2\\pi}{a}\\left(h\\hat{x}+k\\hat{y}+l\\hat{z}\\right),\n$$\n其中 $h,k,l\\in\\mathbb{Z}$。FCC 晶格所允许的倒格矢是那些满足 $S(\\vec{G})\\neq 0$ 的矢量。\n\n计算每个相位 $\\vec{G}\\cdot\\vec{r}_{j}$：\n- 对于 $\\vec{r}_{1}$，\n$$\n\\vec{G}\\cdot\\vec{r}_{1}=0.\n$$\n- 对于 $\\vec{r}_{2}$，\n$$\n\\vec{G}\\cdot\\vec{r}_{2}=\\frac{2\\pi}{a}(h,k,l)\\cdot a\\left(\\frac{1}{2},\\frac{1}{2},0\\right)=2\\pi\\left(\\frac{h}{2}+\\frac{k}{2}\\right)=\\pi(h+k).\n$$\n- 对于 $\\vec{r}_{3}$，\n$$\n\\vec{G}\\cdot\\vec{r}_{3}=\\frac{2\\pi}{a}(h,k,l)\\cdot a\\left(\\frac{1}{2},0,\\frac{1}{2}\\right)=2\\pi\\left(\\frac{h}{2}+\\frac{l}{2}\\right)=\\pi(h+l).\n$$\n- 对于 $\\vec{r}_{4}$，\n$$\n\\vec{G}\\cdot\\vec{r}_{4}=\\frac{2\\pi}{a}(h,k,l)\\cdot a\\left(0,\\frac{1}{2},\\frac{1}{2}\\right)=2\\pi\\left(\\frac{k}{2}+\\frac{l}{2}\\right)=\\pi(k+l).\n$$\n\n因此\n$$\nS(\\vec{G})=1+\\exp\\big(-i\\pi(h+k)\\big)+\\exp\\big(-i\\pi(h+l)\\big)+\\exp\\big(-i\\pi(k+l)\\big).\n$$\n对于任意整数 $n$，使用 $\\exp(-i\\pi n)=(-1)^{n}$，我们得到\n$$\nS(\\vec{G})=1+(-1)^{h+k}+(-1)^{h+l}+(-1)^{k+l}.\n$$\n\n现在根据 $h,k,l$ 的奇偶性进行分析：\n- 如果 $h,k,l$ 全为偶数，那么 $h+k$、$h+l$ 和 $k+l$ 均为偶数，因此每个 $(-1)^{\\text{偶数}}=1$，得到\n$$\nS(\\vec{G})=1+1+1+1=4\\neq 0.\n$$\n- 如果 $h,k,l$ 全为奇数，那么 $h+k$、$h+l$ 和 $k+l$ 均为偶数，同样得到\n$$\nS(\\vec{G})=1+1+1+1=4\\neq 0.\n$$\n- 如果奇偶性混合（不全为偶数也不全为奇数），那么 $h,k,l$ 中恰好有一个的奇偶性与其他两个不同。在这种情况下，$h+k$、$h+l$、$k+l$ 中有两个是奇数，一个是偶数，所以\n$$\nS(\\vec{G})=1+(-1)+(-1)+1=0.\n$$\n\n因此，$S(\\vec{G})\\neq 0$ 当且仅当 $h,k,l$ 全为偶数或全为奇数。这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "1814779"}, {"introduction": "我们已经知道晶体结构决定了哪些赝势分量 $V(\\vec{G})$ 不为零，那么这些分量具体会产生什么物理效应呢？这个练习将通过一个简化的双平面波模型，清晰地展示晶体势如何在布里渊区边界处打开能隙，这是半导体带隙形成的物理根源。你将亲自推导出 X 点的能隙大小与赝势形式因子 $V_{200}$ 的直接关系，从而深刻理解理论参数与物理可观测量之间的联系。", "problem": "考虑一个具有面心立方（FCC）晶格结构的晶体，其晶格常数记为 $a$。导电电子与离子晶格之间的相互作用由一个弱周期性赝势 $V(\\mathbf{r})$ 来近似。我们将在近自由电子模型的框架内分析其电子能带结构。\n\n我们关心的是第一布里渊区 X 点的电子态，该点位于波矢 $\\mathbf{k}_X = (2\\pi/a, 0, 0)$ 处。在布里渊区边界上的这个特定点，自由电子能级的简并性被势场所解除，从而产生一个能带隙。\n\n为了计算这个带隙，我们采用一个简化的双平面波模型。该模型只考虑在没有势场的情况下，在 $\\mathbf{k}_X$ 点能量简并的两个平面波态。对于这个特定的面心立方晶体，唯一相关的非零赝势形状因子（即势的傅里叶系数 $V_\\mathbf{G}$）被给定为 $V_{111}$ 和 $V_{200}$。它们分别对应于 $\\frac{2\\pi}{a}(1,1,1)$ 和 $\\frac{2\\pi}{a}(2,0,0)$ 类型的倒格矢 $\\mathbf{G}$。假设这些形状因子是实数值。\n\n请确定 X 点处能带隙 $E_g$ 的解析表达式。用给定的符号参数表示你的答案。", "solution": "我们用近自由电子哈密顿量 $H=\\frac{\\hat{p}^{2}}{2m}+V(\\mathbf{r})$ 来描述电子，其中弱周期性赝势展开为 $V(\\mathbf{r})=\\sum_{\\mathbf{G}}V_{\\mathbf{G}}\\exp(i\\mathbf{G}\\cdot\\mathbf{r})$，且形状因子为实数 $V_{\\mathbf{G}}=V_{-\\mathbf{G}}$。在平面波基下，$V_{\\mathbf{G}}$ 将 $|\\mathbf{k}\\rangle$ 与 $|\\mathbf{k}-\\mathbf{G}\\rangle$ 耦合起来。\n\n在面心立方晶体的 X 点，$\\mathbf{k}_{X}=(2\\pi/a,0,0)$。倒格矢 $\\mathbf{G}_{200}=(2\\pi/a)(2,0,0)$ 满足 $\\mathbf{k}_{X}=\\mathbf{G}_{200}/2$，因此两个自由电子平面波 $|\\mathbf{k}_{X}\\rangle$ 和 $|\\mathbf{k}_{X}-\\mathbf{G}_{200}\\rangle$ 是简并的：\n$$\nE_{0}(\\mathbf{k}_{X})=\\frac{\\hbar^{2}|\\mathbf{k}_{X}|^{2}}{2m},\\qquad\nE_{0}(\\mathbf{k}_{X}-\\mathbf{G}_{200})=\\frac{\\hbar^{2}|\\mathbf{k}_{X}-\\mathbf{G}_{200}|^{2}}{2m}.\n$$\n利用 $|\\mathbf{k}_{X}|^{2}=|\\mathbf{G}_{200}/2|^{2}=\\frac{|\\mathbf{G}_{200}|^{2}}{4}$ 和 $|\\mathbf{k}_{X}-\\mathbf{G}_{200}|^{2}=|-\\mathbf{G}_{200}/2|^{2}=\\frac{|\\mathbf{G}_{200}|^{2}}{4}$，我们发现 $E_{0}(\\mathbf{k}_{X})=E_{0}(\\mathbf{k}_{X}-\\mathbf{G}_{200})$。\n\n将问题限制在由 $\\{|\\mathbf{k}_{X}\\rangle,|\\mathbf{k}_{X}-\\mathbf{G}_{200}\\rangle\\}$ 张成的双平面波子空间中，哈密顿量矩阵为\n$$\nH=\n\\begin{pmatrix}\nE_{0} & V_{200} \\\\\nV_{200} & E_{0}\n\\end{pmatrix},\n$$\n其中 $E_{0}=\\frac{\\hbar^{2}|\\mathbf{k}_{X}|^{2}}{2m}$ （加上任何公共的平均势，这部分在计算带隙时会抵消），非对角耦合项是傅里叶分量 $V_{\\mathbf{G}_{200}}\\equiv V_{200}$。非零的 $V_{111}$ 并不直接耦合这两个态，而只对对角线能量产生高阶修正，这在这个双态模型中不影响一阶带隙。\n\n对角化这个 $2\\times 2$ 矩阵得到本征值\n$$\nE_{\\pm}=E_{0}\\pm |V_{200}|,\n$$\n因此 X 点的能带隙为\n$$\nE_{g}=E_{+}-E_{-}=2|V_{200}|.\n$$", "answer": "$$\\boxed{2|V_{200}|}$$", "id": "1814786"}, {"introduction": "在掌握了结构因子和能隙形成的基本原理后，让我们将这些概念综合起来，进行一次更接近真实的计算。本练习是一个动手计算工作坊，你将为一个真实材料（硅）构建一个最小的经验赝势模型。通过编写代码来构造哈密顿量矩阵并计算其能带结构，你将亲身体验如何通过调整赝势参数来改变材料的电子特性，并从“坏”的赝势中学习到什么才是一个“好”的赝势，从而建立起对赝势方法强大功能的直观感受。", "problem": "您将使用一个最小平面波经验赝势模型，为钻石结构的晶体硅构建和评估一个刻意设计存在问题的局域赝势。该晶体使用面心立方布拉菲晶格进行建模，其晶格常数 $a=5.431\\,\\mathrm{\\AA}$，基元包含两个原子，位置分别为 $\\boldsymbol{0}$ 和 $\\boldsymbol{\\tau}=\\frac{a}{4}(1,1,1)$。倒易晶格基矢定义为 $\\boldsymbol{b}_1=\\frac{2\\pi}{a}(0,1,1)$，$\\boldsymbol{b}_2=\\frac{2\\pi}{a}(1,0,1)$ 和 $\\boldsymbol{b}_3=\\frac{2\\pi}{a}(1,1,0)$。考虑一个由倒易晶格矢量 $\\boldsymbol{G}=n_1\\boldsymbol{b}_1+n_2\\boldsymbol{b}_2+n_3\\boldsymbol{b}_3$ 标记的平面波基，其中整数系数 $n_1,n_2,n_3\\in\\{-1,0,1\\}$。\n\n对于一个晶体动量 $\\boldsymbol{k}$，在此基下的哈密顿矩阵为\n$$\nH_{\\boldsymbol{G},\\boldsymbol{G}'}(\\boldsymbol{k})=\\frac{\\hbar^2}{2m_{\\mathrm{e}}}\\,\\lvert \\boldsymbol{k}+\\boldsymbol{G}\\rvert^2\\,\\delta_{\\boldsymbol{G},\\boldsymbol{G}'} + V\\big(\\lvert \\boldsymbol{G}-\\boldsymbol{G}'\\rvert\\big)\\,S\\big(\\boldsymbol{G}-\\boldsymbol{G}'\\big),\n$$\n其中 $\\frac{\\hbar^2}{2m_{\\mathrm{e}}}=3.809981944\\,\\mathrm{eV}\\cdot\\mathrm{\\AA}^2$ 是自由电子前因子，倒易空间中的局域赝势由一个双参数高斯函数指定\n$$\nV(q)=-V_0\\,\\exp\\!\\left[-\\left(\\frac{q}{\\alpha}\\right)^2\\right]\\quad\\text{with}\\quad q=\\lvert \\boldsymbol{G}-\\boldsymbol{G}'\\rvert,\n$$\n而双原子基元的钻石结构结构因子为\n$$\nS(\\boldsymbol{Q})=1+\\exp\\!\\big(i\\,\\boldsymbol{Q}\\cdot\\boldsymbol{\\tau}\\big),\\quad \\boldsymbol{Q}=\\boldsymbol{G}-\\boldsymbol{G}'.\n$$\n所有波矢的单位均为 $\\mathrm{\\AA}^{-1}$，所有能量必须以电子伏特 ($\\mathrm{eV}$) 表示。\n\n设价带数量为 $n_{\\mathrm{val}}=4$（考虑了每个原胞中的两个原子以及自旋简并）。对于给定的 $\\boldsymbol{k}$，设 $H(\\boldsymbol{k})$ 排序后的本征值为 $E_1(\\boldsymbol{k})\\le E_2(\\boldsymbol{k})\\le\\cdots$。在 $\\boldsymbol{k}$ 点的价带顶能量为 $E_{\\mathrm{v}}(\\boldsymbol{k})=E_{n_{\\mathrm{val}}}(\\boldsymbol{k})$，导带底能量为 $E_{\\mathrm{c}}(\\boldsymbol{k})=E_{n_{\\mathrm{val}}+1}(\\boldsymbol{k})$。通过对三个高对称点进行采样来近似计算基本带隙\n$$\n\\Gamma=(0,0,0),\\quad X=\\frac{2\\pi}{a}(0,1,0),\\quad L=\\frac{\\pi}{a}(1,1,1),\n$$\n并定义\n$$\nE_{\\mathrm{v}}^{\\max}=\\max\\big\\{E_{\\mathrm{v}}(\\Gamma),E_{\\mathrm{v}}(X),E_{\\mathrm{v}}(L)\\big\\},\\quad\nE_{\\mathrm{c}}^{\\min}=\\min\\big\\{E_{\\mathrm{c}}(\\Gamma),E_{\\mathrm{c}}(X),E_{\\mathrm{c}}(L)\\big\\},\n$$\n$$\nE_{\\mathrm{g}}=E_{\\mathrm{c}}^{\\min}-E_{\\mathrm{v}}^{\\max}.\n$$\n报告 $E_{\\mathrm{g}}$ 的值，单位为 $\\mathrm{eV}$。\n\n您必须为以下每一组参数 $(V_0,\\alpha)$ 计算 $E_{\\mathrm{g}}$，这些参数共同构成了一个测试套件，用于探测赝势的不同行为：\n- 情况 $1$ (标称强度和范围)：$V_0=60.0\\,\\mathrm{eV}$, $\\alpha=3.0\\,\\mathrm{\\AA}^{-1}$。\n- 情况 $2$ (在倒易空间中范围过短，即大 $q$ 耦合不足)：$V_0=60.0\\,\\mathrm{eV}$, $\\alpha=0.5\\,\\mathrm{\\AA}^{-1}$。\n- 情况 $3$ (整体散射过弱)：$V_0=10.0\\,\\mathrm{eV}$, $\\alpha=3.0\\,\\mathrm{\\AA}^{-1}$。\n- 情况 $4$ (强度过大且范围过长)：$V_0=200.0\\,\\mathrm{eV}$, $\\alpha=5.0\\,\\mathrm{\\AA}^{-1}$。\n- 情况 $5$ (物理上无意义的符号反转)：$V_0=-40.0\\,\\mathrm{eV}$, $\\alpha=3.0\\,\\mathrm{\\AA}^{-1}$。\n\n您的程序必须：\n- 按照规定实现哈密顿量 $H_{\\boldsymbol{G},\\boldsymbol{G}'}(\\boldsymbol{k})$，使用 $n_1,n_2,n_3\\in\\{-1,0,1\\}$ 的平面波基。\n- 使用上述定义为每种情况计算 $E_{\\mathrm{g}}$，并以 $\\mathrm{eV}$ 为单位表示所有能量。\n- 生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，按情况 $1$ 到 $5$ 的顺序排列，每个数字都打印为浮点数值。例如，所需格式的输出如下所示：$[x_1,x_2,x_3,x_4,x_5]$，其中每个 $x_j$ 是情况 $j$ 下的 $E_{\\mathrm{g}}$ 值，单位为 $\\mathrm{eV}$。\n\n所有需要的常数和定义均已在上方给出；不要假定任何额外数据。角度（如有）蕴含在点积中，并且必须以弧度处理。能量必须在所要求的单行输出中以电子伏特（$\\mathrm{eV}$）为单位的浮点数报告。", "solution": "所提供的问题是固体物理学中一个定义明确的计算练习。它要求在经验赝势框架内，使用最小平面波基来计算硅的电子带隙。所有常数、函数形式和计算步骤都已明确提供。该问题科学上合理、自洽且逻辑一致，不包含任何使其无效的缺陷。因此，将提供一个解决方案。\n\n问题的核心是在第一布里渊区的特定高对称点上构建并对角化晶体固体的哈密顿矩阵。步骤如下。\n\n首先，我们建立几何框架。该晶体具有面心立方布拉菲晶格，晶格常数为 $a = 5.431\\,\\mathrm{\\AA}$。电子波函数在平面波基组中展开。基函数的形式为 $\\exp(i(\\boldsymbol{k}+\\boldsymbol{G})\\cdot\\boldsymbol{r})$，其中 $\\boldsymbol{k}$ 是晶体动量，$\\boldsymbol{G}$ 是倒易晶格矢量。问题通过将倒易晶格矢量 $\\boldsymbol{G}$ 指定为所有线性组合 $\\boldsymbol{G}=n_1\\boldsymbol{b}_1+n_2\\boldsymbol{b}_2+n_3\\boldsymbol{b}_3$（其中 $n_1,n_2,n_3 \\in \\{-1,0,1\\}$）来定义一个有限基组。矢量 $\\boldsymbol{b}_1, \\boldsymbol{b}_2, \\boldsymbol{b}_3$ 定义为 $\\boldsymbol{b}_1=\\frac{2\\pi}{a}(0,1,1)$，$\\boldsymbol{b}_2=\\frac{2\\pi}{a}(1,0,1)$ 和 $\\boldsymbol{b}_3=\\frac{2\\pi}{a}(1,1,0)$。这种构造方法产生了一个包含 $3^3=27$ 个不同 $\\boldsymbol{G}$ 矢量的唯一集合，从而定义了一个 $27 \\times 27$ 的哈密顿矩阵。\n\n对于给定的晶体动量 $\\boldsymbol{k}$，哈密顿矩阵元 $H_{\\boldsymbol{G},\\boldsymbol{G}'}(\\boldsymbol{k})$ 由下式给出：\n$$\nH_{\\boldsymbol{G},\\boldsymbol{G}'}(\\boldsymbol{k})=\\frac{\\hbar^2}{2m_{\\mathrm{e}}}\\,\\lvert \\boldsymbol{k}+\\boldsymbol{G}\\rvert^2\\,\\delta_{\\boldsymbol{G},\\boldsymbol{G}'} + V_{\\text{eff}}(\\boldsymbol{G}-\\boldsymbol{G}')\n$$\n第一项是波矢为 $\\boldsymbol{k}+\\boldsymbol{G}$ 的平面波的动能。该项在平面波基下是对角的。常数给定为 $\\frac{\\hbar^2}{2m_{\\mathrm{e}}}=3.809981944\\,\\mathrm{eV}\\cdot\\mathrm{\\AA}^2$。\n第二项 $V_{\\text{eff}}(\\boldsymbol{Q}) = V(\\lvert\\boldsymbol{Q}\\rvert)S(\\boldsymbol{Q})$（其中 $\\boldsymbol{Q} = \\boldsymbol{G}-\\boldsymbol{G}'$）表示有效晶体势。它是局域赝势形状因子 $V(q)$ 和几何结构因子 $S(\\boldsymbol{Q})$ 的乘积。赝势定义为高斯函数：\n$$\nV(q)=-V_0\\,\\exp\\!\\left[-\\left(\\frac{q}{\\alpha}\\right)^2\\right]\n$$\n其中 $q=\\lvert\\boldsymbol{Q}\\rvert$，而 $(V_0, \\alpha)$ 是待变化的参数。对于基元位于 $\\boldsymbol{0}$ 和 $\\boldsymbol{\\tau}=\\frac{a}{4}(1,1,1)$ 的钻石晶格，其结构因子为：\n$$\nS(\\boldsymbol{Q})=1+\\exp\\!\\big(i\\,\\boldsymbol{Q}\\cdot\\boldsymbol{\\tau}\\big)\n$$\n所指定的 $\\boldsymbol{G}$ 矢量的一个重要性质是，对于任何 $\\boldsymbol{Q}=\\boldsymbol{G}-\\boldsymbol{G}'$，点积 $\\boldsymbol{Q}\\cdot\\boldsymbol{\\tau}$ 都是 $\\pi$ 的整数倍。因此，结构因子 $S(\\boldsymbol{Q})$ 始终是一个实数，其值为 0 或 2。这极大地简化了问题，因为哈密顿矩阵 $H(\\boldsymbol{k})$ 是实对称的，而不仅仅是厄米的。\n\n计算过程是为布里渊区中指定的三个高对称 $\\boldsymbol{k}$ 点（$\\Gamma=(0,0,0)$，$X=\\frac{2\\pi}{a}(0,1,0)$ 和 $L=\\frac{\\pi}{a}(1,1,1)$）分别构建这个 $27 \\times 27$ 矩阵。对于每个矩阵 $H(\\boldsymbol{k})$，我们求解本征值问题 $H(\\boldsymbol{k})\\Psi_n(\\boldsymbol{k})=E_n(\\boldsymbol{k})\\Psi_n(\\boldsymbol{k})$。这通过数值方法对角化矩阵来完成，从而得到 27 个按升序排列的实数本征值 $E_n(\\boldsymbol{k})$。\n\n根据问题描述，价带数量为 $n_{\\mathrm{val}}=4$。因此，在给定 $\\boldsymbol{k}$ 点的价带最高能量为 $E_{\\mathrm{v}}(\\boldsymbol{k})=E_4(\\boldsymbol{k})$，即第四个本征值。导带最低能量为 $E_{\\mathrm{c}}(\\boldsymbol{k})=E_{n_{\\mathrm{val}}+1}(\\boldsymbol{k})=E_5(\\boldsymbol{k})$，即第五个本征值。\n\n为了近似计算基本带隙 $E_{\\mathrm{g}}$，我们在采样的 $\\boldsymbol{k}$ 点上确定价带边的全局最大值 $E_{\\mathrm{v}}^{\\max}$ 和导带边的全局最小值 $E_{\\mathrm{c}}^{\\min}$：\n$$\nE_{\\mathrm{v}}^{\\max}=\\max\\big\\{E_{\\mathrm{v}}(\\Gamma),E_{\\mathrm{v}}(X),E_{\\mathrm{v}}(L)\\big\\}\n$$\n$$\nE_{\\mathrm{c}}^{\\min}=\\min\\big\\{E_{\\mathrm{c}}(\\Gamma),E_{\\mathrm{c}}(X),E_{\\mathrm{c}}(L)\\big\\}\n$$\n那么带隙就是它们的差值：\n$$\nE_{\\mathrm{g}}=E_{\\mathrm{c}}^{\\min}-E_{\\mathrm{v}}^{\\max}\n$$\n整个过程对测试套件中指定的五对赝势参数 $(V_0, \\alpha)$ 中的每一对都重复一遍。得到的五个 $E_{\\mathrm{g}}$ 值构成了最终答案。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport scipy.linalg\n\ndef solve():\n    \"\"\"\n    Constructs and evaluates a pseudopotential model for crystalline Silicon\n    to calculate the electronic band gap for several parameter sets.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        (60.0, 3.0),  # Case 1\n        (60.0, 0.5),  # Case 2\n        (10.0, 3.0),  # Case 3\n        (200.0, 5.0), # Case 4\n        (-40.0, 3.0)  # Case 5\n    ]\n    \n    # --- Physical and geometric constants ---\n    A_LATTICE = 5.431  # Lattice constant in Angstrom\n    HBAR2_OVER_2M = 3.809981944  # hbar^2 / (2*m_e) in eV * Angstrom^2\n    N_VALENCE = 4  # Number of valence bands\n    \n    # Basis vector for the second atom in the primitive cell\n    tau_vec = (A_LATTICE / 4.0) * np.array([1.0, 1.0, 1.0])\n    \n    # Reciprocal lattice primitive vectors as defined in the problem\n    b1 = (2.0 * np.pi / A_LATTICE) * np.array([0.0, 1.0, 1.0])\n    b2 = (2.0 * np.pi / A_LATTICE) * np.array([1.0, 0.0, 1.0])\n    b3 = (2.0 * np.pi / A_LATTICE) * np.array([1.0, 1.0, 0.0])\n    \n    # High-symmetry k-points\n    k_points = {\n        'Gamma': np.array([0.0, 0.0, 0.0]),\n        'X': (2.0 * np.pi / A_LATTICE) * np.array([0.0, 1.0, 0.0]),\n        'L': (np.pi / A_LATTICE) * np.array([1.0, 1.0, 1.0])\n    }\n    \n    # --- Generate the plane-wave basis set {G} ---\n    g_vectors = []\n    n_range = [-1, 0, 1]\n    for n1 in n_range:\n        for n2 in n_range:\n            for n3 in n_range:\n                g = n1 * b1 + n2 * b2 + n3 * b3\n                g_vectors.append(g)\n    \n    g_vectors = np.array(g_vectors)\n    num_g_vectors = len(g_vectors)\n\n    results = []\n    for v0, alpha in test_cases:\n        \n        e_v_max = -np.inf\n        e_c_min = np.inf\n        \n        for k_vec in k_points.values():\n            \n            # --- Construct the Hamiltonian matrix H(k) ---\n            H = np.zeros((num_g_vectors, num_g_vectors), dtype=np.float64)\n            \n            for i in range(num_g_vectors):\n                for j in range(num_g_vectors):\n                    G_i = g_vectors[i]\n                    G_j = g_vectors[j]\n                    Q_vec = G_i - G_j\n                    \n                    # Kinetic energy term (diagonal)\n                    if i == j:\n                        kinetic_energy = HBAR2_OVER_2M * np.linalg.norm(k_vec + G_i)**2\n                        H[i, j] += kinetic_energy\n                    \n                    # Potential energy term (off-diagonal and diagonal)\n                    # Structure Factor S(Q) = 1 + exp(i * Q . tau)\n                    dot_product = np.dot(Q_vec, tau_vec)\n                    # As derived, exp(i*dot_product) is real (+1 or -1) for this problem's basis\n                    s_val = 1.0 + np.cos(dot_product) # Use cos since sin part is zero.\n                    \n                    if abs(s_val) > 1e-9: # Proceed only if structure factor is non-zero\n                        q_mag = np.linalg.norm(Q_vec)\n                        \n                        # Pseudopotential V(q)\n                        v_val = -v0 * np.exp(-(q_mag / alpha)**2)\n                        \n                        H[i, j] += v_val * s_val\n\n            # --- Diagonalize H(k) to get eigenvalues (energy bands) ---\n            # H is real and symmetric, use scipy.linalg.eigh for efficiency and stability\n            eigenvalues = scipy.linalg.eigh(H, eigvals_only=True)\n            \n            # --- Update valence band max and conduction band min ---\n            e_v_k = eigenvalues[N_VALENCE - 1]\n            e_c_k = eigenvalues[N_VALENCE]\n            \n            e_v_max = max(e_v_max, e_v_k)\n            e_c_min = min(e_c_min, e_c_k)\n            \n        # --- Calculate band gap for the current parameter set ---\n        band_gap = e_c_min - e_v_max\n        results.append(band_gap)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```", "id": "2387833"}]}