{"hands_on_practices": [{"introduction": "我们的第一个练习将使用一个高度简化但富有启发性的原子模型。通过将所有电子集中在一个薄球壳上，我们可以解析地推导出原子形状因子，并清晰地看到空间维度（壳层半径 $R$）如何影响倒易空间中的散射模式。这是一个掌握计算方法的基础练习。[@problem_id:1808688]", "problem": "考虑一个假设的、原子序数为 $Z$ 的球对称原子。在这个模型中，原子由一个位于原点的点状原子核和 $Z$ 个电子组成。假定全部电子电荷分布在一个半径为 $R$ 的无限薄球壳上。这种分布由电子数密度 $\\rho(r) = C \\delta(r-R)$ 描述，其中 $r$ 是离原子核的径向距离，$\\delta(x)$ 是狄拉克δ函数，$C$ 是一个归一化常数。首先，通过要求电子数密度在全空间上的积分等于 $Z$ 这一条件，来确定归一化常数 $C$（用 $Z$ 和 $R$ 表示）。\n\n原子形状因子 $f_a(\\mathbf{q})$ 是原子电子密度的傅里叶变换，它决定了原子的X射线散射性质。它的定义为积分：\n$$ f_a(\\mathbf{q}) = \\int \\rho(\\mathbf{r}) \\exp(-i \\mathbf{q} \\cdot \\mathbf{r}) dV $$\n其中 $\\mathbf{q}$ 是散射矢量，积分为全空间积分。由于电子密度的球对称性，形状因子将只依赖于散射矢量的模 $q = |\\mathbf{q}|$。\n\n计算这个假设原子的原子形状因子 $f_a(q)$。将你的最终答案表示为一个以 $Z$、$q$ 和 $R$ 表示的单一闭式解析表达式。", "solution": "给定一个包含 $Z$ 个电子、半径为 $R$ 的壳层的球对称电子数密度为 $\\rho(r) = C \\delta(r - R)$。归一化条件是数密度在全空间上的积分等于 $Z$。在球坐标系中，体积元为 $dV = r^{2} \\sin\\theta \\, dr \\, d\\theta \\, d\\phi$，且密度仅依赖于 $r$，我们有\n$$\n\\int \\rho(\\mathbf{r}) \\, dV \\;=\\; \\int_{0}^{\\infty} \\int_{0}^{\\pi} \\int_{0}^{2\\pi} C \\delta(r - R) \\, r^{2} \\sin\\theta \\, d\\phi \\, d\\theta \\, dr \\;=\\; 4\\pi C \\int_{0}^{\\infty} \\delta(r - R) \\, r^{2} \\, dr \\;=\\; 4\\pi C R^{2}.\n$$\n应用条件 $\\int \\rho \\, dV = Z$ 得到\n$$\n4\\pi C R^{2} = Z \\quad \\Rightarrow \\quad C = \\frac{Z}{4\\pi R^{2}}.\n$$\n\n原子形状因子是电子数密度的傅里叶变换，\n$$\nf_{a}(\\mathbf{q}) \\;=\\; \\int \\rho(\\mathbf{r}) \\exp\\!\\left(-i \\mathbf{q}\\cdot \\mathbf{r}\\right) \\, dV.\n$$\n根据球对称性，$f_{a}$ 只依赖于 $q = |\\mathbf{q}|$。选择 $z$ 轴沿 $\\mathbf{q}$ 方向，这样 $\\mathbf{q}\\cdot \\mathbf{r} = q r \\cos\\theta$。那么\n$$\nf_{a}(q) \\;=\\; \\int_{0}^{\\infty} \\int_{0}^{\\pi} \\int_{0}^{2\\pi} C \\delta(r - R) \\exp\\!\\left(-i q r \\cos\\theta\\right) r^{2} \\sin\\theta \\, d\\phi \\, d\\theta \\, dr.\n$$\n首先计算角向积分。方位角积分给出一个因子 $2\\pi$，并令 $u = \\cos\\theta$，\n$$\n\\int_{0}^{\\pi} \\exp\\!\\left(-i q r \\cos\\theta\\right) \\sin\\theta \\, d\\theta \\;=\\; \\int_{-1}^{1} \\exp(-i q r u) \\, du \\;=\\; \\frac{2 \\sin(q r)}{q r}.\n$$\n因此，\n$$\n\\int \\exp\\!\\left(-i q r \\cos\\theta\\right) \\, d\\Omega \\;=\\; 2\\pi \\cdot \\frac{2 \\sin(q r)}{q r} \\;=\\; 4\\pi \\frac{\\sin(q r)}{q r}.\n$$\n代回原式，\n$$\nf_{a}(q) \\;=\\; C \\int_{0}^{\\infty} \\delta(r - R) \\, r^{2} \\left[ 4\\pi \\frac{\\sin(q r)}{q r} \\right] dr \\;=\\; 4\\pi C \\, \\frac{R^{2} \\sin(q R)}{q R}.\n$$\n使用归一化常数 $C = \\frac{Z}{4\\pi R^{2}}$，我们得到\n$$\nf_{a}(q) \\;=\\; \\frac{Z}{4\\pi R^{2}} \\cdot 4\\pi R^{2} \\cdot \\frac{\\sin(q R)}{q R} \\;=\\; Z \\, \\frac{\\sin(q R)}{q R}.\n$$\n这个结果通过极限 $\\lim_{x \\to 0} \\frac{\\sin x}{x} = 1$ 与归一化条件 $f_{a}(0) = Z$ 相一致。", "answer": "$$\\boxed{Z \\,\\frac{\\sin(q R)}{q R}}$$", "id": "1808688"}, {"introduction": "超越理想化的球壳模型，这个练习将探讨一个更符合物理实际的情景，其中电子密度是平滑且弥散的，由高斯函数描述。计算这种分布的形状因子将揭示傅里叶变换的一个基本性质，并展示一个更弥散的电子云如何影响散射振幅。[@problem_id:1808725]", "problem": "考虑一个原子序数为 $Z$ 的中性原子模型。其 $Z$ 个电子的空间分布由一个球对称的电子数密度 $\\rho(r)$ 描述，其中 $r$ 是到原子核的距离。该密度由以下高斯函数给出：\n$$\n\\rho(r) = C \\exp\\left(-\\frac{r^2}{a^2}\\right)\n$$\n其中 $a$ 是一个具有长度量纲的常数，表征了电子云的大小，而 $C$ 是一个归一化常数。常数 $C$ 的选择必须使得电子数密度在整个空间上的积分等于总电子数 $Z$。\n\n原子形状因子 $f(\\vec{K})$ 描述了X射线从原子电子云散射的散射振幅，其定义为电子密度的傅立叶变换：\n$$\nf(\\vec{K}) = \\int \\rho(\\vec{r}) \\exp(-i\\vec{K}\\cdot\\vec{r}) \\, d^3\\vec{r}\n$$\n其中积分遍及整个空间，$\\vec{r}$ 是从原子核出发的位置矢量，$\\vec{K}$ 是散射矢量。对于球对称密度，形状因子仅取决于散射矢量的大小 $K = |\\vec{K}|$。\n\n求此原子的原子形状因子 $f(K)$。用 $Z$、$K$ 和 $a$ 将你的最终答案表示为解析表达式。", "solution": "求解过程包括两个主要步骤：首先，我们通过确保总电子数为 $Z$ 来确定归一化常数 $C$。其次，我们计算归一化电子密度的傅立叶变换以求得原子形状因子 $f(K)$。\n\n**第1步：电子密度的归一化**\n\n归一化条件要求电子数密度 $\\rho(\\vec{r})$ 在整个空间上的积分等于总电子数 $Z$。\n$$\nZ = \\int_{\\text{all space}} \\rho(\\vec{r}) \\, d^3\\vec{r}\n$$\n由于密度 $\\rho(r)$ 是球对称的，因此在球坐标系中进行此积分最为方便。体积元为 $d^3\\vec{r} = r^2 \\sin\\theta \\, dr \\, d\\theta \\, d\\phi$。\n$$\nZ = \\int_0^\\infty \\int_0^\\pi \\int_0^{2\\pi} C \\exp\\left(-\\frac{r^2}{a^2}\\right) r^2 \\sin\\theta \\, d\\phi \\, d\\theta \\, dr\n$$\n对角度变量 $\\phi$ 和 $\\theta$ 的积分与其他变量无关。\n$$\n\\int_0^{2\\pi} d\\phi = 2\\pi\n$$\n$$\n\\int_0^\\pi \\sin\\theta \\, d\\theta = [-\\cos\\theta]_0^\\pi = -(-1) - (-1) = 2\n$$\n角度积分的乘积为 $4\\pi$。 将此结果代入归一化方程，得到：\n$$\nZ = 4\\pi C \\int_0^\\infty r^2 \\exp\\left(-\\frac{r^2}{a^2}\\right) dr\n$$\n剩下的径向积分是一个标准的高斯积分，形式为 $\\int_0^\\infty x^{2n} \\exp(-bx^2) dx = \\frac{(2n-1)!!}{2^{n+1}} \\sqrt{\\frac{\\pi}{b^{2n+1}}}$。在我们的情况下，$n=1$ 且 $b = 1/a^2$。\n$$\n\\int_0^\\infty r^2 \\exp\\left(-\\frac{r^2}{a^2}\\right) dr = \\frac{1!!}{2^{1+1}} \\sqrt{\\frac{\\pi}{(1/a^2)^{2(1)+1}}} = \\frac{1}{4} \\sqrt{\\pi a^6} = \\frac{\\sqrt{\\pi} a^3}{4}\n$$\n将此结果代回：\n$$\nZ = 4\\pi C \\left(\\frac{\\sqrt{\\pi} a^3}{4}\\right) = C \\pi^{3/2} a^3\n$$\n求解归一化常数 $C$：\n$$\nC = \\frac{Z}{\\pi^{3/2} a^3}\n$$\n因此，归一化的电子密度为：\n$$\n\\rho(r) = \\frac{Z}{\\pi^{3/2} a^3} \\exp\\left(-\\frac{r^2}{a^2}\\right)\n$$\n\n**第2步：原子形状因子的计算**\n\n原子形状因子 $f(\\vec{K})$ 是 $\\rho(\\vec{r})$ 的傅立叶变换：\n$$\nf(\\vec{K}) = \\int \\rho(\\vec{r}) \\exp(-i\\vec{K}\\cdot\\vec{r}) \\, d^3\\vec{r}\n$$\n我们再次在球坐标系中进行计算。由于问题的球对称性，我们可以不失一般性地将坐标系的 $z$ 轴与散射矢量 $\\vec{K}$ 对齐。这样，点积 $\\vec{K} \\cdot \\vec{r}$ 就简化为 $K r \\cos\\theta$，其中 $\\theta$ 是极角。\n$$\nf(K) = \\int_0^\\infty \\int_0^\\pi \\int_0^{2\\pi} \\frac{Z}{\\pi^{3/2} a^3} \\exp\\left(-\\frac{r^2}{a^2}\\right) \\exp(-iKr\\cos\\theta) r^2 \\sin\\theta \\, d\\phi \\, d\\theta \\, dr\n$$\n对 $\\phi$ 的积分得到一个因子 $2\\pi$。\n$$\nf(K) = \\frac{2\\pi Z}{\\pi^{3/2} a^3} \\int_0^\\infty r^2 \\exp\\left(-\\frac{r^2}{a^2}\\right) \\left[ \\int_0^\\pi \\exp(-iKr\\cos\\theta) \\sin\\theta \\, d\\theta \\right] dr\n$$\n我们来计算内部对 $\\theta$ 的积分。我们使用换元法，令 $u = \\cos\\theta$，则 $du = -\\sin\\theta \\, d\\theta$。积分限从 $\\theta \\in [0, \\pi]$ 变为 $u \\in [1, -1]$。\n$$\n\\int_0^\\pi \\exp(-iKr\\cos\\theta) \\sin\\theta \\, d\\theta = \\int_1^{-1} \\exp(-iKru) (-du) = \\int_{-1}^1 \\exp(-iKru) \\, du\n$$\n$$\n= \\left[ \\frac{\\exp(-iKru)}{-iKr} \\right]_{-1}^1 = \\frac{\\exp(-iKr) - \\exp(iKr)}{-iKr}\n$$\n使用欧拉恒等式 $\\sin(x) = \\frac{\\exp(ix) - \\exp(-ix)}{2i}$，我们可以简化此表达式：\n$$\n\\frac{-2i\\sin(Kr)}{-iKr} = \\frac{2\\sin(Kr)}{Kr}\n$$\n将此结果代回 $f(K)$ 的表达式中：\n$$\nf(K) = \\frac{2 Z}{\\sqrt{\\pi} a^3} \\int_0^\\infty r^2 \\exp\\left(-\\frac{r^2}{a^2}\\right) \\left( \\frac{2\\sin(Kr)}{Kr} \\right) dr\n$$\n$$\nf(K) = \\frac{4Z}{K\\sqrt{\\pi} a^3} \\int_0^\\infty r \\sin(Kr) \\exp\\left(-\\frac{r^2}{a^2}\\right) dr\n$$\n剩下的积分是一个已知结果，与高斯函数的傅立叶正弦变换有关。标准积分形式为 $\\int_0^\\infty x \\exp(-bx^2) \\sin(cx) dx = \\frac{c\\sqrt{\\pi}}{4b^{3/2}}\\exp\\left(-\\frac{c^2}{4b}\\right)$。此处，$x=r$，$b=1/a^2$，$c=K$。\n$$\n\\int_0^\\infty r \\sin(Kr) \\exp\\left(-\\frac{r^2}{a^2}\\right) dr = \\frac{K\\sqrt{\\pi}}{4(1/a^2)^{3/2}} \\exp\\left(-\\frac{K^2}{4(1/a^2)}\\right) = \\frac{K\\sqrt{\\pi}a^3}{4} \\exp\\left(-\\frac{K^2 a^2}{4}\\right)\n$$\n最后，我们将此积分结果代入 $f(K)$ 的表达式中：\n$$\nf(K) = \\frac{4Z}{K\\sqrt{\\pi} a^3} \\left[ \\frac{K\\sqrt{\\pi}a^3}{4} \\exp\\left(-\\frac{K^2 a^2}{4}\\right) \\right]\n$$\n前面的系数相互抵消，留下原子形状因子的最终表达式：\n$$\nf(K) = Z \\exp\\left(-\\frac{K^2 a^2}{4}\\right)\n$$\n作为检验，对于前向散射（$K=0$），我们得到 $f(0)=Z$，这是正确的结果，因为所有 $Z$ 个电子都同相散射。", "answer": "$$\\boxed{Z \\exp\\left(-\\frac{K^{2} a^{2}}{4}\\right)}$$", "id": "1808725"}, {"introduction": "我们最后的练习将问题反转过来：给定一个由实验或理论得出的形状因子，其底层的电子分布是怎样的？通过执行傅里叶逆变换，你将巩固对正空间 ($\\rho(r)$) 和倒易空间 ($f(q)$) 之间对偶关系的理解，证明它们是同一枚硬币的两面。[@problem_id:1808733]", "problem": "在对物质进行X射线散射的研究中，原子形状因子 $f(\\vec{q})$ 提供了衡量来自单个原子的散射振幅的尺度。它通过三维傅里叶变换与原子的电子数密度 $\\rho(\\vec{r})$ 相关联：\n$$f(\\vec{q}) = \\int \\rho(\\vec{r}) \\exp(-i \\vec{q} \\cdot \\vec{r}) d^3r$$\n其中 $\\vec{q}$ 是散射矢量，积分遍及整个空间。因此，电子密度可以通过傅里叶逆变换从形状因子中恢复：\n$$\\rho(\\vec{r}) = \\frac{1}{(2\\pi)^3} \\int f(\\vec{q}) \\exp(i \\vec{q} \\cdot \\vec{r}) d^3q$$\n\n考虑一个包含 $Z$ 个电子的球对称原子的理论模型。在此模型中，原子形状因子具有以下形式：\n$$f(q) = \\frac{Z}{1 + a^2 q^2}$$\n其中 $q = |\\vec{q}|$ 是散射矢量的大小，$a$ 是一个具有长度单位的常数，代表电子云的特征屏蔽长度。\n\n求相应的径向电子数密度 $\\rho(r)$，作为径向距离 $r = |\\vec{r}|$ 的函数。请用 $Z$、$a$ 和 $r$ 的符号表达式表示你的答案。", "solution": "我们从给定约定下的傅里叶逆变换开始：\n$$\\rho(\\vec{r})=\\frac{1}{(2\\pi)^{3}}\\int f(\\vec{q})\\exp(i\\vec{q}\\cdot\\vec{r})\\,d^{3}q.$$\n对于球对称的形状因子 $f(\\vec{q})=f(q)$，电子密度仅依赖于 $r=|\\vec{r}|$。选择极轴沿 $\\vec{r}$ 方向，我们有 $\\vec{q}\\cdot\\vec{r}=q r\\cos\\theta$ 和 $d^{3}q=q^{2}\\,dq\\,d\\Omega$，其中角向积分为\n$$\\int \\exp(i q r\\cos\\theta)\\,d\\Omega=2\\pi\\int_{-1}^{1}\\exp(i q r u)\\,du=4\\pi\\frac{\\sin(q r)}{q r}.$$\n因此，\n$$\\rho(r)=\\frac{1}{(2\\pi)^{3}}\\int_{0}^{\\infty} f(q) \\left( 4\\pi q^2 \\frac{\\sin(qr)}{qr} \\right) dq = \\frac{1}{2\\pi^2 r} \\int_0^\\infty q f(q) \\sin(qr) \\,dq.$$\n代入给定的模型 $f(q)=\\frac{Z}{1+a^{2}q^{2}}$，我们得到\n$$\\rho(r)=\\frac{Z}{2\\pi^2 r}\\int_{0}^{\\infty}\\frac{q\\sin(q r)}{1+a^{2}q^{2}}\\,dq.$$\n引入 $\\kappa=\\frac{1}{a}$，使得 $1+a^{2}q^{2}=a^{2}(q^{2}+\\kappa^{2})$，并提出因子 $a^{2}$：\n$$\\rho(r)=\\frac{Z}{2\\pi^2 a^2 r}\\int_{0}^{\\infty}\\frac{q\\sin(q r)}{q^{2}+\\kappa^{2}}\\,dq.$$\n对于 $r>0$ 和 $\\kappa>0$ 的标准积分为\n$$\\int_{0}^{\\infty}\\frac{q\\sin(q r)}{q^{2}+\\kappa^{2}}\\,dq=\\frac{\\pi}{2}\\exp(-\\kappa r).$$\n使用此结果，\n$$\\rho(r)=\\frac{Z}{2\\pi^2 a^2 r}\\cdot\\frac{\\pi}{2}\\exp(-\\kappa r)=\\frac{Z}{4\\pi a^{2}r}\\exp\\!\\left(-\\frac{r}{a}\\right).$$\n作为一致性检验，总电子数为\n$$\\int \\rho(\\vec{r})\\,d^{3}r=4\\pi\\int_{0}^{\\infty}\\rho(r)r^{2}\\,dr=\\frac{Z}{a^{2}}\\int_{0}^{\\infty}r\\exp\\!\\left(-\\frac{r}{a}\\right)\\,dr=Z,$$\n因为 $\\int_{0}^{\\infty}r\\exp(-r/a)\\,dr=a^{2}$。因此结果被正确归一化。所以，径向电子密度为\n$$\\rho(r)=\\frac{Z}{4\\pi a^{2}r}\\,\\exp\\!\\left(-\\frac{r}{a}\\right).$$", "answer": "$$\\boxed{\\frac{Z}{4\\pi a^{2}r}\\exp\\!\\left(-\\frac{r}{a}\\right)}$$", "id": "1808733"}]}