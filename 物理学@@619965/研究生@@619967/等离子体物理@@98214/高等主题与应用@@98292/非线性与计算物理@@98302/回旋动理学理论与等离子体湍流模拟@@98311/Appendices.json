{"hands_on_practices": [{"introduction": "在现代等离子体湍流模拟中，$\\delta f$ 方法是一种极其高效的工具，它通过追踪偏离已知背景分布的微小扰动来工作。在这种方法中，每个模拟粒子都带有一个“权重”$w_p$，该权重代表了粒子所在相空间位置的扰动 $\\delta f$ 与背景分布 $f_0$ 的比值。这个练习将引导你理解如何巧妙地设定初始粒子权重，以构造一个纯粹的温度扰动而没有任何初始密度扰动的物理情景，这是设置 $\\delta f$ 模拟的一项基本技能。[@problem_id:264074]", "problem": "在用于等离子体模拟的 delta-f ($\\delta f$) 网格粒子 (PIC) 方法中，总分布函数 $f$ 被分解为一个大的、稳恒的背景部分 $f_0$ 和一个小的、演化的扰动部分 $\\delta f$，使得 $f = f_0 + \\delta f$。该模拟跟踪标记粒子的演化，这些粒子根据背景分布 $f_0$ 对相空间进行采样。每个标记为 $p$ 的粒子都被赋予一个权重 $w_p$，该权重定义为在该粒子的相空间位置 $\\mathbf{Z}_p$ 处，扰动分布与背景分布的比值：\n$$w_p(t) = \\frac{\\delta f(\\mathbf{Z}_p, t)}{f_0(\\mathbf{Z}_p)}$$\n扰动数密度 $\\delta n$ 是扰动分布函数的一个矩，由速度空间上的积分给出：\n$$\\delta n(\\mathbf{x}, t) = \\int \\delta f(\\mathbf{x}, \\mathbf{v}, t) d^3v$$\n考虑一种空间均匀、无磁化的等离子体，其中给定粒子种类的背景分布函数 $f_0$ 是一个三维麦克斯韦分布：\n$$f_0(\\mathbf{v}) = n_0 \\left(\\frac{m}{2\\pi T_0}\\right)^{3/2} \\exp\\left(-\\frac{m|\\mathbf{v}|^2}{2T_0}\\right)$$\n此处，$n_0$ 是平衡数密度，$m$ 是粒子质量，$T_0$ 是以能量单位表示的平衡温度。\n\n现需用一种特定类型的扰动来初始化模拟，该扰动对应于纯温度扰动，且不伴随任何相关的密度扰动。为实现此目的，模拟粒子的初始权重根据以下依赖于粒子动能的形式来设定：\n$$w_p = A\\left(\\frac{m v_p^2}{2 T_0} - C\\right)$$\n其中 $v_p=|\\mathbf{v}_p|$ 是粒子 $p$ 的速率，$A$ 是一个任意非零振幅常数，$C$ 是一个无量纲常数。\n\n假设在 $t=0$ 时刻的粒子加载提供了对连续背景分布 $f_0$ 的完美采样，请推导为确保初始扰动数密度 $\\delta n$ 在空间各处均为零，所需的常数 $C$ 的精确数值。", "solution": "我们要求初始扰动密度\n$$\\delta n \\;=\\;\\int \\delta f\\,d^3v \\;=\\;\\int w(\\mathbf v)\\,f_0(\\mathbf v)\\,d^3v \\;=\\;0.$$\n由于 $w(\\mathbf v)=A\\bigl(\\frac{m v^2}{2T_0}-C\\bigr)$ 且 $A\\neq0$，我们有\n$$\\int\\!f_0\\frac{m v^2}{2T_0}\\,d^3v \\;-\\;C\\int\\!f_0\\,d^3v \\;=\\;0.$$\n计算麦克斯韦分布的矩：\n$$\\int f_0\\,d^3v = n_0,$$\n$$\\int f_0\\,\\frac{m v^2}{2}\\,d^3v = \\frac{3}{2}n_0T_0\n\\quad\\Longrightarrow\\quad\n\\int f_0\\,\\frac{m v^2}{2T_0}\\,d^3v = \\frac{3}{2}n_0.$$\n因此\n$$C = \\frac{\\displaystyle\\int f_0\\,\\frac{m v^2}{2T_0}\\,d^3v}{\\displaystyle\\int f_0\\,d^3v}\n= \\frac{\\frac{3}{2}n_0}{n_0} = \\frac{3}{2}.$$", "answer": "$$\\boxed{\\frac{3}{2}}$$", "id": "264074"}, {"introduction": "理解了如何用带权重的粒子来表示扰动之后，下一步是探究这些粒子如何通过计算网格与电磁场相互作用，这是“单元内粒子”（PIC）方法的核心。然而，将粒子电荷分配到网格、求解场方程、再将场力插值回粒子位置的这个过程并非完美无瑕，它会引入一些非物理的数值效应。本实践将引导你计算一个关键的数值产物——非物理自洽力，它恰恰源于这种离散化过程，理解这一点对于正确构建和解读 PIC 模拟至关重要。[@problem_id:264056]", "problem": "在现代等离子体模拟中，例如基于回旋动理学理论的模拟，带电粒子通常被建模为“宏粒子”，它们通过在离散计算网格上计算出的场相互作用。理解这种粒子-网格耦合产生的数值赝像是保证此类模拟有效性的关键。一个基本的赝像是“非物理自作用力”，即粒子因离散化过程而与其自身产生的场发生相互作用。\n\n考虑一个一维静电“单元内粒子”（PIC）模拟区域，其网格点位于 $x_j = j \\Delta x$ 位置，其中 $j$ 为整数。一个电荷量为 $q$ 的单个粒子位于位置 $x_p$。我们将使用一种非标准的、“混合的”PIC方案来分析该粒子上的自作用力，该方案结合了不同阶数的方法。\n\n计算该粒子所受作用力的步骤如下：\n1.  **电荷分配（最近网格点法，NGP）：** 粒子的总电荷 $q$ 被分配到唯一最近的网格点 $x_J$ 上。网格点 $j$ 上的电荷密度 $\\rho_j$ 由 $\\rho_j = Q_j / \\Delta x$ 给出，其中 $Q_j$ 是分配到网格点 $j$ 上的电荷。\n2.  **场求解器：** 网格上的电势 $\\phi_j$ 通过求解一维有限差分泊松方程来计算：\n    $$\n    \\frac{\\phi_{j+1} - 2\\phi_j + \\phi_{j-1}}{(\\Delta x)^2} = -\\frac{\\rho_j}{\\epsilon_0}\n    $$\n    其中 $\\epsilon_0$ 是真空介电常数。假设区域是无限的，这意味着网格上单个点电荷产生的电势具有 $\\phi_j \\propto |j-J|$ 的形式。然后，使用对称的二阶有限差分公式计算每个网格点上的电场 $E_j$：\n    $$\n    E_j = -\\frac{\\phi_{j+1} - \\phi_{j-1}}{2\\Delta x}\n    $$\n3.  **力插值（单元内云团法，CIC）：** 粒子位置处的电场 $E(x_p)$ 是通过对包围该粒子的两个网格点上的电场值进行线性插值来确定的。\n    \n设距离粒子最近的网格点为 $x_J = J \\Delta x$。定义粒子相对于此最近网格点的归一化位移为 $\\xi = (x_p - x_J)/\\Delta x$，其中 $\\xi \\in (-1/2, 1/2]$。推导作用在粒子上的非物理自作用力 $F$ 的表达式，该表达式是关于 $q$、$\\epsilon_0$ 和归一化位移 $\\xi$ 的函数。", "solution": "1. 在一维情况下，对于节点$J$处的单个点电荷$q$，离散泊松方程求解器满足\n$$\n\\frac{\\phi_{j+1}-2\\phi_j+\\phi_{j-1}}{(\\Delta x)^2}=-\\frac{q}{\\epsilon_0\\,\\Delta x}\\,\\delta_{jJ}.\n$$\n一维离散拉普拉斯算子的格林函数与$|j-J|$成正比，因此\n$$\n\\phi_j=-\\frac{q\\,\\Delta x}{2\\epsilon_0}\\,\\bigl|\\,j-J\\bigr|.\n$$\n2. 通过中心差分法计算网格节点 $j$ 处的电场为\n$$\nE_j=-\\frac{\\phi_{j+1}-\\phi_{j-1}}{2\\Delta x}\n=\\frac{q\\Delta x}{2\\epsilon_0\\,2\\Delta x}\\Bigl(|j+1-J|-|\\,j-1-J|\\Bigr)\n=\\frac{q}{4\\epsilon_0}\\bigl(|j+1-J|-|\\,j-1-J|\\bigr).\n$$\n注意到当 $m\\neq0$ 时 $|m+1|-|m-1|=2\\,\\mathrm{sign}(m)$，而当 $m=0$ 时为零，可得\n$$\nE_j=\\begin{cases}\\displaystyle \n\\frac{q}{2\\epsilon_0}\\,\\mathrm{sign}(j-J),&j\\neq J,\\\\0,&j=J~.\n\\end{cases}\n$$\n3. 对于一个位于 $x_p=J\\Delta x+\\xi\\,\\Delta x$ 且 $\\xi\\in(-\\tfrac12,\\tfrac12]$ 的粒子，从两个包围节点进行的CIC插值得到\n$$\nE(x_p)=(1-|\\xi|)\\,E_J+|\\xi|\\,E_{J+\\mathrm{sign}(\\xi)}\n=|\\xi|\\;\\frac{q}{2\\epsilon_0}\\,\\mathrm{sign}(\\xi)\n=\\frac{q}{2\\epsilon_0}\\,\\xi.\n$$\n4. 非物理自作用力为\n$$\nF=q\\,E(x_p)=\\frac{q^2}{2\\epsilon_0}\\,\\xi.\n$$", "answer": "$$\\boxed{\\frac{q^2}{2\\epsilon_0}\\,\\xi}$$", "id": "264056"}, {"introduction": "回旋动理学理论通过对粒子快速的回旋运动进行平均，极大地简化了复杂等离子体动力学的描述。在数值模拟中，这种“回旋平均”效应必须被精确地再现。这个练习将带你深入现代回旋动理学代码的核心，挑战你为一个关键的回旋平均算子推导出一个高阶有限差分格式的系数，让你亲身体验如何将一个连续的物理概念转化为离散的、可计算的数值算法。[@problem_id:263858]", "problem": "在磁约束等离子体的回旋动理学模拟中，粒子的有限拉莫尔半径 (FLR) 效应通过回旋平均算符来描述。在傅里叶空间中，对于一个涨落量 $\\phi$，此操作对应于将其垂直波矢分量 $\\hat{\\phi}(\\mathbf{k}_\\perp)$ 乘以第一类零阶贝塞尔函数 $J_0(k_\\perp \\rho)$，其中 $k_\\perp=|\\mathbf{k}_\\perp|$ 是垂直波数，而 $\\rho$ 是粒子的拉莫尔半径。\n\n为了在空间网格上进行数值实现，必须使用有限差分格式来近似该算符。考虑一个一维问题，其中物理量仅在 $x$ 方向上变化，因此 $k_\\perp = k_x$。网格具有均匀间距 $\\Delta x$。我们希望构建一个对称的五点有限差分模板来近似回旋平均算符。这个有限差分算符 $\\mathcal{J}_{FD}$ 在网格点 $x_i$ 处对场 $\\phi$ 的作用由下式给出：\n$$\n(\\mathcal{J}_{FD}\\phi)_i = c_2 \\phi_{i-2} + c_1 \\phi_{i-1} + c_0 \\phi_i + c_1 \\phi_{i+1} + c_2 \\phi_{i+2}\n$$\n该模板的傅里叶表示（或符号）为：\n$$\n\\widehat{\\mathcal{J}_{FD}}(k_x) = c_0 + 2c_1\\cos(k_x \\Delta x) + 2c_2\\cos(2k_x \\Delta x)\n$$\n为了确定系数 $c_0, c_1, c_2$，我们要求 $\\widehat{\\mathcal{J}_{FD}}(k_x)$ 关于 $k_x$ 的泰勒级数展开式与精确算符 $J_0(k_x \\rho)$ 的展开式匹配至 $k_x$ 的四阶。这确保了该格式具有四阶精度。\n\n相关的泰勒级数展开式为：\n$$\nJ_0(z) = 1 - \\frac{z^2}{4} + \\frac{z^4}{64} - \\mathcal{O}(z^6)\n$$\n$$\n\\cos(u) = 1 - \\frac{u^2}{2!} + \\frac{u^4}{4!} - \\mathcal{O}(u^6)\n$$\n令无量纲参数 $b = \\left(\\frac{\\rho}{\\Delta x}\\right)^2$。\n\n推导该四阶有限差分格式的系数 $c_1$ 作为参数 $b$ 的函数。", "solution": "我们将\n$$\\widehat{\\mathcal{J}_{FD}}(k_x)=c_0+2c_1\\cos(u)+2c_2\\cos(2u),\\quad u=k_x\\Delta x$$\n的泰勒展开式与\n$$J_0(k_x\\rho)=1-\\frac{(k_x\\rho)^2}{4}+\\frac{(k_x\\rho)^4}{64}+\\mathcal{O}(k_x^6)$$\n的泰勒展开式进行匹配，其中 $b=(\\rho/\\Delta x)^2$，因此 $k_x\\rho=u\\sqrt b$。\n\n1. 将模板符号展开至 $u$ 的四阶：\n$$\\cos(u)=1-\\frac{u^2}{2}+\\frac{u^4}{24},\\quad\n\\cos(2u)=1-2u^2+\\frac{2u^4}{3}。$$\n因此\n$$\\widehat{\\mathcal{J}_{FD}}=c_0+2c_1\\Bigl(1-\\frac{u^2}{2}+\\frac{u^4}{24}\\Bigr)\n+2c_2\\Bigl(1-2u^2+\\frac{2u^4}{3}\\Bigr)+\\mathcal{O}(u^6)。$$\n\n2. 收集系数：\n常数项：$c_0+2c_1+2c_2=1.$\n$u^2$ 项：$-c_1-4c_2=-\\frac b4.$\n$u^4$ 项：$\\frac{c_1}{12}+\\frac{4c_2}{3}=\\frac{b^2}{64}.$\n\n3. 求解该线性系统。由\n$$c_1+4c_2=\\frac b4,\\quad c_1+16c_2=\\frac{3b^2}{16},$$\n两式相减可得\n$$12c_2=\\frac{3b^2-4b}{16},\\quad c_2=\\frac{3b^2-4b}{192}。$$\n那么\n$$c_1=\\frac b4-4c_2=\\frac{12b-(3b^2-4b)}{48}=\\frac{16b-3b^2}{48}。$$", "answer": "$$\\boxed{\\frac{b(16 - 3b)}{48}}$$", "id": "263858"}]}