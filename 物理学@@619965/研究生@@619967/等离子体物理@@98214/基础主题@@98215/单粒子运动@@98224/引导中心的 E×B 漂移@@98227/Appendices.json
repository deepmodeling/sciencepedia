{"hands_on_practices": [{"introduction": "掌握了 $\\vec{E} \\times \\vec{B}$ 漂移的基本公式后，让我们通过一个具体的例子来检验我们的理解。在这个练习中，我们将计算一个带电粒子在特定的非均匀电场和均匀磁场中的运动时间 [@problem_id:248592]。这个实践将帮助你熟练掌握在不同坐标系下计算漂移速度，并运用积分来解决实际的动力学问题，从而将抽象的公式与可测量的物理量联系起来。", "problem": "一个质量为 $m$、电荷为 $q$ 的带电粒子在同时存在电场和磁场的空间区域中运动。磁场是均匀且静态的，沿 z 轴方向，在柱坐标 $(\\rho, \\phi, z)$ 下由 $\\vec{B} = B_0 \\hat{z}$ 给出。电场是静态的，纯方位角的，其大小与离 z 轴的径向距离成反比，由 $\\vec{E} = \\frac{K}{\\rho}\\hat{\\phi}$ 给出。此处，$B_0 > 0$ 和 $K > 0$ 是正常数。这种形式的电场在任何不包围 z 轴的区域内都是物理上可实现的。\n\n在导心近似下，粒子导心的主导运动是 $\\vec{E} \\times \\vec{B}$ 漂移，由速度矢量 $\\vec{v}_E = \\frac{\\vec{E} \\times \\vec{B}}{B^2}$ 描述。假设所有其他漂移（例如梯度漂移、曲率漂移和极化漂移）都可以忽略不计。\n\n推导粒子导心从初始径向位置 $\\rho_1$ 漂移到最终径向位置 $\\rho_2$ 所需时间 $T$ 的符号表达式，其中 $\\rho_2 > \\rho_1 > 0$。", "solution": "1. $\\vec{E}\\times\\vec{B}$ 漂移速度由下式给出\n$$\n\\vec{v}_E=\\frac{\\vec{E}\\times\\vec{B}}{B^2}\\,. \n$$\n2. 根据 $\\vec{E}=\\frac{K}{\\rho}\\hat\\phi$ 和 $\\vec{B}=B_0\\hat{z}$，计算\n$$\n\\vec{E}\\times\\vec{B}\n=\\frac{K}{\\rho}\\,\\hat\\phi\\times B_0\\hat{z}\n=\\frac{K B_0}{\\rho}\\,\\hat\\rho\n\\quad\\Longrightarrow\\quad\n\\vec{v}_E=\\frac{K}{B_0\\,\\rho}\\,\\hat\\rho.\n$$\n3. 导心以速度 $v_\\rho=d\\rho/dt=K/(B_0\\rho)$ 沿径向向外漂移。分离变量：\n$$\n\\rho\\,d\\rho=\\frac{K}{B_0}\\,dt.\n$$\n4. 对 $\\rho$ 从 $\\rho_1$ 到 $\\rho_2$、对时间从 $0$ 到 $T$ 进行积分：\n$$\n\\int_{\\rho_1}^{\\rho_2}\\rho\\,d\\rho\n=\\frac{K}{B_0}\\int_0^Tdt\n\\quad\\Longrightarrow\\quad\n\\frac{1}{2}(\\rho_2^2-\\rho_1^2)=\\frac{K}{B_0}\\,T.\n$$\n5. 求解 $T$：\n$$\nT=\\frac{B_0}{2K}\\,(\\rho_2^2-\\rho_1^2).\n$$", "answer": "$$\\boxed{\\frac{B_0}{2K}(\\rho_2^2-\\rho_1^2)}$$", "id": "248592"}, {"introduction": "在真实的等离子体环境中，粒子常常会穿越电势发生剧烈变化的区域，例如等离子体鞘层。这个练习模拟了这样一个过程，要求你计算引导中心穿过一个一维电势垒后的净横向位移 [@problem_id:248608]。通过结合引导中心能量守恒和 $\\vec{E} \\times \\vec{B}$ 漂移，你将更深入地理解在复杂场结构中粒子轨迹的决定因素，体会理论在解决现实物理问题中的应用。", "problem": "一个质量为 $m$、电荷为 $q$ 的粒子在一个空间区域中运动，该区域存在均匀、静态的磁场 $\\vec{B} = B_0 \\hat{z}$ 和一个由 $\\Phi(x) = \\Phi_0 \\tanh(x/L)$ 给出的非均匀、静态电势。这个电势产生一个局域电场 $\\vec{E} = E_x(x) \\hat{x}$，该电场驱动粒子在 y 方向上进行 $\\vec{E}\\times\\vec{B}$ 漂移。\n\n粒子的运动可由其导心来描述，其轨迹表示为 $\\vec{R}(t) = (X(t), Y(t), Z(t))$。我们考虑一个从 $x \\to -\\infty$ 开始运动的导心，其初速度纯粹沿着 x 轴，$\\vec{V}_{gc, i} = V_0 \\hat{x}$。该粒子具有一个恒定的磁矩 $\\mu$。假设初始动能足以克服势垒，即 $\\frac{1}{2}mV_0^2 > 2q\\Phi_0$。\n\n在漂移近似下，当 $\\vec{E}\\times\\vec{B}$ 漂移的动能与导心的其他动能相比可以忽略不计时，该近似有效。在此近似下，导心的能量根据以下关系守恒：\n$$W_{gc} \\approx \\frac{1}{2}m V_x^2 + \\mu B_0 + q\\Phi(x) = \\text{常数}$$\n其中 $V_x(t) = \\dot{X}(t)$ 是导心沿 x 轴的瞬时速度。\n\n推导导心从 $x \\to -\\infty$ 运动到 $x \\to +\\infty$ 后的总横向位移 $\\Delta Y$ 的闭式表达式。用 $m, q, B_0, V_0$ 和 $\\Phi_0$ 表示你的答案。", "solution": "我们有$$\\vec{E}=-\\nabla\\Phi=-\\frac{\\Phi_0}{L}\\text{sech}^2\\bigl(\\frac{x}{L}\\bigr)\\,\\hat x,\\qquad\\vec B=B_0\\hat z$$所以 $\\vec{E}\\times\\vec{B}$ 漂移为\n$$v_y=\\frac{E_x}{B_0}=-\\frac{\\Phi_0}{B_0L}\\text{sech}^2\\bigl(\\frac{x}{L}\\bigr)\\,. $$\n总横向位移为\n$$\\Delta Y=\\int_{-\\infty}^{\\infty}v_y\\,dt=\\int_{-\\infty}^{\\infty}\\frac{v_y(x)}{V_x(x)}\\,dx\\,. $$\n根据能量守恒\n$$\\frac12mV_x^2+q\\Phi(x)=\\frac12mV_0^2-q\\Phi_0,\\qquad\\Phi(x)=\\Phi_0\\tanh\\bigl(\\frac{x}{L}\\bigr)$$\n我们得到\n$$V_x^2=V_0^2-\\frac{2q\\Phi_0}{m}\\bigl[1+\\tanh(u)\\bigr],\\quad u=\\frac xL. $$\n因此\n$$\\Delta Y=-\\frac{\\Phi_0}{B_0}\\int_{-\\infty}^{\\infty}\\frac{\\text{sech}^2(u)}{\\sqrt{V_0^2-A[1+\\tanh(u)]}}\\,du,\\quad A=\\frac{2q\\Phi_0}{m}. $$\n设 $s=\\tanh(u)$，则 $ds=\\text{sech}^2(u)\\,du$，积分上下限从 $u=\\pm\\infty$ 变为 $s=\\pm1$，所以\n$$\\Delta Y=-\\frac{\\Phi_0}{B_0}\\int_{-1}^{1}\\frac{ds}{\\sqrt{B-As}},\\quad B=V_0^2-A. $$\n该积分为初等积分：\n$$\\int\\frac{ds}{\\sqrt{B-As}}=-\\frac{2}{A}\\sqrt{B-As}\\Big|_{-1}^{1}\n=\\frac{2}{A}\\bigl(\\sqrt{B+A}-\\sqrt{B-A}\\bigr).$$\n由于 $B+A=V_0^2,\\;B-A=V_0^2-\\frac{4q\\Phi_0}{m},\\;A=\\frac{2q\\Phi_0}{m}$，可以得到\n$$\\Delta Y=-\\frac{\\Phi_0}{B_0}\\,\\frac{2}{A}\\Bigl(V_0-\\sqrt{V_0^2-\\tfrac{4q\\Phi_0}{m}}\\Bigr)\n=-\\frac{m}{qB_0}\\Bigl(V_0-\\sqrt{V_0^2-\\tfrac{4q\\Phi_0}{m}}\\Bigr). $$", "answer": "$$\\boxed{-\\frac{m}{qB_{0}}\\Bigl(V_{0}-\\sqrt{V_{0}^{2}-\\frac{4q\\Phi_{0}}{m}}\\Bigr)}$$", "id": "248608"}, {"introduction": "理论分析为我们提供了 $\\vec{E} \\times \\vec{B}$ 漂移的简洁公式，但这一漂移的本质是粒子在洛伦兹力作用下复杂回旋运动的平均结果。这个动手实践将通过编写代码，从第一性原理（牛顿第二定律和洛伦兹力）出发，数值模拟带电粒子的完整轨迹 [@problem_id:2390224]。你将亲眼看到漂移运动如何从回旋中浮现，并通过计算引导中心来精确地量化这一效应，从而深刻理解理论与真实物理过程之间的联系。", "problem": "一个电荷为 $q$、质量为 $m$ 的非相对论性点状粒子在均匀且相互垂直的电场和磁场中运动。设粒子的位置为 $\\mathbf{r}(t)$（单位：米），速度为 $\\mathbf{v}(t)$（单位：米/秒）。基本依据是 Newton 第二定律和洛伦兹力定律：总力为 $\\mathbf{F} = q\\left(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}\\right)$，因此运动方程为耦合的常微分方程组（ODEs）：$\\dfrac{d\\mathbf{r}}{dt} = \\mathbf{v}$ 和 $m\\dfrac{d\\mathbf{v}}{dt} = q\\left(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}\\right)$。假设所有场在空间和时间上都是恒定的，并以国际单位制（SI）给出。\n\n您的任务是实现并使用欧拉方法求解常微分方程，以数值方式证明 $\\mathbf{E}\\times\\mathbf{B}$ 漂移的存在。具体而言：\n\n1. 仅从 Newton 第二定律和洛伦兹力（如上文给出的基本依据）出发，推导当一个恒定的垂直电场 $\\mathbf{E}$ 和磁场 $\\mathbf{B}$ 作用于粒子时所产生的连续时间漂移速度的形式。解释为什么此漂移与 $q$ 和 $m$ 无关。\n2. 为上述常微分方程组推导前向欧拉法和一种半隐式欧拉变体（先更新速度，然后使用更新后的速度更新位置）。您必须明确陈述您将要实现的更新规则。\n3. 为了在有限时间内稳健地数值提取漂移，而无需等待多次回旋，请使用导心位置来滤除回旋运动并分离出漂移。定义导心坐标\n   $$\\mathbf{R}(t) = \\mathbf{r}(t) - \\frac{m}{q\\|\\mathbf{B}\\|^2}\\,\\mathbf{v}(t) \\times \\mathbf{B},$$\n   并将漂移速度估计为有限时间差商\n   $$\\widehat{\\mathbf{v}}_{\\text{drift}} = \\frac{\\mathbf{R}(T) - \\mathbf{R}(0)}{T}.$$\n   解释这如何从连续时间动力学中得出，以及为什么它能消除快速的回旋运动。\n4. 实现这两种方法，并针对下面的每个测试用例，计算您的数值估计漂移速度 $\\widehat{\\mathbf{v}}_{\\text{drift}}$ 与您在第 1 部分中从连续方程解析推导出的漂移速度之间差值的欧几里得范数（单位：米/秒）。对于每个测试用例，报告两个浮点数：使用前向欧拉法的误差，其后是使用半隐式欧拉变体的误差。\n\n物理和数值单位：$\\mathbf{E}$ 的所有矢量分量单位为伏特/米，$\\mathbf{B}$ 的单位为特斯拉，时间单位为秒，$\\mathbf{r}$ 的单位为米，$\\mathbf{v}$ 的单位为米/秒，电荷 $q$ 的单位为库仑，质量 $m$ 的单位为千克。将所有要求的误差大小以米/秒为单位表示为浮点数。\n\n测试套件和初始条件：\n- 所有情况均使用初始位置 $\\mathbf{r}(0) = (0,0,0)$ 米。\n- 使用以下四组参数集，涵盖一般情况、边界情况、磁场非常小的边缘情况以及电荷符号反转的情况：\n  1. 情况 A（一般情况）：$q = 1.0\\times 10^{-15}$，$m = 1.0\\times 10^{-12}$，$\\mathbf{E} = (2.0,0.0,0.0)$，$\\mathbf{B} = (0.0,0.0,0.5)$，$T = 10.0$，$\\Delta t = 0.05$，以及 $\\mathbf{v}(0) = (0.0,0.0,0.0)$。\n  2. 情况 B（边界情况，无电场）：$q = 1.0\\times 10^{-15}$，$m = 1.0\\times 10^{-12}$，$\\mathbf{E} = (0.0,0.0,0.0)$，$\\mathbf{B} = (0.0,0.0,0.5)$，$T = 1.0$，$\\Delta t = 0.1$，以及 $\\mathbf{v}(0) = (0.0,0.0,0.0)$。\n  3. 情况 C（边缘情况，磁场非常小）：$q = 1.0\\times 10^{-15}$，$m = 1.0\\times 10^{-12}$，$\\mathbf{E} = (0.01,0.0,0.0)$，$\\mathbf{B} = (0.0,0.0,1.0\\times 10^{-4})$，$T = 50.0$，$\\Delta t = 0.5$，以及 $\\mathbf{v}(0) = (0.0,0.0,0.0)$。\n  4. 情况 D（电荷符号反转）：$q = -1.0\\times 10^{-15}$，$m = 1.0\\times 10^{-12}$，$\\mathbf{E} = (2.0,0.0,0.0)$，$\\mathbf{B} = (0.0,0.0,0.5)$，$T = 10.0$，$\\Delta t = 0.05$，以及 $\\mathbf{v}(0) = (0.0,0.0,0.0)$。\n\n最终输出格式：\n- 您的程序必须生成单行输出，其中包含一个位于方括号内的逗号分隔列表形式的结果。\n- 该列表必须按顺序为每个情况包含两个浮点数：首先是前向欧拉法的误差（单位：米/秒），然后是半隐式欧拉法的误差（单位：米/秒）。因此，对于这四种情况，输出总共必须有 8 个数字，顺序为 $\\left[\\text{A-FE},\\text{A-SE},\\text{B-FE},\\text{B-SE},\\text{C-FE},\\text{C-SE},\\text{D-FE},\\text{D-SE}\\right]$。", "solution": "所提出的问题是有效的。它基于经典电动力学的基本原理，即洛伦兹力定律和 Newton 第二定律，并构成了一个在计算物理学中定义明确的初值问题。所有必要的参数和条件都已提供，不存在科学或逻辑上的矛盾。我们将进行严谨的求解。\n\n带电粒子在交叉电磁场中的运动是一个典型问题。其轨迹是平行于磁场的匀速运动、垂直于磁场平面内的圆周回旋运动，以及此回旋中心同样垂直于磁场的稳定漂移的叠加。我们的目标是首先解析推导此漂移速度，然后使用欧拉法的两种变体从数值上证明其存在。\n\n**1. 漂移速度的解析推导**\n\n一个电荷为 $q$、质量为 $m$ 的粒子的运动方程由 Newton 第二定律和洛伦兹力组合给出：\n$$m\\frac{d\\mathbf{v}}{dt} = q(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B})$$\n我们寻求速度 $\\mathbf{v}$ 的解。让我们将速度分解为平行和垂直于磁场 $\\mathbf{B}$ 的分量：$\\mathbf{v} = \\mathbf{v}_{\\|} + \\mathbf{v}_{\\perp}$。电场也同样分解为 $\\mathbf{E} = \\mathbf{E}_{\\|} + \\mathbf{E}_{\\perp}$。运动方程可分为两部分：\n$$m\\frac{d\\mathbf{v}_{\\|}}{dt} = q\\mathbf{E}_{\\|}$$\n$$m\\frac{d\\mathbf{v}_{\\perp}}{dt} = q(\\mathbf{E}_{\\perp} + \\mathbf{v}_{\\perp} \\times \\mathbf{B})$$\n问题陈述场是相互垂直的，因此 $\\mathbf{E} \\cdot \\mathbf{B} = 0$，这意味着 $\\mathbf{E}_{\\|} = 0$。因此，$\\frac{d\\mathbf{v}_{\\|}}{dt} = 0$，平行于 $\\mathbf{B}$ 的速度分量是恒定的。\n\n垂直运动更为复杂。我们假设垂直速度 $\\mathbf{v}_{\\perp}$ 可以表示为一个恒定漂移速度 $\\mathbf{v}_D$ 和一个时变的回旋速度 $\\mathbf{u}(t)$ 的和：$\\mathbf{v}_{\\perp} = \\mathbf{v}_D + \\mathbf{u}(t)$。漂移速度代表一个稳态解，此时垂直平面上的合力平均为零。存在一个特定的恒定速度 $\\mathbf{v}_D$，使得电场力和磁场力完全平衡。我们通过将垂直加速度设为零并将 $\\mathbf{v}_{\\perp}$ 替换为 $\\mathbf{v}_D$ 来找到此速度：\n$$0 = q(\\mathbf{E}_{\\perp} + \\mathbf{v}_D \\times \\mathbf{B})$$\n$$\\mathbf{E}_{\\perp} = -(\\mathbf{v}_D \\times \\mathbf{B})$$\n为了求解 $\\mathbf{v}_D$，我们将此方程与 $\\mathbf{B}$ 做叉积：\n$$\\mathbf{E}_{\\perp} \\times \\mathbf{B} = -(\\mathbf{v}_D \\times \\mathbf{B}) \\times \\mathbf{B}$$\n使用矢量三重积恒等式 $\\mathbf{A} \\times (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{B}(\\mathbf{A} \\cdot \\mathbf{C}) - \\mathbf{C}(\\mathbf{A} \\cdot \\mathbf{B})$，我们得到：\n$$\\mathbf{E}_{\\perp} \\times \\mathbf{B} = -[\\mathbf{B}(\\mathbf{v}_D \\cdot \\mathbf{B}) - \\mathbf{v}_D(\\mathbf{B} \\cdot \\mathbf{B})]$$\n漂移速度 $\\mathbf{v}_D$ 是对垂直力的响应，因此它必须垂直于 $\\mathbf{B}$，即 $\\mathbf{v}_D \\cdot \\mathbf{B} = 0$。方程简化为：\n$$\\mathbf{E}_{\\perp} \\times \\mathbf{B} = -[-\\mathbf{v}_D(\\mathbf{B} \\cdot \\mathbf{B})] = \\mathbf{v}_D \\|\\mathbf{B}\\|^2$$\n由于 $\\mathbf{E}_{\\perp} = \\mathbf{E}$，我们得到 $\\mathbf{E} \\times \\mathbf{B}$ 漂移速度的表达式：\n$$\\mathbf{v}_D = \\frac{\\mathbf{E} \\times \\mathbf{B}}{\\|\\mathbf{B}\\|^2}$$\n此推导表明，漂移速度 $\\mathbf{v}_D$ 仅取决于电场 $\\mathbf{E}$ 和磁场 $\\mathbf{B}$。它从根本上与粒子的电荷 $q$ 和质量 $m$ 无关。电荷和质量的大小仅影响叠加的回旋运动的特性（其频率和半径），而不影响导心漂移的速度。电荷 $q$ 的符号会反转回旋方向，但漂移方向保持不变。\n\n**2. 数值积分方案的推导**\n\n待解的方程组是一组两个耦合的一阶常微分方程（ODEs）：\n$$ \\frac{d\\mathbf{r}}{dt} = \\mathbf{v} $$\n$$ \\frac{d\\mathbf{v}}{dt} = \\frac{q}{m}(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}) = \\mathbf{a}(\\mathbf{v}) $$\n我们用一个恒定的步长 $\\Delta t$ 对时间进行离散化，使得 $t_n = n\\Delta t$。系统在时间 $t_n$ 的状态为 $(\\mathbf{r}_n, \\mathbf{v}_n)$。\n\n**前向欧拉（FE）**法是一种显式一阶方法。它使用在第 $n$ 步计算的导数来近似第 $n+1$ 步的状态：\n$$ \\mathbf{v}_{n+1} = \\mathbf{v}_n + \\Delta t \\cdot \\mathbf{a}(\\mathbf{v}_n) = \\mathbf{v}_n + \\Delta t \\frac{q}{m}(\\mathbf{E} + \\mathbf{v}_n \\times \\mathbf{B}) $$\n$$ \\mathbf{r}_{n+1} = \\mathbf{r}_n + \\Delta t \\cdot \\mathbf{v}_n $$\n该方法简单，但以其较差的稳定性而著称，尤其对于振荡系统，它会人为地增加系统能量。\n\n**半隐式欧拉（SE）**法，也称为 Euler-Cromer 法，是一种提高稳定性的变体。按照规定，我们首先更新速度，然后使用这个新计算出的速度来更新位置。这引入了一种隐式元素，显著改善了哈密顿系统的能量守恒性。更新规则如下：\n$$ \\mathbf{v}_{n+1} = \\mathbf{v}_n + \\Delta t \\cdot \\mathbf{a}(\\mathbf{v}_n) = \\mathbf{v}_n + \\Delta t \\frac{q}{m}(\\mathbf{E} + \\mathbf{v}_n \\times \\mathbf{B}) $$\n$$ \\mathbf{r}_{n+1} = \\mathbf{r}_n + \\Delta t \\cdot \\mathbf{v}_{n+1} $$\n与前向欧拉法相比，这种辛积分器预计能为回旋粒子产生更准确的长期轨迹。\n\n**3. 用于漂移估计的导心位置**\n\n完整的粒子轨迹 $\\mathbf{r}(t)$ 是一条复杂的摆线路径，由快速的回旋运动叠加在较慢的导心漂移上而形成。为了数值提取漂移速度，我们必须滤除振荡的回旋运动。导心位置 $\\mathbf{R}(t)$ 代表粒子圆周回旋的中心。问题中定义为：\n$$\\mathbf{R}(t) = \\mathbf{r}(t) - \\frac{m}{q\\|\\mathbf{B}\\|^2}\\,\\mathbf{v}(t) \\times \\mathbf{B}$$\n第二项 $\\boldsymbol{\\rho}_{est}(t) = \\frac{m}{q\\|\\mathbf{B}\\|^2}\\,\\mathbf{v}(t) \\times \\mathbf{B}$，是回旋半径矢量的近似，该矢量是从导心指向粒子位置的矢量。通过从粒子的瞬时位置 $\\mathbf{r}(t)$ 中减去此项，我们得到导心位置的估计值。这种减法有效地从位置数据中移除了振荡运动的最大分量。\n\n这个估计的导心的瞬时速度 $\\frac{d\\mathbf{R}}{dt}$ 并非完全恒定。它包含真实的导心速度（在我们的情况下是 $\\mathbf{v}_D$，因为 $\\mathbf{v}_{\\|}(0)=0$）外加一个以回旋频率振荡的残余项。为了消除这种残余振荡，我们在总模拟时间 $T$ 上对导心速度进行平均。这是通过计算有限差商来实现的：\n$$\\widehat{\\mathbf{v}}_{\\text{drift}} = \\frac{\\mathbf{R}(T) - \\mathbf{R}(0)}{T}$$\n这个计算等价于 $\\frac{1}{T}\\int_0^T \\frac{d\\mathbf{R}}{dt'} dt'$。当时间 $T$ 远大于回旋周期时，振荡部分的积分与恒定漂移的积分相比变得可以忽略不计，从而得到一个数值上稳健的平均漂移速度估计。对于给定的初始条件 $\\mathbf{r}(0) = \\mathbf{0}$ 和 $\\mathbf{v}(0) = \\mathbf{0}$，初始导心位置为 $\\mathbf{R}(0) = \\mathbf{0}$，从而将估计简化为 $\\widehat{\\mathbf{v}}_{\\text{drift}} = \\mathbf{R}(T)/T$。\n\n**4. 计算流程**\n\n对于每个测试用例，我们执行以下步骤：\n1.  计算解析漂移速度 $\\mathbf{v}_D = \\frac{\\mathbf{E} \\times \\mathbf{B}}{\\|\\mathbf{B}\\|^2}$。\n2.  使用前向欧拉法运行从 $t=0$ 到 $t=T$ 的模拟，以找到最终状态 $(\\mathbf{r}_{FE}(T), \\mathbf{v}_{FE}(T))$。\n3.  计算最终导心位置 $\\mathbf{R}_{FE}(T)$ 和数值漂移 $\\widehat{\\mathbf{v}}_{\\text{drift, FE}} = (\\mathbf{R}_{FE}(T) - \\mathbf{R}(0))/T$。\n4.  计算前向欧拉法的误差，即欧几里得范数 $E_{FE} = \\|\\widehat{\\mathbf{v}}_{\\text{drift, FE}} - \\mathbf{v}_D\\|$。\n5.  使用半隐式欧拉法重复步骤 2-4，以找到 $(\\mathbf{r}_{SE}(T), \\mathbf{v}_{SE}(T))$、$\\widehat{\\mathbf{v}}_{\\text{drift, SE}}$ 以及相应的误差 $E_{SE} = \\|\\widehat{\\mathbf{v}}_{\\text{drift, SE}} - \\mathbf{v}_D\\|$。\n6.  计算出的误差对 $(E_{FE}, E_{SE})$ 构成了该测试用例的结果。对所有指定的用例重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the error in numerically estimated E x B drift velocity\n    using Forward Euler and Semi-Implicit Euler methods.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (happy path)\n        {\n            \"q\": 1.0e-15, \"m\": 1.0e-12, \"E\": np.array([2.0, 0.0, 0.0]),\n            \"B\": np.array([0.0, 0.0, 0.5]), \"T\": 10.0, \"dt\": 0.05,\n            \"v0\": np.array([0.0, 0.0, 0.0]), \"r0\": np.array([0.0, 0.0, 0.0])\n        },\n        # Case B (boundary, no electric field)\n        {\n            \"q\": 1.0e-15, \"m\": 1.0e-12, \"E\": np.array([0.0, 0.0, 0.0]),\n            \"B\": np.array([0.0, 0.0, 0.5]), \"T\": 1.0, \"dt\": 0.1,\n            \"v0\": np.array([0.0, 0.0, 0.0]), \"r0\": np.array([0.0, 0.0, 0.0])\n        },\n        # Case C (edge, very small magnetic field)\n        {\n            \"q\": 1.0e-15, \"m\": 1.0e-12, \"E\": np.array([0.01, 0.0, 0.0]),\n            \"B\": np.array([0.0, 0.0, 1.0e-4]), \"T\": 50.0, \"dt\": 0.5,\n            \"v0\": np.array([0.0, 0.0, 0.0]), \"r0\": np.array([0.0, 0.0, 0.0])\n        },\n        # Case D (sign reversal of charge)\n        {\n            \"q\": -1.0e-15, \"m\": 1.0e-12, \"E\": np.array([2.0, 0.0, 0.0]),\n            \"B\": np.array([0.0, 0.0, 0.5]), \"T\": 10.0, \"dt\": 0.05,\n            \"v0\": np.array([0.0, 0.0, 0.0]), \"r0\": np.array([0.0, 0.0, 0.0])\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        q, m, E, B = case[\"q\"], case[\"m\"], case[\"E\"], case[\"B\"]\n        T, dt, v0, r0 = case[\"T\"], case[\"dt\"], case[\"v0\"], case[\"r0\"]\n\n        B_norm_sq = np.dot(B, B)\n\n        # Calculate analytical drift velocity\n        if B_norm_sq > 0:\n            v_drift_analytical = np.cross(E, B) / B_norm_sq\n        else:\n            v_drift_analytical = np.array([0.0, 0.0, 0.0])\n            \n        num_steps = int(round(T / dt))\n\n        # --- Forward Euler Method ---\n        r = np.copy(r0)\n        v = np.copy(v0)\n        \n        for _ in range(num_steps):\n            a = (q / m) * (E + np.cross(v, B))\n            r_next = r + v * dt\n            v_next = v + a * dt\n            r, v = r_next, v_next\n        \n        r_final_fe, v_final_fe = r, v\n        \n        # --- Semi-Implicit Euler Method ---\n        r = np.copy(r0)\n        v = np.copy(v0)\n        \n        for _ in range(num_steps):\n            a = (q / m) * (E + np.cross(v, B))\n            v_next = v + a * dt\n            r_next = r + v_next * dt\n            r, v = r_next, v_next\n            \n        r_final_se, v_final_se = r, v\n\n        # --- Calculate errors ---\n        # Guiding center position R_0 at t=0 is r0 since v0 is zero\n        R0 = r0\n        \n        # Error for Forward Euler\n        if B_norm_sq > 0:\n            R_T_fe = r_final_fe - (m / (q * B_norm_sq)) * np.cross(v_final_fe, B)\n        else: # Handle B=0 case, though not in test suite\n            R_T_fe = r_final_fe\n            \n        v_drift_fe_numerical = (R_T_fe - R0) / T\n        error_fe = np.linalg.norm(v_drift_fe_numerical - v_drift_analytical)\n        results.append(error_fe)\n\n        # Error for Semi-Implicit Euler\n        if B_norm_sq > 0:\n            R_T_se = r_final_se - (m / (q * B_norm_sq)) * np.cross(v_final_se, B)\n        else: # Handle B=0 case\n            R_T_se = r_final_se\n\n        v_drift_se_numerical = (R_T_se - R0) / T\n        error_se = np.linalg.norm(v_drift_se_numerical - v_drift_analytical)\n        results.append(error_se)\n\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\nsolve()\n```", "id": "2390224"}]}