{"hands_on_practices": [{"introduction": "瓦尼尔函数是在周期性势场中电子的连续描述与直观、离散的紧束缚模型之间架起理想桥梁的工具。通过将电子态表示为局域化的轨道，我们可以计算出关键的模型参数，例如在位能和跃迁振幅。本练习 [@problem_id:1279679] 将引导您完成一项基础计算：确定最近邻势能矩阵元，该矩阵元直接关系到光晶格中原子的紧束缚模型中的跃迁参数。", "problem": "考虑一个一维无相互作用的粒子系统，该系统处于周期势中，例如冷原子在光晶格中所感受到的势。该势由下式给出：\n$$\nV(x) = V_0 \\cos\\left(\\frac{2\\pi x}{a}\\right)\n$$\n其中 $V_0$ 是势振幅，$a$ 是晶格常数。\n\n在紧束缚近似下（即对于深晶格势），单粒子波函数可以用瓦尼尔函数 $W_n(x)$ 来描述，这些函数局域在格点 $R_n = na$（其中 $n$ 为整数）附近。对于最低能带，在此近似下，中心位于格点 $n$ 的瓦尼尔函数可以很好地用一个归一化的高斯波包来近似：\n$$\nW_n(x) \\approx \\left(\\frac{2}{\\pi \\sigma^2}\\right)^{1/4} \\exp\\left(-\\frac{(x - na)^2}{\\sigma^2}\\right)\n$$\n其中 $\\sigma$ 是波包的空间宽度，并且我们假设 $\\sigma \\ll a$。\n\n你的任务是计算最近邻势能矩阵元，定义为 $J = \\langle W_n | V(x) | W_{n+1} \\rangle$。由于系统的平移对称性，该值与具体的格点 $n$ 无关。\n\n计算这个矩阵元 $J$。请用参数 $V_0$、$a$ 和 $\\sigma$ 给出闭式解析表达式形式的答案。", "solution": "我们需要计算最近邻势能矩阵元 $J = \\langle W_n | V(x) | W_{n+1} \\rangle$。由于平移不变性，该矩阵元与 $n$ 无关。因此，我们可以不失一般性地设 $n=0$ 来计算 $J = \\langle W_0 | V(x) | W_1 \\rangle$。\n\n该矩阵元由以下积分给出：\n$$\nJ = \\int_{-\\infty}^{\\infty} W_0^*(x) V(x) W_1(x) \\, dx\n$$\n\n瓦尼尔函数是实函数，所以 $W_0^*(x) = W_0(x)$。让我们代入给定的瓦尼尔函数和势的表达式。对于 $n=0$ 和 $n=1$，瓦尼尔函数为：\n$$\nW_0(x) = \\left(\\frac{2}{\\pi \\sigma^2}\\right)^{1/4} \\exp\\left(-\\frac{x^2}{\\sigma^2}\\right)\n$$\n$$\nW_1(x) = \\left(\\frac{2}{\\pi \\sigma^2}\\right)^{1/4} \\exp\\left(-\\frac{(x - a)^2}{\\sigma^2}\\right)\n$$\n势为：\n$$\nV(x) = V_0 \\cos\\left(\\frac{2\\pi x}{a}\\right)\n$$\n\n将这些代入 $J$ 的积分中：\n$$\nJ = \\int_{-\\infty}^{\\infty} \\left[ \\left(\\frac{2}{\\pi \\sigma^2}\\right)^{1/4} \\exp\\left(-\\frac{x^2}{\\sigma^2}\\right) \\right] \\left[ V_0 \\cos\\left(\\frac{2\\pi x}{a}\\right) \\right] \\left[ \\left(\\frac{2}{\\pi \\sigma^2}\\right)^{1/4} \\exp\\left(-\\frac{(x-a)^2}{\\sigma^2}\\right) \\right] \\, dx\n$$\n\n我们可以把常数提出来：\n$$\nJ = V_0 \\left(\\frac{2}{\\pi \\sigma^2}\\right)^{1/2} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{x^2}{\\sigma^2}\\right) \\exp\\left(-\\frac{(x-a)^2}{\\sigma^2}\\right) \\cos\\left(\\frac{2\\pi x}{a}\\right) \\, dx\n$$\n\n接下来，我们合并指数函数的宗量：\n$$\n-\\frac{x^2}{\\sigma^2} - \\frac{(x-a)^2}{\\sigma^2} = -\\frac{1}{\\sigma^2} (x^2 + x^2 - 2ax + a^2) = -\\frac{1}{\\sigma^2} (2x^2 - 2ax + a^2)\n$$\n我们对 $x$ 的二次项进行配方：\n$$\n2x^2 - 2ax + a^2 = 2\\left(x^2 - ax\\right) + a^2 = 2\\left(\\left(x - \\frac{a}{2}\\right)^2 - \\frac{a^2}{4}\\right) + a^2 = 2\\left(x - \\frac{a}{2}\\right)^2 - \\frac{a^2}{2} + a^2 = 2\\left(x - \\frac{a}{2}\\right)^2 + \\frac{a^2}{2}\n$$\n所以指数项变为：\n$$\n\\exp\\left(-\\frac{1}{\\sigma^2} \\left[2\\left(x - \\frac{a}{2}\\right)^2 + \\frac{a^2}{2}\\right]\\right) = \\exp\\left(-\\frac{2}{\\sigma^2}\\left(x - \\frac{a}{2}\\right)^2\\right) \\exp\\left(-\\frac{a^2}{2\\sigma^2}\\right)\n$$\n\n现在，我们将其代回 $J$ 的积分中：\n$$\nJ = V_0 \\left(\\frac{2}{\\pi \\sigma^2}\\right)^{1/2} \\exp\\left(-\\frac{a^2}{2\\sigma^2}\\right) \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{2}{\\sigma^2}\\left(x - \\frac{a}{2}\\right)^2\\right) \\cos\\left(\\frac{2\\pi x}{a}\\right) \\, dx\n$$\n\n为了求解该积分，我们进行变量代换：$u = x - a/2$，这意味着 $x = u + a/2$ 且 $du = dx$。积分变为：\n$$\nI_{\\text{int}} = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{2u^2}{\\sigma^2}\\right) \\cos\\left(\\frac{2\\pi}{a}\\left(u + \\frac{a}{2}\\right)\\right) \\, du\n$$\n使用恒等式 $\\cos(A+B) = \\cos A \\cos B - \\sin A \\sin B$：\n$$\n\\cos\\left(\\frac{2\\pi u}{a} + \\pi\\right) = \\cos\\left(\\frac{2\\pi u}{a}\\right)\\cos(\\pi) - \\sin\\left(\\frac{2\\pi u}{a}\\right)\\sin(\\pi) = -\\cos\\left(\\frac{2\\pi u}{a}\\right)\n$$\n所以积分简化为：\n$$\nI_{\\text{int}} = -\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{2u^2}{\\sigma^2}\\right) \\cos\\left(\\frac{2\\pi u}{a}\\right) \\, du\n$$\n这是一个标准的高斯积分，其形式为 $\\int_{-\\infty}^{\\infty} e^{-Ax^2} \\cos(kx) \\, dx = \\sqrt{\\frac{\\pi}{A}} e^{-k^2/(4A)}$。\n在我们的例子中，$A = 2/\\sigma^2$ 且 $k = 2\\pi/a$。\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{2u^2}{\\sigma^2}\\right) \\cos\\left(\\frac{2\\pi u}{a}\\right) \\, du = \\sqrt{\\frac{\\pi}{2/\\sigma^2}} \\exp\\left(-\\frac{(2\\pi/a)^2}{4(2/\\sigma^2)}\\right)\n$$\n$$\n= \\sqrt{\\frac{\\pi \\sigma^2}{2}} \\exp\\left(-\\frac{4\\pi^2/a^2}{8/\\sigma^2}\\right) = \\sqrt{\\frac{\\pi \\sigma^2}{2}} \\exp\\left(-\\frac{\\pi^2 \\sigma^2}{2a^2}\\right)\n$$\n因此，\n$$\nI_{\\text{int}} = - \\sqrt{\\frac{\\pi \\sigma^2}{2}} \\exp\\left(-\\frac{\\pi^2 \\sigma^2}{2a^2}\\right)\n$$\n\n最后，我们将此结果代回 $J$ 的表达式中：\n$$\nJ = V_0 \\left(\\frac{2}{\\pi \\sigma^2}\\right)^{1/2} \\exp\\left(-\\frac{a^2}{2\\sigma^2}\\right) \\left(- \\sqrt{\\frac{\\pi \\sigma^2}{2}} \\exp\\left(-\\frac{\\pi^2 \\sigma^2}{2a^2}\\right)\\right)\n$$\n平方根项相互抵消：\n$$\n\\left(\\frac{2}{\\pi \\sigma^2}\\right)^{1/2} \\sqrt{\\frac{\\pi \\sigma^2}{2}} = \\sqrt{\\frac{2}{\\pi \\sigma^2} \\cdot \\frac{\\pi \\sigma^2}{2}} = \\sqrt{1} = 1\n$$\n这就得到了 $J$ 的最终表达式：\n$$\nJ = -V_0 \\exp\\left(-\\frac{a^2}{2\\sigma^2}\\right) \\exp\\left(-\\frac{\\pi^2 \\sigma^2}{2a^2}\\right)\n$$\n$$\nJ = -V_0 \\exp\\left[-\\frac{1}{2}\\left(\\frac{a^2}{\\sigma^2} + \\frac{\\pi^2 \\sigma^2}{a^2}\\right)\\right]\n$$", "answer": "$$\n\\boxed{-V_0 \\exp\\left[-\\frac{1}{2}\\left(\\frac{a^2}{\\sigma^2} + \\frac{\\pi^2 \\sigma^2}{a^2}\\right)\\right]}\n$$", "id": "1279679"}, {"introduction": "最大局域瓦尼尔函数的位置并非任意，而是受到晶体潜在对称性的深刻制约。在具有反演对称性的体系中，瓦尼尔中心被“钉扎”在特定的高对称点上，这一现象与现代电极化理论有着深刻的联系。本练习 [@problem_id:1279665] 将揭示这种优美的联系，要求您仅根据布里渊区中特殊点的布洛赫态的反演本征值来确定瓦尼尔中心的位置。", "problem": "考虑一个晶格常数为 $a$ 的一维绝缘体。该晶体具有反演对称性，我们选择坐标系原点 $x=0$ 作为反演中心。因此，所有点 $x=ma$（其中 $m$ 是整数）都是等效的反演中心。\n\n对于单个孤立能带，在布里渊区的高对称点 $k=0$ 和 $k=\\pi/a$ 处，布洛赫函数的元胞周期部分 $|u_k\\rangle$ 可以被选择为反演算符 $\\hat{I}$（其中 $(\\hat{I}f)(x) = f(-x)$）的本征态。对应的本征值为 $\\xi_0$ 和 $\\xi_{\\pi/a}$：\n$$\n\\hat{I}|u_0\\rangle = \\xi_0 |u_0\\rangle\n$$\n$$\n\\hat{I}|u_{\\pi/a}\\rangle = \\xi_{\\pi/a} |u_{\\pi/a}\\rangle\n$$\n其中 $\\xi_0, \\xi_{\\pi/a}$ 的取值只能是 $+1$ 或 $-1$。\n\n可以为此能带构建一组局域 Wannier 函数基 $|W_R\\rangle$，其中 $|W_R\\rangle$ 是局域在格矢 $R=ma$ 处元胞中的 Wannier 函数。在原点元胞（$R=0$）中的 Wannier 函数中心由期望值 $\\bar{x} = \\langle W_0|\\hat{x}|W_0\\rangle$ 给出。通过恰当地选择整个布里渊区中布洛赫函数的相位，可以构建出最局域 Wannier 函数 (MLWFs)。对于具有反演对称性的系统，这些 MLWF 的中心被钉扎在高对称位置上。\n\n给定布洛赫态在 $k=0$ 和 $k=\\pi/a$ 处的反演本征值 $\\xi_0$ 和 $\\xi_{\\pi/a}$，请确定原点元胞中最局域 Wannier 函数 (MLWF) 的 Wannier 中心 $\\bar{x}$ 的位置。你的答案应使用 $a$、$\\xi_0$ 和 $\\xi_{\\pi/a}$ 表示，并且应位于区间 $[0, a)$ 内。", "solution": "1. 在 $k=0$ 和 $k=\\pi/a$ 处的反演本征值满足 $\\xi_0, \\xi_{\\pi/a} \\in \\{+1, -1\\}$。在反演对称性下，原点元胞中的单带 Wannier 中心 $\\bar{x}$ 只能位于 $0$ 或 $a/2 \\pmod a$。其值由乘积 $\\xi_0\\xi_{\\pi/a}$ 确定：\n   - 如果 $\\xi_0\\xi_{\\pi/a}=+1$，那么 $\\bar{x}=0$。\n   - 如果 $\\xi_0\\xi_{\\pi/a}=-1$，那么 $\\bar{x}=a/2$。\n\n2. 我们可以写出一个统一的表达式来涵盖这两种情况：\n$$\n\\bar{x} = a \\frac{1 - \\xi_0\\xi_{\\pi/a}}{4}\n$$\n确实，对于 $\\xi_0\\xi_{\\pi/a}=+1$，此表达式给出 $\\bar{x}=0$，而对于 $\\xi_0\\xi_{\\pi/a}=-1$，它给出 $\\bar{x}=a/2$。", "answer": "$$\\boxed{\\frac{a}{4}(1 - \\xi_0 \\xi_{\\pi/a})}$$", "id": "1279665"}, {"introduction": "寻找最大局域瓦尼尔函数是一个优化问题，其核心在于“解开”布里渊区中布洛赫态的相位，使其尽可能平滑。由 Marzari 和 Vanderbilt 开发的标准算法中，一个核心环节是分析相邻 k 点之间的幺正交叠矩阵 $M^{(\\mathbf{k}, \\mathbf{b})}$。本练习 [@problem_id:1279731] 让您亲手实践此过程中的一个关键数学操作：计算矩阵对数。该操作被用来提取瓦尼尔中心的位置。", "problem": "在电子结构理论中，最大局域化瓦尼尔函数 (MLWFs) 提供了周期性固体中电子态的一种实空间表示。它们是由离域的布洛赫态 $|\\psi_{n\\mathbf{k}}\\rangle$ 构建的，其中 $n$ 是能带指数，$\\mathbf{k}$ 是布里渊区中的晶体动量。由 Marzari 和 Vanderbilt 发展的生成 MLWFs 的过程，涉及最小化瓦尼尔函数的总空间展宽。\n\n该过程中的一个关键对象是 k点间交叠矩阵，其矩阵元定义为 $M_{mn}^{(\\mathbf{k}, \\mathbf{b})} = \\langle u_{m\\mathbf{k}} | u_{n, \\mathbf{k}+\\mathbf{b}} \\rangle$。在这里， $|u_{n\\mathbf{k}}\\rangle = e^{-i\\mathbf{k}\\cdot\\mathbf{r}} |\\psi_{n\\mathbf{k}}\\rangle$ 是布洛赫函数的晶胞周期部分，$\\mathbf{b}$ 是连接布里渊区离散化网格中相邻 k 点的矢量。对于任何孤立的能带群，这些矩阵都是幺正的。\n\n瓦尼尔函数中心编码了局域轨道的位置，它是由这些交叠矩阵的本征值决定的。这需要计算矩阵对数 $L = \\ln M$。\n\n考虑一个简单的双能带模型，对于一个特定的 k 点 $\\mathbf{k}$ 及其相邻点 $\\mathbf{k}+\\mathbf{b}$，交叠矩阵由下式给出：\n$$\nM = \\begin{pmatrix} \\cos\\theta & i\\sin\\theta \\\\ i\\sin\\theta & \\cos\\theta \\end{pmatrix}\n$$\n其中 $\\theta$ 是一个由系统的哈密顿量和 k 点网格决定的实参数。\n\n你的任务是计算该矩阵对数的平方的迹，即 $\\mathrm{Tr}[(\\ln M)^2]$。使用复对数的主支，对于复数 $z = r e^{i\\phi}$，其定义为 $\\ln z = \\ln r + i\\phi$，其中 $-\\pi < \\phi \\le \\pi$。", "solution": "我们希望计算 $\\Tr[(\\ln M)^2]$，其中\n$$\nM = \\begin{pmatrix}\\cos\\theta & i\\sin\\theta\\\\i\\sin\\theta & \\cos\\theta\\end{pmatrix}.\n$$\n\n1.  $M$ 的本征值。\n    将 $M$ 写作\n$$\n    M = \\cos\\theta I + i\\sin\\theta \\sigma_x,\n$$\n    其中 $\\sigma_x$ 的本征值为 $\\pm1$。因此 $M$ 的本征值为\n$$\n    \\lambda_{\\pm} = \\cos\\theta \\pm i\\sin\\theta = e^{\\pm i\\theta}.\n$$\n\n2.  本征值的对数。\n    在 $-\\pi<\\theta\\le\\pi$ 的主支上，\n$$\n    \\ln\\lambda_{+} = \\ln(e^{i\\theta}) = i\\theta,\n    \\quad\n    \\ln\\lambda_{-} = \\ln(e^{-i\\theta}) = -i\\theta.\n$$\n\n3.  对数的平方。\n$$\n    (\\ln\\lambda_{\\pm})^2 = (\\pm i\\theta)^2 = -\\theta^2.\n$$\n\n4.  $(\\ln M)^2$ 的迹。\n    因为迹是 $(\\ln M)^2$ 的本征值之和，\n$$\n    \\Tr[(\\ln M)^2]\n    = (\\ln\\lambda_{+})^2 + (\\ln\\lambda_{-})^2\n    = -\\theta^2 + (-\\theta^2)\n    = -2\\theta^2.\n$$", "answer": "$$\\boxed{-2\\theta^2}$$", "id": "1279731"}]}