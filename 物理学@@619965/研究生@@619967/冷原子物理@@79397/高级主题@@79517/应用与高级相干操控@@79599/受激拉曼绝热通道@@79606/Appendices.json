{"hands_on_practices": [{"introduction": "要想真正掌握受激拉曼绝热通道（STIRAP）技术，我们首先需要理解其理想情况下的工作原理。这个基础练习旨在揭示STIRAP高效率背后的“魔法”：即“暗态”的存在。通过分析在反直觉脉冲序列下各量子态布居数的演化过程，你将建立一个清晰的物理图像，理解系统是如何在不布居中间损耗态的情况下，被引导着从初态转移到末态的 [@problem_id:2025912]。在进行更复杂的定量计算之前，这种定性理解是至关重要的第一步。", "problem": "一个原子系统用三个量子态来建模，记作 $|1\\rangle$、 $|2\\rangle$ 和 $|3\\rangle$。态 $|1\\rangle$ 和 $|3\\rangle$ 是长寿命、近简并的基态，而态 $|2\\rangle$ 是一个不稳定的激发态，形成一个所谓的 $\\Lambda$ 型系统。目标是将整个原子布居从态 $|1\\rangle$ 高效地转移到态 $|3\\rangle$。\n\n为实现这一目标，采用了一种称为受激拉曼绝热通道 (Stimulated Raman Adiabatic Passage, STIRAP) 的技术。该方法使用两个相干激光脉冲：一个“泵浦”脉冲，其具有时变拉比频率 $\\Omega_P(t)$，用于耦合态 $|1\\rangle$ 和 $|2\\rangle$；以及一个“斯托克斯”脉冲，其拉比频率为 $\\Omega_S(t)$，用于耦合态 $|2\\rangle$ 和 $|3\\rangle$。系统初始完全制备在态 $|1\\rangle$ 上。STIRAP 方案要求一个“反直觉”的脉冲序列，其中斯托克斯脉冲部分先于泵浦脉冲。\n\n设 $P_1(t)$、$P_2(t)$ 和 $P_3(t)$ 分别表示态 $|1\\rangle$、 $|2\\rangle$ 和 $|3\\rangle$ 上随时间变化的布居数。假设过程是理想的，意味着演化是完全绝热的，并且没有退相干或布居数损耗的来源。\n\n在这个理想的 STIRAP 过程中，下列哪个陈述最准确地描述了布居数的时间演化？\n\nA. 泵浦脉冲将布居从态 $|1\\rangle$ 转移到态 $|2\\rangle$，之后斯托克斯脉冲将布居从态 $|2\\rangle$ 转移到态 $|3\\rangle$。在某一中间时刻，布居几乎完全处于态 $|2\\rangle$。\n\nB. 布居从态 $|1\\rangle$ 相干地转移到态 $|3\\rangle$，使得态 $|2\\rangle$ 的布居在整个过程中保持为零。态 $|1\\rangle$ 的布居单调减少，而态 $|3\\rangle$ 的布居单调增加，直到转移完成。\n\nC. 系统经历涉及所有三个态的快速拉比振荡。布居数 $P_1(t)$、$P_2(t)$ 和 $P_3(t)$ 随时间显著振荡，并且未能实现到态 $|3\\rangle$ 的完全布居转移。\n\nD. 布居从态 $|1\\rangle$ 转移到态 $|3\\rangle$，但系统必须短暂地布居在态 $|2\\rangle$ 上才能发生转移。因此，在脉冲重叠区域，$P_2(t)$ 表现出一个瞬态的非零峰值，然后返回到零。", "solution": "我们在旋转波近似下，对精确双光子共振的三能级系统进行建模。在有序基 $\\{|1\\rangle,|2\\rangle,|3\\rangle\\}$ 中，且对于零单光子失谐，哈密顿量为\n$$\nH(t)=\\frac{\\hbar}{2}\\begin{pmatrix}\n0 & \\Omega_{P}(t) & 0\\\\\n\\Omega_{P}(t) & 0 & \\Omega_{S}(t)\\\\\n0 & \\Omega_{S}(t) & 0\n\\end{pmatrix}.\n$$\n我们寻找一个在 $|2\\rangle$ 上没有布居的瞬时本征态（即暗态）。作此拟设\n$$\n|D(t)\\rangle=\\cos\\theta(t)\\,|1\\rangle-\\sin\\theta(t)\\,|3\\rangle,\n$$\n其中混合角 $\\theta(t)$ 待定。将 $H(t)$ 作用于 $|D(t)\\rangle$ 得到\n$$\nH(t)|D(t)\\rangle=\\frac{\\hbar}{2}\\left[\\Omega_{P}(t)\\cos\\theta(t)-\\Omega_{S}(t)\\sin\\theta(t)\\right]|2\\rangle.\n$$\n要求 $|D(t)\\rangle$ 是一个在 $|2\\rangle$ 上投影为零的本征态，这意味着\n$$\n\\Omega_{P}(t)\\cos\\theta(t)-\\Omega_{S}(t)\\sin\\theta(t)=0\\quad\\Rightarrow\\quad \\tan\\theta(t)=\\frac{\\Omega_{P}(t)}{\\Omega_{S}(t)}.\n$$\n因此， $|D(t)\\rangle$ 是一个本征值为零的本征态（暗态），其在 $|2\\rangle$ 上的振幅恒为零。\n\n根据绝热定理，如果系统初始制备在 $|D(t_{i})\\rangle$ 上，并且参数 $\\Omega_{P}(t)$ 和 $\\Omega_{S}(t)$ 变化得足够缓慢以满足绝热条件\n$$\n|\\dot{\\theta}(t)|\\ll \\Omega_{\\text{eff}}(t),\\quad \\Omega_{\\text{eff}}(t)=\\sqrt{\\Omega_{P}^{2}(t)+\\Omega_{S}^{2}(t)},\n$$\n那么态矢量将保持在 $|D(t)\\rangle$ 上（相差一个相位），而不会布居到正交的本征态上。\n\n对于 STIRAP 的反直觉序列，斯托克斯脉冲先于泵浦脉冲，因此初始时 $\\Omega_{P}(t_{i})=0$ 而 $\\Omega_{S}(t_{i})\\neq 0$。因此\n$$\n\\tan\\theta(t_{i})=0\\;\\Rightarrow\\;\\theta(t_{i})=0\\;\\Rightarrow\\;|D(t_{i})\\rangle=|1\\rangle,\n$$\n这与初始制备相符。在序列结束时，场的设置使得 $\\Omega_{S}(t_{f})\\to 0$ 而 $\\Omega_{P}(t_{f})\\neq 0$，从而得到\n$$\n\\tan\\theta(t_{f})\\to \\infty\\;\\Rightarrow\\;\\theta(t_{f})\\to \\frac{\\pi}{2}\\;\\Rightarrow\\;|D(t_{f})\\rangle=-|3\\rangle.\n$$\n因此，在理想的绝热跟随下，随时间变化的布居数为\n$$\nP_{1}(t)=|\\langle 1|D(t)\\rangle|^{2}=\\cos^{2}\\theta(t),\\quad P_{3}(t)=|\\langle 3|D(t)\\rangle|^{2}=\\sin^{2}\\theta(t),\\quad P_{2}(t)=|\\langle 2|D(t)\\rangle|^{2}=0,\n$$\n在反直觉的脉冲顺序下，$\\theta(t)$ 从 $0$ 单调地变为 $\\pi/2$。因此，$P_{1}(t)$ 从 $1$ 单调减少到 $0$，$P_{3}(t)$ 从 $0$ 单调增加到 $1$，而 $P_{2}(t)$ 在整个过程中保持为零。\n\n这与陈述 B 相符。陈述 A 和 D 错误地断言 $|2\\rangle$ 中存在瞬态布居，这在理想（完全绝热、无退相干）的极限下是不存在的。陈述 C 描述了非绝热动力学，这与理想的 STIRAP 不兼容，并且不会产生完全的转移。", "answer": "$$\\boxed{B}$$", "id": "2025912"}, {"introduction": "在理想STIRAP概念的基础上，我们现在来解决一个非标准条件下的定量问题。本练习考虑一个特殊情况：泵浦光和斯托克斯光脉冲被同时施加，这使得系统从一开始就演化为多个“缀饰态”的叠加态。通过解析求解动力学过程，你将计算最终的布居转移效率，并亲眼见证当经典的绝热条件不被满足时，量子干涉如何决定最终结果 [@problem_id:1269145]。这个练习将锻炼你直接使用哈密顿量及其本征系统来预测量子演化的能力。", "problem": "一个三能级原子，其能级态 $|1\\rangle$、 $|2\\rangle$ 和 $|3\\rangle$ 排列成 $\\Lambda$ 型组态，用于通过受激拉曼绝热通道 (Stimulated Raman Adiabatic Passage, STIRAP) 实现从态 $|1\\rangle$ 到态 $|3\\rangle$ 的布居数转移。跃迁 $|1\\rangle \\leftrightarrow |2\\rangle$ 由具有时变拉比频率 $\\Omega_P(t)$ 的泵浦光驱动，跃迁 $|2\\rangle \\leftrightarrow |3\\rangle$ 由具有拉比频率 $\\Omega_S(t)$ 的斯托克斯光驱动。\n\n在旋转波近似 (RWA) 下，该系统的哈密顿量为：\n$$\nH(t) = \\frac{\\hbar}{2}\n\\begin{pmatrix}\n0 & \\Omega_P(t) & 0 \\\\\n\\Omega_P(t) & -2\\Delta & \\Omega_S(t) \\\\\n0 & \\Omega_S(t) & 0\n\\end{pmatrix}\n$$\n其中 $\\Delta$ 是相对于激发态 $|2\\rangle$ 的单光子失谐。我们假设系统处于双光子共振状态。\n\n考虑一个非标准的 STIRAP 情景，其中单光子失谐为零 ($\\Delta=0$)，并且泵浦光脉冲和斯托克斯光脉冲以相同的、随时间变化的形状同时施加。即，在所有时间 $t$，都有 $\\Omega_P(t) = \\Omega_S(t) = \\Omega(t)$。脉冲 $\\Omega(t)$ 仅在有限的时间区间内非零，其形状使得总脉冲面积为 $A = \\int_{-\\infty}^{\\infty} \\Omega(t') dt'$。\n\n在 $t \\to -\\infty$ 时，原子初始处于基态 $|1\\rangle$，即 $|\\psi(-\\infty)\\rangle = |1\\rangle$。\n\n计算向态 $|3\\rangle$ 的最终布居数转移效率，定义为 $P_3 = |\\langle 3|\\psi(+\\infty) \\rangle|^2$。请将您的答案表示为总脉冲面积 $A$ 的函数。", "solution": "该问题要求在特定的脉冲条件下，计算三能级系统中态 $|3\\rangle$ 的最终布居数。\n\n1.  **简化哈密顿量：**\n    在 $\\Delta=0$ 和 $\\Omega_P(t) = \\Omega_S(t) = \\Omega(t)$ 的条件下，哈密顿量变为：\n    $$\n    H(t) = \\frac{\\hbar \\Omega(t)}{2}\n    \\begin{pmatrix}\n    0 & 1 & 0 \\\\\n    1 & 0 & 1 \\\\\n    0 & 1 & 0\n    \\end{pmatrix}\n    $$\n    该哈密顿量可以写成 $H(t) = \\Omega(t) H_0$，其中 $H_0 = \\frac{\\hbar}{2} \\begin{pmatrix} 0 & 1 & 0 \\\\ 1 & 0 & 1 \\\\ 0 & 1 & 0 \\end{pmatrix}$ 是一个不含时的矩阵。\n\n2.  **求解本征态和本征值：**\n    由于哈密顿量 $H_0$ 的矩阵形式是不含时的，其本征矢量（“缀饰态”）也是不含时的。本征值将与 $\\Omega(t)$ 成正比。我们通过求解特征方程 $\\det(H_0 - \\frac{E}{\\Omega(t)} I) = 0$ 来寻找本征值 $E$。令 $\\lambda = E / (\\hbar \\Omega(t))$。\n    $$\n    \\det \\begin{pmatrix}\n    -\\frac{\\lambda\\hbar}{2} & \\hbar/2 & 0 \\\\\n    \\hbar/2 & -\\frac{\\lambda\\hbar}{2} & \\hbar/2 \\\\\n    0 & \\hbar/2 & -\\frac{\\lambda\\hbar}{2}\n    \\end{pmatrix} = \\left(\\frac{\\hbar}{2}\\right)^3 \\det \\begin{pmatrix}\n    -\\lambda & 1 & 0 \\\\\n    1 & -\\lambda & 1 \\\\\n    0 & 1 & -\\lambda\n    \\end{pmatrix} = 0\n    $$\n    $-\\lambda(\\lambda^2 - 1) - 1(-\\lambda) = 0$\n    $-\\lambda^3 + \\lambda + \\lambda = 0 \\implies \\lambda^3 - 2\\lambda = 0$\n    $\\lambda(\\lambda^2 - 2) = 0$。\n    解为 $\\lambda_0 = 0$、$\\lambda_+ = \\sqrt{2}$ 和 $\\lambda_- = -\\sqrt{2}$。\n    对应的含时本征值为：\n    $E_0(t) = 0$\n    $E_+(t) = \\frac{\\hbar\\Omega(t)}{\\sqrt{2}}$\n    $E_-(t) = -\\frac{\\hbar\\Omega(t)}{\\sqrt{2}}$\n\n    现在，我们求解相应的归一化本征矢量 $|\\psi_0\\rangle$、$|\\psi_+\\rangle$ 和 $|\\psi_-\\rangle$。\n    对于 $E_0=0$（暗态）：\n    $H_0 \\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix} = 0 \\implies c_2=0, c_1+c_3=0$。\n    归一化后， $|\\psi_0\\rangle = \\frac{1}{\\sqrt{2}}(|1\\rangle - |3\\rangle)$。\n\n    对于 $E_+ = \\hbar\\Omega(t)/\\sqrt{2}$：\n    $H_0 \\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix} = \\frac{\\hbar\\Omega(t)}{\\sqrt{2}} \\frac{1}{\\Omega(t)} \\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix} = \\frac{\\hbar}{\\sqrt{2}} \\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix}$。\n    $\\frac{\\hbar}{2} c_2 = \\frac{\\hbar}{\\sqrt{2}} c_1 \\implies c_2 = \\sqrt{2}c_1$。\n    $\\frac{\\hbar}{2} (c_1+c_3) = \\frac{\\hbar}{\\sqrt{2}} c_2 = \\hbar c_1 \\implies c_1+c_3 = 2c_1 \\implies c_3=c_1$。\n    本征矢量与 $(1, \\sqrt{2}, 1)^T$ 成正比。归一化后：$|\\psi_+\\rangle = \\frac{1}{2}(|1\\rangle + \\sqrt{2}|2\\rangle + |3\\rangle)$。\n\n    对于 $E_- = -\\hbar\\Omega(t)/\\sqrt{2}$：\n    类似的计算可得 $c_2 = -\\sqrt{2}c_1$ 和 $c_3=c_1$。\n    本征矢量与 $(1, -\\sqrt{2}, 1)^T$ 成正比。归一化后：$|\\psi_-\\rangle = \\frac{1}{2}(|1\\rangle - \\sqrt{2}|2\\rangle + |3\\rangle)$。\n\n3.  **分解初始态：**\n    系统初始处于 $|\\psi(-\\infty)\\rangle = |1\\rangle$。我们将其投影到不含时的本征基上：\n    $|1\\rangle = \\alpha_0|\\psi_0\\rangle + \\alpha_+|\\psi_+\\rangle + \\alpha_-|\\psi_-\\rangle$。\n    $\\alpha_0 = \\langle\\psi_0|1\\rangle = \\frac{1}{\\sqrt{2}}$。\n    $\\alpha_+ = \\langle\\psi_+|1\\rangle = \\frac{1}{2}$。\n    $\\alpha_- = \\langle\\psi_-|1\\rangle = \\frac{1}{2}$。\n    因此，初始态为 $|\\psi(-\\infty)\\rangle = \\frac{1}{\\sqrt{2}}|\\psi_0\\rangle + \\frac{1}{2}|\\psi_+\\rangle + \\frac{1}{2}|\\psi_-\\rangle$。\n\n4.  **时间演化：**\n    由于缀饰态是不含时的，薛定谔方程 $i\\hbar \\frac{d}{dt}|\\psi(t)\\rangle = H(t)|\\psi(t)\\rangle$ 的解是演化本征态的直接叠加。一个本征态 $|\\psi_k\\rangle$ 按 $|\\psi_k(t)\\rangle = \\exp\\left(-\\frac{i}{\\hbar}\\int_{-\\infty}^t E_k(t') dt'\\right)|\\psi_k\\rangle$ 演化。\n    在 $t \\to +\\infty$ 时的状态为：\n    $$\n    |\\psi(+\\infty)\\rangle = \\alpha_0 e^{-\\frac{i}{\\hbar}\\int_{-\\infty}^\\infty E_0 dt'}|\\psi_0\\rangle + \\alpha_+ e^{-\\frac{i}{\\hbar}\\int_{-\\infty}^\\infty E_+(t') dt'}|\\psi_+\\rangle + \\alpha_- e^{-\\frac{i}{\\hbar}\\int_{-\\infty}^\\infty E_-(t') dt'}|\\psi_-\\rangle\n    $$\n    相位积分为：\n    $\\int_{-\\infty}^\\infty E_0(t') dt' = 0$。\n    $\\int_{-\\infty}^\\infty E_\\pm(t') dt' = \\pm \\frac{\\hbar}{\\sqrt{2}}\\int_{-\\infty}^\\infty \\Omega(t') dt' = \\pm \\frac{\\hbar A}{\\sqrt{2}}$。\n    将这些代入 $|\\psi(+\\infty)\\rangle$ 的表达式中：\n    $$\n    |\\psi(+\\infty)\\rangle = \\frac{1}{\\sqrt{2}}|\\psi_0\\rangle + \\frac{1}{2} e^{-i A/\\sqrt{2}} |\\psi_+\\rangle + \\frac{1}{2} e^{i A/\\sqrt{2}} |\\psi_-\\rangle\n    $$\n\n5.  **计算态 |3> 的最终布居数：**\n    我们需要计算 $P_3 = |\\langle 3|\\psi(+\\infty) \\rangle|^2$。首先，我们求出幅值 $\\langle 3|\\psi(+\\infty) \\rangle$。\n    $\\langle 3|\\psi_0\\rangle = -1/\\sqrt{2}$\n    $\\langle 3|\\psi_+\\rangle = 1/2$\n    $\\langle 3|\\psi_-\\rangle = 1/2$\n    $$\n    \\langle 3|\\psi(+\\infty) \\rangle = \\frac{1}{\\sqrt{2}}\\langle 3|\\psi_0\\rangle + \\frac{1}{2} e^{-i A/\\sqrt{2}} \\langle 3|\\psi_+\\rangle + \\frac{1}{2} e^{i A/\\sqrt{2}} \\langle 3|\\psi_-\\rangle\n    $$\n    $$\n    \\langle 3|\\psi(+\\infty) \\rangle = \\frac{1}{\\sqrt{2}}\\left(-\\frac{1}{\\sqrt{2}}\\right) + \\frac{1}{2} e^{-i A/\\sqrt{2}} \\left(\\frac{1}{2}\\right) + \\frac{1}{2} e^{i A/\\sqrt{2}} \\left(\\frac{1}{2}\\right)\n    $$\n    $$\n    \\langle 3|\\psi(+\\infty) \\rangle = -\\frac{1}{2} + \\frac{1}{4}\\left(e^{-i A/\\sqrt{2}} + e^{i A/\\sqrt{2}}\\right)\n    $$\n    使用欧拉公式 $\\cos(x) = (e^{ix}+e^{-ix})/2$：\n    $$\n    \\langle 3|\\psi(+\\infty) \\rangle = -\\frac{1}{2} + \\frac{1}{2}\\cos\\left(\\frac{A}{\\sqrt{2}}\\right) = \\frac{1}{2}\\left(\\cos\\left(\\frac{A}{\\sqrt{2}}\\right) - 1\\right)\n    $$\n    现在我们计算概率 $P_3$：\n    $$\n    P_3 = \\left| \\frac{1}{2}\\left(\\cos\\left(\\frac{A}{\\sqrt{2}}\\right) - 1\\right) \\right|^2 = \\frac{1}{4}\\left(1 - \\cos\\left(\\frac{A}{\\sqrt{2}}\\right)\\right)^2\n    $$\n    使用半角恒等式 $1-\\cos(x) = 2\\sin^2(x/2)$：\n    $$\n    P_3 = \\frac{1}{4}\\left(2\\sin^2\\left(\\frac{A}{2\\sqrt{2}}\\right)\\right)^2 = \\frac{1}{4} \\left(4\\sin^4\\left(\\frac{A}{2\\sqrt{2}}\\right)\\right)\n    $$\n    $$\n    P_3 = \\sin^4\\left(\\frac{A}{2\\sqrt{2}}\\right)\n    $$\n    这就是最终的布居数转移效率。", "answer": "$$\n\\boxed{\\sin^4\\left(\\frac{A}{2\\sqrt{2}}\\right)}\n$$", "id": "1269145"}, {"introduction": "最后的实践将连接理论与计算模拟的现实，让你能从零开始构建STIRAP过程的模型。在这个练习中，你将编写一个程序来数值求解三能级系统的含时薛定谔方程。通过实现一个可靠的时间演化算法，你可以研究各种实验参数——例如脉冲顺序、脉冲宽度和失谐——对转移效率的影响 [@problem_id:2421268]。这个综合性项目不仅巩固了你对底层物理的理解，还为你掌握现代量子控制研究所需的核心计算技能。", "problem": "您需要编写一个完整、可运行的程序，对经历受激拉曼绝热通道 (Stimulated Raman Adiabatic Passage, STIRAP) 的三能级量子系统，进行时间相关薛定谔方程的数值求解。目标是计算在几组不同参数下，转移到目标态的最终布居数。您必须使用基于原理的时间相关哈密顿量描述以及保范数的时间步进方案。\n\n从基本定律出发，态矢量根据时间相关薛定谔方程演化\n$$\ni\\hbar \\frac{d}{dt}\\,|\\psi(t)\\rangle = \\hat{H}(t)\\,|\\psi(t)\\rangle .\n$$\n在单位制中，将约化普朗克常数设为1，即令 $\\hbar = 1$，因此控制方程为\n$$\ni \\frac{d}{dt}\\,|\\psi(t)\\rangle = \\hat{H}(t)\\,|\\psi(t)\\rangle .\n$$\n考虑一个具有基态 $|1\\rangle$、$|2\\rangle$ 和 $|3\\rangle$ 的 Lambda (Λ) 型三能级系统。在旋转波近似 (Rotating Wave Approximation, RWA) 下，并在一个已移除快速振荡项的参考系中，哈密顿量可表示为\n$$\n\\hat{H}(t) =\n\\begin{pmatrix}\n0 & \\Omega_{\\mathrm{p}}(t)/2 & 0 \\\\\n\\Omega_{\\mathrm{p}}(t)/2 & \\Delta & \\Omega_{\\mathrm{s}}(t)/2 \\\\\n0 & \\Omega_{\\mathrm{s}}(t)/2 & \\delta\n\\end{pmatrix},\n$$\n其中 $\\Omega_{\\mathrm{p}}(t)$ 是耦合 $|1\\rangle \\leftrightarrow |2\\rangle$ 的泵浦拉比频率，$\\Omega_{\\mathrm{s}}(t)$ 是耦合 $|3\\rangle \\leftrightarrow |2\\rangle$ 的斯托克斯拉比频率，$\\Delta$ 是中间态 $|2\\rangle$ 的单光子失谐，$\\delta$ 是 $|1\\rangle$ 与 $|3\\rangle$ 之间的双光子失谐。拉比频率是含时的高斯脉冲，\n$$\n\\Omega_{\\mathrm{p}}(t) = \\Omega_{0}\\,\\exp\\!\\left(-\\frac{(t - t_{\\mathrm{p}})^2}{2\\sigma^2}\\right), \\quad\n\\Omega_{\\mathrm{s}}(t) = \\Omega_{0}\\,\\exp\\!\\left(-\\frac{(t - t_{\\mathrm{s}})^2}{2\\sigma^2}\\right),\n$$\n其峰值振幅同为 $\\Omega_{0}$，时间宽度为 $\\sigma$，脉冲中心分别为 $t_{\\mathrm{p}}$ 和 $t_{\\mathrm{s}}$。在反直觉的 STIRAP 序列中，斯托克斯脉冲先于泵浦脉冲，即 $t_{\\mathrm{s}} < t_{\\mathrm{p}}$。\n\n您必须：\n- 使用一种基于哈密顿量在每个时间步长中点处求值的矩阵指数的幺正、保范数时间步进方案，通过数值积分时间相关薛定谔方程来显式地演化态矢量。也就是说，在一个从 $t$ 到 $t+\\Delta t$ 的小时间步长 $\\Delta t$ 内，使用\n$$\n|\\psi(t+\\Delta t)\\rangle \\approx \\exp\\!\\left(-i\\, \\hat{H}\\!\\left(t+\\frac{\\Delta t}{2}\\right)\\,\\Delta t\\right)\\,|\\psi(t)\\rangle .\n$$\n- 在 $t=t_{0}$ 时将系统初始化在态 $|1\\rangle$ 上，即 $|\\psi(t_{0})\\rangle = (1,0,0)^{\\mathsf{T}}$。\n- 对 $\\Omega_{0}$、$\\Delta$ 和 $\\delta$ 使用以弧度每秒为单位的角频率，对时间相关量使用秒为单位。所有计算必须统一使用这些单位。\n- 选择一个足够宽的总模拟区间 $[t_{0},t_{\\mathrm{f}}]$，以确保两个脉冲在区间端点处均可忽略。一个鲁棒的选择是 $t_{0} = -6\\sigma - \\frac{\\tau}{2}$ 和 $t_{\\mathrm{f}} = +6\\sigma + \\frac{\\tau}{2}$，其中 $\\tau = |t_{\\mathrm{p}} - t_{\\mathrm{s}}|$ 是脉冲间隔。使用一个足够小的固定时间步长 $\\Delta t$，以解析脉冲包络和最快的相干动力学过程。\n\n您的程序必须实现以下参数集的测试套件。在每种情况下，以浮点数形式报告在态 $|3\\rangle$ 上的最终布居数 $P_{3}(t_{\\mathrm{f}}) = |\\langle 3|\\psi(t_{\\mathrm{f}})\\rangle|^{2}$。请使用指定的单位和定义。\n\n所有测试的通用定义：\n- 设高斯宽度为 $\\sigma$，具体值依情况而定。\n- 设脉冲间隔为 $\\tau = 2\\sigma$。\n- 对于反直觉顺序，设 $t_{\\mathrm{s}} = -\\tau/2$ 且 $t_{\\mathrm{p}} = +\\tau/2$。\n- 对于直觉顺序，设 $t_{\\mathrm{p}} = -\\tau/2$ 且 $t_{\\mathrm{s}} = +\\tau/2$。\n- 使用满足 $\\Delta t \\le \\min\\!\\left(\\frac{\\sigma}{200}, \\frac{1}{20\\,\\Omega_{0}}\\right)$ 的固定步长 $\\Delta t$。\n\n需要实现的测试用例：\n- 用例 1（表现良好的 STIRAP）：$\\Omega_{0} = 2\\pi \\times 15\\times 10^{6}\\ \\mathrm{rad/s}$，$\\sigma = 25\\times 10^{-9}\\ \\mathrm{s}$，反直觉顺序，$\\Delta = 0$，$\\delta = 0$。\n- 用例 2（直觉顺序，转移效果差）：与用例 1 相同，但为直觉顺序。\n- 用例 3（因脉冲过短导致非绝热）：$\\Omega_{0} = 2\\pi \\times 15\\times 10^{6}\\ \\mathrm{rad/s}$，$\\sigma = 5\\times 10^{-9}\\ \\mathrm{s}$，反直觉顺序，$\\Delta = 0$，$\\delta = 0$。\n- 用例 4（单光子失谐鲁棒性）：$\\Omega_{0} = 2\\pi \\times 15\\times 10^{6}\\ \\mathrm{rad/s}$，$\\sigma = 25\\times 10^{-9}\\ \\mathrm{s}$，反直觉顺序，$\\Delta = 2\\pi \\times 50\\times 10^{6}\\ \\mathrm{rad/s}$，$\\delta = 0$。\n- 用例 5（双光子失谐敏感性）：$\\Omega_{0} = 2\\pi \\times 15\\times 10^{6}\\ \\mathrm{rad/s}$，$\\sigma = 25\\times 10^{-9}\\ \\mathrm{s}$，反直觉顺序，$\\Delta = 0$，$\\delta = 2\\pi \\times 5\\times 10^{6}\\ \\mathrm{rad/s}$。\n\n角度单位（如果考虑任何相位）必须是弧度。所有物理量都应以指定的单位处理。\n\n所需输出：\n- 您的程序应生成单行输出，其中包含按顺序排列的用例 1 到 5 的最终布居数 $P_{3}(t_{\\mathrm{f}})$，每个值都四舍五入到恰好六位小数，形式为用方括号括起来的逗号分隔列表。例如，输出格式为 $[0.999500,0.010000,0.450000,0.980000,0.600000]$。\n\n您的解决方案必须是一个单一、完整的程序。它不能要求任何用户输入或外部文件。它必须使用基于上述原理的严谨数值方法。最终答案是单位区间 $\\left[0,1\\right]$ 内的无量纲布居数，表示为四舍五入到六位小数的小数。", "solution": "问题陈述已经过严格的验证过程。\n\n**第一步：提取已知条件**\n- **控制方程**：$i \\frac{d}{dt}\\,|\\psi(t)\\rangle = \\hat{H}(t)\\,|\\psi(t)\\rangle$，其中 $\\hbar = 1$。\n- **哈密顿量**：\n$$\n\\hat{H}(t) =\n\\begin{pmatrix}\n0 & \\Omega_{\\mathrm{p}}(t)/2 & 0 \\\\\n\\Omega_{\\mathrm{p}}(t)/2 & \\Delta & \\Omega_{\\mathrm{s}}(t)/2 \\\\\n0 & \\Omega_{\\mathrm{s}}(t)/2 & \\delta\n\\end{pmatrix}\n$$\n- **拉比频率**：$\\Omega_{\\mathrm{p}}(t) = \\Omega_{0}\\,\\exp\\!\\left(-\\frac{(t - t_{\\mathrm{p}})^2}{2\\sigma^2}\\right)$，$\\Omega_{\\mathrm{s}}(t) = \\Omega_{0}\\,\\exp\\!\\left(-\\frac{(t - t_{\\mathrm{s}})^2}{2\\sigma^2}\\right)$。\n- **初始条件**：$|\\psi(t_{0})\\rangle = (1,0,0)^{\\mathsf{T}}$。\n- **数值方法**：$|\\psi(t+\\Delta t)\\rangle \\approx \\exp\\!\\left(-i\\, \\hat{H}\\!\\left(t+\\frac{\\Delta t}{2}\\right)\\,\\Delta t\\right)\\,|\\psi(t)\\rangle$。\n- **模拟时间区间**：$[t_{0}, t_{\\mathrm{f}}]$，其中 $t_{0} = -6\\sigma - \\frac{\\tau}{2}$ 且 $t_{\\mathrm{f}} = +6\\sigma + \\frac{\\tau}{2}$，$\\tau = |t_{\\mathrm{p}} - t_{\\mathrm{s}}|$。\n- **时间步长**：$\\Delta t \\le \\min\\!\\left(\\frac{\\sigma}{200}, \\frac{1}{20\\,\\Omega_{0}}\\right)$。\n- **脉冲时序**：$\\tau = 2\\sigma$。反直觉：$t_{\\mathrm{s}} = -\\tau/2$，$t_{\\mathrm{p}} = +\\tau/2$。直觉：$t_{\\mathrm{p}} = -\\tau/2$，$t_{\\mathrm{s}} = +\\tau/2$。\n- **测试用例**：\n    1. 用例 1：$\\Omega_{0} = 2\\pi \\times 15 \\times 10^{6}\\ \\mathrm{rad/s}$，$\\sigma = 25 \\times 10^{-9}\\ \\mathrm{s}$，反直觉，$\\Delta = 0$，$\\delta = 0$。\n    2. 用例 2：与用例 1 相同，但为直觉顺序。\n    3. 用例 3：$\\Omega_{0} = 2\\pi \\times 15 \\times 10^{6}\\ \\mathrm{rad/s}$，$\\sigma = 5 \\times 10^{-9}\\ \\mathrm{s}$，反直觉，$\\Delta = 0$，$\\delta = 0$。\n    4. 用例 4：$\\Omega_{0} = 2\\pi \\times 15 \\times 10^{6}\\ \\mathrm{rad/s}$，$\\sigma = 25 \\times 10^{-9}\\ \\mathrm{s}$，反直觉，$\\Delta = 2\\pi \\times 50 \\times 10^{6}\\ \\mathrm{rad/s}$，$\\delta = 0$。\n    5. 用例 5：$\\Omega_{0} = 2\\pi \\times 15 \\times 10^{6}\\ \\mathrm{rad/s}$，$\\sigma = 25 \\times 10^{-9}\\ \\mathrm{s}$，反直觉，$\\Delta = 0$，$\\delta = 2\\pi \\times 5 \\times 10^{6}\\ \\mathrm{rad/s}$。\n- **所需输出**：各用例的最终布居数 $P_{3}(t_{\\mathrm{f}}) = |\\langle 3|\\psi(t_{\\mathrm{f}})\\rangle|^{2}$，四舍五入到六位小数，以指定的列表格式表示。\n\n**第二步：验证结论**\n该问题具有科学依据，提法恰当，客观且自包含。它描述了计算量子物理学中的一个标准问题，并明确指定了所有必要的参数和方法。没有逻辑矛盾、事实错误或含糊之处。参数值对于原子系统是物理上现实的。\n\n**结论：该问题有效。**\n\n我们继续进行求解。任务是积分时间相关薛定谔方程，这是一个关于态矢量 $|\\psi(t)\\rangle$ 的一阶线性常微分方程：\n$$\n\\frac{d}{dt}|\\psi(t)\\rangle = -i \\hat{H}(t)|\\psi(t)\\rangle\n$$\n在从 $t$ 到 $t+\\Delta t$ 的时间区间内，其形式解由 $|\\psi(t+\\Delta t)\\rangle = \\hat{U}(t+\\Delta t, t)|\\psi(t)\\rangle$ 给出，其中 $\\hat{U}(t+\\Delta t, t)$ 是时间演化算符。对于含时哈密顿量，该算符由时间排序指数 $\\hat{U}(t+\\Delta t, t) = \\mathcal{T} \\exp(-i \\int_t^{t+\\Delta t} \\hat{H}(t') dt')$ 给出。\n\n问题指定了对传播算符的一种特定近似，该近似等效于二阶 Magnus 展开或在积分内对哈密顿量应用中点法则：\n$$\n\\int_t^{t+\\Delta t} \\hat{H}(t') dt' \\approx \\hat{H}\\left(t+\\frac{\\Delta t}{2}\\right) \\Delta t\n$$\n这得到了以下时间步进公式：\n$$\n|\\psi(t+\\Delta t)\\rangle \\approx \\exp\\left(-i \\hat{H}\\left(t+\\frac{\\Delta t}{2}\\right) \\Delta t\\right) |\\psi(t)\\rangle\n$$\n该传播算符是幺正的，这保证了态矢量的范数 $||\\psi(t)||^2$ 在整个模拟过程中是守恒的。这是一个关键的物理要求，因为总概率必须保持为 1。\n\n算法实现如下：\n1.  **初始化**：为给定的测试用例定义系统参数（$\\Omega_0$、$\\sigma$、$\\Delta$、$\\delta$ 及脉冲顺序）。根据这些参数，按照指定公式计算脉冲时序 $t_{\\mathrm{p}}$ 和 $t_{\\mathrm{s}}$、模拟区间 $[t_0, t_f]$以及时间步长 $\\Delta t$。将态矢量初始化在态 $|1\\rangle$ 上，表示为列矢量 $|\\psi(t_0)\\rangle = [1, 0, 0]^{\\mathsf{T}}$。\n\n2.  **离散化**：将时间区间 $[t_0, t_f]$ 离散化为一系列点 $t_k = t_0 + k \\Delta t$，其中 $k = 0, 1, 2, \\dots, N-1$，且 $N \\Delta t \\approx t_f - t_0$。\n\n3.  **时间演化**：迭代演化态矢量。对于从时间 $t_k$ 到 $t_{k+1} = t_k + \\Delta t$ 的每一步：\n    a. 计算中点时间 $t_{k+1/2} = t_k + \\Delta t/2$。\n    b. 计算含时拉比频率 $\\Omega_{\\mathrm{p}}(t_{k+1/2})$ 和 $\\Omega_{\\mathrm{s}}(t_{k+1/2})$。\n    c. 使用这些频率和给定的失谐量 $\\Delta$ 和 $\\delta$ 构建哈密顿矩阵 $\\hat{H}(t_{k+1/2})$。\n    d. 使用矩阵指数函数计算该步骤的幺正演化算符 $\\hat{U}_k = \\exp(-i \\hat{H}(t_{k+1/2}) \\Delta t)$。这是该步骤中计算量最大的部分。\n    e. 更新态矢量：$|\\psi(t_{k+1})\\rangle = \\hat{U}_k |\\psi(t_k)\\rangle$。\n\n4.  **最终测量**：在最后一个时间步之后，模拟得到最终时刻的态矢量 $|\\psi(t_f)\\rangle = [c_1(t_f), c_2(t_f), c_3(t_f)]^{\\mathsf{T}}$。然后计算所需输出，即态 $|3\\rangle$ 上的布居数，为其振幅的模平方：$P_3(t_f) = |c_3(t_f)|^2$。\n\n对所有五个测试用例重复此过程。将得到的最终布居数按指定格式进行格式化。该实现使用能够高效处理复数矩阵代数和矩阵指数运算的数值库。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Main function to solve the STIRAP problem for all test cases.\n    \"\"\"\n\n    def run_simulation(omega0, sigma, pulse_order, delta_one_photon, delta_two_photon):\n        \"\"\"\n        Numerically solves the TDSE for a single STIRAP parameter set.\n\n        Args:\n            omega0 (float): Peak Rabi frequency in rad/s.\n            sigma (float): Temporal width of Gaussian pulses in s.\n            pulse_order (str): 'counter-intuitive' or 'intuitive'.\n            delta_one_photon (float): One-photon detuning Delta in rad/s.\n            delta_two_photon (float): Two-photon detuning delta in rad/s.\n\n        Returns:\n            float: Final population in state |3>.\n        \"\"\"\n        # Define pulse separation and centers\n        tau = 2.0 * sigma\n        if pulse_order == 'counter-intuitive':\n            t_s = -tau / 2.0\n            t_p = tau / 2.0\n        elif pulse_order == 'intuitive':\n            t_p = -tau / 2.0\n            t_s = tau / 2.0\n        else:\n            raise ValueError(\"Invalid pulse_order specified.\")\n\n        # Set up simulation time grid\n        t0 = -6.0 * sigma - tau / 2.0\n        tf = 6.0 * sigma + tau / 2.0\n        dt = min(sigma / 200.0, 1.0 / (20.0 * omega0))\n        time_points = np.arange(t0, tf, dt)\n\n        # Initialize state vector |psi(t0)> = |1> = [1, 0, 0]^T\n        psi = np.array([1.0, 0.0, 0.0], dtype=np.complex128)\n\n        # Define Gaussian pulse shapes for pump and Stokes lasers\n        def omega_p(t):\n            return omega0 * np.exp(-(t - t_p)**2 / (2.0 * sigma**2))\n\n        def omega_s(t):\n            return omega0 * np.exp(-(t - t_s)**2 / (2.0 * sigma**2))\n\n        # Main time-stepping loop\n        for t in time_points:\n            t_mid = t + dt / 2.0\n\n            # Evaluate Rabi frequencies at the midpoint of the time step\n            omega_p_mid = omega_p(t_mid)\n            omega_s_mid = omega_s(t_mid)\n\n            # Construct the Hamiltonian matrix at the midpoint\n            h_mid = np.array([\n                [0.0, omega_p_mid / 2.0, 0.0],\n                [omega_p_mid / 2.0, delta_one_photon, omega_s_mid / 2.0],\n                [0.0, omega_s_mid / 2.0, delta_two_photon]\n            ], dtype=np.complex128)\n\n            # Compute the unitary time-evolution operator using matrix exponential\n            U = expm(-1j * h_mid * dt)\n\n            # Update the state vector\n            psi = U @ psi\n\n        # Calculate the final population in state |3>\n        p3_final = np.abs(psi[2])**2\n        return p3_final\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (well-behaved STIRAP): Omega0=2pi*15MHz, sigma=25ns, counter-intuitive, Delta=0, delta=0\n        {'omega0': 2.0 * np.pi * 15e6, 'sigma': 25e-9, 'pulse_order': 'counter-intuitive', 'delta_one_photon': 0.0, 'delta_two_photon': 0.0},\n        # Case 2 (intuitive ordering, poor transfer): same as Case 1 but intuitive\n        {'omega0': 2.0 * np.pi * 15e6, 'sigma': 25e-9, 'pulse_order': 'intuitive', 'delta_one_photon': 0.0, 'delta_two_photon': 0.0},\n        # Case 3 (non-adiabatic due to short pulses): Omega0=2pi*15MHz, sigma=5ns, counter-intuitive\n        {'omega0': 2.0 * np.pi * 15e6, 'sigma': 5e-9, 'pulse_order': 'counter-intuitive', 'delta_one_photon': 0.0, 'delta_two_photon': 0.0},\n        # Case 4 (one-photon detuning robustness): Omega0=2pi*15MHz, sigma=25ns, counter-intuitive, Delta=2pi*50MHz\n        {'omega0': 2.0 * np.pi * 15e6, 'sigma': 25e-9, 'pulse_order': 'counter-intuitive', 'delta_one_photon': 2.0 * np.pi * 50e6, 'delta_two_photon': 0.0},\n        # Case 5 (two-photon detuning sensitivity): Omega0=2pi*15MHz, sigma=25ns, counter-intuitive, delta=2pi*5MHz\n        {'omega0': 2.0 * np.pi * 15e6, 'sigma': 25e-9, 'pulse_order': 'counter-intuitive', 'delta_one_photon': 0.0, 'delta_two_photon': 2.0 * np.pi * 5e6},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation(**case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2421268"}]}