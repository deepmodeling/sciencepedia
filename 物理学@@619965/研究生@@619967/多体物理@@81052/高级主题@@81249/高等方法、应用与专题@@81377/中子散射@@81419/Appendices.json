{"hands_on_practices": [{"introduction": "中子散射实验的原始输出是探测器在不同角度和时间通道记录的中子计数。为了揭示材料的物理性质，我们必须将这些原始数据转化为具有物理意义的动态结构因子 $S(Q,\\omega)$。本练习将指导你完成这一关键的数据转换过程——从飞行时间谱到能量-动量空间——它是在任何散射实验中进行数据分析都不可或缺的第一步，从而揭开数据处理的神秘面紗。[@problem_id:2493186]", "problem": "一个正向几何结构的飞行时间非弹性中子散射实验测量了作为飞行时间和探测器角度函数的原始计数。您必须使用第一性原理将原始飞行时间计数 $C(t,2\\theta)$ 转换为动态结构因子 $S(Q,\\omega)$ 的估计值。这些原理包括：中子的非相对论运动学、飞行时间几何结构、变量变换的雅可比因子、入射通量归一化、探测器立体角以及运动学前置因子。然后，通过测试弹性线是否在指定的容差范围内出现在零能量转移处，来验证能量守恒。\n\n使用的基本出发点：\n- 中子非相对论动能：$E = \\tfrac{1}{2} m_{\\mathrm{n}} v^2$。\n- 中子波数：$k = \\sqrt{2 m_{\\mathrm{n}} E}/\\hbar$。\n- 飞行时间几何结构（正向几何结构）：$t = L_1/v_i + L_2/v_f$，其中 $L_1$ 是源到样品的距离，$L_2$ 是样品到探测器的距离，$v_i$ 是由 $E_i$ 决定的入射速度，$v_f$ 是由 $E_f$ 决定的末态速度。\n- 能量转移：$\\omega = E_i - E_f$。\n- 动量转移大小：$Q = \\sqrt{k_i^2 + k_f^2 - 2 k_i k_f \\cos(2\\theta)}$。\n- 变量变换雅可比：从单位时间的计数转换到单位能量的计数必须包含因子 $\\left|\\tfrac{\\mathrm{d}t}{\\mathrm{d}E_f}\\right|$。\n- 双微分散射截面与动态结构因子之间的关系：$\\tfrac{\\mathrm{d}^2 \\sigma}{\\mathrm{d}\\Omega\\,\\mathrm{d}E_f} \\propto \\tfrac{k_f}{k_i} S(Q,\\omega)$。在从归一化、经雅可比校正的计数估计 $S(Q,\\omega)$ 时，使用此比例关系来移除运动学因子。将比例常数视为1，使得最终的 $S(Q,\\omega)$ 具有任意但一致的无量纲单位。\n\n常数和仪器参数：\n- 中子质量 $m_{\\mathrm{n}} = 1.67492749804 \\times 10^{-27}\\ \\mathrm{kg}$。\n- 约化普朗克常数 $\\hbar = 1.054571817 \\times 10^{-34}\\ \\mathrm{J\\cdot s}$。\n- 电子伏特转换 $1\\ \\mathrm{meV} = 1.602176634 \\times 10^{-22}\\ \\mathrm{J}$。\n- 源到样品距离 $L_1 = 15.0\\ \\mathrm{m}$。\n- 样品到探测器距离 $L_2 = 5.0\\ \\mathrm{m}$。\n- 探测器像素面积 $A_{\\mathrm{det}} = 1.0\\times 10^{-4}\\ \\mathrm{m}^2$。\n- 像素到样品的距离 $R = 5.0\\ \\mathrm{m}$，因此立体角为 $\\Delta \\Omega = A_{\\mathrm{det}}/R^2$。\n- 入射能量 $E_i = 25.0\\ \\mathrm{meV}$。\n- 样品处的入射能谱通量（单位能量）：$\\Phi_i = 1.0\\times 10^9\\ \\mathrm{s^{-1}\\ meV^{-1}}$。\n- 时间通道宽度 $\\Delta t = 100\\ \\mu\\mathrm{s}$。在所有计算中，使用以秒为单位的 $\\Delta t$。\n- 角度 $2\\theta$ 以度为单位给出。在进行三角函数计算时需转换为弧度。\n- 为评估弹性线上的能量守恒，定义弹性时间 $t_{\\mathrm{el}} = L_1/v_i + L_2/v_i$ 并要求 $|\\omega| \\le \\tau$，容差 $\\tau = 10^{-3}\\ \\mathrm{meV}$。\n\n每个测试用例的任务是：\n1. 对于每个时间通道中心 $t$ 和探测器角度 $2\\theta$，根据飞行时间约束计算 $E_f$，然后计算 $\\omega = E_i - E_f$ 以及对应的 $k_i$, $k_f$ 和 $Q$。\n2. 使用雅可比将每个时间仓的计数 $C$ 转换为单位末态能量的强度：首先形成速率 $C/\\Delta t$，然后乘以 $\\left|\\tfrac{\\mathrm{d}t}{\\mathrm{d}E_f}\\right|$ 得到单位能量的计数。确保该导数是相对于与 $\\Phi_i$ 使用相同能量单位（即 meV）的 $E_f$ 求得的。\n3. 通过入射通量和立体角进行归一化，以获得与 $S(Q,\\omega)$ 成正比的微分散射截面估计值。\n4. 移除运动学前置因子以估计 $S(Q,\\omega)$：乘以 $k_i/k_f$。\n5. 对于每个测试用例，报告两个输出：\n   - 在所提供的时间通道中 $S(Q,\\omega)$ 的峰值，四舍五入到六位小数（无量纲）。\n   - 一个布尔值，指示弹性线上能量是否守恒：找到其 $t$ 最接近 $t_{\\mathrm{el}}$ 的时间通道，计算其 $\\omega$，并检查是否 $|\\omega| \\le 10^{-3}\\ \\mathrm{meV}$。\n\n角度单位要求：所有输入角度均以度为单位，必须在内部转换为弧度。能量单位要求：在计算 $\\omega$ 和通量归一化时，所有能量必须以 $\\mathrm{meV}$ 为单位；报告的 $S$ 值四舍五入到六位小数；布尔值无单位。不打印任何角度或能量；仅打印所要求的量。\n\n测试套件：\n- 测试用例 1: $2\\theta = 30^{\\circ}$，时间 $t$ (单位 $\\mu\\mathrm{s}$): $[9096.0,\\ 9146.0,\\ 9196.0]$，计数 $C$: $[1000,\\ 2000,\\ 1000]$。\n- 测试用例 2: $2\\theta = 5^{\\circ}$，时间 $t$ (单位 $\\mu\\mathrm{s}$): $[9146.0,\\ 9246.0,\\ 9346.0]$，计数 $C$: $[1500,\\ 3000,\\ 1500]$。\n- 测试用例 3: $2\\theta = 150^{\\circ}$，时间 $t$ (单位 $\\mu\\mathrm{s}$): $[9246.0,\\ 9296.0,\\ 9346.0]$，计数 $C$: $[1000,\\ 2000,\\ 1000]$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，\n  格式为 [[S_peak_1,energy_check_1],[S_peak_2,energy_check_2],[S_peak_3,energy_check_3]]\n  其中每个 S_peak 四舍五入到六位小数，每个 energy_check 是一个布尔字面量（True 或 False）。", "solution": "所提出的问题是有效的，因为它科学地基于非相对论力学和中子散射的原理，提法恰当且数据充分，并以客观、明确的语言表述。可以构建一个系统的解决方案。\n\n任务是将原始的飞行时间（ToF）中子散射数据 $C(t, 2\\theta)$ 转换为动态结构因子 $S(Q, \\omega)$，并在弹性线上验证能量守恒。这需要逐步应用运动学关系和归一化因子。所有计算都将使用提供的常数和仪器参数。\n\n让我们从建立入射中子束的性质开始。给定的入射能量为 $E_i = 25.0\\ \\mathrm{meV}$。为了进行运动学计算，所有能量都必须转换为国际单位制单位（焦耳）。转换关系为 $1\\ \\mathrm{meV} = 1.602176634 \\times 10^{-22}\\ \\mathrm{J}$。\n入射能量（以焦耳为单位）是：\n$$E_{i, \\mathrm{J}} = E_i \\times (1.602176634 \\times 10^{-22}\\ \\mathrm{J/meV})$$\n根据非相对论动能公式 $E = \\frac{1}{2} m_{\\mathrm{n}} v^2$，可以确定入射中子速度 $v_i$：\n$$v_i = \\sqrt{\\frac{2 E_{i, \\mathrm{J}}}{m_{\\mathrm{n}}}}$$\n其中 $m_{\\mathrm{n}} = 1.67492749804 \\times 10^{-27}\\ \\mathrm{kg}$ 是中子质量。相应的入射波数 $k_i$ 由 $k = \\frac{m_{\\mathrm{n}} v}{\\hbar}$ 给出：\n$$k_i = \\frac{m_{\\mathrm{n}} v_i}{\\hbar}$$\n其中 $\\hbar = 1.054571817 \\times 10^{-34}\\ \\mathrm{J\\cdot s}$ 是约化普朗克常数。\n\n对于弹性散射，中子的能量不变 ($E_f = E_i$)，因此其速度也不变 ($v_f = v_i$)。弹性散射中子的飞行时间 $t_{\\mathrm{el}}$ 是总距离除以恒定速度：\n$$t_{\\mathrm{el}} = \\frac{L_1 + L_2}{v_i}$$\n其中 $L_1 = 15.0\\ \\mathrm{m}$ 是源到样品的距离，$L_2 = 5.0\\ \\mathrm{m}$ 是样品到探测器的距离。该值用于识别对应于弹性线的时间通道，以进行能量守恒检验。\n\n对于一般的非弹性散射事件，中子在时间 $t$ 到达探测器。总飞行时间是两个飞行路径的时间之和：\n$$t = \\frac{L_1}{v_i} + \\frac{L_2}{v_f}$$\n我们可以解出末态速度 $v_f$：\n$$v_f = \\frac{L_2}{t - L_1/v_i}$$\n这要求 $t  L_1/v_i$，这在物理上是必需的。\n然后，末态动能（以焦耳为单位）$E_{f, \\mathrm{J}}$ 为：\n$$E_{f, \\mathrm{J}} = \\frac{1}{2} m_{\\mathrm{n}} v_f^2$$\n末态波数为：\n$$k_f = \\frac{m_{\\mathrm{n}} v_f}{\\hbar}$$\n能量转移 $\\omega$ 定义为中子损失的能量，即 $\\omega = E_i - E_f$。在计算中，我们使用以 meV 为单位的能量：\n$$\\omega = E_i - E_{f, \\mathrm{J}} \\times (\\frac{1}{1.602176634 \\times 10^{-22}\\ \\mathrm{J/meV}})$$\n动量转移矢量的大小 $Q$ 由矢量差 $\\vec{Q} = \\vec{k_i} - \\vec{k_f}$ 的余弦定理给出：\n$$Q = \\sqrt{k_i^2 + k_f^2 - 2 k_i k_f \\cos(2\\theta)}$$\n其中 $2\\theta$ 是散射角，在计算时必须从度转换为弧度。\n\n为了将时间仓中的测量计数 $C$ 转换为与双微分散射截面成正比的量，我们遵循指定的步骤。首先，我们确定单位末态能量的强度。计数率近似为 $C/\\Delta t$，其中 $\\Delta t = 100 \\times 10^{-6}\\ \\mathrm{s}$。从时间密度转换为能量密度需要雅可比因子 $|\\frac{\\mathrm{d}t}{\\mathrm{d}E_f}|$。\n从 $t = L_1/v_i + L_2/v_f$ 和 $E_f = \\frac{1}{2} m_{\\mathrm{n}} v_f^2$，我们推导雅可比。使用链式法则更简单：\n$$ \\frac{\\mathrm{d}t}{\\mathrm{d}E_f} = \\frac{\\mathrm{d}t}{\\mathrm{d}v_f} \\frac{\\mathrm{d}v_f}{\\mathrm{d}E_f} $$\n$$ \\frac{\\mathrm{d}t}{\\mathrm{d}v_f} = -\\frac{L_2}{v_f^2} \\quad \\text{和} \\quad \\frac{\\mathrm{d}E_f}{\\mathrm{d}v_f} = m_{\\mathrm{n}}v_f \\implies \\frac{\\mathrm{d}v_f}{\\mathrm{d}E_f} = \\frac{1}{m_{\\mathrm{n}}v_f} $$\n因此，相对于以焦耳为单位的能量的导数为：\n$$\\frac{\\mathrm{d}t}{\\mathrm{d}E_{f, \\mathrm{J}}} = \\left(-\\frac{L_2}{v_f^2}\\right) \\left(\\frac{1}{m_{\\mathrm{n}}v_f}\\right) = -\\frac{L_2}{m_{\\mathrm{n}}v_f^3}$$\n问题要求的是相对于以 meV 为单位的能量的导数。设其为 $\\frac{\\mathrm{d}t}{\\mathrm{d}E_{f, \\text{meV}}}$。\n$$\\frac{\\mathrm{d}t}{\\mathrm{d}E_{f, \\text{meV}}} = \\frac{\\mathrm{d}t}{\\mathrm{d}E_{f, \\mathrm{J}}} \\frac{\\mathrm{d}E_{f, \\mathrm{J}}}{\\mathrm{d}E_{f, \\text{meV}}} = \\frac{\\mathrm{d}t}{\\mathrm{d}E_{f, \\mathrm{J}}} \\times (1.602176634 \\times 10^{-22}\\ \\mathrm{J/meV})$$\n所需的雅可比大小为：\n$$J = \\left|\\frac{\\mathrm{d}t}{\\mathrm{d}E_{f, \\text{meV}}}\\right| = \\frac{L_2}{m_{\\mathrm{n}}v_f^3} \\times (1.602176634 \\times 10^{-22})$$\n单位末态能量的强度 $I_{E_f}$ 由计数率乘以该雅可比给出：\n$$I_{E_f} = \\frac{C}{\\Delta t} \\times J$$\n然后，该量通过入射能谱通量 $\\Phi_i = 1.0 \\times 10^9\\ \\mathrm{s^{-1}\\ meV^{-1}}$ 和探测器立体角 $\\Delta\\Omega = A_{\\mathrm{det}}/R^2 = (1.0 \\times 10^{-4}\\ \\mathrm{m}^2) / (5.0\\ \\mathrm{m})^2 = 4.0 \\times 10^{-6}\\ \\mathrm{sr}$ 进行归一化。这给出了与双微分散射截面成正比的估计值：\n$$\\frac{\\mathrm{d}^2\\sigma}{\\mathrm{d}\\Omega\\,\\mathrm{d}E_f} \\propto I_{\\text{norm}} = \\frac{I_{E_f}}{\\Phi_i \\Delta\\Omega}$$\n最后，使用给定的关系式（比例常数设为1）提取动态结构因子 $S(Q, \\omega)$：\n$$ \\frac{\\mathrm{d}^2\\sigma}{\\mathrm{d}\\Omega\\,\\mathrm{d}E_f} = \\frac{k_f}{k_i} S(Q, \\omega) $$\n因此，我们对 $S(Q, \\omega)$ 的估计是：\n$$S(Q, \\omega) = I_{\\text{norm}} \\times \\frac{k_i}{k_f} = \\frac{C J}{\\Delta t \\cdot \\Phi_i \\Delta\\Omega} \\frac{k_i}{k_f}$$\n对每个时间通道执行此计算。识别出每个测试用例的 $S(Q, \\omega)$ 峰值。\n\n对于能量守恒检验，找到其时间 $t$ 最接近计算出的 $t_{\\mathrm{el}}$ 的时间通道。计算此特定通道的能量转移 $\\omega$。如果 $|\\omega| \\le \\tau$，其中容差 $\\tau = 10^{-3}\\ \\mathrm{meV}$，则条件满足。\n\n完整的流程在提供的程序中实现，该程序处理每个测试用例并按规定格式化最终输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the inelastic neutron scattering data reduction problem.\n    \"\"\"\n\n    # --- Constants and Instrument Parameters ---\n    # Physical constants\n    M_N = 1.67492749804e-27  # Neutron mass in kg\n    HBAR = 1.054571817e-34    # Reduced Planck constant in J*s\n    MEV_TO_J = 1.602176634e-22 # Conversion factor from meV to Joules\n    J_TO_MEV = 1.0 / MEV_TO_J\n\n    # Instrument parameters\n    L1 = 15.0  # Source-to-sample distance in m\n    L2 = 5.0  # Sample-to-detector distance in m\n    R = 5.0   # Sample-to-detector pixel distance in m\n    A_DET = 1.0e-4 # Detector pixel area in m^2\n    DELTA_OMEGA = A_DET / R**2 # Solid angle in sr\n    EI_MEV = 25.0 # Incident energy in meV\n    PHI_I = 1.0e9 # Incident spectral flux in s^-1 meV^-1\n    DELTA_T_S = 100e-6 # Time channel width in s\n    TAU = 1e-3 # Energy conservation tolerance in meV\n\n    # --- Pre-computation of Incident Beam Properties ---\n    EI_J = EI_MEV * MEV_TO_J\n    VI = np.sqrt(2 * EI_J / M_N)\n    KI = M_N * VI / HBAR\n    T_EL_S = (L1 + L2) / VI\n    T_EL_MUS = T_EL_S * 1e6\n\n    # --- Test Suite ---\n    test_cases = [\n        # (angle_deg, times_mus, counts)\n        (30.0, [9096.0, 9146.0, 9196.0], [1000, 2000, 1000]),\n        (5.0,  [9146.0, 9246.0, 9346.0], [1500, 3000, 1500]),\n        (150.0,[9246.0, 9296.0, 9346.0], [1000, 2000, 1000]),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        angle_deg, times_mus, counts = case\n        angle_rad = np.deg2rad(angle_deg)\n        \n        s_values = []\n        omega_values = []\n\n        for t_mus, c in zip(times_mus, counts):\n            t_s = t_mus * 1e-6\n            \n            # Check for physical time-of-flight\n            if t_s = L1 / VI:\n                # This case is unphysical but should not occur with the given data\n                continue\n            \n            # --- Kinematics Calculation ---\n            vf = L2 / (t_s - L1 / VI)\n            ef_j = 0.5 * M_N * vf**2\n            ef_mev = ef_j * J_TO_MEV\n            omega_mev = EI_MEV - ef_mev\n            kf = M_N * vf / HBAR\n            \n            # --- Jacobian Calculation ---\n            # Jacobian |dt/dE_f| with E_f in meV\n            jacobian = (L2 / (M_N * vf**3)) * MEV_TO_J\n\n            # --- S(Q, omega) Calculation ---\n            # Intensity per unit final energy\n            intensity_per_energy = (c / DELTA_T_S) * jacobian\n            # Normalized intensity (proportional to cross-section)\n            i_norm = intensity_per_energy / (PHI_I * DELTA_OMEGA)\n            # Dynamic structure factor\n            s_q_omega = i_norm * (KI / kf)\n\n            s_values.append(s_q_omega)\n            omega_values.append(omega_mev)\n\n        # --- Task 5a: Find Peak S(Q, omega) ---\n        s_peak = np.max(s_values) if s_values else 0.0\n\n        # --- Task 5b: Energy Conservation Check ---\n        time_diffs = [abs(t_mus - T_EL_MUS) for t_mus in times_mus]\n        closest_idx = np.argmin(time_diffs)\n        omega_at_elastic = omega_values[closest_idx]\n        energy_check = abs(omega_at_elastic) = TAU\n\n        # Append results for this case\n        results.append([round(s_peak, 6), energy_check])\n    \n    # --- Final Output Formatting ---\n    result_strings = [f\"[{s},{str(c)}]\" for s, c in results]\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```", "id": "2493186"}, {"introduction": "小角中子散射 (SANS) 是研究纳米尺度结构（例如聚合物、胶体和生物大分子）的强大技术，其关键在于利用样品不同组分之间的“衬度”差异。本练习将演示一种名为“衬度匹配”的巧妙实验策略，即通过同位素取代（如用氘替换氢）来调节混合物中某一特定组分的散射长度密度，使其与溶剂相匹配，从而在散射信号中“隐形”，进而凸显出我们感兴趣的目标结构。[@problem_id:1174190]", "problem": "在小角中子散射 (SANS) 实验中，不同组分之间的散射对比度决定了测得的强度。这种对比度源于材料的一个关键性质——散射长度密度 (SLD) 的差异。对于给定的分子或单体，SLD（记为 $\\rho$）定义为其组成原子的相干中子散射长度之和除以其体积。\n\n考虑一个由溶解在氘代溶剂中的聚合物共混物组成的三元体系。该聚合物共混物本身是全氢化聚合物（聚合物 H）及其全氘代对应物（聚合物 D）的混合物。\n体系组分定义如下：\n- 聚合物 H 单体：化学式为 $\\text{C}_{n_C}\\text{H}_{n_H}$，其中 $n_C$ 和 $n_H$ 分别是每个单体中碳原子和氢原子的数量。其单体体积为 $v_m$。碳的相干散射长度为 $b_C$，氢的为 $b_H$。\n- 聚合物 D 单体：化学式为 $\\text{C}_{n_C}\\text{D}_{n_H}$，其中所有氢原子都被氘取代。其单体体积也为 $v_m$。氘的相干散射长度为 $b_D$。\n- 溶剂：一种氘代分子，化学式为 $\\text{C}_{m_C}\\text{D}_{m_D}$。其分子体积为 $v_s$。\n\nSANS 中一种称为“对比度匹配”的常用技术，涉及调整样品的组成，使某一组分对中子“不可见”。你的任务是找出当聚合物共混物分散在氘代溶剂中时，能使整个共混物变得“不可见”的特定组成。\n\n计算聚合物共混物中氘代聚合物（聚合物 D）的体积分数 $\\phi$，使得共混物的平均 SLD 恰好等于溶剂的 SLD。用给定的参数 $n_C, n_H, m_C, m_D, v_m, v_s, b_C, b_H, b_D$ 将你的答案表示为符号表达式。", "solution": "1. 定义各组分的 SLD：\n   聚合物 H 单体的 SLD  \n   $$\\rho_H=\\frac{n_C\\,b_C+n_H\\,b_H}{v_m}\\,. $$\n   聚合物 D 单体的 SLD  \n   $$\\rho_D=\\frac{n_C\\,b_C+n_H\\,b_D}{v_m}\\,. $$\n   氘代溶剂的 SLD  \n   $$\\rho_S=\\frac{m_C\\,b_C+m_D\\,b_D}{v_s}\\,. $$\n\n2. 聚合物共混物的体积平均 SLD（D 的体积分数为 $\\phi$，H 的体积分数为 $1-\\phi$）为\n   $$\\rho_{\\rm blend}=\\phi\\,\\rho_D+(1-\\phi)\\,\\rho_H\\,. $$\n\n3. 对比度匹配要求 $\\rho_{\\rm blend}=\\rho_S$，因此\n   $$\\phi\\,\\rho_D+(1-\\phi)\\,\\rho_H=\\rho_S\\,. $$\n\n4. 求解 $\\phi$：\n   $$\\phi(\\rho_D-\\rho_H)=\\rho_S-\\rho_H$$\n   $$\\phi=\\frac{\\rho_S-\\rho_H}{\\rho_D-\\rho_H}\\,. $$\n\n5. 代入表达式：\n   $$\\phi\n     =\\frac{\\displaystyle \\frac{m_C b_C+m_D b_D}{v_s}\n           -\\frac{n_C b_C+n_H b_H}{v_m}}\n          {\\displaystyle \\frac{n_C b_C+n_H b_D}{v_m}\n           -\\frac{n_C b_C+n_H b_H}{v_m}}$$\n\n6. 化简分母并合并：\n   $$\\rho_D-\\rho_H\n     =\\frac{n_H(b_D-b_H)}{v_m},$$\n   因此\n   $$\\phi\n     =\\frac{v_m\\Bigl(\\frac{m_C b_C+m_D b_D}{v_s}\\Bigr)\n            -\\bigl(n_C b_C+n_H b_H\\bigr)}\n           {n_H(b_D-b_H)}$$\n   分子和分母同乘以 $v_s$ 得\n   $$\\phi\n     =\\frac{v_m\\,(m_C b_C+m_D b_D)\n            -v_s\\,(n_C b_C+n_H b_H)}\n           {n_H(b_D-b_H)\\,v_s}\\,. $$", "answer": "$$\\boxed{\\frac{v_m\\,(m_C b_C+m_D b_D)-v_s\\,(n_C b_C+n_H b_H)}{n_H\\,\\bigl(b_D-b_H\\bigr)\\,v_s}}$$", "id": "1174190"}, {"introduction": "准弹性中子散射 (QENS) 是研究材料中原子或分子扩散等随机运动的有力工具。当粒子的运动在空间上受限（例如在有限个格点之间跳跃）时，其散射信号中会包含一个纯弹性部分。本练习将推导弹性非相干结构因子 (EISF)，这个量直接反映了扩散运动的空间几何构型，从而将宏观的散射信号与微观的原子跳跃路径联系起来。[@problem_id:129553]", "problem": "非相干中子散射是研究材料中单粒子动力学（如扩散和局域运动）的强大技术。非相干散射的双微分截面与非相干动态结构因子 $S_{inc}(\\mathbf{Q}, \\omega)$ 成正比，其中 $\\hbar\\mathbf{Q}$ 是散射事件中的动量转移，$\\hbar\\omega$ 是能量转移。\n\n$S_{inc}(\\mathbf{Q}, \\omega)$ 函数是单粒子关联函数 $G_s(\\mathbf{r}, t)$ 的时间和空间傅里叶变换。对于经典系统，它通过自中间散射函数 $I_s(\\mathbf{Q},t)$ 与位于位置 $\\mathbf{r}(t)$ 的散射体的运动相关联：\n$$ S_{inc}(\\mathbf{Q}, \\omega) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} I_s(\\mathbf{Q},t) e^{-i\\omega t} dt $$\n其中 $I_s(\\mathbf{Q},t) = \\langle e^{-i\\mathbf{Q}\\cdot\\mathbf{r}(0)} e^{i\\mathbf{Q}\\cdot\\mathbf{r}(t)} \\rangle$，尖括号表示对粒子轨迹的热平均。\n\n当粒子的运动在空间上受限时（例如，在有限数量的格点之间跳跃），即使在很长的时间后，其在时间 $t$ 的位置仍与其在 $t=0$ 时的位置保持相关。这导致 $I_s(\\mathbf{Q},t)$ 中出现一个不衰减的分量，并因此在 $S_{inc}(\\mathbf{Q}, \\omega)$ 中产生一个尖锐的弹性峰。这表示为：\n$$ S_{inc}(\\mathbf{Q}, \\omega) = A_0(\\mathbf{Q})\\delta(\\omega) + S_{qe}(\\mathbf{Q}, \\omega) $$\n其中 $A_0(\\mathbf{Q})$ 是弹性非相干结构因子（EISF），$S_{qe}(\\mathbf{Q}, \\omega)$ 是准弹性分量。EISF 给出纯弹性散射的比例，并可以从中间散射函数的长时间极限计算得出：\n$$ A_0(\\mathbf{Q}) = \\lim_{t\\to\\infty} I_s(\\mathbf{Q},t) = \\left| \\langle e^{i\\mathbf{Q}\\cdot\\mathbf{r}} \\rangle_{\\text{ensemble}} \\right|^2 $$\n系综平均是对粒子在热平衡时可能占据的所有格点进行的。\n\n考虑一个系统，其中单个质子在两个不同的格点 $\\mathbf{R}_1$ 和 $\\mathbf{R}_2$ 之间进行热激活跳跃。这两个格点相距为 $d = |\\mathbf{R}_2 - \\mathbf{R}_1|$。由于格点势能的差异，其平衡占据概率不相等，对于格点 $\\mathbf{R}_1$ 和 $\\mathbf{R}_2$ 分别由 $p_1$ 和 $p_2$ 给出，满足 $p_1 + p_2 = 1$。\n\n假设样品是粉末，向量 $\\mathbf{d} = \\mathbf{R}_2 - \\mathbf{R}_1$ 的取向相对于动量转移向量 $\\mathbf{Q}$ 是随机且均匀分布的。\n\n您的任务是计算粉末平均的弹性非相干结构因子 $\\langle A_0(Q) \\rangle$，将其表示为动量转移大小 $Q = |\\mathbf{Q}|$、格点间距 $d$ 以及格点占据概率 $p_1$ 和 $p_2$ 的函数。", "solution": "单个质子在两个格点之间跳跃的弹性非相干结构因子（EISF）由下式给出：\n\n$$\nA_0(\\mathbf{Q}) = \\left| \\langle e^{i\\mathbf{Q}\\cdot\\mathbf{r}} \\rangle_{\\text{ensemble}} \\right|^2\n$$\n\n其中系综平均考虑了平衡占据概率。对于位置为 $\\mathbf{R}_1$ 和 $\\mathbf{R}_2$、间距为 $\\mathbf{d} = \\mathbf{R}_2 - \\mathbf{R}_1$ 且 $d = |\\mathbf{d}|$ 的两个格点，系综平均为：\n\n$$\n\\langle e^{i\\mathbf{Q}\\cdot\\mathbf{r}} \\rangle_{\\text{ensemble}} = p_1 e^{i\\mathbf{Q}\\cdot\\mathbf{R}_1} + p_2 e^{i\\mathbf{Q}\\cdot\\mathbf{R}_2}\n$$\n\n因此：\n\n$$\nA_0(\\mathbf{Q}) = \\left| p_1 e^{i\\mathbf{Q}\\cdot\\mathbf{R}_1} + p_2 e^{i\\mathbf{Q}\\cdot\\mathbf{R}_2} \\right|^2\n$$\n\n展开模长的平方：\n\n$$\nA_0(\\mathbf{Q}) = \\left( p_1 e^{i\\mathbf{Q}\\cdot\\mathbf{R}_1} + p_2 e^{i\\mathbf{Q}\\cdot\\mathbf{R}_2} \\right) \\left( p_1 e^{-i\\mathbf{Q}\\cdot\\mathbf{R}_1} + p_2 e^{-i\\mathbf{Q}\\cdot\\mathbf{R}_2} \\right) = p_1^2 + p_2^2 + p_1 p_2 \\left( e^{i\\mathbf{Q}\\cdot(\\mathbf{R}_1 - \\mathbf{R}_2)} + e^{i\\mathbf{Q}\\cdot(\\mathbf{R}_2 - \\mathbf{R}_1)} \\right)\n$$\n\n代入 $\\mathbf{R}_1 - \\mathbf{R}_2 = -\\mathbf{d}$：\n\n$$\nA_0(\\mathbf{Q}) = p_1^2 + p_2^2 + p_1 p_2 \\left( e^{-i\\mathbf{Q}\\cdot\\mathbf{d}} + e^{i\\mathbf{Q}\\cdot\\mathbf{d}} \\right) = p_1^2 + p_2^2 + 2 p_1 p_2 \\cos(\\mathbf{Q}\\cdot\\mathbf{d})\n$$\n\n由于 $\\mathbf{Q}\\cdot\\mathbf{d} = Q d \\cos\\theta$，其中 $\\theta$ 是 $\\mathbf{Q}$ 和 $\\mathbf{d}$ 之间的夹角，且对于粉末样品，取向是各向同性的，因此粉末平均 $\\langle A_0(Q) \\rangle$ 是对 $\\theta$ 的球面平均：\n\n$$\n\\langle A_0(Q) \\rangle = \\frac{1}{4\\pi} \\int_{\\phi=0}^{2\\pi} \\int_{\\theta=0}^{\\pi} A_0(\\mathbf{Q}) \\sin\\theta \\, d\\theta \\, d\\phi\n$$\n\n被积函数与 $\\phi$ 无关，所以：\n\n$$\n\\langle A_0(Q) \\rangle = \\frac{1}{4\\pi} \\cdot 2\\pi \\int_{0}^{\\pi} \\left[ p_1^2 + p_2^2 + 2 p_1 p_2 \\cos(Q d \\cos\\theta) \\right] \\sin\\theta \\, d\\theta = \\frac{1}{2} \\int_{0}^{\\pi} \\left[ p_1^2 + p_2^2 + 2 p_1 p_2 \\cos(Q d \\cos\\theta) \\right] \\sin\\theta \\, d\\theta\n$$\n\n将积分拆分：\n\n$$\n\\langle A_0(Q) \\rangle = \\frac{1}{2} \\left[ (p_1^2 + p_2^2) \\int_{0}^{\\pi} \\sin\\theta \\, d\\theta + 2 p_1 p_2 \\int_{0}^{\\pi} \\cos(Q d \\cos\\theta) \\sin\\theta \\, d\\theta \\right]\n$$\n\n计算第一个积分：\n\n$$\n\\int_{0}^{\\pi} \\sin\\theta \\, d\\theta = \\left[ -\\cos\\theta \\right]_{0}^{\\pi} = -\\cos\\pi + \\cos 0 = -(-1) + 1 = 2\n$$\n\n对于第二个积分，进行换元，令 $u = \\cos\\theta$，$du = -\\sin\\theta \\, d\\theta$，积分上下限为 $\\theta = 0 \\to u = 1$，$\\theta = \\pi \\to u = -1$：\n\n$$\n\\int_{0}^{\\pi} \\cos(Q d \\cos\\theta) \\sin\\theta \\, d\\theta = \\int_{1}^{-1} \\cos(Q d u) (-du) = \\int_{-1}^{1} \\cos(Q d u) \\, du\n$$\n\n$$\n\\int_{-1}^{1} \\cos(Q d u) \\, du = \\left[ \\frac{\\sin(Q d u)}{Q d} \\right]_{-1}^{1} = \\frac{\\sin(Q d)}{Q d} - \\frac{\\sin(-Q d)}{Q d} = \\frac{\\sin(Q d)}{Q d} + \\frac{\\sin(Q d)}{Q d} = \\frac{2 \\sin(Q d)}{Q d}\n$$\n\n代入回去：\n\n$$\n\\langle A_0(Q) \\rangle = \\frac{1}{2} \\left[ (p_1^2 + p_2^2) \\cdot 2 + 2 p_1 p_2 \\cdot \\frac{2 \\sin(Q d)}{Q d} \\right] = \\frac{1}{2} \\left[ 2(p_1^2 + p_2^2) + \\frac{4 p_1 p_2 \\sin(Q d)}{Q d} \\right] = p_1^2 + p_2^2 + \\frac{2 p_1 p_2 \\sin(Q d)}{Q d}\n$$\n\n这就是粉末平均的 EISF。", "answer": "$$ \\boxed{p_1^{2} + p_2^{2} + 2 p_1 p_2 \\frac{\\sin(Q d)}{Q d}} $$", "id": "129553"}]}