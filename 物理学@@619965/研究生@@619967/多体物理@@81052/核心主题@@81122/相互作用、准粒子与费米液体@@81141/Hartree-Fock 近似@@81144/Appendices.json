{"hands_on_practices": [{"introduction": "Hartree-Fock自洽场 (SCF) 方法的核心是迭代地构建和对角化Fock矩阵。第一个实践练习将揭开这个关键矩阵的神秘面纱。通过从其组成部分——核心哈密顿量、密度矩阵和双电子积分——手动组装一个Fock矩阵元素，您将对平均场近似中如何包含电子-电子相互作用获得具体的理解。这个练习 [@problem_id:1148551] 强调了将抽象的Roothaan-Hall方程转化为实际计算步骤的过程。", "problem": "在用于闭壳层电子体系的 Hartree-Fock 近似中，福克 (Fock) 矩阵 $F$ 在原子或对称性匹配轨道 $\\{\\psi_i\\}$ 基组中的矩阵元由 Roothaan-Hall 方程给出。单个福克矩阵元 $F_{ij}$ 的计算公式为：\n$$ F_{ij} = H_{ij}^{\\text{core}} + G_{ij} $$\n其中 $H_{ij}^{\\text{core}} = \\langle \\psi_i | \\hat{h} | \\psi_j \\rangle$ 是单电子核心哈密顿积分（动能+核吸引能），而 $G_{ij}$ 代表双电子相互作用（库仑作用和交换作用）。双电子部分由下式给出：\n$$ G_{ij} = \\sum_{k,l} P_{kl} \\left[ (ij|lk) - \\frac{1}{2}(ik|jl) \\right] $$\n此处，$P_{kl}$ 是密度矩阵的相应矩阵元，而 $(ij|lk)$ 是采用化学家标记法的双电子排斥积分：\n$$ (ij|lk) = \\iint \\psi_i^*(1) \\psi_j^*(1) \\frac{1}{|\\mathbf{r}_1 - \\mathbf{r}_2|} \\psi_l^*(2) \\psi_k(2) \\,d\\mathbf{r}_1 d\\mathbf{r}_2 $$\n对于实轨道，这些积分具有8重置换对称性：$(ij|kl) = (ji|kl) = (ij|lk) = (ji|lk) = (kl|ij) = (lk|ij) = (kl|ji) = (lk|ji)$。\n\n考虑一个对称 $\\text{XH}_2$ 分子 $A_1$ 对称块的简单模型。其基组由两个未归一化、非正交的实值对称性匹配轨道 (SALCs) 组成：\n- $\\psi_1$，对应于中心原子X上的价层$s$轨道。\n- $\\psi_2$，对应于两个氢原子上$1s$轨道的同相组合。\n\n你的任务是计算非对角福克矩阵元 $F_{12} = \\langle \\psi_1 | \\hat{F} | \\psi_2 \\rangle$。在此基组中，所需的预先计算好的量由以下符号常量给出：\n\n- 核心哈密顿积分：$H_{12}^{\\text{core}} = h_{12}$\n- 密度矩阵元：$P_{11}$、$P_{12}$、$P_{22}$（注意 $P_{12} = P_{21}$）\n- 唯一的非零双电子积分：\n  - $(12|11) = \\alpha$\n  - $(11|22) = \\beta$\n  - $(12|12) = \\gamma$\n  - $(12|22) = \\delta$\n\n用所提供的符号常量 $h_{12}, P_{11}, P_{12}, P_{22}, \\alpha, \\beta, \\gamma, \\delta$ 表示 $F_{12}$ 的最终结果。", "solution": "我们有\n$$F_{12}=H^{\\rm core}_{12}+G_{12}=h_{12}+G_{12},$$  \n其中\n$$G_{12}=\\sum_{k,l=1}^2P_{kl}\\left[(12|lk)-\\frac{1}{2}(1k|2l)\\right].$$  \n展开求和的四项：\n\n1.  $k=1,l=1$:\n    $P_{11} \\left[ (12|11) - \\frac{1}{2}(11|21) \\right] = P_{11} \\left[ \\alpha - \\frac{1}{2}\\alpha \\right] = \\frac{1}{2}\\alpha P_{11}$ (利用了对称性 $(11|21) = (11|12) = \\alpha$).\n\n2.  $k=1,l=2$:\n    $P_{12} \\left[ (12|21) - \\frac{1}{2}(11|22) \\right] = P_{12} \\left[ \\gamma - \\frac{1}{2}\\beta \\right]$ (利用了对称性 $(12|21)=(12|12)=\\gamma$).\n\n3.  $k=2,l=1$:\n    $P_{21} \\left[ (12|12) - \\frac{1}{2}(12|21) \\right] = P_{12} \\left[ \\gamma - \\frac{1}{2}\\gamma \\right] = \\frac{1}{2}\\gamma P_{12}$ (利用了对称性 $(12|21)=(12|12)=\\gamma$ 和 $P_{21}=P_{12}$).\n\n4.  $k=2,l=2$:\n    $P_{22} \\left[ (12|22) - \\frac{1}{2}(12|22) \\right] = P_{22} \\left[ \\delta - \\frac{1}{2}\\delta \\right] = \\frac{1}{2}\\delta P_{22}$.\n\n将各项相加可得\n$$G_{12}\n=\\frac{1}{2}\\alpha P_{11}\n+P_{12}\\left[\\gamma-\\frac{1}{2}\\beta\\right]\n+\\frac{1}{2}\\gamma P_{12}\n+\\frac{1}{2}\\delta P_{22}\n=\\frac{1}{2}\\alpha P_{11} + \\left(\\frac{3}{2}\\gamma - \\frac{1}{2}\\beta\\right)P_{12} + \\frac{1}{2}\\delta P_{22}$$\n$$G_{12} = \\frac{1}{2}\\left(\\alpha P_{11}+(3\\gamma-\\beta)P_{12}+\\delta P_{22}\\right).$$  \n因此\n$$F_{12}\n=h_{12}+\\frac{1}{2}\\left(\\alpha P_{11}+(3\\gamma-\\beta)P_{12}+\\delta P_{22}\\right).$$", "answer": "$$\\boxed{h_{12}+\\frac{1}{2}\\left(\\alpha P_{11}+(3\\gamma-\\beta)P_{12}+\\delta P_{22}\\right)}$$", "id": "1148551"}, {"introduction": "在构建了Fock矩阵之后，下一个合乎逻辑的问题是：SCF过程如何向解收敛？本练习 [@problem_id:1148501] 介绍了轨道梯度的概念，这是优化分子轨道的驱动力。通过为一个尚未收敛的体系计算占据轨道和虚拟轨道之间的特定非对角Fock矩阵元素，您将精确地看到SCF算法试图消除的目标，从而直接领略迭代能量最小化的机制。", "problem": "在哈特里-福克 (Hartree-Fock, HF) 近似中，闭壳层电子体系的基态由一组空间轨道 $\\{\\psi_i\\}$ 构建的单个斯莱特 (Slater) 行列式来描述。自洽场 (Self-Consistent Field, SCF) 方法的目标是找到使总电子能量最小化的那组轨道。\n\n轨道 $\\psi_i$ 通常表示为一组固定基函数 $\\{\\phi_\\mu\\}$ 的线性组合，即 $\\psi_i = \\sum_\\mu C_{\\mu i} \\phi_\\mu$。对于一个正交归一基组 $\\{\\phi_\\mu\\}$，寻找最优轨道的问题简化为求解罗特汉-霍尔 (Roothaan-Hall) 方程：\n$$ \\mathbf{F C} = \\mathbf{C} \\boldsymbol{\\epsilon} $$\n此处，$\\mathbf{F}$ 是福克 (Fock) 矩阵，$\\mathbf{C}$ 是轨道系数 $C_{\\mu i}$ 构成的矩阵，而 $\\boldsymbol{\\epsilon}$ 是一个轨道能量的对角矩阵。当达到收敛时，作为此方程解的轨道被称为正则轨道，并且在此轨道基下表示的福克矩阵 $\\mathbf{F}^{\\text{MO}} = \\mathbf{C}^\\dagger \\mathbf{F} \\mathbf{C}$ 是对角的。\n\n在 SCF 迭代过程中，达到收敛之前，系数矩阵 $\\mathbf{C}$ 并不能将当前的福克矩阵 $\\mathbf{F}$ 对角化。在当前分子轨道 (Molecular Orbital, MO) 基下，福克矩阵的非对角元 $F_{ij}^{\\text{MO}} = \\langle \\psi_i | \\hat{F} | \\psi_j \\rangle$ 是非零的。连接一个占据轨道 $\\psi_i$ 和一个虚 (未占据) 轨道 $\\psi_a$ 的矩阵元 $F_{ia}^{\\text{MO}}$ 尤其重要。这些矩阵元，记为 $G_{ia} = F_{ia}^{\\text{MO}}$，构成了轨道梯度。$G_{ia}$ 的非零值表明，通过混合 (旋转) 轨道 $\\psi_i$ 和 $\\psi_a$ 可以降低总能量。当所有这些梯度元都为零时，SCF 方法终止。\n\n考虑一个类氦原子（2个电子）在两个实的、正交归一的函数 $\\{\\phi_1, \\phi_2\\}$ 构成的基组中的限制性哈特里-福克 (restricted Hartree-Fock, RHF) 计算。在这种情况下，有一个双占据空间轨道 $\\psi_1$ 和一个虚轨道 $\\psi_2$。\n\n在 SCF 循环的某一次迭代中，该体系尚未收敛。在 $\\{\\phi_1, \\phi_2\\}$ 基下的当前福克矩阵由下式给出：\n$$ \\mathbf{F} = \\begin{pmatrix} \\alpha & \\gamma \\\\ \\gamma & \\beta \\end{pmatrix} $$\n当前的 MO 系数矩阵（它不是 $\\mathbf{F}$ 的特征向量矩阵）由下式给出：\n$$ \\mathbf{C} = \\begin{pmatrix} \\cos\\theta & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta \\end{pmatrix} $$\n$\\mathbf{C}$ 的第一列定义了占据轨道 $\\psi_1$，第二列定义了虚轨道 $\\psi_2$。\n\n给定参数 $\\alpha = -3$，$\\beta = 1$，$\\gamma = -1/2$ 和 $\\theta = \\pi/3$，计算占据轨道 $\\psi_1$ 和虚轨道 $\\psi_2$ 之间的轨道梯度元 $G_{12}$。", "solution": "我们在正交归一基中进行计算，因此 MO 基下的福克矩阵为\n$$\\mathbf{F}^{\\rm MO}= \\mathbf{C}^T\\,\\mathbf{F}\\,\\mathbf{C}\\,. $$  \n轨道梯度元是 MO 基下福克矩阵的 (1,2) 元素：\n$$G_{12} = (\\mathbf{F}^{\\rm MO})_{12}\n= \\sum_{\\mu,\\nu}C_{\\mu1}\\,F_{\\mu\\nu}\\,C_{\\nu2}\\,. $$\n这对应于矩阵乘法 $\\mathbf{C}_{:,1}^T \\mathbf{F} \\mathbf{C}_{:,2}$：\n$$ G_{12} = \\begin{pmatrix} \\cos\\theta & \\sin\\theta \\end{pmatrix} \\begin{pmatrix} \\alpha & \\gamma \\\\ \\gamma & \\beta \\end{pmatrix} \\begin{pmatrix} -\\sin\\theta \\\\ \\cos\\theta \\end{pmatrix} $$\n展开后得到：\n$$G_{12}\n=-\\alpha\\cos\\theta\\sin\\theta+\\gamma(\\cos^2\\theta-\\sin^2\\theta)\n+\\beta\\sin\\theta\\cos\\theta\n=(\\beta-\\alpha)\\cos\\theta\\sin\\theta+\\gamma(\\cos^2\\theta-\\sin^2\\theta)\\,. $$  \n使用三角恒等式 $\\cos^2\\theta-\\sin^2\\theta=\\cos(2\\theta)$ 和 $2\\cos\\theta\\sin\\theta=\\sin(2\\theta)$，\n$$G_{12}=\\frac{1}{2}(\\beta-\\alpha)\\sin(2\\theta)+\\gamma\\cos(2\\theta)\\,. $$  \n代入 $\\alpha=-3$，$\\beta=1$，$\\gamma=-\\frac{1}{2}$，$\\theta=\\pi/3$ 得到\n$$\\beta-\\alpha=4,\\quad\\sin(2\\theta)=\\sin\\frac{2\\pi}{3}=\\frac{\\sqrt3}{2},\\quad\n\\cos(2\\theta)=\\cos\\frac{2\\pi}{3}=-\\frac12$$  \n$$G_{12}=\\frac{1}{2}\\cdot4\\cdot\\frac{\\sqrt3}{2}+\\left(-\\frac12\\right)\\cdot\\left(-\\frac12\\right)\n=\\sqrt3+\\frac14\\,. $$", "answer": "$$\\boxed{\\sqrt{3}+\\frac14}$$", "id": "1148501"}, {"introduction": "当轨道梯度为零时，SCF过程收敛，得到最终的Hartree-Fock基态。这最后一个实践练习 [@problem_id:1148564] 提供了一个机会来验证这个收敛态的一个基本性质：Brillouin定理。通过明确计算HF基态和单激发态之间的哈密顿矩阵元素并证明其为零，您将证实HF理论的一个深刻结果，并巩固您对SCF解在平均场框架内被视为最优解的理解。", "problem": "在针对双电子闭壳层体系的Hartree-Fock (HF) 近似中，基态由单个Slater行列式 $\\Psi_0 = |\\psi_1\\alpha \\ \\psi_1\\beta|$ 描述，其中 $\\psi_1$ 是能量最低的已占空间分子轨道 (MO)，而 $\\alpha, \\beta$ 是自旋函数。Brillouin定理指出，HF基态与单激发行列式之间的哈密顿矩阵元为零。\n\n考虑一个由哈密顿算符 $\\hat{H} = \\hat{h}(1) + \\hat{h}(2) + \\hat{v}(1,2)$ 描述的模型双电子体系，其中 $\\hat{h}$ 是单电子算符（动能 + 核势能），$\\hat{v}(1,2)$ 是电子-电子排斥算符。使用由两个实的、正交归一的原子轨道 (AO) $\\chi_1$ 和 $\\chi_2$ 构成的最小基组进行限制性Hartree-Fock (RHF) 计算。计算已收敛，得到一个已占MO $\\psi_1$ 和一个未占MO $\\psi_2$。MO与AO通过以下变换相关联：\n$$\n\\begin{pmatrix} \\psi_1 \\\\ \\psi_2 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 & 1 \\\\ -1 & 1 \\end{pmatrix} \\begin{pmatrix} \\chi_1 \\\\ \\chi_2 \\end{pmatrix}\n$$\n\n基于AO基函数的必要单电子和双电子积分已经计算得出（以某个任意能量单位），如下所示：\n\n**单电子积分：** $h_{\\mu\\nu} = \\langle \\chi_\\mu | \\hat{h} | \\chi_\\nu \\rangle$\n- $h_{11} = A$\n- $h_{22} = B$\n- $h_{12} = h_{21} = C$\n\n**双电子积分：** $(\\mu\\nu|\\sigma\\lambda) = \\iint \\chi_\\mu(1)\\chi_\\nu(1) \\hat{v}(1,2) \\chi_\\sigma(2)\\chi_\\lambda(2) d\\mathbf{r}_1 d\\mathbf{r}_2$\n- $(11|11) = J_{11}$\n- $(22|22) = J_{22}$\n- $(11|22) = J_{12}$\n- $(12|12) = X$\n- $(11|12) = K_{1}$\n- $(12|22) = K_{2}$\n\n给定参数为：$A = 10$，$B=10$，$C=0$，$J_{11}=6$，$J_{22}=4$，$J_{12}=3$，$X=1/2$，$K_1=1$，$K_2=2$。\n\n您的任务是为该体系明确验证Brillouin定理。计算矩阵元 $\\langle \\Psi_0 | \\hat{H} | \\Psi_{1\\alpha \\to 2\\alpha} \\rangle$ 的值，其中 $\\Psi_{1\\alpha \\to 2\\alpha} = |\\psi_2\\alpha \\ \\psi_1\\beta|$ 是对应于自旋为 $\\alpha$ 的电子从轨道 $\\psi_1$ 激发到轨道 $\\psi_2$ 的Slater行列式。", "solution": "根据Slater-Condon规则，所求的哈密顿矩阵元等于占据轨道 $\\psi_1$ 和虚拟轨道 $\\psi_2$ 之间的福克矩阵元：$\\langle \\Psi_0 | \\hat{H} | \\Psi_{1\\alpha \\to 2\\alpha} \\rangle = F^{\\text{MO}}_{12}$。由于计算已收敛，根据Brillouin定理，该值应为零。我们通过显式计算来验证这一点。\n\n1.  **在AO基组中定义RHF密度矩阵**。对于双占据轨道 $\\psi_1$，自旋求和后的密度矩阵元为 $P_{\\mu\\nu}=2 C_{\\mu 1}C_{\\nu 1}$。由问题给出的 $\\psi_1=(\\chi_1+\\chi_2)/\\sqrt{2}$ 可知，轨道系数为 $C_{11}=1/\\sqrt{2}$ 和 $C_{21}=1/\\sqrt{2}$。因此，密度矩阵元为 $P_{11}=P_{12}=P_{21}=P_{22}=1$。\n\n2.  **在AO基组中构建福克矩阵**。福克矩阵元为 $F_{\\mu\\nu}=h_{\\mu\\nu}+\\sum_{\\sigma,\\lambda}P_{\\sigma,\\lambda}\\left[(\\mu\\nu|\\sigma\\lambda)-\\frac{1}{2}(\\mu\\sigma|\\nu\\lambda)\\right]$。由于所有 $P_{\\sigma\\lambda}=1$，我们展开双电子部分 $G_{\\mu\\nu} = F_{\\mu\\nu} - h_{\\mu\\nu}$：\n    *   $G_{11} = \\frac{1}{2}(11|11) + (11|12) + (11|22) - \\frac{1}{2}(12|12) = \\frac{1}{2}J_{11} + K_1 + J_{12} - \\frac{1}{2}X$\n    *   $G_{22} = (22|11) - \\frac{1}{2}(12|12) + (22|12) + \\frac{1}{2}(22|22) = J_{12} - \\frac{1}{2}X + K_2 + \\frac{1}{2}J_{22}$\n    因此，AO福克矩阵的对角元为：\n    *   $F_{11} = A + \\frac{1}{2}J_{11} + K_1 + J_{12} - \\frac{1}{2}X$\n    *   $F_{22} = B + J_{12} - \\frac{1}{2}X + K_2 + \\frac{1}{2}J_{22}$\n\n3.  **变换到MO基组**。我们需要计算 $F^{\\text{MO}}_{12} = \\langle\\psi_1|\\hat{F}|\\psi_2\\rangle$。根据问题定义，轨道系数矩阵为 $\\mathbf{C} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 & -1 \\\\ 1 & 1 \\end{pmatrix}$。通过基变换 $\\mathbf{F}^{\\text{MO}} = \\mathbf{C}^T \\mathbf{F} \\mathbf{C}$ 得到：\n    $$ F^{\\text{MO}}_{12} = \\sum_{\\mu,\\nu} C_{\\mu 1} F_{\\mu\\nu} C_{\\nu 2} = \\frac{1}{2} \\begin{pmatrix} 1 & 1 \\end{pmatrix} \\begin{pmatrix} F_{11} & F_{12} \\\\ F_{21} & F_{22} \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} $$\n    $$ F^{\\text{MO}}_{12} = \\frac{1}{2} (-F_{11} - F_{21} + F_{12} + F_{22}) $$\n    由于福克矩阵是对称的（$F_{12}=F_{21}$），上式简化为：\n    $$ F^{\\text{MO}}_{12} = \\frac{1}{2}(F_{22} - F_{11}) $$\n\n4.  **代入数值进行计算**。将第2步中 $F_{11}$ 和 $F_{22}$ 的表达式代入，得到：\n    $$ F^{\\text{MO}}_{12} = \\frac{1}{2} \\left[ (B - A) + \\frac{1}{2}(J_{22} - J_{11}) + (K_2 - K_1) \\right] $$\n    代入给定的参数值 $A=10, B=10, J_{11}=6, J_{22}=4, K_1=1, K_2=2$：\n    $$ F^{\\text{MO}}_{12} = \\frac{1}{2} \\left[ (10 - 10) + \\frac{1}{2}(4 - 6) + (2 - 1) \\right] = \\frac{1}{2} [ 0 - 1 + 1 ] = 0 $$\n    矩阵元为零，这验证了Brillouin定理。", "answer": "$$\\boxed{0}$$", "id": "1148564"}]}