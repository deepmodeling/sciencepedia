{"hands_on_practices": [{"introduction": "为了真正掌握ZX算图，我们必须从理论走向实践。本节的第一个练习将引导我们回到本源，通过直接应用其最基本的“状态求和”定义，来计算一个闭合图的标量值。这个练习 [@problem_id:1198196] 不仅能帮助你理解算图的数值是如何从其底层结构中产生的，而且也为后续所有更高级的化简规则奠定了概念基础。", "problem": "在一种被称为ZX演算的量子力学图形化演算中，量子态和算符由张量网络图表示。该演算的一个基本组成部分是“Z-spider”，这是一个具有任意数量边（腿）和相关相位的顶点。\n\n一个闭合图（没有外部腿的图）的标量值由一种按态求和的形式确定。考虑一个由一组顶点 $V$（spider）和一组连接它们的边 $E$ 组成的图。其值是通过对图中每条边的所有可能状态（$|0\\rangle$ 或 $|1\\rangle$）分配进行求和来找到的。\n\n求值规则如下：\n1.  一个分配是一个函数 $c: E \\to \\{0, 1\\}$，它将每条边映射到一个状态。\n2.  对于一个给定的分配 $c$，每个具有相位 $\\alpha_v$ 和关联边 $E_v$ 的Z-spider $v \\in V$ 对总乘积贡献一个因子：\n    -   如果 $E_v$ 中的所有边都被分配为状态 $|0\\rangle$（即对所有 $e \\in E_v$，$c(e)=0$），则贡献为 $1$。\n    -   如果 $E_v$ 中的所有边都被分配为状态 $|1\\rangle$（即对所有 $e \\in E_v$，$c(e)=1$），则贡献为 $e^{i\\alpha_v}$。\n    -   如果 $E_v$ 中的边被分配为 $|0\\rangle$ 和 $|1\\rangle$ 状态的混合，则贡献为 $0$。\n3.  整个图的值是所有 $2^{|E|}$ 种可能状态分配下这些顶点贡献的乘积之和。\n\n**问题：**\n考虑一个结构为四面体的闭合图。在四个顶点中的每一个上，都有一个Z-spider。所有四个spider都具有相同的相位 $\\alpha$。该图的边对应于四面体的六条边。\n\n计算当特定相位 $\\alpha = \\pi/3$ 时，该图的标量值。", "solution": "设顶点集为 $V = \\{v_1, v_2, v_3, v_4\\}$，边集为 $E$。该图是一个四面体，也就是完全图 $K_4$。顶点数为 $|V|=4$，边数为 $|E| = \\binom{4}{2} = 6$。每个顶点的度为3。\n\n该图的标量值（我们记为 $\\mathcal{Z}$）由所有可能的状态分配（着色）$c: E \\to \\{0, 1\\}$ 的总和给出：\n$$ \\mathcal{Z} = \\sum_{c: E \\to \\{0,1\\}} \\prod_{j=1}^{4} C(v_j, c) $$\n其中 $C(v_j, c)$ 是顶点 $v_j$ 处的spider对于着色 $c$ 的贡献。\n\n根据所给规则：\n-   如果与 $v_j$ 关联的所有边都被着色为0，则 $C(v_j, c) = 1$。\n-   如果与 $v_j$ 关联的所有边都被着色为1，则 $C(v_j, c) = e^{i\\alpha}$。\n-   如果与 $v_j$ 关联的边颜色混合，则 $C(v_j, c) = 0$。\n\n求和中的一个项非零，当且仅当乘积 $\\prod_{j=1}^{4} C(v_j, c)$ 非零。这要求对于每个顶点 $v_j$，其贡献 $C(v_j, c)$ 必须非零。这又意味着对于每个顶点 $v_j$，所有与其关联的边必须具有相同的颜色。\n\n我们来分析这个约束。图 $K_4$ 是连通的。我们任取一个顶点，比如 $v_1$。要使其贡献非零，所有与它关联的三条边，即 $(v_1, v_2)$、$(v_1, v_3)$ 和 $(v_1, v_4)$，必须具有相同的颜色，我们称之为 $k \\in \\{0, 1\\}$。\n\n现在考虑一个相邻的顶点，比如 $v_2$。要使其贡献非零，所有与它关联的三条边，即 $(v_2, v_1)$、$(v_2, v_3)$ 和 $(v_2, v_4)$，也必须具有相同的颜色。由于其中一条边 $(v_1, v_2)$ 已经被着色为 $k$，所以所有与 $v_2$ 关联的边也必须被着色为 $k$。\n\n我们可以对所有顶点重复这个论证。由于图是连通的，如果我们从任何一个顶点开始，并要求其关联边是单色的，这个颜色限制会传播到所有相邻的顶点，并随后传播到整个图。因此，要使整个乘积项非零，图中所有的边都必须具有相同的颜色。\n\n因此，在 $2^6 = 64$ 种可能的分配中，只有两种状态分配会产生非零贡献：\n1.  **全0分配 ($c_0$)**：每条边 $e \\in E$ 都被分配状态 $|0\\rangle$。\n2.  **全1分配 ($c_1$)**：每条边 $e \\in E$ 都被分配状态 $|1\\rangle$。\n\n我们来计算这两种分配各自的贡献值。\n\n**情况1：全0分配 ($c_0$)**\n对于每个顶点 $v_j$，所有与其关联的边都被着色为 0。根据规则，每个顶点的贡献是 $C(v_j, c_0) = 1$。\n此分配的总乘积是：\n$$ \\prod_{j=1}^{4} C(v_j, c_0) = 1 \\times 1 \\times 1 \\times 1 = 1 $$\n\n**情况2：全1分配 ($c_1$)**\n对于每个顶点 $v_j$，所有与其关联的边都被着色为 1。根据规则，每个顶点的贡献是 $C(v_j, c_1) = e^{i\\alpha}$。\n此分配的总乘积是：\n$$ \\prod_{j=1}^{4} C(v_j, c_1) = e^{i\\alpha} \\times e^{i\\alpha} \\times e^{i\\alpha} \\times e^{i\\alpha} = e^{i4\\alpha} $$\n\n总标量值 $\\mathcal{Z}$ 是所有可能分配的贡献之和。由于只有 $c_0$ 和 $c_1$ 有贡献，我们得到：\n$$ \\mathcal{Z} = (\\text{来自 } c_0 \\text{ 的贡献}) + (\\text{来自 } c_1 \\text{ 的贡献}) = 1 + e^{i4\\alpha} $$\n\n问题指定相位为 $\\alpha = \\pi/3$。代入此值：\n$$ \\mathcal{Z} = 1 + e^{i4\\pi/3} $$\n\n我们可以使用欧拉公式 $e^{i\\theta} = \\cos(\\theta) + i\\sin(\\theta)$ 来计算该复指数：\n$$ e^{i4\\pi/3} = \\cos\\left(\\frac{4\\pi}{3}\\right) + i\\sin\\left(\\frac{4\\pi}{3}\\right) $$\n角 $4\\pi/3$ 在第三象限。参考角是 $\\pi/3$。\n$$ \\cos\\left(\\frac{4\\pi}{3}\\right) = -\\cos\\left(\\frac{\\pi}{3}\\right) = -\\frac{1}{2} $$\n$$ \\sin\\left(\\frac{4\\pi}{3}\\right) = -\\sin\\left(\\frac{\\pi}{3}\\right) = -\\frac{\\sqrt{3}}{2} $$\n所以，$e^{i4\\pi/3} = -\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}$。\n\n最后，我们将此结果代入 $\\mathcal{Z}$ 的表达式中：\n$$ \\mathcal{Z} = 1 + \\left(-\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}\\right) = \\left(1 - \\frac{1}{2}\\right) - i\\frac{\\sqrt{3}}{2} = \\frac{1}{2} - i\\frac{\\sqrt{3}}{2} $$\n这就是该图的最终标量值。", "answer": "$$ \\boxed{\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}} $$", "id": "1198196"}, {"introduction": "在掌握了算图的基本定义之后，我们进而学习如何利用其强大的化简规则来简化计算。这个练习 [@problem_id:1198194] 将一个具体量子线路的振幅计算问题转化为一个算图化简任务。通过应用蜘蛛融合和双代数等核心规则，你将亲身体验到ZX算图如何将繁琐的矩阵乘法转变为直观的图形变换，从而高效地求解量子线路的性质。", "problem": "ZX-演算是用于量子计算推理的一种图形语言。它基于由称为“蛛”(spider)的特殊节点和连接它们的连线所组成的图。\n\n**背景：**\n1.  **蛛 (Spiders)：** 主要有两种类型的蛛：\n    *   **Z-蛛 (绿点)：** 一个具有 $m$ 个输入、$n$ 个输出和相位 $\\alpha \\in [0, 2\\pi)$ 的 Z-蛛记作 $Z(\\alpha)$。它代表一个线性映射，其在计算基 $\\{|0\\rangle, |1\\rangle\\}$ 下的矩阵元由 $\\langle i_1...i_n | Z(\\alpha) | j_1...j_m \\rangle = \\delta_{i_1...i_n,j_1...j_m,0...0} + e^{i\\alpha}\\delta_{i_1...i_n,j_1...j_m,1...1}$ 给出。这意味着它要求所有相连的线都处于同一状态（要么全部处于 $|0\\rangle$ 态，要么全部处于 $|1\\rangle$ 态），并在后一种情况下施加一个相位 $e^{i\\alpha}$。相位为 0 的蛛通常不加标记。\n    *   **X-蛛 (红点)：** 一个 X-蛛，记作 $X(\\alpha)$，在 Hadamard 变换后的基 $\\{|+\\rangle, |-\\rangle\\}$ 中有类似的定义。一个 $X(0)$ 蛛可以用 Z-蛛和 Hadamard 门（$H$）定义为 $X(0) = H Z(0) H$。\n\n2.  **特殊图：**\n    *   计算基态 $|0\\rangle$ 和 $|1\\rangle$ 由带有一条输出线的 Z-蛛表示：$|0\\rangle \\equiv Z(0)$ 和 $|1\\rangle \\equiv Z(\\pi)$。右矢 $\\langle 0|$ 和 $\\langle 1|$ 相同，但带有一条输入线。\n    *   CNOT 门，其中第一个量子比特为控制位，第二个为目标位（$\\text{CNOT}_{12}$），表示为控制量子比特线上的一个 Z(0) 蛛通过一条边连接到目标量子比特线上的一个 X(0) 蛛。\n\n    $$\n    \\text{CNOT}_{12} =\n    \\vcenter{\\hbox{\n    \\begin{tikzpicture}\n    \\node[circle,fill=green, scale=0.6] (Z) at (0,0.5) {};\n    \\node[circle,fill=red, scale=0.6] (X) at (0,-0.5) {};\n    \\draw (Z) -- (X);\n    \\draw (-1, 0.5) -- (Z) -- (1, 0.5);\n    \\draw (-1, -0.5) -- (X) -- (1, -0.5);\n    \\end{tikzpicture}\n    }}\n    $$\n\n3.  **复合与求值：**\n    *   **顺序复合 ($U_2 \\circ U_1$):** 将 $U_1$ 的输出线连接到 $U_2$ 的输入线。\n    *   **张量积 ($U_1 \\otimes U_2$):** 将 $U_1$ 的图置于 $U_2$ 的图的上方。\n    *   **矩阵元 $\\langle \\psi | U | \\phi \\rangle$：** 这由一个闭合图（没有输入或输出的图）表示，该图通过将 $|\\phi\\rangle$ 的图连接到 $U$ 的输入，并将 $\\langle \\psi |$ 的图连接到 $U$ 的输出来获得。\n    *   **标量求值：** 闭合图的计算结果是一个复数。一个相位为 $\\alpha$ 且没有连接任何线的 Z-蛛（其本身就是一个图）的值为标量 $1+e^{i\\alpha}$。具有多个不相连组件的图的值是它们各自值的乘积。\n\n4.  **化简规则：**\n    *   **蛛融合：** 任何两个相连的同色蛛会融合成一个该颜色的蛛。它们的相位会相加（模 $2\\pi$）。\n    *   **双代数规则：** 一个 Z-蛛和一个 X-蛛可以相互“穿过”。对于任何通过一条或多条线连接的 Z-蛛（绿色）和 X-蛛（红色），以下恒等式成立：\n\n    $$\n    \\vcenter{\\hbox{\n    \\begin{tikzpicture}\n    \\node[circle,fill=green, scale=0.6] (Z) at (0,0) {};\n    \\node[circle,fill=red, scale=0.6] (X) at (1,0) {};\n    \\draw (Z) -- (X);\n    \\draw (Z) -- (-0.7, 0.5);\n    \\draw (Z) -- (-0.7, -0.5);\n    \\draw (X) -- (1.7, 0.5);\n    \\draw (X) -- (1.7, -0.5);\n    \\end{tikzpicture}\n    }}\n    \\quad = \\quad\n    \\vcenter{\\hbox{\n    \\begin{tikzpicture}\n    \\node[circle,fill=red, scale=0.6] (X1) at (-0.5,0.5) {};\n    \\node[circle,fill=red, scale=0.6] (X2) at (-0.5,-0.5) {};\n    \\node[circle,fill=green, scale=0.6] (Z1) at (0.5,0.5) {};\n    \\node[circle,fill=green, scale=0.6] (Z2) at (0.5,-0.5) {};\n    \\draw (-1.2, 0.5) -- (X1) -- (Z1) -- (1.2, 0.5);\n    \\draw (-1.2, -0.5) -- (X2) -- (Z2) -- (1.2, -0.5);\n    \\draw (X1) -- (Z2);\n    \\draw (X2) -- (Z1);\n    \\end{tikzpicture}\n    }}\n    $$\n    对于 CNOT 电路，一个关键的推论是，通过一条边连接的 Z(0) 蛛和 X(0) 蛛可以通过将 Z-蛛“复制”到 X-蛛的其他腿上来解耦。\n\n**问题：**\n考虑三量子比特算符 $U = (I \\otimes \\text{CNOT}_{23}) \\circ (\\text{CNOT}_{12} \\otimes I) \\circ (I \\otimes \\text{CNOT}_{23})$，其中 $\\text{CNOT}_{ij}$ 是以量子比特 $i$ 为控制位、量子比特 $j$ 为目标位的 CNOT 门。\n\n你的任务是计算矩阵元 $\\langle 101 | U | 011 \\rangle$ 的值。你必须使用 ZX-演算进行此计算。化简相应的 ZX-图，直到它成为一个标量值。", "solution": "首先，我们将整个计算过程表示为一个闭合的ZX图。这包括将算符 $U$、输入态 $|011\\rangle$ 和输出态 $\\langle 101|$ 都转换为它们的ZX图表示，并将它们连接起来。\n然后，我们应用“蛛融合”规则，将每条量子比特线上的所有同色（绿色）Z蛛融合成一个。\n- 线1的Z蛛净相位为：$0$ (来自输入 $|0\\rangle$) + $0$ (来自CNOT) + $\\pi$ (来自输出 $\\langle 1|$) = $\\pi$。\n- 线2的Z蛛净相位为：$\\pi$ (来自输入 $|1\\rangle$) + $0$ (来自第一个CNOT) + $0$ (来自第二个CNOT) + $0$ (来自输出 $\\langle 0|$) = $\\pi$。\n- 线3的Z蛛净相位为：$\\pi$ (来自输入 $|1\\rangle$) + $\\pi$ (来自输出 $\\langle 1|$) = $2\\pi \\equiv 0$。\n此时的图是一个由Z蛛（相位分别为$\\pi, \\pi, 0$）和X蛛（来自CNOT门）构成的网络。通过应用包括“双代数规则”在内的化简规则，这个复杂的网络图最终可以被化简为一个单一的、孤立的、相位为$\\pi$的Z蛛。\n一个孤立的、相位为$\\alpha$的Z蛛的标量值为 $1 + e^{i\\alpha}$。因此，该图的最终值为：\n$$ 1 + e^{i\\pi} = 1 - 1 = 0 $$\n所以，该矩阵元的值为0。", "answer": "$$\\boxed{0}$$", "id": "1198194"}, {"introduction": "ZX算图的威力远不止于简化计算，它在量子编译和线路优化领域扮演着至关重要的角色。这个实践练习 [@problem_id:1198219] 聚焦于一个核心的优化问题：如何最小化容错量子计算中成本高昂的 $T$ 门数量。通过将一个复杂的ZX算图化简为“相位小装置范式”（phase-gadget normal form），你将学会如何利用图形方法来分析和减少线路的非Clifford资源，这是量子计算研究中的一个前沿课题。", "problem": "ZX-calculus是一种用于量子过程推理的图形语言。它由被称为“spider”的节点和代表量子比特的线连接而成的图组成。两种基本类型的spider是Z-spider（绿色，记作 $Z(\\alpha)$）和X-spider（红色，记作 $X(\\beta)$），每个都有一个相位 $\\alpha$ 或 $\\beta$。一个由Clifford+T门组成的量子线路可以被转换成一个ZX图，其中T门对应于相位是 $\\pi/4$ 奇数倍的spider。\n\nT门数量优化的一个常用策略是将一个线路的ZX图转换为*相位器件范式*（phase-gadget normal form）。这种范式由一个相互连接的X-spider（具有Clifford相位，即 $\\pi$ 的倍数）的“骨架”组成，该骨架代表一个图态，并由放置在线上的、被称为*相位器件*（phase gadgets）的Z-spider进行装饰。这样一个图的T门数量被定义为相位是 $\\pi/4$ 奇数倍的相位器件的数量。\n\n考虑一个具有两个输入（$i_1, i_2$）和两个输出（$o_1, o_2$）的ZX图。该图的骨架由三个相位均为0的X-spider（$X_1$、$X_2$和$X_3$）组成。它们的连接性如下：\n- $X_1$ 连接到输入 $i_1$、输出 $o_1$，以及$X_2$和$X_3$。\n- $X_2$ 连接到输入 $i_2$，以及$X_1$和$X_3$。\n- $X_3$ 连接到输出 $o_2$，以及$X_1$和$X_2$。\n\n这形成了一个X-spider三角形。该图有四个Z-spider相位器件：\n- 相位为 $\\alpha = \\pi/4$ 的器件 $Z_A$ 位于连接 $X_1$ 和 $X_2$ 的线上。\n- 相位为 $\\beta = 3\\pi/4$ 的器件 $Z_B$ 位于连接 $X_1$ 和 $X_3$ 的线上。\n- 相位为 $\\gamma = -3\\pi/4$ 的器件 $Z_C$ 位于连接 $X_2$ 和 $X_3$ 的线上。\n- 相位为 $\\delta = \\pi/2$ 的器件 $Z_D$ 位于连接输入 $i_2$ 和 $X_2$ 的线上。\n\n使用ZX-calculus的重写规则，将此图简化为一个功能相同但非Clifford相位器件数量最少的形式。这个最小T门数量是多少？", "solution": "给定的ZX图有一个由三个初始相位为0的X-spider（$X_1$、$X_2$、$X_3$）组成的骨架，以及四个Z-spider相位器件：\n- $Z_A$，相位为 $\\alpha = \\pi/4$，位于 $X_1$ 和 $X_2$ 之间的线上。\n- $Z_B$，相位为 $\\beta = 3\\pi/4$，位于 $X_1$ 和 $X_3$ 之间的线上。\n- $Z_C$，相位为 $\\gamma = -3\\pi/4$，位于 $X_2$ 和 $X_3$ 之间的线上。\n- $Z_D$，相位为 $\\delta = \\pi/2$，位于输入 $i_2$ 和 $X_2$ 之间的线上。\n\nT门数量是相位为 $\\pi/4$ 奇数倍的相位器件的数量。初始时：\n- $\\alpha = \\pi/4 = (1) \\cdot \\pi/4$ （奇数倍，非Clifford）。\n- $\\beta = 3\\pi/4 = (3) \\cdot \\pi/4$ （奇数倍，非Clifford）。\n- $\\gamma = -3\\pi/4 = (-3) \\cdot \\pi/4$ （奇数倍，非Clifford）。\n- $\\delta = \\pi/2 = (2) \\cdot \\pi/4$ （偶数倍，Clifford）。\n\n初始T门数量为3。目标是使用ZX-calculus的重写规则将其最小化。\n\n使用X-spider三角形中关于边相位器件的恒等式，边上的每个Z相位器件可以分裂为两个附加在相邻顶点上的半相位器件。具体来说：\n- 一个位于两个X-spider之间边上、相位为 $\\phi$ 的相位器件，等价于将 $\\phi/2$ 加到每个相邻X-spider的相位上。\n\n将此规则应用于三角形的边：\n- 对于 $Z_A$ ($\\alpha = \\pi/4$)：将 $\\alpha/2 = \\pi/8$ 加到 $X_1$ 和 $X_2$ 上。\n- 对于 $Z_B$ ($\\beta = 3\\pi/4$)：将 $\\beta/2 = 3\\pi/8$ 加到 $X_1$ 和 $X_3$ 上。\n- 对于 $Z_C$ ($\\gamma = -3\\pi/4$)：将 $\\gamma/2 = -3\\pi/8$ 加到 $X_2$ 和 $X_3$ 上。\n\nX-spider的相位变为：\n- $X_1$：$0 + \\alpha/2 + \\beta/2 = 0 + \\pi/8 + 3\\pi/8 = 4\\pi/8 = \\pi/2$。\n- $X_2$：$0 + \\alpha/2 + \\gamma/2 = 0 + \\pi/8 - 3\\pi/8 = -2\\pi/8 = -\\pi/4$。\n- $X_3$：$0 + \\beta/2 + \\gamma/2 = 0 + 3\\pi/8 - 3\\pi/8 = 0$。\n\n边相位器件 $Z_A$、$Z_B$ 和 $Z_C$ 被移除。现在的图包含带有相位的骨架，以及仍然在 $X_2$ 输入线上的 $Z_D$。\n\n接下来，将 $Z_D$ 吸收到 $X_2$ 中：一个连接到X-spider的Z相位器件会将其相位加到该spider上。因此，$X_2$的相位变为：\n- $X_2$：$-\\pi/4 + \\delta = -\\pi/4 + \\pi/2 = -\\pi/4 + 2\\pi/4 = \\pi/4$。\n\n现在的图具有：\n- $X_1$：相位 $\\pi/2$。\n- $X_2$：相位 $\\pi/4$。\n- $X_3$：相位 $0$。\n- 没有剩余的边或输入相位器件。\n\n为了使骨架处于相位器件范式且不带额外的非Clifford器件，X-spider上的相位必须是Clifford相位（$\\pi/2$的倍数）。检查：\n- $X_1$：$\\pi/2 = 2 \\cdot (\\pi/4)$（$\\pi/4$的偶数倍），Clifford。\n- $X_2$：$\\pi/4 = 1 \\cdot (\\pi/4)$（$\\pi/4$的奇数倍），非Clifford。\n- $X_3$：$0$，Clifford。\n\n为了表示 $X_2$ 上的非Clifford相位 $\\pi/4$，我们将 $X_2$ 分解为一个相位为0的X-spider和一个连接到其一条支路上、相位为 $\\pi/4$ 的Z相位器件。这可以通过以下恒等式完成：\n- 一个相位为 $\\phi$ 的X-spider等价于一个相位为0的X-spider和一个连接到其任意一条支路上、相位为 $\\phi$ 的Z相位器件。\n\n因此，相位为 $\\pi/4$ 的 $X_2$ 被替换为相位为0的 $X_2$ 和一个附加在 $X_2$ 某条线上、相位为 $\\pi/4$ 的Z相位器件 $Z$。由于 $\\pi/4$ 是 $\\pi/4$ 的奇数倍，该器件是非Clifford器件。\n\n最终的图具有：\n- 骨架X-spider：$X_1$（$\\pi/2$，Clifford），$X_2$（$0$，Clifford），$X_3$（$0$，Clifford）。\n- 一个相位为 $\\pi/4$ 的Z相位器件（非Clifford）。\n\nT门数量是非Clifford相位器件的数量，即1。这是最小的，因为非Clifford相位 $\\pi/4$ 必须存在，并且不能被消除或进一步组合成模 $2\\pi$ 的Clifford相位。", "answer": "$$\\boxed{1}$$", "id": "1198219"}]}