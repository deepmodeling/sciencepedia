{"hands_on_practices": [{"introduction": "窃听者Eve获取信息最直接的方式是“拦截-重发”(intercept-resend)攻击。在本练习中，我们将分析这种基本情景，以量化Eve不可避免地引入到量子信道中的扰动。通过推导期望的量子比特误码率(Quantum Bit Error Rate, QBER)，您将直接看到量子测量原理如何使窃听行为变得可被探测 [@problem_id:715084]。", "problem": "在用于量子密钥分发的BB84协议中，Alice向Bob发送单光子（量子比特）。她使用两个随机选择的基中的一个来编码她的比特'0'和'1'：\n1.  直线基（Z基）：$\\{|0\\rangle, |1\\rangle\\}$\n2.  对角基（X基）：$\\{|+\\rangle, |-\\rangle\\}$，其中 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle+|1\\rangle)$ 且 $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle-|1\\rangle)$。\n\n窃听者 Eve 进行拦截重发攻击。她拦截来自Alice的每一个量子比特，在她选择的基上进行测量，然后将一个根据她测量到的状态制备的新量子比特发送给Bob。Eve 不知道Alice为每个量子比特选择的基。她的策略是概率性地选择测量基：她以概率 $p$ 选择Z基，以概率 $1-p$ 选择X基。\n\n传输完成后，Alice和Bob进行筛选：他们通过一个公共信道通信，比较他们选择的基，并丢弃那些他们使用了不同基的比特。剩下的比特序列就是筛选密钥。量子比特错误率（QBER）是指在该筛选密钥中Bob接收错误的比特所占的比例。\n\n假设Alice为每次传输都以均匀概率选择她的基（Z或X）和她的比特值（'0'或'1'）。给定Eve选择基的概率为 $p = 1/3$，推导Alice和Bob将在他们的筛选密钥中观察到的预期QBER。", "solution": "量子比特错误率（QBER）是在筛选密钥上计算的，筛选密钥只包含Alice和Bob使用相同测量基的比特。由于Alice是均匀随机地选择她的基，筛选后的比特中将有一半对应于双方都使用Z基的情况，另一半对应于双方都使用X基的情况。我们需要计算每种情况下的错误率，然后将它们平均。\n\n令 $Q_Z$ 为Alice和Bob都使用Z基时的错误率。\n令 $Q_X$ 为Alice和Bob都使用X基时的错误率。\n\n**1. 计算 $Q_Z$ (Alice和Bob使用Z基)**\n\n不失一般性，假设Alice发送状态 $|0\\rangle$。\nEve 拦截这个量子比特。\n- Eve以概率 $p$ 选择Z基。她测量 $|0\\rangle$，并以概率1正确地将状态识别为 $|0\\rangle$。然后她将 $|0\\rangle$ 发送给Bob。Bob使用Z基测量，得到 $|0\\rangle$。在这种情况下，没有错误发生。对错误率的贡献是 $p \\times 0 = 0$。\n- Eve以概率 $1-p$ 选择X基。她在 $\\{|+\\rangle, |-\\rangle\\}$ 基上测量状态 $|0\\rangle$。该状态可以写成 $|0\\rangle = \\frac{1}{\\sqrt{2}}(|+\\rangle + |-\\rangle)$。\n    - Eve以概率 $|\\langle+|0\\rangle|^2 = 1/2$ 测量到 $|+\\rangle$。然后她将 $|+\\rangle$ 发送给Bob。\n    - Eve以概率 $|\\langle-|0\\rangle|^2 = 1/2$ 测量到 $|-\\rangle$。然后她将 $|-\\rangle$ 发送给Bob。\n\n现在，Bob在Z基上测量他从Eve那里收到的状态。\n- 如果Bob收到 $|+\\rangle$ 并进行测量。该状态为 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$。Bob以概率 $1/2$ 测量到 $|0\\rangle$ （正确），以概率 $1/2$ 测量到 $|1\\rangle$ （错误）。\n- 如果Bob收到 $|-\\rangle$ 并进行测量。该状态为 $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$。Bob以概率 $1/2$ 测量到 $|0\\rangle$ （正确），以概率 $1/2$ 测量到 $|1\\rangle$ （错误）。\n\n当Eve使用X基时，发生错误的概率是 $1/2$。\n总错误率 $Q_Z$ 是所有导致错误的路径的概率之和：\n$$Q_Z = p \\cdot (0) + (1-p) \\cdot \\left[ \\left(\\frac{1}{2}\\right)_{\\text{Eve measures +}} \\cdot \\left(\\frac{1}{2}\\right)_{\\text{Bob gets error}} + \\left(\\frac{1}{2}\\right)_{\\text{Eve measures -}} \\cdot \\left(\\frac{1}{2}\\right)_{\\text{Bob gets error}} \\right]$$\n$$Q_Z = (1-p) \\left( \\frac{1}{4} + \\frac{1}{4} \\right) = \\frac{1-p}{2}$$\n\n**2. 计算 $Q_X$ (Alice和Bob使用X基)**\n\n不失一般性，假设Alice发送状态 $|+\\rangle$。\nEve 拦截这个量子比特。\n- Eve以概率 $p$ 选择Z基。她测量 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$。\n    - Eve以概率 $1/2$ 测量到 $|0\\rangle$ 并发送 $|0\\rangle$。\n    - Eve以概率 $1/2$ 测量到 $|1\\rangle$ 并发送 $|1\\rangle$。\nBob接收到这个状态，并在X基上进行测量。\n- 如果Bob收到 $|0\\rangle = \\frac{1}{\\sqrt{2}}(|+\\rangle + |-\\rangle)$，他以概率 $1/2$ 测量到 $|+\\rangle$ （正确），以概率 $1/2$ 测量到 $|-\\rangle$ （错误）。\n- 如果Bob收到 $|1\\rangle = \\frac{1}{\\sqrt{2}}(|+\\rangle - |-\\rangle)$，他以概率 $1/2$ 测量到 $|+\\rangle$ （正确），以概率 $1/2$ 测量到 $|-\\rangle$ （错误）。\n如果Eve使用Z基，发生错误的概率是 $1/2$。\n- Eve以概率 $1-p$ 选择X基。她正确地测量到 $|+\\rangle$，将 $|+\\rangle$ 发送给Bob，Bob也测量到 $|+\\rangle$。没有错误发生。对错误率的贡献是 $(1-p) \\times 0 = 0$。\n\n总错误率 $Q_X$ 为：\n$$Q_X = p \\cdot \\left[ \\left(\\frac{1}{2}\\right)_{\\text{Eve measures 0}} \\cdot \\left(\\frac{1}{2}\\right)_{\\text{Bob gets error}} + \\left(\\frac{1}{2}\\right)_{\\text{Eve measures 1}} \\cdot \\left(\\frac{1}{2}\\right)_{\\text{Bob gets error}} \\right] + (1-p) \\cdot (0)$$\n$$Q_X = p \\left( \\frac{1}{4} + \\frac{1}{4} \\right) = \\frac{p}{2}$$\n\n**3. 计算总QBER**\n\n由于Alice均匀地选择她的基，最终的筛选密钥平均将包含数量相等的、源自 Z 基和 X 基选择相同的比特。总QBER是 $Q_Z$ 和 $Q_X$ 的平均值。\n$$QBER = \\frac{1}{2} Q_Z + \\frac{1}{2} Q_X$$\n$$QBER = \\frac{1}{2} \\left( \\frac{1-p}{2} \\right) + \\frac{1}{2} \\left( \\frac{p}{2} \\right) = \\frac{1-p+p}{4} = \\frac{1}{4}$$\n\n有趣的是，QBER与Eve选择基的概率 $p$ 无关。题目中指定 $p = 1/3$。将这个值（或任何其他值）代入最终表达式不会改变结果。\n$$QBER = \\frac{1}{4}$$", "answer": "$$ \\boxed{\\frac{1}{4}} $$", "id": "715084"}, {"introduction": "更复杂的窃听策略涉及相干相互作用，即Eve将自己的量子系统与Alice发送的量子比特纠缠起来。本练习模拟了一种典型的“CNOT攻击”，在这种攻击中，攻击者可以调整其引起的扰动。您将探索攻击者参数与最终产生的比特误码率之间的关系，从而更深入地理解量子安全分析的精妙之处 [@problem_id:714929]。", "problem": "在BB84量子密钥分发协议的背景下，窃听者Eve试图获取关于密钥的信息。她通过拦截从Alice发送给Bob的量子比特来实施一种广义CNOT攻击。Eve使用一个CNOT门，其中信号量子比特作为控制量子比特，她自己的辅助量子比特作为目标。\n\nBB84协议中使用的四个量子态来自两组互不相关的基：\n1.  直线基 (Z基)：$\\{|0\\rangle, |1\\rangle\\}$\n2.  对角基 (X基)：$\\{|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle), |-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)\\}$\n\nAlice随机选择一组基以及该基中的一个量子态发送给Bob。Bob也随机选择一组基进行测量。之后他们通过经典信道通信，丢弃在不匹配的基上进行的测量，从而形成“筛选密钥”。\n\nEve的CNOT攻击由作用于信号量子比特(A)和她的辅助量子比特(E)的组合系统上的幺正变换 $U_{CNOT}$ 描述：$U_{CNOT}|c\\rangle_A |t\\rangle_E = |c\\rangle_A |t \\oplus c\\rangle_E$。为了实施攻击，Eve将她的辅助量子比特制备在一般纯态 $|\\psi\\rangle_E = \\cos\\theta |0\\rangle_E + \\sin\\theta |1\\rangle_E$ 上，其中 $\\theta$ 是由Eve控制的一个实数参数。\n\n假设Alice和Bob以相等的概率（Z基为1/2，X基为1/2）选择他们的基，请推导这种攻击在筛选密钥中引入的平均量子比特误码率(QBER)，记为 $e_{bit}$。QBER定义为筛选密钥中Bob接收错误的那部分比特所占的比例。请用参数 $\\theta$ 表示你的答案。", "solution": "1. 相关方程\n– CNOT 作用：\n$$U_{CNOT}|c\\rangle_A|t\\rangle_E=|c\\rangle_A|t\\oplus c\\rangle_E.$$\n– Eve的辅助量子比特：\n$$|\\psi\\rangle_E=\\cos\\theta\\,|0\\rangle_E+\\sin\\theta\\,|1\\rangle_E.$$\n– QBER $e_{bit}$ 是在筛选密钥中，Bob的比特与Alice的比特不同的平均概率。\n\n2. Z基情况\nAlice发送 $|0\\rangle_A$ 或 $|1\\rangle_A$。经过CNOT门后：\n\n$$\n|0\\rangle_A(\\cos\\theta|0\\rangle_E+\\sin\\theta|1\\rangle_E)\\to|0\\rangle_A(\\cos\\theta|0\\rangle_E+\\sin\\theta|1\\rangle_E),\n$$\n\n$$\n|1\\rangle_A(\\cos\\theta|0\\rangle_E+\\sin\\theta|1\\rangle_E)\\to|1\\rangle_A(\\cos\\theta|1\\rangle_E+\\sin\\theta|0\\rangle_E).\n$$\n  \n在Z基下，信号量子比特未发生改变 ⇒ 无错误：\n$$e_Z=0.$$\n\n3. X基情况\nAlice发送 $|\\pm\\rangle_A=\\tfrac{1}{\\sqrt2}(|0\\rangle\\pm|1\\rangle)$。联合输入为\n\n$$\n|\\Psi_{\\pm}\\rangle\n=\\tfrac{1}{\\sqrt2}(|0\\rangle_A\\pm|1\\rangle_A)(\\cos\\theta|0\\rangle_E+\\sin\\theta|1\\rangle_E).\n$$\n  \n经过CNOT门后，对于“+”输入：\n\n$$\n|\\Psi\\rangle\n=\\tfrac{1}{\\sqrt2}\\bigl[\\cos\\theta(|0,0\\rangle+|1,1\\rangle)\n+\\sin\\theta(|0,1\\rangle+|1,0\\rangle)\\bigr].\n$$\n  \n计算A上的约化态：\n\n$$\n\\rho_A\n=\\mathrm{Tr}_E|\\Psi\\rangle\\langle\\Psi|\n=\\tfrac12\\begin{pmatrix}1 & \\sin2\\theta\\\\\\sin2\\theta & 1\\end{pmatrix}\n=\\tfrac12\\bigl(I+\\sin2\\theta\\,X\\bigr).\n$$\n  \nBob在X基下进行测量。错误概率（发送“+”但得到“-”）为\n\n$$\nP(-)\n=\\langle -|\\rho_A|-\\rangle\n=\\tfrac12\\bigl(1-\\sin2\\theta\\bigr).\n$$\n  \n根据对称性，对于“-”输入同样成立。因此\n$$e_X=\\frac{1-\\sin2\\theta}{2}.$$\n\n4. 平均QBER\nAlice和Bob以1/2的概率使用各自的基；筛选密钥选择了基匹配的事件。因此\n\n$$\ne_{bit}\n=\\tfrac12\\,e_Z+\\tfrac12\\,e_X\n=\\tfrac12\\cdot0+\\tfrac12\\cdot\\tfrac{1-\\sin2\\theta}{2}\n=\\frac{1-\\sin2\\theta}{4}.\n$$", "answer": "$$\\boxed{\\frac{1-\\sin(2\\theta)}{4}}$$", "id": "714929"}, {"introduction": "QKD的最终目标不仅仅是检测错误，而是从含有噪声的数据中提炼出可证安全的密钥。本练习将物理信道错误与信息论安全性联系起来。通过为特定噪声模型计算比特误码率($e_{bit}$)和相位误码率($e_{phase}$)，并将其应用于安全密钥率公式，您将能够量化BB84系统的性能，并理解生成密钥所需满足的条件 [@problem_id:714902]。", "problem": "在量子密钥分发 (QKD) 的背景下，BB84 协议是双方（传统上称为 Alice 和 Bob）之间建立共享密钥的基石方法。Alice 在两组互无偏基中的四种状态之一制备量子比特：Z 基 $\\{|0\\rangle, |1\\rangle\\}$ 或 X 基 $\\{|+\\rangle, |-\\rangle\\}$。Bob 随机选择在 Z 基或 X 基中测量每个传入的量子比特。\n\n生成安全密钥的过程会受到连接 Alice 和 Bob 的量子信道中噪声的损害。考虑一个特定的噪声信道，它以概率 $p$ 对传输的量子比特施加一个泡利-Y 错误 ($\\sigma_Y$)，并以概率 $1-p$ 保持量子比特不变（施加单位算符 $I$）。\n\n该协议的性能和安全性由两个关键参数量化：\n1.  量子比特错误率 ($e_{bit}$)，即 Alice 和 Bob 的筛选密钥中不同比特所占的比例。这是通过在他们丢弃所有使用不同基的实例后，比较一部分比特来确定的。由于协议的对称性，我们可以通过考虑 Alice 和 Bob 都使用 Z 基时的错误概率来计算 $e_{bit}$。\n2.  相位错误率 ($e_{phase}$)，即在共轭基中本应观察到的错误率。对于在 Z 基中建立的密钥，$e_{phase}$ 是指如果双方都使用了 X 基进行测量时会得到的错误率。\n\n在渐近极限（无限长密钥）下，安全密钥率 $r$（每个传输的量子比特中安全密钥比特的比例）的下界由 Devetak-Winter 公式给出，对于 BB84 协议，该公式简化为：\n$$r = 1 - H_2(e_{bit}) - H_2(e_{phase})$$\n其中 $H_2(x) = -x \\log_2(x) - (1-x) \\log_2(1-x)$ 是二元香农熵函数。只有当错误率不太高时，才可能获得正的安全密钥率 ($r > 0$)。\n\n量子态和算符定义如下：\n$|0\\rangle = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, |1\\rangle = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$\n$|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle+|1\\rangle), |-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle-|1\\rangle)$\n$\\sigma_Y = \\begin{pmatrix} 0 & -i \\\\ i & 0 \\end{pmatrix}$\n\n你的任务是推导这个特定噪声信道的安全密钥率 $r$。请用错误概率 $p$ 和二元熵函数 $H_2(x)$ 来表示你的最终答案。", "solution": "1. 量子比特错误率：当双方都使用 Z 基时，一个泡利-Y 错误会翻转 $|0\\rangle\\leftrightarrow|1\\rangle$，所以\n$$e_{bit}=p.$$\n2. 相位错误率：在 X 基中，\n$$\\sigma_Y|+\\rangle=(-i)|-\\rangle,\\quad \\sigma_Y|-\\rangle= i|+\\rangle,$$\n所以一个 Y 错误也会翻转 $|+\\rangle\\leftrightarrow|-\\rangle$，得到\n$$e_{phase}=p.$$\n3. 代入 Devetak–Winter 公式：\n$$r=1-H_2(e_{bit})-H_2(e_{phase})\n=1-H_2(p)-H_2(p)\n=1-2\\,H_2(p).$$", "answer": "$$\\boxed{1-2H_2(p)}$$", "id": "714902"}]}