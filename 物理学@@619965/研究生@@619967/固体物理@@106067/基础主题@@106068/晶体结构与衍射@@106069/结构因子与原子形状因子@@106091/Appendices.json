{"hands_on_practices": [{"introduction": "在深入研究整个晶体的衍射现象之前，我们必须首先理解单个原子的散射行为。原子的散射能力由其原子形态因子 $f(\\mathbf{q})$ 描述，它本质上是原子电子密度分布的傅里叶变换。这个练习将指导你为一个常见的、数学上易于处理的高斯电子密度模型推导出原子形态因子，从而将抽象的定义与具体的数学计算联系起来。[@problem_id:217999]", "problem": "在X射线散射实验中，来自孤立原子的散射由原子形状因子 $f(\\mathbf{q})$ 描述。这个量是原子电子密度分布 $\\rho(\\mathbf{r})$ 的傅里叶变换，由下式给出：\n$$ f(\\mathbf{q}) = \\int \\rho(\\mathbf{r}) e^{-i \\mathbf{q} \\cdot \\mathbf{r}} d^3r $$\n其中 $\\mathbf{q}$ 是散射矢量，表示散射X射线的波矢量的变化。\n\n考虑一个包含 $Z$ 个电子的中性原子的模型。假设电子电荷在原子核周围连续且球对称分布。电子密度由径向距离 $r = |\\mathbf{r}|$ 的高斯函数描述：\n$$ \\rho(r) = A e^{-\\alpha r^2} $$\n其中 $A$ 和 $\\alpha$ 是正常数。常数 $A$ 由归一化条件确定，即电子密度在整个空间上的积分必须等于总电子数 $Z$：\n$$ \\int \\rho(\\mathbf{r}) d^3r = Z $$\n\n基于此模型，推导出原子形状因子 $f(q)$，作为散射矢量大小 $q = |\\mathbf{q}|$ 的函数。用 $Z$、$\\alpha$ 和 $q$ 表示你的最终答案。", "solution": "求解过程包括两个主要步骤：首先，确定归一化常数 $A$；其次，计算电子密度的傅里叶变换。\n\n**步骤1：确定归一化常数 A**\n\n我们使用归一化条件 $\\int \\rho(\\mathbf{r}) d^3r = Z$。由于密度 $\\rho(r)$ 是球对称的，我们可以在球坐标系中计算该积分，其中 $d^3r = r^2 \\sin\\theta dr d\\theta d\\phi$。\n\n$$ Z = \\int_0^{2\\pi} d\\phi \\int_0^\\pi \\sin\\theta d\\theta \\int_0^\\infty \\rho(r) r^2 dr $$\n代入 $\\rho(r) = A e^{-\\alpha r^2}$：\n$$ Z = A \\left( \\int_0^{2\\pi} d\\phi \\right) \\left( \\int_0^\\pi \\sin\\theta d\\theta \\right) \\left( \\int_0^\\infty e^{-\\alpha r^2} r^2 dr \\right) $$\n角度积分很简单：\n$$ \\int_0^{2\\pi} d\\phi = 2\\pi $$\n$$ \\int_0^\\pi \\sin\\theta d\\theta = [-\\cos\\theta]_0^\\pi = -(-1 - 1) = 2 $$\n所以积分变为：\n$$ Z = A (4\\pi) \\int_0^\\infty r^2 e^{-\\alpha r^2} dr $$\n剩下的径向积分是标准的高斯积分，形式为 $\\int_0^\\infty x^{2n} e^{-ax^2} dx = \\frac{(2n-1)!!}{2^{n+1}}\\sqrt{\\frac{\\pi}{a^{2n+1}}}$。在我们的例子中，$n=1$ 且 $a=\\alpha$，所以：\n$$ \\int_0^\\infty r^2 e^{-\\alpha r^2} dr = \\frac{1}{4} \\sqrt{\\frac{\\pi}{\\alpha^3}} $$\n将此结果代回：\n$$ Z = 4\\pi A \\left( \\frac{1}{4} \\sqrt{\\frac{\\pi}{\\alpha^3}} \\right) = A \\pi^{3/2} \\alpha^{-3/2} = A \\left( \\frac{\\pi}{\\alpha} \\right)^{3/2} $$\n求解 A，我们得到：\n$$ A = Z \\left( \\frac{\\alpha}{\\pi} \\right)^{3/2} $$\n\n**步骤2：计算原子形状因子 f(q)**\n\n原子形状因子由 $f(\\mathbf{q}) = \\int \\rho(\\mathbf{r}) e^{-i \\mathbf{q} \\cdot \\mathbf{r}} d^3r$ 给出。我们再次使用球坐标系。对于球对称函数，其傅里叶变换的结果将仅取决于大小 $q=|\\mathbf{q}|$。我们可以通过将坐标系的 z 轴与散射矢量 $\\mathbf{q}$ 对齐来简化计算。因此，$\\mathbf{q} \\cdot \\mathbf{r} = q r \\cos\\theta$。\n\n$$ f(q) = \\int_0^{2\\pi} d\\phi \\int_0^\\pi d\\theta \\int_0^\\infty dr \\, (A e^{-\\alpha r^2}) e^{-iqr\\cos\\theta} r^2 \\sin\\theta $$\n被积函数与 $\\phi$ 无关，所以 $\\phi$ 的积分结果为 $2\\pi$：\n$$ f(q) = 2\\pi A \\int_0^\\infty r^2 e^{-\\alpha r^2} dr \\int_0^\\pi e^{-iqr\\cos\\theta} \\sin\\theta d\\theta $$\n现在我们计算 $\\theta$ 的积分。令 $u = \\cos\\theta$，则 $du = -\\sin\\theta d\\theta$。积分限从 $[0, \\pi]$ 变为 $[1, -1]$。\n$$ \\int_0^\\pi e^{-iqr\\cos\\theta} \\sin\\theta d\\theta = \\int_1^{-1} e^{-iqru} (-du) = \\int_{-1}^1 e^{-iqru} du $$\n$$ = \\left[ \\frac{e^{-iqru}}{-iqr} \\right]_{-1}^1 = \\frac{e^{-iqr} - e^{iqr}}{-iqr} = \\frac{-2i \\sin(qr)}{-iqr} = \\frac{2\\sin(qr)}{qr} $$\n将此结果代回 $f(q)$ 的表达式中：\n$$ f(q) = 2\\pi A \\int_0^\\infty r^2 e^{-\\alpha r^2} \\left( \\frac{2\\sin(qr)}{qr} \\right) dr $$\n$$ f(q) = \\frac{4\\pi A}{q} \\int_0^\\infty r e^{-\\alpha r^2} \\sin(qr) dr $$\n积分 $I = \\int_0^\\infty r e^{-\\alpha r^2} \\sin(qr) dr$ 可以通过将其与高斯函数的傅里叶余弦变换 $F_c(k) = \\int_0^\\infty e^{-ax^2}\\cos(kx)dx = \\frac{1}{2}\\sqrt{\\frac{\\pi}{a}} e^{-k^2/4a}$ 联系起来求得。注意到我们的积分 $I$ 是 $-\\frac{d}{dq} \\int_0^\\infty e^{-\\alpha r^2} \\cos(qr) dr$。\n使用公式，其中 $a=\\alpha$ 且 $k=q$：\n$$ \\int_0^\\infty e^{-\\alpha r^2} \\cos(qr) dr = \\frac{1}{2}\\sqrt{\\frac{\\pi}{\\alpha}} e^{-q^2/4\\alpha} $$\n对 $q$ 求导：\n$$ \\frac{d}{dq} \\left( \\frac{1}{2}\\sqrt{\\frac{\\pi}{\\alpha}} e^{-q^2/4\\alpha} \\right) = \\frac{1}{2}\\sqrt{\\frac{\\pi}{\\alpha}} \\left(-\\frac{2q}{4\\alpha}\\right) e^{-q^2/4\\alpha} = -\\frac{q}{4\\alpha} \\sqrt{\\frac{\\pi}{\\alpha}} e^{-q^2/4\\alpha} $$\n所以，积分 $I$ 为：\n$$ I = -\\left( -\\frac{q}{4\\alpha} \\sqrt{\\frac{\\pi}{\\alpha}} e^{-q^2/4\\alpha} \\right) = \\frac{q\\sqrt{\\pi}}{4\\alpha^{3/2}} e^{-q^2/4\\alpha} $$\n现在将此结果代回 $f(q)$ 的表达式中：\n$$ f(q) = \\frac{4\\pi A}{q} \\left( \\frac{q\\sqrt{\\pi}}{4\\alpha^{3/2}} e^{-q^2/4\\alpha} \\right) = \\frac{A \\pi^{3/2}}{\\alpha^{3/2}} e^{-q^2/4\\alpha} = A \\left(\\frac{\\pi}{\\alpha}\\right)^{3/2} e^{-q^2/4\\alpha} $$\n最后，代入归一化常数 $A = Z (\\alpha/\\pi)^{3/2}$ 的表达式：\n$$ f(q) = \\left[ Z \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\right] \\left(\\frac{\\pi}{\\alpha}\\right)^{3/2} e^{-q^2/4\\alpha} $$\n$$ f(q) = Z e^{-q^2/4\\alpha} $$\n这个结果表明，高斯函数的傅里叶变换是另一个高斯函数。作为检验，对于 $q=0$ (前向散射)，$f(0) = Z e^0 = Z$，这正是总电子数，符合预期。", "answer": "$$ \\boxed{Z \\exp\\left(-\\frac{q^2}{4\\alpha}\\right)} $$", "id": "217999"}, {"introduction": "几何结构因子 $S_{\\mathbf{G}}$ 包含了晶体单胞内原子精确排布的关键信息。这个练习将我们的视角从单个原子提升到完整的晶体点阵（体心立方结构）。通过对理想位置上的原子引入一个微小的位移，你将亲身体验到衍射图谱如何对晶体结构的微小偏离产生高度敏感的响应，这是实验晶体学中的一个核心原理。[@problem_id:217997]", "problem": "在晶体的X射线衍射中，散射振幅由结构因子 $S_{\\mathbf{G}}$ 决定，它取决于晶胞内原子的排布以及原子本身的散射特性。对于一个原子基元，其结构因子由下式给出\n$$ S_{\\mathbf{G}} = \\sum_{j=1}^{N} f_j(\\mathbf{G}) e^{-i \\mathbf{G} \\cdot \\mathbf{r}_j} $$\n其中$N$是基元中的原子数，$\\mathbf{r}_j$是第$j$个原子的位置矢量，$f_j(\\mathbf{G})$是其原子形状因子，而$\\mathbf{G}$是一个倒易点阵矢量。\n\n考虑一个具有体心立方（BCC）结构的单原子晶体，其由一个边长为$a$的常规立方晶胞描述。对应于衍射峰的倒易点阵矢量由 $\\mathbf{G} = \\frac{2\\pi}{a}(h\\hat{x} + k\\hat{y} + l\\hat{z})$ 给出，其中$h, k, l$是被称为米勒指数的整数。\n\n该晶体表现出微小的结构畸变。常规晶胞的基元包含两个相同的原子。第一个原子位于原点，$\\mathbf{r}_1 = (0,0,0)$。第二个原子理想情况下位于体心，但沿z轴有微小位移。其位置由 $\\mathbf{r}_2 = \\frac{a}{2}(\\hat{x} + \\hat{y} + \\hat{z}) + \\delta \\hat{z}$ 给出，其中$\\delta$是一个恒定的位移量。晶体中所有原子都是同一类型，因此它们的原子形状因子$f(\\mathbf{G})$是相同的。\n\n计算对应于米勒指数$(h,k,l) = (0,0,1)$的特定反射的结构因子模的平方，$|S_{\\mathbf{G}}|^2$。令$f_{001}$表示在此反射的特定倒易点阵矢量$\\mathbf{G}$处求值的原子形状因子。用$f_{001}$、$a$和$\\delta$表示你的答案。对于此问题，你可以假设$f_{001}$是一个实数。", "solution": "我们在每个晶胞中有两个原子，其位置为\n\n$$\n\\mathbf{r}_1 = (0,0,0), \n\\quad \n\\mathbf{r}_2 = \\Bigl(\\tfrac{a}{2},\\tfrac{a}{2},\\tfrac{a}{2}+\\delta\\Bigr)\\,,\n$$\n  \n对于(0,0,1)反射，原子形状因子$f_{001}$相同。倒易点阵矢量为\n\n$$\n\\mathbf{G} = \\frac{2\\pi}{a}(0,0,1)\\,.\n$$\n  \n1. 结构因子：\n\n$$\nS_{\\mathbf{G}}\n= \\sum_{j=1}^2 f_{001}\\,e^{-i\\mathbf{G}\\cdot\\mathbf{r}_j}\n= f_{001}\\Bigl[1 + e^{-i\\mathbf{G}\\cdot\\mathbf{r}_2}\\Bigr].\n$$\n  \n2. 计算第二个原子的相位：\n\n$$\n\\mathbf{G}\\cdot\\mathbf{r}_2\n= \\frac{2\\pi}{a}\\,(a/2+\\delta)\n= \\pi + \\frac{2\\pi\\,\\delta}{a}.\n$$\n  \n因此\n\n$$\nS_{\\mathbf{G}}\n= f_{001}\\Bigl[1 + e^{-i(\\pi + 2\\pi\\delta/a)}\\Bigr]\n= f_{001}\\bigl[1 - e^{-i2\\pi\\delta/a}\\bigr].\n$$\n  \n3. 模的平方：\n\n$$\n|S_{\\mathbf{G}}|^2\n= f_{001}^2\\,\\bigl|1 - e^{-i2\\pi\\delta/a}\\bigr|^2\n= f_{001}^2\\bigl[2 - 2\\cos(2\\pi\\delta/a)\\bigr]\n= 4\\,f_{001}^2\\,\\sin^2\\!\\Bigl(\\frac{\\pi\\delta}{a}\\Bigr).\n$$", "answer": "$$\\boxed{4\\,f_{001}^2\\,\\sin^2\\!\\bigl(\\tfrac{\\pi\\delta}{a}\\bigr)}$$", "id": "217997"}, {"introduction": "并非所有晶面都能产生衍射峰；由于单胞基元内原子间的相消干涉，某些衍射会被“禁戒”。这个练习挑战你将结构因子公式应用于一个包含多种类型原子的晶体。你需要找出导致特定衍射峰完全消失（即“系统性消光”）的条件，这深刻揭示了结构因子在预测和解释衍射现象中的强大能力。[@problem_id:218028]", "problem": "考虑一个具有方形晶格结构的假设二维晶体。其常规晶胞是一个边长为 $a$ 的正方形。每个晶胞包含一个由三个原子组成的基元：两个 A 类原子（原子形状因子为 $f_A$）和一个 B 类原子（原子形状因子为 $f_B$）。在与晶胞边缘对齐的笛卡尔坐标系中，这些原子在常规晶胞内的位置如下：\n- 原子 A1: $(0, 0)$\n- 原子 A2: $(\\frac{a}{2}, 0)$\n- 原子 B: $(\\frac{a}{2}, \\frac{a}{2})$\n\n假设原子形状因子 $f_A$ 和 $f_B$ 均为实数且非零，求导致对应于米勒指数 $(h,k) = (2,1)$ 的 X 射线衍射峰完全消光的特定比值 $f_B/f_A$。", "solution": "晶体中 X 射线衍射的结构因子 $ S(h,k) $ 由下式给出：\n\n$$ S(h,k) = \\sum_j f_j \\exp(i \\mathbf{k} \\cdot \\mathbf{r}_j) $$\n\n其中 $ \\mathbf{k} = \\frac{2\\pi}{a} (h \\hat{\\mathbf{x}} + k \\hat{\\mathbf{y}}) $ 是米勒指数为 $(h,k)$ 的散射矢量，$ f_j $是原子形状因子，$ \\mathbf{r}_j $ 是原子 $ j $ 在晶胞中的位置。\n\n常规晶胞中的原子位置为：\n- 原子 A1: $ \\mathbf{r}_{A1} = (0, 0) $\n- 原子 A2: $ \\mathbf{r}_{A2} = \\left( \\frac{a}{2}, 0 \\right) $\n- 原子 B: $ \\mathbf{r}_{B} = \\left( \\frac{a}{2}, \\frac{a}{2} \\right) $\n\n因此，结构因子为：\n\n$$ S(h,k) = f_A \\exp(i \\mathbf{k} \\cdot \\mathbf{r}_{A1}) + f_A \\exp(i \\mathbf{k} \\cdot \\mathbf{r}_{A2}) + f_B \\exp(i \\mathbf{k} \\cdot \\mathbf{r}_{B}) $$\n\n\n计算点积：\n\n$$ \\mathbf{k} \\cdot \\mathbf{r}_{A1} = \\frac{2\\pi}{a} (h \\cdot 0 + k \\cdot 0) = 0 $$\n\n\n$$ \\mathbf{k} \\cdot \\mathbf{r}_{A2} = \\frac{2\\pi}{a} \\left( h \\cdot \\frac{a}{2} + k \\cdot 0 \\right) = \\pi h $$\n\n\n$$ \\mathbf{k} \\cdot \\mathbf{r}_{B} = \\frac{2\\pi}{a} \\left( h \\cdot \\frac{a}{2} + k \\cdot \\frac{a}{2} \\right) = \\pi (h + k) $$\n\n\n代入指数项：\n\n$$ S(h,k) = f_A \\exp(i \\cdot 0) + f_A \\exp(i \\pi h) + f_B \\exp(i \\pi (h + k)) $$\n\n\n$$ S(h,k) = f_A \\cdot 1 + f_A \\cdot (e^{i\\pi})^h + f_B \\cdot (e^{i\\pi})^{h+k} $$\n\n\n$$ S(h,k) = f_A + f_A (-1)^h + f_B (-1)^{h+k} $$\n\n\n对于 $(h,k) = (2,1)$ 的衍射峰：\n\n$$ S(2,1) = f_A + f_A (-1)^2 + f_B (-1)^{2+1} $$\n\n\n$$ (-1)^2 = 1, \\quad (-1)^3 = -1 $$\n\n\n$$ S(2,1) = f_A + f_A \\cdot 1 + f_B \\cdot (-1) = 2f_A - f_B $$\n\n\n当 $ S(2,1) = 0 $ 时，发生完全消光：\n\n$$ 2f_A - f_B = 0 $$\n\n\n$$ f_B = 2f_A $$\n\n\n$$ \\frac{f_B}{f_A} = 2 $$", "answer": "$$ \\boxed{2} $$", "id": "218028"}]}