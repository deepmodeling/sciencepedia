{"hands_on_practices": [{"introduction": "埃瓦尔德求和法将一个缓慢收敛的晶格加和巧妙地分解为几个快速收敛的部分。这个练习将帮助你深入理解该方法的一些精细之处，特别是为了避免重复计算和处理人为引入的抵消电荷而引入的校正项 [@problem_id:97840]。通过亲手计算自能项和电势偏移项，你将能更好地掌握埃瓦尔德势能的完整构成。", "problem": "在固态物理学中，埃瓦尔德（Ewald）求和方法是一种计算周期性体系中长程静电势的强大技术。该方法将收敛缓慢的晶格求和分解为两个快速收敛的部分：一个在实空间中的求和和一个在倒易空间中的求和。此过程引入了修正项，以避免重复计算并处理自相互作用赝象。\n\n考虑一个晶体结构，其由一个体积为 $\\Omega$ 的电中性晶胞描述，晶胞中包含位于位置 $\\mathbf{r}_j$、带有电荷 $q_j$ 的离子。在特定离子位置的总静电势可以分解为几个组成部分。您的任务是，对于一个特定的晶格，在位于原点的离子位置，计算其中两个分量的和。\n\n该晶体具有一个边长为 $a$ 的立方晶胞。它包含两个离子：一个带电荷 $+q$ 的离子位于原点 $\\mathbf{r}_1 = (0,0,0)$，另一个带电荷 $-q$ 的离子位于体心 $\\mathbf{r}_2 = (a/2, a/2, a/2)$。\n\n请计算在原点（$\\mathbf{r}_1$）的离子位置上，以下两种势能贡献之和：\n\n1.  **自势能项 ($V_{self}$):** 该项修正了离子的点电荷与其自身的屏蔽高斯电荷云之间的相互作用，而这种相互作用是 Ewald 方法产生的一种赝象。一个高斯电荷分布 $\\rho^G(\\mathbf{r}) = q (\\eta/\\pi)^{3/2} \\exp(-\\eta r^2)$ 中心处的势能由 $V_{self} = \\frac{q \\sqrt{\\eta}}{2\\epsilon_0\\pi\\sqrt{\\pi}}$ 给出。在这里，$q$ 是目标位置离子的电荷，$\\eta$ 是 Ewald 收敛参数，$\\epsilon_0$ 是真空介电常数。\n\n2.  **恒定势能偏移 ($V_{offset}$):** 该项代表了在倒易空间求和中所使用的电荷分布的光滑部分所产生的平均势。对于真空中的周期性体系，此势能在整个晶胞中是一个常数，由公式 $V_{offset} = -\\frac{1}{6\\epsilon_0 \\Omega} \\sum_{j \\in \\text{cell}} q_j |\\mathbf{r}_j|^2$ 给出。求和遍及一个晶胞内的所有离子。\n\n请以单个符号表达式的形式，给出总势能 $V_{total} = V_{self} + V_{offset}$。", "solution": "在原点 $\\mathbf{r}_1 = (0,0,0)$ 处的离子位置的静电势是自势能项和恒定势能偏移之和：\n\n$$\nV_{\\text{total}} = V_{\\text{self}} + V_{\\text{offset}}\n$$\n\n\n**步骤 1：计算位于原点的离子的 $V_{\\text{self}}$。**\n带有电荷 $q_j$ 的离子的自势能由下式给出：\n\n$$\nV_{\\text{self}} = \\frac{q_j \\sqrt{\\eta}}{2 \\epsilon_0 \\pi \\sqrt{\\pi}}\n$$\n\n对于位于原点的离子，$q_j = q_1 = +q$。因此：\n\n$$\nV_{\\text{self}} = \\frac{q \\sqrt{\\eta}}{2 \\epsilon_0 \\pi \\sqrt{\\pi}} = \\frac{q \\sqrt{\\eta}}{2 \\epsilon_0 \\pi^{3/2}}\n$$\n\n\n**步骤 2：计算 $V_{\\text{offset}}$。**\n恒定势能偏移由下式给出：\n\n$$\nV_{\\text{offset}} = -\\frac{1}{6 \\epsilon_0 \\Omega} \\sum_{j \\in \\text{cell}} q_j |\\mathbf{r}_j|^2,\n$$\n\n其中 $\\Omega = a^3$ 是立方晶胞的体积。求和遍及晶胞中的两个离子。\n\n- 对于位于 $\\mathbf{r}_1 = (0,0,0)$、带电荷 $q_1 = +q$ 的离子 1：\n  \n$$\n  |\\mathbf{r}_1|^2 = 0^2 + 0^2 + 0^2 = 0, \\quad \\text{so} \\quad q_1 |\\mathbf{r}_1|^2 = q \\cdot 0 = 0\n  $$\n\n- 对于位于 $\\mathbf{r}_2 = (a/2, a/2, a/2)$、带电荷 $q_2 = -q$ 的离子 2：\n  \n$$\n  |\\mathbf{r}_2|^2 = \\left(\\frac{a}{2}\\right)^2 + \\left(\\frac{a}{2}\\right)^2 + \\left(\\frac{a}{2}\\right)^2 = 3 \\cdot \\frac{a^2}{4} = \\frac{3a^2}{4}, \\quad \\text{so} \\quad q_2 |\\mathbf{r}_2|^2 = (-q) \\cdot \\frac{3a^2}{4} = -\\frac{3q a^2}{4}\n  $$\n\n将这些贡献相加：\n\n$$\n\\sum_{j} q_j |\\mathbf{r}_j|^2 = 0 + \\left(-\\frac{3q a^2}{4}\\right) = -\\frac{3q a^2}{4}\n$$\n\n代入 $V_{\\text{offset}}$ 的公式中：\n\n$$\nV_{\\text{offset}} = -\\frac{1}{6 \\epsilon_0 a^3} \\left(-\\frac{3q a^2}{4}\\right) = \\frac{1}{6 \\epsilon_0 a^3} \\cdot \\frac{3q a^2}{4} = \\frac{3q a^2}{24 \\epsilon_0 a^3} = \\frac{q}{8 \\epsilon_0 a}\n$$\n\n\n**步骤 3：将各分量相加得到 $V_{\\text{total}}$。**\n\n$$\nV_{\\text{total}} = V_{\\text{self}} + V_{\\text{offset}} = \\frac{q \\sqrt{\\eta}}{2 \\epsilon_0 \\pi^{3/2}} + \\frac{q}{8 \\epsilon_0 a}\n$$\n\n此表达式即为原点处的总静电势。", "answer": "$$\n\\boxed{\\dfrac{q \\sqrt{\\eta}}{2 \\epsilon_0 \\pi^{3/2}} + \\dfrac{q}{8 \\epsilon_0 a}}\n$$", "id": "97840"}, {"introduction": "埃瓦尔德方法的核心在于将晶格加和在实空间和倒易空间中分开处理。这个练习将带你实践倒易空间部分的核心计算步骤 [@problem_id:97935]。通过为一个一维交替电荷链计算其倒易空间能量，你将练习如何构建倒易晶格矢量、计算结构因子，并最终执行求和，这些都是应用埃瓦尔德方法不可或缺的技能。", "problem": "埃瓦尔德求和方法是计算周期性体系静电能的一种强大技术。它将点电荷相互作用的慢收敛晶格求和分解为一个快收敛的实空间求和与一个快收敛的倒易空间求和。\n\n对于三维电荷体系，倒易空间求和对每个晶胞总能量的贡献由下式给出：\n$$ U_{\\text{recip}} = \\frac{1}{2V} \\sum_{\\mathbf{G} \\neq 0} \\frac{4\\pi}{G^2} |S(\\mathbf{G})|^2 e^{-G^2 / (4\\eta^2)} $$\n其中，$V$ 是晶胞的体积，$\\mathbf{G}$ 是非零倒易晶格矢量，$\\eta$ 是埃瓦尔德分裂参数，$S(\\mathbf{G})$ 是晶胞的结构因子。结构因子定义为 $S(\\mathbf{G}) = \\sum_{j} q_j e^{-i \\mathbf{G} \\cdot \\mathbf{r}_j}$，其中求和遍及晶胞内位于位置 $\\mathbf{r}_j$ 的所有电荷 $q_j$。\n\n考虑一个沿x轴排列的、由交替点电荷组成的无限一维链。晶胞长度为 $a$，包含两个电荷：一个电荷 $+q$ 位于位置 $x_1=0$，一个电荷 $-q$ 位于位置 $x_2=a/2$。对于这样一个嵌入三维空间的一维体系，晶胞“体积”取为其长度 $V=a$，倒易晶格矢量由 $G_n = \\frac{2\\pi n}{a}$ 给出，其中 $n$ 为任意非零整数。\n\n你的任务是计算部分和 $U_{\\text{recip}}^{(5)}$，它代表了前五个非零正指数倒易晶格矢量（即对应于 $n=1, 2, 3, 4, 5$ 的矢量）对倒易空间能量的贡献。请用电荷 $q$、晶格常数 $a$ 和埃瓦尔德参数 $\\eta$ 来表示你的答案。", "solution": "我们从三维空间中每个晶胞的倒易空间能量出发，并将其特殊化到长度为 $a$ 的一维链（单位“体积” $V=a$）：\n$$\nU_{\\rm recip}\n=\\frac{1}{2V}\\sum_{G\\neq0}\\frac{4\\pi}{G^2}\\bigl|S(G)\\bigr|^2\\,e^{-G^2/(4\\eta^2)}\n$$\n此处的 $G_n=\\tfrac{2\\pi n}{a}$，$n\\in\\mathbb Z\\setminus\\{0\\}$，对于位于 $x_1=0$ 的电荷 $+q$ 和位于 $x_2=a/2$ 的电荷 $-q$，\n$$\nS(G)=\\sum_j q_j e^{-iGx_j}\n= q\\bigl(1 - e^{-iG\\,a/2}\\bigr)\n$$\n因此\n$$\n|S(G_n)|^2\n= q^2\\bigl|1 - e^{-i\\pi n}\\bigr|^2\n= q^2\\bigl(2 -2\\cos(\\pi n)\\bigr)\n=2q^2\\bigl[1-(-1)^n\\bigr]\n$$\n因此，当 $n$ 为奇数时 $|S(G_n)|^2=4q^2$，当 $n$ 为偶数时为零。对 $n=1,\\dots,5$ 的部分和简化为对 $n=1,3,5$ 求和。代入 $G_n^2=(2\\pi n/a)^2$ 可得\n$$\nU_{\\rm recip}^{(5)}\n=\\frac{1}{2a}\\sum_{n=1,3,5}\\frac{4\\pi}{(2\\pi n/a)^2}\\,4q^2\n\\exp\\!\\Bigl[-\\frac{(2\\pi n/a)^2}{4\\eta^2}\\Bigr]\n$$\n简化每一项：\n$$\n\\frac{4\\pi}{(2\\pi n/a)^2}\\,4q^2\n=4q^2\\frac{4\\pi}{4\\pi^2n^2/a^2}\n=\\frac{4q^2a^2}{\\pi n^2},\n\\quad\n\\exp\\!\\Bigl[-\\frac{(2\\pi n/a)^2}{4\\eta^2}\\Bigr]\n=\\exp\\!\\Bigl[-\\frac{\\pi^2n^2}{a^2\\eta^2}\\Bigr]\n$$\n因此\n$$\nU_{\\rm recip}^{(5)}\n=\\frac{1}{2a}\\sum_{n=1,3,5}\\frac{4q^2a^2}{\\pi n^2}\n\\exp\\!\\Bigl[-\\frac{\\pi^2n^2}{a^2\\eta^2}\\Bigr]\n=\\frac{2q^2a}{\\pi}\\sum_{n=1,3,5}\\frac{1}{n^2}\n\\exp\\!\\Bigl[-\\frac{\\pi^2n^2}{a^2\\eta^2}\\Bigr]\n$$\n展开来看，\n$$\nU_{\\rm recip}^{(5)}\n=\\frac{2q^2a}{\\pi}\\Bigl(\ne^{-\\frac{\\pi^2}{a^2\\eta^2}}\n+\\frac{1}{9}e^{-\\frac{9\\pi^2}{a^2\\eta^2}}\n+\\frac{1}{25}e^{-\\frac{25\\pi^2}{a^2\\eta^2}}\n\\Bigr)\n$$", "answer": "$$\\boxed{\\frac{2q^2a}{\\pi}\\Bigl(e^{-\\frac{\\pi^2}{a^2\\eta^2}}+\\frac{1}{9}e^{-\\frac{9\\pi^2}{a^2\\eta^2}}+\\frac{1}{25}e^{-\\frac{25\\pi^2}{a^2\\eta^2}}\\Bigr)}$$", "id": "97935"}, {"introduction": "理论的优雅最终要在实际计算中体现其价值。在计算物理学中，埃瓦尔德方法不仅是一个数学公式，更是一个需要仔细优化的算法 [@problem_id:97871]。这个练习将引导你思考一个非常实际的问题：如何在保证计算精度的前提下，通过调整实空间和倒易空间的截断参数，来最小化总计算时间，从而揭示理论参数与计算效率之间的深刻联系。", "problem": "在用于计算周期性系统中静电相互作用的 Ewald 求和方法中，总势能的计算被拆分为一个快速收敛的实空间求和与一个快速收敛的倒空间求和。这些求和的收敛性由一个分割参数 $\\alpha$ 控制。在实际应用中，两个求和都在有限的截断值处被截断：实空间求和在半径 $R_{cut}$ 处截断，倒空间求和在波矢大小 $G_{cut}$ 处截断。\n\n计算的精度取决于 $\\alpha$、$R_{cut}$ 和 $G_{cut}$ 的选择。对于给定的目标精度 $\\epsilon$，选择参数以平衡来自两个求和的截断误差。设来自实空间和倒空间求和的均方根（RMS）误差贡献分别由 $\\epsilon_R$ 和 $\\epsilon_K$ 给出：\n\n$$\n\\epsilon_R = C_1 \\frac{\\exp[-(\\alpha R_{cut})^2]}{(\\alpha R_{cut})^2}\n$$\n$$\n\\epsilon_K = C_2 \\frac{\\exp[-(G_{cut}/(2\\alpha))^2]}{G_{cut}/(2\\alpha)}\n$$\n\n其中 $C_1$ 和 $C_2$ 是依赖于系统属性的正常数。为达到总精度 $\\epsilon$ 的一个常用策略是要求两个误差贡献都单独等于 $\\epsilon$：$\\epsilon_R = \\epsilon$ 和 $\\epsilon_K = \\epsilon$。\n\n计算的计算成本是实空间和倒空间部分成本之和，$T = T_R + T_K$。对于一个特定的（可能非标准的）实现，这些成本由以下公式给出：\n\n$$\nT_R = K_R R_{cut}^2\n$$\n$$\nT_K = K_G G_{cut}^3\n$$\n\n其中 $K_R$ 和 $K_G$ 是与算法和机器性能相关的正常数。\n\n你的任务是找到实空间和倒空间计算之间计算量的最优划分。为此，首先用 $\\alpha$ 和目标精度 $\\epsilon$ 来表示 $R_{cut}$ 和 $G_{cut}$。然后，找到使总计算成本 $T(\\alpha)$ 最小化的 $\\alpha$ 值。最后，对于这个最优的 $\\alpha$ 选择，推导出计算成本比率 $\\frac{T_R}{T_K}$ 的数值。\n\n**近似指导：** 对于高精度计算，$\\epsilon$ 非常小。这意味着参量 $u = \\alpha R_{cut}$ 和 $v = G_{cut}/(2\\alpha)$ 很大。在求解形如 $\\epsilon = C' \\frac{e^{-x^2}}{x^n}$ 的方程以求得 $x$ 时，您可以使用领头阶近似 $x^2 \\approx \\ln(C'/\\epsilon)$，忽略缓慢变化的对数修正项。", "solution": "我们已知：\n- 实空间求和的均方根误差： $\\epsilon_R = C_1 \\frac{\\exp[-(\\alpha R_{cut})^2]}{(\\alpha R_{cut})^2} = \\epsilon$\n- 倒空间求和的均方根误差： $\\epsilon_K = C_2 \\frac{\\exp[-(G_{cut}/(2\\alpha))^2]}{G_{cut}/(2\\alpha)} = \\epsilon$\n- 计算成本：$T_R = K_R R_{cut}^2$ 和 $T_K = K_G G_{cut}^3$\n\n对于高精度（$\\epsilon$很小），我们对形如 $\\epsilon = C' e^{-x^2}/x^n$ 的方程使用近似 $x^2 \\approx \\ln(C'/\\epsilon)$。\n\n**第1步：用 $\\alpha$ 和 $\\epsilon$ 求解 $R_{cut}$ 和 $G_{cut}$。**\n\n对于 $\\epsilon_R = \\epsilon$：\n- 令 $u = \\alpha R_{cut}$。则 $\\epsilon = C_1 e^{-u^2} / u^2$。\n- 近似：$u^2 \\approx \\ln(C_1 / \\epsilon)$。\n- 因此，$(\\alpha R_{cut})^2 \\approx \\ln(C_1 / \\epsilon)$。\n- 求解 $R_{cut}$：$R_{cut} \\approx \\frac{1}{\\alpha} \\sqrt{\\ln(C_1 / \\epsilon)}$。\n\n对于 $\\epsilon_K = \\epsilon$：\n- 令 $v = G_{cut}/(2\\alpha)$。则 $\\epsilon = C_2 e^{-v^2} / v$。\n- 近似：$v^2 \\approx \\ln(C_2 / \\epsilon)$（因为 $n=1$）。\n- 因此，$\\left( \\frac{G_{cut}}{2\\alpha} \\right)^2 \\approx \\ln(C_2 / \\epsilon)$。\n- 求解 $G_{cut}$：$G_{cut} \\approx 2\\alpha \\sqrt{\\ln(C_2 / \\epsilon)}$。\n\n**第2步：表示计算成本 $T_R$ 和 $T_K$。**\n\n代入 $R_{cut}$ 和 $G_{cut}$：\n- $T_R = K_R R_{cut}^2 \\approx K_R \\left( \\frac{1}{\\alpha} \\sqrt{\\ln(C_1 / \\epsilon)} \\right)^2 = K_R \\frac{\\ln(C_1 / \\epsilon)}{\\alpha^2}$\n- $T_K = K_G G_{cut}^3 \\approx K_G \\left( 2\\alpha \\sqrt{\\ln(C_2 / \\epsilon)} \\right)^3 = K_G \\cdot 8 \\alpha^3 \\left( \\ln(C_2 / \\epsilon) \\right)^{3/2}$\n\n**第3步：总成本 $T(\\alpha) = T_R + T_K$ 及其最小化。**\n\n定义常数：\n- $A = K_R \\ln(C_1 / \\epsilon)$（与$\\alpha$无关）\n- $B = 8 K_G \\left( \\ln(C_2 / \\epsilon) \\right)^{3/2}$（与$\\alpha$无关）\n\n那么：\n- $T(\\alpha) = A \\alpha^{-2} + B \\alpha^3$\n\n通过将导数设为零来最小化 $T(\\alpha)$：\n- $\\frac{dT}{d\\alpha} = -2A \\alpha^{-3} + 3B \\alpha^2 = 0$\n- 整理得：$3B \\alpha^2 = 2A \\alpha^{-3}$\n- 两边同乘以 $\\alpha^3$：$3B \\alpha^5 = 2A$\n- 因此，$A = \\frac{3}{2} B \\alpha^5$\n\n**第4步：求最优情况下的比率 $T_R / T_K$。**\n\n根据成本表达式和最小化条件：\n- $T_R = A \\alpha^{-2}$\n- $T_K = B \\alpha^3$\n- 比率：$\\frac{T_R}{T_K} = \\frac{A \\alpha^{-2}}{B \\alpha^3} = \\frac{A}{B \\alpha^5}$\n\n代入 $A = \\frac{3}{2} B \\alpha^5$：\n- $\\frac{T_R}{T_K} = \\frac{\\frac{3}{2} B \\alpha^5}{B \\alpha^5} = \\frac{3}{2}$\n\n因此，该比率为 $3/2$。", "answer": "$$\\boxed{\\dfrac{3}{2}}$$", "id": "97871"}]}