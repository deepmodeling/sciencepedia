{"hands_on_practices": [{"introduction": "我们从一个基本问题开始：一个均匀的聚合物混合物在什么条件下会发生相分离？本练习将通过一个理想化的对称二元共混物模型，引导您推导相分离所需的临界聚合度 $N_{crit}$。通过这个过程，您将深入理解弗洛里-哈金斯理论的核心，即相互作用参数 $\\chi$ 和聚合物链长 $N$ 如何共同决定了材料的宏观相行为。[@problem_id:109288]", "problem": "弗洛里-哈金斯理论为聚合物混合物的热力学提供了一个基础模型。对于聚合物 A 和聚合物 B 的二元共混物，以 $k_B T$ 为单位的每个晶格点的混合吉布斯自由能由下式给出：\n$$ g_m = \\frac{\\phi_A \\ln \\phi_A}{N_A} + \\frac{\\phi_B \\ln \\phi_B}{N_B} + \\chi_{AB} \\phi_A \\phi_B $$\n此处，$\\phi_A$ 和 $\\phi_B$ 是两种聚合物的体积分数，且 $\\phi_A + \\phi_B = 1$。$N_A$ 和 $N_B$ 分别是它们的聚合度（即每条链上的单体重复单元数）。参数 $\\chi_{AB}$ 是弗洛里-哈金斯相互作用参数，它量化了 A 和 B 链段之间的相互作用焓。\n\n考虑一种由含氢聚合物及其氘代物组成的对称共混物。对于这种同位素共混物，聚合度相同，即 $N_A = N_B = N$。相互作用参数源于链段极化率和体积的微小差异，通常为正值（$\\chi_{AB} > 0$），并表现出与绝对温度 $T$ 成反比的关系：\n$$ \\chi_{AB}(T) = \\frac{C}{T} $$\n其中 $C$ 是一个带有温度单位的正常数，用于表征氘代链段和含氢链段之间的焓斥力强度。\n\n当体系达到旋节线稳定性极限时，共混物即将发生相分离，该极限由混合自由能对组成的二阶导数为零的条件定义。对于对称共混物，临界点（双结线/旋节线曲线的顶点）出现在对称组成 $\\phi_A = 1/2$ 处。\n\n在给定温度 $T$ 下，存在一个临界聚合度 $N_{crit}$，它表示体系能够发生相分离所需的最小链长。请确定该对称同位素共混物的临界聚合度 $N_{crit}$。请用温度 $T$ 和相互作用强度常数 $C$ 来表示你的答案。", "solution": "每个晶格点的混合吉布斯自由能由下式给出：\n$$ g_m = \\frac{\\phi_A \\ln \\phi_A}{N_A} + \\frac{\\phi_B \\ln \\phi_B}{N_B} + \\chi_{AB} \\phi_A \\phi_B $$\n对于对称共混物，$N_A = N_B = N$ 且 $\\phi_B = 1 - \\phi_A$。将这些代入 $g_m$：\n$$ g_m = \\frac{\\phi_A \\ln \\phi_A}{N} + \\frac{(1 - \\phi_A) \\ln (1 - \\phi_A)}{N} + \\chi_{AB} \\phi_A (1 - \\phi_A) $$\n\n旋节线条件要求 $g_m$ 对 $\\phi_A$ 的二阶导数为零：\n$$ \\frac{\\partial^2 g_m}{\\partial \\phi_A^2} = 0 $$\n\n首先，计算一阶导数：\n$$ \\frac{\\partial g_m}{\\partial \\phi_A} = \\frac{1}{N} \\left[ \\ln \\phi_A + 1 \\right] + \\frac{1}{N} \\left[ -\\ln (1 - \\phi_A) - 1 \\right] + \\chi_{AB} (1 - 2\\phi_A) $$\n化简得：\n$$ \\frac{\\partial g_m}{\\partial \\phi_A} = \\frac{1}{N} \\ln \\left( \\frac{\\phi_A}{1 - \\phi_A} \\right) + \\chi_{AB} (1 - 2\\phi_A) $$\n\n现在，计算二阶导数：\n$$ \\frac{\\partial^2 g_m}{\\partial \\phi_A^2} = \\frac{1}{N} \\cdot \\frac{1}{\\phi_A (1 - \\phi_A)} - 2 \\chi_{AB} $$\n\n根据旋节线条件，令二阶导数为零：\n$$ \\frac{1}{N \\phi_A (1 - \\phi_A)} - 2 \\chi_{AB} = 0 $$\n\n在临界点，$\\phi_A = \\frac{1}{2}$：\n$$ \\frac{1}{N \\cdot \\frac{1}{2} \\cdot \\frac{1}{2}} - 2 \\chi_{AB} = 0 $$\n$$ \\frac{1}{N \\cdot \\frac{1}{4}} = 2 \\chi_{AB} $$\n$$ \\frac{4}{N} = 2 \\chi_{AB} $$\n$$ \\chi_{AB} = \\frac{2}{N} $$\n\n已知 $\\chi_{AB}(T) = \\frac{C}{T}$：\n$$ \\frac{C}{T} = \\frac{2}{N} $$\n\n解出 $N$ 即可得到临界聚合度 $N_{crit}$：\n$$ N_{crit} = \\frac{2T}{C} $$", "answer": "$$ \\boxed{\\dfrac{2T}{C}} $$", "id": "109288"}, {"introduction": "现实世界中的聚合物体系往往包含两种以上的组分。本练习将展示如何将弗洛里-哈金斯理论的稳定性分析从二元体系推广到更复杂的三元体系。通过计算一个对称三元共混物的临界相互作用参数 $\\chi_c$，您将学会在更高维度的情况下应用相同的热力学原理，并使用像赫斯矩阵这样的数学工具来分析多维自由能曲面。[@problem_id:109178]", "problem": "Flory-Huggins理论为聚合物混合物的热力学提供了一种平均场描述。对于一个由$k$种聚合物组分组成的体系，每个晶格点的混合吉布斯自由能$g$由下式给出：\n$$ g = \\frac{\\Delta G_m}{N_{tot} k_B T} = \\sum_{i=1}^{k} \\frac{\\phi_i}{N_i} \\ln \\phi_i + \\sum_{i<j}^{k} \\chi_{ij} \\phi_i \\phi_j $$\n其中$\\phi_i$是组分$i$的体积分数，$N_i$是其聚合度，而$\\chi_{ij}$是组分$i$和$j$之间的Flory-Huggins相互作用参数。假设总体积守恒，因此$\\sum_{i=1}^{k} \\phi_i = 1$。\n\n相分离由自由能曲面的曲率决定。旋节线边界（其区分了亚稳区和不稳区）的定义条件是，自由能相对于独立组分变量的Hessian矩阵是奇异的，即$\\det(\\boldsymbol{H}) = 0$。临界点是旋节线上一个特殊的点，在该点体系首次变得不稳定。\n\n考虑一个对称的三元聚合物共混物，由组分A、B和C组成，它们的聚合度相等，即$N_A = N_B = N_C = N$。相互作用参数由$\\chi_{AC} = \\chi_{BC} = \\chi$和$\\chi_{AB} = 0$给出。求该体系临界相互作用参数$\\chi_c$的值，用$N$表示。", "solution": "对称三元共混物每个晶格点的吉布斯自由能由下式给出：\n$$ g = \\frac{1}{N} \\left( \\phi_A \\ln \\phi_A + \\phi_B \\ln \\phi_B + \\phi_C \\ln \\phi_C \\right) + \\chi \\phi_A \\phi_C + \\chi \\phi_B \\phi_C $$\n约束条件为$\\phi_A + \\phi_B + \\phi_C = 1$。选择$\\phi_A$和$\\phi_B$作为自变量，则$\\phi_C = 1 - \\phi_A - \\phi_B$。代入可得：\n$$ g = \\frac{1}{N} \\left( \\phi_A \\ln \\phi_A + \\phi_B \\ln \\phi_B + (1 - \\phi_A - \\phi_B) \\ln (1 - \\phi_A - \\phi_B) \\right) + \\chi \\phi_A (1 - \\phi_A - \\phi_B) + \\chi \\phi_B (1 - \\phi_A - \\phi_B) $$\n简化相互作用项：\n$$ \\chi \\left[ \\phi_A (1 - \\phi_A - \\phi_B) + \\phi_B (1 - \\phi_A - \\phi_B) \\right] = \\chi \\left( \\phi_A + \\phi_B - \\phi_A^2 - 2\\phi_A\\phi_B - \\phi_B^2 \\right) $$\n因此：\n$$ g = \\frac{1}{N} \\left( \\phi_A \\ln \\phi_A + \\phi_B \\ln \\phi_B + (1 - \\phi_A - \\phi_B) \\ln (1 - \\phi_A - \\phi_B) \\right) + \\chi \\left( \\phi_A + \\phi_B - \\phi_A^2 - 2\\phi_A\\phi_B - \\phi_B^2 \\right) $$\n\nHessian矩阵$\\boldsymbol{H}$的元素为：\n$$ \\frac{\\partial^2 g}{\\partial \\phi_A^2} = \\frac{1}{N} \\left( \\frac{1}{\\phi_A} + \\frac{1}{\\phi_C} \\right) - 2\\chi, \\quad \\frac{\\partial^2 g}{\\partial \\phi_B^2} = \\frac{1}{N} \\left( \\frac{1}{\\phi_B} + \\frac{1}{\\phi_C} \\right) - 2\\chi, \\quad \\frac{\\partial^2 g}{\\partial \\phi_A \\partial \\phi_B} = \\frac{1}{N} \\frac{1}{\\phi_C} - 2\\chi $$\n旋节线条件要求$\\det(\\boldsymbol{H}) = 0$。由于对称性，设$\\phi_A = \\phi_B = \\phi$，则$\\phi_C = 1 - 2\\phi$。Hessian元素变为：\n$$ H_{AA} = \\frac{1}{N} \\left( \\frac{1}{\\phi} + \\frac{1}{1-2\\phi} \\right) - 2\\chi, \\quad H_{BB} = H_{AA}, \\quad H_{AB} = \\frac{1}{N} \\frac{1}{1-2\\phi} - 2\\chi $$\n设$a = H_{AA}$和$b = H_{AB}$。行列式为：\n$$ \\det(\\boldsymbol{H}) = a^2 - b^2 = (a - b)(a + b) = 0 $$\n其中：\n$$ a - b = \\frac{1}{N} \\frac{1}{\\phi}, \\quad a + b = \\frac{1}{N} \\left( \\frac{1}{\\phi} + \\frac{2}{1-2\\phi} \\right) - 4\\chi $$\n因为$a - b = \\frac{1}{N\\phi} \\neq 0$，旋节线条件简化为：\n$$ a + b = 0 \\implies \\frac{1}{N} \\left( \\frac{1}{\\phi} + \\frac{2}{1-2\\phi} \\right) - 4\\chi = 0 \\implies \\chi = \\frac{1}{4N} \\left( \\frac{1}{\\phi} + \\frac{2}{1-2\\phi} \\right) $$\n\n临界点通过最小化$\\chi$关于$\\phi$的值来找到。定义：\n$$ f(\\phi) = \\frac{1}{\\phi} + \\frac{2}{1-2\\phi} $$\n则：\n$$ \\chi = \\frac{f(\\phi)}{4N}, \\quad \\frac{df}{d\\phi} = -\\frac{1}{\\phi^2} + \\frac{4}{(1-2\\phi)^2} $$\n令$\\frac{df}{d\\phi} = 0$：\n$$ -\\frac{1}{\\phi^2} + \\frac{4}{(1-2\\phi)^2} = 0 \\implies \\frac{4}{(1-2\\phi)^2} = \\frac{1}{\\phi^2} \\implies 4\\phi^2 = (1-2\\phi)^2 $$\n取平方根：\n$$ 2\\phi = 1-2\\phi \\quad \\text{或} \\quad 2\\phi = -(1-2\\phi) $$\n第二个方程得出$0 = -1$，这是不可能的。第一个方程得出：\n$$ 4\\phi = 1 \\implies \\phi = \\frac{1}{4} $$\n因此，$\\phi_A = \\phi_B = \\frac{1}{4}$，$\\phi_C = \\frac{1}{2}$。代入$\\chi$中：\n$$ \\chi_c = \\frac{1}{4N} \\left( \\frac{1}{1/4} + \\frac{2}{1-2 \\cdot 1/4} \\right) = \\frac{1}{4N} \\left( 4 + \\frac{2}{1/2} \\right) = \\frac{1}{4N} (4 + 4) = \\frac{8}{4N} = \\frac{2}{N} $$", "answer": "$$ \\boxed{\\dfrac{2}{N}} $$", "id": "109178"}, {"introduction": "弗洛里-哈金斯理论不仅能预测相分离的发生，更能帮助我们理解相分离后形成的具体结构，而这正是决定材料性能的关键。本练习将理论与应用相结合，带您探索嵌段共聚物中常见的自组装形态。通过一个计算任务，您将利用不相容性参数 $\\chi N$ 和组分比例 $f_A$ 来预测体系会处于无序状态，还是形成层状或胶束等有序结构，从而体验理论模型在计算材料科学和功能材料设计中的实际应用。[@problem_id:2466682]", "problem": "考虑一个由相同的线性二嵌段共聚物链组成的熔体的粗粒化模型，单位为约化Lennard-Jones单位。每条链由 $N$ 个单体组成，其中 A 型单体的分数为 $f_A$，B 型单体的分数为 $f_B = 1 - f_A$。这些单体排列成 $A_{N_A}B_{N_B}$ 的嵌段结构，其中 $N_A = f_A N$，$N_B = f_B N$。两种类型 $i$ 和 $j$ 的单体之间相隔距离为 $r$ 的非键相互作用由对Lennard-Jones势建模：\n$$\nU_{ij}(r) = 4 \\,\\epsilon_{ij}\\,\\left[\\left(\\frac{\\sigma_{ij}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r}\\right)^{6}\\right],\n$$\n其中 $\\epsilon_{ij}$ 是势阱深度参数，$\\sigma_{ij}$ 是距离参数。假设尺寸参数遵循 Lorentz-Berthelot 混合法则，即 $\\sigma_{AB} = \\tfrac{1}{2}(\\sigma_{AA} + \\sigma_{BB})$。在约化Lennard-Jones单位下进行计算，其中能量单位为 $\\epsilon$，长度单位为 $\\sigma$，温度单位为 $\\epsilon/k_B$。因此，约化温度为 $T^\\star$，所有 $\\epsilon_{ij}$ 均为无量纲的势阱深度。\n\n在平均场接触模型中，由上述对相互作用产生的 Flory-Huggins 不相容参数 $\\chi$ 可近似为：\n$$\n\\chi = \\frac{z}{T^\\star}\\left(\\frac{\\epsilon_{AA} + \\epsilon_{BB}}{2} - \\epsilon_{AB}\\right),\n$$\n其中 $z$ 是有效配位数，取值为 $z = 6$。定义乘积 $\\chi N$ 为由聚合度标度的不相容性。使用以下分类规则来确定二嵌段共聚物熔体的平衡形貌：\n\n- 如果 $\\chi N < C_{\\mathrm{ODT}}$ 且 $C_{\\mathrm{ODT}} = 10.5$，则将状态分类为无序（序参量标签为 $0$）。\n- 如果 $\\chi N \\ge C_{\\mathrm{ODT}}$ 且 $0.35 \\le f_A \\le 0.65$，则分类为层状（序参量标签为 $2$）。\n- 如果 $\\chi N \\ge C_{\\mathrm{ODT}}$ 且 $f_A$ 在层状窗口之外，则分类为胶束（序参量标签为 $1$）。\n\n在约化单位下，所有量均为无量纲。您的任务是编写一个程序，对于下面测试套件中的每一组参数，计算 $\\chi$ 和 $\\chi N$，应用上述规则，并返回相应的整数标签。\n\n测试套件（每个案例为一个元组 $(\\epsilon_{AA}, \\epsilon_{BB}, \\epsilon_{AB}, N, f_A, T^\\star)$）：\n- 案例 $1$：$(1.0, 1.0, 0.2, 100, 0.50, 1.0)$\n- 案例 $2$：$(1.0, 1.0, 0.8, 100, 0.20, 1.0)$\n- 案例 $3$：$(1.0, 1.0, 0.95, 50, 0.50, 1.0)$\n- 案例 $4$：$(1.0, 1.0, 0.99, 50, 0.50, 1.0)$\n- 案例 $5$：$(0.8, 1.2, 0.7, 30, 0.80, 1.0)$\n\n最终输出格式：您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起，结果顺序与测试套件相同（例如，$[2,1,2,0,1]$）。", "solution": "目标是通过实施一套指定的规则，对二嵌段共聚物熔体的平衡形貌进行分类。该解决方案需要基于所提供的物理模型进行逐步计算。\n\n问题的核心在于将微观相互作用参数转化为对宏观结构的预测。这是通过一系列具有物理动因的步骤来完成的。\n\n首先，我们必须量化两种不同单体类型 A 和 B 之间的有效排斥作用。问题指出，任意两个单体 $i, j \\in \\{A, B\\}$ 之间的相互作用由 Lennard-Jones 势 $U_{ij}(r)$ 描述，其能量标度由势阱深度参数 $\\epsilon_{ij}$ 设定。在稠密的熔体中，对 A-A 和 B-B 接触的偏好（而非 A-B 接触）驱动相分离。这种能量偏好由 Flory-Huggins 参数 $\\chi$ 捕捉。问题提供了基于 Lennard-Jones 能量参数的 $\\chi$ 的平均场近似：\n$$\n\\chi = \\frac{z}{T^\\star}\\left(\\frac{\\epsilon_{AA} + \\epsilon_{BB}}{2} - \\epsilon_{AB}\\right)\n$$\n此处，项 $(\\frac{\\epsilon_{AA} + \\epsilon_{BB}}{2} - \\epsilon_{AB})$ 表示一个 A-B 接触相对于同类接触平均能量的超额能量。正值表示不相容。参数 $z$ 是一个有效配位数，代表一个单体的平均近邻接触数，给定为 $z=6$。约化温度 $T^\\star$ 对能量上的非热不相容性进行标度。\n\n其次，我们考虑嵌段共聚物链的整体热力学。由正 $\\chi$ 驱动的相分离趋势，会因拉伸链以形成大的纯域而导致构象熵损失，从而受到抑制。连接 A 和 B 嵌段的共价键阻止了宏观相分离。系统转而形成微观域。分离的焓驱动与链拉伸的熵罚之间的平衡由乘积 $\\chi N$ 决定，其中 $N$ 是总聚合度。当 $\\chi N$ 较小时，熵占主导地位，A 和 B 嵌段混合，形成无序态。当 $\\chi N$ 足够大时，焓占主导地位，系统有序化为微相分离结构。这个有序-无序转变 (ODT) 的临界值给定为 $C_{\\mathrm{ODT}} = 10.5$。\n\n第三，如果系统是有序的（$\\chi N \\ge C_{\\mathrm{ODT}}$），微观域的具体几何形状取决于 A 和 B 嵌段的相对体积，这由组成分数 $f_A$ 决定。堆积限制决定了最终的形貌。对于对称组成（$f_A$ 接近 $0.5$），A 和 B 域之间的界面趋于平坦，形成层状结构。对于非对称组成（$f_A$ 远非 $0.5$），界面必须弯曲以适应体积差异，少数嵌段在多数嵌段的基质中形成球形或圆柱形域（胶束）。问题为此提供了一个简化规则：\n- 如果 $0.35 \\le f_A \\le 0.65$，形貌为层状。\n- 如果 $f_A < 0.35$ 或 $f_A > 0.65$，形貌为胶束。\n\n确定每个测试案例 $(\\epsilon_{AA}, \\epsilon_{BB}, \\epsilon_{AB}, N, f_A, T^\\star)$ 形貌标签的算法流程如下：\n1.  设定常数：$z = 6.0$ 和 $C_{\\mathrm{ODT}} = 10.5$。\n2.  使用公式 $\\chi = \\frac{z}{T^\\star}\\left(\\frac{\\epsilon_{AA} + \\epsilon_{BB}}{2} - \\epsilon_{AB}\\right)$ 计算 $\\chi$。\n3.  计算乘积 $\\chi N$。\n4.  应用分类逻辑：\n    - 如果 $\\chi N < 10.5$，标签为 $0$（无序）。\n    - 否则（如果 $\\chi N \\ge 10.5$）：\n        - 如果 $0.35 \\le f_A \\le 0.65$，标签为 $2$（层状）。\n        - 否则，标签为 $1$（胶束）。\n\n此流程将对所提供的 5 个测试案例中的每一个实施，以生成最终的分类标签列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the morphology label for diblock copolymer melts based on\n    a mean-field model.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (epsilon_AA, epsilon_BB, epsilon_AB, N, f_A, T_star)\n    test_cases = [\n        (1.0, 1.0, 0.2, 100, 0.50, 1.0),\n        (1.0, 1.0, 0.8, 100, 0.20, 1.0),\n        (1.0, 1.0, 0.95, 50, 0.50, 1.0),\n        (1.0, 1.0, 0.99, 50, 0.50, 1.0),\n        (0.8, 1.2, 0.7, 30, 0.80, 1.0),\n    ]\n\n    # Define constants from the problem statement.\n    z = 6.0  # Effective coordination number\n    C_ODT = 10.5  # Critical value for order-disorder transition\n\n    results = []\n    for case in test_cases:\n        eps_AA, eps_BB, eps_AB, N, f_A, T_star = case\n\n        # Step 1: Calculate the Flory-Huggins incompatibility parameter chi.\n        # chi = (z / T_star) * (0.5 * (eps_AA + eps_BB) - eps_AB)\n        chi = (z / T_star) * (0.5 * (eps_AA + eps_BB) - eps_AB)\n\n        # Step 2: Calculate the incompatibility product chi*N.\n        chi_N = chi * N\n\n        # Step 3: Apply the classification rules to determine the morphology label.\n        label = 0  # Default label is Disordered (0)\n\n        # Check for ordered phases\n        if chi_N >= C_ODT:\n            # Check for lamellar vs. micellar morphology based on f_A\n            if 0.35 <= f_A <= 0.65:\n                label = 2  # Lamellae\n            else:\n                label = 1  # Micelles\n        else:\n            label = 0  # Disordered\n\n        results.append(label)\n\n    # Final print statement in the exact required format.\n    # e.g., [2,1,2,0,1]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2466682"}]}