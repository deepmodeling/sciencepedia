{"hands_on_practices": [{"introduction": "理解高温超导体的第一步是探究其独特的化学成分和电子结构。这个练习将从一个基础的化学概念——氧化态——入手。通过对著名的钇钡铜氧（YBCO）超导体应用电荷中性原则，你将亲自计算出铜离子的平均氧化态，从而揭示高温超导体中一个至关重要的特性：混合价态，这是理解其“空穴掺杂”和超导电性起源的基石。[@problem_id:2257723]", "problem": "研究最多的高温超导体之一是陶瓷材料钇钡铜氧 (YBCO)，其化学计量式为 $\\text{YBa}_2\\text{Cu}_3\\text{O}_7$。该材料迷人的特性源于其特定的电子结构，而电子结构又高度依赖于其组成元素的氧化态。假设钇 (Y)、钡 (Ba) 和氧 (O) 在离子化合物中采用其最常见和最稳定的氧化态（分别为 +3、+2 和 -2），请确定该化合物中铜 (Cu) 的平均氧化态。请用精确分数表示你的答案。", "solution": "在一个电中性化合物中，各元素氧化态与其原子数的乘积之和等于零。设铜的平均氧化态为 $x$。根据给定的 Y 的常见氧化态 $+3$、Ba 的 $+2$、O 的 $-2$，以及化学计量式 $\\text{YBa}_{2}\\text{Cu}_{3}\\text{O}_{7}$，电荷平衡方程为\n$$\n1\\cdot(+3)+2\\cdot(+2)+3\\cdot x+7\\cdot(-2)=0.\n$$\n具体来说，\n$$\n3+4+3x-14=0 \\;\\;\\Rightarrow\\;\\; 3x-7=0 \\;\\;\\Rightarrow\\;\\; x=\\frac{7}{3}.\n$$\n因此，在 $\\text{YBa}_{2}\\text{Cu}_{3}\\text{O}_{7}$ 中，铜的平均氧化态为 $\\frac{7}{3}$。", "answer": "$$\\boxed{\\frac{7}{3}}$$", "id": "2257723"}, {"introduction": "在掌握了基础的化学计量学之后，让我们来模拟一个更接近真实研究的场景。高温超导体的性质，尤其是其临界温度 $T_c$，可以通过化学掺杂和控制氧含量来精确调控。本练习要求你基于实验中可能观察到的质量损失数据，来计算镧锶铜氧（LSCO）材料中每个铜原子的空穴浓度 $p$。这个过程将让你体会到，科学家是如何将宏观测量（如质量变化）与微观的关键电子参数（如载流子浓度）联系起来，从而绘制出材料的相图。[@problem_id:2828432]", "problem": "考虑一种具有 K$_2$NiF$_4$ 型结构的层状铜氧化物 $\\mathrm{La_{2-x}Sr_xCuO_{4-\\delta}}$。已知镧的名义价态为 $\\mathrm{La^{3+}}$，锶的名义价态为 $\\mathrm{Sr^{2+}}$，氧的名义价态为 $\\mathrm{O^{2-}}$，铜的平均价态为 $\\mathrm{Cu}^{2+p}}$，其中 $p$ 是每个铜原子的空穴浓度（无量纲）。锶含量为 $x = 0.18$。该样品是通过锶取代镧位点而合成的。在九配位情况下，Shannon 离子半径分别为 $r_{\\mathrm{La^{3+}}} = 1.216\\,\\mathrm{\\AA}$ 和 $r_{\\mathrm{Sr^{2+}}} = 1.31\\,\\mathrm{\\AA}$，以及 $r_{\\mathrm{O^{2-}}} \\approx 1.40\\,\\mathrm{\\AA}$（作为配位尺寸的参考）。将一个初始质量为 $m_i$ 的该材料压片样品在高温惰性气氛中进行退火处理，由于脱氧（无阳离子损失或挥发），其损失的相对质量分数为 $f = 8.00 \\times 10^{-4}$。使用以下标准原子质量：$M_{\\mathrm{La}} = 138.9055\\,\\mathrm{g\\,mol^{-1}}$，$M_{\\mathrm{Sr}} = 87.62\\,\\mathrm{g\\,mol^{-1}}$，$M_{\\mathrm{Cu}} = 63.546\\,\\mathrm{g\\,mol^{-1}}$，以及 $M_{\\mathrm{O}} = 15.999\\,\\mathrm{g\\,mol^{-1}}$。\n\n从电荷中性原理和给定的离子价态出发，确定退火后每个铜原子的空穴浓度 $p$。明确陈述并论证您根据所提供的离子半径信息对氧化学计量所做的任何假设。将您的最终答案表示为一个无量纲数（空穴数/Cu），并四舍五入到三位有效数字。", "solution": "该问题要求确定在掺锶镧铜氧化物样品 $\\mathrm{La_{2-x}Sr_xCuO_{4-\\delta}}$ 经过退火并因脱氧而损失特定质量分数后，每个铜原子的空穴浓度 $p$。\n\n首先，我们必须验证问题陈述的有效性。该问题在化学和物理上是合理的。它描述了一种典型的高温超导体 $\\mathrm{La_{2-x}Sr_xCuO_4}$，以及一种用于控制其氧含量并因此控制其电子性质的标准实验程序（在惰性气氛中退火）。对于该体系，给定的名义价态、原子质量和结构类型 (K$_2$NiF$_4$) 都是正确的。问题提取得当，提供了计算最终氧缺位和所得空穴浓度的所有必要信息。因此，该问题是有效的。\n\n求解过程分为三个主要步骤：\n1.  确定初始化学式，并计算退火前化合物的相应摩尔质量。\n2.  使用给定的相对质量损失分数 $f$ 来确定最终的氧缺位 $\\delta$。\n3.  对最终的化学式应用电荷中性原理，以求解空穴浓度 $p$。\n\n步骤 1：初始状态和摩尔质量\n该问题描述了一个先合成后退火的样品。我们必须对退火前的初始状态的氧化学计量做出合理的假设。对于初合成的 $\\mathrm{La_{2-x}Sr_xCuO_4}$，最标准且最合理的假设是其已完全氧化，即其氧含量是化学计量的。这对应于初始氧缺位为零。随后的退火步骤引入了非零的氧缺位。因此，我们假设初始化学式为 $\\mathrm{La_{2-x}Sr_xCuO_4}$。离子半径信息 $r_{\\mathrm{Sr^{2+}}} > r_{\\mathrm{La^{3+}}}$ 表明在镧位点存在尺寸失配，这会引起化学压力。然而，在没有更多信息的情况下，这并不否定初始氧化学计量的标准假设；这是该材料体系的一个已知特征。\n\n给定锶含量 $x = 0.18$，初始化学式为 $\\mathrm{La_{1.82}Sr_{0.18}CuO_4}$。\n该化合物的初始摩尔质量 $M_i$ 使用所提供的原子质量计算：$M_{\\mathrm{La}} = 138.9055\\,\\mathrm{g\\,mol^{-1}}$，$M_{\\mathrm{Sr}} = 87.62\\,\\mathrm{g\\,mol^{-1}}$，$M_{\\mathrm{Cu}} = 63.546\\,\\mathrm{g\\,mol^{-1}}$，以及 $M_{\\mathrm{O}} = 15.999\\,\\mathrm{g\\,mol^{-1}}$。\n$$M_i = (2-x)M_{\\mathrm{La}} + x M_{\\mathrm{Sr}} + M_{\\mathrm{Cu}} + 4 M_{\\mathrm{O}}$$\n代入数值：\n$$M_i = (1.82)(138.9055\\,\\mathrm{g\\,mol^{-1}}) + (0.18)(87.62\\,\\mathrm{g\\,mol^{-1}}) + 63.546\\,\\mathrm{g\\,mol^{-1}} + (4)(15.999\\,\\mathrm{g\\,mol^{-1}})$$\n$$M_i = 252.80801\\,\\mathrm{g\\,mol^{-1}} + 15.7716\\,\\mathrm{g\\,mol^{-1}} + 63.546\\,\\mathrm{g\\,mol^{-1}} + 63.996\\,\\mathrm{g\\,mol^{-1}} = 396.12161\\,\\mathrm{g\\,mol^{-1}}$$\n\n步骤 2：最终氧缺位\n退火后，材料失去氧，其化学式变为 $\\mathrm{La_{2-x}Sr_xCuO_{4-\\delta}}$。每个化学式单位的质量损失为 $\\delta \\cdot M_{\\mathrm{O}}$。相对质量损失分数 $f$ 是损失的质量与初始质量之比。对于一摩尔物质：\n$$f = \\frac{\\text{质量损失}}{\\text{初始质量}} = \\frac{\\delta \\cdot M_{\\mathrm{O}}}{M_i}$$\n我们可以求解最终的氧缺位 $\\delta$：\n$$\\delta = \\frac{f \\cdot M_i}{M_{\\mathrm{O}}}$$\n使用给定值 $f = 8.00 \\times 10^{-4}$：\n$$\\delta = \\frac{(8.00 \\times 10^{-4}) \\cdot (396.12161\\,\\mathrm{g\\,mol^{-1}})}{15.999\\,\\mathrm{g\\,mol^{-1}}} \\approx 0.0198072$$\n\n步骤 3：电荷中性与空穴浓度\n电荷中性原理要求每个化学式单位的总电荷为零。最终的化学式为 $\\mathrm{La_{1.82}Sr_{0.18}CuO_{4-\\delta}}$。名义价态分别为 $\\mathrm{La^{3+}}$、$\\mathrm{Sr^{2+}}$、$\\mathrm{Cu^{2+p}}$ 和 $\\mathrm{O^{2-}}$。\n电荷平衡方程为：\n$$(2-x)(+3) + x(+2) + (1)(2+p) + (4-\\delta)(-2) = 0$$\n代入 $x=0.18$：\n$$(1.82)(+3) + (0.18)(+2) + (2+p) + (4-\\delta)(-2) = 0$$\n$$5.46 + 0.36 + 2 + p - 8 + 2\\delta = 0$$\n$$7.82 + p - 8 + 2\\delta = 0$$\n$$-0.18 + p + 2\\delta = 0$$\n求解空穴浓度 $p$：\n$$p = 0.18 - 2\\delta$$\n该方程表明，对于完全氧化的样品（$\\delta=0$），空穴浓度等于锶含量 $x=0.18$；随着氧的脱出（$\\delta>0$），空穴浓度降低。\n\n现在，我们代入计算出的 $\\delta$ 值来求得最终的空穴浓度 $p$：\n$$p = 0.18 - 2(0.0198072)$$\n$$p = 0.18 - 0.0396144$$\n$$p \\approx 0.1403856$$\n问题要求答案四舍五入到三位有效数字。\n$$p \\approx 0.140$$\n因此，退火后每个铜原子的最终空穴浓度为 $0.140$。", "answer": "$$\\boxed{0.140}$$", "id": "2828432"}, {"introduction": "我们已经知道如何确定超导体中的载流子浓度，但这些载流子在晶体中是如何运动的呢？这就需要我们了解材料的能带结构。本练习将带你进入计算材料物理的世界，通过将一个理论模型（紧束缚模型）与模拟的实验数据（角分辨光电子能谱，ARPES）进行拟合，来提取描述能带结构的关键参数。这项实践不仅能锻炼你的计算编程能力，更重要的是，它揭示了现代理论和实验物理学家如何协同工作，从测量数据中提炼出描述材料电子世界的深刻物理规律。[@problem_id:2828406]", "problem": "给定一个用于描述高温铜氧化物超导体中铜氧面的单带紧束缚模型，其电子能带色散在晶格常数设为1的正方晶格上建模。其色散关系为\n$$\n\\epsilon(\\mathbf{k}) = -2t\\left(\\cos k_x + \\cos k_y\\right) - 4t'\\cos k_x \\cos k_y - 2t''\\left(\\cos 2k_x + \\cos 2k_y\\right),\n$$\n其中 $\\mathbf{k}=(k_x,k_y)$，$t$ 是最近邻跃迁振幅，$t'$ 是次近邻跃迁振幅，$t''$ 是次次近邻跃迁振幅。角度 $k_x$ 和 $k_y$ 的单位是弧度。能量必须以电子伏特 (eV) 表示。\n\n角分辨光电子能谱 (ARPES) 测量沿动量空间切线的能带色散 $\\epsilon(\\mathbf{k})$。您将处理基于上述模型在选定的空穴掺杂浓度 $p$ 下生成的无噪声合成ARPES能带图。对于每个掺杂浓度 $p$，会指定沿标准布里渊区 (BZ) 切线的一组动量 $\\{\\mathbf{k}_i\\}$，并使用依赖于掺杂的参数 $(t,t',t'')$ 通过色散关系计算出相应的能量 $\\{E_i\\}$。\n\n您的任务是通过最小二乘法将模型与合成数据进行拟合，从而计算每个掺杂浓度下的比率 $t'/t$。您需要基于以下基本且经过充分检验的基础出发：\n- 正方晶格上紧束缚哈密顿量的动量空间色散定义。\n- 最小二乘法原理：给定数据 $\\{(\\mathbf{k}_i,E_i)\\}$ 和一个参数 $\\theta$ 呈线性的模型 $\\epsilon(\\mathbf{k};\\theta)$，最佳拟合参数应使残差平方和 $\\sum_i \\left[E_i - \\epsilon(\\mathbf{k}_i;\\theta)\\right]^2$ 最小化。\n\n实现一个程序，执行以下步骤：\n1. 对于所提供测试套件中的每个掺杂浓度 $p$，通过在以下三个动量空间切线（角度单位为弧度）的并集上评估 $\\epsilon(\\mathbf{k})$ 来生成合成ARPES数据：\n   - Γ → X 切线：$k_y = 0$，其中 $k_x$ 在 $[-\\pi, \\pi]$ 区间（含两端）上均匀采样 $N = 51$ 个点。\n   - Γ → M 对角线切线：$k_x = k_y$，其中 $k_x = k_y$ 在 $[-\\pi, \\pi]$ 区间（含两端）上均匀采样 $N = 51$ 个点。\n   - 布里渊区边界切线：$k_y = \\pi$，其中 $k_x$ 在 $[-\\pi, \\pi]$ 区间（含两端）上均匀采样 $N = 51$ 个点。\n   使用 $a=1$（晶格常数），因此 $k_x$ 和 $k_y$ 以弧度为单位，位于第一布里渊区 $[-\\pi,\\pi]\\times[-\\pi,\\pi]$ 内。对于每个采样点 $\\mathbf{k}=(k_x,k_y)$，使用上述色散关系和对应掺杂浓度的真实参数，以电子伏特为单位计算能量 $E = \\epsilon(\\mathbf{k})$。不要添加噪声。\n2. 对于每个掺杂浓度，通过求解使下式最小化的线性最小二乘问题来估计 $(\\hat t,\\hat t',\\hat t'')$：\n   $$\n   S(t,t',t'') = \\sum_i \\left[E_i - \\epsilon(\\mathbf{k}_i; t,t',t'')\\right]^2.\n   $$\n   由于模型在参数 $t$、$t'$ 和 $t''$ 上是线性的，这个问题可以通过对以下特征进行线性回归来解决：\n   $$\n   f_1(\\mathbf{k}) = -2\\left(\\cos k_x + \\cos k_y\\right),\\quad\n   f_2(\\mathbf{k}) = -4\\cos k_x \\cos k_y,\\quad\n   f_3(\\mathbf{k}) = -2\\left(\\cos 2k_x + \\cos 2k_y\\right),\n   $$\n   从而 $E = f_1 t + f_2 t' + f_3 t''$。\n3. 报告每个掺杂浓度 $p$ 的比率 $r = \\hat t'/\\hat t$。\n\n单位和角度约定：\n- 能量 $E$ 必须以电子伏特 (eV) 计算。\n- 角度 $k_x,k_y$ 必须按弧度处理。\n\n测试套件（用于生成合成数据的掺杂浓度和真实参数；所有能量单位均为电子伏特）：\n- 案例 1：$p = 0.08$，$t = 0.32$，$t' = -0.12$，$t'' = 0.06$。\n- 案例 2：$p = 0.16$，$t = 0.34$，$t' = -0.10$，$t'' = 0.05$。\n- 案例 3：$p = 0.24$，$t = 0.36$，$t' = -0.09$，$t'' = 0.04$。\n- 案例 4：$p = 0.30$，$t = 0.38$，$t' = -0.08$，$t'' = 0.03$。\n\n您的程序必须：\n- 完全按照上述规定生成合成数据集，不得引入随机性。\n- 为每个掺杂浓度求解线性最小二乘问题。\n- 为每个掺杂浓度计算比率 $r = \\hat t'/\\hat t$，并将每个 $r$ 四舍五入到六位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果的顺序与测试套件中掺杂浓度的顺序相同。例如，输出必须类似于\n$[\\text{r}_1,\\text{r}_2,\\text{r}_3,\\text{r}_4]$\n其中每个 $\\text{r}_i$ 是一个四舍五入到六位小数且不带单位的浮点数。", "solution": "该问题已经过严格验证，被确定为科学上合理、问题适定且计算上可行。这是计算材料物理学中的一个标准练习，涉及将线性回归应用于物理模型。我们将着手进行求解。\n\n该问题要求估算高温铜氧化物超导体的单带紧束缚模型中跃迁参数的比率 $t'/t$。在晶格常数归一 ($a=1$) 的正方晶格上，电子能带色散 $\\epsilon(\\mathbf{k})$ 由下式给出：\n$$\n\\epsilon(\\mathbf{k}) = -2t\\left(\\cos k_x + \\cos k_y\\right) - 4t'\\cos k_x \\cos k_y - 2t''\\left(\\cos 2k_x + \\cos 2k_y\\right)\n$$\n其中 $\\mathbf{k}=(k_x,k_y)$ 是动量空间矢量，$(t, t', t'')$ 分别是最近邻、次近邻和次次近邻的跃迁振幅。\n\n核心任务是从在动量点集 $\\{\\mathbf{k}_i\\}$ 上生成的合成无噪声能量数据 $E_i$ 中恢复这些参数。$\\epsilon(\\mathbf{k})$ 模型在参数 $(t, t', t'')$ 上是线性的。这使我们能够将问题构建为一个线性最小二乘拟合。我们可以将能量表示为：\n$$\nE(\\mathbf{k}) = t \\cdot f_1(\\mathbf{k}) + t' \\cdot f_2(\\mathbf{k}) + t'' \\cdot f_3(\\mathbf{k})\n$$\n特征（或基函数）$f_j(\\mathbf{k})$ 由其对动量 $\\mathbf{k}$ 的依赖关系定义：\n$$\nf_1(\\mathbf{k}) = -2\\left(\\cos k_x + \\cos k_y\\right)\n$$\n$$\nf_2(\\mathbf{k}) = -4\\cos k_x \\cos k_y\n$$\n$$\nf_3(\\mathbf{k}) = -2\\left(\\cos 2k_x + \\cos 2k_y\\right)\n$$\n对于一组 $M$ 个测量值 $(\\mathbf{k}_i, E_i)$（其中 $i=1, \\dots, M$），我们可以构建一个线性方程组。其矩阵形式表示为 $\\mathbf{E} = \\mathbf{X} \\boldsymbol{\\beta}$，其中：\n- $\\mathbf{E}$ 是一个由观测能量 $\\{E_i\\}$ 组成的 $M \\times 1$ 列向量。\n- $\\boldsymbol{\\beta}$ 是待估计的未知参数组成的 $3 \\times 1$ 列向量，$\\boldsymbol{\\beta} = [\\hat t, \\hat t', \\hat t'']^T$。\n- $\\mathbf{X}$ 是 $M \\times 3$ 的设计矩阵，其中每个元素 $X_{ij}$ 对应于第 $i$ 个动量点的第 $j$ 个特征值，$X_{ij} = f_j(\\mathbf{k}_i)$。\n\n最小化残差平方和 $S = \\sum_i (E_i - \\epsilon(\\mathbf{k}_i; \\hat t, \\hat t', \\hat t''))^2 = ||\\mathbf{E} - \\mathbf{X}\\hat{\\boldsymbol{\\beta}}||_2^2$ 的解 $\\hat{\\boldsymbol{\\beta}}$，可以通过求解正规方程组 $\\mathbf{X}^T\\mathbf{X}\\hat{\\boldsymbol{\\beta}} = \\mathbf{X}^T\\mathbf{E}$ 找到。为求解这个超定系统，我们采用一种数值稳定的方法，例如奇异值分解 (SVD)。\n\n对于每个由空穴掺杂水平 $p$ 和一组相应真实参数 $(t_{true}, t'_{true}, t''_{true})$ 标识的测试案例，其流程如下：\n\n1.  **生成合成数据：**\n    - 在第一布里渊区 $[-\\pi, \\pi] \\times [-\\pi, \\pi]$ 内，沿3条特定切线进行采样，共生成 $M = 3 \\times 51 = 153$ 个动量点 $\\{\\mathbf{k}_i\\}$。\n    - **切线 1 (Γ → X 路径)：** $k_y = 0$，其中 $k_x$ 在 $[-\\pi, \\pi]$ 区间上均匀采样 $N = 51$ 个点。\n    - **切线 2 (Γ → M 路径)：** $k_x = k_y$，其中两个分量均在 $[-\\pi, \\pi]$ 区间上均匀采样 $N = 51$ 个点。\n    - **切线 3 (布里渊区边界路径)：** $k_y = \\pi$，其中 $k_x$ 在 $[-\\pi, \\pi]$ 区间上均匀采样 $N = 51$ 个点。\n    - 对每个 $\\mathbf{k}_i$，使用该案例的真实参数 $(t_{true}, t'_{true}, t''_{true})$ 和色散关系式计算出相应的能量 $E_i$。这就构成了我们的合成ARPES数据。\n\n2.  **执行线性最小二乘拟合：**\n    - 通过在 $M=153$ 个动量点上分别计算 3 个特征 $f_1, f_2, f_3$ 的值来构建设计矩阵 $\\mathbf{X}$。\n    - 合成能量向量 $\\mathbf{E}$ 作为目标变量。\n    - 使用标准的线性最小二乘求解器求解线性系统 $\\mathbf{X}\\hat{\\boldsymbol{\\beta}} = \\mathbf{E}$ 以得到 $\\hat{\\boldsymbol{\\beta}} = [\\hat{t}, \\hat{t'}, \\hat{t''}]^T$。由于数据是无噪声的，并且是从同一模型生成的，拟合结果预计将在机器精度范围内恢复真实参数，即 $\\hat{\\boldsymbol{\\beta}} \\approx \\boldsymbol{\\beta}_{true}$。\n\n3.  **计算比率：**\n    - 从估计的参数向量 $\\hat{\\boldsymbol{\\beta}}$ 中提取前两个分量 $\\hat{t}$ 和 $\\hat{t'}$。\n    - 计算所求比率 $r = \\hat{t'}/\\hat{t}$。\n    - 按要求将结果四舍五入到 6 位小数。\n\n对提供的 4 个测试案例中的每一个重复此流程。掺杂参数 $p$ 仅用作每个参数集的标识符，并未在计算中使用。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the tight-binding parameter ratio t'/t for several doping cases.\n    \"\"\"\n    # Test suite (doping p, t, t', t''). Doping p is only for context.\n    # Energies are in eV.\n    test_cases = [\n        # p, t, t', t''\n        (0.08, 0.32, -0.12, 0.06),\n        (0.16, 0.34, -0.10, 0.05),\n        (0.24, 0.36, -0.09, 0.04),\n        (0.30, 0.38, -0.08, 0.03),\n    ]\n\n    results = []\n\n    for _, t_true, t_prime_true, t_prime2_true in test_cases:\n        # Step 1: Generate synthetic ARPES data\n        \n        # Define momentum sampling\n        N = 51\n        kx_range = np.linspace(-np.pi, np.pi, N, dtype=np.float64)\n\n        # Cut 1: Gamma -> X path (ky=0)\n        k_cut1 = np.zeros((N, 2), dtype=np.float64)\n        k_cut1[:, 0] = kx_range\n\n        # Cut 2: Gamma -> M path (kx=ky)\n        k_cut2 = np.zeros((N, 2), dtype=np.float64)\n        k_cut2[:, 0] = kx_range\n        k_cut2[:, 1] = kx_range\n\n        # Cut 3: Zone boundary path (ky=pi)\n        k_cut3 = np.zeros((N, 2), dtype=np.float64)\n        k_cut3[:, 0] = kx_range\n        k_cut3[:, 1] = np.pi\n\n        # Combine momentum points from all cuts\n        k_points = np.vstack((k_cut1, k_cut2, k_cut3))\n        kx = k_points[:, 0]\n        ky = k_points[:, 1]\n\n        # Define the features (basis functions) of the linear model\n        # f1 for t, f2 for t', f3 for t''\n        f1 = -2.0 * (np.cos(kx) + np.cos(ky))\n        f2 = -4.0 * np.cos(kx) * np.cos(ky)\n        f3 = -2.0 * (np.cos(2 * kx) + np.cos(2 * ky))\n        \n        # Construct the design matrix X\n        X = np.stack((f1, f2, f3), axis=1)\n\n        # Generate synthetic energy data E using the true parameters\n        true_params = np.array([t_true, t_prime_true, t_prime2_true])\n        E = X @ true_params\n\n        # Step 2: Solve the linear least-squares problem\n        # The model is E = X @ [t, t', t'']\n        # We solve for the parameters [t, t', t'']\n        # Since the data is noise-free, the fit should be exact.\n        estimated_params, _, _, _ = np.linalg.lstsq(X, E, rcond=None)\n        \n        t_hat = estimated_params[0]\n        t_prime_hat = estimated_params[1]\n        \n        # Step 3: Compute the ratio r = t'/t\n        ratio = t_prime_hat / t_hat\n        \n        # Round to six decimal places and store the result\n        results.append(round(ratio, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2828406"}]}