{"hands_on_practices": [{"introduction": "为了掌握对抗性错误模型，我们从一个基础的构建模块——一个简单的量子线路——开始。这个练习将引导你追踪一个被策略性放置的退相干错误，对一个著名的纠缠态（GHZ态）的制备过程所产生的影响[@problem_id:44176]。通过这个计算，你将为错误如何传播以及系统的脆弱点在何处建立起直观的理解。", "problem": "用于从初态 $|\\psi_0\\rangle = |000\\rangle$ 制备三量子比特 Greenberger-Horne-Zeilinger (GHZ) 态 $|\\text{GHZ}_3\\rangle = \\frac{1}{\\sqrt{2}}(|000\\rangle + |111\\rangle)$ 的标准线路包含一个由三个门组成的序列：\n1.  $G_1$：作用于量子比特 1 上的一个 Hadamard 门 ($H_1$)。\n2.  $G_2$：一个以量子比特 1 为控制位、量子比特 2 为目标位的受控非门 ($CNOT_{12}$)。\n3.  $G_3$：一个以量子比特 1 为控制位、量子比特 3 为目标位的受控非门 ($CNOT_{13}$)。\n\n理想的末态为 $|\\psi_f\\rangle = G_3 G_2 G_1 |\\psi_0\\rangle = |\\text{GHZ}_3\\rangle$。\n\n考虑一个对手可以引入一个错误的场景。该错误模型是一个单量子比特退相干通道，由 Kraus 算符 $E_0 = \\sqrt{1-\\gamma}I$ 和 $E_1 = \\sqrt{\\gamma}Z$ 描述，其中 $Z$ 是泡利-Z 算符。该通道作用于密度矩阵 $\\rho$ 上的行为是 $\\mathcal{E}_\\gamma(\\rho) = E_0 \\rho E_0^\\dagger + E_1 \\rho E_1^\\dagger = (1-\\gamma)\\rho + \\gamma Z\\rho Z$。\n\n对手的目标是最小化末态与理想态 $|\\text{GHZ}_3\\rangle$ 之间的保真度。他们可以在任意一个门 $G_k$（其中 $k \\in \\{1, 2, 3\\}$）之后，立即在任意单个量子比特 $j \\in \\{1, 2, 3\\}$ 上插入退相干通道 $\\mathcal{E}_\\gamma$ 恰好一次。\n\n纯态 $|\\psi\\rangle$ 与混合态 $\\sigma$ 之间的保真度由 $F(|\\psi\\rangle, \\sigma) = \\langle\\psi|\\sigma|\\psi\\rangle$ 给出。\n\n计算最坏情况下的保真度 $F_{worst}$，即对手可实现的最小保真度。您的答案应为一个以退相干强度 $\\gamma$ 表示的表达式。", "solution": "理想态 $ |\\text{GHZ}_3\\rangle $ 与末态 $ \\sigma $ 之间的保真度由下式给出：\n\n$$\nF(|\\text{GHZ}_3\\rangle, \\sigma) = \\langle \\text{GHZ}_3 | \\sigma | \\text{GHZ}_3 \\rangle.\n$$\n\n具有 Kraus 算符 $ E_0 = \\sqrt{1-\\gamma} I $ 和 $ E_1 = \\sqrt{\\gamma} Z $ 的退相干通道 $ \\mathcal{E}_\\gamma $ 在门 $ G_k $ 之后、在量子比特 $ j $ 上插入一次。经过门 $ G_k $ 后的态是纯态，记为 $ |\\psi_k\\rangle $。经过该通道后，态变为：\n\n$$\n\\rho_k = \\mathcal{E}_\\gamma(|\\psi_k\\rangle\\langle\\psi_k|) = (1-\\gamma) |\\psi_k\\rangle\\langle\\psi_k| + \\gamma Z_j |\\psi_k\\rangle\\langle\\psi_k| Z_j.\n$$\n\n作用剩余的门 $ U_{\\text{rem}} $ (从 $ G_{k+1} $ 到 $ G_3 $)，则末态为：\n\n$$\n\\sigma = U_{\\text{rem}} \\rho_k U_{\\text{rem}}^\\dagger = (1-\\gamma) U_{\\text{rem}} |\\psi_k\\rangle\\langle\\psi_k| U_{\\text{rem}}^\\dagger + \\gamma U_{\\text{rem}} (Z_j |\\psi_k\\rangle\\langle\\psi_k| Z_j) U_{\\text{rem}}^\\dagger.\n$$\n\n定义：\n- $ |\\phi\\rangle = U_{\\text{rem}} |\\psi_k\\rangle = |\\text{GHZ}_3\\rangle $ (无错误时的理想末态)，\n- $ |\\phi_j\\rangle = U_{\\text{rem}} (Z_j |\\psi_k\\rangle) $ (经过错误和剩余门后的态)。\n\n则：\n\n$$\n\\sigma = (1-\\gamma) |\\phi\\rangle\\langle\\phi| + \\gamma |\\phi_j\\rangle\\langle\\phi_j|.\n$$\n\n保真度为：\n\n$$\nF = \\langle \\text{GHZ}_3 | \\sigma | \\text{GHZ}_3 \\rangle = (1-\\gamma) \\langle \\text{GHZ}_3 | \\phi \\rangle \\langle \\phi | \\text{GHZ}_3 \\rangle + \\gamma \\langle \\text{GHZ}_3 | \\phi_j \\rangle \\langle \\phi_j | \\text{GHZ}_3 \\rangle.\n$$\n\n由于 $ |\\phi\\rangle = |\\text{GHZ}_3\\rangle $，所以 $ \\langle \\text{GHZ}_3 | \\phi \\rangle = 1 $，且：\n\n$$\nF = (1-\\gamma) \\cdot 1 + \\gamma |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 1 - \\gamma + \\gamma |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2.\n$$\n\n\n现在，为每个插入位置和量子比特计算 $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 $。\n\n- **在 $ G_1 $ (作用于量子比特 1 的 Hadamard 门) 之后：**  \n  初态：$ |\\psi_0\\rangle = |000\\rangle $。  \n  经过 $ G_1 $ 后：$ |\\psi_1\\rangle = H_1 |000\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle + |100\\rangle) $。\n  作用 $ Z_j $：\n  - $ j=1 $：$ Z_1 |\\psi_1\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle - |100\\rangle) $。\n    作用 $ G_2 $ (CNOT$_{12}$) 后：$ \\frac{1}{\\sqrt{2}} (|000\\rangle - |110\\rangle) $。\n    作用 $ G_3 $ (CNOT$_{13}$) 后：$ \\frac{1}{\\sqrt{2}} (|000\\rangle - |111\\rangle) $。\n    所以 $ |\\phi_j\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle - |111\\rangle) $。\n    $ \\langle \\text{GHZ}_3 | \\phi_j \\rangle = \\frac{1}{2} (\\langle 000|000\\rangle - \\langle 000|111\\rangle + \\langle 111|000\\rangle - \\langle 111|111\\rangle) = \\frac{1}{2}(1 - 0 + 0 - 1) = 0 $。\n    因此，$ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 0 $。\n  - $ j=2 $：$ Z_2 |\\psi_1\\rangle = |\\psi_1\\rangle $ (无变化，因为第二个量子比特是 $ |0\\rangle $)。\n    经过 $ G_2 $ 和 $ G_3 $ 之后：$ |\\phi_j\\rangle = |\\text{GHZ}_3\\rangle $，所以 $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 1 $。\n  - $ j=3 $：与 $ j=2 $ 类似，$ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 1 $。\n  保真度：$ j=1 $ 时，$ F = 1 - \\gamma $；$ j=2,3 $ 时，$ F = 1 $。\n\n- **在 $ G_2 $ (CNOT$_{12}$) 之后：**  \n  经过 $ G_2 $ 后：$ |\\psi_2\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle + |110\\rangle) $。\n  作用 $ Z_j $：\n  - $ j=1 $：$ Z_1 |\\psi_2\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle - |110\\rangle) $。\n    作用 $ G_3 $ (CNOT$_{13}$) 后：$ \\frac{1}{\\sqrt{2}} (|000\\rangle - |111\\rangle) $。\n    $ \\langle \\text{GHZ}_3 | \\phi_j \\rangle = 0 $，所以 $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 0 $。\n  - $ j=2 $：$ Z_2 |\\psi_2\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle - |110\\rangle) $ (与 $ j=1 $ 的情况相同)。\n    经过 $ G_3 $ 后：$ |\\phi_j\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle - |111\\rangle) $，所以 $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 0 $。\n  - $ j=3 $：$ Z_3 |\\psi_2\\rangle = |\\psi_2\\rangle $ (无变化)。\n    经过 $ G_3 $ 后：$ |\\phi_j\\rangle = |\\text{GHZ}_3\\rangle $，所以 $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 1 $。\n  保真度：$ j=1,2 $ 时，$ F = 1 - \\gamma $；$ j=3 $ 时，$ F = 1 $。\n\n- **在 $ G_3 $ (CNOT$_{13}$) 之后：**  \n  经过 $ G_3 $ 后：$ |\\psi_3\\rangle = |\\text{GHZ}_3\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle + |111\\rangle) $。\n  作用 $ Z_j $ (没有剩余的门)：\n  - $ j=1 $：$ Z_1 |\\text{GHZ}_3\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle - |111\\rangle) $。\n    $ \\langle \\text{GHZ}_3 | \\phi_j \\rangle = \\langle \\text{GHZ}_3 | Z_1 | \\text{GHZ}_3 \\rangle = 0 $，所以 $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 0 $。\n  - $ j=2,3 $：类似地，$ Z_j |\\text{GHZ}_3\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle - |111\\rangle) $，所以 $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 0 $。\n  保真度：所有 $j$，$ F = 1 - \\gamma $。\n\n在所有情况下，最小保真度为 $ 1 - \\gamma $，在以下情况时达到：\n- 在 $G_1$ 之后作用于量子比特 1，\n- 在 $G_2$ 之后作用于量子比特 1 或 2，\n- 在 $G_3$ 之后作用于任意量子比特。\n因此，$ F_{\\text{worst}} = 1 - \\gamma $。", "answer": "$$ \\boxed{1 - \\gamma} $$", "id": "44176"}, {"introduction": "在了解了单个线路的行为之后，我们现在转向为对抗错误而设计的更复杂的协议。这个问题探讨了在5量子比特纠错码中一个更微妙的对抗性场景[@problem_id:44216]。在这里，问题不仅仅是错误本身，我们还将探索当纠错机制错误地解读一个相干错误并应用错误的“修正”时，会带来怎样的灾难性后果。这突显了诊断和纠正那些不符合我们简单假设的错误的挑战性。", "problem": "5量子比特量子纠错码是能够保护单个逻辑量子比特免受任意单量子比特错误影响的最小编码。它是一种稳定子码，由一组作用于五个物理量子比特的四个对易稳定子生成元定义：\n$g_1 = X \\otimes Z \\otimes Z \\otimes X \\otimes I$\n$g_2 = I \\otimes X \\otimes Z \\otimes Z \\otimes X$\n$g_3 = X \\otimes I \\otimes X \\otimes Z \\otimes Z$\n$g_4 = Z \\otimes X \\otimes I \\otimes X \\otimes Z$\n\n编码空间是该5量子比特系统的完整希尔伯特空间中的一个二维子空间，其中所有状态 $|\\bar{\\psi}\\rangle$ 都是所有四个稳定子生成元的共同本征值为+1的本征态，即对于 $i=1, 2, 3, 4$，有 $g_i |\\bar{\\psi}\\rangle = |\\bar{\\psi}\\rangle$。\n\n考虑一个在编码空间内制备于任意状态 $|\\bar{\\psi}\\rangle$ 的逻辑量子比特。该量子比特在第一个物理量子比特（标记为索引1）上受到一个相干错误，该错误由幺正算符 $U_E(\\epsilon) = \\exp(i\\epsilon Y_1)$ 描述，其中 $Y_1$ 是作用于第一个量子比特的泡利Y算符，$\\epsilon$ 是一个实数参数。\n\n在此错误之后，尝试进行一次恢复操作。然而，由于控制逻辑中的一个故障，所施加的操作是 $C = X_1$，即作用于第一个量子比特的泡利X算符。这对于一个 $Y_1$ 错误来说，并非正确的恢复操作。\n\n系统的最终状态为 $|\\bar{\\psi}_{final}\\rangle = C U_E(\\epsilon) |\\bar{\\psi}\\rangle$。\n\n计算逻辑保真度 $F$，其定义为最终状态与初始状态的交叠的平方：\n$$F = \\left| \\langle\\bar{\\psi}|\\bar{\\psi}_{final}\\rangle \\right|^2$$\n你的任务是找到 $F$ 关于参数 $\\epsilon$ 的最终表达式。逻辑保真度的一个已知属性是，其结果应与编码空间中的具体初始状态 $|\\bar{\\psi}\\rangle$ 无关。", "solution": "1. 量子比特1上的错误幺正算符是 \n$$U_E(\\epsilon)=\\exp\\bigl(i\\epsilon Y_1\\bigr)=\\cos\\epsilon\\,I_1+i\\sin\\epsilon\\,Y_1\\,. $$\n2. 错误的恢复操作是 $C=X_1$，所以最终状态是\n$$|\\bar\\psi_{\\rm final}\\rangle\n=X_1\\,U_E(\\epsilon)\\,|\\bar\\psi\\rangle\n=X_1\\bigl(\\cos\\epsilon\\,I_1+i\\sin\\epsilon\\,Y_1\\bigr)|\\bar\\psi\\rangle\n=\\cos\\epsilon\\,X_1|\\bar\\psi\\rangle\n+i\\sin\\epsilon\\,X_1Y_1|\\bar\\psi\\rangle\\,. $$\n3. 使用泡利乘法 $X_1Y_1=iZ_1$，上式变为\n$$|\\bar\\psi_{\\rm final}\\rangle\n=\\cos\\epsilon\\,X_1|\\bar\\psi\\rangle\n+i\\sin\\epsilon\\,(iZ_1)|\\bar\\psi\\rangle\n=\\cos\\epsilon\\,X_1|\\bar\\psi\\rangle\n-\\sin\\epsilon\\,Z_1|\\bar\\psi\\rangle\\,. $$\n4. 逻辑保真度是\n$$F\n=\\bigl|\\langle\\bar\\psi|\\bar\\psi_{\\rm final}\\rangle\\bigr|^2\n=\\bigl|\\cos\\epsilon\\,\\langle\\bar\\psi|X_1|\\bar\\psi\\rangle\n-\\sin\\epsilon\\,\\langle\\bar\\psi|Z_1|\\bar\\psi\\rangle\\bigr|^2\\,. $$\n5. 在任何稳定子码中，单个量子比特泡利算符（$X_1$ 或 $Z_1$）会将编码空间映射到一个正交子空间，所以\n$$\\langle\\bar\\psi|X_1|\\bar\\psi\\rangle\n=\\langle\\bar\\psi|Z_1|\\bar\\psi\\rangle=0\\,. $$\n因此\n$$F=0\\,. $$", "answer": "$$\\boxed{0}$$", "id": "44216"}, {"introduction": "最后，我们将对抗性模型应用于一个前沿的量子算法——变分量子本征求解器（VQE）。这个练习将我们的焦点从保持量子态的保真度转移到理解对抗者如何破坏算法的最终输出，即能量估计[@problem_id:44218]。通过确定最优的攻击策略，我们将深入了解VQE算法的鲁棒性以及相干错误对算法性能影响的本质。", "problem": "一个单量子比特系统由哈密顿量 $H = \\cos(\\alpha) Z + \\sin(\\alpha) X$ 描述，其中 $X$ 和 $Z$ 是泡利矩阵，$\\alpha$ 是一个实数参数。为了求解该系统的基态能量，我们采用了一种变分量子本征求解器 (Variational Quantum Eigensolver, VQE)。VQE 使用一个参数化的试探态 $|\\psi(\\theta)\\rangle = U(\\theta)|0\\rangle$，其中 $|0\\rangle$ 是计算基矢态，酉拟设是绕 y 轴的旋转，$U(\\theta) = R_y(\\theta) = \\exp(-i\\frac{\\theta}{2} Y)$。这里，$Y$ 是泡利-Y 矩阵，$\\theta$ 是变分参数。\n\n假设 VQE 优化在一个无噪声的环境中成功执行，得到了使能量期望值 $E(\\theta) = \\langle\\psi(\\theta)|H|\\psi(\\theta)\\rangle$ 最小化的最优参数 $\\theta^*$。因此，所得的状态是哈密顿量的真实基态，$|\\psi_{opt}\\rangle = |\\psi(\\theta^*)\\rangle$。\n\n现在，考虑一个对抗场景，其中一个恶意代理在计算中引入了相干误差。该误差被建模为在态制备之后立即施加一个额外的量子门 $U_{err}$。系统的状态变为 $|\\tilde{\\psi}\\rangle = U_{err}|\\psi_{opt}\\rangle$。误差门是一个绕任意轴 $\\vec{n}$（$\\mathbb{R}^3$ 中的单位向量）旋转角度 $\\epsilon$ 的旋转，由 $U_{err} = R_{\\vec{n}}(\\epsilon) = \\exp(-i\\frac{\\epsilon}{2} \\vec{n}\\cdot\\vec{\\sigma})$ 给出，其中 $\\vec{\\sigma} = (X, Y, Z)$ 是泡利矩阵的向量。\n\n对抗者的目标是最大化最终态的能量。他们可以自由选择旋转轴 $\\vec{n}$。你的任务是确定最坏情况下的能量误差 $\\Delta E$，其定义为对抗者可实现的最大可能能量期望值与真实基态能量 $E_g$ 之差。\n\n找出这个最坏情况下的能量误差 $\\Delta E = \\left(\\max_{\\vec{n}} \\langle\\tilde{\\psi}|H|\\tilde{\\psi}\\rangle\\right) - E_g$ 的表达式，作为误差角 $\\epsilon$ 的函数。", "solution": "哈密顿量为 $H = \\cos(\\alpha) Z + \\sin(\\alpha) X$。其本征值可以通过特征方程求得：\n$$\n\\det(H - \\lambda I) = \\lambda^2 - (\\cos^2 \\alpha + \\sin^2 \\alpha) = \\lambda^2 - 1 = 0,\n$$\n所以本征值为 $\\pm 1$。基态能量为 $E_g = -1$。\n\n基态 $|\\psi_{\\text{opt}}\\rangle$ 的布洛赫向量 $\\vec{v}$ 与哈密顿量向量 $\\vec{h} = (\\sin \\alpha, 0, \\cos \\alpha)$ 反平行，因此 $\\vec{v} = -\\vec{h} = (-\\sin \\alpha, 0, -\\cos \\alpha)$。向量 $\\vec{h}$ 的模 $|\\vec{h}| = \\sqrt{\\sin^2 \\alpha + \\cos^2 \\alpha} = 1$，所以 $\\vec{v} \\cdot \\vec{h} = -1$。\n\n误差门 $U_{\\text{err}} = R_{\\vec{n}}(\\epsilon)$ 将 $|\\psi_{\\text{opt}}\\rangle$ 的布洛赫向量绕轴 $\\vec{n}$ 旋转角度 $\\epsilon$。旋转后的能量期望值为：\n$$\n\\langle \\tilde{\\psi} | H | \\tilde{\\psi} \\rangle = \\vec{h} \\cdot \\vec{v}',\n$$\n其中 $\\vec{v}' = R_{\\vec{n}}(\\epsilon) \\vec{v}$。\n\n代入 $\\vec{v} = -\\vec{h}$：\n$$\n\\vec{v}' = R_{\\vec{n}}(\\epsilon) (-\\vec{h}).\n$$\n点积变为：\n$$\n\\vec{h} \\cdot \\vec{v}' = \\vec{h} \\cdot [R_{\\vec{n}}(\\epsilon) (-\\vec{h})] = -\\vec{h} \\cdot [R_{\\vec{n}}(\\epsilon) \\vec{h}].\n$$\n使用向量 $\\vec{u}$ 绕 $\\vec{n}$ 旋转的公式：\n$$\nR_{\\vec{n}}(\\epsilon) \\vec{u} = \\cos \\epsilon \\, \\vec{u} + (1 - \\cos \\epsilon) (\\vec{n} \\cdot \\vec{u}) \\vec{n} + \\sin \\epsilon \\, (\\vec{n} \\times \\vec{u}).\n$$\n因此：\n$$\n\\vec{h} \\cdot [R_{\\vec{n}}(\\epsilon) \\vec{h}] = \\vec{h} \\cdot \\left[ \\cos \\epsilon \\, \\vec{h} + (1 - \\cos \\epsilon) (\\vec{n} \\cdot \\vec{h}) \\vec{n} + \\sin \\epsilon \\, (\\vec{n} \\times \\vec{h}) \\right].\n$$\n展开点积：\n$$\n= \\cos \\epsilon \\, (\\vec{h} \\cdot \\vec{h}) + (1 - \\cos \\epsilon) (\\vec{n} \\cdot \\vec{h}) (\\vec{h} \\cdot \\vec{n}) + \\sin \\epsilon \\, \\vec{h} \\cdot (\\vec{n} \\times \\vec{h}).\n$$\n由于 $\\vec{h} \\cdot \\vec{h} = 1$，$\\vec{h} \\cdot (\\vec{n} \\times \\vec{h}) = \\vec{n} \\cdot (\\vec{h} \\times \\vec{h}) = 0$，以及 $(\\vec{h} \\cdot \\vec{n})^2 = (\\vec{n} \\cdot \\vec{h})^2$：\n$$\n= \\cos \\epsilon + (1 - \\cos \\epsilon) (\\vec{n} \\cdot \\vec{h})^2.\n$$\n因此：\n$$\n\\vec{h} \\cdot \\vec{v}' = - \\left[ \\cos \\epsilon + (1 - \\cos \\epsilon) (\\vec{n} \\cdot \\vec{h})^2 \\right].\n$$\n能量期望值为：\n$$\n\\langle \\tilde{\\psi} | H | \\tilde{\\psi} \\rangle = -\\cos \\epsilon - (1 - \\cos \\epsilon) (\\vec{n} \\cdot \\vec{h})^2.\n$$\n对 $\\vec{n}$ 进行最大化需要最小化 $(\\vec{n} \\cdot \\vec{h})^2$，因为 $1 - \\cos \\epsilon \\geq 0$。其最小值为 $0$，在 $\\vec{n}$ 与 $\\vec{h}$ 垂直时取得。因此：\n$$\n\\max_{\\vec{n}} \\langle \\tilde{\\psi} | H | \\tilde{\\psi} \\rangle = -\\cos \\epsilon.\n$$\n最坏情况下的能量误差为：\n$$\n\\Delta E = \\left( \\max_{\\vec{n}} \\langle \\tilde{\\psi} | H | \\tilde{\\psi} \\rangle \\right) - E_g = (-\\cos \\epsilon) - (-1) = 1 - \\cos \\epsilon.\n$$", "answer": "$$\\boxed{1 - \\cos \\epsilon}$$", "id": "44218"}]}