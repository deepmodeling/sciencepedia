{"hands_on_practices": [{"introduction": "魔法态蒸馏的核心思想是以量换质，即使用多个有噪声的魔法态来提纯出一个更高保真度的魔法态。著名的15-to-1蒸馏协议是阐释这一原理的经典范例。通过解决这个问题 ([@problem_id:105364])，你将亲手计算该协议如何将输入态的错误概率 $\\epsilon$ 显著地降低，得到的输出态错误概率与 $\\epsilon^3$ 成正比，从而直观地理解蒸馏协议在抑制噪声方面的强大能力。", "problem": "在容错量子计算中，诸如 $T$ 门之类的非 Clifford 门对于实现普适性至关重要。由于这些门极难高保真地实现，因此采用了“魔态蒸馏”协议。这些协议将多个含噪声的“魔态”副本作为输入，并产生一个保真度高得多的单副本。然后，提纯后的魔态可用于通过基于隐形传态的线路来实现所需的非 Clifford 门。\n\n对于 $T$ 门，$T = \\begin{pmatrix} 1 & 0 \\\\ 0 & e^{i\\pi/4} \\end{pmatrix}$，一个关键的魔态是 $|A\\rangle = T|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + e^{i\\pi/4}|1\\rangle)$。\n考虑一个含噪声的魔态供应，其中每个状态由密度矩阵描述\n$$ \\rho_{in} = (1-\\epsilon) |A\\rangle\\langle A| + \\epsilon |A^{\\perp}\\rangle\\langle A^{\\perp}| $$\n此处，$|A^{\\perp}\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - e^{i\\pi/4}|1\\rangle)$ 是与 $|A\\rangle$ 正交的状态，而 $\\epsilon$ 是初始错误概率。这些状态的初始保真度为 $F_{in} = \\langle A|\\rho_{in}|A\\rangle = 1-\\epsilon$。可以证明，此错误模型等效于一个以概率 $\\epsilon$ 对理想状态 $|A\\rangle$ 施加泡利 $Z$ 错误的量子信道。\n\n由 Bravyi 和 Kitaev 首次提出的 15-to-1 魔态蒸馏协议，输入 15 个 $\\rho_{in}$ 的副本，并尝试产生一个更高保真度的状态 $\\rho_{out}$。该协议基于 [[15, 1, 3]] 量子 Reed-Muller 码。其工作原理是将逻辑状态编码到 15 个物理量子比特中，然后测量该码的稳定子生成元。如果测量综合症是平凡的（所有结果均为 $+1$），则接受输出状态。否则，将其丢弃。\n\n为了进行计算，您将需要本协议中使用的 [[15, 1, 3]] 码的以下基本性质，该码是从经典 $[15, 11, 3]$ 汉明码导出的一个 CSS 码：\n1.  该码的码距为 $d=3$。这意味着影响一个或两个量子比特的所有错误模式都会被稳定子测量检测到。\n2.  该错误模型对应于泡利 $Z$ 错误。一个由一组量子比特 $S$ 上的 $Z$ 算符乘积组成的错误算符（记作 $Z_S$），如果它与所有稳定子都对易，则无法被检测到。对于此特定码，当 $S$ 是经典 [15, 11, 3] 汉明码中的一个码字时，会发生这种情况。\n3.  如果发生未被检测到的错误，它会损坏输出状态，导致逻辑错误。此类错误算符的最低权重为 3。在 $[15, 11, 3]$ 汉明码中，权重为 3 的经典码字数量恰好是 35。\n\n假设初始错误概率 $\\epsilon$ 很小，计算 15-to-1 蒸馏协议输出状态 $\\rho_{out}$ 的保真度 $F_{out}$。您的答案应该是一个关于 $\\epsilon$ 的表达式，精确到 $\\epsilon$ 的最低非零阶。", "solution": "输出状态的保真度 $ F_{\\text{out}} $ 是在状态被接受的情况下，输出状态正确的概率。当错误模式对应于经典 [15, 11, 3] 汉明码中的一个码字时，协议接受该状态。该错误模型以概率 $ \\epsilon $ 独立地对每个量子比特施加一个泡利 $ Z $ 错误。\n\n错误模式为零码字（无错误）的概率是：\n\n$$\n\\Pr(\\text{no error}) = (1 - \\epsilon)^{15}\n$$\n\n\n错误模式是权重为 $ w $ 的某个特定非零码字的概率是：\n\n$$\n\\Pr(\\text{specific codeword of weight } w) = \\epsilon^w (1 - \\epsilon)^{15 - w}\n$$\n\n\n总接受概率是所有码字的和：\n\n$$\nP_{\\text{accept}} = \\sum_{c \\in \\mathcal{C}} \\epsilon^{w(c)} (1 - \\epsilon)^{15 - w(c)}\n$$\n\n其中 $ \\mathcal{C} $ 是汉明码所有 2048 个码字的集合。\n\n输出状态仅在零码字的情况下是正确的。因此，保真度为：\n\n$$\nF_{\\text{out}} = \\frac{\\Pr(\\text{no error})}{P_{\\text{accept}}} = \\frac{(1 - \\epsilon)^{15}}{\\sum_{c \\in \\mathcal{C}} \\epsilon^{w(c)} (1 - \\epsilon)^{15 - w(c)}}\n$$\n\n\n对于小 $ \\epsilon $，展开到最低非零阶。分子是：\n\n$$\n(1 - \\epsilon)^{15} = 1 - 15\\epsilon + 105\\epsilon^2 - 455\\epsilon^3 + O(\\epsilon^4)\n$$\n\n\n分母包括：\n- 零码字：$ (1 - \\epsilon)^{15} $\n- 35 个权重为 3 的码字：$ 35 \\epsilon^3 (1 - \\epsilon)^{12} $\n- 更高权重的码字，其贡献为 $ O(\\epsilon^4) $\n\n因此：\n\n$$\nP_{\\text{accept}} = (1 - \\epsilon)^{15} + 35 \\epsilon^3 (1 - \\epsilon)^{12} + O(\\epsilon^4)\n$$\n\n\n展开 $ (1 - \\epsilon)^{12} $：\n\n$$\n(1 - \\epsilon)^{12} = 1 - 12\\epsilon + 66\\epsilon^2 - 220\\epsilon^3 + O(\\epsilon^4)\n$$\n\n\n所以：\n\n$$\n35 \\epsilon^3 (1 - \\epsilon)^{12} = 35 \\epsilon^3 (1 - 12\\epsilon + 66\\epsilon^2 - 220\\epsilon^3) + O(\\epsilon^4) = 35\\epsilon^3 - 420\\epsilon^4 + O(\\epsilon^4)\n$$\n\n由于 $ \\epsilon^4 $ 项被吸收到 $ O(\\epsilon^4) $ 中，对于 $ \\epsilon^3 $ 阶，我们只保留 $ 35\\epsilon^3 $。\n\n然后：\n\n$$\nP_{\\text{accept}} = [1 - 15\\epsilon + 105\\epsilon^2 - 455\\epsilon^3] + 35\\epsilon^3 + O(\\epsilon^4) = 1 - 15\\epsilon + 105\\epsilon^2 - 420\\epsilon^3 + O(\\epsilon^4)\n$$\n\n\n保真度比率为：\n\n$$\nF_{\\text{out}} = \\frac{1 - 15\\epsilon + 105\\epsilon^2 - 455\\epsilon^3 + O(\\epsilon^4)}{1 - 15\\epsilon + 105\\epsilon^2 - 420\\epsilon^3 + O(\\epsilon^4)}\n$$\n\n\n设 $ y = 15\\epsilon - 105\\epsilon^2 + 420\\epsilon^3 + O(\\epsilon^4) $，所以分母是 $ 1 - y $。然后：\n\n$$\n(1 - y)^{-1} = 1 + y + y^2 + y^3 + O(\\epsilon^4)\n$$\n\n\n计算：\n\n$$\ny = 15\\epsilon - 105\\epsilon^2 + 420\\epsilon^3 + O(\\epsilon^4)\n$$\n\n\n$$\ny^2 = (15\\epsilon)^2 + 2(15\\epsilon)(-105\\epsilon^2) + O(\\epsilon^4) = 225\\epsilon^2 - 3150\\epsilon^3 + O(\\epsilon^4)\n$$\n\n\n$$\ny^3 = (15\\epsilon)^3 + O(\\epsilon^4) = 3375\\epsilon^3 + O(\\epsilon^4)\n$$\n\n\n所以：\n\n$$\n(1 - y)^{-1} = 1 + (15\\epsilon - 105\\epsilon^2 + 420\\epsilon^3) + (225\\epsilon^2 - 3150\\epsilon^3) + 3375\\epsilon^3 + O(\\epsilon^4) = 1 + 15\\epsilon + 120\\epsilon^2 + 645\\epsilon^3 + O(\\epsilon^4)\n$$\n\n\n现在乘以分子：\n\n$$\nF_{\\text{out}} = (1 - 15\\epsilon + 105\\epsilon^2 - 455\\epsilon^3)(1 + 15\\epsilon + 120\\epsilon^2 + 645\\epsilon^3) + O(\\epsilon^4)\n$$\n\n\n执行乘法：\n- $ 1 \\cdot 1 = 1 $\n- $ 1 \\cdot 15\\epsilon = 15\\epsilon $\n- $ 1 \\cdot 120\\epsilon^2 = 120\\epsilon^2 $\n- $ 1 \\cdot 645\\epsilon^3 = 645\\epsilon^3 $\n- $ -15\\epsilon \\cdot 1 = -15\\epsilon $\n- $ -15\\epsilon \\cdot 15\\epsilon = -225\\epsilon^2 $\n- $ -15\\epsilon \\cdot 120\\epsilon^2 = -1800\\epsilon^3 $\n- $ 105\\epsilon^2 \\cdot 1 = 105\\epsilon^2 $\n- $ 105\\epsilon^2 \\cdot 15\\epsilon = 1575\\epsilon^3 $\n- $ -455\\epsilon^3 \\cdot 1 = -455\\epsilon^3 $\n\n对系数求和：\n- 常数项: 1\n- $ \\epsilon $: $ 15 - 15 = 0 $\n- $ \\epsilon^2 $: $ 120 - 225 + 105 = 0 $\n- $ \\epsilon^3 $: $ 645 - 1800 + 1575 - 455 = -35 $\n\n因此：\n\n$$\nF_{\\text{out}} = 1 - 35\\epsilon^3 + O(\\epsilon^4)\n$$\n\n\n最低非零阶修正是 $ -35\\epsilon^3 $，所以此阶的保真度是 $ 1 - 35\\epsilon^3 $。", "answer": "$$ \\boxed{1 - 35\\epsilon^{3}} $$", "id": "105364"}, {"introduction": "量子纠错码并非万无一失，其纠错能力受其“距离”的限制。这个练习 ([@problem_id:83563]) 探究了一个基于`[[8, 1, 3]]`码的`|H\\rangle`态蒸馏协议，其距离为3，意味着它可以纠正任意单个量子比特的错误。然而，当出现两个量子比特的错误时，该协议会如何反应？此问题将引导你分析这种双比特错误如何被“错误地纠正”，最终导致一个逻辑错误，从而揭示容错计算中一个关键的失效模式。", "problem": "魔术态蒸馏是许多容错量子计算方案中的一个关键子程序。该过程消耗多个带噪的魔术态，以产生一个保真度更高的单一魔术态。在本问题中，我们将分析一个特定的魔术态蒸馏协议的性能。\n\n所讨论的魔术态是 $|H\\rangle$ 态，定义为 $|H\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$，它是 Pauli-X 算符的 $+1$ 本征态。该协议从八个带噪的输入态开始，其中每个状态 $\\rho_{in}$ 是一个 Z-错误信道作用于一个理想 $|H\\rangle$ 态的结果。每个输入态的密度矩阵由下式给出：\n$$ \\rho_{in} = (1-\\epsilon)|H\\rangle\\langle H| + \\epsilon|-\\rangle\\langle -| $$\n其中 $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$，$\\epsilon$ 是初始非保真度。给定量子比特上的一个错误对应于一个 Pauli $Z$ 算符，它将态从 $|H\\rangle$ 翻转到 $|-\\rangle$。\n\n该蒸馏协议基于一个特定的 $[[8, 1, 3]]$ 量子纠错码。一个码距 $d=3$ 的码可以纠正任意单量子比特错误。该协议按如下步骤进行：\n1.  制备八个物理量子比特，每个都处于相同的带噪状态 $\\rho_{in}$。这个初始的 8-量子比特态代表了逻辑 $|\\bar{H}\\rangle$ 态的一个带噪版本。\n2.  测量 $[[8, 1, 3]]$ 码的七个稳定子生成元。\n3.  基于测量结果（错误诊断子），应用一个标准的纠错流程。\n\n这个特定码及其译码流程的性质如下：\n*   任何单量子比特 $Z$ 错误都会被完美纠正，这意味着最终态没有逻辑错误。\n*   任何双量子比特 $Z$ 错误（即，形式为 $Z_i Z_j$ 且 $i \\neq j$ 的错误）会被错误地纠正，从而在编码后的量子比特上变成一个逻辑 $Z_L$ 错误。\n*   权重为三或更高的错误可能被纠正也可能不被纠正，但对于本问题，它们对最终非保真度的贡献可以忽略。\n\n你的任务是计算最终的单量子比特逻辑态的非保真度 $\\epsilon_{out}$。输出非保真度被定义为最终态是逻辑 $|\\bar{-}\\rangle$ 态的概率。请给出 $\\epsilon_{out}$ 关于 $\\epsilon$ 的领头非零阶表达式。", "solution": "输出非保真度 $\\epsilon_{out}$ 被定义为最终态是逻辑 $|\\bar{-}\\rangle$ 态的概率。这种情况在纠错后存在一个逻辑 $Z_L$ 错误时发生。\n\n每个输入态都经历一个 Z-错误信道，并且不同量子比特上的错误是相互独立的。任何单个量子比特上发生 Z 错误的概率是 $\\epsilon$，没有发生错误的概率是 $1 - \\epsilon$。\n\n根据 $[[8, 1, 3]]$ 码的性质：\n- 任何单量子比特 Z 错误都会被完美纠正，结果是没有逻辑错误。\n- 任何双量子比特 Z 错误（即 $Z_i Z_j$ 且 $i \\neq j$）会被错误地纠正为一个逻辑 $Z_L$ 错误。\n- 根据题目陈述，对于 $\\epsilon$ 的领头阶，权重为三或更高的错误可以被忽略。\n\n在领头非零阶上，导致逻辑 $Z_L$ 错误的事件是八个量子比特上恰好发生两个 Z 错误。恰好发生两个错误的概率由二项分布给出：\n\n$$ P(\\text{exactly two errors}) = \\binom{8}{2} \\epsilon^2 (1 - \\epsilon)^{6} $$\n\n展开 $(1 - \\epsilon)^6$：\n\n$$ (1 - \\epsilon)^6 = 1 - 6\\epsilon + 15\\epsilon^2 - 20\\epsilon^3 + \\cdots $$\n\n乘以 $\\binom{8}{2} \\epsilon^2$：\n\n$$ P(\\text{exactly two errors}) = \\binom{8}{2} \\epsilon^2 (1 - 6\\epsilon + 15\\epsilon^2 - \\cdots) = \\binom{8}{2} \\epsilon^2 - 6\\binom{8}{2} \\epsilon^3 + \\cdots $$\n\n领头非零项是 $\\binom{8}{2} \\epsilon^2$。计算二项式系数：\n\n$$ \\binom{8}{2} = \\frac{8!}{2! \\, 6!} = \\frac{8 \\times 7}{2 \\times 1} = 28 $$\n\n因此：\n\n$$ \\epsilon_{out} = 28 \\epsilon^2 + \\mathcal{O}(\\epsilon^3) $$\n\n因此，对 $\\epsilon$ 取领头非零阶，输出非保真度为 $28 \\epsilon^2$。", "answer": "$$ \\boxed{28 \\epsilon^{2}} $$", "id": "83563"}, {"introduction": "一个完整的容错操作流程包括错误探测、综合征解码和恢复操作，而故障可能发生在其中任何一个环节。这个实践 ([@problem_id:98634]) 模拟了一个更为现实的故障场景：系统成功地探测到了一个物理错误，但在执行恢复操作时却应用了错误的指令。你需要分析初始错误和错误恢复操作共同构成的“残余错误”是什么，并计算它如何最终影响编码的逻辑量子比特的保真度，这有助于你更深入地理解整个容错流程的脆弱性。", "problem": "一个容错量子计算方案使用五量子比特`[[5,1,3]]`纠错码来制备高保真度的T态。该五量子比特码由以下稳定子生成元定义：\n$$ g_1 = X \\otimes Z \\otimes Z \\otimes X \\otimes I $$\n$$ g_2 = I \\otimes X \\otimes Z \\otimes Z \\otimes X $$\n$$ g_3 = X \\otimes I \\otimes X \\otimes Z \\otimes Z $$\n$$ g_4 = Z \\otimes X \\otimes I \\otimes X \\otimes Z $$\n相应的逻辑泡利算符为：\n$$ \\bar{X} = X \\otimes X \\otimes X \\otimes X \\otimes X $$\n$$ \\bar{Z} = Z \\otimes Z \\otimes Z \\otimes Z \\otimes Z $$\n$$ \\bar{Y} = i\\bar{X}\\bar{Z} $$\n\n该协议旨在生成一个逻辑T态，记作$|T\\rangle_L$，在逻辑基$\\{|0\\rangle_L, |1\\rangle_L\\}$中，它对应于理想的单量子比特T态$|T\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + e^{i\\pi/4}|1\\rangle)$。\n\n假设在协议的一次运行期间，第一个物理量子比特上发生了一个单量子比特泡利Z错误，该错误由算符 $E = Z \\otimes I \\otimes I \\otimes I \\otimes I$ 描述。通过测量稳定子生成元检测到该错误。然而，由于硬件故障，施加了一个不正确的恢复操作。没有进行正确的纠正，而是对第一个物理量子比特施加了一个泡利X算符 $C = X \\otimes I \\otimes I \\otimes I \\otimes I$。\n\n假设协议如同纠正成功一样继续进行，也就是说，该状态随后由后续的逻辑操作处理。初始错误和错误纠正的净效应是一个作用在编码逻辑态 $|T\\rangle_L$ 上的残余错误算符 $E_{res} = C \\cdot E$。一个物理错误算符在编码空间上的作用等效于一个相应的逻辑泡利算符的作用。这个逻辑算符由物理错误算符与逻辑算符 $\\bar{X}$ 和 $\\bar{Z}$ 的对易关系确定。\n\n计算理想逻辑T态 $|T\\rangle_L$ 与逻辑量子比特的最终态 $|\\psi_{out}\\rangle_L$ 之间的保真度 $F = |\\langle T|_L |\\psi_{out}\\rangle_L|^2$。", "solution": "残余错误算符为 $E_{\\text{res}} = C \\cdot E = (X \\otimes I \\otimes I \\otimes I \\otimes I) \\cdot (Z \\otimes I \\otimes I \\otimes I \\otimes I) = (XZ) \\otimes I \\otimes I \\otimes I \\otimes I$。由于 $XZ = -iY$，并且一个全局相位不影响逻辑算符的映射，我们可以将残余物理错误视为第一个量子比特上的泡利 $Y$ 算符。\n\n我们需要确定物理算符 $Y_1 = Y \\otimes I \\otimes I \\otimes I \\otimes I$ 对应的逻辑算符。这可以通过检查它与逻辑算符 $\\bar{X}$ 和 $\\bar{Z}$ 的对易关系来确定。\n- 与 $\\bar{X}$ 的对易关系：$Y_1 \\bar{X} = (Y_1 X_1) \\otimes X_2 X_3 X_4 X_5 = (-X_1 Y_1) \\otimes X_2 X_3 X_4 X_5 = -\\bar{X} Y_1$。它们反对易。\n- 与 $\\bar{Z}$ 的对易关系：$Y_1 \\bar{Z} = (Y_1 Z_1) \\otimes Z_2 Z_3 Z_4 Z_5 = (-Z_1 Y_1) \\otimes Z_2 Z_3 Z_4 Z_5 = -\\bar{Z} Y_1$。它们反对易。\n\n一个与 $\\bar{X}$ 和 $\\bar{Z}$ 都反对易的逻辑算符是 $\\bar{Y}$。因此，$E_{\\text{res}}$ 在逻辑态上的作用等效于 $\\bar{Y}$（忽略一个不影响保真度的全局相位）。\n\n理想的逻辑T态为 $|T\\rangle_L = \\frac{1}{\\sqrt{2}} (|0\\rangle_L + e^{i\\pi/4} |1\\rangle_L)$。经过错误和错误纠正后的状态为 $|\\psi_{out}\\rangle_L = \\bar{Y} |T\\rangle_L$。应用 $\\bar{Y}$：\n\n$$\n\\bar{Y} |0\\rangle_L = i |1\\rangle_L, \\quad \\bar{Y} |1\\rangle_L = -i |0\\rangle_L.\n$$\n\n\n$$\n|\\psi_{out}\\rangle_L = \\bar{Y} |T\\rangle_L = \\frac{1}{\\sqrt{2}} \\left( \\bar{Y} |0\\rangle_L + e^{i\\pi/4} \\bar{Y} |1\\rangle_L \\right) = \\frac{1}{\\sqrt{2}} \\left( i |1\\rangle_L - i e^{i\\pi/4} |0\\rangle_L \\right) = \\frac{i}{\\sqrt{2}} \\left( - e^{i\\pi/4} |0\\rangle_L + |1\\rangle_L \\right).\n$$\n\n\n保真度为 $F = \\left| \\langle T|_L |\\psi_{out}\\rangle_L \\right|^2$。计算内积：\n\n$$\n\\langle T|_L |\\psi_{out}\\rangle_L = \\left( \\frac{\\langle 0|_L + e^{-i\\pi/4} \\langle 1|_L}{\\sqrt{2}} \\right) \\left( \\frac{i}{\\sqrt{2}} \\left( - e^{i\\pi/4} |0\\rangle_L + |1\\rangle_L \\right) \\right) = \\frac{i}{2} \\left[ -e^{i\\pi/4} \\langle 0|_L |0\\rangle_L + \\langle 0|_L |1\\rangle_L - e^{-i\\pi/4} e^{i\\pi/4} \\langle 1|_L |0\\rangle_L + e^{-i\\pi/4} \\langle 1|_L |1\\rangle_L \\right].\n$$\n\n使用正交归一性 $\\langle a|_L |b\\rangle_L = \\delta_{a,b}$：\n\n$$\n\\langle T|_L |\\psi_{out}\\rangle_L = \\frac{i}{2} \\left[ -e^{i\\pi/4} (1) + 0 - 0 + e^{-i\\pi/4} (1) \\right] = \\frac{i}{2} \\left( e^{-i\\pi/4} - e^{i\\pi/4} \\right).\n$$\n\n化简表达式：\n\n$$\ne^{-i\\pi/4} - e^{i\\pi/4} = -2i \\sin(\\pi/4), \\quad \\sin(\\pi/4) = \\frac{\\sqrt{2}}{2}.\n$$\n\n\n$$\n\\langle T|_L |\\psi_{out}\\rangle_L = \\frac{i}{2} \\left( -2i \\cdot \\frac{\\sqrt{2}}{2} \\right) = \\frac{i}{2} \\left( -i \\sqrt{2} \\right) = \\frac{i \\cdot (-i) \\sqrt{2}}{2} = \\frac{-i^2 \\sqrt{2}}{2} = \\frac{-(-1) \\sqrt{2}}{2} = \\frac{\\sqrt{2}}{2}.\n$$\n\n模方为：\n\n$$\nF = \\left| \\frac{\\sqrt{2}}{2} \\right|^2 = \\left( \\frac{\\sqrt{2}}{2} \\right)^2 = \\frac{2}{4} = \\frac{1}{2}.\n$$", "answer": "$$ \\boxed{\\frac{1}{2}} $$", "id": "98634"}]}