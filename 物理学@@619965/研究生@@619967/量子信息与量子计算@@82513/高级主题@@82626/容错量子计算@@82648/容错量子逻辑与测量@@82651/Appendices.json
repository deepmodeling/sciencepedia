{"hands_on_practices": [{"introduction": "量子纠错码的性能不仅取决于其自身的结构，也同样依赖于解码器的效率。这个练习将引导你探索一个场景，其中环面码上的一个简单的关联物理错误可以误导一个标准的最小权重完美匹配（MWPM）解码器 [@problem_id:84627]。通过计算纠错码点、解码器的修正操作以及最终的状态，你将亲眼见证解码器的“最短路径”假设如何导致一个全局的逻辑错误，从而深刻理解物理错误模式与解码策略之间的关键关系。", "problem": "一个二维环面码构建在一个具有周期性边界条件（即一个环面）的 $L \\times L$ 方格晶格上。量子比特位于该晶格的边上。该编码由一组稳定子算符定义。对于每个顶点 $v$，有一个星算符 $A_v = \\bigotimes_{j \\in \\text{star}(v)} X_j$；对于每个小方格 $p$，有一个小方格算符 $B_p = \\bigotimes_{j \\in \\text{edge}(p)} Z_j$。此处，$\\text{star}(v)$ 是与顶点 $v$ 相邻的边的集合，而 $\\text{edge}(p)$ 是围成小方格 $p$ 的边的集合。编码空间中的一个状态 $|\\psi_L\\rangle$ 满足：对于所有的 $v$，$A_v |\\psi_L\\rangle = |\\psi_L\\rangle$；对于所有的 $p$，$B_p |\\psi_L\\rangle = |\\psi_L\\rangle$。\n\n考虑一个码距为 $d$ 的环面码，其中 $d=L=3$。晶格的顶点可以用整数坐标 $(x,y)$ 标记，其中 $x,y \\in \\{0, 1, 2\\}$，并且所有坐标上的算术运算都在模 $L=3$ 下进行。一条水平边连接顶点 $(x,y)$ 和 $(x+1,y)$，我们将其上的量子比特记为 $h_{x,y}$。一条垂直边连接 $(x,y)$ 和 $(x,y+1)$，我们将其上的量子比特记为 $v_{x,y}$。\n\n假设系统受到一个由算符 $E = Z(h_{0,1}) Z(h_{1,1})$ 描述的关联 Pauli-$Z$ 错误事件，其中 $Z(q)$ 是作用于量子比特 $q$ 的 Pauli-$Z$ 算符。这个错误会违背某些星稳定子，从而产生一个症候。随后应用一个纠错程序，该程序包括两个步骤：\n1.  识别出被违背的星稳定子的位置（即症候）。\n2.  应用一个纠错算符 $C$。该算符是一系列 Pauli-$Z$ 算符的乘积，这些算符构成一条连接症候位置的链。选择这条链时，要使其包含的算符数量最少（即最短路径）。这对于单个缺陷对来说，就是最小权重完美匹配（MWPM）解码器的原理。如果存在多条这样的最短路径，解码器会等概率随机地选择其中一条。\n\n如果组合算符 $C \\cdot E$ 等价于编码的一个非平凡逻辑算符，则发生逻辑错误。对于 $Z$ 型错误，我们关心的是逻辑 $Z$ 算符 $Z_L$，它是一系列作用在一条量子比特链上的 $Z$ 算符的乘积，这条链构成一个环绕环面的同调非平凡的圈。\n\n给定 $L=3$ 环面码上的特定关联错误 $E = Z(h_{0,1}) Z(h_{1,1})$，在应用 MWPM 纠错程序后，残留一个逻辑错误的概率是多少？", "solution": "1. 错误算符为\n$$\nE = Z(h_{0,1})\\,Z(h_{1,1}).\n$$\n水平边上的每个 $Z$ 算符会翻转与其相邻的两个星算符的本征值。顶点 $(1,1)$ 处的星算符受到两个 $Z$ 算符的作用，其本征值回到 $+1$，而顶点 $(0,1)$ 和 $(2,1)$ 处的星算符各受到一个 $Z$ 算符的作用，因而被违背。因此，症候缺陷位于\n$$\nv_1 = (0,1),\\quad v_2 = (2,1).\n$$\n\n2.  MWPM 解码器通过由 $Z$ 算符构成的最短路径来连接 $v_1$ 和 $v_2$。在一个 $3\\times3$ 的环面上，距离\n$$\nd\\bigl((0,1),(2,1)\\bigr)=1\n$$\n是通过单个水平边 $h_{2,1}$ 计算的。这条路径是唯一的，所以\n$$\nC = Z(h_{2,1}).\n$$\n\n3.  组合算符为\n$$\nC\\,E \n= Z(h_{2,1})\\,Z(h_{0,1})\\,Z(h_{1,1})\n$$\n它正好是作用在 $y=1$ 处所有三条水平边上的 $Z$ 算符的乘积。这是一个环绕环面的同调非平凡圈，也即逻辑算符 $Z_L$。因此，每一次这种错误加上纠错的实现，都会产生一个逻辑 $Z$ 算符。\n\n4.  因此，残留逻辑错误的概率是\n$$\n1.\n$$", "answer": "$$\\boxed{1}$$", "id": "84627"}, {"introduction": "真正的容错不仅要求能纠正数据量子比特上的错误，还要求对纠错电路本身的故障具有鲁棒性。这个练习将检验在为Shor码提取纠错码点时，单个有故障的CNOT门所带来的后果 [@problem_id:84591]。你将追踪这个组件故障如何导致错误的码点测量，从而引发一个实际上是逻辑错误的“修正”操作，这揭示了容错方案中一个至关重要的失效模式。", "problem": "在Shor $[[9,1,3]]$ 码的标准实现中，通过为三个3量子比特块的每一个测量错误症状来纠正比特翻转错误。对于单个块，稳定子是 $S_1 = Z_1 Z_2$ 和 $S_2 = Z_2 Z_3$。一个测量 $S_1$ 的标准线路使用一个初始化为 $|0\\rangle$ 的辅助量子比特，并按以下门序列操作：对辅助量子比特施加Hadamard门，施加以数据量子比特1为控制、辅助量子比特为目标的CNOT门，施加以数据量子比特2为控制、辅助量子比特为目标的CNOT门，最后在测量辅助量子比特之前再对其施加一个Hadamard门。\n\n考虑在测量第一个量子比特块（量子比特1、2、3）的 $S_1$ 稳定子期间，作用在第一个数据量子比特（控制位）和辅助量子比特（目标位）之间的一个有故障的CNOT门。该故障被建模为在CNOT门作用后，立即对辅助量子比特施加一个额外的泡利Y算符。9量子比特寄存器的初始态是无错误的逻辑零态 $|\\bar{0}\\rangle_L$。\n\n假设第一个块中用于提取 $S_1$ 和 $S_2$ 症状的其余线路，以及对其他块的所有操作，都是完美的。根据为第一个块测得的错误症状 $(s_1, s_2)$，应用标准纠错程序。此后，执行一整轮相位翻转纠错，我们可以假设这一过程是完美的，并且不会检测到由此产生的错误。\n\n所描述的故障和随后的错误纠正导致了与初始态 $|\\bar{0}\\rangle_L$ 不同的最终态 $|\\psi_f\\rangle$。计算保真度 $F = |\\langle\\bar{0}_L|\\psi_f\\rangle|^2$。", "solution": "该问题要求计算在经历一个特定故障和随后的纠错程序后，初始态 $|\\bar{0}\\rangle_L$ 和最终态 $|\\psi_f\\rangle$ 之间的保真度。\n\n**1. 初始态和Shor码结构**\nShor码的逻辑零态由一个3量子比特相位翻转码和一个3量子比特比特翻转码级联而成。\n外码（相位翻转码）将 $|\\bar{0}\\rangle_L$ 编码为 $|+\\rangle_p |+\\rangle_p |+\\rangle_p$，其中 $|+\\rangle_p = \\frac{1}{\\sqrt{2}}(|0\\rangle_L + |1\\rangle_L)$。\n内码（比特翻转码）将 $|0\\rangle_L$ 编码为 $|000\\rangle$，将 $|1\\rangle_L$ 编码为 $|111\\rangle$。与外码的相位基矢态更相关的是，它将 $|+\\rangle$ 编码为 $\\frac{1}{\\sqrt{2}}(|000\\rangle+|111\\rangle) \\equiv |+\\rangle_B$，将 $|-\\rangle$ 编码为 $\\frac{1}{\\sqrt{2}}(|000\\rangle-|111\\rangle) \\equiv |-\\rangle_B$。\n因此，初始的9量子比特态为：\n$$\n|\\bar{0}\\rangle_L = |+\\rangle_{B1} |+\\rangle_{B2} |+\\rangle_{B3} = \\frac{1}{\\sqrt{8}}(|000\\rangle+|111\\rangle)_1(|000\\rangle+|111\\rangle)_2(|000\\rangle+|111\\rangle)_3\n$$\n其中右矢上的下标表示量子比特块。故障发生在第1块中。\n\n**2. 有故障的症状测量分析**\n设初始态为 $|\\psi\\rangle = |\\bar{0}\\rangle_L$。对 $S_1 = Z_1Z_2$ 的测量从辅助量子比特处于 $|0\\rangle_a$ 态开始。\n测量 $S_1$ 时对数据（量子比特1, 2）和辅助量子比特（$a$）施加的操作序列如下：\n1.  准备辅助量子比特：状态为 $|\\psi\\rangle|0\\rangle_a$。\n2.  对辅助量子比特施加Hadamard门：状态变为 $|\\psi\\rangle \\otimes \\frac{1}{\\sqrt{2}}(|0\\rangle_a + |1\\rangle_a) = |\\psi\\rangle|+\\rangle_a$。\n3.  有故障的CNOT(1, a)：该门为 $U_{faulty} = (I_d \\otimes Y_a) \\cdot \\text{CNOT}(1, a)$。我们来分析它的作用。\n    一个CNOT(c, t)门作用于 $|c\\rangle_c |t\\rangle_t$ 会得到 $|c\\rangle_c |t \\oplus c\\rangle_t$。\n    因此，CNOT(1, a)作用于 $|c\\rangle_1 |+\\rangle_a = |c\\rangle_1 \\frac{1}{\\sqrt{2}}(|0\\rangle_a+|1\\rangle_a)$ 会得到 $|c\\rangle_1 \\frac{1}{\\sqrt{2}}(|c\\rangle_a+|1\\oplus c\\rangle_a)$。\n    对此施加故障 $Y_a$ 会得到 $|c\\rangle_1 \\frac{1}{\\sqrt{2}}Y_a(|c\\rangle_a+|1\\oplus c\\rangle_a)$。\n    如果 $c=0$：$|0\\rangle_1 \\frac{1}{\\sqrt{2}}Y_a(|0\\rangle_a+|1\\rangle_a) = |0\\rangle_1 \\frac{i}{\\sqrt{2}}(|0\\rangle_a-|1\\rangle_a) = i|0\\rangle_1 |-\\rangle_a$。\n    如果 $c=1$：$|1\\rangle_1 \\frac{1}{\\sqrt{2}}Y_a(|1\\rangle_a+|0\\rangle_a) = |1\\rangle_1 \\frac{i}{\\sqrt{2}}(-|1\\rangle_a-|0\\rangle_a) = -i|1\\rangle_1 |-\\rangle_a$。\n    我们可以将在量子比特1的通用状态上的这个作用表示为：对量子比特1施加算符 $iZ_1$，并将辅助量子比特置于 $|-\\rangle_a$ 态。\n    所以，系统的状态变为 $i(Z_1 \\otimes I_{2..9})|\\psi\\rangle \\otimes |-\\rangle_a$。\n4.  标准CNOT(2, a)：此CNOT门作用于步骤3得到的状态。控制位是量子比特2，目标位是处于 $|-\\rangle_a$ 态的辅助量子比特 $a$。\n    CNOT(2, a)作用于 $|c\\rangle_2 |-\\rangle_a = |c\\rangle_2 \\frac{1}{\\sqrt{2}}(|0\\rangle_a-|1\\rangle_a)$ 会得到 $|c\\rangle_2 \\frac{1}{\\sqrt{2}}(|c\\rangle_a-|1\\oplus c\\rangle_a)$。\n    如果 $c=0$：$|0\\rangle_2 \\frac{1}{\\sqrt{2}}(|0\\rangle_a-|1\\rangle_a) = |0\\rangle_2|-\\rangle_a$。\n    如果 $c=1$：$|1\\rangle_2 \\frac{1}{\\sqrt{2}}(|1\\rangle_a-|0\\rangle_a) = -|1\\rangle_2|-\\rangle_a$。\n    这等效于对数据量子比特2施加 $-Z_2$。所以对数据的总变换是 $-Z_2$。\n    系统的状态变为 $(-Z_2) \\cdot i(Z_1|\\psi\\rangle) \\otimes |-\\rangle_a = -i Z_1 Z_2 |\\psi\\rangle \\otimes |-\\rangle_a$。\n5.  对辅助量子比特施加Hadamard门：$H_a |-\\rangle_a = |1\\rangle_a$。测量前的最终状态是 $-i Z_1 Z_2 |\\psi\\rangle |1\\rangle_a$。\n6.  测量：在计算基下测量辅助量子比特。结果必然是 $s_1=1$。数据态塌缩到 $Z_1 Z_2 |\\psi\\rangle = Z_1 Z_2 |\\bar{0}\\rangle_L$。\n\n由于 $|\\bar{0}\\rangle_L$ 是一个有效的码字，它是所有稳定子的本征态，本征值为+1。$S_1=Z_1Z_2$ 是第1块中比特翻转码的一个稳定子。因此，$Z_1Z_2|\\bar{0}\\rangle_L = |\\bar{0}\\rangle_L$。数据态实际上并未因故障传播而改变，但症状位被错误地测量为 $s_1=1$。\n\n对 $S_2=Z_2Z_3$ 的测量是完美的。由于数据态仍为 $|\\bar{0}\\rangle_L$，测量结果是 $s_2=0$。\n第1块测得的错误症状是 $(s_1,s_2)=(1,0)$。\n\n**3. 比特翻转纠错**\n对于稳定子 $(Z_1Z_2, Z_2Z_3)$，错误症状 $(1,0)$ 表明在第一个量子比特上发生了一个比特翻转错误 $X_1$。\n纠错程序对第一个量子比特施加一个 $X_1$ 操作。\n比特翻转纠错后系统的状态是 $|\\psi'\\rangle = X_1 |\\bar{0}\\rangle_L$。\n\n**4. 相位翻转纠错**\n问题陈述中提到，随后的相位翻转纠错不会检测到这个错误。我们来验证这一点。相位翻转稳定子的形式为 $S_p = (\\prod_{j\\in B_k}X_j)(\\prod_{j\\in B_l}X_j)$。错误是 $X_1$。由于 $X_1$ 与所有相位翻转稳定子对易（因为它们或者包含作用在第1块上的偶数个 $X$ 算符，或者不包含），$X_1$ 错误确实不会被检测到。因此，不施加相位翻转纠错。\n最终态是 $|\\psi_f\\rangle = X_1 |\\bar{0}\\rangle_L$。\n\n**5. 保真度计算**\n我们需要计算 $F = |\\langle\\bar{0}_L|\\psi_f\\rangle|^2 = |\\langle\\bar{0}_L|X_1|\\bar{0}_L\\rangle|^2$。\n我们来分析 $X_1$ 对 $|\\bar{0}\\rangle_L$ 的作用。\n$|\\bar{0}\\rangle_L = |+\\rangle_{B1} \\otimes |+\\rangle_{B2} \\otimes |+\\rangle_{B3}$。\n$|+\\rangle_{B1} = \\frac{1}{\\sqrt{2}}(|000\\rangle_1+|111\\rangle_1)$。\n$X_1$ 作用于第一个块的第一个量子比特上。\n$$\nX_1 |+\\rangle_{B1} = X_1 \\frac{1}{\\sqrt{2}}(|000\\rangle_1+|111\\rangle_1) = \\frac{1}{\\sqrt{2}}(|100\\rangle_1+|011\\rangle_1) \\equiv |\\chi\\rangle_1\n$$\n所以，最终态是 $|\\psi_f\\rangle = |\\chi\\rangle_1 |+\\rangle_{B2} |+\\rangle_{B3}$。\n与初始态的交叠为：\n$$\n\\langle\\bar{0}_L|\\psi_f\\rangle = (\\langle+|_{B1}|\\chi\\rangle_1) \\cdot (\\langle+|_{B2}|+\\rangle_{B2}) \\cdot (\\langle+|_{B3}|+\\rangle_{B3})\n$$\n第2和第3块的交叠为1。我们计算第1块的交叠：\n$$\n\\langle+|_{B1}|\\chi\\rangle_1 = \\left( \\frac{1}{\\sqrt{2}}(\\langle 000|_1+\\langle 111|_1) \\right) \\left( \\frac{1}{\\sqrt{2}}(|100\\rangle_1+|011\\rangle_1) \\right)\n$$\n$$\n= \\frac{1}{2}(\\langle 000|100\\rangle + \\langle 000|011\\rangle + \\langle 111|100\\rangle + \\langle 111|011\\rangle)\n$$\n所有的内积都是在正交的计算基矢态之间进行的。\n$$\n= \\frac{1}{2}(0 + 0 + 0 + 0) = 0\n$$\n因此，保真度为 $F = |0|^2 = 0$。", "answer": "$$\\boxed{0}$$", "id": "84591"}, {"introduction": "为了分析大规模量子计算机的性能，我们需要一种方法，将物理噪声和纠错的复杂细节抽象为逻辑层面上的有效描述。这个高级练习将引入逻辑信道及其泡利传输矩阵（PTM）的概念 [@problem_id:84706]。通过分析一个其中物理量子比特同时经历了振幅阻尼和退相位的Steane码逻辑量子比特，你将推导出一个关键的PTM矩阵元，学习如何将物理噪声模型正式地映射到逻辑错误率上。", "problem": "一个 7 量子比特的量子计算寄存器用于使用 Steane $[[7,1,3]]$ 码编码一个逻辑量子比特。逻辑泡利 Z 算符被定义为物理泡利 Z 算符的张量积：$Z_L = Z^{\\otimes 7}$。\n\n寄存器中的所有物理量子比特都受到相同的独立同分布量子误差信道 $\\mathcal{E}$ 的影响。该信道是两个不同过程的复合：首先是一个幅度阻尼 (AD) 信道 $\\mathcal{E}_{AD}$，然后是一个去相 (DP) 信道 $\\mathcal{E}_{DP}$。因此总信道为 $\\mathcal{E} = \\mathcal{E}_{DP} \\circ \\mathcal{E}_{AD}$。\n\n幅度阻尼信道 $\\mathcal{E}_{AD}$ 由以下 Kraus 算符描述：\n$$\nE_0 = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\sqrt{1-\\gamma} \\end{pmatrix}, \\quad E_1 = \\begin{pmatrix} 0 & \\sqrt{\\gamma} \\\\ 0 & 0 \\end{pmatrix}\n$$\n其中 $\\gamma$ 是阻尼概率。\n\n去相信道 $\\mathcal{E}_{DP}$ 由以下映射描述：\n$$\n\\mathcal{E}_{DP}(\\rho) = (1-p) \\rho + p Z \\rho Z\n$$\n其中 $p$ 是去相概率。\n\n在 7 量子比特编码态受到物理误差信道 $\\mathcal{E}^{\\otimes 7}$ 作用后，会应用一个由超算符 $\\mathcal{R}$ 描述的完美纠错过程。该纠错过程能够完美地识别并反转七个物理量子比特中任意一个上的任何单量子比特泡利错误（$X$、$Y$ 或 $Z$）。整个过程定义了一个作用于逻辑量子比特的有效逻辑信道 $\\mathcal{E}_{log} = \\mathcal{R} \\circ \\mathcal{E}^{\\otimes 7}$。\n\n逻辑信道的作用可以通过其泡利传输矩阵 (PTM) $R_{log}$ 来表征，其矩阵元由逻辑泡利算符的变换定义：$\\mathcal{E}_{log}(P_{\\beta,L}) = \\sum_{\\alpha} (R_{log})_{\\alpha\\beta} P_{\\alpha,L}$，其中 $P_{\\alpha,L}, P_{\\beta,L} \\in \\{I_L, X_L, Y_L, Z_L\\}$。\n\n推导逻辑信道泡利传输矩阵的对角元 $(R_{log})_{Z_L Z_L}$ 的精确表达式，该对角元描述了逻辑 $Z_L$ 算符的衰减。", "solution": "1. 逻辑泡利 Z (Pauli‐$Z$) 算符为\n$$Z_L=Z^{\\otimes7}\\,. $$ \n第 $i$ 个物理量子比特经历\n$$\\mathcal{E}_{AD}:\\;Z\\mapsto E_0ZE_0^\\dagger+E_1ZE_1^\\dagger\n=\\bigl(1-\\gamma\\bigr)Z,$$ \n然后 $\\mathcal{E}_{DP}$ 保持 $Z$ 不变。因此，每个物理信道作用于 $Z$ 时是对角的，其本征值为\n$$\\lambda\\;=\\;(1-\\gamma)\\,. $$\n\n2. 在没有恢复操作的情况下，$\\mathcal{E}^{\\otimes7}$ 作用于 $Z_L$ 得到\n$$\\mathcal{E}^{\\otimes7}(Z_L)\n=\\bigl(\\lambda Z\\bigr)^{\\otimes7}\n=\\lambda^7\\,Z_L\\,. $$\n\n3. Steane 码的完美单比特错误解码器只应用泡利 $X、Y、Z$ 纠正。由于幅度阻尼+去相不会对 $Z$ 产生净的泡利 $X$ 或 $Y$ 作用，恢复操作使 $Z_L$ 保持不变。因此\n$$\\mathcal{R}\\!\\bigl(\\mathcal{E}^{\\otimes7}(Z_L)\\bigr)\n=\\lambda^7\\,Z_L\n=(1-\\gamma)^7\\,Z_L.$$\n\n4. 根据定义，PTM 元素 $(R_{log})_{Z_LZ_L}$ 是此像中 $Z_L$ 的系数，即\n$$(R_{log})_{Z_LZ_L}=(1-\\gamma)^7.$$", "answer": "$$\\boxed{(1-\\gamma)^7}$$", "id": "84706"}]}