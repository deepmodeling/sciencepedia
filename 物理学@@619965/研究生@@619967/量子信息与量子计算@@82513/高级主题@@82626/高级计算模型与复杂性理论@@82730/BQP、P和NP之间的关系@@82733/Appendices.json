{"hands_on_practices": [{"introduction": "为了理解 BQP（有界错误量子多项式时间）如何被经典计算复杂性类别所包含，我们首先从一个理想化的场景开始。当一个量子电路完全由矩阵元素为有理数的门构成时，其跃迁振幅可以直接与一个称为 GapP 的函数的整数值相关联。这个练习 [@problem_id:130916] 将通过一个简单的双量子比特电路，具体地展示如何计算这个 GapP 值，从而为 $BQP \\subseteq PP$（概率多项式时间）的证明奠定基础。", "problem": "**背景：** 复杂性类 GapP 由函数 $f(x)$ 构成，这些函数计算的是一台非确定性多项式时间图灵机的接受路径数量与拒绝路径数量之间的差值。由具有有理数值矩阵元素的门构成的量子电路，其迁移振幅本身也是有理数。对于一个迁移振幅 $A = p/q$，当分母 $q$ 固定时，其整数分子 $p$ 可以由一个 GapP 函数计算得出。这个整数 $p$ 被称为该振幅在指定分母 $q$ 下的 GapP 值。\n\n**问题：** 考虑一个制备在初始状态 $|\\psi_{in}\\rangle = |00\\rangle$ 的 2-量子比特系统。我们应用一个量子电路 $U$，它被定义为三个操作的序列：$U = U_3 U_2 U_1$。这些操作如下：\n1.  $U_1 = H \\otimes I$：一个 Hadamard 门 $H$ 作用于第一个量子比特，而第二个量子比特保持不变。\n2.  $U_2 = C-R$：一个受控门，其中第一个量子比特为控制位，第二个量子比特为目标位。单量子比特幺正操作 $R$ 由以下实数值矩阵描述：\n    $$\n    R = \\begin{pmatrix} c & -s \\\\ s & c \\end{pmatrix}\n    $$\n    其中 $s = a/d$ 和 $c = b/d$ 是有理数参数，$a, b, d$ 为整数。\n3.  $U_3 = H \\otimes I$：另一个 Hadamard 门作用于第一个量子比特。\n\n你的任务是计算迁移振幅 $A = \\langle 11 | U | 00 \\rangle$ 的 GapP 值。该振幅的分母固定为 $2d$。请用参数 $a$ 来表示你的答案。", "solution": "1. 初始状态与第一个 Hadamard 门：\n$$|\\psi_0\\rangle = |0\\rangle\\otimes|0\\rangle,\\quad\nU_1=H\\otimes I,\\quad\nH|0\\rangle=\\frac{|0\\rangle+|1\\rangle}{\\sqrt2}.$$\n因此\n$$|\\psi_1\\rangle\n=U_1|\\psi_0\\rangle\n=\\frac{1}{\\sqrt2}(|0\\rangle+|1\\rangle)\\otimes|0\\rangle\n=\\frac{|00\\rangle+|10\\rangle}{\\sqrt2}.$$\n\n2. 受控-$R$ 门，其中\n$$R=\\begin{pmatrix}c&-s\\\\s&c\\end{pmatrix},\\quad\nc=\\frac{b}{d},\\;s=\\frac{a}{d}.$$\n对于 $|00\\rangle$（控制位=0），它平凡地作用；对于 $|10\\rangle$（控制位=1）：\n$$|10\\rangle\\mapsto|1\\rangle\\otimes R|0\\rangle\n=|1\\rangle\\otimes\\bigl(c|0\\rangle+s|1\\rangle\\bigr)\n=c|10\\rangle+s|11\\rangle.$$\n因此\n$$|\\psi_2\\rangle\n=\\frac{1}{\\sqrt2}\\bigl(|00\\rangle+c|10\\rangle+s|11\\rangle\\bigr).$$\n\n3. 第二个 Hadamard 门作用于第一个量子比特：\n$$U_3=H\\otimes I,\\quad\nH|0\\rangle=\\tfrac{|0\\rangle+|1\\rangle}{\\sqrt2},\\;\nH|1\\rangle=\\tfrac{|0\\rangle-|1\\rangle}{\\sqrt2}.$$\n应用于 $|\\psi_2\\rangle$ 中的每一项：\n\n$$\n\\begin{aligned}\n|00\\rangle&\\mapsto\\tfrac1{\\sqrt2}(|0\\rangle+|1\\rangle)\\otimes|0\\rangle,\\\\\nc\\,|10\\rangle&\\mapsto\\tfrac{c}{\\sqrt2}(|0\\rangle-|1\\rangle)\\otimes|0\\rangle,\\\\\ns\\,|11\\rangle&\\mapsto\\tfrac{s}{\\sqrt2}(|0\\rangle-|1\\rangle)\\otimes|1\\rangle.\n\\end{aligned}\n$$\n\n将各项相加并计入前置因子 $1/\\sqrt2$ 得\n$$|\\psi_3\\rangle\n=\\frac1{2}\\Bigl[(1+c)|00\\rangle+(1-c)|10\\rangle\n+s\\,|01\\rangle -s\\,|11\\rangle\\Bigr].$$\n\n4. 提取振幅 $A=\\langle11|\\psi_3\\rangle$：\n$$A=-\\frac{s}{2}=-\\frac{a/d}{2}=-\\frac{a}{2d}.$$\n\n5. 对于分母 $2d$，整数分子（GapP 值）为\n$$p=-a.$$", "answer": "$$\\boxed{-a}$$", "id": "130916"}, {"introduction": "在现实中，许多重要的量子门（如 Hadamard 门）具有无理数振幅，这使得直接映射到 GapP 变得复杂。为了解决这个问题，$BQP \\subseteq PP$ 的证明采用了一种基于路径积分和二进有理数近似的模拟方法。在这个练习 [@problem_id:130813] 中，你将模拟这个过程，通过近似门振幅来计算构成 GapP 函数的关键部分——#P（计数问题）函数 $N_{acc}$ 的值。", "problem": "在计算复杂性理论的研究中，量子复杂性类别 BQP（有界错误量子多项式时间）与经典复杂性类别（如 P 和 NP）之间的关系是一个至关重要的问题。已经证明 BQP 包含在 PP（概率多项式时间）中，PP 是一类可以由概率图灵机在指数级小的概率间隙下解决的问题。这个包含关系 $BQP \\subseteq PP$ 的证明，依赖于通过路径积分形式来模拟量子计算，这让人联想到量子力学中 Feynman 的路径积分。\n\n一个量子计算由一系列幺正门 $U = U_m U_{m-1} \\dots U_1$ 描述。从初始态 $|x\\rangle$ 跃迁到最终态 $|y\\rangle$ 的振幅由所有可能计算路径上的和给出：\n$$\n\\langle y | U | x \\rangle = \\sum_{z_1, \\dots, z_{m-1}} \\langle y | U_m | z_{m-1} \\rangle \\dots \\langle z_1 | U_1 | x \\rangle\n$$\n和中的每一项对应于单条路径的振幅。为了在经典概率机上模拟这个过程，门振幅（可能是无理复数）被近似为二进有理数（分母为2的幂的分数）。对于给定的精度参数 $p$，每个实数值的门矩阵元素 $g_{uv} = \\langle u | G | v \\rangle$ 被近似为 $\\tilde{g}_{uv} = k_{uv}/2^p$，其中 $k_{uv} = \\text{round}(2^p \\cdot g_{uv})$ 是一个整数。对于复数振幅，实部和虚部分别进行近似。\n\n总的近似振幅是这些二进有理数乘积的和，可以写成 $S / 2^{mp}$。整数 $S = \\sum_{\\text{paths}} \\prod_{\\text{gates}} k_{uv}$ 是一个 GapP 函数，意味着它可以表示为非确定性图灵机接受路径数（$N_{acc}$）和拒绝路径数（$N_{rej}$）之间的差。具体来说，我们将一条路径的权重定义为其整数分子之积 $W(\\text{path}) = \\prod k_{uv}$。那么，$N_{acc} = \\sum_{W>0} W(\\text{path})$ 且 $N_{rej} = \\sum_{W<0} |W(\\text{path})|$。$N_{acc}$ 和 $N_{rej}$ 的值可以在 #P 中计算。\n\n您的任务是为一个特定的 2-量子比特量子线路执行这样的计算。\n\n**问题描述：**\n\n考虑一个由幺正算符 $U = U_3 U_2 U_1$ 描述的 2-量子比特量子线路，其中：\n1.  $U_1 = -H \\otimes I$，其中 $H$ 是 Hadamard 门，$I$ 是单位门。\n2.  $U_2$ 是一个受控-$R_Y(\\theta)$ 门，第一个量子比特为控制位，第二个为目标位，旋转角 $\\theta = \\pi/3$。$R_Y(\\theta)$ 门定义为 $R_Y(\\theta) = \\begin{pmatrix} \\cos(\\theta/2) & -\\sin(\\theta/2) \\\\ \\sin(\\theta/2) & \\cos(\\theta/2) \\end{pmatrix}$。\n3.  $U_3 = H \\otimes I$。\n\n门矩阵作用于标准计算基 $\\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\}$。所有门矩阵元均为实数。门矩阵元 $g_{uv}$ 的二进近似为 $\\tilde{g}_{uv} = k_{uv} / 2^p$，其中整数分子 $k_{uv} = \\text{round}(2^p \\cdot g_{uv})$，精度 $p=5$。`round()` 函数将实数四舍五入到最近的整数（其中 .5 向上取整）。\n\n计算从初始态 $|x\\rangle = |00\\rangle$ 到最终态 $|y\\rangle = |11\\rangle$ 的跃迁振幅对应的 $N_{acc}$ 值。该值是所有总权重为正的计算路径的权重之和。", "solution": "1. 从 $|00\\rangle$ 到 $|11\\rangle$ 的跃迁振幅为\n$$\n\\langle11|U_3U_2U_1|00\\rangle\n=\\sum_{z_1,z_2}\\langle11|U_3|z_2\\rangle\\langle z_2|U_2|z_1\\rangle\\langle z_1|U_1|00\\rangle.\n$$\n\n2. 矩阵元振幅（精确值）：\n- $U_1=-H\\otimes I$ 给出\n  $$\\langle z_1|U_1|00\\rangle=\n  \\begin{cases}\n  -\\tfrac1{\\sqrt2},&z_1=00,10,\\\\\n  0,&\\text{其他情况。}\n  \\end{cases}$$\n- $U_2=\\mathrm{C}\\!R_Y(\\pi/3)$ 当第一位比特为 0 时，其作用为单位矩阵；当第一位比特为 1 时，其作用为\n  $$R_Y(\\tfrac\\pi3)=\\begin{pmatrix}\\cos\\tfrac\\pi6&-\\sin\\tfrac\\pi6\\\\\\sin\\tfrac\\pi6&\\cos\\tfrac\\pi6\\end{pmatrix}\n  $$\n  。因此\n  $$\\langle z_2|U_2|z_1\\rangle\\neq0\\iff z_1=10,\\ z_2\\in\\{10,11\\},$$\n  ，其中\n  $$\\langle11|U_2|10\\rangle=\\sin\\tfrac\\pi6=\\tfrac12.$$\n- $U_3=H\\otimes I$ 给出\n  $$\\langle11|U_3|z_2\\rangle\\neq0\\iff z_2\\in\\{01,11\\},\\quad\n  \\langle11|U_3|11\\rangle=-\\tfrac1{\\sqrt2}.$$\n\n3. 唯一的非零路径是 $00\\to z_1=10\\to z_2=11\\to11$，其精确振幅为\n$$\n(-\\tfrac1{\\sqrt2})\\times(\\tfrac12)\\times(-\\tfrac1{\\sqrt2})\n=\\;\\frac1{4}.\n$$\n\n4. 使用 $p=5$ 进行二进近似：将每个精确矩阵元 $g$ 乘以 $2^5=32$ 并四舍五入。\n   - 对于 $U_1$：$g=-\\tfrac1{\\sqrt2}=-\\tfrac{\\sqrt2}{2}\\;\\Longrightarrow\\;k_1=\\round(32\\cdot(-\\tfrac{\\sqrt2}{2}))=\\round(-16\\sqrt2)=-23$。\n   - 对于 $U_2$：$g=\\tfrac12\\;\\Longrightarrow\\;k_2=\\round(32\\cdot\\tfrac12)=16$。\n   - 对于 $U_3$：$g=-\\tfrac1{\\sqrt2}\\;\\Longrightarrow\\;k_3=-23$。\n\n5. 这条唯一路径的整数权重为\n$$\nW = k_1\\,k_2\\,k_3 = (-23)\\times16\\times(-23)=23^2\\cdot16=8464>0.\n$$\n因此，$N_{acc}$，即正权重之和，为 8464。", "answer": "$$\\boxed{8464}$$", "id": "130813"}, {"introduction": "二进有理数近似是 $BQP \\subseteq PP$ 证明的核心，但这种近似的精度会直接影响模拟结果的准确性。通过改变近似中使用的分母（即精度），我们可以探索模拟结果与真实量子概率之间的关系。这个练习 [@problem_id:130804] 要求你计算并比较在两种不同精度下得到的接受概率，这有助于加深对模拟过程本质及其局限性的理解。", "problem": "证明复杂度类 BQP 包含在 PP 中 ($BQP \\subseteq PP$) 的过程涉及使用概率图灵机来模拟量子线路。该模拟的一个关键要素是酉门矩阵的近似。这些矩阵的元素可以是任意复数，它们被近似为二进有理数（形式为 $k/2^p$ 的数），这种数可以由经典计算机处理。这个过程使得 PP 机器能够精确计算任何计算路径的振幅。\n\n考虑一个由单个双量子比特受控 $R_z(\\theta)$ 门组成的简单量子线路，其旋转角设置为 $\\theta = \\pi/4$。其门矩阵由下式给出：\n$$\nC-R_z(\\theta) = \\begin{pmatrix}\n1 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & 0 \\\\\n0 & 0 & e^{-i\\theta/2} & 0 \\\\\n0 & 0 & 0 & e^{i\\theta/2}\n\\end{pmatrix}\n$$\n系统被初始化在状态 $|\\psi_{\\text{in}}\\rangle = |+\\rangle \\otimes |+\\rangle$ 上，其中 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$。当对第一个（控制）量子比特在计算基上测量的结果为 $|1\\rangle$ 时，该计算被定义为“接受”。\n\n该模拟使用矩阵 $\\tilde{U}_D$ 来近似真实的门矩阵 $U = C-R_z(\\pi/4)$，其中 $\\tilde{U}_D$ 的矩阵元素基于分母为 $D$ 的二进有理数。近似规则如下：对于非平凡元素 $e^{\\pm i\\pi/8}$，其实部和虚部分别四舍五入到最接近的形如 $k/D$ 的有理数，其中 $k$ 是一个整数。如果出现平局（一个值恰好在两个此类有理数的正中间），则选择绝对值较大的那个值。元素 $1$ 和 $0$ 已经是精确的二进有理数，因此保持不变。\n\n设 $\\tilde{P}_D$ 是使用分母为 $D$ 的近似门矩阵 $\\tilde{U}_D$ 计算出的接受概率。您的任务是计算绝对差 $|\\tilde{P}_{16} - \\tilde{P}_8|$。", "solution": "我们有输入态\n$$|\\psi_{\\rm in}\\rangle = |+\\rangle\\otimes|+\\rangle\n=\\frac12\\bigl(|00\\rangle+|01\\rangle+|10\\rangle+|11\\rangle\\bigr)\\,. $$\n在施加 $U=C\\!-\\!R_z(\\pi/4)$ 后，精确的输出为\n$$|\\psi_{\\rm out}\\rangle\n=\\frac12\\bigl(|00\\rangle+|01\\rangle+e^{-i\\pi/8}|10\\rangle+e^{i\\pi/8}|11\\rangle\\bigr)\\,. $$\n测量第一个量子比特并在结果为 $|1\\rangle$ 时接受，得到的精确概率为\n$$P=\\frac14\\bigl|e^{-i\\pi/8}\\bigr|^2+\\frac14\\bigl|e^{i\\pi/8}\\bigr|^2\n=\\frac14(1+1)=\\frac12\\,. $$\n\n在分母为 $D$ 的二进近似下，我们替换\n$$e^{\\pm i\\pi/8}=\\cos\\frac{\\pi}{8}\\pm i\\sin\\frac{\\pi}{8}$$\n的方法是，将 $\\{\\cos\\frac{\\pi}{8},\\sin\\frac{\\pi}{8}\\}$ 中的每一项四舍五入到最接近的 $1/D$ 的倍数。\n\n1. 对于 $D=16$：\n   $$\\cos\\frac{\\pi}{8}\\approx0.9239\\to\\frac{15}{16},\\quad\n     \\sin\\frac{\\pi}{8}\\approx0.3827\\to\\frac{6}{16},$$\n   所以 \n   $$\\tilde a_{16}=e^{-i\\pi/8}\\to\\frac{15-6i}{16},\\quad\n     \\tilde b_{16}=e^{i\\pi/8}\\to\\frac{15+6i}{16}。$$\n   然后\n   $$|\\tilde a_{16}|^2\n     =\\Bigl(\\frac{15}{16}\\Bigr)^2+\\Bigl(\\frac{6}{16}\\Bigr)^2\n     =\\frac{225+36}{256}=\\frac{261}{256},$$\n   接受概率是\n   $$\\tilde P_{16}\n     =\\frac14\\bigl(|\\tilde a_{16}|^2+|\\tilde b_{16}|^2\\bigr)\n     =\\frac12\\,|\\tilde a_{16}|^2\n     =\\frac12\\cdot\\frac{261}{256}\n     =\\frac{261}{512}。$$\n\n2. 对于 $D=8$：\n   $$\\cos\\frac{\\pi}{8}\\approx0.9239\\to\\frac{7}{8},\\quad\n     \\sin\\frac{\\pi}{8}\\approx0.3827\\to\\frac{3}{8},$$\n   所以 \n   $$\\tilde a_{8}=\\frac{7-3i}{8},\\quad \\tilde b_{8}=\\frac{7+3i}{8}。$$\n   然后\n   $$|\\tilde a_{8}|^2\n     =\\Bigl(\\frac{7}{8}\\Bigr)^2+\\Bigl(\\frac{3}{8}\\Bigr)^2\n     =\\frac{49+9}{64}=\\frac{58}{64}=\\frac{29}{32},$$\n   以及\n   $$\\tilde P_{8}\n     =\\frac12\\,|\\tilde a_{8}|^2\n     =\\frac12\\cdot\\frac{29}{32}\n     =\\frac{29}{64}。$$\n\n因此，绝对差为\n$$\\bigl|\\tilde P_{16}-\\tilde P_{8}\\bigr|\n=\\Bigl|\\frac{261}{512}-\\frac{29}{64}\\Bigr|\n=\\frac{261-232}{512}\n=\\frac{29}{512}\\,. $$", "answer": "$$\\boxed{\\frac{29}{512}}$$", "id": "130804"}]}