{"hands_on_practices": [{"introduction": "BQP 算法的核心威力源于量子并行性，它能同时探索一个指数级大小的解空间。一个典范性的例子是求解线性变换的“核”（kernel），这是阿贝尔隐藏子群问题（Abelian Hidden Subgroup Problem）的一个特例，而隐藏子群问题是许多著名量子算法的基础。通过这个练习 [@problem_id:148972]，我们将亲手实践一个量子算法，看它如何利用量子叠加和干涉来高效地识别和分离出这个隐藏的代数结构。", "problem": "考虑一个用于寻找线性变换 $A: (\\mathbb{F}_2)^n \\to (\\mathbb{F}_2)^m$ 的核的量子算法。该算法首先将一个 $n$ 量子比特寄存器和一个 $m$ 量子比特寄存器制备在态 $|0\\rangle^{\\otimes n}|0\\rangle^{\\otimes m}$ 上。对第一个寄存器应用Hadamard门之后，再应用一个对应于变换 $A$ 的量子谕示，其作用为将 $|x\\rangle|y\\rangle$ 映射到 $|x\\rangle|y \\oplus Ax\\rangle$，其中 $x \\in (\\mathbb{F}_2)^n$，$y \\in (\\mathbb{F}_2)^m$，且 $\\oplus$ 表示模2按位加法。\n\n调用谕示后，组合系统的状态为 $|\\Psi\\rangle = \\frac{1}{\\sqrt{2^n}}\\sum_{x \\in (\\mathbb{F}_2)^n} |x\\rangle |Ax\\rangle$。之后，第二个（输出）寄存器被丢弃，使得第一个（输入）寄存器处于一个混合态，该混合态由约化密度矩阵 $\\rho_1 = \\text{Tr}_2(|\\Psi\\rangle\\langle\\Psi|)$ 描述。\n\n设 $n=4$ 且 $m=3$。具体的线性变换由矩阵给出\n$$\nA = \\begin{pmatrix}\n1 & 0 & 1 & 1 \\\\\n0 & 1 & 1 & 0 \\\\\n1 & 1 & 0 & 1\n\\end{pmatrix}.\n$$\n对输入寄存器执行一次投影测量。该测量将状态投影到由态 $|\\psi_S\\rangle$ 张成的一维子空间上，其中 $|\\psi_S\\rangle$ 是子空间 $S \\subset (\\mathbb{F}_2)^4$ 中所有向量的均匀叠加态。子空间 $S$ 由基向量 $s_1 = (1,1,1,0)$ 和 $s_2 = (0,0,1,1)$ 定义。因此，投影算子为 $P_S = |\\psi_S\\rangle\\langle\\psi_S|$，其中 $|\\psi_S\\rangle = \\frac{1}{\\sqrt{|S|}}\\sum_{s \\in S} |s\\rangle$。\n\n推导这次测量得到正结果的概率。", "solution": "我们从谕示作用后的状态\n$$|\\Psi\\rangle=\\frac{1}{\\sqrt{2^n}}\\sum_{x\\in(\\mathbb{F}_2)^n}|x\\rangle|Ax\\rangle$$\n开始，并丢弃第二个寄存器以得到\n$$\\rho_1=\\text{Tr}_2\\bigl(|\\Psi\\rangle\\langle\\Psi|\\bigr)\n=\\frac{1}{2^n}\\sum_{x,x'\\in(\\mathbb{F}_2)^n}\\langle Ax'|Ax\\rangle\\,|x\\rangle\\langle x'|\n=\\frac{1}{2^n}\\sum_{x,x':\\,Ax=Ax'}|x\\rangle\\langle x'|.$$\n对\n$$|\\psi_S\\rangle=\\frac{1}{\\sqrt{|S|}}\\sum_{s\\in S}|s\\rangle,\\quad\nP_S=|\\psi_S\\rangle\\langle\\psi_S|$$\n的投影测量，其成功概率为\n$$P=\\text{Tr}\\bigl(P_S\\,\\rho_1\\bigr)\n=\\langle\\psi_S|\\rho_1|\\psi_S\\rangle\n=\\frac{1}{2^n\\,|S|}\\sum_{\\substack{x,x'\\in S\\\\Ax=Ax'}}1.$$\n注意到当 $x,x'\\in S$ 时，它们的差 $t=x-x'$ 也在 $S$ 中，且条件 $Ax=Ax'$ 等价于 $At=0$。对于每个属于 $S \\cap \\ker A$ 的向量 $t$，都恰好对应 $|S|$ 个序偶 $(x,x')$，因此\n$$P=\\frac{|S\\cap\\ker A|\\;|S|}{2^n\\,|S|}=\\frac{|S\\cap\\ker A|}{2^n}.$$\n对于 $n=4$ 的情况，子空间 $S$ 的维度为 2，因此 $|S|=2^2=4$。$S$ 中的元素为\n$$t=\\alpha(1,1,1,0)+\\beta(0,0,1,1)=(\\alpha,\\alpha,\\alpha+\\beta,\\beta).$$\n在 $\\mathbb{F}_2$ 上应用 $A$ 得到\n$$At=(\\alpha + (\\alpha+\\beta) + \\beta, \\alpha + (\\alpha+\\beta), \\alpha + \\alpha + \\beta)^T = (0, \\beta, \\beta)^T,$$\n所以 $At=0 \\iff \\beta=0$。这意味着 $S\\cap\\ker A$ 中有两个元素，它们是当 $\\beta=0$ 时，$\\alpha=0$ 对应的 $(0,0,0,0)$ 和 $\\alpha=1$ 对应的 $(1,1,1,0)$。因此 $|S\\cap\\ker A|=2$。\n最终概率为\n$$P=\\frac{2}{2^4}=\\frac{1}{8}.$$", "answer": "$$\\boxed{\\frac{1}{8}}$$", "id": "148972"}, {"introduction": "BQP 中“有界错误”的承诺依赖于量子纠错（Quantum Error Correction, QEC）的强大能力，它能保护脆弱的量子信息免受噪声干扰。然而，纠错码的性能不仅取决于其本身的设计，还深刻地依赖于我们如何解码错误综合征，特别是在面对现实世界中复杂的关联错误时。这个练习 [@problem_id:149031] 将带领我们深入 7-量子比特 Steane 码的内部，分析一个特定的关联错误模型如何欺骗一个标准的解码器，从而导致一个无法恢复的逻辑错误。", "problem": "7-比特 Steane 码是一种将一个逻辑量子比特编码到七个物理量子比特中的量子纠错码。它是一种 Calderbank-Shor-Steane (CSS) 码，由一组六个稳定子生成元定义。编码量子信息的可靠性对于实现复杂性类别 BQP 中的算法至关重要。本问题研究该码在特定关联误差模型下的脆弱性。\n\n7-比特 Steane 码的稳定子生成元由以下公式给出：\n$$\ng_1 = X_1 X_3 X_5 X_7 \\\\\ng_2 = X_2 X_3 X_6 X_7 \\\\\ng_3 = X_4 X_5 X_6 X_7 \\\\\ng_4 = Z_1 Z_3 Z_5 Z_7 \\\\\ng_5 = Z_2 Z_3 Z_6 Z_7 \\\\\ng_6 = Z_4 Z_5 Z_6 Z_7\n$$\n其中 $X_i, Y_i, Z_i$ 是作用在量子比特 $i$ 上的泡利算符。码空间是所有六个生成元的联合+1特征子空间。逻辑泡利算符为 $\\bar{X} = \\prod_{i=1}^7 X_i$ 和 $\\bar{Z} = \\prod_{i=1}^7 Z_i$。\n\n制备一个逻辑零态 $|\\bar{0}\\rangle$，它是逻辑 $\\bar{Z}$ 算符的特征值为+1的特征态，即 $\\bar{Z}|\\bar{0}\\rangle = |\\bar{0}\\rangle$。该状态受到一个关联噪声信道 $\\mathcal{E}$ 的作用。该信道的定义如下：一个特定的多比特泡利误差 $E = X_1 X_2 X_4 X_5$ 以概率 $p$ 发生；无误差以概率 $1-p$ 发生。\n\n在噪声信道作用后，应用一个标准的纠错程序。这包括：\n1.  测量六个稳定子生成元以获得一个纠错子。对于一个误差 $P$，其纠错子是一个6比特的字符串 $s=(s_1, \\dots, s_6)$，其中如果 $P$ 与 $g_i$ 对易，则 $s_i=0$；如果它们反对易，则 $s_i=1$。\n2.  应用一个校正算符 $C$。校正逻辑基于 Steane 码的标准译码器，该译码器独立地对位翻转类型错误（由 $Z$-稳定子检测）和相位翻转类型错误（由 $X$-稳定子检测）进行译码。译码器假设单量子比特错误是最可能发生的，并选择与测量的纠错子一致的最小权重单量子比特泡利算符。如果纠错子的位翻转（相位翻转）部分全为零，则不应用 $X$-类型（$Z$-类型）的校正。\n\n如果经过误差和校正后的最终状态 $|\\psi_{\\text{final}}\\rangle = C E |\\bar{0}\\rangle$ 与初始状态正交，即 $\\langle\\bar{0}|\\psi_{\\text{final}}\\rangle = 0$，则发生逻辑错误。\n\n计算逻辑错误的总概率 $P_L$ 作为 $p$ 的函数。", "solution": "1. 逻辑错误的总概率为\n$$P_L = (1-p)\\Pr[\\text{逻辑错误}\\mid \\text{无错误}] + p\\,\\Pr[\\text{逻辑错误}\\mid E]$$\n如果没有错误发生，那么测量会得到平凡的纠错子，不会应用任何校正操作，因此最终状态就是初始状态，不会发生逻辑错误。所以，\n$$ \\Pr[\\text{逻辑错误}\\mid \\text{无错误}]=0 $$\n2. 对于关联泡利误差 $E=X_1X_2X_4X_5$，我们通过测量 Z-稳定子 $g_4,g_5,g_6$ 来获得位翻转（X-类型）错误的纠错子：\n$$\ng_4=Z_1 Z_3 Z_5 Z_7 \\\\\ng_5=Z_2 Z_3 Z_6 Z_7 \\\\\ng_6=Z_4 Z_5 Z_6 Z_7\n$$\n我们计算 $E$ 与每一个Z-稳定子的对易关系（Pauli算符 $X_i$ 和 $Z_j$ 当且仅当 $i=j$ 时反对易）：\n- 与 $g_4$：$E$ 在量子比特 1 和 5 上有 $X$ 算符，与 $g_4$ 中的 $Z_1$ 和 $Z_5$ 反对易。因为有两个反对易关系，所以 $E$ 和 $g_4$ 总体上是对易的 $\\implies s_4=0$。\n- 与 $g_5$：$E$ 仅在量子比特 2 上有 $X$ 算符，与 $g_5$ 中的 $Z_2$ 反对易。因此 $E$ 和 $g_5$ 反对易 $\\implies s_5=1$。\n- 与 $g_6$：$E$ 在量子比特 4 和 5 上有 $X$ 算符，与 $g_6$ 中的 $Z_4$ 和 $Z_5$ 反对易。有两个反对易关系，所以 $E$ 和 $g_6$ 对易 $\\implies s_6=0$。\n因此，位翻转部分的纠错子为 $(s_4,s_5,s_6)=(0,1,0)$。由于 $E$ 只包含 $X$ 算符，它与所有 $X$-稳定子 ($g_1, g_2, g_3$) 对易，所以相位翻转部分的纠错子为 $(0,0,0)$。\n3. 标准的最小权重译码器寻找一个具有此纠错子 $(0,1,0)$ 的最小权重 $X$-类型错误。该纠错子唯一地对应于在量子比特 2 上的单个 $X$ 错误。因此，译码器应用的校正算符是\n$$C = X_2$$\n4. 施加在码空间上的总等效算符（残余误差）是校正算符和原始误差的乘积：\n$$CE = X_2 (X_1X_2X_4X_5) = X_1 X_4 X_5$$\n5. 我们需要判断 $CE$ 是否是一个逻辑算符。逻辑 $\\bar{X}$ 算符是 $\\bar{X}=X_1X_2X_3X_4X_5X_6X_7$。注意 $CE$ 与 $\\bar{X}$ 的关系：\n$$\\bar{X} \\cdot g_2 = (X_1X_2X_3X_4X_5X_6X_7) (X_2X_3X_6X_7) = X_1X_4X_5 = CE$$\n这意味着残余误差 $CE$ 与逻辑算符 $\\bar{X}$ 只相差一个稳定子 $g_2$。由于稳定子作用在码字上时保持不变，因此 $CE$ 在码空间上的作用等同于逻辑 $\\bar{X}$ 算符的作用。它会确定地将逻辑态 $|\\bar{0}\\rangle$ 翻转到 $|\\bar{1}\\rangle$。\n6. 既然最终状态是 $|\\bar{1}\\rangle$，它与初始状态 $|\\bar{0}\\rangle$ 正交，所以发生了一个逻辑错误。因此，\n$$\\Pr[\\text{逻辑错误}\\mid E]=1$$\n所以总的逻辑错误概率为\n$$P_L = (1-p)\\cdot 0 + p\\cdot 1 = p$$", "answer": "$$\\boxed{p}$$", "id": "149031"}, {"introduction": "BQP 复杂性类的边界是由 BQP-完全问题来定义的，这些问题代表了该类中最难的计算任务。一个惊人而深刻的发现是，某些 BQP-完全问题等价于计算经典统计力学模型的配分函数，这在量子计算和物理学之间架起了一座桥梁。在这个练习中 [@problem_id:148940]，我们将设计一个模拟受控非门（CNOT）的伊辛自旋“小工具”（gadget），通过调节其能量参数来精确地编码逻辑运算，从而亲身体验这种计算与物理的精妙对应关系。", "problem": "对复杂性类BQP（有界错误量子多项式时间）的研究揭示了量子计算与经典统计力学之间的深刻联系。一些BQP完全问题涉及到计算经典系统的配分函数，例如二维或三维伊辛模型，其中模型的参数（如耦合常数）编码了一个量子线路。这些构造的一个关键特征是使用模拟量子门的局部“小装置”。\n\n考虑一个设计用于模拟受控非（CNOT）门的简单经典小装置。该小装置由四个伊辛自旋组成：一个控制输入（$s_c$）、一个目标输入（$s_t$）、一个控制输出（$s_{c'}$）和一个目标输出（$s_{t'}$），每个自旋取值为$\\{-1, +1\\}$。从逻辑量子比特态$\\{|0\\rangle, |1\\rangle\\}$到自旋态的映射为$|0\\rangle \\leftrightarrow +1$和$|1\\rangle \\leftrightarrow -1$。在此映射下，CNOT逻辑（$|c,t\\rangle \\to |c, c \\oplus t\\rangle$）转换为以下自旋关系：\n$$s_{c'} = s_c$$\n$$s_{t'} = s_c s_t$$\n\n该小装置总共有$2^4 = 16$种可能的自旋构型，被分为两组：\n1.  **有效构型（$C_{valid}$）：** 满足两个CNOT逻辑条件的4种构型。\n2.  **无效构型（$C_{invalid}$）：** 至少违反其中一个条件的12种构型。\n\n为了强制执行CNOT逻辑，引入了一个惩罚哈密顿量，它为无效构型分配更高的能量：\n$$H = \\Delta_c (1 - s_c s_{c'}) + \\Delta_t (1 - s_c s_t s_{t'})$$\n此处，$\\Delta_c > 0$是违反控制量子比特同一性的能量惩罚，而$\\Delta_t > 0$是违反目标量子比特变换逻辑的惩罚。\n\n在逆温度$\\beta$下，该小装置的热力学性质由其配分函数描述。我们为有效和无效子空间定义受限配分函数如下：\n$$Z_{valid} = \\sum_{\\sigma \\in C_{valid}} e^{-\\beta H(\\sigma)}, \\quad Z_{invalid} = \\sum_{\\sigma \\in C_{invalid}} e^{-\\beta H(\\sigma)}$$\n其中$\\sigma = (s_c, s_t, s_{c'}, s_{t'})$表示一个自旋构型。\n\n为确保该小装置在特定的热力学意义上是“平衡的”，等式$Z_{valid} = Z_{invalid}$必须成立。假设目标逻辑的无量纲惩罚已被物理约束固定为值$\\beta\\Delta_t = \\ln(3)$。推导满足平衡条件的控制逻辑所需的无量纲惩罚$\\beta\\Delta_c$的值。", "solution": "我们将哈密顿量写成构型能量的形式。对于一个构型，如果它满足 $s_{c'}=s_c$，则第一项为0；如果不满足，则为 $2\\Delta_c$。同样，如果满足 $s_{t'}=s_c s_t$，则第二项为0；如果不满足，则为 $2\\Delta_t$。\n\n有4个有效构型，它们同时满足两个条件，所以它们的能量都为 $H=0$。因此，有效配分函数为：\n$$Z_{valid} = 4e^{-\\beta \\cdot 0} = 4$$\n\n其余12个无效构型可以分为三类：\n- 4种构型违反控制逻辑但满足目标逻辑（$s_{c'}\\neq s_c, s_{t'}=s_c s_t$）。能量为 $H=2\\Delta_c$。\n- 4种构型满足控制逻辑但违反目标逻辑（$s_{c'} = s_c, s_{t'} \\neq s_c s_t$）。能量为 $H=2\\Delta_t$。\n- 4种构型同时违反两个逻辑（$s_{c'} \\neq s_c, s_{t'} \\neq s_c s_t$）。能量为 $H=2\\Delta_c+2\\Delta_t$。\n\n因此，无效配分函数为：\n$$\nZ_{invalid}\n= 4e^{-2\\beta\\Delta_c} + 4e^{-2\\beta\\Delta_t} + 4e^{-2\\beta(\\Delta_c+\\Delta_t)}\n= 4\\left(e^{-2\\beta\\Delta_c} + e^{-2\\beta\\Delta_t} + e^{-2\\beta\\Delta_c}e^{-2\\beta\\Delta_t}\\right)\n$$\n平衡条件 $Z_{valid}=Z_{invalid}$ 给出：\n$$1 = e^{-2\\beta\\Delta_c} + e^{-2\\beta\\Delta_t} + e^{-2\\beta\\Delta_c}e^{-2\\beta\\Delta_t}$$\n我们已知 $\\beta\\Delta_t = \\ln(3)$，所以 $e^{\\beta\\Delta_t} = 3$，这意味着 $e^{-2\\beta\\Delta_t} = (e^{\\beta\\Delta_t})^{-2} = 3^{-2} = \\frac{1}{9}$。\n令 $x = e^{-2\\beta\\Delta_c}$，代入平衡方程：\n$$1 = x + \\frac{1}{9} + \\frac{x}{9}$$\n$$1 - \\frac{1}{9} = x\\left(1 + \\frac{1}{9}\\right)$$\n$$\\frac{8}{9} = x\\left(\\frac{10}{9}\\right)$$\n$$x = \\frac{8}{10} = \\frac{4}{5}$$\n因此，我们有 $e^{-2\\beta\\Delta_c} = \\frac{4}{5}$。求解 $\\beta\\Delta_c$：\n$$-2\\beta\\Delta_c = \\ln\\left(\\frac{4}{5}\\right)$$\n$$\\beta\\Delta_c = -\\frac{1}{2}\\ln\\left(\\frac{4}{5}\\right) = \\frac{1}{2}\\ln\\left(\\frac{5}{4}\\right)$$", "answer": "$$\\boxed{\\frac{1}{2}\\ln\\frac{5}{4}}$$", "id": "148940"}]}