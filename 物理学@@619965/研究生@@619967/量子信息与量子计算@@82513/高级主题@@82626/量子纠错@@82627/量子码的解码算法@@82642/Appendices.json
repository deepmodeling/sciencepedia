{"hands_on_practices": [{"introduction": "环面码（toric code）是拓扑量子纠错领域的基石。其解码过程常常可以转化为一个直观的几何问题：在网格上将成对出现的“缺陷”（syndrome）连接起来。本练习将通过一个简单的贪心算法，在一个假设的环面码综合征构型中寻找最小权重（即最短路径）的纠错方案。这个实践旨在为你提供一个关于最小权重完美匹配（Minimum Weight Perfect Matching, MWPM）解码器核心思想的具象化入门。[@problem_id:66247]", "problem": "环面码（toric code）是一种定义在具有周期性边界条件（一个环面）的二维方格晶格上的量子纠错码。量子比特（qubit）放置在晶格的边上。该码由两种类型的算符稳定：对每个顶点 $s$ 的星算符 $A_s = \\prod_{j \\in s} X_j$ 和对每个小方格 $p$ 的格子算符 $B_p = \\prod_{j \\in \\partial p} Z_j$。\n\n量子比特上的泡利 $X$ 错误会导致成对的相邻格子算符在测量时产生-1的结果。这些测量结果为-1的小方格被称为Z-综合征（Z-syndrome）。解码的目标是根据综合征的位置推断出X-错误链，并应用一个由X算符组成的纠正链将状态恢复到码空间。纠正链必须将所有的综合征配对起来。寻找最可能的错误构型的问题，等价于寻找一组将综合征配对且总长度（权重）最小的路径。\n\n考虑一个足够大的 $L \\times L$ 晶格上的环面码。一个错误事件产生了四个Z-综合征，分别位于小方格 $p_1, p_2, p_3, p_4$。这些小方格的中心可以用对偶晶格上的整数坐标 $(x,y)$ 来描述。综合征的位置由 $p_1=(0,0)$, $p_2=(W,0)$, $p_3=(0,H)$ 和 $p_4=(W,H)$ 给出，形成一个矩形。两个综合征之间的距离是它们在对偶晶格上的曼哈顿距离，$d((x_i, y_i), (x_j, y_j)) = |x_i - x_j| + |y_i - y_j|$。这个距离对应于连接这两个小方格的最短X算符链的权重。\n\n一个简单的解码策略是贪心最近对算法。其工作方式如下：\n1.  从所有综合征的集合开始。\n2.  找到尚未配对的综合征中曼哈顿距离最小的一对。\n3.  将这对进行配对。相应纠正链的权重就是这个最小距离。\n4.  从待考虑的综合征集合中移除这对已配对的综合征。\n5.  重复步骤2-4，直到所有综合征都被配对。\n\n如果最近对出现距离相等的情况，则选择满足 $i<j$ 且字典序最前的对 $(p_i, p_j)$。例如，如果 $(p_1, p_3)$ 和 $(p_2, p_4)$ 都是最近对，那么选择 $(p_1, p_3)$，因为 $(1,3)$ 在字典序上先于 $(2,4)$。\n\n给定综合征矩形的尺寸 $W$ 和 $H$，计算由该贪心算法确定的纠正的总权重。对于此问题，使用 $W=3$ 和 $H=1$。", "solution": "1. 综合征坐标：\n   $p_1=(0,0)$, $p_2=(W,0)$, $p_3=(0,H)$, $p_4=(W,H)$，其中 $W=3$, $H=1$。\n2. 计算曼哈顿距离 $d_{ij}=|x_i-x_j|+|y_i-y_j|$：\n   $$d_{12}=|0-3|+|0-0|=3,\\quad d_{13}=|0-0|+|0-1|=1,$$\n   $$d_{14}=|0-3|+|0-1|=4,\\quad d_{23}=|3-0|+|0-1|=4,$$\n   $$d_{24}=|3-3|+|0-1|=1,\\quad d_{34}=|0-3|+|1-1|=3.$$\n3. 最小距离为1，由对 $(p_1,p_3)$ 和 $(p_2,p_4)$ 实现。根据字典序平局决胜规则，我们首先选择 $(p_1,p_3)$。\n   此配对的权重：$d_{13}=1$。\n4. 移除 $p_1, p_3$。剩下的综合征 $p_2, p_4$ 之间的距离为 $d_{24}=1$。\n   此配对的权重：$1$。\n5. 总纠正权重 $=1+1=2$。", "answer": "$$\\boxed{2}$$", "id": "66247"}, {"introduction": "在几何模型之外，另一大类强大的解码算法基于图论和概率推理。和积算法（sum-product algorithm），作为置信度传播（Belief Propagation, BP）的一种形式，是一种在 Tanner 图上通过局部信息交换来迭代计算后验错误概率的有效技术。本练习将带你深入经典的 Steane 码，亲手计算置信度传播算法在一次完整迭代中的消息更新过程，从而揭示“信念”是如何在解码网络中形成与传播的。[@problem_id:66341]", "problem": "Steane 码是一种 `[[7, 1, 3]]` 量子纠错码。其纠错性能源自经典的 `[7, 4, 3]` 汉明码。在纠正比特翻转 ($X$) 错误时，需要测量与该经典码的奇偶校验相对应的校正子。其任务是根据校正子和信道错误概率，找到最可能的错误模式，这项任务可以使用经典解码算法来完成。\n\n考虑使用和积算法（置信度传播的一种形式）进行解码。该算法在码的 Tanner 图上运行。设经典码由其奇偶校验矩阵 $H$ 定义，其中行对应校验节点 ($c_j$)，列对应变量节点 ($v_i$)。如果 $H_{ji}=1$，则在 $c_j$ 和 $v_i$ 之间存在一条边。\n\n该算法通过在 Tanner 图的边上传递消息来进行工作，这些消息表示为对数似然比 (LLR)。对于一个二进制变量 $x$，其 LLR 定义为 $L(x) = \\log(P(x=0)/P(x=1))$。设 $L_{ch,i}$ 是由信道给出的变量 $v_i$ 的初始 LLR。\n\n消息是迭代更新的。\n-   初始的变量到校验节点的消息由信道给出：$L(q_{i \\to j})^{(0)} = L_{ch,i}$。\n-   在迭代 $t \\ge 1$ 中，从校验节点 $c_j$ 到变量节点 $v_i$ 的消息更新如下：\n    $$ L(r_{j \\to i})^{(t)} = 2 \\tanh^{-1} \\left( \\prod_{k \\in N(j) \\setminus \\{i\\}} \\tanh\\left(\\frac{L(q_{k \\to j})^{(t-1)}}{2}\\right) \\right) $$\n    其中 $N(j)$ 是连接到校验节点 $j$ 的变量节点的索引集合。\n-   然后，从变量节点 $v_i$ 到校验节点 $c_j$ 的消息更新如下：\n    $$ L(q_{i \\to j})^{(t)} = L_{ch,i} + \\sum_{k \\in N(i) \\setminus \\{j\\}} L(r_{k \\to i})^{(t)} $$\n    其中 $N(i)$ 是连接到变量节点 $i$ 的校验节点的索引集合。\n\n设与 Steane 码相关联的经典码的奇偶校验矩阵为：\n$$ H = \\begin{pmatrix} 0 & 0 & 0 & 1 & 1 & 1 & 1 \\\\ 0 & 1 & 1 & 0 & 0 & 1 & 1 \\\\ 1 & 0 & 1 & 0 & 1 & 0 & 1 \\end{pmatrix} $$\n行由 $j \\in \\{1, 2, 3\\}$ 索引，列由 $i \\in \\{1, 2, ..., 7\\}$ 索引。假设信道产生的错误使得初始 LLR 为 $L_{ch,i} = L_A$（对于 $i \\in \\{1, 2, 3, 4, 5, 6\\}$）和 $L_{ch,7} = L_B$。\n\n计算和积算法一次完整迭代后的变量到校验节点消息 $L(q_{3 \\to 2})^{(1)}$。请用 $L_A$ 和 $L_B$ 的函数表示你的答案。", "solution": "奇偶校验矩阵 $H$ 如下所示：\n\n$$\nH = \\begin{pmatrix}\n0 & 0 & 0 & 1 & 1 & 1 & 1 \\\\\n0 & 1 & 1 & 0 & 0 & 1 & 1 \\\\\n1 & 0 & 1 & 0 & 1 & 0 & 1\n\\end{pmatrix}\n$$\n\n其行（校验节点）由 $j \\in \\{1, 2, 3\\}$ 索引，列（变量节点）由 $i \\in \\{1, 2, \\dots, 7\\}$ 索引。初始 LLR 为 $L_{\\text{ch},i} = L_A$（对于 $i \\in \\{1, 2, 3, 4, 5, 6\\}$）和 $L_{\\text{ch},7} = L_B$。\n\n目标是计算一次完整迭代后的变量到校验节点消息 $L(q_{3 \\to 2})^{(1)}$。该消息更新如下：\n\n$$\nL(q_{i \\to j})^{(t)} = L_{\\text{ch},i} + \\sum_{k \\in N(i) \\setminus \\{j\\}} L(r_{k \\to i})^{(t)}\n$$\n\n其中 $N(i)$ 是连接到变量节点 $i$ 的校验节点的集合。\n\n对于变量节点 $i = 3$，其连接由 $H$ 矩阵第 3 列中的非零项确定：\n- 第 3 列在第 2 行和第 3 行处为 1，所以 $N(3) = \\{2, 3\\}$。\n\n因此，对于发送到校验节点 $j = 2$ 的消息：\n\n$$\nL(q_{3 \\to 2})^{(1)} = L_{\\text{ch},3} + \\sum_{k \\in N(3) \\setminus \\{2\\}} L(r_{k \\to 3})^{(1)}\n$$\n\n排除 $j = 2$ 后，求和仅对 $k \\in \\{3\\}$ 进行（因为 $N(3) \\setminus \\{2\\} = \\{3\\}$）。因此：\n\n$$\nL(q_{3 \\to 2})^{(1)} = L_A + L(r_{3 \\to 3})^{(1)}\n$$\n\n因为 $L_{\\text{ch},3} = L_A$。\n\n现在，计算 $L(r_{3 \\to 3})^{(1)}$，即从校验节点 3 到变量节点 3 的校验到变量节点消息。更新规则为：\n\n$$\nL(r_{j \\to i})^{(t)} = 2 \\tanh^{-1} \\left( \\prod_{k \\in N(j) \\setminus \\{i\\}} \\tanh\\left( \\frac{L(q_{k \\to j})^{(t-1)}}{2} \\right) \\right)\n$$\n\n其中 $N(j)$ 是连接到校验节点 $j$ 的变量节点的集合。\n\n对于校验节点 $j = 3$，其连接由 $H$ 矩阵第 3 行中的非零项确定：\n- 第 3 行在第 1、3、5、7 列处为 1，所以 $N(3) = \\{1, 3, 5, 7\\}$。\n\n因此，对于发送到变量节点 $i = 3$ 的消息：\n\n$$\nL(r_{3 \\to 3})^{(1)} = 2 \\tanh^{-1} \\left( \\prod_{k \\in N(3) \\setminus \\{3\\}} \\tanh\\left( \\frac{L(q_{k \\to 3})^{(0)}}{2} \\right) \\right)\n$$\n\n排除 $i = 3$ 后，乘积对 $k \\in \\{1, 5, 7\\}$ 进行。\n\n$t = 0$ 时的初始变量到校验节点消息为 $L(q_{k \\to j})^{(0)} = L_{\\text{ch},k}$：\n- 对于 $k = 1$：$L(q_{1 \\to 3})^{(0)} = L_{\\text{ch},1} = L_A$\n- 对于 $k = 5$：$L(q_{5 \\to 3})^{(0)} = L_{\\text{ch},5} = L_A$\n- 对于 $k = 7$：$L(q_{7 \\to 3})^{(0)} = L_{\\text{ch},7} = L_B$\n\n将这些代入乘积中：\n\n$$\n\\prod_{k \\in \\{1, 5, 7\\}} \\tanh\\left( \\frac{L(q_{k \\to 3})^{(0)}}{2} \\right) = \\tanh\\left( \\frac{L_A}{2} \\right) \\cdot \\tanh\\left( \\frac{L_A}{2} \\right) \\cdot \\tanh\\left( \\frac{L_B}{2} \\right) = \\left[ \\tanh\\left( \\frac{L_A}{2} \\right) \\right]^2 \\tanh\\left( \\frac{L_B}{2} \\right)\n$$\n\n\n因此：\n\n$$\nL(r_{3 \\to 3})^{(1)} = 2 \\tanh^{-1} \\left( \\left[ \\tanh\\left( \\frac{L_A}{2} \\right) \\right]^2 \\tanh\\left( \\frac{L_B}{2} \\right) \\right)\n$$\n\n\n现在将其代回到 $L(q_{3 \\to 2})^{(1)}$ 的表达式中：\n\n$$\nL(q_{3 \\to 2})^{(1)} = L_A + 2 \\tanh^{-1} \\left( \\left[ \\tanh\\left( \\frac{L_A}{2} \\right) \\right]^2 \\tanh\\left( \\frac{L_B}{2} \\right) \\right)\n$$\n\n\n这就是一次完整迭代后消息的最终表达式。", "answer": "$$\n\\boxed{L_A + 2 \\tanh^{-1} \\left( \\tanh^{2} \\left( \\frac{L_A}{2} \\right) \\tanh \\left( \\frac{L_B}{2} \\right) \\right)}\n$$", "id": "66341"}, {"introduction": "解码并非总是完美的，理解其失败模式与理解其成功机制同样重要。一个局部最优的纠错决策，有时可能导致全局性的逻辑错误。本练习将探讨一个关键情景：一个最小权重解码器在处理 Steane 码上的一个简单双量子比特错误时，会选择一个看似最优的单量子比特纠错操作。然而，我们将看到，这个局部最优选择将导致一个更严重且无法纠正的逻辑错误，这深刻揭示了设计稳健解码器所面临的根本挑战。[@problem_id:66362]", "problem": "量子计算中的一个重要任务是纠正损坏量子态的错误。[[7,1,3]] Steane 码是一种著名的量子纠错码，它将一个逻辑量子比特编码到七个物理量子比特中，并能纠正任何单量子比特错误。它是一种由一组稳定子生成元定义的 CSS 码。对于本问题，我们将使用以下标准稳定子生成元集：\n三个 X 型稳定子是：\n$S_1^X = X_1 X_3 X_5 X_7$\n$S_2^X = X_2 X_3 X_6 X_7$\n$S_3^X = X_4 X_5 X_6 X_7$\n\n以及三个 Z 型稳定子是：\n$S_1^Z = Z_1 Z_3 Z_5 Z_7$\n$S_2^Z = Z_2 Z_3 Z_6 Z_7$\n$S_3^Z = Z_4 Z_5 Z_6 Z_7$\n\n这里，$X_i, Y_i, Z_i$ 是作用在第 $i$ 个量子比特上的泡利算符，索引从 1 到 7。\n\n假设编码后的量子态受到了一个由算符 $E = X_1 X_2$ 给出的权重为 2 的泡利 X 错误。为了纠正这个错误，应用以下步骤：\n1. 测量 Z 型稳定子（$S_1^Z, S_2^Z, S_3^Z$）。测量 $S_j^Z$ 的结果是 $m_j \\in \\{+1, -1\\}$。经典校正子是一个比特串 $s = (s_1, s_2, s_3)$，其中 $s_j = (1-m_j)/2$。如果错误 $E$ 与 $S_j^Z$ 反对易，则产生校正子比特 $s_j=1$；如果它们对易，则 $s_j=0$。\n2. 使用解码算法从校正子 $s$ 推断出纠正算符 $C$。我们考虑的算法是一种贪心算法：它找出能产生观测到的校正子 $s$ 且具有最小可能汉明权重的泡利 X 算符 $C$。一个泡利算符的汉明权重是它非平凡地（即，非单位算符 $I$）作用的量子比特的数量。\n3. 将纠正算符 $C$ 应用于系统。\n\n此过程后的残留错误由算符 $E_{res} = C E$ 给出。这个残留错误可能不是单位算符，这意味着纠正未成功。\n\n你的任务是计算残留错误算符 $E_{res}$ 的汉明权重。", "solution": "错误算符是 $E = X_1 X_2$。Z 型稳定子及其校正子比特计算如下：\n\n- $S_1^Z = Z_1 Z_3 Z_5 Z_7$：$E$ 和 $S_1^Z$ 都非平凡地作用于量子比特 1。由于 $X$ 和 $Z$ 反对易，并且有一个共同的量子比特（奇数个），所以它们反对易。因此，$s_1 = 1$。\n- $S_2^Z = Z_2 Z_3 Z_6 Z_7$：$E$ 和 $S_2^Z$ 都非平凡地作用于量子比特 2。由于有一个共同的量子比特（奇数个），所以它们反对易。因此，$s_2 = 1$。\n- $S_3^Z = Z_4 Z_5 Z_6 Z_7$：$E$ 作用于量子比特 1 和 2，而 $S_3^Z$ 作用于量子比特 4、5、6 和 7。没有共同的量子比特，所以它们对易。因此，$s_3 = 0$。\n\n校正子是 $s = (1, 1, 0)$。纠正算符 $C$ 是能产生此校正子的最小汉明权重的泡利 X 算符。用一个二进制向量 $(v_1, v_2, \\dots, v_7)$ 表示 $C$，其中如果包含 $X_i$，则 $v_i = 1$，否则 $v_i = 0$。校正子方程为：\n\n- $v_1 + v_3 + v_5 + v_7 \\equiv 1 \\pmod{2}$ (来自 $s_1 = 1$)\n- $v_2 + v_3 + v_6 + v_7 \\equiv 1 \\pmod{2}$ (来自 $s_2 = 1$)\n- $v_4 + v_5 + v_6 + v_7 \\equiv 0 \\pmod{2}$ (来自 $s_3 = 0$)\n\n按汉明权重搜索解：\n\n- 权重 0：$(0,0,0,0,0,0,0)$ 给出校正子 $(0,0,0)$，而不是 $(1,1,0)$。\n- 权重 1：测试只有一个 $v_i = 1$ 的向量：\n  - $(1,0,0,0,0,0,0)$：$1+0+0+0=1$, $0+0+0+0=0 \\neq 1$ — 无效。\n  - $(0,1,0,0,0,0,0)$：$0+0+0+0=0 \\neq 1$, $1+0+0+0=1$ — 无效。\n  - $(0,0,1,0,0,0,0)$：$0+1+0+0=1$, $0+1+0+0=1$, $0+0+0+0=0$ — 有效。\n  - $(0,0,0,1,0,0,0)$：$0+0+0+0=0 \\neq 1$ — 无效。\n  - $(0,0,0,0,1,0,0)$：$0+0+1+0=1$, $0+0+0+0=0 \\neq 1$ — 无效。\n  - $(0,0,0,0,0,1,0)$：$0+0+0+0=0 \\neq 1$, $0+0+1+0=1$ — 无效。\n  - $(0,0,0,0,0,0,1)$：$0+0+0+1=1$, $0+0+0+1=1$, $0+0+0+1=1 \\neq 0$ — 无效。\n  只有 $(0,0,1,0,0,0,0)$（即 $C = X_3$）有效，其权重为 1。\n\n因为存在权重为 1 的解，所以最小权重是 1，且 $C = X_3$。残留错误为：\n\n$$\nE_{\\text{res}} = C E = X_3 (X_1 X_2) = X_1 X_2 X_3.\n$$\n\n汉明权重是非单位因子的数量，即 3（量子比特 1、2 和 3）。", "answer": "$$ \\boxed{3} $$", "id": "66362"}]}