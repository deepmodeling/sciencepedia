{"hands_on_practices": [{"introduction": "零噪声外推（Zero-Noise Extrapolation, ZNE）是一种直观的错误缓解方法，它通过将量子硬件视为一个“黑箱”来估计无噪声的理想结果。其核心思想是有控制地放大电路中的噪声，观察可观测量期望值的变化趋势，然后将结果外推回噪声为零的极限。这个练习 [@problem_id:121292] 提供了一个具体的实例，你将通过对一个 CNOT 门引入的噪声进行线性外推，来亲手计算并获得一个更高保真度的结果。", "problem": "零噪声外推（ZNE）是一种量子误差缓解技术，用于估计可观测量的理想无噪声期望值。这是通过以可控的方式系统性地放大量子电路中的噪声，测量不同噪声水平下的期望值，然后将结果外推至零噪声极限来实现的。\n\n对于一个门 $U$，一种常见的噪声放大方法是将其替换为序列 $U(U^\\dagger U)^k$，其中整数 $k \\ge 0$。该序列在逻辑上等效于 $U$，但总共包含 $c=2k+1$ 个门，从而放大了与每次门应用相关的噪声。对于 CNOT 门，其幺正算符 $U_{CNOT}$ 是自伴的（$U_{CNOT}^\\dagger = U_{CNOT}$），因此该过程对应于将单个 CNOT 门替换为一个由 $c=2k+1$ 个 CNOT 门组成的序列。\n\n考虑从初态 $|00\\rangle$ 制备双量子比特贝尔态 $|\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$。该电路由一个作用于第一个量子比特的理想 Hadamard 门，以及一个以第一个量子比特为控制位、第二个量子比特为目标位的 CNOT 门组成。\n\nCNOT 门受到一个退极化噪声模型的影响。每次 CNOT 门的应用由量子通道 $\\mathcal{N}(\\rho)$ 描述，定义如下：\n$$ \\mathcal{N}(\\rho) = (1-p) U_{CNOT} \\rho U_{CNOT}^\\dagger + p \\frac{I_4}{4} $$\n其中 $p$ 是错误概率，$\\rho$ 是双量子比特态， $I_4$ 是双量子比特单位矩阵。\n\n为了缓解误差，我们使用上述的 ZNE 过程。电路中的单个 CNOT 门被 $c$ 次含噪声 CNOT 通道 $\\mathcal{N}$ 的顺序应用所替代，其中 $c$ 是放大因子。然后测量所得末态 $\\rho_{final}(c)$ 与理想贝尔态 $|\\Phi^+\\rangle$ 的保真度。该保真度由 $F(c) = \\langle\\Phi^+ | \\rho_{final}(c) | \\Phi^+\\rangle$ 给出。\n\n假设在放大因子 $c=1$ 和 $c=3$ 下测得的保真度分别为 $F_1$ 和 $F_3$。使用线性外推模型 $F_{extrap}(c) = ac + b$，确定零噪声外推保真度 $F_0 = F_{extrap}(0)$。将您的答案表示为错误概率 $p$ 的函数。", "solution": "1. 经过一个含噪声 CNOT 门后的保真度：\n   将理想 CNOT 门前的量子态表示为 $\\rho_{in}$。理想操作后的态为 $\\ket{\\Phi^+}\\bra{\\Phi^+}$。由于噪声发生在 CNOT 门上，因此经过一个噪声门后的态为 $\\rho_1=\\mathcal{N}(\\rho_{in})=(1-p)U_{CNOT}\\rho_{in}U_{CNOT}^\\dagger+p\\frac{I_4}{4}=(1-p)\\ket{\\Phi^+}\\bra{\\Phi^+}+p\\frac{I_4}{4}$。\n   $$F_1=\\bra{\\Phi^+}\\rho_1\\ket{\\Phi^+}=(1-p)\\cdot1+p\\cdot\\frac14=1-\\frac{3p}{4}.$$\n\n2. 经过三个含噪声 CNOT 门后的保真度：\n   当 $c=3$ 时，电路包含三次连续的含噪 CNOT 通道应用。\n   第一次应用后的态为 $\\rho_1$。\n   第二次应用后的态为 $\\rho_2=\\mathcal{N}(\\rho_1)=(1-p)U_{CNOT}\\,\\rho_1\\,U_{CNOT}^\\dagger+p\\frac{I_4}{4}$。\n   分解 $U_{CNOT}\\rho_1U_{CNOT}^\\dagger=(1-p)\\ket{\\psi_1}\\bra{\\psi_1}+p\\frac{I_4}{4}$，其中 $\\ket{\\psi_1}=U_{CNOT}\\ket{\\Phi^+}$ 且 $|\\langle\\Phi^+|\\psi_1\\rangle|^2=\\frac{1}{4}$。可得\n   $$\\rho_2=(1-p)^2\\ket{\\psi_1}\\bra{\\psi_1}+p(2-p)\\frac{I_4}{4}.$$\n   第三次应用后的态为 $\\rho_3=\\mathcal{N}(\\rho_2)=(1-p)U_{CNOT}\\rho_2U_{CNOT}^\\dagger+p\\frac{I_4}{4}$。\n   由于 $U_{CNOT}\\ket{\\psi_1}=\\ket{\\Phi^+}$，因此\n   $$U_{CNOT}\\rho_2U_{CNOT}^\\dagger = (1-p)^2 \\ket{\\Phi^+}\\bra{\\Phi^+} + p(2-p)\\frac{I_4}{4}.$$\n   所以，$\\rho_3=(1-p)^3\\ket{\\Phi^+}\\bra{\\Phi^+}+\\left((1-p)p(2-p)+p\\right)\\frac{I_4}{4}=(1-p)^3\\ket{\\Phi^+}\\bra{\\Phi^+}+(3p-3p^2+p^3)\\frac{I_4}{4}.$\n   于是保真度为\n   $$F_3=(1-p)^3+(3p-3p^2+p^3)\\frac14\n          =\\frac{4-9p+9p^2-3p^3}{4}.$$\n\n3. 线性外推 $F_{extrap}(c)=ac+b$，其中\n   $$F_1=a+b,\\quad F_3=3a+b\\;\\Longrightarrow\\;b=\\frac{3F_1-F_3}{2}.$$\n   零噪声外推值 $F_0 = F_{extrap}(0) = b$。因此\n   $$F_0=b=\\frac{3\\left(1-\\frac{3p}{4}\\right)-\\frac{4-9p+9p^2-3p^3}{4}}{2}\n           =\\frac{\\frac{12-9p}{4}-\\frac{4-9p+9p^2-3p^3}{4}}{2}=\\frac{8-9p^2+3p^3}{8}.$$", "answer": "$$\\boxed{\\frac{8-9p^2+3p^3}{8}}$$", "id": "121292"}, {"introduction": "与 ZNE 的“黑箱”方法不同，另一类强大的错误缓解技术基于对噪声的精确表征和反演。其思路是，如果我们能构建一个精确的噪声信道模型（例如，通过其泡利传输矩阵），我们就可以在数据后处理中计算出其影响的逆过程。这个练习 [@problem_id:121311] 将引导你完成一个从表征到缓解的完整工作流程：首先使用泡利整流（Pauli-twirling）实验来学习噪声信道的本征值，然后利用这些信息来校正最终的测量结果。", "problem": "一位熟练的实验物理学家正在表征一个有噪声的双量子比特CNOT门，该门由量子通道 $\\mathcal{G}$ 表示。该门被建模为一个理想的CNOT操作 $\\mathcal{C}$，随后是一个相关的泡利误差通道 $\\mathcal{E}$。因此，完整的通道为 $\\mathcal{G} = \\mathcal{E} \\circ \\mathcal{C}$。\n\n双量子比特泡利群由16个算符 $P_k \\in \\{I, X, Y, Z\\}^{\\otimes 2}$ 组成，由 $k \\in \\{I,X,Y,Z\\}^2$ 索引。例如，$P_{IX} = I \\otimes X$。泡利误差通道 $\\mathcal{E}$ 通过其对任意密度矩阵 $\\rho$ 的作用来定义：\n$$\n\\mathcal{E}(\\rho) = \\sum_{j \\in \\{I,X,Y,Z\\}^2} p_j P_j \\rho P_j\n$$\n其中 $p_j$ 是满足 $\\sum_j p_j = 1$ 的概率。泡利通道的一个关键性质是它将泡利算符映射为自身的标量倍：$\\mathcal{E}(P_k) = \\lambda_k P_k$。这16个本征值的集合 $\\{\\lambda_k\\}$ 完全表征了该泡利通道，其中 $\\lambda_{II}=1$。\n\n为了确定15个非平凡本征值 $\\{\\lambda_k\\}_{k \\neq II}$，该实验物理学家进行了一系列泡利旋转实验。对于每个非单位输入泡利算符 $P_k$，他们测量一个值 $\\Lambda_k$，该值对应于 $P_k$ 通过门后的“存活概率”，但测量是在由理想CNOT定义的旋转基中进行的。具体来说，他们测量：\n$$\n\\Lambda_k = \\frac{1}{4} \\text{Tr}[P'_k \\mathcal{G}(P_k)] \\quad \\text{其中} \\quad P'_k = \\mathcal{C}(P_k) = U_{\\text{CNOT}} P_k U_{\\text{CNOT}}^\\dagger\n$$\n这个测量直接给出了与*输出*泡利算符相关的误差通道的本征值，即 $\\Lambda_k = \\lambda_{P'_k}$。\n\n发现理想CNOT门 $\\mathcal{C}$ 在非单位泡利算符集合上实现以下置换：\n- $\\sigma(IX) = XX$ 且 $\\sigma(XX) = IX$\n- $\\sigma(IY) = XY$ 且 $\\sigma(XY) = IY$\n- $\\sigma(IZ) = IZ$\n- $\\sigma(XI) = YI$ 且 $\\sigma(YI) = XI$\n- $\\sigma(XZ) = YZ$ 且 $\\sigma(YZ) = XZ$\n- $\\sigma(YX) = ZX$ 且 $\\sigma(ZX) = YX$\n- $\\sigma(YY) = ZY$ 且 $\\sigma(ZY) = YY$\n- $\\sigma(ZI) = ZZ$ 且 $\\sigma(ZZ) = ZI$\n所有其他未在 $\\sigma$ 的输入中列出的泡利算符（即 $XZ, YZ, \\dots$）也根据此列表进行映射。例如，由于 $\\sigma(XZ) = YZ$，这也意味着对 YZ 的映射为 $\\sigma(YZ)=XZ$。\n\n对于每个输入泡利算符 $P_k$，测得的 $\\Lambda_k$ 值的实验结果为 $\\Lambda_k = 1 - \\delta_k$。参数 $\\delta_k$ 代表微小的误差，并对每个 $k$ 使用不同的符号给出：$\\delta_{IX}, \\delta_{IY}, \\delta_{IZ}, \\dots, \\delta_{ZZ}$。\n\n最后，运行一个量子算法，它制备一个特定的初始态，并应用有噪声的CNOT门 $\\mathcal{G}$。在算法结束时，测量可观测量 $O = YZ$ 的期望值，得到原始（未经缓解的）值为 $\\langle YZ \\rangle_{\\text{raw}} = \\eta$。\n\n您的任务是使用提供的表征数据来计算经误差缓解后的期望值 $\\langle YZ \\rangle_{\\text{mit}}$。该值表示在没有误差通道 $\\mathcal{E}$ 的情况下本应测量到的理想期望值。", "solution": "1. 噪声通道 $\\mathcal{G}=\\mathcal{E}\\circ\\mathcal{C}$ 作用于泡利算符 $P_k$ 上。由于 $\\mathcal{E}$ 是一个泡利通道，它将泡利算符映射为自身的标量倍：\n$$\n\\mathcal{E}(P_k)=\\lambda_kP_k,\n$$\n其中 $\\lambda_k$ 是误差通道 $\\mathcal{E}$ 关于泡利算符 $P_k$ 的本征值。\n\n2. 实验测量值为：\n$$\n\\Lambda_k=\\frac14\\Tr\\bigl[P'_k \\mathcal{G}(P_k)\\bigr] = \\frac14\\Tr\\bigl[P'_k (\\mathcal{E} \\circ \\mathcal{C})(P_k)\\bigr] = \\frac14\\Tr\\bigl[P'_k \\mathcal{E}(P'_k)\\bigr],\n$$\n其中 $P'_k=\\mathcal{C}(P_k)$。由于 $\\mathcal{E}(P'_k) = \\lambda_{P'_k} P'_k$ 且 $\\frac{1}{4}\\text{Tr}((P'_k)^2) = 1$，我们得到：\n$$\n\\Lambda_k=\\lambda_{P'_k}.\n$$\n实验结果为 $\\Lambda_k=1-\\delta_k$，因此我们学习到了误差通道的本征值：\n$$\n\\lambda_{P'_k}=1-\\delta_k.\n$$\n3. 对于一个可观测量 $O$（它是一个泡利算符），原始测量值与理想值的关系为：\n$$\n\\langle O\\rangle_{\\rm raw} = \\text{Tr}[O \\mathcal{E}(\\rho_{ideal})] = \\text{Tr}[\\mathcal{E}(O) \\rho_{ideal}] = \\text{Tr}[\\lambda_O O \\rho_{ideal}] = \\lambda_O \\langle O \\rangle_{\\rm ideal}.\n$$\n在我们的例子中，$O = YZ$，所以\n$$\n\\langle YZ\\rangle_{\\rm raw} = \\eta = \\lambda_{YZ}\\,\\langle YZ\\rangle_{\\rm ideal}.\n$$\n4. 为了找到 $\\lambda_{YZ}$，我们需要找到一个输入泡利算符 $P_k$，使得它的像 $P'_k = \\mathcal{C}(P_k)$ 等于 $YZ$。查阅给定的CNOT置换表 $\\sigma$，我们发现 $\\sigma(XZ)=YZ$。这意味着当我们使用输入 $P_k=XZ$ 进行表征时，我们测量的 $\\Lambda_{XZ}$ 实际上给出了 $\\lambda_{YZ}$ 的值。\n$$\n\\lambda_{YZ}=\\Lambda_{XZ}=1-\\delta_{XZ}.\n$$\n5. 因此，缓解后的期望值为：\n$$\n\\langle YZ\\rangle_{\\rm mit} = \\langle YZ\\rangle_{\\rm ideal}\n=\\frac{\\langle YZ\\rangle_{\\rm raw}}{\\lambda_{YZ}}\n=\\frac{\\eta}{1-\\delta_{XZ}}.\n$$", "answer": "$$\\boxed{\\frac{\\eta}{1-\\delta_{XZ}}}$$", "id": "121311"}, {"introduction": "量子子空间展开（Quantum Subspace Expansion, QSE）提供了另一种独特的错误缓解视角。它不直接反演噪声，而是通过在一个精心构造的低维子空间中对角化哈密顿量，来寻找真实基态能量的更优近似。这个子空间被设计用来捕捉对含噪初态最重要的修正。在本练习 [@problem_id:121253] 中，你将通过构建并求解一个广义本征值问题，来亲身体验 QSE 如何能够从充满噪声的实验数据中恢复出理想的能量值。", "problem": "一位实验物理学家正在研究一个双量子比特系统，其哈密顿量为 $H = J X_1 X_2 + h Z_1$，其中 $X_i, Y_i, Z_i$ 是量子比特 $i$ 的标准泡利算符，$J, h$ 是实数耦合常数。目标是使用量子子空间展开 (QSE) 误差缓解技术来确定该系统的基态能量。\n\n这位实验物理学家制备了一个含噪声的量子态 $\\rho$，它是真实基态的一个近似。为了缓解误差，哈密顿量在一个子空间内被对角化，该子空间由一组算符 $\\{O_1, O_2, O_3\\}$ 作用于含噪声的量子态所张成。这个过程导出一个形式为 $\\mathbf{H} \\mathbf{v} = E \\mathbf{S} \\mathbf{v}$ 的广义本征值问题 (GEP)，其中矩阵元由 $H_{ij} = \\text{Tr}(\\rho O_i^\\dagger H O_j)$ 和 $S_{ij} = \\text{Tr}(\\rho O_i^\\dagger O_j)$ 给出。该广义本征值问题的最低本征值 $E$ 提供了基态能量的一个经过误差缓解的估计值。\n\n展开所用的基底选为 $\\{O_1, O_2, O_3\\}$，其中 $O_1 = I$ (单位算符)，$O_2 = H$，$O_3 = X_1 Y_2$。这三个算符都是厄米的。\n\n实验物理学家测量了必要的期望值，这些值受到由参数 $p \\in [0, 1)$ 表征的某些噪声的影响。以 $J$、$h$ 和 $p$ 表示的测量值如下：\n令 $E_0 \\equiv \\sqrt{J^2+h^2}$。测得的期望值 $\\langle A \\rangle \\equiv \\text{Tr}(\\rho A)$ 为：\n- $\\langle I \\rangle = 1$\n- $\\langle H \\rangle = -(1-p)E_0$\n- $\\langle H^2 \\rangle = E_0^2$\n- $\\langle H^3 \\rangle = -(1-p)E_0^3$\n- $\\langle X_1 Y_2 \\rangle = 0$\n- $\\langle (X_1 Y_2)^2 \\rangle = 1$\n- $\\langle H X_1 Y_2 \\rangle = 0$\n- $\\langle H^2 X_1 Y_2 \\rangle = 0$\n- $\\langle (X_1 Y_2) H (X_1 Y_2) \\rangle = (1-p)E_0$\n\n所有其他所需的矩阵元，例如 $\\langle O_i^\\dagger O_j \\rangle$ 和 $\\langle O_i^\\dagger H O_j \\rangle$，都可以从此列表中推导出来（例如，由于期望值为实数，$\\langle O_j^\\dagger O_i \\rangle = \\langle O_i^\\dagger O_j \\rangle^*$）。\n\n你的任务是通过建立并求解该广义本征值问题来计算经过误差缓解的基态能量。请用 $J$ 和 $h$ 表示你的最终答案。", "solution": "我们在基 $\\{O_1=I, O_2=H, O_3=X_1Y_2\\}$ 中进行计算。定义 $E_0=\\sqrt{J^2+h^2}$。根据给定的期望值，可以得到\n\n1. 重叠矩阵 $S_{ij}=\\langle O_i^\\dagger O_j\\rangle$：\n$$\nS=\\begin{pmatrix}\n\\langle I\\rangle  \\langle H\\rangle  \\langle X_1Y_2\\rangle\\\\\n\\langle H\\rangle  \\langle H^2\\rangle  \\langle H\\,X_1Y_2\\rangle\\\\\n\\langle X_1Y_2\\rangle  \\langle X_1Y_2\\,H\\rangle  \\langle (X_1Y_2)^2\\rangle\n\\end{pmatrix}\n=\\begin{pmatrix}\n1  -(1-p)E_0  0\\\\\n-(1-p)E_0  E_0^2  0\\\\\n0  0  1\n\\end{pmatrix}.\n$$\n\n2. 哈密顿量矩阵 $H_{ij}=\\langle O_i^\\dagger\\,H\\,O_j\\rangle$：\n$$\nH=\\begin{pmatrix}\n\\langle H\\rangle  \\langle H^2\\rangle  \\langle H\\,X_1Y_2\\rangle\\\\\n\\langle H^2\\rangle  \\langle H^3\\rangle  \\langle H^2\\,X_1Y_2\\rangle\\\\\n\\langle X_1Y_2\\,H\\rangle  \\langle X_1Y_2\\,H^2\\rangle  \\langle X_1Y_2\\,H\\,X_1Y_2\\rangle\n\\end{pmatrix}\n=\\begin{pmatrix}\n-(1-p)E_0  E_0^2  0\\\\\nE_0^2  -(1-p)E_0^3  0\\\\\n0  0  (1-p)E_0\n\\end{pmatrix}.\n$$\n\n3. 广义本征值问题 $\\mathbf{H}\\mathbf{v}=E\\mathbf{S}\\mathbf{v}$ 因矩阵的块对角结构而解耦。\n(a) 一个在 $\\{O_1,H\\}$ 上的 $2\\times2$ 子问题。\n(b) 一个在 $\\{O_3\\}$ 上的 $1\\times1$ 子问题，给出 $H_{33} = E S_{33} \\implies (1-p)E_0 = E \\cdot 1$，因此一个本征值为 $E=(1-p)E_0$。\n\n对于 $2\\times2$ 子块，我们求解 $\\det\\bigl(H_{sub}-E\\,S_{sub}\\bigr)=0$：\n$$\n\\det\\begin{pmatrix} -(1-p)E_0-E  E_0^2+E(1-p)E_0 \\\\ E_0^2+E(1-p)E_0  -(1-p)E_0^3-E E_0^2 \\end{pmatrix} = 0\n$$\n$$\n\\det\\begin{pmatrix} -( (1-p)E_0+E )  E_0(E_0+E(1-p)) \\\\ E_0(E_0+E(1-p))  -E_0^2( (1-p)E_0+E ) \\end{pmatrix} = 0\n$$\n$$\nE_0^2((1-p)E_0+E)^2 - E_0^2(E_0+E(1-p))^2 = 0\n$$\n假设 $E_0 \\neq 0$，我们有 $((1-p)E_0+E)^2 = (E_0+E(1-p))^2$。\n这给出两个可能性：$E-E_0=0$ 或 $E+E_0=0$（假设 $p \\in (0,1)$）。\n因此，本征值为 $E=\\pm E_0$。\n\n综上，三个本征值为 $\\{-E_0,\\,+E_0,\\,(1-p)E_0\\}$。基态能量是最低的本征值。因为 $E_0=\\sqrt{J^2+h^2}>0$ 且 $p \\in [0, 1)$，所以 $(1-p)E_0 \\ge 0$。因此最低的本征值是\n$$E_{\\rm min}=-E_0=-\\sqrt{J^2+h^2}. $$", "answer": "$$\\boxed{-\\sqrt{J^2 + h^2}}$$", "id": "121253"}]}