{"hands_on_practices": [{"introduction": "量子干涉是线性光学量子计算的核心，其中最著名的例子是 Hong-Ou-Mandel 效应。理想的量子干涉要求光子在所有自由度上都是完全不可分辨的，但这在实验中是一个巨大的挑战。本练习 [@problem_id:107142] 探讨了一个更贴近现实的场景：当光子部分可分辨时，多光子干涉会受到怎样的影响。通过计算一个玻色子取样实验中特定输出的概率，你将亲身体会到光子不可分辨性对于维持计算优势的关键作用。", "problem": "在一个玻色子采样实验中，三个光子被注入一个对称的三端口干涉仪，每个输入端口一个光子。该干涉仪，被称为三分束器 (tritter)，由 3x3 幺正矩阵 $U$ 描述，该矩阵是离散傅里叶变换矩阵：\n$$ U = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1  1  1 \\\\ 1  \\omega  \\omega^2 \\\\ 1  \\omega^2  \\omega \\end{pmatrix} $$\n其中 $\\omega = e^{i2\\pi/3}$。\n\n输入态被制备为在三个输入模式中各有一个光子。进入输入模式 1 和 2 的光子在所有方面都是全同的。进入输入模式 3 的光子在除了其时间分布之外的所有性质上均与其它光子相同。相对于另外两个光子，它被制备时带有一个时间延迟 $\\tau$。\n\n光子的时间波包被建模为特征时间宽度为 $\\sigma_t$ 的归一化高斯函数。光子 1 和 2 的时间波包是 $\\psi_0(t)$，光子 3 的是 $\\psi_0(t-\\tau)$。延迟波包和未延迟波包之间的重叠由实数参数 $g$ 给出，$g = \\langle\\psi_0|\\psi_0(\\cdot-\\tau)\\rangle = \\exp(-\\frac{\\tau^2}{4\\sigma_t^2})$。\n\n计算在三个输出端口处各探测到一个光子的概率 $P(1,1,1)$。将您的答案表示为归一化时间重叠 $g$ 的函数。", "solution": "1. 对于部分可区分的光子，其概率由下式给出\n$$\nP(1,1,1)=\\sum_{\\sigma,\\pi\\in S_3}\\Bigl[\\prod_{i=1}^3U_{i,\\sigma(i)}U^*_{i,\\pi(i)}\\Bigr]\\,\n\\prod_{k=1}^3\\langle\\phi_{\\sigma(k)}|\\phi_{\\pi(k)}\\rangle\\,,\n$$\n其中，如果 $i,j\\in\\{1,2\\}$ 或 $i=j=3$，则 $\\langle\\phi_i|\\phi_j\\rangle=1$；如果一个索引是 3 而另一个在 $\\{1,2\\}$ 中，则 $\\langle\\phi_i|\\phi_j\\rangle=g$。\n\n2. 定义振幅\n$$\nA_\\sigma=\\prod_{i=1}^3U_{i,\\sigma(i)}\\,,\\qquad \n\\sum_\\sigmaA_\\sigma=\\Perm(U)\\,,\\qquad\n|\\Perm(U)|^2=\\frac13\\,,\\quad \n\\sum_\\sigma|A_\\sigma|^2=\\frac{6}{27}=\\frac{2}{9}\\,.\n$$\n\n3. 将该双重求和分为两类：\n– (i) $\\sigma(3)=\\pi(3)$: 在这种情况下，所有重叠都为 1,\n$$S_1=\\sum_{\\sigma,\\pi:\\,\\sigma(3)=\\pi(3)}A_\\sigma A_\\pi^*\n=\\sum_{j=1}^3\\Bigl|\\sum_{\\sigma:\\,\\sigma(3)=j}A_\\sigma\\Bigr|^2\n=\\frac19\\,.\n$$\n– (ii) $\\sigma(3)\\neq\\pi(3)$: 在这种情况下，重叠的乘积为 $g^2$，并且\n$$\nS_2=\\sum_{\\sigma,\\pi:\\,\\sigma(3)\\neq\\pi(3)}A_\\sigma A_\\pi^*\n=\\bigl|\\Perm(U)\\bigr|^2-S_1\n=\\frac{1}{3}-\\frac{1}{9}=\\frac{2}{9}\\,.\n$$\n\n4. 因此\n$$\nP(1,1,1)=1\\cdot S_1+g^2\\cdot S_2\n=\\frac{1}{9}+\\frac{2}{9}\\,g^2\n=\\frac{1+2g^2}{9}\\,.\n$$", "answer": "$$\\boxed{\\frac{1+2g^2}{9}}$$", "id": "107142"}, {"introduction": "大规模量子计算通常依赖于预先制备的大尺度纠缠资源态，例如簇态。在光子学平台中，实现光子间纠缠的“融合门”操作往往是概率性的，而非确定性的。本练习 [@problem_id:107002] 模拟了通过顺序操作构建一个四比特簇态的过程，并要求你在考虑到过程可能失败的情况下，计算成功构建该簇态所需的平均资源开销。这个问题揭示了扩展光子量子计算机所面临的核心工程挑战之一：如何在概率性操作下高效地构建资源。", "problem": "在测量基量子计算 (MBQC) 中，会先制备称为簇态的大型纠缠资源态，然后通过一系列单量子比特测量来消耗它们。MBQC 光学实现中的一个主要挑战是纠缠操作的概率性。\n\n考虑构建一个四量子比特方形簇态的任务。该状态可以想象为四个量子比特位于一个正方形的顶点上，纠缠链路对应于其边。构建过程始于四个处于乘积态 $|+\\rangle^{\\otimes 4}$ 的量子比特，其中 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$。形成方形拓扑结构所需的四个纠缠链路（CZ门）是按顺序创建的。\n\n在任意两个量子比特之间创建纠缠链路的尝试是通过一个概率过程进行的，为便于本题讨论，该过程可建模为一个“融合门”。每次创建链路的尝试会消耗一个预报的贝尔对，并以概率 $p$ 获得成功。\n\n构建四量子比特方形簇态的过程计划为一个顺序过程：\n1.  在量子比特1和2之间创建一条边，形成一个2量子比特线性簇。\n2.  在量子比特2和3之间创建一条边，形成一个3量子比特线性簇。\n3.  在量子比特3和4之间创建一条边，形成一个4量子比特线性簇。\n4.  最后，在量子比特4和1之间创建一条边以闭合环路，完成方形簇。\n\n该制备过程的一个关键方面是其对失败的敏感性。在任何构建阶段，若添加下一条所需边的尝试失败，将导致整个现有的纠缠结构退相干。发生这种情况时，必须从最开始（即，从初始的四量子比特乘积态）重新开始构建。请注意，在第一次尝试（构建2量子比特簇）时失败并不会破坏任何已存在的纠缠，因为此时还没有纠缠。\n\n你的任务是计算成功构建四量子比特方形簇态所需的预报贝尔对的总平均数量。请用成功概率 $p$ 的闭式解析表达式表示你的答案。", "solution": "设 $C$ 为所需的预报贝尔对的总平均数量。构建过程是顺序的，涉及创建四个纠缠链路。我们用所含边的数量来表示中间结构：\n-   $S_0$：四个未纠缠量子比特的初始状态。\n-   $S_1$：具有一条边的2量子比特线性簇。\n-   $S_2$：具有两条边的3量子比特线性簇。\n-   $S_3$：具有三条边的4量子比特线性簇。\n-   $S_4$：具有四条边的最终4量子比特方形簇。\n\n设 $C_k$ 为从 $S_0$ 开始成功构建结构 $S_k$ 所需的贝尔对的预期总数。我们的目标是求出 $C_4$。\n\n**步骤1：计算创建 $S_1$ 的成本**\n\n为了从 $S_0$ 得到 $S_1$，我们尝试创建第一条边。每次尝试都是一次成功概率为 $p$ 的伯努利试验，成本为一个贝尔对。由于没有已存在的纠缠，失败不会导致更大切簇结构的重新启动。尝试次数 $N_1$ 服从参数为 $p$ 的几何分布。\n概率质量函数为 $P(N_1=n) = (1-p)^{n-1}p$，其中 $n=1, 2, \\dots$。\n预期的尝试次数（也即贝尔对的数量）为：\n$$C_1 = E[N_1] = \\frac{1}{p}$$\n\n**步骤2：建立 $C_k$ 的递推关系**\n\n对于 $k \\ge 2$，要构建结构 $S_k$，我们必须先成功构建了 $S_{k-1}$。然后，我们尝试添加第 $k$ 条边。此阶段的失败会破坏整个 $S_{k-1}$ 结构，迫使从 $S_0$ 开始完全重新启动。\n\n让我们求解 $k \\in \\{2, 3, 4\\}$ 时的预期成本 $C_k$。获得 $S_k$ 的整个过程可以看作是在一个成功制备的 $S_{k-1}$ 结构上添加第 $k$ 条边的一系列尝试。设 $N_k$ 是创建第 $k$ 条边所需的尝试次数。\n\n每次尝试，我们必须首先拥有 $S_{k-1}$ 结构。构建 $S_{k-1}$ 的预期成本是 $C_{k-1}$。\n让我们考虑在刚形成 $S_{k-1}$ 的情况下，形成第 $k$ 条边的过程。设 $N$ 为尝试次数。\n-   如果第一次尝试成功（概率为 $p$），总成本是构建 $S_{k-1}$ 的成本加上成功尝试所用的1个贝尔对。在第一次尝试成功的情况下，总成本为：$C_{k-1} + 1$。\n-   如果第一次尝试失败（概率为 $1-p$），我们消耗了1个贝尔对，失去了结构，并且必须从头开始重启构建 $S_k$ 的整个过程。从此刻起的预期成本为 $C_k$。因此，在第一次尝试失败的情况下，总成本为：$C_{k-1} + 1 + C_k$。\n\n使用全期望定律计算 $C_k$：\n$$C_k = p \\cdot (C_{k-1} + 1) + (1-p) \\cdot (C_{k-1} + 1 + C_k)$$\n上述逻辑稍有瑕疵，因为 $C_{k-1}$ 是一个期望值，而不是一个固定成本。让我们使用一个更严谨的论证。\n\n让我们分析从 $S_{k-1}$ 到 $S_k$ 的成本。设 $N$ 是为创建第 $k$ 条边而进行的尝试次数。$N$ 服从几何分布，$P(N=n) = p(1-p)^{n-1}$。\n最终的成功尝试（第 $n$ 次）之前有 $n-1$ 次失败。\n-   成功操作序列的成本是 $C_{k-1} + 1$（构建 $S_{k-1}$，然后添加最后一条边）。\n-   $n-1$ 次失败中的每一次，其成本包括尝试本身消耗的1个贝尔对，以及从头开始重建 $S_{k-1}$ 结构，后者的预期成本为 $C_{k-1}$。因此，每次失败序列的成本是 $C_{k-1}+1$。\n\n所以，在最后一个阶段需要 $n$ 次尝试的条件下，总预期成本 $C_k$ 为 $E[C_k|N=n] = (n-1)(C_{k-1}+1) + (C_{k-1}+1) = n(C_{k-1}+1)$。\n现在，我们通过对 $n$ 的所有可能值求平均来计算无条件期望 $C_k$：\n$$C_k = E[E[C_k|N=n]] = \\sum_{n=1}^\\infty P(N=n) \\cdot n(C_{k-1}+1)$$\n$$C_k = (C_{k-1}+1) \\sum_{n=1}^\\infty n(1-p)^{n-1}p$$\n该求和是几何分布的期望值，即 $1/p$。\n$$C_k = (C_{k-1}+1) \\cdot \\frac{1}{p}$$\n这就得到了 $k=2, 3, 4$ 时的递推关系：\n$$C_k = \\frac{C_{k-1}+1}{p}$$\n\n**步骤3：求解递推关系**\n\n我们已知 $C_1 = 1/p$。现在可以迭代求解 $C_2, C_3,$ 和 $C_4$。\n\n-   对于 $k=2$：\n    $$C_2 = \\frac{C_1+1}{p} = \\frac{\\frac{1}{p}+1}{p} = \\frac{1+p}{p^2}$$\n\n-   对于 $k=3$：\n    $$C_3 = \\frac{C_2+1}{p} = \\frac{\\frac{1+p}{p^2}+1}{p} = \\frac{\\frac{1+p+p^2}{p^2}}{p} = \\frac{1+p+p^2}{p^3}$$\n\n-   对于 $k=4$：\n    $$C_4 = \\frac{C_3+1}{p} = \\frac{\\frac{1+p+p^2}{p^3}+1}{p} = \\frac{\\frac{1+p+p^2+p^3}{p^3}}{p} = \\frac{1+p+p^2+p^3}{p^4}$$\n\n这就是所需的贝尔对的平均数量。\n\n**步骤4：将答案表示为闭式**\n\n分子是一个有限几何级数：$\\sum_{i=0}^{3} p^i = \\frac{1-p^4}{1-p}$。\n将此代入 $C_4$ 的表达式中：\n$$C_4 = \\frac{\\frac{1-p^4}{1-p}}{p^4} = \\frac{1-p^4}{p^4(1-p)}$$\n这就是所需贝尔对总平均数量的最终闭式表达式。\n\n另外，我们也可以将 $C_4$ 表示为：\n$$C_4 = \\frac{1}{p^4} + \\frac{p}{p^4} + \\frac{p^2}{p^4} + \\frac{p^3}{p^4} = \\frac{1}{p} + \\frac{1}{p^2} + \\frac{1}{p^3} + \\frac{1}{p^4}$$\n这种形式清楚地显示了在每个构建阶段潜在失败所带来的复合成本。", "answer": "$$ \\boxed{\\frac{1-p^4}{p^4(1-p)}} $$", "id": "107002"}, {"introduction": "除了使用单个光子的离散自由度（如偏振）编码量子比特外，光学量子计算还有一种强大的范式：连续变量 (CV) 量子计算，它将信息编码在光的正交分量（quadratures）中。本练习 [@problem_id:107052] 深入探讨了 CV 框架下的测量基量子计算模型。你将使用协方差矩阵这一核心工具来描述 CV 簇态的生成，并探索如何通过对部分模式进行测量，从而在剩余模式上实现量子门操作，这正是 CV 测量基计算的精髓所在。", "problem": "在连续变量（CV）量子计算模型中，量子态由每个模式 $k$ 的正交算符 $(\\hat{x}_k, \\hat{p}_k)$ 描述，这些算符满足正则对易关系 $[\\hat{x}_k, \\hat{p}_l] = i\\hbar\\delta_{kl}$。基于测量的连续变量量子计算的一个关键资源是簇态，它是一种高度纠缠的多模高斯态。\n\n考虑一个由四个玻色子模式组成的系统。初始态是四个独立、相同的单模压缩真空态的乘积。每个模式都在动量正交分量 $\\hat{p}$ 上被压缩，使得对于给定的压缩参数 $s  0$，方差为 $\\text{Var}(\\hat{x}) = (\\hbar/2)e^{2s}$ 和 $\\text{Var}(\\hat{p}) = (\\hbar/2)e^{-2s}$。所有正交分量的平均值均为零。\n\n然后，通过对这个初始四模态施加一系列受控-Z（CZ）门 $U = U_{34}U_{23}U_{12}$ 来生成一个四模线性簇态。模式 $j$ 和 $k$ 之间的一个 CZ 门 $U_{jk} = \\exp(i\\hat{x}_j\\hat{x}_k/\\hbar)$ 通过辛变换作用于正交算符：\n$\\hat{p}_j \\to \\hat{p}_j - \\hat{x}_k$\n$\\hat{p}_k \\to \\hat{p}_k - \\hat{x}_j$\n所有其他正交分量不受影响。\n\n随后，对前两个模式执行一个基于测量的协议。具体来说，对模式1执行动量正交分量 $\\hat{p}_1$ 的零差测量，对模式2执行位置正交分量 $\\hat{x}_2$ 的零差测量。这些测量将模式1和2分别投影到相应的正交本征态上，使得模式3和4处于一个相关的双模高斯态。\n\n你的任务是确定模式3和4最终态中，模式3的动量正交分量与模式4的位置正交分量之间的协方差，即 $\\text{Cov}(\\hat{p}_3, \\hat{x}_4) \\equiv \\frac{1}{2}\\langle \\hat{p}_3 \\hat{x}_4 + \\hat{x}_4 \\hat{p}_3 \\rangle - \\langle \\hat{p}_3 \\rangle \\langle \\hat{x}_4 \\rangle$。请用约化普朗克常数 $\\hbar$ 和压缩参数 $s$ 来表示你的答案。", "solution": "1. 定义初始正交分量 $(\\hat x_j^0,\\hat p_j^0)$，其平均值为零且\n   $$\\Var(\\hat x_j^0)=\\tfrac{\\hbar}{2}e^{2s},\\quad \\Var(\\hat p_j^0)=\\tfrac{\\hbar}{2}e^{-2s}\\,. $$\n2. 在链 $1\\!-\\!2\\!-\\!3\\!-\\!4$ 上施加三个 CZ 门之后，变换后的正交分量为\n   $$\\hat x_j=\\hat x_j^0,\\quad\n     \\hat p_j=\\hat p_j^0-\\sum_{k\\sim j}\\hat x_k^0, $$\n   特别地\n   $$\\hat p_3=\\hat p_3^0-\\hat x_2^0-\\hat x_4^0,\\quad \\hat x_4=\\hat x_4^0\\,. $$\n3. 我们测量 $\\hat p_1^M=\\hat p_1^0-\\hat x_2^0$ 和 $\\hat x_2^M=\\hat x_2^0$，使得模式3和4处于以这些测量结果为条件的态。记为\n   $$v=(\\hat p_3,\\hat x_4)^T,\\quad m=(\\hat p_1^M,\\hat x_2^M)^T.$$ \n4. 利用独立性和零交叉相关性计算无条件协方差。可得\n   $$\\Sigma_{vv}\n   =\\frac{\\hbar}{2}\\begin{pmatrix}e^{-2s}+2e^{2s}-e^{2s}\\\\-e^{2s}^{2s}\\end{pmatrix},\\quad\n     \\Sigma_{vm}\n   =\\frac{\\hbar}{2}\\begin{pmatrix}e^{2s}-e^{2s}\\\\00\\end{pmatrix},$$\n   $$\\Sigma_{mm}\n   =\\frac{\\hbar}{2}\\begin{pmatrix}e^{-2s}+e^{2s}-e^{2s}\\\\-e^{2s}^{2s}\\end{pmatrix}.$$\n5. 条件协方差为 \n   $$\\Sigma_{v|m}=\\Sigma_{vv}-\\Sigma_{vm}\\,\\Sigma_{mm}^{-1}\\,\\Sigma_{vm}^T.$$\n   计算可得\n   $$\\Sigma_{v|m}\n   =\\frac{\\hbar}{2}\\begin{pmatrix}e^{-2s}+e^{2s}-e^{2s}\\\\-e^{2s}^{2s}\\end{pmatrix}.$$\n6. 因此\n   $$\\Cov(\\hat p_3,\\hat x_4)\n   =\\Sigma_{12|m}\n   =-\\frac{\\hbar}{2}e^{2s}\\,. $$", "answer": "$$\\boxed{-\\frac{\\hbar}{2}e^{2s}}$$", "id": "107052"}]}