{"hands_on_practices": [{"introduction": "为了实现通用量子计算，我们需要超越经典计算机模拟能力的量子操作。仅由Clifford门构成的量子电路虽然易于模拟，但其计算能力有限。为了获得通用性，我们必须引入非Clifford操作，而实现这些操作的一种关键方法是利用所谓的“魔术态”(magic states)。本练习旨在通过计算一个重要魔术态的“魔术鲁棒性”(robustness of magic)，让您亲手量化这种作为计算资源的宝贵“魔力”，从而更深刻地理解它在量子计算优越性中的核心地位 [@problem_id:63612]。", "problem": "在稳定器量子计算的资源理论中，非稳定器态（通常称为“魔术态”）是实现通用量子计算的必要资源。一个量子态中所含有的这种资源的量可以通过多种度量来量化，其中之一就是魔术鲁棒性。\n\n对于单量子比特系统，其状态可以用 $\\mathbb{R}^3$中的一个布洛赫矢量 $\\vec{r}$ 来表示，其密度矩阵为 $\\rho = \\frac{1}{2}(I + \\vec{r}\\cdot\\vec{\\sigma})$，其中 $\\vec{\\sigma} = (X, Y, Z)$ 是泡利矩阵的矢量。单量子比特稳定器态的集合由泡利算符的六个本征态组成，其布洛赫矢量分别为 $(\\pm 1, 0, 0)$、$(0, \\pm 1, 0)$ 和 $(0, 0, \\pm 1)$。这些态的凸包构成了稳定器多胞体，它是一个八面体，由所有满足条件 $||\\vec{s}||_1 = |s_x| + |s_y| + |s_z| \\le 1$ 的布洛赫矢量 $\\vec{s}$ 集合定义。\n\n魔术鲁棒性 $R(\\rho)$ 定义为最小的非负值 $R$，使得状态 $\\rho$ 可以写成 $\\rho = (1+R)\\sigma - R\\chi$ 的形式，其中 $\\sigma$ 是某个有效的密度矩阵，而 $\\chi$ 是一个位于稳定器多胞体内的态。对于一个布洛赫矢量为 $\\vec{r}$ 的单量子比特态 $\\rho$，这个量可以用以下公式计算：\n$$\nR(\\rho) = \\max(0, ||\\vec{r}||_1 - 1)\n$$\n\nT 门是一个基本的非 Clifford 门，由矩阵 $T = \\begin{pmatrix} 1 & 0 \\\\ 0 & e^{i\\pi/4} \\end{pmatrix}$ 给出。当它作用于态 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle+|1\\rangle)$ 时，会产生魔术 T 态 $|T\\rangle = T|+\\rangle$。\n\n考虑 Hadamard 门 $H = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix}$。你的任务是计算一个通过将 Hadamard 门作用于 T 态而生成的状态 $|\\psi\\rangle$ 的魔术鲁棒性。也就是说，计算状态 $\\rho_\\psi = |\\psi\\rangle\\langle\\psi|$ 的 $R(\\rho_\\psi)$，其中 $|\\psi\\rangle = H|T\\rangle$。", "solution": "1. 对于布洛赫矢量为 $\\vec r$ 的态，其单量子比特魔术鲁棒性为\n$$\nR(\\rho)=\\max\\bigl(0,\\|\\vec r\\|_1-1\\bigr),\n\\qquad\n\\|\\vec r\\|_1=|r_x|+|r_y|+|r_z|.\n$$\n\n2. T 态 $|T\\rangle=T|+\\rangle$ 的布洛赫矢量分量为 $r_x=\\langle T|X|T\\rangle = \\cos(\\pi/4) = \\frac{\\sqrt{2}}{2}$, $r_y=\\langle T|Y|T\\rangle = \\sin(\\pi/4) = \\frac{\\sqrt{2}}{2}$, $r_z=\\langle T|Z|T\\rangle=0$。所以其布洛赫矢量为 $\\vec{r} = (\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, 0)$。\n$$\n\\|\\vec r\\|_1=\\frac{\\sqrt{2}}{2}+\\frac{\\sqrt{2}}{2}+0=\\sqrt2.\n$$\n\n3. Hadamard 门引起布洛赫旋转 $(x,y,z)\\mapsto(z,-y,x)$。因此对于 \n$\\vec r=(\\frac{\\sqrt{2}}{2},\\frac{\\sqrt{2}}{2},0)$，作用后的新矢量为\n$$\n\\vec r'=(0,-\\frac{\\sqrt{2}}{2},\\frac{\\sqrt{2}}{2}),\n\\qquad\n\\|\\vec r'\\|_1=0+\\frac{\\sqrt{2}}{2}+\\frac{\\sqrt{2}}{2}=\\sqrt2.\n$$\n\n4. 因此，$\\rho_\\psi=|\\psi\\rangle\\langle\\psi|$ 的魔术鲁棒性为\n$$\nR(\\rho_\\psi)=\\max(0,\\sqrt2-1)=\\sqrt2-1.\n$$", "answer": "$$\\boxed{\\sqrt{2}-1}$$", "id": "63612"}, {"introduction": "拥有了像魔术态这样的计算资源后，下一个巨大的挑战便是在真实的物理系统中精确地实现量子操作。在现实世界中，量子比特不可避免地会与环境相互作用，导致噪声和退相干，这会严重影响量子门的保真度。本练习将引导您分析一个普遍存在的噪声模型——准静态频率失谐——是如何影响一个基本单比特门的性能的，您将通过计算平均门保真度来量化这种影响，这是评估和改进量子硬件性能的一项基本技能 [@problem_id:63624]。", "problem": "一个量子比特受到共振驱动场的作用。在旋转坐标系中，当存在频率失谐 $\\delta$ 时，描述该系统的哈密顿量为：\n$$ H = \\frac{\\hbar}{2} \\left( \\Omega \\sigma_x + \\delta \\sigma_z \\right) $$\n其中 $\\sigma_x$ 和 $\\sigma_z$ 是泡利矩阵，$\\Omega$ 是驱动场的拉比频率，$\\delta$ 代表量子比特的跃迁频率与驱动频率之间的准静态失谐。失谐 $\\delta$ 是一个随机变量，其在单次门操作期间是恒定的，但在不同操作之间会发生变化。它服从一个均值为零、方差为 $\\sigma^2$ 的高斯概率分布 $P(\\delta)$：\n$$ P(\\delta) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{\\delta^2}{2\\sigma^2}\\right) $$\n一个理想的单量子比特非门（X门）通过一个共振的（$\\delta = 0$）$\\pi$ 脉冲来实现，这对应于施加驱动场持续时间 $T = \\pi/\\Omega$。失谐 $\\delta$ 的存在会导致门操作中出现错误。\n\n门的质量由平均门保真度 $\\bar{F}$ 来量化。相应的平均门失真度为 $\\mathcal{I} = 1 - \\bar{F}$。在小噪声极限下，即失谐的标准差远小于拉比频率（$\\sigma \\ll \\Omega$）时，平均门失真度可以由其领头项近似表示：\n$$ \\mathcal{I} \\approx C \\left( \\frac{\\sigma}{\\Omega} \\right)^2 $$\n你的任务是计算无量纲系数 $C$。对于此问题，你可以设置 $\\hbar=1$。", "solution": "我们设 $\\hbar=1$，并定义小参数 $\\varepsilon=\\delta/\\Omega$。理想的 X 门是 $V=\\exp(-i(\\pi/2)\\sigma_x)=-i\\sigma_x$（不计全局相位）。在哈密顿量 $H=\\frac{1}{2}\\Omega(\\sigma_x+\\varepsilon\\sigma_z)$ 下，演化时间 $T=\\pi/\\Omega$ 后的实际幺正演化算符为\n$$U(\\delta)=\\exp\\Bigl[-i\\,\\frac{\\pi}{2}\\bigl(\\sigma_x+\\varepsilon\\sigma_z\\bigr)\\Bigr]\n=\\cos\\frac{\\theta}{2}\\,I-i\\sin\\frac{\\theta}{2}\\,\\mathbf{N}\\cdot\\vec{\\sigma},$$\n其中 $\\theta=\\pi\\sqrt{1+\\varepsilon^2}$ 且 $\\mathbf{N}=(1,0,\\varepsilon)/\\sqrt{1+\\varepsilon^2}$。对于 $d=2$ 的情况，门保真度为\n$$F(\\delta)=\\frac{|\\text{Tr}(V^\\dagger U)|^2+2}{6}.$$\n由于 $V^\\dagger=+i\\sigma_x$，可以得到\n$$\\text{Tr}(V^\\dagger U)=i\\,\\text{Tr}(\\sigma_xU)=2\\,N_x\\sin\\frac{\\theta}{2},\\qquad N_x=\\frac{1}{\\sqrt{1+\\varepsilon^2}}.$$\n因此\n$$|\\text{Tr}(V^\\dagger U)|^2=\\frac{4}{1+\\varepsilon^2}\\sin^2\\Bigl(\\frac{\\pi}{2}\\sqrt{1+\\varepsilon^2}\\Bigr),$$\n于是\n$$F(\\delta)=\\frac{4(1+\\varepsilon^2)^{-1}\\sin^2\\bigl(\\frac{\\pi}{2}\\sqrt{1+\\varepsilon^2}\\bigr)+2}{6}.$$\n对于 $\\varepsilon\\ll1$，展开 $\\sqrt{1+\\varepsilon^2}=1+\\varepsilon^2/2+O(\\varepsilon^4)$ 以及\n$$\\sin^2\\Bigl(\\frac{\\pi}{2}\\sqrt{1+\\varepsilon^2}\\Bigr)\n=\\sin^2\\Bigl(\\frac{\\pi}{2}+\\frac{\\pi}{4}\\varepsilon^2+O(\\varepsilon^4)\\Bigr)\n=\\cos^2\\Bigl(\\frac{\\pi}{4}\\varepsilon^2\\Bigr)\n=1+O(\\varepsilon^4).$$\n因此\n$$F(\\delta)=\\frac{4(1-\\varepsilon^2+O(\\varepsilon^4))+2}{6}=1-\\frac{2}{3}\\varepsilon^2+O(\\varepsilon^4).$$\n对 $\\delta$ 进行平均得到 $\\langle\\varepsilon^2\\rangle=(\\sigma/\\Omega)^2$，因此失真度为\n$$\\mathcal I=1-\\bar F\\approx\\frac{2}{3}\\Bigl(\\frac{\\sigma}{\\Omega}\\Bigr)^2.$$", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "63624"}, {"introduction": "面对噪声的挑战，容错量子计算为我们指明了通往大规模、可靠量子计算的道路。其核心思想是使用一个特殊的、可容错实现的“通用”门集（如Clifford+T门集）来近似任意的量子操作。然而，这个过程是有代价的，特别是“T门”作为一种昂贵的非Clifford资源，其数量必须被严格控制。本练习将让您直面这一被称为“量子编译”或“门合成”的核心任务，您需要为一个特定的旋转门找到达到目标精度所需的最小T门数量(T-count)，这个问题连接了量子算法、容错理论和数论，是设计高效容错量子电路的关键 [@problem_id:63628]。", "problem": "在容错量子计算领域，Clifford+T 门集是通用计算的标准选择。该门集由 Clifford 门（Hadamard 门 $H$、相位门 $S=\\sqrt{Z}$ 和 CNOT 门）和非 Clifford $T$ 门组成，其中 $T=S^{1/2}=\\begin{pmatrix} 1 & 0 \\\\ 0 & e^{i\\pi/4} \\end{pmatrix}$。虽然 Clifford 门可以相对容易地容错实现（例如，通过态蒸馏和门远程传输），但 $T$ 门是一种资源密集型的“魔术态”。因此，在量子线路中，最小化 $T$ 门的数量（即 T 门数）至关重要。\n\n任意的单量子比特旋转，例如 $R_z(\\theta) = \\exp(-i\\theta Z/2) = \\begin{pmatrix} e^{-i\\theta/2} & 0 \\\\ 0 & e^{i\\theta/2} \\end{pmatrix}$，必须通过 Clifford 门和 T 门的序列来近似。一种合成 Z 旋转的常见高效策略是使用数论算法，找到 $R_z(\\theta)$ 的一个最优近似，该近似具有 $R_z(k\\pi/2^m)$ 的形式，其中 $k$ 和 $m$ 是整数。这样的旋转仅使用 Clifford 门和 T 门即可合成。\n\n对于一个目标门 $U_{target}$ 及其近似 $U_{approx}$，合成误差由算符范数距离 $\\epsilon = \\|U_{target} - U_{approx}\\|$ 来衡量。对于两个 Z 旋转，算符范数距离和角度差之间的关系由 $\\|R_z(\\theta_1) - R_z(\\theta_2)\\| = 2|\\sin((\\theta_1-\\theta_2)/4)|$ 给出。\n\n目前最先进的算法可以合成门 $R_z(k\\pi/2^m)$（对于奇数 $k$），其 T 门数恰好为 $T_c = 4m-2$。如果 $k$ 是偶数，例如 $k=2j$，则有 $R_z(k\\pi/2^m) = R_z(j\\pi/2^{m-1})$，并且可以进行一种更高效的合成，其 T 门数将基于 $m-1$ 计算。因此，为了找到最优的 T 门数，应始终约简分数 $k/2^m$，直到 $k$ 成为奇数。\n\n您的任务是确定合成单量子比特旋转 $R_z(\\pi/15)$ 达到精度 $\\epsilon = 10^{-10}$ 所需的最优（最小）T 门数。", "solution": "我们希望用\n$$R_z(k\\pi/2^m)$$\n来近似\n$$R_z(\\pi/15)$$\n其算符范数误差需满足\n$$\\epsilon=\\|R_z(\\pi/15)-R_z(k\\pi/2^m)\\|\\le10^{-10}\\,. $$\n\n1. 误差条件。对于两个 Z 旋转，有\n$$\\|R_z(\\theta_1)-R_z(\\theta_2)\\|\n=2\\Bigl|\\sin\\frac{\\theta_1-\\theta_2}{4}\\Bigr|\\le\\epsilon\\,. $$\n设 $\\theta_1=\\pi/15$，$\\theta_2=k\\pi/2^m$，并记 $\\delta\\theta=\\theta_1-\\theta_2$。则\n$$2\\Bigl|\\sin\\frac{\\delta\\theta}{4}\\Bigr|\\le\\epsilon\n\\quad\\Longrightarrow\\quad\n\\Bigl|\\delta\\theta\\Bigr|\\le4\\arcsin\\frac{\\epsilon}{2}\\,. $$\n\n2. 等价地，以 $\\pi$ 为单位，\n$$\\Bigl|\\frac{k}{2^m}-\\frac{1}{15}\\Bigr|\\le\n\\frac{4\\arcsin(\\epsilon/2)}{\\pi}\\,. $$\n\n3. 令\n$$\\Delta=\\frac{4\\arcsin(\\epsilon/2)}{\\pi}\\approx\\frac{4\\arcsin(5\\times10^{-11})}{\\pi}\n\\approx6.366\\times10^{-11}\\,. $$\n\n4. 一个简单的最近整数界给出\n$$\\Bigl|\\frac{\\text{round}(2^m/15)}{2^m}-\\frac{1}{15}\\Bigr|\\le\\frac{1}{2^{m+1}}\\,. $$\n因此，一个充分条件是\n$$\\frac{1}{2^{m+1}}\\le\\Delta\n\\quad\\Longrightarrow\\quad\n2^{m+1}\\ge\\Delta^{-1}\n\\quad\\Longrightarrow\\quad\nm+1\\ge\\log_2\\!\\bigl(\\Delta^{-1}\\bigr)\\approx33.86\n\\quad\\Longrightarrow\\quad\nm\\ge32.86\\,. $$\n\n5. 我们测试 $m=32$。则\n$$k=\\text{round}\\!\\bigl(2^{32}/15\\bigr)\n=\\text{round}\\!(286331153.0666\\ldots)=286331153\\quad(\\text{odd}),$$\n且实际误差为\n$$\\Bigl|\\frac{k}{2^{32}}-\\frac{1}{15}\\Bigr|\n=\\frac{|15k-2^{32}|}{15 \\cdot 2^{32}} = \\frac{1}{15 \\cdot 2^{32}} \\approx1.55\\times10^{-11}<\\Delta\\,. $$\n因此 $m=32$ 是充分的（因为 $k$ 是奇数，所以无法进行进一步的偶数因子约简）。\n\n6. 对于奇数 $k$ 和指数 $m$，T 门数为\n$$T_c=4m-2=4\\cdot32-2=128-2=126\\,. $$\n\n因此，最小 T 门数为 $126$。", "answer": "$$\\boxed{126}$$", "id": "63628"}]}