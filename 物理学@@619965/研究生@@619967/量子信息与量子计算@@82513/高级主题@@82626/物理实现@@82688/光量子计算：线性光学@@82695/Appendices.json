{"hands_on_practices": [{"introduction": "多光子干涉是线性光学量子计算的基石，它与经典波的干涉有着本质区别。当不可区分的光子通过一个分束器网络时，它们的路径振幅会发生量子干涉，其最终的输出分布由一个被称为“积和式”（permanent）的数学量决定。本练习将通过一个基础但非平凡的例子——两个光子输入到一个三端口干涉仪——来引导你动手计算这种量子干涉效应，这是理解玻色采样等更复杂协议的关键一步。[@problem_id:107048]", "problem": "在线性光学量子计算中，多端口干涉仪是一个基本的构建单元。它对光子模式的作用由一个 $M \\times M$ 的幺正矩阵 $U$ 描述，其中 $M$ 是端口数。输入模式的产生算符 $\\{a_k^\\dagger\\}$ 和输出模式的产生算符 $\\{b_j^\\dagger\\}$ 之间的关系由 $b_j^\\dagger = \\sum_{k=1}^M U_{jk} a_k^\\dagger$ 给出。\n\n考虑一个实现量子离散傅里叶变换 (DFT) 的3端口干涉仪。描述此变换的幺正矩阵由下式给出：\n$$\nU = \\frac{1}{\\sqrt{3}} \\begin{pmatrix}\n1 & 1 & 1 \\\\\n1 & \\omega & \\omega^2 \\\\\n1 & \\omega^2 & \\omega\n\\end{pmatrix}\n$$\n其中 $\\omega = e^{2\\pi i/3}$ 是单位主三次根。\n\n假设该干涉仪的输入是一个双光子福克态 $|1,1,0\\rangle_{\\text{in}}$，这对应于一个光子进入输入端口1，一个光子进入输入端口2，零个光子进入输入端口3。\n\n计算此输入态散射到输出福克态 $|1,0,1\\rangle_{\\text{out}}$ 的概率，该输出态对应于一个光子在输出端口1被探测到，零个光子在输出端口2，一个光子在输出端口3。", "solution": "我们有一个 3×3 的幺正矩阵\n$$\nU=\\frac1{\\sqrt3}\\begin{pmatrix}\n1&1&1\\\\\n1&\\omega&\\omega^2\\\\\n1&\\omega^2&\\omega\n\\end{pmatrix},\\quad \\omega=e^{2\\pi i/3},\\;\\omega^3=1,\\;1+\\omega+\\omega^2=0.\n$$\n对于输入占据数为 $r=(1,1,0)$ 且输出为 $s=(1,0,1)$ 的玻色子，其跃迁振幅为\n$$\n\\mathcal A=\\frac{\\operatorname{Perm}(U_{s\\times r})}{\\sqrt{1!\\,1!\\,1!\\,1!}}\n=\\operatorname{Perm}\\begin{pmatrix}\nU_{1,1}&U_{1,2}\\\\\nU_{3,1}&U_{3,2}\n\\end{pmatrix}.\n$$\n该 2×2 子矩阵为\n$$\nU_{s\\times r}=\\frac1{\\sqrt3}\\begin{pmatrix}\n1&1\\\\\n1&\\omega^2\n\\end{pmatrix}.\n$$\n因此其积和式为\n$$\n\\operatorname{Perm}(U_{s\\times r})\n=\\frac1{3}\\bigl(1\\cdot\\omega^2+1\\cdot1\\bigr)\n=\\frac{1+\\omega^2}{3}.\n$$\n因此概率为\n$$\nP=\\bigl|\\mathcal A\\bigr|^2\n=\\frac{|1+\\omega^2|^2}{9}.\n$$\n使用 $1+\\omega+\\omega^2=0\\implies1+\\omega^2=-\\omega$ 以及 $|\\omega|^2=1$，我们得到\n$$\nP=\\frac{|-\\,\\omega|^2}{9}=\\frac1{9}.\n$$", "answer": "$$\\boxed{1/9}$$", "id": "107048"}, {"introduction": "理论模型是理解物理原理的起点，但真实世界的实验总是伴随着各种不完美。Hong-Ou-Mandel (HOM) 效应是双光子干涉最经典的展示，但在实际测量中，完美的干涉相消（体现为零符合计数）难以实现。本练习将理论与实践相结合，要求你分析并量化两种最常见的实验缺陷——光电探测器的有限量子效率 $\\eta$ 和非零的暗计数概率 $\\delta$——是如何影响和降低 HOM 干涉可见度的。[@problem_id:109524]", "problem": "Hong-Ou-Mandel (HOM) 效应是量子光学和光子量子信息处理的基石。在其标准形式中，两个全同的单光子同时射入一个对称的 50:50 分束器的两个输入端口。量子干涉决定了这两个光子将总是从分束器的同一个输出端口出射，这一现象被称为光子聚束。这导致放置在两个输出端口处的光电探测器之间的符合计数率为零。这种干涉的好坏程度由 HOM 可见度来量化，定义为 $V = (C_\\infty - C_0) / C_\\infty$，其中 $C_0$ 是当光子不可区分（零时间延迟）时的符合计数率，$C_\\infty$ 是当光子可区分（大时间延迟）时的符合计数率。在理想情况下，$C_0=0$ 且可见度为 $V=1$。\n\n考虑一个更真实的 HOM 干涉仪，其中输出端口处的两个光电探测器是非理想的。每个探测器都具有一个量子效率 $\\eta$ 的特性，它表示入射光子产生一次响应的概率，其中 $0 < \\eta \\le 1$。此外，每个探测器在相关的探测时间窗口内有概率 $\\delta$ 产生“暗计数”（即在没有任何入射光子的情况下产生一次响应），其中 $0 \\le \\delta \\ll 1$。\n\n假设两个探测器中的暗计数事件彼此不相关，且与光子探测事件也不相关，请推导 HOM 干涉可见度 $V$ 关于量子效率 $\\eta$ 和暗计数概率 $\\delta$ 的闭式表达式。", "solution": "我们用 $n_i$ 表示入射到探测器 $i\\;(i=1,2)$ 上的光子数。对于一个在时间窗口内效率为 $\\eta$、暗计数概率为 $\\delta$ 的探测器，在给定 $n$ 个入射光子的情况下，其产生一次响应的概率为\n$$P_{\\rm click}(n)=1-\\bigl(1-\\delta\\bigr)\\bigl(1-\\eta\\bigr)^n\\,. $$\n\n可区分光子：每个光子独立地以 $1/2$ 的概率从端口 1 或 2 出射。联合分布为\n$$P(n_1=2,n_2=0)=P(0,2)=\\tfrac14,\\quad P(1,1)=\\tfrac12.$$\n因此，符合计数率\n$$\nC_\\infty\n=\\sum_{n_1,n_2}P(n_1,n_2)\\,P_{\\rm click}(n_1)\\,P_{\\rm click}(n_2)\n=\\tfrac14\\bigl[P_{\\rm click}(2)P_{\\rm click}(0)+P_{\\rm click}(0)P_{\\rm click}(2)\\bigr]\n+\\tfrac12\\,P_{\\rm click}(1)^2\n$$\n$$\n=\\tfrac12\\,\\delta\\,\\bigl[1-(1-\\delta)(1-\\eta)^2\\bigr]\n+\\tfrac12\\bigl[1-(1-\\delta)(1-\\eta)\\bigr]^2.\n$$\n\n不可区分光子聚束：两个光子都进入同一个端口，每个端口的概率均为 $1/2$。则\n$$\nC_0=\\tfrac12\\bigl[P_{\\rm click}(2)\\,P_{\\rm click}(0)\\bigr]\n+\\tfrac12\\bigl[P_{\\rm click}(0)\\,P_{\\rm click}(2)\\bigr]\n=\\delta\\;\\bigl[1-(1-\\delta)(1-\\eta)^2\\bigr].\n$$\n\n定义\n$$P_1=1-(1-\\delta)(1-\\eta),\\quad P_2=1-(1-\\delta)(1-\\eta)^2.$$\n则\n$$\nC_\\infty=\\frac{P_1^2+\\delta\\,P_2}{2},\\quad\nC_0=\\delta\\,P_2,\n$$\n可见度为\n$$\nV=\\frac{C_\\infty-C_0}{C_\\infty}\n=\\frac{\\tfrac12(P_1^2+\\delta P_2)-\\delta P_2}{\\tfrac12(P_1^2+\\delta P_2)}\n=\\frac{P_1^2-\\delta P_2}{P_1^2+\\delta P_2}\\,.\n$$\n代回，\n$$\nV\n=\\frac{\\bigl[1-(1-\\delta)(1-\\eta)\\bigr]^2\n-\\delta\\bigl[1-(1-\\delta)(1-\\eta)^2\\bigr]}\n{\\bigl[1-(1-\\delta)(1-\\eta)\\bigr]^2\n+\\delta\\bigl[1-(1-\\delta)(1-\\eta)^2\\bigr]}\\,.\n$$", "answer": "$$\\boxed{\\frac{\\bigl[1-(1-\\delta)(1-\\eta)\\bigr]^2-\\delta\\bigl[1-(1-\\delta)(1-\\eta)^2\\bigr]}{\\bigl[1-(1-\\delta)(1-\\eta)\\bigr]^2+\\delta\\bigl[1-(1-\\delta)(1-\\eta)^2\\bigr]}}$$", "id": "109524"}, {"introduction": "掌握了基本的干涉原理后，下一步是利用它来构建量子计算的核心单元——量子门。在线性光学方案中，量子门通常是概率性的，其成功依赖于特定的测量结果。本练习将带你进入一个更高级的课题：一个基于光子干涉的受控相位（C-PHASE）门的实现与评估。你的任务是分析当核心元件（分束器）的参数偏离理想值时，这个概率性量子门的最终输出状态与理想状态的保真度会如何变化，这对于评估和优化真实量子硬件至关重要。[@problem_id:109494]", "problem": "一个双量子比特受控相位（C-PHASE）门是量子计算中的一个基本组件。在线性光学量子计算中，这类门通常是概率性实现的。考虑一个用于两个光子量子比特的C-PHASE门，一个控制比特（$C$）和一个目标比特（$T$）。这两个量子比特使用双轨表示法进行编码，其中逻辑态$|0\\rangle$对应于空间模式0中有一个单光子而模式1中为真空，而$|1\\rangle$则对应于模式1中有一个光子而模式0中为真空。具体来说，即$|0\\rangle_C \\equiv |1,0\\rangle_{c_0, c_1}$和$|1\\rangle_C \\equiv |0,1\\rangle_{c_0, c_1}$，目标量子比特（$|0\\rangle_T, |1\\rangle_T$）在模式$t_0, t_1$中也有类似定义。\n\nC-PHASE门通过一个简单的电路实现，其中逻辑模式$c_0$和$t_0$直接通过，不做改变。相互作用仅发生在模式$c_1$和$t_1$之间，这两个模式在一个反射率为$R$、透射率为$T=1-R$的单分束器上发生干涉。对于从输入模式$(a_{in,1}, a_{in,2})$到输出模式$(a_{out,1}, a_{out,2})$的湮灭算符，分束器的变换由下式给出：\n$$\n\\begin{pmatrix} a_{out,1} \\\\ a_{out,2} \\end{pmatrix} = \\begin{pmatrix} \\sqrt{T} & i\\sqrt{R} \\\\ i\\sqrt{R} & \\sqrt{T} \\end{pmatrix} \\begin{pmatrix} a_{in,1} \\\\ a_{in,2} \\end{pmatrix}\n$$\n门操作被宣告成功，当且仅当输出模式$c'_1$中的光子数与输入模式$c_1$中的光子数相同，并且输出模式$t'_1$中的光子数与输入模式$t_1$中的光子数相同。\n\n该概率门的理想版本是在$|11\\rangle$分量上施加一个相对于$|01\\rangle$和$|10\\rangle$分量为$-1$的相位，这需要使用$R_{ideal}=3/4$的理想反射率。你的任务是分析当使用一个反射率为任意值$R$（其中$0 < R < 1$）的非理想分束器时，该门的性能。\n\n假设双量子比特系统被制备在初始态：\n$$\n|\\Psi_{in}\\rangle = \\frac{1}{2} \\left( |00\\rangle + |01\\rangle + |10\\rangle + |11\\rangle \\right)\n$$\n计算使用理想分束器（$R=R_{ideal}=3/4$）得到的归一化后选择态与使用非理想分束器（反射率为$R$）得到的归一化后选择态之间的保真度$F = |\\langle \\Psi_{out}^{ideal} | \\Psi_{out}^{actual} \\rangle|^2$。请将你的答案表示为$R$的闭式解析函数。", "solution": "该问题要求计算一个概率性C-PHASE门在理想分束器和非理想分束器情况下，其后选择输出态之间的保真度。输入态为$|\\Psi_{in}\\rangle = \\frac{1}{2} \\sum_{i,j \\in \\{0,1\\}} |ij\\rangle$。\n\n门操作只影响模式$c_1$和$t_1$。我们需要分析四个计算基矢$|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle$的变换。对于每个基矢，在相互作用模式$(c_1, t_1)$中的态分别为$|00\\rangle$, $|01\\rangle$, $|10\\rangle$和$|11\\rangle$。让我们找出经过反射率为$R$、透射率为$T=1-R$的分束器后的输出态。\n\n1.  **输入$|00\\rangle$**：输入到相互作用模式$(c_1, t_1)$的态是$|0,0\\rangle$。经过分束器后，该态保持为$|0,0\\rangle$。后选择条件（输入与输出光子数相同）得到满足。此过程的振幅为$1$。\n    $|00\\rangle_{CT} \\rightarrow |00\\rangle_{CT}$\n\n2.  **输入$|01\\rangle$**：输入到$(c_1, t_1)$的态是$|0,1\\rangle$。分束器对此态的变换如下：\n    $|0,1\\rangle_{c_1, t_1} \\rightarrow i\\sqrt{R}|1,0\\rangle_{c'_1, t'_1} + \\sqrt{T}|0,1\\rangle_{c'_1, t'_1}$\n    后选择条件要求模式$(c'_1, t'_1)$中的输出态为$|0,1\\rangle$。未归一化的后选择态为$\\sqrt{T}|0,1\\rangle_{c'_1, t'_1}$。整体逻辑态变换为：\n    $|01\\rangle_{CT} \\rightarrow \\sqrt{T}|01\\rangle_{CT}$\n    对此输入的成功概率为$P(|01\\rangle) = (\\sqrt{T})^2 = T$。\n\n3.  **输入$|10\\rangle$**：输入到$(c_1, t_1)$的态是$|1,0\\rangle$。其变换为：\n    $|1,0\\rangle_{c_1, t_1} \\rightarrow \\sqrt{T}|1,0\\rangle_{c'_1, t'_1} + i\\sqrt{R}|0,1\\rangle_{c'_1, t'_1}$\n    在输出态$|1,0\\rangle_{c'_1, t'_1}$上进行后选择，得到未归一化的态$\\sqrt{T}|1,0\\rangle_{c'_1, t'_1}$。逻辑态变换为：\n    $|10\\rangle_{CT} \\rightarrow \\sqrt{T}|10\\rangle_{CT}$\n    成功概率为$P(|10\\rangle) = (\\sqrt{T})^2 = T$。\n\n4.  **输入$|11\\rangle$**：输入到$(c_1, t_1)$的态是$|1,1\\rangle$。这个双光子态的变换如下：\n    $|1,1\\rangle_{c_1, t_1} \\rightarrow (T-R)|1,1\\rangle_{c'_1, t'_1} + i\\sqrt{2RT}\\left(|2,0\\rangle_{c'_1, t'_1} + |0,2\\rangle_{c'_1, t'_1}\\right)$\n    在输出态$|1,1\\rangle_{c'_1, t'_1}$上进行后选择，得到未归一化的态$(T-R)|1,1\\rangle_{c'_1, t'_1}$。逻辑态变换为：\n    $|11\\rangle_{CT} \\rightarrow (T-R)|11\\rangle_{CT}$\n    成功概率为$P(|11\\rangle) = (T-R)^2$。\n\n综合这些结果，对于输入态$|\\Psi_{in}\\rangle$，未归一化的后选择态为：\n$$\n|\\Psi_{out, unnorm}\\rangle = \\frac{1}{2}\\left( |00\\rangle + \\sqrt{T}|01\\rangle + \\sqrt{T}|10\\rangle + (T-R)|11\\rangle \\right)\n$$\n\n现在，我们针对理想和实际情况分别进行评估。\n\n**A. 理想情况：$R_{ideal}=3/4$**\n$T_{ideal} = 1 - 3/4 = 1/4$。\n未归一化的输出态为：\n$$\n|\\Psi_{out, unnorm}^{ideal}\\rangle = \\frac{1}{2}\\left( |00\\rangle + \\sqrt{1/4}|01\\rangle + \\sqrt{1/4}|10\\rangle + (1/4 - 3/4)|11\\rangle \\right)\n$$\n$$\n|\\Psi_{out, unnorm}^{ideal}\\rangle = \\frac{1}{2}\\left( |00\\rangle + \\frac{1}{2}|01\\rangle + \\frac{1}{2}|10\\rangle - \\frac{1}{2}|11\\rangle \\right)\n$$\n对于给定输入态，理想门的总体成功概率是此态的模方：\n$$\nP_{succ}^{ideal} = \\| |\\Psi_{out, unnorm}^{ideal}\\rangle \\|^2 = \\left(\\frac{1}{2}\\right)^2 \\left( 1^2 + \\left(\\frac{1}{2}\\right)^2 + \\left(\\frac{1}{2}\\right)^2 + \\left(-\\frac{1}{2}\\right)^2 \\right) = \\frac{1}{4}\\left(1 + \\frac{1}{4} + \\frac{1}{4} + \\frac{1}{4}\\right) = \\frac{1}{4}\\left(\\frac{7}{4}\\right) = \\frac{7}{16}\n$$\n归一化的理想输出态是：\n$$\n|\\Psi_{out}^{ideal}\\rangle = \\frac{1}{\\sqrt{P_{succ}^{ideal}}} |\\Psi_{out, unnorm}^{ideal}\\rangle = \\frac{4}{\\sqrt{7}} \\frac{1}{2}\\left( |00\\rangle + \\frac{1}{2}|01\\rangle + \\frac{1}{2}|10\\rangle - \\frac{1}{2}|11\\rangle \\right) = \\frac{2}{\\sqrt{7}}\\left( |00\\rangle + \\frac{1}{2}(|01\\rangle + |10\\rangle - |11\\rangle) \\right)\n$$\n\n**B. 实际情况：任意反射率$R$**\n$T = 1-R$。\n未归一化的输出态是：\n$$\n|\\Psi_{out, unnorm}^{actual}\\rangle = \\frac{1}{2}\\left( |00\\rangle + \\sqrt{1-R}|01\\rangle + \\sqrt{1-R}|10\\rangle + (1-2R)|11\\rangle \\right)\n$$\n成功概率是：\n$$\nP_{succ}^{actual} = \\| |\\Psi_{out, unnorm}^{actual}\\rangle \\|^2 = \\frac{1}{4}\\left( 1^2 + (\\sqrt{1-R})^2 + (\\sqrt{1-R})^2 + (1-2R)^2 \\right)\n$$\n$$\nP_{succ}^{actual} = \\frac{1}{4}\\left( 1 + (1-R) + (1-R) + (1-4R+4R^2) \\right) = \\frac{1}{4}\\left( 1+2-2R+1-4R+4R^2 \\right) = \\frac{1}{4}\\left( 4 - 6R + 4R^2 \\right) = 1 - \\frac{3}{2}R + R^2\n$$\n归一化的实际输出态是 $|\\Psi_{out}^{actual}\\rangle = (P_{succ}^{actual})^{-1/2} |\\Psi_{out, unnorm}^{actual}\\rangle$。\n\n**C. 保真度计算**\n保真度为$F = |\\langle \\Psi_{out}^{ideal} | \\Psi_{out}^{actual} \\rangle|^2$。归一化态的内积是：\n$$\n\\langle \\Psi_{out}^{ideal} | \\Psi_{out}^{actual} \\rangle = \\frac{\\langle \\Psi_{out, unnorm}^{ideal} | \\Psi_{out, unnorm}^{actual} \\rangle}{\\sqrt{P_{succ}^{ideal} P_{succ}^{actual}}}\n$$\n首先，计算未归一化态的内积：\n$$\n\\langle \\Psi_{out, unnorm}^{ideal} | \\Psi_{out, unnorm}^{actual} \\rangle = \\left(\\frac{1}{2}\\right)^2 \\left( 1 \\cdot 1 + \\frac{1}{2}\\sqrt{1-R} + \\frac{1}{2}\\sqrt{1-R} - \\frac{1}{2}(1-2R) \\right)\n$$\n$$\n= \\frac{1}{4} \\left( 1 + \\sqrt{1-R} - \\frac{1}{2} + R \\right) = \\frac{1}{4} \\left( \\frac{1}{2} + R + \\sqrt{1-R} \\right)\n$$\n现在，我们计算保真度的平方：\n$$\nF = \\frac{|\\langle \\Psi_{out, unnorm}^{ideal} | \\Psi_{out, unnorm}^{actual} \\rangle|^2}{P_{succ}^{ideal} P_{succ}^{actual}} = \\frac{\\left[ \\frac{1}{4} \\left( \\frac{1}{2} + R + \\sqrt{1-R} \\right) \\right]^2}{\\left( \\frac{7}{16} \\right) \\left( 1 - \\frac{3}{2}R + R^2 \\right)}\n$$\n$$\nF = \\frac{\\frac{1}{16} \\left( \\frac{1}{2} + R + \\sqrt{1-R} \\right)^2}{\\frac{7}{16} \\left( 1 - \\frac{3}{2}R + R^2 \\right)} = \\frac{\\left( \\frac{1}{2} + R + \\sqrt{1-R} \\right)^2}{7 \\left( 1 - \\frac{3}{2}R + R^2 \\right)}\n$$\n为了简化表达式，分子和分母同乘以4：\n$$\nF = \\frac{4 \\left( \\frac{1}{2} + R + \\sqrt{1-R} \\right)^2}{28 \\left( 1 - \\frac{3}{2}R + R^2 \\right)} = \\frac{\\left( 2(\\frac{1}{2} + R + \\sqrt{1-R}) \\right)^2}{28 - 42R + 28R^2}\n$$\n$$\nF = \\frac{\\left( 1 + 2R + 2\\sqrt{1-R} \\right)^2}{28 - 42R + 28R^2}\n$$", "answer": "$$ \\boxed{\\frac{\\left( 1 + 2R + 2\\sqrt{1-R} \\right)^2}{28 - 42R + 28R^2}} $$", "id": "109494"}]}