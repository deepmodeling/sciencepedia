{"hands_on_practices": [{"introduction": "Shor算法的精髓在于将大数分解问题巧妙地转化为一个周期寻找问题。本练习将揭示该算法的数论核心：利用中国剩余定理，你将探索周期 $r$ (模 $N$) 如何由其在素因子 $p$ 和 $q$ 下的周期 $r_1$ 和 $r_2$ 唯一确定。这一个实践练习将帮助你理解周期寻找为何是破解RSA加密体系的关键。[@problem_id:132634]", "problem": "在用于分解合数 $N = p_1 p_2$（其中 $p_1$ 和 $p_2$ 是不同的素因子）的 Shor 算法中，一个关键步骤是周期寻找子程序。该子程序使用量子计算机来寻找函数 $f(x) = a^x \\pmod{N}$ 的周期 $r$，其中基数 $a$ 是随机选择的且与 $N$ 互质。周期 $r$ 被定义为满足 $a^r \\equiv 1 \\pmod{N}$ 的最小正整数。\n\n根据中国剩余定理，模 $N$ 的整数乘法群 $(\\mathbb{Z}/N\\mathbb{Z})^*$ 与其素因子模群的直积 $(\\mathbb{Z}/p_1\\mathbb{Z})^* \\times (\\mathbb{Z}/p_2\\mathbb{Z})^*$ 同构。这意味着元素 $a$ 模 $N$ 的阶（或周期）$r$ 由其模 $p_1$ 和 $p_2$ 的阶决定。设 $r_1$ 是 $a$ 模 $p_1$ 的阶，$r_2$ 是 $a$ 模 $p_2$ 的阶。\n\n考查分解数 $N$ 的任务。我们已知其素因子为 $p_1$ 和 $p_2$。对于一个特定的基数 $a$，我们发现其模 $p_1$ 的阶为 $r_1 = 6$，模 $p_2$ 的阶为 $r_2 = 5$。\n\n确定函数 $f(x) = a^x \\pmod{N}$ 的周期 $r$。", "solution": "函数 $f(x) = a^x \\pmod{N}$ 的周期 $r$ 是满足 $a^r \\equiv 1 \\pmod{N}$ 的最小正整数。给定 $N = p_1 p_2$，其中 $p_1$ 和 $p_2$ 是不同的素数，且 $a$ 与 $N$ 互质，根据中国剩余定理可得：\n\n$$\na^r \\equiv 1 \\pmod{N} \\quad \\text{if and only if} \\quad \n\\begin{cases}\na^r \\equiv 1 \\pmod{p_1} \\\\\na^r \\equiv 1 \\pmod{p_2}\n\\end{cases}\n$$\n\n条件 $a^r \\equiv 1 \\pmod{p_1}$ 和 $a^r \\equiv 1 \\pmod{p_2}$ 要求 $r$ 分别是阶 $r_1$（模 $p_1$）和 $r_2$（模 $p_2$）的倍数。已知 $r_1 = 6$ 和 $r_2 = 5$，所以：\n\n$$\nr \\text{ must be a multiple of } 6 \\quad \\text{and} \\quad r \\text{ must be a multiple of } 5.\n$$\n\n因此，$r$ 是 $5$ 和 $6$ 的公倍数。最小公倍数 (LCM) 是满足此条件的最小正整数。由于 $5$ 和 $6$ 互质 ($\\gcd(5,6) = 1$)：\n\n$$\n\\operatorname{LCM}(5, 6) = 5 \\times 6 = 30.\n$$\n\n验证 $r = 30$ 满足 $a^r \\equiv 1 \\pmod{N}$：\n- 模 $p_1$：$a^{30} = (a^6)^5 \\equiv 1^5 \\equiv 1 \\pmod{p_1}$，因为 $r_1 = 6$ 整除 $30$。\n- 模 $p_2$：$a^{30} = (a^5)^6 \\equiv 1^6 \\equiv 1 \\pmod{p_2}$，因为 $r_2 = 5$ 整除 $30$。\n根据中国剩余定理，$a^{30} \\equiv 1 \\pmod{N}$。任何小于 $30$ 的 $5$ 和 $6$ 的正公倍数都不存在，因为 $30$ 是它们的最小公倍数。因此，周期 $r = 30$。", "answer": "$$ \\boxed{30} $$", "id": "132634"}, {"introduction": "在确定了算法的数论目标之后，我们转向实现这一目标的量子引擎——量子相位估计算法 (QPE)。为了保证算法的成功，相位估计必须达到极高的精度，而这直接决定了量子寄存器所需的量子比特数。本练习将指导你进行具体的资源估算，将抽象的算法要求与实际的物理实现联系起来。[@problem_id:132696]", "problem": "在用于对整数 $N$ 进行因数分解的 Shor 算法中，一个关键的子程序是量子相位估计 (Quantum Phase Estimation, QPE) 算法。该子程序用于对一个与 $N$ 互质的随机基底 $a$，求出函数 $f(x) = a^x \\pmod N$ 的周期 $r$。QPE 算法被应用于一个幺正算符 $U$，其对计算基态 $|y\\rangle$ 的作用定义为 $U|y\\rangle = |ay \\pmod N\\rangle$。该算符的特征值为 $e^{i\\phi_s}$ 形式，其中相位为 $\\phi_s = 2\\pi s/r$，整数 $s \\in \\{0, 1, \\dots, r-1\\}$。\n\nQPE 算法使用一个 $t$-量子比特寄存器（“相位寄存器”），并输出一个整数 $j \\in \\{0, 1, \\dots, 2^t-1\\}$。这个测量结果用于生成其中一个相位 $\\phi = s/r$ 的有理数近似值 $\\tilde{\\phi} = j/2^t$（这里我们省略了因子 $2\\pi$）。\n\nShor 算法的后续经典部分会使用连分数算法，从估计值 $j/2^t$ 中找到周期 $r$。为此，相位估计必须高度精确。具体来说，误差必须满足不等式：\n$$ \\left| \\frac{s}{r} - \\frac{j}{2^t} \\right| < \\frac{1}{2N^2} $$\n为了获得高的成功概率，必须仔细选择相位寄存器中的量子比特数 $t$。QPE 算法保证，它能够以至少 $1 - \\epsilon$ 的成功概率将相位 $\\phi$ 估计到 $n$ 比特的精度（即误差 $|\\phi - \\tilde{\\phi}|$ 的上界为 $2^{-n}$）。如果量子比特数 $t$ 选择为以下值，则此保证成立：\n$$ t = n + \\left\\lceil \\log_2\\left(2 + \\frac{1}{2\\epsilon}\\right) \\right\\rceil $$\n你的任务是计算在分解整数 $N=511$ 时，相位估计寄存器所需的最小整数量子比特数 $t$。这需要确保测量的相位足够精确，从而使连分数算法能够以至少 $1-\\epsilon$ 的概率成功，其中失败容忍度 $\\epsilon=1/4$。", "solution": "我们要求相位估计误差满足如下界限：\n$$\\left| \\frac{s}{r} - \\frac{j}{2^t} \\right|  \\frac{1}{2N^2}$$\n而 QPE 算法保证了误差 $|\\phi-\\tilde\\phi|\\le2^{-n}$，因此我们要求\n$$2^{-n} \\le \\frac{1}{2N^2} \\quad\\implies\\quad 2^n \\ge 2N^2 \\quad\\implies\\quad n \\ge \\log_2(2N^2)$$\n对于 $N=511$，我们计算\n$$2N^2=2\\cdot511^2=2\\cdot261121=522242,$$\n并且由于 $2^{18}=262144522242524288=2^{19}$，我们有\n$$n=\\lceil\\log_2(522242)\\rceil=19.$$\n接着，为达到 $\\epsilon=1/4$ 的失败容忍度，我们使用\n$$t=n+\\left\\lceil \\log_2\\left(2 + \\frac{1}{2\\epsilon}\\right) \\right\\rceil\n=19+\\left\\lceil \\log_2(2+2) \\right\\rceil\n=19+\\lceil\\log_2(4)\\rceil\n=19+2=21.$$", "answer": "$$\\boxed{21}$$", "id": "132696"}, {"introduction": "量子计算并非终点，它只提供了“线索”，我们仍需经典的后处理来解开谜底。QPE算法的测量结果为我们提供了分数 $s/r$ 的一个近似值 $y/Q$。本练习将演示至关重要的经典后处理步骤：如何运用连分数算法，从这个有理数近似中精确地还原出周期 $r$。[@problem_id:132720]", "problem": "在用于分解整数 $N$ 的 Shor 算法中，一个关键的子程序是使用量子相位估计算法 (QPE) 来寻找函数 $f(x) = a^x \\pmod{N}$ 对于一个随机选择的基数 $a$ 的周期 $r$。QPE 电路使用一个 $t$ 比特寄存器，会产生一个测量结果，即一个整数 $y$，其中 $0 \\le y  Q = 2^t$。这个测量结果为相位 $\\phi = s/r$（对于某个整数 $s$，$0 \\le s  r$）提供了一个估计，该估计由近似式 $\\phi \\approx y/Q$ 给出。\n\n为了从这个近似值中恢复周期 $r$，我们经典地计算 $y/Q$ 的连分数展开。该展开的有理渐近分数是 $y/Q$ 的一系列越来越好的有理数近似。这些渐近分数中的某一个的分母是周期 $r$ 或 $r$ 的一个因子的良好候选。\n\n一个实数 $x$ 的连分数展开是形如 $[a_0; a_1, a_2, \\dots]$ 的表达式，其中的整数 $a_i$ 计算如下：\n$x_0 = x, a_0 = \\lfloor x_0 \\rfloor$\n$x_1 = 1/(x_0 - a_0), a_1 = \\lfloor x_1 \\rfloor$\n$x_2 = 1/(x_1 - a_1), a_2 = \\lfloor x_2 \\rfloor$\n... 以此类推，直到过程终止（对于有理数 $x$）或无限进行下去（对于无理数 $x$）。\n\n第 $k$ 个有理渐近分数 $C_k = p_k/q_k$ 由此展开式的前 $k+1$ 项给出：$C_k = [a_0; a_1, \\dots, a_k]$。分子 $p_k$ 和分母 $q_k$ 可以使用以下递推关系高效地计算：\n$p_k = a_k p_{k-1} + p_{k-2}$，其中 $p_{-2} = 0, p_{-1} = 1$\n$q_k = a_k q_{k-1} + q_{k-2}$，其中 $q_{-2} = 1, q_{-1} = 0$\n\n考虑一个 Shor 算法的实例，该实例试图寻找 $a=2$ 模 $N=33$ 的周期。QPE 电路使用一个 $t=8$ 比特的寄存器（因此 $Q=2^8=256$）并返回测量结果 $y=102$。你的任务是从测量得到的相位估计 $y/Q$ 的连分数展开中，计算出有理渐近分数 $C_2 = p_2/q_2$。", "solution": "该问题要求计算分数 $y/Q = 102/256$ 的有理渐近分数 $C_2 = p_2/q_2$。\n\n首先，我们简化这个分数：\n$$ x = \\frac{102}{256} = \\frac{51}{128} $$\n\n接下来，我们应用连分数算法来寻找系数 $a_0, a_1, a_2$。\n\n**步骤 0:**\n$x_0 = \\frac{51}{128}$\n$a_0 = \\lfloor x_0 \\rfloor = \\lfloor \\frac{51}{128} \\rfloor = 0$\n\n**步骤 1:**\n$x_1 = \\frac{1}{x_0 - a_0} = \\frac{1}{\\frac{51}{128} - 0} = \\frac{128}{51}$\n$a_1 = \\lfloor x_1 \\rfloor = \\lfloor \\frac{128}{51} \\rfloor = \\lfloor 2.509... \\rfloor = 2$\n\n**步骤 2:**\n$x_2 = \\frac{1}{x_1 - a_1} = \\frac{1}{\\frac{128}{51} - 2} = \\frac{1}{\\frac{128 - 102}{51}} = \\frac{1}{\\frac{26}{51}} = \\frac{51}{26}$\n$a_2 = \\lfloor x_2 \\rfloor = \\lfloor \\frac{51}{26} \\rfloor = \\lfloor 1.961... \\rfloor = 1$\n\n我们现在已经找到了连分数展开的前三个系数：$a_0=0$, $a_1=2$ 和 $a_2=1$。该展开以 $[0; 2, 1, \\dots]$ 开始。这足以计算出渐近分数 $C_2$。\n\n现在，我们使用递推关系来求出 $k=0, 1, 2$ 时的分子 $p_k$ 和分母 $q_k$。\n初始条件是 $p_{-2} = 0, p_{-1} = 1$ 和 $q_{-2} = 1, q_{-1} = 0$。\n\n**对于 k = 0:** ($a_0 = 0$)\n$p_0 = a_0 p_{-1} + p_{-2} = 0 \\cdot 1 + 0 = 0$\n$q_0 = a_0 q_{-1} + q_{-2} = 0 \\cdot 0 + 1 = 1$\n所以，第零个渐近分数是 $C_0 = p_0/q_0 = 0/1$。\n\n**对于 k = 1:** ($a_1 = 2$)\n$p_1 = a_1 p_0 + p_{-1} = 2 \\cdot 0 + 1 = 1$\n$q_1 = a_1 q_0 + q_{-1} = 2 \\cdot 1 + 0 = 2$\n第一个渐近分数是 $C_1 = p_1/q_1 = 1/2$。\n\n**对于 k = 2:** ($a_2 = 1$)\n$p_2 = a_2 p_1 + p_0 = 1 \\cdot 1 + 0 = 1$\n$q_2 = a_2 q_1 + q_0 = 1 \\cdot 2 + 1 = 3$\n第二个渐近分数是 $C_2 = p_2/q_2 = 1/3$。\n\n所求的渐近分数是 $C_2$。", "answer": "$$ \\boxed{\\frac{1}{3}} $$", "id": "132720"}]}