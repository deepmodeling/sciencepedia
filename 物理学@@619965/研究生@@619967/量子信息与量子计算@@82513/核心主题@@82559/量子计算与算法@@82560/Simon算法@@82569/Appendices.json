{"hands_on_practices": [{"introduction": "标准的西蒙算法始于 $|0^n\\rangle|0^n\\rangle$ 态。本练习邀请您探索当我们偏离此标准，将输入寄存器直接制备在密钥本身所对应的态 $|s\\rangle$ 时会发生什么。通过解决这个变体问题，您将更深刻地理解初始的哈达玛变换与预言机的相位反冲机制如何协同作用，从而将关于隐藏字符串 $s$ 的信息编码到量子态中 [@problem_id:134173]。", "problem": "西蒙算法通过查询一个计算函数 $f: \\{0, 1\\}^n \\to \\{0, 1\\}^n$ 的预言机来确定一个隐藏的非零字符串 $s \\in \\{0, 1\\}^n \\setminus \\{0^n\\}$。该函数满足一个承诺，即对于任意 $x, y \\in \\{0, 1\\}^n$，条件 $f(x) = f(y)$ 成立当且仅当 $x \\oplus y = 0^n$ 或 $x \\oplus y = s$，其中 $\\oplus$ 是按位异或运算。\n\n西蒙算法的标准量子线路在两个各含 $n$ 个量子比特的寄存器上运行，并包含以下步骤：\n1. 将系统初始化到状态 $|0^n\\rangle|0^n\\rangle$。\n2. 对第一个寄存器应用哈达玛变换 $H^{\\otimes n}$。\n3. 应用量子预言机 $U_f$，其作用为 $U_f|x\\rangle|y\\rangle = |x\\rangle|y \\oplus f(x)\\rangle$。\n4. 再次对第一个寄存器应用哈达玛变换 $H^{\\otimes n}$。\n5. 在计算基下测量第一个寄存器，得到一个字符串 $y \\in \\{0,1\\}^n$。\n\n考虑该算法的一个变体，其中初始状态为 $|\\psi_{init}\\rangle = |s\\rangle|0^n\\rangle$，而 $s$ 正是定义函数 $f$ 属性的那个秘密字符串。算法的其余部分（步骤2-5）按上述描述进行。\n\n假设已知秘密字符串 $s$ 具有偶数汉明权重，即 $w(s) \\equiv \\sum_{i=1}^n s_i = 0 \\pmod 2$。计算在这个修改后的算法执行一次后，在第一个寄存器中测量到全零字符串 $y=0^n$ 的概率。将您的答案表示为 $n$ 的函数。", "solution": "我们将两个 $n$ 量子比特寄存器分别标记为 $A$（第一个）和 $B$（第二个）。修改后的算法按如下步骤进行。\n\n1. 初始状态：\n$$|\\psi_0\\rangle=|s\\rangle_A|0^n\\rangle_B.$$\n\n2. 对寄存器 $A$ 应用哈达玛变换 $H^{\\otimes n}$ 后：\n$$|\\psi_1\\rangle\n=\\frac1{\\sqrt{2^n}}\\sum_{x\\in\\{0,1\\}^n}(-1)^{s\\cdot x}|x\\rangle_A|0^n\\rangle_B\n,\\quad s\\cdot x\\equiv\\sum_i s_i x_i\\pmod2.$$\n\n3. 应用预言机 $U_f:|x\\rangle|y\\rangle\\mapsto|x\\rangle|y\\oplus f(x)\\rangle$：\n$$|\\psi_2\\rangle\n=\\frac1{\\sqrt{2^n}}\\sum_{x}(-1)^{s\\cdot x}|x\\rangle_A|f(x)\\rangle_B.$$\n\n4. 对寄存器 $A$ 再次应用 $H^{\\otimes n}$：\n$$|\\psi_3\\rangle\n=\\frac1{2^n}\\sum_{x,y}(-1)^{s\\cdot x + x\\cdot y}\\,|y\\rangle_A\\,|f(x)\\rangle_B.$$\n\n5. 将关于 $x$ 的求和按配对 $\\{v,v\\oplus s\\}$ 分组（因为 $f(v)=f(v\\oplus s)$）：\n$$\\sum_{x}(-1)^{(s+y)\\cdot x}|f(x)\\rangle\n=\\sum_{v}\\Bigl[(-1)^{(s+y)\\cdot v}+(-1)^{(s+y)\\cdot(v\\oplus s)}\\Bigr]|f(v)\\rangle.$$\n因为 $(s+y)\\cdot(v\\oplus s)=(s+y)\\cdot v + s\\cdot s + y\\cdot s$ 且 $s\\cdot s=w(s)\\equiv0\\pmod2$，上式变为\n$$\\sum_{x}(-1)^{(s+y)\\cdot x}|f(x)\\rangle\n=\\bigl[1+(-1)^{y\\cdot s}\\bigr]\\sum_{v}(-1)^{(s+y)\\cdot v}|f(v)\\rangle.$$\n\n6. $f(v)$ 有 $2^{n-1}$ 个不同的值，在寄存器 $B$ 中是标准正交的。因此 $|y\\rangle_A$ 的振幅是\n$$\\frac{1}{2^n}\\bigl[1+(-1)^{y\\cdot s}\\bigr]\\sum_v(-1)^{(s+y)\\cdot v}|f(v)\\rangle_B,$$\n其模的平方给出测量概率\n$$P(y)\n=\\frac1{2^{2n}}\\bigl|1+(-1)^{y\\cdot s}\\bigr|^2\\cdot2^{\\,n-1}\n=\\frac1{2^{n+1}}\\bigl|1+(-1)^{y\\cdot s}\\bigr|^2.$$\n\n7. 对于 $y=0^n$，我们有 $y\\cdot s=0$，所以 $1+(-1)^{y\\cdot s}=2$，并且\n$$P(0^n)=\\frac1{2^{n+1}}\\times2^2=\\frac{4}{2^{n+1}}=2^{1-n}.$$", "answer": "$$\\boxed{2^{1-n}}$$", "id": "134173"}, {"introduction": "西蒙算法的最后一步，即对输入寄存器应用哈达玛变换，是提取解的关键。但究竟是什么让这个特定的变换如此特殊？本练习挑战您将完整的 $H^{\\otimes n}$ 替换为部分变换，让您亲眼见证这一改变如何影响最终的测量结果，并加深对量子傅里叶变换在计算基测量中作用的理解 [@problem_id:134091]。", "problem": "Simon 算法是一个解决以下问题的量子算法：给定一个函数 $f: \\{0,1\\}^n \\to \\{0,1\\}^n$，我们被承诺存在一个秘密二进制字符串 $s \\in \\{0,1\\}^n$，使得对于任意两个输入 $x, y \\in \\{0,1\\}^n$，条件 $f(x) = f(y)$ 成立当且仅当 $x \\oplus y = 0^n$ 或 $x \\oplus y = s$。这里 $\\oplus$ 表示按位异或运算，$0^n$ 是由 $n$ 个零组成的字符串。目标是找到这个秘密字符串 $s$。\n\n该算法从两个各有 $n$ 个量子比特的寄存器开始，它们被初始化为 $|0\\rangle^{\\otimes n}|0\\rangle^{\\otimes n}$。对第一个寄存器应用 Hadamard 变换，然后查询将 $|x\\rangle|y\\rangle$ 映射到 $|x\\rangle|y \\oplus f(x)\\rangle$ 的预言机 $U_f$ 后，对第二个寄存器进行测量。如果这次测量的结果是某个值 $z_0$，那么第一个寄存器的状态会坍缩为：\n$$\n|\\psi\\rangle = \\frac{1}{\\sqrt{2}}(|x_0\\rangle + |x_0 \\oplus s\\rangle)\n$$\n其中 $x_0$ 是 $z_0$ 的两个原像之一（即 $f(x_0) = z_0$）。由于初始状态是所有可能输入的均匀叠加，对 $\\{x_0, x_0 \\oplus s\\}$ 是从划分输入空间 $\\{0,1\\}^n$ 的 $2^{n-1}$ 个可能的对中均匀随机选择的。\n\n考虑一个修改版的 Simon 算法，其中第一个寄存器中有 $n=3$ 个量子比特。已知秘密字符串为 $s=100$。如上所述，在第一个寄存器的状态坍缩到 $|\\psi\\rangle$ 后，我们不对此寄存器应用标准的 Hadamard 变换 $H^{\\otimes 3}$，而是应用酉算子 $U = H \\otimes I \\otimes I$，其中 $H$ 是单量子比特 Hadamard 门，$I$ 是单量子比特单位门。\n\n计算在应用酉算子 $U$ 后，从第一个寄存器测量到输出状态 $y=011$ 的概率。", "solution": "我们有第一个寄存器测量后的状态\n$$\n|\\psi\\rangle \\;=\\;\\frac{1}{\\sqrt{2}}\\bigl(|x_0\\rangle+|x_0\\oplus s\\rangle\\bigr)\n$$\n其中 $s=100$。由于陪集是 $\\{0x_1x_2,1x_1x_2\\}$，我们可以写出\n$$\nx_0=(0,x_1,x_2), \n\\qquad\nx_0\\oplus s=(1,x_1,x_2),\n$$\n所以\n$$\n|\\psi\\rangle\n=\\frac{1}{\\sqrt{2}}\\bigl(|0\\,x_1x_2\\rangle+|1\\,x_1x_2\\rangle\\bigr).\n$$\n应用 $U=H\\otimes I\\otimes I$。使用\n$$\nH|0\\rangle=\\frac{|0\\rangle+|1\\rangle}{\\sqrt{2}}, \n\\quad\nH|1\\rangle=\\frac{|0\\rangle-|1\\rangle}{\\sqrt{2}},\n$$\n我们得到\n\\begin{align*}\nU|\\psi\\rangle\n&=\\frac{1}{\\sqrt{2}}\\Bigl(H|0\\rangle\\otimes|x_1x_2\\rangle+H|1\\rangle\\otimes|x_1x_2\\rangle\\Bigr)\\\\\n&=\\frac{1}{\\sqrt{2}}\\Bigl(\\frac{|0\\rangle+|1\\rangle}{\\sqrt{2}}+\\frac{|0\\rangle-|1\\rangle}{\\sqrt{2}}\\Bigr)\\otimes|x_1x_2\\rangle\\\\\n&=\\frac{1}{2}\\bigl(2\\,|0\\rangle\\bigr)\\otimes|x_1x_2\\rangle\n=|0\\,x_1x_2\\rangle.\n\\end{align*}\n因此，测量结果确定为 $y=(0,x_1,x_2)$。因为 $(x_1,x_2)$ 在四个比特对上是均匀分布的，\n$$\n\\text{Pr}[y=011]\n=\\text{Pr}[(0,x_1,x_2)=(0,1,1)]\n=\\frac{1}{4}.\n$$", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "134091"}, {"introduction": "理想的量子算法在一个完美无瑕、没有噪声的环境中运行，但这在现实世界的量子计算机中是一种奢侈。本问题引入了一个简单但功能强大的错误预言机模型，该预言机有时会执行失败。通过分析这种情况，您将获得使用密度矩阵形式化方法来描述和预测量子算法在噪声存在时的行为的实践经验 [@problem_id:134202]。", "problem": "西蒙算法是一种量子算法，对于一个函数 $f:\\{0,1\\}^n \\to \\{0,1\\}^n$，它可以高效地找到一个隐藏字符串 $s \\in \\{0,1\\}^n \\setminus \\{0^n\\}$。该函数保证满足性质：对于任意 $x, x' \\in \\{0,1\\}^n$，$f(x)=f(x')$ 当且仅当 $x' = x \\oplus s$，其中 $\\oplus$ 表示按位异或操作。\n\n标准算法的流程如下：\n1.  将两个$n$量子比特寄存器制备在状态 $|0^n\\rangle|0^n\\rangle$。\n2.  对第一个寄存器施加哈达玛变换 $H^{\\otimes n}$。\n3.  施加量子谕示 $U_f$，它执行变换 $U_f|x\\rangle|y\\rangle = |x\\rangle|y \\oplus f(x)\\rangle$。\n4.  对第一个寄存器施加哈达玛变换 $H^{\\otimes n}$。\n5.  在计算基下测量第一个寄存器。结果是一个字符串 $y \\in \\{0,1\\}^n$，使得按位点积 $y \\cdot s = 0 \\pmod 2$。\n\n考虑对该算法的一个修改，其中步骤3中的谕示是有故障的。它以 $1-p$ 的概率施加正确的谕示 $U_f$。以 $p$ 的概率，它会失效并对两个寄存器都施加单位算符 $I$。这个有故障的谕示对密度矩阵 $\\rho$ 的作用由量子信道 $\\mathcal{E}(\\rho) = (1-p)U_f \\rho U_f^\\dagger + p \\rho$ 描述。\n\n设每个寄存器的量子比特数为 $n=3$，隐藏字符串为 $s=101$。从初始状态 $|0^3\\rangle|0^3\\rangle$ 开始，运行一次修改后的算法后，第一个寄存器上的可观测量 $O = Z \\otimes I \\otimes I$ 的最终期望值是多少？这里，$Z$ 是泡利-Z矩阵，$I$ 是 $2 \\times 2$ 单位矩阵。", "solution": "1. 有故障的谕示信道与期望线性性  \n第一个寄存器上的最终状态是权重为 $1-p$ 的正确西蒙状态与权重为 $p$ 的单位谕示状态的混合。因此对于可观测量 $O$\n$$\\rho_{\\rm final}=(1-p)\\,\\rho_{\\rm correct}+p\\,\\rho_{\\rm id},$$  \n$$\\langle O\\rangle=(1-p)\\text{Tr}[O\\,\\rho_{\\rm correct}]+p\\text{Tr}[O\\,\\rho_{\\rm id}].$$\n\n2. 谕示为单位算符时的期望值  \n如果 $U_f$ 被 $I$ 替换，则线路为\n$$|0^3\\rangle\\xrightarrow{H^{\\otimes3}} \\tfrac1{\\sqrt8}\\sum_{x}|x\\rangle\n\\xrightarrow{I}\\tfrac1{\\sqrt8}\\sum_{x}|x\\rangle\n\\xrightarrow{H^{\\otimes3}}|0^3\\rangle.$$  \n因此 $\\rho_{\\rm id}=|0^3\\rangle\\langle0^3|$ 并且\n$$\\text{Tr}[O\\,\\rho_{\\rm id}]=\\langle0^3|Z\\otimes I\\otimes I|0^3\\rangle=+1.$$\n\n3. 对于正确的西蒙谕示的期望值  \n经过完整的西蒙线路后，第一个寄存器的约化密度矩阵是所有满足 $y\\cdot s=0\\pmod2$ 的 $y\\in\\{0,1\\}^3$ 上的均匀混合。这里 $s=(1,0,1)$，因此 $y_1+y_3=0$。四个有效的 $y$ 是  \n$$000,010,101,111$$  \n并且 $Z\\otimes I\\otimes I$ 的本征值为 $(-1)^{y_1}$。因此  \n$$\\text{Tr}[O\\,\\rho_{\\rm correct}]\n=\\frac1{4}\\sum_{y\\cdot s=0}(-1)^{y_1}\n=\\frac{2\\cdot(+1)+2\\cdot(-1)}4=0.$$\n\n4. 综合结果  \n$$\\langle O\\rangle=(1-p)\\cdot0+p\\cdot1=p.$$", "answer": "$$\\boxed{p}$$", "id": "134202"}]}