{"hands_on_practices": [{"introduction": "在量子计算中，构建复杂的量子线路通常需要依次应用一系列量子门。受控操作是创建特定纠缠态或实现量子算法的基础构件。本练习将展示如何通过组合使用基本的受控门（如CNOT和CCZ门），将一个简单的初始乘积态演化为一个复杂的纠缠态。通过逐步追踪量子态的演化并计算最终的保真度，你将掌握分析多门量子线路的实用技巧，并深入理解受控操作的构造性力量。", "problem": "考虑一个三量子比特的量子系统，其量子比特标记为 1、2 和 3。系统被初始化到状态 $|\\psi_i\\rangle = |+\\rangle_1 |0\\rangle_2 |0\\rangle_3$，其中 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$，而 $|0\\rangle, |1\\rangle$ 是标准的计算基态。\n\n一个由三个量子门组成的序列按以下顺序作用于该系统：\n1.  一个控制非门 (CNOT)，记为 $CNOT_{12}$，其中量子比特 1 为控制位，量子比特 2 为目标位。CNOT 门对计算基态 $|c\\rangle|t\\rangle$ 的作用是 $|c\\rangle|t \\oplus c\\rangle$，其中 $\\oplus$ 表示模 2 加法。\n2.  第二个 CNOT 门，记为 $CNOT_{13}$，其中量子比特 1 为控制位，量子比特 3 为目标位。\n3.  一个双控泡利 Z 门 (doubly-controlled Pauli-Z gate)，记为 $CCZ_{2,3;1}$，其中量子比特 2 和 3 为控制量子比特，量子比特 1 为目标量子比特。该门仅在两个控制量子比特都处于 $|1\\rangle$ 态时，才对目标量子比特施加一个泡利 Z 门。泡利 Z 门的定义为 $Z|0\\rangle = |0\\rangle$ 和 $Z|1\\rangle = -|1\\rangle$。\n\n设 $|\\psi_f\\rangle$ 是施加这一系列门后系统的末态。计算初态与末态之间的保真度 $F = |\\langle \\psi_i | \\psi_f \\rangle|^2$。", "solution": "初态为 $|\\psi_i\\rangle = |+\\rangle_1 |0\\rangle_2 |0\\rangle_3$，其中 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$。因此，\n\n$$\n|\\psi_i\\rangle = \\frac{1}{\\sqrt{2}} \\left( |0\\rangle_1 |0\\rangle_2 |0\\rangle_3 + |1\\rangle_1 |0\\rangle_2 |0\\rangle_3 \\right).\n$$\n\n按顺序施加量子门：\n\n1. **CNOT$_{12}$**（控制量子比特 1，目标量子比特 2）：\n   - $|0\\rangle_1 |0\\rangle_2 |0\\rangle_3 \\to |0\\rangle_1 |0\\rangle_2 |0\\rangle_3$（控制位为 0，目标位不变）。\n   - $|1\\rangle_1 |0\\rangle_2 |0\\rangle_3 \\to |1\\rangle_1 |1\\rangle_2 |0\\rangle_3$（控制位为 1，目标位翻转）。\n   结果态：\n   \n$$\n   |\\psi_1\\rangle = \\frac{1}{\\sqrt{2}} \\left( |000\\rangle + |110\\rangle \\right),\n   $$\n\n   其中 $|q_1 q_2 q_3\\rangle$ 表示 $|q_1\\rangle_1 |q_2\\rangle_2 |q_3\\rangle_3$。\n\n2. **CNOT$_{13}$**（控制量子比特 1，目标量子比特 3）：\n   - $|000\\rangle \\to |000\\rangle$（控制位为 0，目标位不变）。\n   - $|110\\rangle \\to |111\\rangle$（控制位为 1，目标位从 $|0\\rangle$ 翻转到 $|1\\rangle$）。\n   结果态：\n   \n$$\n   |\\psi_2\\rangle = \\frac{1}{\\sqrt{2}} \\left( |000\\rangle + |111\\rangle \\right).\n   $$\n\n\n3. **CCZ$_{2,3;1}$**（控制量子比特 2 和 3，目标量子比特 1；仅当两个控制位都为 $|1\\rangle$ 时，对目标位施加 Z 门）：\n   - $|000\\rangle$：控制位为 $|0\\rangle$ 和 $|0\\rangle$，所以无作用 $\\to |000\\rangle$。\n   - $|111\\rangle$：控制位为 $|1\\rangle$ 和 $|1\\rangle$，所以对目标量子比特 1 施加 Z 门：$Z|1\\rangle = -|1\\rangle \\to -|111\\rangle$。\n   末态：\n   \n$$\n   |\\psi_f\\rangle = \\frac{1}{\\sqrt{2}} \\left( |000\\rangle - |111\\rangle \\right).\n   $$\n\n\n保真度为 $F = |\\langle \\psi_i | \\psi_f \\rangle|^2$。计算内积：\n\n$$\n\\langle \\psi_i | = \\frac{1}{\\sqrt{2}} \\left( \\langle 000| + \\langle 100| \\right),\n$$\n\n\n$$\n|\\psi_f\\rangle = \\frac{1}{\\sqrt{2}} \\left( |000\\rangle - |111\\rangle \\right).\n$$\n\n因此，\n\n$$\n\\langle \\psi_i | \\psi_f \\rangle = \\left( \\frac{1}{\\sqrt{2}} \\left( \\langle 000| + \\langle 100| \\right) \\right) \\left( \\frac{1}{\\sqrt{2}} \\left( |000\\rangle - |111\\rangle \\right) \\right) = \\frac{1}{2} \\left( \\langle 000| + \\langle 100| \\right) \\left( |000\\rangle - |111\\rangle \\right).\n$$\n\n展开：\n\n$$\n\\langle \\psi_i | \\psi_f \\rangle = \\frac{1}{2} \\left[ \\langle 000|000\\rangle - \\langle 000|111\\rangle + \\langle 100|000\\rangle - \\langle 100|111\\rangle \\right].\n$$\n\n利用计算基态的正交归一性（$\\langle abc | def \\rangle = \\delta_{a,d} \\delta_{b,e} \\delta_{c,f}$）：\n\n$$\n\\langle 000|000\\rangle = 1, \\quad \\langle 000|111\\rangle = 0, \\quad \\langle 100|000\\rangle = 0, \\quad \\langle 100|111\\rangle = 0.\n$$\n\n因此，\n\n$$\n\\langle \\psi_i | \\psi_f \\rangle = \\frac{1}{2} \\left[ 1 - 0 + 0 - 0 \\right] = \\frac{1}{2}.\n$$\n\n保真度是模的平方：\n\n$$\nF = \\left| \\frac{1}{2} \\right|^2 = \\left( \\frac{1}{2} \\right)^2 = \\frac{1}{4}.\n$$", "answer": "$$ \\boxed{\\dfrac{1}{4}} $$", "id": "65061"}, {"introduction": "理想的量子线路是重要的理论工具，但真实的量子计算机不可避免地会受到环境噪声的影响。这个练习模拟了一种常见的错误——相位阻尼（phase damping），并探讨了它对量子计算的影响。我们将分析作用在控制量子比特上的相位阻尼噪声，是如何降低一个CNOT门在制备纠缠贝尔态时的性能 [@problem_id:64980]。你将应用算符和表示（operator-sum representation）来描述噪声过程，并通过密度矩阵形式处理含噪系统，这对于表征和缓解量子系统中的错误至关重要。", "problem": "量子计算中的一个基本任务是创建纠缠态，例如贝尔态。然而，量子系统易受噪声影响，这会降低所制备态的质量。本问题探讨一种特定类型的噪声——相位阻尼——对贝尔态制备的影响。\n\n考虑一个双量子比特系统，由一个控制量子比特（下标 'c'）和一个目标量子比特（下标 't'）组成。单个量子比特的计算基为 $\\{|0\\rangle, |1\\rangle\\}$。\n\n系统被制备在初始态 $|\\psi_0\\rangle = |+\\rangle_c |0\\rangle_t$ 中，其中 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$。\n\n控制量子比特受到一个概率为 $p \\in [0, 1]$ 的相位阻尼通道 $\\mathcal{E}$ 的作用。该通道对单量子比特密度矩阵 $\\sigma$ 的作用由算符和表示法描述：\n$$ \\mathcal{E}(\\sigma) = (1-p) \\sigma + p Z \\sigma Z $$\n其中 $Z = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}$ 是泡利-Z算符。目标量子比特不受此噪声过程的影响。\n\n在噪声作用于控制量子比特之后，一个受控非（CNOT）门被应用于该双量子比特系统。CNOT门的第一个量子比特是控制位，第二个是目标位。其对计算基态的作用定义为：\n$$ U_{CNOT} |x, y\\rangle = |x, y \\oplus x\\rangle $$\n其中 $x, y \\in \\{0, 1\\}$ 且 $\\oplus$ 表示模2加法。\n\n目标是制备贝尔态 $|\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$。由密度矩阵 $\\rho$ 描述的态与纯态 $|\\psi\\rangle$ 之间的保真度由 $F = \\langle\\psi|\\rho|\\psi\\rangle$ 给出。\n\n计算双量子比特系统最终态 $\\rho_f$ 与目标贝尔态 $|\\Phi^+\\rangle$ 之间的保真度。将您的答案表示为概率 $p$ 的函数。", "solution": "1. 初始态和密度矩阵\n量子比特的初始态为\n$$|\\psi_0\\rangle = |+\\rangle_c|0\\rangle_t, \\text{ 其中 } |+\\rangle=\\frac{1}{\\sqrt2}(|0\\rangle+|1\\rangle)。$$\n初始密度矩阵为\n$$\n\\rho_0 = |\\psi_0\\rangle\\langle\\psi_0| = \\frac{1}{2}\\bigl(|00\\rangle+|10\\rangle\\bigr)\\bigl(\\langle00|+\\langle10|\\bigr) = \\frac{1}{2} \\left( |00\\rangle\\langle00| + |00\\rangle\\langle10| + |10\\rangle\\langle00| + |10\\rangle\\langle10| \\right)。\n$$\n\n2. 对控制量子比特进行相位阻尼\n该通道的作用为\n$$\\mathcal{E}(\\sigma)=(1-p)\\,\\sigma + p\\,Z\\sigma Z,\\quad \nZ=\\begin{pmatrix}1&0\\\\0&-1\\end{pmatrix}。$$  \n噪声作用于控制量子比特，因此整个系统的演化为 $\\rho_1 = (\\mathcal{E} \\otimes I)(\\rho_0)$。由于$Z|0\\rangle = |0\\rangle$，$Z|1\\rangle = -|1\\rangle$，非对角项（相干项）会衰减：\n$$\n\\rho_1 = \\frac{1}{2} \\left( |00\\rangle\\langle00| + |10\\rangle\\langle10| + (1-2p)(|00\\rangle\\langle10| + |10\\rangle\\langle00|) \\right)。\n$$\n\n3. 应用CNOT门\nCNOT门的作用为 $|x,y\\rangle\\mapsto|x,y\\oplus x\\rangle$。因此\n$$U_{\\rm CNOT}|00\\rangle=|00\\rangle,\\quad\nU_{\\rm CNOT}|10\\rangle=|11\\rangle$$  \n最终态 $\\rho_f = U_{\\rm CNOT}\\,\\rho_1\\,U_{\\rm CNOT}^\\dagger$ 为：\n$$\n\\rho_f = \\frac{1}{2} \\left( |00\\rangle\\langle00| + |11\\rangle\\langle11| + (1-2p)(|00\\rangle\\langle11| + |11\\rangle\\langle00|) \\right)。\n$$\n\n4. 与 $|\\Phi^+\\rangle$ 的保真度\n目标态为 $|\\Phi^+\\rangle=\\frac{1}{\\sqrt2}(|00\\rangle+|11\\rangle)$。保真度为 $F=\\langle\\Phi^+|\\rho_f|\\Phi^+\\rangle$。\n$$\n\\begin{aligned}\nF &= \\langle\\Phi^+| \\rho_f |\\Phi^+\\rangle \\\\\n&= \\frac{1}{2} (\\langle00|+\\langle11|) \\left[ \\frac{1}{2} \\left( |00\\rangle\\langle00| + |11\\rangle\\langle11| + (1-2p)(|00\\rangle\\langle11| + |11\\rangle\\langle00|) \\right) \\right] (|00\\rangle+|11\\rangle) \\\\\n&= \\frac{1}{4} \\left( \\langle00|00\\rangle\\langle00|00\\rangle + \\langle11|11\\rangle\\langle11|11\\rangle + (1-2p)\\langle00|00\\rangle\\langle11|11\\rangle + (1-2p)\\langle11|11\\rangle\\langle00|00\\rangle \\right) \\\\\n&= \\frac{1}{4} \\left( 1 + 1 + (1-2p) + (1-2p) \\right) \\\\\n&= \\frac{1}{4} (4 - 4p) = 1-p。\n\\end{aligned}\n$$", "answer": "$$\\boxed{1-p}$$", "id": "64980"}, {"introduction": "除了作为固定的逻辑门，受控门还可以被参数化，使其成为量子线路中可调节的旋钮。这是许多现代量子算法的基石，例如变分量子本征求解器（VQE）和量子机器学习（QML）。本练习 [@problem_id:64998] 引入了一个参数化的受控旋转门 $C-R_y(\\theta)$，你将学习如何计算一个可观测量（observable）的期望值作为门参数 $\\theta$ 的函数。你将练习的关键技能是计算该期望值的解析梯度，这正是使用经典优化方法来训练变分线路参数的核心要素。", "problem": "考虑一个双量子比特系统，其中第一个量子比特为控制量子比特，第二个为目标量子比特。该系统被初始化在乘积态 $|\\psi_{in}\\rangle = |+\\rangle_1 |0\\rangle_2$ 上，其中 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle+|1\\rangle)$。\n\n一个受控-$R_y(\\theta)$门，记作 $C-R_y(\\theta)$，作用于此初始态。该门的作用是：当控制量子比特处于 $|0\\rangle$ 态时，对目标量子比特施加单位算符 $I$；当控制量子比特处于 $|1\\rangle$ 态时，对目标量子比特施加单量子比特旋转 $R_y(\\theta)$。该算符可以写作：\n$$C-R_y(\\theta) = |0\\rangle\\langle 0| \\otimes I + |1\\rangle\\langle 1| \\otimes R_y(\\theta)$$\n旋转门 $R_y(\\theta)$ 由以下矩阵定义：\n$$R_y(\\theta) = \\exp\\left(-i \\frac{\\theta}{2} Y\\right) = \\begin{pmatrix} \\cos(\\theta/2) & -\\sin(\\theta/2) \\\\ \\sin(\\theta/2) & \\cos(\\theta/2) \\end{pmatrix}$$\n其中 $Y$ 是泡利-Y 矩阵。门作用后系统的状态为 $|\\psi_{out}(\\theta)\\rangle = C-R_y(\\theta) |\\psi_{in}\\rangle$。\n\n最后，对目标量子比特执行泡利-Z 算符的测量。因此，可观测量为 $M = I_1 \\otimes Z_2$。\n\n你的任务是计算可观测量 $M$ 的期望值关于门参数 $\\theta$ 的解析梯度。找到 $\\frac{d}{d\\theta} \\langle M \\rangle$ 的闭式表达式，其中 $\\langle M \\rangle(\\theta) = \\langle\\psi_{out}(\\theta)| M |\\psi_{out}(\\theta)\\rangle$。", "solution": "初始态为 $|\\psi_{in}\\rangle = |+\\rangle_1 |0\\rangle_2 = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle) \\otimes |0\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |10\\rangle)$。\n\n受控-$R_y(\\theta)$门的作用如下：\n\n$$\nC-R_y(\\theta) = |0\\rangle\\langle 0| \\otimes I + |1\\rangle\\langle 1| \\otimes R_y(\\theta)\n$$\n\n施加该门：\n\n$$\nC-R_y(\\theta) |00\\rangle = |0\\rangle \\otimes I|0\\rangle = |00\\rangle\n$$\n\n\n$$\nC-R_y(\\theta) |10\\rangle = |1\\rangle \\otimes R_y(\\theta)|0\\rangle = |1\\rangle \\otimes \\left( \\cos\\left(\\frac{\\theta}{2}\\right) |0\\rangle + \\sin\\left(\\frac{\\theta}{2}\\right) |1\\rangle \\right) = \\cos\\left(\\frac{\\theta}{2}\\right) |10\\rangle + \\sin\\left(\\frac{\\theta}{2}\\right) |11\\rangle\n$$\n\n因此，输出态为：\n\n$$\n|\\psi_{out}(\\theta)\\rangle = C-R_y(\\theta) |\\psi_{in}\\rangle = \\frac{1}{\\sqrt{2}} \\left( |00\\rangle + \\cos\\left(\\frac{\\theta}{2}\\right) |10\\rangle + \\sin\\left(\\frac{\\theta}{2}\\right) |11\\rangle \\right)\n$$\n\n\n可观测量为 $M = I_1 \\otimes Z_2$。期望值 $\\langle M \\rangle = \\langle \\psi_{out}(\\theta) | M | \\psi_{out}(\\theta) \\rangle$。\n\n首先，将 $M$ 作用于 $|\\psi_{out}(\\theta)\\rangle$：\n\n$$\nM |\\psi_{out}(\\theta)\\rangle = (I_1 \\otimes Z_2) \\cdot \\frac{1}{\\sqrt{2}} \\left( |00\\rangle + \\cos\\left(\\frac{\\theta}{2}\\right) |10\\rangle + \\sin\\left(\\frac{\\theta}{2}\\right) |11\\rangle \\right)\n$$\n\n因为 $Z_2 |0\\rangle = |0\\rangle$ 且 $Z_2 |1\\rangle = -|1\\rangle$：\n\n$$\nM |\\psi_{out}(\\theta)\\rangle = \\frac{1}{\\sqrt{2}} \\left( |00\\rangle + \\cos\\left(\\frac{\\theta}{2}\\right) |10\\rangle - \\sin\\left(\\frac{\\theta}{2}\\right) |11\\rangle \\right)\n$$\n\n\n现在计算内积：\n\n$$\n\\langle M \\rangle = \\langle \\psi_{out}(\\theta) | M | \\psi_{out}(\\theta) \\rangle = \\frac{1}{2} \\left[ \\langle 00| + \\cos\\left(\\frac{\\theta}{2}\\right) \\langle 10| + \\sin\\left(\\frac{\\theta}{2}\\right) \\langle 11| \\right] \\left[ |00\\rangle + \\cos\\left(\\frac{\\theta}{2}\\right) |10\\rangle - \\sin\\left(\\frac{\\theta}{2}\\right) |11\\rangle \\right]\n$$\n\n利用基态的正交归一性：\n\n$$\n\\langle M \\rangle = \\frac{1}{2} \\left[ \\langle 00|00\\rangle + \\cos^2\\left(\\frac{\\theta}{2}\\right) \\langle 10|10\\rangle - \\sin^2\\left(\\frac{\\theta}{2}\\right) \\langle 11|11\\rangle \\right] = \\frac{1}{2} \\left[ 1 + \\cos^2\\left(\\frac{\\theta}{2}\\right) - \\sin^2\\left(\\frac{\\theta}{2}\\right) \\right]\n$$\n\n使用二倍角恒等式 $\\cos^2(\\alpha) - \\sin^2(\\alpha) = \\cos(2\\alpha)$，并令 $\\alpha = \\theta/2$：\n\n$$\n\\langle M \\rangle = \\frac{1}{2} \\left[ 1 + \\cos(\\theta) \\right]\n$$\n\n\n关于 $\\theta$ 的导数为：\n\n$$\n\\frac{d}{d\\theta} \\langle M \\rangle = \\frac{d}{d\\theta} \\left[ \\frac{1}{2} (1 + \\cos(\\theta)) \\right] = \\frac{1}{2} \\cdot (-\\sin(\\theta)) = -\\frac{1}{2} \\sin(\\theta)\n$$", "answer": "$$ \\boxed{-\\dfrac{1}{2}\\sin(\\theta)} $$", "id": "64998"}]}