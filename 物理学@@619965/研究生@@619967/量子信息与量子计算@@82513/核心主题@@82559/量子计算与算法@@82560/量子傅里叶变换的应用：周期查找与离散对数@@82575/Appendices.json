{"hands_on_practices": [{"introduction": "量子傅里叶变换在周期发现中的威力在于它能将概率幅集中在特定频率上。练习 [@problem_id:48198] 邀请您通过计算在一个非理想但贴近现实的场景（即寄存器大小 $Q$ 不是周期 $r$ 的整数倍）下的精确测量概率，来深入探究这一过程的数学核心。掌握这一计算能够巩固您对量子傅里叶变换输出为何呈现“峰值”以及峰值结构如何形成的理解。", "problem": "用于分解整数 $N$ 的肖尔算法的量子部分依赖于一个称为量子阶次寻找的子程序。给定 $N$ 和一个与 $N$ 互质的整数 $a < N$，该子程序找到满足 $a^r \\equiv 1 \\pmod{N}$ 的最小正整数 $r$。\n\n该过程使用两个量子寄存器。第一个是初始化为 $|0\\rangle^{\\otimes L}$ 的一个 $L$-量子比特寄存器，第二个是一个足够大以存储高达 $N-1$ 的值的寄存器，也初始化为 $|0\\rangle$。设 $Q = 2^L$。该算法按以下步骤进行：\n\n1.  对第一个寄存器的每个量子比特应用阿达马变换，产生如下状态：\n    $$ |\\psi_1\\rangle = \\frac{1}{\\sqrt{Q}} \\sum_{x=0}^{Q-1} |x\\rangle |0\\rangle $$\n2.  将模幂运算符 $U_f$（其中 $f(x) = a^x \\pmod{N}$）应用于组合状态：\n    $$ |\\psi_2\\rangle = \\frac{1}{\\sqrt{Q}} \\sum_{x=0}^{Q-1} |x\\rangle |a^x \\pmod{N}\\rangle $$\n3.  对第一个寄存器应用量子傅里叶变换 (QFT)。\n4.  测量第一个寄存器。测量结果是一个整数 $k \\in \\{0, 1, ..., Q-1\\}$。\n\n测量值 $k$ 很可能接近 $Q/r$ 的某个整数倍。然后可以使用连分数算法从 $k/Q$ 中推导出周期 $r$。\n\n考虑使用基数 $a=4$ 分解 $N=21$ 的情况。设第一个寄存器由 $L=10$ 个量子比特组成，因此 $Q=1024$。假设在步骤4之后，第一个寄存器的测量结果为 $k=171$。当使用连分数算法处理此结果时，它给出了一个与真实周期不同的周期候选值。计算测量到这个特定结果的精确概率 $P(k=171)$。", "solution": "我们希望计算\n$$P(k)=\\frac{1}{Q^2}\\sum_{y=0}^{r-1}\\Bigl|\\sum_{m=0}^{M_y-1}e^{2\\pi i\\,k(y+m r)/Q}\\Bigr|^2$$\n对于 $N=21$，$a=4$，因此 $r=\\min\\{r:a^r\\equiv1\\pmod{21}\\}=3$, $L=10$, $Q=2^{10}=1024$，以及观测到的 $k=171$。\n\n1.  确定 $M_y=\\#\\{m\\ge0:y+mr\\le Q-1\\}=\\left\\lfloor\\frac{Q-1-y}{r}\\right\\rfloor+1$。由于 $Q=3\\cdot341+1$，可以得出\n$$M_0=342,\\quad M_1=M_2=341.$$\n\n2.  定义\n$$\\theta=\\frac{2\\pi k r}{Q}=\\frac{2\\pi\\cdot171\\cdot3}{1024}\n=\\pi\\Bigl(1+\\tfrac1{512}\\Bigr),$$ \n并令 $S_y=\\sum_{m=0}^{M_y-1}e^{i\\theta m}e^{2\\pi i k y/Q}$。等比级数公式给出\n$$\\Bigl|S_y\\Bigr|\n=\\Bigl|\\frac{1-e^{iM_y\\theta}}{1-e^{i\\theta}}\\Bigr|\n=\\frac{\\bigl|\\sin(\\tfrac{M_y\\theta}{2})\\bigr|}{\\bigl|\\sin(\\tfrac{\\theta}{2})\\bigr|}.$$\n\n3.  注意到\n$$\\frac{\\theta}{2}=\\frac\\pi2+\\frac{\\pi}{1024},\\qquad\n\\sin\\!\\bigl(\\tfrac\\theta2\\bigr)=\\cos\\!\\bigl(\\tfrac\\pi{1024}\\bigr),$$\n以及\n$$\\sin\\!\\bigl(341\\tfrac\\theta2\\bigr)\n=\\sin\\!\\Bigl(\\pi\\frac{174933}{1024}\\Bigr)\n=\\sin\\!\\Bigl(\\frac{853\\pi}{1024}\\Bigr)\n=\\sin\\!\\Bigl(\\frac{171\\pi}{1024}\\Bigr),$$\n我们得到\n$$|S_0|^2\n=\\frac{\\sin^2\\!\\bigl(171\\pi/512\\bigr)}{\\cos^2\\!(\\pi/1024)},\\quad\n|S_1|^2=|S_2|^2\n=\\frac{\\sin^2\\!\\bigl(171\\pi/1024\\bigr)}{\\cos^2\\!(\\pi/1024)}.$$\n\n4.  因此\n$$P(171)=\\frac{1}{1024^2}\\Bigl(|S_0|^2+2|S_1|^2\\Bigr)\n=\\frac{1}{1024^2\\cos^2(\\pi/1024)}\\Bigl[\\sin^2\\!\\bigl(\\tfrac{171\\pi}{512}\\bigr)\n+2\\sin^2\\!\\bigl(\\tfrac{171\\pi}{1024}\\bigr)\\Bigr].$$\n\n5.  最后使用 $\\sin(171\\pi/512)=2\\sin(171\\pi/1024)\\cos(171\\pi/1024)$ 来合并项：\n$$P(171)\n=\\frac{2\\,\\sin^2\\!\\bigl(\\tfrac{171\\pi}{1024}\\bigr)\\bigl(2\\cos^2\\!\\tfrac{171\\pi}{1024}+1\\bigr)}\n{1024^2\\,\\cos^2\\!\\bigl(\\tfrac{\\pi}{1024}\\bigr)}.$$", "answer": "$$\\boxed{\\frac{2\\,\\sin^2\\!\\bigl(\\tfrac{171\\pi}{1024}\\bigr)\\bigl(2\\cos^2\\!\\tfrac{171\\pi}{1024}+1\\bigr)}{1024^2\\,\\cos^2\\!\\bigl(\\tfrac{\\pi}{1024}\\bigr)}}$$", "id": "48198"}, {"introduction": "量子计算的价值最终取决于解读其结果的经典后处理步骤。练习 [@problem_id:48302] 聚焦于这一关键的经典步骤，挑战您追踪一个常见的硬件错误——测量比特翻转——在连分数算法中的影响。这个动手实践突出了算法的鲁棒性（或其脆弱性），并加强了从原始量子测量数据（例如形式为 $k/2^n$ 的近似值）中恢复周期 $r$ 的具体操作。", "problem": "量子周期查找算法是Shor整数分解算法的一个关键组成部分。其目标是找到一个函数 $f(x)$ 的周期 $r$，满足 $f(x+r)=f(x)$。该算法使用一个 $n$ 量子比特寄存器，在应用量子傅里叶变换（QFT）并进行测量后，会得到一个整数结果 $k$。在理想条件下，分数 $k/2^n$ 是一个未知有理数 $c/r$ 的极佳近似值，其中 $c$ 是一个与 $r$ 互质的随机整数。\n\n该算法的经典后处理部分涉及对 $k/2^n$ 使用连分数算法，以找到近似它的候选分数 $p/q$。这些渐近分数的分母 $q$ 是周期 $r$ 的候选值。这一系列渐近分数，记为 $C_m = p_m/q_m$（$m=0, 1, 2, \\dots$），提供了越来越好的近似值。\n\n考虑一个使用 $n=11$ 量子比特寄存器的周期查找算法实例。其基础函数的周期为 $r=7$。算法的量子部分成功运行一次，会正确地得到测量结果 $k=585$。然而，在测量过程中，测量结果 $k$ 的最高有效位（MSB）发生了一个比特翻转错误。这导致产生了一个错误的值 $k'$。\n\n使用这个不正确的值 $k'$，执行经典后处理步骤。计算比值 $k'/2^n$ 的连分数展开式的第三个渐近分数 $C_2 = p_2/q_2$ 的分母。", "solution": "1. 翻转11比特测量值585的最高有效位（MSB）。在11比特表示中，585的MSB为0，所以翻转它相当于加上 $2^{10}$：\n$$k' = 585 + 2^{10} = 585 + 1024 = 1609.$$\n\n2. 构造比值\n$$\\frac{k'}{2^n} = \\frac{1609}{2^{11}} = \\frac{1609}{2048}。$$\n\n3. 计算 $1609/2048$ 的连分数展开式：\n$$\\frac{1609}{2048} = [0;1,3,1,1,1,72,2].$$\n\n4. 使用标准递推关系\n$$p_{-2}=0,\\quad p_{-1}=1,\\quad p_k = a_k p_{k-1} + p_{k-2},$$\n$$q_{-2}=1,\\quad q_{-1}=0,\\quad q_k = a_k q_{k-1} + q_{k-2}.$$\n则\n- $C_0 = p_0/q_0 = 0/1$,\n- $C_1 = p_1/q_1 = 1/1$,\n- $C_2 = p_2/q_2$ ，其中\n  $$p_2 = 3\\cdot p_1 + p_0 = 3\\cdot1 + 0 = 3,$$\n  $$q_2 = 3\\cdot q_1 + q_0 = 3\\cdot1 + 1 = 4.$$\n因此，第三个渐近分数 $C_2 = 3/4$ 的分母为 $q_2 = 4$。", "answer": "$$\\boxed{4}$$", "id": "48302"}, {"introduction": "真实的量子计算机是有噪声的，理解错误的影响至关重要。这个高级练习 [@problem_id:48316] 超越了简单的噪声模型，探讨了特定门操作中一个系统性相干错误所造成的影响，揭示了这类错误不仅仅是降低信号质量，而是会将主傅里叶峰分裂成多个定义明确的子峰。通过推导这些新峰值的位置，您将对硬件故障与算法输出频谱之间的复杂关系获得深刻的洞察。", "problem": "在一个理想化的量子周期寻找算法中，为量子傅里叶变换 (QFT) 准备的初始状态为 $|\\psi\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{x=0}^{N-1} e^{2\\pi i x / r} |x\\rangle$，其中 $N=2^n$ 是寄存器的维度，$r$ 是待确定的周期。\n\n随后的逆 QFT $\\mathcal{Q}_N^{-1}$ 和测量，理想情况下将在输出结果 $y$ 处产生一个尖锐的概率峰，该结果是 $N/r$ 的整数倍。\n\n考虑在状态制备过程中出现系统性硬件误差的情景。施加的相位是 $e^{2\\pi i (x + \\delta(x))/r}$，而非 $e^{2\\pi i x/r}$，其中相位误差项为 $\\delta(x) = \\epsilon \\, x_{j_0} 2^{j_0}$。这里，$x_{j_0} \\in \\{0, 1\\}$ 是整数 $x$ 在其二进制表示 ($x = \\sum_{j=0}^{n-1} x_j 2^j$) 中的第 $j_0$ 位，$j_0$ 是一个指定故障门控制量子比特的固定整数 ($0 \\le j_0 < n$)，而 $\\epsilon$ 是一个小的实值误差参数。\n\n因此，进入逆 QFT 的状态是 $|\\psi_{err}\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{x=0}^{N-1} e^{2\\pi i (x+\\epsilon x_{j_0} 2^{j_0})/r} |x\\rangle$。这个误差导致输出概率分布 $P(y) = |\\langle y | \\mathcal{Q}_N^{-1} |\\psi_{err}\\rangle|^2$ 中的单个尖锐峰分裂成多个更小的峰。\n\n假设无量纲误差量 $\\alpha = \\frac{\\epsilon 2^{j_0}}{r}$ 固定为 $\\frac{1}{3}$。再进一步假设 $N$ 足够大，以至于产生的光谱峰能够被很好地区分，并且它们的位置可以由导出的振幅函数的最大值来近似。\n\n推导最终概率分布 $P(y)$ 中两个最高强度峰之间的分离量 $\\Delta y$。请用 $N$ 和 $j_0$ 来表示你的答案。", "solution": "施加逆量子傅里叶变换 $\\mathcal{Q}_N^{-1}$ 后，系统的状态由 $|\\psi_{out}\\rangle = \\mathcal{Q}_N^{-1} |\\psi_{err}\\rangle$ 给出。测量到结果 $|y\\rangle$ 的振幅是 $A_y = \\langle y | \\psi_{out} \\rangle$。\n\n1.  **计算振幅 $A_y$**\n\n逆 QFT 作用于基态 $|x\\rangle$ 的结果是 $\\mathcal{Q}_N^{-1}|x\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{y=0}^{N-1} e^{-2\\pi i xy/N} |y\\rangle$。\n因此，输出状态是：\n$$\n|\\psi_{out}\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{x=0}^{N-1} e^{2\\pi i (x+\\epsilon x_{j_0} 2^{j_0})/r} \\left( \\frac{1}{\\sqrt{N}} \\sum_{y=0}^{N-1} e^{-2\\pi i xy/N} |y\\rangle \\right)\n$$\n$$\n|\\psi_{out}\\rangle = \\frac{1}{N} \\sum_{y=0}^{N-1} \\left( \\sum_{x=0}^{N-1} e^{2\\pi i (x+\\epsilon x_{j_0} 2^{j_0})/r} e^{-2\\pi i xy/N} \\right) |y\\rangle\n$$\n测量 $|y\\rangle$ 的振幅是括号中的项：\n$$\nA_y = \\frac{1}{N} \\sum_{x=0}^{N-1} e^{2\\pi i x(1/r - y/N)} e^{2\\pi i (\\epsilon 2^{j_0}/r) x_{j_0}}\n$$\n我们定义 $\\theta = \\frac{1}{r} - \\frac{y}{N}$ 和 $\\phi = \\frac{\\epsilon 2^{j_0}}{r}$。表达式变为：\n$$\nA_y = \\frac{1}{N} \\sum_{x=0}^{N-1} e^{2\\pi i x\\theta} e^{2\\pi i \\phi x_{j_0}}\n$$\n\n2.  **根据 $x_{j_0}$ 分解求和**\n\n我们将对 $x$ 的求和分成两部分：一部分是比特 $x_{j_0}=0$ 的情况，另一部分是 $x_{j_0}=1$ 的情况。令 $S_0 = \\{x \\in \\{0,..,N-1\\} | x_{j_0}=0\\}$ 且 $S_1 = \\{x \\in \\{0,..,N-1\\} | x_{j_0}=1\\}$。\n$$\nA_y = \\frac{1}{N} \\left( \\sum_{x \\in S_0} e^{2\\pi i x\\theta} + \\sum_{x \\in S_1} e^{2\\pi i x\\theta} e^{2\\pi i \\phi} \\right)\n$$\n令 $F_0(\\theta) = \\sum_{x \\in S_0} e^{2\\pi i x\\theta}$ 和 $F_1(\\theta) = \\sum_{x \\in S_1} e^{2\\pi i x\\theta}$。所以，$N A_y = F_0(\\theta) + e^{2\\pi i \\phi} F_1(\\theta)$。\n\n3.  **关联 $F_0(\\theta)$ 和 $F_1(\\theta)$**\n\n一个整数 $x$ 可以根据比特 $j_0$ 进行分解。任意 $x \\in \\{0, \\dots, N-1\\}$ 都可以写成 $x = a \\cdot 2^{j_0+1} + b$，其中 $a \\in \\{0, \\dots, N/2^{j_0+1}-1\\}$ 且 $b \\in \\{0, \\dots, 2^{j_0+1}-1\\}$。比特 $x_{j_0}$ 由 $b$ 决定。具体来说，如果 $b \\in \\{0, \\dots, 2^{j_0}-1\\}$，则 $x_{j_0}=0$；如果 $b \\in \\{2^{j_0}, \\dots, 2^{j_0+1}-1\\}$，则 $x_{j_0}=1$。\n$$\nF_0(\\theta) = \\sum_{a=0}^{N/2^{j_0+1}-1} \\sum_{b=0}^{2^{j_0}-1} e^{2\\pi i (a 2^{j_0+1} + b)\\theta} = \\left(\\sum_{a=0}^{N/2^{j_0+1}-1} e^{2\\pi i a 2^{j_0+1}\\theta}\\right) \\left(\\sum_{b=0}^{2^{j_0}-1} e^{2\\pi i b\\theta}\\right)\n$$\n$$\nF_1(\\theta) = \\sum_{a=0}^{N/2^{j_0+1}-1} \\sum_{b=2^{j_0}}^{2^{j_0+1}-1} e^{2\\pi i (a 2^{j_0+1} + b)\\theta} = \\left(\\sum_{a=0}^{N/2^{j_0+1}-1} e^{2\\pi i a 2^{j_0+1}\\theta}\\right) \\left(\\sum_{b=2^{j_0}}^{2^{j_0+1}-1} e^{2\\pi i b\\theta}\\right)\n$$\n$F_1$ 中对 $b$ 的求和可以与 $F_0$ 中的相关联。令 $b' = b - 2^{j_0}$：\n$$\n\\sum_{b=2^{j_0}}^{2^{j_0+1}-1} e^{2\\pi i b\\theta} = \\sum_{b'=0}^{2^{j_0}-1} e^{2\\pi i (b' + 2^{j_0})\\theta} = e^{2\\pi i 2^{j_0}\\theta} \\left(\\sum_{b'=0}^{2^{j_0}-1} e^{2\\pi i b'\\theta}\\right)\n$$\n这意味着 $F_1(\\theta) = F_0(\\theta) e^{2\\pi i 2^{j_0}\\theta}$。\n\n4.  **分析最终振幅**\n\n将这个关系代入 $A_y$ 的表达式中：\n$$\nN A_y = F_0(\\theta) + e^{2\\pi i \\phi} \\left( F_0(\\theta) e^{2\\pi i 2^{j_0}\\theta} \\right) = F_0(\\theta) \\left( 1 + e^{2\\pi i (\\phi + 2^{j_0}\\theta)} \\right)\n$$\n测量到 $y$ 的概率是 $P(y) = |A_y|^2 = \\frac{1}{N^2} |F_0(\\theta)|^2 |1 + e^{2\\pi i (\\phi + 2^{j_0}\\theta)}|^2$。$P(y)$ 的峰值由 $|F_0(\\theta)|^2$ 的峰值决定。$F_0(\\theta)$ 乘积中的第一项 $\\sum_{a} e^{2\\pi i a 2^{j_0+1}\\theta}$ 是一个几何级数和，只有当 $2^{j_0+1}\\theta$ 是整数时，其值才很大。令 $2^{j_0+1}\\theta = k$，其中 $k$ 为某个整数。\n这意味着在 $\\theta \\approx 0$ 处的原始峰分裂成一系列位于以下位置的子峰：\n$$\n\\theta_k = \\frac{k}{2^{j_0+1}}\n$$\n回顾 $\\theta = 1/r - y/N$，输出谱中峰的位置是：\n$$\ny_k = \\frac{N}{r} - N\\theta_k = \\frac{N}{r} - \\frac{Nk}{2^{j_0+1}}\n$$\n\n5.  **确定峰值强度**\n\n这些峰的强度受到 $P(y)$ 中第二个因子的调制。在峰值位置 $\\theta_k$ 处，强度正比于：\n$$\nI_k \\propto \\left|1 + e^{2\\pi i (\\phi + 2^{j_0}\\theta_k)}\\right|^2 = \\left|1 + e^{2\\pi i (\\phi + 2^{j_0} k/2^{j_0+1})}\\right|^2 = \\left|1 + e^{2\\pi i \\phi} e^{i\\pi k}\\right|^2 = \\left|1 + (-1)^k e^{2\\pi i \\phi}\\right|^2\n$$\n我们对整数 $k$ 考察两种情况：\n-   **$k$ 为偶数：** $k=2m$。强度为 $I_{even} \\propto |1 + e^{2\\pi i \\phi}|^2 = (1+\\cos(2\\pi\\phi))^2 + \\sin^2(2\\pi\\phi) = 2+2\\cos(2\\pi\\phi) = 4\\cos^2(\\pi\\phi)$。这些峰包括当 $k=0$ 时位于 $y_0 = N/r$ 的中心峰。\n-   **$k$ 为奇数：** $k=2m+1$。强度为 $I_{odd} \\propto |1 - e^{2\\pi i \\phi}|^2 = (1-\\cos(2\\pi\\phi))^2 + \\sin^2(2\\pi\\phi) = 2-2\\cos(2\\pi\\phi) = 4\\sin^2(\\pi\\phi)$。其中最显著的两个对应于 $k=1$ 和 $k=-1$，位于 $y_{\\pm 1} = N/r \\mp N/2^{j_0+1}$。\n\n6.  **寻找最高强度峰**\n\n问题陈述中无量纲误差参数为 $\\alpha = \\phi = \\frac{\\epsilon 2^{j_0}}{r} = \\frac{1}{3}$。我们比较强度：\n-   $I_{even} \\propto 4\\cos^2(\\pi/3) = 4 \\left(\\frac{1}{2}\\right)^2 = 1$。\n-   $I_{odd} \\propto 4\\sin^2(\\pi/3) = 4 \\left(\\frac{\\sqrt{3}}{2}\\right)^2 = 3$。\n\n由于 $I_{odd} > I_{even}$，最高强度的峰是对应于 $k$ 为奇数值的那些峰。最强的峰将是那些最接近 $|F_0(\\theta)|^2$ 整体包络中心的峰，该包络中心位于 $\\theta=0$。这些对应于 $k$ 的最小非零奇数值，即 $k=1$ 和 $k=-1$。\n\n这两个最高强度峰的位置是：\n-   $y_1 = \\frac{N}{r} - \\frac{N(1)}{2^{j_0+1}}$\n-   $y_{-1} = \\frac{N}{r} - \\frac{N(-1)}{2^{j_0+1}} = \\frac{N}{r} + \\frac{N}{2^{j_0+1}}$\n\n7.  **计算分离量**\n\n这两个峰之间的分离量 $\\Delta y$ 是：\n$$\n\\Delta y = y_{-1} - y_1 = \\left(\\frac{N}{r} + \\frac{N}{2^{j_0+1}}\\right) - \\left(\\frac{N}{r} - \\frac{N}{2^{j_0+1}}\\right) = \\frac{2N}{2^{j_0+1}} = \\frac{N}{2^{j_0}}\n$$\n这就是最终结果。", "answer": "$$\n\\boxed{\\frac{N}{2^{j_0}}}\n$$", "id": "48316"}]}