{"hands_on_practices": [{"introduction": "掌握量子计算的基础在于能够精确追踪量子态在门操作下的演化。本练习将引导你实践如何将SWAP门和Toffoli门依次作用于一个给定的初态，并计算最终特定测量结果的概率，从而巩固分析量子线路的核心技能。[@problem_id:103296]", "problem": "考虑一个三量子比特的量子系统，其状态空间由计算基矢 $|q_1 q_2 q_3\\rangle$ 张成，其中 $q_i \\in \\{0, 1\\}$。标准的单量子比特态定义为 $|0\\rangle = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$， $|1\\rangle = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$，以及哈达玛态 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$。\n\n我们使用两种类型的三量子比特门：\n1.  SWAP$_{ij}$门，它交换量子比特 $i$ 和量子比特 $j$ 的状态。其对基矢的作用由 $U_{\\text{SWAP}_{ij}} |q_1 \\dots q_i \\dots q_j \\dots q_n \\rangle = |q_1 \\dots q_j \\dots q_i \\dots q_n \\rangle$ 给出。\n2.  Toffoli门（或CCNOT门），记作 Toffoli$_{ijk}$。该门有两个控制量子比特 $i$ 和 $j$，以及一个目标量子比特 $k$。当且仅当两个控制量子比特都处于态 $|1\\rangle$ 时，它会对目标量子比特 $k$ 应用一个泡利X门。其对基矢的作用为 $U_{\\text{Toffoli}_{ijk}} |q_i q_j q_k\\rangle = |q_i q_j (q_k \\oplus (q_i \\cdot q_j))\\rangle$，其中 $\\oplus$ 表示模2加法，其他量子比特的状态不受影响。\n\n系统被初始化到状态：\n$$\n|\\psi_{in}\\rangle = |+\\rangle \\otimes |1\\rangle \\otimes |0\\rangle\n$$\n\n一个由两个量子门组成的序列作用于此初始态。首先，一个 SWAP$_{23}$ 门作用于系统，然后是一个 Toffoli$_{123}$ 门。最终状态在计算基下进行测量。\n\n计算测量结果为 $|101\\rangle$ 的概率。", "solution": "初始态由以下公式给出：\n\n$$\n|\\psi_{\\text{in}}\\rangle = |+\\rangle \\otimes |1\\rangle \\otimes |0\\rangle\n$$\n\n其中 $|+\\rangle = \\frac{1}{\\sqrt{2}} (|0\\rangle + |1\\rangle)$。因此：\n\n$$\n|\\psi_{\\text{in}}\\rangle = \\frac{1}{\\sqrt{2}} (|0\\rangle + |1\\rangle) \\otimes |1\\rangle \\otimes |0\\rangle = \\frac{1}{\\sqrt{2}} (|0\\rangle \\otimes |1\\rangle \\otimes |0\\rangle + |1\\rangle \\otimes |1\\rangle \\otimes |0\\rangle)\n$$\n\n在计算基中，这表示为：\n\n$$\n|\\psi_{\\text{in}}\\rangle = \\frac{1}{\\sqrt{2}} (|010\\rangle + |110\\rangle)\n$$\n\n\n应用 SWAP$_{23}$ 门，它交换量子比特2和量子比特3。其对基矢 $|q_1 q_2 q_3\\rangle$ 的作用是：\n\n$$\nU_{\\text{SWAP}_{23}} |q_1 q_2 q_3\\rangle = |q_1 q_3 q_2\\rangle\n$$\n\n将其应用于每一项：\n\n$$\nU_{\\text{SWAP}_{23}} |010\\rangle = |001\\rangle, \\quad U_{\\text{SWAP}_{23}} |110\\rangle = |101\\rangle\n$$\n\n因此，经过 SWAP$_{23}$ 门作用后的状态为：\n\n$$\n|\\psi_{\\text{after swap}}\\rangle = \\frac{1}{\\sqrt{2}} (|001\\rangle + |101\\rangle)\n$$\n\n\n接下来，应用 Toffoli$_{123}$ 门，其控制量子比特为1和2，目标量子比特为3。其对基矢 $|q_1 q_2 q_3\\rangle$ 的作用是：\n\n$$\nU_{\\text{Toffoli}_{123}} |q_1 q_2 q_3\\rangle = |q_1 q_2 (q_3 \\oplus (q_1 \\cdot q_2))\\rangle\n$$\n\n将其应用于每一项：\n- 对于 $|001\\rangle$：$q_1 = 0$，$q_2 = 0$，$q_3 = 1$。因为 $q_1 \\cdot q_2 = 0$，所以 $q_3 \\oplus 0 = 1$，因此：\n  \n$$\n  U_{\\text{Toffoli}_{123}} |001\\rangle = |001\\rangle\n  $$\n\n- 对于 $|101\\rangle$：$q_1 = 1$，$q_2 = 0$，$q_3 = 1$。因为 $q_1 \\cdot q_2 = 0$，所以 $q_3 \\oplus 0 = 1$，因此：\n  \n$$\n  U_{\\text{Toffoli}_{123}} |101\\rangle = |101\\rangle\n  $$\n\n因此，最终的状态是：\n\n$$\n|\\psi_{\\text{final}}\\rangle = \\frac{1}{\\sqrt{2}} (|001\\rangle + |101\\rangle)\n$$\n\n\n测量得到 $|101\\rangle$ 的概率是其在最终状态中系数的绝对值的平方。该系数为 $\\frac{1}{\\sqrt{2}}$，所以：\n\n$$\n|\\langle 101 | \\psi_{\\text{final}}\\rangle|^2 = \\left| \\frac{1}{\\sqrt{2}} \\right|^2 = \\left( \\frac{1}{\\sqrt{2}} \\right)^2 = \\frac{1}{2}\n$$\n\n态 $|001\\rangle$ 和 $|101\\rangle$ 是正交的，并且态的范数是守恒的：\n\n$$\n\\left| \\frac{1}{\\sqrt{2}} \\right|^2 + \\left| \\frac{1}{\\sqrt{2}} \\right|^2 = \\frac{1}{2} + \\frac{1}{2} = 1\n$$\n\n因此，概率为 $\\frac{1}{2}$。", "answer": "$$ \\boxed{\\dfrac{1}{2}} $$", "id": "103296"}, {"introduction": "多量子比特门对纠缠态的作用是量子计算的核心。本练习探讨一个由CNOT门构成的循环序列如何作用于一个最大纠缠的GHZ态，通过计算保真度来量化这些操作对纠缠特性的改变。[@problem_id:103319]", "problem": "一个三量子比特系统被制备于 Greenberger-Horne-Zeilinger (GHZ) 态，这是一个最大纠缠态，定义如下：\n$$\n|\\psi_{GHZ}\\rangle = \\frac{1}{\\sqrt{2}}(|000\\rangle + |111\\rangle)\n$$\n此处，该状态在计算基矢 $|q_1 q_2 q_3\\rangle$ 中表示，其中 $q_i \\in \\{0, 1\\}$ 是第 $i$ 个量子比特的状态。\n\n一个量子电路对该初始态施加一列包含三个受控非门 (CNOT) 的序列。总的幺正操作由 $U = U_3 U_2 U_1$ 给出，其中这些门从右到左依次施加：\n1.  $U_1 = \\text{CNOT}_{12}$ (量子比特 1 为控制位，量子比特 2 为目标位)\n2.  $U_2 = \\text{CNOT}_{23}$ (量子比特 2 为控制位，量子比特 3 为目标位)\n3.  $U_3 = \\text{CNOT}_{31}$ (量子比特 3 为控制位，量子比特 1 为目标位)\n\n$\\text{CNOT}_{ij}$ 门作用于计算基矢态 $|c\\rangle_i|t\\rangle_j$ 的效果是：如果控制量子比特 $c$ 处于 $|1\\rangle$ 态，则翻转目标量子比特 $t$。这可以写作 $|c\\rangle_i|t\\rangle_j \\mapsto |c\\rangle_i|t \\oplus c\\rangle_j$，其中 $\\oplus$ 表示模2加法。该门对所有其他未涉及的量子比特的作用是恒等变换。\n\n设系统在施加了完整的门序列之后的末态为 $|\\psi_{final}\\rangle = U |\\psi_{GHZ}\\rangle$。计算初始 GHZ 态与末态之间的保真度 $F$。保真度定义为两个态的内积的模平方：$F = |\\langle\\psi_{GHZ}|\\psi_{final}\\rangle|^2$。", "solution": "问题要求计算初始的三量子比特 GHZ 态 $|\\psi_{GHZ}\\rangle$ 与施加一个特定量子电路后得到的末态 $|\\psi_{final}\\rangle$ 之间的保真度。\n\n初始态由下式给出：\n$$\n|\\psi_{GHZ}\\rangle = \\frac{1}{\\sqrt{2}}(|000\\rangle + |111\\rangle)\n$$\n\n电路的幺正算符为 $U = \\text{CNOT}_{31}\\text{CNOT}_{23}\\text{CNOT}_{12}$。我们需要计算末态 $|\\psi_{final}\\rangle = U |\\psi_{GHZ}\\rangle$。根据量子力学的线性性质，我们可以将该算符分别作用于叠加态中的每一项：\n$$\n|\\psi_{final}\\rangle = U \\frac{1}{\\sqrt{2}}(|000\\rangle + |111\\rangle) = \\frac{1}{\\sqrt{2}} (U|000\\rangle + U|111\\rangle)\n$$\n\n我们首先计算 $U$ 对基矢态 $|000\\rangle$ 的作用：\n1.  施加 $\\text{CNOT}_{12}$：控制量子比特（量子比特 1）处于 $|0\\rangle$ 态，因此目标量子比特（量子比特 2）不翻转。\n    $$\n    \\text{CNOT}_{12}|000\\rangle = |000\\rangle\n    $$\n2.  施加 $\\text{CNOT}_{23}$：控制量子比特（量子比特 2）处于 $|0\\rangle$ 态，因此目标量子比特（量子比特 3）不翻转。\n    $$\n    \\text{CNOT}_{23}|000\\rangle = |000\\rangle\n    $$\n3.  施加 $\\text{CNOT}_{31}$：控制量子比特（量子比特 3）处于 $|0\\rangle$ 态，因此目标量子比特（量子比特 1）不翻转。\n    $$\n    \\text{CNOT}_{31}|000\\rangle = |000\\rangle\n    $$\n综合这些步骤，我们发现态 $|000\\rangle$ 是变换 $U$ 的一个不动点：\n$$\nU|000\\rangle = \\text{CNOT}_{31}\\text{CNOT}_{23}\\text{CNOT}_{12}|000\\rangle = |000\\rangle\n$$\n\n接下来，我们计算 $U$ 对基矢态 $|111\\rangle$ 的作用：\n1.  施加 $\\text{CNOT}_{12}$：控制量子比特（量子比特 1）是 $|1\\rangle$，所以我们翻转目标量子比特（量子比特 2）。\n    $$\n    \\text{CNOT}_{12}|111\\rangle = |1, 1\\oplus1, 1\\rangle = |101\\rangle\n    $$\n2.  对结果 $|101\\rangle$ 施加 $\\text{CNOT}_{23}$：控制量子比特（量子比特 2）是 $|0\\rangle$，所以目标量子比特（量子比特 3）不翻转。\n    $$\n    \\text{CNOT}_{23}|101\\rangle = |1,0,1\\oplus0\\rangle = |101\\rangle\n    $$\n3.  对结果 $|101\\rangle$ 施加 $\\text{CNOT}_{31}$：控制量子比特（量子比特 3）是 $|1\\rangle$，所以我们翻转目标量子比特（量子比特 1）。\n    $$\n    \\text{CNOT}_{31}|101\\rangle = |1\\oplus1, 0, 1\\rangle = |001\\rangle\n    $$\n所以，$U$ 对 $|111\\rangle$ 的作用是：\n$$\nU|111\\rangle = \\text{CNOT}_{31}\\text{CNOT}_{23}\\text{CNOT}_{12}|111\\rangle = |001\\rangle\n$$\n\n现在我们可以写出末态 $|\\psi_{final}\\rangle$：\n$$\n|\\psi_{final}\\rangle = \\frac{1}{\\sqrt{2}}(|000\\rangle + |001\\rangle)\n$$\n这个末态是 $|000\\rangle$ 和 $|001\\rangle$ 的叠加态。它也可以写成一个乘积态：$|\\psi_{final}\\rangle = |00\\rangle \\otimes \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle) = |00\\rangle|+\\rangle_3$。\n\n最后一步是计算保真度 $F = |\\langle\\psi_{GHZ}|\\psi_{final}\\rangle|^2$。我们首先计算内积 $\\langle\\psi_{GHZ}|\\psi_{final}\\rangle$：\n$$\n\\langle\\psi_{GHZ}|\\psi_{final}\\rangle = \\left( \\frac{1}{\\sqrt{2}}(\\langle 000| + \\langle 111|) \\right) \\left( \\frac{1}{\\sqrt{2}}(|000\\rangle + |001\\rangle) \\right)\n$$\n$$\n\\langle\\psi_{GHZ}|\\psi_{final}\\rangle = \\frac{1}{2} (\\langle 000|000\\rangle + \\langle 000|001\\rangle + \\langle 111|000\\rangle + \\langle 111|001\\rangle)\n$$\n利用计算基矢态的正交性 $\\langle ijk|lmn\\rangle = \\delta_{il}\\delta_{jm}\\delta_{kn}$，我们得到：\n$$\n\\langle 000|000\\rangle = 1\n$$\n$$\n\\langle 000|001\\rangle = 0\n$$\n$$\n\\langle 111|000\\rangle = 0\n$$\n$$\n\\langle 111|001\\rangle = 0\n$$\n将这些值代回内积表达式中：\n$$\n\\langle\\psi_{GHZ}|\\psi_{final}\\rangle = \\frac{1}{2} (1 + 0 + 0 + 0) = \\frac{1}{2}\n$$\n最后，保真度是这个内积的模平方：\n$$\nF = \\left|\\frac{1}{2}\\right|^2 = \\frac{1}{4}\n$$", "answer": "$$\n\\boxed{\\frac{1}{4}}\n$$", "id": "103319"}, {"introduction": "理想的量子门操作在现实中会受到误差的干扰。本练习模拟了在Toffoli门的一个控制比特上存在微小相干误差的情景，通过计算保真度损失，你将具体理解微小误差如何影响计算的最终结果，并初步接触量子误差分析。[@problem_id:103383]", "problem": "托佛利门（Toffoli gate），也称为 CCNOT 门，是一个通用的可逆3量子比特门。其作用于计算基态 $|c_1 c_2 t\\rangle$（其中 $c_1, c_2$ 是控制量子比特，$t$ 是目标量子比特）的操作定义为 $U_{T}|c_1 c_2 t\\rangle = |c_1 c_2, t \\oplus (c_1 \\cdot c_2)\\rangle$，其中 $\\oplus$ 表示模2加法。\n\n考虑一个量子计算，其中一个3量子比特寄存器的预期初始状态为 $|\\psi_{\\text{ideal, in}}\\rangle = |1\\rangle_1 |1\\rangle_2 |0\\rangle_3 \\equiv |110\\rangle$。理想的操作是对此状态应用一个托佛利门 $U_{T}$，得到理想的末态 $|\\psi_{\\text{ideal, out}}\\rangle = U_{T} |\\psi_{\\text{ideal, in}}\\rangle$。\n\n然而，由于态制备过程中的一个缺陷，在第一个控制量子比特上引入了一个小的相干误差。实际制备的态由下式给出：\n$$|\\psi_{\\text{actual, in}}\\rangle = \\left(\\sqrt{1-\\epsilon^2}|1\\rangle_1 + \\epsilon|0\\rangle_1\\right) \\otimes |1\\rangle_2 \\otimes |0\\rangle_3$$\n其中 $\\epsilon$ 是一个代表误差幅度的小实数参数。接着，将同一个托佛利门 $U_T$ 应用于此实际状态，产生实际的末态 $|\\psi_{\\text{actual, out}}\\rangle = U_{T} |\\psi_{\\text{actual, in}}\\rangle$。\n\n两个纯量子态 $|\\phi\\rangle$ 和 $|\\psi\\rangle$ 之间的保真度 $F$ 由 $F = |\\langle\\phi|\\psi\\rangle|^2$ 给出。\n\n计算理想末态与实际末态之间的保真度 $F = |\\langle\\psi_{\\text{ideal, out}}|\\psi_{\\text{actual, out}}\\rangle|^2$。请用 $\\epsilon$ 表示你的答案。", "solution": "解法包含三个主要步骤：\n1.  确定理想末态 $|\\psi_{\\text{ideal, out}}\\rangle$。\n2.  确定实际末态 $|\\psi_{\\text{actual, out}}\\rangle$。\n3.  使用定义计算保真度 $F$。\n\n**步骤1：确定理想末态**\n\n理想初始态为 $|\\psi_{\\text{ideal, in}}\\rangle = |110\\rangle$。我们将托佛利门 $U_T$ 应用于此状态。托佛利门的作用是当且仅当两个控制量子比特都处于 $|1\\rangle$ 态时，翻转目标量子比特。\n\n$$|\\psi_{\\text{ideal, out}}\\rangle = U_T |\\psi_{\\text{ideal, in}}\\rangle = U_T |110\\rangle$$\n\n在这里，控制量子比特（前两个）是 $|1\\rangle$ 和 $|1\\rangle$。因此，目标量子比特（第三个）被翻转（$0 \\rightarrow 1$）。\n\n$$|\\psi_{\\text{ideal, out}}\\rangle = |111\\rangle$$\n\n**步骤2：确定实际末态**\n\n实际初始态由下式给出：\n$$|\\psi_{\\text{actual, in}}\\rangle = \\left(\\sqrt{1-\\epsilon^2}|1\\rangle_1 + \\epsilon|0\\rangle_1\\right) \\otimes |1\\rangle_2 \\otimes |0\\rangle_3$$\n\n我们可以将其展开到计算基上：\n$$|\\psi_{\\text{actual, in}}\\rangle = \\sqrt{1-\\epsilon^2}|110\\rangle + \\epsilon|010\\rangle$$\n\n现在，我们将托佛利门 $U_T$ 应用于此状态。根据量子力学的线性性质，我们可以将门分别作用于叠加态中的每一项：\n$$|\\psi_{\\text{actual, out}}\\rangle = U_T \\left(\\sqrt{1-\\epsilon^2}|110\\rangle + \\epsilon|010\\rangle\\right) = \\sqrt{1-\\epsilon^2} U_T|110\\rangle + \\epsilon U_T|010\\rangle$$\n\n我们计算 $U_T$ 作用于每个基态的结果：\n-   对于 $|110\\rangle$，两个控制位都是 $|1\\rangle$，所以目标位翻转：$U_T|110\\rangle = |111\\rangle$。\n-   对于 $|010\\rangle$，控制位不都是 $|1\\rangle$（第一个控制位是 $|0\\rangle$），所以目标位不翻转：$U_T|010\\rangle = |010\\rangle$。\n\n将这些结果代回实际末态的表达式中：\n$$|\\psi_{\\text{actual, out}}\\rangle = \\sqrt{1-\\epsilon^2}|111\\rangle + \\epsilon|010\\rangle$$\n\n**步骤3：计算保真度**\n\n保真度为 $F = |\\langle\\psi_{\\text{ideal, out}}|\\psi_{\\text{actual, out}}\\rangle|^2$。首先，我们计算内积 $\\langle\\psi_{\\text{ideal, out}}|\\psi_{\\text{actual, out}}\\rangle$。\n\n$$\\langle\\psi_{\\text{ideal, out}}|\\psi_{\\text{actual, out}}\\rangle = \\langle 111 | \\left(\\sqrt{1-\\epsilon^2}|111\\rangle + \\epsilon|010\\rangle\\right)$$\n\n利用内积的分配律：\n$$\\langle\\psi_{\\text{ideal, out}}|\\psi_{\\text{actual, out}}\\rangle = \\sqrt{1-\\epsilon^2}\\langle 111 | 111 \\rangle + \\epsilon\\langle 111 | 010 \\rangle$$\n\n计算基态是标准正交的，即 $\\langle ijk|lmn \\rangle = \\delta_{il}\\delta_{jm}\\delta_{kn}$。因此：\n-   $\\langle 111 | 111 \\rangle = 1$\n-   $\\langle 111 | 010 \\rangle = 0$\n\n代入这些值：\n$$\\langle\\psi_{\\text{ideal, out}}|\\psi_{\\text{actual, out}}\\rangle = \\sqrt{1-\\epsilon^2}(1) + \\epsilon(0) = \\sqrt{1-\\epsilon^2}$$\n\n最后，我们通过对内积的模取平方来计算保真度。由于 $\\epsilon$ 是一个小的实数参数，我们假设 $\\epsilon^2 < 1$，所以 $\\sqrt{1-\\epsilon^2}$ 是实数且为正。\n$$F = |\\sqrt{1-\\epsilon^2}|^2 = 1-\\epsilon^2$$", "answer": "$$\n\\boxed{1 - \\epsilon^2}\n$$", "id": "103383"}]}