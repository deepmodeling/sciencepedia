{"hands_on_practices": [{"introduction": "量子计数算法的核心在于利用量子相位估计算法（QPE）来估计Grover算符的本征相位，从而推断出目标解的数量。[@problem_id:130919] 这道练习将通过一个理想化的场景，带您一步步实践这个核心机制。在这个特意设定的问题中，Grover算符的相位可以被计数寄存器精确地表示，这能帮助您清晰地理解QPE的测量结果如何直接且确定地对应于正确的解数量，为后续更复杂的实践打下坚实基础。", "problem": "量子计数算法 (Quantum Counting Algorithm, QCA) 为一个大小为 $N$ 的空间中的非结构化搜索问题提供了对解的数量 $M$ 的估计。它通过将量子相位估计算法 (Quantum Phase Estimation, QPE) 应用于 Grover 搜索算子 $G$ 来实现。\n\n算子 $G$ 作用于 $n$ 量子比特的态空间，其中 $N=2^n$。其作用实际上是在由所有态的均匀叠加态 $|\\psi_{uniform}\\rangle$ 和 $M$ 个标记的“解”态的均匀叠加态 $|\\psi_{w}\\rangle$ 所张成的二维子空间内的一个旋转。$G$ 的关键性质是其两个非平凡本征值 $e^{\\pm i\\theta}$，其中角度 $\\theta$ 与 $M$ 和 $N$ 的关系由方程 $\\sin(\\theta/2) = \\sqrt{M/N}$ 给出。相应的本征矢 $|\\psi_{\\pm}\\rangle$ 是 $|\\psi_{uniform}\\rangle$ 和 $|\\psi_w\\rangle$ 的叠加。\n\nQCA 从态 $|\\psi_{uniform}\\rangle$（它是 $|\\psi_+\\rangle$ 和 $|\\psi_-\\rangle$ 的叠加态）开始，并使用一个带有 $t$ 量子比特计数寄存器的 QPE 线路来估计相位 $\\phi = \\theta/(2\\pi)$ 和 $1-\\phi = (2\\pi-\\theta)/(2\\pi)$。QPE 过程通过测量计数寄存器来结束，得到一个整数结果 $j \\in \\{0, 1, \\ldots, 2^t-1\\}$。这个整数随后被用来构成对角度的估计值 $\\tilde{\\theta} = 2\\pi j / 2^t$，并因此得到解的数量的估计值 $\\tilde{M} = N \\sin^2(\\tilde{\\theta}/2)$。\n\n考虑一个搜索问题，其中标记项与总项数的比率恰好是 $M/N = 1/2$。执行 QCA 时，计数寄存器中使用 $t=4$ 个量子比特。如果从一个结果 $j$ 导出的估计值 $\\tilde{M}$ 精确等于真实值 $M$，则称该结果 $j$ “对应于正确的解的数量”。\n\n计算测量到对应于正确解的数量的结果 $j$ 的总概率。", "solution": "1. 相关方程\nGrover 角满足\n$$\\sin\\!\\bigl(\\tfrac\\theta2\\bigr)=\\sqrt{\\frac M N}=\\sqrt{\\frac12}=\\frac1{\\sqrt2}\\,. $$\n量子相位估计 (QPE) 估算相位\n$$\\phi=\\frac\\theta{2\\pi},\\quad1-\\phi=\\frac{2\\pi-\\theta}{2\\pi}$$\n通过测量索引 $j\\in\\{0,\\dots,2^t-1\\}$ 得到\n$$\\tilde\\theta=\\frac{2\\pi j}{2^t},\\quad\\tilde M\n=N\\sin^2\\!\\bigl(\\tfrac{\\tilde\\theta}2\\bigr)\\,. $$\n\n2. 求解 $\\theta$\n从 $\\sin(\\theta/2)=1/\\sqrt2$ 和 $\\theta/2\\in[0,\\pi/2]$ 我们得到\n$$\\theta/2=\\frac\\pi4\\;\\Longrightarrow\\;\\theta=\\frac\\pi2\\,. $$\n\n3. 确定精确的相位和索引\n$$\\phi=\\frac{\\pi/2}{2\\pi}=\\frac14,\\quad1-\\phi=\\frac34,\\quad t=4\\implies2^t=16.$$\n因此，精确的测量结果为\n$$j_1=16\\phi=4,\\quad j_2=16(1-\\phi)=12\\,. $$\n\n4. QPE 下的概率\n输入 $|\\psi_{uniform}\\rangle=\\tfrac1{\\sqrt2}(|\\psi_+\\rangle+|\\psi_-\\rangle)$ 得到\n$$P(j_1)=\\tfrac12,\\quad P(j_2)=\\tfrac12,\\quad P(\\text{其他})=0\\,. $$\n$j_1=4$ 和 $j_2=12$ 都给出 $\\tilde M=M$，所以总概率为\n$$P_{\\text{正确}}=P(4)+P(12)=\\frac12+\\frac12=1\\,. $$", "answer": "$$\\boxed{1}$$", "id": "130919"}, {"introduction": "理论知识的价值在于应用，量子计数算法也不例外。它不仅仅是为了得到一个数字，更是一个可以赋能其他量子算法的强大子程序。[@problem_id:116019] 这道练习模拟了一个非常实际的应用场景：我们首先使用量子计数来初步估计解的数量，然后利用这个估计值来设定Grover搜索算法的最佳迭代次数，从而以最高效的方式找到目标解。通过这个练习，您将体会到不同量子算法间的协同作用，并掌握设计多阶段量子协议的解决思路。", "problem": "在量子搜索问题中，给定一个大小为 $N$ 的搜索空间，其中有 $M$ 个标记项。Grover 算法可以高概率地找到一个标记项。该算法基于对一个量子算符 $G$ 的迭代。$G$ 的作用等效于在某个特定的二维希尔伯特空间中的一次旋转。\n\n设状态由相位角 $\\phi = \\frac{1}{\\pi}\\arcsin(\\sqrt{M/N})$ 描述。搜索的初始状态是 $|\\psi_0\\rangle$。在应用 Grover 算符 $k$ 次后，状态变为 $|\\psi_k\\rangle = G^k |\\psi_0\\rangle$。在测量状态 $|\\psi_k\\rangle$ 时，找到一个标记项的概率由下式给出\n$$ P_{succ}(k, \\phi) = \\sin^2((2k+1)\\pi\\phi) $$\n最优迭代次数 $k_{opt}$ 取决于真实的相位 $\\phi$，而该相位通常是未知的。\n\n为解决此问题，可以先使用量子计数算法（Quantum Counting algorithm）得到真实相位 $\\phi$ 的一个估计值 $\\tilde{\\phi}$。基于此估计值，可以计算出运行 Grover 算法的估计迭代次数。一个用于估计迭代次数的常用公式是 $k_{est} = \\lfloor \\frac{1}{4\\tilde{\\phi}} \\rfloor$，该公式在 $\\tilde{\\phi} \\in (0, 1/2]$ 时有效。\n\n假设对于一个给定的搜索问题，其真实相位为 $\\phi_{true} = \\frac{1}{10}$。在一部小型量子计算机上运行一次量子计数算法，得到的估计相位为 $\\tilde{\\phi} = \\frac{1}{16}$。\n\n随后，使用由估计值 $\\tilde{\\phi}$ 决定的迭代次数 $k$（即 $k = \\lfloor \\frac{1}{4\\tilde{\\phi}} \\rfloor$）来执行 Grover 搜索。计算此次 Grover 搜索的成功概率。", "solution": "真实相位为 $\\phi_{true} = \\frac{1}{10}$，估计相位为 $\\tilde{\\phi} = \\frac{1}{16}$。Grover 迭代次数 $k$ 由以下公式确定：\n\n$$\nk = \\left\\lfloor \\frac{1}{4\\tilde{\\phi}} \\right\\rfloor\n$$\n\n代入 $\\tilde{\\phi} = \\frac{1}{16}$：\n\n$$\nk = \\left\\lfloor \\frac{1}{4 \\cdot \\frac{1}{16}} \\right\\rfloor = \\left\\lfloor \\frac{1}{\\frac{4}{16}} \\right\\rfloor = \\left\\lfloor \\frac{1}{\\frac{1}{4}} \\right\\rfloor = \\left\\lfloor 4 \\right\\rfloor = 4\n$$\n\n$k$ 次迭代后的成功概率由下式给出：\n\n$$\nP_{succ}(k, \\phi_{true}) = \\sin^2\\left((2k + 1) \\pi \\phi_{true}\\right)\n$$\n\n代入 $k = 4$ 和 $\\phi_{true} = \\frac{1}{10}$：\n\n$$\nP_{succ} = \\sin^2\\left( (2 \\cdot 4 + 1) \\cdot \\pi \\cdot \\frac{1}{10} \\right) = \\sin^2\\left( 9 \\cdot \\frac{\\pi}{10} \\right) = \\sin^2\\left( \\frac{9\\pi}{10} \\right)\n$$\n\n使用恒等式 $\\sin(\\theta) = \\sin(\\pi - \\theta)$：\n\n$$\n\\sin\\left( \\frac{9\\pi}{10} \\right) = \\sin\\left( \\pi - \\frac{\\pi}{10} \\right) = \\sin\\left( \\frac{\\pi}{10} \\right)\n$$\n\n因此：\n\n$$\nP_{succ} = \\sin^2\\left( \\frac{\\pi}{10} \\right)\n$$\n\n使用倍角公式 $\\sin^2(\\theta) = \\frac{1 - \\cos(2\\theta)}{2}$：\n\n$$\n\\sin^2\\left( \\frac{\\pi}{10} \\right) = \\frac{1 - \\cos\\left( \\frac{\\pi}{5} \\right)}{2}\n$$\n\n$\\cos\\left( \\frac{\\pi}{5} \\right) = \\cos(36^\\circ) = \\frac{\\sqrt{5} + 1}{4}$ 是一个标准值。代入：\n\n$$\n\\sin^2\\left( \\frac{\\pi}{10} \\right) = \\frac{1 - \\frac{\\sqrt{5} + 1}{4}}{2} = \\frac{ \\frac{4 - (\\sqrt{5} + 1)}{4} }{2} = \\frac{3 - \\sqrt{5}}{8}\n$$\n\n因此，成功概率为 $\\frac{3 - \\sqrt{5}}{8}$。", "answer": "$$ \\boxed{\\dfrac{3 - \\sqrt{5}}{8}} $$", "id": "116019"}, {"introduction": "在真实的量子计算机上，算法的性能不仅取决于其理论设计，还受到硬件噪声的严格限制。[@problem_id:115894] 这道高级练习将引导您直面这一挑战，思考如何在有限的量子比特和不可避免的退相干噪声下，优化量子计数算法的性能。您将通过建立一个包含离散化误差和退相干误差的简单模型，运用微积分工具找到最优的计数比特数$t$，从而最小化最终的估计误差。这个过程将让您深刻理解在“带噪中等规模量子”（NISQ）时代，算法设计与硬件现实之间权衡的重要性。", "problem": "量子计数算法是量子计算的基石，旨在估算在大小为 $N=2^n$ 的搜索空间中解的数量 $M$。该算法通过将量子相位估计算法 (QPE) 应用于 Grover 算子 $G$ 来实现这一目标。$G$ 的相关本征值为 $e^{\\pm i \\theta}$，其中相位 $\\theta$ 与解的数量之间的关系为 $M/N = \\sin^2(\\theta/2)$。QPE 使用 $t$ 个辅助“计数”量子比特来产生 $\\theta$ 的一个估计值。\n\n在任何现实的实现中，估计相位 $\\hat{\\theta}$ 的精度受限于两个相互竞争的误差来源，这两个误差来源都取决于 $t$ 的选择：\n\n1.  **离散化误差：** QPE 算法从根本上将连续的相谱离散化。这种离散化的精度由最大有效演化时间决定，由于使用了高达 $G^{2^{t-1}}$ 的受控算子，该时间与 $2^t$ 成正比。根据量子度量学的原理，来自这种“海森堡极限”离散化的相位估计量 $\\hat{\\theta}$ 的方差与演化时间的平方成反比。该部分对总方差的贡献由下式给出：\n    $$ \\text{Var}_{\\text{disc}}(\\hat{\\theta}) = \\frac{\\alpha}{4^t} $$\n    其中 $\\alpha$ 是一个正常数，由 QPE 线路的具体细节和真实相位 $\\theta$ 决定。\n\n2.  **退相干误差：** 用于计数的量子线路会受到噪声的影响。我们用一个逐门的幅度阻尼信道来对此建模。线路的总深度主要由最高次幂的 Grover 算子决定，因此与 $2^t$ 成正比。在整个计算过程中，阻尼信道的累积效应是相位信息的扩散，这引入了一个额外的、独立的方差来源。一个合理的关于这种退相干引起的方差的模型是，它随线路深度线性增长。该部分贡献由下式给出：\n    $$ \\text{Var}_{\\text{deco}}(\\hat{\\theta}) = \\beta \\cdot 2^t $$\n    其中 $\\beta$ 是一个正常数，表示退相干过程的强度。\n\n假设在一个贝叶斯估计框架中，相位 $\\theta$ 具有无信息先验，则 $\\theta$ 的后验分布可以很好地用高斯分布近似。其方差是这两个独立误差来源的方差之和，即 $\\text{Var}_{\\text{total}} = \\text{Var}_{\\text{disc}} + \\text{Var}_{\\text{deco}}$。\n\n你的任务是找到最优的计数量子比特数 $t_{\\text{opt}}$，以最小化这个总后验方差。为了进行优化，请将 $t$ 视为一个连续的正实数变量。请推导出以常数 $\\alpha$ 和 $\\beta$ 表示的 $t_{\\text{opt}}$ 的表达式。", "solution": "我们希望最小化\n$$\n\\mathrm{Var}_{\\rm total}(t)=\\alpha\\,4^{-t}+\\beta\\,2^{t}\n$$\n关于连续变量 $t>0$。\n\n1. 计算导数：\n$$\n\\frac{d}{dt}\\mathrm{Var}_{\\rm total}\n=\\alpha\\frac{d}{dt}2^{-2t}+\\beta\\frac{d}{dt}2^{t}\n=\\alpha(-2\\ln2)\\,2^{-2t}+\\beta(\\ln2)\\,2^{t}\\,.\n$$\n\n2. 令导数为零以求极值：\n$$\n-2\\alpha\\ln2\\,2^{-2t}+\\beta\\ln2\\,2^{t}=0\n\\quad\\Longrightarrow\\quad\n\\beta\\,2^{t}=2\\alpha\\,2^{-2t}\\,.\n$$\n\n3. 求解 $t$：\n$$\n\\beta\\,2^{3t}=2\\alpha\n\\quad\\Longrightarrow\\quad\n2^{3t}=\\frac{2\\alpha}{\\beta}\n\\quad\\Longrightarrow\\quad\n3t\\ln2=\\ln\\!\\bigl(2\\alpha/\\beta\\bigr)\n\\quad\\Longrightarrow\\quad\nt=\\frac{1}{3}\\,\\frac{\\ln\\!\\bigl(2\\alpha/\\beta\\bigr)}{\\ln2}\n=\\frac{1}{3}\\log_{2}\\!\\frac{2\\alpha}{\\beta}\\,.\n$$\n\n检验可知此点的二阶导数为正，确认其为最小值点。", "answer": "$$\\boxed{\\frac{1}{3}\\log_{2}\\!\\frac{2\\alpha}{\\beta}}$$", "id": "115894"}]}