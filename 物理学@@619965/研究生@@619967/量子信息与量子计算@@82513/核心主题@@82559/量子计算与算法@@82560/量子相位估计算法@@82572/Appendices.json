{"hands_on_practices": [{"introduction": "为了打下坚实的基础，我们首先探究一个理想情景。在处理更复杂、更现实的情况之前，理解量子相位估计算法在何种条件下能产生精确、确定性的结果是至关重要的。这个练习 [@problem_id:125956] 将帮助你巩固对计数量子比特数量、待测相位以及结果确定性之间基本关系的理解，展示了QPE算法在最纯粹形式下的一个关键特性。", "problem": "量子相位估计算法 (Quantum Phase Estimation, QPE) 是一种基本的量子算法，用于估计一个幺正算符的本征值。给定一个幺正算符 $U$ 及其一个本征态 $|\\psi\\rangle$，满足 $U|\\psi\\rangle = e^{i2\\pi\\phi}|\\psi\\rangle$，该算法旨在找到相位 $\\phi \\in [0, 1)$ 的一个估计值。\n\n标准的 QPE 电路使用两个量子寄存器。第一个是 $t$ 量子比特的“估计”寄存器，初始化为 $|0\\rangle^{\\otimes t}$。第二个是用于存储本征态 $|\\psi\\rangle$ 的寄存器。该算法按以下步骤进行：\n1.  对估计寄存器中的每个量子比特应用一个 Hadamard 门。\n2.  对于估计寄存器中的每个量子比特 $j$（从 $j=0$ 到 $t-1$），对 $|\\psi\\rangle$ 寄存器应用一个受控-$U^{2^j}$ 操作。\n3.  对估计寄存器应用逆量子傅里叶变换 (inverse Quantum Fourier Transform, QFT)。\n4.  在计算基下测量估计寄存器。测量结果是一个介于 $0$ 和 $2^t-1$ 之间的整数 $m$。相位则估计为 $\\tilde{\\phi} = m/2^t$。\n\n逆 QFT 在一个 $t$ 量子比特寄存器上的作用定义为：\n$$\n\\text{QFT}^{-1} |x\\rangle = \\frac{1}{\\sqrt{2^t}} \\sum_{y=0}^{2^t-1} e^{-i 2\\pi xy / 2^t} |y\\rangle\n$$\n\n考虑一个具有 $t=3$ 量子比特估计寄存器的 QPE 电路，该电路旨在估计一个幺正算符 $U$ 的相位 $\\phi=1/4$。最佳整数测量结果 $m_{\\text{best}}$ 是恰好满足 $m_{\\text{best}}/2^t = \\phi$ 的整数。\n\n计算测量得到的整数结果 $m$ 与最佳结果相差恰好为 1 的总概率，即，求测量结果为 $m_{\\text{best}}-1$ 或 $m_{\\text{best}}+1$ 的概率。", "solution": "我们有 $t=3$ 和 $\\phi=\\tfrac14$，所以“最佳”结果是\n$$m_{\\rm best} = 2^t\\phi = 8\\cdot\\tfrac14 = 2.$$\nQPE 的测量概率由下式给出\n$$\nP(m)\n=\\left|\\frac{1}{2^t}\\sum_{k=0}^{2^t-1} e^{i2\\pi k(\\phi - m/2^t)}\\right|^2\n=\\frac{\\sin^2\\!\\bigl(\\pi\\,2^t(\\phi - m/2^t)\\bigr)}\n{2^{2t}\\,\\sin^2\\!\\bigl(\\pi(\\phi - m/2^t)\\bigr)}.\n$$\n定义偏移量\n$$\\delta_m = \\phi - \\frac m{2^t}.$$\n那么\n$$2^t\\delta_m = 2^t\\phi - m.$$\n对于 $m=1$ 或 $m=3$（即 $m_{\\rm best}\\pm1$），我们有\n$$2^t\\phi - m = 2 - m = \\begin{cases}2-1=1,&m=1,\\\\2-3=-1,&m=3,\\end{cases}$$\n所以\n$$\nP(m)\n=\\frac{\\sin^2(\\pi\\,(2^t\\phi-m))}{2^{2t}\\,\\sin^2\\!\\bigl(\\pi(\\phi - m/2^t)\\bigr)}\n=\\frac{\\sin^2(\\pi\\cdot\\pm1)}{8^2\\,\\sin^2\\!\\bigl(\\pi(\\tfrac14 - m/8)\\bigr)}.\n$$\n由于 $\\sin(\\pi\\cdot\\pm1)=\\sin\\pi=0$，每一项都为零：\n$$P(1)=0,\\quad P(3)=0.$$\n因此，与最佳结果相差恰好为 1 的总概率是\n$$P(1)+P(3)=0+0=0.$$", "answer": "$$\\boxed{0}$$", "id": "125956"}, {"introduction": "从抽象理论走向实际应用，QPE最重要的用途之一是在量子化学和材料科学中寻找哈密顿量的能量本征值。在实践中，制备一个完美的本征态作为输入往往是不可能的。这个实践 [@problem_id:125794] 模拟了一个现实场景，其中输入态是哈密顿量本征态的叠加，它将引导你计算成功测得系统基态能量的概率，从而搭建起QPE算法与其在量子模拟中应用之间的桥梁。", "problem": "量子相位估计算法（QPE）是量子计算的基石，主要用于确定幺正算符 $U$ 的本征值。当制备一个输入态 $|\\psi_{in}\\rangle$ 时，如果该状态可以表示为 $U$ 的本征态 $|\\phi_j\\rangle$ 的线性组合（即 $|\\psi_{in}\\rangle = \\sum_j c_j |\\phi_j\\rangle$），QPE 算法将以 $|c_j|^2$ 的概率测量出相应本征值 $e^{i\\theta_j}$ 的相位 $\\theta_j$。\n\n考虑一个旨在寻找如下给出的双量子比特哈密顿量的能量本征值的 QPE 过程：\n$$\nH = Z_1 + g X_1 X_2\n$$\n此处，$Z_1 = Z \\otimes I$ 和 $X_1 X_2 = X \\otimes X$ 是作用于双量子比特希尔伯特空间上的算符，其中 $Z$ 和 $X$ 是标准的泡利矩阵。参数 $g$ 是一个实的正耦合常数。QPE 过程使用幺正算符 $U = e^{-iHt}$（对于某个演化时间 $t$），并有效地探测 $H$ 的能谱。\n\n系统被制备在初始态 $|\\psi_{in}\\rangle = |10\\rangle$。请注意，该状态是孤立哈密顿项 $H_0 = Z_1$ 的两个简并基态之一。\n\n一次“成功”的测量被定义为得到完整哈密顿量 $H$ 的基态能量 $E_g$ 的测量。假设 QPE 电路有足够数量的辅助量子比特，可以在没有任何近似误差的情况下分辨出 $H$ 的不同能量本征值，请计算成功概率 $P_{succ}$ 作为耦合参数 $g$ 的函数。", "solution": "哈密顿量由 $ H = Z_1 + g X_1 X_2 $ 给出，其中 $ Z_1 = Z \\otimes I $ 且 $ X_1 X_2 = X \\otimes X $。初始态为 $ |\\psi_{\\text{in}}\\rangle = |10\\rangle $。目标是使用量子相位估计算法，找到测量出 $H$ 的基态能量 $ E_g $ 的概率。这需要将 $ |\\psi_{\\text{in}}\\rangle $ 在 $H$ 的本征基中展开，并提取出基态所对应的系数。\n\n$H$ 在计算基 $ \\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\} $ 中的矩阵表示为：\n$$\nH = \\begin{pmatrix}\n1 & 0 & 0 & g \\\\\n0 & 1 & g & 0 \\\\\n0 & g & -1 & 0 \\\\\ng & 0 & 0 & -1\n\\end{pmatrix}.\n$$\n该矩阵是块对角矩阵，有两个不变子空间：$ \\{|00\\rangle, |11\\rangle\\} $ 和 $ \\{|01\\rangle, |10\\rangle\\} $。对于 $ \\{|01\\rangle, |10\\rangle\\} $ 的子块是：\n$$\nH_{\\{01,10\\}} = \\begin{pmatrix}\n1 & g \\\\\ng & -1\n\\end{pmatrix}.\n$$\n初始态 $ |10\\rangle $ 完全位于此子空间内。该子块的本征值通过求解特征方程得到：\n$$\n\\det \\begin{pmatrix}\n1 - \\lambda & g \\\\\ng & -1 - \\lambda\n\\end{pmatrix} = 0 \\implies (1 - \\lambda)(-1 - \\lambda) - g^2 = 0 \\implies \\lambda^2 - 1 - g^2 = 0.\n$$\n解为 $ \\lambda = \\pm \\sqrt{1 + g^2} $。基态能量 $ E_g $ 对应于较小的本征值 $ \\lambda_{-} = -\\sqrt{1 + g^2} $。\n\n在子空间 $ \\{|01\\rangle, |10\\rangle\\} $ 中，对应于 $ \\lambda_{-} $ 的本征向量 $ |v_{-}\\rangle $ 满足：\n$$\n\\begin{pmatrix}\n1 & g \\\\\ng & -1\n\\end{pmatrix} \\begin{pmatrix} A \\\\ B \\end{pmatrix} = -\\sqrt{1 + g^2} \\begin{pmatrix} A \\\\ B \\end{pmatrix},\n$$\n得到方程：\n$$\n(1 + \\sqrt{1 + g^2})A + gB = 0 \\implies B = -\\frac{1 + \\sqrt{1 + g^2}}{g} A.\n$$\n选择一个未归一化的形式 $ |v_{-}\\rangle = g |01\\rangle - (1 + \\sqrt{1 + g^2}) |10\\rangle $，其范数为：\n$$\n\\| |v_{-}\\rangle \\|^2 = g^2 + (1 + \\sqrt{1 + g^2})^2 = g^2 + 1 + 2\\sqrt{1 + g^2} + 1 + g^2 = 2(1 + g^2 + \\sqrt{1 + g^2}).\n$$\n因此，归一化的本征向量为：\n$$\n|v_{-}\\rangle = \\frac{g |01\\rangle - (1 + \\sqrt{1 + g^2}) |10\\rangle}{\\sqrt{2(1 + g^2 + \\sqrt{1 + g^2})}}.\n$$\n与初始态 $ |10\\rangle $ 的内积为：\n$$\n\\langle v_{-} | 10 \\rangle = -\\frac{1 + \\sqrt{1 + g^2}}{\\sqrt{2(1 + g^2 + \\sqrt{1 + g^2})}}.\n$$\n测量到基态能量的概率是这个内积的模平方：\n$$\nP_{\\text{succ}} = \\left| \\langle v_{-} | 10 \\rangle \\right|^2 = \\frac{(1 + \\sqrt{1 + g^2})^2}{2(1 + g^2 + \\sqrt{1 + g^2})}.\n$$\n简化，令 $ s = \\sqrt{1 + g^2} $，所以：\n$$\nP_{\\text{succ}} = \\frac{(1 + s)^2}{2(s^2 + s)} = \\frac{(1 + s)^2}{2s(s + 1)} = \\frac{1 + s}{2s} = \\frac{1}{2} \\left( 1 + \\frac{1}{s} \\right) = \\frac{1}{2} \\left( 1 + \\frac{1}{\\sqrt{1 + g^2}} \\right).\n$$\n初始态 $ |10\\rangle $ 在另一个子空间 $ \\{|00\\rangle, |11\\rangle\\} $ 中没有分量，所以概率完全来自于 $ |v_{-}\\rangle $。\n\n因此，成功的概率为：\n$$\nP_{\\text{succ}} = \\frac{1}{2} \\left( 1 + \\frac{1}{\\sqrt{1 + g^2}} \\right).\n$$", "answer": "$$ \\boxed{\\dfrac{1}{2}\\left(1 + \\dfrac{1}{\\sqrt{1 + g^{2}}}\\right)} $$", "id": "125794"}, {"introduction": "在模拟复杂哈密顿量时，我们常常使用像特罗特-铃木分解这样的方法来近似时间演化算符，但这会引入系统误差。为了获得精确的结果，我们需要更高级的技术来消除这些误差。这个高级练习 [@problem_id:125854] 介绍了一种强大的经典后处理技术——理查森外推法，用以抵消主要的误差项。通过结合不同参数下的多次实验结果，你将学会如何推导出显著更精确的估计值，这是执行高精度量子模拟的一项关键技能。", "problem": "在对哈密顿量 $H = \\sum_j H_j$ 进行总时间为 $t$ 的量子模拟时，演化酉算符 $U = e^{-iHt}$ 通常被近似。一种常用的方法是一阶 Trotter-Suzuki 分解。当在量子相位估计算法 (QPE) 中使用时，这种近似会在估计的相位中引入系统误差。\n\n假设对于一个固定的总演化时间，使用步长为 $\\delta$ 的一阶 Trotter 近似，通过 QPE 估算的相位 $\\hat{\\theta}(\\delta)$ 的误差可以展开为如下的幂级数：\n$$\n\\hat{\\theta}(\\delta) = \\theta_{true} + C_1 \\delta + C_2 \\delta^2 + C_3 \\delta^3 + \\mathcal{O}(\\delta^4)\n$$\n此处，$\\theta_{true}$ 是对应于 $U$ 的一个本征值的精确相位，$C_1, C_2, C_3$ 是由哈密顿量和相关本征态决定的未知常数。\n\n为了减轻此误差，使用 $\\epsilon$、$\\epsilon/2$ 和 $\\epsilon/4$ 的 Trotter 步长进行了三次独立的 QPE 实验。得到的相位估计值分别表示为 $\\hat{\\theta}(\\epsilon)$、$\\hat{\\theta}(\\epsilon/2)$ 和 $\\hat{\\theta}(\\epsilon/4)$。\n\n使用这三次测量结果，推导出 $\\theta_{true}$ 的 Richardson 外推估计值，其精度达到 $\\mathcal{O}(\\epsilon^3)$。将这个改进的估计值表示为三个测量相位 $\\hat{\\theta}(\\epsilon)$、$\\hat{\\theta}(\\epsilon/2)$ 和 $\\hat{\\theta}(\\epsilon/4)$ 的单一线性组合。", "solution": "我们有在不同步长下测得的相位的展开式：\n$$\n\\hat\\theta(\\epsilon)=\\theta_{true}+C_1\\epsilon+C_2\\epsilon^2+C_3\\epsilon^3+\\mathcal{O}(\\epsilon^4),\n$$\n$$\n\\hat\\theta\\bigl(\\tfrac\\epsilon2\\bigr)\n=\\theta_{true}+C_1\\tfrac\\epsilon2+C_2\\tfrac{\\epsilon^2}{4}+C_3\\tfrac{\\epsilon^3}{8}+\\mathcal{O}(\\epsilon^4),\n$$\n$$\n\\hat\\theta\\bigl(\\tfrac\\epsilon4\\bigr)\n=\\theta_{true}+C_1\\tfrac\\epsilon4+C_2\\tfrac{\\epsilon^2}{16}+C_3\\tfrac{\\epsilon^3}{64}+\\mathcal{O}(\\epsilon^4).\n$$\n我们寻求一个线性组合 \n$$L=a\\,\\hat\\theta(\\epsilon)+b\\,\\hat\\theta(\\tfrac\\epsilon2)+c\\,\\hat\\theta(\\tfrac\\epsilon4)$$\n使得 $L=\\theta_{true}+\\mathcal{O}(\\epsilon^3)$。对比系数可得到如下方程组：\n$$\na+b+c=1,\\quad\na+\\tfrac b2+\\tfrac c4=0,\\quad\na+\\tfrac b4+\\tfrac c{16}=0.\n$$\n将第三个方程减去第二个方程，可得 $4b+3c=0\\implies b=-\\tfrac{3c}4$。然后，由第三个方程可得，\n$$\na=-\\frac b4-\\frac c{16}=\\frac{c}{8}.\n$$\n代入 $a+b+c=1$ 可得\n$$\n\\frac{c}{8}-\\frac{3c}{4}+c=1\n\\implies 3c=8\n\\implies c=\\frac{8}{3},\\quad b=-2,\\quad a=\\frac{1}{3}.\n$$\n因此，Richardson 外推估计值为\n$$\nL=\\frac{1}{3}\\,\\hat\\theta(\\epsilon)-2\\,\\hat\\theta\\bigl(\\tfrac\\epsilon2\\bigr)\n+\\frac{8}{3}\\,\\hat\\theta\\bigl(\\tfrac\\epsilon4\\bigr)\n=\\frac{\\hat\\theta(\\epsilon)-6\\,\\hat\\theta(\\tfrac\\epsilon2)+8\\,\\hat\\theta(\\tfrac\\epsilon4)}{3}.\n$$", "answer": "$$\\boxed{\\frac{\\hat{\\theta}(\\epsilon)-6\\,\\hat{\\theta}(\\epsilon/2)+8\\,\\hat{\\theta}(\\epsilon/4)}{3}}$$", "id": "125854"}]}