{"hands_on_practices": [{"introduction": "格罗弗（Grover）算法的几何图像将其描述为在二维平面上的旋转。但我们如何“观测”到这种旋转呢？这个练习通过计算预言机（oracle）算符 $U_\\omega$ 在算法迭代过程中的期望值，提供了一个量化演化状态的方法。这个期望值的振荡行为直观地揭示了状态向量在目标态和初始态所构成平面中的周期性旋转，是理解算法动态核心的关键一步。[@problem_id:88187]", "problem": "Grover 搜索算法为非结构化搜索问题提供了二次方加速。该算法的核心是一个迭代过程，它在一个更大的态空间中放大了标记量子态的幅。\n\n考虑一个具有 $N$ 维希尔伯特空间的量子系统，该空间由一组正交归一的计算基 $\\{|x\\rangle\\}_{x=0}^{N-1}$ 张成。任务是从该基中找到一个单一的标记态，记作 $|\\omega\\rangle$。算法从所有基态的均匀叠加态开始，即 $|s\\rangle = \\frac{1}{\\sqrt{N}}\\sum_{x=0}^{N-1} |x\\rangle$。\n\n算法的每次迭代包括将 Grover 算符 $G$ 应用于系统的状态。Grover 算符是两个幺正算符的乘积，$G = U_s U_\\omega$，其中：\n1.  神谕算符 $U_\\omega = I - 2|\\omega\\rangle\\langle\\omega|$，它会翻转标记态 $|\\omega\\rangle$ 的相位。这里，$I$ 是单位算符。\n2.  扩散算符 $U_s = 2|s\\rangle\\langle s| - I$，它将状态绕初始态 $|s\\rangle$ 进行反射。\n\n经过 $k$ 次迭代后，系统处于状态 $|\\psi_k\\rangle = G^k |s\\rangle$。\n\n您的任务是计算神谕算符 $U_\\omega$ 相对于状态 $|\\psi_k\\rangle$ 的期望值。这个量 $\\langle U_\\omega \\rangle_k = \\langle \\psi_k | U_\\omega | \\psi_k \\rangle$ 揭示了随着算法的进行，状态如何与神谕算符的本征空间对齐。\n\n请用项目数 $N$ 和迭代次数 $k$ 的函数来表示您的答案。", "solution": "要计算期望值 $\\langle U_\\omega \\rangle_k = \\langle \\psi_k | U_\\omega | \\psi_k \\rangle$（其中 $|\\psi_k\\rangle = G^k |s\\rangle$），我们利用由标记态 $|\\omega\\rangle$ 和未标记态的均匀叠加态所张成的二维子空间。定义 $|\\alpha\\rangle$ 为与 $|\\omega\\rangle$ 正交的归一化态：\n\n\n$$\n|\\alpha\\rangle = \\frac{1}{\\sqrt{N-1}} \\sum_{x \\neq \\omega} |x\\rangle.\n$$\n\n\n初始态 $|s\\rangle$ 为：\n\n\n$$\n|s\\rangle = \\sqrt{\\frac{1}{N}} |\\omega\\rangle + \\sqrt{\\frac{N-1}{N}} |\\alpha\\rangle = \\sin\\theta \\, |\\omega\\rangle + \\cos\\theta \\, |\\alpha\\rangle,\n$$\n\n\n其中 $\\theta = \\arcsin(1/\\sqrt{N})$，因此 $\\sin\\theta = 1/\\sqrt{N}$ 且 $\\cos\\theta = \\sqrt{(N-1)/N}$。\n\nGrover 算符 $G$ 在 $\\{|\\alpha\\rangle, |\\omega\\rangle\\}$ 平面内将状态旋转一个角度 $2\\theta$。经过 $k$ 次迭代后，状态变为：\n\n\n$$\n|\\psi_k\\rangle = \\sin((2k+1)\\theta) \\, |\\omega\\rangle + \\cos((2k+1)\\theta) \\, |\\alpha\\rangle.\n$$\n\n\n神谕算符为 $U_\\omega = I - 2|\\omega\\rangle\\langle\\omega|$。将其应用于 $|\\psi_k\\rangle$：\n\n\n$$\nU_\\omega |\\psi_k\\rangle = (I - 2|\\omega\\rangle\\langle\\omega|) \\left[ \\sin((2k+1)\\theta) \\, |\\omega\\rangle + \\cos((2k+1)\\theta) \\, |\\alpha\\rangle \\right] = -\\sin((2k+1)\\theta) \\, |\\omega\\rangle + \\cos((2k+1)\\theta) \\, |\\alpha\\rangle.\n$$\n\n\n现在计算期望值：\n\n\n$$\n\\langle \\psi_k | U_\\omega | \\psi_k \\rangle = \\left[ \\sin((2k+1)\\theta) \\, \\langle\\omega| + \\cos((2k+1)\\theta) \\, \\langle\\alpha| \\right] \\left[ -\\sin((2k+1)\\theta) \\, |\\omega\\rangle + \\cos((2k+1)\\theta) \\, |\\alpha\\rangle \\right].\n$$\n\n\n展开乘积并利用正交归一性（$\\langle\\omega|\\alpha\\rangle = 0$, $\\langle\\alpha|\\omega\\rangle = 0$, $\\langle\\omega|\\omega\\rangle = 1$, $\\langle\\alpha|\\alpha\\rangle = 1$）：\n\n\n$$\n\\begin{aligned}\n\\langle \\psi_k | U_\\omega | \\psi_k \\rangle &= \\sin((2k+1)\\theta) \\cdot (-\\sin((2k+1)\\theta)) \\langle\\omega|\\omega\\rangle + \\sin((2k+1)\\theta) \\cdot \\cos((2k+1)\\theta) \\langle\\omega|\\alpha\\rangle \\\\\n&\\quad + \\cos((2k+1)\\theta) \\cdot (-\\sin((2k+1)\\theta)) \\langle\\alpha|\\omega\\rangle + \\cos((2k+1)\\theta) \\cdot \\cos((2k+1)\\theta) \\langle\\alpha|\\alpha\\rangle \\\\\n&= -\\sin^2((2k+1)\\theta) + \\cos^2((2k+1)\\theta) \\\\\n&= \\cos(2(2k+1)\\theta),\n\\end{aligned}\n$$\n\n\n使用倍角公式 $\\cos(2\\phi) = \\cos^2\\phi - \\sin^2\\phi$，其中 $\\phi = (2k+1)\\theta$。代入 $\\theta = \\arcsin(1/\\sqrt{N})$：\n\n\n$$\n\\langle U_\\omega \\rangle_k = \\cos\\left(2(2k+1) \\arcsin\\left(\\frac{1}{\\sqrt{N}}\\right)\\right).\n$$\n\n\n简化参数：\n\n\n$$\n2(2k+1) = 4k+2,\n$$\n\n\n因此表达式为：\n\n\n$$\n\\langle U_\\omega \\rangle_k = \\cos\\left((4k+2) \\arcsin\\left(\\frac{1}{\\sqrt{N}}\\right)\\right).\n$$", "answer": "$$\n\\boxed{ \\cos\\left( (4k+2) \\arcsin\\left( \\frac{1}{\\sqrt{N}} \\right) \\right) }\n$$", "id": "88187"}, {"introduction": "格罗弗算法的威力源于两个反射算符的巧妙组合。此练习通过一个思想实验向你提出挑战：如果我们将作为反射的扩散算符 $U_s$ 替换为一个投影算符 $P_s$，会发生什么？通过分析这个改动带来的后果，你将能更深刻地领会为什么格罗弗算符的特定结构——特别是扩散算符的反射特性——对于实现振幅放大是不可或缺的。[@problem_id:88232]", "problem": "考虑一个对Grover量子搜索算法的修改。搜索空间是一个由正交归一基 $\\{|0\\rangle, |1\\rangle, \\dots, |N-1\\rangle\\}$ 张成的 $N$ 维希尔伯特空间，其中 $N > 2$。该算法旨在找到一个单一的标记目标态，记作 $|w\\rangle$。\n\n系统的初始态是均匀叠加态 $|s\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{i=0}^{N-1} |i\\rangle$。\n\n该修改算法的一次迭代包含两个操作：\n1. 应用标准的神谕算符 $U_w$，它会翻转目标态的符号：$U_w = I - 2|w\\rangle\\langle w|$。\n2. 应用一个修改过的“扩散”算符，它是到初始态 $|s\\rangle$ 上的投影算符，由 $P_s = |s\\rangle\\langle s|$ 给出。\n\n因此，该修改算法单次迭代的算符为 $G' = P_s U_w$。从初始态 $|\\psi_0\\rangle = |s\\rangle$ 开始，经过 $k$ 次迭代后的状态由未归一化的态 $|\\psi_k\\rangle = (G')^k |s\\rangle$ 给出，其中 $k$ 为任意正整数。\n\n你的任务是计算该算法在 $k$ 次迭代后的成功概率。成功概率定义为当系统处于状态 $|\\psi_k\\rangle$ 时，测量得到目标态 $|w\\rangle$ 的概率。用 $N$ 来表示你的最终答案。", "solution": "初始态为 $|s\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{i=0}^{N-1} |i\\rangle$。目标态为 $|w\\rangle$。将 $|s\\rangle$ 用 $|w\\rangle$ 和非目标态的均匀叠加态 $|s'\\rangle = \\frac{1}{\\sqrt{N-1}} \\sum_{i \\neq w} |i\\rangle$ 来表示，其中 $|s'\\rangle$ 与 $|w\\rangle$ 正交：\n\n\n$$\n|s\\rangle = \\alpha |w\\rangle + \\beta |s'\\rangle,\n$$\n\n其中 $\\alpha = \\langle w | s \\rangle = \\frac{1}{\\sqrt{N}}$ 且 $\\beta = \\sqrt{\\frac{N-1}{N}}$。在这些算符的作用下，状态始终保持在由 $\\{|w\\rangle, |s'\\rangle\\}$ 张成的二维子空间中。\n\n神谕算符为 $U_w = I - 2|w\\rangle\\langle w|$，其作用如下：\n\n$$\nU_w |w\\rangle = -|w\\rangle, \\quad U_w |s'\\rangle = |s'\\rangle.\n$$\n\n\n扩散算符是投影算符 $P_s = |s\\rangle\\langle s|$。迭代算符为 $G' = P_s U_w$。\n\n在基 $\\{|w\\rangle, |s'\\rangle\\}$ 中表示 $G'$：\n\n$$\nG' = \\begin{pmatrix}\n-\\alpha^2 & \\alpha \\beta \\\\\n-\\alpha \\beta & \\beta^2\n\\end{pmatrix},\n$$\n\n使用 $\\alpha = \\frac{1}{\\sqrt{N}}$，$\\beta = \\sqrt{\\frac{N-1}{N}}$，它们都是实数。\n\n初始态矢量为：\n\n$$\n|\\psi_0\\rangle = \\begin{pmatrix} \\alpha \\\\ \\beta \\end{pmatrix}.\n$$\n\n\n经过 $k$ 次迭代后：\n\n$$\n|\\psi_k\\rangle = (G')^k |\\psi_0\\rangle.\n$$\n\n\n$G'$ 的特征值可以通过特征方程求得：\n\n$$\n\\det(G' - \\lambda I) = \\det \\begin{pmatrix} -\\alpha^2 - \\lambda & \\alpha \\beta \\\\ -\\alpha \\beta & \\beta^2 - \\lambda \\end{pmatrix} = (-\\alpha^2 - \\lambda)(\\beta^2 - \\lambda) + (\\alpha \\beta)^2 = 0.\n$$\n\n化简得：\n\n$$\n\\lambda^2 + \\lambda (\\alpha^2 - \\beta^2) = 0,\n$$\n\n所以特征值为 $\\lambda_1 = 0$ 和 $\\lambda_2 = \\beta^2 - \\alpha^2$。\n\n对应于 $\\lambda_2$ 的特征向量为 $\\begin{pmatrix} \\alpha \\\\ \\beta \\end{pmatrix}$，这与 $|\\psi_0\\rangle$ 相匹配。因此：\n\n$$\n|\\psi_k\\rangle = (\\lambda_2)^k |\\psi_0\\rangle = (\\beta^2 - \\alpha^2)^k \\begin{pmatrix} \\alpha \\\\ \\beta \\end{pmatrix}.\n$$\n\n\n代入 $\\alpha$ 和 $\\beta$：\n\n$$\n\\beta^2 - \\alpha^2 = \\frac{N-1}{N} - \\frac{1}{N} = \\frac{N-2}{N}.\n$$\n\n所以：\n\n$$\n|\\psi_k\\rangle = \\left( \\frac{N-2}{N} \\right)^k \\left( \\alpha |w\\rangle + \\beta |s'\\rangle \\right).\n$$\n\n\n$|w\\rangle$ 的振幅为：\n\n$$\n\\langle w | \\psi_k \\rangle = \\left( \\frac{N-2}{N} \\right)^k \\alpha.\n$$\n\n\n$|\\psi_k\\rangle$ 的范数为：\n\n$$\n\\langle \\psi_k | \\psi_k \\rangle = \\left| \\left( \\frac{N-2}{N} \\right)^k \\right|^2 \\left( |\\alpha|^2 + |\\beta|^2 \\right) = \\left( \\frac{N-2}{N} \\right)^{2k} \\left( \\frac{1}{N} + \\frac{N-1}{N} \\right) = \\left( \\frac{N-2}{N} \\right)^{2k}.\n$$\n\n\n成功概率是测量到 $|w\\rangle$ 的概率：\n\n$$\np_k = \\frac{ |\\langle w | \\psi_k \\rangle|^2 }{ \\langle \\psi_k | \\psi_k \\rangle } = \\frac{ \\left[ \\left( \\frac{N-2}{N} \\right)^k \\alpha \\right]^2 }{ \\left( \\frac{N-2}{N} \\right)^{2k} } = \\alpha^2 = \\left( \\frac{1}{\\sqrt{N}} \\right)^2 = \\frac{1}{N}.\n$$\n\n\n这个概率与 $k$ 无关。", "answer": "$$\n\\boxed{\\dfrac{1}{N}}\n$$", "id": "88232"}, {"introduction": "真实的量子计算机并非完美无瑕。最后的这个练习引入了一个贴近实际的误差模型，即初始状态的制备不完美，导致部分振幅“泄漏”到了理想的格罗弗子空间之外。分析这种情况有助于我们理解算法的鲁棒性，以及格罗弗算符在整个希尔伯特空间中的行为，而不仅仅是局限于理想的二维平面。[@problem_id:88215]", "problem": "考虑在一个包含 $N$ 个条目的数据库中搜索单个标记项 $|w\\rangle$ 的 Grover 搜索算法。该算法在一个 $N$ 维希尔伯特空间 $\\mathcal{H}$ 中运行。标准算法在由目标态 $|w\\rangle$ 和均匀叠加态 $|\\psi_{\\text{unif}}\\rangle = \\frac{1}{\\sqrt{N}}\\sum_{i=0}^{N-1}|i\\rangle$ 张成的二维子空间 $\\mathcal{H}_G$ 内演化量子态。\n\n假设由于态制备中的瑕疵，初态 $|\\psi_0\\rangle$ 并非完美的均匀叠加态。它是一个纯态，相对于 $|\\psi_{\\text{unif}}\\rangle$ 的保真度为 $F=|\\langle \\psi_{\\text{unif}} | \\psi_0 \\rangle|^2 = 1-\\epsilon^2$，其中 $0 < \\epsilon < 1$ 是一个很小的参数。这个瑕疵被建模为振幅泄漏到一个态 $|\\psi_{\\text{leak}}\\rangle$ 上，该态是归一化的，并且位于 $\\mathcal{H}_G$ 的正交补空间 $\\mathcal{H}_G^\\perp$ 中。具体来说，初态由下式给出：\n$$\n|\\psi_0\\rangle = \\sqrt{1-\\epsilon^2} |\\psi_{\\text{unif}}\\rangle + \\epsilon |\\psi_{\\text{leak}}\\rangle\n$$\n其中我们假设 $\\epsilon$ 是实数且为正。\n\n搜索是通过应用标准 Grover 算子 $G = U_{\\psi_{\\text{unif}}} U_w$ 来执行的，其中 $U_w = I-2|w\\rangle\\langle w|$ 是神谕算子，$U_{\\psi_{\\text{unif}}} = 2|\\psi_{\\text{unif}}\\rangle\\langle \\psi_{\\text{unif}}| - I$ 是扩散算子。\n\n假设数据库的大小 $N$ 满足以下条件：对于一次理想搜索（从 $|\\psi_{\\text{unif}}\\rangle$ 开始），存在一个最佳整数迭代次数，记为 $k_{\\text{opt}}$，它能以概率 1 找到标记态 $|w\\rangle$。\n\n如果我们将算法应用于不完美的初态 $|\\psi_0\\rangle$ 并运行相同的最佳迭代次数 $k_{\\text{opt}}$，计算找到目标态 $|w\\rangle$ 的成功概率。", "solution": "初态由下式给出：\n\n$$\n|\\psi_0\\rangle = \\sqrt{1-\\epsilon^2} |\\psi_{\\text{unif}}\\rangle + \\epsilon |\\psi_{\\text{leak}}\\rangle\n$$\n\n其中 $|\\psi_{\\text{leak}}\\rangle$ 是归一化的，且位于由 $|w\\rangle$ 和 $|\\psi_{\\text{unif}}\\rangle$ 张成的二维子空间 $\\mathcal{H}_G$ 的正交补空间 $\\mathcal{H}_G^\\perp$ 中。因此，$\\langle w | \\psi_{\\text{leak}} \\rangle = 0$ 且 $\\langle \\psi_{\\text{unif}} | \\psi_{\\text{leak}} \\rangle = 0$。\n\nGrover 算子为 $G = U_{\\psi_{\\text{unif}}} U_w$，其中 $U_w = I - 2|w\\rangle\\langle w|$ 且 $U_{\\psi_{\\text{unif}}} = 2|\\psi_{\\text{unif}}\\rangle\\langle \\psi_{\\text{unif}}| - I$。对于任意态 $|v\\rangle \\in \\mathcal{H}_G^\\perp$，$G$ 的作用是：\n\n$$\nG |v\\rangle = U_{\\psi_{\\text{unif}}}} U_w |v\\rangle = U_{\\psi_{\\text{unif}}}} |v\\rangle = -|v\\rangle\n$$\n\n因为 $U_w |v\\rangle = |v\\rangle$（由于 $\\langle w | v \\rangle = 0$）且 $U_{\\psi_{\\text{unif}}}} |v\\rangle = -|v\\rangle$（由于 $\\langle \\psi_{\\text{unif}} | v \\rangle = 0$）。因此，经过 $k$ 次迭代后：\n\n$$\nG^k |v\\rangle = (-1)^k |v\\rangle.\n$$\n\n\n经过 $k_{\\text{opt}}$ 次迭代后，量子态演化为：\n\n$$\n|\\psi_{k_{\\text{opt}}}\\rangle = G^{k_{\\text{opt}}} |\\psi_0\\rangle = \\sqrt{1-\\epsilon^2}  G^{k_{\\text{opt}}} |\\psi_{\\text{unif}}\\rangle + \\epsilon  G^{k_{\\text{opt}}} |\\psi_{\\text{leak}}\\rangle.\n$$\n\n\n根据假设，对于理想初态 $|\\psi_{\\text{unif}}\\rangle$，$G^{k_{\\text{opt}}} |\\psi_{\\text{unif}}\\rangle = |w\\rangle$。同时，$G^{k_{\\text{opt}}} |\\psi_{\\text{leak}}\\rangle = (-1)^{k_{\\text{opt}}} |\\psi_{\\text{leak}}\\rangle$。代入这些结果：\n\n$$\n|\\psi_{k_{\\text{opt}}}\\rangle = \\sqrt{1-\\epsilon^2} |w\\rangle + \\epsilon (-1)^{k_{\\text{opt}}} |\\psi_{\\text{leak}}\\rangle.\n$$\n\n\n成功概率为 $|\\langle w | \\psi_{k_{\\text{opt}}}\\rangle|^2$。计算内积：\n\n$$\n\\langle w | \\psi_{k_{\\text{opt}}}\\rangle = \\langle w | \\left( \\sqrt{1-\\epsilon^2} |w\\rangle + \\epsilon (-1)^{k_{\\text{opt}}} |\\psi_{\\text{leak}}\\rangle \\right) = \\sqrt{1-\\epsilon^2} \\langle w | w \\rangle + \\epsilon (-1)^{k_{\\text{opt}}} \\langle w | \\psi_{\\text{leak}} \\rangle.\n$$\n\n由于 $|\\psi_{\\text{leak}}\\rangle \\in \\mathcal{H}_G^\\perp$ 且 $|w\\rangle \\in \\mathcal{H}_G$，所以 $\\langle w | \\psi_{\\text{leak}} \\rangle = 0$。因此：\n\n$$\n\\langle w | \\psi_{k_{\\text{opt}}}\\rangle = \\sqrt{1-\\epsilon^2}.\n$$\n\n\n成功概率为：\n\n$$\n|\\langle w | \\psi_{k_{\\text{opt}}}\\rangle|^2 = \\left( \\sqrt{1-\\epsilon^2} \\right)^2 = 1 - \\epsilon^2.\n$$", "answer": "$$ \\boxed{1 - \\epsilon^2} $$", "id": "88215"}]}