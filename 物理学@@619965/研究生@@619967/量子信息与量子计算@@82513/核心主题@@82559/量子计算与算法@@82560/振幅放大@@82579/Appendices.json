{"hands_on_practices": [{"introduction": "Grover 搜索算法的威力源于其巧妙的几何诠释：通过在二维子空间中进行迭代旋转，将量子态逐步推向目标态。标准的算法从均匀叠加态开始，但该算法的核心原理具有更广泛的适用性。本练习 [@problem_id:45135] 挑战你将振幅放大的几何直觉应用到一个非标准场景中：初始状态不再是均匀叠加态，而是多量子比特的 Greenberger-Horne-Zeilinger (GHZ) 纠缠态。通过解决这个问题，你将深化对振幅放大几何本质的理解，而不仅仅是记忆公式。", "problem": "格罗弗搜索算法是量子计算的基石，旨在在非结构化数据库中找到一个特定的“标记”项。该算法的核心是迭代应用格罗弗算子 $G$，它会逐渐增大会被标记的量子态的振幅。\n\n单次格罗弗迭代由算子 $G = U_s U_w$ 描述，其中：\n1.  $U_w = I - 2|w\\rangle\\langle w|$ 是“神谕”算子，它会翻转标记态 $|w\\rangle$ 的符号。\n2.  $U_s = 2|\\psi_0\\rangle\\langle \\psi_0| - I$ 是“扩散”算子，它执行关于初始态 $|\\psi_0\\rangle$ 的反射。\n\n通常，该算法从所有可能状态的均匀叠加态开始。在本问题中，我们探讨一个不同的场景。考虑一个 $n$ 量子比特的量子计算机，其中 $n \\ge 2$。标记态是基态 $|w\\rangle = |0\\rangle^{\\otimes n}$。然而，初始态 $|\\psi_0\\rangle$ 不是均匀叠加态，而是 $n$ 量子比特的 Greenberger–Horne–Zeilinger (GHZ) 态：\n$$\n|\\psi_0\\rangle = \\frac{1}{\\sqrt{2}} \\left( |0\\rangle^{\\otimes n} + |1\\rangle^{\\otimes n} \\right)\n$$\n您的任务是计算在初始态 $|\\psi_0\\rangle$ 上单次应用格罗弗算子 $G$ 后，在标记态 $|w\\rangle$ 中找到系统的概率。这就是成功概率 $P_{success} = |\\langle w| G |\\psi_0\\rangle|^2$。", "solution": "该问题要求计算经过一次迭代后，改进的格罗弗搜索的成功概率。解决这个问题的关键在于使用格罗弗算法的几何解释。整个过程可以被看作是在整个希尔伯特空间的二维子空间中的一次旋转。\n\n**第 1 步：定义二维子空间**\n格罗弗算法的动力学局限于由标记态 $|w\\rangle$ 和初始态 $|\\psi_0\\rangle$ 张成的二维平面。为该平面使用一个标准正交基更为方便。我们选择标记态 $|w\\rangle$ 作为其中一个基向量。另一个基向量，我们记作 $|w^\\perp\\rangle$，是初始态 $|\\psi_0\\rangle$ 中与 $|w\\rangle$ 正交且经过适当归一化的分量。\n\n标记态为 $|w\\rangle = |0\\rangle^{\\otimes n}$。\n初始态为 $|\\psi_0\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle^{\\otimes n} + |1\\rangle^{\\otimes n}) = \\frac{1}{\\sqrt{2}}(|w\\rangle + |1\\rangle^{\\otimes n})$。\n态 $|1\\rangle^{\\otimes n}$ 与 $|w\\rangle = |0\\rangle^{\\otimes n}$ 正交，因为 $\\langle 0...0 | 1...1 \\rangle = 0$。它也经过了归一化。因此，我们可以确定 $|w^\\perp\\rangle = |1\\rangle^{\\otimes n}$。\n\n**第 2 步：在二维基中表示初始态**\n这个二维平面中的任何态都可以写成 $|w\\rangle$ 和 $|w^\\perp\\rangle$ 的线性组合。初始态 $|\\psi_0\\rangle$ 可以写成以下形式：\n$$\n|\\psi_0\\rangle = \\sin(\\theta) |w\\rangle + \\cos(\\theta) |w^\\perp\\rangle\n$$\n对于某个角度 $\\theta$。找到标记态的初始概率是 $\\sin^2(\\theta)$。\n根据我们的态：\n$$\n|\\psi_0\\rangle = \\frac{1}{\\sqrt{2}}|w\\rangle + \\frac{1}{\\sqrt{2}}|w^\\perp\\rangle\n$$\n通过比较这两种形式，我们可以确定 $\\sin(\\theta)$ 和 $\\cos(\\theta)$:\n$$\n\\sin(\\theta) = \\frac{1}{\\sqrt{2}}, \\quad \\cos(\\theta) = \\frac{1}{\\sqrt{2}}\n$$\n这给出了初始角度 $\\theta = \\frac{\\pi}{4}$。初始成功概率为 $|\\langle w|\\psi_0\\rangle|^2 = \\sin^2(\\pi/4) = 1/2$。\n\n**第 3 步：格罗弗算子的几何解释**\n格罗弗算子 $G = U_s U_w$ 对应于在 $(|w^\\perp\\rangle, |w\\rangle)$ 平面内的一次旋转。\n- 神谕算子 $U_w = I - 2|w\\rangle\\langle w|$ 是关于 $|w^\\perp\\rangle$ 轴的反射。\n- 扩散算子 $U_s = 2|\\psi_0\\rangle\\langle \\psi_0| - I$ 是关于初始态向量 $|\\psi_0\\rangle$ 的反射。\n两次反射的复合是一次旋转。旋转的角度是两个反射轴之间夹角的两倍。$|w^\\perp\\rangle$ 和 $|\\psi_0\\rangle$ 之间的夹角是 $\\theta$。因此，单次应用格罗弗算子 $G$ 会将状态向量在平面内朝向目标态 $|w\\rangle$ 旋转一个角度 $2\\theta$。\n\n**第 4 步：计算一次迭代后的状态**\n初始态 $|\\psi_0\\rangle$ 相对于 $|w^\\perp\\rangle$ 轴的角度为 $\\theta$。经过一次格罗弗迭代后，新状态 $|\\psi_1\\rangle = G|\\psi_0\\rangle$ 相对于 $|w^\\perp\\rangle$ 轴的角度将是 $\\theta + 2\\theta = 3\\theta$。\n因此，一次迭代后的状态可以写为：\n$$\n|\\psi_1\\rangle = \\sin(3\\theta) |w\\rangle + \\cos(3\\theta) |w^\\perp\\rangle\n$$\n\n**第 5 步：计算成功概率**\n一次迭代后的成功概率是状态 $|\\psi_1\\rangle$ 中标记态 $|w\\rangle$ 的振幅的模平方。\n$$\nP_{success} = |\\langle w | \\psi_1 \\rangle|^2 = \\sin^2(3\\theta)\n$$\n我们已经求得 $\\theta = \\pi/4$。代入这个值：\n$$\nP_{success} = \\sin^2\\left(3 \\cdot \\frac{\\pi}{4}\\right) = \\sin^2\\left(\\frac{3\\pi}{4}\\right)\n$$\n我们计算正弦函数的值：\n$$\n\\sin\\left(\\frac{3\\pi}{4}\\right) = \\sin\\left(\\pi - \\frac{\\pi}{4}\\right) = \\sin\\left(\\frac{\\pi}{4}\\right) = \\frac{1}{\\sqrt{2}}\n$$\n最后，我们计算概率：\n$$\nP_{success} = \\left(\\frac{1}{\\sqrt{2}}\\right)^2 = \\frac{1}{2}\n$$\n有趣的是，经过一次迭代后，找到标记态的概率保持不变。这是一个特例，因为初始角度恰好为 $\\theta=\\pi/4$。", "answer": "$$ \\boxed{\\frac{1}{2}} $$", "id": "45135"}, {"introduction": "理想化的量子算法是在一个无噪声的环境中运行的，但这与现实相去甚远。实际的量子计算机会受到各种噪声源的影响，这些噪声会降低算法的性能。本练习 [@problem_id:45082] 将引导你直面这一挑战，通过分析一个常见的噪声模型——退极化信道（depolarizing channel）——对 Grover 算法的影响。你需要运用密度矩阵（density matrix）这一关键工具来描述噪声过程，并计算出在噪声存在下单次迭代后的成功概率，从而获得在现实条件下评估量子算法性能的宝贵经验。", "problem": "考虑一个在2量子比特寄存器上的量子搜索问题，其对应于一个包含 $N=4$ 个项目的搜索空间。系统被初始化在均匀叠加态 $|s\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{x=0}^{N-1} |x\\rangle$。存在一个单一的“标记”态，记为 $|w\\rangle$。搜索是通过应用一次格罗弗算法的迭代来执行的。\n\n一次标准的格罗弗迭代由算符 $G = D O$ 描述，其中 $O$ 是神谕算符，$D$ 是扩散算符。神谕算符定义为 $O = I - 2|w\\rangle\\langle w|$，扩散算符定义为 $D = 2|s\\rangle\\langle s| - I$。\n\n在这个问题中，量子计算机受到噪声的影响。在将神谕算符 $O$ 应用于该量子态之后，但在应用扩散算符 $D$ *之前*，该2量子比特系统与环境发生相互作用。这种相互作用被建模为一个2量子比特的退极化通道 $\\mathcal{E}_p$，其对密度矩阵 $\\rho$ 的作用定义如下：\n$$\n\\mathcal{E}_p(\\rho) = (1-p) \\rho + p \\frac{I_N}{N}\n$$\n其中 $I_N$ 是作用在 $N=4$ 维希尔伯特空间上的单位算符。\n\n假设系统从纯态 $\\rho_{in} = |s\\rangle\\langle s|$ 开始，一次带噪声的格罗弗迭代按以下步骤进行：\n1. 应用神谕算符：$\\rho_1 = O \\rho_{in} O^\\dagger$。\n2. 应用退极化通道：$\\rho_2 = \\mathcal{E}_p(\\rho_1)$。\n3. 应用扩散算符：$\\rho_{out} = D \\rho_2 D^\\dagger$。\n\n在退极化通道强度为 $p = 1/10$ 的条件下，计算在最终态 $\\rho_{out}$ 中测量到标记态 $|w\\rangle$ 的概率。", "solution": "1. **初始态和算符**。当 $N=4$ 时，\n$$|s\\rangle=\\frac{1}{2}\\sum_{x=0}^3|x\\rangle,\\quad P=|w\\rangle\\langle w|$$\n$$O=I-2P,\\quad D=2|s\\rangle\\langle s|-I$$\n初始密度矩阵为 $\\rho_{in}=|s\\rangle\\langle s|$。\n\n2. **经过神谕算符作用后**：\n$$\\rho_1=O\\rho_{in}O^\\dagger=|\\psi_1\\rangle\\langle\\psi_1|$$\n其中\n$$|\\psi_1\\rangle=O|s\\rangle=\\frac{1}{2}\\left(-|w\\rangle+\\sum_{x\\neq w}|x\\rangle\\right)$$\n\n3. **强度为 $p$ 的退极化噪声**：\n$$\\rho_2=\\mathcal{E}_p(\\rho_1)=(1-p)\\rho_1+p\\frac{I_4}{4}$$\n\n4. **经过扩散算符作用后**：\n因为 $D$ 是幺正且厄米的（$D^2=I$），所以 $D\\frac{I_4}{4}D^\\dagger = \\frac{I_4}{4}$。\n$$\\rho_{out}=D\\rho_2 D^\\dagger=(1-p)D\\rho_1 D+p\\frac{I_4}{4}$$\n\n5. **测量 $|w\\rangle$ 的概率**：\n$$P_w=\\text{Tr}(P\\rho_{out})=(1-p)\\text{Tr}(P D\\rho_1 D)+p\\frac{\\text{Tr}(P)}{4}$$\n因为 $\\text{Tr}(P)=1$ 且 $D P D=|w'\\rangle\\langle w'|$（其中 $|w'\\rangle=D|w\\rangle=|s\\rangle-|w\\rangle$），我们有：\n$$\\text{Tr}(P D\\rho_1 D) = \\text{Tr}(D P D \\rho_1) = \\text{Tr}(|w'\\rangle\\langle w'|\\rho_1) = |\\langle w'|\\psi_1\\rangle|^2$$\n计算内积：\n$$\\langle w'|\\psi_1\\rangle = (\\langle s| - \\langle w|)|\\psi_1\\rangle = \\langle s|\\psi_1\\rangle - \\langle w|\\psi_1\\rangle$$\n$$\\langle s|\\psi_1\\rangle = \\langle s|O|s\\rangle = 1-2|\\langle s|w\\rangle|^2 = 1-2(\\frac{1}{2})^2 = \\frac{1}{2}$$\n$$\\langle w|\\psi_1\\rangle = \\langle w|O|s\\rangle = \\langle w|s\\rangle - 2\\langle w|w\\rangle\\langle w|s\\rangle = \\frac{1}{2} - 2(1)\\frac{1}{2} = -\\frac{1}{2}$$\n所以\n$$\\langle w'|\\psi_1\\rangle=\\frac{1}{2}-(-\\frac{1}{2})=1$$\n因此 $\\text{Tr}(P D\\rho_1 D)=1^2=1$。\n\n6. **最终结果**\n$$P_w=(1-p)\\cdot 1+p\\cdot\\frac{1}{4}=1-\\frac{3p}{4}$$\n代入 $p=\\frac{1}{10}$ 得 $P_w=1-\\frac{3}{40}=\\frac{37}{40}$。", "answer": "$$\\boxed{\\frac{37}{40}}$$", "id": "45082"}, {"introduction": "Grover 算法的每一步都经过精心设计，以确保振幅的有效放大。其中，绕初始态进行反射的扩散算符 $U_s = 2|\\psi\\rangle\\langle\\psi| - I$ 发挥着至关重要的作用。为了深刻理解其设计的精妙之处，本练习 [@problem_id:45206] 提出了一个思想实验：如果我们将标准的扩散算符替换为一个绕着与初始态正交的态 $|\\phi\\rangle$ 进行反射的算符，算法会发生什么？通过计算这个修改后算法的结果，你将洞察标准扩散算符为何是放大过程不可或缺的一环，并对算法的内在机制有更本质的认识。", "problem": "标准的Grover振幅放大算法依赖于对一个算符 $G = U_s U_\\omega$ 的迭代应用，其中 $U_\\omega$ 是一个标记目标态的神谕算符，$U_s$ 是一个执行关于初态反转的扩散算符。本问题探讨该过程的一个变体。\n\n考虑一个量子系统，其 $N$ 维希尔伯特空间由一组正交归一基 $\\{|i\\rangle\\}_{i=0}^{N-1}$ 张成。其中，有 $M$ 个态被指定为“目标”态，其中 $1 \\le M < N$。系统的初始态是所有基态的均匀叠加态：\n$$\n|\\psi\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{i=0}^{N-1} |i\\rangle\n$$\n态 $|\\psi\\rangle$ 可以表示为目标态的归一化叠加态 $|\\omega\\rangle$ 与非目标态的归一化叠加态 $|\\beta\\rangle$ 的线性组合。神谕算符 $U_\\omega$ 定义为关于与目标态正交的子空间的反射，可写作 $U_\\omega = I - 2|\\omega\\rangle\\langle\\omega|$。\n\n在本问题中，标准的扩散算符 $U_s = 2|\\psi\\rangle\\langle\\psi| - I$ 被一个修正的扩散算符 $U_\\phi = 2|\\phi\\rangle\\langle\\phi| - I$ 所取代。态 $|\\phi\\rangle$ 是一个归一化态，它位于由 $\\{|\\omega\\rangle, |\\beta\\rangle\\}$ 张成的二维平面内，并且与初态 $|\\psi\\rangle$ 正交，即 $\\langle\\phi|\\psi\\rangle=0$。\n\n计算在对初态 $|\\psi\\rangle$ 单次应用修正算符 $G' = U_\\phi U_\\omega$ 之后，测量得到目标态的概率。请将最终答案表示为含 $M$ 和 $N$ 的解析表达式。", "solution": "我们在由以下二者张成的二维子空间中进行计算：\n$$|\\omega\\rangle,\\quad|\\beta\\rangle$$\n其中\n$$|\\psi\\rangle=\\sqrt{\\frac{M}{N}}|\\omega\\rangle+\\sqrt{\\frac{N-M}{N}}|\\beta\\rangle,\\qquad\n|\\phi\\rangle=a|\\omega\\rangle+b|\\beta\\rangle,\\quad\\langle\\phi|\\psi\\rangle=0,\\;\\langle\\phi|\\phi\\rangle=1.$$\n\n1. 根据正交性和归一化条件确定 $a,b$。\n   正交性：\n   $$\\langle\\phi|\\psi\\rangle = a\\sqrt{\\frac{M}{N}}+b\\sqrt{\\frac{N-M}{N}}=0 \\;\\Longrightarrow\\; b=-a\\sqrt{\\frac{M}{N-M}}$$\n   归一化：\n   $$|a|^2+|b|^2 = a^2\\left(1+\\frac{M}{N-M}\\right) = a^2\\frac{N}{N-M}=1 \\;\\Longrightarrow\\; a=\\sqrt{\\frac{N-M}{N}},\\; b=-\\sqrt{\\frac{M}{N}}$$\n   因此\n   $$|\\phi\\rangle = \\sqrt{\\frac{N-M}{N}}|\\omega\\rangle - \\sqrt{\\frac{M}{N}}|\\beta\\rangle$$\n\n2. 将神谕算符 $U_\\omega=I-2|\\omega\\rangle\\langle\\omega|$ 应用于 $|\\psi\\rangle$：\n   $$|\\chi\\rangle = U_\\omega|\\psi\\rangle = -\\sqrt{\\frac{M}{N}}|\\omega\\rangle + \\sqrt{\\frac{N-M}{N}}|\\beta\\rangle$$\n\n3. 将修正的扩散算符 $U_\\phi=2|\\phi\\rangle\\langle\\phi|-I$ 应用于 $|\\chi\\rangle$。\n   首先计算内积\n   $$\\langle\\phi|\\chi\\rangle = \\left(\\sqrt{\\frac{N-M}{N}}\\langle\\omega| - \\sqrt{\\frac{M}{N}}\\langle\\beta|\\right) \\left(-\\sqrt{\\frac{M}{N}}|\\omega\\rangle + \\sqrt{\\frac{N-M}{N}}|\\beta\\rangle\\right) = -2\\frac{\\sqrt{M(N-M)}}{N}$$\n   然后\n   $$G'|\\psi\\rangle = U_\\phi|\\chi\\rangle = 2\\langle\\phi|\\chi\\rangle|\\phi\\rangle-|\\chi\\rangle = -4\\frac{\\sqrt{M(N-M)}}{N}|\\phi\\rangle - \\left(-\\sqrt{\\frac{M}{N}}|\\omega\\rangle + \\sqrt{\\frac{N-M}{N}}|\\beta\\rangle\\right)$$\n\n4. 代入 $|\\phi\\rangle$ 并收集 $|\\omega\\rangle$ 的系数：\n   $$C_\\omega = -4\\frac{\\sqrt{M(N-M)}}{N}\\left(\\sqrt{\\frac{N-M}{N}}\\right) + \\sqrt{\\frac{M}{N}}$$\n   $$C_\\omega = -4\\frac{\\sqrt{M}(N-M)}{N\\sqrt{N}} + \\frac{N\\sqrt{M}}{N\\sqrt{N}} = \\frac{-4(N-M)\\sqrt{M} + N\\sqrt{M}}{N\\sqrt{N}} = \\frac{(4M-3N)\\sqrt{M}}{N\\sqrt{N}}$$\n\n5. 由于迭代后的态位于 $\\{|\\omega\\rangle,|\\beta\\rangle\\}$ 平面内，所有的目标态分量都由 $|\\omega\\rangle$ 项所描述。因此，测量到目标态的概率为\n   $$P_{\\rm target} =|C_\\omega|^2 = \\frac{(4M-3N)^2 M}{N^3}$$", "answer": "$$\\boxed{\\frac{M(4M-3N)^2}{N^3}}$$", "id": "45206"}]}