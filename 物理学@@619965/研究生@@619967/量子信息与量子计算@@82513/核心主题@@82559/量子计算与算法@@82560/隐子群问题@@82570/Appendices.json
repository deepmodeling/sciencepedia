{"hands_on_practices": [{"introduction": "让我们从一个基础练习开始，以巩固您对有限阿贝尔群中隐藏子群问题（HSP）标准算法的理解。本练习 [@problem_id:155639] 聚焦于在群 $G = \\mathbb{Z}_2 \\times \\mathbb{Z}_4$ 内的一个直接计算，让您能够运用群特征标和量子傅里叶变换的核心概念来确定测量概率。掌握这类计算是解决更复杂HSP实例的第一步。", "problem": "隐藏子群问题 (HSP) 为包括 Simon 算法和 Shor 算法在内的多种量子算法提供了一个统一的框架。考虑一个有限阿贝尔群 $G$ 上的 HSP。我们给定一个函数 $f: G \\to S$（其中 $S$ 是某个有限集），该函数在一个隐藏子群 $H \\le G$ 的陪集上是常数，并在不同的陪集上取不同的值。目标是找到 $H$。\n\n求解阿贝尔 HSP 的标准量子算法按以下步骤进行：\n1.  将两个量子寄存器初始化为 $|0\\rangle|0\\rangle$。\n2.  对第一个寄存器应用量子傅里叶变换 (QFT) 以创建 $G$ 上的均匀叠加态：$\\frac{1}{\\sqrt{|G|}} \\sum_{g \\in G} |g\\rangle|0\\rangle$。\n3.  查询预言机 $U_f$，它将 $|g\\rangle|y\\rangle$ 映射到 $|g\\rangle|y \\oplus f(g)\\rangle$，得到状态 $\\frac{1}{\\sqrt{|G|}} \\sum_{g \\in G} |g\\rangle|f(g)\\rangle$。\n4.  测量第二个寄存器。如果结果是 $s_0$，第一个寄存器将坍缩到陪集 $g_0 H$ 中元素上的叠加态，对于某个 $g_0 \\in G$：$|\\psi_{g_0 H}\\rangle = \\frac{1}{\\sqrt{|H|}} \\sum_{h \\in H} |g_0 h\\rangle$。\n5.  对第一个寄存器应用群 $G$ 的 QFT，记为 $\\text{QFT}_G$。\n6.  测量第一个寄存器。结果将是特征标群 $\\widehat{G}$ 的一个元素。\n\n设群为 $G = \\mathbb{Z}_2 \\times \\mathbb{Z}_4$，其元素是序对 $(g_1, g_2)$，其中 $g_1 \\in \\{0, 1\\}$ 且 $g_2 \\in \\{0, 1, 2, 3\\}$。群运算是按分量进行加法，并分别模以各自的阶数。群 $G$ 的特征标是函数 $\\chi_j: G \\to \\mathbb{C}$，由 $j = (j_1, j_2) \\in G$ 索引，定义如下：\n$$\n\\chi_{(j_1, j_2)}((g_1, g_2)) = \\exp\\left(2\\pi i \\left(\\frac{j_1 g_1}{2} + \\frac{j_2 g_2}{4}\\right)\\right)\n$$\n假设隐藏子群是 $H = \\{(0,0), (1,2)\\}$。\n\n计算在 HSP 算法的最后一步中测量到特征标 $\\chi_{(1,1)}$ 的概率。", "solution": "1. 在测量第二个寄存器并得到某个陪集 $g_0H$ 后，第一个寄存器上的状态为 $|\\psi_{g_0 H}\\rangle = \\frac{1}{\\sqrt{|H|}} \\sum_{h \\in H} |g_0 h\\rangle$。对其应用QFT后，状态变为：\n\n$$\n\\text{QFT}_G |\\psi_{g_0 H}\\rangle = \\frac{1}{\\sqrt{|H|}} \\text{QFT}_G \\left(\\sum_{h\\in H}|g_0h\\rangle\\right) = \\frac{1}{\\sqrt{|H||G|}} \\sum_{j\\in\\widehat G}\\left(\\sum_{h\\in H}\\chi_j(g_0h)\\right)|j\\rangle\n$$\n\n2. 测量到特征标 $\\chi_j$ 的概率是该结果幅值的模平方：\n\n$$\nP(j) = \\left| \\frac{1}{\\sqrt{|H||G|}} \\sum_{h\\in H}\\chi_j(g_0h) \\right|^2 = \\frac{1}{|G||H|}\\left|\\sum_{h\\in H}\\chi_j(g_0h)\\right|^2\n$$\n\n由于 $\\chi_j(g_0h) = \\chi_j(g_0)\\chi_j(h)$ 且 $|\\chi_j(g_0)|=1$，概率可以简化为：\n\n$$\nP(j) = \\frac{1}{|G||H|}\\left|\\chi_j(g_0)\\right|^2\\left|\\sum_{h\\in H}\\chi_j(h)\\right|^2 = \\frac{1}{|G||H|}\\left|\\sum_{h\\in H}\\chi_j(h)\\right|^2\n$$\n\n这表明概率与选择了哪个陪集 $g_0H$ 无关。\n\n3. 在本题中，$|G|=|\\mathbb{Z}_2 \\times \\mathbb{Z}_4| = 2 \\times 4 = 8$，$|H|=2$，且 $H=\\{(0,0),(1,2)\\}$。我们计算 $j=(1,1)$ 时的和：\n\n$$\n\\sum_{h\\in H}\\chi_{(1,1)}(h) = \\chi_{(1,1)}(0,0) + \\chi_{(1,1)}(1,2)\n$$\n\n使用特征标的定义：\n$\\chi_{(1,1)}(0,0) = \\exp\\left(2\\pi i \\left(\\frac{1 \\cdot 0}{2} + \\frac{1 \\cdot 0}{4}\\right)\\right) = e^0 = 1$\n$\\chi_{(1,1)}(1,2) = \\exp\\left(2\\pi i \\left(\\frac{1 \\cdot 1}{2} + \\frac{1 \\cdot 2}{4}\\right)\\right) = \\exp\\left(2\\pi i \\left(\\frac{1}{2} + \\frac{1}{2}\\right)\\right) = e^{2\\pi i} = 1$\n\n所以，和为 $1+1=2$。\n\n4. 因此，测量到 $\\chi_{(1,1)}$ 的概率是：\n\n$$\nP(\\chi_{(1,1)}) = \\frac{1}{8 \\cdot 2} |2|^2 = \\frac{4}{16} = \\frac{1}{4}\n$$", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "155639"}, {"introduction": "从阿贝尔群转向非阿贝尔群，需要我们运用表示论的语言。本练习 [@problem_id:155600] 探讨了在海森堡群 $H_3(\\mathbb{F}_p)$ 上的HSP，这是一个典型的非阿贝尔群例子。通过比较隐藏子群分别是正规子群（中心）与非正规子群时的算法结果，您将深刻洞察一个子群的代数性质如何显著影响量子算法的测量结果。", "problem": "设 $p$ 为一个素数。有限域 $\\mathbb{F}_p$ 上的海森堡群 $G = H_3(\\mathbb{F}_p)$ 是由以下形式的 $3 \\times 3$ 上三角矩阵构成的集合：\n$$\ng(x,y,z) = \\begin{pmatrix} 1 & x & z \\\\ 0 & 1 & y \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n其中 $x, y, z \\in \\mathbb{F}_p$。群运算是矩阵乘法，其复合律为：\n$$\ng(x_1, y_1, z_1) g(x_2, y_2, z_2) = g(x_1+x_2, y_1+y_2, z_1+z_2+x_1y_2)\n$$\n该群的阶为 $|G|=p^3$。群的中心为 $Z(G) = \\{g(0,0,z) | z \\in \\mathbb{F}_p\\}$。\n\n$H_3(\\mathbb{F}_p)$ 的不可约表示 (irreps) 由 $p^2$ 个 1 维不可约表示和 $p-1$ 个 $p$ 维不可约表示组成。我们将 $p$ 维不可约表示记为 $\\rho_c$，其中 $c \\in \\mathbb{F}_p^* = \\{1, 2, \\dots, p-1\\}$。不可约表示 $\\rho_c$ 的特征标 $\\chi_c = \\text{Tr}(\\rho_c)$ 具有以下性质：\n1. 对于任何不在中心内的元素 $g(x,y,z)$（即 $x$ 或 $y$ 非零），其特征标为 $\\chi_c(g(x,y,z)) = 0$。\n2. 对于任何在中心内的元素 $g(0,0,z)$，其特征标为 $\\chi_c(g(0,0,z)) = p \\cdot \\exp(2\\pi i c z / p)$。\n\n在针对具有隐藏子群 $H$ 的群 $G$ 的隐藏子群问题 (HSP) 的标准量子算法中，在量子傅里叶变换之后，我们会对表示寄存器进行测量。我们定义一个与测量结果相关的量 $Q_H(\\rho)$，其公式如下：\n$$\nQ_H(\\rho) = \\frac{d_\\rho}{|G|} \\sum_{h \\in H} \\chi_\\rho(h)\n$$\n其中 $d_\\rho$ 是不可约表示 $\\rho$ 的维度，$\\chi_\\rho$ 是其特征标，求和遍及隐藏子群 $H$ 的所有元素。\n\n考虑在 $G=H_3(\\mathbb{F}_p)$ 上的HSP，针对一个特定的 $p$ 维不可约表示 $\\rho_{c_0}$，其中 $c_0$ 是 $\\mathbb{F}_p$ 的一个固定的非零元素。我们将分析两种不同的隐藏子群。\n\n情形 A：隐藏子群是中心，$H_A = Z(G) = \\{g(0,0,z) | z \\in \\mathbb{F}_p\\}$。\n情形 B：隐藏子群是 $H_B = \\{g(k,0,0) | k \\in \\mathbb{F}_p\\}$。这是一个阶为 $p$ 的非正规子群。\n\n设 $Q_A(\\rho_{c_0})$ 和 $Q_B(\\rho_{c_0})$ 分别为情形 A 和情形 B 中此量的值。计算比率 $R = \\frac{Q_A(\\rho_{c_0})}{Q_B(\\rho_{c_0})}$。", "solution": "我们使用给定的公式 \n$$Q_H(\\rho)=\\frac{d_\\rho}{|G|}\\sum_{h\\in H}\\chi_\\rho(h),$$\n其中 $d_{\\rho_{c_0}}=p$， $|G|=p^3$，以及特征标数据：\n- 若 $(x,y)\\neq(0,0)$，则 $\\chi_{c_0}(g(x,y,z))=0$。\n- $\\chi_{c_0}(g(0,0,z))=p\\,e^{2\\pi i c_0 z/p}$。\n\n**情形 A**：$H_A=Z(G)=\\{g(0,0,z)\\,\\mid\\,z\\in\\mathbb{F}_p\\}$。此子群中所有元素都在中心内。则\n\n$$\n\\sum_{h\\in H_A}\\chi_{c_0}(h)\n=\\sum_{z\\in\\mathbb{F}_p}\\chi_{c_0}(g(0,0,z))\n=\\sum_{z=0}^{p-1}p\\,e^{2\\pi i c_0 z/p}\n=p\\sum_{z=0}^{p-1}\\left(e^{2\\pi i c_0 /p}\\right)^z\n$$\n\n这是一个几何级数求和。因为 $p$ 是素数且 $c_0 \\in \\{1, \\dots, p-1\\}$，所以公比 $e^{2\\pi i c_0/p} \\neq 1$。因此，和为0。\n$$\n\\sum_{h\\in H_A}\\chi_{c_0}(h) = 0\n$$\n\n因此\n$$\nQ_A(\\rho_{c_0})\n=\\frac{p}{p^3}\\cdot0\n=0.\n$$\n\n**情形 B**：$H_B=\\{g(k,0,0)\\,\\mid\\,k\\in\\mathbb{F}_p\\}$。该子群的元素为 $g(0,0,0), g(1,0,0), \\dots, g(p-1,0,0)$。\n其中，只有当 $k=0$ 时，元素 $g(0,0,0)$ 在中心内。所有其他元素 $g(k,0,0)$ (其中 $k\\neq 0$) 都不在中心内。\n于是\n\n$$\n\\sum_{h\\in H_B}\\chi_{c_0}(h)\n= \\chi_{c_0}(g(0,0,0)) + \\sum_{k=1}^{p-1} \\chi_{c_0}(g(k,0,0))\n$$\n\n根据给定的特征标性质：\n- $\\chi_{c_0}(g(0,0,0)) = p \\cdot e^{2\\pi i c_0 \\cdot 0 / p} = p$。\n- 对于 $k \\in \\{1, \\dots, p-1\\}$，元素 $g(k,0,0)$ 不在中心内，因此 $\\chi_{c_0}(g(k,0,0))=0$。\n\n所以，和为\n$$\n\\sum_{h\\in H_B}\\chi_{c_0}(h) = p + \\sum_{k=1}^{p-1} 0 = p.\n$$\n\n因此\n$$\nQ_B(\\rho_{c_0})\n=\\frac{p}{p^3}\\cdot p\n=\\frac{p^2}{p^3} = \\frac1p.\n$$\n\n\n**比率**\n所以该比率为\n$$\nR=\\frac{Q_A(\\rho_{c_0})}{Q_B(\\rho_{c_0})}\n=\\frac{0}{1/p}\n=0.\n$$", "answer": "$$\\boxed{0}$$", "id": "155600"}, {"introduction": "理想的量子算法在无噪声的环境中运行，但实际的实现总是会受到误差的干扰。本练习 [@problem_id:155730] 探究了一种常见的噪声模型对Simon算法（HSP框架的一个经典应用）的影响。通过分析一个导致退相干的错误预言机，您将学习使用密度矩阵来计算噪声如何影响算法的成功概率，从而在理想理论与实际情况之间架起一座桥梁。", "problem": "在 Simon 的问题中，一个预言机提供了对函数 $f: \\{0,1\\}^n \\to \\{0,1\\}^n$ 的访问。问题承诺存在一个秘密的非零字符串 $s \\in \\{0,1\\}^n \\setminus \\{0^n\\}$，使得对于任意 $x, y \\in \\{0,1\\}^n$，我们有 $f(x)=f(y)$ 当且仅当 $x=y \\oplus s$，其中 $\\oplus$ 表示按位异或加法。目标是找到 $s$。\n\n解决此问题的量子算法涉及两个 $n$ 量子比特寄存器，其步骤如下：\n1. 将寄存器初始化到状态 $|0\\rangle^{\\otimes n}|0\\rangle^{\\otimes n}$。\n2. 对第一个（输入）寄存器应用阿达马变换 $H^{\\otimes n}$。\n3. 查询一个量子预言机 $U_f$，它将 $|x\\rangle|y\\rangle$ 映射到 $|x\\rangle|y \\oplus f(x)\\rangle$。\n4. 对第一个寄存器再次应用阿达马变换 $H^{\\otimes n}$。\n5. 在计算基下测量第一个寄存器，得到一个结果 $y \\in \\{0,1\\}^n$。\n\n在理想的、无噪声的执行中，任何测量结果 $y$ 都必须满足正交条件 $s \\cdot y \\equiv \\sum_{i=1}^n s_i y_i \\pmod 2 = 0$。\n\n现在，考虑该算法的一个含噪声版本。预言机是有故障的：预言机调用以概率 $p$ 失效。一次失效事件会导致*整个系统*（两个寄存器）的量子态完全退相干到最大混合态，其密度算符为 $\\rho_{\\text{fail}} = \\frac{1}{2^{2n}}I_{2n}$，其中 $I_{2n}$ 是 $2n$ 量子比特希尔伯特空间上的单位算符。预言机以概率 $1-p$ 完美地作为 $U_f$ 运行。在这个可能出错的预言机步骤之后，算法继续执行上述的第 4 步和第 5 步。\n\n测量得到与隐藏字符串 $s$ 正交的结果向量 $y$ 的总概率是多少？", "solution": "该算法有两种互斥的情况：预言机正常工作（概率为 $1-p$）或失效（概率为 $p$）。总概率是这两种情况概率的加权和。\n\n**情况 1：预言机正常工作（概率为 $1-p$）**\n- 在理想情况下，算法的标准分析表明，第 5 步测量的结果 $y$ 总是满足正交条件 $s \\cdot y \\equiv 0 \\pmod 2$。\n- 这是因为第 4 步之后，只有那些满足 $s \\cdot y \\equiv 0 \\pmod 2$ 的基态 $|y\\rangle$ 的振幅才不为零。\n- 因此，在这种情况下，测量到与 $s$ 正交的 $y$ 的概率是 1。\n\n**情况 2：预言机失效（概率为 $p$）**\n- 在第 3 步之后，系统的状态由密度算符描述：\n$$\n\\rho_{\\text{fail}} = \\frac{I_{2n}}{2^{2n}}\n$$\n其中 $I_{2n}$ 是 $2n$ 量子比特希尔伯特空间上的单位算符。\n- 第 4 步对第一个寄存器应用 $H^{\\otimes n}$。这个操作由酉算符 $U_H = H^{\\otimes n} \\otimes I^{\\otimes n}$ 描述。变换后的状态是：\n$$\n\\rho' = U_H \\rho_{\\text{fail}} U_H^\\dagger = U_H \\frac{I_{2n}}{2^{2n}} U_H^\\dagger\n$$\n由于单位算符与任何酉算符都可交换（$U_H I_{2n} = I_{2n} U_H$），我们有 $U_H I_{2n} U_H^\\dagger = I_{2n} U_H U_H^\\dagger = I_{2n}$。因此，状态不变：\n$$\n\\rho' = \\rho_{\\text{fail}} = \\frac{I_{2n}}{2^{2n}}\n$$\n- 第 5 步测量第一个寄存器。第一个寄存器的约化密度矩阵是通过对第二个寄存器求偏迹得到的，结果是 $\\text{Tr}_2(\\rho') = \\frac{I_n}{2^n}$，其中 $I_n$ 是 $n$ 量子比特空间上的单位算符。\n- 这意味着第一个寄存器处于最大混合态。测量任何特定结果 $y \\in \\{0,1\\}^n$ 的概率都是 $\\frac{1}{2^n}$。\n- 我们关心的是测量到一个满足 $s \\cdot y = 0$ 的 $y$ 的概率。由于 $s$ 是非零向量，方程 $s \\cdot y = 0$ 定义了 $\\{0,1\\}^n$ 空间中的一个维度为 $n-1$ 的超平面（子空间）。这个子空间包含 $2^{n-1}$ 个向量。\n- 因此，在预言机失效的情况下，测量到与 $s$ 正交的 $y$ 的概率是（满足条件的向量数）$\\times$（每个向量的概率）：\n$$\nP(\\text{正交} | \\text{失效}) = 2^{n-1} \\times \\frac{1}{2^n} = \\frac{1}{2}\n$$\n\n**总概率**\n总概率是两种情况的加权和：\n$$\nP(\\text{总}) = P(\\text{正交} | \\text{正常}) \\cdot P(\\text{正常}) + P(\\text{正交} | \\text{失效}) \\cdot P(\\text{失效})\n$$\n$$\nP(\\text{总}) = 1 \\cdot (1-p) + \\frac{1}{2} \\cdot p = 1 - p + \\frac{p}{2} = 1 - \\frac{p}{2}\n$$", "answer": "$$ \\boxed{1 - \\frac{p}{2}} $$", "id": "155730"}]}