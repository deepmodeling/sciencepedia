{"hands_on_practices": [{"introduction": "这第一个练习是一项基础性训练，旨在巩固您对量子傅里叶变换 (Quantum Fourier Transform, QFT) 核心定义的理解。我们将 QFT 应用于一个标准的多体纠缠态——W 态 [@problem_id:167266]。这个练习将帮助您熟练掌握 QFT 如何作用于叠加态，以及输入态中各项的相位如何通过干涉，共同塑造出复杂的输出结果。", "problem": "在量子计算中，量子傅里叶变换（QFT）是作用于量子比特的线性变换，是离散傅里叶变换的量子对应物。对于一个由$n$个量子比特组成的量子系统，其计算基态表示为$|j\\rangle$，其中$j$是一个整数，范围在$0 \\le j \\le 2^n - 1$之间。$n$量子比特量子傅里叶变换（记为$U_{\\text{QFT}}$）作用于基态$|j\\rangle$的定义如下：\n$$ U_{\\text{QFT}}|j\\rangle = \\frac{1}{\\sqrt{2^n}} \\sum_{k=0}^{2^n-1} \\exp\\left(\\frac{2\\pi i j k}{2^n}\\right) |k\\rangle $$\n此处，右矢与其二进制表示相对应，例如，当$n=3$时，$|1\\rangle \\equiv |001\\rangle$ 且 $|6\\rangle \\equiv |110\\rangle$。\n\n另一个重要的多体纠缠态是$n$量子比特的W态，它是所有只有一个量子比特处于$|1\\rangle$态而其余量子比特处于$|0\\rangle$态的基态的均匀叠加。当$n=3$时，W态为：\n$$ |W_3\\rangle = \\frac{1}{\\sqrt{3}} \\left( |001\\rangle + |010\\rangle + |100\\rangle \\right) $$\n\n考虑一个初始制备于$|W_3\\rangle$态的3量子比特量子寄存器。随后，将3量子比特量子傅里叶变换作用于该寄存器。变换之后，在计算基下对所有三个量子比特进行测量。\n\n计算测量结果为$|111\\rangle$态的概率。", "solution": "初始态是3量子比特的W态：\n\n$$\n|W_3\\rangle = \\frac{1}{\\sqrt{3}} \\left( |001\\rangle + |010\\rangle + |100\\rangle \\right)\n$$\n\n用十进制表示， $|001\\rangle = |1\\rangle$，$|010\\rangle = |2\\rangle$，以及 $|100\\rangle = |4\\rangle$，所以：\n\n$$\n|W_3\\rangle = \\frac{1}{\\sqrt{3}} \\left( |1\\rangle + |2\\rangle + |4\\rangle \\right)\n$$\n\n\n3量子比特量子傅里叶变换（QFT）作用于基态$|j\\rangle$的形式如下：\n\n$$\nU_{\\text{QFT}} |j\\rangle = \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} \\exp\\left( \\frac{2\\pi i j k}{8} \\right) |k\\rangle\n$$\n\n\n根据线性性质，将$U_{\\text{QFT}}$作用于$|W_3\\rangle$得到：\n\n$$\nU_{\\text{QFT}} |W_3\\rangle = \\frac{1}{\\sqrt{3}} \\left( U_{\\text{QFT}} |1\\rangle + U_{\\text{QFT}} |2\\rangle + U_{\\text{QFT}} |4\\rangle \\right)\n$$\n\n\n分别计算每一项：\n- 对于 $|j=1\\rangle$：\n  \n$$\n  U_{\\text{QFT}} |1\\rangle = \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} \\exp\\left( \\frac{2\\pi i \\cdot 1 \\cdot k}{8} \\right) |k\\rangle = \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} \\omega^k |k\\rangle\n  $$\n\n  其中 $\\omega = \\exp(2\\pi i / 8) = \\exp(i\\pi/4)$。\n- 对于 $|j=2\\rangle$：\n  \n$$\n  U_{\\text{QFT}} |2\\rangle = \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} \\exp\\left( \\frac{2\\pi i \\cdot 2 \\cdot k}{8} \\right) |k\\rangle = \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} \\exp\\left( \\frac{2\\pi i k}{4} \\right) |k\\rangle = \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} \\phi^k |k\\rangle\n  $$\n\n  其中 $\\phi = \\exp(i\\pi/2) = i$。\n- 对于 $|j=4\\rangle$：\n  \n$$\n  U_{\\text{QFT}} |4\\rangle = \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} \\exp\\left( \\frac{2\\pi i \\cdot 4 \\cdot k}{8} \\right) |k\\rangle = \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} \\exp\\left( i\\pi k \\right) |k\\rangle = \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} (-1)^k |k\\rangle\n  $$\n\n\n经过QFT变换后的态为：\n\n$$\nU_{\\text{QFT}} |W_3\\rangle = \\frac{1}{\\sqrt{3}} \\left( \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} \\omega^k |k\\rangle + \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} \\phi^k |k\\rangle + \\frac{1}{\\sqrt{8}} \\sum_{k=0}^{7} (-1)^k |k\\rangle \\right) = \\frac{1}{\\sqrt{24}} \\sum_{k=0}^{7} \\left( \\omega^k + \\phi^k + (-1)^k \\right) |k\\rangle\n$$\n\n\n态$|111\\rangle$对应于$k=7$。$|7\\rangle$的系数为：\n\n$$\nc_7 = \\frac{1}{\\sqrt{24}} \\left( \\omega^7 + \\phi^7 + (-1)^7 \\right)\n$$\n\n\n计算每一项：\n- $\\omega^7 = \\exp(14\\pi i / 8) = \\exp(7\\pi i / 4) = \\cos(7\\pi/4) + i \\sin(7\\pi/4) = \\frac{\\sqrt{2}}{2} - i \\frac{\\sqrt{2}}{2} = \\frac{1}{\\sqrt{2}} (1 - i)$\n- $\\phi^7 = i^7 = i^{4+3} = i^3 = -i$\n- $(-1)^7 = -1$\n\n所以：\n\n$$\nc_7 = \\frac{1}{\\sqrt{24}} \\left( \\frac{1}{\\sqrt{2}} (1 - i) - i - 1 \\right) = \\frac{1}{\\sqrt{24}} \\left( \\frac{1}{\\sqrt{2}} - 1 - i \\left( \\frac{1}{\\sqrt{2}} + 1 \\right) \\right)\n$$\n\n\n测量得到$|111\\rangle$的概率是$|c_7|^2$：\n\n$$\n|c_7|^2 = \\frac{1}{24} \\left| \\frac{1}{\\sqrt{2}} - 1 - i \\left( \\frac{1}{\\sqrt{2}} + 1 \\right) \\right|^2 = \\frac{1}{24} \\left[ \\left( \\frac{1}{\\sqrt{2}} - 1 \\right)^2 + \\left( \\frac{1}{\\sqrt{2}} + 1 \\right)^2 \\right]\n$$\n\n\n计算平方项：\n\n$$\n\\left( \\frac{1}{\\sqrt{2}} - 1 \\right)^2 = \\left( \\frac{1}{\\sqrt{2}} \\right)^2 - 2 \\cdot \\frac{1}{\\sqrt{2}} \\cdot 1 + 1^2 = \\frac{1}{2} - \\sqrt{2} + 1 = \\frac{3}{2} - \\sqrt{2}\n$$\n\n\n$$\n\\left( \\frac{1}{\\sqrt{2}} + 1 \\right)^2 = \\left( \\frac{1}{\\sqrt{2}} \\right)^2 + 2 \\cdot \\frac{1}{\\sqrt{2}} \\cdot 1 + 1^2 = \\frac{1}{2} + \\sqrt{2} + 1 = \\frac{3}{2} + \\sqrt{2}\n$$\n\n\n将平方项求和：\n\n$$\n\\left( \\frac{3}{2} - \\sqrt{2} \\right) + \\left( \\frac{3}{2} + \\sqrt{2} \\right) = 3\n$$\n\n\n因此：\n\n$$\n|c_7|^2 = \\frac{1}{24} \\cdot 3 = \\frac{3}{24} = \\frac{1}{8}\n$$\n\n\n测量得到$|111\\rangle$的概率是$\\frac{1}{8}$。", "answer": "$$ \\boxed{\\dfrac{1}{8}} $$", "id": "167266"}, {"introduction": "现在，我们将探索量子傅里叶变换最强大的特性之一：它揭示周期性的能力。这个练习 [@problem_id:167137] 将演示一个由周期性基态构成的输入态，在经过 QFT 之后，如何被变换为一个具有相应“倒易”周期性的输出态。这个原理正是诸如秀尔算法 (Shor's algorithm) 等关键量子算法的基石。", "problem": "量子傅里叶变换 (Quantum Fourier Transform, QFT) 在标准正交基 $|0\\rangle, |1\\rangle, \\dots, |N-1\\rangle$ 上的定义是一个酉变换，其对基矢的作用如下：\n$$\nQFT_N |x\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{y=0}^{N-1} e^{2\\pi i xy / N} |y\\rangle\n$$\n其中 $x \\in \\{0, 1, \\dots, N-1\\}$。对于一个 $n$ 量子比特的系统，$N=2^n$。\n\n考虑一个 4 量子比特的量子寄存器，因此 $N=2^4=16$。该系统被制备在一个初态 $|\\psi_{in}\\rangle$ 中，该初态是与集合 $S = \\{0, 4, 8, 12\\}$ 中整数对应的计算基矢的均匀叠加态。随后，对该状态应用量子傅里叶变换，得到状态 $|\\psi_{out}\\rangle = QFT_{16} |\\psi_{in}\\rangle$。\n\n从输出状态中测量出计算基矢 $|y\\rangle$ 的总概率是多少？其中整数 $y$ 满足条件 $y \\equiv 2 \\pmod 4$。", "solution": "1.  **构建初态 $|\\psi_{in}\\rangle$。**\n初态是集合 $S = \\{0, 4, 8, 12\\}$ 中各状态的均匀叠加。该集合的大小为 $|S|=4$。因此，归一化的初态为：\n$$\n|\\psi_{in}\\rangle = \\frac{1}{\\sqrt{|S|}} \\sum_{x \\in S} |x\\rangle = \\frac{1}{\\sqrt{4}} \\left( |0\\rangle + |4\\rangle + |8\\rangle + |12\\rangle \\right) = \\frac{1}{2} \\sum_{k=0}^{3} |4k\\rangle\n$$\n\n2.  **应用量子傅里叶变换。**\n我们将 $QFT_{16}$ 应用于状态 $|\\psi_{in}\\rangle$。利用 QFT 算符的线性性：\n$$\n|\\psi_{out}\\rangle = QFT_{16} |\\psi_{in}\\rangle = \\frac{1}{2} \\sum_{k=0}^{3} QFT_{16} |4k\\rangle\n$$\n现在，我们将 QFT 的定义代入每个基矢：\n$$\n|\\psi_{out}\\rangle = \\frac{1}{2} \\sum_{k=0}^{3} \\left( \\frac{1}{\\sqrt{16}} \\sum_{y=0}^{15} e^{2\\pi i (4k)y / 16} |y\\rangle \\right)\n$$\n$$\n|\\psi_{out}\\rangle = \\frac{1}{2 \\cdot 4} \\sum_{k=0}^{3} \\sum_{y=0}^{15} e^{i \\pi ky / 2} |y\\rangle\n$$\n我们可以交换求和顺序，以对每个基矢 $|y\\rangle$ 的系数进行分组：\n$$\n|\\psi_{out}\\rangle = \\frac{1}{8} \\sum_{y=0}^{15} \\left( \\sum_{k=0}^{3} e^{i \\pi ky / 2} \\right) |y\\rangle\n$$\n状态 $|\\psi_{out}\\rangle$ 可以写作 $|\\psi_{out}\\rangle = \\sum_{y=0}^{15} c_y |y\\rangle$，其中振幅 $c_y$ 为：\n$$\nc_y = \\frac{1}{8} \\sum_{k=0}^{3} \\left(e^{i \\pi y / 2}\\right)^k\n$$\n\n3.  **计算振幅 $c_y$。**\n计算 $c_y$ 的求和是一个有限几何级数 $\\sum_{k=0}^{n-1} r^k$，其中 $n=4$，公比为 $r = e^{i \\pi y / 2}$。\n该求和有两种情况：\n(a) 如果 $r=1$，则和为 $n=4$。这种情况发生在 $e^{i \\pi y / 2} = 1$ 时，这意味着 $\\frac{\\pi y}{2}$ 是 $2\\pi$ 的整数倍。所以，$\\frac{y}{4}$ 必须是一个整数。这对 $y \\in \\{0, 4, 8, 12\\}$ 成立。在这种情况下，振幅为：\n$$\nc_y = \\frac{1}{8} \\cdot 4 = \\frac{1}{2} \\quad \\text{对 } y \\in \\{0, 4, 8, 12\\}\n$$\n(b) 如果 $r \\neq 1$，则和为 $\\frac{r^n - 1}{r - 1}$。这里 $n=4$：\n$$\n\\sum_{k=0}^{3} r^k = \\frac{r^4 - 1}{r - 1} = \\frac{(e^{i \\pi y / 2})^4 - 1}{e^{i \\pi y / 2} - 1} = \\frac{e^{i 2\\pi y} - 1}{e^{i \\pi y / 2} - 1}\n$$\n因为 $y$ 是整数，所以 $e^{i 2\\pi y} = \\cos(2\\pi y) + i \\sin(2\\pi y) = 1$。分子是 $1 - 1 = 0$。由于我们处于 $r \\neq 1$ 的情况，分母不为零。因此，和为 0。\n这意味着对于所有不是 4 的倍数的 $y$，振幅为：\n$$\nc_y = 0 \\quad \\text{对 } y \\notin \\{0, 4, 8, 12\\}\n$$\n所以，输出状态只是四个基矢的叠加：\n$$\n|\\psi_{out}\\rangle = \\frac{1}{2} \\left( |0\\rangle + |4\\rangle + |8\\rangle + |12\\rangle \\right)\n$$\n\n4.  **计算所需概率。**\n问题要求测量出状态 $|y\\rangle$（其中 $y \\equiv 2 \\pmod 4$）的总概率。在 $y \\in \\{0, 1, \\dots, 15\\}$ 的范围内，满足此条件的 $y$ 值为 $2, 6, 10, 14$。\n测量到特定状态 $|y\\rangle$ 的概率是 $P(y) = |c_y|^2$。总概率是这些结果各自概率的总和：\n$$\nP_{total} = P(y=2) + P(y=6) + P(y=10) + P(y=14)\n$$\n$$\nP_{total} = |c_2|^2 + |c_6|^2 + |c_{10}|^2 + |c_{14}|^2\n$$\n根据我们在第 3 步中的分析，只有当 $y$ 是 4 的倍数时，振幅 $c_y$ 才不为零。\n集合 $\\{2, 6, 10, 14\\}$ 中没有一个值是 4 的倍数。\n因此，这些状态的振幅都为零：\n$$\nc_2 = 0, \\quad c_6 = 0, \\quad c_{10} = 0, \\quad c_{14} = 0\n$$\n将这些值代入概率表达式中：\n$$\nP_{total} = |0|^2 + |0|^2 + |0|^2 + |0|^2 = 0\n$$", "answer": "$$\n\\boxed{0}\n$$", "id": "167137"}, {"introduction": "量子傅里叶变换不仅是算法工具，它还与物理系统有着深刻的联系。最后一个练习 [@problem_id:167237] 探讨了一个具有循环对称性的系统哈密顿量，这可以类比为粒子在一个环上的运动。您将看到 QFT 如何精确地对角化此哈密顿量，从而揭示其能量本征值，将抽象的 QFT 工具与具体的量子动力学物理联系起来。", "problem": "考虑一个三量子比特系统，其计算基矢 $|j\\rangle$（其中 $j$ 是量子比特串的整数表示，$j \\in \\{0, 1, \\dots, 7\\}$）可被视为一个大小为 $N=8$ 的循环图上的格点。该系统在一个哈密顿量下演化，该哈密顿量描述了此循环上的最近邻跃迁，并具有均匀的在位能。哈密顿量由下式给出：\n$$ H = \\sum_{j=0}^{N-1} \\left( \\epsilon |j\\rangle\\langle j| + J |j\\rangle\\langle j+1 \\pmod N| + J |j\\rangle\\langle j-1 \\pmod N| \\right) $$\n其中 $N=8$，$J$ 是跃迁强度，$\\epsilon$ 是在位能。\n\n这个哈密顿量是一个循环矩阵，可通过量子傅里叶变换（QFT）对角化。$H$ 的本征矢量是傅里叶态 $|\\tilde{k}\\rangle$，对应的能量本征值由下式给出：\n$$ E_k = \\epsilon + 2J \\cos\\left(\\frac{2\\pi k}{N}\\right) $$\n其中 $k \\in \\{0, 1, \\dots, N-1\\}$。计算基矢 $|k\\rangle$ 与能量本征基（傅里叶基）$|\\tilde{k}\\rangle$ 之间的关系由逆量子傅里叶变换给出：\n$|\\tilde{k}\\rangle = U_{QFT}^\\dagger |k\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{j=0}^{N-1} e^{-2\\pi i jk/N} |j\\rangle$。\n\n如果系统被制备在初始态 $|\\psi(0)\\rangle = |1\\rangle$，求其在之后的时间 $t$ 的回归概率 $P(t) = |\\langle 1 | \\psi(t) \\rangle|^2$。将答案表示为 $t$、$J$ 和约化普朗克常数 $\\hbar$ 的函数。", "solution": "我们希望计算\n$$P(t)=\\bigl|\\langle1|e^{-iHt/\\hbar}|1\\rangle\\bigr|^2\\,. $$\n由于 $H$ 的本征值为\n$$E_k=\\epsilon+2J\\cos\\frac{2\\pi k}{N},\\quad N=8,$$ \n本征矢量为 $|\\tilde k\\rangle$，可求得振幅\n$$A(t)=\\langle1|\\psi(t)\\rangle\n=\\frac1N\\sum_{k=0}^{N-1}e^{-iE_k t/\\hbar}\n=e^{-i\\epsilon t/\\hbar}\\frac1{8}\\sum_{k=0}^{7}e^{-i\\frac{2Jt}{\\hbar}\\cos\\frac{\\pi k}{4}}\\,.$$\n全局相位在 $|A(t)|^2$ 中会消掉，因此设\n$$\\alpha=\\frac{2Jt}{\\hbar}\\,,$$ \n并计算该离散和。注意到 $\\cos\\frac{\\pi k}{4}$ 的取值\n\\{1, √2/2, 0, −√2/2, −1, −√2/2, 0, √2/2\\} 是成对出现的，可以得到\n\n$$\n\\sum_{k=0}^7e^{-i\\alpha\\cos(\\pi k/4)}\n=2\\cos\\alpha+2+4\\cos\\frac{\\alpha}{\\sqrt2}\\,.\n$$\n\n因此回归振幅为\n\n$$\nA(t)=\\frac{1}{8}\\bigl(2\\cos\\alpha+2+4\\cos\\frac{\\alpha}{\\sqrt2}\\bigr)\n=\\frac{1}{4}+\\frac{1}{4}\\cos\\alpha+\\frac12\\cos\\frac{\\alpha}{\\sqrt2},\n$$\n\n从而\n\n$$\nP(t)=\\Bigl(\\frac{1}{4}+\\frac{1}{4}\\cos\\frac{2Jt}{\\hbar}\n+\\frac12\\cos\\frac{\\sqrt2 Jt}{\\hbar}\\Bigr)^2.\n$$", "answer": "$$\\boxed{\\Bigl(\\tfrac{1+\\cos\\frac{2Jt}{\\hbar}}{4}+\\tfrac{\\cos\\frac{\\sqrt2\\,Jt}{\\hbar}}{2}\\Bigr)^2}$$", "id": "167237"}]}