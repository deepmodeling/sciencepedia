{"hands_on_practices": [{"introduction": "量子并行性的核心思想是利用量子叠加态一次性地对一个函数的所有可能输入进行求值。这个练习将通过一个基础的量子门电路，直观地展示这一概念。我们将看到，通过将输入寄存器置于叠加态，一次量子神谕（oracle）的调用就能将函数在整个定义域上的计算结果编码到一个量子态中，为后续的量子算法奠定基础 [@problem_id:125408]。", "problem": "一个4-量子比特量子系统由两个2-量子比特寄存器组成：一个输入寄存器和一个输出寄存器。该系统的状态在希尔伯特空间 $\\mathcal{H} = (\\mathbb{C}^2)^{\\otimes 2} \\otimes (\\mathbb{C}^2)^{\\otimes 2}$ 中进行描述。单个量子比特的计算基为 $\\{|0\\rangle, |1\\rangle\\}$。\n\n系统被初始化到状态 $|\\psi_{in}\\rangle = |+\\rangle^{\\otimes 2} \\otimes |0\\rangle^{\\otimes 2}$，其中 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$ 且 $|0\\rangle^{\\otimes 2} = |00\\rangle$。\n\n一个由酉算符 $U_f$ 表示的量子神谕被应用于该系统。该神谕评估经典函数 $f: \\{0,1\\}^2 \\to \\{0,1\\}^2$，定义如下：\n$$f(x_1, x_2) = (x_1, x_1 \\oplus x_2)$$\n其中 $\\oplus$ 表示模2加法（XOR）。神谕对计算基态 $|x_1 x_2\\rangle|y_1 y_2\\rangle$ 的作用由下式给出：\n$$U_f |x_1 x_2\\rangle |y_1 y_2\\rangle = |x_1 x_2\\rangle |y_1 \\oplus f_1(x_1, x_2), y_2 \\oplus f_2(x_1, x_2)\\rangle$$\n其中 $f_1$ 和 $f_2$ 是函数 $f$ 的两个分量。\n\n将神谕 $U_f$ 应用于初始态 $|\\psi_{in}\\rangle$ 后，对输出寄存器（最后两个量子比特）在计算基上进行测量。计算得到结果 $|11\\rangle$ 的概率。", "solution": "1. 初始状态为\n$$|\\psi_{in}\\rangle = |+\\rangle^{\\otimes2}\\otimes|00\\rangle\n=\\bigl(\\tfrac1{\\sqrt2}(|0\\rangle+|1\\rangle)\\bigr)^{\\otimes2}\\otimes|00\\rangle\n=\\frac1{2}\\sum_{x_1,x_2\\in\\{0,1\\}}|x_1x_2\\rangle\\otimes|00\\rangle.$$\n\n2. 神谕的作用为\n$$U_f\\,|x_1x_2\\rangle|y_1y_2\\rangle\n=|x_1x_2\\rangle\\,|y_1\\oplus f_1(x_1,x_2),\\,y_2\\oplus f_2(x_1,x_2)\\rangle,$$\n其中 $f(x_1,x_2)=(x_1,\\;x_1\\oplus x_2)$。\n\n3. 将 $U_f$ 应用于 $|\\psi_{in}\\rangle$ 得到\n$$|\\psi_{\\rm out}\\rangle\n=\\frac1{2}\\sum_{x_1,x_2}|x_1x_2\\rangle\\,|f(x_1,x_2)\\rangle.$$\n\n4. 我们测量最后两个量子比特，并希望得到结果 $|11\\rangle$。这种情况只在满足以下条件时发生：\n$$f(x_1,x_2)=(1,1)\\quad\\Longrightarrow\\quad x_1=1,\\;x_1\\oplus x_2=1\n\\;\\Rightarrow\\;x_2=0.$$\n因此，只有一项 $|10\\rangle|11\\rangle$ 有贡献，其振幅为 $1/2$。\n\n5. 在输出寄存器上得到 $|11\\rangle$ 的概率为\n$$P(11)=\\bigl|\\tfrac1{2}\\bigr|^2=\\tfrac14.$$", "answer": "$$\\boxed{\\frac14}$$", "id": "125408"}, {"introduction": "仅仅并行计算出函数的所有值是不够的，真正的量子优势来自于如何巧妙地利用干涉效应来提取我们感兴趣的全局信息。Bernstein-Vazirani 算法是展示这一点的经典范例，它能够通过一次查询确定一个秘密比特串。本练习通过引入一个有缺陷的量子神谕——它在处理某个特定输入时会“失灵”——来挑战你对算法核心机制的理解。你需要计算这种局部错误如何影响最终的全局干涉结果，从而揭示出量子并行性与量子干涉之间密不可分的关系 [@problem_id:125316]。", "problem": "Bernstein-Vazirani (BV) 算法是一种量子算法，它是量子并行性的一个经典范例。该算法解决的问题是寻找一个秘密的 $n$ 比特字符串 $s = s_{n-1}s_{n-2}...s_0$。对该秘密字符串的访问是通过一个函数预言机 $f_s: \\{0,1\\}^n \\to \\{0,1\\}$ 提供的，该预言机由按位内积 $f_s(x) = s \\cdot x \\pmod 2$ 定义。\n\n标准的BV算法使用一个量子线路，其中包含一个用于输入寄存器的 $n$ 个量子比特和一个用于输出的辅助量子比特。线路按如下步骤进行：\n1. 将 $n$ 个输入量子比特初始化为 $|0\\rangle^{\\otimes n}$，将辅助量子比特初始化为 $|1\\rangle$。\n2. 对所有 $n+1$ 个量子比特应用一个Hadamard门 ($H$)。这会将输入寄存器制备到均匀叠加态 $\\frac{1}{\\sqrt{2^n}}\\sum_{x \\in \\{0,1\\}^n}|x\\rangle$上，并将辅助量子比特制备到 $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle-|1\\rangle)$ 态上。\n3. 应用量子预言机 $U_f$，它将 $|x\\rangle|y\\rangle$ 映射到 $|x\\rangle|y \\oplus f_s(x)\\rangle$。为辅助量子比特选择 $|-\\rangle$ 态巧妙地将此预言机转变为一个相位预言机，它会对输入寄存器施加一个相位：$U_f(|x\\rangle \\otimes |-\\rangle) = (-1)^{f_s(x)}|x\\rangle \\otimes |-\\rangle$。\n4. 对输入寄存器应用一个Hadamard门 $H^{\\otimes n}$。\n5. 在计算基下测量输入寄存器。在完美执行的情况下，测量结果恰好是秘密字符串 $s$。\n\n考虑一个 3 量子比特 ($n=3$) 的BV算法实现，用于寻找秘密字符串 $s=110$。然而，该相位预言机是有缺陷的。对于单个计算基态 $|x_0\\rangle = |101\\rangle$，预言机未能施加相位，其作用等同于单位算子。对于所有其他基态 $|x\\rangle \\neq |101\\rangle$，预言机正常运行。即，有缺陷的预言机 $U_f'$ 对输入寄存器状态的作用如下：\n$$\nU_f' |x\\rangle = \\begin{cases}\n    (-1)^{s \\cdot x} |x\\rangle, & \\text{若 } x \\neq 101 \\\\\n    |x\\rangle, & \\text{若 } x = 101\n\\end{cases}\n$$\n假设算法的其余部分完美无瑕地执行，计算测量得到正确秘密字符串 $s=110$ 的概率。", "solution": "我们有 $n=3$，秘密字符串 $s=110$，且有缺陷的预言机的作用如下：\n$$\n\\alpha_x = \\begin{cases}\n(-1)^{s\\cdot x},&x\\neq x_0=101,\\\\\n1,&x=x_0.\n\\end{cases}\n$$\n1. 经过第一批Hadamard门后，输入寄存器为\n$$\n|\\psi_1\\rangle=\\frac1{\\sqrt{2^3}}\\sum_{x\\in\\{0,1\\}^3}|x\\rangle.\n$$\n2. 经过有缺陷的相位预言机后，\n$$\n|\\psi_2\\rangle=\\frac1{\\sqrt{8}}\\sum_{x}\\alpha_x|x\\rangle.\n$$\n3. 应用 $H^{\\otimes3}$ 得到振幅\n$$\nA(y)=\\langle y|\\psi_3\\rangle\n=\\frac1{2^3}\\sum_{x}\\alpha_x\\,(-1)^{x\\cdot y}.\n$$\n4. 分离出有缺陷的项 $x_0=101$:\n\n$$\n\\sum_{x}\\alpha_x(-1)^{x\\cdot y}\n=\\sum_{x}(-1)^{s\\cdot x}(-1)^{x\\cdot y}\n\\;+\\;\\bigl[1-(-1)^{s\\cdot x_0}\\bigr](-1)^{x_0\\cdot y}.\n$$\n\n第一项求和是理想BV算法的结果：\n$$\n\\sum_{x}(-1)^{s\\cdot x+x\\cdot y}\n=\\sum_{x}(-1)^{x\\cdot(s\\oplus y)}\n=2^3\\,\\delta_{y,s}.\n$$\n定义 $\\Delta=1-(-1)^{s\\cdot x_0}$。因此\n$$\nA(y)\n=\\delta_{y,s}\n\\;+\\;\\frac{\\Delta}{8}(-1)^{x_0\\cdot y}.\n$$\n5. 对于 $y=s=110$ 和 $x_0=101$，计算\n$$\ns\\cdot x_0=1\\cdot1+1\\cdot0+0\\cdot1\\equiv1\\pmod2,\n\\quad\n(-1)^{s\\cdot x_0}=-1,\n\\quad\n\\Delta=1-(-1)=2,\n$$\n和\n$$\n(-1)^{x_0\\cdot s}=(-1)^{1}=-1.\n$$\n因此\n$$\nA(s)=1+\\frac{2}{8}(-1)\n=1-\\tfrac14=\\tfrac34,\n\\qquad\nP(s)=|A(s)|^2=\\bigl(\\tfrac34\\bigr)^2=\\tfrac{9}{16}.\n$$", "answer": "$$\\boxed{\\tfrac{9}{16}}$$", "id": "125316"}, {"introduction": "理想化的量子算法是理解理论的基石，但在现实世界中，量子计算机不可避免地会受到噪声的干扰。这个练习将我们从纯态的理想模型带入到更贴近实际的混合态场景中。我们将在 Grover 搜索算法中引入一个有噪声的量子神谕，它以一定概率正确执行，也以一定概率“什么都不做”。通过使用密度矩阵和量子信道的语言，你将分析在这种非理想条件下量子并行性的表现，这对于评估量子算法在真实硬件上的鲁棒性至关重要 [@problem_id:125269]。", "problem": "考虑格罗弗 (Grover) 搜索算法，该算法旨在在一个大小为 $N$ 的无结构数据库中找到一个单一的标记项 $|w\\rangle$。该算法从均匀叠加态 $|s\\rangle = \\frac{1}{\\sqrt{N}}\\sum_{x=0}^{N-1} |x\\rangle$ 开始。\n\n格罗弗算法的一次标准迭代包括应用两个酉算符：神谕算符 $U_w = I - 2|w\\rangle\\langle w|$ 和扩散算符 $U_s = 2|s\\rangle\\langle s| - I$。\n\n在本题中，我们考虑一个有缺陷的神谕算符。该神谕算符并非直接应用酉算符 $U_w$，而是由一个量子信道 $\\mathcal{E}$ 描述：该信道以概率 $p$ 应用正确的神谕算符 $U_w$，并以概率 $1-p$ 应用单位算符 $I$。该信道对密度矩阵为 $\\rho$ 的量子态的作用由下式给出：\n$$\n\\mathcal{E}(\\rho) = p U_w \\rho U_w^\\dagger + (1-p) I \\rho I^\\dagger\n$$\n\n这个含噪声的格罗弗算法的单次迭代从一个状态 $\\rho_{in}$ 开始，应用含噪声的神谕信道 $\\mathcal{E}$ 得到 $\\rho_{mid} = \\mathcal{E}(\\rho_{in})$，然后应用（完美的）扩散算符 $U_s$ 得到最终态 $\\rho_{out} = U_s \\rho_{mid} U_s^\\dagger$。\n\n假设算法从纯态 $|s\\rangle$ 开始，请确定在这次含噪声算法的单次迭代后，测量得到标记态 $|w\\rangle$ 的概率。请将最终答案表示为概率 $p$ 和数据库大小 $N$ 的函数。", "solution": "我们在由 \n$$|w\\rangle,\\quad |w_\\perp\\rangle=\\frac{1}{\\sqrt{N-1}}\\sum_{x\\neq w}|x\\rangle$$ \n张成的二维子空间中进行计算。\n定义角 $\\theta$ 使得 \n$$\\sin\\theta=\\langle w|s\\rangle=\\frac{1}{\\sqrt{N}},\\qquad \\cos\\theta=\\sqrt{\\frac{N-1}{N}}.$$ \n因此 \n$$|s\\rangle=\\sin\\theta\\,|w\\rangle+\\cos\\theta\\,|w_\\perp\\rangle.$$\n\n1. 神谕算符作用（含噪声信道）\n   $$\\rho_{mid}=p\\;U_w|s\\rangle\\langle s|U_w+(1-p)\\;|s\\rangle\\langle s|,$$ \n   其中 $U_w$ 会反转 $|w\\rangle$ 的相位。\n\n2. 扩散（完美）\n   $$\\rho_{out}=U_s\\,\\rho_{mid}\\,U_s^\\dagger\n              =p\\,G|s\\rangle\\langle s|G^\\dagger+(1-p)|s\\rangle\\langle s|,$$ \n   其中 $G=U_sU_w$ 是标准的格罗弗迭代算符。\n\n3. 经过一次完美的格罗弗迭代后 $|w\\rangle$ 的振幅\n   $$G|s\\rangle=\\sin3\\theta\\,|w\\rangle+\\cos3\\theta\\,|w_\\perp\\rangle,\n    \\qquad \\sin3\\theta=3\\sin\\theta-4\\sin^3\\theta\n    =\\frac{3N-4}{N\\sqrt{N}}.$$\n\n4. 测量得到 $|w\\rangle$ 的概率\n   $$P_w=\\Tr\\bigl[|w\\rangle\\langle w|\\,\\rho_{out}\\bigr]\n         =p\\,\\sin^2(3\\theta)+(1-p)\\,\\sin^2\\theta\n         =p\\frac{(3N-4)^2}{N^3}+(1-p)\\frac{1}{N}.$$", "answer": "$$\\boxed{p\\frac{(3N-4)^2}{N^3}+(1-p)\\frac{1}{N}}$$", "id": "125269"}]}