{"hands_on_practices": [{"introduction": "Grover 算法的精妙之处在于其清晰的几何解释：它是在一个二维平面内进行的旋转。这个练习将这一图像推广到任意初始状态，从而巩固控制算法速度的核心几何原理。通过计算广义 Grover 算子在非均匀初始态下的旋转角度，您可以更深刻地理解算法的动力学，并为分析更复杂的搜索场景奠定基础 [@problem_id:107751]。", "id": "107751", "problem": "Grover 量子搜索算法的几何解释为理解其性能提供了一种强有力的方法。在标准算法中，量子态在一个由均匀叠加初识态 $|s\\rangle = \\frac{1}{\\sqrt{N}}\\sum_{x=0}^{N-1}|x\\rangle$ 和单个标记态 $|w\\rangle$ 所张成的二维子空间中演化。每次 Grover 迭代，即应用算符 $G$，对应于状态向量在该平面内的一次小角度旋转，使其更接近目标态 $|w\\rangle$。\n\n考虑此搜索问题的一个广义版本。希尔伯特空间的维度仍然是 $N$，并且存在一个可被预言机识别的唯一标记态 $|w\\rangle$。然而，初识态不是均匀叠加态 $|s\\rangle$，而是一个已知的、归一化的任意态 $|\\psi_{init}\\rangle$。\n\n针对此场景的广义 Grover 算符由下式给出：\n$$G = (2|\\psi_{init}\\rangle\\langle\\psi_{init}| - I)(I - 2|w\\rangle\\langle w|)$$\n其中 $I$ 是单位算符。该算符 $G$ 同样在由 $|\\psi_{init}\\rangle$ 和 $|w\\rangle$ 张成的二维子空间内起到旋转的作用。\n\n设初识态 $|\\psi_{init}\\rangle$ 在标记态 $|w\\rangle$ 方向上的振幅是已知的、实的、非负的，由交叠 $c = \\langle w | \\psi_{init} \\rangle$ 给出。假设 $0 < c < 1$，单次应用广义 Grover 算符 $G$ 所执行的旋转角 $\\Theta$ 是多少？请将您的答案表示为 $c$ 的函数。", "solution": "我们在由归一化向量 $|w\\rangle$ 和 $|\\psi_{\\rm init}\\rangle$ 张成的二维子空间中进行计算，其交叠为\n$$c=\\langle w|\\psi_{\\rm init}\\rangle,\\quad 0<c<1.$$\n\n1. 定义两个反射算符：\n$$R_w=I-2|w\\rangle\\langle w|,\\qquad R_\\psi=2|\\psi_{\\rm init}\\rangle\\langle\\psi_{\\rm init}|-I.$$\nGrover 算符是它们的乘积，\n$$G=R_\\psi\\,R_w.$$\n\n2. 在一个平面内，关于夹角为 $\\phi'$ 的两条直线进行两次反射的乘积，等效于一次角度为 $2\\phi'$ 的旋转。\n在这里，$R_w$ 是关于与 $|w\\rangle$ 正交的直线的反射，而 $R_\\psi$ 是关于由 $|\\psi_{\\rm init}\\rangle$ 张成的直线的反射。\n\n3. 两个反射轴之间的夹角是\n$$\\phi'=\\frac\\pi2-\\angle\\bigl(|\\psi_{\\rm init}\\rangle,|w\\rangle\\bigr)\n=\\frac\\pi2-\\arccos(c)\n=\\arcsin(c).$$\n\n4. 因此，每次 Grover 迭代旋转的角度为\n$$\\Theta=2\\phi'=2\\arcsin(c).$$", "answer": "$$\\boxed{2\\arcsin(c)}$$"}, {"introduction": "多项式方法是证明量子查询下界的有力工具，它将算法的查询次数与输出概率的多项式次数联系起来。本练习探讨了一个特殊场景：即使算法免费获得了关于一半数据项的“先知”信息，一个根本性的计算限制依然存在。这不仅展示了 $\\Omega(\\sqrt{N})$ 下界的稳健性，也考验了您将查询次数与算法可计算函数的多项式性质联系起来的能力 [@problem_id:107677]。", "id": "107677", "problem": "一个量子算法被设计用于在一个包含 $N$ 个项的非结构化数据库中找到一个被标记的项 $w$。该数据库由一个二进制字符串 $x = (x_1, \\dots, x_N)$ 表示，其中如果 $i=w$，则 $x_i = 1$，否则 $x_i = 0$。\n\n该搜索算法被赋予了一个特殊优势。在计算的量子部分开始之前，会选择一个大小为 $|S| = N/2$ 的随机索引子集 $S \\subset \\{1, \\dots, N\\}$，并且所有 $i \\in S$ 对应的 $x_i$ 值都会无代价地向算法揭示。然后，算法必须使用对预言机 $O_x$ 的量子查询来识别被标记的项 $w$，该预言机的作用为 $O_x|i\\rangle = (-1)^{x_i}|i\\rangle$。\n\n无论哪个项 $w$ 被标记，也无论哪个子集 $S$ 被揭示，该算法都必须以高概率（以一个大于 $1/2$ 且小于 1 的常数为界）成功。对于这样的算法，其最坏情况下的查询复杂度 $T$ 被定义为解决最困难的 $w$ 和 $S$ 组合所需的最少查询次数。\n\n对于大的 $N$，查询复杂度的这个下界按幂律 $T \\propto N^\\alpha$ 缩放。使用针对量子查询下界的多项式方法，确定指数 $\\alpha$ 的值。", "solution": "我们将量子算法在输入 $x\\in\\{0,1\\}^N$ 上的接受概率建模为一个实多线性多项式 $p(x)$，其次数至多为 $2T$ (Beals et al. ’98)。在揭示了 $|S|=N/2$ 的子集 $S$ 中所有 $i \\in S$ 对应的 $x_i$ 值之后，算法仍需要确定剩余的 $N/2$ 个未知比特中哪一个包含唯一的 1。因此，在大小为 $m=N/2$ 的未知子立方体上，该算法必须以常数（非平凡）误差近似 $m$ 个比特上的布尔或函数（$\\mathrm{OR}_m$）。\n\n众所周知，任何在所有布尔输入上以小于 $1/2$ 的误差近似 $\\mathrm{OR}_m$ 的实多项式 $q$ 都必须具有次数\n$$\\deg(q)\\;=\\;\\Omega\\bigl(\\sqrt{m}\\bigr)\\;=\\;\\Omega\\bigl(\\sqrt{N/2}\\bigr)\\;. $$\n\n由于 $p(x)$ 限制在未知比特上时模拟了这样一个近似多项式，我们得到\n$$2T\\;\\ge\\;\\deg(p)\\;\\ge\\;\\Omega\\bigl(\\sqrt{N/2}\\bigr)\\;, $$\n因此\n$$T\\;=\\;\\Omega\\bigl(\\sqrt{N}\\bigr)\\,. $$\n\n所以，在缩放关系 $T\\propto N^\\alpha$ 中的指数 $\\alpha$ 是\n$$\\alpha = \\tfrac12\\,. $$", "answer": "$$\\boxed{\\frac{1}{2}}$$"}, {"introduction": "对手方法通过量化不同输入对于量子算法的“可混淆性”来提供查询下界。本练习是该方法在奇偶性问题上的一个典型应用，要求您构造并分析一个对手矩阵，以推导出紧密的下界。这是一次深入研究决定问题量子难度的谱性质的实践，让您亲身体验该方法的核心技术和威力 [@problem_id:107575]。", "id": "107575", "problem": "一个量子算法被设计用于解决一个关于非结构化数据库的承诺问题，该数据库包含 $N=2M$ 个项目，索引从 $0$ 到 $N-1$。我们被承诺其中只有一个项目是“标记的”，该算法的目标是确定这个标记项索引的奇偶性，即计算 $x \\pmod 2$，其中 $x$ 是标记索引。\n\n该算法可以向预言机 $O_x$ 进行查询，该预言机是一个依赖于标记项 $x$ 的幺正算符。对索引 $i$ 的一次预言机查询被建模为变换 $|i\\rangle \\to (-1)^{f_x(i)}|i\\rangle$，其中 $f_x(i) = \\delta_{ix}$ 是预言机函数。因此，对于两个不同的标记项 $x$ 和 $y$，其预言机是不同的，并且它们在基态 $|x\\rangle$ 和 $|y\\rangle$ 上的作用也不同。\n\n寻找此类问题查询复杂度下界的一个强大工具是（负权重）敌手方法。计算标记项的函数 $F$ 的量子查询复杂度 $Q(F)$ 的下界由敌手量给出：\n$$ Q(F) \\ge C \\cdot \\max_{\\Gamma} \\frac{\\|\\Gamma\\|}{\\max_i \\|\\Gamma_i\\|} $$\n其中 $C$ 是一个常数，最大化是针对所有有效的敌手矩阵 $\\Gamma$ 进行的。\n\n敌手矩阵 $\\Gamma$ 是一个由可能的标记项索引的 $N \\times N$ 矩阵，其性质是：如果项目 $x$ 和 $y$ 的函数输出相同，则 $\\Gamma_{xy} = 0$。在我们的问题中，这意味着如果 $x$ 和 $y$ 的奇偶性相同，则 $\\Gamma_{xy} = 0$。矩阵 $\\Gamma_i$ 的元素定义为：如果 $x$ 和 $y$ 的预言机在查询索引 $i$ 上不同，则 $(\\Gamma_i)_{xy} = \\Gamma_{xy}$，否则 $(\\Gamma_i)_{xy}=0$。$\\|\\cdot\\|$ 表示谱范数（最大奇异值）。\n\n对于所述的奇偶性问题，考虑由下式定义的特定对称敌手矩阵 $\\Gamma$：\n$$\n\\Gamma_{xy} = \\begin{cases}\n    1 & \\text{若 } x \\text{ 与 } y \\text{ 的奇偶性不同} \\\\\n    0 & \\text{若 } x \\text{ 与 } y \\text{ 的奇偶性相同}\n\\end{cases}\n$$\n你的任务是计算对于 $\\Gamma$ 的这种特定选择下的敌手量 $V = \\frac{\\|\\Gamma\\|}{\\max_i \\|\\Gamma_i\\|}$。用 $M$ 表示你的答案。", "solution": "问题要求我们计算与大小为 $N=2M$ 的数据库上的奇偶性问题相关的特定敌手矩阵 $\\Gamma$ 的量 $V = \\frac{\\|\\Gamma\\|}{\\max_i \\|\\Gamma_i\\|}$。\n\n**步骤 1：计算 $\\Gamma$ 的谱范数**\n\n索引集合为 $\\{0, 1, \\dots, 2M-1\\}$。其中有 $M$ 个偶数索引 $\\{0, 2, \\dots, 2M-2\\}$ 和 $M$ 个奇数索引 $\\{1, 3, \\dots, 2M-1\\}$。我们对矩阵 $\\Gamma$ 的索引进行排序，使得所有偶数索引在前，所有奇数索引在后。通过这种排序，$\\Gamma$ 呈现为分块矩阵形式。\n\n如果一个索引是偶数而另一个是奇数，则元素 $\\Gamma_{xy}$ 为 1，否则为 0。因此，对应于（偶，偶）和（奇，奇）的分块是零矩阵。对应于（偶，奇）和（奇，偶）的分块是全 1 矩阵。\n令 $J_M$ 为 $M \\times M$ 的全 1 矩阵。那么 $\\Gamma$ 可以写成：\n$$\n\\Gamma = \\begin{pmatrix} 0_{M} & J_M \\\\ J_M & 0_{M} \\end{pmatrix}\n$$\n其中 $0_M$ 是 $M \\times M$ 的零矩阵。\n\n为了求谱范数 $\\|\\Gamma\\|$，我们求其最大特征值的绝对值（因为 $\\Gamma$ 是对称的）。设 $\\lambda$ 是 $\\Gamma$ 的一个特征值，其特征向量为 $v = \\begin{pmatrix} v_e \\\\ v_o \\end{pmatrix}$，其中 $v_e, v_o \\in \\mathbb{C}^M$。特征值方程 $\\Gamma v = \\lambda v$ 给出：\n$$\n\\begin{pmatrix} 0_{M} & J_M \\\\ J_M & 0_{M} \\end{pmatrix} \\begin{pmatrix} v_e \\\\ v_o \\end{pmatrix} = \\lambda \\begin{pmatrix} v_e \\\\ v_o \\end{pmatrix}\n$$\n这产生了一个由两个方程组成的方程组：\n1. $J_M v_o = \\lambda v_e$\n2. $J_M v_e = \\lambda v_o$\n\n如果 $\\lambda=0$，这是一个有效的特征值。如果 $\\lambda \\ne 0$，我们可以将 (2) 代入 (1)：\n$J_M (\\frac{1}{\\lambda} J_M v_e) = \\lambda v_e \\implies J_M^2 v_e = \\lambda^2 v_e$。\n这意味着 $\\lambda^2$ 必须是 $J_M^2$ 的一个特征值。矩阵 $J_M$ 的秩为 1，其迹为 $M$。它的特征值为 $M$（重数为 1，特征向量为 $(1,..,1)^T$）和 $0$（重数为 $M-1$）。$J_M^2$ 的特征值是 $J_M$ 特征值的平方，所以它们是 $M^2$（重数为 1）和 $0$（重数为 $M-1$）。\n\n因此，$\\lambda^2$ 可能是 $M^2$ 或 $0$。\n由于我们假设了 $\\lambda \\neq 0$，我们得到 $\\lambda^2 = M^2$，这给出 $\\lambda = \\pm M$。\n因此，$\\Gamma$ 的特征值为 $M, -M$ 和 $0$。谱范数是这些特征值绝对值的最大值。\n$$\n\\|\\Gamma\\| = M\n$$\n\n**步骤 2：计算 $\\Gamma_i$ 的谱范数**\n\n矩阵 $\\Gamma_i$ 定义为：如果 $x$ 和 $y$ 的预言机在索引 $i$ 上不同，则 $(\\Gamma_i)_{xy} = \\Gamma_{xy}$，否则为 0。对于相位预言机 $O_x|i\\rangle = (-1)^{\\delta_{ix}}|i\\rangle$，预言机 $O_x$ 和 $O_y$ 在索引 $i$ 上不同，当且仅当 $(-1)^{\\delta_{ix}} \\ne (-1)^{\\delta_{iy}}$，这意味着 $\\delta_{ix} \\ne \\delta_{iy}$。给定 $x \\ne y$，这发生当且仅当 $x=i$ 或 $y=i$。\n\n所以，$(\\Gamma_i)_{xy}$ 非零，当且仅当 $\\Gamma_{xy} \\neq 0$ 且 $x=i$ 或 $y=i$。\n\n我们固定一个查询索引 $i \\in \\{0, \\dots, N-1\\}$。$\\Gamma_i$ 的结构取决于 $i$ 的奇偶性。\n\n情况 1：$i$ 是偶数。\n让我们使用与之前相同的分块结构（偶，奇）。不失一般性地，我们假设 $i$ 是我们排序中的第一个偶数索引。\n$\\Gamma_i$ 的非零元素是：\n- 对于所有奇数 $y$，$(\\Gamma_i)_{i,y} = \\Gamma_{i,y} = 1$。\n- 对于所有奇数 $x$，$(\\Gamma_i)_{x,i} = \\Gamma_{x,i} = 1$。\n由于 $i$ 是偶数，如果 $x,y$ 是偶数，则涉及 $i$ 的所有其他元素将有 $\\Gamma_{iy}=0$ 或 $\\Gamma_{xi}=0$。根据 $\\Gamma_i$ 的定义，所有不涉及 $i$ 的元素都为零。\n\n在分块矩阵形式中，$\\Gamma_i$ 将是：\n$$\n\\Gamma_i = \\begin{pmatrix} 0_{M} & B \\\\ B^T & 0_{M} \\end{pmatrix}\n$$\n矩阵 $B$ 对应于（偶数行，奇数列）分块。元素 $B_{kl}$ 对应于 $(\\Gamma_i)_{e_k, o_l}$，其中 $e_k$ 是第 $k$ 个偶数索引，$o_l$ 是第 $l$ 个奇数索引。该元素非零当且仅当 $e_k=i$ 或 $o_l=i$。由于 $i$ 是偶数，我们必须有 $e_k=i$。由于我们将偶数索引排序为 $i=e_1$，所以只有 $B$ 的第一行是非零的。\n对于 $k=1$, $B_{1l} = (\\Gamma_i)_{i, o_l} = \\Gamma_{i, o_l} = 1$ 对所有 $l=1,\\dots,M$ 成立。\n所以，$B$ 是一个 $M \\times M$ 矩阵，其第一行为全 1，其他所有行为零。\n$B = e_1 (1, 1, \\dots, 1) = e_1 \\mathbf{1}^T$，其中 $e_1 = (1, 0, \\dots, 0)^T$ 且 $\\mathbf{1} = (1, 1, \\dots, 1)^T$。\n\n谱范数 $\\|\\Gamma_i\\|$ 是 $\\Gamma_i$ 的最大奇异值，也就是 $\\Gamma_i^T \\Gamma_i$ 最大特征值的平方根。由于 $\\Gamma_i$ 是对称的，这等于 $\\sqrt{\\|\\Gamma_i^2\\|} = \\|\\Gamma_i\\|$。\n$$\n\\Gamma_i^2 = \\begin{pmatrix} 0_{M} & B \\\\ B^T & 0_{M} \\end{pmatrix} \\begin{pmatrix} 0_{M} & B \\\\ B^T & 0_{M} \\end{pmatrix} = \\begin{pmatrix} B B^T & 0_{M} \\\\ 0_{M} & B^T B \\end{pmatrix}\n$$\n我们需要求 $B B^T$ 和 $B^T B$ 的特征值。\n$B = e_1 \\mathbf{1}^T$.\n$B B^T = (e_1 \\mathbf{1}^T)(\\mathbf{1} e_1^T) = e_1 (\\mathbf{1}^T \\mathbf{1}) e_1^T = e_1 (M) e_1^T = M (e_1 e_1^T)$.\n矩阵 $e_1 e_1^T$ 在 (1,1) 位置为 1，其他位置为零。因此，$B B^T$ 在 (1,1) 位置为 $M$，其他位置为零。其特征值为 $M$（重数为 1）和 $0$（重数为 $M-1$）。\n\n$B^T B = (\\mathbf{1} e_1^T)(e_1 \\mathbf{1}^T) = \\mathbf{1} (e_1^T e_1) \\mathbf{1}^T = \\mathbf{1} (1) \\mathbf{1}^T = \\mathbf{1}\\mathbf{1}^T = J_M$.\n$J_M$ 的特征值是 $M$（重数为 1）和 $0$（重数为 $M-1$）。\n\n$\\Gamma_i^2$ 的特征值是 $B B^T$ 和 $B^T B$ 的特征值的集合。它们分别是 $\\{M, 0, \\dots, 0\\}$ 和 $\\{M, 0, \\dots, 0\\}$。所以 $\\Gamma_i^2$ 的特征值是 $M$（重数为 2）和 $0$（重数为 $2M-2$）。\n$\\Gamma_i^2$ 的最大特征值是 $M$。$\\Gamma_i$ 的谱范数是 $\\Gamma_i^2$ 谱范数的平方根。\n$\\|\\Gamma_i\\| = \\sqrt{\\|\\Gamma_i^2\\|} = \\sqrt{M}$。\n\n这个结果对任何偶数索引 $i$ 都成立。根据对称性，如果我们选择一个奇数索引 $i$，偶数和奇数索引的角色会互换，但 $\\Gamma_i$ 的结构及其范数将是相同的。因此，对于所有 $i \\in \\{0, \\dots, N-1\\}$，都有 $\\|\\Gamma_i\\| = \\sqrt{M}$。\n因此，$\\max_i \\|\\Gamma_i\\| = \\sqrt{M}$。\n\n**步骤 3：计算最终的敌手量**\n\n我们现在可以计算所需的比率 $V$：\n$$\nV = \\frac{\\|\\Gamma\\|}{\\max_i \\|\\Gamma_i\\|} = \\frac{M}{\\sqrt{M}} = \\sqrt{M}\n$$", "answer": "$$ \\boxed{\\sqrt{M}} $$"}]}