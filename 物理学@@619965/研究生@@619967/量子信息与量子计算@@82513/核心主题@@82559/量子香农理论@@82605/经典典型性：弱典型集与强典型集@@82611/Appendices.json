{"hands_on_practices": [{"introduction": "典型集的概念是信息论的基石，它将高概率序列与低概率序列区分开来。本练习将引导你动手计算弱典型集的大小，通过一个具体的有偏二元信源例子，将序列的经验熵与信源的真实熵联系起来。这个实践有助于你深入理解渐近均分特性（Asymptotic Equipartition Property, AEP）的实际含义，并掌握如何根据定义来识别和量化典型序列。[@problem_id:56674]", "problem": "一个独立同分布 (i.i.d.) 的离散无记忆信源由定义在有限字母表 $\\mathcal{X}$ 上的一个随机变量 $X$ 来表征，其概率质量函数为 $p(x) = \\text{Pr}(X=x)$。该信源发出的一个长度为 $n$ 的符号序列记为 $x^n = (x_1, x_2, \\ldots, x_n)$，其概率由 $p(x^n) = \\prod_{i=1}^n p(x_i)$ 给出。\n\n该信源的香农熵（使用以 2 为底的对数）定义为：\n$$ H(X) = -\\sum_{x \\in \\mathcal{X}} p(x) \\log_2 p(x) $$\n\n对于给定的序列长度 $n$ 和容差参数 $\\epsilon > 0$，*弱典型集* $A_\\epsilon^{(n)}$ 是指所有样本熵与信源真实熵相近的序列 $x^n$ 的集合。形式上，其定义为：\n$$ A_\\epsilon^{(n)} = \\left\\{ x^n \\in \\mathcal{X}^n : \\left| -\\frac{1}{n} \\log_2 p(x^n) - H(X) \\right| \\le \\epsilon \\right\\} $$\n\n考虑一个二进制无记忆信源，其字母表为 $\\mathcal{X} = \\{0, 1\\}$，概率为 $p(1) = p$ 和 $p(0) = 1-p$。\n对于该信源的一个特定实例，其概率 $p=1/3$，序列长度 $n=9$，容差 $\\epsilon=1/6$，请计算弱典型集中的序列总数，即求集合 $|A_\\epsilon^{(n)}|$ 的大小。", "solution": "弱典型集 $A_\\epsilon^{(n)}$ 定义为：\n\n$$\nA_\\epsilon^{(n)} = \\left\\{ x^n \\in \\mathcal{X}^n : \\left| -\\frac{1}{n} \\log_2 p(x^n) - H(X) \\right| \\le \\epsilon \\right\\}\n$$\n\n对于一个二进制信源，其 $p(1) = p = \\frac{1}{3}$ 且 $p(0) = 1 - p = \\frac{2}{3}$，一个包含 $k$ 个 1 和 $n - k$ 个 0 的序列 $x^n$ 的概率为：\n\n$$\np(x^n) = p^k (1 - p)^{n - k} = \\left(\\frac{1}{3}\\right)^k \\left(\\frac{2}{3}\\right)^{n - k}\n$$\n\n因此：\n\n$$\n\\log_2 p(x^n) = k \\log_2 \\left(\\frac{1}{3}\\right) + (n - k) \\log_2 \\left(\\frac{2}{3}\\right) = -k \\log_2 3 + (n - k) (1 - \\log_2 3)\n$$\n\n化简得：\n\n$$\n\\log_2 p(x^n) = -k \\log_2 3 + n - k - n \\log_2 3 + k \\log_2 3 = n(1 - \\log_2 3) - k\n$$\n\n所以：\n\n$$\n-\\frac{1}{n} \\log_2 p(x^n) = -\\frac{1}{n} [n(1 - \\log_2 3) - k] = -1 + \\log_2 3 + \\frac{k}{n}\n$$\n\n熵 $H(X)$ 为：\n\n$$\nH(X) = -p \\log_2 p - (1 - p) \\log_2 (1 - p) = -\\frac{1}{3} \\log_2 \\frac{1}{3} - \\frac{2}{3} \\log_2 \\frac{2}{3} = \\frac{1}{3} \\log_2 3 + \\frac{2}{3} \\log_2 \\frac{3}{2}\n$$\n\n\n$$\nH(X) = \\frac{1}{3} \\log_2 3 + \\frac{2}{3} (\\log_2 3 - \\log_2 2) = \\frac{1}{3} \\log_2 3 + \\frac{2}{3} \\log_2 3 - \\frac{2}{3} = \\log_2 3 - \\frac{2}{3}\n$$\n\n典型性条件变为：\n\n$$\n\\left| \\left( -1 + \\log_2 3 + \\frac{k}{n} \\right) - \\left( \\log_2 3 - \\frac{2}{3} \\right) \\right| \\le \\epsilon\n$$\n\n化简绝对值内的表达式：\n\n$$\n-1 + \\log_2 3 + \\frac{k}{n} - \\log_2 3 + \\frac{2}{3} = \\frac{k}{n} - \\frac{1}{3}\n$$\n\n因此：\n\n$$\n\\left| \\frac{k}{n} - \\frac{1}{3} \\right| \\le \\epsilon\n$$\n\n当 $n = 9$ 且 $\\epsilon = \\frac{1}{6}$ 时：\n\n$$\n\\left| \\frac{k}{9} - \\frac{1}{3} \\right| \\le \\frac{1}{6}\n$$\n\n求解 $k$：\n\n$$\n-\\frac{1}{6} \\le \\frac{k}{9} - \\frac{1}{3} \\le \\frac{1}{6}\n$$\n\n\n$$\n\\frac{1}{3} - \\frac{1}{6} \\le \\frac{k}{9} \\le \\frac{1}{3} + \\frac{1}{6}\n$$\n\n\n$$\n\\frac{1}{6} \\le \\frac{k}{9} \\le \\frac{1}{2}\n$$\n\n\n$$\n\\frac{9}{6} \\le k \\le \\frac{9}{2} \\implies 1.5 \\le k \\le 4.5\n$$\n\n因为 $k$ 必须为整数，所以 $k = 2, 3, 4$。\n\n$A_\\epsilon^{(n)}$ 的大小是包含 $k$ 个 1 的序列数量，即二项式系数的和：\n\n$$\n|A_\\epsilon^{(n)}| = \\sum_{k=2}^{4} \\binom{9}{k}\n$$\n\n计算得：\n\n$$\n\\binom{9}{2} = \\frac{9 \\times 8}{2} = 36, \\quad \\binom{9}{3} = \\frac{9 \\times 8 \\times 7}{6} = 84, \\quad \\binom{9}{4} = \\frac{9 \\times 8 \\times 7 \\times 6}{24} = 126\n$$\n\n\n$$\n|A_\\epsilon^{(n)}| = 36 + 84 + 126 = 246\n$$", "answer": "$$ \\boxed{246} $$", "id": "56674"}, {"introduction": "类型法（Method of Types）是分析长序列性质的强大组合技术，也是理解强典型性的关键。本练习要求你计算一个给定类型的“类”（type class）的大小，即所有具有相同经验概率分布的序列所构成的集合。通过这个计算，你将熟悉多项式系数在信息论中的应用，并为后续理解强典型集和信源编码定理建立重要的直观认识。[@problem_id:56807]", "problem": "在经典信息论中，**类型方法**是一种分析长随机变量序列性质的强大技术。它是证明 Shannon 信道编码定理的基础，并在量子信息论中也有对应，例如 Schumacher 压缩。\n\n设 $\\mathcal{X}$ 是一个有限字母表。一个长度为 $n$ 的序列，记为 $x^n = (x_1, x_2, \\dots, x_n)$，是符号的有序集合，其中每个 $x_i \\in \\mathcal{X}$。序列 $x^n$ 的**类型**（或经验概率分布）是定义在 $\\mathcal{X}$ 上的一个概率分布 $P_{x^n}$，其对于每个符号 $a \\in \\mathcal{X}$ 的值是该符号在序列中出现的相对频率。也就是说，\n$$ P_{x^n}(a) = \\frac{N(a|x^n)}{n} $$\n其中 $N(a|x^n)$ 是符号 $a$ 在序列 $x^n$ 中出现的次数。\n\n在 $\\mathcal{X}$ 上的概率分布 $P$ 的**类型类**，记为 $T(P)$，是所有类型为 $P$ 的长度为 $n$ 的序列的集合。\n$$ T(P) = \\{x^n \\in \\mathcal{X}^n : P_{x^n} = P \\} $$\n\n考虑一个系统，该系统从三元字母表 $\\mathcal{X} = \\{0, 1, 2\\}$ 中生成长度为 $n$ 的序列。长度 $n$ 是一个正整数，并且是 12 的倍数。我们关心一个由概率分布 $P$ 定义的特定类型类 $T(P)$，其中 $P(0) = 1/4$，$P(1) = 1/3$，$P(2) = 5/12$。\n\n您的任务是计算这个类型类的大小 $|T(P)|$ 的精确值，并将其表示为序列长度 $n$ 的函数。", "solution": "1. 对于字母表 $\\mathcal{X}$ 上的分布 $P$，其计数为 $N(a)$，类型类的大小由多项式系数给出\n$$|T(P)| \\;=\\; \\frac{n!}{\\prod_{a\\in\\mathcal X}N(a)!}\\,. $$\n\n2. 这里 $\\mathcal X=\\{0,1,2\\}$ 并且\n$$N(0)=nP(0)=\\frac{n}{4},\\quad N(1)=nP(1)=\\frac{n}{3},\\quad N(2)=nP(2)=\\frac{5n}{12},$$\n它们都是整数，因为 $n$ 是 12 的倍数。\n\n3. 代入多项式公式可得\n$$\n|T(P)| \\;=\\; \\frac{n!}\n{\\bigl(\\tfrac{n}{4}\\bigr)!\\,\\bigl(\\tfrac{n}{3}\\bigr)!\\,\\bigl(\\tfrac{5n}{12}\\bigr)!}\\,.\n$$", "answer": "$$\\boxed{\\frac{n!}{\\bigl(\\frac{n}{4}\\bigr)!\\,\\bigl(\\frac{n}{3}\\bigr)!\\,\\bigl(\\frac{5n}{12}\\bigr)!}}$$", "id": "56807"}, {"introduction": "弱典型性和强典型性是描述典型序列的两种不同方式，理解它们的区别至关重要。本练习通过一个具体问题，要求你计算那些“弱典型”但“非强典型”的序列的总概率。这个过程将迫使你精确应用两种定义，从而深刻地揭示它们在有限序列长度下的微妙差异。[@problem_id:56805]", "problem": "考虑一个信息源，它产生一个符号序列 $x_1, x_2, \\ldots, x_n$。这些符号是根据一个定义在有限字母表 $\\mathcal{X}$ 上的概率质量函数 $p(x)$ 进行独立同分布 (i.i.d.) 的。\n\n相对于一个容差 $\\epsilon > 0$，**弱典型集** $A_\\epsilon^{(n)}$ 是所有序列 $x^n = (x_1, \\ldots, x_n)$ 的集合，这些序列的样本熵接近于该信源的香农熵 $H(X)$：\n$$A_\\epsilon^{(n)} = \\left\\{ x^n \\in \\mathcal{X}^n : \\left| -\\frac{1}{n} \\log_2 p(x^n) - H(X) \\right| \\le \\epsilon \\right\\}$$\n其中 $p(x^n) = \\prod_{i=1}^n p(x_i)$ 且 $H(X) = -\\sum_{x \\in \\mathcal{X}} p(x) \\log_2 p(x)$。\n\n相对于一个容差 $\\delta > 0$，**强典型集** $T_\\delta^{(n)}$ 是所有序列 $x^n$ 的集合，对于这些序列，每个符号的经验频率都接近其真实概率。设 $N(x|x^n)$ 是符号 $x$ 在序列 $x^n$ 中出现的次数。那么：\n$$T_\\delta^{(n)} = \\left\\{ x^n \\in \\mathcal{X}^n : \\left| \\frac{N(x|x^n)}{n} - p(x) \\right| \\le \\delta \\text{ 对于所有 } x \\in \\mathcal{X}, \\text{ 且 } N(x|x^n)=0 \\text{ 若 } p(x)=0 \\right\\}$$\n\n现在，考虑一个特定的三元信源，其字母表为 $\\mathcal{X} = \\{0, 1, 2\\}$，概率为 $p(0) = p_0$，$p(1) = p_1$ 和 $p(2) = p_2$。对于 $p_0=1/2$，$p_1=1/4$，$p_2=1/4$ 的特定情况，以及序列长度 $n=4$、容差 $\\epsilon = 3/10$ 和 $\\delta = 3/10$ 的条件，计算所有弱典型但非强典型序列的总概率。也就是说，计算 $P(A_\\epsilon^{(n)} \\setminus T_\\delta^{(n)})$。", "solution": "该问题涉及一个三元信源，其字母表为 $\\mathcal{X} = \\{0, 1, 2\\}$，概率为 $p(0) = \\frac{1}{2}$，$p(1) = \\frac{1}{4}$，$p(2) = \\frac{1}{4}$。序列长度为 $n = 4$，容差为 $\\epsilon = \\frac{3}{10}$ 和 $\\delta = \\frac{3}{10}$。目标是计算 $P(A_\\epsilon^{(4)} \\setminus T_\\delta^{(4)})$，即弱典型但非强典型序列的概率。\n\n首先，计算香non熵 $H(X)$：\n\n$$\nH(X) = -\\sum_{x \\in \\mathcal{X}} p(x) \\log_2 p(x) = -\\left[ \\frac{1}{2} \\log_2 \\frac{1}{2} + \\frac{1}{4} \\log_2 \\frac{1}{4} + \\frac{1}{4} \\log_2 \\frac{1}{4} \\right].\n$$\n\n使用 $\\log_2 \\frac{1}{2} = -1$ 和 $\\log_2 \\frac{1}{4} = -2$：\n\n$$\nH(X) = -\\left[ \\frac{1}{2} \\cdot (-1) + \\frac{1}{4} \\cdot (-2) + \\frac{1}{4} \\cdot (-2) \\right] = -\\left[ -\\frac{1}{2} - \\frac{1}{2} - \\frac{1}{2} \\right] = -\\left[ -\\frac{3}{2} \\right] = \\frac{3}{2}.\n$$\n\n\n对于一个序列 $x^4 = (x_1, x_2, x_3, x_4)$，设 $n_0, n_1, n_2$ 分别是符号 $0, 1, 2$ 的计数，其中 $n_0 + n_1 + n_2 = 4$。其概率为：\n\n$$\np(x^4) = \\prod_{i=1}^4 p(x_i) = \\left( \\frac{1}{2} \\right)^{n_0} \\left( \\frac{1}{4} \\right)^{n_1} \\left( \\frac{1}{4} \\right)^{n_2}.\n$$\n\n样本熵为：\n\n$$\n-\\frac{1}{4} \\log_2 p(x^4) = -\\frac{1}{4} \\log_2 \\left[ \\left( \\frac{1}{2} \\right)^{n_0} \\left( \\frac{1}{4} \\right)^{n_1 + n_2} \\right].\n$$\n\n由于 $\\log_2 \\frac{1}{2} = -1$ 且 $\\log_2 \\frac{1}{4} = -2$：\n\n$$\n-\\frac{1}{4} \\log_2 p(x^4) = -\\frac{1}{4} \\left[ n_0 \\cdot (-1) + (n_1 + n_2) \\cdot (-2) \\right] = \\frac{1}{4} (n_0 + 2n_1 + 2n_2).\n$$\n\n代入 $n_1 + n_2 = 4 - n_0$：\n\n$$\n\\frac{1}{4} (n_0 + 2(4 - n_0)) = \\frac{1}{4} (n_0 + 8 - 2n_0) = \\frac{1}{4} (8 - n_0) = 2 - \\frac{n_0}{4}.\n$$\n\n\n弱典型集的条件是：\n\n$$\n\\left| 2 - \\frac{n_0}{4} - \\frac{3}{2} \\right| \\leq \\frac{3}{10} \\implies \\left| \\frac{1}{2} - \\frac{n_0}{4} \\right| \\leq \\frac{3}{10}.\n$$\n\n这可以简化为：\n\n$$\n-\\frac{3}{10} \\leq \\frac{1}{2} - \\frac{n_0}{4} \\leq \\frac{3}{10}.\n$$\n\n解该不等式：\n\n$$\n-\\frac{3}{10} - \\frac{1}{2} \\leq -\\frac{n_0}{4} \\leq \\frac{3}{10} - \\frac{1}{2} \\implies -\\frac{8}{10} \\leq -\\frac{n_0}{4} \\leq -\\frac{2}{10} \\implies \\frac{2}{10} \\leq \\frac{n_0}{4} \\leq \\frac{8}{10}.\n$$\n\n两边乘以 4：\n\n$$\n0.8 \\leq n_0 \\leq 3.2.\n$$\n\n由于 $n_0$ 是整数，所以 $n_0 \\in \\{1, 2, 3\\}$。因此，弱典型序列的 $n_0$ 值为 $1, 2$ 或 $3$。\n\n对于强典型集，经验频率必须对每个 $x$ 满足 $\\left| \\frac{N(x|x^4)}{4} - p(x) \\right| \\leq \\frac{3}{10}$：\n- 对于 $x=0$：$\\left| \\frac{n_0}{4} - \\frac{1}{2} \\right| \\leq \\frac{3}{10}$，得到 $0.8 \\leq n_0 \\leq 3.2$，所以 $n_0 \\in \\{1, 2, 3\\}$（与弱典型性相同）。\n- 对于 $x=1$：$\\left| \\frac{n_1}{4} - \\frac{1}{4} \\right| \\leq \\frac{3}{10} \\implies |n_1 - 1| \\leq 1.2 \\implies -0.2 \\leq n_1 \\leq 2.2$。由于 $n_1$ 是非负整数，所以 $n_1 \\in \\{0, 1, 2\\}$。\n- 对于 $x=2$：类似地，$\\left| \\frac{n_2}{4} - \\frac{1}{4} \\right| \\leq \\frac{3}{10} \\implies n_2 \\in \\{0, 1, 2\\}$。\n\n此外，$n_0 + n_1 + n_2 = 4$。如果 $n_1 \\notin \\{0, 1, 2\\}$ 或 $n_2 \\notin \\{0, 1, 2\\}$，则序列不是强典型的。由于 $n_1, n_2 \\geq 0$，唯一的违规情况发生在 $n_1 > 2$ 或 $n_2 > 2$ 时。在这些约束条件下：\n- 如果 $n_0 = 1$，那么 $n_1 + n_2 = 3$。可能的计数对 $(n_1, n_2)$ 为：$(0,3), (1,2), (2,1), (3,0)$。违反强典型性的计数对是 $(0,3)$（因为 $n_2=3 > 2$）和 $(3,0)$（因为 $n_1=3 > 2$）。\n- 如果 $n_0 = 2$，那么 $n_1 + n_2 = 2$。可能的计数对为：$(0,2), (1,1), (2,0)$。所有都满足 $n_1 \\leq 2, n_2 \\leq 2$。\n- 如果 $n_0 = 3$，那么 $n_1 + n_2 = 1$。可能的计数对为：$(0,1), (1,0)$。所有都满足 $n_1 \\leq 2, n_2 \\leq 2$。\n\n因此，只有计数为 $n_0=1$ 且 $(n_1, n_2) = (0,3)$ 或 $(3,0)$ 的序列是弱典型但非强典型的。\n\n具有计数 $(n_0, n_1, n_2)$ 的序列的概率为：\n\n$$\np(x^4) = \\left( \\frac{1}{2} \\right)^{n_0} \\left( \\frac{1}{4} \\right)^{n_1} \\left( \\frac{1}{4} \\right)^{n_2}.\n$$\n\n此类序列的数量是多项式系数：\n\n$$\n\\binom{4}{n_0, n_1, n_2} = \\frac{4!}{n_0! \\, n_1! \\, n_2!}.\n$$\n\n\n对于 $(n_0, n_1, n_2) = (1, 0, 3)$：\n\n$$\n\\text{序列数量} = \\frac{4!}{1! \\, 0! \\, 3!} = \\frac{24}{1 \\cdot 1 \\cdot 6} = 4,\n$$\n\n\n$$\n\\text{每个序列的概率} = \\left( \\frac{1}{2} \\right)^1 \\left( \\frac{1}{4} \\right)^0 \\left( \\frac{1}{4} \\right)^3 = \\frac{1}{2} \\cdot 1 \\cdot \\frac{1}{64} = \\frac{1}{128},\n$$\n\n\n$$\n\\text{总概率} = 4 \\cdot \\frac{1}{128} = \\frac{4}{128} = \\frac{1}{32}.\n$$\n\n\n对于 $(n_0, n_1, n_2) = (1, 3, 0)$：\n\n$$\n\\text{序列数量} = \\frac{4!}{1! \\, 3! \\, 0!} = \\frac{24}{1 \\cdot 6 \\cdot 1} = 4,\n$$\n\n\n$$\n\\text{每个序列的概率} = \\left( \\frac{1}{2} \\right)^1 \\left( \\frac{1}{4} \\right)^3 \\left( \\frac{1}{4} \\right)^0 = \\frac{1}{2} \\cdot \\frac{1}{64} \\cdot 1 = \\frac{1}{128},\n$$\n\n\n$$\n\\text{总概率} = 4 \\cdot \\frac{1}{128} = \\frac{4}{128} = \\frac{1}{32}.\n$$\n\n\n弱典型但非强典型序列的总概率是它们的和：\n\n$$\n\\frac{1}{32} + \\frac{1}{32} = \\frac{2}{32} = \\frac{1}{16}.\n$$", "answer": "$$ \\boxed{\\dfrac{1}{16}} $$", "id": "56805"}]}