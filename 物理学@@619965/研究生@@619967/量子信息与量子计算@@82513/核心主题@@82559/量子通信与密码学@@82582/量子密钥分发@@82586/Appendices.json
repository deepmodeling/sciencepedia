{"hands_on_practices": [{"introduction": "量子密钥分发（QKD）的安全性并非源于阻止窃听，而是源于其能够有效探测窃听行为。这项实践将通过一个核心场景，量化一个窃听者（Eve）在试图获取信息时必然会引入的扰动。我们将计算在经典的BB84协议下，当Eve采用最直接的“拦截-重发”攻击策略时，会在筛选后的密钥中引入一个高达25%的量子比特错误率（QBER），这个计算揭示了QKD安全性的基本原理。[@problem_id:1651422]", "problem": "两位物理学家，Alice和Bob，正在测试他们的新型量子密钥分发（QKD）系统，该系统基于BB84协议运行。在此协议中，Alice向Bob发送量子比特（qubit），用以编码经典比特信息。\n\n编码方案如下：\n- 要发送经典比特“0”，Alice可以制备处于$|0\\rangle$态（来自直线基）或$|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$态（来自对角基）的量子比特。\n- 要发送经典比特“1”，Alice可以制备处于$|1\\rangle$态（来自直线基）或$|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$态（来自对角基）的量子比特。\n\n对于她发送的每一个量子比特，Alice都会做出两个独立的随机选择：她选择要发送的经典比特（0或1，各有50%的概率），并选择要使用的基（直线基或对角基，各有50%的概率）。\n\n一个窃听者Eve，对从Alice传输到Bob的每一个量子比特都实施拦截重发攻击。对于她拦截的每一个量子比特，由于不知道Alice选择的基，Eve会随机选择一个基（直线基或对角基，各有50%的概率）进行测量。然后，她根据自己的测量结果，在自己所用的测量基中制备一个新的量子比特发送给Bob。\n\nBob接收来自Eve的量子比特，并且在不知道Alice或Eve选择的基的情况下，也随机选择一个基（直线基或对角基，各有50%的概率）进行测量。\n\n在整个量子比特序列传输和测量完毕后，Alice和Bob通过一个公共信道进行通信，以比较他们用于每个比特的基。他们丢弃所有基选择不匹配的比特。剩下的比特构成了筛选密钥。\n\n计算预期的量子比特误码率（QBER），其定义为Bob筛选密钥中的比特与Alice最初发送的相应比特不匹配的概率。请将您的答案表示为小数。", "solution": "令$X \\in \\{0,1\\}$表示Alice的比特，$A \\in \\{\\mathcal{R},\\mathcal{D}\\}$表示Alice的基（直线基或对角基），$E \\in \\{\\mathcal{R},\\mathcal{D}\\}$表示Eve的基，$B \\in \\{\\mathcal{R},\\mathcal{D}\\}$表示Bob的基。令$Y \\in \\{0,1\\}$表示Bob的测量结果在其所选基中解释的比特。筛选集对应于事件$S=\\{A=B\\}$。量子比特误码率（QBER）是条件概率\n$$\n\\mathrm{QBER}=P(Y \\neq X \\mid S).\n$$\n根据Eve的基是否与Alice的基匹配，使用全概率公式，\n$$\nP(Y \\neq X \\mid S)=P(E=A \\mid S)\\,P(Y \\neq X \\mid S,E=A)+P(E \\neq A \\mid S)\\,P(Y \\neq X \\mid S,E \\neq A).\n$$\n因为$E$的选择独立于$A$和$B$，所以以$S$为条件不会改变$E$相对于$A$的分布：\n$$\nP(E=A \\mid S)=\\frac{P(E=A, S)}{P(S)}=\\frac{P(E=A)\\,P(S)}{P(S)}=P(E=A)=\\frac{1}{2},\n$$\n因此$P(E \\neq A \\mid S)=\\frac{1}{2}$。\n\n评估这两个条件错误概率：\n1) 如果$E=A$且$S$成立（即$B=A$），Eve在Alice的基中进行测量，并重新发送该基中对应的本征态。然后Bob在相同的基$A$中测量，通过对本征态进行投影测量，他必然会得到相同的比特。因此\n$$\nP(Y \\neq X \\mid S,E=A)=0.\n$$\n2) 如果$E \\neq A$且$S$成立（即$B=A \\neq E$），Eve在共轭基中进行测量。例如，如果Alice发送了$|0\\rangle$（基$\\mathcal{R}$），而Eve在$\\mathcal{D}$基中测量，Eve的结果是$|+\\rangle$或$|-\\rangle$的概率各为$\\frac{1}{2}$，然后她重新发送该状态。Bob在$\\mathcal{R}$基中测量；根据玻恩定则可得\n$$\n|\\langle 0|+\\rangle|^{2}=|\\langle 1|+\\rangle|^{2}=|\\langle 0|-\\rangle|^{2}=|\\langle 1|-\\rangle|^{2}=\\left|\\frac{1}{\\sqrt{2}}\\right|^{2}=\\frac{1}{2},\n$$\n所以Bob的测量结果相对于Alice的原始比特是均匀随机的。因此\n$$\nP(Y \\neq X \\mid S,E \\neq A)=\\frac{1}{2}.\n$$\n\n综合这些，\n$$\n\\mathrm{QBER}=\\left(\\frac{1}{2}\\right)\\cdot 0+\\left(\\frac{1}{2}\\right)\\cdot \\left(\\frac{1}{2}\\right)=\\frac{1}{4}=0.25.\n$$", "answer": "$$\\boxed{0.25}$$", "id": "1651422"}, {"introduction": "在真实世界的QKD系统中，错误不仅来源于窃听者，也可能源于设备自身的不完美。区分这种“内生”错误率与窃听者引入的错误率至关重要。本练习模拟了一个更为现实的场景，要求我们同时考虑两种常见的硬件缺陷：发送方（Alice）与接收方（Bob）之间的偏振基组未对准，以及Bob探测器的暗计数。通过计算这两种效应共同导致的总体内生QBER，我们可以理解为探测Eve的攻击行为设定一个可靠的错误率阈值是何等重要。[@problem_id:122603]", "problem": "在 BB84 量子密钥分发 (QKD) 协议的一次实际实现中，Alice 向 Bob 发送单光子态。该协议利用两组偏振基：直线基（$Z$基），由水平偏振态（$|H\\rangle$，表示逻辑比特 0）和垂直偏振态（$|V\\rangle$，表示逻辑比特 1）组成；以及对角基（$X$基），由对角偏振态（$|D\\rangle = \\frac{1}{\\sqrt{2}}(|H\\rangle+|V\\rangle)$，表示逻辑 0）和反对角偏振态（$|A\\rangle = \\frac{1}{\\sqrt{2}}(|H\\rangle-|V\\rangle)$，表示逻辑 1）组成。Alice 随机制备并发送处于这四种状态之一的光子。Bob 随机选择在 $Z$ 基或 $X$ 基下进行测量。\n\n在量子传输阶段结束后，Alice 和 Bob 公开宣布他们对每个传输的光子所选择的测量基。他们只保留那些双方测量基匹配的结果，这些结果构成了“筛选密钥”。量子比特错误率 (QBER) 是指此筛选密钥中不正确比特所占的比例。\n\n考虑一个 QKD 系统，其中理想协议受到以下非理想因素的影响：\n\n1.  **基失配：** Alice 和 Bob 相应的偏振基之间存在一个系统性的、恒定的角度失配 $\\theta$。如果 Alice 的基是 $\\{|H\\rangle, |V\\rangle\\}$ 和 $\\{|D\\rangle, |A\\rangle\\}$，那么 Bob 的基是 $\\{|H'\\rangle, |V'\\rangle\\}$ 和 $\\{|D'\\rangle, |A'\\rangle\\}$，其中 $|H'\\rangle = \\cos\\theta |H\\rangle + \\sin\\theta |V\\rangle$ 且 $|V'\\rangle = -\\sin\\theta |H\\rangle + \\cos\\theta |V\\rangle$。同样的旋转也适用于对角基。\n\n2.  **探测器暗计数：** Bob 用于每个基的测量设备由一个偏振分束器和其后的两个单光子探测器组成。即使没有光子入射，在一次测量时间窗口内，每个探测器都有相同的概率 $p_{dark}$ 注册一次“响应”（click）。这些暗计数对于每个探测器是独立的。\n\n3.  **信道损耗：** 连接 Alice 和 Bob 的量子信道是有损耗的，其特征是传输效率为 $\\eta$。这意味着 Alice 发送的光子有 $\\eta$ 的概率到达 Bob 的探测装置。\n\nBob 的探测结果按以下方式确定：对于一个选定的测量基，如果两个相应的探测器中恰好有一个发生响应，则记录一个比特值。如果两个探测器都响应或都不响应，则该事件被视为无效并被丢弃。\n\n假设 Alice 以相等的概率发送 BB84 协议的四种状态中的任意一种，Bob 也以相等的概率选择其测量基，请确定筛选密钥的总 QBER。请将您的答案表示为传输效率 $\\eta$、失配角 $\\theta$ 和暗计数概率 $p_{dark}$ 的函数。", "solution": "1. 定义事件和参数：  \n   - 光子到达：$p_{\\text{arr}}=\\eta$，损耗：$1-\\eta$。  \n   - 探测器暗计数概率：每个探测器为 $p_d=p_{dark}$。  \n   - 在匹配基下的失配投影概率：  \n     $$T_{\\text{correct}}=\\cos^2\\theta,\\quad T_{\\text{error}}=\\sin^2\\theta,\\quad \n       T_{\\text{correct}}+T_{\\text{error}}=1.$$\n\n2. 情况 1：光子到达（概率为 $\\eta$）。  \n   如果光子在一个探测器中引发一次响应，而另一个探测器没有发生暗计数，则恰好发生一次响应。  \n   此情况下的总有效概率：  \n   $$P_{\\text{valid|arr}}\n     =\\sum_{d}\\!T_d\\,(1-p_d)\n     =(T_{\\text{correct}}+T_{\\text{error}})(1-p_d)\n     =1-p_d.$$  \n   仅当光子进入“错误”的探测器，而另一个探测器没有暗计数时，才会发生错误：  \n   $$P_{\\text{err|arr}}\n     =T_{\\text{error}}(1-p_d).$$  \n   因此，光子到达的条件错误率：  \n   $$e_{\\text{arr}}\n     =\\frac{T_{\\text{error}}(1-p_d)}{1-p_d}\n     =T_{\\text{error}}\n     =\\sin^2\\theta.$$\n\n3. 情况 2：光子丢失（概率为 $1-\\eta$）。  \n   响应完全由暗计数引起。恰好发生一次暗计数的概率为  \n   $$P_{\\text{valid|loss}}\n     =2\\,p_d\\,(1-p_d).$$  \n   这个由单次响应产生的比特是随机的，因此每次事件的错误概率是 $1/2$：  \n   $$P_{\\text{err|loss}}\n     =2\\,p_d\\,(1-p_d)\\times\\frac12\n     =(1-\\eta)\\,p_d\\,(1-p_d)\\quad\\text{（已包含前置因子 }1-\\eta\\text{）}$$\n\n4. 每个信号的总有效筛选事件：  \n   $$P_{\\text{valid}}\n     =\\eta(1-p_d)+(1-\\eta)\\,2\\,p_d\\,(1-p_d).$$  \n   每个信号的总错误概率：  \n   $$P_{\\text{err}}\n     =\\eta\\,T_{\\text{error}}(1-p_d)+(1-\\eta)\\,p_d\\,(1-p_d)\n     =\\eta\\,\\sin^2\\theta\\,(1-p_d)+(1-\\eta)\\,p_d\\,(1-p_d).$$\n\n5. QBER 是以下比率：  \n   $$Q\n     =\\frac{P_{\\text{err}}}{P_{\\text{valid}}}\n     =\\frac{\\eta\\sin^2\\theta\\,(1-p_d)+(1-\\eta)p_d\\,(1-p_d)}\n           {\\eta(1-p_d)+(1-\\eta)2p_d\\,(1-p_d)}.$$\n   从分子和分母中提出公因子 $(1-p_d)$：  \n   $$Q\n     =\\frac{\\eta\\sin^2\\theta+(1-\\eta)p_d}\n           {\\eta+2(1-\\eta)p_d}.$$", "answer": "$$\\boxed{\\frac{\\eta\\sin^2\\theta+(1-\\eta)p_{dark}}{\\eta+2(1-\\eta)p_{dark}}}$$", "id": "122603"}, {"introduction": "现代QKD安全性的严格证明，通常依赖于一种更强大且更抽象的视角——任何“制备-测量”方案（如BB84）都可以等效地用一个“基于纠缠”的方案来描述。这项实践旨在帮助你掌握这一核心概念。我们将演示Alice光源中的一个具体物理缺陷——在制备量子态时存在的系统性相位误差——如何能被精确地建模为一个共享纠缠态的瑕疵。通过计算这个有缺陷的“虚拟”纠缠态与理想纠缠态之间的保真度，你将能体会到如何将具体的物理不完美性转化为形式化的安全度量，为理解高级安全性证明奠定基础。[@problem_id:122664]", "problem": "在标准的“制备-测量”版BB84量子密钥分发协议中，Alice制备一个处于四种状态 $\\{|0\\rangle, |1\\rangle, |+\\rangle, |-\\rangle\\}$ 之一的量子比特，并将其发送给Bob。这些状态选自两个互无偏基：Z基 $\\{|0\\rangle, |1\\rangle\\}$ 和X基 $\\{|+\\rangle, |-\\rangle\\}$，其中 $|+\\rangle=\\frac{1}{\\sqrt{2}}(|0\\rangle+|1\\rangle)$ 且 $|-\\rangle=\\frac{1}{\\sqrt{2}}(|0\\rangle-|1\\rangle)$。\n\n该过程的一个等效描述是“源替换”或基于纠缠的方案。在此图像下，Alice被假设制备一个双量子比特纠缠态 $|\\Psi\\rangle_{AB}$，自己保留量子比特A，并将量子比特B发送给Bob。她为Bob“制备”一个状态，是通过对她自己的量子比特A进行测量来实现的。对于理想的BB84协议，这个对应的虚拟纠缠态是贝尔态 $|\\Phi^+\\rangle_{AB} = \\frac{1}{\\sqrt{2}}(|00\\rangle_{AB} + |11\\rangle_{AB})$。在Z基上测量量子比特A，会将量子比特B制备在 $|0\\rangle$ 或 $|1\\rangle$ 状态；在X基上测量量子比特A，会将量子比特B制备在 $|+\\rangle$ 或 $|-\\rangle$ 状态。\n\n考虑一个Alice的源不完美的场景。具体来说，它的源存在系统性的相位编码不精确性。当她意图制备X基状态时，她实际产生的状态会带有一个微小的、系统性的相位误差，用角度 $\\delta$ 表示。她的Z基状态是完美制备的。她实际制备的四种状态是：\n- 对于Z基：$|0\\rangle, |1\\rangle$\n- 对于X基：$|\\tilde{+}\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + e^{i\\delta}|1\\rangle)$ 和 $|\\tilde{-}\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - e^{i\\delta}|1\\rangle)$。\n\n你的任务是使用基于纠缠的方案来为这个不完美的源建模。首先，确定能够准确表示Alice不完美制备的虚拟纠缠纯态 $|\\tilde{\\Psi}\\rangle_{AB}$。然后，计算这个不完美的虚拟状态 $|\\tilde{\\Psi}\\rangle_{AB}$ 与理想的虚拟状态 $|\\Phi^+\\rangle_{AB}$ 之间的保真度 $F$。两个纯态 $|\\psi\\rangle$ 和 $|\\phi\\rangle$ 之间的保真度定义为 $F = |\\langle\\phi|\\psi\\rangle|^2$。\n\n请提供保真度 $F$ 关于相位误差 $\\delta$ 的闭式表达式。", "solution": "该解法包含两个主要步骤：首先，确定不完美的虚拟纠缠态 $|\\tilde{\\Psi}\\rangle_{AB}$ 的形式；其次，计算它与理想状态 $|\\Phi^+\\rangle_{AB}$ 的保真度。\n\n**步骤1：确定不完美的虚拟纠缠态 $|\\tilde{\\Psi}\\rangle_{AB}$**\n\n设未知的虚拟状态为一个通用的双量子比特纯态：\n$$\n|\\tilde{\\Psi}\\rangle_{AB} = c_{00}|00\\rangle + c_{01}|01\\rangle + c_{10}|10\\rangle + c_{11}|11\\rangle\n$$\n其中系数 $c_{ij}$ 是复数，且该状态是归一化的，$\\sum |c_{ij}|^2 = 1$。\n\n我们用Alice的制备所施加的条件来约束这些系数。\n\n**条件1：Z基制备**\n如果Alice在Z基上测量她的量子比特A并得到结果“0”（投影到 $|0\\rangle_A$ 上），那么Bob的量子比特B的状态必须是 $|0\\rangle_B$。Bob的测量后状态（不考虑归一化）是：\n$$\n\\text{Tr}_A(|0\\rangle\\langle 0|_A \\otimes I_B |\\tilde{\\Psi}\\rangle\\langle\\tilde{\\Psi}|) \\propto \\langle 0|_A |\\tilde{\\Psi}\\rangle_{AB} = c_{00}|0\\rangle_B + c_{01}|1\\rangle_B\n$$\n为了使此状态与 $|0\\rangle_B$ 成正比，我们必须有 $c_{01} = 0$。\n\n类似地，如果Alice测量她的量子比特A并得到结果“1”（投影到 $|1\\rangle_A$ 上），Bob的状态必须是 $|1\\rangle_B$：\n$$\n\\langle 1|_A |\\tilde{\\Psi}\\rangle_{AB} = c_{10}|0\\rangle_B + c_{11}|1\\rangle_B\n$$\n为了使此状态与 $|1\\rangle_B$ 成正比，我们必须有 $c_{10} = 0$。\n\n因此，该状态简化为以下形式：\n$$\n|\\tilde{\\Psi}\\rangle_{AB} = c_{00}|00\\rangle + c_{11}|11\\rangle\n$$\n\n**条件2：X基制备（不完美）**\n如果Alice在X基上测量她的量子比特A并得到结果“+”（投影到 $|+\\rangle_A = \\frac{1}{\\sqrt{2}}(|0\\rangle_A+|1\\rangle_A)$ 上），那么Bob的量子比特B的状态必须是 $|\\tilde{+}\\rangle_B = \\frac{1}{\\sqrt{2}}(|0\\rangle_B + e^{i\\delta}|1\\rangle_B)$。\nBob的测量后状态是：\n$$\n\\langle+|_A |\\tilde{\\Psi}\\rangle_{AB} = \\frac{1}{\\sqrt{2}}(\\langle 0|_A + \\langle 1|_A)(c_{00}|00\\rangle + c_{11}|11\\rangle) = \\frac{1}{\\sqrt{2}}(c_{00}|0\\rangle_B + c_{11}|1\\rangle_B)\n$$\n为了使此状态与 $|\\tilde{+}\\rangle_B$ 成正比，系数的比率必须匹配：\n$$\n\\frac{c_{11}}{c_{00}} = \\frac{e^{i\\delta}}{1} \\implies c_{11} = c_{00}e^{i\\delta}\n$$\n\n让我们用另一个X基的制备情况来检验。如果Alice得到结果“-”（投影到 $|-\\rangle_A = \\frac{1}{\\sqrt{2}}(|0\\rangle_A-|1\\rangle_A)$ 上），Bob的量子比特必须处于状态 $|\\tilde{-}\\rangle_B = \\frac{1}{\\sqrt{2}}(|0\\rangle_B - e^{i\\delta}|1\\rangle_B)$。\n$$\n\\langle-|_A |\\tilde{\\Psi}\\rangle_{AB} = \\frac{1}{\\sqrt{2}}(\\langle 0|_A - \\langle 1|_A)(c_{00}|00\\rangle + c_{11}|11\\rangle) = \\frac{1}{\\sqrt{2}}(c_{00}|0\\rangle_B - c_{11}|1\\rangle_B)\n$$\n为了使此状态与 $|\\tilde{-}\\rangle_B$ 成正比，系数的比率必须匹配：\n$$\n\\frac{-c_{11}}{c_{00}} = \\frac{-e^{i\\delta}}{1} \\implies c_{11} = c_{00}e^{i\\delta}\n$$\n这与之前的结果是一致的。\n\n现在我们可以将状态写为 $|\\tilde{\\Psi}\\rangle_{AB} = c_{00}(|00\\rangle + e^{i\\delta}|11\\rangle)$。\n\n**条件3：归一化**\n我们对该状态进行归一化：\n$$\n\\langle\\tilde{\\Psi}|\\tilde{\\Psi}\\rangle = |c_{00}|^2 (\\langle 00| + e^{-i\\delta}\\langle 11|)(|00\\rangle + e^{i\\delta}|11\\rangle) = 1\n$$\n$$\n|c_{00}|^2 (1 + e^{-i\\delta}e^{i\\delta}) = |c_{00}|^2 (1 + 1) = 2|c_{00}|^2 = 1\n$$\n这得到 $|c_{00}| = 1/\\sqrt{2}$。我们可以选择全局相位使得 $c_{00} = 1/\\sqrt{2}$。\n因此，不完美的虚拟纠缠态是：\n$$\n|\\tilde{\\Psi}\\rangle_{AB} = \\frac{1}{\\sqrt{2}}(|00\\rangle + e^{i\\delta}|11\\rangle)\n$$\n\n**步骤2：计算保真度**\n\n理想的虚拟状态是 $|\\Phi^+\\rangle_{AB} = \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$。\n保真度为 $F = |\\langle\\Phi^+|\\tilde{\\Psi}\\rangle|^2$。\n\n首先，我们计算内积：\n$$\n\\langle\\Phi^+|\\tilde{\\Psi}\\rangle = \\left( \\frac{1}{\\sqrt{2}}(\\langle 00| + \\langle 11|) \\right) \\left( \\frac{1}{\\sqrt{2}}(|00\\rangle + e^{i\\delta}|11\\rangle) \\right)\n$$\n$$\n\\langle\\Phi^+|\\tilde{\\Psi}\\rangle = \\frac{1}{2} (\\langle 00|00\\rangle + e^{i\\delta}\\langle 00|11\\rangle + \\langle 11|00\\rangle + e^{i\\delta}\\langle 11|11\\rangle)\n$$\n利用基态的正交归一性 ($\\langle ij | kl \\rangle = \\delta_{ik}\\delta_{jl}$):\n$$\n\\langle\\Phi^+|\\tilde{\\Psi}\\rangle = \\frac{1}{2} (1 + 0 + 0 + e^{i\\delta}) = \\frac{1}{2}(1 + e^{i\\delta})\n$$\n\n现在，我们计算模的平方以得到保真度：\n$$\nF = \\left| \\frac{1}{2}(1 + e^{i\\delta}) \\right|^2 = \\frac{1}{4} |1 + \\cos\\delta + i\\sin\\delta|^2\n$$\n复数 $z = x+iy$ 的模的平方是 $|z|^2 = x^2+y^2$:\n$$\nF = \\frac{1}{4} \\left( (1+\\cos\\delta)^2 + (\\sin\\delta)^2 \\right)\n$$\n$$\nF = \\frac{1}{4} (1 + 2\\cos\\delta + \\cos^2\\delta + \\sin^2\\delta)\n$$\n使用恒等式 $\\cos^2\\delta + \\sin^2\\delta = 1$:\n$$\nF = \\frac{1}{4} (1 + 2\\cos\\delta + 1) = \\frac{1}{4} (2 + 2\\cos\\delta) = \\frac{1}{2}(1+\\cos\\delta)\n$$\n使用三角半角恒等式 $1+\\cos\\delta = 2\\cos^2(\\delta/2)$:\n$$\nF = \\frac{1}{2}\\left(2\\cos^2\\left(\\frac{\\delta}{2}\\right)\\right) = \\cos^2\\left(\\frac{\\delta}{2}\\right)\n$$\n这是保真度的最终表达式。", "answer": "$$ \\boxed{\\cos^2\\left(\\frac{\\delta}{2}\\right)} $$", "id": "122664"}]}