{"hands_on_practices": [{"introduction": "量子密钥分发（QKD）安全性的基石在于，任何窃听行为都必然会干扰量子态，从而在通信双方之间引入可被检测的错误。本练习将通过分析针对BB84协议的最基本攻击——“拦截-重发”攻击，来量化这种干扰。通过这个计算，我们将揭示窃听者Eve的行为如何直接转化为可测量的量子比特错误率（QBER），这是评估信道安全性的第一个关键步骤 [@problem_id:171243]。", "problem": "在BB84量子密钥分发（QKD）协议中，Alice向Bob发送一个单量子比特序列。对于每个量子比特，她随机且独立地选择两组基中的一组来编码一个比特：直角（Z）基，其本征态为 $\\{|0\\rangle, |1\\rangle\\}$，或对角（X）基，其本征态为 $\\{|+\\rangle, |-\\rangle\\}$。这些状态定义如下：\n$$\n|0\\rangle = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad |1\\rangle = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n$$\n|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle), \\quad |-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)\n$$\nBob对每个接收到的量子比特，也随机且独立地选择在Z基或X基上进行测量。传输结束后，Alice和Bob通过一个公共信道进行通信，以比较他们为每个量子比特所使用的基。他们只保留那些他们选择的基相匹配的比特，形成“筛选密钥”。量子比特误码率（QBER）是指在该筛选密钥中，Alice和Bob之间不一致的比特所占的比例。\n\n一个窃听者Eve，进行一种对称的截获重发攻击。对于Alice发送的每个量子比特，Eve会截获它，以相等的概率在Z基或X基上进行测量，然后将一个根据她测量得到的状态新制备的量子比特发送给Bob。假设Eve对每个量子比特的基的选择是随机且独立的。\n\n计算由Eve的攻击所引起的期望QBER。", "solution": "在存在Eve对称截获重发攻击的BB84协议中，期望量子比特误码率（QBER）是指，对于筛选密钥中的一个量子比特（其中Alice和Bob使用了相同的基），Bob的测量结果与Alice发送的比特不一致的概率。筛选密钥的生成条件是Alice和Bob选择了相同的基。\n\n考虑单个量子比特的传输。由于对称性，我们可以不失一般性地假设Alice使用直角基（Z基）。Alice以$\\frac{1}{2}$的等概率发送$\\lvert 0 \\rangle$或$\\lvert 1 \\rangle$。我们将发送的比特固定为$\\lvert 0 \\rangle$（根据对称性，对于$\\lvert 1 \\rangle$而言，错误概率是相同的）。Eve截获量子比特并随机选择测量基：以$\\frac{1}{2}$的概率选择Z基，或以$\\frac{1}{2}$的概率选择X基。\n\n- **情况1：Eve选择Z基（概率为$\\frac{1}{2}$）**  \n  Eve在Z基上测量$\\lvert 0 \\rangle$，得到$\\lvert 0 \\rangle$并向Bob发送$\\lvert 0 \\rangle$。  \n  Bob在Z基上测量（根据筛选密钥的条件），必然得到$0$。错误概率为：$0$。\n\n- **情况2：Eve选择X基（概率为$\\frac{1}{2}$）**  \n  Eve在X基上测量$\\lvert 0 \\rangle$：  \n  - 以$\\frac{1}{2}$的概率得到$\\lvert + \\rangle$，并向Bob发送$\\lvert + \\rangle$。  \n  - 以$\\frac{1}{2}$的概率得到$\\lvert - \\rangle$，并向Bob发送$\\lvert - \\rangle$。  \n  Bob在Z基上测量：  \n  - 对于$\\lvert + \\rangle$，Bob以$\\frac{1}{2}$的概率分别得到$0$或$1$。如果得到$1$则发生错误（概率为$\\frac{1}{2}$）。  \n  - 对于$\\lvert - \\rangle$，Bob以$\\frac{1}{2}$的概率分别得到$0$或$1$。如果得到$1$则发生错误（概率为$\\frac{1}{2}$）。  \n  因此，在Eve选择X基的条件下，错误概率为：  \n  $$\n  \\frac{1}{2} \\cdot \\frac{1}{2} + \\frac{1}{2} \\cdot \\frac{1}{2} = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}.\n  $$\n\n鉴于Alice发送了$\\lvert 0 \\rangle$而Bob在Z基上进行测量，总的错误概率为：  \n$$\nP(\\text{错误} \\mid \\text{Alice Z, Bob Z}) = P(\\text{情况1}) \\cdot 0 + P(\\text{情况2}) \\cdot \\frac{1}{2} = \\frac{1}{2} \\cdot 0 + \\frac{1}{2} \\cdot \\frac{1}{2} = \\frac{1}{4}.\n$$\n\n根据对称性，如果Alice使用对角基（X基）发送$\\lvert + \\rangle$或$\\lvert - \\rangle$，在Bob也使用X基进行测量的条件下，错误概率也为$\\frac{1}{4}$。因为筛选密钥只包含基相同的量子比特，并且对于两种基的选择，条件错误概率均为$\\frac{1}{4}$，所以期望QBER为$\\frac{1}{4}$。", "answer": "$$\\boxed{\\dfrac{1}{4}}$$", "id": "171243"}, {"introduction": "在检测到错误之后，我们如何将观测到的干扰程度与窃听者可能获得的信息量联系起来？熵不确定性关系为“信息-扰动权衡”原理提供了严格的数学基础，它构成了许多QKD安全证明的核心。在此实践中，你将运用该关系，直接从共轭基中测得的量子比特错误率 $Q_X$ 推导出密钥比特对Eve而言的不可预测性（以最小熵为度量）的下限 [@problem_id:143203]。", "problem": "在BB84量子密钥分发（QKD）协议的背景下，最终密钥的安全性从根本上受限于窃听者Eve（E）能够从Alice（A）传输给Bob（B）的原始密钥中获取的信息。这种信息泄露可以使用熵不确定性关系进行量化和界定。\n\n考虑一个BB84的实现方案，其中Alice制备单量子比特态并发送给Bob。她的原始密钥比特编码在计算基（或Z基）（$\\{|0\\rangle, |1\\rangle\\}$）中。为了检测窃听，Alice和Bob公开比较他们在共轭基（或X基）（$\\{|+\\rangle, |-\\rangle\\}$）中制备和测量的一个随机比特子集，其中$|\\pm\\rangle = (|0\\rangle \\pm |1\\rangle)/\\sqrt{2}$。通过这次比较，他们确定了X基中的量子比特错误率（QBER），记为$Q_X$。\n\n对于安全性而言，一个关键的量是给定Eve的量子旁路信息时Alice比特的条件最小熵，$H_{min}(A|E)$。这个量从Eve的角度量化了Alice比特的不可预测性。安全密钥率与此量的下界成正比。\n\n用于此分析的一个强大工具是带有量子旁路信息的熵不certainty关系。对于任意三体纯态$|\\Psi\\rangle_{ABE}$，Alice在Z基和X基上测量结果的条件冯·诺依曼熵的界限如下：\n$$S(Z_A|E) + S(X_A|B) \\ge 1$$\n这里，$S(M_A|S)$ 是给定系统$S$（其中$S \\in \\{B, E\\}$）时，Alice在测量$M$（其中$M \\in \\{X, Z\\}$）上结果的条件冯·诺依曼熵。所有熵均使用以2为底的对数计算。\n\n**问题：**\n假设 (i) Alice和Bob之间在X基上的有效量子信道表现为一个翻转（错误）概率为$Q_X$的二元对称信道，以及 (ii) 为了推导安全界限，条件冯·诺依曼熵$S(A|E)$可作为条件最小熵$H_{min}(A|E)$的一个紧下界，请确定$H_{min}(A|E)$的下界，将其表示为观测到的QBER $Q_X$的函数。你的答案应以$Q_X$和以2为底的对数表示。", "solution": "我们已知条件冯·诺依曼熵的熵不确定性关系：\n$$ S(Z_A|E) + S(X_A|B) \\geq 1 $$\n其中$S(M_A|S)$是给定系统$S$时Alice在测量$M$上结果的条件冯·诺依曼熵，并且熵是以2为底的。\n\n目标是找到条件最小熵$H_{\\min}(A|E)$的下界，根据题目陈述，它的下界是$S(Z_A|E)$。因此，我们专注于求解$S(Z_A|E)$的下界。\n\n根据不确定性关系：\n$$ S(Z_A|E) \\geq 1 - S(X_A|B) $$\n\n我们现在用量子比特错误率$Q_X$来表示$S(X_A|B)$。题目指出，X基上的有效量子信道是一个翻转概率为$Q_X$的二元对称信道。这意味着：\n- Alice在X基中均匀地制备一个比特$a \\in \\{0,1\\}$，因此$P(X_A = a) = \\frac{1}{2}$。\n- Bob的结果$b \\in \\{0,1\\}$满足$P(X_B = b \\mid X_A = a) = \\begin{cases} 1 - Q_X & \\text{若 } b = a \\\\ Q_X & \\text{若 } b \\neq a \\end{cases}$。\n\n联合概率分布为：\n$$ P(X_A = 0, X_B = 0) = \\frac{1}{2}(1 - Q_X), \\quad P(X_A = 0, X_B = 1) = \\frac{1}{2}Q_X $$\n$$ P(X_A = 1, X_B = 0) = \\frac{1}{2}Q_X, \\quad P(X_A = 1, X_B = 1) = \\frac{1}{2}(1 - Q_X) $$\n\n对于这个经典-量子态（其中$X_A$是经典的，$B$是量子的，但态在X基上是对角的），条件冯·诺依曼熵$S(X_A|B)$等于经典条件熵$H(X_A | X_B)$，因为Bob在X基上的测量产生了捕获相关信息的经典结果。\n\n$X_B$的边缘分布为：\n$$ P(X_B = 0) = P(X_A=0, X_B=0) + P(X_A=1, X_B=0) = \\frac{1}{2}(1 - Q_X) + \\frac{1}{2}Q_X = \\frac{1}{2} $$\n$$ P(X_B = 1) = \\frac{1}{2} $$\n\n条件熵$H(X_A | X_B = b)$为：\n- 对于 $X_B = 0$：\n  $$ P(X_A = 0 | X_B = 0) = \\frac{P(X_A=0, X_B=0)}{P(X_B=0)} = 1 - Q_X $$\n  $$ P(X_A = 1 | X_B = 0) = Q_X $$\n  熵为$h_2(Q_X) = -Q_X \\log_2 Q_X - (1 - Q_X) \\log_2 (1 - Q_X)$（二元熵函数）。\n- 对于 $X_B = 1$：\n  $$ P(X_A = 0 | X_B = 1) = Q_X $$\n  $$ P(X_A = 1 | X_B = 1) = 1 - Q_X $$\n  熵也为$h_2(Q_X)$。\n\n因此：\n$$ H(X_A | X_B) = P(X_B=0) h_2(Q_X) + P(X_B=1) h_2(Q_X) = \\frac{1}{2} h_2(Q_X) + \\frac{1}{2} h_2(Q_X) = h_2(Q_X) $$\n所以：\n$$ S(X_A|B) = h_2(Q_X) = -Q_X \\log_2 Q_X - (1 - Q_X) \\log_2 (1 - Q_X) $$\n\n代入不确定性关系中：\n$$ S(Z_A|E) \\geq 1 - h_2(Q_X) = 1 + Q_X \\log_2 Q_X + (1 - Q_X) \\log_2 (1 - Q_X) $$\n\n由于$H_{\\min}(A|E) \\geq S(Z_A|E)$（根据题目，这是一个紧下界），我们得到：\n$$ H_{\\min}(A|E) \\geq 1 + Q_X \\log_2 Q_X + (1 - Q_X) \\log_2 (1 - Q_X) $$\n\n这就是用$Q_X$和以2为底的对数表示的下界。", "answer": "$$ \\boxed{1 + Q_X \\log_2 Q_X + (1 - Q_X) \\log_2 (1 - Q_X)} $$", "id": "143203"}, {"introduction": "一个完整的QKD协议不仅要处理量子信道上的窃听，还必须考虑经典后处理阶段的安全性开销。最终的安全密钥是从原始密钥中“提炼”出来的，这一过程需要为纠错、经典通信认证和隐私放大等步骤“支付”密钥比特。本练习综合了这些实际因素，要求你计算最终安全密钥的长度，从而让你对实际QKD系统中的“安全成本”有一个整体和定量的认识 [@problem_id:171203]。", "problem": "在BB84量子密钥分发协议的实际实现中，双方（Alice和Bob）首先建立一个长度为 $N_{sift}$ 的筛选密钥。为将此筛选密钥转化为最终的安全密钥，他们必须执行纠错（EC）和隐私放大（PA）。\n\nEC协议是交互式的，需要通过公共信道交换 $C$ 条经典消息。为防止中间人攻击，每条消息都必须经过认证。认证使用基于$universal_2$哈希函数的 Carter-Wegman 方案进行。为确保安全性，每条消息都必须从现有的密钥材料中提取一个新的密钥。单条消息认证的安全性由参数 $\\epsilon_{auth}$ 表征，该参数是攻击者能够伪造一个有效的消息-标签对的最大概率。从筛选密钥中消耗的用于认证一条消息的密钥长度 $k_{auth}$ 由 $k_{auth} = 2s_{auth}$ 给出，其中 $s_{auth} = -\\log_2(\\epsilon_{auth})$ 是以比特为单位的认证安全参数。\n\nEC协议在纠正错误的同时，不可避免地会泄露关于密钥的信息。在此过程中泄露给窃听者（Eve）的总信息量记为 $I_{leak}$ 比特。\n\nEC阶段之后，Alice和Bob得到一个更短且经过纠错的密钥。然后，他们通过使用一个$universal_2$哈希函数将此密钥哈希缩短为一个最终的、更短的密钥来进行隐私放大。这一步是必要的，用以消除Eve获得的任何部分信息。这个最终密钥的安全性由保密性参数 $\\epsilon_{PA}$ 来表征，它表示该密钥与完全均匀密钥的迹距离。为达到这个安全水平，最终密钥的长度必须减少一个安全余量 $s_{PA} = -\\log_2(\\epsilon_{PA})$ 比特。\n\n假设初始筛选密钥足够长以完成整个过程，请用初始筛选密钥长度 $N_{sift}$、认证消息数 $C$、信息泄露量 $I_{leak}$ 以及安全参数 $\\epsilon_{auth}$ 和 $\\epsilon_{PA}$ 来推导最终安全密钥长度 $N_{final}$ 的表达式。", "solution": "我们计算从筛选密钥 $N_{sift}$ 中扣除的三个部分：\n1. EC 过程中泄露的信息：$I_{leak}$。\n2. 认证 $C$ 条消息所消耗的密钥。对于一条消息，$s_{auth}=-\\log_2\\epsilon_{auth}$，相关的密钥成本为 $k_{auth}=2\\,s_{auth}=2\\bigl(-\\log_2\\epsilon_{auth}\\bigr)$。因此总的认证成本是 $C\\,k_{auth}=2\\,C\\,\\bigl(-\\log_2\\epsilon_{auth}\\bigr)$。\n3. 隐私放大安全余量 $s_{PA}=-\\log_2\\epsilon_{PA}$。\n\n因此，最终密钥长度为\n$$\nN_{final}\n= N_{sift}\n- I_{leak}\n- 2\\,C\\,\\bigl(-\\log_2\\epsilon_{auth}\\bigr)\n- \\bigl(-\\log_2\\epsilon_{PA}\\bigr).\n$$\n我们可以将 $-\\log_2\\epsilon=\\log_2(1/\\epsilon)$ 重写以得到\n$$\nN_{final}\n= N_{sift}\n- I_{leak}\n- 2\\,C\\,\\log_2\\frac{1}{\\epsilon_{auth}}\n- \\log_2\\frac{1}{\\epsilon_{PA}}.\n$$", "answer": "$$\\boxed{N_{final}=N_{sift}-I_{leak}-2\\,C\\,\\log_2\\frac{1}{\\epsilon_{auth}}-\\log_2\\frac{1}{\\epsilon_{PA}}}$$", "id": "171203"}]}