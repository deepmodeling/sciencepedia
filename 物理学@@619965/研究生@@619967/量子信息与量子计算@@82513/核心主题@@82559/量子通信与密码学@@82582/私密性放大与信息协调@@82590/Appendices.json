{"hands_on_practices": [{"introduction": "我们的第一个练习将建立一个基本模型，以阐明隐私放大的核心原理。我们将探讨公开密钥的哈希标签如何为窃听者提供关于密钥的线性约束，从而直接降低密钥的最小熵（min-entropy）。这个练习将抽象的最小熵概念与仿射子空间维度的具体代数概念联系起来，为量化信息泄露提供了坚实的基础[@problem_id:110640]。", "problem": "Alice 和 Bob 共享一个密钥 $K$。该密钥是一个 $n$ 比特的字符串，我们将其表示为向量空间 $\\mathbb{F}_2^n$ 中的一个向量。最初，假设该密钥在 $\\mathbb{F}_2^n$ 上是均匀随机的。一个窃听者 Eve 拥有关于该密钥的旁路信息，该信息由一组线性约束来刻画。具体来说，Eve 知道对该密钥进行的 $n-k_0$ 次奇偶校验的结果，由 $c = H_E K$ 给出。这里，$H_E$ 是一个已知的在 $\\mathbb{F}_2$ 上的 $(n-k_0) \\times n$ 矩阵，其秩为 $n-k_0$，$c$ 是 $\\mathbb{F}_2^{n-k_0}$ 中的一个已知向量。该信息将密钥 $K$ 限制在 $\\mathbb{F}_2^n$ 的一个特定仿射子空间内。在给定 Eve 信息的条件下，$K$ 的条件分布在该子空间上是均匀的，其初始最小熵 $H_{\\min}(K|E)$ 恰好为 $k_0$。\n\n为了执行完整性校验，Alice 和 Bob 使用一个公开的线性哈希函数 $h_A: \\mathbb{F}_2^n \\to \\mathbb{F}_2^m$，定义为 $h_A(k) = Ak$，其中 $A$ 是一个在 $\\mathbb{F}_2$ 上的 $m \\times n$ 矩阵。矩阵 $A$ 的选择使得组合矩阵 $M = \\begin{pmatrix} H_E \\\\ A \\end{pmatrix}$ 的秩最大化。已知哈希标签中的比特数 $m$ 满足 $m \\le k_0$。\n\nAlice 计算出标签 $T=AK$ 并通过一个公共信道进行通信。现在这个标签 $T$ 也被 Eve 知道了。在给定 Eve 的初始旁路信息以及公开的矩阵 $A$ 和标签 $T$ 的情况下，计算从 Eve 的角度来看密钥 $K$ 的最终最小熵。", "solution": "1. Eve 的初始信息是奇偶校验\n   $$H_E K = c$$  \n   其中 $\\operatorname{rank}(H_E)=n-k_0$。 因此 $K$ 在一个维度为\n   $$n-\\operatorname{rank}(H_E)=n-(n-k_0)=k_0,$$  \n   的仿射子空间上均匀分布，得到\n   $$H_{\\min}(K\\mid E)=k_0.$$\n\n2. Alice 公开了标签\n   $$T = A\\,K,$$  \n   其中 $A$ 是 $m\\times n$ 矩阵且 $m\\le k_0$。 组合矩阵\n   $$M = \\begin{pmatrix}H_E\\\\A\\end{pmatrix}$$  \n   被选择以使其秩最大化。 由于 $\\operatorname{rank}(H_E)=n-k_0$ 且 $A$ 贡献了 $m$ 个独立的行（因为 $m\\le k_0$），\n   $$\\operatorname{rank}(M)= (n-k_0)+m.$$\n\n3. 给定 $(c,T)$，$K$ 位于由 $M K=(c,T)$ 定义的仿射子空间中，其维度为\n   $$n-\\operatorname{rank}(M)\n     =n-[(n-k_0)+m]\n     =k_0-m.$$\n\n4. 因此，最终的最小熵是\n   $$H_{\\min}(K\\mid E,A,T)=k_0-m.$$", "answer": "$$\\boxed{k_0 - m}$$", "id": "110640"}, {"introduction": "在掌握了信息泄露的基本量化方法后，我们将转向一个更具动态性的场景。此练习将分析经典的 Cascade 协议，这是一种著名的信息协调方法。通过分析该协议中可能出现的不同概率路径，我们将学习如何计算在多步骤、概率性协议中的总期望信息泄露量，这是为后续隐私放大阶段设定正确参数的一项关键技能[@problem_id:110716]。", "problem": "在量子密钥分发（QKD）中，Alice和Bob两方生成一个共享的密钥。由于量子信道的非理想性或窃听者的存在，Bob的密钥通常是Alice密钥的一个含噪版本。为了建立完全相同的密钥，他们执行一个经典的后处理程序，包括信息协商和隐私放大。\n\n信息协商旨在识别并纠正他们密钥中的错误。一个常见的协议是Cascade协议。然而，由于该协议涉及奇偶校验位的公开通信，它会向潜在的窃听者Eve泄露一些信息。必须量化泄露的信息量，以便执行隐私放大。隐私放大是一个缩短密钥以移除Eve可能获得的任何部分信息的步骤。\n\n考虑一个简化的场景，其中Alice和Bob共享一个长度为 $N$ 位的筛选密钥。与Alice的密钥相比，Bob的密钥在随机位置上恰好包含两个比特翻转错误。他们使用一个两轮的Cascade协议进行纠错。协议过程如下：\n\n1.  **第一轮：**将长度为 $N$ 位的密钥分成 $N/k_1$ 个大小为 $k_1$ 的块。Alice和Bob交换每个块的奇偶校验值。\n    *   如果一个块的奇偶校验值不同，则它包含奇数个错误。对该块执行二分查找以定位并纠正一个错误。此查找会额外揭示 $\\log_2(k_1)$ 个奇偶校验位。\n    *   如果两个错误在这一轮中被定位并纠正，协议终止。\n    *   如果两个错误在同一个块中，它们的奇偶校验值与无错误情况相匹配，因此在这一轮中不会发现错误。协议进入第二轮。\n\n2.  **第二轮：**在这一轮开始之前，整个 $N$ 位的密钥以Alice和Bob都知道的方式进行随机置换。这会重新随机化剩余两个错误的位置。然后将密钥分成 $N/k_2$ 个大小为 $k_2$ 的块，并使用新的块大小重复第一轮的纠错过程。\n    *   在这一轮中，对大小为 $k_2$ 的块进行二分查找会额外揭示 $\\log_2(k_2)$ 个奇偶校验位。\n    *   如果找到错误，协议终止。如果未找到，协议失败终止，密钥被丢弃。\n\n对于此问题，假设密钥长度 $N$ 是块大小 $k_1$ 和 $k_2$ 的倍数，并且 $k_1$ 和 $k_2$ 都是2的幂。两个错误的初始位置是从所有可能的位置对中均匀随机选择的。\n\n总信息泄露量定义为在协议执行过程中通过公共信道揭示的奇偶校验位的总数。计算预期的总信息泄露量，并用 $N$、$k_1$ 和 $k_2$ 表示你的答案。", "solution": "在两轮Cascade协议中，预期的总信息泄露量是通过考虑基于两个错误的初始位置和第二轮中的置换的不同情况来推导的。泄露量包括初始块的奇偶校验位和来自二分查找的额外奇偶校验位。\n\n**步骤1：定义概率和泄露分量**\n- 设 $q_1$ 为在第一轮中两个错误位于同一块中的概率。在同一个块中选择两个位置的方式有 $\\frac{N}{k_1} \\binom{k_1}{2}$ 种，而选择任意两个位置的总方式有 $\\binom{N}{2}$ 种。因此，\n  \n$$\n  q_1 = \\frac{\\frac{N}{k_1} \\cdot \\frac{k_1(k_1-1)}{2}}{\\frac{N(N-1)}{2}} = \\frac{k_1-1}{N-1}.\n  $$\n\n  在第一轮中错误位于不同块的概率是 $p_1 = 1 - q_1 = \\frac{N - k_1}{N-1}$。\n\n- 如果进入第二轮（以概率 $q_1$ 发生），则应用随机置换。在第二轮中两个错误位于同一块中的概率是\n  \n$$\n  q_2 = \\frac{k_2-1}{N-1},\n  $$\n\n  而它们位于不同块的概率是 $p_2 = 1 - q_2 = \\frac{N - k_2}{N-1}$。\n\n**步骤2：第一轮中的泄露量**\n- 第一轮中初始块的奇偶校验总是泄露 $\\frac{N}{k_1}$ 位。\n- 如果错误位于不同的块中（概率为 $p_1$），则执行两次二分查找，每次揭示 $\\log_2 k_1$ 位，因此额外泄露 $2 \\log_2 k_1$ 位。\n- 如果错误位于同一块中（概率为 $q_1$），则不执行二分查找，因此没有额外的位被泄露。\n- 因此，第一轮的泄露量为：\n  \n$$\n  L_1 = \\begin{cases}\n    \\frac{N}{k_1} + 2 \\log_2 k_1 & \\text{概率为 } p_1, \\\\\n    \\frac{N}{k_1} & \\text{概率为 } q_1.\n  \\end{cases}\n  $$\n\n\n**步骤3：第二轮中的泄露量（仅当第一轮失败时）**\n- 第二轮以概率 $q_1$ 发生。初始块的奇偶校验泄露 $\\frac{N}{k_2}$ 位。\n- 如果在第二轮中错误位于不同的块中（概率为 $p_2$），则执行两次二分查找，额外泄露 $2 \\log_2 k_2$ 位。\n- 如果它们在同一个块中（概率为 $q_2$），则不执行二分查找。\n- 因此，第二轮的泄露量为：\n  \n$$\n  L_2 = \\begin{cases}\n    \\frac{N}{k_2} + 2 \\log_2 k_2 & \\text{概率为 } p_2, \\\\\n    \\frac{N}{k_2} & \\text{概率为 } q_2.\n  \\end{cases}\n  $$\n\n\n**步骤4：预期的总泄露量**\n预期的泄露量为：\n\n$$\n\\mathbb{E}[L] = \\mathbb{E}[L_1] + q_1 \\cdot \\mathbb{E}[L_2],\n$$\n\n因为 $L_2$ 仅在第二轮发生时（概率为 $q_1$）才会被泄露。\n\n- 计算 $\\mathbb{E}[L_1]$：\n  \n$$\n  \\mathbb{E}[L_1] = p_1 \\left( \\frac{N}{k_1} + 2 \\log_2 k_1 \\right) + q_1 \\left( \\frac{N}{k_1} \\right) = \\frac{N}{k_1} + 2 p_1 \\log_2 k_1.\n  $$\n\n\n- 计算 $\\mathbb{E}[L_2]$：\n  \n$$\n  \\mathbb{E}[L_2] = p_2 \\left( \\frac{N}{k_2} + 2 \\log_2 k_2 \\right) + q_2 \\left( \\frac{N}{k_2} \\right) = \\frac{N}{k_2} + 2 p_2 \\log_2 k_2.\n  $$\n\n\n- 代入：\n  \n$$\n  \\mathbb{E}[L] = \\left( \\frac{N}{k_1} + 2 p_1 \\log_2 k_1 \\right) + q_1 \\left( \\frac{N}{k_2} + 2 p_2 \\log_2 k_2 \\right).\n  $$\n\n\n**步骤5：代入概率**\n- $p_1 = \\frac{N - k_1}{N-1}$, $q_1 = \\frac{k_1 - 1}{N-1}$, $p_2 = \\frac{N - k_2}{N-1}$。\n- 因此，\n  \n$$\n  \\mathbb{E}[L] = \\frac{N}{k_1} + 2 \\cdot \\frac{N - k_1}{N-1} \\log_2 k_1 + \\frac{k_1 - 1}{N-1} \\left( \\frac{N}{k_2} + 2 \\cdot \\frac{N - k_2}{N-1} \\log_2 k_2 \\right).\n  $$\n\n\n**步骤6：简化表达式**\n展开各项：\n\n$$\n\\mathbb{E}[L] = \\frac{N}{k_1} + \\frac{2(N - k_1)}{N-1} \\log_2 k_1 + \\frac{k_1 - 1}{N-1} \\cdot \\frac{N}{k_2} + \\frac{k_1 - 1}{N-1} \\cdot 2 \\cdot \\frac{N - k_2}{N-1} \\log_2 k_2.\n$$\n\n简化第三项：\n\n$$\n\\frac{k_1 - 1}{N-1} \\cdot \\frac{N}{k_2} = \\frac{N(k_1 - 1)}{k_2(N-1)},\n$$\n\n以及第四项：\n\n$$\n\\frac{k_1 - 1}{N-1} \\cdot 2 \\cdot \\frac{N - k_2}{N-1} \\log_2 k_2 = \\frac{2(k_1 - 1)(N - k_2)}{(N-1)^2} \\log_2 k_2.\n$$\n\n最终表达式为：\n\n$$\n\\mathbb{E}[L] = \\frac{N}{k_1} + \\frac{N(k_1 - 1)}{k_2(N-1)} + \\frac{2(N - k_1)}{N-1} \\log_2 k_1 + \\frac{2(k_1 - 1)(N - k_2)}{(N-1)^2} \\log_2 k_2.\n$$", "answer": "$$\\boxed{\\dfrac{N}{k_1} + \\dfrac{N(k_1 - 1)}{k_2(N-1)} + \\dfrac{2(N - k_1)}{N-1} \\log_2 k_1 + \\dfrac{2(k_1 - 1)(N - k_2)}{(N-1)^2} \\log_2 k_2}$$", "id": "110716"}, {"introduction": "安全协议的稳健性往往取决于对微妙细节的处理。本练习探讨了一个常见但危险的错误：重用哈希函数的公共种子。我们将量化当同一个种子被用来哈希两个相关的原始密钥时所造成的安全损失，从而揭示这种重用行为如何为窃听者创造一个可利用的关联，进而破坏密钥的安全性[@problem_id:110739]。", "problem": "在涉及密码密钥生成的场景中，例如在量子密钥分发（QKD）中，隐私放大是一个至关重要的过程，它用于从一个更长的、部分泄露的原始密钥中生成一个短的、高度安全的密钥。这通常通过使用一个公开选择种子的2-一致哈希函数来完成。本问题探讨了在相关操作中重复使用相同哈希函数种子的安全性影响。\n\n设 $X_1 \\in \\{0,1\\}^n$ 是一个原始密钥，它是一个长度为 $n$ 的均匀随机二进制字符串。第二个二进制字符串 $X_2 \\in \\{0,1\\}^n$ 是通过将 $X_1$ 经过一个比特翻转概率为 $p \\in (0, 1/2)$ 的二元对称信道（BSC）生成的。也就是说，$X_2 = X_1 \\oplus \\Delta$，其中 $\\Delta$ 是一个 $n$ 比特的错误向量，其分量是参数为 $p$ 的独立同分布的伯努利随机变量。\n\n通过从一个可能的种子集合中均匀随机地选择一个种子 $S$ 来选择一个哈希函数 $h_S: \\{0,1\\}^n \\to \\{0,1\\}^m$。对应的哈希函数族是线性的和2-一致的。这意味着两个性质：\n1.  对于任何种子 $s$，$h_s$ 是一个线性映射：$h_s(x \\oplus y) = h_s(x) \\oplus h_s(y)$。\n2.  对于任何非零向量 $z \\in \\{0,1\\}^n$，在随机选择种子 $S$ 的情况下 $h_S(z)=0$ 的概率恰好是 $P_S(h_S(z)=0) = 2^{-m}$。\n\nAlice 计算她的最终密钥为 $K_1 = h_S(X_1)$。一个窃听者 Eve 设法获知了使用相同种子 $S$ 生成的相关密钥 $K_2 = h_S(X_2)$。Eve 所掌握的全部信息包括对 $(K_2, S)$。\n\nAlice 的密钥 $K_1$ 相对于 Eve 所掌握信息的安全性由条件最小熵 $H_{\\min}(K_1|K_2,S)$ 来量化。最小熵是根据攻击者猜测密钥的最大成功概率 $P_{guess}$ 来定义的：\n$$H_{\\min}(K_1|K_2,S) = -\\log_2 P_{guess}(K_1|K_2,S)$$\n其中\n$$P_{guess}(K_1|K_2,S) = \\mathbb{E}_{(k_2,s) \\sim P_{K_2,S}} \\left[ \\max_{k_1 \\in \\{0,1\\}^m} P(K_1=k_1 | K_2=k_2, S=s) \\right]$$\n\n计算条件最小熵 $H_{\\min}(K_1|K_2,S)$。为此，你可以假设对于任何给定的种子 $s$ 和值 $k_2$，攻击者猜测 $K_1$ 的最优策略是猜测 $K_1=k_2$。这意味着你可以使用如下简化：\n$$\\max_{k_1 \\in \\{0,1\\}^m} P(K_1=k_1|K_2=k_2, S=s) = P(K_1=k_2|K_2=k_2, S=s)$$", "solution": "我们已知：\n- $X_1$ 在 $\\{0,1\\}^n$ 上均匀分布。\n- $X_2 = X_1 \\oplus \\Delta$，其中 $\\Delta$ 由独立同分布的伯努利($p$)分量组成。\n- 哈希函数 $h_S$ 是线性的和2-一致的，因此对于任何非零 $z \\in \\{0,1\\}^n$，$P_S(h_S(z) = 0) = 2^{-m}$。\n- $K_1 = h_S(X_1)$ 且 $K_2 = h_S(X_2)$。\n- Eve 知道 $(K_2, S)$，我们需要计算 $H_{\\min}(K_1 | K_2, S) = -\\log_2 P_{\\text{guess}}(K_1 | K_2, S)$。\n- 最优猜测策略给出 $P_{\\text{guess}}(K_1 | K_2, S) = \\mathbb{E}_{(k_2,s) \\sim P_{K_2,S}} \\left[ P(K_1 = k_2 | K_2 = k_2, S = s) \\right]$。\n\n利用 $h_S$ 的线性性质：\n\n$$\nK_2 = h_S(X_2) = h_S(X_1 \\oplus \\Delta) = h_S(X_1) \\oplus h_S(\\Delta) = K_1 \\oplus h_S(\\Delta).\n$$\n\n因此，$K_1 = K_2 \\oplus h_S(\\Delta)$。对于固定的 $S = s$ 和 $K_2 = k_2$：\n\n$$\nK_1 = k_2 \\oplus h_s(\\Delta).\n$$\n\n事件 $K_1 = k_2$ 等价于 $h_s(\\Delta) = 0$。因此：\n\n$$\nP(K_1 = k_2 | K_2 = k_2, S = s) = P(h_s(\\Delta) = 0 | S = s).\n$$\n\n由于 $\\Delta$ 独立于 $S$：\n\n$$\nP(h_s(\\Delta) = 0 | S = s) = P(h_s(\\Delta) = 0).\n$$\n\n代入 $P_{\\text{guess}}$：\n\n$$\nP_{\\text{guess}}(K_1 | K_2, S) = \\mathbb{E}_{(k_2,s)} \\left[ P(h_s(\\Delta) = 0) \\right].\n$$\n\n内部的概率不依赖于 $k_2$，所以：\n\n$$\nP_{\\text{guess}}(K_1 | K_2, S) = \\mathbb{E}_{s} \\left[ P(h_s(\\Delta) = 0) \\right] = \\mathbb{E}_S \\left[ P(h_S(\\Delta) = 0) \\right].\n$$\n\n根据全期望定律：\n\n$$\n\\mathbb{E}_S \\left[ P(h_S(\\Delta) = 0) \\right] = \\mathbb{E}_S \\left[ \\sum_{\\delta \\in \\{0,1\\}^n} P(\\Delta = \\delta) \\cdot \\mathbf{1}_{\\{h_S(\\delta) = 0\\}} \\right].\n$$\n\n交换求和与期望（因为 $\\Delta$ 独立于 $S$）：\n\n$$\n= \\sum_{\\delta \\in \\{0,1\\}^n} P(\\Delta = \\delta) \\cdot \\mathbb{E}_S \\left[ \\mathbf{1}_{\\{h_S(\\delta) = 0\\}} \\right] = \\sum_{\\delta} P(\\Delta = \\delta) \\cdot P_S(h_S(\\delta) = 0).\n$$\n\n将求和拆分为 $\\delta = 0$ 和 $\\delta \\neq 0$ 两部分：\n- 若 $\\delta = 0$，根据线性性质，$h_S(0) = 0$ 恒成立，所以 $P_S(h_S(0) = 0) = 1$。\n- 若 $\\delta \\neq 0$，根据2-一致性，有 $P_S(h_S(\\delta) = 0) = 2^{-m}$。\n\n因此：\n\n$$\n\\sum_{\\delta} P(\\Delta = \\delta) P_S(h_S(\\delta) = 0) = P(\\Delta = 0) \\cdot 1 + \\sum_{\\delta \\neq 0} P(\\Delta = \\delta) \\cdot 2^{-m}.\n$$\n\n现在：\n\n$$\nP(\\Delta = 0) = (1-p)^n,\n$$\n\n\n$$\n\\sum_{\\delta \\neq 0} P(\\Delta = \\delta) = 1 - P(\\Delta = 0) = 1 - (1-p)^n.\n$$\n\n所以：\n\n$$\n\\mathbb{E}_S \\left[ P(h_S(\\Delta) = 0) \\right] = (1-p)^n \\cdot 1 + (1 - (1-p)^n) \\cdot 2^{-m}.\n$$\n\n因此：\n\n$$\nP_{\\text{guess}}(K_1 | K_2, S) = (1-p)^n + 2^{-m} (1 - (1-p)^n).\n$$\n\n条件最小熵为：\n\n$$\nH_{\\min}(K_1 | K_2, S) = -\\log_2 P_{\\text{guess}}(K_1 | K_2, S) = -\\log_2 \\left( (1-p)^n + 2^{-m} (1 - (1-p)^n) \\right).\n$$", "answer": "$$\\boxed{ -\\log_{2} \\left( (1-p)^{n} + 2^{-m} \\cdot \\left(1 - (1-p)^{n}\\right) \\right) }$$", "id": "110739"}]}