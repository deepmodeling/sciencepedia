{"hands_on_practices": [{"introduction": "E91协议的核心在于利用贝尔测试来验证量子信道的安全性。第一个练习将引导我们完成一个基础但至关重要的计算：在理想情况下，针对纠缠的单态（singlet state），计算CHSH（Clauser-Horne-Shimony-Holt）值。通过这个练习，我们将亲手验证量子力学如何预测对贝尔不等式的最大程度的违背，并得到著名的“Tsirelson界限”$2\\sqrt{2}$，这是评估信道安全性的基准。[@problem_id:152753]", "problem": "由 Artur Ekert 于 1991 年提出的 E91 量子密钥分发协议，利用量子纠缠的特性来确保安全通信。该协议的一个关键部分涉及两方，Alice 和 Bob，他们对共享的纠缠量子比特对进行贝尔测试，以验证其量子信道的安全性。此测试检验是否违背了克劳泽-霍恩-西蒙尼-霍尔特（CHSH）不等式，该不等式是相关性可以用局域隐变量理论解释的必要条件。\n\n假设 Alice 和 Bob 共享大量的量子比特对，每个都制备在单态上：\n$$|\\psi^{-}\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle - |10\\rangle)$$\n为了进行贝尔测试，Alice 和 Bob 各自沿着两个选定方向之一测量其量子比特的自旋。在 x-z 平面内，与 z 轴正方向成 $\\theta$ 角的方向向量 $\\vec{u}$ 上的自旋投影测量算符由 $\\sigma(\\theta) = \\vec{u} \\cdot \\vec{\\sigma} = \\sin\\theta \\, \\sigma_x + \\cos\\theta \\, \\sigma_z$ 给出，其中 $\\vec{\\sigma} = (\\sigma_x, \\sigma_y, \\sigma_z)$ 是泡利矩阵矢量。\n\nAlice 在两个测量设置 $A = \\sigma(\\theta_A)$ 和 $A' = \\sigma(\\theta_{A'})$ 之间随机选择，其角度分别为 $\\theta_A = 0$ 和 $\\theta_{A'} = \\pi/2$。\n类似地，Bob 在他的两个设置 $B = \\sigma(\\theta_B)$ 和 $B' = \\sigma(\\theta_{B'})$ 之间随机选择，其角度分别为 $\\theta_B = \\pi/4$ 和 $\\theta_{B'} = 3\\pi/4$。\n\nCHSH 参数 $S$ 是由这些测量结果乘积的期望值构建的：\n$$S = E(A, B) - E(A, B') + E(A', B) + E(A', B')$$\n其中，例如 $E(A, B) = \\langle \\psi^{-} | A \\otimes B | \\psi^{-} \\rangle$。请计算在给定状态和测量设置下 $S$ 的值。", "solution": "单态由以下公式给出：\n$$|\\psi^{-}\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle - |10\\rangle)$$\n\n测量算符定义为 $\\sigma(\\theta) = \\sin\\theta \\, \\sigma_x + \\cos\\theta \\, \\sigma_z$。对于 Alice：\n- $A = \\sigma(0) = \\cos(0) \\, \\sigma_z = \\sigma_z$ (因为 $\\sin(0)=0$)\n- $A' = \\sigma(\\pi/2) = \\sin(\\pi/2) \\, \\sigma_x = \\sigma_x$ (因为 $\\cos(\\pi/2)=0$)\n\n对于 Bob：\n- $B = \\sigma(\\pi/4) = \\sin(\\pi/4) \\, \\sigma_x + \\cos(\\pi/4) \\, \\sigma_z = \\frac{\\sqrt{2}}{2} (\\sigma_x + \\sigma_z)$\n- $B' = \\sigma(3\\pi/4) = \\sin(3\\pi/4) \\, \\sigma_x + \\cos(3\\pi/4) \\, \\sigma_z = \\frac{\\sqrt{2}}{2} (\\sigma_x - \\sigma_z)$\n\n对于单态，期望值由以下公式给出：\n$$\\langle \\psi^{-} | (\\vec{a} \\cdot \\vec{\\sigma}) \\otimes (\\vec{b} \\cdot \\vec{\\sigma}) | \\psi^{-} \\rangle = -\\vec{a} \\cdot \\vec{b}$$\n其中 $\\vec{a}$ 和 $\\vec{b}$ 是测量方向上的单位向量。\n\nx-z 平面内的方向向量为：\n- 对于 $A$：$\\vec{a}_A = (0, 0, 1)$ (沿 z 轴)\n- 对于 $A'$：$\\vec{a}_{A'} = (1, 0, 0)$ (沿 x 轴)\n- 对于 $B$：$\\vec{b}_B = (\\sin(\\pi/4), 0, \\cos(\\pi/4)) = \\left( \\frac{\\sqrt{2}}{2}, 0, \\frac{\\sqrt{2}}{2} \\right)$\n- 对于 $B'$：$\\vec{b}_{B'} = (\\sin(3\\pi/4), 0, \\cos(3\\pi/4)) = \\left( \\frac{\\sqrt{2}}{2}, 0, -\\frac{\\sqrt{2}}{2} \\right)$\n\n现在计算每个期望值：\n- $E(A, B) = -\\vec{a}_A \\cdot \\vec{b}_B = - \\left[ (0)\\left(\\frac{\\sqrt{2}}{2}\\right) + (0)(0) + (1)\\left(\\frac{\\sqrt{2}}{2}\\right) \\right] = -\\frac{\\sqrt{2}}{2}$\n- $E(A, B') = -\\vec{a}_A \\cdot \\vec{b}_{B'} = - \\left[ (0)\\left(\\frac{\\sqrt{2}}{2}\\right) + (0)(0) + (1)\\left(-\\frac{\\sqrt{2}}{2}\\right) \\right] = - \\left(-\\frac{\\sqrt{2}}{2}\\right) = \\frac{\\sqrt{2}}{2}$\n- $E(A', B) = -\\vec{a}_{A'} \\cdot \\vec{b}_B = - \\left[ (1)\\left(\\frac{\\sqrt{2}}{2}\\right) + (0)(0) + (0)\\left(\\frac{\\sqrt{2}}{2}\\right) \\right] = -\\frac{\\sqrt{2}}{2}$\n- $E(A', B') = -\\vec{a}_{A'} \\cdot \\vec{b}_{B'} = - \\left[ (1)\\left(\\frac{\\sqrt{2}}{2}\\right) + (0)(0) + (0)\\left(-\\frac{\\sqrt{2}}{2}\\right) \\right] = -\\frac{\\sqrt{2}}{2}$\n\nCHSH 参数为：\n$$S = E(A, B) - E(A, B') + E(A', B) + E(A', B')$$\n代入数值：\n$$S = \\left(-\\frac{\\sqrt{2}}{2}\\right) - \\left(\\frac{\\sqrt{2}}{2}\\right) + \\left(-\\frac{\\sqrt{2}}{2}\\right) + \\left(-\\frac{\\sqrt{2}}{2}\\right) = -\\frac{\\sqrt{2}}{2} - \\frac{\\sqrt{2}}{2} - \\frac{\\sqrt{2}}{2} - \\frac{\\sqrt{2}}{2} = -4 \\cdot \\frac{\\sqrt{2}}{2} = -2\\sqrt{2}$$", "answer": "$$\\boxed{-2\\sqrt{2}}$$", "id": "152753"}, {"introduction": "在建立了理想情况下的基准后，我们现在来探讨E91协议的安全性是如何体现的。这个练习模拟了一种经典的窃听场景，即“拦截-重发”（intercept-resend）攻击，其中窃听者Eve会拦截、测量并重新发送一个伪造的量子比特给Bob。通过计算在这种攻击下Alice和Bob会观察到的CHSH值，我们将看到量子关联是如何被破坏的，从而导致贝尔不等式的违背消失，Eve的存在也因此暴露。[@problem_id:152778]", "problem": "在用于量子密钥分发的E91协议中，Alice和Bob共享大量纠缠量子比特对以建立一个秘密密钥。该协议的一个关键部分是通过检查共享量子比特对的一个子集是否违背贝尔不等式，来测试窃听者(Eve)的存在。\n\n考虑源产生处于单态的量子比特对：\n$$|\\psi^-\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle - |10\\rangle)$$\n一个量子比特发送给Alice，另一个发送给Bob。为了测试信道的安全性，他们根据Clauser-Horne-Shimony-Holt (CHSH)形式体系进行测量。Alice在两个测量可观测量$A_1$和$A_2$之间进行选择，Bob在$B_1$和$B_2$之间进行选择。这些可观测量定义如下：\n- Alice的可观测量：$A_1 = \\sigma_Z$, $A_2 = \\sigma_X$\n- Bob的可观测量：$B_1 = \\frac{1}{\\sqrt{2}}(\\sigma_Z + \\sigma_X)$, $B_2 = \\frac{1}{\\sqrt{2}}(-\\sigma_Z + \\sigma_X)$\n\n其中 $\\sigma_X, \\sigma_Y, \\sigma_Z$是标准泡利矩阵。测试的有效性由CHSH值$S$量化，定义为：\n$$S = \\langle A_1 B_1 \\rangle - \\langle A_1 B_2 \\rangle + \\langle A_2 B_1 \\rangle + \\langle A_2 B_2 \\rangle$$\n其中 $\\langle \\cdot \\rangle$表示相对于共享量子态的期望值。对于一个纯单态，这些设置得出$S = -2\\sqrt{2}$，最大程度地违背了经典界限$|S| \\le 2$。\n\n现在，假设一个窃听者Eve对通往Bob的信道执行拦截重发攻击。对于每一个从源传输到Bob的量子比特，Eve都会拦截它，在计算基$\\{|0\\rangle, |1\\rangle\\}$中进行测量，然后根据她的测量结果制备一个新的量子比特并发送给Bob。具体来说，如果Eve测量到量子比特处于$|0\\rangle$态，她就发送一个处于$|0\\rangle$态的新量子比特给Bob。如果她测量到$|1\\rangle$，她就发送$|1\\rangle$。\n\n计算在这种特定的拦截重发攻击下，Alice和Bob将观察到的CHSH参数$S$的值。", "solution": "我们首先确定Alice和Bob共享的攻击后状态$\\rho_{AB}$。Eve在计算基中测量Bob的量子比特，并重发该结果。对于单态，对Bob的量子比特进行计算基测量会使Alice的量子比特塌缩到相反的计算基态。因此，他们以 $\\frac{1}{2}$ 的概率最终处于 $|1\\rangle_A|0\\rangle_B$，并以 $\\frac{1}{2}$ 的概率处于 $|0\\rangle_A|1\\rangle_B$。因此：\n$$ \\rho_{AB} = \\frac{1}{2}\\left(|10\\rangle\\langle 10|+|01\\rangle\\langle 01|\\right) $$\n\n我们现在计算每个关联项：\n1.  $\\langle A_1 B_1 \\rangle$，其中 $A_1=\\sigma_Z$ 且 $B_1=\\frac{1}{\\sqrt{2}}(\\sigma_Z+\\sigma_X)$。\n   对于 $|10\\rangle$：$\\langle\\sigma_Z\\rangle_A=-1$, $\\langle\\sigma_Z\\rangle_B=+1$, $\\langle\\sigma_X\\rangle_B=0$ $\\implies$ $\\langle B_1 \\rangle = \\frac{1}{\\sqrt{2}}(1+0)=\\frac{1}{\\sqrt{2}}$。乘积为 $-1 \\cdot \\frac{1}{\\sqrt{2}} = -\\frac{1}{\\sqrt{2}}$。\n   对于 $|01\\rangle$：$\\langle\\sigma_Z\\rangle_A=+1$, $\\langle\\sigma_Z\\rangle_B=-1$, $\\langle\\sigma_X\\rangle_B=0$ $\\implies$ $\\langle B_1 \\rangle = -\\frac{1}{\\sqrt{2}}$。乘积为 $+1 \\cdot (-\\frac{1}{\\sqrt{2}}) = -\\frac{1}{\\sqrt{2}}$。\n   取平均得到：\n   $$ \\langle A_1 B_1 \\rangle = \\frac{1}{2}\\left(-\\frac{1}{\\sqrt{2}}-\\frac{1}{\\sqrt{2}}\\right) = -\\frac{1}{\\sqrt{2}} $$\n\n2.  $\\langle A_1 B_2 \\rangle$，其中 $B_2=\\frac{1}{\\sqrt{2}}(-\\sigma_Z+\\sigma_X)$。\n   对于 $|10\\rangle$：$\\langle B_2 \\rangle = \\frac{1}{\\sqrt{2}}(-1+0)=-\\frac{1}{\\sqrt{2}}$, $\\langle\\sigma_Z\\rangle_A=-1$ $\\implies$ $(-1)(-\\frac{1}{\\sqrt{2}})=+\\frac{1}{\\sqrt{2}}$。\n   对于 $|01\\rangle$：$\\langle B_2 \\rangle = \\frac{1}{\\sqrt{2}}(1+0)=\\frac{1}{\\sqrt{2}}$, $\\langle\\sigma_Z\\rangle_A=+1$ $\\implies$ $+\\frac{1}{\\sqrt{2}}$。\n   取平均得到：\n   $$ \\langle A_1 B_2 \\rangle = \\frac{1}{2}\\left(\\frac{1}{\\sqrt{2}}+\\frac{1}{\\sqrt{2}}\\right) = +\\frac{1}{\\sqrt{2}} $$\n\n3.  $\\langle A_2 B_1 \\rangle$，其中 $A_2=\\sigma_X$。对于$|0\\rangle$或$|1\\rangle$，$\\langle\\sigma_X\\rangle=0$，所以：\n   $$ \\langle A_2 B_1 \\rangle = 0, \\qquad \\langle A_2 B_2 \\rangle = 0 $$\n\n最终CHSH参数为：\n$$ S = \\langle A_1 B_1 \\rangle - \\langle A_1 B_2 \\rangle + \\langle A_2 B_1 \\rangle + \\langle A_2 B_2 \\rangle = -\\frac{1}{\\sqrt{2}} - \\frac{1}{\\sqrt{2}} + 0 + 0 = -\\frac{2}{\\sqrt{2}} = -\\sqrt{2} $$", "answer": "$$\\boxed{-\\sqrt{2}}$$", "id": "152778"}, {"introduction": "除了应对蓄意的窃听攻击，任何现实世界中的量子通信协议都必须考虑环境噪声的影响。最后一个练习将我们带入更实际的场景，探讨当量子信道存在噪声时会发生什么，这里以退偏振信道（depolarizing channel）为例。通过计算在这种噪声模型下CHSH值的最大可能值与噪声概率$p$之间的关系，我们可以理解E91协议的鲁棒性及其极限。这个计算揭示了一个关键的噪声阈值，一旦超过该阈值，协议的安全性将无法得到保障。[@problem_id:152873]", "problem": "在用于量子密钥分发的E91协议中，Alice和Bob共享大量纠缠的双量子比特对。为确保其通信信道的安全性，他们对这些量子比特对的一个子集进行统计检验，以检查是否存在对贝尔不等式（通常是克劳泽-霍恩-西蒙尼-霍尔特（CHSH）不等式）的违背。一个显著的违背证实了量子关联的存在，并对窃听者可能已经获得的信息量给出了限制。\n\n假设Alice和Bob理想情况下共享处于单态 $|\\psi^-\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle - |10\\rangle)$ 的量子对。然而，该量子信道是有噪声的。具体来说，在Bob进行测量之前，每个量子对中属于Bob的量子比特会经过一个退极化信道。单量子比特退极化信道 $\\mathcal{E}_p$ 对任意单量子比特态 $\\rho_B$ 的作用描述如下：\n$$ \\mathcal{E}_p(\\rho_B) = (1-p)\\rho_B + p \\frac{I_B}{2} $$\n其中 $p$ 是退极化概率（$0 \\le p \\le 1$），$I_B$ 是Bob的希尔伯特空间上的单位算符。\n\nAlice和Bob沿着选定的方向进行自旋投影的测量。这些测量对应于可观测量 $A_i = \\vec{a}_i \\cdot \\vec{\\sigma}$（对于Alice）和 $B_j = \\vec{b}_j \\cdot \\vec{\\sigma}$（对于Bob），其中 $\\vec{a}_i$ 和 $\\vec{b}_j$ 是 $\\mathbb{R}^3$ 中的单位向量，$\\vec{\\sigma}=(\\sigma_x, \\sigma_y, \\sigma_z)$ 是泡利矩阵的矢量。他们各自使用两种测量设置（$i, j \\in \\{1, 2\\}$）来检验CHSH不等式。CHSH值是以下算符的期望值：\n$$ S = A_1 \\otimes B_1 + A_1 \\otimes B_2 + A_2 \\otimes B_1 - A_2 \\otimes B_2 $$\n计算 $\\langle S \\rangle$ 在所有可能的测量方向 $(\\vec{a}_1, \\vec{a}_2, \\vec{b}_1, \\vec{b}_2)$ 上所能达到的最大值，该值应为退极化概率 $p$ 的函数。", "solution": "初始状态为单态：\n\n$$\n|\\psi^-\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle - |10\\rangle), \\quad \\rho_{AB} = |\\psi^-\\rangle\\langle\\psi^-|.\n$$\n\n在退极化信道作用于Bob的量子比特后，状态变为：\n\n$$\n\\rho_{AB}' = (I_A \\otimes \\mathcal{E}_p)(\\rho_{AB}) = (1-p) \\rho_{AB} + p \\left( \\frac{I_A}{2} \\otimes \\frac{I_B}{2} \\right),\n$$\n\n因为Alice的约化态为 $\\rho_A = \\operatorname{Tr}_B(\\rho_{AB}) = I_A / 2$。\n\n算符 $O$ 的期望值为：\n\n$$\n\\langle O \\rangle = \\operatorname{Tr}(\\rho_{AB}' O) = (1-p) \\operatorname{Tr}(\\rho_{AB} O) + p \\operatorname{Tr}\\left( \\frac{I_{AB}}{4} O \\right).\n$$\n\n对于CHSH算符：\n\n$$\nS = A_1 \\otimes B_1 + A_1 \\otimes B_2 + A_2 \\otimes B_1 - A_2 \\otimes B_2,\n$$\n\n每一项 $A_i \\otimes B_j$ 的迹都为零，因为 $A_i = \\vec{a}_i \\cdot \\vec{\\sigma}$ 和 $B_j = \\vec{b}_j \\cdot \\vec{\\sigma}$ 都是无迹的（泡利矩阵是无迹的）。因此：\n\n$$\n\\operatorname{Tr}(A_i \\otimes B_j) = \\operatorname{Tr}(A_i) \\operatorname{Tr}(B_j) = 0,\n$$\n\n并且：\n\n$$\n\\langle A_i \\otimes B_j \\rangle = (1-p) \\langle A_i \\otimes B_j \\rangle_0,\n$$\n\n其中 $\\langle \\cdot \\rangle_0$ 表示在单态下的期望值。\n\n在单态下：\n\n$$\n\\langle A_i \\otimes B_j \\rangle_0 = -\\vec{a}_i \\cdot \\vec{b}_j.\n$$\n\n因此：\n\n$$\n\\langle A_i \\otimes B_j \\rangle = -(1-p) \\vec{a}_i \\cdot \\vec{b}_j.\n$$\n\nCHSH期望值为：\n\n$$\n\\langle S \\rangle = \\langle A_1 B_1 \\rangle + \\langle A_1 B_2 \\rangle + \\langle A_2 B_1 \\rangle - \\langle A_2 B_2 \\rangle = -(1-p) \\left[ \\vec{a}_1 \\cdot \\vec{b}_1 + \\vec{a}_1 \\cdot \\vec{b}_2 + \\vec{a}_2 \\cdot \\vec{b}_1 - \\vec{a}_2 \\cdot \\vec{b}_2 \\right].\n$$\n\n定义：\n\n$$\nC = \\vec{a}_1 \\cdot \\vec{b}_1 + \\vec{a}_1 \\cdot \\vec{b}_2 + \\vec{a}_2 \\cdot \\vec{b}_1 - \\vec{a}_2 \\cdot \\vec{b}_2.\n$$\n\n那么：\n\n$$\n\\langle S \\rangle = -(1-p) C.\n$$\n\n由于可以自由选择测量方向，通过改变 $\\vec{b}_j \\to -\\vec{b}_j$（这会使 $C \\to -C$）可以反转 $C$ 的符号。因此，$\\langle S \\rangle$ 的最大值为：\n\n$$\n\\max \\langle S \\rangle = (1-p) \\max |C|.\n$$\n\n现在，在单位向量 $\\vec{a}_1, \\vec{a}_2, \\vec{b}_1, \\vec{b}_2$ 上最大化 $C$。将 $C$ 重写为：\n\n$$\nC = \\vec{a}_1 \\cdot (\\vec{b}_1 + \\vec{b}_2) + \\vec{a}_2 \\cdot (\\vec{b}_1 - \\vec{b}_2).\n$$\n\n设 $\\vec{v} = \\vec{b}_1 + \\vec{b}_2$ 和 $\\vec{w} = \\vec{b}_1 - \\vec{b}_2$。那么：\n\n$$\nC = \\vec{a}_1 \\cdot \\vec{v} + \\vec{a}_2 \\cdot \\vec{w}.\n$$\n\n在 $\\vec{a}_1, \\vec{a}_2$（单位向量）上的最大值为：\n\n$$\n\\max C = |\\vec{v}| + |\\vec{w}|,\n$$\n\n当 $\\vec{a}_1 \\parallel \\vec{v}$ 和 $\\vec{a}_2 \\parallel \\vec{w}$ 时取得。现在：\n\n$$\n|\\vec{v}|^2 = |\\vec{b}_1 + \\vec{b}_2|^2 = 2 + 2 \\vec{b}_1 \\cdot \\vec{b}_2, \\quad |\\vec{w}|^2 = |\\vec{b}_1 - \\vec{b}_2|^2 = 2 - 2 \\vec{b}_1 \\cdot \\vec{b}_2.\n$$\n\n设 $x = \\vec{b}_1 \\cdot \\vec{b}_2$，其中 $x \\in [-1, 1]$。那么：\n\n$$\n|\\vec{v}| = \\sqrt{2(1 + x)}, \\quad |\\vec{w}| = \\sqrt{2(1 - x)},\n$$\n\n并且：\n\n$$\n|\\vec{v}| + |\\vec{w}| = \\sqrt{2} \\left( \\sqrt{1 + x} + \\sqrt{1 - x} \\right).\n$$\n\n对函数进行最大化：\n\n$$\nf(x) = \\sqrt{1 + x} + \\sqrt{1 - x}, \\quad x \\in [-1, 1].\n$$\n\n导数为：\n\n$$\nf'(x) = \\frac{1}{2\\sqrt{1+x}} - \\frac{1}{2\\sqrt{1-x}}.\n$$\n\n令 $f'(x) = 0$：\n\n$$\n\\frac{1}{\\sqrt{1+x}} = \\frac{1}{\\sqrt{1-x}} \\implies \\sqrt{1-x} = \\sqrt{1+x} \\implies x = 0.\n$$\n\n在 $x = 0$ 处，$f(0) = 2$。检查边界：$f(1) = \\sqrt{2}$，$f(-1) = \\sqrt{2}$，两者都小于2。因此：\n\n$$\n\\max f(x) = 2,\n$$\n\n并且：\n\n$$\n\\max (|\\vec{v}| + |\\vec{w}|) = \\sqrt{2} \\cdot 2 = 2\\sqrt{2}.\n$$\n\n所以 $\\max |C| = 2\\sqrt{2}$，并且：\n\n$$\n\\max \\langle S \\rangle = (1-p) \\cdot 2\\sqrt{2} = 2\\sqrt{2} (1-p).\n$$", "answer": "$$ \\boxed{2\\sqrt{2}\\left(1 - p\\right)} $$", "id": "152873"}]}