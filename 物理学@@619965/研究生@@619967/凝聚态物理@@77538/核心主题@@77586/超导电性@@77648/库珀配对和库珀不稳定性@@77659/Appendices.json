{"hands_on_practices": [{"introduction": "理解超导转变温度 $T_c$ 的来源是凝聚态物理学的基石。这第一个实践将引导您完成经典的 Bardeen-Cooper-Schrieffer (BCS) 计算，该计算针对一个简化的吸引势 [@problem_id:2977400]。通过求解线性化的能隙方程，您将推导出著名的 $T_c$ 指数公式，从而深刻体会到即使是电子之间微弱的吸引力也能如何导致集体不稳定性。", "problem": "考虑三维金属中的电子，其在费米能级处具有恒定的单自旋态密度 $N(0)$。这些电子通过一种可分离的各向同性 s-波吸引相互作用，该相互作用仅在费米能量周围宽度为 $\\hbar \\omega_D$ 的能量壳层内非零。该相互作用为\n$$\nV_{\\mathbf{k}\\mathbf{k}'}=-V\\,\\Theta\\!\\left(\\hbar\\omega_D-|\\xi_{\\mathbf{k}}|\\right)\\Theta\\!\\left(\\hbar\\omega_D-|\\xi_{\\mathbf{k}'}|\\right),\n$$\n其中 $V>0$，$\\omega_D$ 是德拜角频率，$\\xi_{\\mathbf{k}}$ 是相对于费米能级测量的单粒子能量，$\\Theta(x)$ 是 Heaviside 阶跃函数。\n\n从在转变温度 $T_c$ 处线性化的平均场 Bardeen–Cooper–Schrieffer (BCS) 自洽条件出发，并使用正常态格林函数 $G(\\mathbf{k},i\\epsilon_n)=\\left(i\\epsilon_n-\\xi_{\\mathbf{k}}\\right)^{-1}$（其中费米子 Matsubara 能量为 $\\epsilon_n=(2n+1)\\pi k_B T$），推导出 Cooper 不稳定性的判据，并在弱耦合极限 $0<N(0)V\\ll 1$ 下求解该判据，以获得临界温度的闭合形式解析表达式。你可以假设 $k_B T_c\\ll \\hbar \\omega_D$，因此相关的 Matsubara 求和具有较大的上限截断指数，并可在适当之处使用双伽玛函数 $\\psi(z)$ 和 Euler–Mascheroni 常数 $\\gamma$ 的熟知性质。\n\n答案要求：\n- 以 $N(0)V$ 和基本常数的形式，给出无量纲比值 $k_B T_c/(\\hbar \\omega_D)$ 的单一闭合形式解析表达式。\n- 不要代入常数的数值，也不要四舍五入；因为答案是完全解析的，所以没有有效数字的要求。\n- 最终的方框答案内不要包含任何单位。", "solution": "确定超导转变温度 $T_c$ 的出发点是线性化的 Bardeen–Cooper–Schrieffer (BCS) 能隙方程。在 Matsubara 形式中，该方程描述了在 $T=T_c$ 时超导能隙 $\\Delta_{\\mathbf{k}}$ 出现非平凡解的条件。该方程是一个本征值问题，当最大本征值达到 1 时，不稳定性发生。方程由下式给出：\n$$\n\\Delta_{\\mathbf{k}} = - k_B T_c \\sum_{\\mathbf{k}', n} V_{\\mathbf{k}\\mathbf{k}'} G(\\mathbf{k}', i\\epsilon_n) G(-\\mathbf{k}', -i\\epsilon_n) \\Delta_{\\mathbf{k}'}\n$$\n其中 $\\epsilon_n = (2n+1)\\pi k_B T_c$ 是整数 $n$ 对应的费米子 Matsubara 频率，而 $G(\\mathbf{k}, i\\epsilon_n) = (i\\epsilon_n - \\xi_{\\mathbf{k}})^{-1}$ 是正常态格林函数。单粒子能量 $\\xi_{\\mathbf{k}}$ 是相对于费米能级测量的，对于各向同性系统，我们有 $\\xi_{-\\mathbf{k}} = \\xi_{\\mathbf{k}}$。格林函数的乘积是：\n$$\nG(\\mathbf{k}', i\\epsilon_n) G(-\\mathbf{k}', -i\\epsilon_n) = \\frac{1}{i\\epsilon_n - \\xi_{\\mathbf{k}'}} \\frac{1}{-i\\epsilon_n - \\xi_{\\mathbf{k}'}} = \\frac{-1}{(i\\epsilon_n)^2 - \\xi_{\\mathbf{k}'}^2} = \\frac{1}{\\epsilon_n^2 + \\xi_{\\mathbf{k}'}^2}\n$$\n相互作用势由 $V_{\\mathbf{k}\\mathbf{k}'}=-V\\,\\Theta(\\hbar\\omega_D-|\\xi_{\\mathbf{k}}|)\\Theta(\\hbar\\omega_D-|\\xi_{\\mathbf{k}'}|)$ 给出，其中 $V>0$。这种可分离形式意味着能隙参数 $\\Delta_{\\mathbf{k}}$ 对于能量壳层 $|\\xi_{\\mathbf{k}}| < \\hbar\\omega_D$ 内的态是常数 $\\Delta_0$，而在壳层外为零。\n$$\n\\Delta_{\\mathbf{k}} = \\Delta_0 \\, \\Theta(\\hbar\\omega_D-|\\xi_{\\mathbf{k}}|)\n$$\n将这些代入能隙方程，我们可以考虑一个满足 $|\\xi_{\\mathbf{k}}| < \\hbar\\omega_D$ 的态 $\\mathbf{k}$，对于此态有 $\\Delta_{\\mathbf{k}} = \\Delta_0$。\n$$\n\\Delta_0 = - k_B T_c \\sum_{\\mathbf{k}', n} \\left[-V\\,\\Theta(\\hbar\\omega_D-|\\xi_{\\mathbf{k}}|)\\Theta(\\hbar\\omega_D-|\\xi_{\\mathbf{k}'}|)\\right] \\left(\\frac{1}{\\epsilon_n^2 + \\xi_{\\mathbf{k}'}^2}\\right) \\Delta_0 \\, \\Theta(\\hbar\\omega_D-|\\xi_{\\mathbf{k}'}|)\n$$\n由于 $T_c$ 对应于非零解 $\\Delta_0 \\neq 0$ 首次出现的温度，故可将方程两边同除以 $\\Delta_0$。方程左边已经满足 $\\Theta(\\hbar\\omega_D-|\\xi_{\\mathbf{k}}|)=1$ 的条件。项 $\\Theta(\\hbar\\omega_D-|\\xi_{\\mathbf{k}'}|)\\Theta(\\hbar\\omega_D-|\\xi_{\\mathbf{k}'}|)$ 就是 $\\Theta(\\hbar\\omega_D-|\\xi_{\\mathbf{k}'}|)$。\n$$\n1 = V k_B T_c \\sum_{\\mathbf{k}', n} \\Theta(\\hbar\\omega_D-|\\xi_{\\mathbf{k}'}|) \\frac{1}{\\epsilon_n^2 + \\xi_{\\mathbf{k}'}^2}\n$$\n此方程即为 Cooper 不稳定性的判据。为求解此方程，我们将对动量态 $\\mathbf{k}'$ 的求和转换成对能量的积分，并由单自旋态密度 $N(0)$ 加权。求和 $\\sum_{\\mathbf{k}'}$ 变为 $\\int N(\\xi') d\\xi'$。题目说明在能量壳层内，$N(\\xi')$ 可取为常数 $N(0)$。\n$$\n1 = V N(0) k_B T_c \\sum_{n=-\\infty}^{\\infty} \\int_{-\\hbar\\omega_D}^{\\hbar\\omega_D} d\\xi' \\frac{1}{\\epsilon_n^2 + (\\xi')^2}\n$$\n我们首先计算对 $\\xi'$ 的积分：\n$$\n\\int_{-\\hbar\\omega_D}^{\\hbar\\omega_D} \\frac{d\\xi'}{\\epsilon_n^2 + (\\xi')^2} = \\left[ \\frac{1}{|\\epsilon_n|} \\arctan\\left(\\frac{\\xi'}{|\\epsilon_n|}\\right) \\right]_{-\\hbar\\omega_D}^{\\hbar\\omega_D} = \\frac{2}{|\\epsilon_n|} \\arctan\\left(\\frac{\\hbar\\omega_D}{|\\epsilon_n|}\\right)\n$$\n代回后，判据变为：\n$$\n1 = V N(0) k_B T_c \\sum_{n=-\\infty}^{\\infty} \\frac{2}{|\\epsilon_n|} \\arctan\\left(\\frac{\\hbar\\omega_D}{|\\epsilon_n|}\\right)\n$$\n对于 $n \\ge 0$，由于 $|\\epsilon_n| = |\\epsilon_{-n-1}| = (2n+1)\\pi k_B T_c$，求和中的项对于 $n$ 和 $-n-1$ 是相同的。因此，对所有整数的求和可以写成对非负整数求和的两倍。\n$$\n1 = V N(0) k_B T_c \\cdot 2 \\sum_{n=0}^{\\infty} \\frac{2}{\\epsilon_n} \\arctan\\left(\\frac{\\hbar\\omega_D}{\\epsilon_n}\\right)\n$$\n令 $\\lambda = N(0)V$ 为无量纲耦合常数。代入 $\\epsilon_n = (2n+1)\\pi k_B T_c$：\n$$\n\\frac{1}{\\lambda} = 4 k_B T_c \\sum_{n=0}^{\\infty} \\frac{1}{(2n+1)\\pi k_B T_c} \\arctan\\left(\\frac{\\hbar\\omega_D}{(2n+1)\\pi k_B T_c}\\right)\n$$\n$$\n\\frac{1}{\\lambda} = \\frac{4}{\\pi} \\sum_{n=0}^{\\infty} \\frac{1}{2n+1} \\arctan\\left(\\frac{\\hbar\\omega_D}{(2n+1)\\pi k_B T_c}\\right)\n$$\n我们在弱耦合极限 $0 < \\lambda \\ll 1$ 下求解此方程，此极限下 $1/\\lambda$ 很大。这要求右边的求和很大，意味着反正切函数的自变量对许多项来说都很大。这对应于 $k_B T_c \\ll \\hbar\\omega_D$ 的假设。\n我们定义一个截断指数 $n_D$，使得 Matsubara 频率的能量与德拜能量截断相当：$(2n_D+1)\\pi k_B T_c \\approx \\hbar\\omega_D$。对于 $n \\ll n_D$，反正切的自变量很大，我们可以近似 $\\arctan(x) \\approx \\pi/2$。对于 $n \\gg n_D$，自变量很小，求和中的项变得可以忽略。因此，我们通过取 $\\arctan \\approx \\pi/2$ 并求和至 $n_D-1$ 来近似该求和。\n$$\n\\frac{1}{\\lambda} \\approx \\frac{4}{\\pi} \\sum_{n=0}^{n_D-1} \\frac{1}{2n+1} \\left(\\frac{\\pi}{2}\\right) = 2 \\sum_{n=0}^{n_D-1} \\frac{1}{2n+1}\n$$\n该求和可以用包含 Euler–Mascheroni 常数 $\\gamma \\approx 0.577$ 的渐近公式来近似：\n$$\n\\sum_{k=0}^{N-1} \\frac{1}{2k+1} \\approx \\frac{1}{2}\\ln(N) + \\frac{\\ln(4)+\\gamma}{2}\n$$\n将此公式应用于我们的求和，并取 $N=n_D$：\n$$\n\\frac{1}{\\lambda} \\approx 2 \\left( \\frac{1}{2}\\ln(n_D) + \\frac{\\ln(4)+\\gamma}{2} \\right) = \\ln(n_D) + \\ln(4) + \\gamma = \\ln(4n_D) + \\gamma\n$$\n根据截断指数的定义，$2n_D\\pi k_B T_c \\approx \\hbar\\omega_D$，我们有 $n_D \\approx \\frac{\\hbar\\omega_D}{2\\pi k_B T_c}$。将此代入关于 $1/\\lambda$ 的方程：\n$$\n\\frac{1}{\\lambda} \\approx \\ln\\left(4 \\cdot \\frac{\\hbar\\omega_D}{2\\pi k_B T_c}\\right) + \\gamma = \\ln\\left(\\frac{2\\hbar\\omega_D}{\\pi k_B T_c}\\right) + \\gamma\n$$\n现在，我们求解 $T_c$：\n$$\n\\frac{1}{\\lambda} - \\gamma = \\ln\\left(\\frac{2\\hbar\\omega_D}{\\pi k_B T_c}\\right)\n$$\n对两边取指数：\n$$\n\\exp\\left(\\frac{1}{\\lambda} - \\gamma\\right) = \\frac{2\\hbar\\omega_D}{\\pi k_B T_c}\n$$\n$$\nk_B T_c = \\frac{2\\hbar\\omega_D}{\\pi} \\exp\\left(\\gamma - \\frac{1}{\\lambda}\\right) = \\frac{2e^{\\gamma}}{\\pi} \\hbar\\omega_D \\exp\\left(-\\frac{1}{\\lambda}\\right)\n$$\n将 $\\lambda = N(0)V$ 代回：\n$$\nk_B T_c = \\frac{2e^{\\gamma}}{\\pi} \\hbar\\omega_D \\exp\\left(-\\frac{1}{N(0)V}\\right)\n$$\n问题要求的是无量纲比值 $k_B T_c / (\\hbar\\omega_D)$。\n$$\n\\frac{k_B T_c}{\\hbar\\omega_D} = \\frac{2e^{\\gamma}}{\\pi} \\exp\\left(-\\frac{1}{N(0)V}\\right)\n$$\n这便是著名的弱耦合极限下临界温度的 BCS 公式。", "answer": "$$\\boxed{\\frac{2e^{\\gamma}}{\\pi}\\exp\\left(-\\frac{1}{N(0)V}\\right)}$$", "id": "2977400"}, {"introduction": "在简单的 s 波模型之外，许多真实材料表现出更复杂的配对对称性，例如 d 波。本练习探讨了不同配对通道相互竞争的情景 [@problem_id:2977330]。您将学习如何将此问题表述为一个矩阵本征值方程，这是一种强大的技术，使您能够确定哪种配对对称性在能量上最有利，并将在系统中得以实现。", "problem": "考虑一个单带、各向同性的二维金属，其费米面为圆形，在费米能级处每个自旋的态密度为常数 $N(0)$。在粒子-粒子（库珀）通道中，有效相互作用假定是可分离的，并根据下式混合主要的 s 波和 d 波谐波：\n$$\nV(\\mathbf{k},\\mathbf{k}') \\equiv -\\Big[g_{s}\\,\\phi_{s}(\\mathbf{k})\\,\\phi_{s}(\\mathbf{k}')+g_{d}\\,\\phi_{d}(\\mathbf{k})\\,\\phi_{d}(\\mathbf{k}')+g_{m}\\,\\big(\\phi_{s}(\\mathbf{k})\\,\\phi_{d}(\\mathbf{k}')+\\phi_{d}(\\mathbf{k})\\,\\phi_{s}(\\mathbf{k}')\\big)\\Big],\n$$\n其中 $g_{s}$、$g_{d}$ 和 $g_{m}$ 是与温度无关的实数耦合常数。基函数取为在费米面上正交归一的函数，对于费米面角 $\\theta_{\\mathbf{k}}$，有 $\\phi_{s}(\\mathbf{k}) \\equiv 1$ 和 $\\phi_{d}(\\mathbf{k}) \\equiv \\sqrt{2}\\cos(2\\theta_{\\mathbf{k}})$，满足 $\\langle \\phi_{i}\\phi_{j}\\rangle_{\\mathrm{FS}}=\\delta_{ij}$，其中 $\\langle \\cdots \\rangle_{\\mathrm{FS}}$ 表示费米面平均。\n\n在超导相变附近，关于能隙函数 $\\Delta(\\mathbf{k})$ 的线性化 Bardeen–Cooper–Schrieffer (BCS) 能隙方程在温度 $T$ 下为\n$$\n\\Delta(\\mathbf{k})=-\\sum_{\\mathbf{k}'}V(\\mathbf{k},\\mathbf{k}')\\,\\frac{\\tanh\\!\\big(\\xi_{\\mathbf{k}'}/(2T)\\big)}{2\\,\\xi_{\\mathbf{k}'}}\\,\\Delta(\\mathbf{k}'),\n$$\n其中 $\\xi_{\\mathbf{k}}$ 是相对于费米能级的单粒子能量。假设一个对两种谐波都共同的能量截断 $\\omega_{c}$，并定义对数库珀积分\n$$\n\\mathcal{I}(T)\\equiv \\int_{0}^{\\omega_{c}}\\mathrm{d}\\xi\\,\\frac{\\tanh\\!\\big(\\xi/(2T)\\big)}{\\xi}.\n$$\n假设能隙具有形式 $\\Delta(\\mathbf{k})=\\Delta_{s}\\,\\phi_{s}(\\mathbf{k})+\\Delta_{d}\\,\\phi_{d}(\\mathbf{k})$，推导决定配对起始的耦合本征值方程，并将其表示为一个关于向量 $(\\Delta_{s},\\Delta_{d})^{\\top}$ 的 $2\\times 2$ 本征值问题。仅使用上述假设，明确地用 $g_{s}$、$g_{d}$、$g_{m}$、$N(0)$ 和 $\\mathcal{I}(T)$ 来确定所得无量纲配对核的最大本征值 $\\lambda_{\\max}$。\n\n你的最终答案必须是 $\\lambda_{\\max}$ 的一个单一闭合形式的符号表达式。不需要进行数值计算，也不需要单位。", "solution": "出发点是超导相变温度 $T$ 附近的线性化 Bardeen–Cooper–Schrieffer (BCS) 能隙方程：\n$$\n\\Delta(\\mathbf{k})=-\\sum_{\\mathbf{k}'}V(\\mathbf{k},\\mathbf{k}')\\,\\frac{\\tanh\\!\\big(\\xi_{\\mathbf{k}'}/(2T)\\big)}{2\\,\\xi_{\\mathbf{k}'}}\\,\\Delta(\\mathbf{k}')\n$$\n此处，$\\Delta(\\mathbf{k})$ 是超导能隙函数，$V(\\mathbf{k},\\mathbf{k}')$ 是有效相互作用势，$\\xi_{\\mathbf{k}'}$ 是相对于费米能级的单粒子能量。\n\n给定能隙函数的 ansatz 为一个 s 波分量和一个 d 波分量的线性组合：\n$$\n\\Delta(\\mathbf{k})=\\Delta_{s}\\,\\phi_{s}(\\mathbf{k})+\\Delta_{d}\\,\\phi_{d}(\\mathbf{k})\n$$\n相互作用势以可分离形式给出：\n$$\nV(\\mathbf{k},\\mathbf{k}') = -\\Big[g_{s}\\,\\phi_{s}(\\mathbf{k})\\,\\phi_{s}(\\mathbf{k}')+g_{d}\\,\\phi_{d}(\\mathbf{k})\\,\\phi_{d}(\\mathbf{k}')+g_{m}\\,\\big(\\phi_{s}(\\mathbf{k})\\,\\phi_{d}(\\mathbf{k}')+\\phi_{d}(\\mathbf{k})\\,\\phi_{s}(\\mathbf{k}')\\big)\\Big]\n$$\n对动量态 $\\mathbf{k}'$ 的求和可以转换成一个能量积分和一个费米面上的平均。假设在费米能级附近，每个自旋的态密度 $N(0)$ 为常数，这个转换为 $\\sum_{\\mathbf{k}'} \\to \\int \\mathrm{d}\\xi' N(\\xi') \\langle \\dots \\rangle_{\\mathrm{FS}} \\approx N(0)\\int \\mathrm{d}\\xi' \\langle \\dots \\rangle_{\\mathrm{FS}}$。能量积分被限制在费米能级周围的 $[-\\omega_{c}, \\omega_{c}]$ 窗口内。相关的能量积分为\n$$\n\\int_{-\\omega_{c}}^{\\omega_{c}} \\mathrm{d}\\xi' \\frac{\\tanh(\\xi'/(2T))}{2\\xi'} = 2 \\int_{0}^{\\omega_{c}} \\mathrm{d}\\xi' \\frac{\\tanh(\\xi'/(2T))}{2\\xi'} = \\int_{0}^{\\omega_{c}} \\mathrm{d}\\xi' \\frac{\\tanh(\\xi'/(2T))}{\\xi'} \\equiv \\mathcal{I}(T)\n$$\n因此，能隙方程变成了一个费米面上的积分方程：\n$$\n\\Delta(\\mathbf{k}) = N(0)\\,\\mathcal{I}(T) \\left\\langle \\Big[g_{s}\\,\\phi_{s}(\\mathbf{k})\\,\\phi_{s}(\\mathbf{k}')+g_{d}\\,\\phi_{d}(\\mathbf{k})\\,\\phi_{d}(\\mathbf{k}')+g_{m}\\,\\big(\\phi_{s}(\\mathbf{k})\\,\\phi_{d}(\\mathbf{k}')+\\phi_{d}(\\mathbf{k})\\,\\phi_{s}(\\mathbf{k}')\\big)\\Big] \\Delta(\\mathbf{k}') \\right\\rangle_{\\mathrm{FS}(\\mathbf{k}')}\n$$\n其中 $\\langle \\dots \\rangle_{\\mathrm{FS}(\\mathbf{k}')}$ 表示在费米面上对动量方向 $\\mathbf{k}'$ 的平均。\n\n我们将 $\\Delta(\\mathbf{k}')$ 的 ansatz 代入方程中：\n$$\n\\Delta_{s}\\,\\phi_{s}(\\mathbf{k})+\\Delta_{d}\\,\\phi_{d}(\\mathbf{k}) = N(0)\\,\\mathcal{I}(T) \\left\\langle \\Big[ \\dots \\Big] \\Big[\\Delta_{s}\\,\\phi_{s}(\\mathbf{k}')+\\Delta_{d}\\,\\phi_{d}(\\mathbf{k}')\\Big] \\right\\rangle_{\\mathrm{FS}(\\mathbf{k}')}\n$$\n利用基函数的正交归一性 $\\langle \\phi_{i}(\\mathbf{k}')\\phi_{j}(\\mathbf{k}')\\rangle_{\\mathrm{FS}} = \\delta_{ij}$ 来计算费米面平均。平均号内的项展开如下：\n\\begin{align*}\n& \\left\\langle \\Big[ \\dots \\Big] \\Big[\\Delta_{s}\\,\\phi_{s}(\\mathbf{k}')+\\Delta_{d}\\,\\phi_{d}(\\mathbf{k}')\\Big] \\right\\rangle_{\\mathrm{FS}(\\mathbf{k}')} \\\\\n=\\ & g_{s}\\phi_{s}(\\mathbf{k}) \\Big(\\Delta_{s}\\langle\\phi_{s}^{2}\\rangle_{\\mathrm{FS}} + \\Delta_{d}\\langle\\phi_{s}\\phi_{d}\\rangle_{\\mathrm{FS}}\\Big) + g_{d}\\phi_{d}(\\mathbf{k}) \\Big(\\Delta_{s}\\langle\\phi_{d}\\phi_{s}\\rangle_{\\mathrm{FS}} + \\Delta_{d}\\langle\\phi_{d}^{2}\\rangle_{\\mathrm{FS}}\\Big) \\\\\n& + g_{m}\\phi_{s}(\\mathbf{k}) \\Big(\\Delta_{s}\\langle\\phi_{d}\\phi_{s}\\rangle_{\\mathrm{FS}} + \\Delta_{d}\\langle\\phi_{d}^{2}\\rangle_{\\mathrm{FS}}\\Big) + g_{m}\\phi_{d}(\\mathbf{k}) \\Big(\\Delta_{s}\\langle\\phi_{s}^{2}\\rangle_{\\mathrm{FS}} + \\Delta_{d}\\langle\\phi_{s}\\phi_{d}\\rangle_{\\mathrm{FS}}\\Big) \\\\\n=\\ & g_{s}\\phi_{s}(\\mathbf{k}) (\\Delta_{s} \\cdot 1 + \\Delta_{d} \\cdot 0) + g_{d}\\phi_{d}(\\mathbf{k}) (\\Delta_{s} \\cdot 0 + \\Delta_{d} \\cdot 1) \\\\\n& + g_{m}\\phi_{s}(\\mathbf{k}) (\\Delta_{s} \\cdot 0 + \\Delta_{d} \\cdot 1) + g_{m}\\phi_{d}(\\mathbf{k}) (\\Delta_{s} \\cdot 1 + \\Delta_{d} \\cdot 0) \\\\\n=\\ & (g_{s}\\Delta_{s} + g_{m}\\Delta_{d})\\phi_{s}(\\mathbf{k}) + (g_{m}\\Delta_{s} + g_{d}\\Delta_{d})\\phi_{d}(\\mathbf{k})\n\\end{align*}\n将此结果代入能隙方程得到：\n$$\n\\Delta_{s}\\,\\phi_{s}(\\mathbf{k})+\\Delta_{d}\\,\\phi_{d}(\\mathbf{k}) = N(0)\\,\\mathcal{I}(T) \\Big[ (g_{s}\\Delta_{s} + g_{m}\\Delta_{d})\\phi_{s}(\\mathbf{k}) + (g_{m}\\Delta_{s} + g_{d}\\Delta_{d})\\phi_{d}(\\mathbf{k}) \\Big]\n$$\n根据基函数 $\\phi_{s}(\\mathbf{k})$ 和 $\\phi_{d}(\\mathbf{k})$ 的线性无关性，我们可以令方程两边它们的系数相等。这得到一个关于 $\\Delta_{s}$ 和 $\\Delta_{d}$ 的双耦合线性方程组：\n\\begin{align*}\n\\Delta_{s} &= N(0)\\,\\mathcal{I}(T) (g_{s}\\Delta_{s} + g_{m}\\Delta_{d}) \\\\\n\\Delta_{d} &= N(0)\\,\\mathcal{I}(T) (g_{m}\\Delta_{s} + g_{d}\\Delta_{d})\n\\end{align*}\n这个系统可以写成一个 $2 \\times 2$ 矩阵本征值问题。设能隙系数的向量为 $\\vec{\\Delta} = (\\Delta_{s}, \\Delta_{d})^{\\top}$。方程变为：\n$$\n\\begin{pmatrix} \\Delta_{s} \\\\ \\Delta_{d} \\end{pmatrix} = N(0)\\,\\mathcal{I}(T) \\begin{pmatrix} g_{s} & g_{m} \\\\ g_{m} & g_{d} \\end{pmatrix} \\begin{pmatrix} \\Delta_{s} \\\\ \\Delta_{d} \\end{pmatrix}\n$$\n这是一个形如 $\\vec{\\Delta} = \\mathbf{K} \\vec{\\Delta}$ 的本征值方程，其中矩阵 $\\mathbf{K}$ 是无量纲的配对核。为了存在非平庸解（即 $\\vec{\\Delta} \\neq 0$），核 $\\mathbf{K}$ 的本征值必须为 1。问题要求这个核的最大本征值 $\\lambda_{\\max}$，它由下式给出：\n$$\n\\mathbf{K} = N(0)\\,\\mathcal{I}(T) \\begin{pmatrix} g_{s} & g_{m} \\\\ g_{m} & g_{d} \\end{pmatrix}\n$$\n$\\mathbf{K}$ 的本征值 $\\lambda$ 通过标量因子 $\\lambda = N(0)\\,\\mathcal{I}(T)\\,\\mu$ 与矩阵 $\\mathbf{G} = \\begin{pmatrix} g_{s} & g_{m} \\\\ g_{m} & g_{d} \\end{pmatrix}$ 的本征值 $\\mu$ 相关联。我们从其特征方程 $\\det(\\mathbf{G} - \\mu\\mathbf{I})=0$ 中求出 $\\mathbf{G}$ 的本征值：\n$$\n\\det \\begin{pmatrix} g_{s} - \\mu & g_{m} \\\\ g_{m} & g_{d} - \\mu \\end{pmatrix} = (g_{s}-\\mu)(g_{d}-\\mu) - g_{m}^{2} = 0\n$$\n这个关于 $\\mu$ 的二次方程是 $\\mu^{2} - (g_{s}+g_{d})\\mu + (g_{s}g_{d} - g_{m}^{2}) = 0$。解由二次公式给出：\n$$\n\\mu = \\frac{(g_{s}+g_{d}) \\pm \\sqrt{(g_{s}+g_{d})^{2} - 4(g_{s}g_{d} - g_{m}^{2})}}{2} = \\frac{(g_{s}+g_{d}) \\pm \\sqrt{(g_{s}-g_{d})^{2} + 4g_{m}^{2}}}{2}\n$$\n最大本征值 $\\mu_{\\max}$ 对应于正号：\n$$\n\\mu_{\\max} = \\frac{g_{s}+g_{d} + \\sqrt{(g_{s}-g_{d})^{2} + 4g_{m}^{2}}}{2}\n$$\n因此，完整的无量纲配对核 $\\mathbf{K}$ 的最大本征值是 $\\lambda_{\\max} = N(0)\\,\\mathcal{I}(T)\\,\\mu_{\\max}$。\n$$\n\\lambda_{\\max} = N(0)\\,\\mathcal{I}(T) \\left(\\frac{g_{s} + g_{d} + \\sqrt{(g_{s} - g_{d})^{2} + 4g_{m}^{2}}}{2}\\right)\n$$\n超导的起始发生在由条件 $\\lambda_{\\max}(T_{c}) = 1$ 决定的临界温度 $T_{c}$ 处。", "answer": "$$\\boxed{N(0)\\,\\mathcal{I}(T) \\frac{g_{s} + g_{d} + \\sqrt{(g_{s} - g_{d})^{2} + 4g_{m}^{2}}}{2}}$$", "id": "2977330"}, {"introduction": "对于现实的配对相互作用，能隙方程的解析解通常是不可能的。本实践将从解析推导过渡到数值计算，提供一个在离散化的费米面上求解库珀不稳定性的框架 [@problem_id:2977260]。您将推导并实现一种稳健的数值方法，将问题转化为一个对称矩阵本征值问题，这是超导现代研究中的一项关键技能。", "problem": "要求您设计并实现一个数值程序，通过计算与离散化费米面上线性化的超导能隙方程相关的最大本征值，来确定 Cooper 不稳定性的起始点。目标是，从第一性原理出发，推导出一个数学上精确的算子，其最大本征值决定了该不稳定性，然后实现一个鲁棒的算法，为几个给定的情况计算该最大本征值。\n\n起点和基本依据：\n\n- 考虑 Bardeen–Cooper–Schrieffer (BCS) 框架，其中费米面上的低能准粒子通过有效配对相互作用 $V_{\\mathbf{k}\\mathbf{k}'}$ 进行相互作用。\n- 在接近超导转变的温度下，线性响应理论表明能隙函数 $ \\Delta(\\mathbf{k}) $ 满足一个齐次线性方程，该方程通过组合有效相互作用和限制在费米面上的正常态双粒子磁化率得到。\n- 将费米面离散化为由索引 $i$ 标记的小块，并使用求积权重以加权和来近似曲面积分。结果是一个作用于能隙函数各小块值组成的向量的线性算子。不稳定性由此算子的最大本征值所控制。\n\n您的任务：\n\n- 在不假设任何预先给定的封闭形式表达式的情况下，从这些原理中推导出加权的、离散的算子，解释如何将其简化为一个在适当加权的内积空间中作用的对称矩阵，并论证为何其最大本征值决定了不稳定性。\n- 实现一个数值方案，该方案：\n  1. 接受离散化的费米面求积作为输入，形式为非负权重列表 $w_i$ 和表示小块 $i$ 与 $j$ 之间相互作用的实矩阵 $V_{ij}$。\n  2. 构建适当的对称矩阵，其最大本征值是控制不稳定性的物理相关量。\n  3. 使用为对称矩阵设计的数值稳定算法计算最大本征值。\n  4. 通过基于物理互易性和厄米性（Hermiticity）进行适当的对称化，处理由离散化噪声引起的非对称 $V_{ij}$。\n\n由于本征值是无量纲的，因此输出不需要物理单位。如果在任何中间步骤中使用角度，则必须以弧度为单位。\n\n程序的输入和输出规范：\n\n- 您将获得一个小型的参数集测试套件，每个参数集包含一个矩阵 $V$ 和一个权重列表 $w$。您的程序必须针对每种情况，构建由推导得出的对称算子，并以浮点数形式返回其最大本征值。\n- 最终输出必须是单行文本，其中包含用方括号括起来的逗号分隔的结果列表，例如 $[\\text{result}_1,\\text{result}_2,\\text{result}_3]$。\n\n要实现和评估的测试套件：\n\n- 情况 $1$（理想路径，均匀吸引通道）：\n  - $N = 4$，$w = [0.3, 0.3, 0.3, 0.3]$，\n  - 对所有 $i,j$，$V_{ij} = -0.9$。\n\n- 情况 $2$（边界条件，零相互作用）：\n  - $N = 3$，$w = [0.5, 0.3, 0.2]$，\n  - 对所有 $i,j$，$V_{ij} = 0$。\n\n- 情况 $3$（圆形费米面上的各向异性通道，具有 $d$ 波谐波）：\n  - $N = 8$，$w_i = 1/8$（$i = 0, \\dots, 7$），\n  - $\\theta_i = 2\\pi i / 8$（以弧度为单位），\n  - $V_{ij} = -0.6 \\cos\\!\\left(2(\\theta_i - \\theta_j)\\right)$。\n\n- 情况 $4$（具有各向异性权重的非对称离散化噪声）：\n  - $N = 5$，$w = [0.15, 0.05, 0.4, 0.3, 0.1]$，\n  - \n    $V = \n    \\begin{pmatrix}\n    -0.3 & -0.1 & -0.05 & 0.0 & -0.02 \\\\\n    -0.12 & -0.28 & -0.08 & -0.01 & 0.02 \\\\\n    -0.05 & -0.07 & -0.25 & -0.02 & -0.03 \\\\\n    -0.01 & -0.02 & -0.04 & -0.2 & -0.06 \\\\\n    -0.03 & 0.01 & -0.02 & -0.07 & -0.22\n    \\end{pmatrix}\n    $。\n\n您的程序应生成单行输出，其中包含四种情况的最大本征值，格式应严格为 $[\\lambda_1,\\lambda_2,\\lambda_3,\\lambda_4]$，其中每个 $\\lambda_i$ 是从相应情况计算得出的浮点数。不应打印任何其他文本。", "solution": "该问题要求基于线性化的 Bardeen–Cooper–Schrieffer (BCS) 能隙方程，推导一种数值方法来确定超导体中 Cooper 不稳定性的起始点。任务的核心是根据费米面和配对相互作用的离散表示，构建一个对称矩阵本征值问题，然后计算其最大本征值。\n\n### 对称算子的推导\n\n1.  **线性化能隙方程**\n\n    起点是 BCS 能隙方程，它决定了超导能隙 $\\Delta(\\mathbf{k})$。在临界温度 $T_c$ 附近，能隙无穷小，这使得方程可以被线性化。在此极限下，它成为一个关于在费米面 ($FS$) 上求值的能隙函数的齐次线性积分方程：\n    $$\n    \\Delta(\\mathbf{k}) = \\lambda_T \\int_{FS} \\left(-V(\\mathbf{k}, \\mathbf{k'})\\right) \\Delta(\\mathbf{k'}) d\\mu(\\mathbf{k'})\n    $$\n    在这里，$V(\\mathbf{k}, \\mathbf{k'})$ 是电子态 $\\mathbf{k}$ 和 $\\mathbf{k'}$ 之间的有效配对相互作用。吸引相互作用对应于 $V < 0$。因此，积分算子的核取为 $-V(\\mathbf{k}, \\mathbf{k'})$，对于吸引势，该核为正。系数 $\\lambda_T > 0$ 包含了温度依赖性和材料属性（如态密度）。具体而言，在 BCS 理论中，$\\lambda_T$ 与 $\\ln(1/T)$ 成正比，其中 $T$ 是温度。项 $d\\mu(\\mathbf{k'})$ 表示费米面上的积分测度。\n\n    只有当此本征值方程被满足时，才存在标志着超导起始的非平凡解（$\\Delta(\\mathbf{k}) \\not\\equiv 0$）。这种情况发生在与温度相关的项 $\\lambda_T$ 使得 1 成为由 $(\\mathcal{K}f)(\\mathbf{k}) = \\lambda_T \\int_{FS} (-V(\\mathbf{k}, \\mathbf{k'})) f(\\mathbf{k'}) d\\mu(\\mathbf{k'})$ 定义的算子 $\\mathcal{K}$ 的一个本征值时。\n\n    将方程重排为标准本征值问题：\n    $$\n    \\frac{1}{\\lambda_T} \\Delta(\\mathbf{k}) = \\int_{FS} \\left(-V(\\mathbf{k}, \\mathbf{k'})\\right) \\Delta(\\mathbf{k'}) d\\mu(\\mathbf{k'})\n    $$\n    令 $\\Lambda = 1/\\lambda_T$。向超导态的转变发生在临界温度 $T_c$ 处，这是存在非平凡解的最高可能温度。由于 $\\lambda_T$ 随着 $T$ 的降低而增加，最高的转变温度 $T_c$ 在允许非平凡解的最小可能 $\\lambda_T$ 值处达到。这对应于 $1/\\lambda_T$ 等于积分算子的最大本征值 $\\Lambda_{max}$ 的情况。因此，不稳定性由以 $-V(\\mathbf{k}, \\mathbf{k'})$ 为核的积分算子的最大本征值 $\\Lambda_{max}$ 决定。\n\n2.  **离散化与矩阵表述**\n\n    问题提供了一个由 $N$ 个小块组成的离散化费米面，并附有近似测度 $d\\mu(\\mathbf{k})$ 的正求积权重 $w_i$。积分方程因此转换为矩阵方程。令 $\\Delta_i = \\Delta(\\mathbf{k}_i)$ 为小块 $i$ 上的能隙，$V_{ij} = V(\\mathbf{k}_i, \\mathbf{k}_j)$ 为相互作用矩阵。离散化的本征值方程为：\n    $$\n    \\Lambda \\Delta_i = \\sum_{j=1}^{N} (-V_{ij}) \\Delta_j w_j\n    $$\n    这可以写成矩阵形式 $\\Lambda \\vec{\\Delta} = K \\vec{\\Delta}$，其中矩阵 $K$ 的元素为 $K_{ij} = (-V_{ij}) w_j$。由于因子 $w_j$ 的存在，该矩阵 $K$ 通常不是对称的，这会使本征值计算复杂化，并可能导致数值不稳定性。\n\n3.  **本征值问题的对称化**\n\n    为了获得一个更鲁棒的数值问题，我们将其转换为一个等价的对称矩阵问题。这通过在一个适当加权的内积空间中进行操作来实现。我们定义一个新向量 $\\vec{\\psi}$，其分量为 $\\psi_i = \\sqrt{w_i} \\Delta_i$。这假设所有权重如规定一样均为非负值，$w_i \\ge 0$。如果 $w_i > 0$，我们有 $\\Delta_i = \\psi_i / \\sqrt{w_i}$。将此代入离散化方程中：\n    $$\n    \\Lambda \\frac{\\psi_i}{\\sqrt{w_i}} = \\sum_{j=1}^{N} (-V_{ij}) \\left(\\frac{\\psi_j}{\\sqrt{w_j}}\\right) w_j = \\sum_{j=1}^{N} (-V_{ij}) \\sqrt{w_j} \\psi_j\n    $$\n    两边同乘以 $\\sqrt{w_i}$ 可得：\n    $$\n    \\Lambda \\psi_i = \\sum_{j=1}^{N} \\left( \\sqrt{w_i} (-V_{ij}) \\sqrt{w_j} \\right) \\psi_j\n    $$\n    这是一个标准本征值问题 $\\Lambda \\vec{\\psi} = S \\vec{\\psi}$，其中矩阵 $S$ 的元素为：\n    $$\n    S_{ij} = \\sqrt{w_i} (-V_{ij}) \\sqrt{w_j}\n    $$\n    $S$ 的本征值 $\\Lambda$ 与原始非对称矩阵 $K$ 的本征值相同。物理互易性的基本原理要求相互作用势是厄米的（Hermitian）。对于实势，这意味着对称性：$V(\\mathbf{k}, \\mathbf{k'}) = V(\\mathbf{k'}, \\mathbf{k})$，因此 $V_{ij} = V_{ji}$。如果 $V$ 是对称的，那么 $S$ 也是对称的：\n    $$\n    S_{ji} = \\sqrt{w_j} (-V_{ji}) \\sqrt{w_i} = \\sqrt{w_j} (-V_{ij}) \\sqrt{w_i} = S_{ij}\n    $$\n    寻找这个实对称矩阵 $S$ 的最大本征值问题是适定的，并且可以使用稳定的数值算法高效求解。\n\n4.  **处理非对称离散化噪声**\n\n    在实践中，由于数值误差或离散化伪影，所提供的相互作用矩阵 $V$ 可能不是完全对称的。由于底层的物理相互作用必须是对称的，任何反对称分量都是无物理意义的噪声。我们可以通过在构建 $S$ 之前用其对称部分 $V^{\\text{sym}}$ 替换 $V$ 来滤除这种噪声：\n    $$\n    V^{\\text{sym}}_{ij} = \\frac{V_{ij} + V_{ji}}{2}\n    $$\n    因此，我们最终的对称矩阵是 $S_{ij} = \\sqrt{w_i} (-V^{\\text{sym}}_{ij}) \\sqrt{w_j}$。\n\n### 数值实现策略\n\n为每个测试用例计算最大本征值的步骤如下：\n1.  给定输入矩阵 $V$ 和权重向量 $w$。\n2.  构建对称化的相互作用矩阵 $V^{\\text{sym}} = (V + V^T)/2$。\n3.  将本征值问题的核定义为 $K = -V^{\\text{sym}}$。\n4.  构建最终的对称矩阵 $S$，其元素为 $S_{ij} = \\sqrt{w_i} K_{ij} \\sqrt{w_j}$。这可以使用矩阵乘法高效地执行：$S = \\text{diag}(\\sqrt{w}) \\cdot K \\cdot \\text{diag}(\\sqrt{w})$。\n5.  使用数值稳定的算法（例如 `numpy.linalg.eigh` 提供的算法）计算实对称矩阵 $S$ 的本征值。\n6.  结果是计算出的实本征值中的最大值。\n\n此过程将应用于所提供的四个测试用例中的每一个。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_max_eigenvalue(V_in, w_in):\n    \"\"\"\n    Computes the largest eigenvalue governing the Cooper instability.\n\n    Args:\n        V_in (list of lists of floats): The pairing interaction matrix V_ij.\n        w_in (list of floats): The quadrature weights w_i.\n\n    Returns:\n        float: The largest eigenvalue of the symmetrized operator.\n    \"\"\"\n    # Convert inputs to numpy arrays for efficient computation.\n    V = np.array(V_in, dtype=float)\n    w = np.array(w_in, dtype=float)\n\n    # 1. Symmetrize the interaction matrix V to remove unphysical noise.\n    # V_sym = (V + V.T) / 2\n    V_sym = 0.5 * (V + V.T)\n\n    # 2. Define the kernel of the eigenvalue problem, which is -V for\n    #    an attractive interaction.\n    kernel = -V_sym\n\n    # 3. Construct the symmetric matrix S = sqrt(w_i) * kernel_ij * sqrt(w_j).\n    # This can be done efficiently via matrix multiplication.\n    # Let sqrt_w_diag be a diagonal matrix with sqrt(w_i) on the diagonal.\n    # Then S = sqrt_w_diag @ kernel @ sqrt_w_diag.\n    sqrt_w = np.sqrt(w)\n    # Using broadcasting for an efficient element-wise multiplication\n    # S_ij = kernel_ij * sqrt(w_i) * sqrt(w_j)\n    S = kernel * np.outer(sqrt_w, sqrt_w)\n\n    # 4. Compute the eigenvalues of the real symmetric matrix S.\n    # numpy.linalg.eigh is specialized for Hermitian (or real symmetric)\n    # matrices and is numerically stable. It returns eigenvalues in\n    # ascending order.\n    eigenvalues = np.linalg.eigh(S)[0]\n\n    # 5. The instability is governed by the largest (most positive) eigenvalue.\n    # Since eigh returns them sorted, the largest is the last one.\n    # Using np.max() is also robust in case the sorting order isn't guaranteed.\n    max_eigenvalue = np.max(eigenvalues)\n\n    return max_eigenvalue\n\ndef solve():\n    \"\"\"\n    Main function to process all test cases and print the results.\n    \"\"\"\n    # Case 1 (happy path, uniform attractive channel):\n    N1 = 4\n    w1 = [0.3, 0.3, 0.3, 0.3]\n    V1 = [[-0.9 for _ in range(N1)] for _ in range(N1)]\n\n    # Case 2 (boundary condition, zero interaction):\n    N2 = 3\n    w2 = [0.5, 0.3, 0.2]\n    V2 = [[0.0 for _ in range(N2)] for _ in range(N2)]\n    \n    # Case 3 (anisotropic channel on a circular Fermi surface):\n    N3 = 8\n    w3 = [1/8 for _ in range(N3)]\n    thetas3 = [2 * np.pi * i / N3 for i in range(N3)]\n    V3 = np.zeros((N3, N3))\n    for i in range(N3):\n        for j in range(N3):\n            V3[i, j] = -0.6 * np.cos(2 * (thetas3[i] - thetas3[j]))\n\n    # Case 4 (non-symmetric discretization noise with anisotropic weights):\n    w4 = [0.15, 0.05, 0.4, 0.3, 0.1]\n    V4 = [\n        [-0.3, -0.1, -0.05, 0.0, -0.02],\n        [-0.12, -0.28, -0.08, -0.01, 0.02],\n        [-0.05, -0.07, -0.25, -0.02, -0.03],\n        [-0.01, -0.02, -0.04, -0.2, -0.06],\n        [-0.03, 0.01, -0.02, -0.07, -0.22]\n    ]\n\n    test_cases = [\n        (V1, w1),\n        (V2, w2),\n        (V3, w3),\n        (V4, w4)\n    ]\n\n    results = []\n    for V, w in test_cases:\n        result = compute_max_eigenvalue(V, w)\n        # Rounding close-to-zero results for clean output.\n        if np.isclose(result, 0):\n            results.append(0.0)\n        else:\n            results.append(result)\n\n    # Final print statement in the exact required format.\n    # The output format is a comma-separated list of floats inside square brackets.\n    # Using repr() to ensure accurate float representation without losing precision.\n    print(f\"[{','.join(map(repr, results))}]\")\n\nsolve()\n```", "id": "2977260"}]}