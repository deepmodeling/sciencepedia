{"hands_on_practices": [{"introduction": "角分辨光电子能谱 (ARPES) 是直接探测材料电子能带结构和探测超导能隙的最强大工具之一。当材料进入超导态时，费米能级上的单粒子谱函数会打开一个能隙，形成所谓的“相干峰”。本练习将指导您分析一组假设的 ARPES 数据，通过识别和量化这些相干峰的位置来提取超导能隙的动量依赖性，并确定其对称性 [@problem_id:2988210]。", "problem": "角分辨光电子能谱 (ARPES) 测量与单粒子谱函数乘以费米函数成正比的光电流强度。考虑一个准二维的四方晶系超导体，其费米面在第一象限内可通过极角 $\\varphi \\in [0,\\pi/4]$ 进行参数化，其中 $\\varphi=0$ 是反节点方向，$\\varphi=\\pi/4$ 是节点（对角线）方向。ARPES 测量沿着与费米面相交于角度 $\\varphi=\\{0,\\pi/18,\\pi/9,\\pi/6,2\\pi/9,\\pi/4\\}$ 的路径进行，测量温度分别在超导临界温度 $T_c$ 的略上方和远低于 $T_c$ 的情况下进行。\n\n在正常态 ($T \\gtrsim T_c$)下，沿每条路径的准粒子色散都穿过费米能级，没有观察到前沿移动，即在费米动量 $k_F(\\varphi)$ 处的对称化能量分布曲线 (EDC) 在实验分辨率内显示出位于 $\\omega=0$ 的单峰。\n\n在超导态 ($T \\ll T_c$)下，在 $k_F(\\varphi)$ 处的对称化 EDC 显示出位于结合能 $\\pm E_{\\text{pk}}(\\varphi)$ 的两个对称峰。测得的正能量峰位 $E_{\\text{pk}}(\\varphi)$ （您可以将其视为在 $k_F$ 处的最小激发能）如下：\n- $\\varphi=0$ 时: $E_{\\text{pk}}=24.00$ meV\n- $\\varphi=\\pi/18$ 时: $E_{\\text{pk}}=22.55$ meV\n- $\\varphi=\\pi/9$ 时: $E_{\\text{pk}}=18.39$ meV\n- $\\varphi=\\pi/6$ 时: $E_{\\text{pk}}=12.00$ meV\n- $\\varphi=2\\pi/9$ 时: $E_{\\text{pk}}=4.17$ meV\n- $\\varphi=\\pi/4$ 时: $E_{\\text{pk}}=0.00$ meV\n\n任务：\n- 仅利用 ARPES 谱函数的基本性质以及超导对单粒子激发的影响，解释如何通过比较 $T_c$ 上下色散来确定费米能级处能隙的打开，并说明为何在 $k_F$ 处对称化 EDC 的峰位等于该角度下费米面上超导能隙的大小。\n- 根据所提供的数据，计算每个列出的 $\\varphi$ 角处的超导能隙大小 $\\Delta(\\varphi)$。\n- 假设能隙具有与四方对称性和自旋单态配对一致的单谐波角度依赖性，确定最能拟合数据的费米面上的能隙解析表达式 $\\Delta(\\varphi)$。在表达式中，$\\varphi$ 使用弧度，$\\Delta$ 的单位为 meV。报告的振幅参数需保留三位有效数字。\n\n您的最终答案必须是 $\\Delta(\\varphi)$ 的单个闭合形式解析表达式；$\\varphi$ 使用弧度，能量单位为 meV，并将拟合的振幅四舍五入至三位有效数字。", "solution": "该问题被评估为有效，因为它科学地基于凝聚态物理学的原理，问题陈述清晰，目标明确，数据充分，且没有矛盾或模糊之处。\n\n该问题要求分三部分作答：首先，解释角分辨光电子能谱 (ARPES) 如何测量超导能隙；其次，根据提供的数据确定能隙值；最后，推导能隙角度依赖性的解析表达式。\n\n**第一部分：ARPES 与超导能隙**\n\n在 ARPES 实验中测量的强度 $I(\\mathbf{k}, \\omega)$ 与单粒子谱函数 $A(\\mathbf{k}, \\omega)$ 和费米-狄拉克分布函数 $f(\\omega, T)$ 的乘积成正比：\n$$I(\\mathbf{k}, \\omega) \\propto A(\\mathbf{k}, \\omega) f(\\omega, T)$$\n其中 $\\mathbf{k}$ 是电子动量，$\\omega$ 是结合能（在费米能级 $E_F$ 处 $\\omega=0$），$T$ 是温度。谱函数 $A(\\mathbf{k}, \\omega)$ 表示动量为 $\\mathbf{k}$、能量为 $\\omega$ 的单粒子电子激发的概率密度。$A(\\mathbf{k}, \\omega)$ 中的峰对应于稳定或准稳定的电子态（准粒子）。能量分布曲线 (EDC) 是在固定 $\\mathbf{k}$ 下 $I(\\omega)$ 的图像。\n\n在正常态下，对于一个略高于超导临界温度 $T_c$ 的温度 $T$，金属系统具有穿过费米能级的连续电子态能带。这些准粒子态的色散由 $\\varepsilon(\\mathbf{k})$ 给出。在费米面上的任何动量 $\\mathbf{k}_F$ 处，色散都穿过费米能级，因此 $\\varepsilon(\\mathbf{k}_F) = 0$。因此，谱函数 $A(\\mathbf{k}_F, \\omega)$ 在 $\\omega = 0$ 处呈现一个尖锐的峰。在 $\\mathbf{k}_F$ 处观察到的 EDC 在 $\\omega=0$ 处显示一个前沿，而经过对称化处理（用于校正费米函数的截止效应）的 EDC 显示一个以 $\\omega=0$ 为中心的单峰。这表示在费米能级上存在无能隙的激发。\n\n在超导态下，当 $T \\ll T_c$ 时，库珀对的形成从根本上改变了单粒子激发谱。根据 Bardeen-Cooper-Schrieffer (BCS) 理论及其扩展，一个超导能隙 $\\Delta(\\mathbf{k})$ 在费米能级附近打开。新的准粒子激发（Bogoliubov 准粒子）的能量由下式给出：\n$$E(\\mathbf{k}) = \\sqrt{\\varepsilon(\\mathbf{k})^2 + \\Delta(\\mathbf{k})^2}$$\n至关重要的是，在费米动量 $\\mathbf{k}_F$ 处（正常态色散为 $\\varepsilon(\\mathbf{k}_F)=0$），产生一个准粒子激发所需的最小能量现在是非零的：\n$$E(\\mathbf{k}_F) = \\sqrt{0^2 + \\Delta(\\mathbf{k}_F)^2} = |\\Delta(\\mathbf{k}_F)|$$\n这意味着在费米能级处没有可用的态。原来在 $\\omega=0$ 处的谱权重被推开，在谱函数 $A(\\mathbf{k}_F, \\omega)$ 中于能量 $\\omega = \\pm |\\Delta(\\mathbf{k}_F)|$ 处形成两个“相干峰”。\n\n在实验上，这表现为在正常态下观察到的单个准粒子峰的分裂。在 $\\mathbf{k}_F$ 处的对称化 EDC 现在显示出位于结合能 $\\pm E_{\\text{pk}}$ 的两个清晰的对称峰。通过比较高于 $T_c$（在 $\\omega=0$ 处的单峰）和低于 $T_c$（在 $\\pm E_{\\text{pk}}$ 处的双峰）的能谱，可以直接、动量分辨地证明超导能隙的打开。测得的峰位 $E_{\\text{pk}}$ 是对该特定动量下费米面上能隙大小的直接测量：$E_{\\text{pk}}(\\varphi) = |\\Delta(\\varphi)|$。\n\n**第二部分：根据数据计算超导能隙大小**\n\n基于以上推理，测得的峰值能量 $E_{\\text{pk}}(\\varphi)$ 即为费米面上相应角度处的超导能隙大小 $\\Delta(\\varphi)$。\n- 在 $\\varphi=0$ 时：$\\Delta(0) = 24.00$ meV\n- 在 $\\varphi=\\pi/18$ 时：$\\Delta(\\pi/18) = 22.55$ meV\n- 在 $\\varphi=\\pi/9$ 时：$\\Delta(\\pi/9) = 18.39$ meV\n- 在 $\\varphi=\\pi/6$ 时：$\\Delta(\\pi/6) = 12.00$ meV\n- 在 $\\varphi=2\\pi/9$ 时：$\\Delta(2\\pi/9) = 4.17$ meV\n- 在 $\\varphi=\\pi/4$ 时：$\\Delta(\\pi/4) = 0.00$ meV\n\n**第三部分：能隙的解析表达式**\n\n我们需要找到一个解析函数 $\\Delta(\\varphi)$，它与问题的约束条件一致：四方对称性、自旋单态配对以及单谐波角度依赖性。\n- **自旋单态配对**要求库珀对波函数的轨道部分在反演下为偶，即 $\\Delta(\\mathbf{k}) = \\Delta(-\\mathbf{k})$，这转换成 $\\Delta(\\varphi) = \\Delta(\\varphi+\\pi)$。\n- **四方对称性**要求在 $90$ 度旋转下不变，即 $\\Delta(\\varphi) = \\Delta(\\varphi+\\pi/2)$。\n- 数据显示，能隙在反节点（$\\varphi=0$）处最大，在节点（$\\varphi=\\pi/4$）处为零。\n\n满足这些条件，特别是节点结构的最简单的谐波函数，属于 $\\text{D}_{4h}$ 点群的 $\\text{B}_{1g}$ 不可约表示，这对应于 $d_{x^2-y^2}$ 波对称性。对于一个具有近乎圆柱形费米面的准二维体系，这种对称性具有以下形式：\n$$\\Delta(\\varphi) = \\Delta_0 \\cos(2\\varphi)$$\n该函数在 $\\varphi=0$ 和 $\\pi$ 处有最大值，在 $\\varphi=\\pi/4$ 和 $3\\pi/4$ 处有节点，与给定的反节点和节点方向完美匹配。它还满足 $\\Delta(\\varphi+\\pi/2) = \\Delta_0\\cos(2(\\varphi+\\pi/2)) = \\Delta_0\\cos(2\\varphi+\\pi) = -\\Delta_0\\cos(2\\varphi)$。由于 ARPES 测量的是能隙的*大小* $|\\Delta(\\varphi)|$，其对称性为 $|\\cos(2\\varphi)|=|\\cos(2(\\varphi+\\pi/2))|$。在给定的范围 $\\varphi \\in [0, \\pi/4]$ 内，$2\\varphi \\in [0, \\pi/2]$ 且 $\\cos(2\\varphi) \\ge 0$，因此我们可以使用更简单的形式 $\\Delta(\\varphi) = \\Delta_0 \\cos(2\\varphi)$。\n\n为了确定振幅 $\\Delta_0$，我们可以将此模型与数据进行拟合。简单的观察就非常有启发性。\n使用反节点处的数据点，$\\varphi=0$:\n$\\Delta(0) = 24.00 \\text{ meV} = \\Delta_0 \\cos(2 \\cdot 0) = \\Delta_0 \\cdot 1$。这意味着 $\\Delta_0 = 24.00 \\text{ meV}$。\n\n让我们检查这个 $\\Delta_0$ 值是否与其他数据点一致：\n- 对于 $\\varphi=\\pi/18$: $\\Delta(\\pi/18) = 24.00 \\cos(\\pi/9) \\approx 24.00 \\times 0.9397 = 22.5528 \\text{ meV}$。这与测量的 $22.55 \\text{ meV}$ 相符。\n- 对于 $\\varphi=\\pi/9$: $\\Delta(\\pi/9) = 24.00 \\cos(2\\pi/9) \\approx 24.00 \\times 0.7660 = 18.385 \\text{ meV}$。这与测量的 $18.39 \\text{ meV}$ 相符。\n- 对于 $\\varphi=\\pi/6$: $\\Delta(\\pi/6) = 24.00 \\cos(\\pi/3) = 24.00 \\times 0.5 = 12.00 \\text{ meV}$。这完全匹配。\n- 对于 $\\varphi=2\\pi/9$: $\\Delta(2\\pi/9) = 24.00 \\cos(4\\pi/9) \\approx 24.00 \\times 0.1736 = 4.1664 \\text{ meV}$。这与测量的 $4.17 \\text{ meV}$ 相符。\n- 对于 $\\varphi=\\pi/4$: $\\Delta(\\pi/4) = 24.00 \\cos(\\pi/2) = 24.00 \\times 0 = 0.00 \\text{ meV}$。这完全匹配。\n\n模型 $\\Delta(\\varphi) = 24.00 \\cos(2\\varphi)$ 与数据拟合得异常准确，表明数据很可能是由这个精确的函数形式生成的。正式的最小二乘拟合将得出 $\\Delta_0 \\approx 24.00 \\text{ meV}$。\n\n问题要求将振幅参数报告为三位有效数字。因此，我们取 $\\Delta_0 = 24.0 \\text{ meV}$。因此，能隙大小的最终解析表达式为 $\\Delta(\\varphi) = 24.0 \\cos(2\\varphi)$，其中 $\\Delta$ 的单位是 meV，$\\varphi$ 的单位是弧度。", "answer": "$$\n\\boxed{24.0 \\cos(2\\varphi)}\n$$", "id": "2988210"}, {"introduction": "扫描隧道显微镜 (STM) 通过测量准粒子在杂质周围散射形成的干涉图样（QPI），为研究超导能隙的动量结构提供了另一种强大的实空间方法。这些干涉图样的傅里叶变换揭示了连接恒定能量轮廓上状态的散射矢量，从而可以重构出准粒子色散关系。本计算练习将引导您完成一个模拟工作流程：首先根据一个给定的各向异性能隙模型生成合成的 QPI 数据，然后通过反演这些数据来重构能隙函数 [@problem_id:2988261]。", "problem": "您的任务是构建一个程序化流程，该流程通过提取 Bogoliubov 准粒子的色散并重建超导能隙函数的动量依赖性，来模拟扫描隧道显微镜 (STM) 中观测到的准粒子干涉 (QPI) 如何为超导能隙提供实验证据。物理背景设定为一个二维单带超导体，其具有圆形费米面，在 Bardeen-Cooper-Schrieffer (BCS) 框架内描述，并在费米面附近进行线性化。您的程序必须从一个物理上一致的模型生成合成的 QPI 数据，然后反演这些数据以恢复超导能隙的角度依赖性，最后将一个简单的各向异性 $s$ 波能隙形式拟合到重建的值上。\n\n基本原理和定义：\n- 在 Bardeen–Cooper–Schrieffer (BCS) 框架中，Bogoliubov 准粒子色散由下式给出\n$$\nE(\\mathbf{k}) = \\sqrt{\\xi(\\mathbf{k})^2 + \\Delta(\\theta)^2},\n$$\n其中 $\\mathbf{k}$ 是晶体动量，$\\theta$ 是费米面上的极角，$E(\\mathbf{k})$ 是准粒子能量，$\\xi(\\mathbf{k})$ 是相对于化学势测量的正常态能带能量，$\\Delta(\\theta)$ 是超导能隙。\n- 在费米面附近，将正常态色散线性化为\n$$\n\\xi(k) = v_F \\left(k - k_F\\right),\n$$\n其中 $k = |\\mathbf{k}|$, $v_F$ 是费米速度（以 meV·nm 为单位，表示单位波矢的能量），$k_F$ 是费米波矢（以 nm$^{-1}$ 为单位）。\n- 假设一个形式如下的各向异性 $s$ 波能隙\n$$\n\\Delta(\\theta) = \\Delta_0 \\left(1 + a \\cos(4\\theta)\\right),\n$$\n其中 $\\Delta_0$ 是平均能隙幅值（以 meV 为单位），$a$ 是一个无量纲的各向异性参数。\n- 在准粒子干涉的联合态密度近似中，对于同一等能线上角度为 $\\theta$ 和 $\\theta + \\pi$ 的态之间的主导背散射，散射波矢的大小被建模为\n$$\nq(E,\\theta) \\approx 2 k(E,\\theta),\n$$\n其中 $k(E,\\theta)$ 表示在能量 $E$ 和角度 $\\theta$ 下满足 Bogoliubov 色散的动量大小。\n\n数据生成模型和反演任务：\n- 对于每个角度 $\\theta$，选择一个略高于局域能隙的能量 $E(\\theta)$，具体为\n$$\nE(\\theta) = \\Delta(\\theta) + \\delta E,\n$$\n其中 $\\delta E  0$ 是一个固定的能量偏移量（以 meV 为单位）。对于这个 $E(\\theta)$，相对于费米波矢的径向位移是\n$$\n\\delta k(\\theta) = \\frac{\\sqrt{E(\\theta)^2 - \\Delta(\\theta)^2}}{v_F}.\n$$\n- 那么，合成的测量背散射波矢是\n$$\nq(\\theta) = 2 \\left(k_F + \\delta k(\\theta)\\right),\n$$\n单位为 nm$^{-1}$。\n- 反演问题：给定 $E(\\theta)$ 和 $q(\\theta)$，通过以下方式在该角度重建局域能隙\n$$\n\\Delta_{\\text{rec}}(\\theta) = \\sqrt{E(\\theta)^2 - \\left(v_F \\left(\\frac{q(\\theta)}{2} - k_F\\right)\\right)^2}.\n$$\n- 然后将重建的角度依赖性 $\\Delta_{\\text{rec}}(\\theta)$ 拟合到参数形式\n$$\n\\Delta(\\theta) = A + B \\cos(4\\theta),\n$$\n使用线性最小二乘法提取 $A$ 和 $B$，并报告\n$$\n\\Delta_0 = A, \\quad a = \\frac{B}{A}.\n$$\n\n单位和角度约定：\n- 能量 $E$、$\\Delta_0$ 和 $\\Delta_{\\text{rec}}$ 必须以 meV 为单位处理。\n- 波矢 $k_F$ 和 $q$ 必须以 nm$^{-1}$ 为单位处理。\n- 费米速度 $v_F$ 必须以 meV·nm 为单位处理。\n- 角度 $\\theta$ 必须以弧度为单位处理。\n\n测试套件：\n在所有测试用例中使用以下通用参数：\n- 费米速度 $v_F = 25$ meV·nm。\n- 费米波矢 $k_F = 8$ nm$^{-1}$。\n- 能量偏移 $\\delta E = 0.4$ meV。\n- 弧度表示的角度集合 $\\Theta = \\{0, \\pi/8, \\pi/4, 3\\pi/8, \\pi/2\\}$。\n\n提供三个具有不同能隙参数的测试用例：\n1. 用例 1：$\\Delta_0 = 3.0$ meV, $a = 0.0$。\n2. 用例 2：$\\Delta_0 = 4.0$ meV, $a = 0.3$。\n3. 用例 3：$\\Delta_0 = 5.5$ meV, $a = -0.2$。\n\n对于每个用例，您的程序必须：\n- 使用正向模型为所有 $\\theta \\in \\Theta$ 生成合成的 $q(\\theta)$。\n- 反演 $E(\\theta)$ 和 $q(\\theta)$ 以计算所有 $\\theta \\in \\Theta$ 的 $\\Delta_{\\text{rec}}(\\theta)$。\n- 通过线性最小二乘法将 $\\Delta_{\\text{rec}}(\\theta)$ 拟合到 $\\Delta(\\theta) = A + B \\cos(4\\theta)$ 以获得 $A$ 和 $B$，并计算 $\\Delta_0 = A$ 和 $a = B/A$。\n- 将所有测试用例的拟合参数聚合到单行输出中。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，顺序如下\n$$\n[\\Delta_{0,1}, a_1, \\Delta_{0,2}, a_2, \\Delta_{0,3}, a_3],\n$$\n其中 $\\Delta_{0,i}$ 以 meV 为单位， $a_i$ 是无量纲的，所有数值都表示为浮点数。不应打印任何其他文本。", "solution": "问题陈述已经过分析，并被认为是有效的。它在科学上基于超导的 Bardeen-Cooper-Schrieffer (BCS) 理论和准粒子干涉 (QPI) 图样的分析。该问题是适定的，为获得唯一的确定性解提供了所有必要的参数和定义。模型和任务是客观的，并且可以在计算上形式化。\n\n该解决方案模拟了实验凝聚态物理学中的一个核心两阶段过程：从理论模型生成合成的实验数据，然后对合成数据应用反演和拟合程序以恢复原始模型的参数。这种方法验证了数据分析流程。\n\n**第 1 部分：正向模型 - 合成数据生成**\n\n第一步是为费米面上的离散角度集合 $\\Theta = \\{0, \\pi/8, \\pi/4, 3\\pi/8, \\pi/2\\}$ 生成合成的 QPI 数据，特别是散射波矢 $q(\\theta)$。此过程依赖于所提供的物理模型。\n\n1.  **各向异性超导能隙 $\\Delta(\\theta)$**：对于每个由平均能隙幅值 $\\Delta_0$ 和各向异性参数 $a$ 定义的测试用例，使用指定的各向异性 $s$ 波形式计算角度依赖的能隙 $\\Delta(\\theta)$：\n    $$\n    \\Delta(\\theta) = \\Delta_0 \\left(1 + a \\cos(4\\theta)\\right)\n    $$\n    该函数描述了在动量空间中，产生一个准粒子激发所需的能量成本如何随方向变化。\n\n2.  **探测能量 $E(\\theta)$**：在模拟的 QPI 实验中，我们在特定能量下探测系统。该模型将每个角度 $\\theta$ 的探测能量 $E(\\theta)$ 设置在比局域能隙值高一个固定偏移量 $\\delta E$ 的位置：\n    $$\n    E(\\theta) = \\Delta(\\theta) + \\delta E\n    $$\n    这种选择确保了对于每个方向，我们探测的都是恰好在超导能隙外的态，那里的 QPI 信号通常很强。\n\n3.  **动量偏移 $\\delta k(\\theta)$**：Bogoliubov 准粒子的能量由 $E(\\mathbf{k}) = \\sqrt{\\xi(\\mathbf{k})^2 + \\Delta(\\theta)^2}$ 给出。使用线性化的正常态色散 $\\xi(k) = v_F (k - k_F)$，我们可以求解在给定能量 $E$ 和角度 $\\theta$ 下的动量大小 $k$。重新排列色散关系可得：\n    $$\n    \\xi(k, \\theta)^2 = E(\\theta)^2 - \\Delta(\\theta)^2\n    $$\n    $$\n    \\left(v_F (k - k_F)\\right)^2 = E(\\theta)^2 - \\Delta(\\theta)^2\n    $$\n    因此，相对于费米波矢的径向位移 $\\delta k(\\theta) = k(E, \\theta) - k_F$ 为：\n    $$\n    \\delta k(\\theta) = \\frac{\\sqrt{E(\\theta)^2 - \\Delta(\\theta)^2}}{v_F}\n    $$\n    使用定义的 $E(\\theta) = \\Delta(\\theta) + \\delta E$，上式可简化为：\n    $$\n    \\delta k(\\theta) = \\frac{\\sqrt{(\\Delta(\\theta) + \\delta E)^2 - \\Delta(\\theta)^2}}{v_F} = \\frac{\\sqrt{2\\Delta(\\theta)\\delta E + \\delta E^2}}{v_F}\n    $$\n\n4.  **散射波矢 $q(\\theta)$**：合成的 QPI 信号是散射波矢的大小 $q(\\theta)$。假设在等能线上，点 $\\mathbf{k}$ 和 $-\\mathbf{k}$ 之间的背散射占主导地位，散射矢量 $\\mathbf{q} = \\mathbf{k} - (-\\mathbf{k}) = 2\\mathbf{k}$ 的大小近似为：\n    $$\n    q(\\theta) = 2k(E,\\theta) = 2 \\left(k_F + \\delta k(\\theta)\\right)\n    $$\n    对于 $\\theta_i \\in \\Theta$，这组 $\\{q(\\theta_i)\\}$ 构成了我们的合成实验数据。\n\n**第 2 部分：反演与参数拟合**\n\n第二步是处理合成数据 $\\{q(\\theta_i)\\}$，以重建能隙函数的参数 $\\Delta_0$ 和 $a$。\n\n1.  **能隙重建 $\\Delta_{\\text{rec}}(\\theta)$**：反演过程逆转了正向模型的步骤。给定能量 $E(\\theta)$ 和测量的散射矢量 $q(\\theta)$，目标是找出能隙 $\\Delta(\\theta)$。从关系式 $q(\\theta) = 2(k_F + \\delta k(\\theta))$，我们首先求出动量偏移：\n    $$\n    \\delta k(\\theta) = \\frac{q(\\theta)}{2} - k_F\n    $$\n    将此代入色散关系 $v_F \\delta k(\\theta) = \\sqrt{E(\\theta)^2 - \\Delta(\\theta)^2}$，我们可以解出重建的能隙 $\\Delta_{\\text{rec}}(\\theta)$：\n    $$\n    \\Delta_{\\text{rec}}(\\theta) = \\sqrt{E(\\theta)^2 - \\left(v_F \\left(\\frac{q(\\theta)}{2} - k_F\\right)\\right)^2}\n    $$\n    在这个无噪声的模拟中，重建的能隙 $\\Delta_{\\text{rec}}(\\theta)$ 在数值上将与用于生成数据的原始能隙 $\\Delta(\\theta)$ 完全相同。\n\n2.  **线性最小二乘拟合**：最后的任务是将重建的能隙值集合 $\\{\\Delta_{\\text{rec}}(\\theta_i)\\}$ 拟合到参数形式 $\\Delta_{\\text{fit}}(\\theta) = A + B \\cos(4\\theta)$。这是一个线性回归问题。我们有一组数据点 $(\\cos(4\\theta_i), \\Delta_{\\text{rec}}(\\theta_i))$，并且我们希望找到最佳拟合参数 $A$ 和 $B$。这可以用矩阵形式表示为 $Y = M\\beta$，其中：\n    - $Y = [\\Delta_{\\text{rec}}(\\theta_1), \\dots, \\Delta_{\\text{rec}}(\\theta_N)]^T$ 是观测值向量。\n    - $M$ 是设计矩阵，其中每一行是 $[1, \\cos(4\\theta_i)]$。\n    - $\\beta = [A, B]^T$ 是待定参数的向量。\n    \n    $\\beta$ 的最小二乘解使残差平方和 $\\|Y - M\\beta\\|^2$ 最小化。该解的正式形式为 $\\beta = (M^T M)^{-1} M^T Y$。在计算上，这可以使用标准的线性代数库函数（例如 `numpy.linalg.lstsq`）来解决。\n\n3.  **参数提取**：一旦拟合得到最优系数 $A$ 和 $B$，就可以通过将拟合形式 $\\Delta_{\\text{fit}}(\\theta) = A + B \\cos(4\\theta)$ 与原始模型 $\\Delta(\\theta) = \\Delta_0 + (\\Delta_0 a) \\cos(4\\theta)$ 进行比较来恢复能隙模型的物理参数。通过直接比较：\n    $$\n    A = \\Delta_0\n    $$\n    $$\n    B = \\Delta_0 a \\implies a = \\frac{B}{A}\n    $$\n    这些计算出的值 $\\Delta_0 = A$ 和 $a = B/A$ 代表每个测试用例的最终输出。程序将遍历所有测试用例并聚合这些结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    This function models the extraction of superconducting gap parameters from\n    synthetic Quasiparticle Interference (QPI) data. It performs three main steps\n    for each test case:\n    1. Generates synthetic QPI scattering wavevectors q(theta) from a given\n       anisotropic s-wave gap model.\n    2. Inverts the synthetic data to reconstruct the angle-dependent gap.\n    3. Fits the reconstructed gap to a parametric form using linear least\n       squares to recover the original model parameters.\n    \"\"\"\n\n    # Common physical and numerical parameters across all test cases.\n    v_F = 25.0  # Fermi velocity in meV·nm\n    k_F = 8.0   # Fermi wavevector in nm^-1\n    delta_E = 0.4 # Energy offset in meV\n    \n    # Set of angles for the QPI simulation, in radians.\n    thetas = np.array([0.0, np.pi/8.0, np.pi/4.0, 3.0*np.pi/8.0, np.pi/2.0])\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (Delta_0, a).\n    test_cases = [\n        (3.0, 0.0),\n        (4.0, 0.3),\n        (5.5, -0.2),\n    ]\n\n    all_results = []\n    for Delta_0_true, a_true in test_cases:\n        # --- Step 1: Forward Model - Generate Synthetic Data ---\n\n        # Calculate the true angle-dependent gap (Delta) for each theta.\n        Delta_true_values = Delta_0_true * (1.0 + a_true * np.cos(4.0 * thetas))\n\n        # Calculate the probe energy E for each theta.\n        E_theta_values = Delta_true_values + delta_E\n\n        # Calculate the radial displacement from the Fermi wavevector, delta_k.\n        # This follows from the Bogoliubov dispersion relation.\n        # The term under the square root is (E^2 - Delta^2).\n        term_sqrt = (E_theta_values**2 - Delta_true_values**2)\n        delta_k_values = np.sqrt(term_sqrt) / v_F\n\n        # Calculate the synthetic backscattering wavevector q.\n        q_theta_values = 2.0 * (k_F + delta_k_values)\n\n        # --- Step 2: Inversion - Reconstruct the Gap ---\n\n        # Invert the synthetic q(theta) and E(theta) data to get the reconstructed gap.\n        # This step validates the data analysis pipeline.\n        Delta_rec_values = np.sqrt(\n            E_theta_values**2 - (v_F * (q_theta_values / 2.0 - k_F))**2\n        )\n\n        # --- Step 3: Fitting - Extract Model Parameters ---\n\n        # We fit Delta_rec = A + B * x, where x = cos(4*theta).\n        # This is a linear least squares problem.\n        y_fit = Delta_rec_values\n        x_fit = np.cos(4.0 * thetas)\n        \n        # The design matrix M for the linear system M * [A, B]^T = y^T.\n        # The first column is for the constant term (A), the second for the cos term (B).\n        M = np.vstack([np.ones(len(thetas)), x_fit]).T\n        \n        # Solve the linear least squares problem for parameters [A, B].\n        params, _, _, _ = np.linalg.lstsq(M, y_fit, rcond=None)\n        A_fit, B_fit = params\n        \n        # Recover the physical parameters Delta_0 and a from the fitted A and B.\n        Delta_0_fit = A_fit\n        # A_fit should not be zero for the given test cases.\n        a_fit = B_fit / A_fit if not np.isclose(A_fit, 0) else np.nan\n            \n        all_results.extend([Delta_0_fit, a_fit])\n\n    # Final print statement in the exact required format.\n    # Use formatting to ensure clean float representation, removing trailing zeros.\n    formatted_results = [f'{r:.15f}'.rstrip('0').rstrip('.') for r in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2988261"}, {"introduction": "超导能隙不仅影响单粒子谱，还深刻地改变了通过超导结的电荷输运。虽然能隙抑制了能量低于 $\\Delta$ 的单粒子隧穿，但一种称为多重安德烈夫反射 (MAR) 的多粒子过程可以在能隙内产生电流。本练习要求您从第一性原理出发，推导出在超导体-正常金属-超导体 (SNS) 结中 MAR 过程的能量阶梯，并确定导致电导出现子谐波能隙结构的电压条件 [@problem_id:2988249]。", "problem": "一个短的超导体-正常金属-超导体（SNS）结被施加了一个直流电压 $V$，该电压作用于其超导电极两端。两个超导体均由 Bardeen–Cooper–Schrieffer (BCS) 理论描述，具有相同的零温能隙 $\\Delta$，正常区域是弹道的，且界面是完美透射的。假设温度为零，非弹性散射可忽略不计，并且全部电压降都发生在正常区域，因此超导凝聚体保持平衡，其化学势 $\\mu_{L}$ 和 $\\mu_{R}$ 满足 $\\mu_{L}-\\mu_{R}=eV$，其中 $e$ 是元电荷的大小。在偏压存在的情况下，子能隙输运由安德烈夫反射（Andreev reflection）介导，其中一个电子类准粒子（电荷为 $-e$）被逆向反射为一个空穴类准粒子（电荷为 $+e$），同时一个库珀对（Cooper pair）被转移到超导凝聚体中。\n\n从以下几点出发：\n- 带有能隙 $\\Delta$ 的 Bardeen–Cooper–Schrieffer (BCS) 准粒子谱，使得能量为 $|E|\\Delta$ 的单粒子态在超导体中是倏逝的，\n- 在正常区域两端存在化学势差 $\\mu_{L}-\\mu_{R}=eV$ 的情况下，能量守恒，\n- 以及安德烈夫反射在正常金属-超导体界面上的定义，即一个将能量为 $E$（相对于局域凝聚体）的电子类态转换为能量为 $-E$ 的空穴类态的过程，\n推导一个初始能量为 $E_{0}$ 且满足 $|E_{0}|\\Delta$ 的子能隙准粒子，在经过 $n$ 次连续的安德烈夫反射和穿越正常区域的过程后，能够达到连续谱 $|E|\\ge\\Delta$ 的条件。您的推导应明确构建准粒子在 $m$ 次穿越后的能量阶梯 $E_{m}$（用 $E_{0}$ 和 $eV$ 表示），并确定第 $n$ 阶过程在能量上被允许的最小偏压 $V$。\n\n将第 $n$ 阶多重安德烈夫反射的起始电压 $V_{n}$ 的最终结果以伏特为单位表示。最终答案必须是单一的闭式解析表达式。", "solution": "该问题要求推导在一个短的、弹道的超导体-正常金属-超导体（SNS）结中，第 $n$ 阶多重安德烈夫反射（MAR）过程的起始电压。\n\n**问题有效性判断：** 该问题有效。它在一个标准理论框架（BCS理论，偏压结模型）内描述了一个公认的物理现象（多重安德烈夫反射）。其前提在科学上是合理的，目标明确且形式上可解。所有构建严谨推导所需的信息均已提供。\n\n**1. 能级设置与准粒子动力学**\n设正常区域中心的化学势为参考能量，记为 $0$。一个偏压 $V$ 对称地施加在结上，使得左（L）和右（R）超导体的化学势分别为 $\\mu_{L} = +eV/2$ 和 $\\mu_{R} = -eV/2$。这满足了给定条件 $\\mu_{L} - \\mu_{R} = eV$。两个超导体具有相同的能隙 $\\Delta$，意味着在能量范围 $|E_{rel}|  \\Delta$ 内不存在单粒子态，其中 $E_{rel}$ 是相对于局域超导凝聚体化学势的能量。\n\n在正常区域中，一个绝对能量为 $E$ 的准粒子，其相对于左超导体的相对能量为 $E_L = E - \\mu_L$，相对于右超导体的相对能量为 $E_R = E - \\mu_R$。\n\n在正常金属-超导体（NS）界面上的安德烈夫反射，将一个类型（电子类或空穴类）的入射准粒子（相对能量为 $E_{rel}$）转换为另一个类型的出射准粒子（相对能量为 $-E_{rel}$）。如果入射准粒子的绝对能量为 $E_{in}$，并撞击到一个势为 $\\mu_{target}$ 的超导体上，其相对能量为 $E_{in} - \\mu_{target}$。反射后的准粒子的相对能量为 $-(E_{in} - \\mu_{target})$。因此，其新的绝对能量 $E_{out}$ 为：\n$$E_{out} = -(E_{in} - \\mu_{target}) + \\mu_{target} = -E_{in} + 2\\mu_{target}$$\n\n**2. 能量阶梯的构建**\n我们来追踪一个在正常区域中，以电子类激发形式开始运动的准粒子，其初始绝对能量为 $E_0$，从左向右（L $\\rightarrow$ R）移动。我们定义 $E_m$ 为该准粒子在经过 $m$ 次穿越正常区域和 $m$ 次安德烈夫反射后的绝对能量。\n\n- **初始状态 (m=0):** 一个电子类准粒子以能量 $E_0$ 开始其第一次穿越（L $\\rightarrow$ R）。\n\n- **第一次反射后 (m=1):** 能量为 $E_0$ 的电子类准粒子到达右界面（S$_R$），此处的势为 $\\mu_R = -eV/2$。它经历安德烈夫反射。新的能量为：\n$$E_1 = -E_0 + 2\\mu_R = -E_0 - eV$$\n此时，准粒子变为空穴类，并从 R $\\rightarrow$ L 移动。\n\n- **第二次反射后 (m=2):** 能量为 $E_1$ 的空穴类准粒子到达左界面（S$_L$），此处的势为 $\\mu_L = +eV/2$。它经历安德烈夫反射。新的能量为：\n$$E_2 = -E_1 + 2\\mu_L = -(-E_0 - eV) + eV = E_0 + 2eV$$\n此时，准粒子变为电子类，并从 L $\\rightarrow$ R 移动。\n\n- **第三次反射后 (m=3):** 能量为 $E_2$ 的电子类准粒子到达右界面（S$_R$）：\n$$E_3 = -E_2 + 2\\mu_R = -(E_0 + 2eV) - eV = -E_0 - 3eV$$\n此时，准粒子变为空穴类，并从 R $\\rightarrow$ L 移动。\n\n这就建立了准粒子在 $m$ 次反射后的能量阶梯 $E_m$：\n$$E_m = \\begin{cases} E_0 + m \\cdot eV  \\text{若 } m \\text{ 为偶数} \\\\ -E_0 - m \\cdot eV  \\text{若 } m \\text{ 为奇数} \\end{cases}$$\n\n**3. 多重安德烈夫反射的条件**\n为了使MAR过程发生，准粒子在其反射过程中必须保持在子能隙态。一个能量为 $E_{in}$ 的入射准粒子，在一个势为 $\\mu_{target}$ 的界面上被反射，当且仅当其相对能量在能隙内，即 $|E_{in} - \\mu_{target}|  \\Delta$。如果 $|E_{in} - \\mu_{target}| \\ge \\Delta$，准粒子将逃逸到超导体的连续态中。\n\n让我们找出第 $m$ 次反射为子能隙过程的一般条件。正在进行第 $m$ 次反射的粒子已经完成了 $m-1$ 次穿越，其能量为 $E_{m-1}$。\n\n- 如果 $m$ 是奇数，粒子接近 S$_R$（$\\mu_{target} = -eV/2$）。它是一个电子类准粒子，能量为 $E_{m-1} = E_0 + (m-1)eV$（因为 $m-1$ 是偶数）。子能隙条件为：\n$$|E_{m-1} - \\mu_R| = |E_0 + (m-1)eV - (-eV/2)| = |E_0 + \\frac{(2m-1)eV}{2}|  \\Delta$$\n\n- 如果 $m$ 是偶数，粒子接近 S$_L$（$\\mu_{target} = +eV/2$）。它是一个空穴类准粒子，能量为 $E_{m-1} = -E_0 - (m-1)eV$（因为 $m-1$ 是奇数）。子能隙条件为：\n$$|E_{m-1} - \\mu_L| = |-E_0 - (m-1)eV - (eV/2)| = |-(E_0 + \\frac{(2m-1)eV}{2})| = |E_0 + \\frac{(2m-1)eV}{2}|  \\Delta$$\n\n因此，第 $m$ 次反射为子能隙过程的条件在两种情况下是相同的：\n$$|E_0 + \\frac{(2m-1)eV}{2}|  \\Delta$$\n\n**4. 第 n 阶过程的起始电压**\n第 $n$ 阶 MAR 过程在电压 $V_n$ 时在能量上变为可能，此时一个准粒子可以经历 $n-1$ 次子能隙反射，然后在第 $n$ 次反射时逃逸到连续谱中。这需要找到最小电压 $V_n$，使得存在一个初始能量 $E_0$ 满足：\n1.  对于所有 $m \\in \\{1, 2, \\dots, n-1\\}$，$|E_0 + \\frac{(2m-1)eV_n}{2}|  \\Delta$。\n2.  $|E_0 + \\frac{(2n-1)eV_n}{2}| \\ge \\Delta$ （起始点在等号成立时）。\n\n初始状态是一个“子能隙准粒子”。为了使这样一个粒子存在于正常区域，其能量 $E_0$ 必须低于*两个*超导体的能隙边缘。这意味着 $|E_0 - \\mu_L|  \\Delta$ 和 $|E_0 - \\mu_R|  \\Delta$。\n- $|E_0 - eV/2|  \\Delta \\implies - \\Delta + eV/2  E_0  \\Delta + eV/2$\n- $|E_0 + eV/2|  \\Delta \\implies - \\Delta - eV/2  E_0  \\Delta - eV/2$\n这些范围的交集定义了 $E_0$ 的允许能量：$|E_0|  \\Delta - eV/2$。这要求 $\\Delta - eV/2  0$，即 $eV  2\\Delta$。\n\n让我们对变量进行归一化：$x = E_0/\\Delta$ 和 $v = eV/(2\\Delta)$。条件变为：\n- $|x|  1-v$ （初始态的范围）\n- 对于 $m=1, \\dots, n-1$，$|x + (2m-1)v|  1$ （子能隙反射）\n- $|x + (2n-1)v| = 1$ （逃逸的起始点）\n\n从起始条件，我们得到 $x = \\pm 1 - (2n-1)v$。我们将此代入 $x$ 的范围条件中：\n$|\\pm 1 - (2n-1)v|  1-v$。\n\n- 情况 $x = 1 - (2n-1)v$：\n  $|1 - (2n-1)v|  1-v$。\n  这给出了两个不等式：\n  a) $1 - (2n-1)v  1-v \\implies -(2n-1)v  -v \\implies (2n-2)v  0$。由于 $v0$，这意味着 $n1$。\n  b) $-(1-v)  1 - (2n-1)v \\implies -1+v  1 - 2nv + v \\implies 2nv  2 \\implies v  1/n$。\n\n- 情况 $x = -1 - (2n-1)v$：\n  $|-1 - (2n-1)v|  1-v \\implies 1 + (2n-1)v  1-v \\implies 2nv  0$。对于 $v0$ 这是不可能的。\n\n因此，该过程仅在 $v  1/n$ 时才可能发生。我们还必须满足对于 $m=1, \\dots, n-1$ 的中间子能隙条件：\n$|x + (2m-1)v| = |(1-(2n-1)v) + (2m-1)v| = |1 - 2(n-m)v|  1$。\n由于 $nm$ 且 $v0$，这简化为 $1-2(n-m)v  -1$，意味着 $2(n-m)v  2$，即 $v  1/(n-m)$。这必须对所有 $m \\in \\{1, \\dots, n-1\\}$ 成立。其中最严格的条件是当 $n-m$ 取最大值时，即 $m=1$ 时：$v  1/(n-1)$。\n\n对于该过程的可能性，我们对 $v$ 有两个约束：$v  1/n$ 和 $v  1/(n-1)$。因为对于 $n \\ge 2$，$1/n  1/(n-1)$，所以条件 $v  1/n$ 是更严格的。\n\n第 $n$ 阶过程变得可能的最小电压 $V_n$（以及最小的 $v_n$）对应于这个允许区域的边界。因此，起始电压由下式给出：\n$$v_n = \\frac{1}{n}$$\n将 $v_n = eV_n/(2\\Delta)$ 代回：\n$$\\frac{eV_n}{2\\Delta} = \\frac{1}{n}$$\n求解 $V_n$ 得到起始电压的最终表达式。\n$$V_n = \\frac{2\\Delta}{ne}$$\n这个结果代表了一个由 $n$ 次安德烈夫反射介导的特定电流通道开启时的电压。", "answer": "$$\\boxed{\\frac{2\\Delta}{ne}}$$", "id": "2988249"}]}