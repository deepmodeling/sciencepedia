{"hands_on_practices": [{"introduction": "铁磁材料中磁滞现象最重要的实际影响之一是能量耗散。本练习旨在建立一个基础性的联系：将抽象的磁滞回线面积与一个可量化的物理量——在每个磁化周期中以热量形式损失的能量——联系起来。通过对一个理想化的矩形磁滞回线进行分析 [@problem_id:2995439]，你将从基本电磁学原理出发，推导出能量损失的表达式，为理解更复杂、更现实的磁滞行为奠定坚实的基础。", "problem": "一块电导率可忽略不计的体铁磁体，在准静态条件下，被一个振幅为 $H_{0}$ 且空间均匀的外磁场 $H(t)$ 驱动，该振幅 $H_{0}$ 满足 $H_{0} \\ge H_{c}$。该材料的磁化强度 $M$ 随磁场 $H$ 的变化呈现矩形磁滞回线：当 $|H|H_{c}$ 时，磁化强度饱和在 $M=\\pm M_{s}$；而当 $H$ 穿过矫顽场值 $\\pm H_{c}$ 时，磁化强度在 $-M_{s}$ 和 $+M_{s}$ 之间不连续地翻转。假设磁感应强度由 $B=\\mu_{0}(H+M)$ 给出，其中 $\\mu_{0}$ 是国际单位制（SI）中的自由空间磁导率，并且除了准静态磁滞外，没有额外的动态损耗。\n\n从静磁学的基本能量平衡出发，推导在一个完整的 $H(t)$ 周期内，单位体积所耗散的能量，并用 $\\mu_{0}$、$M_{s}$ 和 $H_{c}$ 表示。然后，基于同样的基础，解释为什么在准静态条件下，该能量损耗与驱动频率无关。将最终的单位体积每周期的能量损耗表示为单一的闭式解析表达式，单位为焦耳/立方米/周期。请勿提供任何数值近似。", "solution": "该问题要求基于基本能量平衡，推导铁磁材料在所施加磁场的一个完整周期内单位体积所耗散的能量。该材料的特征是具有矩形磁滞回线。\n\n静磁学中能量平衡的起点是，在磁场 $H$ 存在的情况下，外部源改变磁感应强度 $dB$ 所做的单位体积微分功 $dW$。其表达式为：\n$$dW = H \\, dB$$\n磁场 $H(t)$ 在一个完整周期内，源提供的单位体积总能量是该量对周期的积分：\n$$W_{cycle} = \\oint H \\, dB$$\n磁感应强度 $B$ 由本构关系 $B = \\mu_{0}(H+M)$ 给出，其中 $\\mu_{0}$ 是自由空间磁导率，$H$ 是磁场，$M$ 是材料的磁化强度。因此，$B$ 的微分为：\n$$dB = \\mu_{0}(dH + dM)$$\n将此代入每周期功的表达式中，得到：\n$$W_{cycle} = \\oint H \\mu_{0}(dH + dM) = \\mu_{0} \\oint H \\, dH + \\mu_{0} \\oint H \\, dM$$\n第一项 $\\mu_{0} \\oint H \\, dH$ 代表储存在磁场本身的能量。由于 $H$ 是状态变量，其在一个周期的起点和终点的值是相同的。因此，像 $H \\, dH = d\\left(\\frac{1}{2}H^2\\right)$ 这样的全微分沿闭合路径的积分为零：\n$$\\mu_{0} \\oint H \\, dH = \\mu_{0} \\int d\\left(\\frac{1}{2}H^2\\right) = 0$$\n这一项对应于可逆地储存在场中并返回到源的能量。\n\n第二项 $W_{diss} = \\mu_{0} \\oint H \\, dM$ 代表对材料内部磁畴所做的不可逆功。这部分功以热量的形式耗散掉，其值非零是因为 $M$ 和 $H$ 之间的关系是磁滞的，意味着 $M$ 不是 $H$ 的单值函数。因此，单位体积每周期的耗散能量由该积分给出，其值等于 $\\mu_{0}$ 乘以 $M-H$ 磁滞回线所包围的面积。\n$$W_{diss} = \\mu_{0} \\oint H \\, dM$$\n现在我们对指定的矩形磁滞回线计算这个积分。外磁场 $H(t)$ 的周期振幅为 $H_{0}$，满足 $H_{0} \\ge H_{c}$。让我们从点 $(H, M) = (H_{0}, M_{s})$ 开始，追踪一个完整周期。\n\n1.  **路径 1：$H$ 从 $H_{0}$ 减小到 $-H_{c}$。**\n    材料处于饱和状态，因此磁化强度 $M$ 保持在 $M_s$ 不变。沿着这条路径，$dM = 0$。对积分的贡献为零：\n    $$\\int_{H_{0}}^{-H_{c}} H \\, (0) = 0$$\n\n2.  **路径 2：$H$ 处于 $-H_{c}$，磁化强度发生翻转。**\n    在 $H = -H_{c}$ 时，磁化强度从 $M = +M_{s}$ 不连续地翻转到 $M = -M_{s}$。在翻转期间，$H$ 恒定为 $-H_{c}$。沿着回线的这个垂直段的积分为：\n    $$\\int_{+M_{s}}^{-M_{s}} (-H_{c}) \\, dM = -H_{c} [M]_{+M_{s}}^{-M_{s}} = -H_{c}(-M_{s} - M_{s}) = 2H_{c}M_{s}$$\n\n3.  **路径 3：$H$ 从 $-H_{c}$ 减小到 $-H_{0}$。**\n    此时磁化强度在相反方向上饱和，因此 $M$ 保持在 $-M_s$ 不变。沿着这条路径，$dM = 0$。对积分的贡献为零。\n\n4.  **路径 4：$H$ 从 $-H_{0}$ 增大到 $+H_{c}$。**\n    同样，$M$ 保持在 $-M_s$ 不变，所以 $dM = 0$。对积分的贡献为零。\n\n5.  **路径 5：$H$ 处于 $+H_{c}$，磁化强度翻转回来。**\n    在 $H = +H_c$ 时，磁化强度从 $M = -M_s$ 不连续地翻转到 $M = +M_s$。在翻转期间，$H$ 恒定为 $+H_c$。积分为：\n    $$\\int_{-M_{s}}^{+M_{s}} (+H_{c}) \\, dM = H_{c} [M]_{-M_{s}}^{+M_{s}} = H_{c}(M_{s} - (-M_{s})) = 2H_{c}M_{s}$$\n\n6.  **路径 6：$H$ 从 $+H_{c}$ 增大到 $H_{0}$。**\n    磁化强度再次在 $M_s$ 处饱和，所以 $dM = 0$。贡献为零。\n\n将所有路径的贡献相加，得到回线所包围的总面积：\n$$\\oint H \\, dM = 0 + 2H_{c}M_{s} + 0 + 0 + 2H_{c}M_{s} + 0 = 4H_{c}M_{s}$$\n该值是 $M-H$ 平面中矩形的面积，其宽度为 $2H_{c}$，高度为 $2M_{s}$。\n\n因此，在一个完整周期内单位体积所耗散的总能量为：\n$$W_{diss} = \\mu_{0} \\oint H \\, dM = 4\\mu_{0}H_{c}M_{s}$$\n\n接下来，我们必须解释为什么在准静态条件下，这种能量损耗与驱动频率无关。术语“准静态”意味着系统被驱动得非常缓慢，以至于在任何时刻，它都任意接近于静磁平衡。在这种条件下，系统的状态，特别是其磁化强度 $M$，仅是瞬时施加场 $H$ 的函数，并遵循指定的静态磁滞回线。因此，由材料参数 $M_{s}$ 和 $H_{c}$ 定义的 $M-H$ 回线的形状，与磁场 $H(t)$ 变化的快慢无关。\n\n由于每周期耗散的能量 $W_{diss}$ 与 $M-H$ 回线所包围的面积成正比，并且在准静态条件下这个面积是恒定的，所以*每周期*的耗散能量与驱动频率无关。“电导率可忽略不计”和“无额外动态损耗”的假设至关重要，因为它明确排除了频率依赖性的损耗机制，例如涡流或其他动态弛豫效应，这些效应会导致磁滞回线的面积随频率增加而增大。需要注意的是，虽然每周期的能量损耗是恒定的，但时间平均的功率耗散 $P_{diss} = W_{diss} \\times f$（其中 $f$ 是频率）与频率成正比。", "answer": "$$\n\\boxed{4\\mu_{0}H_{c}M_{s}}\n$$", "id": "2995439"}, {"introduction": "理解了磁滞回线的面积代表能量损失后，一个自然而然的问题是：是什么机制产生了磁滞回线并赋予其宽度（即矫顽力）？本练习通过一个微观模型深入探讨了这个问题。你将把畴壁模拟为一根与单个钉扎缺陷相互作用的弹性线 [@problem_id:2995361]，并通过能量最小化原理，从畴壁张力 $\\Gamma$ 和缺陷强度 $U$ 等基本参数出发，推导出矫顽力，从而深刻揭示磁硬度的物理起源。", "problem": "考虑一个铁磁性薄膜，其上存在一个沿 $y$ 坐标轴、总跨度为 $L$ 的一维直线型 $180^{\\circ}$ 磁畴壁。该磁畴壁被建模为一个线张力为 $\\Gamma$ 的弹性弦，其对于位移场 $z(y)$ 的弹性势能由 $E_{\\mathrm{el}}[z] = \\frac{\\Gamma}{2} \\int_{-L/2}^{L/2} (\\partial_{y} z)^{2} \\, dy$ 给出。位于 $y=0$ 处的一个局域缺陷通过短程束缚势与磁畴壁耦合，其对磁畴壁的影响可以用磁畴壁中心位移 $x \\equiv z(0)$ 来近似表示，即附加一个局域二次势能：当 $|x| \\leq \\xi$ 时，$V_{\\mathrm{def}}(x) = \\frac{U}{2} x^{2}$；当 $|x|  \\xi$ 时，$V_{\\mathrm{def}}(x) = 0$。此处 $U$ 是缺陷劲度，$\\xi$ 是其俘获半径。沿易磁化轴方向的外部均匀磁场 $H$ 对磁畴壁施加一个压强，产生线力密度 $f_{\\ell} = 2 \\mu_{0} M_{s} H \\, t$，其中 $\\mu_{0}$ 是真空磁导率，$M_{s}$ 是饱和磁化强度，$t$ 是膜厚度。假设准静态演化，且磁畴壁端点被固定，即 $z(-L/2) = z(L/2) = 0$。\n\n从上述要素出发，并应用能量最小化第一性原理，完成以下任务：\n\n1. 当磁畴壁中心位移被约束为 $x$ 且端点满足 $z(\\pm L/2)=0$ 时，确定磁畴壁的最小弹性势能 $E_{\\mathrm{el}}(x)$。由此，确定一个等效弹性劲度 $K$，使得 $E_{\\mathrm{el}}(x) = \\frac{K}{2} x^{2}$。\n\n2. 对于中心位移为 $x$ 的能量最小化形状，通过计算 $\\int_{-L/2}^{L/2} z(y) \\, dy$ 来包含由外场引起的线力 $f_{\\ell}$ 所做的功，并写出在 $|x| \\leq \\xi$ 和 $|x|  \\xi$ 这两种情况下，磁畴壁总准静态能量 $E(x)$ 作为 $x$ 的函数。\n\n3. 对于从 $0$ 开始缓慢增加的 $H$，确定正向去钉扎阈值 $H_{c}^{+}$，此时在 $|x| \\leq \\xi$ 处的亚稳态钉扎极小值消失。对于去钉扎后缓慢减小的 $H$，确定反向再钉扎阈值 $H_{c}^{-}$，此时在 $|x|  \\xi$ 处的未钉扎极小值重新进入缺陷俘获半径。然后求出磁滞宽度 $\\Delta H \\equiv H_{c}^{+} - H_{c}^{-}$。\n\n用 $\\Gamma$、$U$、$\\xi$、$L$、$\\mu_{0}$、$M_{s}$ 和 $t$ 来表示你对 $H_{c}^{+}$、$H_{c}^{-}$ 和 $\\Delta H$ 的最终答案，单位为安培/米 (A/m)。最终答案必须是单一的闭式解析表达式。无需四舍五入。", "solution": "该问题是有效的，因为它在科学上基于微磁学和驱动弹性界面物理学的既定原理，信息充分、边界条件清晰，属良定问题，并且以客观、正式的语言表述。我们可以按照所列步骤进行求解。\n\n### 1. 最小弹性势能与等效劲度 $K$\n\n磁畴壁的弹性势能由泛函 $E_{\\mathrm{el}}[z] = \\frac{\\Gamma}{2} \\int_{-L/2}^{L/2} (\\partial_{y} z)^{2} \\, dy$ 给出。为找到在边界条件 $z(\\pm L/2) = 0$ 和约束条件 $z(0)=x$ 下使该能量最小化的磁畴壁形状 $z(y)$，我们使用变分法。被积函数 $\\mathcal{L} = \\frac{\\Gamma}{2} (\\partial_{y} z)^{2}$ 的欧拉-拉格朗日方程为：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial z} - \\frac{d}{dy}\\left(\\frac{\\partial \\mathcal{L}}{\\partial (\\partial_{y} z)}\\right) = 0\n$$\n由于 $\\frac{\\partial \\mathcal{L}}{\\partial z} = 0$ 且 $\\frac{\\partial \\mathcal{L}}{\\partial (\\partial_{y} z)} = \\Gamma \\partial_{y} z$，方程变为：\n$$\n-\\frac{d}{dy}(\\Gamma \\partial_{y} z) = -\\Gamma \\partial_{yy} z = 0 \\implies \\partial_{yy} z = 0\n$$\n通解是 $y$ 的一个线性函数。由于在 $y=0$ 处存在约束，我们必须为磁畴壁的形状考虑两个独立的部分：一段在 $y \\in [-L/2, 0]$，另一段在 $y \\in [0, L/2]$。\n\n对于 $y \\in [0, L/2]$ 的部分：\n通解为 $z(y) = A_1 y + B_1$。应用条件 $z(0)=x$ 和 $z(L/2)=0$：\n- $z(0) = A_1(0) + B_1 = x \\implies B_1 = x$。\n- $z(L/2) = A_1(L/2) + x = 0 \\implies A_1 = -2x/L$。\n因此，对于 $y \\in [0, L/2]$，形状为 $z(y) = x(1 - 2y/L)$。\n\n对于 $y \\in [-L/2, 0]$ 的部分：\n通解为 $z(y) = A_2 y + B_2$。应用条件 $z(0)=x$ 和 $z(-L/2)=0$：\n- $z(0) = A_2(0) + B_2 = x \\implies B_2 = x$。\n- $z(-L/2) = A_2(-L/2) + x = 0 \\implies A_2 = 2x/L$。\n因此，对于 $y \\in [-L/2, 0]$，形状为 $z(y) = x(1 + 2y/L)$。\n\n这两个表达式可以用绝对值合并为一个：$z(y) = x(1 - 2|y|/L)$。这描述了磁畴壁的一种三角形或“帐篷”状的形状。\n\n现在，我们计算此构型的最小弹性势能 $E_{\\mathrm{el}}(x)$。当 $y \\neq 0$ 时，其导数为 $\\partial_y z = - (2x/L)\\mathrm{sgn}(y)$。其平方为 $(\\partial_y z)^2 = 4x^2/L^2$。\n$$\nE_{\\mathrm{el}}(x) = \\frac{\\Gamma}{2} \\int_{-L/2}^{L/2} \\left(\\frac{4x^2}{L^2}\\right) dy = \\frac{2\\Gamma x^2}{L^2} \\int_{-L/2}^{L/2} dy = \\frac{2\\Gamma x^2}{L^2} (L) = \\frac{2\\Gamma x^2}{L}\n$$\n我们需要从关系式 $E_{\\mathrm{el}}(x) = \\frac{K}{2} x^2$ 中确定一个等效弹性劲度 $K$。\n$$\n\\frac{K}{2} x^2 = \\frac{2\\Gamma x^2}{L} \\implies K = \\frac{4\\Gamma}{L}\n$$\n\n### 2. 总准静态能量 $E(x)$\n\n总能量 $E(x)$ 是弹性势能 $E_{\\mathrm{el}}(x)$、缺陷势能 $V_{\\mathrm{def}}(x)$ 以及由外场引起的势能之和。线力 $f_{\\ell}$ 在位移 $z(y)$ 下对磁畴壁做的功为 $W = \\int f_{\\ell} z(y) dy$。相应的势能项为 $-W$。\n位移剖面的积分为：\n$$\n\\int_{-L/2}^{L/2} z(y) dy = \\int_{-L/2}^{L/2} x(1 - 2|y|/L) dy = 2x \\int_{0}^{L/2} (1 - 2y/L) dy\n$$\n$$\n= 2x \\left[ y - \\frac{y^2}{L} \\right]_{0}^{L/2} = 2x \\left( \\frac{L}{2} - \\frac{(L/2)^2}{L} \\right) = 2x \\left( \\frac{L}{2} - \\frac{L}{4} \\right) = \\frac{xL}{2}\n$$\n来自磁场的势能为 $-f_{\\ell} \\int z(y) dy$。代入 $f_{\\ell} = 2 \\mu_{0} M_{s} H t$：\n$$\nE_{\\mathrm{field}}(x) = -(2 \\mu_{0} M_{s} H t) \\left(\\frac{xL}{2}\\right) = -\\mu_{0} M_{s} t L H x\n$$\n因此，总能量 $E(x)$ 为：\n$$\nE(x) = E_{\\mathrm{el}}(x) + V_{\\mathrm{def}}(x) + E_{\\mathrm{field}}(x) = \\frac{2\\Gamma}{L} x^2 + V_{\\mathrm{def}}(x) - \\mu_{0} M_{s} t L H x\n$$\n我们现在为缺陷势的两种情况写出该式：\n- 对于 $|x| \\leq \\xi$ (钉扎情况): $V_{\\mathrm{def}}(x) = \\frac{U}{2}x^2$。\n$$\nE_{\\mathrm{pinned}}(x) = \\frac{2\\Gamma}{L} x^2 + \\frac{U}{2} x^2 - \\mu_{0} M_{s} t L H x = \\frac{1}{2} \\left(\\frac{4\\Gamma}{L} + U\\right)x^2 - \\mu_{0} M_{s} t L H x\n$$\n使用 $K=4\\Gamma/L$，此式为 $E_{\\mathrm{pinned}}(x) = \\frac{1}{2}(K+U)x^2 - \\mu_{0} M_{s} t L H x$。\n- 对于 $|x|  \\xi$ (未钉扎情况): $V_{\\mathrm{def}}(x) = 0$。\n$$\nE_{\\mathrm{unpinned}}(x) = \\frac{2\\Gamma}{L} x^2 - \\mu_{0} M_{s} t L H x = \\frac{K}{2} x^2 - \\mu_{0} M_{s} t L H x\n$$\n\n### 3. 去钉扎、再钉扎与磁滞\n\n临界场对应于总能量 $E(x)$ 极小值稳定性的变化。我们假设 $H0$，因此我们关心的是 $x0$ 的情况。\n\n**正向去钉扎阈值 $H_{c}^{+}$**：\n从 $H=0$ 开始，磁畴壁处于钉扎状态，其平衡位置由 $E_{\\mathrm{pinned}}(x)$ 的极小值确定。我们通过将导数设为零来找到极小值：\n$$\n\\frac{dE_{\\mathrm{pinned}}}{dx} = (K+U)x - \\mu_{0} M_{s} t L H = 0 \\implies x_{\\mathrm{min,p}} = \\frac{\\mu_{0} M_{s} t L H}{K+U}\n$$\n只要 $x_{\\mathrm{min,p}}  \\xi$，这就代表一个稳定的局域极小值。当这个局域极小值在俘获半径内不复存在时，就会发生去钉扎。这发生在极小值被推到缺陷区域边界时，即 $x_{\\mathrm{min,p}} = \\xi$。发生这种情况时的磁场即为正向去钉扎阈值 $H_{c}^{+}$：\n$$\n\\xi = \\frac{\\mu_{0} M_{s} t L H_{c}^{+}}{K+U} \\implies H_{c}^{+} = \\frac{(K+U)\\xi}{\\mu_{0} M_{s} t L}\n$$\n代入 $K = 4\\Gamma/L$：\n$$\nH_{c}^{+} = \\frac{(4\\Gamma/L + U)\\xi}{\\mu_{0} M_{s} t L} = \\frac{(4\\Gamma + UL)\\xi}{\\mu_{0} M_{s} t L^2}\n$$\n\n**反向再钉扎阈值 $H_{c}^{-}$**：\n去钉扎后（$H  H_{c}^{+}$），磁畴壁处于未钉扎状态，其平衡位置由 $E_{\\mathrm{unpinned}}(x)$ 的极小值给出：\n$$\n\\frac{dE_{\\mathrm{unpinned}}}{dx} = Kx - \\mu_{0} M_{s} t L H = 0 \\implies x_{\\mathrm{min,u}} = \\frac{\\mu_{0} M_{s} t L H}{K}\n$$\n当磁场 $H$ 从一个大值减小时，$x_{\\mathrm{min,u}}$ 减小。当未钉扎的极小值重新进入缺陷俘获半径时，发生再钉扎，即在阈值 $x_{\\mathrm{min,u}} = \\xi$ 处。这定义了反向再钉扎阈值 $H_{c}^{-}$：\n$$\n\\xi = \\frac{\\mu_{0} M_{s} t L H_{c}^{-}}{K} \\implies H_{c}^{-} = \\frac{K\\xi}{\\mu_{0} M_{s} t L}\n$$\n代入 $K = 4\\Gamma/L$：\n$$\nH_{c}^{-} = \\frac{(4\\Gamma/L)\\xi}{\\mu_{0} M_{s} t L} = \\frac{4\\Gamma\\xi}{\\mu_{0} M_{s} t L^2}\n$$\n\n**磁滞宽度 $\\Delta H$**：\n磁滞宽度是正向和反向临界场之差：\n$$\n\\Delta H = H_{c}^{+} - H_{c}^{-} = \\frac{(K+U)\\xi}{\\mu_{0} M_{s} t L} - \\frac{K\\xi}{\\mu_{0} M_{s} t L}\n$$\n$$\n\\Delta H = \\frac{(K+U-K)\\xi}{\\mu_{0} M_{s} t L} = \\frac{U\\xi}{\\mu_{0} M_{s} t L}\n$$\n此结果表明，磁滞宽度与由乘积 $U\\xi$ 表征的缺陷强度成正比，与磁压耦合常数 $\\mu_0 M_s t$ 和力作用的有效长度 $L$ 成反比。\n\n最终表达式为：\n$H_{c}^{+} = \\frac{(4\\Gamma + UL)\\xi}{\\mu_{0} M_{s} t L^2}$\n$H_{c}^{-} = \\frac{4\\Gamma\\xi}{\\mu_{0} M_{s} t L^2}$\n$\\Delta H = \\frac{U\\xi}{\\mu_{0} M_{s} t L}$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{(4\\Gamma + UL)\\xi}{\\mu_{0} M_{s} t L^{2}}  \\frac{4\\Gamma\\xi}{\\mu_{0} M_{s} t L^{2}}  \\frac{U\\xi}{\\mu_{0} M_{s} t L} \\end{pmatrix}}\n$$", "id": "2995361"}, {"introduction": "我们的讨论从准静态的磁滞现象转向动态响应。当磁性材料受到交变磁场作用时，其响应由复数磁化率 $\\chi(\\omega)$ 描述。本练习 [@problem_id:2995419] 让你通过动手编程，探索由因果律决定的、连接磁化率耗散部分（虚部 $\\chi''$）与响应部分（实部 $\\chi'$）的深刻关系——即克莱默-克朗尼格关系 (Kramers-Kronig relations)，这是线性响应理论的基石。这个计算实践也反映了现代凝聚态物理研究中理论与计算相结合的重要方法。", "problem": "考虑一个线性、因果的磁介质，其中在时域中，磁化响应 $M(t)$ 对外加磁场 $H(t)$ 的关系由一个推迟磁化率 $\\chi(t)$ 描述，即 $M(t) = \\int_{-\\infty}^{\\infty} \\chi(t - t') H(t') \\, dt'$。根据因果性，对于 $t  0$，有 $\\chi(t) = 0$。通过傅里叶变换得到的频域磁化率 $\\chi(\\omega)$（其中角频率 $\\omega$ 的单位为弧度/秒）在复$\\omega$平面的上半平面是解析的。虚部 $\\chi''(\\omega)$ 描述耗散，对应于响应的吸收部分。实部 $\\chi'(\\omega)$ 和虚部 $\\chi''(\\omega)$ 通过解析性和因果性相互关联，且 $\\chi(\\omega)$ 与静态磁化率的一致性要求其满足适当的求和规则。\n\n给定一族物理上合理的铁磁共振（FMR）线型，用于描述磁化率的虚部。该线型由一个叠加在高频常数背景上的单个阻尼共振构成。总磁化率被建模为一个恒定的高频极限与一个单共振贡献之和。该共振贡献由特征共振角频率 $\\omega_0$、无量纲振幅 $\\Delta \\chi$ 以及一个控制共振线宽的正阻尼率 $\\Gamma$ 决定。为了进行数值重构，测量谱 $\\chi''(\\omega)$ 在一个限制于非负$\\omega$的有限频率网格 $\\{\\omega_i\\}$ 上被均匀采样。\n\n任务：\n1. 从推迟响应的因果性和 $\\chi(\\omega)$ 的解析性出发，推导一个色散关系。该关系利用在正频率轴上的主值积分，从虚部 $\\chi''(\\omega)$ 确定实部 $\\chi'(\\omega)$。除因果性、实值时域响应以及在大的$|\\omega|$下为保证收敛而进行的足够快衰减的假设外，不要假定任何特定的函数形式。\n2. 陈述并论证一个求和规则，该规则将静态磁化率差值 $\\chi(0) - \\chi_{\\infty}$ 与 $\\chi''(\\omega)$ 在正频率轴上的积分联系起来，其中 $\\chi_{\\infty}$ 是 $\\chi'(\\omega)$ 的高频极限。\n3. 实现一个程序，对下述每个测试用例执行以下操作：\n   - 使用与因果磁化率和恒定高频极限 $\\chi_{\\infty}$ 一致的单共振 FMR 线型，在网格 $\\omega \\in [0,\\omega_{\\max}]$ 上构建“测量的”虚部 $\\chi''(\\omega)$。该共振由 $\\omega_0$、$\\Gamma$ 和振幅 $\\Delta \\chi$ 表征。\n   - 使用任务1中推导的色散关系，从采样的 $\\chi''(\\omega)$ 重构实部 $\\chi'(\\omega)$。该关系通过在给定网格上使用适当的求积法，实现为 $\\omega \\ge 0$ 上的数值主值积分。通过在离散求和中排除自身项来处理奇异点处的主值。\n   - 根据重构结果计算静态实部 $\\chi'(0)$，并将其与 $\\chi_{\\infty} + \\Delta \\chi$ 进行比较，以验证与静态磁化率的一致性。\n   - 使用相同的网格对任务2中的求和规则进行数值计算，并将结果与 $\\Delta \\chi$ 进行比较，从而检验测量的耗散与静态响应之间的一致性。\n   - 计算重构的 $\\chi'(\\omega)$ 与用于生成 $\\chi''(\\omega)$ 的单共振模型的精确实部之间的最大绝对误差（在同一网格上），从而验证重构算法的正确性。\n4. 使用以下测试套件和规格：\n   - 单位：角频率单位必须是弧度/秒，磁化率必须是无量纲的。\n   - 频率网格：对于每个测试用例，使用一个从 $\\omega = 0$ 到 $\\omega = \\omega_{\\max} = 20 \\, \\omega_0$ 的包含 $N = 4001$ 个点的均匀网格。\n   - 通过/失败的数值容差：\n     - 对于色散重构，$\\chi'(\\omega)$ 的最大绝对误差不得超过 $10^{-2}$（无量纲）。\n     - 对于求和规则，数值积分与 $\\Delta \\chi$ 之间的绝对差不得超过 $5 \\times 10^{-3}$（无量纲）。\n     - 对于静态磁化率，重构的 $\\chi'(0)$ 与 $\\chi_{\\infty} + \\Delta \\chi$ 之间的绝对差不得超过 $5 \\times 10^{-3}$（无量纲）。\n   - 测试用例（每个由 $(\\omega_0, \\Gamma, \\Delta \\chi, \\chi_{\\infty})$ 指定）：\n     1. $(2\\pi \\times 10^{10}\\,\\text{rad/s}, \\, 0.05 \\, \\omega_0, \\, 1.2, \\, 0.15)$\n     2. $(2\\pi \\times 5 \\times 10^{9}\\,\\text{rad/s}, \\, 0.005 \\, \\omega_0, \\, 0.8, \\, 0.10)$\n     3. $(2\\pi \\times 1.5 \\times 10^{10}\\,\\text{rad/s}, \\, 0.5 \\, \\omega_0, \\, 2.0, \\, 0.05)$\n   - 对于用于生成 $\\chi''(\\omega)$ 和进行验证的精确模型，复单共振磁化率由一个因果形式隐式给出，该形式与围绕 $\\omega_0$ 的阻尼振子响应和高频极限 $\\chi_{\\infty}$ 一致。您的程序必须从此模型构建 $\\chi''(\\omega)$，并利用解析性约束来重构 $\\chi'(\\omega)$；这确保了验证的内部一致性。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。\n- 对于每个测试用例，输出一个三元列表 $[\\text{KK\\_ok}, \\text{sum\\_rule\\_ok}, \\text{static\\_ok}]$，其中每个元素都是一个布尔值，指示相应的检查是否在指定容差下通过。\n- 因此，最终输出必须是 $[[b_{11},b_{12},b_{13}],[b_{21},b_{22},b_{23}],[b_{31},b_{32},b_{33}]]$ 的形式，不含空格，其中 $b_{ij}$ 是布尔字面量。", "solution": "该问题要求推导因果磁化率的基本关系，然后实现并验证一个从磁化率虚部重构实部的数值算法。整个过程将分为三部分详述：理论推导、显式模型的选择以及数值实现的描述。\n\n### 任务1：Kramers-Kronig 色散关系的推导\n\n磁化率实部 $\\chi'(\\omega)$ 和虚部 $\\chi''(\\omega)$ 之间关系的基础在于因果性原理。响应 $M(t)$ 不能先于激励 $H(t)$ 这一陈述意味着推迟磁化率 $\\chi(t)$ 对于 $t  0$ 必须为零。通过傅里叶变换的性质，由此得出的一个推论是，其频域对应物 $\\chi(\\omega)$ 在复频率平面的上半平面（$\\text{Im}(\\omega)  0$）是一个解析函数。\n\n问题陈述，磁化率在高频时趋于一个常数值 $\\chi_{\\infty}$。处理一个在无穷远处消失的函数更为方便。我们定义 $\\phi(\\omega) = \\chi(\\omega) - \\chi_{\\infty}$。该函数同样在上半平面解析，并且当 $|\\omega| \\to \\infty$ 时 $\\phi(\\omega) \\to 0$。\n\n根据 Cauchy 积分公式，对于上半平面中的任意点 $\\omega$，我们有：\n$$\n\\phi(\\omega) = \\frac{1}{2\\pi i} \\oint_C \\frac{\\phi(z)}{z - \\omega} dz\n$$\n我们选择围道 $C$ 为从 $-R$ 到 $+R$ 的实轴以及上半平面中半径为 $R$ 的一个大半圆 $\\Gamma_R$。当 $R \\to \\infty$ 时，只要 $|z| \\to \\infty$ 时 $\\phi(z) \\to 0$，沿半圆的积分就消失为零。对于任何物理响应，此条件都成立。因此，积分简化为沿实轴的积分：\n$$\n\\phi(\\omega) = \\frac{1}{2\\pi i} \\int_{-\\infty}^{\\infty} \\frac{\\phi(\\omega')}{\\omega' - \\omega} d\\omega'\n$$\n为了求出实频率 $\\omega$ 处的值，我们取复频率点的虚部从上方趋于零的极限，即 $\\omega \\to \\omega_r + i\\epsilon$ 且 $\\epsilon \\to 0^+$。利用 Sokhotski-Plemelj 定理，即 $\\lim_{\\epsilon \\to 0^+} \\frac{1}{x \\pm i\\epsilon} = \\mp i\\pi \\delta(x) + \\mathcal{P}\\frac{1}{x}$，积分变为：\n$$\n\\phi(\\omega_r) = \\frac{1}{2\\pi i} \\left( \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{\\phi(\\omega')}{\\omega' - \\omega_r} d\\omega' + i\\pi \\phi(\\omega_r) \\right)\n$$\n其中 $\\mathcal{P}$ 表示 Cauchy 主值。重新整理此方程可得：\n$$\n\\phi(\\omega_r) = \\frac{1}{i\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{\\phi(\\omega')}{\\omega' - \\omega_r} d\\omega'\n$$\n代入 $\\phi(\\omega) = \\chi(\\omega) - \\chi_{\\infty} = (\\chi'(\\omega) - \\chi_{\\infty}) + i\\chi''(\\omega)$ 并令实部相等（同时省略实频率的下标 $r$）：\n$$\n\\chi'(\\omega) - \\chi_{\\infty} = \\text{Re}\\left[ \\frac{1}{i\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{(\\chi'(\\omega') - \\chi_{\\infty}) + i\\chi''(\\omega')}{\\omega' - \\omega} d\\omega' \\right] = \\frac{1}{\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{\\chi''(\\omega')}{\\omega' - \\omega} d\\omega'\n$$\n对于实值时域响应 $\\chi(t)$，我们有对称性 $\\chi(-\\omega) = \\chi^*(\\omega)$，这意味着 $\\chi'(\\omega)$ 是 $\\omega$ 的偶函数，而 $\\chi''(\\omega)$ 是奇函数。我们可以利用 $\\chi''(\\omega)$ 的奇函数性质将积分重写在区间 $[0, \\infty)$ 上：\n$$\n\\int_{-\\infty}^{\\infty} \\frac{\\chi''(\\omega')}{\\omega' - \\omega} d\\omega' = \\int_{0}^{\\infty} \\chi''(\\omega') \\left( \\frac{1}{\\omega' - \\omega} + \\frac{1}{\\omega' + \\omega} \\right) d\\omega' = \\int_{0}^{\\infty} \\frac{2\\omega' \\chi''(\\omega')}{(\\omega')^2 - \\omega^2} d\\omega'\n$$\n这便得到了所要求的 Kramers-Kronig 关系式的最终形式，用于计算实部：\n$$\n\\chi'(\\omega) = \\chi_{\\infty} + \\frac{2}{\\pi} \\mathcal{P} \\int_{0}^{\\infty} \\frac{\\omega' \\chi''(\\omega')}{(\\omega')^2 - \\omega^2} d\\omega'\n$$\n\n### 任务2：求和规则的推导\n\n通过计算 $\\omega = 0$ 时的 Kramers-Kronig 关系，可以推导出一个连接静态响应与总耗散的求和规则。由于 $\\chi''(\\omega)$ 是奇函数，$\\chi''(0)=0$，因此 $\\chi(0) = \\chi'(0)$。在推导出的关系式中令 $\\omega=0$ 可得：\n$$\n\\chi'(0) - \\chi_{\\infty} = \\frac{2}{\\pi} \\mathcal{P} \\int_{0}^{\\infty} \\frac{\\omega' \\chi''(\\omega')}{(\\omega')^2 - 0^2} d\\omega' = \\frac{2}{\\pi} \\int_{0}^{\\infty} \\frac{\\chi''(\\omega')}{\\omega'} d\\omega'\n$$\n此时主值已不再必要，因为 $\\omega' = 0$ 处的奇点已被消除。对于一个物理系统，在零频率附近，磁化率的虚部通常表现为 $\\chi''(\\omega') \\propto \\omega'$，这使得被积函数 $\\chi''(\\omega')/\\omega'$ 在 $\\omega'=0$ 处是有限的，积分是收敛的。问题将 $\\Delta\\chi$ 定义为振幅，它对应于共振的静态贡献，因此 $\\chi(0) = \\chi_{\\infty} + \\Delta\\chi$。所以，该求和规则将 $\\Delta\\chi$ 与耗散部分在所有正频率上的积分联系起来：\n$$\n\\Delta\\chi = \\chi'(0) - \\chi_{\\infty} = \\frac{2}{\\pi} \\int_{0}^{\\infty} \\frac{\\chi''(\\omega')}{\\omega'} d\\omega'\n$$\n\n### 任务3：数值实现与验证\n\n**解析模型**\n为了生成“测量的”$\\chi''(\\omega)$数据并为验证提供 $\\chi'(\\omega)$ 的精确解，我们必须为 $\\chi(\\omega)$ 选择一个与问题描述一致的特定函数形式。一个带有高频偏移的因果单共振线型可以很好地由阻尼谐振子（DHO）模型描述。该模型的极点仅位于复频率平面的下半平面（确保因果性），满足 $\\chi(-\\omega) = \\chi^*(\\omega)$，并能正确表示参数 $\\Delta\\chi$、$\\omega_0$、$\\Gamma$ 和 $\\chi_{\\infty}$。DHO 磁化率为：\n$$\n\\chi(\\omega) = \\chi_{\\infty} + \\frac{\\Delta\\chi \\omega_0^2}{\\omega_0^2 - \\omega^2 - i\\omega\\Gamma}\n$$\n将其分离为实部和虚部，可得到用于生成数据和进行验证的精确表达式：\n$$\n\\chi'_{\\text{exact}}(\\omega) = \\chi_{\\infty} + \\frac{\\Delta\\chi \\omega_0^2 (\\omega_0^2 - \\omega^2)}{(\\omega_0^2 - \\omega^2)^2 + (\\omega\\Gamma)^2}\n$$\n$$\n\\chi''_{\\text{model}}(\\omega) = \\frac{\\Delta\\chi \\omega_0^2 (\\omega\\Gamma)}{(\\omega_0^2 - \\omega^2)^2 + (\\omega\\Gamma)^2}\n$$\n\n**数值算法**\n程序将对每个测试用例执行以下步骤：\n1.  **网格和模型数据**: 创建一个从 $\\omega=0$ 到 $\\omega_{\\max}=20\\omega_0$ 的包含 $N=4001$ 个点的均匀频率网格。在每个网格点上计算 $\\chi''_{\\text{model}}(\\omega)$ 的值，作为“测量的”输入数据。同时计算精确的 $\\chi'_{\\text{exact}}(\\omega)$ 值，以备后续比较。\n2.  **Kramers-Kronig 重构**: $\\chi'(\\omega)$ 的积分以数值方式实现。对于网格上的每个目标频率 $\\omega_i$，积分通过在同一网格上使用梯形法则计算。为提高效率，计算过程进行了矢量化。构建一个矩阵 `integrand_matrix[j, i]`，其中包含当 $\\omega'=\\omega_j$ 和 $\\omega=\\omega_i$ 时的被积函数值。为了处理 Cauchy 主值，对角线项 `[i, i]`（分母为零处）被设为 $0$。这对应于问题中指定的“排除自身项”的方法。然后，每个 $\\omega_i$ 的积分值就是该矩阵对应列的梯形求和结果。\n3.  **静态磁化率检查**: 将重构值 $\\chi'_{\\text{recon}}(0)$（重构数组的第一个点）与预期的静态值 $\\chi_{\\infty} + \\Delta\\chi$进行比较。其绝对差值与 $5 \\times 10^{-3}$ 的容差进行核对。\n4.  **求和规则检查**: 对求和规则积分 $\\frac{2}{\\pi} \\int_{0}^{\\infty} \\frac{\\chi''(\\omega')}{\\omega'} d\\omega'$ 进行数值计算。被积函数 $\\chi''(\\omega')/\\omega'$ 在 $\\omega'=0$ 处有一个可去奇点。其在 $\\omega' \\to 0$ 时的极限是 $\\Delta\\chi \\Gamma / \\omega_0^2$。该值用于被积函数数组的第一个点。然后使用梯形法则计算积分，并将结果与 $\\Delta\\chi$ 进行比较，容差为 $5 \\times 10^{-3}$。\n5.  **重构精度检查**: 在所有网格点上计算重构谱 $\\chi'_{\\text{recon}}(\\omega)$与解析解 $\\chi'_{\\text{exact}}(\\omega)$ 之间的最大绝对误差。此误差与 $10^{-2}$ 的容差进行核对。\n\n最后，报告每个测试用例的这三项检查的布尔结果。需要注意的是，对于测试用例2，阻尼 $\\Gamma = 0.005\\omega_0$ 非常小，导致共振峰极其尖锐。网格间距 $d\\omega = 20\\omega_0 / 4000 = 0.005\\omega_0$ 等于共振峰的近似半峰全宽。相对于特征尺寸而言，这种粗糙的采样预计会在梯形积分中引入显著的数值误差，可能导致此用例的检查失败。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of reconstructing the real part of magnetic susceptibility from the\n    imaginary part using the Kramers-Kronig relations and verifies the results.\n    \"\"\"\n\n    # Test cases defined by (omega_0 [rad/s], Gamma [fraction of omega_0], Delta_chi, Chi_infinity)\n    test_cases = [\n        (2 * np.pi * 1e10, 0.05, 1.2, 0.15),\n        (2 * np.pi * 5e9, 0.005, 0.8, 0.10),\n        (2 * np.pi * 1.5e10, 0.5, 2.0, 0.05),\n    ]\n\n    # Numerical parameters\n    N = 4001  # Number of points in the frequency grid\n\n    # Tolerances for checks\n    kk_tolerance = 1e-2\n    sum_rule_tolerance = 5e-3\n    static_tolerance = 5e-3\n    \n    results = []\n\n    for case in test_cases:\n        w0, gamma_frac, delta_chi, chi_inf = case\n        gamma = gamma_frac * w0\n        w_max = 20 * w0\n\n        # 1. Construct frequency grid and \"measured\" susceptibility data\n        # Using linspace for a uniform grid\n        w_grid = np.linspace(0, w_max, N)\n        \n        # Damped Harmonic Oscillator (DHO) model for susceptibility\n        # Denominator of the resonance term\n        denom_dho = (w0**2 - w_grid**2)**2 + (w_grid * gamma)**2\n        \n        # Avoid division by zero if denom_dho happens to be zero\n        # In practice, with damping gamma > 0, this denominator is always positive for real omega.\n        \n        # Exact real part (for validation)\n        chi_p_exact = chi_inf + (delta_chi * w0**2 * (w0**2 - w_grid**2)) / denom_dho\n        \n        # \"Measured\" imaginary part (input for reconstruction)\n        chi_pp_measured = (delta_chi * w0**2 * (w_grid * gamma)) / denom_dho\n\n        # 2. Reconstruct the real part chi'(w) using Kramers-Kronig\n        \n        # Vectorized calculation of the principal value integral.\n        # Let w_prime be the integration variable (rows, axis=0)\n        # Let w be the evaluation point (columns, axis=1)\n        w_prime_col = w_grid[:, np.newaxis]\n        \n        # Denominator for the KK integrand: (w_prime^2 - w^2)\n        kk_denom = w_prime_col**2 - w_grid**2\n        \n        # Prevent division by zero on the diagonal. The value here does not matter\n        # as the corresponding integrand values will be set to zero.\n        np.fill_diagonal(kk_denom, 1.0)\n        \n        # Numerator for the KK integrand: 2 * w_prime * chi_pp(w_prime)\n        kk_num = 2 * w_prime_col * chi_pp_measured[:, np.newaxis]\n        \n        integrand_matrix = kk_num / kk_denom\n        \n        # Handle the principal value by setting the singular term to 0\n        np.fill_diagonal(integrand_matrix, 0.0)\n        \n        # Integrate each column (for each w) using the trapezoidal rule\n        integral_vals = np.trapz(integrand_matrix, x=w_grid, axis=0)\n        \n        chi_p_reconstructed = chi_inf + (1 / np.pi) * integral_vals\n\n        # 3. Perform the required checks\n        \n        # Check 1: Kramers-Kronig reconstruction accuracy\n        kk_error = np.max(np.abs(chi_p_reconstructed - chi_p_exact))\n        kk_ok = kk_error = kk_tolerance\n        \n        # Check 2: Sum rule verification\n        # Integrand is chi_pp(w') / w'\n        # Handle the removable singularity at w' = 0\n        integrand_sum_rule = np.zeros_like(w_grid)\n        # For w' > 0\n        integrand_sum_rule[1:] = chi_pp_measured[1:] / w_grid[1:]\n        # The limit of the integrand as w' -> 0 is (Delta_chi * Gamma) / w0^2\n        integrand_sum_rule[0] = (delta_chi * gamma) / (w0**2)\n        \n        sum_rule_integral = (2 / np.pi) * np.trapz(integrand_sum_rule, x=w_grid)\n        sum_rule_diff = np.abs(sum_rule_integral - delta_chi)\n        sum_rule_ok = sum_rule_diff = sum_rule_tolerance\n        \n        # Check 3: Static susceptibility reconstruction\n        # The reconstructed static value is the first element of the array\n        chi_p_static_recon = chi_p_reconstructed[0]\n        # The exact static value is chi_inf + delta_chi\n        static_diff = np.abs(chi_p_static_recon - (chi_inf + delta_chi))\n        static_ok = static_diff = static_tolerance\n\n        # Collect boolean results for the current case\n        results.append([kk_ok, sum_rule_ok, static_ok])\n\n    # Final print statement in the exact required format\n    # Convert boolean to lowercase string 'true' or 'false'\n    formatted_results = [\n        f\"[{str(r[0]).lower()},{str(r[1]).lower()},{str(r[2]).lower()}]\" \n        for r in results\n    ]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2995419"}]}