{"hands_on_practices": [{"introduction": "我们对磁共振的探索始于最基本的量子力学构件：单个自旋在磁场中的行为。这个练习将引导你从第一性原理出发，推导塞曼（Zeeman）相互作用如何解除原子核自旋态的简并。通过计算一个具体的自旋$I=3/2$系统的能级分裂和跃迁频率，你将亲手揭示为何在这种基本情况下，尽管存在多个能级，我们却只观测到一个共振频率，为理解更复杂的磁共振现象打下坚实的基础。[@problem_id:3003350]", "problem": "一个自旋量子数为 $I = \\frac{3}{2}$ 的原子核被置于一个沿 $z$ 轴方向的匀强恒定磁场 $\\mathbf{B}_0$ 中。考虑核磁矩与该磁场相互作用的 Zeeman 相互作用哈密顿量 $H_Z$。从核磁矩算符 $\\boldsymbol{\\mu}$ 的定义、磁相互作用能的基本形式以及 $I_z$ 的角动量本征值性质出发，推导磁量子数 $m \\in \\{-\\frac{3}{2}, -\\frac{1}{2}, \\frac{1}{2}, \\frac{3}{2}\\}$ 对应的能量本征值 $E_m$，并计算相邻 $m$ 能级之间分裂的大小。利用核磁共振选择定则 $\\Delta m = \\pm 1$，列举所有允许的跃迁并确定它们的角频率。\n\n将能量分裂的大小以焦耳为单位表示，跃迁角频率以弧度每秒为单位表示。将你的最终答案以一个单行矩阵的形式给出，其第一个元素是相邻能级能量分裂的大小，其余元素是按 $m$ 递增顺序排列的允许跃迁的角频率。无需进行数值四舍五入；用核磁旋比 $\\gamma$、约化普朗克常数 $\\hbar$ 和磁场大小 $B_0$ 来符号化地表示你的结果。", "solution": "该问题被验证为有科学依据、良定且客观。它是磁共振量子力学中的一个标准问题。所有必要信息均已提供，且其前提与已确立的物理原理一致。\n\n解答过程如下。\n\n核磁矩算符 $\\boldsymbol{\\mu}$ 与核自旋角动量算符 $\\mathbf{I}$ 成正比，比例常数为核磁旋比 $\\gamma$。\n$$\n\\boldsymbol{\\mu} = \\gamma \\mathbf{I}\n$$\nZeeman 哈密顿量 $H_Z$ 描述了该磁矩与外部静磁场 $\\mathbf{B}_0$ 的相互作用能。它由磁矩和磁场的标量积的负值给出。\n$$\nH_Z = - \\boldsymbol{\\mu} \\cdot \\mathbf{B}_0\n$$\n代入 $\\boldsymbol{\\mu}$ 的表达式，我们得到：\n$$\nH_Z = - (\\gamma \\mathbf{I}) \\cdot \\mathbf{B}_0 = -\\gamma (\\mathbf{I} \\cdot \\mathbf{B}_0)\n$$\n题目指明磁场 $\\mathbf{B}_0$ 是匀强且沿 $z$ 轴方向的。我们可以将其写为 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$，其中 $B_0$ 是磁场的大小。自旋角动量算符为 $\\mathbf{I} = I_x \\hat{\\mathbf{x}} + I_y \\hat{\\mathbf{y}} + I_z \\hat{\\mathbf{z}}$。因此，标量积为：\n$$\n\\mathbf{I} \\cdot \\mathbf{B}_0 = (I_x \\hat{\\mathbf{x}} + I_y \\hat{\\mathbf{y}} + I_z \\hat{\\mathbf{z}}) \\cdot (B_0 \\hat{\\mathbf{z}}) = I_z B_0\n$$\n哈密顿量简化为：\n$$\nH_Z = -\\gamma B_0 I_z\n$$\n该系统的能量本征值 $E_m$ 是哈密顿算符 $H_Z$ 的本征值。系统的本征态是算符 $I^2$ 和 $I_z$ 的共同本征态，记为 $|I, m\\rangle$。$I_z$ 算符作用于这些态上的结果由以下本征方程给出：\n$$\nI_z |I, m\\rangle = m \\hbar |I, m\\rangle\n$$\n其中 $m$ 是磁量子数，$\\hbar$ 是约化普朗克常数。对于给定的自旋量子数 $I$，$m$ 可以取从 $-I$ 到 $+I$ 的 $2I+1$ 个值，步长为整数。\n\n将哈密顿量 $H_Z$ 作用于本征态 $|I, m\\rangle$：\n$$\nH_Z |I, m\\rangle = (-\\gamma B_0 I_z) |I, m\\rangle = -\\gamma B_0 (I_z |I, m\\rangle) = -\\gamma B_0 (m \\hbar) |I, m\\rangle\n$$\n这是 $H_Z$ 的本征方程，其本征值为 $E_m$：\n$$\nE_m = -m \\gamma \\hbar B_0\n$$\n题目指出原子核的自旋量子数为 $I = \\frac{3}{2}$。因此，$m$ 的可能取值为 $m \\in \\{-\\frac{3}{2}, -\\frac{1}{2}, \\frac{1}{2}, \\frac{3}{2}\\}$。这产生了四个分立的能级。\n\n接下来，我们计算相邻 $m$ 能级之间能量分裂的大小。考虑对应于量子数 $m$ 和 $m+1$ 的两个相邻能级。能量差为：\n$$\n\\Delta E = E_{m+1} - E_m = (-(m+1)\\gamma\\hbar B_0) - (-m\\gamma\\hbar B_0) = -m\\gamma\\hbar B_0 - \\gamma\\hbar B_0 + m\\gamma\\hbar B_0 = -\\gamma\\hbar B_0\n$$\n这个结果表明能级是等间距的。任意两个相邻能级之间的分裂是恒定的。题目要求计算该分裂的大小。由于不同原子核的磁旋比 $\\gamma$ 可以是正值或负值，而能量分裂的大小必须是一个非负量，因此我们必须取绝对值：\n$$\n|\\Delta E| = |-\\gamma\\hbar B_0| = |\\gamma|\\hbar B_0\n$$\n这给出了以焦耳为单位的能量分裂。\n\n最后，我们确定允许跃迁的角频率。核磁共振中磁偶极跃迁的选择定则为 $\\Delta m = \\pm 1$。这意味着跃迁只允许在相邻能级之间发生。在此类跃迁中吸收或发射的光子能量 $E_{\\text{photon}}$ 必须等于初态和末态之间能量差的绝对值：\n$$\nE_{\\text{photon}} = |E_{\\text{final}} - E_{\\text{initial}}| = |\\Delta E| = |\\gamma|\\hbar B_0\n$$\n光子能量通过 $E_{\\text{photon}} = \\hbar \\omega$ 与其角频率 $\\omega$ 相关。令两个光子能量的表达式相等：\n$$\n\\hbar \\omega = |\\gamma|\\hbar B_0\n$$\n解出角频率 $\\omega$（单位为弧度每秒）可得：\n$$\n\\omega = |\\gamma|B_0\n$$\n这个频率被称为 Larmor 频率。由于所有相邻能级之间的能量分裂是相同的，所有允许的跃迁都发生在这同一个频率上。\n\n题目要求列举允许的跃迁。对于 $I=3/2$，有三种满足 $\\Delta m = \\pm 1$ 的可能跃迁：\n\\begin{enumerate}\n    \\item $m = -\\frac{3}{2}$ 和 $m = -\\frac{1}{2}$ 之间的跃迁。\n    \\item $m = -\\frac{1}{2}$ 和 $m = \\frac{1}{2}$ 之间的跃迁。\n    \\item $m = \\frac{1}{2}$ 和 $m = \\frac{3}{2}$ 之间的跃迁。\n\\end{enumerate}\n这些跃迁中每一个的角频率都是相同的，即 $\\omega = |\\gamma|B_0$。\n\n最终答案应以单行矩阵的形式给出。第一个元素是能量分裂的大小，即 $|\\gamma|\\hbar B_0$。随后的元素是允许跃迁的角频率，按 $m$（跃迁对中较低能态的 $m$ 值）的递增顺序排列。因此，我们列出这三次跃迁的频率，尽管它们是相同的。\n\n矩阵元素为：\n\\begin{itemize}\n    \\item 能量分裂：$|\\gamma|\\hbar B_0$\n    \\item 跃迁 1 ($m = -3/2 \\leftrightarrow -1/2$) 的频率：$|\\gamma|B_0$\n    \\item 跃迁 2 ($m = -1/2 \\leftrightarrow 1/2$) 的频率：$|\\gamma|B_0$\n    \\item 跃迁 3 ($m = 1/2 \\leftrightarrow 3/2$) 的频率：$|\\gamma|B_0$\n\\end{itemize}", "answer": "$$\n\\boxed{\\begin{pmatrix} |\\gamma|\\hbar B_0 & |\\gamma|B_0 & |\\gamma|B_0 & |\\gamma|B_0 \\end{pmatrix}}\n$$", "id": "3003350"}, {"introduction": "超越静态能级的概念，核磁共振的真正威力在于其探测动力学过程的能力。本练习将我们的视角从单个自旋扩展到自旋系综，并深入探讨纵向弛豫，一个由自旋-晶格相互作用主导的、至关重要的动力学过程。通过求解描述宏观磁化强度的布洛赫方程（Bloch equation），你将学会如何从一个假想的“反转-恢复”实验数据中提取出自旋-晶格弛豫时间$T_1$，从而将基础理论与实际的实验数据分析紧密联系起来。[@problem_id:3003371]", "problem": "采用核磁共振(NMR)技术研究一个由自旋-$\\tfrac{1}{2}$原子核组成的均匀系综。假设纵向弛豫是单指数的，其自旋-晶格弛豫时间为 $T_1$，并且在恢复延迟期间，横向过程不影响纵向分量。系统处于高温强场极限下，因此在固定的温度和静磁场下，平衡纵向磁化强度 $M_0$ 不随时间变化。从纵向Bloch方程出发\n$$\n\\frac{d M_z}{d t} \\;=\\; -\\,\\frac{M_z - M_0}{T_1}\\,,\n$$\n并将射频脉冲视为瞬时旋转，它在每个恢复周期开始时设定 $M_z$ 的初始条件。\n\n(a) 在一个使自旋布居数相等的饱和脉冲之后，纵向磁化强度立即变为 $M_z(0)=0$。推导当 $t>0$ 时，$M_z(t)$ 对时间的显式依赖关系。\n\n(b) 在一次反转恢复实验中，施加一个理想的 $180^{\\circ}$ 反转脉冲，接着是一个可变延迟 $\\tau$，然后是一个理想的 $90^{\\circ}$ 读出脉冲。检测到的信号与施加 $90^{\\circ}$ 脉冲之前的瞬间的纵向磁化强度 $M_z(\\tau)$ 成正比。使用相同的Bloch方程框架并假设脉冲是理想的，推导当 $t=\\tau$ 时的 $M_z(\\tau)$。\n\n对该样品的一次测量发现，在延迟 $\\tau_0 = 72.00\\ \\mathrm{ms}$ 时，反转恢复信号的符号发生改变，即 $M_z(\\tau_0)=0$。使用单指数模型和你的推导，根据此零交叉延迟计算 $T_1$。将 $T_1$ 的数值四舍五入至四位有效数字。以 $\\mathrm{s}$ 为单位表示弛豫时间。\n\n将最终答案表示为一个有序对，其中包含(a)部分的解析表达式和(b)部分提取的 $T_1$ 的数值。", "solution": "该问题要求分析核磁共振(NMR)实验中的纵向磁化弛豫，此过程由一个称为纵向Bloch方程的一阶线性常微分方程所描述：\n$$\n\\frac{d M_z}{d t} = -\\frac{M_z - M_0}{T_1}\n$$\n此处，$M_z(t)$ 是时间 $t$ 的纵向磁化强度，$M_0$ 是热平衡磁化强度，$T_1$ 是自旋-晶格弛豫时间或纵向弛豫时间。我们必须针对两种不同的实验情景求解此方程。\n\n该微分方程是可分离变量的，可以重写为：\n$$\n\\frac{d M_z}{M_z - M_0} = -\\frac{1}{T_1} dt\n$$\n我们可以将此方程从初始时间 $t=0$（初始磁化强度为 $M_z(0)$）积分到一个更晚的时间 $t$（磁化强度为 $M_z(t)$）：\n$$\n\\int_{M_z(0)}^{M_z(t)} \\frac{dM'_z}{M'_z - M_0} = \\int_0^t -\\frac{1}{T_1} dt'\n$$\n执行积分可得：\n$$\n\\left[ \\ln|M'_z - M_0| \\right]_{M_z(0)}^{M_z(t)} = -\\frac{t}{T_1}\n$$\n$$\n\\ln|M_z(t) - M_0| - \\ln|M_z(0) - M_0| = -\\frac{t}{T_1}\n$$\n$$\n\\ln\\left( \\frac{|M_z(t) - M_0|}{|M_z(0) - M_0|} \\right) = -\\frac{t}{T_1}\n$$\n对于物理弛豫过程，其中 $M_z(t)$ 从初始值 $M_z(0)$ 单调地趋近 $M_0$，量 $(M_z - M_0)$ 在弛豫期间符号不变。因此，我们可以去掉绝对值符号。对两边取指数可得：\n$$\n\\frac{M_z(t) - M_0}{M_z(0) - M_0} = \\exp\\left(-\\frac{t}{T_1}\\right)\n$$\n重新整理以求解 $M_z(t)$，我们得到纵向磁化恢复的通解：\n$$\nM_z(t) = M_0 + \\left( M_z(0) - M_0 \\right) \\exp\\left(-\\frac{t}{T_1}\\right)\n$$\n这个通用表达式将用于解决问题的两个部分。\n\n(a) 对饱和恢复实验的推导。\n在饱和恢复实验中，施加一个初始脉冲（或一串脉冲）以使自旋系统饱和。饱和意味着自旋布居数均等化，这对应于净纵向磁化强度为零。因此，在时间 $t=0$ 时的初始条件是 $M_z(0) = 0$。\n将此初始条件代入通解中：\n$$\nM_z(t) = M_0 + \\left( 0 - M_0 \\right) \\exp\\left(-\\frac{t}{T_1}\\right)\n$$\n$$\nM_z(t) = M_0 - M_0 \\exp\\left(-\\frac{t}{T_1}\\right)\n$$\n这可以写成饱和恢复的标准形式：\n$$\nM_z(t) = M_0 \\left(1 - \\exp\\left(-\\frac{t}{T_1}\\right)\\right)\n$$\n这就是在饱和脉冲之后，纵向磁化强度对时间的显式依赖关系。\n\n(b) 从反转恢复实验计算 $T_1$。\n在反转恢复实验中，实验开始时系统处于热平衡状态，即 $M_z = M_0$。在 $t=0$ 时施加一个理想的 $180^{\\circ}$ 反转脉冲。这样的脉冲会反转纵向磁化强度，因此对于随后持续时间为 $\\tau$ 的恢复周期，其初始条件为 $M_z(0) = -M_0$。\n我们再次使用通解，这次令 $t=\\tau$ 并使用新的初始条件 $M_z(0) = -M_0$：\n$$\nM_z(\\tau) = M_0 + \\left( (-M_0) - M_0 \\right) \\exp\\left(-\\frac{\\tau}{T_1}\\right)\n$$\n$$\nM_z(\\tau) = M_0 - 2M_0 \\exp\\left(-\\frac{\\tau}{T_1}\\right)\n$$\n这给出了测量信号对延迟时间 $\\tau$ 的依赖关系：\n$$\nM_z(\\tau) = M_0 \\left(1 - 2\\exp\\left(-\\frac{\\tau}{T_1}\\right)\\right)\n$$\n问题陈述，在特定延迟 $\\tau_0 = 72.00 \\, \\mathrm{ms}$ 时信号变为零。这是反转恢复曲线的零点或零交叉时间。此时，$M_z(\\tau_0) = 0$。\n$$\n0 = M_0 \\left(1 - 2\\exp\\left(-\\frac{\\tau_0}{T_1}\\right)\\right)\n$$\n由于平衡磁化强度 $M_0$ 非零，我们可以将其约去：\n$$\n0 = 1 - 2\\exp\\left(-\\frac{\\tau_0}{T_1}\\right)\n$$\n现在，我们求解 $T_1$：\n$$\n2\\exp\\left(-\\frac{\\tau_0}{T_1}\\right) = 1\n$$\n$$\n\\exp\\left(-\\frac{\\tau_0}{T_1}\\right) = \\frac{1}{2}\n$$\n对两边取自然对数：\n$$\n-\\frac{\\tau_0}{T_1} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2)\n$$\n$$\n\\frac{\\tau_0}{T_1} = \\ln(2)\n$$\n最后，求解 $T_1$：\n$$\nT_1 = \\frac{\\tau_0}{\\ln(2)}\n$$\n给定 $\\tau_0 = 72.00 \\, \\mathrm{ms}$。我们必须以秒为单位表示 $T_1$，所以 $\\tau_0 = 72.00 \\times 10^{-3} \\, \\mathrm{s}$。\n$$\nT_1 = \\frac{72.00 \\times 10^{-3} \\, \\mathrm{s}}{\\ln(2)}\n$$\n使用数值 $\\ln(2) \\approx 0.69314718$：\n$$\nT_1 \\approx \\frac{72.00 \\times 10^{-3}}{0.69314718} \\, \\mathrm{s} \\approx 0.1038732 \\, \\mathrm{s}\n$$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $1$、$0$、$3$、$8$，而第五位数字是 $7$，所以我们向上取整。\n$$\nT_1 \\approx 0.1039 \\, \\mathrm{s}\n$$\n最终答案是由(a)部分的解析表达式和 $T_1$ 的数值组成的有序对。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nM_0 \\left(1 - \\exp\\left(-\\frac{t}{T_1}\\right)\\right) & 0.1039\n\\end{pmatrix}\n}\n$$", "id": "3003371"}, {"introduction": "在真实的实验中，样品内部的磁场并非完美均匀，这导致了“非均匀展宽”——一个使信号快速衰减但并非源于真实动力学弛豫的现象。本练习将带你直面这一复杂但核心的概念，并引入强大的自旋回波技术，它能够巧妙地重聚因静态不均匀性而失相的自旋，从而区分静态和动态效应。通过编程实现一个包含扩散过程的自旋回波模型，你将获得宝贵的实践经验，深刻理解核磁共振如何作为一种强大的工具，用于测量材料内部的微观输运性质。[@problem_id:3003340]", "problem": "考虑一个由无相互作用的自旋组成的系综，通过核磁共振 (NMR) 或电子自旋共振 (ESR) 在固体或液体中进行探测，并放置在一个静态外部磁场中，该磁场具有沿 $x$ 轴的均匀主分量 $B_0$ 和一个叠加的线性空间梯度 $G$，使得 $B(x) = B_0 + G x$。局域拉末角频率为 $\\omega(x) = \\gamma B(x)$，其中 $\\gamma$ 是旋磁比，单位为 $\\mathrm{rad \\, s^{-1} \\, T^{-1}}$。假设横向磁化强度遵循由布洛赫方程控制的进动动力学，并且系综平均的自由感应衰减可以通过对由 $x$ 的空间分布引起的频率偏移进行平均来建模，而经过 $\\pi/2$–$\\pi$ 脉冲序列后，在时间 $2\\tau$ 处的哈恩回波包络受到本征横向弛豫和场梯度中随机运动的共同影响。\n\n您必须从第一性原理出发，为一维样本推导并实现以下计算任务：\n\n1) 静态非均匀展宽与自由感应衰减 (FID)：假设沿 $x$ 轴的自旋位置的静态分布是均值为 $0$、方差为 $\\sigma_x^2$ 的高斯分布，这意味着瞬时拉末频率也服从相应的高斯分布。利用系综平均的定义和高斯随机变量的性质，计算仅由静态非均匀展宽（即忽略本征横向弛豫）引起的在时间 $t$ 的归一化横向磁化包络 $M_{\\mathrm{FID}}(t)$，并将其表示为一个无量纲浮点数。\n\n2) 恒定梯度中扩散引起的哈恩回波衰减：将沿 $x$ 轴的分子运动建模为一维布朗运动，其扩散系数为 $D$，单位为 $\\mathrm{m^2 \\, s^{-1}}$。在恒定梯度 $G$（单位为 $\\mathrm{T \\, m^{-1}}$）下，随时间变化的拉末频率成为一个随机过程 $\\omega(t) = \\gamma G x(t)$。利用在时间 $\\tau$ 施加 $\\pi$ 脉冲的哈恩回波在翻转坐标系下的累积相位的定义，以及 $x(t)$ 的高斯特性，计算在时间 $2\\tau$ 处的归一化回波包络 $M_{\\mathrm{echo}}(2\\tau)$，该包络同时包含由 $T_2$（单位为 $\\mathrm{s}$）表征的本征横向弛豫和梯度中扩散引起的失相。将结果表示为一个无量纲浮点数。\n\n您的程序必须对下面的每个测试用例计算并返回一个数值对 $[M_{\\mathrm{FID}}(t), M_{\\mathrm{echo}}(2\\tau)]$。请使用以下科学上合理的测试套件，其参数均以国际单位制 (SI) 规定：\n\n- 测试用例 1 (通用正常路径)：\n  - $\\gamma = 2.675 \\times 10^8$,\n  - $G = 1.0 \\times 10^{-2}$,\n  - $D = 2.0 \\times 10^{-9}$,\n  - $T_2 = 1.5$,\n  - $\\tau = 4.0 \\times 10^{-2}$,\n  - $\\sigma_x = 5.0 \\times 10^{-3}$,\n  - $t = 1.0 \\times 10^{-4}$.\n\n- 测试用例 2 (边界：零梯度)：\n  - $\\gamma = 2.675 \\times 10^8$,\n  - $G = 0.0$,\n  - $D = 2.0 \\times 10^{-9}$,\n  - $T_2 = 1.5$,\n  - $\\tau = 4.0 \\times 10^{-2}$,\n  - $\\sigma_x = 5.0 \\times 10^{-3}$,\n  - $t = 1.0 \\times 10^{-4}$.\n\n- 测试用例 3 (边缘：零扩散，仅静态梯度)：\n  - $\\gamma = 2.675 \\times 10^8$,\n  - $G = 1.0 \\times 10^{-2}$,\n  - $D = 0.0$,\n  - $T_2 = 1.5$,\n  - $\\tau = 4.0 \\times 10^{-2}$,\n  - $\\sigma_x = 5.0 \\times 10^{-3}$,\n  - $t = 1.0 \\times 10^{-4}$.\n\n- 测试用例 4 (边缘：非常长的 $T_2$，扩散主导的回波)：\n  - $\\gamma = 2.675 \\times 10^8$,\n  - $G = 3.0 \\times 10^{-2}$,\n  - $D = 2.0 \\times 10^{-9}$,\n  - $T_2 = 1.0 \\times 10^{3}$,\n  - $\\tau = 5.0 \\times 10^{-2}$,\n  - $\\sigma_x = 5.0 \\times 10^{-3}$,\n  - $t = 1.0 \\times 10^{-5}$.\n\n- 测试用例 5 (边缘：小 $\\tau$)：\n  - $\\gamma = 2.675 \\times 10^8$,\n  - $G = 2.0 \\times 10^{-2}$,\n  - $D = 2.0 \\times 10^{-9}$,\n  - $T_2 = 5.0 \\times 10^{-1}$,\n  - $\\tau = 5.0 \\times 10^{-3}$,\n  - $\\sigma_x = 5.0 \\times 10^{-3}$,\n  - $t = 7.0 \\times 10^{-5}$.\n\n所有量必须按所提供的国际单位制处理。您的程序应生成单行输出，其中包含一个由列表组成的列表，用方括号括起，并以逗号分隔。每个内部列表对应一个测试用例，并按顺序包含 $[M_{\\mathrm{FID}}(t), M_{\\mathrm{echo}}(2\\tau)]$。例如，输出格式必须类似于 $[[a_1,b_1],[a_2,b_2],\\dots]$，其中每个 $a_i$ 和 $b_i$ 都是浮点数。", "solution": "我们从布洛赫方程 $\\frac{d\\mathbf{M}}{dt} = \\gamma \\mathbf{M} \\times \\mathbf{B}$ 给出的磁矩在磁场中的进动动力学开始，当 $\\mathbf{B}(x) = B_0 \\hat{z} + G x \\hat{z}$ 时，该方程意味着沿梯度方向位置 $x$ 处的自旋具有局域拉莫尔角频率 $\\omega(x) = \\gamma B(x)$。系综横向磁化强度是通过对局域频率分布进行平均，以及在含时情况下，对运动的随机实现进行平均来获得的。\n\n静态非均匀展宽与 $M_{\\mathrm{FID}}(t)$：如果位置 $x$ 的空间分布是均值为 $0$、方差为 $\\sigma_x^2$ 的高斯分布，则由于 $\\omega(x) = \\gamma (B_0 + G x)$ 且与均值的频偏与 $x$ 成正比，因此局域拉莫尔角频率 $\\omega$ 的诱导分布也是高斯的。具体来说，如果 $x \\sim \\mathcal{N}(0,\\sigma_x^2)$，那么频偏 $\\Delta \\omega = \\gamma G x$ 是均值为 $0$、方差为 $\\sigma_\\omega^2 = (\\gamma G)^2 \\sigma_x^2$ 的高斯分布。自由感应衰减下的横向磁化包络是高斯频率分布在时间 $t$ 处求值的特征函数，并在 $t=0$ 时归一化为 1。令 $p(\\Delta \\omega)$ 为高斯概率密度。那么\n$$\nM_{\\mathrm{FID}}(t) = \\left\\langle e^{i \\Delta \\omega \\, t} \\right\\rangle_{\\Delta \\omega} = \\int_{-\\infty}^{\\infty} e^{i \\Delta \\omega \\, t} \\, \\frac{1}{\\sqrt{2\\pi} \\sigma_\\omega} \\exp\\left(-\\frac{\\Delta \\omega^2}{2 \\sigma_\\omega^2}\\right) \\, d(\\Delta \\omega).\n$$\n该积分是零均值高斯分布的特征函数，等于\n$$\nM_{\\mathrm{FID}}(t) = \\exp\\left( - \\frac{1}{2} \\sigma_\\omega^2 t^2 \\right) = \\exp\\left( - \\frac{1}{2} (\\gamma G)^2 \\sigma_x^2 \\, t^2 \\right).\n$$\n这只捕捉了由静态空间展宽引起的非均匀失相，并忽略了本征横向弛豫。结果是无量纲的。\n\n恒定梯度中扩散引起的哈恩回波衰减：考虑一个哈恩回波序列，在初始 $\\pi/2$ 脉冲后，于时间 $\\tau$ 施加一个 $\\pi$ 脉冲。在存在恒定梯度 $G$ 和扩散系数为 $D$ 的一维布朗运动 $x(t)$（满足 $\\langle x(t)\\rangle = 0$ 和协方差 $\\langle x(t_1) x(t_2) \\rangle = 2 D \\min(t_1,t_2)$）的情况下，瞬时角频率成为一个随机过程 $\\omega(t) = \\gamma G x(t)$。在翻转坐标系中的累积相位为\n$$\n\\phi = \\int_0^{2\\tau} \\omega(t) f(t) \\, dt = \\gamma G \\int_0^{2\\tau} x(t) f(t) \\, dt,\n$$\n其中翻转函数 $f(t)$ 解释了由 $\\pi$ 脉冲引起的符号反转：对于 $0 \\le t < \\tau$，$f(t) = +1$；对于 $\\tau \\le t \\le 2\\tau$，$f(t) = -1$。由于 $x(t)$ 是一个零均值高斯过程，而 $\\phi$ 是 $x(t)$ 的线性泛函，因此 $\\phi$ 是一个零均值高斯随机变量。由扩散引起的失相所产生的归一化回波振幅是特征函数 $\\langle e^{i \\phi} \\rangle$，对于高斯变量，它等于 $\\exp\\left(- \\frac{1}{2} \\mathrm{Var}(\\phi)\\right)$。方差为\n$$\n\\mathrm{Var}(\\phi) = (\\gamma G)^2 \\int_0^{2\\tau} \\int_0^{2\\tau} f(t_1) f(t_2) \\, \\langle x(t_1) x(t_2) \\rangle \\, dt_1 dt_2\n= 2 D (\\gamma G)^2 \\int_0^{2\\tau} \\int_0^{2\\tau} f(t_1) f(t_2) \\, \\min(t_1,t_2) \\, dt_1 dt_2.\n$$\n使用恒等式\n$$\n\\int_0^{T} \\int_0^{T} \\min(t_1,t_2) \\, a(t_1) a(t_2) \\, dt_1 dt_2 = \\int_0^{T} \\left( \\int_t^{T} a(u) \\, du \\right)^2 dt,\n$$\n令 $a(t) = f(t)$ 且 $T = 2\\tau$，我们计算内部积分 $S(t) = \\int_t^{2\\tau} f(u) \\, du$。对于 $0 \\le t \\le \\tau$，$S(t) = \\int_t^{\\tau} 1 \\, du + \\int_{\\tau}^{2\\tau} (-1) \\, du = (\\tau - t) - \\tau = -t$。对于 $\\tau \\le t \\le 2\\tau$，$S(t) = \\int_t^{2\\tau} (-1) \\, du = -(2\\tau - t) = t - 2\\tau$。因此，\n$$\n\\mathrm{Var}(\\phi) = 2 D (\\gamma G)^2 \\left[ \\int_0^{\\tau} t^2 \\, dt + \\int_{\\tau}^{2\\tau} (t - 2\\tau)^2 \\, dt \\right] = 2 D (\\gamma G)^2 \\left( \\frac{\\tau^3}{3} + \\frac{\\tau^3}{3} \\right) = \\frac{4}{3} D (\\gamma G)^2 \\tau^3.\n$$\n因此，由扩散引起的哈恩回波衰减因子为\n$$\nM_{\\mathrm{diff}}(2\\tau) = \\exp\\left( - \\frac{1}{2} \\mathrm{Var}(\\phi) \\right) = \\exp\\left( - \\frac{2}{3} D (\\gamma G)^2 \\tau^3 \\right).\n$$\n具有特征时间 $T_2$ 的本征横向弛豫为回波包络贡献了一个乘性的衰减因子 $\\exp(-2\\tau / T_2)$。合并后的归一化回波包络为\n$$\nM_{\\mathrm{echo}}(2\\tau) = \\exp\\left( - \\frac{2 \\tau}{T_2} \\right) \\exp\\left( - \\frac{2}{3} D (\\gamma G)^2 \\tau^3 \\right).\n$$\n该结果具有预期的极限情况：如果 $G = 0$ 或 $D = 0$，则由扩散引起的失相消失，且 $M_{\\mathrm{echo}}(2\\tau) = \\exp(-2\\tau/T_2)$；对于非常小的 $\\tau$，扩散因子趋近于 $1$，因为指数与 $\\tau^3$ 成比例。\n\n算法设计：对于每个测试用例，从给定参数计算 $\\sigma_\\omega = \\gamma G \\sigma_x$，然后评估\n$$\nM_{\\mathrm{FID}}(t) = \\exp\\left( - \\frac{1}{2} \\sigma_\\omega^2 \\, t^2 \\right),\n\\quad\nM_{\\mathrm{echo}}(2\\tau) = \\exp\\left( - \\frac{2 \\tau}{T_2} \\right) \\exp\\left( - \\frac{2}{3} D (\\gamma G)^2 \\tau^3 \\right),\n$$\n并为该测试用例以浮点数形式返回数值对 $[M_{\\mathrm{FID}}(t), M_{\\mathrm{echo}}(2\\tau)]$。所有输入参数均采用国际单位制，输出为无量纲浮点数。最终程序将所有指定测试用例的结果汇总到一个列表的列表中，并以所需的单行格式打印。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef fid_amplitude(gamma, G, sigma_x, t):\n    \"\"\"\n    Compute M_FID(t) due to static Gaussian distribution of positions in a linear B0 gradient.\n    sigma_omega = gamma * G * sigma_x\n    M_FID = exp(-0.5 * (sigma_omega * t)^2)\n    \"\"\"\n    sigma_omega = gamma * G * sigma_x\n    return float(np.exp(-0.5 * (sigma_omega * t) ** 2))\n\ndef echo_amplitude(gamma, G, D, T2, tau):\n    \"\"\"\n    Compute M_echo(2*tau) including intrinsic T2 and diffusion in a constant gradient.\n    M_echo = exp(-2*tau / T2) * exp( - (2/3) * D * (gamma*G)^2 * tau^3 )\n    \"\"\"\n    # Handle extremely large T2 robustly (although not strictly necessary with given values)\n    t2_factor = np.exp(-2.0 * tau / T2) if T2 > 0 else 0.0\n    diff_factor = np.exp(-(2.0 / 3.0) * D * (gamma * G) ** 2 * tau ** 3)\n    return float(t2_factor * diff_factor)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: gamma, G, D, T2, tau, sigma_x, t\n    test_cases = [\n        (2.675e8, 1.0e-2, 2.0e-9, 1.5,    4.0e-2, 5.0e-3, 1.0e-4),  # Case 1\n        (2.675e8, 0.0,    2.0e-9, 1.5,    4.0e-2, 5.0e-3, 1.0e-4),  # Case 2\n        (2.675e8, 1.0e-2, 0.0,    1.5,    4.0e-2, 5.0e-3, 1.0e-4),  # Case 3\n        (2.675e8, 3.0e-2, 2.0e-9, 1.0e3,  5.0e-2, 5.0e-3, 1.0e-5),  # Case 4\n        (2.675e8, 2.0e-2, 2.0e-9, 5.0e-1, 5.0e-3, 5.0e-3, 7.0e-5),  # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        gamma, G, D, T2, tau, sigma_x, t = case\n        fid = fid_amplitude(gamma, G, sigma_x, t)\n        echo = echo_amplitude(gamma, G, D, T2, tau)\n        results.append([fid, echo])\n\n    # Final print statement in the exact required format.\n    # Print as a single line: list of lists with floats\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\nsolve()\n```", "id": "3003340"}]}