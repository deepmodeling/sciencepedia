{"hands_on_practices": [{"introduction": "磁各向异性并非仅仅是晶体结构的内禀属性，它也可能由外部因素（如机械应力）诱导产生，这在薄膜材料中尤为重要。本练习将指导您从基本原理出发，推导立方晶系薄膜在双轴应变下产生的有效单轴各向异性常数 $K_{\\text{me}}$。这项实践旨在培养您将基本磁弹理论应用于实际场景的技能。[@problem_id:3002883]", "problem": "一个立方铁磁薄膜外延生长在一个立方衬底上，从而施加了一个均匀的、等双轴的面内应变。该应变状态是对角的，由 $\\,\\epsilon_{xx}=\\epsilon_{yy}=\\epsilon\\,$ 和 $\\,\\epsilon_{zz}=-2\\nu\\,\\epsilon\\,$ 给出，且没有剪切分量。这里，$\\,\\nu\\,$ 是适用于双轴外延约束的有效弹性耦合系数，$\\,\\epsilon\\,$ 是施加的面内应变。磁化方向由相对于立方轴 $[100],[010],[001]$ 的方向余弦 $\\,\\alpha_{x},\\alpha_{y},\\alpha_{z}\\,$ 分别描述。\n\n从立方晶体在小应变极限下的广义线性磁弹性耦合出发，并且只使用公认的本构关系，将磁弹性能量密度改写成相对于薄膜法线（$z$轴）的单轴形式。通过将磁弹性贡献写成 $\\,F_{\\text{me}}=K_{\\text{me}}\\sin^{2}\\theta+\\text{const}\\,$ 的形式来定义有效单轴各向异性常数 $\\,K_{\\text{me}}\\,$，其中 $\\,\\theta\\,$ 是磁化方向与薄膜法线之间的夹角（角度单位为弧度）。计算 $\\,K_{\\text{me}}\\,$，用立方磁弹性耦合常数 $\\,B_{1}\\,$、面内应变 $\\,\\epsilon\\,$ 和 $\\,\\nu\\,$ 来表示。请以单个闭式解析表达式的形式提供最终结果。不要代入任何数值。如果需要赋予单位，最终的能量常数将以焦耳/立方米表示，但仅报告符号表达式作为答案。", "solution": "该问题要求推导在特定双轴应变状态下，立方铁磁薄膜的有效单轴磁弹各向异性常数 $K_{\\text{me}}$。推导始于立方晶体中磁弹性能量密度 $F_{\\text{me}}$ 的通用表达式，该表达式是应变张量分量 $\\epsilon_{ij}$ 和磁化方向余弦 $\\alpha_i$ 的函数。\n\n考虑应变的线性项，立方晶体的磁弹性能量密度的通用表达式为：\n$$F_{\\text{me}} = B_{1}(\\epsilon_{xx}\\alpha_{x}^{2} + \\epsilon_{yy}\\alpha_{y}^{2} + \\epsilon_{zz}\\alpha_{z}^{2}) + B_{2}(\\epsilon_{xy}\\alpha_{x}\\alpha_{y} + \\epsilon_{yz}\\alpha_{y}\\alpha_{z} + \\epsilon_{zx}\\alpha_{z}\\alpha_{x})$$\n这里，$B_{1}$ 和 $B_{2}$ 是磁弹性耦合常数。一个与 $\\epsilon_{xx}+\\epsilon_{yy}+\\epsilon_{zz}$ 成正比的额外各向同性项与磁化方向无关，可以忽略，因为它只对恒定的能量偏移有贡献。\n\n问题指明了薄膜的应变状态。它是一种等双轴面内应变，薄膜法线沿 $z$ 轴方向。非零应变分量为：\n$$ \\epsilon_{xx} = \\epsilon_{yy} = \\epsilon $$\n$$ \\epsilon_{zz} = -2\\nu\\epsilon $$\n所有剪切应变分量均为零：\n$$ \\epsilon_{xy} = \\epsilon_{yz} = \\epsilon_{zx} = 0 $$\n其中 $\\epsilon$ 是面内应变的大小，$\\nu$ 是一个有效的弹性耦合常数。\n\n将这些应变分量代入 $F_{\\text{me}}$ 的通用表达式中：\n$$F_{\\text{me}} = B_{1}(\\epsilon\\alpha_{x}^{2} + \\epsilon\\alpha_{y}^{2} + (-2\\nu\\epsilon)\\alpha_{z}^{2}) + B_{2}(0 \\cdot \\alpha_{x}\\alpha_{y} + 0 \\cdot \\alpha_{y}\\alpha_{z} + 0 \\cdot \\alpha_{z}\\alpha_{x})$$\n由于没有剪切应变，与 $B_{2}$ 成正比的项消失。表达式简化为：\n$$F_{\\text{me}} = B_{1}\\epsilon(\\alpha_{x}^{2} + \\alpha_{y}^{2} - 2\\nu\\alpha_{z}^{2})$$\n方向余弦 $\\alpha_{x}$、$\\alpha_{y}$ 和 $\\alpha_{z}$ 满足归一化条件：\n$$ \\alpha_{x}^{2} + \\alpha_{y}^{2} + \\alpha_{z}^{2} = 1 $$\n这使我们能够消去面内分量 $\\alpha_{x}^{2}$ 和 $\\alpha_{y}^{2}$：\n$$ \\alpha_{x}^{2} + \\alpha_{y}^{2} = 1 - \\alpha_{z}^{2} $$\n将此式代入 $F_{\\text{me}}$ 的表达式中：\n$$F_{\\text{me}} = B_{1}\\epsilon((1 - \\alpha_{z}^{2}) - 2\\nu\\alpha_{z}^{2})$$\n$$F_{\\text{me}} = B_{1}\\epsilon(1 - (1 + 2\\nu)\\alpha_{z}^{2})$$\n问题定义 $\\theta$ 为磁化矢量与薄膜法线（$z$ 轴）之间的夹角。因此，方向余弦 $\\alpha_{z}$ 与 $\\theta$ 的关系为：\n$$ \\alpha_{z} = \\cos\\theta $$\n将此关系代入能量表达式中：\n$$F_{\\text{me}} = B_{1}\\epsilon(1 - (1 + 2\\nu)\\cos^{2}\\theta)$$\n问题要求最终的能量表达式形式为 $F_{\\text{me}} = K_{\\text{me}}\\sin^{2}\\theta + \\text{const}$。为达到此目的，我们使用三角恒等式 $\\cos^{2}\\theta = 1 - \\sin^{2}\\theta$：\n$$F_{\\text{me}} = B_{1}\\epsilon(1 - (1 + 2\\nu)(1 - \\sin^{2}\\theta))$$\n$$F_{\\text{me}} = B_{1}\\epsilon(1 - (1 + 2\\nu) + (1 + 2\\nu)\\sin^{2}\\theta)$$\n$$F_{\\text{me}} = B_{1}\\epsilon(-2\\nu + (1 + 2\\nu)\\sin^{2}\\theta)$$\n将前面的因子 $B_{1}\\epsilon$ 分配进去：\n$$F_{\\text{me}} = B_{1}\\epsilon(1 + 2\\nu)\\sin^{2}\\theta - 2\\nu B_{1}\\epsilon$$\n此表达式现在是所期望的单轴形式 $F_{\\text{me}} = K_{\\text{me}}\\sin^{2}\\theta + \\text{const}$，其中常数项与 $\\theta$ 无关。通过比较这两种形式，我们可以将有效单轴各向异性常数 $K_{\\text{me}}$ 确定为 $\\sin^{2}\\theta$ 项的系数。\n\n因此，有效磁弹各向异性常数为：\n$$ K_{\\text{me}} = B_{1}\\epsilon(1 + 2\\nu) $$\n常数偏移量为 $\\text{const} = -2\\nu B_{1}\\epsilon$。问题只要求给出 $K_{\\text{me}}$ 的表达式。", "answer": "$$\n\\boxed{B_{1}\\epsilon(1 + 2\\nu)}\n$$", "id": "3002883"}, {"introduction": "在理论推导了各向异性常数之后，本练习将理论与实验联系起来，展示了一种从实验测量的磁化-磁场（$M-H$）曲线中确定各向异性能密度的经典而强大的方法。此练习涉及计算沿易磁化轴和难磁化轴磁化材料所做的功，并证明其差值即为各向异性常数 $K_u$。这加强了对磁功与储存能量之间热力学联系的理解。[@problem_id:3002886]", "problem": "在恒定温度下，于准静态可逆条件下对一个单轴铁磁体进行测量。在对退磁场进行校正后，沿晶体学易磁化轴和难磁化轴，获得了内部磁场作为磁化强度函数的曲线。饱和磁化强度为 $M_{s}=8.00\\times 10^{5}\\ \\mathrm{A\\,m^{-1}}$。在 $0\\leq M\\leq M_{s}$ 的范围内，可逆的内部磁场-磁化强度关系可以很好地由以下公式描述：\n$$H_{\\text{hard}}(M)=1.25\\,M,$$\n$$H_{\\text{easy}}(M)=0.08\\,M+0.04\\,\\frac{M^{3}}{M_{s}^{2}},$$\n其中 $H$ 和 $M$ 的单位均为 $\\mathrm{A\\,m^{-1}}$。假设磁弹性效应和任何外在的钉扎贡献可以忽略不计，并且测量进行得足够缓慢以避免涡流耗散。在国际单位制（SI）下进行计算，其中准静态磁功密度与磁化强度的变化关系为 $dW=\\mu_{0}\\,H\\,dM$，且 $\\mu_{0}=4\\pi\\times 10^{-7}\\ \\mathrm{N\\,A^{-2}}$。\n\n从热力学功的表达式出发，并根据磁晶各向异性能密度的定义（在固定磁化强度 $M$ 的大小下，使磁化强度从易磁化轴旋转到难磁化轴所需的单位体积可逆功），推导单轴各向异性常数 $K_{u}$ 的表达式，该表达式应使用 $H$–$M$ 平面中难磁化轴和易磁化轴可逆曲线之间的面积来表示。清晰地陈述此构造有效所需满足的假设。然后，使用给定的 $H(M)$ 关系式，对 $K_{u}$ 进行数值计算。\n\n将 $K_{u}$ 的最终答案以 $\\mathrm{kJ\\,m^{-3}}$ 为单位表示，并四舍五入到四位有效数字。", "solution": "该问题要求：推导单轴各向异性常数 $K_u$（用难磁化轴和易磁化轴磁化曲线之间的面积表示），陈述其基本假设，并对 $K_u$ 进行数值计算。\n\n首先，我们验证问题陈述的有效性。\n\n### 步骤 1：提取已知条件\n- 饱和磁化强度：$M_{s}=8.00\\times 10^{5}\\ \\mathrm{A\\,m^{-1}}$\n- 难磁化轴内部磁场-磁化强度关系：$H_{\\text{hard}}(M)=1.25\\,M$ 对于 $0\\leq M\\leq M_{s}$\n- 易磁化轴内部磁场-磁化强度关系：$H_{\\text{easy}}(M)=0.08\\,M+0.04\\,\\frac{M^{3}}{M_{s}^{2}}$ 对于 $0\\leq M\\leq M_{s}$\n- 准静态磁功密度变化：$dW=\\mu_{0}\\,H\\,dM$\n- 自由空间磁导率：$\\mu_{0}=4\\pi\\times 10^{-7}\\ \\mathrm{N\\,A^{-2}}$\n- 磁晶各向异性能密度的定义：在固定磁化强度大小 $M$ 的情况下，使磁化强度从易磁化轴旋转到难磁化轴所需的单位体积可逆功。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上基于凝聚态物理学中的磁学原理。它使用了磁功和磁晶各向异性的标准定义。所提供的场-磁化关系 $H(M)$ 的函数形式是唯象的，但对于单轴材料中的可逆磁化过程是物理上合理的。问题提法得当、内容自洽，并为获得唯一解提供了所有必要数据。语言客观明确。所提供的值在物理上是现实的。该问题是磁学中的一个标准练习，既不琐碎也非病态问题。\n\n### 步骤 3：结论与行动\n此问题被判定为有效。将提供完整解答。\n\n### 推导与求解\n\n将材料从退磁状态（$M=0$）磁化到磁化强度大小为 $M$ 的状态时，单位体积所做的磁功 $W$ 由功密度表达式的积分给出：\n$$W(M) = \\int_0^M \\mu_0 H(m) dm$$\n在恒定温度下，该功对应于系统亥姆霍兹自由能密度中磁性部分的改变量。\n\n对于单轴磁性材料，磁晶各向异性能密度 $E_a$ 是依赖于磁化矢量相对于晶轴方向的能量。对于最简单的单轴情况，其表达式为：\n$$E_a(\\theta) = K_u \\sin^2(\\theta)$$\n其中 $K_u$ 是一阶单轴各向异性常数，$\\theta$ 是磁化矢量与易磁化轴之间的夹角。\n\n当材料沿易磁化轴磁化时，$\\theta=0$，因此储存的各向异性能为 $E_a(0) = K_u \\sin^2(0) = 0$。沿易磁化轴将材料磁化至饱和磁化强度 $M_s$ 所做的功为：\n$$W_{\\text{easy}} = \\int_0^{M_s} \\mu_0 H_{\\text{easy}}(M) dM$$\n\n当材料沿难磁化轴磁化时，磁化强度被迫与易磁化轴垂直排列，因此 $\\theta=\\frac{\\pi}{2}$。在此状态下储存的各向异性能密度为 $E_a(\\frac{\\pi}{2}) = K_u \\sin^2(\\frac{\\pi}{2}) = K_u$。沿难磁化轴将材料磁化至饱和磁化强度 $M_s$ 所做的功为：\n$$W_{\\text{hard}} = \\int_0^{M_s} \\mu_0 H_{\\text{hard}}(M) dM$$\n\n沿难磁化轴和易磁化轴将材料磁化至饱和所需的功之差，必须等于这两种状态下储存的各向异性能之差。\n$$\\Delta W = W_{\\text{hard}} - W_{\\text{easy}} = E_a(\\frac{\\pi}{2}) - E_a(0) = K_u - 0 = K_u$$\n因此，我们可以将 $K_u$ 表示为：\n$$K_u = \\int_0^{M_s} \\mu_0 H_{\\text{hard}}(M) dM - \\int_0^{M_s} \\mu_0 H_{\\text{easy}}(M) dM$$\n$$K_u = \\mu_0 \\int_0^{M_s} \\left[ H_{\\text{hard}}(M) - H_{\\text{easy}}(M) \\right] dM$$\n积分项 $A = \\int_0^{M_s} [H_{\\text{hard}}(M) - H_{\\text{easy}}(M)] dM$ 表示在 $H-M$ 平面中，从 $M=0$ 到 $M=M_s$，难磁化轴和易磁化轴磁化曲线所包围的面积。因此，单轴各向异性常数的表达式为：\n$$K_u = \\mu_0 A$$\n\n此推导所需的主要假设是：\n1.  磁化过程是热力学可逆和准静态的。\n2.  系统的自由能可以加和地分离为一个磁晶各向异性项和一个与磁场相互作用相关的项。\n3.  单轴各向异性能密度可以由一阶项 $E_a = K_u \\sin^2(\\theta)$ 充分描述，更高阶的项可以忽略不计。\n4.  各向异性常数 $K_u$ 与磁化强度大小 $M$ 无关。\n5.  如问题中所述，诸如畴壁钉扎、磁弹性贡献和样品形状（退磁场）等外在效应可以忽略不计或已得到适当校正。\n6.  测量是在单晶或完全取向的多晶样品上进行的。\n\n现在，我们进行数值计算。首先，我们通过对给定磁场表达式之差从 $M=0$ 到 $M=M_s$ 进行积分，求出面积 $A$。\n$$H_{\\text{hard}}(M) - H_{\\text{easy}}(M) = (1.25\\,M) - \\left(0.08\\,M+0.04\\,\\frac{M^{3}}{M_{s}^{2}}\\right) = 1.17\\,M - 0.04\\,\\frac{M^{3}}{M_{s}^{2}}$$\n$$A = \\int_0^{M_s} \\left( 1.17\\,M - 0.04\\,\\frac{M^{3}}{M_{s}^{2}} \\right) dM$$\n进行积分：\n$$A = \\left[ \\frac{1.17}{2} M^{2} - \\frac{0.04}{4 M_{s}^{2}} M^{4} \\right]_0^{M_s}$$\n$$A = \\left[ 0.585 M^{2} - \\frac{0.01}{M_{s}^{2}} M^{4} \\right]_0^{M_s}$$\n计算定积分：\n$$A = \\left( 0.585 M_{s}^{2} - \\frac{0.01}{M_{s}^{2}} M_{s}^{4} \\right) - (0) = 0.585 M_{s}^{2} - 0.01 M_{s}^{2} = 0.575 M_{s}^{2}$$\n现在，我们计算 $K_u$：\n$$K_u = \\mu_0 A = \\mu_0 (0.575 M_{s}^{2})$$\n代入给定值 $M_{s}=8.00\\times 10^{5}\\ \\mathrm{A\\,m^{-1}}$ 和 $\\mu_{0}=4\\pi\\times 10^{-7}\\ \\mathrm{N\\,A^{-2}}$：\n$$K_u = (4\\pi\\times 10^{-7}\\ \\mathrm{N\\,A^{-2}}) \\times 0.575 \\times (8.00\\times 10^{5}\\ \\mathrm{A\\,m^{-1}})^{2}$$\n$$K_u = (4\\pi\\times 10^{-7}) \\times 0.575 \\times (64.0 \\times 10^{10})\\ \\mathrm{N\\,m^{-2}}$$\n单位 $\\mathrm{N\\,m^{-2}}$ 等同于 $\\mathrm{J\\,m^{-3}}$，这对于能量密度是正确的。\n$$K_u = (4\\pi \\times 0.575 \\times 64.0) \\times 10^{-7} \\times 10^{10}\\ \\mathrm{J\\,m^{-3}}$$\n$$K_u = (462.4424...) \\times 10^{3}\\ \\mathrm{J\\,m^{-3}}$$\n问题要求答案以千焦每立方米（$\\mathrm{kJ\\,m^{-3}}$）为单位。\n$$K_u = 462.4424...\\ \\mathrm{kJ\\,m^{-3}}$$\n按要求四舍五入到四位有效数字：\n$$K_u \\approx 462.4\\ \\mathrm{kJ\\,m^{-3}}$$", "answer": "$$\\boxed{462.4}$$", "id": "3002886"}, {"introduction": "在探讨了静态能量形貌及其实验测量之后，我们现在转向动力学。这个高级练习深入研究了磁化强度的计算模型，该模型由包含各向异性能和交换能的 Landau-Lifshitz-Gilbert (LLG) 方程控制。您的任务是分析一个数值模拟方案的稳定性，这是计算物理学中确保数值结果具有物理意义的关键技能，它将静态能量概念与自旋的时间依赖行为、进动和弛豫联系起来。[@problem_id:3002841]", "problem": "要求您为具有立方磁晶各向异性的一维铁磁薄膜中的磁化动力学设计一种时域有限差分计算。该演化过程由 Landau-Lifshitz-Gilbert (LLG) 方程控制，其中磁化单位矢量场表示为 $m(x,t) = \\left(m_x,m_y,m_z\\right)$，有效场 $H_{\\mathrm{eff}}(x,t)$ 由总微磁能量密度导出。您的任务是从基本定义出发，构建一个显式的有限差分空间离散化方案和一个前向欧拉时间步进格式，然后围绕一个均匀易磁轴状态进行线性稳定性分析，以确定对时间步长的稳定性约束。该分析必须基于：\n\n- 标准的微磁形式的 Landau-Lifshitz-Gilbert (LLG) 方程，其中 $H_{\\mathrm{eff}}$ 的单位是安培/米，旋磁常数 $\\gamma_0$ 的单位是秒$^{-1}$·米/安培：\n  $$\\frac{\\partial m}{\\partial t} = - \\gamma_0\\, m \\times H_{\\mathrm{eff}} + \\alpha\\, m \\times \\frac{\\partial m}{\\partial t},$$\n  其中 $\\alpha$ 是无量纲的 Gilbert 阻尼参数，且 $|m| = 1$。\n\n- 交换能密度，\n  $$E_{\\mathrm{ex}} = A\\, |\\nabla m|^2,$$\n  其中 $A$ 是交换刚度（单位为焦耳/米）。\n\n- 立方磁晶各向异性能密度，\n  $$E_{\\mathrm{cub}} = K_1 \\left(m_x^2 m_y^2 + m_y^2 m_z^2 + m_z^2 m_x^2\\right),$$\n  其中 $K_1$ 是一阶立方各向异性常数（单位为焦耳/立方米）。\n\n- 通过能量的变分微分得到的有效场，\n  $$H_{\\mathrm{eff}} = -\\frac{1}{\\mu_0 M_s}\\, \\frac{\\delta E}{\\delta m},$$\n  其中 $\\mu_0$ 是真空磁导率（单位为亨利/米），$M_s$ 是饱和磁化强度（单位为安培/米）。\n\n执行以下操作：\n\n1. 为交换项推导一个一致的一维中心差分离散化，并在间距为 $\\Delta x$ 的均匀网格上计算其离散拉普拉斯算子的特征值界。推导 $m_j^n \\approx m(x_j, t_n)$ 的显式前向欧拉时间步进更新式，并指明为强制 $|m_j^{n+1}|=1$ 所需的任何归一化步骤。\n\n2. 围绕一个均匀易磁轴平衡态 $m_0 = (1,0,0)$ 对您的离散格式进行线性化，保留横向小分量的领头阶项。使用此线性化结果，确定离散系统所支持的最高进动频率的界，将其表示为材料参数和网格间距的函数。\n\n3. 从线性化的离散动力学出发，为显式欧拉法推导一个充分稳定性条件，该条件用最大允许时间步长 $\\Delta t_{\\max}$ 表示，并使用物理参数 $A$、$K_1$、$M_s$、$\\mu_0$、$\\gamma_0$ 以及网格间距 $\\Delta x$ 来表达。清晰地陈述推导中使用的所有假设。您的稳定性条件必须以秒为单位表示。\n\n4. 实现一个程序，对于下方的每个测试用例，该程序计算相应的 $\\Delta t_{\\max}$ 并返回一个布尔值，用于说明给定的 $\\Delta t$ 是否满足您的稳定性约束。所有量都必须使用国际单位制 (SI) 处理：$A$ 的单位是焦耳/米， $K_1$ 的单位是焦耳/立方米， $M_s$ 的单位是安培/米， $\\mu_0$ 的单位是亨利/米， $\\gamma_0$ 的单位是秒$^{-1}$·米/安培， $\\Delta x$ 的单位是米， $\\Delta t$ 的单位是秒。由于输出是纯粹的 SI 单位数值，因此不需要角度单位。\n\n5. 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素都是 $[\\Delta t_{\\max}, \\mathrm{is\\_stable}]$ 形式的包含两个条目的列表。第一个条目是一个以秒为单位的浮点数，第二个条目是一个布尔值，其稳定性谓词定义为 $\\Delta t \\le \\Delta t_{\\max}$。\n\n使用以下测试套件，它探测了多种不同情况。对于每个用例，使用 $\\mu_0 = 4\\pi \\times 10^{-7}$ 和 $\\gamma_0 = 2.211 \\times 10^{5}$。参数如下：\n\n- 案例1（通用，交换主导网格，理想路径）：$A = 1.3 \\times 10^{-11}$，$K_1 = 4.8 \\times 10^{4}$，$M_s = 8.0 \\times 10^{5}$，$\\Delta x = 2.0 \\times 10^{-9}$，$\\alpha = 2.0 \\times 10^{-2}$，并测试 $\\Delta t = 1.0 \\times 10^{-15}$。\n\n- 案例2（接近稳定性边界，略在界内）：$A = 1.3 \\times 10^{-11}$，$K_1 = 4.8 \\times 10^{4}$，$M_s = 8.0 \\times 10^{5}$，$\\Delta x = 2.0 \\times 10^{-9}$，$\\alpha = 2.0 \\times 10^{-2}$，并测试 $\\Delta t = 6.9 \\times 10^{-15}$。\n\n- 案例3（阻尼趋于零，预计不稳定）：$A = 1.3 \\times 10^{-11}$，$K_1 = 4.8 \\times 10^{4}$，$M_s = 8.0 \\times 10^{5}$，$\\Delta x = 2.0 \\times 10^{-9}$，$\\alpha = 1.0 \\times 10^{-6}$，并测试 $\\Delta t = 1.0 \\times 10^{-15}$。\n\n- 案例4（极细网格，交换主导不稳定性）：$A = 1.3 \\times 10^{-11}$，$K_1 = 4.8 \\times 10^{4}$，$M_s = 8.0 \\times 10^{5}$，$\\Delta x = 5.0 \\times 10^{-10}$，$\\alpha = 2.0 \\times 10^{-2}$，并测试 $\\Delta t = 1.0 \\times 10^{-15}$。\n\n- 案例5（无交换，各向异性主导）：$A = 0$，$K_1 = 2.0 \\times 10^{5}$，$M_s = 1.0 \\times 10^{6}$，$\\Delta x = 1.0 \\times 10^{-9}$，$\\alpha = 1.0 \\times 10^{-1}$，并测试 $\\Delta t = 2.0 \\times 10^{-12}$。\n\n- 案例6（负立方各向异性，典型的类铁符号）：$A = 2.1 \\times 10^{-11}$，$K_1 = -1.0 \\times 10^{5}$，$M_s = 1.7 \\times 10^{6}$，$\\Delta x = 1.0 \\times 10^{-9}$，$\\alpha = 2.0 \\times 10^{-2}$，并测试 $\\Delta t = 2.0 \\times 10^{-15}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，例如：$[[\\Delta t_{\\max,1}, \\mathrm{is\\_stable}_1],[\\Delta t_{\\max,2}, \\mathrm{is\\_stable}_2],\\dots]$。", "solution": "该问题要求为具有立方各向异性的一维 Landau-Lifshitz-Gilbert (LLG) 方程的时域有限差分 (FDTD) 模拟推导数值稳定性条件。求解过程分为几个步骤：规范化运动方程，在空间和时间上对其进行离散化，围绕平衡态对离散系统进行线性化，最后执行 von Neumann 稳定性分析以找到最大稳定时间步长 $\\Delta t_{\\max}$。\n\n首先，我们陈述给定的 Gilbert 形式的 Landau-Lifshitz-Gilbert (LLG) 方程：\n$$ \\frac{\\partial m}{\\partial t} = - \\gamma_0\\, m \\times H_{\\mathrm{eff}} + \\alpha\\, m \\times \\frac{\\partial m}{\\partial t} $$\n其中 $m$ 是归一化磁化矢量（$|m|=1$），$\\gamma_0$ 是旋磁常数，$\\alpha$ 是 Gilbert 阻尼参数，$H_{\\mathrm{eff}}$ 是有效磁场。此方程可重排为等价的 Landau-Lifshitz (LL) 形式，这更便于分析：\n$$ \\frac{\\partial m}{\\partial t} = - \\frac{\\gamma_0}{1+\\alpha^2} \\left( m \\times H_{\\mathrm{eff}} \\right) - \\frac{\\alpha \\gamma_0}{1+\\alpha^2} \\left( m \\times (m \\times H_{\\mathrm{eff}}) \\right) $$\n\n有效场 $H_{\\mathrm{eff}}$ 通过变分导数由总能量密度 $E = E_{\\mathrm{ex}} + E_{\\mathrm{cub}}$ 导出：\n$$ H_{\\mathrm{eff}} = -\\frac{1}{\\mu_0 M_s} \\frac{\\delta E}{\\delta m} $$\n能量密度项包括交换能 $E_{\\mathrm{ex}} = A |\\nabla m|^2$ 和立方各向异性能 $E_{\\mathrm{cub}} = K_1 (m_x^2 m_y^2 + m_y^2 m_z^2 + m_z^2 m_x^2)$。对有效场的相应贡献为：\n$$ H_{\\mathrm{eff, ex}} = -\\frac{1}{\\mu_0 M_s} \\frac{\\delta E_{\\mathrm{ex}}}{\\delta m} = \\frac{2A}{\\mu_0 M_s} \\nabla^2 m $$\n$$ H_{\\mathrm{eff, cub}} = -\\frac{2K_1}{\\mu_0 M_s} \\begin{pmatrix} m_x(1-m_x^2) \\\\ m_y(1-m_y^2) \\\\ m_z(1-m_z^2) \\end{pmatrix} $$\n因此，总有效场为 $H_{\\mathrm{eff}} = H_{\\mathrm{eff, ex}} + H_{\\mathrm{eff, cub}}$。\n\n对于 FDTD 格式，我们将一维空间离散化到点为 $x_j = j \\Delta x$ 的网格上。空间二阶导数（拉普拉斯算子）使用二阶中心差分近似：\n$$ (\\nabla^2 m)_j \\approx \\frac{m_{j+1} - 2m_j + m_{j-1}}{(\\Delta x)^2} $$\n对于平面波模式 $m_j \\propto e^{ikx_j}$，此离散拉普拉斯算子的特征值为 $\\lambda_k = -\\frac{4}{(\\Delta x)^2}\\sin^2(\\frac{k\\Delta x}{2})$。模最大的特征值出现在最高空间频率（奈奎斯特频率） $k_{\\max}=\\pi/\\Delta x$ 处，这给出 $\\lambda_{k_{\\max}} = -4/(\\Delta x)^2$。\n\n时间演化使用显式前向欧拉法离散化：\n$$ \\frac{m_j^{n+1} - m_j^n}{\\Delta t} = \\left(\\frac{\\partial m}{\\partial t}\\right)_j^n $$\n$$ m_j^{*,n+1} = m_j^n + \\Delta t \\left(\\frac{\\partial m}{\\partial t}\\right)_j^n $$\n其中右侧（RHS）使用在时间步 $n$ 的离散有效场，并基于 LL 形式进行评估。由于此更新不保持 $m$ 的单位长度，因此需要一个归一化步骤：$m_j^{n+1} = m_j^{*,n+1} / |m_j^{*,n+1}|$。\n\n为分析数值稳定性，我们在均匀平衡态 $m_0 = (1,0,0)$ 附近对系统进行线性化。设 $m = (1, m_y, m_z)$，其中 $m_y$ 和 $m_z$ 是小的横向微扰。到一阶，$m_x \\approx 1$。有效场线性化为 $H_{\\mathrm{eff}} \\approx (0, \\mathcal{L}m_y, \\mathcal{L}m_z)$，其中 $\\mathcal{L}$ 是一个线性算子：\n$$ \\mathcal{L}m_p = \\frac{2A}{\\mu_0 M_s} \\nabla^2 m_p - \\frac{2K_1}{\\mu_0 M_s} m_p, \\quad p \\in \\{y,z\\} $$\n将此代入 LL 方程并仅保留 $m_y$ 和 $m_z$ 的一阶项，我们得到横向分量的线性系统：\n$$ \\frac{\\partial}{\\partial t} \\begin{pmatrix} m_y \\\\ m_z \\end{pmatrix} = -\\frac{\\gamma_0}{1+\\alpha^2} \\begin{pmatrix} \\alpha(-\\mathcal{L}) & -(-\\mathcal{L}) \\\\ -\\mathcal{L} & \\alpha(-\\mathcal{L}) \\end{pmatrix} \\begin{pmatrix} m_y \\\\ m_z \\end{pmatrix} = \\frac{\\gamma_0 \\mathcal{L}}{1+\\alpha^2} \\begin{pmatrix} \\alpha & 1 \\\\ -1 & \\alpha \\end{pmatrix} \\begin{pmatrix} m_y \\\\ m_z \\end{pmatrix} $$\n在空间傅里叶域（von Neumann 分析）中，对于每个波矢 $k$，算子 $\\mathcal{L}$ 变为一个标量特征值 $L_k$：\n$$ L_k = \\frac{2A}{\\mu_0 M_s}\\left(-\\frac{4\\sin^2(k\\Delta x/2)}{(\\Delta x)^2}\\right) - \\frac{2K_1}{\\mu_0 M_s} = -\\frac{2}{\\mu_0 M_s}\\left(\\frac{4A\\sin^2(k\\Delta x/2)}{(\\Delta x)^2} + K_1\\right) $$\n时间演化矩阵的特征值则为 $\\Omega_k = \\frac{\\gamma_0 L_k}{1+\\alpha^2}(\\alpha \\pm i)$。\n\n为使前向欧拉法稳定，每个模式的放大因子模长不得大于 $1$。即，对于所有 $k$，有 $|1 + \\Delta t \\Omega_k| \\le 1$。这个不等式在复平面中描述了一个以 $(-1,0)$ 为中心、半径为 $1$ 的圆。该条件等价于 $2 \\mathrm{Re}(\\Delta t \\Omega_k) + |\\Delta t \\Omega_k|^2 \\le 0$。由于 $\\Delta t > 0$，这可简化为：\n$$ \\Delta t \\le -\\frac{2 \\mathrm{Re}(\\Omega_k)}{|\\Omega_k|^2} $$\n$\\Omega_k$ 的实部和模的平方为：\n$$ \\mathrm{Re}(\\Omega_k) = \\frac{\\gamma_0 L_k \\alpha}{1+\\alpha^2} $$\n$$ |\\Omega_k|^2 = \\frac{(\\gamma_0 L_k)^2(\\alpha^2+1)}{(1+\\alpha^2)^2} = \\frac{(\\gamma_0 L_k)^2}{1+\\alpha^2} $$\n代入这些可得到每个模式的条件：\n$$ \\Delta t \\le -\\frac{2 \\left(\\frac{\\gamma_0 L_k \\alpha}{1+\\alpha^2}\\right)}{\\frac{(\\gamma_0 L_k)^2}{1+\\alpha^2}} = -\\frac{2\\alpha}{\\gamma_0 L_k} $$\n为保证平衡态的物理稳定性，我们要求物理系统特征值的实部为非正。为使 $m_0=(1,0,0)$ 成为一个稳定平衡态（易磁轴），$K_1$ 应为正。在这种情况下，$L_k$ 总是负的。如果 $K_1<0$，$m_0$ 是一个鞍点，对长波微扰不稳定。然而，数值稳定性由具有最大速率的模式决定，该速率可以是衰减率或增长率。\n稳定性约束必须对所有 $k$ 成立，因此我们必须使用最严格的情况，这对应于 $|\\Omega_k|$ 的最大值。这种情况在 $|L_k|$ 为最大值时发生。我们必须在 $k \\in [0, \\pi/\\Delta x]$ 上找到 $|L_k|$ 的最大值。\n$$ |L_k| = \\frac{2}{\\mu_0 M_s} \\left| \\frac{4A\\sin^2(k\\Delta x/2)}{(\\Delta x)^2} + K_1 \\right| $$\n依赖于 $k$ 的项是单调的，所以 $|L_k|$ 的最大值必须出现在 $k$ 域的边界处，即 $k=0$ 或 $k=\\pi/\\Delta x$。\n$$ |L_{k=0}| = \\frac{2|K_1|}{\\mu_0 M_s} $$\n$$ |L_{k=\\pi/\\Delta x}| = \\frac{2}{\\mu_0 M_s} \\left| \\frac{4A}{(\\Delta x)^2} + K_1 \\right| $$\n令 $|L_{\\max}| = \\max(|L_{k=0}|, |L_{k=\\pi/\\Delta x}|)$。稳定性条件变为 $\\Delta t \\le \\frac{2\\alpha}{\\gamma_0 |L_{\\max}|}$。\n因此，最大允许时间步长为：\n$$ \\Delta t_{\\max} = \\frac{2\\alpha}{\\gamma_0 |L_{\\max}|} = \\frac{2\\alpha}{\\gamma_0 \\frac{2}{\\mu_0 M_s} \\max\\left(|K_1|, \\left|\\frac{4A}{(\\Delta x)^2} + K_1\\right|\\right)} = \\frac{\\alpha \\mu_0 M_s}{\\gamma_0 \\max\\left(|K_1|, \\left|\\frac{4A}{(\\Delta x)^2} + K_1\\right|\\right)} $$\n这是用于计算的最终表达式。\n注意所作的假设：围绕 $m_0=(1,0,0)$ 的线性化、中心差分空间离散化、前向欧拉时间积分以及周期性边界条件（隐含在傅里叶分析中）。我们测试了所有模式的稳定性，包括当 $K_1 < 0$ 时物理上不稳定的模式，因为这些快速增长的模式同样会约束数值时间步长。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the maximum stable timestep in a 1D FDTD micromagnetic simulation.\n    \"\"\"\n    \n    # Define physical constants.\n    MU_0 = 4 * np.pi * 1e-7  # Vacuum permeability in H/m\n    GAMMA_0 = 2.211e5        # Gyromagnetic constant in m/(A*s)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: (A, K1, Ms, dx, alpha, dt_test)\n        (1.3e-11, 4.8e4, 8.0e5, 2.0e-9, 2.0e-2, 1.0e-15),\n        # Case 2:\n        (1.3e-11, 4.8e4, 8.0e5, 2.0e-9, 2.0e-2, 6.9e-15),\n        # Case 3:\n        (1.3e-11, 4.8e4, 8.0e5, 2.0e-9, 1.0e-6, 1.0e-15),\n        # Case 4:\n        (1.3e-11, 4.8e4, 8.0e5, 5.0e-10, 2.0e-2, 1.0e-15),\n        # Case 5:\n        (0.0, 2.0e5, 1.0e6, 1.0e-9, 1.0e-1, 2.0e-12),\n        # Case 6:\n        (2.1e-11, -1.0e5, 1.7e6, 1.0e-9, 2.0e-2, 2.0e-15),\n    ]\n\n    results = []\n    for params in test_cases:\n        A, K1, Ms, dx, alpha, dt_test = params\n        \n        # Calculate the maximum eigenvalue of the discrete spatial operator.\n        # This determines the highest frequency/rate in the system.\n        \n        # Contribution from anisotropy term alone (corresponds to k=0 mode).\n        # This is |K1|.\n        L_term1 = abs(K1)\n        \n        # Contribution from exchange and anisotropy (corresponds to k=pi/dx mode).\n        # This is |4A/dx^2 + K1|.\n        exchange_term_max = 4 * A / (dx**2)\n        L_term2 = abs(exchange_term_max + K1)\n        \n        # The maximum value that drives the stability limit.\n        max_L_term = max(L_term1, L_term2)\n        \n        # The stability condition for explicit Euler applied to the LLG equation is:\n        # dt_max = (alpha * mu_0 * Ms) / (gamma_0 * max(|K1|, |4A/dx^2 + K1|))\n        \n        numerator = alpha * MU_0 * Ms\n        denominator = GAMMA_0 * max_L_term\n        \n        # Handle the case where the denominator is zero (e.g., A=0, K1=0).\n        # This would correspond to a free spin, no fields, dt_max is infinite.\n        if denominator == 0:\n            dt_max = float('inf')\n        else:\n            dt_max = numerator / denominator\n\n        # Check if the given timestep is stable.\n        is_stable = dt_test = dt_max\n        \n        results.append([dt_max, is_stable])\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists matches the required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3002841"}]}