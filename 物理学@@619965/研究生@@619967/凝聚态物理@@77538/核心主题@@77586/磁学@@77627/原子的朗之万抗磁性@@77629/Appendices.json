{"hands_on_practices": [{"introduction": "理论物理学的力量在于能从第一性原理出发，推导出描述自然现象的公式。本练习将引导你通过经典力学的方法，为一个被谐振子势束缚的电子建立哈密顿量，并推导其在磁场中的响应。通过这个过程，你将亲手揭示朗之万抗磁性公式的经典起源，并理解磁化率与电子轨道均方半径 $\\langle r^2 \\rangle$ 之间的深刻联系。[@problem_id:3000024]", "problem": "考虑一个带电量为 $-e$、质量为 $m$ 的经典电子，该电子被束缚在一个各向同性的谐振子势 $V(\\mathbf{r}) = \\frac{1}{2} m \\omega_{0}^{2} r^{2}$ 中，其中 $r = |\\mathbf{r}|$ 且 $\\omega_{0}$ 是特征角频率。施加一个静态、空间均匀的磁场 $\\mathbf{B} = B \\hat{\\mathbf{z}}$，该磁场从零绝热地开启到一个小的有限值，使得保留到 $B^{2}$ 阶的项足以捕捉其主要响应。计算在国际单位制 (SI) 下进行，并对矢量势采用对称规范 $\\mathbf{A}(\\mathbf{r}) = \\frac{1}{2} \\mathbf{B} \\times \\mathbf{r}$。\n\n从经典最小耦合哈密顿量 $H(\\mathbf{r},\\mathbf{p}) = \\frac{1}{2m} \\left|\\mathbf{p} - e \\mathbf{A}(\\mathbf{r})\\right|^{2} + \\frac{1}{2} m \\omega_{0}^{2} r^{2}$ 出发，推导由场引起的束缚运动轨道平均能量的主要阶变化 $\\Delta E(B)$。定义沿场方向的感应磁矩为 $\\mu_{z}(B) = - \\frac{\\partial \\Delta E}{\\partial B}$，并定义磁化率 $\\alpha_{m}$，在 $B$ 的主要阶上满足 $\\mu_{z}(B) = \\alpha_{m} B$。假设未受扰动的运动是各向同性的，其轨道相对于 $\\hat{\\mathbf{z}}$ 的取向是均匀分布的，并且系综平均的净轨道角动量为零，因此，在轨道平均后，$B$ 的线性项贡献消失。\n\n将磁化率 $\\alpha_{m}$ 的最终结果表示为一个用 $e$、$m$、$\\omega_{0}$ 以及束缚运动的未受扰动总能量 $E$ 表示的单一闭式解析表达式。所有物理量均使用国际单位制。不进行任何舍入；提供精确的符号表达式。最后，明确证明您的结果仅依赖于轨道的未受扰动均方半径 $\\langle r^{2} \\rangle$，从而与和原子 Langevin 抗磁性相关的经典预测相匹配。您的最终方框答案必须是 $\\alpha_{m}$ 的解析表达式。", "solution": "该问题要求解在弱静态磁场作用下，一个被束缚在各向同性谐振子势中的经典电子的磁化率 $\\alpha_m$。首先需要验证问题陈述本身。\n\n题目给出的哈密顿量为 $H(\\mathbf{r},\\mathbf{p}) = \\frac{1}{2m} |\\mathbf{p} - e \\mathbf{A}(\\mathbf{r})|^2 + V(\\mathbf{r})$，而粒子被指定为电荷为 $q = -e$ 的电子。标准的最小耦合方案是用动能动量 $\\mathbf{p} - q\\mathbf{A}$ 替换正则动量 $\\mathbf{p}$。对于电荷 $q=-e$，这导致动能项为 $\\frac{1}{2m}|\\mathbf{p} - (-e)\\mathbf{A}|^2 = \\frac{1}{2m}|\\mathbf{p} + e\\mathbf{A}|^2$。问题陈述中提供的哈密顿量 $\\frac{1}{2m}|\\mathbf{p} - e\\mathbf{A}|^2$ 对应于一个电荷为 $+e$ 的粒子。这在形式上构成了一个矛盾。然而，题目明确指出，磁场 $B$ 的线性贡献在平均后将被忽略。随后的 $B$ 的二次项依赖于 $e^2$，因此不受此符号模糊性的影响。核心物理问题依然是良定的，所以我们继续展开给定的哈密顿量。\n\n哈密顿量为 $H = \\frac{1}{2m} (\\mathbf{p} - e\\mathbf{A}) \\cdot (\\mathbf{p} - e\\mathbf{A}) + V(\\mathbf{r}) = \\frac{\\mathbf{p}^2}{2m} - \\frac{e}{2m}(\\mathbf{p} \\cdot \\mathbf{A} + \\mathbf{A} \\cdot \\mathbf{p}) + \\frac{e^2}{2m} A^2 + V(\\mathbf{r})$。\n在经典力学中，$\\mathbf{p}$ 和 $\\mathbf{A}(\\mathbf{r})$ 是可交换的，因此 $\\mathbf{p} \\cdot \\mathbf{A} = \\mathbf{A} \\cdot \\mathbf{p}$。\n因此，$H = \\frac{\\mathbf{p}^2}{2m} + V(\\mathbf{r}) - \\frac{e}{m} \\mathbf{p} \\cdot \\mathbf{A} + \\frac{e^2}{2m} A^2$。\n未受扰动的哈密顿量是 $H_0 = \\frac{\\mathbf{p}^2}{2m} + V(\\mathbf{r}) = \\frac{\\mathbf{p}^2}{2m} + \\frac{1}{2}m\\omega_0^2 r^2$。\n由磁场引起的微扰是 $\\Delta H = - \\frac{e}{m} \\mathbf{p} \\cdot \\mathbf{A} + \\frac{e^2}{2m} A^2$。\n\n我们代入对称规范的矢量势 $\\mathbf{A}(\\mathbf{r}) = \\frac{1}{2} \\mathbf{B} \\times \\mathbf{r}$。\n$\\Delta H$ 中的第一项变为：\n$$ - \\frac{e}{m} \\mathbf{p} \\cdot \\left(\\frac{1}{2} \\mathbf{B} \\times \\mathbf{r}\\right) = - \\frac{e}{2m} \\mathbf{B} \\cdot (\\mathbf{r} \\times \\mathbf{p}) = - \\frac{e}{2m} \\mathbf{B} \\cdot \\mathbf{L} $$\n其中 $\\mathbf{L} = \\mathbf{r} \\times \\mathbf{p}$ 是轨道角动量。值得注意的是，如果我们使用了电子的正确哈密顿量，即 $q=-e$，这一项将是 $+\\frac{e}{2m}\\mathbf{B}\\cdot\\mathbf{L}$，它表示标准的 Zeeman 相互作用能 $-\\boldsymbol{\\mu} \\cdot \\mathbf{B}$，其中 $\\boldsymbol{\\mu} = \\frac{q}{2m}\\mathbf{L} = -\\frac{e}{2m}\\mathbf{L}$。\n\n$\\Delta H$ 中的第二项是场的二次项：\n$$ \\frac{e^2}{2m} A^2 = \\frac{e^2}{2m} \\left|\\frac{1}{2}\\mathbf{B} \\times \\mathbf{r}\\right|^2 = \\frac{e^2}{8m} (\\mathbf{B} \\times \\mathbf{r}) \\cdot (\\mathbf{B} \\times \\mathbf{r}) $$\n使用矢量恒等式 $(\\mathbf{a} \\times \\mathbf{b}) \\cdot (\\mathbf{a} \\times \\mathbf{b}) = a^2 b^2 - (\\mathbf{a} \\cdot \\mathbf{b})^2$，我们得到：\n$$ A^2 = \\frac{1}{4} (B^2 r^2 - (\\mathbf{B} \\cdot \\mathbf{r})^2) $$\n当 $\\mathbf{B} = B\\hat{\\mathbf{z}}$ 时，我们有 $|\\mathbf{B}| = B$ 和 $\\mathbf{B} \\cdot \\mathbf{r} = B z$。\n$$ A^2 = \\frac{B^2}{4}(x^2+y^2) $$\n所以第二项是 $\\frac{e^2 B^2}{8m}(x^2+y^2)$。\n\n完整的哈密顿量微扰是 $\\Delta H = \\mp \\frac{e}{2m} \\mathbf{L} \\cdot \\mathbf{B} + \\frac{e^2 B^2}{8m}(x^2+y^2)$，其中符号的模糊性已被指出。\n由场引起的轨道平均能量变化 $\\Delta E(B)$ 是 $\\Delta H$ 在未受扰动运动上的平均值，记为 $\\langle \\dots \\rangle_0$。\n$$ \\Delta E(B) = \\langle \\Delta H \\rangle_0 = \\mp \\frac{e}{2m} \\langle \\mathbf{L} \\cdot \\mathbf{B} \\rangle_0 + \\frac{e^2 B^2}{8m} \\langle x^2+y^2 \\rangle_0 $$\n题目陈述任何净轨道角动量平均值为零，这意味着 $\\langle \\mathbf{L} \\rangle_0 = 0$。因此，$B$ 的线性项 $\\langle \\mathbf{L} \\cdot \\mathbf{B} \\rangle_0 = \\mathbf{B} \\cdot \\langle \\mathbf{L} \\rangle_0$ 为零。这解决了我们计算中的符号模糊性。\n我们得到能量的主要阶变化为：\n$$ \\Delta E(B) = \\frac{e^2 B^2}{8m} \\langle x^2+y^2 \\rangle_0 $$\n题目假设未受扰动的运动是各向同性的。对于一个各向同性的系统，坐标平方的平均值相等：$\\langle x^2 \\rangle_0 = \\langle y^2 \\rangle_0 = \\langle z^2 \\rangle_0$。\n因为 $r^2 = x^2+y^2+z^2$，我们有 $\\langle r^2 \\rangle_0 = \\langle x^2 \\rangle_0 + \\langle y^2 \\rangle_0 + \\langle z^2 \\rangle_0 = 3\\langle x^2 \\rangle_0$。\n这使我们可以写出 $\\langle x^2 \\rangle_0 = \\langle y^2 \\rangle_0 = \\frac{1}{3}\\langle r^2 \\rangle_0$。\n将此代入 $\\Delta E(B)$ 的表达式中：\n$$ \\langle x^2+y^2 \\rangle_0 = \\langle x^2 \\rangle_0 + \\langle y^2 \\rangle_0 = \\frac{1}{3}\\langle r^2 \\rangle_0 + \\frac{1}{3}\\langle r^2 \\rangle_0 = \\frac{2}{3}\\langle r^2 \\rangle_0 $$\n$$ \\Delta E(B) = \\frac{e^2 B^2}{8m} \\left( \\frac{2}{3} \\langle r^2 \\rangle_0 \\right) = \\frac{e^2 B^2}{12m} \\langle r^2 \\rangle_0 $$\n为了用未受扰动能量 $E$ 来表示它，我们使用维里定理，对于处在势 $V \\propto r^n$ 中的粒子。对于谐振子, $n=2$，该定理指出平均动能 $\\langle T \\rangle_0$ 等于平均势能 $\\langle V \\rangle_0$。\n$$ E = \\langle H_0 \\rangle_0 = \\langle T \\rangle_0 + \\langle V \\rangle_0 = 2 \\langle V \\rangle_0 $$\n势能为 $V(\\mathbf{r}) = \\frac{1}{2} m \\omega_0^2 r^2$。其平均值为：\n$$ \\langle V \\rangle_0 = \\left\\langle \\frac{1}{2} m \\omega_0^2 r^2 \\right\\rangle_0 = \\frac{1}{2} m \\omega_0^2 \\langle r^2 \\rangle_0 $$\n从 $E = 2 \\langle V \\rangle_0$ 可得 $E = 2 \\left( \\frac{1}{2} m \\omega_0^2 \\langle r^2 \\rangle_0 \\right) = m \\omega_0^2 \\langle r^2 \\rangle_0$。\n由此，我们求得用总能量表示的均方半径：\n$$ \\langle r^2 \\rangle_0 = \\frac{E}{m \\omega_0^2} $$\n将此代入我们关于 $\\Delta E(B)$ 的表达式中：\n$$ \\Delta E(B) = \\frac{e^2 B^2}{12m} \\left( \\frac{E}{m \\omega_0^2} \\right) = \\frac{e^2 E B^2}{12 m^2 \\omega_0^2} $$\n这就是场引起的能量变化。沿场轴的感应磁矩定义为 $\\mu_z(B) = - \\frac{\\partial \\Delta E}{\\partial B}$。\n$$ \\mu_z(B) = - \\frac{\\partial}{\\partial B} \\left( \\frac{e^2 E B^2}{12 m^2 \\omega_0^2} \\right) = - \\frac{e^2 E}{12 m^2 \\omega_0^2} (2B) = - \\frac{e^2 E B}{6 m^2 \\omega_0^2} $$\n磁化率 $\\alpha_m$ 由 $\\mu_z(B) = \\alpha_m B$ 定义。将此与我们得到的 $\\mu_z(B)$ 结果进行比较：\n$$ \\alpha_m B = - \\frac{e^2 E B}{6 m^2 \\omega_0^2} $$\n$$ \\alpha_m = - \\frac{e^2 E}{6 m^2 \\omega_0^2} $$\n负号表示抗磁响应，这与预期相符。\n\n最后，题目要求证明此结果仅依赖于未受扰动的均方半径 $\\langle r^2 \\rangle$。我们可以通过将 $E = m \\omega_0^2 \\langle r^2 \\rangle_0$ 代回到我们关于 $\\alpha_m$ 的表达式中来做到这一点：\n$$ \\alpha_m = - \\frac{e^2 (m \\omega_0^2 \\langle r^2 \\rangle_0)}{6 m^2 \\omega_0^2} = - \\frac{e^2}{6m} \\langle r^2 \\rangle_0 $$\n这证实了磁化率与电子轨道的均方半径成正比，这是经典 Langevin 抗磁性理论的基石。所要求的最终答案是 $\\alpha_m$ 用 $e$、$m$、$\\omega_0$ 和 $E$ 表示的表达式。", "answer": "$$\n\\boxed{-\\frac{e^2 E}{6 m^2 \\omega_{0}^{2}}}\n$$", "id": "3000024"}, {"introduction": "物理学定律的一个重要应用是连接宏观可测性质与微观结构参数。在本实践中，你将利用已知的硅晶体宏观磁化率数据，反向应用朗之万抗磁性公式来估算硅原子内电子轨道的均方根半径。这个练习不仅能让你熟练运用公式，更重要的是，它展示了如何通过宏观实验测量来“窥探”原子的微观世界。[@problem_id:1769910]", "problem": "材料的磁化率提供了一种探究其微观电子结构的无损方法。对于像硅这样的抗磁性材料，其对外磁场的微弱排斥作用与电子轨道的平均空间范围有关。\n\n考虑一个纯晶体硅样品。使用下面提供的数据，估算硅原子中一个电子的轨道半径均方根 $\\sqrt{\\langle r^2 \\rangle}$。假设抗磁性的经典模型适用。\n\n**给定数据：**\n-   硅的磁化率（国际单位制中的无量纲量）：$\\chi = -3.10 \\times 10^{-6}$\n-   硅的质量密度：$\\rho = 2.33 \\text{ g/cm}^3$\n-   硅的摩尔质量：$M_{molar} = 28.09 \\text{ g/mol}$\n-   硅的原子序数：$Z = 14$\n\n**基本常数：**\n-   真空磁导率：$\\mu_0 = 4\\pi \\times 10^{-7} \\text{ N/A}^2$\n-   电子质量：$m_e = 9.11 \\times 10^{-31} \\text{ kg}$\n-   元电荷：$e = 1.60 \\times 10^{-19} \\text{ C}$\n-   阿伏伽德罗常数：$N_A = 6.02 \\times 10^{23} \\text{ mol}^{-1}$\n\n最终答案以埃（$\\text{\\AA}$）为单位，并保留三位有效数字。注意 $1 \\text{ \\AA} = 10^{-10} \\text{ m}$。", "solution": "在经典的Larmor抗磁性模型中，由弱磁场 $B$ 在单个原子上感生出的磁矩由下式给出\n$$\nm_{\\text{atom}}=-\\frac{e^{2}}{6 m_{e}}\\left(\\sum_{i=1}^{Z}\\langle r_{i}^{2}\\rangle\\right)B,\n$$\n因此，原子数密度为 $N$ 的材料的磁化强度 $M$ 为\n$$\nM=N\\,m_{\\text{atom}}=-N\\frac{e^{2}}{6 m_{e}}\\left(\\sum_{i=1}^{Z}\\langle r_{i}^{2}\\rangle\\right)B.\n$$\n对于线性响应，使用 $B=\\mu_{0}H$ 和 $M=\\chi H$，体积磁化率为\n$$\n\\chi=-\\mu_{0}N\\frac{e^{2}}{6 m_{e}}\\left(\\sum_{i=1}^{Z}\\langle r_{i}^{2}\\rangle\\right).\n$$\n定义平均每个电子的均方半径为 $\\langle r^{2}\\rangle\\equiv \\frac{1}{Z}\\sum_{i=1}^{Z}\\langle r_{i}^{2}\\rangle$，则上式变为\n$$\n\\chi=-\\mu_{0}N\\frac{e^{2}}{6 m_{e}}\\,Z\\,\\langle r^{2}\\rangle.\n$$\n解出 $\\langle r^{2}\\rangle$ 并考虑到对于抗磁性物质 $|\\chi|=-\\chi$，\n$$\n\\langle r^{2}\\rangle=\\frac{6 m_{e}|\\chi|}{\\mu_{0}e^{2}N Z}.\n$$\n原子数密度可由质量密度和摩尔质量得到：\n$$\nN=\\frac{\\rho}{M_{\\text{molar}}}N_{A}=\\frac{2.33\\times 10^{3}\\ \\text{kg/m}^{3}}{28.09\\times 10^{-3}\\ \\text{kg/mol}}\\times 6.02\\times 10^{23}\\ \\text{mol}^{-1}\\approx 4.996\\times 10^{28}\\ \\text{m}^{-3}.\n$$\n代入数值，\n$$\n\\langle r^{2}\\rangle=\\frac{6\\,(9.11\\times 10^{-31}\\ \\text{kg})\\,(3.10\\times 10^{-6})}{(4\\pi\\times 10^{-7}\\ \\text{N/A}^{2})\\,(1.60\\times 10^{-19}\\ \\text{C})^{2}\\,(4.996\\times 10^{28}\\ \\text{m}^{-3})\\,(14)}\\approx 7.53\\times 10^{-22}\\ \\text{m}^{2}.\n$$\n因此，均方根半径为\n$$\n\\sqrt{\\langle r^{2}\\rangle}\\approx \\sqrt{7.53\\times 10^{-22}}\\ \\text{m}\\approx 2.74\\times 10^{-11}\\ \\text{m}=0.274\\ \\text{\\AA}.\n$$\n以埃为单位并保留三位有效数字，估算值为$0.274$。", "answer": "$$\\boxed{0.274}$$", "id": "1769910"}, {"introduction": "朗之万抗磁性公式中的核心微观参数 $\\langle r^2 \\rangle$ 最终是由量子力学决定的。本练习将带你进入计算物理学的领域，通过编写程序数值计算类氢原子在不同量子态下的 $\\langle r^2 \\rangle$ 值。通过将你的数值结果与已知的解析解进行比较，你不仅能加深对量子力学波函数结构的理解，还能建立对理论公式和数值方法双重验证的信心。[@problem_id:3000000]", "problem": "你的任务是数值验证束缚类氢态的半径平方期望值 $\\langle r^2 \\rangle$ 的解析解，这在原子 Langevin 抗磁性的背景下出现。原子中单个束缚电子的抗磁磁化率通过一个源自磁场量子微扰理论且经过充分检验的线性关系与 $\\langle r^2 \\rangle$ 成正比。你的程序必须使用归一化的类氢径向波函数从第一性原理计算 $\\langle r^2 \\rangle$，并将其与已知的 $\\langle r^2 \\rangle$ 解析解进行比较，然后通过报告相对误差来评估数值精度。\n\n从以下基础出发：\n- 库仑势下的不含时 Schrödinger 方程存在可分离为径向和角向部分的归一化束缚态本征函数，其中径向部分取决于主量子数 $n$、角动量量子数 $\\ell$ 和核电荷数 $Z$。类氢径向函数可以用缔合 Laguerre 多项式和一个与 $r$ 成正比的无量纲变量 $\\rho$ 来表示。\n- 径向函数 $R_{n\\ell}(r)$ 的归一化条件是 $\\int_{0}^{\\infty} |R_{n\\ell}(r)|^2 r^2 \\, dr = 1$。\n- 任意径向物理量 $f(r)$ 的期望值是 $\\langle f(r) \\rangle = \\int_{0}^{\\infty} f(r) \\, |R_{n\\ell}(r)|^2 \\, r^2 \\, dr$。\n- 束缚电子的抗磁磁化率与 $\\langle r^2 \\rangle$ 成正比，因此 $\\langle r^2 \\rangle$ 中的任何相对误差都会直接导致磁化率中产生相同的相对误差。\n\n要求：\n- 为核电荷数为 $Z$ 的类氢离子实现归一化的类氢径向波函数 $R_{n\\ell}(r)$，使用标准的缔合 Laguerre 多项式形式，其宗量为 $\\rho = 2 Z r / (n a_0)$，其中 $a_0$ 是 Bohr 半径。你必须确保如上所述的精确归一化。\n- 使用在 $r \\in [0,\\infty)$ 上的可靠数值求积方法，通过计算积分 $\\int_{0}^{\\infty} r^4 |R_{n\\ell}(r)|^2 \\, dr$ 来计算 $\\langle r^2 \\rangle$ 的数值。请使用双精度浮点运算。\n- 为了进行验证，还需计算类氢态 $\\langle r^2 \\rangle$ 作为 $(n,\\ell,Z)$ 函数的已知解析解闭式值，此过程不涉及数值积分。请勿在程序中推导此公式；你可以直接在代码中实现该闭式。\n- 所有计算出的 $\\langle r^2 \\rangle$ 值都以 $a_0^2$ 为单位表示。最终报告的误差是无量纲的，因此输出中不需要物理单位。\n- 通过为每个测试用例计算相对误差 $\\varepsilon = |\\langle r^2 \\rangle_{\\text{num}} - \\langle r^2 \\rangle_{\\text{an}}| / \\langle r^2 \\rangle_{\\text{an}}$ 来评估数值精度。使用足够严格的求积容差，以使 $\\varepsilon$ 足够小而具有意义。\n\n测试套件：\n- 使用以下有序的测试用例列表，每个用例指定为 $(Z,n,\\ell)$，所有符号均为整数：$(1,1,0)$, $(1,2,0)$, $(1,2,1)$, $(2,1,0)$, $(3,3,2)$, $(2,5,0)$。\n- 这些用例探究以下情况：$Z=1$ 的基态 $1s$、一个径向激发的 $2s$ 态、一个角向激发的 $2p$ 态、$Z=2$ 时束缚更强的 $1s$ 态、$Z=3$ 的高 $\\ell$ 值情况 $3d$ 态，以及 $Z=2$ 时强调大长度尺度的有节高 $n$ 值 $5s$ 态。\n\n输出规格：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按照上面给出的确切顺序包含每个测试用例的相对误差 $\\varepsilon$（浮点数）。例如，输出形式为 $[\\varepsilon_1,\\varepsilon_2,\\dots,\\varepsilon_6]$。\n- 每个条目都必须是浮点数。不得打印任何其他文本。\n\n注意事项：\n- Bohr 半径 $a_0$ 仅用作单位转换常数。由于输出是无量纲的相对误差，并且要求你以 $a_0^2$ 为单位表示 $\\langle r^2 \\rangle$，为简化计算，你可以在计算中设置 $a_0 = 1$ 进行无量纲化处理。\n- 角度不直接用于径向积分；如果在任何中间推理中出现，请使用弧度。", "solution": "所提出的问题是计算量子物理学中一个有效且明确的练习。它要求对类氢原子各种束缚态的半径平方期望值 $\\langle r^2 \\rangle$ 的已知解析结果进行数值验证。这个量具有重要的物理意义，因为它与原子的抗磁磁化率成正比。解决方案包括实现类氢径向波函数，执行数值积分以求得 $\\langle r^2 \\rangle$，并将此结果与精确的解析解进行比较，以评估数值方法的准确性。所有的物理和数学前提都是合理的。\n\n解决方案分三个阶段进行：首先，基于量子理论定义必要的数学函数；其次，指定计算 $\\langle r^2 \\rangle$ 的数值和解析方法；第三，概述计算每个测试用例相对误差的过程。\n\n**1. 类氢径向波函数, $R_{n\\ell}(r)$**\n\n对于核电荷数为 $Z$ 的类氢原子，其不含时 Schrödinger 方程在球坐标系中可得到分离变量解。波函数的径向部分，记为 $R_{n\\ell}(r)$，取决于主量子数 $n \\in \\{1, 2, 3, \\dots\\}$ 和角动量量子数 $\\ell \\in \\{0, 1, \\dots, n-1\\}$。归一化的径向波函数由下式给出：\n\n$$\nR_{n\\ell}(r) = N_{n\\ell} \\cdot \\left(\\frac{2Zr}{na_0}\\right)^\\ell \\cdot \\exp\\left(-\\frac{Zr}{na_0}\\right) \\cdot L_{n-\\ell-1}^{2\\ell+1}\\left(\\frac{2Zr}{na_0}\\right)\n$$\n\n其中 $a_0$ 是 Bohr 半径，作为我们的长度单位。该表达式的组成部分是：\n- 归一化常数 $N_{n\\ell}$，它确保 $\\int_{0}^{\\infty} |R_{n\\ell}(r)|^2 r^2 dr = 1$：\n$$\nN_{n\\ell} = \\sqrt{\\left(\\frac{2Z}{na_0}\\right)^3 \\frac{(n-\\ell-1)!}{2n \\cdot (n+\\ell)!}}\n$$\n- 指数项 $\\exp(-Zr/(na_0))$，它保证波函数在远距离处衰减。\n- 项 $(2Zr/(na_0))^\\ell$，它决定了在原点 $r=0$ 附近的行为。\n- 函数 $L_{p}^{k}(x)$，即广义（或缔合） Laguerre 多项式。此处，多项式的次数为 $p = n-\\ell-1$，阶数为 $k = 2\\ell+1$。其宗量是无量纲半径 $\\rho = 2Zr/(na_0)$。\n\n为计算方便，所有长度均以 Bohr 半径为单位表示，实际上相当于设置 $a_0 = 1$。\n\n**2. 期望值 $\\langle r^2 \\rangle$ 的计算**\n\n期望值 $\\langle r^2 \\rangle$ 是电子到原子核距离的均方值。\n\n**a. 数值计算**\n根据量子力学原理，对于由径向波函数 $R_{n\\ell}(r)$ 描述的态，位置函数 $f(r)$ 的期望值由积分 $\\langle f(r) \\rangle = \\int_0^\\infty f(r) |R_{n\\ell}(r)|^2 r^2 dr$ 给出。当 $f(r) = r^2$ 时，该式变为：\n\n$$\n\\langle r^2 \\rangle_{\\text{num}} = \\int_{0}^{\\infty} r^2 \\cdot |R_{n\\ell}(r)|^2 r^2 dr = \\int_{0}^{\\infty} r^4 |R_{n\\ell}(r)|^2 dr\n$$\n\n被积函数 $r^4 |R_{n\\ell}(r)|^2$ 是一个良态函数，在 $r=0$ 处为零（因为 $\\ell > -1$ 总是成立），并在 $r \\to \\infty$ 时指数衰减至零。这使得该瑕积分适合进行高精度数值求积，我们将为此使用 `scipy.integrate.quad` 函数。为确保高精度，求积的相对和绝对误差容差将设置为一个严格的值，例如 $10^{-14}$。\n\n**b. 解析计算**\n类氢态的期望值 $\\langle r^2 \\rangle$ 有一个已知的解析解闭式，它可以通过使用 Laguerre 多项式的性质或算符方法推导出来。其公式为：\n\n$$\n\\langle r^2 \\rangle_{\\text{an}} = \\frac{a_0^2 n^2}{2Z^2} [5n^2 + 1 - 3\\ell(\\ell+1)]\n$$\n\n通过直接实现该公式，我们获得一个基准值，可以用来验证我们的数值积分。设 $a_0 = 1$，程序中使用的公式为：\n\n$$\n\\langle r^2 \\rangle_{\\text{an}} = \\frac{n^2}{2Z^2} [5n^2 + 1 - 3\\ell(\\ell+1)]\n$$\n\n**3. 误差分析与实现**\n\n最后一步是量化数值计算的精度。相对误差 $\\varepsilon$ 定义为数值结果与解析结果之间的绝对差值，再用解析结果进行归一化：\n\n$$\n\\varepsilon = \\frac{|\\langle r^2 \\rangle_{\\text{num}} - \\langle r^2 \\rangle_{\\text{an}}|}{\\langle r^2 \\rangle_{\\text{an}}}\n$$\n\n这个无量纲量度量了数值结果偏离真值的分数。\n\n实现将包括一个使用 `numpy` 和 `scipy` 库的 Python 脚本。\n- 一个辅助函数将为给定的量子数组 $(Z, n, \\ell)$ 构建径向波函数 $R_{n\\ell}(r)$。它将使用 `scipy.special.factorial` 计算归一化常数，并使用 `scipy.special.genlaguerre` 来评估缔合 Laguerre 多项式 $L_{n-\\ell-1}^{2\\ell+1}$。\n- 一个函数 `calculate_r2_numerical` 将定义被积函数 $r^4 |R_{n\\ell}(r)|^2$ 并将其连同积分限 $[0, \\infty)$ 一起传递给 `scipy.integrate.quad`。\n- 一个函数 `calculate_r2_analytical` 将根据闭式表达式计算其值。\n- 主 `solve` 例程将遍历所提供的测试用例：$(1,1,0)$、$(1,2,0)$、$(1,2,1)$、$(2,1,0)$、$(3,3,2)$ 和 $(2,5,0)$。对于每个用例，它将调用两个计算函数，计算相对误差 $\\varepsilon$，并收集结果。最终输出是按指定格式排列的这些误差的列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import genlaguerre, factorial\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the relative error between numerical and analytical values of\n    <r^2> for hydrogenic states for a given set of test cases.\n    \"\"\"\n    \n    # Test cases are tuples of (Z, n, l)\n    test_cases = [\n        (1, 1, 0),  # 1s state for Hydrogen\n        (1, 2, 0),  # 2s state for Hydrogen\n        (1, 2, 1),  # 2p state for Hydrogen\n        (2, 1, 0),  # 1s state for He+\n        (3, 3, 2),  # 3d state for Li++\n        (2, 5, 0),  # 5s state for He+\n    ]\n\n    results = []\n    \n    # Set Bohr radius a_0 = 1 for dimensionless calculations\n    a0 = 1.0\n\n    for Z, n, l in test_cases:\n        # 1. Define the normalized radial wavefunction R_nl(r)\n        \n        # Normalization constant N_nl as per the formula:\n        # sqrt( (2Z/na0)^3 * (n-l-1)! / (2n * (n+l)!) )\n        norm_const_factor1 = (2.0 * Z / (n * a0))**3\n        norm_const_factor2 = factorial(n - l - 1) / (2.0 * n * factorial(n + l))\n        norm_const = np.sqrt(norm_const_factor1 * norm_const_factor2)\n        \n        # Associated Laguerre polynomial L_{n-l-1}^{2l+1}(rho)\n        laguerre_poly = genlaguerre(n - l - 1, 2 * l + 1)\n        \n        def R_nl(r):\n            \"\"\"\n            Computes the value of the radial wavefunction R_nl at radius r.\n            \"\"\"\n            if r < 0:\n                return 0.0\n            \n            # Dimensionless radius variable rho\n            rho = 2.0 * Z * r / (n * a0)\n            \n            # The full expression for R_nl(r)\n            val = norm_const * (rho**l) * np.exp(-rho / 2.0) * laguerre_poly(rho)\n            return val\n\n        # 2. Compute <r^2> numerically\n        \n        def integrand_r2(r):\n            \"\"\"\n            The integrand for <r^2> is r^4 * |R_nl(r)|^2\n            \"\"\"\n            R = R_nl(r)\n            return r**4 * R**2\n\n        # Use quad for numerical integration from 0 to infinity.\n        # Set high precision to ensure numerical error is small.\n        r2_num, _ = quad(integrand_r2, 0, np.inf, epsabs=1e-15, epsrel=1e-15)\n\n        # 3. Compute <r^2> analytically\n        \n        # Formula: <r^2> = a0^2 * n^2 / (2 * Z^2) * [5*n^2 + 1 - 3*l*(l+1)]\n        r2_an = (a0**2 * n**2 / (2.0 * Z**2)) * (5 * n**2 + 1 - 3 * l * (l + 1))\n\n        # 4. Compute the relative error\n        \n        if r2_an == 0:\n            # Avoid division by zero, though not expected for these states\n            relative_error = np.abs(r2_num - r2_an)\n        else:\n            relative_error = np.abs(r2_num - r2_an) / r2_an\n            \n        results.append(relative_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3000000"}]}