{"hands_on_practices": [{"introduction": "本练习旨在深入探讨热激发磁振子对铁磁体磁化的影响，特别是在二维系统中。通过分析无能隙和有能隙两种情况，您将亲自验证 Mermin-Wagner 定理的结论，并理解各向异性能隙在低温下稳定长程磁有序的关键作用。这是一个理解维度和对称性在相变中重要性的基础性计算。[@problem_id:3017157]", "problem": "考虑一个二维各向同性 Heisenberg 铁磁体，在长波、低温区域，其自旋动力学可以很好地由无相互作用的磁子（线性自旋波理论）描述。设磁子色散由无能隙形式 $\\epsilon_{\\mathbf{k}}=D k^{2}$（各向同性情况）或有能隙形式 $\\epsilon_{\\mathbf{k}}=\\Delta + D k^{2}$（易轴各向异性情况）给出，其中 $D$ 是自旋波刚度，$\\Delta>0$ 是各向异性能隙。由热磁子引起的磁化密度减少量为\n$$\n\\delta M(T)= (g\\,\\mu_{B}) \\int \\frac{d^{2}k}{(2\\pi)^{2}}\\, n_{B}(\\epsilon_{\\mathbf{k}}),\n$$\n其中 $g$ 是朗德 $g$ 因子，$\\mu_{B}$ 是玻尔磁子，而 $n_{B}(x)=\\left[\\exp(x/T)-1\\right]^{-1}$ 是玻色–爱因斯坦 (BE) 分布。使用的单位制中，玻尔兹曼常数 $k_{B}=1$，因此温度 $T$ 的单位是能量。\n\n(a) 仅使用 $\\epsilon_{\\mathbf{k}}$ 的长波形式，分析在无能隙情况 $\\epsilon_{\\mathbf{k}}=Dk^{2}$ 下积分的红外行为，并确定对于任意固定的 $T>0$，$\\delta M(T)$ 是有限还是发散。\n\n(b) 对于有能隙情况 $\\epsilon_{\\mathbf{k}}=\\Delta + D k^{2}$，在低温极限 $T\\ll \\Delta$ 下，推导 $\\delta M(T)$ 的领头阶渐近形式。您的推导必须从上述表达式出发，并基于 BE 分布和连续 $\\mathbf{k}$ 空间积分的第一性原理进行，不得引用任何预先制表的渐近结果。\n\n请为您对有能隙情况的解答提供一个最终答案，该答案应为 $\\delta M(T)$ 在低温下的领头阶渐近形式的单个闭式解析表达式（每单位面积），用 $g$、$ \\mu_{B}$、$D$、$\\Delta$ 和 $T$ 表示。通过显式保留 $g\\,\\mu_{B}$，使答案以单位面积的磁矩为单位。无需进行数值计算。", "solution": "首先，将根据所需标准对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **系统**：二维各向同性 Heisenberg 铁磁体。\n- **模型**：长波、低温区域中的无相互作用磁子（线性自旋波理论）。\n- **磁子色散（无能隙）**：对于各向同性情况，为 $\\epsilon_{\\mathbf{k}}=D k^{2}$，其中 $D$ 是自旋波刚度， $k = |\\mathbf{k}|$。\n- **磁子色散（有能隙）**：对于易轴各向异性情况，为 $\\epsilon_{\\mathbf{k}}=\\Delta + D k^{2}$，其中 $\\Delta > 0$ 是各向异性能隙。\n- **磁化减少**：由热磁子引起的磁化密度减少量由以下积分给出：\n$$ \\delta M(T)= (g\\,\\mu_{B}) \\int \\frac{d^{2}k}{(2\\pi)^{2}}\\, n_{B}(\\epsilon_{\\mathbf{k}}) $$\n- **常数和函数**：\n  - $g$：朗德 $g$ 因子。\n  - $\\mu_{B}$：玻尔磁子。\n  - $n_{B}(x)=\\left[\\exp(x/T)-1\\right]^{-1}$：玻色–爱因斯坦 (BE) 分布。\n  - 单位：玻尔兹曼常数 $k_{B}=1$，因此温度 $T$ 的单位是能量。\n- **任务**：\n  (a) 对于无能隙情况（$\\epsilon_{\\mathbf{k}}=Dk^{2}$），分析积分的红外行为（$k \\to 0$），并确定对于任意固定的 $T>0$，$\\delta M(T)$ 是有限还是发散。\n  (b) 对于有能隙情况（$\\epsilon_{\\mathbf{k}}=\\Delta + D k^{2}$），在低温极限 $T\\ll \\Delta$ 下，推导 $\\delta M(T)$ 的领头阶渐近形式。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学性**：该问题根植于凝聚态物理学的基本原理，特别是铁磁材料中的磁子理论。磁子色散和磁化减少的表达式是线性自旋波理论的标准结果。积分收敛性的分析与统计力学的基石——Mermin-Wagner 定理直接相关。\n2.  **适定性**：该问题是适定的。(a) 部分要求对积分收敛性进行定性分析，(b) 部分要求进行特定的渐近推导。条件（(a) 中 $T>0$，(b) 中 $T \\ll \\Delta$）都已明确说明，并且每个部分都能推导出唯一且有意义的答案。\n3.  **客观性**：问题以精确、客观和定量的语言陈述，没有任何主观性或模糊性。\n4.  **完整性**：所有必要信息，包括色散关系、磁化减少的公式以及玻色–爱因斯坦分布的形式，都已提供。该问题是自洽的。\n5.  **一致性和真实性**：该设置为一个标准的理论模型，虽然经过简化，但抓住了二维磁体的基本物理特性。不存在内部矛盾或物理上不可能的条件。\n\n### 步骤3：结论与行动\n该问题在科学上是合理的、适定的和完整的。这是一个理论凝聚态物理中的有效问题。我将继续进行解答。\n\n### 解答\n\n**(a) 无能隙情况（$\\epsilon_{\\mathbf{k}}=Dk^{2}$）的分析**\n\n对于无能隙情况，磁化密度的减少量由下式给出：\n$$ \\delta M(T) = (g\\,\\mu_{B}) \\int \\frac{d^{2}k}{(2\\pi)^{2}}\\, n_{B}(Dk^{2}) = (g\\,\\mu_{B}) \\int \\frac{d^{2}k}{(2\\pi)^{2}}\\, \\frac{1}{\\exp(Dk^{2}/T) - 1} $$\n我们需要分析红外行为，这对应于小波矢（即 $k \\to 0$）时积分的行为。对于任意固定的温度 $T>0$，当 $k \\to 0$ 时，指数的自变量 $Dk^{2}/T \\to 0$。在此极限下，我们可以使用指数函数的泰勒展开，对于小的 $x$，有 $\\exp(x) \\approx 1 + x$。\n将此应用于玻色–爱因斯坦分布：\n$$ n_{B}(Dk^{2}) = \\frac{1}{\\exp(Dk^{2}/T) - 1} \\approx \\frac{1}{(1 + Dk^{2}/T) - 1} = \\frac{T}{Dk^{2}} \\quad \\text{当 } k \\to 0 \\text{ 时} $$\n$\\delta M(T)$ 的积分是在二维 $\\mathbf{k}$ 空间上进行的。为方便起见，我们切换到极坐标系，其中面积微元为 $d^{2}k = 2\\pi k \\, dk$。积分变为：\n$$ \\delta M(T) = \\frac{g\\,\\mu_{B}}{(2\\pi)^2} \\int_{0}^{k_{c}} 2\\pi k \\, dk \\, n_{B}(Dk^{2}) = \\frac{g\\,\\mu_{B}}{2\\pi} \\int_{0}^{k_{c}} k \\, dk \\, \\frac{1}{\\exp(Dk^{2}/T) - 1} $$\n其中 $k_{c}$ 是一个上限截止波矢，定义了长波区域的边界。积分的收敛性由其在下限 $k=0$ 附近的行为决定。代入被积函数在小 $k$ 时的近似：\n$$ \\int_{0}^{k_{c}} k \\left(\\frac{T}{Dk^{2}}\\right) dk = \\frac{T}{D} \\int_{0}^{k_{c}} \\frac{1}{k} \\, dk $$\n这个积分的形式为 $\\int (1/k) \\, dk = \\ln(k)$。从一个小的、非零的下限 $\\epsilon \\to 0$ 开始计算：\n$$ \\lim_{\\epsilon \\to 0} \\left[ \\ln(k) \\right]_{\\epsilon}^{k_{c}} = \\ln(k_{c}) - \\lim_{\\epsilon \\to 0} \\ln(\\epsilon) $$\n当 $\\epsilon \\to 0$ 时，$\\ln(\\epsilon) \\to -\\infty$。因此，积分在下限处对数发散。这被称为红外发散。\n因此，对于任何有限温度 $T > 0$，计算出的磁化减少量 $\\delta M(T)$ 都是无穷大。这意味着热涨落完全破坏了长程铁磁序，这一结果与 Mermin-Wagner 定理对于具有连续对称性和短程相互作用的二维系统所得出的结论一致。\n\n**(a) 的结论：** 对于任意 $T>0$，$\\delta M(T)$ 都是发散的。\n\n**(b) 有能隙情况（$\\epsilon_{\\mathbf{k}}=\\Delta + D k^{2}$）的渐近形式**\n\n对于有能隙情况，磁化减少量为：\n$$ \\delta M(T) = (g\\,\\mu_{B}) \\int \\frac{d^{2}k}{(2\\pi)^{2}}\\, \\frac{1}{\\exp((\\Delta + D k^{2})/T) - 1} $$\n我们关心的是低温极限，即 $T \\ll \\Delta$。这意味着比值 $\\Delta/T \\gg 1$。\n玻色–爱因斯坦分布的自变量是 $(\\Delta + Dk^2)/T$。因为 $\\Delta > 0$，$D > 0$，且 $k^2 \\ge 0$，所以该自变量总是大于或等于 $\\Delta/T$。鉴于 $T \\ll \\Delta$，该自变量总是很大的。\n对于一个大的自变量 $x \\gg 1$，玻色–爱因斯坦分布可以通过在分母中忽略与大的 $\\exp(x)$ 项相比的 $-1$ 来近似：\n$$ n_{B}(x) = \\frac{1}{\\exp(x) - 1} \\approx \\frac{1}{\\exp(x)} = \\exp(-x) $$\n将此近似应用于我们的积分：\n$$ \\delta M(T) \\approx (g\\,\\mu_{B}) \\int \\frac{d^{2}k}{(2\\pi)^{2}}\\, \\exp\\left(-\\frac{\\Delta + D k^{2}}{T}\\right) $$\n我们将 $\\mathbf{k}$ 空间上的积分转换为极坐标，其中 $k = |\\mathbf{k}|$ 且 $d^{2}k = 2\\pi k \\, dk$。$k$ 的积分范围是从 $0$ 到 $\\infty$。来自大 $k$ 的贡献被指数抑制，因此将积分上限从一个有限的截止值 $k_c$ 扩展到无穷大不会影响领头阶的渐近行为。\n$$ \\delta M(T) \\approx \\frac{g\\,\\mu_{B}}{(2\\pi)^2} \\int_0^\\infty (2\\pi k \\, dk) \\, \\exp\\left(-\\frac{\\Delta}{T}\\right) \\exp\\left(-\\frac{D k^{2}}{T}\\right) $$\n简化并提出与 $k$ 无关的项：\n$$ \\delta M(T) \\approx \\frac{g\\,\\mu_{B}}{2\\pi} \\exp\\left(-\\frac{\\Delta}{T}\\right) \\int_0^\\infty k \\exp\\left(-\\frac{D}{T} k^{2}\\right) dk $$\n剩下的积分是一个标准的高斯型积分。我们来计算它。我们进行变量替换。设 $u = \\frac{D}{T} k^{2}$。那么 $du = \\frac{2D}{T} k \\, dk$，这给出 $k \\, dk = \\frac{T}{2D} du$。$u$ 的积分极限是从 $u(k=0)=0$ 到 $u(k=\\infty)=\\infty$。\n$$ \\int_0^\\infty k \\exp\\left(-\\frac{D}{T} k^{2}\\right) dk = \\int_0^\\infty \\exp(-u) \\left(\\frac{T}{2D} du\\right) = \\frac{T}{2D} \\int_0^\\infty \\exp(-u) du $$\n定积分 $\\int_0^\\infty \\exp(-u) du = [-\\exp(-u)]_0^\\infty = (0) - (-1) = 1$。\n所以，该积分的值是 $\\frac{T}{2D}$。\n将此结果代回到 $\\delta M(T)$ 的表达式中：\n$$ \\delta M(T) \\approx \\frac{g\\,\\mu_{B}}{2\\pi} \\exp\\left(-\\frac{\\Delta}{T}\\right) \\left(\\frac{T}{2D}\\right) $$\n合并各项，得到低温极限下磁化减少量的领头阶渐近形式：\n$$ \\delta M(T) \\approx \\frac{g\\,\\mu_{B} T}{4\\pi D} \\exp\\left(-\\frac{\\Delta}{T}\\right) $$\n此表达式表明，由于能隙 $\\Delta$ 的存在，磁化减少量在低温下呈指数级抑制。", "answer": "$$\n\\boxed{\\frac{g \\mu_{B} T}{4 \\pi D} \\exp\\left(-\\frac{\\Delta}{T}\\right)}\n$$", "id": "3017157"}, {"introduction": "在理想晶体的基础上，本练习将我们带入更现实的无序系统。您将运用玻恩一阶近似（Born approximation）来计算由静态交换无序引起的弹性磁振子散射，从而推导出其平均自由程 $\\ell(\\varepsilon)$。这个实践对于理解磁振子输运性质（如热导率）以及光谱线宽的来源至关重要。[@problem_id:3017115]", "problem": "考虑一个三维简单立方晶格上的最近邻海森堡铁磁体，其晶格常数为 $a$，自旋长度为 $S$，均匀交换作用为 $J_0>0$，并受到弱淬火交换无序的微扰。在零温下，我们关注长波自旋波（磁振子），它们可以被视为无相互作用的玻色子准粒子，其色散关系为 $\\varepsilon_{\\boldsymbol{k}}=\\hbar \\omega_{\\boldsymbol{k}}=D k^2$，其中 $D$ 是自旋波刚度。在洁净极限下，对于简单立方晶格，其刚度为 $D=2 S J_0 a^2$。假设弱交换随机性 $\\delta J(\\boldsymbol{r})$ 可被粗粒化为一个标量随机势 $V(\\boldsymbol{r})$，该势以 $V(\\boldsymbol{r}) \\psi^{\\dagger}(\\boldsymbol{r}) \\psi(\\boldsymbol{r})$ 的形式与磁振子密度耦合，其中 $V(\\boldsymbol{r})=2 S z\\, \\delta J(\\boldsymbol{r})$，$z=6$ 是配位数。该无序是高斯的、静态的、且在空间上是 $\\delta$-相关的，其均值为零，关联函数为 $\\langle \\delta J(\\boldsymbol{r}) \\delta J(\\boldsymbol{r}') \\rangle = \\Delta_J^2 a^3 \\delta(\\boldsymbol{r}-\\boldsymbol{r}')$，其中 $\\Delta_J$ 是交换涨落的均方根振幅。忽略偶极相互作用、各向异性能隙以及任何非弹性磁振子-磁振子散射；严格在谐波近似下进行计算，并仅考虑由随机势引起的弹性散射。\n\n使用三维弹性散射的一阶 Born 近似，并假设样品无限大，计算磁振子能量为 $\\varepsilon=\\hbar \\omega$ 时的弹性磁振子平均自由程 $\\ell(\\varepsilon)$。您的推导必须从此情境下的基本原理出发，即：二次型磁振子色散、由 $v(\\varepsilon)=(1/\\hbar)\\, \\partial \\varepsilon_{\\boldsymbol{k}}/\\partial k$ 定义的群速度、三维各向同性二次能带的单位体积态密度，以及用无序关联函数表示的弹性散射率的 Born 近似表达式。假设 $\\delta J(\\boldsymbol{r})$ 和 $V(\\boldsymbol{r})$ 之间存在上述粗粒化映射关系，请将最终答案表示为 $\\ell(\\varepsilon)$ 的单一闭合形式解析表达式，用 $J_0$、$\\Delta_J$、$a$、$z$ 和基本常数表示。明确说明其对能量的依赖关系以及对无序强度的依赖关系。当所有输入均使用国际单位制（SI）时，请用米来表示您的答案。不要代入数值；仅提供符号结果。最终答案必须是单一的解析表达式。", "solution": "在尝试求解之前，对问题进行验证。\n\n### 步骤 1：提取已知条件\n-   系统：三维简单立方晶格上的最近邻海森堡铁磁体。\n-   晶格常数：$a$。\n-   自旋长度：$S$。\n-   均匀交换耦合：$J_0 > 0$。\n-   磁振子色散关系：$\\varepsilon_{\\boldsymbol{k}} = Dk^2$，其中 $k = |\\boldsymbol{k}|$。\n-   简单立方晶格的自旋波刚度：$D = 2 S J_0 a^2$。\n-   与磁振子密度耦合的无序势：$V(\\boldsymbol{r}) \\psi^{\\dagger}(\\boldsymbol{r}) \\psi(\\boldsymbol{r})$。\n-   粗粒化势：$V(\\boldsymbol{r}) = 2 S z\\, \\delta J(\\boldsymbol{r})$，配位数为 $z=6$。\n-   无序性质：高斯、静态、零均值 $\\langle \\delta J(\\boldsymbol{r}) \\rangle = 0$。\n-   无序关联函数：$\\langle \\delta J(\\boldsymbol{r}) \\delta J(\\boldsymbol{r}') \\rangle = \\Delta_J^2 a^3 \\delta(\\boldsymbol{r}-\\boldsymbol{r}')$，其中 $\\Delta_J$ 是交换涨落的均方根振幅。\n-   近似：零温、长波极限、无相互作用的磁振子（谐波近似）、仅弹性散射、无限大样品、忽略偶极相互作用和各向异性。\n-   任务：计算作为能量 $\\varepsilon$ 函数的弹性磁振子平均自由程 $\\ell(\\varepsilon)$。\n-   方法：使用一阶 Born 近似，群速度的定义 $v(\\varepsilon)=(1/\\hbar)\\, \\partial \\varepsilon_{\\boldsymbol{k}}/\\partial k$，以及三维各向同性二次能带的态密度。\n-   答案要求形式：用 $J_0$、$\\Delta_J$、$a$、$z$ 和基本常数表示的 $\\ell(\\varepsilon)$ 的单一闭合形式解析表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据：** 该问题描述了无序铁磁体中自旋波的标准模型。所使用的概念——Heisenberg 模型、磁振子、二次色散、自旋波刚度、Born 近似和平均自由程——都是凝聚态物理的基石。该模型在科学上是有效且公认的。\n-   **适定性：** 这是一个适定问题。它提供了所有必要的信息和明确的目标。可以从给定的前提中推导出一个唯一且有意义的解。\n-   **客观性：** 语言精确、量化，没有任何主观或模棱两可的术语。\n-   **完整性与一致性：** 该问题是自洽的。给定的参数彼此一致。例如，问题给出了微观交换作用 $J_0$ 与宏观刚度 $D$ 之间的关系，以及从交换无序 $\\delta J$ 到散射势 $V$ 的映射。\n\n### 步骤 3：结论与行动\n问题有效。将进行推导求解。\n\n### 推导过程\n准粒子的弹性平均自由程 $\\ell(\\varepsilon)$ 定义为其群速度 $v(\\varepsilon)$ 和其弹性散射寿命 $\\tau(\\varepsilon)$ 的乘积：\n$$ \\ell(\\varepsilon) = v(\\varepsilon) \\tau(\\varepsilon) $$\n我们将分别计算 $v(\\varepsilon)$ 和 $\\tau(\\varepsilon)$。\n\n**1. 群速度 $v(\\varepsilon)$**\n群速度定义为 $v_g = \\frac{1}{\\hbar} \\frac{\\partial \\varepsilon_{\\boldsymbol{k}}}{\\partial k}$。给定各向同性色散关系 $\\varepsilon_k = Dk^2$，我们有：\n$$ v_k = \\frac{1}{\\hbar} \\frac{\\partial}{\\partial k} (Dk^2) = \\frac{2Dk}{\\hbar} $$\n为将速度表示为能量 $\\varepsilon$ 的函数，我们使用关系式 $k = \\sqrt{\\varepsilon/D}$。将其代入 $v_k$ 的表达式中：\n$$ v(\\varepsilon) = \\frac{2D}{\\hbar} \\sqrt{\\frac{\\varepsilon}{D}} = \\frac{2}{\\hbar}\\sqrt{D\\varepsilon} $$\n\n**2. 弹性散射寿命 $\\tau(\\varepsilon)$**\n弹性散射寿命是散射率 $1/\\tau(\\varepsilon)$ 的倒数。在一阶 Born 近似（等效于 Fermi 黄金定则）中，从初态 $|\\boldsymbol{k}\\rangle$ 散射到任意末态 $|\\boldsymbol{k'}\\rangle$ 的散射率由下式给出：\n$$ \\frac{1}{\\tau_{\\boldsymbol{k}}} = \\frac{2\\pi}{\\hbar} \\sum_{\\boldsymbol{k'}} \\langle |\\langle\\boldsymbol{k'}|H'|\\boldsymbol{k}\\rangle|^2 \\rangle_{\\text{dis}} \\delta(\\varepsilon_{\\boldsymbol{k'}} - \\varepsilon_{\\boldsymbol{k}}) $$\n其中 $H'$ 是散射哈密顿量，$\\langle \\dots \\rangle_{\\text{dis}}$ 表示对无序系综的平均。散射势为 $V(\\boldsymbol{r})$，平面波态 $|\\boldsymbol{k}\\rangle = (1/\\sqrt{\\mathcal{V}})e^{i\\boldsymbol{k}\\cdot\\boldsymbol{r}}$（其中 $\\mathcal{V}$ 是系统体积）之间的矩阵元为：\n$$ \\langle\\boldsymbol{k'}|V|\\boldsymbol{k}\\rangle = \\frac{1}{\\mathcal{V}} \\int d^3r \\, e^{-i\\boldsymbol{k'}\\cdot\\boldsymbol{r}} V(\\boldsymbol{r}) e^{i\\boldsymbol{k}\\cdot\\boldsymbol{r}} = \\frac{1}{\\mathcal{V}} \\tilde{V}(\\boldsymbol{q}) $$\n其中 $\\boldsymbol{q} = \\boldsymbol{k'} - \\boldsymbol{k}$ 是散射波矢，$\\tilde{V}(\\boldsymbol{q})$ 是势 $V(\\boldsymbol{r})$ 的傅里叶变换。\n\n我们需要计算矩阵元平方的无序平均值：\n$$ \\langle |\\langle\\boldsymbol{k'}|V|\\boldsymbol{k}\\rangle|^2 \\rangle_{\\text{dis}} = \\frac{1}{\\mathcal{V}^2} \\langle |\\tilde{V}(\\boldsymbol{q})|^2 \\rangle_{\\text{dis}} $$\n让我们计算 $\\langle |\\tilde{V}(\\boldsymbol{q})|^2 \\rangle_{\\text{dis}}$：\n$$ \\langle |\\tilde{V}(\\boldsymbol{q})|^2 \\rangle_{\\text{dis}} = \\left\\langle \\int d^3r \\, e^{-i\\boldsymbol{q}\\cdot\\boldsymbol{r}} V(\\boldsymbol{r}) \\int d^3r' \\, e^{i\\boldsymbol{q}\\cdot\\boldsymbol{r'}} V(\\boldsymbol{r'}) \\right\\rangle_{\\text{dis}} $$\n$$ = \\iint d^3r \\, d^3r' \\, e^{-i\\boldsymbol{q}\\cdot(\\boldsymbol{r}-\\boldsymbol{r'})} \\langle V(\\boldsymbol{r}) V(\\boldsymbol{r'}) \\rangle_{\\text{dis}} $$\n使用给定的关系式 $V(\\boldsymbol{r}) = 2Sz\\,\\delta J(\\boldsymbol{r})$ 和 $\\langle \\delta J(\\boldsymbol{r}) \\delta J(\\boldsymbol{r'}) \\rangle = \\Delta_J^2 a^3 \\delta(\\boldsymbol{r}-\\boldsymbol{r'})$，势关联函数为：\n$$ \\langle V(\\boldsymbol{r}) V(\\boldsymbol{r'}) \\rangle_{\\text{dis}} = (2Sz)^2 \\langle \\delta J(\\boldsymbol{r}) \\delta J(\\boldsymbol{r'}) \\rangle_{\\text{dis}} = (2Sz)^2 \\Delta_J^2 a^3 \\delta(\\boldsymbol{r}-\\boldsymbol{r'}) $$\n将此式代回 $\\langle |\\tilde{V}(\\boldsymbol{q})|^2 \\rangle_{\\text{dis}}$ 的表达式中：\n$$ \\langle |\\tilde{V}(\\boldsymbol{q})|^2 \\rangle_{\\text{dis}} = \\iint d^3r \\, d^3r' \\, e^{-i\\boldsymbol{q}\\cdot(\\boldsymbol{r}-\\boldsymbol{r'})} (2Sz)^2 \\Delta_J^2 a^3 \\delta(\\boldsymbol{r}-\\boldsymbol{r'}) $$\n$$ = (2Sz)^2 \\Delta_J^2 a^3 \\int d^3r \\, e^{-i\\boldsymbol{q}\\cdot(\\boldsymbol{r}-\\boldsymbol{r})} = (2Sz)^2 \\Delta_J^2 a^3 \\int d^3r = (2Sz)^2 \\Delta_J^2 a^3 \\mathcal{V} $$\n结果与 $\\boldsymbol{q}$ 无关，这是 $\\delta$-相关（白噪声）随机势的特征。我们将常数 $(2Sz)^2 \\Delta_J^2 a^3$ 记为 $C_V$。\n\n现在，我们可以写出散射率。我们将对 $\\boldsymbol{k'}$ 的求和替换为对连续态的积分：$\\sum_{\\boldsymbol{k'}} \\to \\mathcal{V} \\int \\frac{d^3k'}{(2\\pi)^3}$。\n$$ \\frac{1}{\\tau(\\varepsilon)} = \\frac{2\\pi}{\\hbar} \\mathcal{V} \\int \\frac{d^3k'}{(2\\pi)^3} \\frac{C_V \\mathcal{V}}{\\mathcal{V}^2} \\delta(\\varepsilon_{\\boldsymbol{k'}} - \\varepsilon) $$\n$$ \\frac{1}{\\tau(\\varepsilon)} = \\frac{2\\pi C_V}{\\hbar(2\\pi)^3} \\int d^3k' \\, \\delta(\\varepsilon_{k'} - \\varepsilon) $$\n该积分等于 $(2\\pi)^3$ 乘以单位体积的态密度 $g(\\varepsilon)$。\n$$ \\int d^3k' \\, \\delta(\\varepsilon_{k'} - \\varepsilon) = (2\\pi)^3 g(\\varepsilon) $$\n对于三维各向同性二次色散 $\\varepsilon_k=Dk^2$，单位体积的态密度为：\n$$ g(\\varepsilon) = \\frac{d}{d\\varepsilon} \\left( \\frac{1}{(2\\pi)^3} \\frac{4}{3}\\pi k^3 \\right) = \\frac{d}{d\\varepsilon} \\left( \\frac{1}{6\\pi^2} \\left(\\frac{\\varepsilon}{D}\\right)^{3/2} \\right) = \\frac{1}{6\\pi^2 D^{3/2}} \\frac{3}{2} \\varepsilon^{1/2} = \\frac{\\sqrt{\\varepsilon}}{4\\pi^2 D^{3/2}} $$\n将此代入散射率的表达式中：\n$$ \\frac{1}{\\tau(\\varepsilon)} = \\frac{2\\pi C_V}{\\hbar} g(\\varepsilon) = \\frac{2\\pi}{\\hbar} ((2Sz)^2 \\Delta_J^2 a^3) \\left( \\frac{\\sqrt{\\varepsilon}}{4\\pi^2 D^{3/2}} \\right) $$\n$$ \\frac{1}{\\tau(\\varepsilon)} = \\frac{(2Sz)^2 \\Delta_J^2 a^3 \\sqrt{\\varepsilon}}{2\\pi \\hbar D^{3/2}} $$\n因此，散射寿命为：\n$$ \\tau(\\varepsilon) = \\frac{2\\pi \\hbar D^{3/2}}{(2Sz)^2 \\Delta_J^2 a^3 \\sqrt{\\varepsilon}} $$\n\n**3. 平均自由程 $\\ell(\\varepsilon)$**\n现在我们将 $v(\\varepsilon)$ 和 $\\tau(\\varepsilon)$ 的表达式合并：\n$$ \\ell(\\varepsilon) = v(\\varepsilon) \\tau(\\varepsilon) = \\left( \\frac{2\\sqrt{D\\varepsilon}}{\\hbar} \\right) \\left( \\frac{2\\pi \\hbar D^{3/2}}{(2Sz)^2 \\Delta_J^2 a^3 \\sqrt{\\varepsilon}} \\right) $$\n因子 $\\hbar$ 和 $\\sqrt{\\varepsilon}$ 消去了，这表明对于该模型，平均自由程与能量无关。\n$$ \\ell = \\frac{4\\pi D^{1/2} D^{3/2}}{(2Sz)^2 \\Delta_J^2 a^3} = \\frac{4\\pi D^2}{4z^2 S^2 \\Delta_J^2 a^3} = \\frac{\\pi D^2}{z^2 S^2 \\Delta_J^2 a^3} $$\n最后，我们代入给定的自旋波刚度表达式 $D = 2 S J_0 a^2$：\n$$ \\ell = \\frac{\\pi (2 S J_0 a^2)^2}{z^2 S^2 \\Delta_J^2 a^3} = \\frac{\\pi (4 S^2 J_0^2 a^4)}{z^2 S^2 \\Delta_J^2 a^3} $$\n$S^2$ 因子也消去了。化简表达式，我们得到：\n$$ \\ell = \\frac{4\\pi J_0^2 a}{z^2 \\Delta_J^2} $$\n这就是弹性平均自由程的最终表达式。它与磁振子能量 $\\varepsilon$ 无关（这是三维中 $k^2$ 色散和 $\\delta$-相关无序共同作用的结果），也与自旋长度 $S$ 无关。平均自由程与无序强度的平方成反比，即 $\\ell \\propto \\Delta_J^{-2}$，这与散射理论中散射截面与势强度的平方成正比的结论相符。\n\n简单立方晶格的数值 $z=6$ 已给出，但按照标准做法在此保留为符号，最终公式对于该模型下任何配位数为 $z$ 的晶格都是通用的。", "answer": "$$ \\boxed{\\frac{4\\pi J_{0}^{2} a}{z^{2} \\Delta_{J}^{2}}} $$", "id": "3017115"}, {"introduction": "这个综合性练习是理论与实验的桥梁，旨在模拟从非弹性中子散射数据中提取基本物理参数的全过程。您将通过编写程序来构建色散模型，拟合“测量”数据，并评估参数不确定性。这项实践训练了现代凝聚态物理学家必备的技能：将理论模型与实验数据进行定量比较。[@problem_id:3017112]", "problem": "您的任务是构建一个完备且有原则的估计器，用于从铁磁体中磁振子的合成非弹性中子散射数据中提取交换常数。该估计器需使用第一性原理基线，并考虑仪器分辨率。\n\n您的估计器必须实现为一个程序，该程序能够 (i) 从已知的真实参数合成测量数据，(ii) 使用源于仪器分辨率且有物理依据的权重将模型参数与合成数据进行拟合，以及 (iii) 报告从费雪信息中估计出的不确定度。所有结果必须以毫电子伏（meV）为单位报告，并且所有三角函数的参数都必须以弧度进行计算。最终程序必须打印单行内容，该行包含一个列表的列表，其元素为浮点数，格式详见“最终输出格式”部分。\n\n该问题的基础是位于布拉菲晶格上、具有自旋 $S$ 和弱单轴各向异性的量子海森堡铁磁体。其哈密顿量为\n$$\n\\hat{H} \\;=\\; -\\sum_{\\langle i,j \\rangle} J_{ij}\\,\\hat{\\mathbf{S}}_i\\cdot \\hat{\\mathbf{S}}_j \\;-\\; K\\sum_i \\left(\\hat{S}_i^z\\right)^2,\n$$\n其中，交换常数 $J_{ij} \\ge 0$ 有利于铁磁排列，各向异性 $K \\ge 0$。在线性自旋波近似下，围绕铁磁基态存在一个能量为 $\\epsilon_{\\mathbf{q}}$ 的单磁振子分支，其 delta 函数形式的动力学结构因子 $S(\\mathbf{q},\\omega)$ 集中在 $\\omega = \\epsilon_{\\mathbf{q}}/\\hbar$ 处。非弹性中子谱仪的仪器分辨率可以通过动量和能量上的高斯展宽来建模。在固定的标称波矢 $\\mathbf{q}$ 处扫描能量 $\\omega$ 时，通过误差传播，会产生一个由固有能量分辨率和色散斜率共同决定的有效能量宽度。\n\n您必须设计并实现一个程序，该程序能够：\n- 从线性自旋波框架出发，构建一维空间（最多包含次近邻交换）铁磁体和二维方格子上沿 $\\Gamma$–$X$ 方向（仅含最近邻）的磁振子色散 $\\epsilon_{\\mathbf{q}}$。各向异性在 $\\mathbf{q}=0$ 处引入一个能隙 $\\Delta$。\n- 在离散动量 $\\{\\mathbf{q}_i\\}$ 处合成“测量”的峰值能量 $\\{\\epsilon_i\\}$ 及其对应的动力学结构因子 $S(\\mathbf{q}_i,\\omega)$，使其在能量上呈高斯分布，中心位于 $\\epsilon_i$，其有效宽度通过仪器分辨率的传播得到。为完成此任务，您应将测量的峰值位置视为在采样动量处的真实色散值，同时使用有效宽度来定义参数估计中的统计权重。\n- 使用加权非线性最小二乘法估计未知的交换常数和各向异性能隙，其中每个点的权重使用由仪器分辨率限制的有效方差。使用费雪信息（等效于加权最小二乘目标函数的曲率）来估计拟合参数的单标准差不确定度。\n- 按要求为每个测试用例生成结果，并将它们汇总到单行输出中。\n\n您的估计器必须遵循以下物理和数学规范：\n\n- 从线性自旋波的结果出发，即 $S(\\mathbf{q},\\omega)$ 中的单磁振子峰值位于磁振子色散 $\\epsilon_{\\mathbf{q}}$ 处，并且该色散由铁磁相中交换耦合的傅里叶变换以及各向异性引起的能隙 $\\Delta$ 共同决定。\n- 对于一维链，其最近邻间距为 $a$，交换常数为 $J_1$（最近邻）和 $J_2$（次近邻），自旋为 $S$，您必须推导出色散 $\\epsilon_q$ 作为波矢 $q$ 的函数，以及不确定度传播所需的动量导数 $\\partial \\epsilon_q/\\partial q$。能隙 $\\Delta$ 以能量单位加法性地进入公式。对于二维方格子，如果只有最近邻交换 $J_1$，并且路径为 $q_y=0$ 的 $\\Gamma$–$X$ 路径，您必须推导出沿此截线的类似色散和斜率。\n- 将每个标称动量处的动力学结构因子建模为\n$$\nS(\\mathbf{q}_i,\\omega) \\;=\\; A_i \\exp\\!\\left[-\\frac{\\left(\\omega - \\epsilon_{\\mathbf{q}_i}\\right)^2}{2\\,\\sigma_{\\mathrm{eff}}(\\mathbf{q}_i)^2}\\right],\n$$\n其中振幅 $A_i$ 为常数，可取为1，有效能量宽度为\n$$\n\\sigma_{\\mathrm{eff}}(\\mathbf{q}_i) \\;=\\; \\sqrt{ \\sigma_\\omega^2 \\;+\\; \\left(\\frac{\\partial \\epsilon_{\\mathbf{q}}}{\\partial q}\\bigg|_{\\mathbf{q}_i}\\right)^2 \\sigma_q^2 }.\n$$\n这里 $\\sigma_\\omega$ 是仪器的能量分辨率（单位 meV），$\\sigma_q$ 是动量分辨率（单位 埃的倒数），$\\partial \\epsilon_{\\mathbf{q}}/\\partial q$ 是沿一维截线扫描方向投影的色散斜率。将 $qa$ 作为弧度处理。\n- 在对模型参数 $\\boldsymbol{\\theta}$ 与测量峰值能量 $\\{\\epsilon_i\\}$ 进行的加权非线性最小二乘拟合中，使用有效方差 $\\sigma_{\\mathrm{eff}}(\\mathbf{q}_i)^2$ 作为权重。即，最小化残差平方和\n$$\n\\chi^2(\\boldsymbol{\\theta}) \\;=\\; \\sum_i \\frac{\\left[ \\epsilon_i - \\epsilon_{\\mathrm{model}}(\\mathbf{q}_i;\\boldsymbol{\\theta}) \\right]^2}{\\sigma_{\\mathrm{eff}}(\\mathbf{q}_i;\\boldsymbol{\\theta})^2},\n$$\n并将有效方差视为已知。在优化过程中，可使用当前参数估计值迭代地重新计算 $\\sigma_{\\mathrm{eff}}$。\n- 从费雪信息矩阵估计参数不确定度\n$$\n\\mathcal{I}(\\boldsymbol{\\theta}^\\star) \\;=\\; \\mathbf{J}(\\boldsymbol{\\theta}^\\star)^\\top \\mathbf{W}(\\boldsymbol{\\theta}^\\star) \\mathbf{J}(\\boldsymbol{\\theta}^\\star),\n$$\n其中 $\\mathbf{J}$ 是未加权模型 $\\epsilon_{\\mathrm{model}}(\\mathbf{q}_i;\\boldsymbol{\\theta})$ 关于参数的雅可比矩阵，在最佳拟合参数 $\\boldsymbol{\\theta}^\\star$ 处求值，$\\mathbf{W}$ 是对角权重矩阵，其元素为 $1/\\sigma_{\\mathrm{eff}}^2$。将 $\\mathcal{I}^{-1}$ 对角线元素的平方根作为单标准差不确定度报告。\n\n测试套件。实现并求解以下三个测试用例。对于每个用例，使用提供的真实参数合成数据，然后通过您的程序估计参数。\n\n- 案例1（一维链，仅含最近邻）：\n  - 自旋 $S = 1$。\n  - 晶格间距 $a = 2.7$ 埃。\n  - 真实值：$J_1 = 3.2$ meV, $\\Delta = 0.35$ meV。\n  - 仪器分辨率：$\\sigma_q = 0.03$ 埃$^{-1}$，$\\sigma_\\omega = 0.12$ meV。\n  - 采样：波矢 $q$ 在 $[0.0, 1.0]$ 埃$^{-1}$ 区间内均匀采样，步长为 $0.05$ 埃$^{-1}$。\n  - 待拟合和报告的未知数：$J_1$ 和 $\\Delta$。\n- 案例2（一维链，含次近邻）：\n  - 自旋 $S = 1$。\n  - 晶格间距 $a = 3.0$ 埃。\n  - 真实值：$J_1 = 2.8$ meV, $J_2 = 0.6$ meV, $\\Delta = 0.20$ meV。\n  - 仪器分辨率：$\\sigma_q = 0.02$ 埃$^{-1}$，$\\sigma_\\omega = 0.08$ meV。\n  - 采样：波矢 $q$ 在 $[0.0, 0.9]$ 埃$^{-1}$ 区间内均匀采样，步长为 $0.03$ 埃$^{-1}$。\n  - 待拟合和报告的未知数：$J_1$、$J_2$ 和 $\\Delta$。\n- 案例3（二维方格子沿 $\\Gamma$–$X$ 方向，仅含最近邻）：\n  - 自旋 $S = 1$。\n  - 晶格间距 $a = 3.1$ 埃。\n  - 真实值：$J_1 = 5.0$ meV, $\\Delta = 0.40$ meV。\n  - 仪器分辨率：$\\sigma_q = 0.04$ 埃$^{-1}$，$\\sigma_\\omega = 0.15$ meV。\n  - 采样：波矢沿 $\\Gamma$–$X$ 路径，其中 $q_x$ 在 $[0.0, 0.8]$ 埃$^{-1}$ 区间内均匀采样，步长为 $0.04$ 埃$^{-1}$，且 $q_y = 0$。\n  - 待拟合和报告的未知数：$J_1$ 和 $\\Delta$。\n\n角度约定和单位：\n- 始终使用以弧度为单位的 $qa$ 计算三角函数。\n- 所有交换常数 $J_1$、$J_2$ 和能隙 $\\Delta$ 均以 meV 为单位。\n- 动量 $q$ 以 埃$^{-1}$ 为单位。\n- 仪器分辨率 $\\sigma_q$ 和 $\\sigma_\\omega$ 分别以 埃$^{-1}$ 和 meV 为单位。\n\n最终输出格式：\n- 对于案例1，输出列表 $[J_1,\\Delta,\\sigma_{J_1},\\sigma_{\\Delta}]$。\n- 对于案例2，输出列表 $[J_1,J_2,\\Delta,\\sigma_{J_1},\\sigma_{J_2},\\sigma_{\\Delta}]$。\n- 对于案例3，输出列表 $[J_1,\\Delta,\\sigma_{J_1},\\sigma_{\\Delta}]$。\n- 您的程序应生成单行输出，其中包含一个由三个案例专属列表构成的列表。所有数字四舍五入到三位小数，形式为用方括号括起来的逗号分隔列表。例如：\n  - \"[[case1_vals],[case2_vals],[case3_vals]]\"\n- 不应打印任何额外文本。\n\n您的实现必须是确定性的，且不得使用任何外部输入。不要向合成数据中添加随机噪声；仅通过指定的有效宽度来引入仪器分辨率。对所有三角函数参数使用弧度，并以 meV 为单位报告所有能量，四舍五入到三位小数。", "solution": "用户提供了一个问题，要求为量子海森堡铁磁体的物理参数开发一个基于物理原理的估计器。这涉及到推导理论模型，基于这些模型合成数据，并实现一个统计上可靠的拟合程序来恢复参数及其不确定度。该问题已经过验证，被认为是科学上可靠、适定且完整的。\n\n### 第一部分：理论模型推导\n\n分析始于包含单轴各向异性项的海森堡哈密顿量：\n$$\n\\hat{H} = -\\sum_{\\langle i,j \\rangle} J_{ij}\\,\\hat{\\mathbf{S}}_i\\cdot \\hat{\\mathbf{S}}_j - K\\sum_i \\left(\\hat{S}_i^z\\right)^2\n$$\n在线性自旋波近似的框架内，可以推导出布拉菲晶格的磁振子色散关系 $\\epsilon_{\\mathbf{q}}$。通过 Holstein-Primakoff 变换并保留玻色子算符的二次项，得到的标准结果是：\n$$\n\\epsilon_{\\mathbf{q}} = \\Delta + 2S \\left[ J(\\mathbf{0}) - J(\\mathbf{q}) \\right]\n$$\n这里，$J(\\mathbf{q}) = \\sum_{\\mathbf{R}} J_{\\mathbf{R}} e^{i\\mathbf{q}\\cdot\\mathbf{R}}$ 是交换相互作用 $J_{ij} = J(\\mathbf{R}_i - \\mathbf{R}_j)$ 的傅里叶变换。项 $\\Delta$ 是在 $\\mathbf{q}=\\mathbf{0}$ 处的能隙，它源于破坏对称性的各向异性项。根据问题陈述，我们将 $\\Delta$ 视为一个唯象的附加参数。求和 $\\sum_{\\mathbf{R}}$ 遍历连接相互作用自旋的所有晶格矢量 $\\mathbf{R}$。对于一个相互作用达到特定范围的模型，并考虑到在哈密顿量求和 $\\sum_{\\langle i,j \\rangle}$ 中每对自旋只计算一次，表达式变为：\n$$\n\\epsilon_{\\mathbf{q}} = \\Delta + \\sum_{\\mathbf{R} > 0} 2 z_{\\mathbf{R}} J_{\\mathbf{R}} S \\left(1 - \\cos(\\mathbf{q}\\cdot\\mathbf{R})\\right)\n$$\n其中 $z_{\\mathbf{R}}$ 是位于矢量 $\\mathbf{R}$ 处的邻居数量。从傅里叶变换得到的更直接形式是：对于一维链，$J(\\mathbf{q}) = \\sum_{R>0} 2 J_R \\cos(qR)$，且 $J(\\mathbf{0}) = \\sum_{R>0} 2 J_R$。因此，$\\epsilon_q = \\Delta + 2S [J(0) - J(q)] = \\Delta + 2S \\sum_{R>0} 2 J_R (1-\\cos(qR)) = \\Delta + 4S \\sum_{R>0} J_R(1-\\cos(qR))$。\n\n基于这些原理，我们推导测试用例所需的具体色散关系及其斜率。\n\n**案例1和3：一维链及二维方格子（$\\Gamma-X$方向）的最近邻（NN）相互作用**\n对于晶格间距为 $a$ 且具有最近邻交换 $J_1$ 的一维链，到邻居的矢量是 $R=a$。对于沿 $\\Gamma-X$ 路径（$q_y=0, q_x=q$）的二维方格子，一般色散 $\\epsilon_{\\mathbf{q}} = \\Delta + 4SJ_1(2 - \\cos(q_x a) - \\cos(q_y a))$ 简化为 $\\epsilon_q = \\Delta + 4SJ_1(2 - \\cos(qa) - \\cos(0)) = \\Delta + 4SJ_1(1-\\cos(qa))$。有趣的是，对于最近邻相互作用，两个系统沿指定路径的色散具有相同的函数形式。给定自旋 $S=1$，模型为：\n$$\n\\epsilon(q; J_1, \\Delta) = \\Delta + 4 J_1 (1 - \\cos(qa))\n$$\n为计算有效分辨率所需的关于波矢 $q$ 的导数是：\n$$\n\\frac{\\partial\\epsilon}{\\partial q} = 4 J_1 a \\sin(qa)\n$$\n\n**案例2：具有次近邻（NNN）相互作用的一维链**\n该模型包括最近邻交换 $J_1$（在距离 $a$ 处）和次近邻交换 $J_2$（在距离 $2a$ 处）。对于 $S=1$：\n$$\n\\epsilon(q; J_1, J_2, \\Delta) = \\Delta + 4 J_1 (1 - \\cos(qa)) + 4 J_2 (1 - \\cos(2qa))\n$$\n相应的色散斜率为：\n$$\n\\frac{\\partial\\epsilon}{\\partial q} = 4 J_1 a \\sin(qa) + 8 J_2 a \\sin(2qa)\n$$\n\n### 第二部分：参数估计与不确定度量化\n\n估计过程基于加权非线性最小二乘法。我们的目标是找到使卡方函数最小化的参数 $\\boldsymbol{\\theta}$：\n$$\n\\chi^2(\\boldsymbol{\\theta}) = \\sum_i \\frac{\\left[ \\epsilon_i - \\epsilon_{\\mathrm{model}}(\\mathbf{q}_i;\\boldsymbol{\\theta}) \\right]^2}{\\sigma_{\\mathrm{eff}}(\\mathbf{q}_i;\\boldsymbol{\\theta})^2}\n$$\n数据点 $\\{\\epsilon_i\\}$ 是使用无附加噪声的真实参数合成的：$\\epsilon_i = \\epsilon_{\\mathrm{model}}(\\mathbf{q}_i; \\boldsymbol{\\theta}_{\\text{true}})$。统计权重由有效能量方差 $\\sigma_{\\mathrm{eff}}^2$ 导出。\n\n由于权重 $w_i = 1/\\sigma_{\\mathrm{eff}}^2$ 通过色散斜率 $\\partial\\epsilon/\\partial q$ 依赖于模型参数 $\\boldsymbol{\\theta}$，因此采用迭代重加权最小二乘法（IRLS）程序。\n\n1.  **初始化**：从参数的初始猜测值 $\\boldsymbol{\\theta}_0$ 开始。\n2.  **迭代**：对于步骤 $k=0, 1, 2, \\dots$：\n    a.  对每个动量点计算色散斜率 $\\frac{\\partial\\epsilon}{\\partial q}(\\mathbf{q}_i; \\boldsymbol{\\theta}_k)$。\n    b.  计算有效标准差 $\\sigma_{\\mathrm{eff}}(\\mathbf{q}_i; \\boldsymbol{\\theta}_k) = \\sqrt{\\sigma_\\omega^2 + \\left(\\frac{\\partial\\epsilon}{\\partial q}\\right)^2 \\sigma_q^2}$。\n    c.  使用权重 $w_i = 1/\\sigma_{\\mathrm{eff}}^2(\\mathbf{q}_i; \\boldsymbol{\\theta}_k)$ 求解 $\\boldsymbol{\\theta}_{k+1}$ 的加权最小二乘问题。这可以通过使用 `scipy.optimize.curve_fit` 实现。\n3.  **收敛**：当参数估计值收敛时，即 $\\|\\boldsymbol{\\theta}_{k+1} - \\boldsymbol{\\theta}_k\\|$ 小于一个小的容差时，循环终止。\n\n收敛到最佳拟合参数 $\\boldsymbol{\\theta}^\\star$ 后，估计参数不确定度。当 `curve_fit` 函数与 `absolute_sigma=True` 配合使用时，它返回协方差矩阵 $\\mathbf{C} = \\mathcal{I}^{-1}$，其中 $\\mathcal{I}$ 是费雪信息矩阵：\n$$\n\\mathcal{I}_{jk} = \\sum_i \\frac{1}{\\sigma_{\\mathrm{eff}}(\\mathbf{q}_i; \\boldsymbol{\\theta}^\\star)^2} \\frac{\\partial\\epsilon_{\\mathrm{model}}(\\mathbf{q}_i)}{\\partial\\theta_j} \\frac{\\partial\\epsilon_{\\mathrm{model}}(\\mathbf{q}_i)}{\\partial\\theta_k}\n$$\n参数 $\\theta_j$ 的单标准差不确定度由 $\\sigma_j = \\sqrt{C_{jj}} = \\sqrt{(\\mathcal{I}^{-1})_{jj}}$ 给出。\n\n### 第三部分：测试用例的实现\n\n构建一个 Python 程序来实现针对三个指定测试用例的完整工作流程。\n\n-   一个通用的求解器函数封装了 IRLS 过程和不确定度计算。\n-   具体的物理模型及其导数被定义为独立的函数。\n-   对于每个案例，将适当的模型、真实参数以及仪器/采样参数提供给求解器。\n-   拟合程序中所有参数的初始猜测值均设为 $1.0$。由于合成数据是无噪声的，拟合预计会精确收敛到真实值。计算中的非平凡部分在于确定不确定度。\n-   收集每个案例的最终结果，格式化为三位小数，并严格按照指定的输出格式打印为单行的列表之列表。\n-   该代码被设计为确定性的和自包含的，使用 `numpy` 进行数值运算，并使用 `scipy.optimize.curve_fit` 作为核心拟合算法。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\nfrom functools import partial\n\n# --- Part 1: Physical Models and Derivatives ---\n\n# For cases 1 and 3 (NN model on 1D chain or Gamma-X in 2D)\ndef model_nn(q, J1, Delta, S, a):\n    \"\"\"Magnon dispersion for NN model.\"\"\"\n    return Delta + 4 * S * J1 * (1 - np.cos(q * a))\n\ndef slope_nn(q, J1, Delta, S, a):\n    \"\"\"Dispersion slope for NN model. Delta is a dummy arg for signature matching.\"\"\"\n    return 4 * S * J1 * a * np.sin(q * a)\n\n# For case 2 (NNN model on 1D chain)\ndef model_nnn(q, J1, J2, Delta, S, a):\n    \"\"\"Magnon dispersion for NNN model.\"\"\"\n    return Delta + 4 * S * J1 * (1 - np.cos(q * a)) + 4 * S * J2 * (1 - np.cos(2 * q * a))\n\ndef slope_nnn(q, J1, J2, Delta, S, a):\n    \"\"\"Dispersion slope for NNN model. Delta is a dummy arg for signature matching.\"\"\"\n    return 4 * S * J1 * a * np.sin(q * a) + 8 * S * J2 * a * np.sin(2 * q * a)\n\n# --- Part 2: Parameter Estimation ---\n\ndef estimate_parameters(q_data, model_func, slope_func, true_params, sigma_q, sigma_omega, p0):\n    \"\"\"\n    Synthesizes data and fits parameters using Iteratively Reweighted Least Squares.\n    \n    Args:\n        q_data (np.array): Array of wavevectors.\n        model_func (callable): The dispersion model function f(q, *params).\n        slope_func (callable): The dispersion slope function df/dq(q, *params).\n        true_params (list): Ground-truth parameters for data synthesis.\n        sigma_q (float): Momentum resolution.\n        sigma_omega (float): Energy resolution.\n        p0 (list): Initial guess for parameters.\n\n    Returns:\n        tuple: (best_fit_params, uncertainties)\n    \"\"\"\n    # Synthesize \"measured\" data using ground-truth parameters (no noise)\n    epsilon_data = model_func(q_data, *true_params)\n    \n    p_k = np.array(p0, dtype=float)\n    \n    # Iteratively Reweighted Least Squares (IRLS) loop\n    for _ in range(15):  # 15 iterations is more than sufficient for convergence\n        p_prev = p_k.copy()\n        \n        # Calculate weights based on current parameter estimates\n        slope_k = slope_func(q_data, *p_k)\n        sigma_eff_k = np.sqrt(sigma_omega**2 + (slope_k**2) * sigma_q**2)\n        # Prevent division by zero if sigma_eff is ever zero.\n        sigma_eff_k[sigma_eff_k < 1e-12] = 1e-12\n        \n        # Perform weighted non-linear least squares fit\n        try:\n            popt, _ = curve_fit(model_func, q_data, epsilon_data, p0=p_k, sigma=sigma_eff_k, absolute_sigma=True)\n            p_k = popt\n        except RuntimeError:\n            # Fit failed, break with last good parameters\n            p_k = p_prev  # Revert to previous\n            break\n\n        # Check for convergence\n        if np.allclose(p_k, p_prev, rtol=1e-9, atol=1e-9):\n            break\n            \n    # Final fit at converged parameters to get the covariance matrix\n    p_final = p_k\n    slope_final = slope_func(q_data, *p_final)\n    sigma_eff_final = np.sqrt(sigma_omega**2 + (slope_final**2) * sigma_q**2)\n    sigma_eff_final[sigma_eff_final < 1e-12] = 1e-12\n\n    popt, pcov = curve_fit(model_func, q_data, epsilon_data, p0=p_final, sigma=sigma_eff_final, absolute_sigma=True)\n    \n    # Uncertainties are the sqrt of the diagonal of the covariance matrix\n    perr = np.sqrt(np.diag(pcov))\n    \n    return popt, perr\n\ndef solve():\n    \"\"\"\n    Main function to solve the specified test cases and print the results.\n    \"\"\"\n    # --- Part 3: Test Suite ---\n    \n    # Case 1: 1D chain, NN\n    case1 = {\n        'S': 1.0, 'a': 2.7,\n        'true_params': [3.2, 0.35],  # [J1, Delta]\n        'p0': [1.0, 1.0],\n        'sigma_q': 0.03, 'sigma_omega': 0.12,\n        'q_range': (0.0, 1.0, 21), # start, stop, num_points\n        'model': model_nn, 'slope': slope_nn,\n        'num_params': 2\n    }\n\n    # Case 2: 1D chain, NNN\n    case2 = {\n        'S': 1.0, 'a': 3.0,\n        'true_params': [2.8, 0.6, 0.20],  # [J1, J2, Delta]\n        'p0': [1.0, 1.0, 1.0],\n        'sigma_q': 0.02, 'sigma_omega': 0.08,\n        'q_range': (0.0, 0.9, 31),\n        'model': model_nnn, 'slope': slope_nnn,\n        'num_params': 3\n    }\n    \n    # Case 3: 2D square lattice, NN, Gamma-X\n    case3 = {\n        'S': 1.0, 'a': 3.1,\n        'true_params': [5.0, 0.40], # [J1, Delta]\n        'p0': [1.0, 1.0],\n        'sigma_q': 0.04, 'sigma_omega': 0.15,\n        'q_range': (0.0, 0.8, 21),\n        'model': model_nn, 'slope': slope_nn,\n        'num_params': 2\n    }\n\n    test_cases = [case1, case2, case3]\n    all_results = []\n\n    for case in test_cases:\n        # Generate q-vector\n        q_start, q_stop, q_num = case['q_range']\n        q_data = np.linspace(q_start, q_stop, q_num)\n\n        # Create model and slope functions with fixed S and a\n        model = partial(case['model'], S=case['S'], a=case['a'])\n        slope = partial(case['slope'], S=case['S'], a=case['a'])\n        \n        # Estimate parameters and uncertainties\n        popt, perr = estimate_parameters(\n            q_data, model, slope,\n            case['true_params'], case['sigma_q'], case['sigma_omega'], case['p0']\n        )\n        \n        # Format results as [param1, param2, ..., err1, err2, ...]\n        result_list = list(popt) + list(perr)\n        all_results.append(result_list)\n\n    # Final printing in the exact required format\n    formatted_case_results = []\n    for res_list in all_results:\n        formatted_vals = [f\"{val:.3f}\" for val in res_list]\n        formatted_case_results.append(f\"[{','.join(formatted_vals)}]\")\n    \n    print(f\"[{','.join(formatted_case_results)}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3017112"}]}