{"hands_on_practices": [{"introduction": "有效质量的概念是理解固体中电荷输运的基石。这个练习将指导你从半经典运动方程出发，推导出有效质量的表达式，从而为你打下坚实的基础。通过这个过程，你将揭示能带的曲率如何决定电子的惯性响应，并引出电子和空穴行为之间的关键区别 [@problem_id:2984205]。", "problem": "考虑一个一维（1D）近邻紧束缚能带，其晶体动量为 $k$，晶格常数 $a>0$，能量色散关系为 $E(k)=-2t\\cos(ka)$，其中跃迁参数 $t>0$。从 Bloch 电子的半经典动力学出发，并且只使用基本关系，即群速度 $v(k)=\\frac{1}{\\hbar}\\frac{dE}{dk}$ 和在空间均匀外力 $F$ 作用下晶体动量的运动方程 $\\hbar\\,\\frac{dk}{dt}=F$，通过能带中的 Newton 第二定律将 $F$ 与其加速度 $a=\\frac{dv}{dt}$ 联系起来，推导一个固定 $k$ 附近的波包的有效惯性响应，并由此获得有效质量 $m^{*}(k)$ 的解析表达式。计算在布里渊区中心 $k=0$ 和布里渊区边界 $k=\\pi/a$ 处的 $m^{*}$。然后，用文字解释这两个结果在符号和大小上的差异，并用类电子响应和类空穴响应进行说明。将你最终的 $m^{*}(0)$ 和 $m^{*}(\\pi/a)$ 答案用 $\\hbar$、$t$ 和 $a$ 以符号形式表示，并按 $\\big(m^{*}(0),\\,m^{*}(\\pi/a)\\big)$ 的顺序呈现在一个单行矩阵中。不需要进行数值计算。", "solution": "本题要求推导一维紧束缚能带的有效质量 $m^{*}(k)$，计算其在布里渊区中心和边界处的值，并对结果进行物理解释。推导将从给定的 Bloch 电子的半经典运动方程出发。\n\n波包的加速度 $a$ 是其群速度 $v$ 的时间导数，而群速度 $v$ 是晶体动量 $k$ 的函数。由于外力 $F$ 导致 $k$ 随时间变化，我们必须应用链式法则：\n$$a = \\frac{dv}{dt} = \\frac{dv(k)}{dk} \\frac{dk}{dt}$$\n题目给出了两个基本关系：\n1. 群速度：$v(k) = \\frac{1}{\\hbar} \\frac{dE}{dk}$\n2. 晶体动量的运动方程：$\\hbar \\frac{dk}{dt} = F$，这意味着 $\\frac{dk}{dt} = \\frac{F}{\\hbar}$。\n\n首先，让我们通过对群速度表达式关于 $k$ 求导来求出 $\\frac{dv(k)}{dk}$ 项的表达式：\n$$\\frac{dv(k)}{dk} = \\frac{d}{dk} \\left( \\frac{1}{\\hbar} \\frac{dE}{dk} \\right) = \\frac{1}{\\hbar} \\frac{d^2E}{dk^2}$$\n现在，我们将此式以及 $\\frac{dk}{dt}$ 的表达式代入加速度方程中：\n$$a = \\left( \\frac{1}{\\hbar} \\frac{d^2E}{dk^2} \\right) \\left( \\frac{F}{\\hbar} \\right) = \\left( \\frac{1}{\\hbar^2} \\frac{d^2E}{dk^2} \\right) F$$\n此方程将波包的加速度 $a$ 与外力 $F$ 联系起来。为定义有效惯性质量 $m^*(k)$，我们将此结果与 Newton 第二定律 $F = m a$（等效地，$a = \\frac{1}{m} F$）进行比较。通过直接比较，我们确定有效质量的倒数为：\n$$\\frac{1}{m^*(k)} = \\frac{1}{\\hbar^2} \\frac{d^2E}{dk^2}$$\n将此表达式取倒数，得到一维有效质量的通用公式：\n$$m^*(k) = \\hbar^2 \\left( \\frac{d^2E}{dk^2} \\right)^{-1}$$\n这个结果证实了有效质量与能带 $E(k)$ 的曲率成反比。\n\n接下来，我们将此公式应用于给定的紧束缚色散关系 $E(k) = -2t \\cos(ka)$，其中 $t>0$ 且 $a>0$。我们需要计算 $E(k)$ 对 $k$ 的二阶导数。\n一阶导数为：\n$$\\frac{dE}{dk} = \\frac{d}{dk}(-2t \\cos(ka)) = -2t (-\\sin(ka) \\cdot a) = 2ta \\sin(ka)$$\n二阶导数为：\n$$\\frac{d^2E}{dk^2} = \\frac{d}{dk}(2ta \\sin(ka)) = 2ta (\\cos(ka) \\cdot a) = 2ta^2 \\cos(ka)$$\n将这个二阶导数代入我们关于 $m^*(k)$ 的表达式中，我们得到该特定能带的有效质量：\n$$m^*(k) = \\frac{\\hbar^2}{2ta^2 \\cos(ka)}$$\n现在，我们在第一布里渊区的两个指定点上计算该表达式的值。\n\n1.  在布里渊区中心，$k=0$ 处：\n    有效质量为：\n    $$m^*(0) = \\frac{\\hbar^2}{2ta^2 \\cos(0)} = \\frac{\\hbar^2}{2ta^2}$$\n    由于 $t>0$，$a>0$ 且 $\\hbar^2 > 0$，有效质量 $m^*(0)$ 为正。\n\n2.  在布里渊区边界，$k=\\pi/a$ 处：\n    有效质量为：\n    $$m^*(\\pi/a) = \\frac{\\hbar^2}{2ta^2 \\cos\\left(\\frac{\\pi}{a} a\\right)} = \\frac{\\hbar^2}{2ta^2 \\cos(\\pi)} = \\frac{\\hbar^2}{2ta^2(-1)} = -\\frac{\\hbar^2}{2ta^2}$$\n    有效质量 $m^*(\\pi/a)$ 为负，且其大小与 $m^*(0)$ 相等。\n\n这些结果的物理解释如下。有效质量将粒子的加速度与外力联系起来。正的有效质量，如此处在能带底（$k=0$，$E(0)=-2t$ 为能量最小值）所发现的，表示粒子沿外力施加的相同方向加速。这是我们期望从像电子这样的粒子获得的常规响应，因此这被描述为“类电子”响应。$m^*(0)$ 的正值是能带在其最小值处具有正曲率（$\\frac{d^2E}{dk^2} > 0$）的直接结果。\n\n相反，负的有效质量，如此处在能带顶（$k=\\pi/a$，$E(\\pi/a)=+2t$ 为能量最大值）所发现的，表示粒子沿与外力相反的方向加速。这种反直觉的行为是近满带中载流子的特征。在能带顶附近缺少一个电子（一个空穴）的行为如同一个带正电荷和正质量的粒子。位于能带顶部的电子，具有负有效质量 $m^*0$，对电场 $E_{field}$（以及力 $F=-eE_{field}$）的响应是逆着力的方向加速。这样一个电子的运动等效于一个带正电荷 $+e$ 和正质量 $|m^*|$ 的空穴在相同电场下的运动。因此，能带顶部的响应被描述为“类空穴”的。$m^*(\\pi/a)$ 的负值源于能带在其最大值处的负曲率（$\\frac{d^2E}{dk^2}  0$）。两者大小相等是因为简单的余弦函数在其最小值和最大值处的曲率大小相等。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\hbar^2}{2ta^2}  -\\frac{\\hbar^2}{2ta^2}\n\\end{pmatrix}\n}\n$$", "id": "2984205"}, {"introduction": "虽然抛物线能带近似在许多情况下是有效的，但真实的半导体，特别是窄带隙材料，通常表现出显著的非抛物线性。本实践将探讨这种更真实的能带结构所带来的影响，要求你推导修正后的态密度（DOS）。通过解决这个问题，你将理解能带结构的细节如何直接影响宏观物理量，例如对器件建模至关重要的有效态密度 [@problem_id:2984219]。", "problem": "一种直接带隙的窄带隙半导体，其导带底位于布里渊区中心附近，此处的色散关系偏离简单的抛物线形式，可以很好地用 Kane 模型描述：\n$$E\\left(1+\\alpha E\\right)=\\frac{\\hbar^{2}k^{2}}{2m_{c}^{\\ast}},$$\n其中，$E \\ge 0$ 是从导带底向上测量的载流子能量，$k$ 是波矢大小，$m_{c}^{\\ast}$ 是导带底有效质量，$\\alpha$ 是 Kane 非抛物性参数。假设只有一个导带谷 ($g_{v}=1$) 且自旋简并度为 $g_{s}=2$。在三维空间中进行计算。\n\n从 $k$ 空间中态计数的第一性原理出发，并且仅使用上述色散关系和态密度 (DOS) 的定义，完成以下任务：\n\n1) 推导单位体积内的导带态密度 $g_{c}(E)$，精确到 $\\alpha$ 的一阶（即仅保留到 $\\mathcal{O}(\\alpha)$ 的项），并表示为对抛物线能带结果的一个修正。清楚地说明非抛物性如何改变其对能量的依赖关系。\n\n2) 在非简并极限下，电子浓度可以写为 $n = N_{c}(T) \\exp\\!\\left[-(E_{c}-E_{F})/(k_{B}T)\\right]$，其中 $N_{c}(T)$ 是导带有效态密度，$E_{c}$ 是导带底能量，$E_{F}$ 是费米能级，$k_{B}$ 是玻尔兹曼常数。使用第 (1) 部分的结果，计算精确到 $\\alpha$ 一阶的 $N_{c}(T)$，给出一个封闭形式的解析表达式，并假设 $|\\alpha| k_{B}T \\ll 1$。\n\n3) 当 $T=300\\ \\mathrm{K}$ 时，使用参数 $m_{c}^{\\ast}=0.020\\,m_{0}$（其中 $m_{0}$ 为自由电子质量）、$g_{v}=1$ 和 $\\alpha=2.0\\ \\mathrm{eV}^{-1}$，数值计算 $N_{c}(T)$。使用 $h=6.62607015\\times 10^{-34}\\ \\mathrm{J\\,s}$、$\\hbar=h/(2\\pi)$、$k_{B}=1.380649\\times 10^{-23}\\ \\mathrm{J\\,K}^{-1}$ 和 $m_{0}=9.1093837015\\times 10^{-31}\\ \\mathrm{kg}$。进行单位转换，使最终的 $N_{c}(T)$ 以 $\\mathrm{cm}^{-3}$ 为单位表示。将您的答案四舍五入到三位有效数字。\n\n您的最终答案必须是 $N_{c}(300\\ \\mathrm{K})$ 的单一数值（以 $\\mathrm{cm}^{-3}$ 为单位），并四舍五入。", "solution": "用户要求我解决一个关于具有非抛物线导带的半导体中态密度的多部分问题。\n\n### 第 1 步：问题验证\n\n#### 提取的已知条件\n-   **色散关系：** $E\\left(1+\\alpha E\\right)=\\frac{\\hbar^{2}k^{2}}{2m_{c}^{\\ast}}$，对于从导带底测量的能量 $E \\ge 0$。\n-   **变量：** $E$ (载流子能量)，$k$ (波矢大小)。\n-   **常量：** $m_{c}^{\\ast}$ (导带底有效质量)，$\\alpha$ (Kane 非抛物性参数)。\n-   **简并度：** 能谷简并度 $g_{v}=1$，自旋简并度 $g_{s}=2$。\n-   **维度：** 三维 ($3$D)。\n-   **任务 1：** 推导单位体积内的导带态密度 $g_{c}(E)$，精确到 $\\alpha$ 的一阶，即 $\\mathcal{O}(\\alpha)$。\n-   **任务 2：** 对于非简并极限 $n = N_{c}(T) \\exp\\!\\left[-(E_{c}-E_{F})/(k_{B}T)\\right]$，计算精确到 $\\alpha$ 一阶的导带有效态密度 $N_{c}(T)$，假设 $|\\alpha| k_{B}T \\ll 1$。\n-   **任务 3：** 在 $T=300\\ \\mathrm{K}$ 时使用以下参数数值计算 $N_{c}(T)$：\n    -   $m_{c}^{\\ast}=0.020\\,m_{0}$\n    -   $\\alpha=2.0\\ \\mathrm{eV}^{-1}$\n    -   $h=6.62607015\\times 10^{-34}\\ \\mathrm{J\\,s}$\n    -   $\\hbar=h/(2\\pi)$\n    -   $k_{B}=1.380649\\times 10^{-23}\\ \\mathrm{J\\,K}^{-1}$\n    -   $m_{0}=9.1093837015\\times 10^{-31}\\ \\mathrm{kg}$\n-   **最终答案格式：** $N_{c}(300\\ \\mathrm{K})$ 的单一数值，单位为 $\\mathrm{cm}^{-3}$，四舍五入到三位有效数字。\n\n#### 使用提取的已知条件进行验证\n-   **科学依据：** 该问题在科学上是合理的。Kane 模型是描述窄带隙半导体中非抛物线色散关系的一个标准且成熟的近似方法。态密度 (DOS)、有效态密度以及非简并极限下的麦克斯韦-玻尔兹曼近似等概念是凝聚态物理和半导体物理学的基本原理。\n-   **适定性：** 该问题是适定的。它提供了所有必要的信息和常数，可以按逻辑顺序进行推导和计算。任务定义明确，约束条件（例如，对 $\\alpha$ 的一阶近似）也已明确说明。存在唯一且有意义的解。\n-   **客观性：** 问题陈述使用精确、客观和定量的语言，没有任何主观或模棱两可的术语。\n\n#### 结论\n该问题是有效的，因为它具有科学依据、适定、客观，并且没有验证清单中列出的缺陷。我将继续进行解答。\n\n### 第 2 步：解答\n\n#### 1) 态密度 $g_{c}(E)$ 的推导\n单位能量、单位体积内的态密度 $g_c(E)$ 是从 $k$ 空间中的态数量推导出来的。对于一个 3D 系统，在 $k$ 空间中体积为 $4\\pi k^2 dk$ 的球壳内的态数 $dN$ 由下式给出：\n$$dN = g_v g_s V \\frac{4\\pi k^2 dk}{(2\\pi)^3}$$\n其中 $V$ 是晶体的体积。态密度则为\n$$g_c(E) = \\frac{1}{V} \\frac{dN}{dE} = \\frac{g_v g_s}{2\\pi^2} k^2 \\frac{dk}{dE}$$\n我们使用给定的 Kane 色散关系来找到 $k^2$ 和 $dk/dE$ 关于能量 $E$ 的表达式。\n$$E(1+\\alpha E)=\\frac{\\hbar^{2}k^{2}}{2m_{c}^{\\ast}}$$\n由此，我们将 $k^2$ 表示为 $E$ 的函数：\n$$k^2(E) = \\frac{2m_c^*}{\\hbar^2} (E + \\alpha E^2)$$\n为了求 $dk/dE$，我们首先对 $k^2$ 关于 $E$ 求导：\n$$2k \\frac{dk}{dE} = \\frac{d(k^2)}{dE} = \\frac{2m_c^*}{\\hbar^2} (1 + 2\\alpha E)$$\n$$\\implies \\frac{dk}{dE} = \\frac{m_c^*}{\\hbar^2 k} (1 + 2\\alpha E)$$\n现在，将 $k^2$ 和 $dk/dE$ 的表达式代入 $g_c(E)$ 的公式中：\n$$g_c(E) = \\frac{g_v g_s}{2\\pi^2} \\left( \\frac{2m_c^*}{\\hbar^2} (E + \\alpha E^2) \\right) \\left( \\frac{m_c^*}{\\hbar^2 k} (1 + 2\\alpha E) \\right)$$\n使用 $k(E) = \\frac{\\sqrt{2m_c^*}}{\\hbar} \\sqrt{E(1+\\alpha E)}$，我们简化得到：\n$$g_c(E) = \\frac{g_v g_s}{2\\pi^2} \\frac{2m_c^* E(1+\\alpha E)}{\\hbar^2} \\frac{m_c^*(1+2\\alpha E)}{\\hbar^2} \\frac{\\hbar}{\\sqrt{2m_c^* E(1+\\alpha E)}}$$\n$$g_c(E) = \\frac{g_v g_s (2m_c^*)^{3/2}}{4\\pi^2 \\hbar^3} \\sqrt{E(1+\\alpha E)} (1+2\\alpha E)$$\n这是 Kane 模型的精确态密度。问题要求结果精确到 $\\alpha$ 的一阶。我们展开包含 $\\alpha E$ 的项，假设 $|\\alpha E| \\ll 1$：\n$$\\sqrt{1+\\alpha E} \\approx 1 + \\frac{1}{2}\\alpha E + \\mathcal{O}(\\alpha^2 E^2)$$\n将此代入 $g_c(E)$ 的表达式中：\n$$g_c(E) \\approx \\frac{g_v g_s (2m_c^*)^{3/2}}{4\\pi^2 \\hbar^3} \\sqrt{E} \\left(1 + \\frac{1}{2}\\alpha E\\right) (1+2\\alpha E)$$\n展开乘积并保留到 $\\alpha$ 一阶的项：\n$$(1 + \\frac{1}{2}\\alpha E)(1+2\\alpha E) = 1 + 2\\alpha E + \\frac{1}{2}\\alpha E + \\alpha^2 E^2 \\approx 1 + \\frac{5}{2}\\alpha E$$\n所以，精确到 $\\alpha$ 一阶的态密度为：\n$$g_c(E) \\approx \\frac{g_v g_s (2m_c^*)^{3/2}}{4\\pi^2 \\hbar^3} E^{1/2} \\left(1 + \\frac{5}{2}\\alpha E\\right)$$\n抛物线能带（$\\alpha=0$）的项是 $g_{c,0}(E) = \\frac{g_v g_s (2m_c^*)^{3/2}}{4\\pi^2 \\hbar^3} E^{1/2}$。因此，我们可以将结果写成一个修正形式：\n$$g_c(E) = g_{c,0}(E) \\left(1 + \\frac{5}{2}\\alpha E\\right)$$\n非抛物性引入了一个随能量增长的修正项，有效地在抛物线 DOS 的标准 $E^{1/2}$ 依赖关系上增加了一个 $E^{3/2}$ 的依赖关系。\n\n#### 2) 有效态密度 $N_c(T)$ 的推导\n电子浓度 $n$ 是通过对导带中所有能量的态密度和载流子分布函数的乘积进行积分得到的。能量 $E$ 是从导带底 $E_c=0$ 处开始测量的。\n$$n = \\int_{0}^{\\infty} g_c(E) f(E) dE$$\n在非简并极限下，费米-狄拉克分布 $f(E)$ 近似为麦克斯韦-玻尔兹曼分布：\n$$f(E) \\approx \\exp\\left(-\\frac{E - E_F}{k_B T}\\right) = \\exp\\left(\\frac{E_F}{k_B T}\\right) \\exp\\left(-\\frac{E}{k_B T}\\right)$$\n问题给出 $n = N_c(T) \\exp\\left[-(E_c-E_F)/(k_B T)\\right]$，对于 $E_c=0$，这等价于 $n = N_c(T) \\exp(E_F/k_B T)$。通过将其与 $n$ 的积分表达式进行比较，我们确定有效态密度 $N_c(T)$ 为：\n$$N_c(T) = \\int_{0}^{\\infty} g_c(E) \\exp\\left(-\\frac{E}{k_B T}\\right) dE$$\n代入 $g_c(E)$ 的一阶表达式：\n$$N_c(T) = \\int_{0}^{\\infty} g_{c,0}(E) \\left(1 + \\frac{5}{2}\\alpha E\\right) \\exp\\left(-\\frac{E}{k_B T}\\right) dE$$\n$$N_c(T) = \\int_{0}^{\\infty} g_{c,0}(E) \\exp\\left(-\\frac{E}{k_B T}\\right) dE + \\frac{5}{2}\\alpha \\int_{0}^{\\infty} E g_{c,0}(E) \\exp\\left(-\\frac{E}{k_B T}\\right) dE$$\n第一项是抛物线能带的有效态密度 $N_{c,0}(T)$。\n$$N_c(T) = N_{c,0}(T) + \\frac{5}{2}\\alpha \\int_{0}^{\\infty} \\frac{g_v g_s (2m_c^*)^{3/2}}{4\\pi^2 \\hbar^3} E^{3/2} \\exp\\left(-\\frac{E}{k_B T}\\right) dE$$\n我们使用包含伽马函数的标准积分形式，$\\int_0^\\infty x^z e^{-x} dx = \\Gamma(z+1)$。\n令 $x=E/(k_B T)$。积分为：\n$$\\int_0^\\infty E^{1/2} e^{-E/k_B T} dE = (k_B T)^{3/2} \\Gamma\\left(\\frac{3}{2}\\right) = (k_B T)^{3/2} \\frac{\\sqrt{\\pi}}{2}$$\n$$\\int_0^\\infty E^{3/2} e^{-E/k_B T} dE = (k_B T)^{5/2} \\Gamma\\left(\\frac{5}{2}\\right) = (k_B T)^{5/2} \\frac{3\\sqrt{\\pi}}{4}$$\n因此，我们可以用 $N_{c,0}(T)$ 来表示 $N_c(T)$：\n$$N_c(T) = N_{c,0}(T) \\left( 1 + \\frac{5}{2}\\alpha \\frac{\\int E^{3/2} \\dots}{\\int E^{1/2} \\dots} \\right) = N_{c,0}(T) \\left( 1 + \\frac{5}{2}\\alpha \\frac{(k_B T)^{5/2} \\Gamma(5/2)}{(k_B T)^{3/2} \\Gamma(3/2)} \\right)$$\n使用 $\\Gamma(5/2) / \\Gamma(3/2) = 3/2$：\n$$N_c(T) = N_{c,0}(T) \\left( 1 + \\frac{5}{2}\\alpha (k_B T) \\frac{3}{2} \\right) = N_{c,0}(T) \\left( 1 + \\frac{15}{4}\\alpha k_B T \\right)$$\n抛物线有效态密度的标准表达式是 $N_{c,0}(T) = g_s g_v \\left( \\frac{m_c^* k_B T}{2\\pi \\hbar^2} \\right)^{3/2}$。对于 $g_s=2$ 和 $g_v=1$，并使用 $\\hbar=h/(2\\pi)$，这变为：\n$$N_{c,0}(T) = 2 \\left( \\frac{m_c^* k_B T}{2\\pi (h/2\\pi)^2} \\right)^{3/2} = 2 \\left( \\frac{2\\pi m_c^* k_B T}{h^2} \\right)^{3/2}$$\n所以，$N_c(T)$ 的最终封闭形式表达式为：\n$$N_c(T) = 2 \\left( \\frac{2\\pi m_c^* k_B T}{h^2} \\right)^{3/2} \\left( 1 + \\frac{15}{4}\\alpha k_B T \\right)$$\n\n#### 3) $N_c(300\\ \\mathrm{K})$ 的数值计算\n我们使用上面推导出的表达式和给定的国际单位制（SI）参数进行计算。\n-   $T = 300\\ \\mathrm{K}$\n-   $m_c^* = 0.020 \\times (9.1093837 \\times 10^{-31}\\ \\mathrm{kg}) = 1.82187674 \\times 10^{-32}\\ \\mathrm{kg}$\n-   $k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$\n-   $h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J\\,s}$\n-   $\\alpha = 2.0\\ \\mathrm{eV}^{-1}$\n\n首先，计算无量纲修正项 $\\frac{15}{4}\\alpha k_B T$。我们需要将 $k_B T$ 的单位换算成 eV。\n$1\\ \\mathrm{eV} = 1.602176634 \\times 10^{-19}\\ \\mathrm{J}$.\n$k_B T = (1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}) \\times (300\\ \\mathrm{K}) = 4.141947 \\times 10^{-21}\\ \\mathrm{J}$.\n$k_B T (\\text{in eV}) = \\frac{4.141947 \\times 10^{-21}\\ \\mathrm{J}}{1.602176634 \\times 10^{-19}\\ \\mathrm{J/eV}} = 0.025852\\ \\mathrm{eV}$.\n修正因子为：\n$$1 + \\frac{15}{4}(2.0\\ \\mathrm{eV}^{-1})(0.025852\\ \\mathrm{eV}) = 1 + 7.5 \\times 0.025852 = 1 + 0.19389 = 1.19389$$\n接下来，计算抛物线项 $N_{c,0}(T)$，其单位将是 $\\mathrm{m^{-3}}$。\n$$N_{c,0}(T) = 2 \\left( \\frac{2\\pi m_c^* k_B T}{h^2} \\right)^{3/2}$$\n括号内的参数为：\n$$\\frac{2\\pi (1.82187674 \\times 10^{-32}\\ \\mathrm{kg}) (4.141947 \\times 10^{-21}\\ \\mathrm{J})}{(6.62607015 \\times 10^{-34}\\ \\mathrm{J\\,s})^2} = \\frac{4.73543 \\times 10^{-52}\\ \\mathrm{kg \\cdot J}}{4.39047 \\times 10^{-67}\\ \\mathrm{J^2 s^2}} = 1.07857 \\times 10^{15}\\ \\mathrm{m^{-2}}$$\n将其取 $3/2$ 次方：\n$$(1.07857 \\times 10^{15})^{3/2} = (1.07857)^{1.5} \\times 10^{22.5} = 1.11945 \\times \\sqrt{10} \\times 10^{22} = 3.5398 \\times 10^{22}\\ \\mathrm{m^{-3}}$$\n$$N_{c,0}(300\\ \\mathrm{K}) = 2 \\times (3.5398 \\times 10^{22}\\ \\mathrm{m^{-3}}) = 7.0796 \\times 10^{22}\\ \\mathrm{m^{-3}}$$\n现在，应用非抛物性修正：\n$$N_c(300\\ \\mathrm{K}) = N_{c,0}(300\\ \\mathrm{K}) \\times 1.19389 = (7.0796 \\times 10^{22}\\ \\mathrm{m^{-3}}) \\times 1.19389 = 8.4522 \\times 10^{22}\\ \\mathrm{m^{-3}}$$\n最后，将结果转换为 $\\mathrm{cm^{-3}}$。因为 $1\\ \\mathrm{m} = 100\\ \\mathrm{cm}$，所以 $1\\ \\mathrm{m^3} = 10^6\\ \\mathrm{cm^3}$，即 $1\\ \\mathrm{m^{-3}} = 10^{-6}\\ \\mathrm{cm^{-3}}$。\n$$N_c(300\\ \\mathrm{K}) = (8.4522 \\times 10^{22}) \\times 10^{-6}\\ \\mathrm{cm^{-3}} = 8.4522 \\times 10^{16}\\ \\mathrm{cm^{-3}}$$\n四舍五入到三位有效数字，得到 $8.45 \\times 10^{16}\\ \\mathrm{cm^{-3}}$。", "answer": "$$\\boxed{8.45 \\times 10^{16}}$$", "id": "2984219"}, {"introduction": "在现代材料科学中，我们经常使用密度泛函理论（DFT）等方法来计算能带结构。这项动手编程任务将理论与实践联系起来，要求你通过对能带数据进行二次拟合，实现一个从计算结果中提取有效质量的数值程序。这个练习不仅强化了有效质量与能带曲率之间的联系，还引入了估计计算物理中不确定性的实际挑战 [@problem_id:2984204]。", "problem": "您的任务是实现一个完整、可运行的程序，通过将能带极值附近的电子能带能量 $E(\\mathbf{k})$ 拟合为二次型来估算载流子的方向标量有效质量 $m^*$，并量化因拟合范围选择而产生的不确定性。背景为密度泛函理论 (DFT, Density Functional Theory) 的能带结构。您的实现必须从基本定义和经过充分验证的公式出发，不得依赖任何预先给定的简化关系。您必须明确推导为何在极值点附近进行二次拟合可用于提取 $m^*$，以及如何通过一系列拟合窗口来估算其不确定性。然后，您的程序必须在提供的测试套件上执行此过程，并以指定的确切格式打印所需的输出。\n\n从以下基本概念出发：\n- 布洛赫能带能量 $E_n(\\mathbf{k})$ 及其群速度定义 $ \\mathbf{v}_n(\\mathbf{k}) = \\frac{1}{\\hbar}\\nabla_{\\mathbf{k}} E_n(\\mathbf{k}) $。\n- 均匀电场中波包的半经典动力学，其中 $ \\hbar \\,\\dot{\\mathbf{k}} = q \\,\\mathbf{E} $，以及牛顿第二定律 $ \\mathbf{F} = m \\,\\dot{\\mathbf{v}} $，用于确定一个在极值点附近可被视为有效质量的惯性参数。\n- 导带底附近的电子和价带顶附近的空穴的概念，包括电荷 $q$ 的符号约定和极值点处的曲率。\n\n您的程序必须在纯数学和算法层面上实现以下步骤：\n1. 对于每个数据集，在极值点周围的 $k$ 空间中选择对称窗口，对每个窗口使用最小二乘法将 $E(k)$ 拟合为二次多项式 $E(k) \\approx a k^2 + b k + c$，并从拟合中计算方向曲率。\n2. 根据上述基本原理，从曲率推导出方向标量有效质量。\n3. 对于价带顶的类空穴输运，报告由负曲率引起的正空穴质量大小。\n4. 通过在多个窗口上汇总结果并计算这些窗口间的统计离散度量，来估算由拟合范围引起的不确定性。\n\n单位与报告：\n- 使用电子伏特 ($\\mathrm{eV}$) 表示能量 $E$，使用反埃米 ($\\mathrm{\\AA^{-1}}$) 表示波矢 $k$，使用焦耳-秒 ($\\mathrm{J\\,s}$) 表示约化普朗克常数 $\\hbar$。\n- 将有效质量表示为无量纲比值 $m^*/m_e$，其中 $m_e$ 是自由电子静止质量，并将不确定性表示为 $m^*/m_e$ 在所有拟合窗口上的标准差，同样为无量纲。\n- 如果出现任何角度，必须以弧度为单位；此特定任务不涉及角度量。\n\n拟合窗口：\n- 使用对称拟合半宽度 $W = \\{\\,0.02,\\,0.03,\\,0.04,\\,0.05\\,\\}\\,\\mathrm{\\AA^{-1}}$。对于每个窗口 $w \\in W$，使用所有满足 $|k| \\leq w$ 的 $k$ 点进行拟合。\n\n测试套件：\n使用在以下离散波矢网格上定义的合成类DFT数据集\n$$\nk_m = m \\times 0.01 \\,\\mathrm{\\AA^{-1}}, \\quad m \\in \\{-5,-4,\\dots,0,\\dots,4,5\\}.\n$$\n对于每种情况和每个主方向 $\\hat{x}$ 和 $\\hat{y}$，定义\n$$\nE_{\\text{cond}}(k) = E_0 + C\\,k^2 + D\\,k^4 + \\delta \\,\\sin(\\Omega\\,k), \\quad\nE_{\\text{val}}(k) = E_0 - C\\,k^2 + D\\,k^4 + \\delta \\,\\sin(\\Omega\\,k),\n$$\n其中 $E_0$ 是带边能量，$C$ 是主导的二次项系数，$D$ 是一个小的四次修正项，$\\delta$ 是一个小的确定性微扰振幅，$\\Omega$ 是一个固定的角频率因子，使得 $\\Omega\\,k$ 无量纲。所有数学实体均以上述指定单位给出：$E_0$ 和 $\\delta$ 的单位是 $\\mathrm{eV}$，$C$ 的单位是 $\\mathrm{eV\\,\\AA^2}$，$D$ 的单位是 $\\mathrm{eV\\,\\AA^4}$，$\\Omega$ 的单位是 $\\mathrm{\\AA}$ 以使 $\\Omega\\,k$ 无量纲。\n\n提供并使用以下三个测试案例：\n- 案例 A (导带，各向同性):\n  - 方向 $\\hat{x}$: $E_0 = 0.0\\,\\mathrm{eV}$, $C_{\\hat{x}} = 19.0\\,\\mathrm{eV\\,\\AA^2}$, $D_{\\hat{x}} = 100.0\\,\\mathrm{eV\\,\\AA^4}$, $\\delta_{\\hat{x}} = 5.0\\times 10^{-4}\\,\\mathrm{eV}$, $\\Omega_{\\hat{x}} = 50.0\\,\\mathrm{\\AA}$。\n  - 方向 $\\hat{y}$: $E_0 = 0.0\\,\\mathrm{eV}$, $C_{\\hat{y}} = 19.0\\,\\mathrm{eV\\,\\AA^2}$, $D_{\\hat{y}} = 100.0\\,\\mathrm{eV\\,\\AA^4}$, $\\delta_{\\hat{y}} = 5.0\\times 10^{-4}\\,\\mathrm{eV}$, $\\Omega_{\\hat{y}} = 50.0\\,\\mathrm{\\AA}$。\n- 案例 B (导带，各向异性):\n  - 方向 $\\hat{x}$: $E_0 = 0.1\\,\\mathrm{eV}$, $C_{\\hat{x}} = 7.625\\,\\mathrm{eV\\,\\AA^2}$, $D_{\\hat{x}} = 50.0\\,\\mathrm{eV\\,\\AA^4}$, $\\delta_{\\hat{x}} = 7.0\\times 10^{-4}\\,\\mathrm{eV}$, $\\Omega_{\\hat{x}} = 70.0\\,\\mathrm{\\AA}$。\n  - 方向 $\\hat{y}$: $E_0 = 0.1\\,\\mathrm{eV}$, $C_{\\hat{y}} = 2.5425\\,\\mathrm{eV\\,\\AA^2}$, $D_{\\hat{y}} = 30.0\\,\\mathrm{eV\\,\\AA^4}$, $\\delta_{\\hat{y}} = 7.0\\times 10^{-4}\\,\\mathrm{eV}$, $\\Omega_{\\hat{y}} = 70.0\\,\\mathrm{\\AA}$。\n- 案例 C (价带，类空穴，各向异性):\n  - 方向 $\\hat{x}$: $E_0 = 0.0\\,\\mathrm{eV}$, $C_{\\hat{x}} = 4.7645\\,\\mathrm{eV\\,\\AA^2}$, $D_{\\hat{x}} = 40.0\\,\\mathrm{eV\\,\\AA^4}$, $\\delta_{\\hat{x}} = 6.0\\times 10^{-4}\\,\\mathrm{eV}$, $\\Omega_{\\hat{x}} = 60.0\\,\\mathrm{\\AA}$。\n  - 方向 $\\hat{y}$: $E_0 = 0.0\\,\\mathrm{eV}$, $C_{\\hat{y}} = 3.1765\\,\\mathrm{eV\\,\\AA^2}$, $D_{\\hat{y}} = 20.0\\,\\mathrm{eV\\,\\AA^4}$, $\\delta_{\\hat{y}} = 6.0\\times 10^{-4}\\,\\mathrm{eV}$, $\\Omega_{\\hat{y}} = 60.0\\,\\mathrm{\\AA}$。\n\n要求的输出：\n- 对于三个案例中的每一个，以及对于每个方向 $\\hat{x}$ 和 $\\hat{y}$，计算：\n  - 在四个窗口 $W$ 上的方向平均有效质量比 $m^*/m_e$。\n  - 在四个窗口 $W$ 上的方向不确定性，即 $m^*/m_e$ 的样本标准差。\n- 您的程序应生成单行输出，其中包含这 $12$ 个结果，按以下固定顺序排列，以逗号分隔，并用方括号括起：\n  $[A_{x,\\text{mean}},A_{y,\\text{mean}},A_{x,\\text{std}},A_{y,\\text{std}},B_{x,\\text{mean}},B_{y,\\text{mean}},B_{x,\\text{std}},B_{y,\\text{std}},C_{x,\\text{mean}},C_{y,\\text{mean}},C_{x,\\text{std}},C_{y,\\text{std}}]$。\n所有质量比和不确定性都必须以浮点数（无量纲）形式报告。程序不得读取输入，并且必须按原样运行至完成。", "solution": "该问题是有效的。它是一个在凝聚态物理学领域中定义明确、具有科学依据的计算问题，提供了所有必要的参数和明确的目标。\n\n目标是根据给定的电子能带色散关系 $E(\\mathbf{k})$ 确定载流子的方向标量有效质量 $m^*$，并量化此确定过程中的不确定性。该方法涉及在能带极值附近将能带结构拟合为二次多项式。\n\n首先，我们建立能带曲率与有效质量之间的理论联系。在均匀电场 $\\mathbf{E}$ 中，一个电荷为 $q$、晶体动量为 $\\hbar\\mathbf{k}$ 的电子波包的半经典运动方程由下式给出：\n$$\n\\mathbf{F} = q\\mathbf{E}\n$$\n$$\n\\dot{\\mathbf{k}} = \\frac{q\\mathbf{E}}{\\hbar}\n$$\n波包的群速度对应于经典粒子的速度，其定义为能带能量 $E(\\mathbf{k})$ 的梯度：\n$$\n\\mathbf{v}(\\mathbf{k}) = \\frac{1}{\\hbar} \\nabla_{\\mathbf{k}} E(\\mathbf{k})\n$$\n波包的加速度是其速度的时间导数, $\\dot{\\mathbf{v}}$。使用链式法则，我们有：\n$$\n\\dot{\\mathbf{v}} = \\frac{d\\mathbf{v}}{dt} = (\\nabla_{\\mathbf{k}} \\mathbf{v}) \\cdot \\dot{\\mathbf{k}}\n$$\n代入 $\\mathbf{v}$ 和 $\\dot{\\mathbf{k}}$ 的表达式：\n$$\n\\dot{\\mathbf{v}} = \\left( \\nabla_{\\mathbf{k}} \\left( \\frac{1}{\\hbar} \\nabla_{\\mathbf{k}} E(\\mathbf{k}) \\right) \\right) \\cdot \\left( \\frac{q\\mathbf{E}}{\\hbar} \\right) = \\frac{q}{\\hbar^2} \\left( \\nabla_{\\mathbf{k}} \\otimes \\nabla_{\\mathbf{k}} E(\\mathbf{k}) \\right) \\mathbf{E}\n$$\n用分量形式表示，即 $ \\dot{v}_i = \\sum_j \\frac{q}{\\hbar^2} \\frac{\\partial^2 E}{\\partial k_i \\partial k_j} E_j $。\n现在，我们将其与牛顿第二定律 $\\mathbf{F} = m\\,\\mathbf{a}$ 进行比较，其中 $\\mathbf{a} = \\dot{\\mathbf{v}}$。对于我们的波包，这变为 $q\\mathbf{E} = m^* \\dot{\\mathbf{v}}$，其中 $m^*$ 是有效质量，通常是一个张量。这个方程可以写成 $\\dot{\\mathbf{v}} = (m^*)^{-1} q\\mathbf{E}$，或以分量形式表示为 $\\dot{v}_i = \\sum_j (m^*)^{-1}_{ij} q E_j$。\n\n通过比较 $\\dot{v}_i$ 的两个表达式，我们确定了逆有效质量张量的分量：\n$$\n(m^*)^{-1}_{ij} = \\frac{1}{\\hbar^2} \\frac{\\partial^2 E}{\\partial k_i \\partial k_j}\n$$\n这个方程揭示了有效质量与能带曲率成反比。\n\n问题简化为沿 $k$ 空间中特定方向 $\\hat{u}$ 的一维输运问题。我们考虑沿一条穿过极值点（我们设其在 $k=0$ 处）的直线 $k\\hat{u}$ 的能带结构。$E(k)$ 在 $k=0$ 附近的泰勒展开为：\n$$\nE(k) = E(0) + \\left. \\frac{dE}{dk} \\right|_{k=0} k + \\frac{1}{2} \\left. \\frac{d^2E}{dk^2} \\right|_{k=0} k^2 + \\mathcal{O}(k^3)\n$$\n在极值点（最小值或最大值），一阶导数为零，即 $\\left. \\frac{dE}{dk} \\right|_{k=0} = 0$。因此，在极值点附近，色散关系近似为二次（或抛物线）形式：\n$$\nE(k) \\approx E(0) + \\frac{1}{2} \\left. \\frac{d^2E}{dk^2} \\right|_{k=0} k^2\n$$\n我们试图通过类比自由粒子来用有效质量 $m^*$ 对此行为进行建模，自由粒子的能量-动量关系为 $E_p = p^2 / (2m)$。使用德布罗意关系 $p = \\hbar k$，具有有效质量 $m^*$ 的自由粒子的能量为：\n$$\nE(k) = E_0 + \\frac{\\hbar^2 k^2}{2m^*}\n$$\n其中 $E_0=E(0)$ 是带边能量。通过比较两个 $E(k)$ 近似表达式中 $k^2$ 项的系数，我们发现：\n$$\n\\frac{1}{2} \\frac{d^2E}{dk^2} = \\frac{\\hbar^2}{2m^*} \\implies m^* = \\hbar^2 \\left( \\frac{d^2E}{dk^2} \\right)^{-1}\n$$\n这是方向标量有效质量的核心公式。\n\n为了实现这一点，我们将提供的离散 $E(k)$ 数据拟合到一个二次多项式 $E_{fit}(k) = a k^2 + b k + c$。对于这个多项式，二阶导数是一个常数：$\\frac{d^2E_{fit}}{dk^2} = 2a$。因此，我们可以近似有效质量为：\n$$\nm^* \\approx \\frac{\\hbar^2}{2a}\n$$\n$m^*$ 的符号取决于曲率 $a$ 的符号。\n- 对于导带底的电子，能带向上弯曲，因此 $a  0$，得到正的有效质量 $m^*_e  0$。\n- 对于价带顶的载流子，能带向下弯曲，因此 $a  0$。这意味着电子的有效质量为负。然而，在近满价带中的输运更便于用“空穴”的运动来描述，空穴代表电子的缺失。空穴的行为像一个带正电荷 $+e$ 和正有效质量 $m^*_h$ 的粒子。空穴质量定义为价带顶电子有效质量的负值：\n$$\nm^*_h = -m^*_{e, \\text{VBM}} = - \\frac{\\hbar^2}{2a} = \\left| \\frac{\\hbar^2}{2a} \\right| \\quad (\\text{因为 } a0)\n$$\n\n计算必须使用一致的单位。由于 $E$ 的单位是 $\\mathrm{eV}$，$k$ 的单位是 $\\mathrm{\\AA^{-1}}$，所以拟合系数 $a$ 的单位将是 $\\mathrm{eV\\,\\AA^2}$。为了获得无量纲的质量比 $m^*/m_e$，我们计算：\n$$\n\\frac{m^*}{m_e} = \\frac{\\hbar^2/(2a)}{m_e} = \\frac{1}{a} \\left( \\frac{\\hbar^2}{2m_e} \\right)\n$$\n括号中的项是一个常数，可以预先计算，其单位为 $\\mathrm{eV\\,\\AA^2}$ 以匹配 $a$ 的单位。\n使用 `scipy.constants` 中的值：$\\hbar = 1.054571817... \\times 10^{-34} \\mathrm{J\\,s}$，$m_e = 9.1093837... \\times 10^{-31} \\mathrm{kg}$，$1 \\mathrm{eV} = 1.602176634... \\times 10^{-19} \\mathrm{J}$，以及 $1 \\mathrm{\\AA} = 10^{-10} \\mathrm{m}$：\n$$\n\\frac{\\hbar^2}{2m_e} = \\frac{(1.0545... \\times 10^{-34})^2}{2 \\times 9.1093... \\times 10^{-31}} \\frac{1}{(1.6021... \\times 10^{-19}) (10^{-10})^2} \\approx 3.80998 \\mathrm{\\,eV\\,\\AA^2}\n$$\n所以，质量比的最终公式是：\n$$\n\\frac{m^*}{m_e} = \\frac{3.80998...}{a \\text{ [单位为 eV}\\cdot\\text{\\AA}^2\\text{]}}\n$$\n\n算法流程如下：\n1. 对于每个测试案例 (A, B, C) 和每个方向 ($\\hat{x}, \\hat{y}$):\n2. 使用提供的参数和函数生成离散数据集 $(k, E(k))$。\n3. 对于集合 $\\{0.02, 0.03, 0.04, 0.05\\}\\,\\mathrm{\\AA^{-1}}$ 中的每个拟合半宽度 $w$:\n   a. 选择满足 $|k| \\leq w$ 的 $(k, E(k))$ 数据子集。\n   b. 执行最小二乘二次拟合以找到系数 $a$。\n   c. 使用上面推导的公式计算质量比 $m^*/m_e$。对于价带案例 (C)，取绝对值以获得正的空穴质量。\n4. 收集从四个窗口中获得的四个质量比值。\n5. 计算这四个值的平均值。\n6. 计算这四个值的样本标准差（使用一个自由度校正），以量化由于拟合范围选择引起的不确定性。\n7. 按指定顺序整理所有 12 个结果（3 个案例中每个案例 2 个方向的平均值和标准差），用于最终输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import constants\n\ndef solve():\n    \"\"\"\n    Calculates directional effective masses and their uncertainties by fitting\n    synthetic band structure data.\n    \"\"\"\n\n    # --- Physical Constants and Conversion Factor ---\n    # Using scipy.constants for high-precision values.\n    hbar_js = constants.hbar  # h in J*s\n    m_e_kg = constants.m_e   # Electron rest mass in kg\n    ev_j = constants.electron_volt  # 1 eV in Joules\n    angstrom_m = 1e-10  # 1 Angstrom in meters\n\n    # Conversion factor from a (in eV*A^2) to m*/m_e (dimensionless)\n    # m*/m_e = (hbar^2 / (2 * a)) / m_e = (hbar^2 / (2 * m_e)) / a\n    # We need to convert a from [eV*A^2] to [J*m^2] before dividing.\n    # a_jm2 = a_eva2 * ev_j * (angstrom_m)^2\n    # So, m*/m_e = (hbar^2 / (2 * m_e)) / (a_eva2 * ev_j * angstrom_m**2)\n    # Pre-calculating the constant part:\n    # CONVERSION_FACTOR = hbar^2 / (2 * m_e * eV_to_J * A^2_to_m^2)\n    CONVERSION_FACTOR = hbar_js**2 / (2 * m_e_kg * ev_j * angstrom_m**2)\n    # This factor has units of eV*A^2.\n    # The final formula is: m_star_ratio = CONVERSION_FACTOR / a_fit\n\n    # --- Problem Setup ---\n    # Define the discrete k-space grid\n    k_step = 0.01  # in A^-1\n    k_points = np.arange(-5, 6) * k_step # from -0.05 to 0.05\n\n    # Define the fitting window half-widths\n    fitting_windows_half_width = [0.02, 0.03, 0.04, 0.05] # in A^-1\n\n    # --- Test Cases ---\n    test_cases = {\n        'A': {\n            'type': 'conduction',\n            'directions': [\n                {'E0': 0.0, 'C': 19.0, 'D': 100.0, 'delta': 5.0e-4, 'Omega': 50.0}, # x\n                {'E0': 0.0, 'C': 19.0, 'D': 100.0, 'delta': 5.0e-4, 'Omega': 50.0}, # y\n            ]\n        },\n        'B': {\n            'type': 'conduction',\n            'directions': [\n                {'E0': 0.1, 'C': 7.625, 'D': 50.0, 'delta': 7.0e-4, 'Omega': 70.0}, # x\n                {'E0': 0.1, 'C': 2.5425,'D': 30.0, 'delta': 7.0e-4, 'Omega': 70.0}, # y\n            ]\n        },\n        'C': {\n            'type': 'valence',\n            'directions': [\n                {'E0': 0.0, 'C': 4.7645, 'D': 40.0, 'delta': 6.0e-4, 'Omega': 60.0}, # x\n                {'E0': 0.0, 'C': 3.1765, 'D': 20.0, 'delta': 6.0e-4, 'Omega': 60.0}, # y\n            ]\n        }\n    }\n\n    def energy_band_func(k, E0, C, D, delta, Omega, band_type):\n        \"\"\"Calculates band energy E(k) based on the provided formula.\"\"\"\n        sign = 1.0 if band_type == 'conduction' else -1.0\n        return E0 + sign * C * k**2 + D * k**4 + delta * np.sin(Omega * k)\n\n    final_results = []\n\n    case_order = ['A', 'B', 'C']\n    for case_id in case_order:\n        case = test_cases[case_id]\n        case_type = case['type']\n        \n        means = []\n        stds = []\n\n        for direction_params in case['directions']:\n            # Generate the energy data for the current direction\n            E_points = energy_band_func(\n                k_points,\n                direction_params['E0'],\n                direction_params['C'],\n                direction_params['D'],\n                direction_params['delta'],\n                direction_params['Omega'],\n                case_type\n            )\n\n            mass_ratios_for_windows = []\n            \n            # Iterate through each fitting window\n            for w in fitting_windows_half_width:\n                # Select data points within the current window\n                # Use a small tolerance for floating point comparison\n                window_mask = np.abs(k_points) = w + 1e-9\n                k_fit = k_points[window_mask]\n                E_fit = E_points[window_mask]\n\n                # Perform a quadratic fit: E(k) = a*k^2 + b*k + c\n                coeffs = np.polyfit(k_fit, E_fit, 2)\n                a_fit = coeffs[0] # The quadratic coefficient\n\n                # Calculate the effective mass ratio m*/m_e\n                # m*/m_e = (hbar^2/(2*a)) / m_e = CONVERSION_FACTOR / a\n                m_star_ratio = CONVERSION_FACTOR / a_fit\n                \n                # For valence band (hole mass), curvature 'a' is negative.\n                # The hole effective mass is positive, so we take the absolute value.\n                if case_type == 'valence':\n                    m_star_ratio = abs(m_star_ratio)\n\n                mass_ratios_for_windows.append(m_star_ratio)\n\n            # Calculate statistics across the windows for the current direction\n            mean_mass = np.mean(mass_ratios_for_windows)\n            # Use ddof=1 for sample standard deviation\n            std_mass = np.std(mass_ratios_for_windows, ddof=1)\n            \n            means.append(mean_mass)\n            stds.append(std_mass)\n        \n        # Following the required output format: [A_x_mean, A_y_mean, A_x_std, A_y_std, ...]\n        final_results.extend(means)\n        final_results.extend(stds)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in final_results)}]\")\n\nsolve()\n```", "id": "2984204"}]}