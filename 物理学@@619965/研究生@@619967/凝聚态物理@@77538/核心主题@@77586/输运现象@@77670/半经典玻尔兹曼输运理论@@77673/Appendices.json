{"hands_on_practices": [{"introduction": "这项实践将指导您完成维德曼-弗朗茨定律的经典推导。这是一个基础练习，旨在应用索末菲展开处理玻尔兹曼输运积分，从而得出一个连接金属中电导率和热导率的普适常数。掌握这一计算是理解简并费米子体系中输运现象的关键一步 [@problem_id:1221120]。", "problem": "考虑一个处于$d$维空间中的无相互作用的电子气。电子具有抛物线形的能量色散关系 $\\epsilon(\\mathbf{k}) = \\frac{\\hbar^2 |\\mathbf{k}|^2}{2m}$，其中 $\\mathbf{k}$ 是波矢，$m$ 是有效质量。该系统由自由电子模型描述。\n\n电子气的输运性质由散射过程决定，这些过程在弛豫时间近似的框架内建模。假设散射时间 $\\tau$ 是一个常数，且与电子的能量无关。\n\n使用半经典的玻尔兹曼输运理论，确定在低温极限下 ($k_B T \\ll \\mu$) 的洛伦兹数 $L = \\frac{\\kappa}{\\sigma T}$。其中，$\\sigma$ 是电导率，$\\kappa$ 是热导率的电子贡献部分，$T$ 是绝对温度，$\\mu$ 是化学势，$k_B$ 是玻尔兹曼常数。\n\n用基本电荷 $e$ 和玻尔兹曼常数 $k_B$ 表示你的答案。", "solution": "电导率 $\\sigma$ 和电子热导率 $\\kappa$ 可以通过在弛豫时间近似下的玻尔兹曼输运方程计算得出。对于一个 $d$ 维各向同性系统，其通用表达式为：\n$$\n\\sigma = e^2 \\mathcal{K}_0\n$$\n$$\n\\kappa = \\frac{1}{T} \\left( \\mathcal{K}_2 - \\frac{\\mathcal{K}_1^2}{\\mathcal{K}_0} \\right)\n$$\n其中输运积分 $\\mathcal{K}_n$ 由下式给出：\n$$\n\\mathcal{K}_n = \\int_0^\\infty d\\epsilon \\, \\mathcal{D}(\\epsilon) (\\epsilon - \\mu)^n \\left( -\\frac{\\partial f_0}{\\partial \\epsilon} \\right)\n$$\n在此，$f_0(\\epsilon) = [e^{(\\epsilon-\\mu)/(k_B T)} + 1]^{-1}$ 是费米-狄拉克分布函数，而 $\\mathcal{D}(\\epsilon)$ 是输运分布函数。对于一个 $d$ 维各向同性系统，$\\mathcal{D}(\\epsilon)$ 由下式给出：\n$$\n\\mathcal{D}(\\epsilon) = \\frac{1}{d} g(\\epsilon) v^2(\\epsilon) \\tau(\\epsilon)\n$$\n其中 $g(\\epsilon)$ 是单位体积的态密度，$v(\\epsilon)$ 是电子速率，$\\tau(\\epsilon)$ 是弛豫时间。\n\n问题陈述了色散关系为 $\\epsilon(\\mathbf{k}) = \\frac{\\hbar^2 k^2}{2m}$，这意味着 $v(\\epsilon) = \\sqrt{\\frac{2\\epsilon}{m}}$。对于这个色散关系，在 $d$ 维空间中的态密度形式为 $g(\\epsilon) = C_d \\epsilon^{d/2 - 1}$，其中 $C_d$ 是一个依赖于 $d$ 和 $m$ 的常数。弛豫时间被给定为一个常数 $\\tau(\\epsilon) = \\tau$。\n\n将这些代入输运分布函数：\n$$\n\\mathcal{D}(\\epsilon) = \\frac{1}{d} (C_d \\epsilon^{d/2 - 1}) \\left(\\frac{2\\epsilon}{m}\\right) \\tau = \\frac{2 C_d \\tau}{dm} \\epsilon^{d/2}\n$$\n函数 $\\mathcal{D}(\\epsilon)$ 是能量的光滑函数。\n\n现在我们在低温极限 ($k_B T \\ll \\mu$) 下计算积分 $\\mathcal{K}_n$。在此极限下，费米函数的导数 $-\\frac{\\partial f_0}{\\partial \\epsilon}$ 在 $\\epsilon = \\mu$ 处呈尖峰状。我们可以对形式为 $I = \\int_0^\\infty H(\\epsilon) \\left( -\\frac{\\partial f_0}{\\partial \\epsilon} \\right) d\\epsilon$ 的积分使用索末菲展开：\n$$\nI \\approx H(\\mu) + \\frac{\\pi^2}{6} (k_B T)^2 H''(\\mu) + \\mathcal{O}(T^4)\n$$\n\n我们来计算 $\\mathcal{K}_0$、$\\mathcal{K}_1$ 和 $\\mathcal{K}_2$。\n\n对于 $\\mathcal{K}_0$：$H(\\epsilon) = \\mathcal{D}(\\epsilon)$。\n$$\n\\mathcal{K}_0 \\approx \\mathcal{D}(\\mu) + \\frac{\\pi^2}{6} (k_B T)^2 \\mathcal{D}''(\\mu)\n$$\n取主导项，$\\mathcal{K}_0 \\approx \\mathcal{D}(\\mu)$。\n电导率为 $\\sigma = e^2 \\mathcal{K}_0 \\approx e^2 \\mathcal{D}(\\mu)$。\n\n对于 $\\mathcal{K}_1$：$H(\\epsilon) = (\\epsilon - \\mu) \\mathcal{D}(\\epsilon)$。\n$H(\\mu) = 0$。$H'(\\epsilon) = \\mathcal{D}(\\epsilon) + (\\epsilon-\\mu)\\mathcal{D}'(\\epsilon)$，所以 $H'(\\mu) = \\mathcal{D}(\\mu)$。$H''(\\epsilon) = 2\\mathcal{D}'(\\epsilon) + (\\epsilon-\\mu)\\mathcal{D}''(\\epsilon)$，所以 $H''(\\mu) = 2\\mathcal{D}'(\\mu)$。\n通过对 $\\mathcal{D}(\\epsilon)$ 在 $\\epsilon=\\mu$ 附近进行泰勒展开，并利用标准积分，可以得到积分的主导项。最终得到：\n$$\n\\mathcal{K}_1 \\approx \\frac{\\pi^2}{3}(k_B T)^2 \\mathcal{D}'(\\mu)\n$$\n\n对于 $\\mathcal{K}_2$：$H(\\epsilon) = (\\epsilon - \\mu)^2 \\mathcal{D}(\\epsilon)$。\n$H(\\mu) = 0$, $H'(\\mu) = 0$, $H''(\\mu) = 2\\mathcal{D}(\\mu)$。\n索末菲展开中的主导项来自二阶导数项：\n$$\n\\mathcal{K}_2 \\approx \\frac{\\pi^2}{6} (k_B T)^2 H''(\\mu) = \\frac{\\pi^2}{6} (k_B T)^2 [2\\mathcal{D}(\\mu)] = \\frac{\\pi^2}{3} (k_B T)^2 \\mathcal{D}(\\mu)\n$$\n这也可以通过直接积分得到：\n$$\n\\mathcal{K}_2 \\approx \\int_{-\\infty}^{\\infty} (x k_B T)^2 \\mathcal{D}(\\mu) \\frac{e^x}{(e^x+1)^2} dx = (k_B T)^2 \\mathcal{D}(\\mu) \\int_{-\\infty}^{\\infty} \\frac{x^2 e^x}{(e^x+1)^2} dx = \\frac{\\pi^2}{3} (k_B T)^2 \\mathcal{D}(\\mu)\n$$\n\n现在，我们来组合出热导率 $\\kappa$：\n$$\n\\kappa = \\frac{1}{T} \\left( \\mathcal{K}_2 - \\frac{\\mathcal{K}_1^2}{\\mathcal{K}_0} \\right)\n$$\n在 $T$ 的最低阶近似下，$\\mathcal{K}_0 \\approx \\mathcal{D}(\\mu)$，$\\mathcal{K}_1 \\propto T^2$，且 $\\mathcal{K}_2 \\propto T^2$。\n项 $\\mathcal{K}_1^2/\\mathcal{K}_0 \\propto T^4$，因此它是一个高阶修正，对于 $\\kappa$ 的主导行为可以忽略不计。\n$$\n\\kappa \\approx \\frac{1}{T} \\mathcal{K}_2 = \\frac{1}{T} \\left( \\frac{\\pi^2}{3} (k_B T)^2 \\mathcal{D}(\\mu) \\right) = \\frac{\\pi^2 k_B^2 T}{3} \\mathcal{D}(\\mu)\n$$\n\n最后，我们计算洛伦兹数 $L$：\n$$\nL = \\frac{\\kappa}{\\sigma T}\n$$\n代入 $\\sigma$ 和 $\\kappa$ 的主导阶表达式：\n$$\n\\sigma \\approx e^2 \\mathcal{D}(\\mu)\n$$\n$$\n\\kappa \\approx \\frac{\\pi^2 k_B^2 T}{3} \\mathcal{D}(\\mu)\n$$\n$$\nL = \\frac{\\frac{\\pi^2 k_B^2 T}{3} \\mathcal{D}(\\mu)}{(e^2 \\mathcal{D}(\\mu)) T} = \\frac{\\pi^2 k_B^2}{3 e^2}\n$$\n结果与输运函数 $\\mathcal{D}(\\mu)$ 无关，因此也与维度 $d$、质量 $m$ 和常数弛豫时间 $\\tau$ 无关，因为这些因子在比率中都相互抵消了。这个普适值被称为洛伦兹数 $L_0$。\n$$\nL = \\frac{\\pi^2}{3} \\left( \\frac{k_B}{e} \\right)^2\n$$\n这就是著名的 Wiedemann-Franz 定律。", "answer": "$$ \\boxed{\\frac{\\pi^2}{3} \\left(\\frac{k_B}{e}\\right)^2} $$", "id": "1221120"}, {"introduction": "在基础之上，本实践将处理一个更真实的情景：计算由多种声子散射机制共同限制的载流子迁移率。您将应用马西森定则来合并声学声子和光学声子的影响，这是半导体物理学和二维材料研究中的一项常见任务。该练习旨在加深对微观散射事件与宏观输运系数之间联系的理解 [@problem_id:3022353]。", "problem": "考虑一个单层过渡金属二硫族化物，其在$\\mathbf{K}$谷具有由有效质量$m^{*}$描述的单个各向同性抛物线型导带底。假设以下物理上真实的条件：\n- 二维（2D）电子，其色散关系为 $E(\\mathbf{k}) = \\hbar^{2} k^{2}/(2 m^{*})$，各向同性速度为 $\\mathbf{v} = \\hbar \\mathbf{k}/m^{*}$。\n- 由平衡分布 $f_{0}(E)$ 描述的非简并载流子，其对弱静电场 $\\mathbf{E}$ 呈线性响应。\n- 半经典 Boltzmann 输运框架内的弛豫时间近似（RTA）。\n- 本征散射主要由通过形变势 $D_{\\mathrm{ac}}$（声子群速度为 $v_{s}$）的纵向声学（LA）声子，以及角频率为 $\\omega_{0}$、能量为 $\\hbar \\omega_{0}$、且用于吸收过程的电子-声子耦合与 $k$ 无关的单个无色散纵向光学（LO）声子主导。\n- LA 声子在能量均分和弹性散射极限下处理，而 LO 声子散射在温度 $T$ 下被处理为以吸收为主，其 Bose–Einstein 占据数为 $N_{0} = \\left[\\exp\\left(\\hbar \\omega_{0}/(k_{B} T)\\right) - 1\\right]^{-1}$。\n- 晶体的二维面质量密度为 $\\rho_{s}$。\n\n从线性化 Boltzmann 输运方程和用于电子-声子散射的 Fermi 黄金定则出发，并援引关于动量弛豫率可加性的 Matthiessen 法则，推导受 LA 和 LO 声子散射限制的总低场载流子迁移率 $\\mu(T)$。将你的最终答案表示为由 $m^{*}$、$D_{\\mathrm{ac}}$、$\\rho_{s}$、$v_{s}$、$\\hbar$、$e$、$k_{B}$、$T$、$\\omega_{0}$ 以及一个由 LO 吸收散射率系数定义的唯象常数 $C_{\\mathrm{op}}$（其中 $1/\\tau_{\\mathrm{op}} = C_{\\mathrm{op}}\\,N_{0}$）构成的单个闭合形式解析表达式。你可以假设自旋和谷简并度在迁移率中相互抵消。将最终迁移率以国际单位制单位 $\\mathrm{m}^{2}\\,\\mathrm{V}^{-1}\\,\\mathrm{s}^{-1}$ 表示。无需进行数值计算。", "solution": "该问题要求在考虑纵向声学（LA）和纵向光学（LO）声子散射的情况下，推导二维电子气中的低场载流子迁移率 $\\mu(T)$。推导将在半经典 Boltzmann 输运框架内，采用弛豫时间近似（RTA）进行。\n\n对于一个各向同性的二维系统，其低场电导率 $\\sigma$ 由对能量 $E$ 的积分给出：\n$$ \\sigma = e^2 \\int_0^\\infty \\mathcal{T}(E) \\left( -\\frac{\\partial f_0(E)}{\\partial E} \\right) dE $$\n其中 $e$ 是元电荷，$f_0(E)$ 是平衡载流子分布函数，$\\mathcal{T}(E)$ 是输运分布函数。对于一个具有各向同性抛物线型色散关系 $E(\\mathbf{k}) = \\hbar^2 k^2 / (2m^*)$ 的系统，输运分布函数为：\n$$ \\mathcal{T}(E) = D_{2D}(E) v(E)^2 \\frac{\\tau(E)}{2} $$\n这里，$D_{2D}(E)$ 是二维态密度，$v(E)$ 是能量为 $E$ 时的电子速度，$\\tau(E)$ 是动量弛豫时间。\n\n对于二维抛物线能带，单位面积的态密度（包括自旋和谷简并度 $g_s g_v$）为 $D_{2D}(E) = \\frac{g_s g_v m^*}{2\\pi\\hbar^2}$。电子速度为 $v(E) = \\sqrt{2E/m^*}$。问题陈述中提到，自旋和谷简并度在最终的迁移率表达式中会相互抵消，因此我们可以设 $g_s=g_v=1$ 继续进行，并且之后会证明这些因子的确会消去。因此，我们使用与能量无关的 $D_{2D}(E) = \\frac{m^*}{2\\pi\\hbar^2}$。\n\n系统是非简并的，因此平衡分布是 Maxwell-Boltzmann 分布，$f_0(E) \\propto \\exp(-E/(k_B T))$，其中 $k_B$ 是 Boltzmann 常数，$T$ 是温度。那么其导数为：\n$$ -\\frac{\\partial f_0(E)}{\\partial E} = \\frac{1}{k_B T} f_0(E) $$\n\n载流子迁移率 $\\mu$ 通过 $\\sigma = n e \\mu$ 与电导率 $\\sigma$ 及二维载流子密度 $n$ 相关。载流子密度 $n$ 由下式给出：\n$$ n = \\int_0^\\infty D_{2D}(E) f_0(E) dE $$\n结合这些表达式，迁移率为：\n$$ \\mu = \\frac{\\sigma}{ne} = \\frac{e \\int_0^\\infty D_{2D}(E) v(E)^2 \\frac{\\tau(E)}{2} \\left(-\\frac{\\partial f_0(E)}{\\partial E}\\right) dE}{\\int_0^\\infty D_{2D}(E) f_0(E) dE} $$\n代入 $D_{2D}(E)$、$v(E)$ 和 $-\\partial f_0/\\partial E$ 的表达式：\n$$ \\mu = \\frac{e \\int_0^\\infty \\left(\\frac{m^*}{2\\pi\\hbar^2}\\right) \\left(\\frac{2E}{m^*}\\right) \\frac{\\tau(E)}{2} \\left(\\frac{f_0(E)}{k_B T}\\right) dE}{\\int_0^\\infty \\left(\\frac{m^*}{2\\pi\\hbar^2}\\right) f_0(E) dE} $$\n常数因子 $\\frac{m^*}{2\\pi\\hbar^2}$ 从分子和分母中消去。\n$$ \\mu = \\frac{e \\int_0^\\infty \\frac{E}{m^* k_B T} \\tau(E) f_0(E) dE}{\\int_0^\\infty f_0(E) dE} $$\n代入 $f_0(E) = C \\exp(-E/(k_B T))$，其中 $C$ 是一个归一化常数：\n$$ \\mu = \\frac{\\frac{e}{m^* k_B T} \\int_0^\\infty E \\tau(E) \\exp(-E/(k_B T)) dE}{\\int_0^\\infty \\exp(-E/(k_B T)) dE} $$\n分母中的积分为 $\\int_0^\\infty \\exp(-E/(k_B T)) dE = k_B T$。\n$$ \\mu = \\frac{e}{m^* (k_B T)^2} \\int_0^\\infty E \\tau(E) \\exp(-E/(k_B T)) dE $$\n\n接下来，我们计算动量弛豫时间 $\\tau(E)$。根据 Matthiessen 法则，总散射率 $1/\\tau(E)$ 是各个独立散射机制速率的总和：\n$$ \\frac{1}{\\tau(E)} = \\frac{1}{\\tau_{\\mathrm{ac}}(E)} + \\frac{1}{\\tau_{\\mathrm{op}}(E)} $$\n其中 $\\tau_{\\mathrm{ac}}$ 和 $\\tau_{\\mathrm{op}}$ 分别是由 LA 和 LO 声子散射引起的弛豫时间。\n\n对于二维系统中通过形变势的 LA 声子散射，在弹性散射和能量均分（$k_B T \\gg \\hbar v_s q$）近似下，动量弛豫率与载流子能量 $E$ 无关。标准结果为：\n$$ \\frac{1}{\\tau_{\\mathrm{ac}}} = \\frac{m^* D_{\\mathrm{ac}}^2 k_B T}{\\hbar^3 \\rho_s v_s^2} $$\n其中 $D_{\\mathrm{ac}}$ 是形变势，$\\rho_s$ 是二维面质量密度，$v_s$ 是声速。\n\n对于 LO 声子散射，问题定义了一个唯象模型，其中散射率主要由吸收频率为 $\\omega_0$ 的无色散声子决定。陈述中指出耦合与 $k$ 无关，因此得到的速率相对于电子能量是一个常数：\n$$ \\frac{1}{\\tau_{\\mathrm{op}}} = C_{\\mathrm{op}} N_{0} $$\n其中 $C_{\\mathrm{op}}$ 是一个常数，$N_0$ 是声子的 Bose-Einstein 占据数：\n$$ N_{0} = \\frac{1}{\\exp\\left(\\frac{\\hbar \\omega_{0}}{k_{B} T}\\right) - 1} $$\n\n由于 $1/\\tau_{\\mathrm{ac}}$ 和 $1/\\tau_{\\mathrm{op}}$ 都与能量 $E$ 无关，总弛豫时间 $\\tau(E)$ 相对于能量也是一个常数。我们称之为 $\\tau_{\\mathrm{tot}}$：\n$$ \\frac{1}{\\tau_{\\mathrm{tot}}} = \\frac{m^* D_{\\mathrm{ac}}^2 k_B T}{\\hbar^3 \\rho_s v_s^2} + C_{\\mathrm{op}} \\left[ \\exp\\left(\\frac{\\hbar \\omega_0}{k_B T}\\right) - 1 \\right]^{-1} $$\n\n因为 $\\tau(E) = \\tau_{\\mathrm{tot}}$ 是一个常数，我们可以将其从迁移率积分中提出来：\n$$ \\mu = \\frac{e \\tau_{\\mathrm{tot}}}{m^* (k_B T)^2} \\int_0^\\infty E \\exp(-E/(k_B T)) dE $$\n剩余的积分是一个标准的 Gamma 函数积分：\n$$ \\int_0^\\infty E \\exp(-E/(k_B T)) dE $$\n令 $x = E/(k_B T)$。则 $E = x k_B T$ 且 $dE = k_B T dx$。该积分变为：\n$$ \\int_0^\\infty (x k_B T) \\exp(-x) (k_B T dx) = (k_B T)^2 \\int_0^\\infty x e^{-x} dx $$\n积分 $\\int_0^\\infty x e^{-x} dx = \\Gamma(2) = 1! = 1$。因此，该积分的计算结果为 $(k_B T)^2$。\n将此结果代回迁移率的表达式中：\n$$ \\mu = \\frac{e \\tau_{\\mathrm{tot}}}{m^* (k_B T)^2} (k_B T)^2 = \\frac{e \\tau_{\\mathrm{tot}}}{m^*} $$\n这是一个熟知的结果，即对于与能量无关的弛豫时间，动力学平均迁移率简化为 Drude 公式。\n\n最后，我们代入 $\\tau_{\\mathrm{tot}}$ 的表达式：\n$$ \\mu(T) = \\frac{e}{m^*} \\left( \\frac{1}{\\tau_{\\mathrm{tot}}} \\right)^{-1} = \\frac{e}{m^*} \\left( \\frac{m^* D_{\\mathrm{ac}}^2 k_B T}{\\hbar^3 \\rho_s v_s^2} + C_{\\mathrm{op}} \\left[ \\exp\\left(\\frac{\\hbar \\omega_0}{k_B T}\\right) - 1 \\right]^{-1} \\right)^{-1} $$\n这就是总低场迁移率作为温度和给定材料参数的函数的最终闭合形式解析表达式。", "answer": "$$ \\boxed{\\frac{e}{m^{*}} \\left( \\frac{m^{*} D_{\\mathrm{ac}}^{2} k_{B} T}{\\hbar^{3} \\rho_{s} v_{s}^{2}} + C_{\\mathrm{op}} \\left[ \\exp\\left(\\frac{\\hbar \\omega_{0}}{k_{B} T}\\right) - 1 \\right]^{-1} \\right)^{-1}} $$", "id": "3022353"}, {"introduction": "最后一项实践将从纸笔推导过渡到计算建模，这是现代材料研究中的一项至关重要的技能。您的任务是通过寻找理想的载流子浓度来数值优化热电优值 $ZT$。这需要您完整地实现半经典输运模型，展示理论概念如何直接用于指导高性能材料的设计 [@problem_id:2532254]。", "problem": "要求您实现一个完整的程序，针对弛豫时间近似下的单个抛物线形能带，计算在给定固定晶格热导率的情况下，使热电优值 $ZT$ 最大化的载流子浓度。您的程序必须通过简约化学势 $ \\eta $ 和一个能量依赖的散射模型来平衡功率因子和洛伦兹数，从而解决此优化问题。\n\n需要使用的基本原理和定义：\n- 假设单个抛物线形能带，其弛豫时间依赖于能量 $ \\tau(E) \\propto E^{r} $，其中 $ r $ 是散射指数。\n- 设简约能量为 $ \\varepsilon = E/(k_{\\mathrm{B}} T) $，简约化学势为 $ \\eta = \\mu/(k_{\\mathrm{B}} T) $，其中 $ k_{\\mathrm{B}} $ 为 Boltzmann 常数，$ T $ 为绝对温度。\n- Fermi–Dirac 占据数为 $ f(\\varepsilon,\\eta) = \\left(1 + \\exp(\\varepsilon - \\eta)\\right)^{-1} $，其能量导数满足 $ -\\partial f/\\partial \\varepsilon = f(1-f) $。\n- 定义输运积分\n$$\nJ_{n}(\\eta,r) = \\int_{0}^{\\infty} \\varepsilon^{\\,r + 1/2} \\left(\\varepsilon - \\eta\\right)^{n} \\left[ -\\frac{\\partial f(\\varepsilon,\\eta)}{\\partial \\varepsilon} \\right] \\, d\\varepsilon \\quad \\text{for } n \\in \\{0,1,2\\}.\n$$\n- 将电导率建模为 $ \\sigma(\\eta) = A_{\\sigma} \\, J_{0}(\\eta,r) $，其中 $ A_{\\sigma} $ 是在指定温度 $ T $ 下单位为 $\\mathrm{S/m}$ 的给定正输运前因子。Seebeck 系数为\n$$\nS(\\eta) = \\frac{k_{\\mathrm{B}}}{e} \\, \\frac{J_{1}(\\eta,r)}{J_{0}(\\eta,r)} ,\n$$\n洛伦兹数为\n$$\nL(\\eta) = \\left(\\frac{k_{\\mathrm{B}}}{e}\\right)^{2} \\left[ \\frac{J_{2}(\\eta,r)}{J_{0}(\\eta,r)} - \\left( \\frac{J_{1}(\\eta,r)}{J_{0}(\\eta,r)} \\right)^{2} \\right],\n$$\n其中 $ e $ 是元电荷。\n- 电子热导率为 $ \\kappa_{e}(\\eta) = L(\\eta) \\, \\sigma(\\eta) \\, T $，晶格热导率为与 $ \\eta $ 无关的固定正常数 $ \\kappa_{l} $。\n- 热电优值为\n$$\nZT(\\eta) = \\frac{ S(\\eta)^{2} \\, \\sigma(\\eta) \\, T }{ \\kappa_{e}(\\eta) + \\kappa_{l} }.\n$$\n- 对于 $n$ 型半导体，载流子浓度 $ n(\\eta) $ 通过 $ 1/2 $ 阶的 Fermi–Dirac 积分与 $ \\eta $ 相关联：\n$$\nF_{1/2}(\\eta) = \\int_{0}^{\\infty} \\frac{\\varepsilon^{1/2}}{1 + \\exp(\\varepsilon - \\eta)} \\, d\\varepsilon,\n$$\n以及导带中的有效态密度，\n$$\nN_{c}(T) = 2 \\left( \\frac{2 \\pi m^{\\ast} k_{\\mathrm{B}} T}{h^{2}} \\right)^{3/2},\n$$\n其中 $ m^{\\ast} $ 是导带有效质量，$ h $ 是 Planck 常数，因子 $ 2 $ 用于自旋简并。包含能谷简并度 $ g_{v} $ 后，数密度为\n$$\nn(\\eta) = g_{v} \\, N_{c}(T) \\, F_{1/2}(\\eta).\n$$\n以上所有积分都必须进行数值计算。\n\n任务：\n- 对于每个指定的测试用例，您必须在一个足够宽的 $ \\eta $ 范围内进行数值最大化 $ ZT(\\eta) $，以涵盖非简并和简并两种情况。然后，计算相应的最优载流子浓度 $ n(\\eta_{\\mathrm{opt}}) $。\n- 您的数值结果必须以 $\\mathrm{cm}^{-3}$ 为单位的载流子浓度表示，并四舍五入到三位有效数字。\n\n测试套件：\n每个测试用例是一个元组 $ (T, \\kappa_{l}, r, A_{\\sigma}, m^{\\ast}, g_{v}) $，其中：\n- $ T $ 单位为 $\\mathrm{K}$，\n- $ \\kappa_{l} $ 单位为 $\\mathrm{W \\, m^{-1} \\, K^{-1}}$，\n- $ r $ 无量纲，\n- $ A_{\\sigma} $ 在指定温度 $ T $ 下单位为 $\\mathrm{S/m}$，\n- $ m^{\\ast} $ 单位为千克，\n- $ g_{v} $ 无量纲。\n\n按给定顺序使用以下测试用例：\n- 情况 1：$ (300, 1.5, 0.0, 5.0 \\times 10^{4}, 1.5 \\, m_{e}, 2) $。\n- 情况 2：$ (300, 15.0, 0.0, 5.0 \\times 10^{4}, 1.5 \\, m_{e}, 2) $。\n- 情况 3：$ (800, 2.0, 0.5, 8.0 \\times 10^{4}, 0.7 \\, m_{e}, 6) $。\n- 情况 4：$ (500, 0.5, -0.5, 3.0 \\times 10^{4}, 2.0 \\, m_{e}, 1) $。\n- 情况 5：$ (300, 1.5, 0.0, 5.0 \\times 10^{3}, 1.0 \\, m_{e}, 2) $。\n\n这里 $ m_{e} $ 表示自由电子质量（单位为千克）。\n\n输出规范：\n- 您的程序应生成单行输出，其中包含五个测试用例的最优载流子浓度，形式为方括号括起来的逗号分隔列表，顺序与测试套件相同。每个浓度以 $\\mathrm{cm}^{-3}$ 为单位表示，四舍五入到三位有效数字，输出字符串中不含单位符号。例如，输出行的格式为\n\"[n1,n2,n3,n4,n5]\"\n其中每个 $ n_{i} $ 是一个浮点数，代表在 $\\mathrm{cm}^{-3}$ 单位下四舍五入后的值。\n\n要求与约束：\n- 您必须以足够的精度对所有必需的积分进行数值计算，以确保结果在非简并和简并两种情况下都稳定且收敛。\n- 不要假设输运积分或 Fermi–Dirac 积分有任何封闭形式的表达式；直接根据上述定义进行计算。\n- $ \\eta $ 的搜索域必须足够宽，以包含 $ \\eta \\ll 0 $ (非简并) 和 $ \\eta \\gg 0 $ (简并)；您必须实现一个有原则的一维最大化程序，该程序结合粗略扫描和局部优化来定位 $ \\eta_{\\mathrm{opt}} $。\n- 确保所有常量使用一致，并且所有物理量在内部都带有正确的单位。最终报告的浓度必须以 $\\mathrm{cm}^{-3}$ 为单位，并四舍五入到三位有效数字。", "solution": "该问题陈述已经过严格验证，在科学上是合理、适定且完整的。它代表了材料化学和固态物理领域中的一个标准计算任务，基于单个抛物线形能带的半经典 Boltzmann 输运理论。所有提供的定义、物理量和参数都与已建立的理论模型一致，并且在物理现实的范围内。因此，我们可以进行形式化的求解。\n\n目标是确定使热电优值 $ZT$ 最大化的最优载流子浓度 $n_{\\mathrm{opt}}$。该量定义为：\n$$\nZT(\\eta) = \\frac{ S(\\eta)^{2} \\, \\sigma(\\eta) \\, T }{ \\kappa_{e}(\\eta) + \\kappa_{l} }\n$$\n优化是相对于简约化学势 $\\eta = \\mu/(k_{\\mathrm{B}} T)$ 进行的，它作为载流子浓度的代理。此任务代表了热电材料设计中的一个经典优化问题，需要在相互竞争的因素之间取得平衡。增加 $\\eta$ (从而增加载流子浓度) 通常会增加电导率 $\\sigma(\\eta)$，这有利于功率因子 $S^2\\sigma$。然而，非常高的 $\\eta$ 通常会降低 Seebeck 系数 $S(\\eta)$ 并增加电子热导率 $\\kappa_e(\\eta)$，这两者都对 $ZT$ 不利。因此，最优的 $\\eta$ 对应于给定材料系统（由其散射机制($r$)、温度($T$)和晶格热导率($\\kappa_l$)定义）的理想平衡点。\n\n求解方法是所提供物理模型的直接数值实现。\n\n1.  **输运积分的计算**：该模型的核心在于输运积分，定义为：\n    $$\n    J_{n}(\\eta,r) = \\int_{0}^{\\infty} \\varepsilon^{\\,r + 1/2} \\left(\\varepsilon - \\eta\\right)^{n} \\left[ -\\frac{\\partial f(\\varepsilon,\\eta)}{\\partial \\varepsilon} \\right] \\, d\\varepsilon \\quad \\text{for } n \\in \\{0,1,2\\}\n    $$\n    这些积分通过数值方法计算。项 $-\\partial f/\\partial\\varepsilon$ 表示 Fermi-Dirac 分布的能量导数。为了稳健的数值评估，最好将其表示为：\n    $$\n    -\\frac{\\partial f(\\varepsilon,\\eta)}{\\partial \\varepsilon} = \\frac{\\exp(\\varepsilon - \\eta)}{\\left(1 + \\exp(\\varepsilon - \\eta)\\right)^2} = \\frac{1}{4 \\cosh^2\\left(\\frac{\\varepsilon - \\eta}{2}\\right)}\n    $$\n    该函数在 $\\varepsilon = \\eta$ 附近呈尖峰，将积分的贡献局域化。我们采用数值积分，具体是 `scipy.integrate` 库中的 `quad` 函数，在足够大的积分区间（例如，从 $\\varepsilon=0$ 到 $\\varepsilon=100$）上进行计算，以确保在相关 $\\eta$ 范围内的收敛。\n\n2.  **输运系数的计算**：对于给定的 $\\eta$，计算出输运积分 $J_0$、$J_1$ 和 $J_2$ 后，我们可以确定输运系数：\n    -   电导率：$\\sigma(\\eta) = A_{\\sigma} \\, J_{0}(\\eta,r)$\n    -   Seebeck 系数：$S(\\eta) = \\frac{k_{\\mathrm{B}}}{e} \\, \\frac{J_{1}(\\eta,r)}{J_{0}(\\eta,r)}$\n    -   洛伦兹数：$L(\\eta) = \\left(\\frac{k_{\\mathrm{B}}}{e}\\right)^{2} \\left[ \\frac{J_{2}(\\eta,r)}{J_{0}(\\eta,r)} - \\left( \\frac{J_{1}(\\eta,r)}{J_{0}(\\eta,r)} \\right)^{2} \\right]$\n    -   电子热导率：$\\kappa_{e}(\\eta) = L(\\eta) \\, \\sigma(\\eta) \\, T$\n\n3.  **$ZT(\\eta)$ 的优化**：使用上述系数和给定的常数 $\\kappa_l$ 构建函数 $ZT(\\eta)$。我们寻求使 $ZT(\\eta)$ 最大化的值 $\\eta_{\\mathrm{opt}}$。这通过一维数值优化程序实现。我们将最小化目标函数的负值，即 $-ZT(\\eta)$。`scipy.optimize.minimize_scalar` 函数及其 `bounded` 方法提供了一种在指定的 $\\eta$ 搜索范围内寻找最大值的稳健而高效的方法。从 $\\eta = -10$ (非简并区) 到 $\\eta = 20$ (重简并区) 的范围足以定位最优值。\n\n4.  **最优载流子浓度的确定**：一旦找到 $\\eta_{\\mathrm{opt}}$，就计算相应的最优载流子浓度 $n(\\eta_{\\mathrm{opt}})$。这需要计算另一个积分，即 $1/2$ 阶的 Fermi-Dirac 积分：\n    $$\n    F_{1/2}(\\eta_{\\mathrm{opt}}) = \\int_{0}^{\\infty} \\frac{\\varepsilon^{1/2}}{1 + \\exp(\\varepsilon - \\eta_{\\mathrm{opt}})} \\, d\\varepsilon\n    $$\n    该积分也通过数值积分计算。然后，载流子浓度由下式给出：\n    $$\n    n(\\eta_{\\mathrm{opt}}) = g_{v} \\, N_{c}(T) \\, F_{1/2}(\\eta_{\\mathrm{opt}})\n    $$\n    其中 $N_c(T)$ 是导带中的有效态密度：\n    $$\n    N_{c}(T) = 2 \\left( \\frac{2 \\pi m^{\\ast} k_{\\mathrm{B}} T}{h^{2}} \\right)^{3/2}\n    $$\n    所有计算都严格使用国际单位制（SI）单位。\n\n5.  **最终格式化**：载流子浓度的最终结果以 $\\mathrm{m^{-3}}$ 为单位计算。必须通过乘以因子 $10^{-6}$ 将其转换为 $\\mathrm{cm^{-3}}$。然后，根据问题规范，将所得数值四舍五入到三位有效数字。此过程被系统地应用于每个提供的测试用例。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Solves for the optimal carrier concentration that maximizes the thermoelectric\n    figure of merit ZT for a set of given material parameters.\n    \"\"\"\n\n    # Physical constants in SI units\n    k_B = 1.380649e-23  # Boltzmann constant in J/K\n    e = 1.602176634e-19   # Elementary charge in C\n    h = 6.62607015e-34    # Planck's constant in J*s\n    m_e = 9.1093837e-31   # Free-electron mass in kg\n\n    # Test cases: (T [K], kappa_l [W/mK], r, Asigma [S/m], m_star [m_e], g_v)\n    test_cases = [\n        (300, 1.5, 0.0, 5.0e4, 1.5, 2),\n        (300, 15.0, 0.0, 5.0e4, 1.5, 2),\n        (800, 2.0, 0.5, 8.0e4, 0.7, 6),\n        (500, 0.5, -0.5, 3.0e4, 2.0, 1),\n        (300, 1.5, 0.0, 5.0e3, 1.0, 2),\n    ]\n\n    results = []\n    for case in test_cases:\n        T, kappa_l, r, A_sigma, m_star_ratio, g_v = case\n        m_star = m_star_ratio * m_e\n\n        # Memoization cache for transport integrals to accelerate optimization\n        memo_integrals = {}\n\n        def get_transport_integrals(eta):\n            \"\"\"Computes the transport integrals J0, J1, J2 for a given eta.\"\"\"\n            if eta in memo_integrals:\n                return memo_integrals[eta]\n\n            # Numerically stable form of -df/d(epsilon)\n            df_de = lambda eps: 1 / (4 * np.cosh((eps - eta) / 2)**2)\n\n            # Define integrands for J_n\n            j0_integrand = lambda eps: eps**(r + 0.5) * df_de(eps)\n            j1_integrand = lambda eps: eps**(r + 0.5) * (eps - eta) * df_de(eps)\n            j2_integrand = lambda eps: eps**(r + 0.5) * (eps - eta)**2 * df_de(eps)\n            \n            # Integration range: A large upper bound is sufficient due to the sharp\n            # decay of the df/de kernel.\n            upper_bound = max(eta + 40, 80)\n\n            J0, _ = quad(j0_integrand, 0, upper_bound)\n            J1, _ = quad(j1_integrand, 0, upper_bound)\n            J2, _ = quad(j2_integrand, 0, upper_bound)\n\n            memo_integrals[eta] = (J0, J1, J2)\n            return J0, J1, J2\n\n        def calculate_zt(eta):\n            \"\"\"Calculates ZT as a function of the reduced chemical potential eta.\"\"\"\n            J0, J1, J2 = get_transport_integrals(eta)\n\n            if J0 <= 1e-12:  # Avoid division by zero for very small J0\n                return 0\n\n            # Electrical conductivity\n            sigma = A_sigma * J0\n            \n            # Seebeck coefficient\n            S = (k_B / e) * (J1 / J0)\n            \n            # Lorenz number\n            L = (k_B / e)**2 * (J2 / J0 - (J1 / J0)**2)\n            \n            # Electronic thermal conductivity\n            kappa_e = L * sigma * T\n            \n            # Figure of merit\n            ZT = (S**2 * sigma * T) / (kappa_e + kappa_l)\n            \n            return ZT\n\n        # Find eta that maximizes ZT by minimizing -ZT.\n        # The search range for eta is chosen to be broad.\n        opt_result = minimize_scalar(lambda eta: -calculate_zt(eta), bounds=(-10, 20), method='bounded')\n        eta_opt = opt_result.x\n\n        # Calculate carrier concentration at the optimal eta\n        # Fermi-Dirac integral of order 1/2\n        f12_integrand = lambda eps: np.sqrt(eps) / (1 + np.exp(eps - eta_opt))\n        F12, _ = quad(f12_integrand, 0, max(eta_opt + 40, 80))\n\n        # Effective density of states\n        Nc = 2 * ((2 * np.pi * m_star * k_B * T) / h**2)**1.5\n\n        # Optimal carrier concentration in m^-3\n        n_opt_m3 = g_v * Nc * F12\n\n        # Convert to cm^-3\n        n_opt_cm3 = n_opt_m3 * 1e-6\n        \n        # Format to 3 significant figures\n        formatted_n = f\"{n_opt_cm3:.3g}\"\n        results.append(formatted_n)\n    \n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2532254"}]}