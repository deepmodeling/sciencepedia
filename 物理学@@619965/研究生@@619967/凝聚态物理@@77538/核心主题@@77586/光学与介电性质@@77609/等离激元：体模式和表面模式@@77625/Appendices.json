{"hands_on_practices": [{"introduction": "理论学习的第一步是掌握其最核心、最基础的模型。本练习将引导你从第一性原理出发，推导金属-电介质界面上表面等离激元的色散关系。通过在静电近似下求解拉普拉斯方程并应用电磁场边界条件，你将亲自揭示表面等离激元存在的关键条件，并计算出其共振频率 [@problem_id:3010379]。这个推导是理解等离激元物理本质的基石。", "problem": "一个半无限德鲁德金属占据半空间 $z<0$，并与一个占据半空间 $z>0$、相对介电常数为 $\\epsilon_{d}$ 的无损耗、无色散的电介质相邻。该金属由带有带间背景的无碰撞德鲁德电介质响应来描述，因此其相对介电常数为 $\\epsilon_{m}(\\omega)=\\epsilon_{\\infty}-\\omega_{p}^{2}/\\omega^{2}$，其中 $\\epsilon_{\\infty}>1$ 表示束缚电荷的高频极化，而 $\\omega_{p}$ 是传导电子的裸等离子体频率。考虑在非推迟（静电）极限下，平面界面 $z=0$ 处的纵向表面电荷振荡，此时沿界面的波长远小于任何电磁推迟尺度。\n\n从每种介质中的静电方程 $\\nabla\\cdot\\left(\\epsilon(\\omega)\\nabla\\phi\\right)=0$ 以及在 $z=0$ 处标量势 $\\phi$ 连续和电位移矢量 $\\mathbf{D}=\\epsilon(\\omega)\\epsilon_{0}\\mathbf{E}$ 的法向分量连续的边界条件出发，推导束缚界面模式的存在条件，并以 $\\omega_{p}$、$\\epsilon_{\\infty}$ 和 $\\epsilon_{d}$ 的形式，求出表面等离激元频率 $\\omega_{s}$ 的闭合形式解析表达式。\n\n将您的最终答案表示为单个闭合形式表达式。无需进行数值计算。", "solution": "首先对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 一个德鲁德金属占据半空间 $z<0$。\n- 一个无损耗、无色散的电介质占据半空间 $z>0$。\n- 金属的相对介电常数为 $\\epsilon_{m}(\\omega)=\\epsilon_{\\infty}-\\omega_{p}^{2}/\\omega^{2}$。\n- 电介质的相对介电常数为 $\\epsilon_{d}$。\n- 约束条件：$\\epsilon_{\\infty}>1$。\n- 系统处于非推迟（静电）极限下。\n- 控制方程为 $\\nabla\\cdot\\left(\\epsilon(\\omega)\\nabla\\phi\\right)=0$。\n- 在界面 $z=0$ 处的边界条件：\n    1. 标量势 $\\phi$ 连续。\n    2. 电位移矢量 $\\mathbf{D}=\\epsilon(\\omega)\\epsilon_{0}\\mathbf{E}$ 的法向分量连续。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据充分**：该问题描述了一个用于研究表面等离激元的经典物理系统。金属介电常数的德鲁德模型、无损耗电介质的假设、静电极限、控制方程以及电磁边界条件都是凝聚态物理和电磁学中的标准和基本概念。该设定是科学合理的。\n- **适定性**：问题陈述清晰，提供了推导表面等离激元频率的唯一表达式所需的所有物理模型、方程和边界条件。它要求进行具体的推导并给出最终的解析表达式，这是一个明确定义的任务。\n- **客观性**：问题使用精确、客观的科学语言表述，没有歧义或主观论断。\n\n### 步骤3：结论与行动\n问题是有效的，因为它科学依据充分、适定、客观、自洽且一致。将推导解答。\n\n问题要求解两种介质界面上纵向表面电荷振荡的频率。我们从给定的静电方程开始，该方程在无源区域成立：\n$$\n\\nabla\\cdot\\left(\\epsilon(\\mathbf{r}, \\omega)\\nabla\\phi(\\mathbf{r}, \\omega)\\right) = 0\n$$\n在此问题中，介电常数 $\\epsilon$ 是频率 $\\omega$ 的函数，但在每个半空间内空间均匀。因此，在每种介质中，该方程简化为标量势 $\\phi$ 的拉普拉斯方程：\n$$\n\\nabla^2\\phi = 0\n$$\n我们正在寻找一种束缚表面模式，这是一种沿界面（在$xy$平面内）传播并从界面向两种介质内部指数衰减的波。由于$xy$平面内的平移对称性，我们可以寻求以下形式的解：\n$$\n\\phi(x, y, z) = f(z) e^{i(k_x x + k_y y)}\n$$\n其中 $\\mathbf{k}_‖ = (k_x, k_y)$是面内波矢。不失一般性，我们将传播方向与$x$轴对齐，因此$k_y=0$，波矢大小为$k_‖ = |k_x|$。于是电势形式为 $\\phi(x, z) = f(z)e^{ik_x x}$。将其代入拉普拉斯方程 $\\left(\\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial z^2}\\right)\\phi = 0$，得到：\n$$\n(-k_x^2 f(z) + \\frac{d^2f(z)}{dz^2})e^{ik_x x} = 0\n$$\n这导出了一个关于$f(z)$的常微分方程：\n$$\n\\frac{d^2f(z)}{dz^2} - k_x^2 f(z) = 0\n$$\n此方程的通解为 $f(z) = A e^{k_x z} + B e^{-k_x z}$。我们必须将此解应用于每种介质，并施加边界条件，即电势在远离界面处消失，即当 $|z| \\to \\infty$ 时 $\\phi \\to 0$。我们假设 $k_x$ 是实数且为正。\n\n在电介质中（$z>0$），当 $z \\to \\infty$ 时电势必须衰减。这要求 $e^{k_x z}$ 项的系数为零。因此，电介质中的电势为：\n$$\n\\phi_d(x, z) = A e^{-k_x z} e^{ik_x x} \\quad \\text{for} \\quad z>0\n$$\n在金属介质中（$z<0$），当 $z \\to -\\infty$ 时电势必须衰减。这要求 $e^{-k_x z}$ 项的系数为零。因此，金属中的电势为：\n$$\n\\phi_m(x, z) = B e^{k_x z} e^{ik_x x} \\quad \\text{for} \\quad z<0\n$$\n现在，我们在界面 $z=0$ 处应用边界条件。\n\n1.  标量势 $\\phi$ 的连续性：\n    $$\n    \\phi_d(x, z=0) = \\phi_m(x, z=0)\n    $$\n    $$\n    A e^0 e^{ik_x x} = B e^0 e^{ik_x x} \\implies A = B\n    $$\n    为简单起见，我们可以设 $B=A$。\n\n2.  电位移矢量 $\\mathbf{D}$ 法向分量的连续性。法向是 $z$ 方向。$D_z$ 分量由 $D_z = \\epsilon(\\omega) \\epsilon_0 E_z = -\\epsilon(\\omega) \\epsilon_0 \\frac{\\partial\\phi}{\\partial z}$ 给出。边界条件为：\n    $$\n    \\epsilon_d \\epsilon_0 \\frac{\\partial\\phi_d}{\\partial z}\\bigg|_{z=0} = \\epsilon_m(\\omega) \\epsilon_0 \\frac{\\partial\\phi_m}{\\partial z}\\bigg|_{z=0}\n    $$\n    常数 $\\epsilon_0$ 可以消去。我们来计算导数：\n    $$\n    \\frac{\\partial\\phi_d}{\\partial z} = -k_x A e^{-k_x z} e^{ik_x x} \\implies \\frac{\\partial\\phi_d}{\\partial z}\\bigg|_{z=0} = -k_x A e^{ik_x x}\n    $$\n    $$\n    \\frac{\\partial\\phi_m}{\\partial z} = k_x A e^{k_x z} e^{ik_x x} \\implies \\frac{\\partial\\phi_m}{\\partial z}\\bigg|_{z=0} = k_x A e^{ik_x x}\n    $$\n    将这些代入边界条件，得到：\n    $$\n    \\epsilon_d (-k_x A e^{ik_x x}) = \\epsilon_m(\\omega) (k_x A e^{ik_x x})\n    $$\n    为使非平庸解存在，必须有 $A \\neq 0$ 且 $k_x \\neq 0$。因此我们可以将两边同除以 $-k_x A e^{ik_x x}$：\n    $$\n    \\epsilon_d = -\\epsilon_m(\\omega)\n    $$\n    关系式 $\\epsilon_d + \\epsilon_m(\\omega) = 0$ 是静电极限下两种介质界面上表面等离激元模式存在的普适条件。为了存在束缚模式，我们要求介电常数符号相反。由于电介质的 $\\epsilon_d > 0$，我们必须有 $\\epsilon_m(\\omega) < 0$，这是金属在其等离子体频率以下的特性。\n\n为求得表面等离激元频率 $\\omega_s$，我们将给定的金属介电常数表达式 $\\epsilon_{m}(\\omega)=\\epsilon_{\\infty}-\\omega_{p}^{2}/\\omega^{2}$ 代入存在条件。设 $\\omega_s$ 是满足此条件的频率：\n$$\n\\epsilon_d + \\left(\\epsilon_{\\infty} - \\frac{\\omega_p^2}{\\omega_s^2}\\right) = 0\n$$\n重新整理各项以求解 $\\omega_s$：\n$$\n\\epsilon_d + \\epsilon_{\\infty} = \\frac{\\omega_p^2}{\\omega_s^2}\n$$\n$$\n\\omega_s^2 = \\frac{\\omega_p^2}{\\epsilon_{\\infty} + \\epsilon_d}\n$$\n取平方根，得到表面等离激元频率的最终表达式：\n$$\n\\omega_s = \\frac{\\omega_p}{\\sqrt{\\epsilon_{\\infty} + \\epsilon_d}}\n$$\n由于 $\\epsilon_d>0$ 且 $\\epsilon_{\\infty}>1$，分母为实数且大于1，这确保了 $\\omega_s < \\omega_p$。条件 $\\epsilon_m(\\omega_s) = -\\epsilon_d < 0$ 得到满足，证实了解的物理一致性。", "answer": "$$\n\\boxed{\\frac{\\omega_{p}}{\\sqrt{\\epsilon_{\\infty} + \\epsilon_{d}}}}\n$$", "id": "3010379"}, {"introduction": "在理解了界面上的等离激元后，我们转向其在材料内部的对应物——体等离激元。本练习将带你进入多体物理的范畴，使用随机相位近似 (RPA) 来探索电子气的集体行为。你的任务是计算体等离激元色散关系的第一个修正项，即频率如何随波矢 $q$ 变化 [@problem_id:3010353]。这个练习不仅能让你熟练掌握 Lindhard 函数在长波极限下的应用，还能让你深刻理解集体激发模式的动量依赖性。", "problem": "考虑一个温度为零、数密度为 $n$ 的三维均匀电子气，其具有各向同性的抛物色散关系 $\\epsilon_{\\mathbf{k}}=\\hbar^{2}k^{2}/(2m)$、费米波矢 $k_{F}$ 和费米速度 $v_{F}=\\hbar k_{F}/m$。电子在一个均匀正背景中运动，该背景的特点是具有一个与频率无关的背景介电常数 $\\varepsilon_{b}$（国际单位制）。在随机相位近似（RPA）中，纵向介电函数为\n$$\n\\varepsilon(\\omega,q)=1-V_{q}\\,\\Pi^{0}(\\omega,q),\n$$\n其中 $V_{q}=e^{2}/(\\varepsilon_{b}q^{2})$ 是库仑相互作用的傅里叶变换，$\\Pi^{0}(\\omega,q)$ 是无相互作用的密度-密度响应函数（林哈德函数），在零温下其定义为\n$$\n\\Pi^{0}(\\omega,q)=2\\int \\frac{d^{3}k}{(2\\pi)^{3}}\\;\\frac{f(\\epsilon_{\\mathbf{k}})-f(\\epsilon_{\\mathbf{k}+\\mathbf{q}})}{\\hbar\\omega+\\epsilon_{\\mathbf{k}}-\\epsilon_{\\mathbf{k}+\\mathbf{q}}+i0^{+}},\n$$\n其中 $f(\\epsilon)$ 是费米-狄拉克分布。在无碰撞长波机制 $q\\ll k_{F}$ 和 $\\omega\\gg q v_{F}$ 下，求解 $\\varepsilon(\\omega,q)=0$ 以获得纵向等离激元色散关系 $\\omega_{p}(q)$，并计算其小 $q$ 展开至 $q^{2}$ 阶（包括 $q^2$ 阶）。你可以引入由 $\\omega_{p}^{2}=n e^{2}/(m\\varepsilon_{b})$ 定义的体等离激元频率 $\\omega_{p}$。请用 $\\omega_{p}$、$v_{F}$ 和 $q$ 表示你的最终答案，形式为一个单闭合解析表达式。请勿进行数值计算；仅给出符号表达式。", "solution": "本题要求解在小波矢极限下，三维均匀电子气的纵向等离激元色散关系 $\\omega_{p}(q)$，展开至 $q^{2}$ 阶。色散关系通过求解方程 $\\varepsilon(\\omega, q) = 0$ 得到，其中 $\\varepsilon(\\omega, q)$ 是随机相位近似（RPA）下的纵向介电函数。\n\n给定的介电函数为：\n$$ \\varepsilon(\\omega,q)=1-V_{q}\\,\\Pi^{0}(\\omega,q) $$\n其中 $V_{q}=e^{2}/(\\varepsilon_{b}q^{2})$ 是库仑相互作用的傅里叶分量，$\\Pi^{0}(\\omega,q)$ 是在零温 $T=0$ 下的无相互作用的密度-密度响应函数（林哈德函数）。\n\n条件 $\\varepsilon(\\omega, q) = 0$ 意味着：\n$$ 1 = V_{q}\\,\\Pi^{0}(\\omega,q) = \\frac{e^2}{\\varepsilon_{b}q^2} \\Pi^{0}(\\omega,q) $$\n为了求解 $\\omega(q)$，我们必须首先在由 $q\\ll k_{F}$ 和 $\\omega\\gg q v_{F}$ 定义的指定长波、高频机制下，找到 $\\Pi^{0}(\\omega,q)$ 的一个合适的表达式。林哈德函数由下式给出：\n$$ \\Pi^{0}(\\omega,q)=2\\int \\frac{d^{3}k}{(2\\pi)^{3}}\\;\\frac{f(\\epsilon_{\\mathbf{k}})-f(\\epsilon_{\\mathbf{k}+\\mathbf{q}})}{\\hbar\\omega+\\epsilon_{\\mathbf{k}}-\\epsilon_{\\mathbf{k}+\\mathbf{q}}+i0^{+}} $$\n在零温下，费米-狄拉克分布 $f(\\epsilon_{\\mathbf{k}})$ 是一个阶跃函数，当 $\\epsilon_{\\mathbf{k}} < \\epsilon_F$（即 $k < k_F$）时为1，当 $\\epsilon_{\\mathbf{k}} > \\epsilon_F$ 时为0。在此极限下，可以从线性化的弗拉索夫方程推导出一个更易于处理的 $\\Pi^0$ 形式，其给出：\n$$ \\Pi^{0}(\\omega,q) = 2 \\int \\frac{d^3k}{(2\\pi)^3} \\left(-\\frac{df(\\epsilon_{\\mathbf{k}})}{d\\epsilon_{\\mathbf{k}}}\\right) \\frac{(\\mathbf{q}\\cdot\\mathbf{v}_{\\mathbf{k}})^{2}}{\\omega^2 - (\\mathbf{q}\\cdot\\mathbf{v}_{\\mathbf{k}})^2} $$\n其中 $\\mathbf{v}_{\\mathbf{k}} = \\frac{1}{\\hbar}\\nabla_{\\mathbf{k}}\\epsilon_{\\mathbf{k}} = \\frac{\\hbar\\mathbf{k}}{m}$。\n在 $\\omega \\gg qv_F \\ge qv_k$ 的极限下，我们可以展开分母：\n$$ \\frac{1}{\\omega^2 - (\\mathbf{q}\\cdot\\mathbf{v}_{\\mathbf{k}})^2} = \\frac{1}{\\omega^2} \\left(1 - \\left(\\frac{\\mathbf{q}\\cdot\\mathbf{v}_{\\mathbf{k}}}{\\omega}\\right)^2\\right)^{-1} \\approx \\frac{1}{\\omega^2}\\left(1 + \\left(\\frac{\\mathbf{q}\\cdot\\mathbf{v}_{\\mathbf{k}}}{\\omega}\\right)^2 + \\dots \\right) $$\n将此代入 $\\Pi^{0}(\\omega,q)$ 的积分中：\n$$ \\Pi^0(\\omega,q) \\approx 2 \\int \\frac{d^3k}{(2\\pi)^3} \\left(-\\frac{df}{d\\epsilon_k}\\right) \\left[ \\frac{(\\mathbf{q}\\cdot\\mathbf{v_k})^2}{\\omega^2} + \\frac{(\\mathbf{q}\\cdot\\mathbf{v_k})^4}{\\omega^4} + \\dots \\right] $$\n在零温下，$-\\frac{df}{d\\epsilon_k} = \\delta(\\epsilon_k - \\epsilon_F)$。因此积分被限制在费米面上，其中 $k=k_F$ 且 $v_k=v_F$。我们来计算各项。\n\n第一项是：\n$$ \\Pi^0_{(1)} = \\frac{2}{\\omega^2} \\int \\frac{d^3k}{(2\\pi)^3} \\delta(\\epsilon_k - \\epsilon_F) (\\mathbf{q}\\cdot\\mathbf{v_k})^2 $$\n设 $\\mathbf{q}$ 的方向为 $z$ 轴。那么 $\\mathbf{q}\\cdot\\mathbf{v_k} = qv_k \\cos\\theta$。对于 $k=k_F$，这便是 $qv_F\\cos\\theta$。\n对 delta 函数的积分给出了费米能级处的态密度，$D(\\epsilon_F) = 2 \\int \\frac{d^3k}{(2\\pi)^3} \\delta(\\epsilon_k - \\epsilon_F) = \\frac{mk_F}{\\pi^2\\hbar^2}$。\n速度项必须在费米面上进行平均：$\\langle (\\mathbf{q}\\cdot\\mathbf{v_k})^2 \\rangle_{FS} = \\langle q^2v_F^2\\cos^2\\theta \\rangle = q^2v_F^2 \\frac{\\int \\cos^2\\theta d\\Omega}{\\int d\\Omega} = q^2v_F^2 \\frac{4\\pi/3}{4\\pi}=\\frac{1}{3}q^2v_F^2$。\n所以，$\\Pi^0_{(1)} = \\frac{1}{\\omega^2} D(\\epsilon_F) \\frac{1}{3}q^2v_F^2 = \\frac{1}{\\omega^2} \\frac{mk_F}{\\pi^2\\hbar^2} \\frac{1}{3}q^2 \\left(\\frac{\\hbar k_F}{m}\\right)^2 = \\frac{k_F^3 q^2}{3\\pi^2 m \\omega^2}$。\n使用电子密度关系 $n = k_F^3/(3\\pi^2)$，我们得到：\n$$ \\Pi^0_{(1)} = \\frac{nq^2}{m\\omega^2} $$\n这是 $\\Pi^0(\\omega,q)$ 的领头项。\n\n展开式中的第二项是：\n$$ \\Pi^0_{(2)} = \\frac{2}{\\omega^4} \\int \\frac{d^3k}{(2\\pi)^3} \\delta(\\epsilon_k - \\epsilon_F) (\\mathbf{q}\\cdot\\mathbf{v_k})^4 = \\frac{D(\\epsilon_F)}{\\omega^4} \\langle(\\mathbf{q}\\cdot\\mathbf{v_k})^4\\rangle_{FS} $$\n角度平均为 $\\langle(\\mathbf{q}\\cdot\\mathbf{v_k})^4\\rangle_{FS} = \\langle q^4v_F^4\\cos^4\\theta \\rangle = q^4v_F^4 \\frac{\\int\\cos^4\\theta d\\Omega}{\\int d\\Omega} = q^4v_F^4 \\frac{4\\pi/5}{4\\pi} = \\frac{1}{5}q^4v_F^4$。\n因此，$\\Pi^0_{(2)} = \\frac{D(\\epsilon_F)}{\\omega^4} \\frac{1}{5}q^4v_F^4 = \\frac{mk_F}{\\pi^2\\hbar^2\\omega^4}\\frac{1}{5}q^4v_F^4 = \\frac{mk_F q^4}{5\\pi^2\\hbar^2\\omega^4} \\left(\\frac{\\hbar k_F}{m}\\right)^4 = \\frac{k_F^5 \\hbar^2 q^4}{5\\pi^2 m^3 \\omega^4}$。\n使用 $n=k_F^3/(3\\pi^2)$ 和 $v_F=\\hbar k_F/m$：\n$$ \\Pi^0_{(2)} = \\frac{(3\\pi^2 n) k_F^2 \\hbar^2 q^4}{5\\pi^2 m^3 \\omega^4} = \\frac{3n q^4}{5 m \\omega^4} \\frac{\\hbar^2 k_F^2}{m^2} = \\frac{3nq^4v_F^2}{5m\\omega^4} $$\n合并各项，得到 $\\Pi^0(\\omega,q)$ 的展开式为：\n$$ \\Pi^0(\\omega,q) \\approx \\frac{nq^2}{m\\omega^2} + \\frac{3nq^4v_F^2}{5m\\omega^4} = \\frac{nq^2}{m\\omega^2}\\left(1 + \\frac{3q^2v_F^2}{5\\omega^2}\\right) $$\n现在，我们将此代入等离激元条件 $1 = \\frac{e^2}{\\varepsilon_{b}q^2}\\Pi^0(\\omega,q)$:\n$$ 1 = \\frac{e^2}{\\varepsilon_{b}q^2} \\cdot \\frac{nq^2}{m\\omega^2}\\left(1 + \\frac{3q^2v_F^2}{5\\omega^2}\\right) $$\n$$ 1 = \\frac{ne^2}{m\\varepsilon_{b}\\omega^2}\\left(1 + \\frac{3q^2v_F^2}{5\\omega^2}\\right) $$\n使用体等离激元频率的定义 $\\omega_{p}^{2} = ne^2/(m\\varepsilon_{b})$：\n$$ 1 = \\frac{\\omega_{p}^2}{\\omega^2}\\left(1 + \\frac{3q^2v_F^2}{5\\omega^2}\\right) $$\n这给出了色散关系 $\\omega(q)$ 的一个隐式方程：\n$$ \\omega^2 = \\omega_{p}^2\\left(1 + \\frac{3q^2v_F^2}{5\\omega^2}\\right) $$\n为了找到小 $q$ 展开，我们可以迭代地求解此方程。在最低阶（$q=0$）时，我们有 $\\omega^2 = \\omega_p^2$，因此 $\\omega(0) = \\omega_p$。\n对于下一阶项，我们可以在修正项（已经是 $q^2$ 阶）中用其零阶值 $\\omega \\approx \\omega_p$ 来近似 $\\omega$。\n$$ \\omega(q)^2 \\approx \\omega_{p}^2\\left(1 + \\frac{3q^2v_F^2}{5\\omega_{p}^2}\\right) = \\omega_{p}^2 + \\frac{3}{5}q^2v_F^2 $$\n题目要求将 $\\omega_p(q)$ 展开到 $q^2$ 阶。我们对上述表达式取平方根：\n$$ \\omega_p(q) = \\sqrt{\\omega_{p}^2 + \\frac{3}{5}q^2v_F^2} = \\omega_{p}\\left(1 + \\frac{3q^2v_F^2}{5\\omega_{p}^2}\\right)^{1/2} $$\n对小 $x$ 使用二项式展开 $(1+x)^{1/2} \\approx 1 + \\frac{1}{2}x$：\n$$ \\omega_p(q) \\approx \\omega_{p}\\left(1 + \\frac{1}{2} \\cdot \\frac{3q^2v_F^2}{5\\omega_{p}^2}\\right) = \\omega_{p} + \\frac{3}{10}\\frac{v_F^2 q^2}{\\omega_{p}} $$\n这就是展开到 $q$ 的二阶的等离激元色散关系。", "answer": "$$\\boxed{\\omega_{p} + \\frac{3 v_{F}^{2}}{10 \\omega_{p}} q^{2}}$$", "id": "3010353"}, {"introduction": "理论模型最终需要与实验数据相结合才能发挥其预测能力。这个动手实践项目将让你扮演一名研究科学家的角色，使用真实的合成光学数据来构建和验证金属的介电函数模型。你将通过拟合给定的数据，确定 Drude-Lorentz 模型的参数，并用此模型预测在不同条件下表面等离激元-极化激元 (SPP) 的行为 [@problem_id:3010327]。这项练习旨在弥合理论与实践之间的鸿沟，让你体验如何从实验测量中提炼物理参数并进行定量预测。", "problem": "考虑一个由频率相关的介电函数表征的半无限金属和一个具有恒定介电常数的半无限电介质。您将使用一个合成的光学椭偏光谱数据集，该数据集包含金属的复介电函数随光子能量的变化。您的任务是基于带电振子图像为金属介电函数构建一个有物理基础的模型，通过拟合数据集来估计其参数，然后使用拟合的介电函数预测在金属-电介质界面上的表面等离激元极化子（SPP）的色散关系。您必须实现三种模型以突出高频介电常数和带间跃迁的作用：(i) 一个包含高频常数和一个带间洛伦兹振子的完整 Drude-Lorentz 模型，(ii) 一个高频常数固定为1的仅德鲁德模型，以及 (iii) 一个具有自由高频常数的仅德鲁德模型。\n\n使用的基本理论基础：\n- 线性、均匀、各向同性介质中的麦克斯韦方程组，以及场在平面界面上的相关边界条件。\n- 由电场引起的极化的线性响应理论，该理论通过受谐和力与阻尼作用的束缚和自由经典电荷集合进行建模。\n- 定义了电极化率和介电函数的极化与电场之间的本构关系。\n- 从电磁边界条件推导出的平坦界面上存在束缚表面等离激元极化子模式的条件。\n\n数据与单位：\n- 光子能量网格（单位：电子伏特）：$E = [1.2, 1.5, 1.8, 2.1, 2.4, 2.7, 3.0]$。\n- 在这些光子能量下测得的金属复介电函数值，以 $[\\operatorname{Re}\\,\\epsilon_m(E), \\operatorname{Im}\\,\\epsilon_m(E)]$ 对的形式给出：\n  - $1.2\\,\\mathrm{eV}$: $[-49.690,\\ 3.616]$\n  - $1.5\\,\\mathrm{eV}$: $[-29.357,\\ 2.283]$\n  - $1.8\\,\\mathrm{eV}$: $[-18.187,\\ 2.114]$\n  - $2.1\\,\\mathrm{eV}$: $[-11.770,\\ 2.833]$\n  - $2.4\\,\\mathrm{eV}$: $[-9.051,\\ 3.349]$\n  - $2.7\\,\\mathrm{eV}$: $[-7.278,\\ 2.154]$\n  - $3.0\\,\\mathrm{eV}$: $[-5.152,\\ 1.172]$\n- 在计算 SPP 色散时，应使用国际单位制（SI）的物理常数：\n  - 光速 $c$ 单位为 $\\mathrm{m/s}$。\n  - 基本电荷 $e$ 单位为 $\\mathrm{C}$。\n  - 约化普朗克常数 $\\hbar$ 单位为 $\\mathrm{J\\,s}$。\n- 非金属部分的介电常数被认为是实数且与频率无关，记为 $\\epsilon_d$（无量纲）。\n\n建模与拟合任务：\n1. 为金属构建一个因果、线性响应的介电函数模型，包含以下三种变体：\n   (a) 完整的 Drude-Lorentz 模型，包括一个高频常数贡献、一个单一的带间洛伦兹振子以及一个自由电子德鲁德项。该模型由一个无量纲的高频常数 $\\epsilon_\\infty$、一个德鲁德等离子体能量（单位：电子伏特）、一个德鲁德阻尼能量（单位：电子伏特）、一个洛伦兹振子强度（无量纲）、一个洛伦兹共振能量（单位：电子伏特）和一个洛伦兹阻尼能量（单位：电子伏特）参数化。\n   (b) 仅德鲁德模型，其中 $\\epsilon_\\infty$ 固定为无量纲值 $1$ 且无洛伦兹振子，由一个德鲁德等离子体能量（单位：电子伏特）和一个德鲁德阻尼能量（单位：电子伏特）参数化。\n   (c) 仅德鲁德模型，其中 $\\epsilon_\\infty$ 为自由参数且无洛伦兹振子，由无量纲的 $\\epsilon_\\infty$、一个德鲁德等离子体能量（单位：电子伏特）和一个德鲁德阻尼能量（单位：电子伏特）参数化。\n2. 通过最小化模型复介电函数与测量值在能量网格上的残差平方和，将每个模型的参数与所提供的数据集进行拟合。残差必须包括每个能量点的实部和虚部。确保所有代表能量或阻尼的受物理约束的参数严格为正，并且振子强度为非负。高频常数 $\\epsilon_\\infty$ 必须为正。\n3. 使用每个模型的拟合介电函数，通过求解由麦克斯韦方程组和边界条件所蕴含的色散关系，计算金属与介电常数为 $\\epsilon_d$ 的电介质之间平坦界面上的 SPP 面内波矢 $k_x(\\omega)$。结果用有效折射率 $n_{\\mathrm{eff}}(\\omega)$ 表示，其定义为 $n_{\\mathrm{eff}}(\\omega) = \\operatorname{Re}\\left\\{\\frac{c\\,k_x(\\omega)}{\\omega}\\right\\}$。此处，角频率 $\\omega$（单位：rad/s）与光子能量 $E$（单位：eV）的关系为 $\\omega = E\\,e/\\hbar$。有效折射率为无量纲量。\n4. 测试套件和输出：对于以下测试用例，其中电介质部分的介电常数为 $\\epsilon_d$（无量纲），光子能量为 $E$（单位：电子伏特），计算三个模型中每一个的 $n_{\\mathrm{eff}}$：\n   - 用例 A: $\\epsilon_d = 1.0$, $E = 1.55$。\n   - 用例 B: $\\epsilon_d = 2.25$, $E = 2.00$。\n   - 用例 C: $\\epsilon_d = 3.06, $E = 2.75$。\n   对于每个用例，按以下顺序生成对应于三个模型的结果：完整 Drude-Lorentz 模型、$\\epsilon_\\infty = 1$ 的仅德鲁德模型、自由 $\\epsilon_\\infty$ 的仅德鲁德模型。\n\n算法和数值要求：\n- 通过将实部和虚部残差堆叠成一个单一的实数向量目标，对复值数据集执行非线性最小二乘拟合。使用数值稳定的方法处理复数算术。\n- 确保参数具有如上所述的物理意义的边界。\n- 一致地处理复数平方根，为 $n_{\\mathrm{eff}}$ 选择具有非负实部的物理相关分支。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含九个结果，以逗号分隔的列表形式包含在方括号内，按测试用例（A、B、C）排序，并在每个用例内部按模型（完整 Drude-Lorentz、$\\epsilon_\\infty = 1$ 的仅德鲁德模型、自由 $\\epsilon_\\infty$ 的仅德鲁德模型）排序。\n- 每个浮点数必须四舍五入到六位小数。\n- 最终输出行必须类似于：\"[x1,x2,x3,x4,x5,x6,x7,x8,x9]\"，其中 $x_i$ 是按指定顺序排列的对应于有效折射率的六位小数浮点数。\n\n所有介电函数都是无量纲的，光子能量必须以电子伏特为单位提供，角频率以弧度/秒为单位，有效折射率为无量纲。此问题不涉及角度。不涉及百分比；所有数值结果必须以十进制表示法给出。", "solution": "用户提供的问题被评估为有效。该问题在科学上是合理的、适定的、客观的，并包含了获得唯一解所需的所有必要信息。其任务涉及对金属的光学特性进行建模，将这些模型与提供的数据进行拟合，然后使用拟合后的模型预测表面等离激元极化子（SPP）在金属-电介质界面上的行为。这是凝聚态物理和纳米光子学中一个标准的、在概念上具有重要意义的问题。\n\n### 1. 理论框架：金属的介电函数\n\n金属对外部电磁场的响应由其频率相关的复介电函数 $\\epsilon_m(\\omega)$ 来表征。该函数可以通过考虑电子的集体运动进行物理建模。这些电子大致可分为两类：“自由”导电电子和“束缚”核心电子。\n\n#### 1.1 自由电子的 Drude 模型\n\nDrude 模型将导电电子作为受阻尼力（代表散射事件）作用的自由电子气，提供了一个经典描述。电荷为 $-e$ 且有效质量为 $m^*$ 的电子在电场 $\\vec{E}(t) = \\vec{E}_0 e^{-i\\omega t}$ 中的运动方程为：\n$$ m^* \\frac{d^2\\vec{r}}{dt^2} + m^*\\gamma_D \\frac{d\\vec{r}}{dt} = -e \\vec{E}(t) $$\n此处，$\\gamma_D$ 是阻尼率或碰撞频率。求解稳态位移 $\\vec{r}(t)$ 可得到感生极化 $\\vec{P} = -ne\\vec{r} = \\epsilon_0 \\chi(\\omega) \\vec{E}$，其中 $n$ 是电子密度。由此产生的电极化率 $\\chi_{Drude}(\\omega)$ 给出了介电函数 $\\epsilon(\\omega) = 1 + \\chi(\\omega)$ 的 Drude 贡献：\n$$ \\epsilon_{Drude}(\\omega) = 1 - \\frac{\\omega_p^2}{\\omega^2 + i\\gamma_D \\omega} $$\n其中 $\\omega_p = \\sqrt{ne^2/(m^*\\epsilon_0)}$ 是等离子体频率。在高频下，来自束缚核心电子的贡献变得显著。这通过一个常数偏移量 $\\epsilon_\\infty$ 来解释，它代表了在远高于所考虑的等离子体频率和共振频率的频率下，所有其他极化机制贡献的介电常数。广义 Drude 模型为：\n$$ \\epsilon_m(\\omega) = \\epsilon_\\infty - \\frac{\\omega_p^2}{\\omega^2 + i\\gamma_D \\omega} $$\n在实现上，使用光子能量 $E = \\hbar\\omega$ 进行计算很方便。定义相应的能量参数 $E_p = \\hbar\\omega_p$ 和 $\\Gamma_D = \\hbar\\gamma_D$，方程变为：\n$$ \\epsilon_m(E) = \\epsilon_\\infty - \\frac{E_p^2}{E^2 + i E \\Gamma_D} $$\n\n#### 1.2 束缚电子的 Lorentz 模型\n\n带间跃迁，即电子从一个填充带激发到一个空带，可以经典地建模为一组阻尼谐振子。一个共振频率为 $\\omega_L$、阻尼率为 $\\gamma_L$ 的束缚电子的运动方程为：\n$$ m \\frac{d^2\\vec{r}}{dt^2} + m\\gamma_L \\frac{d\\vec{r}}{dt} + m\\omega_L^2 \\vec{r} = -e \\vec{E}(t) $$\n这导出了洛伦兹极化率：\n$$ \\chi_{Lorentz}(\\omega) = \\frac{\\omega_{p,L}^2}{\\omega_L^2 - \\omega^2 - i\\gamma_L \\omega} $$\n其中 $\\omega_{p,L,j}$ 是与这些束缚振子密度相关的等离子体频率。\n\n#### 1.3 组合的 Drude-Lorentz 模型\n\n一个更完整的真实金属模型结合了这些效应。总介电函数是高频常数、自由电子 Drude 响应以及一个或多个用于带间跃迁的洛伦兹振子之和：\n$$ \\epsilon_m(\\omega) = \\epsilon_\\infty - \\frac{\\omega_p^2}{\\omega^2 + i\\gamma_D \\omega} + \\sum_j \\frac{S_j \\omega_{L,j}^2}{\\omega_{L,j}^2 - \\omega^2 - i\\gamma_L \\omega} $$\n参数 $S_j$ 是第 j 个振子的无量纲强度，与 $\\omega_{p,L,j}$ 相关。用能量表示，包含一个洛伦兹振子的完整模型为：\n$$ \\epsilon_m(E) = \\epsilon_\\infty - \\frac{E_p^2}{E^2 + i E \\Gamma_D} + \\frac{S_L E_L^2}{E_L^2 - E^2 - i E \\Gamma_L} $$\n\n### 2. 通过最小二乘拟合进行参数估计\n\n问题指明了该模型的三种变体：\n(a) 完整 Drude-Lorentz 模型：参数 $(\\epsilon_\\infty, E_p, \\Gamma_D, S_L, E_L, \\Gamma_L)$。\n(b) 仅 Drude 模型，$\\epsilon_\\infty \\equiv 1$：参数 $(E_p, \\Gamma_D)$。\n(c) 仅 Drude 模型，自由 $\\epsilon_\\infty$：参数 $(\\epsilon_\\infty, E_p, \\Gamma_D)$。\n\n为了确定每个模型的最优参数，我们将模型函数 $\\epsilon_{model}(E; \\vec{p})$ 与提供的实验数据 $(\\{E_j\\}, \\{\\epsilon_{data}(E_j)\\})$ 进行拟合。拟合通过最小化模型与数据之间的残差平方和（SSR）来执行。由于 $\\epsilon_m$ 是复数，目标函数在其-部和虛部上都被定义：\n$$ \\mathrm{SSR}(\\vec{p}) = \\sum_j \\left[ (\\operatorname{Re}\\{\\epsilon_{model}(E_j; \\vec{p})\\} - \\operatorname{Re}\\{\\epsilon_{data}(E_j)\\})^2 + (\\operatorname{Im}\\{\\epsilon_{model}(E_j; \\vec{p})\\} - \\operatorname{Im}\\{\\epsilon_{data}(E_j)\\})^2 \\right] $$\n这等效于最小化复残差向量的 L2 范数的平方，即 $||\\vec{\\epsilon}_{model} - \\vec{\\epsilon}_{data}||^2$。这个非线性最小二乘问题使用优化算法（例如 Levenberg-Marquardt）进行数值求解，并受到参数的物理约束（例如，能量和阻尼必须为正）。\n\n### 3. 表面等离激元极化子（SPP）色散\n\nSPP 是一种横磁（TM）表面电磁波，沿着金属（介电函数为 $\\epsilon_m(\\omega)$）和电介质（介电常数为 $\\epsilon_d$）之间的界面传播。其存在条件和色散关系是通过求解麦克斯韦方程组以及界面处场的连续性边界条件得出的。这得出了面内波矢 $k_x$ 的 SPP 色散关系：\n$$ k_x(\\omega) = \\frac{\\omega}{c} \\sqrt{\\frac{\\epsilon_m(\\omega) \\epsilon_d}{\\epsilon_m(\\omega) + \\epsilon_d}} $$\n为了使低损耗的 SPP 存在，通常需要满足两个条件：$\\operatorname{Re}\\{\\epsilon_m\\} < -\\epsilon_d$ 且 $\\operatorname{Im}\\{\\epsilon_m\\}$ 必须小且为正。有效折射率 $n_{\\mathrm{eff}}$ 是一个无量纲量，描述了 SPP 相对于真空光速的相速度：\n$$ n_{\\mathrm{eff}}(\\omega) = \\frac{c k_x(\\omega)}{\\omega} $$\n代入 $k_x(\\omega)$ 的表达式，我们得到：\n$$ n_{\\mathrm{eff}}(\\omega) = \\sqrt{\\frac{\\epsilon_m(\\omega) \\epsilon_d}{\\epsilon_m(\\omega) + \\epsilon_d}} $$\n由于 $\\epsilon_m(\\omega)$ 是复数，$k_x$ 和 $n_{\\mathrm{eff}}$ 也是复数。实部 $\\operatorname{Re}\\{n_{\\mathrm{eff}}\\}$ 决定了相速度，而虚部则与传播损耗有关。问题要求计算 $\\operatorname{Re}\\{n_{\\mathrm{eff}}\\}$，其中复数平方根的分支被选择为具有非负实部的分支，这对应于物理上有意义的前向传播波或倏逝衰减波。\n\n### 4. 算法实现\n\n解决方案的实现如下：\n1.  **模型定义**：创建三个 Python 函数，分别对应问题中指定的三种介电模型。这些函数接受光子能量 $E$（单位：eV）和一个参数向量作为输入，并返回复介电常数 $\\epsilon_m(E)$。\n2.  **拟合**：为每个模型定义一个残差函数，用于计算模型预测与实验数据之间差异的向量，并堆叠成一个实值数组 `[Re(diff_1), Im(diff_1), ...]`。使用 `scipy.optimize.least_squares` 函数找到使这些残差平方和最小化的参数向量。提供了有物理动机的初始猜测和边界，以确保收敛到有意义的解。\n3.  **SPP 计算**：实现了一个 `calculate_neff` 函数。它接受光子能量 $E$、电介质的介电常数 $\\epsilon_d$、所选的模型函数及其拟合参数作为输入。它计算 $\\epsilon_m(E)$，然后评估 $n_{\\mathrm{eff}}(\\omega)$ 的表达式，并返回其实部。\n4.  **执行**：主脚本首先对所有三个模型执行拟合程序，以获得三组优化的参数。然后，它遍历指定的测试用例（A、B、C）。对于每个用例，它使用三个拟合模型中的每一个来计算 $\\operatorname{Re}\\{n_{\\mathrm{eff}}\\}$。将得到的九个值收集起来，并按要求格式化为单个字符串。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Solves the plasmonics problem by fitting dielectric models and calculating SPP effective indices.\n    \"\"\"\n\n    # --- Dielectric Function Models ---\n    # The models accept energy E in eV and parameters are also in eV where applicable.\n\n    def model_a(E, params):\n        \"\"\"Full Drude-Lorentz model.\"\"\"\n        eps_inf, E_p, Gamma_D, S_L, E_L, Gamma_L = params\n        E = np.asarray(E, dtype=complex)\n        E2 = E**2\n        \n        drude_term = E_p**2 / (E2 + 1j * E * Gamma_D)\n        lorentz_term = (S_L * E_L**2) / (E_L**2 - E2 - 1j * E * Gamma_L)\n        \n        return eps_inf - drude_term + lorentz_term\n\n    def model_b(E, params):\n        \"\"\"Drude-only model with eps_inf = 1.\"\"\"\n        E_p, Gamma_D = params\n        E = np.asarray(E, dtype=complex)\n        E2 = E**2\n        \n        drude_term = E_p**2 / (E2 + 1j * E * Gamma_D)\n        \n        return 1.0 - drude_term\n\n    def model_c(E, params):\n        \"\"\"Drude-only model with free eps_inf.\"\"\"\n        eps_inf, E_p, Gamma_D = params\n        E = np.asarray(E, dtype=complex)\n        E2 = E**2\n        \n        drude_term = E_p**2 / (E2 + 1j * E * Gamma_D)\n        \n        return eps_inf - drude_term\n\n    # --- Residual Functions for Fitting ---\n\n    def residuals(params, E_data, eps_data, model_func):\n        \"\"\"Generic residuals function.\"\"\"\n        eps_model = model_func(E_data, params)\n        diff = eps_model - eps_data\n        return np.concatenate((diff.real, diff.imag))\n\n    # --- SPP Effective Index Calculation ---\n\n    def calculate_neff(E, eps_d, model_func, params):\n        \"\"\"Calculates the SPP effective index n_eff.\"\"\"\n        eps_m = model_func(E, params)\n        arg = (eps_m * eps_d) / (eps_m + eps_d)\n        n_eff_complex = np.sqrt(arg.astype(np.complex128))\n        return n_eff_complex.real\n\n    # --- Data and Constants ---\n    E_data = np.array([1.2, 1.5, 1.8, 2.1, 2.4, 2.7, 3.0])\n    eps_data = np.array([\n        -49.690 + 3.616j, -29.357 + 2.283j, -18.187 + 2.114j,\n        -11.770 + 2.833j, -9.051 + 3.349j,  -7.278 + 2.154j,\n        -5.152 + 1.172j\n    ])\n\n    # --- Fitting ---\n    \n    # Model (a): Full Drude-Lorentz\n    # Params: [eps_inf, E_p, Gamma_D, S_L, E_L, Gamma_L]\n    p0_a = [5.0, 9.0, 0.1, 0.5, 2.5, 0.8]\n    bounds_a = ([1e-9, 1e-9, 1e-9, 0, 1e-9, 1e-9], \n                [np.inf, np.inf, np.inf, np.inf, np.inf, np.inf])\n    res_a = least_squares(residuals, p0_a, args=(E_data, eps_data, model_a), bounds=bounds_a)\n    params_a = res_a.x\n\n    # Model (b): Drude-only, eps_inf = 1\n    # Params: [E_p, Gamma_D]\n    p0_b = [8.5, 0.1]\n    bounds_b = ([1e-9, 1e-9], [np.inf, np.inf])\n    res_b = least_squares(residuals, p0_b, args=(E_data, eps_data, model_b), bounds=bounds_b)\n    params_b = res_b.x\n\n    # Model (c): Drude-only, free eps_inf\n    # Params: [eps_inf, E_p, Gamma_D]\n    p0_c = [6.8, 9.0, 0.1]\n    bounds_c = ([1e-9, 1e-9, 1e-9], [np.inf, np.inf, np.inf])\n    res_c = least_squares(residuals, p0_c, args=(E_data, eps_data, model_c), bounds=bounds_c)\n    params_c = res_c.x\n    \n    # --- Test Cases and Calculation ---\n    test_cases = [\n        (1.0, 1.55),   # Case A: eps_d, E\n        (2.25, 2.00),  # Case B\n        (3.06, 2.75)   # Case C\n    ]\n\n    models_params_ordered = [\n        (model_a, params_a),\n        (model_b, params_b),\n        (model_c, params_c)\n    ]\n    \n    results = []\n    for eps_d_test, E_test in test_cases:\n        for model_func, params in models_params_ordered:\n            n_eff = calculate_neff(E_test, eps_d_test, model_func, params)\n            results.append(n_eff)\n\n    # --- Format and Print Output ---\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3010327"}]}