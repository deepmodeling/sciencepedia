{"hands_on_practices": [{"introduction": "热膨胀的根本原因在于原子间相互作用势的不对称性。本练习提供了一个直接的、动手的计算来揭示这种联系。通过考虑原子间键合的真实模型——莫尔斯势，你将运用经典统计力学来推导热膨胀的主导项，从而巩固你对微观非谐性如何转化为宏观上依赖于温度的尺寸变化的理解 [@problem_id:2969949]。", "problem": "考虑一个一维原子间距坐标 $r$，它受莫尔斯势 $V(r)=D\\left(\\exp\\!\\left(-2a(r-r_0)\\right)-2\\exp\\!\\left(-a(r-r_0)\\right)\\right)$ 的控制，其中势阱深度 $D>0$，范围参数 $a>0$，且最小值位于 $r=r_0$。在经典正则系综 (Canonical Ensemble (CE)) 中，绝对温度 $T$ 下的热平均值 $\\langle r\\rangle_T$ 是通过玻尔兹曼权重 $\\exp(-\\beta V(r))$ 定义的，其中逆温度为 $\\beta=1/(k_B T)$，$k_B$ 是玻尔兹曼常数 ($k_B$)。从正则平均的基本定义出发，通过对势 $V(r)$ 在其最小值 $r_0$ 附近进行系统展开，计算经典极限下的领头热膨胀项，即求出 $\\langle r\\rangle_T$ 直到 $T$ 的一阶项。将非谐性视为微扰处理，并假设分布在 $r_0$ 附近足够局域化，从而使得展开和高斯矩恒等式成立。将 $\\langle r\\rangle_T$ 的最终结果表示为一个包含到 $T$ 线性项的闭式解析表达式，该表达式应由 $D$、$a$、$r_0$ 和 $k_B$ 表示。最终的方框答案内不应包含单位。由于答案为符号形式，无需进行舍入。", "solution": "问题要求在经典正则系综中，计算由莫尔斯势控制的一维系统的原子间距热平均值 $\\langle r \\rangle_T$。我们的任务是找到 $\\langle r \\rangle_T$ 的表达式，精确到温度 $T$ 的线性项。这对应于对热膨胀的领头阶贡献。\n\n莫尔斯势由下式给出\n$$V(r) = D\\left(\\exp(-2a(r-r_0)) - 2\\exp(-a(r-r_0))\\right)$$\n其中 $D > 0$ 是势阱深度，$a > 0$ 是范围参数，$r_0$ 是对应于势能最小值的平衡间距。\n\n在温度 $T$ 下，间距 $r$ 的热平均值由正则平均给出：\n$$\\langle r \\rangle_T = \\frac{\\int_0^\\infty r \\exp(-\\beta V(r)) dr}{\\int_0^\\infty \\exp(-\\beta V(r)) dr}$$\n其中 $\\beta = 1/(k_B T)$，$k_B$ 是玻尔兹曼常数。\n\n为分析低温下的行为，我们将势 $V(r)$ 在其最小值 $r=r_0$ 附近展开为泰勒级数。令 $x = r-r_0$ 为偏离平衡位置的位移。势作为 $x$ 的函数为 $V(r_0+x)$。其泰勒级数为：\n$$V(r_0+x) = V(r_0) + V'(r_0)x + \\frac{1}{2!}V''(r_0)x^2 + \\frac{1}{3!}V'''(r_0)x^3 + \\mathcal{O}(x^4)$$\n我们计算 $V(r)$ 所需的各阶导数，并在 $r=r_0$ 处求值：\n- $V(r_0) = D(\\exp(0) - 2\\exp(0)) = -D$。\n- $V'(r) = D(-2a\\exp(-2a(r-r_0)) + 2a\\exp(-a(r-r_0)))$，因此 $V'(r_0) = D(-2a+2a)=0$，正如最小值所预期的。\n- $V''(r) = D(4a^2\\exp(-2a(r-r_0)) - 2a^2\\exp(-a(r-r_0)))$，因此 $V''(r_0) = D(4a^2-2a^2)=2Da^2$。\n- $V'''(r) = D(-8a^3\\exp(-2a(r-r_0)) + 2a^3\\exp(-a(r-r_0)))$，因此 $V'''(r_0) = D(-8a^3+2a^3)=-6Da^3$。\n\n将这些结果代入泰勒级数，势展开到三次项为：\n$$V(r_0+x) \\approx -D + \\frac{1}{2}(2Da^2)x^2 + \\frac{1}{6}(-6Da^3)x^3 = -D + Da^2x^2 - Da^3x^3$$\n我们可以将其分为谐振部分 $V_h(x)$ 和非谐微扰部分 $V_a(x)$。令 $k = 2Da^2$ 为等效劲度系数。\n$$V(r_0+x) = \\underbrace{-D + \\frac{1}{2}kx^2}_{V_h(x)} \\underbrace{- Da^3x^3}_{V_a(x)} + \\mathcal{O}(x^4)$$\n势中的常数项 $-D$ 会在平均值的分子和分母中产生一个因子 $\\exp(\\beta D)$，该因子会相互抵消，因此我们可以忽略它。\n\n偏离平衡位置的平均位移为 $\\langle x \\rangle_T = \\langle r-r_0 \\rangle_T = \\langle r \\rangle_T - r_0$。我们想要计算 $\\langle x \\rangle_T$。\n$$\\langle x \\rangle_T = \\frac{\\int_{-\\infty}^\\infty x \\exp(-\\beta (V_h(x) + V_a(x))) dx}{\\int_{-\\infty}^\\infty \\exp(-\\beta (V_h(x) + V_a(x))) dx}$$\n积分限从 $(-r_0, \\infty)$ 扩展到 $(-\\infty, \\infty)$，这在低温下是一个有效的近似，因为此时玻尔兹曼权重 $\\exp(-\\beta V(x))$ 在 $x=0$ 附近呈尖峰分布。\n在低温下，$\\beta V_a(x)$ 很小，所以我们可以展开非谐项的指数函数：$\\exp(-\\beta V_a(x)) \\approx 1 - \\beta V_a(x)$。\n$$\\langle x \\rangle_T \\approx \\frac{\\int x (1-\\beta V_a(x)) \\exp(-\\beta V_h(x)) dx}{\\int (1-\\beta V_a(x)) \\exp(-\\beta V_h(x)) dx}$$\n令 $\\langle A \\rangle_0$ 表示相对于谐振势 $V_h(x)$ 的热平均值：\n$$\\langle A \\rangle_0 = \\frac{\\int A(x) \\exp(-\\beta V_h(x)) dx}{\\int \\exp(-\\beta V_h(x)) dx}$$\n使用这种表示法， $\\langle x \\rangle_T$ 变为：\n$$\\langle x \\rangle_T \\approx \\frac{\\langle x(1-\\beta V_a(x)) \\rangle_0}{\\langle 1-\\beta V_a(x) \\rangle_0} = \\frac{\\langle x \\rangle_0 - \\beta \\langle xV_a(x) \\rangle_0}{1 - \\beta \\langle V_a(x) \\rangle_0}$$\n谐振势 $V_h(x) = \\frac{1}{2}kx^2$ 是 $x$ 的偶函数。相应的玻尔兹曼分布是一个高斯分布，也是一个偶函数。因此，任何奇函数在此分布下的平均值都为零。\n- $\\langle x \\rangle_0 = 0$。\n- $V_a(x) = -Da^3x^3$ 是一个奇函数，所以 $\\langle V_a(x) \\rangle_0 = -Da^3 \\langle x^3 \\rangle_0 = 0$。\n- 乘积 $xV_a(x) = -Da^3x^4$ 是一个偶函数，所以其平均值不为零。\n\n经过这些简化，$\\langle x \\rangle_T$ 的表达式变为：\n$$\\langle x \\rangle_T \\approx \\frac{0 - \\beta \\langle xV_a(x) \\rangle_0}{1 - 0} = -\\beta \\langle xV_a(x) \\rangle_0$$\n代入 $V_a(x)$:\n$$\\langle x \\rangle_T \\approx -\\beta \\langle x(-Da^3x^3) \\rangle_0 = \\beta Da^3 \\langle x^4 \\rangle_0$$\n我们现在需要计算谐振子的四阶矩 $\\langle x^4 \\rangle_0$。谐振分布是一个零均值的高斯分布。该分布的矩是众所周知的。首先，根据能量均分定理 $\\frac{1}{2}k\\langle x^2 \\rangle_0 = \\frac{1}{2}k_BT$ 可以求得二阶矩（方差），它给出：\n$$\\langle x^2 \\rangle_0 = \\frac{k_BT}{k} = \\frac{k_BT}{2Da^2} = \\frac{1}{2\\beta Da^2}$$\n对于零均值高斯分布，四阶矩与二阶矩的关系为 $\\langle x^4 \\rangle_0 = 3(\\langle x^2 \\rangle_0)^2$。\n$$\\langle x^4 \\rangle_0 = 3 \\left( \\frac{1}{2\\beta Da^2} \\right)^2 = \\frac{3}{4\\beta^2 D^2 a^4}$$\n现在，我们将此结果代回 $\\langle x \\rangle_T$ 的表达式中：\n$$\\langle x \\rangle_T \\approx \\beta Da^3 \\left( \\frac{3}{4\\beta^2 D^2 a^4} \\right) = \\frac{3Da^3}{4\\beta D^2 a^4} = \\frac{3}{4\\beta Da}$$\n最后，我们代入 $\\beta = 1/(k_B T)$：\n$$\\langle x \\rangle_T \\approx \\frac{3k_B T}{4Da}$$\n这就是偏离平衡位置的平均位移，它与温度成线性关系。那么，平均间距 $\\langle r \\rangle_T$ 为：\n$$\\langle r \\rangle_T = r_0 + \\langle x \\rangle_T \\approx r_0 + \\frac{3k_B T}{4Da}$$\n该表达式包含了常数项 $r_0$ 和 $T$ 的线性项，符合题目要求。修正项的正号表明平均间距随温度升高而增加，这正是热膨胀现象。这种现象源于原子间势的不对称性，在数学上由非零的三次非谐项所捕捉。", "answer": "$$\\boxed{r_0 + \\frac{3k_B T}{4Da}}$$", "id": "2969949"}, {"introduction": "从单个化学键的模型过渡到晶体，我们必须考虑晶格的集体振动——声子。本实践将引入准谐近似和格林艾森参数，它们是将声子频率的体积依赖性与宏观热膨胀联系起来的关键工具。你将首先推导热膨胀系数的一般表达式，然后将其应用于一个模型系统，以解释负热膨胀（NTE）这一引人入胜的现象，展示它如何源于不同声子模式的竞争性贡献 [@problem_id:2969960]。", "problem": "一种晶体固体可以很好地用准谐波近似来描述，其中声子频率 $\\omega_{\\mathbf{q}\\nu}$ 取决于晶体体积 $V$。总亥姆霍兹自由能可以写为 $F(V,T) = U_{0}(V) + F_{\\text{ph}}(V,T)$，其中 $U_{0}(V)$ 是静态晶格能，声子部分为\n$$\nF_{\\text{ph}}(V,T) = \\sum_{\\mathbf{q}\\nu} \\left[ \\tfrac{1}{2}\\hbar \\omega_{\\mathbf{q}\\nu}(V) + k_{B} T \\ln\\!\\left(1 - \\exp\\!\\left(-\\frac{\\hbar \\omega_{\\mathbf{q}\\nu}(V)}{k_{B} T}\\right)\\right)\\right].\n$$\n模式格林爱森参数定义为 $\\gamma_{\\mathbf{q}\\nu} \\equiv -\\frac{\\partial \\ln \\omega_{\\mathbf{q}\\nu}}{\\partial \\ln V}$，等温体弹性模量定义为 $B_{T} \\equiv -V\\left(\\frac{\\partial P}{\\partial V}\\right)_{T}$，体热膨胀系数定义为 $\\alpha(T) \\equiv \\frac{1}{V}\\left(\\frac{\\partial V}{\\partial T}\\right)_{P}$。\n\n任务：\n1) 仅从上述定义和基本热力学关系出发，推导 $\\alpha(T)$ 的一个通用表达式，该表达式用声子热容 $C_{\\mathbf{q}\\nu}(T)$、模式格林爱森参数 $\\gamma_{\\mathbf{q}\\nu}$、等温体弹性模量 $B_{T}$ 和体积 $V$ 来表示。根据你的表达式，陈述在多模式系统中，温度 $T$ 下出现负热膨胀的充要条件。\n\n2) 考虑一个具有两组无色散（爱因斯坦）光学模式的模型多模式晶体：\n- 一组低频模式，简并度为 $g_{-}$，能量为 $\\hbar\\omega_{-}$，模式格林爱森参数为 $\\gamma_{-}0$。\n- 一组高频模式，简并度为 $g_{+}$，能量为 $\\hbar\\omega_{+}$，模式格林爱森参数为 $\\gamma_{+}0$。\n假设 $B_{T}$ 和 $V$ 在感兴趣的温度范围内不随温度变化，并且能量为 $\\hbar \\omega$ 的爱因斯坦模式的声子热容为\n$$\nC_{E}(\\omega,T) = k_{B}\\,\\frac{x^{2}\\exp(x)}{\\left[\\exp(x)-1\\right]^{2}},\\quad x \\equiv \\frac{\\hbar \\omega}{k_{B}T}.\n$$\n\n对于参数为 $g_{-}=3$, $\\hbar\\omega_{-}=8\\,\\text{meV}$, $\\gamma_{-}=-2.5$, $g_{+}=9$, $\\hbar\\omega_{+}=20\\,\\text{meV}$, 和 $\\gamma_{+}=+1.0$ 的数值模型，确定 $\\alpha(T)$ 符号改变时的温度 $T^{\\star}$。你可以取玻尔兹曼常数为 $k_{B}=0.0861733\\,\\text{meV/K}$。报告 $T^{\\star}$ 的数值，四舍五入到3位有效数字。以开尔文为单位表示你的最终答案。", "solution": "这个问题包含两个部分。第一部分要求在准谐波近似下推导体热膨胀系数 $\\alpha(T)$ 的通用表达式，以及负热膨胀（NTE）的条件。第二部分将此结果应用于一个特定的模型，以计算热膨胀系数改变符号的温度 $T^{\\star}$。\n\n### 第一部分：$\\alpha(T)$ 的推导及负热膨胀的条件\n\n体热膨胀系数 $\\alpha(T)$ 定义为\n$$\n\\alpha(T) \\equiv \\frac{1}{V}\\left(\\frac{\\partial V}{\\partial T}\\right)_{P}\n$$\n其中 $V$ 是体积，$T$ 是温度，$P$ 是压力。该导数在恒定压力下取值。为了方便计算，我们使用偏导数的“三乘积规则”，即\n$$\n\\left(\\frac{\\partial V}{\\partial T}\\right)_{P} \\left(\\frac{\\partial T}{\\partial P}\\right)_{V} \\left(\\frac{\\partial P}{\\partial V}\\right)_{T} = -1\n$$\n整理这个恒等式得到\n$$\n\\left(\\frac{\\partial V}{\\partial T}\\right)_{P} = -\\left(\\frac{\\partial V}{\\partial P}\\right)_{T} \\left(\\frac{\\partial P}{\\partial T}\\right)_{V}\n$$\n将此代入 $\\alpha(T)$ 的定义中：\n$$\n\\alpha(T) = -\\frac{1}{V} \\left(\\frac{\\partial V}{\\partial P}\\right)_{T} \\left(\\frac{\\partial P}{\\partial T}\\right)_{V}\n$$\n等温体弹性模量 $B_T$ 定义为 $B_{T} \\equiv -V\\left(\\frac{\\partial P}{\\partial V}\\right)_{T}$。因此，$-\\frac{1}{V}\\left(\\frac{\\partial V}{\\partial P}\\right)_{T} = \\frac{1}{B_T}$。这将 $\\alpha(T)$ 的表达式简化为\n$$\n\\alpha(T) = \\frac{1}{B_{T}} \\left(\\frac{\\partial P}{\\partial T}\\right)_{V}\n$$\n这是一个标准的热力学关系。现在我们必须计算 $\\left(\\frac{\\partial P}{\\partial T}\\right)_{V}$ 项。压力 $P$ 通过基本关系 $P = -\\left(\\frac{\\partial F}{\\partial V}\\right)_{T}$ 与亥姆霍兹自由能 $F(V,T)$ 相关。给定的总亥姆霍兹自由能为 $F(V,T) = U_{0}(V) + F_{\\text{ph}}(V,T)$。\n于是压力为\n$$\nP(V,T) = -\\left(\\frac{\\partial U_{0}}{\\partial V}\\right)_{T} - \\left(\\frac{\\partial F_{\\text{ph}}}{\\partial V}\\right)_{T}\n$$\n我们需要计算在恒定体积下压力随温度的变化：\n$$\n\\left(\\frac{\\partial P}{\\partial T}\\right)_{V} = -\\frac{\\partial}{\\partial T}\\left(\\frac{\\partial U_{0}}{\\partial V}\\right)_{V} - \\frac{\\partial}{\\partial T}\\left(\\frac{\\partial F_{\\text{ph}}}{\\partial V}\\right)_{V} = -\\frac{\\partial^2 F_{\\text{ph}}}{\\partial T \\partial V}\n$$\n$U_0(V)$ 相关项消失，因为 $U_0$ 仅是 $V$ 的函数。由于 $F_{\\text{ph}}$ 是一个良好函数，我们可以交换微分顺序：$\\frac{\\partial^2 F_{\\text{ph}}}{\\partial T \\partial V} = \\frac{\\partial^2 F_{\\text{ph}}}{\\partial V \\partial T}$。\n\n自由能的声子贡献是所有声子模式 $(\\mathbf{q}\\nu)$ 的总和：\n$$\nF_{\\text{ph}}(V,T) = \\sum_{\\mathbf{q}\\nu} F_{\\mathbf{q}\\nu}(V,T) = \\sum_{\\mathbf{q}\\nu} \\left[ \\tfrac{1}{2}\\hbar \\omega_{\\mathbf{q}\\nu}(V) + k_{B} T \\ln\\!\\left(1 - \\exp\\!\\left(-\\frac{\\hbar \\omega_{\\mathbf{q}\\nu}(V)}{k_{B} T}\\right)\\right)\\right]\n$$\n我们首先计算单个模式的自由能 $F_{\\mathbf{q}\\nu}$ 对体积 $V$ 的导数。频率 $\\omega_{\\mathbf{q}\\nu}$ 是 $V$ 的函数。\n$$\n\\frac{\\partial F_{\\mathbf{q}\\nu}}{\\partial V} = \\frac{\\partial \\omega_{\\mathbf{q}\\nu}}{\\partial V} \\frac{\\partial F_{\\mathbf{q}\\nu}}{\\partial \\omega_{\\mathbf{q}\\nu}} = \\frac{\\partial \\omega_{\\mathbf{q}\\nu}}{\\partial V} \\left[ \\frac{1}{2}\\hbar + k_B T \\frac{-\\exp(-\\hbar\\omega_{\\mathbf{q}\\nu}/k_B T) \\cdot (-\\hbar/k_B T)}{1-\\exp(-\\hbar\\omega_{\\mathbf{q}\\nu}/k_B T)} \\right]\n$$\n$$\n\\frac{\\partial F_{\\mathbf{q}\\nu}}{\\partial V} = \\frac{\\partial \\omega_{\\mathbf{q}\\nu}}{\\partial V} \\left[ \\frac{1}{2}\\hbar + \\frac{\\hbar}{ \\exp(\\hbar\\omega_{\\mathbf{q}\\nu}/k_B T) - 1 } \\right] = \\frac{1}{\\omega_{\\mathbf{q}\\nu}} \\frac{\\partial \\omega_{\\mathbf{q}\\nu}}{\\partial V} \\left[ \\frac{1}{2}\\hbar\\omega_{\\mathbf{q}\\nu} + \\frac{\\hbar\\omega_{\\mathbf{q}\\nu}}{ \\exp(\\hbar\\omega_{\\mathbf{q}\\nu}/k_B T) - 1 } \\right]\n$$\n方括号中的项是量子谐振子的平均能量 $U_{\\mathbf{q}\\nu}(T)$。所以，$\\frac{\\partial F_{\\mathbf{q}\\nu}}{\\partial V} = U_{\\mathbf{q}\\nu}(T) \\frac{\\partial \\ln \\omega_{\\mathbf{q}\\nu}}{\\partial V}$。\n使用模式格林爱森参数的定义 $\\gamma_{\\mathbf{q}\\nu} \\equiv -\\frac{\\partial \\ln \\omega_{\\mathbf{q}\\nu}}{\\partial \\ln V} = -\\frac{V}{\\omega_{\\mathbf{q}\\nu}}\\frac{\\partial \\omega_{\\mathbf{q}\\nu}}{\\partial V}$，我们可以写出 $\\frac{\\partial \\ln \\omega_{\\mathbf{q}\\nu}}{\\partial V} = -\\frac{\\gamma_{\\mathbf{q}\\nu}}{V}$。\n因此，\n$$\n\\frac{\\partial F_{\\mathbf{q}\\nu}}{\\partial V} = - U_{\\mathbf{q}\\nu}(T) \\frac{\\gamma_{\\mathbf{q}\\nu}}{V}\n$$\n对所有模式求和，得到声子对压力的贡献：\n$$\nP_{\\text{ph}}(V,T) = -\\left(\\frac{\\partial F_{\\text{ph}}}{\\partial V}\\right)_{T} = \\sum_{\\mathbf{q}\\nu} \\frac{\\gamma_{\\mathbf{q}\\nu} U_{\\mathbf{q}\\nu}(T)}{V}\n$$\n现在，我们可以计算 $\\left(\\frac{\\partial P}{\\partial T}\\right)_{V} = \\left(\\frac{\\partial P_{\\text{ph}}}{\\partial T}\\right)_{V}$：\n$$\n\\left(\\frac{\\partial P}{\\partial T}\\right)_{V} = \\frac{\\partial}{\\partial T} \\left( \\sum_{\\mathbf{q}\\nu} \\frac{\\gamma_{\\mathbf{q}\\nu} U_{\\mathbf{q}\\nu}(T)}{V} \\right)_{V} = \\frac{1}{V} \\sum_{\\mathbf{q}\\nu} \\gamma_{\\mathbf{q}\\nu} \\left(\\frac{\\partial U_{\\mathbf{q}\\nu}}{\\partial T}\\right)_{V}\n$$\n量 $\\left(\\frac{\\partial U_{\\mathbf{q}\\nu}}{\\partial T}\\right)_{V}$ 是模式 $(\\mathbf{q}\\nu)$ 的热容，记为 $C_{\\mathbf{q}\\nu}(T)$。\n$$\n\\left(\\frac{\\partial P}{\\partial T}\\right)_{V} = \\frac{1}{V} \\sum_{\\mathbf{q}\\nu} \\gamma_{\\mathbf{q}\\nu} C_{\\mathbf{q}\\nu}(T)\n$$\n将此代回 $\\alpha(T)$ 的表达式，我们得到最终结果：\n$$\n\\alpha(T) = \\frac{1}{B_{T} V} \\sum_{\\mathbf{q}\\nu} \\gamma_{\\mathbf{q}\\nu} C_{\\mathbf{q}\\nu}(T)\n$$\n这就是用指定量表示的 $\\alpha(T)$ 的通用表达式。\n\n对于负热膨胀，我们必须有 $\\alpha(T)  0$。对于热力学稳定的固体，等温体弹性模量 $B_T$ 必须为正 ($B_T  0$)，体积 $V$ 也为正。任何模式的热容 $C_{\\mathbf{q}\\nu}(T)$ 是一个非负的量 ($C_{\\mathbf{q}\\nu}(T) \\ge 0$)。因此，$\\alpha(T)$ 的符号完全由 $\\sum_{\\mathbf{q}\\nu} \\gamma_{\\mathbf{q}\\nu} C_{\\mathbf{q}\\nu}(T)$ 这个和的符号确定。\n在温度 $T$ 下发生负热膨胀的充要条件是：\n$$\n\\sum_{\\mathbf{q}\\nu} \\gamma_{\\mathbf{q}\\nu} C_{\\mathbf{q}\\nu}(T)  0\n$$\n\n### 第二部分：符号改变温度 $T^{\\star}$ 的计算\n\n对于给定的模型，对模式的求和包含两个部分：一个简并度为 $g_{-}$、频率为 $\\omega_{-}$、格林爱森参数为 $\\gamma_{-}$ 的低频组，和一个简并度为 $g_{+}$、频率为 $\\omega_{+}$、格林爱森参数为 $\\gamma_{+}$ 的高频组。求和变为：\n$$\n\\sum_{\\text{modes}} \\gamma_{\\text{mode}} C_{\\text{mode}}(T) = g_{-} \\gamma_{-} C_{E}(\\omega_{-}, T) + g_{+} \\gamma_{+} C_{E}(\\omega_{+}, T)\n$$\n其中 $C_{E}(\\omega, T)$ 是单个爱因斯坦模式的热容。\n热膨胀系数 $\\alpha(T)$ 在 $\\alpha(T) = 0$ 时改变符号。由于前因子 $\\frac{1}{B_T V}$ 为正，这发生在求和为零时：\n$$\ng_{-} \\gamma_{-} C_{E}(\\omega_{-}, T^{\\star}) + g_{+} \\gamma_{+} C_{E}(\\omega_{+}, T^{\\star}) = 0\n$$\n题目给出了爱因斯坦热容的表达式：$C_{E}(\\omega,T) = k_{B}\\,\\frac{x^{2}\\exp(x)}{\\left[\\exp(x)-1\\right]^{2}}$，其中 $x \\equiv \\frac{\\hbar \\omega}{k_{B}T}$。\n将此代入我们的方程：\n$$\ng_{-} \\gamma_{-} k_{B} \\frac{x_{-}^2 \\exp(x_{-})}{(\\exp(x_{-})-1)^2} + g_{+} \\gamma_{+} k_{B} \\frac{x_{+}^2 \\exp(x_{+})}{(\\exp(x_{+})-1)^2} = 0\n$$\n其中 $x_{-} \\equiv \\frac{\\hbar\\omega_{-}}{k_B T^{\\star}}$ 和 $x_{+} \\equiv \\frac{\\hbar\\omega_{+}}{k_B T^{\\star}}$。玻尔兹曼常数 $k_B$ 被消去。\n代入数值 $g_{-}=3$, $\\gamma_{-}=-2.5$, $g_{+}=9$, $\\gamma_{+}=+1.0$：\n$$\n(3)(-2.5) \\frac{x_{-}^2 \\exp(x_{-})}{(\\exp(x_{-})-1)^2} + (9)(1.0) \\frac{x_{+}^2 \\exp(x_{+})}{(\\exp(x_{+})-1)^2} = 0\n$$\n$$\n9 \\frac{x_{+}^2 \\exp(x_{+})}{(\\exp(x_{+})-1)^2} = 7.5 \\frac{x_{-}^2 \\exp(x_{-})}{(\\exp(x_{-})-1)^2}\n$$\n变量 $x_{-}$ 和 $x_{+}$ 是相关的：$x_{+} = \\frac{\\hbar\\omega_{+}}{k_B T^{\\star}} = \\frac{\\hbar\\omega_{-}}{k_B T^{\\star}} \\frac{\\hbar\\omega_{+}}{\\hbar\\omega_{-}} = x_{-} \\frac{20\\,\\text{meV}}{8\\,\\text{meV}} = 2.5 x_{-}$。\n代入 $x_{+} = 2.5x_{-}$，方程变为：\n$$\n9 \\frac{(2.5x_{-})^2 \\exp(2.5x_{-})}{(\\exp(2.5x_{-})-1)^2} = 7.5 \\frac{x_{-}^2 \\exp(x_{-})}{(\\exp(x_{-})-1)^2}\n$$\n对于 $T^{\\star}  0$，我们有 $x_{-} \\ne 0$，所以可以从两边消去 $x_{-}^2$：\n$$\n9 \\cdot (2.5)^2 \\frac{\\exp(2.5x_{-})}{(\\exp(2.5x_{-})-1)^2} = 7.5 \\frac{\\exp(x_{-})}{(\\exp(x_{-})-1)^2}\n$$\n$$\n56.25 \\frac{\\exp(2.5x_{-})}{(\\exp(2.5x_{-})-1)^2} = 7.5 \\frac{\\exp(x_{-})}{(\\exp(x_{-})-1)^2}\n$$\n两边除以 7.5 得到：\n$$\n7.5 \\frac{\\exp(2.5x_{-})}{(\\exp(2.5x_{-})-1)^2} = \\frac{\\exp(x_{-})}{(\\exp(x_{-})-1)^2}\n$$\n这是一个关于 $x_{-}$ 的超越方程。我们进行数值求解。我们定义一个函数 $f(y) = 7.5 \\exp(2.5y)(\\exp(y)-1)^2 - \\exp(y)(\\exp(2.5y)-1)^2$ 并求其根 $y=x_{-}$。\n通过试值，我们发现当 $y=0.65$ 时，$f(0.65) > 0$，而当 $y=0.66$ 时，$f(0.66)  0$。进一步精确求解表明，根非常接近于 $x_{-} \\approx 0.6529$。\n现在我们可以计算温度 $T^{\\star}$：\n$$\nT^{\\star} = \\frac{\\hbar\\omega_{-}}{k_B x_{-}}\n$$\n使用给定的值 $\\hbar\\omega_{-} = 8\\,\\text{meV}$ 和 $k_B=0.0861733\\,\\text{meV/K}$：\n$$\nT^{\\star} = \\frac{8\\,\\text{meV}}{(0.0861733\\,\\text{meV/K}) \\cdot (0.6529)} = \\frac{8}{0.056262}\\,\\text{K} \\approx 142.189\\,\\text{K}\n$$\n将结果四舍五入到3位有效数字得到 $142\\,\\text{K}$。在低温下，较软模式的负 $\\gamma_{-}$ 占主导地位，导致加热时收缩（$\\alpha  0$）。在较高温度下，数量更多的高能模式的正 $\\gamma_{+}$ 变得显著，导致膨胀（$\\alpha > 0$）。$T^{\\star}$ 是这个转变的交叉温度。", "answer": "$$\\boxed{142}$$", "id": "2969960"}, {"introduction": "尽管准谐近似功能强大，但在强非谐性材料中它常常会失效，因为简单的微扰理论在这种情况下是不够的。这个计算实践将介绍自洽声子（SCP）方法，这是一种更稳健的、能够处理强声子-声子相互作用的非微扰方法。通过编程实现并比较准谐近似（QHA）和自洽声子（SCP）模型，你将获得计算材料物理的实践技能，并亲眼见证精确地捕捉高阶（四次）非谐性对于定量预测材料热学性质是何等关键 [@problem_id:2970007]。", "problem": "您需要实现一个程序，为一个具有强非谐性的钙钛矿简化模型，计算作为温度函数的体积热膨胀系数 $\\alpha(T)$。您必须比较准谐波近似 (QHA) 和自洽声子 (SCP) 方法的预测结果，并定量评估四次非谐性在复现实验膨胀趋势方面的影响。\n\n需要使用的基本定义和建模假设：\n- 在温度 $T$ 和体积 $V$ 下的亥姆霍兹自由能 $F(T,V)$ 由晶格弹性贡献和振动贡献组成。在固定外压 $P_{\\mathrm{ext}}$ 下的吉布斯自由能为 $G(T,V) = E_{\\mathrm{el}}(V) + F_{\\mathrm{vib}}(T,V) + P_{\\mathrm{ext}} V$，在给定温度 $T$ 下的热平衡条件是在固定 $P_{\\mathrm{ext}}$ 时最小化关于 $V$ 的 $G(T,V)$。\n- 体积热膨胀系数定义为 $\\alpha(T) = \\frac{1}{V(T)} \\left( \\frac{\\partial V(T)}{\\partial T} \\right)_{P_{\\mathrm{ext}}}$，您必须使用中心有限差分近似进行数值计算。\n- 弹性贡献被建模为围绕参考体积 $V_0$ 的二次展开，其体积模量为 $B$：$E_{\\mathrm{el}}(V) = \\frac{B}{2 V_0} (V - V_0)^2$。\n- 振动谱由 $s$ 个相同的光学模式表示，这些模式通过 Grüneisen 型关系式 $\\omega(V) = \\omega_0 \\left( \\frac{V}{V_0} \\right)^{-\\gamma}$ 与体积耦合，其中 $\\omega_0$ 是参考角频率，$\\gamma$ 是 Grüneisen 参数。\n- 每个模式的谐振子亥姆霍兹自由能为 $F_{\\mathrm{harm}}(T,\\omega) = k_B T \\ln\\left(1 - e^{-\\hbar \\omega / k_B T}\\right) + \\frac{1}{2} \\hbar \\omega$，因此总的 QHA 振动自由能为 $F_{\\mathrm{QHA}}(T,V) = s \\, F_{\\mathrm{harm}}(T, \\omega(V))$。其中 $k_B$ 是玻尔兹曼常数，$\\hbar$ 是约化普朗克常数。\n- 在自洽声子 (SCP) 方法对四次非谐性的处理中，每个模式由单坐标势 $U(x;V) = \\frac{1}{2} M \\omega(V)^2 x^2 + \\frac{1}{4} \\beta x^4$ 决定，其中 $M$ 是有效质量，$\\beta$ 是四次项系数。重整化角频率 $\\Omega$ 由以下自洽条件隐式确定：\n$$\nM \\Omega^2 = M \\omega(V)^2 + 3 \\beta \\langle x^2 \\rangle_{\\Omega},\n$$\n其中谐波坐标方差为\n$$\n\\langle x^2 \\rangle_{\\Omega} = \\frac{\\hbar}{2 M \\Omega} \\coth\\left( \\frac{\\hbar \\Omega}{2 k_B T} \\right).\n$$\n使用 $\\langle x^4 \\rangle_{\\Omega} = 3 \\langle x^2 \\rangle_{\\Omega}^2$。在自洽的 $\\Omega$ 处，每个模式的 SCP 变分自由能为\n$$\nF_{\\mathrm{SCP,mode}}(T,V) = F_{\\mathrm{harm}}(T,\\Omega) + \\frac{1}{2} M \\left( \\omega(V)^2 - \\Omega^2 \\right) \\langle x^2 \\rangle_{\\Omega} + \\frac{1}{4} \\beta \\langle x^4 \\rangle_{\\Omega},\n$$\n且 $F_{\\mathrm{SCP}}(T,V) = s \\, F_{\\mathrm{SCP,mode}}(T,V)$。\n\n计算任务：\n1. 对于每个指定的参数集和温度 $T$，通过在固定外压 $P_{\\mathrm{ext}}$ 下最小化关于 $V$ 的 $G(T,V)$ 来计算平衡体积 $V(T)$，适用于：\n   - 使用 $F_{\\mathrm{QHA}}(T,V)$ 的 QHA。\n   - 使用 $F_{\\mathrm{SCP}}(T,V)$ 的 SCP，其中重整化角频率 $\\Omega$ 必须通过上述隐式方程自洽地获得。如果 $\\beta = 0$，则恰好有 $\\Omega = \\omega(V)$。\n2. 在每个目标温度 $T$ 处，使用中心有限差分近似计算 $\\alpha(T)$：\n$$\n\\alpha(T) \\approx \\frac{1}{V(T)} \\cdot \\frac{V(T + \\Delta T) - V(T - \\Delta T)}{2 \\, \\Delta T},\n$$\n其中 $\\Delta T = 1 \\, \\mathrm{K}$。\n3. 对于每个测试用例，还需计算与所提供的实验参考值 $\\alpha_{\\mathrm{exp}}(T)$ 的相对偏差，以小数形式表示：\n$$\n\\delta(T) = \\frac{\\alpha(T) - \\alpha_{\\mathrm{exp}}(T)}{\\alpha_{\\mathrm{exp}}(T)}.\n$$\n\n单位和数值报告：\n- 所有物理量必须采用国际单位制 (SI)。热膨胀系数必须以 $\\mathrm{K}^{-1}$ 为单位报告。\n- 报告所有数值输出时，四舍五入到七位小数。\n\n测试套件：\n为以下三个探索不同区域的参数集实现计算：\n\n- 测试用例 1 (强非谐性钙钛矿)：\n  - $V_0 = 64 \\times 10^{-30} \\, \\mathrm{m}^3$, $B = 1.10 \\times 10^{11} \\, \\mathrm{Pa}$, $M = 3.0 \\times 10^{-26} \\, \\mathrm{kg}$, $\\omega_0 = 2.0 \\times 10^{13} \\, \\mathrm{rad/s}$, $\\gamma = 2.0$, $\\beta = 6.0 \\times 10^{20} \\, \\mathrm{J/m}^4$, $s = 3$, $P_{\\mathrm{ext}} = 0 \\, \\mathrm{Pa}$, 目标温度 $T \\in \\{300 \\, \\mathrm{K}, 900 \\, \\mathrm{K}\\}$，实验参考值 $\\alpha_{\\mathrm{exp}}(300 \\, \\mathrm{K}) = 1.40 \\times 10^{-5} \\, \\mathrm{K}^{-1}$ 和 $\\alpha_{\\mathrm{exp}}(900 \\, \\mathrm{K}) = 1.20 \\times 10^{-5} \\, \\mathrm{K}^{-1}$。\n- 测试用例 2 (中等非谐性)：\n  - 与测试用例 1 相同，除了 $\\beta = 1.5 \\times 10^{20} \\, \\mathrm{J/m}^4$，以及实验参考值 $\\alpha_{\\mathrm{exp}}(300 \\, \\mathrm{K}) = 1.30 \\times 10^{-5} \\, \\mathrm{K}^{-1}$ 和 $\\alpha_{\\mathrm{exp}}(900 \\, \\mathrm{K}) = 1.25 \\times 10^{-5} \\, \\mathrm{K}^{-1}$。\n- 测试用例 3 (谐波极限边界)：\n  - 与测试用例 1 相同，除了 $\\beta = 0$，以及实验参考值 $\\alpha_{\\mathrm{exp}}(300 \\, \\mathrm{K}) = 1.25 \\times 10^{-5} \\, \\mathrm{K}^{-1}$ 和 $\\alpha_{\\mathrm{exp}}(900 \\, \\mathrm{K}) = 1.25 \\times 10^{-5} \\, \\mathrm{K}^{-1}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。\n- 每个测试用例的条目必须是一个包含八个数字的列表：\n  - $[\\alpha_{\\mathrm{QHA}}(300 \\, \\mathrm{K}), \\alpha_{\\mathrm{QHA}}(900 \\, \\mathrm{K}), \\alpha_{\\mathrm{SCP}}(300 \\, \\mathrm{K}), \\alpha_{\\mathrm{SCP}}(900 \\, \\mathrm{K}), \\delta_{\\mathrm{QHA}}(300 \\, \\mathrm{K}), \\delta_{\\mathrm{QHA}}(900 \\, \\mathrm{K}), \\delta_{\\mathrm{SCP}}(300 \\, \\mathrm{K}), \\delta_{\\mathrm{SCP}}(900 \\, \\mathrm{K})]$,\n  四舍五入到七位小数，所有 $\\alpha$ 的值单位为 $\\mathrm{K}^{-1}$，$\\delta$ 的值为无单位小数。\n- 因此，对于这三个测试用例，最终输出必须看起来像一个包含三个列表的单一列表，例如：$[[a_1,a_2,a_3,a_4,a_5,a_6,a_7,a_8],[b_1,\\dots,b_8],[c_1,\\dots,c_8]]$，其中每个符号都被数值替换。", "solution": "用户请求在两种不同的理论近似（准谐波近似和自洽声子方法）下，为一个模型钙钛矿计算体积热膨胀系数 $\\alpha(T)$。该请求已被验证为凝聚态物理学中一个科学上合理、良定且完整的问题。我们将进行详细的解答。\n\n### 1. 热力学框架\n\n吉布斯自由能由下式给出：\n$$\nG(T,V) = E_{\\mathrm{el}}(V) + F_{\\mathrm{vib}}(T,V) + P_{\\mathrm{ext}} V\n$$\n其中 $E_{\\mathrm{el}}(V)$ 是晶格的静态弹性势能，$F_{\\mathrm{vib}}(T,V)$ 是振动亥姆霍兹自由能。平衡体积 $V(T)$ 通过求解以下最小化问题得出：\n$$\n\\left( \\frac{\\partial G(T,V)}{\\partial V} \\right)_T = 0\n$$\n问题为能量贡献指定了以下模型：\n\n-   **弹性势能**：一个简单的二次模型，描述了从参考体积 $V_0$ 压缩或膨胀晶格所需的能量代价。\n    $$\n    E_{\\mathrm{el}}(V) = \\frac{B}{2 V_0} (V - V_0)^2\n    $$\n    此处，$B$ 是体积模量。\n\n-   **振动自由能**：该项取决于为处理原子振动（声子）所选择的近似方法。晶体的振动行为被简化为 $s$ 个相同的光学声子模式，其频率 $\\omega$ 根据 Grüneisen 关系随体积变化：\n    $$\n    \\omega(V) = \\omega_0 \\left( \\frac{V}{V_0} \\right)^{-\\gamma}\n    $$\n    其中 $\\gamma$ 是 Grüneisen 参数。\n\n### 2. 准谐波近似 (QHA)\n\nQHA 是一个较简单的模型。它将声子视为理想谐振子，但允许它们的频率依赖于晶体体积。总振动自由能是每个模式贡献的总和：\n$$\nF_{\\mathrm{QHA}}(T,V) = s \\cdot F_{\\mathrm{harm}}(T, \\omega(V))\n$$\n其中 $F_{\\mathrm{harm}}$ 是量子谐振子的标准统计力学结果：\n$$\nF_{\\mathrm{harm}}(T,\\omega) = k_B T \\ln\\left(1 - e^{-\\hbar \\omega / k_B T}\\right) + \\frac{1}{2} \\hbar \\omega\n$$\n项 $\\frac{1}{2} \\hbar \\omega$ 是零点能。\n\n### 3. 自洽声子 (SCP) 方法\n\nSCP 方法提供了对非谐性更复杂的处理，对于谐波近似失效的材料而言至关重要。每个模式的势能包含一个四次项：$U(x) = \\frac{1}{2} M \\omega(V)^2 x^2 + \\frac{1}{4} \\beta x^4$。该项引入了声子间的相互作用。SCP 方法用一个具有*重整化*频率 $\\Omega$ 的有效无相互作用声子系统来近似这个相互作用系统，而 $\\Omega$ 必须自洽地确定。\n\n自洽条件将重整化频率 $\\Omega$ 与有效谐振子的均方根位移 $\\langle x^2 \\rangle_{\\Omega}$ 联系起来：\n$$\nM \\Omega^2 = M \\omega(V)^2 + 3 \\beta \\langle x^2 \\rangle_{\\Omega}\n$$\n均方根位移本身也依赖于 $\\Omega$：\n$$\n\\langle x^2 \\rangle_{\\Omega} = \\frac{\\hbar}{2 M \\Omega} \\coth\\left( \\frac{\\hbar \\Omega}{2 k_B T} \\right)\n$$\n对于给定的体积 $V$ 和温度 $T$，这构成了一个关于 $\\Omega$ 的隐式方程，必须通过数值方法求解，例如，使用像 Brent-Dekker 方法这样的求根算法。\n\n一旦找到自洽的 $\\Omega$，就可以计算 SCP 振动自由能。利用自洽条件，给定的 $F_{\\mathrm{SCP,mode}}$ 表达式可以简化为：\n$$\nF_{\\mathrm{SCP,mode}}(T,V) = F_{\\mathrm{harm}}(T,\\Omega) - \\frac{3}{4}\\beta (\\langle x^2 \\rangle_{\\Omega})^2\n$$\n于是，总的 SCP 振动自由能为 $F_{\\mathrm{SCP}}(T,V) = s \\cdot F_{\\mathrm{SCP,mode}}(T,V)$。一个关键的检验是，如果非谐性系数 $\\beta = 0$，自洽方程会得出 $\\Omega = \\omega(V)$，并且 SCP 自由能正确地退化为 QHA 自由能。\n\n### 4. 计算算法\n\n整体计算流程如下：\n\n1.  **对于每个测试用例和模型 (QHA/SCP)：**\n    a. 我们在固定温度 $T$ 下定义一个吉布斯自由能函数 $G(V)$。该函数封装了 $E_{\\mathrm{el}}(V)$ 和相应的 $F_{\\mathrm{vib}}(T,V)$ 的计算。\n    b. 对于 SCP 模型，$F_{\\mathrm{vib}}(T,V)$ 的评估需要一个内部步骤：对每个 $(T,V)$ 对，使用数值求根器（`scipy.optimize.brentq`）求解关于 $\\Omega$ 的自洽方程。\n    c. 我们使用一个优化例程（`scipy.optimize.minimize_scalar`）通过数值最小化关于 $V$ 的 $G(V)$ 来找到平衡体积 $V(T)$。\n\n2.  **计算热膨胀系数 $\\alpha(T)$：**\n    问题指定了对导数 $\\left( \\frac{\\partial V}{\\partial T} \\right)_P$ 使用中心有限差分近似。这需要计算三个温度下的平衡体积：$T - \\Delta T$，$T$ 和 $T + \\Delta T$，其中 $\\Delta T = 1 \\, \\mathrm{K}$。\n    $$\n    \\alpha(T) \\approx \\frac{1}{V(T)} \\frac{V(T + \\Delta T) - V(T - \\Delta T)}{2 \\Delta T}\n    $$\n\n3.  **计算相对偏差 $\\delta(T)$：**\n    将计算出的 $\\alpha(T)$ 与提供的实验参考值 $\\alpha_{\\mathrm{exp}}(T)$进行比较，以量化模型的准确性：\n    $$\n    \\delta(T) = \\frac{\\alpha(T) - \\alpha_{\\mathrm{exp}}(T)}{\\alpha_{\\mathrm{exp}}(T)}\n    $$\n\n4.  **最终输出：**\n    将每个测试用例的结果——包括两种模型在两个温度下计算出的 $\\alpha$ 和 $\\delta$ 值，共八个浮点数——收集、四舍五入，并格式化为指定的列表的列表结构。实现过程全程使用国际单位制。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize_scalar, brentq\n\ndef solve():\n    \"\"\"\n    Computes volumetric thermal expansion coefficient for QHA and SCP models\n    and compares them to experimental data.\n    \"\"\"\n    \n    # Fundamental constants in SI units\n    HBAR = 1.054571817e-34  # J.s\n    KB = 1.380649e-23      # J/K\n    \n    # Finite difference step for temperature\n    DT = 1.0\n\n    # Test cases as defined in the problem statement\n    test_cases = [\n        {\n            \"params\": {'s': 3, 'V0': 64e-30, 'B': 1.10e11, 'M': 3.0e-26, \n                       'omega0': 2.0e13, 'gamma': 2.0, 'beta': 6.0e20, 'P_ext': 0.0},\n            \"temps\": [300.0, 900.0],\n            \"alpha_exp\": [1.40e-5, 1.20e-5]\n        },\n        {\n            \"params\": {'s': 3, 'V0': 64e-30, 'B': 1.10e11, 'M': 3.0e-26, \n                       'omega0': 2.0e13, 'gamma': 2.0, 'beta': 1.5e20, 'P_ext': 0.0},\n            \"temps\": [300.0, 900.0],\n            \"alpha_exp\": [1.30e-5, 1.25e-5]\n        },\n        {\n            \"params\": {'s': 3, 'V0': 64e-30, 'B': 1.10e11, 'M': 3.0e-26, \n                       'omega0': 2.0e13, 'gamma': 2.0, 'beta': 0.0, 'P_ext': 0.0},\n            \"temps\": [300.0, 900.0],\n            \"alpha_exp\": [1.25e-5, 1.25e-5]\n        }\n    ]\n\n    all_results = []\n    \n    # Memoization caches to speed up repeated calculations during minimization\n    memo_F_vib = {}\n    memo_omega_scp = {}\n\n    def get_omega_V(V, p):\n        return p['omega0'] * (V / p['V0'])**(-p['gamma'])\n\n    def get_E_el(V, p):\n        return p['B'] / (2 * p['V0']) * (V - p['V0'])**2\n\n    def get_F_harm_mode(T, omega):\n        if T = 1e-9 or omega = 1e-9:\n             return 0.5 * HBAR * omega\n        \n        arg = HBAR * omega / (KB * T)\n        # Avoid overflow/underflow issues in np.exp\n        if arg  700:\n            return 0.5 * HBAR * omega\n        \n        return KB * T * np.log(1 - np.exp(-arg)) + 0.5 * HBAR * omega\n\n    def get_F_qha(T, V, p):\n        key = ('QHA', T, V)\n        if key in memo_F_vib: return memo_F_vib[key]\n        \n        omega = get_omega_V(V, p)\n        result = p['s'] * get_F_harm_mode(T, omega)\n        memo_F_vib[key] = result\n        return result\n\n    def solve_omega_scp_for_V_T(V, T, p):\n        key = (T, V)\n        if key in memo_omega_scp: return memo_omega_scp[key]\n        \n        if p['beta'] == 0:\n            omega_scp = get_omega_V(V, p)\n            memo_omega_scp[key] = omega_scp\n            return omega_scp\n            \n        omega_bare_sq = get_omega_V(V, p)**2\n        \n        def scp_equation(Omega):\n            if Omega = 1e-12: return -np.inf\n            \n            arg_coth = HBAR * Omega / (2 * KB * T)\n            coth_val = 1.0 / np.tanh(arg_coth) if arg_coth  300 else 1.0\n                \n            x2_mean = (HBAR / (2 * p['M'] * Omega)) * coth_val\n            return Omega**2 - omega_bare_sq - (3 * p['beta'] / p['M']) * x2_mean\n        \n        omega_bare = np.sqrt(omega_bare_sq)\n        lower_bound = omega_bare * 1e-6\n        upper_bound = omega_bare * 20\n        \n        # Protect against brentq failure due to boundary signs\n        try:\n            val_lower = scp_equation(lower_bound)\n            val_upper = scp_equation(upper_bound)\n            if np.sign(val_lower) == np.sign(val_upper):\n                upper_bound *= 5\n        except (OverflowError, ValueError):\n            pass\n            \n        omega_scp = brentq(scp_equation, lower_bound, upper_bound, xtol=1e-15, rtol=1e-15)\n        memo_omega_scp[key] = omega_scp\n        return omega_scp\n\n    def get_F_scp(T, V, p):\n        key = ('SCP', T, V)\n        if key in memo_F_vib: return memo_F_vib[key]\n\n        if p['beta'] == 0:\n             return get_F_qha(T, V, p)\n        \n        Omega_scp = solve_omega_scp_for_V_T(V, T, p)\n        \n        arg_coth = HBAR * Omega_scp / (2 * KB * T)\n        coth_val = 1.0 / np.tanh(arg_coth) if arg_coth  300 else 1.0\n        \n        x2_mean = (HBAR / (2 * p['M'] * Omega_scp)) * coth_val\n        \n        F_harm_scp = p['s'] * get_F_harm_mode(T, Omega_scp)\n        correction = p['s'] * (-0.75 * p['beta'] * x2_mean**2)\n        \n        result = F_harm_scp + correction\n        memo_F_vib[key] = result\n        return result\n\n    def get_equilibrium_volume(T, p, model):\n        F_vib_func = get_F_qha if model == 'QHA' else get_F_scp\n\n        def gibbs_G(V):\n            Eel = get_E_el(V, p)\n            Fvib = F_vib_func(T, V, p)\n            return Eel + Fvib + p['P_ext'] * V\n            \n        bounds = (p['V0'] * 0.9, p['V0'] * 1.1)\n        res = minimize_scalar(gibbs_G, bounds=bounds, method='bounded', options={'xatol': 1e-25})\n        return res.x\n\n    for case in test_cases:\n        params = case[\"params\"]\n        \n        memo_F_vib.clear()\n        memo_omega_scp.clear()\n        \n        alphas = []\n        for model in ['QHA', 'SCP']:\n            for T_target in case[\"temps\"]:\n                V_T = get_equilibrium_volume(T_target, params, model)\n                V_plus = get_equilibrium_volume(T_target + DT, params, model)\n                V_minus = get_equilibrium_volume(T_target - DT, params, model)\n                \n                alpha = (1.0 / V_T) * (V_plus - V_minus) / (2.0 * DT)\n                alphas.append(alpha)\n        \n        alpha_qha = alphas[0:2]\n        alpha_scp = alphas[2:4]\n        \n        delta_qha = [(a - a_exp) / a_exp for a, a_exp in zip(alpha_qha, case[\"alpha_exp\"])]\n        delta_scp = [(a - a_exp) / a_exp for a, a_exp in zip(alpha_scp, case[\"alpha_exp\"])]\n        \n        case_result = [\n            round(alpha_qha[0], 7), round(alpha_qha[1], 7),\n            round(alpha_scp[0], 7), round(alpha_scp[1], 7),\n            round(delta_qha[0], 7), round(delta_qha[1], 7),\n            round(delta_scp[0], 7), round(delta_scp[1], 7)\n        ]\n        all_results.append(case_result)\n        \n    # Format the final output string as per requirements\n    print(f\"[{','.join(map(str, all_results))}]\".replace(\" \", \"\"))\n\nsolve()\n```", "id": "2970007"}]}