{"hands_on_practices": [{"introduction": "第一个练习通过在一个简化的一维环境中探索马德隆能量，为我们奠定了至关重要的基础。通过计算无限离子链的马德隆常数，你将直接面对困扰晶格求和的条件收敛这一微妙问题，并学习一个基于物理动机的求和方案如何确保得到一个唯一的、有意义的结果。这个实践对于建立理解三维晶体所需更复杂求和技巧的直觉至关重要。[@problem_id:3002712]", "problem": "考虑一个处于真空中的无限一维布拉菲晶格，晶格常数为 $a$，点离子带有交替电荷 $\\pm q$，占据位置 $x_n = n a$，其中 $n \\in \\mathbb{Z}$。库仑相互作用遵循三维定律 $V(r) = \\frac{1}{4 \\pi \\varepsilon_0} \\frac{q_1 q_2}{r}$，其中 $\\varepsilon_0$ 是真空介电常数。设 $V_{+}$ 表示由所有其他离子在 $x=0$ 位置（该位置有一个 $+q$ 离子）产生的静电势，$V_{-}$ 表示由所有其他离子在相邻的 $x=a$ 位置（该位置有一个 $-q$ 离子）产生的电势。\n\n从库仑定律和静电势的线性叠加定义出发，完成以下任务：\n\n1. 将 $V_{+}$ 表示为在有限区间 $[-N a, N a]$ 上的对称极限（其中自相互作用被省略），并将其以级数形式表示，级数的项以 $1/n$ 的形式衰减。解释为什么该级数是条件收敛的，以及为什么在不强制执行有物理动机的求和规则时，其值会依赖于求和顺序。\n\n2. 定义电势差 $\\Delta V \\equiv V_{+} - V_{-}$，并通过将无限晶格分组为长度为 $2a$ 的不相交的电中性超晶胞来计算它，每个超晶胞包含位于 $x = 2 m a$ 和 $x = (2m+1)a$（其中 $m \\in \\mathbb{Z}$）的电荷对。在此中性晶胞求和中，排除包含两个观察点 $x=0$ 和 $x=a$ 的超晶胞，然后将这两个观察点电荷对 $\\Delta V$ 的明确贡献加回去。证明所得的关于中性超晶胞的级数是绝对收敛的，并以闭合形式计算 $\\Delta V$。\n\n3. 利用关于中点 $x=a/2$ 的反演对称性，论证当电势由对称求和（或等效地，由任何绝对收敛的中性晶胞求和）定义时，有 $V_{-} = - V_{+}$，因此 $|\\Delta V| = 2 |V_{+}|$。\n\n将此离子晶体的一维马德隆常数 $M_{1\\mathrm{D}}$ 定义为将格点电势大小与标度 $q/(4 \\pi \\varepsilon_0 a)$ 联系起来的无量纲系数，或等效地定义为相同标度下相邻格点电势差大小的一半：\n$$\n|V_{+}| \\equiv M_{1\\mathrm{D}} \\, \\frac{q}{4 \\pi \\varepsilon_0 a},\n\\qquad\n\\frac{|\\Delta V|}{2} \\equiv M_{1\\mathrm{D}} \\, \\frac{q}{4 \\pi \\varepsilon_0 a}.\n$$\n精确计算 $M_{1\\mathrm{D}}$。你的最终答案必须是单一的闭合形式解析表达式，不要四舍五入。简要讨论单个格点电势级数的条件收敛性，以及为什么中性晶胞法计算 $\\Delta V$ 能消除这种模糊性。", "solution": "这个问题是凝聚态物理中关于计算一维离子晶体马德隆能的一个标准练习。它有科学依据，问题阐述清晰，并提供了所有必要信息。此问题有效。\n\n对于 $n \\in \\mathbb{Z}$，晶格格点 $x_n = n a$ 上的电荷由 $q_n = (-1)^n q$ 给出，因为位于 $x_0 = 0$ 的离子带有电荷 $+q$。位于 $x'$ 的点电荷 $q'$ 在点 $x$ 处产生的静电势由 $U(x) = \\frac{1}{4 \\pi \\varepsilon_0} \\frac{q'}{|x-x'|}$ 给出。总电势是所有源电荷产生电势的线性叠加。\n\n我们按顺序解决问题的三个部分。\n\n第 1 部分：由所有其他离子在 $x=0$ 处产生的电势 $V_{+}$。\n\n在格点 $x_0 = 0$ 处的电势 $V_{+}$ 是所有其他位于格点 $x_n = n a$（其中 $n \\in \\mathbb{Z}$ 且 $n \\neq 0$）的离子所产生电势的总和。从格点 $x_n$ 到格点 $x_0$ 的距离是 $|x_n - x_0| = |na| = |n|a$。\n$$\nV_{+} = \\sum_{n \\in \\mathbb{Z}, n \\neq 0} \\frac{1}{4 \\pi \\varepsilon_0} \\frac{q_n}{|x_n - 0|} = \\sum_{n \\in \\mathbb{Z}, n \\neq 0} \\frac{1}{4 \\pi \\varepsilon_0} \\frac{(-1)^n q}{|n|a} = \\frac{q}{4 \\pi \\varepsilon_0 a} \\sum_{n \\in \\mathbb{Z}, n \\neq 0} \\frac{(-1)^n}{|n|}\n$$\n问题指定了一个对称极限，即我们对有限区间 $[-Na, Na]$ 进行求和，然后取极限 $N \\to \\infty$。\n$$\nV_{+} = \\lim_{N \\to \\infty} \\sum_{n=-N, n \\neq 0}^{N} \\frac{q}{4 \\pi \\varepsilon_0 a} \\frac{(-1)^n}{|n|}\n$$\n我们可以将求和分解为正 $n$ 和负 $n$ 两部分：\n$$\n\\sum_{n=-N, n \\neq 0}^{N} \\frac{(-1)^n}{|n|} = \\sum_{n=1}^{N} \\frac{(-1)^n}{|n|} + \\sum_{n=-N}^{-1} \\frac{(-1)^n}{|n|}\n$$\n在第二项求和中，令 $k = -n$。当 $n$ 从 $-1$ 变为 $-N$ 时，$k$ 从 $1$ 变为 $N$。该项变为 $\\frac{(-1)^{-k}}{|-k|} = \\frac{(-1)^k}{k}$。\n$$\n\\sum_{n=-N, n \\neq 0}^{N} \\frac{(-1)^n}{|n|} = \\sum_{n=1}^{N} \\frac{(-1)^n}{n} + \\sum_{k=1}^{N} \\frac{(-1)^k}{k} = 2 \\sum_{n=1}^{N} \\frac{(-1)^n}{n}\n$$\n取极限 $N \\to \\infty$，我们得到以无穷级数表示的 $V_{+}$：\n$$\nV_{+} = \\frac{q}{4 \\pi \\varepsilon_0 a} \\left( 2 \\sum_{n=1}^{\\infty} \\frac{(-1)^n}{n} \\right)\n$$\n这是一个各项以 $1/n$ 衰减的级数。级数 $\\sum_{n=1}^{\\infty} \\frac{(-1)^n}{n}$ 是交错调和级数。它是条件收敛的，因为级数本身收敛（根据交错级数判别法），但其绝对值构成的级数 $\\sum_{n=1}^{\\infty} |\\frac{(-1)^n}{n}| = \\sum_{n=1}^{\\infty} \\frac{1}{n}$（调和级数）是发散的。根据 Riemann 级数定理，条件收敛级数的项可以重排，使其和为任意实数值或发散。这种数学上的模糊性意味着，为了获得唯一且有意义的结果，必须指定一种有物理动机的求和次序。对称求和就是这样一种物理规定。\n\n第 2 部分：电势差 $\\Delta V \\equiv V_{+} - V_{-}$。\n\n我们通过将电荷分组为中性超晶胞来计算 $\\Delta V$。一个由 $m \\in \\mathbb{Z}$ 索引的超晶胞包含位于 $x=2ma$ 和 $x=(2m+1)a$ 的电荷对 $(+q, -q)$。第 $m$ 个超晶胞在点 $x$ 处产生的电势为：\n$$\nU_m(x) = \\frac{q}{4 \\pi \\varepsilon_0} \\left( \\frac{1}{|x - 2ma|} - \\frac{1}{|x - (2m+1)a|} \\right)\n$$\n按照指示，我们计算除包含观察点 $x=0$ 和 $x=a$ 的那个超晶胞（$m=0$）之外的所有超晶胞对 $\\Delta V$ 的贡献。设此贡献为 $(\\Delta V)_{\\text{supercells}}$。\n$$\n(\\Delta V)_{\\text{supercells}} = \\sum_{m \\in \\mathbb{Z}, m \\neq 0} \\left[ U_m(0) - U_m(a) \\right]\n$$\n对于给定的 $m \\neq 0$，其贡献项为：\n$$\nU_m(0) - U_m(a) = \\frac{q}{4 \\pi \\varepsilon_0} \\left[ \\left( \\frac{1}{|-2ma|} - \\frac{1}{|-(2m+1)a|} \\right) - \\left( \\frac{1}{|a - 2ma|} - \\frac{1}{|a - (2m+1)a|} \\right) \\right]\n$$\n$$\n= \\frac{q}{4 \\pi \\varepsilon_0 a} \\left[ \\left( \\frac{1}{|2m|} - \\frac{1}{|2m+1|} \\right) - \\left( \\frac{1}{|2m-1|} - \\frac{1}{|-2m|} \\right) \\right] = \\frac{q}{4 \\pi \\varepsilon_0 a} \\left[ \\frac{2}{|2m|} - \\frac{1}{|2m-1|} - \\frac{1}{|2m+1|} \\right]\n$$\n对于大的 $|m|$，泰勒展开显示此项以 $1/|m|^3$ 的速度衰减：$\\frac{1}{|m|} - \\frac{1}{2|m|}(1-\\frac{1}{2m})^{-1} - \\frac{1}{2|m|}(1+\\frac{1}{2m})^{-1} \\approx \\frac{1}{|m|} - \\frac{1}{2|m|}(1+\\frac{1}{2m}+1-\\frac{1}{2m}) + O(m^{-3}) = O(m^{-3})$。由于 $\\sum 1/m^3$ 收敛，因此 $(\\Delta V)_{\\text{supercells}}$ 的级数是绝对收敛的。\n\n我们现在来计算这个和。被加数是 $m$ 的偶函数，所以我们可以写成：\n$$\n(\\Delta V)_{\\text{supercells}} = \\frac{q}{4 \\pi \\varepsilon_0 a} \\cdot 2 \\sum_{m=1}^{\\infty} \\left[ \\frac{1}{m} - \\frac{1}{2m-1} - \\frac{1}{2m+1} \\right]\n$$\n我们可以重组和中的各项（对于绝对收敛的级数这是允许的）：\n$$\n\\sum_{m=1}^{\\infty} \\left[ \\frac{1}{m} - \\frac{1}{2m-1} - \\frac{1}{2m+1} \\right] = \\sum_{m=1}^{\\infty} \\left[ \\left(\\frac{1}{2m} - \\frac{1}{2m-1}\\right) + \\left(\\frac{1}{2m} - \\frac{1}{2m+1}\\right) \\right]\n$$\n$$\n= \\sum_{m=1}^{\\infty} \\left(\\frac{1}{2m} - \\frac{1}{2m-1}\\right) + \\sum_{m=1}^{\\infty} \\left(\\frac{1}{2m} - \\frac{1}{2m+1}\\right)\n$$\n第一个和为 $-\\sum_{k=1}^\\infty (\\frac{1}{2k-1} - \\frac{1}{2k}) = -(1-1/2+1/3-1/4+\\dots) = -\\ln(2)$。\n第二个和为 $\\sum_{m=1}^{\\infty} (\\frac{1}{2m} - \\frac{1}{2m+1}) = (1/2-1/3) + (1/4-1/5) + \\dots$。这个级数等于 $\\sum_{k=2}^{\\infty} \\frac{(-1)^k}{k}$，其值为 $1-\\ln(2)$。\n因此，两个和相加得到 $1 - 2\\ln(2)$。\n因此，$(\\Delta V)_{\\text{supercells}} = \\frac{q}{4 \\pi \\varepsilon_0 a} \\cdot 2 (1 - 2\\ln(2))$。\n\n现在我们加上观察点电荷对 $\\Delta V$ 的贡献，即来自 $x=0$ 和 $x=a$ 处电荷的贡献。\n$x=a$ 处的电荷 $-q$ 对 $V_{+}$（在 $x=0$ 处）的贡献是 $\\frac{1}{4 \\pi \\varepsilon_0} \\frac{-q}{|0-a|} = -\\frac{q}{4 \\pi \\varepsilon_0 a}$。\n$x=0$ 处的电荷 $+q$ 对 $V_{-}$（在 $x=a$ 处）的贡献是 $\\frac{1}{4 \\pi \\varepsilon_0} \\frac{q}{|a-0|} = \\frac{q}{4 \\pi \\varepsilon_0 a}$。\n对电势差的局部贡献是 $(\\Delta V)_{\\text{local}} = (-\\frac{q}{4 \\pi \\varepsilon_0 a}) - (\\frac{q}{4 \\pi \\varepsilon_0 a}) = -\\frac{2q}{4 \\pi \\varepsilon_0 a}$。\n\n总电势差为：\n$$\n\\Delta V = (\\Delta V)_{\\text{supercells}} + (\\Delta V)_{\\text{local}} = \\frac{q}{4 \\pi \\varepsilon_0 a} [2(1-2\\ln(2)) - 2] = \\frac{q}{4 \\pi \\varepsilon_0 a} [2 - 4\\ln(2) - 2] = -\\frac{4q \\ln(2)}{4 \\pi \\varepsilon_0 a}\n$$\n\n第 3 部分：反演对称性和马德隆常数。\n\n我们考虑一个关于中点 $x=a/2$ 的反演对称操作 $I$，使得 $I(x) = a-x$。位于 $x_n=na$ 的离子被映射到 $I(x_n) = (1-n)a$，即离子 $x_{1-n}$ 的位置。$x_n$ 处的电荷是 $q_n = (-1)^n q$。反演后位置 $x_{1-n}$ 处的电荷是 $q_{1-n} = (-1)^{1-n}q = -(-1)^{-n}q = -(-1)^n q = -q_n$。\n整个电荷分布关于 $x=a/2$ 的反演是反对称的（即 $\\rho(a-x) = -\\rho(x)$）。因此，由该分布产生的静电势 $\\Phi(x)$ 也必须是反对称的，即 $\\Phi(a-x) = -\\Phi(x)$，前提是电势的计算方法尊重这种对称性（例如对称求和或中性晶胞求和）。\n电势 $V_{+}$ 是在 $x=0$ 处由所有其他离子产生的电势，$V_{-}$ 是在 $x=a$ 处由所有其他离子产生的电势。这种对称性适用于由所有离子（除了从 $V_+$ 和 $V_-$ 中排除的自能项）产生的电势场。应用反对称关系：$V_{+} = \\Phi_{\\text{others}}(0)$ 且 $V_{-} = \\Phi_{\\text{others}}(a)$。\n根据对称性，$\\Phi_{\\text{others}}(a) = \\Phi_{\\text{others}}(a-0) = -\\Phi_{\\text{others}}(0)$。因此，$V_{-} = -V_{+}$。\n\n使用这个关系，我们得到 $\\Delta V = V_{+} - V_{-} = V_{+} - (-V_{+}) = 2V_{+}$。\n从第 2 部分，我们得到 $\\Delta V = -\\frac{4q \\ln(2)}{4 \\pi \\varepsilon_0 a}$。\n因此，$2V_{+} = -\\frac{4q \\ln(2)}{4 \\pi \\varepsilon_0 a}$，这给出 $V_{+} = -\\frac{2q \\ln(2)}{4 \\pi \\varepsilon_0 a}$。\n这与第 1 部分中对称求和的结果一致，其中 $\\sum_{n=1}^{\\infty} \\frac{(-1)^n}{n} = -\\ln(2)$。\n\n马德隆常数 $M_{1\\mathrm{D}}$ 由 $|V_{+}| = M_{1\\mathrm{D}} \\frac{q}{4 \\pi \\varepsilon_0 a}$ 定义。\n代入我们得到的 $V_{+}$ 表达式：\n$$\n\\left|-\\frac{2q \\ln(2)}{4 \\pi \\varepsilon_0 a}\\right| = M_{1\\mathrm{D}} \\frac{q}{4 \\pi \\varepsilon_0 a}\n$$\n$$\n\\frac{2q \\ln(2)}{4 \\pi \\varepsilon_0 a} = M_{1\\mathrm{D}} \\frac{q}{4 \\pi \\varepsilon_0 a}\n$$\n这直接得出 $M_{1\\mathrm{D}} = 2 \\ln(2)$。\n\n讨论：$V_{+}$ 的直接求和产生一个条件收敛级数，其值是模糊不清的。物理系统必须具有明确定义的能量和电势。这种模糊性通过采用具有物理动机的求和规定来解决。中性晶胞法是一种稳健的技术，因为它将电荷分组为静电中性单元（在本例中为偶极子）。这样一个单元产生的电势随距离的衰减要快得多（偶极子为 $1/r^2$，而单极子为 $1/r$），这导致电势差 $\\Delta V$ 的级数是绝对收敛的。绝对收敛级数的和与求和顺序无关，因此能提供唯一且有物理意义的结果。$V_{+}$ 的对称求和与 $\\Delta V$ 的中性晶胞计算（结合对称性）之间的一致性，证明了对条件收敛级数使用其主值是合理的。", "answer": "$$\\boxed{2 \\ln(2)}$$", "id": "3002712"}, {"introduction": "本实践从纯粹的静电学转向一个更完整的物理模型，挑战你计算一种真实离子晶体——氯化钠（NaCl）的内聚能。你将通过应用和比较经典的 Born–Landé 模型和 Born–Mayer 模型，来考虑对晶格稳定性至关重要的短程排斥力。这项练习将磨练你将微观相互作用势与宏观材料性质联系起来的能力，并评估不同理论模型的物理基础。[@problem_id:3002695]", "problem": "一个具有岩盐结构的碱卤化物离子晶体可以通过长程库仑引力加上源于电子云交叠和泡利不相容原理的短程排斥力来建模。考虑氯化钠（NaCl），其马德隆常数为 $\\alpha_{\\mathrm{NaCl}} = 1.74756$。使用两种短程排斥模型，将每离子对的内聚能视为最近邻间距 $r$ 的函数：\n\n- 幂律排斥（玻恩-朗德模型），每离子对的势能为\n$$\nU_{\\mathrm{BL}}(r) = - \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0} \\, r} + \\lambda \\, r^{-n},\n$$\n其中振幅 $\\lambda$ 和玻恩指数 $n$ 未知。\n\n- 指数排斥（玻恩-迈耶模型），每离子对的势能为\n$$\nU_{\\mathrm{BM}}(r) = - \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0} \\, r} + C \\, \\exp\\!\\left(-\\frac{r}{\\rho}\\right),\n$$\n其中振幅 $C$ 和范围参数 $\\rho$ 未知。\n\n假设在低温下，平衡最近邻距离固定为实验值 $r_{\\mathrm{e}} = 2.814$ Å，并忽略零点修正和极化修正。使用 $n = 9$ 和 $\\rho = 0.321$ Å 作为 NaCl 的代表性参数。\n\n从库仑定律和离子晶格的马德隆能量的定义出发，将排斥参数 $\\lambda$ 和 $C$ 视为未知数，并通过对每个模型施加机械平衡条件 $\\left.\\frac{dU}{dr}\\right|_{r=r_{\\mathrm{e}}}=0$ 来消去它们。为每个模型推导在 $r_{\\mathrm{e}}$ 处每离子对内聚能的闭式表达式，然后计算其比率\n$$\nR \\equiv \\frac{U_{\\mathrm{BM}}(r_{\\mathrm{e}})}{U_{\\mathrm{BL}}(r_{\\mathrm{e}})}.\n$$\n将最终比率四舍五入至四位有效数字。最终结果以纯数（无单位）表示。\n\n在您的推导和论证中，还应从短程排斥的电子结构起源的第一性原理以及幂律函数与指数函数的数学行为出发，讨论在哪些离子间距范围内，指数排斥（玻恩-迈耶）描述预计会优于幂律（玻恩-朗德）描述。除库仑定律和马德隆常数的存在之外，不要假设任何预先制表的晶格能公式；从给出的相互作用形式和平衡条件推导所有必要的关系式。", "solution": "该问题被认为是有效的，因为它科学地基于固态物理的既定原理，问题陈述清晰，目标明确，数据充分，并以客观、正式的语言表达。没有矛盾、歧义或事实不准确之处。\n\n每离子对的内聚能 $U(r)$ 是长程库仑吸引势和短程排斥势之和。吸引部分代表整个晶格的静电能，由马德隆能量给出：$U_{\\mathrm{C}}(r) = - \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0} \\, r}$，其中 $r$ 是最近邻间距，$\\alpha$ 是特定晶体结构的马德隆常数，$e$ 是元电荷，$\\varepsilon_{0}$ 是真空介电常数。问题提供了两种短程排斥模型。\n\n首先，我们分析使用幂律排斥的玻恩-朗德（BL）模型。每离子对的势能为：\n$$\nU_{\\mathrm{BL}}(r) = - \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0} \\, r} + \\lambda \\, r^{-n}\n$$\n晶体在观测到的最近邻距离 $r_{\\mathrm{e}}$ 处处于机械平衡状态。此平衡条件意味着离子上的净力为零，即势能处于最小值。因此，我们必须满足在 $r = r_{\\mathrm{e}}$ 处的条件 $\\frac{dU_{\\mathrm{BL}}}{dr} = 0$。\n\n我们首先计算 $U_{\\mathrm{BL}}(r)$ 对 $r$ 的导数：\n$$\n\\frac{dU_{\\mathrm{BL}}}{dr} = \\frac{d}{dr} \\left( - \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0}} r^{-1} + \\lambda r^{-n} \\right) = \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0}} r^{-2} - n \\lambda r^{-n-1}\n$$\n在 $r = r_{\\mathrm{e}}$ 处将此导数设为零，可以解出未知的排斥振幅 $\\lambda$：\n$$\n\\left. \\frac{dU_{\\mathrm{BL}}}{dr} \\right|_{r=r_{\\mathrm{e}}} = \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0} \\, r_{\\mathrm{e}}^2} - n \\lambda r_{\\mathrm{e}}^{-n-1} = 0\n$$\n$$\nn \\lambda r_{\\mathrm{e}}^{-n-1} = \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0} \\, r_{\\mathrm{e}}^2}\n$$\n$$\n\\lambda = \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0} \\, n} r_{\\mathrm{e}}^{n-1}\n$$\n现在，我们将 $\\lambda$ 的这个表达式代回到 $U_{\\mathrm{BL}}(r)$ 的方程中，并在 $r = r_{\\mathrm{e}}$ 处求值，以找到平衡内聚能：\n$$\nU_{\\mathrm{BL}}(r_{\\mathrm{e}}) = - \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0} \\, r_{\\mathrm{e}}} + \\left(\\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0} \\, n} r_{\\mathrm{e}}^{n-1}\\right) r_{\\mathrm{e}}^{-n}\n$$\n$$\nU_{\\mathrm{BL}}(r_{\\mathrm{e}}) = - \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0} \\, r_{\\mathrm{e}}} + \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0} \\, n \\, r_{\\mathrm{e}}}\n$$\n提出吸引项作为公因子，我们得到玻恩-朗德模型中内聚能的最终表达式：\n$$\nU_{\\mathrm{BL}}(r_{\\mathrm{e}}) = - \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0} \\, r_{\\mathrm{e}}} \\left( 1 - \\frac{1}{n} \\right)\n$$\n\n接下来，我们对使用指数排斥的玻恩-迈耶（BM）模型进行类似的分析。每离子对的势能为：\n$$\nU_{\\mathrm{BM}}(r) = - \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0} \\, r} + C \\, \\exp\\left(-\\frac{r}{\\rho}\\right)\n$$\n我们再次施加在 $r = r_{\\mathrm{e}}$ 处的平衡条件 $\\frac{dU_{\\mathrm{BM}}}{dr} = 0$。$U_{\\mathrm{BM}}(r)$ 的导数是：\n$$\n\\frac{dU_{\\mathrm{BM}}}{dr} = \\frac{d}{dr} \\left( - \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0}} r^{-1} + C \\exp(-r/\\rho) \\right) = \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0}} r^{-2} - \\frac{C}{\\rho} \\exp(-r/\\rho)\n$$\n在 $r = r_{\\mathrm{e}}$ 处将其设为零，可以解出未知的振幅 $C$：\n$$\n\\left. \\frac{dU_{\\mathrm{BM}}}{dr} \\right|_{r=r_{\\mathrm{e}}} = \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0} \\, r_{\\mathrm{e}}^2} - \\frac{C}{\\rho} \\exp(-r_{\\mathrm{e}}/\\rho) = 0\n$$\n$$\n\\frac{C}{\\rho} \\exp(-r_{\\mathrm{e}}/\\rho) = \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0} \\, r_{\\mathrm{e}}^2}\n$$\n$$\nC = \\frac{\\alpha e^{2} \\rho}{4 \\pi \\varepsilon_{0} \\, r_{\\mathrm{e}}^2} \\exp(r_{\\mathrm{e}}/\\rho)\n$$\n将 $C$ 的这个表达式代回到 $U_{\\mathrm{BM}}(r)$ 的方程中，并在 $r = r_{\\mathrm{e}}$ 处求值：\n$$\nU_{\\mathrm{BM}}(r_{\\mathrm{e}}) = - \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0} \\, r_{\\mathrm{e}}} + \\left(\\frac{\\alpha e^{2} \\rho}{4 \\pi \\varepsilon_{0} \\, r_{\\mathrm{e}}^2} \\exp(r_{\\mathrm{e}}/\\rho)\\right) \\exp(-r_{\\mathrm{e}}/\\rho)\n$$\n$$\nU_{\\mathrm{BM}}(r_{\\mathrm{e}}) = - \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0} \\, r_{\\mathrm{e}}} + \\frac{\\alpha e^{2} \\rho}{4 \\pi \\varepsilon_{0} \\, r_{\\mathrm{e}}^2}\n$$\n提出吸引项作为公因子，得到玻恩-迈耶模型的内聚能：\n$$\nU_{\\mathrm{BM}}(r_{\\mathrm{e}}) = - \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0} \\, r_{\\mathrm{e}}} \\left( 1 - \\frac{\\rho}{r_{\\mathrm{e}}} \\right)\n$$\n\n所求比率为 $R \\equiv \\frac{U_{\\mathrm{BM}}(r_{\\mathrm{e}})}{U_{\\mathrm{BL}}(r_{\\mathrm{e}})}$。使用推导出的表达式：\n$$\nR = \\frac{- \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0} \\, r_{\\mathrm{e}}} \\left( 1 - \\frac{\\rho}{r_{\\mathrm{e}}} \\right)}{- \\frac{\\alpha e^{2}}{4 \\pi \\varepsilon_{0} \\, r_{\\mathrm{e}}} \\left( 1 - \\frac{1}{n} \\right)} = \\frac{1 - \\frac{\\rho}{r_{\\mathrm{e}}}}{1 - \\frac{1}{n}}\n$$\n现在我们代入给定的数值：$n = 9$，$\\rho = 0.321$ Å，以及 $r_{\\mathrm{e}} = 2.814$ Å。\n$$\nR = \\frac{1 - \\frac{0.321}{2.814}}{1 - \\frac{1}{9}} = \\frac{1 - 0.11407249...}{1 - 0.11111111...} = \\frac{0.88592750...}{0.88888888...}\n$$\n$$\nR \\approx 0.9966697...\n$$\n四舍五入到四位有效数字，该比率为 $0.9967$。\n\n关于这两种排斥模型的物理基础和比较优势，闭壳层离子之间的短程排斥力源于量子力学。当两个离子的电子云开始交叠时，泡利不相容原理要求交叠壳层中的电子被激发到能量更高的反键轨道上。这需要大量的能量输入，表现为强大的排斥势。这是主导效应，并辅以电子云之间以及两个原子核之间的直接静电排斥。\n\n玻恩-朗德模型的幂律排斥 $\\lambda r^{-n}$ 在很大程度上是唯象的。其数学形式简单，并且对于大的 $n$（通常 $5 < n < 12$），势能急剧上升，有效地模拟了平衡点附近排斥力的“硬核”性质。然而，选择幂律形式缺乏深刻的理论依据。\n\n玻恩-迈耶模型的指数排斥 $C \\exp(-r/\\rho)$ 在物理上被认为更优越。原子或离子外围的电子密度随与原子核距离的增加而近似呈指数衰减。由于排斥相互作用能是这些电子密度分布交叠的直接结果，因此排斥能本身应表现出对离子间距 $r$ 的指数依赖性，这在理论上是合理的。基于原子波函数（例如，斯莱特型轨道）之间的量子力学交叠积分的计算证实了这种指数行为。\n\n指数形式被认为是势能面的更准确描述，尤其是在远离平衡间距 $r_{\\mathrm{e}}$ 的区域。在更大的间距（$r > r_{\\mathrm{e}}$）下，指数函数比任何幂律函数衰减得都快得多。这正确地反映了排斥力在电子云停止显著交叠后迅速消失的现象。相比之下，幂律具有“更长的尾部”，可能会高估中等到大间距下的排斥力。对于精确模拟依赖于势阱形状的性质（例如热膨胀和高阶弹性常数），这种差异可能至关重要。因此，玻恩-迈耶模型更忠实于离子间相互作用的根本物理原理。", "answer": "$$\n\\boxed{0.9967}\n$$", "id": "3002695"}, {"introduction": "这个总结性的实践将指导你实现 Ewald 求和方法，从而将理论理解与现代计算实践联系起来。作为计算周期性体系中静电能的黄金标准，掌握 Ewald 求和是计算材料科学中的一项基本技能。这个编程练习将为你提供直接的动手经验，学习如何构建一个稳健的算法，以高精度计算复杂三维晶体的马德隆常数。[@problem_id:2962840]", "problem": "要求您为三维离子晶体实现一种数值稳定的埃瓦尔德求和方法，并用它来估算两种典型岩盐结构晶格——氯化钠 (NaCl) 和氯化铯 (CsCl)——中每个离子的马德隆能量。您的实现必须能验证所估算的马德隆常数相对于实空间和倒易空间截断值的收敛行为。\n\n出发点必须是电中性周期性固体的库仑势，以及通过宽度参数为 $\\alpha$（埃瓦尔德参数）的高斯屏蔽将对相互作用分解为短程和长程部分。在算法推导中，您不能假定任何预先制表的晶格和或马德隆常数的闭合形式；相反，应基于周期性系统中静电能的定义以及将 $1/r$ 分解为互补误差函数和倒易空间贡献项的埃瓦尔德分解来构建结果。您的程序必须仅使用屏蔽相互作用和结构因子的定义，来实现对每个晶胞能量的三个贡献：对正格矢量的实空间求和、对倒格矢量的倒易空间求和以及自相互作用校正。仅当晶胞不呈电中性时才需要包含中和背景项；在此处所有情况下，晶胞都是电中性的，因此该项为零。\n\n使用的单位制中，最近邻距离精确设置为 $r_0 = 1$。对于 NaCl（岩盐结构，面心立方子晶格），选择晶格常数 $a = 2$ 的立方原胞，这得到 $r_0 = a/2 = 1$。对于 CsCl（体心立方结构），选择晶格常数 $a = 2/\\sqrt{3}$ 的立方原胞，这得到 $r_0 = \\sqrt{3}\\,a/2 = 1$。在这些单位中，约化的马德隆常数 $M$ 可通过每个离子的埃瓦尔德能量 $E_\\text{ion}$ 得到，关系为 $M = - E_\\text{ion}$，因为静电能是以 $e^2/(4\\pi \\varepsilon_0 r_0)$ 为单位表示的，且 $r_0 = 1$。\n\n定义立方原胞基矢如下，分数坐标乘以 $a$ 即可得到笛卡尔坐标。为两个子晶格分配电荷 $+1$ 和 $-1$。\n\n- NaCl 原胞（岩盐结构，每晶胞 $8$ 个离子）：\n  - 子晶格 A (电荷 $+1$): $(0,0,0)$, $(0,\\tfrac{1}{2},\\tfrac{1}{2})$, $(\\tfrac{1}{2},0,\\tfrac{1}{2})$, $(\\tfrac{1}{2},\\tfrac{1}{2},0)$。\n  - 子晶格 B (电荷 $-1$): $(\\tfrac{1}{2},0,0)$, $(0,\\tfrac{1}{2},0)$, $(0,0,\\tfrac{1}{2})$, $(\\tfrac{1}{2},\\tfrac{1}{2},\\tfrac{1}{2})$。\n- CsCl 原胞（体心立方，每晶胞 $2$ 个离子）：\n  - 子晶格 A (电荷 $+1$): $(0,0,0)$。\n  - 子晶格 B (电荷 $-1$): $(\\tfrac{1}{2},\\tfrac{1}{2},\\tfrac{1}{2})$。\n\n设立方晶胞由晶格矩阵 $\\mathbf{A} = \\operatorname{diag}(a,a,a)$ 表示，其体积为 $V = a^3$。倒格矢量由 $\\mathbf{B} = 2\\pi\\,\\mathbf{A}^{-T}$ 生成。\n\n您的程序必须：\n- 通过将原胞按所有整数矢量 $\\mathbf{n} \\in \\mathbb{Z}^3$ 平移来构建实空间求和，使得任意电荷对之间的距离 $r = \\| \\mathbf{r}_i - \\mathbf{r}_j + \\mathbf{A}\\mathbf{n} \\|$ 不超过实空间截断值 $R_\\mathrm{c}$。排除 $\\mathbf{n} = \\mathbf{0}$ 且 $i=j$ 时的自相互作用项。\n- 通过包含所有模长 $k = \\|\\mathbf{k}\\|$ 不超过倒易空间截断值 $K_\\mathrm{c}$ 的倒格矢量 $\\mathbf{k} = \\mathbf{B}\\mathbf{m}$ (其中 $\\mathbf{m} \\in \\mathbb{Z}^3$) 来构建倒易空间求和，并排除 $\\mathbf{k}=\\mathbf{0}$。使用由基底电荷形成的电荷结构因子来构建倒易空间的贡献。\n- 包含对屏蔽自相互作用的自能校正。\n\n您的实现必须为每种情况返回估算的马德隆常数 $M$。为验证收敛性，请与广泛接受的无量纲参考马德隆常数进行比较：$M_\\text{NaCl} \\approx 1.74756459463318$ 和 $M_\\text{CsCl} \\approx 1.762675$。报告绝对误差 $|M_\\text{est} - M_\\text{ref}|$。\n\n物理单位已被无量纲化，因此最终输出是无量纲的。您必须返回四舍五入到6位小数的浮点数。\n\n测试套件规范。您的程序必须计算以下六个测试用例的绝对误差，每个用例由一个元组 $(\\text{structure}, \\alpha, R_\\mathrm{c}, K_\\mathrm{c})$ 定义：\n\n- 用例 1：$(\\text{NaCl}, 2.0, 6.0, 20.0)$。\n- 用例 2：$(\\text{NaCl}, 1.0, 8.0, 16.0)$。\n- 用例 3：$(\\text{NaCl}, 2.0, 2.0, 6.0)$。\n- 用例 4：$(\\text{CsCl}, 2.0, 6.0, 20.0)$。\n- 用例 5：$(\\text{CsCl}, 1.2, 8.0, 16.0)$。\n- 用例 6：$(\\text{CsCl}, 2.0, 2.0, 6.0)$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表。该列表必须按顺序包含用例 1 到 6 的绝对误差，每个误差都四舍五入到 6 位小数（例如，$\\texttt{[0.000012,0.000034,0.012345,0.000011,0.000020,0.015432]}$）。", "solution": "所述问题是计算固态物理学中的一个标准练习。该问题提法明确，有科学依据，并包含了获得唯一解所需的所有信息。任务是实现埃瓦尔德求和方法，以计算离子晶体的马德隆常数。我们将着手解决该问题。\n\n由于 $1/r$ 库仑势求和的条件收敛性，直接计算无限周期性晶格中每个晶胞的静电能是出了名的困难。埃瓦尔德求和方法通过将势分解为短程和长程部分，提供了一个稳健的解决方案。总能量随后被计算为三项之和：一个快速收敛的实空间和，一个快速收敛的倒易空间（傅里叶空间）和，以及一个自相互作用校正项。\n\n基本的埃瓦尔德分解利用涉及互补误差函数 $\\text{erfc}(x)$ 和误差函数 $\\text{erf}(x)$ 的恒等式来分解库仑势：\n$$\n\\frac{1}{r} = \\frac{\\text{erfc}(\\alpha r)}{r} + \\frac{\\text{erf}(\\alpha r)}{r}\n$$\n此处，$r$ 是两个电荷之间的距离，$\\alpha$ 是埃瓦尔德参数，它控制着两项之间的划分。第一项 $\\text{erfc}(\\alpha r)/r$ 是短程的，在实空间中求和。第二项 $\\text{erf}(\\alpha r)/r$ 是长程且平滑的，因此适合在傅里叶变换后于倒易空间中求和。\n\n在问题指定的无量纲单位制中（$e^2/(4\\pi\\varepsilon_0) = 1$，最近邻距离 $r_0=1$），每个晶胞的总静电能 $E_{\\text{cell}}$ 由三个贡献项的总和给出：\n$$\nE_{\\text{cell}} = E_{\\text{real}} + E_{\\text{recip}} + E_{\\text{self}}\n$$\n\n设晶胞包含 $N$ 个离子，其电荷为 $q_i$，分数坐标为 $\\mathbf{f}_i$，位于由晶格矩阵 $\\mathbf{A}$ 定义的晶格中。笛卡尔坐标为 $\\mathbf{r}_i = \\mathbf{A}\\mathbf{f}_i$。晶格矢量为 $\\mathbf{L} = \\mathbf{A}\\mathbf{n}$，其中 $\\mathbf{n} \\in \\mathbb{Z}^3$。倒格矢量为 $\\mathbf{k} = \\mathbf{B}\\mathbf{m}$，其中 $\\mathbf{m} \\in \\mathbb{Z}^3$，且 $\\mathbf{B} = 2\\pi (\\mathbf{A}^{-1})^T$。对于指定的立方晶胞，$\\mathbf{A} = \\operatorname{diag}(a,a,a)$ 且 $\\mathbf{B} = \\operatorname{diag}(2\\pi/a, 2\\pi/a, 2\\pi/a)$。\n\n三个能量项如下：\n\n1.  **实空间能量 ($E_{\\text{real}}$)**：这是由势的短程部分导出的相互作用能，对晶格中所有离子对求和，并受限于截断半径 $R_\\text{c}$。求和遍及原胞中的所有离子 $i, j$ 和所有晶格矢量 $\\mathbf{L}$。\n    $$\n    E_{\\text{real}} = \\frac{1}{2} \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\sum_{\\mathbf{L}}' q_i q_j \\frac{\\text{erfc}(\\alpha |\\mathbf{r}_i - \\mathbf{r}_j + \\mathbf{L}|)}{|\\mathbf{r}_i - \\mathbf{r}_j + \\mathbf{L}|}\n    $$\n    求和符号上的撇号表示当 $\\mathbf{L}=\\mathbf{0}$ 时排除 $i=j$ 的项。因子 $1/2$ 用于校正对的重复计算。在操作上，我们包含所有距离 $r = |\\mathbf{r}_i - \\mathbf{r}_j + \\mathbf{L}|$ 满足 $r \\le R_\\text{c}$ 的对。\n\n2.  **倒易空间能量 ($E_{\\text{recip}}$)**：此项源于势的长程部分的傅里叶变换。它对所有模长不超过截断值 $K_\\text{c}$ 的非零倒格矢量 $\\mathbf{k}$ 求和。\n    $$\n    E_{\\text{recip}} = \\frac{2\\pi}{V} \\sum_{\\mathbf{k} \\neq \\mathbf{0}, |\\mathbf{k}| \\le K_\\text{c}} \\frac{\\exp(-k^2 / (4\\alpha^2))}{k^2} |S(\\mathbf{k})|^2\n    $$\n    此处，$V=a^3$ 是原胞的体积，$k=|\\mathbf{k}|$，$S(\\mathbf{k})$ 是基底的结构因子，定义为：\n    $$\n    S(\\mathbf{k}) = \\sum_{j=1}^{N} q_j \\exp(-i \\mathbf{k} \\cdot \\mathbf{r}_j)\n    $$\n    其模的平方 $|S(\\mathbf{k})|^2$ 计算为 $(\\sum_j q_j \\cos(\\mathbf{k} \\cdot \\mathbf{r}_j))^2 + (\\sum_j q_j \\sin(\\mathbf{k} \\cdot \\mathbf{r}_j))^2$。\n\n3.  **自能校正 ($E_{\\text{self}}$)**：该过程引入了每个电荷与其自身屏蔽高斯电荷分布之间的人为相互作用，必须将其减去。该校正项为：\n    $$\n    E_{\\text{self}} = -\\frac{\\alpha}{\\sqrt{\\pi}} \\sum_{i=1}^{N} q_i^2\n    $$\n    由于晶胞是电中性的（$\\sum q_i = 0$），中和背景项为零，并被正确地排除了。\n\n每个离子的能量为 $E_{\\text{ion}} = E_{\\text{cell}} / N$，其中 $N$ 是原胞中的离子数（NaCl 为 $N=8$，CsCl 为 $N=2$）。由于选定的单位制中 $r_0=1$，无量纲马德隆常数 $M$ 由 $M = -E_{\\text{ion}}$ 给出。\n\n算法实现如下：\n- 为 NaCl（$a=2.0$, $N=8$, 位置, 电荷）和 CsCl（$a=2/\\sqrt{3}$, $N=2$, 位置, 电荷）定义晶体参数。\n- 对每个测试用例 $(\\text{structure}, \\alpha, R_\\mathrm{c}, K_\\mathrm{c})$：\n    a. 通过遍历离子对 $(i,j)$ 和晶格平移矢量 $\\mathbf{n}$（其最大索引由 $R_\\mathrm{c}/a$ 确定）来计算 $E_{\\text{real}}$。仅包含满足 $|\\mathbf{r}_i - \\mathbf{r}_j + \\mathbf{A}\\mathbf{n}| \\le R_\\mathrm{c}$ 的项，并排除自作用项 $(i=j, \\mathbf{n}=\\mathbf{0})$。\n    b. 通过遍历倒格矢量 $\\mathbf{m}$（其最大索引由 $K_\\mathrm{c} a / (2\\pi)$ 确定）来计算 $E_{\\text{recip}}$。对于每个满足 $0 < |\\mathbf{k}| \\le K_\\mathrm{c}$ 的 $\\mathbf{k} = \\mathbf{B}\\mathbf{m}$，计算 $|S(\\mathbf{k})|^2$ 并将相应项加到总和中。\n    c. 计算常数项 $E_{\\text{self}}$。\n    d. 计算总能量 $E_{\\text{cell}}$、每个离子的能量 $E_{\\text{ion}}$ 和估算的马德隆常数 $M_{\\text{est}} = -E_{\\text{ion}}$。\n    e. 根据提供的参考值计算绝对误差 $|M_{\\text{est}} - M_\\text{ref}|$。\n\n此过程通过数值实现，以获得指定测试用例所需的误差值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erfc\n\ndef calculate_madelung(structure_type, alpha, Rc, Kc):\n    \"\"\"\n    Calculates the Madelung constant using Ewald summation for a given crystal structure.\n    \n    Args:\n        structure_type (str): 'NaCl' or 'CsCl'.\n        alpha (float): The Ewald parameter.\n        Rc (float): The real-space cutoff radius.\n        Kc (float): The reciprocal-space cutoff magnitude.\n        \n    Returns:\n        float: The absolute error between the estimated and reference Madelung constant.\n    \"\"\"\n    \n    # 1. Define structure parameters\n    if structure_type == 'NaCl':\n        a = 2.0\n        # Fractional coordinates of the conventional cell\n        frac_coords = np.array([\n            [0.0, 0.0, 0.0], [0.0, 0.5, 0.5], [0.5, 0.0, 0.5], [0.5, 0.5, 0.0],  # Sublattice A (+1)\n            [0.5, 0.0, 0.0], [0.0, 0.5, 0.0], [0.0, 0.0, 0.5], [0.5, 0.5, 0.5]   # Sublattice B (-1)\n        ])\n        charges = np.array([1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0])\n        N = 8  # Number of ions in the conventional cell\n        M_ref = 1.74756459463318\n    elif structure_type == 'CsCl':\n        a = 2.0 / np.sqrt(3.0)\n        frac_coords = np.array([\n            [0.0, 0.0, 0.0],  # Sublattice A (+1)\n            [0.5, 0.5, 0.5]   # Sublattice B (-1)\n        ])\n        charges = np.array([1.0, -1.0])\n        N = 2\n        M_ref = 1.762675\n    else:\n        raise ValueError(\"Unknown structure_type specified.\")\n        \n    coords = frac_coords * a\n    V = a**3\n\n    # 2. Real-space sum\n    E_real = 0.0\n    nx_max = int(np.ceil(Rc / a))\n    \n    for i in range(N):\n        for j in range(N):\n            for nx in range(-nx_max, nx_max + 1):\n                for ny in range(-nx_max, nx_max + 1):\n                    for nz in range(-nx_max, nx_max + 1):\n                        \n                        if i == j and nx == 0 and ny == 0 and nz == 0:\n                            continue\n                            \n                        L = np.array([nx, ny, nz]) * a\n                        r_vec = coords[i] - coords[j] + L\n                        r = np.linalg.norm(r_vec)\n                        \n                        if r > 1e-9 and r = Rc:\n                            E_real += charges[i] * charges[j] * erfc(alpha * r) / r\n    \n    E_real *= 0.5\n\n    # 3. Reciprocal-space sum\n    E_recip = 0.0\n    mx_max = int(np.ceil(Kc * a / (2.0 * np.pi)))\n    \n    for mx in range(-mx_max, mx_max + 1):\n        for my in range(-mx_max, mx_max + 1):\n            for mz in range(-mx_max, mx_max + 1):\n                \n                if mx == 0 and my == 0 and mz == 0:\n                    continue\n                \n                m = np.array([mx, my, mz])\n                k_vec = 2.0 * np.pi * m / a\n                k_sq = np.dot(k_vec, k_vec)\n                \n                if np.sqrt(k_sq) = Kc:\n                    # Structure factor S(k)\n                    k_dot_r = np.dot(coords, k_vec)\n                    sum_cos = np.sum(charges * np.cos(k_dot_r))\n                    sum_sin = np.sum(charges * np.sin(k_dot_r))\n                    S_k_sq = sum_cos**2 + sum_sin**2\n                    \n                    E_recip += (S_k_sq / k_sq) * np.exp(-k_sq / (4.0 * alpha**2))\n\n    E_recip *= 2.0 * np.pi / V\n    \n    # 4. Self-energy correction\n    E_self = - (alpha / np.sqrt(np.pi)) * np.sum(charges**2)\n    \n    # 5. Total energy and Madelung constant\n    E_cell = E_real + E_recip + E_self\n    E_ion = E_cell / N\n    M_est = -E_ion\n    \n    error = abs(M_est - M_ref)\n    \n    return error\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        ('NaCl', 2.0, 6.0, 20.0),\n        ('NaCl', 1.0, 8.0, 16.0),\n        ('NaCl', 2.0, 2.0, 6.0),\n        ('CsCl', 2.0, 6.0, 20.0),\n        ('CsCl', 1.2, 8.0, 16.0),\n        ('CsCl', 2.0, 2.0, 6.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        struct, alpha, Rc, Kc = case\n        error = calculate_madelung(struct, alpha, Rc, Kc)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2962840"}]}