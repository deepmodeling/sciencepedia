{"hands_on_practices": [{"introduction": "对晶体缺陷的任何分析都始于一个基本问题：缺陷在晶格中的什么位置？本练习通过系统地识别和量化面心立方（fcc）晶格中的间隙位置，直接解决了这一问题[@problem_id:2978756]。通过运用晶体学和几何学的基本原理，你将掌握确定四面体和八面体间隙位置的核心技能，这是理解扩散、合金化和缺陷相互作用等后续所有现象的结构基础。", "problem": "一个理想的单原子晶体具有面心立方（fcc）Bravais晶格，其常规立方晶格参数为$a$。常规立方晶胞的晶格点位于分数坐标$\\left(0,0,0\\right)$、$\\left(0,\\tfrac{1}{2},\\tfrac{1}{2}\\right)$、$\\left(\\tfrac{1}{2},0,\\tfrac{1}{2}\\right)$和$\\left(\\tfrac{1}{2},\\tfrac{1}{2},0\\right)$。定义一个间隙位置为空间中的一个点，一个小的测试原子可以被放置在该点，使其最近邻的主体原子分别形成一个正四面体（四面体间隙）或一个正八面体（八面体间隙）。\n\n从fcc Bravais晶格的晶体学定义和由最近邻原子形成的正四面体和正八面体的几何特征出发，完成以下任务：\n\n1. 通过给出代表性的分数坐标，列举出常规立方晶胞内所有对称不等价的四面体和八面体间隙位置，并论证为何它们穷尽了所有这些类型的最近邻间隙。\n\n2. 考虑到空间群对称性以及相邻常规晶胞之间在晶胞边界上位置的共享，确定属于单个常规立方晶胞的四面体和八面体间隙位置的总数。\n\n3. 利用fcc晶格的常规晶胞与原胞之间的关系，计算每个原胞的四面体和八面体间隙位置的密度，该密度定义为与单个原胞关联的此类位置的数量。\n\n将你的最终答案表示为一个双元素行向量$\\left(N_{\\mathrm{tet}},\\,N_{\\mathrm{oct}}\\right)$，给出每个原胞的四面体和八面体位置密度。无需四舍五入。答案是无量纲的，应以精确整数形式给出。", "solution": "该问题要求识别和量化面心立方（fcc）晶格中的四面体和八面体间隙位置。求解过程将首先根据所提供的几何定义确定这些位置的坐标，然后计算每个常规晶胞的位置数量，最后计算每个原胞的位置密度。\n\n**1. 间隙位置的识别和列举**\n\n在边长为$a$的常规立方晶胞中，fcc晶格的原子位于8个角和6个面心。这些原子的分数坐标为$(0,0,0)$、$(\\frac{1}{2},\\frac{1}{2},0)$、$(\\frac{1}{2},0,\\frac{1}{2})$、$(0,\\frac{1}{2},\\frac{1}{2})$以及所有由整数平移生成的位置，这使得所有角（例如$(0,0,0)$, $(1,0,0)$）和面心（例如$(\\frac{1}{2},\\frac{1}{2},0)$, $(1,\\frac{1}{2},\\frac{1}{2})$）都有原子。\n\n**A. 八面体间隙位置**\n\n八面体间隙位置是与形成一个正八面体的6个主体原子等距的点。\n\n我们首先考察常规立方晶胞的体心位置，其分数坐标为$(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$。距离此点最近的主体原子是位于立方体六个面中心的6个原子。这些面心原子的位置是：\n$(\\frac{1}{2}, \\frac{1}{2}, 0)$, $(1, \\frac{1}{2}, \\frac{1}{2})$, $(0, \\frac{1}{2}, \\frac{1}{2})$, $(\\frac{1}{2}, 1, \\frac{1}{2})$, $(\\frac{1}{2}, 0, \\frac{1}{2})$, $(\\frac{1}{2}, \\frac{1}{2}, 1)$。\n从体心位置$(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})a$到这6个面心原子中任意一个的距离都是$\\frac{a}{2}$。例如，到$(\\frac{1}{2}, \\frac{1}{2}, 0)a$的距离是$\\sqrt{(0)^2 + (0)^2 + (\\frac{a}{2})^2} = \\frac{a}{2}$。\n这6个原子形成一个以$(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$为中心的正八面体。因此，体心是一个八面体间隙位置。\n\n接下来，考虑常规晶胞棱的中点，例如分数坐标为$(\\frac{1}{2}, 0, 0)$的点。其最近邻原子是位于$(0,0,0)$和$(1,0,0)$的两个角上原子，以及位于$(\\frac{1}{2}, \\frac{1}{2}, 0)$、$(\\frac{1}{2}, -\\frac{1}{2}, 0)$、$(\\frac{1}{2}, 0, \\frac{1}{2})$和$(\\frac{1}{2}, 0, -\\frac{1}{2})$的四个面心原子。请注意，其中两个面心原子位于相邻的晶胞中。从$(\\frac{1}{2}, 0, 0)a$到这6个原子中任意一个的距离都是$\\frac{a}{2}$。这6个原子也形成一个正八面体。因此，常规晶胞所有12条棱的中点也都是八面体间隙位置。\n\n在fcc晶格（空间群Fm-3m）中，所有八面体位置都是对称等价的。体心位置$(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$可以通过晶格基矢的平移映射到一个棱心位置。例如，将位置$(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$沿fcc基矢平移$(\\frac{1}{2}, \\frac{1}{2}, 0)$得到$(1, 1, \\frac{1}{2})$，此位置在晶体学上等价于棱心位置$(0, 0, \\frac{1}{2})$。因此，只有一种对称不等价的八面体位置。我们选择$(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$作为其代表性分数坐标。\n\n**B. 四面体间隙位置**\n\n四面体间隙位置是与形成一个正四面体的4个主体原子等距的点。\n\n我们将常规晶胞划分为8个更小的立方体（卦限），每个小立方体的边长为$\\frac{a}{2}$。考虑位于原点的卦限，这是一个角点从$(0,0,0)$到$(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$的立方体。这个小立方体中被主体原子占据的顶点是位于$(0,0,0)$的角上原子和位于$(\\frac{1}{2}, \\frac{1}{2}, 0)$、$(\\frac{1}{2}, 0, \\frac{1}{2})$和$(0, \\frac{1}{2}, \\frac{1}{2})$的三个面心原子。\n这四个原子形成一个正四面体。它们中任意两者之间的距离都是fcc晶格中的最近邻距离，$d = \\sqrt{(\\frac{a}{2})^2 + (\\frac{a}{2})^2} = \\frac{a}{\\sqrt{2}}$。\n这个四面体的中心是该卦限的几何中心，其分数坐标为$(\\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4})$。从该点到四个配位原子中任意一个的距离是$\\sqrt{(\\frac{a}{4})^2 + (\\frac{a}{4})^2 + (\\frac{a}{4})^2} = \\frac{a\\sqrt{3}}{4}$。因此，点$(\\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4})$是一个四面体间隙位置。\n\n根据对称性，常规晶胞的8个卦限中，每个的中心都有一个相同的四面体位置。这8个位置的坐标形式相对于晶胞中心$(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$为$(\\pm\\frac{1}{4}, \\pm\\frac{1}{4}, \\pm\\frac{1}{4})$，从而得到绝对坐标：$(\\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4})$、$(\\frac{3}{4}, \\frac{1}{4}, \\frac{1}{4})$、$(\\frac{1}{4}, \\frac{3}{4}, \\frac{1}{4})$、$(\\frac{1}{4}, \\frac{1}{4}, \\frac{3}{4})$、$(\\frac{3}{4}, \\frac{3}{4}, \\frac{1}{4})$、$(\\frac{3}{4}, \\frac{1}{4}, \\frac{3}{4})$、$(\\frac{1}{4}, \\frac{3}{4}, \\frac{3}{4})$和$(\\frac{3}{4}, \\frac{3}{4}, \\frac{3}{4})$。\n所有这8个位置都是对称等价的。例如，位于$(\\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4})$的位置可以通过关于晶胞中心$(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$的反演操作映射到$(\\frac{3}{4}, \\frac{3}{4}, \\frac{3}{4})$，而反演是fcc晶格的一个对称操作。因此，只有一种对称不等价的四面体位置。我们选择$(\\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4})$作为其代表性分数坐标。\n\n“配位主体原子形成一个正多面体”这一严格要求确保了这些位置必须处于高对称性位置。一个完整的群论分析（使用Wyckoff位置）证实了这些是满足给定最近邻定义的唯一类型的间隙位置。\n\n**2. 每个常规晶胞的位置数**\n\n为了求出属于单个常规晶胞的总位置数，我们必须考虑晶胞边界上位置的共享。\n\n*   **四面体位置 ($N_{\\mathrm{tet, conv}}$)**:\n    8个四面体位置，其坐标如$(\\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4})$和$(\\frac{3}{4}, \\frac{1}{4}, \\frac{1}{4})$，都完全位于常规晶胞内部。它们的坐标没有一个是$0$或$1$。因此，它们不与相邻晶胞共享。\n    每个常规晶胞的四面体位置总数为8。\n    $$N_{\\mathrm{tet, conv}} = 8$$\n\n*   **八面体位置 ($N_{\\mathrm{oct, conv}}$)**:\n    八面体位置出现在两类地方：\n    1.  立方体的体心：在$(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$处有$1$个这样的位置。它完全在晶胞内部，对计数贡献为$1$。\n    2.  棱的中点：一个立方体有$12$条棱。每条棱上的位置（例如在$(\\frac{1}{2}, 0, 0)$）被$4$个相邻的常规晶胞共享。因此，每个棱上位置对计数的贡献为$\\frac{1}{4}$。\n    来自棱上位置的总贡献是$12 \\times \\frac{1}{4} = 3$。\n    每个常规晶胞的八面体位置总数是这些贡献的总和：\n    $$N_{\\mathrm{oct, conv}} = 1 (\\text{体心}) + 12 \\times \\frac{1}{4} (\\text{棱心}) = 1 + 3 = 4$$\n\n**3. 每个原胞的位置密度**\n\n每个原胞的间隙位置密度是每个主体原子的间隙位置数。首先，我们确定一个常规fcc晶胞中的原子数（$N_{\\mathrm{atoms, conv}}$）。\n有8个原子在角上，每个被8个晶胞共享；6个原子在面心，每个被2个晶胞共享。\n$$N_{\\mathrm{atoms, conv}} = 8 \\times \\frac{1}{8} + 6 \\times \\frac{1}{2} = 1 + 3 = 4$$\n一个常规fcc晶胞包含4个原子（因此等效于4个原胞，因为根据定义，一个原胞包含1个原子）。\n\n每种位置在每个原胞中的密度是常规晶胞中的总位置数除以常规晶胞中的原子数。\n\n*   **四面体位置密度 ($N_{\\mathrm{tet}}$)**:\n    $$N_{\\mathrm{tet}} = \\frac{N_{\\mathrm{tet, conv}}}{N_{\\mathrm{atoms, conv}}} = \\frac{8}{4} = 2$$\n    每个原胞有$2$个四面体位置。\n\n*   **八面体位置密度 ($N_{\\mathrm{oct}}$)**:\n    $$N_{\\mathrm{oct}} = \\frac{N_{\\mathrm{oct, conv}}}{N_{\\mathrm{atoms, conv}}} = \\frac{4}{4} = 1$$\n    每个原胞有$1$个八面体位置。\n\n最终答案是密度对$(N_{\\mathrm{tet}}, N_{\\mathrm{oct}})$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix} 2 & 1 \\end{pmatrix}\n}\n$$", "id": "2978756"}, {"introduction": "在确定了间隙缺陷的可能位置之后，下一步是理解它们的能量学行为，特别是它们的电荷态是如何由周围的电子环境决定的。这个练习将引导你运用基本的宏观热力学原理，推导出缺陷形成能与费米能级之间的线性关系[@problem_id:2852086]。掌握这一关系使你能够计算电荷转变能级，这是构建和解释缺陷形成能图的关键，也是预测半导体中缺陷电学活性的核心方法。", "problem": "半导体晶体中的点缺陷是在原子库和电子库存在的情况下形成的。考虑一个巨正则形成过程，在此过程中，缺陷与具有化学势的原子库交换原子，并与化学势（费米能级）为 $E_F$ 的电子库交换电子。设该缺陷为二元化合物中的一个空位，并选择价带顶为能量零点，因此带隙内的费米能级满足 $E_F \\ge 0$。假设温度足够低，以致于形成自由能的熵贡献可以忽略不计，且形成能可以很好地用基态能量和化学势来近似。\n\n从电荷态为 $q$ 的缺陷的形成能的热力学定义出发——该定义是通过对电子数使用电子化学势 $E_F$ 进行勒让德变换而构建的——推导形成能 $E_f^q(E_F)$ 对 $E_F$ 的函数依赖关系，并求出其对于一般整数 $q$ 的斜率 $\\mathrm{d}E_f^q/\\mathrm{d}E_F$。\n\n然后，考虑一个特定的空位，通过可靠的计算已知其在价带顶处的以下总形成能：\n- $E_f^{+1}(0) = 2.70\\,\\mathrm{eV}$，\n- $E_f^{0}(0) = 3.10\\,\\mathrm{eV}$。\n\n此处 $E_f^{q}(0)$ 表示在 $E_F = 0$（即价带顶）处计算的形成能。利用您推导出的斜率结果以及热力学电荷态跃迁能级的定义（即两种电荷态具有相等形成能时的费米能级），计算相对于价带顶定义的跃迁能级 $\\varepsilon(+1/0)$。\n\n用电子伏特表示最终答案，并将答案四舍五入到四位有效数字。", "solution": "该问题要求推导缺陷形成能对费米能级的函数依赖关系、该函数的斜率，并随后计算一个特定的电荷态跃迁能级。\n\n首先，我们必须建立电荷态为 $q$ 的点缺陷的形成能的热力学定义，记作 $E_f^q$。该系统是一个晶体，与原子库（每种原子 $i$ 的化学势为 $\\mu_i$）和电子库（化学势为 $E_F$，即费米能级）接触。这对应于一个巨正则系综。\n\n形成能 $E_f^q$ 是有缺陷和无缺陷系统巨势的差值。当形成一个缺陷时，有 $n_i$ 个 $i$ 类原子与原子库交换，并且与净电荷 $q$ 相对应的电子数与电子库交换。符号约定是：从原子库添加到晶体中的原子数 $n_i > 0$；$q$ 是缺陷的净电荷，意味着有 $q$ 个电子从缺陷中移出并转移到能量为 $E_F$ 的电子库中。形成能由下式给出：\n$$\nE_f^q(E_F, \\{\\mu_i\\}) = E_{tot}(defect, q) - E_{tot}(perfect) - \\sum_i n_i \\mu_i + q E_{F}\n$$\n其中 $E_{tot}(defect, q)$ 是含有一个电荷态为 $q$ 的缺陷的晶体的总能量，$E_{tot}(perfect)$ 是完美晶体的总能量。问题指明，价带顶（VBM）是能量标度的零点，因此 $E_F$ 是从价带顶开始测量的。\n\n项 $[E_{tot}(defect, q) - E_{tot}(perfect) - \\sum_i n_i \\mu_i]$ 依赖于电荷态 $q$ 和原子化学势 $\\{\\mu_i\\}$，但独立于费米能级 $E_F$。该项表示费米能级位于参考能量零点，即位于价带顶（$E_F=0$）时的形成能。我们将此量记作 $E_f^q(0)$：\n$$\nE_f^q(0) = E_{tot}(defect, q) - E_{tot}(perfect) - \\sum_i n_i \\mu_i\n$$\n将其代入一般表达式，我们得到形成能对费米能级的函数依赖关系：\n$$\nE_f^q(E_F) = E_f^q(0) + qE_F\n$$\n该方程表明，特定电荷态 $q$ 的缺陷的形成能是费米能级 $E_F$ 的线性函数。\n\n第二个任务是求此函数的斜率，即其对 $E_F$ 的导数。对上述表达式求导：\n$$\n\\frac{\\mathrm{d}E_f^q}{\\mathrm{d}E_F} = \\frac{\\mathrm{d}}{\\mathrm{d}E_F} \\left[ E_f^q(0) + qE_F \\right]\n$$\n由于 $E_f^q(0)$ 是一个相对于 $E_F$ 的常数，其导数为零。$qE_F$ 对 $E_F$ 的导数就是 $q$。\n因此，斜率为：\n$$\n\\frac{\\mathrm{d}E_f^q}{\\mathrm{d}E_F} = q\n$$\n形成能对费米能级图的斜率等于缺陷的电荷态。\n\n最后的任务是计算热力学电荷态跃迁能级 $\\varepsilon(+1/0)$。该能级定义为两种电荷态 $q=+1$ 和 $q=0$ 的形成能相等时的费米能级 $E_F$ 的值。\n$$\nE_f^{+1}(\\varepsilon(+1/0)) = E_f^{0}(\\varepsilon(+1/0))\n$$\n对每种电荷态使用推导出的线性关系：\n$$\nE_f^{+1}(0) + (+1)\\varepsilon(+1/0) = E_f^{0}(0) + (0)\\varepsilon(+1/0)\n$$\n这可以简化为：\n$$\nE_f^{+1}(0) + \\varepsilon(+1/0) = E_f^{0}(0)\n$$\n求解跃迁能级 $\\varepsilon(+1/0)$：\n$$\n\\varepsilon(+1/0) = E_f^{0}(0) - E_f^{+1}(0)\n$$\n我们已知在价带顶（$E_F=0$）处的形成能的数值：\n- $E_f^{+1}(0) = 2.70\\,\\mathrm{eV}$\n- $E_f^{0}(0) = 3.10\\,\\mathrm{eV}$\n\n将这些值的数值部分代入跃迁能级的表达式中：\n$$\n\\varepsilon(+1/0) = 3.10 - 2.70 = 0.40\n$$\n由于形成能以电子伏特（$\\mathrm{eV}$）为单位，因此得到的跃迁能级也以电子伏特为单位。因此，$\\varepsilon(+1/0) = 0.40\\,\\mathrm{eV}$。\n问题要求答案以电子伏特表示，并四舍五入到四位有效数字。计算值为 $0.40$。为了用四位有效数字表示，我们写作 $0.4000$。", "answer": "$$\n\\boxed{0.4000}\n$$", "id": "2852086"}, {"introduction": "单个缺陷的性质固然重要，但材料的宏观电子特性是由所有载流子和带电缺陷的集体行为决定的。本实践将前述概念融会贯通，要求你建立并求解电中性方程，以自洽地确定含有多种缺陷的半导体的费米能级 $E_F$ [@problem_id:2978777]。通过这项计算练习，你将体验到如何从第一性原理出发，结合统计力学和数值方法，预测缺陷对材料电子性质的真实影响，这是现代材料物理研究中的一项核心技能。", "problem": "您需要基于平衡统计力学和电荷守恒的第一性原理，推导、实现并计算一个含有带电空位和间隙原子的半导体的自洽费米能级。该系统被定义为一个具有抛物线形能带和稀疏缺陷的单一、非简并半导体。所有能量必须以电子伏特 (eV) 为单位，所有温度以开尔文 (K) 为单位，所有数密度以每立方厘米 (cm$^{-3}$) 为单位。最终结果必须以 eV 表示。\n\n从基本定律和核心定义出发，使用以下基础：\n- 平衡状态下的电荷守恒要求总净电荷密度为零。净电荷密度是正电荷密度之和减去负电荷密度之和，并且依赖于费米能级 $E_F$。\n- 导带底的能量为 $E_c$，价带顶的能量为 $E_v$，带隙为 $E_g = E_c - E_v$。按照惯例，设 $E_v = 0$，因此 $E_c = E_g$，并以 $E_v$ 为参考点来衡量 $E_F$。\n- 在针对具有抛物线形能带的非简并载流子的麦克斯韦-玻尔兹曼近似下，电子和空穴的数密度作为温度 $T$ 下 $E_F$ 的函数，由有效态密度和非简并极限下的费米-狄拉克统计给出：$n(E_F,T)$ 和 $p(E_F,T)$。您必须使用玻尔兹曼常数 $k_B$，将它们表示为 $N_c$、$N_v$、$E_g$、$E_F$ 和 $T$ 的函数。\n- 对于每种缺陷 $j$（例如空位或间隙原子），列举其允许的电荷态 $q$，并给出在 $E_F = 0$ 时的形成能，记为 $E_{f,0}^{(j,q)}$。处于电荷态 $q$ 的缺陷的稀疏平衡浓度与一个玻尔兹曼因子成正比，该因子由当前 $E_F$ 下的形成能、位点密度 $N_{\\text{sites}}^{(j)}$ 以及一个可选的简并因子 $g^{(j,q)}$ 决定。形成能通过电荷 $q$ 线性地依赖于 $E_F$。\n\n通过将总正电荷密度与总负电荷密度相等，推导出电中性条件，其中电荷密度用 $p(E_F,T)$、$n(E_F,T)$ 以及由各缺陷电荷态浓度构建的缺陷电荷密度来表示。将中性函数写成一个关于 $E_F$ 的标量函数，该函数在平衡时必须为零，并解释其单调性和连续性如何确保在带隙内可靠地找到 $E_F$ 的根。然后设计一个算法来自洽地求解 $E_F(T)$：对于给定的参数，构建中性函数，并使用一个稳健的有界求根方法在物理上有意义的区间内找到唯一的 $E_F$。如果需要，实现一个系统性的区间搜索以保证找到符号变化。\n\n实现一个完整的程序，对下面的每个测试用例，计算相对于价带顶的自洽费米能级 $E_F$（以 eV 为单位），结果四舍五入到六位小数。您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔的结果列表（例如，“[result1,result2,result3]”）。\n\n所有数学符号、变量、函数、运算符和数字都必须用 LaTeX 书写。任何输出的物理单位都必须明确指定。不涉及角度。如果需要分数，则必须表示为小数。\n\n使用玻尔兹曼常数 $k_B = 8.617333262145 \\times 10^{-5}$ eV/K。对于每种缺陷 $j$，将在温度 $T$ 和费米能级 $E_F$ 下电荷态 $q$ 的浓度建模为\n$$\nc^{(j,q)}(E_F,T) = N_{\\text{sites}}^{(j)} \\, g^{(j,q)} \\, \\exp\\!\\left( -\\frac{E_{f}^{(j,q)}(E_F)}{k_B T} \\right),\n$$\n并且\n$$\nE_{f}^{(j,q)}(E_F) = E_{f,0}^{(j,q)} + q \\, E_F.\n$$\n假设缺陷是稀疏的，因此位点耗尽可以忽略不计，且电荷态之间无相互作用。\n\n将具有抛物线形能带的非简并半导体的电子和空穴密度定义为\n$$\nn(E_F,T) = N_c \\, \\exp\\!\\left( -\\frac{E_c - E_F}{k_B T} \\right), \\quad\np(E_F,T) = N_v \\, \\exp\\!\\left( -\\frac{E_F - E_v}{k_B T} \\right),\n$$\n其中 $E_v = 0$ 且 $E_c = E_g$。这些是在麦克斯韦-玻尔兹曼近似下经过充分检验的公式。\n\n中性函数由总正电荷密度和总负电荷密度之间的差值构建。该函数在平衡时必须为零。使用有界求根方法在区间 $[0, E_g]$ 内求解 $E_F$；如果不能立即找到符号变化，则在扩展的区间上实现系统性的区间搜索，以可靠地定位一个符号变化。\n\n测试套件和参数（所有能量单位为 eV，所有密度单位为 cm$^{-3}$；$E_F$ 必须以 eV 为单位返回，且相对于 $E_v$）：\n- 测试用例 $1$（类本征，中等缺陷）：\n  - $E_g = 1.12$，$N_c = 2.8 \\times 10^{19}$，$N_v = 1.04 \\times 10^{19}$，$T = 300$。\n  - 空位：$N_{\\text{sites}}^{(\\mathrm{V})} = 5.0 \\times 10^{22}$；电荷态 $q = [0, -1, -2]$；$E_{f,0}^{(\\mathrm{V},q)} = [3.6, 3.4, 3.3]$；$g^{(\\mathrm{V},q)} = [1, 1, 1]$。\n  - 间隙原子：$N_{\\text{sites}}^{(\\mathrm{I})} = 5.0 \\times 10^{22}$；电荷态 $q = [0, +1, +2]$；$E_{f,0}^{(\\mathrm{I},q)} = [3.6, 3.7, 3.9]$；$g^{(\\mathrm{I},q)} = [1, 1, 1]$。\n- 测试用例 $2$（高温，类施主间隙原子）：\n  - $E_g = 1.12$，$N_c = 2.8 \\times 10^{19}$，$N_v = 1.04 \\times 10^{19}$，$T = 1000$。\n  - 空位：$N_{\\text{sites}}^{(\\mathrm{V})} = 5.0 \\times 10^{22}$；电荷态 $q = [0, -1, -2]$；$E_{f,0}^{(\\mathrm{V},q)} = [3.8, 3.6, 3.5]$；$g^{(\\mathrm{V},q)} = [1, 1, 1]$。\n  - 间隙原子：$N_{\\text{sites}}^{(\\mathrm{I})} = 5.0 \\times 10^{22}$；电荷态 $q = [0, +1, +2]$；$E_{f,0}^{(\\mathrm{I},q)} = [2.0, 1.4, 1.5]$；$g^{(\\mathrm{I},q)} = [1, 1, 1]$。\n- 测试用例 $3$（窄带隙半导体，平衡缺陷）：\n  - $E_g = 0.5$，$N_c = 1.5 \\times 10^{19}$，$N_v = 1.5 \\times 10^{19}$，$T = 600$。\n  - 空位：$N_{\\text{sites}}^{(\\mathrm{V})} = 1.0 \\times 10^{22}$；电荷态 $q = [0, -1, -2]$；$E_{f,0}^{(\\mathrm{V},q)} = [2.2, 2.0, 1.9]$；$g^{(\\mathrm{V},q)} = [1, 1, 1]$。\n  - 间隙原子：$N_{\\text{sites}}^{(\\mathrm{I})} = 1.0 \\times 10^{22}$；电荷态 $q = [0, +1]$；$E_{f,0}^{(\\mathrm{I},q)} = [2.5, 2.6]$；$g^{(\\mathrm{I},q)} = [1, 1]$。\n- 测试用例 $4$（无缺陷，本征参考）：\n  - $E_g = 1.12$，$N_c = 2.8 \\times 10^{19}$，$N_v = 1.04 \\times 10^{19}$，$T = 300$。\n  - 空位：$N_{\\text{sites}}^{(\\mathrm{V})} = 0$；电荷态 $q = [0]$；$E_{f,0}^{(\\mathrm{V},q)} = [10.0]$；$g^{(\\mathrm{V},q)} = [1]$。\n  - 间隙原子：$N_{\\text{sites}}^{(\\mathrm{I})} = 0$；电荷态 $q = [0]$；$E_{f,0}^{(\\mathrm{I},q)} = [10.0]$；$g^{(\\mathrm{I},q)} = [1]$。\n- 测试用例 $5$（重度类施主间隙原子）：\n  - $E_g = 1.8$，$N_c = 2.0 \\times 10^{19}$，$N_v = 2.0 \\times 10^{19}$，$T = 800$。\n  - 空位：$N_{\\text{sites}}^{(\\mathrm{V})} = 1.0 \\times 10^{22}$；电荷态 $q = [0, -1]$；$E_{f,0}^{(\\mathrm{V},q)} = [3.0, 2.8]$；$g^{(\\mathrm{V},q)} = [1, 1]$。\n  - 间隙原子：$N_{\\text{sites}}^{(\\mathrm{I})} = 1.0 \\times 10^{22}$；电荷态 $q = [0, +1]$；$E_{f,0}^{(\\mathrm{I},q)} = [1.0, 0.6]$；$g^{(\\mathrm{I},q)} = [1, 2]$。\n\n您的程序必须计算每个测试用例的 $E_F$，并打印单行结果，该行包含一个由方括号括起来的、包含五个 $E_F$ 值的逗号分隔列表（以 eV 为单位，四舍五入到六位小数）。例如，一个有效的输出行是“[0.547200,0.650000,0.250000,0.547200,1.676000]”。", "solution": "本问题要求通过求解电中性方程来确定半导体在给定温度下的自洽费米能级 $E_F$。我们将遵循问题描述中概述的步骤：推导电中性方程，构建中性函数，分析其性质，并设计求解算法。\n\n**1. 电中性方程的推导**\n\n在热力学平衡状态下，半导体晶体必须保持宏观上的电中性。这意味着总的正电荷密度必须等于总的负电荷密度。系统中的带电粒子包括：\n- **正电荷**: 价带中的空穴（密度为 $p$）和带正电荷 $q>0$ 的缺陷（浓度为 $c^{(j,q)}$）。\n- **负电荷**: 导带中的电子（密度为 $n$）和带负电荷 $q0$ 的缺陷（浓度为 $c^{(j,q)}$）。\n\n因此，电中性条件可以写为：\n$$\n\\sum_{\\text{正电荷}} \\rho^+ = \\sum_{\\text{负电荷}} \\rho^-\n$$\n$$\np(E_F, T) + \\sum_{j} \\sum_{q>0} q \\cdot c^{(j,q)}(E_F, T) = n(E_F, T) + \\sum_{j} \\sum_{q0} |q| \\cdot c^{(j,q)}(E_F, T)\n$$\n其中 $j$ 遍历所有缺陷种类（例如空位和间隙原子）。\n\n**2. 中性函数的构建**\n\n为了便于求解，我们将所有项移到等式的一侧，定义一个中性函数 $\\mathcal{N}(E_F)$，其根对应于满足电中性条件的费米能级 $E_F$。\n$$\n\\mathcal{N}(E_F) = p(E_F, T) - n(E_F, T) + \\sum_{j} \\sum_{q} q \\cdot c^{(j,q)}(E_F, T) = 0\n$$\n这里我们利用了 $|q| = -q$ 对于 $q0$。将问题中给出的表达式代入：\n- $p(E_F, T) = N_v \\exp\\left( -\\frac{E_F - E_v}{k_B T} \\right)$\n- $n(E_F, T) = N_c \\exp\\left( -\\frac{E_c - E_F}{k_B T} \\right)$\n- $c^{(j,q)}(E_F, T) = N_{\\text{sites}}^{(j)} g^{(j,q)} \\exp\\left( -\\frac{E_{f,0}^{(j,q)} + q E_F}{k_B T} \\right)$\n\n将这些代入后，$\\mathcal{N}(E_F)$ 成为一个只依赖于 $E_F$ 的复杂非线性函数（在给定温度和材料参数下）。\n\n**3. 函数性质与求解**\n\n为了可靠地找到根，我们分析 $\\mathcal{N}(E_F)$ 的性质。\n- **连续性**: 函数中所有项（指数函数）都是 $E_F$ 的连续函数，因此 $\\mathcal{N}(E_F)$ 也是连续的。\n- **单调性**: 我们考察函数对 $E_F$ 的导数：\n$$\n\\frac{d\\mathcal{N}}{dE_F} = \\frac{dp}{dE_F} - \\frac{dn}{dE_F} + \\sum_{j,q} q \\frac{dc^{(j,q)}}{dE_F}\n$$\n各项的导数分别为：\n- $\\frac{dp}{dE_F} = -\\frac{p(E_F, T)}{k_B T}  0$\n- $-\\frac{dn}{dE_F} = - \\left( \\frac{n(E_F, T)}{k_B T} \\right)  0$\n- $\\frac{dc^{(j,q)}}{dE_F} = c^{(j,q)}(E_F, T) \\cdot \\left(-\\frac{q}{k_B T}\\right)$\n- 因此，缺陷项的导数为 $\\sum_{j,q} q^2 \\left(-\\frac{c^{(j,q)}(E_F, T)}{k_B T}\\right) \\le 0$。\n\n由于所有项的导数都小于或等于零（并且至少有一项严格小于零），$\\frac{d\\mathcal{N}}{dE_F}$ 严格为负。这意味着 $\\mathcal{N}(E_F)$ 是一个关于 $E_F$ 的严格单调递减函数。\n一个连续的、严格单调的函数最多只有一个根。此外，当 $E_F \\to -\\infty$ 时，$p(E_F)$ 占主导，$\\mathcal{N}(E_F) \\to +\\infty$。当 $E_F \\to +\\infty$ 时，$n(E_F)$ 占主导，$\\mathcal{N}(E_F) \\to -\\infty$。因此，在 $(-\\infty, \\infty)$ 区间内保证存在一个且仅有一个根。\n\n**4. 算法设计**\n\n基于上述性质，我们可以设计一个稳健的算法来求解 $E_F$：\n1.  **定义函数**: 实现一个计算 $\\mathcal{N}(E_F)$ 值的函数，该函数以 $E_F$ 为输入，并使用所有给定的材料参数（$E_g, N_c, N_v, T$ 以及所有缺陷的参数）。\n2.  **设定搜索区间**: 物理上有意义的费米能级通常位于带隙 $[E_v, E_c]$ 内或其附近。由于我们保证了根的存在，可以选择一个足够宽的区间，例如 $[-1\\,\\text{eV}, E_g+1\\,\\text{eV}]$，来确保根位于该区间内，即 $\\mathcal{N}(-1)$ 和 $\\mathcal{N}(E_g+1)$ 异号。\n3.  **求解**: 使用一个有界的求根算法，如二分法或更高效的布伦特方法（Brent's method），在设定的区间内寻找 $\\mathcal{N}(E_F)=0$ 的根。该方法收敛速度快且保证能找到根。\n4.  **实现**: 下面的 Python 代码实现了这一算法，并对给定的所有测试用例计算 $E_F$。\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the self-consistent Fermi level in a semiconductor for multiple test cases.\n    \"\"\"\n    \n    # Define the Boltzmann constant in eV/K.\n    k_B = 8.617333262145e-5\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (intrinsic-like, moderate defects)\n        {\n            \"Eg\": 1.12, \"Nc\": 2.8e19, \"Nv\": 1.04e19, \"T\": 300,\n            \"defects\": [\n                {\"N_sites\": 5.0e22, \"q\": [0, -1, -2], \"Ef0\": [3.6, 3.4, 3.3], \"g\": [1, 1, 1]},\n                {\"N_sites\": 5.0e22, \"q\": [0, +1, +2], \"Ef0\": [3.6, 3.7, 3.9], \"g\": [1, 1, 1]}\n            ]\n        },\n        # Test case 2 (high temperature, donor-like interstitials)\n        {\n            \"Eg\": 1.12, \"Nc\": 2.8e19, \"Nv\": 1.04e19, \"T\": 1000,\n            \"defects\": [\n                {\"N_sites\": 5.0e22, \"q\": [0, -1, -2], \"Ef0\": [3.8, 3.6, 3.5], \"g\": [1, 1, 1]},\n                {\"N_sites\": 5.0e22, \"q\": [0, +1, +2], \"Ef0\": [2.0, 1.4, 1.5], \"g\": [1, 1, 1]}\n            ]\n        },\n        # Test case 3 (narrow-gap semiconductor, balanced defects)\n        {\n            \"Eg\": 0.5, \"Nc\": 1.5e19, \"Nv\": 1.5e19, \"T\": 600,\n            \"defects\": [\n                {\"N_sites\": 1.0e22, \"q\": [0, -1, -2], \"Ef0\": [2.2, 2.0, 1.9], \"g\": [1, 1, 1]},\n                {\"N_sites\": 1.0e22, \"q\": [0, +1], \"Ef0\": [2.5, 2.6], \"g\": [1, 1]}\n            ]\n        },\n        # Test case 4 (no defects, intrinsic reference)\n        {\n            \"Eg\": 1.12, \"Nc\": 2.8e19, \"Nv\": 1.04e19, \"T\": 300,\n            \"defects\": [\n                {\"N_sites\": 0, \"q\": [0], \"Ef0\": [10.0], \"g\": [1]},\n                {\"N_sites\": 0, \"q\": [0], \"Ef0\": [10.0], \"g\": [1]}\n            ]\n        },\n        # Test case 5 (heavily donor-like interstitials)\n        {\n            \"Eg\": 1.8, \"Nc\": 2.0e19, \"Nv\": 2.0e19, \"T\": 800,\n            \"defects\": [\n                {\"N_sites\": 1.0e22, \"q\": [0, -1], \"Ef0\": [3.0, 2.8], \"g\": [1, 1]},\n                {\"N_sites\": 1.0e22, \"q\": [0, +1], \"Ef0\": [1.0, 0.6], \"g\": [1, 2]}\n            ]\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters for the current case\n        Eg = case[\"Eg\"]\n        Nc = case[\"Nc\"]\n        Nv = case[\"Nv\"]\n        T = case[\"T\"]\n        defects = case[\"defects\"]\n        \n        # Thermal energy in eV\n        kBT = k_B * T\n\n        def neutrality_function(Ef):\n            \"\"\"\n            Calculates the net charge density rho(Ef, T) for a given Fermi level Ef.\n            The function is defined as rho = p - n + sum(q * c_defect).\n            A root of this function corresponds to charge neutrality.\n            \"\"\"\n            # Calculate electron and hole densities\n            # n(Ef, T) = Nc * exp(-(Ec - Ef) / kBT), with Ev=0, Ec=Eg\n            n = Nc * np.exp(-(Eg - Ef) / kBT)\n            # p(Ef, T) = Nv * exp(-(Ef - Ev) / kBT), with Ev=0\n            p = Nv * np.exp(-Ef / kBT)\n            \n            # Calculate the total charge density from all defects\n            defect_charge_density = 0.0\n            for defect_species in defects:\n                N_sites = defect_species[\"N_sites\"]\n                if N_sites == 0:\n                    continue\n                \n                # Iterate through all charge states of the defect species\n                for i in range(len(defect_species[\"q\"])):\n                    q = defect_species[\"q\"][i]\n                    Ef0 = defect_species[\"Ef0\"][i]\n                    g = defect_species[\"g\"][i]\n                    \n                    # Formation energy at the given Fermi level Ef\n                    E_f_defect = Ef0 + q * Ef\n                    \n                    # Concentration of the defect in this charge state\n                    c_defect = N_sites * g * np.exp(-E_f_defect / kBT)\n                    \n                    # Add its contribution to the total charge density\n                    defect_charge_density += q * c_defect\n            \n            # Return the total net charge density\n            return p - n + defect_charge_density\n\n        # The neutrality function is continuous and strictly monotonically decreasing,\n        # which guarantees a unique root. We search for the root in a physically\n        # reasonable interval around the band gap. An interval of [-1.0, Eg + 1.0]\n        # is robust enough to guarantee bracketing the root.\n        bracket_low = -1.0\n        bracket_high = Eg + 1.0\n        \n        try:\n            # Use Brent's method for robust and fast root finding\n            Ef_solution = brentq(neutrality_function, bracket_low, bracket_high)\n            results.append(f\"{Ef_solution:.6f}\")\n        except ValueError:\n            results.append(\"Error\")\n\n    # Print the final results in the specified format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "answer": "$$\n\\boxed{\\texttt{[0.547196,0.648600,0.245084,0.547196,1.676345]}}\n$$", "id": "2978777"}]}