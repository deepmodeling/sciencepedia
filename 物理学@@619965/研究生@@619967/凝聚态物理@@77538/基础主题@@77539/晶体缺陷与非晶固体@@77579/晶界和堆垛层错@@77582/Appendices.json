{"hands_on_practices": [{"introduction": "此练习从最小尺度的平面缺陷——堆垛层错——入手。通过计算决定肖克利（Shockley）不全位错平衡间距的层错能，您将直接体会到界面能这一抽象概念如何转化为可测量的力学效应 [@problem_id:184953]。这是一个将能量概念与晶体缺陷具体行为联系起来的基础性实践，为理解更复杂的界面现象奠定基础。", "problem": "在面心立方（FCC）晶体中，一个全位错可以通过分解为两个肖克利（Shockley）不全位错来降低其能量。这个过程由不全位错之间的弹性排斥力与它们之间形成的区域的层错能所引起的吸引力之间的平衡所决定。\n\n考虑在面心立方金属中的一个直全位错，其晶格常数为 $a$，剪切模量为 $G$，泊松比为 $\\nu$。它在其滑移面上分解为两个平行的肖克利（Shockley）不全位错。不全位错之间的区域是一个层错，其单位面积的比能为 $\\gamma_{SF}$，这导致不全位错之间产生一个单位长度上的恒定吸引力，其大小等于 $\\gamma_{SF}$。\n\n每个肖克利（Shockley）不全位错的伯格斯矢量大小为 $|\\vec{b}_p| = \\frac{a}{\\sqrt{6}}$。两个相距为 $d$ 的不全位错之间的单位长度排斥力 $F_{rep}$ 由下式给出：\n$$F_{rep} = \\frac{G}{2\\pi d} \\left( b_{s1}b_{s2} + \\frac{b_{e1}b_{e2}}{1-\\nu} \\right)$$\n其中 $b_{si}$ 和 $b_{ei}$（$i=1, 2$）分别是不全位错伯格斯矢量的螺型和刃型标量分量。分量的符号由其在位错线方向和滑移面法线上的投影确定。\n\n原始的全位错具有一般混合型特征，其伯格斯矢量 $\\vec{b}$ 与位错线方向 $\\vec{\\xi}$ 成 $\\phi$ 角。对于面心立方晶体中的分解，一个已知的晶体学结果是，两个肖克利（Shockley）不全位错的伯格斯矢量 $\\vec{b}_1$ 和 $\\vec{b}_2$ 分别与位错线 $\\vec{\\xi}$ 成 $(\\phi - \\pi/6)$ 和 $(\\phi + \\pi/6)$ 角。\n\n对于一个特定的混合型位错，其角度为 $\\phi = \\pi/3$，求两个肖克利（Shockley）不全位错之间的平衡分离距离 $d$。将你的答案表示为以 $G$、$a$、$\\gamma_{SF}$ 和 $\\nu$ 表示的闭合形式解析表达式。", "solution": "为了确定两个肖克利（Shockley）不全位错之间的平衡分离距离 $d$，我们将弹性排斥力 $F_{\\text{rep}}$ 与由层错能引起的单位长度吸引力 $\\gamma_{SF}$ 相等。\n\n**步骤 1：表示排斥力 $F_{\\text{rep}}$**  \n给定的单位长度排斥力公式为：\n$$\nF_{\\text{rep}} = \\frac{G}{2\\pi d} \\left( b_{s1}b_{s2} + \\frac{b_{e1}b_{e2}}{1 - \\nu} \\right),\n$$\n其中 $b_{si}$ 和 $b_{ei}$ 是不全位错伯格斯矢量的螺型和刃型分量。\n\n**步骤 2：确定螺型和刃型分量**  \n每个不全位错的伯格斯矢量大小为 $|\\vec{b}_p| = \\frac{a}{\\sqrt{6}}$。对于 $\\phi = \\frac{\\pi}{3}$，不全位错相对于位错线的角度为：\n- 不全位错 1：$\\theta_1 = \\phi - \\frac{\\pi}{6} = \\frac{\\pi}{6}$，\n- 不全位错 2：$\\theta_2 = \\phi + \\frac{\\pi}{6} = \\frac{\\pi}{2}$。\n\n螺型和刃型分量为：\n$$\nb_{si} = |\\vec{b}_p| \\cos\\theta_i, \\quad b_{ei} = |\\vec{b}_p| \\sin\\theta_i.\n$$\n对于**不全位错 1**（$\\theta_1 = \\frac{\\pi}{6}$）：\n$$\nb_{s1} = \\frac{a}{\\sqrt{6}} \\cos\\frac{\\pi}{6}, \\quad b_{e1} = \\frac{a}{\\sqrt{6}} \\sin\\frac{\\pi}{6}.\n$$\n对于**不全位错 2**（$\\theta_2 = \\frac{\\pi}{2}$）：\n$$\nb_{s2} = \\frac{a}{\\sqrt{6}} \\cos\\frac{\\pi}{2} = 0, \\quad b_{e2} = \\frac{a}{\\sqrt{6}} \\sin\\frac{\\pi}{2} = \\frac{a}{\\sqrt{6}}.\n$$\n\n**步骤 3：计算乘积 $b_{s1}b_{s2}$ 和 $b_{e1}b_{e2}$**  \n- 螺型-螺型分量乘积：\n$$\nb_{s1}b_{s2} = \\left( \\frac{a}{\\sqrt{6}} \\cos\\frac{\\pi}{6} \\right)(0) = 0.\n$$\n- 刃型-刃型分量乘积：\n$$\nb_{e1}b_{e2} = \\left( \\frac{a}{\\sqrt{6}} \\sin\\frac{\\pi}{6} \\right)\\left( \\frac{a}{\\sqrt{6}} \\right) = \\frac{a^2}{6} \\cdot \\frac{1}{2} = \\frac{a^2}{12}.\n$$\n\n**步骤 4：代入 $F_{\\text{rep}}$**  \n$$\nF_{\\text{rep}} = \\frac{G}{2\\pi d} \\left( 0 + \\frac{a^2 / 12}{1 - \\nu} \\right) = \\frac{G a^2}{24 \\pi d (1 - \\nu)}.\n$$\n\n**步骤 5：将 $F_{\\text{rep}}$ 与 $\\gamma_{SF}$ 相等并求解 $d$**  \n在平衡时，$F_{\\text{rep}} = \\gamma_{SF}$：\n$$\n\\frac{G a^2}{24 \\pi d (1 - \\nu)} = \\gamma_{SF}.\n$$\n求解 $d$：\n$$\nd = \\frac{G a^2}{24 \\pi \\gamma_{SF} (1 - \\nu)}.\n$$", "answer": "$$\\boxed{\\dfrac{G a^{2}}{24 \\pi \\gamma_{SF} (1 - \\nu)}}$$", "id": "184953"}, {"introduction": "在理解了层错的基本性质后，我们将视野扩展到两个不同取向晶粒间的完整界面——晶界。此练习将引导您深入重合位置点阵（Coincidence Site Lattice, CSL）理论，这是一个描述特殊低能晶界几何结构的强大框架 [@problem_id:2992781]。通过从第一性原理出发构建CSL基矢，您将深刻理解CSL的定义方式及其特征指数 $\\Sigma$ 的物理意义。", "problem": "在一个简单立方晶体中，晶格矢量沿笛卡尔坐标轴取向，以常规立方晶格常数为单位，晶格表示为 $\\Lambda = \\mathbb{Z}^{3}$。两个晶粒通过一个刚性旋转相关联，该旋转由特殊正交矩阵 $R \\in \\mathrm{SO}(3)$ 描述，旋转轴为晶向 $[001]$，且 $\\cos\\theta = \\frac{3}{5}$，$\\sin\\theta = \\frac{4}{5}$。在标准基下，该旋转矩阵为\n$$\nR = \\begin{pmatrix}\n\\frac{3}{5} & -\\frac{4}{5} & 0 \\\\\n\\frac{4}{5} & \\frac{3}{5} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}.\n$$\n仅使用重合位置点阵 (CSL) 的定义，即 $\\Lambda_{\\mathrm{CSL}} = \\Lambda \\cap R \\Lambda$，以及 $R$ 是一个具有有理数元素的正交矩阵这一事实，完成以下任务：\n\n- 推导一个整数性条件，以面内坐标的同余条件形式，表征所有同时位于 $R \\Lambda$ 中的矢量 $v \\in \\mathbb{Z}^{3}$。\n- 为 $\\Lambda_{\\mathrm{CSL}}$ 构建一个显式的原胞基 $\\{b_{1}, b_{2}, b_{3}\\}$，其中 $b_{3}$ 平行于 $[001]$。\n- 计算重合指数 $\\Sigma = [\\Lambda : \\Lambda_{\\mathrm{CSL}}]$，其值为从 $\\mathbb{Z}^{3}$ 的标准基到您构建的 CSL 基的基变换矩阵的行列式的绝对值。\n\n请以单个整数的形式给出 $\\Sigma$ 的最终值。无需四舍五入。答案是无量纲的，报告结果时不应包含单位。", "solution": "该问题要求推导在一个简单立方晶体中，特定晶界对应的重合指数 $\\Sigma$。推导过程必须首先建立晶格点成为重合点的条件，然后为重合位置点阵（CSL）构建一个原胞基，最后基于此基计算 $\\Sigma$。\n\n晶格由 $\\Lambda = \\mathbb{Z}^{3}$ 给出。关联两个晶粒的旋转矩阵 $R$ 为：\n$$\nR = \\begin{pmatrix}\n\\frac{3}{5} & -\\frac{4}{5} & 0 \\\\\n\\frac{4}{5} & \\frac{3}{5} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\n重合位置点阵 $\\Lambda_{\\mathrm{CSL}}$ 定义为两个晶格 $\\Lambda$ 和旋转后的晶格 $R\\Lambda$ 所共有的晶格点的集合。在数学上，这是两者的交集：\n$$\n\\Lambda_{\\mathrm{CSL}} = \\Lambda \\cap R \\Lambda\n$$\n一个矢量 $v \\in \\mathbb{Z}^{3}$ 属于 $\\Lambda_{\\mathrm{CSL}}$ 当且仅当它满足两个条件：\n1. $v \\in \\Lambda$，这意味着 $v$ 的分量是整数。设 $v = (v_x, v_y, v_z)^T$，其中 $v_x, v_y, v_z \\in \\mathbb{Z}$。\n2. $v \\in R\\Lambda$，这意味着存在一个矢量 $u \\in \\Lambda$ 使得 $v = Ru$。由于 $u$ 必须具有整数分量，该条件等价于：在旋转 $R$ 下 $v$ 的原像必须是整数矢量。即 $u = R^{-1}v \\in \\mathbb{Z}^{3}$。\n\n由于 $R$ 是一个正交矩阵，其逆矩阵 $R^{-1}$ 等于其转置矩阵 $R^{T}$。因此，一个矢量 $v \\in \\mathbb{Z}^{3}$ 位于 $\\Lambda_{\\mathrm{CSL}}$ 中的条件是 $R^{T}v \\in \\mathbb{Z}^{3}$。\n\n首先，我们推导显式的整数性条件。旋转矩阵的转置为：\n$$\nR^{T} = \\begin{pmatrix}\n\\frac{3}{5} & \\frac{4}{5} & 0 \\\\\n-\\frac{4}{5} & \\frac{3}{5} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\n设 $v = (v_x, v_y, v_z)^T$ 是 $\\mathbb{Z}^{3}$ 中的一个矢量。矢量 $R^{T}v$ 是：\n$$\nR^{T}v = \\begin{pmatrix}\n\\frac{3}{5}v_x + \\frac{4}{5}v_y \\\\\n-\\frac{4}{5}v_x + \\frac{3}{5}v_y \\\\\nv_z\n\\end{pmatrix}\n$$\n要使 $R^{T}v$ 成为 $\\mathbb{Z}^{3}$ 中的一个矢量，其所有分量必须是整数。\n第三个分量是 $v_z$，根据 $v$ 的定义，它已经是一个整数。\n前两个分量对面内坐标 $(v_x, v_y)$ 产生以下条件：\n1. $\\frac{3}{5}v_x + \\frac{4}{5}v_y \\in \\mathbb{Z} \\implies 3v_x + 4v_y$ 必须是 $5$ 的倍数。\n2. $-\\frac{4}{5}v_x + \\frac{3}{5}v_y \\in \\mathbb{Z} \\implies -4v_x + 3v_y$ 必须是 $5$ 的倍数。\n\n这些可以表示为模5的同余关系：\n1. $3v_x + 4v_y \\equiv 0 \\pmod{5}$\n2. $-4v_x + 3v_y \\equiv 0 \\pmod{5}$\n\n我们可以检查这些条件是否独立。第一个同余关系 $3v_x \\equiv -4v_y \\pmod{5}$ 可简化为 $3v_x \\equiv v_y \\pmod{5}$。第二个同余关系 $3v_y \\equiv 4v_x \\pmod{5}$ 意味着 $v_y \\equiv \\frac{4}{3}v_x \\pmod{5}$。由于 $3 \\times 2 = 6 \\equiv 1 \\pmod{5}$，所以 $3$ 模 $5$ 的逆是 $2$。因此，$v_y \\equiv 4 \\times 2 v_x \\pmod{5}$，即 $v_y \\equiv 8v_x \\pmod{5}$，或 $v_y \\equiv 3v_x \\pmod{5}$。这两个同余关系是等价的。因此，表征 $\\Lambda_{\\mathrm{CSL}}$ 中所有矢量的整数性条件可以由关于面内坐标的单个同余关系给出：\n$$\n3v_x + 4v_y \\equiv 0 \\pmod{5}\n$$\n\n接下来，我们为 $\\Lambda_{\\mathrm{CSL}}$ 构建一个原胞基 $\\{b_1, b_2, b_3\\}$。基矢量 $b_3$ 必须平行于 $[001]$。最简单的选择是 $b_3 = (0, 0, 1)^T$。我们验证它是一个 CSL 矢量：对于 $v_x=0$ 和 $v_y=0$，条件 $3(0)+4(0)=0 \\equiv 0 \\pmod{5}$ 成立。分量 $v_z=1$ 是一个整数。所以，$b_3$ 是一个有效的 CSL 矢量。\n\n现在我们需要为 $xy$ 平面内的二维 CSL 找到一个原胞基。我们正在寻找两个线性无关的整数矢量 $(v_x, v_y)$，它们满足 $3v_x + 4v_y \\equiv 0 \\pmod{5}$ 并且能生成所有其他此类矢量。让我们找两个简单的解。\n- 如果我们设 $v_x = 1$，同余关系变为 $3 + 4v_y \\equiv 0 \\pmod{5}$，或 $4v_y \\equiv -3 \\equiv 2 \\pmod{5}$。两边乘以 $4$（因为 $4 \\times 4 = 16 \\equiv 1 \\pmod{5}$），我们得到 $v_y \\equiv 8 \\equiv 3 \\pmod{5}$。最简单的整数解是 $(v_x, v_y) = (1, 3)$。我们用它来定义平面内的第一个基矢量：$b_1 = (1, 3, 0)^T$。\n- 为了找到第二个线性无关的矢量，我们尝试 $v_x = 2$。同余关系变为 $3(2) + 4v_y \\equiv 0 \\pmod{5}$，或 $6 + 4v_y \\equiv 0 \\pmod{5}$，这简化为 $1 + 4v_y \\equiv 0 \\pmod{5}$，或 $4v_y \\equiv -1 \\equiv 4 \\pmod{5}$。这给出 $v_y \\equiv 1 \\pmod{5}$。最简单的整数解是 $(v_x, v_y) = (2, 1)$。我们定义第二个基矢量：$b_2 = (2, 1, 0)^T$。\n\n因此，我们为 $\\Lambda_{\\mathrm{CSL}}$ 提出了一个基：\n$$\nb_1 = \\begin{pmatrix} 1 \\\\ 3 \\\\ 0 \\end{pmatrix}, \\quad b_2 = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad b_3 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n为了验证这个基是原胞基，我们必须证明任何矢量 $v \\in \\Lambda_{\\mathrm{CSL}}$ 都可以写成整数线性组合 $v = c_1 b_1 + c_2 b_2 + c_3 b_3$，其中 $c_1, c_2, c_3 \\in \\mathbb{Z}$。\n对于一个一般的 CSL 矢量 $v = (v_x, v_y, v_z)^T$，我们有 $v_z = c_3$。由于 $v_z$ 是整数，所以 $c_3$ 是整数。对于面内分量：\n$$\n\\begin{pmatrix} v_x \\\\ v_y \\end{pmatrix} = c_1 \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix} + c_2 \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 & 2 \\\\ 3 & 1 \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}\n$$\n求解 $c_1$ 和 $c_2$：\n$$\n\\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} = \\begin{pmatrix} 1 & 2 \\\\ 3 & 1 \\end{pmatrix}^{-1} \\begin{pmatrix} v_x \\\\ v_y \\end{pmatrix} = \\frac{1}{1 - 6} \\begin{pmatrix} 1 & -2 \\\\ -3 & 1 \\end{pmatrix} \\begin{pmatrix} v_x \\\\ v_y \\end{pmatrix} = -\\frac{1}{5} \\begin{pmatrix} v_x - 2v_y \\\\ -3v_x + v_y \\end{pmatrix}\n$$\n要使该基为原胞基，$c_1$ 和 $c_2$ 对于任何 CSL 矢量 $(v_x, v_y, 0)^T$ 都必须是整数。这要求 $v_x - 2v_y$ 和 $-3v_x + v_y$ 都能被 $5$ 整除。根据 CSL 条件, $v_y \\equiv 3v_x \\pmod{5}$。将此代入表达式中：\n- $v_x - 2v_y \\equiv v_x - 2(3v_x) = v_x - 6v_x = -5v_x \\equiv 0 \\pmod{5}$。\n- $-3v_x + v_y \\equiv -3v_x + (3v_x) = 0 \\pmod{5}$。\n两个表达式都能被 $5$ 整除，所以 $c_1$ 和 $c_2$ 确实是整数。因此，基 $\\{b_1, b_2, b_3\\}$ 是 $\\Lambda_{\\mathrm{CSL}}$ 的一个原胞基。\n\n最后，我们计算重合指数 $\\Sigma$。它被定义为子群 $\\Lambda_{\\mathrm{CSL}}$ 在 $\\Lambda$ 中的指数，该指数由原胞的体积之比给出，$\\Sigma = \\mathrm{Vol}(\\Lambda) / \\mathrm{Vol}(\\Lambda_{\\mathrm{CSL}})$。这等于从 $\\Lambda$ 的基到 $\\Lambda_{\\mathrm{CSL}}$ 的基的基变换矩阵的行列式的绝对值。\n对于 $\\Lambda = \\mathbb{Z}^{3}$，标准基是 $\\{e_1, e_2, e_3\\}$。基变换矩阵 $B$ 以 CSL 基矢量 $\\{b_1, b_2, b_3\\}$ 作为其列：\n$$\nB = \\begin{pmatrix} 1 & 2 & 0 \\\\ 3 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n重合指数 $\\Sigma$ 于是计算如下：\n$$\n\\Sigma = |\\det(B)| = \\left| \\det \\begin{pmatrix} 1 & 2 & 0 \\\\ 3 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\right|\n$$\n该行列式可以通过沿第三列的代数余子式展开求得：\n$$\n\\det(B) = 1 \\cdot \\det \\begin{pmatrix} 1 & 2 \\\\ 3 & 1 \\end{pmatrix} = 1 \\cdot (1 \\cdot 1 - 2 \\cdot 3) = 1 - 6 = -5\n$$\n因此，重合指数是：\n$$\n\\Sigma = |-5| = 5\n$$", "answer": "$$\n\\boxed{5}\n$$", "id": "2992781"}, {"introduction": "本练习旨在架起理论模型与现代计算研究之间的桥梁，展示如何量化界面的能量。您将学习如何利用密度泛函理论（Density Functional Theory, DFT）这一计算材料科学的主力工具，通过其输出的总能量数据来计算晶界能 [@problem_id:2992839]。这个实践不仅巩固了界面过剩能的物理概念，也揭示了第一性原理计算在材料设计与表征中的核心作用。", "problem": "您的任务是实现一个基于物理学的计算程序。该程序根据双晶超胞的密度泛函理论（DFT）计算得到的总能量，返回单位面积的晶界过剩能。目标是在周期性边界条件下，计算由亥姆霍兹自由能过剩量推导出的界面能密度。\n\n起点与基本原理：在低温平衡状态下，根据密度泛函理论（DFT）的精度，一个系统的亥姆霍兹自由能 $F$ 等于其内能。对于一个在周期性边界条件（PBC）下包含平面缺陷的超胞，与界面相关的自由能过剩量是超胞能量与等量原子在完美体相晶体中的能量之差。单位面积的界面能，记作 $\\gamma$，从第一性原理上定义为单位面积的自由能过剩量。假设每个超胞包含 $n$ 个总面积为 $A$ 的相同界面，界面能密度可通过减去体相贡献并按总界面面积归一化得到：\n$$\n\\gamma = \\frac{F_{\\text{supercell}} - N f_{\\text{bulk}}}{n A}\n$$\n在零温下，并且在DFT的常用近似中，我们使用 $F_{\\text{supercell}} \\approx E_{\\text{supercell}}$ 和 $f_{\\text{bulk}} \\approx E_{\\text{bulk, per atom}}$，从而得到\n$$\n\\gamma = \\frac{E_{\\text{supercell}} - N E_{\\text{bulk, per atom}}}{n A}\n$$\n对于PBC下的双晶超胞，通常 $n=2$，因为在沿法线方向的重复单元内存在两个等效的晶界。对于具有单个晶界和真空层的板坯模型，如果只存在一个晶界，则可以使用 $n=1$。\n\n您的程序必须根据上述定义实现 $\\gamma$ 的物理一致性计算，执行从电子伏特每平方埃到焦耳每平方米的单位转换，并为提供的测试集生成结果。使用精确常数 $1\\ \\mathrm{eV} = 1.602176634\\times 10^{-19}\\ \\mathrm{J}$ 和 $1\\ \\text{\\AA}^2 = 10^{-20}\\ \\mathrm{m}^2$。因此，从 $\\mathrm{eV}/\\text{\\AA}^2$ 到 $\\mathrm{J}/\\mathrm{m}^2$ 的转换因子是\n$$\n\\Lambda = \\frac{1.602176634\\times 10^{-19}}{10^{-20}} = 16.02176634\n$$\n您的算法必须：\n- 接受一组测试用例，每个用例由 $(E_{\\text{supercell}}, N, E_{\\text{bulk, per atom}}, A, n)$ 指定，其中 $E_{\\text{supercell}}$ 的单位是 $\\mathrm{eV}$，$N$ 是原子计数的整数，$E_{\\text{bulk, per atom}}$ 的单位是 $\\mathrm{eV}$ 每原子，$A$ 的单位是 $\\text{\\AA}^2$，$n$ 是界面计数的整数。\n- 计算过剩能 $\\Delta E = E_{\\text{supercell}} - N E_{\\text{bulk, per atom}}$，单位为 $\\mathrm{eV}$。\n- 计算 $\\gamma$，单位为 $\\mathrm{eV}/\\text{\\AA}^2$，公式为 $\\gamma_{\\text{eV/\\AA}^2} = \\Delta E / (n A)$。\n- 使用 $\\gamma_{\\mathrm{J/m}^2} = \\Lambda \\times \\gamma_{\\text{eV/\\AA}^2}$ 将其转换为 $\\mathrm{J}/\\mathrm{m}^2$。\n- 返回每个 $\\gamma_{\\mathrm{J/m}^2}$，四舍五入到 $6$ 位小数。\n\n科学真实性约束：确保 $A>0$ 和 $n\\ge 1$。对于物理上弛豫的结构，界面能密度应为非负值。\n\n角度单位规范：不适用于此任务。\n\n百分比：不适用于此任务。\n\n测试集：\n- 案例 $1$（具有两个等效晶界的双晶）：$E_{\\text{supercell}} = -1061.5\\ \\mathrm{eV}$，$N=500$，$E_{\\text{bulk, per atom}} = -2.503\\ \\mathrm{eV}$，$A = 2500\\ \\text{\\AA}^2$，$n=2$。这是一个在PBC下的典型对称倾转双晶。\n- 案例 $2$（板坯中的单个晶界）：$E_{\\text{supercell}} = -732.52\\ \\mathrm{eV}$，$N=200$，$E_{\\text{bulk, per atom}} = -3.725\\ \\mathrm{eV}$，$A = 1000\\ \\text{\\AA}^2$，$n=1$。\n- 案例 $3$（无缺陷参考一致性检查）：$E_{\\text{supercell}} = -1500.0\\ \\mathrm{eV}$，$N=300$，$E_{\\text{bulk, per atom}} = -5.0\\ \\mathrm{eV}$，$A = 1500\\ \\text{\\AA}^2$，$n=2$。\n- 案例 $4$（PBC下具有两个缺陷的堆垛层错）：$E_{\\text{supercell}} = -965.313\\ \\mathrm{eV}$，$N=256$，$E_{\\text{bulk, per atom}} = -3.80\\ \\mathrm{eV}$，$A = 800\\ \\text{\\AA}^2$，$n=2$。\n\n输出和单位要求：\n- 以 $\\mathrm{J}/\\mathrm{m}^2$ 为单位表示每个界面能，并四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $[x_1,x_2,x_3,x_4]$，顺序与测试集完全一致。", "solution": "该问题陈述被评估为有效。它在科学上基于凝聚态物理和计算材料科学的原理，特别是关于从第一性原理总能计算中计算界面能。该问题定义明确、客观，并包含所有必要的信息和数据，以得出一个唯一的、可验证的解决方案。所提供的测试用例在物理上是现实的，并包含一个有价值的一致性检查。\n\n目标是为一系列由其密度泛函理论（DFT）计算的总能量定义的材料体系，计算界面能密度 $\\gamma$。单位面积界面能 $\\gamma$ 的基本定义是界面单位面积的亥姆霍兹自由能过剩量。在零温下，这是DFT基态计算的标准近似，亥姆霍兹自由能 $F$ 等同于总内能 $E$。\n\n对于一个包含 $N$ 个原子和 $n$ 个面积为 $A$ 的界面的超胞，其控制方程由下式给出：\n$$\n\\gamma = \\frac{E_{\\text{supercell}} - N E_{\\text{bulk, per atom}}}{n A}\n$$\n在此，$E_{\\text{supercell}}$ 是包含界面的超胞的总能量，$E_{\\text{bulk, per atom}}$ 是相应完美体相晶体中每个原子的能量。项 $N E_{\\text{bulk, per atom}}$ 代表一个参考系统的总能量，该系统包含相同数量的原子，但处于无缺陷的体相构型中。因此，分子 $\\Delta E = E_{\\text{supercell}} - N E_{\\text{bulk, per atom}}$ 是由于界面产生而引入的过剩能。然后将该过剩能按总界面面积 $n A$ 进行归一化，以得到单位面积的能量。\n\n输入的能量以电子伏特（$\\mathrm{eV}$）为单位，面积以平方埃（$\\text{\\AA}^2$）为单位，从而得到以 $\\mathrm{eV}/\\text{\\AA}^2$ 为单位的 $\\gamma$。最终结果必须转换为国际标准单位焦耳每平方米（$\\mathrm{J}/\\mathrm{m}^2$）。转换因子 $\\Lambda$ 是从电子伏特和埃的基本常数推导出来的：\n$$\n\\Lambda = \\frac{1\\ \\mathrm{eV}}{1\\ \\text{\\AA}^2} = \\frac{1.602176634 \\times 10^{-19}\\ \\mathrm{J}}{(10^{-10}\\ \\mathrm{m})^2} = \\frac{1.602176634 \\times 10^{-19}\\ \\mathrm{J}}{10^{-20}\\ \\mathrm{m}^2} = 16.02176634\\ \\frac{\\mathrm{J}/\\mathrm{m}^2}{\\mathrm{eV}/\\text{\\AA}^2}\n$$\n每个测试用例的计算步骤如下：\n1. 计算以 $\\mathrm{eV}$ 为单位的过剩能 $\\Delta E$。\n2. 计算以 $\\mathrm{eV}/\\text{\\AA}^2$ 为单位的界面能 $\\gamma_{\\text{eV/\\AA}^2}$。\n3. 通过乘以 $\\Lambda$ 将此值转换为以 $\\mathrm{J}/\\mathrm{m}^2$ 为单位的 $\\gamma_{\\mathrm{J/m}^2}$。\n4. 将最终结果四舍五入到 $6$ 位小数。\n\n我们现在将此过程应用于提供的测试集。\n\n案例 $1$：一个具有 $n=2$ 个界面的双晶。\n给定：$E_{\\text{supercell}} = -1061.5\\ \\mathrm{eV}$，$N=500$，$E_{\\text{bulk, per atom}} = -2.503\\ \\mathrm{eV}$，$A = 2500\\ \\text{\\AA}^2$，$n=2$。\n1. 过剩能：$\\Delta E = -1061.5 - 500 \\times (-2.503) = -1061.5 + 1251.5 = 190.0\\ \\mathrm{eV}$。\n2. 界面能：$\\gamma_{\\text{eV/\\AA}^2} = \\frac{190.0}{2 \\times 2500} = \\frac{190.0}{5000} = 0.038\\ \\mathrm{eV}/\\text{\\AA}^2$。\n3. 单位转换：$\\gamma_{\\mathrm{J/m}^2} = 0.038 \\times 16.02176634 \\approx 0.60882712\\ \\mathrm{J}/\\mathrm{m}^2$。\n4. 四舍五入：结果是 $0.608827\\ \\mathrm{J}/\\mathrm{m}^2$。\n\n案例 $2$：一个具有 $n=1$ 个界面的板坯。\n给定：$E_{\\text{supercell}} = -732.52\\ \\mathrm{eV}$，$N=200$，$E_{\\text{bulk, per atom}} = -3.725\\ \\mathrm{eV}$，$A = 1000\\ \\text{\\AA}^2$，$n=1$。\n1. 过剩能：$\\Delta E = -732.52 - 200 \\times (-3.725) = -732.52 + 745.0 = 12.48\\ \\mathrm{eV}$。\n2. 界面能：$\\gamma_{\\text{eV/\\AA}^2} = \\frac{12.48}{1 \\times 1000} = 0.01248\\ \\mathrm{eV}/\\text{\\AA}^2$。\n3. 单位转换：$\\gamma_{\\mathrm{J/m}^2} = 0.01248 \\times 16.02176634 \\approx 0.19995164\\ \\mathrm{J}/\\mathrm{m}^2$。\n4. 四舍五入：结果是 $0.199952\\ \\mathrm{J}/\\mathrm{m}^2$。\n\n案例 $3$：一个无缺陷参考检查。\n给定：$E_{\\text{supercell}} = -1500.0\\ \\mathrm{eV}$，$N=300$，$E_{\\text{bulk, per atom}} = -5.0\\ \\mathrm{eV}$，$A = 1500\\ \\text{\\AA}^2$，$n=2$。\n1. 过剩能：$\\Delta E = -1500.0 - 300 \\times (-5.0) = -1500.0 + 1500.0 = 0.0\\ \\mathrm{eV}$。\n这个结果在物理上是符合预期的，因为超胞的能量恰好是相应体相材料的能量，这表明没有缺陷存在。\n2. 界面能：$\\gamma_{\\text{eV/\\AA}^2} = \\frac{0.0}{2 \\times 1500} = 0.0\\ \\mathrm{eV}/\\text{\\AA}^2$。\n3. 单位转换：$\\gamma_{\\mathrm{J/m}^2} = 0.0 \\times 16.02176634 = 0.0\\ \\mathrm{J}/\\mathrm{m}^2$。\n4. 四舍五入：结果是 $0.000000\\ \\mathrm{J}/\\mathrm{m}^2$。\n\n案例 $4$：一个每个超胞有两个缺陷的堆垛层错。\n给定：$E_{\\text{supercell}} = -965.313\\ \\mathrm{eV}$，$N=256$，$E_{\\text{bulk, per atom}} = -3.80\\ \\mathrm{eV}$，$A = 800\\ \\text{\\AA}^2$，$n=2$。\n1. 过剩能：$\\Delta E = -965.313 - 256 \\times (-3.80) = -965.313 + 972.8 = 7.487\\ \\mathrm{eV}$。\n2. 界面能：$\\gamma_{\\text{eV/\\AA}^2} = \\frac{7.487}{2 \\times 800} = \\frac{7.487}{1600} = 0.004679375\\ \\mathrm{eV}/\\text{\\AA}^2$。\n3. 单位转换：$\\gamma_{\\mathrm{J/m}^2} = 0.004679375 \\times 16.02176634 \\approx 0.07497128\\ \\mathrm{J}/\\mathrm{m}^2$。\n4. 四舍五入：结果是 $0.074971\\ \\mathrm{J}/\\mathrm{m}^2$。\n\n实现将把此逻辑编码，以处理测试集并生成所需的输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the grain boundary excess energy per unit area from DFT total energies.\n    \"\"\"\n    # Define the exact physical constants as specified.\n    # Conversion factor from eV/Å^2 to J/m^2.\n    # Lambda = (1.602176634e-19 J/eV) / (1e-20 m^2/Å^2)\n    LAMBDA = 16.02176634\n\n    # Define the test cases from the problem statement.\n    # Format: (E_supercell (eV), N_atoms, E_bulk_per_atom (eV), Area (Å^2), n_interfaces)\n    test_cases = [\n        (-1061.5, 500, -2.503, 2500, 2), # Case 1: bicrystal\n        (-732.52, 200, -3.725, 1000, 1), # Case 2: single slab\n        (-1500.0, 300, -5.0, 1500, 2),   # Case 3: no defect reference\n        (-965.313, 256, -3.80, 800, 2)    # Case 4: stacking fault\n    ]\n\n    results = []\n    for case in test_cases:\n        e_supercell, n_atoms, e_bulk_per_atom, area, n_interfaces = case\n\n        # Step 1: Compute the excess energy in eV.\n        # This is the difference between the supercell energy and the energy\n        # of an equivalent number of atoms in a perfect bulk crystal.\n        delta_e = e_supercell - (n_atoms * e_bulk_per_atom)\n\n        # Step 2: Compute gamma in eV/Å^2.\n        # This is the excess energy normalized by the total interface area.\n        # Check for division by zero, although problem constraints ensure A>0, n>=1.\n        if n_interfaces * area == 0:\n            gamma_ev_per_a2 = 0.0 # Or handle as an error\n        else:\n            gamma_ev_per_a2 = delta_e / (n_interfaces * area)\n\n        # Step 3: Convert gamma to J/m^2 using the conversion factor LAMBDA.\n        gamma_j_per_m2 = gamma_ev_per_a2 * LAMBDA\n\n        results.append(gamma_j_per_m2)\n\n    # Final print statement in the exact required format.\n    # The output is a single line: a comma-separated list of results\n    # enclosed in square brackets, with each result rounded to 6 decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2992839"}]}