{"hands_on_practices": [{"introduction": "理论学习的最终目的是要与实验世界相联系。本练习将理论与实践相结合，模拟了材料科学家在实验室中分析扩散数据以确定关键材料参数的真实过程。通过分析来自二次离子质谱（SIMS）的假设示踪剂深度剖面数据，您将从菲克定律和连续性方程等基本原理出发，推导出扩散系数与实验可测量之间的关系 [@problem_id:2982033]。此练习不仅能巩固您对扩散数学形式的理解，还能让您掌握如何从实验数据中提取如扩散激活能 $E_a$ 这样的核心物理量。", "problem": "使用二次离子质谱（SIMS）通过示踪扩散法研究一种晶体固体。在时刻 $t=0$ 时，将一层等效于单原子层的宿主放射性同位素以超薄平面的形式沉积在抛光表面上，从而在 $x=0$ 处形成一个有效的瞬时空间局域平面源。晶体在高真空下进行等温退火，使扩散沿 $x$ 方向呈一维进行，且无外场、无净漂移、无偏析或陷俘。示踪剂浓度足够稀，不会扰动主晶格，并且在测量范围内，扩散系数可视为与浓度无关。\n\n对名义上相同的样品进行了两次独立的退火处理：\n\n- 在温度 $T_{1} = 1100$ K 下退火 $t_{1} = 12$ h，其SIMS深度剖面能很好地用一个方差为 $\\sigma_{1}^{2}$ 的高斯函数拟合，其中 $\\sigma_{1} = 700$ nm。\n\n- 在温度 $T_{2} = 1000$ K 下退火 $t_{2} = 24$ h，其SIMS深度剖面能很好地用一个方差为 $\\sigma_{2}^{2}$ 的高斯函数拟合，其中 $\\sigma_{2} = 300$ nm。\n\n假设晶体在 $x>0$ 区域是半无限的，并且总积分示踪剂含量在两次实验中是守恒且相同的。\n\n仅从一维连续性方程和Fick第一定律出发，推导在半无限介质中，瞬时平面源的高斯方差与扩散系数之间的关系。然后，利用该关系和扩散系数的Arrhenius形式，\n$$\nD(T) = D_{0}\\,\\exp\\!\\left(-\\frac{E_{a}}{k_{B} T}\\right),\n$$\n确定扩散的激活能 $E_{a}$。将 $E_{a}$ 以电子伏特表示，并将最终答案四舍五入到四位有效数字。使用以电子伏特每开尔文为单位的玻尔兹曼常数，$k_{B} = 8.617333262 \\times 10^{-5}$ eV/K。", "solution": "首先验证该问题，以确保其科学基础扎实、提法恰当且信息完整。\n\n### 步骤1：提取已知条件\n- **系统：** 半无限晶体固体（$x>0$）中的一维示踪扩散。\n- **源：** 位于 $x=0$、时间 $t=0$ 的瞬时平面源。\n- **条件：** 等温退火，无外场、漂移、偏析或陷俘。扩散系数 $D$ 与浓度无关。\n- **实验1：**\n  - 温度：$T_{1} = 1100$ K\n  - 时间：$t_{1} = 12$ h\n  - 剖面：高斯分布，标准差 $\\sigma_{1} = 700$ nm。\n- **实验2：**\n  - 温度：$T_{2} = 1000$ K\n  - 时间：$t_{2} = 24$ h\n  - 剖面：高斯分布，标准差 $\\sigma_{2} = 300$ nm。\n- **模型：** $D(T) = D_{0}\\,\\exp\\!\\left(-\\frac{E_{a}}{k_{B} T}\\right)$\n- **常数：** $k_{B} = 8.617333262 \\times 10^{-5}$ eV/K。\n- **任务：**\n  1. 从第一性原理出发，推导高斯方差 $\\sigma^2$ 和扩散系数 $D$ 之间的关系。\n  2. 确定激活能 $E_{a}$（以电子伏特为单位），并四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学基础：** 该问题基于Fick扩散定律和热激活过程的Arrhenius模型，这些是凝聚态物理和材料科学的基本原理。所描述的实验装置是测量扩散系数的标准方法。该问题在科学上是合理的。\n- **适定性：** 该问题提供了两组独立的实验数据集，从而可以确定Arrhenius模型中的两个未知参数（$D_0$ 和 $E_a$）。要求是求出其中之一 $E_a$，这是一个明确定义的任务。\n- **客观性与完整性：** 该问题以精确、客观的语言陈述，并提供了得出解决方案所需的所有数值数据和物理常数。\n\n### 步骤3：结论与行动\n此问题有效。将提供解答。\n\n### 解题推导\n\n推导过程首先从建立示踪剂剖面的方差 $\\sigma^2$、扩散系数 $D$ 和退火时间 $t$ 之间的关系开始。\n\n示踪剂浓度 $C(x, t)$ 的一维连续性方程为：\n$$\n\\frac{\\partial C}{\\partial t} = -\\frac{\\partial J}{\\partial x}\n$$\n其中 $J$ 是扩散通量。Fick第一定律指出，通量与浓度梯度成正比：\n$$\nJ = -D \\frac{\\partial C}{\\partial x}\n$$\n由于扩散系数 $D$ 被给定为与浓度无关，将Fick第一定律代入连续性方程，得到Fick第二定律，也称为扩散方程：\n$$\n\\frac{\\partial C}{\\partial t} = \\frac{\\partial}{\\partial x} \\left( D \\frac{\\partial C}{\\partial x} \\right) = D \\frac{\\partial^2 C}{\\partial x^2}\n$$\n该问题描述了一个在时间 $t=0$ 时沉积在表面 $x=0$ 处的瞬时局域平面源。对于半无限介质 ($x \\ge 0$)，初始条件为 $C(x, 0) = M \\delta(x)$，其中 $M$ 是每单位面积沉积的示踪剂总量，$\\delta(x)$ 是Dirac delta函数。$x=0$ 处的边界条件是反射壁（或者说，所有通量都朝向介质内部），因为没有物质从表面损失。\n\n在此条件下，扩散方程的解为：\n$$\nC(x, t) = \\frac{M}{\\sqrt{\\pi D t}} \\exp\\left(-\\frac{x^2}{4Dt}\\right)\n$$\n问题陈述，测得的浓度剖面能很好地被一个方差为 $\\sigma^2$ 的高斯函数拟合。一个以 $x=0$ 为中心的一般高斯概率密度函数（与浓度成正比）的形式如下：\n$$\nf(x) \\propto \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right)\n$$\n通过比较解 $C(x, t)$ 中的指数项与高斯函数的一般形式，我们可以令其指数参数相等：\n$$\n-\\frac{x^2}{4Dt} = -\\frac{x^2}{2\\sigma^2}\n$$\n这直接得出了方差 $\\sigma^2$、扩散系数 $D$ 和时间 $t$ 之间的关系：\n$$\n\\sigma^2 = 2Dt\n$$\n至此，完成了任务的第一部分。现在，我们使用这个关系来确定激活能 $E_a$。\n\n我们有两个实验，可以为之写出：\n1. 在温度 $T_1$下：$\\sigma_1^2 = 2D(T_1)t_1$\n2. 在温度 $T_2$下：$\\sigma_2^2 = 2D(T_2)t_2$\n\n由此，我们可以表示出扩散系数：\n$$\nD(T_1) = \\frac{\\sigma_1^2}{2t_1}\n$$\n$$\nD(T_2) = \\frac{\\sigma_2^2}{2t_2}\n$$\n扩散系数遵循Arrhenius方程：$D(T) = D_0 \\exp\\left(-\\frac{E_a}{k_B T}\\right)$。将两个实验的扩散系数相除，可以消去指前因子 $D_0$：\n$$\n\\frac{D(T_1)}{D(T_2)} = \\frac{D_0 \\exp\\left(-\\frac{E_a}{k_B T_1}\\right)}{D_0 \\exp\\left(-\\frac{E_a}{k_B T_2}\\right)} = \\exp\\left(-\\frac{E_a}{k_B T_1} + \\frac{E_a}{k_B T_2}\\right) = \\exp\\left[\\frac{E_a}{k_B}\\left(\\frac{1}{T_2} - \\frac{1}{T_1}\\right)\\right]\n$$\n将此式与从实验数据导出的比率相等：\n$$\n\\frac{\\sigma_1^2 / (2t_1)}{\\sigma_2^2 / (2t_2)} = \\frac{\\sigma_1^2 t_2}{\\sigma_2^2 t_1} = \\exp\\left[\\frac{E_a}{k_B}\\left(\\frac{1}{T_2} - \\frac{1}{T_1}\\right)\\right]\n$$\n为了求解 $E_a$，我们对两边取自然对数：\n$$\n\\ln\\left(\\frac{\\sigma_1^2 t_2}{\\sigma_2^2 t_1}\\right) = \\frac{E_a}{k_B}\\left(\\frac{1}{T_2} - \\frac{1}{T_1}\\right)\n$$\n分离出 $E_a$：\n$$\nE_a = k_B \\frac{\\ln\\left(\\frac{\\sigma_1^2 t_2}{\\sigma_2^2 t_1}\\right)}{\\frac{1}{T_2} - \\frac{1}{T_1}} = k_B \\frac{\\ln\\left[\\left(\\frac{\\sigma_1}{\\sigma_2}\\right)^2 \\frac{t_2}{t_1}\\right]}{\\frac{T_1 - T_2}{T_1 T_2}}\n$$\n现在，我们代入给定的数值：\n- $T_1 = 1100$ K\n- $t_1 = 12$ h\n- $\\sigma_1 = 700$ nm\n- $T_2 = 1000$ K\n- $t_2 = 24$ h\n- $\\sigma_2 = 300$ nm\n- $k_B = 8.617333262 \\times 10^{-5}$ eV/K\n\n这些比率是无量纲的：\n$$\n\\frac{t_2}{t_1} = \\frac{24 \\text{ h}}{12 \\text{ h}} = 2\n$$\n$$\n\\frac{\\sigma_1}{\\sigma_2} = \\frac{700 \\text{ nm}}{300 \\text{ nm}} = \\frac{7}{3}\n$$\n对数的参数为：\n$$\n\\left(\\frac{\\sigma_1}{\\sigma_2}\\right)^2 \\frac{t_2}{t_1} = \\left(\\frac{7}{3}\\right)^2 \\times 2 = \\frac{49}{9} \\times 2 = \\frac{98}{9}\n$$\n分母中的温度项是：\n$$\n\\frac{1}{T_2} - \\frac{1}{T_1} = \\frac{1}{1000 \\text{ K}} - \\frac{1}{1100 \\text{ K}} = \\frac{1100 - 1000}{1000 \\times 1100} \\text{ K}^{-1} = \\frac{100}{1100000} \\text{ K}^{-1} = \\frac{1}{11000} \\text{ K}^{-1}\n$$\n将这些值代入 $E_a$ 的表达式中：\n$$\nE_a = (8.617333262 \\times 10^{-5} \\text{ eV/K}) \\frac{\\ln\\left(\\frac{98}{9}\\right)}{\\frac{1}{11000} \\text{ K}^{-1}}\n$$\n$$\nE_a = (8.617333262 \\times 10^{-5}) \\times 11000 \\times \\ln\\left(\\frac{98}{9}\\right) \\text{ eV}\n$$\n$$\nE_a \\approx 0.94790666 \\times \\ln(10.888...) \\text{ eV}\n$$\n$$\nE_a \\approx 0.94790666 \\times 2.3877085 \\text{ eV}\n$$\n$$\nE_a \\approx 2.2632594 \\text{ eV}\n$$\n四舍五入到四位有效数字，激活能为 $2.263$ eV。", "answer": "$$\n\\boxed{2.263}\n$$", "id": "2982033"}, {"introduction": "在从宏观实验中确定了激活能之后，一个自然而然的问题是：这个能量在原子尺度上代表了什么？本练习深入探讨了空位介导的溶质扩散机制，揭示了宏观激活能实际上是由更基本的能量项构成的，例如空位形成能 $E_f$、迁移势垒 $E_m^{sv}$ 以及溶质-空位结合能 $E_b$。通过从第一性原理推导溶质的有效扩散系数，您将理解杂质原子与晶格缺陷之间的相互作用如何显著影响其迁移行为 [@problem_id:2982094]，这是理解和设计现代合金性能的关键一步。", "problem": "一种面心立方（FCC）金属中的稀置换溶质通过空位机理进行扩散。考虑一个被 $z$ 个最近邻位置所包围的单个溶质原子，对于FCC晶格，$z=12$。假设以下符合物理实际的条件和参数：\n\n- 晶格常数 $a = 0.36\\,\\mathrm{nm}$，温度 $T = 900\\,\\mathrm{K}$。\n- 在稀浓度极限下，空位的平衡分数浓度由空位形成能 $E_f = 1.60\\,\\mathrm{eV}$ 决定，且形成过程中的熵贡献被忽略。\n- 溶质与一个最近邻空位结合，结合能为 $E_b = 0.25\\,\\mathrm{eV}$。\n- 当一个空位位于溶质的最近邻位置上时，溶质-空位交换的尝试频率为 $\\nu_{sv} = 5.0\\times 10^{12}\\,\\mathrm{s}^{-1}$，激活势垒为 $E_m^{sv} = 1.10\\,\\mathrm{eV}$。\n- 体内空位运动的尝试频率为 $\\nu_v = 1.0\\times 10^{13}\\,\\mathrm{s}^{-1}$，激活势垒为 $E_m^{v} = 0.90\\,\\mathrm{eV}$。\n- 假设处于稀浓度极限 $c_v \\ll 1$ 且最近邻位置是统计独立的。在此极限下，一个溶质拥有多个相邻空位的概率可以忽略不计。\n- 假设在连续的溶质-空位交换之间，空位进行了足够快的体内重新取向，以至于在溶质运动的时间尺度上，连续的溶质位移实际上是不相关的。\n\n从空位-溶质结合的细致平衡原理和作为均方位移增长的长时间极限的扩散随机行走定义出发，推导溶质的有效示踪扩散系数 $D_s$ 的表达式，该表达式应使用 $a$, $z$, $T$, $E_f$, $E_b$, $E_m^{sv}$, $\\nu_{sv}$ 以及玻尔兹曼常数 $k_B$ 来表示。然后使用 $k_B = 8.617333262\\times 10^{-5}\\,\\mathrm{eV/K}$ 对 $D_s$ 进行数值计算。\n\n将最终的扩散系数以 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$ 为单位表示，并将答案四舍五入到三位有效数字。", "solution": "该问题要求在针对空位介导扩散的一组特定假设下，推导并计算面心立方（FCC）晶体中置换溶质的示踪扩散系数 $D_s$。分析必须从第一性原理开始。\n\n在立方晶体中，扩散系数可以由随机行走粒子的均方位移（MSD）的长时间行为来定义。对于三维晶格，此关系式由下式给出：\n$$\nD_s = \\lim_{t\\to\\infty} \\frac{\\langle |\\mathbf{r}(t) - \\mathbf{r}(0)|^2 \\rangle}{6t}\n$$\n对于一个由长度为 $\\lambda$、总频率为 $\\Gamma_s$ 的离散跳跃组成的随机行走，经过长时间 $t$ 后的MSD为 $\\langle |\\mathbf{r}(t) - \\mathbf{r}(0)|^2 \\rangle = (\\Gamma_s t) \\lambda^2$。然而，这个表达式假设每次跳跃的方向都与前一次独立。在空位介导的溶质扩散中，溶质跳入相邻空位后，会将空位留在溶质的原始位置，这造成了很高的反向跳跃概率。这会在连续的跳跃矢量之间引入相关性。这些相关性的影响由相关因子 $f_s$（小于1）来表征。因此，扩散系数的一般表达式为：\n$$\nD_s = \\frac{1}{6} f_s \\Gamma_s \\lambda^2\n$$\n问题陈述中做出了一个关键的简化假设：“连续的溶质位移实际上是不相关的”。这指示我们将相关因子设为 $f_s = 1$。因此，在更复杂的模型（例如，五频模型）中计算 $f_s$ 所需的体内空位运动参数（$\\nu_v$ 和 $E_m^v$），对于这个具体问题是不需要的。\n\n表达式 $D_s$ 中的其余各项必须被确定。\n首先，对于FCC晶格中的一个置换原子，其跳跃距离 $\\lambda$ 对应于最近邻位置之间的距离。给定晶格常数 $a$，最近邻距离为 $\\lambda = a/\\sqrt{2}$。因此，跳跃距离的平方为：\n$$\n\\lambda^2 = \\frac{a^2}{2}\n$$\n接下来，我们推导溶质原子的总跳跃频率 $\\Gamma_s$。一个溶质原子只有在其 $z$ 个最近邻位置之一上存在空位时才能跳跃。总跳跃频率是跳入这 $z$ 个位置中每个位置的跳跃速率之和。设 $\\omega_{sv}$ 为溶质与位于相邻位置上的空位之间的交换频率。设 $c_v^{NN}$ 为溶质的任意一个最近邻位置被空位占据的概率。假设稀浓度极限允许我们独立处理 $z$ 个相邻位置中的每一个，并忽略存在多个相邻空位的情况。那么，总跳跃速率是相邻位置数、空位出现在这样一个位置上的概率以及交换频率的乘积：\n$$\n\\Gamma_s = z \\, c_v^{NN} \\, \\omega_{sv}\n$$\n对于FCC晶格，配位数为 $z=12$。\n\n交换频率 $\\omega_{sv}$ 是一个热激活过程，遵循阿伦尼乌斯型关系。它是一个尝试频率 $\\nu_{sv}$ 与一个包含迁移能垒 $E_m^{sv}$ 的玻尔兹曼因子的乘积：\n$$\n\\omega_{sv} = \\nu_{sv} \\exp\\left(-\\frac{E_m^{sv}}{k_B T}\\right)\n$$\n在溶质的最近邻位置找到一个空位的概率 $c_v^{NN}$ 与体内的平衡空位浓度 $c_v^{bulk}$ 相关。按指示忽略熵效应，体内空位浓度由空位形成能 $E_f$ 决定：\n$$\nc_v^{bulk} = \\exp\\left(-\\frac{E_f}{k_B T}\\right)\n$$\n问题陈述指出，溶质与最近邻空位之间存在 $E_b = 0.25\\,\\mathrm{eV}$ 的结合能。正的结合能意味着当空位与溶质相邻时，系统的能量更低。因此，在溶质的最近邻位置找到空位的概率相对于体内，会通过一个与此结合能相关的玻尔兹曼因子得到增强：\n$$\nc_v^{NN} = c_v^{bulk} \\exp\\left(\\frac{E_b}{k_B T}\\right) = \\exp\\left(-\\frac{E_f}{k_B T}\\right) \\exp\\left(\\frac{E_b}{k_B T}\\right) = \\exp\\left(-\\frac{E_f - E_b}{k_B T}\\right)\n$$\n现在，我们可以组合出总的溶质跳跃频率 $\\Gamma_s$ 的表达式：\n$$\n\\Gamma_s = z \\, \\left[ \\exp\\left(-\\frac{E_f - E_b}{k_B T}\\right) \\right] \\, \\left[ \\nu_{sv} \\exp\\left(-\\frac{E_m^{sv}}{k_B T}\\right) \\right]\n$$\n合并指数项，我们得到：\n$$\n\\Gamma_s = z \\, \\nu_{sv} \\exp\\left(-\\frac{E_f - E_b + E_m^{sv}}{k_B T}\\right)\n$$\n将所有推导出的分量（$f_s=1$, $\\lambda^2=a^2/2$ 和 $\\Gamma_s$）代入 $D_s$ 的方程：\n$$\nD_s = \\frac{1}{6} (1) \\left[ z \\, \\nu_{sv} \\exp\\left(-\\frac{E_f - E_b + E_m^{sv}}{k_B T}\\right) \\right] \\left( \\frac{a^2}{2} \\right)\n$$\n对FCC晶格使用 $z=12$：\n$$\nD_s = \\frac{1}{6} (12) \\, \\nu_{sv} \\frac{a^2}{2} \\exp\\left(-\\frac{E_f - E_b + E_m^{sv}}{k_B T}\\right) = a^2 \\nu_{sv} \\exp\\left(-\\frac{E_f - E_b + E_m^{sv}}{k_B T}\\right)\n$$\n这就是在给定假设下，溶质扩散系数的最终解析表达式。\n\n我们现在使用所提供的参数进行数值计算：\n$a = 0.36\\,\\mathrm{nm} = 0.36 \\times 10^{-9}\\,\\mathrm{m}$\n$T = 900\\,\\mathrm{K}$\n$E_f = 1.60\\,\\mathrm{eV}$\n$E_b = 0.25\\,\\mathrm{eV}$\n$E_m^{sv} = 1.10\\,\\mathrm{eV}$\n$\\nu_{sv} = 5.0\\times 10^{12}\\,\\mathrm{s}^{-1}$\n$k_B = 8.617333262\\times 10^{-5}\\,\\mathrm{eV/K}$\n\n首先，计算热能 $k_B T$：\n$$\nk_B T = (8.617333262\\times 10^{-5}\\,\\mathrm{eV/K}) \\times (900\\,\\mathrm{K}) \\approx 0.077556\\,\\mathrm{eV}\n$$\n接下来，计算指数部分中的有效激活能 $Q_s$：\n$$\nQ_s = E_f - E_b + E_m^{sv} = 1.60\\,\\mathrm{eV} - 0.25\\,\\mathrm{eV} + 1.10\\,\\mathrm{eV} = 2.45\\,\\mathrm{eV}\n$$\n现在，计算指数项的值：\n$$\n\\exp\\left(-\\frac{Q_s}{k_B T}\\right) = \\exp\\left(-\\frac{2.45\\,\\mathrm{eV}}{0.077556\\,\\mathrm{eV}}\\right) \\approx \\exp(-31.590) \\approx 1.7224 \\times 10^{-14}\n$$\n计算指前因子 $D_0$：\n$$\nD_0 = a^2 \\nu_{sv} = (0.36 \\times 10^{-9}\\,\\mathrm{m})^2 \\times (5.0\\times 10^{12}\\,\\mathrm{s}^{-1})\n$$\n$$\nD_0 = (0.1296 \\times 10^{-18}\\,\\mathrm{m}^2) \\times (5.0\\times 10^{12}\\,\\mathrm{s}^{-1}) = 0.648 \\times 10^{-6}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}\n$$\n最后，将指前因子与指数项相乘得到 $D_s$：\n$$\nD_s = (0.648 \\times 10^{-6}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}) \\times (1.7224 \\times 10^{-14}) \\approx 1.1161 \\times 10^{-20}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}\n$$\n将结果四舍五入到三位有效数字，我们得到：\n$$\nD_s = 1.12 \\times 10^{-20}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}\n$$", "answer": "$$\n\\boxed{1.12 \\times 10^{-20}}\n$$", "id": "2982094"}, {"introduction": "随着计算材料科学的发展，我们现在能够从第一性原理出发预测扩散行为。这个计算练习将带您进入现代扩散研究的前沿，您将基于一个离散的、由密度泛函理论（DFT）等方法计算出的势能面，来确定原子扩散的激活能。您需要实现一种算法来寻找能量最低的扩散路径（最小最大路径），并结合过渡态理论计算扩散系数 $D$ [@problem_id:2982051]。这项实践将理论概念、数值算法和物理洞察力融为一体，完美展示了如何连接原子级别的量子力学计算与材料的宏观动力学属性。", "problem": "在晶体固体中，一个扩散的间隙原子在一个势能面上运动，该势能面可使用密度泛函理论 (Density Functional Theory, DFT) 计算。在一个离散化表示中，晶体二维平面中的一组候选间隙位置及其对应的位置能量被给定为一个矩形网格。考虑该网格上的最近邻连接（四个邻居：上、下、左、右）。两个指定位置之间扩散的激活势垒定义为：存在一条连接这两个位置的路径，该路径上所有中间位置的能量都不超过某个能级，这个能级的最小值减去初始位置的能量。在初始位置附近，势能沿笛卡尔方向被谐波近似，而过渡态理论 (Transition State Theory, TST) 将跳跃速率与尝试频率和玻尔兹曼因子联系起来。扩散系数可由二维晶格上连续时间随机行走的均方位移的定义推导出。\n\n从以下基本原理出发：\n- 玻尔兹曼分布指出，在绝对温度 $T$ 下，占据能量为 $E$ 的能级的概率与 $\\exp(-E/(k_{\\mathrm{B}} T))$ 成正比，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数。\n- 在位置 $x=0$ 的局部最小值附近，势能可以近似为 $V(x) \\approx \\frac{1}{2} \\kappa x^2$，其中 $\\kappa = \\frac{d^2 V}{dx^2}\\big|_{x=0}$ 是曲率。\n- 在过渡态理论 (TST) 中，越过能垒的速率由尝试频率和玻尔兹曼因子的乘积决定。\n- 对于二维空间中的无偏连续时间随机行走，均方位移满足 $\\langle r^2(t) \\rangle = 4 D t$，并且等于期望步数与步长平方的乘积。\n\n您的任务是按数学和算法实现以下步骤：\n1. 给定一个以电子伏特(eV)为单位的位置能量网格，以及由从零开始的整数坐标 $(r_{\\mathrm{s}}, c_{\\mathrm{s}})$ 和 $(r_{\\mathrm{e}}, c_{\\mathrm{e}})$ 指定的两个位置，计算阈值能量 $E_{\\mathrm{thr}}$，该能量是存在一条连接这两个位置的最近邻路径且路径上所有节点的能量都小于或等于 $E_{\\mathrm{thr}}$ 的最小能级。将激活势垒定义为 $E_{\\mathrm{a}} = E_{\\mathrm{thr}} - E(r_{\\mathrm{s}}, c_{\\mathrm{s}})$。这是一个关于节点能量的极小化极大路径问题（minimax path problem），可以通过按能量升序填充晶格并检查连通性来解决。\n2. 使用晶格常数 $a$ 的中心二阶有限差分来近似起始位置处沿 $x$ 方向的局部曲率 $\\kappa$：\n$$\n\\kappa \\approx \\frac{\\left[E(r_{\\mathrm{s}}, c_{\\mathrm{s}}+1) - 2\\,E(r_{\\mathrm{s}}, c_{\\mathrm{s}}) + E(r_{\\mathrm{s}}, c_{\\mathrm{s}}-1)\\right]\\,\\varepsilon}{a^2},\n$$\n其中 $\\varepsilon = 1.602\\,176\\,634\\times 10^{-19}\\,\\mathrm{J/eV}$ 将电子伏特转换为焦耳。\n3. 根据谐波近似 $V(x)\\approx \\frac{1}{2}\\kappa x^2$ 和质量为 $m$ 的粒子的牛顿动力学，得到角频率 $\\omega = \\sqrt{\\kappa/m}$ 和尝试频率 $\\nu = \\omega/(2\\pi)$。\n4. 使用过渡态理论和平衡统计力学，得到一个方向上的跳跃速率为\n$$\n\\Gamma = \\nu \\exp\\!\\left(-\\frac{E_{\\mathrm{a}}}{k_{\\mathrm{B}} T}\\right),\n$$\n其中当势垒以电子伏特为单位时，$k_{\\mathrm{B}}$ 应在单位上保持一致，使用电子伏特每开尔文。在二维空间中，有四个对称的最近邻居且跳跃长度为 $a$ 时，扩散系数满足\n$$\nD = a^2 \\Gamma,\n$$\n该关系可由 $\\langle r^2(t) \\rangle = N a^2$（其中 $N$ 是期望跳跃次数）和 $\\langle r^2(t) \\rangle = 4 D t$ 导出。\n\n实现一个完整的程序，为以下三个测试用例计算 $E_{\\mathrm{a}}$（单位：电子伏特）和 $D$（单位：米²/秒）。对坐标使用从零开始的索引，考虑四邻居连接，并假设晶格常数 $a$ 是相邻网格点之间的间距。将最终答案表示为电子伏特（对于 $E_{\\mathrm{a}}$）和米²/秒（对于 $D$）。您的程序必须将每个数值输出四舍五入到六位有效数字。\n\n测试套件：\n- 用例 1：\n  - 大小为 $5\\times 5$ 的网格，所有元素初始化为 $0.40$ eV，除了 $E(1,2)=0.05$ eV、$E(2,2)=0.08$ eV、$E(3,2)=0.05$ eV。\n  - 起点 $(r_{\\mathrm{s}},c_{\\mathrm{s}})=(1,2)$，终点 $(r_{\\mathrm{e}},c_{\\mathrm{e}})=(3,2)$。\n  - 晶格常数 $a=3.0\\times 10^{-10}\\,\\mathrm{m}$，质量 $m=1.674\\times 10^{-27}\\,\\mathrm{kg}$，温度 $T=600$ K。\n- 用例 2：\n  - 大小为 $5\\times 5$ 的网格，所有元素初始化为 $0.20$ eV，除了 $E(2,2)=0.10$ eV、$E(3,2)=0.10$ eV、$E(2,1)=0.11$ eV、$E(2,3)=0.12$ eV。\n  - 起点 $(r_{\\mathrm{s}},c_{\\mathrm{s}})=(2,2)$，终点 $(r_{\\mathrm{e}},c_{\\mathrm{e}})=(3,2)$。\n  - 晶格常数 $a=3.0\\times 10^{-10}\\,\\mathrm{m}$，质量 $m=1.674\\times 10^{-27}\\,\\mathrm{kg}$，温度 $T=300$ K。\n- 用例 3：\n  - 大小为 $5\\times 5$ 的网格，所有元素初始化为 $0.20$ eV，除了 $E(2,2)=0.50$ eV、$E(1,1)=0.12$ eV、$E(3,3)=0.12$ eV、$E(1,2)=0.15$ eV、$E(2,1)=0.15$ eV、$E(2,3)=0.15$ eV、$E(3,2)=0.15$ eV。\n  - 起点 $(r_{\\mathrm{s}},c_{\\mathrm{s}})=(1,1)$，终点 $(r_{\\mathrm{e}},c_{\\mathrm{e}})=(3,3)$。\n  - 晶格常数 $a=3.0\\times 10^{-10}\\,\\mathrm{m}$，质量 $m=1.674\\times 10^{-27}\\,\\mathrm{kg}$，温度 $T=800$ K。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个用例，并且本身必须是一个双元素列表 $[E_{\\mathrm{a}}, D]$，其中第一个元素以电子伏特为单位，第二个元素以米²/秒为单位。例如，输出必须看起来像\n$[[E_{\\mathrm{a,1}},D_1],[E_{\\mathrm{a,2}},D_2],[E_{\\mathrm{a,3}},D_3]]$。", "solution": "该问题要求使用离散化的势能网格以及平衡统计力学和过渡态理论 (TST) 的基本原理来计算激活势垒和扩散系数。推导从第一性原理出发，然后映射到一个算法。\n\n首先，激活势垒 $E_{\\mathrm{a}}$ 通过节点能量的极小化极大路径定义。考虑网格中的位置集合，每个位置的能量为 $E_{ij}$，单位为电子伏特 (eV)。对于两个位置 $(r_{\\mathrm{s}},c_{\\mathrm{s}})$ 和 $(r_{\\mathrm{e}},c_{\\mathrm{e}})$，路径定义为连接它们的最近邻位置序列。路径成本是该路径上的最大节点能量。阈值能量 $E_{\\mathrm{thr}}$ 是所有路径中可能的最小最大节点能量。形式上，\n$$\nE_{\\mathrm{thr}} = \\min_{\\mathcal{P} \\in \\mathcal{S}} \\left( \\max_{(i,j) \\in \\mathcal{P}} E_{ij} \\right),\n$$\n其中 $\\mathcal{S}$ 是从 $(r_{\\mathrm{s}},c_{\\mathrm{s}})$ 到 $(r_{\\mathrm{e}},c_{\\mathrm{e}})$ 的所有最近邻路径的集合。激活势垒是\n$$\nE_{\\mathrm{a}} = E_{\\mathrm{thr}} - E_{r_{\\mathrm{s}} c_{\\mathrm{s}}}.\n$$\n这个定义与物理诠释相符：在两个位置之间打开一个连接通道的最低能级决定了相对于初始最小值的鞍点能量。\n\n在算法上，这个极小化极大问题可以通过一个填充过程高效解决。按能量升序对所有位置进行排序。按该顺序激活位置，并使用不相交集联合（Disjoint Set Union, DSU，也称并查集）将相邻的已激活位置合并。每次激活后，检查起始和结束位置是否都已激活且属于同一集合。首次出现连通性时的位置能量恰好是 $E_{\\mathrm{thr}}$，因为在该激活水平下，存在一条完全位于子水平集 $\\{(i,j): E_{ij} \\le E_{\\mathrm{thr}}\\}$ 内的路径，而在此之前不存在这样的路径。\n\n其次，计算起始位置在谐波近似下的尝试频率 $\\nu$。在起始位置附近，假设沿 $x$ 方向的势能可以近似为 $V(x) \\approx \\frac{1}{2} \\kappa x^2$，其中 $\\kappa$ 是曲率。使用中心有限差分和晶格常数 $a$，\n$$\n\\kappa \\approx \\frac{\\left[E(r_{\\mathrm{s}}, c_{\\mathrm{s}}+1) - 2\\,E(r_{\\mathrm{s}}, c_{\\mathrm{s}}) + E(r_{\\mathrm{s}}, c_{\\mathrm{s}}-1)\\right] \\,\\varepsilon}{a^2},\n$$\n其中 $\\varepsilon = 1.602\\,176\\,634\\times 10^{-19}\\,\\mathrm{J/eV}$ 将电子伏特转换为焦耳。对一个质量为 $m$ 的粒子，谐振子的角频率是\n$$\n\\omega = \\sqrt{\\frac{\\kappa}{m}},\n$$\n尝试频率是循环频率\n$$\n\\nu = \\frac{\\omega}{2\\pi} = \\frac{1}{2\\pi}\\sqrt{\\frac{\\kappa}{m}}.\n$$\n\n第三，过渡态理论 (TST) 指出，越过一个能量为 $E_{\\mathrm{a}}$ 的势垒的速率与尝试频率乘以玻尔兹曼因子成正比。使用玻尔兹曼分布，在温度 $T$ 下热激活越过高度为 $E_{\\mathrm{a}}$ 势垒的概率与 $\\exp\\!\\left(-\\frac{E_{\\mathrm{a}}}{k_{\\mathrm{B}} T}\\right)$ 成比例。因此，一个方向上的跳跃速率是\n$$\n\\Gamma = \\nu \\exp\\!\\left(-\\frac{E_{\\mathrm{a}}}{k_{\\mathrm{B}} T}\\right).\n$$\n由于 $E_{\\mathrm{a}}$ 以电子伏特表示，因此应使用单位为电子伏特每开尔文的 $k_{\\mathrm{B}}$，即 $k_{\\mathrm{B}} \\approx 8.617\\,333\\,262\\,145\\times 10^{-5}\\,\\mathrm{eV/K}$，以在指数中保持单位一致性。\n\n最后，为将速率与扩散系数联系起来，考虑在一个二维方格上进行无偏连续时间随机行走，其中最近邻步长为 $a$。到时间 $t$ 为止的期望步数是一个速率为 $4\\Gamma$（四个方向，每个方向速率为 $\\Gamma$）的泊松过程，因此期望步数为 $N = 4\\Gamma t$。均方位移是独立步长的总和，$\\langle r^2(t) \\rangle = N a^2 = 4\\Gamma t\\, a^2$。根据二维扩散系数的定义，$\\langle r^2(t) \\rangle = 4 D t$。将两者相等可得\n$$\nD = a^2 \\Gamma.\n$$\n因此，算法如下：\n- 通过在升序节点能量上进行DSU填充来计算 $E_{\\mathrm{thr}}$，然后 $E_{\\mathrm{a}} = E_{\\mathrm{thr}} - E_{\\mathrm{s}}$。\n- 通过在起始位置沿 $x$ 方向的中心差分计算 $\\kappa$，转换为焦耳，除以 $a^2$，然后 $\\nu = \\frac{1}{2\\pi}\\sqrt{\\kappa/m}$。\n- 使用单位为电子伏特每开尔文的 $k_{\\mathrm{B}}$ 计算 $\\Gamma = \\nu \\exp\\!\\left(-\\frac{E_{\\mathrm{a}}}{k_{\\mathrm{B}} T}\\right)$。\n- 计算 $D = a^2 \\Gamma$。\n- 将以电子伏特为单位的 $E_{\\mathrm{a}}$ 和以米²/秒为单位的 $D$ 四舍五入到六位有效数字，并按指定的列表清单格式输出。\n\n所提供测试套件中的边缘情况和覆盖范围：\n- 用例1是一个典型的通道，其中一个能量较高的位置充当鞍点，产生一个非零势垒。\n- 用例2是一个边界情况，直接相邻路径上的势垒为零，测试算法能否正确得到 $E_{\\mathrm{a}}=0$，同时仍能从局部曲率计算出有限的尝试频率。\n- 用例3包含一个高能量脊，需要绕行；极小化极大阈值由最佳绕行路径上遇到的最高能量控制，测试了寻路逻辑。\n\n程序实现了带有路径压缩和按秩合并的DSU以提高效率，计算有限差分以获得曲率，处理单位转换，并以六位有效数字打印所需的输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom math import sqrt, exp, pi\n\ndef format_sig(x, sig=6):\n    # Format a number to a string with 'sig' significant figures.\n    # Use general format to allow scientific notation for very small/large values.\n    return f\"{x:.{sig}g}\"\n\nclass DSU:\n    def __init__(self, n):\n        self.parent = list(range(n))\n        self.rank = [0]*n\n\n    def find(self, x):\n        # Path compression\n        while self.parent[x] != x:\n            self.parent[x] = self.parent[self.parent[x]]\n            x = self.parent[x]\n        return x\n\n    def union(self, x, y):\n        rx = self.find(x)\n        ry = self.find(y)\n        if rx == ry:\n            return False\n        # Union by rank\n        if self.rank[rx] < self.rank[ry]:\n            self.parent[rx] = ry\n        elif self.rank[rx] > self.rank[ry]:\n            self.parent[ry] = rx\n        else:\n            self.parent[ry] = rx\n            self.rank[rx] += 1\n        return True\n\ndef minimax_threshold(E_grid, start_rc, end_rc):\n    \"\"\"\n    Compute the minimal energy threshold for connectivity via 4-neighbor paths.\n    E_grid: 2D numpy array of energies in eV.\n    start_rc, end_rc: tuples (r, c) with zero-based indices.\n    Returns E_thr in eV.\n    \"\"\"\n    R, C = E_grid.shape\n    # Flatten indices\n    def idx(r, c): return r * C + c\n\n    # Prepare sorted list of nodes by energy\n    energies = E_grid.flatten()\n    order = np.argsort(energies)\n    active = np.zeros(R*C, dtype=bool)\n    dsu = DSU(R*C)\n\n    srci = idx(*start_rc)\n    dsti = idx(*end_rc)\n\n    # Map index to (r,c) for neighbor checks\n    rc_from_idx = [(i // C, i % C) for i in range(R*C)]\n\n    # Directions: up, down, left, right\n    dirs = [(-1,0),(1,0),(0,-1),(0,1)]\n\n    for k in order:\n        r, c = rc_from_idx[k]\n        active[k] = True\n        # Union with active neighbors\n        for dr, dc in dirs:\n            nr, nc = r + dr, c + dc\n            if 0 <= nr < R and 0 <= nc < C:\n                ni = idx(nr, nc)\n                if active[ni]:\n                    dsu.union(k, ni)\n        # Check connectivity once both are active\n        if active[srci] and active[dsti]:\n            if dsu.find(srci) == dsu.find(dsti):\n                # The current energy is the threshold\n                return energies[k]\n    # If not connected even at highest energy (should not happen in this test suite)\n    return energies[order[-1]]\n\ndef curvature_along_x(E_grid, start_rc, a, eV_to_J):\n    \"\"\"\n    Central second-order finite difference curvature along x-direction at start site.\n    E_grid: 2D numpy array of energies in eV.\n    start_rc: (r, c) with c in [1, C-2] to have neighbors.\n    a: lattice constant in meters.\n    eV_to_J: conversion factor.\n    Returns kappa in J/m^2.\n    \"\"\"\n    r, c = start_rc\n    E_left = E_grid[r, c-1]\n    E_center = E_grid[r, c]\n    E_right = E_grid[r, c+1]\n    second_diff_eV = (E_right - 2.0*E_center + E_left)\n    kappa = (second_diff_eV * eV_to_J) / (a**2)\n    return kappa\n\ndef compute_case(E_grid, start_rc, end_rc, a, m, T):\n    \"\"\"\n    Compute Ea (eV) and D (m^2/s) for one case.\n    \"\"\"\n    # Constants\n    eV_to_J = 1.602176634e-19\n    kB_eV = 8.617333262145e-5  # eV/K\n\n    # Activation barrier via minimax threshold\n    E_thr = minimax_threshold(E_grid, start_rc, end_rc)\n    E_start = E_grid[start_rc[0], start_rc[1]]\n    Ea = E_thr - E_start  # in eV\n\n    # Attempt frequency from harmonic curvature along x\n    kappa = curvature_along_x(E_grid, start_rc, a, eV_to_J)  # J/m^2\n    # Guard against negative or zero curvature: if non-positive, set nu to 0\n    nu = 0.0\n    if kappa > 0.0:\n        omega = sqrt(kappa / m)  # rad/s\n        nu = omega / (2.0 * pi)  # Hz\n\n    # Jump rate and diffusion coefficient\n    # Use kB in eV/K consistent with Ea (in eV)\n    boltz = exp(-Ea / (kB_eV * T))\n    Gamma = nu * boltz  # s^-1 (per direction)\n    D = (a**2) * Gamma  # m^2/s\n\n    return Ea, D\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Case 1\n    E1 = np.full((5,5), 0.40, dtype=float)\n    E1[1,2] = 0.05\n    E1[2,2] = 0.08\n    E1[3,2] = 0.05\n    start1 = (1,2)\n    end1 = (3,2)\n    a1 = 3.0e-10\n    m1 = 1.674e-27\n    T1 = 600\n\n    # Case 2\n    E2 = np.full((5,5), 0.20, dtype=float)\n    E2[2,2] = 0.10\n    E2[3,2] = 0.10\n    E2[2,1] = 0.11\n    E2[2,3] = 0.12\n    start2 = (2,2)\n    end2 = (3,2)\n    a2 = 3.0e-10\n    m2 = 1.674e-27\n    T2 = 300\n\n    # Case 3\n    E3 = np.full((5,5), 0.20, dtype=float)\n    E3[2,2] = 0.50\n    E3[1,1] = 0.12\n    E3[3,3] = 0.12\n    E3[1,2] = 0.15\n    E3[2,1] = 0.15\n    E3[2,3] = 0.15\n    E3[3,2] = 0.15\n    start3 = (1,1)\n    end3 = (3,3)\n    a3 = 3.0e-10\n    m3 = 1.674e-27\n    T3 = 800\n\n    test_cases = [\n        (E1, start1, end1, a1, m1, T1),\n        (E2, start2, end2, a2, m2, T2),\n        (E3, start3, end3, a3, m3, T3),\n    ]\n\n    results = []\n    for E, s, e, a, m, T in test_cases:\n        Ea, D = compute_case(E, s, e, a, m, T)\n        results.append([format_sig(Ea, 6), format_sig(D, 6)])\n\n    # Final print statement in the exact required format.\n    # Produce a single-line bracketed list of lists: [[Ea1,D1],[Ea2,D2],[Ea3,D3]]\n    print(f\"[{','.join('[' + ','.join(map(str, pair)) + ']' for pair in results)}]\")\n\nsolve()\n```", "id": "2982051"}]}