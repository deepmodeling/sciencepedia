{"hands_on_practices": [{"introduction": "衍射图样是晶体中所有原子散射波相干叠加的结果，而理解这一现象的起点是单个原子的散射能力，即原子形状因子 $f(\\mathbf{q})$。本练习将带你从一个原子的电子密度分布出发，通过傅里叶变换这一基本工具，亲手计算其原子形状因子。通过一个高斯函数模型，我们将得到一个解析结果，它清晰地揭示了原子形状因子的基本性质及其对散射矢量 $\\mathbf{q}$ 的依赖关系。", "problem": "在X射线散射实验中，来自孤立原子的散射由原子形状因子 $f(\\mathbf{q})$ 描述。这个量是原子电子密度分布 $\\rho(\\mathbf{r})$ 的傅里叶变换，其表达式为：\n$$ f(\\mathbf{q}) = \\int \\rho(\\mathbf{r}) e^{i \\mathbf{q} \\cdot \\mathbf{r}} d^3r $$\n其中 $\\mathbf{q}$ 是散射矢量，表示散射后X射线的波矢变化量。\n\n考虑一个包含 $Z$ 个电子的中性原子模型。假设电子电荷在原子核周围呈连续且球对称分布。电子密度由径向距离 $r = |\\mathbf{r}|$ 的高斯函数描述：\n$$ \\rho(r) = A e^{-\\alpha r^2} $$\n其中 $A$ 和 $\\alpha$ 是正常数。常数 $A$ 由归一化条件确定，即电子密度在整个空间上的积分必须等于总电子数 $Z$：\n$$ \\int \\rho(\\mathbf{r}) d^3r = Z $$\n\n基于此模型，推导原子形状因子 $f(q)$ 作为散射矢量大小 $q = |\\mathbf{q}|$ 的函数。用 $Z$、$\\alpha$ 和 $q$ 表示你的最终答案。", "solution": "求解过程包括两个主要步骤：首先，确定归一化常数 $A$；其次，计算电子密度的傅里叶变换。\n\n**步骤1：确定归一化常数 $A$**\n\n我们使用归一化条件 $\\int \\rho(\\mathbf{r}) d^3r = Z$。由于密度 $\\rho(r)$ 是球对称的，我们可以在球坐标系中计算该积分，其中 $d^3r = r^2 \\sin\\theta dr d\\theta d\\phi$。\n\n$$ Z = \\int_0^{2\\pi} d\\phi \\int_0^\\pi \\sin\\theta d\\theta \\int_0^\\infty \\rho(r) r^2 dr $$\n代入 $\\rho(r) = A e^{-\\alpha r^2}$：\n$$ Z = A \\left( \\int_0^{2\\pi} d\\phi \\right) \\left( \\int_0^\\pi \\sin\\theta d\\theta \\right) \\left( \\int_0^\\infty e^{-\\alpha r^2} r^2 dr \\right) $$\n角度部分的积分很简单：\n$$ \\int_0^{2\\pi} d\\phi = 2\\pi $$\n$$ \\int_0^\\pi \\sin\\theta d\\theta = [-\\cos\\theta]_0^\\pi = -(-1 - 1) = 2 $$\n所以积分变为：\n$$ Z = A (4\\pi) \\int_0^\\infty r^2 e^{-\\alpha r^2} dr $$\n剩下的径向积分是标准的高斯积分，其形式为 $\\int_0^\\infty x^{2n} e^{-ax^2} dx = \\frac{(2n-1)!!}{2^{n+1}}\\sqrt{\\frac{\\pi}{a^{2n+1}}}$。在我们的情况下，$n=1$ 且 $a=\\alpha$，所以：\n$$ \\int_0^\\infty r^2 e^{-\\alpha r^2} dr = \\frac{1}{4} \\sqrt{\\frac{\\pi}{\\alpha^3}} $$\n将此结果代回：\n$$ Z = 4\\pi A \\left( \\frac{1}{4} \\sqrt{\\frac{\\pi}{\\alpha^3}} \\right) = A \\pi^{3/2} \\alpha^{-3/2} = A \\left( \\frac{\\pi}{\\alpha} \\right)^{3/2} $$\n解出 $A$，我们得到：\n$$ A = Z \\left( \\frac{\\alpha}{\\pi} \\right)^{3/2} $$\n\n**步骤2：计算原子形状因子 $f(q)$**\n\n原子形状因子由 $f(\\mathbf{q}) = \\int \\rho(\\mathbf{r}) e^{i \\mathbf{q} \\cdot \\mathbf{r}} d^3r$ 给出。我们再次使用球坐标系。对于球对称函数，其傅里叶变换的结果将只依赖于大小 $q=|\\mathbf{q}|$。我们可以通过将坐标系的z轴与散射矢量 $\\mathbf{q}$ 对齐来简化计算。因此，$\\mathbf{q} \\cdot \\mathbf{r} = q r \\cos\\theta$。\n\n$$ f(q) = \\int_0^{2\\pi} d\\phi \\int_0^\\pi d\\theta \\int_0^\\infty dr \\, (A e^{-\\alpha r^2}) e^{iqr\\cos\\theta} r^2 \\sin\\theta $$\n被积函数与 $\\phi$ 无关，所以对 $\\phi$ 的积分得到 $2\\pi$：\n$$ f(q) = 2\\pi A \\int_0^\\infty r^2 e^{-\\alpha r^2} dr \\int_0^\\pi e^{iqr\\cos\\theta} \\sin\\theta d\\theta $$\n现在我们计算对 $\\theta$ 的积分。令 $u = \\cos\\theta$，则 $du = -\\sin\\theta d\\theta$。积分限从 $[0, \\pi]$ 变为 $[1, -1]$。\n$$ \\int_0^\\pi e^{iqr\\cos\\theta} \\sin\\theta d\\theta = \\int_1^{-1} e^{iqru} (-du) = \\int_{-1}^1 e^{iqru} du $$\n$$ = \\left[ \\frac{e^{iqru}}{iqr} \\right]_{-1}^1 = \\frac{e^{iqr} - e^{-iqr}}{iqr} = \\frac{2i \\sin(qr)}{iqr} = \\frac{2\\sin(qr)}{qr} $$\n将此结果代回 $f(q)$ 的表达式中：\n$$ f(q) = 2\\pi A \\int_0^\\infty r^2 e^{-\\alpha r^2} \\left( \\frac{2\\sin(qr)}{qr} \\right) dr $$\n$$ f(q) = \\frac{4\\pi A}{q} \\int_0^\\infty r e^{-\\alpha r^2} \\sin(qr) dr $$\n积分 $I = \\int_0^\\infty r e^{-\\alpha r^2} \\sin(qr) dr$ 可以通过将其与高斯函数的傅里叶余弦变换联系起来求解，$F_c(k) = \\int_0^\\infty e^{-ax^2}\\cos(kx)dx = \\frac{1}{2}\\sqrt{\\frac{\\pi}{a}} e^{-k^2/4a}$。注意到我们的积分 $I$ 是 $-\\frac{d}{dq} \\int_0^\\infty e^{-\\alpha r^2} \\cos(qr) dr$。\n使用公式，令 $a=\\alpha$ 和 $k=q$：\n$$ \\int_0^\\infty e^{-\\alpha r^2} \\cos(qr) dr = \\frac{1}{2}\\sqrt{\\frac{\\pi}{\\alpha}} e^{-q^2/4\\alpha} $$\n对 $q$ 求导：\n$$ \\frac{d}{dq} \\left( \\frac{1}{2}\\sqrt{\\frac{\\pi}{\\alpha}} e^{-q^2/4\\alpha} \\right) = \\frac{1}{2}\\sqrt{\\frac{\\pi}{\\alpha}} \\left(-\\frac{2q}{4\\alpha}\\right) e^{-q^2/4\\alpha} = -\\frac{q}{4\\alpha} \\sqrt{\\frac{\\pi}{\\alpha}} e^{-q^2/4\\alpha} $$\n所以，积分 $I$ 是：\n$$ I = -\\left( -\\frac{q}{4\\alpha} \\sqrt{\\frac{\\pi}{\\alpha}} e^{-q^2/4\\alpha} \\right) = \\frac{q\\sqrt{\\pi}}{4\\alpha^{3/2}} e^{-q^2/4\\alpha} $$\n现在将此结果代回 $f(q)$ 的表达式中：\n$$ f(q) = \\frac{4\\pi A}{q} \\left( \\frac{q\\sqrt{\\pi}}{4\\alpha^{3/2}} e^{-q^2/4\\alpha} \\right) = \\frac{A \\pi^{3/2}}{\\alpha^{3/2}} e^{-q^2/4\\alpha} = A \\left(\\frac{\\pi}{\\alpha}\\right)^{3/2} e^{-q^2/4\\alpha} $$\n最后，代入归一化常数 $A = Z (\\alpha/\\pi)^{3/2}$ 的表达式：\n$$ f(q) = \\left[ Z \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\right] \\left(\\frac{\\pi}{\\alpha}\\right)^{3/2} e^{-q^2/4\\alpha} $$\n$$ f(q) = Z e^{-q^2/4\\alpha} $$\n这个结果表明，高斯函数的傅里叶变换仍然是高斯函数。作为检验，对于 $q=0$ (前向散射)，$f(0) = Z e^0 = Z$，这正是总电子数，与预期相符。", "answer": "$$ \\boxed{Z \\exp\\left(-\\frac{q^2}{4\\alpha}\\right)} $$", "id": "217999"}, {"introduction": "在掌握了单个原子的散射后，我们进而研究完整晶体的衍射。本练习将以重要的闪锌矿（ZnS）结构为例，探讨单元晶胞内不同原子（A和B）的具体排布如何通过结构因子 $F_{hkl}$ 决定衍射峰的强度。通过计算并比较不同晶面（如(220)和(200)）的衍射强度，我们将揭示衍射实验是如何灵敏地探测到与原子形状因子之和 $f_A+f_B$ 或之差 $f_A-f_B$ 相关的结构信息，这是材料表征中的一个核心原理。", "problem": "闪锌矿（ZnS）晶体结构由一个面心立方（FCC）布拉维晶格和一个双原子基元构成。其常规立方晶胞的边长为 $a$。相对于每个晶格点，基元包含一个位于位置 $\\mathbf{d}_A = (0,0,0)$ 的A类原子和一个位于位置 $\\mathbf{d}_B = \\frac{a}{4}(\\hat{x} + \\hat{y} + \\hat{z})$ 的B类原子。\n\n晶体对X射线的散射振幅由结构因子 $F_{hkl}$ 决定，该结构因子对应于由米勒指数 $(h,k,l)$ 标记的特定布拉格反射。对于带基元的晶格，结构因子通过对单个晶胞内所有原子求和来计算。对于闪锌矿结构，常规晶胞中原子的位置可以写为 $\\mathbf{r}_j = \\mathbf{R}_n + \\mathbf{d}_k$，其中 $\\mathbf{R}_n$ 是FCC晶格点的位置，$\\mathbf{d}_k$ 是基元原子的位置。\n\n常规晶胞中的四个FCC晶格点位于 $\\mathbf{R}_1 = (0,0,0)$、$\\mathbf{R}_2 = \\frac{a}{2}(\\hat{x}+\\hat{y})$、$\\mathbf{R}_3 = \\frac{a}{2}(\\hat{x}+\\hat{z})$ 和 $\\mathbf{R}_4 = \\frac{a}{2}(\\hat{y}+\\hat{z})$。设 A、B 原子的原子形状因子分别为 $f_A$ 和 $f_B$。您可以假设这些形状因子为实数且与散射矢量无关。\n\n计算 $(2,2,0)$ 和 $(2,0,0)$ 反射的衍射强度之比。该比值等于相应结构因子模的平方之比，即 $R = \\frac{|F_{220}|^2}{|F_{200}|^2}$。", "solution": "米勒指数为 $(h,k,l)$ 的结构因子为\n$$\nF_{hkl} \\;=\\;\\sum_{j}f_j\\,e^{2\\pi i(hx_j+ky_j+lz_j)}\\,,\n$$\n其中 $(x_j,y_j,z_j)$ 是以 $a$ 为单位的原子坐标。对于闪锌矿的常规晶胞，按四个FCC格点 $\\mathbf R_n$ 和双原子基元 $\\{\\mathbf d_A,\\mathbf d_B\\}$ 进行分组：\n$$\nF_{hkl}\n=\\sum_{n=1}^4\\Bigl[f_A\\,e^{2\\pi i\\,\\mathbf G\\cdot\\mathbf R_n}\n+f_B\\,e^{2\\pi i\\,\\mathbf G\\cdot(\\mathbf R_n+\\mathbf{d}_B)}\\Bigr]\n=\\Bigl[f_A+f_B\\,e^{2\\pi i\\,\\mathbf G\\cdot\\mathbf{d}_B}\\Bigr]\n\\sum_{n=1}^4e^{2\\pi i\\,\\mathbf G\\cdot\\mathbf R_n}\\!,\n$$\n其中 $\\mathbf G=(h,k,l)/a$ 且 $\\mathbf{d}_B=(\\tfrac14,\\tfrac14,\\tfrac14)a$。现在\n$$\n\\mathbf G\\cdot\\mathbf{d}_B\n=\\frac{h+k+l}{4},\\qquad\n\\sum_{n=1}^4e^{2\\pi i\\,\\mathbf G\\cdot\\mathbf R_n}\n=1+e^{i\\pi(h+k)}+e^{i\\pi(h+l)}+e^{i\\pi(k+l)}.\n$$\n对于 $h,k,l$ 全为偶数或全为奇数的fcc反射，每个指数项都等于 $+1$，因此总和为 $4$。因此\n$$\nF_{hkl}=4\\bigl(f_A+f_B\\,e^{i\\pi\\frac{h+k+l}{2}}\\bigr).\n$$\n对于 $(2,2,0)$ 情况：$h+k+l=4\\implies e^{i\\pi\\frac{4}{2}}=e^{2\\pi i}=1$，因此\n$$\nF_{220}=4\\,(f_A+f_B).\n$$\n对于 $(2,0,0)$ 情况：$h+k+l=2\\implies e^{i\\pi\\frac{2}{2}}=e^{i\\pi}=-1$，因此\n$$\nF_{200}=4\\,(f_A-f_B).\n$$\n强度比为\n$$\nR=\\frac{|F_{220}|^2}{|F_{200}|^2}\n=\\frac{16(f_A+f_B)^2}{16(f_A-f_B)^2}\n=\\Bigl(\\frac{f_A+f_B}{f_A-f_B}\\Bigr)^{\\!2}.\n$$", "answer": "$$\\boxed{\\left(\\frac{f_A+f_B}{f_A-f_B}\\right)^2}$$", "id": "218138"}, {"introduction": "真实的晶体并非完美无瑕。最后的这个练习将引导我们探讨晶体结构的微小偏离——例如原子的轻微位移——如何影响衍射图样。通过分析一个存在畸变的体心立方（BCC）晶格，我们将看到对称性的破缺是如何激活在理想结构中本应“禁戒”的衍射峰。这一原理对于研究材料中微妙的结构变化、相变以及缺陷至关重要。", "problem": "在晶体的X射线衍射中，散射振幅由结构因子 $F_{\\mathbf{G}}$ 决定，它取决于晶胞内原子的排列以及原子自身的散射特性。对于一个原子基元，其结构因子由下式给出：\n$$ F_{\\mathbf{G}} = \\sum_{j=1}^{N} f_j(\\mathbf{G}) e^{i \\mathbf{G} \\cdot \\mathbf{r}_j} $$\n其中$N$是基元中的原子数，$\\mathbf{r}_j$是第$j$个原子的位置矢量，$f_j(\\mathbf{G})$是其原子形状因子，$\\mathbf{G}$是一个倒格矢。\n\n考虑一个具有体心立方（BCC）结构的单原子晶体，它由边长为$a$的常规立方晶胞描述。对应于衍射峰的倒格矢由$\\mathbf{G} = \\frac{2\\pi}{a}(h\\hat{x} + k\\hat{y} + l\\hat{z})$给出，其中$h, k, l$是被称为米勒指数的整数。\n\n该晶体表现出微小的结构畸变。常规晶胞的基元包含两个相同的原子。第一个原子位于原点，$\\mathbf{r}_1 = (0,0,0)$。第二个原子理想情况下位于体心，但沿z轴有轻微位移。其位置由$\\mathbf{r}_2 = \\frac{a}{2}(\\hat{x} + \\hat{y} + \\hat{z}) + \\delta \\hat{z}$给出，其中$\\delta$是一个恒定位移。晶体中所有原子都属于同一类型，因此它们的原子形状因子$f(\\mathbf{G})$是相同的。\n\n计算对应于米勒指数$(h,k,l) = (0,0,1)$的特定反射的结构因子模的平方$|F_{\\mathbf{G}}|^2$。设$f_{001}$表示在该反射的特定倒格矢$\\mathbf{G}$处计算的原子形状因子。用$f_{001}$、$a$和$\\delta$表示你的答案。对于此问题，你可以假设$f_{001}$是一个实数。", "solution": "每个晶胞中有两个原子，位置分别为  \n\n$$\n\\mathbf{r}_1 = (0,0,0), \n\\quad \n\\mathbf{r}_2 = \\Bigl(\\tfrac{a}{2},\\tfrac{a}{2},\\tfrac{a}{2}+\\delta\\Bigr)\\,,\n$$\n  \n对于$(0,0,1)$反射，它们具有相同的原子形状因子$f_{001}$。倒格矢为  \n\n$$\n\\mathbf{G} = \\frac{2\\pi}{a}(0,0,1)\\,.\n$$\n  \n1. 结构因子：  \n\n$$\nF_{\\mathbf{G}}\n= \\sum_{j=1}^2 f_{001}\\,e^{i\\mathbf{G}\\cdot\\mathbf{r}_j}\n= f_{001}\\Bigl[1 + e^{i\\mathbf{G}\\cdot\\mathbf{r}_2}\\Bigr].\n$$\n  \n2. 计算第二个原子的相位：  \n\n$$\n\\mathbf{G}\\cdot\\mathbf{r}_2\n= \\frac{2\\pi}{a}\\,(a/2+\\delta)\n= \\pi + \\frac{2\\pi\\,\\delta}{a}.\n$$\n  \n因此  \n\n$$\nF_{\\mathbf{G}}\n= f_{001}\\Bigl[1 + e^{i(\\pi + 2\\pi\\delta/a)}\\Bigr]\n= f_{001}\\bigl[1 - e^{i2\\pi\\delta/a}\\bigr].\n$$\n  \n3. 模的平方：  \n\n$$\n|F_{\\mathbf{G}}|^2\n= f_{001}^2\\,\\bigl|1 - e^{i2\\pi\\delta/a}\\bigr|^2\n= f_{001}^2\\bigl[2 - 2\\cos(2\\pi\\delta/a)\\bigr]\n= 4\\,f_{001}^2\\,\\sin^2\\!\\Bigl(\\frac{\\pi\\delta}{a}\\Bigr).\n$$", "answer": "$$\\boxed{4\\,f_{001}^2\\,\\sin^2\\!\\bigl(\\tfrac{\\pi\\delta}{a}\\bigr)}$$", "id": "217997"}]}