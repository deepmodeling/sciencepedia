{"hands_on_practices": [{"introduction": "深入理解晶体物理学，始于从第一性原理精确描述原子的空间排布。本练习将引导你分析最简单的立方结构——简单立方（sc）晶格，通过矢量分析和几何可视化，系统地确定近邻、次近邻和三近邻的壳层结构。这项实践旨在为你奠定坚实的晶体几何基础，是掌握量化晶体学不可或缺的第一步 [@problem_id:2976225]。", "problem": "一个单原子晶体形成了简单立方（sc）布拉维格子，其常规立方晶格常数为$a$。请仅使用布拉维格子的定义、实空间中原子间距的欧几里得度量，以及作为第一近邻壳层中原子数的配位数的定义，从第一性原理出发，推导出简单立方结构中的配位数和最近邻距离，并将它们表示为$a$的函数。此外，请列举第二和第三近邻壳层，给出它们的多重度（每个壳层中有多少个近邻原子）以及它们与参考原子之间的相应距离，同样表示为$a$的函数。\n\n你的推导必须从晶格矢量和晶格平移矢量集开始，通过将不同的壳层识别为与原点等距的格点集（不包括原点本身）来进行。\n\n请将你的最终结果以单行矩阵的形式报告，按顺序包含$z_{1}$、 $r_{1}$、 $z_{2}$、 $r_{2}$、 $z_{3}$、 $r_{3}$，其中$z_{n}$是第$n$个近邻壳层的多重度，$r_{n}$是其距离，所有这些都用$a$来表示。\n\n最终答案中不要包含单位。不需要进行数值取整；请提供精确的符号表达式。", "solution": "该问题陈述清晰且科学上合理，基于晶体学和固态物理学的基础概念。我们将从第一性原理出发进行严格的推导。\n\n布拉维格子是由位置矢量$\\vec{R}$定义的无限点阵，其形式为：\n$$\n\\vec{R} = n_1 \\vec{a}_1 + n_2 \\vec{a}_2 + n_3 \\vec{a}_3\n$$\n其中$\\vec{a}_1$、$\\vec{a}_2$、$\\vec{a}_3$是原胞基矢，而$n_1、 n_2、 n_3$是任意整数。对于一个常规立方晶格常数为$a$的简单立方（sc）格子，最简单的原胞基矢选择是使其与笛卡尔坐标系对齐：\n$$\n\\vec{a}_1 = a \\hat{x}, \\quad \\vec{a}_2 = a \\hat{y}, \\quad \\vec{a}_3 = a \\hat{z}\n$$\n因此，任何格点都可以用对应于整数三元组$(n_x, n_y, n_z)$的矢量$\\vec{R}$表示：\n$$\n\\vec{R}(n_x, n_y, n_z) = a(n_x \\hat{x} + n_y \\hat{y} + n_z \\hat{z})\n$$\n我们在原点处设置一个参考原子，对应于三元组$(0, 0, 0)$。从该参考原子到位于$\\vec{R}$位置的任何其他原子的距离$d$由矢量$\\vec{R}$的欧几里得范数给出：\n$$\nd = |\\vec{R}| = \\sqrt{\\vec{R} \\cdot \\vec{R}} = \\sqrt{(a n_x)^2 + (a n_y)^2 + (a n_z)^2} = a \\sqrt{n_x^2 + n_y^2 + n_z^2}\n$$\n近邻壳层被定义为距参考原子等距的原子集合。为了识别这些壳层，我们必须考虑所有非零整数三元组$(n_x, n_y, n_z)$，并系统地计算平方和$S = n_x^2 + n_y^2 + n_z^2$，从而找到$d$的不同值。到某个壳层的距离则为$r = a\\sqrt{S}$，其多重度（壳层中的原子数）是能产生相同$S$值的不同整数三元组$(n_x, n_y, n_z)$的数量。\n\n**第一近邻壳层 ($n=1$):**\n我们寻找$S = n_x^2 + n_y^2 + n_z^2$的最小非零值。由于$n_x、 n_y、 n_z$是整数，$n_i^2$的最小可能非零值为$1, 4, 9, \\dots$。当其中一个整数为$\\pm 1$而另外两个为$0$时，可以获得最小和$S_1$。\n$$\nS_1 = (\\pm 1)^2 + 0^2 + 0^2 = 1\n$$\n到这个第一壳层的距离，即最近邻距离$r_1$，是：\n$$\nr_1 = a \\sqrt{S_1} = a \\sqrt{1} = a\n$$\n这个壳层的多重度$z_1$，也就是配位数，是所有导致$S_1=1$的整数三元组的数量。这些是$(\\pm 1, 0, 0)$的排列：\n- $(\\pm 1, 0, 0)$: $2$个原子（沿$x$轴正方向和负方向）\n- $(0, \\pm 1, 0)$: $2$个原子（沿$y$轴正方向和负方向）\n- $(0, 0, \\pm 1)$: $2$个原子（沿$z$轴正方向和负方向）\n总多重度为$z_1 = 2 + 2 + 2 = 6$。\n\n**第二近邻壳层 ($n=2$):**\n平方和的下一个最小值$S_2$通过将两个整数设为$\\pm 1$、一个整数设为$0$来找到。\n$$\nS_2 = (\\pm 1)^2 + (\\pm 1)^2 + 0^2 = 1 + 1 + 0 = 2\n$$\n到第二近邻壳层的距离$r_2$是：\n$$\nr_2 = a \\sqrt{S_2} = a \\sqrt{2}\n$$\n多重度$z_2$是所有导致$S_2=2$的整数三元组的数量。这些是$(\\pm 1, \\pm 1, 0)$的排列：\n- $(\\pm 1, \\pm 1, 0)$: $4$个原子（在$xy$平面上，位于$(\\pm a, \\pm a, 0)$）\n- $(\\pm 1, 0, \\pm 1)$: $4$个原子（在$xz$平面上，位于$(\\pm a, 0, \\pm a)$）\n- $(0, \\pm 1, \\pm 1)$: $4$个原子（在$yz$平面上，位于$(0, \\pm a, \\pm a)$）\n总多重度为$z_2 = 4 + 4 + 4 = 12$。这些近邻原子位于以原点为中心、边长为$2a$的立方体的面心上。\n\n**第三近邻壳层 ($n=3$):**\n平方和的下一个不同值$S_3$通过将所有三个整数都设为$\\pm 1$来找到。\n$$\nS_3 = (\\pm 1)^2 + (\\pm 1)^2 + (\\pm 1)^2 = 1 + 1 + 1 = 3\n$$\n注意，和$S=4$（例如，来自$2^2+0^2+0^2$）大于$S=3$。到第三近邻壳层的距离$r_3$是：\n$$\nr_3 = a \\sqrt{S_3} = a \\sqrt{3}\n$$\n多重度$z_3$是所有导致$S_3=3$的整数三元组的数量。这些是所有分量均为$\\pm 1$的三元组：\n- $(\\pm 1, \\pm 1, \\pm 1)$: 共有$2 \\times 2 \\times 2 = 8$种可能的符号组合。\n总多重度为$z_3 = 8$。这些近邻原子位于以原点为中心、边长为$2a$的立方体的顶点上。\n\n综上所述，我们已经为简单立方格子的前三个近邻壳层推导出了以下量：\n- 第1壳层: $z_1 = 6$, $r_1 = a$\n- 第2壳层: $z_2 = 12$, $r_2 = a\\sqrt{2}$\n- 第3壳层: $z_3 = 8$, $r_3 = a\\sqrt{3}$\n\n现在将这些结果汇编成所要求的矩阵格式。", "answer": "$$\n\\boxed{\\begin{pmatrix} 6 & a & 12 & a\\sqrt{2} & 8 & a\\sqrt{3} \\end{pmatrix}}\n$$", "id": "2976225"}, {"introduction": "在掌握了基本的几何分析之后，我们进一步探讨原子排布如何决定晶体的物理特性。本练习通过一个思想实验，即通过将闪锌矿晶格中的两种原子视为相同，从而将其转变为金刚石晶格，揭示了晶体基元、对称性、衍射图样和电子能带结构之间的深刻联系。这项练习对于理解为何看似相似的结构会展现出截然不同的物理性质至关重要 [@problem_id:2976223]。", "problem": "考虑一个具有闪锌矿几何构型的晶体，其定义如下。原子核占据两个相互贯穿的面心立方（FCC）子晶格，其常规立方晶格参数为 $a$，两者之间的位移矢量为 $\\mathbf{d}=(a/4)(1,1,1)$；一个子晶格容纳 $A$ 类原子，另一个容纳 $B$ 类原子。其布拉维晶格为面心立方（FCC）晶格；其倒易晶格和相应的布里渊区（BZ）也与 FCC 布拉维晶格相关联。对于倒易晶格矢量 $\\mathbf{G}$，运动学散射振幅为晶体结构因子 $F(\\mathbf{G})=\\sum_{j} f_{j} \\exp(i \\mathbf{G}\\cdot \\mathbf{r}_{j})$，其中 $f_{j}$ 是位于 $\\mathbf{r}_{j}$ 处的单个原子的弹性 X 射线形状因子。单电子哈密顿量为 $H=\\frac{\\mathbf{p}^{2}}{2m}+V(\\mathbf{r})$，其中周期性势 $V(\\mathbf{r})$ 是所有以原子核位置为中心的单离子有效势之和。\n\n假设一个特殊极限情况 $f_{A}=f_{B}$ 且 $v_{A}(\\mathbf{r})=v_{B}(\\mathbf{r})$，其中 $v_{A}$ 和 $v_{B}$ 分别是 A 类和 B 类物种的有效单离子势。仅使用上述定义和布拉维晶格的标准性质，判断下列陈述中哪些是此极限的正确推论。\n\nA. 在此极限下，闪锌矿中由基元干涉产生的衍射选择定则变得与金刚石的相同：对于密勒指数 $(h,k,l)$ 全为偶数或全为奇数的 FCC 允许的反射，附加的基元干涉会使 $h+k+l\\equiv 2 \\ (\\mathrm{mod}\\ 4)$ 的反射消光，并保留 $h+k+l\\equiv 0 \\ (\\mathrm{mod}\\ 4)$ 的反射，而全奇数的反射保持允许。\n\nB. 即使 $v_{A}(\\mathbf{r})=v_{B}(\\mathbf{r})$，闪锌矿结构仍然是非中心对称的；反演对称性没有恢复，因此电子能带结构不能与金刚石的重合。\n\nC. 当 $v_{A}(\\mathbf{r})=v_{B}(\\mathbf{r})$ 时，周期性势 $V(\\mathbf{r})$ 与金刚石的周期性势重合，空间群变为金刚石的空间群（Fd-$3$m），并且单电子能带色散关系是相同的（不影响本征函数或色散关系的整体能量平移除外）。\n\nD. 在 $f_{A}=f_{B}$ 和 $v_{A}=v_{B}$ 的极限下，布拉维晶格有效地从面心立方变为简单立方，这就是晶体简化为金刚石的原因。\n\nE. 倒易晶格和布里渊区保持为面心立方布拉维晶格的对应形式；$f_{A}=f_{B}$ 的等式只改变了结构因子中依赖于基元的部分，而没有改变 FCC 晶格的选择定则。", "solution": "闪锌矿结构由一个带有双原子基元的 FCC 布拉维晶格组成。设 FCC 晶格点由向量 $\\mathbf{R}$ 表示。我们可以将基元原子置于相对于每个晶格点 $\\mathbf{R}$ 的位置：$A$ 类原子在 $\\mathbf{r}_A = (0,0,0)$，$B$ 类原子在 $\\mathbf{r}_B = \\mathbf{d} = (a/4)(1,1,1)$。\n\n### 晶体结构因子分析\n\n对于倒易晶格矢量 $\\mathbf{G}$，结构因子 $F(\\mathbf{G})$ 由晶格求和与基元求和的乘积给出。晶格求和项强制要求 $\\mathbf{G}$ 必须是倒易晶格的一个矢量，对于 FCC 正格子，这意味着 $\\mathbf{G} = (2\\pi/a)(h,k,l)$ 的密勒指数 $(h,k,l)$ 必须全为偶数或全为奇数。这就是 FCC 晶格的选择定则。基元求和项，或称几何结构因子 $S_{basis}(\\mathbf{G})$ 为：\n$$S_{basis}(\\mathbf{G}) = \\sum_{j} f_{j} e^{i \\mathbf{G}\\cdot \\mathbf{r}_{j}} = f_A e^{i \\mathbf{G}\\cdot \\mathbf{r}_A} + f_B e^{i \\mathbf{G}\\cdot \\mathbf{r}_B}$$\n代入基元位置 $\\mathbf{r}_A=\\mathbf{0}$ 和 $\\mathbf{r}_B=\\mathbf{d}$：\n$$S_{basis}(\\mathbf{G}) = f_A + f_B e^{i \\mathbf{G}\\cdot \\mathbf{d}}$$\n点积为 $\\mathbf{G}\\cdot\\mathbf{d} = \\frac{2\\pi}{a}(h,k,l) \\cdot \\frac{a}{4}(1,1,1) = \\frac{\\pi}{2}(h+k+l)$。因此：\n$$S_{basis}(\\mathbf{G}) = f_A + f_B e^{i \\frac{\\pi}{2}(h+k+l)}$$\n在指定的极限 $f_A = f_B = f$ 下，结构变为金刚石结构，基元因子变为：\n$$S_{basis}(\\mathbf{G}) = f \\left(1 + e^{i \\frac{\\pi}{2}(h+k+l)}\\right)$$\n我们针对 FCC 允许的反射分析此因子：\n1.  **$(h,k,l)$ 全为奇数：** 和 $h+k+l$ 为奇数。例如，对于 $(1,1,1)$，$h+k+l=3$，$S_{basis} = f(1+e^{i3\\pi/2}) = f(1-i) \\neq 0$。通常，当 $h+k+l$ 为奇数时，$S_{basis}$ 不为零。这些反射是允许的。\n2.  **$(h,k,l)$ 全为偶数：** 和 $h+k+l$ 为偶数。\n    -   如果 $h+k+l = 4n$（$n$ 为整数），那么 $e^{i\\frac{\\pi}{2}(4n)} = e^{i2n\\pi} = 1$。所以，$S_{basis} = f(1+1) = 2f \\neq 0$。这些反射是允许的。这对应于 $h+k+l \\equiv 0 \\pmod 4$。\n    -   如果 $h+k+l = 4n+2$，那么 $e^{i\\frac{\\pi}{2}(4n+2)} = e^{i(2n\\pi+\\pi)} = -1$。所以，$S_{basis} = f(1-1) = 0$。这些反射被消光。这对应于 $h+k+l \\equiv 2 \\pmod 4$。\n\n### 势和哈密顿量分析\n\n周期性势 $V(\\mathbf{r})$ 是所有以原子位置为中心的单离子势之和：\n$$V(\\mathbf{r}) = \\sum_{\\mathbf{R}} \\left[ v_A(\\mathbf{r} - (\\mathbf{R}+\\mathbf{r}_A)) + v_B(\\mathbf{r} - (\\mathbf{R}+\\mathbf{r}_B)) \\right]$$\n在极限 $v_A(\\mathbf{r}) = v_B(\\mathbf{r}) = v(\\mathbf{r})$ 下：\n$$V(\\mathbf{r}) = \\sum_{\\mathbf{R}} \\left[ v(\\mathbf{r} - \\mathbf{R}) + v(\\mathbf{r} - (\\mathbf{R}+\\mathbf{d})) \\right]$$\n这恰好是原子位于金刚石晶格位置上的晶体的势。因此，势 $V(\\mathbf{r})$ 变得与金刚石晶体的势相同。哈密顿量 $H=\\frac{\\mathbf{p}^{2}}{2m}+V(\\mathbf{r})$ 也因此变得与金刚石结构的哈密顿量相同。\n\n闪锌矿结构（空间群 F-43m）是非中心对称的。金刚石结构（空间群 Fd-3m）是中心对称的。当 $v_A = v_B$ 时，哈密顿量所描述的物理系统获得了金刚石结构的更高对称性，包括反演对称性。这意味着系统的有效空间群变为 Fd-3m。由于哈密顿量变得与金刚石的相同，其能带结构也必须与金刚石的相同。\n\n### 逐项分析选项\n\n**A. 在此极限下，闪锌矿中由基元干涉产生的衍射选择定则变得与金刚石的相同：对于密勒指数 $(h,k,l)$ 全为偶数或全为奇数的 FCC 允许的反射，附加的基元干涉会使 $h+k+l\\equiv 2 \\ (\\mathrm{mod}\\ 4)$ 的反射消光，并保留 $h+k+l\\equiv 0 \\ (\\mathrm{mod}\\ 4)$ 的反射，而全奇数的反射保持允许。**\n我们对极限 $f_A = f_B$ 下的结构因子的分析直接证实了这些选择定则。这些是已知的金刚石立方结构的选择定则。该陈述是此极限的正确推论。\n**结论：正确。**\n\n**B. 即使 $v_{A}(\\mathbf{r})=v_{B}(\\mathbf{r})$，闪锌矿结构仍然是非中心对称的；反演对称性没有恢复，因此电子能带结构不能与金刚石的重合。**\n该陈述不正确。虽然闪锌矿的*晶体结构*缺少反演中心，但使两个基元原子相同（$v_A = v_B$）导致晶体势 $V(\\mathbf{r})$ 在物理上与金刚石结构的势无法区分。金刚石结构的势*是*中心对称的。因此，哈密顿量 $H$ 获得了反演对称性。由于哈密顿量变得与金刚石的相同，其能带结构也必须与金刚石的相同。\n**结论：不正确。**\n\n**C. 当 $v_{A}(\\mathbf{r})=v_{B}(\\mathbf{r})$ 时，周期性势 $V(\\mathbf{r})$ 与金刚石的周期性势重合，空间群变为金刚石的空间群（Fd-$3$m），并且单电子能带色散关系是相同的（不影响本征函数或色散关系的整体能量平移除外）。**\n如上所述，极限 $v_A = v_B$ 使得势 $V(\\mathbf{r})$ 与金刚石的势完全相同。哈密顿量的对称性由势的对称性决定。因此，有效空间群变为金刚石的空间群 Fd-3m，它是中心对称的。相同的哈密顿量意味着相同的能量本征值 ($E_n(\\mathbf{k})$) 和本征函数 ($\\psi_{n,\\mathbf{k}}$)。该陈述完全正确。\n**结论：正确。**\n\n**D. 在 $f_{A}=f_{B}$ 和 $v_{A}=v_{B}$ 的极限下，布拉维晶格有效地从面心立方变为简单立方，这就是晶体简化为金刚石的原因。**\n这从根本上是错误的。布拉维晶格描述晶体的平移对称性。对于闪锌矿和金刚石，它都是 FCC。简单立方晶格有不同的平移矢量集和不同的原胞体积。极限 $f_A=f_B, v_A=v_B$ 不会改变底层的平移矢量晶格；它只是使基元中的原子变得相同。金刚石结构是一个带双原子基元的 FCC 布拉维晶格，而不是简单立方结构。\n**结论：不正确。**\n\n**E. 倒易晶格和布里渊区保持为面心立方布拉维晶格的对应形式；$f_{A}=f_{B}$ 的等式只改变了结构因子中依赖于基元的部分，而没有改变 FCC 晶格的选择定则。**\n倒易晶格和布里渊区的形状完全由布拉维晶格决定，而不是由基元决定。由于布拉维晶格保持为 FCC，倒易晶格（为 BCC）和布里渊区（截角八面体）不发生改变。等式 $f_A=f_B$ 影响的是几何结构因子 $S_{basis}(\\mathbf{G})$，它乘以晶格求和项。“FCC 晶格选择定则”（即 $(h,k,l)$ 必须全偶或全奇）源于晶格求和，因此不受影响。基元因子随后施加了*附加*条件（系统性消光），但它不改变晶格类型的基本规则。该陈述正确地区分了这两个部分。\n**结论：正确。**", "answer": "$$\\boxed{ACE}$$", "id": "2976223"}, {"introduction": "最后，让我们架起理论与实验之间的桥梁。本练习将挑战你应用晶体几何和衍射理论知识，构建一个计算模型来模拟面心立方（FCC）晶体的劳厄背反射实验 [@problem_id:2976233]。通过将理论公式转化为一个可运行的程序，你将具体地理解晶体学信息是如何被编码在衍射图样中的，并发展现代研究所需的宝贵计算技能。", "problem": "考虑一个面心立方（FCC）晶体，其取向使得晶向 $[001]$ 与入射的多色X射线束对齐。你需要在以下假设下模拟一个背反射劳厄图样，并设计一个程序来识别对称等效的衍射点和系统性消光。\n\n使用以下原理和定义作为基本依据：\n- 晶格常数为 $a$ 的立方晶格的倒易晶格具有基矢 $\\mathbf{b}_1 = \\frac{2\\pi}{a}\\hat{\\mathbf{x}}$、$\\mathbf{b}_2 = \\frac{2\\pi}{a}\\hat{\\mathbf{y}}$ 和 $\\mathbf{b}_3 = \\frac{2\\pi}{a}\\hat{\\mathbf{z}}$。对于密勒指数 $(h,k,l)$，倒易晶格矢量为 $\\mathbf{G} = h\\mathbf{b}_1 + k\\mathbf{b}_2 + l\\mathbf{b}_3$。\n- 在X射线弹性散射中，劳厄条件表述为 $\\mathbf{k}_{\\text{out}} = \\mathbf{k}_{\\text{in}} + \\mathbf{G}$，且 $|\\mathbf{k}_{\\text{out}}| = |\\mathbf{k}_{\\text{in}}| = \\frac{2\\pi}{\\lambda}$，其中 $\\lambda$ 是波长。当 $\\mathbf{k}_{\\text{in}} = k_0 \\hat{\\mathbf{z}}$ 时，施加 $|\\mathbf{k}_{\\text{out}}| = |\\mathbf{k}_{\\text{in}}|$ 条件可得出标量约束 $|\\mathbf{G}|^2 + 2 k_0 G_z = 0$，对其求解 $k_0$ 可得 $k_0 = -\\frac{|\\mathbf{G}|^2}{2 G_z}$。一个有物理意义的正值 $k_0$ 要求 $G_z < 0$（对于入射束沿 $+\\hat{\\mathbf{z}}$ 方向的背反射情况）。\n- 对于在基底位置 $(0,0,0)$、$(0,\\frac{1}{2},\\frac{1}{2})$、$(\\frac{1}{2},0,\\frac{1}{2})$、$(\\frac{1}{2},\\frac{1}{2},0)$ 具有相同原子的面心立方晶格，其结构因子为 $F(h,k,l) = f\\left[1 + e^{i\\pi(k+l)} + e^{i\\pi(h+l)} + e^{i\\pi(h+k)}\\right]$，其中 $f$ 是原子形状因子。这导出了选择定则：$F(h,k,l) \\neq 0$ 当且仅当 $h$、$k$ 和 $l$ 均为偶数或均为奇数（否则发生系统性消光）。\n- 在入射束一侧 $z = -D$（$D > 0$）处放置一个与入射束垂直的平面探测器，用以记录背反射。对于每个方向为 $\\hat{\\mathbf{u}} = \\frac{\\mathbf{k}_{\\text{out}}}{|\\mathbf{k}_{\\text{out}}|}$ 且满足 $\\hat{\\mathbf{u}}\\cdot\\hat{\\mathbf{z}} < 0$ 的衍射束，其与探测器平面的交点位于射线 $\\mathbf{r}(t) = t \\hat{\\mathbf{u}}$ 上参数 $t = -\\frac{D}{\\hat{\\mathbf{u}}_z}$ 处，从而得到屏上坐标 $(x,y) = (t \\hat{\\mathbf{u}}_x, t \\hat{\\mathbf{u}}_y)$。屏上半径为 $R = \\sqrt{x^2 + y^2}$。\n\n你的任务：\n1. 生成所有满足 $-N \\le h,k,l \\le N$ 的密勒指数 $(h,k,l)$，不包括 $(0,0,0)$ 且限制 $l < 0$ 以确保背反射候选点的 $G_z < 0$。对于每个候选点，计算 $\\mathbf{G}$、$k_0 = -\\frac{|\\mathbf{G}|^2}{2 G_z}$ 以及波长 $\\lambda = \\frac{2\\pi}{k_0}$。\n2. 应用FCC选择定则来识别系统性消光（即那些 $h$、$k$、$l$ 不全为偶数或不全为奇数的衍射点）。将这些衍射点从后续的几何考虑中舍弃。\n3. 通过只接受满足 $\\lambda_{\\min} \\le \\lambda \\le \\lambda_{\\max}$ 的衍射点来施加一个符合物理现实的连续谱辐射带；将该波段之外的衍射点视为未被记录而舍弃。\n4. 计算衍射方向 $\\hat{\\mathbf{u}} = \\frac{\\mathbf{k}_{\\text{in}} + \\mathbf{G}}{|\\mathbf{k}_{\\text{in}} + \\mathbf{G}|}$（其中 $\\mathbf{k}_{\\text{in}} = k_0 \\hat{\\mathbf{z}}$），并只接受满足 $\\hat{\\mathbf{u}}_z < 0$ 的背反射。对于每个被接受的衍射点，计算其屏上半径 $R$ 并以毫米（mm）为单位表示。\n5. 在围绕 $[001]$ 轴的四重旋转对称与平面内镜面对称（即围绕 $[001]$ 的 $4/mmm$ 点群）下，识别对称等效的衍射点。如果两个衍射点 $(h,k,l)$ 和 $(h',k',l')$ 满足 $l' = l$ 且 $(h',k')$ 可通过 $(h,k)$ 在 $x$-$y$ 平面内进行任意组合的90度旋转和符号翻转得到，则它们被视为等效。在实现时，使用规范键 $(l, \\min(|h|,|k|), \\max(|h|,|k|))$ 来对等效类进行分类。\n6. 对每个测试用例，生成以下输出：\n   - 一个整数：所考虑的满足 $l<0$ 的候选指数总数（不包括 $(0,0,0)$）。\n   - 一个整数：这些候选点中的系统性消光数量（即不满足FCC选择定则的数量）。\n   - 一个整数：经过所有物理条件（波长带和背反射方向）筛选后记录到的衍射点数量。\n   - 一个整数：基于上述规范键，在记录到的衍射点中包含的对称等效类的数量。\n   - 一个浮点数：记录到的衍射点的平均屏上半径（单位：毫米），四舍五入到六位小数。如果没有记录到衍射点，则返回 $0.0$。\n\n使用以下测试套件，其中所有长度参数均以米（m）为单位，波长也以米（m）为单位：\n- 测试用例1（理想情况）：$a = 4.05\\times 10^{-10}$, $D = 0.10$, $N = 4$, $\\lambda_{\\min} = 0.5\\times 10^{-10}$, $\\lambda_{\\max} = 2.0\\times 10^{-10}$。\n- 测试用例2（扩展覆盖范围）：$a = 3.52\\times 10^{-10}$, $D = 0.15$, $N = 5$, $\\lambda_{\\min} = 0.4\\times 10^{-10}$, $\\lambda_{\\max} = 2.5\\times 10^{-10}$。\n- 测试用例3（窄带边缘情况）：$a = 4.05\\times 10^{-10}$, $D = 0.10$, $N = 2$, $\\lambda_{\\min} = 1.5\\times 10^{-10}$, $\\lambda_{\\max} = 1.6\\times 10^{-10}$。\n\n你的程序应将所有测试用例的结果聚合到单行输出中，形式为一个由方括号括起来的、逗号分隔的列表。每个测试用例的结果必须是按上述顺序排列的列表，因此最终输出的格式必须为\n$[ [r_{1,1}, r_{1,2}, r_{1,3}, r_{1,4}, r_{1,5}], [r_{2,1}, r_{2,2}, r_{2,3}, r_{2,4}, r_{2,5}], [r_{3,1}, r_{3,2}, r_{3,3}, r_{3,4}, r_{3,5}] ]$,\n其中 $r_{j,i}$ 是按定义为整数或浮点数的值。每个内部列表的最后一项必须是以毫米为单位表示的平均半径，并四舍五入到六位小数。", "solution": "用户希望模拟面心立方（FCC）晶体的背反射劳厄X射线衍射图样并分析结果。该问题在科学上是合理的，阐述清晰，并且所有参数和步骤都已明确定义。我将逐步推导解决方案，这将构成最终程序的基础。\n\n### 1. 理论框架\n\n问题基于X射线衍射运动学，由劳厄条件和倒易晶格的几何形状描述。\n\n**倒易晶格与入射束：**\n晶体是面心立方（FCC）晶格，其倒易晶格是体心立方（BCC）晶格。然而，对于边长为 $a$ 的立方常规晶胞，使用基于简单立方基矢的倒易晶格矢量更为简单：\n_$\\mathbf{b}_1 = \\frac{2\\pi}{a}\\hat{\\mathbf{x}}$，$\\mathbf{b}_2 = \\frac{2\\pi}{a}\\hat{\\mathbf{y}}$，$\\mathbf{b}_3 = \\frac{2\\pi}{a}\\hat{\\mathbf{z}}$。_\n倒易晶格矢量 $\\mathbf{G}$ 由密勒指数 $(h,k,l)$ 给出：\n_$\\mathbf{G} = h\\mathbf{b}_1 + k\\mathbf{b}_2 + l\\mathbf{b}_3 = \\frac{2\\pi}{a}(h\\hat{\\mathbf{x}} + k\\hat{\\mathbf{y}} + l\\hat{\\mathbf{z}})$。_\n入射X射线束的波矢 $\\mathbf{k}_{\\text{in}}$ 与 $[001]$ 方向（$\\hat{\\mathbf{z}}$ 轴）对齐。其大小为 $k_0 = |\\mathbf{k}_{\\text{in}}| = \\frac{2\\pi}{\\lambda}$，其中 $\\lambda$ 是波长。\n_$\\mathbf{k}_{\\text{in}} = k_0\\hat{\\mathbf{z}}$。_\n\n**劳厄条件与波长选择：**\n弹性散射的条件是 $\\mathbf{k}_{\\text{out}} = \\mathbf{k}_{\\text{in}} + \\mathbf{G}$ 且 $|\\mathbf{k}_{\\text{out}}| = |\\mathbf{k}_{\\text{in}}|$。对第一个方程平方可得：\n_$$|\\mathbf{k}_{\\text{out}}|^2 = |\\mathbf{k}_{\\text{in}}|^2 + |\\mathbf{G}|^2 + 2\\mathbf{k}_{\\text{in}}\\cdot\\mathbf{G}$$_\n代入 $|\\mathbf{k}_{\\text{out}}| = |\\mathbf{k}_{\\text{in}}| = k_0$ 将其简化为厄瓦尔德球构图的基本方程：\n_$$|\\mathbf{G}|^2 + 2\\mathbf{k}_{\\text{in}}\\cdot\\mathbf{G} = 0$$_\n当 $\\mathbf{k}_{\\text{in}} = k_0\\hat{\\mathbf{z}}$ 且 $\\mathbf{G} = \\frac{2\\pi}{a}(h, k, l)$ 时，点积变为 $2\\mathbf{k}_{\\text{in}}\\cdot\\mathbf{G} = 2k_0 G_z = 2k_0 \\frac{2\\pi l}{a}$。模的平方为 $|\\mathbf{G}|^2 = (\\frac{2\\pi}{a})^2(h^2+k^2+l^2)$。代入这些可得：\n_$$(\\frac{2\\pi}{a})^2(h^2+k^2+l^2) + 2k_0 (\\frac{2\\pi l}{a}) = 0$$_\n求解 $k_0$ 得：\n_$$k_0 = -\\frac{(\\frac{2\\pi}{a})^2(h^2+k^2+l^2)}{2 (\\frac{2\\pi l}{a})} = -\\frac{\\pi}{a}\\frac{h^2+k^2+l^2}{l}$$_\n由于 $k_0$ 必须为正，且 $h^2+k^2+l^2 > 0$，因此必须有 $l < 0$。这证实了问题对候选衍射点的约束。对应的波长 $\\lambda = \\frac{2\\pi}{k_0}$ 为：\n_$$\\lambda = \\frac{2\\pi}{-\\frac{\\pi}{a}\\frac{h^2+k^2+l^2}{l}} = -2a \\frac{l}{h^2+k^2+l^2}$$_\n这个简单的公式将用于检查衍射是否由给定的波长带 $[\\lambda_{\\min}, \\lambda_{\\max}]$ 激发。\n\n**FCC选择定则：**\n对于基底位置在 $(0,0,0), (0,\\frac{1}{2},\\frac{1}{2}), (\\frac{1}{2},0,\\frac{1}{2}), (\\frac{1}{2},\\frac{1}{2},0)$ 的单原子FCC晶格，其结构因子 $F(h,k,l)$ 为：\n_$$F(h,k,l) = f\\left[1 + e^{i\\pi(k+l)} + e^{i\\pi(h+l)} + e^{i\\pi(h+k)}\\right]$$_\n其中 $f$ 是原子形状因子。仅当密勒指数 $h, k, l$ 全为偶数或全为奇数时，此和才不为零。具有混合奇偶性指数的衍射是“系统性消光”的。\n\n**背反射几何与探测器坐标：**\n在背反射装置中，衍射束必须向后传播才能被记录。衍射束的方向是 $\\hat{\\mathbf{u}} = \\frac{\\mathbf{k}_{\\text{out}}}{k_0}$。其 $z$ 分量必须为负，即 $\\hat{u}_z < 0$。\n_$$\\mathbf{k}_{\\text{out}} = \\mathbf{k}_{\\text{in}} + \\mathbf{G} = k_0\\hat{\\mathbf{z}} + \\frac{2\\pi}{a}(h\\hat{\\mathbf{x}} + k\\hat{\\mathbf{y}} + l\\hat{\\mathbf{z}})$$_\n_$$\\hat{\\mathbf{u}} = \\frac{\\mathbf{k}_{\\text{out}}}{k_0} = \\hat{\\mathbf{z}} + \\frac{2\\pi}{ak_0}(h\\hat{\\mathbf{x}} + k\\hat{\\mathbf{y}} + l\\hat{\\mathbf{z}})$$__\n代入 $k_0$ 的表达式：\n_$$\\hat{u}_z = 1 + \\frac{2\\pi l}{ak_0} = 1 + \\frac{2\\pi l}{a} \\left( -\\frac{a}{\\pi}\\frac{l}{h^2+k^2+l^2} \\right) = 1 - \\frac{2l^2}{h^2+k^2+l^2} = \\frac{h^2+k^2-l^2}{h^2+k^2+l^2}$$__\n因此，条件 $\\hat{u}_z < 0$ 简化为 $h^2+k^2-l^2 < 0$，或 $h^2+k^2 < l^2$。\n\n探测器是位于 $z=-D$ 的一个平面。沿 $\\hat{\\mathbf{u}}$ 方向从原点发出的衍射光线到达探测器的位置是 $(x,y,-D)$。位置矢量是 $t\\hat{\\mathbf{u}}$，所以 $t\\hat{u}_z = -D$，即 $t = -D/\\hat{u}_z$。光斑半径 $R$ 为：\n_$$R = \\sqrt{(t\\hat{u}_x)^2 + (t\\hat{u}_y)^2} = |t|\\sqrt{\\hat{u}_x^2 + \\hat{u}_y^2} = t\\sqrt{1-\\hat{u}_z^2} = -\\frac{D}{\\hat{u}_z}\\sqrt{1-\\hat{u}_z^2}$$__\n这等价于 $R = D\\tan\\theta$，其中 $\\theta$ 是与垂直于探测器的中心轴的偏离角。我们可以推导出以密勒指数表示的直接表达式：\n_$$R = D \\frac{2|l|\\sqrt{h^2+k^2}}{l^2 - (h^2+k^2)}$$_\n由于 $l<0$，这也可以写成：\n_$$R = D \\frac{-2l\\sqrt{h^2+k^2}}{l^2 - (h^2+k^2)}$$_\n\n**对称等效性：**\n问题基于 $[001]$ 轴的四重旋转对称和镜面对称（点群 $4/mmm$）来定义对称等效性。对于固定的 $l$，如果数对 $(|h'|,|k'|)$ 是 $(|h|,|k|)$ 的一个排列，则任意两个衍射 $(h,k,l)$ 和 $(h',k',l')$ 是等效的。表示每个等效类的规范键是 $(l, \\min(|h|,|k|), \\max(|h|,|k|))$。\n\n### 2. 算法设计\n\n解决方案将通过迭代候选的密勒指数并应用一系列过滤器来实现。\n\n1.  **生成候选点**：迭代所有整数 $h, k, l$，满足 $-N \\le h,k \\le N$ 且 $-N \\le l < 0$。对这些点计数以得到 `total_candidates`。\n2.  **过滤器1（系统性消光）**：对于每个 $(h,k,l)$，检查指数是否全为偶数或全为奇数。如果它们的奇偶性混合，则递增 `systematic_absences` 并舍弃。\n3.  **过滤器2（波长）**：计算 $\\lambda = -2a \\frac{l}{h^2+k^2+l^2}$。如果 $\\lambda$ 不在 $[\\lambda_{\\min}, \\lambda_{\\max}]$ 范围内，则舍弃该衍射点。\n4.  **过滤器3（背反射几何）**：检查是否满足 $h^2+k^2 < l^2$。如果不满足，衍射束不会向后传播，因此被舍弃。\n5.  **处理记录的衍射点**：如果一个衍射点 $(h,k,l)$ 通过了所有过滤器：\n    *   递增 `recorded_reflections`。\n    *   使用上面推导的公式计算其屏上半径 $R$。乘以1000将其转换为毫米。存储此值。\n    *   生成对称键 $(l, \\min(|h|,|k|), \\max(|h|,|k|))$ 并将其添加到一个集合中，以跟踪唯一的等效类。\n6.  **最终计算**：\n    *   `symmetry_classes` 的数量即为键集合的最终大小。\n    *   计算所有存储的半径的平均值。如果没有记录到衍射点，平均值为 $0.0$。\n    *   将平均半径四舍五入到六位小数。\n7.  **输出**：将为当前测试用例计算的五个值（`total_candidates`, `systematic_absences`, `recorded_reflections`, `symmetry_classes`, `mean_radius_mm`）组合成一个列表。对所有测试用例重复此过程，并按要求格式化最终输出。\n\n这种结构化方法确保了问题陈述中的所有条件都得到精确满足。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n\n    def _solve_case(a, D, N, lambda_min, lambda_max):\n        \"\"\"\n        Solves one test case for the Laue pattern simulation.\n\n        Args:\n            a (float): Lattice parameter in meters.\n            D (float): Sample-to-detector distance in meters.\n            N (int): Maximum absolute value for Miller indices h, k, l.\n            lambda_min (float): Minimum wavelength in the X-ray beam in meters.\n            lambda_max (float): Maximum wavelength in the X-ray beam in meters.\n        \n        Returns:\n            list: A list containing the five required output values for the test case.\n        \"\"\"\n        total_candidates = 0\n        systematic_absences = 0\n        recorded_reflections_count = 0\n        \n        recorded_radii_m = []\n        recorded_keys = set()\n\n        # Task 1: Generate all Miller indices (h, k, l) with -N <= h,k,l <= N,\n        # excluding (0,0,0) and restricted to l < 0.\n        for h in range(-N, N + 1):\n            for k in range(-N, N + 1):\n                for l in range(-N, 0):  # This ensures l < 0.\n                    \n                    # (0,0,0) is automatically excluded since l cannot be 0.\n                    total_candidates += 1\n\n                    # Task 2: Apply FCC selection rule.\n                    # Indices must be all even or all odd.\n                    # We check if the parities of |h|, |k|, |l| are the same.\n                    parities = {abs(h) % 2, abs(k) % 2, abs(l) % 2}\n                    if len(parities) > 1: # Mixed parities\n                        systematic_absences += 1\n                        continue\n                    \n                    # Task 1 (cont.): Compute wavelength for the reflection.\n                    hkl_sq_sum = h**2 + k**2 + l**2\n                    \n                    # This check is for safety, though hkl_sq_sum > 0 since l < 0.\n                    if hkl_sq_sum == 0:\n                        continue\n\n                    lambda_val = -2 * a * l / hkl_sq_sum\n                    \n                    # Task 3: Impose wavelength band filter.\n                    if not (lambda_min <= lambda_val <= lambda_max):\n                        continue\n\n                    # Task 4: Impose geometric back-reflection condition.\n                    # The condition for back-reflection is h^2 + k^2 < l^2.\n                    if not (h**2 + k**2 < l**2):\n                        continue\n\n                    # If we reach here, the reflection is recorded.\n                    recorded_reflections_count += 1\n\n                    # Task 4 (cont.): Compute the screen radius R.\n                    # Formula: R = D * (-2*l*sqrt(h^2+k^2)) / (l^2 - (h^2+k^2))\n                    # The sign works out because l < 0 and l^2 > h^2+k^2.\n                    radius_m = D * (-2 * l * np.sqrt(h**2 + k**2)) / (l**2 - (h**2 + k**2))\n                    recorded_radii_m.append(radius_m)\n\n                    # Task 5: Identify symmetry-equivalence class.\n                    # The key is (l, min(|h|,|k|), max(|h|,|k|)).\n                    key = (l, min(abs(h), abs(k)), max(abs(h), abs(k)))\n                    recorded_keys.add(key)\n\n        # Task 6: Produce final outputs for the test case.\n        num_symmetry_classes = len(recorded_keys)\n        \n        if recorded_reflections_count > 0:\n            # Calculate mean radius and convert from meters to millimeters.\n            mean_radius_mm = np.mean(recorded_radii_m) * 1000.0\n        else:\n            mean_radius_mm = 0.0\n\n        # Round the mean radius to six decimal places as required.\n        mean_radius_mm = round(mean_radius_mm, 6)\n\n        return [\n            total_candidates,\n            systematic_absences,\n            recorded_reflections_count,\n            num_symmetry_classes,\n            mean_radius_mm\n        ]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (a, D, N, lambda_min, lambda_max)\n        (4.05e-10, 0.10, 4, 0.5e-10, 2.0e-10),\n        (3.52e-10, 0.15, 5, 0.4e-10, 2.5e-10),\n        (4.05e-10, 0.10, 2, 1.5e-10, 1.6e-10),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = _solve_case(*case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # str() on a list creates a string like '[1, 2, 3]', then we join them.\n    print(f\"[{', '.join(map(str, results))}]\".replace(\" \", \"\"))\n\nsolve()\n```", "id": "2976233"}]}