{"hands_on_practices": [{"introduction": "第一个实践将深入探讨由关联驱动的金属-绝缘体相变的核心——莫特（Mott）相变。通过将哈伯德（Hubbard）模型与托马斯-费米（Thomas-Fermi）屏蔽理论相结合，你将推导出著名的莫特判据，它将临界电子密度 $n_c$ 与有效玻尔半径 $a_B$ 联系起来。这个练习可以让你从根本上理解促进离域的电子动能与导致局域的库仑排斥之间的竞争。[@problem_id:3005620]", "problem": "考虑一个接近关联驱动的金属-绝缘体相变的三维掺杂半导体，其低能行为可通过单带 Hubbard 哈密顿量来建模\n$$\nH \\;=\\; -\\,t \\sum_{\\langle i j \\rangle,\\,\\sigma} c_{i\\sigma}^{\\dagger} c_{j\\sigma} \\;+\\; U \\sum_{i} n_{i\\uparrow} n_{i\\downarrow},\n$$\n其中 $t$ 是最近邻跃迁振幅，$U$ 是在位库仑排斥。假设对于施主采用有效质量的类氢描述，其在介电常数为 $\\kappa$ 的主体电介质中的有效质量为 $m^{\\ast}$，因此有效玻尔半径为\n$$\na_{B} \\;=\\; \\frac{\\kappa \\hbar^{2}}{m^{\\ast} e^{2}}.\n$$\n在金属相中，对于密度为 $n$ 的三维顺磁电子气，其长波静态屏蔽可以在 Thomas–Fermi 理论框架内近似，其费米波矢为\n$$\nk_{F} \\;=\\; \\big( 3 \\pi^{2} n \\big)^{1/3},\n$$\n以及 Thomas–Fermi 屏蔽波矢\n$$\nk_{\\mathrm{TF}}^{2} \\;=\\; \\frac{4 k_{F}}{\\pi a_{B}}.\n$$\n在 Hubbard 的观点下，当屏蔽后的在位排斥与动能带宽相当时，会发生金属-绝缘体相变。在上述连续介质假设下，这可以重述为：一旦屏蔽长度与有效玻尔半径相当，施主束缚态便会消失。通过以下条件来对此阈值进行建模\n$$\nk_{\\mathrm{TF}} a_{B} \\;=\\; 1.\n$$\n仅从这些前提出发，消去 $k_{F}$ 和 $k_{\\mathrm{TF}}$，以得到以下形式的临界密度判据\n$$\nn_{c}^{1/3} a_{B} \\;=\\; C,\n$$\n并计算无量纲常数 $C$ 的精确闭式表达式。请将最终答案表示为一个不带单位的简化精确表达式。此外，请用文字说明为什么这个条件能够从动能、库仑排斥和屏蔽之间的竞争角度，抓住 Mott 金属-绝缘体相变的物理内涵。您的最终数值结果必须以精确表达式给出；不要进行四舍五入或近似。", "solution": "该问题要求基于一组给定的物理模型和假设，推导掺杂半导体中金属-绝缘体相变的临界密度判据。最终结果应为关系式 $n_{c}^{1/3} a_{B} = C$ 中无量纲常数 $C$ 的表达式。\n\n首先，需要对问题陈述进行验证。\n问题给出了以下已知条件：\n1. 单带 Hubbard 哈密顿量：$H = -t \\sum_{\\langle i j \\rangle,\\,\\sigma} c_{i\\sigma}^{\\dagger} c_{j\\sigma} + U \\sum_{i} n_{i\\uparrow} n_{i\\downarrow}$。\n2. 类氢施主的有效玻尔半径：$a_{B} = \\frac{\\kappa \\hbar^{2}}{m^{\\ast} e^{2}}$。\n3. 三维电子气的费米波矢：$k_{F} = ( 3 \\pi^{2} n )^{1/3}$。\n4. Thomas–Fermi 屏蔽波矢：$k_{\\mathrm{TF}}^{2} = \\frac{4 k_{F}}{\\pi a_{B}}$。\n5. 金属-绝缘体相变判据 (Mott 判据)：$k_{\\mathrm{TF}} a_{B} = 1$。\n\n该问题具有科学依据，因为它使用凝聚态物理中的标准模型（Hubbard 模型、有效质量近似、Thomas-Fermi 屏蔽）来描述一个众所周知的现象（Mott 相变）。所给出的方程是这些模型在三维空间中的标准结果。该问题提法明确，提供了清晰的目标和通过代数运算达成目标所需的所有信息。术语精确且客观。因此，该问题被认为是有效的，可以构建解答。\n\n目标是推导关系式 $n_{c}^{1/3} a_{B} = C$ 中的常数 $C$ 的表达式，其中 $n_c$ 是相变时的临界电子密度。推导过程通过组合所给的方程来进行。\n\n相变由前提 (5) 给出的条件定义，该条件在临界密度 $n = n_c$ 时成立：\n$$\nk_{\\mathrm{TF}} a_{B} = 1\n$$\n根据此条件，我们可以将相变点处的 Thomas–Fermi 波矢表示为：\n$$\nk_{\\mathrm{TF}} = \\frac{1}{a_{B}}\n$$\n接下来，我们将此结果代入前提 (4) 中给出的 Thomas–Fermi 波矢的表达式：\n$$\nk_{\\mathrm{TF}}^{2} = \\left(\\frac{1}{a_{B}}\\right)^{2} = \\frac{4 k_{F}}{\\pi a_{B}}\n$$\n该方程将临界密度下的费米波矢 $k_{F}$ 与有效玻尔半径 $a_{B}$ 联系起来。我们可以将其简化以求解 $k_{F}$：\n$$\n\\frac{1}{a_{B}^{2}} = \\frac{4 k_{F}}{\\pi a_{B}}\n$$\n两边同乘以 $\\pi a_{B}^{2}$ 可得：\n$$\n\\pi = 4 k_{F} a_{B}\n$$\n求解 $k_{F}$：\n$$\nk_{F} = \\frac{\\pi}{4 a_{B}}\n$$\n此表达式给出了临界密度 $n_c$ 处的费米波矢的值。现在，我们使用前提 (3) 给出的费米波矢与电子密度 $n$ 之间的一般关系。在临界密度 $n_c$ 处，该关系为：\n$$\nk_{F} = (3 \\pi^{2} n_{c})^{1/3}\n$$\n我们将相变时 $k_{F}$ 的两个表达式相等：\n$$\n(3 \\pi^{2} n_{c})^{1/3} = \\frac{\\pi}{4 a_{B}}\n$$\n问题要求结果的形式为 $n_{c}^{1/3} a_{B} = C$。我们可以重新整理方程以匹配此形式。首先，分离出 $n_{c}^{1/3}$ 项：\n$$\nn_{c}^{1/3} (3 \\pi^{2})^{1/3} = \\frac{\\pi}{4 a_{B}}\n$$\n现在，两边同乘以 $a_{B}$ 并除以 $(3 \\pi^{2})^{1/3}$：\n$$\nn_{c}^{1/3} a_{B} = \\frac{\\pi}{4 (3 \\pi^{2})^{1/3}}\n$$\n该方程已是所需形式，常数 $C$ 由右侧给出。我们可以简化 $C$ 的表达式：\n$$\nC = \\frac{\\pi}{4 (3)^{1/3} (\\pi^{2})^{1/3}} = \\frac{\\pi}{4 \\cdot 3^{1/3} \\cdot \\pi^{2/3}}\n$$\n使用指数性质 $x^{a}/x^{b} = x^{a-b}$：\n$$\nC = \\frac{\\pi^{1 - 2/3}}{4 \\cdot 3^{1/3}} = \\frac{\\pi^{1/3}}{4 \\cdot 3^{1/3}}\n$$\n这可以写成更紧凑的形式：\n$$\nC = \\frac{1}{4} \\left(\\frac{\\pi}{3}\\right)^{1/3}\n$$\n这就是无量纲常数 $C$ 的精确闭式表达式。\n\n问题的第二部分要求说明为什么这个条件能够抓住 Mott 相变的物理内涵。Mott 相变从根本上是电子动能与电子间库仑排斥之间竞争的结果。动能有利于电子的离域化和金属性行为，而库仑排斥则有利于电子的局域化和绝缘性行为。\n\n1.  **竞争框架**：在 Hubbard 模型中，这种竞争由在位库仑排斥 $U$ 与跃迁振幅 $t$ 的比值表示。大的 $U/t$ 比值会导致绝缘态，因为将两个电子置于同一格点所需的能量代价 $U$ 阻止了它们自由移动。小的 $U/t$ 比值则会导致金属态，此时由跃迁（与 $t$ 成正比）带来的动能增益占主导地位。\n\n2.  **掺杂半导体背景**：在低施主浓度 $n$ 的掺杂半导体中，电子是局域化的，束缚在单个施主离子上。此时为绝缘态。这种束缚态的空间范围是有效玻尔半径 $a_{B}$，它代表了由单个施主离子的吸引库仑势引起的局域化长度尺度。随着施主浓度 $n$ 的增加，会发生两件事：(a) 施主之间的平均距离减小，增加了波函数的交叠，从而增加了有效跃迁 $t$；(b) 可移动电子的数量增加，导致库仑势的屏蔽。\n\n3.  **屏蔽的作用**：自由电子形成电子气，屏蔽了施主离子的库仑势。裸库仑势 $V(r) \\propto 1/r$ 被修正为短程的 Yukawa-like 势，$V_{screened}(r) \\propto (1/r)\\exp(-k_{\\mathrm{TF}} r)$。长度尺度 $1/k_{\\mathrm{TF}}$ 是屏蔽长度，它表征了电荷的静电影响被抑制的距离。\n\n4.  **Mott 判据 ($k_{\\mathrm{TF}} a_{B} = 1$)**：该条件指出，当屏蔽长度等于有效玻尔半径，即 $\\lambda_{\\mathrm{TF}} = 1/k_{\\mathrm{TF}} = a_B$ 时，发生相变。这抓住了物理上的转折点：\n    - 当 $\\lambda_{\\mathrm{TF}} > a_B$（低密度）时，屏蔽很弱。来自施主离子的库仑势延伸得足够远，足以形成一个尺寸约为 $a_B$ 的稳定、局域化的束缚态。系统是绝缘的。\n    - 当 $\\lambda_{\\mathrm{TF}} \\le a_B$（高密度）时，屏蔽非常强，以至于势在小于束缚态所需尺寸的距离内被有效“截断”。稳定的束缚态无法再形成。电子不再束缚于单个施主，而是在整个晶体中离域，形成金属态。\n\n本质上，$k_{\\mathrm{TF}} a_{B} = 1$ 判据模拟了这样一个点：集体屏蔽效应（多体系统动能的一种体现）压倒了单个杂质位点上的局域化库仑势。这有效地破坏了束缚态，导致电子离域并向金属相转变，从而抓住了该系统中 Mott 相变的核心物理。推导出的关系式 $n_{c}^{1/3} a_{B} = C$ 将宏观密度 $n_c$ 与微观长度尺度 $a_B$ 联系起来，基于这一物理图像为临界点提供了定量预测。", "answer": "$$\n\\boxed{\\frac{1}{4} \\left(\\frac{\\pi}{3}\\right)^{1/3}}\n$$", "id": "3005620"}, {"introduction": "现在，我们将焦点从关联转向无序，后者是安德森（Anderson）局域化背后的驱动力。本练习将介绍强大的局域化自洽理论，让你能够超越简单的标度论证。通过求解扩散系数的自洽方程，您将能够确定安德森相变的普适性质，例如临界无序强度 $\\gamma_c$ 和关联长度指数 $\\nu$。[@problem_id:3005634]", "problem": "考虑一个在安德森局域化自洽理论（通常称为 Vollhardt–Wölfle 方法）框架下描述的三维无序导体。令 $D(\\omega)$ 表示频率依赖的扩散常数，$D_{0}$ 表示玻尔兹曼（德鲁德）扩散常数。令 $N_{0}$ 为单位体积内费米能级上的单粒子态密度（DOS）（包括自旋）。在此框架中，一个标准的出发点是以下自洽方程\n$$\n\\frac{D_{0}}{D(\\omega)} \\;=\\; 1 \\;+\\; \\frac{1}{\\pi N_{0}} \\int_{|\\mathbf{q}|<q_{\\max}} \\frac{d^{3}q}{(2\\pi)^{3}} \\,\\frac{1}{-\\,i\\omega \\;+\\; D(\\omega)\\, q^{2}} \\,,\n$$\n其中动量积分在紫外区被截断于 $q_{\\max} = 1/\\ell$，$\\ell$ 是弹性平均自由程。通过 $\\kappa^{2}(\\omega) \\equiv -\\,i\\omega/D(\\omega)$ 定义红外标度 $\\kappa(\\omega)$，并在相变的两侧取适当的零频极限。严格在 $d=3$ 维下进行计算，显式地计算动量积分，然后引入无量纲变量 $d \\equiv D(\\omega)/D_{0}$，$x \\equiv \\kappa(\\omega)\\,\\ell$，以及无量纲无序强度\n$$\n\\gamma \\;\\equiv\\; \\frac{1}{2\\pi^{3}\\,N_{0}\\,D_{0}\\,\\ell} \\,.\n$$\n通过分析金属相一侧和绝缘相一侧在临界点附近的 $\\omega \\to 0$ 极限，确定：\n- 发生相变时的临界值 $\\gamma_{c}$，以及\n- 由 $\\xi \\sim |\\gamma - \\gamma_{c}|^{-\\nu}$ 定义的相关长度指数 $\\nu$，其中 $\\xi$ 是绝缘相一侧的零频相关长度，$\\xi \\equiv \\kappa^{-1}(\\omega\\to 0)$。\n\n将你的最终答案表示为一个二元行矩阵 $(\\gamma_{c}, \\nu)$。不需要进行数值计算或四舍五入。所有中间步骤都必须从上述自洽方程出发，使用给定的截断和定义，从第一性原理推导得出，并且你使用的任何展开都必须有渐近意义上的合理解释。你的最终答案必须是单一的闭式解析表达式。最终答案中不要包含单位；$\\gamma_{c}$ 和 $\\nu$ 都是无量纲的。", "solution": "在尝试解答之前，首先对问题进行验证，以确保其科学上可靠、内容自洽且提法恰当。\n\n### 步骤 1：提取给定条件\n-   **系统**：三维（$d=3$）无序导体。\n-   **理论框架**：安德森局域化的自洽理论（Vollhardt–Wölfle 方法）。\n-   **自洽方程**：\n    $$\n    \\frac{D_{0}}{D(\\omega)} \\;=\\; 1 \\;+\\; \\frac{1}{\\pi N_{0}} \\int_{|\\mathbf{q}|<q_{\\max}} \\frac{d^{3}q}{(2\\pi)^{3}} \\,\\frac{1}{-\\,i\\omega \\;+\\; D(\\omega)\\, q^{2}}\n    $$\n-   **定义和常数**：\n    -   $D(\\omega)$: 频率依赖的扩散常数。\n    -   $D_{0}$: 玻尔兹曼（德鲁德）扩散常数。\n    -   $N_{0}$: 单位体积内费米能级上的单粒子态密度。\n    -   $q_{\\max} = 1/\\ell$: 紫外动量截断，其中 $\\ell$ 是弹性平均自由程。\n    -   $\\kappa^{2}(\\omega) \\equiv -\\,i\\omega/D(\\omega)$: 红外标度定义。\n    -   $d \\equiv D(\\omega)/D_{0}$: 无量纲扩散常数。\n    -   $x \\equiv \\kappa(\\omega)\\,\\ell$: 无量纲红外标度。\n    -   $\\gamma \\;\\equiv\\; \\frac{1}{2\\pi^{3}\\,N_{0}\\,D_{0}\\,\\ell}$: 无量纲无序强度。\n-   **任务**：\n    1.  确定金属-绝缘体相变的临界值 $\\gamma_{c}$。\n    2.  根据关系式 $\\xi \\sim |\\gamma - \\gamma_{c}|^{-\\nu}$ 确定相关长度指数 $\\nu$，其中 $\\xi \\equiv \\kappa^{-1}(\\omega\\to 0)$ 是绝缘相一侧的相关长度。\n\n### 步骤 2：使用提取的给定条件进行验证\n该问题是理论凝聚态物理，特别是安德森局域化研究领域的一个标准练习题。\n-   **科学基础**：该问题基于已广为接受的 Vollhardt–Wölfle 局域化自洽理论，这是该领域的基石之一。所有方程和定义都是该理论的标准内容。问题不含伪科学或有科学争议的主张。\n-   **提法恰当性**：问题陈述清晰，并提供了推导所求量 $\\gamma_c$ 和 $\\nu$ 所需的全部信息（基本方程、所有定义和截断）。任务是在此特定理论模型内推导已知的、唯一的结果。\n-   **客观性**：语言精确、专业，没有任何主观或含糊的术语。\n-   **完整性与一致性**：问题是自洽的。所提供的定义与方程的结构一致。\n\n### 步骤 3：结论与行动\n问题被判定为**有效**。这是一个既定理论物理领域中提法恰当的标准问题。现在开始推导解答。\n\n### 解答推导\n\n出发点是关于扩散常数 $D(\\omega)$ 的自洽方程：\n$$\n\\frac{D_{0}}{D(\\omega)} = 1 + \\frac{1}{\\pi N_{0}} \\int_{|\\mathbf{q}|<q_{\\max}} \\frac{d^{3}q}{(2\\pi)^{3}} \\frac{1}{D(\\omega)\\, q^{2} - i\\omega}\n$$\n该积分是在动量空间中一个半径为 $q_{\\max}$ 的球上进行的。我们可以通过切换到球坐标来计算它。由于被积函数是各向同性的，角向积分给出一个 $4\\pi$ 因子。\n$$\n\\int_{|\\mathbf{q}|<q_{\\max}} \\frac{d^{3}q}{(2\\pi)^{3}} \\frac{1}{D(\\omega) q^{2} - i\\omega} = \\frac{4\\pi}{(2\\pi)^{3}} \\int_{0}^{q_{\\max}} \\frac{q^{2} dq}{D(\\omega) q^{2} - i\\omega} = \\frac{1}{2\\pi^{2}D(\\omega)} \\int_{0}^{q_{\\max}} \\frac{q^{2} dq}{q^{2} - i\\omega/D(\\omega)}\n$$\n使用定义 $\\kappa^2(\\omega) \\equiv -i\\omega/D(\\omega)$，积分变为：\n$$\n\\frac{1}{2\\pi^{2}D(\\omega)} \\int_{0}^{q_{\\max}} \\frac{q^{2} dq}{q^{2} + \\kappa^{2}(\\omega)}\n$$\n这个有理函数的积分可以通过重写分子来求解：\n$$\n\\int_{0}^{q_{\\max}} \\frac{q^{2}}{q^{2} + \\kappa^{2}} dq = \\int_{0}^{q_{\\max}} \\frac{(q^{2} + \\kappa^{2}) - \\kappa^{2}}{q^{2} + \\kappa^{2}} dq = \\int_{0}^{q_{\\max}} \\left(1 - \\frac{\\kappa^{2}}{q^{2} + \\kappa^{2}}\\right) dq\n$$\n$$\n= \\left[q - \\kappa \\arctan\\left(\\frac{q}{\\kappa}\\right)\\right]_{0}^{q_{\\max}} = q_{\\max} - \\kappa(\\omega) \\arctan\\left(\\frac{q_{\\max}}{\\kappa(\\omega)}\\right)\n$$\n将此结果代回自洽方程：\n$$\n\\frac{D_{0}}{D(\\omega)} = 1 + \\frac{1}{\\pi N_{0}} \\frac{1}{2\\pi^{2}D(\\omega)} \\left[q_{\\max} - \\kappa(\\omega) \\arctan\\left(\\frac{q_{\\max}}{\\kappa(\\omega)}\\right)\\right]\n$$\n$$\n\\frac{D_{0}}{D(\\omega)} = 1 + \\frac{1}{2\\pi^{3} N_{0} D(\\omega)} \\left[q_{\\max} - \\kappa(\\omega) \\arctan\\left(\\frac{q_{\\max}}{\\kappa(\\omega)}\\right)\\right]\n$$\n现在，我们引入无量纲变量。将方程两边乘以 $D(\\omega)$：\n$$\nD_{0} = D(\\omega) + \\frac{1}{2\\pi^{3} N_{0}} \\left[q_{\\max} - \\kappa(\\omega) \\arctan\\left(\\frac{q_{\\max}}{\\kappa(\\omega)}\\right)\\right]\n$$\n再除以 $D_{0}$：\n$$\n1 = \\frac{D(\\omega)}{D_{0}} + \\frac{1}{2\\pi^{3} N_{0} D_{0}} \\left[q_{\\max} - \\kappa(\\omega) \\arctan\\left(\\frac{q_{\\max}}{\\kappa(\\omega)}\\right)\\right]\n$$\n使用 $q_{\\max} = 1/\\ell$ 以及 $\\gamma = \\frac{1}{2\\pi^{3} N_{0} D_{0} \\ell}$ 的定义：\n$$\n1 = \\frac{D(\\omega)}{D_{0}} + \\frac{1}{2\\pi^{3} N_{0} D_{0} \\ell} \\cdot \\ell \\left[\\frac{1}{\\ell} - \\kappa(\\omega) \\arctan\\left(\\frac{1/\\ell}{\\kappa(\\omega)}\\right)\\right]\n$$\n$$\n1 = \\frac{D(\\omega)}{D_{0}} + \\gamma \\left[1 - \\kappa(\\omega)\\ell \\arctan\\left(\\frac{1}{\\kappa(\\omega)\\ell}\\right)\\right]\n$$\n最后，使用 $d = D(\\omega)/D_{0}$ 和 $x = \\kappa(\\omega)\\ell$，我们得到无量纲的自洽方程：\n$$\n1 = d + \\gamma \\left[1 - x \\arctan\\left(\\frac{1}{x}\\right)\\right]\n$$\n这个方程支配着系统的行为。我们在两种机制下分析它，以求出 $\\gamma_c$ 和 $\\nu$。\n\n**1. 金属相一侧与临界无序 $\\gamma_c$**\n\n在金属相一侧，直流电导率是有限的，这意味着直流扩散常数 $D$ 是有限正值。我们考虑 $\\omega \\to 0$ 的极限。在此极限下，$D(\\omega) \\to D > 0$。\n无量纲变量变为：\n$d = D(\\omega)/D_{0} \\to D/D_{0}$。\n$x = \\kappa(\\omega)\\ell = \\ell \\sqrt{-i\\omega/D(\\omega)} \\to 0$。\n我们需要项 $x \\arctan(1/x)$ 在 $x \\to 0$ 时的行为。利用恒等式 $\\arctan(1/x) = \\pi/2 - \\arctan(x)$（对于 $x > 0$）以及 $\\arctan(x) = x - x^3/3 + \\dots$ 的泰勒展开（对于小 $x$），我们有 $\\arctan(1/x) \\approx \\pi/2 - x$。\n因此，$\\lim_{x\\to 0} [x \\arctan(1/x)] = \\lim_{x\\to 0} [x(\\pi/2 - x)] = 0$。\n取无量纲方程的 $\\omega \\to 0$ 极限：\n$$\n1 = \\lim_{\\omega\\to 0} d + \\gamma \\left[1 - \\lim_{\\omega\\to 0} \\left(x \\arctan\\left(\\frac{1}{x}\\right)\\right) \\right]\n$$\n$$\n1 = \\frac{D}{D_{0}} + \\gamma (1-0) = \\frac{D}{D_{0}} + \\gamma\n$$\n这给出了重整化的直流扩散常数 $D$ 为：\n$$\n\\frac{D}{D_{0}} = 1 - \\gamma\n$$\n只要 $D > 0$，系统就处于金属相，这要求 $1 - \\gamma > 0$，即 $\\gamma < 1$。金属-绝缘体相变发生在扩散常数消失时，即 $D \\to 0$。这发生在 $\\gamma$ 从下方趋近于临界值 $\\gamma_c$ 时。从该表达式可知，当 $\\gamma \\to 1$ 时，$D \\to 0$。\n因此，无序参数的临界值为 $\\gamma_c = 1$。\n\n**2. 绝缘相一侧与相关长度指数 $\\nu$**\n\n在绝缘相一侧（$\\gamma > \\gamma_c$），直流电导率为零，意味着当 $\\omega \\to 0$ 时 $D(\\omega) \\to 0$。在这种机制下，局域化长度 $\\xi$ 是有限的。当 $\\omega \\to 0$ 时，量 $\\kappa(\\omega)$ 预计会趋于一个有限的、实的、非零的值 $\\kappa_0 = 1/\\xi$。\n在绝缘相一侧的 $\\omega \\to 0$ 极限下，我们有 $d = D(\\omega)/D_0 \\to 0$ 和 $x = \\kappa(\\omega)\\ell \\to \\kappa_0\\ell \\equiv x_0$。无量纲方程变为：\n$$\n1 = 0 + \\gamma \\left[1 - x_0 \\arctan\\left(\\frac{1}{x_0}\\right)\\right]\n$$\n$$\n\\frac{1}{\\gamma} = 1 - x_0 \\arctan\\left(\\frac{1}{x_0}\\right)\n$$\n这个方程对于给定的无序强度 $\\gamma > \\gamma_c$ 决定了 $x_0 = \\ell/\\xi$ 的值。\n为了求出指数 $\\nu$，我们分析临界点附近的行为，即当 $\\gamma \\to \\gamma_c^+ = 1^+$ 时。在相变点，局域化长度发散（$\\xi \\to \\infty$），这意味着 $\\kappa_0 \\to 0$，因此 $x_0 \\to 0$。\n设 $\\gamma = \\gamma_c + \\delta\\gamma = 1 + \\delta\\gamma$，其中 $\\delta\\gamma > 0$ 是一个小数。\n方程左边是 $1/\\gamma = 1/(1+\\delta\\gamma) \\approx 1 - \\delta\\gamma$（对于小 $\\delta\\gamma$）。\n对于右边，我们对小 $x_0$ 进行展开：\n$$\n\\arctan\\left(\\frac{1}{x_0}\\right) = \\frac{\\pi}{2} - \\arctan(x_0) = \\frac{\\pi}{2} - x_0 + O(x_0^3)\n$$\n所以，$x_0 \\arctan(1/x_0) \\approx x_0(\\pi/2 - x_0) = (\\pi/2)x_0 - x_0^2$。\n方程变为：\n$$\n1 - \\delta\\gamma \\approx 1 - \\left(\\frac{\\pi}{2}x_0 - x_0^2\\right)\n$$\n$$\n\\delta\\gamma \\approx \\frac{\\pi}{2}x_0 - x_0^2\n$$\n对于 $x_0 \\to 0$，线性项是主导项。因此，在主导阶上：\n$$\n\\delta\\gamma \\approx \\frac{\\pi}{2} x_0 \\quad \\implies \\quad x_0 \\approx \\frac{2}{\\pi}\\delta\\gamma = \\frac{2}{\\pi}(\\gamma - \\gamma_c)\n$$\n局域化长度为 $\\xi = \\ell/x_0$。代入 $x_0$ 的表达式：\n$$\n\\xi \\approx \\frac{\\ell}{(2/\\pi)(\\gamma - \\gamma_c)} = \\frac{\\pi\\ell}{2} (\\gamma - \\gamma_c)^{-1}\n$$\n问题通过标度关系 $\\xi \\sim |\\gamma - \\gamma_c|^{-\\nu}$ 来定义相关长度指数 $\\nu$。将我们的结果与此定义进行比较，我们确定指数为 $\\nu=1$。\n\n所求的两个量是 $\\gamma_c = 1$ 和 $\\nu = 1$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 1\n\\end{pmatrix}\n}\n$$", "id": "3005634"}, {"introduction": "作为对解析理论的补充，数值模拟为研究无序系统提供了不可或缺的工具。在本实践中，你将实现一个算法来计算一维无序链的李雅普诺夫（Lyapunov）指数 $\\gamma$，该指数与局域化长度 $\\xi$ 直接相关（$\\xi=1/\\gamma$）。这个动手编程练习不仅使局域化长度这一抽象概念变得具体可触，还能让你通过数值方法验证大系统中至关重要的自平均（self-averaging）性质。[@problem_id:3005640]", "problem": "要求您编写一个完整、可运行的程序，用于估计一维无序紧束缚链的有限尺寸李雅普诺夫指数的经验分布，并用此分布评估与局域化长度估计相关的自平均性。目标是基于第一性原理设计一个数值稳定的最大李雅普诺夫指数估计器，该估计器基于转移矩阵，并量化其分布如何随着系统尺寸的增加而变窄。\n\n您的推导和算法必须基于以下基本出发点：\n\n- 一维紧束缚薛定谔方程，包含在位无序，\n  $$\\psi_{i+1} + \\psi_{i-1} + \\varepsilon_i \\psi_i = E \\psi_i,$$\n  其中 $E$ 是以最近邻跃迁振幅为单位的能量（因此跃迁振幅设为 $1$），而 $\\varepsilon_i$ 是独立同分布的在位势，从宽度为 $W$ 的均匀分布 $\\left[-\\tfrac{W}{2}, \\tfrac{W}{2}\\right]$ 中抽取。\n- 相关的 $2 \\times 2$ 转移矩阵形式，它将一个双分量状态在格点间演化，\n  $$\\begin{pmatrix}\\psi_{i+1}\\\\ \\psi_i\\end{pmatrix} = \\begin{pmatrix} E - \\varepsilon_i & -1 \\\\ 1 & 0 \\end{pmatrix} \\begin{pmatrix}\\psi_i\\\\ \\psi_{i-1}\\end{pmatrix}.$$\n- 随机矩阵乘积的最大李雅普诺夫指数 $\\gamma$，它根据Oseledec的乘法遍历定理，通过矩阵乘积在长链极限下的行为来量化典型解的指数增长率。对于一维安德森问题，最大李雅普诺夫指数的倒数等于局域化长度，即 $\\xi = 1/\\gamma$。\n\n您的程序必须为一组无序实现（系综）实现一个数值稳定的有限长度最大李雅普诺夫指数估计器，并生成该系综上的经验分布。该估计器应通过迭代乘以转移矩阵并在每个格点进行归一化以避免溢出，并累加每步范数增长因子的对数来获得。具体来说，如果在格点 $i$ 处双分量状态向量被归一化为单位欧几里得范数，那么在乘以该格点的转移矩阵后，范数会增加一个因子 $n_i$；对于单个实现的有限长度李雅普诺夫指数则为\n$$\\gamma_L = \\frac{1}{L} \\sum_{i=1}^{L} \\ln n_i.$$\n从 $N$ 个独立实现的系综中，您必须计算样本均值 $\\mu_L = \\frac{1}{N} \\sum_{j=1}^{N} \\gamma_L^{(j)}$ 和无偏样本方差 $s_L^2 = \\frac{1}{N-1} \\sum_{j=1}^{N} \\left(\\gamma_L^{(j)} - \\mu_L\\right)^2$。使用 $\\hat{\\xi}_{\\mathrm{typ}} = 1/\\mu_L$ 作为典型局域化长度估计器。通过检查 $s_L^2$ 如何随 $L$ 缩放来解释自平均性；对于独立的无序 $\\varepsilon_i$，$\\ln n_i$ 的总和预期满足中心极限定理，因此对于大的 $L$，$s_L^2 \\propto 1/L$。\n\n实现要求和约束：\n\n- 所有能量都是无量纲的，以跃迁振幅为单位。所有长度都以晶格格点数计。没有需要转换的物理单位。\n- 在每一步使用数值稳定的归一化。在每个实现中，将双分量状态初始化为一个单位范数向量，例如 $\\left(\\psi_1,\\psi_0\\right) = (1,0)$，并在每个格点计算新的向量对，计算其欧几里得范数，累加范数的对数，并在下一步之前将该向量对重新归一化为单位范数。\n- 为高效地获得经验分布，请尽可能使用向量化数组操作并行演化所有实现。\n- 对于下面的每个测试用例，报告样本均值 $\\mu_L$、无偏样本方差 $s_L^2$ 和局域化长度估计器 $\\hat{\\xi}_{\\mathrm{typ}} = 1/\\mu_L$。\n\n自平均性检查：\n\n- 为量化自平均性，比较两个具有相同无序强度 $W$ 和能量 $E$ 但长度 $L$ 不同的案例。计算比率\n  $$R = \\frac{s_{L_1}^2 \\, L_1}{s_{L_2}^2 \\, L_2}.$$\n  在自平均区域，$R$ 应接近于 $1$。您的程序还必须输出一个布尔值，如果 $\\lvert R - 1 \\rvert &lt; 0.5$ 则为真，否则为假。\n\n测试套件：\n\n- 案例1（基准，中等无序）：$L = 2000$, $W = 2.0$, $E = 0.0$, $N = 1000$, 随机种子 $= 12345$。\n- 案例2（能带中心，弱无序）：$L = 2000$, $W = 0.5$, $E = 0.0$, $N = 1000$, 随机种子 $= 23456$。\n- 案例3（短链，与案例1参数相同，用于探测自平均性）：$L = 400$, $W = 2.0$, $E = 0.0$, $N = 1000$, 随机种子 $= 34567$。\n- 案例4（弱无序下靠近能带边缘）：$L = 2000$, $W = 0.5$, $E = 1.8$, $N = 1000$, 随机种子 $= 45678$。\n\n最终输出规范：\n\n- 对于每个案例 $i \\in \\{1,2,3,4\\}$，按此顺序生成一个包含三个浮点数的列表 $[\\mu_i, s_i^2, \\hat{\\xi}_i]$，其中 $\\mu_i$ 是 $\\gamma_L$ 的样本均值， $s_i^2$ 是 $\\gamma_L$ 的无偏样本方差，$\\hat{\\xi}_i = 1/\\mu_i$。\n- 同时，为案例1和3生成自平均比率和布尔值，形式为列表 $[R_{1,3}, \\mathrm{SA\\_ok}_{1,3}]$，其中 $R_{1,3}$ 是一个浮点数，$\\mathrm{SA\\_ok}_{1,3}$ 是一个如上定义的布尔值。\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个案例和自平均性检查都使用嵌套列表。所有浮点数使用六位小数。例如，打印的输出必须具有以下确切形式：\n  [[mu1,var1,xi1],[mu2,var2,xi2],[mu3,var3,xi3],[mu4,var4,xi4],[R13,True]]\n用计算出的数字替换占位符，并酌情打印 True 或 False；不要打印任何其他文本。", "solution": "用户要求阐述并实现一个数值算法，用于估计一维无序紧束缚链的最大李雅普诺夫指数，分析其统计分布，并验证自平均性。\n\n该物理系统由一维晶格上的离散、不含时薛定谔方程描述：\n$$\n\\psi_{i+1} + \\psi_{i-1} + \\varepsilon_i \\psi_i = E \\psi_i\n$$\n此处，$\\psi_i$ 是在格点 $i$ 上的波函数振幅，$E$ 是能量，最近邻跃迁振幅设为 $1$。无序通过在位势 $\\varepsilon_i$ 引入，它们是独立同分布的随机变量，从均匀分布 $U[-\\frac{W}{2}, \\frac{W}{2}]$ 中抽取，其中 $W$ 是无序强度。\n\n为分析波函数的空间演化，我们可以将薛定谔方程重排为一个递归形式。这就引出了转移矩阵方法。我们在格点 $i$ 定义一个双分量状态向量 $\\vec{\\Psi}_{i-1} = \\begin{pmatrix}\\psi_i \\\\ \\psi_{i-1}\\end{pmatrix}$。方程 $\\psi_{i+1} = (E - \\varepsilon_i)\\psi_i - \\psi_{i-1}$ 决定了到下一个格点的演化。因此，新的状态向量 $\\vec{\\Psi}_i = \\begin{pmatrix}\\psi_{i+1} \\\\ \\psi_i\\end{pmatrix}$ 通过一个线性变换与前一个相关联：\n$$\n\\vec{\\Psi}_i = \\begin{pmatrix} E - \\varepsilon_i & -1 \\\\ 1 & 0 \\end{pmatrix} \\vec{\\Psi}_{i-1} \\equiv M_i \\vec{\\Psi}_{i-1}\n$$\n矩阵 $M_i$ 是在格点 $i$ 的转移矩阵。其元素取决于随机势 $\\varepsilon_i$。\n\n经过 $L$ 个格点后，波函数向量 $\\vec{\\Psi}_L$ 通过 $L$ 个随机矩阵的乘积与初始向量 $\\vec{\\Psi}_0 = \\begin{pmatrix}\\psi_1 \\\\ \\psi_0\\end{pmatrix}$ 相关联：\n$$\n\\vec{\\Psi}_L = M_L M_{L-1} \\cdots M_1 \\vec{\\Psi}_0 = P_L \\vec{\\Psi}_0\n$$\n根据Oseledec的乘法遍历定理，对于几乎任何初始向量 $\\vec{\\Psi}_0$，$\\vec{\\Psi}_L$ 的范数随 $L$ 指数增长或衰减。这种指数变化的速率由最大李雅普诺夫指数 $\\gamma$ 给出：\n$$\n\\gamma = \\lim_{L \\to \\infty} \\frac{1}{L} \\ln \\left\\| P_L \\vec{\\Psi}_0 \\right\\|\n$$\n在一维安德森局域化问题的背景下，对于任何非零的无序强度 $W>0$，所有量子态都是局域化的。波函数包络从其局域化中心呈指数衰减，即 $|\\psi_i| \\sim e^{-|i-i_0|/\\xi}$，其中 $\\xi$ 是局域化长度。局域化长度与最大李雅普诺夫指数直接相关，关系为 $\\xi = 1/\\gamma$。\n\n通过先计算乘积矩阵 $P_L$ 再计算其范数来天真地计算 $\\gamma$ 是数值不稳定的。$\\vec{\\Psi}_i$ 的范数呈指数增长，会迅速导致浮点数溢出。为避免此问题，采用了一种涉及迭代归一化的数值稳定程序。此方法类似于用于求单个矩阵最大特征值的幂迭代法，但已适配于矩阵的乘积。\n\n对于单次无序实现，算法按以下步骤进行：\n1.  初始化一个具有单位欧几里得范数的状态向量 $\\vec{v}_0$，例如 $\\vec{v}_0 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，对应于初始选择 $(\\psi_1, \\psi_0) = (1,0)$。\n2.  对从 $1$ 到 $L$ 的每个格点 $i$：\n    a. 生成一个随机在位势 $\\varepsilon_i$ 并构成转移矩阵 $M_i$。\n    b. 将转移矩阵应用于当前的归一化向量：$\\vec{u}_i = M_i \\vec{v}_{i-1}$。\n    c. 计算所得向量的欧几里得范数：$n_i = \\|\\vec{u}_i\\|$。这个因子代表了此步的范数增长。\n    d. 为下一次迭代将向量归一化以保持单位范数：$\\vec{v}_i = \\vec{u}_i / n_i$。\n    e. 存储范数的对数 $\\ln n_i$。\n\n经过 $L$ 步后，范数的总乘积给出了总增长因子。对于这次单次实现的有限尺寸李雅普诺夫指数 $\\gamma_L$ 是对数增长因子的平均值：\n$$\n\\gamma_L = \\frac{1}{L} \\sum_{i=1}^L \\ln n_i\n$$\n为研究统计性质，对一个包含 $N$ 个独立无序实现的系综重复此过程。这将产生一组 $N$ 个值 $\\{\\gamma_L^{(j)}\\}_{j=1}^N$。从这个经验分布中，我们计算样本均值 $\\mu_L$ 和无偏样本方差 $s_L^2$：\n$$\n\\mu_L = \\frac{1}{N} \\sum_{j=1}^{N} \\gamma_L^{(j)} \\quad \\text{and} \\quad\ns_L^2 = \\frac{1}{N-1} \\sum_{j=1}^{N} (\\gamma_L^{(j)} - \\mu_L)^2\n$$\n然后，典型局域化长度估计为 $\\hat{\\xi}_{\\mathrm{typ}} = 1/\\mu_L$。\n\n自平均性是无序系统物理学中的一个关键性质。它意味着对于足够大的系统，单个大样本的行为就像系综平均一样。对于李雅普诺夫指数，这意味着 $\\gamma_L$ 的分布随着 $L$ 的增加而逐渐变窄。$\\gamma_L$ 求和中的项 $\\ln n_i$ 是具有短程关联的随机变量。根据中心极限定理，它们的和的方差与 $L$ 呈线性关系，因此它们的均值的方差 $s_L^2 = \\text{Var}(\\gamma_L)$ 应按 $1/L$ 缩放：\n$$\ns_L^2 \\propto \\frac{1}{L}\n$$\n这意味着对于大的 $L$，乘积 $s_L^2 L$ 应近似为常数。为验证这一点，我们比较两个具有相同参数 $(W, E)$ 但不同长度 $L_1$ 和 $L_2$ 的模拟。我们计算比率：\n$$\nR = \\frac{s_{L_1}^2 L_1}{s_{L_2}^2 L_2}\n$$\n如果自平均性成立，该比率 $R$ 应接近于 $1$。问题定义了一个容差 $|R-1| < 0.5$ 来测试这一点。\n\n程序实现将使用向量化的 `numpy` 操作并行地对 $N$ 个实现执行这些计算，以提高效率。一个单独的函数将封装给定参数集 $(L, W, E, N, \\text{seed})$ 的计算。一个形状为 $(N, 2)$ 的数组将同时保存所有实现的状态向量。在每个晶格格点 $i$，生成一个包含 $N$ 个随机势 $\\varepsilon_i$ 的数组，然后将转移矩阵操作、范数计算和归一化一次性应用于所有 $N$ 个向量。然后从得到的 $\\gamma_L$ 值系综中计算最终的统计数据和自平均性检查。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_stats(L, W, E, N, seed):\n    \"\"\"\n    Calculates the distribution of finite-size Lyapunov exponents for a 1D\n    tight-binding chain.\n\n    Args:\n        L (int): Length of the chain.\n        W (float): Disorder strength.\n        E (float): Energy.\n        N (int): Number of disorder realizations (ensemble size).\n        seed (int): Seed for the random number generator.\n\n    Returns:\n        tuple: A tuple containing:\n            - mu_L (float): Sample mean of the Lyapunov exponent.\n            - s_L_sq (float): Unbiased sample variance of the Lyapunov exponent.\n            - xi_typ (float): Estimated localization length (1 / mu_L).\n    \"\"\"\n    rng = np.random.default_rng(seed)\n\n    # Initialize N state vectors, each as (psi_1, psi_0) = (1, 0).\n    # Shape: (N, 2)\n    psi_vectors = np.zeros((N, 2))\n    psi_vectors[:, 0] = 1.0\n\n    # Array to accumulate the sum of log-norms for each realization.\n    log_norm_sum = np.zeros(N)\n\n    for _ in range(L):\n        # Generate N random onsite potentials from U[-W/2, W/2].\n        epsilons = rng.uniform(-W / 2.0, W / 2.0, size=N)\n\n        # Apply the transfer matrix to all N vectors simultaneously.\n        # Vector is (psi_current, psi_previous).\n        # New vector is (psi_next, psi_current).\n        psi_current = psi_vectors[:, 0]\n        psi_previous = psi_vectors[:, 1]\n        \n        psi_next = (E - epsilons) * psi_current - psi_previous\n        \n        # This temporary copy is needed for vectorization.\n        new_psi_vectors = np.empty_like(psi_vectors)\n        new_psi_vectors[:, 0] = psi_next\n        new_psi_vectors[:, 1] = psi_current\n\n        # Calculate the Euclidean norms of the N new vectors.\n        norms = np.linalg.norm(new_psi_vectors, axis=1)\n\n        # Accumulate the logarithm of the norms.\n        log_norm_sum += np.log(norms)\n\n        # Renormalize the state vectors to unit norm for the next step.\n        # Use np.newaxis to ensure correct broadcasting (N, 2) / (N, 1).\n        psi_vectors = new_psi_vectors / norms[:, np.newaxis]\n\n    # Calculate finite-length Lyapunov exponent for each realization.\n    gamma_L = log_norm_sum / L\n\n    # Compute sample mean and unbiased sample variance over the ensemble.\n    mu_L = np.mean(gamma_L)\n    s_L_sq = np.var(gamma_L, ddof=1)\n\n    # Estimate the typical localization length.\n    xi_typ = 1.0 / mu_L if mu_L > 0 else np.inf\n\n    return mu_L, s_L_sq, xi_typ\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L, W, E, N, seed)\n        (2000, 2.0, 0.0, 1000, 12345),  # Case 1\n        (2000, 0.5, 0.0, 1000, 23456),  # Case 2\n        (400, 2.0, 0.0, 1000, 34567),   # Case 3\n        (2000, 0.5, 1.8, 1000, 45678),  # Case 4\n    ]\n\n    case_results = []\n    for params in test_cases:\n        mu, var, xi = calculate_stats(*params)\n        case_results.append([mu, var, xi])\n\n    # Self-averaging check for Cases 1 and 3.\n    # L1 from Case 1, L2 from Case 3 (using problem notation)\n    L1 = test_cases[0][0]\n    s_L1_sq = case_results[0][1]\n\n    L2 = test_cases[2][0]\n    s_L2_sq = case_results[2][1]\n\n    R13 = (s_L1_sq * L1) / (s_L2_sq * L2)\n    SA_ok = abs(R13 - 1.0) < 0.5\n\n    # Prepare for final output string generation.\n    final_list = case_results + [[R13, SA_ok]]\n\n    # Format the results into the required single-line string.\n    output_parts = []\n    # Format the four main cases.\n    for i in range(4):\n        mu, var, xi = final_list[i]\n        output_parts.append(f\"[{mu:.6f},{var:.6f},{xi:.6f}]\")\n    \n    # Format the self-averaging check part.\n    r_val, sa_bool = final_list[4]\n    output_parts.append(f\"[{r_val:.6f},{'True' if sa_bool else 'False'}]\")\n\n    print(f\"[{','.join(output_parts)}]\")\n\n\nsolve()\n```", "id": "3005640"}]}