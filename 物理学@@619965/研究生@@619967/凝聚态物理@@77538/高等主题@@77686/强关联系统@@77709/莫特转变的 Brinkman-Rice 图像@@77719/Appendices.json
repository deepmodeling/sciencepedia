{"hands_on_practices": [{"introduction": "Brinkman-Rice图像的核心在于Gutzwiller变分方法，它为描述Mott相变提供了一个直观的物理图像。这个练习将引导你完成关键的推导过程，从计算无相互作用基态的双占有率$d_0$出发，通过最小化Gutzwiller能量泛函，揭示关联效应如何压制双占有率$d(U)$，并最终在临界相互作用$U_c$处导致Mott相变的发生。这是理解该理论的基石性计算。[@problem_id:2974400]", "problem": "考虑顺磁相中半填充的单带 Hubbard 模型，其哈密顿量为 $H = \\sum_{i,j,\\sigma} t_{ij}\\, c_{i\\sigma}^{\\dagger} c_{j\\sigma} + U \\sum_{i} n_{i\\uparrow} n_{i\\downarrow}$，其中 $c_{i\\sigma}^{\\dagger}$ 和 $c_{i\\sigma}$ 分别是自旋为 $\\sigma$ 的电子在格点 $i$ 上的产生和湮灭算符，$t_{ij}$ 是跃迁振幅，$U$ 是在位排斥势。每个格点的双占据率为 $d \\equiv \\langle n_{i\\uparrow} n_{i\\downarrow} \\rangle$，平均填充数为 $n \\equiv \\langle n_{i\\uparrow} + n_{i\\downarrow} \\rangle$。假设能带是自旋简并的，且系统处于空间均匀态。\n\n- 首先，计算半填充时的无相互作用双占据率 $d_0$。将无相互作用基态视为顺磁相中自旋扇区独立的 Slater 行列式，并使用 $d$ 的定义。\n\n- 接下来，在基于 Gutzwiller 变分法的 Brinkman-Rice 图像中，考虑大配位数极限下（此时局域组态计数是准确的）的顺磁半填充态。令 $E_0$ 表示半填充时每个格点的无相互作用动能（包括两种自旋），并假设 $E_0 < 0$。通过 Gutzwiller 带宽窄化因子 $q(d)$ 对动能进行重整化来构建每个格点的能量泛函 $E(d)$，其中 $q(d)$ 由与半填充和粒子-空穴对称性一致的在位组态概率确定，然后加上相互作用能 $U d$。然后对 $E(d)$ 关于 $d$ 进行最小化以获得 $d(U)$，并确定在此情景下使 $d$ 消失的相互作用强度 $U_c$。用 $U/U_c$ 表示你得到的 $d(U)$ 的最终结果。\n\n请以精确解析形式给出 $d_0$ 和 $d(U)$ 的最终表达式。无需四舍五入。答案应为无量纲的。", "solution": "该问题被验证为具有科学依据、提法恰当且客观。这是凝聚态理论中一个关于 Hubbard 模型内 Mott 转变的标准问题，采用由 Brinkman 和 Rice 首创的 Gutzwiller 近似方法来解决。所有提供的信息都是自洽的，足以得到唯一解。\n\n问题分两部分解决：首先，计算无相互作用极限下的双占据率；其次，在 Brinkman-Rice-Gutzwiller 框架内计算双占据率作为相互作用强度 $U$ 的函数。\n\n第一部分：无相互作用双占据率 $d_0$\n\n每个格点的双占据率 $d$ 定义为期望值 $d \\equiv \\langle n_{i\\uparrow} n_{i\\downarrow} \\rangle$，其中 $n_{i\\sigma} = c_{i\\sigma}^{\\dagger} c_{i\\sigma}$ 是格点 $i$ 上自旋为 $\\sigma$ 的电子的数算符。\n\n在无相互作用情况（$U=0$）下，基态是通过填充最低能量的单粒子态形成的单个 Slater 行列式。对于顺磁系统，自旋向上和自旋向下的电子形成独立的费米海。因此，在某个格点上发现一个自旋向上电子的事件与在同一格点上发现一个自旋向下电子的事件在统计上是独立的。因此，数算符乘积的期望值可以分解为：\n$$\nd_0 = \\langle n_{i\\uparrow} n_{i\\downarrow} \\rangle_{U=0} = \\langle n_{i\\uparrow} \\rangle_{U=0} \\langle n_{i\\downarrow} \\rangle_{U=0}\n$$\n问题指定了半填充能带，这意味着每个格点的平均总电子数为 $n=1$。\n$$\nn = \\langle n_{i\\uparrow} + n_{i\\downarrow} \\rangle = \\langle n_{i\\uparrow} \\rangle + \\langle n_{i\\downarrow} \\rangle = 1\n$$\n在顺磁和自旋简并的系统中，每种自旋的平均占据数必须相等：\n$$\n\\langle n_{i\\uparrow} \\rangle = \\langle n_{i\\downarrow} \\rangle\n$$\n结合这两个条件，我们发现：\n$$\n2 \\langle n_{i\\uparrow} \\rangle = 1 \\implies \\langle n_{i\\uparrow} \\rangle = \\frac{1}{2}\n$$\n因此，$\\langle n_{i\\downarrow} \\rangle = \\frac{1}{2}$ 也成立。\n\n将这些值代入 $d_0$ 的分解表达式中：\n$$\nd_0 = \\left(\\frac{1}{2}\\right) \\left(\\frac{1}{2}\\right) = \\frac{1}{4}\n$$\n\n第二部分：Brinkman-Rice 图像中的双占据率 $d(U)$\n\nBrinkman-Rice 图像采用了 Gutzwiller 变分法。每个格点的总能量 $E(d)$ 被构建为变分参数 $d$（双占据率）的函数。能量泛函由重整化的动能和在位排斥引起的势能组成：\n$$\nE(d) = q(d) E_0 + U d\n$$\n这里，$E_0$ 是每个格点的无相互作用动能（给定 $E_0 < 0$），$U d$ 是每个格点的相互作用能，$q(d)$ 是 Gutzwiller 带宽窄化因子，它量化了因关联抑制电荷涨落而导致的动能减少。\n\n对于半填充（$n=1$）的顺磁系统，在大晶格配位数极限下（Gutzwiller 近似所假设的），带宽窄化因子 $q(d)$ 有一个公认的形式。这个形式可以通过考虑允许电子跃迁的格点上局域组态的概率来推导。在半填充时，为了保持粒子-空穴对称性，一个格点为空的概率必须等于其被双占据的概率，即 $\\nu_0 = d$。单占据的概率是 $\\nu_s = 1 - 2d$。由此得到的带宽窄化因子是：\n$$\nq(d) = 8d(1-2d)\n$$\n这个因子正确地描述了两种极限情况下的物理：\n1.  无相互作用极限：$d = d_0 = 1/4$。此时 $q(1/4) = 8(1/4)(1 - 2(1/4)) = 2(1/2) = 1$。动能未被重整化，符合预期。\n2.  强关联极限（Mott 绝缘体）：$d \\to 0$。此时 $q(d) \\to 0$。由于电荷涨落被冻结，动能被完全抑制。$d$ 的有效范围是 $0 \\le d \\le 1/4$。\n\n将 $q(d)$ 的这个表达式代入能量泛函中，得到：\n$$\nE(d) = 8d(1-2d)E_0 + U d\n$$\n为了找到平衡双占据率 $d(U)$，我们对 $E(d)$ 关于 $d$ 进行最小化：\n$$\n\\frac{\\partial E(d)}{\\partial d} = \\frac{\\partial}{\\partial d} (8d E_0 - 16d^2 E_0 + U d) = 8E_0 - 32d E_0 + U = 0\n$$\n求解 $d$：\n$$\n32d E_0 = 8E_0 + U\n$$\n$$\nd(U) = \\frac{8E_0 + U}{32E_0} = \\frac{1}{4} + \\frac{U}{32E_0}\n$$\n因为给定 $E_0 < 0$，我们可以写成 $E_0 = -|E_0|$ 以使物理依赖关系更清晰：\n$$\nd(U) = \\frac{1}{4} - \\frac{U}{32|E_0|}\n$$\n该表达式表明，随着排斥作用 $U$ 的增加，双占据率从其无相互作用值 $d_0 = 1/4$ 开始线性减小。\n\nMott 转变发生在临界相互作用强度 $U_c$ 处，此时双占据率消失，标志着电子的局域化和电荷能隙的打开。我们通过令 $d(U_c) = 0$ 来找到 $U_c$：\n$$\n0 = \\frac{1}{4} - \\frac{U_c}{32|E_0|}\n$$\n$$\n\\frac{U_c}{32|E_0|} = \\frac{1}{4} \\implies U_c = \\frac{32|E_0|}{4} = 8|E_0|\n$$\n这就是著名的 Brinkman-Rice 关于临界相互作用的结果。\n\n最后，我们用比值 $U/U_c$ 来表示双占据率 $d(U)$。从 $d(U)$ 的表达式中，我们有 $\\frac{U}{32|E_0|} = \\frac{U}{4 U_c}$。将其代回，我们得到：\n$$\nd(U) = \\frac{1}{4} - \\frac{U}{4U_c} = \\frac{1}{4}\\left(1 - \\frac{U}{U_c}\\right)\n$$\n这个表达式在金属相（$0 \\le U \\le U_c$）内有效。对于 $U > U_c$，双占据率为零。\n\n问题要求给出 $d_0$ 和 $d(U)$ 的解析表达式。\n\n无相互作用双占据率为 $d_0 = \\frac{1}{4}$。\n相互作用双占据率为 $d(U) = \\frac{1}{4}\\left(1 - \\frac{U}{U_c}\\right)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{4} & \\frac{1}{4}\\left(1 - \\frac{U}{U_c}\\right) \\end{pmatrix}}\n$$", "id": "2974400"}, {"introduction": "一个强大的物理理论必须能够做出可检验的预测，从而连接理论与实验。本练习旨在将Brinkman-Rice图像中的准粒子权重$Z$这一核心概念与一个关键的实验可观测量——电阻率的$T^2$行为——联系起来。你将推导当系统趋近Mott相变时，准粒子相干性的丧失（$Z \\to 0$）如何导致电子-电子散射的急剧增强和电阻率系数$A$的发散，这是强关联金属的一个标志性特征。[@problem_id:2974471]", "problem": "考虑一个晶格上的半满单带 Hubbard 模型，其裸带色散关系为 $\\epsilon_{\\mathbf{k}}$，裸电子密度为 $n$，裸带质量为 $m_b$，裸半带宽为 $W$。假设该系统是一个重整化费米液体，其自能与动量无关（如在动力学平均场理论中），特征在于准粒子权重 $Z$ 和有效质量 $m^{\\ast} = m_b/Z$。总电子密度中有 $Z$ 的部分是相干准粒子，低能动力学标度由重整化费米液体相干标度 $\\propto Z W$ 设定。\n\n使用以下经过充分检验的费米液体要素：\n\n- 准粒子衰变率由自能的虚部控制，即 $1/\\tau = -2 Z\\,\\operatorname{Im}\\Sigma(\\omega=0,T)/\\hbar$。\n\n- 在一个局域（动量无关）的费米液体中，当 $\\omega=0$ 附近时，自能虚部对温度的主要依赖关系与温度成二次方关系：$\\operatorname{Im}\\Sigma(0,T) = -C\\left(\\pi k_B T\\right)^2/(Z W)$，其中 $C$ 是一个由局域相互作用和相空间决定的无量纲常数，$k_B$ 是玻尔兹曼常数，$\\hbar$ 是约化普朗克常数。\n\n- 相干准粒子的直流电导率可以采用 Drude 形式，$\\sigma = n_{\\mathrm{coh}} e^2 \\tau/m^{\\ast}$，其中 $n_{\\mathrm{coh}} = Z n$ 是相干载流子密度，$e$ 是元电荷。因此，电阻率为 $\\rho = m^{\\ast}/(n_{\\mathrm{coh}} e^2 \\tau)$。\n\n从这些输入出发，推导相干费米液体的低温电阻率，证明其具有 $\\rho(T) = A T^2$ 的形式，并求出系数 $A$ 的解析表达式，用 $Z$、$m_b$、$n$、$e$、$k_B$、$\\hbar$、$W$ 和 $C$ 表示。然后，在半满填充的 Brinkman-Rice 图像下，采用准粒子重整化关系 $Z(U) = 1 - \\left(U/U_c\\right)^2$，其中 $U$ 是在位库伦排斥，$U_c$ 是莫特转变的临界值。用此关系将 $A$ 明确表示为 $U$ 和 $U_c$ 的函数，并讨论当 $U \\to U_c^{-}$ 时 $A$ 是如何发散的。\n\n只需提供 $A(U)$ 的最终解析表达式。将 $A$ 以 $\\Omega\\,\\mathrm{m}\\,\\mathrm{K}^{-2}$ 的国际单位制单位表示。不需要进行数值计算，最终的方框答案中不应包含任何单位。", "solution": "该问题陈述经评估具有科学依据、提法明确且客观，满足所有有效性标准。它提出了一个凝聚态物理中的标准理论问题，涉及莫特转变附近强关联电子的行为，并使用了费米液体理论和 Brinkman-Rice 图像中的既定概念和关系。所有必要的参数和方程均已提供，构成了一个自洽且一致的设定。\n\n我们从推导低温电阻率 $\\rho(T)$ 开始。问题给出了用准粒子性质表示的类 Drude 电阻率表达式：\n$$\n\\rho = \\frac{m^{\\ast}}{n_{\\mathrm{coh}} e^2 \\tau}\n$$\n这里，$m^{\\ast}$ 是有效质量，$n_{\\mathrm{coh}}$ 是相干准粒子密度，$e$ 是元电荷，$\\tau$ 是准粒子寿命。\n\n问题为重整化费米液体提供了以下关系：\n1.  有效质量：$m^{\\ast} = m_b/Z$\n2.  相干载流子密度：$n_{\\mathrm{coh}} = Z n$\n其中 $m_b$ 是裸带质量，$n$ 是总电子密度，$Z$ 是准粒子权重。\n\n将这些表达式代入电阻率公式可得：\n$$\n\\rho = \\frac{m_b/Z}{(Z n) e^2 \\tau} = \\frac{m_b}{Z^2 n e^2 \\tau} = \\frac{m_b}{Z^2 n e^2} \\left(\\frac{1}{\\tau}\\right)\n$$\n准粒子散射率 $1/\\tau$ 与费米能级（$\\omega=0$）处的自能虚部 $\\operatorname{Im}\\Sigma(\\omega, T)$ 相关，由所给公式给出：\n$$\n\\frac{1}{\\tau} = - \\frac{2 Z}{\\hbar} \\operatorname{Im}\\Sigma(\\omega=0, T)\n$$\n其中 $\\hbar$ 是约化普朗克常数。将其代入我们的 $\\rho$ 表达式得到：\n$$\n\\rho(T) = \\frac{m_b}{Z^2 n e^2} \\left( - \\frac{2 Z}{\\hbar} \\operatorname{Im}\\Sigma(0, T) \\right) = - \\frac{2 m_b}{Z n e^2 \\hbar} \\operatorname{Im}\\Sigma(0, T)\n$$\n问题指出，对于局域费米液体，自能对温度的主要依赖关系是二次方关系：\n$$\n\\operatorname{Im}\\Sigma(0, T) = - \\frac{C (\\pi k_B T)^2}{Z W}\n$$\n其中 $C$ 是一个无量纲常数，$k_B$ 是玻尔兹曼常数，$T$ 是温度，$W$ 是裸半带宽。$1/(ZW)$ 因子反映了散射的相关能量标度是相干能量标度，其与 $ZW$ 成正比。\n\n将此 $\\operatorname{Im}\\Sigma(0, T)$ 的表达式代入 $\\rho(T)$ 的方程中：\n$$\n\\rho(T) = - \\frac{2 m_b}{Z n e^2 \\hbar} \\left( - \\frac{C (\\pi k_B T)^2}{Z W} \\right) = \\frac{2 m_b C \\pi^2 k_B^2}{Z^2 n e^2 \\hbar W} T^2\n$$\n这个结果表明，低温电阻率遵循特征性的费米液体幂律关系 $\\rho(T) \\propto T^2$。我们可以从一般形式 $\\rho(T) = A T^2$ 中确定系数 $A$：\n$$\nA = \\frac{2 \\pi^2 C m_b k_B^2}{n e^2 \\hbar W Z^2}\n$$\n接下来，我们引入半满填充下莫特转变的 Brinkman-Rice 图像。准粒子权重 $Z$ 取决于在位库伦排斥强度 $U$ 相对于临界值 $U_c$ 的大小。问题给出了从 Gutzwiller 近似中推导出的具体形式：\n$$\nZ(U) = 1 - \\left(\\frac{U}{U_c}\\right)^2\n$$\n莫特转变发生在 $U=U_c$ 处，此时 $Z$ 消失。将这个 $Z(U)$ 的表达式代入我们的系数 $A$ 的方程，得到 $A$ 作为 $U$ 的函数的最终表达式：\n$$\nA(U) = \\frac{2 \\pi^2 C m_b k_B^2}{n e^2 \\hbar W \\left( 1 - \\left(\\frac{U}{U_c}\\right)^2 \\right)^2}\n$$\n这个表达式揭示了当接近莫特转变时电阻率系数的行为。当 $U \\to U_c^{-}$ 时，分母项 $\\left(1 - (U/U_c)^2\\right)^2$ 趋近于零。这导致系数 $A$ 发散。$A$ 的发散行为 $A \\propto Z^{-2} \\propto (U_c - U)^{-2}$ 是 Brinkman-Rice 莫特转变的一个标志，标志着由于极端的质量增强（$m^* \\propto 1/Z$）和准粒子相干性的丧失，金属态的崩溃。电子发生局域化，导致在 $U \\ge U_c$ 时进入绝缘态。问题要求给出 $A(U)$ 的解析表达式。", "answer": "$$\n\\boxed{\\frac{2 \\pi^{2} C m_b k_B^{2}}{n e^{2} \\hbar W \\left( 1 - \\left(\\frac{U}{U_c}\\right)^{2} \\right)^{2}}}\n$$", "id": "2974471"}, {"introduction": "理论结果，如临界相互作用$U_c = 8|E_0|$，只有在应用于具体模型时才获得其实际意义。本练习旨在通过让你为二维方格晶格模型数值计算基态动能$E_0$，从而架起抽象推导与具体应用之间的桥梁。这项基于编码的动手任务将为临界相互作用强度$U_c$提供一个可计算的数值，并巩固你对晶格几何如何决定问题能量尺度的理解。[@problem_id:2974507]", "problem": "考虑一个二维方格晶格上的单带哈伯德模型（Hubbard model），其最近邻跃迁振幅为 $t$（可正可负），在位库仑排斥为 $U$。无相互作用的紧束缚色散为 $\\varepsilon_{\\mathbf{k}}=-2t(\\cos k_x+\\cos k_y)$，其中 $\\mathbf{k}=(k_x,k_y)$ 位于布里渊区 $[-\\pi,\\pi)\\times[-\\pi,\\pi)$ 内。考虑零温和半填充（每个格点一个电子）的情况。由于二分晶格上的粒子-空穴对称性，半填充时的化学势为 $\\mu=0$。\n\n您的任务是：\n- 从哈伯德哈密顿量和半填充下的 Gutzwiller-Brinkman-Rice 变分图像出发，利用第一性原理推导临界相互作用 $U_c$ 的表达式，该表达式应使用半填充时无相互作用的格点平均动能 $E_0$ 来表示。不要假设任何已知的简化公式；请从 Gutzwiller 近似中的动能重整化和对双占据率的变分最小化开始。\n- 通过使用均匀网格进行布里渊区求和，数值估算半填充时无相互作用系统的 $E_0$。使用以下定义：\n$$\nE_0=\\frac{2}{4\\pi^2}\\int_{-\\pi}^{\\pi}\\int_{-\\pi}^{\\pi}\\varepsilon_{\\mathbf{k}}\\ \\Theta(-\\varepsilon_{\\mathbf{k}})\\,\\mathrm{d}k_x\\,\\mathrm{d}k_y,\n$$\n其中因子 $2$ 考虑了自旋简并，$\\Theta$ 是亥维赛阶跃函数（Heaviside step function）。将此积分实现为黎曼和，使用一个 $N\\times N$ 的均匀网格，其中 $N$ 为奇数，$k_\\alpha=-\\pi+\\frac{2\\pi}{N}i_\\alpha$，$i_\\alpha\\in\\{0,1,\\dots,N-1\\}$ 且 $\\alpha\\in\\{x,y\\}$。对于 $\\varepsilon_{\\mathbf{k}}=0$ 的点集，要与半填充条件一致地处理；请注意，这些点对 $E_0$ 没有贡献，因为它们的能量为零。\n- 使用您推导出的关系，为每个测试用例计算无量纲临界相互作用比 $u_c\\equiv U_c/|t|$。\n\n角度必须以弧度为单位。最终输出是无量纲的，不需要物理单位。报告每个 $u_c$ 值，四舍五入到 $6$ 位小数。\n\n测试组：\n- 用例 A: $(t,N)=(1.0,801)$\n- 用例 B: $(t,N)=(2.5,401)$\n- 用例 C: $(t,N)=(-1.0,401)$\n- 用例 D: $(t,N)=(1.0,21)$\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起，顺序为 [A,B,C,D]，例如，“[x_A,x_B,x_C,x_D]”。每个条目必须是四舍五入到 $6$ 位小数的浮点数。", "solution": "经评估，问题陈述有效。其科学依据扎根于已建立的哈伯德模型理论和关于莫特相变的 Gutzwiller-Brinkman-Rice 图像。该问题设定良好，所有参数、条件和数值方法都有明确无误的定义，不含主观论断或事实错误。\n\n### 1. 临界相互作用 $U_c$ 的理论推导\n\n我们从 Gutzwiller 近似所描述的半填充单带哈伯德模型的变分基态格点平均能量 $E$ 开始。该能量是双占据格点比例 $d$ 的函数：\n$$ E(d) = q(d) E_0 + U d $$\n在此，$U$ 是在位哈伯德排斥，$E_0$ 是半填充时无相互作用（$U=0$）系统的格点平均动能。$q(d)$ 项是动能重整化因子，它描述了由于关联效应阻碍电子跃迁而导致的能带能量降低。\n\n对于半填充系统，Gutzwiller 近似为此重整化因子提供了具体形式：\n$$ q(d) = 8d(1-2d) $$\n这个关系是 Brinkman-Rice 理论的基石。将其代入能量泛函可得：\n$$ E(d) = 8d(1-2d)E_0 + Ud $$\n为了找到在给定相互作用强度 $U$ 下最优的双占据比例，我们对能量 $E(d)$ 关于变分参数 $d$ 进行最小化：\n$$ \\frac{\\partial E(d)}{\\partial d} = \\frac{\\partial}{\\partial d} [8dE_0 - 16d^2E_0 + Ud] = 8E_0 - 32dE_0 + U = 0 $$\n求解 $d$ 可得：\n$$ 32dE_0 = 8E_0 + U \\implies d = \\frac{8E_0 + U}{32E_0} = \\frac{1}{4} + \\frac{U}{32E_0} $$\n无相互作用动能 $E_0$ 是费米海的基态能量，因此其本身为负值。我们可以写成 $E_0 = -|E_0|$，这给出：\n$$ d = \\frac{1}{4} - \\frac{U}{32|E_0|} $$\n此方程表明，当 $U=0$ 时，我们恢复了无相互作用的结果 $d=1/4$。随着 $U$ 的增加，$d$ 减小，这反映了双占据的能量代价。\n\nBrinkman-Rice 模型描述了一个金属-绝缘体相变，在临界相互作用强度 $U_c$ 时，电荷涨落被完全抑制。这对应于双占据的消失，即 $d=0$。此时，每个格点恰好被一个电子占据，系统成为莫特绝缘体。在我们的 $d$ 表达式中令 $d=0$，就可以求解 $U_c$：\n$$ 0 = \\frac{1}{4} - \\frac{U_c}{32|E_0|} $$\n$$ \\frac{U_c}{32|E_0|} = \\frac{1}{4} \\implies U_c = \\frac{32}{4}|E_0| = 8|E_0| $$\n这是 Brinkman-Rice 图像中关于临界相互作用的著名结果。问题要求计算无量纲比率 $u_c \\equiv U_c/|t|$，其中 $t$ 是跃迁振幅。代入我们关于 $U_c$ 的结果：\n$$ u_c = \\frac{8|E_0|}{|t|} $$\n\n### 2. $E_0$ 与 $u_c$ 的数值估算\n\n下一步是计算无相互作用的格点平均动能 $E_0$。问题给出了定义：\n$$ E_0=\\frac{2}{4\\pi^2}\\int_{-\\pi}^{\\pi}\\int_{-\\pi}^{\\pi}\\varepsilon_{\\mathbf{k}}\\ \\Theta(-\\varepsilon_{\\mathbf{k}})\\,\\mathrm{d}k_x\\,\\mathrm{d}k_y $$\n其中 $\\varepsilon_{\\mathbf{k}}=-2t(\\cos k_x+\\cos k_y)$ 是色散关系，因子 $2$ 考虑了自旋，而 $\\Theta$ 是亥维赛阶跃函数，它强制执行了 $T=0$ 的条件，即只有能量 $\\varepsilon_{\\mathbf{k}} < \\mu=0$ 的态被占据。\n\n我们可以分析 $E_0$ 对 $t$ 的依赖性。我们定义一个无量纲积分 $K_0$：\n$$ K_0 = \\frac{4}{4\\pi^2} \\iint_{\\cos k_x+\\cos k_y > 0} (\\cos k_x+\\cos k_y)\\,\\mathrm{d}k_x\\,\\mathrm{d}k_y $$\n- 若 $t>0$，则 $t=|t|$ 且当 $\\cos k_x+\\cos k_y > 0$ 时 $\\varepsilon_{\\mathbf{k}} < 0$。\n  $$ E_0 = \\frac{2}{4\\pi^2} \\iint_{\\cos k_x+\\cos k_y>0} -2|t|(\\cos k_x+\\cos k_y)\\,\\mathrm{d}k_x\\,\\mathrm{d}k_y = -|t| K_0 $$\n- 若 $t<0$，则 $t=-|t|$ 且当 $\\cos k_x+\\cos k_y < 0$ 时 $\\varepsilon_{\\mathbf{k}} < 0$。\n  $$ E_0 = \\frac{2}{4\\pi^2} \\iint_{\\cos k_x+\\cos k_y<0} 2|t|(\\cos k_x+\\cos k_y)\\,\\mathrm{d}k_x\\,\\mathrm{d}k_y $$\n  由于布里渊区和被积函数的对称性，$\\int_{\\cos k_x+\\cos k_y<0} (\\cos k_x+\\cos k_y)\\,\\mathrm{d}\\mathbf{k} = -\\int_{\\cos k_x+\\cos k_y>0} (\\cos k_x+\\cos k_y)\\,\\mathrm{d}\\mathbf{k}$。因此，这种情况下同样有 $E_0 = -|t| K_0$。\n\n在所有情况下，都有 $|E_0| = |t|K_0$，这意味着 $|E_0|/|t| = K_0$。该比率是一个常数，仅依赖于晶格结构，而与 $t$ 的符号或大小无关。因此，无量纲临界相互作用为：\n$$ u_c = \\frac{8|E_0|}{|t|} = 8K_0 $$\n我们的任务简化为数值计算 $K_0$。问题指定在均匀的 $N \\times N$ 网格上进行黎曼求和，其中 $k_\\alpha=-\\pi+\\frac{2\\pi}{N}i_\\alpha$，面积元为 $\\Delta k_x \\Delta k_y = (\\frac{2\\pi}{N})^2 = \\frac{4\\pi^2}{N^2}$。\n$$ K_0 \\approx \\frac{4}{4\\pi^2} \\sum_{i_x=0}^{N-1} \\sum_{i_y=0}^{N-1} (\\cos k_{i_x} + \\cos k_{i_y}) \\cdot \\Theta(\\cos k_{i_x} + \\cos k_{i_y}) \\cdot \\frac{4\\pi^2}{N^2} $$\n$$ K_0 \\approx \\frac{4}{N^2} \\sum_{i_x, i_y \\text{ s.t. } \\cos k_{i_x}+\\cos k_{i_y}>0} (\\cos k_{i_x} + \\cos k_{i_y}) $$\n$u_c$ 的计算因此将仅依赖于网格大小 $N$，而与 $t$ 的具体值无关。这意味着测试用例 B 和 C 必须产生相同的结果。\n\n数值算法如下：\n1.  对于给定的网格大小 $N$，生成 {$k_x, k_y$} 点。\n2.  对每个点 $(\\mathbf{k})$，计算 $C = \\cos k_x + \\cos k_y$。\n3.  对所有 $C > 0$ 的情况，将 $C$ 的值相加。\n4.  使用上述公式计算 $K_0$。\n5.  计算 $u_c = 8K_0$。\n对每个测试用例执行此过程。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the dimensionless critical interaction u_c = U_c/|t| in the\n    Brinkman-Rice picture for a 2D square lattice Hubbard model.\n    \"\"\"\n\n    test_cases = [\n        # (t, N)\n        (1.0, 801),  # Case A\n        (2.5, 401),  # Case B\n        (-1.0, 401), # Case C\n        (1.0, 21),   # Case D\n    ]\n\n    results = []\n    \n    # Cache results for N to avoid re-computation for cases B and C.\n    uc_cache = {}\n\n    for t, N in test_cases:\n        if N in uc_cache:\n            results.append(uc_cache[N])\n            continue\n            \n        # The derivation u_c = 8 * |E_0|/|t| shows that the result only depends\n        # on the lattice structure and the numerical grid size N, not the\n        # value or sign of the hopping parameter t.\n\n        # 1. Set up the N x N uniform grid in the Brillouin zone.\n        # k_alpha = -pi + (2*pi/N) * i_alpha for i_alpha in {0, ..., N-1}\n        i_alpha = np.arange(N)\n        k_vals = -np.pi + (2.0 * np.pi / N) * i_alpha\n        kx, ky = np.meshgrid(k_vals, k_vals)\n\n        # 2. Calculate the dimensionless sum part of the energy integral.\n        # The sum corresponds to the integral of (cos(kx) + cos(ky)) over the\n        # region of the Brillouin zone where this term is positive.\n        cos_sum_term = np.cos(kx) + np.cos(ky)\n\n        # 3. Apply the Heaviside step function condition.\n        # The condition for E_0 involves integrating over states where eps_k < 0.\n        # For t > 0, this means cos(kx) + cos(ky) > 0.\n        # For t < 0, this means cos(kx) + cos(ky) < 0.\n        # The a dimensionless constant K_0 = |E_0|/|t| is independent of t's sign.\n        # We calculate K_0 by summing over the positive part.\n        sum_val = np.sum(cos_sum_term[cos_sum_term > 0])\n\n        # 4. Calculate K_0 = |E_0|/|t|. The Riemann sum approximation is:\n        # K_0 = (4 / (4*pi^2)) * sum_val * (delta_k)^2\n        # delta_k = 2*pi/N, so (delta_k)^2 = 4*pi^2 / N^2\n        # K_0 = (4 / (4*pi^2)) * sum_val * (4*pi^2 / N^2) = 4 * sum_val / N^2\n        K0 = 4.0 / (N**2) * sum_val\n\n        # 5. Calculate the dimensionless critical interaction u_c = 8 * |E_0|/|t|.\n        # From the derivation, U_c = 8 * |E_0|, so u_c = 8 * K0.\n        uc = 8.0 * K0\n        \n        # Round the result to 6 decimal places as required.\n        rounded_uc = round(uc, 6)\n        results.append(rounded_uc)\n        uc_cache[N] = rounded_uc\n\n    # Print the final results in the specified format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2974507"}]}