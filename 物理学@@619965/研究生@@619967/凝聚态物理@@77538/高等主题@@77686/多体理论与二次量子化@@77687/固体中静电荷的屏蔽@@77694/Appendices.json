{"hands_on_practices": [{"introduction": "理论学习的基石在于将其应用于具体问题。第一个实践将带您回到托马斯-费米（Thomas-Fermi）理论的核心，这是一个描述金属中电荷屏蔽的简化但功能强大的模型。通过这个练习，您将亲手推导由外部点电荷引起的感应电荷密度，并验证一个基本原则——完全屏蔽法则，即电子气会重新排列以完全中和外来电荷 [@problem_id:3014987]。这个计算不仅能加深您对线性响应和介电函数概念的理解，还能锻炼您在傅里叶空间中解决静电问题的能力。", "problem": "考虑一个零温下的均匀三维电子气。在原点处放置一个总电荷为 $Q$ 的静态外部点电荷，因此外部电荷密度为 $\\rho_{\\mathrm{ext}}(\\mathbf{r}) = Q \\,\\delta^{(3)}(\\mathbf{r})$。计算采用高斯单位制，傅里叶变换的约定为 $f(\\mathbf{r}) = \\int \\frac{d^{3}q}{(2\\pi)^{3}}\\, f(\\mathbf{q}) \\exp(i \\mathbf{q}\\cdot \\mathbf{r})$ 和 $f(\\mathbf{q}) = \\int d^{3}r\\, f(\\mathbf{r}) \\exp(-i \\mathbf{q}\\cdot \\mathbf{r})$，并使用库仑核 $v(\\mathbf{q}) = \\frac{4\\pi}{q^{2}}$。在随机相近似 (RPA) 中，由外部源引起的屏蔽势满足 $\\phi_{\\mathrm{tot}}(\\mathbf{q}) = \\phi_{\\mathrm{ext}}(\\mathbf{q})/\\epsilon(\\mathbf{q})$，其中 $\\epsilon(\\mathbf{q})$ 是静态介电函数，而 $\\phi_{\\mathrm{ext}}(\\mathbf{q}) = v(\\mathbf{q}) \\rho_{\\mathrm{ext}}(\\mathbf{q})$ 可由泊松方程得出。感生电子数密度与感生电荷密度之间的关系为 $\\rho_{\\mathrm{ind}}(\\mathbf{r}) = -e\\,\\delta n(\\mathbf{r})$。\n\n仅从这些定义（泊松方程、线性响应和介电屏蔽关系）出发，推导 $\\delta n(\\mathbf{q})$ 关于 $\\epsilon(\\mathbf{q})$ 和 $Q$ 的傅里叶空间表达式。然后，通过将问题具体化到 RPA 的长波 Thomas–Fermi 极限，计算实空间中的感生密度 $\\delta n(\\mathbf{r})$。在此极限下，静态介电函数的形式为 $\\epsilon(\\mathbf{q}) = 1 + \\frac{k_{\\mathrm{TF}}^{2}}{q^{2}}$，其中 $k_{\\mathrm{TF}}$ 是 Thomas–Fermi 波数。最后，在不计算任何用于归一化的实空间积分的情况下，仅使用 $\\epsilon(\\mathbf{q})$ 在 $q=0$ 处的行为以及 $\\delta n(\\mathbf{q})$ 的傅里叶空间表达式，验证总感生电荷等于 $-Q$。\n\n你的最终答案必须是 Thomas–Fermi 极限下 $\\delta n(\\mathbf{r})$ 的一个单一闭合形式解析表达式。请勿在最终答案框中包含单位。无需进行数值计算。", "solution": "首先根据给定标准对问题进行验证。\n\n### 问题验证\n\n**第一步：提取已知条件**\n- 系统：一个零温（$T=0$）下的均匀三维（$3$D）电子气。\n- 外部源：位于原点的静态外部点电荷，总电荷为 $Q$，电荷密度为 $\\rho_{\\mathrm{ext}}(\\mathbf{r}) = Q \\,\\delta^{(3)}(\\mathbf{r})$。\n- 单位与约定：使用高斯单位制。傅里叶变换对定义为 $f(\\mathbf{r}) = \\int \\frac{d^{3}q}{(2\\pi)^{3}}\\, f(\\mathbf{q}) \\exp(i \\mathbf{q}\\cdot \\mathbf{r})$ 和 $f(\\mathbf{q}) = \\int d^{3}r\\, f(\\mathbf{r}) \\exp(-i \\mathbf{q}\\cdot \\mathbf{r})$。傅里叶空间中的库仑核为 $v(\\mathbf{q}) = \\frac{4\\pi}{q^{2}}$。\n- 物理关系：屏蔽势为 $\\phi_{\\mathrm{tot}}(\\mathbf{q}) = \\phi_{\\mathrm{ext}}(\\mathbf{q})/\\epsilon(\\mathbf{q})$，其中 $\\epsilon(\\mathbf{q})$ 是静态介电函数。外部势由泊松方程给出，$\\phi_{\\mathrm{ext}}(\\mathbf{q}) = v(\\mathbf{q}) \\rho_{\\mathrm{ext}}(\\mathbf{q})$。感生电子数密度 $\\delta n(\\mathbf{r})$ 与感生电荷密度之间的关系为 $\\rho_{\\mathrm{ind}}(\\mathbf{r}) = -e\\,\\delta n(\\mathbf{r})$。\n- 特定模型：静态介电函数的 Thomas–Fermi 近似为 $\\epsilon(\\mathbf{q}) = 1 + \\frac{k_{\\mathrm{TF}}^{2}}{q^{2}}$。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据：** 这是一个凝聚态物理中的标准练习题，涉及线性响应理论、随机相近似（RPA）和 Thomas-Fermi 屏蔽等成熟概念。所有原理和方程都是该领域的基础。\n- **良构性：** 问题陈述清晰，提供了所有必要的定义、常数和关系。它要求进行特定的推导和验证，存在唯一解。\n- **客观性：** 语言正式且精确，没有任何主观或含糊的术语。\n- **缺陷检查清单：** 该问题未违反任何无效性标准。它在科学上是合理的，并且是完整、一致和结构良好的。\n\n**第三步：结论与行动**\n问题有效。将提供完整解答。\n\n### 解答推导\n\n解答过程按要求分为三部分：首先，推导感生电子数密度 $\\delta n(\\mathbf{q})$ 的通用傅里叶空间表达式；其次，在 Thomas–Fermi 近似下计算实空间密度 $\\delta n(\\mathbf{r})$；第三，验证总感生电荷。\n\n**第一部分：$\\delta n(\\mathbf{q})$ 的推导**\n\n总电荷密度 $\\rho_{\\mathrm{tot}}(\\mathbf{r})$ 是外部电荷密度 $\\rho_{\\mathrm{ext}}(\\mathbf{r})$ 与电子气产生的感生电荷密度 $\\rho_{\\mathrm{ind}}(\\mathbf{r})$ 之和。\n$$ \\rho_{\\mathrm{tot}}(\\mathbf{r}) = \\rho_{\\mathrm{ext}}(\\mathbf{r}) + \\rho_{\\mathrm{ind}}(\\mathbf{r}) $$\n在傅里叶空间中，该关系为 $\\rho_{\\mathrm{tot}}(\\mathbf{q}) = \\rho_{\\mathrm{ext}}(\\mathbf{q}) + \\rho_{\\mathrm{ind}}(\\mathbf{q})$。\n\n总势 $\\phi_{\\mathrm{tot}}(\\mathbf{r})$ 由总电荷密度 $\\rho_{\\mathrm{tot}}(\\mathbf{r})$ 根据泊松方程 $\\nabla^2 \\phi_{\\mathrm{tot}}(\\mathbf{r}) = -4\\pi \\rho_{\\mathrm{tot}}(\\mathbf{r})$ 生成。在傅里叶空间中，这变为 $-q^2 \\phi_{\\mathrm{tot}}(\\mathbf{q}) = -4\\pi \\rho_{\\mathrm{tot}}(\\mathbf{q})$，它通过库仑核 $v(\\mathbf{q}) = 4\\pi/q^2$ 将势和电荷密度联系起来：\n$$ \\phi_{\\mathrm{tot}}(\\mathbf{q}) = \\frac{4\\pi}{q^2} \\rho_{\\mathrm{tot}}(\\mathbf{q}) = v(\\mathbf{q}) \\rho_{\\mathrm{tot}}(\\mathbf{q}) $$\n问题陈述，在随机相近似 (RPA) 中，总势通过介电函数 $\\epsilon(\\mathbf{q})$ 与外部势相关联：\n$$ \\phi_{\\mathrm{tot}}(\\mathbf{q}) = \\frac{\\phi_{\\mathrm{ext}}(\\mathbf{q})}{\\epsilon(\\mathbf{q})} $$\n外部势 $\\phi_{\\mathrm{ext}}(\\mathbf{q})$ 由外部电荷 $\\rho_{\\mathrm{ext}}(\\mathbf{q})$ 产生，因此 $\\phi_{\\mathrm{ext}}(\\mathbf{q}) = v(\\mathbf{q}) \\rho_{\\mathrm{ext}}(\\mathbf{q})$。将此代入屏蔽关系式得到：\n$$ \\phi_{\\mathrm{tot}}(\\mathbf{q}) = \\frac{v(\\mathbf{q}) \\rho_{\\mathrm{ext}}(\\mathbf{q})}{\\epsilon(\\mathbf{q})} $$\n通过令 $\\phi_{\\mathrm{tot}}(\\mathbf{q})$ 的两个表达式相等，我们得到：\n$$ v(\\mathbf{q}) \\rho_{\\mathrm{tot}}(\\mathbf{q}) = \\frac{v(\\mathbf{q}) \\rho_{\\mathrm{ext}}(\\mathbf{q})}{\\epsilon(\\mathbf{q})} $$\n$$ \\rho_{\\mathrm{tot}}(\\mathbf{q}) = \\frac{\\rho_{\\mathrm{ext}}(\\mathbf{q})}{\\epsilon(\\mathbf{q})} $$\n代入 $\\rho_{\\mathrm{tot}}(\\mathbf{q}) = \\rho_{\\mathrm{ext}}(\\mathbf{q}) + \\rho_{\\mathrm{ind}}(\\mathbf{q})$ 允许我们求解感生电荷密度：\n$$ \\rho_{\\mathrm{ext}}(\\mathbf{q}) + \\rho_{\\mathrm{ind}}(\\mathbf{q}) = \\frac{\\rho_{\\mathrm{ext}}(\\mathbf{q})}{\\epsilon(\\mathbf{q})} $$\n$$ \\rho_{\\mathrm{ind}}(\\mathbf{q}) = \\rho_{\\mathrm{ext}}(\\mathbf{q}) \\left( \\frac{1}{\\epsilon(\\mathbf{q})} - 1 \\right) $$\n外部电荷是位于原点的点电荷 $Q$，即 $\\rho_{\\mathrm{ext}}(\\mathbf{r}) = Q\\,\\delta^{(3)}(\\mathbf{r})$。其傅里叶变换为 $\\rho_{\\mathrm{ext}}(\\mathbf{q}) = \\int d^3r \\, Q\\,\\delta^{(3)}(\\mathbf{r}) \\exp(-i\\mathbf{q}\\cdot\\mathbf{r}) = Q$。因此：\n$$ \\rho_{\\mathrm{ind}}(\\mathbf{q}) = Q \\left( \\frac{1}{\\epsilon(\\mathbf{q})} - 1 \\right) $$\n感生电荷密度通过 $\\rho_{\\mathrm{ind}}(\\mathbf{r}) = -e\\,\\delta n(\\mathbf{r})$ 与感生电子数密度相关，这意味着 $\\rho_{\\mathrm{ind}}(\\mathbf{q}) = -e\\,\\delta n(\\mathbf{q})$。因此，我们得到 $\\delta n(\\mathbf{q})$ 的傅里叶空间表达式：\n$$ -e\\,\\delta n(\\mathbf{q}) = Q \\left( \\frac{1}{\\epsilon(\\mathbf{q})} - 1 \\right) \\implies \\delta n(\\mathbf{q}) = \\frac{Q}{e} \\left( 1 - \\frac{1}{\\epsilon(\\mathbf{q})} \\right) $$\n\n**第二部分：在 Thomas–Fermi 极限下计算 $\\delta n(\\mathbf{r})$**\n\n我们现在使用 Thomas–Fermi 介电函数，$\\epsilon(\\mathbf{q}) = 1 + \\frac{k_{\\mathrm{TF}}^{2}}{q^{2}}$。将其代入 $\\delta n(\\mathbf{q})$ 的表达式：\n$$ \\delta n(\\mathbf{q}) = \\frac{Q}{e} \\left( 1 - \\frac{1}{1 + k_{\\mathrm{TF}}^{2}/q^{2}} \\right) = \\frac{Q}{e} \\left( 1 - \\frac{q^2}{q^2 + k_{\\mathrm{TF}}^{2}} \\right) $$\n$$ \\delta n(\\mathbf{q}) = \\frac{Q}{e} \\left( \\frac{q^2 + k_{\\mathrm{TF}}^{2} - q^2}{q^2 + k_{\\mathrm{TF}}^{2}} \\right) = \\frac{Q}{e} \\frac{k_{\\mathrm{TF}}^{2}}{q^2 + k_{\\mathrm{TF}}^{2}} $$\n为了求得实空间中的感生密度 $\\delta n(\\mathbf{r})$，我们必须执行傅里叶逆变换：\n$$ \\delta n(\\mathbf{r}) = \\int \\frac{d^3q}{(2\\pi)^3} \\delta n(\\mathbf{q}) \\exp(i\\mathbf{q}\\cdot\\mathbf{r}) = \\frac{Q k_{\\mathrm{TF}}^{2}}{e} \\int \\frac{d^3q}{(2\\pi)^3} \\frac{\\exp(i\\mathbf{q}\\cdot\\mathbf{r})}{q^2 + k_{\\mathrm{TF}}^{2}} $$\n这个积分是一个标准结果，对应于亥姆霍兹算子 $(-\\nabla^2 + k_{\\mathrm{TF}}^2)$ 的格林函数。我们可以使用 $\\mathbf{q}$ 的球坐标来计算它。设 $z$ 轴沿 $\\mathbf{r}$ 方向，因此 $\\mathbf{q}\\cdot\\mathbf{r} = qr\\cos\\theta$，其中 $r=|\\mathbf{r}|$ 且 $q=|\\mathbf{q}|$。体积元为 $d^3q = q^2 \\sin\\theta \\,dq\\,d\\theta\\,d\\phi$。\n$$ \\int \\frac{d^3q}{(2\\pi)^3} \\frac{\\exp(i\\mathbf{q}\\cdot\\mathbf{r})}{q^2 + k_{\\mathrm{TF}}^{2}} = \\frac{1}{(2\\pi)^3} \\int_0^\\infty dq \\frac{q^2}{q^2+k_{\\mathrm{TF}}^2} \\int_0^{2\\pi}d\\phi \\int_0^\\pi d\\theta\\,\\sin\\theta\\,\\exp(iqr\\cos\\theta) $$\n角积分的结果为：\n$$ \\int_0^{2\\pi}d\\phi = 2\\pi $$\n$$ \\int_0^\\pi \\sin\\theta\\,\\exp(iqr\\cos\\theta)\\,d\\theta = \\left[-\\frac{\\exp(iqr\\cos\\theta)}{iqr}\\right]_0^\\pi = \\frac{\\exp(iqr) - \\exp(-iqr)}{iqr} = \\frac{2\\sin(qr)}{qr} $$\n积分变为：\n$$ \\frac{2\\pi}{(2\\pi)^3} \\int_0^\\infty dq \\frac{q^2}{q^2+k_{\\mathrm{TF}}^2} \\frac{2\\sin(qr)}{qr} = \\frac{1}{2\\pi^2 r} \\int_0^\\infty dq \\frac{q\\sin(qr)}{q^2+k_{\\mathrm{TF}}^2} $$\n这个剩余的积分可以使用围道积分法求解，其值为 $\\frac{\\pi}{2}\\exp(-k_{\\mathrm{TF}}r)$。\n$$ \\frac{1}{2\\pi^2 r} \\left(\\frac{\\pi}{2}\\exp(-k_{\\mathrm{TF}}r)\\right) = \\frac{1}{4\\pi r} \\exp(-k_{\\mathrm{TF}}r) $$\n将此结果代回 $\\delta n(\\mathbf{r})$ 的表达式：\n$$ \\delta n(\\mathbf{r}) = \\frac{Q k_{\\mathrm{TF}}^{2}}{e} \\left( \\frac{1}{4\\pi r} \\exp(-k_{\\mathrm{TF}}r) \\right) = \\frac{Q k_{\\mathrm{TF}}^{2}}{4\\pi e r} \\exp(-k_{\\mathrm{TF}}r) $$\n这个表达式描述了屏蔽外部电荷的感生电子密度云。\n\n**第三部分：总感生电荷的验证**\n\n总感生电荷 $Q_{\\mathrm{ind}}$ 是感生电荷密度在整个空间上的积分：\n$$ Q_{\\mathrm{ind}} = \\int d^3r \\, \\rho_{\\mathrm{ind}}(\\mathbf{r}) $$\n利用傅里叶变换的性质，这等于傅里叶变换后的密度在 $\\mathbf{q}=0$ 处的值：\n$$ Q_{\\mathrm{ind}} = \\rho_{\\mathrm{ind}}(\\mathbf{q}=0) $$\n从第一部分，我们有 $\\rho_{\\mathrm{ind}}(\\mathbf{q}) = Q \\left( \\frac{1}{\\epsilon(\\mathbf{q})} - 1 \\right)$。我们需要在 $\\mathbf{q} \\to 0$ 的极限下计算它。对于金属（电子气模型所模拟的对象），介电函数在零波矢处发散，表示对静电荷的完美屏蔽。特别地，在 Thomas–Fermi 模型中：\n$$ \\lim_{q\\to 0} \\epsilon(\\mathbf{q}) = \\lim_{q\\to 0} \\left( 1 + \\frac{k_{\\mathrm{TF}}^{2}}{q^2} \\right) = \\infty $$\n因此，介电函数的倒数在此极限下为零：\n$$ \\lim_{q\\to 0} \\frac{1}{\\epsilon(\\mathbf{q})} = 0 $$\n将此代入 $Q_{\\mathrm{ind}}$ 的表达式：\n$$ Q_{\\mathrm{ind}} = \\lim_{\\mathbf{q}\\to 0} Q \\left( \\frac{1}{\\epsilon(\\mathbf{q})} - 1 \\right) = Q(0 - 1) = -Q $$\n这个结果证实了电子气中的总感生电荷与外部电荷大小完全相等、符号相反，从而导致在大距离上的完美屏蔽。此验证仅使用了傅里叶空间表达式和 $\\epsilon(\\mathbf{q})$ 在长波长下的行为，符合题目要求。", "answer": "$$\n\\boxed{\\frac{Q k_{\\mathrm{TF}}^{2}}{4 \\pi e r} \\exp(-k_{\\mathrm{TF}} r)}\n$$", "id": "3014987"}, {"introduction": "许多现代材料，如石墨烯和半导体异质结，其行为本质上是二维的。下一个练习将探讨一个深刻的问题：当电子被限制在一个平面上时，电荷屏蔽的行为与在三维空间中有何不同？通过对比三维（3D）和二维（2D）电子气中的托马斯-费米屏蔽长度，您会发现2D系统中的屏蔽在长距离下会显著减弱，并且不能用简单的汤川势（Yukawa potential）来描述 [@problem_id:3014924]。这个实践揭示了维度对多体相互作用的深远影响，这是理解低维材料物理特性的关键一步。", "problem": "在 Thomas–Fermi (TF) 近似下，考虑固体中巡游电子的静态屏蔽效应。采用高斯单位制，并设背景介电常数为1。设一个数密度为 $n$、化学势为 $\\mu$ 的均匀电子液体，受到一个位于原点的外部点电荷 $Q$ 产生的弱慢变静电势 $\\phi(\\mathbf{r})$ 的微扰。假设零温、抛物线能带和线性响应，使得密度变化满足 $\\delta n(\\mathbf{r}) = (\\partial n / \\partial \\mu)\\,e\\,\\phi(\\mathbf{r})$。感生电荷密度为 $\\rho_{\\mathrm{ind}}(\\mathbf{r}) = -e\\,\\delta n(\\mathbf{r})$。\n\nA部分（三维）：在三维空间中，使用静态麦克斯韦方程（高斯定律）和线性响应，构建并求解类TF屏蔽尺度 $\\kappa_{\\mathrm{3D}}$，该尺度表征了屏蔽库仑相互作用在小波矢极限下的特征。请用 $e$ 和 $\\partial n / \\partial \\mu$ 纯粹地表示 $\\kappa_{\\mathrm{3D}}$。\n\nB部分（二维）：考虑一个严格限制在 $z=0$ 平面内的二维电子液体，但它们之间通过三维库仑定律相互作用。利用面内傅里叶分量 $\\phi(\\mathbf{q}, z=0)$ 与面电荷密度 $\\rho(\\mathbf{q})\\,\\delta(z)$ 之间的静电关系，并结合相同的线性响应，求出进入屏蔽面内相互作用小波矢极限的类TF屏蔽尺度 $\\kappa_{\\mathrm{2D}}$。请用 $e$ 和 $\\partial n / \\partial \\mu$ 纯粹地表示 $\\kappa_{\\mathrm{2D}}$。\n\nC部分（概念）：根据您的推导，解释为什么实空间中的局域汤川形式势通常不能描述嵌入三维空间中的平面的二维屏蔽效应。\n\n以单一表达式给出最终答案，即 $\\kappa_{\\mathrm{3D}}$ 和 $\\kappa_{\\mathrm{2D}}$ 对。最终的屏蔽波矢以逆长度单位表示（高斯单位制，背景介电常数为1）。无需进行数值计算。", "solution": "本题探讨了 Thomas-Fermi 近似下电子液体中的静电荷屏蔽概念。该系统是一个受外部点电荷微扰的电子气。我们分别推导了三维和二维系统的屏蔽性质。分析依赖于将线性响应理论与静态麦克斯韦方程相结合。\n\n在整个推导过程中，我们采用高斯单位制，且背景介电常数设为1 ($\\epsilon_b = 1$)。温度假定为零 ($T=0$)。\n\n给出的基本方程是：\n1.  在弱静电势 $\\phi(\\mathbf{r})$ 存在的情况下，电子密度变化 $\\delta n(\\mathbf{r})$ 的线性响应关系：\n    $$\n    \\delta n(\\mathbf{r}) = \\left(\\frac{\\partial n}{\\partial \\mu}\\right) e \\phi(\\mathbf{r})\n    $$\n    其中 $n$ 是电子数密度，$\\mu$ 是化学势， $e$ 是元电荷。量 $(\\partial n / \\partial \\mu)$ 是费米能级上的热力学态密度。\n2.  感生电荷密度 $\\rho_{\\mathrm{ind}}(\\mathbf{r})$ 与电子密度变化的关系为：\n    $$\n    \\rho_{\\mathrm{ind}}(\\mathbf{r}) = -e \\delta n(\\mathbf{r})\n    $$\n    结合这两个关系，我们得到感生电荷密度以局域势表示的本构关系：\n    $$\n    \\rho_{\\mathrm{ind}}(\\mathbf{r}) = -e^2 \\left(\\frac{\\partial n}{\\partial \\mu}\\right) \\phi(\\mathbf{r})\n    $$\n    这种局域关系是 Thomas-Fermi 近似的一个关键特征。\n\n**A部分：三维屏蔽**\n\n在三维空间中，总静电势 $\\phi(\\mathbf{r})$ 由泊松方程决定：\n$$\n\\nabla^2 \\phi(\\mathbf{r}) = -4\\pi \\rho_{\\mathrm{tot}}(\\mathbf{r})\n$$\n总电荷密度 $\\rho_{\\mathrm{tot}}(\\mathbf{r})$ 是位于原点的外部点电荷 $Q$ 和感生电荷密度 $\\rho_{\\mathrm{ind}}(\\mathbf{r})$ 的和：\n$$\n\\rho_{\\mathrm{tot}}(\\mathbf{r}) = \\rho_{\\mathrm{ext}}(\\mathbf{r}) + \\rho_{\\mathrm{ind}}(\\mathbf{r}) = Q\\delta(\\mathbf{r}) + \\rho_{\\mathrm{ind}}(\\mathbf{r})\n$$\n将总电荷密度和感生电荷密度的表达式代入泊松方程，得到：\n$$\n\\nabla^2 \\phi(\\mathbf{r}) = -4\\pi \\left( Q\\delta(\\mathbf{r}) - e^2 \\left(\\frac{\\partial n}{\\partial \\mu}\\right) \\phi(\\mathbf{r}) \\right)\n$$\n整理各项，我们得到屏蔽泊松方程：\n$$\n\\left( \\nabla^2 - 4\\pi e^2 \\frac{\\partial n}{\\partial \\mu} \\right) \\phi(\\mathbf{r}) = -4\\pi Q\\delta(\\mathbf{r})\n$$\n该方程的形式为 $(\\nabla^2 - \\kappa^2) \\phi(\\mathbf{r}) = -4\\pi Q\\delta(\\mathbf{r})$，它描述了具有特征逆长度尺度 $\\kappa$ 的屏蔽效应。通过直接比较，我们确定了三维 Thomas-Fermi 屏蔽波矢的平方 $\\kappa_{\\mathrm{3D}}^2$：\n$$\n\\kappa_{\\mathrm{3D}}^2 = 4\\pi e^2 \\frac{\\partial n}{\\partial \\mu}\n$$\n此处，$n$ 是体数密度（单位为 长度$^{-3}$），而 $(\\partial n / \\partial \\mu)$ 的单位为（能量 $\\cdot$ 体积）$^{-1}$。\n因此，屏蔽尺度 $\\kappa_{\\mathrm{3D}}$ 为：\n$$\n\\kappa_{\\mathrm{3D}} = \\sqrt{4\\pi e^2 \\frac{\\partial n}{\\partial \\mu}}\n$$\n该表达式按要求纯粹地依赖于 $e$ 和 $\\partial n / \\partial \\mu$。该方程的解是著名的汤川势，$\\phi(\\mathbf{r}) = Q \\exp(-\\kappa_{\\mathrm{3D}} r)/r$，其中 $r = |\\mathbf{r}|$。\n\n**B部分：二维屏蔽**\n\n在这种情况下，电子液体被限制在 $z=0$ 平面内，形成二维电子气 (2DEG)。电荷密度是在 $xy$ 平面中定义的面密度。我们将面内位置矢量表示为 $\\mathbf{r}_{||}$，其傅里叶共轭波矢表示为 $\\mathbf{q}$。三维空间中的总电荷密度为 $\\rho(\\mathbf{r}) = \\rho_{\\mathrm{sh,tot}}(\\mathbf{r}_{||}) \\delta(z)$，其中 $\\rho_{\\mathrm{sh,tot}}$ 是总面电荷密度。\n\n我们在傅里叶空间中进行计算。使用混合表示法，分析最为清晰：在 $xy$ 平面进行傅里叶变换，而在 $z$ 坐标上使用实空间表示。泊松方程变为：\n$$\n\\left(\\frac{\\partial^2}{\\partial z^2} - q^2\\right) \\phi(\\mathbf{q}, z) = -4\\pi \\rho_{\\mathrm{sh,tot}}(\\mathbf{q}) \\delta(z)\n$$\n其中 $q = |\\mathbf{q}|$。对于 $z \\neq 0$ 的解是 $\\phi(\\mathbf{q}, z) = A \\exp(-q|z|)$。对该方程在 $z=0$ 两侧进行积分，得到将电场跳变与面电荷联系起来的边界条件。这给出了平面内的电势 $\\phi(\\mathbf{q}, z=0)$ 与总面电荷密度 $\\rho_{\\mathrm{sh,tot}}(\\mathbf{q})$ 之间的直接关系：\n$$\n\\phi(\\mathbf{q}, z=0) = \\frac{2\\pi}{q} \\rho_{\\mathrm{sh,tot}}(\\mathbf{q})\n$$\n这个关系捕捉了通过三维库仑定律相互作用的二维面电荷的静电学特性。总面电荷是外部部分和感生部分之和：\n$$\n\\rho_{\\mathrm{sh,tot}}(\\mathbf{q}) = \\rho_{\\mathrm{sh,ext}}(\\mathbf{q}) + \\rho_{\\mathrm{sh,ind}}(\\mathbf{q})\n$$\n应用于二维平面的线性响应关系为：\n$$\n\\rho_{\\mathrm{sh,ind}}(\\mathbf{q}) = -e^2 \\left(\\frac{\\partial n}{\\partial \\mu}\\right) \\phi(\\mathbf{q}, z=0)\n$$\n此处，$n$ 是面数密度（单位为 长度$^{-2}$），而 $(\\partial n / \\partial \\mu)$ 的单位为（能量 $\\cdot$ 面积）$^{-1}$。\n将其代入总面电荷的表达式，得到：\n$$\n\\rho_{\\mathrm{sh,tot}}(\\mathbf{q}) = \\rho_{\\mathrm{sh,ext}}(\\mathbf{q}) - e^2 \\left(\\frac{\\partial n}{\\partial \\mu}\\right) \\phi(\\mathbf{q}, z=0)\n$$\n现在我们代入 $\\phi(\\mathbf{q}, z=0)$ 的静电关系式：\n$$\n\\rho_{\\mathrm{sh,tot}}(\\mathbf{q}) = \\rho_{\\mathrm{sh,ext}}(\\mathbf{q}) - e^2 \\left(\\frac{\\partial n}{\\partial \\mu}\\right) \\frac{2\\pi}{q} \\rho_{\\mathrm{sh,tot}}(\\mathbf{q})\n$$\n求解 $\\rho_{\\mathrm{sh,tot}}(\\mathbf{q})$：\n$$\n\\rho_{\\mathrm{sh,tot}}(\\mathbf{q}) \\left(1 + \\frac{2\\pi e^2}{q} \\frac{\\partial n}{\\partial \\mu}\\right) = \\rho_{\\mathrm{sh,ext}}(\\mathbf{q})\n$$\n那么，平面内的屏蔽势为：\n$$\n\\phi(\\mathbf{q}, z=0) = \\frac{2\\pi}{q} \\rho_{\\mathrm{sh,tot}}(\\mathbf{q}) = \\frac{2\\pi}{q} \\frac{\\rho_{\\mathrm{sh,ext}}(\\mathbf{q})}{1 + \\frac{2\\pi e^2}{q} \\frac{\\partial n}{\\partial \\mu}}\n$$\n$$\n\\phi(\\mathbf{q}, z=0) = \\frac{2\\pi \\rho_{\\mathrm{sh,ext}}(\\mathbf{q})}{q + 2\\pi e^2 \\frac{\\partial n}{\\partial \\mu}}\n$$\n此表达式具有 $\\phi(\\mathbf{q}) \\propto 1/(q + \\kappa_{\\mathrm{2D}})$ 的形式。通过比较，我们确定了二维 Thomas-Fermi 屏蔽尺度 $\\kappa_{\\mathrm{2D}}$：\n$$\n\\kappa_{\\mathrm{2D}} = 2\\pi e^2 \\frac{\\partial n}{\\partial \\mu}\n$$\n对于二维情况，该表达式按要求纯粹地依赖于 $e$ 和 $\\partial n / \\partial \\mu$。\n\n**C部分：概念解释**\n\n局域汤川形式势 $\\phi(r) \\propto \\exp(-\\kappa r)/r$ 是一个屏蔽势的实空间表示，其傅里叶变换形式为 $\\phi(k) \\propto 1/(k^2 + \\kappa^2)$。如A部分所示，这种结构出现在三维中，其中屏蔽项 $\\kappa_{\\mathrm{3D}}^2$ 被加到源于拉普拉斯算符 $\\nabla^2$ 的 $k^2$ 项上。屏蔽由一个恒定的屏蔽长度 $1/\\kappa_{\\mathrm{3D}}$ 来描述。\n\n相比之下，对于嵌入在三维空间中的二维电子气，如B部分所推导的，平面内的屏蔽势在傅里叶空间中的形式为 $\\phi(q) \\propto 1/(q + \\kappa_{\\mathrm{2D}})$。关键的区别在于对波矢大小 $q$ 的线性依赖，而非 $q^2$。这个线性的 $q$ 项是限制在二维平面内的电荷所经历的三维库仑相互作用的直接结果；傅里叶空间中的未屏蔽势为 $V_0(q) \\propto 1/q$。\n\n屏蔽项 $\\kappa_{\\mathrm{2D}}$ 是一个常数（在TF近似中），而未屏蔽项依赖于 $q$。这使得屏蔽效应本质上是长程的且依赖于波矢。由介电函数 $\\epsilon(q) = 1 + \\kappa_{\\mathrm{2D}}/q$ 所表征的屏蔽效率在长波长（$q \\to 0$）时非常强，但在短波长（$q \\to \\infty$）时减弱。\n\n$1/(q + \\kappa_{\\mathrm{2D}})$ 的傅里叶逆变换到实空间并不产生一个简单的汤川函数。得到的势涉及 Struve 函数和 Bessel 函数的组合，并表现出不同的渐近行为。在短距离（$r_{||} \\to 0$）处，它恢复为未屏蔽的 $1/r_{||}$ 库仑势。在长距离（$r_{||} \\to \\infty$）处，它以幂律形式衰减，$\\phi(r_{||}) \\propto 1/r_{||}^3$，这比汤川势的指数衰减要弱得多。这种代数衰减是二维系统中屏蔽效应的一个特征性标志。因此，意味着指数屏蔽的局域汤川势，在这种二维背景下不能正确描述屏蔽势的长程行为。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sqrt{4\\pi e^{2} \\frac{\\partial n}{\\partial \\mu}} & 2\\pi e^{2} \\frac{\\partial n}{\\partial \\mu}\n\\end{pmatrix}\n}\n$$", "id": "3014924"}, {"introduction": "虽然解析模型为我们提供了宝贵的物理直觉，但定量的预测往往需要数值计算。本章的最后一个实践将引导您从解析推导走向计算机模拟，这也是现代凝聚态物理研究的常态。您将基于随机相近似（Random Phase Approximation, RPA）的林哈德（Lindhard）介电函数，编写程序来数值计算不同电子密度下的屏蔽相互作用 $W(q)$ [@problem_id:3014978]。这个练习不仅能让您直观地看到屏蔽效应如何依赖于动量 $q$ 和电子密度（通过 $r_s$ 参数化），还能让您学会如何将抽象的理论公式转化为可执行的代码，并从中分析出物理上有意义的结果，例如强屏蔽和弱屏蔽的动量范围。", "problem": "考虑一个固体中处于静态极限下的三维均匀电子气。从静电学和线性响应理论的基本原理出发，对静态外部电荷分布的屏蔽效应可以通过一个依赖于动量的介电函数 $ \\epsilon(q) $ 和一个屏蔽相互作用 $ W(q) $ 来描述。在随机相近似（RPA）中，$ \\epsilon(q) $ 可以由裸库仑相互作用和电子气的无相互作用密度-密度响应函数构造而成。设电子密度由Wigner-Seitz半径 $ r_s $ 参数化，其定义为 $ n = \\frac{3}{4\\pi (r_s a_0)^3} $，其中 $ a_0 $ 是玻尔半径。费米波矢为 $ k_F = (3\\pi^2 n)^{1/3} $。采用傅里叶变换约定 $ f(\\mathbf{r}) = \\int \\frac{d^3 q}{(2\\pi)^3} e^{i \\mathbf{q}\\cdot \\mathbf{r}} f(\\mathbf{q}) $，并对所有物理量使用国际单位制（SI）。在此约定下的SI单位制中，动量空间中的裸库仑相互作用为 $ v(q) $，屏蔽相互作用为 $ W(q) = \\frac{v(q)}{\\epsilon(q)} $。\n\n您必须从以下基本基础出发构建程序：\n- SI单位制中的泊松方程 $ \\nabla \\cdot (\\epsilon_0 \\mathbf{E}) = \\rho $，其中 $ \\mathbf{E} = -\\nabla \\phi $，以及在所述傅里叶变换约定下动量空间中库仑势的定义。\n- 线性响应的定义：一个静态外部势 $ \\phi_{\\mathrm{ext}}(\\mathbf{q}) $ 会引起一个密度涨落 $ \\delta n(\\mathbf{q}) $，该涨落与无相互作用的密度-密度响应函数 $ \\chi^0(q,0) $ 相关。\n- 连接 $ \\delta n(\\mathbf{q}) $、$ v(q) $ 和 $ \\phi(\\mathbf{q}) $ 的RPA自洽关系，从而导出介电函数 $ \\epsilon(q) $ 和屏蔽相互作用 $ W(q) $。\n\n您的任务是：\n1. 基于上述基础，推导出一个物理上正确且适合对三维均匀电子气在零温下进行数值计算的 $ \\epsilon(q) $ 的表达式，明确用 $ r_s $ 和 $ q $ 表示，然后计算 $ W(q) $。\n2. 对于每个给定的 $ r_s $，在一个由 $ N = 200 $ 个点组成的动量网格 $ \\{ q_i \\} $ 上计算 $ \\epsilon(q) $ 和 $ W(q) $，其中 $ q_i $ 在 $ 0.05\\,k_F $ 到 $ 3.0\\,k_F $ 之间线性间隔。在计算中避免奇异点，确保科学真实性和数值稳定性。\n3. 通过基于比率 $ S(q) = \\frac{W(q)}{v(q)} = \\frac{1}{\\epsilon(q)} $ 的算法分类，识别动量空间中的弱屏蔽和强屏蔽区域：\n   - 强屏蔽区域，其中 $ S(q) \\leq 0.5 $。\n   - 弱屏蔽区域，其中 $ S(q) \\geq 0.9 $。\n   - 其他情况为过渡区域。\n4. 对每个测试用例，计算以下可量化的输出：\n   - 动量网格中处于强屏蔽区域的比例，以小数表示（无百分号）。\n   - 动量网格中处于弱屏蔽区域的比例，以小数表示（无百分号）。\n   - 强屏蔽区域中的最大 $ q $，以无量纲比值 $ q/k_F $ 报告；若该区域中没有 $ q $，则报告 $ \\mathrm{NaN} $。\n   - 弱屏蔽区域中的最小 $ q $，以无量纲比值 $ q/k_F $ 报告；若该区域中没有 $ q $，则报告 $ \\mathrm{NaN} $。\n\n使用以下涵盖不同密度和屏蔽强度的Wigner-Seitz半径测试套件：\n- $ r_s = 0.5 $（高密度，预计在小 $ q $ 处有较强屏蔽）。\n- $ r_s = 2.0 $（中等密度）。\n- $ r_s = 5.0 $（低密度，预计屏蔽较弱）。\n\n所有物理常数必须使用SI单位：元电荷 $ e $（库仑），真空介电常数 $ \\epsilon_0 $（法拉/米），约化普朗克常数 $ \\hbar $（焦耳·秒），电子质量 $ m $（千克），以及玻尔半径 $ a_0 $（米）。动量 $ q $ 的单位必须是米-1。所要求的输出是无量纲的小数和比率，因此最终数值答案无需附加单位。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献一个如上所述包含四个小数的列表。例如，一个有效的输出格式是 $ [ [x_1,x_2,x_3,x_4],[y_1,y_2,y_3,y_4],[z_1,z_2,z_3,z_4] ] $，其中每个 $ x_i $、$ y_i $ 和 $ z_i $ 是一个小数或在适用时为 $ \\mathrm{NaN} $。", "solution": "该问题是凝聚态物理学的基础模型——均匀电子气多体理论中的一个标准练习。它要求在随机相近似（RPA）内推导和数值计算静态介电函数 $\\epsilon(q)$，并随后分析屏蔽行为。该问题具有科学依据，提法明确，并提供了所有必要的参数和定义。因此，我们认为它是有效的。我们将采用严谨的、基于第一性原理的求解方法。\n\n静态介电函数 $\\epsilon(q)$ 的推导始于所规定的静电学和线性响应理论的基本原理。\n\n一个微扰均匀电子气的外部静电势 $\\phi_{\\mathrm{ext}}(\\mathbf{q})$ 会引起电子密度的变化 $\\delta n(\\mathbf{q})$。在RPA的自洽场近似中，电子响应的不是单独的外部势，而是总的、被屏蔽的势 $\\phi_{\\mathrm{tot}}(\\mathbf{q})$。这个总势是外部势和由感生密度本身产生的感生势 $\\phi_{\\mathrm{ind}}(\\mathbf{q})$ 之和。\n$$ \\phi_{\\mathrm{tot}}(\\mathbf{q}) = \\phi_{\\mathrm{ext}}(\\mathbf{q}) + \\phi_{\\mathrm{ind}}(\\mathbf{q}) $$\n\n问题定义了无相互作用的密度-密度响应函数 $\\chi^0(q)$，它将感生密度与电子感受到的总势联系起来。对于静态微扰，这种线性响应关系为：\n$$ \\delta n(\\mathbf{q}) = \\chi^0(q) \\phi_{\\mathrm{tot}}(\\mathbf{q}) $$\n正确识别 $\\chi^0(q)$ 至关重要。在标准文献中，密度-密度关联函数 $\\chi_{nn}^{(0)}(q)$ 将感生密度与势*能*的微扰 $\\delta V_{\\mathrm{tot}}(\\mathbf{q}) = -e \\phi_{\\mathrm{tot}}(\\mathbf{q})$ 联系起来，其中 $-e$ 是电子电荷。因此，$\\delta n(\\mathbf{q}) = \\chi_{nn}^{(0)}(q) (-e \\phi_{\\mathrm{tot}}(\\mathbf{q}))$。与问题的定义相比较，我们确定 $\\chi^0(q) = -e \\chi_{nn}^{(0)}(q)$。\n\n感生势 $\\phi_{\\mathrm{ind}}(\\mathbf{q})$ 由感生电荷密度 $\\rho_{\\mathrm{ind}}(\\mathbf{q}) = -e \\delta n(\\mathbf{q})$ 产生。根据傅里叶空间中的泊松方程 $q^2 \\phi(\\mathbf{q}) = \\rho(\\mathbf{q})/\\epsilon_0$，我们有：\n$$ \\phi_{\\mathrm{ind}}(\\mathbf{q}) = \\frac{\\rho_{\\mathrm{ind}}(\\mathbf{q})}{\\epsilon_0 q^2} = \\frac{-e \\delta n(\\mathbf{q})}{\\epsilon_0 q^2} $$\n\n现在我们通过代入 $\\delta n(\\mathbf{q})$ 的表达式来构建自洽方程：\n$$ \\phi_{\\mathrm{ind}}(\\mathbf{q}) = -\\frac{e}{\\epsilon_0 q^2} \\left[ \\chi^0(q) \\phi_{\\mathrm{tot}}(\\mathbf{q}) \\right] $$\n将此式代入总势的方程中：\n$$ \\phi_{\\mathrm{tot}}(\\mathbf{q}) = \\phi_{\\mathrm{ext}}(\\mathbf{q}) - \\frac{e \\chi^0(q)}{\\epsilon_0 q^2} \\phi_{\\mathrm{tot}}(\\mathbf{q}) $$\n整理以求解 $\\phi_{\\mathrm{tot}}(\\mathbf{q})$ 得：\n$$ \\phi_{\\mathrm{tot}}(\\mathbf{q}) \\left( 1 + \\frac{e \\chi^0(q)}{\\epsilon_0 q^2} \\right) = \\phi_{\\mathrm{ext}}(\\mathbf{q}) $$\n介电函数 $\\epsilon(q)$ 定义为外部势与总势之比，即 $\\epsilon(q) = \\phi_{\\mathrm{ext}}(q) / \\phi_{\\mathrm{tot}}(q)$。因此：\n$$ \\epsilon(q) = 1 + \\frac{e \\chi^0(q)}{\\epsilon_0 q^2} $$\n利用我们的识别 $\\chi^0(q) = -e \\chi_{nn}^{(0)}(q)$ 并回顾裸库仑相互作用的定义 $v(q) = e^2/(\\epsilon_0 q^2)$，我们得到了标准的RPA表达式：\n$$ \\epsilon(q) = 1 - \\frac{e^2}{\\epsilon_0 q^2} \\chi_{nn}^{(0)}(q) = 1 - v(q) \\chi_{nn}^{(0)}(q) $$\n\n下一步是获得三维电子气在零温（$T=0$）下静态无相互作用密度-密度响应函数 $\\chi_{nn}^{(0)}(q)$ 的表达式。这由Lindhard函数给出：\n$$ \\chi_{nn}^{(0)}(q) = -D(\\varepsilon_F) \\left[ \\frac{1}{2} + \\frac{k_F}{2q} \\left(1 - \\frac{q^2}{4k_F^2}\\right) \\ln \\left| \\frac{q+2k_F}{q-2k_F} \\right| \\right] $$\n其中 $k_F$ 是费米波矢，$D(\\varepsilon_F)$ 是费米能级处的态密度（包括自旋），由 $D(\\varepsilon_F) = m k_F / (\\pi^2 \\hbar^2)$ 给出。\n\n将此代入 $\\epsilon(q)$ 的表达式中，我们得到：\n$$ \\epsilon(q) = 1 + \\frac{e^2}{\\epsilon_0 q^2} \\frac{m k_F}{\\pi^2 \\hbar^2} \\left[ \\frac{1}{2} + \\frac{4k_F^2 - q^2}{8k_F q} \\ln \\left| \\frac{2k_F+q}{2k_F-q} \\right| \\right] $$\n前置因子被识别为Thomas-Fermi屏蔽波矢的平方，$k_{TF}^2 = e^2 D(\\varepsilon_F)/\\epsilon_0 = e^2 m k_F / (\\epsilon_0 \\pi^2 \\hbar^2)$。所以，\n$$ \\epsilon(q) = 1 + \\frac{k_{TF}^2}{q^2} \\left[ \\frac{1}{2} + \\frac{4k_F^2 - q^2}{8k_F q} \\ln \\left| \\frac{2k_F+q}{2k_F-q} \\right| \\right] $$\n\n为了进行数值计算，我们使用Wigner-Seitz半径 $r_s$ 和无量纲动量 $q_d = q/k_F$ 将所有量表示为无量纲形式。\n费米波矢为 $k_F = (3\\pi^2 n)^{1/3}$。由于 $n = 3/(4\\pi(r_s a_0)^3)$，我们有 $k_F = (\\frac{9\\pi}{4})^{1/3} \\frac{1}{r_s a_0}$。\nThomas-Fermi波矢可以与 $k_F$ 和 $a_0$ 相关联：$k_{TF}^2 = 4k_F/(\\pi a_0)$。\n因此，比值 $(k_{TF}/k_F)^2$ 可以用 $r_s$ 表示：\n$$ \\left(\\frac{k_{TF}}{k_F}\\right)^2 = \\frac{4}{\\pi a_0 k_F} = \\frac{4}{\\pi a_0} \\frac{r_s a_0}{(9\\pi/4)^{1/3}} = \\frac{4 r_s}{\\pi (9\\pi/4)^{1/3}} $$\n我们定义一个无量纲常数 $C = \\frac{4}{\\pi (9\\pi/4)^{1/3}}$。那么 $k_{TF}^2/q^2$ 项变为：\n$$ \\frac{k_{TF}^2}{q^2} = \\frac{1}{(q/k_F)^2} \\left(\\frac{k_{TF}}{k_F}\\right)^2 = \\frac{C r_s}{q_d^2} $$\n括号中的项，即Lindhard响应因子 $L(q_d)$，变为：\n$$ L(q_d) = \\left[ \\frac{1}{2} + \\frac{4 - q_d^2}{8 q_d} \\ln \\left| \\frac{2+q_d}{2-q_d} \\right| \\right] $$\n用于计算的最终表达式是完全无量纲的：\n$$ \\epsilon(q_d; r_s) = 1 + \\frac{C r_s}{q_d^2} L(q_d) $$\n对于每个 $r_s$，在从 $0.05$ 到 $3.0$ 线性间隔的 $N=200$ 个 $q_d$ 值组成的网格上计算该表达式。请注意，对数项的导数在 $q_d=2$ 处有一个奇点，但函数 $L(q_d)$ 本身是连续的，其值为 $L(q_d=2) = 1/2$。我们的数值网格不会精确地触及这一点，但稳健的实现应注意其附近的行为。\n\n计算出 $\\epsilon(q)$ 后，屏蔽比计算为 $S(q) = W(q)/v(q) = 1/\\epsilon(q)$。然后将动量网格上的 $S(q)$ 值分类为强屏蔽（$S(q) \\leq 0.5$）、弱屏蔽（$S(q) \\geq 0.9$）和过渡区域。根据此分类，我们提取所需的度量：强屏蔽和弱屏蔽区域的比例，强屏蔽区域中的最大 $q/k_F$，以及弱屏蔽区域中的最小 $q/k_F$。如果某个区域为空，则相应的量报告为非数字（NaN）。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the charge screening problem for a 3D homogeneous electron gas.\n    Derives and evaluates the RPA dielectric function to classify screening regimes.\n    \"\"\"\n\n    def calculate_screening_metrics(rs: float, q_grid_dimless: np.ndarray):\n        \"\"\"\n        Calculates screening metrics for a given Wigner-Seitz radius (rs).\n\n        Args:\n            rs: The Wigner-Seitz radius (dimensionless).\n            q_grid_dimless: A NumPy array of dimensionless momenta q/k_F.\n\n        Returns:\n            A list containing four metrics:\n            - Fraction of the grid in the strong screening regime.\n            - Fraction of the grid in the weak screening regime.\n            - Largest q/k_F in the strong regime (NaN if none).\n            - Smallest q/k_F in the weak regime (NaN if none).\n        \"\"\"\n        N = len(q_grid_dimless)\n        \n        # Constant C from the derivation: C = 4 / (pi * (9*pi/4)^(1/3))\n        C = 4.0 / (np.pi * np.power(9.0 * np.pi / 4.0, 1.0 / 3.0))\n\n        # The term q_d = q/k_F has a special point at q_d=2\n        # where the derivative of the Lindhard function diverges.\n        # The function itself is continuous and numerically stable near this point.\n        q_d = q_grid_dimless\n\n        # Calculate the Lindhard response factor L(q_d)\n        log_term = np.log(np.abs((2.0 + q_d) / (2.0 - q_d)))\n        lindhard_factor = 0.5 + ((4.0 - q_d**2) / (8.0 * q_d)) * log_term\n        \n        # Calculate the dielectric function epsilon(q)\n        # epsilon = 1 + (C * rs / q_d^2) * L(q_d)\n        epsilon = 1.0 + (C * rs / (q_d**2)) * lindhard_factor\n\n        # Calculate the screening ratio S(q) = 1 / epsilon(q)\n        s_q = 1.0 / epsilon\n        \n        # Classify screening regimes\n        is_strong = s_q = 0.5\n        is_weak = s_q >= 0.9\n\n        # 1. Fraction of the momentum grid in the strong screening regime\n        frac_strong = np.count_nonzero(is_strong) / N\n\n        # 2. Fraction of the momentum grid in the weak screening regime\n        frac_weak = np.count_nonzero(is_weak) / N\n\n        # 3. Largest q/k_F in the strong screening regime\n        strong_q_values = q_d[is_strong]\n        max_q_strong = np.max(strong_q_values) if strong_q_values.size > 0 else np.nan\n\n        # 4. Smallest q/k_F in the weak screening regime\n        weak_q_values = q_d[is_weak]\n        min_q_weak = np.min(weak_q_values) if weak_q_values.size > 0 else np.nan\n\n        return [frac_strong, frac_weak, max_q_strong, min_q_weak]\n\n    # Define the test cases from the problem statement.\n    test_cases_rs = [0.5, 2.0, 5.0]\n\n    # Define the momentum grid\n    N = 200\n    q_grid_dimless = np.linspace(0.05, 3.0, N)\n\n    results = []\n    for rs in test_cases_rs:\n        metrics = calculate_screening_metrics(rs, q_grid_dimless)\n        results.append(metrics)\n\n    # Format the final output string to match the required format `[[...],[...]]`\n    def format_num(val):\n        if np.isnan(val):\n            return 'NaN'\n        # Format to a sufficient number of decimal places for precision\n        return f\"{val:.8f}\"\n        \n    inner_lists_str = []\n    for res_list in results:\n        # Using custom number formatter to handle NaNs and precision\n        s = '[' + ','.join([format_num(x) for x in res_list]) + ']'\n        inner_lists_str.append(s)\n    \n    final_output = '[' + ','.join(inner_lists_str) + ']'\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "3014978"}]}