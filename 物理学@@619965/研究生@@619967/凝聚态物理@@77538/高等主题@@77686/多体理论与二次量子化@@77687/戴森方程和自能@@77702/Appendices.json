{"hands_on_practices": [{"introduction": "在多体理论中，自能是对粒子间相互作用导致其传播性质改变的根本描述。第一个练习将引导我们计算最简单、也最直观的自能近似——哈特里 (Hartree) 自能。通过这个练习 [@problem_id:2983409]，你将亲手推导在一个局域相互作用模型中，电子如何感受到由其他所有电子产生的平均势场，从而深刻理解自能与平均场理论之间的直接联系。", "problem": "考虑一个平移不变晶格上的自旋-$\\frac{1}{2}$电子，其无相互作用的哈密顿量 $H_{0}$ 在动量空间中是对角化的，并且其在位相互作用由Hubbard形式 $H_{\\text{int}} = U \\sum_{i} n_{i\\uparrow} n_{i\\downarrow}$ 描述，其中 $U$ 是一个实常数，$n_{i\\sigma} = c_{i\\sigma}^{\\dagger} c_{i\\sigma}$，且 $c_{i\\sigma}$ 在格点 $i$ 上湮灭一个自旋为 $\\sigma$ 的电子。在虚时形式下，使用热力学单粒子格林函数 $G_{\\sigma}(i\\omega_{n},\\mathbf{k})$ 和Dyson方程，\n$$\nG_{\\sigma}^{-1}(i\\omega_{n},\\mathbf{k}) = G_{0,\\sigma}^{-1}(i\\omega_{n},\\mathbf{k}) - \\Sigma_{\\sigma}(i\\omega_{n},\\mathbf{k}) ,\n$$\n其中 $G_{0,\\sigma}$ 是无相互作用的格林函数，$\\Sigma_{\\sigma}$ 是自能。使用多体微扰理论对 $U$ 取一阶近似（Hartree近似），从第一性原理出发，推导为何Hartree自能 $\\Sigma_{\\sigma}^{\\text{H}}(i\\omega_{n},\\mathbf{k})$ 与动量 $\\mathbf{k}$ 无关，并在顺磁性正常态（其中 $n_{\\uparrow} = n_{\\downarrow} = n/2$）下，求出其以总粒子密度 $n$ 表示的值。请将最终答案表示为单个闭合形式的解析表达式。不需要进行数值计算，也无需单位。", "solution": "该问题要求推导Hubbard模型的一阶自能（Hartree近似）及其在顺磁态下的值。\n\n总哈密顿量为 $H = H_0 + H_{\\text{int}}$，其中 $H_0$ 是无相互作用部分，在动量空间中是对角的，具有单粒子能量 $\\epsilon_{\\mathbf{k}}$；$H_{\\text{int}}$ 是在位Hubbard相互作用：\n$$H_{\\text{int}} = U \\sum_{i} n_{i\\uparrow} n_{i\\downarrow} = U \\sum_{i} c_{i\\uparrow}^{\\dagger} c_{i\\uparrow} c_{i\\downarrow}^{\\dagger} c_{i\\downarrow}$$\n其中 $U$ 是相互作用强度，$c_{i\\sigma}^{\\dagger}$（$c_{i\\sigma}$）在格点 $i$ 上产生（湮灭）一个自旋为 $\\sigma \\in \\{\\uparrow, \\downarrow\\}$ 的电子。\n\n自能 $\\Sigma_{\\sigma}(i\\omega_{n},\\mathbf{k})$ 由Dyson方程定义：\n$$G_{\\sigma}^{-1}(i\\omega_{n},\\mathbf{k}) = G_{0,\\sigma}^{-1}(i\\omega_{n},\\mathbf{k}) - \\Sigma_{\\sigma}(i\\omega_{n},\\mathbf{k})$$\n其中 $G_{\\sigma}$ 是全格林函数，$G_{0,\\sigma}$ 是无相互作用格林函数，其逆为 $G_{0,\\sigma}^{-1}(i\\omega_{n},\\mathbf{k}) = i\\omega_n - (\\epsilon_{\\mathbf{k}} - \\mu)$。为简化符号，我们将化学势 $\\mu$ 吸收到 $\\epsilon_{\\mathbf{k}}$ 中。\n\n我们使用虚时形式下的单粒子格林函数的运动方程来推导自能。实空间、虚时间的格林函数定义为 $G_{\\sigma}(\\mathbf{r}_i - \\mathbf{r}_j, \\tau) = -\\langle T_{\\tau} c_{i\\sigma}(\\tau) c_{j\\sigma}^{\\dagger}(0) \\rangle$，其中 $T_{\\tau}$ 是时间排序算符。算符 $c_{i\\sigma}$ 的运动方程由Heisenberg方程给出，$\\frac{\\partial c_{i\\sigma}}{\\partial \\tau} = [H, c_{i\\sigma}]$。\n\n与总哈密顿量 $H = H_0 + H_{\\text{int}}$ 的对易子是：\n$$[H, c_{i\\sigma}] = [H_0, c_{i\\sigma}] + [H_{\\text{int}}, c_{i\\sigma}]$$\n第一项给出无相互作用的动力学。第二项涉及相互作用，为：\n$$[H_{\\text{int}}, c_{i\\sigma}] = [U \\sum_{l} n_{l\\uparrow} n_{l\\downarrow}, c_{i\\sigma}]$$\n由于 $c_{i\\sigma}$ 与不同格点（$l \\ne i$）上的算符反对易，求和只剩下 $l=i$ 这一项：\n$$[H_{\\text{int}}, c_{i\\sigma}] = U [n_{i\\uparrow} n_{i\\downarrow}, c_{i\\sigma}] = U (c_{i\\uparrow}^{\\dagger} c_{i\\uparrow} c_{i\\downarrow}^{\\dagger} c_{i\\downarrow} c_{i\\sigma} - c_{i\\sigma} c_{i\\uparrow}^{\\dagger} c_{i\\uparrow} c_{i\\downarrow}^{\\dagger} c_{i\\downarrow})$$\n让我们对一个特定的自旋（比如 $\\sigma = \\uparrow$）进行计算：\n$$[H_{\\text{int}}, c_{i\\uparrow}] = U [c_{i\\uparrow}^{\\dagger} c_{i\\uparrow} n_{i\\downarrow}, c_{i\\uparrow}] = U \\{[c_{i\\uparrow}^{\\dagger} c_{i\\uparrow}, c_{i\\uparrow}] n_{i\\downarrow} + c_{i\\uparrow}^{\\dagger} c_{i\\uparrow} [n_{i\\downarrow}, c_{i\\uparrow}]\\}$$\n第二项为零，因为不同自旋的算符是对易的。对于第一项，我们使用恒等式 $[AB, C] = A\\{B,C\\} - \\{A,C\\}B$。令 $A=c_{i\\uparrow}^{\\dagger}$，$B=c_{i\\uparrow}$，$C=c_{i\\uparrow}$：\n$$[c_{i\\uparrow}^{\\dagger} c_{i\\uparrow}, c_{i\\uparrow}] = c_{i\\uparrow}^{\\dagger}\\{c_{i\\uparrow}, c_{i\\uparrow}\\} - \\{c_{i\\uparrow}^{\\dagger}, c_{i\\uparrow}\\}c_{i\\uparrow} = c_{i\\uparrow}^{\\dagger}(0) - (1)c_{i\\uparrow} = -c_{i\\uparrow}$$\n因此，对于 $\\sigma=\\uparrow$，我们有 $[H_{\\text{int}}, c_{i\\uparrow}] = -U c_{i\\uparrow} n_{i\\downarrow}$。根据对称性，对于 $\\sigma=\\downarrow$，有 $[H_{\\text{int}}, c_{i\\downarrow}] = -U c_{i\\downarrow} n_{i\\uparrow}$。我们可以将其紧凑地写为：\n$$[H_{\\text{int}}, c_{i\\sigma}] = -U c_{i\\sigma} n_{i,-\\sigma}$$\n因此，格林函数的运动方程涉及一个四费米子关联函数。Hartree近似在于将这个四费米子项解耦为一个二费米子项与平均密度的乘积。这对应于一种平均场近似，其中每个电子感受到来自相反自旋电子的静态平均势。\n$$ \\langle T_{\\tau} c_{i\\sigma}(\\tau) n_{i,-\\sigma}(\\tau) c_{j\\sigma}^{\\dagger}(0) \\rangle \\approx \\langle n_{i,-\\sigma}(\\tau) \\rangle \\langle T_{\\tau} c_{i\\sigma}(\\tau) c_{j\\sigma}^{\\dagger}(0) \\rangle $$\n在一个平移不变的系统中，平均密度与格点 $i$ 和时间 $\\tau$ 无关，即 $\\langle n_{i,-\\sigma}(\\tau) \\rangle = n_{-\\sigma}$。因此，该近似得出：\n$$ U\\langle T_{\\tau} c_{i\\sigma}(\\tau) n_{i,-\\sigma}(\\tau) c_{j\\sigma}^{\\dagger}(0) \\rangle \\approx U n_{-\\sigma} \\langle T_{\\tau} c_{i\\sigma}(\\tau) c_{j\\sigma}^{\\dagger}(0) \\rangle = -U n_{-\\sigma} G_{\\sigma}(\\mathbf{r}_i - \\mathbf{r}_j, \\tau) $$\n在傅立叶空间中（$k \\equiv (\\mathbf{k}, i\\omega_n)$），全运动方程变为：\n$$(i\\omega_n - \\epsilon_{\\mathbf{k}}) G_{\\sigma}(k) = 1 + U n_{-\\sigma} G_{\\sigma}(k)$$\n重新整理各项以求解 $G_{\\sigma}(k)$：\n$$(i\\omega_n - \\epsilon_{\\mathbf{k}} - U n_{-\\sigma}) G_{\\sigma}(k) = 1$$\n这给出了全格林函数的逆：\n$$G_{\\sigma}^{-1}(k) = i\\omega_n - \\epsilon_{\\mathbf{k}} - U n_{-\\sigma}$$\n将此与Dyson方程 $G_{\\sigma}^{-1}(k) = G_{0,\\sigma}^{-1}(k) - \\Sigma_{\\sigma}(k) = (i\\omega_n - \\epsilon_{\\mathbf{k}}) - \\Sigma_{\\sigma}(k)$ 相比较，我们确定Hartree自能为：\n$$\\Sigma_{\\sigma}^{\\text{H}}(i\\omega_n, \\mathbf{k}) = U n_{-\\sigma}$$\n这个结果是关于 $U$ 的一阶自能。在这一阶上没有相应的Fock（交换）项，因为Hubbard相互作用只存在于相反自旋的电子之间，它们是可区分的粒子，所以不发生交换相互作用。\n\n现在，我们来回答提出的问题。\n\n1.  **与动量和频率无关性：**\n    推导出的自能 $\\Sigma_{\\sigma}^{\\text{H}} = U n_{-\\sigma}$ 是一个常数值。它显然与电子的动量 $\\mathbf{k}$ 和Matsubara频率 $i\\omega_n$ 都无关。这是Hubbard相互作用和Hartree近似的物理性质的直接结果。\n    -   **局域性：** Hubbard相互作用 $H_{\\text{int}} = U \\sum_i n_{i\\uparrow}n_{i\\downarrow}$ 是严格局域的（在位的）。一个在格点 $i$ 上的电子只与完全相同的格点 $i$ 上的其他电子相互作用。\n    -   **平均场近似：** Hartree近似将相反自旋密度的涨落算符 $n_{i,-\\sigma}$ 替换为其静态、空间均匀的期望值 $\\langle n_{i,-\\sigma} \\rangle = n_{-\\sigma}$。这产生了一个在空间和时间上都是常数的平均场势 $V_{\\text{eff}} = U n_{-\\sigma}$。\n    -   一个空间上恒定的势会对所有单粒子态增加一个恒定的能量位移，而不管它们的动量是多少。因此，自能与 $\\mathbf{k}$ 无关。\n    -   一个不随时间变化的（静态）势会导致一个与频率无关的能量位移。因此，自能与 $i\\omega_n$ 无关。\n\n2.  **在顺磁态下的值：**\n    问题指定了顺磁性正常态，其特征是无磁序。这意味着自旋向上和自旋向下的电子密度相等：\n    $$n_{\\uparrow} = n_{\\downarrow}$$\n    总粒子密度（或填充因子）是 $n = n_{\\uparrow} + n_{\\downarrow}$。结合这两个条件得出：\n    $$n_{\\uparrow} = n_{\\downarrow} = \\frac{n}{2}$$\n    我们现在可以将此代入Hartree自能的一般表达式 $\\Sigma_{\\sigma}^{\\text{H}} = U n_{-\\sigma}$ 中。对于任何给定的自旋 $\\sigma$，相反自旋的密度 $n_{-\\sigma}$ 等于 $n/2$。\n    $$\\Sigma^{\\text{H}} = U \\left(\\frac{n}{2}\\right)$$\n    由于结果对两种自旋都相同，我们可以省略自旋指标 $\\sigma$。\n\n在Hartree近似下，Hubbard模型的一阶自能是一个与动量和频率无关的势移，其值等于相互作用强度与总电子密度乘积的一半。", "answer": "$$\\boxed{\\frac{Un}{2}}$$", "id": "2983409"}, {"introduction": "静态的平均场图像虽然直观，但忽略了相互作用的动态效应。第二个练习将我们带入一个更深的层次，探索自能在高频极限下的行为。通过对一个原子极限模型的分析 [@problem_id:2983414]，你将学习如何运用矩展开技术，揭示自能的动态修正项，这与系统中的短时关联和量子涨落直接相关。这个练习展示了超越简单平均场描述的分析威力。", "problem": "考虑一个处于原子极限（无跃迁）下的具有短程在位相互作用的单带费米子系统。其哈密顿量为 $H = U \\, n_{\\uparrow} n_{\\downarrow} - \\mu \\left(n_{\\uparrow} + n_{\\downarrow}\\right)$，其中 $U$ 是相互作用强度，$\\mu$ 是化学势，而 $n_{\\sigma} = c_{\\sigma}^{\\dagger} c_{\\sigma}$ 是自旋为 $\\sigma \\in \\{\\uparrow,\\downarrow\\}$ 的局域粒子数算符。定义松原格林函数 $G_{\\sigma}(\\tau) = - \\langle T_{\\tau} c_{\\sigma}(\\tau) c_{\\sigma}^{\\dagger}(0) \\rangle$ 及其傅里叶变换 $G_{\\sigma}(i\\omega_{n})$，其中费米子松原频率为 $\\omega_{n} = (2n+1)\\pi/\\beta$。自能 $\\Sigma_{\\sigma}(i\\omega_{n})$ 由戴森方程 $G_{\\sigma}^{-1}(i\\omega_{n}) = i\\omega_{n} + \\mu - \\Sigma_{\\sigma}(i\\omega_{n})$ 定义。\n\n从这些定义和哈密顿量所蕴含的谱结构出发，推导 $\\Sigma_{\\sigma}(i\\omega_{n})$ 的高频渐近展开式，直到并包括 $(i\\omega_{n})^{-1}$ 阶项。将结果仅用局域期望值 $n_{-\\sigma} \\equiv \\langle n_{-\\sigma} \\rangle$ 表示。明确指出尾部随频率的标度行为，并给出 $\\Sigma_{\\sigma}(i\\omega_{n})$ 截断到 $(i\\omega_{n})^{-1}$ 阶的最终表达式。\n\n您的最终答案必须是仅包含 $U$、$n_{-\\sigma}$ 和 $\\omega_{n}$ 的单个闭合形式解析表达式。无需单位。最终答案中不要包含任何余项记号（例如大O记号）。", "solution": "问题陈述经核实具有科学依据、良构且客观。它提出了一个量子多体理论中关于哈伯德模型原子极限下自能高频行为的标准可解问题。\n\n推导过程是通过将自能 $\\Sigma_{\\sigma}(i\\omega_{n})$ 的高频展开与单粒子谱函数的矩联系起来。如题目所给，戴森方程定义了自能 $\\Sigma_{\\sigma}(i\\omega_n)$：\n$$ G_{\\sigma}^{-1}(i\\omega_{n}) = i\\omega_{n} + \\mu - \\Sigma_{\\sigma}(i\\omega_{n}) $$\n它可以被重排以表示自能为：\n$$ \\Sigma_{\\sigma}(i\\omega_{n}) = i\\omega_{n} + \\mu - G_{\\sigma}^{-1}(i\\omega_{n}) $$\n松原格林函数 $G_{\\sigma}(i\\omega_{n})$ 具有如下形式的一般高频渐近展开：\n$$ G_{\\sigma}(i\\omega_{n}) = \\sum_{k=0}^{\\infty} \\frac{M_k}{(i\\omega_n)^{k+1}} = \\frac{M_0}{i\\omega_n} + \\frac{M_1}{(i\\omega_n)^2} + \\frac{M_2}{(i\\omega_n)^3} + \\mathcal{O}\\left((i\\omega_n)^{-4}\\right) $$\n其中系数 $M_k$ 是谱函数的矩。这些矩可以通过涉及哈密顿量 $H$ 的嵌套对易子计算得出。通用公式为 $M_k = \\langle \\{ \\mathcal{L}^k c_{\\sigma}, c_{\\sigma}^{\\dagger} \\} \\rangle$，其中刘维尔超算符定义为 $\\mathcal{L}A = [A, H]$。\n\n我们将计算前三阶矩（$M_0, M_1, M_2$）以确定 $\\Sigma_{\\sigma}(i\\omega_{n})$ 直到 $(i\\omega_{n})^{-1}$ 阶的展开。\n\n零阶矩 $M_0$ 由正则反对易关系给出：\n$$ M_0 = \\langle \\{c_{\\sigma}, c_{\\sigma}^{\\dagger}\\} \\rangle = 1 $$\n\n为计算一阶矩 $M_1$，我们首先需要对易子 $[c_{\\sigma}, H]$。哈密顿量为 $H = U n_{\\uparrow} n_{\\downarrow} - \\mu(n_{\\uparrow} + n_{\\downarrow})$。利用费米子的基本对易关系 $[A, BC] = [A, B]C + B[A, C]$ 以及特定关系 $[c_{\\alpha}, n_{\\beta}] = [c_{\\alpha}, c_{\\beta}^{\\dagger}c_{\\beta}] = \\delta_{\\alpha\\beta}c_{\\alpha}$，我们得到：\n$$ [c_{\\sigma}, H] = [c_{\\sigma}, U n_{\\sigma} n_{-\\sigma} - \\mu(n_{\\sigma} + n_{-\\sigma})] $$\n$$ [c_{\\sigma}, H] = U [c_{\\sigma}, n_{\\sigma} n_{-\\sigma}] - \\mu [c_{\\sigma}, n_{\\sigma}] - \\mu [c_{\\sigma}, n_{-\\sigma}] $$\n$$ [c_{\\sigma}, H] = U(n_{\\sigma}[c_{\\sigma}, n_{-\\sigma}] + [c_{\\sigma}, n_{\\sigma}]n_{-\\sigma}) - \\mu c_{\\sigma} - 0 $$\n$$ [c_{\\sigma}, H] = U(0 + c_{\\sigma}n_{-\\sigma}) - \\mu c_{\\sigma} $$\n由于 $c_{\\sigma}$ 和 $n_{-\\sigma}$ 对易，我们有：\n$$ [c_{\\sigma}, H] = (U n_{-\\sigma} - \\mu) c_{\\sigma} $$\n现在，我们可以计算 $M_1$：\n$$ M_1 = \\langle \\{[c_{\\sigma}, H], c_{\\sigma}^{\\dagger}\\} \\rangle = \\langle \\{(U n_{-\\sigma} - \\mu)c_{\\sigma}, c_{\\sigma}^{\\dagger}\\} \\rangle = \\langle (U n_{-\\sigma} - \\mu)\\{c_{\\sigma}, c_{\\sigma}^{\\dagger}\\} \\rangle = \\langle U n_{-\\sigma} - \\mu \\rangle $$\n$$ M_1 = U \\langle n_{-\\sigma} \\rangle - \\mu $$\n题目将期望值 $\\langle n_{-\\sigma} \\rangle$ 定义为 $n_{-\\sigma}$，但为清晰起见，在整个推导过程中我们将保留显式的平均值符号 $\\langle \\cdot \\rangle$。\n\n为计算二阶矩 $M_2$，我们需要二重嵌套对易子 $[[c_{\\sigma}, H], H]$：\n$$ [[c_{\\sigma}, H], H] = [(U n_{-\\sigma} - \\mu) c_{\\sigma}, H] = (U n_{-\\sigma} - \\mu)[c_{\\sigma}, H] + [U n_{-\\sigma} - \\mu, H]c_{\\sigma} $$\n哈密顿量 $H$ 仅由相互对易的粒子数算符 $n_{\\uparrow}$ 和 $n_{\\downarrow}$ 构成。因此，任何 $n_{\\uparrow}$ 和 $n_{\\downarrow}$ 的函数，例如 $n_{-\\sigma}$，都与 $H$ 对易。这意味着 $[n_{-\\sigma}, H] = 0$，因此有 $[U n_{-\\sigma} - \\mu, H] = 0$。\n该对易子简化为：\n$$ [[c_{\\sigma}, H], H] = (U n_{-\\sigma} - \\mu)[c_{\\sigma}, H] = (U n_{-\\sigma} - \\mu)(U n_{-\\sigma} - \\mu)c_{\\sigma} = (U n_{-\\sigma} - \\mu)^2 c_{\\sigma} $$\n于是二阶矩 $M_2$ 为：\n$$ M_2 = \\langle \\{[[c_{\\sigma}, H], H], c_{\\sigma}^{\\dagger}\\} \\rangle = \\langle \\{(U n_{-\\sigma} - \\mu)^2 c_{\\sigma}, c_{\\sigma}^{\\dagger}\\} \\rangle = \\langle (U n_{-\\sigma} - \\mu)^2 \\rangle $$\n利用 $n_{-\\sigma}$ 是单格点上费米子的粒子数算符这一性质，其本征值为 $0$ 和 $1$，因此 $n_{-\\sigma}^2 = n_{-\\sigma}$。\n$$ M_2 = \\langle U^2 n_{-\\sigma}^2 - 2U\\mu n_{-\\sigma} + \\mu^2 \\rangle = U^2 \\langle n_{-\\sigma} \\rangle - 2U\\mu \\langle n_{-\\sigma} \\rangle + \\mu^2 $$\n现在我们得到了 $G_{\\sigma}(i\\omega_{n})$ 直到所需阶数的展开式：\n$$ G_{\\sigma}(i\\omega_n) \\approx \\frac{1}{i\\omega_n} + \\frac{M_1}{(i\\omega_n)^2} + \\frac{M_2}{(i\\omega_n)^3} $$\n为求得 $\\Sigma_{\\sigma}(i\\omega_{n})$，我们需要对此级数求逆以得到 $G_{\\sigma}^{-1}(i\\omega_{n})$。令 $z = i\\omega_n$。\n$$ G_{\\sigma}(z) = \\frac{1}{z} \\left(1 + \\frac{M_1}{z} + \\frac{M_2}{z^2} + \\dots \\right) $$\n$$ G_{\\sigma}^{-1}(z) = z \\left(1 + \\frac{M_1}{z} + \\frac{M_2}{z^2} + \\dots \\right)^{-1} $$\n对于小的 $x$，使用几何级数展开 $(1+x)^{-1} \\approx 1-x+x^2$：\n$$ G_{\\sigma}^{-1}(z) \\approx z \\left(1 - \\left(\\frac{M_1}{z} + \\frac{M_2}{z^2}\\right) + \\left(\\frac{M_1}{z}\\right)^2 \\right) $$\n$$ G_{\\sigma}^{-1}(z) \\approx z \\left(1 - \\frac{M_1}{z} + \\frac{M_1^2 - M_2}{z^2} \\right) = z - M_1 + \\frac{M_1^2 - M_2}{z} $$\n我们来计算 $M_1^2 - M_2$ 这一项：\n$$ M_1^2 = (U \\langle n_{-\\sigma} \\rangle - \\mu)^2 = U^2 \\langle n_{-\\sigma} \\rangle^2 - 2U\\mu \\langle n_{-\\sigma} \\rangle + \\mu^2 $$\n$$ M_1^2 - M_2 = (U^2 \\langle n_{-\\sigma} \\rangle^2 - 2U\\mu \\langle n_{-\\sigma} \\rangle + \\mu^2) - (U^2 \\langle n_{-\\sigma} \\rangle - 2U\\mu \\langle n_{-\\sigma} \\rangle + \\mu^2) $$\n$$ M_1^2 - M_2 = U^2 (\\langle n_{-\\sigma} \\rangle^2 - \\langle n_{-\\sigma} \\rangle) = -U^2 \\langle n_{-\\sigma} \\rangle (1 - \\langle n_{-\\sigma} \\rangle) $$\n将系数代回到 $G_{\\sigma}^{-1}(i\\omega_{n})$ 的展开式中：\n$$ G_{\\sigma}^{-1}(i\\omega_n) \\approx i\\omega_n - (U \\langle n_{-\\sigma} \\rangle - \\mu) - \\frac{U^2 \\langle n_{-\\sigma} \\rangle (1 - \\langle n_{-\\sigma} \\rangle)}{i\\omega_n} $$\n最后，我们从戴森方程中获得自能：\n$$ \\Sigma_{\\sigma}(i\\omega_{n}) = i\\omega_n + \\mu - G_{\\sigma}^{-1}(i\\omega_n) $$\n$$ \\Sigma_{\\sigma}(i\\omega_{n}) \\approx i\\omega_n + \\mu - \\left( i\\omega_n - U \\langle n_{-\\sigma} \\rangle + \\mu - \\frac{U^2 \\langle n_{-\\sigma} \\rangle (1 - \\langle n_{-\\sigma} \\rangle)}{i\\omega_n} \\right) $$\n$$ \\Sigma_{\\sigma}(i\\omega_{n}) \\approx U \\langle n_{-\\sigma} \\rangle + \\frac{U^2 \\langle n_{-\\sigma} \\rangle (1 - \\langle n_{-\\sigma} \\rangle)}{i\\omega_n} $$\n高频展开由一个常数项（静态的哈特里-福克贡献）和一个领头阶的动态修正组成。自能的尾部，即当 $\\omega_n \\to \\infty$ 时衰减的部分，其标度行为为 $(i\\omega_n)^{-1}$。\n\n使用题目中的记号 $n_{-\\sigma} \\equiv \\langle n_{-\\sigma} \\rangle$，截断到 $(i\\omega_{n})^{-1}$ 阶的最终表达式为：\n$$ \\Sigma_{\\sigma}(i\\omega_{n}) = U n_{-\\sigma} + \\frac{U^2 n_{-\\sigma} (1 - n_{-\\sigma})}{i\\omega_n} $$", "answer": "$$ \\boxed{U n_{-\\sigma} + \\frac{U^{2} n_{-\\sigma} (1 - n_{-\\sigma})}{i\\omega_{n}}} $$", "id": "2983414"}, {"introduction": "理论计算常常在虚构的松原频率 ($i\\omega_n$) 轴上进行，而实验测量则发生在真实的频率 ($\\omega$) 轴上。这一理论与现实的鸿沟需要通过一个被称为“解析延拓”的数学过程来跨越。第三个练习 [@problem_id:2983423] 聚焦于这一关键但充满数值挑战的任务，通过比较两种主流方法（Padé近似和最大熵方法），揭示它们背后的数学假设、适用场景及常见陷阱。掌握这些知识对于将理论计算结果与实验数据进行可靠比较至关重要。", "problem": "一个相互作用的费米子系统由一个包含自能的单粒子格林函数来描述。设 $\\Sigma(i\\omega_n)$ 表示费米子Matsubara自能，$\\Sigma^R(\\omega)$ 是其在实频轴上的推迟对应部分。根据因果性和稳定性，$\\Sigma(z)$ 在复平面的上半平面是解析的，并且推迟函数满足Kramers–Kronig关系。Dyson方程将全格林函数与裸格林函数和自能联系起来。从 $\\Sigma(i\\omega_n)$ 获得 $\\Sigma^R(\\omega)$ 的解析延拓问题是众所周知的不适定问题。\n\n两种常见的解析延拓数值方法是Padé近似和最大熵方法（MaxEnt，Maximum Entropy的缩写）。考虑在因果性和高频矩存在的通常假设下，将这些方法具体应用于相互作用费米子问题的自能。\n\n当使用Padé近似和最大熵方法将 $\\Sigma(i\\omega_n)$ 解析延拓到 $\\Sigma^R(\\omega)$ 时，关于这两种方法的数学假设和典型失效模式，以下哪些陈述是正确的？选择所有适用项。\n\nA. Padé近似构造一个在实轴之外解析的有理函数，该函数在一组离散的虚频点上与 $\\Sigma(i\\omega_n)$ 匹配。在没有噪声、且数据是由一个在上半平面解析且奇点局限于实轴的函数生成的情况下，Padé近似可以通过稠密的极点-零点对来逼近支割；然而，微小的统计噪声通常会导致伪极点-零点对的出现以及对因果性的潜在违反，例如出现 $\\operatorname{Im}\\Sigma^R(\\omega) > 0$ 的区域。\n\nB. 最大熵方法假设自能的谱权重是非负的，即 $A_\\Sigma(\\omega) \\equiv -\\frac{1}{\\pi}\\operatorname{Im}\\Sigma^R(\\omega) \\ge 0$，并使用一个贝叶斯后验概率，该后验概率在一个数据失配项和一个相对于默认模型的熵项之间进行权衡。它倾向于过度平滑尖锐特征，并且对默认模型的选择以及对噪声水平的估计很敏感。\n\nC. 如果Padé近似能以机器精度复现 $\\Sigma(i\\omega_n)$，那么它必然在实轴上保持 $\\operatorname{Im}\\Sigma^R(\\omega)$ 的正确符号。\n\nD. 最大熵方法可以直接应用于 $\\Sigma(i\\omega_n)$ 而无需任何修改，因为其积分核与格林函数的积分核相同，所以不需要进行减法或施加渐近约束。\n\nE. 引入已知的高频约束，例如强制在 $|z|\\to\\infty$ 时 $\\Sigma(z) \\to \\Sigma_{\\infty} + \\Sigma_1/z + \\mathcal{O}(1/z^2)$，可以通过减少伪影、提高稳定性和唯一性来改进Padé近似和最大熵方法。\n\nF. 只要输入数据 $\\Sigma(i\\omega_n)$ 是无噪声的，最大熵方法就保证能够恢复 $\\operatorname{Im}\\Sigma^R(\\omega)$ 中的尖锐准粒子结构。\n\nG. 一旦使用了足够多的Matsubara点，由Padé近似得到的解析延拓结果本质上是唯一的，并且与沿虚轴的采样策略无关。", "solution": "任务是评估关于两种常见的数值方法——Padé近似和最大熵方法（MaxEnt）——的陈述。这些方法用于将费米子自能 $\\Sigma(i\\omega_n)$ 从Matsubara虚轴解析延拓到实频轴，从而得到 $\\Sigma^R(\\omega)$。从离散、带噪声的数据集进行解析延拓是一个数学上的不适定问题。\n\n任何响应函数（包括自能 $\\Sigma(z)$）的一个基本属性是，因果性要求它在复频平面的上半平面是解析的。物理稳定性的一个进一步推论是，系统不能自发产生能量，这意味着推迟自能的虚部必须是非正的，即 $\\operatorname{Im}\\Sigma^R(\\omega) \\le 0$。这意味着定义为 $A_\\Sigma(\\omega) = -\\frac{1}{\\pi}\\operatorname{Im}\\Sigma^R(\\omega)$ 的自能谱函数必须是非负的，即 $A_\\Sigma(\\omega) \\ge 0$。\n\n自能可以通过谱表示（或Lehmann表示）来表达，该表示解释了其渐近行为：\n$$ \\Sigma(z) = \\Sigma_{\\infty} + \\int_{-\\infty}^{\\infty} d\\omega' \\frac{A_{\\Sigma}(\\omega')}{z - \\omega'} $$\n在此，$\\Sigma_{\\infty}$ 是自能中与频率无关的Hartree-Fock部分，它是 $\\Sigma(z)$ 在 $|z| \\to \\infty$ 时的极限。对于大的 $|z|$，积分项以 $1/z$ 的形式趋于零。$1/z$ 项的系数由谱函数的零阶矩给出，$\\Sigma_1 = -\\int_{-\\infty}^{\\infty} A_\\Sigma(\\omega') d\\omega'$。这些性质对于正确的解析延拓至关重要。\n\n我们现在逐一评估每个陈述。\n\n**A. Padé近似构造一个在实轴之外解析的有理函数，该函数在一组离散的虚频点上与 $\\Sigma(i\\omega_n)$ 匹配。在没有噪声、且数据是由一个在上半平面解析且奇点局限于实轴的函数生成的情况下，Padé近似可以通过稠密的极点-零点对来逼近支割；然而，微小的统计噪声通常会导致伪极点-零点对的出现以及对因果性的潜在违反，例如出现 $\\operatorname{Im}\\Sigma^R(\\omega) > 0$ 的区域。**\n\nPadé近似方法试图用一个有理函数 $[M/N](z) = P_M(z)/Q_N(z)$ 来近似一个函数 $f(z)$，其中 $P_M$ 和 $Q_N$ 分别是M次和N次多项式。其系数是通过将近似函数的值与输入数据 $\\Sigma(i\\omega_n)$ 在 $M+N+1$ 个点上进行匹配来确定的。该陈述正确地描述了：一个极点仅在下半平面的有理函数，可以通过将其极点和零点密集地排列在实轴附近，来近似一个在实轴上有支割的函数。这是近似理论中的一个已知结果。然而，确定多项式的系数（从而确定极点和零点的位置）是一个数值不稳定的过程。输入数据 $\\Sigma(i\\omega_n)$ 上的微小统计噪声可能导致极点-零点位置发生巨大的、不可控的变化。这可以表现为两种关键方式：1. 极点可能被移到上半平面，这违反了 $\\Sigma(z)$ 必须在那里解析的因果性条件。2. 即使所有极点都保持在下半平面，它们的排布也可能变得不符合物理。近似函数在实轴上的虚部 $\\operatorname{Im} [M/N](\\omega)$ 可能会出现伪振荡。这些振荡很容易穿过零点，导致出现 $\\operatorname{Im}\\Sigma^R(\\omega) > 0$ 的区域，从而违反物理稳定性条件。这个陈述准确地描述了该方法及其最主要的失效模式。\n结论：**正确**。\n\n**B. 最大熵方法假设自能的谱权重是非负的，即 $A_\\Sigma(\\omega) \\equiv -\\frac{1}{\\pi}\\operatorname{Im}\\Sigma^R(\\omega) \\ge 0$，并使用一个贝叶斯后验概率，该后验概率在一个数据失配项和一个相对于默认模型的熵项之间进行权衡。它倾向于过度平滑尖锐特征，并且对默认模型的选择以及对噪声水平的估计很敏感。**\n\n最大熵方法从根本上是为了重构一个正定分布函数而设计的，在本问题中这个函数就是谱函数 $A_\\Sigma(\\omega)$。因此，$A_\\Sigma(\\omega) \\ge 0$ 的假设是内置于该方法的核心之中的，这与物理稳定性要求 $\\operatorname{Im}\\Sigma^R(\\omega) \\le 0$ 完美契合。MaxEnt在贝叶斯框架下能得到最好的理解。它的目标是在给定数据 $\\Sigma(i\\omega_n)$ 的情况下，找到最概然的谱函数 $A$。根据贝叶斯定理，后验概率为 $P(A|\\text{data}) \\propto P(\\text{data}|A)P(A)$。似然项 $P(\\text{data}|A)$ 通常取为 $e^{-\\chi^2/2}$，其中 $\\chi^2$ 衡量数据与谱函数预测值之间的失配度。先验概率项 $P(A)$ 通过Shannon-Jaynes熵来表示，$P(A) \\propto e^{\\alpha S}$，其中 $S = -\\int d\\omega\\, A(\\omega)\\ln(A(\\omega)/D(\\omega))$，$D(\\omega)$ 是用户提供的默认模型。因此，该方法最大化一个泛函 $Q = \\alpha S - \\chi^2/2$。熵项倾向于得到最平滑、最无特征的谱。这对解进行了正则化，但其已知后果是会展宽和过度平滑像准粒子峰或带边这样的尖锐特征。最终结果也已知对有些随意的默认模型 $D(\\omega)$ 的选择以及参数 $\\alpha$ 的选择很敏感，$\\alpha$ 控制着拟合数据和最大化熵之间的平衡，并且通常由输入噪声的估计值来确定。这个陈述是MaxEnt方法的一个精确且准确的描述。\n结论：**正确**。\n\n**C. 如果Padé近似能以机器精度复现 $\\Sigma(i\\omega_n)$，那么它必然在实轴上保持 $\\operatorname{Im}\\Sigma^R(\\omega)$ 的正确符号。**\n\n这个陈述是不正确的。从离散点集进行解析延拓是不适定问题。在虚轴上的完美拟合不保证函数的全局物理性质，例如其在实轴上虚部的符号。虽然Carlson定理在特定条件下保证了解析函数的唯一性，但一个有限阶的Padé近似通常不是那个唯一的函数。人们可以构造出多个在有限点集上一致但在别处表现得非常不同的有理函数。Padé过程没有内置机制来强制执行 $\\operatorname{Im}\\Sigma^R(\\omega) \\le 0$ 的约束。因此，即使一个近似函数能高精度地匹配输入数据，它仍然可能表现出不符合物理的行为，例如导致 $\\operatorname{Im}\\Sigma^R(\\omega) > 0$ 的振荡。\n结论：**不正确**。\n\n**D. 最大熵方法可以直接应用于 $\\Sigma(i\\omega_n)$ 而无需任何修改，因为其积分核与格林函数的积分核相同，所以不需要进行减法或施加渐近约束。**\n\n这个陈述是不正确的。尽管将谱函数与虚轴上的函数关联起来的积分核 $K(\\omega_n, \\omega') = 1/(i\\omega_n - \\omega')$，对于格林函数 $G(z)$ 和自能的动力学部分确实具有相同的形式，但它们的渐近行为是不同的。通常情况下，$G(z) \\to 1/z$ 当 $|z|\\to\\infty$ 时，意味着其谱函数的积分为1。相比之下，对于许多相互作用模型，自能在高频下趋于一个常数，即 $\\Sigma(z) \\to \\Sigma_{\\infty}$ 当 $|z|\\to\\infty$ 时。标准的MaxEnt形式假定被重构的函数由一个积分 $\\int d\\omega' A(\\omega')/(z-\\omega')$ 表示，该积分在 $|z|\\to\\infty$ 时必然趋于零。因此，如果 $\\Sigma_\\infty \\neq 0$，就不能直接将MaxEnt应用于 $\\Sigma(i\\omega_n)$。正确的步骤是首先减去这个渐近常数，即将MaxEnt应用于函数 $\\tilde{\\Sigma}(z) = \\Sigma(z) - \\Sigma_{\\infty}$ 的数据，这个函数在无穷远处确实趋于零。因此，需要进行减法操作。\n结论：**不正确**。\n\n**E. 引入已知的高频约束，例如强制在 $|z|\\to\\infty$ 时 $\\Sigma(z) \\to \\Sigma_{\\infty} + \\Sigma_1/z + \\mathcal{O}(1/z^2)$，可以通过减少伪影、提高稳定性和唯一性来改进Padé近似和最大熵方法。**\n\n这个陈述是正确的。引入已知的先验信息是为不适定问题进行正则化的一个标准且强大的技术。$\\Sigma(z)$ 的渐近行为就提供了此类信息。对于Padé近似，约束有理函数的系数以复现 $\\Sigma_\\infty$ 和/或 $\\Sigma_1$ 的已知值，会给拟合问题增加精确的线性约束。这减少了自由度并稳定了拟合，通常会得到一个更符合物理、振荡更小的结果。对于MaxEnt，使用这个信息是必不可少的。正如在选项D中所指出的，$\\Sigma_\\infty$ 必须被减去。此外，一阶矩 $\\Sigma_1 = -\\int A_\\Sigma(\\omega') d\\omega'$ 的值可以在优化过程中作为附加约束来强制执行。在这两种方法中，这些约束都缩小了巨大的可能解空间，引导算法得出一个不仅与低频数据一致，也与高频物理一致的结果。这显著提高了稳定性并减少了不符合物理的伪影。\n结论：**正确**。\n\n**F. 只要输入数据 $\\Sigma(i\\omega_n)$ 是无噪声的，最大熵方法就保证能够恢复 $\\operatorname{Im}\\Sigma^R(\\omega)$ 中的尖锐准粒子结构。**\n\n这个陈述是不正确的。“保证”这个词的语气太强了。MaxEnt方法就其本质而言，包含一个倾向于平滑、无特征解的熵项。像类delta函数的准粒子峰这样的尖锐结构具有非常低的熵，并会受到算法的惩罚。即使是使用完全无噪声的数据，在完美拟合数据（低 $\\chi^2$）和拥有高熵谱之间也存在权衡。算法总是会为了获得熵而对尖锐的峰引入一些展宽。虽然高质量的数据比带噪声的数据能分辨出更尖锐的特征，但完美恢复一个真正的delta函数是不可能的，一些展宽是不可避免的。该方法不保证能恢复尖锐结构。\n结论：**不正确**。\n\n**G. 一旦使用了足够多的Matsubara点，由Padé近似得到的解析延拓结果本质上是唯一的，并且与沿虚轴的采样策略无关。**\n\n这个陈述在多个方面都是不正确的。Padé近似不是唯一的；其结果关键地依赖于所选的多项式阶数 $[M/N]$。没有单一的、最优的选择，不同的选择可以产生截然不同的谱。此外，结果高度依赖于“采样策略”——包括所使用的Matsubara点的数量以及哪些特定的点被包含在拟合中。使用更多的点不一定会收敛到唯一的答案；事实上，它可能会加剧数值不稳定性，这是一种与多项式插值中的Runge现象相关的现象。因此，Padé近似的结果既不是唯一的，也不独立于采样策略。\n结论：**不正确**。\n\n总之，陈述A、B和E是关于Padé近似和最大熵方法用于解析延拓的性质和实际应用的正确描述。", "answer": "$$\\boxed{ABE}$$", "id": "2983423"}]}