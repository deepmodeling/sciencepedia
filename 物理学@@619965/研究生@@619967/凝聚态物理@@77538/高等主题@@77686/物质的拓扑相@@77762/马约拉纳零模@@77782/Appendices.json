{"hands_on_practices": [{"introduction": "一维拓扑超导体的标志是其 $\\mathbb{Z}_2$ 拓扑不变量，它将非拓扑相与拓扑相区分开来。第一个练习将引导你亲自动手计算 Kitaev 链模型的这个不变量。通过从 Bogoliubov-de Gennes 哈密顿量构造一个反对称矩阵，并计算其在布里渊区高对称性动量点上的 Pfaffian 值，你将能够判断系统是否能够承载马约拉纳零模 [@problem_id:3003983]。", "problem": "考虑一个具有最近邻跃迁和实数 $p$ 波配对的一维无自旋费米子晶格，采用平均场近似。其 Bogoliubov-de Gennes (BdG) 哈密顿量可以写作动量空间中的二次型形式，\n$$\nH=\\frac{1}{2}\\sum_{k}\\Psi_{k}^{\\dagger}\\, \\mathcal{H}(k)\\, \\Psi_{k},\n$$\n其中 Nambu 旋量为 $\\Psi_{k}=\\begin{pmatrix}c_{k} \\\\ c_{-k}^{\\dagger}\\end{pmatrix}$ ，布洛赫 BdG 矩阵为\n$$\n\\mathcal{H}(k)=\\xi(k)\\,\\tau_{z}+2\\Delta\\,\\sin k\\, \\tau_{y},\n$$\n其中 $\\xi(k)=-\\mu-2t\\cos k$，跃迁振幅 $t>0$，实数配对振幅 $\\Delta>0$，化学势为 $\\mu$。此处 $\\tau_{x}$、$\\tau_{y}$ 和 $\\tau_{z}$ 是 Nambu 空间中的泡利矩阵，矩阵 $\\mathcal{H}(k)$ 满足由 $C=\\tau_{x}K$ 实现的粒子-空穴对称性，其中 $K$ 表示复共轭。对于一维 D 类系统，Kitaev Majorana 数 $\\mathcal{M}$ 可以在粒子-空穴对称动量点 $k=0$ 和 $k=\\pi$ 处，通过计算在这些点上由 $\\mathcal{H}(k)$ 构造的反对称矩阵的普法夫值（Pfaffian）乘积的符号来求得。普法夫值 $\\mathrm{Pf}(\\cdot)$ 是为反对称矩阵定义的，并满足 $\\mathrm{Pf}(M)^{2}=\\det(M)$。\n\n仅使用 BdG 形式理论和粒子-空穴对称性的基本结构，在 $k=0$ 和 $k=\\pi$ 处构造适当的反对称矩阵 $B(k)$，然后对参数集 $t=1$，$\\Delta=0.7$ 和 $\\mu=\\tfrac{3}{2}$ 计算 $\\mathrm{Pf}[B(0)]\\,\\mathrm{Pf}[B(\\pi)]$ 的符号。给出 Majorana 数 $\\mathcal{M}$ 的最终值，它是一个实数 $\\pm 1$。无需四舍五入。", "solution": "该问题要求计算由 Bogoliubov-de Gennes (BdG) 哈密顿量 $\\mathcal{H}(k)$ 描述的一维 $p$ 波超导体的 Majorana 数 $\\mathcal{M}$。对于一维 D 类系统，Majorana 数是一个 $\\mathbb{Z}_2$ 拓扑不变量，可以通过检验哈密顿量在粒子-空穴对称动量点 $k=0$ 和 $k=\\pi$ 处的性质来确定。\n\nMajorana 数 $\\mathcal{M}$ 由以下公式给出：\n$$\n\\mathcal{M} = \\mathrm{sign}\\left( \\mathrm{Pf}[B(0)] \\cdot \\mathrm{Pf}[B(\\pi)] \\right)\n$$\n其中 $\\mathrm{Pf}[\\cdot]$ 表示普法夫值，而 $B(k)$ 是由 BdG 哈密顿量 $\\mathcal{H}(k)$ 在动量点 $k=0$ 和 $k=\\pi$ 处构造的反对称矩阵。\n\n粒子-空穴对称性（PHS）是由算符 $C = \\tau_x K$ 实现的，其中 $\\tau_x$ 是第一个泡利矩阵，$K$ 是复共轭算符。哈密顿量满足对称关系 $C \\mathcal{H}(k) C^{-1} = -\\mathcal{H}(-k)$。在 PHS 不变动量点 $k_{inv} \\in \\{0, \\pi\\}$，由于 $-k_{inv} \\equiv k_{inv} \\pmod{2\\pi}$，此关系简化为：\n$$\n(\\tau_x K) \\mathcal{H}(k_{inv}) (K^{-1} \\tau_x^{-1}) = \\tau_x \\mathcal{H}^*(k_{inv}) \\tau_x = -\\mathcal{H}(k_{inv})\n$$\n适当的反对称矩阵 $B(k)$ 构造为 $B(k) = \\mathcal{H}(k) U$，其中 $U$ 是 PHS 算符的酉部分。在本例中，$U = \\tau_x$。我们来构造 $B(k_{inv}) = \\mathcal{H}(k_{inv}) \\tau_x$ 并验证其是反对称的。如果一个矩阵 $M$ 的转置 $M^T$ 等于 $-M$，则该矩阵是反对称的。\n\n$B(k_{inv})$ 的转置是 $B(k_{inv})^T = (\\mathcal{H}(k_{inv}) \\tau_x)^T = \\tau_x^T \\mathcal{H}(k_{inv})^T = \\tau_x \\mathcal{H}(k_{inv})^T$。因为 $\\mathcal{H}(k)$ 是厄米矩阵，所以 $\\mathcal{H}(k_{inv})^\\dagger = \\mathcal{H}(k_{inv})$，这意味着 $\\mathcal{H}(k_{inv})^T = \\mathcal{H}(k_{inv})^*$。\n因此，$B(k_{inv})^T = \\tau_x \\mathcal{H}(k_{inv})^*$。\n\n从 PHS 关系中，我们有 $\\tau_x \\mathcal{H}^*(k_{inv}) \\tau_x = -\\mathcal{H}(k_{inv})$。从右侧乘以 $\\tau_x$ 得到 $\\tau_x \\mathcal{H}^*(k_{inv}) = -\\mathcal{H}(k_{inv})\\tau_x$。\n这表明 $B(k_{inv})^T = -\\mathcal{H}(k_{inv})\\tau_x = -B(k_{inv})$。因此，矩阵 $B(k_{inv})$ 确实是反对称的，其普法夫值是有明确定义的。\n\n现在，我们必须求出 $B(k_{inv})$ 的显式形式。BdG 哈密顿量由下式给出：\n$$\n\\mathcal{H}(k) = \\xi(k)\\,\\tau_{z}+2\\Delta\\,\\sin k\\, \\tau_{y}\n$$\n在动量点 $k=0$ 和 $k=\\pi$ 处，项 $\\sin k$ 为零。因此，哈密顿量简化为：\n$$\n\\mathcal{H}(k_{inv}) = \\xi(k_{inv})\\,\\tau_{z}\n$$\n现在我们可以构造 $B(k_{inv})$：\n$$\nB(k_{inv}) = \\mathcal{H}(k_{inv})\\tau_x = (\\xi(k_{inv})\\,\\tau_{z})\\tau_x = \\xi(k_{inv})(\\tau_z \\tau_x)\n$$\n使用泡利矩阵恒等式 $\\tau_z \\tau_x = i\\tau_y$，我们得到：\n$$\nB(k_{inv}) = i\\xi(k_{inv})\\tau_y = i\\xi(k_{inv}) \\begin{pmatrix} 0 & -i \\\\ i & 0 \\end{pmatrix} = \\xi(k_{inv}) \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix}\n$$\n这是一个 $2 \\times 2$ 的实反对称矩阵。对于一个一般的 $2 \\times 2$ 反对称矩阵 $M = \\begin{pmatrix} 0 & a \\\\ -a & 0 \\end{pmatrix}$，普法夫值定义为 $\\mathrm{Pf}(M) = a$。\n在我们的例子中，非对角元是 $a = \\xi(k_{inv})$。因此，普法夫值为：\n$$\n\\mathrm{Pf}[B(k_{inv})] = \\xi(k_{inv})\n$$\n那么 Majorana 数由 $k=0$ 和 $k=\\pi$ 处的普法夫值乘积的符号给出：\n$$\n\\mathcal{M} = \\mathrm{sign}(\\xi(0) \\cdot \\xi(\\pi))\n$$\n给定参数 $t=1$，$\\Delta=0.7$ 和 $\\mu=\\frac{3}{2}$。色散关系为 $\\xi(k) = -\\mu-2t\\cos k$。$\\Delta$ 的值在此计算中是不需要的，因为它只影响 $\\mathcal{H}(k)$ 的非对角项，而这些项在 $k=0$ 和 $k=\\pi$ 时为零。\n\n我们来计算 $\\xi(k)$ 在 $k=0$ 和 $k=\\pi$ 处的值：\n对于 $k=0$：\n$$\n\\xi(0) = -\\mu - 2t\\cos(0) = -\\frac{3}{2} - 2(1)(1) = -\\frac{3}{2} - 2 = -\\frac{7}{2}\n$$\n对于 $k=\\pi$：\n$$\n\\xi(\\pi) = -\\mu - 2t\\cos(\\pi) = -\\frac{3}{2} - 2(1)(-1) = -\\frac{3}{2} + 2 = \\frac{1}{2}\n$$\n现在，我们可以计算 Majorana 数 $\\mathcal{M}$：\n$$\n\\mathcal{M} = \\mathrm{sign}\\left( \\left(-\\frac{7}{2}\\right) \\cdot \\left(\\frac{1}{2}\\right) \\right) = \\mathrm{sign}\\left(-\\frac{7}{4}\\right)\n$$\n负数的符号是 $-1$。因此，Majorana 数为：\n$$\n\\mathcal{M} = -1\n$$\n这表明对于给定的参数，系统处于拓扑非平庸相，其末端存在 Majorana 零模。", "answer": "$$\\boxed{-1}$$", "id": "3003983"}, {"introduction": "虽然手动计算对于理解概念至关重要，但将此过程自动化可以让我们系统性地探索一个系统的相图。这个练习将挑战你把前一个练习中的数学步骤转化为一个计算算法。通过编写一个程序来计算 $\\mathbb{Z}_2$ 拓扑不变量，你将构建一个实用工具，用以测试不同的参数区域并识别 Kitaev 链中的拓扑相变 [@problem_id:3003940]。", "problem": "你必须编写一个完整的、可运行的程序，对于一个具有平移不变性和粒子-空穴对称性的一维Bogoliubov-de Gennes (BdG)哈密顿量，通过计算在时间反演不变动量点$k=0$和$k=\\pi$（波矢$k$以弧度为单位）上普法夫值的符号，来计算对称性分类D中的一维$\\mathbb{Z}_2$拓扑不变量。该不变量定义为这些符号的乘积，负的乘积表示存在马约拉纳零模的非平庸相。从基本原理出发：(i) 二次费米子哈密顿量的马约拉纳表示会产生一个实反对称矩阵，其Pfaffian编码了基态的费米子宇称； (ii) 在一维情况下，$\\mathbb{Z}_2$不变量由$k=0$和$k=\\pi$之间Pfaffian符号的变化所捕获。\n\n你的程序必须为一个普遍的偶数维晶格BdG问题实现以下算法步骤，然后将其特化并应用于离散化的Kitaev链：\n\n1. 给定一个Nambu基$\\Psi_k=(c_k, c_{-k}^\\dagger)$中具有粒子-空穴对称性和平移不变性的BdG哈密顿量$H(k)$，在$k=0$和$k=\\pi$处构造一个实反对称马约拉纳矩阵$A(k)$。马约拉纳二次型可以写成$(i/4)\\,\\Gamma^\\top A(k) \\Gamma$，其中$\\Gamma$是马约拉纳算符的集合。对于具有实数参数的单带无自旋Kitaev链，在$k=0$和$k=\\pi$处的反对称矩阵$A(k)$简化为一个$2\\times 2$矩阵$A(k)=\\begin{pmatrix}0 & g(k)\\\\ -g(k) & 0\\end{pmatrix}$，其中$g(k)=-\\mu-2t\\cos k$，$\\mu$是化学势，$t$是跃迁振幅。配对振幅$\\Delta$不影响$k=0$和$k=\\pi$处的$A(k)$，因为在这些点$\\sin k=0$（假设$\\Delta$为实数）。\n\n2. 对于一个偶数维的实反对称矩阵$A$，通过递归斜对称消去法实现一个数值稳定的Pfaffian计算：选择一个非零主元$p=A_{0,1}$（可能需要在跟踪置换符号的同时进行行/列交换），通过$B\\leftarrow B + \\frac{1}{p}(v u^\\top - u v^\\top)$更新尾随子块$B$，其中$u=A_{0,2:}$，$v=A_{1,2:}$，然后进行递归。如果所有潜在的主元都为零，则返回$0$作为Pfaffian值。\n\n3. 定义符号函数$\\operatorname{sgn}(\\operatorname{Pf}(A(k)))$，如果$\\operatorname{Pf}(A(k))<0$则返回$-1$，如果$\\operatorname{Pf}(A(k))>0$则返回$+1$，如果$|\\operatorname{Pf}(A(k))|$低于一个小的容差（表示能隙闭合边界），则返回$0$。\n\n4. $\\mathbb{Z}_2$不变量由$\\nu=\\operatorname{sgn}(\\operatorname{Pf}(A(0)))\\times \\operatorname{sgn}(\\operatorname{Pf}(A(\\pi)))$给出。负乘积产生非平庸拓扑相（马约拉纳零模），正乘积产生平庸相，任何零因子表示一个边界（能隙闭合）。\n\n测试套件规范和输出格式：\n- 特化到无自旋Kitaev链，其BdG哈密顿量在Nambu基下为$H(k)=\\xi(k)\\,\\tau_z+\\Delta \\sin k\\,\\tau_y$，其中$\\xi(k)=-\\mu-2t\\cos k$，$\\tau_x, \\tau_y, \\tau_z$是作用于粒子-空穴空间的泡利矩阵，且$\\Delta$取实数。对于这个链，在$k=0$和$k=\\pi$处使用$A(k)=\\begin{pmatrix}0 & -\\mu-2t\\cos k\\\\ \\mu+2t\\cos k & 0\\end{pmatrix}$。\n- 在以下参数集上实现并运行算法（角度$k$以弧度为单位；无需物理单位）：\n    1. $t=1$, $\\mu=0$, $\\Delta=0.3$ (典型的非平庸情况)。\n    2. $t=1$, $\\mu=3$, $\\Delta=0.3$ (典型的平庸情况)。\n    3. $t=1$, $\\mu=-3$, $\\Delta=0.7$ (负$\\mu$的典型平庸情况)。\n    4. $t=1$, $\\mu=2$, $\\Delta=0.5$ (一个Pfaffian为零的边界情况)。\n    5. $t=1$, $\\mu=-2$, $\\Delta=0.5$ (一个Pfaffian为零的边界情况)。\n    6. $t=-1$, $\\mu=0$, $\\Delta=0.4$ ($t$的符号反转；分类应取决于$|\\mu|<2|t|$）。\n- 对每个参数集，输出一个列表$[s_0,s_\\pi,\\text{topological}]$，其中$s_0=\\operatorname{sgn}(\\operatorname{Pf}(A(0)))$和$s_\\pi=\\operatorname{sgn}(\\operatorname{Pf}(A(\\pi)))$是$\\{-1,0,+1\\}$中的整数，而$\\text{topological}$是一个布尔值，指示$\\nu$是否严格等于$-1$（即$s_0$和$s_\\pi$均不为$0$且它们的乘积为$-1$）。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个条目对应一个测试用例，顺序与上文相同。例如：$[[s_0,s_\\pi,\\text{topological}],\\ldots]$。\n\n不允许外部输入；程序必须直接运行并打印答案。", "solution": "该问题要求计算Kitaev链的一维$\\mathbb{Z}_2$拓扑不变量，该模型是D类对称性拓扑超导体的经典模型。这需要实现一个通用的、数值稳定的算法来计算实反对称矩阵的Pfaffian，然后将其应用于Kitaev链在动量空间中高对称性点的具体情况。\n\n该解决方案从基本原理出发。首先，我们建立二次费米子哈密顿量、马约拉纳表示和Pfaffian之间的联系。其次，我们根据特定动量点上的Pfaffian符号定义$\\mathbb{Z}_2$不变量。第三，我们详细介绍一个稳健的Pfaffian递归算法的实现。最后，我们将这套机制应用于Kitaev链的给定测试用例。\n\n**1. 马约拉纳表示与Pfaffian**\n\n一个普遍的费米子二次哈密顿量可以写成 $H = \\sum_{i,j} c_i^\\dagger H_{ij} c_j + \\frac{1}{2}\\sum_{i,j} (\\Delta_{ij} c_i^\\dagger c_j^\\dagger + \\text{h.c.})$，其中 $c_i$ 是费米子湮灭算符。通过引入马约拉纳费米子算符，$\\gamma_{2i-1} = c_i + c_i^\\dagger$ 和 $\\gamma_{2i} = -i(c_i - c_i^\\dagger)$，它们是厄米的且满足 $\\{\\gamma_a, \\gamma_b\\} = 2\\delta_{ab}$，我们可以将任何此类哈密顿量表示为以下形式：\n$$H = \\frac{i}{4} \\sum_{a,b} \\Gamma_a^\\top A_{ab} \\Gamma_b$$\n其中 $\\Gamma$ 是所有马约拉纳算符组成的向量，而 $A$ 是一个实反对称矩阵。\n\n这种表示的意义在于，$H$的基态性质被编码在矩阵$A$的Pfaffian中。Pfaffian，$\\operatorname{Pf}(A)$，是矩阵元素的一个多项式，满足 $(\\operatorname{Pf}(A))^2 = \\det(A)$。对于一个D类对称性（其特征是粒子-空穴对称性$P$满足$P^2=1$）的系统，矩阵$A$是实反对称的。Pfaffian的符号，$\\operatorname{sgn}(\\operatorname{Pf}(A))$，对应于基态的费米子宇称$(-1)^{N_F}$，其中$N_F$是基态的费米子数。$\\operatorname{sgn}(\\operatorname{Pf}(A))=+1$的值表示偶数个费米子（包括零），而$\\operatorname{sgn}(\\operatorname{Pf}(A))=-1$表示奇数个。\n\n**2. 一维中的$\\mathbb{Z}_2$拓扑不变量**\n\n对于一维、平移不变的系统，哈密顿量和相应的马约拉纳矩阵$A$是波矢$k$的函数，波矢$k$定义在布里渊区$k \\in [-\\pi, \\pi)$内。该系统有两个特殊的时间反演不变动量点 (TRIMs)，即$k=0$和$k=\\pi$。\n\n对于一维D类系统，$\\mathbb{Z}_2$拓扑不变量$\\nu$由这两个TRIMs之间基态费米子宇称的变化决定。它被定义为在这些点上Pfaffian符号的乘积：\n$$\\nu = \\operatorname{sgn}(\\operatorname{Pf}(A(k=0))) \\times \\operatorname{sgn}(\\operatorname{Pf}(A(k=\\pi)))$$\n- 如果 $\\nu = +1$，基态在$k=0$和$k=\\pi$处具有相同的费米子宇称。系统处于拓扑平庸相。\n- 如果 $\\nu = -1$，宇称发生改变，表明在某个$k \\in (0, \\pi)$处必须发生能带反转和拓扑相变。系统处于拓扑非平庸相，当链具有开放边界时，其两端会各承载一个受保护的马约拉纳零模。\n- 如果$\\operatorname{Pf}(A(0))$或$\\operatorname{Pf}(A(\\pi))$为零，能隙在该TRIM处闭合。这对应于一个拓扑相边界。\n\n**3. 应用于Kitaev链**\n\n问题给出了在Nambu基$\\Psi_k^\\dagger = (c_k^\\dagger, c_{-k})$下无自旋Kitaev链的Bogoliubov-de Gennes (BdG)哈密顿量：\n$$H(k) = \\xi(k)\\,\\tau_z + \\Delta \\sin k\\,\\tau_y = \\begin{pmatrix} \\xi(k) & -i\\Delta\\sin k \\\\ i\\Delta\\sin k & -\\xi(k) \\end{pmatrix}$$\n其中$\\xi(k) = -\\mu - 2t \\cos k$。在TRIMs $k=0$和$k=\\pi$处，$\\sin k$项为零。哈密顿量简化为$H(k) = \\xi(k)\\tau_z$。相应的马约拉纳矩阵$A(k)$变为块对角形式，而用于计算费米子宇称的相关子块由下式给出：\n$$A(k) = \\begin{pmatrix} 0 & g(k) \\\\ -g(k) & 0 \\end{pmatrix}, \\quad \\text{其中 } g(k) = \\xi(k) = -\\mu - 2t \\cos k$$\n对于 $k \\in \\{0, \\pi\\}$。这个$2\\times 2$矩阵的Pfaffian就是$\\operatorname{Pf}(A(k)) = g(k)$。\n\n因此，不变量的计算如下：\n$$\\nu = \\operatorname{sgn}(g(0)) \\times \\operatorname{sgn}(g(\\pi)) = \\operatorname{sgn}(-\\mu - 2t) \\times \\operatorname{sgn}(-\\mu + 2t)$$\n当且仅当$(-\\mu - 2t)$和$(-\\mu + 2t)$符号相反时，存在非平庸相($\\nu=-1$)。对于$t>0$，这简化为$|\\mu| < 2|t|$。\n\n**4. Pfaffian计算算法**\n\n问题要求实现一个通用的、数值稳定的算法来计算偶数维实反对称矩阵$A$的Pfaffian。指定的方法是一种递归消去过程。设$A$为一个$2n \\times 2n$的矩阵。\n\n1.  **基准情形**：如果$n=0$（矩阵是$0 \\times 0$），根据定义Pfaffian为$1$。\n2.  **主元选择**：为保证数值稳定性，我们选择一个主元$p = A_{i,j}$，使得$|A_{i,j}|$是最大的非对角元素（按量级）。然后我们进行行列交换，将该元素移到$A_{0,1}$位置。如果交换次数为奇数，此置换会带来一个符号变化。一个更简单、稳定的方法是找到第一行中的最大元素，比如说$A_{0,j}$，然后交换第1列/行与第j列/行。如果$j \\neq 1$，则符号改变为$(-1)$。\n3.  **递归步骤**：在选择主元后，矩阵具有以下形式：\n    $$A' = \\begin{pmatrix} 0 & p & \\mathbf{u} \\\\ -p & 0 & \\mathbf{v} \\\\ -\\mathbf{u}^\\top & -\\mathbf{v}^\\top & B \\end{pmatrix}$$\n    其中$p=A'_{0,1}$，$\\mathbf{u}=A'_{0,2:}$，$\\mathbf{v}=A'_{1,2:}$是大小为$2n-2$的行向量，而$B$是尾随的$(2n-2) \\times (2n-2)$反对称子矩阵。$A$的Pfaffian与从$B$导出的一个更小矩阵的Pfaffian相关。所需的更新规则，等价于求舒尔补的Pfaffian，是：\n    $$B_{new} = B + \\frac{1}{p}(v^T u - u^T v)$$\n    其中 $u^T v$ 表示行向量的外积。Pfaffian的递归关系是：\n    $$\\operatorname{Pf}(A) = (\\text{置换符号}) \\times p \\times \\operatorname{Pf}(B_{new})$$\n4.  **零Pfaffian**：如果矩阵的所有非对角元素都为零（在数值容差范围内），则Pfaffian为$0$。\n\n该算法为通用偶数维矩阵实现，然后应用于Kitaev链模型中的$2 \\times 2$矩阵，如题目所要求。使用一个带小容差的符号函数将Pfaffian值分类为$\\{-1, 0, +1\\}$。", "answer": "```python\nimport numpy as np\n\ndef pfaffian_recursive(matrix, tol=1e-12):\n    \"\"\"\n    Computes the Pfaffian of a real antisymmetric matrix using recursive\n    skew-symmetric elimination.\n\n    Args:\n        matrix (np.ndarray): A real, antisymmetric square matrix of even dimension.\n        tol (float): Tolerance for checking if a value is zero.\n\n    Returns:\n        float: The Pfaffian of the matrix.\n    \"\"\"\n    n = matrix.shape[0]\n    \n    if n % 2 != 0:\n        raise ValueError(\"Matrix must have an even dimension.\")\n    \n    if n == 0:\n        return 1.0\n\n    # Make a copy to avoid modifying the original matrix\n    A = matrix.copy()\n\n    # Find the largest off-diagonal element in magnitude to use as pivot for stability.\n    # We only need to search the upper triangle.\n    pivot_row, pivot_col = 0, 1\n    max_val = 0.0\n    for i in range(n):\n        for j in range(i + 1, n):\n            if abs(A[i, j]) > max_val:\n                max_val = abs(A[i, j])\n                pivot_row, pivot_col = i, j\n\n    if max_val < tol:\n        return 0.0\n\n    # Permutation sign from swaps\n    perm_sign = 1.0\n    \n    # Swap row/col pivot_row with 0\n    if pivot_row != 0:\n        A[[0, pivot_row], :] = A[[pivot_row, 0], :]\n        A[:, [0, pivot_row]] = A[:, [pivot_row, 0]]\n        perm_sign *= -1.0\n        \n    # Swap row/col pivot_col with 1\n    if pivot_col != 1:\n        # If pivot_col was originally 0, it's now at pivot_row\n        if pivot_col == 0:\n            pivot_col = pivot_row\n            \n        A[[1, pivot_col], :] = A[[pivot_col, 1], :]\n        A[:, [1, pivot_col]] = A[:, [pivot_col, 1]]\n        perm_sign *= -1.0\n        \n    p = A[0, 1]\n    \n    if n == 2:\n        return perm_sign * p\n\n    # Extract submatrices for the recursive step\n    B = A[2:, 2:]\n    u = A[0, 2:]  # Row vector\n    v = A[1, 2:]  # Row vector\n    \n    # Update trailing submatrix B using the specified formula\n    # np.outer(v, u) corresponds to v^T u in mathematical notation for row vectors u, v\n    B_new = B + (np.outer(v, u) - np.outer(u, v)) / p\n    \n    return perm_sign * p * pfaffian_recursive(B_new, tol)\n\ndef sign_pf(val, tol=1e-9):\n    \"\"\"\n    Computes the sign of the Pfaffian, treating values below tolerance as zero.\n    \"\"\"\n    if abs(val) < tol:\n        return 0\n    return 1 if val > 0 else -1\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test suite of the Kitaev chain.\n    \"\"\"\n    test_cases = [\n        # (t, mu, Delta)\n        (1.0, 0.0, 0.3),    # nontrivial\n        (1.0, 3.0, 0.3),    # trivial\n        (1.0, -3.0, 0.7),   # trivial\n        (1.0, 2.0, 0.5),    # boundary\n        (1.0, -2.0, 0.5),   # boundary\n        (-1.0, 0.0, 0.4),   # nontrivial (t<0)\n    ]\n\n    results = []\n    for t, mu, delta in test_cases:\n        # Define g(k) = -mu - 2*t*cos(k)\n        g0 = -mu - 2 * t * np.cos(0)\n        g_pi = -mu - 2 * t * np.cos(np.pi)\n        \n        # Construct the 2x2 Majorana matrices at k=0 and k=pi\n        A0 = np.array([[0, g0], [-g0, 0]])\n        A_pi = np.array([[0, g_pi], [-g_pi, 0]])\n        \n        # Compute Pfaffians using the general recursive algorithm\n        pf0 = pfaffian_recursive(A0)\n        pf_pi = pfaffian_recursive(A_pi)\n        \n        # Compute the signs\n        s0 = sign_pf(pf0)\n        s_pi = sign_pf(pf_pi)\n        \n        # Determine if the phase is topological (invariant nu = -1)\n        # It's topological only if s0*s_pi is strictly -1.\n        is_topological = (s0 * s_pi == -1)\n        \n        results.append([s0, s_pi, is_topological])\n\n    # Format the output string as a list of lists.\n    # str() on a list automatically adds brackets, which matches the required format.\n    result_strings = [str(r) for r in results]\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```", "id": "3003940"}, {"introduction": "在寻找马约拉纳零模的过程中，实验数据可能具有欺骗性；一个关键特征——零偏压电导峰——也可能由非拓扑的“伪”态产生。最后一个练习将我们从理想化的理论带到实验验证的复杂性中。你将分析平滑的势能变化如何产生模仿马约拉纳的平庸态，并评估不同的测量技术，以可靠地区分真正的拓扑零模与这些“冒名顶替者”[@problem_id:3003997]。", "problem": "一个位于$s$波超导体表面的由磁性吸附原子组成的铁磁链会形成一个Yu–Shiba–Rusinov能带，在存在自旋轨道耦合的情况下，其低能行为可以被一个有效无自旋$1\\mathrm{D}$超导通道所模拟，该通道由一个属于D对称性类且具有粒子-空穴对称性的Bogoliubov–de Gennes (BdG) 哈密顿量描述。考虑一个有效的连续谱描述，其中局域化学势 $ \\mu(x) $ 在链的末端附近于一个长度标度 $ \\ell $ 上平滑变化，该长度标度满足 $ k_F^{-1} \\ll \\ell \\lesssim \\xi $，其中 $ k_F $ 是演生的Shiba能带的费米波矢，$ \\xi $ 是由感应能隙决定的超导相干长度。假设在均匀参数下，该链处于拓扑平庸相。\n\n运用BdG形式主义的第一性原理以及平滑的空间非均匀性会为准粒子产生半经典转折点的概念，论证一个平滑的链末端势 $ \\mu(x) $ 如何能够在不改变体拓扑不变量的情况下产生近零能末端态。基于此机制，判断下列关于物理后果和区分性测量的陈述中哪些是正确的。\n\n选项:\n\nA. 一个缓慢变化的 $ \\mu(x) $ 可以在链末端产生局域化的近零能安德烈夫束缚态，其方式是产生一个空间区域，在该区域中，简化的一维狄拉克描述中的有效质量项改变符号，从而产生一对由软边界约束的强重叠马约拉纳分量；全局拓扑不变量保持平庸，因为体材料从未经历真正的能隙闭合。\n\nB. 在扫描隧道显微镜中，由平滑势产生的平庸末端态与真正的马约拉纳零模是无法区分的，因为即使在弱隧道耦合下，两者在零温下都必须产生 $ 2e^2/h $ 的量子化零偏压电导。\n\nC. 在一个具有有限充电能的悬浮Shiba链岛中，对一端施加门电压并测量两端的端到端非局域谱学显示，对于真正的马约拉纳零模，零偏压特征会表现出相关的移动和分裂，而平庸的平滑势末端态仅对门电压产生局域响应。\n\nD. 作为磁交换强度或有效化学势的函数，长均匀拓扑节段中真正的马约拉纳零模的能量分裂通常会以由 $ k_F $ 决定的波矢进行振荡，并随链长 $ L $ 以 $ e^{-L/\\xi} $ 的形式衰减，而平庸的平滑势末端态则在有限的参数范围内表现出能量钉扎在零能附近，且不伴有相干振荡。\n\nE. 自旋分辨隧道谱可以作为一个明确的判据：平庸的平滑势末端态继承了Yu–Shiba–Rusinov态的强自旋极化，因此产生高度自旋极化的零偏压峰，而在此设定下，真正的马约拉纳零模在所有能量下都是完全无自旋极化的。\n\n选择所有正确的陈述。", "solution": "问题陈述描述了凝聚态物理中一个与寻找马约拉纳零模（MZMs）相关的现实场景。它提出了一个系统——$s$波超导体上的铁磁原子链——这被认为是实现有效一维拓扑超导体的平台。问题的核心是区分“真正的”受拓扑保护的MZM与可能由链末端平滑势变化引起的“平庸的”近零能安德烈夫束缚态（ABS）。\n\n该问题具有科学依据、提法严谨且客观。所使用的所有术语，如Bogoliubov–de Gennes (BdG) 哈密顿量、D对称性类、Yu-Shiba-Rusinov (YSR) 能带、费米波矢 $k_F$ 和相干长度 $\\xi$ 等，都是该领域的标准术语。一个在其体材料中拓扑平庸的链，由于边界效应可以拥有近零能态，这一前提是当前研究的核心课题之一。因此，该问题是有效的。\n\n**理论框架**\n\n该系统的低能物理由一个有效的一维无自旋$p$波超导体描述。这样一个系统的BdG哈密顿量可以写作：\n$$ H_{BdG} = \\int dx \\, \\Psi^\\dagger(x) \\begin{pmatrix} -\\frac{\\hbar^2}{2m^*}\\partial_x^2 - \\mu(x) & \\Delta_p \\frac{\\hbar}{i}\\partial_x \\\\ \\Delta_p^* \\frac{\\hbar}{i}\\partial_x & \\frac{\\hbar^2}{2m^*}\\partial_x^2 + \\mu(x) \\end{pmatrix} \\Psi(x) $$\n其中 $\\Psi(x) = (\\psi(x), \\psi^\\dagger(x))^T$ 是Nambu旋量，$m^*$ 是有效质量，$\\Delta_p$ 是感应的$p$波配对振幅，$\\mu(x)$ 是局域化学势。\n\n拓扑相由体材料中化学势 $\\mu$ 的符号决定。对于一个均匀系统，当 $\\mu < 0$ 时，体是拓扑非平庸的，在每个末端拥有一个零能MZM。当 $\\mu > 0$ 时，体是拓扑平庸的，不存在受拓扑保护的末端态。\n\n问题陈述该体是拓扑平庸的，因此我们假设远离末端处 $\\mu(x) \\to \\mu_{bulk} > 0$。然而，靠近末端的平滑势 $\\mu(x)$ 可以变化。如果 $\\mu(x)$ 平滑变化并创造一个区域，使其局域行为如同处于拓扑相中（例如，通过下降到零以下），它就可以俘获一个低能ABS。这个态不是拓扑保护的，因为体不变量没有改变。它可以被理解为一个费米子激发 $c = \\gamma_1 + i\\gamma_2$，其两个马约拉纳分量 $\\gamma_1$ 和 $\\gamma_2$ 局域在链末端附近的同一区域。它们的空间重叠通常会导致有限的杂化能，使该态的能量从零分裂开。平滑的势可以使这个能量分裂偶然地变得很小，从而创建一个模拟真实MZM的“准马约拉纳”态。\n\n在此框架下，我们可以评估各个选项。\n\n**逐项分析**\n\n**A. 一个缓慢变化的 $ \\mu(x) $ 可以在链末端产生局域化的近零能安德烈夫束缚态，其方式是产生一个空间区域，在该区域中，简化的一维狄拉克描述中的有效质量项改变符号，从而产生一对由软边界约束的强重叠马约拉纳分量；全局拓扑不变量保持平庸，因为体材料从未经历真正的能隙闭合。**\n\n这个陈述准确地描述了“平庸”近零能态的形成机制。将BdG哈密顿量在费米点 $\\pm k_F$ 附近线性化，会得到一个类狄拉克方程，其中化学势 $\\mu$ 扮演了质量项的角色。该质量项改变符号的空间畴壁已知会束缚一个零能态（Jackiw-Rebbi模）。在此背景下，如果平滑势 $\\mu(x)$ 在末端附近局域地下降到零以下（而在体材料中为正），它就创造了这样一个畴壁，从而俘获了一个ABS。这个ABS，作为一个单一的局域化费米子，由两个共处一地（因此“强重叠”）的马约拉纳分量组成。由于体性质（其中 $\\mu > 0$）未变，全局拓扑不变量保持平庸。该描述在物理上是合理的。\n\n**结论：正确**\n\n**B. 在扫描隧道显微镜中，由平滑势产生的平庸末端态与真正的马约拉纳零模是无法区分的，因为即使在弱隧道耦合下，两者在零温下都必须产生 $ 2e^2/h $ 的量子化零偏压电导。**\n\n这个陈述是不正确的。在零温 $T=0$ 和弱隧道极限下，$ G = 2e^2/h $ 的量子化零偏压电导峰 (ZBCP) 是一个完美孤立MZM的标志性特征。这种量子化源于由MZM介导的完美安德烈夫反射。一个平庸的ABS，作为一个能量为 $E_{ABS}$ 的常规费米子态，会在偏置电压 $V = \\pm E_{ABS}/e$ 处产生两个电导峰。如果 $E_{ABS}$ 非常小，这些峰会合并成一个单一的ZBCP。然而，这个峰的高度通常不是量子化的，并且小于 $2e^2/h$。虽然对于一个能量非常接近零的态，其电子和空穴分量可能几乎相等，导致电导接近量子化值，但这并非像真正的MZM那样是一个必然或必须的特征。因此，两者*都必须*产生量子化峰的前提是错误的，原则上它们可以通过这一测量手段加以区分。\n\n**结论：错误**\n\n**C. 在一个具有有限充电能的悬浮Shiba链岛中，对一端施加门电压并测量两端的端到端非局域谱学显示，对于真正的马约拉纳零模，零偏压特征会表现出相关的移动和分裂，而平庸的平滑势末端态仅对门电压产生局域响应。**\n\n这个陈述描述了一个关键的非局域性测试。一个拓扑非平庸的链在其两端各拥有一个MZM，即 $\\gamma_A$ 和 $\\gamma_B$。这两个模式构成一个单一的、非局域的费米子自由度 $f = (\\gamma_A + i\\gamma_B)/2$，其占据状态决定了岛的电荷宇称。对一端（比如A端）附近的势施加门电压会扰动 $\\gamma_A$ 的波函数，这反过来又会影响整个非局域 $f$ 态的杂化能和性质。因此，在A端和B端进行的隧道谱测量都会显示出对A端门电压的相关响应（移动、分裂）。相比之下，平庸的末端态是局域的ABS。A端的态与B端的态在物理上是分离的。对A端施加门电压只会显著影响A端的局域ABS。B端的谱学测量对A端的门电压将基本不敏感（假设链足够长）。这种局域性与非局域性是一个根本的区别。\n\n**结论：正确**\n\n**D. 作为磁交换强度或有效化学势的函数，长均匀拓扑节段中真正的马约拉纳零模的能量分裂通常会以由 $ k_F $ 决定的波矢进行振荡，并随链长 $ L $ 以 $ e^{-L/\\xi} $ 的形式衰减，而平庸的平滑势末端态则在有限的参数范围内表现出能量钉扎在零能附近，且不伴有相干振荡。**\n\n这个陈述正确地对比了特征性的参数依赖关系。对于长度为 $L$ 的有限拓扑线，两端MZM的波函数会发生重叠，导致能量分裂 $\\delta E$。这个重叠积分依赖于来自两端波函数的干涉，从而导致对费米波矢 $k_F$ 和长度 $L$ 等参数的振荡依赖性，即 $\\delta E \\propto e^{-L/\\xi} \\cos(k_F L)$。当一个系统参数（如化学势或磁场）变化时，$k_F$ 改变，导致 $\\delta E$ 围绕零振荡。另一方面，平庸的末端态是单个束缚态，其能量 $E_{ABS}$ 由局域条件决定。它们的能量不表现出MZM杂化所特有的 $k_F L$ 振荡。相反，这些准马约拉纳态的能量可以在有限的参数范围内“粘滞”或“钉扎”在 $E=0$ 附近，这种行为可与D类系统中的无序诱导效应联系起来，之后再非周期性地偏离零能。这种在低能态的参数依赖性上的定性差异是一个有效且重要的判据。\n\n**结论：正确**\n\n**E. 自旋分辨隧道谱可以作为一个明确的判据：平庸的平滑势末端态继承了Yu–Shiba–Rusinov态的强自旋极化，因此产生高度自旋极化的零偏压峰，而在此设定下，真正的马约拉纳零模在所有能量下都是完全无自旋极化的。**\n\n这个陈述关于MZM自旋极化的部分实际上是错误的。所描述的系统（具有SOC的铁磁吸附原子）产生了一个有效的p波超导体，其中底层的电子是有自旋的。MZM是这些电子态和空穴态的叠加。由于强局域磁矩（铁磁链）和SOC的存在，没有普遍的对称性会强制MZM是无自旋极化的。事实上，针对此类系统的理论模型和数值模拟一致表明，MZM是自旋极化的，其极化方向与磁场和SOC轴相关联。虽然由极化YSR能带形成的平庸ABS也预期是自旋极化的，但声称真正的MZM是“完全无自旋极化的”是错误的。平庸ABS和真实MZM在自旋织构或取向上的差异可能是一个有效的判据，但此选项中提出的前提是错误的。\n\n**结论：错误**", "answer": "$$\\boxed{ACD}$$", "id": "3003997"}]}