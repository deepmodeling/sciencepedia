{"hands_on_practices": [{"introduction": "要真正掌握贝里相位的概念，没有比 Michael Berry 最初研究的系统更好的起点了：一个在缓慢旋转的磁场中的自旋-1/2粒子。本练习将引导您从第一性原理出发，推导这个原型模型的贝里相位。通过这个实践，您不仅将直接从量子力学计算出这个相位，还将揭示它与一个纯粹的几何量——参数路径所张立体角——之间的深刻联系 [@problem_id:2971723]。", "problem": "考虑一个自旋-1/2粒子处于时变磁场中，其哈密顿量为 $H(t) = -\\tfrac{\\Delta}{2}\\,\\hat{\\mathbf{n}}(t)\\cdot\\boldsymbol{\\sigma}$，其中 $\\Delta>0$ 是一个恒定的能量标度，$\\boldsymbol{\\sigma}$ 是泡利矩阵，$\\hat{\\mathbf{n}}(t)=\\mathbf{B}(t)/|\\mathbf{B}(t)|$是沿瞬时磁场方向的单位矢量。假设系统经历严格绝热演化，从而始终保持在 $H(t)$ 的瞬时非简并基态上。方向 $\\hat{\\mathbf{n}}(t)$ 在单位布洛赫球面上，于一个固定的极角 $\\theta_{0}\\in(0,\\pi)$ 处，描绘了一个闭合的纬线环路，同时方位角 $\\phi$ 从 $0$ 均匀增加到 $2\\pi$。\n\n从第一性原理出发，也即利用量子绝热定理以及瞬时非简并本征态在参数空间中沿闭合环路输运时的贝里联络和贝里相位的定义，推导基态在一个周期内累积的绝热贝里相位。然后，计算极角为 $\\theta_{0}$ 的纬线在布洛赫球面上所张的立体角，并比较这两个结果以建立它们之间的关系。\n\n将你得到的贝里相位的最终答案表示为关于 $\\theta_{0}$ 的单个闭式表达式，并将该相位以弧度为单位表示。", "solution": "该问题要求推导一个在缓慢旋转磁场中的自旋-1/2系统的基态所获得的贝里相位，并将其与磁场矢量路径所张的立体角联系起来。\n\n系统的哈密顿量由下式给出\n$$H(t) = -\\frac{\\Delta}{2}\\,\\hat{\\mathbf{n}}(t)\\cdot\\boldsymbol{\\sigma}$$\n其中 $\\Delta>0$，$\\boldsymbol{\\sigma} = (\\sigma_x, \\sigma_y, \\sigma_z)$ 是泡利矩阵，$\\hat{\\mathbf{n}}(t)$ 是一个单位矢量，在球坐标系下表示为\n$$\\hat{\\mathbf{n}}(t) = (\\sin\\theta_0 \\cos\\phi(t), \\sin\\theta_0 \\sin\\phi(t), \\cos\\theta_0)$$\n该路径是一个闭合环路，其中极角 $\\theta_0$ 恒定，$\\theta_0 \\in (0, \\pi)$，方位角 $\\phi(t)$ 从 $0$ 到 $2\\pi$ 均匀变化。\n\n首先，我们确定哈密顿量的瞬时本征态和本征值。矩阵 $\\hat{\\mathbf{n}}\\cdot\\boldsymbol{\\sigma}$ 的本征值为 $\\pm 1$。因此，$H(t)$ 的能量本征值为\n$$E_{\\pm} = \\mp \\frac{\\Delta}{2}$$\n由于 $\\Delta > 0$，基态对应于能量 $E_- = -\\frac{\\Delta}{2}$，激发态对应于能量 $E_+ = +\\frac{\\Delta}{2}$。题目说明系统保持在瞬时非简并基态，我们将其记为 $|u_-(t)\\rangle$。这个态是 $H(t)$ 能量为 $E_-$ 的本征态，这意味着它是 $\\hat{\\mathbf{n}}(t)\\cdot\\boldsymbol{\\sigma}$ 本征值为 $+1$ 的本征态。\n$$(\\hat{\\mathbf{n}}(t)\\cdot\\boldsymbol{\\sigma})|u_-(t)\\rangle = +1 |u_-(t)\\rangle$$\n$\\hat{\\mathbf{n}}\\cdot\\boldsymbol{\\sigma}$ 的矩阵表示为\n$$\\hat{\\mathbf{n}}\\cdot\\boldsymbol{\\sigma} = \\begin{pmatrix} n_z & n_x - i n_y \\\\ n_x + i n_y & -n_z \\end{pmatrix} = \\begin{pmatrix} \\cos\\theta_0 & \\sin\\theta_0 e^{-i\\phi(t)} \\\\ \\sin\\theta_0 e^{i\\phi(t)} & -\\cos\\theta_0 \\end{pmatrix}$$\n我们需要找到该矩阵对应本征值 $+1$ 的归一化本征矢量。沿 $(\\theta, \\phi)$ 方向的自旋向上态的一个标准选择是\n$$|u_-(\\theta, \\phi)\\rangle = \\begin{pmatrix} \\cos(\\frac{\\theta}{2}) \\\\ \\sin(\\frac{\\theta}{2}) e^{i\\phi} \\end{pmatrix}$$\n对于参数空间中的闭合路径，该本征矢量必须是单值的。对于路径 $\\theta=\\theta_0$ 且 $\\phi$ 从 $0$ 变到 $2\\pi$ 的情况，我们有 $|u_-(\\theta_0, 0)\\rangle = |u_-(\\theta_0, 2\\pi)\\rangle$，因此这种规范（相位）的选择是合适的。由于 $\\theta_0 \\in (0, \\pi)$，这个态在整个路径上都是良定义且光滑的。对我们的问题，基态为\n$$|u_-(t)\\rangle = |u_-(\\theta_0, \\phi(t))\\rangle = \\begin{pmatrix} \\cos(\\frac{\\theta_0}{2}) \\\\ \\sin(\\frac{\\theta_0}{2}) e^{i\\phi(t)} \\end{pmatrix}$$\n\n在参数空间中，沿闭合路径 $C$ 累积的绝热贝里相位 $\\gamma$ 由贝里联络 $\\mathbf{A}(t)$ 在该路径上的积分给出：\n$$\\gamma = \\oint_C \\mathbf{A} \\cdot d\\mathbf{R}$$\n其中 $\\mathbf{R}(t)$ 将路径参数化，贝里联络为 $\\mathbf{A}(t) = i \\langle u_-(t) | \\nabla_{\\mathbf{R}} u_-(t) \\rangle$。\n在我们的例子中，路径由方位角 $\\phi$ 参数化。贝里相位可以写为\n$$\\gamma = \\int_0^{2\\pi} A_\\phi d\\phi$$\n其中贝里联络沿路径的分量是 $A_\\phi = i \\langle u_-(\\phi) | \\frac{\\partial}{\\partial\\phi} | u_-(\\phi) \\rangle$。\n\n我们来计算这个分量。首先，我们求基态对 $\\phi$ 的偏导数：\n$$\\frac{\\partial}{\\partial\\phi} |u_-(\\phi)\\rangle = \\frac{\\partial}{\\partial\\phi} \\begin{pmatrix} \\cos(\\frac{\\theta_0}{2}) \\\\ \\sin(\\frac{\\theta_0}{2}) e^{i\\phi} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ i \\sin(\\frac{\\theta_0}{2}) e^{i\\phi} \\end{pmatrix}$$\n接下来，我们计算内积 $\\langle u_-(\\phi) | \\frac{\\partial}{\\partial\\phi} | u_-(\\phi) \\rangle$：\n$$\\langle u_-(\\phi) | \\frac{\\partial}{\\partial\\phi} | u_-(\\phi) \\rangle = \\begin{pmatrix} \\cos(\\frac{\\theta_0}{2}) & \\sin(\\frac{\\theta_0}{2}) e^{-i\\phi} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ i \\sin(\\frac{\\theta_0}{2}) e^{i\\phi} \\end{pmatrix}$$\n$$= (\\cos(\\frac{\\theta_0}{2}))(0) + (\\sin(\\frac{\\theta_0}{2}) e^{-i\\phi})(i \\sin(\\frac{\\theta_0}{2}) e^{i\\phi}) = i \\sin^2(\\frac{\\theta_0}{2})$$\n那么贝里联络分量 $A_\\phi$ 是\n$$A_\\phi = i \\left( i \\sin^2(\\frac{\\theta_0}{2}) \\right) = -\\sin^2(\\frac{\\theta_0}{2})$$\n现在，我们在闭合环路 $\\phi \\in [0, 2\\pi]$ 上对 $A_\\phi$ 进行积分，以求得贝里相位 $\\gamma$：\n$$\\gamma = \\int_0^{2\\pi} (-\\sin^2(\\frac{\\theta_0}{2})) d\\phi = -\\sin^2(\\frac{\\theta_0}{2}) \\int_0^{2\\pi} d\\phi = -2\\pi \\sin^2(\\frac{\\theta_0}{2})$$\n使用半角三角恒等式 $\\sin^2(\\frac{x}{2}) = \\frac{1}{2}(1-\\cos x)$，我们可以将贝里相位重写为：\n$$\\gamma = -2\\pi \\left(\\frac{1-\\cos\\theta_0}{2}\\right) = -\\pi(1-\\cos\\theta_0)$$\n\n接下来，我们计算环路在布洛赫球面上所张的立体角 $\\Omega$。该路径是一个纬度恒为 $\\theta_0$ 的圆。立体角是此路径所包围的球冠的面积，从北极（$\\theta=0$）开始测量。单位球面上的面积元是 $dA = \\sin\\theta d\\theta d\\phi$。\n立体角 $\\Omega$ 是该面积元在球冠上的积分：\n$$\\Omega = \\int_0^{2\\pi} d\\phi \\int_0^{\\theta_0} \\sin\\theta d\\theta$$\n$$\\Omega = 2\\pi \\int_0^{\\theta_0} \\sin\\theta d\\theta = 2\\pi [-\\cos\\theta]_0^{\\theta_0}$$\n$$\\Omega = 2\\pi (-\\cos\\theta_0 - (-\\cos 0)) = 2\\pi(1-\\cos\\theta_0)$$\n\n最后，我们比较推导出的贝里相位 $\\gamma$ 和立体角 $\\Omega$：\n$$\\gamma = -\\pi(1-\\cos\\theta_0)$$\n$$\\Omega = 2\\pi(1-\\cos\\theta_0)$$\n通过比较这两个表达式，我们建立如下关系：\n$$\\gamma = -\\frac{1}{2}\\Omega$$\n自旋-1/2基态累积的贝里相位等于磁场矢量在布洛赫球面上所描绘的闭合路径所张立体角的负二分之一。\n\n题目要求将贝里相位表示为单个闭式表达式。这就是我们得到的 $\\gamma$ 的结果。", "answer": "$$\n\\boxed{-\\pi(1-\\cos\\theta_0)}\n$$", "id": "2971723"}, {"introduction": "在闭合回线的几何相位基础上，我们现在探索这一概念如何推广为参数空间中一个曲面上的“通量”。本练习将处理一个经典的二能级哈密顿量 $H(\\mathbf{R})=\\mathbf{R}\\cdot\\boldsymbol{\\sigma}$，它是外尔半金属等拓扑现象的基础模型。您将发现，参数空间中 $\\mathbf{R}=0$ 处的简并点如同贝里曲率的“磁单极子”源，通过将此曲率在一个包围该点的球面上积分，您将计算出第一个量子化的拓扑不变量：陈数 [@problem_id:2971734]。", "problem": "考虑凝聚态物理中一个依赖于参数的两能级哈密顿量，由 $H(\\mathbf{R})=\\mathbf{R}\\cdot\\boldsymbol{\\sigma}$ 给出，其中 $\\mathbf{R}\\in\\mathbb{R}^{3}$ 是控制参数，$\\boldsymbol{\\sigma}$ 是泡利矩阵。关注在参数空间 $\\mathbb{R}^{3}\\setminus\\{\\mathbf{0}\\}$ 上定义的、本征值为 $-|\\mathbf{R}|$ 的非简并低能带。从一个绝热演化的非简并能带在参数空间中的贝里联络和贝里曲率的标准定义出发，显式地计算贝里曲率矢量场 $\\Omega(\\mathbf{R})$。然后，利用计算出的 $\\Omega(\\mathbf{R})$，在参数空间中任意一个半径为 $R_{0}>0$ 且包围了 $\\mathbf{R}=\\mathbf{0}$ 处简并点的球面 $S^{2}$ 上，计算与该能带相关的第一陈数，并验证其等于 $1$。您的推导过程应该是自洽的，并从基本定义开始，不使用任何现成的快捷公式。将最终的贝里曲率表示为笛卡尔矢量形式的闭合解析表达式，将陈数表示为一个精确整数。不需要数值舍入，也不需要物理单位。最终答案必须以一个解析表达式和一个数字的形式给出。", "solution": "解答过程主要分为三个部分：1) 求解哈密顿量的本征态，2) 从贝里联络计算贝里曲率，以及 3) 通过对曲率在球面上积分来计算陈数。\n\n**1. 哈密顿量的本征值与本征态**\n\n哈密顿量由 $H(\\mathbf{R}) = \\mathbf{R} \\cdot \\boldsymbol{\\sigma} = R_x \\sigma_x + R_y \\sigma_y + R_z \\sigma_z$ 给出。使用泡利矩阵的标准表示法，其矩阵形式为：\n$$\nH(\\mathbf{R}) = \\begin{pmatrix} R_z & R_x - iR_y \\\\ R_x + iR_y & -R_z \\end{pmatrix}\n$$\n本征值 $\\lambda$ 可通过求解特征方程 $\\det(H - \\lambda I) = 0$ 得到：\n$$\n\\det \\begin{pmatrix} R_z - \\lambda & R_x - iR_y \\\\ R_x + iR_y & -R_z - \\lambda \\end{pmatrix} = (-R_z - \\lambda)(R_z - \\lambda) - (R_x^2 + R_y^2) = 0\n$$\n$$\n\\lambda^2 - R_z^2 - R_x^2 - R_y^2 = 0 \\implies \\lambda^2 = |\\mathbf{R}|^2\n$$\n本征值为 $\\lambda_{\\pm} = \\pm |\\mathbf{R}|$。问题关注的是本征值为 $E_- = -|\\mathbf{R}|$ 的低能带。\n\n为了找到相应的本征矢量 $|u_-(\\mathbf{R})\\rangle$，方便起见，我们将矢量 $\\mathbf{R}$ 用球坐标参数化：$R_x = R\\sin\\theta\\cos\\phi$，$R_y = R\\sin\\theta\\sin\\phi$，$R_z = R\\cos\\theta$，其中 $R=|\\mathbf{R}|$。哈密顿量变为 $H = R(\\hat{\\mathbf{n}}\\cdot\\boldsymbol{\\sigma})$，其中 $\\hat{\\mathbf{n}} = \\mathbf{R}/R$。\n$$\nH = R \\begin{pmatrix} \\cos\\theta & \\sin\\theta e^{-i\\phi} \\\\ \\sin\\theta e^{i\\phi} & -\\cos\\theta \\end{pmatrix}\n$$\n对应于本征值 $-R$ 的归一化本征矢量是：\n$$\n|u_-(\\mathbf{R})\\rangle = \\begin{pmatrix} \\sin(\\theta/2) \\\\ -\\cos(\\theta/2)e^{i\\phi} \\end{pmatrix}\n$$\n这种规范选择在除了南极点（$\\theta = \\pi$）之外的所有地方都是良定义的，在南极点 $\\phi$ 不是唯一确定的。\n\n**2. 贝里联络与贝里曲率**\n\n贝里联络是参数空间中的一个矢量势 $\\mathbf{A}(\\mathbf{R})$，其分量定义为 $A_i = i\\langle u_-|\\partial_{R_i}|u_-\\rangle$。更方便的做法是先计算贝里联络的1-形式 $\\mathcal{A} = i\\langle u_-|d|u_-\\rangle$。在球坐标 $(R, \\theta, \\phi)$ 中，即为 $\\mathcal{A} = A_R dR + A_\\theta d\\theta + A_\\phi d\\phi$，其中各分量为：\n$$\nA_R = i\\langle u_-|\\frac{\\partial}{\\partial R}|u_-\\rangle, \\quad A_\\theta = i\\langle u_-|\\frac{\\partial}{\\partial \\theta}|u_-\\rangle, \\quad A_\\phi = i\\langle u_-|\\frac{\\partial}{\\partial \\phi}|u_-\\rangle\n$$\n态 $|u_-\\rangle$ 仅依赖于 $\\theta$ 和 $\\phi$。因此，$A_R = 0$。\n接下来，我们计算 $A_\\theta$：\n$$\n\\frac{\\partial}{\\partial\\theta}|u_-\\rangle = \\begin{pmatrix} \\frac{1}{2}\\cos(\\theta/2) \\\\ \\frac{1}{2}\\sin(\\theta/2)e^{i\\phi} \\end{pmatrix}\n$$\n$$\nA_\\theta = i \\left( \\sin(\\theta/2), -\\cos(\\theta/2)e^{-i\\phi} \\right) \\begin{pmatrix} \\frac{1}{2}\\cos(\\theta/2) \\\\ \\frac{1}{2}\\sin(\\theta/2)e^{i\\phi} \\end{pmatrix} = i \\left( \\frac{1}{2}\\sin(\\theta/2)\\cos(\\theta/2) - \\frac{1}{2}\\cos(\\theta/2)\\sin(\\theta/2) \\right) = 0\n$$\n现在，我们计算 $A_\\phi$：\n$$\n\\frac{\\partial}{\\partial\\phi}|u_-\\rangle = \\begin{pmatrix} 0 \\\\ -i\\cos(\\theta/2)e^{i\\phi} \\end{pmatrix}\n$$\n$$\nA_\\phi = i \\left( \\sin(\\theta/2), -\\cos(\\theta/2)e^{-i\\phi} \\right) \\begin{pmatrix} 0 \\\\ -i\\cos(\\theta/2)e^{i\\phi} \\end{pmatrix} = i \\left((-\\cos(\\theta/2)e^{-i\\phi})(-i\\cos(\\theta/2)e^{i\\phi})\\right) = i(i\\cos^2(\\theta/2)) = -\\cos^2(\\theta/2)\n$$\n贝里联络 1-形式为 $\\mathcal{A} = -\\cos^2(\\theta/2) d\\phi$。\n\n贝里曲率是 2-形式 $\\Omega = d\\mathcal{A}$，其中 $d$ 是外微分。\n$$\n\\Omega = d(-\\cos^2(\\theta/2) d\\phi) = -d(\\cos^2(\\theta/2)) \\wedge d\\phi\n$$\n$$\nd(\\cos^2(\\theta/2)) = 2\\cos(\\theta/2)(-\\sin(\\theta/2)) \\frac{1}{2} d\\theta = -\\frac{1}{2}\\sin\\theta d\\theta\n$$\n$$\n\\Omega = -(-\\frac{1}{2}\\sin\\theta d\\theta) \\wedge d\\phi = \\frac{1}{2}\\sin\\theta d\\theta \\wedge d\\phi\n$$\n问题要求的是贝里曲率矢量场 $\\boldsymbol{\\Omega}(\\mathbf{R})$。在 $\\mathbb{R}^3$ 中，它与曲率 2-形式的关系为 $\\Omega_{ij} = \\epsilon_{ijk} \\boldsymbol{\\Omega}_k$。$\\boldsymbol{\\Omega}$ 穿过一个面元 $d\\mathbf{S}$ 的通量等于 2-形式 $\\Omega$ 在该表面上的积分。在半径为 $R$ 的球面上，矢量面元为 $d\\mathbf{S} = R^2 \\sin\\theta d\\theta d\\phi \\, \\hat{R}$。通量为：\n$$\n\\boldsymbol{\\Omega} \\cdot d\\mathbf{S} = (\\boldsymbol{\\Omega} \\cdot \\hat{R}) R^2 \\sin\\theta d\\theta d\\phi\n$$\n将其与 $\\Omega$ 等同，我们得到：\n$$\n(\\boldsymbol{\\Omega} \\cdot \\hat{R}) R^2 \\sin\\theta d\\theta d\\phi = \\frac{1}{2}\\sin\\theta d\\theta d\\phi\n$$\n这意味着 $(\\boldsymbol{\\Omega} \\cdot \\hat{R}) R^2 = \\frac{1}{2}$。根据球对称性，曲率矢量必须指向径向方向，因此 $\\boldsymbol{\\Omega} = \\Omega_R \\hat{R}$。\n这得到 $\\Omega_R = \\frac{1}{2R^2}$。因此，贝里曲率矢量场为：\n$$\n\\boldsymbol{\\Omega}(\\mathbf{R}) = \\frac{1}{2R^2} \\hat{R}\n$$\n用笛卡尔矢量表示法，即为：\n$$\n\\boldsymbol{\\Omega}(\\mathbf{R}) = \\frac{\\mathbf{R}}{2|\\mathbf{R}|^3}\n$$\n这个场类似于位于原点的磁单极子的磁场。\n\n**3. 第一陈数**\n\n第一陈数 $C_1$ 是贝里曲率 2-形式在一个闭合二维流形上的积分除以 $2\\pi$。对于半径为 $R_0$ 的球面 $S^2$，计算如下：\n$$\nC_1 = \\frac{1}{2\\pi} \\iint_{S^2} \\Omega\n$$\n代入 $\\Omega$ 的表达式：\n$$\nC_1 = \\frac{1}{2\\pi} \\iint_{S^2} \\frac{1}{2}\\sin\\theta d\\theta \\wedge d\\phi\n$$\n积分在球坐标角度的整个范围内进行，$\\theta \\in [0, \\pi]$ 和 $\\phi \\in [0, 2\\pi]$：\n$$\nC_1 = \\frac{1}{4\\pi} \\int_0^{2\\pi} d\\phi \\int_0^\\pi \\sin\\theta d\\theta\n$$\n计算积分：\n$$\n\\int_0^{2\\pi} d\\phi = 2\\pi\n$$\n$$\n\\int_0^\\pi \\sin\\theta d\\theta = [-\\cos\\theta]_0^\\pi = -(-1) - (-1) = 2\n$$\n将这些结果代回 $C_1$ 的表达式中：\n$$\nC_1 = \\frac{1}{4\\pi} (2\\pi)(2) = 1\n$$\n或者，使用矢量形式，陈数是贝里曲率矢量场穿过球面的通量除以 $2\\pi$：\n$$\nC_1 = \\frac{1}{2\\pi} \\oiint_{S^2} \\boldsymbol{\\Omega} \\cdot d\\mathbf{S}\n$$\n在半径为 $R = R_0$ 的球面上，$\\boldsymbol{\\Omega}(\\mathbf{R}) = \\frac{1}{2R_0^2}\\hat{R}$ 且 $d\\mathbf{S} = \\hat{R} R_0^2 \\sin\\theta d\\theta d\\phi$。\n$$\n\\boldsymbol{\\Omega} \\cdot d\\mathbf{S} = \\left(\\frac{1}{2R_0^2}\\hat{R}\\right) \\cdot \\left(\\hat{R} R_0^2 \\sin\\theta d\\theta d\\phi\\right) = \\frac{1}{2} \\sin\\theta d\\theta d\\phi\n$$\n这个积分与上面的积分相同，证实了 $C_1=1$。这验证了所要求的结果。陈数是一个整数不变量，它反映了在 $\\mathbf{R}=\\mathbf{0}$ 处的 Weyl 点周围能带结构的拓扑性质。\n\n最终结果是贝里曲率矢量场的表达式和第一陈数的值。\n贝里曲率：$\\boldsymbol{\\Omega}(\\mathbf{R}) = \\frac{\\mathbf{R}}{2|\\mathbf{R}|^3}$。\n陈数：$C_1 = 1$。", "answer": "$$\n\\boxed{\\boldsymbol{\\Omega}(\\mathbf{R}) = \\frac{\\mathbf{R}}{2|\\mathbf{R}|^3}, \\quad C_1=1}\n$$", "id": "2971734"}, {"introduction": "当拓扑学的理论洞见能够应用于实际材料时，它们才真正显示出强大的力量，而这通常需要数值计算。最后一个练习旨在通过实现一个稳定的数值算法，在离散化的布里渊区上计算布洛赫哈密顿量的陈数，从而弥合连续介质理论与计算凝聚态物理之间的鸿沟。您将学习如何使用借鉴自格点规范理论的“链接变量”技术来处理布洛赫态的规范自由度，并在每个格点方块上构建一个规范不变的量，以确定全局拓扑不变量 [@problem_id:2971710]。", "problem": "给定一个定义在均匀网格上的方形布里渊区 (BZ) 上的双能带布洛赫哈密顿量，具有周期性边界条件。该哈密顿量为\n$$\nH(\\mathbf{k}) = d_x(\\mathbf{k})\\,\\sigma_x + d_y(\\mathbf{k})\\,\\sigma_y + d_z(\\mathbf{k})\\,\\sigma_z,\n$$\n其中 $\\sigma_x,\\sigma_y,\\sigma_z$ 为泡利矩阵，各分量为\n$$\nd_x(\\mathbf{k}) = \\sin k_x,\\quad d_y(\\mathbf{k}) = \\sin k_y,\\quad d_z(\\mathbf{k}) = m + \\cos k_x + \\cos k_y,\n$$\n$\\mathbf{k} = (k_x,k_y)$ 遍历布里渊区 $[-\\pi,\\pi)\\times[-\\pi,\\pi)$。参数 $m$ 是一个实质量项。\n\n从非简并能带的几何客体——贝里联络 $\\mathcal{A}_\\mu(\\mathbf{k})$ 及其旋度——贝里曲率 $\\mathcal{F}_{xy}(\\mathbf{k})$ 的基本定义出发，仅使用占据（低能）能带的归一化元胞周期布洛赫本征态的最近邻交叠，构建布里渊区有限网格上 $\\mathcal{F}_{xy}(\\mathbf{k})$ 的一个稳定、规范不变且数值上稳健的离散化方法。您的构建必须从贝里联络和贝里曲率的定义开始，并按以下步骤进行：\n- 基于低能带元胞周期本征态的归一化交叠，定义布里渊区网格上最近邻点之间的有向链路变量的概念，该变量能消除任意的局域相位选择。\n- 为每个元格构建一个规范不变量，该量在连续极限下通过离散形式的斯托克斯定理恢复为穿过该元格的贝里通量。\n- 从元格变量的主辐角中确定每个元格上的格点场强，该场强是一个位于区间 $(-\\pi,\\pi]$ 内的实数。\n- 将整个布里渊区网格上的格点场强求和，并除以 $2\\pi$ 进行归一化，从而获得低能带的整数量子化陈数。\n\n您的程序必须按如下方式实现此方案：\n- 构建一个布里渊区的均匀 $N\\times N$ 网格，其中 $k_x \\in [-\\pi,\\pi)$ 和 $k_y \\in [-\\pi,\\pi)$ 在每个方向上采样 $N$ 个点，间距为 $\\Delta k = 2\\pi/N$。该网格必须在两个方向上都使用周期性边界条件。\n- 对于网格上的每个 $\\mathbf{k}$，计算 $H(\\mathbf{k})$ 的本征矢量，并选择对应于低能带的归一化本征矢量作为元胞周期布洛赫态 $|u(\\mathbf{k})\\rangle$。\n- 仅使用 $|u(\\mathbf{k})\\rangle$ 与 $|u(\\mathbf{k}+\\hat{\\mu})\\rangle$（其中 $\\mu \\in \\{x,y\\}$）之间的最近邻交叠，沿布里渊区网格的格点方向构建单位模的有向链路变量。使用这些有向链路为每个元格构建一个规范不变的元格变量，并从中得到一个位于 $(-\\pi,\\pi]$ 区间内的实数格点场强值。\n- 将所有元格上的格点场强求和，然后除以 $2\\pi$ 得到一个实数，再四舍五入到最近的整数，以报告低能带的陈数。\n\n无需输入。请使用以下参数对 $(m,N)$ 的测试套件，并为每种情况计算低能带的整数陈数：\n- 测试 $1$: $(m,N) = (-1.0,\\,21)$\n- 测试 $2$: $(m,N) = (1.0,\\,21)$\n- 测试 $3$: $(m,N) = (3.0,\\,21)$\n- 测试 $4$: $(m,N) = (-1.5,\\,9)$\n- 测试 $5$: $(m,N) = (0.2,\\,41)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4,r_5]$），其中每个 $r_i$ 是相应测试计算出的整数陈数。不应打印任何其他文本。角度以弧度为单位。没有需要报告的物理单位。", "solution": "该问题要求在离散化的布里渊区 (BZ) 上，计算给定双能带布洛赫哈密顿量的低能带的陈数。该方法必须从第一性原理出发，始于贝里联络和贝里曲率的定义，最终形成一个数值稳定、规范不变的算法。所指定的方法是由 Fukui、Hatsugai 和 Suzuki 发展的成熟的格点规范理论方法。\n\n### 理论构建与数值策略\n\n#### 1. 哈密顿量及其本征态\n该系统由一个二维方形布里渊区上的 $2 \\times 2$ 布洛赫哈密顿量 $H(\\mathbf{k})$ 描述，其中 $\\mathbf{k}=(k_x, k_y) \\in [-\\pi, \\pi) \\times [-\\pi, \\pi)$：\n$$ H(\\mathbf{k}) = \\mathbf{d}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma} = d_x(\\mathbf{k})\\sigma_x + d_y(\\mathbf{k})\\sigma_y + d_z(\\mathbf{k})\\sigma_z $$\n其中 $\\boldsymbol{\\sigma} = (\\sigma_x, \\sigma_y, \\sigma_z)$ 为泡利矩阵。$\\mathbf{d}$-矢量的分量由下式给出：\n$$ d_x(\\mathbf{k}) = \\sin k_x $$\n$$ d_y(\\mathbf{k}) = \\sin k_y $$\n$$ d_z(\\mathbf{k}) = m + \\cos k_x + \\cos k_y $$\n该哈密顿量的能量本征值为 $E_{\\pm}(\\mathbf{k}) = \\pm |\\mathbf{d}(\\mathbf{k})| = \\pm \\sqrt{d_x^2 + d_y^2 + d_z^2}$。为使陈数有良定义，能带之间必须存在能隙，即对所有 $\\mathbf{k}$ 都有 $|\\mathbf{d}(\\mathbf{k})| \\neq 0$。\n对于每个动量 $\\mathbf{k}$，我们找到对应于低能（占据）能带 $E_-(\\mathbf{k})$ 的归一化元胞周期布洛赫本征态 $|u(\\mathbf{k})\\rangle$。\n\n#### 2. 贝里相位、联络和曲率\n与能带相关的基本几何量是贝里联络，定义为：\n$$ \\mathcal{A}_{\\mu}(\\mathbf{k}) = i \\langle u(\\mathbf{k}) | \\partial_{k_\\mu} u(\\mathbf{k}) \\rangle, \\quad \\mu \\in \\{x,y\\} $$\n本征态 $|u(\\mathbf{k})\\rangle$ 的定义只在一个任意的、依赖于 $\\mathbf{k}$ 的相位因子 $e^{i\\phi(\\mathbf{k})}$ 内是确定的，即 $|u(\\mathbf{k})\\rangle \\to e^{i\\phi(\\mathbf{k})}|u(\\mathbf{k})\\rangle$。这是一种 U(1) 规范自由度。在这种变换下，贝里联络的变换行为类似于规范势：$\\mathcal{A}_{\\mu}(\\mathbf{k}) \\to \\mathcal{A}_{\\mu}(\\mathbf{k}) - \\partial_{k_\\mu} \\phi(\\mathbf{k})$。\n\n物理的、规范不变的量是贝里曲率，即联络的“旋度”：\n$$ \\mathcal{F}_{xy}(\\mathbf{k}) = \\partial_{k_x} \\mathcal{A}_y(\\mathbf{k}) - \\partial_{k_y} \\mathcal{A}_x(\\mathbf{k}) $$\n陈数 $C$ 是一个拓扑不变量，定义为贝里曲率穿过整个布里渊区的总通量，并以 $2\\pi$ 为单位进行量子化：\n$$ C = \\frac{1}{2\\pi} \\int_{\\text{BZ}} \\mathcal{F}_{xy}(\\mathbf{k}) \\, d k_x d k_y $$\n由于 $|u(\\mathbf{k})\\rangle$ 的规范不定性以及计算导数的需要，直接对该积分进行数值计算是具有挑战性的。\n\n#### 3. 格点离散化与规范不变表述\n为创建一个稳健的数值算法，我们将布里渊区离散化为一个均匀的 $N \\times N$ 网格，格点为 $\\mathbf{k}_{ij} = (-\\pi + i \\frac{2\\pi}{N}, -\\pi + j \\frac{2\\pi}{N})$，并采用周期性边界条件。我们在每个格点上计算低能带的本征态 $|u(\\mathbf{k})\\rangle$。\n\n连续导数被有限差分链路变量所取代。连接两个相邻点 $\\mathbf{k}$ 和 $\\mathbf{k}+\\hat{\\mu}\\Delta k$（其中 $\\hat{\\mu}$ 是 $k_x$ 或 $k_y$ 方向的单位向量）的链路变量由相应本征态的交叠定义：\n$$ U_{\\mu}(\\mathbf{k}) = \\frac{\\langle u(\\mathbf{k}) | u(\\mathbf{k}+\\hat{\\mu}) \\rangle}{|\\langle u(\\mathbf{k}) | u(\\mathbf{k}+\\hat{\\mu}) \\rangle|} $$\n这个量是一个模为1的复数，即 U(1) 群的一个元。在连续极限 $\\Delta k \\to 0$下，$U_{\\mu}(\\mathbf{k}) \\approx e^{-i\\mathcal{A}_\\mu(\\mathbf{k})\\Delta k}$。虽然单个链路变量是规范依赖的，但可以通过将它们沿一个闭合回路的乘积来构造一个规范不变量。对于一个始于 $\\mathbf{k}$ 的元格，其元格变量（或称威尔逊圈）为：\n$$ W(\\mathbf{k}) = U_x(\\mathbf{k}) U_y(\\mathbf{k}+\\hat{x}) U_x^*(\\mathbf{k}+\\hat{y}) U_y^*(\\mathbf{k}) $$\n该乘积对应于遍历元格的边界：$\\mathbf{k} \\to \\mathbf{k}+\\hat{x} \\to \\mathbf{k}+\\hat{x}+\\hat{y} \\to \\mathbf{k}+\\hat{y} \\to \\mathbf{k}$。规范依赖的相位因子会完全抵消，使得 $W(\\mathbf{k})$ 成为规范不变量。\n\n元格变量的辐角定义了格点场强 $F_{xy}(\\mathbf{k})$，它代表了穿过该元格的总贝里通量：\n$$ F_{xy}(\\mathbf{k}) = \\arg(W(\\mathbf{k})) $$\n为唯一定义该通量，辐角必须取其主值，$F_{xy}(\\mathbf{k}) \\in (-\\pi, \\pi]$。在连续极限下，$F_{xy}(\\mathbf{k}) \\approx \\mathcal{F}_{xy}(\\mathbf{k}) (\\Delta k)^2$。\n\n#### 4. 陈数的计算\n根据离散形式的斯托克斯定理，曲率在整个布里渊区上的积分变成了对所有元格上局域格点场强的求和：\n$$ C = \\frac{1}{2\\pi} \\sum_{\\mathbf{k} \\in \\text{grid}} F_{xy}(\\mathbf{k}) $$\n求和是在离散化的布里渊区的所有 $N \\times N$ 个元格上进行的。这个和的结果必须是一个整数，反映了陈数的拓扑性质。数值计算结果将是一个非常接近整数的实数，随后对其进行四舍五入。\n\n### 算法实现\n该算法使用 Python 的 `numpy` 库实现，以进行高效的向量化操作。\n1.  生成一个用于 $(k_x, k_y)$ 的 $N \\times N$ 网格。\n2.  将哈密顿量 $H(\\mathbf{k})$ 构建为一个 `(N, N, 2, 2)` 数组，以便使用 `numpy.linalg.eigh` 在所有 $\\mathbf{k}$ 点上同时进行对角化。\n3.  提取低能带的本征矢量 $|u(\\mathbf{k})\\rangle$，存入一个 `(N, N, 2)` 数组中。\n4.  将链路变量 $U_x$ 和 $U_y$ 计算为 `(N, N)` 数组。使用 `numpy.roll` 高效地计算最近邻交叠，以处理周期性边界条件。\n5.  通过单次向量化操作计算所有元格的元格变量 $W$，同样使用 `numpy.roll` 来访问移位格点上的链路变量。\n6.  使用 `numpy.angle` 获得格点场强 $F_{xy}$。\n7.  最后，将 $F_{xy}$ 的所有元素求和，除以 $2\\pi$ 并四舍五入到最近的整数，得到陈数。\n此过程应用于每个测试用例 $(m, N)$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_chern_number(m: float, N: int) -> int:\n    \"\"\"\n    Computes the Chern number of the lower band for a 2-band Hamiltonian\n    on a discretized Brillouin zone using the Fukui-Hatsugai-Suzuki method.\n\n    Args:\n        m (float): The mass parameter in the Hamiltonian.\n        N (int): The number of grid points in each direction of the BZ.\n\n    Returns:\n        int: The computed integer Chern number.\n    \"\"\"\n    # 1. Discretize the Brillouin Zone (BZ)\n    # The grid spans [-pi, pi) with N points.\n    k_vals = np.linspace(-np.pi, np.pi, N, endpoint=False)\n    # meshgrid with 'xy' indexing (default) means kx varies along axis 1 (columns)\n    # and ky varies along axis 0 (rows).\n    kx, ky = np.meshgrid(k_vals, k_vals)\n\n    # 2. Construct the Hamiltonian H(k) = d(k) . sigma for all k\n    # H = [[dz, dx - i*dy], [dx + i*dy, -dz]]\n    dx = np.sin(kx)\n    dy = np.sin(ky)\n    dz = m + np.cos(kx) + np.cos(ky)\n\n    # Vectorized Hamiltonian construction over the entire BZ grid\n    H = np.zeros((N, N, 2, 2), dtype=np.complex128)\n    H[..., 0, 0] = dz\n    H[..., 1, 1] = -dz\n    H[..., 0, 1] = dx - 1j * dy\n    H[..., 1, 0] = dx + 1j * dy\n\n    # 3. Diagonalize H(k) and get the lower-band eigenvector |u(k)>\n    # np.linalg.eigh returns eigenvalues sorted in ascending order.\n    # The first eigenvector corresponds to the lower-energy band.\n    # The output eigvecs has shape (N, N, 2, 2). eigvecs[..., :, 0] gives\n    # the first eigenvector for each (k_x, k_y) point.\n    _, eigvecs = np.linalg.eigh(H)\n    u = eigvecs[..., :, 0]  # Shape: (N, N, 2)\n\n    # 4. Calculate U(1) link variables U_mu(k)\n    u_conj = np.conj(u)\n\n    # Link variable U_x: overlap between u(k) and u(k + x_hat)\n    # A shift in the +x direction corresponds to a roll along axis=1.\n    u_x_next = np.roll(u, -1, axis=1)\n    overlap_x = np.sum(u_conj * u_x_next, axis=2)\n    Ux = overlap_x / np.abs(overlap_x)\n\n    # Link variable U_y: overlap between u(k) and u(k + y_hat)\n    # A shift in the +y direction corresponds to a roll along axis=0.\n    u_y_next = np.roll(u, -1, axis=0)\n    overlap_y = np.sum(u_conj * u_y_next, axis=2)\n    Uy = overlap_y / np.abs(overlap_y)\n\n    # 5. Form the gauge-invariant plaquette variable W(k)\n    # W(k) = U_x(k) * U_y(k+x_hat) * U_x(k+y_hat)^-1 * U_y(k)^-1\n    # U_y(k+x_hat) is Uy shifted by -1 in the x-direction (axis 1)\n    # U_x(k+y_hat) is Ux shifted by -1 in the y-direction (axis 0)\n    Uy_shifted_x = np.roll(Uy, -1, axis=1)\n    Ux_shifted_y = np.roll(Ux, -1, axis=0)\n\n    W = Ux * Uy_shifted_x * np.conj(Ux_shifted_y) * np.conj(Uy)\n\n    # 6. Calculate lattice field strength F_xy(k)\n    # np.angle returns the principal argument in the interval (-pi, pi]\n    F_xy = np.angle(W)\n\n    # 7. Sum F_xy over all plaquettes, divide by 2*pi, and round to the nearest integer\n    chern_number_raw = np.sum(F_xy) / (2 * np.pi)\n    chern_number = np.round(chern_number_raw).astype(int)\n\n    return chern_number\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (-1.0, 21),  # Test 1\n        (1.0, 21),   # Test 2\n        (3.0, 21),   # Test 3\n        (-1.5, 9),   # Test 4\n        (0.2, 41),   # Test 5\n    ]\n\n    results = []\n    for m, N in test_cases:\n        result = compute_chern_number(m, N)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2971710"}]}