{"hands_on_practices": [{"introduction": "节点线半金属中的能带交叠并非偶然，它们通常受到晶体对称性的拓扑保护。本练习将通过一个简洁的低能有效模型，帮助你深入理解这一核心概念。你将亲手验证，当破坏保护节点环的特定对称性（在本例中为联合的时间反演与空间反演对称性 $PT$）时，系统会打开一个能隙，从半金属相转变为绝缘体相，并精确计算出这个由对称性破缺引入的质量项。[@problem_id:3007268]", "problem": "考虑一个在对称性保护的节线环附近、具有联合空间反演和时间反演对称性（宇称-时间对称性，简写为 $PT$）的三维空间中的无自旋双带布洛赫哈密顿量。假设在该环的邻域内，低能哈密顿量可以用柱坐标 $k_{\\rho} = k_{\\rho}\\cos\\phi$，$k_{y} = k_{\\rho}\\sin\\phi$，$k_{z}$ 写为\n$$\nH_{0}(\\mathbf{k}) \\;=\\; d_{x}(\\mathbf{k})\\,\\sigma_{x} \\;+\\; d_{z}(\\mathbf{k})\\,\\sigma_{z},\n$$\n其分量为\n$$\nd_{x}(\\mathbf{k}) \\;=\\; v_{\\rho}\\big(k_{\\rho} - k_{0}\\big),\\qquad d_{z}(\\mathbf{k}) \\;=\\; v_{z}\\,k_{z},\n$$\n其中 $v_{\\rho} \\!>\\! 0$，$v_{z} \\!>\\! 0$ 是实速度，$k_{0} \\!>\\! 0$ 设定了节线环在 $k_{z}\\!=\\!0$ 平面内的半径，$\\sigma_{x}$、$\\sigma_{z}$ 是作用于双带轨道子空间中的泡利矩阵。你可以假设，对于无自旋费米子，$PT$ 对称性意味着在适当的基底下，对于所有的 $\\mathbf{k}$，$H_{0}(\\mathbf{k})$ 都是一个实矩阵。\n\n(a) 仅利用所述的对称性推论以及给定的 $H_{0}(\\mathbf{k})$ 形式，解释为什么 $H_{0}(\\mathbf{k})$ 的能谱呈现出一个节线环，并确定其在动量空间中的位置。\n\n(b) 现在加上在位项\n$$\nH_{m} \\;=\\; m\\,\\sigma_{y},\n$$\n其中 $m \\neq 0$ 是一个实常数。从 $PT$ 如何作用于矩阵和复共轭的第一性原理出发，论证为什么在无自旋情况下该项会破坏 $PT$ 对称性，并论证总哈密顿量 $H(\\mathbf{k}) = H_{0}(\\mathbf{k}) + H_{m}$ 变为完全有能隙的。\n\n(c) 定义 $q_{\\rho} \\equiv k_{\\rho} - k_{0}$ 和 $q_{z} \\equiv k_{z}$ 为相对于原节线环的横向小偏离量。在固定动量 $\\mathbf{k}$ 处的直接带隙定义为该动量下导带和价带之间的能量差。推导直接带隙 $\\Delta(q_{\\rho},q_{z})$ 的解析表达式，用 $m$、$v_{\\rho}$、$v_{z}$、$q_{\\rho}$ 和 $q_{z}$ 表示，且在这些偏离量的主导阶下有效。你的最终答案必须是单一的闭合形式表达式。不要近似或四舍五入；保留所有已定义的符号。以无单位的解析表达式给出你的最终答案。", "solution": "问题陈述已经过验证，被认为是具有科学依据、提法得当且客观的。它代表了凝聚态物理学中描述节线半金属及对称性破缺微扰效应的一个标准模型。因此，我们可以着手提供完整解答。\n\n问题要求对一个节线半金属的双带哈密顿量模型进行分三部分的分析。\n\n(a) 在 $H_{0}(\\mathbf{k})$ 中确定节线环。\n\n给定的哈密顿量为 $H_{0}(\\mathbf{k}) = d_{x}(\\mathbf{k})\\,\\sigma_{x} + d_{z}(\\mathbf{k})\\,\\sigma_{z}$。这是一个 $2 \\times 2$ 矩阵，其一般形式为 $\\mathbf{d}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma}$，其中 $\\boldsymbol{\\sigma} = (\\sigma_{x}, \\sigma_{y}, \\sigma_{z})$ 是泡利矩阵矢量，而 $\\mathbf{d}(\\mathbf{k}) = (d_{x}(\\mathbf{k}), 0, d_{z}(\\mathbf{k}))$。这类哈密顿量的能量本征值为 $E_{\\pm}(\\mathbf{k}) = \\pm |\\mathbf{d}(\\mathbf{k})|$。\n在本问题中，本征值为：\n$$\nE_{\\pm}(\\mathbf{k}) = \\pm \\sqrt{d_{x}(\\mathbf{k})^{2} + d_{z}(\\mathbf{k})^{2}}\n$$\n节点特征，或称能谱中的简并，出现在两能带之间的能隙闭合处。这意味着 $E_{+}(\\mathbf{k}) = E_{-}(\\mathbf{k})$，而这仅在两能带的能量都为零时才可能发生。这要求 $\\mathbf{d}$ 矢量的模为零：\n$$\n|\\mathbf{d}(\\mathbf{k})| = \\sqrt{d_{x}(\\mathbf{k})^{2} + d_{z}(\\mathbf{k})^{2}} = 0\n$$\n这一个条件等价于实函数 $d_{x}(\\mathbf{k})$ 和 $d_{z}(\\mathbf{k})$ 需同时满足的两个条件：\n1. $d_{x}(\\mathbf{k}) = v_{\\rho}(k_{\\rho} - k_{0}) = 0$。由于给定 $v_{\\rho}>0$，这意味着 $k_{\\rho} = k_{0}$。\n2. $d_{z}(\\mathbf{k}) = v_{z}k_{z} = 0$。由于给定 $v_{z}>0$，这意味着 $k_{z} = 0$。\n\n动量空间 $(\\mathbf{k})$ 中同时满足这两个条件的点集由 $k_{\\rho} = \\sqrt{k_x^2 + k_y^2} = k_{0}$ 和 $k_{z}=0$ 定义。这是在 $k_{z}=0$ 平面内、以原点为中心、半径为 $k_{0}$ 的圆的方程。这就是节线环。\n\n题目指明，对于具有 $PT$ 对称性的无自旋费米子，哈密顿量 $H_0(\\mathbf{k})$ 可以选择为一个实矩阵。一个一般的 $2 \\times 2$ 哈密顿量为 $H = d_0 I + d_x\\sigma_x + d_y\\sigma_y + d_z\\sigma_z$。由于 $\\sigma_x$ 和 $\\sigma_z$ 是实矩阵，而 $\\sigma_y$ 是纯虚矩阵，因此 $H_0(\\mathbf{k})$ 为实的条件（假设系数 $d_i$ 为实数）意味着 $\\sigma_y$ 的系数必须为零，即 $d_y(\\mathbf{k})=0$。在一个一般的三维系统中，闭合能隙需要满足三个条件（$d_x=0, d_y=0, d_z=0$），这通常只发生在孤立点（Weyl点）。$PT$ 对称性通过强制所有 $\\mathbf{k}$ 的 $d_y(\\mathbf{k})=0$，将简并所需的条件数量从三个减少到两个。$d_x(\\mathbf{k})=0$ 和 $d_z(\\mathbf{k})=0$ 这两个条件在三维动量空间中定义了一条线，在本例中即为节线环。\n\n(b) $PT$ 对称性破缺和能隙的打开。\n\n附加项为 $H_{m} = m\\,\\sigma_{y}$，其中 $m$ 是一个非零实常数。我们需要从第一性原理出发，论证为何这一项会破坏 $PT$ 对称性。对于无自旋系统，时间反演算符就是复共轭算符，$T = K$。宇称算符 $P$ 反转动量，$\\mathbf{k} \\to -\\mathbf{k}$。如果一个哈密顿量 $H$ 在联合操作下不变，即 $(PT)H(PT)^{-1} = H$，则称其具有 $PT$ 对称性。\n\n我们来分析 $PT$ 对 $H_m$ 项的作用。由于 $H_m$ 与动量 $\\mathbf{k}$ 无关，宇称算符在轨道基底下对其的作用是平凡的（即 $P H_m P^{-1} = H_m$）。那么完整的 $PT$ 算符的作用是：\n$$\n(PT)H_{m}(PT)^{-1} = K (P H_{m} P^{-1}) K^{-1} = K H_{m} K^{-1}\n$$\n代入 $H_m = m\\sigma_y$ 并注意到 $m$ 是一个实常数，得到：\n$$\nK (m\\sigma_{y}) K^{-1} = m K \\sigma_{y} K^{-1} = m \\sigma_{y}^{*}\n$$\n泡利矩阵 $\\sigma_y$ 由 $\\sigma_{y} = \\begin{pmatrix} 0 & -i \\\\ i & 0 \\end{pmatrix}$ 给出。其复共轭为 $\\sigma_{y}^{*} = \\begin{pmatrix} 0 & i \\\\ -i & 0 \\end{pmatrix} = -\\sigma_{y}$。\n因此，我们有：\n$$\n(PT)H_{m}(PT)^{-1} = -m\\sigma_{y} = -H_{m}\n$$\n$H_m$ 满足 $PT$ 对称性的条件是 $(PT)H_{m}(PT)^{-1} = H_{m}$，这意味着 $-H_m = H_m$。这只有在 $H_m=0$（即要求 $m=0$）时才成立。而题目中说明 $m \\neq 0$，因此 $H_m$ 项破坏了 $PT$ 对称性。\n\n现在我们论证总哈密顿量 $H(\\mathbf{k}) = H_{0}(\\mathbf{k}) + H_{m}$ 是完全有能隙的。新的哈密顿量是：\n$$\nH(\\mathbf{k}) = d_{x}(\\mathbf{k})\\,\\sigma_{x} + m\\,\\sigma_{y} + d_{z}(\\mathbf{k})\\,\\sigma_{z}\n$$\n这具有 $\\mathbf{d'}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma}$ 的形式，其中新的矢量为 $\\mathbf{d'}(\\mathbf{k}) = (d_{x}(\\mathbf{k}), m, d_{z}(\\mathbf{k}))$。能量本征值为 $E'_{\\pm}(\\mathbf{k}) = \\pm |\\mathbf{d'}(\\mathbf{k})|$。\n$$\nE'_{\\pm}(\\mathbf{k}) = \\pm \\sqrt{d_{x}(\\mathbf{k})^{2} + m^{2} + d_{z}(\\mathbf{k})^{2}}\n$$\n如果对于任何 $\\mathbf{k}$，能带之间的能量差始终非零，则系统是有能隙的。这意味着本征值永远不能为零。零本征值将要求 $|\\mathbf{d'}(\\mathbf{k})|=0$，即 $d_{x}(\\mathbf{k})^{2} + m^{2} + d_{z}(\\mathbf{k})^{2} = 0$。由于 $d_x$、$d_z$ 和 $m$ 都是实数，它们的平方是非负的。它们的和仅在每一项都为零时才可能为零：$d_x(\\mathbf{k})=0$、$m=0$ 和 $d_z(\\mathbf{k})=0$。然而，问题指明 $m \\neq 0$。因此，平方根下的量 $[v_{\\rho}(k_{\\rho}-k_{0})]^2 + m^2 + [v_z k_z]^2$ 对于所有 $\\mathbf{k}$ 值都严格为正。其最小值为 $m^2$，出现在原来的节线环位置（$k_\\rho=k_0, k_z=0$）。由于本征值永不为零，所以能谱是完全有能隙的。\n\n(c) 直接带隙的推导。\n\n在给定动量 $\\mathbf{k}$ 处的直接带隙 $\\Delta$ 是该动量下导带 ($E'_{+}$) 和价带 ($E'_{-}$) 的能量之差。\n$$\n\\Delta(\\mathbf{k}) = E'_{+}(\\mathbf{k}) - E'_{-}(\\mathbf{k})\n$$\n使用在 (b) 部分推导出的本征值：\n$$\n\\Delta(\\mathbf{k}) = \\left(\\sqrt{d_{x}^{2} + m^{2} + d_{z}^{2}}\\right) - \\left(-\\sqrt{d_{x}^{2} + m^{2} + d_{z}^{2}}\\right) = 2\\sqrt{d_{x}^{2} + m^{2} + d_{z}^{2}}\n$$\n问题要求用小动量偏离量 $q_{\\rho} = k_{\\rho} - k_{0}$ 和 $q_{z} = k_{z}$ 来表示该表达式。该模型哈密顿量已经对这些偏离量进行了线性化，即 $d_{x}(\\mathbf{k}) = v_{\\rho}(k_{\\rho} - k_{0}) = v_{\\rho}q_{\\rho}$ 和 $d_{z}(\\mathbf{k}) = v_{z}k_{z} = v_{z}q_{z}$。这些是节线环附近哈密顿量分量的主导阶项。将它们代入能隙的表达式中，我们得到了与这个主导阶哈密顿量一致的能隙表达式。\n$$\n\\Delta(q_{\\rho},q_{z}) = 2\\sqrt{(v_{\\rho}q_{\\rho})^{2} + m^{2} + (v_{z}q_{z})^{2}}\n$$\n这可以简化为：\n$$\n\\Delta(q_{\\rho},q_{z}) = 2\\sqrt{v_{\\rho}^{2}q_{\\rho}^{2} + m^{2} + v_{z}^{2}q_{z}^{2}}\n$$\n这就是在给定的主导阶模型内有效的、直接带隙的最终闭合形式解析表达式。", "answer": "$$\n\\boxed{2 \\sqrt{v_{\\rho}^{2} q_{\\rho}^{2} + m^{2} + v_{z}^{2} q_{z}^{2}}}\n$$", "id": "3007268"}, {"introduction": "拓扑物态一个深刻的特性是其非平庸的体拓扑性质会对应着独特的边界态，这便是所谓的“体-边对应”原理。对于节点线半金属，其标志性的表面态被称为“鼓膜态”（drumhead states）。本计算实践将引导你将一个体哈密顿量转化为有限厚度的板层（slab）模型，并通过数值计算来寻找这些能量钉扎在费米面附近的、且局域在材料表面的鼓膜态，从而将抽象的拓扑概念与可观测的物理现象联系起来。[@problem_id:3007279]", "problem": "考虑一个简单立方晶格上的最小双带紧束缚模型，该模型实现了一个在波矢分量 $k_z = 0$ 的平面上具有节线环的节线半金属。动量空间中的布洛赫哈密顿量由下式给出：\n$$\nH(\\mathbf{k}) = \\left[m - t_{xy}\\left(\\cos k_x + \\cos k_y\\right) - t_z \\cos k_z\\right]\\sigma_z + v \\sin k_z \\,\\sigma_x,\n$$\n其中 $\\mathbf{k} = (k_x,k_y,k_z)$，$\\sigma_x$ 和 $\\sigma_z$ 是作用于轨道空间的泡利矩阵，$m$、$t_{xy}$、$t_z$ 和 $v$ 是实数参数。所有能量均为无量纲，并以晶格常数为 $1$ 的单位表示，所有角度均以弧度为单位。\n\n从紧束缚哈密顿量和布洛赫定理的定义出发，并利用沿单一轴向在实空间和动量空间之间的离散傅里叶变换，对一个具有 $N$ 层且晶体动量 $(k_x,k_y)$ 固定的平板，沿 $z$ 轴实现开放边界条件。您的实现必须：\n- 推导出实空间平板哈密顿量 $H_{\\text{slab}}(k_x,k_y)$，该哈密顿量是一个由 $2 \\times 2$ 块构成的块三对角矩阵，仅使用给定的布洛赫哈密顿量所隐含的沿 $z$ 轴的最近邻层耦合。\n- 数值对角化 $H_{\\text{slab}}(k_x,k_y)$ 以获得本征值 $E_\\alpha$ 和归一化本征矢量 $\\lvert \\psi_\\alpha \\rangle$。\n- 通过计算每个本征态在前 $s$ 层和后 $s$ 层上的概率权重来量化表面局域化：\n$$\nw_{\\text{left},\\alpha} = \\sum_{n=1}^{s} \\sum_{o=1}^{2} \\left\\lvert \\psi_\\alpha(n,o) \\right\\rvert^2,\\quad\nw_{\\text{right},\\alpha} = \\sum_{n=N-s+1}^{N} \\sum_{o=1}^{2} \\left\\lvert \\psi_\\alpha(n,o) \\right\\rvert^2,\n$$\n其中 $\\psi_\\alpha(n,o)$ 是在第 $n$ 层和轨道 $o$ 上的振幅。\n- 如果在 $(k_x,k_y)$ 处存在至少一个满足 $\\lvert E_\\alpha \\rvert \\le \\delta$ 和 $\\max\\{w_{\\text{left},\\alpha}, w_{\\text{right},\\alpha}\\} \\ge w_{\\text{th}}$ 的本征态，则声明该处存在一个表面鼓膜态。\n\n在所有计算中使用以下固定参数值：\n- $m = 1.5$，$t_{xy} = 1.0$，$t_z = 1.0$，$v = 0.6$。\n- 平板厚度 $N = 80$ 层。\n- 表面窗口厚度 $s = 4$ 层。\n- 能量窗口 $\\delta = 0.08$。\n- 表面局域化阈值 $w_{\\text{th}} = 0.3$。\n\n测试套件。对于上述固定模型和参数，评估以下四个 $(k_x,k_y)$ 点（角度以弧度为单位）是否存在表面鼓膜态：\n- 情况 1：$(k_x,k_y) = (0,0)$。\n- 情况 2：$(k_x,k_y) = (\\pi,\\pi)$。\n- 情况 3：$(k_x,k_y) = (2\\pi/3,0)$。\n- 情况 4：$(k_x,k_y) = (\\pi,0)$。\n\n您的程序应生成单行输出，其中包含一个 Python 布尔字面量的逗号分隔列表，用方括号括起来，并按上述情况的顺序排列，例如 $[{\\tt True},{\\tt False},{\\tt False},{\\tt True}]$。由于模型是无量纲的，且所有角度都以弧度为单位，因此没有物理单位需要报告。最终输出是单行上的四个布尔值列表。程序必须是自包含的，且无需用户输入。", "solution": "我们从紧束缚描述和布洛赫定理出发。对于一个平移不变的晶体，布洛赫哈密顿量 $H(\\mathbf{k})$ 编码了沿各个方向的跃迁振幅。要沿选定轴施加开放边界条件，需要沿该轴执行离散傅里叶逆变换，以恢复具有有限层数且仅包含动量空间中已存在耦合的实空间表示。\n\n给定的布洛赫哈密顿量为\n$$\nH(\\mathbf{k}) = M(\\mathbf{k})\\,\\sigma_z + A(\\mathbf{k})\\,\\sigma_x,\n$$\n其中\n$$\nM(\\mathbf{k}) = m - t_{xy}\\left(\\cos k_x + \\cos k_y\\right) - t_z \\cos k_z, \\quad A(\\mathbf{k}) = v \\sin k_z.\n$$\n对于固定的平面内动量 $(k_x,k_y)$，$k_z$ 的依赖关系决定了沿 $z$ 方向的实空间层间耦合结构。使用傅里叶恒等式\n$$\n\\cos k_z = \\tfrac{1}{2}\\left(e^{ik_z} + e^{-ik_z}\\right), \\quad \\sin k_z = \\tfrac{1}{2i}\\left(e^{ik_z} - e^{-ik_z}\\right),\n$$\n我们可以确定，$\\cos k_z$ 贡献了在前向和后向近邻之间对称的最近邻层跃迁项，而 $\\sin k_z$ 则由于与 $\\sigma_x$ 相乘，贡献了在轨道基中反对称且纯非对角的最近邻层跃迁项。\n\n让我们将平板哈密顿量 $H_{\\text{slab}}(k_x,k_y)$ 写成一个维度为 $2N \\times 2N$ 的块三对角矩阵，其中 $N$ 是层数，每个块作用于双轨道内部空间。每层上的在位块为\n$$\nH_0(k_x,k_y) = \\left[m - t_{xy}\\left(\\cos k_x + \\cos k_y\\right)\\right]\\sigma_z,\n$$\n从第 $n$ 层到第 $n+1$ 层的最近邻层跃迁块为\n$$\nT = -\\tfrac{t_z}{2}\\,\\sigma_z - i\\,\\tfrac{v}{2}\\,\\sigma_x,\n$$\n其厄密共轭 $T^\\dagger = -\\tfrac{t_z}{2}\\,\\sigma_z + i\\,\\tfrac{v}{2}\\,\\sigma_x$ 描述了从第 $n+1$ 层耦合回第 $n$ 层的过程。这些直接从 $k_z$ 依赖关系的傅里叶逆变换得出：\n- 项 $-t_z \\cos k_z\\,\\sigma_z$ 在前向和后向的最近邻层跃迁中都变换为 $-\\tfrac{t_z}{2}\\,\\sigma_z$。\n- 项 $v \\sin k_z\\,\\sigma_x$ 在前向跃迁中变换为 $-\\tfrac{i v}{2}\\,\\sigma_x$，在后向跃迁中变换为 $+\\tfrac{i v}{2}\\,\\sigma_x$，以确保厄密性。\n\n因此，在开放边界条件下，$H_{\\text{slab}}(k_x,k_y)$ 在所有对角 $2 \\times 2$ 块上为 $H_0$，在第一上非对角块上为 $T$，在第一下非对角块上为 $T^\\dagger$。边界层没有超出边缘的耦合。\n\n为判断表面鼓膜态，我们对角化 $H_{\\text{slab}}(k_x,k_y)$ 以获得长度为 $2N$ 的本征值 $E_\\alpha$ 和归一化本征矢量 $\\lvert \\psi_\\alpha \\rangle$。我们将每个本征矢量的分量重塑为层和轨道指数，使得 $\\psi_\\alpha(n,o)$ 是在第 $n \\in \\{1,\\dots,N\\}$ 层和轨道 $o \\in \\{1,2\\}$ 上的振幅。左、右表面的局域化权重定义为\n$$\nw_{\\text{left},\\alpha} = \\sum_{n=1}^{s} \\sum_{o=1}^{2} \\left\\lvert \\psi_\\alpha(n,o) \\right\\rvert^2, \\quad\nw_{\\text{right},\\alpha} = \\sum_{n=N-s+1}^{N} \\sum_{o=1}^{2} \\left\\lvert \\psi_\\alpha(n,o) \\right\\rvert^2,\n$$\n其中 $s$ 是定义表面区域的层数。如果同时满足以下两个标准，则一个态被识别为表面鼓膜态：\n- 能量接近于零：$\\lvert E_\\alpha \\rvert \\le \\delta$。\n- 表面局域化：$\\max\\{w_{\\text{left},\\alpha}, w_{\\text{right},\\alpha}\\} \\ge w_{\\text{th}}$。\n\n这个标准是基于节线半金属中鼓膜态的拓扑表征而具有物理动机的。对于这个最小模型，在固定的 $(k_x,k_y)$ 和两个时间反演不变动量点 $k_z = 0$ 和 $k_z = \\pi$ 处的有效“质量”分别为\n$$\nM_0(k_x,k_y) = m - t_{xy}\\left(\\cos k_x + \\cos k_y\\right) - t_z, \\quad\nM_\\pi(k_x,k_y) = m - t_{xy}\\left(\\cos k_x + \\cos k_y\\right) + t_z.\n$$\n拓扑鼓膜表面态的存在与条件 $M_0(k_x,k_y) M_\\pi(k_x,k_y) < 0$ 相关联，该条件可简化为一个平面内不等式，定义了一个由节线环所界定的区域，在该区域内体能隙闭合。对于所选参数，该区域对应于 $\\cos k_x + \\cos k_y > 0.5$，因此像 $(k_x,k_y) = (0,0)$ 这样的点预计会存在鼓膜态，而像 $(\\pi,\\pi)$ 这样远在区域外的点则不会。\n\n算法设计：\n- 输入为固定的模型参数 $m = 1.5$，$t_{xy} = 1.0$，$t_z = 1.0$，$v = 0.6$，平板厚度 $N = 80$，表面窗口 $s = 4$，能量窗口 $\\delta = 0.08$，以及局域化阈值 $w_{\\text{th}} = 0.3$。\n- 对于每个测试点 $(k_x,k_y)$：根据上述推导构建 $H_0(k_x,k_y)$ 和 $T$；组装 $2N \\times 2N$ 的厄密矩阵；对其进行对角化，获得所有本征值和本征矢量；根据两个标准筛选本征态，以确定是否存在鼓膜态。\n- 为每个测试用例返回一个布尔值，表示是否找到了至少一个鼓膜态。\n\n测试套件：\n- 情况 1：$(k_x,k_y) = (0,0)$，预计在节线环投影内部。\n- 情况 2：$(k_x,k_y) = (\\pi,\\pi)$，预计在外部。\n- 情况 3：$(k_x,k_y) = (2\\pi/3,0)$，预计位于由 $\\cos k_x + \\cos k_y = 0.5$ 定义的边界上。\n- 情况 4：$(k_x,k_y) = (\\pi,0)$，预计在外部。\n\n程序按上述顺序输出单行，包含一个 Python 风格的四个布尔值列表。所有计算都是无量纲的，所有角度都以弧度为单位。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_slab_hamiltonian(kx, ky, params, N):\n    \"\"\"\n    Construct the 2N x 2N slab Hamiltonian with open boundaries along z.\n    params: dict with keys m, txy, tz, v\n    \"\"\"\n    m = params[\"m\"]\n    txy = params[\"txy\"]\n    tz = params[\"tz\"]\n    v = params[\"v\"]\n\n    # Pauli matrices\n    sx = np.array([[0.0, 1.0],\n                   [1.0, 0.0]], dtype=np.complex128)\n    sz = np.array([[1.0, 0.0],\n                   [0.0, -1.0]], dtype=np.complex128)\n\n    # Onsite block H0(kx,ky) = [m - txy (cos kx + cos ky)] * sz\n    H0_coeff = (m - txy * (np.cos(kx) + np.cos(ky)))\n    H0 = H0_coeff * sz\n\n    # Nearest-layer hopping T = -(tz/2) * sz - i (v/2) * sx\n    T = -(tz / 2.0) * sz - 1j * (v / 2.0) * sx\n    T_dag = T.conj().T\n\n    dim = 2 * N\n    H = np.zeros((dim, dim), dtype=np.complex128)\n\n    # Fill diagonal blocks\n    for n in range(N):\n        i0 = 2 * n\n        H[i0:i0+2, i0:i0+2] = H0\n\n    # Fill off-diagonal nearest-layer blocks\n    for n in range(N - 1):\n        i0 = 2 * n\n        j0 = 2 * (n + 1)\n        H[i0:i0+2, j0:j0+2] = T\n        H[j0:j0+2, i0:i0+2] = T_dag\n\n    return H\n\ndef surface_drumhead_present(kx, ky, params, N, s, delta, wthr):\n    \"\"\"\n    Determine if a drumhead surface state is present for given (kx,ky).\n    Criteria: exists eigenstate with |E| <= delta and surface weight >= wthr.\n    \"\"\"\n    H = build_slab_hamiltonian(kx, ky, params, N)\n    # Hermitian eigen-decomposition\n    evals, evecs = np.linalg.eigh(H)\n\n    # Reshape eigenvectors to (N,2) per state for probability computations\n    present = False\n    # Pre-compute layer indices for left and right surfaces\n    left_layers = list(range(0, s))\n    right_layers = list(range(N - s, N))\n\n    for idx, E in enumerate(evals):\n        if abs(E) <= delta:\n            vec = evecs[:, idx]\n            # Reshape to (N, 2)\n            psi = vec.reshape(N, 2)\n            # Probability per layer (sum over orbitals)\n            layer_prob = np.sum(np.abs(psi)**2, axis=1).real\n            # Normalization safety (should already be normalized)\n            total = np.sum(layer_prob)\n            if total <= 0:\n                continue\n            # Compute surface weights\n            w_left = float(np.sum(layer_prob[left_layers]))\n            w_right = float(np.sum(layer_prob[right_layers]))\n            if max(w_left, w_right) >= wthr:\n                present = True\n                break\n\n    return present\n\ndef solve():\n    # Fixed parameters as specified in the problem\n    params = {\n        \"m\": 1.5,\n        \"txy\": 1.0,\n        \"tz\": 1.0,\n        \"v\": 0.6,\n    }\n    N = 80\n    s = 4\n    delta = 0.08\n    wthr = 0.3\n\n    # Test cases: angles in radians\n    test_cases = [\n        (0.0, 0.0),                 # Case 1: inside\n        (np.pi, np.pi),             # Case 2: outside\n        (2.0 * np.pi / 3.0, 0.0),   # Case 3: boundary\n        (np.pi, 0.0),               # Case 4: outside\n    ]\n\n    results = []\n    for kx, ky in test_cases:\n        res = surface_drumhead_present(kx, ky, params, N, s, delta, wthr)\n        results.append(res)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3007279"}, {"introduction": "除了通过计算表面态来揭示拓扑性质，我们还可以运用更普适和强大的数学工具——威尔逊循环（Wilson loop）——直接从体哈密顿量中提取拓扑不变量。本练习将指导你数值计算沿着动量空间中特定闭合路径的威尔逊循环，并计算其本征相位，即贝里相位。你将发现，当一个路径与节点线“环环相扣”时，它会积累一个量子化的 $\\pi$ 贝里相位，这为探测和表征节点线提供了一种不依赖于边界的有力方法。[@problem_id:3007283]", "problem": "给定一个三维动量空间中的双能带布洛赫哈密顿量，其设计旨在承载一个对称性保护的节线环。该哈密顿量由一个系数矢量和泡利矩阵定义为 $$H(\\mathbf{k}) = d_x(\\mathbf{k})\\,\\sigma_x + d_y(\\mathbf{k})\\,\\sigma_y + d_z(\\mathbf{k})\\,\\sigma_z,$$ 其中 $$d_x(\\mathbf{k}) = k_0^2 - k_x^2 - k_y^2,\\quad d_y(\\mathbf{k}) = \\alpha\\, k_y\\, k_z,\\quad d_z(\\mathbf{k}) = k_z.$$ 此处，$\\sigma_x$、$\\sigma_y$ 和 $\\sigma_z$ 是泡利矩阵，$\\mathbf{k} = (k_x,k_y,k_z)$ 是晶体动量。在该模型中，当 $$k_z = 0 \\quad\\text{且}\\quad k_x^2 + k_y^2 = k_0^2$$ 时，能带发生接触，形成一条节线。\n\n从占据带布洛赫态 $|u(\\mathbf{k})\\rangle$ 的贝里联络的定义 $$\\mathbf{A}(\\mathbf{k}) = i \\langle u(\\mathbf{k})|\\nabla_{\\mathbf{k}} u(\\mathbf{k})\\rangle,$$ 以及动量空间中沿闭合回路 $\\mathcal{C}$ 的威尔逊回路（贝里联络的路径排序指数）的定义 $$\\mathcal{W}[\\mathcal{C}] = \\mathcal{P}\\exp\\left(i\\oint_{\\mathcal{C}} \\mathbf{A}(\\mathbf{k})\\cdot d\\mathbf{k}\\right),$$ 出发，您必须沿着一族闭合回路数值实现占据子空间的威尔逊回路。这些回路是位于垂直于 $k_x$ 轴的平面内的圆。每个回路由一个角度 $\\phi$（单位为弧度）参数化为 $$\\mathbf{k}(\\phi) = \\big(a,\\ r\\cos\\phi,\\ z_0 + r\\sin\\phi\\big),\\quad \\phi \\in [0,2\\pi),$$ 其中 $a$ (沿 $k_x$ 的偏移量)、$r$ (半径) 和 $z_0$ (沿 $k_z$ 的垂直偏移量) 是常数。对于每个回路，将路径在 $\\phi$ 中离散化为 $N$ 个等间距点，并通过将相邻点上占据带本征矢量之间的交叠矩阵相乘来构造威尔逊回路。在单占据带的情况下，威尔逊回路简化为一个复相位 $e^{i\\gamma}$，其中 $\\gamma$ 是围绕该回路累积的贝里相位。\n\n您的任务是：\n- 通过将 $\\phi$ 离散化为 $N$ 个点，并计算相邻点之间占据带本征矢量的归一化交叠的乘积，来实现沿指定闭合路径的威尔逊回路。计算中要包括最后一个点与第一个点的连接以闭合回路。使用在占据子空间层面保持规范不变性的良态数值方法。\n- 提取威尔逊回路的本征相位。在当前模型中，只有一个占据带，因此威尔逊回路有一个本征相位 $\\gamma$（单位为弧度）。\n- 基于本征相位，计算一个用于节线环绕的检测指标。环绕回路必须产生一个等于 $\\pi$ 模 $2\\pi$（弧度）的贝里相位 $\\gamma$，而非环绕回路产生的 $\\gamma$ 约等于 $0$ 模 $2\\pi$。如果 $\\gamma$ 在 $\\pi$ 模 $2\\pi$ 的容差 $\\delta$ 范围内，则将布尔检测结果定义为“真”(true)，否则为“假”(false)。全程使用弧度作为角度单位。\n\n使用以下测试套件，其中每个元组代表 $(k_0,\\ \\alpha,\\ a,\\ r,\\ z_0,\\ N,\\ \\delta)$，$\\delta$ 是相位容差：\n- 情况1（理想路径，环绕）：$(1.0,\\ 0.8,\\ 1.0,\\ 0.3,\\ 0.0,\\ 400,\\ 0.1)$。\n- 情况2（远距离非环绕）：$(1.0,\\ 0.8,\\ 3.0,\\ 0.3,\\ 0.0,\\ 400,\\ 0.1)$。\n- 情况3（环绕，带垂直偏移的微小回路）：$(1.0,\\ 0.8,\\ 1.0,\\ 0.001,\\ 0.1,\\ 800,\\ 0.1)$。\n- 情况4（作为边缘情况的粗糙离散化环绕）：$(1.0,\\ 0.8,\\ 1.0,\\ 0.3,\\ 0.0,\\ 32,\\ 0.2)$。\n\n科学真实性要求：\n- 对于每种情况，假设较低的能带被占据。\n- 确保回路不穿过节线；所提供的参数是为了避免直接的简并点。\n- 使用弧度作为角度单位，并报告反映回路是否与节线环绕的检测布尔值。\n\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“$[{\\rm True},{\\rm False},{\\rm True},{\\rm True}]$”）。输出值必须是布尔值。不应打印任何其他文本。", "solution": "所提出的问题是凝聚态物理领域中一个有效且良定的计算练习，特别涉及节线半金属的拓扑性质。任务是为一个给定的双能带哈密顿量数值实现威尔逊回路的计算，以验证与节线相关的拓扑荷。所测试的主要物理原理是：动量空间中一个与节线环绕的闭合回路会累积一个量子化的贝里相位 $\\pi$。\n\n该问题的基础是三维动量空间 $\\mathbf{k} = (k_x, k_y, k_z)$ 中的双能带布洛赫哈密顿量 $H(\\mathbf{k})$。该哈密顿量表示为泡利矩阵 $\\mathbf{\\sigma} = (\\sigma_x, \\sigma_y, \\sigma_z)$ 的线性组合：\n$$H(\\mathbf{k}) = \\mathbf{d}(\\mathbf{k}) \\cdot \\mathbf{\\sigma} = d_x(\\mathbf{k})\\,\\sigma_x + d_y(\\mathbf{k})\\,\\sigma_y + d_z(\\mathbf{k})\\,\\sigma_z$$\n其矩阵形式为：\n$$H(\\mathbf{k}) = \\begin{pmatrix} d_z(\\mathbf{k}) & d_x(\\mathbf{k}) - i d_y(\\mathbf{k}) \\\\ d_x(\\mathbf{k}) + i d_y(\\mathbf{k}) & -d_z(\\mathbf{k}) \\end{pmatrix}$$\n矢量 $\\mathbf{d}(\\mathbf{k})$ 的分量定义为：\n$$d_x(\\mathbf{k}) = k_0^2 - k_x^2 - k_y^2$$\n$$d_y(\\mathbf{k}) = \\alpha\\, k_y\\, k_z$$\n$$d_z(\\mathbf{k}) = k_z$$\n该系统的能量本征值为 $E_{\\pm}(\\mathbf{k}) = \\pm |\\mathbf{d}(\\mathbf{k})| = \\pm \\sqrt{d_x(\\mathbf{k})^2 + d_y(\\mathbf{k})^2 + d_z(\\mathbf{k})^2}$。能带接触点或简并点出现在能隙闭合处，即 $E_+(\\mathbf{k}) = E_-(\\mathbf{k}) = 0$。这等价于条件 $|\\mathbf{d}(\\mathbf{k})| = 0$，要求 $d_x$、$d_y$ 和 $d_z$ 三个分量同时为零。这个条件，$k_z = 0$ 且 $k_x^2 + k_y^2 = k_0^2$，定义了一个位于 $k_z=0$ 平面内、半径为 $k_0$ 的圆形节线。问题规定，对应于本征值 $E_-(\\mathbf{k})$ 的较低能带是占据带。\n\n核心任务是计算此占据带沿着指定闭合路径 $\\mathcal{C}$ 的威尔逊回路 $\\mathcal{W}[\\mathcal{C}]$。该路径是一个位于 $k_x=a$ 恒定值平面上的圆，由角度 $\\phi \\in [0, 2\\pi)$ 参数化：\n$$\\mathbf{k}(\\phi) = (a,\\ r\\cos\\phi,\\ z_0 + r\\sin\\phi)$$\n为了数值计算威尔逊回路，此连续路径被离散化为 $N$ 个小步。我们定义 $N$ 个离散动量点 $\\mathbf{k}_j = \\mathbf{k}(\\phi_j)$，其中角度为 $\\phi_j = 2\\pi j/N$，对于 $j=0, 1, \\dots, N-1$。\n\n在离散路径上的每个点 $\\mathbf{k}_j$，我们必须找到占据带对应的布洛赫态，记为 $|u_j\\rangle \\equiv |u(\\mathbf{k}_j)\\rangle$。这通过数值对角化 $2 \\times 2$ 的哈密顿量矩阵 $H(\\mathbf{k}_j)$ 并选取对应于较低本征值 $E_-(\\mathbf{k}_j)$ 的本征矢量来实现。\n\n有了占据带本征矢量集合 $\\{|u_j\\rangle\\}$，威尔逊回路便可构造为路径上相邻点之间本征矢量内积（交叠）的乘积。由于只有一个占据带，威尔逊回路 $\\mathcal{W}[\\mathcal{C}]$ 是一个我们记为 $W$ 的复标量。其离散近似由以下乘积给出：\n$$W = \\prod_{j=0}^{N-1} \\langle u_j | u_{(j+1)\\%N} \\rangle$$\n其中 $|u_{(j+1)\\%N}\\rangle$ 索引中的模运算符确保通过最后的交叠项 $\\langle u_{N-1} | u_0 \\rangle$ 闭合路径。内积 $\\langle u_a | u_b \\rangle$ 是标准的复数点积，计算上等同于 $u_a^\\dagger u_b$。这种威尔逊回路的表述在局域相位变换 $|u_j\\rangle \\to e^{i\\theta_j}|u_j\\rangle$ 下是规范不变的，这对于其代表一个物理可观测量至关重要。\n\n复数值 $W$ 编码了拓扑信息。它的相位是布洛赫态动量沿回路 $\\mathcal{C}$ 演化时累积的贝里相位 $\\gamma$：\n$$W = |W| e^{i\\gamma} \\implies \\gamma = \\arg(W)$$\n拓扑物质理论的一个基本结论是，与节线拓扑环绕的回路 $\\mathcal{C}$ 会获得一个非平庸的贝里相位 $\\gamma = \\pi \\pmod{2\\pi}$。反之，非环绕回路将具有平庸的贝里相位 $\\gamma = 0 \\pmod{2\\pi}$。\n\n因此，拓扑环绕的检测变成了对计算出的 $\\gamma$ 值的直接检验。引入一个容差 $\\delta$ 以考虑离散化中固有的数值误差。相位 $\\gamma$ 在主值范围 $(-\\pi, \\pi]$ 内计算。如果一个回路的相位的绝对值 $|\\gamma|$ 大于 $\\pi - \\delta$，则判定为“环绕”。\n\n所提供的算法为每个测试用例系统地执行这些步骤。它构建哈密顿量，离散化路径，使用 `numpy.linalg.eigh` 计算每个点的基态本征矢量，计算威尔逊回路乘积，使用 `numpy.angle` 提取相位，并应用指定的检测标准以产生表示环绕状态的最终布尔结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Wilson loop and detects nodal line linking for a series of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (k0, alpha, a, r, z0, N, delta)\n        (1.0, 0.8, 1.0, 0.3, 0.0, 400, 0.1),    # Case 1: happy path, linked\n        (1.0, 0.8, 3.0, 0.3, 0.0, 400, 0.1),    # Case 2: far unlinked\n        (1.0, 0.8, 1.0, 0.001, 0.1, 800, 0.1),  # Case 3: linked, tiny loop with vertical offset\n        (1.0, 0.8, 1.0, 0.3, 0.0, 32, 0.2),     # Case 4: linked with coarse discretization\n    ]\n\n    results = []\n    for case in test_cases:\n        k0, alpha, a, r, z0, N, delta = case\n        \n        # 1. Discretize the path in momentum space\n        # Generate N points for phi from 0 to 2*pi (exclusive of 2*pi)\n        phis = np.linspace(0, 2 * np.pi, N, endpoint=False)\n        \n        k_path = []\n        for phi in phis:\n            kx = a\n            ky = r * np.cos(phi)\n            kz = z0 + r * np.sin(phi)\n            k_path.append(np.array([kx, ky, kz]))\n\n        # 2. Calculate the occupied-band eigenvectors for each point on the path\n        eigenvectors = []\n        for k in k_path:\n            kx, ky, kz = k\n            \n            # Define d-vector components\n            d_x = k0**2 - kx**2 - ky**2\n            d_y = alpha * ky * kz\n            d_z = kz\n            \n            # Construct the 2x2 Hamiltonian matrix H = d.sigma\n            hamiltonian = np.array([\n                [d_z, d_x - 1j * d_y],\n                [d_x + 1j * d_y, -d_z]\n            ], dtype=complex)\n            \n            # Diagonalize the Hermitian Hamiltonian\n            # numpy.linalg.eigh returns eigenvalues in ascending order\n            # and corresponding eigenvectors in columns.\n            eigenvalues, eigvecs = np.linalg.eigh(hamiltonian)\n            \n            # The occupied band corresponds to the lower energy (first eigenvalue)\n            occupied_eigenvector = eigvecs[:, 0]\n            eigenvectors.append(occupied_eigenvector)\n\n        # 3. Compute the Wilson loop as a product of overlaps\n        wilson_loop_value = 1.0 + 0.0j\n        for i in range(N):\n            # Overlap between eigenvector at point i and point i+1\n            # The modulo operator % N handles the loop closure from N-1 to 0\n            u_i = eigenvectors[i]\n            u_j = eigenvectors[(i + 1) % N]\n            \n            # np.vdot computes the conjugate dot product u_i_conj.T @ u_j\n            overlap = np.vdot(u_i, u_j)\n            wilson_loop_value *= overlap\n\n        # 4. Extract the Berry phase (eigenphase) and check the linking condition\n        # np.angle returns the phase in the interval (-pi, pi]\n        berry_phase = np.angle(wilson_loop_value)\n        \n        # A linked loop yields a Berry phase of pi (mod 2pi).\n        # We test if the absolute value of the phase is close to pi within tolerance delta.\n        # This is equivalent to abs(gamma) > pi - delta.\n        is_linked = abs(berry_phase) > np.pi - delta\n        results.append(is_linked)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3007283"}]}