{"hands_on_practices": [{"introduction": "这个练习是理解贝里相位的经典范例。我们将为一个在缓慢旋转的磁场中进动的自旋-$\\frac{1}{2}$系统，解析地推导出其获得的贝里相位。通过这个练习，你将掌握计算贝里联络和相位积分的具体步骤，并揭示它与参数空间路径所张立体角这一几何概念的直接联系 [@problem_id:2971932]。", "problem": "考虑一个带有磁矩的自旋$\\frac{1}{2}$粒子，在大小恒为 $B_{0}$ 的时变磁场 $\\vec{B}(t)$ 中进行绝热演化。设磁场方向由单位矢量 $\\vec{n}(t)$ 给出，该矢量绕 $\\hat{z}$ 轴描绘出一个极角固定为 $\\theta$ 的圆锥，因此 $\\vec{n}(t) = (\\sin\\theta\\cos\\phi(t), \\sin\\theta\\sin\\phi(t), \\cos\\theta)$，其中 $\\phi(t)$ 在一个周期内从 $0$ 缓慢增加到 $2\\pi$。哈密顿量为 $H(t) = -\\gamma\\,\\vec{S}\\cdot\\vec{B}(t)$，其中 $\\gamma$ 是一个正常数，$\\vec{S} = \\frac{\\hbar}{2}\\,\\vec{\\sigma}$，$\\vec{\\sigma}$ 是泡利矩阵。\n\n假设演化是绝热的，并且在周期开始时，系统初始制备在 $H(t)$ 的瞬时本征态上，其沿 $\\vec{n}(t)$ 方向的自旋投影为 $+\\frac{\\hbar}{2}$。从含时薛定谔方程和绝热定理出发，并使用循环绝热演化中几何（贝里）相位的核心定义，推导在参数空间中完成一个完整周期后累积的贝里相位，将其表示为圆锥角 $\\theta$ 的闭式解析表达式。忽略动力学相位。将你的最终答案表示为以弧度为单位的单个解析表达式。", "solution": "该问题陈述已被验证，并被发现具有科学依据、提法恰当且客观。这是一个量子力学中的标准问题，存在唯一且有意义的解。因此，我们可以进行推导。\n\n在磁场 $\\vec{B}(t)$ 中，一个磁矩为 $\\vec{\\mu} = \\gamma \\vec{S}$ 的自旋$\\frac{1}{2}$粒子的哈密顿量为 $H(t) = -\\gamma\\,\\vec{S}\\cdot\\vec{B}(t)$。自旋算符为 $\\vec{S} = \\frac{\\hbar}{2}\\,\\vec{\\sigma}$，其中 $\\vec{\\sigma}$ 是泡利矩阵。磁场大小恒为 $B_0$，方向随时变化，$\\vec{B}(t) = B_0 \\vec{n}(t)$。因此，哈密顿量可以写为：\n$$H(t) = -\\gamma B_0 \\frac{\\hbar}{2} (\\vec{\\sigma} \\cdot \\vec{n}(t))$$\n方向矢量 $\\vec{n}(t)$ 由一个固定的极角 $\\theta$ 和一个时变的方位角 $\\phi(t)$ 参数化，即 $\\vec{n}(t) = (\\sin\\theta\\cos\\phi(t), \\sin\\theta\\sin\\phi(t), \\cos\\theta)$。算符 $\\vec{\\sigma} \\cdot \\vec{n}(t)$ 的矩阵形式为：\n$$ \\vec{\\sigma} \\cdot \\vec{n}(t) = \\sigma_x n_x + \\sigma_y n_y + \\sigma_z n_z = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix} \\sin\\theta\\cos\\phi(t) + \\begin{pmatrix} 0 & -i \\\\ i & 0 \\end{pmatrix} \\sin\\theta\\sin\\phi(t) + \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} \\cos\\theta $$\n$$ \\vec{\\sigma} \\cdot \\vec{n}(t) = \\begin{pmatrix} \\cos\\theta & \\sin\\theta(\\cos\\phi(t) - i\\sin\\phi(t)) \\\\ \\sin\\theta(\\cos\\phi(t) + i\\sin\\phi(t)) & -\\cos\\theta \\end{pmatrix} = \\begin{pmatrix} \\cos\\theta & \\sin\\theta \\, e^{-i\\phi(t)} \\\\ \\sin\\theta \\, e^{i\\phi(t)} & -\\cos\\theta \\end{pmatrix} $$\n该矩阵的本征值为 $\\lambda = \\pm 1$。问题指定系统处于瞬时本征态，其沿 $\\vec{n}(t)$ 方向的自旋投影为 $+\\frac{\\hbar}{2}$。这对应于算符 $\\vec{S} \\cdot \\vec{n} = \\frac{\\hbar}{2} \\vec{\\sigma} \\cdot \\vec{n}$ 的本征值为 $+\\frac{\\hbar}{2}$ 的本征态。这等价于 $\\vec{\\sigma} \\cdot \\vec{n}$ 的本征值为 $\\lambda=+1$ 的本征态。我们将此态记为 $|n_{+}(t)\\rangle$。\n\n为求此本征态，我们求解方程 $(\\vec{\\sigma} \\cdot \\vec{n}) |n_{+}(t)\\rangle = (+1) |n_{+}(t)\\rangle$。设 $|n_{+}(t)\\rangle = \\begin{pmatrix} a \\\\ b \\end{pmatrix}$。\n$$ \\begin{pmatrix} \\cos\\theta & \\sin\\theta \\, e^{-i\\phi} \\\\ \\sin\\theta \\, e^{i\\phi} & -\\cos\\theta \\end{pmatrix} \\begin{pmatrix} a \\\\ b \\end{pmatrix} = \\begin{pmatrix} a \\\\ b \\end{pmatrix} $$\n从第一行，我们得到 $a\\cos\\theta + b\\sin\\theta\\,e^{-i\\phi} = a$，化简为 $b\\sin\\theta\\,e^{-i\\phi} = a(1-\\cos\\theta)$。使用半角恒等式 $\\sin\\theta = 2\\sin(\\theta/2)\\cos(\\theta/2)$ 和 $1-\\cos\\theta = 2\\sin^2(\\theta/2)$，我们得到：\n$$ b(2\\sin(\\theta/2)\\cos(\\theta/2))e^{-i\\phi} = a(2\\sin^2(\\theta/2)) $$\n假设 $\\sin(\\theta/2) \\neq 0$ (即 $\\theta \\neq 0$)，我们可以两边除以 $2\\sin(\\theta/2)$：\n$$ b\\cos(\\theta/2)e^{-i\\phi} = a\\sin(\\theta/2) \\implies \\frac{b}{a} = \\frac{\\sin(\\theta/2)}{\\cos(\\theta/2)} e^{i\\phi} = \\tan(\\theta/2) e^{i\\phi} $$\n我们选择 $a = \\cos(\\theta/2)$ 和 $b = \\sin(\\theta/2)e^{i\\phi}$。归一化条件 $|a|^2+|b|^2 = \\cos^2(\\theta/2) + \\sin^2(\\theta/2) = 1$ 得到满足。这一选择得到的态矢量是关于 $\\phi$ 的单值函数。瞬时本征态是：\n$$ |n_{+}(t)\\rangle = \\begin{pmatrix} \\cos(\\frac{\\theta}{2}) \\\\ \\sin(\\frac{\\theta}{2})e^{i\\phi(t)} \\end{pmatrix} $$\n对于指定路径，此参数化是良定义的，该路径避开了 $\\theta=\\pi$ 处的奇异点。\n\n对于一个经历绝热循环演化的系统，其贝里相位 $\\gamma_B$ 由贝里联络在参数空间中的闭合路径上的积分给出。问题陈述演化是循环的，参数 $\\phi(t)$ 从 $0$ 变化到 $2\\pi$，而 $\\theta$ 保持不变。\n贝里相位的公式为：\n$$ \\gamma_B = i \\oint_C \\langle n_{+}(\\vec{R}) | \\nabla_{\\vec{R}} | n_{+}(\\vec{R}) \\rangle \\cdot d\\vec{R} $$\n在我们的情况下，参数空间由 $(\\theta, \\phi)$ 描述，路径 $C$ 是一个在 $\\theta$ 恒定时由 $\\phi$ 参数化的回路。因此，$\\vec{R} = \\vec{R}(\\phi)$，$d\\vec{R} = \\hat{\\phi}d\\phi$，且 $\\nabla_{\\vec{R}} = \\frac{1}{r_{\\phi}}\\frac{\\partial}{\\partial\\phi}\\hat{\\phi}$，其中 $r_{\\phi}$ 是一个标度因子。该公式简化为对 $\\phi$ 的积分：\n$$ \\gamma_B = i \\int_{0}^{2\\pi} \\langle n_{+}(\\phi) | \\frac{\\partial}{\\partial\\phi} | n_{+}(\\phi) \\rangle d\\phi $$\n首先，我们计算态矢量对 $\\phi$ 的导数：\n$$ \\frac{\\partial}{\\partial\\phi} |n_{+}(\\phi)\\rangle = \\frac{\\partial}{\\partial\\phi} \\begin{pmatrix} \\cos(\\frac{\\theta}{2}) \\\\ \\sin(\\frac{\\theta}{2})e^{i\\phi} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ i\\sin(\\frac{\\theta}{2})e^{i\\phi} \\end{pmatrix} $$\n接下来，我们计算内积 $\\langle n_{+}(\\phi) | \\frac{\\partial}{\\partial\\phi} | n_{+}(\\phi) \\rangle$：\n$$ \\langle n_{+}(\\phi) | \\frac{\\partial}{\\partial\\phi} | n_{+}(\\phi) \\rangle = \\begin{pmatrix} \\cos(\\frac{\\theta}{2}) & \\sin(\\frac{\\theta}{2})e^{-i\\phi} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ i\\sin(\\frac{\\theta}{2})e^{i\\phi} \\end{pmatrix} $$\n$$ = \\cos(\\frac{\\theta}{2}) \\cdot 0 + \\sin(\\frac{\\theta}{2})e^{-i\\phi} \\cdot i\\sin(\\frac{\\theta}{2})e^{i\\phi} = i\\sin^2(\\frac{\\theta}{2}) $$\n现在我们将此结果代入贝里相位的积分中：\n$$ \\gamma_B = i \\int_{0}^{2\\pi} \\left( i\\sin^2(\\frac{\\theta}{2}) \\right) d\\phi = i^2 \\sin^2(\\frac{\\theta}{2}) \\int_{0}^{2\\pi} d\\phi $$\n$$ \\gamma_B = -\\sin^2(\\frac{\\theta}{2}) [\\phi]_{0}^{2\\pi} = -2\\pi\\sin^2(\\frac{\\theta}{2}) $$\n使用三角恒等式 $2\\sin^2(\\frac{\\theta}{2}) = 1 - \\cos\\theta$，我们可以将贝里相位表示为其最终形式：\n$$ \\gamma_B = -\\pi(1 - \\cos\\theta) $$\n这个结果可以进行几何解释。半角为 $\\theta$ 的圆锥所对的立体角 $\\Omega$ 为 $\\Omega = \\int_0^{2\\pi} d\\phi \\int_0^\\theta \\sin\\theta' d\\theta' = 2\\pi(1-\\cos\\theta)$。对于一个磁量子数为 $m_s$ 的自旋态，其贝里相位由 $\\gamma_{m_s} = -m_s \\Omega$ 给出。在我们的例子中，该态的自旋投影为 $+\\frac{\\hbar}{2}$，这对应于 $m_s = +\\frac{1}{2}$。因此，贝里相位为 $\\gamma_{1/2} = -(\\frac{1}{2})\\Omega = -(\\frac{1}{2})[2\\pi(1-\\cos\\theta)] = -\\pi(1-\\cos\\theta)$，这证实了我们的计算结果。\n根据问题陈述的要求，动力学相位被明确忽略了。推导出的表达式是在一个周期后累积的几何相位。", "answer": "$$\n\\boxed{-\\pi(1-\\cos\\theta)}\n$$", "id": "2971932"}, {"introduction": "是什么使得贝里相位具有“拓扑”性质？这个练习旨在探索这一核心问题。我们将考察一个参数空间中的闭合路径，但它并*不*包围简并点（一个锥形交叉点）的情况。通过证明在这种情况下贝里相位为零，你将更深刻地理解，非平庸的几何相位是系统参数空间中潜在拓扑特征的标志 [@problem_id:2642867]。", "problem": "考虑一个双核坐标 $\\mathbf{R}=(x,y)$ 下的双态线性振动耦合哈密顿量，\n$$\n\\hat{H}(\\mathbf{R}) \\;=\\; \\begin{pmatrix}\n\\kappa\\,x & \\lambda\\,y \\\\\n\\lambda\\,y & -\\kappa\\,x\n\\end{pmatrix},\n$$\n其中 $\\kappa>0$ 和 $\\lambda>0$ 是实常数，锥形交叉点位于 $(x,y)=(0,0)$。一个核轨道是平面上的一个简单闭合回路，其参数化表示为\n$$\nx(\\phi) \\;=\\; R_{0} + r\\cos\\phi,\\quad y(\\phi) \\;=\\; r\\sin\\phi,\\quad \\phi\\in[0,2\\pi],\n$$\n参数满足 $R_{0}>r>0$，因此该回路不包围原点。\n\n假设在一个周期 $\\phi:0\\to 2\\pi$ 内，核在较低的绝热电子态上进行绝热运动。仅使用适用于参数依赖量子系统中绝热输运的基本定义，计算较低的绝热电子本征态在闭合回路上累积的几何（Berry）相位。以弧度为单位，给出精确值的最终答案。不要使用除 $\\hat{H}(\\mathbf{R})$ 中隐含的耦合之外的任何外部场或非绝热耦合。", "solution": "该问题要求计算一个给定的双态哈密顿量的较低绝热电子本征态在其参数沿一指定闭合回路变化时所累积的几何（Berry）相位。\n\n哈密顿量是核坐标 $\\mathbf{R}=(x,y)$ 的函数，由下式给出：\n$$\n\\hat{H}(\\mathbf{R}) = \\begin{pmatrix}\n\\kappa\\,x & \\lambda\\,y \\\\\n\\lambda\\,y & -\\kappa\\,x\n\\end{pmatrix}\n$$\n其中 $\\kappa$ 和 $\\lambda$ 是正实常数。该哈密顿量在 $\\mathbf{R}=(0,0)$ 处有一个锥形交叉点，在该点两个电子态发生简并。\n\n核轨道是一个由 $\\phi \\in [0, 2\\pi]$ 参数化的闭合回路 $C$：\n$$\nx(\\phi) = R_{0} + r\\cos\\phi, \\quad y(\\phi) = r\\sin\\phi\n$$\n条件为 $R_{0} > r > 0$。这描述了一个以 $(R_{0}, 0)$ 为中心、半径为 $r$ 的圆。至关重要的是，由于 $R_{0} > r$，$x(\\phi) = R_{0} + r\\cos\\phi$ 的值始终为正，因为其最小值为 $R_0 - r > 0$。这意味着闭合回路 $C$ 不包围锥形交叉点的位置——原点 $(0,0)$。\n\n在参数空间中，一个归一化的绝热本征态 $|\\psi(\\mathbf{R})\\rangle$ 沿闭合路径 $C$ 累积的几何相位 $\\gamma$ 由 Berry 联络 $\\mathbf{A}(\\mathbf{R})$ 的线积分定义：\n$$\n\\gamma = \\oint_C \\mathbf{A}(\\mathbf{R}) \\cdot d\\mathbf{R}\n$$\n其中 Berry 联络由下式给出：\n$$\n\\mathbf{A}(\\mathbf{R}) = i \\langle \\psi(\\mathbf{R}) | \\nabla_{\\mathbf{R}} \\psi(\\mathbf{R}) \\rangle\n$$\n且 $\\nabla_{\\mathbf{R}} = \\left(\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y}\\right)$ 是关于参数的梯度算符。\n\n首先，我们必须求出 $\\hat{H}(\\mathbf{R})$ 的本征值和较低的绝热本征态。特征方程为 $\\det(\\hat{H} - E\\hat{I})=0$：\n$$\n(-E + \\kappa x)(-E - \\kappa x) - (\\lambda y)^2 = 0 \\implies E^2 - (\\kappa x)^2 - (\\lambda y)^2 = 0\n$$\n本征值为 $E_{\\pm}(\\mathbf{R}) = \\pm \\sqrt{(\\kappa x)^2 + (\\lambda y)^2}$。较低的绝热态对应于本征值 $E_{-}(\\mathbf{R}) = -\\sqrt{(\\kappa x)^2 + (\\lambda y)^2}$。\n\n由于哈密顿矩阵是实对称的，其本征矢量可以选择为实的。一个关键的洞见是，能否在整个路径上定义一个*单值*的本征矢量决定了几何相位的性质。我们定义一组有效参数 $X = \\kappa x$ 和 $Y = \\lambda y$。哈密顿量变为：\n$$\n\\hat{H} = \\begin{pmatrix} X & Y \\\\ Y & -X \\end{pmatrix}\n$$\n让我们用极坐标表示这些参数：$X = \\rho \\cos\\alpha$ 和 $Y = \\rho \\sin\\alpha$，其中 $\\rho = \\sqrt{X^2+Y^2}$ 且 $\\alpha = \\arctan_2(Y, X)$ 是极角。哈密顿量于是为 $\\hat{H} = \\rho \\begin{pmatrix} \\cos\\alpha & \\sin\\alpha \\\\ \\sin\\alpha & -\\cos\\alpha \\end{pmatrix}$。对应于较低本征值 $E_{-} = -\\rho$ 的归一化本征矢量是：\n$$\n|\\psi_{-}(\\mathbf{R})\\rangle = \\begin{pmatrix} \\sin(\\alpha/2) \\\\ -\\cos(\\alpha/2) \\end{pmatrix}\n$$\n该本征矢量是实的。其沿路径 $C$ 的单值性取决于角度 $\\alpha$ 的行为。在 $(X, Y)$ 参数空间中的路径是一个由 $X(\\phi) = \\kappa(R_0 + r\\cos\\phi)$ 和 $Y(\\phi) = \\lambda r\\sin\\phi$ 给出的椭圆。由于对所有 $\\phi$ 都有 $x(\\phi) > 0$，因此 $X(\\phi) = \\kappa x(\\phi) > 0$。$(X,Y)$ 平面中的路径完全包含在右半平面 ($X>0$) 中，因此不包围原点 $(0,0)$。\n\n因为路径不包围参数空间的原点，角度 $\\alpha$ 可以被定义为沿路径的连续单值函数，例如，通过使用 $\\alpha = \\arctan(Y/X)$，其值域为 $(-\\pi/2, \\pi/2)$。经过一个完整的周期 $\\phi: 0 \\to 2\\pi$ 后，系统回到其在参数空间中的起点，角度 $\\alpha$ 也回到其初始值，使得 $\\alpha(2\\pi) = \\alpha(0)$。\n这确保了实本征矢量 $|\\psi_{-}(\\mathbf{R})\\rangle$ 是沿回路 $C$ 的位置的连续单值函数。\n\n现在我们为此类单值的、实的、归一化的本征态计算 Berry 联络。设 $|\\psi(\\mathbf{R})\\rangle$ 为这样一个态。它是一个具有实分量 $\\psi_k(\\mathbf{R})$ 的列向量，并且是归一化的：$\\langle\\psi|\\psi\\rangle = \\sum_k \\psi_k^2 = 1$。Berry 联络为 $\\mathbf{A}(\\mathbf{R}) = i \\langle \\psi | \\nabla_{\\mathbf{R}} \\psi \\rangle$。让我们考虑梯度的一个分量，例如，关于 $x$ 的分量：\n$$\n\\langle \\psi | \\frac{\\partial}{\\partial x} \\psi \\rangle = \\sum_k \\psi_k \\frac{\\partial \\psi_k}{\\partial x}\n$$\n根据归一化条件，我们可以对 $x$ 求导：\n$$\n\\frac{\\partial}{\\partial x} \\left(\\sum_k \\psi_k^2\\right) = \\frac{\\partial}{\\partial x}(1) = 0\n$$\n$$\n\\sum_k 2 \\psi_k \\frac{\\partial \\psi_k}{\\partial x} = 0 \\implies \\sum_k \\psi_k \\frac{\\partial \\psi_k}{\\partial x} = 0\n$$\n因此，向量 $\\langle \\psi | \\nabla_{\\mathbf{R}} \\psi \\rangle$ 的 $x$ 分量为零。同样的推理也适用于 $y$ 分量。因此，对于一个单值实本征态的选择，我们有：\n$$\n\\langle \\psi_{-}(\\mathbf{R}) | \\nabla_{\\mathbf{R}} \\psi_{-}(\\mathbf{R}) \\rangle = \\mathbf{0}\n$$\n这意味着，在本征态由单值实向量表示的规范中，Berry 联络恒等于零：\n$$\n\\mathbf{A}(\\mathbf{R}) = i (\\mathbf{0}) = \\mathbf{0}\n$$\n几何相位于是就是这个零矢量场沿路径 $C$ 的积分：\n$$\n\\gamma = \\oint_C \\mathbf{0} \\cdot d\\mathbf{R} = 0\n$$\n几何相位为零。这一结果是一个普遍原理的体现：当且仅当参数空间中的路径包围一个简并点（锥形交叉点）时，才会产生非平凡的几何相位。在本问题中，路径被明确构造成不包围简并点。", "answer": "$$\n\\boxed{0}\n$$", "id": "2642867"}, {"introduction": "从简单系统过渡到周期性晶格，贝里相位的概念催生了像陈数这样被量子化的拓扑不变量，它们被用以表征物质的拓扑相。本计算练习将指导你实现一个标准的、规范不变的数值方法，为一个著名的陈绝缘体模型计算陈数。这项实践将理论与现代凝聚态物理研究中使用的实用计算工具连接起来 [@problem_id:2971931]。", "problem": "请实现一个完全规范不变的离散化方案，用于在二维晶体动量空间网格上计算单个占据能带的贝里曲率。该方案需使用连接变量和格点场强。请使用定义在方形布里渊区上的双能带紧束缚布洛赫哈密顿量：\n$$\nH(\\vec k) = d_x(\\vec k)\\,\\sigma_x + d_y(\\vec k)\\,\\sigma_y + d_z(\\vec k)\\,\\sigma_z,\n$$\n其中\n$$\nd_x(\\vec k) = \\sin(k_x),\\quad d_y(\\vec k) = \\sin(k_y),\\quad d_z(\\vec k) = m + \\cos(k_x) + \\cos(k_y),\n$$\n这里 $\\sigma_x$, $\\sigma_y$, 和 $\\sigma_z$ 是泡利矩阵，$\\vec k=(k_x,k_y)$，$m$ 是一个实数控制参数。布里渊区是一个方形 $k$-环面，满足 $k_x,k_y \\in [-\\pi,\\pi)$ 并具有周期性边界条件。\n\n你的程序必须：\n- 构建一个覆盖布里渊区的 $N \\times N$ 均匀网格，其中 $k_x$ 和 $k_y$ 的采样点为\n$$\nk_\\mu(n) = -\\pi + \\frac{2\\pi}{N}\\,n,\\quad n\\in\\{0,1,\\dots,N-1\\},\\quad \\mu\\in\\{x,y\\}.\n$$\n- 在网格上的每个 $\\vec k$ 点，计算对应于 $H(\\vec k)$ 最低能量本征值的归一化占据态布洛赫本征矢 $\\lvert u(\\vec k)\\rangle$。\n- 定义沿 $k_x$ 和 $k_y$ 方向的连接变量：\n$$\nU_x(\\vec k) = \\frac{\\langle u(\\vec k+\\delta \\vec k_x)\\mid u(\\vec k)\\rangle}{\\left|\\langle u(\\vec k+\\delta \\vec k_x)\\mid u(\\vec k)\\rangle\\right|},\\quad\nU_y(\\vec k) = \\frac{\\langle u(\\vec k+\\delta \\vec k_y)\\mid u(\\vec k)\\rangle}{\\left|\\langle u(\\vec k+\\delta \\vec k_y)\\mid u(\\vec k)\\rangle\\right|},\n$$\n其中 $\\delta \\vec k_x=(\\frac{2\\pi}{N},0)$ 和 $\\delta \\vec k_y=(0,\\frac{2\\pi}{N})$，内积是 $\\mathbb C^2$ 上的标准复内积。\n- 计算每个网格小方格（plaquette）上的格点场强（即通过小方格的离散化贝里曲率磁通），其由规范不变相位给出：\n$$\n\\mathcal F(\\vec k) = \\arg\\left[\\, U_x(\\vec k)\\, U_y(\\vec k+\\delta \\vec k_x)\\, U_x(\\vec k+\\delta \\vec k_y)^{-1}\\, U_y(\\vec k)^{-1}\\,\\right],\n$$\n其中 $\\arg$ 返回区间 $(-\\pi,\\pi]$ 内的主辐角，以弧度为单位，逆是模为1的复倒数。角度必须以弧度处理。\n- 计算总陈数\n$$\nC = \\frac{1}{2\\pi}\\sum_{\\text{plaquettes}} \\mathcal F(\\vec k),\n$$\n并将其输出为最接近的整数（求和后四舍五入到最近的整数）。\n\n你可以不加证明地假设以下基础理论：厄米矩阵的标准谱理论、本征矢的正交归一性、周期性系统中布洛赫哈密顿量的定义，以及对于有带隙的能带，贝里曲率的积分是一个拓扑不变量（陈数）的原理。\n\n测试套件：\n- 使用以下参数集 $(m,N)$：\n  - 情况 1：$(m,N) = (3.0,31)$。\n  - 情况 2：$(m,N) = (1.0,31)$。\n  - 情况 3：$(m,N) = (-1.0,31)$。\n  - 情况 4：$(m,N) = (1.0,9)$。\n  - 情况 5：$(m,N) = (2.5,31)$。\n这些测试用例覆盖了一个平庸相、两个符号相反的非平庸相、一个粗网格鲁棒性检查以及另一个平庸相。所有角度必须以弧度为单位，且无需进行物理单位转换。\n\n最终输出规范：\n- 你的程序必须生成单行输出，其中包含一个包含五个计算出的陈数（每个测试用例一个，按相同顺序）的列表，格式为逗号分隔的列表，并用方括号括起，例如 $\\texttt{[0,-1,1,-1,0]}$。\n- 每个条目必须是整数。\n\n你的解决方案必须是一个无需外部输入即可执行这些计算的完整可运行程序。", "solution": "该问题要求计算二维方格子上一个双能带紧束缚模型的陈数。陈数是表征电子能带结构的一个拓扑不变量。它被定义为贝里曲率在整个布里渊区上的积分。所指定的方法是一种成熟的、规范不变的数值方案，用于在离散化的动量空间格点上计算陈数。\n\n其基本原理是几何性的。对于依赖于一组参数 $\\vec k$ 的量子态族 $\\lvert u(\\vec k)\\rangle$，该族态的几何性质由贝里联络 $\\vec A(\\vec k) = i \\langle u(\\vec k) \\mid \\nabla_{\\vec k} u(\\vec k) \\rangle$ 和贝里曲率 $\\mathcal{F}_{xy}(\\vec k) = \\partial_{k_x} A_y - \\partial_{k_y} A_x$ 描述。对于周期性固体中的一个有带隙的电子能带，布里渊区是一个环面，贝里曲率在此环面上的积分是量子化的，得到一个整数，即陈数 $C$：\n$$\nC = \\frac{1}{2\\pi} \\int_{\\text{BZ}} \\mathcal{F}_{xy}(\\vec k) \\, d^2k\n$$\n这个整数是拓扑稳健的，这意味着只要能隙保持打开，它在哈密顿量的平滑形变下不会改变。\n\n通过对本征矢求导来直接数值计算曲率是有问题的，因为在每个 $\\vec k$ 点，本征矢 $\\lvert u(\\vec k)\\rangle$ 的相位是任意的。规范变换 $\\lvert u(\\vec k) \\rangle \\to e^{i\\phi(\\vec k)}\\lvert u(\\vec k)\\rangle$ 会改变联络 $\\vec A(\\vec k) \\to \\vec A(\\vec k) - \\nabla_{\\vec k} \\phi(\\vec k)$，这使得可靠地计算导数变得困难。问题中指定的方法由 Fukui、Hatsugai 和 Suzuki 提出，它通过在离散化格点上定义显式规范不变的量来规避这个问题。\n\n步骤如下：\n\n1.  **离散化布里渊区**：连续的布里渊区（一个满足 $k_x, k_y \\in [-\\pi, \\pi)$ 的环面）被一个均匀的 $N \\times N$ 点阵所取代。格点由 $\\vec k(n_x, n_y) = (k_x(n_x), k_y(n_y))$ 给出，其中\n    $$\n    k_\\mu(n) = -\\pi + \\frac{2\\pi}{N}\\,n,\\quad n\\in\\{0,1,\\dots,N-1\\},\\quad \\mu\\in\\{x,y\\}.\n    $$\n    相邻点之间的步长矢量是 $\\delta \\vec k_x = (\\frac{2\\pi}{N}, 0)$ 和 $\\delta \\vec k_y = (0, \\frac{2\\pi}{N})$。\n\n2.  **计算本征矢**：在格点上的每个点 $\\vec k$，构建布洛赫哈密顿量 $H(\\vec k)$。由于该哈密顿量是一个 $2 \\times 2$ 的厄米矩阵，它有两个实数本征值，分别对应上、下两个能带。\n    $$\n    H(\\vec k) = \\begin{pmatrix} d_z(\\vec k) & d_x(\\vec k) - i d_y(\\vec k) \\\\ d_x(\\vec k) + i d_y(\\vec k) & -d_z(\\vec k) \\end{pmatrix}\n    $$\n    其本征值为 $E_\\pm(\\vec k) = \\pm \\sqrt{d_x^2 + d_y^2 + d_z^2}$。问题关注的是占据能带，即能量最低的能带 $E_-(\\vec k)$。对于每个 $\\vec k$，我们用数值方法计算相应的归一化本征矢 $\\lvert u(\\vec k)\\rangle$。一个关键点是，数值对角化程序在不同的 $\\vec k$ 点可能会返回相位任意且互不相关的本征矢。后续步骤的设计旨在对这种规范选择不敏感。\n\n3.  **定义连接变量**：贝里联络被离散化为连接动量空间格点上相邻站点的连接变量。在 $\\mu$ 方向上的连接变量定义为相邻站点本征矢的归一化内积：\n    $$\n    U_\\mu(\\vec k) = \\frac{\\langle u(\\vec k+\\delta \\vec k_\\mu)\\mid u(\\vec k)\\rangle}{\\left|\\langle u(\\vec k+\\delta \\vec k_\\mu)\\mid u(\\vec k)\\rangle\\right|}\n    $$\n    连接变量 $U_\\mu(\\vec k)$ 可以被看作是一个离散化的平行输运子。它的相位 $\\arg(U_\\mu(\\vec k))$ 是贝里联络分量 $A_\\mu(\\vec k)$ 在从 $\\vec k$ 到 $\\vec k + \\delta \\vec k_\\mu$ 的连接段上积分的有限差分近似。将内积归一化至单位模长，消除了与交叠幅度相关的任何模糊性，只保留了关键的相位信息。\n\n4.  **计算格子磁通**：贝里曲率与沿闭合回路的连接变量的路径排序乘积有关。格点上最小的非平凡回路是一个基本小方格（plaquette），其顶点位于 $\\vec k$, $\\vec k+\\delta \\vec k_x$, $\\vec k+\\delta \\vec k_y$ 和 $\\vec k+\\delta \\vec k_x+\\delta \\vec k_y$。格点场强或称格子磁通 $\\mathcal{F}(\\vec k)$ 被定义为围绕该小方格的连接变量乘积的相位：\n    $$\n    \\mathcal F(\\vec k) = \\arg\\left[\\, U_x(\\vec k)\\, U_y(\\vec k+\\delta \\vec k_x)\\, U_x(\\vec k+\\delta \\vec k_y)^{-1}\\, U_y(\\vec k)^{-1}\\,\\right]\n    $$\n    这个量是穿过该小方格的磁通量的离散模拟。它是显式规范不变的；任何规范变换 $\\lvert u(\\vec k)\\rangle \\to e^{i\\phi(\\vec k)}\\lvert u(\\vec k)\\rangle$ 都会导致连接变量产生相位移动，而这些相移在闭合的小方格回路上恰好相互抵消。结果 $\\mathcal{F}(\\vec k)$ 位于区间 $(-\\pi, \\pi]$ 内。\n\n5.  **计算陈数**：总陈数 $C$ 是通过将布里渊区中所有 $N \\times N$ 个小方格的磁通求和，再除以 $2\\pi$ 得到的：\n    $$\n    C = \\frac{1}{2\\pi}\\sum_{\\vec k} \\mathcal F(\\vec k)\n    $$\n    对于一个有带隙的系统，在足够精细的网格上，这个求和的结果将非常接近一个整数。最后一步是将此浮点数四舍五入到最接近的整数，以获得量子化的拓扑不变量。\n\n实现将遵循这些步骤，并使用 `numpy` 进行高效的数组操作。布里渊区的周期性通过使用 `np.roll` 来移动数组自然地处理，这实现了周期性边界条件。本征矢使用 `np.linalg.eigh` 计算，该函数被矢量化以一次性处理整个格点上的哈密顿量矩阵。", "answer": "```python\nimport numpy as np\n\ndef compute_chern_number(m: float, N: int) -> int:\n    \"\"\"\n    Computes the Chern number for a 2D two-band model on a discretized\n    Brillouin zone.\n\n    Args:\n        m: The mass parameter in the Hamiltonian.\n        N: The number of grid points in each dimension of the k-space mesh.\n\n    Returns:\n        The calculated Chern number, rounded to the nearest integer.\n    \"\"\"\n    # Step 1: Construct the k-space mesh.\n    # The grid covers kx, ky from -pi to pi (exclusive of pi).\n    k_vals = np.linspace(-np.pi, np.pi, N, endpoint=False)\n    # Using 'ij' indexing ensures that axis 0 of the grid corresponds to kx\n    # and axis 1 corresponds to ky.\n    kx_grid, ky_grid = np.meshgrid(k_vals, k_vals, indexing='ij')\n\n    # Step 2: Define the Hamiltonian at each k-point.\n    # H(k) = d_x(k)sigma_x + d_y(k)sigma_y + d_z(k)sigma_z\n    dx = np.sin(kx_grid)\n    dy = np.sin(ky_grid)\n    dz = m + np.cos(kx_grid) + np.cos(ky_grid)\n\n    # Construct the (N, N, 2, 2) array of Hamiltonians.\n    # H = [[dz, dx - 1j*dy], [dx + 1j*dy, -dz]]\n    H = np.zeros((N, N, 2, 2), dtype=complex)\n    H[:, :, 0, 0] = dz\n    H[:, :, 0, 1] = dx - 1j * dy\n    H[:, :, 1, 0] = dx + 1j * dy\n    H[:, :, 1, 1] = -dz\n\n    # Step 2 (cont.): Compute the occupied eigenvectors.\n    # np.linalg.eigh is vectorized and computes eigenvalues/vectors for all\n    # k-points at once. Eigenvalues are sorted in ascending order.\n    # The first eigenvector (column 0) corresponds to the lowest eigenvalue.\n    # The shape of eigvecs is (N, N, 2, 2).\n    # The shape of the occupied eigenvector array u_nk is (N, N, 2).\n    _, eigvecs = np.linalg.eigh(H)\n    u_nk = eigvecs[:, :, :, 0]\n\n    # Step 3: Compute the link variables U_x and U_y.\n    # The link variables connect adjacent k-points.\n    # U_mu(k) = <u(k+d_k_mu)|u(k)> / |<u(k+d_k_mu)|u(k)>|\n\n    # For U_x, shift eigenvectors along the kx direction (axis 0).\n    u_nk_x_shifted = np.roll(u_nk, -1, axis=0)\n    # Compute the inner product <u(k+dkx)|u(k)>.\n    # The sum is over the spinor components (axis 2).\n    inner_prod_x = np.sum(u_nk_x_shifted.conj() * u_nk, axis=2)\n    Ux = inner_prod_x / np.abs(inner_prod_x)\n\n    # For U_y, shift eigenvectors along the ky direction (axis 1).\n    u_nk_y_shifted = np.roll(u_nk, -1, axis=1)\n    # Compute the inner product <u(k+dky)|u(k)>.\n    inner_prod_y = np.sum(u_nk_y_shifted.conj() * u_nk, axis=2)\n    Uy = inner_prod_y / np.abs(inner_prod_y)\n\n    # Step 4: Compute the lattice field strength (plaquette flux).\n    # F(k) = arg[ U_x(k) U_y(k+dk_x) U_x(k+dk_y)^-1 U_y(k)^-1 ]\n    # The inverse of a complex number with unit modulus is its conjugate.\n    \n    # U_y(k + dk_x) is calculated by rolling Uy along axis 0 (kx).\n    Uy_x_shifted = np.roll(Uy, -1, axis=0)\n    # U_x(k + dk_y) is calculated by rolling Ux along axis 1 (ky).\n    Ux_y_shifted = np.roll(Ux, -1, axis=1)\n    \n    plaquette_prod = Ux * Uy_x_shifted * np.conj(Ux_y_shifted) * np.conj(Uy)\n    \n    # The argument gives the flux, ensuring it's in (-pi, pi].\n    field_strength = np.angle(plaquette_prod)\n\n    # Step 5: Compute the total Chern number.\n    # Sum all plaquette fluxes and normalize by 2*pi.\n    total_flux = np.sum(field_strength)\n    chern_number = total_flux / (2 * np.pi)\n\n    # Return the result rounded to the nearest integer.\n    return int(np.round(chern_number))\n\ndef solve():\n    \"\"\"\n    Runs the Chern number calculation for the test suite and prints the results.\n    \"\"\"\n    # (m, N) parameter sets for the test cases.\n    test_cases = [\n        (3.0, 31),\n        (1.0, 31),\n        (-1.0, 31),\n        (1.0, 9),\n        (2.5, 31),\n    ]\n\n    results = []\n    for m, N in test_cases:\n        chern_num = compute_chern_number(m, N)\n        results.append(chern_num)\n\n    # Print the final output in the specified format: [C1,C2,C3,C4,C5].\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "2971931"}]}