{"hands_on_practices": [{"introduction": "在设计任何自旋电子学器件之前，理解自旋信息如何在材料中传播和衰减是至关重要的第一步。本练习将从基本的自旋连续性方程和菲克定律出发，推导出描述自旋极化在扩散通道中空间分布的控制方程。通过这个过程，你将掌握自旋扩散长度（$l_s$）这一核心概念，并定量地感受到它如何决定自旋电子学器件的有效作用尺度。[@problem_id:3017005]", "problem": "一个准一维扩散通道被用于非局域自旋注入和探测。在 $x=0$ 处产生自旋积累，其特征是自旋向上和自旋向下布居之间的自旋电化学势差 $\\mu_{s}(x)$，并让其在稳态条件下沿 $x>0$ 方向扩散。假设以下基本前提：(i) 自旋密度 $n_{s}(x,t)$ 的自旋连续性方程为 $\\partial n_{s}/\\partial t + \\nabla \\cdot \\mathbf{j}_{s} = - n_{s}/\\tau_{s}$，其中 $\\tau_{s}$ 是自旋弛豫时间；(ii) 菲克定律对自旋流密度成立，$\\mathbf{j}_{s} = - D \\nabla n_{s}$，其中 $D$ 是自旋扩散常数。在线性响应区，假设 $n_{s}(x)$ 通过一个恒定的自旋可压缩性与 $\\mu_{s}(x)$ 成正比，因此 $\\mu_{s}(x)$ 的空间分布与 $n_{s}(x)$ 遵循相同的微分方程，两者仅相差一个比例常数。\n\n从这些基本前提出发，推导在 $x>0$ 区域支配 $\\mu_{s}(x)$ 的稳态一维微分方程，并证明其解是一个由称为自旋扩散长度的长度标度 $l_{s}$ 表征的指数衰减。然后，给定 $D = 0.01\\,\\mathrm{m}^{2}/\\mathrm{s}$ 和 $\\tau_{s} = 100\\,\\mathrm{ps}$，计算：\n- 自旋扩散长度 $l_{s}$，以米表示，以及\n- $\\mu_{s}(x)$ 在距离 $L = 1.0 \\times 10^{-6}\\,\\mathrm{m}$ 上的衰减分数因子 $f$，定义为 $f = \\mu_{s}(L)/\\mu_{s}(0)$，以无量纲小数表示。\n\n将 $l_{s}$ 用科学记数法四舍五入到四位有效数字，并将 $f$ 四舍五入到五位有效数字。以行矩阵的形式提供最终答案，其中依次包含 $l_{s}$ 和 $f$。", "solution": "在稳态条件下，自旋连续性方程简化为\n$$\n\\nabla \\cdot \\mathbf{j}_{s} = - \\frac{n_{s}}{\\tau_{s}}.\n$$\n利用自旋扩散的菲克定律，\n$$\n\\mathbf{j}_{s} = - D \\nabla n_{s},\n$$\n我们得到\n$$\n\\nabla \\cdot \\left( - D \\nabla n_{s} \\right) = - \\frac{n_{s}}{\\tau_{s}} \\quad \\Rightarrow \\quad D \\nabla^{2} n_{s} = \\frac{n_{s}}{\\tau_{s}}.\n$$\n在一维空间中，\n$$\nD \\frac{d^{2} n_{s}}{dx^{2}} = \\frac{n_{s}}{\\tau_{s}}.\n$$\n对于扩散输运，在线性响应区，自旋密度 $n_{s}(x)$ 通过一个常数因子（自旋可压缩性）与自旋电化学势 $\\mu_{s}(x)$ 成正比，因此 $\\mu_{s}(x)$ 遵循相同的空间微分方程：\n$$\nD \\frac{d^{2} \\mu_{s}}{dx^{2}} = \\frac{\\mu_{s}}{\\tau_{s}}.\n$$\n这是一个齐次二阶线性微分方程。寻求形如 $\\mu_{s}(x) = \\mu_{0} \\exp(\\kappa x)$ 的解，可以得到特征方程\n$$\nD \\kappa^{2} = \\frac{1}{\\tau_{s}} \\quad \\Rightarrow \\quad \\kappa = \\pm \\frac{1}{\\sqrt{D \\tau_{s}}}.\n$$\n对于 $x>0$ 且在 $x=0$ 处有一个局域源的情况，随距离衰减的物理上可接受的解是\n$$\n\\mu_{s}(x) = \\mu_{s}(0) \\exp\\!\\left( - \\frac{x}{l_{s}} \\right),\n$$\n其中自旋扩散长度 $l_{s}$ 定义为\n$$\nl_{s} = \\sqrt{D \\tau_{s}}.\n$$\n\n现在我们根据给定的参数计算 $l_{s}$ 和衰减分数因子 $f = \\mu_{s}(L)/\\mu_{s}(0)$。在最后一步之前，所有量都保持符号形式表示。\n\n首先，自旋扩散长度：\n$$\nl_{s} = \\sqrt{D \\tau_{s}}.\n$$\n在距离 $L$ 上的衰减分数因子为：\n$$\nf = \\frac{\\mu_{s}(L)}{\\mu_{s}(0)} = \\exp\\!\\left( - \\frac{L}{l_{s}} \\right) = \\exp\\!\\left( - \\frac{L}{\\sqrt{D \\tau_{s}}} \\right).\n$$\n\n代入给定值。将自旋弛豫时间转换为秒：\n$$\n\\tau_{s} = 100\\,\\mathrm{ps} = 100 \\times 10^{-12}\\,\\mathrm{s} = 1.0 \\times 10^{-10}\\,\\mathrm{s}.\n$$\n扩散常数为\n$$\nD = 0.01\\,\\mathrm{m}^{2}/\\mathrm{s} = 1.0 \\times 10^{-2}\\,\\mathrm{m}^{2}/\\mathrm{s}.\n$$\n因此，\n$$\nl_{s} = \\sqrt{(1.0 \\times 10^{-2}) \\times (1.0 \\times 10^{-10})}\\,\\mathrm{m} = \\sqrt{1.0 \\times 10^{-12}}\\,\\mathrm{m} = 1.0 \\times 10^{-6}\\,\\mathrm{m}.\n$$\n用科学记数法四舍五入到四位有效数字，结果为\n$$\nl_{s} = 1.000 \\times 10^{-6}\\,\\mathrm{m}.\n$$\n\n对于 $L = 1.0 \\times 10^{-6}\\,\\mathrm{m}$ 的衰减因子，\n$$\n\\frac{L}{l_{s}} = \\frac{1.0 \\times 10^{-6}}{1.0 \\times 10^{-6}} = 1,\n$$\n所以\n$$\nf = \\exp(-1).\n$$\n数值上，四舍五入到五位有效数字，\n$$\nf = 0.36788.\n$$\n\n因此，所要求的输出是以米为单位的 $l_{s}$ 和无量纲的衰减分数因子 $f$，并以行矩阵 $(l_{s}, f)$ 的顺序表示。", "answer": "$$\\boxed{\\begin{pmatrix}1.000 \\times 10^{-6} & 0.36788\\end{pmatrix}}$$", "id": "3017005"}, {"introduction": "建立了自旋扩散模型后，下一步是了解如何利用该模型来探测自旋流。本练习将探讨逆自旋霍尔效应（ISHE），这是一种关键的电学探测技术，它能将自旋流有效地转换成可测量的电压信号。你将推导在一个典型的铁磁体/普通金属双层结构中产生的逆自旋霍尔电压，从而将抽象的自旋流概念与实际的实验可观测量联系起来。[@problem_id:3017027]", "problem": "一个铁磁体/铂双层结构在铁磁共振下被驱动，将自旋流泵浦到铂（Pt）薄膜中。考虑一个Pt条带，其厚度为$t$（沿$\\hat{z}$方向），长度为$L$（沿$\\hat{y}$方向，逆自旋霍尔电场将沿此方向测量），宽度为$W$（沿$\\hat{x}$方向）。该Pt的电阻率为$\\rho$，自旋霍尔角为$\\theta_{\\mathrm{SH}}$，自旋扩散长度为$l_s$。自旋流在$z=0$的界面处从铁磁体注入Pt，沿$+\\hat{z}$方向流动，并沿$\\hat{x}$方向极化；位于$z = t$的Pt外表面是自旋绝缘的（在$z=t$处没有自旋流流出）。样品沿$\\hat{y}$方向是开路的，因此没有净电荷电流可以沿条带流动；从而沿$\\hat{y}$方向产生一个稳态的逆自旋霍尔电场，并在条带两端产生可测量的电压。\n\n从Pt中的一维自旋扩散框架和逆自旋霍尔效应的定义出发，推导条带两端（间距为$L$）之间的开路逆自旋霍尔电压$V_{\\mathrm{ISHE}}$的表达式，用$z=0$处的界面泵浦自旋流密度大小$J_s^0$（以角动量单位定义）以及材料和几何参数$\\{\\theta_{\\mathrm{SH}}, \\rho, t, l_s, L\\}$来表示。然后根据以下参数对电压进行数值计算：\n- $\\theta_{\\mathrm{SH}} = 0.080$\n- $\\rho = 3.5 \\times 10^{-7}\\ \\Omega\\,\\mathrm{m}$\n- $t = 6.0 \\times 10^{-9}\\ \\mathrm{m}$\n- $l_s = 1.5 \\times 10^{-9}\\ \\mathrm{m}$\n- $L = 1.00 \\times 10^{-3}\\ \\mathrm{m}$\n- 转换后的界面自旋流密度 $(2e/\\hbar)\\,J_s^0 = 8.0 \\times 10^{7}\\ \\mathrm{A/m}^2$\n\n假设Pt中的电导率是各向同性的，并忽略任何界面自旋记忆损失。将$V_{\\mathrm{ISHE}}$的最终数值答案以毫伏为单位表示，并四舍五入到三位有效数字。只提供最终的数值作为你的答案。", "solution": "合适的出发点是正常金属（Pt）中的一维稳态自旋扩散，由满足以下方程的自旋积累$\\mu_s(z)$来描述\n$$\n\\frac{d^2 \\mu_s}{dz^2} = \\frac{\\mu_s}{l_s^2},\n$$\n以及自旋流密度$J_s(z)$（沿$\\hat{z}$方向流动，沿$\\hat{x}$方向极化）与自旋积累梯度之间的本构关系，\n$$\nJ_s(z) = -\\frac{\\sigma}{2e}\\,\\frac{d \\mu_s}{dz},\n$$\n其中$\\sigma = 1/\\rho$是Pt的电导率，$e$是元电荷。边界条件是在铁磁体/Pt界面处的自旋流固定为泵浦值，\n$$\nJ_s(0) = J_s^0,\n$$\n并且在$z=t$处的自由Pt表面是自旋绝缘的，\n$$\nJ_s(t) = 0.\n$$\n\n求解$\\mu_s(z)$的微分方程，得到通解形式为$\\mu_s(z) = A \\sinh(z/l_s) + B \\cosh(z/l_s)$。使用$J_s(z) = -(\\sigma/2e)\\, d\\mu_s/dz$并应用$J_s(t)=0$和$J_s(0)=J_s^0$可以确定常数$A$和$B$，由此可以找到Pt中自旋流的空间分布，\n$$\nJ_s(z) = J_s^0\\,\\frac{\\sinh\\!\\big((t-z)/l_s\\big)}{\\sinh\\!\\big(t/l_s\\big)}.\n$$\n这个分布满足$J_s(0)=J_s^0$和$J_s(t)=0$，是自旋绝缘外边界条件下标准的一维自旋扩散结果。\n\n逆自旋霍尔效应根据以下公式将自旋流密度转换为横向电荷流密度：\n$$\n\\mathbf{j}_c^{\\mathrm{ISHE}}(z) = \\theta_{\\mathrm{SH}}\\,\\frac{2e}{\\hbar}\\,\\mathbf{J}_s(z)\\times \\hat{\\mathbf{s}},\n$$\n其中$\\hat{\\mathbf{s}}$是自旋极化的单位矢量。对于我们的几何结构，$\\mathbf{J}_s \\parallel \\hat{z}$且$\\hat{\\mathbf{s}} \\parallel \\hat{x}$，因此$\\mathbf{j}_c^{\\mathrm{ISHE}}(z)$沿$\\hat{y}$方向，其大小为\n$$\nj_c^{\\mathrm{ISHE}}(z) = \\theta_{\\mathrm{SH}}\\,\\frac{2e}{\\hbar}\\,J_s(z).\n$$\n\n在沿$\\hat{y}$方向的开路条件下，没有净电荷电流可以流过条带。局部地，欧姆定律给出传导电流密度$j_{\\mathrm{cond}}(z) = \\sigma E_y$，对于均匀的$\\sigma$，该值与$z$无关。开路条件是穿过厚度的总电流为零：\n$$\n\\int_{0}^{t}\\!\\big[j_{\\mathrm{cond}}(z) + j_c^{\\mathrm{ISHE}}(z)\\big]\\,dz \\;=\\; 0\n\\;\\;\\Rightarrow\\;\\;\n\\sigma t\\,E_y + \\int_{0}^{t}\\! j_c^{\\mathrm{ISHE}}(z)\\,dz \\;=\\; 0.\n$$\n因此，稳态电场为\n$$\nE_y \\;=\\; -\\frac{1}{\\sigma t}\\,\\int_{0}^{t}\\! j_c^{\\mathrm{ISHE}}(z)\\,dz\n\\;=\\; -\\rho\\,\\frac{1}{t}\\,\\theta_{\\mathrm{SH}}\\,\\frac{2e}{\\hbar}\\,\\int_{0}^{t}\\! J_s(z)\\,dz.\n$$\n使用$J_s(z)$的分布公式，\n$$\n\\int_{0}^{t}\\! J_s(z)\\,dz \\;=\\; J_s^0 \\int_{0}^{t} \\frac{\\sinh\\!\\big((t-z)/l_s\\big)}{\\sinh\\!\\big(t/l_s\\big)}\\,dz.\n$$\n进行变量代换$u = (t-z)/l_s$，则$dz = -l_s\\,du$，$z=0 \\Rightarrow u = t/l_s$，且$z=t \\Rightarrow u=0$。于是\n$$\n\\int_{0}^{t}\\! J_s(z)\\,dz \\;=\\; J_s^0\\, l_s \\int_{0}^{t/l_s} \\frac{\\sinh u}{\\sinh\\!\\big(t/l_s\\big)}\\,du\n\\;=\\; J_s^0\\, l_s\\,\\frac{\\cosh\\!\\big(t/l_s\\big) - 1}{\\sinh\\!\\big(t/l_s\\big)}.\n$$\n使用恒等式 $(\\cosh T - 1)/\\sinh T = \\tanh(T/2)$，其中 $T = t/l_s$，我们得到\n$$\n\\int_{0}^{t}\\! J_s(z)\\,dz \\;=\\; J_s^0\\, l_s\\,\\tanh\\!\\Big(\\frac{t}{2l_s}\\Big).\n$$\n因此开路电场的大小为\n$$\n|E_y| \\;=\\; \\rho\\,\\theta_{\\mathrm{SH}}\\,\\frac{2e}{\\hbar}\\,J_s^0\\,\\frac{l_s}{t}\\,\\tanh\\!\\Big(\\frac{t}{2l_s}\\Big).\n$$\n条带两端（间距为$L$）之间的逆自旋霍尔电压则为\n$$\nV_{\\mathrm{ISHE}} \\;=\\; |E_y|\\,L\n\\;=\\; \\rho\\,\\theta_{\\mathrm{SH}}\\,\\frac{2e}{\\hbar}\\,J_s^0\\,\\frac{l_s}{t}\\,\\tanh\\!\\Big(\\frac{t}{2l_s}\\Big)\\,L.\n$$\n\n这就是用$\\{\\theta_{\\mathrm{SH}}, \\rho, t, l_s, L, J_s^0\\}$表示的所求表达式。为了进行数值计算，使用给定的转换后界面自旋流密度$(2e/\\hbar)\\,J_s^0$会很方便。记$J_s^{(\\mathrm{c})} \\equiv (2e/\\hbar)\\,J_s^0$，我们重写为\n$$\nV_{\\mathrm{ISHE}} \\;=\\; \\rho\\,\\theta_{\\mathrm{SH}}\\,J_s^{(\\mathrm{c})}\\,\\frac{l_s}{t}\\,\\tanh\\!\\Big(\\frac{t}{2l_s}\\Big)\\,L.\n$$\n\n代入数值：\n- $\\theta_{\\mathrm{SH}} = 0.080$,\n- $\\rho = 3.5 \\times 10^{-7}\\ \\Omega\\,\\mathrm{m}$,\n- $t = 6.0 \\times 10^{-9}\\ \\mathrm{m}$,\n- $l_s = 1.5 \\times 10^{-9}\\ \\mathrm{m}$,\n- $L = 1.00 \\times 10^{-3}\\ \\mathrm{m}$,\n- $J_s^{(\\mathrm{c})} = 8.0 \\times 10^{7}\\ \\mathrm{A/m}^2$.\n\n计算无量纲因子\n$$\n\\frac{l_s}{t}\\,\\tanh\\!\\Big(\\frac{t}{2l_s}\\Big)\n\\;=\\; \\frac{1.5 \\times 10^{-9}}{6.0 \\times 10^{-9}}\\,\\tanh\\!\\Big(\\frac{6.0 \\times 10^{-9}}{2 \\times 1.5 \\times 10^{-9}}\\Big)\n\\;=\\; 0.25 \\times \\tanh(2.0).\n$$\n使用$\\tanh(2.0) \\approx 0.96402758$，该因子为\n$$\n0.25 \\times 0.96402758 \\approx 0.241006895.\n$$\n现在，穿过厚度的平均逆自旋霍尔电荷流密度为\n$$\n\\langle j_c^{\\mathrm{ISHE}} \\rangle \\;=\\; \\theta_{\\mathrm{SH}}\\,J_s^{(\\mathrm{c})}\\,\\frac{l_s}{t}\\,\\tanh\\!\\Big(\\frac{t}{2l_s}\\Big)\n\\;\\approx\\; 0.080 \\times (8.0 \\times 10^{7}) \\times 0.241006895\n\\;\\approx\\; 1.54244413 \\times 10^{6}\\ \\mathrm{A/m}^2.\n$$\n开路电场为 $E_y = \\rho \\langle j_c^{\\mathrm{ISHE}} \\rangle$，得到\n$$\nE_y \\;\\approx\\; (3.5 \\times 10^{-7}) \\times (1.54244413 \\times 10^{6})\\ \\mathrm{V/m}\n\\;\\approx\\; 0.539855445\\ \\mathrm{V/m}.\n$$\n最后，\n$$\nV_{\\mathrm{ISHE}} \\;=\\; E_y\\,L \\;\\approx\\; 0.539855445 \\times (1.00 \\times 10^{-3})\\ \\mathrm{V}\n\\;\\approx\\; 5.39855445 \\times 10^{-4}\\ \\mathrm{V}.\n$$\n转换为毫伏：$5.39855445 \\times 10^{-4}\\ \\mathrm{V} \\equiv 0.539855445\\ \\mathrm{mV}$。四舍五入到三位有效数字，得到$0.540\\ \\mathrm{mV}$。", "answer": "$$\\boxed{0.540}$$", "id": "3017027"}, {"introduction": "除了电学方法，量子隧穿谱学为测量自旋极化提供了另一种强大的途径。本次练习是一项“计算实验”，你将模拟著名的 Meservey-Tedrow 实验，该实验利用超导体的塞曼分裂态密度作为自旋探测器。通过从第一性原理构建模型，实现对隧穿电导的数值模拟，并设计算法从模拟数据中提取自旋极化率 $P$，你将深入理解复杂的实验数据是如何被建模和解译的。[@problem_id:3017039]", "problem": "您的任务是设计并实现一个完整的、可运行的程序，用于模拟在有限磁场下通过铁磁体-绝缘体-超导体结的自旋极化隧穿电导，并从偏压不对称性中提取铁磁体的自旋极化率。该问题的背景是凝聚态物理学中的 Meservey–Tedrow 自旋极化隧穿技术，其中薄超导膜的准粒子态密度的塞曼分裂使得能够对隧穿载流子进行自旋选择性探测。\n\n从适用于自旋注入和探测技术的有效基本原理出发：\n- 使用费米黄金定则来论证隧穿电流正比于自旋分辨态密度与占据因子乘积的能量积分。微分电导通过电流对电压求导得到。\n- 使用超导体的 Bardeen–Cooper–Schrieffer (BCS) 准粒子态密度作为依赖于能量的谱函数。BCS 态密度在能隙附近呈尖峰状，是文献中经过充分检验的公式。一个微小的 Dynes 展宽可以稳定数值计算。\n- 使用磁场下自旋能级的塞曼分裂：自旋向上和自旋向下的准粒子能量分别移动了 $\\pm \\Delta_{Z}/2$，其中 $\\Delta_{Z}$ 是塞曼能量。\n- 使用费米-狄拉克 (FD) 分布来考虑热展宽效应，并利用有限温度下的微分电导可以表示为谱函数与 FD 分布导数的热卷积这一事实。\n\n用纯数学术语定义物理和数学模型：\n- 设超导能隙为 $\\Delta$（单位 $\\mathrm{meV}$）。\n- 设塞曼分裂为 $\\Delta_{Z}$（单位 $\\mathrm{meV}$）。\n- 设温度为 $T$（单位 $\\mathrm{K}$）。\n- 设 Dynes 展宽参数为 $\\Gamma$（单位 $\\mathrm{meV}$），其为小的正数。\n- 设铁磁体的自旋极化率为 $P$（无量纲），其自旋分辨隧穿权重为 $w_{\\uparrow} = (1+P)/2$ 和 $w_{\\downarrow} = (1-P)/2$。\n\n每个自旋的自旋分辨超导态密度是经塞曼移动的 BCS 态密度，而进入隧穿电导的总谱函数是自旋向上和自旋向下分量的加权和。有限温度下的微分电导可以表示为谱函数与费米-狄拉克函数导数的卷积，该导数正比于能量偏移量除以 $k_{B}T$ 的 $\\mathrm{sech}^{2}$ 函数，其中 $k_{B}$ 是玻尔兹曼常数。您必须使用单位为 $\\mathrm{meV}$ 的 $\\Delta$ 和 $\\Delta_{Z}$，单位为 $\\mathrm{K}$ 的 $T$，并取 $k_{B} \\approx 0.08617333$ $\\mathrm{meV}/\\mathrm{K}$，以确保所有能量单位一致为 $\\mathrm{meV}$。偏压必须以 $\\mathrm{mV}$ 为单位处理，其中以 $\\mathrm{meV}$ 为单位的能量 $eV$ 在数值上等于以 $\\mathrm{mV}$ 为单位的电压 $V$。\n\n您的程序必须：\n1. 从第一性原理出发，使用带有微小 Dynes 参数的 Bardeen–Cooper–Schrieffer 态密度，并为自旋向上和自旋向下分别移动 $\\pm \\Delta_{Z}/2$，来构建自旋分辨的超导谱函数。\n2. 将进入隧穿电导的总谱函数构建为自旋向上和自旋向下分量的加权和，权重由 $P$ 决定。\n3. 通过实现与费米-狄拉克分布导数的卷积来计算有限温度下的微分电导 $G(V)$。该热学核函数必须归一化，使其能量积分为 1，以确保在零温极限下电导归一化的物理一致性。\n4. 利用所述模型下 $G(V)$ 对 $P$ 的线性关系，设计一种算法，在给定 $\\Delta_{Z}$ 和 $T$ 的情况下，从模拟的 $G(V)$ 中提取 $P$。具体来说，将 $G(V)$ 写成 $G(V) = G_{A}(V) + P \\, G_{B}(V)$ 的形式，其中 $G_{A}(V)$ 是非极化贡献，$G_{B}(V)$ 是极化基函数，并通过最小化模拟的 $G(V)$ 与作为 $P$ 的函数的模型表达式之间的均方差，使用一个有原则的估计器来获得 $P$。您的估计器必须在 $\\Delta_{Z}=0$ 时返回 $P=0$，因为在没有塞曼分裂的情况下，极化基函数会消失。\n5. 使用数值稳定的积分或快速卷积在对称偏压网格 $V \\in [-V_{\\max}, V_{\\max}]$ (单位 $\\mathrm{mV}$) 上计算 $G(V)$。适当选择 $V_{\\max}$ 和离散化，以便在所有测试条件下都能很好地分辨相干峰及其自旋分裂的对应部分，而不会引入人为误差。\n6. 对于下面描述的每个测试用例，使用已知的基准极化率 $P_{\\text{true}}$ 模拟 $G(V)$，然后应用您的估计器从模拟的 $G(V)$ 中恢复 $P$。最终输出必须是测试用例的估计极化率列表，四舍五入到四位小数，并按指定的确切格式单行打印。\n\n物理单位：\n- 能量必须以 $\\mathrm{meV}$ 为单位。\n- 温度必须以 $\\mathrm{K}$ 为单位。\n- 偏压必须以 $\\mathrm{mV}$ 为单位，以使以 $\\mathrm{meV}$ 为单位的 $eV$ 在数值上等于以 $\\mathrm{mV}$ 为单位的 $V$。\n- 提取的极化率 $P$ 是无量纲的，必须表示为小数。\n\n测试套件：\n为以下参数集提供结果，以测试对典型、边界和边缘情况的覆盖。在每种情况下，使用给定的 $(\\Delta, \\Delta_{Z}, T, P_{\\text{true}}, \\Gamma)$ 值：\n- 情况 1（正常路径）：$(\\Delta = 1.5, \\Delta_{Z} = 0.3, T = 1.5, P_{\\text{true}} = 0.45, \\Gamma = 0.03)$。\n- 情况 2（非极化边界）：$(\\Delta = 1.5, \\Delta_{Z} = 0.3, T = 1.5, P_{\\text{true}} = 0.0, \\Gamma = 0.03)$。\n- 情况 3（小塞曼分裂边缘情况）：$(\\Delta = 1.5, \\Delta_{Z} = 0.05, T = 0.5, P_{\\text{true}} = 0.5, \\Gamma = 0.02)$。\n- 情况 4（无塞曼分裂边界）：$(\\Delta = 1.5, \\Delta_{Z} = 0.0, T = 0.5, P_{\\text{true}} = 0.4, \\Gamma = 0.02)$，其中估计器必须返回 $P=0$，因为不对称性恒为零。\n- 情况 5（高温展宽）：$(\\Delta = 1.5, \\Delta_{Z} = 0.3, T = 5.0, P_{\\text{true}} = 0.45, \\Gamma = 0.05)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含按上述顺序列出的各情况的估计极化率，格式为逗号分隔的列表，并用方括号括起来，每个值四舍五入到四位小数；例如，$[0.1234,0.0000,0.5678,0.0000,0.4321]$。", "solution": "该问题要求设计一个程序，用以模拟铁磁体-绝缘体-超导体 (F-I-S) 结的微分隧穿电导 $G(V)$，并随后提取铁磁体的自旋极化率 $P$。物理模型基于 Meservey-Tedrow 技术，该技术依赖于超导体态密度的塞曼分裂。解决方案将按照概述从第一性原理出发进行开发。\n\n首先，我们定义自旋分辨的准粒子态密度 (DOS)。理想超导体的标准 Bardeen-Cooper-Schrieffer (BCS) DOS 由 $\\rho_{BCS}(E) \\propto |E| / \\sqrt{E^2 - \\Delta^2}$ 给出（对于能量 $|E| > \\Delta$），在能隙 $|E| < \\Delta$ 内为零，其中 $\\Delta$ 是超导能隙。为了考虑寿命效应并确保数值稳定性，通过用复能量替换能量 $E$ 来引入 Dynes 展宽参数 $\\Gamma$。一个常见的、粒子-空穴对称的展宽 DOS 形式为：\n$$ \\rho(E, \\Delta, \\Gamma) = \\mathrm{Re}\\left[ \\frac{|E - i\\Gamma|}{\\sqrt{(E - i\\Gamma)^2 - \\Delta^2}} \\right] $$\n其中与正常态 DOS 相关的比例常数被视为单位 1，因为它将在归一化电导中被抵消。在磁场中，塞曼效应消除了自旋简并。自旋向上 ($\\uparrow$) 和自旋向下 ($\\downarrow$) 准粒子的能量分别移动了 $\\mp \\Delta_Z/2$，其中 $\\Delta_Z$ 是塞曼分裂能。因此，自旋分辨的 DOS 由下式给出：\n$$ \\rho_{\\uparrow}(E) = \\rho(E - \\Delta_Z/2, \\Delta, \\Gamma) $$\n$$ \\rho_{\\downarrow}(E) = \\rho(E + \\Delta_Z/2, \\Delta, \\Gamma) $$\n\n根据费米黄金定则，在偏压 $V$ 下的隧穿电流正比于可供隧穿的谱函数（由占据概率加权）的积分。总谱函数 $N(E, P)$ 是自旋分辨 DOS 的加权和，权重由铁磁电极的自旋极化率 $P$ 决定：\n$$ N(E, P) = w_{\\uparrow} \\rho_{\\uparrow}(E) + w_{\\downarrow} \\rho_{\\downarrow}(E) = \\frac{1+P}{2} \\rho_{\\uparrow}(E) + \\frac{1-P}{2} \\rho_{\\downarrow}(E) $$\n在有限温度 $T$ 下，微分电导 $G(V) = dI/dV$ 是通过将谱函数 $N(E, P)$ 与热展宽核 $K_T(E)$ 进行卷积得到的，热展宽核是费米-狄拉克分布 $f_{FD}(E) = (1 + e^{E/k_B T})^{-1}$ 的负导数：\n$$ G(V) \\propto \\int_{-\\infty}^{\\infty} N(E', P) \\left( -\\frac{\\partial f_{FD}(eV - E')}{\\partial(eV)} \\right) dE' $$\n该核函数为 $K_T(E) = -\\frac{\\partial f_{FD}(E)}{\\partial E} = \\frac{1}{4k_B T} \\mathrm{sech}^2\\left(\\frac{E}{2k_B T}\\right)$。该核函数是归一化的，使得 $\\int_{-\\infty}^{\\infty} K_T(E) dE = 1$。按照以 meV 为单位的能量 $eV$ 在数值上等于以 mV 为单位的偏压 $V$ 的约定，电导由以下卷积给出：\n$$ G(V) = (N(E, P) * K_T(E))|_{E=V} = \\int_{-\\infty}^{\\infty} N(E', P) K_T(V - E') dE' $$\n\n为了提取极化率 $P$，我们利用 $N(E, P)$ 对 $P$ 的线性依赖关系。我们可以将谱函数重写为：\n$$ N(E, P) = \\left[ \\frac{\\rho_{\\uparrow}(E) + \\rho_{\\downarrow}(E)}{2} \\right] + P \\left[ \\frac{\\rho_{\\uparrow}(E) - \\rho_{\\downarrow}(E)}{2} \\right] $$\n令 $N_A(E) = \\frac{1}{2}(\\rho_{\\uparrow}(E) + \\rho_{\\downarrow}(E))$ 为与极化无关的部分，令 $N_B(E) = \\frac{1}{2}(\\rho_{\\uparrow}(E) - \\rho_{\\downarrow}(E))$ 为依赖于极化的基函数。由于卷积的线性性质，电导也可以写成线性形式：\n$$ G(V, P) = G_A(V) + P \\cdot G_B(V) $$\n其中 $G_A(V) = (N_A * K_T)(V)$ 且 $G_B(V) = (N_B * K_T)(V)$。给定一条测量的电导曲线 $G_{meas}(V)$，我们可以通过在离散电压点 $V_i$ 上最小化均方误差 $\\chi^2 = \\sum_i [G_{meas}(V_i) - G(V_i, P)]^2$ 来估计 $P$。将导数 $\\partial \\chi^2 / \\partial P$ 设为零，可得出 $P$ 的最小二乘估计器：\n$$ P_{est} = \\frac{\\sum_i (G_{meas}(V_i) - G_A(V_i)) G_B(V_i)}{\\sum_i G_B(V_i)^2} = \\frac{(\\vec{G}_{meas} - \\vec{G}_A) \\cdot \\vec{G}_B}{\\vec{G}_B \\cdot \\vec{G}_B} $$\n其中向量表示在电压网格上求值的函数。如果塞曼分裂 $\\Delta_Z = 0$，则 $\\rho_{\\uparrow}(E) = \\rho_{\\downarrow}(E)$。这导致 $N_B(E)$ 以及随后的 $G_B(V)$ 恒等于零。在这种情况下，极化信息丢失，估计器的分母变为零。物理上正确的结果是 $P=0$，我们的算法必须强制执行这一点。\n\n数值实现过程如下。首先，为能量和电压建立一个足够精细和宽的数值网格。在该网格上计算自旋分辨的 DOS 和热学核函数。使用快速傅里叶变换 (FFT) 通过 `scipy.signal.fftconvolve` 高效地执行卷积，以获得 $G_{meas}(V)$ （来自 $P_{true}$）、$G_A(V)$ 和 $G_B(V)$。最后，将推导出的估计器公式应用于生成的 $G_{meas}(V)$，为每个给定的测试用例计算 $P_{est}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.signal import fftconvolve\n\ndef solve():\n    \"\"\"\n    Simulates spin-polarized tunneling and extracts ferromagnet spin polarization.\n    \"\"\"\n    # Boltzmann constant in meV/K\n    KB_MEV_K = 0.08617333\n\n    def bcs_dos(E, delta, gamma):\n        \"\"\"\n        Calculates the Dynes-broadened, particle-hole symmetric BCS density of states.\n        \n        Args:\n            E (np.ndarray): Energy grid in meV.\n            delta (float): Superconducting gap in meV.\n            gamma (float): Dynes broadening parameter in meV.\n            \n        Returns:\n            np.ndarray: The normalized density of states.\n        \"\"\"\n        # Complex energy E' = E - i*gamma\n        E_complex = E - 1j * gamma\n        \n        # Term inside the square root: (E')^2 - delta^2\n        sqrt_arg = E_complex**2 - delta**2\n        \n        # DOS is Re[|E'| / sqrt((E')^2 - delta^2)]\n        dos = np.real(np.abs(E_complex) / np.sqrt(sqrt_arg))\n        \n        return dos\n\n    def compute_conductance(V_grid, delta, delta_z, T, P, gamma):\n        \"\"\"\n        Computes the differential conductance G(V) for a F-I-S junction.\n        \n        Args:\n            V_grid (np.ndarray): Bias voltage grid in mV.\n            delta (float): Superconducting gap in meV.\n            delta_z (float): Zeeman splitting in meV.\n            T (float): Temperature in K.\n            P (float): Spin polarization.\n            gamma (float): Dynes broadening in meV.\n            \n        Returns:\n            np.ndarray: The simulated differential conductance G(V).\n        \"\"\"\n        # Energy grid is identical to voltage grid based on problem spec (eV -> V)\n        E_grid = V_grid\n        dE = E_grid[1] - E_grid[0]\n        \n        # 1. Spin-resolved DOS\n        dos_up = bcs_dos(E_grid - delta_z / 2, delta, gamma)\n        dos_down = bcs_dos(E_grid + delta_z / 2, delta, gamma)\n        \n        # 2. Total spectral function N(E, P)\n        w_up = (1 + P) / 2\n        w_down = (1 - P) / 2\n        N_total = w_up * dos_up + w_down * dos_down\n        \n        # 3. Thermal smearing kernel\n        k_BT = KB_MEV_K * T\n        if k_BT <= 0: # Avoid division by zero for T=0\n             # For T=0, the kernel is a delta function. Convolution is identity.\n             return N_total\n        \n        thermal_kernel = (1 / (4 * k_BT)) * (1 / np.cosh(E_grid / (2 * k_BT)))**2\n        \n        # Normalize kernel to ensure its discrete integral is 1\n        thermal_kernel /= np.sum(thermal_kernel) * dE\n        \n        # 4. Convolution using FFT for efficiency\n        conductance = fftconvolve(N_total, thermal_kernel, mode='same') * dE\n        \n        return conductance\n\n    def estimate_polarization(V_grid, G_measured, delta, delta_z, T, gamma):\n        \"\"\"\n        Estimates spin polarization P from a given conductance curve G(V).\n        \n        Args:\n            V_grid (np.ndarray): Bias voltage grid in mV.\n            G_measured (np.ndarray): The \"measured\" conductance curve.\n            delta (float): Superconducting gap in meV.\n            delta_z (float): Zeeman splitting in meV.\n            T (float): Temperature in K.\n            gamma (float): Dynes broadening in meV.\n            \n        Returns:\n            float: The estimated spin polarization P.\n        \"\"\"\n        # If there's no Zeeman splitting, P cannot be determined. Return 0.\n        if np.isclose(delta_z, 0.0):\n            return 0.0\n            \n        E_grid = V_grid\n        dE = E_grid[1] - E_grid[0]\n        \n        # Calculate basis functions G_A and G_B\n        dos_up = bcs_dos(E_grid - delta_z / 2, delta, gamma)\n        dos_down = bcs_dos(E_grid + delta_z / 2, delta, gamma)\n        \n        N_A = 0.5 * (dos_up + dos_down)\n        N_B = 0.5 * (dos_up - dos_down)\n        \n        k_BT = KB_MEV_K * T\n        if k_BT <= 0: # Handle T=0 case\n            G_A = N_A\n            G_B = N_B\n        else:\n            thermal_kernel = (1 / (4 * k_BT)) * (1 / np.cosh(E_grid / (2 * k_BT)))**2\n            thermal_kernel /= np.sum(thermal_kernel) * dE\n            G_A = fftconvolve(N_A, thermal_kernel, mode='same') * dE\n            G_B = fftconvolve(N_B, thermal_kernel, mode='same') * dE\n        \n        # Apply the least-squares estimator formula\n        numerator = np.dot(G_measured - G_A, G_B)\n        denominator = np.dot(G_B, G_B)\n        \n        # Avoid division by zero if G_B is numerically zero\n        if np.isclose(denominator, 0.0):\n            return 0.0\n            \n        P_est = numerator / denominator\n        return P_est\n\n    # Define numerical grid parameters\n    V_max = 5.0  # mV\n    N_points = 4097  # Use an odd number for symmetry, power of 2 + 1 is efficient\n    V_grid = np.linspace(-V_max, V_max, N_points)\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (delta, delta_z, T, P_true, gamma)\n        (1.5, 0.3, 1.5, 0.45, 0.03),  # Case 1: Happy path\n        (1.5, 0.3, 1.5, 0.0, 0.03),   # Case 2: Unpolarized boundary\n        (1.5, 0.05, 0.5, 0.5, 0.02),  # Case 3: Small Zeeman splitting\n        (1.5, 0.0, 0.5, 0.4, 0.02),   # Case 4: No Zeeman splitting\n        (1.5, 0.3, 5.0, 0.45, 0.05),  # Case 5: High-temperature smearing\n    ]\n\n    results = []\n    for case in test_cases:\n        delta, delta_z, T, P_true, gamma = case\n        \n        # 1. Simulate the \"measured\" conductance using P_true\n        G_measured = compute_conductance(V_grid, delta, delta_z, T, P_true, gamma)\n        \n        # 2. Estimate the polarization from the simulated data\n        P_estimated = estimate_polarization(V_grid, G_measured, delta, delta_z, T, gamma)\n        \n        results.append(P_estimated)\n\n    # Format results to four decimal places for final output\n    formatted_results = [f\"{r:.4f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3017039"}]}