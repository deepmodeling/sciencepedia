{"hands_on_practices": [{"introduction": "要真正掌握巨磁阻效应，最好的起点是亲手计算其核心参数。这个练习将引导你使用一个简化的双电流模型，这是理解自旋相关散射如何导致电阻变化的基础。通过计算并联（P）和反并联（AP）状态下的电阻，你将推导出巨磁阻比（GMR ratio），这是衡量自旋阀器件性能的关键指标 [@problem_id:1779536]。", "problem": "自旋阀是现代硬盘读头中使用的基本元件，其工作原理依赖于巨磁阻 (GMR) 效应。我们可以使用双电流模型来模拟一个简单自旋阀的电阻，在该模型中，电子被分为两个独立的通道：自旋向上和自旋向下。该器件的总电阻 $R$ 等效于这两个通道的电阻 $R_{\\uparrow}$ 和 $R_{\\downarrow}$ 并联。\n\n自旋阀由两层铁磁层和一层薄的非磁性隔离层隔开组成。电子在铁磁层中经历的电阻取决于其自旋方向与该层磁化方向的相对关系。设 $r_a$ 为自旋与该层磁化方向平行的电子的电阻元，而 $r_{anti}$ 为自旋与该层磁化方向反平行的电子的电阻元。由于散射增加，反平行情况下的电阻要显著更高。对于此器件，这种关系由一个自旋散射不对称因子 $\\alpha$ 描述，使得 $r_{anti} = \\alpha r_a$。每个自旋通道的总电阻是其在两个铁磁层中电阻的总和。\n\n该器件可以处于两种状态：\n1.  **平行 (P) 构型**：两个铁磁层的磁化方向平行。\n2.  **反平行 (AP) 构型**：两个铁磁层的磁化方向反平行。\n\n对于这个特定器件，自旋散射不对称因子为 $\\alpha = 9$。请计算 GMR 比率，其定义为 $\\frac{R_{AP} - R_{P}}{R_{P}}$，其中 $R_{P}$ 和 $R_{AP}$ 分别为平行和反平行构型下的器件总电阻。将您的答案表示为小数，并四舍五入到三位有效数字。", "solution": "在双电流模型中，器件的总电阻是自旋向上和自旋向下通道电阻的并联组合，所以 $R=\\frac{R_{\\uparrow}R_{\\downarrow}}{R_{\\uparrow}+R_{\\downarrow}}$。每个自旋通道的总电阻是其在两个铁磁层中电阻的总和。设 $r_{a}$ 为平行自旋的电阻，$r_{anti}=\\alpha r_{a}$ 为反平行自旋的电阻。\n\n平行构型：\n- 与共同磁化方向平行的自旋在两层中都是平行的，因此 $R_{\\uparrow}^{P}=r_{a}+r_{a}=2r_{a}$。\n- 与共同磁化方向反平行的自旋在两层中都是反平行的，因此 $R_{\\downarrow}^{P}=r_{anti}+r_{anti}=2\\alpha r_{a}$。\n- 总电阻是并联组合：\n$$\nR_{P}=\\frac{R_{\\uparrow}^{P}R_{\\downarrow}^{P}}{R_{\\uparrow}^{P}+R_{\\downarrow}^{P}}=\\frac{(2r_{a})(2\\alpha r_{a})}{2r_{a}+2\\alpha r_{a}}=\\frac{2\\alpha}{1+\\alpha}\\,r_{a}.\n$$\n\n反平行构型：\n- 每个自旋在一层中是平行的，在另一层中是反平行的，所以 $R_{\\uparrow}^{AP}=R_{\\downarrow}^{AP}=r_{a}+r_{anti}=(1+\\alpha)r_{a}$。\n- 两个相等的电阻并联，总电阻为单个电阻值的一半：\n$$\nR_{AP}=\\frac{(1+\\alpha)r_{a}}{2}.\n$$\n\nGMR 比率为\n$$\n\\frac{R_{AP}-R_{P}}{R_{P}}=\\frac{\\frac{(1+\\alpha)r_{a}}{2}-\\frac{2\\alpha}{1+\\alpha}r_{a}}{\\frac{2\\alpha}{1+\\alpha}r_{a}}=\\frac{(1+\\alpha)^{2}-4\\alpha}{4\\alpha}=\\frac{(\\alpha-1)^{2}}{4\\alpha}.\n$$\n当 $\\alpha=9$ 时，\n$$\n\\frac{R_{AP}-R_{P}}{R_{P}}=\\frac{(9-1)^{2}}{4\\cdot 9}=\\frac{64}{36}=\\frac{16}{9}\\approx 1.78,\n$$\n四舍五入到三位有效数字。", "answer": "$$\\boxed{1.78}$$", "id": "1779536"}, {"introduction": "在掌握了基础模型之后，下一步是构建一个更贴近真实器件的物理图像。这个练习将挑战你分析一个电流垂直平面（CPP）结构的三层膜，其中明确区分了体电阻率和界面电阻的贡献 [@problem_id:2992241]。这种精细化的电阻网络模型对于定量理解和设计高性能的 GMR 器件至关重要，它能帮助你更好地将理论与实验测量联系起来。", "problem": "考虑一个由铁磁体/非磁性体/铁磁体（$F/N/F$）构成的电流垂直于平面的三层结构，其中两个铁磁层相同，厚度均为$t_{F}$，非磁性间隔层的厚度为$t_{N}$。该器件具有均匀的横截面积$A$，且电流均匀流过。假设采用双电流模型（自旋向上和自旋向下的通道独立导电，无自旋翻转散射），并假设为线性响应（欧姆输运）。铁磁体中自旋向上和自旋向下电子的体电阻率分别为$\\rho_{F}^{\\uparrow}$和$\\rho_{F}^{\\downarrow}$。非磁性间隔层的体电阻率与自旋无关，等于$\\rho_{N}$。每个$F/N$界面都贡献一个与自旋相关的界面比电阻（面积-电阻乘积），分别表示为$R_{b}^{\\uparrow}$和$R_{b}^{\\downarrow}$，单位为$\\mathrm{\\Omega \\, m^{2}}$。在三层结构中有两个$F/N$界面。忽略任何其他界面贡献。\n\n在平行(P)磁构型中，两个铁磁体的磁化方向一致。在反平行(AP)构型中，它们的磁化方向相反。界面比电阻是相对于相邻铁磁体的局域磁化方向定义的；因此，在AP构型中，一个相对于左侧铁磁体是自旋向上的电子，在到达右侧铁磁体界面时，将相对于右侧铁磁体是自旋向下的。\n\n仅从欧姆定律、厚度为$L$且电阻率为$\\rho$的平板的体电阻定义$R = \\rho L/A$、给定自旋通道内电阻的串联相加以及两个自旋通道电导的并联相加出发，推导在P和AP构型下器件总电阻$R_{P}$和$R_{AP}$（单位为$\\mathrm{\\Omega}$）的闭合形式表达式，这些表达式应为$A$、$t_{F}$、$t_{N}$、$\\rho_{F}^{\\uparrow}$、$\\rho_{F}^{\\downarrow}$、$\\rho_{N}$、$R_{b}^{\\uparrow}$和$R_{b}^{\\downarrow}$的函数。请以解析表达式的形式给出最终答案。不需要进行数值计算。最终电阻请以$\\mathrm{\\Omega}$为单位表示（而不是面积-电阻乘积）。", "solution": "此问题被认为是有效的，因为它代表了凝聚态物理学中一个标准的、适定的问题，具有科学依据、自洽且客观。不存在矛盾、信息缺失或违反物理原理的情况。因此，我们可以进行推导。\n\n分析基于双电流模型，其中自旋向上($\\uparrow$)和自旋向下($\\downarrow$)的电子被视为两个独立的并行导电通道。器件的总电阻通过以下步骤确定：首先，通过对每个自旋通道的构成层和界面的电阻进行串联相加来计算该通道的电阻；然后，将两个通道的电导并联相加。该结构为$F/N/F$三层结构，电流垂直于平面(CPP)。\n\n首先，我们定义三层结构中每个组成部分的电阻，单位为欧姆($\\Omega$)。给定体电阻率$\\rho$、层厚度$L$和横截面积$A$，电阻为$R = \\rho L / A$。给定界面比电阻（面积-电阻乘积）$R_b$，界面电阻为$R_{int} = R_b / A$。\n\n各个组成部分的电阻如下：\n-   厚度为$t_F$的单个铁磁($F$)层的电阻：\n    $$R_{F}^{\\uparrow} = \\frac{\\rho_{F}^{\\uparrow} t_{F}}{A}$$\n    $$R_{F}^{\\downarrow} = \\frac{\\rho_{F}^{\\downarrow} t_{F}}{A}$$\n-   厚度为$t_N$的非磁性($N$)间隔层的电阻：\n    $$R_N = \\frac{\\rho_N t_N}{A}$$\n-   单个F/N界面的电阻：\n    $$R_{int}^{\\uparrow} = \\frac{R_{b}^{\\uparrow}}{A}$$\n    $$R_{int}^{\\downarrow} = \\frac{R_{b}^{\\downarrow}}{A}$$\n\n我们现在推导平行(P)和反平行(AP)磁构型下的总电阻。\n\n**平行(P)构型**\n在P构型中，两个铁磁层的磁化方向一致。电子在穿过整个器件的过程中，其自旋状态保持不变。\n\n自旋向上通道包含两个$F$层、一个$N$层和两个$F/N$界面，它们都对自旋向上电子的电阻有贡献。自旋向上通道的总电阻$R_{P}^{\\uparrow}$是它们的串联总和：\n$$R_{P}^{\\uparrow} = R_{F}^{\\uparrow} + R_{int}^{\\uparrow} + R_{N} + R_{int}^{\\uparrow} + R_{F}^{\\uparrow} = 2 R_{F}^{\\uparrow} + 2 R_{int}^{\\uparrow} + R_{N}$$\n代入每个组成部分的表达式：\n$$R_{P}^{\\uparrow} = 2 \\frac{\\rho_{F}^{\\uparrow} t_{F}}{A} + 2 \\frac{R_{b}^{\\uparrow}}{A} + \\frac{\\rho_{N} t_{N}}{A} = \\frac{1}{A} (2 \\rho_{F}^{\\uparrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\uparrow})$$\n\n类似地，自旋向下通道的总电阻$R_{P}^{\\downarrow}$为：\n$$R_{P}^{\\downarrow} = 2 R_{F}^{\\downarrow} + 2 R_{int}^{\\downarrow} + R_{N} = \\frac{1}{A} (2 \\rho_{F}^{\\downarrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\downarrow})$$\n\n器件的总电阻$R_P$通过将两个通道并联得到：\n$$R_P = \\left( \\frac{1}{R_{P}^{\\uparrow}} + \\frac{1}{R_{P}^{\\downarrow}} \\right)^{-1} = \\frac{R_{P}^{\\uparrow} R_{P}^{\\downarrow}}{R_{P}^{\\uparrow} + R_{P}^{\\downarrow}}$$\n代入$R_{P}^{\\uparrow}$和$R_{P}^{\\downarrow}$的表达式：\n分子中的乘积是：\n$$R_{P}^{\\uparrow} R_{P}^{\\downarrow} = \\frac{1}{A^2} (2 \\rho_{F}^{\\uparrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\uparrow}) (2 \\rho_{F}^{\\downarrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\downarrow})$$\n分母中的和是：\n$$R_{P}^{\\uparrow} + R_{P}^{\\downarrow} = \\frac{1}{A} [ (2 \\rho_{F}^{\\uparrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\uparrow}) + (2 \\rho_{F}^{\\downarrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\downarrow}) ]$$\n$$R_{P}^{\\uparrow} + R_{P}^{\\downarrow} = \\frac{2}{A} [ (\\rho_{F}^{\\uparrow} + \\rho_{F}^{\\downarrow}) t_{F} + \\rho_{N} t_{N} + (R_{b}^{\\uparrow} + R_{b}^{\\downarrow}) ]$$\n将这些组合起来，得到$R_P$的最终表达式：\n$$R_P = \\frac{\\frac{1}{A^2} (2 \\rho_{F}^{\\uparrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\uparrow})(2 \\rho_{F}^{\\downarrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\downarrow})}{\\frac{2}{A} [(\\rho_{F}^{\\uparrow} + \\rho_{F}^{\\downarrow}) t_{F} + \\rho_{N} t_{N} + (R_{b}^{\\uparrow} + R_{b}^{\\downarrow})]}$$\n$$R_P = \\frac{1}{2A} \\frac{(2 \\rho_{F}^{\\uparrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\uparrow})(2 \\rho_{F}^{\\downarrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\downarrow})}{(\\rho_{F}^{\\uparrow} + \\rho_{F}^{\\downarrow}) t_{F} + \\rho_{N} t_{N} + R_{b}^{\\uparrow} + R_{b}^{\\downarrow}}$$\n\n**反平行(AP)构型**\n在AP构型中，磁化方向相反。我们将自旋量子化轴固定在左侧铁磁体的磁化方向上。一个相对于左侧铁磁体是自旋向上的电子，相对于右侧铁磁体则是自旋向下的，反之亦然。\n\n我们来追踪第一个通道，即一个相对于左侧铁磁体是自旋$\\uparrow$的电子。它串联经历以下电阻：\n1.  左侧$F$层：$R_{F}^{\\uparrow}$\n2.  第一个$F/N$界面：$R_{int}^{\\uparrow}$\n3.  $N$间隔层：$R_{N}$\n4.  第二个$F/N$界面：此时相对于右侧铁磁体是自旋$\\downarrow$，因此经历的电阻是$R_{int}^{\\downarrow}$。\n5.  右侧$F$层：作为自旋$\\downarrow$电子经历电阻，即$R_{F}^{\\downarrow}$。\n\n此通道的总电阻$R_{AP, 1}$为：\n$$R_{AP, 1} = R_{F}^{\\uparrow} + R_{int}^{\\uparrow} + R_{N} + R_{int}^{\\downarrow} + R_{F}^{\\downarrow}$$\n\n对于第二个通道（相对于左侧铁磁体是自旋$\\downarrow$），串联电阻为：$R_{F}^{\\downarrow}$、$R_{int}^{\\downarrow}$、$R_{N}$、$R_{int}^{\\uparrow}$和$R_{F}^{\\uparrow}$。总电阻为：\n$$R_{AP, 2} = R_{F}^{\\downarrow} + R_{int}^{\\downarrow} + R_{N} + R_{int}^{\\uparrow} + R_{F}^{\\uparrow}$$\n\n显然，$R_{AP, 1} = R_{AP, 2}$。我们将这个单一通道的电阻表示为$R_{AP}^{\\text{channel}}$。\n$$R_{AP}^{\\text{channel}} = (\\rho_{F}^{\\uparrow} + \\rho_{F}^{\\downarrow})\\frac{t_{F}}{A} + (R_{b}^{\\uparrow} + R_{b}^{\\downarrow})\\frac{1}{A} + \\rho_{N}\\frac{t_{N}}{A}$$\n$$R_{AP}^{\\text{channel}} = \\frac{1}{A} [(\\rho_{F}^{\\uparrow} + \\rho_{F}^{\\downarrow}) t_{F} + \\rho_{N} t_{N} + R_{b}^{\\uparrow} + R_{b}^{\\downarrow}]$$\n\n器件总电阻$R_{AP}$是两个相同电阻$R_{AP}^{\\text{channel}}$的并联组合：\n$$R_{AP} = \\left( \\frac{1}{R_{AP}^{\\text{channel}}} + \\frac{1}{R_{AP}^{\\text{channel}}} \\right)^{-1} = \\frac{R_{AP}^{\\text{channel}}}{2}$$\n代入$R_{AP}^{\\text{channel}}$的表达式，得到$R_{AP}$的最终表达式：\n$$R_{AP} = \\frac{1}{2A} [(\\rho_{F}^{\\uparrow} + \\rho_{F}^{\\downarrow}) t_{F} + \\rho_{N} t_{N} + R_{b}^{\\uparrow} + R_{b}^{\\downarrow}]$$\n因此，两个所需的表达式都已推导得出。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2A} \\frac{(2 \\rho_{F}^{\\uparrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\uparrow})(2 \\rho_{F}^{\\downarrow} t_{F} + \\rho_{N} t_{N} + 2 R_{b}^{\\downarrow})}{(\\rho_{F}^{\\uparrow} + \\rho_{F}^{\\downarrow}) t_{F} + \\rho_{N} t_{N} + R_{b}^{\\uparrow} + R_{b}^{\\downarrow}} & \\frac{1}{2A} [(\\rho_{F}^{\\uparrow} + \\rho_{F}^{\\downarrow}) t_{F} + \\rho_{N} t_{N} + R_{b}^{\\uparrow} + R_{b}^{\\downarrow}] \\end{pmatrix}}$$", "id": "2992241"}, {"introduction": "虽然唯象的电阻模型极具解释力，但预测新材料的 GMR 特性则需要更根本的量子输运理论。这个高级实践将引导你进入计算凝聚态物理的前沿，通过一个结合了密度泛函理论思想和格林函数方法的计算工作流，从第一性原理出发计算自旋相关的电子透射率 [@problem_id:2992231]。完成这个练习意味着你将掌握从基本哈密顿量到可测量的宏观物理量（如 GMR 比）的现代研究方法。", "problem": "您需要设计并实现一个完整的、可运行的程序，该程序旨在操作一个从头计算工作流。该工作流结合了密度泛函理论（DFT）与波函数匹配方法，用以计算自旋分辨透射率 $T_s(E)$，并在弹道输运、单轨道、最近邻紧束缚近似下，预测一个特定的铁磁体/正常金属（$F/N$）界面的垂直平面电流巨磁阻（CPP GMR）。计算必须以纯粹的数学和逻辑术语表达，并在明确说明的假设下产生可进行数值检验的输出。\n\n您必须假设以下基于物理动机的模型和基本依据：\n\n- 从用于相位相干输运的 Landauer–Büttiker 形式论出发，其中两端电导由透射概率决定。将每个自旋通道 $s \\in \\{\\uparrow,\\downarrow\\}$ 独立处理，界面处的散射为自旋守恒散射。\n- 将 DFT 推导的电子结构映射为铁磁性导线中每个自旋通道的单轨道（类$s$轨道）紧束缚哈密顿量，以及正常金属导线中的单轨道紧束缚哈密顿量。将模型限制为半无限一维链，其最近邻跃迁和在位能通过从头计算的能带中心和带宽进行拟合。界面由一个单一的界面轨道表示，该轨道与铁磁性导线的最后一个格点以及正常金属导线的第一个格点耦合。\n- 使用通过推迟格林函数表示的波函数匹配来获得半无限导线的表面自能，并计算通过单一界面轨道的透射率 $T_s(E)$。采用推迟边界条件和针对导线能带之外能量的主值规定，以确保科学真实性。\n- 为一个对称的 $F/N/F$ 自旋阀建模，该阀具有两个相同的 $F/N$ 界面，由一个间隔层隔开。为简化起见，忽略间隔层的相位相干性（界面电阻的非相干串联相加）。使用平行和反平行磁化排列计算 CPP GMR 比率，结果为无量纲的小数。\n\n您的程序必须实现以下任务：\n\n1. 用自旋相关的参数 $(\\epsilon_{F,\\uparrow}, t_{F,\\uparrow})$ 和 $(\\epsilon_{F,\\downarrow}, t_{F,\\downarrow})$ 表示铁磁性导线，用 $(\\epsilon_N, t_N)$ 表示正常金属导线，用 $(\\epsilon_{C,\\uparrow}, \\epsilon_{C,\\downarrow})$ 表示界面轨道，其与铁磁体的耦合为 $(t_{cL,\\uparrow}, t_{cL,\\downarrow})$，与正常金属的耦合为 $t_{cR}$。所有能量和跃迁项必须以电子伏特（eV）为单位处理。\n2. 使用基于半无限紧束缚链的推迟格林函数的波函数匹配方法，计算在指定能量 $E$ 下的自旋分辨单界面透射率 $T_s(E)$。\n3. 对于平行（P）和反平行（AP）磁化排列，通过对两个相同界面的非相干串联相加来近似对称 $F/N/F$ 器件的电导。由此，计算定义为 $(R_{\\mathrm{AP}} - R_{\\mathrm{P}})/R_{\\mathrm{P}}$ 的 CPP GMR 比率，以不带百分号的小数表示。\n4. 生成最终输出，为一行包含所提供测试套件结果的列表。每个测试用例的结果必须是一个包含三个浮点数的列表 $[T_{\\uparrow}(E), T_{\\downarrow}(E), \\mathrm{GMR}]$，四舍五入到六位小数。最终打印必须生成形如 $[[r_{1,1},r_{1,2},r_{1,3}],[r_{2,1},r_{2,2},r_{2,3}],\\dots]$ 的单行。\n\n单位和约定：\n\n- 能量和跃迁项必须以电子伏特（eV）为单位。\n- 自旋分辨透射率 $T_s(E)$ 是无量纲的。\n- GMR 比率必须以小数表示。\n\n测试套件和模型参数：\n\n在所有测试用例中，为铁磁体、正常金属和界面轨道使用以下固定参数：\n\n- 铁磁体（左导线）：\n  - $\\epsilon_{F,\\uparrow} = -0.6$ eV, $t_{F,\\uparrow} = 1.3$ eV.\n  - $\\epsilon_{F,\\downarrow} = +0.4$ eV, $t_{F,\\downarrow} = 0.9$ eV.\n- 正常金属（右导线）：\n  - $\\epsilon_{N} = 0.0$ eV, $t_{N} = 1.0$ eV.\n- 界面轨道：\n  - $\\epsilon_{C,\\uparrow} = -0.1$ eV, $\\epsilon_{C,\\downarrow} = +0.1$ eV.\n  - $t_{cR} = 0.85$ eV.\n\n定义四个测试用例，它们改变费米能量 $E$ 和铁磁体到界面的耦合：\n\n- 测试用例 1（一般情况）：\n  - $E = 0.0$ eV.\n  - $t_{cL,\\uparrow} = 0.9$ eV, $t_{cL,\\downarrow} = 0.8$ eV.\n- 测试用例 2（近能带边缘行为）：\n  - $E = 1.99$ eV.\n  - $t_{cL,\\uparrow} = 0.9$ eV, $t_{cL,\\downarrow} = 0.8$ eV.\n- 测试用例 3（弱界面耦合）：\n  - $E = -0.5$ eV.\n  - $t_{cL,\\uparrow} = 0.2$ eV, $t_{cL,\\downarrow} = 0.2$ eV.\n- 测试用例 4（上能带中的自旋不对称透射）：\n  - $E = 1.85$ eV.\n  - $t_{cL,\\uparrow} = 0.9$ eV, $t_{cL,\\downarrow} = 0.8$ eV.\n\n要求的最终输出格式：\n\n- 您的程序应生成一行输出，其中包含一个逗号分隔的列表的列表，每个内层列表包含三个浮点数 $[T_{\\uparrow}(E), T_{\\downarrow}(E), \\mathrm{GMR}]$，均四舍五入到六位小数，并用方括号括起来，对应于上述定义的四个测试用例的顺序。例如：$[[r_{1,1},r_{1,2},r_{1,3}],[r_{2,1},r_{2,2},r_{2,3}],[r_{3,1},r_{3,2},r_{3,3}],[r_{4,1},r_{4,2},r_{4,3}]]$。", "solution": "该问题要求计算一个铁磁体/正常金属/铁磁体（$F/N/F$）自旋阀的自旋分辨透射率和巨磁阻（GMR）。其理论框架基于应用于一个简化的一维单轨道紧束缚模型的 Landauer-Büttiker 形式论。计算将使用推迟格林函数技术进行。\n\n首先，我们对系统进行建模。它由两个半无限导线，一个左侧的铁磁体（$F$）和一个右侧的正常金属（$N$）组成，通过一个单一的界面轨道（$C$）耦合。由于左侧导线的铁磁性质，其电子结构是自旋相关的。我们独立描述每个自旋通道 $s \\in \\{\\uparrow, \\downarrow\\}$。导线的紧束缚哈密顿量由在位能 $\\epsilon$ 和最近邻跃迁积分 $t$ 来表征。铁磁性导线的参数为 $(\\epsilon_{F,s}, t_{F,s})$，正常金属导线的参数为 $(\\epsilon_N, t_N)$，界面轨道具有自旋相关的在位能 $\\epsilon_{C,s}$。从左导线到中心格点的耦合（跃迁）为 $t_{cL,s}$，从中心格点到右导线的耦合为 $t_{cR}$。\n\n计算的核心是推迟格林函数。对于一个参数为 $(\\epsilon, t)$ 的半无限一维紧束缚链，其表面格点的格林函数 $g^R_{surf}(E)$ 通过求解表面格点的戴森方程得到。这会产生一个关于 $g^R_{surf}$ 的二次方程，选择物理可行解（对应于出射波或衰减态）可得：\n$$\ng^R_{surf}(E; \\epsilon, t) = \\frac{(E - \\epsilon) - \\sqrt{(E - \\epsilon)^2 - 4t^2}}{2t^2}\n$$\n必须小心处理平方根以确保正确的推迟边界条件。从解析上讲，这意味着对于能量 $E$ 在导线导带内（$|E-\\epsilon| \\le 2|t|$）的情况，平方根的参数为负，我们取其根为具有负号的纯虚数，以确保 $g^R_{surf}(E)$ 的虚部非正。对于能带外的能量，根是实数，其符号的选择应对应于一个远离界面衰减的态。使用复数算术，将平方根的参数视为复数 $(E - \\epsilon)^2 - 4t^2 + i0^+$ 能正确地涵盖所有情况，其中平方根的主分支通常产生一个非负的虚部，因此需要在分子中明确使用减号。\n\n半无限导线充当电荷库，使中心格点的能级展宽。这种效应由自能 $\\Sigma^R(E)$ 捕捉。对于给定的自旋通道 $s$，左导线（$L$）和右导线（$R$）施加在中心格点上的自能由下式给出：\n$$\n\\Sigma^R_{L,s}(E) = t_{cL,s}^2 \\cdot g^R_{surf}(E; \\epsilon_{F,s}, t_{F,s})\n$$\n$$\n\\Sigma^R_{R}(E) = t_{cR}^2 \\cdot g^R_{surf}(E; \\epsilon_N, t_N)\n$$\n请注意，正常金属导线的参数是自旋无关的。\n\n中心界面格点的完整推迟格林函数，被其与导线的耦合“修饰”后，为：\n$$\nG^R_{C,s}(E) = \\left[ E - \\epsilon_{C,s} - \\Sigma^R_{L,s}(E) - \\Sigma^R_{R}(E) \\right]^{-1}\n$$\n自旋通道 $s$ 通过界面的透射概率 $T_s(E)$ 由 Landauer-Büttiker 公式给出，对于单格点导体，该公式简化为：\n$$\nT_s(E) = \\Gamma_{L,s}(E) \\cdot \\Gamma_{R}(E) \\cdot |G^R_{C,s}(E)|^2\n$$\n这里，$\\Gamma_{L/R,s}$ 是展宽函数（或耦合速率），表示电子从导线进入中心格点或从中心格点离开到导线的速率。它们与自能的虚部有关：\n$$\n\\Gamma_{L/R,s}(E) = -2 \\, \\mathrm{Im}[\\Sigma^R_{L/R,s}(E)]\n$$\n透射仅在电子在两个导线中都有可用态的能量下发生，这对应于 $\\Gamma_{L,s}$ 和 $\\Gamma_{R}$ 均为非零值。\n\n接下来，我们计算对称 $F/N/F$ 器件的 GMR。问题指定了两个相同 $F/N$ 界面电阻的非相干相加。我们考虑两个平行的自旋通道贯穿整个器件。\n\n对于平行（P）构型，两个 $F$ 层的磁化方向一致。\n自旋向上通道的总电阻是两个界面电阻之和：$R_{P,\\uparrow} = R_\\uparrow + R_\\uparrow = 2 R_\\uparrow$。以电阻量子 $R_0 = h/e^2$ 为单位，我们有 $R_s = 1/T_s(E)$。\n因此，$R_{P,\\uparrow} = 2/T_\\uparrow(E)$。类似地，对于自旋向下通道，$R_{P,\\downarrow} = 2/T_\\downarrow(E)$。\n总电阻 $R_P$ 是通过将两个平行自旋通道的电导（电阻的倒数）相加得到的：\n$$\n\\frac{1}{R_P} = \\frac{1}{R_{P,\\uparrow}} + \\frac{1}{R_{P,\\downarrow}} = \\frac{T_\\uparrow(E)}{2} + \\frac{T_\\downarrow(E)}{2} \\implies R_P = \\frac{2}{T_\\uparrow(E) + T_\\downarrow(E)}\n$$\n\n对于反平行（AP）构型，第二个 $F$ 层的磁化方向被翻转。处于自旋向上通道的电子以透射率 $T_\\uparrow$ 穿过第一个界面，以透射率 $T_\\downarrow$ 穿过第二个界面。\n该路径的总电阻为 $R_{AP,\\text{path1}} = R_\\uparrow + R_\\downarrow = 1/T_\\uparrow(E) + 1/T_\\downarrow(E)$。\n另一条路径，对于最初处于自旋向下通道的电子，是对称的：$R_{AP,\\text{path2}} = R_\\downarrow + R_\\uparrow = R_{AP,\\text{path1}}$。\n总电阻 $R_{AP}$ 由这两个平行的相同路径得出：\n$$\n\\frac{1}{R_{AP}} = \\frac{1}{R_{AP,\\text{path1}}} + \\frac{1}{R_{AP,\\text{path2}}} = \\frac{2}{1/T_\\uparrow(E) + 1/T_\\downarrow(E)} \\implies R_{AP} = \\frac{1}{2} \\left( \\frac{1}{T_\\uparrow(E)} + \\frac{1}{T_\\downarrow(E)} \\right) = \\frac{T_\\uparrow(E) + T_\\downarrow(E)}{2 T_\\uparrow(E) T_\\downarrow(E)}\n$$\n\n最后，GMR 比率定义为 $(R_{AP} - R_P)/R_P = R_{AP}/R_P - 1$。代入推导出的 $R_P$ 和 $R_{AP}$ 表达式（以 $R_0$ 为单位）：\n$$\n\\mathrm{GMR} = \\frac{\\frac{T_\\uparrow + T_\\downarrow}{2 T_\\uparrow T_\\downarrow}}{\\frac{2}{T_\\uparrow + T_\\downarrow}} - 1 = \\frac{(T_\\uparrow + T_\\downarrow)^2}{4 T_\\uparrow T_\\downarrow} - 1\n$$\n该表达式可以简化为：\n$$\n\\mathrm{GMR} = \\frac{T_\\uparrow^2 + 2T_\\uparrow T_\\downarrow + T_\\downarrow^2 - 4T_\\uparrow T_\\downarrow}{4 T_\\uparrow T_\\downarrow} = \\frac{(T_\\uparrow - T_\\downarrow)^2}{4 T_\\uparrow T_\\downarrow}\n$$\n这个最终公式提供了基于单界面自旋分辨透射率的 GMR 比率。算法将为每个测试用例实现这些公式，利用 `numpy` 库的复数支持来进行计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are permitted.\n\ndef solve():\n    \"\"\"\n    Main function to solve the CPP-GMR problem for the given test suite.\n    It orchestrates the calculation for each test case and prints the final result.\n    \"\"\"\n\n    # Fixed parameters as defined in the problem statement.\n    # Ferromagnet (F) lead parameters in eV\n    eps_F_up, t_F_up = -0.6, 1.3\n    eps_F_down, t_F_down = 0.4, 0.9\n    # Normal metal (N) lead parameters in eV\n    eps_N, t_N = 0.0, 1.0\n    # Interfacial orbital parameters in eV\n    eps_C_up, eps_C_down = -0.1, 0.1\n    # Interface coupling parameters in eV\n    t_cR = 0.85\n\n    # Test cases defined in the problem statement.\n    # Each case is a tuple: (E, t_cL_up, t_cL_down)\n    test_cases = [\n        (0.0, 0.9, 0.8),    # Test case 1\n        (1.99, 0.9, 0.8),   # Test case 2\n        (-0.5, 0.2, 0.2),   # Test case 3\n        (1.85, 0.9, 0.8),   # Test case 4\n    ]\n\n    # Pre-calculate surface Green's function for the right (Normal Metal) lead\n    # as it's common for all spins and test cases unless E changes.\n    \n    def get_surface_g(E, eps, t):\n        \"\"\"\n        Calculates the retarded surface Green's function for a semi-infinite 1D tight-binding lead.\n        \n        Args:\n            E (float): Energy in eV.\n            eps (float): Onsite energy of the lead in eV.\n            t (float): Hopping parameter of the lead in eV.\n            \n        Returns:\n            complex: The value of the retarded surface Green's function.\n        \"\"\"\n        if t == 0:\n            return 1j * np.inf # Avoid division by zero, though not expected\n        \n        # Use complex arithmetic to handle in-band and out-of-band cases correctly.\n        # The term (E - eps)^2 - 4*t^2 + 0j ensures numpy.sqrt returns a complex number.\n        # The principal root of sqrt for a negative real number is on the positive imaginary axis.\n        # The minus sign before the sqrt ensures the correct retarded boundary condition (Im(g) <= 0).\n        z = (E - eps)\n        arg_sqrt = z**2 - 4 * t**2 + 0j\n        numerator = z - np.sqrt(arg_sqrt)\n        denominator = 2 * t**2\n        \n        return numerator / denominator\n\n    def compute_results_for_case(case):\n        \"\"\"\n        Computes the spin-resolved transmission and GMR for a single test case.\n        \"\"\"\n        E, t_cL_up, t_cL_down = case\n\n        # --- Right Lead (Normal Metal) Calculations ---\n        # These are spin-independent.\n        g_surf_R = get_surface_g(E, eps_N, t_N)\n        sigma_R = t_cR**2 * g_surf_R\n        gamma_R = -2 * np.imag(sigma_R)\n\n        # --- Spin-Up Channel Calculation ---\n        g_surf_L_up = get_surface_g(E, eps_F_up, t_F_up)\n        sigma_L_up = t_cL_up**2 * g_surf_L_up\n        gamma_L_up = -2 * np.imag(sigma_L_up)\n        \n        # Dressed Green's function for the central site\n        g_C_up_inv = E - eps_C_up - sigma_L_up - sigma_R\n        g_C_up = 1.0 / g_C_up_inv\n        \n        # Transmission for spin-up\n        T_up = gamma_L_up * gamma_R * np.abs(g_C_up)**2\n\n        # --- Spin-Down Channel Calculation ---\n        g_surf_L_down = get_surface_g(E, eps_F_down, t_F_down)\n        sigma_L_down = t_cL_down**2 * g_surf_L_down\n        gamma_L_down = -2 * np.imag(sigma_L_down)\n        \n        # Dressed Green's function for the central site\n        g_C_down_inv = E - eps_C_down - sigma_L_down - sigma_R\n        g_C_down = 1.0 / g_C_down_inv\n        \n        # Transmission for spin-down\n        T_down = gamma_L_down * gamma_R * np.abs(g_C_down)**2\n\n        # --- GMR Calculation ---\n        # Handle cases where transmission might be zero to avoid division by zero.\n        if T_up * T_down == 0:\n            # If T_up and T_down are not equal, GMR is infinite.\n            # If they are both zero, resistances are both infinite and GMR is ill-defined.\n            # A common physical convention is GMR=0 if total transmission is zero.\n            # However, the formula (T_up-T_down)^2 / (4*T_up*T_down) suggests divergence.\n            # For the given test cases, this is not expected to happen.\n            if T_up == T_down:\n                gmr = 0.0\n            else:\n                gmr = np.inf # Placeholder for an infinite GMR\n        else:\n            gmr = (T_up - T_down)**2 / (4 * T_up * T_down)\n            \n        return [round(T_up, 6), round(T_down, 6), round(gmr, 6)]\n\n    # Process all test cases\n    results = [compute_results_for_case(case) for case in test_cases]\n\n    # Format the final output as a single string\n    result_str = \",\".join([str(r) for r in results])\n    result_str = result_str.replace(\" \", \"\") # Remove spaces for compact representation\n\n    # Print the final result in the exact required format.\n    print(f\"[{result_str}]\")\n\nsolve()\n\n```", "id": "2992231"}]}