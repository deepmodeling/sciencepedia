{"hands_on_practices": [{"introduction": "这个练习将理论与实验数据分析紧密结合。在真实的材料中，外在自旋霍尔效应通常由两种主要机制贡献：斜散射和边跳。本练习旨在通过一个假设的实验数据集，教会你如何分离这两种贡献，并计算出总的自旋霍尔角及其不确定度，这对于严谨地解读实验结果至关重要 `[@problem_id:3020544]`。", "problem": "考虑一个处于稀杂质、低温区域的非磁性金属薄膜，此条件下自旋霍尔效应 (SHE) 由外源散射主导。\n\n自旋霍尔角定义为横向自旋流 $J_{s}$ 与纵向电荷流 $J_{c}$ 的无量纲比值 $\\theta_{\\mathrm{SH}} \\equiv J_{s}/J_{c}$，其包含两项相加的外源贡献：(i) 斜散射，它对 $\\theta_{\\mathrm{SH}}$ 的贡献与电阻率无关；(ii) 侧跳，其贡献与剩余电阻率成线性关系。这些论述在金属中杂质诱导的自旋轨道散射理论中是公认的。\n\n一项低温实验提供了以下数据：\n- 剩余电阻率 $\\,\\rho_{0} = 8.3\\,\\mu\\Omega\\cdot\\mathrm{cm}\\,$，标准不确定度 $\\,\\sigma_{\\rho} = 0.2\\,\\mu\\Omega\\cdot\\mathrm{cm}\\,$.\n- 拟合的斜散射系数 $\\,a_{\\mathrm{sk}} = 5.8 \\times 10^{-3}\\,$，标准不确定度 $\\,\\sigma_{a} = 0.3 \\times 10^{-3}\\,$.\n- 拟合的侧跳系数 $\\,\\gamma_{\\mathrm{sj}} = 1.7 \\times 10^{-3}\\,(\\mu\\Omega\\cdot\\mathrm{cm})^{-1}\\,$，标准不确定度 $\\,\\sigma_{\\gamma} = 0.2 \\times 10^{-3}\\,(\\mu\\Omega\\cdot\\mathrm{cm})^{-1}\\,$.\n\n对自旋霍尔角与电阻率依赖关系的联合拟合，得出 $a_{\\mathrm{sk}}$ 和 $\\gamma_{\\mathrm{sj}}$ 估计值之间的相关系数为 $\\,r = -0.35\\,$. 剩余电阻率的测量与拟合无关，因此可以认为它与 $a_{\\mathrm{sk}}$ 和 $\\gamma_{\\mathrm{sj}}$ 不相关。\n\n仅使用上述定义以及关于斜散射和侧跳的成熟标度关系，推导在 $\\,\\rho_{0}\\,$ 处的总外源自旋霍尔角表达式，并通过合并斜散射和侧跳的贡献来估计其值。将不确定度传播到小参数变化的一阶（线性近似），明确地包含由 $r$ 决定的 $a_{\\mathrm{sk}}$ 和 $\\gamma_{\\mathrm{sj}}$ 之间的协方差，并将 $\\rho_{0}$ 视为与两个拟合参数无关。\n\n将结果以一个双分量的行矩阵形式报告，其中包含：\n- 在 $\\,\\rho_{0}\\,$ 处的总外源自旋霍尔角的中心估计值，以及\n- 其单标准差不确定度。\n\n将每个分量四舍五入至四位有效数字。自旋霍尔角是无量纲的；将两个分量均表示为纯数（无单位）。", "solution": "首先验证问题，确保其科学上合理、表述清晰且客观。\n\n### 步骤 1：提取已知条件\n问题提供了以下信息：\n- 总外源自旋霍尔角 $\\theta_{\\mathrm{SH}}$ 是斜散射贡献 $a_{\\mathrm{sk}}$ 和侧跳贡献 $\\gamma_{\\mathrm{sj}}\\rho_0$ 的和。\n- 剩余电阻率：$\\rho_{0} = 8.3\\,\\mu\\Omega\\cdot\\mathrm{cm}$\n- 电阻率的标准不确定度：$\\sigma_{\\rho} = 0.2\\,\\mu\\Omega\\cdot\\mathrm{cm}$\n- 斜散射系数：$a_{\\mathrm{sk}} = 5.8 \\times 10^{-3}$\n- 斜散射系数的标准不确定度：$\\sigma_{a} = 0.3 \\times 10^{-3}$\n- 侧跳系数：$\\gamma_{\\mathrm{sj}} = 1.7 \\times 10^{-3}\\,(\\mu\\Omega\\cdot\\mathrm{cm})^{-1}$\n- 侧跳系数的标准不确定度：$\\sigma_{\\gamma} = 0.2 \\times 10^{-3}\\,(\\mu\\Omega\\cdot\\mathrm{cm})^{-1}$\n- $a_{\\mathrm{sk}}$ 和 $\\gamma_{\\mathrm{sj}}$ 之间的相关系数：$r = -0.35$\n- $\\rho_{0}$ 的测量与 $a_{\\mathrm{sk}}$ 和 $\\gamma_{\\mathrm{sj}}$ 的拟合无关。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于凝聚态物理学中关于外源自旋霍尔效应的既有唯象模型，其中自旋霍尔角被建模为电阻率的线性函数 $\\theta_{\\mathrm{SH}}(\\rho) = a_{\\mathrm{sk}} + \\gamma_{\\mathrm{sj}}\\rho$。分量 $a_{\\mathrm{sk}}$（斜散射）和 $\\gamma_{\\mathrm{sj}}\\rho$（侧跳）是标准的教科书概念。所提供的数值对于金属体系是物理上现实的。该问题在科学上是合理的。\n- **表述清晰**：该问题提供了一个清晰的模型、一套完整的输入参数及其不确定度（包括协方差），并要求一个特定的输出（$\\theta_{\\mathrm{SH}}$ 的值和不确定度）。任务是将一种标准的统计方法（一阶不确定度传播）应用于给定的模型和数据。可以确定一个唯一、稳定且有意义的解。\n- **客观性**：该问题以精确、定量且无偏见的语言陈述。\n\n### 步骤 3：结论与行动\n问题有效。将提供一个合理的解。\n\n### 解题推导\n\n在剩余电阻率 $\\rho_0$ 处的总外源自旋霍尔角 $\\theta_{\\mathrm{SH}}$ 由斜散射和侧跳贡献之和给出。模型为：\n$$ \\theta_{\\mathrm{SH}}(a_{\\mathrm{sk}}, \\gamma_{\\mathrm{sj}}, \\rho_0) = a_{\\mathrm{sk}} + \\gamma_{\\mathrm{sj}} \\rho_0 $$\n其中 $a_{\\mathrm{sk}}$ 是斜散射系数，$\\gamma_{\\mathrm{sj}}$ 是侧跳系数。\n\n首先，我们使用给定的参数中心值计算 $\\theta_{\\mathrm{SH}}$ 的中心估计值：\n$$ \\theta_{\\mathrm{SH}} = (5.8 \\times 10^{-3}) + (1.7 \\times 10^{-3}\\,(\\mu\\Omega\\cdot\\mathrm{cm})^{-1}) \\times (8.3\\,\\mu\\Omega\\cdot\\mathrm{cm}) $$\n$$ \\theta_{\\mathrm{SH}} = 5.8 \\times 10^{-3} + 14.11 \\times 10^{-3} $$\n$$ \\theta_{\\mathrm{SH}} = 19.91 \\times 10^{-3} = 0.01991 $$\n四舍五入到四位有效数字，中心估计值为 $0.01991$。\n\n接下来，我们传播不确定度以求出 $\\theta_{\\mathrm{SH}}$ 的不确定度，记为 $\\sigma_{\\theta}$。对于函数 $f(x_1, x_2, \\dots, x_n)$，其方差 $\\sigma_f^2$ 在一阶近似下的一般公式为：\n$$ \\sigma_f^2 = \\sum_{i=1}^{n} \\left(\\frac{\\partial f}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2 + \\sum_{i \\neq j} \\left(\\frac{\\partial f}{\\partial x_i}\\right) \\left(\\frac{\\partial f}{\\partial x_j}\\right) \\text{Cov}(x_i, x_j) $$\n在我们的情况下，函数是 $\\theta_{\\mathrm{SH}}(a_{\\mathrm{sk}}, \\gamma_{\\mathrm{sj}}, \\rho_0)$。变量为 $x_1 = a_{\\mathrm{sk}}$，$x_2 = \\gamma_{\\mathrm{sj}}$ 和 $x_3 = \\rho_0$。偏导数为：\n$$ \\frac{\\partial \\theta_{\\mathrm{SH}}}{\\partial a_{\\mathrm{sk}}} = 1 $$\n$$ \\frac{\\partial \\theta_{\\mathrm{SH}}}{\\partial \\gamma_{\\mathrm{sj}}} = \\rho_0 $$\n$$ \\frac{\\partial \\theta_{\\mathrm{SH}}}{\\partial \\rho_0} = \\gamma_{\\mathrm{sj}} $$\n问题指出 $\\rho_0$ 与 $a_{\\mathrm{sk}}$ 和 $\\gamma_{\\mathrm{sj}}$ 不相关。因此，$\\text{Cov}(a_{\\mathrm{sk}}, \\rho_0) = 0$ 且 $\\text{Cov}(\\gamma_{\\mathrm{sj}}, \\rho_0) = 0$。$a_{\\mathrm{sk}}$ 和 $\\gamma_{\\mathrm{sj}}$ 之间的协方差由 $\\text{Cov}(a_{\\mathrm{sk}}, \\gamma_{\\mathrm{sj}}) = r \\sigma_a \\sigma_\\gamma$ 给出，其中 $r$ 是相关系数，$\\sigma_a$ 和 $\\sigma_\\gamma$ 分别是各自的标准不确定度。\n\n将这些代入方差公式，我们得到：\n$$ \\sigma_{\\theta}^2 = \\left(\\frac{\\partial \\theta_{\\mathrm{SH}}}{\\partial a_{\\mathrm{sk}}}\\right)^2 \\sigma_a^2 + \\left(\\frac{\\partial \\theta_{\\mathrm{SH}}}{\\partial \\gamma_{\\mathrm{sj}}}\\right)^2 \\sigma_\\gamma^2 + \\left(\\frac{\\partial \\theta_{\\mathrm{SH}}}{\\partial \\rho_0}\\right)^2 \\sigma_\\rho^2 + 2 \\left(\\frac{\\partial \\theta_{\\mathrm{SH}}}{\\partial a_{\\mathrm{sk}}}\\right) \\left(\\frac{\\partial \\theta_{\\mathrm{SH}}}{\\partial \\gamma_{\\mathrm{sj}}}\\right) \\text{Cov}(a_{\\mathrm{sk}}, \\gamma_{\\mathrm{sj}}) $$\n$$ \\sigma_{\\theta}^2 = (1)^2 \\sigma_a^2 + (\\rho_0)^2 \\sigma_\\gamma^2 + (\\gamma_{\\mathrm{sj}})^2 \\sigma_\\rho^2 + 2(1)(\\rho_0)(r \\sigma_a \\sigma_\\gamma) $$\n现在，我们代入数值：\n- $\\sigma_a = 0.3 \\times 10^{-3}$\n- $\\sigma_\\gamma = 0.2 \\times 10^{-3}\\,(\\mu\\Omega\\cdot\\mathrm{cm})^{-1}$\n- $\\sigma_\\rho = 0.2\\,\\mu\\Omega\\cdot\\mathrm{cm}$\n- $\\rho_0 = 8.3\\,\\mu\\Omega\\cdot\\mathrm{cm}$\n- $\\gamma_{\\mathrm{sj}} = 1.7 \\times 10^{-3}\\,(\\mu\\Omega\\cdot\\mathrm{cm})^{-1}$\n- $r = -0.35$\n\n让我们计算方差 $\\sigma_{\\theta}^2$ 的每一项：\n1.  来自 $\\sigma_a^2$ 的项：\n    $$ \\sigma_a^2 = (0.3 \\times 10^{-3})^2 = 0.09 \\times 10^{-6} $$\n2.  来自 $\\sigma_\\gamma^2$ 的项：\n    $$ \\rho_0^2 \\sigma_\\gamma^2 = (8.3)^2 \\times (0.2 \\times 10^{-3})^2 = 68.89 \\times 0.04 \\times 10^{-6} = 2.7556 \\times 10^{-6} $$\n3.  来自 $\\sigma_\\rho^2$ 的项：\n    $$ \\gamma_{\\mathrm{sj}}^2 \\sigma_\\rho^2 = (1.7 \\times 10^{-3})^2 \\times (0.2)^2 = 2.89 \\times 10^{-6} \\times 0.04 = 0.1156 \\times 10^{-6} $$\n4.  协方差项：\n    $$ 2 \\rho_0 r \\sigma_a \\sigma_\\gamma = 2 \\times (8.3) \\times (-0.35) \\times (0.3 \\times 10^{-3}) \\times (0.2 \\times 10^{-3}) $$\n    $$ = 2 \\times 8.3 \\times (-0.35) \\times (0.06 \\times 10^{-6}) = -5.81 \\times 0.06 \\times 10^{-6} = -0.3486 \\times 10^{-6} $$\n\n将这些项相加得到总方差：\n$$ \\sigma_{\\theta}^2 = (0.09 + 2.7556 + 0.1156 - 0.3486) \\times 10^{-6} $$\n$$ \\sigma_{\\theta}^2 = (2.9612 - 0.3486) \\times 10^{-6} = 2.6126 \\times 10^{-6} $$\n\n标准不确定度 $\\sigma_{\\theta}$ 是方差的平方根：\n$$ \\sigma_{\\theta} = \\sqrt{2.6126 \\times 10^{-6}} = \\sqrt{2.6126} \\times 10^{-3} \\approx 1.616354 \\times 10^{-3} $$\n$$ \\sigma_{\\theta} \\approx 0.001616354 $$\n四舍五入到四位有效数字，不确定度为 $0.001616$。\n\n结果以一个包含中心估计值及其不确定度的双分量行矩阵形式报告。\n- 中心估计值：$0.01991$\n- 不确定度：$0.001616$", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.01991 & 0.001616 \\end{pmatrix}}\n$$", "id": "3020544"}, {"introduction": "在自旋电子学器件中，测量的物理量往往受到样品尺寸和界面效应的影响。本练习探讨了在一个典型的非磁性/铁磁性双层膜结构中，自旋扩散如何影响测得的有效自旋霍尔角。通过从自旋扩散方程出发推导厚度依赖关系，并将其拟合到给定的数据，你将能提取出关键的材料参数——自旋扩散长度 $\\lambda_s$ `[@problem_id:3020529]`。", "problem": "一层厚度为 $t$、电导率为 $\\sigma$ 的非磁性金属 (NM) 薄膜，在 $z=0$ 处与一个能完全吸收自旋积累（即界面自旋积累为零）的铁磁体 (FM) 接触，并在 $z=t$ 处有一个真空顶表面，没有自旋流可以流过该表面。一个均匀的面内电场 $E_x$ 在NM中驱动产生电荷电流密度 $j_c=\\sigma E_x$。由于自旋霍尔效应（SHE），该电荷电流产生一个均匀的体自旋霍尔源，对应于一个沿 $z$ 方向、自旋极化沿 $y$ 方向的自旋流，记作 $j_{s}^{\\mathrm{SH}}=\\theta_{\\mathrm{SH}} j_c$，其中 $\\theta_{\\mathrm{SH}}$ 是内禀自旋霍尔角。NM中的稳态自旋积累 $\\mu_s(z)$ 遵循一维自旋扩散，其自旋扩散长度为 $\\lambda_s$。\n\n从一维稳态自旋扩散方程以及自旋流与自旋积累梯度之间的本构关系出发，推导有限的自旋扩散长度 $\\lambda_s$ 和厚度 $t$ 如何修正测得的（等效）自旋霍尔角。将测得的等效自旋霍尔角定义为 $\\theta_{\\mathrm{eff}}(t)\\equiv j_s(0)/j_c$，其中 $j_s(0)$ 是在 $z=0$ 处注入到FM中的净自旋电流密度。\n\n现提供一个NM/FM双层结构的以下实验数据，其中在不同厚度 $t$ 下测得的等效自旋霍尔角为：\n- $t=2.0\\,\\mathrm{nm}$，$\\theta_{\\mathrm{eff}}(t)=0.0600$，\n- $t=4.0\\,\\mathrm{nm}$，$\\theta_{\\mathrm{eff}}(t)=0.146$，\n- $t=8.0\\,\\mathrm{nm}$，$\\theta_{\\mathrm{eff}}(t)=0.220$，\n- $t=30.0\\,\\mathrm{nm}$，$\\theta_{\\mathrm{eff}}(t)=0.240$。\n\n假设 $t=30.0\\,\\mathrm{nm}$ 的样品足够厚，可以代表渐近（体）极限，因此 $\\theta_{\\mathrm{SH}}=\\theta_{\\mathrm{eff}}(30.0\\,\\mathrm{nm})$。利用您推导出的厚度依赖关系，确定自旋扩散长度 $\\lambda_s$。将您的最终结果以纳米为单位表示，并四舍五入到三位有效数字。", "solution": "用户希望我解决一个凝聚态物理问题。\n\n### 步骤 1：提取已知条件\n- 一层厚度为 $t$、电导率为 $\\sigma$ 的非磁性金属 (NM) 薄膜。\n- NM 在 $z=0$ 处与一个能完全吸收自旋积累的铁磁体 (FM) 接触，这意味着自旋积累 $\\mu_s$ 的边界条件是 $\\mu_s(0)=0$。\n- NM 在 $z=t$ 处有一个真空顶表面，没有自旋流可以流过。这意味着净自旋流 $j_s(t)=0$。\n- 一个均匀的面内电场 $E_x$ 驱动产生电荷电流密度 $j_c=\\sigma E_x$。\n- 自旋霍尔效应 (SHE) 产生一个均匀的、沿 z 方向的体自旋流 $j_{s}^{\\mathrm{SH}}=\\theta_{\\mathrm{SH}} j_c$，其中 $\\theta_{\\mathrm{SH}}$ 是内禀自旋霍尔角。\n- NM 中的稳态自旋积累 $\\mu_s(z)$ 遵循一维自旋扩散，其自旋扩散长度为 $\\lambda_s$。\n- 问题涉及一维稳态自旋扩散方程以及自旋流和自旋积累梯度之间的本构关系。\n- 测得的等效自旋霍尔角定义为 $\\theta_{\\mathrm{eff}}(t) \\equiv j_s(0)/j_c$，其中 $j_s(0)$ 是在 $z=0$ 处注入到 FM 中的净自旋电流密度。\n- 实验数据：\n  - 对于 $t=2.0\\,\\mathrm{nm}$，$\\theta_{\\mathrm{eff}}(t)=0.0600$。\n  - 对于 $t=4.0\\,\\mathrm{nm}$，$\\theta_{\\mathrm{eff}}(t)=0.146$。\n  - 对于 $t=8.0\\,\\mathrm{nm}$，$\\theta_{\\mathrm{eff}}(t)=0.220$。\n  - 对于 $t=30.0\\,\\mathrm{nm}$，$\\theta_{\\mathrm{eff}}(t)=0.240$。\n- 假设：$t=30.0\\,\\mathrm{nm}$ 的样品足够厚，可以代表渐近（体）极限，即 $\\theta_{\\mathrm{SH}}=\\theta_{\\mathrm{eff}}(30.0\\,\\mathrm{nm})$。\n- 目标是确定自旋扩散长度 $\\lambda_s$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题基于非磁性/铁磁性异质结构中自旋输运的成熟模型，涉及自旋霍尔效应和自旋扩散。这些是自旋电子学和凝聚态物理学的核心概念。所描述的装置是一种标准的实验配置。\n- **适定性：** 该问题提供了一个二阶常微分方程和两个边界条件，这为自旋积累分布定义了唯一解。后续使用推导出的模型将参数与实验数据进行拟合的任务是一个标准的、适定的过程。\n- **客观性：** 问题陈述是定量的，使用了精确定义的术语和标准的物理模型。不存在主观或基于观点的论断。\n- 问题是自洽且内部一致的。\n\n### 步骤 3：结论和行动\n问题是有效的。将提供完整的解答。\n\n### 等效自旋霍尔角的推导\n非磁性金属中自旋积累 $\\mu_s(z)$ 的空间分布由一维稳态自旋扩散方程决定：\n$$ \\frac{d^2\\mu_s(z)}{dz^2} - \\frac{\\mu_s(z)}{\\lambda_s^2} = 0 $$\n这个齐次二阶线性常微分方程的通解是：\n$$ \\mu_s(z) = A \\cosh\\left(\\frac{z}{\\lambda_s}\\right) + B \\sinh\\left(\\frac{z}{\\lambda_s}\\right) $$\n其中 $A$ 和 $B$ 是待由边界条件确定的常数。\n\n边界条件是：\n1.  在 NM/FM 界面（$z=0$）处，铁磁体作为理想的自旋吸收体，因此自旋积累为零：$\\mu_s(0) = 0$。\n2.  在 NM/真空 界面（$z=t$）处，没有自旋流可以流出：$j_s(t) = 0$。\n\n应用第一个边界条件 $\\mu_s(0) = 0$：\n$$ \\mu_s(0) = A \\cosh(0) + B \\sinh(0) = A \\cdot 1 + B \\cdot 0 = A = 0 $$\n因此自旋积累的分布简化为：\n$$ \\mu_s(z) = B \\sinh\\left(\\frac{z}{\\lambda_s}\\right) $$\n\n总自旋电流密度 $j_s(z)$ 是自旋霍尔电流 $j_s^{\\mathrm{SH}}$ 和扩散自旋流 $j_s^{\\mathrm{diff}}(z)$ 的和：\n$$ j_s(z) = j_s^{\\mathrm{SH}} + j_s^{\\mathrm{diff}}(z) $$\n自旋霍尔电流为 $j_s^{\\mathrm{SH}} = \\theta_{\\mathrm{SH}}j_c$。扩散电流由自旋积累的梯度驱动。这个本构关系是菲克定律的一种形式，即 $j_s^{\\mathrm{diff}}(z) = -C \\frac{d\\mu_s(z)}{dz}$，其中 $C$ 是一个与材料电导率相关的正常数。$C$ 的确切形式是不需要的，因为它最终会被消掉。\n\n首先，我们计算 $\\mu_s(z)$ 的梯度：\n$$ \\frac{d\\mu_s(z)}{dz} = \\frac{B}{\\lambda_s} \\cosh\\left(\\frac{z}{\\lambda_s}\\right) $$\n因此，总自旋流为：\n$$ j_s(z) = \\theta_{\\mathrm{SH}}j_c - \\frac{CB}{\\lambda_s} \\cosh\\left(\\frac{z}{\\lambda_s}\\right) $$\n现在，我们应用第二个边界条件 $j_s(t) = 0$：\n$$ j_s(t) = \\theta_{\\mathrm{SH}}j_c - \\frac{CB}{\\lambda_s} \\cosh\\left(\\frac{t}{\\lambda_s}\\right) = 0 $$\n我们可以解出常数 $B$：\n$$ B = \\frac{\\theta_{\\mathrm{SH}}j_c \\lambda_s}{C \\cosh(t/\\lambda_s)} $$\n问题要求的是等效自旋霍尔角，它由在 $z=0$ 处注入到 FM 中的自旋流定义：$\\theta_{\\mathrm{eff}}(t) = j_s(0)/j_c$。让我们计算 $j_s(0)$：\n$$ j_s(0) = \\theta_{\\mathrm{SH}}j_c - \\frac{CB}{\\lambda_s} \\cosh\\left(\\frac{0}{\\lambda_s}\\right) = \\theta_{\\mathrm{SH}}j_c - \\frac{CB}{\\lambda_s} $$\n代入 $B$ 的表达式：\n$$ j_s(0) = \\theta_{\\mathrm{SH}}j_c - \\frac{C}{\\lambda_s} \\left( \\frac{\\theta_{\\mathrm{SH}}j_c \\lambda_s}{C \\cosh(t/\\lambda_s)} \\right) = \\theta_{\\mathrm{SH}}j_c - \\frac{\\theta_{\\mathrm{SH}}j_c}{\\cosh(t/\\lambda_s)} $$\n$$ j_s(0) = \\theta_{\\mathrm{SH}}j_c \\left( 1 - \\frac{1}{\\cosh(t/\\lambda_s)} \\right) = \\theta_{\\mathrm{SH}}j_c \\left( 1 - \\operatorname{sech}\\left(\\frac{t}{\\lambda_s}\\right) \\right) $$\n两边除以 $j_c$，我们得到等效自旋霍尔角的期望表达式：\n$$ \\theta_{\\mathrm{eff}}(t) = \\theta_{\\mathrm{SH}}\\left( 1 - \\operatorname{sech}\\left(\\frac{t}{\\lambda_s}\\right) \\right) $$\n\n### 自旋扩散长度的确定\n根据题意，厚度为 $t=30.0\\,\\mathrm{nm}$ 的样品足够厚，处于渐近极限（$t \\gg \\lambda_s$）。在此极限下，$\\cosh(t/\\lambda_s) \\to \\infty$，因此 $\\operatorname{sech}(t/\\lambda_s) \\to 0$。该公式给出 $\\theta_{\\mathrm{eff}}(t \\to \\infty) = \\theta_{\\mathrm{SH}}$。因此，我们可以使用最厚样品的测量值来确定内禀自旋霍尔角：\n$$ \\theta_{\\mathrm{SH}} = \\theta_{\\mathrm{eff}}(30.0\\,\\mathrm{nm}) = 0.240 $$\n现在我们可以利用这个值和其他数据点来求解 $\\lambda_s$。我们重排推导出的方程来解出 $\\lambda_s$：\n$$ \\frac{\\theta_{\\mathrm{eff}}(t)}{\\theta_{\\mathrm{SH}}} = 1 - \\operatorname{sech}\\left(\\frac{t}{\\lambda_s}\\right) $$\n$$ \\operatorname{sech}\\left(\\frac{t}{\\lambda_s}\\right) = 1 - \\frac{\\theta_{\\mathrm{eff}}(t)}{\\theta_{\\mathrm{SH}}} = \\frac{\\theta_{\\mathrm{SH}} - \\theta_{\\mathrm{eff}}(t)}{\\theta_{\\mathrm{SH}}} $$\n$$ \\cosh\\left(\\frac{t}{\\lambda_s}\\right) = \\frac{\\theta_{\\mathrm{SH}}}{\\theta_{\\mathrm{SH}} - \\theta_{\\mathrm{eff}}(t)} $$\n$$ \\frac{t}{\\lambda_s} = \\arccosh\\left(\\frac{\\theta_{\\mathrm{SH}}}{\\theta_{\\mathrm{SH}} - \\theta_{\\mathrm{eff}}(t)}\\right) $$\n$$ \\lambda_s = \\frac{t}{\\arccosh\\left(\\frac{\\theta_{\\mathrm{SH}}}{\\theta_{\\mathrm{SH}} - \\theta_{\\mathrm{eff}}(t)}\\right)} $$\n我们现在为剩下的三个数据点分别计算 $\\lambda_s$：\n\n1.  对于 $t_1 = 2.0\\,\\mathrm{nm}$ 和 $\\theta_{\\mathrm{eff}}(t_1) = 0.0600$：\n    $$ \\lambda_{s,1} = \\frac{2.0}{\\arccosh\\left(\\frac{0.240}{0.240 - 0.0600}\\right)} = \\frac{2.0}{\\arccosh\\left(\\frac{0.240}{0.180}\\right)} = \\frac{2.0}{\\arccosh(4/3)} \\approx \\frac{2.0}{0.795365} \\approx 2.5145\\,\\mathrm{nm} $$\n\n2.  对于 $t_2 = 4.0\\,\\mathrm{nm}$ 和 $\\theta_{\\mathrm{eff}}(t_2) = 0.146$：\n    $$ \\lambda_{s,2} = \\frac{4.0}{\\arccosh\\left(\\frac{0.240}{0.240 - 0.146}\\right)} = \\frac{4.0}{\\arccosh\\left(\\frac{0.240}{0.094}\\right)} = \\frac{4.0}{\\arccosh(120/47)} \\approx \\frac{4.0}{1.58966} \\approx 2.5163\\,\\mathrm{nm} $$\n\n3.  对于 $t_3 = 8.0\\,\\mathrm{nm}$ 和 $\\theta_{\\mathrm{eff}}(t_3) = 0.220$：\n    $$ \\lambda_{s,3} = \\frac{8.0}{\\arccosh\\left(\\frac{0.240}{0.240 - 0.220}\\right)} = \\frac{8.0}{\\arccosh\\left(\\frac{0.240}{0.020}\\right)} = \\frac{8.0}{\\arccosh(12)} \\approx \\frac{8.0}{3.17628} \\approx 2.5186\\,\\mathrm{nm} $$\n\n从三个数据点计算出的值高度一致。为了获得 $\\lambda_s$ 的单个最佳估计值，我们取这三个值的平均值：\n$$ \\lambda_s = \\frac{\\lambda_{s,1} + \\lambda_{s,2} + \\lambda_{s,3}}{3} = \\frac{2.5145 + 2.5163 + 2.5186}{3} \\approx 2.5165\\,\\mathrm{nm} $$\n按照要求，将结果四舍五入到三位有效数字：\n$$ \\lambda_s \\approx 2.52\\,\\mathrm{nm} $$", "answer": "$$\\boxed{2.52}$$", "id": "3020529"}, {"introduction": "内禀自旋霍尔电导率的理论根源在于能带结构的拓扑性质，具体表现为“自旋贝里曲率”。这个计算练习将抽象的理论具象化，指导你如何为一个具有Rashba自旋轨道耦合的二维紧束缚模型，通过Kubo公式进行数值计算。通过亲手实现这个算法，你不仅能深刻理解内禀自旋霍尔效应的来源，还能掌握评估计算收敛性等计算物理中的实用技能 `[@problem_id:2860271]`。", "problem": "你的任务是为一个二维反演非对称紧束缚模型，使用Wannier插值策略，实现内禀自旋霍尔电导率（记作 $\\sigma_{sH}$）的数值计算。目的是将线性响应理论中的基本定义与一个可执行的具体算法联系起来，并评估 $\\sigma_{sH}$ 关于布里渊区采样的收敛性。\n\n考虑一个单轨道正方晶格，其晶格常数设为 $a=1$，并采用周期性边界条件。在动量空间中，布洛赫哈密顿量是自旋空间中的一个 $2 \\times 2$ 矩阵，包含由反演非对称性引起的自旋轨道耦合（Rashba形式）：\n$$\nH(\\mathbf{k}) = \\varepsilon(\\mathbf{k}) \\,\\sigma_0 + \\alpha \\left( \\sin k_y \\,\\sigma_x - \\sin k_x \\,\\sigma_y \\right),\n$$\n其中 $\\mathbf{k} = (k_x,k_y)$，$\\varepsilon(\\mathbf{k}) = -2t \\left( \\cos k_x + \\cos k_y \\right)$，$\\sigma_0$ 是 $2 \\times 2$ 的单位矩阵，$\\sigma_{x,y,z}$ 是作用在自旋空间中的泡利矩阵，$t>0$ 是最近邻跃迁强度，$\\alpha$ 是Rashba自旋轨道耦合强度。角度以弧度为单位，布里渊区为 $k_x,k_y \\in [-\\pi,\\pi)$。\n\n使用以下基本定义和事实作为你的出发点：\n- Kubo线性响应理论将 $\\sigma_{sH}$ 与晶体的平衡性质及其本征态联系起来。\n- 速度算符定义为 $v_\\mu(\\mathbf{k}) = \\partial H(\\mathbf{k})/\\partial k_\\mu$，其中 $\\mu \\in \\{x,y\\}$。\n- 自旋算符为 $s_z = \\frac{1}{2}\\sigma_z$。沿 $x$ 方向、自旋极化沿 $z$ 方向的自旋流是对称化乘积 $j_x^{(s)}(\\mathbf{k}) = \\frac{1}{2}\\{s_z, v_x(\\mathbf{k})\\}$。\n- 在此背景下，Wannier插值意味着在局域（紧束缚/Wannier）基矢中工作，从实空间跃迁振幅解析地获得 $H(\\mathbf{k})$ 及其导数，而不是通过在 $\\mathbf{k}$ 空间中进行有限差分。\n\n基于这些基础，推导一个适用于在布里渊区上进行数值积分的可实现公式，以计算在零温和指定费米能 $E_F$ 下的内禀自旋霍尔电导率。使用 $\\hbar = 1$ 和 $e = 1$ 的约定，因此你计算的数值是 $\\sigma_{sH}$ 以 $e/\\hbar$ 为单位表示的值。在此约定中，布里渊区平均取代了因子 $(2\\pi)^{-2}\\int_{\\text{BZ}} d^2k$，因此布里渊区上的积分通过在一个 $N_k \\times N_k$ 的 $\\mathbf{k}$ 点网格上的均匀平均来近似。\n\n你的程序必须：\n1. 实现上述模型，并从紧束缚形式解析地构造 $H(\\mathbf{k})$、$v_x(\\mathbf{k})$、$v_y(\\mathbf{k})$ 和 $j_x^{(s)}(\\mathbf{k})$（这是Wannier插值步骤）。\n2. 使用零温费米占据，并给定费米能 $E_F$。\n3. 通过在布里渊区上积分来评估 $\\sigma_{sH}$，使用一个沿每个方向有 $N_k$ 个点的均匀Monkhorst–Pack式网格 $k_x,k_y \\in [-\\pi,\\pi)$。角度以弧度为单位。\n4. 将最终结果以 $e/\\hbar$ 为单位表示为一个纯数。\n\n测试套件和要求输出：\n- 使用以下五组参数集 $(t,\\alpha,E_F,N_k)$：\n    1. $(1.0,\\,0.35,\\,-3.20,\\,25)$\n    2. $(1.0,\\,0.35,\\,-3.20,\\,51)$\n    3. $(1.0,\\,0.35,\\,-3.20,\\,101)$\n    4. $(1.0,\\,0.00,\\,0.00,\\,31)$\n    5. $(1.0,\\,0.60,\\,0.00,\\,81)$\n- 对每种情况，计算以 $e/\\hbar$ 为单位的 $\\sigma_{sH}$，并将结果四舍五入到六位小数。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的、由逗号分隔的五个结果的列表（例如，“[r1,r2,r3,r4,r5]”），其中每个 $r_i$ 是对应测试用例的四舍五入后的浮点值。\n\n科学真实性和适用性说明：\n- 所选的哈密顿量是一个最小的反演非对称紧束缚模型，它在纯净极限下支持有限的内禀自旋霍尔响应。\n- 通过使用从实空间跃迁推导出的紧束缚哈密顿量相对于 $\\mathbf{k}$ 的解析导数，满足了Wannier插值的要求。\n- 通过比较前三个输出来评估关于 $N_k$ 的收敛性；这些输出之间的稳定性表明了采样收敛。\n\n必须以弧度为单位处理所有角度。所有最终数值答案必须按规定以 $e/\\hbar$ 为单位报告，并四舍五入到六位小数。最终输出格式必须严格为包含五个结果的Python列表的单行。", "solution": "用户要求对一个指定的二维紧束缚模型进行内禀自旋霍尔电导率 $\\sigma_{sH}$ 的数值计算。根据我的指令，第一步是严格验证问题陈述。\n\n### 步骤 1：问题验证\n\n我从问题陈述中提取了以下给定信息：\n- **模型:** 一个在二维正方晶格上的单轨道紧束缚模型，晶格常数 $a=1$。\n- **哈密顿量:** $H(\\mathbf{k}) = \\varepsilon(\\mathbf{k}) \\,\\sigma_0 + \\alpha \\left( \\sin k_y \\,\\sigma_x - \\sin k_x \\,\\sigma_y \\right)$，其中 $\\varepsilon(\\mathbf{k}) = -2t \\left( \\cos k_x + \\cos k_y \\right)$。$\\sigma_{0,x,y,z}$ 是泡利矩阵。\n- **基本算符:** 速度算符 $v_\\mu(\\mathbf{k}) = \\partial H(\\mathbf{k})/\\partial k_\\mu$。自旋-$z$算符 $s_z = \\frac{1}{2}\\sigma_z$。自旋流 $j_x^{(s)}(\\mathbf{k}) = \\frac{1}{2}\\{s_z, v_x(\\mathbf{k})\\}$。\n- **物理常数:** $\\hbar=1$, $e=1$。\n- **任务:** 计算在零温 $T=0$ 和费米能 $E_F$ 下的内禀自旋霍尔电导率 $\\sigma_{sH}$。\n- **数值方法:** 用在 $k_x, k_y \\in [-\\pi, \\pi)$ 上的一个均匀 $N_k \\times N_k$ 网格上的求和来近似布里渊区（BZ）积分。\n- **测试用例:** 提供了五组参数 $(t, \\alpha, E_F, N_k)$ 用于测试。\n\n该问题具有科学依据，描述了晶格上的一个标准Rashba模型。使用Kubo形式主义进行线性响应的表述是凝聚态物理中正确且标准的方法。所有术语都定义明确，参数在物理上是合理的。问题是自洽且客观的。因此，该问题被视为 **有效**。我将继续进行解答。\n\n### 步骤 2：可计算公式的推导\n\n内禀自旋霍尔电导率 $\\sigma_{sH}$（更准确地说是 $\\sigma_{xy}^{s_z}$）是关联自旋流 $j_x^{(s)}$ 与横向电场 $E_y$ 的线性响应系数。在零温下，它可以使用Kubo公式计算，该公式可以表示为每个能带 $n$ 的自旋贝里曲率 $\\Omega_{n,xy}^{(s)}(\\mathbf{k})$ 的形式：\n$$\n\\sigma_{sH} = \\sum_{n} \\int_{\\text{BZ}} \\frac{d^2k}{(2\\pi)^2} f(E_{n\\mathbf{k}}) \\Omega_{n,xy}^{(s)}(\\mathbf{k})\n$$\n其中 $f(E_{n\\mathbf{k}})$ 是费米-狄拉克分布，在 $T=0$ 时为阶跃函数 $\\Theta(E_F - E_{n\\mathbf{k}})$。自旋贝里曲率由下式给出：\n$$\n\\Omega_{n,xy}^{(s)}(\\mathbf{k}) = -2 \\, \\text{Im} \\sum_{m \\neq n} \\frac{ \\langle u_{n\\mathbf{k}} | j_x^{(s)}(\\mathbf{k}) | u_{m\\mathbf{k}} \\rangle \\langle u_{m\\mathbf{k}} | v_y(\\mathbf{k}) | u_{n\\mathbf{k}} \\rangle }{(E_{n\\mathbf{k}} - E_{m\\mathbf{k}})^2}\n$$\n其中 $|u_{n\\mathbf{k}}\\rangle$ 和 $E_{n\\mathbf{k}}$ 分别是 $H(\\mathbf{k})$ 的本征矢量和本征值。问题指明要用离散网格上的归一化求和来代替布里渊区积分。\n\n首先，我们必须推导哈密顿量本征基中算符的解析形式。\n\n**1. 哈密顿量及其本征态/本征值：**\n哈密顿量为 $H(\\mathbf{k}) = \\varepsilon(\\mathbf{k})\\sigma_0 + \\mathbf{d}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma}$，其中 $\\mathbf{d}(\\mathbf{k}) = (\\alpha \\sin k_y, -\\alpha \\sin k_x, 0)$。\n本征值为 $E_{\\pm}(\\mathbf{k}) = \\varepsilon(\\mathbf{k}) \\pm |\\mathbf{d}(\\mathbf{k})|$。令 $n=1$ 表示低能带（$E_1 = E_-$），$n=2$ 表示高能带（$E_2 = E_+$）。\n$$\nE_{1,2}(\\mathbf{k}) = -2t(\\cos k_x + \\cos k_y) \\mp |\\alpha|\\sqrt{\\sin^2 k_x + \\sin^2 k_y}\n$$\n能量差为 $\\Delta E = E_2 - E_1 = 2|\\alpha|\\sqrt{\\sin^2 k_x + \\sin^2 k_y}$。\n相应的本征矢量 $|u_1\\rangle$ 和 $|u_2\\rangle$ 可以确定，但我们会发现直接计算矩阵元更为稳健。在每个 $\\mathbf{k}$ 点进行数值对角化是最实用的方法。\n\n**2. 速度和自旋流算符：**\n速度算符通过对 $H(\\mathbf{k})$ 进行解析微分得到：\n$$\nv_x(\\mathbf{k}) = \\frac{\\partial H}{\\partial k_x} = (2t \\sin k_x) \\sigma_0 - \\alpha \\cos k_x \\sigma_y = \\begin{pmatrix} 2t \\sin k_x & i\\alpha \\cos k_x \\\\ -i\\alpha \\cos k_x & 2t \\sin k_x \\end{pmatrix}\n$$\n$$\nv_y(\\mathbf{k}) = \\frac{\\partial H}{\\partial k_y} = (2t \\sin k_y) \\sigma_0 + \\alpha \\cos k_y \\sigma_x = \\begin{pmatrix} 2t \\sin k_y & \\alpha \\cos k_y \\\\ \\alpha \\cos k_y & 2t \\sin k_y \\end{pmatrix}\n$$\n自旋流算符为 $j_x^{(s)}(\\mathbf{k}) = \\frac{1}{2}\\{s_z, v_x(\\mathbf{k})\\} = \\frac{1}{4}\\{ \\sigma_z, v_x(\\mathbf{k}) \\}$。使用泡利矩阵的反对易关系 $\\{\\sigma_i, \\sigma_j\\} = 2\\delta_{ij}\\sigma_0$，我们知道 $\\{\\sigma_z, \\sigma_y\\} = 0$。\n$$\nj_x^{(s)}(\\mathbf{k}) = \\frac{1}{4} \\left( (2t \\sin k_x) \\{\\sigma_z, \\sigma_0\\} - \\alpha \\cos k_x \\{\\sigma_z, \\sigma_y\\} \\right) = \\frac{1}{4} (2t \\sin k_x) (2\\sigma_z) = (t \\sin k_x) \\sigma_z\n$$\n$$\nj_x^{(s)}(\\mathbf{k}) = \\begin{pmatrix} t \\sin k_x & 0 \\\\ 0 & -t \\sin k_x \\end{pmatrix}\n$$\n\n**3. 矩阵元和自旋贝里曲率：**\n对于我们的 $2 \\times 2$ 系统，$\\Omega_{n,xy}^{(s)}$ 的公式得以简化。对于低能带（$n=1$）：\n$$\n\\Omega_{1,xy}^{(s)}(\\mathbf{k}) = -2 \\, \\text{Im} \\frac{ \\langle u_1 | j_x^{(s)} | u_2 \\rangle \\langle u_2 | v_y | u_1 \\rangle }{(E_1 - E_2)^2}\n$$\n矩阵元必须在两个本征矢量 $|u_1\\rangle$ 和 $|u_2\\rangle$ 之间计算。虽然解析计算是可行的，但容易出现相位误差。一个更安全的方法是在每个 $\\mathbf{k}$ 点数值对角化 $H(\\mathbf{k})$ 以获得 $|u_{1,2}\\rangle$，然后计算矩阵元。\n我们将分子表示为 $M_{12} = \\langle u_1 | j_x^{(s)} | u_2 \\rangle \\langle u_2 | v_y | u_1 \\rangle$。两个能带的自旋贝里曲率通过 $\\Omega_{2,xy}^{(s)}(\\mathbf{k}) = -\\Omega_{1,xy}^{(s)}(\\mathbf{k})$ 相关联。\n\n**4. 电导率的最终表达式：**\n总自旋霍尔电导率是所有占据态贡献的总和。\n$$\n\\sigma_{sH} = \\frac{1}{N_k^2} \\sum_{\\mathbf{k}} \\left( \\Theta(E_F - E_{1\\mathbf{k}})\\Omega_{1,xy}^{(s)}(\\mathbf{k}) + \\Theta(E_F - E_{2\\mathbf{k}})\\Omega_{2,xy}^{(s)}(\\mathbf{k}) \\right)\n$$\n使用 $\\Omega_2 = -\\Omega_1$，上式变为：\n$$\n\\sigma_{sH} = \\frac{1}{N_k^2} \\sum_{\\mathbf{k}} \\left( \\Theta(E_F - E_{1\\mathbf{k}}) - \\Theta(E_F - E_{2\\mathbf{k}}) \\right) \\Omega_{1,xy}^{(s)}(\\mathbf{k})\n$$\n由于 $E_1 < E_2$，仅当费米能级 $E_F$ 位于两个能带之间（$E_1 < E_F < E_2$）时，项 $(\\Theta(E_F - E_1) - \\Theta(E_F - E_2))$ 才为1，否则为0。\n因此，用于数值实现的最终表达式为：\n$$\n\\sigma_{sH} = \\frac{1}{N_k^2} \\sum_{\\mathbf{k} \\text{ where } E_{1\\mathbf{k}} < E_F < E_{2\\mathbf{k}}} \\left( -2 \\, \\text{Im} \\frac{ \\langle u_{1\\mathbf{k}} | j_x^{(s)}(\\mathbf{k}) | u_{2\\mathbf{k}} \\rangle \\langle u_{2\\mathbf{k}} | v_y(\\mathbf{k}) | u_{1\\mathbf{k}} \\rangle }{(E_{1\\mathbf{k}} - E_{2\\mathbf{k}})^2} \\right)\n$$\n特殊情况：如果 $\\alpha=0$，能带是简并的，自旋轨道耦合机制消失。哈密顿量在自旋空间中是对角的，计算 $\\sigma_{sH}$ 所需的非对角矩阵元为零。因此，当 $\\alpha=0$ 时，$\\sigma_{sH}=0$。\n\n### 步骤 3：算法设计\nPython实现的算法如下：\n1.  对于每个测试用例 $(t, \\alpha, E_F, N_k)$：\n2.  如果 $\\alpha=0$，结果为 $0.0$。\n3.  否则，在 $[-\\pi, \\pi) \\times [-\\pi, \\pi)$ 中生成一个 $N_k \\times N_k$ 的Monkhorst-Pack网格的 $\\mathbf{k}$ 点。\n4.  初始化总电导率累加器为 $0$。\n5.  遍历网格上的每个 $\\mathbf{k}=(k_x, k_y)$ 点。\n    a. 构造 $2 \\times 2$ 的哈密顿矩阵 $H(\\mathbf{k})$。\n    b. 使用库函数（例如 `numpy.linalg.eigh`）对 $H(\\mathbf{k})$ 进行数值对角化，以获得本征值 $E_1, E_2$ 和本征矢量 $|u_1\\rangle, |u_2\\rangle$。\n    c. 如果能带隙 $(E_2 - E_1)$ 小于一个小的容差（以避免在简并点处除以零），则继续下一个 $\\mathbf{k}$ 点。\n    d. 构造 $j_x^{(s)}(\\mathbf{k})$ 和 $v_y(\\mathbf{k})$ 的矩阵。\n    e. 计算矩阵元 $j_{12} = \\langle u_1 | j_x^{(s)} | u_2 \\rangle$ 和 $v_{21} = \\langle u_2 | v_y | u_1 \\rangle$。\n    f. 计算它们乘积的虚部：$\\text{Im}(j_{12} \\cdot v_{21})$。\n    g. 计算低能带的自旋贝里曲率：$\\Omega_1 = -2 \\cdot \\text{Im}(j_{12} \\cdot v_{21}) / (E_1 - E_2)^2$。\n    h. 检查占据条件：如果 $E_1 < E_F$，则将 $\\Omega_1$ 加到累加器中。如果 $E_2 < E_F$，则减去 $\\Omega_1$（因为 $\\Omega_2 = -\\Omega_1$）。\n6.  将最终总和除以 $N_k^2$ 以获得平均值，即 $\\sigma_{sH}$。\n7.  将结果四舍五入到六位小数。\n8.  收集所有测试用例的结果并格式化最终的输出字符串。\n此过程提供了一个基于基本原理的直接且稳健的数值解。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the intrinsic spin Hall conductivity for a 2D Rashba\n    tight-binding model using Wannier interpolation (analytical operators)\n    and Kubo formalism.\n    \"\"\"\n\n    # Pauli matrices and identity\n    sigma0 = np.array([[1, 0], [0, 1]], dtype=complex)\n    sigma_x = np.array([[0, 1], [1, 0]], dtype=complex)\n    sigma_y = np.array([[0, -1j], [1j, 0]], dtype=complex)\n    sigma_z = np.array([[1, 0], [0, -1]], dtype=complex)\n\n    def calculate_sigma_sh(t, alpha, E_F, Nk):\n        \"\"\"\n        Calculates sigma_sH for a single set of parameters.\n        \"\"\"\n        # Case alpha=0: No spin-orbit coupling, so SHE is zero.\n        if alpha == 0:\n            return 0.0\n\n        # Create a uniform k-grid in the 1st Brillouin Zone: [-pi, pi)\n        k_coords = np.linspace(-np.pi, np.pi, Nk, endpoint=False)\n        kx_grid, ky_grid = np.meshgrid(k_coords, k_coords)\n\n        total_sigma_sh_sum = 0.0\n\n        for ikx in range(Nk):\n            for iky in range(Nk):\n                kx = kx_grid[ikx, iky]\n                ky = ky_grid[ikx, iky]\n\n                # 1. Construct Hamiltonian H(k)\n                epsilon_k = -2 * t * (np.cos(kx) + np.cos(ky))\n                H_k = epsilon_k * sigma0 + alpha * (np.sin(ky) * sigma_x - np.sin(kx) * sigma_y)\n\n                # 2. Diagonalize H(k) to get eigenvalues and eigenvectors\n                # eigh ensures real eigenvalues and orthonormal eigenvectors\n                energies, eigenstates = np.linalg.eigh(H_k)\n                E1, E2 = energies[0], energies[1]\n                \n                # Energy denominator\n                energy_gap = E2 - E1\n                if np.abs(energy_gap)  1e-9:  # Avoid division by zero at degeneracies\n                    continue\n\n                u1, u2 = eigenstates[:, 0], eigenstates[:, 1]\n\n                # 3. Construct operators v_y(k) and j_x^s(k)\n                vy_k = (2 * t * np.sin(ky)) * sigma0 + alpha * np.cos(ky) * sigma_x\n                jxs_k = (t * np.sin(kx)) * sigma_z\n                \n                # 4. Calculate matrix elements\n                # Numpy's vdot computes u_conj.T @ v\n                v_21 = np.vdot(u2, vy_k @ u1)\n                j_12 = np.vdot(u1, jxs_k @ u2)\n                \n                # 5. Calculate numerator of spin Berry curvature\n                numerator_im_part = np.imag(j_12 * v_21)\n\n                # 6. Calculate spin Berry curvature for the lower band (n=1)\n                Omega1 = -2 * numerator_im_part / (energy_gap**2)\n\n                # 7. Sum contributions based on Fermi level occupation\n                # sigma_sH = sum_k (f(E1)*Omega1 + f(E2)*Omega2)\n                # Since Omega2 = -Omega1, this is sum_k (f(E1)-f(E2))*Omega1\n                # At T=0, f(E) is a step function Theta(E_F - E).\n                contribution = 0.0\n                if E1  E_F:\n                    contribution += Omega1\n                if E2  E_F:\n                    contribution -= Omega1 # equivalent to adding Omega2\n\n                total_sigma_sh_sum += contribution\n\n        # Average over all k-points\n        sigma_sh = total_sigma_sh_sum / (Nk**2)\n        \n        return sigma_sh\n\n    # Test cases from the problem statement\n    test_cases = [\n        # (t,   alpha, E_F,   Nk)\n        (1.0, 0.35, -3.20, 25),\n        (1.0, 0.35, -3.20, 51),\n        (1.0, 0.35, -3.20, 101),\n        (1.0, 0.00, 0.00, 31),\n        (1.0, 0.60, 0.00, 81),\n    ]\n\n    results = []\n    for params in test_cases:\n        t, alpha, E_F, Nk = params\n        result = calculate_sigma_sh(t, alpha, E_F, Nk)\n        # Round to six decimal places as required\n        results.append(round(result, 6))\n\n    # Format and print the final output as a single-line list\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2860271"}]}