{"hands_on_practices": [{"introduction": "本节练习将为扭转双层石墨烯（TBG）建立几何基础。我们将从第一性原理出发，推导由扭转两层石墨烯所产生的莫尔超晶格的特性。理解真实空间中的莫尔图案与其倒易空间表象（即莫尔布里渊区）之间的关系，是构建任何扭转双层石墨烯物理模型的关键第一步 [@problem_id:3022794]。", "problem": "考虑扭转双层石墨烯 (Twisted Bilayer Graphene, TBG)，它由两片相同的石墨烯片层构成。这两片石墨烯具有相同的三角布拉维晶格，晶格常数为 $a$（即原胞实空间晶格矢量的模长），彼此之间相对旋转了一个扭转角 $\\theta$。该三角布拉维晶格的原胞实空间矢量模长为 $a$，相互夹角为 $60^{\\circ}$，因此其原胞实空间晶胞面积为 $A_{\\mathrm{g}} = (\\sqrt{3}/2)\\,a^{2}$。其倒易晶格也是三角晶格；倒易原胞矢量 $\\mathbf{b}_{1}$ 和 $\\mathbf{b}_{2}$ 满足关系 $ \\mathbf{a}_{i} \\cdot \\mathbf{b}_{j} = 2\\pi \\delta_{ij}$，倒易原胞的面积（等于第一布里渊区 (BZ) 的面积）为 $A_{\\mathrm{BZ}} = (4\\pi^{2})/A_{\\mathrm{real}}$。\n\n当两个层以角度 $\\theta$ 扭转时，两个倒易晶格的干涉会产生摩尔超晶格：基本的摩尔倒易矢量可以由一层的一个倒易原胞矢量与另一层相应的旋转后矢量之差来构造。这定义了一个摩尔三角倒易晶格以及一个相应的实空间摩尔三角晶格。请利用这些基本定义和几何关系，从第一性原理出发推导：\n\n1. 摩尔布里渊区 (BZ) 面积 $A_{\\mathrm{mBZ}}(\\theta)$ 关于 $\\theta$ 和 $a$ 的显式解析表达式。\n2. 一个摩尔原胞实空间晶胞内包含的石墨烯原胞数量 $N(\\theta)$ 的显式解析表达式。\n\n您的推导必须从上述摩尔倒易晶格的几何构造以及三角晶格的倒易空间/实空间关系出发。将 $\\theta$ 视为以弧度为单位的角度。请用 $a$ 表示 $A_{\\mathrm{mBZ}}(\\theta)$；如果 $a$ 的单位是米，则其物理单位是 $\\mathrm{m}^{-2}$。量 $N(\\theta)$ 是无量纲的。请以闭合形式表达式给出最终答案；不需要数值近似或四舍五入。", "solution": "问题要求我们为扭转双层石墨烯 (TBG) 推导两个量：摩尔布里渊区的面积 $A_{\\mathrm{mBZ}}(\\theta)$，以及一个摩尔晶胞中的石墨烯晶胞数量 $N(\\theta)$。\n我将基于第一性原理概述推导步骤。\n\n**步骤 1：石墨烯晶格与倒易晶格**\n*   单层石墨烯具有三角布拉维晶格。设晶格常数为 $a$，实空间原胞矢量可选为 $\\mathbf{a}_1 = a(1, 0)$ 和 $\\mathbf{a}_2 = a(1/2, \\sqrt{3}/2)$。实空间原胞的面积为 $A_g = |\\mathbf{a}_1 \\times \\mathbf{a}_2| = \\frac{\\sqrt{3}}{2}a^2$。\n*   倒易晶格原胞矢量 $\\mathbf{b}_j$ 由 $\\mathbf{a}_i \\cdot \\mathbf{b}_j = 2\\pi\\delta_{ij}$ 定义。一种标准的选择是 $\\mathbf{b}_1 = \\frac{2\\pi}{a}(1, -1/\\sqrt{3})$ 和 $\\mathbf{b}_2 = \\frac{2\\pi}{a}(0, 2/\\sqrt{3})$。这些矢量构成一个相对于实空间晶格旋转了 $30^\\circ$ 的三角晶格。\n*   两个不等价的狄拉克点（布里渊区的角点）位于 $K = \\frac{1}{3}(\\mathbf{b}_1 + 2\\mathbf{b}_2) = \\frac{2\\pi}{a}(\\frac{1}{3}, \\frac{1}{\\sqrt{3}})$ 和 $K' = \\frac{1}{3}(2\\mathbf{b}_1 + \\mathbf{b}_2) = \\frac{2\\pi}{a}(\\frac{2}{3}, 0)$。这些矢量的模长为 $|K| = |K'| = \\frac{4\\pi}{3a}$。\n*   第一布里渊区的面积为 $A_{BZ} = \\frac{8\\pi^2}{3\\sqrt{3}a^2}$。\n\n**步骤 2：摩尔晶格的构造**\n*   两个石墨烯层相对旋转一个角度 $\\theta$。我们可以固定第 1 层，并将第 2 层旋转 $\\theta$。\n*   第 2 层的倒易晶格也旋转了 $\\theta$。第 1 层的一个倒易原胞矢量是 $\\mathbf{b}_1$，第 2 层对应的矢量是 $\\mathbf{b}_1' = R(\\theta)\\mathbf{b}_1$，其中 $R(\\theta)$ 是旋转矩阵。\n*   基本的摩尔倒易矢量由两者之差给出：$\\mathbf{G}_{m,1} = \\mathbf{b}_1' - \\mathbf{b}_1$。其模长为 $|\\mathbf{G}_{m,1}| = |\\mathbf{b}_1' - \\mathbf{b}_1| = \\sqrt{(\\mathbf{b}_1' - \\mathbf{b}_1)\\cdot(\\mathbf{b}_1' - \\mathbf{b}_1)} = \\sqrt{|\\mathbf{b}_1'|^2 + |\\mathbf{b}_1|^2 - 2\\mathbf{b}_1'\\cdot\\mathbf{b}_1}$。\n*   因为旋转保持长度不变，所以 $|\\mathbf{b}_1'|=|\\mathbf{b}_1|$ 且 $\\mathbf{b}_1'\\cdot\\mathbf{b}_1 = |\\mathbf{b}_1|^2\\cos(\\theta)$。因此，$|\\mathbf{G}_{m,1}|^2 = 2|\\mathbf{b}_1|^2(1-\\cos\\theta) = 4|\\mathbf{b}_1|^2\\sin^2(\\theta/2)$。于是，$|\\mathbf{G}_{m,1}| = 2|\\mathbf{b}_1|\\sin(\\theta/2)$。\n*   同理，对于另一个原胞矢量，有 $|\\mathbf{G}_{m,2}| = 2|\\mathbf{b}_2|\\sin(\\theta/2)$。由于 $|\\mathbf{b}_1|=|\\mathbf{b}_2|$，摩尔倒易晶格也是一个三角晶格，其晶格常数为 $G_m = 2|\\mathbf{b}_1|\\sin(\\theta/2)$。\n\n**步骤 3：摩尔布里渊区的面积 $A_{\\mathrm{mBZ}}(\\theta)$**\n*   摩尔倒易晶格是一个三角晶格，相对于石墨烯的倒易晶格，其尺度缩放因子为 $2\\sin(\\theta/2)$。\n*   其原胞面积与缩放因子的平方成正比。$A_{\\mathrm{mBZ}} = A_{\\mathrm{BZ}} \\times (2\\sin(\\theta/2))^2$ 是不正确的。倒易晶格原胞的面积与晶格矢量长度的平方成正比。\n*   摩尔倒易原胞的面积为 $A_{\\mathrm{m-recip}} = |\\mathbf{G}_{m,1} \\times \\mathbf{G}_{m,2}|$。$\\mathbf{G}_{m,1}$ 和 $\\mathbf{G}_{m,2}$ 之间的夹角与 $\\mathbf{b}_1$ 和 $\\mathbf{b}_2$ 之间的夹角相同（取决于选择，可以是 $60^\\circ$ 或 $120^\\circ$，我们假设是 $120^\\circ$）。摩尔晶格相对于原始晶格发生了旋转，但其几何形状相同。所以 $A_{\\mathrm{m-recip}} = |\\mathbf{G}_{m,1}| |\\mathbf{G}_{m,2}| \\sin(120^\\circ) = (G_m)^2 \\frac{\\sqrt{3}}{2}$。\n*   等等，问题陈述中说*实空间*原胞矢量之间的夹角为 $60^{\\circ}$。这意味着倒易原胞矢量之间的夹角为 $120^{\\circ}$。所以我的假设是正确的。\n*   $|\\mathbf{b}_1|=|\\mathbf{b}_2|=b$。根据 $\\mathbf{a}_i \\cdot \\mathbf{b}_j = 2\\pi\\delta_{ij}$ 和几何关系，我们得到 $b = \\frac{4\\pi}{\\sqrt{3}a}$。所以 $G_m = 2 \\frac{4\\pi}{\\sqrt{3}a} \\sin(\\frac{\\theta}{2})$。并且 $A_{\\mathrm{m-recip}} = (G_m)^2 \\frac{\\sqrt{3}}{2} = \\left(2 \\frac{4\\pi}{\\sqrt{3}a} \\sin\\left(\\frac{\\theta}{2}\\right)\\right)^2 \\frac{\\sqrt{3}}{2} = 4 \\frac{16\\pi^2}{3a^2} \\sin^2\\left(\\frac{\\theta}{2}\\right) \\frac{\\sqrt{3}}{2} = \\frac{32\\sqrt{3}\\pi^2}{3a^2}\\sin^2\\left(\\frac{\\theta}{2}\\right)$。\n*   问题问的是 $A_{\\mathrm{mBZ}}(\\theta)$。问题陈述中说‘倒易原胞的面积（等于第一布里渊区 (BZ) 的面积）’。所以我应该使用这个面积。我们称之为 $A_{\\mathrm{mBZ}}(\\theta) = A_{\\mathrm{m-recip}}$。因此，$A_{\\mathrm{mBZ}}(\\theta) = \\frac{32\\sqrt{3}\\pi^2}{3a^2}\\sin^2(\\frac{\\theta}{2})$。\n*   这是答案的第一部分。\n\n**步骤 4：一个摩尔晶胞中的石墨烯晶胞数量 $N(\\theta)$**\n*   $N(\\theta)$ 是摩尔实空间原胞面积 $A_m$ 与石墨烯实空间原胞面积 $A_g$ 的比值。所以 $N(\\theta) = A_m / A_g$。\n*   我们知道对于二维晶格，实空间晶胞面积 ($A_{\\mathrm{real}}$) 和倒易空间晶胞面积 ($A_{\\mathrm{recip}}$) 之间的一般关系是 $A_{\\mathrm{real}} \\cdot A_{\\mathrm{recip}} = (2\\pi)^2$。\n*   对于石墨烯晶格：$A_g = \\frac{\\sqrt{3}}{2}a^2$。倒易晶胞面积为 $A_{recip, g} = (2\\pi)^2 / A_g = \\frac{4\\pi^2}{(\\sqrt{3}/2)a^2} = \\frac{8\\pi^2}{\\sqrt{3}a^2}$。\n*   对于摩尔晶格：倒易晶胞面积为 $A_{\\mathrm{m-recip}} = A_{\\mathrm{mBZ}}(\\theta) = \\frac{32\\sqrt{3}\\pi^2}{3a^2}\\sin^2(\\frac{\\theta}{2})$。因此，实空间摩尔晶胞面积为 $A_m = (2\\pi)^2 / A_{\\mathrm{m-recip}} = 4\\pi^2 / \\left( \\frac{32\\sqrt{3}\\pi^2}{3a^2}\\sin^2\\left(\\frac{\\theta}{2}\\right) \\right) = \\frac{4\\pi^2 \\cdot 3a^2}{32\\sqrt{3}\\pi^2 \\sin^2(\\theta/2)} = \\frac{12a^2}{32\\sqrt{3}\\sin^2(\\theta/2)} = \\frac{3a^2}{8\\sqrt{3}\\sin^2(\\theta/2)} = \\frac{\\sqrt{3}a^2}{8\\sin^2(\\theta/2)}$。\n*   现在我们可以计算比值 $N(\\theta)$：$N(\\theta) = \\frac{A_m}{A_g} = \\frac{\\frac{\\sqrt{3}a^2}{8\\sin^2(\\theta/2)}}{\\frac{\\sqrt{3}}{2}a^2} = \\frac{\\sqrt{3}a^2}{8\\sin^2(\\theta/2)} \\cdot \\frac{2}{\\sqrt{3}a^2} = \\frac{2}{8\\sin^2(\\theta/2)} = \\frac{1}{4\\sin^2(\\theta/2)}$。\n*   这是答案的第二部分。它符合无量纲的要求。\n*   让我们再次检查推导过程。关键步骤是摩尔倒易晶胞的面积。摩尔倒易矢量的长度是 $G_m = |\\mathbf{b}| \\cdot 2\\sin(\\theta/2)$。一个矢量长度为 $b$ 的三角晶格的倒易原胞面积是 $A_{recip\\_cell} = |b_1 \\times b_2| = b^2 \\sin(120^\\circ) = b^2 \\sqrt{3}/2$。这里的 $b=|\\mathbf{b}_1|$ 是石墨烯倒易矢量的长度。因此 $A_{m-recip} = G_m^2 \\sqrt{3}/2 = (b \\cdot 2\\sin(\\theta/2))^2 \\sqrt{3}/2 = b^2 \\cdot 4\\sin^2(\\theta/2) \\cdot \\sqrt{3}/2 = (b^2 \\sqrt{3}/2) \\cdot 4\\sin^2(\\theta/2) = A_{recip,g} \\cdot 4\\sin^2(\\theta/2)$。\n*   $A_{recip,g} = \\frac{8\\pi^2}{\\sqrt{3}a^2}$。所以 $A_{mBZ} = \\frac{8\\pi^2}{\\sqrt{3}a^2} \\cdot 4\\sin^2(\\frac{\\theta}{2}) = \\frac{32\\pi^2}{\\sqrt{3}a^2} \\sin^2(\\frac{\\theta}{2})$。让我们将其有理化：$\\frac{32\\sqrt{3}\\pi^2}{3a^2} \\sin^2(\\frac{\\theta}{2})$。这与我之前的结果相符。很好。\n*   对于 $N(\\theta)$：$N(\\theta) = A_m/A_g = ( (2\\pi)^2/A_{m-recip} ) / ( (2\\pi)^2/A_{recip,g} ) = A_{recip,g}/A_{m-recip} = A_{recip,g} / (A_{recip,g} \\cdot 4\\sin^2(\\theta/2)) = \\frac{1}{4\\sin^2(\\theta/2)}$。这是一个获得第二个结果的更快方法，并对其进行了验证。推导是可靠的。\n\n**最终答案格式化**\n*   最终答案应放在 `boxed pmatrix` 环境中。\n*   开始 `<final_answer>` 标签。\n*   问题要求两个表达式。我将使用 `pmatrix` 环境。\n*   `A_{\\mathrm{mBZ}}(\\theta)` 是第一项。`$N(\\theta)` 是第二项。\n*   答案是 `$\\frac{32\\sqrt{3}\\pi^2}{3a^2}\\sin^2(\\frac{\\theta}{2})$` 和 `$\\frac{1}{4\\sin^2(\\frac{\\theta}{2})}$`。\n*   根据规则格式化它们：使用 `\\frac`、`^`、`{}` 表示指数。\n*   最后检查格式 `$$\\boxed{\\begin{pmatrix} \\frac{32\\sqrt{3}\\pi^{2}}{3a^{2}}\\sin^{2}\\left(\\frac{\\theta}{2}\\right) & \\frac{1}{4\\sin^{2}\\left(\\frac{\\theta}{2}\\right)} \\end{pmatrix}}$$`。看起来不错。注意 `\\sin^2(x)` 最好写成 `\\sin^{2}(x)` 以避免歧义。问题要求 `$\\theta/2$`，所以 `\\frac{\\theta}{2}` 是正确的。\n*   看起来计划很可靠。我准备好写解决方案了。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{32\\sqrt{3}\\pi^{2}}{3a^{2}}\\sin^{2}\\left(\\frac{\\theta}{2}\\right) & \\frac{1}{4\\sin^{2}\\left(\\frac{\\theta}{2}\\right)} \\end{pmatrix}}$$", "id": "3022794"}, {"introduction": "在理解了莫尔几何之后，我们现在可以探索其最著名的结果：“魔角”的出现。本练习将指导您基于著名的Bistritzer–MacDonald连续介质模型进行一个简化计算，探究层间耦合如何能够显著地将电子速度重整化至零，从而产生平带 [@problem_id:3022739]。这个实践将系统的结构参数与使扭转双层石墨烯如此非凡的电子特性联系起来。", "problem": "在小转角 $\\theta$ 下，转角双层石墨烯 (TBG) 可以用两个无质量的狄拉克哈密顿量来描述，每个哈密顿量对应一层，并通过一个空间调制的层间隧穿耦合在一起。在 Bistritzer–MacDonald 连续模型中，莫尔标度由波矢 $k_{\\theta} = 2|\\mathbf{K}|\\sin(\\theta/2)$ 决定，其中 $|\\mathbf{K}| = 4\\pi/(3a)$，$a$ 是单层石墨烯的晶格常数。层间隧穿由三个对称性相关的过程主导，其特征振幅为 $w_0$（子晶格内，常标记为AA）和 $w_1$（子晶格间，常标记为AB/BA）。莫尔布里渊区中心的低能狄拉克速度 $v^{*}(\\theta)$ 通过虚层间散射被重整化，而第一个“魔角”的操作性定义是使 $v^{*}(\\theta)=0$ 的最小 $\\theta$。\n\n从每层的连续狄拉克哈密顿量出发，将层间隧穿作为对无量纲耦合 $\\alpha = w_1/(\\hbar v_F k_{\\theta})$ 的二阶微扰处理，推导出 $v^{*}(\\theta)=0$ 的领头阶条件（用临界 $\\alpha_{\\mathrm{c}}$ 表示），并求解相应的 $\\theta$。然后，使用参数值 $v_F = 1.00 \\times 10^{6}$ m/s，$w_1 = 0.110$ eV，$a = 0.246 \\times 10^{-9}$ m 和 $\\hbar = 6.582 \\times 10^{-16}$ eV·s，计算第一个魔角的数值。将最终角度以度为单位表示，并将答案四舍五入到四位有效数字。\n\n最后，定性讨论解对 $w_0/w_1$ 比值以及使 $w_0$ 相对于 $w_1$ 减小的弛豫效应的敏感性，解释这些因素如何进入领头阶条件，以及它们如何改变魔角的估计值。\n\n你的最终报告值必须是一个数字。在最终答案中以度为单位陈述角度（不要在方框内包含单位）。", "solution": "问题要求基于连续模型，推导和计算转角双层石墨烯 (TBG) 的第一个魔角。\n\n给出的关键物理量和关系如下：\n- 莫尔波矢：$k_{\\theta} = 2|\\mathbf{K}|\\sin(\\theta/2)$，其中 $\\theta$ 是转角。\n- 单层倒格矢大小：$|\\mathbf{K}| = 4\\pi/(3a)$，其中 $a$ 是单层晶格常数。\n- 层间隧穿振幅：$w_0$（子晶格内）和 $w_1$（子晶格间）。\n- 莫尔布里渊区中心的重整化费米速度：$v^{*}(\\theta)$。\n- 第一个魔角的定义：使 $v^{*}(\\theta)=0$ 的最小 $\\theta > 0$。\n- 无量纲耦合参数：$\\alpha = w_1/(\\hbar v_F k_{\\theta})$。\n- 推导需使用二阶微扰理论。\n\n对于小角度 $\\theta$，莫尔波矢可近似为 $k_{\\theta} \\approx 2|\\mathbf{K}|(\\theta/2) = |\\mathbf{K}|\\theta$。\n\n在电中性点附近，TBG 的低能电子特性可以用一个有效哈密顿量来描述。在连续模型中，两个石墨烯层的狄拉克锥通过莫尔层间势耦合。将此耦合视为对各层动能的微扰，可以推导出低能能带的有效哈密顿量。载流子的速度通过由莫尔势介导的两层之间的虚散射过程而被重整化。\n\n问题指定使用二阶微扰理论。在手性极限 ($w_0=0$) 下，此方法得到的莫尔 $\\Gamma$ 点重整化速度 $v^*$ 的标准结果为：\n$$ \\frac{v^{*}(\\theta)}{v_F} = 1 - 3\\alpha^2 $$\n因子 $3$ 源于连接两层布里渊区狄拉克点的三个等效散射波矢。$3\\alpha^2$ 项是速度的二阶修正。\n\n魔角由条件 $v^{*}(\\theta)=0$ 定义。将此条件应用于微扰结果，得到：\n$$ 1 - 3\\alpha_c^2 = 0 $$\n其中 $\\alpha_c$ 是耦合参数的临界值。求解 $\\alpha_c$ 可得：\n$$ \\alpha_c = \\frac{1}{\\sqrt{3}} $$\n这给出了魔角的领头阶条件。\n\n现在，我们求解满足此条件的角度 $\\theta$。我们将 $\\alpha$、$k_{\\theta}$ 和 $|\\mathbf{K}|$ 的定义代入方程 $\\alpha = \\alpha_c$。\n$$ \\frac{w_1}{\\hbar v_F k_{\\theta}} = \\frac{1}{\\sqrt{3}} $$\n使用小角度近似 $k_{\\theta} \\approx |\\mathbf{K}|\\theta = \\frac{4\\pi}{3a}\\theta$，我们得到：\n$$ \\frac{w_1}{\\hbar v_F \\left(\\frac{4\\pi}{3a}\\theta\\right)} = \\frac{1}{\\sqrt{3}} $$\n求解魔角 $\\theta_m$：\n$$ \\theta_m = \\frac{\\sqrt{3} w_1}{\\hbar v_F \\left(\\frac{4\\pi}{3a}\\right)} = \\frac{3\\sqrt{3} a w_1}{4\\pi \\hbar v_F} $$\n这是在指定模型和近似下，第一个魔角的解析表达式（单位为弧度）。\n\n接下来，我们使用给定的参数计算其数值：\n- $v_F = 1.00 \\times 10^{6}$ m/s\n- $w_1 = 0.110$ eV\n- $a = 0.246 \\times 10^{-9}$ m\n- $\\hbar = 6.582 \\times 10^{-16}$ eV·s\n\n将这些值代入 $\\theta_m$ 的表达式中：\n$$ \\theta_m = \\frac{3\\sqrt{3} (0.246 \\times 10^{-9} \\, \\text{m}) (0.110 \\, \\text{eV})}{4\\pi (6.582 \\times 10^{-16} \\, \\text{eV·s}) (1.00 \\times 10^6 \\, \\text{m/s})} $$\n单位 (m·eV)/(eV·s·m/s) 相互抵消，留下一个无量纲的结果（弧度），正如预期。\n$$ \\theta_m \\approx \\frac{3 \\times 1.73205 \\times 0.246 \\times 10^{-9} \\times 0.110}{4 \\times 3.14159 \\times 6.582 \\times 10^{-16} \\times 1.00 \\times 10^6} \\approx \\frac{1.4040 \\times 10^{-10}}{8.2710 \\times 10^{-9}} \\approx 0.0169997 \\, \\text{rad} $$\n为了将其转换为度，我们乘以 $180/\\pi$：\n$$ \\theta_m (\\text{deg}) = 0.0169997 \\times \\frac{180}{\\pi} \\approx 0.97395^{\\circ} $$\n四舍五入到四位有效数字，第一个魔角为 $0.9740^{\\circ}$。\n\n最后，需要对解关于 $w_0/w_1$ 比值和晶格弛豫的敏感性进行定性讨论。\n\n上述计算假设了手性极限，即子晶格内隧穿 $w_0$ 为零。如果 $w_0 \\neq 0$，隧穿矩阵会变得更加复杂。在 Bistritzer-MacDonald 模型中，非零的 $w_0$ （通常 $w_0 < w_1$）会使速度重整化效果减弱。也就是说，对于给定的角度 $\\theta$，当 $w_0/w_1$ 较大时，速度 $v^*$ 的抑制程度较小。为了实现平带条件 ($v^*=0$)，需要更强的有效层间耦合。这对应于更大的无量纲参数 $\\alpha = w_1/(\\hbar v_F k_\\theta)$ 值。由于 $\\alpha$ 与 $k_\\theta$ 成反比（因此在小角度下与 $\\theta$ 成反比），更大的 $\\alpha$ 值需要更小的转角 $\\theta$。因此，领头阶条件被修正，预计较大的 $w_0/w_1$ 比值会减小魔角。\n\n晶格弛豫指的是原子位置偏离理想刚性晶格构型的重构。在 TBG 中，弛豫导致能量上有利的 AB/BA 堆叠区域扩张，而能量上不利的 AA 堆叠区域收缩。AA 区域的收缩增加了局域层间距离，从而指数级抑制了相应的隧穿振幅 $w_0$。而 AB/BA 隧穿 $w_1$ 受影响较小。因此，晶格弛豫的主要后果是显著减小 $w_0/w_1$ 的比值，使系统更接近手性极限 ($w_0/w_1 \\approx 0$)。根据上述论证，较小的 $w_0/w_1$ 比值使速度重整化更有效，意味着实现 $v^*=0$ 需要较小的 $\\alpha$ 值。这反过来又意味着需要更大的莫尔波长，因此需要更大的魔角 $\\theta$。总而言之，与未弛豫晶格（具有较大的固有 $w_0/w_1$ 比值）的预测相比，晶格弛豫预计会增大第一个魔角的值。", "answer": "$$\\boxed{0.9740}$$", "id": "3022739"}, {"introduction": "如前一个练习所推导的，平带的存在意味着动能被抑制，而电子间的相互作用成为主导。这最后一个练习将深入探讨由此产生的迷人的关联电子物理世界。通过实现一个平均场模型，您将探索不同有序基态（如味道极化相和谷间相干相）之间的竞争，从而一窥多体现象是如何从魔角扭转双层石墨烯独特的能带结构中产生的 [@problem_id:3022777]。", "problem": "考虑一个简化的平均场模型，用于描述扭转双层石墨烯在第一个所谓“魔角”附近的性质，在此角度下，窄的莫尔条纹能带可以近似为平带，并由一个近似的4阶特殊酉群（SU($4$)）味对称性来描述，该对称性包含两个谷和两个自旋。用索引 $\\alpha \\in \\{1,2,3,4\\}$ 表示四种味，对应于 $(\\tau,\\sigma)$，其中 $\\tau \\in \\{K,K'\\}$ 是谷，$\\sigma \\in \\{\\uparrow,\\downarrow\\}$ 是自旋。假设在零温下，每个莫尔晶胞的每种味只有一个平带。令 $n_{\\alpha} \\in [0,1]$ 为每个晶胞中味 $\\alpha$ 的平均占据数，每个晶胞的总填充数为 $\\nu = \\sum_{\\alpha} n_{\\alpha} \\in [0,4]$。本问题中的所有量均以无量纲单位表示，其中单粒子带宽设为 $1$。\n\n相互作用哈密顿量是味对称的，包含三个部分：一个 Hartree 密度-密度排斥项，一个 SU($4$)-对称的交换（Fock）项，以及一个谷间相干（谷交换）项。在 Hartree-Fock 近似下，每个晶胞的平均场能量可以用单体密度矩阵元表示。用 $n_{\\tau\\sigma}$ 表示自旋为 $\\sigma \\in \\{\\uparrow,\\downarrow\\}$ 在谷 $\\tau \\in \\{K,K'\\}$ 的占据数，用 $\\Delta_{\\sigma} = \\langle c^{\\dagger}_{K\\sigma} c_{K'\\sigma} \\rangle$ 表示自旋 $\\sigma$ 的谷间相干序参量。每个晶胞的总能量形式如下\n$$\nE = \\frac{g_{\\mathrm{H}}}{2}\\,\\nu^2 + \\frac{g_{\\mathrm{X}}}{2} \\sum_{\\alpha=1}^{4} n_{\\alpha}^2 \\;-\\; J \\sum_{\\sigma=\\uparrow,\\downarrow} |\\Delta_{\\sigma}|^2,\n$$\n其中 $g_{\\mathrm{H}} > 0$ 是 Hartree 系数，$g_{\\mathrm{X}} < 0$ 是交换系数，$J > 0$ 是谷间相干耦合强度。在零温下，对于一个固定的自旋 $\\sigma$ 和一个二能级谷子空间， $2\\times 2$ 单体密度矩阵的正定性和归一化条件意味着以下边界\n$$\n|\\Delta_{\\sigma}| \\le \\min\\!\\left(\\frac{n_{\\sigma}}{2},\\,\\frac{2 - n_{\\sigma}}{2}\\right),\n$$\n其中 $n_{\\sigma} = n_{K\\sigma} + n_{K'\\sigma} \\in [0,2]$ 是自旋 $\\sigma$ 的谷子空间中的总占据数。当每个自旋内的谷占据数相等，且占据态是谷子空间中的一个相干叠加态时，该边界达到饱和；当谷子空间为空（$n_{\\sigma} = 0$）或完全填充（$n_{\\sigma} = 2$）时，该边界为零。\n\n需要比较两种候选的平均场相：\n\n1. 味极化相（FP），在此相中，粒子在填充约束允许的情况下，尽可能少地占据不同的味。在此相中，对于两个自旋，都有 $|\\Delta_{\\sigma}| = 0$。在 $0 \\le n_{\\alpha} \\le 1$ 的约束下，对于固定的 $\\nu$，通过先完全填充一个味，再开始填充下一个味的方式，可以实现最大的味极化，从而得到一个分段的占据构型，该构型使得 $\\sum_{\\alpha} n_{\\alpha}^2$ 最大化。\n\n2. 谷间相干相（IVC），在此相中，自旋是无极化的，每个自旋内的谷占据数相等，从而使 $|\\Delta_{\\sigma}|$ 的边界达到饱和。在此相中，所有四种味的占据数都相等，$n_{\\alpha} = \\nu/4$，每个自旋的相干性为 $|\\Delta_{\\sigma}| = \\min\\!\\left(\\frac{n_{\\sigma}}{2},\\,\\frac{2 - n_{\\sigma}}{2}\\right)$，其中 $n_{\\sigma} = \\nu/2$。\n\n定义味极化序参量\n$$\nM = \\left(\\sum_{\\alpha=1}^{4} n_{\\alpha}^2\\right) - \\frac{\\nu^2}{4},\n$$\n它衡量了偏离均等味占据的程度（$M=0$ 表示完全均等的味占据），以及总谷间相干序参量\n$$\n|\\Delta| = \\sqrt{|\\Delta_{\\uparrow}|^2 + |\\Delta_{\\downarrow}|^2}.\n$$\n\n任务。实现一个程序，对于每个指定的测试用例，使用上述定义计算两种拟设相的平均场能量 $E_{\\mathrm{FP}}$ 和 $E_{\\mathrm{IVC}}$，将能量较低的相确定为基态（若能量相等，则选择味极化相），并为每个测试用例输出：\n- 相标识符，为整数（FP为 $0$，IVC为 $1$）。\n- 对应的味极化序参量 $M$。\n- 对应的总谷间相干序参量 $|\\Delta|$。\n\n您的程序应一致地处理 Hartree 贡献 $\\frac{g_{\\mathrm{H}}}{2} \\nu^2$，但请注意，在固定 $\\nu$ 时，它不影响相的竞争，因为它与味的分布无关。\n\n使用以下无量纲单位的参数集测试套件 $(\\nu, g_{\\mathrm{H}}, g_{\\mathrm{X}}, J)$：\n- 测试 $1$: $(\\nu, g_{\\mathrm{H}}, g_{\\mathrm{X}}, J) = (0, 1, -0.5, 0.1)$。\n- 测试 $2$: $(\\nu, g_{\\mathrm{H}}, g_{\\mathrm{X}}, J) = (1, 1, -0.5, 0.1)$。\n- 测试 $3$: $(\\nu, g_{\\mathrm{H}}, g_{\\mathrm{X}}, J) = (2, 1, -0.2, 0.5)$。\n- 测试 $4$: $(\\nu, g_{\\mathrm{H}}, g_{\\mathrm{X}}, J) = (3.2, 1, -0.8, 0.1)$。\n- 测试 $5$: $(\\nu, g_{\\mathrm{H}}, g_{\\mathrm{X}}, J) = (2, 1, -0.8, 1.2)$。\n- 测试 $6$: $(\\nu, g_{\\mathrm{H}}, g_{\\mathrm{X}}, J) = (4, 1, -0.5, 0.5)$。\n\n最终输出格式。您的程序应生成单行输出，其中包含六个测试用例的结果，格式为用方括号括起来的逗号分隔列表。每个内部列表必须为 $[\\text{phase\\_id}, M, |\\Delta|]$ 的形式，数值以 Python 浮点数或整数表示。例如，输出行的格式为\n$[[\\cdots],[\\cdots],[\\cdots],[\\cdots],[\\cdots],[\\cdots]]$。", "solution": "该问题要求比较扭转双层石墨烯简化模型的两种候选基态的平均场能量：一种是味极化（FP）相，另一种是谷间相干（IVC）相。基态由能量较低者确定，若能量相等，则选择FP相。对于确定的基态，我们必须计算味极化序参量 $M$ 和总谷间相干序参量 $|\\Delta|$。\n\n每个莫尔晶胞的总能量由下式给出\n$$\nE = \\frac{g_{\\mathrm{H}}}{2}\\,\\nu^2 + \\frac{g_{\\mathrm{X}}}{2} \\sum_{\\alpha=1}^{4} n_{\\alpha}^2 \\;-\\; J \\sum_{\\sigma=\\uparrow,\\downarrow} |\\Delta_{\\sigma}|^2\n$$\n其中 $\\nu$ 是总填充数，$g_{\\mathrm{H}}$、$g_{\\mathrm{X}}$ 和 $J$ 是耦合常数，$n_{\\alpha}$ 是味占据数，而 $|\\Delta_{\\sigma}|$ 是与自旋相关的谷间相干振幅。在固定填充数 $\\nu$ 的情况下，Hartree 项 $\\frac{g_{\\mathrm{H}}}{2}\\nu^2$ 对两相是相同的，因此不影响相竞争。但是，在计算总能量时必须包含此项。\n\n我们现在将推导两种相各自的能量和序参量的具体表达式。\n\n**1. 味极化（FP）相**\n\n在FP相中，粒子占据尽可能少的味。选择占据数 $n_{\\alpha}$ 以最大化 $\\sum_{\\alpha} n_{\\alpha}^2$ 项。对于总填充数 $\\nu \\in [0, 4]$，这可以通过完全填充 $\\lfloor\\nu\\rfloor$ 个味（占据数为1），部分填充一个味（占据数为剩余的 $\\nu - \\lfloor\\nu\\rfloor$），并使其他 $4 - \\lfloor\\nu\\rfloor - 1$ 个味保持为空来实现。\n\n- **味占据数 ($n_{\\alpha}$)**：令 $k = \\lfloor\\nu\\rfloor$。四种味的占据数集合为 $\\{\\underbrace{1, \\dots, 1}_{k \\text{ 次}}, \\nu - k, \\underbrace{0, \\dots, 0}_{3-k \\text{ 次}}\\}$。对于 $\\nu=4$，这正确地给出了 $\\{1,1,1,1\\}$。\n\n- **占据数平方和 ($\\sum n_{\\alpha}^2$)**：基于这些占据数，其和为\n$$\n\\sum_{\\alpha=1}^{4} n_{\\alpha}^2 = k \\cdot 1^2 + (\\nu-k)^2 = \\lfloor\\nu\\rfloor + (\\nu - \\lfloor\\nu\\rfloor)^2.\n$$\n\n- **谷间相干性 ($|\\Delta_{\\sigma}|$)**：根据FP相的定义，谷间相干性为零：对于 $\\sigma \\in \\{\\uparrow,\\downarrow\\}$，$|\\Delta_{\\sigma}| = 0$。\n\n- **能量 ($E_{\\mathrm{FP}}$)**：将这些代入通用能量公式，得到\n$$\nE_{\\mathrm{FP}}(\\nu, g_{\\mathrm{H}}, g_{\\mathrm{X}}, J) = \\frac{g_{\\mathrm{H}}}{2}\\nu^2 + \\frac{g_{\\mathrm{X}}}{2} \\left[ \\lfloor\\nu\\rfloor + (\\nu - \\lfloor\\nu\\rfloor)^2 \\right].\n$$\n\n- **味极化 ($M_{\\mathrm{FP}}$)**：序参量 $M$ 定义为 $M = \\left(\\sum n_{\\alpha}^2\\right) - \\frac{\\nu^2}{4}$。对于FP相：\n$$\nM_{\\mathrm{FP}} = \\left[ \\lfloor\\nu\\rfloor + (\\nu - \\lfloor\\nu\\rfloor)^2 \\right] - \\frac{\\nu^2}{4}.\n$$\n\n- **总相干性 ($|\\Delta|_{\\mathrm{FP}}$)**：总相干性参量 $|\\Delta| = \\sqrt{|\\Delta_{\\uparrow}|^2 + |\\Delta_{\\downarrow}|^2}$ 为\n$$\n|\\Delta|_{\\mathrm{FP}} = \\sqrt{0^2 + 0^2} = 0.\n$$\n\n**2. 谷间相干（IVC）相**\n\n在IVC相中，味占据数均等分布，自旋无极化，且谷间相干性达到最大。\n\n- **味占据数 ($n_{\\alpha}$)**：所有四种味的占据数相等：对于 $\\alpha \\in \\{1,2,3,4\\}$，$n_{\\alpha} = \\nu/4$。\n\n- **占据数平方和 ($\\sum n_{\\alpha}^2$)**：\n$$\n\\sum_{\\alpha=1}^{4} n_{\\alpha}^2 = 4 \\left(\\frac{\\nu}{4}\\right)^2 = \\frac{\\nu^2}{4}.\n$$\n\n- **谷间相干性 ($|\\Delta_{\\sigma}|$)**：每个自旋通道的相干性使边界 $|\\Delta_{\\sigma}| \\le \\min\\left(\\frac{n_{\\sigma}}{2},\\,\\frac{2 - n_{\\sigma}}{2}\\right)$ 饱和。在自旋无极化的情况下，每个自旋的总填充数为 $n_{\\sigma} = n_{K\\sigma} + n_{K'\\sigma} = \\nu/4 + \\nu/4 = \\nu/2$。因此，\n$$\n|\\Delta_{\\uparrow}| = |\\Delta_{\\downarrow}| = \\min\\left(\\frac{\\nu/2}{2},\\, \\frac{2-\\nu/2}{2}\\right) = \\min\\left(\\frac{\\nu}{4}, 1-\\frac{\\nu}{4}\\right).\n$$\n当 $\\nu \\le 2$ 时，此表达式的值为 $\\nu/4$；当 $\\nu > 2$ 时，值为 $1-\\nu/4$。\n\n- **能量 ($E_{\\mathrm{IVC}}$)**：代入能量公式：\n$$\nE_{\\mathrm{IVC}}(\\nu, g_{\\mathrm{H}}, g_{\\mathrm{X}}, J) = \\frac{g_{\\mathrm{H}}}{2}\\nu^2 + \\frac{g_{\\mathrm{X}}}{2} \\left(\\frac{\\nu^2}{4}\\right) - J \\left[ |\\Delta_{\\uparrow}|^2 + |\\Delta_{\\downarrow}|^2 \\right]\n$$\n$$\nE_{\\mathrm{IVC}} = \\frac{g_{\\mathrm{H}}}{2}\\nu^2 + \\frac{g_{\\mathrm{X}}}{8}\\nu^2 - 2J \\left[ \\min\\left(\\frac{\\nu}{4}, 1-\\frac{\\nu}{4}\\right) \\right]^2.\n$$\n\n- **味极化 ($M_{\\mathrm{IVC}}$)**：\n$$\nM_{\\mathrm{IVC}} = \\left(\\frac{\\nu^2}{4}\\right) - \\frac{\\nu^2}{4} = 0.\n$$\n这是预料之中的，因为IVC态具有均匀的味占据。\n\n- **总相干性 ($|\\Delta|_{\\mathrm{IVC}}$)**：\n$$\n|\\Delta|_{\\mathrm{IVC}} = \\sqrt{|\\Delta_{\\uparrow}|^2 + |\\Delta_{\\downarrow}|^2} = \\sqrt{2 \\left[ \\min\\left(\\frac{\\nu}{4}, 1-\\frac{\\nu}{4}\\right) \\right]^2} = \\sqrt{2} \\min\\left(\\frac{\\nu}{4}, 1-\\frac{\\nu}{4}\\right).\n$$\n\n**计算逻辑**\n\n对于每个测试用例 $(\\nu, g_{\\mathrm{H}}, g_{\\mathrm{X}}, J)$：\n1.  使用推导出的公式计算 $E_{\\mathrm{FP}}$、$M_{\\mathrm{FP}}$ 和 $|\\Delta|_{\\mathrm{FP}}$。\n2.  使用推导出的公式计算 $E_{\\mathrm{IVC}}$、$M_{\\mathrm{IVC}}$ 和 $|\\Delta|_{\\mathrm{IVC}}$。\n3.  比较能量。如果 $E_{\\mathrm{FP}} \\le E_{\\mathrm{IVC}}$，则基态是FP（相ID $0$）。输出为 $[0, M_{\\mathrm{FP}}, |\\Delta|_{\\mathrm{FP}}]$。\n4.  否则，如果 $E_{\\mathrm{IVC}} < E_{\\mathrm{FP}}$，则基态是IVC（相ID $1$）。输出为 $[1, M_{\\mathrm{IVC}}, |\\Delta|_{\\mathrm{IVC}}]$。\n\n对每个测试用例执行此过程以生成最终输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the ground state properties for two competing phases in a \n    simplified model of twisted bilayer graphene.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Format: (nu, g_H, g_X, J)\n    test_cases = [\n        (0.0, 1.0, -0.5, 0.1),\n        (1.0, 1.0, -0.5, 0.1),\n        (2.0, 1.0, -0.2, 0.5),\n        (3.2, 1.0, -0.8, 0.1),\n        (2.0, 1.0, -0.8, 1.2),\n        (4.0, 1.0, -0.5, 0.5),\n    ]\n\n    results = []\n    for case in test_cases:\n        nu, g_H, g_X, J = case\n        \n        # --- Flavor-Polarized (FP) Phase Calculation ---\n        k = np.floor(nu)\n        \n        # Sum of squared occupations\n        sum_n_sq_fp = k + (nu - k)**2\n        \n        # Energy of the FP phase\n        # The coherence term is zero by definition\n        E_fp = (g_H / 2.0) * nu**2 + (g_X / 2.0) * sum_n_sq_fp\n        \n        # Flavor polarization order parameter M for FP phase\n        M_fp = sum_n_sq_fp - (nu**2 / 4.0)\n        \n        # Total intervalley coherence |Delta| for FP phase is 0\n        Delta_fp = 0.0\n\n        # --- Intervalley-Coherent (IVC) Phase Calculation ---\n        \n        # Sum of squared occupations\n        sum_n_sq_ivc = nu**2 / 4.0\n        \n        # Intervalley coherence amplitude per spin\n        delta_sigma_ivc = min(nu / 4.0, 1.0 - nu / 4.0)\n        \n        # Sum of squared coherence amplitudes\n        sum_delta_sq_ivc = 2.0 * delta_sigma_ivc**2\n        \n        # Energy of the IVC phase\n        E_ivc = (g_H / 2.0) * nu**2 + (g_X / 2.0) * sum_n_sq_ivc - J * sum_delta_sq_ivc\n        \n        # Flavor polarization order parameter M for IVC phase is 0\n        M_ivc = 0.0\n        \n        # Total intervalley coherence |Delta| for IVC phase\n        Delta_ivc = np.sqrt(2.0) * delta_sigma_ivc\n\n        # --- Phase Competition ---\n        # Compare energies to find the ground state.\n        # Tie-breaking rule: favor FP phase if energies are equal.\n        if E_fp = E_ivc:\n            # Ground state is Flavor-Polarized\n            phase_id = 0\n            M_gs = M_fp\n            Delta_gs = Delta_fp\n        else:\n            # Ground state is Intervalley-Coherent\n            phase_id = 1\n            M_gs = M_ivc\n            Delta_gs = Delta_ivc\n            \n        results.append([phase_id, M_gs, Delta_gs])\n\n    # Final print statement in the exact required format.\n    # The use of map(str, ...) on a list of lists is intentional to match the spec.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3022777"}]}