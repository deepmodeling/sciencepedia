{"hands_on_practices": [{"introduction": "在深入研究过渡金属硫族化合物（TMDs）复杂的电子和光学特性之前，我们必须首先牢固掌握其基本的晶体结构。本练习通过一个基于理想几何模型的估算，引导您从微观的化学键长和范德华半径等参数出发，推导出块状 2H-MoS$_2$ 的宏观晶格常数。这个实践不仅能加深您对 TMDs 原子排列的直观理解，还能通过计算各向异性比率 $c/a$，让您亲身感受其固有的层状结构特性 [@problem_id:3022462]。", "problem": "单层六方多型体2H-二硫化钼 (2H-MoS$_2$) 由一个硫-钼-硫 (S–Mo–S) 三层结构组成，其中钼原子与六个相邻的硫原子形成三角棱柱配位。将每一层视为由钼原子组成的等边三角形网络，其面内晶格常数为 $a$，硫原子位于钼原子三角形中心的正上方和正下方。假设以下与文献一致的典型值来估计其结构：\n- 钼-硫键长 $d_{\\mathrm{MoS}} = 2.42\\,\\text{\\AA}$，\n- 硫的范德华半径 $r_{\\mathrm{vdW}}(\\mathrm{S}) = 1.80\\,\\text{\\AA}$，\n- 层内S-Mo-S三层结构厚度 $t = 3.10\\,\\text{\\AA}$ (单个三层结构内两个硫原子平面之间的距离)。\n\n仅使用理想的三角棱柱几何构型和六方对称性，推导2H晶胞的面内晶格常数 $a$ 和面外晶格常数 $c$ 的表达式。将Mo–S键的横向投影视为钼原子六方网络中三角形顶点到其质心的距离，并将相邻三层结构之间的层间硫-硫间距建模为范德华接触距离 $g = 2\\,r_{\\mathrm{vdW}}(\\mathrm{S})$。2H多型体的晶胞沿 $c$ 轴方向堆叠了两个S-Mo-S三层结构。\n\n计算：\n- 面内晶格常数 $a$，\n- 面外晶格常数 $c$，\n- 各向异性比 $c/a$。\n\n将 $a$ 和 $c$ 以 Å 为单位表示。将所有要求的数值结果四舍五入到三位有效数字。将 $c/a$ 以无量纲、无弧度的形式给出。", "solution": "我们已对问题陈述进行评估并确定其有效。该问题具有科学依据，内容自洽，提法明确，为估算2H-MoS$_2$的晶格常数提供了一套一致的几何和物理参数。该模型基于理想的三角棱柱几何构型，通过直接应用几何原理可以得出一个唯一解。\n\n解题过程基于所提供的参数，计算面内晶格常数 $a$、面外晶格常数 $c$ 以及各向异性比 $c/a$。\n\n**1. 计算面内晶格常数 ($a$)**\n\n题目描述了一个单一的S-Mo-S三层结构。Mo原子形成一个三角晶格，S原子位于Mo原子构成的三角形中心的正上方和正下方。在此结构中，长度为 $d_{\\mathrm{MoS}}$ 的Mo-S键可以视为一个直角三角形的斜边。\n\n这个直角三角形的两条直角边分别是：\ni. 一个垂直分量，即从钼原子平面到任一硫原子平面的垂直距离。鉴于S-Mo-S三层结构的总厚度为 $t$，此距离为 $t/2$。\nii. 一个水平分量，即Mo-S键在钼原子平面上的横向投影。我们记该投影为 $p$。\n\n根据勾股定理，这些量之间的关系为：\n$$d_{\\mathrm{MoS}}^2 = p^2 + \\left(\\frac{t}{2}\\right)^2$$\n我们可以解出横向投影 $p$：\n$$p = \\sqrt{d_{\\mathrm{MoS}}^2 - \\left(\\frac{t}{2}\\right)^2}$$\n题目指出，该横向投影 $p$ 等于一个等边三角形的顶点（一个Mo原子）到其质心的距离，该等边三角形的边长为面内晶格常数 $a$。对于边长为 $a$ 的等边三角形，此距离由以下几何关系给出：\n$$p = \\frac{a}{\\sqrt{3}}$$\n令两个关于 $p$ 的表达式相等，我们可以推导出 $a$ 的公式：\n$$\\frac{a}{\\sqrt{3}} = \\sqrt{d_{\\mathrm{MoS}}^2 - \\left(\\frac{t}{2}\\right)^2}$$\n$$a = \\sqrt{3} \\sqrt{d_{\\mathrm{MoS}}^2 - \\left(\\frac{t}{2}\\right)^2}$$\n代入给定值 $d_{\\mathrm{MoS}} = 2.42\\,\\text{\\AA}$ 和 $t = 3.10\\,\\text{\\AA}$：\n$$a = \\sqrt{3} \\sqrt{(2.42)^2 - \\left(\\frac{3.10}{2}\\right)^2} = \\sqrt{3} \\sqrt{5.8564 - (1.55)^2}$$\n$$a = \\sqrt{3} \\sqrt{5.8564 - 2.4025} = \\sqrt{3} \\sqrt{3.4539} \\approx 3.2190\\,\\text{\\AA}$$\n四舍五入到三位有效数字，面内晶格常数为 $a \\approx 3.22\\,\\text{\\AA}$。\n\n**2. 计算面外晶格常数 ($c$)**\n\n2H多型体的MoS$_2$晶胞包含两个沿 $c$ 轴堆叠的S-Mo-S三层结构。面外晶格常数 $c$ 是这个双三层结构晶胞的总高度。\n\n晶胞的高度是相邻三层结构中心之间距离（即Mo平面到Mo平面的距离）的两倍。记此距离为 $h_{\\mathrm{Mo-Mo}}$。\n$$c = 2 h_{\\mathrm{Mo-Mo}}$$\n距离 $h_{\\mathrm{Mo-Mo}}$ 由一个三层结构内部的间距和三层结构之间的间距组成。具体而言，从一层中的Mo平面到下一层中的Mo平面，必须穿过第一个三层结构厚度的一半到达其S平面边界，再穿过层间范德华间隙，然后穿过第二个三层结构厚度的一半到达其Mo平面。\n更正式地讲，层间间隙 $g$ 是一个三层结构的硫平面与相邻三层结构最近的硫平面之间的距离。因此，钼平面之间的距离是 $h_{\\mathrm{Mo-Mo}} = \\frac{t}{2} + g + \\frac{t}{2} = t + g$。\n因此，面外晶格常数由下式给出：\n$$c = 2(t + g)$$\n题目将层间硫-硫间距（范德华间隙）定义为 $g = 2\\,r_{\\mathrm{vdW}}(\\mathrm{S})$。\n$$c = 2(t + 2\\,r_{\\mathrm{vdW}}(\\mathrm{S}))$$\n代入给定值 $t = 3.10\\,\\text{\\AA}$ 和 $r_{\\mathrm{vdW}}(\\mathrm{S}) = 1.80\\,\\text{\\AA}$：\n$$c = 2(3.10 + 2 \\times 1.80) = 2(3.10 + 3.60) = 2(6.70) = 13.4\\,\\text{\\AA}$$\n根据输入参数，该结果具有三位有效数字。面外晶格常数为 $c = 13.4\\,\\text{\\AA}$。\n\n**3. 计算各向异性比 ($c/a$)**\n\n各向异性比是面外晶格常数与面内晶格常数的无量纲比值。为避免舍入误差的传播，我们使用未四舍五入的值进行计算：\n$$a \\approx 3.2190\\,\\text{\\AA}$$\n$$c = 13.4\\,\\text{\\AA}$$\n该比值为：\n$$\\frac{c}{a} = \\frac{13.4}{3.2190} \\approx 4.16278$$\n四舍五入到三位有效数字，各向异性比为 $c/a \\approx 4.16$。\n\n所求的量为：\n- 面内晶格常数 $a \\approx 3.22\\,\\text{\\AA}$。\n- 面外晶格常数 $c = 13.4\\,\\text{\\AA}$。\n- 各向异性比 $c/a \\approx 4.16$。", "answer": "$$\\boxed{\\begin{pmatrix} 3.22 & 13.4 & 4.16 \\end{pmatrix}}$$", "id": "3022462"}, {"introduction": "单层TMDs最引人入胜的特性之一源于其对称性破缺与强自旋轨道耦合（SOC）的结合。本练习将指导您运用对称性原理，在布里渊区的$K$点附近推导出一个描述价带顶的有效哈密顿量，并由此计算出由SOC引起的自旋劈裂。通过这个实践，您将理解为何反演对称性的缺失是产生自旋劈裂的必要条件，并能定量比较不同材料（如 MoS$_2$ 与 WS$_2$）中该效应的强度，这对于理解谷电子学和自旋电子学至关重要 [@problem_id:3022332]。", "problem": "考虑一个化学式为 $\\mathrm{MX}_{2}$ 的单层过渡金属二硫属化物 (TMD)，其中 $\\mathrm{M}$ 是VI族过渡金属，$\\mathrm{X}$ 是硫属元素。在布里渊区角点 $K$ 附近，顶价带主要来源于金属的 $d$ 轨道，这些轨道具有有限的平面外轨道角动量，并与硫属元素的 $p$ 轨道弱混合。在单层结构中，$\\mathrm{X}$–$\\mathrm{M}$–$\\mathrm{X}$ 堆叠结构破坏了全局反演对称性，但时间反演对称性保持不变。主导的相对论性相互作用是原子自旋轨道耦合 (SOC)，其微观形式由单粒子算符 $H_{\\mathrm{SO}}=\\lambda\\,\\mathbf{L}\\cdot\\mathbf{S}$ 给出，该算符作用于每种原子内部，其中 $\\lambda$ 是SOC常数，$\\mathbf{L}$ 是轨道角动量，$\\mathbf{S}$ 是自旋角动量。\n\n从 $H_{\\mathrm{SO}}=\\lambda\\,\\mathbf{L}\\cdot\\mathbf{S}$、时间反演对称性以及适用于单层TMD在 $K$ 点的点群约束出发，在双带 $\\mathbf{k}\\cdot\\mathbf{p}$ 模型描述中，推导在 $K$ 点的价带子空间中允许存在的主导阶有效SOC项。利用此结果，得到固定谷点 $K$ 处价带边的自旋分裂 $\\Delta_{v}(K)$ 的解析表达式，该表达式用单个有效SOC参数 $\\lambda_{v}$ 表示，此参数是通过将 $H_{\\mathrm{SO}}$ 投影到低能价带子空间中得到的。简要解释为什么破缺的反演对称性允许非零的 $\\Delta_{v}(K)$，而时间反演对称性则导致了谷对比的自旋构型。\n\n然后，使用以下包含了原子SOC和杂化效应的有效价带SOC参数，计算 $\\mathrm{MoS}_{2}$ 和 $\\mathrm{WS}_{2}$ 的 $\\Delta_{v}(K)$ 值：\n- $\\lambda_{v}^{\\mathrm{MoS}_{2}}=75\\ \\mathrm{meV}$，\n- $\\lambda_{v}^{\\mathrm{WS}_{2}}=215\\ \\mathrm{meV}$。\n\n最终能量以 $\\mathrm{meV}$ 为单位表示，并将您的答案四舍五入到四位有效数字。将您得到的两个 $\\Delta_{v}(K)$ 的最终数值以单行矩阵的形式给出。此外，根据您推导的表达式，陈述在 $\\Delta_{v}(K)$ 方面区分 $\\mathrm{MoX}_{2}$ 和 $\\mathrm{WX}_{2}$ 的定性趋势。", "solution": "此问题要求推导单层过渡金属二硫属化物 (TMD) 在布里渊区 $K$ 点处价带的自旋分裂，然后对 $\\mathrm{MoS}_{2}$ 和 $\\mathrm{WS}_{2}$ 进行数值计算。\n\n### 步骤1：有效自旋轨道耦合 (SOC) 哈密顿量的推导\n\n我们从微观原子自旋轨道耦合 (SOC) 哈密顿量 $H_{\\mathrm{SO}}=\\lambda\\,\\mathbf{L}\\cdot\\mathbf{S}$ 开始，其中 $\\lambda$ 是SOC常数，$\\mathbf{L}$ 和 $\\mathbf{S}$ 分别是轨道和自旋角动量算符。我们需要找到当这个哈密顿量投影到 $K$ 点价带边的二重自旋简并子空间上时的有效形式。\n\n设该子空间的基为 $\\{|v, K, \\uparrow\\rangle, |v, K, \\downarrow\\rangle\\}$，其中 $|v, K\\rangle$ 表示布洛赫态的轨道部分，而 $|\\uparrow\\rangle, |\\downarrow\\rangle$ 是沿着平面外 $z$ 轴量子化的自旋向上和自旋向下态。有效哈密顿量将是这个自旋基中的一个 $2 \\times 2$ 矩阵。\n\n一个 $2 \\times 2$ 哈密顿量的一般形式为 $H^{\\text{eff}} = c_0 I + \\mathbf{c} \\cdot \\boldsymbol{\\sigma}$，其中 $I$ 是 $2 \\times 2$ 单位矩阵，$\\boldsymbol{\\sigma}=(\\sigma_x, \\sigma_y, \\sigma_z)$ 是泡利矩阵，系数通过将 $H_{\\mathrm{SO}}$ 投影到该基上确定。\n\n问题陈述了 $K$ 点的价带来源于具有有限平面外轨道角动量的金属 $d$ 轨道。这意味着轨道角动量的 $z$ 分量的期望值 $\\langle v, K|L_z|v, K\\rangle$ 是非零的。$K$ 点的点群对称性是 $D_{3h}$。在该群绕 $z$ 轴的 $C_3$ 旋转对称性下，平面内分量 $(L_x, L_y)$ 像矢量一样变换且不保持不变，而 $L_z$ 是一个标量且保持不变。因此，它们在非简并（轨道上）态 $|v, K\\rangle$ 内的期望值必须为零：$\\langle v, K|L_x|v, K\\rangle = 0$ 和 $\\langle v, K|L_y|v, K\\rangle = 0$。\n\n因此，$H_{\\mathrm{SO}}$ 的投影大大简化：\n$$\nH_{\\mathrm{SO}, v, K}^{\\text{eff}} = \\text{proj}_{v,K} (\\lambda (L_x S_x + L_y S_y + L_z S_z)) \\text{proj}_{v,K}\n$$\n项 $L_x S_x$ 和 $L_y S_y$ 包含翻转自旋的算符。例如，$\\langle \\uparrow | L_x S_x | \\downarrow \\rangle \\propto \\langle v,K|L_x|v,K \\rangle$。由于一阶期望值 $\\langle L_x \\rangle$ 和 $\\langle L_y \\rangle$ 为零，这些项在主导阶上没有贡献。唯一保留下来的是包含 $L_z S_z$ 的项。\n$$\nH_{\\mathrm{SO}, v, K}^{\\text{eff}} \\approx \\lambda \\langle v, K|L_z|v, K\\rangle S_z\n$$\n这个有效哈密顿量在 $z$ 自旋基中是对角的。我们将 $S_z$ 以矩阵形式表示为 $S_z \\rightarrow \\frac{\\hbar}{2}\\sigma_z$。对于无量纲的公式，我们可以使用 $S_z \\rightarrow \\frac{1}{2}\\sigma_z$。量 $\\lambda \\langle v, K|L_z|v, K\\rangle$ 是导致一个能量值的微观参数的乘积。\n\n现在，我们必须考虑基本对称性施加的约束：破缺的反演对称性 ($\\mathcal{P}$) 和保持的时间反演对称性 ($\\mathcal{T}$)。谷指数 $\\tau$ 区分 $K$ ($\\tau=+1$) 和 $K'$ ($\\tau=-1$) 谷。$K'$ 谷的态是 $K$ 谷态的时间反演伙伴。算符 $\\mathbf{L}$ 在时间反演下是奇的，所以 $\\langle L_z \\rangle_{K'} = \\langle v, K'|L_z|v, K'\\rangle = - \\langle v, K|L_z|v, K\\rangle = -\\langle L_z \\rangle_K$。这意味着有效轨道磁矩在两个谷中是相反的。\n\n我们可以将一般谷 $\\tau$ 的有效哈密顿量写为：\n$$\nH_{\\mathrm{SO}, v, \\tau}^{\\text{eff}} \\propto \\tau S_z\n$$\n让我们根据问题中给定的单个参数 $\\lambda_v$ 来定义有效哈密顿量。在双能级自旋系统中，有效SOC哈密顿量的常见形式是 $H = C \\sigma_z$。其本征值为 $\\pm C$，导致 $2C$ 的分裂。考虑到所提供的数值，其中参数 $\\lambda_v$ 大约是已知实验分裂值的一半，因此将有效哈密顿量定义为以下形式是合理的：\n$$\nH_{\\mathrm{SO}, v, \\tau}^{\\text{eff}} = \\lambda_v \\tau \\sigma_z\n$$\n这就是推导出的、对称性所允许的主导阶有效SOC项。这种形式与时间反演对称性一致，因为它连接了两个谷：$\\mathcal{T} H_{\\text{eff}}(K) \\mathcal{T}^{-1} = \\mathcal{T} (\\lambda_v \\sigma_z) \\mathcal{T}^{-1} = \\lambda_v (-\\sigma_z) = H_{\\text{eff}}(K')$。\n\n### 步骤2：自旋分裂 $\\Delta_v(K)$ 的解析表达式\n\n使用推导出的 $K$ 谷 ($\\tau=+1$) 的有效哈密顿量 $H_{\\mathrm{SO}, v, K}^{\\text{eff}} = \\lambda_v \\sigma_z$，我们求其本征值。$\\sigma_z$ 的本征值为 $+1$（对于自旋向上态 $|\\uparrow\\rangle$）和 $-1$（对于自旋向下态 $|\\downarrow\\rangle$）。相应的能量本征值为：\n$$\nE_{\\uparrow} = +\\lambda_v\n$$\n$$\nE_{\\downarrow} = -\\lambda_v\n$$\n自旋分裂 $\\Delta_v(K)$ 是这些能级之间的绝对差值：\n$$\n\\Delta_v(K) = |E_{\\uparrow} - E_{\\downarrow}| = |\\lambda_v - (-\\lambda_v)| = |2\\lambda_v|\n$$\n由于像 $\\lambda_v$ 这样的SOC参数代表能量尺度并且通常取正值，因此自旋分裂的解析表达式为：\n$$\n\\Delta_v(K) = 2\\lambda_v\n$$\n\n### 步骤3：对称性的作用\n\n- **破缺的反演对称性**：对于一个系统，要在波矢 $\\mathbf{k}$ 处表现出自旋分裂 $\\mathbf{\\Delta E} \\propto \\boldsymbol{\\Omega}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma}$，有效SOC场 $\\boldsymbol{\\Omega}(\\mathbf{k})$ 必须非零。时间反演对称性要求 $\\boldsymbol{\\Omega}(-\\mathbf{k}) = -\\boldsymbol{\\Omega}(\\mathbf{k})$。如果同时存在反演对称性，则要求 $\\boldsymbol{\\Omega}(-\\mathbf{k}) = \\boldsymbol{\\Omega}(\\mathbf{k})$。唯一同时为奇函数和偶函数的函数是零函数，即 $\\boldsymbol{\\Omega}(\\mathbf{k}) = 0$。因此，在中心对称晶体中，自旋分裂是被禁止的（Kramers 简并性在每个 $\\mathbf{k}$ 点都成立）。在单层TMD中，反演对称性被破坏，因此约束 $\\boldsymbol{\\Omega}(-\\mathbf{k}) = \\boldsymbol{\\Omega}(\\mathbf{k})$ 被解除，从而允许 $\\boldsymbol{\\Omega}(\\mathbf{k}) \\neq 0$ 以及非零的自旋分裂 $\\Delta_v(K)$。\n\n- **时间反演对称性与谷对比自旋**：如推导所示，时间反演对称性通过 $H_{\\text{eff}}(K') = \\mathcal{T} H_{\\text{eff}}(K) \\mathcal{T}^{-1}$ 连接了 $K$ 谷和 $K'$ 谷的哈密顿量。当 $H_{\\text{eff}}(K) = \\lambda_v \\sigma_z$ 时，这导致 $H_{\\text{eff}}(K') = -\\lambda_v \\sigma_z$。这意味着自旋分裂的符号在两个谷中是相反的。在 $K$ 谷，自旋向上态的能量为 $+\\lambda_v$，自旋向下态为 $-\\lambda_v$。在 $K'$ 谷，自旋向上态的能量为 $-\\lambda_v$，自旋向下态为 $+\\lambda_v$。自旋态的顺序是相反的，这是谷对比自旋构型的标志。分裂的大小 $2\\lambda_v$ 在两个谷中保持相同。\n\n### 步骤4：对 $\\mathrm{MoS}_{2}$ 和 $\\mathrm{WS}_{2}$ 的数值计算\n\n使用推导的表达式 $\\Delta_v(K) = 2\\lambda_v$ 和所提供的参数：\n\n- 对于 $\\mathrm{MoS}_{2}$：$\\lambda_{v}^{\\mathrm{MoS}_{2}} = 75\\ \\mathrm{meV}$\n$$\n\\Delta_{v}(K)_{\\mathrm{MoS}_{2}} = 2 \\times 75\\ \\mathrm{meV} = 150\\ \\mathrm{meV}\n$$\n四舍五入到四位有效数字得到 $150.0\\ \\mathrm{meV}$。\n\n- 对于 $\\mathrm{WS}_{2}$：$\\lambda_{v}^{\\mathrm{WS}_{2}} = 215\\ \\mathrm{meV}$\n$$\n\\Delta_{v}(K)_{\\mathrm{WS}_{2}} = 2 \\times 215\\ \\mathrm{meV} = 430\\ \\mathrm{meV}\n$$\n四舍五入到四位有效数字得到 $430.0\\ \\mathrm{meV}$。\n\n### 步骤5：定性趋势\n\n原子自旋轨道耦合的强度随原子序数 ($Z$) 急剧增加，对于类氢原子大致为 $Z^4$，对于多电子原子则增长稍缓。过渡金属钼 (Mo, $Z=42$) 和钨 (W, $Z=74$) 位于元素周期表的同一族，但W处于更高的周期，并且重得多。有效SOC参数 $\\lambda_v$ 与微观原子SOC强度成正比。因此，在含有较重过渡金属的TMD中，自旋分裂 $\\Delta_v(K)$ 要大得多。定性趋势是，对于给定的硫属元素 $\\mathrm{X}$，$\\mathrm{WX}_{2}$ 中价带的自旋分裂远大于 $\\mathrm{MoX}_{2}$ 中的分裂。我们的计算证实了这一点：$\\Delta_v(\\mathrm{WS}_2) = 430.0 \\ \\mathrm{meV} > \\Delta_v(\\mathrm{MoS}_2) = 150.0 \\ \\mathrm{meV}$。", "answer": "$$\\boxed{\\begin{pmatrix} 150.0 & 430.0 \\end{pmatrix}}$$", "id": "3022332"}, {"introduction": "为了在理论和实验之间建立桥梁，物理学家常常构建能抓住核心物理的简化模型。本练习将带您进入计算凝聚态物理的核心实践：通过拟合“第一性原理”能带数据来构建一个最小紧束缚（tight-binding）模型。您将通过一个编程任务，模拟基于投影的瓦尼尔化（Wannierization）过程，不仅学习如何建立哈密顿量并拟合参数，更重要的是，学会如何利用晶格的对称性来验证所得参数的物理真实性，这是从复杂计算中提炼物理洞见的必要技能 [@problem_id:3022373]。", "problem": "构建、拟合和验证一个最小的过渡金属硫族化合物紧束缚模型，方法是在一个简化的、考虑对称性的设置中模拟基于投影的Wannier化。您将处理一个二维六方单层材料，其点群对称性与三棱柱配位一致。使用一个最小的轨道组分，包含一个以金属为中心的轨道和两个面内以硫族元素为中心的轨道，以及一个受三重旋转对称性约束的最近邻金属-硫族耦合。所有能量必须以电子伏特 (eV) 为单位处理，所有晶体动量必须以弧度为单位处理，点积也以弧度计算。最终输出中不需要其他物理单位。\n\n从以下基础出发：\n- 对于周期性晶格，Bloch定理意味着单粒子哈密顿量在晶体动量基下可以分解为各个独立的晶体动量，其哈密顿量矩阵 $H(\\mathbf{k})$ 的本征值给出在 $\\mathbf{k}$ 处的能带能量。\n- 在紧束缚表示中，$H(\\mathbf{k})$ 是实空间跃迁振幅的傅里叶变换，晶格的对称性操作约束了在位项和跃迁项。\n- 对于具有三棱柱配位和面外镜面对称性的单层过渡金属二硫族化合物，两个面内类$p$硫族轨道作为一个二维不可约表示进行变换，这导致了在高对称性极限下在位能的简并，并禁止了在位混合，而三个最近邻金属-硫族跃迁在三重旋转下是等效的。\n\n模型说明：\n- 使用一组基，包含一个以金属为中心的轨道 $d$ 和两个以硫族元素为中心的轨道 $p_x$ 和 $p_y$，记为 $\\{d,p_x,p_y\\}$。在晶体动量 $\\mathbf{k}=(k_x,k_y)$ 处的紧束缚哈密顿量为\n$$\nH(\\mathbf{k})=\\begin{pmatrix}\n\\varepsilon_d & h_x(\\mathbf{k}) & h_y(\\mathbf{k})\\\\\nh_x(\\mathbf{k}) & \\varepsilon_p & u\\\\\nh_y(\\mathbf{k}) & u & \\varepsilon_p\n\\end{pmatrix},\n$$\n其中 $\\varepsilon_d$ 和 $\\varepsilon_p$ 是在位能，$u$ 是 $p_x$ 和 $p_y$ 之间的在位混合项，而 $h_x(\\mathbf{k}),h_y(\\mathbf{k})$ 源于最近邻金属-硫族跃迁。\n- 设三个最近邻金属到硫族元素的化学键方向为单位矢量\n$$\n\\boldsymbol{\\delta}_1=(1,0),\\quad \\boldsymbol{\\delta}_2=\\left(-\\tfrac{1}{2},\\tfrac{\\sqrt{3}}{2}\\right),\\quad \\boldsymbol{\\delta}_3=\\left(-\\tfrac{1}{2},-\\tfrac{\\sqrt{3}}{2}\\right).\n$$\n定义与这些化学键相关的三个独立的实数跃迁振幅 $t_1,t_2,t_3$。令 $\\hat{\\mathbf{e}}_i=\\boldsymbol{\\delta}_i$ 表示沿化学键 $i\\in\\{1,2,3\\}$ 的单位矢量。使用时间反演对称、空间反演偶的约定来表示非对角耦合项：\n$$\nh_x(\\mathbf{k})=\\sum_{i=1}^{3} t_i\\,(\\hat{\\mathbf{e}}_i)_x \\cos(\\mathbf{k}\\cdot \\boldsymbol{\\delta}_i),\\quad\nh_y(\\mathbf{k})=\\sum_{i=1}^{3} t_i\\,(\\hat{\\mathbf{e}}_i)_y \\cos(\\mathbf{k}\\cdot \\boldsymbol{\\delta}_i).\n$$\n- 对于给定的参数集 $\\Theta=\\{\\varepsilon_d,\\varepsilon_p,u,t_1,t_2,t_3\\}$，合成的“第一性原理”能带是在一组预设的晶体动量上 $H(\\mathbf{k})$ 的排序后的本征值。\n\n通过拟合实现Wannier化的任务：\n- 通过估计最小紧束缚参数 $\\tilde{\\Theta}$ 来模拟基于投影的Wannier化，这些参数要能在一组 $\\mathbf{k}$ 点上再现目标能带。使用非线性最小二乘法，最小化在每个 $\\mathbf{k}$ 点上模型能带能量与目标能带能量之差的平方和。\n- 拟合后，提取估计的最近邻跃迁振幅 $\\tilde{t}_1,\\tilde{t}_2,\\tilde{t}_3$ 和在位混合项 $\\tilde{u}$。\n\n对称性验证：\n- 对于一个理想的三角（trigonal）环境，三重旋转对称性强制要求 $t_1=t_2=t_3$，并且在位硫族二重态在原子位置上没有对称性允许的混合，因此 $u=0$。通过检查以下条件，在数值容差 $\\tau=\\;0.01\\;\\text{eV}$ 内验证拟合参数是否符合这些预期：\n$$\n\\max\\big(|\\tilde{t}_1-\\bar{t}|,|\\tilde{t}_2-\\bar{t}|,|\\tilde{t}_3-\\bar{t}|\\big)\\le \\tau,\\quad |\\tilde{u}|\\le \\tau,\n$$\n其中 $\\bar{t}=(\\tilde{t}_1+\\tilde{t}_2+\\tilde{t}_3)/3$。\n\n晶体动量采样：\n- 使用以下九个 $\\mathbf{k}$ 点集，所有角度均以弧度为单位：\n$$\n\\begin{aligned}\n&\\mathbf{k}_1=(0,0),\\quad \\mathbf{k}_2=\\left(\\tfrac{2\\pi}{3},0\\right),\\quad \\mathbf{k}_3=(\\pi,0),\\\\\n&\\mathbf{k}_4=\\left(\\tfrac{\\pi}{2},\\tfrac{\\pi}{2\\sqrt{3}}\\right),\\quad \\mathbf{k}_5=\\left(\\tfrac{2\\pi}{3},\\tfrac{2\\pi}{3\\sqrt{3}}\\right),\\quad \\mathbf{k}_6=\\left(-\\tfrac{2\\pi}{3},\\tfrac{2\\pi}{3\\sqrt{3}}\\right),\\\\\n&\\mathbf{k}_7=\\left(0,\\tfrac{2\\pi}{\\sqrt{3}}\\right),\\quad \\mathbf{k}_8=\\left(\\tfrac{\\pi}{3},\\tfrac{\\pi}{\\sqrt{3}}\\right),\\quad \\mathbf{k}_9=\\left(\\pi,\\tfrac{\\pi}{\\sqrt{3}}\\right).\n\\end{aligned}\n$$\n\n测试套件：\n- 对于以下每种情况，将所列参数视为用于生成合成目标能带的“真实”参数 $\\Theta$。拟合程序应从一个通用的初始猜测值开始，返回一组拟合参数 $\\tilde{\\Theta}$，然后执行上述的对称性验证。为每种情况报告一个布尔值，指示对称性验证是否通过。\n- 情况A（理想路径，对称）：$\\varepsilon_d=1.5\\;\\text{eV}$，$\\varepsilon_p=-1.0\\;\\text{eV}$， $u=0.0\\;\\text{eV}$， $t_1=t_2=t_3=1.2\\;\\text{eV}$。\n- 情况B（对称性破缺的各向异性）：$\\varepsilon_d=1.5\\;\\text{eV}$，$\\varepsilon_p=-1.0\\;\\text{eV}$， $u=0.0\\;\\text{eV}$， $t_1=1.2\\;\\text{eV}$， $t_2=0.9\\;\\text{eV}$， $t_3=1.35\\;\\text{eV}$。\n- 情况C（近似对称，在容差范围内）：$\\varepsilon_d=1.5\\;\\text{eV}$，$\\varepsilon_p=-1.0\\;\\text{eV}$， $u=0.0\\;\\text{eV}$， $t_1=1.2\\;\\text{eV}$， $t_2=1.205\\;\\text{eV}$， $t_3=1.195\\;\\text{eV}$。\n- 情况D（边界情况，近简并的在位能）：$\\varepsilon_d=0.0\\;\\text{eV}$，$\\varepsilon_p=0.0\\;\\text{eV}$， $u=0.0\\;\\text{eV}$， $t_1=t_2=t_3=0.8\\;\\text{eV}$。\n\n目标与输出：\n- 您的程序必须对每种情况，在九个 $\\mathbf{k}$ 点上生成合成的目标能带，通过最小化所有 $\\mathbf{k}$ 点和所有三条能带的总能带能量失配平方和来拟合最小紧束缚参数，使用 $\\tau=\\;0.01\\;\\text{eV}$ 的容差验证拟合参数是否符合对称性预期，并为每种情况返回一个布尔值，指示对称性验证是否通过。\n- 最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，例如 [$\\text{True}$,$\\text{False}$,$\\text{True}$,$\\text{True}$]。不应打印任何额外文本。", "solution": "该问题要求构建和验证一个用于单层过渡金属二硫族化合物的最小紧束缚模型。这包括生成合成的能带结构数据，将模型参数与此数据进行拟合，然后根据晶体对称性的预期来验证拟合后的参数。此过程将针对四个不同的测试用例进行。\n\n### 步骤1：模型哈密顿量的构建\n\n该系统是一个具有与三棱柱配位一致的点群对称性的二维六方单层。最小紧束缚模型是基于一个包含三个轨道的基组构建的：一个以金属为中心的轨道（表示为 $d$）和两个面内以硫族元素为中心的轨道（表示为 $p_x$ 和 $p_y$）。基的顺序为 $\\{d, p_x, p_y\\}$。\n\n在晶体动量（$\\mathbf{k}$-空间）表示中，对于给定的晶体动量 $\\mathbf{k}=(k_x, k_y)$，其哈密顿量是一个 $3 \\times 3$ 的矩阵：\n$$\nH(\\mathbf{k}) = \\begin{pmatrix}\n\\varepsilon_d & h_x(\\mathbf{k}) & h_y(\\mathbf{k}) \\\\\nh_x(\\mathbf{k})^* & \\varepsilon_p & u \\\\\nh_y(\\mathbf{k})^* & u & \\varepsilon_p\n\\end{pmatrix}\n$$\n模型的参数包括在位能 $\\varepsilon_d$ 和 $\\varepsilon_p$，$p_x$ 和 $p_y$ 轨道之间的在位混合参数 $u$，以及三个最近邻金属-硫族跃迁振幅 $t_1$, $t_2$, 和 $t_3$。这六个参数的集合表示为 $\\Theta = \\{\\varepsilon_d, \\varepsilon_p, u, t_1, t_2, t_3\\}$。由于问题指定了时间反演对称、空间反演偶的约定，非对角跃迁项是实数，即 $h(\\mathbf{k})^* = h(\\mathbf{k})$。因此哈密顿量矩阵是实对称的。\n\n非对角项 $h_x(\\mathbf{k})$ 和 $h_y(\\mathbf{k})$ 分别表示 $d$ 轨道与 $p_x$ 和 $p_y$ 轨道之间的总跃迁振幅。它们是通过对三个最近邻金属-硫族化学键求和来计算的。化学键矢量如下：\n$$\n\\boldsymbol{\\delta}_1 = (1, 0), \\quad \\boldsymbol{\\delta}_2 = \\left(-\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right), \\quad \\boldsymbol{\\delta}_3 = \\left(-\\frac{1}{2}, -\\frac{\\sqrt{3}}{2}\\right)\n$$\n跃迁项由实空间跃迁积分的傅里叶变换定义，并受对称性约束。问题指定了以下形式：\n$$\nh_x(\\mathbf{k}) = \\sum_{i=1}^{3} t_i \\, (\\hat{\\mathbf{e}}_i)_x \\cos(\\mathbf{k} \\cdot \\boldsymbol{\\delta}_i)\n$$\n$$\nh_y(\\mathbf{k}) = \\sum_{i=1}^{3} t_i \\, (\\hat{\\mathbf{e}}_i)_y \\cos(\\mathbf{k} \\cdot \\boldsymbol{\\delta}_i)\n$$\n其中 $\\hat{\\mathbf{e}}_i = \\boldsymbol{\\delta}_i$ 是沿化学键方向的单位矢量。代入 $\\boldsymbol{\\delta}_i$ 的分量可得：\n$$\nh_x(\\mathbf{k}) = t_1 \\cos(k_x) - \\frac{1}{2} t_2 \\cos\\left(-\\frac{k_x}{2} + \\frac{\\sqrt{3}k_y}{2}\\right) - \\frac{1}{2} t_3 \\cos\\left(-\\frac{k_x}{2} - \\frac{\\sqrt{3}k_y}{2}\\right)\n$$\n$$\nh_y(\\mathbf{k}) = \\frac{\\sqrt{3}}{2} t_2 \\cos\\left(-\\frac{k_x}{2} + \\frac{\\sqrt{3}k_y}{2}\\right) - \\frac{\\sqrt{3}}{2} t_3 \\cos\\left(-\\frac{k_x}{2} - \\frac{\\sqrt{3}k_y}{2}\\right)\n$$\n\n### 步骤2：能带结构计算与参数拟合\n\n对于给定的参数集 $\\Theta$，电子能带能量 $E_n(\\mathbf{k})$ （其中 $n=1,2,3$）是哈密顿量矩阵 $H(\\mathbf{k})$ 的本征值。由于 $H(\\mathbf{k})$ 是一个 $3 \\times 3$ 的实对称矩阵，其本征值总是实数，并且可以使用数值特征值求解器高效地找到。我们将实现一个函数，用于计算任何给定 $\\mathbf{k}$ 和 $\\Theta$ 的这些本征值。\n\n核心任务是通过拟合模型参数来模拟基于投影的Wannier化。这涉及一个非线性最小二乘优化。对于每个测试用例，都提供一个“真实”的参数集 $\\Theta_{\\text{true}}$。\n\n1.  **生成目标数据**：首先，我们生成“合成的第一性原理”能带结构。这是通过计算问题陈述中提供的九个特定晶体动量 $\\mathbf{k}_j$ 的能带能量 $E_n^{\\text{target}}(\\mathbf{k}_j) = \\text{eigvals}(H(\\mathbf{k}_j; \\Theta_{\\text{true}}))$ 来完成的。对每个 $\\mathbf{k}_j$ 的本征值进行排序，以确保比较的一致性。\n\n2.  **定义代价函数**：我们寻求一组新的参数 $\\tilde{\\Theta}$，以最佳地再现目标能带结构。拟合的质量由模型能带与目标能带之间的残差平方和来衡量：\n    $$\n    S(\\tilde{\\Theta}) = \\sum_{j=1}^{9} \\sum_{n=1}^{3} \\left( E_n^{\\text{model}}(\\mathbf{k}_j; \\tilde{\\Theta}) - E_n^{\\text{target}}(\\mathbf{k}_j) \\right)^2\n    $$\n    最小化此代价函数是一个非线性最小二乘问题。\n\n3.  **数值优化**：我们使用 `scipy.optimize.least_squares` 函数，它非常适合这类问题。它需要一个计算残差向量 $r_{jn} = E_n^{\\text{model}}(\\mathbf{k}_j; \\tilde{\\Theta}) - E_n^{\\text{target}}(\\mathbf{k}_j)$ 的函数。然后，该算法从一个初始猜测值开始，迭代调整 $\\tilde{\\Theta}$ 以最小化 $\\sum r_{jn}^2$。将使用一个通用的参数初始猜测值 $\\tilde{\\Theta}$ 来开始拟合过程。\n\n### 步骤3：对称性验证\n\n在优化收敛到一组拟合参数 $\\tilde{\\Theta} = \\{\\tilde{\\varepsilon}_d, \\tilde{\\varepsilon}_p, \\tilde{u}, \\tilde{t}_1, \\tilde{t}_2, \\tilde{t}_3\\}$ 后，我们必须根据从对称性推导出的物理预期对它们进行验证。对于具有理想三棱柱配位（点群 $D_{3h}$）的结构，三重旋转对称轴意味着三个最近邻跃迁参数必须相等，即 $t_1 = t_2 = t_3$。此外，硫族元素位点上的 $p_x$ 和 $p_y$ 轨道形成一个二维不可约表示（$E'$），这禁止哈密顿量中存在任何在位混合项 $u$；因此，$u=0$。\n\n验证过程检查拟合参数是否在给定的数值容差 $\\tau = 0.01\\;\\text{eV}$ 内遵循这些对称性约束。两个条件如下：\n\n1.  **跃迁各向同性**：各个跃迁参数与其平均值的偏差必须很小。设 $\\bar{t} = (\\tilde{t}_1 + \\tilde{t}_2 + \\tilde{t}_3) / 3$。条件是：\n    $$\n    \\max\\left(|\\tilde{t}_1 - \\bar{t}|, |\\tilde{t}_2 - \\bar{t}|, |\\tilde{t}_3 - \\bar{t}|\\right) \\le \\tau\n    $$\n\n2.  **在位混合**：拟合的在位混合参数 $\\tilde{u}$ 必须接近于零：\n    $$\n    |\\tilde{u}| \\le \\tau\n    $$\n\n只有当两个条件都满足时，测试用例才算通过验证。最终输出是针对四个指定的测试用例中的每一个的布尔值（`True` 或 `False`），指示此验证的结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Solves the Wannierization-by-fitting problem for four test cases.\n    For each case, it generates target bands, fits the TB model parameters,\n    and validates them against symmetry expectations.\n    \"\"\"\n    \n    # Define physical and problem-specific constants\n    SQRT3 = np.sqrt(3)\n    PI = np.pi\n    TOLERANCE = 0.01\n\n    # Define the nearest-neighbor bond vectors\n    DELTAS = np.array([\n        [1.0, 0.0],\n        [-0.5, SQRT3 / 2.0],\n        [-0.5, -SQRT3 / 2.0]\n    ])\n\n    # Define the set of nine k-points for band structure sampling\n    K_POINTS = np.array([\n        [0.0, 0.0],\n        [2 * PI / 3, 0.0],\n        [PI, 0.0],\n        [PI / 2, PI / (2 * SQRT3)],\n        [2 * PI / 3, 2 * PI / (3 * SQRT3)],\n        [-2 * PI / 3, 2 * PI / (3 * SQRT3)],\n        [0.0, 2 * PI / SQRT3],\n        [PI / 3, PI / SQRT3],\n        [PI, PI / SQRT3]\n    ])\n\n    def calculate_all_bands(params, k_points_array):\n        \"\"\"\n        Calculates band energies for a given set of parameters and k-points.\n        Args:\n            params (list or np.array): The 6 model parameters [eps_d, eps_p, u, t1, t2, t3].\n            k_points_array (np.array): Array of k-points, shape (N_k, 2).\n        Returns:\n            np.array: A flattened array of sorted band energies for all k-points.\n        \"\"\"\n        eps_d, eps_p, u, t1, t2, t3 = params\n        ts = np.array([t1, t2, t3])\n\n        num_k_points = k_points_array.shape[0]\n        num_bands = 3\n        all_bands = np.zeros((num_k_points, num_bands))\n\n        # Vectorized calculation of k dot delta\n        k_dot_deltas = k_points_array @ DELTAS.T  # Shape: (num_k_points, 3)\n        cos_vals = np.cos(k_dot_deltas)\n\n        # Vectorized calculation of h_x and h_y over all k-points\n        h_x_contribs = ts * DELTAS[:, 0]\n        h_y_contribs = ts * DELTAS[:, 1]\n        h_x_all = cos_vals @ h_x_contribs\n        h_y_all = cos_vals @ h_y_contribs\n\n        # Construct and diagonalize Hamiltonian for each k-point\n        for i in range(num_k_points):\n            h_x, h_y = h_x_all[i], h_y_all[i]\n            H_k = np.array([\n                [eps_d,  h_x,   h_y],\n                [h_x,    eps_p, u],\n                [h_y,    u,     eps_p]\n            ])\n            # np.linalg.eigh returns sorted eigenvalues for Hermitian matrices\n            eigenvalues = np.linalg.eigh(H_k)[0]\n            all_bands[i, :] = eigenvalues\n            \n        return all_bands.flatten()\n\n    def residuals(params, target_bands_flat, k_points_array):\n        \"\"\"\n        Calculates the residuals between model and target bands for the optimizer.\n        \"\"\"\n        model_bands_flat = calculate_all_bands(params, k_points_array)\n        return model_bands_flat - target_bands_flat\n\n    def perform_fit(true_params):\n        \"\"\"\n        Generates target data and performs the nonlinear least-squares fit.\n        \"\"\"\n        # 1. Generate target data from \"true\" parameters\n        target_bands = calculate_all_bands(true_params, K_POINTS)\n        \n        # 2. Set up a generic initial guess for the parameters\n        initial_guess = [1.0, -0.5, 0.1, 1.0, 1.0, 1.0]\n\n        # 3. Perform the least-squares optimization\n        result = least_squares(residuals, initial_guess, args=(target_bands, K_POINTS))\n        \n        return result.x\n\n    def validate_symmetry(fitted_params):\n        \"\"\"\n        Checks if the fitted parameters satisfy the symmetry conditions.\n        \"\"\"\n        u_tilde = fitted_params[2]\n        t_tilde = np.array(fitted_params[3:])\n\n        # Condition 1: On-site mixing u should be close to zero\n        u_check = np.abs(u_tilde) <= TOLERANCE\n        \n        # Condition 2: Hopping parameters t_i should be nearly equal\n        t_bar = np.mean(t_tilde)\n        t_deviations = np.abs(t_tilde - t_bar)\n        t_check = np.max(t_deviations) <= TOLERANCE\n        \n        return u_check and t_check\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        # Case A (happy path, symmetric):\n        {'params': [1.5, -1.0, 0.0, 1.2, 1.2, 1.2]},\n        # Case B (symmetry-broken anisotropy):\n        {'params': [1.5, -1.0, 0.0, 1.2, 0.9, 1.35]},\n        # Case C (near-symmetric, within tolerance):\n        {'params': [1.5, -1.0, 0.0, 1.2, 1.205, 1.195]},\n        # Case D (edge case, near-degenerate on-sites):\n        {'params': [0.0, 0.0, 0.0, 0.8, 0.8, 0.8]},\n    ]\n    \n    results = []\n    for case in test_cases:\n        true_parameters = case['params']\n        fitted_parameters = perform_fit(true_parameters)\n        symmetry_valid = validate_symmetry(fitted_parameters)\n        results.append(symmetry_valid)\n        \n    # Format the final output as a comma-separated list of booleans in brackets\n    # Using map(str, ...) and .capitalize() for 'True'/'False' required by problem\n    formatted_results = [str(r).capitalize() for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3022373"}]}