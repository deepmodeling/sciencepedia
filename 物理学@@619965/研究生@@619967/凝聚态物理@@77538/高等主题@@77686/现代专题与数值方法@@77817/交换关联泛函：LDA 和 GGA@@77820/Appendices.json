{"hands_on_practices": [{"introduction": "在密度泛函理论中，一个基本技能是理解交换相关能量泛函 $E_{xc}[n]$ 与交换相关势 $v_{xc}(\\mathbf{r})$ 之间的联系。本练习将引导您完成从给定的局域密度近似（LDA）相关能量密度 $\\varepsilon_c(r_s)$ 推导出相应相关势 $v_c^{\\text{LDA}}$ 的核心数学步骤。掌握这种泛函微分对于理解密度泛函理论计算的构建至关重要。[@problem_id:2987547]", "problem": "考虑 Kohn–Sham 密度泛函理论 (DFT)，其中局域密度近似 (LDA) 内的相关能由泛函 $$E_{c}^{\\text{LDA}}[n]=\\int d^{3}r\\,n(\\mathbf{r})\\,\\varepsilon_{c}\\!\\left(r_{s}(n(\\mathbf{r}))\\right),$$ 建模，其中 Wigner–Seitz 半径在原子单位中定义为 $$r_{s}(n)=\\left(\\frac{3}{4\\pi n}\\right)^{1/3}.$$ LDA 相关势由泛函导数 $$v_{c}^{\\text{LDA}}(\\mathbf{r})=\\frac{\\delta E_{c}^{\\text{LDA}}[n]}{\\delta n(\\mathbf{r})}$$ 给出。假设存在均匀电子气，使得 $n(\\mathbf{r})=n_{0}$ 为常数，并考虑每个电子的相关能（以原子单位 Hartree 表示）的以下参数化形式：$$\\varepsilon_{c}(r_{s})=-\\frac{\\alpha}{1+\\beta r_{s}+\\gamma r_{s}^{2}},$$ 其中 $\\alpha=0.08$, $\\beta=0.9$ 且 $\\gamma=0.1$。从以上定义出发，仅使用标准微积分和泛函微分，推导 $v_{c}^{\\text{LDA}}$ 作为 $n$ 的函数的表达式，然后计算其在密度对应于 $r_s=2$ 时的值。以 Hartree 为单位表示最终能量。将答案四舍五入至四位有效数字。", "solution": "本问题要求在 Kohn-Sham 密度泛函理论 (DFT) 的局域密度近似 (LDA) 框架下，推导并计算相关势 $v_{c}^{\\text{LDA}}$。出发点是相关能泛函的定义以及作为其泛函导数的相关势。\n\n相关能泛函由下式给出：\n$$E_{c}^{\\text{LDA}}[n]=\\int d^{3}r\\,n(\\mathbf{r})\\,\\varepsilon_{c}\\!\\left(r_{s}(n(\\mathbf{r}))\\right)$$\n其中 $n(\\mathbf{r})$ 是电子密度，$\\varepsilon_{c}$ 是均匀电子气中每个粒子的相关能。$\\varepsilon_{c}$ 是 Wigner-Seitz 半径 $r_s$ 的函数，而 $r_s$ 本身又是局域密度的函数：\n$$r_{s}(n)=\\left(\\frac{3}{4\\pi n}\\right)^{1/3}$$\n相关势定义为相关能对电子密度的泛函导数：\n$$v_{c}^{\\text{LDA}}(\\mathbf{r})=\\frac{\\delta E_{c}^{\\text{LDA}}[n]}{\\delta n(\\mathbf{r})}$$\n为了计算这个导数，我们使用泛函导数的链式法则。被积函数是局域密度 $n(\\mathbf{r}')$ 的函数，即 $f(n(\\mathbf{r}')) = n(\\mathbf{r}') \\varepsilon_{c}(r_s(n(\\mathbf{r}')))$。对于一个具有一般形式 $F[n] = \\int f(n(\\mathbf{r}')) d^3r'$ 的泛函，其泛函导数为 $\\frac{\\delta F[n]}{\\delta n(\\mathbf{r})} = \\frac{d f(n)}{dn}\\big|_{n=n(\\mathbf{r})}$。\n因此，相关势由能量密度项 $n\\varepsilon_{c}$ 对 $n$ 的普通导数给出：\n$$v_{c}^{\\text{LDA}}(n(\\mathbf{r})) = \\frac{d}{dn} \\left[ n\\,\\varepsilon_{c}(r_s(n)) \\right]_{n=n(\\mathbf{r})}$$\n使用乘法法则求导，我们得到：\n$$v_{c}^{\\text{LDA}}(n) = \\frac{d(n)}{dn}\\varepsilon_{c}(r_s(n)) + n \\frac{d}{dn}\\left[\\varepsilon_{c}(r_s(n))\\right]$$\n$$v_{c}^{\\text{LDA}}(n) = \\varepsilon_{c}(r_s(n)) + n \\frac{d\\varepsilon_{c}}{dr_{s}}\\frac{dr_{s}}{dn}$$\n接下来，我们必须求出 $r_s$ 关于 $n$ 的导数：\n$$r_{s}(n) = \\left(\\frac{3}{4\\pi}\\right)^{1/3} n^{-1/3}$$\n$$\\frac{dr_{s}}{dn} = \\left(\\frac{3}{4\\pi}\\right)^{1/3} \\left(-\\frac{1}{3} n^{-4/3}\\right) = -\\frac{1}{3} \\left(\\frac{3}{4\\pi n}\\right)^{1/3} \\frac{1}{n} = -\\frac{r_{s}}{3n}$$\n将此结果代回到 $v_{c}^{\\text{LDA}}(n)$ 的表达式中：\n$$v_{c}^{\\text{LDA}}(n) = \\varepsilon_{c}(r_s(n)) + n \\frac{d\\varepsilon_{c}}{dr_{s}} \\left(-\\frac{r_{s}}{3n}\\right)$$\n这可以简化为用 $\\varepsilon_{c}(r_s)$ 及其导数表示的 LDA 相关势的通用表达式。由于 $r_s$ 是 $n$ 的唯一函数，我们可以将该势表示为 $r_s$ 的函数：\n$$v_{c}^{\\text{LDA}}(r_s) = \\varepsilon_{c}(r_s) - \\frac{r_s}{3}\\frac{d\\varepsilon_{c}}{dr_{s}}$$\n问题给出了 $\\varepsilon_{c}(r_s)$ 的一个特定参数化形式：\n$$\\varepsilon_{c}(r_{s})=-\\frac{\\alpha}{1+\\beta r_{s}+\\gamma r_{s}^{2}} = -\\alpha(1+\\beta r_{s}+\\gamma r_{s}^{2})^{-1}$$\n我们计算它关于 $r_s$ 的导数：\n$$\\frac{d\\varepsilon_{c}}{dr_{s}} = -\\alpha(-1)(1+\\beta r_{s}+\\gamma r_{s}^{2})^{-2} \\frac{d}{dr_s}(1+\\beta r_{s}+\\gamma r_{s}^{2})$$\n$$\\frac{d\\varepsilon_{c}}{dr_{s}} = \\frac{\\alpha(\\beta + 2\\gamma r_{s})}{(1+\\beta r_{s}+\\gamma r_{s}^{2})^2}$$\n现在，我们将 $\\varepsilon_{c}(r_s)$ 及其导数代入 $v_{c}^{\\text{LDA}}(r_s)$ 的表达式中：\n$$v_{c}^{\\text{LDA}}(r_s) = -\\frac{\\alpha}{1+\\beta r_{s}+\\gamma r_{s}^{2}} - \\frac{r_s}{3} \\left[ \\frac{\\alpha(\\beta + 2\\gamma r_{s})}{(1+\\beta r_{s}+\\gamma r_{s}^{2})^2} \\right]$$\n这就是所要求的相关势作为 $r_s$ 的函数的表达式，并可通过 $r_{s}(n)=(3/(4\\pi n))^{1/3}$ 进一步表示为 $n$ 的函数。\n\n最后一步是在给定参数 $\\alpha=0.08, \\beta=0.9, \\gamma=0.1$ 以及在对应于 $r_s=2$ 的密度下，计算该表达式的值。\n\n首先，我们计算分母项 $D = 1+\\beta r_{s}+\\gamma r_{s}^{2}$ 在 $r_s=2$ 时的值：\n$$D = 1 + (0.9)(2) + (0.1)(2^2) = 1 + 1.8 + 0.1(4) = 1 + 1.8 + 0.4 = 3.2$$\n现在，我们计算 $v_{c}^{\\text{LDA}}(r_s=2)$ 的两个项：\n第一项是 $\\varepsilon_{c}(r_s=2)$：\n$$\\varepsilon_{c}(r_s=2) = -\\frac{\\alpha}{D} = -\\frac{0.08}{3.2} = -0.025 \\, \\text{Hartree}$$\n第二项是 $-\\frac{r_s}{3}\\frac{d\\varepsilon_{c}}{dr_{s}}$ 在 $r_s=2$ 时的值：\n$$-\\frac{r_s}{3}\\frac{d\\varepsilon_{c}}{dr_{s}} = -\\frac{2}{3} \\left[ \\frac{\\alpha(\\beta + 2\\gamma r_{s})}{D^2} \\right]_{r_s=2}$$\n方括号内的分子是：\n$$\\alpha(\\beta + 2\\gamma(2)) = 0.08(0.9 + 2(0.1)(2)) = 0.08(0.9+0.4) = 0.08(1.3) = 0.104$$\n分母是 $D^2 = (3.2)^2 = 10.24$。\n所以，第二项是：\n$$-\\frac{2}{3} \\left( \\frac{0.104}{10.24} \\right) = -\\frac{0.208}{30.72} \\approx -0.006770833... \\, \\text{Hartree}$$\n总的相关势是这两项的和：\n$$v_{c}^{\\text{LDA}}(r_s=2) = -0.025 - 0.006770833... = -0.031770833... \\, \\text{Hartree}$$\n将结果四舍五入到四位有效数字，我们得到 $-0.03177$。", "answer": "$$\\boxed{-0.03177}$$", "id": "2987547"}, {"introduction": "评估密度泛函的一个关键方面是了解它们的内在局限性。本练习通过将局域密度近似（LDA）应用于一个简单的单电子系统（其精确行为已知），为您提供了一个具体且定量的机会来审视自相互作用误差（SIE）。这是一个非常著名的 LDA 和 GGA 的缺陷，理解它有助于您更批判性地使用这些工具。[@problem_id:2987515]", "problem": "三维空间中的单电子密度由一个归一化的高斯函数 $n(\\mathbf{r}) = N \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\exp\\!\\left(-\\alpha r^{2}\\right)$ 建模，其中 $N=1$，而 $\\alpha>0$ 设定了局域化尺度。在原子单位制下进行计算，因此电子电荷大小、约化普朗克常数和电子质量均为1。将系统视为完全自旋极化，因此自旋向上密度为 $n_{\\uparrow}(\\mathbf{r})=n(\\mathbf{r})$，自旋向下密度为 $n_{\\downarrow}(\\mathbf{r})=0$。\n\n从哈特里（经典库仑）能量和自旋相关的局域密度近似（LDA）中的交换能的实空间定义出发，\n- 哈特里能量 $E_{H}[n]$ 由 $E_{H}[n] = \\frac{1}{2}\\int d^{3}r \\int d^{3}r' \\frac{n(\\mathbf{r})\\, n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}$ 给出，\n- 且对于完全自旋极化的密度，LDA交换能为 $E_{x}^{\\mathrm{LDA}}[n_{\\uparrow},n_{\\downarrow}] = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\int d^{3}r\\, n_{\\uparrow}(\\mathbf{r})^{4/3}$，\n\n推导出 $E_{H}$ 和 $E_{x}^{\\mathrm{LDA}}$ 关于 $\\alpha$ 的闭合形式表达式。利用单电子的精确交换能抵消哈特里能量这一事实，即 $E_{x}^{\\mathrm{exact}}=-E_{H}$，将LDA交换能的自相互作用误差定义为 $S(\\alpha) \\equiv E_{H} + E_{x}^{\\mathrm{LDA}}$，并确定其如何随 $\\alpha$ 变化。\n\n答案要求：\n- 将您的最终答案表示为 $S(\\alpha)$ 的单一闭合形式解析表达式，仅包含 $\\alpha$ 和数学常数。\n- 最终答案中不包含单位。无需进行数值四舍五入。", "solution": "单电子密度由 $n(\\mathbf{r}) = \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\exp(-\\alpha r^2)$ 给出，其中使用了归一化系数 $N=1$。系统是完全自旋极化的，因此 $n_{\\uparrow}(\\mathbf{r}) = n(\\mathbf{r})$ 且 $n_{\\downarrow}(\\mathbf{r}) = 0$。我们在原子单位制下进行计算。\n\n首先，我们计算哈特里能量 $E_H[n]$，其定义为：\n$$E_{H}[n] = \\frac{1}{2}\\int d^{3}r \\int d^{3}r' \\frac{n(\\mathbf{r})\\, n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}$$\n该表达式是一个卷积。在傅里叶空间中计算最为简便。密度 $n(\\mathbf{r})$ 的傅里叶变换为 $\\tilde{n}(\\mathbf{k}) = \\int d^3r\\, n(\\mathbf{r})e^{-i\\mathbf{k}\\cdot\\mathbf{r}}$。归一化的三维高斯函数 $n(\\mathbf{r}) = (\\frac{\\alpha}{\\pi})^{3/2}\\exp(-\\alpha r^2)$ 的傅里叶变换是：\n$$\\tilde{n}(\\mathbf{k}) = \\exp\\left(-\\frac{k^2}{4\\alpha}\\right)$$\n其中 $k=|\\mathbf{k}|$。库仑核 $\\frac{1}{|\\mathbf{r}|}$ 的傅里叶变换是 $\\frac{4\\pi}{k^2}$。利用卷积定理和帕塞瓦尔定理，哈特里能量可以在k空间中表示为：\n$$E_{H} = \\frac{1}{2} \\int \\frac{d^3k}{(2\\pi)^3} |\\tilde{n}(\\mathbf{k})|^2 \\left(\\frac{4\\pi}{k^2}\\right) = \\frac{2\\pi}{(2\\pi)^3} \\int d^3k \\frac{|\\tilde{n}(\\mathbf{k})|^2}{k^2}$$\n代入 $\\tilde{n}(\\mathbf{k})$ 的表达式：\n$$E_{H} = \\frac{1}{4\\pi^2} \\int d^3k \\frac{\\left|\\exp\\left(-\\frac{k^2}{4\\alpha}\\right)\\right|^2}{k^2} = \\frac{1}{4\\pi^2} \\int d^3k \\frac{\\exp\\left(-\\frac{k^2}{2\\alpha}\\right)}{k^2}$$\n被积函数是球对称的，因此我们在k空间中使用球坐标进行积分（$d^3k = 4\\pi k^2 dk$）：\n$$E_{H} = \\frac{1}{4\\pi^2} \\int_0^\\infty 4\\pi k^2 dk \\frac{\\exp\\left(-\\frac{k^2}{2\\alpha}\\right)}{k^2} = \\frac{1}{\\pi} \\int_0^\\infty \\exp\\left(-\\frac{k^2}{2\\alpha}\\right) dk$$\n这是一个标准的高斯积分，其形式为 $\\int_0^\\infty \\exp(-ax^2)dx = \\frac{1}{2}\\sqrt{\\frac{\\pi}{a}}$。此处，$a = \\frac{1}{2\\alpha}$。\n$$E_{H} = \\frac{1}{\\pi} \\left(\\frac{1}{2}\\sqrt{\\frac{\\pi}{1/(2\\alpha)}}\\right) = \\frac{1}{2\\pi}\\sqrt{2\\pi\\alpha} = \\sqrt{\\frac{2\\pi\\alpha}{4\\pi^2}} = \\sqrt{\\frac{\\alpha}{2\\pi}}$$\n因此，哈特里能量为 $E_{H} = \\left(\\frac{\\alpha}{2\\pi}\\right)^{1/2}$。\n\n接下来，我们计算在局域密度近似（LDA）下的交换能，根据问题中对完全自旋极化体系的定义：\n$$E_{x}^{\\mathrm{LDA}}[n_{\\uparrow}, n_{\\downarrow}] = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\int d^{3}r\\, n_{\\uparrow}(\\mathbf{r})^{4/3}$$\n由于 $n_{\\uparrow}(\\mathbf{r}) = n(\\mathbf{r})$，我们首先计算 $n(\\mathbf{r})^{4/3}$ 项：\n$$n(\\mathbf{r})^{4/3} = \\left[ \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\exp(-\\alpha r^2) \\right]^{4/3} = \\left(\\frac{\\alpha}{\\pi}\\right)^2 \\exp\\left(-\\frac{4}{3}\\alpha r^2\\right)$$\n现在我们在球坐标系下计算积分 $\\int d^3r\\, n(\\mathbf{r})^{4/3}$：\n$$\\int d^3r\\, n(\\mathbf{r})^{4/3} = \\int_0^\\infty 4\\pi r^2 dr \\left(\\frac{\\alpha}{\\pi}\\right)^2 \\exp\\left(-\\frac{4}{3}\\alpha r^2\\right) = 4\\pi\\left(\\frac{\\alpha}{\\pi}\\right)^2 \\int_0^\\infty r^2 \\exp\\left(-\\frac{4}{3}\\alpha r^2\\right) dr$$\n使用标准积分 $\\int_0^\\infty x^2 e^{-ax^2}dx = \\frac{1}{4}\\sqrt{\\frac{\\pi}{a^3}}$，其中 $a=\\frac{4\\alpha}{3}$：\n$$\\int_0^\\infty r^2 \\exp\\left(-\\frac{4\\alpha}{3} r^2\\right) dr = \\frac{1}{4}\\sqrt{\\frac{\\pi}{(4\\alpha/3)^3}} = \\frac{1}{4}\\sqrt{\\frac{27\\pi}{64\\alpha^3}} = \\frac{3\\sqrt{3\\pi}}{32\\alpha^{3/2}}$$\n将此结果代回到 $n^{4/3}$ 的积分中：\n$$\\int d^3r\\, n(\\mathbf{r})^{4/3} = 4\\pi\\frac{\\alpha^2}{\\pi^2} \\left(\\frac{3\\sqrt{3\\pi}}{32\\alpha^{3/2}}\\right) = \\frac{4\\alpha^2}{\\pi} \\frac{3\\cdot 3^{1/2}\\pi^{1/2}}{32\\alpha^{3/2}} = \\frac{12 \\cdot 3^{1/2} \\alpha^{1/2}}{32 \\pi^{1/2}} = \\frac{3 \\cdot 3^{1/2} \\alpha^{1/2}}{8 \\pi^{1/2}} = \\frac{3^{3/2}}{8} \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2}$$\n现在，我们可以得到LDA交换能：\n$$E_{x}^{\\mathrm{LDA}} = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\left[ \\frac{3^{3/2}}{8} \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2} \\right] = -\\frac{3^1 \\cdot 3^{1/3} \\cdot 3^{3/2}}{4 \\cdot 8} \\frac{\\alpha^{1/2}}{\\pi^{1/3}\\pi^{1/2}}$$\n合并 $3$ 和 $\\pi$ 的指数：\n$$1 + \\frac{1}{3} + \\frac{3}{2} = \\frac{6+2+9}{6} = \\frac{17}{6}$$\n$$\\frac{1}{3} + \\frac{1}{2} = \\frac{2+3}{6} = \\frac{5}{6}$$\n$$E_{x}^{\\mathrm{LDA}} = -\\frac{3^{17/6}}{32} \\frac{\\alpha^{1/2}}{\\pi^{5/6}} = -\\frac{3^{17/6}}{32\\pi^{5/6}} \\alpha^{1/2}$$\n自相互作用误差 $S(\\alpha)$ 定义为 $S(\\alpha) = E_{H} + E_{x}^{\\mathrm{LDA}}$。\n$$S(\\alpha) = \\left(\\frac{\\alpha}{2\\pi}\\right)^{1/2} - \\frac{3^{17/6}}{32\\pi^{5/6}} \\alpha^{1/2} = \\left( \\frac{1}{(2\\pi)^{1/2}} - \\frac{3^{17/6}}{32\\pi^{5/6}} \\right) \\alpha^{1/2}$$\n此表达式表明自相互作用误差随 $\\alpha^{1/2}$ 变化。为了给出一个单一的闭合形式表达式，我们将各项通分合并：\n$$E_{H} = \\frac{\\alpha^{1/2}}{2^{1/2}\\pi^{1/2}} = \\frac{16 \\cdot 2^{1/2} \\pi^{1/3}}{32\\pi^{5/6}}\\alpha^{1/2}$$\n与 $E_x^{\\mathrm{LDA}}$ 合并：\n$$S(\\alpha) = \\frac{16 \\cdot 2^{1/2} \\pi^{1/3}\\alpha^{1/2} - 3^{17/6}\\alpha^{1/2}}{32\\pi^{5/6}} = \\frac{(16 \\cdot 2^{1/2} \\pi^{1/3} - 3^{17/6})\\alpha^{1/2}}{32\\pi^{5/6}}$$\n这就是自相互作用误差 $S(\\alpha)$ 的最终闭合形式表达式。", "answer": "$$\\boxed{\\left( \\frac{16 \\cdot 2^{1/2} \\pi^{1/3} - 3^{17/6}}{32\\pi^{5/6}} \\right) \\alpha^{1/2}}$$", "id": "2987515"}, {"introduction": "从理论走向实际应用，本练习模拟了计算材料科学中的一项常见任务：对不同泛函的性能进行基准测试。通过分析一组关于固体材料内聚能的假设计算数据，您将学习如何量化 LDA 的典型误差（如过结合）和 GGA 的修正效果，并探索这些误差如何与材料的电子密度（以 $r_s$ 表征）等物理性质相关联。这项实践有助于您理解在实际研究中如何选择和评估一个合适的泛函。[@problem_id:2987552]", "problem": "给定一组单原子固体，其参考内聚能由高水平基准计算得出，同时还给出了由密度泛函理论 (DFT) 中的两种交换相关近似——局域密度近似 (LDA) 和广义梯度近似 (GGA)——预测的内聚能。对于每种固体，您还会得到价电子密度参数 $r_s$（对应于价电子密度的 Wigner-Seitz 半径，以玻尔半径为单位）。\n\n从 Kohn-Sham 密度泛函理论 (DFT) 的基础出发，每个原子的内聚能定义为固体中每个原子的总能量与孤立原子的能量之差，两者均使用相同的近似方法计算。交换相关贡献在 LDA 中是局域近似，或在 GGA 中包含密度梯度。您的任务是计算每种固体在 LDA 和 GGA 下内聚能相对于参考值的相对误差，然后量化这些误差随价电子密度参数 $r_s$ 变化的趋势。\n\n定义和要求：\n- 对于每种固体，一种方法的内聚能相对误差定义为 $$\\varepsilon = \\frac{E_{\\text{method}} - E_{\\text{ref}}}{E_{\\text{ref}}},$$ 其中 $E_{\\text{ref}}$ 是每个原子的参考内聚能，$E_{\\text{method}}$ 是来自 LDA 或 GGA 的每个原子的内聚能。\n- 一组 $r_s$ 值和一组相对误差 $\\varepsilon$ 之间的皮尔逊相关系数必须使用以下公式计算：$$\\rho = \\frac{\\sum_{i=1}^{N} (r_s^{(i)} - \\bar{r}_s)(\\varepsilon^{(i)} - \\bar{\\varepsilon})}{\\sqrt{\\left[\\sum_{i=1}^{N} (r_s^{(i)} - \\bar{r}_s)^2\\right]\\left[\\sum_{i=1}^{N} (\\varepsilon^{(i)} - \\bar{\\varepsilon})^2\\right]}},$$ 其中 $\\bar{r}_s$ 和 $\\bar{\\varepsilon}$ 分别是 $r_s$ 和 $\\varepsilon$ 的样本均值。\n- $\\varepsilon$ 对 $r_s$ 的线性拟合的最小二乘斜率必须计算为 $$m = \\frac{\\sum_{i=1}^{N} (r_s^{(i)} - \\bar{r}_s)(\\varepsilon^{(i)} - \\bar{\\varepsilon})}{\\sum_{i=1}^{N} (r_s^{(i)} - \\bar{r}_s)^2}.$$\n- 应为每种方法提供一个单调趋势指示符：如果斜率 $m$ 为正（表示误差随 $r_s$ 呈增加趋势），则返回 $\\,\\texttt{True}\\,$，否则返回 $\\,\\texttt{False}\\,$。\n\n使用以下包含 $N=5$ 种单原子固体的测试集。所有内聚能的单位均为电子伏特/原子，而 $r_s$ 以玻尔为单位，是无量纲的。程序应将这些视为精确输入，无需进行任何单位转换。所选值在科学上是合理的，并覆盖了一定范围的 $r_s$：\n- 固体 1：$r_s = 3.25$, $E_{\\text{ref}} = 1.63$, $E_{\\text{LDA}} = 1.95$, $E_{\\text{GGA}} = 1.55$。\n- 固体 2：$r_s = 3.93$, $E_{\\text{ref}} = 1.13$, $E_{\\text{LDA}} = 1.35$, $E_{\\text{GGA}} = 1.05$。\n- 固体 3：$r_s = 2.07$, $E_{\\text{ref}} = 3.39$, $E_{\\text{LDA}} = 4.05$, $E_{\\text{GGA}} = 3.36$。\n- 固体 4：$r_s = 2.01$, $E_{\\text{ref}} = 4.63$, $E_{\\text{LDA}} = 5.30$, $E_{\\text{GGA}} = 4.60$。\n- 固体 5：$r_s = 4.96$, $E_{\\text{ref}} = 0.93$, $E_{\\text{LDA}} = 1.10$, $E_{\\text{GGA}} = 0.85$。\n\n您的程序必须：\n1.  计算 LDA 的相对误差列表 $$\\{\\varepsilon_{\\text{LDA}}^{(i)}\\}_{i=1}^{5},$$ 和 GGA 的相对误差列表 $$\\{\\varepsilon_{\\text{GGA}}^{(i)}\\}_{i=1}^{5}.$$\n2.  计算 $r_s$ 与相应误差列表之间的皮尔逊相关系数 $\\rho_{\\text{LDA}}$ 和 $\\rho_{\\text{GGA}}$。\n3.  计算误差对 $r_s$ 线性拟合的最小二乘斜率 $m_{\\text{LDA}}$ 和 $m_{\\text{GGA}}$。\n4.  计算每种方法的单调趋势布尔值，定义为如果 $m > 0$ 则为 $\\,\\texttt{True}\\,$，如果 $m \\le 0$ 则为 $\\,\\texttt{False}\\,$。\n\n角度单位不适用。将所有计算出的浮点数输出四舍五入到六位小数。最终输出格式必须是单行，包含一个用方括号括起来的逗号分隔列表，结构如下：\n$$[\\,[\\varepsilon_{\\text{LDA}}^{(1)},\\ldots,\\varepsilon_{\\text{LDA}}^{(5)}],\\,[\\varepsilon_{\\text{GGA}}^{(1)},\\ldots,\\varepsilon_{\\text{GGA}}^{(5)}],\\,\\rho_{\\text{LDA}},\\,m_{\\text{LDA}},\\,\\rho_{\\text{GGA}},\\,m_{\\text{GGA}},\\,\\texttt{monotonic\\_LDA},\\,\\texttt{monotonic\\_GGA}\\,],$$\n其中每个 $\\varepsilon$、$\\rho$ 和 $m$ 都是四舍五入到六位小数的浮点数，而单调性指示符是布尔值。\n\n此设计包括一般情况和边缘多样性，覆盖了低 $r_s$ 和高 $r_s$ 的固体以及一定范围的内聚能，测试了分别是 LDA 和 GGA 预期的过结合和欠结合两种情况。您的程序应生成具有确切输出格式的指定单行。", "solution": "我们的目标是通过量化两种常见的交换相关泛函——局域密度近似 (LDA) 和广义梯度近似 (GGA)——在预测一组单原子固体的内聚能时相对于基准参考值的误差，来分析它们的性能。然后，我们将研究这个误差是否随价电子密度（以 Wigner-Seitz 半径 $r_s$ 表征）表现出系统性趋势。\n\n解决方案分为三个主要步骤：\n1.  计算每种固体和每种方法的相对误差。\n2.  对误差作为 $r_s$ 的函数进行统计分析，包括计算最小二乘斜率和皮尔逊相关系数。\n3.  将结果组合成指定的输出格式。\n\n提供的 $N=5$ 种固体的数据如下：\n- 固体 1：$r_s^{(1)}=3.25$, $E_{\\text{ref}}^{(1)}=1.63$, $E_{\\text{LDA}}^{(1)}=1.95$, $E_{\\text{GGA}}^{(1)}=1.55$\n- 固体 2：$r_s^{(2)}=3.93$, $E_{\\text{ref}}^{(2)}=1.13$, $E_{\\text{LDA}}^{(2)}=1.35$, $E_{\\text{GGA}}^{(2)}=1.05$\n- 固体 3：$r_s^{(3)}=2.07$, $E_{\\text{ref}}^{(3)}=3.39$, $E_{\\text{LDA}}^{(3)}=4.05$, $E_{\\text{GGA}}^{(3)}=3.36$\n- 固体 4：$r_s^{(4)}=2.01$, $E_{\\text{ref}}^{(4)}=4.63$, $E_{\\text{LDA}}^{(4)}=5.30$, $E_{\\text{GGA}}^{(4)}=4.60$\n- 固体 5：$r_s^{(5)}=4.96$, $E_{\\text{ref}}^{(5)}=0.93$, $E_{\\text{LDA}}^{(5)}=1.10$, $E_{\\text{GGA}}^{(5)}=0.85$\n\n所有能量单位均为 eV/原子， $r_s$ 是无量纲的。\n\n**步骤 1：计算相对误差**\n\n对于给定的方法（LDA 或 GGA）和特定的固体 $i$，相对误差 $\\varepsilon$ 定义为：\n$$ \\varepsilon^{(i)} = \\frac{E_{\\text{method}}^{(i)} - E_{\\text{ref}}^{(i)}}{E_{\\text{ref}}^{(i)}} $$\n正误差表示高估了内聚能（过结合），而负误差表示低估了内聚能（欠结合）。\n\n对于 LDA：\n- $\\varepsilon_{\\text{LDA}}^{(1)} = (1.95 - 1.63) / 1.63 \\approx 0.196319$\n- $\\varepsilon_{\\text{LDA}}^{(2)} = (1.35 - 1.13) / 1.13 \\approx 0.194690$\n- $\\varepsilon_{\\text{LDA}}^{(3)} = (4.05 - 3.39) / 3.39 \\approx 0.194690$\n- $\\varepsilon_{\\text{LDA}}^{(4)} = (5.30 - 4.63) / 4.63 \\approx 0.144708$\n- $\\varepsilon_{\\text{LDA}}^{(5)} = (1.10 - 0.93) / 0.93 \\approx 0.182796$\nLDA 相对误差的列表是 $\\{\\varepsilon_{\\text{LDA}}^{(i)}\\} = [0.196319, 0.194690, 0.194690, 0.144708, 0.182796]$。\n\n对于 GGA：\n- $\\varepsilon_{\\text{GGA}}^{(1)} = (1.55 - 1.63) / 1.63 \\approx -0.049080$\n- $\\varepsilon_{\\text{GGA}}^{(2)} = (1.05 - 1.13) / 1.13 \\approx -0.070796$\n- $\\varepsilon_{\\text{GGA}}^{(3)} = (3.36 - 3.39) / 3.39 \\approx -0.008850$\n- $\\varepsilon_{\\text{GGA}}^{(4)} = (4.60 - 4.63) / 4.63 \\approx -0.006479$\n- $\\varepsilon_{\\text{GGA}}^{(5)} = (0.85 - 0.93) / 0.93 \\approx -0.086022$\nGGA 相对误差的列表是 $\\{\\varepsilon_{\\text{GGA}}^{(i)}\\} = [-0.049080, -0.070796, -0.008850, -0.006479, -0.086022]$。\n\n正如 DFT 中已知的趋势所预期的那样，LDA 一致地高估了内聚能，而 GGA 提供了一种修正，在此案例中导致了轻微的低估。\n\n**步骤 2：统计分析**\n\n我们现在计算相对误差 $\\varepsilon$ 和 Wigner-Seitz 半径 $r_s$ 之间线性关系的最小二乘斜率 $m$ 和皮尔逊相关系数 $\\rho$。公式如下：\n$$ m = \\frac{\\sum_{i=1}^{N} (r_s^{(i)} - \\bar{r}_s)(\\varepsilon^{(i)} - \\bar{\\varepsilon})}{\\sum_{i=1}^{N} (r_s^{(i)} - \\bar{r}_s)^2} $$\n$$ \\rho = \\frac{\\sum_{i=1}^{N} (r_s^{(i)} - \\bar{r}_s)(\\varepsilon^{(i)} - \\bar{\\varepsilon})}{\\sqrt{\\left[\\sum_{i=1}^{N} (r_s^{(i)} - \\bar{r}_s)^2\\right]\\left[\\sum_{i=1}^{N} (\\varepsilon^{(i)} - \\bar{\\varepsilon})^2\\right]}} $$\n令 $x_i = r_s^{(i)}$ 和 $y_i = \\varepsilon^{(i)}$。两个表达式中的分子是偏差乘积的和，$S_{xy} = \\sum_{i=1}^{N} (x_i - \\bar{x})(y_i - \\bar{y})$。斜率的分母是 $x$ 的平方偏差和，$S_{xx} = \\sum_{i=1}^{N} (x_i - \\bar{x})^2$，而相关系数的分母是 $\\sqrt{S_{xx} S_{yy}}$，其中 $S_{yy} = \\sum_{i=1}^{N} (y_i - \\bar{y})^2$。\n\n首先，我们计算 $r_s$ 数据的样本均值和平方和，这对 LDA 和 GGA 的分析都是通用的。\n$r_s$ 值的集合是 $\\{3.25, 3.93, 2.07, 2.01, 4.96\\}$。\n均值为 $\\bar{r}_s = (3.25 + 3.93 + 2.07 + 2.01 + 4.96) / 5 = 3.244$。\n平方偏差和是 $S_{xx} = \\sum_{i=1}^{5} (r_s^{(i)} - \\bar{r}_s)^2 \\approx 6.31632$。\n\n**对 LDA 的分析：**\n- 均相对误差为 $\\bar{\\varepsilon}_{\\text{LDA}} \\approx 0.182641$。\n- 偏差乘积的和为 $S_{xy, \\text{LDA}} = \\sum (r_s^{(i)} - \\bar{r}_s)(\\varepsilon_{\\text{LDA}}^{(i)} - \\bar{\\varepsilon}_{\\text{LDA}}) \\approx 0.041277$。\n- 误差的平方偏差和为 $S_{yy, \\text{LDA}} = \\sum (\\varepsilon_{\\text{LDA}}^{(i)} - \\bar{\\varepsilon}_{\\text{LDA}})^2 \\approx 0.001916$。\n\nLDA 的斜率为：\n$$ m_{\\text{LDA}} = \\frac{S_{xy, \\text{LDA}}}{S_{xx}} \\approx \\frac{0.041277}{6.31632} \\approx 0.006535 $$\n由于 $m_{\\text{LDA}} > 0$，LDA 的单调趋势指示符为 $\\texttt{True}$。\n\nLDA 的皮尔逊相关系数为：\n$$ \\rho_{\\text{LDA}} = \\frac{S_{xy, \\text{LDA}}}{\\sqrt{S_{xx} S_{yy, \\text{LDA}}}} \\approx \\frac{0.041277}{\\sqrt{6.31632 \\times 0.001916}} \\approx 0.375179 $$\n这个小的正相关表明 LDA 误差有随 $r_s$ 增大的微弱趋势。\n\n**对 GGA 的分析：**\n- 均相对误差为 $\\bar{\\varepsilon}_{\\text{GGA}} \\approx -0.044245$。\n- 偏差乘积的和为 $S_{xy, \\text{GGA}} = \\sum (r_s^{(i)} - \\bar{r}_s)(\\varepsilon_{\\text{GGA}}^{(i)} - \\bar{\\varepsilon}_{\\text{GGA}}) \\approx -0.178085$。\n- 误差的平方偏差和为 $S_{yy, \\text{GGA}} = \\sum (\\varepsilon_{\\text{GGA}}^{(i)} - \\bar{\\varepsilon}_{\\text{GGA}})^2 \\approx 0.005153$。\n\nGGA 的斜率为：\n$$ m_{\\text{GGA}} = \\frac{S_{xy, \\text{GGA}}}{S_{xx}} \\approx \\frac{-0.178085}{6.31632} \\approx -0.028197 $$\n由于 $m_{\\text{GGA}}  0$，GGA 的单调趋势指示符为 $\\texttt{False}$。\n\nGGA 的皮尔逊相关系数为：\n$$ \\rho_{\\text{GGA}} = \\frac{S_{xy, \\text{GGA}}}{\\sqrt{S_{xx} S_{yy, \\text{GGA}}}} \\approx \\frac{-0.178085}{\\sqrt{6.31632 \\times 0.005153}} \\approx -0.987156 $$\n强负相关（$\\rho$ 接近 -1）表明了一个清晰的趋势：随着 $r_s$ 的增加（即电子气密度降低），GGA 的内聚能被逐渐低估得更多。\n\n**步骤 3：最终结果组合**\n\n收集计算出的值并按要求格式化。所有浮点数都四舍五入到六位小数。\n\n- LDA 误差列表：$[0.196319, 0.194690, 0.194690, 0.144708, 0.182796]$\n- GGA 误差列表：$[-0.049080, -0.070796, -0.008850, -0.006479, -0.086022]$\n- $\\rho_{\\text{LDA}} \\approx 0.375179$\n- $m_{\\text{LDA}} \\approx 0.006535$\n- $\\rho_{\\text{GGA}} \\approx -0.987156$\n- $m_{\\text{GGA}} \\approx -0.028197$\n- LDA 的单调趋势：$\\texttt{True}$\n- GGA 的单调趋势：$\\texttt{False}$\n\n这些结果按照问题陈述中的规定，组合成一个单行字符串。", "answer": "`[[0.196319,0.194690,0.194690,0.144708,0.182796],[-0.049080,-0.070796,-0.008850,-0.006479,-0.086022],0.375179,0.006535,-0.987156,-0.028197,True,False]`", "id": "2987552"}]}