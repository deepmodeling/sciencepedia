{"hands_on_practices": [{"introduction": "理解一个新概念最好的方法，往往是从一个简单的、可解的例子入手。本练习正是为此而设计，它将带领我们分析一个仅包含四个自旋的微型系统。通过从第一性原理出发，你将亲手计算不同价键构型（valence bond configurations）的叠加（即“共振”）如何定量地改变自旋间的关联，这将为你深入理解共振价键（RVB）理论的物理精髓打下坚实的直觉基础。[@problem_id:3013864]", "problem": "考虑一个由4个自旋-$\\frac{1}{2}$自由度组成的系统，它们位于一个正方形的顶点上，并由格点 $1,2,3,4$ 按循环顺序标记。假设一个二分分解，子格为 $A=\\{1,3\\}$ 和 $B=\\{2,4\\}$。设两个最近邻价键覆盖为\n- 水平覆盖 $\\lvert h\\rangle=\\lvert s_{12}\\rangle\\otimes\\lvert s_{34}\\rangle$，\n- 垂直覆盖 $\\lvert v\\rangle=\\lvert s_{23}\\rangle\\otimes\\lvert s_{41}\\rangle$，\n其中格点 $i,j$ 上的自旋单态为 $\\lvert s_{ij}\\rangle=\\left(\\lvert\\uparrow_i\\downarrow_j\\rangle-\\lvert\\downarrow_i\\uparrow_j\\rangle\\right)/\\sqrt{2}$。\n\n定义等振幅共振价键 (RVB) 态\n$$\n\\lvert \\psi\\rangle=\\mathcal{N}\\left(\\lvert h\\rangle+\\lvert v\\rangle\\right),\n$$\n其中归一化因子 $\\mathcal{N}$ 的选择需满足 $\\langle\\psi\\vert\\psi\\rangle=1$。仅根据自旋-$\\frac{1}{2}$ 算符、单态和基本张量积结构的定义性质进行计算；不要先验地假设任何专门的交叠积分公式。\n\n从第一性原理出发，计算局域 Heisenberg 关联子 $\\,\\langle \\psi\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert\\psi\\rangle\\,$ 的精确期望值，其中 $\\mathbf{S}_i=\\left(S_i^x,S_i^y,S_i^z\\right)$ 是格点$i$上的自旋-$\\frac{1}{2}$算符。在您的推导中，明确指出由单一覆盖项和由 RVB 叠加产生的交叉项各自的贡献，并解释后者如何与长度为4的基本回路周围价键的重构相关联。\n\n请以单个精确数值的形式给出您的最终结果。无需四舍五入，答案不带物理单位。", "solution": "此问题要求计算一个位于$4$格点正方晶格上的共振价键 (RVB) 态的自旋-自旋关联函数。计算必须从第一性原理出发。\n\n该系统由四个自旋-$\\frac{1}{2}$粒子组成，位于按循环顺序标记的格点 $1, 2, 3, 4$ 上。\n两个最近邻价键 (VB) 覆盖由下式给出：\n水平覆盖：\n$$ \\lvert h\\rangle = \\lvert s_{12}\\rangle \\otimes \\lvert s_{34}\\rangle $$\n垂直覆盖：\n$$ \\lvert v\\rangle = \\lvert s_{23}\\rangle \\otimes \\lvert s_{41}\\rangle $$\n其中，格点 $i$ 和 $j$ 的自旋单态定义为：\n$$ \\lvert s_{ij}\\rangle = \\frac{1}{\\sqrt{2}} \\left( \\lvert\\uparrow_i\\downarrow_j\\rangle - \\lvert\\downarrow_i\\uparrow_j\\rangle \\right) $$\n等振幅 RVB 态是这两个覆盖的归一化叠加：\n$$ \\lvert \\psi\\rangle = \\mathcal{N}\\left(\\lvert h\\rangle+\\lvert v\\rangle\\right) $$\n归一化条件为 $\\langle\\psi\\vert\\psi\\rangle = 1$。\n\n首先，我们确定归一化常数 $\\mathcal{N}$。归一化条件展开为：\n$$ \\langle\\psi\\vert\\psi\\rangle = |\\mathcal{N}|^2 \\left( \\langle h\\vert h\\rangle + \\langle v\\vert v\\rangle + \\langle h\\vert v\\rangle + \\langle v\\vert h\\rangle \\right) = 1 $$\n根据定义，VB 覆盖是归一化的，所以 $\\langle h\\vert h\\rangle = 1$ 且 $\\langle v\\vert v\\rangle = 1$。我们必须计算交叠积分 $\\langle h\\vert v\\rangle$。为此，我们将两个态在计算基（记作 $|\\sigma_1\\sigma_2\\sigma_3\\sigma_4\\rangle$）中展开。\n\n水平态是：\n$$ \\lvert h\\rangle = \\frac{1}{\\sqrt{2}}\\left(\\lvert\\uparrow_1\\downarrow_2\\rangle - \\lvert\\downarrow_1\\uparrow_2\\rangle\\right) \\otimes \\frac{1}{\\sqrt{2}}\\left(\\lvert\\uparrow_3\\downarrow_4\\rangle - \\lvert\\downarrow_3\\uparrow_4\\rangle\\right) $$\n$$ \\lvert h\\rangle = \\frac{1}{2} \\left( \\lvert\\uparrow\\downarrow\\uparrow\\downarrow\\rangle - \\lvert\\uparrow\\downarrow\\downarrow\\uparrow\\rangle - \\lvert\\downarrow\\uparrow\\uparrow\\downarrow\\rangle + \\lvert\\downarrow\\uparrow\\downarrow\\uparrow\\rangle \\right) $$\n垂直态是：\n$$ \\lvert v\\rangle = \\frac{1}{\\sqrt{2}}\\left(\\lvert\\uparrow_2\\downarrow_3\\rangle - \\lvert\\downarrow_2\\uparrow_3\\rangle\\right) \\otimes \\frac{1}{\\sqrt{2}}\\left(\\lvert\\uparrow_4\\downarrow_1\\rangle - \\lvert\\downarrow_4\\uparrow_1\\rangle\\right) $$\n$$ \\lvert v\\rangle = \\frac{1}{2} \\left( \\lvert\\downarrow_1\\uparrow_2\\downarrow_3\\uparrow_4\\rangle - \\lvert\\uparrow_1\\uparrow_2\\downarrow_3\\downarrow_4\\rangle - \\lvert\\downarrow_1\\downarrow_2\\uparrow_3\\uparrow_4\\rangle + \\lvert\\uparrow_1\\downarrow_2\\uparrow_3\\downarrow_4\\rangle \\right) $$\n现在，我们计算内积 $\\langle h\\vert v\\rangle$。由于基态的正交性，只有具有相同自旋构型的项才能保留下来：\n$$ \\langle h\\vert v\\rangle = \\frac{1}{4} \\left( \\langle\\uparrow\\downarrow\\uparrow\\downarrow\\vert\\uparrow\\downarrow\\uparrow\\downarrow\\rangle + \\langle\\downarrow\\uparrow\\downarrow\\uparrow\\vert\\downarrow\\uparrow\\downarrow\\uparrow\\rangle \\right) = \\frac{1}{4} (1+1) = \\frac{1}{2} $$\n该交叠是实数，因此 $\\langle v\\vert h\\rangle = \\langle h\\vert v\\rangle^* = \\frac{1}{2}$。\n代入归一化条件：\n$$ |\\mathcal{N}|^2 \\left( 1 + 1 + \\frac{1}{2} + \\frac{1}{2} \\right) = |\\mathcal{N}|^2 (3) = 1 $$\n选择 $\\mathcal{N}$ 为实数和正数，我们得到 $\\mathcal{N} = \\frac{1}{\\sqrt{3}}$。\n\n接下来，我们计算期望值 $\\langle \\psi\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert\\psi\\rangle$。\n$$ \\langle \\psi\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert\\psi\\rangle = \\mathcal{N}^2 \\langle h+v\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert h+v\\rangle $$\n$$ = \\frac{1}{3} \\left( \\langle h\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert h\\rangle + \\langle v\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert v\\rangle + \\langle h\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert v\\rangle + \\langle v\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert h\\rangle \\right) $$\n由于 $\\mathbf{S}_1\\cdot \\mathbf{S}_2$ 是一个厄米算符，最后两项是互为复共轭的。这些态都是实数，所以矩阵元也是实数，且 $\\langle h\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert v\\rangle = \\langle v\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert h\\rangle$。\n$$ \\langle \\psi\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert\\psi\\rangle = \\frac{1}{3} \\left( \\langle h\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert h\\rangle + \\langle v\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert v\\rangle + 2\\langle h\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert v\\rangle \\right) $$\n我们分别计算每一项。\n\n1.  $\\lvert h\\rangle$ 的单一覆盖项：$\\langle h\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert h\\rangle$\n算符 $\\mathbf{S}_1\\cdot \\mathbf{S}_2$ 仅作用于格点 $1$ 和 $2$ 的希尔伯特空间上。\n一对自旋的总自旋是 $\\mathbf{S}_{ij} = \\mathbf{S}_i+\\mathbf{S}_j$，所以 $\\mathbf{S}_{ij}^2 = \\mathbf{S}_i^2+\\mathbf{S}_j^2+2\\mathbf{S}_i\\cdot\\mathbf{S}_j$。这给出 $\\mathbf{S}_i\\cdot \\mathbf{S}_j = \\frac{1}{2}(\\mathbf{S}_{ij}^2 - \\mathbf{S}_i^2 - \\mathbf{S}_j^2)$。\n对于一个自旋-$\\frac{1}{2}$ 粒子，$\\mathbf{S}_i^2$ 的本征值为 $s(s+1) = \\frac{1}{2}(\\frac{1}{2}+1) = \\frac{3}{4}$ (以 $\\hbar^2=1$ 为单位)。\n态 $\\lvert s_{12}\\rangle$ 是一个总自旋为 $S_{12}=0$ 的单态，因此 $\\mathbf{S}_{12}^2$ 的本征值为 $0$。\n因此，$\\mathbf{S}_1\\cdot \\mathbf{S}_2$ 作用于 $\\lvert s_{12}\\rangle$ 得到本征值 $\\frac{1}{2}(0 - \\frac{3}{4} - \\frac{3}{4}) = -\\frac{3}{4}$。\n$$ \\langle h\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert h\\rangle = \\langle s_{12}s_{34}\\vert (\\mathbf{S}_1\\cdot \\mathbf{S}_2 \\otimes I_{34})\\vert s_{12}s_{34}\\rangle = \\langle s_{12}\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert s_{12}\\rangle \\langle s_{34}\\vert s_{34}\\rangle = -\\frac{3}{4} \\times 1 = -\\frac{3}{4} $$\n\n2.  $\\lvert v\\rangle$ 的单一覆盖项：$\\langle v\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert v\\rangle$\n在态 $\\lvert v\\rangle = \\lvert s_{23}\\rangle\\otimes\\lvert s_{41}\\rangle$ 中，格点 $1$ 和 $2$ 不在同一个单态对中。我们必须直接进行计算。该算符为 $\\mathbf{S}_1\\cdot \\mathbf{S}_2=S_1^zS_2^z + \\frac{1}{2}(S_1^+S_2^- + S_1^-S_2^+)$。\n该态为 $\\lvert v\\rangle = \\frac{1}{2} \\left( \\lvert\\downarrow\\uparrow\\downarrow\\uparrow\\rangle - \\lvert\\uparrow\\uparrow\\downarrow\\downarrow\\rangle - \\lvert\\downarrow\\downarrow\\uparrow\\uparrow\\rangle + \\lvert\\uparrow\\downarrow\\uparrow\\downarrow\\rangle \\right)$。\n态 $|v\\rangle$ 的总自旋 $S_{tot}^z=0$ 并且在全局自旋翻转下不变，这保证了自旋旋转不变性。因此，$\\langle \\mathbf{S}_1\\cdot \\mathbf{S}_2\\rangle = 3\\langle S_1^zS_2^z\\rangle$。\n我们来计算 $\\langle v\\vert S_1^zS_2^z\\vert v\\rangle$。算符 $S_1^zS_2^z$ 在计算基中是对角的。\n$$ \\langle v\\vert S_1^zS_2^z\\vert v\\rangle = \\frac{1}{4} \\left[ (1)^2(-\\frac{1}{4}) + (-1)^2(\\frac{1}{4}) + (-1)^2(\\frac{1}{4}) + (1)^2(-\\frac{1}{4}) \\right] = \\frac{1}{4}\\left(-\\frac{1}{4}+\\frac{1}{4}+\\frac{1}{4}-\\frac{1}{4}\\right)=0 $$\n由于z分量关联为零，总关联也为零：\n$$ \\langle v\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert v\\rangle = 0 $$\n\n3.  交叉项：$2\\langle h\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert v\\rangle$\n这一项代表了两个覆盖之间的量子干涉。\n我们可以用算符作用于 $\\lvert h\\rangle$：\n$$ \\mathbf{S}_1\\cdot \\mathbf{S}_2 \\lvert h\\rangle = \\mathbf{S}_1\\cdot \\mathbf{S}_2 \\lvert s_{12}s_{34}\\rangle = (-\\frac{3}{4}) \\lvert s_{12}s_{34}\\rangle = -\\frac{3}{4} \\lvert h\\rangle $$\n所以该矩阵元变为：\n$$ \\langle h\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert v\\rangle = \\langle h \\vert -\\frac{3}{4} \\vert v \\rangle = -\\frac{3}{4} \\langle h\\vert v\\rangle $$\n使用我们之前计算的交叠 $\\langle h\\vert v\\rangle = \\frac{1}{2}$：\n$$ \\langle h\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert v\\rangle = -\\frac{3}{4} \\times \\frac{1}{2} = -\\frac{3}{8} $$\n这一项是实数，所以 $2\\langle h\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert v\\rangle = 2 \\times (-\\frac{3}{8}) = -\\frac{3}{4}$。\n\n这个交叉项的贡献从根本上与价键重构的能力相关联。该项的存在取决于非零的交叠 $\\langle h\\vert v\\rangle$，它量化了一种键构型在另一种上的投影。$\\lvert h\\rangle$ 和 $\\lvert v\\rangle$ 组合图的回路结构决定了这个交叠。算符 $\\mathbf{S}_1 \\cdot \\mathbf{S}_2$ 探测格点 $1$ 和 $2$ 之间的关联。交叉项衡量的是系统在这种探测相互作用下，在垂直和水平覆盖之间跃迁的振幅。由于 $\\lvert h\\rangle$ 是该算符的本征态，这个跃迁振幅与结构交叠 $\\langle h \\vert v \\rangle$ 成正比。\n\n最后, 我们汇总总期望值：\n$$ \\langle \\psi\\vert \\mathbf{S}_1\\cdot \\mathbf{S}_2\\vert\\psi\\rangle = \\frac{1}{3} \\left( \\left(-\\frac{3}{4}\\right) + (0) + \\left(-\\frac{3}{4}\\right) \\right) $$\n$$ = \\frac{1}{3} \\left( -\\frac{6}{4} \\right) = \\frac{1}{3} \\left( -\\frac{3}{2} \\right) = -\\frac{1}{2} $$\n各项贡献如下：\n-   来自 $\\lvert h\\rangle$ 覆盖（对角项）：加权贡献为 $\\frac{1}{3} \\times (-\\frac{3}{4}) = -\\frac{1}{4}$。\n-   来自 $\\lvert v\\rangle$ 覆盖（对角项）：加权贡献为 $\\frac{1}{3} \\times (0) = 0$。\n-   来自干涉（交叉项）：加权贡献为 $\\frac{1}{3} \\times (-\\frac{3}{4}) = -\\frac{1}{4}$。\n总和为 $-\\frac{1}{4} + 0 - \\frac{1}{4} = -\\frac{1}{2}$。", "answer": "$$ \\boxed{-\\frac{1}{2}} $$", "id": "3013864"}, {"introduction": "在掌握了基本图像后，我们来学习一种更强大、更通用的构建RVB态的方法——Gutzwiller投影的BCS波函数。本练习将运用这一更形式化的工具，重新审视之前遇到的四自旋系统。这个过程不仅会验证我们先前的计算结果，展示不同理论框架间的一致性，更重要的是，它将RVB理论与超导的BCS理论联系起来，并引出量子蒙特卡洛模拟中一个至关重要的问题——符号问题（sign problem）。[@problem_id:3013855]", "problem": "考虑一个自旋-$\\frac{1}{2}$的费米子系统，该系统位于一个由 $4$ 个格点（标记为 $1,2,3,4$）构成的周期性环上，其二分为 $A=\\{1,3\\}$ 和 $B=\\{2,4\\}$。定义一个实空间自旋单重态 Bardeen–Cooper–Schrieffer (BCS) 配对函数 $f_{ij}$，该函数仅在连接两个子格的最近邻键上非零，具体为 $f_{12}=f_{23}=f_{34}=f_{41}=\\Delta$ 且对所有 $i,j$ 满足 $f_{ji}=-f_{ij}$，在其他情况下 $f_{ij}=0$，其中 $\\Delta>0$ 为实数。半填充时的投影 BCS 共振价键 (RVB) 态为\n$$\n|\\Psi_{\\mathrm{RVB}}\\rangle=\\mathcal{P}_{G}\\left[\\sum_{i<j}f_{ij}\\left(c_{i\\uparrow}^{\\dagger}c_{j\\downarrow}^{\\dagger}-c_{i\\downarrow}^{\\dagger}c_{j\\uparrow}^{\\dagger}\\right)\\right]^{2}|0\\rangle,\n$$\n其中 $\\mathcal{P}_{G}$ 是 Gutzwiller 投影算符，它将系统投影到每个格点上恰好有一个电子的子空间上。\n\n使用针对投影 BCS 态的 Pfaffian 或行列式形式，并仅从二次量子化中的基本算符恒等式和定义出发，完成以下任务：\n\n1.  计算未归一化的模方 $\\langle\\Psi_{\\mathrm{RVB}}|\\Psi_{\\mathrm{RVB}}\\rangle$，将其表示为 $\\Delta$ 的显式函数。\n\n2.  在归一化 RVB 态中，计算最近邻自旋-自旋关联函数 $\\langle \\mathbf{S}_{1}\\cdot \\mathbf{S}_{2}\\rangle$，其中 $\\mathbf{S}_{i}$ 是格点 $i$ 上的自旋算符，且 $\\mathbf{S}_{i}\\cdot \\mathbf{S}_{j}=S_{i}^{x}S_{j}^{x}+S_{i}^{y}S_{j}^{y}+S_{i}^{z}S_{j}^{z}$。\n\n3.  基于 Pfaffian/行列式结构以及配对的二分特性，解释在一般二分晶格上对 $|\\Psi_{\\mathrm{RVB}}|^{2}$ 进行蒙特卡洛抽样且 $f_{ij}$ 为实数时，不存在符号问题的条件。\n\n请以关联函数 $\\langle \\mathbf{S}_{1}\\cdot \\mathbf{S}_{2}\\rangle$ 在归一化 RVB 态中的精确值作为最终答案（无单位，不四舍五入）。", "solution": "用户要求我分三部分解决一个关于一个 $4$ 格点环上的共振价键 (RVB) 态的问题，然后给出自旋-自旋关联函数的值。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n-   系统：一个自旋-$\\frac{1}{2}$ 费米子系统，位于一个由 $N=4$ 个格点（标记为 $1,2,3,4$）构成的周期性环上。\n-   二分：该晶格是二分的，子格为 $A=\\{1,3\\}$ 和 $B=\\{2,4\\}$。\n-   配对函数 $f_{ij}$：\n    -   实空间自旋单重态 BCS 配对，$f_{ji}=-f_{ij}$。\n    -   仅在连接两个子格的最近邻键上非零。\n    -   值：$f_{12}=f_{23}=f_{34}=f_{41}=\\Delta$，其中 $\\Delta>0$ 是一个实数。\n    -   所有其他元素为零（即 $f_{13}=f_{24}=0$）。\n-   态的定义：半填充（$N_e=4$ 个电子）时的投影 RVB 态由下式给出\n    $$|\\Psi_{\\mathrm{RVB}}\\rangle=\\mathcal{P}_{G}\\left[\\sum_{i<j}f_{ij}\\left(c_{i\\uparrow}^{\\dagger}c_{j\\downarrow}^{\\dagger}-c_{i\\downarrow}^{\\dagger}c_{j\\uparrow}^{\\dagger}\\right)\\right]^{2}|0\\rangle$$\n    其中 $\\mathcal{P}_{G}$ 是 Gutzwiller 投影算符，它将系统约束为每个格点恰好有一个电子。\n-   任务：\n    1.  计算未归一化的模方 $\\langle\\Psi_{\\mathrm{RVB}}|\\Psi_{\\mathrm{RVB}}\\rangle$，作为 $\\Delta$ 的函数。\n    2.  在归一化 RVB 态中计算最近邻自旋-自旋关联函数 $\\langle \\mathbf{S}_{1}\\cdot \\mathbf{S}_{2}\\rangle$。\n    3.  解释在一般二分晶格上对 $|\\Psi_{\\mathrm{RVB}}|^{2}$ 进行蒙特卡洛抽样且 $f_{ij}$ 为实数时，不存在符号问题的条件。\n-   最终答案要求：关联函数 $\\langle \\mathbf{S}_{1}\\cdot \\mathbf{S}_{2}\\rangle$ 的精确值。\n\n**第 2 步：使用提取的已知条件进行验证**\n-   **科学依据**：该问题在标准凝聚态理论中有坚实的基础。它涉及的概念，如二次量子化、Gutzwiller 投影、RVB 态和自旋关联，都是研究强关联电子系统的核心。Pfaffian/行列式形式是解决此类问题的标准技术。\n-   **良定性**：对于一个有限系统，其态和可观测量都有精确的定义。该问题是自洽的、数学上良定的，允许一个唯一的、可计算的解。\n-   **客观性**：问题以正式、客观的语言陈述，没有任何主观或模棱两可的术语。\n\n**第 3 步：结论与行动**\n问题是有效的。我将开始解题。\n\n### 第 1 部分：模的计算\n\n我们定义单重态对产生算符为 $b_{ij}^{\\dagger} = c_{i\\uparrow}^{\\dagger}c_{j\\downarrow}^{\\dagger}-c_{i\\downarrow}^{\\dagger}c_{j\\uparrow}^{\\dagger}$。未归一化的 RVB 态为\n$$|\\Psi_{\\mathrm{RVB}}\\rangle = \\mathcal{P}_{G} \\left(\\sum_{i<j} f_{ij} b_{ij}^{\\dagger}\\right)^2 |0\\rangle$$\nGutzwiller 投影 $\\mathcal{P}_{G}$ 确保每个格点有一个电子，这意味着任何项 $b_{ij}^{\\dagger}b_{kl}^{\\dagger}|0\\rangle$ 只有在格点 $\\{i,j,k,l\\}$ 全部不同时才能存活。对于我们的 $N=4$ 系统，这意味着 $\\{i,j,k,l\\}$ 必须是 $\\{1,2,3,4\\}$ 的一个排列。对键对 $(i,j)$ 和 $(k,l)$ 的求和简化为对四个格点划分为两对的所有方式的求和。\n非零配对为 $f_{12}=\\Delta$, $f_{23}=\\Delta$, $f_{34}=\\Delta$, $f_{41}=\\Delta$。我们还有 $f_{14}=-f_{41}=-\\Delta$ 和 $f_{32}=-f_{23}=-\\Delta$ 等。\n算符的展开式为：\n$$ \\left(\\sum_{i<j} f_{ij} b_{ij}^{\\dagger}\\right)^2 = \\sum_{i<j, k<l} f_{ij}f_{kl} b_{ij}^\\dagger b_{kl}^\\dagger $$\n通过投影，我们只对 $\\{1,2,3,4\\}$ 分成两对的划分进行求和：$\\{(1,2), (3,4)\\}$，$\\{(1,3), (2,4)\\}$ 和 $\\{(1,4), (2,3)\\}$。\n$$|\\Psi_{\\mathrm{RVB}}\\rangle = \\mathcal{P}_{G} \\left( f_{12}f_{34} b_{12}^\\dagger b_{34}^\\dagger + f_{13}f_{24} b_{13}^\\dagger b_{24}^\\dagger + f_{14}f_{23} b_{14}^\\dagger b_{23}^\\dagger \\right) |0\\rangle$$\n请注意，像 $(f_{12}b_{12}^\\dagger)(f_{34}b_{34}^\\dagger)$ 和 $(f_{34}b_{34}^\\dagger)(f_{12}b_{12}^\\dagger)$ 这样的对产生的因子 $2$ 已经通过对有序对的求和处理了。\n使用给定的 $f_{ij}$ 值：\n$f_{12}f_{34} = \\Delta \\cdot \\Delta = \\Delta^2$。\n$f_{13}f_{24} = 0 \\cdot 0 = 0$。\n$f_{14}f_{23} = (-\\Delta) \\cdot \\Delta = -\\Delta^2$。\n\n态变为：\n$$|\\Psi_{\\mathrm{RVB}}\\rangle = \\Delta^2 \\left( b_{12}^\\dagger b_{34}^\\dagger - b_{14}^\\dagger b_{23}^\\dagger \\right) |0\\rangle$$\n令 $|\\psi_1\\rangle = b_{12}^\\dagger b_{34}^\\dagger |0\\rangle$ 和 $|\\psi_2\\rangle = b_{14}^\\dagger b_{23}^\\dagger |0\\rangle$。这些是在不相交的格点集上未归一化单重态的乘积。\n模方为 $\\langle\\Psi_{\\mathrm{RVB}}|\\Psi_{\\mathrm{RVB}}\\rangle = \\Delta^4 \\langle \\psi_1 - \\psi_2 | \\psi_1 - \\psi_2 \\rangle$。\n$$ \\langle \\psi_1 - \\psi_2 | \\psi_1 - \\psi_2 \\rangle = \\langle\\psi_1|\\psi_1\\rangle + \\langle\\psi_2|\\psi_2\\rangle - 2 \\text{Re}\\langle\\psi_1|\\psi_2\\rangle $$\n一个未归一化单重态的模为 $\\langle b_{ij}^\\dagger | b_{ij}^\\dagger \\rangle = \\langle 0 | b_{ij}b_{ij}^\\dagger | 0 \\rangle = 2$。\n所以，$\\langle\\psi_1|\\psi_1\\rangle = \\langle b_{12}^\\dagger b_{34}^\\dagger | b_{12}^\\dagger b_{34}^\\dagger \\rangle = \\langle b_{12}^\\dagger | b_{12}^\\dagger \\rangle \\langle b_{34}^\\dagger | b_{34}^\\dagger \\rangle = 2 \\times 2 = 4$。\n类似地，$\\langle\\psi_2|\\psi_2\\rangle = 4$。\n两个二聚体覆盖之间的交叠项 $\\langle\\psi_1|\\psi_2\\rangle$ 可以使用归一化单重态 $|s_{ij}\\rangle = (1/\\sqrt{2})b_{ij}^{\\dagger}|0\\rangle$ 的恒等式来计算。\n$\\langle s_{ab}s_{cd}|s_{ad}s_{cb}\\rangle = -1/2$。\n这里 $|\\psi_1\\rangle = 2|s_{12}s_{34}\\rangle$ 和 $|\\psi_2\\rangle = 2|s_{14}s_{23}\\rangle = 2|s_{14}s_{32}\\rangle$。我们有 $\\langle s_{12}s_{34}|s_{14}s_{32}\\rangle$ 的结构，这对应于交换 c->d, d->c 的恒等式。由于 $|s_{32}\\rangle = -|s_{23}\\rangle$，这不会改变大小。交叠为 $\\langle\\psi_1|\\psi_2\\rangle = 4 \\langle s_{12}s_{34}|s_{14}s_{23}\\rangle = 4(-1/2) = -2$。\n所以，$\\langle \\psi_1 - \\psi_2 | \\psi_1 - \\psi_2 \\rangle = 4 + 4 - 2(-2) = 12$。\n未归一化的模方是 $\\langle\\Psi_{\\mathrm{RVB}}|\\Psi_{\\mathrm{RVB}}\\rangle = 12\\Delta^4$。\n\n### 第 2 部分：自旋-自旋关联函数\n\n归一化的态是 $|\\tilde{\\Psi}\\rangle = \\frac{1}{\\sqrt{12}\\Delta^2}|\\Psi_{\\mathrm{RVB}}\\rangle = \\frac{1}{\\sqrt{12}}(|\\psi_1\\rangle - |\\psi_2\\rangle)$。\n我们需要计算 $\\langle \\mathbf{S}_1 \\cdot \\mathbf{S}_2 \\rangle = \\langle \\tilde{\\Psi} | S_1^zS_2^z + \\frac{1}{2}(S_1^+S_2^- + S_1^-S_2^+) | \\tilde{\\Psi} \\rangle$。\n期望值为：\n$$ \\langle \\mathbf{S}_1 \\cdot \\mathbf{S}_2 \\rangle = \\frac{1}{12} \\langle \\psi_1 - \\psi_2 | \\mathbf{S}_1 \\cdot \\mathbf{S}_2 | \\psi_1 - \\psi_2 \\rangle $$\n$$ = \\frac{1}{12} \\left( \\langle\\psi_1|\\mathbf{S}_1 \\cdot \\mathbf{S}_2|\\psi_1\\rangle + \\langle\\psi_2|\\mathbf{S}_1 \\cdot \\mathbf{S}_2|\\psi_2\\rangle - 2\\text{Re}\\langle\\psi_1|\\mathbf{S}_1 \\cdot \\mathbf{S}_2|\\psi_2\\rangle \\right) $$\n1.  **第 1 项**：$\\langle\\psi_1|\\mathbf{S}_1 \\cdot \\mathbf{S}_2|\\psi_1\\rangle = \\langle b_{12}^\\dagger b_{34}^\\dagger | \\mathbf{S}_1 \\cdot \\mathbf{S}_2 | b_{12}^\\dagger b_{34}^\\dagger \\rangle$。由于 $\\mathbf{S}_1 \\cdot \\mathbf{S}_2$ 仅作用于格点 $1,2$，该项可分离：$\\langle b_{12}^\\dagger | \\mathbf{S}_1 \\cdot \\mathbf{S}_2 | b_{12}^\\dagger \\rangle \\langle b_{34}^\\dagger | b_{34}^\\dagger \\rangle$。因为 $|s_{12}\\rangle$ 是一个自旋单重态，所以 $\\mathbf{S}_1 \\cdot \\mathbf{S}_2 |s_{12}\\rangle = -\\frac{3}{4}|s_{12}\\rangle$。该算符作用于未归一化的态得到 $\\mathbf{S}_1 \\cdot \\mathbf{S}_2 |b_{12}^\\dagger\\rangle = -\\frac{3}{4}|b_{12}^\\dagger\\rangle$。\n    因此，$\\langle\\psi_1|\\mathbf{S}_1 \\cdot \\mathbf{S}_2|\\psi_1\\rangle = (-\\frac{3}{4}) \\langle b_{12}^\\dagger | b_{12}^\\dagger \\rangle \\langle b_{34}^\\dagger | b_{34}^\\dagger \\rangle = (-\\frac{3}{4}) \\cdot 2 \\cdot 2 = -3$。\n2.  **第 2 项**：$\\langle\\psi_2|\\mathbf{S}_1 \\cdot \\mathbf{S}_2|\\psi_2\\rangle = \\langle b_{14}^\\dagger b_{23}^\\dagger | \\mathbf{S}_1 \\cdot \\mathbf{S}_2 | b_{14}^\\dagger b_{23}^\\dagger \\rangle$。在态 $|\\psi_2\\rangle$ 中，格点 $1$ 和 $2$ 上的自旋是不相关的。$\\langle S_1^z S_2^z \\rangle = \\langle S_1^z \\rangle \\langle S_2^z \\rangle = 0 \\cdot 0 = 0$。类似地，自旋翻转项也为零。因此，$\\langle\\psi_2|\\mathbf{S}_1 \\cdot \\mathbf{S}_2|\\psi_2\\rangle = 0$。\n3.  **交叉项**：为了计算 $\\langle\\psi_1|\\mathbf{S}_1 \\cdot \\mathbf{S}_2|\\psi_2\\rangle$，我们可以使用单重态的重耦合恒等式。\n    $|s_{14}s_{23}\\rangle = -\\frac{1}{2}|s_{12}s_{34}\\rangle + \\frac{\\sqrt{3}}{2}|T_{12,34}\\rangle$，其中 $|T_{12,34}\\rangle$ 是一个自旋 $(1,2)$ 形成三重态、自旋 $(3,4)$ 形成三重态，并耦合为总单重态的态。\n    $|\\psi_1\\rangle = 2|s_{12}s_{34}\\rangle = 2|s\\rangle$。\n    $|\\psi_2\\rangle = 2|s_{14}s_{23}\\rangle = 2(-\\frac{1}{2}|s\\rangle + \\frac{\\sqrt{3}}{2}|T\\rangle) = -|s\\rangle+\\sqrt{3}|T\\rangle$。\n    $\\langle\\psi_1|\\mathbf{S}_1 \\cdot \\mathbf{S}_2|\\psi_2\\rangle = \\langle 2s | \\mathbf{S}_1 \\cdot \\mathbf{S}_2 | -s+\\sqrt{3}T \\rangle$。\n    算符 $\\mathbf{S}_1 \\cdot \\mathbf{S}_2$ 在 $\\{|s\\rangle, |T\\rangle\\}$ 基中是对角的：$\\mathbf{S}_1 \\cdot \\mathbf{S}_2 |s\\rangle = -\\frac{3}{4}|s\\rangle$ 且 $\\mathbf{S}_1 \\cdot \\mathbf{S}_2 |T\\rangle = \\frac{1}{4}|T\\rangle$。态 $|s\\rangle$ 和 $|T\\rangle$ 是正交的。\n    $\\langle\\psi_1|\\mathbf{S}_1 \\cdot \\mathbf{S}_2|\\psi_2\\rangle = \\langle 2s | \\mathbf{S}_1 \\cdot \\mathbf{S}_2 | -s \\rangle = -2 \\langle s | (-\\frac{3}{4}) | s \\rangle = \\frac{3}{2}$。这是一个实数。\n    \n    综合起来：\n    $$ \\langle \\mathbf{S}_1 \\cdot \\mathbf{S}_2 \\rangle = \\frac{1}{12} \\left[ -3 + 0 - 2\\left(\\frac{3}{2}\\right) \\right] = \\frac{1}{12}(-3 - 3) = \\frac{-6}{12} = -\\frac{1}{2} $$\n\n### 第 3 部分：符号问题的缺失\n\n问题涉及对 $|\\Psi_{\\mathrm{RVB}}|^{2}$ 进行蒙特卡洛抽样。这通常指变分蒙特卡洛 (VMC)。在 VMC 中，人们计算期望值，如 $\\langle H \\rangle = \\frac{\\sum_C |\\Psi(C)|^2 (E_L(C))}{\\sum_C |\\Psi(C)|^2}$，其中 $E_L(C) = \\frac{\\langle C | H | \\Psi \\rangle}{\\langle C | \\Psi \\rangle}$ 是局域能量。抽样权重是 $|\\Psi(C)|^2$，它显然是非负的。因此，在 VMC 抽样分布 $|\\Psi|^2$ 的背景下，根据定义不存在符号问题。\n\n然而，这个问题可能指的是波函数 $\\Psi$ 本身一个更深刻的性质，如果这个态被用作试探波函数，它就适合于“无符号问题”的投影量子蒙特卡洛（如 AFQMC）方法。对于一个没有磁场的二分晶格上的哈密顿量，如果基态可以在一个特定的局域基中写成所有系数都非负的形式，那么符号问题就不存在。对于一个二分晶格（A、B）上的自旋系统，Marshall-Peierls 符号定理指出，对于一个组态 $C$，基态波函数 $\\Psi_0(C)$ 可以写成 $\\Psi_0(C) = (-1)^{N_\\downarrow^A(C)} |\\Psi_0(C)|$，其中 $N_\\downarrow^A(C)$ 是 A 子格上下自旋的数量。这种符号结构可以通过一个局域么正变换 $U = \\exp(i\\pi \\sum_{j \\in B} S_j^z)$ 来消除，从而留下一个振幅全为正的波函数。\n\n给定的 RVB 态形式为 $|\\Psi\\rangle = \\mathcal{P}_G(\\sum_{i,j} f_{ij}b_{ij}^\\dagger)^{N/2}|0\\rangle$。一个已知的结果（例如，来自 Lieb 的工作，或更近期的 M. W. C. Hastings 的工作）是，对于一个二分晶格，其实配对函数 $f_{ij}$ 局限于 A 和 B 子格之间的键，所得到的单重态波函数 $\\Psi(C)$ 满足 Marshall-Peierls 符号定则。这意味着所有振幅都是实的，它们的符号由 $(-1)^{N_\\downarrow^A(C)}$ 给出。因此，在投影 QMC 的背景下，这样的态是“无符号问题”的。条件是：\n1.  晶格是二分的。\n2.  配对函数 $f_{ij}$ 是实数。\n3.  配对仅限于不同子格中的格点之间（如果 $i,j$ 在同一个子格中，则 $f_{ij}=0$）。\n\n### 最终答案计算\n关联函数的值是 $-\\frac{1}{2}$。", "answer": "$$\n\\boxed{-\\frac{1}{2}}\n$$", "id": "3013855"}, {"introduction": "从微小的、可精确求解的模型走向真实的无限大系统，是理论物理研究的关键一步。本练习将指导你完成这一跨越，我们将采用一种被称为“狄拉克自旋液体”（Dirac Spin Liquid）的复杂变分波函数来研究二维方格点上的海森堡模型。你将通过数值计算和有限尺寸标度分析——一种标准的研究方法——来推断系统在热力学极限下的基态能量，从而将理论模型与真实的凝聚态物质问题联系起来。[@problem_id:3013886]", "problem": "考虑一个二维方晶格上的自旋-$\\frac{1}{2}$反铁磁海森堡模型，其哈密顿量为 $H = J \\sum_{\\langle i j \\rangle} \\mathbf{S}_i \\cdot \\mathbf{S}_j$，其中 $J > 0$ 且 $\\langle i j \\rangle$ 表示最近邻对。在费米子（从粒子）表示中，自旋算符写为 $\\mathbf{S}_i = \\tfrac{1}{2} f^\\dagger_{i\\alpha} \\boldsymbol{\\sigma}_{\\alpha\\beta} f_{i\\beta}$，并满足单占据约束 $\\sum_{\\alpha} f^\\dagger_{i\\alpha} f_{i\\alpha} = 1$，其中 $f_{i\\alpha}$ 是费米子自旋子算符，$\\boldsymbol{\\sigma}$ 是泡利矩阵。在平均场水平上，可以通过一个在方晶格上实现每个格胞 (plaquette) 有 $\\pi$-通量的最近邻跃迁哈密顿量，来构建一个共振价键 (RVB) 狄拉克自旋液体 (DSL) 拟设：\n$$\nH_{\\text{MF}} = \\sum_{\\langle ij \\rangle,\\sigma} t_{ij} f^\\dagger_{i\\sigma} f_{j\\sigma} + \\text{h.c.},\n$$\n选择的规范使得水平方向的键具有 $t_{ij} = t$，而竖直方向的键具有 $t_{ij} = t (-1)^{x_i}$，其中 $x_i$ 是格点 $i$ 的 $x$ 坐标，$t>0$ 设定了平均场能量标度。这种模式强制了 $\\pi$-通量条件，因为围绕任何格胞的跃迁项乘积具有 $\\pi$ 的相位。每个空间方向上的边界条件可以是周期性的或反周期性的；反周期性边界条件通过在该方向的边界上引入一个 $\\pi$ 的相位来实现。\n\n从海森堡哈密顿量和上述费米子表示出发，推导狄拉克自旋液体拟设的平均场变分能（以 $J$ 为单位的单位格点能量 $E/N$），并用最近邻键上的基态费米子关联函数来表示。你的推导必须基于自旋相互作用到费米子双线性项的标准解耦，定义键期望值 $\\chi_{ij} = \\sum_\\sigma \\langle f^\\dagger_{i\\sigma} f_{j\\sigma} \\rangle$，并使用半填充时 $H_{\\text{MF}}$ 的基态投影算符来在具有特定边界条件的有限晶格上计算 $\\chi_{ij}$。不要假设任何未从所述基本出发点推导出的简化公式；你的程序必须实现你所提供的推导过程。\n\n具有线性色散自旋子的狄拉克自旋液体中的有限尺寸效应会导致能量密度的特征修正。使用系统的晶格尺寸 $L \\times L$ （其中 $L$ 为偶数以确保每个自旋组分处于半填充状态）和边界条件，计算有限尺寸的单位格点能量 $E(L)$，并通过拟合到一个标度形式来提取热力学极限能量 $E_\\infty$\n$$\nE(L) = E_\\infty + \\frac{c}{L^3},\n$$\n其中 $c$ 是一个取决于边界条件的非普适常数。所有能量都必须以 $J$ 为单位（即 $E/J$ 和 $E_\\infty/J$）表示为无量纲浮点数。\n\n实现要求：\n- 在实空间中为一个自旋组分构建 $L \\times L$ 晶格的 $H_{\\text{MF}}$，使用 $\\pi$-通量规范选择，即水平键上 $t_{x} = t$，竖直键上 $t_{y}(x) = t (-1)^x$。通过将跨越边界的跃迁项乘以 $-1$（对于该方向的反周期性条件）或 $+1$（对于周期性条件）来施加 $x$ 和 $y$ 方向上的周期性或反周期性边界条件。\n- 对角化 $H_{\\text{MF}}$，在半填充时填充一个自旋组分的最低 $N/2$ 个单粒子态，其中 $N = L^2$ 是晶格格点数。从已占据的本征矢量构建基态投影算符 $P$。单自旋组分关联为 $\\langle f^\\dagger_i f_j \\rangle = P_{j i}$，由于自旋简并，对自旋求和的键期望值为 $\\chi_{ij} = 2 P_{j i}$。\n- 通过枚举所有格点 $i$ 的 $(i, i+\\hat{x})$ 和 $(i, i+\\hat{y})$ 并考虑周期性环绕来计算最近邻键 $\\langle i j \\rangle$。使用你推导出的平均场表达式，在每个有限晶格上计算单位格点变分能 $E(L)/J$。\n- 对于每组边界条件，将 $E(L)$ 对 $L^{-3}$ 进行拟合，以提取 $E_\\infty$ 作为截距。同时，对于给定的边界条件集，计算一个布尔值，指示 $E(L)$ 是否随 $L$ 单调变化（此检查使用随 $L$ 增大而单调递减）。\n\n测试套件：\n- 使用 $t=1$ 和 $J=1$。\n- 情况1：$L \\in \\{10, 14, 18\\}$，边界条件 $(x,y) = (\\text{周期性}, \\text{周期性})$。\n- 情况2：$L \\in \\{8, 12, 16\\}$，边界条件 $(x,y) = (\\text{反周期性}, \\text{周期性})$。\n- 情况3：$L \\in \\{8, 12, 16\\}$，边界条件 $(x,y) = (\\text{反周期性}, \\text{反周期性})$。\n- 情况4：$L \\in \\{6, 8, 10\\}$，边界条件 $(x,y) = (\\text{周期性}, \\text{反周期性})$。\n\n答案规范和输出格式：\n- 对于每种情况，你的程序必须返回两项：拟合得到的热力学极限单位格点能量 $E_\\infty/J$（浮点数），以及单调性布尔值。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按上述情况的顺序排列结果：$[E_{\\infty,1}, \\text{monotonic}_1, E_{\\infty,2}, \\text{monotonic}_2, E_{\\infty,3}, \\text{monotonic}_3, E_{\\infty,4}, \\text{monotonic}_4]$。", "solution": "该问题被评估为有效。它在科学上基于凝聚态物理的标准理论框架，特别是量子自旋液体的研究。问题设定合理，清晰地定义了模型、平均场拟设、计算过程和所需的分析。语言客观明确。未发现使其无效的缺陷。\n\n任务是为狄拉克自旋液体 (DSL) 拟设计算自旋-$\\frac{1}{2}$反铁磁海森堡模型的平均场变分能（单位格点能量 $E/N$）。出发点是哈密顿量 $H = J \\sum_{\\langle i j \\rangle} \\mathbf{S}_i \\cdot \\mathbf{S}_j$，其中 $J>0$。变分态 $|\\Psi_{MF}\\rangle$ 是描述在具有 $\\pi$-通量的方晶格上运动的无相互作用费米子的平均场哈密顿量 $H_{\\text{MF}}$ 的基态。\n\n首先，我们推导变分能 $E = \\langle \\Psi_{MF} | H | \\Psi_{MF} \\rangle$ 的表达式。自旋算符在费米子从粒子表示中表示为：$\\mathbf{S}_i = \\frac{1}{2} \\sum_{\\alpha, \\beta} f^\\dagger_{i\\alpha} \\boldsymbol{\\sigma}_{\\alpha\\beta} f_{i\\beta}$，其中 $f_{i\\alpha}$ 是格点 $i$ 上自旋为 $\\alpha \\in \\{\\uparrow, \\downarrow\\}$ 的费米子湮灭算符，$\\boldsymbol{\\sigma}$ 是泡利矩阵矢量。\n\n能量是最近邻键上期望值的总和，$E = J \\sum_{\\langle ij \\rangle} \\langle \\mathbf{S}_i \\cdot \\mathbf{S}_j \\rangle$。拟设态 $|\\Psi_{MF}\\rangle$ 是一个不依赖自旋的跃迁哈密顿量的基态，由两个相同的分别用于上自旋和下自旋的斯莱特行列式构成：$|\\Psi_{MF}\\rangle = |\\Psi_0\\rangle_\\uparrow \\otimes |\\Psi_0\\rangle_\\downarrow$。这个态是自旋单态，意味着它在全局SU(2)自旋旋转下是不变的。因此，自旋-自旋关联函数的期望值是各向同性的：\n$$\n\\langle S_i^x S_j^x \\rangle = \\langle S_i^y S_j^y \\rangle = \\langle S_i^z S_j^z \\rangle\n$$\n这使我们可以将总关联写为 $\\langle \\mathbf{S}_i \\cdot \\mathbf{S}_j \\rangle = 3 \\langle S_i^z S_j^z \\rangle$。\n\n我们现在计算 $\\langle S_i^z S_j^z \\rangle$。自旋算符的 $z$ 分量是 $S_i^z = \\frac{1}{2}(f^\\dagger_{i\\uparrow}f_{i\\uparrow} - f^\\dagger_{i\\downarrow}f_{i\\downarrow}) = \\frac{1}{2}(n_{i\\uparrow} - n_{i\\downarrow})$。\n其期望值为：\n$$\n\\langle S_i^z S_j^z \\rangle = \\frac{1}{4} \\langle (n_{i\\uparrow} - n_{i\\downarrow})(n_{j\\uparrow} - n_{j\\downarrow}) \\rangle = \\frac{1}{4} \\left( \\langle n_{i\\uparrow} n_{j\\uparrow} \\rangle - \\langle n_{i\\uparrow} n_{j\\downarrow} \\rangle - \\langle n_{i\\downarrow} n_{j\\uparrow} \\rangle + \\langle n_{i\\downarrow} n_{j\\downarrow} \\rangle \\right)\n$$\n由于平均场哈密顿量 $H_{\\text{MF}}$ 没有耦合两种自旋组分的项，涉及不同自旋的算符的期望值可以进行因子分解，例如 $\\langle n_{i\\uparrow} n_{j\\downarrow} \\rangle = \\langle n_{i\\uparrow} \\rangle \\langle n_{j\\downarrow} \\rangle$。对于半填充的非磁性态，对所有 $i$ 和 $\\sigma$ 都有 $\\langle n_{i\\sigma} \\rangle = 1/2$。因此 $\\langle n_{i\\uparrow} n_{j\\downarrow} \\rangle = \\langle n_{i\\downarrow} n_{j\\uparrow} \\rangle = (1/2)(1/2) = 1/4$。\n\n对于相同自旋组分的算符，我们对自由费米子基态应用威克定理 (Wick's theorem)。对于 $i \\ne j$：\n$$\n\\langle n_{i\\sigma} n_{j\\sigma} \\rangle = \\langle f^\\dagger_{i\\sigma} f_{i\\sigma} f^\\dagger_{j\\sigma} f_{j\\sigma} \\rangle = \\langle n_{i\\sigma} \\rangle \\langle n_{j\\sigma} \\rangle - |\\langle f^\\dagger_{i\\sigma} f_{j\\sigma} \\rangle|^2\n$$\n我们定义单自旋组分关联函数 $C_{ij} = \\langle f^\\dagger_{i\\sigma} f_{j\\sigma} \\rangle$。注意这与自旋 $\\sigma$ 无关，因为 $|\\Psi_0\\rangle_\\uparrow$ 和 $|\\Psi_0\\rangle_\\downarrow$ 是相同的。因此，$\\langle n_{i\\sigma} n_{j\\sigma} \\rangle = (1/2)(1/2) - |C_{ij}|^2 = 1/4 - |C_{ij}|^2$。\n\n将这些结果代回到 $\\langle S_i^z S_j^z \\rangle$ 的表达式中：\n$$\n\\langle S_i^z S_j^z \\rangle = \\frac{1}{4} \\left( (1/4 - |C_{ij}|^2) - 1/4 - 1/4 + (1/4 - |C_{ij}|^2) \\right) = -\\frac{1}{2} |C_{ij}|^2\n$$\n于是总的自旋-自旋关联为：\n$$\n\\langle \\mathbf{S}_i \\cdot \\mathbf{S}_j \\rangle = 3 \\langle S_i^z S_j^z \\rangle = -\\frac{3}{2} |C_{ij}|^2\n$$\n问题定义了对自旋求和的键期望值 $\\chi_{ij} = \\sum_\\sigma \\langle f^\\dagger_{i\\sigma} f_{j\\sigma} \\rangle = \\langle f^\\dagger_{i\\uparrow} f_{j\\uparrow} \\rangle + \\langle f^\\dagger_{i\\downarrow} f_{j\\downarrow} \\rangle = 2 C_{ij}$（因为 $C_{ij}$ 不依赖于自旋）。因此，$C_{ij} = \\chi_{ij}/2$。代入此式可得：\n$$\n\\langle \\mathbf{S}_i \\cdot \\mathbf{S}_j \\rangle = -\\frac{3}{2} \\left| \\frac{\\chi_{ij}}{2} \\right|^2 = -\\frac{3}{8} |\\chi_{ij}|^2\n$$\n通过对所有最近邻键求和，得到总变分能：\n$$\nE = J \\sum_{\\langle ij \\rangle} \\langle \\mathbf{S}_i \\cdot \\mathbf{S}_j \\rangle = -J \\frac{3}{8} \\sum_{\\langle ij \\rangle} |\\chi_{ij}|^2\n$$\n单位格点能量，以 $J$ 为单位，是：\n$$\n\\frac{E}{NJ} = -\\frac{3}{8N} \\sum_{\\langle ij \\rangle} |\\chi_{ij}|^2\n$$\n这是需要实现的最终表达式。计算过程如下：通过数值方法构建并对角化单个自旋组分的 $H_{\\text{MF}}$ 来找到基态投影算符 $P$，由此我们得到 $\\chi_{ij} = 2 P_{ji}$。对 $\\langle ij \\rangle$ 的求和遍历了 $L \\times L$ 环面上的所有 $2N$ 个键。\n\n数值实现将执行以下步骤：\n1. 对于每对 $(L, \\text{BC})$，为一个自旋组分构建 $N \\times N$（$N=L^2$）的实空间矩阵 $H_{\\text{MF}}$，其中包含 $\\pi$-通量规范选择和边界条件。\n2. 对角化 $H_{\\text{MF}}$，并使用与 $N/2$ 个最低本征值对应的本征矢量来构成基态投影矩阵 $P$。\n3. 为所有最近邻键 $\\langle ij \\rangle$ 计算 $\\chi_{ij} = 2P_{ji}$。\n4. 使用推导出的公式计算单位格点能量 $E(L)/J$。\n5. 对于每组边界条件，收集指定 $L$ 值的能量，并通过对 $E(L)$ 与 $1/L^3$ 进行线性回归，将它们拟合到模型 $E(L) = E_\\infty + c/L^3$。此拟合的截距给出 $E_\\infty/J$。\n6. 检查能量序列 $E(L)$ 是否随 $L$ 的增加而单调递减。\n7. 按规定收集并格式化结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_energy_per_site(L, bc_x_str, bc_y_str):\n    \"\"\"\n    Calculates the mean-field variational energy per site for the DSL ansatz.\n\n    Args:\n        L (int): The linear size of the L x L square lattice.\n        bc_x_str (str): Boundary condition in x ('periodic' or 'antiperiodic').\n        bc_y_str (str): Boundary condition in y ('periodic' or 'antiperiodic').\n\n    Returns:\n        float: The variational energy per site in units of J.\n    \"\"\"\n    N = L * L\n    \n    # Set BC phases: +1 for Periodic, -1 for Anti-periodic\n    bc_x_phase = -1.0 if bc_x_str == 'antiperiodic' else 1.0\n    bc_y_phase = -1.0 if bc_y_str == 'antiperiodic' else 1.0\n\n    # 1. Construct the mean-field Hamiltonian H_MF for one spin species\n    H_mf = np.zeros((N, N), dtype=np.float64)\n    t = 1.0  # Mean-field hopping amplitude scale\n\n    for i in range(N):\n        x, y = i % L, i // L\n\n        # Horizontal hopping (i to i+x_hat)\n        j_h = y * L + (x + 1) % L\n        phase_h = bc_x_phase if x == L - 1 else 1.0\n        H_mf[i, j_h] = t * phase_h\n        H_mf[j_h, i] = t * phase_h\n\n        # Vertical hopping (i to i+y_hat)\n        # Hopping strength depends on x-coordinate due to pi-flux\n        t_v = t * (1.0 if x % 2 == 0 else -1.0)\n        j_v = ((y + 1) % L) * L + x\n        phase_v = bc_y_phase if y == L - 1 else 1.0\n        H_mf[i, j_v] = t_v * phase_v\n        H_mf[j_v, i] = t_v * phase_v\n\n    # 2. Diagonalize H_MF and form the ground-state projector P\n    eigvals, eigvecs = np.linalg.eigh(H_mf)\n    \n    # At half-filling, occupy the lowest N/2 states\n    num_occupied = N // 2\n    occupied_vecs = eigvecs[:, :num_occupied]\n    \n    # Projector P = V @ V_dagger. P_ij = sum_k v_ik v_jk\n    P = occupied_vecs @ occupied_vecs.T\n\n    # 3. Compute the variational energy per site using the derived formula\n    # E/(NJ) = - (3 / (8N)) * sum_{<ij>} |chi_ij|^2\n    # The sum is over all unique nearest-neighbor bonds.\n    \n    chi_sq_sum_bonds = 0.0\n    for i in range(N):\n        x, y = i % L, i // L\n        \n        # Horizontal bond <i, j_h>\n        j_h = y * L + (x + 1) % L\n        # chi_ij = 2 * P_ji\n        chi_ij_h = 2.0 * P[j_h, i]\n        chi_sq_sum_bonds += chi_ij_h**2\n        \n        # Vertical bond <i, j_v>\n        j_v = ((y + 1) % L) * L + x\n        chi_ij_v = 2.0 * P[j_v, i]\n        chi_sq_sum_bonds += chi_ij_v**2\n    \n    # The loop over i considers neighbors to the right and down, covering all\n    # 2N bonds on the torus exactly once.\n    \n    energy_per_site_over_J = - (3.0 / (8.0 * N)) * chi_sq_sum_bonds\n    \n    return energy_per_site_over_J\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {'L_values': [10, 14, 18], 'bc_x': 'periodic', 'bc_y': 'periodic'},\n        # Case 2\n        {'L_values': [8, 12, 16], 'bc_x': 'antiperiodic', 'bc_y': 'periodic'},\n        # Case 3\n        {'L_values': [8, 12, 16], 'bc_x': 'antiperiodic', 'bc_y': 'antiperiodic'},\n        # Case 4\n        {'L_values': [6, 8, 10], 'bc_x': 'periodic', 'bc_y': 'antiperiodic'},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        L_values = case['L_values']\n        bc_x = case['bc_x']\n        bc_y = case['bc_y']\n        \n        energies = []\n        L_inv_cubed = []\n        for L in L_values:\n            e = calculate_energy_per_site(L, bc_x, bc_y)\n            energies.append(e)\n            L_inv_cubed.append(1.0 / (L**3))\n        \n        # Fit E(L) = E_inf + c/L^3, which is a linear model y = c*x + E_inf\n        # where y = E(L) and x = 1/L^3.\n        # np.polyfit with deg=1 returns [slope, intercept].\n        coeffs = np.polyfit(L_inv_cubed, energies, 1)\n        E_infinity = coeffs[1]\n        \n        # Check for monotonic decrease of energy with increasing L\n        is_monotonic = all(energies[i] > energies[i+1] for i in range(len(energies) - 1))\n        \n        results.append(E_infinity)\n        results.append(is_monotonic)\n\n    # Final print statement in the exact required format.\n    # Convert booleans to strings ('True', 'False') and join all items.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3013886"}]}