{"hands_on_practices": [{"introduction": "本练习是朗道理论的基石之一。它演示了如何直接从自由能展开式中推导二级相变的一个关键实验特征——比热的有限跳变。通过该实践，你将练习如何通过最小化自由能来寻找平衡态，并利用平衡态序参量计算热力学响应函数，从而加深对平均场理论核心逻辑的理解。[@problem_id:3008513]", "problem": "考虑一个经历连续（二级）相变的均匀系统，该相变由一个标量序参量 $m$ 描述。在相变点附近，朗道自由能密度可以展开为\n$$\nf(T,m)=f_{\\mathrm{reg}}(T)+a(T)m^{2}+b\\,m^{4},\n$$\n其中 $f_{\\mathrm{reg}}(T)$ 是一个正则（解析）的背景贡献项，$b>0$ 是一个与 $T$ 无关的常数，且 $a(T)=a'(T-T_{c})$，其中 $a'>0$，$T_{c}$ 是临界温度。假设在固定温度 $T$ 下，通过最小化关于 $m$ 的 $f(T,m)$ 来达到热力学平衡。定义熵密度为 $s(T)=-\\partial f_{\\mathrm{eq}}(T)/\\partial T$，单位体积比热为 $C(T)=T\\,\\partial s(T)/\\partial T=-T\\,\\partial^{2}f_{\\mathrm{eq}}(T)/\\partial T^{2}$。\n\n从这些定义和平衡条件 $\\partial f/\\partial m=0$ 出发，计算相变点处比热跳变的奇异贡献，\n$$\n\\Delta C \\equiv \\lim_{T\\to T_{c}^{-}}C(T)-\\lim_{T\\to T_{c}^{+}}C(T),\n$$\n该贡献可归因于朗道项 $a(T)m^{2}+b\\,m^{4}$，并用 $T_{c}$、$a'$ 和 $b$ 明确表示（在计算跳变时，可以忽略正则背景项 $f_{\\mathrm{reg}}(T)$）。然后，利用比热临界指数 $\\alpha$ 的定义，即奇异部分 $C_{\\mathrm{sing}}(T)\\sim |t|^{-\\alpha}$（当 $t\\to 0$ 时，其中 $t=(T-T_{c})/T_{c}$），确定此朗道理论中 $\\alpha$ 的平均场值。\n\n您的最终答案应将 $\\Delta C$ 和 $\\alpha$ 这两个量以单行矩阵的形式列出。无需进行数值计算或四舍五入；请用符号表示您的答案。", "solution": "本问题要求计算一个由朗道自由能密度描述的、处于二级相变点附近的系统的比热跳变 $\\Delta C$ 和临界指数 $\\alpha$。\n\n朗道自由能密度由下式给出\n$$\nf(T,m)=f_{\\mathrm{reg}}(T)+a(T)m^{2}+b\\,m^{4}\n$$\n其中 $a(T)=a'(T-T_{c})$，$a'>0$，且 $b>0$。热力学平衡是通过最小化关于序参量 $m$ 的 $f(T,m)$ 得到的。平衡条件为 $\\frac{\\partial f}{\\partial m}=0$。\n\n求导数，我们得到：\n$$\n\\frac{\\partial f}{\\partial m} = 2a(T)m + 4bm^3 = 2m(a(T) + 2bm^2) = 0\n$$\n该方程有两种解：$m=0$ 或 $m^2 = -\\frac{a(T)}{2b}$。为确定哪个解对应于最小值，我们考察二阶导数：\n$$\n\\frac{\\partial^2 f}{\\partial m^2} = 2a(T) + 12bm^2\n$$\n稳定解要求 $\\frac{\\partial^2 f}{\\partial m^2} > 0$。\n\n情况1：高温相（$T>T_{c}$）\n在此区域，$a(T) = a'(T-T_c) > 0$。由于 $b>0$，解 $m^2 = -a(T)/(2b)$ 是非物理的，因为它会得到虚数 $m$。唯一的实数解是 $m=0$。\n在 $m=0$ 处，二阶导数为 $\\frac{\\partial^2 f}{\\partial m^2} = 2a(T) > 0$，表明是一个极小值。\n因此，对于 $T>T_{c}$，平衡序参量为 $m_{\\mathrm{eq}}=0$。\n\n情况2：低温相（$T<T_{c}$）\n在此区域，$a(T) = a'(T-T_c) < 0$。可能的实数解为 $m=0$ 和 $m = \\pm \\sqrt{-a(T)/(2b)}$。\n在 $m=0$ 处，二阶导数为 $\\frac{\\partial^2 f}{\\partial m^2} = 2a(T) < 0$，这对应于一个极大值。此解不稳定。\n对于 $m^2 = -a(T)/(2b)$，二阶导数为：\n$$\n\\frac{\\partial^2 f}{\\partial m^2} = 2a(T) + 12b\\left(-\\frac{a(T)}{2b}\\right) = 2a(T) - 6a(T) = -4a(T)\n$$\n由于对于 $T<T_c$ 有 $a(T)<0$，我们得到 $-4a(T)>0$，表明这是一个稳定的极小值。\n因此，对于 $T<T_{c}$，平衡序参量满足 $m_{\\mathrm{eq}}^2 = -\\frac{a(T)}{2b} = \\frac{a'(T_c-T)}{2b}$。\n\n接下来，我们将 $m_{\\mathrm{eq}}(T)$ 代回 $f(T,m)$ 来求平衡自由能 $f_{\\mathrm{eq}}(T)$。我们关心的是由包含 $m$ 的项产生的奇异部分。设 $f_{\\mathrm{eq, sing}}(T)$ 为此贡献项。\n\n对于 $T>T_{c}$，$m_{\\mathrm{eq}}=0$，所以 $f_{\\mathrm{eq, sing}}(T) = a(T)(0)^2 + b(0)^4 = 0$。\n对于 $T<T_{c}$，$m_{\\mathrm{eq}}^2 = -a(T)/(2b)$，所以\n$$\nf_{\\mathrm{eq, sing}}(T) = a(T)m_{\\mathrm{eq}}^2 + bm_{\\mathrm{eq}}^4 = a(T)\\left(-\\frac{a(T)}{2b}\\right) + b\\left(-\\frac{a(T)}{2b}\\right)^2 = -\\frac{a(T)^2}{2b} + \\frac{a(T)^2}{4b} = -\\frac{a(T)^2}{4b}\n$$\n代入 $a(T) = a'(T-T_c)$，我们得到：\n$$\nf_{\\mathrm{eq, sing}}(T) = -\\frac{(a')^2(T-T_c)^2}{4b}\n$$\n总结如下：\n$$\nf_{\\mathrm{eq, sing}}(T) = \\begin{cases} 0 & \\text{对于 } T \\geq T_c \\\\ -\\frac{(a')^2(T-T_c)^2}{4b} & \\text{对于 } T < T_c \\end{cases}\n$$\n问题指明，在计算跳变 $\\Delta C$ 时，可以忽略正则部分 $f_{\\mathrm{reg}}(T)$ 的贡献，因为它的导数在 $T_c$ 处是连续的。\n\n熵密度为 $s(T) = -\\frac{\\partial f_{\\mathrm{eq}}(T)}{\\partial T}$。熵的奇异贡献 $s_{\\mathrm{sing}}(T)$ 为：\n$$\ns_{\\mathrm{sing}}(T) = -\\frac{\\partial f_{\\mathrm{eq, sing}}(T)}{\\partial T}\n$$\n对于 $T>T_{c}$，$s_{\\mathrm{sing}}(T) = -\\frac{\\partial}{\\partial T}(0) = 0$。\n对于 $T<T_{c}$，\n$$\ns_{\\mathrm{sing}}(T) = -\\frac{\\partial}{\\partial T}\\left(-\\frac{(a')^2(T-T_c)^2}{4b}\\right) = \\frac{(a')^2}{4b} \\cdot 2(T-T_c) = \\frac{(a')^2(T-T_c)}{2b}\n$$\n注意到 $\\lim_{T \\to T_c^-} s_{\\mathrm{sing}}(T) = 0$，所以熵在 $T_c$ 处是连续的，这与二级相变的预期相符。\n\n比热为 $C(T) = T \\frac{\\partial s(T)}{\\partial T}$。其奇异贡献 $C_{\\mathrm{sing}}(T)$ 为：\n$$\nC_{\\mathrm{sing}}(T) = T \\frac{\\partial s_{\\mathrm{sing}}(T)}{\\partial T}\n$$\n对于 $T>T_{c}$，$C_{\\mathrm{sing}}(T) = T \\frac{\\partial}{\\partial T}(0) = 0$。\n对于 $T<T_{c}$，\n$$\nC_{\\mathrm{sing}}(T) = T \\frac{\\partial}{\\partial T}\\left(\\frac{(a')^2(T-T_c)}{2b}\\right) = T \\frac{(a')^2}{2b}\n$$\n相变点处的比热跳变 $\\Delta C$ 定义为：\n$$\n\\Delta C = \\lim_{T\\to T_{c}^{-}}C(T) - \\lim_{T\\to T_{c}^{+}}C(T) = \\lim_{T\\to T_{c}^{-}}C_{\\mathrm{sing}}(T) - \\lim_{T\\to T_{c}^{+}}C_{\\mathrm{sing}}(T)\n$$\n$$\n\\lim_{T\\to T_{c}^{-}}C_{\\mathrm{sing}}(T) = \\lim_{T\\to T_{c}^{-}}\\left(T \\frac{(a')^2}{2b}\\right) = \\frac{(a')^2 T_c}{2b}\n$$\n$$\n\\lim_{T\\to T_{c}^{+}}C_{\\mathrm{sing}}(T) = \\lim_{T\\to T_{c}^{+}}(0) = 0\n$$\n因此，跳变为：\n$$\n\\Delta C = \\frac{(a')^2 T_c}{2b} - 0 = \\frac{(a')^2 T_c}{2b}\n$$\n为确定临界指数 $\\alpha$，我们分析比热的奇异部分 $C_{\\mathrm{sing}}(T)$ 在 $T \\to T_c$ 时的行为。标度律定义为 $C_{\\mathrm{sing}}(T) \\sim |t|^{-\\alpha}$，其中 $t=(T-T_c)/T_c$。\n如上所示，对于 $T>T_c$（$t>0$），$C_{\\mathrm{sing}}(T)=0$。对于 $T<T_c$（$t<0$），当 $T \\to T_c^-$ 时，$C_{\\mathrm{sing}}(T)$ 趋近于一个有限的非零常数 $\\frac{(a')^2 T_c}{2b}$。这个有限的跳跃间断意味着比热不发散。其标度行为是一个常数，可以写成 $|t|^0=1$。\n$$\nC_{\\mathrm{sing}}(T) \\sim |t|^{-\\alpha} \\sim \\text{constant} \\propto |t|^0\n$$\n比较指数，我们发现 $-\\alpha = 0$，这意味着 $\\alpha=0$。这个指数 $\\alpha$ 的值是具有比热跳变的系统的标准平均场结果。\n\n待确定的两个量是比热跳变 $\\Delta C$ 和临界指数 $\\alpha$。\n$$\n\\Delta C = \\frac{(a')^2 T_c}{2b}\n$$\n$$\n\\alpha = 0\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{(a')^{2} T_{c}}{2b} & 0 \\end{pmatrix}}\n$$", "id": "3008513"}, {"introduction": "与描述连续相变的二级朗道理论不同，通过调整展开系数（特别是使用一个负的四阶项），该模型可以描述一级相变。本练习将引导你应用相共存条件——即自由能相等和系统处于平衡态——来确定在转变温度下不连续出现的非零磁化强度。这个过程不仅能让你掌握处理一级相变的方法，也突显了朗道框架的灵活性和普适性。[@problem_id:3008464]", "problem": "考虑一个铁磁体，在朗道平均场理论的描述下，它具有一个均匀的序参量，即在外磁场 $h$ 中的格点磁化强度 $m$。亥姆霍兹自由能密度 $f(m;T,h)$ 展开为\n$$\nf(m;T,h) = f_{0} + \\frac{1}{2}\\,\\alpha\\,(T - T_{0})\\,m^{2} + \\frac{1}{4}\\,b\\,m^{4} + \\frac{1}{6}\\,c\\,m^{6} - h\\,m,\n$$\n其中 $\\alpha>0$，$b<0$ 和 $c>0$ 是不依赖于温度的常数，$T_{0}$ 是一个参考温度。假设系统空间均匀并忽略涨落（平均场近似）。在零场 $h=0$ 时，该模型存在一级相变，此时顺磁态 $m=0$ 和铁磁态 $m\\neq 0$ 可以共存。\n\n使用麦克斯韦构作（物态方程 $h(m)$ 的等面积法则），或在 $h=0$ 时等效地使用自由能相等条件，确定在相变温度 $T=T_{t}$ 时的共存磁化强度 $m_{+}$ 和 $m_{-}$。推导这些共存磁化强度用朗道系数 $b$ 和 $c$ 表示的闭合形式表达式，无需进行数值代入。将最终答案表示为有序对 $(m_{+}, m_{-})$。最终表达式无需四舍五入，也不应包含单位。", "solution": "该问题要求在零外磁场（$h=0$）下，对于由特定朗道自由能密度描述的铁磁体，在相变温度 $T=T_{t}$ 时的共存磁化强度，记为 $m_{+}$ 和 $m_{-}$。\n\n在 $h=0$ 时，亥姆霍兹自由能密度由下式给出：\n$$\nf(m;T) = f_{0} + \\frac{1}{2}\\,\\alpha\\,(T - T_{0})\\,m^{2} + \\frac{1}{4}\\,b\\,m^{4} + \\frac{1}{6}\\,c\\,m^{6}\n$$\n其中 $\\alpha>0$，$b<0$ 且 $c>0$。\n\n一级相变发生在某一温度 $T_{t}$，在该温度下两个不同相可以处于热力学平衡状态共存。在本例中，这两个相分别是磁化强度 $m=0$ 的顺磁态和具有非零自发磁化强度 $m_s \\neq 0$ 的铁磁态。\n\n在相变温度 $T=T_{t}$ 时，这种共存的条件有两个：\n1.  两个共存相的自由能必须相等。\n2.  铁磁态必须是稳定（或至少是亚稳）的平衡态，这意味着其磁化强度 $m_s$ 必须对应于自由能的一个局域极小值。\n\n让我们将这两个条件形式化。\n\n**条件 1：自由能相等**\n在相变温度 $T_{t}$，顺磁态（$m=0$）的自由能必须等于铁磁态（$m=m_s$）的自由能。\n$$\nf(m=0; T_{t}) = f(m=m_s; T_{t})\n$$\n代入自由能密度的表达式：\n$$\nf_{0} = f_{0} + \\frac{1}{2}\\,\\alpha\\,(T_{t} - T_{0})\\,m_{s}^{2} + \\frac{1}{4}\\,b\\,m_{s}^{4} + \\frac{1}{6}\\,c\\,m_{s}^{6}\n$$\n对于非平庸的铁磁态，$m_s \\neq 0$，我们可以将方程两边同除以 $m_s^2$：\n$$\n0 = \\frac{1}{2}\\,\\alpha\\,(T_{t} - T_{0}) + \\frac{1}{4}\\,b\\,m_{s}^{2} + \\frac{1}{6}\\,c\\,m_{s}^{4} \\quad (1)\n$$\n\n**条件 2：铁磁态的平衡**\n要使磁化强度 $m_s$ 对应于一个平衡态，它必须是自由能的一个极值。这可以通过将自由能密度对 $m$ 的一阶导数设为零来找到。\n$$\n\\frac{\\partial f(m;T)}{\\partial m} = \\alpha\\,(T - T_{0})\\,m + b\\,m^{3} + c\\,m^{5}\n$$\n在 $m=m_s$ 和 $T=T_{t}$ 处计算该式：\n$$\n\\left. \\frac{\\partial f}{\\partial m} \\right|_{m=m_s, T=T_t} = \\alpha\\,(T_{t} - T_{0})\\,m_{s} + b\\,m_{s}^{3} + c\\,m_{s}^{5} = 0\n$$\n由于 $m_s \\neq 0$，我们可以同除以 $m_s$：\n$$\n\\alpha\\,(T_{t} - T_{0}) + b\\,m_{s}^{2} + c\\,m_{s}^{4} = 0 \\quad (2)\n$$\n\n**求解共存磁化强度**\n我们现在有一个关于两个未知量 $\\alpha(T_t - T_0)$ 和 $m_s^2$ 的方程组，由两个代数方程（1）和（2）组成。我们可以解这个方程组来求得 $m_s$。\n从方程（2）中，我们可以将项 $\\alpha(T_t - T_0)$ 表示为：\n$$\n\\alpha\\,(T_{t} - T_{0}) = - b\\,m_{s}^{2} - c\\,m_{s}^{4}\n$$\n现在，我们将此表达式代入方程（1）：\n$$\n0 = \\frac{1}{2}(- b\\,m_{s}^{2} - c\\,m_{s}^{4}) + \\frac{1}{4}\\,b\\,m_{s}^{2} + \\frac{1}{6}\\,c\\,m_{s}^{4}\n$$\n让我们合并含有 $m_s^2$ 和 $m_s^4$ 的项：\n$$\n0 = \\left(-\\frac{1}{2}b + \\frac{1}{4}b\\right)m_{s}^{2} + \\left(-\\frac{1}{2}c + \\frac{1}{6}c\\right)m_{s}^{4}\n$$\n$$\n0 = \\left(-\\frac{1}{4}b\\right)m_{s}^{2} + \\left(-\\frac{3}{6}c + \\frac{1}{6}c\\right)m_{s}^{4}\n$$\n$$\n0 = -\\frac{1}{4}\\,b\\,m_{s}^{2} - \\frac{2}{6}\\,c\\,m_{s}^{4}\n$$\n$$\n0 = -\\frac{1}{4}\\,b\\,m_{s}^{2} - \\frac{1}{3}\\,c\\,m_{s}^{4}\n$$\n我们可以提取公因式 $m_s^2$：\n$$\nm_{s}^{2} \\left( -\\frac{1}{4}\\,b - \\frac{1}{3}\\,c\\,m_{s}^{2} \\right) = 0\n$$\n这个方程有两个解。一个是平庸解 $m_s^2 = 0$，它对应我们已经考虑过的顺磁态。另一个解给出了非零的自发磁化强度：\n$$\n-\\frac{1}{4}\\,b - \\frac{1}{3}\\,c\\,m_{s}^{2} = 0\n$$\n求解 $m_s^2$：\n$$\n\\frac{1}{3}\\,c\\,m_{s}^{2} = -\\frac{1}{4}\\,b\n$$\n$$\nm_{s}^{2} = -\\frac{3b}{4c}\n$$\n因为题目说明了 $b<0$ 和 $c>0$，所以上式右边为正，因此 $m_s$ 存在实数解。开平方根得到两个解，它们对应于共存磁化强度 $m_+$ 和 $m_-$：\n$$\nm_{s} = \\pm\\sqrt{-\\frac{3b}{4c}}\n$$\n按照惯例，我们将正解记为 $m_+$，负解记为 $m_-$。\n$$\nm_{+} = \\sqrt{-\\frac{3b}{4c}}\n$$\n$$\nm_{-} = -\\sqrt{-\\frac{3b}{4c}}\n$$\n问题要求的是有序对 $(m_{+}, m_{-})$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{-\\frac{3b}{4c}} & -\\sqrt{-\\frac{3b}{4c}} \\end{pmatrix}}\n$$", "id": "3008464"}, {"introduction": "本练习是一项综合性实践，旨在通过计算将理论付诸实践。我们将从普适的朗道展开式转向一个具体的微观模型——外斯平均场理论下的伊辛磁体。你的任务是数值求解自洽方程以获得磁化曲线并计算磁化率，这需要你运用求根算法并根据自由能最小化原则来选择稳定的物理状态。这项练习将让你对理论概念如何在具体系统中表现出来有更直观的感受。[@problem_id:3008495]", "problem": "考虑一个处于魏斯平均场理论 (MFT) 中的铁磁类伊辛系统。令序参量为单位自旋磁化强度，记为 $m$，微观交换参数为 $J&gt;0$，配位数为 $z$。在MFT中，温度为 $T$、外场为 $h$ 时的均匀磁化强度满足以下自洽关系式\n$$\nm \\;=\\; \\tanh\\!\\big(\\beta\\,[z J\\, m + h]\\big),\n$$\n其中 $\\beta \\equiv 1/T$。计算中采用的单位制将玻尔兹曼常数设为1（因此 $T$ 和 $h$ 的能量单位由 $J$ 设定）。在MFT中，临界温度为 $T_c = zJ$。必须通过在 $m\\in[-1,1]$ 的范围内最小化单位自旋的平均场自由能来选择热力学稳定分支\n$$\nf(m;T,h) \\;=\\; \\tfrac{1}{2}\\, z J\\, m^2 \\;-\\; \\frac{1}{\\beta}\\,\\ln\\!\\Big[2\\cosh\\!\\big(\\beta\\,(zJ\\,m+h)\\big)\\Big],\n$$\n磁化率定义为零场下的微分响应，\n$$\n\\chi(T) \\;\\equiv\\; \\left.\\frac{\\partial m}{\\partial h}\\right|_{h=0},\n$$\n它可以通过对自洽方程关于 $h$ 求导，并在 $h=0$ 的稳定解上计算结果来精确表示。\n\n你的任务是：\n- 实现一个稳健的数值程序，通过求解自洽方程并根据上述自由能最小化判据选择热力学稳定解，来计算给定 $(h,T)$ 下的稳定磁化强度 $m(h,T)$。\n- 通过对自洽方程关于 $h$ 求导并用代数方法解出 $\\partial m/\\partial h$，推导出一个用 $\\beta$、$zJ$、$m$ 和双曲函数表示的 $\\chi(T)$ 的精确表达式。实现该表达式，并在 $h=0$ 和稳定解 $m(h=0,T)$ 处进行计算，求得 $\\chi(T)$。\n- 使用 $z=6$，$J=1$，因此 $T_c = 6$。下面所有的温度 $T$ 和场 $h$ 均以 $k_B=1$ 和 $J=1$ 为单位，磁化强度 $m$ 是无量纲的。磁化率 $\\chi$ 应以与这些选择一致的场的逆单位报告。\n\n测试组。你的程序必须计算：\n- 以下 $(T,h)$ 对的磁化强度值 $m(h,T)$：\n  1. $(T,h)=(6.5,\\,0.1)$，\n  2. $(T,h)=(5.5,\\,0.0)$，当在 $h=0$ 处出现多个热力学等效的最小值时，返回非负的稳定解，\n  3. $(T,h)=(6.0,\\,10^{-4})$，\n  4. $(T,h)=(100.0,\\,1.0)$，\n  5. $(T,h)=(0.5,\\,-10^{-6})$。\n- 临界点附近温度下的零场磁化率：\n  6. $T=6.1$ 时的 $\\chi(T)$，\n  7. $T=5.9$ 时的 $\\chi(T)$，\n  8. 振幅比 $R \\equiv \\chi(6.1)/\\chi(5.9)$。\n\n科学真实性和解释说明：你应该会观察到，当 $T&gt;T_c$ 时出现光滑的顺磁曲线；当温度低于 $T_c$ 时，在 $h=0$ 处发生自发对称性破缺，此时 $m\\neq 0$；在 $T_c$ 附近，小场 $h$ 下出现非线性临界响应，并且在 $h=0$ 处斜率无穷大；在低温下出现饱和。磁化率应在 $T\\to T_c$ 时发散，并在 $T_c$ 上下表现出不同的振幅。\n\n最终输出格式：你的程序应该产生单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n$$\n[m(0.1,6.5),\\,m(0.0,5.5),\\,m(10^{-4},6.0),\\,m(1.0,100.0),\\,m(-10^{-6},0.5),\\,\\chi(6.1),\\,\\chi(5.9),\\,R].\n$$\n所有条目必须以浮点数形式打印。不应打印任何额外的文本或单位。本问题不涉及角度。物理量应以上述指定的单位报告。", "solution": "该问题被评估为 **有效**。它在伊辛铁磁体的魏斯平均场理论标准框架内，提供了一个自洽、科学上合理且良定的问题。所有必要的方程、参数和条件都得到了明确陈述，并且与统计力学的既定原理一致。\n\n解决方案主要分为两部分：首先，实现一个用于求解稳定磁化强度 $m(T,h)$ 的数值求解器；其次，推导并实现一个用于计算零场磁化率 $\\chi(T)$ 的解析表达式。\n\n**1. 稳定磁化强度 $m(T,h)$ 的数值解法**\n\n单位自旋磁化强度 $m$ 由以下自洽方程确定：\n$$\nm = \\tanh(\\beta(zJm + h))\n$$\n其中 $\\beta = 1/T$，$z$ 是配位数，$J$ 是交换耦合，$h$ 是外磁场。这是一个关于 $m$ 的超越方程。为便于数值求解，将其重写为函数 $g(m)$ 的求根问题：\n$$\ng(m) = m - \\tanh(\\beta(zJm + h)) = 0\n$$\n$m$ 的定义域在物理上被限制在 $m \\in [-1, 1]$ 内。对 $g(m)$ 的分析表明 $g(-1) = -1 - \\tanh(\\beta(-zJ+h)) &lt; 0$ 且 $g(1) = 1 - \\tanh(\\beta(zJ+h)) &gt; 0$，这保证了在区间 $[-1, 1]$ 内至少存在一个根。\n\n对于高于临界温度 $T_c = zJ$ 的温度 $T$，$m$ 存在唯一解。对于 $T &lt; T_c$，最多可能存在三个不同的实根。物理上实现的热力学稳定态对应于使单位自旋的平均场自由能 $f(m; T, h)$ 最小的 $m$ 值：\n$$\nf(m;T,h) = \\frac{1}{2} z J m^2 - T \\ln\\Big[2\\cosh\\big(\\beta(zJm+h)\\big)\\Big]\n$$\n寻找稳定磁化强度 $m(T,h)$ 的数值算法如下：\n1.  对于给定的参数 $T$ 和 $h$，定义函数 $g(m)$。\n2.  在区间 $m \\in [-1, 1]$ 内找到 $g(m)=0$ 的所有根。这可以通过将区间划分为一个精细的网格，并在任何检测到 $g(m)$ 符号变化的子区间内使用区间法求根器（如 Brent 方法，即 `scipy.optimize.brentq`）来稳健地实现。这确保能找到所有解。\n3.  对于找到的每个根 $m_i$，计算其自由能 $f(m_i; T, h)$。为防止双曲余弦函数参数过大时发生数值溢出，使用恒等式 $\\ln(2\\cosh(x)) = |x| + \\ln(1 + e^{-2|x|})$ 来计算 $\\ln(2\\cosh(x))$ 项。\n4.  稳定解是对应于自由能全局最小值的根 $m^*$。\n5.  处理 $T &lt; T_c$ 且 $h=0$ 时的特殊情况：自由能是 $m$ 的偶函数，导致在 $\\pm m_0$ 处有两个简并的最小值。根据题目要求，返回非负解 $+m_0$。\n\n**2. 磁化率 $\\chi(T)$ 的解析表达式**\n\n零场磁化率定义为 $\\chi(T) \\equiv (\\partial m / \\partial h)|_{h=0}$。通过对自洽方程关于 $h$ 进行隐式微分来推导解析表达式：\n$$\n\\frac{\\partial m}{\\partial h} = \\frac{d}{dh} \\left[ \\tanh(\\beta(zJm + h)) \\right]\n$$\n应用链式法则：\n$$\n\\frac{\\partial m}{\\partial h} = \\text{sech}^2(\\beta(zJm + h)) \\cdot \\left[ \\beta \\left( zJ \\frac{\\partial m}{\\partial h} + 1 \\right) \\right]\n$$\n对该方程求解 $\\partial m / \\partial h$ 可得：\n$$\n\\frac{\\partial m}{\\partial h} = \\frac{\\beta\\,\\text{sech}^2(\\beta(zJm + h))}{1 - \\beta zJ\\,\\text{sech}^2(\\beta(zJm + h))}\n$$\n为了求得 $\\chi(T)$，我们在 $h=0$ 处计算此表达式。令 $m_0(T)$ 为温度 $T$ 下的稳定零场磁化强度。磁化率为：\n$$\n\\chi(T) = \\frac{\\beta\\,\\text{sech}^2(\\beta zJ m_0)}{1 - \\beta zJ\\,\\text{sech}^2(\\beta zJ m_0)}\n$$\n利用恒等式 $\\text{sech}^2(x) = 1 - \\tanh^2(x)$ 以及在 $h=0$ 时 $m_0 = \\tanh(\\beta zJ m_0)$ 这一事实，我们可以重写 $\\text{sech}^2(\\beta zJ m_0) = 1 - m_0^2$。这给出了一个更优雅且数值上更稳定的公式：\n$$\n\\chi(T) = \\frac{\\beta(1 - m_0^2)}{1 - \\beta zJ(1 - m_0^2)}\n$$\n$\\chi(T)$ 的计算步骤是：\n1.  对于给定温度 $T$，使用第 1 部分中描述的数值方法计算稳定的零场磁化强度 $m_0(T)$。\n2.  将 $T$ (以 $\\beta=1/T$ 的形式) 和计算出的 $m_0(T)$ 的值代入 $\\chi(T)$ 的最终表达式中。\n\n对于指定的参数，我们使用 $z=6$ 和 $J=1$，这给出的临界温度为 $T_c=6$。所有计算都在这些单位下进行。实现过程遵循这些推导出的原理来计算测试组所需的值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main solver function to compute magnetization and susceptibility for the given test cases\n    within the Weiss Mean-Field Theory for an Ising model.\n    \"\"\"\n    \n    # Define physical constants from the problem statement\n    Z = 6.0\n    J = 1.0\n    TC = Z * J  # Critical temperature\n\n    def _get_m_roots(T, h):\n        \"\"\"\n        Finds all real roots of the self-consistency equation m = tanh(β(zJm + h))\n        in the interval [-1, 1] using a grid search and a bracketing root-finder.\n        \"\"\"\n        if T <= 0:\n            raise ValueError(\"Temperature must be positive.\")\n        \n        beta = 1.0 / T\n        zJ = Z * J\n\n        def g(m_val):\n            return m_val - np.tanh(beta * (zJ * m_val + h))\n\n        roots = set()\n\n        # The function g(m) has g(-1) < 0 and g(1) > 0, so at least one root exists.\n        # To find all roots (up to three), we scan for sign changes on a fine grid.\n        m_grid = np.linspace(-1.0, 1.0, num=4001)\n        g_grid = g(m_grid)\n        \n        for i in range(len(m_grid) - 1):\n            if np.sign(g_grid[i]) != np.sign(g_grid[i+1]):\n                try:\n                    root = brentq(g, m_grid[i], m_grid[i+1])\n                    roots.add(root)\n                except ValueError:\n                    # This should not be reached due to the check for sign change\n                    pass\n        \n        # Ensure m=0 is considered if it is a root (case h=0)\n        if h == 0.0 and np.isclose(g(0.0), 0.0):\n            roots.add(0.0)\n\n        # As a fallback, if no sign changes were found (e.g., tangent root),\n        # brentq on the whole interval guarantees finding at least one root.\n        if not roots:\n            try:\n                root = brentq(g, -1.0, 1.0)\n                roots.add(root)\n            except ValueError:\n                # Highly unlikely given the properties of g(m)\n                pass\n\n        return list(roots)\n\n    def solve_m(T, h):\n        \"\"\"\n        Computes the stable magnetization m(T, h) by finding the root of the\n        self-consistency equation that minimizes the mean-field free energy.\n        \"\"\"\n        beta = 1.0 / T\n        zJ = Z * J\n        \n        roots = _get_m_roots(T, h)\n        \n        if not roots:\n            raise RuntimeError(f\"Could not find any solution for m at T={T}, h={h}.\")\n\n        if len(roots) == 1:\n            return roots[0]\n            \n        def free_energy(m_val):\n            \"\"\"Numerically stable free energy function.\"\"\"\n            arg = beta * (zJ * m_val + h)\n            # Use stable log(2*cosh(x)) = |x| + log(1+exp(-2|x|)) to avoid overflow\n            log_2cosh_term = np.abs(arg) + np.log(1.0 + np.exp(-2.0 * np.abs(arg)))\n            return 0.5 * zJ * m_val**2 - T * log_2cosh_term\n\n        energies = [free_energy(m_val) for m_val in roots]\n        stable_m = roots[np.argmin(energies)]\n        \n        # Apply special rule from problem for T<Tc, h=0 (degenerate minima)\n        if T < TC and h == 0.0:\n            return np.abs(stable_m)\n        \n        return stable_m\n\n    def calculate_chi(T):\n        \"\"\"\n        Calculates the zero-field susceptibility χ(T) using the analytical formula\n        derived from the self-consistency equation.\n        \"\"\"\n        beta = 1.0 / T\n        zJ = Z * J\n        \n        # Find the stable magnetization at zero field, m0\n        m0 = solve_m(T, 0.0)\n        \n        # Use derived expression: χ = β(1-m₀²)/(1-βzJ(1-m₀²))\n        m0_sq = m0**2\n        numerator = beta * (1.0 - m0_sq)\n        denominator = 1.0 - beta * zJ * (1.0 - m0_sq)\n        \n        if np.isclose(denominator, 0.0):\n            # This happens exactly at T=Tc, where χ diverges\n            return np.inf\n        \n        return numerator / denominator\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'type': 'm', 'T': 6.5, 'h': 0.1},\n        {'type': 'm', 'T': 5.5, 'h': 0.0},\n        {'type': 'm', 'T': 6.0, 'h': 1e-4},\n        {'type': 'm', 'T': 100.0, 'h': 1.0},\n        {'type': 'm', 'T': 0.5, 'h': -1.0e-6},\n        {'type': 'chi', 'T': 6.1},\n        {'type': 'chi', 'T': 5.9},\n    ]\n\n    results = []\n    \n    # Calculate magnetizations and susceptibilities\n    for case in test_cases:\n        if case['type'] == 'm':\n            results.append(solve_m(case['T'], case['h']))\n        elif case['type'] == 'chi':\n            results.append(calculate_chi(case['T']))\n\n    # The 8th result is the amplitude ratio R\n    chi_6_1 = results[5]\n    chi_5_9 = results[6]\n    R = chi_6_1 / chi_5_9\n    results.append(R)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3008495"}]}