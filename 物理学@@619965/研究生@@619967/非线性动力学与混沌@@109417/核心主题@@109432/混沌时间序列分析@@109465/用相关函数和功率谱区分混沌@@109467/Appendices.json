{"hands_on_practices": [{"introduction": "理解相关性的第一步是观察当它被破坏时会发生什么。本练习通过比较一个完全有序的周期信号与其随机打乱后的版本，直观地展示了这一点。通过计算二者自相关函数的差异 [@problem_id:864203]，我们可以具体地体会到自相关函数是如何量化时间序列中固有的时间结构的。", "problem": "逻辑斯谛映射(logistic map)是非线性动力学中的一个典型模型，由迭代函数 $x_{n+1} = f(x_n) = r x_n (1 - x_n)$ 描述。对于参数 $r$ 的某些特定值，该系统会最终进入一个稳定的周期轨道。\n\n考虑参数设置为 $r = 1 + \\sqrt{5}$ 的逻辑斯谛映射。在此参数值下，其长期动力学行为会收敛到一个稳定的二周期轨道，在两个不同的值（我们记为 $x_A$ 和 $x_B$）之间交替。这会生成一个确定性的周期性时间序列 $\\{x_n\\}$，可以写作 $x_A, x_B, x_A, x_B, \\dots$（假设初始条件合适）。\n\n探测时间序列中时间结构的一种常用技术，是将其性质与一个随机打乱后版本的性质进行比较。让我们通过随机打乱周期序列 $\\{x_n\\}$ 来构建第二个时间序列 $\\{y_n\\}$。对于一个无限长的序列，这等价于从轨道点集合 $\\{x_A, x_B\\}$ 中独立地、以均等概率抽取来生成每一项 $y_n$。\n\n对于一个均值为 $\\mu$ 的平稳时间序列 $\\{z_n\\}$，其单步自相关函数 $C(1)$ 定义为期望值 $C(1) = E[(z_n - \\mu)(z_{n+1} - \\mu)]$。该量度量了序列中相继点之间的相关性。\n\n设 $C_{orig}(1)$ 为原始周期性时间序列 $\\{x_n\\}$ 的单步自相关， $C_{shuf}(1)$ 为随机打乱的时间序列 $\\{y_n\\}$ 的单步自相关。这两者之差 $\\Delta C(1) = C_{orig}(1) - C_{shuf}(1)$ 量化了被随机打乱过程所破坏的时间相关性。\n\n你的任务是计算这个差值 $\\Delta C(1)$。", "solution": "**步骤1：确定二周期轨道的点**\n\n一个二周期轨道由两个点 $x_A$ 和 $x_B$ 组成，使得 $x_B = f(x_A)$ 且 $x_A = f(x_B) = f(f(x_A))$。这些点是方程 $x = f(f(x))$ 的根，但同时不是 $x=f(x)$ 的不动点。对于逻辑斯谛映射 $x_{n+1}=rx_n(1-x_n)$，其二周期轨道的点由以下公式给出：\n$$ x_{A,B} = \\frac{r+1 \\pm \\sqrt{(r+1)(r-3)}}{2r} $$\n给定 $r = 1 + \\sqrt{5}$。让我们将此值代入平方根下的表达式中：\n$$ (r+1)(r-3) = (1+\\sqrt{5}+1)(1+\\sqrt{5}-3) = (2+\\sqrt{5})(\\sqrt{5}-2) = (\\sqrt{5})^2 - 2^2 = 5 - 4 = 1 $$\n这极大地简化了轨道点的计算：\n$$ x_{A,B} = \\frac{(1+\\sqrt{5})+1 \\pm \\sqrt{1}}{2(1+\\sqrt{5})} = \\frac{2+\\sqrt{5} \\pm 1}{2(1+\\sqrt{5})} $$\n这给出了两个不同的点：\n$$ x_A = \\frac{2+\\sqrt{5} + 1}{2(1+\\sqrt{5})} = \\frac{3+\\sqrt{5}}{2(1+\\sqrt{5})} $$\n为了简化此表达式，我们将分子和分母同乘以分母的共轭：\n$$ x_A = \\frac{3+\\sqrt{5}}{2(1+\\sqrt{5})} \\times \\frac{1-\\sqrt{5}}{1-\\sqrt{5}} = \\frac{3-3\\sqrt{5}+\\sqrt{5}-5}{2(1-5)} = \\frac{-2-2\\sqrt{5}}{-8} = \\frac{1+\\sqrt{5}}{4} $$\n第二个点是：\n$$ x_B = \\frac{2+\\sqrt{5} - 1}{2(1+\\sqrt{5})} = \\frac{1+\\sqrt{5}}{2(1+\\sqrt{5})} = \\frac{1}{2} $$\n所以，该二周期轨道中的点集为 $S = \\{ \\frac{1+\\sqrt{5}}{4}, \\frac{1}{2} \\}$。\n\n**步骤2：计算时间序列的均值**\n\n原始周期序列 $\\{x_n\\}$ 和打乱后的序列 $\\{y_n\\}$ 都是由相同的值集合 $S$ 构建的。在这两种情况下，从长远来看，这两个值以相同的频率出现。因此，两个序列的均值 $\\mu$ 是相同的：\n$$ \\mu = E[x_n] = E[y_n] = \\frac{x_A + x_B}{2} $$\n$$ \\mu = \\frac{1}{2}\\left(\\frac{1+\\sqrt{5}}{4} + \\frac{1}{2}\\right) = \\frac{1}{2}\\left(\\frac{1+\\sqrt{5}+2}{4}\\right) = \\frac{3+\\sqrt{5}}{8} $$\n\n**步骤3：计算原始周期序列的自相关 $C_{orig}(1)$**\n\n原始序列为 $\\{x_n\\} = x_A, x_B, x_A, x_B, \\dots$。期望值 $E[\\cdot]$ 是通过对轨道的一个完整周期进行平均来计算的。相继点对 $(x_n, x_{n+1})$ 要么是 $(x_A, x_B)$，要么是 $(x_B, x_A)$，每种情况出现的概率均为 $1/2$。\n$$ C_{orig}(1) = E[(x_n - \\mu)(x_{n+1} - \\mu)] = \\frac{1}{2} \\left[ (x_A - \\mu)(x_B - \\mu) + (x_B - \\mu)(x_A - \\mu) \\right] = (x_A - \\mu)(x_B - \\mu) $$\n让我们计算每个点与均值的偏差：\n$$ x_A - \\mu = \\frac{1+\\sqrt{5}}{4} - \\frac{3+\\sqrt{5}}{8} = \\frac{2(1+\\sqrt{5}) - (3+\\sqrt{5})}{8} = \\frac{2+2\\sqrt{5}-3-\\sqrt{5}}{8} = \\frac{\\sqrt{5}-1}{8} $$\n$$ x_B - \\mu = \\frac{1}{2} - \\frac{3+\\sqrt{5}}{8} = \\frac{4 - (3+\\sqrt{5})}{8} = \\frac{1-\\sqrt{5}}{8} $$\n现在我们计算它们的乘积：\n$$ C_{orig}(1) = \\left(\\frac{\\sqrt{5}-1}{8}\\right) \\left(\\frac{1-\\sqrt{5}}{8}\\right) = -\\frac{(\\sqrt{5}-1)^2}{64} = -\\frac{5 - 2\\sqrt{5} + 1}{64} = -\\frac{6-2\\sqrt{5}}{64} = -\\frac{3-\\sqrt{5}}{32} = \\frac{\\sqrt{5}-3}{32} $$\n\n**步骤4：计算打乱后序列的自相关 $C_{shuf}(1)$**\n\n对于打乱后的序列 $\\{y_n\\}$，每个元素都从集合 $S$ 中独立抽取。其单步自相关为 $C_{shuf}(1) = E[(y_n - \\mu)(y_{n+1} - \\mu)]$。由于 $y_n$ 和 $y_{n+1}$ 的统计独立性，乘积的期望等于期望的乘积：\n$$ C_{shuf}(1) = E[y_n - \\mu] \\cdot E[y_{n+1} - \\mu] $$\n根据均值 $\\mu$ 的定义，与均值的偏差的期望为零：\n$$ E[y_n - \\mu] = E[y_n] - \\mu = \\mu - \\mu = 0 $$\n因此，\n$$ C_{shuf}(1) = 0 \\cdot 0 = 0 $$\n\n**步骤5：计算差值 $\\Delta C(1)$**\n\n最后，我们计算两个自相关值之间的差：\n$$ \\Delta C(1) = C_{orig}(1) - C_{shuf}(1) = \\frac{\\sqrt{5}-3}{32} - 0 = \\frac{\\sqrt{5}-3}{32} $$\n这个负值反映了在一个高于均值的值 ($x_A$) 和一个低于均值的值 ($x_B$) 之间交替的系统中预期的反相关性。随机打乱过程通过破坏这种确定性顺序，将单步自相关减小到零，这是白噪声过程的一个特征。", "answer": "$$ \\boxed{\\frac{\\sqrt{5}-3}{32}} $$", "id": "864203"}, {"introduction": "在理解了相关性衡量的是什么之后，让我们将这个概念应用于一个真正的混沌系统。本练习将计算著名的逻辑斯蒂映射在其完全混沌状态下的总功率，这等价于方差或零延迟自相关 $C(0)$ [@problem_id:864192]。这个实践介绍了利用系统的不变概率密度来计算其统计特性的关键技术，这是分析混沌动力学的基石。", "problem": "在非线性动力系统的研究中，功率谱是区分不同类型行为（如周期、准周期和混沌运动）的关键工具。对于由离散映射生成的时间序列 $\\{x_n\\}$，功率谱 $S(\\omega)$ 揭示了其动力学的频率成分。周期和准周期系统表现为具有离散狄拉克δ函数峰的功率谱，而混沌系统的特征是连续的宽带谱。\n\n总功率通过对所有频率的功率谱进行积分得到，它与滞后 $k=0$ 时的自相关函数 $C(k) = \\langle (x_{n+k} - \\langle x \\rangle)(x_n - \\langle x \\rangle) \\rangle$ 相关。具体而言，对于一个平稳过程，总积分功率与信号的方差成正比，即 $C(0) = \\text{Var}(x)$。\n\n对于一个遍历系统，时间平均 $\\langle \\cdot \\rangle$ 可以被在不变概率密度函数 $\\rho(x)$ 上的系综平均所替代。方差由下式给出：\n$$\n\\text{Var}(x) = \\langle (x - \\langle x \\rangle)^2 \\rangle = \\int (x - \\langle x \\rangle)^2 \\rho(x) dx\n$$\n其中 $\\langle x \\rangle = \\int x' \\rho(x') dx'$。\n\n考虑逻辑斯蒂映射，一个展现混沌的经典系统例子，其由以下递归关系定义：\n$$\nx_{n+1} = r x_n (1 - x_n)\n$$\n其中 $x_n \\in [0, 1]$。在参数值 $r=4$ 时，系统处于完全混沌状态。对于此特定情况，状态变量 $x$ 在区间 $(0, 1)$ 上的不变概率密度函数 $\\rho(x)$ 已知为：\n$$\n\\rho(x) = \\frac{1}{\\pi\\sqrt{x(1-x)}}\n$$\n您的任务是计算逻辑斯蒂映射在 $r=4$ 时的总积分功率。如前所述，这等同于计算 $x$ 相对于其不变密度的方差。", "solution": "我们希望计算\n$$\n\\Var(x)=\\int_0^1 (x-\\langle x\\rangle)^2\\,\\rho(x)\\,dx,\n$$ \n其中 \n$$\n\\rho(x)=\\frac1{\\pi\\sqrt{x(1-x)}}, \n\\qquad \\langle x\\rangle=\\int_0^1 x\\,\\rho(x)\\,dx.\n$$\n\n1. 通过贝塔积分计算平均值 $\\langle x\\rangle$。定义\n$$\nE[x^n]=\\int_0^1 x^n\\,\\rho(x)\\,dx\n=\\frac1\\pi\\int_0^1 x^n\\,x^{-\\tfrac12}(1-x)^{-\\tfrac12}dx\n=\\frac1\\pi B\\bigl(n+\\tfrac12,\\tfrac12\\bigr).\n$$\n对于 $n=1$，\n$$\n\\langle x\\rangle=E[x]\n=\\frac1\\pi B\\bigl(\\tfrac32,\\tfrac12\\bigr)\n=\\frac1\\pi\\frac{\\Gamma(\\tfrac32)\\,\\Gamma(\\tfrac12)}{\\Gamma(2)}.\n$$\n使用 $\\Gamma(\\tfrac12)=\\sqrt\\pi$ 和 $\\Gamma(\\tfrac32)=\\tfrac12\\sqrt\\pi$，\n$$\nB\\bigl(\\tfrac32,\\tfrac12\\bigr)\n=\\frac{\\tfrac12\\sqrt\\pi\\cdot\\sqrt\\pi}{1}\n=\\frac{\\pi}{2},\n$$\n所以\n$$\n\\langle x\\rangle=\\frac1\\pi\\cdot\\frac{\\pi}{2}=\\frac12.\n$$\n\n2. 类似地计算 $E[x^2]$：\n$$\nE[x^2]\n=\\frac1\\pi B\\bigl(\\tfrac52,\\tfrac12\\bigr)\n=\\frac1\\pi\\frac{\\Gamma(\\tfrac52)\\,\\Gamma(\\tfrac12)}{\\Gamma(3)}.\n$$\n使用 $\\Gamma(\\tfrac52)=\\tfrac32\\cdot\\tfrac12\\sqrt\\pi=\\tfrac{3}{4}\\sqrt\\pi$ 和 $\\Gamma(3)=2$，\n$$\nB\\bigl(\\tfrac52,\\tfrac12\\bigr)\n=\\frac{\\tfrac{3}{4}\\sqrt\\pi\\cdot\\sqrt\\pi}{2}\n=\\frac{3\\pi}{8},\n$$\n因此\n$$\nE[x^2]=\\frac1\\pi\\cdot\\frac{3\\pi}{8}=\\frac{3}{8}.\n$$\n\n3. 所以方差为\n$$\n\\Var(x)=E[x^2]-\\bigl(E[x]\\bigr)^2\n=\\frac{3}{8}-\\Bigl(\\frac12\\Bigr)^2\n=\\frac{3}{8}-\\frac{1}{4}\n=\\frac{1}{8}.\n$$", "answer": "$$\\boxed{1/8}$$", "id": "864192"}, {"introduction": "时间序列分析中的一个核心挑战是区分确定性混沌和随机噪声。最后的这个练习直面了这一问题，要求你构建一个简单的随机模型（一个 AR(1) 过程）来模仿一个混沌映射的短期相关性 [@problem_id:864236]。通过比较它们在不同时间延迟下的相关性，我们可以开始体会到那些使我们能够区分这两种根本不同类型过程的微妙但重要的差异。", "problem": "在非线性动力学的研究中，一个关键问题是判断一个给定的时间序列是由确定性混沌系统还是随机过程生成的。像自相关函数（ACF）这样的统计工具常被用来探测其内在动力学。虽然一些混沌系统可以产生不相关的时间序列（如白噪声），但许多系统会表现出随时间衰减的短期相关性。\n\n一种能够表现出指数衰减相关性的简单随机模型是1阶自回归过程，或称AR(1)过程。如果时间序列 $\\{y_n\\}$ 是由映射 $y_n = \\alpha y_{n-1} + \\epsilon_n$ 生成的，那么它就是一个AR(1)过程。其中 $|\\alpha| < 1$ 是一个常数参数，$\\{\\epsilon_n\\}$ 是一个零均值、独立同分布（i.i.d.）的随机变量序列（白噪声），且与过去的 $y$ 值不相关。对于一个平稳AR(1)过程，其归一化自相关函数由 $C_{AR(1)}(k) = \\alpha^k$ 给出（对于 $k \\ge 0$）。\n\n考虑一个定义在单位区间 $[0,1]$ 上的确定性混沌映射 $f_p(x)$：\n$$\nx_{n+1} = f_p(x_n) = \\begin{cases}\nx_n/p & \\text{if } 0 \\le x_n \\le p \\\\\n(1-x_n)/(1-p) & \\text{if } p < x_n \\le 1\n\\end{cases}\n$$\n其中 $p$ 是一个参数，满足 $0 < p < 1$ 且 $p \\neq 1/2$。对于任何这样的 $p$，该映射都是混沌和遍历的，并具有一个均匀不变概率密度函数 $\\rho(x)=1$（对于 $x \\in [0,1]$）。通过迭代此映射，可以生成一个时间序列 $\\{x_n\\}$。此确定性时间序列的归一化自相关函数定义为 $C_{map}(k) = \\frac{\\langle (x_{n+k} - \\mu)(x_n - \\mu) \\rangle}{\\sigma^2}$，其中 $\\mu$ 是均值，$\\sigma^2$ 是方差，$\\langle \\cdot \\rangle$ 表示在不变分布上的平均值。\n\n我们需要构建一个AR(1)过程，作为一个简单的随机模型来模仿该混沌映射的一步相关性。为此，选择其参数 $\\alpha$，使得AR(1)过程的一步自相关与混沌映射的一步自相关相匹配，即 $C_{AR(1)}(1) = C_{map}(1)$。\n\n你的任务是求出这个特别构造的AR(1)过程的两步自相关 $C_{AR(1)}(2)$。请用参数 $p$ 来表示你的答案。", "solution": "我们希望匹配AR(1)过程的参数 $\\alpha=C_{\\rm map}(1)$，然后计算\n$$C_{AR(1)}(2)=\\alpha^2\\,. $$\n\n1. 不变密度 $\\rho(x)=1$ 在 $[0,1]$ 上 ⇒ \n   $$\\mu=E[x]=\\int_0^1x\\,dx=\\frac12,\\qquad \n     \\sigma^2=E[x^2]-\\mu^2=\\frac1{3}-\\frac1{4}=\\frac1{12}\\,. $$\n\n2. 计算 $E[x_nx_{n+1}]=E[x\\,f_p(x)]$：\n   将积分在 $x=p$ 处拆分，\n   \n$$\n   E[x\\,f_p(x)]\n   =\\int_0^p x\\frac{x}{p}\\,dx+\\int_p^1 x\\frac{1-x}{1-p}\\,dx\n   =\\frac1p\\int_0^p x^2dx+\\frac1{1-p}\\int_p^1 x(1-x)dx.\n   $$\n\n   计算：\n   \n$$\n     \\frac1p\\cdot\\frac{p^3}{3}\n     =\\frac{p^2}{3},\n     \\quad\n     \\int_p^1x(1-x)dx\n     =\\frac{1-p^2}{2}-\\frac{1-p^3}{3}\n     =\\frac{1-3p^2+2p^3}{6},\n   $$\n\n   所以\n   \n$$\n     \\frac{1}{1-p}\\cdot\\frac{1-3p^2+2p^3}{6}\n     =\\frac{-2p^2+p+1}{6}.\n   $$\n\n   因此\n   \n$$\n     E[x_nx_{n+1}]\n     =\\frac{p^2}{3}+\\frac{-2p^2+p+1}{6}\n     =\\frac{p+1}{6}\\,.\n   $$\n\n\n3. 一步自协方差为\n   \n$$\n     \\Cov(x_n,x_{n+1})\n     =E[x_nx_{n+1}]-\\mu^2\n     =\\frac{p+1}{6}-\\frac14\n     =\\frac{2p-1}{12}\\,,\n   $$\n\n   所以，归一化一步自相关为\n   \n$$\n     C_{\\rm map}(1)\n     =\\frac{\\Cov(x_n,x_{n+1})}{\\sigma^2}\n     =\\frac{\\tfrac{2p-1}{12}}{\\tfrac{1}{12}}\n     =2p-1\n     \\equiv \\alpha.\n   $$\n\n\n4. 因此，AR(1)过程的两步自相关为\n   $$\n     C_{AR(1)}(2)=\\alpha^2=(2p-1)^2.\n   $$", "answer": "$$\\boxed{(2p-1)^2}$$", "id": "864236"}]}