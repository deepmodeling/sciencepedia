{"hands_on_practices": [{"introduction": "在从时间序列重构吸引子的过程中，第一步是选择一个合适的时间延迟 $\\tau$。一个好的 $\\tau$ 值可以确保延迟坐标矢量中的分量足够独立，从而在重构的相空间中更好地展开吸引子。本练习将引导你使用一种常见且有效的方法——寻找时间序列自相关函数的第一个零点——来确定一个周期信号的最佳 $\\tau$ 值，为后续的重构工作打下坚实的基础 [@problem_id:854826]。", "problem": "在非线性动力系统的研究中，一种从单一时间序列可观测量 $x(t)$ 重构相空间的常用技术是时间延迟嵌入法。该方法受到Takens定理的支持，通过使用信号的延迟副本来构建一个高维空间中的向量：$\\mathbf{X}(t) = (x(t), x(t-\\tau), x(t-2\\tau), \\dots, x(t-(m-1)\\tau))$。时间延迟 $\\tau$ 的选择对于忠实重构系统的吸引子至关重要。\n\n一种选择最优 $\\tau$ 的流行启发式方法是选择对应于时间序列自相关函数首次过零点的值。这可以确保坐标 $x(t)$ 和 $x(t-\\tau)$ 足够独立。\n\n对于一个周期为 $T$ 的连续、零均值的周期信号 $x(t)$，其自相关函数定义为：\n$$R_{xx}(\\tau) = \\frac{1}{T} \\int_0^T x(t) x(t+\\tau) \\,dt$$\n\n考虑由两个正弦波叠加给出的特定时间序列：\n$$x(t) = A \\sin(\\omega t) + B \\sin(2\\omega t)$$\n其中 $A$、$B$ 和 $\\omega$ 是正常数。该信号是周期性的，周期为 $T = 2\\pi/\\omega$，且均值为零。\n\n计算使自相关函数 $R_{xx}(\\tau)$ 为零的最小正时间延迟 $\\tau > 0$。", "solution": "我们有\n$$x(t)=A\\sin(\\omega t)+B\\sin(2\\omega t),\\quad T=\\frac{2\\pi}{\\omega}$$\n和自相关函数\n$$R_{xx}(\\tau)=\\frac{1}{T}\\int_0^T x(t)\\,x(t+\\tau)\\,dt.$$\n1. 展开被积函数，注意到不同谐波的交叉项在一个周期内的平均值为零。因此\n$$R_{xx}(\\tau)\n=\\frac{A^2}{T}\\int_0^T\\sin(\\omega t)\\sin[\\omega(t+\\tau)]\\,dt\n+\\frac{B^2}{T}\\int_0^T\\sin(2\\omega t)\\sin[2\\omega(t+\\tau)]\\,dt.$$\n2. 使用恒等式\n$$\\frac{1}{T}\\int_0^T\\sin(k t)\\sin[k(t+\\tau)]\\,dt=\\frac{1}{2}\\cos(k\\tau)$$\n其中 $k$ 为整数。因此\n$$R_{xx}(\\tau)\n=\\frac{A^2}{2}\\cos(\\omega\\tau)+\\frac{B^2}{2}\\cos(2\\omega\\tau).$$\n3. 令 $R_{xx}(\\tau)=0$:\n$$A^2\\cos(\\omega\\tau)+B^2\\cos(2\\omega\\tau)=0.$$\n4. 使用 $\\cos(2\\theta)=2\\cos^2\\theta-1$ 并令 $\\theta=\\omega\\tau$:\n$$A^2\\cos\\theta+B^2\\bigl(2\\cos^2\\theta-1\\bigr)=0\n\\;\\Rightarrow\\;2B^2c^2+A^2c-B^2=0,\\quad c=\\cos\\theta.$$\n5. 解关于 $c$ 的二次方程：\n$$c=\\frac{-A^2\\pm\\sqrt{A^4+8B^4}}{4B^2}.$$\n只有带“+”号的根位于 $[-1,1]$ 区间内。因此\n$$\\cos(\\omega\\tau)=\\frac{-A^2+\\sqrt{A^4+8B^4}}{4B^2}$$\n且最小正解为\n$$\\tau=\\frac{1}{\\omega}\\arccos\\!\\Bigl(\\frac{\\sqrt{A^4+8B^4}-A^2}{4B^2}\\Bigr).$$", "answer": "$$\\boxed{\\frac{1}{\\omega}\\arccos\\!\\Bigl(\\frac{\\sqrt{A^4+8B^4}-A^2}{4B^2}\\Bigr)}$$", "id": "854826"}, {"introduction": "选择了时间延迟 $\\tau$ 之后，下一个关键步骤是确定足以“展开”吸引子而无自相交的最小嵌入维度 $m$。伪最近邻 (False Nearest Neighbors, FNN) 算法是解决此问题的有力工具，其核心思想是：在过低的维度中因投影而彼此靠近的点（伪邻居），在维度增加时通常会分离开来。这个练习将让你通过一个具体的计算，亲身体验 FNN 算法如何量化这种分离，从而判断邻近点的真伪 [@problem_id:854905]。", "problem": "在非线性动力学中，系统的相空间可以利用时间延迟坐标法从一个标量时间序列中重构。对于一个时间序列 $x(t)$，我们构建 $m$ 维向量 $\\vec{y}(t) = (x(t), x(t+\\tau), \\dots, x(t+(m-1)\\tau))$，其中 $\\tau$ 是一个固定的时间延迟。根据 Takens 定理，如果嵌入维度 $m$ 足够大，由向量 $\\vec{y}(t)$ 描绘出的重构吸引子的几何结构与原系统的吸引子在拓扑上是等价的。\n\n一个关键步骤是确定最小的充分嵌入维度 $m_{min}$。假近邻 (FNN) 算法是完成此任务的一种广泛使用的启发式方法。其核心思想是，如果维度 $m$ 太低，真实吸引子上相距很远的点可能会被投影到彼此附近，从而产生“假近邻”。当嵌入维度增加到 $m+1$ 时，这些假近邻通常会彼此远离。\n\n在 $\\mathbb{R}^m$ 中识别假近邻对 $(\\vec{P}, \\vec{Q})$ 的一个判据是，计算它们在新增加维度上的分离距离与它们在原始 $m$ 维空间中分离距离的比率。具体来说，设 $\\vec{P} = (p_1, \\dots, p_m)$ 是一个点，$\\vec{Q}=(q_1, \\dots, q_m)$ 是它在 $\\mathbb{R}^m$ 中的最近邻。设 $p_{m+1}$ 和 $q_{m+1}$ 是构成 $\\mathbb{R}^{m+1}$ 中相应向量所需的分量。测试比率定义为：\n$$ C = \\frac{|p_{m+1} - q_{m+1}|}{R_m(\\vec{P}, \\vec{Q})} $$\n其中 $R_m(\\vec{P}, \\vec{Q})$ 是 $\\vec{P}$ 和 $\\vec{Q}$ 之间的欧几里得距离。如果 $C$ 的值超过某个阈值，则表明 $\\vec{Q}$ 很可能是 $\\vec{P}$ 的一个假近邻。\n\n考虑一个分析，其中正在评估嵌入维度从 $m=2$ 增加到 $m=3$ 的情况。在 2 维嵌入空间中，一个参考点 $\\vec{P}$ 及其最近邻 $\\vec{Q}$ 由下式给出：\n$$ \\vec{P} = (v, v/\\lambda) $$\n$$ \\vec{Q} = (v+\\delta, v/\\lambda - 2\\delta) $$\n将这些向量扩展到第 3 维所需的时间序列值为 $p_3 = \\mu$ 和 $q_3 = \\nu$。参数 $v, \\lambda, \\delta, \\mu, \\nu$ 是正常数。\n\n计算这对点的 FNN 测试比率 $C$。", "solution": "1. FNN 测试比率为\n$$\nC = \\frac{|p_3 - q_3|}{R_2(\\vec P,\\vec Q)}.\n$$\n2. 分子：由于 $p_3=\\mu$， $q_3=\\nu$，\n$$\n|p_3 - q_3| = |\\mu - \\nu|.\n$$\n3. 分母：二维距离\n$$\nR_2(\\vec P,\\vec Q)\n= \\sqrt{(p_1-q_1)^2 + (p_2-q_2)^2}.\n$$\n4. 代入 $\\vec P=(v,v/\\lambda)$，$\\vec Q=(v+\\delta,\\,v/\\lambda-2\\delta)$：\n\n$$\np_1-q_1 = v - (v+\\delta) = -\\delta,\n\\quad\np_2-q_2 = \\frac{v}{\\lambda} - \\Bigl(\\frac{v}{\\lambda}-2\\delta\\Bigr) = 2\\delta.\n$$\n\n因此\n$$\nR_2 = \\sqrt{(-\\delta)^2 + (2\\delta)^2}\n= \\sqrt{\\delta^2 + 4\\delta^2}\n= \\sqrt{5\\,\\delta^2}\n= \\delta\\sqrt{5}.\n$$\n5. 所以\n$$\nC = \\frac{|\\mu - \\nu|}{\\delta\\sqrt{5}}.\n$$", "answer": "$$\\boxed{\\frac{|\\mu - \\nu|}{\\delta\\sqrt{5}}}$$", "id": "854905"}, {"introduction": "当使用恰当的 $\\tau$ 和 $m$ 成功重构吸引子后，我们便可以开始分析其几何性质以提取系统的不变量。关联积分 $C(r)$ 是一个基本工具，它通过计算在给定半径 $r$ 内点的对数比例来量化吸引子上的点密度。这个练习提供了一个在小数据集上计算 $C(r)$ 的动手实践，这是估算分形维数（如关联维数）等重要动力学特征的第一步 [@problem_id:854917]。", "problem": "在非线性动力系统的研究中，可以使用延迟坐标法从标量时间序列重构相空间。给定一个长度为 $L$ 的离散时间序列 $\\{s_n\\}_{n=1}^L$，可以在一个 $m$ 维重构相空间中构建一个向量序列。对于嵌入维度 $m$ 和时间延迟 $\\tau$ （采样间隔的整数倍），状态向量定义为：\n$$ \\vec{x}_n = (s_n, s_{n+\\tau}, s_{n+2\\tau}, \\dots, s_{n+(m-1)\\tau}) $$\n这些向量是为 $n = 1, 2, \\dots, N$ 构建的，其中向量总数为 $N = L - (m-1)\\tau$。\n\n在重构空间中得到的点云的一个基本几何性质由相关积分 $C(r)$ 捕获。它通过测量分离距离不超过指定半径 $r$ 的点对所占的比例来量化吸引子上的点密度。标准定义为：\n$$ C(r) = \\frac{1}{N(N-1)} \\sum_{i=1}^{N} \\sum_{j=1, j \\neq i}^{N} \\Theta(r - ||\\vec{x}_i - \\vec{x}_j||) $$\n此处，$\\Theta(z)$ 是亥维赛德阶跃函数，定义为当 $z \\ge 0$ 时 $\\Theta(z)=1$，当 $z < 0$ 时 $\\Theta(z)=0$。向量之间的距离使用一个合适的范数 $||\\cdot||$ 来测量。\n\n考虑一个长度为 $L=6$ 的特定时间序列，由下式给出：\n$$ \\{s_n\\}_{n=1}^6 = \\{0, 3, 1, 4, 2, 5\\} $$\n使用嵌入维度 $m=2$ 和时间延迟 $\\tau=1$，构建延迟向量。随后，计算当半径为 $r = 5/2$ 时相关积分 $C(r)$ 的值。对于距离计算，使用最大范数（$L_\\infty$ 范数），对于两个向量 $\\vec{a}=(a_1, \\dots, a_m)$ 和 $\\vec{b}=(b_1, \\dots, b_m)$，其定义为 $||\\vec{a} - \\vec{b}||_\\infty = \\max_{k=1,\\dots,m} |a_k - b_k|$。\n\n$C(5/2)$ 的精确值是多少？", "solution": "我们有 $L=6$，$m=2$，$\\tau=1$，因此\n$$N \\;=\\; L - (m-1)\\tau \\;=\\; 6 - 1 \\;=\\;5.$$\n延迟向量为\n$$\n\\vec x_1=(s_1,s_2)=(0,3),\\quad\n\\vec x_2=(3,1),\\quad\n\\vec x_3=(1,4),\\quad\n\\vec x_4=(4,2),\\quad\n\\vec x_5=(2,5).\n$$\n使用 $L_\\infty$‐范数，\n$$\nd_{ij} \\;=\\; \\|\\vec x_i-\\vec x_j\\|_\\infty\n\\;=\\;\\max\\bigl(|s_i-s_j|,\\;|s_{i+1}-s_{j+1}|\\bigr).\n$$\n计算不同的无序距离（$i<j$）：\n\n$$\n\\begin{array}{c|cccc}\n(i,j)&(1,2)&(1,3)&(1,4)&(1,5)\\\\\\hline\nd_{ij}&3&1&4&2\n\\end{array}\n\\quad\n\\begin{array}{c|ccc}\n(i,j)&(2,3)&(2,4)&(2,5)\\\\\\hline\nd_{ij}&3&1&4\n\\end{array}\n\\quad\n\\begin{array}{c|cc}\n(i,j)&(3,4)&(3,5)\\\\\\hline\nd_{ij}&3&1\n\\end{array}\n\\quad\n\\begin{array}{c|c}\n(i,j)&(4,5)\\\\\\hline\nd_{ij}&3\n\\end{array}\n$$\n\n对于半径 $r=\\tfrac52$，亥维赛德检验 $\\Theta(r-d_{ij})=1$ 恰好对 $d_{ij}\\in\\{1,2\\}$ 的无序对成立，即 $(1,3),(1,5),(2,4),(3,5)$。共有 $4$ 个这样的无序对，或者 $8$ 个有序对。因此\n$$\nC\\!\\bigl(\\tfrac52\\bigr)\n\\;=\\;\\frac{1}{N(N-1)}\\sum_{i\\neq j}\\Theta\\!\\bigl(\\tfrac52-d_{ij}\\bigr)\n\\;=\\;\\frac{8}{5\\cdot4}\n\\;=\\;\\frac{2}{5}.\n$$", "answer": "$$\\boxed{\\frac{2}{5}}$$", "id": "854917"}]}