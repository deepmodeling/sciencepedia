{"hands_on_practices": [{"introduction": "当一个可积系统受到微小扰动时，其原有的守恒量（如作用量 $I$）通常不再精确守恒。然而，正则微扰理论使我们能够找到一个新的、近似守恒的量，从而理解系统的长期行为。本练习以一个受立方势扰动的谐振子为例，指导你计算对原作用量的一阶修正，让你亲身体验寻找近可积系统中近似不变量的基本方法 [@problem_id:886164]。", "problem": "一个质量为 $m$、角频率为 $\\omega$ 的一维谐振子，其哈密顿量为 $H_0(q, p) = \\frac{p^2}{2m} + \\frac{1}{2} m \\omega^2 q^2$。该系统是可积的，其动力学可以用作用量-角变量 $(I, \\theta)$ 来描述，其中作用量为 $I = H_0/\\omega$，角变量为 $\\theta$。$(q, p)$ 与 $(I, \\theta)$ 之间的变换关系如下：\n$$q = \\sqrt{\\frac{2I}{m\\omega}} \\sin \\theta$$\n$$p = \\sqrt{2m\\omega I} \\cos \\theta$$\n\n现在，考虑一个对该系统的微扰，其哈密顿量为 $H = H_0 + \\epsilon H_1$，其中 $H_1 = q^3$，$ \\epsilon$ 是一个小参数。由于微扰的存在，原始作用量 $I$ 不再守恒。然而，根据正则微扰理论，可以找到一个新的变量，即微扰作用量 $I'$，它是一个近似的运动守恒量。这个新的作用量可以表示为关于 $\\epsilon$ 的级数：\n$$I'(q,p) = I(q,p) + \\epsilon I_1(q,p) + O(\\epsilon^2)$$\n其中 $I_1(q,p)$ 是对作用量的一阶修正。\n\n你的任务是求出该微扰谐振子的一阶修正 $I_1$。请用原始相空间坐标 $q$ 和 $p$ 的函数来表示你的最终答案。", "solution": "系统的总哈密顿量为 $H = H_0 + \\epsilon H_1$，其中 $H_0 = \\frac{p^2}{2m} + \\frac{1}{2} m \\omega^2 q^2$，并且 $H_1 = q^3$。\n\n我们使用正则微扰理论来寻找一个新的作用量变量 $I'$，它在 $\\epsilon$ 的一阶近似下是守恒的。标准流程包括寻找一个从旧的作用量-角变量 $(I, \\theta)$到新变量 $(I', \\theta')$ 的正则变换，使得新的哈密顿量 $K(I')$ 在 $\\epsilon$ 的一阶近似下与新的角变量 $\\theta'$ 无关。\n\n对作用量的一阶修正 $I_1$ 由以下公式给出：\n$$I_1 = \\frac{H_1 - \\langle H_1 \\rangle_\\theta}{\\omega_0(I)}$$\n其中 $\\omega_0(I) = \\frac{dH_0}{dI}$ 是未微扰频率，而 $\\langle H_1 \\rangle_\\theta$ 是微扰 $H_1$ 在一个未微扰运动周期内的平均值，这对应于对角变量 $\\theta$ 从 $0$ 到 $2\\pi$ 进行平均。\n\n首先，我们计算未微扰频率 $\\omega_0$。用作用量 $I$ 表示的未微扰哈密顿量是 $H_0(I) = I\\omega$。\n$$\\omega_0(I) = \\frac{d H_0}{dI} = \\frac{d(I\\omega)}{dI} = \\omega$$\n正如所预期的，简谐振子的频率是恒定的。\n\n接下来，我们将微扰 $H_1 = q^3$ 用未微扰的作用量-角变量 $(I, \\theta)$ 表示。使用给定的变换 $q = \\sqrt{\\frac{2I}{m\\omega}} \\sin \\theta$：\n$$H_1(I, \\theta) = \\left(\\sqrt{\\frac{2I}{m\\omega}}\\right)^3 \\sin^3 \\theta = \\left(\\frac{2I}{m\\omega}\\right)^{3/2} \\sin^3 \\theta$$\n\n现在，我们计算 $H_1$ 对 $\\theta$ 的平均值：\n$$\\langle H_1 \\rangle_\\theta = \\frac{1}{2\\pi} \\int_0^{2\\pi} H_1(I, \\theta) \\,d\\theta = \\left(\\frac{2I}{m\\omega}\\right)^{3/2} \\frac{1}{2\\pi} \\int_0^{2\\pi} \\sin^3 \\theta \\,d\\theta$$\n为了计算该积分，我们可以使用恒等式 $\\sin^3\\theta = \\frac{3}{4}\\sin\\theta - \\frac{1}{4}\\sin(3\\theta)$。\n$$\\int_0^{2\\pi} \\sin^3 \\theta \\,d\\theta = \\int_0^{2\\pi} \\left(\\frac{3}{4}\\sin\\theta - \\frac{1}{4}\\sin(3\\theta)\\right) d\\theta$$\n$$= \\left[-\\frac{3}{4}\\cos\\theta + \\frac{1}{12}\\cos(3\\theta)\\right]_0^{2\\pi}$$\n$$= \\left(-\\frac{3}{4} + \\frac{1}{12}\\right) - \\left(-\\frac{3}{4} + \\frac{1}{12}\\right) = 0$$\n另外，也可以注意到 $\\sin^3\\theta$ 是一个关于 $\\theta=\\pi$ 反射的奇函数，因此它在 $[0, 2\\pi]$ 上的积分为零。\n\n因此，微扰的平均值为零：\n$$\\langle H_1 \\rangle_\\theta = 0$$\n\n现在我们将这些结果代入 $I_1$ 的公式中：\n$$I_1 = \\frac{H_1 - 0}{\\omega} = \\frac{H_1}{\\omega}$$\n题目要求用原始坐标 $(q,p)$ 来表示 $I_1$。由于 $H_1 = q^3$，我们有：\n$$I_1(q,p) = \\frac{q^3}{\\omega}$$\n\n因此，新的近似守恒的作用量变量为：\n$$I' = I + \\epsilon \\frac{q^3}{\\omega} + O(\\epsilon^2) = \\frac{1}{\\omega}\\left(\\frac{p^2}{2m} + \\frac{1}{2}m\\omega^2q^2\\right) + \\epsilon \\frac{q^3}{\\omega} + O(\\epsilon^2)$$\n一阶修正项为 $I_1 = q^3/\\omega$。", "answer": "$$ \\boxed{\\frac{q^3}{\\omega}} $$", "id": "886164"}, {"introduction": "微扰不仅会修正守恒量，还可能导致系统动力学行为发生质变，尤其是在分隔不同类型运动的分界线（separatrix）附近。本练习将探讨这些脆弱的结构在受到阻尼、常力矩和周期驱动力共同作用时的命运。你将运用强大的梅尔尼科夫方法（Melnikov method），通过分析经典的受迫摆模型，精确计算其稳定与不稳定流形发生相交、从而引发混沌动力学的临界条件 [@problem_id:886188]。", "problem": "考虑一个受到阻尼、周期性外力和恒定扭矩作用的摆。其运动方程为：\n$$ \\ddot{\\theta} + \\delta \\dot{\\theta} + \\omega_0^2 \\sin\\theta = \\Gamma + \\gamma \\cos(\\omega t) $$\n其中 $\\theta$ 是角位置，$\\omega_0$ 是无阻尼、无外力摆的固有频率，$\\delta$ 是阻尼系数，$\\Gamma$ 是恒定扭矩，$\\gamma$ 是周期性强迫力的振幅，$\\omega$ 是其频率。所有参数均为正常数。\n\n我们在小扰动极限下分析此系统，即 $\\delta, \\Gamma, \\gamma$ 均为小量。该系统可视为可积单摆 $\\ddot{\\theta} + \\omega_0^2 \\sin\\theta = 0$ 的一个扰动。在相平面 $(\\theta, \\dot{\\theta}) \\in \\mathbb{R}^2$ 上观察，未扰动系统在任意整数 $k$ 的 $((2k+1)\\pi, 0)$ 处具有鞍点。一条对应于异宿轨道的分割线将位于 $(-\\pi, 0)$ 的鞍点连接到位于 $(\\pi, 0)$ 的鞍点。\n\n在扰动下，鞍点持续存在，成为双曲周期轨道。这些轨道的稳定流形和不稳定流形可能会相交，从而导致混沌动力学。这种行为的开始可以通过 Melnikov 方法来预测，该方法提供了一种度量流形之间距离的方法。当此距离函数首次出现零点时，就会发生异宿相切。\n\n使用 Melnikov 积分，求出首次出现异宿相切时的临界强迫振幅 $\\gamma_c$。将您的答案表示为 $\\delta, \\Gamma, \\omega_0$ 和 $\\omega$ 的函数。", "solution": "运动方程为 $\\ddot{\\theta} + \\delta \\dot{\\theta} + \\omega_0^2 \\sin\\theta = \\Gamma + \\gamma \\cos(\\omega t)$。\n我们可以通过令 $x = \\theta$ 和 $y = \\dot{\\theta}$ 将其写成一阶系统：\n$$ \\dot{x} = y $$\n$$ \\dot{y} = -\\omega_0^2 \\sin x - \\delta y + \\Gamma + \\gamma \\cos(\\omega t) $$\n该系统可以写成 $\\dot{\\mathbf{z}} = \\mathbf{f}_0(\\mathbf{z}) + \\mathbf{g}(\\mathbf{z}, t)$ 的形式，其中 $\\mathbf{z} = (x, y)^T$。\n\n未扰动系统是单摆：\n$$ \\dot{x} = y = f_{0,x} $$\n$$ \\dot{y} = -\\omega_0^2 \\sin x = f_{0,y} $$\n这是一个哈密顿系统，其哈密顿量为 $H(x,y) = \\frac{1}{2}y^2 - \\omega_0^2 \\cos x$。鞍点位于 $(x,y) = ((2k+1)\\pi, 0)$。鞍点处的能量为 $H = -\\omega_0^2 \\cos(\\pi) = \\omega_0^2$。\n\n连接鞍点 $(-\\pi,0)$ 和 $(\\pi,0)$ 的异宿轨道 $q_0(t) = (x_0(t), y_0(t))$ 位于能量水平 $H=\\omega_0^2$ 上。\n$$ \\frac{1}{2}y_0^2 - \\omega_0^2 \\cos x_0 = \\omega_0^2 \\implies y_0^2 = 2\\omega_0^2(1+\\cos x_0) = 4\\omega_0^2 \\cos^2(x_0/2) $$\n这给出 $y_0 = \\pm 2\\omega_0 \\cos(x_0/2)$。我们为上分割线选择正根。\n从 $\\dot{x}_0 = y_0$，我们求解 $x_0(t)$：\n$$ \\frac{dx_0}{dt} = 2\\omega_0 \\cos(x_0/2) \\implies \\int \\frac{dx_0}{2\\cos(x_0/2)} = \\int \\omega_0 dt $$\n$$ \\int \\frac{1}{2}\\sec(x_0/2) dx_0 = \\omega_0 t + C' $$\n选择约定 $x_0(0)=0$（轨道的中心点），我们得到一个方便的参数化表示：\n$$ x_0(t) = 2 \\arctan(\\sinh(\\omega_0 t)) $$\n这满足当 $t \\to \\infty$ 时 $x_0(t) \\to \\pi$ 以及当 $t \\to -\\infty$ 时 $x_0(t) \\to -\\pi$。\n速度为：\n$$ y_0(t) = \\dot{x}_0(t) = 2 \\frac{\\omega_0 \\cosh(\\omega_0 t)}{1+\\sinh^2(\\omega_0 t)} = 2 \\frac{\\omega_0 \\cosh(\\omega_0 t)}{\\cosh^2(\\omega_0 t)} = 2\\omega_0 \\text{sech}(\\omega_0 t) $$\n因此，未扰动的异宿轨道是 $q_0(t) = (2 \\arctan(\\sinh(\\omega_0 t)), 2\\omega_0 \\text{sech}(\\omega_0 t))$。\n\n扰动向量为 $\\mathbf{g}(x, y, t) = (0, -\\delta y + \\Gamma + \\gamma \\cos(\\omega t))$。\nMelnikov 函数 $M(t_0)$ 度量了在 $t_0$ 时刻 Poincaré 截面上稳定流形和不稳定流形之间的有向距离。它由以下积分给出：\n$$ M(t_0) = \\int_{-\\infty}^{\\infty} \\mathbf{f}_0(q_0(t)) \\wedge \\mathbf{g}(q_0(t), t+t_0) \\, dt $$\n楔积为 $\\mathbf{f}_0 \\wedge \\mathbf{g} = f_{0,x} g_y - f_{0,y} g_x$。\n代入各分量：\n$$ \\mathbf{f}_0(q_0(t)) \\wedge \\mathbf{g}(q_0(t), t+t_0) = y_0(t)[-\\delta y_0(t) + \\Gamma + \\gamma \\cos(\\omega(t+t_0))] - (-\\omega_0^2 \\sin x_0(t))[0] $$\n$$ = \\Gamma y_0(t) - \\delta y_0(t)^2 + \\gamma y_0(t) \\cos(\\omega(t+t_0)) $$\nMelnikov 积分变为：\n$$ M(t_0) = \\Gamma \\int_{-\\infty}^{\\infty} y_0(t) dt - \\delta \\int_{-\\infty}^{\\infty} y_0(t)^2 dt + \\gamma \\int_{-\\infty}^{\\infty} y_0(t) \\cos(\\omega(t+t_0)) dt $$\n我们分别计算每个积分：\n\n1.  $\\int_{-\\infty}^{\\infty} y_0(t) dt = \\int_{-\\infty}^{\\infty} \\dot{x}_0(t) dt = x_0(\\infty) - x_0(-\\infty) = \\pi - (-\\pi) = 2\\pi$。\n\n2.  $\\int_{-\\infty}^{\\infty} y_0(t)^2 dt = \\int_{-\\infty}^{\\infty} (2\\omega_0 \\text{sech}(\\omega_0 t))^2 dt = 4\\omega_0^2 \\int_{-\\infty}^{\\infty} \\text{sech}^2(\\omega_0 t) dt$。\n    令 $u = \\omega_0 t$, $du = \\omega_0 dt$。\n    积分为 $4\\omega_0 \\int_{-\\infty}^{\\infty} \\text{sech}^2(u) du = 4\\omega_0 [\\tanh u]_{-\\infty}^{\\infty} = 4\\omega_0 (1 - (-1)) = 8\\omega_0$。\n\n3.  $\\int_{-\\infty}^{\\infty} y_0(t) \\cos(\\omega(t+t_0)) dt = \\int_{-\\infty}^{\\infty} 2\\omega_0 \\text{sech}(\\omega_0 t) (\\cos(\\omega t)\\cos(\\omega t_0) - \\sin(\\omega t)\\sin(\\omega t_0)) dt$。\n    因为 $\\text{sech}(\\omega_0 t)$ 是偶函数，所以含有 $\\sin(\\omega t)$（奇函数）的项的积分为零。\n    积分变为 $2\\omega_0 \\cos(\\omega t_0) \\int_{-\\infty}^{\\infty} \\text{sech}(\\omega_0 t) \\cos(\\omega t) dt$。\n    这个积分是 sech 函数的傅里叶变换。\n    $\\int_{-\\infty}^{\\infty} e^{-ikz} \\text{sech}(az) dz = \\frac{\\pi}{a} \\text{sech}(\\frac{\\pi k}{2a})$。\n    取实部，并设 $z=t, k=\\omega, a=\\omega_0$，我们得到 $\\int_{-\\infty}^{\\infty} \\cos(\\omega t) \\text{sech}(\\omega_0 t) dt = \\frac{\\pi}{\\omega_0} \\text{sech}(\\frac{\\pi\\omega}{2\\omega_0})$。\n    所以这部分是 $2\\omega_0 \\cos(\\omega t_0) \\left( \\frac{\\pi}{\\omega_0} \\text{sech}\\left(\\frac{\\pi\\omega}{2\\omega_0}\\right) \\right) = 2\\pi \\cos(\\omega t_0) \\text{sech}\\left(\\frac{\\pi\\omega}{2\\omega_0}\\right)$。\n\n结合这些结果，Melnikov 函数是：\n$$ M(t_0) = 2\\pi\\Gamma - 8\\omega_0\\delta + 2\\pi\\gamma \\text{sech}\\left(\\frac{\\pi\\omega}{2\\omega_0}\\right) \\cos(\\omega t_0) $$\n当 $\\gamma$ 从零开始增加时，$M(t_0)$ 首次出现零点，此时发生异宿相切。这对应于常数项的大小与振荡项的振幅相等的条件。\n当 $\\max_{t_0} | - 2\\pi\\gamma_c \\text{sech}(\\frac{\\pi\\omega}{2\\omega_0}) \\cos(\\omega t_0) | = | 2\\pi\\Gamma - 8\\omega_0\\delta |$ 时，可以找到临界振幅 $\\gamma_c$。\n$$ 2\\pi\\gamma_c \\text{sech}\\left(\\frac{\\pi\\omega}{2\\omega_0}\\right) = |2\\pi\\Gamma - 8\\omega_0\\delta| $$\n求解 $\\gamma_c$：\n$$ \\gamma_c = \\frac{|2\\pi\\Gamma - 8\\omega_0\\delta|}{2\\pi \\text{sech}\\left(\\frac{\\pi\\omega}{2\\omega_0}\\right)} = \\frac{|\\pi\\Gamma - 4\\omega_0\\delta|}{\\pi} \\cosh\\left(\\frac\\pi\\omega{2\\omega_0}\\right) $$", "answer": "$$ \\boxed{\\frac{|\\pi\\Gamma - 4\\omega_0\\delta|}{\\pi} \\cosh\\left(\\frac{\\pi\\omega}{2\\omega_0}\\right)} $$", "id": "886188"}, {"introduction": "尽管微扰会导致混沌，但著名的KAM定理揭示了并非所有规则运动都会被摧毁，许多不变环面（invariant tori）在扰动下依然存在。本练习将视角切换到离散映射——标准映射，这是研究哈密顿混沌的一个范例模型。你将着手计算一个在微扰下得以幸存的不变曲线（KAM曲线）的一阶形变，从而具体地感受这些具有韧性的结构是如何被“扭曲”而非被完全破坏的 [@problem_id:886255]。", "problem": "标准映射是哈密顿混沌研究中的一个范式模型，它描述了一个“受踢转子”的动力学。从第 $n$ 步的坐标 $(p_n, \\theta_n)$ 到第 $n+1$ 步的坐标 $(p_{n+1}, \\theta_{n+1})$ 的变换由下式给出\n$$\n\\begin{aligned}\np_{n+1} &= p_n + K \\sin(\\theta_n) \\\\\n\\theta_{n+1} &= \\theta_n + p_{n+1} \\pmod{2\\pi}\n\\end{aligned}\n$$\n此处，$p$ 是动量，$\\theta \\in [0, 2\\pi)$ 是角度，$K$ 是非线性参数。\n\n对于可积情况 $K=0$，动量是守恒的，$p_{n+1} = p_n$。相空间被不变曲线（即水平线 $p = I_0$）所叶化，其中 $I_0$ 是一个常数。在每条这样的曲线上，角度 $\\theta$ 在每一步增加 $I_0$，因此 $I_0$ 是旋转数。\n\n对于小的非零 $K$，Kolmogorov-Arnold-Moser (KAM) 定理指出，大部分这些不变曲线（那些具有“足够无理”旋转数的曲线）不会被破坏，而仅仅是发生形变。我们可以使用正则微扰理论来找到这些受扰动曲线的形状。\n\n我们寻求一个从原始坐标 $(p, \\theta)$ 到新坐标 $(I, \\phi)$ 的正则变换，该变换由一个形式为 $S(\\theta, I) = \\theta I + K S_1(\\theta, I) + O(K^2)$ 的生成函数定义，使得新的作用量 $I$ 是该映射的一个不变量。受扰动的不变曲线则由条件 $I=I_0$ 描述，其中 $I_0$ 是未扰动曲线的作用量。这条曲线在原始相空间中的形状可以表示为 $p = p(\\theta)$。\n\n在 $K$ 的一阶近似下，对应于未扰动曲线 $p=I_0$ 的受扰动不变曲线的方程可以写为：\n$$\np(\\theta) = I_0 + K f(\\theta, I_0) + O(K^2)\n$$\n假设 $I_0$ 不是 $2\\pi$ 的整数倍，求出描述不变曲线一阶修正的函数 $f(\\theta, I_0)$。", "solution": "我们寻求 $f(\\theta,I_0)$，使得在受扰动的不变曲线上\n$$p(\\theta)=I_0+K\\,f(\\theta,I_0)+O(K^2)$$\n且映射\n$$\\begin{cases}\np_{n+1}=p_n+K\\sin\\theta_n,\\\\\n\\theta_{n+1}=\\theta_n+p_{n+1},\n\\end{cases}$$\n将 $(\\theta,p(\\theta))$ 映为 $(\\theta',p(\\theta'))$，其中 $\\theta'=\\theta+p(\\theta)+O(K^2)$ 且\n$$p(\\theta')=p(\\theta)+K\\sin\\theta+O(K^2)\\,. $$\n令 $I_0+K\\,f(\\theta',I_0)=I_0+K\\bigl(f(\\theta,I_0)+\\sin\\theta\\bigr)$ 并舍去 $O(K^2)$ 项，得到函数方程\n$$f(\\theta+I_0,I_0)-f(\\theta,I_0)=\\sin\\theta\\,. $$\n我们用傅里叶级数求解。写出\n$$f(\\theta)=\\sum_{m}f_m\\,e^{im\\theta},\\qquad \\sin\\theta=\\frac{e^{i\\theta}-e^{-i\\theta}}{2i}\\,. $$\n那么对于每个 $m$，\n$$f_m\\bigl(e^{imI_0}-1\\bigr)=\\frac{1}{2i}\\bigl[\\delta_{m,1}-\\delta_{m,-1}\\bigr].$$\n因此只有 $m=\\pm1$ 有贡献：\n\n$$\nf_1=\\frac{1}{2i(e^{iI_0}-1)}\n=-\\frac{e^{-iI_0/2}}{4\\sin(I_0/2)}, \n\\quad\nf_{-1}=-\\frac{1}{2i(e^{-iI_0}-1)}\n=-\\frac{e^{\\,iI_0/2}}{4\\sin(I_0/2)}.\n$$\n\n因此\n\n$$\nf(\\theta)\n=f_1e^{i\\theta}+f_{-1}e^{-i\\theta}\n=-\\frac{1}{4\\sin(I_0/2)}\\Bigl(e^{i(\\theta-\\frac{I_0}{2})}+e^{-i(\\theta-\\frac{I_0}{2})}\\Bigr)\n=-\\frac{\\cos\\!\\bigl(\\theta-\\tfrac{I_0}{2}\\bigr)}{2\\sin(\\tfrac{I_0}{2})}\\,,\n$$\n\n这确实满足 $f(\\theta+I_0)-f(\\theta)=\\sin\\theta$。", "answer": "$$\\boxed{-\\frac{\\cos\\!\\bigl(\\theta-\\tfrac{I_0}{2}\\bigr)}{2\\sin\\!\\bigl(\\tfrac{I_0}{2}\\bigr)}}$$", "id": "886255"}]}