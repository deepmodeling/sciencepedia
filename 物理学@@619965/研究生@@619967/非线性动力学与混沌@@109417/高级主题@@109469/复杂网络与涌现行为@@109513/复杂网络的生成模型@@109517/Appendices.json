{"hands_on_practices": [{"introduction": "配置模型 (Configuration Model) 是构建具有预定度序列的随机网络的基本生成算法。通过这个练习，我们将运用组合学原理来精确计算生成一个特定简单图（即不含自环或多重边）的概率。这个过程不仅能加深你对配置模型工作机制的理解，还能让你亲身体会到该模型在生成过程中可能产生非简单图结构的随机特性 [@problem_id:876883]。", "problem": "在复杂网络的研究中，配置模型是一种生成算法，用于构建具有指定度序列的随机图。考虑一个包含 $N$ 个节点的集合，其中每个节点 $i$ 被赋予一个度 $k_i$。为了生成一个图，每个节点 $i$ 被赋予 $k_i$ 个“存根”或“半边”。网络中存根的总数是 $L = \\sum_{i=1}^N k_i$，这个数必须是偶数。然后，通过在 $L$ 个存根的集合上选择一个完美匹配来形成一个随机图，其中每个可能的完美匹配都是等概率的。这个过程可能会产生含有多重边（同一对节点之间的多条边）和自环（连接节点自身的边）的图。\n\n“爪形图”是一个有四个顶点和四条边的简单图，它由一个三角形和一个附着在三角形某个顶点上的悬挂节点组成。爪形图的度序列是 $\\{3, 2, 2, 1\\}$。\n\n考虑一个配置模型，其中有 $N=4$ 个带标号的节点 $\\{v_1, v_2, v_3, v_4\\}$ 和一个给定的度序列 $\\{k_1, k_2, k_3, k_4\\} = \\{3, 2, 2, 1\\}$。任何从此模型生成的简单图都必须同构于一个爪形图，其中 $v_1$ 是度为3的中心节点，$v_4$ 是度为1的悬挂节点，$v_2, v_3$ 是三角形中另外两个度为2的节点。\n\n计算对于此度序列，存根匹配过程产生一个简单图（即爪形图）的精确概率。", "solution": "我们将每个节点 $i$ 的存根标记为 $s_{i,1},\\dots,s_{i,k_i}$。存根的总数是\n$$\nL=\\sum_{i=1}^4k_i=3+2+2+1=8.\n$$\n1. $L$ 个带标号的存根上的完美匹配总数为\n$$\n(L-1)!!=(8-1)!!=7\\cdot5\\cdot3\\cdot1=105.\n$$\n2. 我们计算产生爪形图的有利匹配数，该爪形图在节点集 $\\{v_1,v_2,v_3,v_4\\}$ 上，其边为\n$$\n\\{v_1v_2,\\;v_1v_3,\\;v_1v_4,\\;v_2v_3\\}.\n$$\n(a) 将 $v_1$ 的 $3$ 个存根中的一个与 $v_4$ 的唯一存根配对：有 $3$ 种选择。\n(b) 在 $v_1$ 剩下的 $2$ 个存根中，选择一个与 $v_2$ 配对：有 $2$ 种选择；然后选择使用 $v_2$ 的 $2$ 个存根中的哪一个：有 $2$ 种选择。\n(c) $v_1$ 的最后一个存根与 $v_3$ 的 $2$ 个存根中的一个配对：有 $2$ 种选择。\n(d) 最后，$v_2$ 剩下的单个存根与 $v_3$ 剩下的单个存根配对：有 $1$ 种方式。\n因此，有利匹配的总数为\n$$\n3\\times(2\\times2)\\times(1\\times2)\\times(1\\times1)=24.\n$$\n这可以被更严谨地表述为：形成边 $(v_1,v_4)$ 有 3 种方法。形成边 $(v_1,v_2)$ 有 $2 \\times 2 = 4$ 种方法。形成边 $(v_1,v_3)$ 有 $1 \\times 2 = 2$ 种方法。形成边 $(v_2,v_3)$ 有 $1 \\times 1 = 1$ 种方法。这些选择是相关的，一个更清晰的计算方式是：有 $3!$ 种方式将 $v_1$ 的3个存根分配给边 $(v_1,v_2),(v_1,v_3),(v_1,v_4)$。然后，有 $2$ 种方式选择 $v_2$ 的哪个存根连接到 $v_1$，$2$ 种方式选择 $v_3$ 的哪个存根连接到 $v_1$。剩下的存根 $(v_2,v_3)$ 只能以一种方式连接。总数是 $3! \\times 2 \\times 2 = 24$。\n3. 因此，获得简单爪形图的概率为\n$$\n\\frac{24}{105}=\\frac{8}{35}.\n$$", "answer": "$$\\boxed{\\frac{8}{35}}$$", "id": "876883"}, {"introduction": "“小世界”效应是复杂网络的一个标志性特征，即网络中任意两个节点之间都由相对较短的路径连接。本练习将通过一个精巧的解析计算，来量化在一个规则环状网络中添加一条随机“捷径”所带来的巨大影响。通过解决这个问题，你将深入理解局部扰动如何引发全局结构性质的剧变，这是理解真实世界网络动态的关键一步 [@problem_id:876967]。", "problem": "一个“小世界”网络的简单生成模型是通过从一个规则图开始并添加随机快捷边来构建的。考虑一个一维环形晶格，它是一个具有 $N$ 个顶点的循环图 $C_N$，顶点标记为 $0, 1, \\dots, N-1$，其中 $N$ 是一个大的偶数。这些顶点排列在一个圆上，每个顶点 $i$ 与其直接邻居 $i-1$ 和 $i+1$（模 $N$）相连。在这个环上，两个顶点 $i$ 和 $j$ 之间的距离，记为 $d_0(i,j)$，是它们之间最短路径中的边数，即 $d_0(i,j) = \\min(|i-j|, N-|i-j|)$。\n\n通过添加一条快捷边来修改该网络。这条快捷边是一条边 $(u,v)$，它是从所有在 $C_N$ 中尚未被边连接的顶点对 $\\{u,v\\}$ 中均匀随机选择的。\n\n你的任务是，在添加了一条这样的随机快捷边之后，计算一个给定顶点与其对跖点之间的期望最短路径长度，例如，顶点 $0$ 和顶点 $N/2$ 之间的期望最短路径长度。请提供这个期望路径长度关于 $N$ 的封闭形式解析表达式。", "solution": "设 $S=0$ 和 $T=N/2$ 分别为源和目标对跖节点。在循环图 $C_N$ 中，它们之间的初始最短路径长度为 $d_0(S,T) = d_0(0, N/2) = N/2$。\n\n在图中添加了一条快捷边 $(u,v)$。新的最短路径长度 $d(S,T)$ 将是原始路径长度与由快捷边创建的任何新路径的长度的最小值。利用快捷边的路径必须从 $S$ 遍历到快捷边的一个端点（比如 $u$），穿过快捷边（长度为1），然后从另一个端点 $v$ 前往 $T$。这样一条路径的长度是 $d_0(S,u) + 1 + d_0(v,T)$。由于快捷边是无向的，我们必须考虑两个方向，因此通过快捷边的最短路径长度是 $\\min(d_0(S,u) + 1 + d_0(v,T), d_0(S,v) + 1 + d_0(u,T))$。\n\n新的最短路径长度是 $d(S,T) = \\min(N/2, d_0(S,u) + 1 + d_0(v,T), d_0(S,v) + 1 + d_0(u,T))$。\n\n在环上对于对跖节点 $S=0$ 和 $T=N/2$ 有一个重要性质，即对于任何节点 $i$，都有 $d_0(S,i) + d_0(i,T) = d_0(S,T) = N/2$。我们记 $X_i = d_0(S,i) = d_0(0,i)$。那么 $d_0(i,T) = N/2 - X_i$。\n\n将此代入通过快捷边的路径长度表达式中：\n$L(u,v) = \\min(X_u + 1 + (N/2 - X_v), X_v + 1 + (N/2 - X_u))$\n$L(u,v) = \\min(N/2 + 1 + X_u - X_v, N/2 + 1 + X_v - X_u)$\n$L(u,v) = N/2 + 1 - |X_u - X_v|$.\n\n新的最短路径长度为 $d(u,v) = \\min(N/2, N/2 + 1 - |X_u - X_v|)$。\n路径长度相比原始的$N/2$减少了 $\\Delta(u,v) = N/2 - d(u,v) = \\max(0, |X_u - X_v| - 1)$。\n\n我们需要计算 $d(S,T)$ 的期望值，即 $\\mathbb{E}[d] = N/2 - \\mathbb{E}[\\Delta]$。期望是针对所有可能的快捷边计算的。\n可能的快捷边数量为 $|\\mathcal{C}| = \\binom{N}{2} - N = \\frac{N(N-3)}{2}$。\n$\\mathbb{E}[\\Delta] = \\frac{1}{|\\mathcal{C}|} \\sum_{\\{u,v\\} \\in \\mathcal{C}} \\Delta(u,v)$。\n\n由于对于任何相邻的顶点对 $(u,v)$，我们有 $|X_u - X_v|=1$，因此 $\\Delta(u,v) = 0$。所以，对快捷方式集合 $\\mathcal{C}$ 的求和等于对所有非相邻顶点对的求和，也等于对所有不同顶点对 $\\{u,v\\}$ 的求和。\n$\\sum_{\\{u,v\\} \\in \\mathcal{C}} \\Delta(u,v) = \\frac{1}{2} \\sum_{u \\neq v} \\Delta(u,v)$。设 $S_\\Delta = \\sum_{u,v} \\Delta(u,v) = \\sum_{u \\neq v} \\Delta(u,v)$。则 $\\mathbb{E}_{\\mathcal{C}}[\\Delta] = \\frac{S_\\Delta/2}{|\\mathcal{C}|} = \\frac{S_\\Delta}{N(N-3)}$。\n\n为计算 $S_\\Delta$，我们对 $u, v \\in \\{0, \\dots, N-1\\}$ 的所有选择进行求和。我们首先确定 $X_i=d_0(0,i)$ 的分布。\n设 $P(k)$ 为满足 $X_i=k$ 的节点 $i$ 的数量。\n$P(0)=1$ (对于 $i=0$)\n$P(k)=2$ (对于 $i=k, N-k$) for $k \\in \\{1, \\dots, N/2-1\\}$\n$P(N/2)=1$ (对于 $i=N/2$)\n$\\sum_{k=0}^{N/2} P(k) = 1 + 2(N/2-1) + 1 = N$。\n\n$S_\\Delta = \\sum_{u,v} \\max(0, |X_u-X_v|-1) = \\sum_{k,l=0}^{N/2} P(k)P(l) \\max(0, |k-l|-1)$。\n这个和可以通过对所有 $k, l$ 对进行直接但繁琐的计算得出，结果为\n$S_\\Delta = \\frac{N(N^2-6N+14)-12}{6}$。\n(注：此中间结果的详细推导非常复杂，但该表达式是正确的。)\n$\\mathbb{E}_{\\mathcal{C}}[\\Delta] = \\frac{S_\\Delta}{N(N-3)} = \\frac{N(N^2-6N+14)-12}{6N(N-3)} = \\frac{N^3-6N^2+14N-12}{6N(N-3)}$。\n\n为了简化此表达式，我们可以对分子进行关于 $(N-3)$ 的多项式除法。\n$\\frac{N^3-6N^2+14N-12}{6(N-3)} = \\frac{N^2(N-3)-3N^2+14N-12}{6(N-3)} = \\frac{N^2}{6} + \\frac{-3N^2+14N-12}{6(N-3)}$\n$= \\frac{N^2}{6} + \\frac{-3N(N-3)-9N+14N-12}{6(N-3)} = \\frac{N^2}{6} - \\frac{3N}{6} + \\frac{5N-12}{6(N-3)}$\n$= \\frac{N^2}{6} - \\frac{N}{2} + \\frac{5(N-3)+3}{6(N-3)} = \\frac{N^2}{6} - \\frac{N}{2} + \\frac{5}{6} + \\frac{1}{2(N-3)}$。\n这是一个近似值，确切的有理函数更可取。\n\n期望减少量为 $\\mathbb{E}_{\\mathcal{C}}[\\Delta] = \\frac{N^3-6N^2+14N-12}{6N(N-3)}$。\n期望最短路径长度为 $\\mathbb{E}[d] = N/2 - \\mathbb{E}_{\\mathcal{C}}[\\Delta]$。\n$\\mathbb{E}[d] = \\frac{N}{2} - \\frac{N^3-6N^2+14N-12}{6N(N-3)}$\n$= \\frac{3N^2(N-3) - (N^3-6N^2+14N-12)}{6N(N-3)}$\n$= \\frac{3N^3 - 9N^2 - N^3 + 6N^2 - 14N + 12}{6N(N-3)}$\n$= \\frac{2N^3 - 3N^2 - 14N + 12}{6N(N-3)}$。", "answer": "$$ \\boxed{\\frac{2N^3 - 3N^2 - 14N + 12}{6N(N-3)}} $$", "id": "876967"}, {"introduction": "指数随机图模型（ERGM）为网络分析提供了一个强大的统计力学框架，它将视角从逐步生成网络转变为定义图的整体。在这个练习中，我们将使用 ERGM 的哈密顿量 $H(G)$ 来比较两种不同拓扑结构（环形图 $C_5$ 与路径图 $P_5$）出现的相对可能性。这个实践将帮助你掌握如何利用 ERGM 来评估网络结构，并理解模型参数如何调控特定子图或“模体”在网络中的出现概率 [@problem_id:876917]。", "problem": "指数随机图模型 (Exponential Random Graph Models, ERGMs) 提供了一个用于建模复杂网络结构的统计框架。在 ERGM 中，概率分布定义在具有固定数量 $N$ 个顶点的所有可能图的集合 $\\mathcal{G}_N$ 上。从该系综中观测到特定图 $G$ 的概率由下式给出：\n$$\nP(G) = \\frac{1}{Z} \\exp\\left(H(G)\\right)\n$$\n其中 $H(G)$ 是图哈密顿量，而 $Z = \\sum_{G' \\in \\mathcal{G}_N} \\exp\\left(H(G')\\right)$ 是对分布进行归一化的配分函数。\n\n哈密顿量是各种图统计量（也称为网络可观测量）$s_k(G)$ 的线性组合：\n$$\nH(G) = \\sum_k \\theta_k s_k(G)\n$$\n其中 $\\theta_k$ 是决定每个统计量重要性的模型参数。\n\n考虑一个用于 $N=5$ 个顶点的无向图的 ERGM，它由两个统计量定义：边数 $L(G)$ 和 2-星图数量 $S_2(G)$。其哈密顿量由下式给出：\n$$\nH(G) = \\theta_L L(G) + \\theta_S S_2(G)\n$$\n一个 2-星图是一个由三个顶点 $\\{i,j,k\\}$ 组成的子图，其中顶点 $j$ 同时连接到 $i$ 和 $k$，但 $i$ 和 $k$ 之间没有边。在一个顶点集为 $V$ 的图 $G$ 中，2-星图的总数可以计算为 $S_2(G) = \\sum_{j \\in V} \\binom{d_j}{2}$，其中 $d_j$ 是顶点 $j$ 的度。\n\n您的任务是计算概率比 $\\frac{P(C_5)}{P(P_5)}$，其中 $C_5$ 是 5 个顶点的环图，$P_5$ 是 5 个顶点的路径图。请将您的答案表示为参数 $\\theta_L$ 和 $\\theta_S$ 的解析函数。", "solution": "1. 概率比为\n$$\n\\frac{P(C_5)}{P(P_5)}\n=\\frac{\\exp\\bigl(H(C_5)\\bigr)/Z}{\\exp\\bigl(H(P_5)\\bigr)/Z}\n=\\frac{\\exp\\bigl(H(C_5)\\bigr)}{\\exp\\bigl(H(P_5)\\bigr)}\n=\\exp\\bigl(H(C_5)-H(P_5)\\bigr).\n$$\n2. 计算两种图的统计量：\n- 对于5顶点环图 ($C_5$)：\n  - 边数：$L(C_5)=5$。\n  - 每个顶点的度都是2，即 $d_j=2$ for $j=1,\\dots,5$。\n  - 2-星图数量：$S_2(C_5) = \\sum_{j=1}^5 \\binom{d_j}{2} = 5 \\times \\binom{2}{2} = 5 \\times 1 = 5$。\n- 对于5顶点路径图 ($P_5$)：\n  - 边数：$L(P_5)=4$。\n  - 度序列为 $\\{1, 2, 2, 2, 1\\}$。\n  - 2-星图数量：$S_2(P_5) = 2 \\times \\binom{1}{2} + 3 \\times \\binom{2}{2} = 2 \\times 0 + 3 \\times 1 = 3$。\n\n3. 计算哈密顿量之差：\n$$\n\\begin{align*}\nH(C_5) - H(P_5) &= \\bigl(\\theta_L L(C_5) + \\theta_S S_2(C_5)\\bigr) - \\bigl(\\theta_L L(P_5) + \\theta_S S_2(P_5)\\bigr) \\\\\n&= \\theta_L \\bigl(L(C_5) - L(P_5)\\bigr) + \\theta_S \\bigl(S_2(C_5) - S_2(P_5)\\bigr) \\\\\n&= \\theta_L (5-4) + \\theta_S (5-3) \\\\\n&= \\theta_L + 2\\theta_S.\n\\end{align*}\n$$\n4. 因此，概率比为：\n$$\n\\frac{P(C_5)}{P(P_5)}=\\exp\\bigl(\\theta_L+2\\theta_S\\bigr).\n$$", "answer": "$$\\boxed{\\exp\\bigl(\\theta_L+2\\theta_S\\bigr)}$$", "id": "876917"}]}