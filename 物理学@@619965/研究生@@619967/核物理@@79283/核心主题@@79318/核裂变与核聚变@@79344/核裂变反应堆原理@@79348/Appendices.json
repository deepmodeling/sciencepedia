{"hands_on_practices": [{"introduction": "反应堆的临界状态对其几何形状极其敏感。在工程实践中，由于热膨胀、制造公差或结构变形，反应堆的物理边界可能会发生微小变化。微扰理论提供了一个强大的数学工具，使我们能够在不重新求解复杂的扩散方程的情况下，估算这些微小变化对反应堆临界状态的影响。本练习 [@problem_id:405684] 将指导您应用一阶微扰理论，通过伴随通量加权的方法，具体计算由边界变形引起的几何曲率变化，从而加深对微扰理论在反应堆物理中应用的理解。", "problem": "考虑一个裸堆、均匀、临界的圆柱形核反应堆，其未扰动半径为$R_0$，高度为$H_0$。中子布居由双群扩散理论描述。快中子（第一群）和热中子（第二群）通量$\\phi_1(\\vec{r})$和$\\phi_2(\\vec{r})$满足以下稳态方程：\n$$\nD_1 \\nabla^2 \\phi_1 - \\Sigma_{R1} \\phi_1 + \\nu\\Sigma_{f2} \\phi_2 = 0\n$$\n$$\nD_2 \\nabla^2 \\phi_2 - \\Sigma_{a2} \\phi_2 + \\Sigma_{s1\\to2} \\phi_1 = 0\n$$\n其中$D_g$是扩散系数，$\\Sigma_{R1}$是快中子移除截面，$\\Sigma_{a2}$是热中子吸收截面，$\\Sigma_{s1\\to2}$是从群1到群2的散射截面，$\\nu\\Sigma_{f2}$是中子产生截面（裂变仅由热中子引起，并产生快中子）。反应堆材料由这些常数参数指定。\n\n未受扰动的反应堆是临界的，其通量在由$r=R_0$和$z=0, H_0$定义的外推边界上为零。解的形式为$\\phi_g(r,z) = \\Phi_g J_0(\\frac{\\nu_0 r}{R_0})\\sin(\\frac{\\pi z}{H_0})$，其中$J_0$是第一类零阶贝塞尔函数，$\\nu_0$是它的第一个零点（$J_0(\\nu_0)=0$）。\n\n现在反应堆的径向边界受到扰动，使得新的半径由$R(z) = R_0 + d_0 \\sin^2\\left(\\frac{\\pi z}{H_0}\\right)$给出，其中$d_0$是一个小的常数位移（$d_0 \\ll R_0$）。高度保持为$H_0$。\n\n使用基于伴随通量法的一阶微扰理论，计算由该边界变形引起的几何曲率变化$\\delta B_g^2$。用$R_0$、$d_0$和$\\nu_0$表示你的答案。", "solution": "我们考虑未扰动几何的亥姆霍兹特征值问题，\n$$\\nabla^2\\phi + B^2\\phi=0,\\quad \\phi|_{r=R_0}=0,\\;\\phi|_{z=0,H_0}=0,$$\n其特征函数为\n$$\\phi(r,z)=N\\,J_0\\!\\Bigl(\\nu_0\\frac{r}{R_0}\\Bigr)\\sin\\!\\Bigl(\\frac{\\pi z}{H_0}\\Bigr),\\quad\nB^2=\\Bigl(\\frac{\\nu_0}{R_0}\\Bigr)^2+\\Bigl(\\frac{\\pi}{H_0}\\Bigr)^2,$$\n其中 $J_0(\\nu_0)=0$。\n\n在一个小的径向边界位移\n$$\\delta r(z)=d_0\\sin^2\\!\\Bigl(\\frac{\\pi z}{H_0}\\Bigr),$$\n下，特征值的一阶移动由形状微扰公式给出\n$$\n\\delta B^2\n=-\\frac{\\displaystyle\\int_{\\partial V}\n\\bigl|\\partial_n\\phi\\bigr|^2\\,\\delta r\\,dS}\n{\\displaystyle\\int_V\\phi^2\\,dV}\\,.\n$$\n\n1. 在$r=R_0$处的法向导数：\n$$\n\\partial_n\\phi=\\partial_r\\phi\\Big|_{r=R_0}\n=-N\\,\\frac{\\nu_0}{R_0}\\,J_1(\\nu_0)\\,\\sin\\!\\Bigl(\\frac{\\pi z}{H_0}\\Bigr)\\,.\n$$\n\n2. 分母（归一化）：\n\n$$\n\\int_V\\phi^2\\,dV\n=N^2\\,(2\\pi)\\int_0^{R_0}J_0^2\\!\\Bigl(\\nu_0\\frac{r}{R_0}\\Bigr)\\,rdr\n\\int_0^{H_0}\\sin^2\\!\\Bigl(\\frac{\\pi z}{H_0}\\Bigr)dz\n=N^2\\,\\frac{\\pi R_0^2H_0}{2}\\,J_1^2(\\nu_0)\\,.\n$$\n\n\n3. 分子：\n\n$$\n\\int_{\\partial V}|\\partial_n\\phi|^2\\,\\delta r\\,dS\n=\\int_0^{2\\pi}\\!\\!d\\theta\\int_0^{H_0}\n\\Bigl[N^2\\frac{\\nu_0^2}{R_0^2}J_1^2(\\nu_0)\\sin^2\\!\\tfrac{\\pi z}{H_0}\\Bigr]\n\\,d_0\\sin^2\\!\\tfrac{\\pi z}{H_0}\\,R_0\\,dz\n$$\n\n\n$$\n= N^2\\,\\frac{\\nu_0^2}{R_0}\\,J_1^2(\\nu_0)\\,d_0\\,(2\\pi)\\,\n\\int_0^{H_0}\\sin^4\\!\\tfrac{\\pi z}{H_0}\\,dz\n= N^2\\,\\frac{\\nu_0^2}{R_0}\\,J_1^2(\\nu_0)\\,d_0\\,\n\\frac{3\\pi H_0}{4}\\,.\n$$\n\n\n4. 组合计算$\\delta B^2$：\n$$\n\\delta B^2\n=-\\frac{N^2\\,\\dfrac{\\nu_0^2}{R_0}\\,J_1^2(\\nu_0)\\,d_0\\,\\dfrac{3\\pi H_0}{4}}\n{N^2\\,\\dfrac{\\pi R_0^2H_0}{2}\\,J_1^2(\\nu_0)}\n=-\\frac{3\\,\\nu_0^2\\,d_0}{2\\,R_0^3}\\,. \n$$", "answer": "$$\\boxed{-\\frac{3\\,\\nu_0^2\\,d_0}{2\\,R_0^3}}$$", "id": "405684"}, {"introduction": "许多先进的反应堆设计采用多堆芯耦合的方案，这类系统通常具有高度的几何与物理对称性。然而，这种对称性可能会因为制造误差、不均匀的燃料燃耗或控制棒的非对称移动而被打破，从而影响系统的整体中子行为。本练习 [@problem_id:405618] 引入了一个更高级的分析工具——简并微扰理论，用于处理由于对称性破缺导致的简并本征值分裂问题。通过分析一个对称的四堆芯系统，您将学习如何量化一个非对称微扰对系统有效增殖因子 $k_{eff}$ 的影响。", "problem": "一个核反应堆系统由四个相同的耦合堆芯组成，它们排列在一个正方形的顶点上。这些堆芯按逆时针顺序标记为1、2、3和4。使用一个节点模型来描述中子布居数动力学，其中系统状态由每个堆芯中的裂变源强度矢量 $\\vec{S} = (S_1, S_2, S_3, S_4)^T$ 给出。下一代中子的源矢量 $\\vec{S}'$ 通过矩阵方程 $\\vec{S}' = \\mathbf{P} \\vec{S}$ 与当前代 $\\vec{S}$ 相关联。\n\n在临界状态下，系统以稳态运行，这由本征值问题 $\\mathbf{P} \\vec{S} = \\lambda \\vec{S}$ 描述，其中本征值 $\\lambda$ 代表系统的有效增殖因子 $k_{eff}$。\n\n对于未微扰系统，其高度对称性使得产生矩阵 $\\mathbf{P}_0$ 具有简单的结构。对角元为 $P_{ii} = k_0$，代表每个堆芯内部的中子产生。非对角元仅在最近邻堆芯之间不为零，其值为 $P_{ij} = k_1$。所有其他的非对角元均为零。\n\n这个未微扰系统拥有一个二重简并本征值 $\\lambda_0$。\n\n通过修改堆芯1和2之间的耦合，引入了一个非对称微扰。相应的矩阵元从 $k_1$ 变为 $k_1 + \\delta k$，即 $P_{12} = P_{21} = k_1 + \\delta k$。产生矩阵 $\\mathbf{P}$ 的所有其他元素保持不变。\n\n使用一阶简并微扰理论，计算由该微扰引起的简并本征值 $\\lambda_0$ 的劈裂 $\\Delta\\lambda$。", "solution": "1. 产生矩阵和未微扰本征问题\n未微扰矩阵为\n$$\\mathbf{P}_0 = k_0 I + k_1 A,$$ \n其中 $A$ 是正方形的邻接矩阵：如果 $i,j$ 是最近邻，则 $A_{ij}=1$，否则为 $0$。$A$ 的本征值为 $2,0,0,-2$，所以\n$$\\lambda^{(0)} = k_0 + k_1\\mu,\\quad \\mu\\in\\{2,0,0,-2\\}.$$ \n二重简并本征值为\n$$\\lambda_0 = k_0\\quad(\\mu=0).$$\n\n2. 简并子空间和标准正交基\n为 $\\mu=0$ 选择实数标准正交本征矢量：\n$$\\psi_1=\\tfrac1{\\sqrt2}(1,0,-1,0)^T,\\quad \\psi_2=\\tfrac1{\\sqrt2}(0,1,0,-1)^T.$$\n\n3. 微扰矩阵\n只有 $P_{12}$ 和 $P_{21}$ 改变了 $\\delta k$，所以\n$$(\\delta\\mathbf{P})_{12}=(\\delta\\mathbf{P})_{21}=\\delta k,$$ \n所有其他项为零。\n\n4. 简并子空间中的矩阵元\n计算\n$$W_{mn}=\\psi_m^T\\,\\delta\\mathbf{P}\\,\\psi_n.$$ \n由于 $\\psi_1$ 仅在位置1和3有非零项，而 $\\psi_2$ 仅在位置2和4有非零项，所以 $W_{12}$ 中唯一的非零项来自指标 (1,2)：\n$$W_{11}=0,\\quad W_{22}=0,\\quad\nW_{12}=W_{21}=\\psi_{1,1}\\,\\delta k\\,\\psi_{2,2}\n=\\tfrac1{\\sqrt2}\\,\\delta k\\,\\tfrac1{\\sqrt2}\n=\\tfrac{\\delta k}{2}.$$\n\n5. 久期方程和本征值移动\n$2\\times2$ 微扰矩阵为\n$$W=\\begin{pmatrix}0 & \\tfrac{\\delta k}{2}\\\n$$6pt]\\tfrac{\\delta k}{2} & 0\\end{pmatrix}$$ \n其本征值为 $\\pm\\tfrac{\\delta k}{2}$。因此，两个受微扰的本征值为\n$$\\lambda_0\\pm\\tfrac{\\delta k}{2},$$  \n劈裂为\n$$\\Delta\\lambda=\\bigl(\\lambda_0+\\tfrac{\\delta k}{2}\\bigr)-\\bigl(\\lambda_0-\\tfrac{\\delta k}{2}\\bigr)\n=\\delta k.$$", "answer": "$$\\boxed{\\delta k}$$", "id": "405618"}, {"introduction": "在现代反应堆设计与安全分析中，不确定性量化 (UQ) 是一个至关重要的环节。反应堆的性能参数（如有效增殖因子 $k_{\\text{eff}}$）的计算依赖于实验测得的核截面数据，而这些数据本身存在不确定性。微扰理论的原理可以被巧妙地应用于构建一个系统性的框架，来评估这些输入不确定性如何传播到最终的计算结果中。本练习 [@problem_id:405631] 将引导您运用基于一阶灵敏度分析的“三明治”公式，这是一个将微扰思想应用于统计分析的典型范例。您将亲手计算给定核数据协方差矩阵下 $k_{\\text{eff}}$ 的方差，从而掌握不确定性传播分析的核心方法。", "problem": "对有效增殖因数 $k_{\\text{eff}}$ 的精确预测在核反应堆的设计和安全分析中至关重要。$k_{\\text{eff}}$ 的值是使用中子输运或扩散理论，并以核截面数据作为输入来计算的。这些核数据源于实验，并具有固有的不确定性，这些不确定性会在计算过程中传播，最终导致预测的 $k_{\\text{eff}}$ 存在不确定性。\n\n一阶微扰理论为量化这种不确定性传播提供了一种强大的方法。对于一个作为多个参数 $X_1, X_2, \\ldots, X_n$ 的函数的量 $Y$，其方差 $\\text{Var}(Y)$ 可近似表示为：\n$$ \\text{Var}(Y) \\approx \\sum_{i=1}^n \\sum_{j=1}^n \\frac{\\partial Y}{\\partial X_i} \\frac{\\partial Y}{\\partial X_j} \\text{Cov}(X_i, X_j) $$\n其中 $\\text{Cov}(X_i, X_j)$ 是参数 $X_i$ 和 $X_j$ 之间的协方差。\n\n在反应堆物理学中，我们关心的是 $Y=k_{\\text{eff}}$，参数 $X_i$ 是核数据，我们将其记为 $\\sigma_i$。使用相对量通常会很方便。$k_{\\text{eff}}$ 相对于参数 $\\sigma_i$ 的相对灵敏度定义为：\n$$ S_i = \\frac{\\sigma_i}{k_{\\text{eff}}} \\frac{\\partial k_{\\text{eff}}}{\\partial \\sigma_i} $$\n两个参数 $\\sigma_i$ 和 $\\sigma_j$ 之间的相对协方差由下式给出：\n$$ C^{\\text{rel}}_{ij} = \\frac{\\text{Cov}(\\sigma_i, \\sigma_j)}{\\sigma_i \\sigma_j} $$\n使用这些定义，$k_{\\text{eff}}$ 的方差可以用矩阵形式表示为：\n$$ \\text{Var}(k_{\\text{eff}}) = k_{\\text{eff}}^2 S^T C^{\\text{rel}} S $$\n其中 $S$ 是相对灵敏度的列向量，$C^{\\text{rel}}$ 是相对协方差矩阵。\n\n考虑一个概念性的临界反应堆，其在名义有效增殖因数 $k_{\\text{eff},0} = K$ 下运行。假定 $k_{\\text{eff}}$ 的不确定性主要由四个关键的双能群核数据参数的不确定性决定：\n- $\\sigma_1$：快中子群产中子裂变宏观截面，$(\\nu\\Sigma_f)_1$\n- $\\sigma_2$：快中子群吸收宏观截面，$\\Sigma_{a,1}$\n- $\\sigma_3$：热中子群产中子裂变宏观截面，$(\\nu\\Sigma_f)_2$\n- $\\sigma_4$：热中子群吸收宏观截面，$\\Sigma_{a,2}$\n\n$k_{\\text{eff}}$ 相对于这些参数的相对灵敏度向量已确定为：\n$$ S = \\begin{pmatrix} S_1 \\\\ S_2 \\\\ S_3 \\\\ S_4 \\end{pmatrix} = \\begin{pmatrix} A \\\\ -B \\\\ C \\\\ -D \\end{pmatrix} $$\n其中 $A, B, C, D$ 是正常数。\n\n这四个参数的相对协方差矩阵由下式给出：\n$$ C^{\\text{rel}} = \\begin{pmatrix} v_1 & c_{12} & c_{13} & 0 \\\\ c_{12} & v_2 & 0 & 0 \\\\ c_{13} & 0 & v_3 & c_{34} \\\\ 0 & 0 & c_{34} & v_4 \\end{pmatrix} $$\n其中 $v_i$ 是相对方差，$c_{ij}$ 是相对协方差。所有矩阵元均为已知实常数。\n\n你的任务是计算有效增殖因数的方差 $\\text{Var}(k_{\\text{eff}})$。", "solution": "有效增殖因数的方差 $\\text{Var}(k_{\\text{eff}})$ 是通过使用一阶微扰理论传播核数据参数中的不确定性来确定的。题目以矩阵形式给出了相关公式：\n$$ \\text{Var}(k_{\\text{eff}}) = k_{\\text{eff},0}^2 S^T C^{\\text{rel}} S $$\n\n我们已知以下信息：\n- 名义有效增殖因数：$k_{\\text{eff},0} = K$。\n- 相对灵敏度向量：$S = \\begin{pmatrix} A \\\\ -B \\\\ C \\\\ -D \\end{pmatrix}$。\n- 相对协方差矩阵：$C^{\\text{rel}} = \\begin{pmatrix} v_1 & c_{12} & c_{13} & 0 \\\\ c_{12} & v_2 & 0 & 0 \\\\ c_{13} & 0 & v_3 & c_{34} \\\\ 0 & 0 & c_{34} & v_4 \\end{pmatrix}$。\n\n计算过程是通过求矩阵乘积 $S^T C^{\\text{rel}} S$ 来进行的。\n\n首先，我们求灵敏度向量的转置 $S^T$：\n$$ S^T = \\begin{pmatrix} A & -B & C & -D \\end{pmatrix} $$\n\n接下来，我们计算行向量 $S^T$ 与矩阵 $C^{\\text{rel}}$ 的乘积：\n$$ S^T C^{\\text{rel}} = \\begin{pmatrix} A & -B & C & -D \\end{pmatrix} \\begin{pmatrix} v_1 & c_{12} & c_{13} & 0 \\\\ c_{12} & v_2 & 0 & 0 \\\\ c_{13} & 0 & v_3 & c_{34} \\\\ 0 & 0 & c_{34} & v_4 \\end{pmatrix} $$\n执行矩阵乘法，得到一个 $1 \\times 4$ 的行向量：\n分量 1: $A(v_1) - B(c_{12}) + C(c_{13}) - D(0) = A v_1 - B c_{12} + C c_{13}$\n分量 2: $A(c_{12}) - B(v_2) + C(0) - D(0) = A c_{12} - B v_2$\n分量 3: $A(c_{13}) - B(0) + C(v_3) - D(c_{34}) = A c_{13} + C v_3 - D c_{34}$\n分量 4: $A(0) - B(0) + C(c_{34}) - D(v_4) = C c_{34} - D v_4$\n\n所以，得到的行向量是：\n$$ S^T C^{\\text{rel}} = \\begin{pmatrix} A v_1 - B c_{12} + C c_{13} & A c_{12} - B v_2 & A c_{13} + C v_3 - D c_{34} & C c_{34} - D v_4 \\end{pmatrix} $$\n\n现在，我们将此行向量乘以列向量 $S$：\n$$ S^T C^{\\text{rel}} S = \\begin{pmatrix} A v_1 - B c_{12} + C c_{13} & A c_{12} - B v_2 & A c_{13} + C v_3 - D c_{34} & C c_{34} - D v_4 \\end{pmatrix} \\begin{pmatrix} A \\\\ -B \\\\ C \\\\ -D \\end{pmatrix} $$\n这是一个点积运算，结果为一个标量值：\n$$ S^T C^{\\text{rel}} S = A(A v_1 - B c_{12} + C c_{13}) - B(A c_{12} - B v_2) + C(A c_{13} + C v_3 - D c_{34}) - D(C c_{34} - D v_4) $$\n我们展开每一项：\n$$ = (A^2 v_1 - A B c_{12} + A C c_{13}) + (-A B c_{12} + B^2 v_2) + (A C c_{13} + C^2 v_3 - C D c_{34}) + (-C D c_{34} + D^2 v_4) $$\n现在，我们合并同类项：\n$$ = A^2 v_1 + B^2 v_2 + C^2 v_3 + D^2 v_4 - 2 A B c_{12} + 2 A C c_{13} - 2 C D c_{34} $$\n\n最后，我们将这个结果代入方差的原始公式中：\n$$ \\text{Var}(k_{\\text{eff}}) = k_{\\text{eff},0}^2 (S^T C^{\\text{rel}} S) $$\n$$ \\text{Var}(k_{\\text{eff}}) = K^2 (A^2 v_1 + B^2 v_2 + C^2 v_3 + D^2 v_4 - 2 A B c_{12} + 2 A C c_{13} - 2 C D c_{34}) $$\n这就是 $k_{\\text{eff}}$ 方差的最终表达式。", "answer": "$$ \\boxed{K^2 (A^2 v_1 + B^2 v_2 + C^2 v_3 + D^2 v_4 - 2 A B c_{12} + 2 A C c_{13} - 2 C D c_{34})} $$", "id": "405631"}]}