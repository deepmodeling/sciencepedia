{"hands_on_practices": [{"introduction": "探测器响应的线性度是进行精确能量测量的基础，然而在某些情况下，信号的产生过程本身就是非线性的。本练习 [@problem_id:407054] 探讨了有机闪烁体中一个重要的非线性效应：高密度激发下的发光猝灭。通过建立一个描述激子动力学的简化反应速率方程，您将推导出相对闪烁效率，从而将微观的分子相互作用与宏观的可观测亮度和能量响应联系起来。", "problem": "重带电粒子穿过有机闪烁体时，会产生一条由受激分子（即激子）组成的致密径迹。这些激子的密度通常很高，足以通过双分子湮没引起显著的发光猝灭。激子布居密度 $n(\\mathbf{r}, t)$ 的动力学可以用一个反应-扩散方程来描述：\n\n$$\n\\frac{\\partial n}{\\partial t} = D \\nabla^2 n - \\frac{n}{\\tau_0} - \\gamma n^2\n$$\n\n其中 $D$ 是激子扩散系数，$\\tau_0$ 是对应于辐射衰变（闪烁）的激子自然寿命，$\\gamma$ 是双分子湮没（$X^*+X^* \\to$ 非辐射产物）的速率常数。项 $n/\\tau_0$ 代表单位体积的光发射率。\n\n为了建立一个易于处理的模型，我们对重离子径迹做如下简化假设：\n1.  初始激子密度 $n(\\mathbf{r}, t=0)$ 在半径为 $R_c$ 的圆柱体内是均匀的，在圆柱体外为零。我们将这个恒定的初始密度记为 $n_c$。\n2.  与衰变过程相比，激子扩散可以忽略不计，因此我们可以设置 $D=0$。这意味着激子基本上是静态的，其密度演化仅取决于局域的初始密度。\n\n“相对闪烁效率” $\\eta_{\\text{rel}}$ 是表征闪烁体响应的一个关键指标。它定义为单位径迹长度发射的光子总数 $L$ 与单位径迹长度初始产生的激子总数 $N_0$ 之比。\n\n在这些假设下，推导相对闪烁效率 $\\eta_{\\text{rel}}$ 的闭式表达式。用初始激子密度 $n_c$、辐射寿命 $\\tau_0$ 和双分子猝灭速率常数 $\\gamma$ 来表示你的答案。", "solution": "我们考虑圆柱体内某一点的局域动力学，有 $n(0)=n_c$ 且 $D=0$，因此\n$$\n\\frac{dn}{dt}=-\\frac{n}{\\tau_0}-\\gamma n^2\n$$\n单位体积的光子发射率为 $R(t)=n(t)/\\tau_0$，因此每个初始激子产生的光子总数为\n$$\n\\eta_{\\text{rel}}\n=\\frac{\\displaystyle\\int_0^\\infty \\frac{n(t)}{\\tau_0}\\,dt}{n_c}\n$$\n\n1.  重写积分：\n$$\n\\int_0^\\infty \\frac{n}{\\tau_0}\\,dt\n=-\\frac{1}{\\tau_0}\\int_{n_c}^{0}\\frac{n}{\\,n/\\tau_0+\\gamma n^2\\,}\\,dn\n$$\n\n2.  简化被积函数：\n$$\n\\frac{n}{n/\\tau_0+\\gamma n^2}\n=\\frac{n}{n\\bigl(1/\\tau_0+\\gamma n\\bigr)}\n=\\frac{1}{\\,1/\\tau_0+\\gamma n\\,}\n$$\n\n3.  令 $A=1/\\tau_0$ 进行积分：\n$$\n\\int_{n_c}^0\\frac{dn}{A+\\gamma n}\n=\\frac{1}{\\gamma}\\Bigl[\\ln\\!(A+\\gamma n)\\Bigr]_{n_c}^{0}\n=\\frac{1}{\\gamma}\\ln\\frac{A+\\gamma n_c}{A}\n$$\n\n4.  注意到 $A=1/\\tau_0$，可以得到\n$$\n\\int_0^\\infty\\frac{n}{\\tau_0}\\,dt\n=\\frac{1}{\\gamma\\tau_0}\\ln\\bigl(1+\\gamma n_c\\tau_0\\bigr)\n$$\n\n5.  除以 $n_c$ 得到相对效率：\n$$\n\\eta_{\\text{rel}}\n=\\frac{1}{\\gamma n_c\\tau_0}\\ln\\bigl(1+\\gamma n_c\\tau_0\\bigr)\n$$", "answer": "$$\\boxed{\\frac{\\ln\\bigl(1+\\gamma n_c\\tau_0\\bigr)}{\\gamma n_c\\tau_0}}$$", "id": "407054"}, {"introduction": "从探测器获得的原始信号往往淹没在电子学噪声中，为了提取有用的信息（如能量），必须进行精心的信号处理。本练习 [@problem_id:407093] 聚焦于核电子学中的核心问题：如何通过优化数字成形滤波器来最大化信噪比（SNR）。通过分析一个假设的实验结果，即最优成形时间 $k_{opt}$ 恰好等于探测器脉冲衰减时间常数 $\\tau_d$，您将反过来推断出系统噪声的关键特性。", "problem": "一个核辐射探测器系统由一个探测器、一个电荷灵敏前置放大器和一个实现脉冲形成器的数字信号处理器组成。对于单个事件，来自前置放大器的输出电压脉冲具有指数衰减特性，其时间常数为 $\\tau_d$：\n$$V_{\\text{in}}(t) = A_0 e^{-t/\\tau_d} u(t)$$\n其中 $u(t)$ 是亥维赛阶跃函数，$A_0$ 是初始脉冲幅度。\n\n为了优化能量分辨率，使用了一个数字三角形成形器。该形成器可以用一个脉冲响应 $h(t)$ 来描述，当它与一个阶跃函数卷积时，会产生一个高度为 1 的等腰三角脉冲，在时间 $t=k$ 达到峰值，并在 $t=2k$ 时返回到零。此处，$k$ 是形成器的可调节峰化时间。\n\n该系统受到两种基本白噪声源的影响：一种是功率谱密度 (PSD) 恒为 $e_{ns}^2 = a^2$ 的串联噪声源，另一种是功率谱密度为 $i_{np}^2 = b^2$ 的并联噪声源。经过前置放大器的积分级后，这些噪声源在形成器的输入端产生的总电压噪声功率谱密度由下式给出：\n$$S_N(\\omega) = a^2 + \\frac{b^2}{\\omega^2}$$\n\n在一个旨在寻找最佳信噪比 (SNR) 的实验中，形成时间 $k$ 是可变的。实验确定，使信噪比最大化的最佳形成时间 $k_{\\text{opt}}$ 正好等于探测器的脉冲衰减时间常数，即 $k_{\\text{opt}} = \\tau_d$。\n\n根据这一实验结果，确定比值 $\\frac{\\tau_{\\text{noise}}}{\\tau_d}$ 的值，其中 $\\tau_{\\text{noise}} = a/b$ 是系统的特征噪声时间常数。", "solution": "1. 相关表达式\n- 输入脉冲：\n  $$V_{\\text{in}}(t)=A_0 e^{-t/\\tau_d}u(t)\\,. $$\n- 三角形成形器脉冲响应\n  $$h(t)=\\frac1k\\bigl[u(t)-2u(t-k)+u(t-2k)\\bigr]\\,, $$\n  其传递函数模的平方为\n  $$|H(\\omega)|^2=\\Bigl|\\tfrac1k\\bigl(1-2e^{-i\\omega k}+e^{-2i\\omega k}\\bigr)\\Bigr|^2\n  =\\frac{16}{k^2}\\sin^4\\!\\bigl(\\tfrac{\\omega k}{2}\\bigr)\\,. $$\n- 在峰化时间 $t=k$ 时的信号幅度：\n  $$S=V_{\\text{out}}(k)\n  =\\frac{A_0}{k}\\int_0^k e^{-(k-\\tau)/\\tau_d}\\,d\\tau\n  =A_0\\frac{\\tau_d}{k}\\bigl(1-e^{-k/\\tau_d}\\bigr)\\,. $$\n- 形成器输入端的噪声功率谱密度：\n  $$S_N(\\omega)=a^2+\\frac{b^2}{\\omega^2}\\,,\\qquad\\tau_{\\text{noise}}=\\frac{a}{b}\\,. $$\n\n2. 三角形成形的近似噪声方差\n  （对于白串联噪声和 $1/\\omega^2$ 并联噪声的标准结果）：\n  $$\\sigma_s^2=\\frac{C_s\\,a^2}{k},\\quad\n    \\sigma_p^2=C_p\\,b^2\\,k,\\quad\n    C_s=\\tfrac{3}{8},\\;C_p=\\tfrac{1}{8}\\,. $$\n  总噪声方差\n  $$\\sigma^2=\\frac{C_s\\,a^2}{k}+C_p\\,b^2\\,k\n    =b^2\\Bigl(\\frac{\\tau_{\\text{noise}}^2C_s}{k}+C_pk\\Bigr)\\,. $$\n\n3. 信噪比的平方\n  $$\\text{SNR}^2\n  =\\frac{S^2}{\\sigma^2}\n  =\\frac{A_0^2\\bigl(\\tfrac{\\tau_d}{k}(1-e^{-k/\\tau_d})\\bigr)^2}\n         {b^2\\Bigl(\\tfrac{\\tau_{\\text{noise}}^2C_s}{k}+C_pk\\Bigr)}\\,. $$\n  定义 $x=k/\\tau_d$ 和 $r=\\tau_{\\text{noise}}/\\tau_d$。则\n  $$\\text{SNR}^2\n  =\\frac{A_0^2}{b^2\\tau_d}\\;\n   \\frac{(1-e^{-x})^2}{x\\bigl(r^2C_s+ C_p x^2\\bigr)}\\,. $$\n\n4. 最佳形成时间满足 $d(\\text{SNR}^2)/dx=0$。\n   要求在 $x=1$ 处取得最优值，可得\n  $$\\frac{2e^{-1}}{1-e^{-1}}\n    =\\frac{r^2C_s+3C_p}{r^2C_s+C_p}\\,. $$\n  代入 $C_s=\\frac38$，$C_p=\\frac18$ 并解出 $r^2$：\n  \n$$\n    r^2\n   =\\frac{\\tfrac{1}{8}\\bigl(3-5e^{-1}\\bigr)}{\\tfrac{3}{8}\\bigl(3e^{-1}-1\\bigr)}\n   =\\frac{3e-5}{9-3e}\\,.\n  $$\n\n  因此\n  $$\\frac{\\tau_{\\text{noise}}}{\\tau_d}\n    =r=\\sqrt{\\frac{3e-5}{9-3e}}\\,. $$", "answer": "$$\\boxed{\\sqrt{\\frac{3e-5}{9-3e}}}$$", "id": "407093"}, {"introduction": "除了测量能量，探测器信号的形状（即其时间演化特征）也携带着宝贵的信息，例如入射粒子的类型。本练习 [@problem_id:407181] 介绍了一种强大的技术——脉冲形状甄别（PSD），并使用费雪比（Fisher ratio）$F$ 作为甄别性能的量度。您将为两种具有不同时间常数的脉冲信号设计一个最优的线性滤波器，以最大限度地分离它们，并计算可实现的最大费雪比，这对于中子与伽马射线的甄别等混合场辐射测量至关重要。", "problem": "在辐射探测器的数字信号处理中，脉冲形状甄别（PSD）是一种根据不同粒子类型（例如中子和伽马射线）产生的信号具有不同时间轮廓来区分它们的技术。衡量一种甄别算法有效性的常用优值是费雪比 $F$。\n\n考虑一个探测器信号混有加性白噪声的系统。测量到的信号可以建模为 $V(t) = s_i(t) + n(t)$，其中 $s_i(t)$ 是粒子类型 $i$ 的理想脉冲形状，$n(t)$ 是噪声。噪声是一个平稳随机过程，其自相关函数为 $\\langle n(t) n(t') \\rangle = \\sigma_n^2 \\delta(t-t')$, 其中 $\\sigma_n^2$ 是一个代表噪声功率谱密度的常数。\n\n为了甄别两种脉冲类型 $s_1(t)$ 和 $s_2(t)$，通过计算一个甄别值 $Q = \\int_0^\\infty V(t) w(t) dt$ 来应用线性滤波操作，其中 $w(t)$ 是一个随时间变化的权重函数。费雪比定义为：\n$$ F = \\frac{(\\langle Q_2 \\rangle - \\langle Q_1 \\rangle)^2}{\\text{Var}(Q_1) + \\text{Var}(Q_2)} $$\n其中 $\\langle Q_i \\rangle$ 是脉冲类型 $i$ 的甄别值的均值（期望值），而 $\\text{Var}(Q_i)$ 是其方差，该方差完全由噪声引起。众所周知，通过选择与两种理想脉冲形状之差成正比的最优权重函数，即 $w_{\\text{opt}}(t) \\propto s_2(t) - s_1(t)$，可以使 $F$ 最大化。\n\n假设两种理想的、归一化的脉冲形状由下式给出：\n$$ s_1(t) = A_1 \\left(\\frac{t}{\\tau_1}\\right) e^{-t/\\tau_1} H(t) $$\n$$ s_2(t) = A_2 \\left(\\frac{t}{\\tau_2}\\right) e^{-t/\\tau_2} H(t) $$\n其中 $\\tau_2 > \\tau_1$ 是特征时间常数，$A_1$ 和 $A_2$ 是幅度因子，$H(t)$ 是亥维赛阶跃函数。\n\n这些脉冲是由在探测器中沉积相同总能量的相互作用产生的。这通过施加一个约束来建模，即每个理想脉冲形状的总积分电荷等于一个常数值 $Q_0$。\n$$ \\int_0^\\infty s_1(t) dt = \\int_0^\\infty s_2(t) dt = Q_0 $$\n\n你的任务是计算用于甄别这两种脉冲形状可实现的最大费雪比 $F_{\\text{max}}$。请用参数 $Q_0$、$\\tau_1$、$\\tau_2$ 和 $\\sigma_n^2$ 将你的答案表示为单个闭式解析表达式。", "solution": "我们希望最大化\n$$F=\\frac{\\bigl(\\langle Q_2\\rangle-\\langle Q_1\\rangle\\bigr)^2}{\\text{Var}(Q_1)+\\text{Var}(Q_2)}$$\n其中\n$$Q=\\int_0^\\infty V(t)\\,w(t)\\,dt,\\quad V(t)=s_i(t)+n(t),$$\n且加性白噪声为 $\\langle n(t)n(t')\\rangle=\\sigma_n^2\\delta(t-t')$. 众所周知，最优权重为 $w\\propto s_2-s_1$，且其缩放因子在 $F$ 中会消去，可得\n$$F_{\\max}=\\frac{\\displaystyle\\int_0^\\infty\\bigl[s_2(t)-s_1(t)\\bigr]^2dt}{2\\,\\sigma_n^2}\\,. $$\n\n1.  通过下式对 $s_i(t)=A_i\\,(t/\\tau_i)e^{-t/\\tau_i}H(t)$ 进行归一化\n   $$\\int_0^\\infty s_i(t)\\,dt\n     =A_i\\int_0^\\infty\\frac{t}{\\tau_i}e^{-t/\\tau_i}dt\n     =A_i\\,\\tau_i=Q_0\n     \\;\\;\\Longrightarrow\\;\\;\n     A_i=\\frac{Q_0}{\\tau_i}.$$\n   因此\n   $$s_i(t)=Q_0\\,\\frac{t}{\\tau_i^2}\\,e^{-t/\\tau_i}H(t)\\,. $$\n\n2.  计算\n   $$I_i=\\int_0^\\infty s_i^2(t)\\,dt\n     =\\int_0^\\infty Q_0^2\\frac{t^2}{\\tau_i^4}e^{-2t/\\tau_i}dt\n     =\\frac{Q_0^2}{\\tau_i^4}\\cdot\\frac{\\tau_i^3}{4}\n     =\\frac{Q_0^2}{4\\,\\tau_i}\\,, $$\n   利用 $\\int_0^\\infty t^2e^{-2t/\\tau_i}dt=2/(2/\\tau_i)^3=\\tau_i^3/4$。\n\n3.  计算交叉项，其中 $\\alpha=1/\\tau_1+1/\\tau_2$:\n   $$I_{12}=\\int_0^\\infty s_1(t)s_2(t)\\,dt\n     =Q_0^2\\frac{2}{\\tau_1^2\\tau_2^2\\alpha^3}\n     =\\frac{2Q_0^2\\,\\tau_1\\tau_2}{(\\tau_1+\\tau_2)^3}\\,. $$\n\n4.  因此\n   $$\\int_0^\\infty(s_2-s_1)^2dt\n     =I_1+I_2-2I_{12}\n     =Q_0^2\\Bigl(\\frac1{4\\tau_1}+\\frac1{4\\tau_2}-\\frac{4\\tau_1\\tau_2}{(\\tau_1+\\tau_2)^3}\\Bigr).$$\n\n5.  代入 $F_{\\max}$ 可得\n   $$F_{\\max}\n     =\\frac{1}{2\\sigma_n^2}\\,Q_0^2\\Bigl(\\frac{\\tau_1+\\tau_2}{4\\tau_1\\tau_2}\n     -\\frac{4\\tau_1\\tau_2}{(\\tau_1+\\tau_2)^3}\\Bigr)\n     =\\frac{Q_0^2(\\tau_2-\\tau_1)^2(\\tau_1^2+6\\tau_1\\tau_2+\\tau_2^2)}\n           {8\\,\\sigma_n^2\\,\\tau_1\\,\\tau_2\\,(\\tau_1+\\tau_2)^3}\\,. $$", "answer": "$$\\boxed{\\frac{Q_0^2(\\tau_2-\\tau_1)^2(\\tau_1^2+6\\tau_1\\tau_2+\\tau_2^2)}{8\\,\\sigma_n^2\\,\\tau_1\\,\\tau_2\\,(\\tau_1+\\tau_2)^3}}$$", "id": "407181"}]}