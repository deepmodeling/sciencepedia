{"hands_on_practices": [{"introduction": "恒星大气的结构和外观从根本上取决于其内部气体与辐射的相互作用。这种相互作用的强度由一个称为“不透明度”($\\kappa_\\nu$)的关键物理量来量化。这个实践练习 ([@problem_id:257286]) 引导我们为一个简化的氢原子气体计算普朗克平均不透明度，该模型虽然简化，但抓住了光致电离过程的关键物理特性，展示了如何将依赖频率的微观过程平均化，以用于恒星结构模型。", "problem": "在恒星内部和大气的研究中，一个关键的物理量是不透明度，它衡量恒星物质对辐射流的阻碍程度。为了简化恒星结构模型，人们通常使用频率平均不透明度。普朗克平均不透明度 $\\kappa_P$ 是频率相关的质量吸收系数 $\\kappa_\\nu$ 由普朗克黑体谱 $B_\\nu(T)$ 加权的平均值。其定义为：\n$$\n\\kappa_P = \\frac{\\int_0^\\infty \\kappa_\\nu B_\\nu(T) d\\nu}{\\int_0^\\infty B_\\nu(T) d\\nu}\n$$\n其中 $B_\\nu(T)$ 是温度为 $T$ 的黑体的普朗克函数：\n$$\nB_\\nu(T) = \\frac{2 h \\nu^3}{c^2} \\frac{1}{e^{h\\nu/(k_B T)} - 1}\n$$\n此处，$h$ 是普朗克常数，$k_B$ 是玻尔兹曼常数，$c$ 是光速。\n\n考虑一个恒星大气中气体的简化模型。假设不透明度完全由类氢粒子某个特定能级的束缚-自由吸收（光致电离）主导。该过程有一个电离阈值能量，对应频率为 $\\nu_n$。对于频率 $\\nu$ 低于此阈值的光子，没有吸收。对于等于或高于该阈值的频率，质量吸收系数可以很好地用 Kramers 定律近似，其函数形式如下：\n$$\n\\kappa_\\nu = \\begin{cases} 0  \\text{for } \\nu  \\nu_n \\\\ \\kappa_n \\left(\\frac{\\nu_n}{\\nu}\\right)^3  \\text{for } \\nu \\geq \\nu_n \\end{cases}\n$$\n其中 $\\kappa_n$ 是一个常数，代表在电离边频率 $\\nu_n$ 处的不透明度。\n\n基于此模型，推导普朗克平均不透明度 $\\kappa_P$ 的闭合形式表达式。将你的最终答案用常数 $\\kappa_n$ 和无量纲参数 $x_n = \\frac{h \\nu_n}{k_B T}$ 表示，该参数比较了电离能与气体的特征热能。你的最终表达式也可能包含基本数学常数。", "solution": "我们从定义出发\n$$\n\\kappa_P=\\frac{\\int_0^\\infty\\kappa_\\nu B_\\nu(T)\\,d\\nu}{\\int_0^\\infty B_\\nu(T)\\,d\\nu},\\qquad\nB_\\nu=\\frac{2h\\nu^3}{c^2}\\frac1{e^{h\\nu/(k_B T)}-1}.\n$$\n在我们的模型中\n$$\n\\kappa_\\nu=\\begin{cases}0,  \\nu  \\nu_n,\\\\\\kappa_n\\bigl(\\nu_n/\\nu\\bigr)^3,  \\nu\\ge\\nu_n.\\end{cases}\n$$\n分子：\n$$\nN=\\int_0^\\infty\\kappa_\\nu B_\\nu\\,d\\nu\n=\\kappa_n\\nu_n^3\\frac{2h}{c^2}\\int_{\\nu_n}^\\infty\\frac{\\nu^{-3}\\,\\nu^3}{e^{h\\nu/(k_B T)}-1}\\,d\\nu\n=\\kappa_n\\frac{2h\\nu_n^3}{c^2}\\int_{\\nu_n}^\\infty\\frac{d\\nu}{e^{h\\nu/(k_B T)}-1}.\n$$\n令 $x=h\\nu/(k_B T)$，则 $d\\nu=(k_B T/h)\\,dx$ 且 $x_n=h\\nu_n/(k_B T)$：\n$$\nN=\\kappa_n\\frac{2h\\nu_n^3}{c^2}\\frac{k_B T}{h}\\int_{x_n}^\\infty\\frac{dx}{e^x-1}\n=\\kappa_n\\frac{2k_B^4T^4x_n^3}{h^3c^2}\\int_{x_n}^\\infty\\frac{dx}{e^x-1}.\n$$\n但是\n$$\n\\int_{x_n}^\\infty\\frac{dx}{e^x-1}\n=-\\ln\\bigl(1-e^{-x_n}\\bigr).\n$$\n因此\n$$\nN=\\kappa_n\\frac{2k_B^4T^4x_n^3}{h^3c^2}\\bigl[-\\ln(1-e^{-x_n})\\bigr].\n$$\n分母：\n$$\nD=\\int_0^\\infty B_\\nu\\,d\\nu\n=\\frac{2h}{c^2}\\int_0^\\infty\\frac{\\nu^3\\,d\\nu}{e^{h\\nu/(k_B T)}-1}\n=\\frac{2k_B^4T^4}{h^3c^2}\\int_0^\\infty\\frac{x^3\\,dx}{e^x-1}\n=\\frac{2k_B^4T^4}{h^3c^2}\\frac{\\pi^4}{15}.\n$$\n所以\n$$\n\\kappa_P=\\frac{N}{D}\n=\\kappa_n\\frac{2k_B^4T^4x_n^3\\,[-\\ln(1-e^{-x_n})]}{h^3c^2}\\Big/\\frac{2k_B^4T^4}{h^3c^2}\\frac{\\pi^4}{15}\n=\\kappa_n\\frac{15\\,x_n^3}{\\pi^4}\\bigl[-\\ln(1-e^{-x_n})\\bigr].\n$$", "answer": "$$\\boxed{\\frac{15\\kappa_n x_n^3}{\\pi^4}\\bigl[-\\ln\\bigl(1-e^{-x_n}\\bigr)\\bigr]}$$", "id": "257286"}, {"introduction": "在了解了不透明度如何描述物质与辐射的相互作用后，下一步是求解辐射转移方程，以预测恒星的最终辐射输出。此练习 ([@problem_id:257500]) 要求您应用辐射转移方程的形式解，来计算一个包含光球层和色球层（具有温度反转）的简化模型大气的出射辐射强度。通过求解这个问题，您将亲身体会到恒星大气的温度结构如何直接决定了我们观测到的光谱特征。", "problem": "在恒星大气的研究中，出射辐射场由气体的温度结构决定。一个恒星的简化模型——其光球层上覆盖着色球层——可以通过为源函数 $S(\\tau)$ 假设一种特定形式来构建，其中 $\\tau$ 是垂直光学深度。\n\n考虑一个处于局部热动平衡（LTE）状态的平面平行灰色大气，其中源函数 $S(\\tau)$ 等同于普朗克函数 $B(T(\\tau))$。与法线成 $\\theta$ 角（其中 $\\mu = \\cos\\theta$）的出射比辐射强度 $I(0, \\mu)$ 由辐射转移方程的形式解给出：\n$$\nI(0, \\mu) = \\int_0^\\infty S(\\tau) e^{-\\tau/\\mu} \\frac{d\\tau}{\\mu}\n$$\n\n假设源函数由一个分段线性不连续函数建模，该函数表示在光学深度 $\\tau_0$ 处存在一个温度极小值。\n对于较深的光球层（$\\tau > \\tau_0$），源函数随光学深度线性增加：\n$$\nS(\\tau) = S_0 (1 + \\beta \\tau) \\quad \\text{for} \\quad \\tau > \\tau_0\n$$\n对于较高的色球层（$0 \\le \\tau \\le \\tau_0$），源函数随光学深度线性减小，反映了朝向表面的温度升高：\n$$\nS(\\tau) = S_c - \\alpha \\tau \\quad \\text{for} \\quad 0 \\le \\tau \\le \\tau_0\n$$\n此处，$S_0$、$S_c$、$\\beta$ 和 $\\alpha$ 是正常数。注意 $S(\\tau)$ 在 $\\tau = \\tau_0$ 处是不连续的。\n\n推导出出射比辐射强度 $I(0, \\mu)$ 作为 $\\mu$、$\\tau_0$ 以及定义源函数的常数的函数的闭式解析表达式。", "solution": "该问题要求解在给定的分段源函数 $S(\\tau)$ 下，从平面平行灰色大气中出射的比辐射强度 $I(0, \\mu)$。出发点是辐射转移方程的形式解：\n$$\nI(0, \\mu) = \\frac{1}{\\mu} \\int_0^\\infty S(\\tau) e^{-\\tau/\\mu} d\\tau\n$$\n根据 $S(\\tau)$ 的分段定义，我们必须在不连续点 $\\tau = \\tau_0$ 处将积分分开。\n$$\nI(0, \\mu) = \\frac{1}{\\mu} \\left[ \\int_0^{\\tau_0} S(\\tau) e^{-\\tau/\\mu} d\\tau + \\int_{\\tau_0}^\\infty S(\\tau) e^{-\\tau/\\mu} d\\tau \\right]\n$$\n现在，我们将 $S(\\tau)$ 的相应表达式代入每个积分中。\n\n我们来计算第一个积分 $I_1$，它对应于色球层（$0 \\le \\tau \\le \\tau_0$）：\n$$\nI_1 = \\frac{1}{\\mu} \\int_0^{\\tau_0} (S_c - \\alpha \\tau) e^{-\\tau/\\mu} d\\tau\n$$\n这个积分可以使用分部积分法求解，$\\int u \\, dv = uv - \\int v \\, du$。令 $u = S_c - \\alpha \\tau$ 和 $dv = e^{-\\tau/\\mu} d\\tau$。则 $du = -\\alpha \\, d\\tau$ 且 $v = -\\mu e^{-\\tau/\\mu}$。\n$$\n\\int (S_c - \\alpha \\tau) e^{-\\tau/\\mu} d\\tau = (S_c - \\alpha \\tau)(-\\mu e^{-\\tau/\\mu}) - \\int (-\\mu e^{-\\tau/\\mu})(-\\alpha \\, d\\tau)\n$$\n$$\n= -\\mu(S_c - \\alpha \\tau)e^{-\\tau/\\mu} - \\alpha\\mu \\int e^{-\\tau/\\mu} d\\tau\n$$\n$$\n= -\\mu(S_c - \\alpha \\tau)e^{-\\tau/\\mu} - \\alpha\\mu (-\\mu e^{-\\tau/\\mu})\n$$\n$$\n= -\\mu(S_c - \\alpha \\tau)e^{-\\tau/\\mu} + \\alpha\\mu^2 e^{-\\tau/\\mu}\n$$\n现在我们计算这个从 $0$ 到 $\\tau_0$ 的定积分：\n$$\n\\int_0^{\\tau_0} (S_c - \\alpha \\tau) e^{-\\tau/\\mu} d\\tau = \\left[-\\mu(S_c - \\alpha \\tau)e^{-\\tau/\\mu} + \\alpha\\mu^2 e^{-\\tau/\\mu}\\right]_0^{\\tau_0}\n$$\n$$\n= \\left(-\\mu(S_c - \\alpha \\tau_0)e^{-\\tau_0/\\mu} + \\alpha\\mu^2 e^{-\\tau_0/\\mu}\\right) - \\left(-\\mu(S_c - 0)e^{0} + \\alpha\\mu^2 e^{0}\\right)\n$$\n$$\n= -\\mu S_c e^{-\\tau_0/\\mu} + \\alpha\\mu\\tau_0 e^{-\\tau_0/\\mu} + \\alpha\\mu^2 e^{-\\tau_0/\\mu} + \\mu S_c - \\alpha\\mu^2\n$$\n除以前置因子 $1/\\mu$，我们得到第一个积分的贡献：\n$$\nI_1 = -S_c e^{-\\tau_0/\\mu} + \\alpha\\tau_0 e^{-\\tau_0/\\mu} + \\alpha\\mu e^{-\\tau_0/\\mu} + S_c - \\alpha\\mu\n$$\n$$\nI_1 = S_c(1 - e^{-\\tau_0/\\mu}) - \\alpha\\mu(1 - e^{-\\tau_0/\\mu}) + \\alpha\\tau_0 e^{-\\tau_0/\\mu}\n$$\n\n接下来，我们计算第二个积分 $I_2$，它对应于光球层（$\\tau > \\tau_0$）：\n$$\nI_2 = \\frac{1}{\\mu} \\int_{\\tau_0}^\\infty S_0(1+\\beta\\tau) e^{-\\tau/\\mu} d\\tau\n$$\n我们再次使用分部积分法。令 $u = S_0(1+\\beta\\tau)$ 和 $dv = e^{-\\tau/\\mu} d\\tau$。则 $du = S_0\\beta \\, d\\tau$ 且 $v = -\\mu e^{-\\tau/\\mu}$。\n$$\n\\int S_0(1+\\beta\\tau) e^{-\\tau/\\mu} d\\tau = S_0(1+\\beta\\tau)(-\\mu e^{-\\tau/\\mu}) - \\int (-\\mu e^{-\\tau/\\mu})(S_0\\beta \\, d\\tau)\n$$\n$$\n= -\\mu S_0(1+\\beta\\tau)e^{-\\tau/\\mu} + S_0\\beta\\mu \\int e^{-\\tau/\\mu} d\\tau\n$$\n$$\n= -\\mu S_0(1+\\beta\\tau)e^{-\\tau/\\mu} + S_0\\beta\\mu (-\\mu e^{-\\tau/\\mu})\n$$\n$$\n= -\\mu S_0(1+\\beta\\tau)e^{-\\tau/\\mu} - S_0\\beta\\mu^2 e^{-\\tau/\\mu}\n$$\n现在我们计算这个从 $\\tau_0$ 到 $\\infty$ 的定积分：\n$$\n\\int_{\\tau_0}^\\infty S_0(1+\\beta\\tau) e^{-\\tau/\\mu} d\\tau = \\left[-\\mu S_0(1+\\beta\\tau)e^{-\\tau/\\mu} - S_0\\beta\\mu^2 e^{-\\tau/\\mu}\\right]_{\\tau_0}^\\infty\n$$\n当 $\\tau \\to \\infty$ 时，$e^{-\\tau/\\mu}$ 项趋近于 $0$。所以上限处的值为零。\n$$\n= 0 - \\left(-\\mu S_0(1+\\beta\\tau_0)e^{-\\tau_0/\\mu} - S_0\\beta\\mu^2 e^{-\\tau_0/\\mu}\\right)\n$$\n$$\n= \\mu S_0(1+\\beta\\tau_0)e^{-\\tau_0/\\mu} + S_0\\beta\\mu^2 e^{-\\tau_0/\\mu}\n$$\n除以前置因子 $1/\\mu$，我们得到第二个积分的贡献：\n$$\nI_2 = S_0(1+\\beta\\tau_0)e^{-\\tau_0/\\mu} + S_0\\beta\\mu e^{-\\tau_0/\\mu} = S_0(1+\\beta\\tau_0+\\beta\\mu)e^{-\\tau_0/\\mu}\n$$\n\n总的出射强度是两部分贡献之和，$I(0, \\mu) = I_1 + I_2$：\n$$\nI(0, \\mu) = \\left( S_c(1 - e^{-\\tau_0/\\mu}) - \\alpha\\mu(1 - e^{-\\tau_0/\\mu}) + \\alpha\\tau_0 e^{-\\tau_0/\\mu} \\right) + \\left( S_0(1+\\beta\\tau_0+\\beta\\mu)e^{-\\tau_0/\\mu} \\right)\n$$\n我们可以将含有和不含 $e^{-\\tau_0/\\mu}$ 的项收集起来：\n$$\nI(0, \\mu) = (S_c - \\alpha\\mu) + \\left( -S_c + \\alpha\\mu + \\alpha\\tau_0 + S_0(1+\\beta\\tau_0) + S_0\\beta\\mu \\right) e^{-\\tau_0/\\mu}\n$$\n最后，我们可以根据 $\\mu$ 的幂次对括号内的项进行分组：\n$$\nI(0, \\mu) = S_c - \\alpha\\mu + \\left[ S_0(1+\\beta\\tau_0) - S_c + \\alpha\\tau_0 + (S_0\\beta + \\alpha)\\mu \\right] e^{-\\tau_0/\\mu}\n$$\n这就是出射比辐射强度的最终闭式表达式。", "answer": "$$\n\\boxed{S_c - \\alpha\\mu + \\left[ S_0(1+\\beta\\tau_0) - S_c + \\alpha\\tau_0 + (S_0\\beta + \\alpha)\\mu \\right] e^{-\\tau_0/\\mu}}\n$$", "id": "257500"}, {"introduction": "虽然前面两个练习提供了可以解析求解的理想化模型，但实际的恒星大气模型由于其复杂性必须依赖数值方法求解。Lambda迭代法是求解辐射转移方程的一种基础方法，但其收敛缓慢的缺点限制了其实际应用。这个高阶练习 ([@problem_id:257571]) 深入探讨了加速Lambda迭代收敛的数值技术，通过推导一个理想加速算符的傅里叶形式，揭示了现代计算天体物理学中用于高效构建大气模型的核心思想。", "problem": "在恒星大气辐射转移的研究中，拉姆达迭代法是求解转移方程的一种基本技术。对于一个假设各向同性散射的简化灰色大气模型，辐射转移问题可以简化为求解平均强度 $J(\\tau)$，其中 $\\tau$ 是光学深度。\n\n辐射转移方程的积分形式通过拉姆达算符 $\\Lambda$ 将平均强度 $J(\\tau)$ 与源函数 $S(\\tau)$ 联系起来：\n$$\nJ(\\tau) = \\Lambda[S(\\tau)]\n$$\n源函数由下式给出：\n$$\nS(\\tau) = (1-\\epsilon)J(\\tau) + \\epsilon B(\\tau)\n$$\n其中 $\\epsilon$ 是热化参数（一个介于 0 和 1 之间的常数），$B(\\tau)$ 是普朗克函数，我们将其视为一个给定的源项。\n\n标准的拉姆达迭代通过以下方式更新平均强度：\n$$\nJ_{n+1}(\\tau) = \\Lambda[S_n(\\tau)] = (1-\\epsilon)\\Lambda[J_n(\\tau)] + \\epsilon\\Lambda[B(\\tau)]\n$$\n这个迭代过程在光学厚区域的收敛速度可能非常慢。为了加快收敛，可以采用如 Ng 加速等加速方法。这些方法利用先前迭代值的信息来构造一个改进的解估计。\n\n让我们考虑这样一个加速方案的理想化版本。我们定义一个理想线性加速算符 $\\mathcal{A}$，它根据单次拉姆达迭代产生的变化量 $\\Delta J_n = J_{n+1} - J_n$ 来提供对当前解估计 $J_n$ 的精确修正。这种关系表示为：\n$$\nJ_{\\text{true}} - J_n = \\mathcal{A}[\\Delta J_n]\n$$\n其中 $J_{\\text{true}}$ 是精确的收敛解。\n\n为了分析此算符的性质，我们考虑一个无限、均匀介质的简化模型。在此模型中，拉姆达算符是一个卷积算符，其核与第一指数积分函数 $E_1$ 相关：\n$$\n\\Lambda[S(\\tau)] = \\frac{1}{2} \\int_{-\\infty}^{\\infty} S(\\tau') E_1(|\\tau - \\tau'|) d\\tau'\n$$\n\n**您的任务是推导理想加速算符 $\\mathcal{A}$ 在傅里叶空间中的显式函数形式。**设 $k$ 是对应于光学深度 $\\tau$ 的波数。您应该将算符的傅里叶变换 $\\tilde{\\mathcal{A}}(k)$ 表示为 $k$ 和热化参数 $\\epsilon$ 的函数。\n\n您可以不加证明地使用指数积分函数的以下标准傅里叶变换性质：\n$$\n\\int_{-\\infty}^{\\infty} \\frac{1}{2} E_1(|\\tau|) e^{-ik\\tau} d\\tau = \\frac{\\arctan(k)}{k}\n$$", "solution": "定义误差 $e_n = J_{\\text{true}} - J_n$。误差传播遵循 $e_{n+1} = (1-\\epsilon)\\Lambda[e_n]$。\n迭代的变化量为 $\\Delta J_n = J_{n+1} - J_n = (J_{\\text{true}} - J_n) - (J_{\\text{true}} - J_{n+1}) = e_n - e_{n+1} = [I - (1-\\epsilon)\\Lambda]e_n$。\n根据理想加速算符的定义 $e_n = \\mathcal{A}[\\Delta J_n]$，我们有 $\\mathcal{A} = [I - (1-\\epsilon)\\Lambda]^{-1}$。\n在傅里叶空间中，算符变为其傅里叶变换 $\\tilde{\\mathcal{A}}(k)$，因此：\n$$\\tilde{\\mathcal{A}}(k) = (1 - (1-\\epsilon)\\tilde{\\Lambda}(k))^{-1}$$\n代入 $\\tilde{\\Lambda}(k) = \\frac{\\arctan(k)}{k}$，我们得到：\n$$\\tilde{\\mathcal{A}}(k) = \\frac{1}{1-(1-\\epsilon)\\frac{\\arctan(k)}{k}}$$", "answer": "$$\\boxed{\\frac{1}{1-(1-\\epsilon)\\,\\frac{\\arctan(k)}{k}}}$$", "id": "257571"}]}