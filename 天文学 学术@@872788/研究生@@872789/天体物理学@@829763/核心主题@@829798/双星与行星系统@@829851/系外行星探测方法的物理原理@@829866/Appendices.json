{"hands_on_practices": [{"introduction": "凌星法是目前最高效的系外行星探测技术，但它存在一个固有的几何限制：只有当行星的轨道平面与我们的视线近乎对齐时，我们才能观测到凌星现象。本练习旨在通过推导凌星行星撞击参数 $b$ 的期望值，来量化这种观测选择效应 [@problem_id:250046]。通过解决这个问题，你将能够理解如何从基本的几何和概率原理出发，预测凌星巡天所发现行星样本的统计特性。", "problem": "**问题描述**\n\n对一个大的行星系综进行凌星巡天。每个系统包含一颗行星，该行星围绕一颗半径为 $R_s$ 的恒星以半长轴为 $a$ 的圆形轨道运行。一个关键假设是这些系统的轨道朝向是随机且各向同性的，这意味着任何给定行星的轨道平面法向量等可能地指向空间中的任何方向。\n\n撞击参数 $b$ 是一个无量纲量，用于衡量在合相时恒星中心和行星中心在天球平面上的投影距离。对于圆形轨道，其由关系式 $b = \\frac{a}{R_s} |\\cos i|$ 给出，其中 $i$ 是轨道倾角。轨道倾角 $i$ 是轨道平面法向量与观测者视线之间的夹角。\n\n如果行星中心从恒星盘面正前方经过，则观测到一次凌星。这发生在撞击参数 $b$ 满足条件 $b \\le 1$ 时。我们感兴趣的是被观测到发生凌星的行星子总体的统计特性。\n\n推导该凌星行星总体的撞击参数的期望值 $\\langle b \\rangle$。", "solution": "1. 对于各向同性的朝向，$x=\\cos i$ 的分布在 $[-1,1]$ 上是均匀的，所以\n$$f_x(x)=\\frac12,\\quad x\\in[-1,1].$$\n\n2. 定义 $u=|\\cos i|$。那么它在 $[0,1]$ 上的概率密度函数（PDF）是\n$$f_u(u)=f_x(u)+f_x(-u)=\\frac12+\\frac12=1,\\quad u\\in[0,1].$$\n\n3. 撞击参数为\n$$b=\\frac{a}{R_s}\\,u\\equiv A\\,u,\\quad A\\equiv\\frac{a}{R_s}.$$\n\n4. 凌星条件 $b\\le1$ 意味着\n$$u\\le\\frac1A.$$\n凌星的概率是\n$$P(\\text{transit})=\\int_0^{1/A}f_u(u)\\,du=\\int_0^{1/A}1\\,du=\\frac1A.$$\n\n5. 给定发生凌星的条件下，$u$ 的条件概率密度函数是\n$$f_{u|\\text{tran}}(u)=\\frac{f_u(u)}{P(\\text{transit})}=\\frac{1}{1/A}=A,\n\\quad u\\in\\left[0,\\frac1A\\right].$$\n\n6. 对于凌星行星，$b$ 的期望值为\n$$\n\\langle b\\rangle\n=\\int_0^{1/A}(A\\,u)\\,f_{u|\\text{tran}}(u)\\,du\n=A\\int_0^{1/A}u\\,(A)\\,du\n=A^2\\int_0^{1/A}u\\,du\n=A^2\\left[\\frac{u^2}{2}\\right]_0^{1/A}\n=A^2\\frac{1}{2A^2}\n=\\frac12.\n$$", "answer": "$$\\boxed{\\frac12}$$", "id": "250046"}, {"introduction": "引力微透镜效应能够探测到非常遥远的行星，其原理是测量由前景天体（透镜）引力场引起的背景恒星（源）亮度的短暂变化。在标准模型的基础上，任何微小的物理扰动都可能在光变曲线上留下可识别的异常信号。本练习探讨了“xallarap效应”，即源恒星自身的轨道运动如何对标准微透镜放大率曲线产生一阶修正 [@problem_id:250003]。这个实践将训练你使用一阶近似（泰勒展开）来分析微小扰动，这是从数据中提取精细信号的关键物理技能。", "problem": "引力微透镜事件的标准模型涉及一颗点状源星（S）和单个点状透镜质量（L）。透镜的引力场使来自源星的光线偏转，形成多个像，并导致源星短暂增亮。放大率 $A$ 是透镜与源之间无量纲角距离 $u$ 的函数，该角距离以爱因斯坦半径 $\\theta_E$ 为单位进行测量。标准放大率公式为：\n$$\nA(u) = \\frac{u^2 + 2}{u \\sqrt{u^2 + 4}}\n$$\n在一种更复杂的、被称为“xallarap效应”的情景中，源星并非静止，而是一个双星系统的成员，围绕系统的质心运行。这种轨道运动会对源星在天球上的位置引入一个小的周期性扰动，这反过来又会在放大率光变曲线中引起可探测的异常。\n\n考虑一个透镜为单个点质量的微透镜事件。源星是一颗在双星系统内以圆形轨道运行的恒星。为简单起见，假设轨道完全位于天球平面内（即轨道倾角 $i=90^\\circ$）。源星围绕双星质心轨道的投影半径，以爱因斯坦半径为单位测量，由常数 $\\rho$ 给出。我们假设 $\\rho \\ll 1$。\n\n我们在天球平面上定义一个二维坐标系，原点位于透镜的位置。源双星质心的未扰动轨迹是一条直线。设撞击参数（最小距离）为 $u_0$。我们对齐坐标系，使得在最接近时刻 $t_0$，质心位于位置 $\\vec{u}_B(t_0) = (u_0, 0)$。\n\n源星的轨道运动增加了一个位置偏移。在特定时刻 $t_0$，源星相对于双星质心的位置矢量由 $\\vec{u}_{orb}(t_0) = (\\rho \\cos\\phi, \\rho \\sin\\phi)$ 给出，其中 $\\phi$ 是那一瞬间的轨道相位角。\n\n推导在最接近时刻 $t_0$，由源星轨道运动引起的位移所导致的放大率的一阶修正 $\\delta A$。用撞击参数 $u_0$、归一化轨道半径 $\\rho$ 和轨道相位 $\\phi$ 来表示你的答案。", "solution": "1. 相关方程：\n   标准放大率为\n   $$A(u)=\\frac{u^2+2}{u\\sqrt{u^2+4}}.$$\n   对于一个小的源位移 $\\delta\\vec u$，一阶泰勒展开给出\n   $$\\delta A = \\nabla_{\\vec u}A\\bigl(\\vec u_B\\bigr)\\cdot\\delta\\vec u.$$\n\n2. 在最接近时刻 $t_0$，质心位置为 $\\vec u_B=(u_0,0)$，轨道偏移为 $\\delta\\vec u=(\\rho\\cos\\phi,\\rho\\sin\\phi)$。 由于 $A$ 仅依赖于 $u=|\\vec u|$，\n   $$\\nabla_{\\vec u}A = \\frac{dA}{du}\\,\\hat u = A'(u)\\frac{\\vec u}{u}.$$\n   在 $\\vec u_B$ 处，$\\hat u=(1,0)$ 且\n   $$\\delta A = A'(u_0)\\,(1,0)\\cdot(\\rho\\cos\\phi,\\rho\\sin\\phi) = A'(u_0)\\,\\rho\\cos\\phi.$$\n\n3. 计算 $A'(u)$。记 $A=N/D$，其中 $N=u^2+2$， $D=u\\sqrt{u^2+4}$。那么\n   $$N'=2u,\\quad D'=\\sqrt{u^2+4}+\\frac{u^2}{\\sqrt{u^2+4}} = \\frac{2(u^2+2)}{\\sqrt{u^2+4}}.$$\n   因此\n   $$\\frac{dA}{du} = \\frac{N'D - N D'}{D^2} = \\frac{2u\\bigl(u\\sqrt{u^2+4}\\bigr) - 2\\frac{(u^2+2)^2}{\\sqrt{u^2+4}}}{u^2(u^2+4)} = -\\frac{8}{u^2(u^2+4)^{3/2}}.$$\n\n4. 因此，一阶修正为\n   $$\\delta A = -\\frac{8\\rho\\cos\\phi}{u_0^2(u_0^2+4)^{3/2}}.$$", "answer": "$$\\boxed{-\\frac{8\\rho\\cos\\phi}{u_0^2(u_0^2+4)^{3/2}}}$$", "id": "250003"}, {"introduction": "天体测量法通过精确测量恒星因行星引力拖拽而产生的微小位置摆动来直接探测系外行星。在将轨道模型拟合到观测数据后，一个至关重要但更具挑战性的任务是量化拟合参数的不确定性。本练习将指导你推导在给定测量误差的情况下，通过最小化卡方（$\\chi^2$）统计量得到的最佳拟合参数的协方差矩阵 [@problem_id:250025]。掌握这一过程，你将能够把原始测量误差转化为对行星轨道元素等物理量的可信度量，这是现代天体物理数据分析的基石。", "problem": "我们于 $N$ 个不同时刻 $t_j$（$j=1, \\dots, N$）测量了一颗绕邻近恒星运行的系外行星的天体测量位置。每次测量都提供了该行星与恒星在赤经（$\\Delta \\alpha_j$）和赤纬（$\\Delta \\delta_j$）上的角分离。我们可以将这些测量数据组织成一组 $N$ 个二维数据向量 $\\mathbf{d}_j = (\\Delta \\alpha_j, \\Delta \\delta_j)^T$。假设测量不确定度服从高斯分布，各次测量之间不相关，且所有观测都具有相同的不确定度，在 $\\Delta \\alpha$ 和 $\\Delta \\delta$ 方向上的标准差均为 $\\sigma$。\n\n行星的轨道由一个包含 $M$ 个参数的模型描述，这些参数构成一个参数向量 $\\mathbf{p} = (p_1, \\dots, p_M)^T$。对于每个时刻 $t_j$，该模型预测出一个天体测量位置向量 $\\mathbf{m}_j(\\mathbf{p}) = (\\Delta \\alpha_{\\text{model}}(t_j, \\mathbf{p}), \\Delta \\delta_{\\text{model}}(t_j, \\mathbf{p}))^T$。\n\n最佳拟合参数 $\\mathbf{p}_0$ 是通过最小化卡方（$\\chi^2$）统计量得到的，其定义为：\n$$\n\\chi^2(\\mathbf{p}) = \\sum_{j=1}^{N} \\frac{(\\mathbf{d}_j - \\mathbf{m}_j(\\mathbf{p}))^T (\\mathbf{d}_j - \\mathbf{m}_j(\\mathbf{p}))}{\\sigma^2}\n$$\n\n最佳拟合参数的不确定度由参数协方差矩阵 $\\mathbf{C}$ 来表征，它与 $\\chi^2$ 似然曲面在其最小值处的曲率有关。对于多元高斯不确定度，协方差矩阵是费雪信息矩阵 $\\mathbf{F}$ 的逆矩阵，其分量由 $F_{kl} = \\frac{1}{2}\\frac{\\partial^2 \\chi^2}{\\partial p_k \\partial p_l}$ 在最佳拟合参数 $\\mathbf{p}_0$ 处计算得到。\n\n设 $\\mathbf{J}_j$ 为第 $j$ 次观测的雅可比矩阵，于最佳拟合参数 $\\mathbf{p}_0$ 处求值。这是一个 $2 \\times M$ 矩阵，其元素为 $(\\mathbf{J}_j)_{k,l} = \\frac{\\partial m_{j,k}}{\\partial p_l}|_{\\mathbf{p}_0}$，其中 $m_{j,k}$ 是模型向量 $\\mathbf{m}_j$ 的第 $k$ 个分量。\n\n假设模型在参数不确定度的尺度上足够线性（或等价地说，拟合良好且残差 $\\mathbf{d}_j - \\mathbf{m}_j(\\mathbf{p}_0)$ 很小并呈噪声特性），你可以忽略包含模型二阶导数 $\\frac{\\partial^2 \\mathbf{m}_j}{\\partial p_k \\partial p_l}$ 的项。在此近似下，推导最佳拟合参数 $\\mathbf{p}_0$ 的协方差矩阵 $\\mathbf{C}$ 的表达式。用测量不确定度 $\\sigma$ 和雅可比矩阵 $\\mathbf{J}_j$ 来表示你的答案。", "solution": "我们从卡方和费雪矩阵的定义出发：\n$$\n\\chi^2(\\mathbf p)=\\sum_{j=1}^N\\frac{(\\mathbf d_j-\\mathbf m_j(\\mathbf p))^T(\\mathbf d_j-\\mathbf m_j(\\mathbf p))}{\\sigma^2},\n\\qquad\nF_{kl}=\\tfrac12\\frac{\\partial^2\\chi^2}{\\partial p_k\\partial p_l}\\Big|_{\\mathbf p_0}.\n$$\n1. 一阶导数：\n$$\n\\frac{\\partial\\chi^2}{\\partial p_l}\n=-\\frac{2}{\\sigma^2}\\sum_{j=1}^N(\\mathbf d_j-\\mathbf m_j)^T\\frac{\\partial\\mathbf m_j}{\\partial p_l}\n=-\\frac{2}{\\sigma^2}\\sum_{j=1}^N(\\mathbf d_j-\\mathbf m_j)^T\\mathbf J_{j\\!,l}.\n$$\n2. 二阶导数，忽略 $\\partial^2\\mathbf m_j/\\partial p_k\\partial p_l$：\n$$\n\\frac{\\partial^2\\chi^2}{\\partial p_k\\partial p_l}\n=\\frac{2}{\\sigma^2}\\sum_{j=1}^N\\Bigl(\\frac{\\partial\\mathbf m_j}{\\partial p_k}\\Bigr)^T\n\\frac{\\partial\\mathbf m_j}{\\partial p_l}\n=\\frac{2}{\\sigma^2}\\sum_{j=1}^N(\\mathbf J_j)_{:,k}^T(\\mathbf J_j)_{:,l}.\n$$\n因此\n$$\nF_{kl}=\\frac1{2}\\frac{\\partial^2\\chi^2}{\\partial p_k\\partial p_l}\n=\\frac{1}{\\sigma^2}\\sum_{j=1}^N(\\mathbf J_j^T\\mathbf J_j)_{kl},\n$$\n或以矩阵形式表示\n$$\n\\mathbf F=\\frac{1}{\\sigma^2}\\sum_{j=1}^N\\mathbf J_j^T\\mathbf J_j.\n$$\n由于协方差为 $\\mathbf C=\\mathbf F^{-1}$，我们得到\n$$\n\\mathbf C=\\sigma^2\\left(\\sum_{j=1}^N\\mathbf J_j^T\\mathbf J_j\\right)^{-1}.\n$$", "answer": "$$\\boxed{\\sigma^2\\left(\\sum_{j=1}^N\\mathbf J_j^T\\mathbf J_j\\right)^{-1}}$$", "id": "250025"}]}