{"hands_on_practices": [{"introduction": "在任何定量科学中，理解和量化不确定性是解读实验或观测结果的核心。在从恒星运动学推断星盘表面密度的过程中，我们的最终结果 $\\Sigma$ 是通过测量恒星的速度弥散 $\\sigma_z$ 和标高 $h_z$ 计算得出的。本练习将引导您完成一个基础但至关重要的任务：推导观测误差如何传播到最终的物理量中，这使我们能够评估我们对表面密度估计的置信度。", "problem": "在天体物理学对星系盘的研究中，其垂直结构通常被建模为一个自引力、等温的恒星薄层。对于处于流体静力学平衡中的这样一个系统，示踪恒星族的垂直速度弥散 $\\sigma_z$ 与盘的总表面质量密度 $\\Sigma$ 以及该星族的垂直标高 $h_z$ 相关。该关系由以下公式给出：\n$$ \\sigma_z^2 = 2 \\pi G \\Sigma h_z $$\n其中 $G$ 是引力常数。\n\n天文观测提供了速度弥散 $\\sigma_z$ 和标高 $h_z$ 的测量值，每个值都有一定的不确定度。假设 $\\sigma_z$ 和 $h_z$ 的测量是独立的，且它们的不确定度很小，则可以通过误差传播来确定推导出的表面密度 $\\Sigma$ 的不确定度。\n\n令速度弥散的相对不确定度为 $\\epsilon_{\\sigma_z} = \\frac{\\delta\\sigma_z}{\\sigma_z}$，标高的相对不确定度为 $\\epsilon_{h_z} = \\frac{\\delta h_z}{h_z}$。引力常数 $G$ 和因子 $2\\pi$ 是精确已知的，没有不确定度。\n\n推导表面质量密度总相对不确定度 $\\frac{\\delta\\Sigma}{\\Sigma}$ 作为 $\\epsilon_{\\sigma_z}$ 和 $\\epsilon_{h_z}$ 函数的解析表达式。", "solution": "从垂直平衡关系式出发，\n$$\\sigma_z^2 = 2\\pi G\\,\\Sigma\\,h_z$$\n我们求解表面密度，\n$$\\Sigma = \\frac{\\sigma_z^2}{2\\pi G\\,h_z}。$$\n\n对于两个独立的测量值 $\\sigma_z$ 和 $h_z$，其相对不确定度很小，分别为\n$\\epsilon_{\\sigma_z}=\\frac{\\delta\\sigma_z}{\\sigma_z}$ 和 $\\epsilon_{h_z}=\\frac{\\delta h_z}{h_z}$，传播的相对不确定度为\n$$(\\tfrac{\\delta\\Sigma}{\\Sigma})^2\n= \\Bigl(\\tfrac{\\partial\\Sigma}{\\partial\\sigma_z}\\,\\frac{\\delta\\sigma_z}{\\Sigma}\\Bigr)^2\n+ \\Bigl(\\tfrac{\\partial\\Sigma}{\\partial h_z}\\,\\frac{\\delta h_z}{\\Sigma}\\Bigr)^2。$$\n\n计算偏导数：\n$$\\frac{\\partial\\Sigma}{\\partial\\sigma_z}\n= \\frac{2\\,\\sigma_z}{2\\pi G\\,h_z}\n= \\frac{2}{\\sigma_z}\\,\\Sigma,\n\\quad\n\\frac{\\partial\\Sigma}{\\partial h_z}\n= -\\frac{\\sigma_z^2}{2\\pi G\\,h_z^2}\n= -\\frac{1}{h_z}\\,\\Sigma。$$\n\n因此\n$$\\frac{\\partial\\Sigma}{\\partial\\sigma_z}\\,\\frac{\\delta\\sigma_z}{\\Sigma}\n= 2\\,\\epsilon_{\\sigma_z},\n\\quad\n\\frac{\\partial\\Sigma}{\\partial h_z}\\,\\frac{\\delta h_z}{\\Sigma}\n= -\\,\\epsilon_{h_z},$$\n且\n$$(\\tfrac{\\delta\\Sigma}{\\Sigma})^2\n= (2\\,\\epsilon_{\\sigma_z})^2 + (\\epsilon_{h_z})^2\n= 4\\,\\epsilon_{\\sigma_z}^2 + \\epsilon_{h_z}^2。$$\n取正平方根得到总相对不确定度：\n$$\\frac{\\delta\\Sigma}{\\Sigma}\n= \\sqrt{4\\,\\epsilon_{\\sigma_z}^2 + \\epsilon_{h_z}^2}。$$", "answer": "$$\\boxed{\\sqrt{4\\,\\epsilon_{\\sigma_z}^2 + \\epsilon_{h_z}^2}}$$", "id": "275482"}, {"introduction": "表面密度测量的有效性，关键取决于我们选择的示踪星是否代表了一个单一、均衡的星族。本练习模拟了一个在实际研究中可能出现的分析错误：将来自不同动力学特性的两个星族（一个“热”星族和一个“冷”星族）的参数混合使用。通过推导这种情况下导致的误差，您将深刻理解在应用物理模型时，谨慎选择和验证示踪样本以避免引入巨大系统性偏差的重要性。", "problem": "一位天体物理学家正在研究一个星系盘的垂直结构。该星系盘被建模为具有两个不同的、引力相互作用的恒星成分：一个动力学“冷”星族（例如，年轻恒星）和一个动力学“热”星族（例如，年老恒星）。星系盘的总表面质量密度为 $\\Sigma_{\\text{true}}$。\n\n两个星族都被假定为等温的，并处于垂直流体静力学平衡状态。在此框架下，每个成分 $i$（其中 $i$ 可以是代表冷的 `c` 或代表热的 `h`）的垂直密度分布由一个具有特征标高的指数函数近似，标高为 $h_i$。每个成分的标高与其垂直速度弥散 $\\sigma_{z,i}$ 和总表面密度 $\\Sigma_{\\text{true}}$ 通过以下方程相关联：\n$$\n\\sigma_{z,i}^2 = \\alpha G \\Sigma_{\\text{true}} h_i\n$$\n此处，$G$ 是引力常数，$\\alpha$ 是一个量级为1的无量纲常数，其值取决于详细的垂直质量分布。\n\n这位天体物理学家进行了两次测量：\n1. 冷成分的标高 $h_c$。\n2. 热成分的垂直速度弥散 $\\sigma_{z,h}$。\n\n不幸的是，他们在分析中犯了一个错误。他们误认为星系盘是一个单成分系统，因此应用了单成分公式 $\\Sigma = \\sigma_z^2 / (\\alpha G h)$ 来计算表面密度。他们错误地将两个不同的测量值——热成分的速度弥散和冷成分的标高——结合起来，计算出了一个错误的表面密度，我们称之为 $\\Sigma_{\\text{err}}$。\n\n从恒星星族研究中可知，热成分的垂直速度弥散是冷成分的 $N$ 倍，即 $\\sigma_{z,h} = N \\sigma_{z,c}$。\n\n推导错误表面密度与真实表面密度之比 $\\frac{\\Sigma_{\\text{err}}}{\\Sigma_{\\text{true}}}$ 关于因子 $N$ 的表达式。", "solution": "1. 对于处于垂直流体静力学平衡中的每个成分 $i\\in\\{c,h\\}$ 的相关方程：\n$$\\sigma_{z,i}^2 = \\alpha\\,G\\,\\Sigma_{\\text{true}}\\,h_i.$$\n2. 天体物理学家使用 $\\sigma_{z,h}$ 和 $h_c$ 计算出的错误表面密度为\n$$\\Sigma_{\\text{err}}\n=\\frac{\\sigma_{z,h}^2}{\\alpha\\,G\\,h_c}.$$\n3. 从冷成分来看，真实的表面密度为\n$$\\Sigma_{\\text{true}}\n=\\frac{\\sigma_{z,c}^2}{\\alpha\\,G\\,h_c}.$$\n4. 两者取比值，\n$$\\frac{\\Sigma_{\\text{err}}}{\\Sigma_{\\text{true}}}\n=\\frac{\\displaystyle\\frac{\\sigma_{z,h}^2}{\\alpha\\,G\\,h_c}}\n{\\displaystyle\\frac{\\sigma_{z,c}^2}{\\alpha\\,G\\,h_c}}\n=\\frac{\\sigma_{z,h}^2}{\\sigma_{z,c}^2}.$$\n5. 使用关系式 $\\sigma_{z,h}=N\\,\\sigma_{z,c}$ 可得\n$$\\frac{\\Sigma_{\\text{err}}}{\\Sigma_{\\text{true}}}\n=\\frac{(N\\,\\sigma_{z,c})^2}{\\sigma_{z,c}^2}\n=N^2.$$", "answer": "$$\\boxed{N^2}$$", "id": "275340"}, {"introduction": "现代天体物理学研究正从简单的点估计转向更复杂的统计推断方法，以便从有限和带有噪声的数据中提取最可靠的物理信息。本高级练习将带您进入现代数据分析的前沿，应用贝叶斯统计框架来解决表面密度推断问题。通过为一个给定的恒星样本推导其表面密度的最大后验（MAP）估计，您将亲身体验如何利用概率模型直接从原始观测数据中推断出天体物理参数，这是构成现代天文学研究基石的一种强大方法。", "problem": "一个用于描述银河盘垂直结构的标准模型将其视为一个自引力的、无限大、平面平行的恒星等温片。在此模型中，观测到一颗垂直位置为 $z$、垂直速度为 $v_z$ 的单颗恒星的概率密度函数 (PDF) 由下式给出：\n$$\nP(z, v_z | \\Sigma, \\sigma_z) = \\frac{1}{\\mathcal{N}} \\exp\\left( -\\frac{v_z^2}{2\\sigma_z^2} - \\frac{\\Phi(z)}{\\sigma_z^2} \\right)\n$$\n其中 $\\sigma_z$ 是恒定的垂直速度弥散，$\\Phi(z)$ 是引力势，$\\mathcal{N}$ 是一个归一化常数。对于一个自引力等温片，势和密度通过泊松方程保持一致，从而得到如下具体形式：\n$$\nP(z, v_z | \\Sigma, \\sigma_z) = \\frac{\\pi G \\Sigma}{2\\sigma_z^3 \\sqrt{2\\pi}} \\exp\\left(-\\frac{v_z^2}{2\\sigma_z^2}\\right) \\text{sech}^2\\left(\\frac{\\pi G \\Sigma z}{\\sigma_z^2}\\right)\n$$\n这里，$\\Sigma$ 是盘的总表面质量密度，$G$ 是引力常数。\n\n一位天文学家收集了一个包含 $N$ 颗恒星的样本数据，其中包括它们的垂直位置 $\\{z_i\\}_{i=1}^N$。从它们的光谱数据中，该星族的垂直速度弥散 $\\sigma_z$ 得到了很好的约束，可以被视为一个已知常数。\n\n你的任务是进行贝叶斯分析，以确定表面密度 $\\Sigma$。假设表面密度的先验为无信息 Jeffreys 先验，$P(\\Sigma) \\propto 1/\\Sigma$。在推导的最后一步，你可以假设所有观测到的恒星都靠近银河中平面，这使得近似 $\\tanh(x) \\approx x$ 是合理的。\n\n推导局域表面密度的最大后验 (MAP) 估计量 $\\Sigma_{\\text{MAP}}$，用已知量 $N$、$\\sigma_z$、$G$ 以及数据集 $\\{z_i\\}$ 表示。", "solution": "对 $v_z$ 进行积分，可以得到每个 $z_i$ 的边缘似然，\n$$\nP(z|\\Sigma)=\\int_{-\\infty}^\\infty P(z,v_z|\\Sigma)\\,dv_z\n=\\frac{\\pi G\\Sigma}{2\\sigma_z^3\\sqrt{2\\pi}}\\sqrt{2\\pi}\\,\\sigma_z\\;\\text{sech}^2\\!\\Bigl(\\frac{\\pi G\\Sigma z}{\\sigma_z^2}\\Bigr)\n=\\frac{\\pi G\\Sigma}{2\\sigma_z^2}\\text{sech}^2\\!\\Bigl(\\alpha z\\Bigr),\n\\quad \\alpha\\equiv\\frac{\\pi G\\Sigma}{\\sigma_z^2}.\n$$\n使用 Jeffreys 先验 $P(\\Sigma)\\propto1/\\Sigma$，后验分布为\n$$\nP(\\Sigma|\\{z_i\\})\\propto\\frac1\\Sigma\\prod_{i=1}^N P(z_i|\\Sigma)\n\\propto\\Sigma^{N-1}\\prod_{i=1}^N\\text{sech}^2(\\alpha z_i).\n$$\n因此，对数后验为\n$$\n\\mathcal L=(N-1)\\ln\\Sigma-2\\sum_{i=1}^N\\ln\\cosh(\\alpha z_i)+\\text{const}.\n$$\n令 $d\\mathcal L/d\\Sigma=0$ 可得\n$$\n\\frac{N-1}{\\Sigma}-2\\sum_{i=1}^N\\frac{d}{d\\Sigma}\\ln\\cosh(\\alpha z_i)\n=\\frac{N-1}{\\Sigma}-2\\sum_{i=1}^N\\frac{\\pi Gz_i}{\\sigma_z^2}\\tanh(\\alpha z_i)=0.\n$$\n对于靠近中平面的恒星，有 $|\\alpha z_i|\\ll1$，因此 $\\tanh(\\alpha z_i)\\approx\\alpha z_i$，所以\n$$\n\\frac{N-1}{\\Sigma}-2\\sum_{i=1}^N\\frac{\\pi Gz_i}{\\sigma_z^2}\\frac{\\pi G\\Sigma z_i}{\\sigma_z^2}=0\n\\;\\Longrightarrow\\;\nN-1=2\\frac{(\\pi G\\Sigma)^2}{\\sigma_z^4}\\sum_{i=1}^N z_i^2.\n$$\n解出 $\\Sigma$ 可得\n$$\n\\Sigma_{\\text{MAP}}=\\frac{\\sigma_z^2}{\\pi G}\\sqrt{\\frac{N-1}{2\\sum_{i=1}^N z_i^2}}.\n$$", "answer": "$$\\boxed{\\frac{\\sigma_z^2}{\\pi G}\\sqrt{\\frac{N-1}{2\\sum_{i=1}^N z_i^2}}}$$", "id": "275544"}]}