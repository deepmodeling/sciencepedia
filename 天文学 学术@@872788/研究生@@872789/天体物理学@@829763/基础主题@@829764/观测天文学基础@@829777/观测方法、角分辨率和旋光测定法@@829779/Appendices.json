{"hands_on_practices": [{"introduction": "在射电干涉测量中，由于对天空亮度的傅里叶分量进行了不完全采样，重建的图像（即“脏图”）会与一个复杂的点扩展函数（即“脏波束”）发生卷积，从而产生降低图像保真度的伪影。Högbom CLEAN算法是天体物理学中用于解决此问题的经典解卷积方法。通过这个练习[@problem_id:249013]，您将亲手实践该算法的核心迭代步骤，理解如何通过识别和减去最亮的源成分来逐步“清洁”图像，从而对图像重建过程建立起直观的认识。", "problem": "在射电干涉测量中，观测到的图像，被称为“脏图”$I_D(\\vec{r})$，是真实天空亮度分布与干涉仪的点扩散函数（即“脏束”$B_D(\\vec{r})$）卷积的结果。Högbom CLEAN 算法是一种广泛使用的迭代反卷积技术，用于去除由脏束的旁瓣引入的伪影。\n\n该算法的步骤如下：\n1.  初始化“残差图”$I_R$为脏图，$I_{R,0}(\\vec{r}) = I_D(\\vec{r})$。\n2.  在每次迭代 $i$ 中，在当前残差图 $I_{R,i}(\\vec{r})$ 中找到最亮点的坐标 $\\vec{r}_{p,i}$ 和流量 $I_{p,i}$。\n3.  从残差图中减去一部分脏束，该脏束按峰值流量进行缩放并以峰值位置为中心。此更新由下式给出：\n    $$I_{R, i+1}(\\vec{r}) = I_{R, i}(\\vec{r}) - g \\, I_{p,i} \\, B_D(\\vec{r} - \\vec{r}_{p,i})$$\n    其中，$g$ 是一个称为“循环增益”的无量纲参数，通常在 $0$ 和 $1$ 之间。\n4.  重复此过程，直到满足停止准则。\n\n考虑一个简单情况，脏图由单个未分辨的点源组成。由于与脏束的卷积，脏图表示为一个以 $\\vec{r}_0 = (x_0, y_0)$ 为中心的高斯函数：\n$$I_D(x, y) = A \\exp\\left(-\\frac{(x-x_0)^2 + (y-y_0)^2}{2\\sigma_S^2}\\right)$$\n其中 $A > 0$ 是峰值振幅，$\\sigma_S$ 是特征宽度。\n\n对于此特定观测，其脏束有一个主瓣和一个显著的旁瓣。它被建模为两个高斯函数的和：\n$$B_D(x, y) = \\exp\\left(-\\frac{x^2+y^2}{2\\sigma_B^2}\\right) + S \\exp\\left(-\\frac{(x-x_s)^2 + (y-y_s)^2}{2\\sigma_B^2}\\right)$$\n其中 $\\sigma_B$ 是高斯分量的宽度，$(x_s, y_s)$ 是旁瓣相对于主瓣的位置，$S$ 是旁瓣的相对强度。你可以假设脏束的全局最大值在原点 $(0,0)$，这在 $0  S  1$ 时成立。\n\n推导 Högbom CLEAN 算法第一次完整迭代后的残差图 $I_{R,1}(x, y)$ 的解析表达式。你的最终表达式应以 $x, y, A, x_0, y_0, \\sigma_S, g, \\sigma_B, S, x_s$ 和 $y_s$ 表示。", "solution": "1. 初始残差是脏图：\n$$I_{R,0}(x,y)=I_D(x,y)=A\\exp\\Bigl(-\\frac{(x-x_0)^2+(y-y_0)^2}{2\\sigma_S^2}\\Bigr)\\,. $$\n2. 最亮的峰值出现在 $(x_0,y_0)$，其流量为 $I_{p,0}=A$，位置为 $\\vec r_{p,0}=(x_0,y_0)$。\n3. 一次迭代后的 CLEAN 更新为\n$$I_{R,1}(x,y)=I_{R,0}(x,y)-g\\,I_{p,0}\\,B_D\\bigl(x-x_0,y-y_0\\bigr)\\,. $$\n4. 代入 $I_{R,0}$ 和 $B_D$：\n$$\\begin{aligned}\nI_{R,1}(x,y)=A\\exp\\Bigl(-\\frac{(x-x_0)^2+(y-y_0)^2}{2\\sigma_S^2}\\Bigr)\n-gA\\Bigl[\\exp\\Bigl(-\\frac{(x-x_0)^2+(y-y_0)^2}{2\\sigma_B^2}\\Bigr)\\\\\n\\quad+S\\exp\\Bigl(-\\frac{(x-x_0-x_s)^2+(y-y_0-y_s)^2}{2\\sigma_B^2}\\Bigr)\\Bigr]\\,.  \n\\end{aligned}$$", "answer": "$$\\boxed{A\\exp\\!\\Bigl(-\\frac{(x-x_0)^2+(y-y_0)^2}{2\\sigma_S^2}\\Bigr)\\;-\\;g\\,A\\Bigl[\\exp\\!\\Bigl(-\\frac{(x-x_0)^2+(y-y_0)^2}{2\\sigma_B^2}\\Bigr)\\;+\\;S\\,\\exp\\!\\Bigl(-\\frac{(x-x_0-x_s)^2+(y-y_0-y_s)^2}{2\\sigma_B^2}\\Bigr)\\Bigr]}$$", "id": "249013"}, {"introduction": "现在，我们将注意力转向偏振测量技术，任何实际仪器的性能都存在其物理极限。旋转半波片（HWP）是许多偏振计中的关键光学元件，其制造精度直接决定了线性偏振的测量准确性。这个练习[@problem_id:248789]将引导您使用穆勒矩阵这一强大的数学工具，来量化一个微小的物理缺陷（延迟误差）如何转化为可测量的性能损失（偏振调制效率的降低），这对于仪器设计和误差分析至关重要。", "problem": "旋转半波片 (HWP) 是用于测量线偏振的偏振计中的常见组件。一个理想的 HWP 会在光的两个正交线偏振分量之间引入 $\\Delta = \\pi$ 弧度的相移（延迟量）。在此设置中，HWP 旋转，其快轴相对于参考方向成 $\\theta$ 角。其后是一个固定的线偏振片，称为检偏器，它沿着参考方向（角度 $\\alpha=0$）定向。这种配置将入射的线偏振信号调制成一个易于测量的时变强度信号。\n\n在实际仪器中，HWP 并非理想，其延迟量为 $\\Delta = \\pi + \\delta$，其中 $\\delta$ 是一个小的、恒定的延迟量误差。这种不完美性降低了仪器测量线偏振的能力。\n\n斯托克斯矢量 $S = [I, Q, U, V]^T$ 描述了光的偏振态。一个光学元件由一个 $4\\times4$ 的穆勒矩阵 $M$ 来描述。出射的斯托克斯矢量 $S_{out}$ 由 $S_{out} = M S_{in}$ 给出。测量的强度是最终斯托克斯矢量的第一个分量。\n\n快轴角度为 $\\theta$、延迟量为 $\\Delta$ 的延迟器的穆勒矩阵为：\n$$\nM_{R}(\\theta, \\Delta) = \\begin{pmatrix}\n1   0   0   0 \\\\\n0   \\cos^2(2\\theta) + \\sin^2(2\\theta)\\cos(\\Delta)   \\cos(2\\theta)\\sin(2\\theta)(1-\\cos(\\Delta))   -\\sin(2\\theta)\\sin(\\Delta) \\\\\n0   \\cos(2\\theta)\\sin(2\\theta)(1-\\cos(\\Delta))   \\sin^2(2\\theta) + \\cos^2(2\\theta)\\cos(\\Delta)   \\cos(2\\theta)\\sin(\\Delta) \\\\\n0   \\sin(2\\theta)\\sin(\\Delta)   -\\cos(2\\theta)\\sin(\\Delta)   \\cos(\\Delta)\n\\end{pmatrix}\n$$\n方向角为 $\\alpha$ 的线偏振片的穆勒矩阵为：\n$$\nM_{LP}(\\alpha) = \\frac{1}{2} \\begin{pmatrix}\n1   \\cos(2\\alpha)   \\sin(2\\alpha)   0 \\\\\n\\cos(2\\alpha)   \\cos^2(2\\alpha)   \\cos(2\\alpha)\\sin(2\\alpha)   0 \\\\\n\\sin(2\\alpha)   \\cos(2\\alpha)\\sin(2\\alpha)   \\sin^2(2\\alpha)   0 \\\\\n0   0   0   0\n\\end{pmatrix}\n$$\n\n线偏振的“偏振调制效率” $\\eta$ 定义为实际 HWP 在 $4\\theta$ 谐波处的强度调制振幅与理想 HWP（$\\delta=0$）相应振幅之比。\n\n推导由延迟量误差 $\\delta$ 引起的偏振调制效率损失，定义为 $1-\\eta$。最终表达式应对小 $\\delta$ 有效，并给出至 $\\delta$ 的最低非零阶。", "solution": "1. 经过旋转延迟器和固定偏振片后的输出强度为 $I_{\\rm out}=\\frac12\\bigl(I_{\\rm in}+S_{1}\\bigr)$，其中 $S_{1}$ 是经过延迟器后的第二个斯托克斯分量：$$S_{1}=M_{R,11}Q+M_{R,12}U$$\n2. 对于 $\\Delta=\\pi+\\delta$ 且 $\\delta\\ll1$，有 $\\cos\\Delta=-1+\\frac{\\delta^2}{2}+O(\\delta^4)$ 和 $1-\\cos\\Delta=2-\\frac{\\delta^2}{2}+O(\\delta^4)$。\n3. 根据穆勒矩阵，\n$$ \\begin{aligned} M_{R,11} = \\cos^2(2\\theta)+\\sin^2(2\\theta)\\cos\\Delta \\\\ = \\cos(4\\theta)+\\frac{\\delta^2}{2}\\sin^2(2\\theta), \\end{aligned} $$\n$$ \\begin{aligned} M_{R,12} = \\cos(2\\theta)\\sin(2\\theta)(1-\\cos\\Delta) \\\\ = \\sin(4\\theta)-\\frac{\\delta^2}{4}\\sin(4\\theta). \\end{aligned} $$\n因此，\n$$ S_{1} = \\left(\\cos(4\\theta)+\\frac{\\delta^2}{2}\\sin^2(2\\theta)\\right)Q + \\left(\\sin(4\\theta)-\\frac{\\delta^2}{4}\\sin(4\\theta)\\right)U. $$\n4. 利用 $\\sin^2(2\\theta)=\\frac12(1-\\cos(4\\theta))$，则 $4\\theta$ 项变为\n$$ S_{1}^{(4\\theta)} = \\left(1-\\frac{\\delta^2}{4}\\right)\\bigl(Q\\cos(4\\theta)+U\\sin(4\\theta)\\bigr). $$\n因此调制振幅为\n$$ A_{\\rm real}=\\frac12\\left(1-\\frac{\\delta^2}{4}\\right)\\sqrt{Q^2+U^2}, \\quad A_{\\rm ideal}=\\frac12\\sqrt{Q^2+U^2}. $$\n5. 效率为\n$$ \\eta=\\frac{A_{\\rm real}}{A_{\\rm ideal}}=1-\\frac{\\delta^2}{4}, $$\n所以损失为\n$$ 1-\\eta=\\frac{\\delta^2}{4}. $$", "answer": "$$\\boxed{\\frac{\\delta^2}{4}}$$", "id": "248789"}, {"introduction": "在认识到仪器不完美性的基础上，关键的下一步是精确地校准这些效应。在偏振测量中，望远镜天线自身的“仪器偏振”（通常由“D-terms”描述）会污染来自天体的真实信号，必须在数据分析前予以扣除。本练习[@problem_id:249075]模拟了一个标准的校准流程，它利用一个已知偏振特性的校准源在天空中的位置变化（视差角旋转），来反解描述仪器偏振的琼斯矩阵参数，这是获取高保真度偏振数据的关键一步。", "problem": "在射电偏振测量中，天线测得的电压信号通过一个 $2 \\times 2$ 的 Jones 矩阵 $J$ 与来自天体源的真实电磁波相关联。观测到的相干矩阵 $\\rho'$ 的测量方程为 $\\rho' = J \\rho J^\\dagger$，其中 $\\rho$ 是源在天线参考系中的真实相干矩阵。相干矩阵按照惯例通过 Stokes 参数 $(I, Q, U, V)$ 表示为：\n$$\n\\rho = \\frac{1}{2}\\begin{pmatrix} I+Q   U+iV \\\\ U-iV   I-Q \\end{pmatrix}\n$$\n考虑一个天线仪器偏振的简化模型，其中主增益被归一化为1，仪器泄漏由微小的复数“D项” $d_x$ 和 $d_y$ 描述。Jones 矩阵由下式给出：\n$$\nJ = \\begin{pmatrix} 1   d_x \\\\ d_y   1 \\end{pmatrix}\n$$\n为了校准这些D项，需要在一个视差角 $\\psi$ 范围内观测一个具有已知 Stokes 参数 $(I_c, Q_c, U_c)$ 的单个、未分辨的校准源。随着源在天空中移动，其偏振方向相对于固定的天线看起来会发生旋转。因此，源在天线参考系中的真实相干矩阵 $\\rho_{ant}(\\psi)$ 是视差角的函数。\n\n对于很小的D项（$|d_x|, |d_y| \\ll 1$），测量方程可以被线性化。观测到的非对角项 $\\rho'_{xy}$ 与其在天线参考系中的真实值 $\\rho_{xy,ant}(\\psi)$ 之间的偏差可以很好地近似为：\n$$\n\\rho'_{xy}(\\psi) - \\rho_{xy,ant}(\\psi) \\approx d_x \\rho_{yy,ant}(\\psi) + d_y^* \\rho_{xx,ant}(\\psi)\n$$\n假设已在不同的视差角进行了一系列测量。复数据向量 $\\Delta(\\psi) = 2 \\left( \\rho'_{xy}(\\psi) - \\rho_{xy,ant}(\\psi) \\right)$ 已被拟合到一个考虑了视差角旋转的模型中：\n$$\n\\Delta(\\psi) = A_1 + A_2 \\cos(2\\psi) + A_3 \\sin(2\\psi)\n$$\n通过此过程得到的最佳拟合复系数为 $A_1$、$A_2$ 和 $A_3$。\n\n假设校准源的总强度不为零（$I_c \\neq 0$）并且是线性偏振的（$Q_c^2 + U_c^2 \\neq 0$），请推导仪器泄漏项 $d_x$ 的最小二乘估计。用已知的校准源 Stokes 参数 $I_c$、$Q_c$、$U_c$ 和拟合的复系数 $A_1$、$A_2$、$A_3$ 来表示你的答案。", "solution": "我们从天线参考系中的源 Stokes 参数开始。对于一个 $V_c=0$ 的校准源，由视差角 $\\psi$ 引起的旋转给出：\n$$\nQ_{\\rm ant}(\\psi)=Q_c\\cos2\\psi+U_c\\sin2\\psi,\\quad\nU_{\\rm ant}(\\psi)=-Q_c\\sin2\\psi+U_c\\cos2\\psi.\n$$\n因此，真实的相干项为\n$$\n\\rho_{xy,ant}=\\tfrac12\\,U_{\\rm ant},\\quad\n\\rho_{xx,ant}=\\tfrac12\\,(I_c+Q_{\\rm ant}),\\quad\n\\rho_{yy,ant}=\\tfrac12\\,(I_c-Q_{\\rm ant}).\n$$\n\n将测量方程线性化后得到\n$$\n\\Delta(\\psi)=2\\bigl(\\rho'_{xy}-\\rho_{xy,ant}\\bigr)\n\\approx d_x\\,(I_c-Q_{\\rm ant})+d_y^*\\,(I_c+Q_{\\rm ant}).\n$$\n代入 $Q_{\\rm ant}=Q_c\\cos2\\psi+U_c\\sin2\\psi$：\n$$\n\\Delta(\\psi)=(d_x+d_y^*)\\,I_c+(-d_x+d_y^*)\\,(Q_c\\cos2\\psi+U_c\\sin2\\psi).\n$$\n拟合 $\\Delta(\\psi)=A_1+A_2\\cos2\\psi+A_3\\sin2\\psi$ 得到\n$$\nA_1=(d_x+d_y^*)\\,I_c,\\quad \nA_2=(-d_x+d_y^*)\\,Q_c,\\quad\nA_3=(-d_x+d_y^*)\\,U_c.\n$$\n定义\n$$\nS=d_x+d_y^*,\\quad D=-d_x+d_y^*.\n$$\n那么 $S=A_1/I_c$，且 $D$ 的最小二乘解是\n$$\nD=\\frac{Q_cA_2+U_cA_3}{Q_c^2+U_c^2}.\n$$\n最后，\n$$\nd_x=\\frac{S-D}{2}\n=\\frac12\\Bigl(\\frac{A_1}{I_c}-\\frac{Q_cA_2+U_cA_3}{Q_c^2+U_c^2}\\Bigr).\n$$", "answer": "$$\\boxed{\\frac12\\Bigl(\\frac{A_1}{I_c}-\\frac{Q_cA_2+U_cA_3}{Q_c^2+U_c^2}\\Bigr)}$$", "id": "249075"}]}