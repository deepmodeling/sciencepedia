{"hands_on_practices": [{"introduction": "这第一个实践为处理观测数据奠定了基础。我们将探讨基本天体测量——自行和视差——中的不确定性如何传播到我们推导出的切向速度中[@problem_id:274431]。你会发现，由于两个速度分量都依赖于同一个视差测量值，它们的误差会变得相关——这是严谨数据分析中的一个关键概念。", "problem": "在恒星运动学中，恒星在天球平面上的切向速度是一个关键的导出量。它通常被分解为沿天球坐标系坐标轴的两个分量。在银道坐标系中，这些分量是 $v_l$（沿银经 $l$ 增加方向的速度）和 $v_b$（沿银纬 $b$ 增加方向的速度）。\n\n这些速度不是直接测量的，而是通过三个天体测量观测量计算得出的：周年视差 $\\varpi$ 和自行 $\\mu_l$ 与 $\\mu_b$ 的两个分量。它们之间的关系是：\n$$v_l = K \\frac{\\mu_l}{\\varpi}$$\n$$v_b = K \\frac{\\mu_b}{\\varpi}$$\n其中 $K$ 是一个常数，用于处理单位转换（例如，将视差的单位毫角秒和自行的单位毫角秒/年转换为速度的单位公里/秒）。\n\n观测量 $(\\mu_l, \\mu_b, \\varpi)$ 各有其测量不确定度，分别表示为 $\\sigma_{\\mu_l}$、$\\sigma_{\\mu_b}$ 和 $\\sigma_\\varpi$。通常假设这三个观测量的测量误差是统计独立的（不相关的）。然而，由于 $v_l$ 和 $v_b$ 都依赖于相同的视差测量值 $\\varpi$，它们的不确定度将会是相关的。\n\n一组导出量 $\\mathbf{y} = f(\\mathbf{x})$ 的不确定度可以用协方差矩阵 $\\mathbf{C_y}$ 来描述，该矩阵是根据输入观测量 $\\mathbf{C_x}$ 的协方差矩阵，使用一阶误差传播公式计算得出的：\n$$\\mathbf{C_y} = \\mathbf{J} \\mathbf{C_x} \\mathbf{J}^T$$\n其中 $\\mathbf{J}$ 是该变换的雅可比矩阵（$J_{ij} = \\partial y_i / \\partial x_j$），$\\mathbf{J}^T$ 是其转置矩阵。\n\n推导切向速度分量的 2x2 协方差矩阵 $\\mathbf{C_v}$，其定义如下：\n$$\\mathbf{C_v} = \\begin{pmatrix} \\sigma_{v_l}^2  \\text{Cov}(v_l, v_b) \\\\ \\text{Cov}(v_b, v_l)  \\sigma_{v_b}^2 \\end{pmatrix}$$\n请用观测量 $\\mu_l, \\mu_b, \\varpi$、它们的不确定度 $\\sigma_{\\mu_l}, \\sigma_{\\mu_b}, \\sigma_\\varpi$ 以及常数 $K$ 来表示你的答案。", "solution": "我们有 $\\mathbf{y}=(v_l,v_b)$ 和 $\\mathbf{x}=(\\mu_l,\\mu_b,\\varpi)$。雅可比矩阵 $J_{ij}=\\partial y_i/\\partial x_j$ 为\n$$\\frac{\\partial v_l}{\\partial\\mu_l}=\\frac{K}{\\varpi},\\quad\n\\frac{\\partial v_l}{\\partial\\mu_b}=0,\\quad\n\\frac{\\partial v_l}{\\partial\\varpi}=-\\frac{K\\mu_l}{\\varpi^2},$$\n$$\\frac{\\partial v_b}{\\partial\\mu_l}=0,\\quad\n\\frac{\\partial v_b}{\\partial\\mu_b}=\\frac{K}{\\varpi},\\quad\n\\frac{\\partial v_b}{\\partial\\varpi}=-\\frac{K\\mu_b}{\\varpi^2},$$\n因此\n$$J=\\begin{pmatrix}\nK/\\varpi  0  -K\\mu_l/\\varpi^2\\\\\n0  K/\\varpi  -K\\mu_b/\\varpi^2\n\\end{pmatrix}.$$\n\n输入的协方差矩阵为\n$$C_x=\\operatorname{diag}(\\sigma_{\\mu_l}^2,\\sigma_{\\mu_b}^2,\\sigma_\\varpi^2).$$\n根据一阶误差传播，\n$$C_v=J\\,C_x\\,J^T,$$\n按分量计算得到\n$$\\sigma_{v_l}^2\n=(K/\\varpi)^2\\sigma_{\\mu_l}^2+(-K\\mu_l/\\varpi^2)^2\\,\\sigma_\\varpi^2\n=K^2\\Bigl(\\frac{\\sigma_{\\mu_l}^2}{\\varpi^2}+\\frac{\\mu_l^2\\sigma_\\varpi^2}{\\varpi^4}\\Bigr),$$\n$$\\sigma_{v_b}^2\n=(K/\\varpi)^2\\sigma_{\\mu_b}^2+(-K\\mu_b/\\varpi^2)^2\\,\\sigma_\\varpi^2\n=K^2\\Bigl(\\frac{\\sigma_{\\mu_b}^2}{\\varpi^2}+\\frac{\\mu_b^2\\sigma_\\varpi^2}{\\varpi^4}\\Bigr),$$\n$$\\mathrm{Cov}(v_l,v_b)\n=(-K\\mu_l/\\varpi^2)(-K\\mu_b/\\varpi^2)\\,\\sigma_\\varpi^2\n=K^2\\frac{\\mu_l\\mu_b\\,\\sigma_\\varpi^2}{\\varpi^4}.$$\n\n因此\n$$C_v=\\begin{pmatrix}\nK^2\\Bigl(\\frac{\\sigma_{\\mu_l}^2}{\\varpi^2}+\\frac{\\mu_l^2\\sigma_\\varpi^2}{\\varpi^4}\\Bigr)  K^2\\frac{\\mu_l\\mu_b\\,\\sigma_\\varpi^2}{\\varpi^4} \\\\\nK^2\\frac{\\mu_l\\mu_b\\,\\sigma_\\varpi^2}{\\varpi^4}  K^2\\Bigl(\\frac{\\sigma_{\\mu_b}^2}{\\varpi^2}+\\frac{\\mu_b^2\\sigma_\\varpi^2}{\\varpi^4}\\Bigr)\n\\end{pmatrix}.$$", "answer": "$$\\boxed{\\begin{pmatrix}\nK^2\\Bigl(\\frac{\\sigma_{\\mu_l}^2}{\\varpi^2}+\\frac{\\mu_l^2\\sigma_\\varpi^2}{\\varpi^4}\\Bigr)  K^2\\frac{\\mu_l\\mu_b\\,\\sigma_\\varpi^2}{\\varpi^4}\\\\\nK^2\\frac{\\mu_l\\mu_b\\,\\sigma_\\varpi^2}{\\varpi^4}  K^2\\Bigl(\\frac{\\sigma_{\\mu_b}^2}{\\varpi^2}+\\frac{\\mu_b^2\\sigma_\\varpi^2}{\\varpi^4}\\Bigr)\n\\end{pmatrix}}$$", "id": "274431"}, {"introduction": "在我们对随机误差的理解之上，本练习揭示了一个更微妙的挑战：系统性偏差[@problem_id:274126]。我们将研究一个情景，其中完全无偏的随机视差测量误差，如何导致对一个星族动能的系统性高估。这个实践表明了为什么我们必须对天文学中常见的非线性变换保持警惕。", "problem": "在天体物理测量中，恒星的切向速度 $v_t$ 是通过其观测到的周年自行 $\\mu$ 和三角视差 $\\varpi$ 由关系式 $v_t = K \\frac{\\mu}{\\varpi}$ 确定的，其中 $K$ 是一个已知的数值常数，用于处理单位转换。\n\n考虑一个大的恒星群体，它们都与太阳处于相同的真实距离，因此具有相同的真实视差，记为 $\\varpi_t$。此外，假设该群体中所有恒星都具有相同的真实切向速度 $v_{t,t}$。一位天文学家测量该群体中每颗恒星的视差。测量过程会受到随机误差的影响，因此对于任何给定的恒星，其测量视差 $\\varpi_m$ 是一个随机变量，服从均值为真实视差 $\\varpi_t$、标准差为 $\\sigma_\\varpi$ 的高斯（正态）分布。假设自行 $\\mu$ 的测量不确定度可以忽略不计。\n\n由于 $v_t$ 和 $\\varpi$ 之间的非线性关系，测量的切向速度平方的期望值 $\\langle v_{t,m}^2 \\rangle$ 将不等于真实的切向速度平方 $v_{t,t}^2$。这种差异是一种统计偏差。\n\n对于高精度测量，定义为 $f = \\sigma_\\varpi / \\varpi_t$ 的视差分数不确定度远小于一（$f \\ll 1$）。在此极限下，测量的速度平方期望值与真实的速度平方之比可以用关于 $f$ 的幂级数来近似。到首个非平凡阶，该关系式具有以下形式：\n$$\n\\frac{\\langle v_{t,m}^2 \\rangle}{v_{t,t}^2} = 1 + C f^2 + \\mathcal{O}(f^4)\n$$\n你的任务是推导无量纲常数系数 $C$ 的值。", "solution": "1. 测量的切向速度和真实的切向速度满足\n$$\nv_{t,m} \\;=\\; K\\,\\frac{\\mu}{\\varpi_m}, \n\\quad\nv_{t,t} \\;=\\; K\\,\\frac{\\mu}{\\varpi_t},\n$$\n因此\n$$\n\\frac{\\langle v_{t,m}^2\\rangle}{v_{t,t}^2}\n=\\left\\langle\\left(\\frac{\\varpi_t}{\\varpi_m}\\right)^2\\right\\rangle.\n$$\n\n2. 设 $\\varpi_m$ 是一个高斯随机变量 $X\\sim\\mathcal{N}(\\varpi_t,\\sigma_\\varpi)$，并定义无量纲量\n$$\nY = \\frac{X}{\\varpi_t}\\sim\\mathcal{N}(1,f), \n\\quad f = \\frac{\\sigma_\\varpi}{\\varpi_t}.\n$$\n那么\n$$\n\\frac{\\langle v_{t,m}^2\\rangle}{v_{t,t}^2}\n= \\big\\langle Y^{-2}\\big\\rangle.\n$$\n\n3. 写作 $Y=1+\\delta$，其中 $\\delta\\sim\\mathcal{N}(0,f)$，并展开\n$$\n\\frac{1}{Y^2} = (1+\\delta)^{-2}\n= \\sum_{k=0}^\\infty \\binom{-2}{k}\\,\\delta^k\n=1 -2\\delta +3\\delta^2 -4\\delta^3 +5\\delta^4+\\cdots.\n$$\n\n4. 取期望值，并使用 $E[\\delta]=0$，$E[\\delta^2]=f^2$，$E[\\delta^3]=0$，$E[\\delta^4]=3f^4$，\n$$\n\\big\\langle Y^{-2}\\big\\rangle = 1 +3f^2 + \\mathcal{O}(f^4).\n$$\n\n5. 因此\n$$\n\\frac{\\langle v_{t,m}^2\\rangle}{v_{t,t}^2} = 1 + 3f^2 + \\mathcal{O}(f^4),\n$$\n系数为 $C=3$。", "answer": "$$\\boxed{3}$$", "id": "274126"}, {"introduction": "最后的这个实践将我们的运动学知识应用到一个前沿研究问题上：解构恒星族群[@problem_id:274260]。你将构建一个概率模型，用以在广阔的银河系背景恒星中识别出隐藏的、运动一致的星流。这个练习将教你如何构建一个高斯混合模型，该模型明确地包含了每颗恒星的测量不确定性，这是现代银河考古学核心的强大技术。", "problem": "一次天文巡天收集了银河系中一个被认为包含星流的区域内 $N$ 颗恒星的大样本运动学数据。这些星流是具有共同起源、因而具有相似运动学特征的恒星相干结构，它们在银河系普遍的“场”星族中穿行。每颗恒星 $i$ 的观测三维速度矢量 $\\vec{v}_i$（由其自行、视向速度和视差推导得出）都存在测量不确定度，其特征由一个 $3 \\times 3$ 的协方差矩阵 $\\mathbf{C}_i$ 描述。\n\n为了区分星流和场星族，我们将整个样本的速度分布建模为一个高斯混合模型 (GMM)。该模型包含两个成分：“星流”成分和“场星”成分。\n\n模型假设如下：\n1.  样本中比例为 $f_s$ 的恒星属于星流，其余比例为 $(1-f_s)$ 的恒星属于场星族。\n2.  星流恒星的真实三维速度服从一个均值向量为 $\\vec{\\mu}_s$、内禀协方差矩阵为 $\\mathbf{\\Sigma}_s$ 的多元高斯分布。\n3.  场星的真实三维速度服从另一个独立的多元高斯分布，其均值向量为 $\\vec{\\mu}_f$，内禀协方差矩阵为 $\\mathbf{\\Sigma}_f$。\n4.  观测过程为每颗恒星引入了测量误差。恒星的观测速度 $\\vec{v}_i$ 是其真实速度 $\\vec{u}_i$ 与测量误差向量 $\\vec{\\epsilon}_i$ 的和。假设误差服从一个零均值的多元高斯分布，$P(\\vec{\\epsilon}_i) = \\mathcal{N}(\\vec{\\epsilon}_i|\\vec{0}, \\mathbf{C}_i)$，其中 $\\mathbf{C}_i$ 是恒星 $i$ 的已知测量误差协方差矩阵。\n\n模型的全套参数为 $\\theta = \\{f_s, \\vec{\\mu}_s, \\mathbf{\\Sigma}_s, \\vec{\\mu}_f, \\mathbf{\\Sigma}_f\\}$。可用的数据是观测速度及其误差协方差的集合，$\\{\\vec{v}_i, \\mathbf{C}_i\\}_{i=1}^N$。\n\n请推导在给定观测数据下，模型参数的总对数似然函数 $\\ln L(\\theta)$。最终表达式必须是单个闭式解析表达式，并用模型参数和数据表示。", "solution": "1. 观测速度 $\\vec v_i$ 的边缘似然是两个高斯分布的混合：\n$$\nP(\\vec v_i\\mid\\theta)\n= f_s\\,\\mathcal N(\\vec v_i\\mid\\vec\\mu_s,\\Sigma_s+C_i)\n+(1-f_s)\\,\\mathcal N(\\vec v_i\\mid\\vec\\mu_f,\\Sigma_f+C_i),\n$$\n其中\n$$\n\\mathcal N(\\vec v\\mid\\vec\\mu,\\Sigma)\n=\\frac{1}{\\sqrt{(2\\pi)^3\\det\\Sigma}}\n\\exp\\!\\Bigl(-\\tfrac12(\\vec v-\\vec\\mu)^\\top\\Sigma^{-1}(\\vec v-\\vec\\mu)\\Bigr).\n$$\n\n2. 总似然函数为\n$$\nL(\\theta)=\\prod_{i=1}^N P(\\vec v_i\\mid\\theta).\n$$\n\n3. 取对数得到对数似然函数，\n$$\n\\ln L(\\theta)\n=\\sum_{i=1}^N\\ln\\Biggl[\nf_s\\,\\frac{\\exp\\!\\bigl(-\\tfrac12(\\vec v_i-\\vec\\mu_s)^\\top(\\Sigma_s+C_i)^{-1}(\\vec v_i-\\vec\\mu_s)\\bigr)}\n{\\sqrt{(2\\pi)^3\\det(\\Sigma_s+C_i)}} \n+(1-f_s)\\,\\frac{\\exp\\!\\bigl(-\\tfrac12(\\vec v_i-\\vec\\mu_f)^\\top(\\Sigma_f+C_i)^{-1}(\\vec v_i-\\vec\\mu_f)\\bigr)}\n{\\sqrt{(2\\pi)^3\\det(\\Sigma_f+C_i)}}\\Biggr].\n$$", "answer": "$$\\boxed{\\ln L(\\theta)=\\sum_{i=1}^N\\ln\\Biggl[f_s\\frac{1}{\\sqrt{(2\\pi)^3\\det(\\Sigma_s+C_i)}}\\exp\\Bigl(-\\tfrac12(\\vec v_i-\\vec\\mu_s)^\\top(\\Sigma_s+C_i)^{-1}(\\vec v_i-\\vec\\mu_s)\\Bigr)+(1-f_s)\\frac{1}{\\sqrt{(2\\pi)^3\\det(\\Sigma_f+C_i)}}\\exp\\Bigl(-\\tfrac12(\\vec v_i-\\vec\\mu_f)^\\top(\\Sigma_f+C_i)^{-1}(\\vec v_i-\\vec\\mu_f)\\Bigr)\\Biggr]}$$", "id": "274260"}]}