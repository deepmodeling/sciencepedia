{"hands_on_practices": [{"introduction": "恒星视差的测量不仅仅是简单的几何学问题，更是一个统计估计问题。在实践中，我们需要将一个模型拟合到一系列随时间收集的、包含噪声的测量数据上。第一个练习将引导你完成一项基础分析，以理解视差测量的精度 $\\sigma_\\pi$ 如何依赖于关键的观测参数。通过这个过程，你将深入了解设计天体测量巡天项目时的基本权衡，并看到重复观测如何系统性地降低我们的不确定性。[@problem_id:273091]", "problem": "一位天文学家正在分析一颗邻近恒星的运动。为简便起见，该恒星的视运动被投影到天球上的一个一维坐标轴上。该恒星在此坐标轴上的位置 $x$ 作为时间 $t$ 的函数，由以下天体测量方程建模：\n$$x(t) = a_0 + \\mu t + \\pi \\sin(\\omega t)$$\n在此， $a_0$ 是恒星在 $t=0$ 时的参考位置，$\\mu$ 是其自行，$\\pi$ 是其周年视差。地球绕太阳公转的角频率 $\\omega$ 是一个已知常数。\n\n这位天文学家收集了固定数量 $N$ 的恒星位置测量数据。这些测量是在总观测时间基线 $T$ 内，以均匀采样的时间 $t_k$进行的。时间区间以 $t=0$ 为中心，因此测量数据分布在 $t \\in [-T/2, T/2]$ 上。每次测量 $x_k$ 都受到独立同分布的高斯噪声影响，该噪声具有已知的恒定标准差 $\\sigma_x$。\n\n使用线性最小二乘法分析，推导视差测定值的不确定度（标准差）$\\sigma_\\pi$ 的表达式。您的推导应假设观测基线很长，即 $T \\gg 1/\\omega$，并且测量次数 $N$ 足够大，可以用积分来近似求和。请用 $\\sigma_x$ 和 $N$ 表示您的最终答案。", "solution": "问题要求解通过对模型 $x(t) = a_0 + \\mu t + \\pi \\sin(\\omega t)$ 进行线性最小二乘拟合得到的视差参数 $\\pi$ 的不确定度。\n\n该模型对于参数 $\\mathbf{p} = (a_0, \\mu, \\pi)^T$ 是线性的。其一般形式为 $x(t) = \\sum_{j=1}^3 p_j f_j(t)$，基函数为 $f_1(t)=1$, $f_2(t)=t$ 和 $f_3(t)=\\sin(\\omega t)$。\n\n对于在时间 $t_k$ 处具有均匀不确定度 $\\sigma_x$ 的一组 $N$ 个测量值 $x_k$，最佳拟合参数 $\\hat{\\mathbf{p}}$ 的协方差矩阵由下式给出：\n$$C = \\sigma_x^2 (A^T A)^{-1}$$\n其中 $A$ 是设计矩阵，其元素为 $A_{kj} = f_j(t_k)$。参数 $p_j$ 的不确定度为 $\\sigma_{p_j} = \\sqrt{C_{jj}}$。我们关心的是 $\\sigma_\\pi = \\sqrt{C_{33}}$。\n\n令 $M = A^T A$。其元素为 $M_{ij} = \\sum_{k=1}^N f_i(t_k) f_j(t_k)$。\n由于 $N$ 很大且测量值在 $[-T/2, T/2]$ 上均匀采样，我们可以用积分来近似求和：\n$$\\sum_{k=1}^N g(t_k) \\approx \\frac{N}{T} \\int_{-T/2}^{T/2} g(t) dt$$\n\n让我们计算对称矩阵 $M$ 的元素：\n$M_{11} = \\sum_k 1 = N$。\n$M_{12} = \\sum_k t_k \\approx \\frac{N}{T} \\int_{-T/2}^{T/2} t \\,dt = \\frac{N}{T} \\left[\\frac{t^2}{2}\\right]_{-T/2}^{T/2} = 0$。\n$M_{13} = \\sum_k \\sin(\\omega t_k) \\approx \\frac{N}{T} \\int_{-T/2}^{T/2} \\sin(\\omega t) \\,dt = \\frac{N}{T} \\left[-\\frac{\\cos(\\omega t)}{\\omega}\\right]_{-T/2}^{T/2} = 0$，因为 $\\cos$ 是偶函数。\n$M_{22} = \\sum_k t_k^2 \\approx \\frac{N}{T} \\int_{-T/2}^{T/2} t^2 \\,dt = \\frac{N}{T} \\left[\\frac{t^3}{3}\\right]_{-T/2}^{T/2} = \\frac{N T^2}{12}$。\n$M_{33} = \\sum_k \\sin^2(\\omega t_k) \\approx \\frac{N}{T} \\int_{-T/2}^{T/2} \\sin^2(\\omega t) \\,dt = \\frac{N}{T} \\int_{-T/2}^{T/2} \\frac{1-\\cos(2\\omega t)}{2} \\,dt$。\n$$M_{33} \\approx \\frac{N}{T} \\left[\\frac{t}{2} - \\frac{\\sin(2\\omega t)}{4\\omega}\\right]_{-T/2}^{T/2} = \\frac{N}{T} \\left(\\frac{T}{2} - \\frac{\\sin(\\omega T)}{2\\omega}\\right)$$\n在长基线极限下, $T \\gg 1/\\omega$，$\\sin(\\omega T)$ 项与 $T$ 相比可以忽略不计，因此 $M_{33} \\approx \\frac{N}{2}$。\n\n$M_{23} = \\sum_k t_k \\sin(\\omega t_k) \\approx \\frac{N}{T} \\int_{-T/2}^{T/2} t \\sin(\\omega t) \\,dt$。\n使用分部积分法：$\\int t \\sin(\\omega t) \\,dt = -\\frac{t\\cos(\\omega t)}{\\omega} + \\frac{\\sin(\\omega t)}{\\omega^2}$。\n$$M_{23} \\approx \\frac{N}{T} \\left[-\\frac{t\\cos(\\omega t)}{\\omega} + \\frac{\\sin(\\omega t)}{\\omega^2}\\right]_{-T/2}^{T/2} = \\frac{N}{T} \\left(-\\frac{T \\cos(\\omega T/2)}{\\omega} + \\frac{2\\sin(\\omega T/2)}{\\omega^2}\\right)$$\n对于 $T \\gg 1/\\omega$，括号内的第一项占主导地位。因此，$M_{23} \\approx -\\frac{N}{\\omega} \\cos(\\omega T/2)$。\n\n矩阵 $M$ 是块对角矩阵，因为 $M_{12}=M_{13}=0$。\n$$M \\approx \\begin{pmatrix} N  0  0 \\\\ 0  \\frac{NT^2}{12}  -\\frac{N}{\\omega}\\cos(\\omega T/2) \\\\ 0  -\\frac{N}{\\omega}\\cos(\\omega T/2)  \\frac{N}{2} \\end{pmatrix}$$\n$\\pi$ 的不确定度仅取决于耦合参数 $(\\mu, \\pi)$ 的子矩阵。我们将此子矩阵称为 $M'$。\n$$M' = \\begin{pmatrix} \\frac{NT^2}{12}  -\\frac{N}{\\omega}\\cos(\\omega T/2) \\\\ -\\frac{N}{\\omega}\\cos(\\omega T/2)  \\frac{N}{2} \\end{pmatrix}$$\n我们需要找到 $(M')^{-1}$ 的 $(2,2)$ 元素。\n$$(M')^{-1} = \\frac{1}{\\det(M')} \\begin{pmatrix} \\frac{N}{2}  \\frac{N}{\\omega}\\cos(\\omega T/2) \\\\ \\frac{N}{\\omega}\\cos(\\omega T/2)  \\frac{NT^2}{12} \\end{pmatrix}$$\n行列式为：\n$$\\det(M') = \\left(\\frac{NT^2}{12}\\right)\\left(\\frac{N}{2}\\right) - \\left(-\\frac{N}{\\omega}\\cos(\\omega T/2)\\right)^2 = \\frac{N^2 T^2}{24} - \\frac{N^2}{\\omega^2}\\cos^2(\\omega T/2)$$\n视差的不确定度 $\\sigma_\\pi^2$ 是 $\\sigma_x^2$ 乘以 $M^{-1}$ 的 $(3,3)$ 元素，也就是 $\\sigma_x^2$ 乘以 $(M')^{-1}$ 的 $(2,2)$ 元素。\n$$\\sigma_\\pi^2 = \\sigma_x^2 \\left((M')^{-1}\\right)_{22} = \\sigma_x^2 \\frac{NT^2/12}{\\det(M')} = \\sigma_x^2 \\frac{NT^2/12}{\\frac{N^2 T^2}{24} - \\frac{N^2}{\\omega^2}\\cos^2(\\omega T/2)}$$\n$$\\sigma_\\pi^2 = \\sigma_x^2 \\frac{NT^2/12}{N^2 \\left(\\frac{T^2}{24} - \\frac{\\cos^2(\\omega T/2)}{\\omega^2}\\right)} = \\frac{\\sigma_x^2}{N} \\frac{T^2/12}{\\frac{T^2}{24} - \\frac{\\cos^2(\\omega T/2)}{\\omega^2}}$$\n为了分析长基线极限 $T \\gg 1/\\omega$，我们可以从分母中提出因子 $T^2/24$：\n$$\\sigma_\\pi^2 = \\frac{\\sigma_x^2}{N} \\frac{T^2/12}{(T^2/24)\\left(1 - \\frac{24 \\cos^2(\\omega T/2)}{\\omega^2 T^2}\\right)} = \\frac{2\\sigma_x^2}{N} \\frac{1}{1 - \\frac{24 \\cos^2(\\omega T/2)}{\\omega^2 T^2}}$$\n当 $T \\to \\infty$ 时，项 $\\frac{24 \\cos^2(\\omega T/2)}{\\omega^2 T^2} \\to 0$。\n因此，在长观测基线的极限下：\n$$\\sigma_\\pi^2 = \\frac{2\\sigma_x^2}{N}$$\n不确定度是该方差的平方根：\n$$\\sigma_\\pi = \\sigma_x \\sqrt{\\frac{2}{N}}$$", "answer": "$$ \\boxed{\\sigma_x \\sqrt{\\frac{2}{N}}} $$", "id": "273091"}, {"introduction": "观测数据有时可能与直觉相悖。例如，由于噪声的影响，一次视差测量可能会得到一个负值，而真实的视差值不可能是负的。我们不应直接丢弃这类数据，而是可以运用更成熟的统计框架来提取有用信息。这个问题将展示贝叶斯推断的强大之处，即使面对负的视差测量值，我们依然可以推导出恒星距离的有意义的概率分布，这演示了如何将一个有问题的数据结果转化为一个有效的科学约束。[@problem_id:318808]", "problem": "贝叶斯推断为估算恒星距离提供了一个强大的框架，尤其是在处理低信噪比的视差测量值时，包括形式上非物理的负测量值。负视差虽然对于真实视差（对于距离 $r>0$ 定义为 $\\varpi = 1/r$）来说是不可能的，但它可能因测量噪声而出现，并且仍然包含有关恒星距离的宝贵信息。\n\n考虑一颗真实距离 $r$ 未知的恒星。对于这个尺度参数，我们采用一个无信息的杰弗里斯先验，并将其截断在一个物理上合理的范围 $[r_{min}, r_{max}]$ 内。因此，距离的先验概率密度函数由下式给出：\n$$\n\\pi(r) \\propto \\frac{1}{r} \\quad \\text{for} \\quad r \\in [r_{min}, r_{max}]\n$$\n一次天文观测得到一个负的三角视差测量值 $\\varpi_m  0$。已知测量误差服从高斯分布，标准差为 $\\sigma_\\varpi$。因此，在给定真实距离 $r$ 的情况下，观测到 $\\varpi_m$ 的似然函数正比于：\n$$\nL(\\varpi_m|r) \\propto \\exp \\left( - \\frac{(\\varpi_m - 1/r)^2}{2\\sigma_\\varpi^2} \\right)\n$$\n假设参数 $\\varpi_m$、$\\sigma_\\varpi$、$r_{min}$ 和 $r_{max}$ 使得距离 $r$ 的后验概率分布的众数位于区间 $(r_{min}, r_{max})$ 的内部，请推导该众数（记为 $r_{mode}$）的闭式解析表达式。", "solution": "1. 后验概率（未归一化）：\n$$\np(r|\\varpi_m)\\;\\propto\\;\\pi(r)L(\\varpi_m|r)\n\\;=\\;\\frac{1}{r}\\exp\\!\\Bigl(-\\frac{(\\varpi_m-1/r)^2}{2\\sigma_\\varpi^2}\\Bigr).\n$$\n2. 对数后验概率：\n$$\n\\ln p = -\\ln r \\;-\\;\\frac{(\\varpi_m-1/r)^2}{2\\sigma_\\varpi^2} + \\text{const}.\n$$\n3. 对 $r$ 求导并令其为零：\n$$\n\\frac{d\\ln p}{dr}\n=-\\frac{1}{r}\n-\\frac{1}{\\sigma_\\varpi^2}(\\varpi_m-\\tfrac{1}{r})\\frac{d}{dr}(\\varpi_m-\\tfrac{1}{r})\n=-\\frac{1}{r}-\\frac{\\varpi_m-1/r}{\\sigma_\\varpi^2\\,r^2}=0.\n$$\n4. 两边同乘以 $-\\sigma_\\varpi^2r^2$：\n$$\n\\sigma_\\varpi^2\\,r + \\varpi_m - \\frac{1}{r} = 0\n\\;\\;\\Longrightarrow\\;\\;\n\\sigma_\\varpi^2\\,r^2 + \\varpi_m\\,r - 1 = 0.\n$$\n5. 求解二次方程 $\\sigma_\\varpi^2r^2 + \\varpi_m r -1=0$ 的正根：\n$$\nr_{\\rm mode}\n=\\frac{-\\varpi_m + \\sqrt{\\varpi_m^2 +4\\sigma_\\varpi^2}}{2\\,\\sigma_\\varpi^2}.\n$$", "answer": "$$\\boxed{\\frac{-\\varpi_m + \\sqrt{\\varpi_m^2 + 4\\sigma_\\varpi^2}}{2\\,\\sigma_\\varpi^2}}$$", "id": "318808"}, {"introduction": "对数据的成功拟合并不保证我们底层的物理模型是正确的。我们常常需要在一个更简单的模型和一个可能更好地捕捉恒星运动真实情况（例如，由不可见的伴星引起的加速运动）的更复杂的模型之间做出选择。这个练习将探讨使用贝叶斯信息准则（BIC）来完成模型选择这一关键任务。你将推导出，为了证明一个复杂模型额外参数的合理性，它需要比简单模型好多少，从而为奥卡姆剃刀原理提供一个定量的应用。[@problem_id:272915]", "problem": "在高精度天体测量学中，对恒星在天球上的运动进行建模，以确定其视差和自行。对于某些恒星，简单的线性运动模型不足以描述其运动，而一个加速运动模型（可能表明存在一个未被观测到的伴星）能更好地拟合观测数据。\n\n考虑用两种分层模型来拟合包含 $N$ 个天体测量数据的数据集，以描述一颗恒星的轨迹。\n*   **模型 $M_1$**：一个标准的5参数天体测量模型，代表线性的自行和视差。其自由参数数量为 $k_1 = 5$。\n*   **模型 $M_2$**：一个扩展的7参数模型，包含了赤经和赤纬方向的两个额外长期加速度项。其自由参数数量为 $k_2 = 7$。\n\n两个模型都通过最小化卡方统计量来拟合数据。设模型 $M_1$ 和 $M_2$ 得到的最小卡方值分别为 $\\chi^2_1$ 和 $\\chi^2_2$。由于 $M_2$ 是一个更复杂的模型，且包含 $M_1$ 作为其特例，因此可以保证 $\\chi^2_2 \\le \\chi^2_1$。拟合的改善程度由 $\\Delta \\chi^2 = \\chi^2_1 - \\chi^2_2$ 量化。\n\n为了判断模型 $M_2$ 增加的复杂性是否因其拟合改善而显得合理，我们采用贝叶斯信息准则 (BIC)。BIC 的定义为 $BIC = \\chi^2_{min} + k \\ln(N)$，其中 $k$ 是模型中的参数数量。BIC 值较低的模型更优。如果 BIC 的差值 $\\Delta BIC = BIC_2 - BIC_1$ 小于或等于一个负阈值 $-\\mathcal{E}$（其中 $\\mathcal{E}$ 是一个正常数），我们就认为支持更复杂模型 $M_2$ 的证据是“非常强”的。\n\n请推导要构成支持7参数模型 $M_2$ 优于5参数模型 $M_1$ 的“非常强证据”所需的卡方拟合最小改善量 $\\Delta \\chi^2_{min}$，并将其表示为观测次数 $N$ 和证据阈值 $\\mathcal{E}$ 的函数。", "solution": "对于每个模型，我们有\n$$BIC = \\chi^2_{\\min} + k\\ln N.$$\n因此对于 $M_1$ ($k_1=5$) 和 $M_2$ ($k_2=7$)：\n$$BIC_1 = \\chi^2_1 + 5\\ln N,\\quad BIC_2 = \\chi^2_2 + 7\\ln N.$$\n\n定义拟合改善量\n$$\\Delta\\chi^2 = \\chi^2_1 - \\chi^2_2\\ge0$$\n和 BIC 差值\n$$\\Delta BIC = BIC_2 - BIC_1.$$\n计算\n$$\\Delta BIC = (\\chi^2_2 + 7\\ln N) - (\\chi^2_1 + 5\\ln N)\n= -\\,\\Delta\\chi^2 + 2\\ln N.$$\n\n当满足以下条件时，我们认为存在支持 $M_2$ 的“非常强”证据：\n$$\\Delta BIC \\le -\\mathcal E.$$\n代入可得\n$$-\\,\\Delta\\chi^2 + 2\\ln N \\le -\\mathcal E\n\\quad\\Longrightarrow\\quad\n\\Delta\\chi^2 \\ge \\mathcal E + 2\\ln N.$$\n因此，所需的最小改善量为\n$$\\Delta\\chi^2_{\\min} = \\mathcal E + 2\\ln N.$$", "answer": "$$\\boxed{\\mathcal{E} + 2\\ln N}$$", "id": "272915"}]}