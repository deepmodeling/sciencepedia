{"hands_on_practices": [{"introduction": "数值相对论的核心在于求解双曲偏微分方程形式的爱因斯坦方程组，任何成功的数值模拟都始于一个稳定可靠的算法。本练习将引导你分析一个简化的BSSN“玩具模型”的数值稳定性，这是现代数值相对论代码中常用的方法。通过进行冯·诺依曼稳定性分析，你将亲手推导 Courant-Friedrichs-Lewy (CFL) 条件，这是确保数值解在演化过程中不发散的基本要求[@problem_id:910011]。", "problem": "在数值相对论领域，BSSN (Baumgarte-Shapiro-Shibata-Nakamura) 格式是演化爱因斯坦方程的一种稳健方法。实现这种格式的一个关键方面是确保所选离散化方案的数值稳定性。稳定性分析通常在简化的“玩具模型”上进行，这些模型捕捉了完整系统的基本数学结构。\n\n考虑以下一维线性化玩具模型，它模仿了 BSSN 系统的某些特征，例如引入辅助变量和平流项。该系统描述了三个场 $u(t,x)$、$v(t,x)$ 和 $q(t,x)$ 的演化：\n$$\n\\begin{aligned}\n\\partial_t u = -b \\, \\partial_x u + v \\\\\n\\partial_t v = -b \\, \\partial_x v + c^2 \\, \\partial_x q \\\\\n\\partial_t q = -b \\, \\partial_x q + \\partial_x v\n\\end{aligned}\n$$\n此处，$c$ 是一个正常数特征速度 ($c0$)，$b$ 是一个常数平流速度，类似于广义相对论中移动矢量的一个分量。\n\n该系统将在空间上具有均匀间距 $\\Delta x$ 和时间上具有均匀间距 $\\Delta t$ 的网格上进行数值求解。所采用的数值方案是一种二阶精度方法，它将用于时间演化的蛙跳格式与用于空间导数的中心有限差分近似相结合。具体来说，对于一个通用场矢量 $\\mathbf{U} = (u,v,q)^T$，该方案为：\n$$\n\\frac{\\mathbf{U}^{n+1}_j - \\mathbf{U}^{n-1}_j}{2\\Delta t} = (\\text{RHS})^n_j\n$$\n其中，下标 $j$ 和上标 $n$ 分别表示空间和时间网格点，$x_j=j\\Delta x$ 和 $t_n=n\\Delta t$。偏微分方程系统的右侧 (RHS) 在时间步 $n$ 进行计算，所有空间导数 $\\partial_x$ 均由二阶中心差分算子近似：\n$$\n\\partial_x f(t_n, x_j) \\approx \\frac{f^n_{j+1} - f^n_{j-1}}{2\\Delta x}\n$$\n\n您的任务是对该数值方案进行 von Neumann 稳定性分析。确定 Courant-Friedrichs-Lewy (CFL) 稳定性条件。基于此，为使该方案对所有可能的波模都保持稳定，库朗数 $\\lambda_C = \\Delta t / \\Delta x$ 的最大允许值是多少？", "solution": "1. 傅里叶符号 $\\xi=\\sin(k\\Delta x)/\\Delta x$，因此 RHS 矩阵 $L$ 的特征值为 $\\lambda_1 = -i b \\xi$ 和 $\\lambda_{2,3} = -i b \\xi \\pm i c \\xi = -i(b \\mp c)\\xi$。\n2. 蛙跳法推进 $\\mathbf{U}^{n+1} = \\mathbf{U}^{n-1} + 2\\Delta t L \\mathbf{U}^n$ 给出特征方程 $\\zeta^2 - 2\\Delta t \\lambda \\zeta - 1 = 0$，其解为 $\\zeta = \\Delta t \\lambda \\pm \\sqrt{1 + (\\Delta t \\lambda)^2}$。\n3. 对于纯虚特征值 $\\lambda = i\\omega$，$\\sqrt{1 + (\\Delta t \\lambda)^2} = \\sqrt{1 - (\\Delta t \\omega)^2}$ 必须为实数，这意味着 $|\\Delta t \\omega| \\le 1$。\n4. 在此问题中，$|\\omega|$ 的最大值为 $(|b|+c)/\\Delta x$。因此，稳定性条件为 $\\Delta t (|b|+c)/\\Delta x \\le 1$，即 $\\lambda_C = \\Delta t/\\Delta x \\le 1/(c+|b|)$。", "answer": "$$\\boxed{\\frac{1}{c+|b|}}$$", "id": "910011"}, {"introduction": "在保证了基本的数值稳定性之后，下一步是提高计算的精度，这对于精确预测引力波等现象至关重要。高阶差分格式是实现高精度的常用手段，但它们会引入非物理的数值色散和高频不稳定性。本练习探讨了一种关键的实用技术——人工耗散，用于抑制这些数值噪声，通过实际计算来校准耗散参数，你将深入理解在追求高精度的同时，如何维持解的物理真实性[@problem_id:910026]。", "problem": "在数值相对论领域，常采用高阶有限差分格式来求解描述引力场演化的双曲型偏微分方程组。为抑制高频数值不稳定性，通常会在离散化方程中加入人工耗散项。本问题关注物理波传播的数值色散与此类人工耗散的阻尼效应之间的相互作用。\n\n考虑标量场 $u(t, x)$ 的一维平流方程：\n$$\n\\partial_t u + c \\, \\partial_x u = 0\n$$\n其中 $c  0$ 是恒定的平流速度。我们使用方法线法，即对空间进行离散化，而时间保持连续。设空间格点为 $x_j = j \\Delta x$，其中 $j$ 为整数。方程在格点 $j$ 处的半离散形式由下式给出：\n$$\n\\frac{d u_j}{dt} = -c (D_x u)_j + (Q u)_j\n$$\n空间导数 $\\partial_x$ 由一个四阶精度的中心有限差分算子 $D_x$ 近似，该算子使用五点模板：\n$$\n(D_x u)_j = \\frac{1}{12\\Delta x}(-u_{j+2} + 8u_{j+1} - 8u_{j-1} + u_{j-2})\n$$\n项 $(Q u)_j$ 代表一个六阶 Kreiss-Oliger 人工耗散，定义为：\n$$\n(Q u)_j = \\frac{\\epsilon_d c}{\\Delta x} (D_+ D_-)^3 u_j\n$$\n其中 $\\epsilon_d$ 是一个无量纲耗散参数，$D_+$ 和 $D_-$ 是标准的一阶向前和向后差分算子，$D_+ u_j = u_{j+1} - u_j$ 和 $D_- u_j = u_j - u_{j-1}$。因此，算子 $(D_+ D_-)^3$ 是作为一个十三点模板来应用的。\n\n四阶平流算子会引入数值色散，导致不同的傅里叶模式以不同的群速度传播。另一方面，耗散算子以不同的速率对傅里叶模式进行阻尼。\n\n您的任务是求出耗散参数 $\\epsilon_d$ 的一个特定值，使得网格波数为 $\\theta = k \\Delta x = \\pi/2$ 的傅里叶模式的 e-折阻尼时间，等于一个波包以数值平流格式所允许的群速度最大可能量值移动一个网格间距 $\\Delta x$ 所需的时间。", "solution": "1. 四阶中心导数的修正波数为：\n$$\na(\\theta) = \\frac{-e^{2i\\theta}+8e^{i\\theta}-8e^{-i\\theta}+e^{-2i\\theta}}{12\\Delta x} = \\frac{i\\bigl(8\\sin\\theta-\\sin2\\theta\\bigr)}{6\\Delta x}\n$$\n\n2. 色散关系为 $\\omega(\\theta) = - \\frac{c}{\\Delta x}A(\\theta)$，其中 $A(\\theta) = \\frac{8\\sin\\theta-\\sin2\\theta}{6}$。\n\n3. 群速度为\n$$\nv_g = \\frac{d\\omega}{dk} = -c\\,\\frac{dA}{d\\theta} = -c\\,\\frac{4\\cos\\theta-\\cos2\\theta}{3}\n$$\n令 $x=\\cos\\theta \\in [-1,1]$；则 $4\\cos\\theta-\\cos2\\theta=-2x^2+4x+1$。该函数在 $[-1,1]$ 上的最大绝对值为 $5$（在 $x=-1$ 处取值 $-5$）。因此，最大群速度为 $v_{\\max} = \\frac{5c}{3}$。\n\n4. 跨越一个网格间距的平流时间为：\n$$\nt_{\\rm adv} = \\frac{\\Delta x}{v_{\\max}} = \\frac{3\\Delta x}{5c}\n$$\n\n5. 耗散算子的符号为 $(Q u)_j = -\\frac{8\\epsilon_d c}{\\Delta x}(1-\\cos\\theta)^3 u_j$。因此阻尼率为\n$$\n\\gamma(\\theta) = \\frac{8\\epsilon_d c}{\\Delta x}(1-\\cos\\theta)^3, \\quad \\tau(\\theta) = \\frac{1}{\\gamma} = \\frac{\\Delta x}{8\\epsilon_d c(1-\\cos\\theta)^3}\n$$\n在 $\\theta=\\pi/2$ 处，$1-\\cos\\theta=1$，所以 $\\tau = \\Delta x/(8\\epsilon_d c)$。\n\n6. 令阻尼时间等于平流时间：\n$$\n\\frac{\\Delta x}{8\\epsilon_d c} = \\frac{3\\Delta x}{5c} \\quad \\Longrightarrow \\quad \\epsilon_d = \\frac{5}{24}\n$$", "answer": "$$\\boxed{\\frac{5}{24}}$$", "id": "910026"}, {"introduction": "一个完整的数值相对论模拟不仅包括时间演化，还需要一个满足爱因斯坦约束方程的有效初始构型。本练习将带你进入“初始值问题”的求解领域，这是一个涉及椭圆型方程组的挑战。你将使用谱方法，这是一种求解约束方程的高精度技术，通过为一个单黑洞时空构建求解器矩阵的一个元素，你将体验到处理渐近平坦时空和求解复杂物理方程的数值策略[@problem_id:910030]。", "problem": "在构建双黑洞并合的初始数据时，必须在一个三维空间切片上求解爱因斯坦约束方程。Lichnerowicz-York (LY) 方法为求解这些方程提供了一种强有力的方式。对于一个具有共形平坦、极大切片（$K=0$）初始切片的真空时空，哈密顿约束简化为一个关于共形因子 $\\psi$ 的非线性椭圆方程。该共形因子通过 $g_{ij} = \\psi^4 \\delta_{ij}$ 将物理度规 $g_{ij}$ 与平直共形度规 $\\delta_{ij}$ 联系起来。\n\n对于一个具有线性动量 $P^i$ 的单黑洞（一个 Bowen-York 黑洞），LY 方程由下式给出：\n$$ \\nabla^2 \\psi + \\frac{1}{8} \\left(\\hat{A}_{ij}\\hat{A}^{ij}\\right) \\psi^{-7} = 0 $$\n其中 $\\nabla^2$ 是平直空间拉普拉斯算子，$\\hat{A}_{ij}$ 是共形相关的外曲率。对于沿 z 轴方向、大小为 $P$ 的 boost，源项为 $\\hat{A}_{ij}\\hat{A}^{ij} = \\frac{9P^2}{2r^4}(1+\\cos^2\\theta)$，其中 $r$ 是各向同性径向坐标，$\\theta$ 是极角。\n\n为了数值求解该方程，我们通常通过设 $\\psi = \\psi_0 + \\delta\\psi$ 将其在近似解 $\\psi_0$ 周围线性化。这就得到了一个关于修正量 $\\delta\\psi$ 的线性椭圆方程：\n$$ L[\\delta\\psi] \\equiv \\nabla^2(\\delta\\psi) - \\frac{7}{8}\\left(\\hat{A}_{ij}\\hat{A}^{ij}\\right)\\psi_0^{-8}\\delta\\psi = -\\left( \\nabla^2 \\psi_0 + \\frac{1}{8} \\hat{A}_{ij}\\hat{A}^{ij} \\psi_0^{-7}\\right) $$\n为简单起见，我们在大半径处用 $\\psi_0=1$ 来近似背景解。该问题通常通过将 $\\delta\\psi$ 展开为球谐函数 $\\delta\\psi(r, \\theta) = \\sum_l \\phi_l(r) Y_{l0}(\\theta)$（假设轴对称）来求解。算子 $L$ 随后在球谐函数基中成为一个矩阵算子。\n\n考虑该算子的对角部分 $L_0$，它作用于球对称（$l=0$）的径向函数 $\\phi_0(r)$。该算子是通过对势项进行球面平均得到的：\n$$ L_0[\\phi_0(r)] = \\left(\\frac{d^2}{dr^2} + \\frac{2}{r}\\frac{d}{dr}\\right)\\phi_0(r) - V_0(r)\\phi_0(r) $$\n其中 $V_0(r)$ 是 $\\frac{7}{8}(\\hat{A}_{ij}\\hat{A}^{ij})\\psi_0^{-8}|_{\\psi_0=1}$ 的球面平均。\n\n该问题被设定在半径为 $A$ 的球外部区域，即 $r \\in [A, \\infty)$。我们使用坐标变换 $r(x) = \\frac{2A}{1+x}$ 将该区域紧致化，此变换将 $r \\in [A, \\infty)$ 映射到计算域 $x \\in [1, -1]$。径向函数 $\\phi_0(x)$ 随后被近似为一个切比雪夫多项式的截断和，$\\phi_0(x) \\approx \\sum_{k=0}^N c_k T_k(x)$。该方程在一组配置点上被强制满足，对于一个 N 阶的基，这些点是 Chebyshev-Gauss-Lobatto 点 $x_j = \\cos(j\\pi/N)$，$j=0, \\dots, N$。\n\n这个过程将微分方程转换为一个矩阵方程 $M \\cdot \\vec{c} = \\vec{s}$，其中算子的矩阵元由 $M_{jk} = L_0[T_k(x)]|_{x=x_j}$ 给出。\n\n**你的任务是计算对于一个 N=3 阶的基的矩阵元 $M_{23}$。**", "solution": "1. 定义 $T_3(x)=4x^3-3x$，所以 $T_3'(x)=12x^2-3$,  $T_3''(x)=24x$。\n\n2. 坐标映射：$r(x)=2A/(1+x) \\implies x=(2A/r)-1$, $dx/dr=-2A/r^2$。\n\n3. 对于 $\\phi(r)=T_3(x(r))$:\n   $d\\phi/dr = T_3'(x) \\cdot dx/dr = -(2A/r^2)T_3'(x)$,\n   $d^2\\phi/dr^2 = \\frac{d}{dr}[-2A/r^2 T_3'] = T_3''(x)(dx/dr)(-2A/r^2) + T_3'(x)(4A/r^3) = (4A^2/r^4)T_3''(x)+(4A/r^3)T_3'(x)$。\n\n4. $L_0[\\phi] = d^2\\phi/dr^2 + (2/r)d\\phi/dr - V_0\\phi = (4A^2/r^4)T_3''(x) - V_0(r)T_3(x)$。\n\n5. 势的球面平均为：$V_0(r) = \\frac{21P^2}{4r^4}$。\n\n6. 在 $x_2 = \\cos(2\\pi/3) = -1/2$ 处计算：$T_3''(x_2) = 24(-1/2) = -12$, $T_3(x_2)=1$, $r(-1/2) = 2A/(1-1/2)=4A$。\n\n7. 代入：\n   $M_{23} = (4A^2/(4A)^4)(-12) - (21P^2/(4(4A)^4))(1) = -48A^2/(256A^4) - 21P^2/(1024A^4) = -3/(16A^2) - 21P^2/(1024A^4)$。", "answer": "$$\\boxed{-\\frac{3}{16A^2} - \\frac{21P^2}{1024A^4}}$$", "id": "910030"}]}