{"hands_on_practices": [{"introduction": "我们首先从史瓦西黑洞（Schwarzschild black hole）附近的光子球（photon sphere）和临界冲击参数（critical impact parameter）的概念入手。当光线的冲击参数略大于临界值时，它会在逃逸到无穷远之前围绕黑洞旋转多次，从而产生一个巨大的偏转角。这项练习 [@problem_id:329472] 将引导你推导出这种对数发散（logarithmic divergence）的主导项，这是强引力透镜效应的一个关键特征。", "problem": "在广义相对论中，一个光子在质量为 $M$ 的静态球对称大质量物体附近的路径由史瓦西时空中的零测地线描述。该几何结构的特征是史瓦西半径 $r_s = 2GM/c^2$。\n\n一个从无穷远处以撞击参数 $b$ 接近该大质量物体的光子将会发生偏转。对于一个到达最小距离 $r_0$（近星点）并返回无穷远处的光子，其方位角 $\\phi$ 的总变化由以下积分给出：\n$$\n\\Delta\\phi(b) = 2 \\int_{r_0}^{\\infty} \\frac{dr}{r^2 \\sqrt{\\frac{1}{b^2} - V_{\\text{eff}}(r)}}\n$$\n其中，光子的等效势为 $V_{\\text{eff}}(r) = \\frac{1}{r^2}\\left(1-\\frac{r_s}{r}\\right)$。最近距离 $r_0$ 是方程 $1/b^2 = V_{\\text{eff}}(r_0)$ 的最大实根。\n\n存在一个临界撞击参数 $b_{crit}$，当撞击参数为此值时，光子被捕获到半径为 $r_{ph} = \\frac{3}{2}r_s$ 的光子球上的不稳定圆轨道中。对于 $b > b_{crit}$，光子发生偏转并逃逸至无穷远。对于比 $b_{crit}$ 无穷小的 $b$，光子在逃逸前会围绕大质量物体旋转很多圈，从而导致一个大的偏转角 $\\alpha(b) = \\Delta\\phi(b) - \\pi$。\n\n在 $b$ 从上方趋近于 $b_{crit}$ 的极限下，偏转角呈对数发散。这种发散可以用领头项表示为：\n$$\n\\alpha(b) \\approx -C \\ln\\left(\\frac{b}{b_{crit}} - 1\\right) + \\mathcal{O}(1)\n$$\n你的任务是推导出无量纲常数 $C$。", "solution": "1. 从关于变量 $u=1/r$ 的零测地线积分开始，\n$$\n\\Delta\\phi(b)\n=2\\int_{0}^{u_0}\\frac{du}{\\sqrt{\\frac1{b^2}-u^2+r_su^3}}\\,,\\quad \nu_0:\\;\\frac1{b^2}-u_0^2+r_su_0^3=0.\n$$\n光子球位于\n$$\nu_m=\\frac1{r_{ph}}=\\frac{2}{3r_s},\\qquad \n\\frac1{b_{crit}^2}=u_m^2-r_su_m^3=\\frac{4}{27r_s^2}.\n$$\n\n2. 定义\n$$\n\\varepsilon=\\frac1{b^2}-\\frac1{b_{crit}^2}, \n$$\n因此对于 $b\\to b_{crit}^+$，有 $\\varepsilon\\to0^-$。将被开方数在 $u_m$ 附近展开：\n$$\nQ(u)=\\frac1{b^2}-u^2+r_su^3\n=\\varepsilon+\\frac12Q''(u_m)(u-u_m)^2+\\cdots,\n\\quad Q''(u_m)=2,\n$$\n因此\n$$\nQ(u)\\approx\\varepsilon+(u-u_m)^2.\n$$\n转折点为\n$$\nu_0=u_m-\\sqrt{-\\varepsilon}.\n$$\n\n3. $\\Delta\\phi$ 的发散部分来自 $u\\approx u_m$。设\n$$\nu-u_m=-\\sqrt{-\\varepsilon}\\,y,\n$$ \n那么\n$$\ndu=-\\sqrt{-\\varepsilon}\\,dy,\\qquad\n\\sqrt{Q(u)}=\\sqrt{-\\varepsilon}\\,\\sqrt{y^2-1}.\n$$\n因此\n$$\n\\Delta\\phi_{\\rm div}\n=2\\int_{u_0}^{\\!U}\\frac{du}{\\sqrt{Q(u)}}\n=2\\int_{1}^{y_U}\\frac{-\\sqrt{-\\varepsilon}\\,dy}{\\sqrt{-\\varepsilon}\\,\\sqrt{y^2-1}}\n=2\\int_{1}^{y_U}\\frac{dy}{\\sqrt{y^2-1}}\n=2\\arccosh(y_U).\n$$\n对于大的截断 $y_U\\sim(u_m-u_U)/\\sqrt{-\\varepsilon}\\gg1$，\n$$\n2\\arccosh(y_U)=2\\ln\\bigl(y_U+\\sqrt{y_U^2-1}\\bigr)\n=-\\ln(-\\varepsilon)+\\mathcal O(1).\n$$\n\n4. 注意到 $-\\varepsilon=1/b_{crit}^2-1/b^2\\propto(b/b_{crit}-1)$，可以得到\n$$\n\\alpha(b)=\\Delta\\phi(b)-\\pi\\approx -\\ln\\!\\bigl(b/b_{crit}-1\\bigr)+\\mathcal O(1),\n$$\n所以无量纲常数为\n$$\nC=1.\n$$", "answer": "$$\\boxed{1}$$", "id": "329472"}, {"introduction": "在静态时空的基础上，我们进一步探讨黑洞的自转如何影响光的路径。克尔度规（Kerr metric）引入了参考系拖拽效应（frame-dragging），打破了球对称性，使得光子轨道依赖于其相对于黑洞自旋的方向。这项练习 [@problem_id:901733] 要求你计算在一个极端克尔黑洞（extremal Kerr black hole）周围，顺行轨道（prograde orbit）上光子的临界冲击参数，这是理解旋转黑洞阴影（black hole shadows）的关键一步。", "problem": "克尔黑洞由其质量 $M$ 和自旋参数 $a$ 描述。在 Boyer-Lindquist 坐标 $(t, r, \\theta, \\phi)$ 中，时空几何由以下度规给出：\n$$ds^2 = -\\left(1-\\frac{2Mr}{\\Sigma}\\right)dt^2 - \\frac{4Mar\\sin^2\\theta}{\\Sigma}dtd\\phi + \\frac{\\Sigma}{\\Delta}dr^2 + \\Sigma d\\theta^2 + \\left(r^2+a^2+\\frac{2Ma^2r\\sin^2\\theta}{\\Sigma}\\right)\\sin^2\\theta d\\phi^2$$\n其中 $\\Sigma = r^2+a^2\\cos^2\\theta$ 且 $\\Delta = r^2-2Mr+a^2$。\n\n考虑一个在**极端**克尔黑洞赤道面（$\\theta=\\pi/2$）运动的光子，其自旋参数达到最大值，即 $a=M$。该光子处于**顺行**轨道，意味着其轨道角动量与黑洞自旋的方向相同。\n\n光子的轨迹由其在无穷远处的守恒能量 $E$ 和守恒的轴向角动量分量 $L$ 决定。碰撞参数定义为 $b = L/E$。碰撞参数小于某个临界值 $b_c$ 的光子会被黑洞捕获，而碰撞参数大于 $b_c$ 的光子则会被散射到无穷远处。这个临界值对应于一个不稳定的圆形光子轨道的碰撞参数。\n\n您的任务是计算围绕极端克尔黑洞的顺行赤道轨道上光子的临界碰撞参数 $b_c$。请用黑洞质量 $M$ 来表示您的答案。", "solution": "1. 对于赤道面上的零测地线 ($\\eta=0$)，径向势为 (令 $\\xi=b=L/E$):\n$$R(r)=\\bigl[E(r^2+a^2)-aL\\bigr]^2-\\Delta(L-aE)^2=E^2V(r,b)\\,.$$\n$V=0$ 和 $dV/dr=0$ 给出\n$$V=(r^2+a^2-ab)^2-(r^2-2Mr+a^2)(b-a)^2=0,$$\n$$\\frac{dV}{dr}=4r(r^2+a^2-ab)-2(r-M)(b-a)^2=0.$$\n2. 定义 $k=b-a$。则 $r^2+a^2-ab =r^2-ak$。方程变为\n  a) $$(r^2-ak)^2-\\Delta\\,k^2=0\\implies r^2(r^2-k(2a+k))+2Mrk^2=0,$$\n  b) $$2r^3-2akr-(r-M)k^2=0.$$\n3. 通过(b)式在(a)式中消去 $M k^2$ 得到\n   $$k(2a+k)=3r^2,\\quad k^2=\\frac{r^3}{M}.$$\n4. 组合起来得到光子轨道的三次方程：\n$$r^3-6Mr^2+9M^2r-4a^2M=0.$$\n5. 对于极端克尔情况 $a=M$，该方程可因式分解为 $(r-M)^2(r-4M)=0$。不稳定的顺行轨道位于\n$$r_{\\rm ph}=M.$$\n6. 从 $k(2a+k)=3r^2$ 或直接从 $b^2=a^2+3r^2$，当 $r=a=M$ 时，\n$$b_c^2=M^2+3M^2=4M^2\\;\\implies\\;b_c=2M.$$", "answer": "$$\\boxed{2M}$$", "id": "901733"}, {"introduction": "虽然光子球附近的强引力透镜在理论上引人入胜，但许多天体物理观测涉及的是弱引力透镜（weak gravitational lensing），即光线远离大质量天体经过。这项练习 [@problem_id:2421994] 将解析微扰理论（analytical perturbation theory）与数值方法相结合，来计算著名的弱场偏转角。通过推导并使用努梅罗夫方法（Numerov method）求解一阶微扰方程，你将获得计算天体物理学中一种强大技术的实践经验。", "problem": "您需要使用 Schwarzschild 时空中的零类测地线二阶微分方程来为一个球对称、不旋转的大质量天体引起的弱场光线弯曲建模。该方程已简化到运动平面，并用倒数半径 $u(\\phi) = 1/r(\\phi)$ 表示，其中 $r$ 是径向坐标，$\\phi$ 是极角（以弧度为单位）。在几何单位制中进行计算，其中引力常数 $G$ 和光速 $c$ 均设为 $1$，并用未受扰动的直线轨迹的碰撞参数 $b$ 对所有长度进行缩放，使距离变为无量纲。定义无量纲参数 $\\mu = M/b$ 和 $\\bar{u}(\\phi) = b\\,u(\\phi)$，其中 $M$ 是中心天体的质量。\n\n从 Schwarzschild 度规中的零类测地线方程出发，使用标准方法将其简化为轨道方程（Binet 形式），并对小参数 $\\mu$ 进行一阶弱场微扰展开。请基于以下基本出发点进行推导：\n\n- 广义相对论 (GR) 中关于静态、球对称真空时空的 Schwarzschild 解。\n- 零类测地线条件和中心势的平面简化。\n- 倒数半径 $u(\\phi)$ 的引入以及 Schwarzschild 时空中零类测地线轨道方程的 Binet 形式。\n\n您的任务：\n\n1. 推导 $\\bar{u}(\\phi)$ 的无量纲轨道方程，并求出对应于 $\\mu = 0$ 且在 $\\phi = \\pi/2$ 处距离最近的未受扰动直线解 $\\bar{u}_0(\\phi)$。请将 $\\bar{u}_0(\\phi)$ 明确表示为 $\\phi$ 的函数，并证明您对 $\\phi$ 原点选择的合理性。\n\n2. 引入一阶微扰 $\\bar{u}(\\phi) = \\bar{u}_0(\\phi) + \\mu\\,w(\\phi)$，并仅保留到 $\\mu$ 的一阶项，推导出关于 $w(\\phi)$ 的线性非齐次二阶常微分方程 (ODE)，其形式为 $w''(\\phi) + k(\\phi)\\,w(\\phi) = s(\\phi)$，并给出在 $\\phi = \\pi/2$ 处的边界条件，该边界条件体现了最近点的对称性。请用 $\\bar{u}_0(\\phi)$ 明确表示 $k(\\phi)$ 和 $s(\\phi)$。\n\n3. 设计一个 Numerov 格式，使用在 $\\phi=\\pi/2$ 处的边界条件，在 $\\phi \\in [0,\\pi]$ 的均匀网格上求解 $w(\\phi)$ 的 ODE。您的算法必须：\n   - 在 $\\phi$ (弧度)上使用均匀步长 $h$。\n   - 实现适用于线性非齐次方程 $y''(x) + k(x)\\,y(x) = s(x)$ 的 Numerov 递推关系。\n   - 通过使用与所推导的 ODE 和边界条件一致的 Taylor 展开，初始化 $\\phi = \\pi/2$ 附近的两个起始值。\n   - 从 $\\phi=\\pi/2$ 分别向 $\\phi=0$ 和 $\\phi=\\pi$ 进行推进。\n\n4. 使用您计算出的 $w(\\phi)$，通过确定轨迹的入射和出射渐近线的偏移，估计到 $\\mu$ 的一阶的总弯曲角（大小）$\\alpha$（以弧度为单位）。请注意，渐近线对应于 $\\bar{u}(\\phi)$ 在 $\\phi=0$ 附近（入射）和 $\\phi=\\pi$ 附近（出射）的零点。在这些零点附近使用一阶局域线性化来估计角度偏移，并组合它们以获得以弧度为单位的正实数 $\\alpha$。您必须以弧度表示最终的弯曲角。\n\n5. 将上述步骤在一个完整、可运行的程序中实现，并针对以下无量纲质量与碰撞参数之比的测试集计算弯曲角：\n   - $\\mu = 0$\n   - $\\mu = 10^{-6}$\n   - $\\mu = 10^{-5}$\n   - $\\mu = 5\\times 10^{-5}$\n\n数值与输出要求：\n\n- 角度必须以弧度为单位。\n- 在 $\\phi$ 上使用足够精细的网格，以确保对于给定的测试集，Numerov 方法的六阶精度能在结果中至少体现出 6 位有效数字。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，\"[result1,result2,result3,result4]\"）。每个结果都必须是一个浮点数（以弧度为单位），按上述顺序对应于各自 $\\mu$ 的弯曲角。\n\n您的推导必须仅依赖于所述的基本出发点和标准定义，不得假定任何未由此推导出的结果。在您的书面推导中，所有符号、运算符和数字都必须用 LaTeX 表示。程序应是自包含的，不需要用户输入或外部文件。", "solution": "问题陈述已经过严格验证，被认为是具有科学依据、良定且客观的。它提出了一个源于广义相对论的计算物理学标准问题，并给出了通往唯一、有意义解的清晰路径。所有需要的数据和条件都已提供。\n\n求解过程遵循指定的任务步骤。\n\n**1. 无量纲轨道方程和未受扰动解的推导**\n\n在 Schwarzschild 时空中，一个无质量粒子（零类测地线）的轨迹的 Binet 方程，用倒数半径 $u(\\phi) = 1/r(\\phi)$ 表示，在几何单位制（$G=c=1$）下由以下公式给出：\n$$\n\\frac{d^2u}{d\\phi^2} + u = 3Mu^2\n$$\n其中 $M$ 是中心天体的质量。\n\n我们引入无量纲变量 $\\bar{u}(\\phi) = b u(\\phi)$ 和 $\\mu = M/b$，其中 $b$ 是碰撞参数。将 $u = \\bar{u}/b$ 代入方程中：\n$$\n\\frac{d^2}{d\\phi^2}\\left(\\frac{\\bar{u}}{b}\\right) + \\left(\\frac{\\bar{u}}{b}\\right) = 3M\\left(\\frac{\\bar{u}}{b}\\right)^2\n$$\n两边乘以 $b$ 得到无量纲轨道方程：\n$$\n\\frac{d^2\\bar{u}}{d\\phi^2} + \\bar{u} = \\frac{3M}{b}\\bar{u}^2\n$$\n$$\n\\frac{d^2\\bar{u}}{d\\phi^2} + \\bar{u} = 3\\mu \\bar{u}^2\n$$\n这就是所求的关于 $\\bar{u}(\\phi)$ 的方程。\n\n对于未受扰动的情况，我们设 $\\mu=0$。方程简化为简谐振子方程：\n$$\n\\frac{d^2\\bar{u}_0}{d\\phi^2} + \\bar{u}_0 = 0\n$$\n其通解为 $\\bar{u}_0(\\phi) = A\\cos(\\phi) + B\\sin(\\phi)$。选择 $\\phi$ 的坐标系，使得入射路径从 $\\phi \\approx 0$ 开始，出射路径朝向 $\\phi \\approx \\pi$。问题陈述指出，最近点出现在 $\\phi = \\pi/2$。在最近点，$r$ 为最小值，因此 $u=1/r$ 和 $\\bar{u}$ 为最大值。这要求 $\\bar{u}_0$ 的导数在 $\\phi=\\pi/2$ 处为零：\n$$\n\\frac{d\\bar{u}_0}{d\\phi}\\bigg|_{\\phi=\\pi/2} = [-A\\sin(\\phi) + B\\cos(\\phi)]_{\\phi=\\pi/2} = -A\\sin(\\pi/2) + B\\cos(\\pi/2) = -A = 0\n$$\n因此，$A=0$，解的形式为 $\\bar{u}_0(\\phi) = B\\sin(\\phi)$。对于未受扰动的直线轨迹，最近距离是碰撞参数 $b$。在 $\\phi=\\pi/2$ 处，我们有 $r=b$，这意味着 $u=1/b$。用无量纲的术语来说，就是 $\\bar{u}_0(\\pi/2) = b u(\\pi/2) = b(1/b) = 1$。在此点计算我们的解，得到 $\\bar{u}_0(\\pi/2) = B\\sin(\\pi/2)=B=1$。\n因此，未受扰动的解为：\n$$\n\\bar{u}_0(\\phi) = \\sin(\\phi)\n$$\n\n**2. 一阶微扰方程的推导**\n\n我们将一阶微扰 $\\bar{u}(\\phi) = \\bar{u}_0(\\phi) + \\mu w(\\phi)$ 引入到完整的无量纲方程中：\n$$\n\\frac{d^2}{d\\phi^2}(\\bar{u}_0 + \\mu w) + (\\bar{u}_0 + \\mu w) = 3\\mu(\\bar{u}_0 + \\mu w)^2\n$$\n展开并按 $\\mu$ 的幂次分组：\n$$\n\\left(\\frac{d^2\\bar{u}_0}{d\\phi^2} + \\bar{u}_0\\right) + \\mu\\left(\\frac{d^2w}{d\\phi^2} + w\\right) = 3\\mu(\\bar{u}_0^2 + 2\\mu\\bar{u}_0w + O(\\mu^2))\n$$\n左边的第一项为零，因为 $\\bar{u}_0$ 是齐次方程的解。令两边 $\\mu$ 的同阶项相等，得到：\n$$\n\\mu\\left(\\frac{d^2w}{d\\phi^2} + w\\right) = 3\\mu\\bar{u}_0^2\n$$\n两边除以 $\\mu$ 并代入 $\\bar{u}_0(\\phi)=\\sin(\\phi)$，我们得到微扰函数 $w(\\phi)$ 的线性非齐次常微分方程：\n$$\n\\frac{d^2w}{d\\phi^2}(\\phi) + w(\\phi) = 3\\sin^2(\\phi)\n$$\n这个 ODE 的形式为 $w''(\\phi) + k(\\phi)w(\\phi) = s(\\phi)$，其中 $k(\\phi)=1$ 且 $s(\\phi)=3\\sin^2(\\phi)$。\n\n物理轨迹必须关于最近点 $\\phi=\\pi/2$ 对称。由于未受扰动解 $\\bar{u}_0(\\phi)=\\sin(\\phi)$ 关于 $\\phi=\\pi/2$ 对称（因为 $\\sin(\\pi/2+\\delta) = \\sin(\\pi/2-\\delta)$），微扰 $w(\\phi)$ 也必须是对称的。这意味着它的导数在对称点必须为零：\n$$\n\\frac{dw}{d\\phi}\\bigg|_{\\phi=\\pi/2} = 0\n$$\n这提供了一个边界条件。为了开始数值积分，还需要第二个条件，即 $w(\\pi/2)$ 的值。$w(\\phi)$ 的 ODE 通解为 $w(\\phi) = C\\sin(\\phi) + 2 - \\sin^2(\\phi)$。对于常数 $C$ 的任何选择，条件 $w'(\\pi/2)=0$ 都满足。中点的值为 $w(\\pi/2) = C+1$。如任务 4 将要显示的，最终的弯曲角与 $C$ 无关。为计算简便起见，我们设 $C=0$，这对应于此问题的标准特解。这个选择给出了第二个边界条件：\n$$\nw(\\pi/2) = 1\n$$\n\n**3. Numerov 格式设计**\n\n任务是求解 ODE $w''(\\phi) + k(\\phi)w(\\phi) = s(\\phi)$，其中 $k(\\phi)=1$ 且 $s(\\phi)=3\\sin^2(\\phi)$。Numerov 方法是求解此类方程的六阶精度格式。在均匀网格 $\\phi_n = n h$ 上，其递推关系为：\n$$\ny_{n+1}\\left(1+\\frac{h^2}{12}k_{n+1}\\right) = 2y_n\\left(1-\\frac{5h^2}{12}k_n\\right) - y_{n-1}\\left(1+\\frac{h^2}{12}k_{n-1}\\right) + \\frac{h^2}{12}(s_{n+1}+10s_n+s_{n-1})\n$$\n由于 $k(\\phi)=1$ 是常数，对于 $w_n=w(\\phi_n)$，该关系简化为：\n$$\nw_{n+1}\\left(1+\\frac{h^2}{12}\\right) = 2w_n\\left(1-\\frac{5h^2}{12}\\right) - w_{n-1}\\left(1+\\frac{h^2}{12}\\right) + \\frac{h^2}{12}(s_{n+1}+10s_n+s_{n-1})\n$$\n积分将从中心点 $\\phi_c = \\pi/2$ 开始。设该点的网格索引为 $i_c$。我们需要两个初始值来启动递推。我们使用 $w_{i_c} = w(\\pi/2)$ 和从 $\\phi_c = \\pi/2$ 附近的 Taylor 展开得到的第二个值 $w_{i_c-1} = w(\\pi/2 - h)$：\n$$\nw(\\phi_c-h) = w(\\phi_c) - h w'(\\phi_c) + \\frac{h^2}{2}w''(\\phi_c) - \\frac{h^3}{6}w'''(\\phi_c) + \\frac{h^4}{24}w^{(4)}(\\phi_c) + O(h^6)\n$$\n利用我们的边界条件和 ODE：\n- $w(\\phi_c) = 1$\n- $w'(\\phi_c) = 0$\n- $w''(\\phi_c) = -w(\\phi_c) + s(\\phi_c) = -1 + 3\\sin^2(\\pi/2) = 2$\n- $w'''(\\phi) = -w'(\\phi) + 3\\sin(2\\phi) \\implies w'''(\\phi_c) = 0$\n- $w^{(4)}(\\phi) = -w''(\\phi) + 6\\cos(2\\phi) \\implies w^{(4)}(\\phi_c) = -2 + 6\\cos(\\pi) = -8$\n\n将这些代入展开式：\n$$\nw(\\pi/2 - h) = 1 + h^2 - \\frac{h^4}{3}\n$$\n已知 $w_{i_c}$ 和 $w_{i_c-1}$ 后，我们可以通过重新整理 Numerov 递推关系来求解 $w_{n-1}$，从而向 $\\phi=0$ 向后推进：\n$$\nw_{n-1} = \\frac{1}{1+h^2/12}\\left[ 2w_n\\left(1-\\frac{5h^2}{12}\\right) - w_{n+1}\\left(1+\\frac{h^2}{12}\\right) + \\frac{h^2}{12}(s_{n+1}+10s_n+s_{n-1}) \\right]\n$$\n对 $n = i_c-1, i_c-2, ..., 1$ 迭代应用此公式。对于 $\\phi \\in [\\pi/2, \\pi]$ 的解可以通过利用对称性找到：$w(\\pi/2+\\delta) = w(\\pi/2-\\delta)$，这意味着在网格上，$w_{i_c+k} = w_{i_c-k}$。\n\n**4. 弯曲角估计**\n\n总弯曲角 $\\alpha$ 是轨迹总角度变化与未受扰动值 $\\pi$ 弧度的偏离。轨迹的渐近线出现在 $r \\to \\infty$ 的地方，即 $\\bar{u}(\\phi) = 0$。我们寻求 $\\bar{u}(\\phi) = \\sin(\\phi) + \\mu w(\\phi) = 0$ 的根。\n\n对于入射渐近线，在 $\\phi=0$ 附近，设根为 $\\phi_{in}$。对于小的 $\\phi_{in}$，我们进行线性化：$\\sin(\\phi_{in}) \\approx \\phi_{in}$ 且 $w(\\phi_{in}) \\approx w(0)$。\n$$\n\\phi_{in} + \\mu w(0) \\approx 0 \\implies \\phi_{in} \\approx -\\mu w(0)\n$$\n对于出射渐近线，在 $\\phi=\\pi$ 附近，设根为 $\\phi_{out} = \\pi + \\delta\\phi$。对于小的 $\\delta\\phi$：$\\sin(\\pi+\\delta\\phi) \\approx -\\delta\\phi$ 且 $w(\\pi+\\delta\\phi) \\approx w(\\pi)$。\n$$\n-\\delta\\phi + \\mu w(\\pi) \\approx 0 \\implies \\delta\\phi \\approx \\mu w(\\pi)\n$$\n所以，$\\phi_{out} \\approx \\pi + \\mu w(\\pi)$。经过的总角度为 $\\Delta\\Phi = \\phi_{out} - \\phi_{in} \\approx (\\pi + \\mu w(\\pi)) - (-\\mu w(0)) = \\pi + \\mu(w(0)+w(\\pi))$。\n弯曲角 $\\alpha$ 是与 $\\pi$ 的偏离：\n$$\n\\alpha = \\Delta\\Phi - \\pi = \\mu(w(0) + w(\\pi))\n$$\n根据对称性，$w(0) = w(\\pi)$。因此，使用数值计算的 $w(\\phi)$ 得到弯曲角的最终公式为：\n$$\n\\alpha = 2\\mu w(0)\n$$\n解析解 $w(\\phi) = 2-\\sin^2(\\phi)$ 给出 $w(0)=2$，这得到了已知的广义相对论结果 $\\alpha = 4\\mu = 4M/b$。我们的数值方法应该近似这个结果。对于测试用例 $\\mu=0$，该公式正确地给出 $\\alpha=0$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_bending_angle(mu, N=2**16):\n    \"\"\"\n    Calculates the weak-field gravitational bending angle of light.\n\n    This function implements a Numerov scheme to solve the first-order\n    perturbation equation for a null geodesic in Schwarzschild spacetime.\n\n    Args:\n        mu (float): The dimensionless mass-to-impact-parameter ratio M/b.\n        N (int): The number of grid intervals for the phi-domain [0, pi].\n                 Must be an even number.\n\n    Returns:\n        float: The total bending angle alpha in radians.\n    \"\"\"\n    if mu == 0.0:\n        return 0.0\n\n    # 1. Set up the grid and known functions\n    h = np.pi / N\n    phi = np.linspace(0.0, np.pi, N + 1)\n    \n    # The source term s(phi) = 3*sin^2(phi) in w'' + w = s\n    s = 3.0 * np.sin(phi)**2\n    \n    # The perturbation function array\n    w = np.zeros(N + 1)\n    \n    # Index of the center point, phi = pi/2\n    ic = N // 2\n\n    # 2. Initialize the solution at the center using boundary conditions\n    # From the problem analysis, we choose w(pi/2) = 1.\n    w[ic] = 1.0\n    \n    # Use a Taylor expansion for the second point w(pi/2 - h) to match\n    # the high order of the Numerov method.\n    # w(pi/2-h) = w(pi/2) + h^2 - h^4/3 + O(h^6)\n    w[ic - 1] = 1.0 + h**2 - (h**4) / 3.0\n\n    # 3. Implement the Numerov method\n    # The recurrence for w'' + w = s is:\n    # w_{n-1} = (2*w_n*(1 - 5h^2/12) - w_{n+1}*(1+h^2/12) + h^2/12*(s_{n+1}+10s_n+s_{n-1}))/(1+h^2/12)\n    \n    # Pre-calculate coefficients for efficiency\n    c1 = 1.0 + h**2 / 12.0\n    c2 = 2.0 * (1.0 - 5.0 * h**2 / 12.0)\n    c3 = h**2 / 12.0\n\n    # March backwards from the center (phi=pi/2) to phi=0\n    # At each step n, we have w[n] and w[n+1] and compute w[n-1].\n    for n in range(ic - 1, 0, -1):\n        s_term = s[n + 1] + 10.0 * s[n] + s[n - 1]\n        numerator = c2 * w[n] - c1 * w[n + 1] + c3 * s_term\n        w[n - 1] = numerator / c1\n\n    # 4. Calculate the bending angle\n    # The bending angle alpha is given by alpha = 2 * mu * w(0)\n    w_0 = w[0]\n    alpha = 2.0 * mu * w_0\n    \n    return alpha\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        0.0,\n        1e-6,\n        1e-5,\n        5e-5,\n    ]\n\n    results = []\n    # Use a sufficiently large number of grid points for high accuracy.\n    # N must be even. 2^16 ensures precision well beyond the required 6 sig figs.\n    N_grid = 2**16 \n    \n    for mu in test_cases:\n        angle = calculate_bending_angle(mu, N=N_grid)\n        results.append(angle)\n\n    # Final print statement in the exact required format.\n    # e.g., \"[0.0,4.0e-06,4.0e-05,2.0e-04]\"\n    # Using a general format string that adapts to the number's magnitude.\n    print(f\"[{','.join(f'{r:.7g}' for r in results)}]\")\n\nsolve()\n```", "id": "2421994"}]}