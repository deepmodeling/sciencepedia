{"hands_on_practices": [{"introduction": "在我们运用重子声学振荡（BAO）作为标准尺之前，首先必须理解其物理起源，即在早期宇宙光子-重子等离子体中传播的声波。这个练习将这一复杂过程简化为一个一维波动方程，让我们可以亲手建立一个数值模型。通过这项动手编程实践，你不仅能直观地感受“振荡”的本质，还能掌握计算宇宙学中至关重要的数值稳定性与色散等核心概念[@problem_id:2449953]。", "problem": "考虑将紧密耦合的光子-重子流体中的早期声学驻波建模为一维线性波。在一个共动的、无量纲的描述中，将空间区间 $x\\in[0,L]$ 和时间 $t\\ge 0$ 上的标量微扰场 $u(x,t)$ 用一维线性波动方程 $u_{tt} = c_s^2 u_{xx}$ 进行建模，其中 $c_s$ 是恒定的声速。施加固定端点边界条件 $u(0,t)=0$ 和 $u(L,t)=0$，以及一个初始速度为零的初始驻波微扰：$u(x,0) = A \\sin(n\\pi x/L)$ 和 $u_t(x,0)=0$，其中 $A$ 是振幅，$n$ 是一个正整数模数。所有量都是无量纲的，任何角度都必须以弧度为单位处理。\n\n从 $u_{tt} = c_s^2 u_{xx}$ 和均匀网格上的中心有限差分定义出发，完成以下任务，不要引用任何预先推导的目标公式：\n\n- 在均匀网格 $x_i = i\\Delta x$（$i=0,1,\\dots,N_x-1$，$\\Delta x = L/(N_x-1)$）和时间层级 $t^m = m\\Delta t$（$m$为整数）上，推导一个时间中心、空间中心的二阶精度显式格式。定义库朗数 $r = c_s \\Delta t/\\Delta x$。明确说明内部点的更新方程，以及如何初始化第一个时间步，以使得当 $u_t(x,0)=0$ 时，整个方法在时间上保持二阶精度。\n- 使用从离散傅里叶模式定义开始的平面波（Von Neumann）分析，推导关于 $r$ 的稳定性条件，该条件确保对网格上所有可分辨的空间波数，放大是有界的。\n- 通过相同的分析，推导连接数值角频率和空间波数的离散色散关系，并用 $r$ 和 $\\Delta x$ 表示。解释该格式在何种特殊情况下变为非色散的。\n- 实现推导出的格式，并用它来对初始数据进行数值演化。为了测量给定模式 $n$ 的数值角频率，记录空间中点 $x=L/2$ 处 $u$ 的时间序列（取奇数 $N_x$ 以使中点成为网格点）。检测时间上的连续局部最大值，并通过对每个峰值周围的三个连续样本拟合抛物线来精确化它们出现的时间。使用检测到的第一个和最后一个峰值时间之差除以间隔的周期数来估计数值周期 $T_{\\text{num}}$，然后设定数值角频率 $\\omega_{\\text{num}} = 2\\pi/T_{\\text{num}}$。驻波模式的连续谱角频率为 $\\omega_{\\text{cont}} = c_s k$，其中 $k = n\\pi/L$。以浮点数 $|\\omega_{\\text{num}}-\\omega_{\\text{cont}}|/\\omega_{\\text{cont}}$ 的形式报告相对误差。\n- 对于一个 $r$ 违反稳定性条件的测试，为了进行稳定性分类，不要运行长时间模拟；而是使用你推导出的稳定性条件报告一个布尔值来指示不稳定性。\n\n测试套件和要求输出：\n使用以下三个测试用例，全部使用 $L=1$，$A=1$，$n=1$，$c_s = 1/\\sqrt{3}$，$N_x = 201$（这样中点是一个网格节点，并且初始模式可以被精确表示）：\n\n- 用例1（理想情况，非色散极限）：$r=1$，模拟 $P=5$ 个连续谱驻波周期。输出相对角频率误差，为浮点数，四舍五入到八位小数。\n- 用例2（稳定，色散）：$r=0.9$，模拟 $P=5$ 个周期。输出相对角频率误差，为浮点数，四舍五入到八位小数。\n- 用例3（不稳定）：$r=1.1$。仅使用你推导的稳定性条件，如果格式不稳定则输出布尔值 true，否则输出 false。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，顺序为[用例1的结果, 用例2的结果, 用例3的结果]。前两个条目必须是如上所述的浮点数，第三个必须是布尔值。例如：“[0.0,0.00123456,True]”。", "solution": "所提出的问题是关于一维线性波动方程的一个标准的、适定的初边值问题。它具有科学依据，内容自洽，并且不包含任何歧义或矛盾。因此，这是一个有效的问题，其完整解的推导和实现如下。\n\n控制偏微分方程（PDE）是一维线性波动方程：\n$$\n\\frac{\\partial^2 u}{\\partial t^2} = c_s^2 \\frac{\\partial^2 u}{\\partial x^2}\n$$\n其中 $u(x,t)$ 是标量微扰场，$x$ 是共动空间坐标，$t$ 是时间，$c_s$ 是恒定声速。\n\n该问题定义在空间域 $x \\in [0, L]$上，具有固定端点边界条件 $u(0,t)=0$ 和 $u(L,t)=0$。初始条件由一个初始速度为零的驻波剖面给出：$u(x,0) = A \\sin(n\\pi x/L)$ 和 $u_t(x,0)=0$。\n\n我们将在一个均匀网格上构建数值解，空间步长为 $\\Delta x$，时间步长为 $\\Delta t$。令 $x_i = i\\Delta x$（$i=0, 1, \\dots, N_x-1$）和 $t^m = m\\Delta t$（整数 $m \\ge 0$）。$u(x_i, t^m)$ 的数值近似值记为 $u_i^m$。\n\n**有限差分格式的推导**\n为了推导一个在空间和时间上都是二阶精度的显式格式，我们对偏导数采用中心有限差分近似。\n\n时间上的二阶偏导数 $u_{tt}$ 在网格点 $(x_i, t^m)$ 处的近似为：\n$$\n\\frac{\\partial^2 u}{\\partial t^2}\\bigg|_{i,m} \\approx \\frac{u_i^{m+1} - 2u_i^m + u_i^{m-1}}{(\\Delta t)^2} + O((\\Delta t)^2)\n$$\n空间上的二阶偏导数 $u_{xx}$ 的近似为：\n$$\n\\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{i,m} \\approx \\frac{u_{i+1}^m - 2u_i^m + u_{i-1}^m}{(\\Delta x)^2} + O((\\Delta x)^2)\n$$\n将这些近似代入波动方程得到：\n$$\n\\frac{u_i^{m+1} - 2u_i^m + u_i^{m-1}}{(\\Delta t)^2} = c_s^2 \\left( \\frac{u_{i+1}^m - 2u_i^m + u_{i-1}^m}{(\\Delta x)^2} \\right)\n$$\n为了得到 $u_i^{m+1}$ 的显式更新规则，我们重排该方程：\n$$\nu_i^{m+1} = 2u_i^m - u_i^{m-1} + \\frac{c_s^2 (\\Delta t)^2}{(\\Delta x)^2} (u_{i+1}^m - 2u_i^m + u_{i-1}^m)\n$$\n定义库朗数 $r = c_s \\Delta t/\\Delta x$，表达式简化为：\n$$\nu_i^{m+1} = 2u_i^m - u_i^{m-1} + r^2(u_{i+1}^m - 2u_i^m + u_{i-1}^m)\n$$\n这可以进一步重排，得到内部网格点的更新方程：\n$$\nu_i^{m+1} = 2(1 - r^2)u_i^m + r^2(u_{i+1}^m + u_{i-1}^m) - u_i^{m-1}\n$$\n这就是波动方程的中心时间、中心空间（CTCS）格式。\n\n**第一个时间步的初始化**\nCTCS 格式是一个三层格式，需要时间层 $m$ 和 $m-1$ 的数据来计算 $m+1$ 层的解。为了开始模拟，我们需要 $u_i^0$ 和 $u_i^1$。场 $u_i^0$ 由初始条件 $u(x_i, 0)$ 给出。为了在保持二阶精度的情况下找到 $u_i^1$，我们使用初始速度条件 $u_t(x,0)=0$。在 $t=0$ 时，时间导数的二阶精度中心差分是：\n$$\n\\frac{\\partial u}{\\partial t}\\bigg|_{i,0} = \\frac{u_i^1 - u_i^{-1}}{2\\Delta t} = 0\n$$\n这意味着 $u_i^{-1} = u_i^1$。通用更新方程可以在第一个时间步（$m=0$）进行评估：\n$$\nu_i^1 = 2(1 - r^2)u_i^0 + r^2(u_{i+1}^0 + u_{i-1}^0) - u_i^{-1}\n$$\n代入 $u_i^{-1} = u_i^1$ 得到：\n$$\nu_i^1 = 2(1 - r^2)u_i^0 + r^2(u_{i+1}^0 + u_{i-1}^0) - u_i^1\n$$\n$$\n2u_i^1 = 2(1 - r^2)u_i^0 + r^2(u_{i+1}^0 + u_{i-1}^0)\n$$\n求解 $u_i^1$ 得到第一个时间步的特殊公式：\n$$\nu_i^1 = (1 - r^2)u_i^0 + \\frac{r^2}{2}(u_{i+1}^0 + u_{i-1}^0)\n$$\n这样就可以仅使用 $t^0=0$ 时的初始条件来计算 $t^1 = \\Delta t$ 时的解，从而保持了该方法的整体二阶精度。\n\n**Von Neumann 稳定性分析**\n为了确定该格式的稳定性，我们进行 Von Neumann 分析。我们考虑一个单一傅里叶模式解，形式为：\n$$\nu_i^m = G(k)^m e^{j k x_i} = G^m e^{j k i \\Delta x}\n$$\n其中 $k$ 是空间波数，$j=\\sqrt{-1}$，$G(k)$ 是该模式每个时间步的放大因子。为了使解保持有界，我们要求对于网格可分辨的所有波数 $k$，都有 $|G| \\le 1$。\n\n将该试探解代入CTCS更新方程：\n$$\nG^{m+1}e^{jki\\Delta x} = 2(1-r^2)G^m e^{jki\\Delta x} + r^2(G^m e^{jk(i+1)\\Delta x} + G^m e^{jk(i-1)\\Delta x}) - G^{m-1}e^{jki\\Delta x}\n$$\n除以 $G^{m-1}e^{jki\\Delta x}$ 得到关于 $G$ 的特征方程：\n$$\nG^2 = 2(1-r^2)G + r^2 G(e^{jk\\Delta x} + e^{-jk\\Delta x}) - 1\n$$\n使用欧拉恒等式 $e^{j\\theta} + e^{-j\\theta} = 2\\cos(\\theta)$：\n$$\nG^2 - [2(1-r^2) + 2r^2\\cos(k\\Delta x)]G + 1 = 0\n$$\n这可以用半角恒等式 $1-\\cos(\\theta) = 2\\sin^2(\\theta/2)$ 重写为：\n$$\nG^2 - 2[1 - 2r^2\\sin^2(k\\Delta x/2)]G + 1 = 0\n$$\n这是一个形式为 $G^2 - 2pG + 1 = 0$ 的二次方程，其中 $p = 1 - 2r^2\\sin^2(k\\Delta x/2)$。$G$ 的解是 $G=p \\pm \\sqrt{p^2-1}$。\n为了稳定性（$|G| \\le 1$），根 $G$ 必须是单位模的复数。这发生在判别式为非正数时，即 $p^2 \\le 1$，这等价于 $|p| \\le 1$：\n$$\n|1 - 2r^2\\sin^2(k\\Delta x/2)| \\le 1\n$$\n这个不等式产生两个条件：\n1. $1 - 2r^2\\sin^2(k\\Delta x/2) \\le 1 \\implies -2r^2\\sin^2(k\\Delta x/2) \\le 0$，这总是成立的。\n2. $1 - 2r^2\\sin^2(k\\Delta x/2) \\ge -1 \\implies 2 \\ge 2r^2\\sin^2(k\\Delta x/2) \\implies r^2\\sin^2(k\\Delta x/2) \\le 1$。\n\n这个条件必须对所有的 $k$ 都成立。项 $\\sin^2(k\\Delta x/2)$ 在网格上最高可分辨波数 $k = \\pi/\\Delta x$ 时达到其最大值 1。因此，最严格的条件是 $r^2 \\le 1$。由于 $r \\ge 0$，稳定性条件是：\n$$\nr \\le 1\n$$\n这就是该格式的 Courant-Friedrichs-Lewy (CFL) 条件。如果 $r > 1$，该格式不稳定。\n\n**离散色散关系**\n放大因子 $G$ 可以用数值角频率 $\\omega_{\\text{num}}$ 表示为 $G = e^{j\\omega_{\\text{num}}\\Delta t}$。根据特征方程，我们有 $\\cos(\\omega_{\\text{num}}\\Delta t) = p$：\n$$\n\\cos(\\omega_{\\text{num}}\\Delta t) = 1 - 2r^2\\sin^2(k\\Delta x/2)\n$$\n将半角恒等式 $1-\\cos(\\theta) = 2\\sin^2(\\theta/2)$ 应用于左侧，得到：\n$$\n2\\sin^2(\\omega_{\\text{num}}\\Delta t/2) = 2r^2\\sin^2(k\\Delta x/2)\n$$\n对两边取平方根（并考虑主支）得到离散色散关系：\n$$\n\\sin(\\frac{\\omega_{\\text{num}}\\Delta t}{2}) = r \\sin(\\frac{k\\Delta x}{2})\n$$\n连续谱色散关系是线性的：$\\omega_{\\text{cont}} = c_s k$。如果一个数值格式的色散关系也是线性的，并且与连续谱的色散关系相匹配，那么该格式就是非色散的。在库朗数 $r=1$ 的特殊情况下，我们有 $c_s \\Delta t = \\Delta x$。离散色散关系变为：\n$$\n\\sin(\\frac{\\omega_{\\text{num}}\\Delta t}{2}) = \\sin(\\frac{k\\Delta x}{2}) = \\sin(\\frac{k c_s \\Delta t}{2})\n$$\n这意味着对于所有的 $k$，都有 $\\omega_{\\text{num}} = c_s k = \\omega_{\\text{cont}}$。因此，当 $r=1$ 时，该格式变为非色散的，并且数值相速度与所有可分辨频率的物理相速度完全匹配。对于任何 $r  1$，该关系是非线性的，导致数值色散，即不同波数的波以不同的速度传播。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and print the final result.\n    \"\"\"\n\n    def simulate_and_analyze(L, A, n, cs, Nx, r, P):\n        \"\"\"\n        Derives, implements, and analyzes the CTCS scheme for a given test case.\n        \"\"\"\n        # Case 3: Instability check based on the derived condition r = 1.\n        if r > 1:\n            return True\n\n        # === Grid and Parameter Setup ===\n        dx = L / (Nx - 1)\n        dt = r * dx / cs\n        x = np.linspace(0, L, Nx)\n        r_sq = r * r\n\n        # === Continuum and Simulation Time Properties ===\n        k_cont = n * np.pi / L\n        omega_cont = cs * k_cont\n        T_cont = 2 * np.pi / omega_cont\n        T_sim = P * T_cont\n        Nt = int(np.ceil(T_sim / dt))\n\n        # === Initialization ===\n        # u^0: Initial condition at t=0\n        u_curr = A * np.sin(k_cont * x)\n        \n        # u_prev will hold u at time m-1, u_curr holds u at time m\n        u_prev = u_curr.copy()\n        \n        # Data recording for midpoint time series\n        mid_idx = (Nx - 1) // 2\n        time_points = [0.0]\n        u_mid_series = [u_curr[mid_idx]]\n\n        # === First Time Step ===\n        # Calculated using special second-order accurate formula for u_t(x,0)=0\n        u_next = np.zeros_like(u_curr)\n        u_next[1:-1] = (1 - r_sq) * u_curr[1:-1] + 0.5 * r_sq * (u_curr[2:] + u_curr[:-2])\n        u_curr = u_next\n        \n        # Record data for the first step\n        time_points.append(dt)\n        u_mid_series.append(u_curr[mid_idx])\n        \n        # === Main Time-Stepping Loop ===\n        for m in range(1, Nt):\n            u_next = np.zeros_like(u_curr)\n            # CTCS update for interior points\n            u_next[1:-1] = 2 * (1 - r_sq) * u_curr[1:-1] - u_prev[1:-1] + r_sq * (u_curr[2:] + u_curr[:-2])\n            \n            # Update fields for the next iteration\n            u_prev = u_curr\n            u_curr = u_next\n            \n            # Record data\n            time_points.append((m + 1) * dt)\n            u_mid_series.append(u_curr[mid_idx])\n\n        # === Numerical Frequency Measurement ===\n        time_points = np.array(time_points)\n        u_mid_series = np.array(u_mid_series)\n\n        # Detect local maxima in the midpoint time series\n        peak_indices = np.where((u_mid_series[1:-1] > u_mid_series[:-2])  (u_mid_series[1:-1] > u_mid_series[2:]))[0] + 1\n        \n        if len(peak_indices)  2:\n            raise RuntimeError(\"Insufficient peaks detected to measure frequency.\")\n\n        # Refine peak times using parabolic interpolation\n        refined_peak_times = []\n        for idx in peak_indices:\n            y_m1, y_0, y_p1 = u_mid_series[idx-1:idx+2]\n            \n            # The denominator approaches zero for a straight line.\n            denominator = 2 * (y_m1 - 2*y_0 + y_p1)\n            if np.abs(denominator)  1e-15:\n                tau_peak = 0.0\n            else:\n                numerator = y_m1 - y_p1\n                tau_peak = dt * numerator / denominator\n            \n            refined_peak_times.append(time_points[idx] + tau_peak)\n\n        # Calculate numerical period and frequency\n        num_periods = len(refined_peak_times) - 1\n        total_duration = refined_peak_times[-1] - refined_peak_times[0]\n        T_num = total_duration / num_periods\n        omega_num = 2 * np.pi / T_num\n\n        # Calculate relative error\n        rel_error = np.abs(omega_num - omega_cont) / omega_cont\n        \n        return round(rel_error, 8)\n\n    # Define the test cases from the problem statement.\n    common_params = {'L': 1.0, 'A': 1.0, 'n': 1, 'cs': 1.0/np.sqrt(3), 'Nx': 201}\n    test_cases = [\n        {'r': 1.0, 'P': 5},   # Case 1: Non-dispersive\n        {'r': 0.9, 'P': 5},   # Case 2: Stable, dispersive\n        {'r': 1.1, 'P': 5},   # Case 3: Unstable\n    ]\n\n    results = []\n    for case_params in test_cases:\n        params = {**common_params, **case_params}\n        result = simulate_and_analyze(**params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2449953"}, {"introduction": "一旦BAO的物理尺度$r_s$在复合时期被“冻结”，我们在天空中观测到的其对应的角尺度，则取决于光线传播至我们这里的路径，而这条路径是由宇宙的几何形态决定的。这个练习将引导你通过解析推导，直接比较在不同空间曲率的宇宙中，BAO角尺度的表现有何不同。它清晰地揭示了为何BAO是探测宇宙几何学，例如物质密度参数$\\Omega_{m,0}$和曲率参数$\\Omega_{k,0}$的有力工具[@problem_id:296434]。", "problem": "星系大尺度分布中的重子声学振荡（Baryon Acoustic Oscillation, BAO）特征为宇宙学测量提供了一把“标准尺”。这把尺子的特征共动尺度由拖拽时期（drag epoch）的声视界（sound horizon）决定，记为 $r_s$。在给定红移 $z$ 处观测到的该特征的角大小 $\\theta(z)$，通过角直径距离 $d_A(z)$ 依赖于宇宙的几何结构。其关系式如下：\n$$\n\\theta(z) = \\frac{r_s}{(1+z) d_A(z)}\n$$\n对于一个只包含物质（尘埃）且曲率为非零的宇宙（即 $\\Omega_{r,0} = \\Omega_{\\Lambda,0} = 0$，$\\Omega_{m,0} + \\Omega_{k,0} = 1$），角直径距离由 Mattig 公式描述：\n$$\nd_A(z) = \\frac{2c}{H_0 (1+z)^2 \\Omega_{m,0}^2} \\left[ \\Omega_{m,0}z + (\\Omega_{m,0}-2) \\left( \\sqrt{1+\\Omega_{m,0}z} - 1 \\right) \\right]\n$$\n其中 $c$ 是光速，$H_0$ 是哈勃常数，$\\Omega_{m,0}$ 是红移 $z=0$ 时的物质密度参数。\n\n考虑两种不同的只含物质的宇宙学模型：\n1.  一个空间平坦、只含物质的宇宙（爱因斯坦-德西特模型），其中 $\\Omega_{m,0} = 1$ 且 $\\Omega_{k,0} = 0$。\n2.  一个空间开放、只含物质的宇宙，其中物质密度参数为 $\\Omega_{m,0}  1$，曲率密度参数为 $\\Omega_{k,0} = 1-\\Omega_{m,0}  0$。\n\n在相同的红移 $z$ 下，推导开放宇宙中 BAO 特征的观测角大小与平坦宇宙中 BAO 特征的观测角大小之比 $R = \\frac{\\theta_{\\text{open}}(z)}{\\theta_{\\text{flat}}(z)}$ 的符号表达式。你的最终答案应该是红移 $z$ 和开放宇宙物质密度参数 $\\Omega_{m,0}$ 的函数。", "solution": "1.  我们从角大小比的定义开始。由于 $r_s$ 和 $(1+z)$ 对于两个模型是相同的，它们在比值中被消掉：\n    $$\n    R = \\frac{\\theta_{\\text{open}}(z)}{\\theta_{\\text{flat}}(z)} = \\frac{r_s/[(1+z)d_A^{\\text{open}}(z)]}{r_s/[(1+z)d_A^{\\text{flat}}(z)]} = \\frac{d_A^{\\text{flat}}(z)}{d_A^{\\text{open}}(z)}\n    $$\n\n2.  我们利用给定的 Mattig 公式计算平坦宇宙情况下的角直径距离 $d_A^{\\text{flat}}(z)$。令 $\\Omega_{m,0} = 1$：\n    $$\n    d_A^{\\text{flat}}(z) = \\frac{2c}{H_0(1+z)^2 \\cdot 1^2}\\left[1 \\cdot z + (1-2)\\left(\\sqrt{1+1 \\cdot z}-1\\right)\\right] = \\frac{2c}{H_0(1+z)^2}\\left[z - \\left(\\sqrt{1+z}-1\\right)\\right] = \\frac{2c}{H_0(1+z)^2}\\left[1+z - \\sqrt{1+z}\\right]\n    $$\n\n3.  开放宇宙的角直径距离 $d_A^{\\text{open}}(z)$ 直接由 Mattig 公式给出，其中 $\\Omega_{m,0}$ 是一个参数：\n    $$\n    d_A^{\\text{open}}(z) = \\frac{2c}{H_0 (1+z)^2 \\Omega_{m,0}^2} \\left[ \\Omega_{m,0}z + (\\Omega_{m,0}-2) \\left( \\sqrt{1+\\Omega_{m,0}z} - 1 \\right) \\right]\n    $$\n\n4.  现在我们计算比值 $R = d_A^{\\text{flat}}(z) / d_A^{\\text{open}}(z)$。为了简化，我们可以使用 $1+z - \\sqrt{1+z} = \\sqrt{1+z}(\\sqrt{1+z}-1)$ 这一关系：\n    $$\n    R = \\frac{\\frac{2c}{H_0(1+z)^2}\\left[1+z - \\sqrt{1+z}\\right]}{\\frac{2c}{H_0 (1+z)^2 \\Omega_{m,0}^2} \\left[ \\Omega_{m,0}z + (\\Omega_{m,0}-2) \\left( \\sqrt{1+\\Omega_{m,0}z} - 1 \\right) \\right]}\n    $$\n    $$\n    R = \\frac{\\Omega_{m,0}^2 \\left(1+z - \\sqrt{1+z}\\right)}{\\Omega_{m,0}z + (\\Omega_{m,0}-2)\\left(\\sqrt{1+\\Omega_{m,0}z}-1\\right)}\n    $$\n    利用恒等式，分子可以写成 $\\Omega_{m,0}^2 \\sqrt{1+z}(\\sqrt{1+z}-1)$。因此，最终表达式为：\n    $$\n    R = \\frac{\\Omega_{m,0}^2\\sqrt{1+z}\\,(\\sqrt{1+z}-1)}{\\Omega_{m,0}z+(\\Omega_{m,0}-2)\\bigl(\\sqrt{1+\\Omega_{m,0}z}-1\\bigr)}\n    $$", "answer": "$$\\boxed{\\frac{\\Omega_{m,0}^2\\sqrt{1+z}\\,(\\sqrt{1+z}-1)}{\\Omega_{m,0}z+(\\Omega_{m,0}-2)\\bigl(\\sqrt{1+\\Omega_{m,0}z}-1\\bigr)}}$$", "id": "296434"}, {"introduction": "在真实的宇宙学分析中，我们必须依赖一个理论模型来解读观测数据，但如果这个假设的模型本身就是不准确的呢？这项实践深入探讨了这一高级课题，它将量化一个在分析中常见的简化假设——即假设宇宙是平坦的——在真实宇宙存在曲率时，会如何系统性地影响我们对暗能量状态方程参数$w$的测量。这是一个关于理解和控制系统误差的深刻教训，对于任何有志于从事精确宇宙学研究的学生都至关重要[@problem_id:808486]。", "problem": "一位天体物理学家正在分析来自其宇宙的宇宙学数据，该宇宙可以被一个 $k\\Lambda$CDM 模型精确描述。这个“真实”模型具有当前的密度参数，包括物质的 $\\Omega_{m,0}$、宇宙学常数的 $\\Omega_{\\Lambda,0}$ 和曲率的 $\\Omega_{k,0}$，它们满足闭合关系 $\\Omega_{m,0} + \\Omega_{\\Lambda,0} + \\Omega_{k,0} = 1$。物质组分是无压的（$w_m=0$），宇宙学常数的状态方程参数为 $w_\\Lambda = -1$。\n\n这位天体物理学家没有意识到非零曲率的存在，假设宇宙是空间平坦的（$\\Omega_k=0$），并将其建模为一个“基准”平坦 $w$CDM 模型。该模型包含物质和一个状态方程参数为常数 $w$ 的暗能量组分。这个基准模型中的密度参数用 $\\Omega'_{m,0}$ 和 $\\Omega'_{DE,0}$ 表示，满足 $\\Omega'_{m,0} + \\Omega'_{DE,0} = 1$。通过独立测量，这位天体物理学家得到了一个非常精确的物质密度值，因此他们固定 $\\Omega'_{m,0} = \\Omega_{m,0}$。\n\n为了约束参数 $w$，这位天体物理学家将其基准模型的“急动参数”与他们宇宙的真实值进行匹配。急动参数 $j_0$ 是对当前时期标度因子的三阶时间导数的一个无量纲量度，定义为 $j_0 \\equiv (1/H_0^3) (\\dddot{a}/a)|_{t_0}$。它提供了关于宇宙加速变化率的信息。\n\n对于真实的 $k\\Lambda$CDM 宇宙，急动参数由下式给出：\n$$j_{0, \\text{true}} = 1 - \\Omega_{k,0}$$\n\n对于基准平坦 $w$CDM 模型，急动参数为：\n$$j_{0, \\text{fid}} = 1 + \\frac{9}{2} w(1+w)(1-\\Omega_{m,0})$$\n\n假设真实宇宙具有非零曲率 $\\Omega_{k,0}$ 和非零物质密度 $\\Omega_{m,0} \\in (0,1)$。通过令真实急动参数和基准急动参数相等，确定天体物理学家推断出的 $w$ 值。对于 $w$ 会有两个数学解；选择在模型失配消失的极限下（即当 $\\Omega_{k,0} \\to 0$ 时）能正确恢复到真实值 $w=-1$ 的那个解。", "solution": "1.  令真实急动参数 $j_{0, \\text{true}}$ 和基准急动参数 $j_{0, \\text{fid}}$ 相等：\n    $$\n    1-\\Omega_{k,0} = 1+\\frac{9}{2}\\,w(1+w)(1-\\Omega_{m,0})\n    $$\n2.  两边同减 1：\n    $$\n    -\\Omega_{k,0} = \\frac{9}{2}\\,w(1+w)(1-\\Omega_{m,0})\n    $$\n3.  重排方程，得到一个关于 $w$ 的标准二次方程形式 $w^2+w+C=0$：\n    $$\n    w(1+w) = -\\frac{2\\,\\Omega_{k,0}}{9\\,(1-\\Omega_{m,0})}\n    $$\n    $$\n    w^2+w+\\frac{2\\,\\Omega_{k,0}}{9\\,(1-\\Omega_{m,0})}=0\n    $$\n4.  使用二次方程求根公式 $w = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$ 求解 $w$：\n    $$\n    w = \\frac{-1 \\pm \\sqrt{1^2 - 4(1)\\left(\\frac{2\\,\\Omega_{k,0}}{9(1-\\Omega_{m,0})}\\right)}}{2} = \\frac{-1 \\pm \\sqrt{1-\\frac{8\\,\\Omega_{k,0}}{9(1-\\Omega_{m,0})}}}{2}\n    $$\n5.  选择正确的物理分支。我们需要在模型失配消失的极限下（即 $\\Omega_{k,0} \\to 0$）恢复到真实宇宙学常数对应的 $w=-1$。\n    当 $\\Omega_{k,0} \\to 0$ 时，平方根项变为 $\\sqrt{1-0}=1$。\n    -   使用“+”号的分支得到：$w = \\frac{-1+1}{2} = 0$。\n    -   使用“-”号的分支得到：$w = \\frac{-1-1}{2} = -1$。\n    因此，我们必须选择“-”号分支。\n    $$\n    w = \\frac{-1-\\sqrt{1-\\frac{8\\,\\Omega_{k,0}}{9(1-\\Omega_{m,0})}}}{2}\n    $$", "answer": "$$\\boxed{\\frac{-1-\\sqrt{1-\\frac{8\\Omega_{k,0}}{9(1-\\Omega_{m,0})}}}{2}}$$", "id": "808486"}]}