{"hands_on_practices": [{"introduction": "在任何天文巡天观测中，我们探测到的样本并非总是对整个天体总体的无偏代表。本练习将深入探讨一种经典的选择效应，即马姆奎斯特偏见（Malmquist bias）。你将通过计算来量化一个巡天的亮度极限（magnitude limit）如何与超新星宿主星系的本动速度相结合，从而系统性地扭曲观测样本，并导致对物质密度参数 $\\Omega_m$ 的测量出现偏差 [@problem_id:842065]。", "problem": "一项宇宙学巡天旨在使用Ia型超新星（SNe Ia）作为标准烛光来限制物质密度参数 $\\Omega_m$。为简单起见，我们将此巡天建模为观测大量都位于相同的小宇宙学红移 $z_c \\ll 1$ 处的Ia型超新星。其基础（“真实”）宇宙学模型是一个空间平坦的Friedmann-Lemaître-Robertson-Walker (FLRW) 时空，由哈勃常数 $H_0$ 和物质密度参数 $\\Omega_{m,0}$ 描述。在此模型中，红移为 $z$ 的天体的光度距离 $d_L$ 由下式给出：\n$$d_L(z; \\Omega_m) = \\frac{c(1+z)}{H_0} \\int_0^z \\frac{dz'}{\\sqrt{\\Omega_m(1+z')^3 + 1-\\Omega_m}}$$\n其中 $c$ 是光速。对于红移 $z \\ll 1$ 的最低阶，这可以近似为：\n$$d_L(z; \\Omega_m) \\approx \\frac{cz}{H_0}\\left[1 + \\left(1-\\frac{3\\Omega_m}{4}\\right)z\\right].$$\n假设所有Ia型超新星都具有恒定且相同的内禀绝对星等 $M$。视星等 $m$ 通过距离模数公式与光度距离相关联：$\\mu = m - M = 5 \\log_{10}(d_L/\\text{Mpc}) + 25$。\n\nIa型超新星的宿主星系除了哈勃流之外，还具有本动速度 $v_p$。这些速度被建模为从均值为零、标准差为 $\\sigma_v$ 的高斯分布中抽取的随机变量，其中 $v_p \\ll c$。沿视线方向的本动速度会改变超新星的观测红移 $z_{obs}$ 和观测视星等 $m_{obs}$，使其与在宇宙静止坐标系中的值（$z_c$, $m_{cosmo}$）不同。对于 $v_p/c$ 的一阶项，这些关系是：\n$$1+z_{obs} = (1+z_c)\\left(1+\\frac{v_p}{c}\\right)$$\n$$m_{obs} = m_{cosmo} - \\frac{5}{c \\ln 10} v_p$$\n其中正的 $v_p$ 对应于朝向观测者的运动。\n\n该巡天是星等限制的，在 $m_{lim}$ 处有一个尖锐的探测阈值：只有当 $m_{obs}  m_{lim}$ 时，超新星才会被探测到。巡天的设置使得星等极限等于在没有本动速度的情况下，红移为 $z_c$ 的超新星的预期视星等，即 $m_{lim} = m_{cosmo}(z_c)$。\n\n一位分析师未意识到这种选择效应，使用探测到的超新星样本来估计 $\\Omega_m$。他们计算了样本的平均观测星等 $\\bar{m}_{obs}$ 和平均观测红移 $\\bar{z}_{obs}$。然后，他们通过假设这些平均值满足标准宇宙学关系，即 $\\bar{m}_{obs}$ 对应于光度距离 $d_L(\\bar{z}_{obs}; \\Omega_{m,inf})$，来确定推断出的物质密度 $\\Omega_{m,inf}$。\n\n计算由于忽略此选择偏误而引起的对物质密度参数的系统误差 $\\Delta\\Omega_m = \\Omega_{m,inf} - \\Omega_{m,0}$。给出答案至 $z_c$ 的主导阶。最终表达式应以 $z_c$、$\\sigma_v$、$c$ 和基本数学常数表示。", "solution": "解题过程分为四个主要步骤：\n1.  确定由于选择效应导致的探测到的超新星样本的有偏平均本动速度 $\\delta v = \\langle v_p \\rangle$。\n2.  将推断出的宇宙学参数与真实参数和速度偏置联系起来。\n3.  使用光度距离的低红移近似来计算必要的导数。\n4.  结合这些结果求出系统误差 $\\Delta\\Omega_m$。\n\n**步骤1：计算平均本动速度偏置**\n\n当超新星的视星等 $m_{obs}$ 小于极限值 $m_{lim}$ 时，巡天会探测到它。条件是：\n$$m_{obs}  m_{lim}$$\n使用给定的关系 $m_{obs} = m_{cosmo} - \\frac{5}{c \\ln 10} v_p$ 和 $m_{lim} = m_{cosmo}$，选择判据变为：\n$$m_{cosmo} - \\frac{5}{c \\ln 10} v_p  m_{cosmo}$$\n$$-\\frac{5}{c \\ln 10} v_p  0$$\n由于 $\\frac{5}{c \\ln 10}$ 是正的，这简化为 $v_p > 0$。这意味着巡天只探测到宿主星系朝向观测者运动的超新星。\n\n本动速度 $v_p$ 从高斯分布 $P(v_p) = \\frac{1}{\\sqrt{2\\pi}\\sigma_v} \\exp\\left(-\\frac{v_p^2}{2\\sigma_v^2}\\right)$ 中抽取。所选样本的平均本动速度 $\\delta v = \\langle v_p \\rangle_{sel}$ 是此分布在 $v_p > 0$ 上截断后的均值。\n$$\\delta v = \\langle v_p \\rangle_{sel} = \\frac{\\int_0^\\infty v_p P(v_p) dv_p}{\\int_0^\\infty P(v_p) dv_p}$$\n分母是对称高斯分布在其一半范围上的积分，其值为 $1/2$。\n$$\\int_0^\\infty P(v_p) dv_p = \\frac{1}{2}$$\n分子是：\n$$\\int_0^\\infty v_p \\frac{1}{\\sqrt{2\\pi}\\sigma_v} e^{-\\frac{v_p^2}{2\\sigma_v^2}} dv_p = \\frac{1}{\\sqrt{2\\pi}\\sigma_v} \\left[-\\sigma_v^2 e^{-\\frac{v_p^2}{2\\sigma_v^2}}\\right]_0^\\infty = \\frac{1}{\\sqrt{2\\pi}\\sigma_v} (0 - (-\\sigma_v^2)) = \\frac{\\sigma_v}{\\sqrt{2\\pi}}$$\n因此，有偏的平均本动速度是：\n$$\\delta v = \\frac{\\sigma_v/\\sqrt{2\\pi}}{1/2} = \\frac{2\\sigma_v}{\\sqrt{2\\pi}} = \\sqrt{\\frac{2}{\\pi}} \\sigma_v$$\n\n**步骤2：将推断参数与偏置联系起来**\n\n分析师假设平均可观测量 $(\\bar{z}_{obs}, \\bar{m}_{obs})$ 遵循标准宇宙学关系，该关系通过推断的光度距离 $d_L(\\bar{z}_{obs}; \\Omega_{m,inf})$ 将它们联系起来。距离模数方程给出：\n$$5 \\log_{10}(d_L(\\bar{z}_{obs}; \\Omega_{m,inf})) = \\bar{m}_{obs} - M - 25$$\n真实的宇宙学模型关联了未受扰动的量：\n$$5 \\log_{10}(d_L(z_c; \\Omega_{m,0})) = m_{cosmo} - M - 25$$\n平均观测星等为 $\\bar{m}_{obs} = \\langle m_{cosmo} - \\frac{5}{c\\ln 10}v_p \\rangle_{sel} = m_{cosmo} - \\frac{5}{c\\ln 10} \\delta v$。\n将此代入第一个方程：\n$$5 \\log_{10}(d_L(\\bar{z}_{obs}; \\Omega_{m,inf})) = \\left(m_{cosmo} - \\frac{5}{c\\ln 10} \\delta v\\right) - M - 25$$\n使用第二个方程替换 $(m_{cosmo} - M - 25)$，我们得到：\n$$5 \\log_{10}(d_L(\\bar{z}_{obs}; \\Omega_{m,inf})) = 5 \\log_{10}(d_L(z_c; \\Omega_{m,0})) - \\frac{5}{c\\ln 10} \\delta v$$\n$$\\log_{10}(d_L(\\bar{z}_{obs}; \\Omega_{m,inf})) = \\log_{10}(d_L(z_c; \\Omega_{m,0})) - \\frac{\\delta v}{c\\ln 10}$$\n从 $\\log_{10}$ 转换为 $\\ln$：\n$$\\ln(d_L(\\bar{z}_{obs}; \\Omega_{m,inf})) = \\ln(d_L(z_c; \\Omega_{m,0})) - \\frac{\\delta v}{c}$$\n平均观测红移为 $\\bar{z}_{obs} = \\langle z_c + (1+z_c)v_p/c \\rangle_{sel} = z_c + (1+z_c)\\delta v/c$。令 $\\delta z = \\bar{z}_{obs} - z_c = (1+z_c)\\delta v/c$。\n我们有一个小的系统误差 $\\Delta\\Omega_m = \\Omega_{m,inf} - \\Omega_{m,0}$。我们在 $(z_c, \\Omega_{m,0})$ 附近将 $\\ln d_L$ 方程的左侧线性化：\n$$\\ln(d_L(z_c+\\delta z; \\Omega_{m,0}+\\Delta\\Omega_m)) \\approx \\ln(d_L(z_c; \\Omega_{m,0})) + \\frac{\\partial \\ln d_L}{\\partial z}\\bigg|_{(z_c, \\Omega_{m,0})} \\delta z + \\frac{\\partial \\ln d_L}{\\partial \\Omega_m}\\bigg|_{(z_c, \\Omega_{m,0})} \\Delta\\Omega_m$$\n将此代回，我们得到：\n$$\\frac{\\partial \\ln d_L}{\\partial z} \\delta z + \\frac{\\partial \\ln d_L}{\\partial \\Omega_m} \\Delta\\Omega_m \\approx -\\frac{\\delta v}{c}$$\n代入 $\\delta z = (1+z_c)\\delta v/c$：\n$$\\left(\\frac{\\partial \\ln d_L}{\\partial z} (1+z_c) + 1\\right)\\frac{\\delta v}{c} + \\frac{\\partial \\ln d_L}{\\partial \\Omega_m} \\Delta\\Omega_m \\approx 0$$\n$$\\Delta\\Omega_m \\approx -\\frac{\\delta v/c}{\\frac{\\partial \\ln d_L}{\\partial \\Omega_m}} \\left(1 + (1+z_c)\\frac{\\partial \\ln d_L}{\\partial z}\\right)$$\n\n**步骤3：低红移近似**\n\n我们使用所提供的 $d_L$ 的低红移近似：\n$$d_L(z; \\Omega_m) \\approx \\frac{cz}{H_0}\\left[1 + \\left(1-\\frac{3\\Omega_m}{4}\\right)z\\right]$$\n取自然对数：\n$$\\ln d_L \\approx \\ln\\left(\\frac{cz}{H_0}\\right) + \\ln\\left[1 + \\left(1-\\frac{3\\Omega_m}{4}\\right)z\\right]$$\n对于 $z \\ll 1$，我们可以近似 $\\ln(1+x) \\approx x$：\n$$\\ln d_L \\approx \\ln\\left(\\frac{cz}{H_0}\\right) + \\left(1-\\frac{3\\Omega_m}{4}\\right)z$$\n现在，我们计算在 $(z_c, \\Omega_{m,0})$ 处的偏导数：\n$$\\frac{\\partial \\ln d_L}{\\partial \\Omega_m} \\approx -\\frac{3z_c}{4}$$\n$$\\frac{\\partial \\ln d_L}{\\partial z} \\approx \\frac{1}{z_c} + \\left(1-\\frac{3\\Omega_{m,0}}{4}\\right)$$\n我们将关于 $z$ 的导数代入 $\\Delta\\Omega_m$ 的表达式中：\n$$1 + (1+z_c)\\frac{\\partial \\ln d_L}{\\partial z} \\approx 1 + (1+z_c)\\left[\\frac{1}{z_c} + 1-\\frac{3\\Omega_{m,0}}{4}\\right] = 1 + \\left(\\frac{1}{z_c}+1+1-\\frac{3\\Omega_{m,0}}{4}\\right) + O(z_c) = \\frac{1}{z_c} + 3-\\frac{3\\Omega_{m,0}}{4} + O(z_c)$$\n由于 $z_c \\ll 1$，项 $1/z_c$ 是主导项。因此，到 $z_c$ 的主导阶：\n$$1 + (1+z_c)\\frac{\\partial \\ln d_L}{\\partial z} \\approx \\frac{1}{z_c}$$\n\n**步骤4：$\\Delta\\Omega_m$ 的最终计算**\n\n将主导阶项代入 $\\Delta\\Omega_m$ 的表达式中：\n$$\\Delta\\Omega_m \\approx -\\frac{\\delta v/c}{(-3z_c/4)} \\left(\\frac{1}{z_c}\\right)$$\n$$\\Delta\\Omega_m \\approx \\frac{4\\delta v}{3cz_c^2}$$\n最后，我们代入 $\\delta v = \\sqrt{2/\\pi} \\sigma_v$ 的表达式：\n$$\\Delta\\Omega_m \\approx \\frac{4}{3cz_c^2} \\sqrt{\\frac{2}{\\pi}} \\sigma_v$$", "answer": "$$ \\boxed{\\frac{4\\sigma_v}{3cz_c^2}\\sqrt{\\frac{2}{\\pi}}} $$", "id": "842065"}, {"introduction": "除了分析现有数据，宇宙学研究的一个关键部分是设计未来的实验，使其尽可能强大。本练习将介绍费雪矩阵（Fisher matrix），这是一个用于预测巡天项目约束能力的基本工具。你将解决一个简化的巡天优化问题：确定观测超新星的最佳红移，以最大限度地获取关于暗能量状态方程参数 $w$ 的信息 [@problem_id:842052]。", "problem": "费雪信息矩阵是宇宙学中一个强大的工具，用于预测未来实验的约束能力。对于Ia型超新星巡天，一组宇宙学参数 $\\{\\theta_\\alpha\\}$ 的费雪矩阵可以通过对所有观测到的超新星求和来近似。在超新星连续分布的极限情况下，这个求和变成了对红移 $z$ 的积分：\n\n$$ F_{\\alpha\\beta} = \\int_0^{z_{\\text{max}}} \\frac{1}{\\sigma_{\\mu}(z)^2} \\frac{\\partial \\mu(z)}{\\partial \\theta_\\alpha} \\frac{\\partial \\mu(z)}{\\partial \\theta_\\beta} n(z) dz $$\n\n其中 $n(z) \\equiv dN/dz$ 是观测到的超新星的红移分布，$\\mu(z)$ 是距离模数，$\\sigma_\\mu(z)$ 是在红移 $z$ 处距离模数测量的总不确定度。超新星的总数是固定的， $N_{\\text{tot}} = \\int_0^{z_{\\text{max}}} n(z) dz$。\n\n考虑一个简化问题，我们希望优化一个巡天策略来约束单个暗能量参数 $w$。在这种情况下，品质因数通过最大化单个费雪矩阵元素 $F_{ww}$ 来实现最大化。我们希望最大化的积分是：\n\n$$ F_{ww} = \\int_0^\\infty n(z) S(z) dz $$\n\n其中 $S(z) = \\frac{1}{\\sigma_{\\mu}(z)^2} \\left( \\frac{\\partial \\mu(z)}{\\partial w} \\right)^2$ 是灵敏度函数。为了在超新星总数 $N_{\\text{tot}}$ 固定的情况下最大化该积分，最优策略是将所有观测集中在灵敏度函数 $S(z)$ 达到其全局最大值的单个红移 $z^*$ 处。由此产生的分布将是一个狄拉克 $\\delta$ 函数， $n(z) = N_{\\text{tot}} \\delta(z - z^*)$。\n\n你的任务是确定这个最优红移 $z^*$。对于这个问题，假设一个假想的巡天，其中距离模数的测量不确定度以及其对参数 $w$ 的灵敏度由以下模型给出：\n\n1.  距离模数的不确定度模型为 $\\sigma_{\\mu}(z) = \\sigma_m \\frac{z}{1+z}$，其中 $\\sigma_m$ 是一个常数，代表内禀星等弥散和高红移不确定度下限。\n\n2.  距离模数对暗能量参数 $w$ 的灵敏度模型为 $\\frac{\\partial \\mu(z)}{\\partial w} = A z^{\\alpha} (1+z)^{-\\beta}$，其中 $A$、$\\alpha$ 和 $\\beta$ 是取决于基本宇宙学的正常数。\n\n在 $\\alpha=2$ 和 $\\beta=3$ 的特定情况下，求出使费雪信息 $F_{ww}$ 最大化的最优红移 $z^*$ 的精确值。", "solution": "1. 灵敏度函数为\n$$\nS(z)=\\frac{1}{\\sigma_\\mu(z)^2}\\Bigl(\\frac{\\partial\\mu}{\\partial w}\\Bigr)^2\n=\\frac{1}{\\bigl(\\sigma_m\\frac{z}{1+z}\\bigr)^2}\\,\\bigl(A z^\\alpha(1+z)^{-\\beta}\\bigr)^2.\n$$\n\n2. 对于 $\\alpha=2,\\;\\beta=3$，该式变为\n$$\nS(z)\n=\\frac{A^2z^{4}(1+z)^{-6}}{\\sigma_m^2\\,z^2(1+z)^{-2}}\n=\\frac{A^2}{\\sigma_m^2}\\;z^2(1+z)^{-4}.\n$$\n\n3. 为了找到 $S(z)$ 的最大值（等价于找到 $z^2(1+z)^{-4}$ 的最大值），计算\n$$\n\\frac{d}{dz}\\bigl[z^2(1+z)^{-4}\\bigr]\n=2z(1+z)^{-4}-4z^2(1+z)^{-5}\n=z(1+z)^{-5}\\bigl[2(1+z)-4z\\bigr]\n$$\n并令其为零：\n$$\n2(1+z)-4z=0\\quad\\Rightarrow\\quad2-2z=0\\quad\\Rightarrow\\quad z=1.\n$$\n\n4. 检查二阶导数可以确认这是一个最大值。因此\n$$\nz^*=1.\n$$", "answer": "$$\\boxed{1}$$", "id": "842052"}, {"introduction": "Ia型超新星作为宇宙学探针的威力，取决于我们利用经验性的光变曲线关系将其“标准化”的能力。但如果这个经验模型本身并不完备呢？最后的这个练习将探讨一个微妙的、未被建模的超新星物理特性，会如何传递并最终导致暗能量状态方程参数 $w$ 的测量出现显著的系统性偏差 [@problem_id:842001]。这个实践突显了天体物理学理解与宇宙学结论之间至关重要的相互作用。", "problem": "Ia型超新星（SNe Ia）是用于测量宇宙膨胀历史的强大宇宙学探针。它们作为“可标准化的烛光”，意味着它们的峰值内禀光度可以从光变曲线的性质中推断出来。Ia型超新星在峰值亮度时的绝对星等 $M$ 的标准经验模型由下式给出：\n$$M = M_B - \\alpha x_1 + \\beta c$$\n其中 $x_1$ 是光变曲线的拉伸度（衡量其持续时间的量），$c$ 是其在峰值亮度时的颜色。参数 $M_B$、$\\alpha$ 和 $\\beta$ 是讨厌参数，通常使用大量的超新星数据集与宇宙学参数同时进行拟合。\n\n观测到的视星等 $m$ 通过距离模数 $\\mu$ 与绝对星等和光度距离 $d_L$ 相关联：\n$$\\mu(z) = m - M = 5 \\log_{10}\\left(\\frac{d_L(z)}{10 \\text{ pc}}\\right)$$\n在一个平坦的弗里德曼-勒梅特-罗伯逊-沃尔克（FLRW）宇宙中，红移为 $z$ 的物体的光度距离由下式给出：\n$$d_L(z) = \\frac{c(1+z)}{H_0} \\int_0^z \\frac{dz'}{\\sqrt{\\Omega_{m,0}(1+z')^3 + (1-\\Omega_{m,0})(1+z')^{3(1+w)}}}$$\n其中 $c$ 是光速，$H_0$ 是哈勃常数，$\\Omega_{m,0}$ 是当今的物质密度参数，$w$ 是暗能量的状态方程参数，假定为常数。\n\n现在，考虑一种情景，其中Ia型超新星的真实绝对星等对在峰值亮度时评估的颜色时间导数 $\\dot{c} = dc/dt$ 有额外的依赖性。具体来说，真实的绝对星等是：\n$$M_{true} = M_B - \\alpha x_1 + \\beta c - \\gamma \\dot{c}$$\n其中 $\\gamma$ 是一个常数。假设进行了一项宇宙学分析，但该分析没有意识到这个附加项。此外，假设对于所使用的超新星样本，这个新参数 $\\dot{c}$ 的总体平均值随红移线性演化：\n$$\\langle \\dot{c}(z) \\rangle = \\dot{c}_0 + k_c z$$\n其中 $\\dot{c}_0$ 和 $k_c$ 是常数。\n\n对一个低红移（$z \\ll 1$）的超新星样本进行宇宙学拟合，以约束 $w$ 和 $\\Omega_{m,0}$。拟合过程对一个讨厌参数 $\\mathcal{M}$ 进行边缘化，该参数吸收了 $M_B$ 和 $H_0$ 的组合。这种边缘化有效地消除了对距离模数中任何常数偏移的敏感性。\n\n假设真实的底层宇宙学由参数 $w_{true}$ 和 $\\Omega_{m,0}$ 描述，这个未被考虑的系统性效应将在暗能量状态方程的估计中引入一个偏差。计算估计的暗能量状态方程参数中的主导阶偏差 $\\Delta w = w_{est} - w_{true}$。用 $\\gamma$、$k_c$ 和 $\\Omega_{m,0}$ 表示你的答案。", "solution": "1. 未建模的项使拟合的距离模数发生偏移\n   $$\\delta\\mu(z) \\;=\\;\\mu_{\\rm fit}(z)-\\mu_{\\rm true}(z)\\;=\\;-\\,\\gamma\\langle\\dot c(z)\\rangle_{\\rm pop} \n   =-\\gamma(\\dot c_0+k_cz)\\,. $$\n   常数部分 $-\\gamma\\dot c_0$ 被讨厌参数 $\\mathcal M$ 吸收，剩下\n   $$\\delta\\mu(z)=-\\gamma k_c\\,z\\,. $$\n2. 对于一个平坦、常数 $w$ 的宇宙中的 $z\\ll1$，光度距离展开为\n   $$d_L(z)=\\frac{c}{H_0}\\Bigl[z+\\tfrac12(1-q_0)z^2+\\dots\\Bigr],\\quad\n   q_0=\\tfrac12\\bigl[1+3w(1-\\Omega_{m,0})\\bigr]\\,. $$\n   因此\n   $$\\mu(z)=5\\log_{10}d_L+\\text{const}\n     =5\\log_{10}z+\\frac{5}{\\ln10}\\,\\frac{1-q_0}2\\,z+\\mathcal O(z^2)\\,. $$\n3. $\\mu$ 对 $w$ 在 $z$ 的线性阶上的灵敏度为\n   $$\\frac{\\partial\\mu}{\\partial w}\n   =\\frac{5}{\\ln10}\\,\\frac{-1}{2}\\,\\frac{\\partial q_0}{\\partial w}\\,z\n   =-\\frac{5}{2\\ln10}\\cdot\\frac{3}{2}(1-\\Omega_{m,0})\\,z\n   =-\\frac{15(1-\\Omega_{m,0})}{4\\ln10}\\,z\\,. $$\n4. 令 $\\delta\\mu(z)=\\frac{\\partial\\mu}{\\partial w}\\,\\Delta w$ 并消去 $z$ 得到\n   $$-\\gamma k_c\n   =-\\frac{15(1-\\Omega_{m,0})}{4\\ln10}\\,\\Delta w\n   \\;\\;\\longrightarrow\\;\\;\n   \\Delta w\n   =\\frac{4\\ln10}{15(1-\\Omega_{m,0})}\\,\\gamma\\,k_c\\,. $$", "answer": "$$\\boxed{\\frac{4\\ln(10)}{15\\,(1-\\Omega_{m,0})}\\,\\gamma\\,k_c}$$", "id": "842001"}]}