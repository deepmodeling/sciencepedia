{"hands_on_practices": [{"introduction": "放大器的核心功能是提供信号增益。在差分转单端转换电路中，这一增益直接取决于输入晶体管的关键参数——跨导($g_m$)。本练习将引导你通过一个具体的增益目标，反向计算出所需的晶体管跨导，这对于在实际设计中选择和偏置晶体管以满足性能指标至关重要。[@problem_id:1297526]", "problem": "一位工程师正在设计一个音频前置放大器的输入级，该输入级采用一个标准的带有源电流镜负载的差分放大器。该放大器采用金属-氧化物-半导体场效应晶体管（MOSFET）技术构建，并被配置为将差分输入电压转换为单端输出电压。构成差分对的两个输入MOSFET被认为是完美匹配的。\n\n设计规范要求从差分输入到单端输出的电压增益大小为 $|A_v| = 40$。在单端输出节点处的总等效输出电阻，它考虑了驱动晶体管和有源负载的特性，已知为 $R_{out} = 125 \\text{ k}\\Omega$。\n\n为了满足此增益规范，每个输入MOSFET所需的跨导 $g_m$ 是多少？请以毫西门子（mS）为单位表示您的答案，并四舍五入到两位有效数字。", "solution": "对于一个将差分输入转换为单端输出、带有电流镜有源负载的匹配MOS差分对，设差分输入为 $v_{id} = v_{1} - v_{2}$，采用对称驱动，使得 $v_{1} = +\\frac{v_{id}}{2}$ 且 $v_{2} = -\\frac{v_{id}}{2}$。在一个理想的尾电流源下，源极节点是交流地，因此输入晶体管的小信号漏极电流为 $\\Delta i_{1} = g_{m}\\frac{v_{id}}{2}$ 和 $\\Delta i_{2} = -g_{m}\\frac{v_{id}}{2}$。电流镜将 $\\Delta i_{1}$ 复制到输出支路，因此注入到输出节点的净小信号电流为\n$$\n\\Delta i_{o} = \\Delta i_{\\text{mirror}} - \\Delta i_{2} = \\Delta i_{1} - \\Delta i_{2} = g_{m}\\frac{v_{id}}{2} - \\left(-g_{m}\\frac{v_{id}}{2}\\right) = g_{m}v_{id}.\n$$\n在输出节点处，当等效输出电阻为 $R_{out}$ 时，输出电压为\n$$\nv_{o} = -\\Delta i_{o}R_{out} = -g_{m}R_{out}\\,v_{id},\n$$\n因此差分到单端的电压增益为\n$$\nA_{v} = \\frac{v_{o}}{v_{id}} = -g_{m}R_{out}, \\quad |A_{v}| = g_{m}R_{out}.\n$$\n求解 $g_{m}$ 可得\n$$\ng_{m} = \\frac{|A_{v}|}{R_{out}}.\n$$\n代入 $|A_{v}| = 40$ 和 $R_{out} = 125 \\times 10^{3}\\ \\Omega$，\n$$\ng_{m} = \\frac{40}{125 \\times 10^{3}}\\ \\text{S} = 3.2 \\times 10^{-4}\\ \\text{S} = 0.32\\ \\text{mS}.\n$$\n四舍五入到两位有效数字，每个输入MOSFET所需的跨导为 $0.32\\ \\text{mS}$。", "answer": "$$\\boxed{0.32}$$", "id": "1297526"}, {"introduction": "掌握了小信号增益的计算后，我们必须考虑放大器在实际工作中的大信号限制。输出电压的摆动范围并非无限，它受到电源电压以及晶体管必须保持在有效工作区的严格约束。本练习将通过分析BJT差分放大器，帮助你确定其输出电压的上限和下限，从而理解晶体管饱和是如何限制电路的线性工作范围的。[@problem_id:1297527]", "problem": "考虑一个用于差分转单端信号转换的双极结型晶体管 (BJT) 差分放大器电路。该放大器由两个相同的NPN型晶体管 $Q_1$ 和 $Q_2$ 构成，它们的发射极连接在一起，然后通过一个吸收电流为 $I_{EE}$ 的理想恒流源连接到负电源 $-V_{CC}$。$Q_1$ 和 $Q_2$ 的集电极分别通过相同的电阻 $R_C$ 连接到正电源 $+V_{CC}$。\n\n一个差分输入电压 $v_{id} = v_{B1} - v_{B2}$ 被施加在晶体管的基极之间，并叠加在零伏的共模电压 $V_{CM} = 0.0$ V 上。单端输出 $v_o$ 从晶体管 $Q_2$ 的集电极取出。\n\n电路的工作参数如下：\n- 电源电压: $V_{CC} = 15.0$ V\n- 尾电流: $I_{EE} = 2.00$ mA\n- 集电极电阻: $R_C = 12.0$ k$\\Omega$\n- 正向有源区基极-发射极电压: $V_{BE(on)} = 0.70$ V\n- 集电极-发射极饱和电压: $V_{CE(sat)} = 0.20$ V\n\n假设晶体管完全匹配，基极电流可忽略（即电流增益 $\\beta$ 为无穷大），并且尾电流源是理想的。\n\n确定定义放大器线性工作范围的最大正输出电压 ($V_{O,max}$) 和最小负输出电压 ($V_{O,min}$)。线性范围定义为两个晶体管都保持在正向有源区的 $v_o$ 范围。\n\n答案以伏特为单位，四舍五入到三位有效数字。将最终答案以行矩阵的形式 $\\begin{pmatrix} V_{O,max} & V_{O,min} \\end{pmatrix}$ 给出。", "solution": "问题要求计算晶体管 $Q_2$ 集电极上的最大和最小输出电压 ($V_{O,max}$ 和 $V_{O,min}$)，使得晶体管 $Q_1$ 和 $Q_2$ 都保持在正向有源区。这意味着两个晶体管都不能进入截止区或饱和区。\n\n输出电压由 $v_o = v_{C2} = V_{CC} - I_{C2} R_C$ 给出。根据 Kirchhoff 电流定律，在公共发射极节点处，两个晶体管中的电流关系为：$I_{C1} + I_{C2} \\approx I_{E1} + I_{E2} = I_{EE}$，因为基极电流可忽略不计。\n\n一个 NPN 型 BJT 处在正向有源区的条件是 $V_{BE} = V_{BE(on)}$ 且 $V_{CE} > V_{CE(sat)}$。该区域的边界是饱和区，此时 $V_{CE} = V_{CE(sat)}$。因此，饱和时的集电极电压为 $V_{C,sat} = V_E + V_{CE(sat)}$，其中 $V_E$ 是发射极电压。\n\n对于差分放大器，发射极电压 $V_E$ 随差分输入 $v_{id}$ 轻微变化。然而，在初步分析中，我们可以将发射极电压 $V_E$ 近似为其静态值 $V_{EQ}$。静态发射极电压由共模输入电压 $V_{CM}$ 决定。\n$$V_E \\approx V_{EQ} = V_{CM} - V_{BE(on)}$$\n已知 $V_{CM} = 0.0$ V 且 $V_{BE(on)} = 0.70$ V:\n$$V_E \\approx 0.0 - 0.70 = -0.70 \\text{ V}$$\n\n**步骤 1：计算最小输出电压 ($V_{O,min}$)**\n\n$Q_2$ 集电极的最小输出电压 $V_{O,min}$ 出现在电流 $I_{C2}$ 达到最大值时。这种情况发生在输入电压 $v_{id}$ 足够大，将大部分尾电流 $I_{EE}$ 引导通过 $Q_2$ 时。随着 $I_{C2}$ 的增加，输出电压 $v_o = v_{C2}$ 减小。当晶体管 $Q_2$ 进入饱和区时，达到下限。\n\n$Q_2$ 的饱和条件是 $V_{C2} = V_{CE(sat)} + V_E$。使用我们对 $V_E$ 的近似值：\n$$V_{O,min} = V_{C2,sat} = V_E + V_{CE(sat)} \\approx V_{EQ} + V_{CE(sat)}$$\n代入给定值：\n$$V_{O,min} = -0.70 \\text{ V} + 0.20 \\text{ V} = -0.50 \\text{ V}$$\n四舍五入到三位有效数字， $V_{O,min} = -0.500$ V。\n\n此时，电流 $I_{C2}$ 将是 $I_{C2} = \\frac{V_{CC} - V_{O,min}}{R_C} = \\frac{15.0 - (-0.50)}{12.0 \\times 10^3} = \\frac{15.5}{12.0} \\text{ mA} \\approx 1.29$ mA。这小于总尾电流 $I_{EE} = 2.00$ mA，这是合理的，因为 $Q_1$ 仍会导通剩余的电流 ($2.00 - 1.29 = 0.71$ mA)。\n\n**步骤 2：计算最大输出电压 ($V_{O,max}$)**\n\n$Q_2$ 集电极的最大输出电压 $V_{O,max}$ 出现在电流 $I_{C2}$ 达到最小值时。这种情况发生在输入电压 $v_{id}$ 足够小（负值），将大部分尾电流 $I_{EE}$ 引导通过 $Q_1$ 时。随着 $I_{C2}$ 的减小， $v_o = v_{C2}$ 增大。\n\n如果 $Q_2$ 进入截止区（$I_{C2}=0$），输出电压将上升到 $V_{CC}=15.0$ V。但是，我们必须检查晶体管 $Q_1$ 的状态。因为 $I_{C1} = I_{EE} - I_{C2}$，当 $I_{C2}$ 减小时，$I_{C1}$ 增加。增大的电流 $I_{C1}$ 会导致 $Q_1$ 的集电极电压 $V_{C1} = V_{CC} - I_{C1}R_C$ 下降。输出电压 $v_o$ 的上限摆幅受限于晶体管 $Q_1$ 的饱和。\n\n$Q_1$ 的饱和条件是 $V_{C1} = V_E + V_{CE(sat)}$。使用我们对 $V_E$ 的近似值：\n$$V_{C1,sat} = V_E + V_{CE(sat)} \\approx V_{EQ} + V_{CE(sat)} = -0.70 \\text{ V} + 0.20 \\text{ V} = -0.50 \\text{ V}$$\n所以，当 $Q_1$ 的集电极电压下降到 $-0.50$ V 时，它进入饱和区。我们可以计算出此时的电流 $I_{C1}$：\n$$V_{C1,sat} = V_{CC} - I_{C1,sat} R_C$$\n$$I_{C1,sat} = \\frac{V_{CC} - V_{C1,sat}}{R_C} = \\frac{15.0 \\text{ V} - (-0.50 \\text{ V})}{12.0 \\times 10^3 \\text{ }\\Omega} = \\frac{15.5 \\text{ V}}{12.0 \\text{ k}\\Omega} \\approx 1.29167 \\text{ mA}$$\n这个电流 $I_{C1,sat}$ 是 $Q_1$ 在饱和前能通过的最大电流。\n\n$Q_2$ 中对应的电流是：\n$$I_{C2} = I_{EE} - I_{C1,sat} = 2.00 \\text{ mA} - 1.29167 \\text{ mA} = 0.70833 \\text{ mA}$$\n$Q_2$ 中的这个最小电流（在保持 $Q_1$ 处于有源区的同时）决定了最大输出电压 $V_{O,max}$。\n$$V_{O,max} = V_{CC} - I_{C2} R_C = 15.0 \\text{ V} - (0.70833 \\times 10^{-3} \\text{ A})(12.0 \\times 10^3 \\text{ }\\Omega)$$\n$$V_{O,max} = 15.0 \\text{ V} - 8.50 \\text{ V} = 6.50 \\text{ V}$$\n四舍五入到三位有效数字， $V_{O,max} = 6.50$ V。\n\n**步骤 3：最终答案格式化**\n\n最大和最小输出电压分别为 $V_{O,max} = 6.50$ V 和 $V_{O,min} = -0.500$ V。结果必须以行矩阵的形式呈现。\n$$ \\begin{pmatrix} V_{O,max} & V_{O,min} \\end{pmatrix} = \\begin{pmatrix} 6.50 & -0.500 \\end{pmatrix} $$", "answer": "$$\\boxed{\\begin{pmatrix} 6.50 & -0.500 \\end{pmatrix}}$$", "id": "1297527"}, {"introduction": "差分放大器的一个关键优势在于其抑制共模信号的能力，这一性能通过共模抑制比(CMRR)来衡量。在实际电路中，由于尾电流源并非理想，其有限的输出电阻($R_{SS}$)会降低CMRR。本练习模拟了一个典型的设计场景：为了达到系统要求的80 dB的CMRR，你需要计算尾电流源所需的最小输出电阻，从而将宏观性能指标与具体的电路参数联系起来。[@problem_id:1297522]", "problem": "一位模拟集成电路设计师正在使用一个基本的 NMOS 差分对来设计一个差分转单端转换器。该放大器的每个晶体管的漏极都连接了一个电阻负载 $R_D$。输出电压从其中一个晶体管的漏极获取，而另一个晶体管的漏极也连接到同样值为 $R_D$ 的负载电阻，以保持电路的对称性。该差分对由一个非理想的尾电流源偏置，该电流源提供总直流电流 $I_{TAIL}$，并具有有限的输出电阻 $R_{SS}$。\n\n为电路设计提供了以下参数：\n- 工艺跨导参数：$\\mu_n C_{ox} = 200 \\; \\mu\\text{A}/\\text{V}^2$\n- 两个晶体管的宽长比：$(W/L) = 50$\n- 负载电阻：$R_D = 10 \\; \\text{k}\\Omega$\n- 总尾偏置电流：$I_{TAIL} = 0.5 \\; \\text{mA}$\n\n设计必须达到至少 80 dB 的共模抑制比 (CMRR)。\n\n在分析中，假设两个 NMOS 晶体管完全匹配，工作在饱和区，并且具有无限大的本征输出电阻 ($r_o \\to \\infty$)。您也可以忽略体效应。\n\n确定尾电流源所需的最小输出电阻 $R_{SS}$，以满足此 CMRR 规范。请用兆欧 ($\\text{M}\\Omega$) 表示您的答案，并四舍五入到三位有效数字。", "solution": "在小信号模型下分析 NMOS 差分对，假设晶体管匹配，$r_{o} \\to \\infty$，且体效应可忽略不计。令 $k \\equiv \\mu_{n} C_{ox} (W/L)$，并设每个晶体管的静态漏极电流为 $I_{D} = I_{TAIL}/2$。\n\n每个晶体管在饱和区的跨导可由平方率模型得到：\n$$\nI_{D} = \\frac{1}{2} k V_{ov}^{2}, \\quad g_{m} = k V_{ov} = \\sqrt{2 k I_{D}}.\n$$\n\n通过用 $v_{g1} = +v_{id}/2$ 和 $v_{g2} = -v_{id}/2$ 驱动栅极，可以找到到单端输出的差模增益。对于理想的差分激励，源极节点处于交流地，因此 $v_{s} = 0$。所观察一侧的小信号漏极电流为 $i_{d1} = g_{m} (v_{id}/2)$，并且漏极负载 $R_{D}$ 接到交流地，\n$$\nA_{d} \\equiv \\frac{v_{o}}{v_{id}} = - \\frac{g_{m} R_{D}}{2}.\n$$\n\n对于共模激励，$v_{g1} = v_{g2} = v_{cm}$，源极节点电压 $v_{s}$ 由源极节点的 KCL（包括尾电阻 $R_{SS}$）确定：\n$$\n2 g_{m} (v_{cm} - v_{s}) = \\frac{v_{s}}{R_{SS}} \\;\\;\\Rightarrow\\;\\; v_{s} = \\frac{2 g_{m} R_{SS}}{1 + 2 g_{m} R_{SS}} \\, v_{cm}.\n$$\n任意一侧的漏极电流为 $i_{d} = g_{m} (v_{cm} - v_{s}) = \\dfrac{g_{m}}{1 + 2 g_{m} R_{SS}} \\, v_{cm}$，因此单端共模增益为\n$$\nA_{cm} \\equiv \\frac{v_{o}}{v_{cm}} = - \\frac{g_{m} R_{D}}{1 + 2 g_{m} R_{SS}}.\n$$\n\n因此，单端 CMRR 的幅值为\n$$\n\\mathrm{CMRR} = \\left|\\frac{A_{d}}{A_{cm}}\\right| = \\frac{\\frac{g_{m} R_{D}}{2}}{\\frac{g_{m} R_{D}}{1 + 2 g_{m} R_{SS}}} = \\frac{1 + 2 g_{m} R_{SS}}{2}.\n$$\n技术规范要求 $20 \\log_{10}(\\mathrm{CMRR}) \\geq 80$，即\n$$\n\\mathrm{CMRR} \\geq 10^{\\frac{80}{20}} = 10^{4}.\n$$\n因此，\n$$\n\\frac{1 + 2 g_{m} R_{SS}}{2} \\geq 10^{4} \\;\\;\\Rightarrow\\;\\; 1 + 2 g_{m} R_{SS} \\geq 2 \\times 10^{4} \\;\\;\\Rightarrow\\;\\; R_{SS} \\geq \\frac{2 \\times 10^{4} - 1}{2 g_{m}}.\n$$\n\n现在根据给定参数计算 $g_{m}$。其中 $k = \\mu_{n} C_{ox} (W/L)$ 且 $I_{D} = I_{TAIL}/2$，\n$$\nk = (200 \\times 10^{-6}) \\times 50 = 0.01 \\;\\text{A/V}^{2}, \\quad I_{D} = \\frac{0.5 \\times 10^{-3}}{2} = 0.25 \\times 10^{-3} \\;\\text{A},\n$$\n$$\ng_{m} = \\sqrt{2 k I_{D}} = \\sqrt{2 \\times 0.01 \\times 0.25 \\times 10^{-3}} = \\sqrt{5} \\times 10^{-3} \\;\\text{S}.\n$$\n因此，\n$$\nR_{SS,\\min} = \\frac{2 \\times 10^{4} - 1}{2 \\sqrt{5} \\times 10^{-3}} \\;\\text{}\\Omega = \\left(\\frac{19999}{2 \\sqrt{5}}\\right) \\times 10^{3} \\;\\text{}\\Omega.\n$$\n转换为兆欧得到\n$$\nR_{SS,\\min} = \\left(\\frac{19999}{2 \\sqrt{5}}\\right) \\times 10^{-3} \\;\\text{M}\\Omega \\approx 4.4719 \\;\\text{M}\\Omega.\n$$\n以兆欧为单位，四舍五入到三位有效数字，结果是 $4.47$。", "answer": "$$\\boxed{4.47}$$", "id": "1297522"}]}