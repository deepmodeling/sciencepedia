{"hands_on_practices": [{"introduction": "源极跟随器（或共漏极）电路是模拟设计中的基本单元。它具有高输入阻抗和低输出阻抗的特性，常被用作电压缓冲器以隔离电路的不同部分。通过分析这个采用PMOS管实现的电平转换器，我们将深入理解其小信号电压增益，并特别关注体效应（body effect）对电路性能的影响 [@problem_id:1323366]。", "problem": "考虑一个电平转换电路，它由单个p沟道增强型金属-氧化物-半导体场效应晶体管 (PMOS) 构成，记为 $M_1$。$M_1$ 的漏极接地 (0 V)。$M_1$ 的源极连接到一个电阻 $R_S$，该电阻的另一端连接到负直流电源电压。晶体管的体（衬底）也接地。输入是一个交流小信号电压 $v_{in}$，施加在 $M_1$ 的栅极上。输出 $v_{out}$ 从 $M_1$ 的源极获取。\n\n对于小信号分析，该晶体管由其跨导 $g_m$、其本征输出电阻 $r_o$ 以及其体效应跨导 $g_{mb}$ 来表征，其中 $g_{mb}$ 用于说明源-体电压的影响。\n\n确定电路的输入阻抗 $Z_{in}$ 及其小信号电压增益 $A_v = v_{out}/v_{in}$。将您的答案对 $(Z_{in}, A_v)$ 以 $1 \\times 2$ 行矩阵的形式表示为单个符号表达式，并用给定的参数表示。", "solution": "设小信号栅极、源极、漏极和体电压分别记为 $v_{g}$、$v_{s}$、$v_{d}$ 和 $v_{b}$。在交流小信号模型中，直流电源视为交流地，因此 $v_{d}=0$ （漏极接地），负电源为交流地（$R_{S}$ 的下端为交流地），且 $v_{b}=0$ （体接地）。输入为 $v_{in}=v_{g}$，输出为 $v_{out}=v_{s}$。\n\n使用混合-$\\pi$ 小信号模型，其中包含：\n- 漏极和源极之间的一个电阻 $r_{o}$。\n- 从漏极到源极的一个受控电流源，其值为 $i_{d}=g_{m}v_{gs}+g_{mb}v_{bs}$，其中 $v_{gs}=v_{g}-v_{s}$ 且 $v_{bs}=v_{b}-v_{s}$。\n\n输入阻抗。在此模型中，MOS栅极不吸取直流或低频小信号电流（不包括栅漏电流或电容），因此 $i_{in}=0$，从而\n$$\nZ_{in}=\\frac{v_{in}}{i_{in}}=\\infty.\n$$\n\n电压增益。在源节点处列写KCL方程。从源节点流向交流地的电流分别通过 $R_{S}$ 和 $r_{o}$，大小分别为 $v_{s}/R_{S}$ 和 $v_{s}/r_{o}$。受控电流源将电流 $i_{d}$ 从漏极（地）注入源节点，其中\n$$\ni_{d}=g_{m}v_{gs}+g_{mb}v_{bs}=g_{m}(v_{g}-v_{s})+g_{mb}(0-v_{s})=g_{m}v_{g}-(g_{m}+g_{mb})v_{s}.\n$$\n源节点的KCL方程为\n$$\n\\frac{v_{s}}{R_{S}}+\\frac{v_{s}}{r_{o}}=i_{d}=g_{m}v_{g}-(g_{m}+g_{mb})v_{s}.\n$$\n重新整理以合并 $v_{s}$ 项：\n$$\n\\left(\\frac{1}{R_{S}}+\\frac{1}{r_{o}}+g_{m}+g_{mb}\\right)v_{s}=g_{m}v_{g}.\n$$\n因此，小信号增益为\n$$\nA_{v}=\\frac{v_{out}}{v_{in}}=\\frac{v_{s}}{v_{g}}=\\frac{g_{m}}{g_{m}+g_{mb}+\\frac{1}{R_{S}}+\\frac{1}{r_{o}}}.\n$$\n因此，所求的对为\n$$\n\\left(Z_{in},\\,A_{v}\\right)=\\left(\\infty,\\,\\frac{g_{m}}{g_{m}+g_{mb}+\\frac{1}{R_{S}}+\\frac{1}{r_{o}}}\\right).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\infty & \\dfrac{g_{m}}{g_{m}+g_{mb}+\\dfrac{1}{R_{S}}+\\dfrac{1}{r_{o}}}\\end{pmatrix}}$$", "id": "1323366"}, {"introduction": "在放大器设计中，实现高电压增益是一个核心目标。本练习探讨了一种采用PMOS作为放大管、并使用一个级联（cascode）有源负载来提升性能的共源极放大器。通过推导其小信号电压增益，你将学会如何分析更复杂的复合电路，并理解有源负载在高增益设计中的关键作用 [@problem_id:1323378]。", "problem": "考虑一个使用金属-氧化物-半导体场效应晶体管 (MOSFET) 构建的放大器级。该级旨在实现高电压增益。\n\n主要的放大器件是一个 p 沟道增强型 MOSFET，记作 $M_1$。其源极连接到正电源电压 $V_{DD}$。其栅极作为小信号电压 $v_{in}$ 的输入端口，该信号叠加在直流偏置上。其漏极是放大器的输出端口，提供信号 $v_{out}$。\n\n该放大器的有源负载实现为一个共源共栅（cascode）电流源，它提供高动态输出电阻。该负载由两个 n 沟道增强型 MOSFET 构建，记作 $M_2$ 和 $M_3$。晶体管 $M_2$ 的漏极连接到输出节点（即 $M_1$ 的漏极）。$M_2$ 的栅极连接到一个稳定的直流偏置电压 $V_{B1}$。$M_2$ 的源极连接到 $M_3$ 的漏极。晶体管 $M_3$ 的源极连接到地，其栅极连接到第二个稳定的直流偏置电压 $V_{B2}$。所有 n 沟道晶体管的衬底都连接到地。\n\n假设所有晶体管都偏置在饱和区工作。每个晶体管 $M_i$（其中 $i=1, 2, 3$）的相关小信号参数是其跨导 $g_{mi}$ 和其有限输出电阻 $r_{oi}$。由于晶体管 $M_2$ 的源极未连接到其衬底，它会受到体效应的影响，这引入了一个体效应跨导 $g_{mb2}$。\n\n你的任务是为该放大器级的总小信号电压增益 $A_v = v_{out} / v_{in}$ 推导出一个单一的、闭合形式的解析表达式。你的最终表达式应以给定的小信号参数表示：$g_{m1}, r_{o1}, g_{m2}, r_{o2}, g_{m3}, r_{o3}$ 和 $g_{mb2}$。", "solution": "将所有直流偏置源，包括 $V_{DD}$、$V_{B1}$ 和 $V_{B2}$，视作交流地。对 $M_i$ 使用参数为 $g_{mi}$ 和 $r_{oi}$ 的小信号混合-$\\pi$ 模型，并因体效应为 $M_2$ 包含 $g_{mb2}$。设输出节点为 $v_{x} \\equiv v_{out}$，$M_2$ 和 $M_3$ 之间的内部节点为 $v_{y}$。$M_2$ 和 $M_3$ 的栅极为交流地。\n\n对于源极为交流地的 p 沟道器件 $M_1$，从源极到漏极的受控源为 $g_{m1} v_{sg1}$；因此，由于 $M_1$ 的跨导而离开节点 $v_{x}$ 的电流为 $-g_{m1} v_{sg1} = g_{m1} v_{in}$，因为 $v_{sg1} = -v_{in}$。流经 $r_{o1}$ 离开节点 $v_{x}$ 的电流为 $v_{x}/r_{o1}$。\n\n对于 $M_2$ (nMOS)，其中 $v_{gs2} = -v_{y}$，$v_{bs2} = -v_{y}$，且 $v_{ds2} = v_{x} - v_{y}$，从漏极到源极的电流（离开节点 $v_x$）为\n$$\ni_{d2} = g_{m2} v_{gs2} + g_{mb2} v_{bs2} + \\frac{v_{ds2}}{r_{o2}} = -(g_{m2} + g_{mb2}) v_{y} + \\frac{v_{x} - v_{y}}{r_{o2}}.\n$$\n对于 $M_3$ (nMOS)，其中 $v_{gs3} = 0$ 且 $v_{ds3} = v_{y}$，离开节点 $v_y$ 的电流为 $v_{y}/r_{o3}$。\n\n在节点 $v_{x}$ 列出 KCL 方程（流出电流之和等于零）：\n$$\ng_{m1} v_{in} + \\frac{v_{x}}{r_{o1}} - (g_{m2} + g_{mb2}) v_{y} + \\frac{v_{x} - v_{y}}{r_{o2}} = 0,\n$$\n整理后得到\n$$\n\\left( \\frac{1}{r_{o1}} + \\frac{1}{r_{o2}} \\right) v_{x} + \\left( -\\frac{1}{r_{o2}} - g_{m2} - g_{mb2} \\right) v_{y} + g_{m1} v_{in} = 0.\n$$\n在节点 $v_{y}$ 列出 KCL 方程（流出电流之和等于零）。通过 $M_2$ 从源极到漏极流出的电流是 $i_{d2}$ 的负值：\n$$\n(g_{m2} + g_{mb2}) v_{y} - \\frac{v_{x} - v_{y}}{r_{o2}} + \\frac{v_{y}}{r_{o3}} = 0,\n$$\n简化为\n$$\n-\\frac{1}{r_{o2}} v_{x} + \\left( g_{m2} + g_{mb2} + \\frac{1}{r_{o2}} + \\frac{1}{r_{o3}} \\right) v_{y} = 0.\n$$\n求解 $v_{y}$ 关于 $v_{x}$ 的表达式：\n$$\nv_{y} = \\frac{ \\frac{1}{r_{o2}} }{ g_{m2} + g_{mb2} + \\frac{1}{r_{o2}} + \\frac{1}{r_{o3}} } \\, v_{x}.\n$$\n将此代入 $v_{x}$ 的 KCL 方程：\n$$\n\\left( \\frac{1}{r_{o1}} + \\frac{1}{r_{o2}} \\right) v_{x} - \\left( \\frac{1}{r_{o2}} + g_{m2} + g_{mb2} \\right) \\frac{ \\frac{1}{r_{o2}} }{ g_{m2} + g_{mb2} + \\frac{1}{r_{o2}} + \\frac{1}{r_{o3}} } v_{x} + g_{m1} v_{in} = 0.\n$$\n定义 $A \\equiv g_{m2} + g_{mb2} + \\frac{1}{r_{o2}} + \\frac{1}{r_{o3}}$。$v_{x}$ 的系数简化为\n$$\n\\frac{1}{r_{o1}} + \\frac{1}{r_{o2}} - \\left( \\frac{1}{r_{o2}} + g_{m2} + g_{mb2} \\right) \\frac{ \\frac{1}{r_{o2}} }{ A }\n= \\frac{1}{r_{o1}} + \\frac{ \\frac{1}{r_{o2}} \\frac{1}{r_{o3}} }{ A }.\n$$\n因此\n$$\n\\left[ \\frac{1}{r_{o1}} + \\frac{ \\frac{1}{r_{o2}} \\frac{1}{r_{o3}} }{ g_{m2} + g_{mb2} + \\frac{1}{r_{o2}} + \\frac{1}{r_{o3}} } \\right] v_{x} + g_{m1} v_{in} = 0,\n$$\n所以\n$$\n\\frac{v_{out}}{v_{in}} = \\frac{v_{x}}{v_{in}} = - \\frac{ g_{m1} }{ \\frac{1}{r_{o1}} + \\frac{ \\frac{1}{r_{o2}} \\frac{1}{r_{o3}} }{ g_{m2} + g_{mb2} + \\frac{1}{r_{o2}} + \\frac{1}{r_{o3}} } }.\n$$\n认识到负载网络的输出电阻是\n$$\nR_{\\text{load}} = \\frac{ g_{m2} + g_{mb2} + \\frac{1}{r_{o2}} + \\frac{1}{r_{o3}} }{ \\frac{1}{r_{o2}} \\frac{1}{r_{o3}} } = r_{o2} + r_{o3} + (g_{m2} + g_{mb2}) r_{o2} r_{o3},\n$$\n总增益可以写成一个不含并联表示法的单一闭合形式：\n$$\nA_{v} = - g_{m1} \\frac{ r_{o1} \\left[ r_{o2} + r_{o3} + (g_{m2} + g_{mb2}) r_{o2} r_{o3} \\right] }{ r_{o1} + r_{o2} + r_{o3} + (g_{m2} + g_{mb2}) r_{o2} r_{o3} }.\n$$\n在所述小信号模型下，此表达式是精确的，并包含了体效应的贡献 $g_{mb2}$。", "answer": "$$\\boxed{-g_{m1}\\frac{r_{o1}\\left[r_{o2}+r_{o3}+\\left(g_{m2}+g_{mb2}\\right)r_{o2}r_{o3}\\right]}{r_{o1}+r_{o2}+r_{o3}+\\left(g_{m2}+g_{mb2}\\right)r_{o2}r_{o3}}}$$", "id": "1323378"}, {"introduction": "除了放大信号，晶体管还能用于合成其他电子元件。由于在集成电路上制造大电感既困难又昂贵，回旋器（gyrator）电路应运而生，它能用晶体管和小电容模拟出电感的行为。这个练习将指导你分析一个由PMOS构成的回旋器，揭示有源电路模拟无源元件的精妙之处 [@problem_id:1323383]。", "problem": "回旋器是现代模拟集成电路设计中的一个关键电路，它允许使用晶体管和电容器等小型片上元件来模拟一个大电感。考虑一个由两个标记为 $M_1$ 和 $M_2$ 的p沟道增强型MOSFET（PMOS）和一个电容 $C$ 构成的回旋器电路。\n\n该电路的配置如下：\n- 晶体管 $M_1$ 被设置为源极跟随器。其漏极连接到主电源电压$V_{DD}$。其栅极作为整个电路的主输入端。其源极连接到一个内部节点，我们称之为节点 $X$。\n- 晶体管 $M_2$ 被设置为共源放大器。其源极连接到$V_{DD}$。其栅极连接到节点 $X$。其漏极连接回 $M_1$ 的栅极，即电路的输入端。\n- 一个电容值为 $C$ 的电容器连接在节点 $X$ 和电源电压$V_{DD}$之间。\n- 输入阻抗$Z_{in}$定义在电路的输入端（$M_1$ 的栅极），在该处，小信号测试电压$v_{in}$产生小信号输入电流$i_{in}$。\n\n假设两个晶体管都偏置在饱和区工作。设 $M_1$ 和 $M_2$ 的跨导分别为$g_{m1}$和$g_{m2}$。在本分析中，你必须忽略两个器件的体效应和沟道长度调制效应（即，假设晶体管输出电阻$r_o$为无穷大）。\n\n基于此配置，电路的输入阻抗模拟了一个电阻与一个电感串联的阻抗。请确定该电路在其输入端呈现的等效电感$L_{eq}$的符号表达式。", "solution": "设 $M_1$ 栅极（也是 $M_2$ 漏极）处的小信号输入电压为 $v_{in}$，节点 $X$ 处的小信号电压为 $v_{x}$。电源节点$V_{DD}$是交流地。如题所述，两个器件的栅极均不吸取电流，且$r_{o}\\to\\infty$。\n\n对于PMOS，小信号跨导产生的从源极到漏极的沟道电流等于$i_{sd} = g_{m} v_{sg}$，其中$v_{sg} = v_{s} - v_{g}$。将此应用于 $M_1$ （源极在节点 $X$，栅极在输入端，漏极在交流地），通过 $M_1$ 流出节点 $X$ 的小信号电流为\n$$\ni_{M1} = g_{m1}(v_{x} - v_{in}).\n$$\n从节点 $X$ 流向地的电容电流为\n$$\ni_{C} = s C\\, v_{x}.\n$$\n根据Kirchhoff电流定律（流出节点 $X$ 的电流之和为零，因为没有其他元件连接到节点 $X$），\n$$\ns C\\, v_{x} + g_{m1}(v_{x} - v_{in}) = 0,\n$$\n由此可得\n$$\nv_{x} = \\frac{g_{m1}}{s C + g_{m1}}\\, v_{in}.\n$$\n\n输入电流是 $M_2$ 的漏极电流（漏极在输入节点，源极在交流地，栅极在节点 $X$）。对于PMOS，源-漏电流为 $i_{sd2} = g_{m2} v_{sg2} = g_{m2}(0 - v_{x}) = - g_{m2} v_{x}$。漏-源电流，即从输入节点流入 $M_2$ 的电流，为 $i_{d2} = -i_{sd2} = g_{m2} v_{x}$。因此，\n$$\ni_{in} = g_{m2} v_{x} = g_{m2}\\,\\frac{g_{m1}}{s C + g_{m1}}\\, v_{in}.\n$$\n因此，输入导纳和输入阻抗分别为\n$$\nY_{in} = \\frac{i_{in}}{v_{in}} = \\frac{g_{m1} g_{m2}}{s C + g_{m1}}, \n\\qquad\nZ_{in} = \\frac{s C + g_{m1}}{g_{m1} g_{m2}} = \\frac{1}{g_{m2}} + s\\,\\frac{C}{g_{m1} g_{m2}}.\n$$\n这是一个电阻和电感串联组合的阻抗，其等效电感为\n$$\nL_{eq} = \\frac{C}{g_{m1} g_{m2}}.\n$$", "answer": "$$\\boxed{\\frac{C}{g_{m1} g_{m2}}}$$", "id": "1323383"}]}