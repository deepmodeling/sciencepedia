{"hands_on_practices": [{"introduction": "逐次逼近型ADC的核心在于其高效的二分搜索算法。本练习将让你扮演“SAR逻辑”的角色，通过解读一系列比较器的输出（高电平或低电平），一步步构建出最终的数字码。这个过程可以让你直观地理解模拟电压是如何被逐位量化为数字值的。[@problem_id:1334890]", "problem": "一个用于大气监测的嵌入式系统采用一个6位逐次逼近寄存器 (SAR) 模数转换器 (ADC) 来数字化一个高精度气压传感器的输出电压。该 ADC 的工作参考电压为 $V_{ref} = 5.12 \\, \\text{V}$。\n\nSAR ADC 的转换过程是一个二分搜索。它逐个确定从最高有效位 (MSB) 到最低有效位 (LSB) 的每一位的状态。对于每一位，一个数模转换器 (DAC) 会生成一个试验电压，并与传感器的模拟输入电压 $V_{in}$ 进行比较。如果比较器的输出为“高”(HIGH)，表示 $V_{in}$ 大于或等于试验电压，该位将保持为1。如果输出为“低”(LOW)，表示 $V_{in}$ 小于试验电压，该位将被设置为0。\n\n对于一次特定的恒定压力测量，从 MSB 到 LSB 的测试所对应的比较器输出序列被观测为：\n\n高、低、高、高、低、高\n\n根据此序列，确定 ADC 产生的最终6位数字字。将您的答案表示为该二进制字的等效十进制 (base-10) 整数。", "solution": "问题要求计算由一个逐次逼近寄存器 (SAR) 模数转换器 (ADC) 决定的6位二进制字的等效十进制数。该 ADC 的分辨率为 $N=6$ 位，参考电压为 $V_{ref} = 5.12 \\, \\text{V}$。从最高有效位 (MSB) $b_5$ 到最低有效位 (LSB) $b_0$ 的各比特对应的比较器输出序列为：高、低、高、高、低、高。\n\nSAR ADC 执行一个二分搜索来找到模拟输入电压 $V_{in}$ 的数字表示。我们将通过转换过程的6个步骤来追踪6位寄存器 $B = b_5 b_4 b_3 b_2 b_1 b_0$ 的状态。\n\n内部的数模转换器 (DAC) 根据当前的试验数字字生成一个试验电压。比较器输出“高”意味着当前测试的位应保持为“1”，而输出“低”则意味着它应被设置为“0”。\n\n**步骤1：测试 MSB ($b_5$)**\n初始试验字通过将 MSB 设置为“1”并将所有其他位设置为“0”来设定。\n试验字：$100000_2$。\n比较器输出为**高 (HIGH)**。这意味着 $V_{in}$ 大于或等于与 $100000_2$ 对应的电压。因此，MSB 被保留。\n$b_5 = 1$。\n当前结果：$1????_2$。\n\n**步骤2：测试位 $b_4$**\n下一个试验字通过保留已确定的位 ($b_5=1$) 并将被测试的下一位 ($b_4$) 设置为“1”来形成。\n试验字：$110000_2$。\n比较器输出为**低 (LOW)**。这意味着 $V_{in}$ 小于与 $110000_2$ 对应的电压。因此，该位必须被清除。\n$b_4 = 0$。\n当前结果：$10???_2$。\n\n**步骤3：测试位 $b_3$**\n试验字通过使用已确定的位 ($b_5=1, b_4=0$) 并将被测试的位 ($b_3$) 设置为“1”来形成。\n试验字：$101000_2$。\n比较器输出为**高 (HIGH)**。这意味着 $V_{in}$ 大于或等于与 $101000_2$ 对应的电压。因此，该位被保留。\n$b_3 = 1$。\n当前结果：$101??_2$。\n\n**步骤4：测试位 $b_2$**\n试验字通过使用已确定的位 ($b_5=1, b_4=0, b_3=1$) 并将被测试的位 ($b_2$) 设置为“1”来形成。\n试验字：$101100_2$。\n比较器输出为**高 (HIGH)**。这意味着 $V_{in}$ 大于或等于与 $101100_2$ 对应的电压。该位被保留。\n$b_2 = 1$。\n当前结果：$1011?_2$。\n\n**步骤5：测试位 $b_1$**\n试验字通过使用已确定的位 ($b_5=1, b_4=0, b_3=1, b_2=1$) 并将被测试的位 ($b_1$) 设置为“1”来形成。\n试验字：$101110_2$。\n比较器输出为**低 (LOW)**。这意味着 $V_{in}$ 小于与 $101110_2$ 对应的电压。该位必须被清除。\n$b_1 = 0$。\n当前结果：$10110?_2$。\n\n**步骤6：测试 LSB ($b_0$)**\n最终的试验字通过使用先前已确定的位并将 LSB ($b_0$) 设置为“1”来形成。\n试验字：$101101_2$。\n比较器输出为**高 (HIGH)**。这意味着 $V_{in}$ 大于或等于与 $101101_2$ 对应的电压。该位被保留。\n$b_0 = 1$。\n\n经过所有6个步骤后，最终的二进制字为 $101101_2$。\n\n最后一步是将此二进制字转换为其等效的十进制数。\n$B_{decimal} = (1 \\times 2^5) + (0 \\times 2^4) + (1 \\times 2^3) + (1 \\times 2^2) + (0 \\times 2^1) + (1 \\times 2^0)$\n$B_{decimal} = (1 \\times 32) + (0 \\times 16) + (1 \\times 8) + (1 \\times 4) + (0 \\times 2) + (1 \\times 1)$\n$B_{decimal} = 32 + 0 + 8 + 4 + 0 + 1$\n$B_{decimal} = 45$\n\n最终数字字的等效十进制整数为45。", "answer": "$$\\boxed{45}$$", "id": "1334890"}, {"introduction": "理解了逐次逼近的多步骤转换过程后，一个自然的问题是：如果输入信号在转换期间发生变化会怎样？本练习通过一个假设情景，移除了采样保持（S&H）电路，从而揭示了在转换期间输入不稳所带来的严重误差。通过这个思想实验，你将深刻体会到为何采样保持电路对于实现精确转换是不可或缺的。[@problem_id:1334885]", "problem": "一款8位逐次逼近寄存器（SAR）模数转换器（ADC）设计工作在参考电压 $V_{ref} = 5.12 \\, \\text{V}$下，对应的输入电压范围为 $0 \\, \\text{V}$ 至 $5.12 \\, \\text{V}$。单个采样的转换过程需要8个时钟周期，每个时钟周期的持续时间为 $T_{clk} = 1.0 \\, \\mu\\text{s}$。转换在时间 $t=0$ 开始。第 $i$ 位（其中 $i=1$ 对应最高有效位MSB，$i=8$ 对应最低有效位LSB）的确定是基于一次比较，该比较恰好发生在第 $i$ 个时钟周期的末尾，即时间 $t_i = i \\cdot T_{clk}$。\n\n由于设计疏忽，该ADC缺少采样保持电路。因此，在转换过程中，模拟输入信号并非保持恒定。相反，比较器的输入端直接连接到一个时变信号，该信号由以下方程描述：\n$$V_{in}(t) = V_0 + kt$$\n其中 $V_0 = 3.21 \\, \\text{V}$ 且 $k = 2.50 \\times 10^4 \\, \\text{V/s}$。\n\nSAR逻辑的工作方式如下：对于从MSB到LSB的每一位，它将一个试验位设置为 '1'，并在指定的比较时刻将产生的内部数模转换器（DAC）电压与模拟输入 $V_{in}(t)$ 进行比较。如果 $V_{in}(t)$ 大于或等于试验电压，则该位保留为 '1'；否则，该位被设置为 '0'。\n\n计算该ADC针对此输入信号所产生的最终8位数字输出码。请以十进制整数形式给出答案。", "solution": "SAR ADC为确定每一位的值，在时刻 $t_{i} = i T_{clk}$ 进行一次模拟输入比较，其中 $i=1$ 对应MSB，$i=8$ 对应LSB。由于没有采样保持电路，输入为 $V_{in}(t) = V_{0} + k t$。SAR的判决规则是：在第 $i$ 位，将试验位设为1（保持先前已决定的位，并将所有更低的位设为0），形成DAC试验电压 $V_{DAC}^{(i)}$，当且仅当 $V_{in}(t_{i}) \\geq V_{DAC}^{(i)}$ 时，将该位保留为1。\n\n已知：\n- $V_{ref} = 5.12 \\, \\text{V}$。\n- 分辨率 $N=8$，所以LSB的大小为 $V_{LSB} = \\frac{V_{ref}}{2^{8}} = \\frac{5.12}{256} = 0.02 \\, \\text{V}$，各位的权重为 $w_{1}=\\frac{V_{ref}}{2}=2.56 \\, \\text{V}$，$w_{2}=\\frac{V_{ref}}{4}=1.28 \\, \\text{V}$，$w_{3}=0.64 \\, \\text{V}$，$w_{4}=0.32 \\, \\text{V}$，$w_{5}=0.16 \\, \\text{V}$，$w_{6}=0.08 \\, \\text{V}$，$w_{7}=0.04 \\, \\text{V}$，$w_{8}=0.02 \\, \\text{V}$。\n- $T_{clk} = 1.0 \\times 10^{-6} \\, \\text{s}$。\n- $V_{0} = 3.21 \\, \\text{V}$，$k = 2.50 \\times 10^{4} \\, \\text{V/s}$，所以每个时钟周期的输入增加量为 $k T_{clk} = 2.50 \\times 10^{4} \\times 1.0 \\times 10^{-6} = 2.50 \\times 10^{-2} \\, \\text{V} = 0.025 \\, \\text{V}$。\n- 因此 $V_{in}(t_{i}) = V_{0} + k i T_{clk} = 3.21 + 0.025 i \\, \\text{V}$。\n\n逐位进行：\n- $i=1$ (MSB)：$t_{1} = T_{clk}$，$V_{in}(t_{1}) = 3.21 + 0.025 = 3.235 \\, \\text{V}$。试验MSB=1：$V_{DAC}^{(1)} = w_{1} = 2.56 \\, \\text{V}$。因为 $3.235 \\geq 2.56$，故保留位1：$b_{1}=1$。\n- $i=2$：$t_{2} = 2 T_{clk}$，$V_{in}(t_{2}) = 3.21 + 0.050 = 3.26 \\, \\text{V}$。试验 $b_{1}=1, b_{2}=1$：$V_{DAC}^{(2)} = w_{1} + w_{2} = 2.56 + 1.28 = 3.84 \\, \\text{V}$。因为 $3.26 < 3.84$，故设 $b_{2}=0$。\n- $i=3$：$t_{3} = 3 T_{clk}$，$V_{in}(t_{3}) = 3.21 + 0.075 = 3.285 \\, \\text{V}$。试验 $b_{1}=1, b_{3}=1$：$V_{DAC}^{(3)} = w_{1} + w_{3} = 2.56 + 0.64 = 3.20 \\, \\text{V}$。因为 $3.285 \\geq 3.20$，故保留 $b_{3}=1$。\n- $i=4$：$t_{4} = 4 T_{clk}$，$V_{in}(t_{4}) = 3.21 + 0.100 = 3.31 \\, \\text{V}$。试验 $b_{1}=1, b_{3}=1, b_{4}=1$：$V_{DAC}^{(4)} = 2.56 + 0.64 + 0.32 = 3.52 \\, \\text{V}$。因为 $3.31 < 3.52$，故设 $b_{4}=0$。\n- $i=5$：$t_{5} = 5 T_{clk}$，$V_{in}(t_{5}) = 3.21 + 0.125 = 3.335 \\, \\text{V}$。试验 $b_{1}=1, b_{3}=1, b_{5}=1$：$V_{DAC}^{(5)} = 2.56 + 0.64 + 0.16 = 3.36 \\, \\text{V}$。因为 $3.335 < 3.36$，故设 $b_{5}=0$。\n- $i=6$：$t_{6} = 6 T_{clk}$，$V_{in}(t_{6}) = 3.21 + 0.150 = 3.36 \\, \\text{V}$。试验 $b_{1}=1, b_{3}=1, b_{6}=1$：$V_{DAC}^{(6)} = 2.56 + 0.64 + 0.08 = 3.28 \\, \\text{V}$。因为 $3.36 \\geq 3.28$，故保留 $b_{6}=1$。\n- $i=7$：$t_{7} = 7 T_{clk}$，$V_{in}(t_{7}) = 3.21 + 0.175 = 3.385 \\, \\text{V}$。试验 $b_{1}=1, b_{3}=1, b_{6}=1, b_{7}=1$：$V_{DAC}^{(7)} = 2.56 + 0.64 + 0.08 + 0.04 = 3.32 \\, \\text{V}$。因为 $3.385 \\geq 3.32$，故保留 $b_{7}=1$。\n- $i=8$ (LSB)：$t_{8} = 8 T_{clk}$，$V_{in}(t_{8}) = 3.21 + 0.200 = 3.41 \\, \\text{V}$。试验 $b_{1}=1, b_{3}=1, b_{6}=1, b_{7}=1, b_{8}=1$：$V_{DAC}^{(8)} = 2.56 + 0.64 + 0.08 + 0.04 + 0.02 = 3.34 \\, \\text{V}$。因为 $3.41 \\geq 3.34$，故保留 $b_{8}=1$。\n\n因此，最终的位模式是 $b_{1}\\ldots b_{8} = 1\\,0\\,1\\,0\\,0\\,1\\,1\\,1$，其对应的十进制码为 $128 + 32 + 4 + 2 + 1 = 167$。\n因此，最终的8位数字输出码是 $167$。", "answer": "$$\\boxed{167}$$", "id": "1334885"}, {"introduction": "从单次转换扩展到实时信号处理系统，我们必须将ADC的内部工作速度与外部系统需求联系起来。本练习要求你以系统设计者的视角进行思考，推导出满足奈奎斯特采样定理所需的最低ADC时钟频率。这有助于你理解ADC的位数（$N$）、采样时间（$k$）等内部参数如何直接影响整个系统能够处理的信号带宽。[@problem_id:1334898]", "problem": "一个生物医学工程团队正在开发一种可穿戴心电图 (ECG) 监护仪。该设备必须精确捕捉患者的心脏信号，已知该信号在滤波后，其有效频率分量的最高频率为 $f_{max}$。为了将此信号数字化，该设计采用了一个分辨率为 $N$ 位的逐次逼近寄存器 (SAR) 型模数转换器 (ADC)。\n\n此 SAR ADC 对每个样本的采集操作分为两个阶段。首先，一个初始的采样保持 (S/H) 阶段用于采集模拟电压，此过程需要固定的 $k$ 个时钟周期。紧接着，转换阶段开始，在此阶段中 $N$ 个比特位被逐一确定。每个比特位的确定恰好需要一个时钟周期。\n\n为确保信号的高保真数字表示并防止混叠，系统必须遵循严格的采样协议。指定的采样率 $f_s$ 被设定为信号所需理论最小奈奎斯特速率的 $\\alpha$ 倍。为保证系统正常工作，完成一次完整的 ADC 转换所需的总时间不得超过连续采样之间的时间间隔。\n\n请推导 ADC 为满足这些系统要求所必须具备的最低时钟频率 $f_{clk, min}$ 的闭式解析表达式。请用参数 $f_{max}$、$N$、$k$ 和 $\\alpha$ 来表示您的答案。", "solution": "设滤波后信号的最大频率为 $f_{max}$。奈奎斯特采样定理要求 $f_{s} \\geq 2 f_{max}$。系统设定的采样率是该最小值的 $\\alpha$ 倍，因此\n$$\nf_{s} = 2 \\alpha f_{max}.\n$$\n每个样本的 ADC 转换包括两个串行阶段：一个耗时 $k$ 个时钟周期的采样保持阶段和一个耗时 $N$ 个时钟周期的逐次逼近阶段，因此每次采样总共需要 $k+N$ 个时钟周期。如果 ADC 时钟频率为 $f_{clk}$，则完成一次转换所需的时间为\n$$\nT_{conv} = \\frac{k+N}{f_{clk}}.\n$$\n为确保每次转换在下一次采样开始前完成，转换时间不得超过采样间隔 $T_{s} = \\frac{1}{f_{s}}$：\n$$\n\\frac{k+N}{f_{clk}} \\leq \\frac{1}{f_{s}}.\n$$\n解出 $f_{clk}$ 可得\n$$\nf_{clk} \\geq (k+N) f_{s}.\n$$\n将 $f_{s} = 2 \\alpha f_{max}$ 代入，得出所需的最小 ADC 时钟频率：\n$$\nf_{clk, min} = 2 \\alpha (k+N) f_{max}.\n$$", "answer": "$$\\boxed{2 \\alpha (k+N) f_{max}}$$", "id": "1334898"}]}