{"hands_on_practices": [{"introduction": "为了真正掌握总谐波失真 (THD) 的概念，我们首先从一个基本问题入手：分析一个理想的非正弦波形。本练习将引导你计算理想方波的 THD [@problem_id:1342909]。通过将傅里叶级数分析与 THD 的定义直接联系起来，你将直观地理解一个信号是如何由基波和一系列谐波分量构成的，并能定量地评估其失真程度。", "problem": "在电子系统的分析中，通常需要评估信号的纯净度。考虑一个由函数发生器产生的理想对称方波电压 $v(t)$。该信号的峰值幅度为 $V_0$，周期为 $T$。在一个周期内，其波形定义为：\n$$\nv(t) = \\begin{cases}\n+V_0 & \\text{for } 0 < t < T/2 \\\\\n-V_0 & \\text{for } T/2 < t < T\n\\end{cases}\n$$\n该信号与纯正弦波的偏差通过其总谐波失真 (THD) 进行量化。THD 定义为所有谐波分量（从二次谐波开始）的总均方根 (RMS) 值与基波分量的均方根值之比。这可以表示为：\n$$THD = \\frac{\\sqrt{\\sum_{n=2}^{\\infty} V_{n, \\text{rms}}^2}}{V_{1, \\text{rms}}}$$\n其中 $V_{n, \\text{rms}}$ 代表第 $n$ 次谐波的均方根电压。\n\n计算此理想方波的精确理论 THD。以简化的解析表达式给出答案。", "solution": "设方波的基波角频率为 $\\omega_{0} = \\frac{2\\pi}{T}$。其在一个周期内的傅里叶级数可以写作\n$$\nv(t) = \\sum_{n=1}^{\\infty} \\left[a_{n}\\cos(n\\omega_{0}t) + b_{n}\\sin(n\\omega_{0}t)\\right].\n$$\n由于 $v(t+T/2) = -v(t)$（半波对称性），因此信号中没有直流分量，也没有偶次谐波。我们具体计算正弦系数：\n$$\nb_{n} = \\frac{2}{T}\\int_{0}^{T} v(t)\\sin(n\\omega_{0}t)\\,dt = \\frac{2}{T}\\left[\\int_{0}^{T/2} V_{0}\\sin(n\\omega_{0}t)\\,dt + \\int_{T/2}^{T} (-V_{0})\\sin(n\\omega_{0}t)\\,dt\\right].\n$$\n计算积分，\n$$\n\\int \\sin(n\\omega_{0}t)\\,dt = -\\frac{\\cos(n\\omega_{0}t)}{n\\omega_{0}},\n$$\n所以\n$$\n\\int_{0}^{T/2} V_{0}\\sin(n\\omega_{0}t)\\,dt = \\frac{V_{0}}{n\\omega_{0}}\\left[-\\cos\\!\\left(n\\omega_{0}\\frac{T}{2}\\right) + 1\\right],\n$$\n$$\n\\int_{T/2}^{T} (-V_{0})\\sin(n\\omega_{0}t)\\,dt = \\frac{V_{0}}{n\\omega_{0}}\\left[\\cos(n\\omega_{0}T) - \\cos\\!\\left(n\\omega_{0}\\frac{T}{2}\\right)\\right].\n$$\n相加，\n$$\n\\int_{0}^{T} v(t)\\sin(n\\omega_{0}t)\\,dt = \\frac{V_{0}}{n\\omega_{0}}\\left[2 - 2\\cos\\!\\left(n\\omega_{0}\\frac{T}{2}\\right)\\right].\n$$\n使用 $\\omega_{0} = \\frac{2\\pi}{T}$ 可得 $\\cos\\!\\left(n\\omega_{0}\\frac{T}{2}\\right) = \\cos(n\\pi) = (-1)^{n}$ 以及 $\\cos(n\\omega_{0}T) = \\cos(2\\pi n) = 1$。因此\n$$\nb_{n} = \\frac{2}{T}\\cdot \\frac{V_{0}}{n\\omega_{0}}\\cdot 2\\left[1 - \\cos(n\\pi)\\right] = \\frac{4V_{0}}{T n \\omega_{0}}\\left[1 - (-1)^{n}\\right] = \\frac{2V_{0}}{\\pi n}\\left[1 - (-1)^{n}\\right].\n$$\n因此，当 $n$ 为奇数时 $b_{n} = \\frac{4V_{0}}{\\pi n}$，当 $n$ 为偶数时 $b_{n}=0$，同时所有 $a_{n}=0$。第 $n$ 次谐波是峰值幅度为 $|b_{n}|$ 的正弦波，所以其均方根值为\n$$\nV_{n,\\text{rms}} = \\frac{|b_{n}|}{\\sqrt{2}} = \n\\begin{cases}\n\\frac{4V_{0}}{\\pi n\\sqrt{2}}, & n \\text{ 奇数}, \\\\\n0, & n \\text{ 偶数}.\n\\end{cases}\n$$\n特别地，基波的均方根值为\n$$\nV_{1,\\text{rms}} = \\frac{4V_{0}}{\\pi\\sqrt{2}}.\n$$\nTHD 为\n$$\n\\text{THD} = \\frac{\\sqrt{\\sum_{n=2}^{\\infty} V_{n,\\text{rms}}^{2}}}{V_{1,\\text{rms}}} = \\frac{\\sqrt{\\sum_{\\substack{n=3\\\\ n\\ \\text{奇数}}}^{\\infty} \\left(\\frac{4V_{0}}{\\pi n\\sqrt{2}}\\right)^{2}}}{\\frac{4V_{0}}{\\pi\\sqrt{2}}} = \\sqrt{\\sum_{\\substack{n=3\\\\ n\\ \\text{奇数}}}^{\\infty} \\frac{1}{n^{2}}}.\n$$\n利用已知级数 $\\sum_{n=1}^{\\infty}\\frac{1}{n^{2}} = \\frac{\\pi^{2}}{6}$ 并分离出奇数项，\n$$\n\\sum_{\\substack{n=1\\\\ n\\ \\text{奇数}}}^{\\infty} \\frac{1}{n^{2}} = \\sum_{n=1}^{\\infty} \\frac{1}{n^{2}} - \\sum_{n=1}^{\\infty} \\frac{1}{(2n)^{2}} = \\frac{\\pi^{2}}{6} - \\frac{1}{4}\\cdot \\frac{\\pi^{2}}{6} = \\frac{\\pi^{2}}{8}.\n$$\n因此，\n$$\n\\sum_{\\substack{n=3\\\\ n\\ \\text{奇数}}}^{\\infty} \\frac{1}{n^{2}} = \\frac{\\pi^{2}}{8} - 1,\n$$\n且\n$$\n\\text{THD} = \\sqrt{\\frac{\\pi^{2}}{8} - 1}.\n$$\n这便是理想对称方波的精确理论THD值。", "answer": "$$\\boxed{\\sqrt{\\frac{\\pi^{2}}{8}-1}}$$", "id": "1342909"}, {"introduction": "理解了如何量化失真之后，下一个关键问题是：谐波失真是从哪里来的？这个练习通过一个简化的非线性放大器模型来回答这个问题 [@problem_id:1342877]。你将探索当一个纯正弦信号通过一个具有弱三次方非线性特性的电路时，其输出如何产生谐波，从而建立起电路非线性行为与信号频谱纯度降低之间的直接联系。", "problem": "一位音频工程师正在对一个新的前置放大器级进行特性分析。通过测试，他们发现对于足够小的输入信号，该放大器的输入-输出电压关系可以用一个弱三次非线性模型来描述。输出电压 $V_{out}$ 与输入电压 $V_{in}$ 通过传递函数 $V_{out}(t) = a_1 V_{in}(t) + a_3 V_{in}^3(t)$ 相关联。在此，$a_1 > 0$ 是主线性增益系数，$a_3$ 是一个小的、非零的三次失真系数。弱非线性的条件由 $|a_3 V_p^2| \\ll a_1$ 给出。\n\n将一个纯正弦测试信号 $V_{in}(t) = V_p \\sin(\\omega_0 t)$ 应用于此前置放大器的输入端。非线性项的引入会在输出信号中产生谐波频率。\n\n总谐波失真 (THD) 定义为所有谐波分量（高于基频的频率）之和的均方根 (RMS) 电压与基波分量的均方根 (RMS) 电压之比。\n\n假设弱非线性条件成立，推导输出信号 $V_{out}(t)$ 的 THD 的一个简化闭式解析表达式。您的最终表达式应以参数 $V_p$、$a_1$ 和 $a_3$ 表示。", "solution": "我们从给定的传递函数和正弦输入开始。使用 $V_{in}(t) = V_{p} \\sin(\\omega_{0} t)$，输出为\n$$\nV_{out}(t) = a_{1} V_{p} \\sin(\\omega_{0} t) + a_{3} V_{p}^{3} \\sin^{3}(\\omega_{0} t).\n$$\n应用三角恒等式 $\\sin^{3} x = \\frac{3 \\sin x - \\sin 3x}{4}$ 来分离基波和三次谐波：\n$$\nV_{out}(t) = \\left(a_{1} V_{p} + \\frac{3}{4} a_{3} V_{p}^{3}\\right) \\sin(\\omega_{0} t) - \\frac{1}{4} a_{3} V_{p}^{3} \\sin(3 \\omega_{0} t).\n$$\n因此，在 $\\omega_{0}$ 处的基波分量的峰值振幅为\n$$\nA_{1} = a_{1} V_{p} + \\frac{3}{4} a_{3} V_{p}^{3},\n$$\n并且唯一存在的谐波是在 $3 \\omega_{0}$ 处的三次谐波，其峰值振幅为\n$$\nA_{3} = -\\frac{1}{4} a_{3} V_{p}^{3}.\n$$\n对于一个正弦波 $A \\sin(\\cdot)$，其 RMS 值为 $|A|/\\sqrt{2}$。所有谐波之和的 RMS 等于它们各自 RMS 平方和的平方根；此处只有三次谐波存在，因此总谐波 RMS 为 $|A_{3}|/\\sqrt{2}$。基波 RMS 为 $|A_{1}|/\\sqrt{2}$。因此，精确的 THD 为\n$$\n\\mathrm{THD} = \\frac{|A_{3}|/\\sqrt{2}}{|A_{1}|/\\sqrt{2}} = \\frac{|A_{3}|}{|A_{1}|} = \\frac{\\left|\\frac{1}{4} a_{3} V_{p}^{3}\\right|}{\\left|a_{1} V_{p} + \\frac{3}{4} a_{3} V_{p}^{3}\\right|} = \\frac{|a_{3}| V_{p}^{2}}{\\left|4 a_{1} + 3 a_{3} V_{p}^{2}\\right|}.\n$$\n在弱非线性条件 $|a_{3} V_{p}^{2}| \\ll a_{1}$ 下，对基波振幅的三次校正与 $a_{1} V_{p}$ 相比可以忽略不计，因此 $|A_{1}| \\approx a_{1} V_{p}$。在 $a_{3} V_{p}^{2}/a_{1}$ 中仅保留主导项，可得到简化的闭式表达式\n$$\n\\mathrm{THD} \\approx \\frac{|a_{3}| V_{p}^{3}/4}{a_{1} V_{p}} = \\frac{|a_{3}| V_{p}^{2}}{4 a_{1}}.\n$$\n该表达式以 $V_{p}$、$a_{1}$ 和 $a_{3}$ 表示，其中 $a_{1} > 0$ 且 $a_{3}$ 的符号可以是正也可以是负；绝对值保证了 THD 为非负值。", "answer": "$$\\boxed{\\frac{|a_{3}| V_{p}^{2}}{4 a_{1}}}$$", "id": "1342877"}, {"introduction": "在实际系统中，我们常常需要处理已经失真的信号。最后一个练习将我们带入一个实际的应用场景：我们能否“净化”一个带有谐波的信号？[@problem_id:1342927] 在这里，你将分析一个包含多个谐波分量的信号在通过一个简单的一阶低通滤波器后的变化。这个实践有助于你建立关于线性系统（如滤波器）如何与非线性失真相互作用的直觉，并探讨了滤波是否总能有效改善以 THD 衡量的信号纯度这一重要问题。", "problem": "一个来自非理想振荡器的音频信号被发现由一个基频分量和若干个谐波组成。输入信号 $v_{in}(t)$ 可由以下有限傅里叶级数精确描述：\n$$v_{in}(t) = \\sum_{n=1}^{5} V_n \\sin(2\\pi n f_1 t)$$\n基频为 $f_1 = 1.0 \\text{ kHz}$。前五个频率分量的电压幅值测量如下：\n- 基波 (n=1): $V_1 = 2.0 \\text{ V}$\n- 二次谐波 (n=2): $V_2 = 0.20 \\text{ V}$\n- 三次谐波 (n=3): $V_3 = 0.15 \\text{ V}$\n- 四次谐波 (n=4): $V_4 = 0.10 \\text{ V}$\n- 五次谐波 (n=5): $V_5 = 0.05 \\text{ V}$\n\n该信号通过一个简单的一阶RC低通滤波器对其进行净化。滤波器的复电压传递函数 $H(j\\omega)$ 由下式给出：\n$$H(j\\omega) = \\frac{1}{1 + j\\frac{\\omega}{\\omega_c}}$$\n其中 $\\omega = 2\\pi f$ 是信号分量的角频率，$\\omega_c = 2\\pi f_c$ 是滤波器的截止角频率。滤波器设计的截止频率为 $f_c = 1.8 \\text{ kHz}$。\n\n信号的总谐波失真 (THD) 定义为所有谐波频率（基频以上）分量的均方根 (RMS) 幅值与基频分量的均方根幅值之比。对于由离散正弦波组成的信号，其THD由以下公式给出：\n$$THD = \\frac{\\sqrt{\\sum_{n=2}^{\\infty} V_n^2}}{V_1}$$\n\n假设滤波器根据其传递函数理想工作且不引入任何新的失真，计算滤波器输出信号 $v_{out}(t)$ 的总谐波失真 (THD)。将答案表示为十进制数值，并四舍五入至三位有效数字。", "solution": "该问题要求计算信号通过一阶RC低通滤波器后的总谐波失真 (THD)。为此，我们首先需要确定滤波器输出端每个频率分量的幅值。\n\n一个由其传递函数 $H(j\\omega)$ 描述的线性滤波器，会改变输入信号中每个正弦分量的幅度和相位。输出分量的幅值 $V'_n$ 等于输入幅值 $V_n$ 乘以在该分量频率 $\\omega_n = 2\\pi n f_1$ 处计算的传递函数的模 $|H(j\\omega_n)|$。\n\n给定传递函数的模为：\n$$|H(j\\omega)| = \\left| \\frac{1}{1 + j\\frac{\\omega}{\\omega_c}} \\right| = \\frac{|1|}{\\left|1 + j\\frac{\\omega}{\\omega_c}\\right|} = \\frac{1}{\\sqrt{1^2 + \\left(\\frac{\\omega}{\\omega_c}\\right)^2}} = \\frac{1}{\\sqrt{1 + \\left(\\frac{f}{f_c}\\right)^2}}$$\n其中 $f$ 是分量的频率，$f_c$ 是滤波器的截止频率。\n\n给定 $f_1 = 1.0 \\text{ kHz}$ 和 $f_c = 1.8 \\text{ kHz}$。我们现在为从 $n=1$ 到 $n=5$ 的每个分量计算输出幅值 $V'_n = V_n \\cdot |H(j\\omega_n)|$。\n\n对于基波分量($n=1$):\n频率为 $f_1 = 1.0 \\text{ kHz}$。\n衰减因子为 $|H(j\\omega_1)| = \\frac{1}{\\sqrt{1 + (1.0/1.8)^2}} \\approx \\frac{1}{\\sqrt{1 + 0.3086}} \\approx 0.8742$。\n输出幅值为 $V'_1 = V_1 \\cdot |H(j\\omega_1)| = 2.0 \\text{ V} \\cdot 0.8742 = 1.7484 \\text{ V}$。\n\n对于二次谐波($n=2$):\n频率为 $f_2 = 2 \\cdot 1.0 \\text{ kHz} = 2.0 \\text{ kHz}$。\n衰减因子为 $|H(j\\omega_2)| = \\frac{1}{\\sqrt{1 + (2.0/1.8)^2}} \\approx \\frac{1}{\\sqrt{1 + 1.2346}} \\approx 0.6690$。\n输出幅值为 $V'_2 = V_2 \\cdot |H(j\\omega_2)| = 0.20 \\text{ V} \\cdot 0.6690 = 0.1338 \\text{ V}$。\n\n对于三次谐波($n=3$):\n频率为 $f_3 = 3 \\cdot 1.0 \\text{ kHz} = 3.0 \\text{ kHz}$。\n衰减因子为 $|H(j\\omega_3)| = \\frac{1}{\\sqrt{1 + (3.0/1.8)^2}} \\approx \\frac{1}{\\sqrt{1 + 2.7778}} \\approx 0.5145$。\n输出幅值为 $V'_3 = V_3 \\cdot |H(j\\omega_3)| = 0.15 \\text{ V} \\cdot 0.5145 = 0.07718 \\text{ V}$。\n\n对于四次谐波($n=4$):\n频率为 $f_4 = 4 \\cdot 1.0 \\text{ kHz} = 4.0 \\text{ kHz}$。\n衰减因子为 $|H(j\\omega_4)| = \\frac{1}{\\sqrt{1 + (4.0/1.8)^2}} \\approx \\frac{1}{\\sqrt{1 + 4.9383}} \\approx 0.4103$。\n输出幅值为 $V'_4 = V_4 \\cdot |H(j\\omega_4)| = 0.10 \\text{ V} \\cdot 0.4103 = 0.04103 \\text{ V}$。\n\n对于五次谐波($n=5$):\n频率为 $f_5 = 5 \\cdot 1.0 \\text{ kHz} = 5.0 \\text{ kHz}$。\n衰减因子为 $|H(j\\omega_5)| = \\frac{1}{\\sqrt{1 + (5.0/1.8)^2}} \\approx \\frac{1}{\\sqrt{1 + 7.7160}} \\approx 0.3398$。\n输出幅值为 $V'_5 = V_5 \\cdot |H(j\\omega_5)| = 0.05 \\text{ V} \\cdot 0.3398 = 0.01699 \\text{ V}$。\n\n现在，我们可以使用提供的公式和新的输出幅值来计算输出信号的THD。谐波幅值的平方和为：\n$$\\sum_{n=2}^{5} (V'_n)^2 = (V'_2)^2 + (V'_3)^2 + (V'_4)^2 + (V'_5)^2$$\n$$\\sum_{n=2}^{5} (V'_n)^2 = (0.1338)^2 + (0.07718)^2 + (0.04103)^2 + (0.01699)^2$$\n$$\\sum_{n=2}^{5} (V'_n)^2 \\approx 0.01790 + 0.005957 + 0.001683 + 0.0002887 \\approx 0.02583 \\text{ V}^2$$\n\n谐波的RMS幅值是此和的平方根：\n$$\\sqrt{\\sum_{n=2}^{5} (V'_n)^2} \\approx \\sqrt{0.02583} \\approx 0.1607 \\text{ V}$$\n\n最后，输出信号的THD是谐波RMS幅值与基波幅值之比：\n$$THD_{out} = \\frac{\\sqrt{\\sum_{n=2}^{5} (V'_n)^2}}{V'_1} \\approx \\frac{0.1607 \\text{ V}}{1.7484 \\text{ V}} \\approx 0.09191$$\n\n将结果四舍五入到三位有效数字，我们得到 0.0919。", "answer": "$$\\boxed{0.0919}$$", "id": "1342927"}]}