{"hands_on_practices": [{"introduction": "计算流体动力学的核心，特别是广泛应用的有限体积法（Finite Volume Method），在于将连续的物理守恒定律（如质量、动量和能量守恒）转化为离散的代数方程组。本练习将带你亲手体验这个过程，为一个非矩形的控制体积推导离散化的质量守恒方程。这是理解CFD求解器内部工作原理的一项基本功。[@problem_id:1764386]", "problem": "在为一个浅水河流系统开发二维计算流体动力学 (CFD) 模型的过程中，其计算域被离散化为一个由正六边形控制体积组成的网格。我们将分析单个此类控制体积的质量守恒。\n\n该控制体积是一个边长为 $L$ 的正六边形，其中心位于笛卡尔坐标系的原点 $(0,0)$。其顶点位于 $(L, 0)$、$(L/2, \\sqrt{3}L/2)$、$(-L/2, \\sqrt{3}L/2)$、$(-L, 0)$、$(-L/2, -\\sqrt{3}L/2)$ 和 $(L/2, -\\sqrt{3}L/2)$。我们假设该模型是二维的，这对应于分析一个具有均匀单位深度的水流切片。该控制体积内流体的空间平均密度用 $\\rho_P$ 表示。\n\n六边形的面按逆时针方向从 1 到 6 编号，其中面 1 是位于上半平面 ($y>0$) 的水平面。为了进行数值近似，我们认为流动性质在每个面上是均匀的。对于每个面 $i$（其中 $i=1, \\dots, 6$），流体密度为 $\\rho_i$，速度矢量由 $\\vec{v}_i = u_i \\hat{i} + v_i \\hat{j}$ 给出。\n\n基于这些定义，推导控制体积内平均密度随时间的变化率 $\\frac{d\\rho_P}{dt}$ 的表达式。答案应为一个用 $L$ 和各面性质 $\\{\\rho_i, u_i, v_i\\}$（$i=1, \\dots, 6$）表示的单个解析表达式。", "solution": "我们使用二维情况下具有单位深度的固定控制体积的积分形式质量守恒方程：\n$$\\frac{d}{dt}\\int_{A}\\rho\\,dA+\\oint_{\\partial A}\\rho\\,\\vec{v}\\cdot\\vec{n}\\,dl=0.$$\n通过 $\\int_{A}\\rho\\,dA=A\\,\\rho_{P}$ 定义面积平均密度 $\\rho_{P}$（其中面积固定），我们得到\n$$A\\,\\frac{d\\rho_{P}}{dt}+\\sum_{i=1}^{6}\\rho_{i}\\,\\vec{v}_{i}\\cdot\\vec{n}_{i}\\,l_{i}=0,$$\n其中 $l_{i}$ 是面 $i$ 的长度，$\\vec{n}_{i}$ 是其外向单位法向量。对于边长为 $L$ 的正六边形，每个面的长度为 $l_{i}=L$。边长为 $L$ 的正六边形的面积为\n$$A=6\\left(\\frac{\\sqrt{3}}{4}L^{2}\\right)=\\frac{3\\sqrt{3}}{2}\\,L^{2}.$$\n因此\n$$\\frac{d\\rho_{P}}{dt}=-\\frac{L}{A}\\sum_{i=1}^{6}\\rho_{i}\\,\\vec{v}_{i}\\cdot\\vec{n}_{i}=-\\frac{2}{3\\sqrt{3}\\,L}\\sum_{i=1}^{6}\\rho_{i}\\,\\vec{v}_{i}\\cdot\\vec{n}_{i}.$$\n将面按逆时针方向编号，面 1 为顶部的水平边。六个面的外向单位法向量为\n$$\\vec{n}_{1}=(0,1),\\quad \\vec{n}_{2}=\\left(-\\frac{\\sqrt{3}}{2},\\frac{1}{2}\\right),\\quad \\vec{n}_{3}=\\left(-\\frac{\\sqrt{3}}{2},-\\frac{1}{2}\\right),$$\n$$\\vec{n}_{4}=(0,-1),\\quad \\vec{n}_{5}=\\left(\\frac{\\sqrt{3}}{2},-\\frac{1}{2}\\right),\\quad \\vec{n}_{6}=\\left(\\frac{\\sqrt{3}}{2},\\frac{1}{2}\\right).$$\n写出 $\\vec{v}_{i}=u_{i}\\hat{i}+v_{i}\\hat{j}$ 并进行点积运算，得到\n$$\\sum_{i=1}^{6}\\rho_{i}\\,\\vec{v}_{i}\\cdot\\vec{n}_{i}=\\rho_{1}v_{1}+\\rho_{2}\\left(-\\frac{\\sqrt{3}}{2}u_{2}+\\frac{1}{2}v_{2}\\right)+\\rho_{3}\\left(-\\frac{\\sqrt{3}}{2}u_{3}-\\frac{1}{2}v_{3}\\right)-\\rho_{4}v_{4}+\\rho_{5}\\left(\\frac{\\sqrt{3}}{2}u_{5}-\\frac{1}{2}v_{5}\\right)+\\rho_{6}\\left(\\frac{\\sqrt{3}}{2}u_{6}+\\frac{1}{2}v_{6}\\right).$$\n代入并提取公因数以消去分数，得到如下紧凑表达式\n$$\\frac{d\\rho_{P}}{dt}=-\\frac{1}{3\\sqrt{3}\\,L}\\Big[2\\rho_{1}v_{1}+\\rho_{2}(-\\sqrt{3}\\,u_{2}+v_{2})+\\rho_{3}(-\\sqrt{3}\\,u_{3}-v_{3})-2\\rho_{4}v_{4}+\\rho_{5}(\\sqrt{3}\\,u_{5}-v_{5})+\\rho_{6}(\\sqrt{3}\\,u_{6}+v_{6})\\Big].$$\n此表达式即为所求的用 $L$ 和各面性质表示的平均密度随时间的变化率。", "answer": "$$\\boxed{-\\frac{1}{3\\sqrt{3}\\,L}\\left[2\\rho_{1}v_{1}+\\rho_{2}\\left(-\\sqrt{3}\\,u_{2}+v_{2}\\right)+\\rho_{3}\\left(-\\sqrt{3}\\,u_{3}-v_{3}\\right)-2\\rho_{4}v_{4}+\\rho_{5}\\left(\\sqrt{3}\\,u_{5}-v_{5}\\right)+\\rho_{6}\\left(\\sqrt{3}\\,u_{6}+v_{6}\\right)\\right]}$$", "id": "1764386"}, {"introduction": "当我们将控制方程离散化后，会得到一个代数方程系统。对于随时间演变的问题（瞬态问题），我们需要一步步地求解这些方程。本练习将通过一个污染物输运的实例，让你手动计算一个时间步长后的浓度变化，从而揭开时间推进算法的神秘面纱。这将帮助你直观地理解数值模拟是如何随时间演化的。[@problem_id:1764344]", "problem": "一位环境工程师正在对一条狭长直水道中溶解污染物的输运过程进行建模。该过程由污染物浓度 $C(x, t)$ 的一维对流-扩散方程所描述：\n$$\n\\frac{\\partial C}{\\partial t} + u \\frac{\\partial C}{\\partial x} = D \\frac{\\partial^2 C}{\\partial x^2}\n$$\n其中，$u$ 是沿水道的恒定均匀流体速度，$D$ 是污染物的恒定扩散系数。\n\n为对此方程进行数值求解，采用了计算流体动力学 (CFD) 方法。空间域被离散化为间距为 $\\Delta x$ 的均匀网格，时间以大小为 $\\Delta t$ 的离散步长向前推进。下标 $i$ 和 $n$ 分别表示空间上的网格点和时间层，因此有 $C_i^n \\approx C(i\\Delta x, n\\Delta t)$。该工程师采用了显式前向时间中心空间 (FTCS) 离散格式。\n\n模拟的相关参数如下：\n- 流体速度, $u = 0.40 \\, \\text{m/s}$\n- 扩散系数, $D = 0.015 \\, \\text{m}^2\\text{/s}$\n- 网格间距, $\\Delta x = 0.10 \\, \\text{m}$\n- 时间步长, $\\Delta t = 0.050 \\, \\text{s}$\n\n在时间 $t=0$ 时（对应于时间层 $n=0$），测得三个相邻网格点上的浓度为：\n- $C_{i-1}^0 = 2.10 \\, \\text{kg/m}^3$\n- $C_{i}^0 = 2.50 \\, \\text{kg/m}^3$\n- $C_{i+1}^0 = 2.70 \\, \\text{kg/m}^3$\n\n使用这些信息，计算单个时间步长后（即在时间层 $n+1$ 时）网格点 $i$ 上的浓度 $C_i^{n+1}$。答案以 kg/m$^3$ 为单位，并四舍五入到三位有效数字。", "solution": "我们从一维对流-扩散方程开始\n$$\n\\frac{\\partial C}{\\partial t} + u \\frac{\\partial C}{\\partial x} = D \\frac{\\partial^{2} C}{\\partial x^{2}}.\n$$\n在网格点 $i$ 和时间层 $n$ 处，使用显式前向时间中心空间 (FTCS) 格式，我们将时间和空间导数近似为\n$$\n\\frac{C_{i}^{n+1} - C_{i}^{n}}{\\Delta t} + u \\frac{C_{i+1}^{n} - C_{i-1}^{n}}{2 \\Delta x} = D \\frac{C_{i+1}^{n} - 2 C_{i}^{n} + C_{i-1}^{n}}{\\Delta x^{2}}.\n$$\n求解 $C_{i}^{n+1}$，得到显式更新公式\n$$\nC_{i}^{n+1} = C_{i}^{n} - \\frac{u \\Delta t}{2 \\Delta x} \\left(C_{i+1}^{n} - C_{i-1}^{n}\\right) + \\frac{D \\Delta t}{\\Delta x^{2}} \\left(C_{i+1}^{n} - 2 C_{i}^{n} + C_{i-1}^{n}\\right).\n$$\n定义无量纲系数 $\\alpha = \\frac{u \\Delta t}{2 \\Delta x}$ 和 $\\beta = \\frac{D \\Delta t}{\\Delta x^{2}}$。代入给定的参数值，\n$$\n\\alpha = \\frac{(0.40)\\,(0.050)}{2\\,(0.10)} = 0.10, \\quad \\beta = \\frac{(0.015)\\,(0.050)}{(0.10)^{2}} = 0.075.\n$$\n使用时间层 $n=0$ 时的初始浓度，\n$$\nC_{i+1}^{0} - C_{i-1}^{0} = 2.70 - 2.10 = 0.60, \\quad C_{i+1}^{0} - 2 C_{i}^{0} + C_{i-1}^{0} = 2.70 - 2(2.50) + 2.10 = -0.20.\n$$\n因此，\n$$\nC_{i}^{1} = 2.50 - (0.10)(0.60) + (0.075)(-0.20) = 2.50 - 0.06 - 0.015 = 2.425.\n$$\n四舍五入到三位有效数字，得到 $2.43$。", "answer": "$$\\boxed{2.43}$$", "id": "1764344"}, {"introduction": "在CFD中，选择离散格式并非随意的；一些看似合理的格式在特定条件下会产生错误的、非物理的振荡解。本练习将探讨中心差分格式在对流主导问题中的一个关键限制。通过推导单元佩克莱数（cell Péclet number, $Pe$）的临界值，你将掌握一个指导实践中选择数值格式的重要原则，以确保计算结果的物理真实性。[@problem_id:1764340]", "problem": "在计算流体动力学（CFD）领域，一个核心挑战是输运方程的精确数值求解。考虑一个标量 $\\phi$（例如，在具有稳定均匀流体流动的窄通道中污染物的浓度）的一维稳态对流扩散方程。其非守恒形式的控制方程由下式给出：\n$$u \\frac{d\\phi}{dx} - \\Gamma \\frac{d^2\\phi}{dx^2} = 0$$\n在此， $u$ 是恒定的正流体速度，$\\Gamma$ 是恒定的正扩散系数，$x$ 是空间坐标。\n\n为了对该方程进行数值求解，我们在一个由节点 $i$ 索引的均匀网格上对其进行离散化。节点 $i$ 的位置是 $x_i$，相邻节点间的恒定间距为 $\\Delta x = x_{i+1} - x_i$。我们将使用有限差分法，采用二阶中心差分格式来近似一阶导数（对流项）和二阶导数（扩散项）。\n\n对于任意内部节点 $i$，得到的代数方程可以重排为以下通用形式，该形式将一个节点上的值与其直接相邻节点联系起来：\n$$a_P \\phi_i = a_W \\phi_{i-1} + a_E \\phi_{i+1}$$\n在这种约定中，下标 $P$、$W$ 和 $E$ 分别指代中心（\"P\"oint）、西侧（$i-1$）和东侧（$i+1$）节点。\n\n一个数值格式若要产生物理上真实（即避免非物理振荡）的解，其关键要求是连接一个节点与其相邻节点的系数（$a_W$ 和 $a_E$）必须是非负的。\n\n通过如上所述离散化控制方程，确定无量纲网格佩克莱数（定义为 $Pe = \\frac{u \\Delta x}{\\Gamma}$）的最大值，使得对系数 $a_W$ 和 $a_E$ 的非负性条件得以满足。", "solution": "我们从稳态一维对流扩散方程开始\n$$u \\frac{d\\phi}{dx} - \\Gamma \\frac{d^{2}\\phi}{dx^{2}} = 0,$$\n其中 $u>0$、$\\Gamma>0$ 为常数，网格为均匀网格，间距为 $\\Delta x$。\n\n在节点 $i$ 处使用二阶中心差分，\n$$\\left.\\frac{d\\phi}{dx}\\right|_{i} \\approx \\frac{\\phi_{i+1} - \\phi_{i-1}}{2 \\Delta x}, \\qquad \\left.\\frac{d^{2}\\phi}{dx^{2}}\\right|_{i} \\approx \\frac{\\phi_{i+1} - 2 \\phi_{i} + \\phi_{i-1}}{\\Delta x^{2}}.$$\n代入微分方程可得\n$$u \\frac{\\phi_{i+1} - \\phi_{i-1}}{2 \\Delta x} - \\Gamma \\frac{\\phi_{i+1} - 2 \\phi_{i} + \\phi_{i-1}}{\\Delta x^{2}} = 0.$$\n展开并重新组合各项，\n$$\\frac{\\Gamma}{\\Delta x^{2}} \\phi_{i+1} - \\frac{2 \\Gamma}{\\Delta x^{2}} \\phi_{i} + \\frac{\\Gamma}{\\Delta x^{2}} \\phi_{i-1} - \\frac{u}{2 \\Delta x} \\phi_{i+1} + \\frac{u}{2 \\Delta x} \\phi_{i-1} = 0.$$\n将相邻项移至右侧，以匹配 $a_{P} \\phi_{i} = a_{W} \\phi_{i-1} + a_{E} \\phi_{i+1}$ 的形式：\n$$\\frac{2 \\Gamma}{\\Delta x^{2}} \\phi_{i} = \\left(\\frac{\\Gamma}{\\Delta x^{2}} + \\frac{u}{2 \\Delta x}\\right) \\phi_{i-1} + \\left(\\frac{\\Gamma}{\\Delta x^{2}} - \\frac{u}{2 \\Delta x}\\right) \\phi_{i+1}.$$\n因此，\n$$a_{P} = \\frac{2 \\Gamma}{\\Delta x^{2}}, \\quad a_{W} = \\frac{\\Gamma}{\\Delta x^{2}} + \\frac{u}{2 \\Delta x}, \\quad a_{E} = \\frac{\\Gamma}{\\Delta x^{2}} - \\frac{u}{2 \\Delta x}.$$\n\n对相邻项系数的非负性要求是\n$$a_{W} \\ge 0, \\qquad a_{E} \\ge 0.$$\n由于 $u>0$，$\\Gamma>0$ 且 $\\Delta x>0$，我们自动得到 $a_{W} > 0$。约束性条件是 $a_{E} \\ge 0$，即，\n$$\\frac{\\Gamma}{\\Delta x^{2}} - \\frac{u}{2 \\Delta x} \\ge 0 \\quad \\Longleftrightarrow \\quad \\frac{u \\Delta x}{\\Gamma} \\le 2.$$\n定义网格佩克莱数 $Pe = \\frac{u \\Delta x}{\\Gamma}$，确保 $a_{W}$ 和 $a_{E}$ 非负的最大值为\n$$Pe_{\\max} = 2.$$", "answer": "$$\\boxed{2}$$", "id": "1764340"}]}