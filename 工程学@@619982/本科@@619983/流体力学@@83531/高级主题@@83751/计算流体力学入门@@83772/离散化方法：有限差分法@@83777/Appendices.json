{"hands_on_practices": [{"introduction": "将微分方程转化为代数方程是数值建模的第一步。本练习将通过一个经典的模型方程——对流扩散方程——来实践这一过程，该方程同时包含一阶（对流）和二阶（扩散）导数。通过这个练习，你将学习如何为捕捉不同物理现象的项选择和应用合适的离散格式，例如，使用迎风格式处理对流项，以及使用中心差分格式处理扩散项 [@problem_id:1749174]。", "problem": "考虑在具有均匀单向流体流动的窄通道中，某化学组分的一维稳态输运问题。该组分的浓度记为 $\\phi(x)$，由以下对流扩散方程控制：\n$$u \\frac{d\\phi}{dx} - D \\frac{d^2\\phi}{dx^2} = 0$$\n其中，$u$ 是沿 x 轴的恒定正流体速度，$D$ 是恒定的扩散系数。\n\n为了对此方程进行数值求解，将空间域离散为网格间距恒为 $\\Delta x$ 的均匀网格。网格节点 $i$ 处的浓度值记为 $\\phi_i$。\n\n采用一阶迎风差分格式离散对流项 ($u \\frac{d\\phi}{dx}$)，并采用二阶中心差分格式离散扩散项 ($-D \\frac{d^2\\phi}{dx^2}$)，来建立数值模型。\n\n将这些离散格式应用于内部网格节点 $i$，得到的代数方程可以整理为 $A \\phi_i = B \\phi_{i-1} + C \\phi_{i+1}$ 的形式。下列哪个选项正确地表示了这个有限差分方程？\n\nA. $(2D - u \\Delta x) \\phi_i = D \\phi_{i-1} + (D - u \\Delta x) \\phi_{i+1}$\n\nB. $4D \\phi_i = (2D + u \\Delta x) \\phi_{i-1} + (2D - u \\Delta x) \\phi_{i+1}$\n\nC. $(u \\Delta x + 2D) \\phi_i = (u \\Delta x + D) \\phi_{i-1} + D \\phi_{i+1}$\n\nD. $(u \\Delta x + D) \\phi_i = (u \\Delta x + D) \\phi_{i-1}$\n\nE. $(u \\Delta x - 2D) \\phi_i = (u \\Delta x - D) \\phi_{i-1} - D \\phi_{i+1}", "solution": "目标是将给定的一维稳态对流扩散方程进行离散化，并将其整理成指定的代数形式。\n\n控制微分方程为：\n$$u \\frac{d\\phi}{dx} - D \\frac{d^2\\phi}{dx^2} = 0$$\n\n空间域以均匀间距 $\\Delta x$ 离散，节点 $i$ 处的浓度为 $\\phi_i$，其西侧邻点为 $\\phi_{i-1}$，东侧邻点为 $\\phi_{i+1}$。\n\n首先，我们离散化对流（或平流）项 $u \\frac{d\\phi}{dx}$。题目指定了使用一阶迎风差分格式。由于速度 $u$ 为正，流动方向为 x 轴正方向。因此，对于节点 $i$，“迎风”方向是流动的来源方向，即节点 $i-1$。这对应于一阶后向差分格式。\n$$u \\frac{d\\phi}{dx} \\bigg|_i \\approx u \\frac{\\phi_i - \\phi_{i-1}}{\\Delta x}$$\n\n接下来，我们离散化扩散项 $-D \\frac{d^2\\phi}{dx^2}$。题目指定了对二阶导数使用二阶中心差分格式。\n$$\\frac{d^2\\phi}{dx^2} \\bigg|_i \\approx \\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{(\\Delta x)^2}$$\n因此，离散化后的扩散项为：\n$$-D \\frac{d^2\\phi}{dx^2} \\bigg|_i \\approx -D \\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{(\\Delta x)^2}$$\n\n现在，我们将这些离散形式代回原始的控制方程中：\n$$u \\frac{\\phi_i - \\phi_{i-1}}{\\Delta x} - D \\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{(\\Delta x)^2} = 0$$\n\n为了简化并消去分母，我们将整个方程乘以 $(\\Delta x)^2$：\n$$(\\Delta x)^2 \\left( u \\frac{\\phi_i - \\phi_{i-1}}{\\Delta x} \\right) - (\\Delta x)^2 \\left( D \\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{(\\Delta x)^2} \\right) = 0$$\n$$u \\Delta x (\\phi_i - \\phi_{i-1}) - D (\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}) = 0$$\n\n现在，我们展开各项：\n$$u \\Delta x \\phi_i - u \\Delta x \\phi_{i-1} - D \\phi_{i+1} + 2D \\phi_i - D \\phi_{i-1} = 0$$\n\n最后一步是将此方程整理成 $A \\phi_i = B \\phi_{i-1} + C \\phi_{i+1}$ 的形式。我们将所有包含 $\\phi_i$ 的项合并到等式左边，所有其他项移到等式右边。\n\n合并含 $\\phi_i$ 的项：\n$$(u \\Delta x + 2D) \\phi_i$$\n\n合并含 $\\phi_{i-1}$ 和 $\\phi_{i+1}$ 的项并移到右边：\n$$u \\Delta x \\phi_{i-1} + D \\phi_{i-1} + D \\phi_{i+1}$$\n$$(u \\Delta x + D) \\phi_{i-1} + D \\phi_{i+1}$$\n\n令左右两侧相等，得到最终整理后的代数方程：\n$$(u \\Delta x + 2D) \\phi_i = (u \\Delta x + D) \\phi_{i-1} + D \\phi_{i+1}$$\n\n将此结果与给定选项进行比较：\nA. $(2D - u \\Delta x) \\phi_i = D \\phi_{i-1} + (D - u \\Delta x) \\phi_{i+1}$ (错误，这是对流项使用前向差分的结果)\nB. $4D \\phi_i = (2D + u \\Delta x) \\phi_{i-1} + (2D - u \\Delta x) \\phi_{i+1}$ (错误，这是对流项使用中心差分的结果)\nC. $(u \\Delta x + 2D) \\phi_i = (u \\Delta x + D) \\phi_{i-1} + D \\phi_{i+1}$ (正确)\nD. $(u \\Delta x + D) \\phi_i = (u \\Delta x + D) \\phi_{i-1}$ (错误，缺少扩散项和 $\\phi_{i+1}$ 项)\nE. $(u \\Delta x - 2D) \\phi_i = (u \\Delta x - D) \\phi_{i-1} - D \\phi_{i+1}$ (错误，处理扩散项时出现符号错误)\n\n因此，正确选项是 C。", "answer": "$$\\boxed{C}$$", "id": "1749174"}, {"introduction": "虽然均匀网格便于教学和理解，但现实世界的问题往往需要非均匀网格来更高效地解析特定区域的复杂流动特征，例如边界层。本练习将带你超越简单的教科书公式，挑战你在非均匀网格上推导一个二阶精度的导数近似格式 [@problem_id:1749171]。掌握这项技术对于开发灵活高效的数值求解器至关重要，它展示了有限差分法的更普适的应用。", "problem": "在开发一维流体流动的数值求解器时，一个常见的任务是评估作为流体驱动力的压力梯度。考虑一个场景，其中压力场 $p(x)$ 仅在非均匀计算网格上的一系列离散点上是已知的。我们感兴趣的是，在位于位置 $x_i$ 的特定网格点（节点）$i$ 处，为压力梯度找到一个高精度近似。该节点处的压力为 $p_i$。其相邻节点分别是：位于位置 $x_{i-1}$、压力为 $p_{i-1}$ 的节点 $i-1$，以及位于位置 $x_{i+1}$、压力为 $p_{i+1}$ 的节点 $i+1$。网格间距不恒定，因此一般有 $x_{i+1} - x_i \\neq x_i - x_{i-1}$。\n\n您的任务是为位置 $x_i$ 处的压力梯度 $\\frac{dp}{dx}$ 推导一个二阶精度的有限差分近似。请将您的最终答案表示为一个解析表达式，该表达式使用给定的网格点位置 $x_{i-1}$、$x_i$、$x_{i+1}$ 和相应的压力值 $p_{i-1}$、$p_i$、$p_{i+1}$ 来表示。", "solution": "我们寻求使用三个点 $(x_{i-1},p_{i-1})$、$(x_{i},p_{i})$ 和 $(x_{i+1},p_{i+1})$，在非均匀网格上对 $\\left.\\frac{dp}{dx}\\right|_{x_{i}}$ 进行二阶精度的近似。令 $h_{-}=x_{i}-x_{i-1}$ 且 $h_{+}=x_{i+1}-x_{i}$。构造二次拉格朗日插值多项式 $p(x)\\approx \\sum_{j\\in\\{i-1,i,i+1\\}} p_{j} L_{j}(x)$，其中\n$$\nL_{i-1}(x)=\\frac{(x-x_{i})(x-x_{i+1})}{(x_{i-1}-x_{i})(x_{i-1}-x_{i+1})},\\quad\nL_{i}(x)=\\frac{(x-x_{i-1})(x-x_{i+1})}{(x_{i}-x_{i-1})(x_{i}-x_{i+1})},\\quad\nL_{i+1}(x)=\\frac{(x-x_{i-1})(x-x_{i})}{(x_{i+1}-x_{i-1})(x_{i+1}-x_{i})}.\n$$\n那么\n$$\n\\left.\\frac{dp}{dx}\\right|_{x_{i}} \\approx p_{i-1} L_{i-1}'(x_{i})+p_{i} L_{i}'(x_{i})+p_{i+1} L_{i+1}'(x_{i}).\n$$\n对每个基函数求导，并在 $x=x_{i}$ 处求值。使用恒等式 $x_{i-1}-x_{i}=-h_{-}$、$x_{i-1}-x_{i+1}=-(h_{-}+h_{+})$、$x_{i}-x_{i-1}=h_{-}$、$x_{i}-x_{i+1}=-h_{+}$、$x_{i+1}-x_{i-1}=h_{-}+h_{+}$ 以及 $x_{i+1}-x_{i}=h_{+}$，我们得到\n$$\nL_{i-1}'(x_{i})=-\\frac{h_{+}}{h_{-}(h_{-}+h_{+})},\\quad\nL_{i}'(x_{i})=\\frac{h_{+}-h_{-}}{h_{-}h_{+}},\\quad\nL_{i+1}'(x_{i})=\\frac{h_{-}}{h_{+}(h_{-}+h_{+})}.\n$$\n因此，\n$$\n\\left.\\frac{dp}{dx}\\right|_{x_{i}} \\approx -\\frac{h_{+}}{h_{-}(h_{-}+h_{+})}p_{i-1}+\\frac{h_{+}-h_{-}}{h_{-}h_{+}}p_{i}+\\frac{h_{-}}{h_{+}(h_{-}+h_{+})}p_{i+1}.\n$$\n将 $h_{-}=x_{i}-x_{i-1}$ 和 $h_{+}=x_{i+1}-x_{i}$ 代回，得到以网格位置表示的所需表达式：\n$$\n\\left.\\frac{dp}{dx}\\right|_{x_{i}} \\approx -\\frac{x_{i+1}-x_{i}}{(x_{i}-x_{i-1})(x_{i+1}-x_{i-1})}p_{i-1}+\\frac{(x_{i+1}-x_{i})-(x_{i}-x_{i-1})}{(x_{i}-x_{i-1})(x_{i+1}-x_{i})}p_{i}+\\frac{x_{i}-x_{i-1}}{(x_{i+1}-x_{i})(x_{i+1}-x_{i-1})}p_{i+1}.\n$$\n因为这是通过这三个节点的二次拉格朗日插值多项式的导数，所以在光滑场上，其截断误差为 $O(h^{2})$，从而在非均匀网格上提供了一个二阶精度的近似。", "answer": "$$\\boxed{-\\frac{x_{i+1}-x_{i}}{(x_{i}-x_{i-1})(x_{i+1}-x_{i-1})}p_{i-1}+\\frac{(x_{i+1}-x_{i})-(x_{i}-x_{i-1})}{(x_{i}-x_{i-1})(x_{i+1}-x_{i})}p_{i}+\\frac{x_{i}-x_{i-1}}{(x_{i+1}-x_{i})(x_{i+1}-x_{i-1})}p_{i+1}}$$", "id": "1749171"}, {"introduction": "流体动力学问题本质上是多维的，因此将一维的离散化思想扩展到更高维度是必要的技能。本练习将通过处理混合偏导数项 $\\frac{\\partial^2 u}{\\partial x \\partial y}$，将你的技能扩展到二维空间，该项在黏性流动的控制方程中（如纳维-斯托克斯方程）频繁出现。你将学习如何通过依次应用一维差分算子来构建二维计算模板，这是解决多维问题的基本方法 [@problem_id:1749175]。", "problem": "在粘性流体流动的数值模拟中，控制方程的离散化是一个基本步骤。考虑一个场景：您正在开发一个有限差分法 (FDM) 代码来求解纳维-斯托克斯方程。在一个均匀的笛卡尔网格上，粘性应力张量分量中出现的一个关键项是混合偏导数。\n\n计算域由一个均匀的笛卡尔网格组成，其中网格点由坐标 $(x_i, y_j) = (i \\Delta x, j \\Delta y)$ 表示，$i, j$ 为整数索引，$\\Delta x$ 和 $\\Delta y$ 为恒定的网格间距。一个标量场（例如 x 方向的速度分量 $u$）在网格点 $(x_i, y_j)$ 上的值记为 $u_{i,j}$。\n\n您的任务是推导在网格节点 $(i,j)$ 处混合偏导数项 $\\frac{\\partial^2 u}{\\partial x \\partial y}$ 的二阶精度有限差分近似。该推导必须通过依次应用用于一阶导数的二阶中心差分算子来进行。请以单个代数表达式的形式提供最终的近似，该表达式用 $u$ 在网格点上的值（例如，$u_{i,j}, u_{i+1,j}$ 等）以及网格间距 $\\Delta x$ 和 $\\Delta y$ 来表示。", "solution": "我们通过依次应用用于一阶导数的二阶中心差分算子，来寻求在点 $(i,j)$ 处混合导数 $\\frac{\\partial^{2} u}{\\partial x \\partial y}$ 的一个二阶精度近似。\n\n对于均匀笛卡尔网格（间距为 $\\Delta x$ 和 $\\Delta y$）上的光滑函数 $u(x,y)$，其在点 $(i,j)$ 处对 $y$ 的一阶导数的二阶中心差分近似为\n$$\n\\left(\\frac{\\partial u}{\\partial y}\\right)_{i,j} = \\frac{u_{i,j+1} - u_{i,j-1}}{2 \\Delta y} + \\mathcal{O}(\\Delta y^{2}).\n$$\n为得到 $\\frac{\\partial^{2} u}{\\partial x \\partial y}$，我们使用关于 $x$ 的二阶中心差分对上式求关于 $x$ 的导数：\n$$\n\\left(\\frac{\\partial^{2} u}{\\partial x \\partial y}\\right)_{i,j} = \\frac{\\left(\\frac{\\partial u}{\\partial y}\\right)_{i+1,j} - \\left(\\frac{\\partial u}{\\partial y}\\right)_{i-1,j}}{2 \\Delta x} + \\mathcal{O}(\\Delta x^{2}).\n$$\n现在，我们用关于 $y$ 的二阶中心差分来近似在点 $(i+1,j)$ 和 $(i-1,j)$ 处的 $y$ 向导数：\n$$\n\\left(\\frac{\\partial u}{\\partial y}\\right)_{i+1,j} = \\frac{u_{i+1,j+1} - u_{i+1,j-1}}{2 \\Delta y} + \\mathcal{O}(\\Delta y^{2}), \\quad\n\\left(\\frac{\\partial u}{\\partial y}\\right)_{i-1,j} = \\frac{u_{i-1,j+1} - u_{i-1,j-1}}{2 \\Delta y} + \\mathcal{O}(\\Delta y^{2}).\n$$\n将这些代入关于 $x$ 的差分表达式中，得到\n$$\n\\left(\\frac{\\partial^{2} u}{\\partial x \\partial y}\\right)_{i,j} = \\frac{1}{2 \\Delta x} \\left[ \\frac{u_{i+1,j+1} - u_{i+1,j-1}}{2 \\Delta y} - \\frac{u_{i-1,j+1} - u_{i-1,j-1}}{2 \\Delta y} \\right] + \\mathcal{O}(\\Delta x^{2} + \\Delta y^{2}).\n$$\n合并同类项即可得到标准的紧凑差分格式\n$$\n\\left(\\frac{\\partial^{2} u}{\\partial x \\partial y}\\right)_{i,j} = \\frac{u_{i+1,j+1} - u_{i+1,j-1} - u_{i-1,j+1} + u_{i-1,j-1}}{4 \\Delta x \\Delta y} + \\mathcal{O}(\\Delta x^{2} + \\Delta y^{2}).\n$$\n因此，通过依次应用一阶导数的中心差分所得到的二阶精度有限差分近似，即为上述的四点公式。", "answer": "$$\\boxed{\\frac{u_{i+1,j+1} - u_{i+1,j-1} - u_{i-1,j+1} + u_{i-1,j-1}}{4\\,\\Delta x\\,\\Delta y}}$$", "id": "1749175"}]}