{"hands_on_practices": [{"introduction": "后向台阶流是计算流体力学 (CFD) 中一个经典的基准问题，用于检验数值方法的准确性和效率。本练习的目标不仅仅是创建一个网格，而是通过只在需要的地方布置高分辨率来创建一个高效的网格。这个问题将挑战你识别高速度梯度的区域，例如边界层和回流区，这是任何成功模拟的关键技能。[@problem_id:1761175]", "problem": "在计算流体动力学（CFD）领域，数值模拟的准确性在很大程度上取决于用于离散化计算域的计算网格的质量。考虑一个经典的二维、不可压缩、层流流过一个突然扩张的通道的问题，该问题通常被称为后向台阶流。该通道在台阶上游的高度为 $H$，下游的高度为 $H_2 > H$。流体以均匀的速度剖面从左侧进入，并在向右移动时发展。\n\n为了成功进行模拟，必须设计网格以准确捕捉重要的流动特征。“网格密度”指的是特定区域内网格点或单元的集中程度。在流动变量（如速度或压力）变化剧烈的区域，需要更高的密度。“结构化网格”由规则、重复的单元模式（例如二维中的四边形）组成，其中每个网格点都可以通过整数索引（i, j）来识别。\n\n下列哪种描述代表了模拟这种后向台阶流最合适且最高效的网格设计策略？\n\nA. 在整个计算域上使用高密度且均匀的结构化网格，以确保各处都具有最大的先验准确性。\nB. 使用由三角形组成的非结构化网格，最高网格密度位于远离任何固体壁面的主流核心区域，以最好地捕捉整体流体运动。\nC. 将结构化网格划分为若干块（多块网格）。网格线在所有固体壁面附近密集聚类，特别是在紧邻台阶拐角下游的区域内，单元集中度更高。\nD. 仅在通道的入口和出口边界附近使用高密度结构化网格，而在中间部分使用非常粗糙的网格，以节省计算成本。\nE. 使用均匀的结构化网格，其单元尺寸由最小的几何特征（即台阶本身的尖角）决定。", "solution": "对于二维不可压缩层流后向台阶流，决定网格需求的主导流动特征如下：(i) 沿所有固体壁面（上游和下游）的无滑移边界层，这会产生陡峭的壁面法向梯度，需要近壁面网格加密以保证准确性和稳定性；(ii) 台阶处的突然扩张会产生逆压梯度，并导致在台阶拐角处发生流动分离，紧随其后产生一个回流泡；(iii) 从台阶拐角处发出的自由剪切层，向下游发展，并在有限距离处重新附着到壁面上，之后边界层重新发展。速度和压力的最大空间梯度出现在壁面处、分离的剪切层内以及台阶下游紧邻的回流和再附着发生的区域。高效的网格将高密度分配给这些区域，并允许在梯度较低的主流核心区域进行网格粗化。\n\n与壁面对齐的结构化网格能很好地控制正交性和拉伸，从而减少沿流向的数值扩散，并允许在壁面法向进行有效的加密，以满足近壁面分辨率要求（例如，对于层流解析，第一层单元高度要小，以满足所需的 $y^{+}$）。台阶处的几何不连续性可以通过多块结构化拓扑结构自然地处理，从而能够在拐角周围、沿分离的剪切层以及整个回流区域实现局部加密和网格间距的平滑过渡，同时保持远场核心流动的网格相对粗糙。这在需要的地方实现了准确性，并在其他地方实现了计算效率。\n\n评估选项：\n- A 选项在所有地方都使用高密度、均匀的网格。虽然准确，但效率低下，因为它在梯度较弱的区域浪费了单元，并违反了目标性加密的原则。\n- B 选项将最高密度置于远离壁面的核心区域。这错误地分配了分辨率；与壁面和剪切层相比，核心区的梯度相对平缓，因此关键的近壁面和台阶后区域将得不到充分解析。\n- C 选项采用多块结构化网格，在所有壁面附近进行加密，特别是在台阶下游。这与物理现象相符：它有效地解析了边界层、分离的剪切层、回流泡和再附着区，同时允许在核心区使用较粗的间距。\n- D 选项仅在入口和出口附近加密，而将中间部分粗化，这未能解析关键的台阶后分离和剪切层动力学。\n- E 选项强制使用由最小特征（拐角）尺寸决定的均匀网格，这在全局上是低效的，并且没有提供所需的各向异性近壁面加密和局部的台阶后加密。\n\n因此，最合适且最高效的策略是采用多块结构化网格，在壁面附近进行加密，并在紧邻台阶下游的区域进行重点加密，这与选项C相对应。", "answer": "$$\\boxed{C}$$", "id": "1761175"}, {"introduction": "现实世界的几何形状很少是简单的矩形，这给结构化网格的生成带来了挑战。本练习介绍“多块结构化网格”技术，它是一种将复杂域分解为多个拓扑简单的块，从而为复杂形状生成高质量结构化网格的强大方法。T形管连接问题提供了一个清晰、易于管理的场景，以检验你对区域分解规则的理解。[@problem_id:1761243]", "problem": "在计算流体力学中，复杂的几何形状通常被分解为拓扑上更简单的矩形区域，以利于生成高质量的结构化网格。这种技术被称为多块结构化网格生成。\n\n考虑一个代表T形接管的二维域。该域 $D$ 在笛卡尔坐标系 $(x,y)$ 中定义为两个矩形区域的并集：一个水平通道 $R_H$ 和一个垂直通道 $R_V$。\n- 水平通道定义为 $R_H = \\{(x, y) | -L \\le x \\le L, -W \\le y \\le 0\\}$。\n- 垂直通道定义为 $R_V = \\{(x, y) | -W \\le x \\le W, 0 \\le y \\le H\\}$。\n其中，$L$、$W$和$H$为正常数，且 $L > W$。\n\n域 $D$ 的一个有效多块分解必须满足两个条件：\n1. 所有块的并集必须与域 $D$ 完全相同。\n2. 任意两个不同块的内部必须不相交（即块不能重叠，但可以共享边界）。\n\n以下哪个选项描述了T形接管域 $D$ 的一个有效多块分解？\n\nA. 一个三块分解，定义如下：\n- 块 1: $[-L, -W] \\times [-W, 0]$\n- 块 2: $[W, L] \\times [-W, 0]$\n- 块 3: $[-W, W] \\times [-W, H]$\n\nB. 一个两块分解，定义如下：\n- 块 1: $[-L, L] \\times [-W, 0]$\n- 块 2: $[-W, W] \\times [-W, H]$\n\nC. 一个三块分解，定义如下：\n- 块 1: $[-L, -W] \\times [-W, 0]$\n- 块 2: $[W, L] \\times [-W, 0]$\n- 块 3: $[-W, W] \\times [0, H]$\n\nD. 一个两块分解，定义如下：\n- 块 1: $[-L, 0] \\times [-W, 0]$\n- 块 2: $[0, L] \\times [0, H]$", "solution": "域是并集 $D=R_{H}\\cup R_{V}$，其中 $R_{H}=[-L,L]\\times[-W,0]$ 且 $R_{V}=[-W,W]\\times[0,H]$。一个有效的多块分解必须满足：\n(i) 块的并集恰好等于 $D$，以及\n(ii) 不同块的内部不相交。对于一个闭合矩形 $[a,b]\\times[c,d]$，其内部是 $(a,b)\\times(c,d)$。\n\n检查A：\n- 块：$B_{1}=[-L,-W]\\times[-W,0]$, $B_{2}=[W,L]\\times[-W,0]$, $B_{3}=[-W,W]\\times[-W,H]$。\n- 并集：$B_{1}\\cup B_{2}\\cup B_{3}=\\bigl([-L,-W]\\times[-W,0]\\bigr)\\cup\\bigl([-W,W]\\times[-W,H]\\bigr)\\cup\\bigl([W,L]\\times[-W,0]\\bigr)$。其结果等于 $[-L,L]\\times[-W,0]\\;\\cup\\;[-W,W]\\times[0,H]=R_{H}\\cup R_{V}=D$。\n- 内部：$\\operatorname{int}(B_{1})=(-L,-W)\\times(-W,0)$, $\\operatorname{int}(B_{2})=(W,L)\\times(-W,0)$, $\\operatorname{int}(B_{3})=(-W,W)\\times(-W,H)$。这些块内部的 $x$ 区间两两不相交，因此对于 $i\\ne j$ 有 $\\operatorname{int}(B_{i})\\cap\\operatorname{int}(B_{j})=\\varnothing$。所以A是有效的。\n\n检查B：\n- 块：$B_{1}=[-L,L]\\times[-W,0]$, $B_{2}=[-W,W]\\times[-W,H]$。\n- 并集：$B_{1}\\cup B_{2}=R_{H}\\cup R_{V}=D$。\n- 内部：$\\operatorname{int}(B_{1})=(-L,L)\\times(-W,0)$ 且 $\\operatorname{int}(B_{2})=(-W,W)\\times(-W,H)$。它们的交集是 $(-W,W)\\times(-W,0)\\ne\\varnothing$。内部区域重叠，所以B是无效的。\n\n检查C：\n- 块：$B_{1}=[-L,-W]\\times[-W,0]$, $B_{2}=[W,L]\\times[-W,0]$, $B_{3}=[-W,W]\\times[0,H]$。\n- 集合 $[-W,W]\\times[-W,0]\\subset R_{H}$ 没有被任何块覆盖，所以并集是 $D$ 的一个真子集。因此C是无效的。\n\n检查D：\n- 块：$B_{1}=[-L,0]\\times[-W,0]$, $B_{2}=[0,L]\\times[0,H]$。\n- 区域 $[0,L]\\times[-W,0]\\subset R_{H}$ 缺失了，并且 $[W,L]\\times[0,H]\\subset B_{2}$ 位于 $D$ 之外，因为 $R_{V}$ 要求 $x\\in[-W,W]$。因此并集不等于 $D$。D是无效的。\n\n因此，只有选项A满足所有两个条件。", "answer": "$$\\boxed{A}$$", "id": "1761243"}, {"introduction": "网格划分的决策不仅影响几何精度，还直接决定了求解过程的计算成本。本练习将焦点从网格的几何形状转移到其对计算性能的影响上。这个问题将阐明一个看似简单的网格拓扑结构和节点编号方案的选择，如何对线性系统求解器的性能产生巨大影响，从而突显网格划分与计算效率之间的深刻联系。[@problem_id:1761189]", "problem": "在计算流体动力学中，对物理域上的偏微分方程进行离散化，通常会产生一个形如 $A\\mathbf{x} = \\mathbf{b}$ 的大型线性代数方程组。矩阵 $A$ 的结构由网格拓扑和节点排序方案决定，而这些因素又显著影响求解该方程组的计算成本。\n\n考虑一个二维矩形结构化网格，其在x方向有 $N_x$ 个节点，在y方向有 $N_y$ 个节点。节点总数为 $N = N_x N_y$。离散化采用五点有限差分格式，这意味着每个内部节点 $(i,j)$ 仅与其四个直接相邻的节点耦合：$(i-1, j)$、$(i+1, j)$、$(i, j-1)$ 和 $(i, j+1)$。\n\n为构造矩阵 $A$，需将二维网格节点映射到一个一维未知数向量 $\\mathbf{x}$。此处采用一种自然的逐行排序方案，其中坐标为 $(i,j)$（$1 \\le i \\le N_x$ 且 $1 \\le j \\le N_y$）的二维网格点通过公式 $k = (j-1)N_x + i$ 映射到一维向量索引 $k$。\n\n使用利用矩阵带状结构的直接求解器（如带状LU分解）求解该系统的计算成本（以浮点运算次数衡量）近似正比于 $N B^2$，其中 $B$ 是矩阵 $A$ 的半带宽。半带宽定义为：对于 $r \\ne c$，使矩阵元素 $A_{rc}$ 可以为非零的最大绝对差 $|r-c|$。\n\n一位工程师的任务是模拟流过一个矩形平板的流动，需要生成一个恰好包含 $10,000$ 个节点的网格。他们正在考虑两种不同的结构化网格配置：\n- **情况1：** 高纵横比网格，其中 $N_x = 2000$ 且 $N_y = 5$。\n- **情况2：** 单位纵横比网格，其中 $N_x = 100$ 且 $N_y = 100$。\n\n假设两种情况都使用相同的逐行排序方案和直接求解器，计算情况1与情况2的计算成本之比。", "solution": "给定一个结构化网格，其从二维索引 $(i,j)$ 到一维索引 $k$ 的映射由 $k=(j-1)N_{x}+i$ 定义。使用五点格式，每个内部节点与其位于 $(i-1,j)$、$(i+1,j)$、$(i,j-1)$ 和 $(i,j+1)$ 的邻居节点耦合。\n\n在此映射下：\n- $(i-1,j)$ 和 $(i+1,j)$ 分别映射到索引 $k-1$ 和 $k+1$，得到 $|r-c|=1$。\n- $(i,j-1)$ 和 $(i,j+1)$ 分别映射到索引 $k-N_{x}$ 和 $k+N_{x}$，得到 $|r-c|=N_{x}$。\n\n根据给定的定义，半带宽 $B$ 是当 $r\\ne c$ 时，使得 $A_{rc}\\neq 0$ 的最大 $|r-c|$。因此，\n$$\nB=N_{x}\n$$\n带状直接求解器的计算成本与 $N B^{2}$ 成正比。对于这两种情况，$N=N_{x}N_{y}=10000$，因此情况1与情况2的成本比为\n$$\n\\frac{N B_{1}^{2}}{N B_{2}^{2}}=\\frac{B_{1}^{2}}{B_{2}^{2}}=\\frac{N_{x,1}^{2}}{N_{x,2}^{2}}=\\frac{2000^{2}}{100^{2}}=400\n$$\n因此，与情况2相比，情况1的计算成本高出 $400$ 倍。", "answer": "$$\\boxed{400}$$", "id": "1761189"}]}