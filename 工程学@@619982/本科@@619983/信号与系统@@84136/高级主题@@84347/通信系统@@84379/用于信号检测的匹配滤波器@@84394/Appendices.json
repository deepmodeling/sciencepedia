{"hands_on_practices": [{"introduction": "我们从一个最基本的问题开始：匹配滤波器的输出在时间上究竟是什么样的？本练习将引导你计算一个简单的矩形脉冲信号 $s(t)$ 与其匹配滤波器 $h(t)$ 进行卷积的结果。这个结果——一个三角形波形——不仅仅是一个数学上的巧合，它实际上是信号的自相关函数，其峰值点代表了信号检测确定性最高的时刻。通过这个练习，你将对匹配滤波器如何通过“塑形”输入信号来最大化特定时刻的输出建立起直观的理解。[@problem_id:1736683]", "problem": "在一个简化的基带数字通信系统中，使用一个矩形脉冲来表示二进制的'1'。该脉冲记为 $s(t)$，其持续时间为 $T$，幅度为单位幅度。其定义为：\n$$s(t) = u(t) - u(t-T)$$\n其中 $u(t)$ 是亥维赛单位阶跃函数(Heaviside unit step function)，定义为当 $t \\ge 0$ 时 $u(t) = 1$，当 $t < 0$ 时 $u(t) = 0$。\n\n为了在接收端的特定时刻最大化信噪比，系统采用了一个匹配滤波器。与信号 $g(t)$ 相匹配的滤波器的冲激响应通常由 $h(t) = g(T_d - t)$ 给出，其中 $T_d$ 是一个表示时间延迟的设计参数。对于本系统，通过选择延迟等于脉冲持续时间，使滤波器变为因果的，因此其冲激响应为 $h(t) = s(T - t)$。\n\n假设传输的脉冲 $s(t)$ 是该匹配滤波器的输入。请确定输出波形 $y(t)$ 作为时间 $t$ 和参数 $T$ 的函数的完整数学表达式。你的答案应该用单位斜坡函数表示，其定义为 $r(t) = t u(t)$。", "solution": "匹配滤波器的输出是输入脉冲与冲激响应的卷积：\n$$\ny(t) = (s * h)(t), \\quad \\text{with} \\quad s(t) = u(t) - u(t - T), \\quad h(t) = s(T - t).\n$$\n由于 $s(t)$ 是一个宽度为 $T$ 的单位幅度矩形脉冲，因此 $h(t)$ 也是一个宽度为 $T$ 的矩形脉冲（经过时间反转和平移以确保因果性）。对于分段连续信号的卷积，孤立时间点上的值不影响结果；因此我们可以等效地使用因果表示\n$$\nh(t) \\equiv u(t) - u(t - T)\n$$\n来计算卷积。因此，\n$$\ny(t) = \\big(u - u(\\cdot - T)\\big) * \\big(u - u(\\cdot - T)\\big).\n$$\n根据卷积的线性性质，\n$$\ny(t) = u * u \\;-\\; u * u(t - T) \\;-\\; u(t - T) * u \\;+\\; u(t - T) * u(t - T).\n$$\n使用标准结果 $u * u = r(t)$（其中 $r(t) = t\\,u(t)$）以及卷积的时移性质，\n$$\nu * u(t - T) = r(t - T), \\quad u(t - T) * u = r(t - T), \\quad u(t - T) * u(t - T) = r(t - 2T).\n$$\n将这些代入 $y(t)$ 的表达式中，得到\n$$\ny(t) = r(t) - 2\\,r(t - T) + r(t - 2T),\n$$\n这是一个底为 $2T$、在 $t = T$ 处峰值为 $T$ 的三角波形，这与匹配滤波器输出的预期结果相符（等于在滞后 $t - T$ 处计算的 $s(t)$ 的自相关）。", "answer": "$$\\boxed{r(t) - 2\\,r(t - T) + r(t - 2T)}$$", "id": "1736683"}, {"introduction": "理想的通信条件在工程实践中极为罕见。本练习引入了一个常见的现实世界中的不完美情况：接收信号中存在一个直流偏置（DC offset）。你将分析这种恒定的干扰如何影响信噪比 $SNR$，这迫使我们必须清晰地区分期望信号的能量和所有不期望成分（包括随机噪声和确定性干扰）的总功率。这个过程将加深你对信噪比定义的理解，并展示在实际应用中评估系统性能时需要考虑的因素。[@problem_id:1736640]", "problem": "在一个数字通信系统中，一个二进制数据流使用简单的矩形脉冲成形方案进行传输。该系统被设计为长期来看是零均值的，即信号脉冲 $s(t)$ 与其反相 $-s(t)$ 的传输概率相等。在我们的分析中，我们关注单个脉冲 $s(t)$ 的检测，其定义如下：\n$$\ns(t) = \\begin{cases} A & \\text{若 } 0 \\le t \\le T \\\\ 0 & \\text{其它情况} \\end{cases}\n$$\n其中 $A$ 和 $T$ 是正常数。\n\n接收机采用一个与信号 $s(t)$ 匹配的滤波器，以在加性高斯白噪声 (AWGN) 存在的情况下最大化脉冲的可检测性。该噪声具有恒定的双边功率谱密度 $N_0/2$。匹配滤波器的输出在最佳时刻被采样，以获得最高信噪比 (SNR)。\n\n在理想情况下，接收信号为 $r_{ideal}(t) = s(t) + n(t)$，其中 $n(t)$ 是加性高斯白噪声。性能由输出信噪比（记为 $SNR_{ideal}$）来衡量，其定义为采样时刻滤波器输出端信号分量的平方值，除以输出端噪声分量的平均功率（方差）。\n\n现在，考虑一个非理想的、性能下降的情况，其中由于接收机模拟前端的缺陷，一个小的、未知的但恒定的直流偏置 $C$ 污染了信号。此时接收信号为 $r_{degraded}(t) = s(t) + C + n(t)$。使用的仍然是相同的匹配滤波器。在这种情况下，直流偏置充当一种干扰。下降后的性能由 $SNR_{degraded}$ 衡量，其中输出端的“信号”功率仍然仅由 $s(t)$ 产生，但输出端的“总噪声”功率是 AWGN 产生的功率与直流偏置 $C$ 产生的功率之和。\n\n计算比率 $\\frac{SNR_{degraded}}{SNR_{ideal}}$ 来量化性能的下降程度。将您的答案表示为关于 $C$、$T$ 和 $N_0$ 的闭式解析表达式。", "solution": "设 $s(t)$ 为实值函数，且时限于 $[0,T]$。将其能量和面积定义为\n$$\nE_{s} \\equiv \\int_{-\\infty}^{\\infty} s^{2}(t)\\,dt, \n\\qquad\nS_{1} \\equiv \\int_{-\\infty}^{\\infty} s(t)\\,dt.\n$$\n对于给定的矩形脉冲，当 $t \\in [0,T]$ 时 $s(t)=A$，其它情况下为零，\n$$\nE_{s}=\\int_{0}^{T} A^{2}\\,dt = A^{2}T,\n\\qquad\nS_{1}=\\int_{0}^{T} A\\,dt = AT.\n$$\n\n使用匹配滤波器 $h(t)=s(T-t)$，在 $t=T$ 时刻的采样值是相关值 $y(T)=\\int_{-\\infty}^{\\infty} s(u)\\,r(u)\\,du$。\n\n理想情况 $r_{\\text{ideal}}(t)=s(t)+n(t)$：\n- 输出采样值处的信号分量为\n$$\ny_{s}(T)=\\int s(u)\\,s(u)\\,du=E_{s}.\n$$\n- 噪声分量是 $y_{n}(T)=\\int s(u)\\,n(u)\\,du$，它是一个零均值高斯随机变量，其方差为\n$$\n\\operatorname{Var}\\{y_{n}(T)\\}=\\frac{N_{0}}{2}\\int s^{2}(u)\\,du=\\frac{N_{0}}{2}E_{s}.\n$$\n因此，\n$$\nSNR_{\\text{ideal}}=\\frac{\\left(y_{s}(T)\\right)^{2}}{\\operatorname{Var}\\{y_{n}(T)\\}}=\\frac{E_{s}^{2}}{\\left(\\frac{N_{0}}{2}\\right)E_{s}}=\\frac{2E_{s}}{N_{0}}.\n$$\n\n性能下降的情况 $r_{\\text{degraded}}(t)=s(t)+C+n(t)$：\n- 输出采样值分解为\n$$\ny(T)=\\int s(u)\\,s(u)\\,du+\\int s(u)\\,C\\,du+\\int s(u)\\,n(u)\\,du\n=E_{s}+C\\,S_{1}+y_{n}(T).\n$$\n- 信号分量仍然是 $E_{s}$。来自直流偏置的干扰是确定性项 $C\\,S_{1}$，其在采样点的功率贡献为 $(C\\,S_{1})^{2}$。AWGN 贡献的方差为 $\\left(\\frac{N_{0}}{2}\\right)E_{s}$。因此，输出采样点的总噪声加干扰功率为\n$$\n\\left(\\frac{N_{0}}{2}\\right)E_{s}+(C\\,S_{1})^{2}.\n$$\n从而，\n$$\nSNR_{\\text{degraded}}=\\frac{E_{s}^{2}}{\\left(\\frac{N_{0}}{2}\\right)E_{s}+C^{2}S_{1}^{2}}.\n$$\n\n性能下降比率为\n$$\n\\frac{SNR_{\\text{degraded}}}{SNR_{\\text{ideal}}}\n=\\frac{\\dfrac{E_{s}^{2}}{\\left(\\frac{N_{0}}{2}\\right)E_{s}+C^{2}S_{1}^{2}}}{\\dfrac{E_{s}^{2}}{\\left(\\frac{N_{0}}{2}\\right)E_{s}}}\n=\\frac{\\left(\\frac{N_{0}}{2}\\right)E_{s}}{\\left(\\frac{N_{0}}{2}\\right)E_{s}+C^{2}S_{1}^{2}}\n=\\frac{1}{1+\\dfrac{2\\,C^{2}S_{1}^{2}}{N_{0}E_{s}}}.\n$$\n对于矩形脉冲，$E_{s}=A^{2}T$ 且 $S_{1}=AT$，所以\n$$\n\\frac{2\\,C^{2}S_{1}^{2}}{N_{0}E_{s}}=\\frac{2\\,C^{2}\\,A^{2}T^{2}}{N_{0}\\,A^{2}T}=\\frac{2\\,C^{2}T}{N_{0}},\n$$\n从而得到\n$$\n\\frac{SNR_{\\text{degraded}}}{SNR_{\\text{ideal}}}\n=\\frac{1}{1+\\dfrac{2\\,C^{2}T}{N_{0}}}\n=\\frac{N_{0}}{N_{0}+2\\,C^{2}T}.\n$$\n该表达式仅取决于 $C$、$T$ 和 $N_{0}$，符合题目要求。", "answer": "$$\\boxed{\\frac{N_{0}}{N_{0}+2C^{2}T}}$$", "id": "1736640"}, {"introduction": "滤波器的“匹配”特性是针对某一个特定信号而言的。如果我们用它来检测一个不同的信号，会发生什么？本练习将量化这种性能损失：当你使用一个为简单矩形脉冲设计的（次优）滤波器来检测一个三角形脉冲信号时，信噪比会下降多少。这种由于滤波器与信号不完全匹配而导致的 $SNR$ 损失在工程上被称为“失配损失”（mismatch loss），其分析对于系统设计至关重要，因为它帮助工程师在性能和实现复杂性之间做出权衡。[@problem_id:1736687]", "problem": "在一个数字通信系统中，需要在加性高斯白噪声 (AWGN) 中检测一个特定信号 $s(t)$，该噪声的双边功率谱密度为常数 $N_0/2$。信号 $s(t)$ 是一个对称三角脉冲，定义如下：\n$$\ns(t) = \n\\begin{cases} \nA \\left(1 - \\frac{2|t - T/2|}{T}\\right) & \\text{for } 0 \\le t \\le T \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\n其中 $A$ 是峰值幅度，$T$ 是持续时间。\n\n系统没有采用针对 $s(t)$ 的最佳匹配滤波器，而是使用了一个次优滤波器。该滤波器与一个矩形脉冲 $p(t)$ 完美匹配，定义如下：\n$$\np(t) = \n\\begin{cases} \nB & \\text{for } 0 \\le t \\le 2T \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\n其中 $B$ 是一个恒定幅度。\n\n一个关键的设计约束是，三角脉冲 $s(t)$ 的总能量等于矩形脉冲 $p(t)$ 的总能量。\n\n你的任务是计算，由于使用此上次优滤波器替代 $s(t)$ 的真实匹配滤波器，所导致的最大可实现输出信噪比 (SNR) 的分数损失。分数损失定义为 $(\\text{SNR}_{\\text{opt}} - \\text{SNR}_{\\text{sub}}) / \\text{SNR}_{\\text{opt}}$，其中 $\\text{SNR}_{\\text{opt}}$ 是最佳滤波器的最大信噪比，$\\text{SNR}_{\\text{sub}}$ 是次优滤波器的最大信噪比。\n\n将你的最终答案表示为保留三位有效数字的小数。", "solution": "我们用 $E_{x} \\triangleq \\int_{-\\infty}^{\\infty} |x(t)|^{2} \\, dt$ 表示波形 $x(t)$ 的信号能量，用 $\\langle x,y \\rangle \\triangleq \\int_{-\\infty}^{\\infty} x(t) y(t) \\, dt$ 表示实信号的内积。在双边功率谱密度为 $N_0/2$ 的加性高斯白噪声 (AWGN) 中，当实际信号为 $s(t)$ 时，与模板 $w(t)$ 匹配的线性滤波器的输出信噪比为\n$$\n\\text{SNR} = \\frac{|\\langle s,w \\rangle|^{2}}{(N_{0}/2)\\,E_{w}}.\n$$\n最佳信噪比通过选择 $w=s$ 获得，这给出\n$$\n\\text{SNR}_{\\text{opt}} = \\frac{\\left(\\int s^{2}(t)\\,dt\\right)^{2}}{(N_{0}/2)\\int s^{2}(t)\\,dt} = \\frac{2 E_{s}}{N_{0}}.\n$$\n对于与 $p(t)$ 匹配的次优滤波器，我们有\n$$\n\\text{SNR}_{\\text{sub}} = \\frac{|\\langle s,p \\rangle|^{2}}{(N_{0}/2)\\,E_{p}}.\n$$\n因此，\n$$\n\\frac{\\text{SNR}_{\\text{sub}}}{\\text{SNR}_{\\text{opt}}} = \\frac{|\\langle s,p \\rangle|^{2}}{E_{p}\\,E_{s}}.\n$$\n根据设计约束 $E_{p}=E_{s}$，上式简化为\n$$\n\\frac{\\text{SNR}_{\\text{sub}}}{\\text{SNR}_{\\text{opt}}} = \\frac{|\\langle s,p \\rangle|^{2}}{E_{s}^{2}}.\n$$\n\n我们现在计算 $E_{s}$、$E_{p}$ 和 $\\langle s,p \\rangle$。\n\n对于在 $[0,T]$ 上的三角波 $s(t)$，\n$$\ns(t) = A\\left(1 - \\frac{2|t - T/2|}{T}\\right) =\n\\begin{cases}\nA \\cdot \\frac{2t}{T}, & 0 \\le t \\le \\frac{T}{2} \\\\\nA \\cdot \\frac{2(T - t)}{T}, & \\frac{T}{2} \\le t \\le T\n\\end{cases}\n$$\n所以\n$$\nE_{s} = \\int_{0}^{T} s^{2}(t)\\,dt\n= 2 \\int_{0}^{T/2} A^{2} \\left(\\frac{2t}{T}\\right)^{2} dt\n= 2 A^{2} \\frac{4}{T^{2}} \\int_{0}^{T/2} t^{2} dt\n= 2 A^{2} \\frac{4}{T^{2}} \\cdot \\frac{(T/2)^{3}}{3}\n= \\frac{A^{2} T}{3}.\n$$\n\n对于在 $[0,2T]$ 上幅度为 $B$ 的矩形波 $p(t)$，\n$$\nE_{p} = \\int_{0}^{2T} B^{2} \\, dt = 2 T B^{2}.\n$$\n能量相等的约束 $E_{p}=E_{s}$ 给出\n$$\n2 T B^{2} = \\frac{A^{2} T}{3} \\quad \\Rightarrow \\quad B^{2} = \\frac{A^{2}}{6}.\n$$\n\n对于内积，与 $p(t)$ 匹配的滤波器可以进行时移以最大化相关性。因为 $p(t)$ 在其长度为 $2T$ 的支撑域上是恒定的，我们选择时移，使得这个 $2T$ 窗口完全覆盖 $s(t)$ 的支撑域；那么\n$$\n\\langle s,p \\rangle = \\int s(t) p(t)\\, dt = B \\int_{0}^{T} s(t)\\, dt.\n$$\n在 $[0,T]$ 上的单位高度对称三角形状下的面积是 $T/2$，因此\n$$\n\\int_{0}^{T} s(t)\\, dt = A \\cdot \\frac{T}{2},\n$$\n所以\n$$\n\\langle s,p \\rangle = B \\cdot A \\cdot \\frac{T}{2} = \\frac{A B T}{2}.\n$$\n\n因此，\n$$\n\\frac{\\text{SNR}_{\\text{sub}}}{\\text{SNR}_{\\text{opt}}}\n= \\frac{\\left(\\frac{A B T}{2}\\right)^{2}}{\\left(\\frac{A^{2} T}{3}\\right)^{2}}\n= \\frac{A^{2} B^{2} T^{2}/4}{A^{4} T^{2}/9}\n= \\frac{9 B^{2}}{4 A^{2}}\n= \\frac{9}{4} \\cdot \\frac{A^{2}/6}{A^{2}}\n= \\frac{3}{8}.\n$$\n从而，分数损失为\n$$\n\\frac{\\text{SNR}_{\\text{opt}} - \\text{SNR}_{\\text{sub}}}{\\text{SNR}_{\\text{opt}}}\n= 1 - \\frac{3}{8} = \\frac{5}{8} = 0.625.\n$$\n保留三位有效数字，该值仍为 $0.625$。", "answer": "$$\\boxed{0.625}$$", "id": "1736687"}]}