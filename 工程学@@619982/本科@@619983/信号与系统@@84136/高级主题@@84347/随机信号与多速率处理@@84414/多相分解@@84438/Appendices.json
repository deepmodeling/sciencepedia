{"hands_on_practices": [{"introduction": "学习多相分解的最佳起点是处理一个简单而常见的滤波器。这个练习将指导你分解一个基本的双点移动平均滤波器，通过这个过程，你将掌握将滤波器脉冲响应分为偶数和奇数部分的核心机制。这是一个用于构建高效多速率系统的基础技能 [@problem_id:1737208]。", "problem": "在多速率数字信号处理中，一个滤波器的传递函数 $H(z)$ 可以被分解为一组“多相分量”。这种分解对于设计高效的滤波器组至关重要，而滤波器组广泛应用于音频压缩和通信等领域。对于一个抽取/插值因子为 $M=2$ 的系统，其传递函数 $H(z)$ 可以通过其两个多相分量 $E_0(z)$ 和 $E_1(z)$ 唯一地表示为以下关系式：\n\n$$H(z) = E_0(z^{2}) + z^{-1}E_1(z^{2})$$\n\n考虑一个简单的两点移动平均滤波器，这是一种常用于实时数据流基本降噪的有限冲激响应（FIR）滤波器。该滤波器的传递函数由下式给出：\n\n$$H(z) = 0.5(1 + z^{-1})$$\n\n确定此特定移动平均滤波器的两个多相分量滤波器 $E_0(z)$ 和 $E_1(z)$。你的最终答案应该是 $E_0(z)$ 和 $E_1(z)$ 的表达式对。", "solution": "我们从给定的传递函数为\n$$H(z) = \\frac{1}{2}\\left(1 + z^{-1}\\right)$$\n的两点移动平均FIR滤波器开始。\n根据定义，一个FIR传递函数可以写作\n$$H(z) = \\sum_{n=0}^{\\infty} h[n] z^{-n},$$\n由此我们可以确定其冲激响应系数为 $h[0] = \\frac{1}{2}$，$h[1] = \\frac{1}{2}$，且对于所有其他 $n$，$h[n] = 0$。\n\n对于 $M=2$ 的多相分解，1型多相分量 $E_{0}(z)$ 和 $E_{1}(z)$ 是通过将 $h[n]$ 分解为其偶数索引和奇数索引部分来定义的：\n$$E_{0}(z) = \\sum_{k=0}^{\\infty} h[2k] z^{-k}, \\qquad E_{1}(z) = \\sum_{k=0}^{\\infty} h[2k+1] z^{-k},$$\n并且它们满足\n$$H(z) = E_{0}\\left(z^{2}\\right) + z^{-1} E_{1}\\left(z^{2}\\right)。$$\n\n计算 $E_{0}(z)$：\n- 唯一的非零偶数索引系数是 $h[0] = \\frac{1}{2}$，对应于 $k=0$。因此，\n$$E_{0}(z) = \\frac{1}{2}。$$\n\n计算 $E_{1}(z)$：\n- 唯一的非零奇数索引系数是 $h[1] = \\frac{1}{2}$，对应于 $k=0$。因此，\n$$E_{1}(z) = \\frac{1}{2}。$$\n\n验证：\n$$E_{0}\\left(z^{2}\\right) + z^{-1} E_{1}\\left(z^{2}\\right) = \\frac{1}{2} + z^{-1}\\left(\\frac{1}{2}\\right) = \\frac{1}{2}\\left(1 + z^{-1}\\right) = H(z),$$\n这与给定的传递函数相匹配。\n\n因此，多相分量为 $E_{0}(z) = \\frac{1}{2}$ 和 $E_{1}(z) = \\frac{1}{2}$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{2} & \\frac{1}{2}\\end{pmatrix}}$$", "id": "1737208"}, {"introduction": "多相分解的美妙之处在于其通用性，它不仅限于两个通道。这个练习将挑战你把一个更复杂的有限脉冲响应（FIR）滤波器分解为三个多相分量，让你将基本概念推广到任意数量的相位 $M$。通过处理这个 $M=3$ 的例子，你将更深入地理解该技术如何适用于更高级的多速率系统设计 [@problem_id:1742747]。", "problem": "一个因果离散时间有限冲激响应 (FIR) 滤波器的冲激响应为 $h[n] = 2\\delta[n] - \\delta[n-1] + 3\\delta[n-3] - 4\\delta[n-5]$。为了进行高效的硬件实现，该滤波器将使用一个3相多相分解来实现。多相分量序列记为 $e_0[n]$、$e_1[n]$ 和 $e_2[n]$，由原始冲激响应 $h[n]$ 通过关系式 $e_k[n] = h[3n+k]$ 定义，其中 $k \\in \\{0, 1, 2\\}$。\n\n求这三个多相分量序列的Z变换，分别记为 $E_0(z)$、$E_1(z)$ 和 $E_2(z)$。", "solution": "该问题要求解冲激响应为 $h[n] = 2\\delta[n] - \\delta[n-1] + 3\\delta[n-3] - 4\\delta[n-5]$ 的FIR滤波器的3相多相分量。\n冲激响应的非零值如下：\n$h[0] = 2$\n$h[1] = -1$\n$h[2] = 0$\n$h[3] = 3$\n$h[4] = 0$\n$h[5] = -4$\n对于所有其他非负整数 $n$，$h[n]=0$。\n\n多相分量 $e_k[n]$ 由关系式 $e_k[n] = h[Mn+k]$ 定义，其中相数 $M=3$。我们将通过对原始序列进行降采样来确定每个分量序列 $e_k[n]$（对于 $k=0, 1, 2$），然后求出它们各自的Z变换 $E_k(z)$。\n\n首先，我们确定分量序列 $e_0[n]$。该分量由 $h[n]$ 从第一个采样点（$n=0$）开始，每三个采样点取一个而构成。其定义为 $e_0[n] = h[3n]$。\n当 $n=0$ 时：$e_0[0] = h[3 \\cdot 0] = h[0] = 2$。\n当 $n=1$ 时：$e_0[1] = h[3 \\cdot 1] = h[3] = 3$。\n对于 $n \\geq 2$，索引 $3n$ 将为 $6, 9, 12, \\dots$。由于当 $m > 5$ 时 $h[m]=0$，因此对于 $n \\geq 2$ 的所有后续 $e_0[n]$ 值均为零。\n所以，序列 $e_0[n]$ 为 $e_0[n] = 2\\delta[n] + 3\\delta[n-1]$。\n$e_0[n]$ 的Z变换为 $E_0(z) = \\mathcal{Z}\\{e_0[n]\\}$，即：\n$E_0(z) = \\mathcal{Z}\\{2\\delta[n] + 3\\delta[n-1]\\} = 2 + 3z^{-1}$。\n\n接下来，我们确定分量序列 $e_1[n]$。该分量由 $h[n]$ 从第二个采样点（$n=1$）开始，每三个采样点取一个而构成。其定义为 $e_1[n] = h[3n+1]$。\n当 $n=0$ 时：$e_1[0] = h[3 \\cdot 0 + 1] = h[1] = -1$。\n当 $n=1$ 时：$e_1[1] = h[3 \\cdot 1 + 1] = h[4] = 0$。\n对于 $n \\geq 1$，索引 $3n+1$ 将为 $4, 7, 10, \\dots$。由于对于这些索引（除了我们已经处理过的 $h[1]$），$h[m]=0$，因此对于 $n \\geq 1$ 的所有后续 $e_1[n]$ 值均为零。\n所以，序列 $e_1[n]$ 为 $e_1[n] = -1 \\cdot \\delta[n]$。\n$e_1[n]$ 的Z变换为 $E_1(z) = \\mathcal{Z}\\{e_1[n]\\}$：\n$E_1(z) = \\mathcal{Z}\\{-\\delta[n]\\} = -1$。\n\n最后，我们确定分量序列 $e_2[n]$。该分量由 $h[n]$ 从第三个采样点（$n=2$）开始，每三个采样点取一个而构成。其定义为 $e_2[n] = h[3n+2]$。\n当 $n=0$ 时：$e_2[0] = h[3 \\cdot 0 + 2] = h[2] = 0$。\n当 $n=1$ 时：$e_2[1] = h[3 \\cdot 1 + 2] = h[5] = -4$。\n对于 $n \\geq 2$，索引 $3n+2$ 将为 $8, 11, \\dots$。由于对于这些索引 $h[m]=0$，因此对于 $n \\geq 2$ 的所有后续 $e_2[n]$ 值均为零。\n所以，序列 $e_2[n]$ 为 $e_2[n] = -4\\delta[n-1]$。\n$e_2[n]$ 的Z变换为 $E_2(z) = \\mathcal{Z}\\{e_2[n]\\}$：\n$E_2(z) = \\mathcal{Z}\\{-4\\delta[n-1]\\} = -4z^{-1}$。\n\n综上所述，三个多相分量的Z变换为：\n$E_0(z) = 2 + 3z^{-1}$\n$E_1(z) = -1$\n$E_2(z) = -4z^{-1}$", "answer": "$$\\boxed{\\begin{pmatrix} 2 + 3z^{-1} & -1 & -4z^{-1} \\end{pmatrix}}$$", "id": "1742747"}, {"introduction": "在实际的信号处理系统中，滤波器通常是级联的。这个练习探讨了一个更深层次的问题：一个由两个滤波器级联而成的系统的多相分量是怎样的？通过推导级联系统的多相分量，你将洞察到这些分量如何相互作用，这对于设计和优化复杂的滤波器组至关重要 [@problem_id:1742749]。", "problem": "在设计高效的多速率数字信号处理系统时，通常会使用其多相分量来实现滤波器。考虑一个滤波系统 $H(z)$，该系统通过级联两个有限冲激响应 (FIR) 滤波器 $H_1(z)$ 和 $H_2(z)$ 实现，使得总传递函数为 $H(z) = H_1(z)H_2(z)$。\n\n各个滤波器的传递函数由下式给出：\n$H_1(z) = a_0 + a_1 z^{-1} + a_2 z^{-2}$\n$H_2(z) = b_0 + b_1 z^{-1}$\n其中 $a_0, a_1, a_2, b_0,$ 和 $b_1$ 是实常数系数。\n\n为进行高效实现，总滤波器 $H(z)$ 需用其2相（类型1）多相分解来表示，其定义如下：\n$H(z) = E_0(z^2) + z^{-1}E_1(z^2)$\n此处，$E_0(z)$ 和 $E_1(z)$ 是 $H(z)$ 的两个多相分量。\n\n确定级联系统 $H(z)$ 的多相分量 $E_0(z)$ 和 $E_1(z)$ 的传递函数。用系数 $a_0, a_1, a_2, b_0, b_1$ 来表示结果。将最终答案以 $1 \\times 2$ 行矩阵 $\\begin{pmatrix} E_0(z) & E_1(z) \\end{pmatrix}$ 的形式给出。", "solution": "我们从具有以下传递函数的级联FIR滤波器开始：\n$$H_{1}(z)=a_{0}+a_{1}z^{-1}+a_{2}z^{-2}, \\quad H_{2}(z)=b_{0}+b_{1}z^{-1}.$$\n总传递函数是二者的乘积\n$$H(z)=H_{1}(z)H_{2}(z).$$\n通过多项式乘法，\n$$\n\\begin{aligned}\nH(z)&=(a_{0}+a_{1}z^{-1}+a_{2}z^{-2})(b_{0}+b_{1}z^{-1})\\\\\n&=a_{0}b_{0}+(a_{0}b_{1}+a_{1}b_{0})z^{-1}+(a_{1}b_{1}+a_{2}b_{0})z^{-2}+a_{2}b_{1}z^{-3}.\n\\end{aligned}\n$$\n因此，若我们将冲激响应系数记为 $h[n]$，则有\n$$h[0]=a_{0}b_{0},\\quad h[1]=a_{0}b_{1}+a_{1}b_{0},\\quad h[2]=a_{1}b_{1}+a_{2}b_{0},\\quad h[3]=a_{2}b_{1}.$$\n对于2相（类型1）多相分解，其定义为\n$$H(z)=E_{0}(z^{2})+z^{-1}E_{1}(z^{2}),$$\n其中多相分量分别由偶数和奇数索引的采样构成：\n$$E_{0}(z)=\\sum_{k}h[2k]z^{-k},\\qquad E_{1}(z)=\\sum_{k}h[2k+1]z^{-k}.$$\n使用计算出的 $h[n]$，我们得到\n$$E_{0}(z)=h[0]+h[2]z^{-1}=a_{0}b_{0}+\\left(a_{1}b_{1}+a_{2}b_{0}\\right)z^{-1},$$\n$$E_{1}(z)=h[1]+h[3]z^{-1}=\\left(a_{0}b_{1}+a_{1}b_{0}\\right)+a_{2}b_{1}z^{-1}.$$\n因此，所求的 $1\\times 2$ 行矩阵为\n$$\\begin{pmatrix}E_{0}(z) & E_{1}(z)\\end{pmatrix}=\\begin{pmatrix}a_{0}b_{0}+\\left(a_{1}b_{1}+a_{2}b_{0}\\right)z^{-1} & \\left(a_{0}b_{1}+a_{1}b_{0}\\right)+a_{2}b_{1}z^{-1}\\end{pmatrix}.$$", "answer": "$$\\boxed{\\begin{pmatrix}a_{0}b_{0}+\\left(a_{1}b_{1}+a_{2}b_{0}\\right)z^{-1} & \\left(a_{0}b_{1}+a_{1}b_{0}\\right)+a_{2}b_{1}z^{-1}\\end{pmatrix}}$$", "id": "1742749"}]}