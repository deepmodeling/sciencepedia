{"hands_on_practices": [{"introduction": "在开始进行谱估计之前，我们首先需要掌握一个基本原则：帕塞瓦尔定理（Parseval's theorem）。该定理在信号的时域和频域之间建立了一座至关重要的桥梁，它揭示了信号的总能量在时域中的计算结果与其在频域中的能量分布之间存在着精确的守恒关系。通过这个练习，你将为一个具体的信号验证这一定理，从而直观地理解信号能量是如何在其频谱上分布的 [@problem_id:1730334]。", "problem": "一个离散时间信号 $x[n]$ 定义为一个因果的、有限长度的几何序列，由下式给出\n$$\nx[n] = \\alpha^n, \\quad \\text{for } n = 0, 1, 2, ..., N-1\n$$\n在其他情况下 $x[n]=0$。对于本题，设其公比为 $\\alpha = \\frac{1}{2}$，信号长度为 $N=4$。\n\n该信号的 $N$ 点离散傅里叶变换 (DFT) 定义为\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] \\exp\\left(-j \\frac{2\\pi kn}{N}\\right), \\quad \\text{for } k = 0, 1, 2, ..., N-1\n$$\n其中 $j$ 是虚数单位。\n\n我们关心与此信号相关的两个量：\n1.  信号在时域中的总能量，由其采样点幅度的平方和给出：$E = \\sum_{n=0}^{N-1} |x[n]|^{2}$。\n2.  其DFT系数的幅度平方和：$S = \\sum_{k=0}^{N-1} |X[k]|^{2}$。\n\n计算比值 $\\frac{S}{E}$ 的精确值。", "solution": "我们已知对于 $n=0,1,2,3$，$x[n]=\\alpha^{n}$，其中 $\\alpha=\\frac{1}{2}$，及其 $N$ 点DFT为\n$$\nX[k]=\\sum_{n=0}^{N-1}x[n]\\exp\\left(-j\\frac{2\\pi kn}{N}\\right),\\quad k=0,1,2,3,\n$$\n其中 $N=4$。与此定义相符的逆DFT为\n$$\nx[n]=\\frac{1}{N}\\sum_{k=0}^{N-1}X[k]\\exp\\left(j\\frac{2\\pi kn}{N}\\right).\n$$\n对于此DFT约定，Parseval定理表明\n$$\n\\sum_{n=0}^{N-1}|x[n]|^{2}=\\frac{1}{N}\\sum_{k=0}^{N-1}|X[k]|^{2}.\n$$\n根据定义，时域能量为\n$$\nE=\\sum_{n=0}^{N-1}|x[n]|^{2}=\\sum_{n=0}^{3}\\left(\\frac{1}{2}\\right)^{2n}=\\sum_{n=0}^{3}\\left(\\frac{1}{4}\\right)^{n}.\n$$\n使用有限几何级数求和公式，\n$$\nE=\\frac{1-\\left(\\frac{1}{4}\\right)^{4}}{1-\\frac{1}{4}}=\\frac{1-\\frac{1}{256}}{\\frac{3}{4}}=\\frac{\\frac{255}{256}}{\\frac{3}{4}}=\\frac{255}{256}\\cdot\\frac{4}{3}=\\frac{85}{64}.\n$$\nDFT系数的幅度平方和为\n$$\nS=\\sum_{k=0}^{N-1}|X[k]|^{2}.\n$$\n应用Parseval定理可得\n$$\nE=\\frac{1}{N}S\\quad\\Longrightarrow\\quad S=NE.\n$$\n因此，所求的比值为\n$$\n\\frac{S}{E}=N=4.\n$$", "answer": "$$\\boxed{4}$$", "id": "1730334"}, {"introduction": "谱估计的核心工具之一是周期图法。然而，周期图法并非孤立的概念，它与信号的自相关函数有着深刻的联系，这一关系由维纳-辛钦定理（Wiener-Khinchin theorem）所描述。这个练习将引导你通过两种不同的方法计算同一个信号的功率谱：一种是直接计算周期图，另一种是先计算信号的自相关函数再对其进行傅里叶变换。通过数值验证这两种方法得到相同的结果，你将能更深刻地理解周期图的物理意义以及它作为功率谱密度估计的理论基础 [@problem_id:1730338]。", "problem": "一个有限离散时间信号由序列 $x[n] = \\{2, 0, -1, 3\\}$ 给出，其中 $n = 0, 1, 2, 3$，而在其他情况下为零。该信号的长度为 $N=4$。\n\n提出了两种不同的方法来分析该信号的频率内容。\n\n方法1涉及计算信号的周期图。序列 $y[n]$ 的 $N$ 点离散傅里叶变换 (DFT) 定义为 $Y[k] = \\sum_{n=0}^{N-1} y[n] \\exp(-j\\frac{2\\pi kn}{N})$。周期图功率谱密度估计 $P[k]$ 定义为 $P[k] = \\frac{1}{N} |X[k]|^2$，其中 $X[k]$ 是信号 $x[n]$ 的 $N$ 点 DFT。计算频率指数 $k=1$ 处的周期图值，并将此值记为 $V_1$。\n\n方法2首先涉及计算信号自相关的一个估计。对于 $m=0, 1, \\dots, N-1$，有偏循环自相关估计 $\\hat{R}_{xx}[m]$ 定义为 $\\hat{R}_{xx}[m] = \\frac{1}{N} \\sum_{n=0}^{N-1} x[n] x[(n-m) \\pmod N]$。然后通过对该自相关序列 $\\hat{R}_{xx}[m]$ 进行 $N$ 点 DFT 来获得谱估计 $S[k]$。计算频率指数 $k=1$ 处的该谱估计值，并将此值记为 $V_2$。\n\n按顺序报告 $V_1$ 和 $V_2$ 的数值。以小数形式表示你的答案。由于答案是精确值，你不需要进行四舍五入。", "solution": "给定一个长度为 $N=4$ 的有限序列 $x[n]$，其中 $x[0]=2$，$x[1]=0$，$x[2]=-1$，$x[3]=3$，在其他情况下 $x[n]=0$。$N$ 点 DFT 定义为 $X[k]=\\sum_{n=0}^{N-1} x[n]\\exp\\!\\left(-j\\frac{2\\pi kn}{N}\\right)$。\n\n方法1 (周期图)：周期图定义为 $P[k]=\\frac{1}{N}|X[k]|^{2}$。对于 $k=1$ 和 $N=4$，令 $W=\\exp\\!\\left(-j\\frac{2\\pi}{4}\\right)=\\exp(-j\\frac{\\pi}{2})=-j$。那么\n$$\nX[1]=x[0]W^{0}+x[1]W^{1}+x[2]W^{2}+x[3]W^{3}\n=2\\cdot 1+0\\cdot(-j)+(-1)\\cdot(-1)+3\\cdot j\n=3+3j.\n$$\n因此\n$$\n|X[1]|^{2}=3^{2}+(3)^{2}=18,\\quad\nP[1]=\\frac{1}{N}|X[1]|^{2}=\\frac{1}{4}\\cdot 18=\\frac{9}{2}=4.5.\n$$\n所以 $V_{1}=4.5$。\n\n方法2 (有偏循环自相关的DFT)：有偏循环自相关为\n$$\n\\hat{R}_{xx}[m]=\\frac{1}{N}\\sum_{n=0}^{N-1}x[n]\\,x[(n-m)\\bmod N],\\quad m=0,1,2,3.\n$$\n计算每一项：\n$$\n\\hat{R}_{xx}[0]=\\frac{1}{4}\\big(2^{2}+0^{2}+(-1)^{2}+3^{2}\\big)=\\frac{14}{4},\n$$\n$$\n\\hat{R}_{xx}[1]=\\frac{1}{4}\\big(x[0]x[3]+x[1]x[0]+x[2]x[1]+x[3]x[2]\\big)=\\frac{1}{4}(6+0+0-3)=\\frac{3}{4},\n$$\n$$\n\\hat{R}_{xx}[2]=\\frac{1}{4}\\big(x[0]x[2]+x[1]x[3]+x[2]x[0]+x[3]x[1]\\big)=\\frac{1}{4}(-2+0-2+0)=-1,\n$$\n$$\n\\hat{R}_{xx}[3]=\\frac{1}{4}\\big(x[0]x[1]+x[1]x[2]+x[2]x[3]+x[3]x[0]\\big)=\\frac{1}{4}(0+0-3+6)=\\frac{3}{4}.\n$$\n因此，对于 $m=0,1,2,3$，$\\hat{R}_{xx}[m]=\\left\\{\\frac{14}{4},\\frac{3}{4},-1,\\frac{3}{4}\\right\\}$。谱估计是 $\\hat{R}_{xx}[m]$ 的 $N$ 点 DFT：\n$$\nS[k]=\\sum_{m=0}^{N-1}\\hat{R}_{xx}[m]\\exp\\!\\left(-j\\frac{2\\pi km}{N}\\right).\n$$\n对于 $k=1$，且 $W=\\exp\\!\\left(-j\\frac{2\\pi}{4}\\right)=-j$，\n$$\nS[1]=\\hat{R}_{xx}[0]W^{0}+\\hat{R}_{xx}[1]W^{1}+\\hat{R}_{xx}[2]W^{2}+\\hat{R}_{xx}[3]W^{3}\n=\\frac{14}{4}+ \\frac{3}{4}(-j)+(-1)(-1)+\\frac{3}{4}j\n=\\frac{14}{4}+1=\\frac{18}{4}=\\frac{9}{2}=4.5.\n$$\n所以 $V_{2}=4.5$。\n\n两种方法的结果一致，这与此处使用的循环(有偏)自相关和DFT归一化的 Wiener–Khinchin 关系 $S[k]=\\frac{1}{N}|X[k]|^{2}$ 相符。", "answer": "$$\\boxed{\\begin{pmatrix} 4.5 & 4.5 \\end{pmatrix}}$$", "id": "1730338"}, {"introduction": "将理论付诸实践时，我们常常会遇到由离散傅里叶变换（DFT）的性质所带来的挑战，其中最典型的问题就是频谱泄漏。然而，通过巧妙地设计我们的测量过程，我们可以显著改善分析结果。这个练习模拟了一个工程设计场景，要求你确定一个最短的信号长度以实现“相干采样”，即让目标频率精确地落在DFT的一个频率“箱”中，从而完全消除该频率分量的频谱泄漏 [@problem_id:1730337]。这个实践将展示如何运用DFT的理论知识来解决实际测量中的精度问题。", "problem": "一位电气工程师正在为本地电网设计一个数字监控系统。该系统以 $f_s = 8000$ Hz 的速率对电压波形进行采样，并使用离散傅里叶变换 (DFT) 进行频率分析。该工程师希望针对一个特定的、已知的非标称频率 $f_0 = 60.125$ Hz 实现完美的频率分辨率，该频率在电网稳定性测试中已被观察到。为此，必须选择合适的信号采集时间，使得频率 $f_0$ 能够精确地落入 DFT 的某个频率仓中。这种被称为相干采样的技术，可以消除频率为 $f_0$ 的分量的一种称为频谱泄漏的频谱分析误差。\n\n系统需要采集的最小正采样点数 $N$ 是多少，才能满足这一条件？", "solution": "对于以采样率 $f_{s}$ 采样的序列进行 $N$ 点 DFT，第 $k$ 个 DFT 频率仓的频率由下式给出\n$$\nf_{k}=\\frac{k f_{s}}{N}, \\quad k \\in \\{0,1,\\ldots,N-1\\}.\n$$\n对频率为 $f_{0}$ 的分量进行相干采样，要求 $f_{0}$ 与某个频率仓 $f_{k}$ 重合，即\n$$\nf_{0}=\\frac{k f_{s}}{N} \\quad \\Longleftrightarrow \\quad \\frac{f_{0}}{f_{s}}=\\frac{k}{N},\n$$\n其中 $k$ 和 $N$ 为某些整数。将比值 $\\frac{f_{0}}{f_{s}}$ 写成最简分数形式，最小正整数解的 $k$ 等于分子， $N$ 等于分母。\n\n当 $f_{s}=8000$ 且 $f_{0}=60.125$ 时，将 $f_{0}$ 表示为有理数：\n$$\n60.125=60+\\frac{1}{8}=\\frac{480}{8}+\\frac{1}{8}=\\frac{481}{8}.\n$$\n因此，\n$$\n\\frac{f_{0}}{f_{s}}=\\frac{\\frac{481}{8}}{8000}=\\frac{481}{64000}.\n$$\n由于 $64000=2^{9}\\cdot 5^{3}$ 且 $481=13\\cdot 37$，分数 $\\frac{481}{64000}$ 已经是最简分数。因此，满足 $\\frac{f_{0}}{f_{s}}=\\frac{k}{N}$ 的最小整数是 $k=481$ 和 $N=64000$。因此，所需的最小正采样点数是\n$$\nN=64000.\n$$\n等效地，这确保了在采集窗口内有整数个周期，因为\n$$\nf_{0}\\frac{N}{f_{s}}=\\frac{f_{0}}{f_{s}}N=\\frac{481}{64000}N=481\n$$\n当 $N=64000$ 时，其结果为 481，这是一个整数，从而消除了频率为 $f_{0}$ 的分量的频谱泄漏。", "answer": "$$\\boxed{64000}$$", "id": "1730337"}]}