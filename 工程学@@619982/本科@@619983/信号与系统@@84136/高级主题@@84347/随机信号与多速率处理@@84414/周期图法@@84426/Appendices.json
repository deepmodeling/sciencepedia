{"hands_on_practices": [{"introduction": "我们从一个基础练习开始。通过计算一个简单的常数信号（即有限长度的直流信号）的周期图，我们实际上是在探究矩形窗本身的傅里叶变换。这个练习将揭示周期图的一个核心特征——频谱泄漏，即单个频率的能量会“泄漏”到相邻的频率上，其形状由窗口函数的频谱决定。理解这一效应是所有实际频谱分析的基础 [@problem_id:1764335]。", "problem": "考虑一个离散时间信号处理场景，其中有限长度序列 $y[n]$ 是通过对一个恒定直流信号进行 $N$ 次采样得到的。该序列定义为，当 $n = 0, 1, \\dots, N-1$ 时，$y[n] = 1$，否则 $y[n] = 0$。整数 $N$ 大于1。\n\n该序列的周期图用于估计其功率谱密度，其定义公式为：\n$$P_{yy}(\\omega) = \\frac{1}{N} \\left| \\sum_{n=0}^{N-1} y[n] \\exp(-j\\omega n) \\right|^2$$\n其中 $\\omega$ 是归一化角频率，单位为弧度/样本，而 $j$ 是虚数单位，满足 $j^2 = -1$。\n\n求周期图 $P_{yy}(\\omega)$ 的解析表达式。你的答案应该是一个关于 $N$ 和 $\\omega$ 的单一闭式表达式。", "solution": "给定一个有限长度序列 $y[n]$，其定义为：当 $n=0,1,\\dots,N-1$ 时，$y[n]=1$，否则 $y[n]=0$，其中 $N>1$。周期图的定义为\n$$\nP_{yy}(\\omega)=\\frac{1}{N}\\left|\\sum_{n=0}^{N-1}y[n]\\exp(-j\\omega n)\\right|^{2}.\n$$\n由于当 $n=0,\\dots,N-1$ 时，$y[n]=1$，所以该求和是一个公比为 $r=\\exp(-j\\omega)$ 的有限几何级数：\n$$\nS(\\omega)=\\sum_{n=0}^{N-1}\\exp(-j\\omega n)=\\frac{1-\\exp(-j\\omega N)}{1-\\exp(-j\\omega)}.\n$$\n因此，\n$$\nP_{yy}(\\omega)=\\frac{1}{N}\\left|\\frac{1-\\exp(-j\\omega N)}{1-\\exp(-j\\omega)}\\right|^{2}.\n$$\n为了简化模的计算，使用对任意实数 $x$ 均成立的恒等式：\n$$\n|1-\\exp(-jx)|^{2}=(1-\\exp(-jx))(1-\\exp(jx))=2-2\\cos(x)=4\\sin^{2}\\left(\\frac{x}{2}\\right).\n$$\n将此恒等式应用于分子（令 $x=N\\omega$）和分母（令 $x=\\omega$），可得\n$$\n\\left|1-\\exp(-j\\omega N)\\right|^{2}=4\\sin^{2}\\left(\\frac{N\\omega}{2}\\right),\\quad \\left|1-\\exp(-j\\omega)\\right|^{2}=4\\sin^{2}\\left(\\frac{\\omega}{2}\\right).\n$$\n因此，\n$$\n\\left|S(\\omega)\\right|^{2}=\\frac{\\sin^{2}\\left(\\frac{N\\omega}{2}\\right)}{\\sin^{2}\\left(\\frac{\\omega}{2}\\right)},\n$$\n并且周期图为\n$$\nP_{yy}(\\omega)=\\frac{1}{N}\\left(\\frac{\\sin\\left(\\frac{N\\omega}{2}\\right)}{\\sin\\left(\\frac{\\omega}{2}\\right)}\\right)^{2}.\n$$\n此表达式对所有 $\\omega$ 均有效，在 $\\sin\\left(\\frac{\\omega}{2}\\right)=0$ 的点处采用通常的极限解释。", "answer": "$$\\boxed{\\frac{1}{N}\\left(\\frac{\\sin\\left(\\frac{N\\omega}{2}\\right)}{\\sin\\left(\\frac{\\omega}{2}\\right)}\\right)^{2}}$$", "id": "1764335"}, {"introduction": "了解了单个信号的周期图后，我们来探讨一个更深入的问题：当我们将两个信号相加时，它们的频谱会发生什么？这个练习通过计算两个脉冲信号之和的周期图，直接揭示了周期图的非线性特性。你会发现，合成信号的周期图并不等于各自周期图的简单相加，其中出现的“交叉项”是理解复杂信号频谱干扰的关键 [@problem_id:1764307]。", "problem": "在数字信号处理中，周期图是信号功率谱密度（PSD）的一种常用估计方法。考虑两个实值离散时间信号 $x_1[n]$ 和 $x_2[n]$，它们都在时间索引 $n$ 从 $0$ 到 $N-1$ 的范围内有定义。第一个信号 $x_1[n]$ 表示在时间 $n_1$ 处一个幅度为 $A$ 的单脉冲，在其他位置为零。第二个信号 $x_2[n]$ 是在时间 $n_2$ 处一个幅度为 $B$ 的单脉冲，在其他位置为零。我们可以将它们写为 $x_1[n] = A \\delta[n-n_1]$ 和 $x_2[n] = B \\delta[n-n_2]$，其中 $\\delta[k]$ 是克罗内克δ函数。假设 $n_1 \\neq n_2$ 并且 $n_1$ 和 $n_2$ 都是范围 $[0, N-1]$ 内的整数。\n\n长度为 $N$ 的信号 $y[n]$ 的周期图定义为：\n$$P_y(\\omega) = \\frac{1}{N} \\left| \\sum_{n=0}^{N-1} y[n] \\exp(-j\\omega n) \\right|^2$$\n其中 $j$ 是虚数单位，$\\omega$ 是角频率。\n\n一个常见的困惑点是周期图是否为线性运算。如果是线性运算，那么信号之和的周期图将等于它们各自周期图的和。为了研究这一点，我们来分析复合信号 $x[n] = x_1[n] + x_2[n]$。求出“交叉项”表达式 $\\Delta(\\omega)$，它被定义为和的周期图与周期图之和的差：\n$$\\Delta(\\omega) = P_{x_1+x_2}(\\omega) - \\left( P_{x_1}(\\omega) + P_{x_2}(\\omega) \\right)$$\n请给出 $\\Delta(\\omega)$ 的一个闭式解析表达式，用 $A$、$B$、$N$、$n_1$、$n_2$ 和 $\\omega$ 来表示。", "solution": "我们从长度为 $N$ 的信号 $y[n]$ 的周期图定义开始：\n$$\nP_{y}(\\omega)=\\frac{1}{N}\\left|\\sum_{n=0}^{N-1}y[n]\\exp(-j\\omega n)\\right|^{2}.\n$$\n对于 $x_{1}[n]=A\\delta[n-n_{1}]$，其傅里叶求和为\n$$\nX_{1}(\\omega)=\\sum_{n=0}^{N-1}A\\delta[n-n_{1}]\\exp(-j\\omega n)=A\\exp(-j\\omega n_{1}),\n$$\n对于 $x_{2}[n]=B\\delta[n-n_{2}]$，\n$$\nX_{2}(\\omega)=\\sum_{n=0}^{N-1}B\\delta[n-n_{2}]\\exp(-j\\omega n)=B\\exp(-j\\omega n_{2}).\n$$\n因此，各自的周期图为\n$$\nP_{x_{1}}(\\omega)=\\frac{1}{N}\\left|A\\exp(-j\\omega n_{1})\\right|^{2}=\\frac{A^{2}}{N},\\qquad\nP_{x_{2}}(\\omega)=\\frac{1}{N}\\left|B\\exp(-j\\omega n_{2})\\right|^{2}=\\frac{B^{2}}{N},\n$$\n其中我们用到了 $A$ 和 $B$ 是实数。\n\n对于和信号 $x[n]=x_{1}[n]+x_{2}[n]$，我们有\n$$\nX(\\omega)=X_{1}(\\omega)+X_{2}(\\omega)=A\\exp(-j\\omega n_{1})+B\\exp(-j\\omega n_{2}).\n$$\n于是\n$$\nP_{x_{1}+x_{2}}(\\omega)=\\frac{1}{N}\\left|X_{1}(\\omega)+X_{2}(\\omega)\\right|^{2}\n=\\frac{1}{N}\\left(\\left|X_{1}(\\omega)\\right|^{2}+\\left|X_{2}(\\omega)\\right|^{2}+X_{1}(\\omega)X_{2}^{\\ast}(\\omega)+X_{2}(\\omega)X_{1}^{\\ast}(\\omega)\\right),\n$$\n使用 $\\left|u+v\\right|^{2}=\\left|u\\right|^{2}+\\left|v\\right|^{2}+u v^{\\ast}+v u^{\\ast}$ 以及 $\\left|z\\right|^{2}=z z^{\\ast}$。减去各自周期图的和，得到交叉项\n$$\n\\Delta(\\omega)=P_{x_{1}+x_{2}}(\\omega)-\\left(P_{x_{1}}(\\omega)+P_{x_{2}}(\\omega)\\right)\n=\\frac{1}{N}\\left(X_{1}(\\omega)X_{2}^{\\ast}(\\omega)+X_{2}(\\omega)X_{1}^{\\ast}(\\omega)\\right)\n=\\frac{2}{N}\\Re\\left\\{X_{1}(\\omega)X_{2}^{\\ast}(\\omega)\\right\\}.\n$$\n现在代入 $X_{1}(\\omega)=A\\exp(-j\\omega n_{1})$ 和 $X_{2}^{\\ast}(\\omega)=B\\exp(j\\omega n_{2})$（因为 $B$ 是实数）：\n$$\nX_{1}(\\omega)X_{2}^{\\ast}(\\omega)=A B \\exp(-j\\omega n_{1})\\exp(j\\omega n_{2})\n= A B \\exp\\!\\left(j\\omega (n_{2}-n_{1})\\right).\n$$\n取实部可得\n$$\n\\Re\\left\\{A B \\exp\\!\\left(j\\omega (n_{2}-n_{1})\\right)\\right\\}=A B \\cos\\!\\left(\\omega (n_{2}-n_{1})\\right).\n$$\n因此，闭式交叉项为\n$$\n\\Delta(\\omega)=\\frac{2 A B}{N}\\cos\\!\\left(\\omega (n_{2}-n_{1})\\right).\n$$\n这明确地表明周期图不是线性的，因为存在一个取决于相对时移 $n_{2}-n_{1}$ 的非零交叉项。", "answer": "$$\\boxed{\\frac{2 A B}{N}\\cos\\!\\left(\\omega\\left(n_{2}-n_{1}\\right)\\right)}$$", "id": "1764307"}, {"introduction": "最后，让我们从理论计算转向实际应用中的一个关键概念。这个练习旨在澄清数字信号处理中一个关于“零填充”（zero-padding）的常见误解。通过分析零填充对周期图的影响，我们将明确区分两个重要概念：*频率分辨率*（区分相近频率的能力）和频谱的*采样密度*。掌握这一区别对于任何在实践中使用快速傅里叶变换（FFT）和周期图进行频谱分析的人来说都至关重要 [@problem_id:1764290]。", "problem": "一位工程师的任务是分析一个记录了有限时长的离散时间信号 $x[n]$。该信号仅在 $n = 0, 1, \\dots, L-1$ 时非零，采样频率为 $f_s$。为了估计该信号的功率谱密度，该工程师使用了周期图法。\n\n该工程师考虑了两种方法：\n1.  对原始信号 $x[n]$ 计算 $L$ 点离散傅里叶变换 (DFT)，记为 $X_L[k]$。然后计算其周期图。\n2.  通过在 $x[n]$ 后附加 $Z$ 个零来创建一个新信号 $x_p[n]$，得到一个总长度为 $N = L+Z$（其中 $N > L$）的信号。然后，对这个补零信号 $x_p[n]$ 计算 $N$ 点 DFT，记为 $X_N[k]$。根据此结果计算周期图。\n\n谱估计的基本频率分辨率指的是其区分原始连续时间信号中两个不同的、频率相近的频率分量的能力。\n\n下列哪个陈述最准确地描述了补零过程（即使用方法2而非方法1）对周期图基本频率分辨率的影响？\n\nA. 补零提高了基本频率分辨率，因为随着DFT长度 $N$ 的增加，由 $f_s/N$ 给出的DFT点之间的频率间隔减小了。\n\nB. 补零不会提高基本频率分辨率。该分辨率由原始非零信号段的持续时间（长度 $L$）决定，而补零仅提供了对潜在频谱形状的一个更密集采样（或插值）的版本。\n\nC. 补零降低了基本频率分辨率，因为在时域信号中添加零实际上是将其频谱与一个sinc类函数进行卷积，这会引入额外的频谱涂抹。\n\nD. 补零提高了基本频率分辨率，但只有当总长度 $N$ 被选为2的幂以利用快速傅里叶变换 (FFT) 算法的效率时，这种提高才显著。\n\nE. 补零对频率分辨率和所得周期图的视觉外观都没有影响，因为添加的零不包含能量。", "solution": "我们从一个有限长度的离散时间信号 $x[n]$ 开始，该信号仅在 $n=0,1,\\dots,L-1$ 时非零。其离散时间傅里叶变换 (DTFT) 为\n$$\nX\\!\\left(\\exp(j\\omega)\\right)=\\sum_{n=0}^{L-1}x[n]\\exp(-j\\omega n).\n$$\n方法1计算 $L$ 点DFT，\n$$\nX_{L}[k]=\\sum_{n=0}^{L-1}x[n]\\exp\\!\\left(-j\\frac{2\\pi k}{L}n\\right)=X\\!\\left(\\exp\\!\\left(j\\omega_{k}^{(L)}\\right)\\right),\\quad \\omega_{k}^{(L)}=\\frac{2\\pi k}{L},\n$$\n这是在 $\\omega_{k}^{(L)}$ 处对DTFT进行采样。方法2通过定义 $x_{p}[n]=x[n]$ (对于 $0\\leq n\\leq L-1$) 和 $x_{p}[n]=0$ (对于 $L\\leq n\\leq N-1$)，将数据补零至长度 $N=L+Z$，并计算\n$$\nX_{N}[k]=\\sum_{n=0}^{N-1}x_{p}[n]\\exp\\!\\left(-j\\frac{2\\pi k}{N}n\\right)=\\sum_{n=0}^{L-1}x[n]\\exp\\!\\left(-j\\frac{2\\pi k}{N}n\\right)=X\\!\\left(\\exp\\!\\left(j\\omega_{k}^{(N)}\\right)\\right),\n$$\n其中 $\\omega_{k}^{(N)}=\\frac{2\\pi k}{N}$。因此，补零不会改变 $X\\!\\left(\\exp(j\\omega)\\right)$；它只是通过将频率网格间距从 $\\Delta \\omega_{L}=\\frac{2\\pi}{L}$ 减小到 $\\Delta \\omega_{N}=\\frac{2\\pi}{N}$（或者以赫兹为单位，从 $\\Delta f_{L}=\\frac{f_{s}}{L}$ 减小到 $\\Delta f_{N}=\\frac{f_{s}}{N}$），从而对同一个潜在的DTFT产生更密集的采样。\n\n在这些采样频率点上的（缩放的）周期图具有形式\n$$\nP_{N}[k]\\propto \\left|X_{N}[k]\\right|^{2}=\\left|X\\!\\left(\\exp\\!\\left(j\\omega_{k}^{(N)}\\right)\\right)\\right|^{2},\n$$\n对于 $P_{L}[k]$ 也是类似的。比例常数不影响分辨率。\n\n基本频率分辨率（分辨两个频率相近的正弦波的能力）由有限观测所施加的有效谱窗决定。将 $x[n]=s[n]w[n]$，其中 $w[n]=1$ (对于 $0\\leq n\\leq L-1$) 且在其他情况下为0，我们有\n$$\nX\\!\\left(\\exp(j\\omega)\\right)=\\frac{1}{2\\pi}\\int_{-\\pi}^{\\pi}S\\!\\left(\\exp(j\\theta)\\right)W\\!\\left(\\exp\\!\\left(j(\\omega-\\theta)\\right)\\right)\\,d\\theta,\n$$\n所以观测到的频谱是潜在频谱与窗谱 $W$ 的卷积。对于长度为 $L$ 的矩形窗，\n$$\nW\\!\\left(\\exp(j\\omega)\\right)=\\sum_{n=0}^{L-1}\\exp(-j\\omega n)=\\exp\\!\\left(-j\\omega\\frac{L-1}{2}\\right)\\frac{\\sin\\!\\left(\\frac{\\omega L}{2}\\right)}{\\sin\\!\\left(\\frac{\\omega}{2}\\right)}.\n$$\n$\\left|W\\!\\left(\\exp(j\\omega)\\right)\\right|$ 的第一零点出现在 $\\omega=\\pm \\frac{2\\pi}{L}$ 处，所以主瓣宽度（在第一零点之间）为\n$$\n\\Delta \\omega_{\\text{mainlobe}}=\\frac{4\\pi}{L},\\quad \\Delta f_{\\text{mainlobe}}=\\frac{\\Delta \\omega_{\\text{mainlobe}}}{2\\pi}f_{s}=\\frac{2f_{s}}{L}.\n$$\n这个主瓣宽度决定了分辨两个相邻音调的能力：如果它们的频率间隔小于大约 $\\Delta f_{\\text{mainlobe}}$，无论 $X\\!\\left(\\exp(j\\omega)\\right)$ 被采样的多么精细，它们都无法被分辨。补零不改变 $w[n]$，因此也不改变 $W$、其主瓣宽度或相关的分辨率；它只是更密集地对同一个 $X\\!\\left(\\exp(j\\omega)\\right)$ 进行采样。\n\n因此：\n- 陈述A不正确，因为通过补零将DFT谱线间隔从 $\\frac{f_{s}}{L}$ 减小到 $\\frac{f_{s}}{N}$ 并不会使决定分辨率的窗主瓣变窄。\n- 陈述B正确：补零不会提高基本频率分辨率；它对频谱进行插值并细化了频率网格。\n- 陈述C不正确：频谱涂抹是由加窗引起的；补零不会引入额外的卷积或涂抹。\n- 陈述D不正确：FFT效率是计算上的问题，而不是一个影响频谱分辨率的效应。\n- 陈述E不正确：虽然补零不改变分辨率，但它确实通过提供一个更密集采样的周期图来改变视觉外观。\n\n因此，最准确的描述由陈述B给出。", "answer": "$$\\boxed{B}$$", "id": "1764290"}]}