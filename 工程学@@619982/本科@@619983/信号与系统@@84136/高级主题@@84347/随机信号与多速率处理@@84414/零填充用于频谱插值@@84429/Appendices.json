{"hands_on_practices": [{"introduction": "信号能量是一个基本概念，帕塞瓦尔定理（Parseval's theorem）建立了时域能量与频域能量之间的桥梁。然而，在处理经过零填充的信号时，如果不注意离散傅里叶变换（DFT）定义中的归一化因子，就很容易得出错误的结论。这个练习旨在通过一个常见的计算错误，强调在应用帕塞瓦尔定理时保持严谨的重要性，从而巩固您对能量守恒和DFT属性的理解。[@problem_id:1774276]", "problem": "考虑一个有限长复值离散时间信号 $x[n]$，该信号仅在区间 $0 \\leq n \\leq N-1$ 上非零。此信号的总能量在时域中定义为 $E_x = \\sum_{n=0}^{N-1} |x[n]|^2$。\n\n然后对此信号进行补零，以创建一个长度为 $N'$ 的新长信号 $y[n]$，其中 $N' > N$。新信号定义如下：\n$$\ny[n] = \\begin{cases} x[n], & 0 \\leq n \\leq N-1 \\\\ 0, & N \\leq n \\leq N'-1 \\end{cases}\n$$\n计算此补零信号的 $N'$ 点离散傅里叶变换 (DFT)，得到频域表示 $Y[k] = \\sum_{n=0}^{N'-1} y[n] \\exp(-j\\frac{2\\pi kn}{N'})$，其中 $k=0, 1, \\dots, N'-1$。\n\n一位工程师试图从此新 DFT 谱中验证信号能量，计算了一个他们标记为 $E_{calc}$ 的量。然而，他们在计算中错误地使用了原始信号长度 $N$ 作为缩放因子，如下所示：\n$$\nE_{calc} = \\frac{1}{N} \\sum_{k=0}^{N'-1} |Y[k]|^2\n$$\n确定比值 $R = \\frac{E_{calc}}{E_x}$，该比值代表工程师能量计算中的分数误差。信号 $x[n]$ 是非平凡的（即其能量 $E_x$ 非零）。请用 $N$ 和 $N'$ 的闭式解析表达式表示你的答案。", "solution": "给定一个有限长信号 $x[n]$，其支撑区间为 $0 \\leq n \\leq N-1$，能量为 $E_{x}=\\sum_{n=0}^{N-1}|x[n]|^{2}$。定义长度为 $N'$ 的补零信号 $y[n]$ 为：当 $0 \\leq n \\leq N-1$ 时，$y[n]=x[n]$；当 $N \\leq n \\leq N'-1$ 时，$y[n]=0$。其 $N'$ 点 DFT 为\n$$\nY[k]=\\sum_{n=0}^{N'-1}y[n]\\exp\\!\\left(-j\\frac{2\\pi kn}{N'}\\right),\\quad k=0,1,\\dots,N'-1.\n$$\n根据此 DFT 约定，$N'$ 点 DFT 的帕塞瓦尔定理表明\n$$\n\\sum_{n=0}^{N'-1}|y[n]|^{2}=\\frac{1}{N'}\\sum_{k=0}^{N'-1}|Y[k]|^{2}.\n$$\n因为当 $0 \\leq n \\leq N-1$ 时 $y[n]=x[n]$，而在其他情况下 $y[n]=0$，我们有\n$$\n\\sum_{n=0}^{N'-1}|y[n]|^{2}=\\sum_{n=0}^{N-1}|x[n]|^{2}=E_{x}.\n$$\n代入帕塞瓦尔定理可得\n$$\nE_{x}=\\frac{1}{N'}\\sum_{k=0}^{N'-1}|Y[k]|^{2}\\quad\\Longrightarrow\\quad \\sum_{k=0}^{N'-1}|Y[k]|^{2}=N' E_{x}.\n$$\n工程师计算\n$$\nE_{\\text{calc}}=\\frac{1}{N}\\sum_{k=0}^{N'-1}|Y[k]|^{2}=\\frac{1}{N}\\left(N' E_{x}\\right)=\\frac{N'}{N}E_{x}.\n$$\n因此，所求的比值为\n$$\nR=\\frac{E_{\\text{calc}}}{E_{x}}=\\frac{N'}{N}.\n$$\n由于 $N'>N$ 且 $E_{x}\\neq 0$，这表明工程师以 $\\frac{N'}{N}$ 的因子高估了能量。", "answer": "$$\\boxed{\\frac{N'}{N}}$$", "id": "1774276"}, {"introduction": "零填充最核心的应用之一，就是通过对频谱进行“插值”来更清晰地观察信号的频率成分。本练习模拟了一个非常实际的挑战：一个微弱的信号峰值是否可能被一个强信号的旁瓣（sidelobe）所掩盖？通过计算所需的零填充量，您将亲身体验如何利用这种技术来提高频谱的可视化分辨率，从而准确地区分真实的信号分量和频谱泄漏伪影。[@problem_id:1774273]", "problem": "一位信号处理工程师正在分析一个离散时间信号 $x[n]$，已知该信号是两个实正弦波之和。该信号通过在 $f_s = 8000$ Hz 的采样频率下采集 $N=1000$ 个样本来捕获，持续时间有限。信号由下式给出：\n$$x[n] = A_1 \\cos(2\\pi \\frac{f_1}{f_s} n) + A_2 \\cos(2\\pi \\frac{f_2}{f_s} n), \\quad \\text{for } n = 0, 1, \\dots, N-1$$\n主分量的频率为 $f_1 = 1000$ Hz。该频率被特意选择，以使其与 $N$ 点离散傅里叶变换 (DFT) 的一个频率仓完全重合。怀疑在频率 $f_2 = 1010$ Hz 处存在一个更弱的次级分量。\n\n在分析有限长度信号的频谱时（这相当于施加了一个矩形窗），由于频谱泄漏，每个正弦分量都会产生一个主峰和一系列旁瓣。工程师担心，位于 $f_2$ 处的弱次级分量可能会被误认为是由位于 $f_1$ 处的强主分量产生的旁瓣，或被其掩盖。\n\n为了更好地观察频谱，工程师决定在信号 $x[n]$ 后追加 $N_{zero}$ 个零，创建一个总长度为 $N_{tot} = N + N_{zero}$ 的新信号，然后计算一个 $N_{tot}$ 点的 DFT。这个过程被称为零填充，它通过提供更密集的频率样本，有效地对底层的连续频谱进行插值。\n\n对于此问题，假设以下两个事实：\n1. 对于一个经过 $N$ 点矩形窗截断的正弦波，其频谱幅度的第一个主旁瓣出现在距离正弦波真实频率大约 $1.4303 \\times (f_s/N)$ 的频率偏移处。\n2. 为了可靠地区分次级分量的峰值与主分量邻近的旁瓣峰值，工程师要求零填充后 DFT 的频率间隔（我们称之为 $\\Delta f_{zp}$）不得超过次级分量的真实频率 $f_2$ 与主分量第一个主旁瓣频率之间频率差的一半。\n\n确定为满足工程师的分辨率标准，必须在信号后追加的最小整数零点数 $N_{zero}$。", "solution": "零填充后 DFT 的频率间隔为 $\\Delta f_{zp} = \\frac{f_{s}}{N_{tot}}$，其中 $N_{tot} = N + N_{zero}$。对于长度为 $N$ 的矩形窗，位于 $f_{1}$ 的正弦波的第一个主旁瓣出现在\n$$\nf_{\\text{sl},1} = f_{1} + 1.4303 \\left(\\frac{f_{s}}{N}\\right).\n$$\n位于 $f_{2}$ 的疑似次级分量与此旁瓣之间的频率差为\n$$\nd \\equiv \\left| f_{2} - f_{\\text{sl},1} \\right| = \\left| f_{2} - f_{1} - 1.4303 \\left(\\frac{f_{s}}{N}\\right) \\right|.\n$$\n工程师的标准要求\n$$\n\\Delta f_{zp} \\leq \\frac{1}{2} d \\quad \\Longrightarrow \\quad \\frac{f_{s}}{N_{tot}} \\leq \\frac{1}{2} \\left| f_{2} - f_{1} - 1.4303 \\left(\\frac{f_{s}}{N}\\right) \\right|.\n$$\n求解 $N_{tot}$ 可得\n$$\nN_{tot} \\geq \\frac{2 f_{s}}{\\left| f_{2} - f_{1} - 1.4303 \\left(\\frac{f_{s}}{N}\\right) \\right|}.\n$$\n代入 $f_{s} = 8000$, $N = 1000$, $f_{1} = 1000$ 和 $f_{2} = 1010$：\n$$\n\\frac{f_{s}}{N} = \\frac{8000}{1000} = 8,\\quad 1.4303 \\left(\\frac{f_{s}}{N}\\right) = 1.4303 \\times 8 = 11.4424,\n$$\n$$\nd = \\left| 1010 - 1000 - 11.4424 \\right| = \\left| 10 - 11.4424 \\right| = 1.4424,\n$$\n$$\nN_{tot} \\geq \\frac{2 \\times 8000}{1.4424} = \\frac{16000}{1.4424} \\approx 11092.623\\ldots\n$$\n因此，最小整数 $N_{tot}$ 为 $11093$，所以\n$$\nN_{zero} = N_{tot} - N = 11093 - 1000 = 10093.\n$$", "answer": "$$\\boxed{10093}$$", "id": "1774273"}, {"introduction": "掌握一个概念的最高境界，是能够逆向运用其原理。这个练习将挑战您从一个全新的角度思考零填充：我们将不再仅仅观察其结果，而是要去分析零填充引入的特定“伪影”——频谱上的高频涟波——来反向推断原始未知信号的属性。这个实践将揭示有限长信号的截断效应（即加窗效应）与频谱特性之间的深刻对偶关系。[@problem_id:1774257]", "problem": "在一个信号处理应用中，采集到一个瞬态实值离散时间信号 $x[n]$。已知该信号的长度 $L$ 有限但未知。也就是说，当 $n < 0$ 和 $n \\ge L$ 时，$x[n] = 0$。为了以高分辨率分析其频谱内容，该序列被零填充至总长度 $N = 4096$。然后对这个零填充序列计算一个 $N$ 点离散傅里叶变换 (DFT)，记为 $X[k]$。\n\n在检查幅度谱 $|X[k]|$ 时，观察到该谱由一个对应于原始信号内容的宽阔、缓慢变化的包络组成，该包络被一个精细的高频波纹模式所调制。对该波纹模式的详细分析表明，其局部最小值（零点）在 DFT 索引 $k$ 上的平均间隔为 $\\Delta k = 22.76$ 个样本。\n\n假设这些波纹是原始信号在长度 $L$ 处被急剧截断产生的伪影，确定信号 $x[n]$ 的原始长度 $L$。将你对 $L$ 的答案表示为最接近的整数。", "solution": "在幅度谱中观察到的精细波纹是由 $x[n]$ 被截断至长度 $L$ 所引起的，这等效于将原始信号乘以一个长度为 $L$ 的矩形窗 $w[n]$。该矩形窗的离散时间傅里叶变换 (DTFT) 为\n$$\nW\\!\\left(\\exp(j\\omega)\\right)=\\exp\\!\\left(-j\\omega\\frac{L-1}{2}\\right)\\frac{\\sin\\!\\left(\\frac{\\omega L}{2}\\right)}{\\sin\\!\\left(\\frac{\\omega}{2}\\right)}.\n$$\n幅度 $|W(\\exp(j\\omega))|$ 在以下位置有零点\n$$\n\\frac{\\omega L}{2}=m\\pi \\quad \\Rightarrow \\quad \\omega=\\frac{2\\pi m}{L}, \\quad m\\in\\mathbb{Z}\\setminus\\{0\\}.\n$$\n因此，频率上连续零点之间的间隔为\n$$\n\\Delta\\omega=\\frac{2\\pi}{L}.\n$$\n$N$ 点 DFT 在频率 $\\omega_{k}=\\frac{2\\pi k}{N}$ 处对 DTFT 进行采样，因此连续零点之间在 DFT 索引上的间隔为\n$$\n\\Delta k=\\frac{N\\,\\Delta\\omega}{2\\pi}=\\frac{N}{L}.\n$$\n求解 $L$ 可得\n$$\nL=\\frac{N}{\\Delta k}.\n$$\n给定 $N=4096$ 和观察到的 $\\Delta k=22.76$，我们得到\n$$\nL=\\frac{4096}{22.76}\\approx 180.\n$$\n四舍五入到最接近的整数，得到 $L=180$。", "answer": "$$\\boxed{180}$$", "id": "1774257"}]}