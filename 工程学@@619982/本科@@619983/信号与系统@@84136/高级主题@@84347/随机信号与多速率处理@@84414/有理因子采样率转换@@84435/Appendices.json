{"hands_on_practices": [{"introduction": "掌握有理因子采样率转换理论的关键在于动手实践。第一个练习将带领你一步步地在时域中追踪一个简单的有限长信号，看它如何经历上采样、理想滤波和下采样的完整三阶段过程。这个练习旨在通过具体的计算，帮助你建立对采样率转换基本机理的扎实理解 [@problem_id:1750673]。", "problem": "在一个专用的数字信号处理（DSP）单元中，需要对一个短输入信号进行重采样。输入是一个有限长因果信号，在 $n=0, 1, 2$ 时定义为 $x[n] = \\{1, 2, 3\\}$，对于所有其他整数 $n$ 值，$x[n] = 0$。\n\n该信号由一个采样率转换器处理，该转换器以一个有理因子 $L/M = 2/3$ 改变采样率。该转换器包含三个阶段：\n1.  一个升采样器，将采样率增加一个因子 $L=2$。\n2.  一个理想低通滤波器。\n3.  一个降采样器，将采样率降低一个因子 $M=3$。\n\n理想低通滤波器的设计旨在完美去除由升采样器产生的镜像伪影，同时不失真所需的信号分量。其截止频率为 $\\omega_c = \\pi/M$，通带增益等于 $L$。\n\n确定输出序列 $y[n]$ 在索引 $n = -1, 0, 1, 2, 3$ 处的值。", "solution": "输入为 $x[n]=\\{1,2,3\\}$（对于 $n=0,1,2$），其他情况下为零。转换器执行因子为 $L=2$ 的升采样，通带增益为 $L$、截止频率为 $\\omega_{c}=\\pi/M=\\pi/3$ 的理想低通滤波，以及因子为 $M=3$ 的降采样。\n\n以因子 $L=2$ 升采样产生 $u[n]=x[n/2]$（对于偶数 $n$），以及 $u[n]=0$（对于奇数 $n$）。等效地，$u[2r]=x[r]$（对于 $r=0,1,2$），其他情况下 $u[n]=0$。\n\n理想低通滤波器的频率响应为\n$$\nH(\\omega)=\\begin{cases}\nL, & |\\omega|\\leq \\omega_{c},\\\\\n0, & \\text{otherwise},\n\\end{cases}\n$$\n其中 $L=2$ 且 $\\omega_{c}=\\pi/3$。其脉冲响应是逆离散时间傅里叶变换（inverse DTFT）：\n$$\nh[n]=\\frac{1}{2\\pi}\\int_{-\\omega_{c}}^{\\omega_{c}}L\\,\\exp(j\\omega n)\\,d\\omega\n=\n\\begin{cases}\n\\displaystyle \\frac{L\\omega_{c}}{\\pi}, & n=0,\\\\[6pt]\n\\displaystyle \\frac{L\\sin(\\omega_{c} n)}{\\pi n}, & n\\neq 0.\n\\end{cases}\n$$\n代入 $L=2$ 和 $\\omega_{c}=\\pi/3$ 得到\n$$\nh[0]=\\frac{2}{3},\\qquad h[n]=\\frac{2\\sin\\!\\left(\\frac{\\pi n}{3}\\right)}{\\pi n}\\ \\text{ for } n\\neq 0.\n$$\n滤波后，$w[n]=(h*u)[n]=\\sum_{k}h[k]\\,u[n-k]$。利用 $u[n]$ 的稀疏性，这变为\n$$\nw[n]=\\sum_{r=0}^{2}x[r]\\;h[n-2r].\n$$\n以因子 $M=3$ 降采样得到\n$$\ny[n]=w[3n]=\\sum_{r=0}^{2}x[r]\\;h[3n-2r].\n$$\n使用 $x[0]=1$, $x[1]=2$, $x[2]=3$，我们有\n$$\ny[n]=h[3n]+2\\,h[3n-2]+3\\,h[3n-4].\n$$\n我们使用 $h[0]=\\frac{2}{3}$ 以及当 $m\\neq 0$ 时 $h[m]=\\frac{2\\sin(\\pi m/3)}{\\pi m}$ 来计算所需索引处的 $h[m]$。注意 $h[m]$ 是偶函数，并且对于非零整数 $q$，$h[3q]=0$。\n\n计算所需的值：\n- $h[\\pm 1]=\\frac{2\\sin(\\pi/3)}{\\pi}=\\frac{\\sqrt{3}}{\\pi}$，\n- $h[\\pm 2]=\\frac{2\\sin(2\\pi/3)}{2\\pi}=\\frac{\\sqrt{3}}{2\\pi}$，\n- $h[\\pm 3]=0$，\n- $h[\\pm 4]=\\frac{2\\sin(4\\pi/3)}{4\\pi}=-\\frac{\\sqrt{3}}{4\\pi}$，\n- $h[\\pm 5]=\\frac{2\\sin(5\\pi/3)}{5\\pi}=-\\frac{\\sqrt{3}}{5\\pi}$，\n- $h[\\pm 6]=0$，\n- $h[\\pm 7]=\\frac{2\\sin(7\\pi/3)}{7\\pi}=\\frac{\\sqrt{3}}{7\\pi}$，\n- $h[9]=0$。\n\n现在计算 $y[n]=h[3n]+2h[3n-2]+3h[3n-4]$：\n\n对于 $n=-1$：$3n=-3$, $3n-2=-5$, $3n-4=-7$,\n$$\ny[-1]=h[-3]+2h[-5]+3h[-7]=0+2\\!\\left(-\\frac{\\sqrt{3}}{5\\pi}\\right)+3\\!\\left(\\frac{\\sqrt{3}}{7\\pi}\\right)=\\frac{\\sqrt{3}}{35\\pi}.\n$$\n\n对于 $n=0$：$3n=0$, $3n-2=-2$, $3n-4=-4$,\n$$\ny[0]=h[0]+2h[-2]+3h[-4]=\\frac{2}{3}+2\\!\\left(\\frac{\\sqrt{3}}{2\\pi}\\right)+3\\!\\left(-\\frac{\\sqrt{3}}{4\\pi}\\right)=\\frac{2}{3}+\\frac{\\sqrt{3}}{4\\pi}.\n$$\n\n对于 $n=1$：$3n=3$, $3n-2=1$, $3n-4=-1$,\n$$\ny[1]=h[3]+2h[1]+3h[-1]=0+2\\!\\left(\\frac{\\sqrt{3}}{\\pi}\\right)+3\\!\\left(\\frac{\\sqrt{3}}{\\pi}\\right)=\\frac{5\\sqrt{3}}{\\pi}.\n$$\n\n对于 $n=2$：$3n=6$, $3n-2=4$, $3n-4=2$,\n$$\ny[2]=h[6]+2h[4]+3h[2]=0+2\\!\\left(-\\frac{\\sqrt{3}}{4\\pi}\\right)+3\\!\\left(\\frac{\\sqrt{3}}{2\\pi}\\right)=\\frac{\\sqrt{3}}{\\pi}.\n$$\n\n对于 $n=3$：$3n=9$, $3n-2=7$, $3n-4=5$,\n$$\ny[3]=h[9]+2h[7]+3h[5]=0+2\\!\\left(\\frac{\\sqrt{3}}{7\\pi}\\right)+3\\!\\left(-\\frac{\\sqrt{3}}{5\\pi}\\right)=-\\frac{11\\sqrt{3}}{35\\pi}.\n$$\n\n因此，对于 $n=-1,0,1,2,3$，输出序列为\n$$\n\\left(\\frac{\\sqrt{3}}{35\\pi},\\ \\frac{2}{3}+\\frac{\\sqrt{3}}{4\\pi},\\ \\frac{5\\sqrt{3}}{\\pi},\\ \\frac{\\sqrt{3}}{\\pi},\\ -\\frac{11\\sqrt{3}}{35\\pi}\\right).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\sqrt{3}}{35\\pi} & \\frac{2}{3}+\\frac{\\sqrt{3}}{4\\pi} & \\frac{5\\sqrt{3}}{\\pi} & \\frac{\\sqrt{3}}{\\pi} & -\\frac{11\\sqrt{3}}{35\\pi}\\end{pmatrix}}$$", "id": "1750673"}, {"introduction": "虽然时域分析很精确，但频域分析往往能提供更深刻的直观理解。这个练习将探讨一个处于最高离散频率（即 $x[n]=(-1)^n$）的信号在通过速率转换器时会发生什么 [@problem_id:1750635]。通过这个例子，你将看到上采样和滤波的组合如何产生深刻且富有启发性的结果，并理解为什么低通滤波器是不可或缺的。", "problem": "一个离散时间信号处理系统通过一个有理数因子 $L/M$ 进行采样率转换。该过程包含三个阶段：第一，输入信号以 $L=2$ 的因子进行上采样；第二，上采样后的信号通过一个理想低通滤波器；第三，滤波后的信号以 $M=3$ 的因子进行下采样。\n\n系统的输入是交替序列 $x[n] = (-1)^n$。\n\n该理想低通滤波器用于防止下采样阶段产生的混叠，其传递函数如下：\n$$ H(e^{j\\omega}) = \\begin{cases} 2 & \\text{for } |\\omega| \\leq \\frac{\\pi}{3} \\\\ 0 & \\text{for } \\frac{\\pi}{3} < |\\omega| \\leq \\pi \\end{cases} $$\n求该系统的输出序列 $y[n]$。答案需用关于 $n$ 的闭式表达式表示。", "solution": "我们使用离散时间傅里叶变换 (DTFT) 和标准多速率关系，在频域中对系统进行逐级分析。\n\n输入为 $x[n] = (-1)^{n} = \\exp(j \\pi n)$。其 DTFT 是在 $\\omega = \\pi$（模 $2\\pi$）处的线谱，可表示为\n$$\nX(e^{j\\omega}) = 2\\pi \\sum_{k\\in\\mathbb{Z}} \\delta(\\omega - \\pi - 2\\pi k).\n$$\n\n以因子 $L=2$ 上采样后，上采样信号 $u[n]$ 的 DTFT 由标准公式给出\n$$\nU(e^{j\\omega}) = X(e^{j 2\\omega}).\n$$\n代入 $X$ 的表达式，\n$$\nU(e^{j\\omega}) = 2\\pi \\sum_{k\\in\\mathbb{Z}} \\delta(2\\omega - \\pi - 2\\pi k).\n$$\n利用狄拉克 delta 函数的尺度变换性质 $\\delta(a \\omega - b) = \\frac{1}{|a|}\\delta(\\omega - b/a)$，我们得到\n$$\nU(e^{j\\omega}) = \\pi \\sum_{k\\in\\mathbb{Z}} \\delta\\!\\left(\\omega - \\frac{\\pi}{2} - \\pi k\\right).\n$$\n因此，在主值区间内，上采样信号仅在 $\\omega = \\pm \\frac{\\pi}{2}$ 处有谱线。\n\n理想低通滤波器的传递函数为\n$$\nH(e^{j\\omega}) = \\begin{cases}\n2 & \\text{for } |\\omega| \\leq \\frac{\\pi}{3}, \\\\\n0 & \\text{for } \\frac{\\pi}{3} < |\\omega| \\leq \\pi.\n\\end{cases}\n$$\n由于 $\\frac{\\pi}{2} > \\frac{\\pi}{3}$，频率 $\\omega = \\pm \\frac{\\pi}{2}$ 严格处于通带之外。因此，滤波后的频谱为\n$$\nW(e^{j\\omega}) = H(e^{j\\omega})\\,U(e^{j\\omega}) = 0,\n$$\n这意味着时域滤波信号恒等于零：\n$$\nw[n] = 0 \\quad \\text{for all } n.\n$$\n\n最后，以因子 $M=3$ 进行下采样，得到\n$$\ny[n] = w[3n] = 0 \\quad \\text{for all } n.\n$$\n\n因此，输出序列为零序列。", "answer": "$$\\boxed{0}$$", "id": "1750635"}, {"introduction": "真实世界的信号通常不是单一频率的正弦波，而是占据了一定的频率带宽。最后一个练习将让你从频域的角度，直观地观察整个信号频谱的变换过程 [@problem_id:1750644]。通过分析信号带宽在每个阶段如何被压缩、滤除镜像和扩展，你将掌握一个强大的概念工具，用以预测任何速率转换过程的最终效果。", "problem": "一个离散时间信号 $x[n]$ 的离散时间傅里叶变换 (DTFT) 为 $X(e^{j\\omega})$。当频率在 $|\\omega| < \\pi/5$ 范围内时，其值非零且为常数1；当 $\\pi/5 \\leq |\\omega| \\leq \\pi$ 时，其值为零。\n\n该信号由一个包含以下三个阶段的数字系统进行处理：\n1. 在原始信号 $x[n]$ 的每对连续采样点之间插入一个零值采样点，从而创建一个中间信号 $x_u[n]$。具体来说，如果 $n$ 是偶数，$x_u[n] = x[n/2]$；如果 $n$ 是奇数，$x_u[n] = 0$。\n2. 信号 $x_u[n]$ 接着通过一个理想低通数字滤波器，其通带增益为2，截止频率为 $\\pi/3$ 弧度/采样点。设该滤波器的输出为 $x_f[n]$。\n3. 最终的输出信号 $y[n]$ 是通过保留 $x_f[n]$ 中每三个采样点中的一个而得到的，即 $y[n] = x_f[3n]$。\n\n确定输出信号 $y[n]$ 的带宽。具体来说，求最大正频率 $\\omega_{max}$，使得对于所有频率 $|\\omega| < \\omega_{max}$，输出信号的DTFT $Y(e^{j\\omega})$ 均非零。请将您的答案表示为 $\\pi$ 的数值倍数。", "solution": "给定一个离散时间信号，其DTFT为\n$$\nX(e^{j\\omega})=\\begin{cases}\n1, & |\\omega|<\\frac{\\pi}{5},\\\\\n0, & \\frac{\\pi}{5}\\leq|\\omega|\\leq \\pi.\n\\end{cases}\n$$\n阶段1是通过插零实现2倍上采样：当 $n$ 为偶数时，$x_{u}[n]=x[n/2]$；当 $n$ 为奇数时，$x_{u}[n]=0$。一个信号经过因子为 $L$ 的上采样后，其DTFT满足\n$$\nX_{u}(e^{j\\omega})=\\sum_{n=-\\infty}^{\\infty}x_{u}[n]\\exp(-j\\omega n)=\\sum_{k=-\\infty}^{\\infty}x[k]\\exp(-j\\omega(2k))=X(e^{j(2\\omega)}).\n$$\n因此，$X_{u}(e^{j\\omega})$ 非零的条件是 $2\\omega$ 落在 $X(e^{j\\Omega})$ 的通带内（模 $2\\pi$）。由于 $X(e^{j\\Omega})$ 仅在 $|\\Omega|<\\pi/5$ 时非零（周期为 $2\\pi$），这意味着\n$$\nX_{u}(e^{j\\omega})\\neq 0 \\quad \\Leftrightarrow \\quad |2\\omega-2\\pi m|<\\frac{\\pi}{5}\\ \\text{for some}\\ m\\in\\mathbb{Z},\n$$\n这等价于\n$$\n|\\omega-m\\pi|<\\frac{\\pi}{10}.\n$$\n在主区间 $[-\\pi,\\pi)$ 内，这会产生一个基带波瓣 $|\\omega|<\\pi/10$ 和在 $\\omega=\\pm\\pi$ 附近总宽度为 $\\pi/5$ 的镜像波瓣，即 $|\\omega\\mp\\pi|<\\pi/10$。\n\n阶段2应用一个通带增益为2、截止频率为 $\\omega_{c}=\\pi/3$ 的理想低通滤波器。其频率响应为\n$$\nH(e^{j\\omega})=\\begin{cases}\n2, & |\\omega|<\\frac{\\pi}{3},\\\\\n0, & \\frac{\\pi}{3}\\leq|\\omega|\\leq \\pi.\n\\end{cases}\n$$\n滤波后的频谱为\n$$\nX_{f}(e^{j\\omega})=H(e^{j\\omega})X_{u}(e^{j\\omega}).\n$$\n由于 $X_{u}$ 的基带为 $|\\omega|<\\pi/10$ 且 $\\pi/10<\\pi/3$，该基带部分通过并被乘以2，而 $\\pm\\pi$ 附近的镜像带落在阻带内被移除。因此\n$$\nX_{f}(e^{j\\omega})=\\begin{cases}\n2, & |\\omega|<\\frac{\\pi}{10},\\\\\n0, & \\frac{\\pi}{10}\\leq|\\omega|\\leq \\pi.\n\\end{cases}\n$$\n\n阶段3进行因子为 $M=3$ 的下采样：$y[n]=x_{f}[3n]$。一个信号经过因子为 $M$ 的抽取后，其DTFT满足\n$$\nY(e^{j\\omega})=\\frac{1}{M}\\sum_{k=0}^{M-1}X_{f}\\!\\left(e^{j\\frac{\\omega+2\\pi k}{M}}\\right).\n$$\n当 $M=3$ 时，\n$$\nY(e^{j\\omega})=\\frac{1}{3}\\sum_{k=0}^{2}X_{f}\\!\\left(e^{j\\frac{\\omega+2\\pi k}{3}}\\right).\n$$\n因为 $X_{f}(e^{j\\theta})$ 仅在 $|\\theta|<\\pi/10$ 时非零，所以和式中的一项非零的条件是\n$$\n\\left|\\frac{\\omega+2\\pi k}{3}\\right|<\\frac{\\pi}{10}.\n$$\n对于 $k=0$，该条件为 $|\\omega|<3\\pi/10$，这是可行的，并产生非零贡献。对于 $k=1$，条件要求 $|\\omega+2\\pi|<3\\pi/10$，这对于 $\\omega\\in[-\\pi,\\pi]$ 是不成立的。对于 $k=2$，条件要求 $|\\omega+4\\pi|<3\\pi/10$，这对于 $\\omega\\in[-\\pi,\\pi]$ 也是不可能的。因此，只有 $k=0$ 的项有贡献，并且 $Y(e^{j\\omega})$ 非零的精确范围是\n$$\n|\\omega|<\\frac{3\\pi}{10}.\n$$\n因此输出带宽为 $\\omega_{\\max}=\\frac{3\\pi}{10}$。\n\n因此，使得 $Y(e^{j\\omega})$ 在所有 $|\\omega|<\\omega_{\\max}$ 范围内都非零的最大正频率是 $\\omega_{\\max}=\\frac{3\\pi}{10}$，即 $\\pi$ 的倍数为 $\\frac{3}{10}\\pi$。", "answer": "$$\\boxed{\\frac{3\\pi}{10}}$$", "id": "1750644"}]}