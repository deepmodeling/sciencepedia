{"hands_on_practices": [{"introduction": "诺布尔恒等式是多速率系统设计的基石，它揭示了如何通过交换滤波器和采样率转换器的顺序来优化计算效率。第一个练习将带领我们实践第一诺布尔恒等式，即与升采样器相关的恒等式。通过为一个具体系统推导等效的滤波器，我们将亲身体验这种变换如何影响滤波器的传递函数，为实现更高效的硬件或软件实现奠定基础。 [@problem_id:1737867]", "problem": "在数字信号处理领域，多速率系统常用于改变信号的采样率。考虑一个离散时间信号处理架构，我们称之为系统1。在该系统中，一个Z变换为 $X(z)$ 的输入信号 $x[n]$ 首先由一个传递函数为 $G(z) = 1 + 2z^{-1} + z^{-2}$ 的有限冲激响应（FIR）滤波器处理。该滤波器的输出然后经过一个因子为 $L=2$ 的升采样，以产生输出信号 $y_1[n]$。因子为 $L$ 的升采样是一个在待升采样的序列的每两个样本之间插入 $L-1$ 个零的过程。\n\n出于硬件实现的考虑，需要进行系统重新设计。在称为系统2的新设计中，操作的顺序被颠倒了。相同的输入信号 $x[n]$ 首先经过一个相同的因子 $L=2$ 的升采样。这个升采样后的信号然后通过一个传递函数为 $H(z)$ 的新FIR滤波器，以产生输出信号 $y_2[n]$。\n\n请确定新滤波器的传递函数 $H(z)$，以确保对于任何任意输入信号 $x[n]$，系统2在功能上等同于系统1。您的答案应为一个以 $z^{-1}$ 的幂表示的 $H(z)$ 的表达式。", "solution": "设 $x[n]$ 的Z变换为 $X(z)$，且 $G(z)=1+2z^{-1}+z^{-2}$。通过一个传递函数为 $G(z)$ 的LTI系统进行滤波，得到 $V(z)=G(z)X(z)$。因子为 $L$ 的升采样是在样本之间插入 $L-1$ 个零；如果 $u[n]$ 是由 $v[n]$ 经过因子为 $L$ 的升采样得到的，则其Z变换满足 $U(z)=V(z^{L})$。因此，在系统1中（先滤波后进行因子为2的升采样），\n$$\nY_{1}(z)=V(z^{2})=G(z^{2})X(z^{2}).\n$$\n\n在系统2中，首先进行升采样：设 $w[n]$ 是 $x[n]$ 经过因子为2的升采样后的版本，我们有\n$$\nW(z)=X(z^{2}).\n$$\n然后通过 $H(z)$ 进行滤波，得到\n$$\nY_{2}(z)=H(z)W(z)=H(z)X(z^{2}).\n$$\n\n为使系统对所有输入信号都功能等效，我们需要对所有的 $X(z)$ 都有 $Y_{2}(z)=Y_{1}(z)$，这意味着\n$$\nH(z)=G(z^{2}).\n$$\n代入 $G(z)=1+2z^{-1}+z^{-2}$ 可得\n$$\nH(z)=1+2z^{-2}+z^{-4}.\n$$\n这也与时域观点相符，即，将滤波器移到升采样器之后，相当于在系数之间插入 $L-1$ 个零，即当 $n$ 为偶数时 $h[n]=g[n/2]$，当 $n$ 为奇数时为 $0$。", "answer": "$$\\boxed{1+2z^{-2}+z^{-4}}$$", "id": "1737867"}, {"introduction": "理论上的Z变换恒等式虽然简洁，但其真正的价值体现在时域的实现中。第二个练习将理论与实践联系起来，要求我们为一个经过优化的多速率系统推导其差分方程。这个过程不仅能加深我们对与降采样器相关的诺布尔恒等式的理解，还能让我们看到这些抽象概念如何直接转化为可执行的算法。 [@problem_id:1737888]", "problem": "在数字信号处理中，多速率系统常利用称为贵族恒等式 (noble identities) 的特性来优化计算效率。这些恒等式允许重排滤波和采样率转换等操作的顺序。\n\n考虑以下场景。一个因果线性时不变 (LTI) 系统被设计用于处理输入信号 $x[n]$。该过程包括两个阶段：\n1.  输入信号 $x[n]$ 首先由一个整数因子 $M=3$ 进行降采样，以产生中间信号 $v[n] = x[3n]$。\n2.  中间信号 $v[n]$ 接着由一个传递函数为 $H(z) = \\frac{1 + \\beta z^{-1}}{1 - \\alpha z^{-1}}$ 的因果 LTI 滤波器进行滤波，以产生最终的输出信号 $y[n]$。\n\n一位工程师知道，可以通过交换操作顺序来构建一个等效系统，即先对原始信号 $x[n]$ 进行滤波，然后再进行降采样。贵族恒等式规定，为了保持等效性，滤波器的传递函数必须从 $H(z)$ 修改为 $G(z) = H(z^M)$。\n\n已知对于任何给定的输入 $x[n]$，两种系统配置都产生完全相同的输出 $y[n]$，您的任务是确定此过程的最终输入-输出差分方程。滤波器的参数给定为 $\\alpha = 0.8$ 和 $\\beta = -0.25$。\n\n求解以标准形式表示的差分方程的系数 $A_1, B_0, B_3$：\n$$y[n] = A_1 y[n-1] + B_0 x[3n] + B_3 x[3n-3]$$\n\n将您的最终答案表示为一个行矩阵，其中包含按顺序排列的三个数值系数 $(A_1, B_0, B_3)$。", "solution": "令抽取器输出为 $v[n]=x[3n]$。给定的因果 LTI 滤波器具有传递函数\n$$\nH(z)=\\frac{1+\\beta z^{-1}}{1-\\alpha z^{-1}},\n$$\n因此，对于输入 $v[n]$ 和输出 $y[n]$，有\n$$\n\\frac{Y(z)}{V(z)}=\\frac{1+\\beta z^{-1}}{1-\\alpha z^{-1}} \\;\\;\\Rightarrow\\;\\; (1-\\alpha z^{-1})Y(z)=(1+\\beta z^{-1})V(z).\n$$\n进行 $z$ 逆变换得到时域差分方程\n$$\ny[n]-\\alpha y[n-1]=v[n]+\\beta v[n-1].\n$$\n代入 $v[n]=x[3n]$ 和 $v[n-1]=x[3(n-1)]=x[3n-3]$ 得\n$$\ny[n]=\\alpha y[n-1]+x[3n]+\\beta x[3n-3].\n$$\n与所要求的形式 $y[n]=A_{1}y[n-1]+B_{0}x[3n]+B_{3}x[3n-3]$ 比较，得出\n$$\nA_{1}=\\alpha,\\quad B_{0}=1,\\quad B_{3}=\\beta.\n$$\n根据指定的参数 $\\alpha=0.8$ 和 $\\beta=-0.25$，系数为\n$$\nA_{1}=0.8,\\quad B_{0}=1,\\quad B_{3}=-0.25.\n$$\n此结果与贵族恒等式一致：先用 $G(z)=H(z^{3})=\\frac{1+\\beta z^{-3}}{1-\\alpha z^{-3}}$ 进行滤波，再以 3 为因子进行降采样，得到 $w[n]-\\alpha w[n-3]=x[n]+\\beta x[n-3]$，然后在 3 的倍数处进行采样，会得到与上述相同的 $y[n]$ 关系。", "answer": "$$\\boxed{\\begin{pmatrix}0.8 & 1 & -0.25\\end{pmatrix}}$$", "id": "1737888"}, {"introduction": "在软件定义无线电等现代通信应用中，以计算高效的方式滤除强干扰至关重要。最后一个练习提出了一个真实的工程挑战：在一个降采样系统之后设计一个陷波滤波器以消除特定频率的干扰。要解决这个问题，我们必须综合运用诺布尔恒等式、信号混叠和滤波器设计的知识，这充分展示了多速率信号处理理论在解决复杂问题中的强大威力。 [@problem_id:1737892]", "problem": "在现代软件定义无线电系统中，常常需要消除强的窄带干扰。为了最小化计算负载，信号处理通常在尽可能低的采样率下进行。\n\n考虑一个被强正弦干扰污染的离散时间信号。已知该干扰的归一化角频率为 $\\omega_0 = \\frac{3\\pi}{8}$ 弧度/样本。为了消除这种干扰，信号首先通过一个抽取器，该抽取器以 $M=5$ 的因子对信号进行降采样。得到的低速率信号随后由一个稳定的二阶无限脉冲响应（IIR）滤波器 $H(z)$ 进行滤波。\n\n该陷波滤波器被设计为在单位圆上有一对共轭复零点，位于 $z_{1,2} = e^{\\pm j\\theta_z}$，用于消除干扰。滤波器的极点位于 $p_{1,2} = r e^{\\pm j\\theta_z}$，半径为 $r=0.95$，以确保稳定性并产生一个急剧的陷波。\n\n你的任务是确定定义滤波器零点位置的基本正角度 $\\theta_z$。你的答案应满足 $0 < \\theta_z < \\pi$。请用弧度表示你的最终答案。", "solution": "原始离散时间信号中的干扰具有归一化角频率 $\\omega_{0} = \\frac{3\\pi}{8}$ 弧度/样本。经过因子为 $M=5$ 的抽取后，降采样的序列为 $y[n] = x[nM]$。对于复指数分量 $x[n] = \\exp(j\\omega_{0} n)$，抽取后的序列变为 $y[n] = \\exp(j \\omega_{0} M n)$，其对应的归一化角频率为\n$$\n\\omega_{d} = M\\omega_{0} \\quad \\text{mod} \\; 2\\pi.\n$$\n要将IIR滤波器的陷波点置于降采样信号中存在的干扰频率上，我们必须将 $\\omega_{d}$ 映射到主区间 $(-\\pi,\\pi]$ 内：\n$$\n\\omega_{d} = \\left(M\\omega_{0} + 2\\pi k\\right) \\in (-\\pi,\\pi] \\quad \\text{for some} \\; k \\in \\mathbb{Z}.\n$$\n代入 $\\omega_{0} = \\frac{3\\pi}{8}$ 和 $M=5$ 得\n$$\nM\\omega_{0} = \\frac{15\\pi}{8}.\n$$\n选择 $k=-1$ 将其折叠到 $(-\\pi,\\pi]$ 区间内，\n$$\n\\omega_{d} = \\frac{15\\pi}{8} - 2\\pi = \\frac{15\\pi}{8} - \\frac{16\\pi}{8} = -\\frac{\\pi}{8}.\n$$\n陷波滤波器的零点必须位于 $z_{1,2} = \\exp(\\pm j\\theta_{z})$，其中基本正角度 $\\theta_{z}$ 在 $(0,\\pi)$ 区间内。由于降采样信号中的干扰出现在 $\\omega_{d} = -\\frac{\\pi}{8}$，所需的正角度是其绝对值\n$$\n\\theta_{z} = |\\omega_{d}| = \\frac{\\pi}{8}.\n$$\n这个选择将零点放置在正确的共轭角度上，以消除混叠的干扰。极点半径 $r=0.95$ 决定了陷波的锐度，但不影响角度 $\\theta_{z}$。", "answer": "$$\\boxed{\\frac{\\pi}{8}}$$", "id": "1737892"}]}