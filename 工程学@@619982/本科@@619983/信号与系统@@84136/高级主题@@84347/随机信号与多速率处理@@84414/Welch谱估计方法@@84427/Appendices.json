{"hands_on_practices": [{"introduction": "要有效运用韦尔奇方法，第一步是规划如何将信号分割成段。本练习将带你完成一个基础但至关重要的计算：根据信号总长度、选定的段长度以及重叠率，确定可以用于平均的总段数。掌握这个计算是所有韦尔奇谱估计任务的实际起点。[@problem_id:1773288]", "problem": "一位工程师正在使用韦尔奇法（Welch's method）来估计从深空探测器接收到的噪声信号的功率谱密度（Power Spectral Density, PSD）。记录的离散时间信号总共包含 $N=8192$ 个采样点。为了进行分析，该信号将被分割成多个长度各为 $L=512$ 个采样点的数据段。为提高估计的统计稳定性，设计的连续数据段之间有 75% 的重叠。计算在此过程中为求平均而创建的数据段总数。", "solution": "设 $N$ 为信号中的总采样点数，$L$ 为每个数据段的长度，$P$ 为重叠百分比。我们已知：\n- 总采样点数, $N = 8192$。\n- 数据段长度, $L = 512$ 个采样点。\n- 重叠百分比, $P = 75\\% = 0.75$。\n\n首先，我们计算任意两个连续数据段之间重叠的采样点数。这等于重叠百分比乘以数据段长度。\n$$\n\\text{重叠采样点数} = P \\times L = 0.75 \\times 512 = 384 \\text{ 个采样点}\n$$\n\n接下来，我们确定“步长”或“跨度”，我们将其表示为 $S$。步长是窗口为获取下一个数据段而移动的采样点数。它等于数据段长度与重叠采样点数之差。\n$$\nS = L - (\\text{重叠采样点数}) = 512 - 384 = 128 \\text{ 个采样点}\n$$\n\n设 $K$ 为数据段的总数。第一个数据段从采样点索引 0 开始。第二个数据段从索引 $S$ 开始，第三个从 $2S$ 开始，依此类推。第 $k$ 个数据段（其中 $k$ 是从 1 到 $K$ 的整数）从采样点索引 $(k-1)S$ 开始。\n\n一个数据段要有效，它必须完全包含在信号的总长度 $N$ 内。第 $k$ 个数据段的最后一个采样点索引为 $(k-1)S + L - 1$。此索引必须小于 $N$。\n$$\n(k-1)S + L - 1 < N\n$$\n一个更直接的确保整个数据段被包含在内的方法是，声明数据段的起始位置加上其长度不能超过总采样点数：\n$$\n(k-1)S + L \\le N\n$$\n\n我们想要找到满足此条件的最大整数 $k$（这将是我们的数据段总数 $K$）。\n$$\n(K-1)S \\le N - L\n$$\n$$\nK - 1 \\le \\frac{N - L}{S}\n$$\n由于 $K-1$ 必须是整数，我们对右侧取底（向下取整）以找到 $K-1$ 的最大可能值。\n$$\nK - 1 = \\left\\lfloor \\frac{N - L}{S} \\right\\rfloor\n$$\n因此，数据段的总数 $K$ 为：\n$$\nK = \\left\\lfloor \\frac{N - L}{S} \\right\\rfloor + 1\n$$\n\n现在，我们将给定的数值代入此公式：\n$$\nK = \\left\\lfloor \\frac{8192 - 512}{128} \\right\\rfloor + 1\n$$\n$$\nK = \\left\\lfloor \\frac{7680}{128} \\right\\rfloor + 1\n$$\n进行除法运算：\n$$\n\\frac{7680}{128} = 60\n$$\n所以，我们得到：\n$$\nK = \\lfloor 60 \\rfloor + 1 = 60 + 1 = 61\n$$\n\n因此，总共创建了 61 个数据段用于分析。", "answer": "$$\\boxed{61}$$", "id": "1773288"}, {"introduction": "在信号分割之后，最重要的参数选择是段长度 $L$。这个选择是谱估计中一个核心权衡的体现：频率分辨率与估计方差之间的平衡。本练习通过一个定性分析，帮助你直观理解段长度如何影响谱图的外观，让你学会从谱图的平滑度和谱峰的锐度来反推所使用的参数。[@problem_id:1773291]", "problem": "一位工程师的任务是分析一个离散时间信号 $x[n]$，已知该信号是两个不同的正弦分量与加性白噪声之和。为了估计信号的频率成分，该工程师使用韦尔奇（Welch）方法计算其功率谱密度（PSD）。从完全相同的信号 $x[n]$ 生成了两个独立的估计，分别标记为估计A和估计B。\n\n两次计算之间唯一改变的参数是韦尔奇算法中使用的单个分段的长度。所有其他参数，例如窗函数的选择和分段之间的重叠百分比，都保持相同。\n\n通过比较两个得到的PSD图，得出以下定性观察结果：\n\n*   **估计A：** 图中显示出两个清晰的峰值，但它们非常宽且有些模糊。图的基线，代表本底噪声，非常平滑，几乎没有随机波动。\n*   **估计B：** 图中在两个正弦波的频率处显示出两个极其尖锐且轮廓分明的峰值。然而，整个图，包括本底噪声，看起来呈锯齿状，并且从一个频率仓到下一个频率仓有高度的随机、尖峰状变化。\n\n根据这些描述，用于估计A的分段长度 $L_A$ 和用于估计B的分段长度 $L_B$ 之间是什么关系？\n\nA. $L_A < L_B$\n\nB. $L_A > L_B$\n\nC. $L_A = L_B$\n\nD. 如果不知道总信号长度，则无法确定此关系。\n\nE. 如果不知道所使用的窗函数，则无法确定此关系。", "solution": "韦尔奇（Welch）方法通过对在长度为 $L$ 的分段上计算出的加窗、重叠的周期图进行平均，来估计功率谱密度。设总数据长度为 $N$，重叠为固定比例 $\\rho$（在两个估计中相同），窗函数 $w[n]$ 是固定的。\n\n1) 韦尔奇估计器的定义：\n对于分段索引 $k=0,\\ldots,K-1$，构造\n$$\nX_{k}[m] = \\sum_{n=0}^{L-1} x_{k}[n]\\,w[n]\\exp\\!\\left(-j\\frac{2\\pi mn}{L}\\right),\n$$\n以及每个分段的周期图\n$$\nI_{k}[m] = \\frac{1}{U L}\\,|X_{k}[m]|^{2}, \\quad U = \\frac{1}{L}\\sum_{n=0}^{L-1} w^{2}[n].\n$$\n韦尔奇PSD估计是\n$$\n\\hat{S}[m] = \\frac{1}{K}\\sum_{k=0}^{K-1} I_{k}[m].\n$$\n\n2) 频率分辨率与分段长度的关系：\n谱窗为 $W(\\omega)=\\sum_{n=0}^{L-1} w[n]\\exp(-j\\omega n)$。其主瓣宽度满足\n$$\n\\Delta\\omega_{\\text{ML}} = \\frac{c_{w}}{L},\n$$\n其中 $c_{w}$ 仅取决于所选的窗函数（在两个估计中相同）。因此，更大的 $L$ 会产生更小的 $\\Delta\\omega_{\\text{ML}}$，即更尖锐、分辨率更高的谱峰；更小的 $L$ 则产生更宽的峰。\n\n3) 通过平均实现的方差减小以及对 $L$ 的依赖性：\n在窗函数和重叠固定的情况下，韦尔奇估计器的方差与平均分段的有效数量 $K$ 成反比：\n$$\n\\operatorname{var}\\{\\hat{S}[m]\\} \\propto \\frac{1}{K},\n$$\n该比例关系中的常数仅取决于窗函数和重叠（在此均固定）。对于固定的 $N$ 和重叠比例 $\\rho$，增加 $L$ 会减少 $K$（能放入 $N$ 中的分段更少），而减少 $L$ 会增加 $K$（分段更多）。因此，更大的 $L$ 意味着更“锯齿状”的PSD（更高方差），而更小的 $L$ 意味着更平滑的PSD（更低方差）。\n\n4) 将观察结果与 $L$ 对应：\n- 估计A：宽而模糊的峰（分辨率差）和非常平滑的本底噪声（低方差）意味着小的 $L$ 和大的 $K$。\n- 估计B：极其尖锐的峰（分辨率好）和锯齿状、尖峰状的本底噪声（高方差）意味着大的 $L$ 和小的 $K$。\n\n因此，分段长度满足\n$$\nL_{A} < L_{B}.\n$$\n这个结论仅取决于在窗函数和重叠固定的条件下，$L$ 如何影响分辨率和方差；它不需要知道总长度 $N$ 或具体的窗函数（除了知道它们在两次估计中是相同的）。\n\n因此，正确选项是A。", "answer": "$$\\boxed{A}$$", "id": "1773291"}, {"introduction": "韦尔奇方法的核心在于对各段频谱进行“平均”，但我们究竟在平均什么？本练习探讨了两种不同的平均策略：“非相干平均”（平均功率谱）与“相干平均”（平均复数谱）。通过对比这两种方法，你将深刻理解为何韦尔奇方法选择平均功率而非复数值，这揭示了该方法作为一种统计估计工具的本质。[@problem_id:1773260]", "problem": "一位工程师正在开发一种自定义信号处理程序，用于估计平稳随机信号的功率谱密度（PSD）。标准方法，即Welch方法，包括将信号分成若干段，计算每段的离散傅里叶变换（DFT），然后对这些DFT的幅值平方进行平均。\n\n该工程师决定研究一种替代程序。将长的输入信号分成 $L$ 个长度相等的不重叠段。对每一段计算DFT，得到每个离散频率点 $k$ 的一组复数值谱 $\\{X_1[k], X_2[k], \\dots, X_L[k]\\}$。\n\n为获得特定频率点 $k$ 的最终PSD估计值，提出了两种不同的平均程序：\n\n程序A（标准非相干平均）：估计值 $P_A[k]$ 是通过对各个DFT的功率（幅值平方）进行平均计算得出的。\n$$P_A[k] = \\frac{1}{L} \\sum_{i=1}^{L} |X_i[k]|^2$$\n\n程序B（替代相干平均）：估计值 $P_B[k]$ 是通过先对复数DFT结果进行平均，然后计算该平均值的幅值平方得出的。\n$$P_B[k] = \\left| \\frac{1}{L} \\sum_{i=1}^{L} X_i[k] \\right|^2$$\n\n为分析这些估计器的性能，假设基础信号是一个零均值、宽义平稳的随机过程。这意味着对于任何给定的频率点 $k$（不对应直流分量），不同段 $i = 1, \\dots, L$ 的复数DFT系数 $X_i[k]$ 可以被建模为期望值为零的独立同分布（i.i.d.）复随机变量，即 $E[X_i[k]] = 0$。\n\n确定程序B所得估计值的期望值与程序A所得估计值的期望值之比的理论值。即，求 $\\frac{E[P_B[k]]}{E[P_A[k]]}$ 的表达式。", "solution": "目标是计算比率 $\\frac{E[P_B[k]]}{E[P_A[k]]}$。我们将分别计算每个估计器 $P_A[k]$ 和 $P_B[k]$ 的期望值。\n\n首先，我们分析程序A，即标准非相干平均。其估计器由下式给出：\n$$P_A[k] = \\frac{1}{L} \\sum_{i=1}^{L} |X_i[k]|^2$$\n我们对这个表达式求期望值。根据期望算子的线性性质，我们可以将其移入求和号内：\n$$E[P_A[k]] = E\\left[ \\frac{1}{L} \\sum_{i=1}^{L} |X_i[k]|^2 \\right] = \\frac{1}{L} \\sum_{i=1}^{L} E[|X_i[k]|^2]$$\n问题陈述中说明，对于 $i=1, \\dots, L$，复数DFT系数 $X_i[k]$ 是独立同分布的（i.i.d.）。这意味着期望幅值平方 $E[|X_i[k]|^2]$ 对于所有段 $i$ 都是相同的。我们用 $\\sigma_X^2$ 表示这个常数值，它代表信号在频率点 $k$ 的真实功率。\n$$E[|X_1[k]|^2] = E[|X_2[k]|^2] = \\dots = E[|X_L[k]|^2] = \\sigma_X^2$$\n将此代入 $E[P_A[k]]$ 的表达式中：\n$$E[P_A[k]] = \\frac{1}{L} \\sum_{i=1}^{L} \\sigma_X^2 = \\frac{1}{L} (L \\cdot \\sigma_X^2) = \\sigma_X^2$$\n这表明程序A的估计器是真实功率 $\\sigma_X^2$ 的一个无偏估计器。\n\n接下来，我们分析程序B，即替代相干平均。其估计器为：\n$$P_B[k] = \\left| \\frac{1}{L} \\sum_{i=1}^{L} X_i[k] \\right|^2$$\n为了求其期望值 $E[P_B[k]]$，我们使用以下性质：对于任意复随机变量 $Z$，其期望幅值平方与其方差和均值的关系为 $E[|Z|^2] = \\text{Var}(Z) + |E[Z]|^2$。\n我们定义复随机变量 $Z = \\frac{1}{L} \\sum_{i=1}^{L} X_i[k]$。那么 $P_B[k] = |Z|^2$。\n我们首先计算 $Z$ 的均值：\n$$E[Z] = E\\left[ \\frac{1}{L} \\sum_{i=1}^{L} X_i[k] \\right] = \\frac{1}{L} \\sum_{i=1}^{L} E[X_i[k]]$$\n问题陈述中说明该过程是零均值的，因此对于所有 $i$ 都有 $E[X_i[k]] = 0$。所以：\n$$E[Z] = \\frac{1}{L} \\sum_{i=1}^{L} 0 = 0$$\n接下来，我们计算 $Z$ 的方差。由于 $X_i[k]$ 是独立的，它们的和的方差等于它们方差的和。\n$$\\text{Var}(Z) = \\text{Var}\\left( \\frac{1}{L} \\sum_{i=1}^{L} X_i[k] \\right) = \\frac{1}{L^2} \\text{Var}\\left( \\sum_{i=1}^{L} X_i[k] \\right) = \\frac{1}{L^2} \\sum_{i=1}^{L} \\text{Var}(X_i[k])$$\n单个复随机变量 $X_i[k]$ 的方差由 $\\text{Var}(X_i[k]) = E[|X_i[k]|^2] - |E[X_i[k]]|^2$ 给出。由于 $E[X_i[k]] = 0$，这可以简化为：\n$$\\text{Var}(X_i[k]) = E[|X_i[k]|^2] - 0 = \\sigma_X^2$$\n由于这些变量是独立同分布的，所以所有 $i$ 的方差都相同。将此代回 $\\text{Var}(Z)$ 的表达式中：\n$$\\text{Var}(Z) = \\frac{1}{L^2} \\sum_{i=1}^{L} \\sigma_X^2 = \\frac{1}{L^2} (L \\cdot \\sigma_X^2) = \\frac{\\sigma_X^2}{L}$$\n现在我们可以计算 $P_B[k]$ 的期望值：\n$$E[P_B[k]] = E[|Z|^2] = \\text{Var}(Z) + |E[Z]|^2 = \\frac{\\sigma_X^2}{L} + |0|^2 = \\frac{\\sigma_X^2}{L}$$\n这表明程序B的估计值的期望值是有偏的，并且比真实功率小一个因子 $L$。\n\n最后，我们计算所需比率：\n$$\\frac{E[P_B[k]]}{E[P_A[k]]} = \\frac{\\sigma_X^2 / L}{\\sigma_X^2} = \\frac{1}{L}$$\n该比率表明，在求幅值平方之前对复数DFT进行相干平均，会使期望功率估计值减小一个因子，该因子等于分段数 $L$。这是因为来自不同段的DFT系数的随机相位在平均过程中倾向于相互抵消。", "answer": "$$\\boxed{\\frac{1}{L}}$$", "id": "1773260"}]}