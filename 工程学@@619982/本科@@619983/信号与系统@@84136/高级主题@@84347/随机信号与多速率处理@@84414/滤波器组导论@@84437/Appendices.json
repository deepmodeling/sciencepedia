{"hands_on_practices": [{"introduction": "在实际应用中，高效地实现滤波器组是一个首要问题。多相分解是实现这一目标的关键技术，它将一个大的滤波器分解成多个更小的、并行的“多相分量”。第一个练习 [@problem_id:1729545] 为您提供了关于这一基本概念的动手实践，要求您对一个简单的有限冲激响应（FIR）滤波器 $H(z)$ 进行 I 型多相分解。", "id": "1729545", "problem": "在多速率数字信号处理系统（例如双通道分析-综合滤波器组）的设计中，一项基础技术是多相分解。该方法通过将一个滤波器分解为称为多相分量的更小子滤波器，从而更有效地实现该滤波器。\n\n对于一个传递函数为 $H(z)$ 的因果有限冲激响应(FIR)滤波器，其用于双通道系统的I型多相分解由以下恒等式定义：\n$$H(z) = E_0(z^2) + z^{-1}E_1(z^2)$$\n其中 $E_0(z)$ 和 $E_1(z)$ 是两个多相分量滤波器。\n\n给定一个传递函数为 $H(z) = 1 + 2z^{-1} + 3z^{-2}$ 的简单低通FIR滤波器，求其两个I型多相分量 $E_0(z)$ 和 $E_1(z)$ 的传递函数。", "solution": "给定因果FIR滤波器的传递函数为 $H(z) = 1 + 2z^{-1} + 3z^{-2}$。将 $H(z)$ 写成一般求和形式 $H(z) = \\sum_{n=0}^{2} h[n] z^{-n}$，可得到系数 $h[0] = 1$、$h[1] = 2$ 和 $h[2] = 3$。\n\n对于双通道I型多相分解，其恒等式为\n$$\nH(z) = E_{0}(z^{2}) + z^{-1} E_{1}(z^{2}),\n$$\n其中多相分量定义为\n$$\nE_{0}(z) = \\sum_{k=0}^{\\infty} h[2k] z^{-k}, \\quad E_{1}(z) = \\sum_{k=0}^{\\infty} h[2k+1] z^{-k}.\n$$\n\n使用偶数索引系数计算 $E_{0}(z)$：\n$$\nE_{0}(z) = h[0] + h[2] z^{-1} = 1 + 3 z^{-1}.\n$$\n\n使用奇数索引系数计算 $E_{1}(z)$：\n$$\nE_{1}(z) = h[1] = 2.\n$$\n\n验证分解结果：\n$$\nE_{0}(z^{2}) + z^{-1} E_{1}(z^{2}) = \\left(1 + 3 z^{-2}\\right) + z^{-1} \\cdot 2 = 1 + 2 z^{-1} + 3 z^{-2} = H(z),\n$$\n这与给定的 $H(z)$ 相匹配，从而证实了所得多相分量的正确性。", "answer": "$$\\boxed{\\begin{pmatrix}1 + 3 z^{-1} & 2\\end{pmatrix}}$$"}, {"introduction": "在理解了如何分解单个滤波器之后，我们现在将滤波器组作为一个完整的系统来考虑。一个常见的设计目标是实现“完美重构”（Perfect Reconstruction, PR），这意味着信号在被分解和重组后能够被完美地恢复。这个练习 [@problem_id:1729528] 将挑战您通过寻找合适的合成滤波器 $F_0(z)$ 和 $F_1(z)$ 来设计一个 PR 系统，从而揭示消除混叠和失真的核心代数条件。", "id": "1729528", "problem": "考虑一个双通道、临界采样的滤波器组。一个输入信号 $x[n]$ 通过两个分析滤波器 $H_0(z)$ 和 $H_1(z)$。每个滤波器的输出接着以2为因子进行下采样。这两个下采样后的信号随后被以2为因子进行上采样，并分别通过两个合成滤波器 $F_0(z)$ 和 $F_1(z)$。合成滤波器的输出相加以产生重构信号 $\\hat{x}[n]$。\n\n如果输出是输入的缩放和延迟版本，即对于某个非零常数增益 $c$ 和非负整数延迟 $d$，有 $\\hat{x}[n] = c x[n-d]$，则称该系统实现了完美重构。\n\n假设分析滤波器的Z变换由 $H_0(z) = 1$ 和 $H_1(z) = z^{-1}$ 给出。确定能够实现单位增益（$c=1$）和最小可能非负整数延迟 $d$ 的完美重构的因果合成滤波器 $F_0(z)$ 和 $F_1(z)$ 的Z变换。\n\n请将您的答案表示为 $\\begin{pmatrix} F_0(z) & F_1(z) \\end{pmatrix}$ 形式的行矩阵。", "solution": "定义分析滤波器的Z变换为 $H_{0}(z)=1$ 和 $H_{1}(z)=z^{-1}$。在一个双通道、2倍抽取和2倍内插的滤波器组中，重构信号 $\\hat{X}(z)$ 在 $z$ 域中可以表示为（使用标准的贵族恒等式和混叠分量分解）：\n$$\n\\hat{X}(z)=\\frac{1}{2}\\left[F_{0}(z)H_{0}(z)+F_{1}(z)H_{1}(z)\\right]X(z)+\\frac{1}{2}\\left[F_{0}(z)H_{0}(-z)+F_{1}(z)H_{1}(-z)\\right]X(-z).\n$$\n具有单位增益和延迟 $d$ 的完美重构要求混叠项消失，且失真项等于 $z^{-d}$，即\n$$\n\\frac{1}{2}\\left[F_{0}(z)H_{0}(z)+F_{1}(z)H_{1}(z)\\right]=z^{-d},\\qquad \\frac{1}{2}\\left[F_{0}(z)H_{0}(-z)+F_{1}(z)H_{1}(-z)\\right]=0.\n$$\n等价地，\n$$\nF_{0}(z)H_{0}(z)+F_{1}(z)H_{1}(z)=2z^{-d},\\qquad F_{0}(z)H_{0}(-z)+F_{1}(z)H_{1}(-z)=0.\n$$\n代入 $H_{0}(z)=1$ 和 $H_{1}(z)=z^{-1}$，并使用 $H_{0}(-z)=1$，$H_{1}(-z)=(-z)^{-1}=-z^{-1}$，得到以下线性系统：\n$$\nF_{0}(z)+z^{-1}F_{1}(z)=2z^{-d},\\qquad F_{0}(z)-z^{-1}F_{1}(z)=0.\n$$\n由第二个方程可得，\n$$\nF_{0}(z)=z^{-1}F_{1}(z).\n$$\n将此结果代入第一个方程：\n$$\nz^{-1}F_{1}(z)+z^{-1}F_{1}(z)=2z^{-d}\\quad\\Rightarrow\\quad 2z^{-1}F_{1}(z)=2z^{-d}\\quad\\Rightarrow\\quad F_{1}(z)=z^{-(d-1)}.\n$$\n因此，\n$$\nF_{0}(z)=z^{-1}F_{1}(z)=z^{-1}z^{-(d-1)}=z^{-d}.\n$$\n为保证因果性，$F_{0}(z)$ 和 $F_{1}(z)$ 都必须是具有非负延迟的可实现系统，即它们必须是 $z^{-1}$ 的多项式，且不含 $z$ 的正次幂。这里，$F_{0}(z)=z^{-d}$ 对任意 $d\\geq 0$ 都是因果的，而 $F_{1}(z)=z^{-(d-1)}$ 是因果的当且仅当 $d-1\\geq 0$，即 $d\\geq 1$。因此，最小的非负整数延迟为 $d=1$，这得出：\n$$\nF_{0}(z)=z^{-1},\\qquad F_{1}(z)=1.\n$$\n通过这些选择，混叠项为零，失真项在单位增益下等于 $z^{-1}$，因此 $\\hat{x}[n]=x[n-1]$。", "answer": "$$\\boxed{\\begin{pmatrix} z^{-1} & 1 \\end{pmatrix}}$$"}, {"introduction": "对一个系统真正的理解，不仅在于知道它如何正常工作，还在于明白当它出错时会发生什么。最后一个练习 [@problem_id:1729559] 提出了一个思想实验：如果一个完美重构系统中的合成滤波器被意外交换，将会发生什么？通过分析这个错误，您将能更深刻地体会到消除混叠所需的精妙平衡，并亲眼看到该条件失效所带来的后果，即输出信号 $\\hat{X}_{swap}(z)$ 与输入信号的频谱镜像版本 $X(-z)$ 之间的关系。", "id": "1729559", "problem": "考虑一个为完美重构（PR）设计的双通道、最大抽取滤波器组。分析级由一个传递函数为 $H_0(z)$ 的低通滤波器和一个传递函数为 $H_1(z)$ 的高通滤波器组成。综合级由传递函数为 $G_0(z)$ 和 $G_1(z)$ 的滤波器组成。该系统的配置是，输入信号 $x[n]$ 首先由 $H_0(z)$ 和 $H_1(z)$ 滤波，然后各自经过一个因子为 2 的下采样器。得到的信号随后经过一个因子为 2 的上采样器，分别由 $G_0(z)$ 和 $G_1(z)$ 滤波，然后相加产生重构信号 $\\hat{x}[n]$。\n\n对于这个特定的完美重构系统，滤波器之间的关系如下：\n1.  高通分析滤波器：$H_1(z) = H_0(-z)$\n2.  低通综合滤波器：$G_0(z) = H_1(-z)$\n3.  高通综合滤波器：$G_1(z) = -H_0(-z)$\n\n低通原型滤波器 $H_0(z)$ 的设计使得原始系统的总传递函数是一个纯延迟，即 $\\hat{X}(z) = z^{-d} X(z)$。这意味着滤波器 $H_0(z)$ 满足条件 $\\frac{1}{2} \\left[ H_0(z)^2 - H_0(-z)^2 \\right] = z^{-d}$，其中 $d$ 为某个整数延迟。\n\n现在，假设在实现过程中出现了一个错误，综合滤波器被互换了。上采样后的低通支路由 $G_1(z)$ 滤波，而上采样后的高通支路由 $G_0(z)$ 滤波。\n\n在这种互换配置下，确定重构信号的 Z 变换 $\\hat{X}_{swap}(z)$。将你的答案表示为关于输入信号的 Z 变换 $X(z)$ 和系统延迟 $d$ 的闭式解析表达式。", "solution": "设分析输出为 $Y_{0}(z)=H_{0}(z)X(z)$ 和 $Y_{1}(z)=H_{1}(z)X(z)$。对于 $v[n]=u[2n]$，2倍下采样的Z变换为 $V(z)=\\frac{1}{2}\\left[U(z^{1/2})+U(-z^{1/2})\\right]$，而对于作为 $v[n]$ 的2倍上采样版本的 $u[n]$，2倍上采样的Z变换为 $U(z)=V(z^{2})$。因此，经过下采样和上采样后，支路信号变为\n$$W_{0}(z)=\\frac{1}{2}\\left[Y_{0}(z)+Y_{0}(-z)\\right],\\qquad W_{1}(z)=\\frac{1}{2}\\left[Y_{1}(z)+Y_{1}(-z)\\right].$$\n应用综合滤波器并求和后，正确连接的系统得到\n$$\\hat{X}(z)=\\frac{1}{2}\\left[G_{0}(z)Y_{0}(z)+G_{1}(z)Y_{1}(z)\\right]+\\frac{1}{2}\\left[G_{0}(z)Y_{0}(-z)+G_{1}(z)Y_{1}(-z)\\right],$$\n使用 $Y_{0}(z)=H_{0}(z)X(z)$ 和 $Y_{1}(z)=H_{1}(z)X(z)$，上式变为\n$$\\hat{X}(z)=\\frac{1}{2}\\left[G_{0}(z)H_{0}(z)+G_{1}(z)H_{1}(z)\\right]X(z)+\\frac{1}{2}\\left[G_{0}(z)H_{0}(-z)+G_{1}(z)H_{1}(-z)\\right]X(-z).$$\n在互换配置中，上采样的低通支路由 $G_{1}(z)$ 滤波，上采样的高通支路由 $G_{0}(z)$ 滤波，因此\n$$\\hat{X}_{swap}(z)=\\frac{1}{2}\\left[G_{1}(z)H_{0}(z)+G_{0}(z)H_{1}(z)\\right]X(z)+\\frac{1}{2}\\left[G_{1}(z)H_{0}(-z)+G_{0}(z)H_{1}(-z)\\right]X(-z).$$\n使用给定的关系式 $H_{1}(z)=H_{0}(-z)$，$G_{0}(z)=H_{1}(-z)=H_{0}(z)$ 和 $G_{1}(z)=-H_{0}(-z)$，系数可简化如下：\n$$G_{1}(z)H_{0}(z)+G_{0}(z)H_{1}(z)=-H_{0}(-z)H_{0}(z)+H_{0}(z)H_{0}(-z)=0,$$\n$$G_{1}(z)H_{0}(-z)+G_{0}(z)H_{1}(-z)=-H_{0}(-z)^{2}+H_{0}(z)^{2}=H_{0}(z)^{2}-H_{0}(-z)^{2}.$$\n因此\n$$\\hat{X}_{swap}(z)=\\frac{1}{2}\\left[H_{0}(z)^{2}-H_{0}(-z)^{2}\\right]X(-z).$$\n根据完美重构条件 $\\frac{1}{2}\\left[H_{0}(z)^{2}-H_{0}(-z)^{2}\\right]=z^{-d}$，我们得到\n$$\\hat{X}_{swap}(z)=z^{-d}X(-z).$$\n这是一个施加于输入的谱折叠版本上的纯延迟。", "answer": "$$\\boxed{z^{-d}X(-z)}$$"}]}