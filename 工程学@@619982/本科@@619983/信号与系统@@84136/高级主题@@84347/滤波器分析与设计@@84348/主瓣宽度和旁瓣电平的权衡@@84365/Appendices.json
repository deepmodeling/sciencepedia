{"hands_on_practices": [{"introduction": "要真正掌握主瓣宽度和旁瓣电平之间的权衡，最好的方法是从定量比较基本的窗函数开始。本练习将引导您分析两个最基础的窗函数：矩形窗和三角窗。通过计算它们各自的主瓣宽度和峰值旁瓣电平，您将能够直接观察到频率分辨率（由主瓣宽度决定）与频谱泄漏抑制（由旁瓣电平反映）之间的根本性妥协。 [@problem_id:1736404]", "problem": "在信号处理中，对一个数据块应用“窗函数”是在进行傅里叶变换之前的一个关键步骤。这样做是为了减轻频谱泄漏，这是一种信号在某一频率的能量“泄漏”到其他频率箱中的效应。不同的窗函数在解析相近频率分量和抑制这种泄漏之间提供了不同的权衡。\n\n本问题要求您定量分析两种基本窗函数之间的权衡：矩形窗和三角窗（或 Bartlett 窗）。两者均被定义为仅在区间 $|t| \\le \\frac{T}{2}$ 上为非零。\n\n1.  **矩形窗：** 当 $|t| \\le \\frac{T}{2}$ 时，$w_R(t) = 1$，其他情况下 $w_R(t) = 0$。\n2.  **三角窗：** 当 $|t| \\le \\frac{T}{2}$ 时，$w_T(t) = 1 - \\frac{2|t|}{T}$，其他情况下 $w_T(t) = 0$。\n\n这些窗的频谱特性由其傅里叶变换 $W(f) = \\int_{-\\infty}^{\\infty} w(t) \\exp(-j 2\\pi f t) dt$ 决定。在您的计算中，请使用归一化 sinc 函数，其定义为 $\\text{sinc}(x) = \\frac{\\sin(\\pi x)}{\\pi x}$。\n\n我们将使用以下两个指标来评估这些窗的性能：\n\n*   **主瓣宽度：** 频谱中中心峰值的宽度，定义为在 $f=0$ 处主峰两侧的前两个零点之间的频率距离（单位为赫兹）。\n*   **峰值旁瓣电平 (PSL)：** 衡量最大旁瓣相对于主瓣强度的指标。为解决本问题，我们将通过计算频谱在离中心 ($f=0$) 的第一个和第二个零点之间的频率中点处的幅度 $|W(f)|$ 来近似第一个旁瓣的峰值幅度。PSL 是这个近似的旁瓣峰值幅度与主瓣峰值幅度 $|W(0)|$ 的比率。\n\n您的任务是计算以下两个无量纲比率：\n\nA. 三角窗频谱的主瓣宽度与矩形窗频谱的主瓣宽度的比率，$\\frac{\\text{Width}_T}{\\text{Width}_R}$。\nB. 三角窗频谱的峰值旁瓣电平与矩形窗频谱的峰值旁瓣电平的比率，$\\frac{\\text{PSL}_T}{\\text{PSL}_R}$。\n\n请将您的最终答案表示为 $(\\frac{\\text{Width}_T}{\\text{Width}_R}, \\frac{\\text{PSL}_T}{\\text{PSL}_R})$ 的解析表达式有序对。", "solution": "将傅里叶变换定义为 $W(f)=\\int_{-\\infty}^{\\infty} w(t)\\exp(-j2\\pi f t)\\,dt$，归一化 sinc 函数定义为 $\\text{sinc}(x)=\\frac{\\sin(\\pi x)}{\\pi x}$。\n\n对于矩形窗 $w_{R}(t)=1$（当 $|t|\\leq T/2$ 时）及 $0$（其他情况），计算\n$$\nW_{R}(f)=\\int_{-T/2}^{T/2}\\exp(-j2\\pi f t)\\,dt\n=\\left.\\frac{\\exp(-j2\\pi f t)}{-j2\\pi f}\\right|_{-T/2}^{T/2}\n=\\frac{\\exp(-j\\pi f T)-\\exp(j\\pi f T)}{-j2\\pi f}\n=T\\,\\text{sinc}(fT).\n$$\n当 $f\\neq 0$ 时，零点出现在 $\\sin(\\pi fT)=0$ 的地方，即 $f=\\pm\\frac{1}{T},\\pm\\frac{2}{T},\\ldots$。因此主瓣宽度（$f=0$ 附近前两个零点之间的距离）是\n$$\n\\text{Width}_{R}=\\frac{1}{T}-\\left(-\\frac{1}{T}\\right)=\\frac{2}{T}.\n$$\n主瓣峰值为 $|W_{R}(0)|=\\int_{-T/2}^{T/2}1\\,dt=T$。第一个和第二个零点分别位于 $f=\\frac{1}{T}$ 和 $f=\\frac{2}{T}$，所以它们的中点是 $f=\\frac{3}{2T}$。在此中点处的近似旁瓣幅度为\n$$\n|W_{R}(\\tfrac{3}{2T})|=T\\,\\left|\\text{sinc}\\!\\left(\\tfrac{3}{2}\\right)\\right|,\n$$\n所以矩形窗的 PSL 是\n$$\n\\text{PSL}_{R}=\\frac{|W_{R}(\\tfrac{3}{2T})|}{|W_{R}(0)|}=\\left|\\text{sinc}\\!\\left(\\tfrac{3}{2}\\right)\\right|\n=\\left|\\frac{\\sin(\\tfrac{3}{2}\\pi)}{\\tfrac{3}{2}\\pi}\\right|\n=\\frac{2}{3\\pi}.\n$$\n\n对于三角窗 $w_{T}(t)=1-\\frac{2|t|}{T}$（当 $|t|\\leq T/2$ 时）及 $0$（其他情况），注意到 $w_{T}(t)=\\text{tri}\\left(\\frac{2t}{T}\\right)$，并使用卷积恒等式 $\\text{tri}(x)=(\\text{rect}*\\text{rect})(x)$。令 $u(t)=\\text{rect}\\left(\\frac{2t}{T}\\right)$，则 $w_{T}(t)=\\frac{2}{T}(u*u)(t)$。根据卷积定理，\n$$\nW_{T}(f)=\\frac{2}{T}\\,U(f)^{2},\\quad U(f)=\\int u(t)\\exp(-j2\\pi f t)\\,dt=\\frac{T}{2}\\,\\text{sinc}\\!\\left(\\frac{fT}{2}\\right).\n$$\n因此，\n$$\nW_{T}(f)=\\frac{2}{T}\\left(\\frac{T}{2}\\,\\text{sinc}\\!\\left(\\frac{fT}{2}\\right)\\right)^{2}\n=\\frac{T}{2}\\,\\text{sinc}^{2}\\!\\left(\\frac{fT}{2}\\right).\n$$\n当 $\\text{sinc}\\!\\left(\\frac{fT}{2}\\right)=0$ 时出现零点，即在 $\\frac{fT}{2}=\\pm 1,\\pm 2,\\ldots$ 处，所以前两个零点位于 $f=\\pm\\frac{2}{T}$。因此主瓣宽度是\n$$\n\\text{Width}_{T}=\\frac{2}{T}-\\left(-\\frac{2}{T}\\right)=\\frac{4}{T}.\n$$\n由此，主瓣宽度比为\n$$\n\\frac{\\text{Width}_{T}}{\\text{Width}_{R}}=\\frac{\\frac{4}{T}}{\\frac{2}{T}}=2.\n$$\n主瓣峰值为 $|W_{T}(0)|=\\int_{-T/2}^{T/2}\\left(1-\\frac{2|t|}{T}\\right)\\,dt=\\frac{T}{2}$，这也可从 $W_{T}(0)=\\frac{T}{2}\\,\\text{sinc}^{2}(0)=\\frac{T}{2}$ 得出。对于 PSL，第一个和第二个零点位于 $f=\\frac{2}{T}$ 和 $f=\\frac{4}{T}$，其中点为 $f=\\frac{3}{T}$。那么近似旁瓣幅度为\n$$\n|W_{T}(\\tfrac{3}{T})|=\\frac{T}{2}\\,\\left|\\text{sinc}\\!\\left(\\tfrac{3}{2}\\right)\\right|^{2},\n$$\n所以\n$$\n\\text{PSL}_{T}=\\frac{|W_{T}(\\tfrac{3}{T})|}{|W_{T}(0)|}=\\left|\\text{sinc}\\!\\left(\\tfrac{3}{2}\\right)\\right|^{2}\n=\\left(\\frac{2}{3\\pi}\\right)^{2}.\n$$\n因此 PSL 的比值为\n$$\n\\frac{\\text{PSL}_{T}}{\\text{PSL}_{R}}=\\frac{\\left(\\frac{2}{3\\pi}\\right)^{2}}{\\frac{2}{3\\pi}}=\\frac{2}{3\\pi}.\n$$\n\n所求的有序对为 $\\left(\\frac{\\text{Width}_{T}}{\\text{Width}_{R}},\\frac{\\text{PSL}_{T}}{\\text{PSL}_{R}}\\right)=\\left(2,\\frac{2}{3\\pi}\\right)$。", "answer": "$$\\boxed{\\left(2, \\frac{2}{3\\pi}\\right)}$$", "id": "1736404"}, {"introduction": "在我们理解了理论上的权衡之后，下一步是将其应用于一个实际的工程场景。在现实世界的应用中，例如监测精密机械的振动，区分两个非常接近的频率分量的能力至关重要。本实践将抽象的主瓣宽度概念与一个具体可衡量的性能指标——频率分辨率——联系起来，展示了窗函数的选择和观测时长如何直接影响我们在信号频谱中能够“看到”的细节。 [@problem_id:1736446]", "problem": "一个信号处理器用于分析一台精密铣床的振动数据。数据在总计 $T = 400$ ms 的观测时间内收集。为减少频谱泄漏，在进行傅里叶变换之前，采集到的数据段会乘以一个三角窗函数 $w(t)$。该三角窗定义为：当 $|t| \\le T/2$ 时，$w(t) = 1 - \\frac{2|t|}{T}$，其他情况下 $w(t)=0$。如果一个振动模式的频谱响应峰值与另一个模式的频谱响应的第一个零点（零交叉点）重合，则认为这两个振幅相近的独立振动模式在频率上恰好可分辨。确定该系统可以分辨的这两个模式之间的最小频率间隔。结果以赫兹（Hz）为单位表示，并四舍五入到三位有效数字。", "solution": "问题要求计算使用时长为 $T$ 的三角窗的系统所能达到的最小可分辨频率间隔 $\\Delta f_{\\text{min}}$。其分辨率判据为瑞利判据：当一个频谱峰的峰值落在另一个频谱峰的第一个最小值处时，认为这两个频谱峰是可分辨的。\n\n当一个包含正弦波的信号与窗函数 $w(t)$ 相乘时，其频谱是正弦波频谱（冲激函数）与窗函数傅里叶变换 $W(f)$ 的卷积。这意味着每个正弦分量的频谱都将具有 $W(f)$ 的形状。因此，为了找到最小可分辨频率间隔，我们需要找到 $W(f)$ 的第一个零点相对于其在 $f=0$ 处的峰值的频率。\n\n首先，我们计算三角窗函数 $w(t)$ 的傅里叶变换。\n该窗函数定义为：当 $|t| \\le T/2$ 时，$w(t) = 1 - \\frac{2|t|}{T}$，其他情况下为 $0$。\n傅里叶变换 $W(f)$ 由下式给出：\n$$W(f) = \\int_{-\\infty}^{\\infty} w(t) e^{-i 2\\pi f t} dt = \\int_{-T/2}^{T/2} \\left(1 - \\frac{2|t|}{T}\\right) e^{-i 2\\pi f t} dt$$\n由于 $w(t)$ 是实偶函数，其变换 $W(f)$ 也将是实偶函数。我们可以简化积分为：\n$$W(f) = 2 \\int_{0}^{T/2} \\left(1 - \\frac{2t}{T}\\right) \\cos(2\\pi f t) dt$$\n我们可以使用分部积分法 $\\int u \\, dv = uv - \\int v \\, du$ 来求解此积分。\n令 $u = 1 - \\frac{2t}{T}$ 且 $dv = \\cos(2\\pi f t) dt$。\n则 $du = -\\frac{2}{T} dt$ 且 $v = \\frac{\\sin(2\\pi f t)}{2\\pi f}$。\n积分为：\n$$ \\int \\left(1 - \\frac{2t}{T}\\right) \\cos(2\\pi f t) dt = \\left(1 - \\frac{2t}{T}\\right) \\frac{\\sin(2\\pi f t)}{2\\pi f} - \\int \\frac{\\sin(2\\pi f t)}{2\\pi f} \\left(-\\frac{2}{T}\\right) dt $$\n$$ = \\left(1 - \\frac{2t}{T}\\right) \\frac{\\sin(2\\pi f t)}{2\\pi f} + \\frac{2}{T(2\\pi f)} \\int \\sin(2\\pi f t) dt $$\n$$ = \\left(1 - \\frac{2t}{T}\\right) \\frac{\\sin(2\\pi f t)}{2\\pi f} - \\frac{2}{T(2\\pi f)^2} \\cos(2\\pi f t) $$\n现在，我们在 $t=0$ 到 $t=T/2$ 的区间上计算这个表达式的值：\n$$ \\left[ \\left(1 - \\frac{2t}{T}\\right) \\frac{\\sin(2\\pi f t)}{2\\pi f} - \\frac{2 \\cos(2\\pi f t)}{T(2\\pi f)^2} \\right]_{0}^{T/2} $$\n在上限 $t=T/2$ 处：\n$$ \\left(1 - \\frac{2(T/2)}{T}\\right) \\frac{\\sin(\\pi f T)}{2\\pi f} - \\frac{2 \\cos(\\pi f T)}{T(2\\pi f)^2} = 0 - \\frac{2 \\cos(\\pi f T)}{4T\\pi^2 f^2} = -\\frac{\\cos(\\pi f T)}{2T\\pi^2 f^2} $$\n在下限 $t=0$ 处：\n$$ \\left(1 - 0\\right) \\frac{\\sin(0)}{2\\pi f} - \\frac{2 \\cos(0)}{T(2\\pi f)^2} = 0 - \\frac{2}{4T\\pi^2 f^2} = -\\frac{1}{2T\\pi^2 f^2} $$\n积分的值是（上限值）-（下限值）：\n$$ \\int_{0}^{T/2} \\dots dt = -\\frac{\\cos(\\pi f T)}{2T\\pi^2 f^2} - \\left(-\\frac{1}{2T\\pi^2 f^2}\\right) = \\frac{1 - \\cos(\\pi f T)}{2T\\pi^2 f^2} $$\n现在，我们乘以 $W(f)$ 初始简化时得到的因子 2：\n$$ W(f) = 2 \\cdot \\frac{1 - \\cos(\\pi f T)}{2T\\pi^2 f^2} = \\frac{1 - \\cos(\\pi f T)}{T\\pi^2 f^2} $$\n使用恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$，我们令 $\\theta = \\pi f T$：\n$$ W(f) = \\frac{2\\sin^2(\\pi f T / 2)}{T\\pi^2 f^2} $$\n为了用非归一化sinc函数 $\\text{sinc}(x) = \\sin(x)/x$ 来表示，我们重新整理表达式：\n$$ W(f) = \\frac{T}{2} \\cdot \\frac{4\\sin^2(\\pi f T / 2)}{T^2\\pi^2 f^2} = \\frac{T}{2} \\left( \\frac{\\sin(\\pi f T / 2)}{\\pi f T / 2} \\right)^2 = \\frac{T}{2} \\operatorname{sinc}^2\\left(\\frac{\\pi f T}{2}\\right) $$\n$W(f)$ 的主瓣中心位于 $f=0$。当sinc函数的自变量为 $\\pi$ 的非零整数倍时，出现第一批零点。所以，对于第一个零点，我们将自变量设为 $\\pm \\pi$：\n$$ \\frac{\\pi f_{\\text{null}} T}{2} = \\pm \\pi $$\n求解 $f_{\\text{null}}$ 得：\n$$ f_{\\text{null}} = \\pm \\frac{2}{T} $$\n从 $f=0$ 的中心峰值到第一个零点的距离是 $2/T$。根据问题的分辨率判据，这个距离就是最小可分辨频率间隔 $\\Delta f_{\\text{min}}$。\n$$ \\Delta f_{\\text{min}} = \\frac{2}{T} $$\n给定 $T = 400$ ms，即 $0.400$ s。\n$$ \\Delta f_{\\text{min}} = \\frac{2}{0.400 \\text{ s}} = 5.00 \\text{ Hz} $$\n最小可分辨频率间隔为 5.00 Hz。", "answer": "$$\\boxed{5.00}$$", "id": "1736446"}, {"introduction": "在掌握了分析标准窗函数的方法后，我们可以更进一步，进入自定义设计的领域。在某些高级应用中，预定义的标准窗函数可能无法满足特定的性能要求，例如需要精确抑制已知频率的干扰。这项高级练习将您置于设计工程师的角色，要求您通过在频率响应中策略性地放置零点来创建一个自定义的有限脉冲响应（FIR）窗，以满足特定的频谱整形需求，从而体验对频谱特性的主动控制。 [@problem_id:1736389]", "problem": "一位工程师正在为频谱分析应用设计一个自定义窗。该窗是一个5抽头、对称、零相位的有限脉冲响应（FIR）滤波器，其系数表示为 $w[n]$，其中 $n \\in \\{-2, -1, 0, 1, 2\\}$，且 $w[n] = w[-n]$。为实现特定的干扰抑制，该窗的频率响应，即其离散时间傅里叶变换（DTFT）$W(e^{j\\omega})$，必须在归一化角频率 $\\omega_1 = \\frac{\\pi}{2}$ 弧度/样本 和 $\\omega_2 = \\frac{3\\pi}{4}$ 弧度/样本 处具有零点（nulls）。\n\n该窗的频谱特性是，在 $\\omega=0$ 附近有一个中心主瓣，在较高频率处有一系列较小的旁瓣。主瓣定义为 $\\omega=0$ 附近由第一零点所限定的区域。主瓣峰值电平是频率响应在 $\\omega=0$ 处的幅度。旁瓣峰值电平定义为主瓣区域外频率响应的最大绝对值。\n\n计算该自定义窗的旁瓣峰值电平与主瓣峰值电平之比。将您的答案表示为一个数值，并四舍五入到四位有效数字。", "solution": "对于一个5抽头、对称、零相位的FIR滤波器，其中 $w[n]=w[-n]$ 且支撑域为 $n\\in\\{-2,-1,0,1,2\\}$，其DTFT可以简化为一个实偶余弦级数：\n$$\nW(e^{j\\omega}) = \\sum_{n=-2}^{2}w[n]e^{-j\\omega n} = w[0]+2w[1]\\cos\\omega+2w[2]\\cos 2\\omega.\n$$\n令 $x=\\cos\\omega$。使用 $\\cos 2\\omega=2x^{2}-1$，$W(e^{j\\omega})$ 是一个关于 $x$ 的二次多项式。在 $\\omega_1 = \\frac{\\pi}{2}$ 和 $\\omega_2 = \\frac{3\\pi}{4}$ 处施加条件 $W(e^{j\\omega_1})=0$ 和 $W(e^{j\\omega_2})=0$，其中 $x_1=\\cos\\omega_1=0$ 和 $x_2=\\cos\\omega_2=-\\frac{\\sqrt{2}}{2}$，那么具有这些根的唯一（在非零比例因子 $K$ 的意义下）二次多项式是\n$$\nW(e^{j\\omega}) = K(\\cos\\omega-\\cos\\omega_1)(\\cos\\omega-\\cos\\omega_2) = K\\,\\cos\\omega\\left(\\cos\\omega+\\frac{\\sqrt{2}}{2}\\right).\n$$\n主瓣由 $\\omega=\\pm\\frac{\\pi}{2}$ 处的第一个零点界定。其峰值电平在 $\\omega=0$ 处：\n$$\n|W(e^{j0})| = |K|\\left(\\cos 0\\right)\\left(\\cos 0+\\frac{\\sqrt{2}}{2}\\right) = |K|\\left(1+\\frac{\\sqrt{2}}{2}\\right).\n$$\n在主瓣之外，考虑\n$$\nf(\\omega)=\\cos\\omega\\left(\\cos\\omega+\\frac{\\sqrt{2}}{2}\\right),\n$$\n因此 $W(e^{j\\omega})=K f(\\omega)$。其导数是\n$$\n\\frac{d}{d\\omega}f(\\omega)=-\\sin\\omega\\left(2\\cos\\omega+\\frac{\\sqrt{2}}{2}\\right).\n$$\n在 $\\omega\\in\\left[\\frac{\\pi}{2},\\frac{3\\pi}{4}\\right]$ 上，$\\sin\\omega>0$ 且 $2\\cos\\omega+\\frac{\\sqrt{2}}{2}$ 只变号一次，从而在 $\\cos\\omega=-\\frac{\\sqrt{2}}{4}$ 处产生一个驻点。在该点，\n$$\nf = \\left(-\\frac{\\sqrt{2}}{4}\\right)\\left(-\\frac{\\sqrt{2}}{4}+\\frac{\\sqrt{2}}{2}\\right)=-\\frac{1}{8},\n$$\n因此第一个旁瓣的幅度是 $\\frac{1}{8}|K|$。\n\n在 $\\omega\\in\\left[\\frac{3\\pi}{4},\\pi\\right]$ 上，有 $\\sin\\omega\\geq 0$ 和 $2\\cos\\omega+\\frac{\\sqrt{2}}{2}<0$，因此 $\\frac{d}{d\\omega}f(\\omega)>0$，所以 $f$ 是递增的，在 $\\omega=\\pi$ 处达到其最大值：\n$$\nf(\\pi)=\\cos\\pi\\left(\\cos\\pi+\\frac{\\sqrt{2}}{2}\\right)=(-1)\\left(-1+\\frac{\\sqrt{2}}{2}\\right)=1-\\frac{1}{\\sqrt{2}}.\n$$\n比较 $1-\\frac{1}{\\sqrt{2}}$ 和 $\\frac{1}{8}$，两边同乘以 $8\\sqrt{2}>0$ 得到 $8\\sqrt{2}-8$ 对比 $\\sqrt{2}$，即 $7\\sqrt{2}>8$，这是成立的（两边平方得到 $98>64$）。因此，旁瓣峰值电平是\n$$\n\\text{PSL}=|K|\\left(1-\\frac{1}{\\sqrt{2}}\\right).\n$$\n主瓣峰值电平是\n$$\n\\text{PML}=|K|\\left(1+\\frac{1}{\\sqrt{2}}\\right).\n$$\n因此所求的比率是\n$$\nR=\\frac{\\text{PSL}}{\\text{PML}}=\\frac{1-\\frac{1}{\\sqrt{2}}}{1+\\frac{1}{\\sqrt{2}}}=\\frac{\\sqrt{2}-1}{\\sqrt{2}+1}=(\\sqrt{2}-1)^{2}=3-2\\sqrt{2}.\n$$\n数值上，$R\\approx 0.171572875\\ldots$，四舍五入到四位有效数字为 $0.1716$。", "answer": "$$\\boxed{0.1716}$$", "id": "1736389"}]}