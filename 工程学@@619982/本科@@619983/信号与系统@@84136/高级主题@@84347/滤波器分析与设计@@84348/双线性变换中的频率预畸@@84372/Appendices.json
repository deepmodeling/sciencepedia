{"hands_on_practices": [{"introduction": "在从模拟原型设计数字滤波器的核心任务中，一个关键步骤是精确地设置数字滤波器的临界频率（例如截止频率）。由于双线性变换引入了非线性频率“扭曲”，我们不能直接使用期望的数字频率值。这个练习将指导你完成一个基本但至关重要的计算：为了在最终的数字滤波器中达到一个特定的目标频率，如何计算出模拟原型滤波器所必须使用的“预畸变”频率[@problem_id:1720731]。", "problem": "一位信号处理工程师的任务是为一套高保真音频系统设计一个数字低通滤波器。其设计方法涉及使用双线性变换，将一个特性良好的连续时间（模拟）滤波器原型转换为一个离散时间（数字）滤波器。该音频系统的采样频率 $F_s$ 为 $20.0 \\text{ kHz}$。\n\n主要的设计规范要求，最终得到的数字滤波器的截止频率（通常是-3 dB衰减点）必须精确地位于系统奈奎斯特频率的一半。众所周知，当从连续时间域映射到离散时间域时，双线性变换会引起频率轴的非线性压缩或“畸变”。为了抵消这种效应并达到所期望的数字截止频率，必须对模拟原型的截止频率进行适当的预先调整，这项技术被称为频率预畸变。\n\n计算该模拟滤波器原型必须使用的预畸变截止频率。答案以千赫兹 (kHz) 为单位，并四舍五入到三位有效数字。", "solution": "双线性变换通过以下公式将连续时间角频率 $\\Omega$（单位：弧度/秒）映射到离散时间角频率 $\\omega$（单位：弧度/采样点）：\n$$\n\\omega=2\\arctan\\!\\left(\\frac{\\Omega T}{2}\\right),\n$$\n其中 $T=\\frac{1}{F_{s}}$ 是采样周期。为了将一个期望的数字截止频率预畸变为一个模拟原型的截止频率，求解 $\\Omega$：\n$$\n\\Omega=\\frac{2}{T}\\tan\\!\\left(\\frac{\\omega}{2}\\right)=2F_{s}\\tan\\!\\left(\\frac{\\omega}{2}\\right).\n$$\n规范要求数字截止频率为奈奎斯特频率的一半。奈奎斯特频率为 $\\frac{F_{s}}{2}$，因此期望的数字截止频率（单位：赫兹）为 $f_{d}=\\frac{F_{s}}{4}$。相应的离散时间角频率为\n$$\n\\omega_{c}=\\frac{2\\pi f_{d}}{F_{s}}=\\frac{2\\pi}{F_{s}}\\cdot\\frac{F_{s}}{4}=\\frac{\\pi}{2}.\n$$\n因此，预畸变的模拟角截止频率为\n$$\n\\Omega_{p}=2F_{s}\\tan\\!\\left(\\frac{\\omega_{c}}{2}\\right)=2F_{s}\\tan\\!\\left(\\frac{\\pi}{4}\\right)=2F_{s}.\n$$\n转换为赫兹，$f_{p}=\\frac{\\Omega_{p}}{2\\pi}$，得到\n$$\nf_{p}=\\frac{2F_{s}}{2\\pi}=\\frac{F_{s}}{\\pi}.\n$$\n当 $F_{s}=20.0\\ \\text{kHz}$ 时，可得\n$$\nf_{p}=\\frac{20.0}{\\pi}\\ \\text{kHz}\\approx 6.366\\ \\text{kHz}.\n$$\n四舍五入到三位有效数字，得到 $6.37\\ \\text{kHz}$。", "answer": "$$\\boxed{6.37}$$", "id": "1720731"}, {"introduction": "在学习了如何进行频率预畸变后，理解为何这一步骤不可或缺至关重要。本练习旨在揭示一个常见的误区：如果不进行预畸变，而天真地将模拟频率与数字频率等同，将会产生多大的误差[@problem_id:1720719]。通过亲手量化这个误差，你将更深刻地体会到频率预畸变在确保滤波器性能精确性方面的重要性。", "problem": "在数字滤波器设计中，双线性变换是一种将模拟滤波器设计转换为数字滤波器设计的常用方法。该变换将复s平面的整个 $j\\Omega$ 轴映射到z平面的单位圆 $z = e^{j\\omega}$ 上，但这种映射是非线性的。模拟频率 $\\Omega$（单位：rad/s）与数字频率 $\\omega$（单位：rad/sample）之间的关系由 $\\Omega = \\frac{2}{T} \\tan\\left(\\frac{\\omega}{2}\\right)$ 给出，其中 $T$ 是采样周期，单位为秒。为了补偿这种非线性，通常会使用一种称为频率预畸变的技术。\n\n一位工程师正在基于一个传递函数为 $H_a(s) = \\frac{\\Omega_c}{s + \\Omega_c}$ 的模拟原型设计一个一阶数字低通滤波器，其中 $\\Omega_c$ 是模拟截止频率。设计规范要求最终的数字滤波器在期望的数字频率 $\\omega_d$ 处具有一个3-dB截止频率。3-dB截止频率是指滤波器幅度响应为其直流增益的 $1/\\sqrt{2}$ 倍时的频率；对于给定的 $H_a(s)$，这恰好发生在频率 $\\Omega = \\Omega_c$ 处。\n\n然而，该工程师忽略了应用频率预畸变。相反，他们犯了一个常见的错误，即假设频率值之间存在直接对应关系。他们将原型滤波器中的模拟截止频率 $\\Omega_c$ 设置为在数值上等于期望的数字截止频率 $\\omega_d$。\n\n给定期望的数字截止频率 $\\omega_d = 0.2\\pi$ radians/sample 和采样周期 $T = 0.5$ s，这个错误导致实际的数字截止频率 $\\omega_a$ 与期望的 $\\omega_d$ 不同。计算截止频率的相对误差，其定义为 $\\epsilon = \\frac{\\omega_a - \\omega_d}{\\omega_d}$。\n\n请以四舍五入到三位有效数字的小数值形式给出相对误差 $\\epsilon$ 的答案。", "solution": "双线性变换通过以下关系式映射模拟频率和数字频率：\n$$\n\\Omega=\\frac{2}{T}\\tan\\!\\left(\\frac{\\omega}{2}\\right),\n$$\n因此，给定的模拟频率 $\\Omega$ 对应于数字频率\n$$\n\\omega=2\\,\\arctan\\!\\left(\\frac{\\Omega T}{2}\\right).\n$$\n对于一阶模拟低通原型 $H_{a}(s)=\\frac{\\Omega_{c}}{s+\\Omega_{c}}$，其3-dB截止频率发生在 $\\Omega=\\Omega_{c}$ 处。在没有进行频率预畸变的情况下，工程师设置 $\\Omega_{c}=\\omega_{d}$。因此，经过双线性变换后的实际数字截止频率为\n$$\n\\omega_{a}=2\\,\\arctan\\!\\left(\\frac{\\Omega_{c}T}{2}\\right)=2\\,\\arctan\\!\\left(\\frac{\\omega_{d}T}{2}\\right).\n$$\n相对误差定义为\n$$\n\\epsilon=\\frac{\\omega_{a}-\\omega_{d}}{\\omega_{d}}=\\frac{2\\,\\arctan\\!\\left(\\frac{\\omega_{d}T}{2}\\right)-\\omega_{d}}{\\omega_{d}}.\n$$\n当 $\\omega_{d}=0.2\\pi=\\frac{\\pi}{5}$ 且 $T=0.5$ 时，我们有\n$$\n\\frac{\\omega_{d}T}{2}=\\frac{\\left(\\frac{\\pi}{5}\\right)\\left(\\frac{1}{2}\\right)}{2}=\\frac{\\pi}{20},\n$$\n所以\n$$\n\\omega_{a}=2\\,\\arctan\\!\\left(\\frac{\\pi}{20}\\right),\\quad\n\\epsilon=\\frac{2\\,\\arctan\\!\\left(\\frac{\\pi}{20}\\right)-\\frac{\\pi}{5}}{\\frac{\\pi}{5}}=\\frac{10}{\\pi}\\arctan\\!\\left(\\frac{\\pi}{20}\\right)-1.\n$$\n进行数值计算，\n$$\n\\arctan\\!\\left(\\frac{\\pi}{20}\\right)\\approx 0.1558065,\\quad \\omega_{a}\\approx 0.311613,\n$$\n且 $\\omega_{d}=\\frac{\\pi}{5}\\approx 0.628319$，\n$$\n\\epsilon=\\frac{0.311613-0.628319}{0.628319}\\approx -0.504.\n$$\n四舍五入到三位有效数字，相对误差为 $-0.504$。", "answer": "$$\\boxed{-0.504}$$", "id": "1720719"}, {"introduction": "实际的滤波器设计任务通常比设定单个截止频率更复杂，比如需要定义一个具有特定带宽的通带。本练习将频率预畸变的概念从单个频率点扩展到一个频率区间，要求你为一个数字带通滤波器设计对应的模拟原型[@problem_id:1720737]。通过计算模拟滤波器的所需带宽，你将看到频率扭曲不仅影响单个频率点，还会改变频率区间的宽度，这对设计带通或带阻滤波器至关重要。", "problem": "一位音频工程师的任务是设计一个数字无限冲激响应（IIR）滤波器，以分离一段音乐录音中的特定频率范围。该设计将使用双线性变换方法来实现，此方法将一个连续时间（模拟）滤波器原型映射到一个离散时间（数字）滤波器。该数字滤波器要求其通带由下截止频率 $f_{d1} = 6.00$ kHz 和上截止频率 $f_{d2} = 12.0$ kHz 界定。音频系统的工作采样频率为 $f_s = 48.0$ kHz。\n\n为确保最终数字滤波器的截止频率正确无误，必须在设计之前对模拟原型滤波器相应的截止频率进行“预畸变”（prewarped）。计算这个经过预畸变的模拟原型滤波器所需的带宽。以千赫兹（kHz）为单位表示您的答案，并四舍五入到三位有效数字。", "solution": "对于双线性变换，模拟角频率 $\\Omega$ 和数字角频率 $\\omega$ 之间的关系是\n$$\n\\Omega=\\frac{2}{T}\\tan\\!\\left(\\frac{\\omega}{2}\\right), \\quad T=\\frac{1}{f_{s}}.\n$$\n转换为赫兹（Hertz），$F=\\frac{\\Omega}{2\\pi}$，并使用 $\\omega=2\\pi \\frac{f_{d}}{f_{s}}$，则与数字频率 $f_{d}$ 对应的预畸变模拟频率为\n$$\nF=\\frac{f_{s}}{\\pi}\\tan\\!\\left(\\pi\\frac{f_{d}}{f_{s}}\\right).\n$$\n因此，预畸变的模拟通带边缘频率为\n$$\nF_{1}=\\frac{f_{s}}{\\pi}\\tan\\!\\left(\\pi\\frac{f_{d1}}{f_{s}}\\right), \\quad F_{2}=\\frac{f_{s}}{\\pi}\\tan\\!\\left(\\pi\\frac{f_{d2}}{f_{s}}\\right),\n$$\n且所需的模拟带宽为\n$$\nB=F_{2}-F_{1}=\\frac{f_{s}}{\\pi}\\left[\\tan\\!\\left(\\pi\\frac{f_{d2}}{f_{s}}\\right)-\\tan\\!\\left(\\pi\\frac{f_{d1}}{f_{s}}\\right)\\right].\n$$\n当 $f_{s}=48.0\\ \\text{kHz}$，$f_{d1}=6.00\\ \\text{kHz}$ 且 $f_{d2}=12.0\\ \\text{kHz}$ 时，\n$$\n\\pi\\frac{f_{d1}}{f_{s}}=\\frac{\\pi}{8}, \\quad \\pi\\frac{f_{d2}}{f_{s}}=\\frac{\\pi}{4},\n$$\n因此 $\\tan(\\pi/4)=1$ 且 $\\tan(\\pi/8)=\\sqrt{2}-1$。所以，\n$$\nB=\\frac{48}{\\pi}\\left[1-(\\sqrt{2}-1)\\right]\\ \\text{kHz}=\\frac{48}{\\pi}(2-\\sqrt{2})\\ \\text{kHz}.\n$$\n数值计算上，\n$$\nB\\approx \\frac{48}{\\pi}\\times 0.5857864376\\ \\text{kHz}\\approx 8.95016013\\ \\text{kHz},\n$$\n四舍五入到三位有效数字后为 $8.95\\ \\text{kHz}$。", "answer": "$$\\boxed{8.95}$$", "id": "1720737"}]}