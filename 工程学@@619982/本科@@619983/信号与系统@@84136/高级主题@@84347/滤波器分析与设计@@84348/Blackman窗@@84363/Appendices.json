{"hands_on_practices": [{"introduction": "为了开启我们的动手实践之旅，我们将从布莱克曼窗函数的基本定义入手。这个练习将让你直接实践应用窗函数的数学公式，这是分析其对信号影响前至关重要的第一步。通过计算窗函数在其中心点的值，你将验证对称窗的一个关键特性，并建立对其形状的基本理解。", "problem": "在数字信号处理中，窗函数用于对信号进行锥削，这有助于在分析有限时长信号的频率成分时减少频谱泄漏。Blackman窗是一种广泛使用的窗函数，以其出色的旁瓣衰减而闻名。\n\n一个对称N点Blackman窗的公式为：\n$$w[n] = 0.42 - 0.5 \\cos\\left(\\frac{2\\pi n}{N-1}\\right) + 0.08 \\cos\\left(\\frac{4\\pi n}{N-1}\\right)$$\n其中窗函数的定义域为整数索引 $n$ 从 $0$ 到 $N-1$。\n\n对于一个长度为 $N = 51$ 的Blackman窗，请确定其中心采样点处的窗函数值 $w[n]$。请用一个具体的数值表示你的答案。", "solution": "我们已知Blackman窗函数为\n$$\nw[n] = 0.42 - 0.5 \\cos\\left(\\frac{2\\pi n}{N-1}\\right) + 0.08 \\cos\\left(\\frac{4\\pi n}{N-1}\\right),\n$$\n其定义域为整数 $n$ 从 $0$ 到 $N-1$。对于一个奇数长度 $N$，中心采样点的索引由下式给出\n$$\nn_{c} = \\frac{N-1}{2}.\n$$\n当 $N=51$ 时，我们有\n$$\nn_{c} = \\frac{51-1}{2} = 25.\n$$\n在 $n=25$ 和 $N-1=50$ 处计算余弦参数的值：\n$$\n\\cos\\left(\\frac{2\\pi n_{c}}{N-1}\\right) = \\cos\\left(\\frac{2\\pi \\cdot 25}{50}\\right) = \\cos(\\pi) = -1,\n$$\n$$\n\\cos\\left(\\frac{4\\pi n_{c}}{N-1}\\right) = \\cos\\left(\\frac{4\\pi \\cdot 25}{50}\\right) = \\cos(2\\pi) = 1.\n$$\n将这些值代入窗函数公式：\n$$\nw[25] = 0.42 - 0.5(-1) + 0.08(1) = 0.42 + 0.5 + 0.08 = 1.\n$$\n因此，窗函数在中心采样点的值为$1$。", "answer": "$$\\boxed{1}$$", "id": "1700456"}, {"introduction": "选择窗函数总是需要在频率分辨率和谱泄漏抑制之间进行权衡。下一个练习将深入探讨这一核心概念，通过比较布莱克曼窗和简单的矩形窗的分辨能力。量化这种差异将帮助你理解，为何布莱克曼窗出色的旁瓣抑制能力是以更宽主瓣为代价的，这对于分辨间隔很近的频率分量是一个关键考量。", "problem": "一位数字信号处理工程师正在分析一个信号，该信号已知是两个振幅相等、频率分别为 $f_1$ 和 $f_2$ 的纯正弦分量的叠加。为了确定这两个频率，工程师对该信号的一个长度为 $N$ 个样本的片段先使用窗函数进行处理，然后再进行 $N$ 点离散傅里叶变换 (DFT)。采样频率为 $f_s$。\n\n在所得频谱中区分（或“分辨”）这两个频率分量的能力，取决于所选窗函数的主瓣宽度。关于可分辨性的一个通用准则是瑞利准则 (Rayleigh criterion)，该准则指出，当一个谱峰的最大值恰好落在另一个谱峰的第一个零点（过零点）上时，这两个谱峰刚好能被分辨。\n\nDFT 中相邻点之间的频率间隔由 $\\Delta f = f_s / N$ 给出。对于不同的窗函数，其第一个零点的位置可以表示为这个基本频率分辨率的倍数。\n- 对于 **矩形窗**，其第一个零点出现在距离其主瓣中心 $1 \\cdot \\Delta f$ 的频率处。\n- 对于 **Blackman 窗**，其第一个零点出现在距离其主瓣中心 $3 \\cdot \\Delta f$ 的频率处。\n\n设 $\\delta f_{\\text{rect}}$ 为使用矩形窗时，分辨这两个正弦波所需的最小频率间隔 $|f_1 - f_2|$。类似地，设 $\\delta f_{\\text{black}}$ 为使用 Blackman 窗时所需的最小频率间隔。\n\n计算比率 $\\frac{\\delta f_{\\text{black}}}{\\delta f_{\\text{rect}}}$。", "solution": "DFT 的频率间隔由 $\\Delta f = f_{s}/N$ 给出。\n\n根据瑞利准则 (Rayleigh criterion)，当两个谱峰的频率间隔等于窗函数频谱的主瓣中心到其第一个零点的距离时，这两个谱峰刚好能被分辨。\n\n对于矩形窗，其第一个零点出现在距离主瓣中心 $1 \\cdot \\Delta f$ 处，因此最小可分辨间隔为\n$$\n\\delta f_{\\text{rect}} = 1 \\cdot \\Delta f.\n$$\n对于 Blackman 窗，其第一个零点出现在距离主瓣中心 $3 \\cdot \\Delta f$ 处，因此\n$$\n\\delta f_{\\text{black}} = 3 \\cdot \\Delta f.\n$$\n因此，该比率为\n$$\n\\frac{\\delta f_{\\text{black}}}{\\delta f_{\\text{rect}}} = \\frac{3 \\cdot \\Delta f}{1 \\cdot \\Delta f} = 3.\n$$", "answer": "$$\\boxed{3}$$", "id": "1700510"}, {"introduction": "除了主要的设计权衡之外，使用离散傅里叶变换（$DFT$）进行真实世界的频谱分析还面临着诸如“扇形损失”（scalloping loss）等实际挑战，即当信号频率与$DFT$频率点未完全对齐时产生的幅度误差。这个进阶练习将挑战你量化布莱克曼窗的最大扇形损失，这一现象会影响频谱中幅度测量的准确性。在实际应用中，理解这种效应对于正确解读频谱数据至关重要。", "problem": "在数字信号处理中，加窗是一种在分析无限长信号的有限片段时，用以减少频谱泄漏的技术。信号会与一个在特定区间之外值为零的窗函数相乘。然而，这个过程会引入一种称为扇形损失的幅度失真。\n\n考虑一个纯复正弦信号 $x[n] = A \\exp(j\\omega_0 n)$，使用 $N$ 点离散傅里叶变换 (DFT) 对其进行分析。在计算DFT之前，该信号与一个周期性的 $N$ 点Blackman窗 $w[n]$ 相乘，对于 $n = 0, 1, \\dots, N-1$，其定义为：\n$$w[n] = a_0 - a_1 \\cos\\left(\\frac{2\\pi n}{N}\\right) + a_2 \\cos\\left(\\frac{4\\pi n}{N}\\right)$$\n这种常见的Blackman窗变体的系数为 $a_0 = 0.42$，$a_1 = 0.5$ 和 $a_2 = 0.08$。\n\n扇形损失指的是，当信号频率 $\\omega_0$ 与DFT的某个频率仓 $\\omega_k = \\frac{2\\pi k}{N}$ 不完全对齐时，在DFT频谱中测量到的信号峰值幅度的降低。当信号频率正好位于两个相邻DFT频率仓的正中间时，会发生最大扇形损失。\n\n假设点数 $N$ 很大，计算这个最大扇形损失。答案以分贝 (dB) 为单位表示，并四舍五入到三位有效数字。", "solution": "单个复正弦信号 $x[n] = A \\exp(j \\omega_{0} n)$ 经 $w[n]$ 加窗后，在DFT频率仓 $k$ 处得到的值为\n$$\nX_{w}[k] = \\sum_{n=0}^{N-1} A \\exp(j \\omega_{0} n)\\, w[n] \\exp\\!\\left(-j \\frac{2\\pi k}{N} n\\right).\n$$\n设 $k$ 是距离 $\\omega_{0}$ 最近的DFT频率仓；记 $\\omega_{0} = \\frac{2\\pi k}{N} + \\Delta$。那么\n$$\nX_{w}[k] = A \\sum_{n=0}^{N-1} w[n] \\exp(j \\Delta n).\n$$\n对于完美的频率仓中心对齐（$\\Delta=0$），测量到的幅度是\n$$\n|X_{w}[k]|_{\\Delta=0} = A \\left|\\sum_{n=0}^{N-1} w[n]\\right|.\n$$\n对于周期性Blackman窗\n$$\nw[n] = a_{0} - a_{1} \\cos\\!\\left(\\frac{2\\pi n}{N}\\right) + a_{2} \\cos\\!\\left(\\frac{4\\pi n}{N}\\right), \\quad n=0,\\dots,N-1,\n$$\n在一个周期内的求和满足 $\\sum_{n=0}^{N-1} \\cos\\!\\left(\\frac{2\\pi n}{N}\\right)=0$ 和 $\\sum_{n=0}^{N-1} \\cos\\!\\left(\\frac{4\\pi n}{N}\\right)=0$，所以\n$$\n\\sum_{n=0}^{N-1} w[n] = a_{0} N.\n$$\n因此，频率仓上的参考幅度是 $A a_{0} N$。\n\n最大扇形损失发生在半个频率仓偏移处，即 $\\Delta = \\frac{\\pi}{N}$。定义 $z \\triangleq \\exp\\!\\left(j \\frac{\\pi}{N}\\right)$。那么\n$$\nS_{1} \\triangleq \\sum_{n=0}^{N-1} w[n] z^{n}\n= a_{0} \\sum_{n=0}^{N-1} z^{n}\n- \\frac{a_{1}}{2} \\sum_{n=0}^{N-1} \\left(\\exp\\!\\left(j \\frac{2\\pi}{N} n\\right) + \\exp\\!\\left(-j \\frac{2\\pi}{N} n\\right)\\right) z^{n}\n+ \\frac{a_{2}}{2} \\sum_{n=0}^{N-1} \\left(\\exp\\!\\left(j \\frac{4\\pi}{N} n\\right) + \\exp\\!\\left(-j \\frac{4\\pi}{N} n\\right)\\right) z^{n}.\n$$\n引入\n$$\nG(m) \\triangleq \\sum_{n=0}^{N-1} \\exp\\!\\left(j \\frac{(2m+1)\\pi}{N} n\\right), \\quad m \\in \\mathbb{Z}.\n$$\n则\n$$\nS_{1} = a_{0} G(0) - \\frac{a_{1}}{2} \\left(G(1)+G(-1)\\right) + \\frac{a_{2}}{2} \\left(G(2)+G(-2)\\right).\n$$\n使用标准的有限和恒等式\n$$\n\\sum_{n=0}^{N-1} \\exp(j \\theta n) = \\exp\\!\\left(j \\theta \\frac{N-1}{2}\\right) \\frac{\\sin\\!\\left(\\frac{N \\theta}{2}\\right)}{\\sin\\!\\left(\\frac{\\theta}{2}\\right)},\n$$\n取 $\\theta_{m} = \\frac{(2m+1)\\pi}{N}$，我们得到\n$$\nG(m) = \\exp\\!\\left(j \\theta_{m} \\frac{N-1}{2}\\right) \\frac{\\sin\\!\\left(\\frac{N \\theta_{m}}{2}\\right)}{\\sin\\!\\left(\\frac{\\theta_{m}}{2}\\right)}.\n$$\n因为 $\\frac{N \\theta_{m}}{2} = \\frac{(2m+1)\\pi}{2}$，我们有 $\\sin\\!\\left(\\frac{N \\theta_{m}}{2}\\right) = (-1)^{m}$。另外，\n$$\n\\exp\\!\\left(j \\theta_{m} \\frac{N-1}{2}\\right) = \\exp\\!\\left(j \\frac{(2m+1)\\pi}{2}\\right) \\exp\\!\\left(-j \\frac{(2m+1)\\pi}{2N}\\right) = j (-1)^{m} \\exp\\!\\left(-j \\frac{(2m+1)\\pi}{2N}\\right).\n$$\n因此\n$$\nG(m) = \\frac{j \\exp\\!\\left(-j \\frac{(2m+1)\\pi}{2N}\\right)}{\\sin\\!\\left(\\frac{(2m+1)\\pi}{2N}\\right)}.\n$$\n这得到\n$$\nS_{1} = j \\left[\n\\frac{a_{0} \\exp\\!\\left(-j \\frac{\\pi}{2N}\\right)}{\\sin\\!\\left(\\frac{\\pi}{2N}\\right)}\n- \\frac{a_{1}}{2} \\left(\n\\frac{\\exp\\!\\left(-j \\frac{3\\pi}{2N}\\right)}{\\sin\\!\\left(\\frac{3\\pi}{2N}\\right)}\n- \\frac{\\exp\\!\\left(+j \\frac{\\pi}{2N}\\right)}{\\sin\\!\\left(\\frac{\\pi}{2N}\\right)}\n\\right)\n+ \\frac{a_{2}}{2} \\left(\n\\frac{\\exp\\!\\left(-j \\frac{5\\pi}{2N}\\right)}{\\sin\\!\\left(\\frac{5\\pi}{2N}\\right)}\n- \\frac{\\exp\\!\\left(+j \\frac{3\\pi}{2N}\\right)}{\\sin\\!\\left(\\frac{3\\pi}{2N}\\right)}\n\\right)\n\\right].\n$$\n对于大的 $N$，我们使用小角度近似\n$$\n\\sin\\!\\left(\\frac{(2m+1)\\pi}{2N}\\right) \\approx \\frac{(2m+1)\\pi}{2N}, \\quad\n\\exp\\!\\left(\\pm j \\frac{(2m+1)\\pi}{2N}\\right) \\approx 1,\n$$\n这给出\n$$\nS_{1} \\approx j \\frac{2N}{\\pi} \\left[\na_{0}\n- \\frac{a_{1}}{2} \\left(\\frac{1}{3} - 1\\right)\n+ \\frac{a_{2}}{2} \\left(\\frac{1}{5} - \\frac{1}{3}\\right)\n\\right]\n= j \\frac{2N}{\\pi} \\left(a_{0} + \\frac{a_{1}}{3} - \\frac{a_{2}}{15}\\right).\n$$\n因此，半个频率仓偏移处的测量峰值与频率仓上峰值的比值，渐进地是，\n$$\nR \\triangleq \\frac{|S_{1}|}{\\left|\\sum_{n=0}^{N-1} w[n]\\right|}\n\\approx \\frac{\\frac{2N}{\\pi} \\left(a_{0} + \\frac{a_{1}}{3} - \\frac{a_{2}}{15}\\right)}{a_{0} N}\n= \\frac{2}{\\pi} \\frac{a_{0} + \\frac{a_{1}}{3} - \\frac{a_{2}}{15}}{a_{0}}.\n$$\n代入 $a_{0}=\\frac{21}{50}$，$a_{1}=\\frac{1}{2}$，$a_{2}=\\frac{2}{25}$，\n$$\na_{0} + \\frac{a_{1}}{3} - \\frac{a_{2}}{15} = \\frac{21}{50} + \\frac{1}{6} - \\frac{2}{375} = \\frac{218}{375},\n$$\n所以\n$$\nR \\approx \\frac{2}{\\pi} \\frac{\\frac{218}{375}}{\\frac{21}{50}} = \\frac{872}{315\\,\\pi}.\n$$\n最大扇形损失（以dB为单位的正数）是\n$$\nL_{\\text{dB}} = -20 \\log_{10}(R) = 20 \\log_{10}\\!\\left(\\frac{1}{R}\\right) = 20 \\log_{10}\\!\\left(\\frac{315\\,\\pi}{872}\\right).\n$$\n数值上，$L_{\\text{dB}} \\approx 1.10$（四舍五入到三位有效数字）。", "answer": "$$\\boxed{1.10}$$", "id": "1700446"}]}