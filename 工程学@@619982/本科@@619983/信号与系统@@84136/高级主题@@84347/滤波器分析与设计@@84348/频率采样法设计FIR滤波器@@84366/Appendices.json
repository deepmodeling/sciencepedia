{"hands_on_practices": [{"introduction": "此练习旨在巩固频率采样方法的基础。我们将从一组给定的理想频率响应样本 $H(k)$ 出发，通过计算离散傅里叶反变换 (IDFT) 来确定滤波器的时域脉冲响应 $h[n]$ [@problem_id:1719137]。这个过程是将频域设计转化为时域实现的第一个、也是最核心的计算步骤，为理解滤波器的工作原理打下坚实基础。", "problem": "一个长度为 $N=15$ 的线性相位有限脉冲响应 (FIR) 滤波器正采用频率采样法进行设计。在此方法中，所需滤波器的频率响应由一组 $N$ 个频率样本 $H(k)$（$k = 0, 1, \\dots, N-1$）指定。这些样本对应于频率 $\\omega_k = \\frac{2\\pi k}{N}$。\n\n对于本特定设计，选择了一个对称的低通特性，其频率样本定义如下：\n$$\nH(k) = \\begin{cases}\n1 & \\text{for } k \\in \\{0, 1, 2, 13, 14\\} \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\n滤波器的脉冲响应 $h[n]$ 是通过计算序列 $H(k)$ 的 $N$ 点离散傅里叶逆变换（IDFT）得到的。\n\n请确定脉冲响应系数 $h[7]$ 的值。请以单个闭式解析表达式的形式给出您的答案。", "solution": "对于一个 $N$ 点IDFT，其常规的DFT/IDFT变换对为\n$$\nX(k)=\\sum_{n=0}^{N-1} x[n]\\exp\\left(-j\\frac{2\\pi kn}{N}\\right),\\quad\nx[n]=\\frac{1}{N}\\sum_{k=0}^{N-1} X(k)\\exp\\left(j\\frac{2\\pi kn}{N}\\right),\n$$\n其脉冲响应为\n$$\nh[n]=\\frac{1}{N}\\sum_{k=0}^{N-1} H(k)\\exp\\left(j\\frac{2\\pi kn}{N}\\right).\n$$\n当 $N=15$ 且 $H(k)=1$（对于 $k\\in\\{0,1,2,13,14\\}$），以及在其他情况下 $H(k)=0$ 时，我们得到\n$$\nh[n]=\\frac{1}{15}\\left[\\exp(0)+\\exp\\left(j\\frac{2\\pi n}{15}\\right)+\\exp\\left(j\\frac{4\\pi n}{15}\\right)+\\exp\\left(j\\frac{26\\pi n}{15}\\right)+\\exp\\left(j\\frac{28\\pi n}{15}\\right)\\right].\n$$\n使用 $13\\equiv -2\\pmod{15}$ 和 $14\\equiv -1\\pmod{15}$ 可得\n$$\nh[n]=\\frac{1}{15}\\left[1+\\exp\\left(j\\frac{2\\pi n}{15}\\right)+\\exp\\left(j\\frac{4\\pi n}{15}\\right)+\\exp\\left(-j\\frac{4\\pi n}{15}\\right)+\\exp\\left(-j\\frac{2\\pi n}{15}\\right)\\right].\n$$\n应用 $\\exp(j\\theta)+\\exp(-j\\theta)=2\\cos\\theta$ 可得\n$$\nh[n]=\\frac{1}{15}\\left[1+2\\cos\\left(\\frac{2\\pi n}{15}\\right)+2\\cos\\left(\\frac{4\\pi n}{15}\\right)\\right].\n$$\n对于 $n=7$，\n$$\nh[7]=\\frac{1}{15}\\left[1+2\\cos\\left(\\frac{14\\pi}{15}\\right)+2\\cos\\left(\\frac{28\\pi}{15}\\right)\\right].\n$$\n使用恒等式 $\\cos(\\pi-\\alpha)=-\\cos(\\alpha)$ 和 $\\cos(2\\pi-\\alpha)=\\cos(\\alpha)$ 可得\n$$\n\\cos\\left(\\frac{14\\pi}{15}\\right)=-\\cos\\left(\\frac{\\pi}{15}\\right),\\qquad\n\\cos\\left(\\frac{28\\pi}{15}\\right)=\\cos\\left(\\frac{2\\pi}{15}\\right).\n$$\n因此，\n$$\nh[7]=\\frac{1}{15}\\left[1-2\\cos\\left(\\frac{\\pi}{15}\\right)+2\\cos\\left(\\frac{2\\pi}{15}\\right)\\right].\n$$\n另外，使用 $\\cos(2x)=2\\cos^{2}(x)-1$ 并设 $x=\\frac{\\pi}{15}$，可以得到等价的闭式形式\n$$\nh[7]=\\frac{1}{15}\\left[4\\cos^{2}\\left(\\frac{\\pi}{15}\\right)-2\\cos\\left(\\frac{\\pi}{15}\\right)-1\\right].\n$$\n$h[7]$ 的这两种表达式都是有效的单个闭式解析表达式。", "answer": "$$\\boxed{\\frac{1}{15}\\left[4\\cos^{2}\\left(\\frac{\\pi}{15}\\right)-2\\cos\\left(\\frac{\\pi}{15}\\right)-1\\right]}$$", "id": "1719137"}, {"introduction": "在掌握了如何从频域样本计算脉冲响应后，我们进一步探究该设计方法的一个深刻内涵。此练习揭示了将某个频率样本 $H(k)$ 设为零，与在z平面的单位圆上精确地放置一个传输零点之间的直接关系 [@problem_id:1742274]。理解这种对应关系是掌握如何通过频率采样法构建具有特定阻带特性的滤波器的关键。", "problem": "一位系统工程师正在设计一个长度为 $N=32$ 的数字有限脉冲响应 (FIR) 滤波器。该设计基于频率采样法，其中期望的频率响应在 $N$ 个等间隔频率点 $\\omega_k = \\frac{2\\pi k}{N}$（$k = 0, 1, \\dots, N-1$）上进行指定。所得的频率样本记为 $H(k)$，用于确定该滤波器的脉冲响应 $h[n]$ 及其相应的传递函数 $H(z)$。\n\n为了近似一个理想低通滤波器，该工程师将频率样本设置如下：\n$$\nH(k) = \\begin{cases} 1 & \\text{for } k \\in \\{0, 1, 2, 30, 31\\} \\\\ 0 & \\text{for } k=3, 4, \\dots, 29 \\end{cases}\n$$\n$H(k)$ 的这些特定选择确保了所得的脉冲响应 $h[n]$ 是一个实值序列。\n\n根据此设计规范，确定该滤波器传递函数 $H(z)$ 的零点中，保证位于 z 平面单位圆上的零点数量。", "solution": "给定一个通过频率采样法设计的长度为 $N=32$ 的 FIR 滤波器。设 $N$ 个等间隔频率点为 $\\omega_{k}=\\frac{2\\pi k}{N}$，$k=0,1,\\dots,N-1$，指定的样本为 $H(k)$。脉冲响应通过逆离散傅里叶变换 (IDFT) 求得：\n$$\nh[n]=\\frac{1}{N}\\sum_{k=0}^{N-1}H(k)\\exp\\left(j\\frac{2\\pi k}{N}n\\right),\\quad n=0,1,\\dots,N-1.\n$$\n传递函数为\n$$\nH(z)=\\sum_{n=0}^{N-1}h[n]z^{-n},\n$$\n特别地，其在单位圆上的频率响应为\n$$\nH\\left(e^{j\\omega}\\right)=\\sum_{n=0}^{N-1}h[n]e^{-j\\omega n}.\n$$\n在采样频率 $\\omega_{m}=\\frac{2\\pi m}{N}$ 处计算 $H(e^{j\\omega})$ 并代入 $h[n]$ 可得\n$$\nH\\left(e^{j\\frac{2\\pi m}{N}}\\right)=\\sum_{n=0}^{N-1}\\left[\\frac{1}{N}\\sum_{k=0}^{N-1}H(k)\\exp\\left(j\\frac{2\\pi k}{N}n\\right)\\right]\\exp\\left(-j\\frac{2\\pi m}{N}n\\right).\n$$\n交换求和顺序可得\n$$\nH\\left(e^{j\\frac{2\\pi m}{N}}\\right)=\\frac{1}{N}\\sum_{k=0}^{N-1}H(k)\\sum_{n=0}^{N-1}\\exp\\left(j\\frac{2\\pi (k-m)}{N}n\\right).\n$$\n利用复指数的正交性，\n$$\n\\sum_{n=0}^{N-1}\\exp\\left(j\\frac{2\\pi (k-m)}{N}n\\right)=\\begin{cases}N,& k=m\\ (\\text{mod }N),\\\\ 0,& k\\neq m,\\end{cases}\n$$\n我们得到精确插值特性\n$$\nH\\left(e^{j\\frac{2\\pi m}{N}}\\right)=H(m),\\quad m=0,1,\\dots,N-1.\n$$\n因此，对于每个满足 $H(m)=0$ 的索引 $m$，$H\\left(e^{j\\frac{2\\pi m}{N}}\\right)$ 的值为 0，这意味着 $z=e^{j\\frac{2\\pi m}{N}}$ 是 $H(z)$ 在单位圆上的一个零点。\n\n在给定的规范中，\n$$\nH(k)=1\\ \\text{for}\\ k\\in\\{0,1,2,30,31\\},\\qquad H(k)=0\\ \\text{for}\\ k=3,4,\\dots,29.\n$$\n集合 $\\{3,4,\\dots,29\\}$ 包含 $29-3+1=27$ 个索引。因此，存在 27 个不同的频率 $\\omega_{k}=\\frac{2\\pi k}{N}$，在这些频率点上 $H\\left(e^{j\\omega_{k}}\\right)=0$，从而保证 $H(z)$ 有 27 个零点位于单位圆上。\n\n这个计数包括了在 $k=\\frac{N}{2}=16$ 处的自共轭奈奎斯特频率（即 $z=-1$）以及在 $k$ 和 $N-k$ 处的所有共轭对，它们各自都贡献了不同的单位圆零点。该规范没有保证存在其他单位圆零点，因此保证的数量是 $27$。", "answer": "$$\\boxed{27}$$", "id": "1742274"}, {"introduction": "本章的最后一个练习将引导我们思考频率采样方法的实际局限性与非理想效应。通过一个思想实验，我们探究单个频率样本的微小误差（例如由硬件量化引起）如何影响整个频率响应 [@problem_id:1719159]。此问题说明了局部扰动的全局影响——即产生贯穿整个频谱的“波纹”，这对于深刻理解该方法的插值本质以及在实际应用中的性能权衡至关重要。", "problem": "一位工程师正在使用频率采样法设计一个长度为 $N=51$ 的线性相位有限脉冲响应 (FIR) 低通滤波器。理想期望频率响应 $H_d(e^{j\\omega})$ 定义为：\n$$\nH_d(e^{j\\omega}) = \n\\begin{cases} \n1 & \\text{for } |\\omega| \\leq 0.3\\pi \\\\\n0 & \\text{for } 0.3\\pi < |\\omega| \\leq \\pi\n\\end{cases}\n$$\n频率样本 $H(k)$ 是在频率 $\\omega_k = \\frac{2\\pi k}{N}$（$k = 0, 1, \\dots, N-1$）处采样得到的。由于实现过程中的硬件量化误差，预期阻带中的一个频率样本被错误地设置。具体来说，索引为 $k=15$ 处的样本本应为 $H(15)=0$，却被存储为一个小的正实数 $H(15) = \\epsilon$。所有其他 $N-1$ 个频率样本均被设置为其正确的理想值。\n\n以下哪个陈述最准确地描述了这一个误差对最终内插频率响应的幅度 $|H(e^{j\\omega})|$ 的影响？\n\nA. 该误差在阻带中的频率 $\\omega = \\frac{2\\pi(15)}{51}$ 处引入一个无限窄的尖峰，但阻带的其余部分保持理想的零衰减。\n\nB. 该误差的影响是局部的；在频率 $\\omega = \\frac{2\\pi(15)}{51}$ 周围出现一个小波纹，但对于阻带中远离该点的频率，频率响应会迅速恢复到理想的零。\n\nC. 该误差导致 FIR 滤波器变得不稳定，从而对某些有界输入信号产生无界输出。\n\nD. 该误差引入了一个延伸至整个频谱（包括通带和阻带）的波纹。该波纹的形状是周期Sinc（或Dirichlet）函数的一个经过缩放和平移的版本。\n\nE. 该误差仅影响滤波器的相位响应，而其幅度响应 $|H(e^{j\\omega})|$ 与理想设计保持一致。", "solution": "频率采样法指定了在 $\\omega_{k}=\\frac{2\\pi k}{N}$ 处的 $N$ 个频率样本 $H(k)$。相应的脉冲响应通过离散傅里叶逆变换 (inverse DFT) 获得：\n$$\nh[n]=\\frac{1}{N}\\sum_{k=0}^{N-1}H(k)\\exp\\left(j\\frac{2\\pi k}{N}n\\right),\\quad n=0,1,\\dots,N-1.\n$$\n$h[n]$ 的离散时间傅里叶变换 (DTFT) 给出了内插的频率响应：\n$$\nH\\left(\\exp(j\\omega)\\right)=\\sum_{n=0}^{N-1}h[n]\\exp(-j\\omega n).\n$$\n将 $h[n]$ 代入此 DTFT 中，得到\n$$\nH\\left(\\exp(j\\omega)\\right)=\\frac{1}{N}\\sum_{k=0}^{N-1}H(k)\\sum_{n=0}^{N-1}\\exp\\left(-j\\left(\\omega-\\frac{2\\pi k}{N}\\right)n\\right).\n$$\n内部的求和是一个有限几何级数，其结果为 Dirichlet 核（相差一个线性相位因子）：\n$$\n\\sum_{n=0}^{N-1}\\exp\\left(-j\\left(\\omega-\\frac{2\\pi k}{N}\\right)n\\right)=\\exp\\left(-j\\frac{(N-1)}{2}\\left(\\omega-\\frac{2\\pi k}{N}\\right)\\right)\\frac{\\sin\\left(\\frac{N}{2}\\left(\\omega-\\frac{2\\pi k}{N}\\right)\\right)}{\\sin\\left(\\frac{1}{2}\\left(\\omega-\\frac{2\\pi k}{N}\\right)\\right)}.\n$$\n因此，\n$$\nH\\left(\\exp(j\\omega)\\right)=\\frac{1}{N}\\sum_{k=0}^{N-1}H(k)\\exp\\left(-j\\frac{(N-1)}{2}\\left(\\omega-\\frac{2\\pi k}{N}\\right)\\right)\\frac{\\sin\\left(\\frac{N}{2}\\left(\\omega-\\frac{2\\pi k}{N}\\right)\\right)}{\\sin\\left(\\frac{1}{2}\\left(\\omega-\\frac{2\\pi k}{N}\\right)\\right)}.\n$$\n这表明每个样本 $H(k)$ 都会在整个频率轴上贡献一个经过平移和缩放的 Dirichlet 核。如果所有样本都与理想的低通值匹配，它们的叠加将近似于期望的响应。如果恰好一个阻带样本存在误差 $H(15)=\\epsilon$（理想值为零），那么 $H\\left(\\exp(j\\omega)\\right)$ 可以写成\n$$\nH\\left(\\exp(j\\omega)\\right)=H_{\\text{ideal}}\\left(\\exp(j\\omega)\\right)+\\frac{\\epsilon}{N}\\exp\\left(-j\\frac{(N-1)}{2}\\left(\\omega-\\frac{2\\pi\\cdot 15}{N}\\right)\\right)\\frac{\\sin\\left(\\frac{N}{2}\\left(\\omega-\\frac{2\\pi\\cdot 15}{N}\\right)\\right)}{\\sin\\left(\\frac{1}{2}\\left(\\omega-\\frac{2\\pi\\cdot 15}{N}\\right)\\right)}.\n$$\n取其幅度，附加项会产生一个形状类似于 Dirichlet 核幅度的波纹，该波纹以 $\\omega=\\frac{2\\pi\\cdot 15}{N}$ 为中心，并且由于 Dirichlet 核在频域上不具有紧支集，该波纹会延伸至整个频谱。因此：\n- 它不是在单个频率上的无限窄尖峰；相反，Dirichlet 核在所有频率上都有旁瓣，因此选项A是错误的。\n- 影响并非局限于 $\\omega=\\frac{2\\pi\\cdot 15}{N}$ 附近；Dirichlet 核在整个频谱上（除了在其零点处）都产生非零贡献，因此选项B是错误的。\n- FIR 滤波器是 BIBO（有界输入有界输出）稳定的，这与系数的量化无关，因此选项C是错误的。\n- 该误差通过附加的 Dirichlet 形状项直接改变了幅度，因此它不仅仅影响相位；选项E是错误的。\n\n因此，正确的描述是，单个错误样本引入了一个形状为经过缩放和平移的 Dirichlet 核的波纹，该波纹延伸至整个频谱，这与选项D一致。", "answer": "$$\\boxed{D}$$", "id": "1719159"}]}