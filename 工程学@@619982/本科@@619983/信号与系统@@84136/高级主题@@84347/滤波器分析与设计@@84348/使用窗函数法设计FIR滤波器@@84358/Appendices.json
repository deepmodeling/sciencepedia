{"hands_on_practices": [{"introduction": "本练习是您迈向实用 FIR 滤波器设计的第一步。我们将从一个理想的低通滤波器开始，它拥有完美的频率响应，但其脉冲响应却是无限长的。您将学习如何通过应用最简单的窗函数——矩形窗，将这个理想概念转化为一个可实现的、有限长度的滤波器，并亲手计算其系数。这个实践通过引导您完成最基本的应用，揭开了窗函数法设计的神秘面纱 [@problem_id:1719431]。", "problem": "一个数字信号处理系统正在被设计用来消除高频噪声。该系统使用一个具有7个抽头的线性相位有限脉冲响应（FIR）滤波器。其脉冲响应，记为 $h[n]$，因此是实值、对称且具有有限长度的。\n\n设计过程始于理想低通滤波器的频率响应 $H_d(e^{j\\omega})$，其在一个周期 $-\\pi \\le \\omega < \\pi$ 上的定义如下：\n$$ H_d(e^{j\\omega}) = \\begin{cases} 1 & \\text{for } |\\omega| \\le \\frac{\\pi}{2} \\\\ 0 & \\text{for } \\frac{\\pi}{2} < |\\omega| \\le \\pi \\end{cases} $$\n相应的理想脉冲响应 $h_d[n]$ 是通过对 $H_d(e^{j\\omega})$ 进行逆变换得到的。\n\n为了创建该7抽头滤波器，理想脉冲响应 $h_d[n]$ 被截断，使其仅在索引 $n$ 从 $-3$ 到 $3$ 的范围内非零。这创建了一个非因果、零相位的滤波器，其系数记为 $h_{nc}[n]$。系数定义如下：\n$$ h_{nc}[n] = \\begin{cases} h_d[n] & \\text{for } n \\in \\{-3, -2, -1, 0, 1, 2, 3\\} \\\\ 0 & \\text{otherwise} \\end{cases} $$\n确定此非因果滤波器的七个非零系数，$h_{nc}[-3], h_{nc}[-2], \\dots, h_{nc}[3]$。将你的答案表示为一个包含这七个值的序列，按索引从 $n=-3$ 到 $n=3$ 的递增顺序排列。你的答案必须是使用像 $\\pi$ 这样的常数表示的精确解析表达式。", "solution": "截止频率为 $\\omega_{c}=\\frac{\\pi}{2}$ 的理想低通滤波器，其频率响应在 $[-\\pi,\\pi)$ 上为：当 $|\\omega|\\leq \\frac{\\pi}{2}$ 时 $H_{d}(\\exp(j\\omega))=1$，否则为 $0$。相应的理想脉冲响应由离散时间傅里叶逆变换（inverse DTFT）给出：\n$$\nh_{d}[n]=\\frac{1}{2\\pi}\\int_{-\\pi}^{\\pi}H_{d}(\\exp(j\\omega))\\exp(j\\omega n)\\,d\\omega\n=\\frac{1}{2\\pi}\\int_{-\\frac{\\pi}{2}}^{\\frac{\\pi}{2}}\\exp(j\\omega n)\\,d\\omega.\n$$\n对于 $n=0$，\n$$\nh_{d}[0]=\\frac{1}{2\\pi}\\int_{-\\frac{\\pi}{2}}^{\\frac{\\pi}{2}}1\\,d\\omega=\\frac{1}{2\\pi}\\left(\\pi\\right)=\\frac{1}{2}.\n$$\n对于 $n\\neq 0$，\n$$\nh_{d}[n]=\\frac{1}{2\\pi}\\left[\\frac{\\exp(j\\omega n)}{j n}\\right]_{-\\frac{\\pi}{2}}^{\\frac{\\pi}{2}}\n=\\frac{1}{2\\pi j n}\\left(\\exp\\!\\left(j\\frac{\\pi n}{2}\\right)-\\exp\\!\\left(-j\\frac{\\pi n}{2}\\right)\\right)\n=\\frac{1}{\\pi n}\\sin\\!\\left(\\frac{\\pi n}{2}\\right).\n$$\n因此，\n$$\nh_{d}[n]=\\begin{cases}\n\\frac{1}{2}, & n=0, \\\\\n\\frac{1}{\\pi n}\\sin\\!\\left(\\frac{\\pi n}{2}\\right), & n\\neq 0.\n\\end{cases}\n$$\n该7抽头非因果零相位滤波器是通过截断至 $n\\in\\{-3,-2,-1,0,1,2,3\\}$ 得到的，因此对于这些 $n$，$h_{nc}[n]=h_{d}[n]$。分别计算每个值：\n- 对于 $n=-3$：$\\sin\\!\\left(-\\frac{3\\pi}{2}\\right)=1$，因此 $h_{nc}[-3]=\\frac{1}{\\pi(-3)}\\cdot 1=-\\frac{1}{3\\pi}$。\n- 对于 $n=-2$：$\\sin(-\\pi)=0$，因此 $h_{nc}[-2]=0$。\n- 对于 $n=-1$：$\\sin\\!\\left(-\\frac{\\pi}{2}\\right)=-1$，因此 $h_{nc}[-1]=\\frac{1}{-\\pi}\\cdot(-1)=\\frac{1}{\\pi}$。\n- 对于 $n=0$：$h_{nc}[0]=\\frac{1}{2}$。\n- 对于 $n=1$：$\\sin\\!\\left(\\frac{\\pi}{2}\\right)=1$，因此 $h_{nc}[1]=\\frac{1}{\\pi}$。\n- 对于 $n=2$：$\\sin(\\pi)=0$，因此 $h_{nc}[2]=0$。\n- 对于 $n=3$：$\\sin\\!\\left(\\frac{3\\pi}{2}\\right)=-1$，因此 $h_{nc}[3]=-\\frac{1}{3\\pi}$。\n\n因此，从 $n=-3$ 到 $n=3$ 排序，这七个系数为 $-\\frac{1}{3\\pi},\\,0,\\,\\frac{1}{\\pi},\\,\\frac{1}{2},\\,\\frac{1}{\\pi},\\,0,\\,-\\frac{1}{3\\pi}$。", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{1}{3\\pi} & 0 & \\frac{1}{\\pi} & \\frac{1}{2} & \\frac{1}{\\pi} & 0 & -\\frac{1}{3\\pi}\\end{pmatrix}}$$", "id": "1719431"}, {"introduction": "在通过截断创建滤波器后，理解其固有的权衡至关重要。窗函数法会在频域中引入可预测的失真，这种现象被称为频谱泄漏。这个思想实验将挑战您解释为什么通过这种方法设计的高通滤波器在直流（DC）处的增益并非完美的零，从而促使您将时域相乘与频域卷积及其后果联系起来 [@problem_id:1719415]。", "problem": "在数字信号处理中，窗函数法是设计有限冲激响应（FIR）滤波器的一种常用技术。该方法从一个理想的频率响应开始，其对应的冲激响应通常是无限长且非因果的。为了创建一个实际的、有限长度的滤波器，这个理想的冲激响应会与一个有限长度的窗函数（如矩形窗、Hamming窗或Blackman窗）相乘。\n\n考虑一个离散时间高通滤波器的设计。一个理想的高通滤波器具有这样的频率响应：其在阻带（包括直流分量，即频率 $\\omega = 0$）中的增益为零，在通带中的增益为常数（例如，单位增益）。然而，当应用窗函数法来设计一个实际的 FIR 高通滤波器时，所得滤波器的频率响应在直流处会表现出一个虽小但明显非零的增益。\n\n下列哪个陈述为这种非零直流增益的出现提供了最准确的物理和数学解释？\n\nA. 通过平移冲激响应来使滤波器具有因果性的过程，在频域中引入了一个线性相位分量，这从根本上改变了直流处的幅度响应，使其从零变为非零值。\n\nB. 用窗函数截断无限长的理想冲激响应，等效于将理想频率响应与窗函数的频率响应进行卷积。窗函数频谱中以直流为中心的主瓣，不可避免地会“涂抹”或“泄漏”到理想滤波器的阻带中，从而导致在直流处的增益非零。\n\nC. 非零直流增益是吉布斯现象的直接结果，吉布斯现象描述了在频带边缘（阻带和通带之间的过渡区域）发生的过冲和波纹，并且这种现象必然会传播到直流频率。\n\nD. 离散化作为理想滤波器冲激响应的连续时间 sinc 函数会引入量化误差。这些误差在直流频率处累积，导致非零增益。\n\nE. 任何实际的窗函数（除了频域中的理想矩形窗）都具有非零带宽。这种固有带宽迫使所得滤波器在理想滤波器增益为零的频率（包括直流）处也具有非零响应。", "solution": "问题询问的是，为什么使用窗函数法设计的高通滤波器会具有非零直流增益，尽管理想的高通滤波器直流增益为零。让我们逐步分析这个过程。\n\n设 $h_{ideal}[n]$ 是理想高通滤波器的冲激响应，设 $H_{ideal}(e^{j\\omega})$ 是其频率响应。根据定义，理想高通滤波器在直流处的增益为零，因此 $H_{ideal}(e^{j0}) = 0$。对应于这种急剧截止滤波器的冲激响应 $h_{ideal}[n]$ 是无限长的（它是一种由余弦调制的 sinc 函数形式）。\n\n窗函数法通过截断这个理想冲激响应来创建一个实际的、有限长度的FIR滤波器。这是通过将 $h_{ideal}[n]$ 与一个有限长度的窗函数 $w[n]$ 相乘来实现的。设所得实际滤波器的冲激响应为 $h[n]$。\n\n$$h[n] = h_{ideal}[n] \\cdot w[n]$$\n\n为了理解此操作对频率响应的影响，我们使用离散时间傅里叶变换（DTFT）的卷积定理。该定理指出，时域中的乘法对应于频域中的周期性卷积。因此，实际滤波器的频率响应 $H(e^{j\\omega})$ 是理想滤波器频率响应 $H_{ideal}(e^{j\\omega})$ 与窗函数频率响应 $W(e^{j\\omega})$ 的卷积。\n\n$$H(e^{j\\omega}) = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} H_{ideal}(e^{j\\theta}) W(e^{j(\\omega - \\theta)}) d\\theta$$\n\n我们关心的是实际滤波器的直流增益，即其在 $\\omega = 0$ 处的频率响应值。\n\n$$H(e^{j0}) = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} H_{ideal}(e^{j\\theta}) W(e^{-j\\theta}) d\\theta$$\n\n让我们分析这个积分的组成部分：\n1.  $H_{ideal}(e^{j\\theta})$：这是理想的高通频率响应。对于阻带内的频率，即对于 $|\\theta| \\le \\omega_c$（其中 $\\omega_c$ 是截止频率），其值为零。因此，$H_{ideal}(e^{j\\theta})$ 在 $\\theta=0$ 附近的一个区域内为零。\n2.  $W(e^{-j\\theta})$：这是窗函数的频率响应。对于任何有限长度的窗， $W(e^{j\\omega})$ 都不是一个简单的 delta 函数。它有一个以 $\\omega=0$ 为中心的高能量“主瓣”和一系列延伸至所有频率的衰减“旁瓣”。主瓣的宽度和旁瓣的幅度取决于所使用的具体窗函数。\n\n用于计算 $H(e^{j0})$ 的积分计算的是这两个函数乘积的面积。尽管 $H_{ideal}(e^{j\\theta})$ 在 $\\theta=0$ 附近为零，但函数 $W(e^{-j\\theta})$ 并非如此。$W(e^{-j\\theta})$ 的主瓣和旁瓣会延伸到 $H_{ideal}(e^{j\\theta})$ 非零的区域（即通带，$|\\theta| > \\omega_c$）。因此，乘积 $H_{ideal}(e^{j\\theta}) W(e^{-j\\theta})$ 在理想滤波器的通带区域内将是非零的。在区间 $[-\\pi, \\pi]$ 上对这个非零乘积进行积分，通常会得到一个非零的结果。\n\n这个过程通常被称为“频谱泄漏”或“涂抹”。卷积运算实际上是将窗函数的频率响应“涂抹”到理想的频率响应上。窗函数频谱中以直流为中心的主瓣的能量会“泄漏”或“扩散”到理想滤波器的阻带中。这种涂抹效应会将整个阻带（包括 $\\omega=0$ 处）的增益从理想值零提升到某个小的非零值。\n\n现在让我们评估给出的选项：\n-   A：使滤波器具有因果性会增加一个线性相位项，但这不会改变幅度响应 $|H(e^{j\\omega})|$。直流增益是一个幅度属性，因此这是不正确的。\n-   B：该陈述正确地指出了时域相乘等效于频域卷积。它正确地指出，窗函数的频谱（其主瓣在直流处）与理想滤波器的频谱进行卷积，导致泄漏或涂抹，从而产生非零的直流增益。这是正确的解释。\n-   C：吉布斯现象指的是在不连续点（频带边缘）附近的高频波纹和过冲/下冲。虽然它也是截断（卷积）的结果，但它特指不连续点处的行为。非零直流增益是频谱泄漏在整个阻带上的更广泛影响，而不仅仅是频带边缘波纹的一个特征。\n-   D：量化误差与用有限数量的比特表示连续值有关。它与窗函数法本身是不同的问题，窗函数法是对理想实数进行的数学运算。这是不正确的。\n-   E：这个陈述部分正确，但不如 B 精确和完整。虽然窗函数的带宽是一个因素，但核心机制是两个频谱的*卷积*。声称窗函数的带宽迫使产生非零响应是一种过度简化，忽略了关键的数学运算。选项B提供了关于*如何*发生这种情况的更严谨的解释。\n\n因此，选项 B 提供了最准确和完整的解释。", "answer": "$$\\boxed{B}$$", "id": "1719415"}, {"introduction": "从基本原理走向工程实践，这个问题解决了一个现实的设计场景。在给定的硬件限制和性能要求下，您将使用功能强大的 Kaiser 窗来寻找最优的滤波器设计。这个练习演示了如何利用成熟的设计公式来平衡阻带衰减和过渡带宽之间的权衡，这是实用信号处理应用中的一项核心技能 [@problem_id:1719395]。", "problem": "一名工程师的任务是设计一个低通有限脉冲响应（FIR）滤波器，用于预处理来自传感器的噪声信号。该设计必须使用Kaiser窗方法实现。由于嵌入式系统上严格的硬件内存限制，滤波器长度固定为 $N=65$。所期望的频率响应指标为：通带截止频率 $\\omega_p = 0.3\\pi$ 弧度/采样点，阻带截止频率 $\\omega_s = 0.4\\pi$ 弧度/采样点。\n\nKaiser窗的经验设计公式如下：\n1.  滤波器长度 $N$、阻带衰减 $A_s$（单位为dB）以及过渡带宽度 $\\Delta\\omega = \\omega_s - \\omega_p$ 之间的关系由以下近似公式给出：\n    $$ (N-1) \\Delta\\omega = \\frac{A_s - 8}{2.285} $$\n2.  Kaiser窗参数 $\\beta$ 由阻带衰减 $A_s$ 确定：\n    $$ \\beta = \\begin{cases} 0.1102(A_s - 8.7), & \\text{for } A_s > 50 \\\\ 0.5842(A_s - 21)^{0.4} + 0.07886(A_s - 21), & \\text{for } 21 \\le A_s \\le 50 \\\\ 0, & \\text{for } A_s < 21 \\end{cases} $$\n\n给定固定的滤波器长度和指定的过渡带宽度，确定可以实现的最大阻带衰减 $A_s$。然后，求出实现此设计所需的参数 $\\beta$ 的值。\n\n以两个数值的形式提供您的答案：衰减 $A_s$（单位为dB）和参数 $\\beta$。将您的最终答案四舍五入到三位有效数字。", "solution": "我们使用给定的Kaiser窗关于滤波器长度、过渡带宽度和阻带衰减的经验关系式：\n$$(N-1)\\Delta\\omega=\\frac{A_{s}-8}{2.285}.$$\n给定 $N=65$ 和 $\\Delta\\omega=\\omega_{s}-\\omega_{p}=0.4\\pi-0.3\\pi=0.1\\pi=\\frac{\\pi}{10}$，我们求解 $A_{s}$：\n$$A_{s}=8+2.285\\,(N-1)\\Delta\\omega=8+2.285\\cdot 64\\cdot \\frac{\\pi}{10}=8+14.624\\,\\pi.$$\n数值上，使用 $\\pi\\approx 3.14159265$，这得到\n$$A_{s}\\approx 8+14.624\\times 3.14159265=53.9426509\\ \\text{dB}.$$\n由于 $A_{s}>50$，适用于Kaiser参数的公式是\n$$\\beta=0.1102\\,(A_{s}-8.7).$$\n代入计算出的 $A_{s}$：\n$$\\beta=0.1102\\,(53.9426509-8.7)=0.1102\\times 45.2426509\\approx 4.98574003.$$\n将两者四舍五入到三位有效数字，得到 $A_{s}\\approx 53.9$ 和 $\\beta\\approx 4.99$。", "answer": "$$\\boxed{\\begin{pmatrix} 53.9 & 4.99 \\end{pmatrix}}$$", "id": "1719395"}]}