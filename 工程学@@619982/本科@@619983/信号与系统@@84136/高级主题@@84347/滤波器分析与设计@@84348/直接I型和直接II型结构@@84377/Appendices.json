{"hands_on_practices": [{"introduction": "动手实践的第一步是掌握如何将滤波器结构与其数学描述联系起来。这个练习将指导您把一个以直接II型结构实现的数字滤波器的框图，转化为其在Z域中的传递函数$H(z)$ [@problem_id:1714613]。直接II型结构因其高效的内存使用而在实际应用中备受青睐，理解如何从其差分方程推导出传递函数是分析和设计数字滤波器的基础技能。", "id": "1714613", "problem": "一个离散时间、线性时不变 (LTI) 系统，例如用于数字音频均衡器的系统，是使用一种称为直接II型实现的计算结构来实现的。该结构在内存方面非常高效，因为它最小化了延迟单元的数量。\n\n该系统的行为由其输入序列 $x[n]$、输出序列 $y[n]$ 以及一个内部中间序列 $w[n]$ 之间的关系所描述。中间序列 $w[n]$ 是根据以下递归差分方程，由输入及其自身的过去值生成的：\n$$w[n] = x[n] - a_1 w[n-1] - a_2 w[n-2]$$\n输出序列 $y[n]$ 则根据以下非递归差分方程，由此中间序列的当前值和过去值形成：\n$$y[n] = b_0 w[n] + b_1 w[n-1] + b_2 w[n-2]$$\n对于该系统的一个特定配置，滤波器系数如下：\n$a_1 = -0.7$\n$a_2 = 0.1$\n$b_0 = 2$\n$b_1 = 0.5$\n$b_2 = -0.3$\n\n确定系统的总传递函数 $H(z) = Y(z)/X(z)$。", "solution": "问题要求解一个由两个差分方程描述的系统的传递函数 $H(z)$，这两个方程定义了其直接II型结构。传递函数是输出的Z变换 $Y(z)$ 与输入的Z变换 $X(z)$ 之比。我们可以通过先对每个差分方程进行Z变换，然后进行代数组合来求得。\n\n第一个方程关联了中间信号 $w[n]$ 与输入信号 $x[n]$：\n$$w[n] = x[n] - a_1 w[n-1] - a_2 w[n-2]$$\n我们对此方程应用Z变换。利用Z变换的时移特性，即 $\\mathcal{Z}\\{f[n-k]\\} = z^{-k}F(z)$，我们得到：\n$$W(z) = X(z) - a_1 z^{-1} W(z) - a_2 z^{-2} W(z)$$\n现在，我们重新整理这个方程以找到 $W(z)$ 和 $X(z)$ 之间的关系。我们将所有包含 $W(z)$ 的项归到一边：\n$$W(z) + a_1 z^{-1} W(z) + a_2 z^{-2} W(z) = X(z)$$\n将 $W(z)$ 因子提出，我们有：\n$$W(z) (1 + a_1 z^{-1} + a_2 z^{-2}) = X(z)$$\n这使我们能够将 $W(z)$ 与 $X(z)$ 的比率表示为一个传递函数，我们称之为 $H_1(z)$：\n$$H_1(z) = \\frac{W(z)}{X(z)} = \\frac{1}{1 + a_1 z^{-1} + a_2 z^{-2}}$$\n\n接下来，我们考虑第二个方程，它关联了输出信号 $y[n]$ 与中间信号 $w[n]$：\n$$y[n] = b_0 w[n] + b_1 w[n-1] + b_2 w[n-2]$$\n同样，我们应用Z变换及其时移特性：\n$$Y(z) = b_0 W(z) + b_1 z^{-1} W(z) + b_2 z^{-2} W(z)$$\n从右侧提出 $W(z)$ 因子，得到：\n$$Y(z) = W(z) (b_0 + b_1 z^{-1} + b_2 z^{-2})$$\n这定义了从中间信号到输出的传递函数，我们称之为 $H_2(z)$：\n$$H_2(z) = \\frac{Y(z)}{W(z)} = b_0 + b_1 z^{-1} + b_2 z^{-2}$$\n\n总传递函数 $H(z) = Y(z)/X(z)$ 是这两个传递函数的乘积，因为该系统是 $H_1(z)$ 紧跟着 $H_2(z)$ 的级联：\n$$H(z) = \\frac{Y(z)}{X(z)} = \\frac{Y(z)}{W(z)} \\cdot \\frac{W(z)}{X(z)} = H_2(z) H_1(z)$$\n代入 $H_1(z)$ 和 $H_2(z)$ 的表达式：\n$$H(z) = (b_0 + b_1 z^{-1} + b_2 z^{-2}) \\cdot \\left( \\frac{1}{1 + a_1 z^{-1} + a_2 z^{-2}} \\right)$$\n$$H(z) = \\frac{b_0 + b_1 z^{-1} + b_2 z^{-2}}{1 + a_1 z^{-1} + a_2 z^{-2}}$$\n这是直接II型二阶IIR滤波器的传递函数的一般形式。\n\n最后，我们代入给定的系数值：\n$a_1 = -0.7$\n$a_2 = 0.1$\n$b_0 = 2$\n$b_1 = 0.5$\n$b_2 = -0.3$\n\n将这些值代入 $H(z)$ 的通用表达式中：\n$$H(z) = \\frac{2 + (0.5) z^{-1} + (-0.3) z^{-2}}{1 + (-0.7) z^{-1} + (0.1) z^{-2}}$$\n$$H(z) = \\frac{2 + 0.5 z^{-1} - 0.3 z^{-2}}{1 - 0.7 z^{-1} + 0.1 z^{-2}}$$\n这就是系统传递函数的最终闭式表达式。", "answer": "$$\\boxed{\\frac{2 + 0.5z^{-1} - 0.3z^{-2}}{1 - 0.7z^{-1} + 0.1z^{-2}}}$$"}, {"introduction": "在掌握了从结构到传递函数的基本分析之后，让我们来挑战一个更接近工程实践的“逆向工程”问题。在这个练习中，您需要像系统工程师一样，根据观测到的系统行为——即滤波器的脉冲响应——来反向推断其关键的反馈系数 [@problem_id:1714591]。这项实践不仅加深了对差分方程和滤波器系数之间关系的理解，还锻炼了通过实验数据进行系统辨识的实用技能。", "id": "1714591", "problem": "一位工程师的任务是表征一个未知的因果、二阶线性时不变（LTI）数字滤波器。这类滤波器通常使用直接型结构实现，其输入输出关系可以用一个通用的有理传递函数 $H(z)$ 来描述：\n$$H(z) = \\frac{Y(z)}{X(z)} = \\frac{b_0 + b_1 z^{-1} + b_2 z^{-2}}{1 + a_1 z^{-1} + a_2 z^{-2}}$$\n这是一个二阶无限长冲激响应（IIR）滤波器的通用形式。\n\n通过初步分析，该工程师确定该滤波器有一个简单的前馈路径，由系数 $b_0 = 2$、$b_1 = 0$ 和 $b_2 = 0$ 描述。为了确定反馈系数，将一个单位冲激输入（定义为 $x[n] = \\delta[n]$）施加于该滤波器。得到的输出冲激响应 $h[n]$ 的前三个采样点测量值为：\n$h[0] = 2$\n$h[1] = 1.6$\n$h[2] = 0.48$\n\n基于这些信息，确定反馈系数 $a_1$ 和 $a_2$ 的数值。答案应以有序对 $(a_1, a_2)$ 的形式提供。", "solution": "对于一个传递函数为\n$$H(z)=\\frac{Y(z)}{X(z)}=\\frac{b_{0}+b_{1}z^{-1}+b_{2}z^{-2}}{1+a_{1}z^{-1}+a_{2}z^{-2}},$$\n的因果二阶LTI IIR滤波器，其相应的时域差分方程可以通过等式两边同乘以分母并进行z逆变换得到：\n$$y[n]+a_{1}y[n-1]+a_{2}y[n-2]=b_{0}x[n]+b_{1}x[n-1]+b_{2}x[n-2].$$\n已知 $b_{0}=2$、$b_{1}=0$ 和 $b_{2}=0$，上式可简化为\n$$y[n]+a_{1}y[n-1]+a_{2}y[n-2]=2x[n].$$\n在冲激输入 $x[n]=\\delta[n]$ 和零初始条件（因果性和初始静止）下，输出即为冲激响应 $h[n]=y[n]$，它满足\n$$h[n]+a_{1}h[n-1]+a_{2}h[n-2]=2\\delta[n].$$\n使用 $h[-1]=0$ 和 $h[-2]=0$，对 $n=0,1,2$ 求解该递推关系：\n- 对于 $n=0$：\n$$h[0]+a_{1}h[-1]+a_{2}h[-2]=2 \\implies h[0]=2,$$\n与测量值一致。\n- 对于 $n=1$：\n$$h[1]+a_{1}h[0]+a_{2}h[-1]=0 \\implies h[1]+a_{1}h[0]=0 \\implies a_{1}=-\\frac{h[1]}{h[0]}.$$\n使用 $h[1]=1.6=\\frac{8}{5}$ 和 $h[0]=2$，\n$$a_{1}=-\\frac{\\frac{8}{5}}{2}=-\\frac{8}{10}=-\\frac{4}{5}.$$\n- 对于 $n=2$：\n$$h[2]+a_{1}h[1]+a_{2}h[0]=0 \\implies a_{2}=-\\frac{h[2]+a_{1}h[1]}{h[0]}.$$\n使用 $h[2]=0.48=\\frac{12}{25}$、$h[1]=\\frac{8}{5}$ 和 $a_{1}=-\\frac{4}{5}$，\n$$h[2]+a_{1}h[1]=\\frac{12}{25}-\\frac{4}{5}\\cdot\\frac{8}{5}=\\frac{12}{25}-\\frac{32}{25}=-\\frac{20}{25}=-\\frac{4}{5},$$\n因此\n$$a_{2}=-\\frac{-\\frac{4}{5}}{2}=\\frac{4}{5}\\cdot\\frac{1}{2}=\\frac{2}{5}.$$\n因此，反馈系数为 $a_{1}=-\\frac{4}{5}$ 和 $a_{2}=\\frac{2}{5}$。", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{4}{5} & \\frac{2}{5}\\end{pmatrix}}$$"}, {"introduction": "无限脉冲响应（IIR）滤波器的输出不仅取决于当前输入，还受到其内部“记忆”或状态的影响。本练习将带您探索滤波器的内在动态特性，即在没有外部输入信号（零输入）的情况下，仅由存储在延迟单元中的初始条件所产生的响应 [@problem_id:1714608]。通过计算零输入响应，您将深刻体会到IIR滤波器内部状态的重要性，并理解这些状态如何决定系统的固有振荡行为和稳定性。", "id": "1714608", "problem": "数字谐振器是音频合成与滤波中的一个关键组件，它通过一个二阶直接II型结构实现。在此结构中，输入信号 $x[n]$ 首先被处理，根据以下差分方程生成一个中间状态信号 $w[n]$：\n$$w[n] = x[n] + w[n-1] - \\frac{1}{2} w[n-2]$$\n最终输出信号 $y[n]$ 由状态信号通过第二个方程合成：\n$$y[n] = w[n] - w[n-2]$$\n在时间 $n=0$ 时，谐振器的输入被关闭，即对于所有 $n \\ge 0$，$x[n] = 0$。然而，由于先前的活动，滤波器的存储单元（延迟模块）中保留了非零的初始值。具体来说，对应于状态信号的值为 $w[-1] = 1$ 和 $w[-2] = 2$。\n\n你的任务是确定系统在 $n \\ge 0$ 时的输出。这个输出被称为零输入响应 $y_{zi}[n]$。请找出 $y_{zi}[n]$ 在 $n \\ge 0$ 时的闭式表达式。", "solution": "由于对于所有 $n \\ge 0$，$x[n]=0$，状态方程化简为齐次线性常系数差分方程\n$$\nw[n] - w[n-1] + \\frac{1}{2} w[n-2] = 0.\n$$\n其特征方程为\n$$\nr^{2} - r + \\frac{1}{2} = 0,\n$$\n其根为\n$$\nr_{1,2} = \\frac{1 \\pm \\mathrm{i}}{2} = \\rho \\exp(\\pm \\mathrm{i}\\theta), \\quad \\rho = 2^{-1/2}, \\quad \\theta = \\frac{\\pi}{4}.\n$$\n因此其通解为\n$$\nw[n] = \\alpha r_{1}^{n} + \\beta r_{2}^{n}.\n$$\n使用给定的初始状态值，通过递归计算出 $w[0]$ 和 $w[1]$：\n$$\nw[0] = x[0] + w[-1] - \\frac{1}{2} w[-2] = 0 + 1 - \\frac{1}{2}\\cdot 2 = 0,\n$$\n$$\nw[1] = x[1] + w[0] - \\frac{1}{2} w[-1] = 0 + 0 - \\frac{1}{2}\\cdot 1 = -\\frac{1}{2}.\n$$\n代入 $w[0]=0$ 可得 $\\alpha + \\beta = 0 \\Rightarrow \\beta = -\\alpha$。然后\n$$\nw[1] = \\alpha r_{1} + \\beta r_{2} = \\alpha(r_{1} - r_{2}) = -\\frac{1}{2}.\n$$\n由于 $r_{1} - r_{2} = \\mathrm{i}$，可得 $\\alpha \\mathrm{i} = -\\frac{1}{2}$，因此 $\\alpha = \\frac{\\mathrm{i}}{2}$ 且 $\\beta = -\\frac{\\mathrm{i}}{2}$。所以，\n$$\nw[n] = \\frac{\\mathrm{i}}{2}\\left(r_{1}^{n} - r_{2}^{n}\\right) = -\\rho^{n} \\sin(n\\theta) = -2^{-n/2} \\sin\\left(\\frac{\\pi}{4} n\\right).\n$$\n输出为 $y[n] = w[n] - w[n-2]$，所以对于 $n \\ge 0$，\n$$\ny_{zi}[n] = -2^{-n/2} \\sin\\left(\\frac{\\pi}{4} n\\right) + 2^{-(n-2)/2} \\sin\\left(\\frac{\\pi}{4} (n-2)\\right).\n$$\n这就是所求的零输入响应的闭式表达式。", "answer": "$$\\boxed{2^{-(n-2)/2}\\sin\\left(\\frac{\\pi}{4}(n-2)\\right)-2^{-n/2}\\sin\\left(\\frac{\\pi}{4}n\\right)}$$"}]}