{"hands_on_practices": [{"introduction": "理解一个函数最有效的方法之一是分析其关键点。对于凯泽窗而言，其中心点具有特殊的重要性。这个练习将引导你通过一个简单的代数计算，揭示窗函数中心点的参数是如何直接与形状参数 $\\beta$ 关联的，这为你理解窗函数的峰值以及归一化行为奠定了基础。[@problem_id:1732449]", "problem": "一位数字信号处理工程师正在使用窗函数法设计一个I型有限冲激响应（FIR）滤波器。他们选择了Kaiser窗，该窗为一个长度为 $N$ （其中 $N$ 是一个正奇数）和一个形状参数 $\\beta > 0$ 所定义。对于 $0 \\leq n \\leq N-1$ ，窗序列 $w[n]$ 由下式给出：\n$$ w[n] = \\frac{I_0\\left( \\alpha_n \\right)}{I_0(\\beta)} $$\n其中 $I_0(x)$ 是第一类零阶修正贝塞尔函数，其参数 $\\alpha_n$ 由下式给出：\n$$ \\alpha_n = \\beta \\sqrt{1 - \\left(\\frac{2n}{N-1} - 1\\right)^2} $$\n该工程师想要分析窗函数在其中心点的属性。对于给定的奇数长度 $N$ ，窗函数是对称的，其中心样本出现在索引 $n_c = (N-1)/2$ 处。请确定在该中心样本处参数 $\\alpha_n$ 的值，即求出 $\\alpha_{n_c}$ 的值。请用给定的符号参数表示你的答案。", "solution": "我们已知Kaiser窗的参数\n$$\\alpha_{n}=\\beta \\sqrt{1-\\left(\\frac{2n}{N-1}-1\\right)^{2}}.$$\n对于一个奇数长度 $N$，中心索引为 $n_{c}=\\frac{N-1}{2}$。将 $n=n_{c}$ 代入：\n$$\\frac{2n_{c}}{N-1}-1=\\frac{2\\left(\\frac{N-1}{2}\\right)}{N-1}-1=\\frac{N-1}{N-1}-1=1-1=0.$$\n因此，\n$$\\alpha_{n_{c}}=\\beta \\sqrt{1-0^{2}}=\\beta \\sqrt{1}=\\beta.$$", "answer": "$$\\boxed{\\beta}$$", "id": "1732449"}, {"introduction": "在理解了凯撒窗的峰值特性后，我们自然会问：为什么标准公式中要包含分母 $I_0(\\beta)$？这个练习通过一个思想实验，让你对比一个“未归一化”的凯撒窗与标准窗的区别。通过这种对比，你将深刻理解归一化的重要性——它不仅将窗函数的峰值设定为标准的 1，还揭示了这种缩放对频域特性的影响，例如相对旁瓣电平。[@problem_id:1732450]", "problem": "在设计有限脉冲响应 (FIR) 滤波器时，窗函数被用来截断理想的无限长脉冲响应。一种常用的窗函数是 Kaiser 窗，它通过一个参数 $\\beta$ 在主瓣宽度和旁瓣衰减之间提供了一种可控的权衡。对于一个长度为 $L=N+1$ 个样本的窗，Kaiser 窗 $w[n]$ 的标准定义为（其中 $n=0, 1, \\dots, N$）：\n$$w[n] = \\frac{I_0\\left(\\beta \\sqrt{1 - \\left(\\frac{2n-N}{N}\\right)^2}\\right)}{I_0(\\beta)}$$\n这里，$I_0(x)$ 是零阶第一类修正贝塞尔函数，它是一个实偶函数，并且对于实数自变量 $x$ 严格为正。\n\n一位工程师在设计滤波器时，正确地使用了上述标准的 Kaiser 窗公式。一名学生在尝试复现该设计时犯了一个错误，使用了一个简化的、未归一化的窗版本，我们称之为 $w_{mod}[n]$：\n$$w_{mod}[n] = I_0\\left(\\beta \\sqrt{1 - \\left(\\frac{2n-N}{N}\\right)^2}\\right)$$\n假设参数 $\\beta$ 是一个典型的正值（例如 $\\beta > 0$），与工程师正确的窗相比，以下哪个陈述描述了学生错误所导致的最直接和最根本的后果？\n\nA. 窗将不再关于其中心对称。\n\nB. 窗在时域的峰值幅度将不再是 1。\n\nC. 窗的频率响应中主瓣的宽度将显著变窄。\n\nD. 窗的长度（非零样本数）将不正确。\n\nE. 频率响应中的相对旁瓣电平（旁瓣峰值幅度与主瓣峰值幅度之比）将发生显著改变。", "solution": "我们从 $n=0,1,\\dots,N$ 的正确 Kaiser 窗定义开始：\n$$w[n]=\\frac{I_{0}\\!\\left(\\beta\\sqrt{1-\\left(\\frac{2n-N}{N}\\right)^{2}}\\right)}{I_{0}(\\beta)}.$$\n学生修改后的窗省略了归一化：\n$$w_{mod}[n]=I_{0}\\!\\left(\\beta\\sqrt{1-\\left(\\frac{2n-N}{N}\\right)^{2}}\\right).$$\n由于 $I_{0}(x)$ 对于实数 $x$ 是严格为正的，并且是其自变量的偶函数，因此对于 $\\beta>0$，有 $I_{0}(\\beta)>0$，所以 $w[n]$ 中的除法是有定义的。\n\n在中心点 $n=\\frac{N}{2}$ 处计算两个窗的值：\n- 此时，函数的自变量变为\n$$\\beta\\sqrt{1-\\left(\\frac{2(\\frac{N}{2})-N}{N}\\right)^{2}}=\\beta\\sqrt{1-0}=\\beta.$$\n因此，\n$$w\\!\\left[\\tfrac{N}{2}\\right]=\\frac{I_{0}(\\beta)}{I_{0}(\\beta)}=1,$$\n$$w_{mod}\\!\\left[\\tfrac{N}{2}\\right]=I_{0}(\\beta).$$\n对于 $\\beta>0$，$I_{0}(\\beta)>1$，所以 $w_{mod}[n]$ 的峰值幅度超过 1，而正确的 $w[n]$ 被归一化以使峰值为 1。\n\n证明修改后的窗是正确窗的一个常数倍缩放：\n$$w_{mod}[n]=I_{0}(\\beta)\\,w[n].$$\n根据离散时间傅里叶变换 (DTFT) 的线性性质，如果 $W(e^{j\\omega})$ 和 $W_{mod}(e^{j\\omega})$ 分别是 $w[n]$ 和 $w_{mod}[n]$ 的DTFT，则\n$$W_{mod}(e^{j\\omega})=I_{0}(\\beta)\\,W(e^{j\\omega}).$$\n因此：\n- 时域对称性得以保持，因为两者都依赖于 $\\left(\\frac{2n-N}{N}\\right)^{2}$，而一个正的标量因子不影响对称性。因此选项 A 是错误的。\n- 频率响应的主瓣宽度不因常数缩放而改变。因此选项 C 是错误的。\n- 窗的长度（非零样本数）没有改变，因为索引范围 $n=0,\\dots,N$ 是相同的。因此选项 D 是错误的。\n- 相对旁瓣电平，定义为旁瓣峰值幅度与主瓣峰值幅度之比，也没有改变，因为分子和分母都被同一个常数 $I_{0}(\\beta)$ 缩放。因此选项 E 是错误的。\n\n省略归一化最直接和最根本的后果是，时域峰值幅度不再是 1，这对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "1732450"}, {"introduction": "掌握了凯撒窗的时域和频域基本特性后，是时候将其应用于实际的工程决策中了。本练习模拟了一个音频工程师面临的典型挑战：在两个非常接近的音调中进行分辨。你的选择将直接取决于你对凯撒窗核心设计权衡的理解，即形状参数 $\\beta$ 如何控制主瓣宽度（决定频率分辨率）与旁瓣衰减（决定频谱泄漏）之间的平衡。[@problem_id:1732452]", "problem": "一位音频工程师正在使用一个数字信号处理（DSP）系统来分析一段复杂的音频录音。其目标是识别同时播放的两个非常相似的音调的精确频率。为此，该工程师在进行傅里叶变换之前，对音频信号的短分段应用一个窗函数。区分两个紧密间隔频率的能力被称为频率分辨率。\n\n该系统使用凯泽窗，对于长度为$N$和非负形状参数$\\beta$，其定义如下：\n$$\nw[n] = \\frac{I_0\\left(\\beta \\sqrt{1 - \\left(\\frac{2n}{N-1}\\right)^2}\\right)}{I_0(\\beta)}, \\quad \\text{对于 } -\\frac{N-1}{2} \\le n \\le \\frac{N-1}{2}\n$$\n其中$I_0(x)$是第一类修正零阶贝塞尔函数。\n\n该工程师的内存缓冲区是固定的，因此在所有分析中窗长$N$是恒定的。然而，他们可以为形状参数选择两种预设之一：\n- **窗A：** $\\beta_A = 3.5$\n- **窗B：** $\\beta_B = 7.5$\n\n为了获得尽可能高的频率分辨率，从而最好地区分这两个相似的音调，该工程师应该选择哪个窗函数？其正确的理由是什么？\n\nA. 窗A，因为较小的$\\beta$值导致主瓣更窄。\n\nB. 窗B，因为较大的$\\beta$值导致主瓣更窄。\n\nC. 窗A，因为较小的$\\beta$值导致更大的旁瓣衰减。\n\nD. 窗B，因为它提供了更好的频谱泄漏抑制，而这总是理想的。\n\nE. 选择无关紧要，因为只有窗长$N$影响频率分辨率。", "solution": "将频率分辨率定义为：在加窗和傅里叶分析后，区分角频率为$\\omega_{1}$和$\\omega_{2}$的两个正弦波的能力。如果信号$x[n]$被$w[n]$加窗，加窗后信号的频谱是原始频谱与窗函数变换的卷积：\n$$\nX_{w}(\\omega) = X(\\omega) * W(\\omega).\n$$\n对于这两个音调，$X(\\omega)$是位于$\\omega_{1}$和$\\omega_{2}$处的冲激之和，因此$X_{w}(\\omega)$是$W(\\omega)$的移位副本之和，分别以$\\omega_{1}$和$\\omega_{2}$为中心。当频率间隔\n$$\n\\Delta \\omega \\equiv |\\omega_{2}-\\omega_{1}|\n$$\n超过$W(\\omega)$的一个特征主瓣宽度（例如，第一零点间宽度或半功率宽度）时，这两个音调是可分辨的。因此，对于固定的窗长$N$，更高的频率分辨率要求$W(\\omega)$的主瓣更窄：\n$$\n\\text{最大化分辨率} \\;\\Longleftrightarrow\\; \\text{最小化 } \\Delta \\omega_{\\text{main}}(\\beta,N).\n$$\n\n对于固定长度$N$和形状参数$\\beta \\ge 0$的凯泽窗，存在一个众所周知的单调权衡关系：\n- 随着$\\beta$增加，旁瓣衰减增加（旁瓣电平降低）。\n- 随着$\\beta$增加，主瓣宽度增加。等价地，\n$$\n\\frac{\\partial}{\\partial \\beta}\\,\\Delta \\omega_{\\text{main}}(\\beta,N) > 0,\\qquad \\frac{\\partial}{\\partial \\beta}\\,A_{\\text{sl}}(\\beta) > 0,\n$$\n其中$A_{\\text{sl}}$表示旁瓣衰减。\n\n因此，在$N$固定的情况下，要最小化$\\Delta \\omega_{\\text{main}}(\\beta,N)$，需要选择较小的$\\beta$。在两个预设值$\\beta_{A}=3.5$和$\\beta_{B}=7.5$之间，我们有\n$$\n\\Delta \\omega_{\\text{main}}(\\beta_{A},N) < \\Delta \\omega_{\\text{main}}(\\beta_{B},N),\n$$\n所以窗A产生更窄的主瓣，从而获得更高的频率分辨率。\n\n评估各个选项：\n- A是正确的：较小的$\\beta$产生更窄的主瓣，从而提高分辨率。\n- B是错误的：较大的$\\beta$会加宽主瓣。\n- C是错误的：较小的$\\beta$不会增加旁瓣衰减，反而会降低它。\n- D具有误导性：虽然较大的$\\beta$会抑制旁瓣（减少泄漏），但它会加宽主瓣，并可能降低区分紧密间隔音调的能力；对于所陈述的分辨率目标而言，“总是理想的”这种说法是不正确的。\n- E是错误的：尽管$N$对分辨率有很大影响，但窗的形状（通过$\\beta$）会改变主瓣宽度，从而改变在$N$固定时的有效分辨率。\n\n因此，根据关于主瓣宽度和频率分辨率的既定推理，正确的选择是窗A。", "answer": "$$\\boxed{A}$$", "id": "1732452"}]}