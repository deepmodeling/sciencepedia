{"hands_on_practices": [{"introduction": "第一个练习旨在巩固巴特利特窗的基础知识。通过直接应用其定义公式，您将亲手计算一个三角窗函数的系数，并将其逐点乘以一个离散信号。这个基本操作是信号处理中抑制频谱泄漏的第一步，也是理解更复杂窗函数应用的基石 [@problem_id:1699596]。", "problem": "在数字信号处理中，窗函数常被应用于有限长度信号，以减少在进行傅里叶变换时的频谱泄漏。考虑一个有限长度离散时间信号 $x[n]$，该信号由序列 $\\{1, 2, 3, 2, 1\\}$ 定义，分别对应 $n = 0, 1, 2, 3, 4$，且对于所有其他的 $n$ 值，$x[n]=0$。\n\n该信号将与一个5点因果Bartlett（三角）窗 $w[n]$ 相乘。长度为 $N$ 的因果Bartlett窗的通用公式如下：\n$$w[n] = 1 - \\frac{2 \\left| n - \\frac{N-1}{2} \\right|}{N-1}$$\n其中整数 $n$ 的范围是 $0 \\le n \\le N-1$。\n\n得到的加窗信号 $y[n]$ 是输入信号和窗函数的逐点乘积，即 $y[n] = x[n] \\cdot w[n]$。\n\n确定在区间 $n=0, 1, 2, 3, 4$ 上 $y[n]$ 的输出序列。将你的答案以单行数字序列的形式给出，分别对应 $y[0], y[1], y[2], y[3], y[4]$ 的值。", "solution": "给定一个有限长度信号 $x[n]$，其中 $x[0]=1$, $x[1]=2$, $x[2]=3$, $x[3]=2$, $x[4]=1$，其他情况下 $x[n]=0$。以及一个5点因果Bartlett窗 $w[n]$，其在 $0 \\leq n \\leq N-1$ 上的定义为\n$$\nw[n] = 1 - \\frac{2 \\left| n - \\frac{N-1}{2} \\right|}{N-1}.\n$$\n对于 $N=5$，我们有 $N-1=4$ 和 $\\frac{N-1}{2}=2$，所以\n$$\nw[n] = 1 - \\frac{2 |n-2|}{4} = 1 - \\frac{|n-2|}{2}, \\quad n=0,1,2,3,4.\n$$\n计算每个 $n$ 对应的 $w[n]$ 值：\n- 当 $n=0$ 时：$|0-2|=2 \\Rightarrow w[0] = 1 - \\frac{2}{2} = 0$。\n- 当 $n=1$ 时：$|1-2|=1 \\Rightarrow w[1] = 1 - \\frac{1}{2} = \\frac{1}{2}$。\n- 当 $n=2$ 时：$|2-2|=0 \\Rightarrow w[2] = 1 - 0 = 1$。\n- 当 $n=3$ 时：$|3-2|=1 \\Rightarrow w[3] = 1 - \\frac{1}{2} = \\frac{1}{2}$。\n- 当 $n=4$ 时：$|4-2|=2 \\Rightarrow w[4] = 1 - \\frac{2}{2} = 0$。\n\n加窗信号为 $y[n] = x[n] w[n]$。计算每个值：\n- $y[0] = 1 \\cdot 0 = 0$。\n- $y[1] = 2 \\cdot \\frac{1}{2} = 1$。\n- $y[2] = 3 \\cdot 1 = 3$。\n- $y[3] = 2 \\cdot \\frac{1}{2} = 1$。\n- $y[4] = 1 \\cdot 0 = 0$。\n\n因此，在 $n=0,1,2,3,4$ 上的输出序列是 $(0, 1, 3, 1, 0)$。", "answer": "$$\\boxed{\\begin{pmatrix}0 & 1 & 3 & 1 & 0\\end{pmatrix}}$$", "id": "1699596"}, {"introduction": "在时域操作的基础上，本练习将带您进入频域，探索巴特利特窗的光谱特性。通过一个巧妙的思路——将巴特利特窗视为两个矩形窗的卷积——我们可以轻松地分析其傅里叶变换。这个练习将帮助您理解如何预测其频谱中的零点位置，这对于控制滤波器阻带衰减至关重要 [@problem_id:1699567]。", "problem": "在数字信号处理中，窗函数用于对信号进行锥化处理，以减少频谱泄露。一类因果的类三角窗函数 $w[n]$，可以通过两个因果矩形脉冲序列的卷积生成。\n\n设 $w_{r1}[n]$ 为一个长度为整数 $L_1 \\geq 1$ 的因果矩形脉冲，定义如下：\n$$ w_{r1}[n] = \\begin{cases} 1 & \\text{for } 0 \\le n \\le L_1-1 \\\\ 0 & \\text{otherwise} \\end{cases} $$\n并设 $w_{r2}[n]$ 为第二个长度为整数 $L_2 \\geq 1$ 的因果矩形脉冲，其定义与 $w_{r1}[n]$ 类似。\n\n所得的类三角窗 $w[n]$ 是它们的卷积，$w[n] = (w_{r1} * w_{r2})[n]$。该窗的总长度为 $N = L_1 + L_2 - 1$。\n\n窗函数 $w[n]$ 的 $N$ 点离散傅里叶变换 (DFT) 由下式给出：\n$$ W[k] = \\sum_{n=0}^{N-1} w[n] \\exp\\left(-j \\frac{2\\pi nk}{N}\\right) $$\n其中 $k = 0, 1, \\dots, N-1$。\n\n你的任务是，找到一个最小的整数长度 $N > 3$，使得可以选择整数长度 $L_1$ 和 $L_2$，让窗函数的 $N$ 点 DFT 幅度 $|W[k]|$ 在频率点索引 $k=2$ 处精确为零。", "solution": "我们构成窗函数 $w[n]=(w_{r1}*w_{r2})[n]$，其中 $w_{r1}[n]$ 和 $w_{r2}[n]$ 分别是长度为整数 $L_{1}\\geq 1$ 和 $L_{2}\\geq 1$ 的因果矩形脉冲。线性卷积的长度为 $N=L_{1}+L_{2}-1$。当 $N\\geq L_{1}+L_{2}-1$（此处为等式）时，线性卷积的 $N$ 点 DFT 等于各补零因子 $N$ 点 DFT 的逐点乘积：\n$$\nW[k]=W_{r1}[k]\\,W_{r2}[k]\\quad\\text{for}\\quad k=0,1,\\dots,N-1.\n$$\n\n对于一个长度为 $L$ 的因果矩形脉冲，其在频率点 $k$ 处的 $N$ 点 DFT 是一个有限几何级数求和\n$$\nW_{r}[k]=\\sum_{n=0}^{L-1}\\exp\\!\\left(-j\\frac{2\\pi nk}{N}\\right)\n=\\exp\\!\\left(-j\\pi\\frac{(L-1)k}{N}\\right)\\,\\frac{\\sin\\!\\left(\\pi \\frac{Lk}{N}\\right)}{\\sin\\!\\left(\\pi \\frac{k}{N}\\right)},\n$$\n其中，该比率形式由有限几何级数的标准恒等式得出。因此，\n$$\n|W_{r}[k]|=0\\quad\\Longleftrightarrow\\quad \\sin\\!\\left(\\pi \\frac{Lk}{N}\\right)=0\\quad\\text{and}\\quad \\sin\\!\\left(\\pi \\frac{k}{N}\\right)\\neq 0.\n$$\n对于 $k=2$ 和 $N>2$ 的情况，分母 $\\sin\\!\\left(\\pi \\frac{2}{N}\\right)\\neq 0$，因此 $|W_{r}[2]|=0$ 当且仅当\n$$\n\\pi \\frac{2L}{N}=m\\pi\\quad\\text{for some integer }m\\neq 0\\quad\\Longleftrightarrow\\quad N \\mid 2L.\n$$\n\n由于 $W[2]=W_{r1}[2]\\,W_{r2}[2]$，我们有 $|W[2]|=0$ 当且仅当 $W_{r1}[2]$ 或 $W_{r2}[2]$ 中至少有一个为零，即当且仅当 $N$ 整除 $2L_{1}$ 或 $N$ 整除 $2L_{2}$。我们必须选择整数 $L_{1},L_{2}\\geq 1$，使得 $N=L_{1}+L_{2}-1$ 并且满足 $N\\mid 2L_{1}$ 或 $N\\mid 2L_{2}$。\n\n一个对任何 $N$ 都适用的通用构造方法是：选择 $L_{1}=N$ 和 $L_{2}=1$。这样 $N=L_{1}+L_{2}-1$ 成立，并且因为 $2L_{1}=2N$，所以 $N\\mid 2L_{1}$ 直接成立。因此 $W_{r1}[2]=0$，从而 $W[2]=0$。因此，对于每个整数 $N>3$ 这都是可能的，而最小的此类 $N$ 是通过取大于3的最小整数得到的，即 $N=4$。\n\n为了完整起见，给出一个 $N=4$ 时的非退化例子：$L_{1}=3$，$L_{2}=2$（此时仍然有 $L_{1}+L_{2}-1=4$）。此时，由于 $2L_{2}=4$，有 $4\\mid 2L_{2}$，这使得 $W_{r2}[2]=0$，从而 $W[2]=0$。因此，$N=4$ 确实是可行且最小的。", "answer": "$$\\boxed{4}$$", "id": "1699567"}, {"introduction": "最后的实践将巴特利特窗置于一个更实际的系统背景中：作为有限冲激响应（FIR）滤波器的系数。您将分析当输入信号为白噪声时，该滤波器的输出功率。这个练习连接了窗函数的理论属性与其在统计信号处理中的实际性能表现，展示了如何量化滤波器对随机信号的影响 [@problem_id:1699598]。", "problem": "一个数字信号处理系统被设计用于分析一个含噪数据流。该系统的输入 $x[n]$ 被建模为一系列不相关的随机变量，代表离散时间白噪声。该噪声过程的均值为零，方差为一。\n\n信号 $x[n]$ 由一个有限脉冲响应（FIR）滤波器处理。该滤波器的脉冲响应，记为 $h[n]$，由一个长度为奇数 $N > 1$ 的 Bartlett（三角）窗定义。脉冲响应的系数由以下公式给出：\n$$h[n] = 1 - \\frac{2\\left|n - \\frac{N-1}{2}\\right|}{N-1}, \\quad \\text{for } n = 0, 1, \\dots, N-1$$\n其他情况下 $h[n] = 0$。\n\n确定滤波器输出信号 $y[n]$ 的总平均功率。请用关于滤波器长度 $N$ 的闭式解析表达式表示你的答案。", "solution": "一个脉冲响应为 $h[n]$ 的线性时不变（LTI）系统的输出信号 $y[n]$，由输入信号 $x[n]$ 与 $h[n]$ 的卷积给出，即 $y[n] = x[n] * h[n] = \\sum_{k=-\\infty}^{\\infty} h[k]x[n-k]$。\n\n输出信号的总平均功率 $P_y$ 定义为其幅值平方的期望值，即 $P_y = E\\left[|y[n]|^2\\right]$。由于滤波器的脉冲响应 $h[n]$ 是实值的，输出 $y[n]$ 也是实值的，因此 $P_y = E\\left[y[n]^2\\right]$。\n\n将 $y[n]$ 的卷积和代入：\n$$P_y = E\\left[ \\left( \\sum_{k=0}^{N-1} h[k]x[n-k] \\right) \\left( \\sum_{l=0}^{N-1} h[l]x[n-l] \\right) \\right]$$\n$$P_y = E\\left[ \\sum_{k=0}^{N-1} \\sum_{l=0}^{N-1} h[k]h[l]x[n-k]x[n-l] \\right]$$\n根据期望的线性性质，我们可以将期望算子移到求和符号内：\n$$P_y = \\sum_{k=0}^{N-1} \\sum_{l=0}^{N-1} h[k]h[l]E[x[n-k]x[n-l]]$$\n项 $E[x[n-k]x[n-l]]$ 是输入信号的自相关，即 $R_{xx}[(n-k)-(n-l)] = R_{xx}[l-k]$。\n\n输入 $x[n]$ 是均值为零、方差为一的白噪声。这意味着其自相关函数为 $R_{xx}[m] = \\sigma_x^2 \\delta[m] = 1 \\cdot \\delta[m]$，其中 $\\delta[m]$ 是克罗内克 delta 函数。\n因此，$E[x[n-k]x[n-l]] = \\delta[l-k]$。输出功率的表达式得到显著简化，因为该项仅在 $l=k$ 时非零：\n$$P_y = \\sum_{k=0}^{N-1} \\sum_{l=0}^{N-1} h[k]h[l]\\delta[l-k] = \\sum_{k=0}^{N-1} h[k]h[k] = \\sum_{k=0}^{N-1} h[k]^2$$\n此结果表明，对于单位方差的白噪声输入，输出功率等于滤波器脉冲响应的能量。\n\n现在我们必须使用给定的 $h[n]$ 表达式来计算这个和。由于 $N$ 被指定为大于1的奇数，我们可以定义一个整数 $M = \\frac{N-1}{2}$，其中 $M \\ge 1$。脉冲响应可以写为：\n$$h[n] = 1 - \\frac{|n - M|}{M}, \\quad \\text{for } n = 0, 1, \\dots, 2M$$\n功率的和为：\n$$P_y = \\sum_{n=0}^{2M} \\left( 1 - \\frac{|n - M|}{M} \\right)^2$$\n这个和关于中心点 $n=M$ 对称。我们可以通过分离中心项（$n=M$）并合并中心周围的对称项对来重写它。\n$$P_y = \\left( h[M] \\right)^2 + \\sum_{n=0}^{M-1} \\left(h[n]\\right)^2 + \\sum_{n=M+1}^{2M} \\left(h[n]\\right)^2$$\n由于对称性，$h[n] = h[2M-n]$。因此，这两个和相等。\n$$P_y = \\left( h[M] \\right)^2 + 2\\sum_{n=0}^{M-1} \\left(h[n]\\right)^2$$\n在中心点 $n=M$ 处，我们有 $h[M] = 1 - \\frac{|M - M|}{M} = 1$。\n对于 $n < M$，我们有 $|n-M| = M-n$，因此 $h[n] = 1 - \\frac{M-n}{M} = \\frac{n}{M}$。\n将这些代入功率方程：\n$$P_y = 1^2 + 2\\sum_{n=0}^{M-1} \\left( \\frac{n}{M} \\right)^2 = 1 + \\frac{2}{M^2} \\sum_{n=0}^{M-1} n^2$$\n求和从 $n=0$ 开始，但第一项是 $0^2=0$，所以我们可以从 $n=1$ 开始求和：\n$$P_y = 1 + \\frac{2}{M^2} \\sum_{n=1}^{M-1} n^2$$\n我们使用前 $m$ 个平方和的标准公式：$\\sum_{k=1}^{m} k^2 = \\frac{m(m+1)(2m+1)}{6}$。这里，$m=M-1$。\n$$P_y = 1 + \\frac{2}{M^2} \\left[ \\frac{(M-1)((M-1)+1)(2(M-1)+1)}{6} \\right]$$\n$$P_y = 1 + \\frac{2}{M^2} \\left[ \\frac{(M-1)M(2M-1)}{6} \\right] = 1 + \\frac{(M-1)(2M-1)}{3M}$$\n现在，我们用公分母 $3M$ 合并各项：\n$$P_y = \\frac{3M + (M-1)(2M-1)}{3M} = \\frac{3M + (2M^2 - 3M + 1)}{3M} = \\frac{2M^2 + 1}{3M}$$\n最后，我们代回 $M = \\frac{N-1}{2}$：\n$$P_y = \\frac{2\\left(\\frac{N-1}{2}\\right)^2 + 1}{3\\left(\\frac{N-1}{2}\\right)} = \\frac{2\\frac{(N-1)^2}{4} + 1}{\\frac{3(N-1)}{2}} = \\frac{\\frac{(N-1)^2}{2} + 1}{\\frac{3(N-1)}{2}}$$\n将分子和分母同乘以2，得到最终表达式：\n$$P_y = \\frac{(N-1)^2 + 2}{3(N-1)}$$\n这就是输出信号的总平均功率作为 $N$ 的函数。", "answer": "$$\\boxed{\\frac{(N-1)^{2} + 2}{3(N-1)}}$$", "id": "1699598"}]}