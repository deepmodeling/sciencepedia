{"hands_on_practices": [{"introduction": "在信号处理和控制系统设计中，我们常常通过连接更简单的子系统来构建复杂的系统。本练习探讨最基本的一种连接方式——串联或“级联”结构。通过分析两个级联的一阶系统，你将实践如何从各个模块的差分方程推导出整个系统的传递函数$H(z)$。掌握这一技能是分析模块化设计的基石，它能帮助你理解单个组件的行为如何共同决定了系统的整体响应。[@problem_id:1756424]", "problem": "一个数字信号处理系统通过将两个更简单的离散时间线性时不变 (LTI) 子系统（标记为系统1和系统2）串联来设计。系统1的输出作为系统2的输入。\n\n系统1的输入-输出关系由以下差分方程描述：\n$$y_1[n] = x[n] + \\alpha y_1[n-1]$$\n其中 $x[n]$ 是系统1的输入信号，$y_1[n]$ 是其输出。\n\n系统2的输入-输出关系由以下差分方程描述：\n$$y[n] = y_1[n] - \\gamma y_1[n-1] + \\beta y[n-1]$$\n其中 $y_1[n]$ 是系统2的输入，$y[n]$ 是整个系统的最终输出。\n\n参数 $\\alpha$、$\\beta$ 和 $\\gamma$ 是表征子系统行为的实值非零常数。\n\n确定复合系统的总传递函数 $H(z) = \\frac{Y(z)}{X(z)}$。将您的答案表示为关于 $z^{-1}$ 幂次的有理函数。", "solution": "我们考虑两个串联的离散时间LTI系统，因此总传递函数等于各个传递函数的乘积。这源于LTI系统的级联特性：如果 $H_{1}(z) = \\frac{Y_{1}(z)}{X(z)}$ 且 $H_{2}(z) = \\frac{Y(z)}{Y_{1}(z)}$，那么 $H(z) = \\frac{Y(z)}{X(z)} = H_{2}(z)H_{1}(z)$。\n\n首先，推导系统1的 $H_{1}(z)$。其差分方程为\n$$\ny_{1}[n] = x[n] + \\alpha y_{1}[n-1]\n$$\n在初始静止条件下进行z变换，并利用时移特性 $Z\\{y[n-k]\\} = z^{-k}Y(z)$，\n$$\nY_{1}(z) = X(z) + \\alpha z^{-1} Y_{1}(z)\n$$\n整理得，\n$$\nY_{1}(z)\\left(1 - \\alpha z^{-1}\\right) = X(z)\n$$\n因此\n$$\nH_{1}(z) = \\frac{Y_{1}(z)}{X(z)} = \\frac{1}{1 - \\alpha z^{-1}}\n$$\n\n接下来，推导系统2的 $H_{2}(z)$。其差分方程为\n$$\ny[n] = y_{1}[n] - \\gamma y_{1}[n-1] + \\beta y[n-1]\n$$\n在初始静止条件下进行z变换，\n$$\nY(z) = Y_{1}(z) - \\gamma z^{-1} Y_{1}(z) + \\beta z^{-1} Y(z)\n$$\n整理得，\n$$\nY(z)\\left(1 - \\beta z^{-1}\\right) = Y_{1}(z)\\left(1 - \\gamma z^{-1}\\right)\n$$\n因此\n$$\nH_{2}(z) = \\frac{Y(z)}{Y_{1}(z)} = \\frac{1 - \\gamma z^{-1}}{1 - \\beta z^{-1}}\n$$\n\n根据级联特性，总传递函数为\n$$\nH(z) = H_{2}(z)H_{1}(z) = \\frac{1 - \\gamma z^{-1}}{1 - \\beta z^{-1}} \\cdot \\frac{1}{1 - \\alpha z^{-1}} = \\frac{1 - \\gamma z^{-1}}{\\left(1 - \\beta z^{-1}\\right)\\left(1 - \\alpha z^{-1}\\right)}\n$$\n将分母展开成 $z^{-1}$ 的幂次形式，\n$$\n\\left(1 - \\beta z^{-1}\\right)\\left(1 - \\alpha z^{-1}\\right) = 1 - \\left(\\alpha + \\beta\\right) z^{-1} + \\alpha \\beta z^{-2}\n$$\n因此，\n$$\nH(z) = \\frac{1 - \\gamma z^{-1}}{1 - \\left(\\alpha + \\beta\\right) z^{-1} + \\alpha \\beta z^{-2}}\n$$", "answer": "$$\\boxed{\\frac{1 - \\gamma z^{-1}}{1 - \\left(\\alpha + \\beta\\right) z^{-1} + \\alpha \\beta z^{-2}}}$$", "id": "1756424"}, {"introduction": "了解了如何组合系统模块之后，我们现在将目光投向系统内部。这个练习提供了一个由内部状态变量定义的特定实现结构（此处为转置直接型结构）。你的任务是进行反向工程，从这个结构图中推导出描述系统行为的单一输入输出差分方程。这项实践旨在培养一项关键技能：将给定的电路或框图转化为其等效的数学模型，这是连接理论与实践的重要桥梁。[@problem_id:1756406]", "problem": "一个因果、离散时间的线性时不变（LTI）系统通过一组耦合方程描述的计算结构实现。这些方程关联了输入序列 $x[n]$、输出序列 $y[n]$ 以及两个内部状态序列 $s_1[n]$ 和 $s_2[n]$。这些关系对所有整数 $n$ 定义如下：\n\n1.  $y[n] = s_1[n] + b_0 x[n]$\n2.  $s_1[n] = s_2[n-1] + b_1 x[n-1] - a_1 y[n-1]$\n3.  $s_2[n] = b_2 x[n-1] - a_2 y[n-1]$\n\n该系统由恒定的实值系数 $a_1, a_2, b_0, b_1, b_2$ 表征。\n\n你的任务是消去内部状态序列 $s_1[n]$ 和 $s_2[n]$，以找到直接描述该系统输入-输出关系的单一差分方程。将你的最终答案表示为用过去的输出值（即 $y[n-k]$，其中 $k>0$）以及当前和过去的输入值（即 $x[n-k]$，其中 $k \\ge 0$）表示的 $y[n]$ 的表达式。", "solution": "我们从给定的耦合方程开始：\n$$y[n]=s_{1}[n]+b_{0}x[n]$$\n$$s_{1}[n]=s_{2}[n-1]+b_{1}x[n-1]-a_{1}y[n-1]$$\n$$s_{2}[n]=b_{2}x[n-1]-a_{2}y[n-1]$$\n\n首先，从输出方程中表示出 $s_{1}[n]$：\n$$s_{1}[n]=y[n]-b_{0}x[n]$$\n\n将此式与第二个方程中 $s_{1}[n]$ 的表达式相等：\n$$y[n]-b_{0}x[n]=s_{2}[n-1]+b_{1}x[n-1]-a_{1}y[n-1]$$\n\n接下来，通过将第三个方程移位一个时间步长来得到 $s_{2}[n-1]$：\n$$s_{2}[n-1]=b_{2}x[n-2]-a_{2}y[n-2]$$\n\n将此式代入前一个关系式：\n$$y[n]-b_{0}x[n]=\\bigl(b_{2}x[n-2]-a_{2}y[n-2]\\bigr)+b_{1}x[n-1]-a_{1}y[n-1]$$\n\n最后，解出 $y[n]$，得到单一的输入-输出差分方程：\n$$y[n]=-a_{1}y[n-1]-a_{2}y[n-2]+b_{0}x[n]+b_{1}x[n-1]+b_{2}x[n-2]$$", "answer": "$$\\boxed{y[n]=-a_{1}y[n-1]-a_{2}y[n-2]+b_{0}x[n]+b_{1}x[n-1]+b_{2}x[n-2]}$$", "id": "1756406"}, {"introduction": "最后一个练习将引导你进入更深层次的分析，揭示系统实现方式的深远影响。对于完全相同的传递函数$H(z)$，不同的实现结构（如直接II型、转置直接II型、并行型）可能具有截然不同的内部特性。本练习通过一个存在极零点对消的例子，探讨了可控性和可观测性的概念，展示了传递函数中看似无害的对消如何在某些非最小实现中，表现为无法从外部控制或观测的“隐藏模式”。[@problem_id:1756417]", "problem": "考虑一个因果、线性时不变（LTI）系统，由以下二阶线性常系数差分方程（LCCDE）描述：\n$$y[n] - (\\alpha + \\beta)y[n-1] + \\alpha\\beta y[n-2] = x[n-1] - \\alpha x[n-2]$$\n其中 $x[n]$ 是输入，$y[n]$ 是输出。参数 $\\alpha$ 和 $\\beta$ 是不相等的非零实常数。\n\n该 LCCDE 对应于一个存在极零点对消的传递函数 $H(z)$。我们希望分析这种对消对系统不同状态空间实现（realization）的性质所产生的影响。我们将考虑三种标准的二阶（即非最小）实现，它们都由以下状态空间模型表示：\n$$\n\\begin{align*}\n\\mathbf{s}[n+1] &= A\\mathbf{s}[n] + Bx[n] \\\\\ny[n] &= C\\mathbf{s}[n] + Dx[n]\n\\end{align*}\n$$\n\n这三种实现定义如下：\n1.  **直接II型（Direct Form II）：** 状态矩阵 $A$ 是直接从 $H(z)$ 的分母系数导出的伴随矩阵（companion matrix）的实现。\n2.  **转置直接II型（Transposed Direct Form II）：** 其模型矩阵 $(A_T, B_T, C_T, D_T)$ 分别是直接II型矩阵 $(A, C, B, D)$ 的转置，即 $A_T = A^T$，$B_T = C^T$，$C_T = B^T$ 和 $D_T = D$。\n3.  **并联型（Parallel Form）：** 通过对传递函数 $H(z)$ 进行部分分式展开而构建的实现。这会得到一个对角状态矩阵 $A = \\mathrm{diag}(\\alpha, \\beta)$。对于本问题，假设其具有特定结构，即输入被馈送到每个并联支路（$B = [1, 1]^T$），并且各支路的输出由留数（residue）加权并求和（$C$ 是留数的行向量）。\n\n以下哪个陈述正确描述了这三种非最小二阶状态空间实现的可控性（controllability）和可观测性（observability）？\n\nA. 直接II型实现不可控，转置直接II型不可观测，并联型实现不可控。\n\nB. 直接II型实现不可观测，转置直接II型不可控，并联型实现不可观测。\n\nC. 所有三种实现都是最小实现，因此既可控又可观测。\n\nD. 直接II型实现不可观测，转置直接II型不可控，并联型实现不可控。\n\nE. 所有三种实现都不可观测。\n\nF. 所有三种实现都不可控。", "solution": "从给定的 LCCDE 开始\n$$y[n] - (\\alpha + \\beta)y[n-1] + \\alpha\\beta y[n-2] = x[n-1] - \\alpha x[n-2]$$\n在零初始条件下取 $z$ 变换：\n$$Y(z) - (\\alpha + \\beta)z^{-1}Y(z) + \\alpha\\beta z^{-2}Y(z) = z^{-1}X(z) - \\alpha z^{-2}X(z)$$\n因此传递函数为\n$$H(z) \\triangleq \\frac{Y(z)}{X(z)} = \\frac{z^{-1} - \\alpha z^{-2}}{1 - (\\alpha + \\beta)z^{-1} + \\alpha\\beta z^{-2}}$$\n分子和分母同乘以 $z^{2}$ 得\n$$H(z) = \\frac{z - \\alpha}{z^{2} - (\\alpha + \\beta)z + \\alpha\\beta} = \\frac{z - \\alpha}{(z - \\alpha)(z - \\beta)} = \\frac{1}{z - \\beta} = \\frac{z^{-1}}{1 - \\beta z^{-1}}$$\n因此，最小系统是一阶的，其单极点位于 $z=\\beta$，而位于 $z=\\alpha$ 的极点与一个零点对消。任何二阶实现都必然是非最小的，包含一个在 $z=\\alpha$ 处的不可观测或不可控模式。\n\n**直接II型（DFII）**。使用标准的DFII规范型实现对于\n$$\\frac{b_{0} + b_{1} z^{-1} + b_{2} z^{-2}}{1 + a_{1} z^{-1} + a_{2} z^{-2}}$$\n其中 $a_{1} = -(\\alpha + \\beta)$，$a_{2} = \\alpha\\beta$，$b_{0} = 0$，$b_{1} = 1$，$b_{2} = -\\alpha$。DFII 的矩阵为\n$$A = \\begin{pmatrix} 0 & 1 \\\\ -a_{2} & -a_{1} \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ -\\alpha\\beta & \\alpha + \\beta \\end{pmatrix},\\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$$\n$$C = \\begin{pmatrix} b_{2} - a_{2} b_{0} & b_{1} - a_{1} b_{0} \\end{pmatrix} = \\begin{pmatrix} -\\alpha & 1 \\end{pmatrix},\\quad D = b_{0} = 0$$\n可观测性：可观测性矩阵为\n$$\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\end{pmatrix} = \\begin{pmatrix} -\\alpha & 1 \\\\ -\\alpha\\beta & \\beta \\end{pmatrix},\\quad \\det(\\mathcal{O}) = (-\\alpha)\\beta - 1\\cdot(-\\alpha\\beta) = 0$$\n所以秩为1，该实现是不可观测的。\n可控性：可控性矩阵为\n$$\\mathcal{C} = \\begin{pmatrix} B & AB \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ 1 & \\alpha + \\beta \\end{pmatrix},\\quad \\det(\\mathcal{C}) = -1 \\neq 0$$\n所以秩为2，该实现是可控的。\n\n**转置直接II型（TDFII）**。根据定义 $A_{T} = A^{T}$，$B_{T} = C^{T}$，$C_{T} = B^{T}$，$D_{T} = D$。具体地，\n$$A_{T} = \\begin{pmatrix} 0 & -\\alpha\\beta \\\\ 1 & \\alpha + \\beta \\end{pmatrix},\\quad B_{T} = \\begin{pmatrix} -\\alpha \\\\ 1 \\end{pmatrix},\\quad C_{T} = \\begin{pmatrix} 0 & 1 \\end{pmatrix},\\quad D_{T} = 0$$\n可控性：\n$$\\mathcal{C}_{T} = \\begin{pmatrix} B_{T} & A_{T}B_{T} \\end{pmatrix} = \\begin{pmatrix} -\\alpha & -\\alpha\\beta \\\\ 1 & \\beta \\end{pmatrix},\\quad \\det(\\mathcal{C}_{T}) = (-\\alpha)\\beta - (-\\alpha\\beta)\\cdot 1 = 0$$\n所以秩为1，该实现是不可控的。\n可观测性：\n$$\\mathcal{O}_{T} = \\begin{pmatrix} C_{T} \\\\ C_{T}A_{T} \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ 1 & \\alpha + \\beta \\end{pmatrix},\\quad \\det(\\mathcal{O}_{T}) = -1 \\neq 0$$\n所以秩为2，该实现是可观测的。\n\n**并联型**。此实现基于对传递函数的部分分式展开。\n$$H(z) = \\frac{z - \\alpha}{(z - \\alpha)(z - \\beta)}$$\n在 $z=\\alpha$ 处，由于极点被零点抵消，其留数 $r_\\alpha$ 为 0。在 $z=\\beta$ 处的留数 $r_\\beta$ 为：\n$$ r_{\\beta} = \\lim_{z \\to \\beta} (z - \\beta) H(z) = \\lim_{z \\to \\beta} (z - \\beta) \\frac{z - \\alpha}{(z - \\alpha)(z - \\beta)} = 1 $$\n因此，对于 $A = \\mathrm{diag}(\\alpha, \\beta)$，$B = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$，$C = \\begin{pmatrix} r_\\alpha & r_\\beta \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\end{pmatrix}$，$D = 0$ 的实现，可控性由下式确定\n$$\\mathcal{C}_{\\mathrm{par}} = \\begin{pmatrix} B & AB \\end{pmatrix} = \\begin{pmatrix} 1 & \\alpha \\\\ 1 & \\beta \\end{pmatrix},\\quad \\det(\\mathcal{C}_{\\mathrm{par}}) = \\beta - \\alpha \\neq 0$$\n所以该实现是可控的。\n可观测性由下式确定\n$$\\mathcal{O}_{\\mathrm{par}} = \\begin{pmatrix} C \\\\ CA \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ 0 & \\beta \\end{pmatrix}$$\n其秩为1，所以该实现是不可观测的。\n\n因此：\n- 直接II型：不可观测，可控。\n- 转置直接II型：不可控，可观测。\n- 并联型：不可观测，可控。\n\n正确选项是 B。", "answer": "$$\\boxed{B}$$", "id": "1756417"}]}