{"hands_on_practices": [{"introduction": "线性相位是许多FIR滤波器设计中的一个理想特性，因为它能确保信号的所有频率分量经历相同的延迟，从而避免波形失真。这一重要特性的根源在于滤波器脉冲响应 $h[n]$ 的对称性。本练习 [@problem_id:1733159] 将通过一个具体实例，让你亲手实践如何利用脉冲响应的对称条件来确定滤波器系数，从而确保其具有线性相位特性。", "problem": "一个因果、实值的有限冲激响应 (FIR) 滤波器正在被设计用于数字音频处理应用。该滤波器的设计指定长度为 3，这意味着其冲激响应（表示为 $h[n]$）仅在离散时间索引 $n=0, 1, 2$ 时非零。\n\n冲激响应由以下表达式给出：\n$$h[n] = (c-1)\\delta[n] + 4\\delta[n-1] + (2c+1)\\delta[n-2]$$\n其中 $\\delta[n]$ 表示克罗内克 delta 函数，而 $c$ 是一个必须仔细选择的实值系数。\n\n为防止音频信号中的相位失真，该滤波器必须具有广义线性相位的特性。确定能确保满足此特性的系数 $c$ 的数值。", "solution": "一个长度为 3 的因果 FIR，其冲激响应为\n$$\nh[n] = (c-1)\\delta[n] + 4\\delta[n-1] + (2c+1)\\delta[n-2]\n$$\n其非零采样点为\n$$\nh[0]=c-1,\\quad h[1]=4,\\quad h[2]=2c+1.\n$$\n对于一个实系数 FIR 滤波器要具有广义线性相位，一个充分必要时域条件是其冲激响应关于中点索引 $n_{0}=(N-1)/2$ 对称或反对称。对于长度 $N=3$，阶数是 $M=N-1=2$，中点索引为 $n_{0}=1$。因此，条件是\n$$\n\\text{对称: } h[n]=h[M-n]\\quad\\text{或}\\quad\\text{反对称: } h[n]=-h[M-n].\n$$\n对于奇数长度 $N$ 的反对称情况，中心抽头必须满足 $h[n_{0}]=-h[n_{0}]$，这意味着 $h[1]=0$。在本题中 $h[1]=4$，所以不可能是反对称。因此我们必须施加对称性条件：\n$$\nh[0]=h[2]\\;\\;\\Longrightarrow\\;\\; c-1=2c+1.\n$$\n求解可得\n$$\nc-1=2c+1\\;\\;\\Longrightarrow\\;\\;-c-2=0\\;\\;\\Longrightarrow\\;\\; c=-2.\n$$\n当 $c=-2$ 时，冲激响应为 $h[0]=-3$, $h[1]=4$, $h[2]=-3$，它关于 $n=1$ 对称，从而确保了广义线性相位。", "answer": "$$\\boxed{-2}$$", "id": "1733159"}, {"introduction": "滤波器脉冲响应 $h[n]$ 的对称性不仅是时域的一个特性，它在Z平面上对系统函数 $H(z)$ 的零点位置有着深刻的几何约束。理解这些约束对于分析和设计滤波器至关重要，因为它揭示了滤波器频率响应的内在结构。本练习 [@problem_id:1733182] 将引导你探索这种零点对称性：当给定一个零点位置时，你将学会如何推导出其他必须存在的零点。", "problem": "一个数字有限脉冲响应（FIR）滤波器被设计用于处理离散时间信号。该滤波器的系统函数记为$H(z)$，是一个关于$z^{-1}$的实系数多项式。此外，已知该滤波器具有广义线性相位响应。\n\n在分析该滤波器的特性时，发现在复z平面上，其系统函数$H(z)$在位置$z_0 = 2\\exp(j\\frac{\\pi}{4})$处有一个零点。根据这些性质，此零点的存在必然导致其他三个特定零点的存在。请从以下选项中确定这另外三个零点的位置。\n\nA. $\\{ 2\\exp(-j\\frac{\\pi}{4}), \\frac{1}{2}\\exp(j\\frac{\\pi}{4}), \\frac{1}{2}\\exp(-j\\frac{\\pi}{4}) \\}$\n\nB. $\\{ 2\\exp(j\\frac{\\pi}{4}), \\frac{1}{2}\\exp(j\\frac{\\pi}{4}), \\frac{1}{2}\\exp(-j\\frac{\\pi}{4}) \\}$\n\nC. $\\{ 2\\exp(-j\\frac{\\pi}{4}), 2\\exp(j\\frac{3\\pi}{4}), 2\\exp(-j\\frac{3\\pi}{4}) \\}$\n\nD. $\\{ -2\\exp(j\\frac{\\pi}{4}), -2\\exp(-j\\frac{\\pi}{4}), \\frac{1}{2}\\exp(j\\frac{\\pi}{4}) \\}$\n\nE. $\\{ \\frac{1}{2}\\exp(j\\frac{\\pi}{4}), \\frac{1}{2}\\exp(-j\\frac{\\pi}{4}), \\frac{1}{2}\\exp(-j\\frac{3\\pi}{4}) \\}$", "solution": "设FIR系统函数为 $H(z)=\\sum_{n=0}^{M} h[n] z^{-n}$，其系数 $h[n]\\in\\mathbb{R}$ 为实数。对于实系数FIR滤波器，其广义线性相位条件意味着其脉冲响应具有对称性或反对称性：\n$$\nh[n]=\\pm h[M-n].\n$$\n在$z$域中，这得到\n$$\nH(z)=\\pm z^{-M} H\\!\\left(z^{-1}\\right).\n$$\n因此，如果 $z_{0}$ 是 $H(z)$ 的一个零点且 $z_{0}\\neq 0$，则\n$$\n0=H(z_{0})=\\pm z_{0}^{-M} H\\!\\left(z_{0}^{-1}\\right)\\;\\;\\Rightarrow\\;\\;H\\!\\left(z_{0}^{-1}\\right)=0,\n$$\n所以每个零点 $z_{0}$ 的倒数 $z_{0}^{-1}$ 也是一个零点（关于单位圆呈倒数对称）。此外，由于 $H(z)$ 具有实系数，零点会以共轭复数对的形式出现：如果 $z_{0}$ 是一个零点，那么 $z_{0}^{*}$ 也是一个零点。结合这两种对称性，任何不在单位圆或实轴上的零点都会产生一个四元组：\n$$\n\\{z_{0},\\,z_{0}^{*},\\,z_{0}^{-1},\\,(z_{0}^{-1})^{*}\\}.\n$$\n\n给定 $z_{0}=2\\exp\\!\\left(j\\frac{\\pi}{4}\\right)$，另外三个隐含的零点是\n$$\nz_{0}^{*}=2\\exp\\!\\left(-j\\frac{\\pi}{4}\\right),\\quad z_{0}^{-1}=\\frac{1}{2}\\exp\\!\\left(-j\\frac{\\pi}{4}\\right),\\quad (z_{0}^{-1})^{*}=\\frac{1}{2}\\exp\\!\\left(j\\frac{\\pi}{4}\\right).\n$$\n这些与选项A相匹配：\n$$\n\\left\\{2\\exp\\!\\left(-j\\frac{\\pi}{4}\\right),\\,\\frac{1}{2}\\exp\\!\\left(j\\frac{\\pi}{4}\\right),\\,\\frac{1}{2}\\exp\\!\\left(-j\\frac{\\pi}{4}\\right)\\right\\}.\n$$", "answer": "$$\\boxed{A}$$", "id": "1733182"}, {"introduction": "理论知识的最终目的是应用于实际设计。这个综合性练习 [@problem_id:1733204] 将挑战你将线性相位滤波器的所有核心概念——脉冲响应对称性、频率响应表达式和设计约束——结合起来，从零开始构建一个满足特定性能指标的滤波器。你将通过设定零点和增益来求解滤波器系数，这是一个模拟真实世界工程设计的宝贵实践。", "problem": "一个长度为$N$的因果有限脉冲响应(FIR)滤波器是一种数字滤波器，其定义为其脉冲响应$h[n]$，该脉冲响应仅在$n=0, 1, \\dots, N-1$时非零。我们感兴趣的是这类滤波器中的一个特定类别，称为I类线性相位FIR滤波器。这类滤波器的特点是其脉冲响应为实值且对称，$h[n] = h[N-1-n]$，并且滤波器长度$N$为奇数。\n\n您的任务是设计一个满足一组特定标准的此类滤波器。该滤波器必须是满足以下两个条件的最短的非平凡I类线性相位FIR滤波器：\n1.  它必须完全消除角频率为$\\omega_1 = \\pi/3$弧度/采样点和$\\omega_2 = \\pi/2$弧度/采样点的频率分量。\n2.  它的直流增益，定义为滤波器在$\\omega=0$处的频率响应值，必须为1。\n\n如果一个滤波器的脉冲响应系数中至少有一个不为零，则该滤波器被认为是非平凡的。\n\n确定此滤波器的系数$h[n]$，其中$n=0, 1, \\dots, N-1$。将系数表示为行向量$(h[0], h[1], \\dots, h[N-1])$。", "solution": "一个I类线性相位有限脉冲响应(FIR)滤波器具有奇数长度，我们可以将其写为$N=2M+1$（对于某个整数$M \\ge 0$），以及对称的脉冲响应，$h[n] = h[N-1-n]$。这种滤波器的频率响应可以表示为$H(e^{j\\omega}) = A_e(\\omega)e^{-j\\omega M}$，其中$A_e(\\omega)$是实值幅度响应。\n\n幅度响应由以下公式给出：\n$$A_e(\\omega) = h[M] + \\sum_{k=1}^{M} 2h[M-k] \\cos(k\\omega)$$\n问题要求我们找到最短的非平凡滤波器。这意味着我们必须找到存在非平凡解的最小整数$M \\ge 1$。$M=0$的情况对应于$N=1$，只有一个系数$h[0]$。要消除任何频率，我们需要$h[0]=0$，而这是一个平凡滤波器。因此，我们从检查$M=1$开始。\n\n**情况1：M = 1（滤波器长度 N = 3）**\n对于$M=1$，滤波器长度为$N=2(1)+1=3$。脉冲响应为$\\{h[0], h[1], h[2]\\}$。根据对称性，$h[0]=h[2]$。\n幅度响应为：\n$$A_e(\\omega) = h[1] + 2h[0]\\cos(\\omega)$$\n滤波器必须消除频率$\\omega_1 = \\pi/3$和$\\omega_2 = \\pi/2$。这意味着幅度响应在这些频率上必须为零。\n1.  在$\\omega_2 = \\pi/2$处：$A_e(\\pi/2) = h[1] + 2h[0]\\cos(\\pi/2) = h[1] + 2h[0](0) = 0 \\implies h[1] = 0$。\n2.  在$\\omega_1 = \\pi/3$处：$A_e(\\pi/3) = h[1] + 2h[0]\\cos(\\pi/3) = h[1] + 2h[0](\\frac{1}{2}) = 0 \\implies h[1] + h[0] = 0$。\n\n从第一个条件我们得到$h[1]=0$。将其代入第二个条件得到$0 + h[0] = 0$，所以$h[0]=0$。\n由于$h[0]=h[2]$，这意味着$h[2]=0$。所有系数（$h[0], h[1], h[2]$）都为零。这是一个平凡滤波器，是不允许的。因此，长度为$N=3$的滤波器不能满足给定的条件。\n\n**情况2：M = 2（滤波器长度 N = 5）**\n对于$M=2$，滤波器长度为$N=2(2)+1=5$。脉冲响应为$\\{h[0], h[1], h[2], h[3], h[4]\\}$。根据对称性，$h[0]=h[4]$且$h[1]=h[3]$。\n幅度响应为：\n$$A_e(\\omega) = h[2] + 2h[1]\\cos(\\omega) + 2h[0]\\cos(2\\omega)$$\n再次，我们应用零点条件：\n1.  在$\\omega_2 = \\pi/2$处：$A_e(\\pi/2) = h[2] + 2h[1]\\cos(\\pi/2) + 2h[0]\\cos(\\pi) = 0$。\n    由于$\\cos(\\pi/2)=0$且$\\cos(\\pi)=-1$，我们得到：\n    $h[2] + 2h[1](0) + 2h[0](-1) = 0 \\implies h[2] - 2h[0] = 0 \\implies h[2] = 2h[0]$。\n2.  在$\\omega_1 = \\pi/3$处：$A_e(\\pi/3) = h[2] + 2h[1]\\cos(\\pi/3) + 2h[0]\\cos(2\\pi/3) = 0$。\n    由于$\\cos(\\pi/3)=1/2$且$\\cos(2\\pi/3)=-1/2$，我们得到：\n    $h[2] + 2h[1](\\frac{1}{2}) + 2h[0](-\\frac{1}{2}) = 0 \\implies h[2] + h[1] - h[0] = 0$。\n\n我们现在有了一个关联系数的二元线性方程组：\n(i) $h[2] = 2h[0]$\n(ii) $h[2] + h[1] - h[0] = 0$\n\n将方程(i)代入(ii)：\n$(2h[0]) + h[1] - h[0] = 0 \\implies h[0] + h[1] = 0 \\implies h[1] = -h[0]$。\n\n我们现在可以用$h[0]$来表示所有独立系数：\n- $h[1] = -h[0]$\n- $h[2] = 2h[0]$\n\n因为我们可以选择一个非零的$h[0]$，这就得到了一个非平凡的滤波器。由于$M=1$时没有解，$M=2$（即$N=5$）是最短的可能长度。\n\n最后的条件是直流增益为1。直流增益是$\\omega=0$处的频率响应：\n$$H(e^{j0}) = \\sum_{n=0}^{4} h[n] = h[0] + h[1] + h[2] + h[3] + h[4]$$\n利用对称性（$h[3]=h[1], h[4]=h[0]$），这变为：\n$$H(e^{j0}) = 2h[0] + 2h[1] + h[2]$$\n现在代入我们找到的关系：$h[1]=-h[0]$和$h[2]=2h[0]$。\n$$H(e^{j0}) = 2h[0] + 2(-h[0]) + (2h[0]) = 2h[0] - 2h[0] + 2h[0] = 2h[0]$$\n条件是直流增益为1，所以：\n$$2h[0] = 1 \\implies h[0] = \\frac{1}{2}$$\n现在我们可以求出所有系数：\n- $h[0] = \\frac{1}{2}$\n- $h[1] = -h[0] = -\\frac{1}{2}$\n- $h[2] = 2h[0] = 2(\\frac{1}{2}) = 1$\n- $h[3] = h[1] = -\\frac{1}{2}$\n- $h[4] = h[0] = \\frac{1}{2}$\n\n滤波器的系数为$h[n] = \\{\\frac{1}{2}, -\\frac{1}{2}, 1, -\\frac{1}{2}, \\frac{1}{2}\\}$。\n最终答案是行向量$(h[0], h[1], h[2], h[3], h[4])$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2}  -\\frac{1}{2}  1  -\\frac{1}{2}  \\frac{1}{2} \\end{pmatrix}}$$", "id": "1733204"}]}