{"hands_on_practices": [{"introduction": "理解任何窗函数的关键第一步是分析其在频域中的表现。这个练习将引导你从汉明窗的基本定义出发，推导其离散时间傅里叶变换（DTFT）的解析表达式 [@problem_id:1723929]。掌握这一基本推导过程，是分析和设计任何数字滤波器的核心技能。", "problem": "在数字信号处理中，加窗是一种基本技术，用于对信号进行锥化处理并减少频谱泄漏。考虑一个信号处理链，其中离散时间信号 $x[n]$ 首先与一个长度为 $N$ 的矩形窗 $w_R[n]$ 相乘。得到的信号随即与一个相同长度 $N$ 的汉明窗 $w_H[n]$ 相乘。这一系列操作等效于将原始信号 $x[n]$ 与一个单一的复合窗 $w_{eq}[n]$ 相乘。\n\n这些窗的正式定义如下：\n- 矩形窗由 $w_R[n] = 1$ 给出，其中 $0 \\le n \\le N-1$；在其他情况下 $w_R[n] = 0$。\n- 汉明窗由 $w_H[n] = 0.54 - 0.46 \\cos\\left(\\frac{2\\pi n}{N-1}\\right)$ 给出，其中 $0 \\le n \\le N-1$；在其他情况下 $w_H[n] = 0$。\n\n假设 $N$ 是一个大于1的整数。\n\n您的任务是推导等效复合窗 $w_{eq}[n]$ 的离散时间傅里叶变换（DTFT）的闭式解析表达式，该变换表示为 $W_{eq}(e^{j\\omega})$。请用 $N$ 和角频率 $\\omega$ 来表示您的最终答案。", "solution": "时域操作是将 $x[n]$ 与长度为 $N$ 的矩形窗 $w_{R}[n]$ 相乘，然后与同样长度为 $N$ 的汉明窗 $w_{H}[n]$ 相乘。由于当 $0 \\leq n \\leq N-1$ 时 $w_{R}[n]=1$，而在其他情况下为零，且 $w_{H}[n]$ 在同一区间外为0，因此它们的乘积等于汉明窗本身：\n$$\nw_{eq}[n]=w_{R}[n]\\,w_{H}[n]=w_{H}[n],\\quad \\text{for all }n.\n$$\n因此，$w_{eq}[n]$ 的DTFT就是汉明窗的DTFT：\n$$\nW_{eq}(e^{j\\omega})=\\sum_{n=0}^{N-1}\\left(0.54-0.46\\cos\\left(\\frac{2\\pi n}{N-1}\\right)\\right)e^{-j\\omega n}.\n$$\n利用DTFT的线性性质和恒等式 $\\cos(\\theta)=\\frac{1}{2}(e^{j\\theta}+e^{-j\\theta})$，我们写出\n$$\nW_{eq}(e^{j\\omega})\n=0.54\\sum_{n=0}^{N-1}e^{-j\\omega n}\n-\\frac{0.46}{2}\\sum_{n=0}^{N-1}\\left[e^{-j\\left(\\omega-\\frac{2\\pi}{N-1}\\right)n}+e^{-j\\left(\\omega+\\frac{2\\pi}{N-1}\\right)n}\\right].\n$$\n对于任意实数 $a$，有限几何级数的求和公式为\n$$\n\\sum_{n=0}^{N-1}e^{-j a n}=e^{-j a\\frac{N-1}{2}}\\frac{\\sin\\left(\\frac{N a}{2}\\right)}{\\sin\\left(\\frac{a}{2}\\right)}.\n$$\n将此公式应用于 $a=\\omega$、$a=\\omega-\\frac{2\\pi}{N-1}$ 和 $a=\\omega+\\frac{2\\pi}{N-1}$，即可得到闭式表达式\n$$\nW_{eq}(e^{j\\omega})\n=0.54\\,e^{-j\\omega\\frac{N-1}{2}}\\frac{\\sin\\left(\\frac{N\\omega}{2}\\right)}{\\sin\\left(\\frac{\\omega}{2}\\right)}\n-0.23\\left[\ne^{-j\\left(\\omega-\\frac{2\\pi}{N-1}\\right)\\frac{N-1}{2}}\\frac{\\sin\\left(\\frac{N}{2}\\left(\\omega-\\frac{2\\pi}{N-1}\\right)\\right)}{\\sin\\left(\\frac{1}{2}\\left(\\omega-\\frac{2\\pi}{N-1}\\right)\\right)}\n+e^{-j\\left(\\omega+\\frac{2\\pi}{N-1}\\right)\\frac{N-1}{2}}\\frac{\\sin\\left(\\frac{N}{2}\\left(\\omega+\\frac{2\\pi}{N-1}\\right)\\right)}{\\sin\\left(\\frac{1}{2}\\left(\\omega+\\frac{2\\pi}{N-1}\\right)\\right)}\n\\right].\n$$\n此表达式对所有 $N>1$ 和所有 $\\omega$ 均有效，对于分母为零的可去奇点，采用常规的极限解释。", "answer": "$$\\boxed{0.54\\,e^{-j\\omega\\frac{N-1}{2}}\\frac{\\sin\\left(\\frac{N\\omega}{2}\\right)}{\\sin\\left(\\frac{\\omega}{2}\\right)}-0.23\\left[e^{-j\\left(\\omega-\\frac{2\\pi}{N-1}\\right)\\frac{N-1}{2}}\\frac{\\sin\\left(\\frac{N}{2}\\left(\\omega-\\frac{2\\pi}{N-1}\\right)\\right)}{\\sin\\left(\\frac{1}{2}\\left(\\omega-\\frac{2\\pi}{N-1}\\right)\\right)}+e^{-j\\left(\\omega+\\frac{2\\pi}{N-1}\\right)\\frac{N-1}{2}}\\frac{\\sin\\left(\\frac{N}{2}\\left(\\omega+\\frac{2\\pi}{N-1}\\right)\\right)}{\\sin\\left(\\frac{1}{2}\\left(\\omega+\\frac{2\\pi}{N-1}\\right)\\right)}\\right]}$$", "id": "1723929"}, {"introduction": "在推导出频谱表达式后，下一步是分析其关键特征，尤其是决定频谱泄漏程度的旁瓣。这个练习 [@problem_id:1723928] 提出了一个实际情景：通过检查频谱旁瓣的结构来区分汉明窗和汉宁窗。这项实践将增强你解读频谱图并理解不同窗函数之间性能权衡的能力。", "problem": "在数字信号处理中，窗函数用于对有限长度的信号进行锥化，以在计算其离散傅里叶变换（DFT）时减少频谱泄漏。两种常见的选择是汉宁窗和汉明窗。一位工程师丢失了某个数据集的元数据，需要确定该数据集是应用了汉宁窗还是汉明窗。计划是通过分析频谱的结构来确定。\n\n一个持续时间为 $T$、中心在 $t=0$ 的广义升余弦窗的连续时间模型由以下公式给出：\n$$w(t) = a_0 - a_1 \\cos\\left(\\frac{2\\pi t}{T}\\right), \\quad \\text{for } |t| \\le \\frac{T}{2}$$\n在其他情况下，$w(t)=0$。其傅里叶变换 $W(\\omega)$ 可以用sinc函数表示，其中 $\\text{sinc}(x) = \\frac{\\sin(\\pi x)}{\\pi x}$：\n$$W(\\omega) = T \\left( a_0 \\, \\text{sinc}\\left(\\frac{\\omega T}{2\\pi}\\right) - \\frac{a_1}{2} \\left[ \\text{sinc}\\left(\\frac{\\omega T}{2\\pi} - 1\\right) + \\text{sinc}\\left(\\frac{\\omega T}{2\\pi} + 1\\right) \\right] \\right) $$\n汉宁窗和汉明窗的系数分别为：\n-   **汉宁窗：** $a_0 = 0.5$, $a_1 = 0.5$\n-   **汉明窗：** $a_0 = 0.54$, $a_1 = 0.46$\n\n对于升余弦窗，主瓣之后是一系列的旁瓣。我们关心的是第一旁瓣和第二旁瓣峰值幅度之比。为解决此问题，假设两种窗谱的第一和第二旁瓣的峰值分别出现在近似归一化频率 $x_1 = 2.5$ 和 $x_2 = 3.5$ 处，其中 $x = \\frac{\\omega T}{2\\pi}$。\n\n计算汉宁窗和汉明窗的第一旁瓣峰值幅度与第二旁瓣峰值幅度之比的理论值。将您的答案表示为两个数值：先是汉宁窗的比率，然后是汉明窗的比率。将您的最终答案四舍五入到四位有效数字。", "solution": "目标是使用提供的傅里叶变换表达式和给定的近似峰值位置，计算汉宁窗和汉明窗的第一旁瓣峰值幅度与第二旁瓣峰值幅度之比。\n\n窗函数的傅里叶变换由下式给出：\n$$W(\\omega) = T \\left( a_0 \\, \\text{sinc}\\left(\\frac{\\omega T}{2\\pi}\\right) - \\frac{a_1}{2} \\left[ \\text{sinc}\\left(\\frac{\\omega T}{2\\pi} - 1\\right) + \\text{sinc}\\left(\\frac{\\omega T}{2\\pi} + 1\\right) \\right] \\right)$$\n我们定义归一化频率 $x = \\frac{\\omega T}{2\\pi}$。忽略常数因子 $T$，频谱形状可以由函数 $S(x)$ 描述：\n$$S(x) = a_0 \\, \\text{sinc}(x) - \\frac{a_1}{2} \\left( \\text{sinc}(x - 1) + \\text{sinc}(x + 1) \\right)$$\n我们需要求出比值 $\\frac{|S(x_1)|}{|S(x_2)|}$，其中 $x_1 = 2.5$ 是第一旁瓣峰值的位置，$x_2 = 3.5$ 是第二旁瓣峰值的位置。\n\n首先，我们列出sinc函数在所需的半整数点上的值：\n- $\\text{sinc}(1.5) = \\frac{\\sin(1.5\\pi)}{1.5\\pi} = \\frac{-1}{1.5\\pi} = -\\frac{2}{3\\pi}$\n- $\\text{sinc}(2.5) = \\frac{\\sin(2.5\\pi)}{2.5\\pi} = \\frac{1}{2.5\\pi} = \\frac{2}{5\\pi}$\n- $\\text{sinc}(3.5) = \\frac{\\sin(3.5\\pi)}{3.5\\pi} = \\frac{-1}{3.5\\pi} = -\\frac{2}{7\\pi}$\n- $\\text{sinc}(4.5) = \\frac{\\sin(4.5\\pi)}{4.5\\pi} = \\frac{1}{4.5\\pi} = \\frac{2}{9\\pi}$\n\n**1. 汉宁窗计算**\n对于汉宁窗，系数为 $a_0 = 0.5$ 和 $a_1 = 0.5$。\n\n在 $x_1 = 2.5$ 处的第一旁瓣峰值幅度：\n$$S_{Hanning}(2.5) = 0.5 \\, \\text{sinc}(2.5) - \\frac{0.5}{2} \\left( \\text{sinc}(2.5 - 1) + \\text{sinc}(2.5 + 1) \\right)$$\n$$S_{Hanning}(2.5) = 0.5 \\, \\text{sinc}(2.5) - 0.25 \\left( \\text{sinc}(1.5) + \\text{sinc}(3.5) \\right)$$\n代入sinc函数的值：\n$$S_{Hanning}(2.5) = 0.5 \\left(\\frac{2}{5\\pi}\\right) - 0.25 \\left(-\\frac{2}{3\\pi} - \\frac{2}{7\\pi}\\right) = \\frac{1}{5\\pi} + \\frac{0.5}{\\pi} \\left(\\frac{1}{3} + \\frac{1}{7}\\right)$$\n$$S_{Hanning}(2.5) = \\frac{1}{5\\pi} + \\frac{0.5 \\times 10}{21\\pi} = \\frac{1}{5\\pi} + \\frac{5}{21\\pi}$$\n$$S_{Hanning}(2.5) = \\frac{1}{\\pi}\\left(\\frac{21 + 25}{105}\\right) = \\frac{46}{105\\pi}$$\n幅度为 $|S_{Hanning}(2.5)| = \\frac{46}{105\\pi}$。\n\n在 $x_2 = 3.5$ 处的第二旁瓣峰值幅度：\n$$S_{Hanning}(3.5) = 0.5 \\, \\text{sinc}(3.5) - 0.25 \\left( \\text{sinc}(2.5) + \\text{sinc}(4.5) \\right)$$\n代入sinc函数的值：\n$$S_{Hanning}(3.5) = 0.5 \\left(-\\frac{2}{7\\pi}\\right) - 0.25 \\left(\\frac{2}{5\\pi} + \\frac{2}{9\\pi}\\right) = -\\frac{1}{7\\pi} - \\frac{0.5}{\\pi} \\left(\\frac{1}{5} + \\frac{1}{9}\\right)$$\n$$S_{Hanning}(3.5) = -\\frac{1}{7\\pi} - \\frac{0.5}{\\pi} \\left(\\frac{9+5}{45}\\right) = -\\frac{1}{7\\pi} - \\frac{0.5 \\times 14}{45\\pi} = -\\frac{1}{7\\pi} - \\frac{7}{45\\pi}$$\n$$S_{Hanning}(3.5) = -\\frac{1}{\\pi}\\left(\\frac{45 + 49}{315}\\right) = -\\frac{94}{315\\pi}$$\n幅度为 $|S_{Hanning}(3.5)| = \\frac{94}{315\\pi}$。\n\n汉宁窗的比率为：\n$$R_{Hanning} = \\frac{|S_{Hanning}(2.5)|}{|S_{Hanning}(3.5)|} = \\frac{46/105\\pi}{94/315\\pi} = \\frac{46}{105} \\times \\frac{315}{94} = \\frac{46}{94} \\times \\frac{315}{105} = \\frac{23}{47} \\times 3 = \\frac{69}{47}$$\n$$R_{Hanning} \\approx 1.468085...$$\n四舍五入到四位有效数字，$R_{Hanning} \\approx 1.468$。\n\n**2. 汉明窗计算**\n对于汉明窗，系数为 $a_0 = 0.54$ 和 $a_1 = 0.46$。\n\n在 $x_1 = 2.5$ 处的第一旁瓣峰值幅度：\n$$S_{Hamming}(2.5) = 0.54 \\, \\text{sinc}(2.5) - \\frac{0.46}{2} \\left( \\text{sinc}(1.5) + \\text{sinc}(3.5) \\right)$$\n$$S_{Hamming}(2.5) = 0.54 \\left(\\frac{2}{5\\pi}\\right) - 0.23 \\left(-\\frac{2}{3\\pi} - \\frac{2}{7\\pi}\\right) = \\frac{1.08}{5\\pi} + \\frac{0.46}{\\pi} \\left(\\frac{1}{3} + \\frac{1}{7}\\right)$$\n$$S_{Hamming}(2.5) = \\frac{0.216}{\\pi} + \\frac{0.46}{\\pi} \\left(\\frac{10}{21}\\right) = \\frac{1}{\\pi} \\left(0.216 + \\frac{4.6}{21}\\right)$$\n$$S_{Hamming}(2.5) \\approx \\frac{1}{\\pi} (0.216 + 0.2190476) = \\frac{0.4350476}{\\pi}$$\n幅度为 $|S_{Hamming}(2.5)| \\approx \\frac{0.4350476}{\\pi}$。\n\n在 $x_2 = 3.5$ 处的第二旁瓣峰值幅度：\n$$S_{Hamming}(3.5) = 0.54 \\, \\text{sinc}(3.5) - 0.23 \\left( \\text{sinc}(2.5) + \\text{sinc}(4.5) \\right)$$\n$$S_{Hamming}(3.5) = 0.54 \\left(-\\frac{2}{7\\pi}\\right) - 0.23 \\left(\\frac{2}{5\\pi} + \\frac{2}{9\\pi}\\right) = -\\frac{1.08}{7\\pi} - \\frac{0.46}{\\pi} \\left(\\frac{1}{5} + \\frac{1}{9}\\right)$$\n$$S_{Hamming}(3.5) = -\\frac{1.08}{7\\pi} - \\frac{0.46}{\\pi} \\left(\\frac{14}{45}\\right) = -\\frac{1}{\\pi} \\left(\\frac{1.08}{7} + \\frac{0.46 \\times 14}{45}\\right)$$\n$$S_{Hamming}(3.5) \\approx -\\frac{1}{\\pi} (0.1542857 + 0.1431111) = -\\frac{0.2973968}{\\pi}$$\n幅度为 $|S_{Hamming}(3.5)| \\approx \\frac{0.2973968}{\\pi}$。\n\n汉明窗的比率为：\n$$R_{Hamming} = \\frac{|S_{Hamming}(2.5)|}{|S_{Hamming}(3.5)|} \\approx \\frac{0.4350476/\\pi}{0.2973968/\\pi} = \\frac{0.4350476}{0.2973968}$$\n$$R_{Hamming} \\approx 1.46285...$$\n四舍五入到四位有效数字，$R_{Hamming} \\approx 1.463$。\n\n这两个计算出的比率分别对应汉宁窗和汉明窗。", "answer": "$$\\boxed{\\begin{pmatrix} 1.468 & 1.463 \\end{pmatrix}}$$", "id": "1723928"}, {"introduction": "学习的最终目标是将理论知识应用于解决实际工程问题。在滤波器设计中，窗函数主瓣的宽度直接决定了滤波器的过渡带陡峭程度。本练习 [@problem_id:1723953] 要求你根据给定的带宽指标，计算出满足设计要求的最小窗口长度 $N$，从而将窗函数的数学特性与关键设计规范直接联系起来。", "problem": "一位信号处理工程师正在使用加窗法设计一个数字有限冲激响应（FIR）滤波器。该设计要求精确控制滤波器的过渡带，而过渡带关键地取决于所用窗函数的主瓣宽度。工程师选择了一个汉明窗，其长度为 $N$，定义如下：\n$$w[n] = 0.54 - 0.46 \\cos\\left(\\frac{2\\pi n}{N-1}\\right), \\quad \\text{for } n = 0, 1, \\dots, N-1.$$\n\n待滤波的信号采样频率为 $f_s = 48$ kHz。对于这类窗函数，大量的经验研究已经确定了其主瓣的零点到零点带宽 $\\Delta f_{\\text{null}}$ 与其3分贝（dB）带宽 $\\Delta f_{\\text{3dB}}$ 之间的关系。该关系由 $\\Delta f_{\\text{3dB}} \\approx 0.325 \\times \\Delta f_{\\text{null}}$ 给出。\n\n汉明窗频谱的主瓣以0 Hz为中心，其第一零点出现在频率 $f = \\pm \\frac{c f_s}{N}$ 处，其中 $c$ 是一个常数。对于汉明窗，该常数为 $c=2$。\n\n滤波器设计规范要求窗函数主瓣的3-dB带宽不超过150 Hz。\n\n确定满足此设计约束的最小整数窗长 $N$。", "solution": "该问题要求确定最小的整数窗长 $N$，以确保汉明窗主瓣的3-dB带宽 $\\Delta f_{\\text{3dB}}$ 不超过150 Hz。设计约束可以写作：\n$$ \\Delta f_{\\text{3dB}} \\le 150 \\text{ Hz} $$\n\n为解决此问题，我们首先需要找到 $\\Delta f_{\\text{3dB}}$ 关于窗长 $N$ 的表达式。题目提供了3-dB带宽与零点到零点带宽 $\\Delta f_{\\text{null}}$ 之间的关系：\n$$ \\Delta f_{\\text{3dB}} \\approx 0.325 \\times \\Delta f_{\\text{null}} $$\n\n接下来，我们确定 $\\Delta f_{\\text{null}}$。题目指出，对于汉明窗，主瓣的第一零点出现在频率 $f = \\pm \\frac{c f_s}{N}$ 处，其中常数 $c=2$。我们将这些零点频率称为 $f_{\\text{null,1}}$ 和 $f_{\\text{null,2}}$。\n$$ f_{\\text{null,1}} = +\\frac{2 f_s}{N} $$\n$$ f_{\\text{null,2}} = -\\frac{2 f_s}{N} $$\n零点到零点带宽是这两个频率之间的差值：\n$$ \\Delta f_{\\text{null}} = f_{\\text{null,1}} - f_{\\text{null,2}} = \\left(\\frac{2 f_s}{N}\\right) - \\left(-\\frac{2 f_s}{N}\\right) = \\frac{4 f_s}{N} $$\n\n现在，我们可以将 $\\Delta f_{\\text{null}}$ 的表达式代入 $\\Delta f_{\\text{3dB}}$ 的方程中：\n$$ \\Delta f_{\\text{3dB}} \\approx 0.325 \\times \\left(\\frac{4 f_s}{N}\\right) = \\frac{1.3 f_s}{N} $$\n\n有了这个表达式，我们就可以利用设计约束来求所需的窗长 $N$：\n$$ \\frac{1.3 f_s}{N} \\le 150 $$\n我们需要解出 $N$。重排不等式可得：\n$$ N \\ge \\frac{1.3 f_s}{150} $$\n\n现在我们可以代入给定的数值。采样频率为 $f_s = 48$ kHz，即 $48000$ Hz。\n$$ N \\ge \\frac{1.3 \\times 48000}{150} $$\n我们进行计算：\n$$ N \\ge \\frac{1.3 \\times 4800}{15} $$\n因为 $4800 / 15 = 320$，我们得到：\n$$ N \\ge 1.3 \\times 320 $$\n$$ N \\ge 416 $$\n\n不等式表明 $N$ 必须大于或等于416。因为窗长 $N$ 必须是整数，所以满足此条件的最小整数 $N$ 值为416。", "answer": "$$\\boxed{416}$$", "id": "1723953"}]}