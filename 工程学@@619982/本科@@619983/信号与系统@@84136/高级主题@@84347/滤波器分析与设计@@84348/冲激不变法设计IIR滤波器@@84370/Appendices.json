{"hands_on_practices": [{"introduction": "第一个练习将引导你掌握脉冲响应不变法的基石：将模拟s平面中的极点映射到数字z平面。理解这种 $z = e^{sT}$ 的变换，是将任何模拟滤波器转换为其数字等效形式的关键第一步。本练习通过一个简单的一阶系统，清晰具体地展示了这一基本映射关系。[@problem_id:1726595]", "problem": "一位工程师正在设计一个数字信号处理系统，以替代一个现有的模拟组件。该模拟组件是一个简单的、稳定的一阶低通滤波器，其传递函数在s平面上位于 $s = -5$ 处有一个单实极点。为创建其数字等效，该工程师决定使用脉冲响应不变法。在模数转换过程中使用了采样周期 $T$。\n\n请确定由此产生的数字无限脉冲响应 (IIR) 滤波器在z平面上对应极点的位置。请将您的答案表示为关于采样周期 $T$ 的符号表达式。", "solution": "给定的模拟系统是一个稳定的一阶低通滤波器，在 $s=-5$ 处有一个单实极点。这样一个系统的规范形式为 $H_{a}(s)=\\frac{K}{s+5}$，其中 $K$ 为某个增益，其脉冲响应为 $h_{a}(t)=K \\exp(-5 t) u(t)$，其中 $u(t)$ 是单位阶跃函数。\n\n在脉冲响应不变法下，离散时间脉冲响应是通过对连续时间脉冲响应以采样周期 $T$ 的整数倍进行采样得到的：\n$$\nh[n]=h_{a}(nT)=K \\exp(-5 n T) u[n].\n$$\n对 $h[n]$ 进行z变换，\n$$\nH(z)=\\sum_{n=0}^{\\infty} K \\exp(-5 T n) z^{-n}=K \\sum_{n=0}^{\\infty} \\left(\\exp(-5 T) z^{-1}\\right)^{n}.\n$$\n这是一个公比为 $\\exp(-5 T) z^{-1}$ 的几何级数，当 $|z|>|\\exp(-5 T)|$ 时收敛，其和为\n$$\nH(z)=\\frac{K}{1-\\exp(-5 T) z^{-1}}.\n$$\n因此，该数字IIR滤波器的极点是分母的根，\n$$\n1-\\exp(-5 T) z^{-1}=0 \\quad \\Rightarrow \\quad z=\\exp(-5 T).\n$$\n更一般地，在脉冲响应不变法下，一个位于 $s=s_{0}$ 的连续时间极点会映射到位于 $z=\\exp(s_{0} T)$ 的离散时间极点。代入 $s_{0}=-5$ 可得出极点位置 $z=\\exp(-5 T)$。", "answer": "$$\\boxed{\\exp(-5 T)}$$", "id": "1726595"}, {"introduction": "从理论走向实践，本练习将展示抽象的数字传递函数 $H(z)$ 如何转化为具体的差分方程，而这正是实时数字滤波器实现的核心。通过计算一个反馈系数，你将直接把模拟滤波器的特性和采样周期与最终数字滤波器的行为联系起来。这加强了你在上一个练习中找到的极点位置与定义滤波器运算的系数之间的联系。[@problem_id:1726536]", "problem": "要设计一个数字滤波器来近似一个一阶连续时间系统。该连续时间系统由传递函数 $H_a(s) = \\frac{10}{s+5}$ 描述。设计方法为脉冲响应不变法，采样周期为 $T = 0.1$ 秒。所得到的数字滤波器将使用一阶无限脉冲响应（IIR）结构实现，其由差分方程 $y[n] = b_0x[n] - a_1y[n-1]$ 描述，其中 $x[n]$ 是输入序列，$y[n]$ 是输出序列。确定反馈系数 $a_1$ 的数值。将最终答案四舍五入到三位有效数字。", "solution": "连续时间传递函数为 $H_{a}(s)=\\frac{10}{s+5}$。其脉冲响应通过拉普拉斯逆变换得到：\n$$\nh_{a}(t)=10\\exp(-5t)u(t).\n$$\n使用脉冲响应不变法，采样周期为 $T$，离散时间脉冲响应是其采样并缩放后的版本：\n$$\nh_{d}[n]=T\\,h_{a}(nT)=10T\\,\\exp(-5nT)u[n].\n$$\n进行 $Z$ 变换，我们得到一个几何级数：\n$$\nH(z)=\\sum_{n=0}^{\\infty}10T\\,\\exp(-5nT)z^{-n}=\\frac{10T}{1-\\exp(-5T)z^{-1}}.\n$$\n给定的IIR结构为 $y[n]=b_{0}x[n]-a_{1}y[n-1]$，其传递函数为\n$$\nH(z)=\\frac{Y(z)}{X(z)}=\\frac{b_{0}}{1+a_{1}z^{-1}}.\n$$\n令其与通过脉冲响应不变法得到的 $H(z)$ 相等，分母必须匹配：\n$$\n1+a_{1}z^{-1}=1-\\exp(-5T)z^{-1}\\quad\\Rightarrow\\quad a_{1}=-\\exp(-5T).\n$$\n当 $T=0.1$ 时，可得\n$$\na_{1}=-\\exp(-0.5)\\approx-0.606530659\\ldots\n$$\n四舍五入到三位有效数字：\n$$\na_{1}\\approx-0.607.\n$$", "answer": "$$\\boxed{-0.607}$$", "id": "1726536"}, {"introduction": "最后一个练习旨在探讨脉冲响应不变法一个关键且不那么直观的后果：混叠。虽然该方法在采样时刻完美地保留了脉冲响应，但这可能导致物理上不同的模拟滤波器产生完全相同的数字滤波器。这个思想实验将挑战你构建这样一个场景，从而揭示该方法背后隐藏的频域混叠现象，并解释了为何此方法主要适用于带限滤波器。[@problem_id:1726542]", "problem": "从模拟原型设计无限脉冲响应 (IIR) 数字滤波器有时会产生违反直觉的结果。脉冲响应不变法就是这样一种设计技术，该方法通过对连续时间模拟滤波器的脉冲响应进行采样来创建数字滤波器的脉冲响应。\n\n考虑一个由以下传递函数给出的、具有实系数的稳定二阶低通模拟滤波器：\n$$H_1(s) = \\frac{\\sigma_0^2 + \\omega_0^2}{(s - \\sigma_0)^2 + \\omega_0^2}$$\n其中 $\\sigma_0$ 和 $\\omega_0$ 是表示滤波器参数的实常数，且满足约束条件 $\\sigma_0 < 0$ 和 $\\omega_0 > 0$。该滤波器的直流增益为单位增益。\n\n此滤波器被用作原型，通过采样周期为 $T_s$ 的脉冲响应不变法来设计数字滤波器 $H(z)$。\n\n结果发现，存在另一个不同的稳定二阶模拟滤波器 $H_2(s)$，它具有独特的带通频率响应特性，但当使用相同的采样周期 $T_s$ 应用相同的脉冲响应不变设计过程时，却能产生完全相同的数字滤波器 $H(z)$。\n\n请确定这样一个滤波器 $H_2(s)$ 的传递函数。您的最终答案应为一个关于 $s$、$\\sigma_0$、$\\omega_0$ 和 $T_s$ 的闭式解析表达式。", "solution": "脉冲响应不变法的核心原理是，数字滤波器的脉冲响应 $h_d[n]$ 是模拟滤波器脉冲响应 $h_a(t)$ 的采样版本。即，$h_d[n] = h_a(nT_s)$，其中 $T_s$ 是采样周期。\n\n要使两个不同的模拟滤波器 $H_1(s)$ 和 $H_2(s)$ 产生完全相同的数字滤波器 $H(z)$，它们各自的脉冲响应 $h_1(t)$ 和 $h_2(t)$ 必须产生相同的采样序列。因此，条件是：\n$$h_1(nT_s) = h_2(nT_s) \\quad \\text{对于所有整数 } n \\ge 0$$\n注意，这并不意味着对于所有 $t$，$h_1(t)$ 都必须等于 $h_2(t)$。\n\n首先，我们求出与给定低通滤波器 $H_1(s)$ 对应的脉冲响应 $h_1(t)$。\n传递函数为：\n$$H_1(s) = \\frac{\\sigma_0^2 + \\omega_0^2}{(s - \\sigma_0)^2 + \\omega_0^2}$$\n该形式可以与拉普拉斯变换对 $\\mathcal{L}\\{e^{at}\\sin(bt)u(t)\\} = \\frac{b}{(s-a)^2 + b^2}$ 关联起来。\n我们可以将 $H_1(s)$ 重写为：\n$$H_1(s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} \\cdot \\frac{\\omega_0}{(s - \\sigma_0)^2 + \\omega_0^2}$$\n应用拉普拉斯逆变换，我们得到脉冲响应 $h_1(t)$：\n$$h_1(t) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 t} \\sin(\\omega_0 t) u(t)$$\n其中 $u(t)$ 是亥维赛德阶跃函数。\n\n接下来，我们以 $T_s$ 为间隔对该脉冲响应进行采样：\n$$h_1(nT_s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 n T_s} \\sin(\\omega_0 n T_s) \\quad \\text{对于 } n \\ge 0$$\n\n现在，我们需要找到一个不同的连续时间脉冲响应 $h_2(t)$，使得 $h_2(nT_s) = h_1(nT_s)$。关键在于采样后正弦函数的周期性。正弦函数具有性质 $\\sin(\\theta) = \\sin(\\theta + 2\\pi k)$，其中 $k$ 为任意整数。\n让我们考虑 $\\sin(\\omega_0 n T_s)$ 这一项。我们可以定义一个新的频率 $\\omega_1$，使得对于所有整数 $n$，$\\sin(\\omega_1 n T_s) = \\sin(\\omega_0 n T_s)$。\n该等式成立的条件是：\n$$\\omega_1 n T_s = \\omega_0 n T_s + 2\\pi k n$$\n对于某个非零整数 $k$。两边同除以 $n T_s$（对于 $n \\neq 0$），我们得到：\n$$\\omega_1 = \\omega_0 + \\frac{2\\pi k}{T_s}$$\n为了创建一个不同于 $H_1(s)$ 的滤波器，我们必须选择 $k \\neq 0$。问题指明 $H_2(s)$ 应具有带通特性。带通滤波器的谐振频率通常比可比的低通滤波器要高。这表明可以选择一个正整数 $k$ 来增加频率。最简单的选择是 $k=1$。我们定义新频率为：\n$$\\omega_1 = \\omega_0 + \\frac{2\\pi}{T_s}$$\n\n现在，我们可以构建脉冲响应 $h_2(t)$。它必须具有与 $h_1(t)$ 相同的指数衰减包络和幅度缩放，以在采样时刻匹配，但使用新的正弦频率 $\\omega_1$：\n$$h_2(t) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 t} \\sin(\\omega_1 t) u(t)$$\n让我们验证 $h_2(nT_s) = h_1(nT_s)$：\n$$h_2(nT_s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 n T_s} \\sin(\\omega_1 n T_s)$$\n$$h_2(nT_s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 n T_s} \\sin\\left(\\left(\\omega_0 + \\frac{2\\pi}{T_s}\\right) n T_s\\right)$$\n$$h_2(nT_s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 n T_s} \\sin(\\omega_0 n T_s + 2\\pi n)$$\n因为 $n$ 是整数，所以 $2\\pi n$ 是 $2\\pi$ 的整数倍，因此 $\\sin(\\omega_0 n T_s + 2\\pi n) = \\sin(\\omega_0 n T_s)$。\n$$h_2(nT_s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 n T_s} \\sin(\\omega_0 n T_s) = h_1(nT_s)$$\n条件满足。\n\n最后，我们通过对 $h_2(t)$ 进行拉普拉斯变换来求得传递函数 $H_2(s)$：\n$$H_2(s) = \\mathcal{L}\\{h_2(t)\\} = \\mathcal{L}\\left\\{ \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} e^{\\sigma_0 t} \\sin(\\omega_1 t) u(t) \\right\\}$$\n使用与之前相同的拉普拉斯变换对：\n$$H_2(s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} \\left[ \\frac{\\omega_1}{(s - \\sigma_0)^2 + \\omega_1^2} \\right]$$\n代入 $\\omega_1$ 的表达式：\n$$H_2(s) = \\frac{\\sigma_0^2 + \\omega_0^2}{\\omega_0} \\frac{\\omega_0 + \\frac{2\\pi}{T_s}}{(s - \\sigma_0)^2 + \\left(\\omega_0 + \\frac{2\\pi}{T_s}\\right)^2}$$\n这是一个稳定（$\\sigma_0<0$）的二阶滤波器的传递函数。其谐振中心位于一个高得多的频率 $\\omega_1 = \\omega_0 + 2\\pi/T_s$ 附近，其直流增益 $H_2(0)$ 远小于其峰值增益，这证实了其带通特性，与在直流处具有最大增益的低通滤波器 $H_1(s)$ 形成对比。", "answer": "$$\\boxed{\\frac{(\\sigma_0^2 + \\omega_0^2)\\left(\\omega_0 + \\frac{2\\pi}{T_s}\\right)}{\\omega_0 \\left( (s-\\sigma_0)^2 + \\left(\\omega_0 + \\frac{2\\pi}{T_s}\\right)^2 \\right)}}$$", "id": "1726542"}]}