{"hands_on_practices": [{"introduction": "本次练习旨在探索一个基本概念：非线性系统如何产生原始信号中不存在的新频率分量。通过分析一个简单的平方运算，您将深入了解谐波生成现象。理解这一现象是掌握时频分析在表征真实世界系统中重要性的关键。[@problem_id:1765704]", "problem": "一位工程师正在测试一个非线性电子元件。该元件的输入是一个纯正弦电压信号，由函数 $v_{in}(t) = V_0 \\cos(\\omega_0 t)$ 描述，其中 $V_0$ 是峰值振幅，$\\omega_0$ 是角频率，单位为弧度/秒。该元件是一个无记忆平方设备，意味着其输出电压由关系式 $v_{out}(t) = [v_{in}(t)]^2$ 给出。该工程师使用频谱分析仪来观察输出信号 $v_{out}(t)$ 的频率成分。假设输入信号是非平凡的（即 $V_0 \\neq 0$ 且 $\\omega_0 \\neq 0$），以下哪项最能描述输出信号 $v_{out}(t)$ 中存在的角频率集合？\n\nA. 只有原始频率 $\\omega_0$。\n\nB. 原始频率 $\\omega_0$ 和一个在 $2\\omega_0$ 处的新分量。\n\nC. 一个直流分量（0 弧度/秒）和一个在 $2\\omega_0$ 处的新分量。\n\nD. 只有一个在 $2\\omega_0$ 处的新分量。\n\nE. 一个直流分量（0 弧度/秒）、原始频率 $\\omega_0$ 和一个在 $2\\omega_0$ 处的新分量。", "solution": "输入是由 $v_{in}(t) = V_{0} \\cos(\\omega_{0} t)$ 描述的单音正弦波，其中 $V_{0} \\neq 0$ 且 $\\omega_{0} \\neq 0$。该设备是一个无记忆平方非线性元件，因此输出为\n$$\nv_{out}(t) = \\left[v_{in}(t)\\right]^{2} = \\left(V_{0} \\cos(\\omega_{0} t)\\right)^{2} = V_{0}^{2} \\cos^{2}(\\omega_{0} t).\n$$\n使用三角降幂恒等式\n$$\n\\cos^{2}(x) = \\frac{1 + \\cos(2x)}{2}.\n$$\n将此恒等式应用于 $x = \\omega_{0} t$ 可得\n$$\nv_{out}(t) = \\frac{V_{0}^{2}}{2} \\left[1 + \\cos(2 \\omega_{0} t)\\right].\n$$\n此分解表明：\n- 一个振幅为 $\\frac{V_{0}^{2}}{2}$ 的直流分量（零角频率）。\n- 一个角频率为 $2 \\omega_{0}$、振幅为 $\\frac{V_{0}^{2}}{2}$ 的谐波。\n在原始频率 $\\omega_{0}$ 处没有分量。因为 $V_{0} \\neq 0$，所以振幅非零；又因为 $\\omega_{0} \\neq 0$，所以谐波处于非零频率。因此，存在的角频率集合是 $\\{0, 2\\omega_{0}\\}$，这与选项C相对应。", "answer": "$$\\boxed{C}$$", "id": "1765704"}, {"introduction": "语谱图具有将时域变换与时频平面变换直接关联的内在属性。本实践问题研究时间压缩对信号语谱图的影响，揭示了时间与频率尺度变换之间的基本反比关系。对于正确解读被加速或减速的信号的语谱图而言，理解这一属性至关重要。[@problem_id:1765762]", "problem": "在信号处理中，频谱图是一种强大的工具，用于可视化信号的频率内容随时间的变化。它通过计算短时傅里叶变换（STFT）生成。对于一个给定的信号 $x(t)$，其频谱图可以被看作是一个二维图，其中水平轴代表时间（$t$），垂直轴代表频率（$f$），而任何点 $(t, f)$ 处的强度或颜色表示信号在该特定时间和频率下的分量大小。\n\n考虑一个任意的非零信号 $x(t)$。通过对原始信号进行时间压缩，创建一个新信号 $y(t)$，使得 $y(t) = x(3t)$。\n\n与原始信号 $x(t)$ 的频谱图相比，新信号 $y(t)$ 的频谱图在时频平面上是如何进行几何变换的？\n\nA. 沿时间轴压缩3倍，并沿频率轴压缩3倍。\n\nB. 沿时间轴拉伸3倍，并沿频率轴压缩3倍。\n\nC. 沿时间轴压缩3倍，并沿频率轴拉伸3倍。\n\nD. 沿时间轴拉伸3倍，并沿频率轴拉伸3倍。\n\nE. 它仅沿时间轴压缩3倍，而沿频率轴的特征保持在相同位置。", "solution": "我们将信号的频谱图定义为其短时傅里叶变换（STFT）的幅度的平方。使用窗函数 $w$，信号 $x$ 的STFT为\n$$\n\\mathrm{STFT}_{x}(t,f)=\\int_{-\\infty}^{\\infty} x(\\tau)\\, w(\\tau - t)\\, \\exp\\!\\left(-\\mathrm{j}2\\pi f \\tau\\right)\\, \\mathrm{d}\\tau,\n$$\n且频谱图为 $S_{x}(t,f)=|\\mathrm{STFT}_{x}(t,f)|^{2}$。\n\n给定 $y(t)=x(3t)$，计算其STFT：\n$$\n\\mathrm{STFT}_{y}(t,f)=\\int_{-\\infty}^{\\infty} x(3\\tau)\\, w(\\tau - t)\\, \\exp\\!\\left(-\\mathrm{j}2\\pi f \\tau\\right)\\, \\mathrm{d}\\tau.\n$$\n应用变量代换 $u=3\\tau$，因此 $\\tau=u/3$ 且 $\\mathrm{d}\\tau=\\mathrm{d}u/3$：\n$$\n\\mathrm{STFT}_{y}(t,f)=\\frac{1}{3}\\int_{-\\infty}^{\\infty} x(u)\\, w\\!\\left(\\frac{u}{3}-t\\right)\\, \\exp\\!\\left(-\\mathrm{j}2\\pi \\frac{f}{3} u\\right)\\, \\mathrm{d}u.\n$$\n定义一个缩放后的窗函数 $\\tilde{w}(s)=w\\!\\left(\\frac{s}{3}\\right)$。那么 $w\\!\\left(\\frac{u}{3}-t\\right)=\\tilde{w}(u-3t)$，上式变为\n$$\n\\mathrm{STFT}_{y}(t,f)=\\frac{1}{3}\\int_{-\\infty}^{\\infty} x(u)\\, \\tilde{w}(u-3t)\\, \\exp\\!\\left(-\\mathrm{j}2\\pi \\frac{f}{3} u\\right)\\, \\mathrm{d}u\n=\\frac{1}{3}\\,\\mathrm{STFT}_{x}^{(\\tilde{w})}(3t,\\tfrac{f}{3}),\n$$\n其中 $\\mathrm{STFT}_{x}^{(\\tilde{w})}$ 表示用窗函数 $\\tilde{w}$ 计算的 $x$ 的STFT。\n\n取幅度的平方，得到频谱图的关系式\n$$\nS_{y}(t,f)=\\left|\\mathrm{STFT}_{y}(t,f)\\right|^{2}\n=\\frac{1}{9}\\, \\left|\\mathrm{STFT}_{x}^{(\\tilde{w})}(3t,\\tfrac{f}{3})\\right|^{2}.\n$$\n因此，除了一个总体的强度因子和窗函数的重新缩放外，特征的几何映射为\n$$\n(t,f)\\mapsto \\left(\\frac{t}{3},\\, 3f\\right),\n$$\n也就是说，特征沿时间轴压缩3倍，沿频率轴拉伸3倍。因此，正确选项是C。", "answer": "$$\\boxed{C}$$", "id": "1765762"}, {"introduction": "语谱图的强大功能伴随着一个由不确定性原理决定的关键权衡：您无法同时在时间和频率上都达到完美的解析度。本练习通过一个通断正弦波的实际例子，展示了分析窗长的选择如何直接影响您的观测结果。通过比较短窗和长窗的结果，您将对如何调整分析方法以突显时间事件或精细频率细节产生实践性的理解。[@problem_id:1765705]", "problem": "考虑一个信号 $x(t)$，它由一个周期性矩形脉冲序列对一个纯正弦音进行门控而生成。该正弦音由 $c(t) = \\cos(2\\pi f_c t)$ 描述，其中载波频率为 $f_c = 1000$ Hz。\n\n门控信号 $p(t)$ 是一个周期性矩形脉冲序列，其周期为 $T_p = 200$ 毫秒。其占空比为50%，意味着在每个周期内，脉冲在 $D = 100$ 毫秒的持续时间内为“高”（值为1），在剩余的100毫秒内为“低”（值为0）。最终得到的信号为 $x(t) = c(t) \\cdot p(t)$。\n\n我们需要计算该信号 $x(t)$ 的语谱图。语谱图是短时傅里叶变换（STFT）的幅度平方，它使用一个滑动窗口來分析信号随时间变化的频率内容。我们将根据分析窗口的长度 $T_w$ 考虑两种不同的情景。\n\n- **情景1：** 窗口长度为 $T_w = 10$ 毫秒。\n- **情景2：** 窗口长度为 $T_w = 500$ 毫秒。\n\n以下哪个陈述为这两种情景下语谱图中的主导特征提供了最准确的定性描述？\n\nA.\n- 情景1：在频率 $f_c$ 附近有一个显著特征，该特征以200毫秒的周期出现和消失。该特征出现约100毫秒，消失100毫秒。短窗口导致了显著的频率展宽。\n- 情景2：在载波频率 $f_c = 1000$ Hz 和边带频率 $f_c \\pm k f_p$（其中 $f_p=5$ Hz）处有一组锐利、连续的水平线。对于较大的整数值 $|k|$，这些线的强度会减弱，并且对应于偶数非零值 $k$ 的谱线（例如，在 $1000 \\pm 10$ Hz, $1000 \\pm 20$ Hz 处）不存在。\n\nB.\n- 情景1：在载波频率 $f_c = 1000$ Hz 和边带频率 $f_c \\pm k f_p$（其中 $f_p=5$ Hz）处有一组锐利、连续的水平线。对于较大的整数值 $|k|$，这些线的强度会减弱，并且对应于偶数非零值 $k$ 的谱线不存在。\n- 情景2：在频率 $f_c$ 附近有一个显著特征，该特征以200毫秒的周期出现和消失。该特征出现约100毫秒，消失100毫秒。\n\nC.\n- 情景1：在频率 $f_c$ 附近有一个显著特征，该特征以200毫秒的周期出现和消失。该特征出现约100毫秒，消失100毫秒。短窗口导致了显著的频率展宽。\n- 情景2：仅在 $k$ 为奇数值时的边带频率 $f_c \\pm k f_p$（其中 $f_p=5$ Hz）处有一组锐利、连续的水平线。位于载波频率 $f_c=1000$ Hz 处的中心谱线不存在。\n\nD.\n- 情景1：在频率 $f_c = 1000$ Hz 处有一条单一、连续的水平线，该线被每100毫秒出现一次的周期性垂直线（宽带脉冲）所切割。\n- 情景2：在载波频率 $f_c = 1000$ Hz 和边带频率 $f_c \\pm k f_p$（其中 $f_p=5$ Hz）处有一组锐利、连续的水平线。对于较大的整数值 $|k|$，这些线的强度会减弱，并且对应于偶数非零值 $k$ 的谱线（例如，在 $1000 \\pm 10$ Hz, $1000 \\pm 20$ Hz 处）不存在。\n\nE.\n- 情景1：在频率 $f_c$ 附近有一个显著特征，该特征以200毫秒的周期出现和消失。该特征出现约100毫秒，消失100毫秒。短窗口导致了显著的频率展宽。\n- 情景2：在载波频率 $f_c = 1000$ Hz 和边带频率 $f_c \\pm k f_p$（其中 $f_p=5$ Hz）处有一组锐利、连续的水平线。所有整数值 $k$ 都会产生可见的谱线，其强度随着 $|k|$ 的增加而平滑减弱。", "solution": "问题要求在两种不同的短时傅里叶变换（STFT）窗口长度下，预测一个门控正弦信号的语谱图的外观。关键原理是时频不确定性原理：短时间窗口提供良好的时间分辨率但频率分辨率较差，而长时间窗口提供良好的频率分辨率但时间分辨率较差。\n\n信号为 $x(t) = \\cos(2\\pi f_c t) \\cdot p(t)$，其中 $f_c = 1000$ Hz。脉冲序列 $p(t)$ 的周期为 $T_p = 200$ 毫秒，脉冲持续时间为 $D = 100$ 毫秒（50%占空比）。脉冲序列的基频为 $f_p = 1/T_p = 1/0.2 = 5$ Hz。\n\n**情景1分析：短窗口 ($T_w = 10$ 毫秒)**\n\n在这种情景下，窗口长度 $T_w=10$ 毫秒远小于脉冲持续时间（$D=100$ 毫秒）和周期（$T_p=200$ 毫秒）。\n- **时间分辨率：** 时间分辨率很高，量级为 $T_w$。STFT可以分辨发生在大于10毫秒时间尺度上的事件。由于信号开启100毫秒然后关闭100毫秒，STFT可以清晰地分辨这些“开”和“关”的状态。\n- **频率分辨率：** 频率分辨率很差，量级为 $\\Delta f \\approx 1/T_w = 1/0.01 = 100$ Hz。STFT无法分辨频率间隔小于约100 Hz的频率分量。\n\n当STFT窗口位于“开”区间内时，它分析的是一段纯正弦信号 $\\cos(2\\pi f_c t)$。变换结果将显示一个以 $f_c = 1000$ Hz为中心的能量峰。由于频率分辨率差，这个峰会很宽，展宽到大约100 Hz的频率范围内。\n当窗口位于“关”区间内时，它分析的是一个零信号，所以变换结果将显示接近零的能量。\n\n随着窗口在时间上滑动，语谱图将显示一个以 $f_c=1000$ Hz为中心的特征，它出现100毫秒，然后消失100毫秒，并以 $T_p=200$ 毫秒的周期重复。这与选项A、C和E的第一部分相符。\n\n**情景2分析：长窗口 ($T_w = 500$ 毫秒)**\n\n在这种情景下，窗口长度 $T_w = 500$ 毫秒远大于脉冲序列的周期（$T_p = 200$ 毫秒）。\n- **时间分辨率：** 时间分辨率很差，量级为 $T_w=500$ 毫秒。STFT窗口总是覆盖多个“开”和“关”的周期（具体来说是 $500/200 = 2.5$ 个周期）。它无法在时间上分辨单个的开/关事件。因此，生成的语谱图在时间上会显得连续，不会显示周期性的闪烁。\n- **频率分辨率：** 频率分辨率极佳，量级为 $\\Delta f \\approx 1/T_w = 1/0.5 = 2$ Hz。STFT可以分辨频率间隔大于2 Hz的频率分量。这足以分辨由5 Hz脉冲序列引起的频谱结构。\n\n为了理解这种结构，我们在频域中分析该信号。信号 $x(t)$ 是两个信号的乘积，所以它的傅里叶变换 $X(f)$ 是它们各自变换的卷积：\n$X(f) = \\mathcal{F}\\{\\cos(2\\pi f_c t)\\} * \\mathcal{F}\\{p(t)\\}$\n\n正弦信号的傅里叶变换是两个δ函数：\n$\\mathcal{F}\\{\\cos(2\\pi f_c t)\\} = \\frac{1}{2}[\\delta(f-f_c) + \\delta(f+f_c)]$\n\n脉冲序列 $p(t)$ 是周期性的，所以其傅里叶变换是一串位于基频 $f_p=5$ Hz整数倍处的δ函数。这些δ函数的权重由 $p(t)$ 的傅里叶级数系数 $c_k$ 给出。\n$\\mathcal{F}\\{p(t)\\} = \\sum_{k=-\\infty}^{\\infty} c_k \\delta(f - k f_p)$\n\n对于一个占空比为50%（$D=T_p/2$）的矩形脉冲序列，其系数由下式给出：\n$c_k = \\frac{1}{T_p} \\int_{-D/2}^{D/2} (1) \\cdot e^{-j 2\\pi k f_p t} dt = \\frac{1}{T_p} \\int_{-T_p/4}^{T_p/4} e^{-j 2\\pi k t/T_p} dt$\n$c_k = \\frac{1}{T_p} \\left[ \\frac{e^{-j 2\\pi k t/T_p}}{-j 2\\pi k/T_p} \\right]_{-T_p/4}^{T_p/4} = \\frac{1}{-j 2\\pi k} (e^{-j \\pi k/2} - e^{j \\pi k/2}) = \\frac{-2j \\sin(-\\pi k/2)}{-j 2\\pi k} = \\frac{\\sin(\\pi k/2)}{\\pi k}$\n这是一个归一化的sinc函数：$c_k = \\frac{1}{2}\\text{sinc}(\\frac{k}{2})$。\n\n我们来计算几个 $k$ 值对应的 $c_k$：\n- $k=0$: $c_0 = \\lim_{k\\to 0} \\frac{\\sin(\\pi k/2)}{\\pi k} = \\frac{\\pi/2}{\\pi} = 1/2$。（直流分量为0.5，与50%占空比的预期相符）。\n- $k=\\pm 1$: $c_{\\pm 1} = \\frac{\\sin(\\pm \\pi/2)}{\\pm \\pi} = \\frac{\\pm 1}{\\pm \\pi} = 1/\\pi$。\n- $k=\\pm 2$: $c_{\\pm 2} = \\frac{\\sin(\\pm \\pi)}{\\pm 2\\pi} = 0$。\n- $k=\\pm 3$: $c_{\\pm 3} = \\frac{\\sin(\\pm 3\\pi/2)}{\\pm 3\\pi} = \\frac{\\mp 1}{\\pm 3\\pi} = -1/(3\\pi)$。\n- $k=\\pm 4$: $c_{\\pm 4} = \\frac{\\sin(\\pm 2\\pi)}{\\pm 4\\pi} = 0$。\n通常，$c_k=0$ 对所有偶数非零整数 $k$ 成立。\n\n现在，将正弦信号的频谱与脉冲序列的频谱进行卷积，意味着在 $f=\\pm f_c$ 处放置脉冲序列频谱的缩放副本。得到的频谱 $X(f)$（对于正频率）由位于频率 $f_c + k f_p$ 处的δ函数组成：\n$X(f) \\propto \\sum_{k=-\\infty}^{\\infty} c_k \\delta(f - (f_c + k f_p))$\n高分辨率的STFT将把这些δ函数分辨为锐利的谱线。因此，语谱图将在频率 $f = f_c + k \\cdot 5$ Hz 处显示连续的水平线。\n\n这些线的强度与 $|c_k|^2$ 成正比。\n- 在 $f_c$ 处存在一条强谱线（对应 $k=0$）。\n- 在 $f_c \\pm 5$ Hz 处存在谱线（对应 $k=\\pm 1$）。\n- 在 $f_c \\pm 10$ Hz 处的谱线不存在（对应 $k=\\pm 2$），因为 $c_{\\pm 2} = 0$。\n- 在 $f_c \\pm 15$ Hz 处存在谱线（对应 $k=\\pm 3$）。\n- 在 $f_c \\pm 20$ Hz 处的谱线不存在（对应 $k=\\pm 4$），因为 $c_{\\pm 4} = 0$。\n依此类推。这与选项A的第二部分相符。\n\n**评估选项：**\n- **A：** 根据上述分析，正确描述了两种情景。\n- **B：** 错误地交换了两种情景的描述。\n- **C：** 错误地声称情景2中位于 $f_c$ 的中心谱线不存在。$k=0$ 的分量（$c_0$）是非零的。\n- **D：** 错误地描述了情景1。垂直线意味着脉冲性的宽带事件，而门控产生的是窄带信号的周期性片段。\n- **E：** 错误地描述了情景2。它没有考虑到频谱中在离载波为 $f_p$ 偶数倍处的零点，这是50%占空比脉冲序列的一个特有特征。\n\n因此，选项A是唯一准确描述了两种情况的选项。", "answer": "$$\\boxed{A}$$", "id": "1765705"}]}