{"hands_on_practices": [{"introduction": "要想真正掌握小波变换，理解分解和重构的基本机理至关重要。本练习将引导您完成一个完整的流程：使用哈尔（Haar）小波分析一个信号，处理其变换域系数，然后合成一个新的信号。通过亲手完成这些步骤，您将对小波分析与合成的实际工作方式，以及小波域中的修改如何直接影响时域信号，建立起一个具体的认识 [@problem_id:1731109]。", "problem": "在一个信号处理应用中，我们探讨一种对小波系数的简单操作。考虑一个长度为四的离散时间信号，由 $x[n] = \\{3, 1, 4, 0\\}$ 给出。该信号经过一个三步过程：分析、操作和合成。\n\n**步骤1：分析**\n使用单层哈尔离散小波变换（DWT）对信号进行分析。该变换应用于信号值中非重叠的相邻对。对于一个通用对 $(s_a, s_b)$，变换产生一个近似系数 $c_A$ 和一个细节系数 $c_D$，定义如下：\n$$c_A = \\frac{s_a + s_b}{\\sqrt{2}}$$\n$$c_D = \\frac{s_a - s_b}{\\sqrt{2}}$$\n将此应用于信号 $x[n]$，得到一组两个近似系数 $cA_1$ 和一组两个细节系数 $cD_1$。\n\n**步骤2：操作**\n在变换域中，将计算出的两个细节系数进行交换。近似系数保持不变。\n\n**步骤3：合成**\n通过应用哈尔离散小波逆变换，利用原始的近似系数和交换后的细节系数，合成一个新信号 $\\hat{x}[n]$。从对应的系数对 $(c_A, c_D)$ 重建原始对 $(s_a, s_b)$ 的逆变换由下式给出：\n$$s_a = \\frac{c_A + c_D}{\\sqrt{2}}$$\n$$s_b = \\frac{c_A - c_D}{\\sqrt{2}}$$\n\n确定重建信号 $\\hat{x}[n]$。", "solution": "给定作用于相邻、非重叠对的单层哈尔离散小波变换及其逆变换。对于一对信号值 $(s_{a},s_{b})$，其分析系数为\n$$\nc_{A}=\\frac{s_{a}+s_{b}}{\\sqrt{2}},\\quad c_{D}=\\frac{s_{a}-s_{b}}{\\sqrt{2}},\n$$\n其逆变换（合成）为\n$$\ns_{a}=\\frac{c_{A}+c_{D}}{\\sqrt{2}},\\quad s_{b}=\\frac{c_{A}-c_{D}}{\\sqrt{2}}.\n$$\n\n步骤1 (分析)：将 $x[n]=\\{3,1,4,0\\}$ 分为两对 $(3,1)$ 和 $(4,0)$。\n- 对于 $(3,1)$:\n$$\nc_{A,1}=\\frac{3+1}{\\sqrt{2}}=\\frac{4}{\\sqrt{2}}=2\\sqrt{2},\\quad\nc_{D,1}=\\frac{3-1}{\\sqrt{2}}=\\frac{2}{\\sqrt{2}}=\\sqrt{2}.\n$$\n- 对于 $(4,0)$:\n$$\nc_{A,2}=\\frac{4+0}{\\sqrt{2}}=\\frac{4}{\\sqrt{2}}=2\\sqrt{2},\\quad\nc_{D,2}=\\frac{4-0}{\\sqrt{2}}=\\frac{4}{\\sqrt{2}}=2\\sqrt{2}.\n$$\n\n步骤2 (操作)：交换两个细节系数，同时保持近似系数不变：\n$$\n\\tilde{c}_{D,1}=c_{D,2}=2\\sqrt{2},\\quad \\tilde{c}_{D,2}=c_{D,1}=\\sqrt{2},\\quad c_{A,1}=2\\sqrt{2},\\quad c_{A,2}=2\\sqrt{2}.\n$$\n\n步骤3 (合成)：使用逆变换公式重建每一对信号值。\n- 根据 $(c_{A,1},\\tilde{c}_{D,1})=(2\\sqrt{2},2\\sqrt{2})$:\n$$\n\\hat{s}_{a,1}=\\frac{2\\sqrt{2}+2\\sqrt{2}}{\\sqrt{2}}=\\frac{4\\sqrt{2}}{\\sqrt{2}}=4,\\quad\n\\hat{s}_{b,1}=\\frac{2\\sqrt{2}-2\\sqrt{2}}{\\sqrt{2}}=0.\n$$\n- 根据 $(c_{A,2},\\tilde{c}_{D,2})=(2\\sqrt{2},\\sqrt{2})$:\n$$\n\\hat{s}_{a,2}=\\frac{2\\sqrt{2}+\\sqrt{2}}{\\sqrt{2}}=\\frac{3\\sqrt{2}}{\\sqrt{2}}=3,\\quad\n\\hat{s}_{b,2}=\\frac{2\\sqrt{2}-\\sqrt{2}}{\\sqrt{2}}=\\frac{\\sqrt{2}}{\\sqrt{2}}=1.\n$$\n\n因此，重建信号为 $\\hat{x}[n]=\\{4,0,3,1\\}$。", "answer": "$$\\boxed{\\begin{pmatrix}4 & 0 & 3 & 1\\end{pmatrix}}$$", "id": "1731109"}, {"introduction": "在学习了变换的计算方法之后，让我们来探究其系数背后的意义。细节系数旨在捕捉信号中的局部变化或“细节”。本练习将挑战您进行逆向思考：什么样的信号会产生零值的细节系数？解答这个问题将揭示一个核心原理，即哈尔小波的细节系数实际上充当了简单的差分检测器 [@problem_id:1731140]，这有助于您更深刻地理解变换的内涵。", "problem": "在离散信号分析中，离散小波变换 (DWT) 是根据信号的局部特性来表示信号的强大工具。它将信号分解为近似（低频）分量和细节（高频）分量。\n\n考虑一个为 $n = 0, 1, 2, 3$ 定义的简单的实值四点信号 $x[n]$。使用 Haar 小波系统对该信号进行第一级DWT分解，将信号分为一个两点近似系数信号 $a_1[k]$ 和一个两点细节系数信号 $d_1[k]$，其中 $k=0,1$。\n\n分解是使用低通滤波器 $h[n]$ 和高通滤波器 $g[n]$ 进行的。对于 Haar 小波系统，这些滤波器定义如下：\n$$h[n] = \\begin{cases} 1/\\sqrt{2} & n=0, 1 \\\\ 0 & \\text{否则} \\end{cases}$$\n$$g[n] = \\begin{cases} 1/\\sqrt{2} & n=0 \\\\ -1/\\sqrt{2} & n=1 \\\\ 0 & \\text{否则} \\end{cases}$$\n\n近似和细节系数使用标准分析方程计算：\n$$a_1[k] = \\sum_{m} x[m] h[m - 2k]$$\n$$d_1[k] = \\sum_{m} x[m] g[m - 2k]$$\n\n下列哪个选项提供了一个非零信号 $x[n]$ 的示例，其中**所有**第一级细节系数 $d_1[k]$ 均为零，并正确描述了任何此类信号在此分解级别上必须具备的一般属性？\n\nA. 信号: $\\{2, 2, -4, -4\\}$。属性：信号在不重叠的双样本块上是分段常数。\n\nB. 信号: $\\{1, 2, 4, 8\\}$。属性：信号呈指数增长。\n\nC. 信号: $\\{3, 3, 3, 3\\}$。属性：信号在其整个长度上必须是恒定直流信号。\n\nD. 信号: $\\{1, 3, 3, 1\\}$。属性：信号必须是对称的（回文的）。\n\nE. 信号: $\\{5, -5, 5, -5\\}$。属性：信号是纯振荡的，其平均值为零。", "solution": "第一级 Haar DWT 细节系数计算如下\n$$\nd_{1}[k]=\\sum_{m}x[m]\\,g[m-2k],\n$$\n其中给定的 $g[n]$ 满足 $g[0]=\\frac{1}{\\sqrt{2}}$，$g[1]=-\\frac{1}{\\sqrt{2}}$，否则 $g[n]=0$。\n\n对于 $k=0$,\n$$\nd_{1}[0]=\\sum_{m}x[m]\\,g[m]=x[0]g[0]+x[1]g[1]=\\frac{1}{\\sqrt{2}}x[0]-\\frac{1}{\\sqrt{2}}x[1]=\\frac{x[0]-x[1]}{\\sqrt{2}}.\n$$\n对于 $k=1$,\n$$\nd_{1}[1]=\\sum_{m}x[m]\\,g[m-2]=x[2]g[0]+x[3]g[1]=\\frac{1}{\\sqrt{2}}x[2]-\\frac{1}{\\sqrt{2}}x[3]=\\frac{x[2]-x[3]}{\\sqrt{2}}.\n$$\n因此，所有第一级细节系数均为零的充分必要条件是\n$$\nd_{1}[0]=0 \\;\\;\\Longleftrightarrow\\;\\; x[0]=x[1],\\qquad d_{1}[1]=0 \\;\\;\\Longleftrightarrow\\;\\; x[2]=x[3].\n$$\n因此，充分必要条件是信号在不重叠的双样本块 $\\{x[0],x[1]\\}$ 和 $\\{x[2],x[3]\\}$ 上是分段常数；这两个块不必具有相同的常数值。\n\n现在检查各个选项：\n- A: $\\{2,2,-4,-4\\}$ 得到 $d_{1}[0]=\\frac{2-2}{\\sqrt{2}}=0$ 且 $d_{1}[1]=\\frac{-4-(-4)}{\\sqrt{2}}=0$，其陈述的属性与推导出的条件相匹配。\n- B: $\\{1,2,4,8\\}$ 得到 $d_{1}[0]=\\frac{1-2}{\\sqrt{2}}\\neq 0$，因此不成立。\n- C: $\\{3,3,3,3\\}$ 得到零细节系数，但所述属性“必须在整个长度上恒定”不是必要的；它只是真实条件的一个特例，因此描述不正确。\n- D: $\\{1,3,3,1\\}$ 得到 $d_{1}[0]=\\frac{1-3}{\\sqrt{2}}\\neq 0$，因此不成立，且所述属性不是一般条件。\n- E: $\\{5,-5,5,-5\\}$ 得到 $d_{1}[0]=\\frac{5-(-5)}{\\sqrt{2}}\\neq 0$，因此不成立。\n\n因此，正确选项是A，而正确的一般属性是信号在此级别上在每个双样本块内是恒定的。", "answer": "$$\\boxed{A}$$", "id": "1731140"}, {"introduction": "小波函数的选择并非随意的；它会显著影响变换在特定应用（如压缩）中的效果。一个关键的性能指标是“能量集中度”——即将信号能量集中到少数几个高幅值系数中的能力。本练习将比较简单的哈尔小波与更平滑的 Daubechies D4 小波在处理一个高斯信号时的性能，通过动手计算，直观展示如何通过匹配小波形状与信号特征来提升能量集中度 [@problem_id:1731106]。", "problem": "离散小波变换（DWT）在信号处理中的一个重要应用是压缩，它依赖于能量集中原理。如果一个变换能用少数几个大幅值系数来表示信号的能量，那么该变换就为信号提供了良好的能量集中性。\n\n考虑一个长度为 `N=8` 的离散时间信号 `x[n]`，它表示一个采样的高斯脉冲。信号的值如下所示：\n`x = [0.00219, 0.04393, 0.32465, 0.88250, 0.88250, 0.32465, 0.04393, 0.00219]`\n\n单层DWT将此信号分解为一组近似系数 `cA` 和一组细节系数 `cD`。近似系数是通过将信号与低通滤波器 `h` 进行卷积，然后以2为因子进行下采样得到的。卷积应使用周期性边界条件（也称为循环卷积）进行。\n\n我们希望比较两种不同的小波对该信号的能量集中性能：Haar小波和Daubechies 4抽头（D4）小波。各自的低通滤波器系数 `h` 如下所示。\n- Haar滤波器： `h_Haar = [0.70711, 0.70711]`\n- Daubechies 4抽头（D4）滤波器： `h_D4 = [0.48296, 0.83652, 0.22414, -0.12941]`\n\n一组系数中所含的能量是这些系数幅值平方的和。令 `E_Haar` 为使用Haar滤波器得到的近似系数 `cA` 的能量，令 `E_D4` 为使用D4滤波器得到的近似系数 `cA` 的能量。\n\n计算比率 `R = E_D4 / E_Haar`。将最终答案四舍五入到四位有效数字。", "solution": "给定一个长度为 $N=8$ 的实值离散时间信号 $x[n]$，其边界条件为周期性（循环卷积），以及两个低通分析滤波器 $h_{\\text{Haar}}$ 和 $h_{\\text{D4}}$。单层DWT的近似序列 $cA$ 是通过将 $x[n]$ 与 $h[m]$ 进行循环卷积，然后以2为因子下采样得到的。使用标准的离散循环卷积，\n$$\ny_{h}[n] = \\sum_{m=0}^{L-1} h[m]\\,x[(n-m)\\bmod N],\\quad cA[k] = y_{h}[2k],\\quad k=0,1,2,3.\n$$\n给定的信号值为\n$$\nx[0]=0.00219,\\;x[1]=0.04393,\\;x[2]=0.32465,\\;x[3]=0.88250,\\;x[4]=0.88250,\\;x[5]=0.32465,\\;x[6]=0.04393,\\;x[7]=0.00219.\n$$\n\nHaar情况：$h_{\\text{Haar}}[0]=0.70711$, $h_{\\text{Haar}}[1]=0.70711$。循环卷积为\n$$\ny_{\\text{Haar}}[n]=0.70711\\,x[n]+0.70711\\,x[n-1].\n$$\n在偶数索引处进行下采样得到\n$$\n\\begin{aligned}\ncA_{\\text{Haar}}[0]&=y_{\\text{Haar}}[0]=0.70711\\,(x[0]+x[7])=0.70711\\cdot(0.00219+0.00219)=0.0030971418,\\\\\ncA_{\\text{Haar}}[1]&=y_{\\text{Haar}}[2]=0.70711\\,(x[2]+x[1])=0.70711\\cdot(0.32465+0.04393)=0.2606266038,\\\\\ncA_{\\text{Haar}}[2]&=y_{\\text{Haar}}[4]=0.70711\\,(x[4]+x[3])=0.70711\\cdot(0.88250+0.88250)=1.24804915,\\\\\ncA_{\\text{Haar}}[3]&=y_{\\text{Haar}}[6]=0.70711\\,(x[6]+x[5])=0.70711\\cdot(0.04393+0.32465)=0.2606266038.\n\\end{aligned}\n$$\n因此近似能量为\n$$\n\\begin{aligned}\nE_{\\text{Haar}}&=\\sum_{k=0}^{3}\\bigl(cA_{\\text{Haar}}[k]\\bigr)^{2}\\\\\n&=(0.0030971418)^{2}+(0.2606266038)^{2}+(1.24804915)^{2}+(0.2606266038)^{2}\\\\\n&=9.592287329\\times 10^{-6}+0.067926226608322+1.5576266808157225+0.067926226608322\\\\\n&\\approx 1.6934887263196955.\n\\end{aligned}\n$$\n\nDaubechies-4情况：$h_{\\text{D4}}[0]=0.48296$, $h_{\\text{D4}}[1]=0.83652$, $h_{\\text{D4}}[2]=0.22414$, $h_{\\text{D4}}[3]=-0.12941$。在偶数索引处的循环卷积得到\n$$\n\\begin{aligned}\ny_{\\text{D4}}[0]&=0.48296\\,x[0]+0.83652\\,x[-1]+0.22414\\,x[-2]-0.12941\\,x[-3]\\\\\n&=0.48296\\,x[0]+0.83652\\,x[7]+0.22414\\,x[6]-0.12941\\,x[5]\\\\\n&=0.48296\\cdot 0.00219+0.83652\\cdot 0.00219+0.22414\\cdot 0.04393-0.12941\\cdot 0.32465\\\\\n&=0.0010576824+0.0018319788+0.0098464702-0.0420129565\\\\\n&=-0.0292768251, \\\\[6pt]\ny_{\\text{D4}}[2]&=0.48296\\,x[2]+0.83652\\,x[1]+0.22414\\,x[0]-0.12941\\,x[7]\\\\\n&=0.48296\\cdot 0.32465+0.83652\\cdot 0.04393+0.22414\\cdot 0.00219-0.12941\\cdot 0.00219\\\\\n&=0.156792964+0.0367483236+0.0004908666-0.0002834079\\\\\n&=0.1937487463, \\\\[6pt]\ny_{\\text{D4}}[4]&=0.48296\\,x[4]+0.83652\\,x[3]+0.22414\\,x[2]-0.12941\\,x[1]\\\\\n&=0.48296\\cdot 0.88250+0.83652\\cdot 0.88250+0.22414\\cdot 0.32465-0.12941\\cdot 0.04393\\\\\n&=0.4262122+0.7382289+0.072767051-0.0056849813\\\\\n&=1.2315231697, \\\\[6pt]\ny_{\\text{D4}}[6]&=0.48296\\,x[6]+0.83652\\,x[5]+0.22414\\,x[4]-0.12941\\,x[3]\\\\\n&=0.48296\\cdot 0.04393+0.83652\\cdot 0.32465+0.22414\\cdot 0.88250-0.12941\\cdot 0.88250\\\\\n&=0.0212164328+0.271576218+0.19780355-0.114204325\\\\\n&=0.3763918758.\n\\end{aligned}\n$$\n因此 $cA_{\\text{D4}}=[-0.0292768251,\\;0.1937487463,\\;1.2315231697,\\;0.3763918758]$ 且近似能量为\n$$\n\\begin{aligned}\nE_{\\text{D4}}&=\\sum_{k=0}^{3}\\bigl(cA_{\\text{D4}}[k]\\bigr)^{2}\\\\\n&=(-0.0292768251)^{2}+(0.1937487463)^{2}+(1.2315231697)^{2}+(0.3763918758)^{2}\\\\\n&=0.000857132487936+0.03753857669282176+1.516649317508+0.1416708441682426\\\\\n&\\approx 1.6967158708570004.\n\\end{aligned}\n$$\n\n所求的比率为\n$$\nR=\\frac{E_{\\text{D4}}}{E_{\\text{Haar}}}=\\frac{1.6967158708570004}{1.6934887263196955}\\approx 1.001905616.\n$$\n四舍五入到四位有效数字得到\n$$\nR\\approx 1.002.\n$$", "answer": "$$\\boxed{1.002}$$", "id": "1731106"}]}