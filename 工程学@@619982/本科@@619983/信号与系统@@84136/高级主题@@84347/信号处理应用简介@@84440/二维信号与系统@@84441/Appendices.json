{"hands_on_practices": [{"introduction": "二维卷积是图像处理的基石，构成了从模糊到边缘检测等一系列操作的基础。在深入研究数值计算细节之前，对卷积如何影响信号的几何形状建立起直观理解是极其宝贵的。此练习 [@problem_id:1772667] 挑战你仅通过分析输入信号和滤波器核的形状，来确定输出信号的支撑区域，从而为理解这一关键操作提供一个强大的视觉基础。", "problem": "在数字信号处理中，两个信号的卷积是一种基本运算。考虑一个离散时间二维信号，记为 $x[n_1, n_2]$，其中 $n_1$ 和 $n_2$ 是整数索引。该信号被定义为仅在一组特定的坐标上非零。具体来说，$x[n_1, n_2]$ 在坐标 $(0,0)$、$(1,0)$、$(2,0)$、$(0,1)$ 和 $(0,2)$ 处的值为1，在所有其他坐标处的值为0。\n\n该信号由一个滤波器处理，其脉冲响应由核 $h[n_1, n_2]$ 给出。该核在坐标 $(0,0)$、$(0,1)$、$(1,0)$ 和 $(1,1)$ 处的值为1，在其他所有地方的值为0。\n\n输出信号 $y[n_1, n_2]$ 是 $x[n_1, n_2]$ 和 $h[n_1, n_2]$ 的二维离散卷积。一个信号的支撑集定义为该信号值非零的所有坐标点 $(n_1, n_2)$ 的集合。\n\n确定输出信号 $y[n_1, n_2]$ 的支撑集中的点的总数。", "solution": "给定一个二维离散信号 $x[n_{1},n_{2}]$ 和一个二维滤波器 $h[n_{1},n_{2}]$，两者都是具有有限支撑集的二值信号。输出是二维卷积\n$$\ny[n_{1},n_{2}] = \\sum_{k_{1}}\\sum_{k_{2}} x[k_{1},k_{2}]\\,h[n_{1}-k_{1},\\,n_{2}-k_{2}] .\n$$\n令 $S_{x}$ 和 $S_{h}$ 分别表示 $x$ 和 $h$ 的支撑集。要使 $y[n_{1},n_{2}]$ 非零，必须存在 $(k_{1},k_{2}) \\in S_{x}$ 和 $(s_{1},s_{2}) \\in S_{h}$ 使得 $n_{1}-k_{1}=s_{1}$ 和 $n_{2}-k_{2}=s_{2}$，即 $(n_{1},n_{2})=(k_{1}+s_{1},k_{2}+s_{2})$。由于所有值都是非负的（具体来说是0和1），这样一对坐标的存在会产生至少一个严格为正的加数，所以 $y[n_{1},n_{2}] \\neq 0$。反过来，任何可以表示为 $(k_{1},k_{2})+(s_{1},s_{2})$ 形式的 $(n_{1},n_{2})$（其中 $(k_{1},k_{2}) \\in S_{x}$ 且 $(s_{1},s_{2}) \\in S_{h}$）都会使得 $y[n_{1},n_{2}]$ 非零。因此，$y$ 的支撑集恰好是闵可夫斯基和\n$$\nS_{y} \\;=\\; S_{x} + S_{h} \\;=\\; \\{\\, p+q : p \\in S_{x},\\; q \\in S_{h} \\,\\}.\n$$\n\n给定\n$$\nS_{x}=\\{(0,0),(1,0),(2,0),(0,1),(0,2)\\}\n$$\n和\n$$\nS_{h}=\\{(0,0),(0,1),(1,0),(1,1)\\}=\\{0,1\\}\\times\\{0,1\\}.\n$$\n将 $S_{x}$ 分解为一个水平臂 $H=\\{(i,0): i=0,1,2\\}$ 和一个垂直臂 $V=\\{(0,j): j=0,1,2\\}$。那么\n$$\nH+S_{h}=\\{(i+a,\\,0+b): i \\in \\{0,1,2\\},\\; a,b \\in \\{0,1\\}\\}\n=\\{(u,v): 0 \\leq u \\leq 3,\\; 0 \\leq v \\leq 1\\},\n$$\n这是一个大小为 $4 \\times 2$ 的矩形，因此 $|H+S_{h}|=8$。\n\n类似地，\n$$\nV+S_{h}=\\{(0+a,\\,j+b): j \\in \\{0,1,2\\},\\; a,b \\in \\{0,1\\}\\}\n=\\{(u,v): 0 \\leq u \\leq 1,\\; 0 \\leq v \\leq 3\\},\n$$\n这是一个大小为 $2 \\times 4$ 的矩形，因此 $|V+S_{h}|=8$。\n\n完整的支撑集是其并集\n$$\nS_{y}=(H+S_{h}) \\cup (V+S_{h}).\n$$\n它们的交集是矩形\n$$\n(H+S_{h}) \\cap (V+S_{h})=\\{(u,v): 0 \\leq u \\leq 1,\\; 0 \\leq v \\leq 1\\},\n$$\n其大小为 $2 \\times 2=4$。根据容斥原理，\n$$\n|S_{y}| = |H+S_{h}| + |V+S_{h}| - |(H+S_{h}) \\cap (V+S_{h})|\n= 8 + 8 - 4 = 12.\n$$\n因此，输出信号 $y[n_{1},n_{2}]$ 的支撑集中的点的总数是 $12$。", "answer": "$$\\boxed{12}$$", "id": "1772667"}, {"introduction": "要真正理解像图像这样的二维信号，我们不仅要观察其空间结构，还必须分析其频率成分。二维离散傅里叶变换 (DFT) 是我们实现这一目标的主要工具，它能揭示信号中潜在的周期性分量。这个基础练习 [@problem_id:1772630] 将指导你手动计算一个简单的 $2 \\times 2$ DFT，为你揭示从空间域到频率域转换的核心机制。", "problem": "考虑一个大小为 $2 \\times 2$ 的二维离散信号 $x[n_1, n_2]$，其定义域为索引 $n_1, n_2 \\in \\{0, 1\\}$。信号的值如下所示：\n$x[0,0] = 3$\n$x[0,1] = 1$\n$x[1,0] = 1$\n$x[1,1] = 3$\n\n你的任务是计算该信号的 $2 \\times 2$ 离散傅里叶变换 (DFT)，我们将其表示为 $X[k_1, k_2]$。请将你的最终答案以一个 $2 \\times 2$ 矩阵的形式呈现，其中第一行第一列的元素是 $X[0,0]$，第一行第二列的元素是 $X[0,1]$，以此类推。", "solution": "一个大小为 $2 \\times 2$ 的信号 $x[n_{1},n_{2}]$ 的二维 DFT 定义为（对于 $k_{1},k_{2} \\in \\{0,1\\}$）：\n$$\nX[k_{1},k_{2}] = \\sum_{n_{1}=0}^{1}\\sum_{n_{2}=0}^{1} x[n_{1},n_{2}] \\exp\\!\\left(-\\mathrm{i}2\\pi\\left(\\frac{k_{1}n_{1}}{2}+\\frac{k_{2}n_{2}}{2}\\right)\\right).\n$$\n当 $N_{1}=N_{2}=2$ 时，指数项可以简化为\n$$\n\\exp\\!\\left(-\\mathrm{i}2\\pi\\left(\\frac{k_{1}n_{1}}{2}+\\frac{k_{2}n_{2}}{2}\\right)\\right)=\\exp\\!\\left(-\\mathrm{i}\\pi(k_{1}n_{1}+k_{2}n_{2})\\right)=(-1)^{k_{1}n_{1}+k_{2}n_{2}}.\n$$\n使用 $x[0,0]=3$, $x[0,1]=1$, $x[1,0]=1$, $x[1,1]=3$，计算每个 DFT 系数：\n\n对于 $(k_{1},k_{2})=(0,0)$，\n$$\nX[0,0]=\\sum_{n_{1}=0}^{1}\\sum_{n_{2}=0}^{1} x[n_{1},n_{2}] = 3+1+1+3=8.\n$$\n\n对于 $(k_{1},k_{2})=(0,1)$，\n$$\nX[0,1]=\\sum_{n_{1}=0}^{1}\\sum_{n_{2}=0}^{1} x[n_{1},n_{2}](-1)^{n_{2}}\n=(x[0,0]+x[1,0])-(x[0,1]+x[1,1])=4-4=0.\n$$\n\n对于 $(k_{1},k_{2})=(1,0)$，\n$$\nX[1,0]=\\sum_{n_{1}=0}^{1}\\sum_{n_{2}=0}^{1} x[n_{1},n_{2}](-1)^{n_{1}}\n=(x[0,0]+x[0,1])-(x[1,0]+x[1,1])=4-4=0.\n$$\n\n对于 $(k_{1},k_{2})=(1,1)$，\n$$\nX[1,1]=\\sum_{n_{1}=0}^{1}\\sum_{n_{2}=0}^{1} x[n_{1},n_{2}](-1)^{n_{1}+n_{2}}\n=3-1-1+3=4.\n$$\n\n因此，行索引为 $k_{1}=0,1$、列索引为 $k_{2}=0,1$ 的 $2 \\times 2$ DFT 矩阵为\n$$\n\\begin{pmatrix}\nX[0,0] & X[0,1] \\\\\nX[1,0] & X[1,1]\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n8 & 0 \\\\\n0 & 4\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}8 & 0 \\\\ 0 & 4\\end{pmatrix}}$$", "id": "1772630"}, {"introduction": "并非所有系统都以简单的前馈方式处理信号；许多系统利用反馈来产生更复杂、更高效的响应，这类系统被称为递归系统或无限冲激响应 (IIR) 滤波器。理解它们行为的第一步是求解其冲激响应。在此练习中 [@problem_id:1772632]，你将推导一个基本二维递归滤波器的冲激响应，探索一个简单的反馈回路如何从一个有限的差分方程中产生无限延伸的响应，这为IIR滤波器的设计和稳定性分析提供了重要启示。", "problem": "一个简单的二维 (2D) 递归滤波器是各种数字图像处理应用中的一个基本组成部分。考虑一个这样的滤波器，其输出（由二维离散信号 $y[n_1, n_2]$ 表示）通过以下线性空间不变差分方程与其输入 $x[n_1, n_2]$ 相关：\n$$y[n_1, n_2] = x[n_1, n_2] + \\alpha y[n_1-1, n_2-1]$$\n此处，$\\alpha$ 是一个实值常数。已知该滤波器是因果的，对于本系统而言，这意味着对于任何满足 $n_1 < 0$ 或 $n_2 < 0$ 的坐标对 $(n_1, n_2)$，其冲激响应 $h[n_1, n_2]$ 均为零。\n\n你的任务是求出该系统的冲激响应 $h[n_1, n_2]$。\n\n请用 $\\alpha$、$n_1$ 和 $n_2$ 将你的答案表示为单个闭式解析表达式。你可以使用标准的离散时间函数：\n- 一维单位阶跃函数 $u[n]$，定义为当 $n \\ge 0$ 时 $u[n] = 1$，当 $n < 0$ 时 $u[n] = 0$。\n- 一维单位冲激函数 $\\delta[n]$，定义为当 $n = 0$ 时 $\\delta[n] = 1$，当 $n \\ne 0$ 时 $\\delta[n] = 0$。", "solution": "线性空间不变系统的冲激响应 $h[n_1, n_2]$ 定义为当输入是二维单位冲激时系统的输出。以原点为中心的二维单位冲激可以表示为两个一维单位冲激的乘积：$x[n_1, n_2] = \\delta[n_1]\\delta[n_2]$。\n\n将 $x[n_1, n_2] = \\delta[n_1]\\delta[n_2]$ 和 $y[n_1, n_2] = h[n_1, n_2]$ 代入给定的差分方程，我们得到决定冲激响应的方程：\n$$h[n_1, n_2] = \\delta[n_1]\\delta[n_2] + \\alpha h[n_1-1, n_2-1]$$\n题目指出系统是因果的，即如果 $n_1 < 0$ 或 $n_2 < 0$，则 $h[n_1, n_2] = 0$。我们可以通过从原点 $(0,0)$ 开始递归地计算其值来求解 $h[n_1, n_2]$。\n\n让我们计算 $h[n_1, n_2]$ 的前几个值：\n对于 $(n_1, n_2) = (0,0)$：\n$h[0,0] = \\delta[0]\\delta[0] + \\alpha h[-1,-1]$\n使用 $\\delta[n]$ 的定义和因果性条件 $h[-1,-1]=0$，我们得到：\n$h[0,0] = (1)(1) + \\alpha(0) = 1$\n\n现在考虑不在主对角线 $n_1=n_2$ 上的点。\n对于 $(n_1, n_2) = (1,0)$：\n$h[1,0] = \\delta[1]\\delta[0] + \\alpha h[0,-1]$\n由于 $\\delta[1]=0$ 且因果性意味着 $h[0,-1]=0$：\n$h[1,0] = (0)(1) + \\alpha(0) = 0$\n\n对于 $(n_1, n_2) = (0,1)$：\n$h[0,1] = \\delta[0]\\delta[1] + \\alpha h[-1,0]$\n由于 $\\delta[1]=0$ 且因果性意味着 $h[-1,0]=0$：\n$h[0,1] = (1)(0) + \\alpha(0) = 0$\n\n让我们研究在 $n_1, n_2 \\ge 0$ 条件下，主对角线 $n_1=n_2$ 上的值。\n对于 $(n_1, n_2) = (1,1)$：\n$h[1,1] = \\delta[1]\\delta[1] + \\alpha h[0,0]$\n由于 $\\delta[1]=0$ 且我们已求得 $h[0,0]=1$：\n$h[1,1] = (0)(0) + \\alpha(1) = \\alpha$\n\n对于 $(n_1, n_2) = (2,2)$：\n$h[2,2] = \\delta[2]\\delta[2] + \\alpha h[1,1]$\n由于 $\\delta[2]=0$ 且我们已求得 $h[1,1]=\\alpha$：\n$h[2,2] = (0)(0) + \\alpha(\\alpha) = \\alpha^2$\n\n我们可以看到，对于 $k \\ge 0$，在对角线 $n_1 = n_2 = k$ 上出现了一个规律。对于任何 $k > 0$，输入项 $\\delta[k]\\delta[k]=0$。递归关系变为 $h[k,k] = \\alpha h[k-1, k-1]$。通过归纳法，我们可以将其推广为：\n$h[k,k] = \\alpha h[k-1, k-1] = \\alpha^2 h[k-2, k-2] = \\dots = \\alpha^k h[0,0] = \\alpha^k$。\n这对所有 $k \\ge 0$ 的整数都成立。\n\n现在我们必须证明，对于第一象限中所有满足 $n_1 \\ne n_2$ 的其他点，$h[n_1, n_2] = 0$。\n对于任何这样的点，$n_1 \\ge 0$ 且 $n_2 \\ge 0$，并且由于 $(n_1, n_2) \\ne (0,0)$，输入项为 $\\delta[n_1]\\delta[n_2] = 0$。递归式为：\n$h[n_1, n_2] = \\alpha h[n_1-1, n_2-1]$\n我们可以将这个递归式展开 $k$ 次：\n$h[n_1, n_2] = \\alpha^k h[n_1-k, n_2-k]$\n情况1：$n_1 > n_2$。我们选择 $k = n_2 + 1$。由于 $n_2 \\ge 0$，我们有 $k \\ge 1$。\n$h[n_1, n_2] = \\alpha^{n_2+1} h[n_1 - (n_2+1), n_2 - (n_2+1)] = \\alpha^{n_2+1} h[n_1 - n_2 - 1, -1]$\n由于 $n_1 > n_2$，所以 $n_1-n_2-1 \\ge 0$。第二个索引是 $-1$，因此根据因果性条件，$h[n_1 - n_2 - 1, -1] = 0$。所以，当 $n_1 > n_2$ 时，$h[n_1, n_2] = 0$。\n情况2：$n_2 > n_1$。我们选择 $k = n_1 + 1$。由于 $n_1 \\ge 0$，我们有 $k \\ge 1$。\n$h[n_1, n_2] = \\alpha^{n_1+1} h[n_1 - (n_1+1), n_2 - (n_1+1)] = \\alpha^{n_1+1} h[-1, n_2 - n_1 - 1]$\n由于 $n_2 > n_1$，所以 $n_2-n_1-1 \\ge 0$。第一个索引是 $-1$，因此根据因果性条件，$h[-1, n_2 - n_1 - 1] = 0$。所以，当 $n_2 > n_1$ 时，$h[n_1, n_2] = 0$。\n\n总而言之，冲激响应仅在第一象限的主对角线上为非零值：\n$$h[n_1, n_2] = \\begin{cases} \\alpha^{n_1} & \\text{当 } n_1 = n_2 \\ge 0 \\text{ 时} \\\\ 0 & \\text{其它} \\end{cases}$$\n我们现在使用给定的函数 $u[n]$ 和 $\\delta[n]$ 来表示这个结果。\n条件 $n_1 = n_2$ 可以用一维冲激函数 $\\delta[n_1 - n_2]$ 来表示。如果该函数的自变量为零（即 $n_1=n_2$），则其值为1，否则为0。\n条件 $n_1 \\ge 0$（由于我们只考虑对角线，这也意味着 $n_2 \\ge 0$）可以用一维单位阶跃函数 $u[n_1]$ 来表示。\n对角线上的响应值为 $\\alpha^{n_1}$。\n将这些分量相乘，得到最终的闭式表达式：\n$$h[n_1, n_2] = \\alpha^{n_1} u[n_1] \\delta[n_1 - n_2]$$\n让我们验证这个表达式。\n- 如果 $n_1 \\ne n_2$，则 $\\delta[n_1 - n_2] = 0$，所以 $h[n_1, n_2] = 0$。正确。\n- 如果 $n_1 = n_2 < 0$，则 $u[n_1] = 0$，所以 $h[n_1, n_2] = 0$。正确。\n- 如果 $n_1 = n_2 \\ge 0$，则 $u[n_1] = 1$ 且 $\\delta[n_1 - n_2] = \\delta[0] = 1$。表达式变为 $h[n_1, n_1] = \\alpha^{n_1}(1)(1) = \\alpha^{n_1}$。正确。\n该表达式精确地表示了推导出的冲激响应。", "answer": "$$\\boxed{\\alpha^{n_1} u[n_1] \\delta[n_1 - n_2]}$$", "id": "1772632"}]}