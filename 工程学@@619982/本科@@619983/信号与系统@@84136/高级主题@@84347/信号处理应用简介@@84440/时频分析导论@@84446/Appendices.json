{"hands_on_practices": [{"introduction": "时频分析的核心在于一个基本的权衡，这类似于物理学中的海森堡不确定性原理。我们无法同时获得完美的时间分辨率和频率分辨率：一个短的分析窗口可以精确地定位事件发生的时间，但会使频率变得模糊；相反，一个长的窗口可以清晰地分辨出相近的频率，但却无法精确知道它们具体在何时出现。这个练习将这个抽象的原则具体化，要求你计算在给定条件下能成功分辨两个紧邻频率分量所需的最小窗口时长 [@problem_id:1730830]。通过这个实践，你将学会如何将定性的理解转化为定量的设计决策，这是进行任何实际谱分析的第一步。", "problem": "一位工程师的任务是分析来自一个精密加工旋转组件的振动信号，以诊断潜在的不平衡问题。该信号的采样率为 $F_s = 10.0 \\text{ kHz}$。初步分析表明，信号中存在两个主要的正弦分量，其频率分别为 $f_1 = 2000.0 \\text{ Hz}$ 和 $f_2 = 1999.3 \\text{ Hz}$。\n\n为了研究这些分量的时变特性，该工程师采用了短时傅里叶变换 (STFT)。分析中使用了 Hann 窗。对于这种窗函数，分辨两个振幅相近的正弦波的一个常用判据是，它们的频率间隔必须至少是在加窗段上计算的离散傅里叶变换 (DFT) 的频率分辨率（或称“谱线间隔”）的两倍。谱线间隔定义为 $\\frac{F_s}{N}$，其中 $N$ 是窗内的采样点数。\n\n根据指定的判据，确定工程师为成功分辨这两个频率分量而必须使用的 Hann 窗的最小持续时间（以毫秒为单位）。答案以毫秒表示，并四舍五入到三位有效数字。", "solution": "给定采样率 $F_{s}$ 和两个频率分别为 $f_{1}$ 和 $f_{2}$ 的正弦分量。设频率间隔为 $\\Delta f_{s} = |f_{1} - f_{2}|$。对于使用 Hann 窗的 STFT，分辨两个振幅相近的正弦波的既定判据是：如果它们的频率间隔至少是 DFT 谱线间隔的两倍，则它们可以被分辨。对于一个包含 $N$ 个样本的窗口，DFT 谱线间隔为 $\\Delta f_{\\text{bin}} = \\frac{F_{s}}{N}$。因此，分辨率条件为\n$$\n\\Delta f_{s} \\geq 2 \\Delta f_{\\text{bin}} = \\frac{2 F_{s}}{N}.\n$$\n对该不等式求解 $N$ 可得\n$$\nN \\geq \\frac{2 F_{s}}{\\Delta f_{s}}.\n$$\n窗的持续时间（以秒为单位）为 $T_{w} = \\frac{N}{F_{s}}$，因此满足该判据的最小持续时间为\n$$\nT_{w,\\min} = \\frac{1}{F_{s}} \\cdot \\frac{2 F_{s}}{\\Delta f_{s}} = \\frac{2}{\\Delta f_{s}}.\n$$\n现在根据给定值计算频率间隔：\n$$\n\\Delta f_{s} = |2000.0 - 1999.3| \\text{ Hz} = 0.7 \\text{ Hz}.\n$$\n因此，\n$$\nT_{w,\\min} = \\frac{2}{0.7} \\text{ s} = \\frac{20}{7} \\text{ s}.\n$$\n转换为毫秒，\n$$\nT_{w,\\min} = \\frac{20}{7} \\times 10^{3} \\text{ ms} \\approx 2.857142857 \\times 10^{3} \\text{ ms}.\n$$\n四舍五入到三位有效数字，\n$$\nT_{w,\\min} \\approx 2.86 \\times 10^{3} \\text{ ms}.\n$$", "answer": "$$\\boxed{2.86 \\times 10^{3}}$$", "id": "1730830"}, {"introduction": "在确定了能满足我们频率分辨率要求的窗口长度后，下一个问题是如何最好地计算和呈现每个窗口内信号的频谱。一个常见的技术是在计算离散傅里叶变换（DFT）之前对加窗后的信号段进行“补零”（zero-padding）。这个练习旨在澄清一个普遍的误解：补零是否能提高真实的频率分辨率？ [@problem_id:1730843] 你将通过分析发现，补零的作用并非提高分辨率，而是对频谱进行插值，使其看起来更平滑，从而帮助我们更精确地估计谱峰的位置。理解这一点对于正确解读语图（spectrogram）和避免错误结论至关重要。", "problem": "一位工程师正在分析一个离散时间信号 $x[n]$，以识别其随时间变化的频率成分。为此，他们使用短时傅里叶变换 (STFT) 计算频谱图。该过程包括以下步骤：\n\n1.  信号 $x[n]$ 被分割成重叠的块。\n2.  每个块都与一个长度为 $L=256$ 样本的窗函数 $w[n]$ 相乘。\n3.  计算每个加窗段的离散傅里叶变换 (DFT)。\n4.  将 DFT 结果的幅值平方绘制成强度图（频谱图）。\n\n最初，工程师选择 DFT 大小 $N$ 等于窗口长度，即 $N=L=256$。我们将得到的频谱图称为*频谱图 A*。\n\n观察结果后，工程师决定修改分析方法。他们保持窗口长度 $L=256$ 不变，但将 DFT 大小更改为 $N=1024$。这是通过对每个 256 样本的加窗段补上 $1024 - 256 = 768$ 个零，然后计算 1024 点 DFT 来实现的。这个新过程产生的结果称为*频谱图 B*。\n\n当比较频谱图 B 和频谱图 A 时，以下哪个陈述最准确地描述了观察到的主要定性差异？\n\nA. 频谱图 B 将具有显著更高的时间分辨率。\n\nB. 频谱图 B 将具有显著更高的真实频率分辨率，使工程师能够区分频率上更接近的正弦波。\n\nC. 频谱图 B 将表现出更强的频谱泄漏，即强频率分量泄漏到相邻的频率仓中。\n\nD. 频谱图 B 中的频率内容看起来像是经过插值并且更平滑，从而更容易精确估计频谱峰值的频率。\n\nE. 频谱图 B 的信噪比将低于频谱图 A。", "solution": "我们分析在保持窗口 $w[n]$ 及其长度 $L$ 固定的情况下，仅将 DFT 大小从 $N=L$ 更改为 $N > L$（通过补零）如何影响 STFT 频谱图。\n\n将时间索引为 $m$ 的加窗段定义为 $y_{m}[n]=x[n]w[n-m]$，其有效非零支撑长度为 $L$。$y_{m}[n]$ 的连续频率 DTFT 是\n$$\nY_{m}(\\omega)=\\sum_{n=0}^{L-1}y_{m}[n]\\exp(-\\mathrm{j}\\omega n).\n$$\n$N$ 点 DFT 在网格 $\\omega_{k}=2\\pi k/N$ 上对 $Y_{m}(\\omega)$ 进行采样：\n$$\nX_{m}[k]=\\sum_{n=0}^{N-1}\\tilde{y}_{m}[n]\\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi k}{N}n\\right),\n$$\n其中，当 $0\\leq n\\leq L-1$ 时 $\\tilde{y}_{m}[n]=y_{m}[n]$，当 $L\\leq n\\leq N-1$ 时 $\\tilde{y}_{m}[n]=0$（当 $N>L$ 时进行补零）。因此 $X_{m}[k]=Y_{m}(\\omega_{k})$；改变 $N$ 只会改变 $Y_{m}(\\omega)$ 的采样密度：\n$$\n\\Delta \\omega=\\frac{2\\pi}{N},\\qquad \\Delta f=\\frac{f_{s}}{N}.\n$$\n\n真实的频率分辨率由窗口的有效持续时间决定，而不是由 $N$ 决定。幅度 $|Y_{m}(\\omega)|$ 是底层谱线与窗口频谱 $W(\\omega)$ 在频域的卷积，其主瓣宽度与 $1/L$ 成正比（比例常数取决于窗口形状）。因此，瑞利极限（Rayleigh limit）以及分辨两个频率相近的正弦波的能力是由 $L$ 和 $w[n]$ 决定的，而不是由 $N$ 决定的。补零（增加 $N$）会细化频率采样网格，但不会使 $|W(\\omega)|$ 的主瓣变窄，因此它不会提供显著更高的真实频率分辨率。\n\n时间分辨率由窗口长度 $L$（和跳跃步长）决定，这两者都未改变；因此增加 $N$ 并不会改善时间分辨率。频谱泄漏由 $w[n]$ 以及正弦波与频率网格的对齐情况决定；补零不会增加泄漏能量，它只是更密集地对相同的泄漏模式进行采样。补零不会降低信噪比，因为没有引入额外的噪声，并且底层的能量分布保持不变。\n\n因此，当 $L$ 固定而 $N$ 增加时，频谱图的频率轴采样变得更精细；显示的幅度 $|X_{m}[k]|^{2}$ 在较粗的频率仓值之间显得更平滑、更像插值，这有助于在不改变基本分辨率或泄漏特性的情况下，直观地定位和估计峰值频率。\n\n因此，最准确的描述是频率内容看起来像是经过插值并且更平滑，从而有助于精确的峰值估计。\n\n选项评估：\n- A: 错误；时间分辨率未改变。\n- B: 错误；真实频率分辨率由 $L$ 和 $w[n]$ 决定，而非 $N$。\n- C: 错误；泄漏是窗口的属性；补零不会增加泄漏。\n- D: 正确；更密集的采样使频谱看起来更平滑和像插值。\n- E: 错误；补零不会降低信噪比。\n\n因此，正确选项是 D。", "answer": "$$\\boxed{D}$$", "id": "1730843"}, {"introduction": "短时傅里叶变换（STFT）将一维时域信号转换为二维的时频图像。我们已经探讨了如何通过窗口长度$N$控制频率分辨率，以及如何通过补零来影响频率轴的采样密度。现在，我们关注时间轴的构建。STFT通过在时间上移动分析窗口来生成一系列频谱“快照”，而窗口每次移动的步长，即“跳数”（hop size）$R$，直接决定了语图在时间轴上的颗粒度或分辨率$\\Delta t$。这个练习将引导你推导时间分辨率、跳数与语图中时间帧总数$M$之间的关系 [@problem_id:1730841]，让你深刻理解调整时间采样密度对分析结果和计算成本的影响。", "problem": "一位信号处理研究人员正在分析一个总长度为 $L$ 个采样点的离散时间信号，该信号以采样频率 $f_s$ 录制。分析采用短时傅里叶变换 (STFT) 进行，该方法包括使用长度为 $N$ 个采样点的分析窗将信号分成较短的片段，然后计算每个片段的傅里叶变换。对于每个后续片段，这些分析窗的位置会前进一个大小为 $R$ 个采样点的跳数。\n\n频谱图中生成的总时间帧数 $M$ 由公式 $M = \\lfloor\\frac{L-N}{R}\\rfloor + 1$ 给出，其中 $\\lfloor x \\rfloor$ 是不大于 $x$ 的最大整数。\n\n研究人员使用跳数 $R_A$ 进行初步分析（设置 A），在频谱图中得到总共 $M_A$ 个时间帧。该频谱图的时间分辨率 $\\Delta t_A$ 定义为连续分析窗中心之间的时间间隔。\n\n在第二次分析（设置 B）中，研究人员旨在将时间分辨率提高 $k$ 倍，其中 $k > 1$。也就是说，新的时间分辨率 $\\Delta t_B$ 应等于 $\\Delta t_A / k$。为实现这一目标，她将跳数调整为一个新值 $R_B$，同时保持所有其他参数（$L$、$N$、$f_s$）不变。这个新设置产生了 $M_B$ 个时间帧。\n\n为简化计算，本题假设 $(L-N)$ 是 $R_A$ 和 $R_B$ 的整数倍，这样就无需使用 floor 函数。\n\n推导帧数之比 $M_B / M_A$ 的表达式。答案仅用初始帧数 $M_A$ 和时间分辨率提高因子 $k$ 来表示。", "solution": "根据 STFT 帧前进的定义，时间分辨率（相邻窗中心之间的时间）等于以秒为单位的跳数：\n$$\n\\Delta t = \\frac{R}{f_{s}}.\n$$\n对于设置 A，这给出\n$$\n\\Delta t_{A} = \\frac{R_{A}}{f_{s}}.\n$$\n为将时间分辨率提高 $k>1$ 倍，设置 B 必须满足\n$$\n\\Delta t_{B} = \\frac{\\Delta t_{A}}{k} \\;\\;\\Rightarrow\\;\\; \\frac{R_{B}}{f_{s}} = \\frac{1}{k}\\frac{R_{A}}{f_{s}} \\;\\;\\Rightarrow\\;\\; R_{B} = \\frac{R_{A}}{k}.\n$$\n在 $(L-N)$ 是 $R_{A}$ 和 $R_{B}$ 整数倍的假设下，帧数为\n$$\nM = \\frac{L - N}{R} + 1.\n$$\n因此，\n$$\nM_{A} = \\frac{L - N}{R_{A}} + 1,\n\\qquad\nM_{B} = \\frac{L - N}{R_{B}} + 1 = \\frac{L - N}{R_{A}/k} + 1 = k\\frac{L - N}{R_{A}} + 1.\n$$\n使用 $\\frac{L - N}{R_{A}} = M_{A} - 1$，我们得到\n$$\nM_{B} = k(M_{A} - 1) + 1.\n$$\n因此，所求的比率为\n$$\n\\frac{M_{B}}{M_{A}} = \\frac{k(M_{A} - 1) + 1}{M_{A}} = k - \\frac{k - 1}{M_{A}}.\n$$\n此表达式仅取决于 $M_{A}$ 和 $k$，符合要求。", "answer": "$$\\boxed{\\frac{k\\left(M_{A}-1\\right)+1}{M_{A}}}$$", "id": "1730841"}]}