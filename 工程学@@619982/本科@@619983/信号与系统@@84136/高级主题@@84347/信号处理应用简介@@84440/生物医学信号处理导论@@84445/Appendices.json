{"hands_on_practices": [{"introduction": "在分析生物医学信号时，量化其基本特性是至关重要的第一步。本练习将引导你计算一个简化的心电图（ECG）心跳周期的总能量，这是一个衡量信号强度的基本指标。通过将复杂的ECG波形建模为简单的几何形状，我们能够运用信号能量的数学定义，将抽象的积分理论应用于一个具体且重要的生物医学场景中。[@problem_id:1728867]", "problem": "在生物医学信号处理中，一个心电图 (ECG) 信号周期的简化模型，记作 $v(t)$，可以使用基本几何形状来构建。该信号除了一系列代表P波、QRS波群和T波的不重叠脉冲外，在其他地方均被视为零。\n\n考虑一个由以下分量建模的心跳周期：\n1.  **P波**：一个矩形脉冲，恒定振幅为 $A_P = 0.2$ 毫伏 (mV)，持续时间为 $T_P = 100$ 毫秒 (ms)。\n2.  **Q波**：一个矩形脉冲，恒定振幅为 $A_Q = -0.1$ mV，持续时间为 $T_Q = 50$ ms。\n3.  **R波**：一个对称三角脉冲，峰值振幅为 $A_R = 1.5$ mV，总基底持续时间为 $T_R = 60$ ms。\n4.  **S波**：一个矩形脉冲，恒定振幅为 $A_S = -0.4$ mV，持续时间为 $T_S = 50$ ms。\n5.  **T波**：一个矩形脉冲，恒定振幅为 $A_T = 0.5$ mV，持续时间为 $T_T = 160$ ms。\n\n在这些脉冲之间的时间间隔内，信号为 0 mV。\n\n计算此信号模型 $v(t)$ 在单个心跳周期内的总能量。最终答案以平方微伏秒 ($\\mu\\text{V}^2\\cdot\\text{s}$) 为单位表示。", "solution": "一个连续时间信号 $v(t)$ 的总能量 $E_v$ 定义为其幅值平方在所有时间上的积分：\n$$E_v = \\int_{-\\infty}^{\\infty} |v(t)|^2 dt$$\n题目指出，该信号由五个不重叠的脉冲组成。当一个信号由在不相交的时间区间上非零的分量组成时，其总能量是各个分量能量的总和。因此，总能量为：\n$$E_v = E_P + E_Q + E_R + E_S + E_T$$\n其中 $E_P, E_Q, E_S, E_T$ 是矩形脉冲的能量，而 $E_R$ 是三角脉冲的能量。\n\n首先，我们求出这两种脉冲的能量公式。\n对于振幅为 $A$、持续时间为 $T$ 的矩形脉冲，其能量为：\n$$E_{\\text{rect}} = \\int_{0}^{T} A^2 dt = A^2 [t]_0^T = A^2 T$$\n对于峰值振幅为 $A$、基底持续时间为 $T$ 的对称三角脉冲，其信号在其持续时间（例如从 $t=0$到$t=T$）内可以描述为：\n$$v_{\\text{tri}}(t) = \\begin{cases} \\frac{2A}{T}t & 0 \\le t < T/2 \\\\ 2A - \\frac{2A}{T}t & T/2 \\le t \\le T \\end{cases}$$\n能量是该函数平方的积分。由于对称性，我们可以对前半部分进行积分再乘以2：\n$$E_{\\text{tri}} = \\int_{0}^{T} |v_{\\text{tri}}(t)|^2 dt = 2 \\int_{0}^{T/2} \\left(\\frac{2A}{T}t\\right)^2 dt$$\n$$E_{\\text{tri}} = 2 \\cdot \\frac{4A^2}{T^2} \\int_{0}^{T/2} t^2 dt = \\frac{8A^2}{T^2} \\left[\\frac{t^3}{3}\\right]_0^{T/2} = \\frac{8A^2}{T^2} \\frac{(T/2)^3}{3} = \\frac{8A^2}{T^2} \\frac{T^3}{24} = \\frac{1}{3} A^2 T$$\n\n接下来，我们必须处理单位。给定的振幅单位是毫伏 (mV)，持续时间单位是毫秒 (ms)。最终答案必须以平方微伏秒 ($\\mu\\text{V}^2\\cdot\\text{s}$) 为单位。我们建立转换因子：\n$1 \\text{ mV} = 10^3 \\mu\\text{V}$\n$1 \\text{ ms} = 10^{-3} \\text{ s}$\n能量是根据 $A^2 T$ 计算的。该乘积的单位最初是 $(\\text{mV})^2 \\cdot \\text{ms}$。\n$(\\text{mV})^2 \\cdot \\text{ms} = (10^3 \\mu\\text{V})^2 \\cdot (10^{-3} \\text{s}) = (10^6 \\mu\\text{V}^2) \\cdot (10^{-3} \\text{s}) = 10^3 \\mu\\text{V}^2\\cdot\\text{s}$。\n所以，要将一个值从 $(\\text{mV})^2 \\cdot \\text{ms}$ 转换为 $\\mu\\text{V}^2\\cdot\\text{s}$，我们需要乘以 1000。\n\n现在，我们计算每个脉冲的能量。\n\n1.  **P波（矩形）**：$A_P = 0.2$ mV, $T_P = 100$ ms。\n    $E_P = A_P^2 T_P = (0.2)^2 \\cdot 100 = 0.04 \\cdot 100 = 4.0 \\text{ mV}^2\\cdot\\text{ms}$\n\n2.  **Q波（矩形）**：$A_Q = -0.1$ mV, $T_Q = 50$ ms。\n    $E_Q = A_Q^2 T_Q = (-0.1)^2 \\cdot 50 = 0.01 \\cdot 50 = 0.5 \\text{ mV}^2\\cdot\\text{ms}$\n\n3.  **R波（三角）**：$A_R = 1.5$ mV, $T_R = 60$ ms。\n    $E_R = \\frac{1}{3} A_R^2 T_R = \\frac{1}{3} (1.5)^2 \\cdot 60 = \\frac{1}{3} \\cdot 2.25 \\cdot 60 = 0.75 \\cdot 60 = 45.0 \\text{ mV}^2\\cdot\\text{ms}$\n\n4.  **S波（矩形）**：$A_S = -0.4$ mV, $T_S = 50$ ms。\n    $E_S = A_S^2 T_S = (-0.4)^2 \\cdot 50 = 0.16 \\cdot 50 = 8.0 \\text{ mV}^2\\cdot\\text{ms}$\n\n5.  **T波（矩形）**：$A_T = 0.5$ mV, $T_T = 160$ ms。\n    $E_T = A_T^2 T_T = (0.5)^2 \\cdot 160 = 0.25 \\cdot 160 = 40.0 \\text{ mV}^2\\cdot\\text{ms}$\n\n现在我们将这些单独的能量相加，得到以 $\\text{mV}^2\\cdot\\text{ms}$ 为单位的总能量：\n$E_{\\text{total, intermediate}} = E_P + E_Q + E_R + E_S + E_T = 4.0 + 0.5 + 45.0 + 8.0 + 40.0 = 97.5 \\text{ mV}^2\\cdot\\text{ms}$\n\n最后，我们使用我们找到的转换因子，将这个总能量转换为所需的单位 $\\mu\\text{V}^2\\cdot\\text{s}$：\n$E_v = 97.5 \\text{ mV}^2\\cdot\\text{ms} \\times \\frac{1000 \\mu\\text{V}^2\\cdot\\text{s}}{1 \\text{ mV}^2\\cdot\\text{ms}} = 97500 \\mu\\text{V}^2\\cdot\\text{s}$", "answer": "$$\\boxed{97500}$$", "id": "1728867"}, {"introduction": "将模拟生物信号转换为数字形式是现代处理技术的核心，但这个过程也伴随着一些潜在的陷阱。本案例模拟了一个常见但严重的操作失误：在未进行适当滤波的情况下对信号进行降采样以减少数据量。通过这个练习，你将亲身体会到“混叠”（aliasing）现象如何将高频噪声伪装成看似合理的生理信号，从而强调了在数字信号采集中遵循奈奎斯特（Nyquist）采样定理的必要性。[@problem_id:1728885]", "problem": "一位生物医学工程师正在分析一种用于监测心率的光电容积描记法（PPG）信号。最初的高保真信号以 $F_s = 500$ Hz 的采样频率进行记录。对这个干净、高分辨率信号的频谱分析揭示了两个主要频率分量：一个对应于真实心率为 162 次/分钟 (bpm) 的生理信号，以及一个来自频率为 $f_N = 60$ Hz 的电源线噪声的强正弦干扰。所有其他谐波和噪声源都可以忽略不计。\n\n为了减少数据存储需求，该工程师决定通过抽取（decimation）对信号进行降采样。目标是获得一个新的采样率 $F_s'$，该采样率应尽可能接近但不超过 65 Hz。这是通过选择一个合适的整数抽取因子 $M$，并仅保留原始信号中每 $M$ 个采样点中的一个来实现的。关键的是，在该抽取过程之前，该工程师忘记了施加抗混叠低通滤波器。\n\n由于这一疏忽，电源线噪声分量混叠到了一个新的、更低的频率上。这个新的伪频率足够强，以至于被误认为是患者的心率。这个错误测量的心率是多少？\n\n请以次/分钟 (bpm) 为单位表示你的最终答案，并四舍五入到三位有效数字。", "solution": "我们已知原始采样频率为 $F_{s}=500$，电源线干扰频率为 $f_{N}=60$。该工程师在没有预先滤波的情况下，通过一个整数抽取因子 $M$ 进行降采样，目标是得到一个尽可能接近但不超过 $65$ 的新采样率 $F_{s}'$。\n\n抽取后的新采样频率为\n$$F_{s}'=\\frac{F_{s}}{M}$$\n约束条件 $F_{s}'\\leq 65$ 给出\n$$\\frac{500}{M}\\leq 65 \\quad \\Longrightarrow \\quad M\\geq \\frac{500}{65}$$\n因此，满足此条件的最小整数 $M$ 是\n$$M=\\left\\lceil \\frac{500}{65}\\right\\rceil=8$$\n所以\n$$F_{s}'=\\frac{500}{8}=62.5$$\n\n在没有抗混叠滤波器的情况下，在采样率 $F_{s}'$ 下采样的频率为 $f$ 的正弦波会混叠为\n$$f_{\\text{alias}}=\\left|f-kF_{s}'\\right|$$\n其中 $k\\in \\mathbb{Z}$ 的选择要使 $f_{\\text{alias}}\\leq \\frac{F_{s}'}{2}$。对于 $f_{N}=60$ 和 $F_{s}'=62.5$，选择 $k=1$：\n$$f_{\\text{alias}}=\\left|60-62.5\\right|=2.5$$\n这满足 $2.5\\leq \\frac{62.5}{2}=31.25$。\n\n错误推断出的心率（以次/分钟为单位）可以通过将混叠频率（以赫兹为单位）乘以 $60$ 得到：\n$$\\text{HR}_{\\text{incorrect}}=60\\times f_{\\text{alias}}=60\\times 2.5=150$$\n四舍五入到三位有效数字，结果仍为 $150$。", "answer": "$$\\boxed{150}$$", "id": "1728885"}, {"introduction": "许多先进的医疗设备，如自动胰岛素泵，都依赖于闭环反馈系统来调节生理参数，而系统的稳定性是首要的设计原则。本练习将带你分析一个简化的血糖调控算法的稳定性，这是一个对患者安全至关重要的特性。通过分析描述系统的差分方程，你将学会如何判断一个系统是否满足有界输入-有界输出（BIBO）稳定条件，这是设计任何安全可靠的反馈控制系统的基础技能。[@problem_id:1728934]", "problem": "一个工程团队正在开发一种闭环自动胰岛素输送系统的原型。该系统的核心是一个数字信号处理器（DSP），它在离散时间步长 $n$ 计算要施用的胰岛素剂量 $y[n]$。该计算基于当前预处理的血糖测量值 $x[n]$ 和过去的剂量。实现的初始算法由以下一阶线性差分方程描述：\n\n$y[n] = x[n] + 1.2y[n-1]$\n\n在测试过程中，发现该算法是不稳定的，因为血糖的微小波动可能导致胰岛素剂量危险地急剧增加。为纠正此问题，工程团队对系统的差分方程提出了几项修改建议。你的任务是分析这些提议，并找出所有能使系统成为有界输入有界输出（BIBO）稳定系统的方案。\n\n下列哪个修改后的差分方程描述了一个 BIBO 稳定系统？选择所有适用选项。\n\nA. $y[n] = x[n] + 1.2y[n-1]$\n\nB. $y[n] = x[n] + 0.9y[n-1]$\n\nC. $y[n] = x[n] + 0.5y[n-1] + 0.6y[n-2]$\n\nD. $y[n] = x[n] - 1.05y[n-2]$\n\nE. $y[n] = x[n] - 0.5x[n-1] + 1.1y[n-1] - 0.5y[n-2]$", "solution": "对于一个由线性常系数差分方程描述的因果 LTI 系统，其传递函数可以通过进行 $Z$ 变换（在零初始条件下）得到。如果方程为\n$$y[n] = \\sum_{k=0}^{M} b_{k} x[n-k] + \\sum_{k=1}^{N} c_{k} y[n-k]$$\n那么\n$$Y(z) = \\left(\\sum_{k=0}^{M} b_{k} z^{-k}\\right) X(z) + \\left(\\sum_{k=1}^{N} c_{k} z^{-k}\\right) Y(z)$$\n所以\n$$H(z) \\equiv \\frac{Y(z)}{X(z)} = \\frac{\\sum_{k=0}^{M} b_{k} z^{-k}}{1 - \\sum_{k=1}^{N} c_{k} z^{-k}}$$\nBIBO 稳定性要求 $H(z)$ 的所有极点都满足 $|z|<1$，即特征方程 $1 - \\sum_{k=1}^{N} c_{k} z^{-k} = 0$ 的根必须严格位于单位圆内部。\n\n分析每个选项：\n\nA. $y[n] = x[n] + 1.2 y[n-1]$.\n此处 $H(z) = \\dfrac{1}{1 - 1.2 z^{-1}}$，极点由 $1 - 1.2 z^{-1} = 0 \\Rightarrow z = 1.2$ 给出。由于 $|1.2| > 1$，该系统不是 BIBO 稳定的。\n\nB. $y[n] = x[n] + 0.9 y[n-1]$.\n此处 $H(z) = \\dfrac{1}{1 - 0.9 z^{-1}}$，极点位于 $z = 0.9$。由于 $|0.9| < 1$，该系统是 BIBO 稳定的。\n\nC. $y[n] = x[n] + 0.5 y[n-1] + 0.6 y[n-2]$.\n此处\n$$H(z) = \\frac{1}{1 - 0.5 z^{-1} - 0.6 z^{-2}}$$\n所以极点满足 $1 - 0.5 z^{-1} - 0.6 z^{-2} = 0$。乘以 $z^{2}$ 得到特征多项式\n$$z^{2} - 0.5 z - 0.6 = 0$$\n判别式为 $\\Delta = ( -0.5 )^{2} - 4(1)(-0.6) = 0.25 + 2.4 = 2.65$，所以较大的根是\n$$z_{+} = \\frac{0.5 + \\sqrt{2.65}}{2}$$\n由于 $\\sqrt{2.65} > \\sqrt{2.25} = 1.5$，因此 $z_{+} > \\frac{0.5 + 1.5}{2} = 1$。因此，至少有一个极点的模 $|z|>1$，所以该系统不是 BIBO 稳定的。\n\nD. $y[n] = x[n] - 1.05 y[n-2]$.\n此处\n$$H(z) = \\frac{1}{1 + 1.05 z^{-2}}$$\n所以极点满足 $1 + 1.05 z^{-2} = 0 \\Rightarrow z^{2} = -1.05$。因此 $|z| = \\sqrt{1.05} > 1$，所以极点在单位圆外，系统不是 BIBO 稳定的。等价地，多项式 $z^{2} + 1.05$ 不满足二阶 Jury 判据的条件 $|a_{2}| < a_{0}$，因为 $1.05 \\not< 1$。\n\nE. $y[n] = x[n] - 0.5 x[n-1] + 1.1 y[n-1] - 0.5 y[n-2]$.\n此处\n$$H(z) = \\frac{1 - 0.5 z^{-1}}{1 - 1.1 z^{-1} + 0.5 z^{-2}}$$\n所以特征多项式为\n$$z^{2} - 1.1 z + 0.5 = 0$$\n其判别式为 $1.1^2 - 4(1)(0.5) = 1.21 - 2 = -0.79 < 0$，所以根是共轭复数。根的乘积是 $0.5$，因此如果根是 $r \\exp(\\pm i\\theta)$，那么 $r^{2} = 0.5$ 且 $r = \\sqrt{0.5} < 1$。因此，两个极点都严格位于单位圆内部，系统是 BIBO 稳定的。Jury 判据也证实了其稳定性：对于 $z^2 + a_1 z + a_2$，稳定条件是 $|a_2|1$ (即 $|0.5|1$，满足)，$1+a_1+a_2>0$ (即 $1-1.1+0.5=0.4>0$，满足)，和 $1-a_1+a_2>0$ (即 $1-(-1.1)+0.5=2.6>0$，满足)。\n\n因此，选项中 BIBO 稳定的系统是 B 和 E。", "answer": "$$\\boxed{BE}$$", "id": "1728934"}]}