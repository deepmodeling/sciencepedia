{"hands_on_practices": [{"introduction": "我们从最基础的信号——一个恒定的直流（DC）信号——开始，来掌握短时傅里叶变换（STFT）的计算。这个练习旨在通过一个简单的例子，让你直接应用STFT的定义式进行计算 [@problem_id:1765475]。通过这个过程，你将理解窗函数在时频分析中的核心作用，并揭示一个关键现象：对于平稳信号，其STFT在频域上的形态其实就是窗函数自身的傅里叶变换。", "problem": "考虑一个由 $x(t) = C$ 给出的连续时间信号，其中 $C$ 是一个非零实常数。我们希望使用短时傅里叶变换（STFT）来分析这个信号。STFT，记为 $X(\\tau, \\omega)$，由以下积分定义：\n$$X(\\tau, \\omega) = \\int_{-\\infty}^{\\infty} x(t) w(t-\\tau) e^{-j\\omega t} dt$$\n其中 $j$ 是虚数单位，$\\tau$ 是时间平移参数，$\\omega$ 是角频率。\n\n用于此分析的窗函数是由下式给出的高斯函数：\n$$w(t) = \\exp(-at^2)$$\n其中 $a$ 是一个正常数。\n\n求信号 $x(t)$ 的STFT $X(\\tau, \\omega)$。请用 $C$, $a$, $\\tau$, $\\omega$ 以及基本数学常数来表示你的答案。", "solution": "短时傅里叶变换 (STFT) 定义为：\n$$X(\\tau, \\omega) = \\int_{-\\infty}^{\\infty} x(t) w(t-\\tau) e^{-j\\omega t} dt$$\n\n我们已知信号 $x(t) = C$ 和窗函数 $w(t) = \\exp(-at^2)$。首先，我们将它们代入 STFT 的定义中。窗函数被平移了 $\\tau$，所以我们使用 $w(t-\\tau) = \\exp(-a(t-\\tau)^2)$。\n\n$$X(\\tau, \\omega) = \\int_{-\\infty}^{\\infty} C \\exp(-a(t-\\tau)^2) e^{-j\\omega t} dt$$\n\n由于 $C$ 是一个常数，我们可以将其从积分中提出：\n$$X(\\tau, \\omega) = C \\int_{-\\infty}^{\\infty} \\exp(-a(t-\\tau)^2) e^{-j\\omega t} dt$$\n\n接下来，我们合并积分内的指数项：\n$$X(\\tau, \\omega) = C \\int_{-\\infty}^{\\infty} \\exp(-a(t-\\tau)^2 - j\\omega t) dt$$\n\n为了求解这个积分，我们需要将指数部分变换成易于积分的二次型。让我们展开指数的参数：\n$$-a(t-\\tau)^2 - j\\omega t = -a(t^2 - 2t\\tau + \\tau^2) - j\\omega t$$\n$$= -at^2 + 2a\\tau t - a\\tau^2 - j\\omega t$$\n\n按积分变量 $t$ 的幂次对各项进行分组：\n$$= -at^2 + (2a\\tau - j\\omega)t - a\\tau^2$$\n\n现在，我们对 $t$ 进行配方。我们从包含 $t$ 的项中提出因子 $-a$：\n$$= -a \\left[ t^2 - \\frac{2a\\tau - j\\omega}{a} t \\right] - a\\tau^2$$\n$$= -a \\left[ t^2 - 2\\left(\\tau - \\frac{j\\omega}{2a}\\right) t \\right] - a\\tau^2$$\n\n为了在方括号内完成配方，我们加上再减去 $t$ 项系数一半的平方，即 $\\left(\\tau - \\frac{j\\omega}{2a}\\right)^2$：\n$$= -a \\left[ \\left(t - \\left(\\tau - \\frac{j\\omega}{2a}\\right)\\right)^2 - \\left(\\tau - \\frac{j\\omega}{2a}\\right)^2 \\right] - a\\tau^2$$\n$$= -a \\left(t - \\left(\\tau - \\frac{j\\omega}{2a}\\right)\\right)^2 + a \\left(\\tau - \\frac{j\\omega}{2a}\\right)^2 - a\\tau^2$$\n\n让我们简化不依赖于 $t$ 的项：\n$$a \\left(\\tau^2 - 2\\tau\\frac{j\\omega}{2a} + \\left(\\frac{j\\omega}{2a}\\right)^2\\right) - a\\tau^2$$\n$$= a\\left(\\tau^2 - \\frac{j\\omega\\tau}{a} - \\frac{\\omega^2}{4a^2}\\right) - a\\tau^2$$\n$$= a\\tau^2 - j\\omega\\tau - \\frac{\\omega^2}{4a} - a\\tau^2$$\n$$= -j\\omega\\tau - \\frac{\\omega^2}{4a}$$\n\n所以，完整的指数是：\n$$-a \\left(t - \\left(\\tau - \\frac{j\\omega}{2a}\\right)\\right)^2 - j\\omega\\tau - \\frac{\\omega^2}{4a}$$\n\n将此代回 $X(\\tau, \\omega)$ 的积分中：\n$$X(\\tau, \\omega) = C \\int_{-\\infty}^{\\infty} \\exp\\left(-a \\left(t - \\left(\\tau - \\frac{j\\omega}{2a}\\right)\\right)^2 - j\\omega\\tau - \\frac{\\omega^2}{4a}\\right) dt$$\n\n指数中不依赖于 $t$ 的部分可以从积分中提出：\n$$X(\\tau, \\omega) = C \\exp\\left(-j\\omega\\tau - \\frac{\\omega^2}{4a}\\right) \\int_{-\\infty}^{\\infty} \\exp\\left(-a \\left(t - \\left(\\tau - \\frac{j\\omega}{2a}\\right)\\right)^2\\right) dt$$\n\n剩下的积分是一个标准的高斯积分。令 $u = t - (\\tau - \\frac{j\\omega}{2a})$，则 $du = dt$。积分为：\n$$\\int_{-\\infty}^{\\infty} \\exp(-au^2) du$$\n这是 $\\int_{-\\infty}^{\\infty} \\exp(-bx^2)dx$ 的形式，其著名结果为 $\\sqrt{\\frac{\\pi}{b}}$。在我们的例子中， $b=a$。因此，该积分的计算结果为：\n$$\\int_{-\\infty}^{\\infty} \\exp(-au^2) du = \\sqrt{\\frac{\\pi}{a}}$$\n\n最后，我们将这个结果代回我们关于 $X(\\tau, \\omega)$ 的表达式中：\n$$X(\\tau, \\omega) = C \\exp\\left(-j\\omega\\tau - \\frac{\\omega^2}{4a}\\right) \\sqrt{\\frac{\\pi}{a}}$$\n\n整理各项得到最终答案：\n$$X(\\tau, \\omega) = C \\sqrt{\\frac{\\pi}{a}} \\exp\\left(-\\frac{\\omega^2}{4a} - j\\omega\\tau\\right)$$", "answer": "$$\\boxed{C \\sqrt{\\frac{\\pi}{a}} \\exp\\left(-\\frac{\\omega^{2}}{4a} - j\\omega\\tau\\right)}$$", "id": "1765475"}, {"introduction": "在分析了最简单的平稳信号之后，让我们来挑战一个经典的非平稳信号——单位阶跃函数。这个练习的核心目的是展示STFT在“定位”信号突变事件上的强大能力 [@problem_id:1765478]。通过计算分析窗滑过信号发生阶跃的 $t=0$ 点前后STFT的变化，你将直观地感受到时频分析是如何捕捉并描述信号在特定时刻的频率行为的。", "problem": "考虑一个信号 $x(t)$，其定义为单位阶跃函数 $u(t)$，其中当 $t \\ge 0$ 时 $u(t) = 1$，当 $t < 0$ 时 $u(t) = 0$。我们希望使用短时傅里叶变换 (STFT) 来分析这个信号。\n\n信号 $x(t)$ 相对于窗函数 $w(t)$ 的STFT定义为：\n$$X(\\tau, \\omega) = \\int_{-\\infty}^{\\infty} x(t) w(t-\\tau) e^{-j\\omega t} dt$$\n其中 $\\tau$ 是滑动窗函数的时间参数，$\\omega$ 是角频率。\n\n对于这个问题，请使用一个以原点为中心、总时长为 $2T$ 的对称矩形窗函数 $w(t)$，其定义如下：\n$$\nw(t) =\n\\begin{cases}\n1, & |t| \\le T \\\\\n0, & |t| > T\n\\end{cases}\n$$\n请使用该矩形窗确定信号 $x(t) = u(t)$ 的STFT $X(\\tau, \\omega)$。结果将是关于 $\\tau$ 和 $\\omega$ 的函数。请将你的结果表示为单个数学表达式，该表达式可根据 $\\tau$ 的值进行分段定义。", "solution": "给定STFT的定义\n$$\nX(\\tau,\\omega)=\\int_{-\\infty}^{\\infty}x(t)\\,w(t-\\tau)\\,\\exp(-j\\omega t)\\,dt,\n$$\n其中 $x(t)=u(t)$ 且窗函数为对称矩形窗\n$$\nw(t)=\\begin{cases}\n1, & |t|\\leq T\\\\\n0, & |t|>T\n\\end{cases}.\n$$\n平移后的窗函数 $w(t-\\tau)=1$ 在 $|t-\\tau|\\leq T$ 时成立，即 $t\\in[\\tau-T,\\tau+T]$，在其他情况下为零。由于当 $t\\geq 0$ 时 $x(t)=u(t)$ 为 $1$，当 $t<0$ 时为 $0$，因此被积函数仅在 $[0,\\infty)$ 和 $[\\tau-T,\\tau+T]$ 的交集上非零。所以，\n$$\nX(\\tau,\\omega)=\\int_{a(\\tau)}^{b(\\tau)}\\exp(-j\\omega t)\\,dt,\n$$\n其中 $a(\\tau)=\\max(0,\\tau-T)$ 且 $b(\\tau)=\\tau+T$，条件是交集非空；否则，$X(\\tau,\\omega)=0$。这就导致了关于 $\\tau$ 的三种情况：\n\n1) 如果 $\\tau\\leq -T$，那么 $b(\\tau)=\\tau+T\\leq 0$，所以与 $[0,\\infty)$ 的交集为空集（在 $t=0$ 处最多为一个零测集），因此 $X(\\tau,\\omega)=0$。\n\n2) 如果 $-T<\\tau<T$，那么 $\\tau+T>0$ 且 $\\tau-T<0$，所以交集是 $[0,\\tau+T]$，得到\n$$\nX(\\tau,\\omega)=\\int_{0}^{\\tau+T}\\exp(-j\\omega t)\\,dt=\n\\begin{cases}\n\\dfrac{1-\\exp\\big(-j\\omega(\\tau+T)\\big)}{j\\omega}, & \\omega\\neq 0,\\\\\n\\tau+T, & \\omega=0.\n\\end{cases}\n$$\n\n3) 如果 $\\tau\\geq T$，那么 $\\tau-T\\geq 0$，所以交集是 $[\\tau-T,\\tau+T]$，得到\n$$\nX(\\tau,\\omega)=\\int_{\\tau-T}^{\\tau+T}\\exp(-j\\omega t)\\,dt=\n\\begin{cases}\n\\exp(-j\\omega\\tau)\\,\\dfrac{2\\sin(\\omega T)}{\\omega}, & \\omega\\neq 0,\\\\\n2T, & \\omega=0.\n\\end{cases}\n$$\n通过直接求值或对 $\\omega$ 取极限，可以发现在边界 $\\tau=-T$ 和 $\\tau=T$ 处，这些表达式是连续相接的。综合以上各种情况，便得到了所求的 STFT $X(\\tau,\\omega)$，它是 $\\tau$ 和 $\\omega$ 的函数。", "answer": "$$\\boxed{X(\\tau,\\omega)=\\begin{cases}\n0, & \\tau\\leq -T,\\\\[6pt]\n\\begin{cases}\n\\dfrac{1-\\exp\\!\\big(-j\\omega(\\tau+T)\\big)}{j\\omega}, & \\omega\\neq 0,\\\\[6pt]\n\\tau+T, & \\omega=0,\n\\end{cases} & -T<\\tau<T,\\\\[12pt]\n\\begin{cases}\n\\exp(-j\\omega\\tau)\\,\\dfrac{2\\sin(\\omega T)}{\\omega}, & \\omega\\neq 0,\\\\[6pt]\n2T, & \\omega=0,\n\\end{cases} & \\tau\\geq T.\n\\end{cases}}$$", "id": "1765478"}, {"introduction": "在通过具体计算熟悉了STFT之后，是时候来探索其更深层次的数学特性了。本练习探讨一个基础的时域操作，即时间延迟 $t_0$，会如何反映在STFT的结果上 [@problem_id:1765452]。推导这个时移特性是理解变换性质的关键一步，它揭示了时域中的平移如何转化为时频域中的平移和线性相位变化，这对于信号处理的理论分析和应用至关重要。", "problem": "在信号处理领域，短时傅里叶变换（STFT）是分析信号频率成分如何随时间变化的关键工具。连续时间信号 $x(t)$ 的STFT定义为：\n$$\nX(\\tau, \\omega) = \\int_{-\\infty}^{\\infty} x(t) w(t - \\tau) e^{-j\\omega t} dt\n$$\n此处，$w(t)$ 是一个实值窗函数，$\\tau$ 是用于局部化分析的时间变量，$\\omega$ 是角频率，$t$ 是时间积分变量，$j$ 是虚数单位，定义为 $j = \\sqrt{-1}$。\n\n考虑一个信号 $x(t)$，其STFT为 $X(\\tau, \\omega)$。我们定义一个新信号 $y(t)$，它是原始信号的一个时延版本，由 $y(t) = x(t - t_0)$ 给出，其中 $t_0$ 是一个常实数时延。\n\n设 $Y(\\tau, \\omega)$ 为信号 $y(t)$ 的STFT，使用相同的窗函数 $w(t)$ 计算。求 $Y(\\tau, \\omega)$ 关于原始STFT $X(\\tau, \\omega)$ 以及参数 $t_0$ 和 $\\omega$ 的表达式。", "solution": "题目要求我们求出时移信号 $y(t) = x(t - t_0)$ 的短时傅里叶变换（STFT），记作 $Y(\\tau, \\omega)$，并将其用原始信号的STFT $X(\\tau, \\omega)$ 来表示。\n\n我们从信号 $y(t)$ 的STFT定义开始，使用与文章主体部分一致的记法：\n$$\nY(\\tau, \\omega) = \\int_{-\\infty}^{\\infty} y(t) w(t - \\tau) e^{-j\\omega t} dt\n$$\n\n将 $y(t)$ 的表达式 $y(t) = x(t - t_0)$ 代入积分中：\n$$\nY(\\tau, \\omega) = \\int_{-\\infty}^{\\infty} x(t - t_0) w(t - \\tau) e^{-j\\omega t} dt\n$$\n\n为了将此表达式与 $x(t)$ 的STFT联系起来，我们在积分中进行变量替换。设新的积分变量为 $\\lambda$，使得 $\\lambda = t - t_0$。这意味着 $t = \\lambda + t_0$，微分元为 $dt = d\\lambda$。由于 $t_0$ 是一个常数，当积分限 $t$ 从 $-\\infty$ 到 $\\infty$ 时，对应的 $\\lambda$ 的积分限也为 $-\\infty$ 到 $\\infty$。\n\n现在，我们将这些代入 $Y(\\tau, \\omega)$ 的积分中：\n$$\nY(\\tau, \\omega) = \\int_{-\\infty}^{\\infty} x(\\lambda) w((\\lambda + t_0) - \\tau) e^{-j\\omega(\\lambda + t_0)} d\\lambda\n$$\n\n我们可以简化积分内的项。窗函数项变为 $w(\\lambda - (\\tau - t_0))$。指数项可以使用性质 $e^{a+b} = e^a e^b$ 来拆分：\n$$\ne^{-j\\omega(\\lambda + t_0)} = e^{-j\\omega\\lambda} e^{-j\\omega t_0}\n$$\n\n$e^{-j\\omega t_0}$ 项相对于积分变量 $\\lambda$ 是一个常数，因此可以移到积分外：\n$$\nY(\\tau, \\omega) = e^{-j\\omega t_0} \\int_{-\\infty}^{\\infty} x(\\lambda) w(\\lambda - (\\tau - t_0)) e^{-j\\omega\\lambda} d\\lambda\n$$\n\n现在，我们来考察剩下的积分。它的形式与原始信号 $x(t)$ 的STFT相同。$x(t)$ 的STFT的定义是：\n$$\nX(\\tau', \\omega) = \\int_{-\\infty}^{\\infty} x(\\lambda) w(\\lambda - \\tau') e^{-j\\omega\\lambda} d\\lambda\n$$\n为了清晰起见，这里我们使用 $\\lambda$ 作为积分变量，使用 $\\tau'$ 作为时间定位参数。\n\n通过将我们得到的 $Y(\\tau, \\omega)$ 表达式中的积分与 $X(\\tau', \\omega)$ 的定义进行比较，我们可以发现，如果我们将时间定位参数 $\\tau'$ 设为 $\\tau - t_0$，两者是相同的。因此，我们有：\n$$\n\\int_{-\\infty}^{\\infty} x(\\lambda) w(\\lambda - (\\tau - t_0)) e^{-j\\omega\\lambda} d\\lambda = X(\\tau - t_0, \\omega)\n$$\n\n将这个结果代回到我们关于 $Y(\\tau, \\omega)$ 的表达式中，我们得到最终的关系式：\n$$\nY(\\tau, \\omega) = e^{-j\\omega t_0} X(\\tau - t_0, \\omega)\n$$\n这个结果表明，信号域中 $t_0$ 的时延，会同时在STFT的时间变量上引起一个 $t_0$ 的时移，并在STFT的频率变量上引起一个 $-\\omega t_0$ 的线性相移。", "answer": "$$\\boxed{\\exp(-j\\omega t_0) X(\\tau - t_0, \\omega)}$$", "id": "1765452"}]}