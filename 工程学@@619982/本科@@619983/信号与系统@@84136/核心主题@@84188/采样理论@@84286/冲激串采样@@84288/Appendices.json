{"hands_on_practices": [{"introduction": "第一个练习将带你实践模拟世界中的频率与数字世界中频率之间的基本转换。理解一个模拟频率如何转化为归一化的数字频率，是所有数字信号处理的基石。通过这个练习 [@problem_id:1726841]，你将牢固掌握物理信号频率与其在数字系统内部表示之间的关键联系。", "problem": "在数字音频处理领域，连续时间模拟信号必须被转换为离散时间数字序列。这个过程被称为采样。考虑一个纯正弦音调，代表一个音符，它可以用连续时间信号 $x(t)$ 来描述。该音调的频率为 $f_c = 2 \\text{ kHz}$。该信号由一个模数转换器 (ADC) 以 $f_s = 5 \\text{ kHz}$ 的采样率进行均匀采样。采样过程根据关系式 $x[n] = x(nT_s)$ 从连续信号 $x(t)$ 创建一个离散时间序列 $x[n]$，其中 $T_s$ 是采样周期。得到的离散时间序列也是一个形式为 $A \\cos(\\Omega n + \\phi)$ 的正弦波。\n\n确定该序列的归一化离散时间角频率 $\\Omega$。将您的最终答案表示为以弧度/样本为单位的解析表达式。", "solution": "频率为 $f_{c}$ 的连续时间正弦波可以写为 $x(t)=A\\cos(2\\pi f_{c}t+\\phi)$。以采样周期 $T_{s}$（其中 $T_{s}=\\frac{1}{f_{s}}$）进行均匀采样，产生离散时间序列\n$$\nx[n]=x(nT_{s})=A\\cos\\!\\left(2\\pi f_{c}nT_{s}+\\phi\\right)=A\\cos\\!\\left(\\left(\\frac{2\\pi f_{c}}{f_{s}}\\right)n+\\phi\\right).\n$$\n通过与形式 $A\\cos(\\Omega n+\\phi)$ 进行比较，归一化离散时间角频率为\n$$\n\\Omega=\\frac{2\\pi f_{c}}{f_{s}}.\n$$\n代入 $f_{c}=2\\times 10^{3}$ 和 $f_{s}=5\\times 10^{3}$（公共因子消去），得到\n$$\n\\Omega=2\\pi\\cdot\\frac{2}{5}=\\frac{4\\pi}{5}.\n$$\n由于离散时间频率是以 $2\\pi$ 为模定义的，并且 $\\frac{4\\pi}{5}\\in(0,\\pi)$，这已经是主值，单位是弧度/样本。", "answer": "$$\\boxed{\\frac{4\\pi}{5}}$$", "id": "1726841"}, {"introduction": "在掌握了基础知识之后，接下来的练习将探讨采样理论中最关键也最容易被误解的现象之一：混叠（aliasing）。当信号的采样率低于奈奎斯特率时，高频分量会“伪装”成低频分量，导致信息失真。这个问题模拟了一个真实场景，你需要在采样后的数据中辨别出频率的“真身”，这对任何处理数字采集数据的工程师来说都是一项至关重要的技能 [@problem_id:1726876]。", "problem": "一位航空航天工程师正在分析一架原型双引擎无人机的声学特征。在某一特定飞行工况下，麦克风接收到的声音信号可以被建模为两个纯音的叠加。第一个音调来自螺旋桨，其频率为 $f_1 = 150$ Hz。第二个音调来自发动机核心，其频率为 $f_2 = 260$ Hz。连续时间信号由 $x(t) = A_1 \\cos(2\\pi f_1 t) + A_2 \\cos(2\\pi f_2 t)$ 给出，其中 $A_1$ 和 $A_2$ 是幅度。\n\n该信号由一个数字数据采集系统以 $f_s = 400$ Hz 的采样率进行采样，以获得一个离散时间信号。由于采样过程的限制，在离散信号中观测到的频率可能与原始模拟频率不同。\n\n确定在采样数据中可以观测到的两个基本频率 $f_{p1}$和 $f_{p2}$。观测频率必须位于主频率范围 $[0, f_s/2]$ 内。按升序提供这两个频率。以 Hz 为单位表示您的最终答案。", "solution": "我们给定一个由两个余弦函数组成的连续时间信号：\n$$\nx(t) = A_{1}\\cos(2\\pi f_{1} t) + A_{2}\\cos(2\\pi f_{2} t),\n$$\n其中 $f_{1} = 150$ 且 $f_{2} = 260$。该信号以采样率 $f_{s} = 400$ 进行采样，因此采样周期为\n$$\nT_{s} = \\frac{1}{f_{s}}.\n$$\n采样后的（离散时间）序列为\n$$\nx[n] = x(nT_{s}) = A_{1}\\cos\\!\\big(2\\pi f_{1} n T_{s}\\big) + A_{2}\\cos\\!\\big(2\\pi f_{2} n T_{s}\\big).\n$$\n在离散时间中，频率会以采样频率为模发生混叠，因为对于任何整数 $k$，\n$$\n\\cos\\!\\big(2\\pi (f + k f_{s}) n T_{s}\\big) = \\cos\\!\\big(2\\pi f n T_{s} + 2\\pi k n\\big) = \\cos\\!\\big(2\\pi f n T_{s}\\big),\n$$\n这里利用了对于整数 $n$ 余弦函数的 $2\\pi$ 周期性。因此，任何连续时间频率 $f$ 都会映射到一个由下式给出的等效离散时间频率 $f'$：\n$$\nf' = f \\bmod f_{s} \\in [0, f_{s}),\n$$\n并且在 $[0, f_{s}/2]$ 内观测到的基带（主）频率为\n$$\nf_{p} = \\min\\!\\big(f',\\, f_{s} - f'\\big),\n$$\n因为对于 $f' > f_{s}/2$，我们有\n$$\n\\cos\\!\\big(2\\pi f' n T_{s}\\big) = \\cos\\!\\big(2\\pi (f_{s} - f') n T_{s}\\big).\n$$\n等效地，$f_{p}$ 是 $f$ 到 $f_{s}$ 的最近整数倍的距离：\n$$\nf_{p} = \\min_{m \\in \\mathbb{Z}} |f - m f_{s}|, \\quad \\text{with } f_{p} \\in [0, f_{s}/2].\n$$\n\n将此应用于每个音调，其中 $f_{s} = 400$：\n- 对于 $f_{1} = 150$，我们有 $f_{1} < f_{s}/2 = 200$，所以它已经位于主范围内。因此\n$$\nf_{p1} = 150.\n$$\n- 对于 $f_{2} = 260$，计算 $f' = 260 \\bmod 400 = 260$，该值超过了 $f_{s}/2 = 200$。将其折叠到主区间：\n$$\nf_{p2} = f_{s} - f' = 400 - 260 = 140.\n$$\n\n因此，在采样数据中观测到的两个频率按升序排列为 $140$ 和 $150$。", "answer": "$$\\boxed{\\begin{pmatrix} 140 & 150 \\end{pmatrix}}$$", "id": "1726876"}, {"introduction": "我们的最后一个练习将挑战升级，探讨信号处理操作本身如何影响采样率要求。一个常见的误解是，奈奎斯特率仅由原始信号决定；然而，如此例中的平方运算等非线性操作会扩展信号的带宽。这个练习 [@problem_id:1726830] 将向你展示为什么系统级的视角至关重要，因为你需要分析整个处理链来确定正确的采样率，以防止信息丢失。", "problem": "考虑一个连续时间信号 $x(t)$。其傅里叶变换（记为 $X(j\\omega)$）被定义为一个矩形脉冲，由下式给出：\n$$\nX(j\\omega) = \\begin{cases} \nK & \\text{当 } |\\omega| \\le W \\\\\n0 & \\text{当 } |\\omega| > W \n\\end{cases}\n$$\n其中 $K$ 和 $W$ 是正常数，分别代表频谱的振幅和半带宽。\n\n一个新信号 $y(t)$ 是通过对原始信号进行平方生成的，即 $y(t) = [x(t)]^2$。这个过程在振幅调制（AM）无线电接收机中使用的包络检波电路中很常见。\n\n确定对信号 $y(t)$ 进行采样所需的最低采样率（称为奈奎斯特率 $\\omega_N$），以确保可以从其样本中无混叠地重建该信号。请用参数 $W$ 表示您的答案 $\\omega_N$。您的最终答案应以弧度/秒为单位。", "solution": "给定一个连续时间信号 $x(t)$，其傅里叶变换为矩形频谱\n$$\nX(j\\omega)=\\begin{cases}\nK, & |\\omega|\\leq W\\\\\n0, & |\\omega|>W\n\\end{cases}\n$$\n其中 $K>0$ 且 $W>0$。一个新信号通过时域平方形成，即 $y(t)=x^2(t)$。我们想要找到对 $y(t)$ 进行无混叠采样所需的最低采样角频率（奈奎斯特率）$\\omega_{N}$。\n\n首先，我们确定 $y(t)$ 的频谱。使用连续时间傅里叶变换的约定\n$$\n\\mathcal{F}\\{x(t)\\}=X(j\\omega),\\qquad \\mathcal{F}^{-1}\\{X(j\\omega)\\}=\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty}X(j\\omega)\\exp(j\\omega t)\\,\\mathrm{d}\\omega,\n$$\n根据乘法-卷积性质可得\n$$\nY(j\\omega)=\\mathcal{F}\\{y(t)\\}=\\mathcal{F}\\{x^2(t)\\}=\\frac{1}{2\\pi}\\bigl[X(j\\omega)*X(j\\omega)\\bigr],\n$$\n其中 $*$ 表示在频率变量上的卷积：\n$$\nY(j\\omega)=\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty}X(j\\nu)\\,X\\bigl(j(\\omega-\\nu)\\bigr)\\,\\mathrm{d}\\nu.\n$$\n由于 $X(j\\nu)$ 仅在 $|\\nu|\\leq W$ 时非零，且 $X\\bigl(j(\\omega-\\nu)\\bigr)$ 仅在 $|\\omega-\\nu|\\leq W$ 时非零，因此被积函数仅在以下两个条件同时成立时才非零：\n$$\n-W\\leq \\nu \\leq W,\\qquad \\omega - W \\leq \\nu \\leq \\omega + W\n$$\n积分区间是 $[-W,W]$ 和 $[\\omega-W,\\omega+W]$ 的交集。当且仅当 $|\\omega|\\leq 2W$ 时，该交集非空。因此，对于 $|\\omega|>2W$，$Y(j\\omega)=0$，且 $Y(j\\omega)$ 的支撑集是 $|\\omega|\\leq 2W$。\n\n此外，对于 $|\\omega|\\leq 2W$，重叠部分的长度为\n$$\nL(\\omega)=\\min\\{W,\\omega+W\\}-\\max\\{-W,\\omega-W\\}=2W-|\\omega|,\n$$\n所以卷积结果呈三角形：\n$$\nY(j\\omega)=\\frac{K^2}{2\\pi}\\bigl(2W-|\\omega|\\bigr),\\qquad |\\omega|\\leq 2W,\n$$\n而在其他情况下 $Y(j\\omega)=0$。对于采样问题，精确的振幅不是必需的；关键在于 $y(t)$ 是带限的，其最高角频率为 $2W$。\n\n根据角频率形式的采样定理，为避免对一个带限于 $|\\omega|\\leq \\Omega_{\\max}$ 的信号进行采样时发生混叠，采样角频率必须满足 $\\omega_s \\geq 2\\Omega_{\\max}$。在这里，$\\Omega_{\\max}=2W$，所以奈奎斯特率为\n$$\n\\omega_{N}=2\\cdot(2W)=4W.\n$$\n因此，对 $y(t)$ 进行采样以避免混叠所需的最低采样率（单位为弧度/秒）是 $\\omega_{N}=4W$。", "answer": "$$\\boxed{4W}$$", "id": "1726830"}]}