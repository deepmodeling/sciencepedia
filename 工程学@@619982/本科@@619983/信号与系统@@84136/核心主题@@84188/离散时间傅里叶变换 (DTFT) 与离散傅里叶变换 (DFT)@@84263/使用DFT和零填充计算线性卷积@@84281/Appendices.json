{"hands_on_practices": [{"introduction": "为了高效地计算线性卷积，我们常常利用离散傅里叶变换（DFT）的卷积定理。然而，DFT 的周期性意味着频域中的直接相乘对应于时域中的循环卷积，而非我们通常需要的线性卷积。本练习旨在解决这个核心问题：为保证基于DFT的计算结果与线性卷积完全一致，我们必须对信号进行多长的零填充？[@problem_id:1732874] 掌握这个基本计算，是正确运用此方法的第一步，也是后续所有实践的基础。", "problem": "在数字信号处理中，计算两个信号的线性卷积是一项基本运算。执行此运算的一种计算上高效的方法是使用离散傅里叶变换 (DFT)。该方法包括对输入信号进行DFT变换，在频域中将它们相乘，然后对乘积进行逆DFT变换。\n\n然而，DFT的乘积对应的是循环卷积，而非线性卷积。为了使用这种基于DFT的方法正确计算线性卷积，必须在应用DFT之前将两个信号都补零到足够的长度，以防止时域混叠。\n\n考虑两个有限长离散时间信号：一个长度为 $L_x = 10$ 的信号 $x[n]$，以及一个长度为 $L_h = 7$ 的滤波器 $h[n]$。为确保 $x[n]$ 和 $h[n]$ 的线性卷积能够被正确计算且不产生混叠，所必须使用的最小DFT大小 $N$ 是多少？\n\nA. 10\n\nB. 15\n\nC. 16\n\nD. 17\n\nE. 70", "solution": "为了通过DFT计算两个有限长序列 $x[n]$ 和 $h[n]$ 的线性卷积而不产生时域混叠，由DFT产生的循环卷积必须等于线性卷积。其充分必要条件是DFT大小 $N$ 满足\n$$\nN \\geq L_{x} + L_{h} - 1,\n$$\n其中 $L_{x}$ 和 $L_{h}$ 分别是 $x[n]$ 和 $h[n]$ 的长度。\n\n给定 $L_{x} = 10$ 和 $L_{h} = 7$，线性卷积的长度为\n$$\nL = L_{x} + L_{h} - 1 = 10 + 7 - 1 = 16.\n$$\n因此，避免混叠的最小DFT大小为\n$$\nN_{\\min} = 16.\n$$\n在所提供的选项中，这对应于选项C。", "answer": "$$\\boxed{C}$$", "id": "1732874"}, {"introduction": "在确定了正确的零填充长度后，一个自然而然的问题是：如果填充长度不足会发生什么？本练习将引导你探究当 DFT 长度 $N$ 小于线性卷积结果的长度时所产生的“时间混叠”现象。通过分析一个不满足长度条件的具体案例，你将学会准确识别出循环卷积结果中哪些样本因混叠而被“污染”，从而直观地理解为何满足长度条件 $N \\geq L_x + L_h - 1$ 如此重要。[@problem_id:1732910]", "problem": "考虑两个有限长度的离散时间序列 $x[n]$ 和 $h[n]$。序列 $x[n]$ 仅在索引 $n \\in \\{0, 1, 2, 3, 4\\}$ 上非零，序列 $h[n]$ 也仅在索引 $n \\in \\{0, 1, 2, 3, 4\\}$ 上非零。\n\n令 $y_{lin}[n]$ 为 $x[n]$ 和 $h[n]$ 的线性卷积。我们希望使用一种涉及离散傅里叶变换 (DFT) 的频域方法来计算此卷积。具体来说，我们计算序列的 8 点 DFT (在适当补零至长度为 8 后)，将它们相乘，然后计算乘积的 8 点逆 DFT。这个过程产生一个 8 个样本的序列 $y_{circ}[n]$，它是补零后序列的 8 点圆周卷积。\n\n由于所用 DFT 的长度，得到的圆周卷积 $y_{circ}[n]$ 的某些样本将不等于真实线性卷积 $y_{lin}[n]$ 的相应样本。这种现象被称为时域混叠。\n\n假设 $x[n]$ 和 $h[n]$ 在其定义的支撑集内是任意（即非全零）序列，下列哪个集合包含了所有样本 $y_{circ}[n]$ 因混叠而失真的索引 $n$？\n\nA. $\\{0\\}$\n\nB. $\\{7\\}$\n\nC. $\\{0, 7\\}$\n\nD. $\\{0, 1\\}$\n\nE. { } (空集，表示没有样本失真)\n\nF. $\\{4\\}$", "solution": "设 $x[n]$ 和 $h[n]$ 仅在 $n \\in \\{0,1,2,3,4\\}$ 上非零，因此它们的长度为 $L_{x}=5$ 和 $L_{h}=5$。线性卷积\n$$\ny_{\\text{lin}}[n] = \\sum_{k=-\\infty}^{\\infty} x[k]\\,h[n-k]\n$$\n的支撑集为 $n \\in \\{0,1,\\ldots,8\\}$，长度为 $L = L_{x} + L_{h} - 1 = 9$。\n\n将两个序列都补零至长度 $N=8$，计算它们的 8 点 DFT，相乘，然后应用 8 点逆 DFT。这将得到 8 点圆周卷积\n$$\ny_{\\text{circ}}[n] = \\sum_{k=0}^{7} x_{8}[k]\\,h_{8}[(n-k) \\bmod 8], \\quad n=0,1,\\ldots,7,\n$$\n其中 $x_{8}[n]$ 和 $h_{8}[n]$ 是 $x[n]$ 和 $h[n]$ 的补零版本。\n\n圆周卷积和线性卷积之间的基本关系是\n$$\ny_{\\text{circ}}[n] = \\sum_{m=-\\infty}^{\\infty} y_{\\text{lin}}[n + mN], \\quad N=8.\n$$\n由于 $y_{\\text{lin}}[n]$ 仅在 $n \\in \\{0,\\ldots,8\\}$ 上非零，对于每个 $n \\in \\{0,\\ldots,7\\}$，和式中唯一可能非零的项是：\n- $m=0$ 的项 $y_{\\text{lin}}[n]$，\n- $m=1$ 的项 $y_{\\text{lin}}[n+8]$，它仅在 $n+8 \\leq 8$ 时（即仅在 $n=0$ 时）非零，\n- $m=-1$ 的项 $y_{\\text{lin}}[n-8]$，对于所有的 $n \\in \\{0,\\ldots,7\\}$，该项为零。\n\n因此，\n$$\ny_{\\text{circ}}[n] =\n\\begin{cases}\ny_{\\text{lin}}[0] + y_{\\text{lin}}[8], & n=0,\\\\\ny_{\\text{lin}}[n], & n=1,2,\\ldots,7.\n\\end{cases}\n$$\n因此，圆周卷积与线性卷积不同的（即因混叠而失真的）唯一索引是 $n=0$。等效地，由于 $L - N = 9 - 8 = 1$，在使用 $N$ 点圆周卷积且 $N < L$ 时，恰好前 $L - N$ 个样本（这里只有 $n=0$ 的样本）会失真。\n\n因此，正确的选项是集合 $\\{0\\}$。", "answer": "$$\\boxed{A}$$", "id": "1732910"}, {"introduction": "在能够定性地识别出混叠发生的位置之后，我们可以更进一步，来精确地量化其影响。本练习要求你计算出由于 DFT 长度不足而导致的具体混叠误差值，即真实线性卷积结果与错误的循环卷积结果之间的数值差异。通过这个计算，你对混叠的理解将从“有”或“无”的定性判断，提升到“有多少”的定量分析，这对于在实际工程应用中评估和控制误差至关重要。[@problem_id:1732919]", "problem": "一位信号处理工程师正在设计一个有限冲激响应（FIR）滤波器。该滤波器的冲激响应由有限长度序列 $h[n]$ 给出。此滤波器用于处理一个由序列 $x[n]$ 表示的输入信号。正确的输出，即“真实”的滤波后信号，是通过计算 $x[n]$ 和 $h[n]$ 的线性卷积得到的。\n\n为了高效地执行此卷积，该工程师选择使用离散傅里叶变换（DFT）。这种方法被称为快速卷积，它涉及将两个序列的 DFT 相乘，然后计算乘积的逆 DFT。该过程实际上计算的是序列的循环卷积。为了使循环卷积等同于线性卷积，必须通过对原始序列进行补零来适当地选择 DFT 大小（记为 $N$）。\n\n然而，由于计算资源的限制，该工程师被迫使用一个比完美重建线性卷积所需的更小的 DFT 大小。这导致了时域混叠，使得计算出的输出与真实输出不同。\n\n输入信号序列为 $x[n] = \\{2, -1, 3, 1, -2\\}$，其中 $n=0, 1, 2, 3, 4$，在其他情况下为零。\n滤波器的冲激响应序列为 $h[n] = \\{1, 2, 0, -1, 3\\}$，其中 $n=0, 1, 2, 3, 4$，在其他情况下为零。\n该工程师使用的 DFT 大小为 $N=5$。\n\n对于给定的采样点索引 $n$，混叠误差定义为该索引处的真实线性卷积值减去同一索引处的计算循环卷积值。计算输出的第一个采样点（对应于索引 $n=0$）的混叠误差的数值。", "solution": "线性卷积定义为 $y_{\\text{lin}}[n] = \\sum_{k=-\\infty}^{\\infty} x[k]\\,h[n-k]$。由于当 $n \\notin \\{0,1,2,3,4\\}$ 时，$x[n]=0$ 且 $h[n]=0$，因此只有索引在 $\\{0,1,2,3,4\\}$ 内的项有贡献。\n\n对于 $n=0$，只有 $k=0$ 有贡献，所以\n$$\ny_{\\text{lin}}[0] = x[0]\\,h[0] = 2 \\cdot 1 = 2.\n$$\n\n使用 $N=5$ 点的 DFT 会得到一个 $5$ 点的循环卷积。得到的循环卷积满足时域混叠关系\n$$\ny_{\\text{circ}}[n] = \\sum_{m \\in \\mathbb{Z}} y_{\\text{lin}}[n + mN],\n$$\n求和仅在 $y_{\\text{lin}}[\\cdot]$ 有定义的索引上进行。这里，线性卷积的支撑集在 $n \\in \\{0,1,\\dots,8\\}$ 上，因此对于 $n=0$：\n$$\ny_{\\text{circ}}[0] = y_{\\text{lin}}[0] + y_{\\text{lin}}[5].\n$$\n\n显式计算 $y_{\\text{lin}}[5]$：\n$$\ny_{\\text{lin}}[5] = \\sum_{k=0}^{4} x[k]\\,h[5-k],\n$$\n其中只有满足 $5-k \\in \\{0,1,2,3,4\\}$ 的项有贡献，即 $k \\in \\{1,2,3,4\\}$。因此，\n$$\n\\begin{aligned}\ny_{\\text{lin}}[5] &= x[1]\\,h[4] + x[2]\\,h[3] + x[3]\\,h[2] + x[4]\\,h[1] \\\\\n&= (-1)\\cdot 3 + 3 \\cdot (-1) + 1 \\cdot 0 + (-2) \\cdot 2 \\\\\n&= -3 - 3 + 0 - 4 \\\\\n&= -10.\n\\end{aligned}\n$$\n因此\n$$\ny_{\\text{circ}}[0] = y_{\\text{lin}}[0] + y_{\\text{lin}}[5] = 2 + (-10) = -8.\n$$\n\n在索引 $n=0$ 处的混叠误差定义为\n$$\ne[0] = y_{\\text{lin}}[0] - y_{\\text{circ}}[0] = 2 - (-8) = 10.\n$$", "answer": "$$\\boxed{10}$$", "id": "1732919"}]}