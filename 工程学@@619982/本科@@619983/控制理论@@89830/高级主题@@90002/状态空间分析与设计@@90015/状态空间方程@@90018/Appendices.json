{"hands_on_practices": [{"introduction": "许多物理系统最初是通过高阶微分方程来描述其动态特性的。这项练习将引导你掌握一项基本技能：如何将一个高阶微分方程转换为标准的状态空间形式。具体来说，我们将使用“控制器规范型” (controller canonical form)，这是一种非常有用的结构，它使得系统可以直接应用于现代控制理论的分析与设计工具中 [@problem_id:1614942]。", "problem": "一个线性时不变 (LTI) 系统由以下三阶常微分方程描述，该方程关联了输出信号 $y(t)$ 和输入信号 $u(t)$：\n$$\n\\frac{d^3y}{dt^3} + 4\\frac{d^2y}{dt^2} + 7\\frac{dy}{dt} + 3y(t) = 5\\frac{du}{dt} + 2u(t)\n$$\n该系统可以使用状态向量 $\\mathbf{x}(t)$、状态矩阵 $A$、输入矩阵 $B$、输出矩阵 $C$ 和直接传输矩阵 $D$ 以状态空间形式表示。状态空间方程的标准形式为：\n$$\n\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t) + Bu(t)\n$$\n$$\ny(t) = C\\mathbf{x}(t) + Du(t)\n$$\n当系统表示为控制器规范型时，确定其状态矩阵 $A$。", "solution": "要将给定的微分方程转换为控制器规范型状态空间形式，我们首先求解系统的传递函数 $G(s) = Y(s)/U(s)$。我们对微分方程进行拉普拉斯变换，并假设初始条件为零。\n\n给定的方程为：\n$$\n\\frac{d^3y}{dt^3} + 4\\frac{d^2y}{dt^2} + 7\\frac{dy}{dt} + 3y(t) = 5\\frac{du}{dt} + 2u(t)\n$$\n应用拉普拉斯变换，在零初始条件下有 $\\mathcal{L}\\{f(t)\\} = F(s)$ 和 $\\mathcal{L}\\{\\frac{d^n f}{dt^n}\\} = s^n F(s)$，我们得到：\n$$\ns^3Y(s) + 4s^2Y(s) + 7sY(s) + 3Y(s) = 5sU(s) + 2U(s)\n$$\n将 $Y(s)$ 和 $U(s)$ 分别提取出来：\n$$\n(s^3 + 4s^2 + 7s + 3)Y(s) = (5s + 2)U(s)\n$$\n传递函数 $G(s)$ 是输出 $Y(s)$ 与输入 $U(s)$ 的比值：\n$$\nG(s) = \\frac{Y(s)}{U(s)} = \\frac{5s + 2}{s^3 + 4s^2 + 7s + 3}\n$$\n对于控制器规范型，我们引入一个中间变量，称之为 $Z(s)$，从而将传递函数分解为两部分：\n$$\n\\frac{Z(s)}{U(s)} = \\frac{1}{s^3 + 4s^2 + 7s + 3} \\quad \\text{和} \\quad \\frac{Y(s)}{Z(s)} = 5s + 2\n$$\n从第一个方程，我们可以写出关于中间变量 $z(t)$ 的微分方程：\n$$\n(s^3 + 4s^2 + 7s + 3)Z(s) = U(s)\n$$\n将其转换回时域得到：\n$$\n\\frac{d^3z}{dt^3} + 4\\frac{d^2z}{dt^2} + 7\\frac{dz}{dt} + 3z(t) = u(t)\n$$\n现在，我们基于 $z(t)$ 及其导数来定义状态变量。这是控制器规范型的标准选择。设状态向量为 $\\mathbf{x} = [x_1, x_2, x_3]^T$。\n$$\nx_1(t) = z(t)\n$$\n$$\nx_2(t) = \\dot{z}(t)\n$$\n$$\nx_3(t) = \\ddot{z}(t)\n$$\n我们现在可以通过对这些状态变量求导来写出状态方程：\n$$\n\\dot{x}_1 = \\dot{z} = x_2\n$$\n$$\n\\dot{x}_2 = \\ddot{z} = x_3\n$$\n为了求得 $\\dot{x}_3$，我们使用关于 $z(t)$ 的微分方程：\n$$\n\\dot{x}_3 = \\dddot{z} = -3z - 7\\dot{z} - 4\\ddot{z} + u(t)\n$$\n将状态变量代入此方程：\n$$\n\\dot{x}_3 = -3x_1 - 7x_2 - 4x_3 + u(t)\n$$\n我们现在可以将这三个状态方程写成矩阵形式 $\\dot{\\mathbf{x}} = A\\mathbf{x} + Bu$：\n$$\n\\begin{pmatrix} \\dot{x}_1 \\\\ \\dot{x}_2 \\\\ \\dot{x}_3 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -3 & -7 & -4 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} u(t)\n$$\n由此，我们可以确定状态矩阵 $A$ 和输入矩阵 $B$：\n$$\nA = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -3 & -7 & -4 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n问题明确要求的是状态矩阵 $A$。为求完整，我们再求一下输出方程。根据我们的分解，$Y(s) = (5s + 2)Z(s)$，其在时域中为：\n$$\ny(t) = 5\\dot{z}(t) + 2z(t)\n$$\n代入状态变量：\n$$\ny(t) = 5x_2 + 2x_1\n$$\n写成矩阵形式 $y = C\\mathbf{x} + Du$：\n$$\ny(t) = \\begin{pmatrix} 2 & 5 & 0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} + \\begin{pmatrix} 0 \\end{pmatrix} u(t)\n$$\n因此，输出矩阵为 $C = \\begin{pmatrix} 2 & 5 & 0 \\end{pmatrix}$，直接传输矩阵为 $D = \\begin{pmatrix} 0 \\end{pmatrix}$。\n\n问题要求的是状态矩阵 $A$。根据我们的推导，该矩阵为：\n$$\nA = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -3 & -7 & -4 \\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ -3 & -7 & -4 \\end{pmatrix}}\n$$", "id": "1614942"}, {"introduction": "当一个系统被表示为状态空间形式后，下一个关键步骤就是求解该方程，以预测其在一段时间内的行为。本练习将通过一个具体的例子，展示如何计算系统的完整时间响应，这个响应同时考虑了系统的初始状态（齐次解）和外部输入（特解）的影响。这个过程的核心在于计算和应用状态转移矩阵 $e^{At}$，这是线性时不变系统分析的基石 [@problem_id:1614978]。", "problem": "一个微型卫星使用主动热控制系统来维持一个关键星上仪器的温度。该系统的热力学动态可以通过状态空间表示来建模。设状态向量为 $\\mathbf{x}(t) = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}$，其中 $x_1(t)$ 是仪器相对于其期望工作点的温度偏差（单位为开尔文），$x_2(t)$ 是仪器安装结构的温度偏差。\n\n系统动态由以下线性时不变 (LTI) 方程描述：\n$$ \\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B u(t) $$\n系统矩阵如下：\n$$ A = \\begin{pmatrix} -1 & 1 \\\\ -5 & -3 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} $$\n输入 $u(t)$ 是提供给仪器加热器的一个归一化信号。在时间 $t=0$ 时，系统处于初始状态 $\\mathbf{x}(0) = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix}$。为了使仪器达到其工作温度，加热器被一个恒定信号激活，该信号表示为 $t \\ge 0$ 时的单位阶跃输入 $u(t) = 1$。\n\n确定对于所有 $t \\ge 0$，仪器温度偏差 $x_1(t)$ 的表达式。", "solution": "我们已知一个线性时不变系统\n$$\n\\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B u(t), \\quad A = \\begin{pmatrix} -1 & 1 \\\\ -5 & -3 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix},\n$$\n其初始条件为 $\\mathbf{x}(0) = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix}$，且对于 $t \\ge 0$ 有单位阶跃输入 $u(t)=1$。这种 LTI 系统的解为\n$$\n\\mathbf{x}(t) = \\exp(A t)\\,\\mathbf{x}(0) + \\int_{0}^{t} \\exp(A(t-\\tau))\\,B\\,u(\\tau)\\,d\\tau.\n$$\n对于恒定输入 $u(t)=1$，一个恒定的特解（稳态解）$\\mathbf{x}_{\\mathrm{ss}}$ 满足\n$$\nA\\,\\mathbf{x}_{\\mathrm{ss}} + B = \\mathbf{0} \\quad \\Longrightarrow \\quad \\mathbf{x}_{\\mathrm{ss}} = -A^{-1} B.\n$$\n计算 $A^{-1}$。行列式为\n$$\n\\det(A) = (-1)(-3) - (1)(-5) = 8,\n$$\n其伴随矩阵为\n$$\n\\operatorname{adj}(A) = \\begin{pmatrix} -3 & -1 \\\\ 5 & -1 \\end{pmatrix},\n$$\n所以\n$$\nA^{-1} = \\frac{1}{8} \\begin{pmatrix} -3 & -1 \\\\ 5 & -1 \\end{pmatrix}, \\quad A^{-1} B = \\frac{1}{8} \\begin{pmatrix} -3 \\\\ 5 \\end{pmatrix}.\n$$\n因此\n$$\n\\mathbf{x}_{\\mathrm{ss}} = -A^{-1} B = \\begin{pmatrix} \\frac{3}{8} \\\\ -\\frac{5}{8} \\end{pmatrix}.\n$$\n因此，全解可以写为\n$$\n\\mathbf{x}(t) = \\exp(A t)\\,(\\mathbf{x}(0) - \\mathbf{x}_{\\mathrm{ss}}) + \\mathbf{x}_{\\mathrm{ss}}.\n$$\n定义 $\\mathbf{v} = \\mathbf{x}(0) - \\mathbf{x}_{\\mathrm{ss}} = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} \\frac{3}{8} \\\\ -\\frac{5}{8} \\end{pmatrix} = \\begin{pmatrix} \\frac{13}{8} \\\\ \\frac{5}{8} \\end{pmatrix}$。\n\n为了计算 $\\exp(A t)$，我们使用具有共轭复特征值的 $2 \\times 2$ 矩阵的标准实数形式表达式。$A$ 的特征多项式是\n$$\n\\lambda^2 + 4 \\lambda + 8 = 0,\n$$\n所以特征值为 $-2 \\pm 2 i$。令 $a = -2$ 且 $b = 2$。那么\n$$\n\\exp(A t) = \\exp(a t)\\left[ \\cos(b t)\\,I + \\frac{\\sin(b t)}{b}\\,(A - a I) \\right]\n= \\exp(-2 t)\\left[ \\cos(2 t)\\,I + \\frac{\\sin(2 t)}{2}\\,(A + 2 I) \\right].\n$$\n计算 $(A + 2 I)$ 并将其应用于 $\\mathbf{v}$：\n$$\nA + 2 I = \\begin{pmatrix} 1 & 1 \\\\ -5 & -1 \\end{pmatrix}, \\quad (A + 2 I)\\mathbf{v} = \\begin{pmatrix} 1 & 1 \\\\ -5 & -1 \\end{pmatrix} \\begin{pmatrix} \\frac{13}{8} \\\\ \\frac{5}{8} \\end{pmatrix} = \\begin{pmatrix} \\frac{18}{8} \\\\ -\\frac{70}{8} \\end{pmatrix} = \\begin{pmatrix} \\frac{9}{4} \\\\ -\\frac{35}{4} \\end{pmatrix}.\n$$\n因此\n$$\n\\exp(A t)\\,\\mathbf{v} = \\exp(-2 t)\\left[ \\cos(2 t)\\,\\mathbf{v} + \\frac{\\sin(2 t)}{2}\\,(A + 2 I)\\mathbf{v} \\right]\n= \\exp(-2 t)\\left[ \\cos(2 t)\\begin{pmatrix} \\frac{13}{8} \\\\ \\frac{5}{8} \\end{pmatrix} + \\frac{\\sin(2 t)}{2}\\begin{pmatrix} \\frac{9}{4} \\\\ -\\frac{35}{4} \\end{pmatrix} \\right].\n$$\n第一个分量是\n$$\n\\left[\\exp(A t)\\,\\mathbf{v}\\right]_{1} = \\exp(-2 t)\\left( \\frac{13}{8}\\cos(2 t) + \\frac{9}{8}\\sin(2 t) \\right).\n$$\n加上稳态解的第一个分量 $\\left(\\mathbf{x}_{\\mathrm{ss}}\\right)_{1} = \\frac{3}{8}$，得到\n$$\nx_{1}(t) = \\exp(-2 t)\\left( \\frac{13}{8}\\cos(2 t) + \\frac{9}{8}\\sin(2 t) \\right) + \\frac{3}{8}, \\quad t \\ge 0.\n$$\n这满足二阶简化方程 $\\ddot{x}_{1} + 4 \\dot{x}_{1} + 8 x_{1} = 3$ 及其初始条件 $x_{1}(0) = 2$ 和 $\\dot{x}_{1}(0) = -1$，从而证实了一致性。", "answer": "$$\\boxed{\\exp(-2 t)\\left(\\frac{13}{8}\\cos(2 t)+\\frac{9}{8}\\sin(2 t)\\right)+\\frac{3}{8}}$$", "id": "1614978"}, {"introduction": "现实世界中的工程系统通常由多个相互连接的子系统构成。状态空间方法的美妙之处在于其模块化特性，允许我们从简单的模块构建复杂的系统。本练习将向你展示如何系统地组合两个独立子系统的状态空间模型，以创建一个描述它们并联组合的整体模型。这种模块化的建模方法对于分析和设计复杂的工程系统至关重要 [@problem_id:1614954]。", "problem": "两个独立的线性时不变 (LTI) 系统由它们各自的状态空间模型描述。\n\n系统1是一个二阶系统，其状态向量为 $\\mathbf{x}_1(t) \\in \\mathbb{R}^2$，标量输入为 $u_1(t)$，标量输出为 $y_1(t)$。其动态由以下方程给出：\n$$\n\\dot{\\mathbf{x}}_1(t) = A_1 \\mathbf{x}_1(t) + B_1 u_1(t)\n$$\n$$\ny_1(t) = C_1 \\mathbf{x}_1(t) + D_1 u_1(t)\n$$\n其中矩阵为：\n$$\nA_1 = \\begin{pmatrix} 0 & 1 \\\\ -5 & -6 \\end{pmatrix}, \\quad B_1 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C_1 = \\begin{pmatrix} 1 & 1 \\end{pmatrix}, \\quad D_1 = 0\n$$\n\n系统2是一个一阶系统，其状态变量为 $x_2(t) \\in \\mathbb{R}$，标量输入为 $u_2(t)$，标量输出为 $y_2(t)$。其动态由以下方程给出：\n$$\n\\dot{x}_2(t) = A_2 x_2(t) + B_2 u_2(t)\n$$\n$$\ny_2(t) = C_2 x_2(t) + D_2 u_2(t)\n$$\n其中矩阵（在本例中为标量）为：\n$$\nA_2 = -2, \\quad B_2 = 3, \\quad C_2 = 1, \\quad D_2 = 1\n$$\n\n这两个系统并联。这意味着它们共享相同的输入 $u(t)$，使得 $u_1(t) = u_2(t) = u(t)$。组合系统的总输出 $y(t)$ 是它们各自输出的总和，即 $y(t) = y_1(t) + y_2(t)$。\n\n得到的组合系统可以使用复合状态向量 $\\mathbf{x}(t) = \\begin{pmatrix} \\mathbf{x}_1(t) \\\\ x_2(t) \\end{pmatrix}$，用一个新的三阶状态空间模型来描述。该模型具有以下标准形式：\n$$\n\\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B u(t)\n$$\n$$\ny(t) = C \\mathbf{x}(t) + D u(t)\n$$\n\n以下哪个选项正确地标识了该并联组合系统的状态空间矩阵 $A, B, C$ 和 $D$？\n\nA. $A = \\begin{pmatrix} 0 & 1 & 0 \\\\ -5 & -6 & 0 \\\\ 0 & 0 & -2 \\end{pmatrix}, B = \\begin{pmatrix} 0 \\\\ 1 \\\\ 3 \\end{pmatrix}, C = \\begin{pmatrix} 1 & 1 & 1 \\end{pmatrix}, D = 1$\n\nB. $A = \\begin{pmatrix} 0 & 1 & 0 \\\\ -5 & -6 & 0 \\\\ 3 & 3 & -2 \\end{pmatrix}, B = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}, C = \\begin{pmatrix} 1 & 1 & 1 \\end{pmatrix}, D = 0$\n\nC. $A = \\begin{pmatrix} 0 & 1 & 0 \\\\ -5 & -6 & 0 \\\\ 0 & 0 & -2 \\end{pmatrix}, B = \\begin{pmatrix} 0 \\\\ 1 \\\\ 3 \\end{pmatrix}, C = \\begin{pmatrix} 1 & 1 & -1 \\end{pmatrix}, D = -1$\n\nD. $A = \\begin{pmatrix} 0 & 1 & 0 \\\\ -5 & -6 & 0 \\\\ 0 & 0 & -2 \\end{pmatrix}, B = \\begin{pmatrix} 0 \\\\ 1 \\\\ 3 \\end{pmatrix}, C = \\begin{pmatrix} 1 & 1 & 1 \\end{pmatrix}, D = 0$", "solution": "因为系统是独立的，并通过共享输入进行并联，复合状态定义为 $\\mathbf{x}(t) = \\begin{pmatrix} \\mathbf{x}_{1}(t) \\\\ x_{2}(t) \\end{pmatrix}$，并且两个子系统的输入均为 $u(t)$。子系统的状态方程为\n$$\n\\dot{\\mathbf{x}}_{1}(t) = A_{1}\\mathbf{x}_{1}(t) + B_{1}u(t), \\quad \\dot{x}_{2}(t) = A_{2}x_{2}(t) + B_{2}u(t).\n$$\n将这些方程堆叠起来，得到总的状态方程\n$$\n\\dot{\\mathbf{x}}(t) = \\begin{pmatrix} A_{1} & 0 \\\\ 0 & A_{2} \\end{pmatrix} \\mathbf{x}(t) + \\begin{pmatrix} B_{1} \\\\ B_{2} \\end{pmatrix} u(t).\n$$\n代入给定的矩阵，\n$$\nA = \\begin{pmatrix} 0 & 1 & 0 \\\\ -5 & -6 & 0 \\\\ 0 & 0 & -2 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\\\ 3 \\end{pmatrix}.\n$$\n\n对于输出，并联连接得出 $y(t) = y_{1}(t) + y_{2}(t)$，因此\n$$\ny(t) = C_{1}\\mathbf{x}_{1}(t) + D_{1}u(t) + C_{2}x_{2}(t) + D_{2}u(t) = \\begin{pmatrix} C_{1} & C_{2} \\end{pmatrix} \\mathbf{x}(t) + (D_{1} + D_{2}) u(t).\n$$\n代入给定的矩阵，\n$$\nC = \\begin{pmatrix} 1 & 1 & 1 \\end{pmatrix}, \\quad D = 0 + 1 = 1.\n$$\n\n因此，正确的组合状态空间矩阵为\n$$\nA = \\begin{pmatrix} 0 & 1 & 0 \\\\ -5 & -6 & 0 \\\\ 0 & 0 & -2 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\\\ 3 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 1 & 1 \\end{pmatrix}, \\quad D = 1,\n$$\n这对应于选项A。", "answer": "$$\\boxed{A}$$", "id": "1614954"}]}