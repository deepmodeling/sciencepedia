{"hands_on_practices": [{"introduction": "理论学习的核心在于实践。本节的第一个练习将引导我们直面一个根本性问题：当一个系统的传递函数出现零极点对消时，其状态空间实现会发生什么？通过分析一个看似简单的二阶系统，我们将揭示传递函数阶次与最小实现阶次之间的关系，并理解为何任何非最小实现都必然导致可控性或可观测性的丧失 [@problem_id:1706947]。", "problem": "考虑一个单输入单输出（SISO）线性时不变（LTI）系统。输入 $U(s)$ 的拉普拉斯变换与输出 $Y(s)$ 的拉普拉斯变换之间的关系由以下传递函数给出：\n$$G(s) = \\frac{Y(s)}{U(s)} = \\frac{s + 1}{s^2 + 3s + 2}$$\n一位控制工程师打算使用以下形式的二维状态空间模型来实现该系统：\n$$ \\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B u(t) $$\n$$ y(t) = C \\mathbf{x}(t) + D u(t) $$\n其中 $\\mathbf{x}(t)$ 是 2x1 的状态向量，$A$ 是 2x2 矩阵，$B$ 是 2x1 矩阵，$C$ 是 1x2 矩阵，并可以假设标量 $D=0$。\n\n对于该传递函数的*任何*有效的二维状态空间实现，下列哪个陈述必然是正确的？\n\nA. 该实现总是能控且总是能观的。\n\nB. 该实现总是能控的，但可能不能观。\n\nC. 该实现总是能观的，但可能不能控。\n\nD. 该实现必须是不能控，或不能观，或两者兼有。\n\nE. 该实现是能控还是能观完全取决于所选择的状态变量，并且有可能找到一个既能控又能观的实现。", "solution": "我们从给定的传递函数开始\n$$G(s)=\\frac{Y(s)}{U(s)}=\\frac{s+1}{s^{2}+3s+2}.$$\n对分母进行因式分解：\n$$s^{2}+3s+2=(s+1)(s+2),$$\n所以\n$$G(s)=\\frac{s+1}{(s+1)(s+2)}=\\frac{1}{s+2}.$$\n因此，该传递函数可以简化为一阶严格真分式形式，其麦克米兰阶（McMillan degree）为\n$$n_{\\min}=1.$$\n\n任何状态空间实现 $(A,B,C,D)$（其中 $D=0$）都满足\n$$G(s)=C(sI-A)^{-1}B.$$\n根据基本实现理论：\n- 一个实现是最小的，当且仅当它既是能控的又是能观的。\n- 任何实现的最小维数等于 $G(s)$ 的麦克米兰阶。\n\n由于 $n_{\\min}=1$，任何二维实现必然是非最小的。因此，根据最小实现准则，它不可能同时是能控和能观的。等价地，每个这样的二维实现必须是不能控，或不能观，或两者兼有。\n\n因此，在这些选项中，对于任何有效的二维实现必然为真的陈述是：它必须是不能控，或不能观，或两者兼有。", "answer": "$$\\boxed{D}$$", "id": "1706947"}, {"introduction": "在理解了零极点对消意味着系统非最小之后，我们自然会问：这种不可控或不可观的模式在系统矩阵中是如何体现的？本练习利用约旦标准型 (Jordan normal form) 这一强大工具，让我们能够精准定位导致特定动态模式“隐藏”的结构性原因 [@problem_id:1573679]。通过确定输入矩阵 $B$ 和输出矩阵 $C$ 的哪些特定元素为零会导致对消，我们将深入理解可控性/可观测性与系统内部连接之间的深刻联系。", "problem": "考虑一个四阶线性时不变 (LTI) 系统，其状态空间表示为 $\\dot{x}(t) = Ax(t) + Bu(t)$ 和 $y(t) = Cx(t)$，其中 $x(t) \\in \\mathbb{R}^4$ 是状态向量，$u(t) \\in \\mathbb{R}$ 是标量输入，$y(t) \\in \\mathbb{R}$ 是标量输出。\n\n系统矩阵 $A$ 以若尔当标准型给出：\n$$\nA = \\begin{pmatrix}\n\\lambda_1 & 1 & 0 & 0 \\\\\n0 & \\lambda_1 & 0 & 0 \\\\\n0 & 0 & \\lambda_2 & 1 \\\\\n0 & 0 & 0 & \\lambda_2\n\\end{pmatrix}\n$$\n其中 $\\lambda_1$ 和 $\\lambda_2$ 是不同的实值特征值。\n\n输入矩阵 $B$ 和输出矩阵 $C$ 分别由列向量和行向量给出：\n$$\nB = \\begin{pmatrix} b_1 \\\\ b_2 \\\\ b_3 \\\\ b_4 \\end{pmatrix}, \\quad C = \\begin{pmatrix} c_1 & c_2 & c_3 & c_4 \\end{pmatrix}\n$$\n其中 $b_i$ 和 $c_i$ 是实常数。\n\n通过分析系统的输入输出行为，观察到传递函数 $G(s) = Y(s)/U(s)$ 未能表示完整的系统动态特性。具体来说，系统的特征多项式为 $\\det(sI-A) = (s-\\lambda_1)^2(s-\\lambda_2)^2$，但由于在 $s=\\lambda_1$ 处至少有一个极点发生了对消，传递函数的分母阶数严格小于四。\n\n下列哪个选项代表了发生这种特定极点对消现象时，$B$ 和 $C$ 的分量所需满足的充要条件？\n\nA. $c_1 = 0$ 或 $b_2 = 0$\n\nB. $c_2 = 0$ 或 $b_1 = 0$\n\nC. $c_1 = 0$ 且 $b_2 = 0$\n\nD. $c_2 = 0$ 且 $b_1 = 0$\n\nE. $c_3 = 0$ 或 $b_4 = 0$\n\nF. 对于任何非零的 $B$ 和 $C$，传递函数的分母总是四阶的。", "solution": "我们使用 LTI 状态空间系统的标准输入输出关系，其传递函数由下式给出\n$$\nG(s) \\;=\\; C\\,(sI - A)^{-1}B.\n$$\n由于 $A$ 是一个块对角矩阵，由两个位于 $\\lambda_{1}$ 和 $\\lambda_{2}$ 的 $2\\times 2$ 若尔当块组成，且 $\\lambda_{1}\\neq \\lambda_{2}$，我们可以将向量和矩阵进行相应分块：\n$$\nJ_{1}=\\begin{pmatrix}\\lambda_{1} & 1 \\\\ 0 & \\lambda_{1}\\end{pmatrix},\\quad\nJ_{2}=\\begin{pmatrix}\\lambda_{2} & 1 \\\\ 0 & \\lambda_{2}\\end{pmatrix},\\quad\nB=\\begin{pmatrix}B_{1}\\\\ B_{2}\\end{pmatrix},\\quad C=\\begin{pmatrix}C_{1} & C_{2}\\end{pmatrix},\n$$\n其中 $B_{1}=\\begin{pmatrix}b_{1}\\\\ b_{2}\\end{pmatrix}$，$B_{2}=\\begin{pmatrix}b_{3}\\\\ b_{4}\\end{pmatrix}$，$C_{1}=\\begin{pmatrix}c_{1} & c_{2}\\end{pmatrix}$，$C_{2}=\\begin{pmatrix}c_{3} & c_{4}\\end{pmatrix}$。那么\n$$\nG(s) \\;=\\; C_{1}(sI-J_{1})^{-1}B_{1} \\;+\\; C_{2}(sI-J_{2})^{-1}B_{2}.\n$$\n对于一个 $2\\times 2$ 的若尔当块 $J=\\begin{pmatrix}\\lambda & 1\\\\ 0 & \\lambda\\end{pmatrix}$，其预解式为\n$$\n(sI-J)^{-1} \\;=\\; (s-\\lambda)^{-1}I \\;+\\; (s-\\lambda)^{-2}N \\;=\\; \\begin{pmatrix}(s-\\lambda)^{-1} & (s-\\lambda)^{-2}\\\\ 0 & (s-\\lambda)^{-1}\\end{pmatrix},\n$$\n其中 $N=\\begin{pmatrix}0&1\\\\0&0\\end{pmatrix}$。将此应用于 $J_{1}$ 可得\n$$\n(sI-J_{1})^{-1} \\;=\\; \\begin{pmatrix}(s-\\lambda_{1})^{-1} & (s-\\lambda_{1})^{-2}\\\\ 0 & (s-\\lambda_{1})^{-1}\\end{pmatrix}.\n$$\n因此，\n$$\nC_{1}(sI-J_{1})^{-1}B_{1}\n= \\begin{pmatrix}c_{1} & c_{2}\\end{pmatrix}\n\\begin{pmatrix}(s-\\lambda_{1})^{-1} & (s-\\lambda_{1})^{-2}\\\\ 0 & (s-\\lambda_{1})^{-1}\\end{pmatrix}\n\\begin{pmatrix}b_{1}\\\\ b_{2}\\end{pmatrix}.\n$$\n一步步进行乘法运算，\n$$\n\\begin{pmatrix}(s-\\lambda_{1})^{-1} & (s-\\lambda_{1})^{-2}\\\\ 0 & (s-\\lambda_{1})^{-1}\\end{pmatrix}\n\\begin{pmatrix}b_{1}\\\\ b_{2}\\end{pmatrix}\n=\n\\begin{pmatrix}(s-\\lambda_{1})^{-1}b_{1} + (s-\\lambda_{1})^{-2}b_{2}\\\\ (s-\\lambda_{1})^{-1}b_{2}\\end{pmatrix},\n$$\n然后\n$$\nC_{1}(sI-J_{1})^{-1}B_{1}\n= c_{1}\\big((s-\\lambda_{1})^{-1}b_{1} + (s-\\lambda_{1})^{-2}b_{2}\\big) + c_{2}(s-\\lambda_{1})^{-1}b_{2}.\n$$\n因此，来自 $\\lambda_{1}$-块的贡献为\n$$\nG_{1}(s) \\;=\\; \\big(c_{1}b_{1} + c_{2}b_{2}\\big)\\,(s-\\lambda_{1})^{-1} \\;+\\; \\big(c_{1}b_{2}\\big)\\,(s-\\lambda_{1})^{-2}.\n$$\n类似地，来自 $\\lambda_{2}$-块的贡献为\n$$\nG_{2}(s) \\;=\\; \\big(c_{3}b_{3} + c_{4}b_{4}\\big)\\,(s-\\lambda_{2})^{-1} \\;+\\; \\big(c_{3}b_{4}\\big)\\,(s-\\lambda_{2})^{-2}.\n$$\n由于 $\\lambda_{1}\\neq \\lambda_{2}$，$G_{2}(s)$ 在 $s=\\lambda_{1}$ 处是解析的，不能对消 $s=\\lambda_{1}$ 处的任何奇点。因此，$G(s)$ 在 $s=\\lambda_{1}$ 处的任何极点的存在性及其阶数完全由 $G_{1}(s)$ 决定。\n\n从 $G_{1}(s)$ 的表达式可知，二阶极点 $(s-\\lambda_{1})^{-2}$ 的系数是 $c_{1}b_{2}$。因此：\n- 若 $c_{1}b_{2}\\neq 0$，则 $G_{1}(s)$ 在 $s=\\lambda_{1}$ 处有一个二阶极点，因此在 $s=\\lambda_{1}$ 处没有极点对消发生，总的分母阶数仍为四。\n- 若 $c_{1}b_{2}=0$，则二阶项消失，在 $s=\\lambda_{1}$ 处通过系数 $c_{1}b_{1}+c_{2}b_{2}$ 最多保留一个一阶极点。这保证了在 $\\lambda_{1}$ 处的两个重极点中至少有一个被对消，从而使分母阶数至少降低一。如果此外还有 $c_{1}b_{1}+c_{2}b_{2}=0$，那么在 $\\lambda_{1}$ 处的两个极点都被对消。\n\n因此，在 $s=\\lambda_{1}$ 处至少有一个极点发生对消的充要条件是\n$$\nc_{1}b_{2} \\;=\\; 0 \\quad\\Longleftrightarrow\\quad c_{1}=0 \\;\\text{ 或 }\\; b_{2}=0,\n$$\n这对应于选项 A。其他列出的选项都不能保证这种对消，而选项 F 是错误的，因为在上述条件下分母的阶数可以降低。", "answer": "$$\\boxed{A}$$", "id": "1573679"}, {"introduction": "前面的练习揭示了零极点对消的理论后果，但其在工程实践中最危险的应用场景是什么？本综合练习将通过一个具体案例，向我们展示一个“特洛伊木马”式的情景：一个从传递函数看是稳定的系统，其内部却隐藏着一个不稳定的、即将失控的动态模式 [@problem_id:2713329]。通过完整分析其可控性、可观测性并构建最小实现，我们将深刻体会到为何绝不能仅仅依赖传递函数来判断系统的内部稳定性。", "problem": "考虑一个由以下矩阵描述的单输入单输出 (SISO) 线性时不变 (LTI) 状态空间系统\n$$\nA=\\begin{pmatrix}\n2 & 0 & 0\\\\\n0 & -1 & 0\\\\\n0 & 0 & -3\n\\end{pmatrix},\\quad\nB=\\begin{pmatrix}\n0\\\\\n1\\\\\n1\n\\end{pmatrix},\\quad\nC=\\begin{pmatrix}\n0 & 1 & 1\n\\end{pmatrix},\\quad\nD=0.\n$$\n仅使用线性系统与控制的基本定义（状态方程、输出方程、拉普拉斯变换，以及能控性、能观性、内部渐近稳定性和最小实现的定义），完成以下步骤：\n\n1) 从状态和输出方程出发，通过拉普拉斯变换推导出给定实现的输入-输出传递函数 $G(s)$。\n\n2) 通过确定其在复平面上的极点位置，判断传递函数 $G(s)$ 是否渐近稳定。清晰地解释 $G(s)$ 中可能存在的极零点对消与所给实现的内部动态有何关系。\n\n3) 通过明确构造能控性矩阵和能观性矩阵并评估其秩，分析该实现的能控性和能观性。指出任何既不能控也不能观的状态分量。\n\n4) 通过移除所有不能控和/或不能观的模态，构建最小实现，并写出最小实现的状态矩阵。解释该最小实现与 $G(s)$ 以及原始实现的内部渐近稳定性（作为自治动态的一个属性）之间的关系。\n\n5) 报告在传递函数中因极零点对消而被掩盖、但存在于原始实现中的不稳定内部特征值的数值。你的最终答案必须是一个无单位的实数。无需四舍五入。", "solution": "该系统由以下状态空间方程描述：\n$$\n\\dot{x}(t) = Ax(t) + Bu(t) \\\\\ny(t) = Cx(t) + Du(t)\n$$\n其中给定的矩阵为：\n$$\nA=\\begin{pmatrix}\n2 & 0 & 0\\\\\n0 & -1 & 0\\\\\n0 & 0 & -3\n\\end{pmatrix},\\quad\nB=\\begin{pmatrix}\n0\\\\\n1\\\\\n1\n\\end{pmatrix},\\quad\nC=\\begin{pmatrix}\n0 & 1 & 1\n\\end{pmatrix},\\quad\nD=0\n$$\n\n**1) 传递函数 $G(s)$ 的推导**\n\n我们首先对状态和输出方程应用拉普拉斯变换，并假设初始条件为零 ($x(0)=0$)。\n$$\nsX(s) = AX(s) + BU(s) \\\\\nY(s) = CX(s) + DU(s)\n$$\n从状态方程中，我们求解频域中的状态向量 $X(s)$：\n$$\n(sI - A)X(s) = BU(s) \\implies X(s) = (sI - A)^{-1}BU(s)\n$$\n其中 $I$ 是 $3 \\times 3$ 的单位矩阵。将此代入输出方程，得到：\n$$\nY(s) = C(sI - A)^{-1}BU(s) + DU(s) = \\left( C(sI - A)^{-1}B + D \\right) U(s)\n$$\n传递函数 $G(s)$ 是 $Y(s)/U(s)$ 的比值，因此：\n$$\nG(s) = C(sI - A)^{-1}B + D\n$$\n我们首先计算矩阵 $(sI - A)^{-1}$：\n$$\nsI - A = \\begin{pmatrix} s-2 & 0 & 0 \\\\ 0 & s+1 & 0 \\\\ 0 & 0 & s+3 \\end{pmatrix}\n$$\n由于 $sI - A$ 是一个对角矩阵，其逆矩阵就是对角元素取倒数后构成的矩阵：\n$$\n(sI - A)^{-1} = \\begin{pmatrix} \\frac{1}{s-2} & 0 & 0 \\\\ 0 & \\frac{1}{s+1} & 0 \\\\ 0 & 0 & \\frac{1}{s+3} \\end{pmatrix}\n$$\n现在我们进行矩阵乘法 $C(sI-A)^{-1}B$。已知 $D=0$：\n$$\nG(s) = \\begin{pmatrix} 0 & 1 & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{s-2} & 0 & 0 \\\\ 0 & \\frac{1}{s+1} & 0 \\\\ 0 & 0 & \\frac{1}{s+3} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n$$\nG(s) = \\begin{pmatrix} 0 & \\frac{1}{s+1} & \\frac{1}{s+3} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n$$\nG(s) = (0)\\left(\\frac{1}{s-2}\\right)(0) + (1)\\left(\\frac{1}{s+1}\\right)(1) + (1)\\left(\\frac{1}{s+3}\\right)(1) = \\frac{1}{s+1} + \\frac{1}{s+3}\n$$\n合并各项，得到传递函数的最终形式：\n$$\nG(s) = \\frac{(s+3) + (s+1)}{(s+1)(s+3)} = \\frac{2s+4}{s^2+4s+3}\n$$\n\n**2) $G(s)$ 的稳定性分析与极零点对消**\n\n传递函数 $G(s)$ 的极点是其分母多项式的根，即 $s_1 = -1$ 和 $s_2 = -3$。由于两个极点的实部都严格为负，它们位于复平面的开左半平面。因此，由 $G(s)$ 描述的输入-输出系统是渐近稳定的。\n\n然而，系统的内部稳定性由状态矩阵 $A$ 的特征值决定。由于 $A$ 是一个对角矩阵，其特征值即为对角线上的元素：$\\lambda_1 = 2$，$\\lambda_2 = -1$ 和 $\\lambda_3 = -3$。这些是系统的模态。\n传递函数的极点集合是 $\\{\\text{-}1, \\text{-}3\\}$，它是系统特征值集合 $\\{2, \\text{-}1, \\text{-}3\\}$ 的一个真子集。特征值 $\\lambda_1 = 2$ 没有在 $G(s)$ 中表现为极点。这表明在计算传递函数的过程中发生了极零点对消。与特征值 $\\lambda_1=2$ 相关的动态模态因此是不能控或不能观的（或两者兼有），使其从输入-输出的角度来看是“隐藏”的。\n关键的是，由于 $\\operatorname{Re}(\\lambda_1) = 2 > 0$，这个隐藏模态是不稳定的。存在不稳定的特征值意味着整个系统不是内部渐近稳定的，尽管其传递函数是稳定的。\n\n**3) 能控性与能观性分析**\n\n我们评估这个 $n=3$ 系统的能控性和能观性。\n\n对于能控性，我们构造能控性矩阵 $\\mathcal{C} = \\begin{pmatrix} B & AB & A^2B \\end{pmatrix}$：\n$$\nAB = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & -1 & 0 \\\\ 0 & 0 & -3 \\end{pmatrix}\\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\\\ -3 \\end{pmatrix}\n$$\n$$\nA^2B = A(AB) = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & -1 & 0 \\\\ 0 & 0 & -3 \\end{pmatrix}\\begin{pmatrix} 0 \\\\ -1 \\\\ -3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 9 \\end{pmatrix}\n$$\n$$\n\\mathcal{C} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 1 & -1 & 1 \\\\ 1 & -3 & 9 \\end{pmatrix}\n$$\n$\\mathcal{C}$ 的第一行是零向量，这直接表明该矩阵是秩亏的。$\\mathcal{C}$ 的秩为 $2$，小于系统阶数 $n=3$。因此，该系统是不能控的。第一行的零向量对应于第一个状态变量 $x_1$，它与特征值 $\\lambda_1=2$ 相关联。该模态是不能控的。\n\n对于能观性，我们构造能观性矩阵 $\\mathcal{O} = \\begin{pmatrix} C^T & A^T C^T & (A^T)^2 C^T \\end{pmatrix}^T = \\begin{pmatrix} C \\\\ CA \\\\ CA^2 \\end{pmatrix}$：\n$$\nCA = \\begin{pmatrix} 0 & 1 & 1 \\end{pmatrix}\\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & -1 & 0 \\\\ 0 & 0 & -3 \\end{pmatrix} = \\begin{pmatrix} 0 & -1 & -3 \\end{pmatrix}\n$$\n$$\nCA^2 = (CA)A = \\begin{pmatrix} 0 & -1 & -3 \\end{pmatrix}\\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & -1 & 0 \\\\ 0 & 0 & -3 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 & 9 \\end{pmatrix}\n$$\n$$\n\\mathcal{O} = \\begin{pmatrix} 0 & 1 & 1 \\\\ 0 & -1 & -3 \\\\ 0 & 1 & 9 \\end{pmatrix}\n$$\n$\\mathcal{O}$ 的第一列是零向量，意味着该矩阵是秩亏的。$\\mathcal{O}$ 的秩为 $2$，小于 $n=3$。因此，该系统是不能观的。第一列的零向量表明第一个状态变量 $x_1$ 的变化对输出没有影响。与特征值 $\\lambda_1=2$ 相关联的模态是不能观的。\n\n与特征值 $\\lambda_1=2$ 对应的状态分量被证实既不能控也不能观。\n\n**4) 最小实现与内部稳定性**\n\n传递函数的一个最小实现是既完全能控又完全能观的实现。它只表示连接输入和输出的动态。鉴于在 $\\lambda_1=2$ 处的模态既不能控也不能观，可以将其移除以构成最小实现。\n原始系统的状态 $x_2$ 和 $x_3$ 对应于能控且能观的子系统。我们通过取矩阵 $A$、$B$ 和 $C$ 中对应于这两个状态的部分来构建最小实现。\n最小实现的状态矩阵 $A_{min}$ 是：\n$$\nA_{\\min} = \\begin{pmatrix} -1 & 0 \\\\ 0 & -3 \\end{pmatrix}\n$$\n相应的输入和输出矩阵是 $B_{\\min} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $C_{\\min} = \\begin{pmatrix} 1 & 1 \\end{pmatrix}$。这个最小实现 $(A_{\\min}, B_{\\min}, C_{\\min}, D)$ 的传递函数与之前推导的 $G(s)$ 完全相同。$A_{\\min}$ 的特征值为 $\\{-1, -3\\}$，两者都是稳定的。因此，这个最小实现是内部渐近稳定的。\n\n然而，*原始*实现的内部稳定性由原始矩阵 $A = \\operatorname{diag}(2, -1, -3)$ 的特征值决定。由于在右半平面存在特征值 $\\lambda = 2$，原始系统是内部不稳定的。这个不稳定的动态与输入和输出完全解耦，这一事实解释了极零点对消现象。\n\n**5) 不稳定的内部特征值**\n\n系统的内部动态由矩阵 $A$ 的特征值决定。特征值为 $\\{2, -1, -3\\}$。如果一个特征值 $\\lambda$ 的实部非负，即 $\\operatorname{Re}(\\lambda) \\geq 0$，则它对应一个不稳定的模态。在这种情况下，特征值 $\\lambda_1 = 2$ 满足此条件。这就是在传递函数 $G(s)$ 中因极零点对消而被掩盖的不稳定内部特征值。其数值为 $2$。", "answer": "$$\n\\boxed{2}\n$$", "id": "2713329"}]}