{"hands_on_practices": [{"introduction": "掌握可控性格拉姆矩阵 (Controllability Gramian) 是分析线性系统可控性的基石。对于稳定的连续时间系统，我们可以通过求解代数李雅普诺夫方程 (algebraic Lyapunov equation) 来确定其无穷时域可控性格拉姆矩阵，这通常比直接计算积分更简便。本练习将通过一个由两个独立子系统构成的解耦系统，引导您应用李雅普诺夫方程，并直观地理解系统结构（如解耦特性）是如何体现在格拉姆矩阵中的。[@problem_id:1565982]", "problem": "考虑一个由两个独立的、不相互作用的子系统组成的物理系统。整个系统的状态由状态向量 $\\mathbf{x}(t) = \\begin{pmatrix} x_1(t) & x_2(t) \\end{pmatrix}^T$ 描述，其演化由线性时不变 (LTI) 状态空间方程 $\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t) + B\\mathbf{u}(t)$ 决定。\n\n系统动力学由矩阵 $A$ 定义，控制输入 $\\mathbf{u}(t)$ 通过矩阵 $B$ 影响系统。对于这个特定系统，矩阵由下式给出：\n$$\nA = \\begin{pmatrix} -\\lambda_1 & 0 \\\\ 0 & -\\lambda_2 \\end{pmatrix}\n\\quad \\text{and} \\quad\nB = \\begin{pmatrix} \\beta_1 & 0 \\\\ 0 & \\beta_2 \\end{pmatrix}\n$$\n此处，$\\lambda_1$ 和 $\\lambda_2$ 是不同的正常数，代表两个子系统的稳定衰减率，而 $\\beta_1$ 和 $\\beta_2$ 是非零实常数，代表相应输入的有效性。\n\n这个稳定系统在无限时间范围内的可控性，可以通过可控性格拉姆矩阵 $W_c$ 来量化。该格拉姆矩阵是满足以下连续时间代数李雅普诺夫方程的唯一对称正定矩阵：\n$$\nAW_c + W_c A^T = -BB^T\n$$\n你的任务是求解此方程，以确定给定系统的可控性格拉姆矩阵 $W_c$。请用符号参数 $\\lambda_1, \\lambda_2, \\beta_1$ 和 $\\beta_2$ 将你的答案表示为一个 2x2 矩阵。", "solution": "给定可控性格拉姆矩阵 $W_{c}$ 的连续时间代数李雅普诺夫方程，\n$$\nA W_{c} + W_{c} A^{T} = - B B^{T},\n$$\n其中\n$$\nA = \\begin{pmatrix} -\\lambda_{1} & 0 \\\\ 0 & -\\lambda_{2} \\end{pmatrix}, \\quad B = \\begin{pmatrix} \\beta_{1} & 0 \\\\ 0 & \\beta_{2} \\end{pmatrix},\n$$\n且 $\\lambda_{1}, \\lambda_{2} > 0$，$\\beta_{1}, \\beta_{2} \\neq 0$。因为 $A$ 是一个对角元素为负的对角矩阵，所以它是赫尔维茨矩阵，因此该李雅普诺夫方程有唯一的对称正定解。令\n$$\nW_{c} = \\begin{pmatrix} w_{11} & w_{12} \\\\ w_{12} & w_{22} \\end{pmatrix}, \\quad A^{T} = A = \\begin{pmatrix} -\\lambda_1 & 0 \\\\ 0 & -\\lambda_2 \\end{pmatrix}, \\quad B B^{T} = \\begin{pmatrix} \\beta_{1}^{2} & 0 \\\\ 0 & \\beta_{2}^{2} \\end{pmatrix}.\n$$\n计算各项：\n$$\nA W_{c} = \\begin{pmatrix} -\\lambda_{1} & 0 \\\\ 0 & -\\lambda_{2} \\end{pmatrix} \\begin{pmatrix} w_{11} & w_{12} \\\\ w_{12} & w_{22} \\end{pmatrix} = \\begin{pmatrix} -\\lambda_{1} w_{11} & -\\lambda_{1} w_{12} \\\\ -\\lambda_{2} w_{12} & -\\lambda_{2} w_{22} \\end{pmatrix},\n$$\n$$\nW_{c} A^T = \\begin{pmatrix} w_{11} & w_{12} \\\\ w_{12} & w_{22} \\end{pmatrix} \\begin{pmatrix} -\\lambda_{1} & 0 \\\\ 0 & -\\lambda_{2} \\end{pmatrix} = \\begin{pmatrix} -\\lambda_{1} w_{11} & -\\lambda_{2} w_{12} \\\\ -\\lambda_{1} w_{12} & -\\lambda_{2} w_{22} \\end{pmatrix}.\n$$\n因此，\n$$\nA W_{c} + W_{c} A^T = \\begin{pmatrix} -2 \\lambda_{1} w_{11} & -(\\lambda_{1} + \\lambda_{2}) w_{12} \\\\ -(\\lambda_{1} + \\lambda_{2}) w_{12} & -2 \\lambda_{2} w_{22} \\end{pmatrix}.\n$$\n令其等于 $- B B^{T}$，得到方程组\n$$\n-2 \\lambda_{1} w_{11} = - \\beta_{1}^{2}, \\quad -(\\lambda_{1} + \\lambda_{2}) w_{12} = 0, \\quad -2 \\lambda_{2} w_{22} = - \\beta_{2}^{2}.\n$$\n利用 $\\lambda_{1}, \\lambda_{2} > 0$ 求解，可得\n$$\nw_{11} = \\frac{\\beta_{1}^{2}}{2 \\lambda_{1}}, \\quad w_{12} = 0, \\quad w_{22} = \\frac{\\beta_{2}^{2}}{2 \\lambda_{2}}.\n$$\n因此，\n$$\nW_{c} = \\begin{pmatrix} \\frac{\\beta_{1}^{2}}{2 \\lambda_{1}} & 0 \\\\ 0 & \\frac{\\beta_{2}^{2}}{2 \\lambda_{2}} \\end{pmatrix},\n$$\n因为 $\\lambda_{1}, \\lambda_{2} > 0$ 且 $\\beta_{1}, \\beta_{2} \\neq 0$，所以该矩阵是对称正定的。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\beta_{1}^{2}}{2 \\lambda_{1}} & 0 \\\\ 0 & \\frac{\\beta_{2}^{2}}{2 \\lambda_{2}}\\end{pmatrix}}$$", "id": "1565982"}, {"introduction": "与可控性相对应，可观测性 (observability) 是控制理论中的另一个核心概念，它关乎我们能否通过系统输出来反推其内部状态。可观测性格拉姆矩阵 (Observability Gramian) 为我们量化了这种能力，并与最优状态估计的误差协方差直接相关。本练习将引导您计算一个系统的可观测性格拉姆矩阵，并对其进行乔列斯基分解 (Cholesky factorization)，这是一个在信号处理中用于构建白化滤波器 (whitening filter) 的关键步骤。[@problem_id:1565970]", "problem": "在动态系统的状态估计领域，理解系统的可观测性至关重要。对于一个由 $\\dot{x}(t) = Ax(t)$ 描述且输出为 $y(t) = Cx(t)$ 的稳定线性时不变 (LTI) 系统，无穷时域可观测性格拉姆矩阵 $W_o$ 量化了从区间 $[0, \\infty)$ 上的输出测量值 $y(t)$ 推断初始状态 $x(0)$ 的优劣程度。该格拉姆矩阵定义为：\n$$W_o = \\int_0^\\infty e^{A^T t} C^T C e^{At} dt$$\n$x(0)$ 最优估计的误差协方差与 $W_o^{-1}$ 成正比。\n\n信号处理中一种常见的估计算法是“白化”测量信号，这涉及到对数据进行变换，使得噪声分量不相关。这可以通过对可观测性格拉姆矩阵进行 Cholesky 分解来实现，其形式为 $W_o = R^T R$，其中 $R$ 是一个上三角矩阵。矩阵 $R$ 及其逆矩阵随后被用来构造这种白化变换。\n\n考虑一个具有以下状态矩阵和输出矩阵的系统：\n$$A = \\begin{pmatrix} -1 & 1 \\\\ 0 & -2 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$$\n确定 Cholesky 分解 $W_o = R^T R$ 中的上三角矩阵 $R$，其中 $R$ 的对角线元素为正。将答案表示为含有精确符号元素的 2x2 矩阵。", "solution": "该问题要求从无穷时域可观测性格拉姆矩阵 $W_o = \\int_0^\\infty e^{A^T t} C^T C e^{At} dt$ 的 Cholesky 分解 $W_o = R^T R$ 中求得上三角矩阵 $R$。\n\n首先，我们需要计算给定矩阵 $A = \\begin{pmatrix} -1 & 1 \\\\ 0 & -2 \\end{pmatrix}$ 的矩阵指数 $e^{At}$。由于 $A$ 是一个具有不同特征值 $\\lambda_1 = -1$ 和 $\\lambda_2 = -2$ 的上三角矩阵，我们可以使用 2x2 上三角矩阵的矩阵指数公式。对于一个矩阵 $A = \\begin{pmatrix} a & b \\\\ 0 & d \\end{pmatrix}$，当 $a \\neq d$ 时, 其指数为 $e^{At} = \\begin{pmatrix} e^{at} & b\\frac{e^{at}-e^{dt}}{a-d} \\\\ 0 & e^{dt} \\end{pmatrix}$。\n代入 $a=-1$, $b=1$ 和 $d=-2$：\n$$e^{At} = \\begin{pmatrix} e^{-t} & 1 \\cdot \\frac{e^{-t}-e^{-2t}}{-1 - (-2)} \\\\ 0 & e^{-2t} \\end{pmatrix} = \\begin{pmatrix} e^{-t} & e^{-t}-e^{-2t} \\\\ 0 & e^{-2t} \\end{pmatrix}$$\n其转置为 $e^{A^T t} = (e^{At})^T = \\begin{pmatrix} e^{-t} & 0 \\\\ e^{-t}-e^{-2t} & e^{-2t} \\end{pmatrix}$。\n\n接下来，我们构造矩阵 $C^T C$。对于 $C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$：\n$$C^T C = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}$$\n\n现在我们可以构造被积函数 $M(t) = e^{A^T t} C^T C e^{At}$：\n$$M(t) = \\begin{pmatrix} e^{-t} & 0 \\\\ e^{-t}-e^{-2t} & e^{-2t} \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} e^{-t} & e^{-t}-e^{-2t} \\\\ 0 & e^{-2t} \\end{pmatrix}$$\n首先，计算前两个矩阵的乘积：\n$$e^{A^T t} C^T C = \\begin{pmatrix} e^{-t} & 0 \\\\ e^{-t}-e^{-2t} & e^{-2t} \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} e^{-t} & 0 \\\\ e^{-t}-e^{-2t} & 0 \\end{pmatrix}$$\n现在，乘以第三个矩阵：\n$$M(t) = \\begin{pmatrix} e^{-t} & 0 \\\\ e^{-t}-e^{-2t} & 0 \\end{pmatrix} \\begin{pmatrix} e^{-t} & e^{-t}-e^{-2t} \\\\ 0 & e^{-2t} \\end{pmatrix} = \\begin{pmatrix} e^{-2t} & e^{-t}(e^{-t}-e^{-2t}) \\\\ (e^{-t}-e^{-2t})e^{-t} & (e^{-t}-e^{-2t})^2 \\end{pmatrix}$$\n化简 $M(t)$ 中的各项：\n$$M(t) = \\begin{pmatrix} e^{-2t} & e^{-2t}-e^{-3t} \\\\ e^{-2t}-e^{-3t} & e^{-2t} - 2e^{-3t} + e^{-4t} \\end{pmatrix}$$\n\n可观测性格拉姆矩阵 $W_o$ 是 $M(t)$ 从 $0$ 到 $\\infty$ 的积分。我们对矩阵的每个元素进行积分。对于一个稳定系统，当 $k > 0$ 时，$\\int_0^\\infty e^{-kt} dt = \\frac{1}{k}$。\n$$W_{o,11} = \\int_0^\\infty e^{-2t} dt = \\frac{1}{2}$$\n$$W_{o,12} = W_{o,21} = \\int_0^\\infty (e^{-2t}-e^{-3t}) dt = \\frac{1}{2} - \\frac{1}{3} = \\frac{1}{6}$$\n$$W_{o,22} = \\int_0^\\infty (e^{-2t} - 2e^{-3t} + e^{-4t}) dt = \\frac{1}{2} - 2\\left(\\frac{1}{3}\\right) + \\frac{1}{4} = \\frac{6 - 8 + 3}{12} = \\frac{1}{12}$$\n因此，可观测性格拉姆矩阵为：\n$$W_o = \\begin{pmatrix} \\frac{1}{2} & \\frac{1}{6} \\\\ \\frac{1}{6} & \\frac{1}{12} \\end{pmatrix}$$\n\n最后，我们进行 Cholesky 分解 $W_o = R^T R$，其中 $R = \\begin{pmatrix} r_{11} & r_{12} \\\\ 0 & r_{22} \\end{pmatrix}$ 是一个对角线元素为正 ($r_{11}>0, r_{22}>0$) 的上三角矩阵。\n$$R^T R = \\begin{pmatrix} r_{11} & 0 \\\\ r_{12} & r_{22} \\end{pmatrix} \\begin{pmatrix} r_{11} & r_{12} \\\\ 0 & r_{22} \\end{pmatrix} = \\begin{pmatrix} r_{11}^2 & r_{11}r_{12} \\\\ r_{11}r_{12} & r_{12}^2 + r_{22}^2 \\end{pmatrix}$$\n将其与 $W_o$ 的对应元素相等：\n1. $r_{11}^2 = W_{o,11} = \\frac{1}{2} \\implies r_{11} = \\sqrt{\\frac{1}{2}} = \\frac{1}{\\sqrt{2}} = \\frac{\\sqrt{2}}{2}$。\n2. $r_{11}r_{12} = W_{o,12} = \\frac{1}{6} \\implies \\left(\\frac{\\sqrt{2}}{2}\\right)r_{12} = \\frac{1}{6} \\implies r_{12} = \\frac{1}{6} \\frac{2}{\\sqrt{2}} = \\frac{1}{3\\sqrt{2}} = \\frac{\\sqrt{2}}{6}$。\n3. $r_{12}^2 + r_{22}^2 = W_{o,22} = \\frac{1}{12} \\implies r_{22}^2 = \\frac{1}{12} - r_{12}^2 = \\frac{1}{12} - \\left(\\frac{\\sqrt{2}}{6}\\right)^2 = \\frac{1}{12} - \\frac{2}{36} = \\frac{1}{12} - \\frac{1}{18}$。\n为作分数减法，我们通分，公分母为 36：\n$$r_{22}^2 = \\frac{3}{36} - \\frac{2}{36} = \\frac{1}{36}$$\n$$r_{22} = \\sqrt{\\frac{1}{36}} = \\frac{1}{6}$$\n由于 $r_{11} = \\frac{\\sqrt{2}}{2} > 0$ 且 $r_{22} = \\frac{1}{6} > 0$，所以条件得到满足。\n\n最终得到的矩阵 $R$ 是：\n$$R = \\begin{pmatrix} \\frac{\\sqrt{2}}{2} & \\frac{\\sqrt{2}}{6} \\\\ 0 & \\frac{1}{6} \\end{pmatrix}$$", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\sqrt{2}}{2} & \\frac{\\sqrt{2}}{6} \\\\ 0 & \\frac{1}{6} \\end{pmatrix}}$$", "id": "1565970"}, {"introduction": "现实世界中的许多系统通过在不同操作模式之间切换来工作，构成了所谓的切换系统 (switched system)。本练习将探索一个有趣现象：即使每个独立的子系统都不可控，通过巧妙的切换策略，整个系统却可以实现完全可控。您将通过计算驱动系统至目标状态所需的最小控制能量，来亲手构建切换系统的可控性格拉姆矩阵，从而深刻理解组合动态如何产生超越其各组成部分的新特性。[@problem_id:1565956]", "problem": "考虑一个二维切换线性系统，其状态向量为 $x(t) = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}$。该系统的动力学由方程 $\\dot{x}(t) = A_{\\sigma(t)} x(t) + B_{\\sigma(t)} u(t)$ 决定，其中 $u(t)$ 是一个标量控制输入，$\\sigma(t)$ 是一个周期性切换信号。\n\n切换信号 $\\sigma(t)$ 的周期为 $T = 3.0$ 秒，并遵循以下规则：\n- 在时间区间 $[kT, kT + \\tau_1)$ (其中 $k = 0, 1, 2, \\dots$)，系统在模式 1 下运行，因此 $\\sigma(t) = 1$。切换时间为 $\\tau_1 = 1.0$ 秒。\n- 在时间区间 $[kT + \\tau_1, (k+1)T)$，系统在模式 2 下运行，因此 $\\sigma(t) = 2$。\n\n两种模式下的系统矩阵如下：\n模式 1：\n$A_1 = \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix}, \\quad B_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$\n\n模式 2：\n$A_2 = \\begin{pmatrix} 0 & 0 \\\\ 1 & 0 \\end{pmatrix}, \\quad B_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$\n\n在区间 $[0, T]$ 上，与输入 $u(t)$ 相关的控制能量定义为 $E = \\int_0^T u(t)^2 dt$。对于一个在时间 $T$ 从原点 $x(0)=0$ 可达的目标状态 $x_f$，存在一个唯一的控制输入 $u^*(t)$，它在实现这一转移的同时最小化控制能量。该最小能量值记为 $E_{min}$。\n\n计算在一个周期内，即从 $t=0$ 到 $t=T=3.0$ 秒，将系统从初始状态 $x(0) = 0$ 驱动到最终状态 $x_f = \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix}$ 所需的最小控制能量 $E_{min}$。请以实数形式提供您的答案。", "solution": "问题要求解在时间区间 $[0, T]$ 内，将一个切换线性系统从原点驱动到指定最终状态 $x_f$ 所需的最小控制能量。该最小能量由二次型 $E_{min} = x_f^T W_c(0,T)^{-1} x_f$ 给出，其中 $W_c(0,T)$ 是切换系统在区间 $[0,T]$ 上的可控性格拉姆矩阵。\n\n从 $x(0)=0$ 开始，系统在时间 $T$ 的状态由下式给出：\n$$x(T) = \\int_0^T \\Phi(T, s) B_{\\sigma(s)} u(s) ds$$\n其中 $\\Phi(t,s)$ 是切换系统的状态转移矩阵。\n\n切换系统在 $[0, T]$ 上的可控性格拉姆矩阵为：\n$$W_c(0,T) = \\int_0^T \\Phi(T,s) B_{\\sigma(s)} B_{\\sigma(s)}^T \\Phi(T,s)^T ds$$\n\n系统在时间 $\\tau_1$ 发生切换。\n对于 $s \\in [0, \\tau_1)$，$\\sigma(s)=1$，从 $s$ 到 $T$ 的状态转移为 $\\Phi(T,s) = e^{A_2(T-\\tau_1)} e^{A_1(\\tau_1-s)}$。\n对于 $s \\in [\\tau_1, T)$，$\\sigma(s)=2$，从 $s$ 到 $T$ 的状态转移为 $\\Phi(T,s) = e^{A_2(T-s)}$。\n\n在切换时间 $\\tau_1$ 处分解格拉姆矩阵的积分：\n$W_c(0,T) = \\int_0^{\\tau_1} e^{A_2(T-\\tau_1)}e^{A_1(\\tau_1-s)} B_1 B_1^T (e^{A_1(\\tau_1-s)})^T (e^{A_2(T-\\tau_1)})^T ds + \\int_{\\tau_1}^T e^{A_2(T-s)} B_2 B_2^T (e^{A_2(T-s)})^T ds$\n\n令 $\\Phi_2 = e^{A_2(T-\\tau_1)}$。第一项可以写为：\n$\\Phi_2 \\left( \\int_0^{\\tau_1} e^{A_1(\\tau_1-s)} B_1 B_1^T (e^{A_1(\\tau_1-s)})^T ds \\right) \\Phi_2^T$\n括号中的积分是第一个子系统的可控性格拉姆矩阵，$W_{c,1}(0, \\tau_1)$。\n令 $s' = \\tau_1 - s$，则 $ds' = -ds$。该积分变为 $\\int_0^{\\tau_1} e^{A_1 s'} B_1 B_1^T (e^{A_1 s'})^T ds'$。\n\n第二项是第二个子系统在 $[\\tau_1, T]$ 上的可控性格拉姆矩阵，记为 $W_{c,2}(\\tau_1, T)$。\n令 $s' = T-s$，则 $ds' = -ds$。该积分变为 $\\int_0^{T-\\tau_1} e^{A_2 s'} B_2 B_2^T (e^{A_2 s'})^T ds'$。\n\n因此，总的格拉姆矩阵表示为：\n$W_c(0,T) = e^{A_2(T-\\tau_1)} W_{c,1}(0, \\tau_1) (e^{A_2(T-\\tau_1)})^T + W_{c,2}(0, T-\\tau_1)$\n\n现在我们开始计算每个分量。\n持续时间为 $\\Delta t_1 = \\tau_1 = 1.0$ 秒 和 $\\Delta t_2 = T - \\tau_1 = 3.0 - 1.0 = 2.0$ 秒。\n\n**第 1 步：计算各个格拉姆矩阵**\n\n对于子系统 1，其 $A_1 = \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix}$：\n$A_1^2 = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}$，所以 $A_1$ 是幂零矩阵。矩阵指数为 $e^{A_1 t} = I + A_1 t = \\begin{pmatrix} 1 & t \\\\ 0 & 1 \\end{pmatrix}$。\n$B_1 B_1^T = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}$。\n$W_{c,1}$ 的被积函数为：\n$e^{A_1 s} B_1 B_1^T (e^{A_1 s})^T = \\begin{pmatrix} 1 & s \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ s & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}$。\n$W_{c,1}(0, \\Delta t_1) = \\int_0^{\\Delta t_1} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} ds = \\begin{pmatrix} \\Delta t_1 & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}$。\n\n对于子系统 2，其 $A_2 = \\begin{pmatrix} 0 & 0 \\\\ 1 & 0 \\end{pmatrix}$：\n$A_2^2 = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}$，所以 $A_2$ 也是幂零矩阵。矩阵指数为 $e^{A_2 t} = I + A_2 t = \\begin{pmatrix} 1 & 0 \\\\ t & 1 \\end{pmatrix}$。\n$B_2 B_2^T = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 1 \\end{pmatrix}$。\n$W_{c,2}$ 的被积函数为：\n$e^{A_2 s} B_2 B_2^T (e^{A_2 s})^T = \\begin{pmatrix} 1 & 0 \\\\ s & 1 \\end{pmatrix} \\begin{pmatrix} 0 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & s \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 1 \\end{pmatrix}$。\n$W_{c,2}(0, \\Delta t_2) = \\int_0^{\\Delta t_2} \\begin{pmatrix} 0 & 0 \\\\ 0 & 1 \\end{pmatrix} ds = \\begin{pmatrix} 0 & 0 \\\\ 0 & \\Delta t_2 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 2 \\end{pmatrix}$。\n\n**第 2 步：组装总格拉姆矩阵 $W_c(0,T)$**\n\n我们需要矩阵 $e^{A_2 \\Delta t_2}$：\n$e^{A_2 \\Delta t_2} = \\begin{pmatrix} 1 & 0 \\\\ \\Delta t_2 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 2 & 1 \\end{pmatrix}$。\n\n现在，我们计算格拉姆矩阵公式中的第一项：\n$e^{A_2 \\Delta t_2} W_{c,1}(0,\\Delta t_1) (e^{A_2 \\Delta t_2})^T = \\begin{pmatrix} 1 & 0 \\\\ 2 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} 1 & 2 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 2 & 0 \\end{pmatrix} \\begin{pmatrix} 1 & 2 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & 2 \\\\ 2 & 4 \\end{pmatrix}$。\n\n最后，加上第二个格拉姆矩阵分量：\n$W_c(0,T) = \\begin{pmatrix} 1 & 2 \\\\ 2 & 4 \\end{pmatrix} + \\begin{pmatrix} 0 & 0 \\\\ 0 & 2 \\end{pmatrix} = \\begin{pmatrix} 1 & 2 \\\\ 2 & 6 \\end{pmatrix}$。\n\n**第 3 步：计算最小能量**\n\n首先，求格拉姆矩阵 $W_c(0,T)$ 的逆。\n行列式为 $\\det(W_c) = (1)(6) - (2)(2) = 6 - 4 = 2$。\n其逆矩阵为：\n$W_c^{-1} = \\frac{1}{\\det(W_c)} \\begin{pmatrix} 6 & -2 \\\\ -2 & 1 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 6 & -2 \\\\ -2 & 1 \\end{pmatrix} = \\begin{pmatrix} 3 & -1 \\\\ -1 & 0.5 \\end{pmatrix}$。\n\n现在，使用 $E_{min} = x_f^T W_c^{-1} x_f$ 计算最小能量。\n目标状态为 $x_f = \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix}$。\n$E_{min} = \\begin{pmatrix} 2 & 3 \\end{pmatrix} \\begin{pmatrix} 3 & -1 \\\\ -1 & 0.5 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix}$\n$E_{min} = \\begin{pmatrix} 2 & 3 \\end{pmatrix} \\begin{pmatrix} 3(2) - 1(3) \\\\ -1(2) + (0.5)(3) \\end{pmatrix} = \\begin{pmatrix} 2 & 3 \\end{pmatrix} \\begin{pmatrix} 6-3 \\\\ -2+1.5 \\end{pmatrix} = \\begin{pmatrix} 2 & 3 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ -0.5 \\end{pmatrix}$\n$E_{min} = 2(3) + 3(-0.5) = 6 - 1.5 = 4.5$。\n\n所需的最小控制能量为 4.5。", "answer": "$$\\boxed{4.5}$$", "id": "1565956"}]}