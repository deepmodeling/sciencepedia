{"hands_on_practices": [{"introduction": "我们将从一个基础练习开始，这个练习的目标是将一个严格正常的传递函数转换为其可控标准型。这是将传递函数表示转换为状态空间模型最直接的方法之一，可以帮助你巩固基本定义和程序。通过这个练习 [@problem_id:1566302]，你将学会如何从传递函数的系数直接构建状态空间矩阵 $A$、$B$、$C$ 和 $D$。", "problem": "一个线性时不变系统由传递函数 $G(s) = \\frac{Y(s)}{U(s)} = \\frac{s^2 + 4}{s^3 + 5s^2 + 9s + 7}$ 描述。该系统可以用以下形式的状态空间表示来建模：\n$$\n\\dot{\\mathbf{x}} = A\\mathbf{x} + B u\n$$\n$$\ny = C\\mathbf{x} + D u\n$$\n其中 $\\mathbf{x}$ 是状态向量，$u$ 是标量输入，$y$ 是标量输出。\n\n下列哪组矩阵对应于该系统的能控标准型？\n\nA. $A = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -7  -9  -5 \\end{pmatrix}$, $B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$, $C = \\begin{pmatrix} 4  0  1 \\end{pmatrix}$, $D = [0]$\n\nB. $A = \\begin{pmatrix} 0  0  -7 \\\\ 1  0  -9 \\\\ 0  1  -5 \\end{pmatrix}$, $B = \\begin{pmatrix} 4 \\\\ 0 \\\\ 1 \\end{pmatrix}$, $C = \\begin{pmatrix} 0  0  1 \\end{pmatrix}$, $D = [0]$\n\nC. $A = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ 7  9  5 \\end{pmatrix}$, $B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$, $C = \\begin{pmatrix} 4  0  1 \\end{pmatrix}$, $D = [0]$\n\nD. $A = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -7  -9  -5 \\end{pmatrix}$, $B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$, $C = \\begin{pmatrix} 1  0  4 \\end{pmatrix}$, $D = [0]$", "solution": "对于一个单输入单输出、分母为首一多项式的严格真传递函数\n$$\nG(s)=\\frac{b_{2}s^{2}+b_{1}s+b_{0}}{s^{3}+a_{2}s^{2}+a_{1}s+a_{0}},\n$$\n其能控标准型定义为\n$$\nA=\\begin{pmatrix}\n0  1  0 \\\\\n0  0  1 \\\\\n-a_{0}  -a_{1}  -a_{2}\n\\end{pmatrix},\\quad\nB=\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix},\\quad\nC=\\begin{pmatrix} b_{0}  b_{1}  b_{2} \\end{pmatrix},\\quad\nD=[0],\n$$\n因为系统是严格真的，所以 $D=0$。\n\n对于给定的传递函数\n$$\nG(s)=\\frac{s^{2}+4}{s^{3}+5s^{2}+9s+7},\n$$\n分母系数为 $a_{2}=5$，$a_{1}=9$，$a_{0}=7$，分子系数为 $b_{2}=1$，$b_{1}=0$，$b_{0}=4$。\n\n为了验证输入输出映射，计算\n$$\nG(s)=C\\,(sI-A)^{-1}B+D.\n$$\n使用上述友矩阵形式的 $A$ 和 $B$，求解 $(sI-A)v=B$ 以得到 $v=(sI-A)^{-1}B$：\n$$\n\\begin{pmatrix}\ns  -1  0 \\\\\n0  s  -1 \\\\\na_{0}  a_{1}  s+a_{2}\n\\end{pmatrix}\n\\begin{pmatrix} v_{1} \\\\ v_{2} \\\\ v_{3} \\end{pmatrix}\n=\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\n由前两个方程可得，$v_{2}=s v_{1}$ 和 $v_{3}=s^{2} v_{1}$。代入第三个方程得到\n$$\na_{0}v_{1}+a_{1}(s v_{1})+(s+a_{2})(s^{2}v_{1})=1\n\\;\\Rightarrow\\;\nv_{1}=\\frac{1}{s^{3}+a_{2}s^{2}+a_{1}s+a_{0}},\n$$\n因此\n$$\nv=\\frac{1}{s^{3}+a_{2}s^{2}+a_{1}s+a_{0}}\\begin{pmatrix} 1 \\\\ s \\\\ s^{2} \\end{pmatrix}.\n$$\n所以，\n$$\nG(s)=C v = \\frac{b_{0}+b_{1}s+b_{2}s^{2}}{s^{3}+a_{2}s^{2}+a_{1}s+a_{0}}.\n$$\n与给定的 $G(s)=\\frac{s^{2}+4}{s^{3}+5s^{2}+9s+7}$ 进行匹配，可得 $b_{2}=1$, $b_{1}=0$, $b_{0}=4$，因此\n$$\nA=\\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -7  -9  -5 \\end{pmatrix},\\quad\nB=\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix},\\quad\nC=\\begin{pmatrix} 4  0  1 \\end{pmatrix},\\quad\nD=[0],\n$$\n这对应于选项A。其他选项要么 $A$ 矩阵的符号不正确（C），要么表示的是能观标准型（B），要么 $C$ 矩阵中分子系数的顺序不正确（D）。", "answer": "$$\\boxed{A}$$", "id": "1566302"}, {"introduction": "在实际应用中，传递函数很少以理想的“教科书”形式出现。这个练习 [@problem_id:1566249] 引入了两种在转换过程中常见的复杂情况：处理具有非零前馈项 $D$ 的正常（但非严格正常）传递函数，以及在应用标准型公式前对分母进行归一化的必要性。掌握这些步骤对于将状态空间方法应用于更广泛的实际系统至关重要。", "problem": "一个工业伺服机构被建模为线性时不变（LTI）系统。其动态特性描述了输入控制信号 $u(t)$ 与输出角位置 $y(t)$ 之间的关系，可由以下拉普拉斯域中的传递函数表示：\n$$G(s) = \\frac{4s^3 + 2s^2 - 4s + 10}{2s^3 + 4s^2 - 6s - 8}$$\n为了实现数字控制器，该系统必须转换为以下形式的状态空间模型：\n$$\\dot{\\mathbf{x}} = A\\mathbf{x} + B u$$\n$$y = C\\mathbf{x} + D u$$\n其中矩阵 $(A, B, C, D)$ 以能控标准型表示该系统。在推导出这些矩阵后，请按以下顺序构造一个行向量，其中包含特定元素：$[A_{31}, A_{32}, A_{33}, C_{11}, C_{12}, C_{13}, D]$。这个得到的向量是什么？", "solution": "本题的任务是，根据给定的传递函数 $G(s)$，求出其能控标准型状态空间矩阵 $(A, B, C, D)$ 中的一组特定元素。\n\n首先，我们分析该传递函数：\n$$G(s) = \\frac{4s^3 + 2s^2 - 4s + 10}{2s^3 + 4s^2 - 6s - 8}$$\n分子多项式的阶数等于分母多项式的阶数（均为3）。这意味着该传递函数是真传递函数，但不是严格真传递函数。因此，会存在一个非零的直接馈通项 $D$。\n\n$D$ 的值可以通过求 $G(s)$ 在 $s \\to \\infty$ 时的极限得到。这等价于分子和分母最高次项系数之比。\n$$D = \\lim_{s \\to \\infty} G(s) = \\lim_{s \\to \\infty} \\frac{4s^3 + 2s^2 - 4s + 10}{2s^3 + 4s^2 - 6s - 8} = \\frac{4}{2} = 2$$\n\n状态空间表示是根据传递函数的严格真部分 $G_{sp}(s)$ 构建的，其中 $G(s) = G_{sp}(s) + D$。我们通过从 $G(s)$ 中减去 $D$ 来求得 $G_{sp}(s)$：\n$$G_{sp}(s) = G(s) - D = \\frac{4s^3 + 2s^2 - 4s + 10}{2s^3 + 4s^2 - 6s - 8} - 2$$\n为了进行减法，我们将各项通分：\n$$G_{sp}(s) = \\frac{(4s^3 + 2s^2 - 4s + 10) - 2(2s^3 + 4s^2 - 6s - 8)}{2s^3 + 4s^2 - 6s - 8}$$\n$$G_{sp}(s) = \\frac{4s^3 + 2s^2 - 4s + 10 - 4s^3 - 8s^2 + 12s + 16}{2s^3 + 4s^2 - 6s - 8}$$\n合并分子中的同类项得到：\n$$G_{sp}(s) = \\frac{-6s^2 + 8s + 26}{2s^3 + 4s^2 - 6s - 8}$$\n\n为了得到能控标准型，严格真传递函数的分母必须是首一的（即其最高次项系数必须为1）。分母的最高次项系数是2，所以我们将分子和分母同时除以2：\n$$G_{sp}(s) = \\frac{\\frac{1}{2}(-6s^2 + 8s + 26)}{\\frac{1}{2}(2s^3 + 4s^2 - 6s - 8)} = \\frac{-3s^2 + 4s + 13}{s^3 + 2s^2 - 3s - 4}$$\n现在，传递函数处于一个 $n=3$ 系统的标准形式：\n$$G_{sp}(s) = \\frac{b_2 s^2 + b_1 s + b_0}{s^3 + a_2 s^2 + a_1 s + a_0}$$\n通过比较系数，我们确定：\n$b_2 = -3$, $b_1 = 4$, $b_0 = 13$\n$a_2 = 2$, $a_1 = -3$, $a_0 = -4$\n\n对于一个三阶系统，其能控标准型矩阵 $(A, B, C)$ 由以下公式给出：\n$$A = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -a_0  -a_1  -a_2 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} b_0  b_1  b_2 \\end{pmatrix}$$\n代入已确定的系数：\n$$A = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -(-4)  -(-3)  -(2) \\end{pmatrix} = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ 4  3  -2 \\end{pmatrix}$$\n$$B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$$\n$$C = \\begin{pmatrix} 13  4  -3 \\end{pmatrix}$$\n并且我们已经求得 $D = 2$。\n\n题目要求构造一个由特定元素组成的行向量：$[A_{31}, A_{32}, A_{33}, C_{11}, C_{12}, C_{13}, D]$。\n从矩阵 $A$ 中得到：\n$A_{31} = 4$\n$A_{32} = 3$\n$A_{33} = -2$\n\n从矩阵 $C$ 中得到：\n$C_{11} = 13$\n$C_{12} = 4$\n$C_{13} = -3$\n\n标量 $D$ 为 $2$。\n\n构造最终的向量：\n$$[A_{31}, A_{32}, A_{33}, C_{11}, C_{12}, C_{13}, D] = [4, 3, -2, 13, 4, -3, 2]$$\n我们将其表示为一个行矩阵。", "answer": "$$\n\\boxed{\\begin{pmatrix} 4  3  -2  13  4  -3  2 \\end{pmatrix}}\n$$", "id": "1566249"}, {"introduction": "仅仅机械地套用公式并不总是能得到最优的系统模型。这个练习 [@problem_id:1566256] 探讨了“最小实现”这一关键概念，当传递函数的分子和分母存在公因式时（即极零点对消），就需要考虑这个问题。理解最小实现是构建一个既完全可控又完全可观测的状态空间模型的关键，它能准确地反映系统的真实动态特性。", "problem": "一个单输入、单输出的线性时不变 (LTI) 系统由传递函数 $G(s) = \\frac{Y(s)}{U(s)}$ 描述，其中 $U(s)$ 是输入信号 $u(t)$ 的拉普拉斯变换，$Y(s)$ 是输出信号 $y(t)$ 的拉普拉斯变换。该传递函数为：\n$$G(s) = \\frac{s+a}{s^3 + (a+b)s^2 + (ab+c)s + ac}$$\n这里，$a$，$b$ 和 $c$ 是互不相同的正常数。\n\n系统的状态空间表示由以下方程给出：\n$$ \\dot{\\mathbf{x}}(t) = \\mathbf{A x}(t) + \\mathbf{B} u(t) $$\n$$ y(t) = \\mathbf{C x}(t) + \\mathbf{D} u(t) $$\n\n确定该系统在可控标准型下的最小实现。最小实现是既完全可控又完全可观的状态空间模型。根据得到的状态空间矩阵 $(\\mathbf{A}, \\mathbf{B}, \\mathbf{C}, \\mathbf{D})$，计算表达式 $\\mathbf{C} \\mathbf{A}^2 \\mathbf{B}$ 的标量值。", "solution": "我们已知传递函数\n$$G(s) = \\frac{s+a}{s^{3} + (a+b)s^{2} + (ab+c)s + ac}.$$\n首先，判断是否存在极点-零点对消。计算分母在 $s=-a$ 处的值：\n$$(-a)^{3} + (a+b)(-a)^{2} + (ab+c)(-a) + ac = -a^{3} + (a+b)a^{2} - a(ab+c) + ac.$$\n化简得，\n$$-a^{3} + a^{3} + ba^{2} - a^{2}b - ac + ac = 0.$$\n因此，$s=-a$ 是分母的一个根，所以 $(s+a)$ 是一个因式。实际上，\n$$(s+a)(s^{2} + b s + c) = s^{3} + (a+b)s^{2} + (ab+c)s + ac.$$\n因此，在对消公因式 $(s+a)$ 后的最小传递函数是\n$$G_{\\min}(s) = \\frac{1}{s^{2} + b s + c},$$\n这是一个二阶的严格真分式。\n\n对于分母为首一多项式 $s^{2} + b s + c$ 且分子为 $1$ (即 $0 \\cdot s + 1$) 的二阶传递函数，其可控标准型实现为\n$$\\mathbf{A} = \\begin{pmatrix} 0  1 \\\\ -c  -b \\end{pmatrix}, \\quad \\mathbf{B} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad \\mathbf{C} = \\begin{pmatrix} 1  0 \\end{pmatrix}, \\quad \\mathbf{D} = 0.$$\n验证传递函数：\n$$(s\\mathbf{I} - \\mathbf{A}) = \\begin{pmatrix} s  -1 \\\\ c  s + b \\end{pmatrix}, \\quad \\det(s\\mathbf{I} - \\mathbf{A}) = s^{2} + b s + c,$$\n$$(s\\mathbf{I} - \\mathbf{A})^{-1} = \\frac{1}{s^{2} + b s + c} \\begin{pmatrix} s + b  1 \\\\ -c  s \\end{pmatrix}, \\quad (s\\mathbf{I} - \\mathbf{A})^{-1}\\mathbf{B} = \\frac{1}{s^{2} + b s + c} \\begin{pmatrix} 1 \\\\ s \\end{pmatrix}.$$\n因此，\n$$G_{\\min}(s) = \\mathbf{C}(s\\mathbf{I} - \\mathbf{A})^{-1}\\mathbf{B} + \\mathbf{D} = \\begin{pmatrix} 1  0 \\end{pmatrix} \\frac{1}{s^{2} + b s + c} \\begin{pmatrix} 1 \\\\ s \\end{pmatrix} = \\frac{1}{s^{2} + b s + c}.$$\n可控性和可观性：\n$$\\mathcal{C} = \\begin{pmatrix} \\mathbf{B}  \\mathbf{A}\\mathbf{B} \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ 1  -b \\end{pmatrix}, \\quad \\det(\\mathcal{C}) = -1 \\neq 0,$$\n$$\\mathcal{O} = \\begin{pmatrix} \\mathbf{C} \\\\ \\mathbf{C}\\mathbf{A} \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix},$$\n两者均为满秩，因此该实现是最小的。\n\n现在计算 $\\mathbf{C}\\mathbf{A}^{2}\\mathbf{B}$。首先，\n$$\\mathbf{A}\\mathbf{B} = \\begin{pmatrix} 0  1 \\\\ -c  -b \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -b \\end{pmatrix}.$$\n然后，\n$$\\mathbf{A}^{2}\\mathbf{B} = \\mathbf{A}(\\mathbf{A}\\mathbf{B}) = \\begin{pmatrix} 0  1 \\\\ -c  -b \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -b \\end{pmatrix} = \\begin{pmatrix} -b \\\\ -c + b^{2} \\end{pmatrix}.$$\n最后，\n$$\\mathbf{C}\\mathbf{A}^{2}\\mathbf{B} = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} -b \\\\ -c + b^{2} \\end{pmatrix} = -b.$$\n因此，所求的标量值为 $-b$。", "answer": "$$\\boxed{-b}$$", "id": "1566256"}]}