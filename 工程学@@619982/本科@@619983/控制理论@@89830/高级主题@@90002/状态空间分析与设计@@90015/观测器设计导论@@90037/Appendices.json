{"hands_on_practices": [{"introduction": "在设计观测器之前，我们必须首先确保系统是‘可观测的’。这个练习 [@problem_id:1584834] 挑战你根据不同的传感器配置来判断一个系统的可观测性，从而突显出物理设计选择如何直接影响我们估计系统内部状态的能力。", "problem": "一个工程团队正在为一个由柔性绳索连接的双体卫星系统的简化一维模型开发状态反馈控制器。该系统由两个质量分别为$m_1$和$m_2$的质点组成，它们由一个弹簧系数为$k$的弹簧连接。一个外力$u(t)$可以施加在质点$m_1$上。为方便建模，将质量和弹簧系数归一化，使得$m_1=1$，$m_2=1$且$k=1$。阻尼被认为可以忽略不计。\n\n系统的状态由向量$\\mathbf{x} = [p_1, v_1, p_2, v_2]^T$描述，其中$p_1$和$v_1$是第一个质点的位置和速度，$p_2$和$v_2$是第二个质点的位置和速度。线性化动力学由状态空间方程$\\dot{\\mathbf{x}} = A\\mathbf{x} + B u$给出，其中系统矩阵$A$为：\n$$\nA = \\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n-1 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n1 & 0 & -1 & 0\n\\end{pmatrix}\n$$\n\n为了实现一个状态估计器（观测器），团队必须能够从可用的测量值中重构完整的状态向量$\\mathbf{x}$。提出了两种不同的传感器配置，从而得到两种不同的输出方程$y = C\\mathbf{x}$。\n\n**配置 1**：一个传感器直接测量第一个质点的绝对位置$p_1$。相应的输出矩阵为：\n$$\nC_1 = \\begin{pmatrix} 1 & 0 & 0 & 0 \\end{pmatrix}\n$$\n\n**配置 2**：一个不同的传感器测量两个质点之间的相对位移$p_1 - p_2$。相应的输出矩阵为：\n$$\nC_2 = \\begin{pmatrix} 1 & 0 & -1 & 0 \\end{pmatrix}\n$$\n\n您的任务是确定哪种配置能构成一个可观测系统。\n\nA) 只有配置1是可观测的。\n\nB) 只有配置2是可观测的。\n\nC) 两种配置都是可观测的。\n\nD) 两种配置都不可观测。", "solution": "对于具有状态矩阵$A$和输出矩阵$C$的线性时不变系统，该系统是可观测的，当且仅当可观测性矩阵\n$$\n\\mathcal{O} = \\begin{pmatrix}\nC \\\\\nCA \\\\\nCA^{2} \\\\\nCA^{3}\n\\end{pmatrix}\n$$\n的秩等于状态维数，这里是$4$。\n\n给定\n$$\nA = \\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n-1 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n1 & 0 & -1 & 0\n\\end{pmatrix},\n$$\n我们测试每一种配置。\n\n配置 1：$C_{1} = \\begin{pmatrix} 1 & 0 & 0 & 0 \\end{pmatrix}$。\n\n计算连续的乘积：\n$$\nC_{1}A = \\begin{pmatrix} 0 & 1 & 0 & 0 \\end{pmatrix},\n$$\n$$\nC_{1}A^{2} = (C_{1}A)A = \\begin{pmatrix} -1 & 0 & 1 & 0 \\end{pmatrix},\n$$\n$$\nC_{1}A^{3} = (C_{1}A^{2})A = \\begin{pmatrix} 0 & -1 & 0 & 1 \\end{pmatrix}.\n$$\n因此\n$$\n\\mathcal{O}_{1} = \\begin{pmatrix}\n1 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & 0 \\\\\n-1 & 0 & 1 & 0 \\\\\n0 & -1 & 0 & 1\n\\end{pmatrix}.\n$$\n$\\mathcal{O}_{1}$的列向量是\n$$\n\\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\\\ 0 \\end{pmatrix},\\quad\n\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ -1 \\end{pmatrix},\\quad\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\end{pmatrix},\\quad\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix},\n$$\n它们是线性无关的。因此$\\operatorname{rank}(\\mathcal{O}_{1}) = 4$，所以配置1是可观测的。\n\n配置 2：$C_{2} = \\begin{pmatrix} 1 & 0 & -1 & 0 \\end{pmatrix}$。\n\n计算连续的乘积：\n$$\nC_{2}A = \\begin{pmatrix} 0 & 1 & 0 & -1 \\end{pmatrix},\n$$\n$$\nC_{2}A^{2} = (C_{2}A)A = \\begin{pmatrix} -2 & 0 & 2 & 0 \\end{pmatrix} = -2 C_{2},\n$$\n$$\nC_{2}A^{3} = (C_{2}A^{2})A = -2(C_{2}A) = \\begin{pmatrix} 0 & -2 & 0 & 2 \\end{pmatrix}.\n$$\n因此\n$$\n\\mathcal{O}_{2} = \\begin{pmatrix}\n1 & 0 & -1 & 0 \\\\\n0 & 1 & 0 & -1 \\\\\n-2 & 0 & 2 & 0 \\\\\n0 & -2 & 0 & 2\n\\end{pmatrix},\n$$\n其中第三行等于第一行的$-2$倍，第四行等于第二行的$-2$倍。因此$\\operatorname{rank}(\\mathcal{O}_{2}) = 2 < 4$，配置2不是可观测的。\n\n所以，只有配置1是可观测的。", "answer": "$$\\boxed{A}$$", "id": "1584834"}, {"introduction": "一旦确认系统是可观测的，我们就可以设计一个观测器来估计其状态。这个练习 [@problem_id:1584819] 将引导你完成观测器设计的核心过程：通过计算观测器增益 $L$ 将观测器误差动态的极点配置在期望的位置。这种被称为极点配置的技术，使我们能够精确控制状态估计值收敛到真实状态的速度。", "problem": "考虑一个由以下状态空间模型描述的二阶线性时不变（LTI）系统：\n$$\n\\begin{aligned}\n\\dot{\\mathbf{x}}(t) &= A \\mathbf{x}(t) + B \\mathbf{u}(t) \\\\\ny(t) &= C \\mathbf{x}(t)\n\\end{aligned}\n$$\n其中状态向量为 $\\mathbf{x}(t) = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}$，矩阵由下式给出：\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ -a_0 & -a_1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}\n$$\n此处，$a_0$ 和 $a_1$ 是实值系统参数。输入矩阵 $B$ 和输入向量 $\\mathbf{u}(t)$ 与本问题无关。\n\n为该系统设计了一个全状态 Luenberger 观测器。估计状态向量 $\\hat{\\mathbf{x}}(t)$ 的动态由以下方程决定：\n$$\n\\dot{\\hat{\\mathbf{x}}}(t) = A \\hat{\\mathbf{x}}(t) + B \\mathbf{u}(t) + L(y(t) - C\\hat{\\mathbf{x}}(t))\n$$\n观测器增益是一个列向量 $L = \\begin{pmatrix} l_1 \\\\ l_2 \\end{pmatrix}$。决定观测器估计误差 $\\mathbf{e}(t) = \\mathbf{x}(t) - \\hat{\\mathbf{x}}(t)$ 的矩阵，其特征多项式期望为：\n$$\np_{des}(s) = s^2 + \\alpha_1 s + \\alpha_0\n$$\n其中 $\\alpha_1 > 0$ 和 $\\alpha_0 > 0$ 是决定观测器期望的稳定动态的系数。\n\n请确定观测器增益 $l_1$ 和 $l_2$ 关于系统参数（$a_0, a_1$）和期望特征多项式系数（$\\alpha_0, \\alpha_1$）的表达式。您的最终答案应按顺序给出 $l_1$ 和 $l_2$ 的表达式。", "solution": "将估计误差定义为 $\\mathbf{e}(t)=\\mathbf{x}(t)-\\hat{\\mathbf{x}}(t)$。使用系统和观测器的动态方程，\n$$\n\\dot{\\mathbf{e}}(t)=\\dot{\\mathbf{x}}(t)-\\dot{\\hat{\\mathbf{x}}}(t)=\\left(A\\mathbf{x}(t)+B\\mathbf{u}(t)\\right)-\\left(A\\hat{\\mathbf{x}}(t)+B\\mathbf{u}(t)+L\\left(y(t)-C\\hat{\\mathbf{x}}(t)\\right)\\right).\n$$\n由于 $y(t)=C\\mathbf{x}(t)$，上式可简化为\n$$\n\\dot{\\mathbf{e}}(t)=A\\left(\\mathbf{x}(t)-\\hat{\\mathbf{x}}(t)\\right)-L\\left(C\\mathbf{x}(t)-C\\hat{\\mathbf{x}}(t)\\right)=(A-LC)\\mathbf{e}(t).\n$$\n已知 $A=\\begin{pmatrix}0&1\\\\-a_{0}&-a_{1}\\end{pmatrix}$，$C=\\begin{pmatrix}1&0\\end{pmatrix}$ 以及 $L=\\begin{pmatrix}l_{1}\\\\ l_{2}\\end{pmatrix}$，我们有\n$$\nLC=\\begin{pmatrix}l_{1}\\\\ l_{2}\\end{pmatrix}\\begin{pmatrix}1&0\\end{pmatrix}=\\begin{pmatrix}l_{1}&0\\\\ l_{2}&0\\end{pmatrix},\n\\quad\nA-LC=\\begin{pmatrix}-l_{1}&1\\\\-a_{0}-l_{2}&-a_{1}\\end{pmatrix}.\n$$\n一个 $2\\times 2$ 矩阵 $M$ 的特征多项式为 $s^{2}-(\\operatorname{tr}M)s+\\det M$。因此，对于 $A-LC$ 而言，\n$$\np(s)=s^{2}-\\left(\\operatorname{tr}(A-LC)\\right)s+\\det(A-LC).\n$$\n计算其迹和行列式：\n$$\n\\operatorname{tr}(A-LC)=-l_{1}-a_{1},\\qquad\n\\det(A-LC)=(-l_{1})(-a_{1})-1\\cdot(-a_{0}-l_{2})=l_{1}a_{1}+a_{0}+l_{2}.\n$$\n我们需要 $p(s)=p_{des}(s)=s^{2}+\\alpha_{1}s+\\alpha_{0}$，因此通过系数匹配可得\n$$\n-\\operatorname{tr}(A-LC)=\\alpha_{1}\\;\\Rightarrow\\;-(-l_{1}-a_{1})=\\alpha_{1}\\;\\Rightarrow\\;l_{1}=\\alpha_{1}-a_{1},\n$$\n$$\n\\det(A-LC)=\\alpha_{0}\\;\\Rightarrow\\;l_{1}a_{1}+a_{0}+l_{2}=\\alpha_{0}\\;\\Rightarrow\\;l_{2}=\\alpha_{0}-a_{0}-l_{1}a_{1}.\n$$\n将 $l_{1}=\\alpha_{1}-a_{1}$ 代入 $l_{2}$ 的表达式中可得\n$$\nl_{2}=\\alpha_{0}-a_{0}-a_{1}(\\alpha_{1}-a_{1})=\\alpha_{0}-a_{0}-a_{1}\\alpha_{1}+a_{1}^{2}.\n$$\n因此，将估计误差动态配置在 $p_{des}(s)=s^{2}+\\alpha_{1}s+\\alpha_{0}$ 处的观测器增益为 $l_{1}=\\alpha_{1}-a_{1}$ 和 $l_{2}=\\alpha_{0}-a_{0}-a_{1}\\alpha_{1}+a_{1}^{2}$。", "answer": "$$\\boxed{\\begin{pmatrix}\\alpha_{1}-a_{1} & \\alpha_{0}-a_{0}-a_{1}\\alpha_{1}+a_{1}^{2}\\end{pmatrix}}$$", "id": "1584819"}, {"introduction": "为了真正掌握可观测性的概念，理解系统‘不可观测’意味着什么也同样重要。这个练习 [@problem_id:1584790] 要求你找到一个对系统输出而言‘不可见’的初始状态。通过识别不可观测子空间中的状态，你将对观测的局限性以及可观测性测试为何如此关键，有一个更深刻、更直观的理解。", "problem": "考虑一个线性时不变 (LTI) 系统，其演化由状态空间方程 $\\dot{x}(t) = Ax(t)$ 和 $y(t) = Cx(t)$ 描述，其中系统在没有任何外部输入的情况下运行。状态向量为 $x(t) \\in \\mathbb{R}^3$，输出为标量 $y(t) \\in \\mathbb{R}$。相应的系统矩阵如下所示：\n$$\nA = \\begin{bmatrix} 1 & -3 & 1 \\\\ 2 & 0 & -3 \\\\ -1 & 2 & -2 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1 & -1 & 0 \\end{bmatrix}\n$$\n可以选择一个非零初始状态 $x(0)$，使得系统的输出始终为零，即对于所有 $t \\ge 0$，$y(t) \\equiv 0$。找到满足此条件的唯一非零初始状态向量 $x(0)$，并附加约束条件为其第一个分量为 $x_1(0) = 5$。请将您的答案表示为一个 $3 \\times 1$ 的列向量。", "solution": "对于零输入 LTI 系统 $\\dot{x}(t)=Ax(t)$ 和 $y(t)=Cx(t)$，其状态和输出分别为 $x(t)=\\exp(At)x(0)$ 和 $y(t)=C\\exp(At)x(0)$。为了使对于所有 $t\\ge 0$ 都有 $y(t)\\equiv 0$，在 $t=0$ 时的所有时间导数都必须为零：\n$$\ny^{(k)}(0)=CA^{k}x(0)=0 \\quad \\text{对于所有 } k\\ge 0.\n$$\n根据 Cayley-Hamilton 定理，在 $\\mathbb{R}^{3}$ 中，只需对 $k=0,1,2$ 强制此条件即可。因此，$x(0)$ 必须位于可观测性矩阵的零空间中\n$$\n\\mathcal{O}=\\begin{bmatrix} C \\\\ CA \\\\ CA^{2} \\end{bmatrix}.\n$$\n已知 $C=\\begin{bmatrix}1 & -1 & 0\\end{bmatrix}$ 和 $A=\\begin{bmatrix} 1 & -3 & 1 \\\\ 2 & 0 & -3 \\\\ -1 & 2 & -2 \\end{bmatrix}$，计算\n$$\nCA=\\begin{bmatrix}1 & -1 & 0\\end{bmatrix}A\n=\\begin{bmatrix}\n1\\cdot 1+(-1)\\cdot 2+0\\cdot(-1),\\;\n1\\cdot(-3)+(-1)\\cdot 0+0\\cdot 2,\\;\n1\\cdot 1+(-1)\\cdot(-3)+0\\cdot(-2)\n\\end{bmatrix}\n=\\begin{bmatrix}-1 & -3 & 4\\end{bmatrix}.\n$$\n然后\n$$\nCA^{2}=(CA)A=\\begin{bmatrix}-1 & -3 & 4\\end{bmatrix}A\n=\\begin{bmatrix}\n(-1)\\cdot 1+(-3)\\cdot 2+4\\cdot(-1),\\;\n(-1)\\cdot(-3)+(-3)\\cdot 0+4\\cdot 2,\\;\n(-1)\\cdot 1+(-3)\\cdot(-3)+4\\cdot(-2)\n\\end{bmatrix}\n=\\begin{bmatrix}-11 & 11 & 0\\end{bmatrix}.\n$$\n因此\n$$\n\\mathcal{O}=\\begin{bmatrix}\n1 & -1 & 0\\\\\n-1 & -3 & 4\\\\\n-11 & 11 & 0\n\\end{bmatrix}.\n$$\n设 $x(0)=\\begin{bmatrix}x_{1} \\\\ x_{2} \\\\ x_{3}\\end{bmatrix}$。求解 $\\mathcal{O}x(0)=0$ 时，由第一行可得 $x_{1}-x_{2}=0$，因此 $x_{1}=x_{2}$。第二行得出 $-x_{1}-3x_{2}+4x_{3}=0$，代入 $x_{1}=x_{2}$ 得 $-4x_{1}+4x_{3}=0$，因此 $x_{3}=x_{1}$。第三行与 $x_{1}=x_{2}$ 一致。因此，零空间由 $\\begin{bmatrix}1 \\\\ 1 \\\\ 1\\end{bmatrix}$ 张成，且满足 $x_{1}(0)=5$ 的唯一非零初始状态为\n$$\nx(0)=5\\begin{bmatrix}1 \\\\ 1 \\\\ 1\\end{bmatrix}=\\begin{bmatrix}5 \\\\ 5 \\\\ 5\\end{bmatrix}.\n$$\n此 $x(0)$ 满足对于 $k=0,1,2$ 有 $CA^{k}x(0)=0$，并且根据 Cayley-Hamilton 定理，可推断出对于所有 $k\\ge 0$ 都有 $CA^{k}x(0)=0$，因此对于所有 $t\\ge 0$ 都有 $y(t)\\equiv 0$。", "answer": "$$\\boxed{\\begin{pmatrix}5 \\\\ 5 \\\\ 5\\end{pmatrix}}$$", "id": "1584790"}]}