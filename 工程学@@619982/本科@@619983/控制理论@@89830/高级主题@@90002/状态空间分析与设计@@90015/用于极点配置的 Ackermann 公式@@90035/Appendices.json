{"hands_on_practices": [{"introduction": "在我们深入改变系统动态之前，让我们先从一个关键的思想实验开始。如果我们的目标是将闭环极点精确地设置在开环极点原来的位置上，会发生什么呢？这个练习 [@problem_id:1556685] 探讨了这一基本情景，揭示了阿克曼公式与凯莱-哈密顿定理之间的优美联系。通过解决这个问题，你将理解为什么该公式会直观地计算出一个零增益矩阵，从而为你理解反馈控制的意义奠定坚实的概念基础。", "problem": "考虑一个由状态空间表达式 $\\dot{x}(t) = Ax(t) + Bu(t)$ 描述的一般的 $n$ 阶、能控的线性时不变 (LTI)、单输入单输出 (SISO) 系统，其中 $x \\in \\mathbb{R}^{n}$ 是状态向量，$u \\in \\mathbb{R}$ 是控制输入，$A$ 是 $n \\times n$ 的状态矩阵，$B$ 是 $n \\times 1$ 的输入矩阵。系统的开环极点是矩阵 $A$ 的特征值，它们是开环特征多项式 $\\alpha(s) = \\det(sI-A)$ 的根。\n\n应用一个形式为 $u(t) = -Kx(t)$ 的状态反馈控制律，其中 $K$ 是一个 $1 \\times n$ 的反馈增益行向量。该控制律的目标是将闭环系统的极点（由矩阵 $(A - BK)$ 的特征值给出）配置到期望的位置。期望的极点位置由期望特征多项式 $\\alpha_d(s)$ 的根指定。\n\n阿克曼公式提供了一种计算增益矩阵 $K$ 以实现期望极点配置的方法。该公式由下式给出：\n$$K = \\begin{pmatrix} 0 & 0 & \\dots & 1 \\end{pmatrix} \\mathcal{C}^{-1} \\alpha_d(A)$$\n其中 $\\mathcal{C}$ 是系统对 $(A, B)$ 的 $n \\times n$ 能控性矩阵，$\\alpha_d(A)$ 是将期望特征多项式 $\\alpha_d(s)$ 中的标量变量 $s$ 替换为矩阵 $A$ 所得到的矩阵多项式。\n\n假设一位控制设计者出于分析目的，决定选择期望的闭环极点与系统原始的开环极点完全相同。在这种特定情况下，阿克曼公式计算出的状态反馈增益矩阵 $K$ 是什么？请用一个对任何此类 $n$ 阶系统都有效的一般矩阵表达式来表示你的答案。", "solution": "给定一个 $n$ 阶能控 LTI SISO 系统 $\\dot{x}(t) = Ax(t) + Bu(t)$ 和状态反馈律 $u(t) = -Kx(t)$, 以及阿克曼公式\n$$\nK = \\begin{pmatrix}0 & 0 & \\dots & 1\\end{pmatrix} \\mathcal{C}^{-1} \\alpha_{d}(A),\n$$\n其中 $\\mathcal{C}$ 是 $(A,B)$ 的能控性矩阵，$\\alpha_{d}(s)$ 是期望的特征多项式。\n\n令选择的期望闭环多项式等于开环特征多项式：\n$$\n\\alpha_{d}(s) = \\alpha(s) = \\det(sI - A).\n$$\n根据凯莱-哈密顿定理，矩阵 $A$ 满足其自身的特征多项式：\n$$\n\\alpha(A) = 0_{n \\times n}.\n$$\n因此，将 $\\alpha_{d}(A) = \\alpha(A)$ 代入阿克曼公式得到\n$$\nK = \\begin{pmatrix}0 & 0 & \\dots & 1\\end{pmatrix} \\mathcal{C}^{-1} \\alpha(A) = \\begin{pmatrix}0 & 0 & \\dots & 1\\end{pmatrix} \\mathcal{C}^{-1} 0_{n \\times n} = 0_{1 \\times n}.\n$$\n因此，在这种情况下，阿克曼公式返回的增益是零行向量，这使得闭环矩阵 $A - BK$ 等于 $A$，从而按要求将极点配置在了原始的开环位置。", "answer": "$$\\boxed{0_{1 \\times n}}$$", "id": "1556685"}, {"introduction": "现在，我们来解决一个控制工程中的核心经典挑战：镇定一个固有不稳定的系统。这个练习 [@problem_id:1556708] 以一个简化的磁悬浮装置模型为例，指导你应用阿克曼公式来计算状态反馈增益 $K$。你的任务是将系统极点从不稳定的位置移动到期望的稳定位置，这是任何控制工程师都必须掌握的基石技能。", "problem": "考虑一个不稳定系统的简化模型，例如磁悬浮物体的垂直控制。其在不稳定平衡点附近的线性化动力学由状态空间方程 $\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t) + B u(t)$ 描述。状态向量定义为 $\\mathbf{x}(t) = \\begin{pmatrix} z(t) \\\\ \\dot{z}(t) \\end{pmatrix}$，其中 $z(t)$ 表示与平衡位置的垂直位移，$\\dot{z}(t)$ 是对应的速度。控制输入 $u(t)$ 与供给电磁铁的电流成正比。\n\n系统矩阵由下式给出：\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ \\omega_0^2 & 0 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n其中 $\\omega_0$ 是一个正常数，代表不稳定开环系统的自然频率。\n\n将要实现一个形式为 $u(t) = -K\\mathbf{x}(t)$ 的状态反馈控制律，其中 $K = \\begin{pmatrix} k_1 & k_2 \\end{pmatrix}$ 是一个常数状态反馈增益矩阵。该控制器的目标是通过将闭环极点移动到期望位置来稳定系统。\n\n您的任务是将闭环极点配置在 $s = -p_1$ 和 $s = -p_2$ 处，其中 $p_1$ 和 $p_2$ 是不相等的正常数。使用阿克曼公式，求出实现此极点配置所需的状态反馈增益矩阵 $K$。请用 $\\omega_0$、$p_1$ 和 $p_2$ 表示您的答案。", "solution": "给定线性时不变系统 $\\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B u(t)$，其中 $A = \\begin{pmatrix} 0 & 1 \\\\ \\omega_{0}^{2} & 0 \\end{pmatrix}$ 且 $B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$，我们应用状态反馈 $u(t) = -K \\mathbf{x}(t)$，其中 $K = \\begin{pmatrix} k_{1} & k_{2} \\end{pmatrix}$。期望的闭环极点位于 $s = -p_{1}$ 和 $s = -p_{2}$，其中 $p_{1} \\neq p_{2} > 0$。期望的特征多项式是\n$$\np_{d}(s) = (s + p_{1})(s + p_{2}) = s^{2} + (p_{1} + p_{2}) s + p_{1} p_{2},\n$$\n其中 $a_{1} = p_{1} + p_{2}$ 且 $a_{0} = p_{1} p_{2}$。\n\n首先，验证能控性并构建能控性矩阵：\n$$\nAB = \\begin{pmatrix} 0 & 1 \\\\ \\omega_{0}^{2} & 0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathcal{C} = \\begin{pmatrix} B & AB \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}.\n$$\n因为 $\\det(\\mathcal{C}) = -1 \\neq 0$，所以矩阵对 $(A,B)$ 是能控的，阿克曼公式适用。\n\n对于具有状态反馈 $u = -K x$ 的单输入单输出（SISO）系统，阿克曼公式给出\n$$\nK = e_{2}^{T} \\mathcal{C}^{-1} \\Phi(A),\n$$\n其中 $e_{2}^{T} = \\begin{pmatrix} 0 & 1 \\end{pmatrix}$ 且 $\\Phi(A)$ 是在 $A$ 处求值的期望特征多项式：\n$$\n\\Phi(A) = A^{2} + a_{1} A + a_{0} I.\n$$\n计算 $A^{2}$：\n$$\nA^{2} = \\begin{pmatrix} 0 & 1 \\\\ \\omega_{0}^{2} & 0 \\end{pmatrix}^{2} = \\begin{pmatrix} \\omega_{0}^{2} & 0 \\\\ 0 & \\omega_{0}^{2} \\end{pmatrix} = \\omega_{0}^{2} I.\n$$\n因此，\n$$\n\\Phi(A) = \\omega_{0}^{2} I + a_{1} A + a_{0} I = (\\omega_{0}^{2} + a_{0}) I + a_{1} A.\n$$\n此外，\n$$\n\\mathcal{C}^{-1} = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}, \\quad e_{2}^{T} \\mathcal{C}^{-1} = \\begin{pmatrix} 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\end{pmatrix}.\n$$\n于是，\n$$\nK = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\left[(\\omega_{0}^{2} + a_{0}) I + a_{1} A \\right].\n$$\n计算内部的矩阵：\n$$\n(\\omega_{0}^{2} + a_{0}) I + a_{1} A = \\begin{pmatrix} \\omega_{0}^{2} + a_{0} & 0 \\\\ 0 & \\omega_{0}^{2} + a_{0} \\end{pmatrix} + \\begin{pmatrix} 0 & a_{1} \\\\ a_{1} \\omega_{0}^{2} & 0 \\end{pmatrix} = \\begin{pmatrix} \\omega_{0}^{2} + a_{0} & a_{1} \\\\ a_{1} \\omega_{0}^{2} & \\omega_{0}^{2} + a_{0} \\end{pmatrix}.\n$$\n因此，\n$$\nK = \\begin{pmatrix} \\omega_{0}^{2} + a_{0} & a_{1} \\end{pmatrix} = \\begin{pmatrix} \\omega_{0}^{2} + p_{1} p_{2} & p_{1} + p_{2} \\end{pmatrix}.\n$$\n\n作为一致性检验，闭环矩阵为 $A - B K = \\begin{pmatrix} 0 & 1 \\\\ \\omega_{0}^{2} - k_{1} & -k_{2} \\end{pmatrix}$，其特征多项式为\n$$\n\\det(sI - (A - BK)) = s^{2} + k_{2} s + (k_{1} - \\omega_{0}^{2}),\n$$\n当 $k_{2} = p_{1} + p_{2}$ 且 $k_{1} = p_{1} p_{2} + \\omega_{0}^{2}$ 时，该多项式等于 $s^{2} + (p_{1} + p_{2}) s + p_{1} p_{2}$，这验证了结果。", "answer": "$$\\boxed{\\begin{pmatrix}\\omega_{0}^{2}+p_{1}p_{2} & p_{1}+p_{2}\\end{pmatrix}}$$", "id": "1556708"}, {"introduction": "控制设计不仅仅是为了挽救不稳定的系统，更多时候是为了优化性能。这个练习 [@problem_id:1556721] 提出了一个系统本身已经稳定，但其响应需要改进的场景。你将使用极点配置技术，精确地移动一个极点以提高系统响应速度，同时有意地将另一个极点保持在原位，这展示了反馈控制如何实现对系统行为的精细调节。", "problem": "一个线性时不变系统由状态空间模型 $\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t) + B\\mathbf{u}(t)$ 描述，其中 $\\mathbf{x}(t) \\in \\mathbb{R}^2$ 是状态向量，$\\mathbf{u}(t)$ 是标量输入。系统矩阵为：\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ -6 & -5 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n该系统的开环极点位于 $s = -2$ 和 $s = -3$。需要设计一个形式为 $\\mathbf{u}(t) = -K\\mathbf{x}(t)$ 的状态反馈控制律，其中 $K = \\begin{pmatrix} k_1 & k_2 \\end{pmatrix}$ 是增益矩阵。\n\n确定增益矩阵 $K$，将开环极点从 $s = -2$ 重新定位到新位置 $s = -10$，同时确保另一个极点保持在原始位置 $s = -3$ 不变。将 $K$ 的最终答案表示为一个 $1 \\times 2$ 的行矩阵。", "solution": "我们已知线性时不变 (LTI) 系统 $\\dot{\\mathbf{x}}(t)=A\\mathbf{x}(t)+B\\mathbf{u}(t)$，其中 $A=\\begin{pmatrix}0 & 1 \\\\ -6 & -5\\end{pmatrix}$ 且 $B=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$，并应用状态反馈控制律 $\\mathbf{u}(t)=-K\\mathbf{x}(t)$，其中 $K=\\begin{pmatrix}k_{1} & k_{2}\\end{pmatrix}$。闭环系统矩阵为\n$$\nA_{\\text{cl}}=A-BK=\\begin{pmatrix}0 & 1 \\\\ -6 & -5\\end{pmatrix}-\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}\\begin{pmatrix}k_{1} & k_{2}\\end{pmatrix}=\\begin{pmatrix}0 & 1 \\\\ -6-k_{1} & -5-k_{2}\\end{pmatrix}.\n$$\n\n一个 $2\\times 2$ 矩阵 $M$ 的特征多项式为 $s^{2}-(\\operatorname{tr}M)s+\\det(M)$。因此，对于 $A_{\\text{cl}}$ 我们有\n$$\n\\operatorname{tr}(A_{\\text{cl}})=-5-k_{2}, \\quad \\det(A_{\\text{cl}})=0\\cdot(-5-k_{2})-1\\cdot(-6-k_{1})=6+k_{1}.\n$$\n因此，闭环特征多项式为\n$$\ns^{2}+(5+k_{2})s+(6+k_{1}).\n$$\n\n我们希望将一个极点从 $s=-2$ 移动到 $s=-10$，同时保持另一个极点在 $s=-3$ 不变。因此，期望的特征值为 $-10$ 和 $-3$，从而得到期望的特征多项式\n$$\n(s+10)(s+3)=s^{2}+13s+30.\n$$\n将其与 $s^{2}+(5+k_{2})s+(6+k_{1})$ 的系数进行匹配，可得\n$$\n5+k_{2}=13 \\quad \\Rightarrow \\quad k_{2}=8,\n$$\n$$\n6+k_{1}=30 \\quad \\Rightarrow \\quad k_{1}=24.\n$$\n\n因此，所需的增益矩阵为 $K=\\begin{pmatrix}24 & 8\\end{pmatrix}$。快速验证表明，闭环特征多项式变为 $s^{2}+13s+30=(s+10)(s+3)$，证实了极点如要求位于 $-10$ 和 $-3$。", "answer": "$$\\boxed{\\begin{pmatrix}24 & 8\\end{pmatrix}}$$", "id": "1556721"}]}