{"hands_on_practices": [{"introduction": "一个系统对一个简单阶跃输入的响应包含了极其丰富的信息。本练习旨在演示如何从这类实验数据中提取直流增益 $K$ 和时间常数 $\\tau$ 等基本参数。掌握这种从阶跃响应曲线中估计模型参数的方法，是建立一阶系统近似模型的一种快速而有效的手段，也是控制工程师的一项基本功。[@problem_id:1597885]", "problem": "一名工程专业的学生接到一项任务，为一辆小型的自平衡电动滑板车创建一个简化的动态模型。为此，他们进行了一项实验。滑板车初始静止（$t=0$），在车轮的电机控制器上施加一个 $U_0 = 5.0$ V 的恒定指令电压，并随时间记录其产生的前进速度 $v$。采集到的时间-速度数据对如下：\n\n- (0.0 s, 0.00 m/s)\n- (0.5 s, 0.46 m/s)\n- (1.0 s, 0.81 m/s)\n- (1.5 s, 1.14 m/s)\n- (2.0 s, 1.36 m/s)\n- (2.5 s, 1.59 m/s)\n- (3.0 s, 1.73 m/s)\n- (4.0 s, 2.03 m/s)\n- (5.0 s, 2.15 m/s)\n- (8.0 s, 2.41 m/s)\n- (10.0 s, 2.46 m/s)\n- (12.0 s, 2.51 m/s)\n- (15.0 s, 2.49 m/s)\n- (18.0 s, 2.50 m/s)\n\n假设滑板车的速度动态特性可以近似为一个一阶线性系统，请估算该模型的两个关键参数：直流增益和主导时间常数。\n\n你的最终答案应为一个行矩阵，包含两个数字：首先是估算的直流增益，然后是估算的时间常数。直流增益的单位应为 (m/s)/V，时间常数的单位应为秒。两个数值都必须四舍五入到两位有效数字。", "solution": "对于一个在 $t=0$ 时由幅度为 $U_{0}$ 的阶跃输入驱动的一阶线性系统，其传递函数假定为\n$$\nG(s)=\\frac{K}{\\tau s+1},\n$$\n因此，速度的阶跃响应为\n$$\nv(t)=K\\,U_{0}\\left(1-\\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\right), \\quad t\\geq 0.\n$$\n其稳态（直流）值为\n$$\nv_{\\infty}=\\lim_{t\\to\\infty}v(t)=K\\,U_{0}\\;\\Rightarrow\\;K=\\frac{v_{\\infty}}{U_{0}}.\n$$\n从数据中可以看出，在最后的几个采样点（10 s 到 18 s），速度接近一个稳定值：$2.46$、$2.51$、$2.49$、$2.50$ m/s。取 $v_{\\infty}\\approx 2.50$ m/s 且 $U_{0}=5.0$ V，可得\n$$\nK=\\frac{2.50}{5.0}=0.50\\;\\text{(m/s)/V}.\n$$\n对于一阶阶跃响应，时间常数 $\\tau$ 满足\n$$\nv(\\tau)=v_{\\infty}\\left(1-\\exp(-1)\\right)\\approx 0.632\\,v_{\\infty}.\n$$\n当 $v_{\\infty}\\approx 2.50$ m/s 时，目标水平为\n$$\nv_{\\text{target}}=0.632\\times 2.50=1.58\\;\\text{m/s}.\n$$\n根据测量数据，在 $t_{1}=2.0$ s 时 $v=1.36$ m/s，在 $t_{2}=2.5$ s 时 $v=1.59$ m/s，因此 $v_{\\text{target}}$ 位于这两个时间点之间。使用线性插值法，\n$$\n\\tau\\approx t_{1}+\\frac{v_{\\text{target}}-v(t_{1})}{v(t_{2})-v(t_{1})}\\,(t_{2}-t_{1})\n=2.0+\\frac{1.58-1.36}{1.59-1.36}\\times 0.5\\approx 2.48\\;\\text{s}.\n$$\n四舍五入到两位有效数字，$\\tau\\approx 2.5$ s。因此，估算的参数为直流增益 $0.50$ (m/s)/V 和主导时间常数 $2.5$ s。", "answer": "$$\\boxed{\\begin{pmatrix} 0.50 & 2.5 \\end{pmatrix}}$$", "id": "1597885"}, {"introduction": "虽然图解法很直观，但最小二乘法为寻找模型参数的“最佳拟合”值提供了一种数学上更为严谨的途径。本练习将指导你如何根据实验数据构建所需的回归矩阵 $\\Phi$ 和参数向量 $\\theta$，并应用最小二乘算法来辨识一个多输入系统。这项实践是解决更复杂的实际工程问题，特别是处理多变量动态系统时的核心技能。[@problem_id:1597904]", "problem": "一位控制工程师正在为一个复杂电路板上的特定组件开发一个简化的热模型。该组件在离散时间步 $k$ 的温度，记为 $T(k)$（单位为摄氏度），被假设为其在前一个时间步的温度 $T(k-1)$ 以及两个附近热源所耗散的功率 $P_1(k-1)$ 和 $P_2(k-1)$（单位均为瓦特）的线性函数。\n\n所提出的离散时间模型由以下线性差分方程给出：\n$$T(k) = -a_1 T(k-1) + b_1 P_1(k-1) + b_2 P_2(k-1)$$\n其中 $a_1$、$b_1$和 $b_2$ 是表征热力学特性的未知实值参数。为了辨识这些参数，进行了一项实验，并记录了以下一系列测量数据：\n\n| 时间步, $k$ | 温度, $T(k)$ (°C) | 电源1功率, $P_1(k)$ (W) | 电源2功率, $P_2(k)$ (W) |\n| :---: | :---: | :---: | :---: |\n| 0 | 1 | 2 | 1 |\n| 1 | 2 | -1 | 0 |\n| 2 | -1 | -2 | 1 |\n| 3 | -2 | 1 | 1 |\n| 4 | 3 | 不适用 | 不适用 |\n\n使用所提供的数据和最小二乘法，确定参数向量 $\\theta = [a_1, b_1, b_2]^T$ 的最优估计。将您的答案以数值列向量的形式呈现。这些参数是无量纲的。将每个参数的最终答案四舍五入到三位有效数字。", "solution": "给定离散时间线性模型\n$$T(k) = -a_{1} T(k-1) + b_{1} P_{1}(k-1) + b_{2} P_{2}(k-1),$$\n其未知参数为 $\\theta = [a_{1}, b_{1}, b_{2}]^{T}$。使用 $k=1,2,3,4$ 的测量值，我们将模型表示为线性回归形式 $y = X \\theta$，其中 $X$ 的每一行是 $[-T(k-1),\\, P_{1}(k-1),\\, P_{2}(k-1)]$，$y$ 汇集了 $T(k)$。\n\n根据数据：\n- 对于 $k=1$：$T(0)=1$, $P_{1}(0)=2$, $P_{2}(0)=1$, $T(1)=2$ 给出行为 $[-1,\\,2,\\,1]$，$y_{1}=2$。\n- 对于 $k=2$：$T(1)=2$, $P_{1}(1)=-1$, $P_{2}(1)=0$, $T(2)=-1$ 给出行为 $[-2,\\,-1,\\,0]$，$y_{2}=-1$。\n- 对于 $k=3$：$T(2)=-1$, $P_{1}(2)=-2$, $P_{2}(2)=1$, $T(3)=-2$ 给出行为 $[1,\\,-2,\\,1]$，$y_{3}=-2$。\n- 对于 $k=4$：$T(3)=-2$, $P_{1}(3)=1$, $P_{2}(3)=1$, $T(4)=3$ 给出行为 $[2,\\,1,\\,1]$，$y_{4}=3$。\n\n因此\n$$\nX=\\begin{pmatrix}\n-1 & 2 & 1\\\\\n-2 & -1 & 0\\\\\n1 & -2 & 1\\\\\n2 & 1 & 1\n\\end{pmatrix},\\quad\ny=\\begin{pmatrix}\n2\\\\\n-1\\\\\n-2\\\\\n3\n\\end{pmatrix}.\n$$\n\n最小二乘估计满足正规方程\n$$\nX^{T}X\\,\\theta = X^{T}y.\n$$\n设 $X$ 的列为 $c_{1}, c_{2}, c_{3}$：\n$$\nc_{1}=\\begin{pmatrix}-1\\\\-2\\\\1\\\\2\\end{pmatrix},\\quad\nc_{2}=\\begin{pmatrix}2\\\\-1\\\\-2\\\\1\\end{pmatrix},\\quad\nc_{3}=\\begin{pmatrix}1\\\\0\\\\1\\\\1\\end{pmatrix}.\n$$\n则\n$$\nX^{T}X=\\begin{pmatrix}\nc_{1}\\cdot c_{1} & c_{1}\\cdot c_{2} & c_{1}\\cdot c_{3}\\\\\nc_{2}\\cdot c_{1} & c_{2}\\cdot c_{2} & c_{2}\\cdot c_{3}\\\\\nc_{3}\\cdot c_{1} & c_{3}\\cdot c_{2} & c_{3}\\cdot c_{3}\n\\end{pmatrix}\n=\\begin{pmatrix}\n10 & 0 & 2\\\\\n0 & 10 & 1\\\\\n2 & 1 & 3\n\\end{pmatrix},\n\\quad\nX^{T}y=\\begin{pmatrix}\nc_{1}\\cdot y\\\\\nc_{2}\\cdot y\\\\\nc_{3}\\cdot y\n\\end{pmatrix}\n=\\begin{pmatrix}\n4\\\\\n12\\\\\n3\n\\end{pmatrix}.\n$$\n\n因此，我们求解\n$$\n\\begin{pmatrix}\n10 & 0 & 2\\\\\n0 & 10 & 1\\\\\n2 & 1 & 3\n\\end{pmatrix}\n\\begin{pmatrix}\na_{1}\\\\\nb_{1}\\\\\nb_{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n4\\\\\n12\\\\\n3\n\\end{pmatrix}.\n$$\n由第一个和第二个方程得：\n$$\n10 a_{1} + 2 b_{2} = 4 \\;\\Rightarrow\\; a_{1} = \\frac{4 - 2 b_{2}}{10},\n\\qquad\n10 b_{1} + b_{2} = 12 \\;\\Rightarrow\\; b_{1} = \\frac{12 - b_{2}}{10}.\n$$\n代入第三个方程 $2 a_{1} + b_{1} + 3 b_{2} = 3$：\n$$\n2\\left(\\frac{4 - 2 b_{2}}{10}\\right) + \\left(\\frac{12 - b_{2}}{10}\\right) + 3 b_{2} = 3,\n$$\n$$\n\\frac{8 - 4 b_{2}}{10} + \\frac{12 - b_{2}}{10} + 3 b_{2} = 3,\n$$\n$$\n\\frac{20 - 5 b_{2}}{10} + 3 b_{2} = 3 \\;\\Rightarrow\\; 2 + \\frac{5}{2} b_{2} = 3 \\;\\Rightarrow\\; b_{2} = \\frac{2}{5}.\n$$\n则\n$$\na_{1} = \\frac{4 - 2\\cdot \\frac{2}{5}}{10} = \\frac{4 - \\frac{4}{5}}{10} = \\frac{\\frac{16}{5}}{10} = \\frac{8}{25},\n\\qquad\nb_{1} = \\frac{12 - \\frac{2}{5}}{10} = \\frac{\\frac{58}{5}}{10} = \\frac{29}{25}.\n$$\n因此，精确解为\n$$\n\\theta^{\\ast}=\\begin{pmatrix}\\frac{8}{25}\\\\[4pt]\\frac{29}{25}\\\\[4pt]\\frac{2}{5}\\end{pmatrix}.\n$$\n将每个条目四舍五入到三位有效数字，得到\n$$\n\\theta^{\\ast}\\approx\\begin{pmatrix}0.320\\\\[2pt]1.16\\\\[2pt]0.400\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0.320\\\\1.16\\\\0.400\\end{pmatrix}}$$", "id": "1597904"}, {"introduction": "在系统辨识中，仅仅获得一个模型是不够的，我们还必须确保辨识出的参数是可靠的。本练习探讨了实验设计中的一个关键概念：输入信号的质量。通过这个思想实验，你将理解为什么一个信息量不足或变化缓慢的输入信号会导致不可靠的参数估计结果，并揭示了输入信号“持续激励”特性对于成功辨识的重要性。[@problem_id:1597935]", "problem": "一位工程师的任务是辨识一个稳定的、离散时间、单输入单输出系统的参数。假设该系统的行为可以由以下线性差分方程很好地描述，其中 $u(k)$ 是输入，$y(k)$ 是在时间步 $k$ 的输出：\n\n$$y(k) = a_1 y(k-1) + a_2 y(k-2) + b_1 u(k-1) + b_2 u(k-2)$$\n\n该工程师旨在使用标准批量最小二乘法来估计参数向量 $\\theta = [a_1, a_2, b_1, b_2]^T$。用于估计的模型结构为 $Y = \\Phi \\theta + E$，其中 $Y$ 是输出测量向量，$\\Phi$ 是回归矩阵，$\\theta$ 是待估计的参数向量，$E$ 是残差向量。回归矩阵 $\\Phi$ 的每一行构造为 $\\phi(k)^T = [y(k-1), y(k-2), u(k-1), u(k-2)]$。\n\n在辨识实验中，工程师向系统施加了一个变化非常缓慢的低频正弦输入信号 $u(k)$。在收集数据并执行最小二乘估计后，工程师观察到所得的参数估计值 $\\hat{\\theta}$ 具有极大的方差，并且对微小的测量噪声高度敏感，从而使其变得不可靠。\n\n下列哪个陈述为参数估计的这种不可靠性提供了最准确的概念和数学解释？\n\nA. 使用低频输入信号违反了测量噪声必须是零均值白噪声过程的假设，从而导致有偏估计。\n\nB. 系统本质上是非线性的，尝试拟合线性模型会导致一个大的、结构化的残差向量 $E$，这使得最小二乘法无效。\n\nC. 对于变化缓慢的输入，回归量 $u(k-1)$ 和 $u(k-2)$ 变得几乎彼此相同。这导致回归矩阵 $\\Phi$ 变为秩亏，意味着方程 $Y = \\Phi \\theta$ 无解。\n\nD. 输入的缓慢变化导致回归矩阵 $\\Phi$ 的列向量变得近乎线性相关（这种情况被称为多重共线性）。这导致矩阵 $(\\Phi^T \\Phi)$ 变得病态且接近奇异，使其逆矩阵对数据中的扰动极为敏感，从而放大了噪声对参数估计的影响。\n\nE. 最小二乘估计算法（该算法通过迭代最小化平方误差和）无法收敛到全局最小值，因为相关的输入信号导致代价函数曲面出现多个局部极小值。", "solution": "我们将数据建模为 $Y=\\Phi\\theta+E$，其中每一行 $\\phi(k)^{T}=[y(k-1),y(k-2),u(k-1),u(k-2)]$。批量最小二乘估计器最小化 $J(\\theta)=\\|Y-\\Phi\\theta\\|^{2}$。将梯度设为零可得到正规方程 $\\Phi^{T}\\Phi\\,\\hat{\\theta}=\\Phi^{T}Y$，当 $\\Phi^{T}\\Phi$ 非奇异时，解为\n$$\n\\hat{\\theta}=(\\Phi^{T}\\Phi)^{-1}\\Phi^{T}Y.\n$$\n假设满足最小二乘法的标准条件：$E$ 的均值为零，协方差为 $\\operatorname{cov}(E)=\\sigma^{2}I$，并且回归量不含噪声。那么\n$$\n\\hat{\\theta}=\\theta+(\\Phi^{T}\\Phi)^{-1}\\Phi^{T}E,\n$$\n因此估计器是无偏的，$\\mathbb{E}[\\hat{\\theta}]=\\theta$，其协方差为\n$$\n\\operatorname{cov}(\\hat{\\theta})=\\sigma^{2}(\\Phi^{T}\\Phi)^{-1}.\n$$\n因此，参数估计的方差由 $(\\Phi^{T}\\Phi)^{-1}$ 控制。为了理解对噪声的敏感性和病态问题，使用奇异值分解 $\\Phi=U\\Sigma V^{T}$，其中 $\\Sigma=\\operatorname{diag}(\\sigma_{1},\\dots,\\sigma_{p})$ 包含奇异值。那么\n$$\n\\Phi^{T}\\Phi=V\\Sigma^{2}V^{T},\\quad (\\Phi^{T}\\Phi)^{-1}=V\\Sigma^{-2}V^{T},\n$$\n所以 $\\Phi$ 的小奇异值（即 $\\sigma_{\\min}\\approx 0$）会导致 $\\Sigma^{-2}$ 的元素值变得非常大，因此 $(\\Phi^{T}\\Phi)^{-1}$ 的元素值也变得非常大。因此，\n$$\n\\operatorname{cov}(\\hat{\\theta})=\\sigma^{2}V\\Sigma^{-2}V^{T}\n$$\n会变得很大，并且任何扰动 $\\delta Y$（例如噪声）在\n$$\n\\delta\\hat{\\theta}=(\\Phi^{T}\\Phi)^{-1}\\Phi^{T}\\delta Y.\n$$\n中被放大。\n此处的根本原因是多重共线性：对于一个变化非常缓慢的正弦输入，$u(k-1)\\approx u(k-2)$，因此 $\\Phi$ 中对应的列向量几乎是共线的。此外，对于一个由低频输入驱动的稳定系统，$y(k-1)$ 和 $y(k-2)$ 也高度相关，并且可以近似为输入回归量的线性组合，从而进一步增加了共线性。这使得 $\\Phi$ 的列向量近乎线性相关，因此 $\\Phi^{T}\\Phi$ 是病态的（接近奇异），这会极大地放大噪声并导致大的参数方差。\n\n这解释了所观察到的不可靠性。这并非由于违反了噪声假设（因此A不正确），也不要求系统是非线性的（B没有依据）。精确的秩亏将意味着解的非唯一性而非“无解”，并且最小二乘法仍然可以通过伪逆得到解；这里的实际问题是接近相关，而非精确相关（因此C不准确）。最后，最小二乘的代价函数是一个具有唯一全局最小值的凸二次函数；相关的输入不会产生局部极小值（因此E不正确）。正确的解释是D中所述的由多重共线性引起的病态问题。", "answer": "$$\\boxed{D}$$", "id": "1597935"}]}