{"hands_on_practices": [{"introduction": "本次练习是你进入最小二乘估计实践世界的第一步。在求解未知参数 $\\theta$ 之前，我们必须首先学会如何将实验数据正确地组织成标准化的 $Y = \\Phi\\theta$ 矩阵形式。本练习将指导你如何根据一组输入输出测量数据，构建用于系统辨识的核心部分——回归矩阵 $\\Phi$，这是一项基本功。[@problem_id:1588623]", "problem": "一位工程师正在对一个热过程进行系统辨识实验。该过程由以下二阶线性离散时间方程建模：\n$$y(k) = a_1 y(k-1) + a_2 y(k-2) + b_1 u(k-1)$$\n其中 $k$ 是离散时间索引，$y(k)$ 是测得的温度输出，$u(k)$ 是加热器功率输入，$a_1, a_2, b_1$ 是未知模型参数。\n\n系统初始处于静止状态，意味着对于所有 $k \\leq 0$，有 $y(k) = 0$。在时间 $k=1$ 时，对系统施加一个单位阶跃输入，使得输入信号定义为当 $k  1$ 时 $u(k) = 0$，当 $k \\geq 1$ 时 $u(k) = 1$。\n\n记录下以下温度测量值序列：\n$y(1) = 0.5$\n$y(2) = 1.5$\n$y(3) = 2.0$\n$y(4) = 2.2$\n$y(5) = 2.3$\n\n为使用最小二乘法估计参数，将系统方程堆叠成形式为 $Y = \\Phi \\theta$ 的线性回归模型，其中 $\\theta = \\begin{pmatrix} a_1  a_2  b_1 \\end{pmatrix}^T$ 是参数向量。使用从 $k=2$ 到 $k=5$ 的可用测量值，构建数值回归矩阵 $\\Phi$。", "solution": "给定模型是二阶线性离散时间方程\n$$y(k)=a_{1}y(k-1)+a_{2}y(k-2)+b_{1}u(k-1).$$\n为了构成线性回归 $Y=\\Phi\\theta$（其中 $\\theta=\\begin{pmatrix}a_{1}  a_{2}  b_{1}\\end{pmatrix}^{T}$），回归矩阵 $\\Phi$ 在时间索引 $k$ 的每一行是\n$$\\phi(k)=\\begin{pmatrix}y(k-1)  y(k-2)  u(k-1)\\end{pmatrix}.$$\n系统在 $k\\leq 0$ 时处于静止状态，因此 $y(0)=0$，并且输入是在 $k=1$ 时的单位阶跃，因此当 $k1$ 时 $u(k)=0$，当 $k\\geq 1$ 时 $u(k)=1$。因此，对于 $k=2,3,4,5$，我们有 $u(k-1)=1$。\n\n使用测得的输出值 $y(1)=0.5$，$y(2)=1.5$，$y(3)=2.0$，$y(4)=2.2$，$y(5)=2.3$，$\\Phi$ 的各行计算如下：\n- 对于 $k=2$：$\\phi(2)=\\begin{pmatrix}y(1)  y(0)  u(1)\\end{pmatrix}=\\begin{pmatrix}0.5  0  1\\end{pmatrix}$。\n- 对于 $k=3$：$\\phi(3)=\\begin{pmatrix}y(2)  y(1)  u(2)\\end{pmatrix}=\\begin{pmatrix}1.5  0.5  1\\end{pmatrix}$。\n- 对于 $k=4$：$\\phi(4)=\\begin{pmatrix}y(3)  y(2)  u(3)\\end{pmatrix}=\\begin{pmatrix}2.0  1.5  1\\end{pmatrix}$。\n- 对于 $k=5$：$\\phi(5)=\\begin{pmatrix}y(4)  y(3)  u(4)\\end{pmatrix}=\\begin{pmatrix}2.2  2.0  1\\end{pmatrix}$。\n\n将这些行堆叠起来，得到数值回归矩阵\n$$\\Phi=\\begin{pmatrix}\n0.5  0  1\\\\\n1.5  0.5  1\\\\\n2.0  1.5  1\\\\\n2.2  2.0  1\n\\end{pmatrix}.$$", "answer": "$$\\boxed{\\begin{pmatrix}0.5  0  1 \\\\ 1.5  0.5  1 \\\\ 2.0  1.5  1 \\\\ 2.2  2.0  1\\end{pmatrix}}$$", "id": "1588623"}, {"introduction": "现实世界的系统很少像教科书模型那样纯净，它们常常包含恒定的扰动，例如环境温度漂移或传感器偏置。本次练习在前一题的基础上，挑战你估计一个包含此类恒定扰动项的系统参数。你将学习如何调整最小二乘框架以计入这些偏置，并从头到尾完成一次完整的数值估计过程。[@problem_id:1588627]", "problem": "一位工程师正在识别一个在制造过程中观测到的离散时间动态系统的参数。该系统的输出 $y(k)$ 被认为遵循一个由输入 $u(k)$ 驱动、并受恒定环境扰动 $d$ 影响的一阶线性模型。提出的模型为：\n$$y(k) = a y(k-1) + b u(k-1) + d$$\n其中 $k$ 是时间索引，$a$、$b$ 和 $d$ 是待确定的未知常数参数。从该过程中收集了一系列输入和输出数据，如下所示：\n- 输入序列：$u(0) = 1$，$u(1) = 0$，$u(2) = 1$，$u(3) = 0$。\n- 输出序列：$y(0) = 2$，$y(1) = 4.1$，$y(2) = 2.9$，$y(3) = 4.6$，$y(4) = 3.3$。\n\n使用所提供的完整数据集，应用批处理最小二乘法来寻找参数的最佳估计值。待估计的参数向量为 $\\theta = \\begin{pmatrix} a  b  d \\end{pmatrix}^T$。\n\n以行矩阵的形式提供您的最终答案，按顺序包含 $a$、$b$ 和 $d$ 的估计值。将每个参数四舍五入到三位有效数字。", "solution": "我们使用一阶线性系统对数据进行建模\n$$y(k) = a\\,y(k-1) + b\\,u(k-1) + d,$$\n并构建批处理最小二乘回归 $Y = \\Phi \\theta$，其中 $\\theta = \\begin{pmatrix} a  b  d \\end{pmatrix}^{T}$。使用 $k=1,2,3,4$ 的样本，我们得到\n$$\\Phi = \\begin{pmatrix}\n2  1  1\\\\\n4.1  0  1\\\\\n2.9  1  1\\\\\n4.6  0  1\n\\end{pmatrix}, \\quad\nY = \\begin{pmatrix}\n4.1\\\\\n2.9\\\\\n4.6\\\\\n3.3\n\\end{pmatrix}.$$\n批处理最小二乘解为\n$$\\hat{\\theta} = \\left(\\Phi^{T}\\Phi\\right)^{-1}\\Phi^{T}Y,$$\n因此我们计算\n$$\\Phi^{T}\\Phi = \\begin{pmatrix}\n50.38  4.9  13.6\\\\\n4.9  2  2\\\\\n13.6  2  4\n\\end{pmatrix}, \\quad\n\\Phi^{T}Y = \\begin{pmatrix}\n48.61\\\\\n8.7\\\\\n14.9\n\\end{pmatrix}.$$\n因此 $\\hat{\\theta}$ 求解正规方程组\n$$\\begin{cases}\n50.38\\,a + 4.9\\,b + 13.6\\,d = 48.61,\\\\\n4.9\\,a + 2\\,b + 2\\,d = 8.7,\\\\\n13.6\\,a + 2\\,b + 4\\,d = 14.9.\n\\end{cases}$$\n将第三个方程减去第二个方程以消去 $b$：\n$$(13.6 - 4.9)a + (2-2)b + (4-2)d = 14.9 - 8.7,$$\n得到\n$$8.7\\,a + 2\\,d = 6.2 \\;\\Rightarrow\\; d = 3.1 - 4.35\\,a.$$\n根据第二个方程，\n$$2\\,b = 8.7 - 4.9\\,a - 2\\,d = 8.7 - 4.9\\,a - (6.2 - 8.7\\,a) = 2.5 + 3.8\\,a,$$\n所以\n$$b = 1.25 + 1.9\\,a.$$\n将 $b$ 和 $d$ 代入第一个方程：\n$$50.38\\,a + 4.9(1.25 + 1.9\\,a) + 13.6(3.1 - 4.35\\,a) = 48.61.$$\n计算各项：\n$$50.38\\,a + 6.125 + 9.31\\,a + 42.16 - 59.16\\,a = 48.61,$$\n$$(50.38 + 9.31 - 59.16)a + (6.125 + 42.16) = 48.61,$$\n$$0.53\\,a + 48.285 = 48.61 \\;\\Rightarrow\\; 0.53\\,a = 0.325 \\;\\Rightarrow\\; a = \\frac{0.325}{0.53} \\approx 0.613207547.$$\n然后\n$$b = 1.25 + 1.9\\,a \\approx 1.25 + 1.9 \\times 0.613207547 \\approx 2.415094339,$$\n$$d = 3.1 - 4.35\\,a \\approx 3.1 - 4.35 \\times 0.613207547 \\approx 0.432547171.$$\n将每个参数四舍五入到三位有效数字，得到\n$$a \\approx 0.613,\\quad b \\approx 2.42,\\quad d \\approx 0.433.$$", "answer": "$$\\boxed{\\begin{pmatrix}0.613  2.42  0.433\\end{pmatrix}}$$", "id": "1588627"}, {"introduction": "当我们的实验未能提供足够“信息”来可靠地估计所有参数，导致数学上的“病态”问题时，我们该怎么办？这项高级练习将介绍岭回归，一种在这种情况下稳定最小二乘解的强大技术。你将推导岭回归估计器，并分析它所引入的偏差，从而深入理解参数估计中偏差与方差之间的关键权衡。[@problem_id:1588663]", "problem": "在系统辨识与控制领域，一项常见的任务是根据一组可用线性模型 $Y = \\Phi\\theta + E$ 描述的测量数据来估计参数向量 $\\theta \\in \\mathbb{R}^p$。此处，$Y \\in \\mathbb{R}^N$ 是测量向量，$\\Phi \\in \\mathbb{R}^{N \\times p}$ 是已知的回归矩阵，而 $E \\in \\mathbb{R}^N$ 是一个均值为零的未测量噪声向量，即 $E[E]=0$。\n\n当实验条件导致的回归矩阵 $\\Phi$ 使得“信息矩阵” $R = \\Phi^T\\Phi$ 呈病态或奇异时，标准的最小二乘估计会对噪声变得高度敏感。为了缓解此问题，可以采用一种称为岭回归（或 Tikhonov 正则化）的方法。岭回归估计值 $\\hat{\\theta}_{ridge}$ 可通过最小化以下代价函数求得：\n$$ J(\\theta) = \\|Y - \\Phi\\theta\\|^2_2 + \\gamma\\|\\theta\\|^2_2 $$\n其中 $\\| \\cdot \\|_2$ 表示欧几里得范数，$\\gamma  0$ 是一个标量正则化参数。\n\n正则化项的引入虽然稳定了解，但会给估计值带来系统性偏差。设该偏差定义为 $B = E[\\hat{\\theta}_{ridge}] - \\theta$，其中期望是针对噪声 $E$ 计算的，并且我们假定 $\\Phi$ 中的回归量是确定性的或与噪声不相关。我们感兴趣的是，这一偏差在信息矩阵 $R$ 的特征空间中是如何进行几何分布的。\n\n设 $R = V\\Lambda V^T$ 是对称半正定矩阵 $R$ 的特征分解，其中 $V = [v_1, v_2, \\dots, v_p]$ 是一个正交矩阵，其列 $v_i$ 是 $R$ 的标准正交特征向量，而 $\\Lambda = \\text{diag}(\\lambda_1, \\lambda_2, \\dots, \\lambda_p)$ 是由相应的非负特征值 $\\lambda_i$ 构成的对角矩阵。\n\n您的任务是确定偏差向量 $B$ 沿着任意特征向量 $v_i$ 方向的分量。请找出该分量的闭式解析表达式，该分量由标量投影 $c_i = v_i^T B$ 给出。您的最终答案应使用正则化参数 $\\gamma$、特征值 $\\lambda_i$ 以及真实参数向量 $\\theta$ 沿 $v_i$ 方向的分量（记为 $\\alpha_i = v_i^T \\theta$）来表示。", "solution": "我们从岭回归的代价函数开始\n$$\nJ(\\theta)=\\|Y-\\Phi\\theta\\|_{2}^{2}+\\gamma\\|\\theta\\|_{2}^{2}.\n$$\n将关于 $\\theta$ 的梯度设为零，可得到岭回归的正规方程。使用 $\\nabla_{\\theta}\\|Y-\\Phi\\theta\\|_{2}^{2}=-2\\Phi^{T}(Y-\\Phi\\theta)$ 和 $\\nabla_{\\theta}\\|\\theta\\|_{2}^{2}=2\\theta$，我们得到\n$$\n-2\\Phi^{T}(Y-\\Phi\\theta)+2\\gamma\\theta=0 \\;\\;\\Rightarrow\\;\\; (\\Phi^{T}\\Phi+\\gamma I)\\theta=\\Phi^{T}Y.\n$$\n因此，岭回归估计量为\n$$\n\\hat{\\theta}_{ridge}=(\\Phi^{T}\\Phi+\\gamma I)^{-1}\\Phi^{T}Y.\n$$\n根据线性模型 $Y=\\Phi\\theta+E$ 并定义 $R=\\Phi^{T}\\Phi$，我们代入可得\n$$\n\\hat{\\theta}_{ridge}=(R+\\gamma I)^{-1}\\Phi^{T}(\\Phi\\theta+E)=(R+\\gamma I)^{-1}(R\\theta+\\Phi^{T}E).\n$$\n对噪声取期望，并利用 $E[E]=0$ 以及 $\\Phi$ 是确定性的（或与 $E$ 不相关），可得\n$$\nE[\\hat{\\theta}_{ridge}]=(R+\\gamma I)^{-1}(R\\theta+E[\\Phi^{T}E])=(R+\\gamma I)^{-1}R\\theta.\n$$\n偏差为\n$$\nB=E[\\hat{\\theta}_{ridge}]-\\theta=\\big((R+\\gamma I)^{-1}R-I\\big)\\theta.\n$$\n我们简化该矩阵因子：\n$$\n(R+\\gamma I)^{-1}R-I=(R+\\gamma I)^{-1}\\big(R-(R+\\gamma I)\\big)=-\\gamma(R+\\gamma I)^{-1}.\n$$\n因此\n$$\nB=-\\gamma(R+\\gamma I)^{-1}\\theta.\n$$\n设 $R=V\\Lambda V^{T}$ 为特征分解，其中 $V=[v_{1},\\dots,v_{p}]$ 是正交矩阵，$\\Lambda=\\mathrm{diag}(\\lambda_{1},\\dots,\\lambda_{p})$。那么\n$$\nR+\\gamma I=V(\\Lambda+\\gamma I)V^{T},\\qquad (R+\\gamma I)^{-1}=V(\\Lambda+\\gamma I)^{-1}V^{T}.\n$$\n于是\n$$\nB=-\\gamma V(\\Lambda+\\gamma I)^{-1}V^{T}\\theta.\n$$\n$B$ 沿着 $v_i$ 的分量是 $c_{i}=v_{i}^{T}B$，所以\n$$\nc_{i}=-\\gamma\\,v_{i}^{T}V(\\Lambda+\\gamma I)^{-1}V^{T}\\theta.\n$$\n使用 $v_{i}^{T}V=e_{i}^{T}$，其中 $e_i$ 是第 $i$ 个标准基向量，并定义 $\\alpha_{i}=v_{i}^{T}\\theta$，我们得到\n$$\nc_{i}=-\\gamma\\,e_{i}^{T}(\\Lambda+\\gamma I)^{-1}V^{T}\\theta=-\\gamma\\,\\frac{1}{\\lambda_{i}+\\gamma}\\,(v_{i}^{T}\\theta)=-\\frac{\\gamma}{\\lambda_{i}+\\gamma}\\,\\alpha_{i}.\n$$\n这表明，偏差沿着 $v_i$ 的分量是真实分量 $\\alpha_i$ 经过因子 $-\\gamma/(\\lambda_{i}+\\gamma)$ 收缩后的结果。", "answer": "$$\\boxed{-\\frac{\\gamma}{\\lambda_{i}+\\gamma}\\,\\alpha_{i}}$$", "id": "1588663"}]}