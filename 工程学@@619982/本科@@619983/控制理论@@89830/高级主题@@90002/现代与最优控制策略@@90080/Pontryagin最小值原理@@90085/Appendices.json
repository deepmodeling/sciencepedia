{"hands_on_practices": [{"introduction": "第一个练习将引导你完整地走一遍应用庞特里亚金最小值原理的全过程。我们从一个常见的工程场景入手：如何以最小的能量消耗，在固定的时间内将一个系统驱动到目标状态。通过求解这个问题 [@problem_id:1600520]，你将学会构建哈密顿量、推导协态方程，并利用边界条件来找到最优控制及其成本的完整解析解，为解决更复杂的优化问题打下坚实的基础。", "problem": "考虑一个用于控制小物体（例如电路板上的一个组件）温度的简化模型。令 $x(t)$ 为在时间 $t$ 时，物体与其恒温环境之间的温度差。根据牛顿冷却定律，物体会自然冷却（或升温）至环境温度，其温度差以与温差本身成正比的速率衰减。我们使用一个温差电控制器（如 Peltier 器件）来主动改变物体的温度。温度动态由以下线性常微分方程描述：\n$$ \\dot{x}(t) = -\\alpha x(t) + \\beta u(t) $$\n此处，$u(t)$ 是控制输入，与供给控制器的功率成正比。参数 $\\alpha$ 和 $\\beta$ 是正常数，分别代表与环境的热耦合以及控制器的效率。\n\n您的任务是找到在固定的时间间隔 $T$ 内，将系统从已知的初始温度差 $x(0) = x_0$ 驱动到与环境达到热平衡状态 $x(T) = 0$ 的最小成本。成本由所消耗的总控制能量定义，由以下泛函给出：\n$$ J = \\int_{0}^{T} \\frac{1}{2} u(t)^2 dt $$\n确定最小成本 $J$ 关于参数 $x_0$、$T$、$\\alpha$ 和 $\\beta$ 的闭式解析表达式。", "solution": "我们寻求最小能量控制，以将标量线性系统 $\\dot{x}(t)=-\\alpha x(t)+\\beta u(t)$ 从 $x(0)=x_{0}$ 驱动到 $x(T)=0$，其成本为 $J=\\int_{0}^{T}\\frac{1}{2}u(t)^{2}\\,dt$。这是一个具有二次控制成本的固定端点最优控制问题。根据庞特里亚金最小值原理，定义哈密顿量\n$$\nH(x,u,p)=\\frac{1}{2}u^{2}+p\\left(-\\alpha x+\\beta u\\right).\n$$\n最优性条件 $\\partial H/\\partial u=0$ 给出\n$$\nu^{\\ast}(t)+\\beta p(t)=0 \\quad \\Rightarrow \\quad u^{\\ast}(t)=-\\beta p(t).\n$$\n协态方程为\n$$\n\\dot{p}(t)=-\\frac{\\partial H}{\\partial x}=\\alpha p(t),\n$$\n其解为\n$$\np(t)=C\\,\\exp(\\alpha t),\n$$\n其中 $C$ 是一个待由边界条件确定的常数。将 $u^{\\ast}$ 代入状态动态方程，得到\n$$\n\\dot{x}(t)=-\\alpha x(t)-\\beta^{2}p(t)=-\\alpha x(t)-\\beta^{2}C\\,\\exp(\\alpha t).\n$$\n该线性常微分方程的积分因子为 $\\exp(\\alpha t)$，因此\n$$\n\\frac{d}{dt}\\left(\\exp(\\alpha t)\\,x(t)\\right)=-\\beta^{2}C\\,\\exp(2\\alpha t).\n$$\n从 $0$ 到 $t$ 积分并使用 $x(0)=x_{0}$，得到\n$$\n\\exp(\\alpha t)\\,x(t)-x_{0}=-\\beta^{2}C\\int_{0}^{t}\\exp(2\\alpha s)\\,ds\n=-\\beta^{2}C\\,\\frac{\\exp(2\\alpha t)-1}{2\\alpha}.\n$$\n因此，\n$$\nx(t)=\\exp(-\\alpha t)\\left[x_{0}-\\beta^{2}C\\,\\frac{\\exp(2\\alpha t)-1}{2\\alpha}\\right].\n$$\n施加终端约束 $x(T)=0$，得到\n$$\n0=\\exp(-\\alpha T)\\left[x_{0}-\\beta^{2}C\\,\\frac{\\exp(2\\alpha T)-1}{2\\alpha}\\right]\n\\quad \\Rightarrow \\quad\nC=\\frac{2\\alpha x_{0}}{\\beta^{2}\\left(\\exp(2\\alpha T)-1\\right)}.\n$$\n则最优控制为\n$$\nu^{\\ast}(t)=-\\beta p(t)=-\\beta C\\,\\exp(\\alpha t).\n$$\n最小成本为\n$$\nJ^{\\ast}=\\int_{0}^{T}\\frac{1}{2}\\left(u^{\\ast}(t)\\right)^{2}dt\n=\\frac{1}{2}\\int_{0}^{T}\\beta^{2}C^{2}\\exp(2\\alpha t)\\,dt\n=\\frac{1}{2}\\,\\beta^{2}C^{2}\\,\\frac{\\exp(2\\alpha T)-1}{2\\alpha}.\n$$\n代入 $C=\\dfrac{2\\alpha x_{0}}{\\beta^{2}\\left(\\exp(2\\alpha T)-1\\right)}$，\n$$\nJ^{\\ast}=\\frac{1}{2}\\cdot\\beta^{2}\\cdot\\frac{4\\alpha^{2}x_{0}^{2}}{\\beta^{4}\\left(\\exp(2\\alpha T)-1\\right)^{2}}\n\\cdot\\frac{\\exp(2\\alpha T)-1}{2\\alpha}\n=\\frac{\\alpha x_{0}^{2}}{\\beta^{2}\\left(\\exp(2\\alpha T)-1\\right)}.\n$$\n这就是所求的关于 $x_{0}$、$T$、$\\alpha$ 和 $\\beta$ 的闭式表达式。", "answer": "$$\\boxed{\\frac{\\alpha x_{0}^{2}}{\\beta^{2}\\left(\\exp(2\\alpha T)-1\\right)}}$$", "id": "1600520"}, {"introduction": "掌握了如何最小化控制能量后，让我们将目标转向最小化时间。本练习探讨一个典型的时间最优控制问题，这类问题在机器人和航空航天领域非常普遍，其目标是“唯快不破”。你将通过一个简单的加热器模型，探索当控制输入只能在“开”或“关”之间切换时，如何以最快速度达到目标温度。这个问题 [@problem_id:1600533] 将为你揭示“开关控制”（bang-bang control）这一重要概念，即最优策略往往是极端地使用最大或最小控制力。", "problem": "一个用于描述小型化学反应器温度控制的简化模型由以下一阶线性微分方程给出：\n$$\n\\frac{dx}{dt} = -x(t) + u(t)\n$$\n在此，$x(t)$ 表示反应器相对于环境温度的无量纲温度。项 $-x(t)$ 模拟了自然冷却过程（牛顿冷却定律），而 $u(t)$ 表示加热器的作用。该加热器是一个简单的设备，只能完全关闭（对应于 $u(t)=0$）或完全开启（对应于 $u(t)=1$）。\n\n反应器的初始温度为 $x(0) = 3$。该过程要求将温度降低到最终值 $x(t_f) = 0.5$。您的任务是确定能在最短时间内实现此温度变化的加热器控制策略。\n\n计算系统从初始状态转变到最终状态所需的最短时间 $t_f$。请以四舍五入到三位有效数字的数值形式报告您的答案。", "solution": "给定线性系统 $\\dot{x}(t)=-x(t)+u(t)$，其中 $u(t)\\in\\{0,1\\}$，$x(0)=3$，目标为 $x(t_{f})=0.5$。目标是最小化到达目标状态的时间 $t_f$。\n\n为了在最短时间内将温度从 $x=3$ 降低到 $x=0.5$，我们需要使温度的下降速率，即 $\\dot{x}$，在任何时刻都尽可能小（即尽可能为负）。$\\dot{x}$ 的表达式为 $-x(t)+u(t)$。由于 $u(t)$ 只能取 0 或 1，为了最小化 $\\dot{x}$，我们必须在整个过程中始终选择 $u$ 的最小值，即 $u(t)=0$。\n\n因此，最优控制策略是始终关闭加热器，$u(t)=0$。当 $u(t)=0$ 时，常微分方程为 $\\dot{x}=-x$，其解为：\n$$\nx(t)=x(0)\\exp(-t)=3\\exp(-t).\n$$\n代入终端条件 $x(t_{f})=0.5$ 可得：\n$$\n3\\exp(-t_{f})=0.5 \\;\\;\\Longrightarrow\\;\\; \\exp(-t_{f})=\\frac{1}{6} \\;\\;\\Longrightarrow\\;\\; t_{f}=\\ln(6).\n$$\n其数值为 $\\ln(6)\\approx 1.791759\\ldots$，四舍五入到三位有效数字是 $1.79$。", "answer": "$$\\boxed{1.79}$$", "id": "1600533"}, {"introduction": "现实世界的任务往往比在固定时间到达一个精确点更具灵活性。最后一个练习将引入两个更高级的概念：自由终端时间和终端流形约束。我们将解决一个目标是“到达指定区域”而非“到达指定点”的问题，并且完成任务的时间也是自由的。通过这个问题 [@problem_id:1600523]，你将学会使用庞特里亚金最小值原理中的横截性条件，这是处理这类灵活且贴近实际的优化问题的关键工具。", "problem": "一个位于二维笛卡尔平面内的质点，其位置向量为 $\\mathbf{x}(t) = [x_1(t), x_2(t)]^T$，由一个速度输入 $\\mathbf{u}(t) = [u_1(t), u_2(t)]^T$ 控制。该质点的动力学由以下简单积分器模型描述：\n$$\n\\dot{\\mathbf{x}}(t) = \\mathbf{u}(t)\n$$\n该质点在时刻 $t=0$ 时从原点出发，即 $\\mathbf{x}(0) = [0, 0]^T$。目标是驱动该质点到达一个以原点为中心、半径为 $R$ 的目标圆上。终端时刻 $t_f$ 不固定，由质点首次到达该圆的时刻决定。因此，终端条件由流形方程 $x_1(t_f)^2 + x_2(t_f)^2 = R^2$ 给出。\n\n目标是找到一个控制输入 $\\mathbf{u}(t)$，以最小化目标泛函 $J$，该泛函表示控制能量和时间长度的组合：\n$$\nJ = \\int_{0}^{t_f} \\left( \\frac{1}{2} (u_1(t)^2 + u_2(t)^2) + 1 \\right) dt\n$$\n\n试确定该目标泛函的可能最小值 $J_{min}$，并用半径 $R$ 表示。", "solution": "我们应用庞特里亚金最小值原理来解决最小化问题\n$$\nJ=\\int_{0}^{t_{f}}\\left(\\frac{1}{2}\\left(u_{1}(t)^{2}+u_{2}(t)^{2}\\right)+1\\right)dt=\\int_{0}^{t_{f}}\\left(\\frac{1}{2}\\|\\mathbf{u}(t)\\|^{2}+1\\right)dt\n$$\n约束条件为动力学 $\\dot{\\mathbf{x}}(t)=\\mathbf{u}(t)$、初始条件 $\\mathbf{x}(0)=\\mathbf{0}$、自由终端时刻 $t_{f}$ 以及终端流形 $g(\\mathbf{x}(t_{f}))=\\|\\mathbf{x}(t_{f})\\|^{2}-R^{2}=0$。\n\n定义哈密顿函数\n$$\nH(\\mathbf{x},\\mathbf{u},\\boldsymbol{\\lambda})=\\frac{1}{2}\\|\\mathbf{u}\\|^{2}+1+\\boldsymbol{\\lambda}^{T}\\mathbf{u}.\n$$\n关于 $\\mathbf{u}$ 的定常条件给出\n$$\n\\frac{\\partial H}{\\partial \\mathbf{u}}=\\mathbf{u}+\\boldsymbol{\\lambda}=\\mathbf{0}\\quad\\Rightarrow\\quad \\mathbf{u}^{*}(t)=-\\boldsymbol{\\lambda}(t).\n$$\n协态动力学为\n$$\n\\dot{\\boldsymbol{\\lambda}}(t)=-\\frac{\\partial H}{\\partial \\mathbf{x}}=\\mathbf{0}\\quad\\Rightarrow\\quad \\boldsymbol{\\lambda}(t)=\\boldsymbol{\\lambda}_{0}\\ \\text{(常数)}.\n$$\n因此，最优控制是常数 $\\mathbf{u}^{*}(t)=-\\boldsymbol{\\lambda}_{0}$，状态演化为\n$$\n\\mathbf{x}(t)=\\int_{0}^{t}\\mathbf{u}^{*}(\\tau)\\,d\\tau=\\mathbf{u}^{*}\\,t=-\\boldsymbol{\\lambda}_{0}\\,t.\n$$\n终端流形条件为\n$$\n\\|\\mathbf{x}(t_{f})\\|^{2}=R^{2}\\quad\\Rightarrow\\quad \\|\\mathbf{u}^{*}\\|^{2}\\,t_{f}^{2}=R^{2}\\quad\\Rightarrow\\quad t_{f}=\\frac{R}{\\|\\mathbf{u}^{*}\\|}.\n$$\n因为终端时刻是自由的且没有终端代价，横截条件得出\n$$\nH(t_{f})=0.\n$$\n将 $\\mathbf{u}^{*}=-\\boldsymbol{\\lambda}_{0}$ 代入哈密顿函数得到\n$$\nH=\\frac{1}{2}\\|\\mathbf{u}^{*}\\|^{2}+1+\\boldsymbol{\\lambda}_{0}^{T}\\mathbf{u}^{*}\n=\\frac{1}{2}\\|\\mathbf{u}^{*}\\|^{2}+1-\\|\\boldsymbol{\\lambda}_{0}\\|^{2}\n=\\frac{1}{2}\\|\\mathbf{u}^{*}\\|^{2}+1-\\|\\mathbf{u}^{*}\\|^{2}\n=1-\\frac{1}{2}\\|\\mathbf{u}^{*}\\|^{2}.\n$$\n令 $H(t_{f})=0$ 得出\n$$\n1-\\frac{1}{2}\\|\\mathbf{u}^{*}\\|^{2}=0\\quad\\Rightarrow\\quad \\|\\mathbf{u}^{*}\\|^{2}=2\\quad\\Rightarrow\\quad \\|\\mathbf{u}^{*}\\|=\\sqrt{2}.\n$$\n因此\n$$\nt_{f}=\\frac{R}{\\sqrt{2}}.\n$$\n那么最优代价为\n$$\nJ_{\\min}=\\int_{0}^{t_{f}}\\left(\\frac{1}{2}\\|\\mathbf{u}^{*}\\|^{2}+1\\right)dt\n=\\int_{0}^{t_{f}}\\left(\\frac{1}{2}\\cdot 2+1\\right)dt\n=\\int_{0}^{t_{f}}2\\,dt\n=2t_{f}\n=2\\cdot\\frac{R}{\\sqrt{2}}\n=\\sqrt{2}\\,R.\n$$\n为了完整起见，同样的值也可以通过直接的变分法论证得到。对于任意固定的 $t_f$ 和 $\\|\\mathbf{y}\\|=R$ 的终端点 $\\mathbf{y}$，最小的控制能量由常数控制 $\\mathbf{u}(t)=\\mathbf{y}/t_{f}$ 实现，得到\n$$\nJ(t_{f})=\\frac{1}{2}\\int_{0}^{t_{f}}\\|\\mathbf{u}\\|^{2}dt+\\int_{0}^{t_{f}}1\\,dt=\\frac{1}{2}\\cdot t_{f}\\cdot\\frac{R^{2}}{t_{f}^{2}}+t_{f}=\\frac{R^{2}}{2t_{f}}+t_{f}.\n$$\n通过令 $\\frac{dJ}{dt_{f}}=-\\frac{R^{2}}{2t_{f}^{2}}+1=0$ 对 $t_{f}>0$ 进行最小化，可得 $t_{f}=R/\\sqrt{2}$，因此 $J_{\\min}=\\sqrt{2}\\,R$，这与 Pontryagin 分析的结果一致。", "answer": "$$\\boxed{\\sqrt{2}\\,R}$$", "id": "1600523"}]}