{"hands_on_practices": [{"introduction": "这个首要练习为理解自适应调节器奠定了基础。我们将通过推导一个“无差拍”（deadbeat）控制器的控制律来探索“确定性等效”原理，该控制器旨在假设我们的模型是完美的情况下，一步就将系统带到其设定点。这个基础计算揭示了自适应控制器如何利用系统估计值来制定决策的核心逻辑 [@problem_id:1608454]。", "problem": "一位工程师正在为一个简单的热过程开发一个控制系统。该过程可以用以下一阶线性离散时间差分方程来建模：\n$$y(k+1) = a y(k) + b u(k)$$\n其中，$y(k)$ 是系统在离散时间步 $k$ 的温度，$u(k)$ 是在时间步 $k$ 的控制输入（施加于加热器的电压），而 $a$ 和 $b$ 是系统未知的、恒定的物理参数。\n\n系统实现了一个自校正调节器。它由两部分组成：一个参数估计器和一个控制器。在每个时间步 $k$，一个参数估计算法会提供 $a$ 和 $b$ 的最新估计值，分别表示为 $\\hat{a}(k)$ 和 $\\hat{b}(k)$。为解决此问题，您可以将这些估计值视为在时间步 $k$ 进行计算时的给定常数，我们将其简称为 $\\hat{a}$ 和 $\\hat{b}$。\n\n控制目标是实现一种“无差拍”控制策略。该策略要求控制器选择一个输入 $u(k)$，使得系统在下一个时间步的输出 $y(k+1)$ 精确地等于一个期望的恒定设定值 $y_{ref}$。\n\n假设模型是精确的，并且参数估计是完美的（即 $\\hat{a} = a$ 且 $\\hat{b} = b$），请推导 $u(k)$ 的控制律。$u(k)$ 的表达式应该用当前测量的温度 $y(k)$、设定值 $y_{ref}$ 以及估计参数 $\\hat{a}$ 和 $\\hat{b}$ 来表示。", "solution": "给定离散时间一阶模型\n$$y(k+1) = a\\,y(k) + b\\,u(k).$$\n无差拍控制器要求下一个输出等于设定值，因此我们施加条件\n$$y(k+1) = y_{ref}.$$\n在时间步 $k$，控制器使用当前的参数估计值，我们将其视为常数 $\\hat{a}$ 和 $\\hat{b}$，并假设估计是完美的，即 $\\hat{a} = a$ 且 $\\hat{b} = b$。将模型参数替换为其估计值以进行控制设计，并强制执行无差拍要求，可得\n$$y_{ref} = \\hat{a}\\,y(k) + \\hat{b}\\,u(k).$$\n我们通过分离 $u(k)$ 来求解这个关于控制输入 $u(k)$ 的线性方程：\n$$\\hat{b}\\,u(k) = y_{ref} - \\hat{a}\\,y(k),$$\n并且，假设 $\\hat{b} \\neq 0$，\n$$u(k) = \\frac{y_{ref} - \\hat{a}\\,y(k)}{\\hat{b}}.$$\n在所述假设下，该控制律能确保 $y(k+1) = y_{ref}$ 在一个步骤内实现。", "answer": "$$\\boxed{\\frac{y_{ref} - \\hat{a}\\,y(k)}{\\hat{b}}}$$", "id": "1608454"}, {"introduction": "在现实世界中，我们的模型永远不可能是完美的。本实践探讨了模型与被控对象失配的关键问题，特别是当一个复杂的过程采用一个简化的模型（即欠参数化）时的情况。通过分析一个基于错误模型导出的固定控制器，你将计算出真实的闭环极点，并亲眼见证未建模的动态特性如何影响系统的稳定性和性能 [@problem_id:1608473]。", "problem": "一位控制系统工程师的任务是为某个化学过程设计一个自校正调节器。由于测量的限制，该工程师决定使用一阶模型结构来近似该过程的动态特性。然而，已知该真实过程表现出更复杂的二阶行为。\n\n从控制输入 $U(z)$ 到过程输出 $Y(z)$ 的真实离散时间传递函数由下式给出：\n$$G_p(z) = \\frac{Y(z)}{U(z)} = \\frac{0.36 z^{-1} - 0.18 z^{-2}}{1 - 0.9 z^{-1} + 0.08 z^{-2}}$$\n\n该自校正调节器基于以下假设和规范进行设计：\n1.  **模型结构**：调节器采用被控对象的一阶模型表示，$\\hat{G}_p(z) = \\frac{\\hat{B}(z)}{\\hat{A}(z)} = \\frac{\\hat{b} z^{-1}}{1 + \\hat{a} z^{-1}}$，其中 $\\hat{a}$ 和 $\\hat{b}$ 是待估计的参数。\n2.  **估计**：参数使用递推最小二乘 (RLS) 算法进行估计。为进行此分析，您需要假设 RLS 估计器已收敛到唯一的参数集 $(\\hat{a}, \\hat{b})$，使得模型 $\\hat{G}_p(z)$ 的脉冲响应的前两个非零项与真实被控对象 $G_p(z)$ 的脉冲响应的前两个非零项完全匹配。\n3.  **控制设计**：控制律采用确定性等效原理进行设计，其中估计参数 $(\\hat{a}, \\hat{b})$ 被视为真实的被控对象参数。目标是极点配置，期望的闭环特征多项式为 $A_m(z) = 1 - 0.5 z^{-1}$。控制器结构为 $R(z)U(z) = T(z)R_{ref}(z) - S(z)Y(z)$，其中 $R_{ref}(z)$ 是参考信号。控制器多项式 $R(z)$ 和 $S(z)$ 选择尽可能低的阶数以满足 Diophantine 方程 $\\hat{A}(z)R(z) + \\hat{B}(z)S(z) = A_m(z)$，且 $R(z)$ 选为零阶首一多项式。\n\n一旦估计器收敛，参数 $\\hat{a}$ 和 $\\hat{b}$ 将变为常数，此时自校正调节器实际上作为一个固定的线性时不变控制器运行。这个固定的控制器随后与真实的二阶被控对象 $G_p(z)$ 相互作用。请确定这个最终的、真实的闭环系统中幅值最大的闭环极点的位置。\n\n将最终答案四舍五入到四位有效数字。", "solution": "真实被控对象由离散传递函数给出\n$$G_{p}(z)=\\frac{0.36 z^{-1}-0.18 z^{-2}}{1-0.9 z^{-1}+0.08 z^{-2}}.$$\n其在输入 $u[k]$ 和输出 $y[k]$ 下的对应差分方程为\n$$y[k]-0.9\\,y[k-1]+0.08\\,y[k-2]=0.36\\,u[k-1]-0.18\\,u[k-2].$$\n对于脉冲输入 $u[0]=1$ 且当 $k\\geq 1$ 时 $u[k]=0$，在零初始条件下，其脉冲响应的前几个采样值按如下方式求得：\n- 在 $k=0$ 时：$y[0]=0$。\n- 在 $k=1$ 时：$y[1]-0.9\\,y[0]+0.08\\,y[-1]=0.36\\,u[0]-0.18\\,u[-1]=0.36$，因此 $y[1]=0.36$。\n- 在 $k=2$ 时：$y[2]-0.9\\,y[1]+0.08\\,y[0]=0.36\\,u[1]-0.18\\,u[0]=-0.18$，因此 $y[2]=-0.18+0.9\\cdot 0.36=0.144$。\n\n因此，$G_{p}(z)$ 的前两个非零脉冲响应项是 $0.36$ 和 $0.144$。\n\n调节器所使用的模型为\n$$\\hat{G}_{p}(z)=\\frac{\\hat{b} z^{-1}}{1+\\hat{a} z^{-1}},$$\n其对应的差分方程为\n$$y[k]+\\hat{a}\\,y[k-1]=\\hat{b}\\,u[k-1].$$\n对于脉冲输入，可得\n- $y[0]=0$,\n- $y[1]=\\hat{b}$,\n- $y[2]=-\\hat{a}\\,\\hat{b}$。\n\n将前两个非零项与真实被控对象匹配，可得\n$$\\hat{b}=0.36,\\qquad -\\hat{a}\\hat{b}=0.144\\;\\Rightarrow\\;\\hat{a}=-\\frac{0.144}{0.36}=-0.4.$$\n\n控制器通过确定性等效原理和 Diophantine 方程进行设计\n$$\\hat{A}(z)R(z)+\\hat{B}(z)S(z)=A_{m}(z),$$\n其中 $\\hat{A}(z)=1+\\hat{a} z^{-1}=1-0.4 z^{-1}$，$\\hat{B}(z)=\\hat{b} z^{-1}=0.36 z^{-1}$，$A_{m}(z)=1-0.5 z^{-1}$，且 $R(z)$ 是零阶首一多项式，所以 $R(z)=1$。为 $S(z)$ 选择尽可能低的阶数，取 $S(z)=s_{0}$ (一个常数)。那么\n$$(1-0.4 z^{-1})+0.36 s_{0} z^{-1}=1-0.5 z^{-1},$$\n这给出了 $z^{-1}$ 的系数方程\n$$-0.4+0.36 s_{0}=-0.5\\;\\Rightarrow\\;0.36 s_{0}=-0.1\\;\\Rightarrow\\;s_{0}=-\\frac{5}{18}.$$\n\n一旦固定，该控制器作用于真实被控对象。将真实被控对象写成多项式形式 $A_{\\text{t}}(z)Y(z)=B_{\\text{t}}(z)U(z)$，其中\n$$A_{\\text{t}}(z)=1-0.9 z^{-1}+0.08 z^{-2},\\qquad B_{\\text{t}}(z)=0.36 z^{-1}-0.18 z^{-2},$$\n并使用调节控制律 $U(z)=-S(z)Y(z)$（参考路径不影响极点），真实的闭环特征多项式为\n$$A_{\\text{cl}}(z)=A_{\\text{t}}(z)+B_{\\text{t}}(z)S(z).$$\n当 $S(z)=s_{0}=-\\frac{5}{18}$ 时，\n$$B_{\\text{t}}(z)S(z)=\\left(0.36 z^{-1}-0.18 z^{-2}\\right)\\left(-\\frac{5}{18}\\right)=-0.1\\,z^{-1}+0.05\\,z^{-2}.$$\n因此，\n$$A_{\\text{cl}}(z)=1-\\left(0.9+0.1\\right)z^{-1}+\\left(0.08+0.05\\right)z^{-2}=1-1.0\\,z^{-1}+0.13\\,z^{-2}.$$\n乘以 $z^{2}$ 得到特征方程\n$$z^{2}-z+0.13=0.$$\n其根为\n$$z=\\frac{1\\pm\\sqrt{1-4\\cdot 0.13}}{2}=\\frac{1\\pm\\sqrt{0.48}}{2}.$$\n由于 $\\sqrt{0.48}\\approx 0.692820323$，极点约为 $0.8464101615$ 和 $0.1535898385$。幅值最大的极点约为 $0.8464101615$，四舍五入到四位有效数字后为 $0.8464$。", "answer": "$$\\boxed{0.8464}$$", "id": "1608473"}, {"introduction": "为了构建鲁棒的自适应系统，我们需要防范参数估计中不可避免的误差。本练习引入了监控控制的概念，它是一个监控调节器性能的实用逻辑层。你将逐步模拟系统，以确定何时冻结参数更新，这是一种在模型预测与现实偏离时防止系统失稳的关键技术 [@problem_id:1608433]。", "problem": "一个自整定调节器被用于一个过程，其真实动态特性对于控制器设计者而言是未知的。该调节器由一个参数估计器和一个控制器组成。参数估计器试图为该过程辨识一个一阶模型，而过程本身已知是更高阶的，这造成了结构性的模型-对象不匹配。\n\n真实的过程动态特性由以下二阶离散时间方程描述：\n$$y(k) = 0.8 y(k-1) + 0.1 y(k-2) + 0.5 u(k-1)$$\n其中 $y(k)$ 是过程输出，$u(k)$ 是在时间步 $k$ 的控制输入。初始条件为对于所有 $k \\leq 0$，都有 $y(k) = 0$ 和 $u(k) = 0$。\n\n该自整定调节器基于一个假定的一阶模型：\n$$\\hat{y}(k|k-1) = \\hat{a}(k-1) y(k-1) + \\hat{b}(k-1) u(k-1) = \\phi^T(k-1) \\theta_e(k-1)$$\n其中 $\\hat{y}(k|k-1)$ 是输出的一步超前预测，$\\phi(k-1) = [y(k-1), u(k-1)]^T$ 是回归向量，$\\theta_e(k) = [\\hat{a}(k), \\hat{b}(k)]^T$ 是估计参数的向量。\n\n$\\theta_e(k)$ 中的参数在每个时间步 $k \\geq 1$ 使用带有遗忘因子 $\\lambda = 0.98$ 的递归最小二乘 (RLS) 算法进行更新。初始参数估计为 $\\theta_e(0) = [0.9, 0.5]^T$，初始协方差矩阵为 $P(0) = 10I$，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n\n控制律是一个直接自适应控制器，其设计目的是使输出 $y(k)$ 跟踪参考信号 $r(k)$。控制输入计算如下：\n$$u(k) = \\frac{1}{\\hat{b}(k)} (r(k+1) - \\hat{a}(k) y(k))$$\n参考信号是一个单位阶跃，即对于所有 $k \\ge 1$，有 $r(k) = 1.0$。\n\n为了在模型明显不适用时防止参数漂移和不稳定性，增加了一个监控逻辑层。如果模型的预测性能显着下降，该逻辑将冻结RLS参数更新。在时间步 $k_f$ 冻结更新的条件是，一步超前预测误差 $\\epsilon(j) = y(j) - \\hat{y}(j|j-1)$ 的幅值连续 $N=2$ 个时间步超过阈值 $\\epsilon_{max} = 0.05$。\n\n确定参数估计被冻结的最小整数时间步 $k_f \\geq N$。", "solution": "真实的受控对象是\n$$y(k)=0.8\\,y(k-1)+0.1\\,y(k-2)+0.5\\,u(k-1),$$\n估计器使用的一步预测器是\n$$\\hat{y}(k|k-1)=\\hat{a}(k-1)\\,y(k-1)+\\hat{b}(k-1)\\,u(k-1)=\\phi^{T}(k-1)\\,\\theta_{e}(k-1),\\quad \\phi(k-1)=\\begin{bmatrix}y(k-1)\\\\ u(k-1)\\end{bmatrix}.$$\n每个时间步带遗忘因子的RLS更新如下\n$$\\epsilon(k)=y(k)-\\phi^{T}(k-1)\\,\\theta_{e}(k-1),$$\n$$S(k)=\\lambda+\\phi^{T}(k-1)\\,P(k-1)\\,\\phi(k-1),\\quad K(k)=\\frac{P(k-1)\\,\\phi(k-1)}{S(k)},$$\n$$\\theta_{e}(k)=\\theta_{e}(k-1)+K(k)\\,\\epsilon(k),\\quad P(k)=\\frac{1}{\\lambda}\\left[P(k-1)-K(k)\\,\\phi^{T}(k-1)\\,P(k-1)\\right],$$\n其中 $\\lambda=0.98$，$\\theta_{e}(0)=\\begin{bmatrix}0.9\\\\ 0.5\\end{bmatrix}$，$P(0)=10I$。控制律为\n$$u(k)=\\frac{1}{\\hat{b}(k)}\\left(r(k+1)-\\hat{a}(k)\\,y(k)\\right),\\quad r(k)=1\\ \\text{for}\\ k\\geq 1.$$\n根据构造，在控制律中使用 $\\theta_{e}(k)$ 可得，对于 $k\\geq 0$，有 $\\hat{y}(k+1|k)=\\hat{a}(k)\\,y(k)+\\hat{b}(k)\\,u(k)=r(k+1)=1$。\n\n我们从初始条件 $y(k)=0$，$u(k)=0$ (对于 $k\\leq 0$) 开始递推。\n\n步骤 k=0 到 k=1:\n- 控制: $u(0)=\\frac{1}{0.5}\\left(r(1)-0.9\\,y(0)\\right)=2$。\n- 对象: $y(1)=0.8\\,y(0)+0.1\\,y(-1)+0.5\\,u(0)=1$。\n- 预测: $\\hat{y}(1|0)=0.9\\,y(0)+0.5\\,u(0)=1$。\n- 误差: $\\epsilon(1)=y(1)-\\hat{y}(1|0)=0$。\n- 使用 $\\phi(0)=\\begin{bmatrix}0\\\\ 2\\end{bmatrix}$ 进行RLS更新:\n$$S(1)=\\lambda+\\phi^{T}(0)P(0)\\phi(0)=0.98+10\\cdot 4=40.98,$$\n$$K(1)=\\frac{P(0)\\phi(0)}{S(1)}=\\frac{10I\\,\\begin{bmatrix}0\\\\ 2\\end{bmatrix}}{40.98}=\\begin{bmatrix}0\\\\ 20/40.98\\end{bmatrix},$$\n$$\\theta_{e}(1)=\\theta_{e}(0)+K(1)\\epsilon(1)=\\begin{bmatrix}0.9\\\\ 0.5\\end{bmatrix},$$\n$$P(1)=\\frac{1}{0.98}\\left[10I-K(1)\\,\\phi^{T}(0)\\,10I\\right]=\\frac{1}{0.98}\\begin{bmatrix}10 & 0\\\\ 0 & 10-\\frac{400}{40.98}\\end{bmatrix}\\approx\\begin{bmatrix}10.20408 & 0\\\\ 0 & 0.24404\\end{bmatrix}.$$\n\n步骤 k=1 到 k=2:\n- 控制: $u(1)=\\frac{1}{0.5}(1-0.9\\,y(1))=0.2$。\n- 对象: $y(2)=0.8\\,y(1)+0.1\\,y(0)+0.5\\,u(1)=0.9$。\n- 预测: $\\hat{y}(2|1)=0.9\\,y(1)+0.5\\,u(1)=1$。\n- 误差: $\\epsilon(2)=y(2)-\\hat{y}(2|1)=-0.1$，因此 $|\\epsilon(2)|=0.1>\\epsilon_{\\max}=0.05$ (第一次超过阈值)。\n- 使用 $\\phi(1)=\\begin{bmatrix}1\\\\ 0.2\\end{bmatrix}$ 进行RLS更新:\n$$S(2)=0.98+\\phi^{T}(1)P(1)\\phi(1)=0.98+10.20408+0.24404\\cdot 0.04\\approx 11.1938416,$$\n$$K(2)=\\frac{P(1)\\phi(1)}{S(2)}=\\frac{\\begin{bmatrix}10.20408\\\\ 0.24404\\cdot 0.2\\end{bmatrix}}{11.1938416}\\approx\\begin{bmatrix}0.911464\\\\ 0.004362\\end{bmatrix},$$\n$$\\theta_{e}(2)=\\theta_{e}(1)+K(2)\\epsilon(2)\\approx\\begin{bmatrix}0.9\\\\ 0.5\\end{bmatrix}+\\begin{bmatrix}0.911464\\\\ 0.004362\\end{bmatrix}(-0.1)\\approx\\begin{bmatrix}0.808854\\\\ 0.499564\\end{bmatrix}.$$\n\n步骤 k=2 到 k=3:\n- 使用 $\\theta_{e}(2)$ 和 $y(2)=0.9$ 进行控制:\n$$u(2)=\\frac{1}{0.499564}\\left(1-0.808854\\cdot 0.9\\right)\\approx 0.54454.$$\n- 对象:\n$$y(3)=0.8\\,y(2)+0.1\\,y(1)+0.5\\,u(2)=0.8\\cdot 0.9+0.1\\cdot 1+0.5\\cdot 0.54454\\approx 1.09227.$$\n- 预测: $\\hat{y}(3|2)=1$ (根据控制律)。\n- 误差: $\\epsilon(3)=y(3)-\\hat{y}(3|2)\\approx 1.09227-1=0.09227$，因此 $|\\epsilon(3)|\\approx 0.09227>0.05$。\n\n因此，在两个连续的时间步发生 $|\\epsilon(2)|>0.05$ 和 $|\\epsilon(3)|>0.05$。\n因此，满足监控条件的最小 $k_{f}\\geq N$ 是 $k_{f}=3$ (冻结发生在观察到第二次连续超过阈值时)。", "answer": "$$\\boxed{3}$$", "id": "1608433"}]}