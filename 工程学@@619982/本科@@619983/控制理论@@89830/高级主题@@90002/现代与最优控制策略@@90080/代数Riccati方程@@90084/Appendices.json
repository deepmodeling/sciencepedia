{"hands_on_practices": [{"introduction": "理解代数Riccati方程（ARE）的最佳方式是从最简单的情形入手：一个一阶（标量）系统。这将复杂的矩阵方程简化为一个熟悉的二次代数方程，让你能够在不被矩阵运算困扰的情况下，专注于理解方程的结构和求解过程。通过这个练习，你将为处理更复杂的系统打下坚实的基础 [@problem_id:1557202]。", "problem": "考虑一个由一阶常微分方程描述的标量线性时不变 (LTI) 系统：\n$$\n\\dot{x}(t) = a x(t) + b u(t)\n$$\n其中 $x(t)$ 是系统状态，$u(t)$ 是控制输入。系统的性能通过一个需要被最小化的无限时域二次型代价函数来评估：\n$$\nJ = \\int_{0}^{\\infty} \\left( q x^2(t) + r u^2(t) \\right) dt\n$$\n最小化此代价函数的最优控制律是一个形式为 $u(t) = -Kx(t)$ 的线性状态反馈控制器。常数增益 $K$ 由相应的 Riccati 方程的唯一正常数稳态解（表示为标量 $p$）来确定。\n\n给定系统参数 $a = 2$，$b = 3$ 和代价函数加权因子 $q = 4$ 及 $r = 1$，确定此正常数解 $p$ 的值。\n\n将最终答案四舍五入至三位有效数字。", "solution": "对于一个连续时间标量 LTI 系统 $\\dot{x}(t) = a x(t) + b u(t)$，其代价函数为 $J = \\int_{0}^{\\infty} \\left(q x^{2}(t) + r u^{2}(t)\\right) dt$，稳态代数 Riccati 方程由下式给出\n$$\nA^{T} P + P A - P B R^{-1} B^{T} P + Q = 0.\n$$\n在标量情况下，$A = a$，$B = b$，$Q = q$，$R = r$，且 $P = p$，因此方程简化为\n$$\n2 a p - \\frac{b^{2}}{r} p^{2} + q = 0.\n$$\n将其重写为关于 $p$ 的标准二次方程，\n$$\n\\frac{b^{2}}{r} p^{2} - 2 a p - q = 0.\n$$\n应用求根公式，\n$$\np = \\frac{2 a \\pm \\sqrt{(2 a)^{2} + 4 \\frac{b^{2}}{r} q}}{2 \\frac{b^{2}}{r}} = \\frac{a \\pm \\sqrt{a^{2} + \\frac{b^{2}}{r} q}}{\\frac{b^{2}}{r}} = \\frac{r}{b^{2}}\\left(a \\pm \\sqrt{a^{2} + \\frac{b^{2}}{r} q}\\right).\n$$\n正的稳定解对应于正号。代入 $a = 2$，$b = 3$，$q = 4$，$r = 1$，\n$$\np = \\frac{1}{9}\\left(2 + \\sqrt{4 + 36}\\right) = \\frac{1}{9}\\left(2 + \\sqrt{40}\\right) = \\frac{1}{9}\\left(2 + 2\\sqrt{10}\\right).\n$$\n数值上，当四舍五入到三位有效数字时，其计算结果为 $p \\approx 0.925$。", "answer": "$$\\boxed{0.925}$$", "id": "1557202"}, {"introduction": "掌握了标量系统后，下一步是进入多变量系统的领域。直接求解矩阵形式的ARE可能相当复杂，但验证一个已知的解是一个绝佳的练习，可以帮助你熟悉ARE的矩阵形式以及所需的矩阵运算。这个实践将加强你对高阶系统Riccati方程结构的理解 [@problem_id:1557248]。", "problem": "在为一个线性时不变系统设计最优控制器时，一位控制工程师正在使用线性二次型调节器 (LQR) 框架。该系统由状态空间方程 $\\dot{x}(t) = Ax(t) + Bu(t)$ 描述，其矩阵如下：\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\nLQR 设计旨在最小化一个代价函数，该函数取决于状态权重矩阵 $Q$ 和控制权重矩阵 $R$，具体如下：\n$$\nQ = \\begin{pmatrix} 5 & 3 \\\\ 3 & 5 \\end{pmatrix}, \\quad R = 1\n$$\n寻找最优控制律的一个关键步骤是，针对一个对称正定矩阵 $P$ 求解连续时间代数Riccati方程 (ARE)。该 ARE 方程如下：\n$$\nA^T P + P A - P B R^{-1} B^T P + Q = \\mathbf{0}\n$$\n其中 $\\mathbf{0}$ 是一个具有适当维度的零矩阵。\n\n一位实习工程师提出了一个候选矩阵 $P_{cand}$ 作为此 ARE 的一个可能解：\n$$\nP_{cand} = \\begin{pmatrix} 3 & 1 \\\\ 1 & 1 \\end{pmatrix}\n$$\n你的任务是验证该实习工程师提出的矩阵 $P_{cand}$ 是否是给定系统的代数Riccati方程的正确解。下列哪个陈述是正确的？\n\nA. 是的，当代入 $P_{cand}$ 时，方程完全成立。\n\nB. 不是，方程的左侧计算结果为零矩阵，但所提出的矩阵 $P_{cand}$ 不是对称的。\n\nC. 不是，方程的左侧计算结果为一个非零矩阵。\n\nD. 不是，由于控制权重矩阵 $R$ 不可逆，因此无法进行计算。", "solution": "我们必须验证候选矩阵 $P_{cand}$ 是否满足连续时间代数Riccati方程\n$$\nA^{T}P + P A - P B R^{-1} B^{T} P + Q = \\mathbf{0},\n$$\n对于给定的\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad Q = \\begin{pmatrix} 5 & 3 \\\\ 3 & 5 \\end{pmatrix}, \\quad R = 1,\n$$\n和\n$$\nP_{cand} = \\begin{pmatrix} 3 & 1 \\\\ 1 & 1 \\end{pmatrix}.\n$$\n首先，注意 $P_{cand}$ 是对称的。此外，由于 $R=1$，我们有 $R^{-1}=1$，这是有定义的，因此可以进行计算。\n\n计算 ARE 中的每一项：\n1) 计算 $A^{T}P_{cand}$：\n$$\nA^{T} = \\begin{pmatrix} 0 & -2 \\\\ 1 & -3 \\end{pmatrix}, \\quad\nA^{T}P_{cand} = \\begin{pmatrix} 0 & -2 \\\\ 1 & -3 \\end{pmatrix} \\begin{pmatrix} 3 & 1 \\\\ 1 & 1 \\end{pmatrix}\n= \\begin{pmatrix} -2 & -2 \\\\ 0 & -2 \\end{pmatrix}.\n$$\n\n2) 计算 $P_{cand}A$：\n$$\nP_{cand}A = \\begin{pmatrix} 3 & 1 \\\\ 1 & 1 \\end{pmatrix} \\begin{pmatrix} 0 & 1 \\\\ -2 & -3 \\end{pmatrix}\n= \\begin{pmatrix} -2 & 0 \\\\ -2 & -2 \\end{pmatrix}.\n$$\n\n3) 将前两项相加：\n$$\nA^{T}P_{cand} + P_{cand}A = \\begin{pmatrix} -2 & -2 \\\\ 0 & -2 \\end{pmatrix} + \\begin{pmatrix} -2 & 0 \\\\ -2 & -2 \\end{pmatrix}\n= \\begin{pmatrix} -4 & -2 \\\\ -2 & -4 \\end{pmatrix}.\n$$\n\n4) 计算项 $P_{cand} B R^{-1} B^{T} P_{cand}$。由于 $R^{-1}=1$，\n$$\nP_{cand}B = \\begin{pmatrix} 3 & 1 \\\\ 1 & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n= \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\quad\nB^{T}P_{cand} = \\begin{pmatrix} 0 & 1 \\end{pmatrix} \\begin{pmatrix} 3 & 1 \\\\ 1 & 1 \\end{pmatrix}\n= \\begin{pmatrix} 1 & 1 \\end{pmatrix},\n$$\n因此\n$$\nP_{cand} B R^{-1} B^{T} P_{cand} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1 & 1 \\end{pmatrix}\n= \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}.\n$$\n\n5) 构造 ARE 的左侧：\n$$\nA^{T}P_{cand} + P_{cand}A - P_{cand} B R^{-1} B^{T} P_{cand} + Q\n= \\begin{pmatrix} -4 & -2 \\\\ -2 & -4 \\end{pmatrix} - \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix} + \\begin{pmatrix} 5 & 3 \\\\ 3 & 5 \\end{pmatrix}.\n$$\n合并矩阵：\n$$\n\\begin{pmatrix} -4 & -2 \\\\ -2 & -4 \\end{pmatrix} - \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}\n= \\begin{pmatrix} -5 & -3 \\\\ -3 & -5 \\end{pmatrix},\n$$\n然后\n$$\n\\begin{pmatrix} -5 & -3 \\\\ -3 & -5 \\end{pmatrix} + \\begin{pmatrix} 5 & 3 \\\\ 3 & 5 \\end{pmatrix}\n= \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}.\n$$\n\n因此，左侧恰好等于零矩阵，所以 $P_{cand}$ 满足 ARE。由于 $P_{cand}$ 是对称的且 $R$ 可逆，正确的选项是当代入 $P_{cand}$ 时，方程完全成立。", "answer": "$$\\boxed{A}$$", "id": "1557248"}, {"introduction": "求解ARE的最终目的是设计一个最优控制器。这最后一个练习将填补理论解 $P$ 与实际控制律 $u = -Kx$ 之间的鸿沟。通过从给定的 $P$ 矩阵计算最优增益矩阵 $K$，你将亲眼看到ARE如何直接应用于构建状态反馈控制器，从而完成从理论到实践的关键一步 [@problem_id:1557238]。", "problem": "在一个连续时间线性系统的线性二次调节器 (LQR) 设计中，状态反馈控制律由 $u = -Kx$ 给出，其中 $x$ 是状态向量，$u$ 是控制输入。最优反馈增益矩阵 $K$ 由相关的代数黎卡提方程 (ARE) 的解确定。\n\n考虑一个双状态系统，其代数黎卡提方程的唯一正定对称解 $P$ 已被计算得出。矩阵 $P$、系统的控制输入矩阵 $B$ 以及标量控制权重 $R$ 如下所示：\n\n$$\nP = \\begin{pmatrix} 6 & 2 \\\\ 2 & 3 \\end{pmatrix}\n$$\n\n$$\nB = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n\n$$\nR = 4\n$$\n\n计算状态反馈增益矩阵 $K$。您的答案应以行矩阵的形式呈现。", "solution": "对于包含状态权重 $Q$ 和控制权重 $R$ 的代价泛函的连续时间 LQR，最优状态反馈律 $u=-Kx$ 使用\n$$\nK = R^{-1} B^{\\top} P,\n$$\n其中 $P$ 是代数黎卡提方程的唯一正定解，$B$ 是输入矩阵。\n\n已知\n$$\nP = \\begin{pmatrix} 6 & 2 \\\\ 2 & 3 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\quad R = 4,\n$$\n我们计算\n$$\nB^{\\top} P = \\begin{pmatrix} 1 & 1 \\end{pmatrix} \\begin{pmatrix} 6 & 2 \\\\ 2 & 3 \\end{pmatrix} = \\begin{pmatrix} 6+2 & 2+3 \\end{pmatrix} = \\begin{pmatrix} 8 & 5 \\end{pmatrix}.\n$$\n因为 $R$ 是一个标量，所以 $R^{-1} = \\frac{1}{4}$，因此\n$$\nK = R^{-1} B^{\\top} P = \\frac{1}{4} \\begin{pmatrix} 8 & 5 \\end{pmatrix} = \\begin{pmatrix} 2 & \\frac{5}{4} \\end{pmatrix}.\n$$\n因此，状态反馈增益矩阵是如上所示的行矩阵。", "answer": "$$\\boxed{\\begin{pmatrix} 2 & \\frac{5}{4} \\end{pmatrix}}$$", "id": "1557238"}]}