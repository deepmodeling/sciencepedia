{"hands_on_practices": [{"introduction": "这个练习探讨了如何在最短时间内将一个物体（如此处的空间站吊杆）从一个静止状态转移到另一个静止状态。这个问题是双积分器系统时间最优控制的经典范例，其解引出了著名的“bang-bang”控制策略。通过解决这个问题[@problem_id:1585098]，你将亲身体验最优控制理论一个最基本且深刻的结论：最快的路径往往需要我们尽全力加速，然后尽全力减速。", "problem": "作为一名控制工程师，您的任务是为两个机械臂设计一个时间最优机动，以在空间站上重新定位一个长而精密的仪器臂。\n\n该仪器臂被建模为一个均匀的刚性杆，它可以在一个平面内围绕其在空间中保持固定的质心旋转。它的方向由其与一个固定参考轴所成的角度 $\\theta(t)$ 来描述。机械臂可以共同对该仪器臂施加一个受控的净力矩，从而产生角加速度 $\\alpha(t) = \\ddot{\\theta}(t)$。\n\n该机动必须从静止状态开始，初始角度为 $\\theta(0) = 0$，并将仪器臂带到一个最终的目标角度 $\\theta_f > 0$。在机动结束时，该仪器臂也必须处于静止状态。\n\n一个关键的约束是该仪器臂的结构完整性。已知最大内部弯矩的大小 $B$ 与角加速度的大小成正比，即 $B = k |\\alpha|$，其中 $k$ 是一个正的比例常数。为了防止结构失效，这个弯矩不得超过一个临界值 $B_{max}$。这对角加速度的最大允许值施加了一个限制，即 $|\\alpha(t)| \\le \\alpha_{max}$，其中 $\\alpha_{max} = B_{max}/k$。\n\n您的任务是确定完成此重新定向机动所需的最短可能时间 $t_f$。\n\n将您的答案表示为一个关于 $\\theta_f$ 和 $\\alpha_{max}$ 的单一闭式解析表达式。假设所有角度均以弧度为单位测量。", "solution": "旋转运动学由状态方程 $\\dot{\\theta}=\\omega$ 和 $\\dot{\\omega}=\\alpha$ 描述，控制约束为 $|\\alpha(t)|\\leq \\alpha_{max}$。边界条件为 $\\theta(0)=0$, $\\omega(0)=0$ 和 $\\theta(t_{f})=\\theta_{f}>0$, $\\omega(t_{f})=0$。\n\n对于一个控制集为由 $|\\alpha|\\leq \\alpha_{max}$ 界定的凸集的双积分器系统的最短时间转移问题，最优控制几乎处处达到饱和边界（“砰-砰”控制）。从静止开始并以静止结束，且位移为正，这意味着控制只进行一次切换：首先取 $\\alpha=\\alpha_{max}$ 以增加角速度，然后在恰好到达 $\\theta=\\theta_{f}$ 时，取 $\\alpha=-\\alpha_{max}$ 将角速度降回零。任何 $|\\alpha|<\\alpha_{max}$ 的时间段都会增加总时间，而无助于满足约束。\n\n在 $0\\leq t\\leq t_{s}$ 期间，取 $\\alpha=\\alpha_{max}$。积分可得 $\\omega(t)=\\alpha_{max} t$ 和 $\\theta(t)=\\frac{1}{2}\\alpha_{max} t^{2}$。在切换时刻 $t_{s}$，状态为 $\\omega_{s}=\\alpha_{max} t_{s}$ 和 $\\theta_{s}=\\frac{1}{2}\\alpha_{max} t_{s}^{2}$。\n\n在 $t_{s}\\leq t\\leq t_{f}$ 期间，取 $\\alpha=-\\alpha_{max}$。于是 $\\omega(t)=\\omega_{s}-\\alpha_{max}(t-t_{s})$。令 $\\omega(t_{f})=0$ 可得 $t_{f}-t_{s}=\\omega_{s}/\\alpha_{max}=t_{s}$，因此 $t_{f}=2 t_{s}$。减速期间转过的角度是 $\\omega(t)$ 曲线下的面积：\n$$\n\\theta_{decel}=\\int_{t_{s}}^{t_{f}}\\omega(t)\\,dt=\\omega_{s}(t_{f}-t_{s})-\\frac{1}{2}\\alpha_{max}(t_{f}-t_{s})^{2}=\\alpha_{max} t_{s}^{2}-\\frac{1}{2}\\alpha_{max} t_{s}^{2}=\\frac{1}{2}\\alpha_{max} t_{s}^{2}.\n$$\n因此总角度为\n$$\n\\theta_{f}=\\theta_{s}+\\theta_{decel}=\\frac{1}{2}\\alpha_{max} t_{s}^{2}+\\frac{1}{2}\\alpha_{max} t_{s}^{2}=\\alpha_{max} t_{s}^{2}.\n$$\n解出 $t_{s}$ 可得 $t_{s}=\\sqrt{\\theta_{f}/\\alpha_{max}}$，最小机动时间为\n$$\nt_{f}=2 t_{s}=2\\sqrt{\\frac{\\theta_{f}}{\\alpha_{max}}}.\n$$\n此结果满足所有约束，并在角加速度界限 $|\\alpha|\\leq \\alpha_{max}$ 下实现了最短时间。", "answer": "$$\\boxed{2\\sqrt{\\frac{\\theta_{f}}{\\alpha_{max}}}}$$", "id": "1585098"}, {"introduction": "在上一个问题探索了“最快”之后，这个练习将我们的目标切换为“最节能”。我们来设计一个起重机的控制策略，使其在规定时间内平稳地移动负载，同时消耗最少的电能。这个问题[@problem_id:1585060]是线性二次型调节器（LQR）问题的一个典型实例，它教你如何运用庞特里亚金极大值原理来系统地解决工程师在实践中经常遇到的能量优化问题。", "problem": "一台自动化龙门起重机的任务是移动一个质量为 $m$ 的有效载荷。其运动被限制在用坐标 $x$ 表示的单一水平轴上。起重机的电机对被建模为质点的有效载荷施加一个时变力 $u(t)$，由此可得运动方程 $\\ddot{x}(t) = u(t)/m$。\n\n起重机必须在固定的时间 $T$ 内，将有效载荷从初始位置 $x(0) = 0$ 且初始速度为零 $\\dot{x}(0) = 0$ 处，运送至最终目的地 $x(T) = L$。在目的地，有效载荷必须完全停止，因此其最终速度必须为零，即 $\\dot{x}(T) = 0$。\n\n为确保平稳运行并最小化电能消耗，控制目标是找到能使由下式给出的代价泛函 $J$ 最小化的力函数 $u(t)$：\n$$J = \\int_{0}^{T} u^2(t) dt$$\n\n求解完成此任务所需的最优控制力 $u^*(t)$，并将其表示为时间 $t$、质量 $m$、最终位置 $L$ 和总时间 $T$ 的函数。", "solution": "我们将有效载荷建模为质点，其状态变量为 $x$ 和 $v=\\dot{x}$，控制输入为 $u(t)$，满足以下动力学方程\n$$\n\\dot{x}=v,\\qquad \\dot{v}=\\frac{u}{m},\n$$\n边界条件为 $x(0)=0$，$v(0)=0$，$x(T)=L$ 以及 $v(T)=0$。需要最小化的代价为\n$$\nJ=\\int_{0}^{T} u^{2}(t)\\,dt.\n$$\n这是一个具有固定终端状态的线性二次最优控制问题。根据庞特里亚金最小值原理 (Pontryagin’s Minimum Principle)，定义哈密顿函数\n$$\nH=u^{2}+\\lambda_{1} v+\\lambda_{2}\\frac{u}{m},\n$$\n其中 $\\lambda_{1}$ 和 $\\lambda_{2}$ 是协态变量。平稳性条件 $\\partial H/\\partial u=0$ 给出\n$$\n2u+\\frac{\\lambda_{2}}{m}=0 \\quad \\Rightarrow \\quad u^*(t)=-\\frac{\\lambda_{2}(t)}{2m}.\n$$\n协态动力学方程为\n$$\n\\dot{\\lambda}_{1}=-\\frac{\\partial H}{\\partial x}=0 \\quad \\Rightarrow \\quad \\lambda_{1}(t)=c_{1},\n$$\n$$\n\\dot{\\lambda}_{2}=-\\frac{\\partial H}{\\partial v}=-\\lambda_{1}=-c_{1} \\quad \\Rightarrow \\quad \\lambda_{2}(t)=-c_{1} t+c_{2},\n$$\n其中 $c_{1}$ 和 $c_{2}$ 为常数。因此，最优控制具有如下仿射形式\n$$\nu^*(t)=\\frac{c_{1} t-c_{2}}{2m}.\n$$\n将 $u^*$ 代入系统动力学方程，\n$$\n\\dot{v}=\\frac{u^{*}}{m}=\\frac{c_{1} t-c_{2}}{2 m^{2}},\n$$\n利用 $v(0)=0$ 积分可得\n$$\nv(t)=\\frac{c_{1}}{4 m^{2}} t^{2}-\\frac{c_{2}}{2 m^{2}} t.\n$$\n利用 $x(0)=0$ 再次积分可得\n$$\nx(t)=\\frac{c_{1}}{12 m^{2}} t^{3}-\\frac{c_{2}}{4 m^{2}} t^{2}.\n$$\n代入终端条件。首先，由 $v(T)=0$ 可得\n$$\n0=\\frac{c_{1}}{4 m^{2}} T^{2}-\\frac{c_{2}}{2 m^{2}} T \\quad \\Rightarrow \\quad c_{2}=\\frac{c_{1} T}{2}.\n$$\n其次，由 $x(T)=L$ 可得\n$$\nL=\\frac{c_{1}}{12 m^{2}} T^{3}-\\frac{1}{4 m^{2}}\\left(\\frac{c_{1} T}{2}\\right) T^{2}\n=\\frac{c_{1} T^{3}}{12 m^{2}}-\\frac{c_{1} T^{3}}{8 m^{2}}\n=-\\frac{c_{1} T^{3}}{24 m^{2}},\n$$\n因此\n$$\nc_{1}=-\\frac{24 m^{2} L}{T^{3}}, \\qquad c_{2}=-\\frac{12 m^{2} L}{T^{2}}.\n$$\n将这些常数代入 $u^*(t)=(c_1 t - c_2)/(2m)$ 的表达式可得\n$$\nu^*(t)=\\frac{1}{2m}\\left(-\\frac{24 m^{2} L}{T^{3}} t+\\frac{12 m^{2} L}{T^{2}}\\right)\n=\\frac{12 m L}{T^{3}}\\left(\\frac{T}{2}-t\\right).\n$$\n此 $u^*(t)$ 是时间的线性函数，在 $t<T/2$ 时加速，在 $t>T/2$ 时减速。它满足边界条件，并且由于被积函数是凸函数以及动力学是线性的，该解可使 $J$ 最小化。", "answer": "$$\\boxed{\\frac{12 m L}{T^{3}}\\left(\\frac{T}{2}-t\\right)}$$", "id": "1585060"}, {"introduction": "最优控制理论的威力远不止于机械和电子系统。这个练习将带你进入生态学领域，解决一个关于控制入侵物种数量的实际问题。你将面对一个非线性的种群动态模型，并学习使用一种强大的分析工具——线性化——来简化问题并找到一个有效的干预策略[@problem_id:1585105]。这展示了如何将控制理论的核心思想应用于更广泛、更复杂的现实世界挑战中。", "problem": "一队保护生态学家正负责控制一种入侵物种，其种群数量 $N(t)$（以千为单位）遵循一个具有强Allee效应的逻辑斯蒂模型。在没有干预的情况下，种群的变化率由以下方程描述：\n$$ \\frac{dN}{dt} = R N \\left(1 - \\frac{N}{K}\\right) \\left(\\frac{N}{A} - 1\\right) $$\n其中时间 $t$ 的单位为年。在一个特定的生态系统中，该物种的参数如下：\n- Allee阈值，$A = 10$ (千个体)\n- 环境承载力，$K = 100$ (千个体)\n- 增长率常数，$R = \\frac{5}{9} \\text{ 年}^{-1}$\n\nAllee阈值 $A$ 是一个关键的种群水平，低于该水平，种群的增长率将变为负值，导致其自然崩溃。当前种群数量估计为 $N_0 = 12$ 千个体。\n\n为了根除该物种，团队决定实施一个恒定的移除（捕获）率，记为 $u$，单位为千个体/年。目标是找到最小的恒定移除率 $u$，使得种群数量能在恰好 $T = 5$ 年内从其初始水平 $N_0$ 减少到Allee阈值 $A$。\n\n为使问题易于解析处理，你可以假设，由于初始种群 $N_0$ 接近Allee阈值 $A$，在相关区间 $[A, N_0]$ 上的种群动态可以通过在Allee阈值 $N=A$ 附近对自然增长率函数进行线性化来精确近似。\n\n计算最小恒定移除率 $u$。答案以千个体/年为单位，并四舍五入到三位有效数字。", "solution": "将自然增长率定义为 $f(N) = R N \\left(1 - \\frac{N}{K}\\right)\\left(\\frac{N}{A} - 1\\right)$。在以恒定速率 $u$（单位：千个体/年）进行移除时，受控的动态系统为\n$$\n\\frac{dN}{dt} = f(N) - u.\n$$\n由于 $N_{0}$ 接近 $A$，我们在 $N=A$ 处对 $f(N)$ 进行线性化。首先，将 $f(N)$ 写为\n$$\nf(N) = \\frac{R}{A}\\,N\\left(1 - \\frac{N}{K}\\right)(N - A).\n$$\n令 $g(N) = N\\left(1 - \\frac{N}{K}\\right)$。则 $f(N) = \\frac{R}{A} g(N)(N - A)$，所以\n$$\nf'(N) = \\frac{R}{A}\\left[g'(N)(N - A) + g(N)\\right], \\quad \\Rightarrow \\quad f'(A) = \\frac{R}{A} g(A).\n$$\n计算 $g(A) = A\\left(1 - \\frac{A}{K}\\right)$，可得\n$$\nf'(A) = \\frac{R}{A}\\,A\\left(1 - \\frac{A}{K}\\right) = R\\left(1 - \\frac{A}{K}\\right).\n$$\n因此，在 $N=A$ 附近的线性化动态系统为\n$$\n\\frac{dN}{dt} \\approx f'(A)(N - A) - u,\n$$\n其中 $f'(A) = R\\left(1 - \\frac{A}{K}\\right)$。定义 $x(t) = N(t) - A$。则\n$$\n\\frac{dx}{dt} = c\\,x - u, \\quad c := R\\left(1 - \\frac{A}{K}\\right),\n$$\n初始条件为 $x(0) = N_{0} - A$，并要求 $x(T) = 0$（即 $N(T) = A$）。方程 $\\frac{dx}{dt} = c x - u$ 的解为\n$$\nx(t) = x(0)\\exp(c t) - \\frac{u}{c}\\left[\\exp(c t) - 1\\right].\n$$\n代入 $x(T) = 0$ 得\n$$\n0 = x(0)\\exp(c T) - \\frac{u}{c}\\left[\\exp(c T) - 1\\right]\n\\quad \\Rightarrow \\quad\nu = c\\,x(0)\\,\\frac{\\exp(c T)}{\\exp(c T) - 1}.\n$$\n代入给定参数。首先计算\n$$\nc = R\\left(1 - \\frac{A}{K}\\right) = \\frac{5}{9}\\left(1 - \\frac{10}{100}\\right) = \\frac{5}{9}\\cdot\\frac{9}{10} = \\frac{1}{2},\n$$\n以及\n$$\nx(0) = N_{0} - A = 12 - 10 = 2, \\quad T = 5.\n$$\n因此\n$$\nu = \\frac{1}{2}\\cdot 2 \\cdot \\frac{\\exp\\!\\left(\\frac{1}{2}\\cdot 5\\right)}{\\exp\\!\\left(\\frac{1}{2}\\cdot 5\\right) - 1}\n= \\frac{\\exp\\!\\left(\\frac{5}{2}\\right)}{\\exp\\!\\left(\\frac{5}{2}\\right) - 1}.\n$$\n数值上，$\\exp\\!\\left(\\frac{5}{2}\\right) \\approx 12.182493961$，因此\n$$\nu \\approx \\frac{12.182493961}{12.182493961 - 1} \\approx 1.089425\\ \\text{（千个体/年）}.\n$$\n四舍五入到三位有效数字，实现 $N(T)=A$ 的最小恒定移除率为 $1.09$（单位：千个体/年）。", "answer": "$$\\boxed{1.09}$$", "id": "1585105"}]}