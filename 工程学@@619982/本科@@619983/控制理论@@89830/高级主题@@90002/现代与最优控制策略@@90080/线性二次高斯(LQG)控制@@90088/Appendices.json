{"hands_on_practices": [{"introduction": "要掌握线性二次高斯（LQG）控制，一个很好的起点是先理解其核心组件之一：线性二次调节器（LQR）。这个练习将引导你解决一个有限时间范围内的 LQR 问题，专注于计算最后一个时间步的控制增益 $K_{N-1}$。通过这个具体计算，你将亲身体会到最优控制是如何通过动态规划、从最终状态成本出发反向推导出来的，从而为理解更复杂的无限时域和随机情况打下坚实的基础 [@problem_id:1589193]。", "problem": "一位科学家正在为一个高精度温控箱设计一个数字控制系统。在离散时间步长 $k$ 上，测量温度与期望设定点之间的偏差，该偏差记为 $x_k$，单位为摄氏度 (°C)。一个热电模块施加一个纠正作用 $u_k$，单位为瓦特 (W)。系统的行为由以下标量离散时间模型描述：\n$$x_{k+1} = a x_k + b u_k$$\n其中系统参数为 $a = 1.015$（无量纲）和 $b = -0.045$ °C/W。\n\n控制器的性能在一个 $N=20$ 步（从 $k=0$ 到 $k=19$）的有限时域内进行评估。目标是最小化一个总代价函数 $J$，该函数同时惩罚温度偏差和控制努力：\n$$J = \\left( \\sum_{k=0}^{N-1} (q x_k^2 + r u_k^2) \\right) + p x_N^2$$\n权重因子给定为 $q = 1.0$，$r = 0.25$，终端代价权重为 $p = 4.5$。权重因子的单位在内部是一致的，以产生一个无量纲的代价值。\n\n最优控制器实现了一个形式为 $u_k = -K_k x_k$ 的时变状态反馈律。您的任务是确定在最后一个控制作用时刻，即时间步长 $k = N-1$ 时的反馈增益 $K_k$。\n\n计算增益 $K_{N-1}$ 的值。您的答案应以瓦特/摄氏度 (W/°C) 为单位，并四舍五入到三位有效数字。", "solution": "我们有一个标量离散时间系统 $x_{k+1} = a x_{k} + b u_{k}$ 和一个有限时域二次型代价函数\n$$\nJ = \\sum_{k=0}^{N-1} \\left(q x_{k}^{2} + r u_{k}^{2}\\right) + p x_{N}^{2}.\n$$\n对于 $k=N-1$ 时的最后一次控制作用，我们关于 $u_{N-1}$ 最小化阶段代价加终端代价：\n$$\nJ_{N-1}(x_{N-1},u_{N-1}) = q x_{N-1}^{2} + r u_{N-1}^{2} + p x_{N}^{2},\n$$\n其中 $x_{N} = a x_{N-1} + b u_{N-1}$。代入 $x_{N}$，\n$$\nJ_{N-1}(x,u) = q x^{2} + r u^{2} + p \\left(a x + b u\\right)^{2},\n$$\n其中 $x \\equiv x_{N-1}$ 且 $u \\equiv u_{N-1}$。为求最优 $u$，对 $u$ 求导并令其为零：\n$$\n\\frac{\\partial J_{N-1}}{\\partial u} = 2 r u + 2 p b \\left(a x + b u\\right) = 0.\n$$\n合并关于 $u$ 的项，得到\n$$\n\\left(r + p b^{2}\\right) u + p a b\\, x = 0 \\quad \\Rightarrow \\quad u^{\\star} = -\\frac{p a b}{r + p b^{2}}\\, x.\n$$\n因此，在 $k=N-1$ 时的最优反馈形式为 $u_{N-1} = -K_{N-1} x_{N-1}$，其中\n$$\nK_{N-1} = \\frac{p a b}{r + p b^{2}}.\n$$\n代入给定的数值 $a = 1.015$，$b = -0.045$，$r = 0.25$ 和 $p = 4.5$，\n$$\nb^{2} = 0.045^{2} = 0.002025, \\quad p b^{2} = 4.5 \\times 0.002025 = 0.0091125,\n$$\n$$\nr + p b^{2} = 0.25 + 0.0091125 = 0.2591125,\n$$\n$$\np a b = 4.5 \\times 1.015 \\times (-0.045) = -0.2055375,\n$$\n所以\n$$\nK_{N-1} = \\frac{-0.2055375}{0.2591125} \\approx -0.7932365.\n$$\n四舍五入到三位有效数字，$K_{N-1} \\approx -0.793$，单位为瓦特/摄氏度。", "answer": "$$\\boxed{-0.793}$$", "id": "1589193"}, {"introduction": "在掌握了 LQR 的基本计算后，下一个关键步骤是培养设计直觉。这个练习以经典的倒立摆系统为背景，让你探索控制器设计的核心权衡：如何通过调整成本函数中的权重矩阵 $Q$ 和 $R$ 来影响控制行为。通过比较不同权重下的控制增益，你将深入理解这些矩阵如何量化我们对系统性能（如响应速度）和控制成本（如能耗）的偏好，这是实际 LQR 设计中至关重要的一环 [@problem_id:1589177]。", "problem": "一位控制工程师正在为小车上的倒立摆简化模型设计一个控制器。该倒立摆围绕其直立不稳定平衡点的线性化动力学由状态空间模型 $\\dot{x} = Ax + Bu$ 给出，其中状态向量为 $x = [\\theta, \\dot{\\theta}]^T$，分别表示与垂直方向的夹角和角速度。控制输入 $u$ 是施加到小车上的水平力的一个标度化表示。系统矩阵为：\n$$ A = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} $$\n该工程师使用线性二次调节器 (LQR) 方法来设计状态反馈控制器 $u = -Kx = -[k_{\\theta}, k_{\\dot{\\theta}}]x$。目标是找到最优增益矩阵 $K$，以最小化二次型代价泛函 $J = \\int_{0}^{\\infty} (x^T Q x + u^T R u) dt$。\n\n工程师考虑了基于两组不同权重矩阵的两种设计：\n1.  **设计 1：** 权重矩阵为 $Q_1 = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$ 和 $R_1 = 1$。此设计得到的最优增益矩阵为 $K_1 = [k_{\\theta,1}, k_{\\dot{\\theta},1}]$。\n2.  **设计 2：** 权重矩阵为 $Q_2 = \\begin{pmatrix} 1 & 0 \\\\ 0 & 100 \\end{pmatrix}$ 和 $R_2 = 1$。此设计得到的最优增益矩阵为 $K_2 = [k_{\\theta,2}, k_{\\dot{\\theta},2}]$。\n\n计算设计 2 与设计 1 的角速度反馈增益之比，即 $k_{\\dot{\\theta},2} / k_{\\dot{\\theta},1}$。将最终答案四舍五入到三位有效数字。", "solution": "我们使用连续时间 LQR 框架。对于系统 $\\dot{x}=Ax+Bu$，其中 $A=\\begin{pmatrix}0 & 1 \\\\ 1 & 0\\end{pmatrix}$，$B=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$，$Q=\\operatorname{diag}(q_{1},q_{2})$ 且 $R=1$，最优增益为 $K=R^{-1}B^{T}P=B^{T}P$，其中 $P=P^{T}\\succeq 0$ 是如下连续时间代数黎卡提方程的解\n$$\nA^{T}P+PA-PBR^{-1}B^{T}P+Q=0.\n$$\n令 $P=\\begin{pmatrix}p_{11} & p_{12} \\\\ p_{12} & p_{22}\\end{pmatrix}$。计算每一项：\n- $A^{T}P+PA=\\begin{pmatrix}2p_{12} & p_{11}+p_{22} \\\\ p_{11}+p_{22} & 2p_{12}\\end{pmatrix}$，\n- $PBR^{-1}B^{T}P=PB B^{T}P=(PB)(PB)^{T}$，其中 $PB=\\begin{pmatrix}p_{12} \\\\ p_{22}\\end{pmatrix}$，因此\n$$\nPBR^{-1}B^{T}P=\\begin{pmatrix}p_{12}^{2} & p_{12}p_{22} \\\\ p_{12}p_{22} & p_{22}^{2}\\end{pmatrix}.\n$$\n黎卡提方程得出以下元素级方程组\n$$\n\\begin{aligned}\n& (1,1):\\quad 2p_{12}+q_{1}-p_{12}^{2}=0, \\\\\n& (1,2):\\quad p_{11}+p_{22}-p_{12}p_{22}=0, \\\\\n& (2,2):\\quad 2p_{12}+q_{2}-p_{22}^{2}=0.\n\\end{aligned}\n$$\n从 (1,1) 项，解关于 $p_{12}$ 的二次方程：\n$$\np_{12}^{2}-2p_{12}-q_{1}=0 \\;\\;\\Rightarrow\\;\\; p_{12}=1\\pm\\sqrt{1+q_{1}}.\n$$\n对于稳定的 LQR 解，在 $P\\succeq 0$ 的条件下，我们需要 $p_{11}=p_{22}(p_{12}-1)\\geq 0$，这选择了 $p_{12}=1+\\sqrt{1+q_{1}}$。然后从 (2,2) 项，\n$$\np_{22}^{2}=2p_{12}+q_{2}=2\\bigl(1+\\sqrt{1+q_{1}}\\bigr)+q_{2},\n$$\n因此，在 $p_{22}\\geq 0$ 的条件下，我们有\n$$\np_{22}=\\sqrt{q_{2}+2+2\\sqrt{1+q_{1}}}.\n$$\n由于 $K=B^{T}P=[p_{12},p_{22}]$，角速度反馈增益为 $k_{\\dot{\\theta}}=p_{22}$。\n\n将此应用于两种设计：\n- 设计 1：$q_{1}=1$，$q_{2}=1$ 得到\n$$\nk_{\\dot{\\theta},1}=p_{22,1}=\\sqrt{1+2+2\\sqrt{2}}=\\sqrt{3+2\\sqrt{2}}=\\sqrt{2}+1.\n$$\n- 设计 2：$q_{1}=1$，$q_{2}=100$ 得到\n$$\nk_{\\dot{\\theta},2}=p_{22,2}=\\sqrt{100+2+2\\sqrt{2}}=\\sqrt{102+2\\sqrt{2}}.\n$$\n因此，比率为\n$$\n\\frac{k_{\\dot{\\theta},2}}{k_{\\dot{\\theta},1}}=\\frac{\\sqrt{102+2\\sqrt{2}}}{\\sqrt{2}+1}=(\\sqrt{2}-1)\\sqrt{102+2\\sqrt{2}}.\n$$\n数值上，这约等于 $4.2409566$，四舍五入到三位有效数字后为 $4.24$。", "answer": "$$\\boxed{4.24}$$", "id": "1589177"}, {"introduction": "这个综合性练习将 LQR 控制器与卡尔曼滤波器结合起来，构成一个完整的 LQG 控制系统。面对一个同时存在过程噪声和测量噪声的不稳定系统，你将运用分离原理，独立设计状态反馈增益 $K$ 和观测器增益 $L$。这个实践旨在展示 LQG 控制的真正威力：即使在充满不确定性的现实条件下，我们依然能够设计出稳定系统并优化其性能，这充分体现了现代控制理论的精髓 [@problem_id:1589180]。", "problem": "一位工程师的任务是稳定一个简单但本质上不稳定的离散时间过程。该过程的状态（在时间步 $k$ 时记为 $x_k$）根据以下线性差分方程演化：\n$$x_{k+1} = 1.2 x_k + u_k + w_k$$\n其中 $u_k$ 是在时间步 $k$ 施加的控制输入。项 $w_k$ 代表过程噪声，被建模为均值为零、方差恒为 $Q = 0.5$ 的高斯白噪声序列。\n\n状态 $x_k$ 无法被直接测量。取而代之的是，一个传感器提供一个带噪声的测量值 $y_k$，由以下公式给出：\n$$y_k = x_k + v_k$$\n其中 $v_k$ 是测量噪声，被建模为均值为零、方差恒为 $R = 0.2$ 的高斯白噪声序列。噪声序列 $w_k$ 和 $v_k$ 彼此不相关，且与初始状态 $x_0$ 也不相关。\n\n控制目标是设计一个控制器来稳定该系统，同时最小化以下无限时域二次代价函数：\n$$J = \\sum_{k=0}^{\\infty} (q x_k^2 + r u_k^2)$$\n其中加权因子为 $q=1$ 和 $r=1$。最终得到的控制器是一个稳态线性二次高斯（LQG）控制器。这种控制器架构使用状态估计器（卡尔曼滤波器）来生成状态的估计值 $\\hat{x}_{k|k}$，然后该估计值被用于线性反馈律中。\n\n该稳态控制器完全由两个恒定的增益来表征：\n1. 状态反馈增益 $K$，用于控制律 $u_k = -K \\hat{x}_{k|k}$。\n2. 观测器（卡尔曼）增益 $L$，用于状态估计更新方程 $\\hat{x}_{k|k} = \\hat{x}_{k|k-1} + L(y_k - C\\hat{x}_{k|k-1})$，对于本系统 $C=1$。\n\n确定稳态反馈增益 $K$ 和稳态卡尔曼增益 $L$ 的数值。答案请四舍五入到四位有效数字。你的最终答案应该是一个行矩阵，其中包含 $K$ 的值，后跟 $L$ 的值。", "solution": "我们将系统和代价函数重写为标准的标量 LQG 形式。被控对象为 $x_{k+1} = a x_{k} + b u_{k} + w_{k}$，其中 $a=1.2$，$b=1$；输出为 $y_{k} = C x_{k} + v_{k}$，其中 $C=1$。噪声方差为 $\\operatorname{Var}(w_{k})=Q=0.5$ 和 $\\operatorname{Var}(v_{k})=R=0.2$。LQR 代价函数为 $J=\\sum_{k=0}^{\\infty} (q x_{k}^{2} + r u_{k}^{2})$，其中 $q=1$ 和 $r=1$。\n\n根据分离原理，稳态 LQG 控制器可以通过独立求解以下两个问题得到：\n- 用于求解状态代价矩阵 $S$ 和反馈增益 $K$ 的离散时间 LQR 代数 Riccati 方程（DARE），以及\n- 用于求解先验误差协方差 $P$ 和卡尔曼增益 $L$ 的稳态卡尔曼滤波器 Riccati 方程。\n\nLQR 设计（反馈增益 K）。对于标量系统，DARE 为\n$$\nS = a^{2} S - \\frac{a^{2} S^{2}}{r + b^{2} S} + q.\n$$\n两边同乘以 $(r + b^{2} S)$ 并化简，得到关于 $S$ 的二次方程：\n$$\nS^{2} + S\\big(r(1 - a^{2}) - q\\big) - q r = 0.\n$$\n当 $a=1.2$，$b=1$，$q=1$，$r=1$ 时，\n$$\nS^{2} - 1.44 S - 1 = 0,\n$$\n其正根为\n$$\nS = \\frac{1.44 + \\sqrt{1.44^{2} + 4}}{2} = \\frac{1.44 + \\sqrt{6.0736}}{2} \\approx 1.95223374.\n$$\n稳态 LQR 增益为\n$$\nK = \\frac{b a S}{r + b^{2} S} = \\frac{a S}{r + S}.\n$$\n代入 $a=1.2$，$r=1$，$S\\approx 1.95223374$，\n$$\nK \\approx \\frac{1.2 \\times 1.95223374}{1 + 1.95223374} \\approx 0.7935 \\quad \\text{（四位有效数字）}.\n$$\n\n卡尔曼滤波器设计（观测器增益 L）。令 $P$ 表示稳态先验误差协方差 $P_{k|k-1}$。稳态关系式为\n$$\nP = a^{2} P^{+} + Q,\\quad P^{+} = (1 - L) P,\\quad L = \\frac{P}{P + R}.\n$$\n消去 $P^{+}$ 和 $L$ 可得\n$$\nP = a^{2} \\frac{P R}{P + R} + Q.\n$$\n乘以 $(P + R)$ 并重新整理，得到关于 $P$ 的二次方程：\n$$\nP^{2} + P\\big(R(1 - a^{2}) - Q\\big) - Q R = 0.\n$$\n当 $a=1.2$，$Q=0.5$，$R=0.2$ 时，\n$$\nP^{2} - 0.588 P - 0.1 = 0,\n$$\n其正根为\n$$\nP = \\frac{0.588 + \\sqrt{0.588^{2} + 0.4}}{2} = \\frac{0.588 + \\sqrt{0.745744}}{2} \\approx 0.725782345.\n$$\n那么稳态卡尔曼增益为\n$$\nL = \\frac{P}{P + R} \\approx \\frac{0.725782345}{0.725782345 + 0.2} \\approx 0.7840 \\quad \\text{（四位有效数字）}.\n$$\n\n因此，稳态 LQG 增益为 $K \\approx 0.7935$ 和 $L \\approx 0.7840$，按要求取四位有效数字。", "answer": "$$\\boxed{\\begin{pmatrix}0.7935 & 0.7840\\end{pmatrix}}$$", "id": "1589180"}]}