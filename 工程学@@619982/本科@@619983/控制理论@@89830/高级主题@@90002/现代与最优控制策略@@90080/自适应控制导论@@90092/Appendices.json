{"hands_on_practices": [{"introduction": "自适应控制的核心思想之一是通过不断减少模型预测与实际测量之间的误差来在线估计未知参数。本练习将带你亲手实践这一基本过程。我们将使用一个智能恒温器的简化模型，通过梯度下降法逐步更新对房间热阻的估计值，这是许多自适应算法背后的基本工作原理 [@problem_id:1582140]。这个计算将帮助你具体理解参数估计算法是如何运作的。", "problem": "一个智能恒温器使用一个简化模型来关联房间内部与外部环境之间的稳态温差 $\\Delta T$（单位为开尔文，K），以及由加热器提供的功率 $P$（单位为瓦特，W）。该模型由线性关系 $\\Delta T = R_{th} P$ 给出，其中 $R_{th}$ 是房间的有效热阻，是恒温器需要学习的一个参数。\n\n为了估计这个参数，恒温器的控制算法在离散时间步 $k=0, 1, 2, \\dots$ 更新一个估计值 $\\hat{R}_{th,k}$。该更新基于一种梯度下降法，旨在最小化当前时间步的平方预测误差，该误差被表达为成本函数 $J_k = \\frac{1}{2} e_k^2$，其中 $e_k = \\Delta T_k - \\hat{R}_{th,k} P_k$。该估计值的更新规则由下式给出：\n$$ \\hat{R}_{th, k+1} = \\hat{R}_{th, k} - \\mu \\left. \\frac{\\partial J_k}{\\partial \\hat{R}_{th}} \\right|_{\\hat{R}_{th} = \\hat{R}_{th,k}} $$\n其中 $\\mu$ 是一个恒定的正学习率。\n\n给定以下实验数据和参数：\n- 热阻的初始估计值为 $\\hat{R}_{th,0} = 0.0500 \\text{ K/W}$。\n- 学习率为 $\\mu = 5.00 \\times 10^{-5} \\text{ W}^{-2}$。\n- 在时间步 $k=0$ 时，加热器功率为 $P_0 = 100.0 \\text{ W}$，测得的温差为 $\\Delta T_0 = 6.00 \\text{ K}$。\n- 在时间步 $k=1$ 时，加热器功率为 $P_1 = 150.0 \\text{ W}$，测得的温差为 $\\Delta T_1 = 9.00 \\text{ K}$。\n\n计算估计值 $\\hat{R}_{th,2}$。您的答案以 K/W 为单位，并四舍五入到三位有效数字。", "solution": "我们已知线性热模型 $\\Delta T = R_{th} P$ 和瞬时平方误差成本函数 $J_{k} = \\frac{1}{2} e_{k}^{2}$，其中 $e_{k} = \\Delta T_{k} - \\hat{R}_{th,k} P_{k}$。使用链式法则计算 $J_{k}$ 相对于 $\\hat{R}_{th}$ 的梯度：\n$$\n\\frac{\\partial J_{k}}{\\partial \\hat{R}_{th}} = \\frac{\\partial}{\\partial \\hat{R}_{th}} \\left( \\frac{1}{2} e_{k}^{2} \\right) = e_{k} \\frac{\\partial e_{k}}{\\partial \\hat{R}_{th}}, \\quad \\text{且} \\quad \\frac{\\partial e_{k}}{\\partial \\hat{R}_{th}} = -P_{k},\n$$\n因此\n$$\n\\frac{\\partial J_{k}}{\\partial \\hat{R}_{th}} = - e_{k} P_{k}.\n$$\n梯度下降的更新公式为\n$$\n\\hat{R}_{th,k+1} = \\hat{R}_{th,k} - \\mu \\left. \\frac{\\partial J_{k}}{\\partial \\hat{R}_{th}} \\right|_{\\hat{R}_{th} = \\hat{R}_{th,k}} = \\hat{R}_{th,k} + \\mu\\, e_{k} P_{k}.\n$$\n等价地，\n$$\n\\hat{R}_{th,k+1} = \\hat{R}_{th,k} + \\mu\\, P_{k} \\left( \\Delta T_{k} - \\hat{R}_{th,k} P_{k} \\right).\n$$\n\n步骤 k = 0：\n给定 $\\hat{R}_{th,0} = 0.0500$，$P_{0} = 100.0$，$\\Delta T_{0} = 6.00$，计算\n$$\ne_{0} = \\Delta T_{0} - \\hat{R}_{th,0} P_{0} = 6.00 - (0.0500)(100.0) = 6.00 - 5.00 = 1.00.\n$$\n更新：\n$$\n\\hat{R}_{th,1} = \\hat{R}_{th,0} + \\mu e_{0} P_{0} = 0.0500 + (5.00 \\times 10^{-5})(1.00)(100.0) = 0.0500 + 0.00500 = 0.0550.\n$$\n\n步骤 k = 1：\n给定 $P_{1} = 150.0$，$\\Delta T_{1} = 9.00$，计算\n$$\ne_{1} = \\Delta T_{1} - \\hat{R}_{th,1} P_{1} = 9.00 - (0.0550)(150.0) = 9.00 - 8.25 = 0.75.\n$$\n更新：\n$$\n\\hat{R}_{th,2} = \\hat{R}_{th,1} + \\mu e_{1} P_{1} = 0.0550 + (5.00 \\times 10^{-5})(0.75)(150.0).\n$$\n计算增量：\n$$\n(5.00 \\times 10^{-5})(0.75)(150.0) = 5.00 \\times 10^{-5} \\times 112.5 = 0.005625.\n$$\n因此，\n$$\n\\hat{R}_{th,2} = 0.0550 + 0.005625 = 0.060625.\n$$\n四舍五入到三位有效数字，结果是 $0.0606$。", "answer": "$$\\boxed{0.0606}$$", "id": "1582140"}, {"introduction": "仅仅拥有一个更新算法是不够的；为了让算法能准确地辨识出系统中所有未知的参数，我们施加的输入信号必须具有足够的“丰富性”或“持续激励性”。本练习探讨了系统辨识的一个基本条件：需要什么样的输入信号才能确保参数可以被唯一确定？通过分析一个二阶系统，你将确定出唯一辨识其所有参数所需的最少正弦输入信号数量，从而将辨识性的抽象概念与测试信号的实际设计联系起来 [@problem_id:1582162]。", "problem": "一位控制工程师的任务是为一个未知的机械系统创建一个高保真度的数字模型。已知该系统的输入-输出行为，即施加的力 $u(t)$ 与产生的位移 $y(t)$ 之间的关系，可以由一个二阶线性时不变（LTI）微分方程精确描述：\n$$\n\\frac{d^2 y(t)}{dt^2} + a_1 \\frac{dy(t)}{dt} + a_0 y(t) = b_0 u(t)\n$$\n参数 $a_1$、$a_0$ 和 $b_0$ 是表征系统物理特性（分别为阻尼、刚度和输入缩放）的实数、正数和未知常数。\n\n为了进行系统辨识，该工程师决定施加一个特定的测试输入信号 $u(t)$，并测量系统的响应 $y(t)$。所使用的辨识算法保证，当且仅当输入信号的频率成分“足够丰富”时，参数集 $\\{a_0, a_1, b_0\\}$ 才能有唯一解。该工程师选择将输入信号构建为有限数量正弦波的叠加：\n$$\nu(t) = \\sum_{i=1}^{N} A_i \\cos(\\omega_i t)\n$$\n此处，$N$ 是正弦分量的数量，振幅 $A_i$ 均为非零，角频率 $\\omega_i$ 是互不相同且严格为正的常数（$\\omega_i > 0$）。\n\n为保证三个未知参数 $\\{a_0, a_1, b_0\\}$ 能从 $u(t)$ 和 $y(t)$ 的测量值中唯一确定，所需的最小整数值 $N$ 是多少？\n\nA. 1\n\nB. 2\n\nC. 3\n\nD. 4\n\nE. 5", "solution": "在零初始条件下，对给定的LTI微分方程进行拉普拉斯变换，以获得从输入到输出的传递函数：\n$$\ns^{2}Y(s)+a_{1}sY(s)+a_{0}Y(s)=b_{0}U(s)\\quad\\Rightarrow\\quad G(s)\\triangleq\\frac{Y(s)}{U(s)}=\\frac{b_{0}}{s^{2}+a_{1}s+a_{0}}.\n$$\n对于角频率为 $\\omega>0$ 的正弦输入，其稳态（相量）响应满足\n$$\nG(j\\omega)=\\frac{b_{0}}{a_{0}-\\omega^{2}+j a_{1}\\omega},\n$$\n其中 $j^{2}=-1$。根据线性和叠加原理，对于具有不同 $\\omega_{i}>0$ 和非零 $A_{i}$ 的多正弦输入 $u(t)=\\sum_{i=1}^{N}A_{i}\\cos(\\omega_{i}t)$，其稳态输出是相同频率下正弦分量的总和。在每个 $\\omega_i$ 处，复频率响应 $H_{i}\\triangleq G(j\\omega_{i})$ 可以通过测量的输入-输出数据（振幅比和相位）来估计。记 $H_{i}=\\alpha_{i}+j\\beta_{i}$，其中 $\\alpha_{i}、\\beta_{i}$ 是通过测量得到的已知实数。\n\n对于每个 $i$，模型意味着\n$$\nH_{i}\\bigl(a_{0}-\\omega_{i}^{2}+j a_{1}\\omega_{i}\\bigr)=b_{0}.\n$$\n令实部和虚部分别相等，得到两个实数方程：\n$$\n\\alpha_{i}a_{1}\\omega_{i}+\\beta_{i}\\bigl(a_{0}-\\omega_{i}^{2}\\bigr)=0,\n$$\n$$\n\\alpha_{i}\\bigl(a_{0}-\\omega_{i}^{2}\\bigr)-\\beta_{i}a_{1}\\omega_{i}=b_{0}.\n$$\n在 $N$ 个不同的频率上，这就为三个未知数 $a_{0},a_{1},b_{0}$ 提供了 $2N$ 个实数方程。\n\n首先，证明 $N=1$ 是不足够的。对于单个频率，上述两个方程在三个未知数中留下一个自由度，因此参数无法唯一确定。\n\n接下来，证明 $N=2$ 是足够的。使用 $i=1,2$ 时的虚部方程，线性求解 $a_{0}$ 和 $a_{1}$：\n$$\n\\beta_{i}a_{0}+\\alpha_{i}a_{1}\\omega_{i}=\\beta_{i}\\omega_{i}^{2},\\quad i\\in\\{1,2\\}.\n$$\n写成矩阵形式，\n$$\n\\begin{pmatrix}\n\\beta_{1} & \\alpha_{1}\\omega_{1}\\\\\n\\beta_{2} & \\alpha_{2}\\omega_{2}\n\\end{pmatrix}\n\\begin{pmatrix}\na_{0}\\\\\na_{1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\beta_{1}\\omega_{1}^{2}\\\\\n\\beta_{2}\\omega_{2}^{2}\n\\end{pmatrix}.\n$$\n为了保证有唯一解，行列式\n$$\n\\Delta=\\beta_{1}\\alpha_{2}\\omega_{2}-\\beta_{2}\\alpha_{1}\\omega_{1}\n$$\n必须非零。对于由给定模型（其中 $a_{0}>0$，$a_{1}>0$，$b_{0}>0$ 且正数 $\\omega_{1}\\neq\\omega_{2}$）生成的数据，我们可以用真实参数明确地表示 $\\alpha_{i}、\\beta_{i}$：\n$$\n\\alpha_{i}=\\frac{b_{0}(a_{0}-\\omega_{i}^{2})}{(a_{0}-\\omega_{i}^{2})^{2}+(a_{1}\\omega_{i})^{2}},\\quad\n\\beta_{i}=-\\frac{b_{0}(a_{1}\\omega_{i})}{(a_{0}-\\omega_{i}^{2})^{2}+(a_{1}\\omega_{i})^{2}}.\n$$\n将这些代入 $\\Delta$ 中得到\n$$\n\\Delta=\\frac{b_{0}^{2}}{\\bigl((a_{0}-\\omega_{1}^{2})^{2}+(a_{1}\\omega_{1})^{2}\\bigr)\\bigl((a_{0}-\\omega_{2}^{2})^{2}+(a_{1}\\omega_{2})^{2}\\bigr)}\n\\cdot a_{1}\\omega_{1}\\omega_{2}\\bigl(\\omega_{2}^{2}-\\omega_{1}^{2}\\bigr).\n$$\n因为 $a_{1}>0$，$b_{0}>0$，$\\omega_{1},\\omega_{2}>0$ 且 $\\omega_{1}\\neq\\omega_{2}$，所有因子都非零，因此 $\\Delta\\neq 0$。因此，这两个虚部方程唯一地确定了 $a_{0}$ 和 $a_{1}$。在 $a_{0}$ 和 $a_{1}$ 已知的情况下，可以从任一频率的实部方程求解 $b_{0}$：\n$$\nb_{0}=\\alpha_{i}\\bigl(a_{0}-\\omega_{i}^{2}\\bigr)-\\beta_{i}a_{1}\\omega_{i},\\quad i\\in\\{1,2\\},\n$$\n对于两个 $i$ 值，这会得到相同的 $b_{0}$。\n\n因此，两个不同的正弦分量足以唯一辨识 $\\{a_{0},a_{1},b_{0}\\}$，而一个则不足够。所以，所需的最小 $N$ 值为 $2$。", "answer": "$$\\boxed{B}$$", "id": "1582162"}, {"introduction": "在理解了持续激励的重要性之后，让我们来探究当这个条件不被满足时会发生什么。本练习展示了一个在自适应控制中非常经典且具有启发性的情况：尽管系统输出被完美地控制（误差趋于零），参数估计值却收敛到了错误的数值。通过解决这个问题，你将深刻理解实现控制目标与实现真实参数收敛之间的关键区别，这是自适应系统中一个核心而微妙的要点 [@problem_id:1582114]。", "problem": "考虑一个一阶动力系统，其行为受两个未知的恒定参数 $\\theta_1$ 和 $\\theta_2$ 的影响。该系统由以下微分方程描述：\n$$ \\dot{y}(t) = u(t) + \\theta_1 w_1(t) + \\theta_2 w_2(t) $$\n其中 $y(t)$ 是系统输出，$u(t)$ 是控制输入，$w_1(t)$ 和 $w_2(t)$ 是已知的周期信号，通常称为回归信号。\n\n为了将输出 $y(t)$ 调节至零，我们采用了一个自适应控制器。其控制律定义为：\n$$ u(t) = -k y(t) - \\hat{\\theta}_1(t) w_1(t) - \\hat{\\theta}_2(t) w_2(t) $$\n其中 $\\hat{\\theta}_1(t)$ 和 $\\hat{\\theta}_2(t)$ 是未知参数 $\\theta_1$ 和 $\\theta_2$ 的在线估计值。参数估计值根据以下自适应律进行更新：\n$$ \\dot{\\hat{\\theta}}_1(t) = \\gamma_1 y(t) w_1(t) $$\n$$ \\dot{\\hat{\\theta}}_2(t) = \\gamma_2 y(t) w_2(t) $$\n其中 $\\gamma_1$ 和 $\\gamma_2$ 是称为自适应增益的正常数。\n\n给定以下具体数值：\n- 真实（但控制器未知）参数：$\\theta_1 = 3.0$, $\\theta_2 = 1.5$\n- 控制器与自适应增益：$k = 10.0$, $\\gamma_1 = 5.0$, $\\gamma_2 = 10.0$\n- 回归信号：$w_1(t) = \\cos(3t)$, $w_2(t) = 2\\cos(3t)$\n- 初始条件：$y(0) = 0$, $\\hat{\\theta}_1(0) = 1.0$, $\\hat{\\theta}_2(0) = 8.0$\n\n该自适应方案保证输出收敛到零，即 $\\lim_{t\\to\\infty} y(t) = 0$。您的任务是确定参数估计值收敛的最终稳态值。设其为 $\\hat{\\theta}_{1,\\infty} = \\lim_{t\\to\\infty} \\hat{\\theta}_1(t)$ 和 $\\hat{\\theta}_{2,\\infty} = \\lim_{t\\to\\infty} \\hat{\\theta}_2(t)$。\n\n请将您的答案表示为一对精确分数 $(\\hat{\\theta}_{1,\\infty}, \\hat{\\theta}_{2,\\infty})$。", "solution": "定义参数估计误差 $\\tilde{\\theta}_{1}(t) \\triangleq \\theta_{1} - \\hat{\\theta}_{1}(t)$ 和 $\\tilde{\\theta}_{2}(t) \\triangleq \\theta_{2} - \\hat{\\theta}_{2}(t)$。将控制律代入系统可得\n$$\n\\dot{y}(t) = -k\\,y(t) + \\tilde{\\theta}_{1}(t)\\,w_{1}(t) + \\tilde{\\theta}_{2}(t)\\,w_{2}(t).\n$$\n自适应律可得\n$$\n\\dot{\\tilde{\\theta}}_{1}(t) = -\\gamma_{1}\\,y(t)\\,w_{1}(t), \\qquad \\dot{\\tilde{\\theta}}_{2}(t) = -\\gamma_{2}\\,y(t)\\,w_{2}(t).\n$$\n对于给定的回归量 $w_{1}(t)=\\cos(3t)$ 和 $w_{2}(t)=2\\cos(3t)$，定义 $w(t)\\triangleq \\cos(3t)$ 和组合\n$$\ns(t) \\triangleq \\tilde{\\theta}_{1}(t) + 2\\,\\tilde{\\theta}_{2}(t).\n$$\n则闭环输出动态和 $s$-动态变为\n$$\n\\dot{y}(t) = -k\\,y(t) + w(t)\\,s(t), \\qquad \\dot{s}(t) = -\\left(\\gamma_{1} + 4\\gamma_{2}\\right)\\,y(t)\\,w(t).\n$$\n根据假设，$\\lim_{t\\to\\infty} y(t)=0$。为使 $y(t)\\equiv 0$ 成为不变集，当 $t\\to\\infty$ 时必须有 $\\dot{y}(t)\\equiv 0$。由于 $w(t)=\\cos(3t)$ 不恒等于零，不变性要求\n$$\ns_{\\infty} \\triangleq \\lim_{t\\to\\infty} s(t) = 0,\n$$\n即，\n$$\n\\tilde{\\theta}_{1,\\infty} + 2\\,\\tilde{\\theta}_{2,\\infty} = 0.\n$$\n接下来，构造一个守恒量。考虑\n$$\nr(t) \\triangleq 2\\gamma_{2}\\,\\tilde{\\theta}_{1}(t) - \\gamma_{1}\\,\\tilde{\\theta}_{2}(t).\n$$\n使用自适应律和 $w_{2}(t)=2w(t)$，其对时间的导数为\n$$\n\\dot{r}(t) = 2\\gamma_{2}\\left(-\\gamma_{1}y(t)w(t)\\right) - \\gamma_{1}\\left(-\\gamma_{2}y(t)\\,2w(t)\\right) = -2\\gamma_{1}\\gamma_{2}y(t)w(t) + 2\\gamma_{1}\\gamma_{2}y(t)w(t) = 0.\n$$\n因此 $r(t)$ 是一个常数：\n$$\nr(t) \\equiv r(0) = 2\\gamma_{2}\\,\\tilde{\\theta}_{1}(0) - \\gamma_{1}\\,\\tilde{\\theta}_{2}(0).\n$$\n根据给定值 $\\theta_{1}=3$, $\\theta_{2}=\\frac{3}{2}$, $\\hat{\\theta}_{1}(0)=1$, $\\hat{\\theta}_{2}(0)=8$, $\\gamma_{1}=5$, $\\gamma_{2}=10$，初始误差为\n$$\n\\tilde{\\theta}_{1}(0) = \\theta_{1} - \\hat{\\theta}_{1}(0) = 3 - 1 = 2, \\qquad \\tilde{\\theta}_{2}(0) = \\theta_{2} - \\hat{\\theta}_{2}(0) = \\frac{3}{2} - 8 = -\\frac{13}{2},\n$$\n因此\n$$\nr(0) = 2\\gamma_{2}\\,\\tilde{\\theta}_{1}(0) - \\gamma_{1}\\,\\tilde{\\theta}_{2}(0) = 2\\cdot 10 \\cdot 2 - 5\\left(-\\frac{13}{2}\\right) = 40 + \\frac{65}{2} = \\frac{145}{2}.\n$$\n在稳态下，序对 $(\\tilde{\\theta}_{1,\\infty},\\tilde{\\theta}_{2,\\infty})$ 必须满足以下线性系统\n$$\n\\tilde{\\theta}_{1,\\infty} + 2\\,\\tilde{\\theta}_{2,\\infty} = 0, \\qquad 2\\gamma_{2}\\,\\tilde{\\theta}_{1,\\infty} - \\gamma_{1}\\,\\tilde{\\theta}_{2,\\infty} = \\frac{145}{2}.\n$$\n由第一个方程可得 $\\tilde{\\theta}_{1,\\infty} = -2\\,\\tilde{\\theta}_{2,\\infty}$。代入第二个方程可得\n$$\n-4\\gamma_{2}\\,\\tilde{\\theta}_{2,\\infty} - \\gamma_{1}\\,\\tilde{\\theta}_{2,\\infty} = \\frac{145}{2} \\;\\;\\Rightarrow\\;\\; \\tilde{\\theta}_{2,\\infty} = -\\frac{145/2}{4\\gamma_{2}+\\gamma_{1}}.\n$$\n当 $\\gamma_{2}=10, \\gamma_{1}=5$ 时，我们有 $4\\gamma_{2}+\\gamma_{1}=45$，因此\n$$\n\\tilde{\\theta}_{2,\\infty} = -\\frac{145}{90} = -\\frac{29}{18}, \\qquad \\tilde{\\theta}_{1,\\infty} = -2\\,\\tilde{\\theta}_{2,\\infty} = \\frac{29}{9}.\n$$\n最后，稳态参数估计值为\n$$\n\\hat{\\theta}_{1,\\infty} = \\theta_{1} - \\tilde{\\theta}_{1,\\infty} = 3 - \\frac{29}{9} = -\\frac{2}{9}, \\qquad \\hat{\\theta}_{2,\\infty} = \\theta_{2} - \\tilde{\\theta}_{2,\\infty} = \\frac{3}{2} - (-\\frac{29}{18}) = \\frac{27}{18} + \\frac{29}{18} = \\frac{56}{18} = \\frac{28}{9}.\n$$\n作为检验，可辨识组合满足 $\\hat{\\theta}_{1,\\infty} + 2\\hat{\\theta}_{2,\\infty} = -\\frac{2}{9} + 2(\\frac{28}{9}) = -\\frac{2}{9} + \\frac{56}{9} = \\frac{54}{9} = 6 = \\theta_{1} + 2\\theta_{2}$，这与 $s_{\\infty}=0$ 一致。", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{2}{9} & \\frac{28}{9}\\end{pmatrix}}$$", "id": "1582114"}]}