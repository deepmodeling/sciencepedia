{"hands_on_practices": [{"introduction": "在许多实际控制系统中，例如机器人或飞行器，控制输入不能瞬间改变。限制输入的变化率（rate-of-change）对于保证系统平稳运行和避免损坏执行器至关重要。本练习将指导您如何将这样一个常见的输入变化率约束转化为标准的矩阵不等式形式 $A_{\\text{rate}} U \\le b_{\\text{rate}}$，这是将 MPC 问题交给二次规划（QP）求解器的标准预备步骤 [@problem_id:1579671]。", "problem": "一位工程师正在使用模型预测控制 (MPC) 为一架四旋翼飞行器开发控制器，这是一种在未来时间区间内优化控制动作的策略。为确保平稳稳定的飞行，限制电机推力的增长速率至关重要。\n\n该工程师考虑了一个长度为 $N=3$ 的预测时域。在当前时间 $t$ 待决定的未来控制输入序列（电机推力指令）用向量 $U = [u_0, u_1, u_2]^T$ 表示，其中 $u_k$ 表示在时间步 $t+k$ 的控制输入。在前一个时间步 $t-1$ 施加的控制输入是已知的，并用 $u_{t-1}$ 表示。\n\n对电机推力增长率的约束由以下不等式给出：\n$$u(k) - u(k-1) \\leq \\Delta u_{\\max}$$\n其中 $\\Delta u_{\\max}$ 是一个正常数，表示连续时间步之间推力允许的最大增量。该约束必须在预测时域内的每一步都成立。\n\n为了在标准的二次规划求解器中使用，这组线性不等式必须被转换为矩阵形式 $A_{\\text{rate}} U \\leq b_{\\text{rate}}$。\n\n您的任务是确定增广矩阵 $M = [A_{\\text{rate}} | b_{\\text{rate}}]$，该矩阵表示在给定预测时域内这组完整的速率约束。竖线表示矩阵增广。请用 $\\Delta u_{\\max}$ 和 $u_{t-1}$ 来表示您的答案。", "solution": "目标是对于长度为 $N=3$ 的预测时域，将输入变化率约束集表示为矩阵形式 $A_{\\text{rate}} U \\leq b_{\\text{rate}}$，然后求出相应的增广矩阵 $M = [A_{\\text{rate}} | b_{\\text{rate}}]$。\n\n决策变量向量是时域内的未来控制输入序列：\n$$U = \\begin{pmatrix} u_0 \\\\ u_1 \\\\ u_2 \\end{pmatrix}$$\n增长率约束由 $u(k) - u(k-1) \\leq \\Delta u_{\\max}$ 给出。我们必须对预测时域内的每一步应用此约束，从第一个未来步 ($k=0$) 到最后一个未来步 ($k=N-1=2$)。\n\n**第一步：展开每个时间步的约束。**\n\n对于时域内的第一个时间步 ($k=0$)：\n控制输入是 $u_0$。前一个控制输入是在时间 $t-1$ 施加的，即已知值 $u_{t-1}$。\n约束为：\n$$u_0 - u_{t-1} \\leq \\Delta u_{\\max}$$\n\n对于时域内的第二个时间步 ($k=1$)：\n控制输入是 $u_1$。时域内的前一个控制输入是 $u_0$。\n约束为：\n$$u_1 - u_0 \\leq \\Delta u_{\\max}$$\n\n对于时域内的第三个时间步 ($k=2$)：\n控制输入是 $u_2$。时域内的前一个控制输入是 $u_1$。\n约束为：\n$$u_2 - u_1 \\leq \\Delta u_{\\max}$$\n\n**第二步：将不等式整理成标准形式。**\n\n我们需要整理每个不等式，使得包含决策变量 ($u_0, u_1, u_2$) 的项在左侧，而常数和已知值在右侧。\n\n第一个不等式 $u_0 - u_{t-1} \\leq \\Delta u_{\\max}$ 变为：\n$$u_0 \\leq \\Delta u_{\\max} + u_{t-1}$$\n根据整个向量 $U$ 将其写为：\n$$(1)u_0 + (0)u_1 + (0)u_2 \\leq \\Delta u_{\\max} + u_{t-1}$$\n\n第二个不等式 $u_1 - u_0 \\leq \\Delta u_{\\max}$ 已经是合适的形式。\n根据整个向量 $U$ 将其写为：\n$$(-1)u_0 + (1)u_1 + (0)u_2 \\leq \\Delta u_{\\max}$$\n\n第三个不等式 $u_2 - u_1 \\leq \\Delta u_{\\max}$ 也已经是合适的形式。\n根据整个向量 $U$ 将其写为：\n$$(0)u_0 + (-1)u_1 + (1)u_2 \\leq \\Delta u_{\\max}$$\n\n**第三步：构造矩阵 $A_{\\text{rate}}$ 和 $b_{\\text{rate}}$。**\n\n现在我们可以将这三个不等式组合成矩阵方程 $A_{\\text{rate}} U \\leq b_{\\text{rate}}$。矩阵 $A_{\\text{rate}}$ 由每个不等式中 $u_0, u_1, u_2$ 的系数构成，而向量 $b_{\\text{rate}}$ 由右侧的值构成。\n\n$$\n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n-1 & 1 & 0 \\\\\n0 & -1 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\nu_0 \\\\\nu_1 \\\\\nu_2\n\\end{pmatrix}\n\\leq\n\\begin{pmatrix}\n\\Delta u_{\\max} + u_{t-1} \\\\\n\\Delta u_{\\max} \\\\\n\\Delta u_{\\max}\n\\end{pmatrix}\n$$\n\n由此，我们可以确定：\n$$A_{\\text{rate}} = \\begin{pmatrix} 1 & 0 & 0 \\\\ -1 & 1 & 0 \\\\ 0 & -1 & 1 \\end{pmatrix}$$\n$$b_{\\text{rate}} = \\begin{pmatrix} \\Delta u_{\\max} + u_{t-1} \\\\ \\Delta u_{\\max} \\\\ \\Delta u_{\\max} \\end{pmatrix}$$\n\n**第四步：构造增广矩阵 $M$。**\n\n最后一步是构造增广矩阵 $M = [A_{\\text{rate}} | b_{\\text{rate}}]$，方法是将向量 $b_{\\text{rate}}$ 作为最后一列放置在矩阵 $A_{\\text{rate}}$ 旁边。\n\n$$M = [A_{\\text{rate}} | b_{\\text{rate}}] = \\begin{pmatrix} 1 & 0 & 0 & \\Delta u_{\\max} + u_{t-1} \\\\ -1 & 1 & 0 & \\Delta u_{\\max} \\\\ 0 & -1 & 1 & \\Delta u_{\\max} \\end{pmatrix}$$\n这就是所求的增广矩阵。", "answer": "$$\\boxed{\\begin{pmatrix} 1 & 0 & 0 & \\Delta u_{\\max} + u_{t-1} \\\\ -1 & 1 & 0 & \\Delta u_{\\max} \\\\ 0 & -1 & 1 & \\Delta u_{\\max} \\end{pmatrix}}$$", "id": "1579671"}, {"introduction": "除了对输入的限制，模型预测控制的一大优势是能够直接处理对系统状态的约束。在热管理或化学过程中，我们常常关心的是不同点之间的温差或浓度差，这类约束通常以绝对值的形式出现。本练习将教您一个通用技巧，如何将绝对值不等式 $|x_1(k) - x_2(k)| \\le T_{\\text{lim}}$ 转换为一组等效的线性不等式，从而使其能够被线性 MPC 框架无缝处理 [@problem_id:1579663]。", "problem": "一个热管理系统旨在调节某电子设备中两个关键部件的温度。系统在离散时间步 $k$ 的状态向量由 $x(k) = \\begin{pmatrix} x_1(k) \\\\ x_2(k) \\end{pmatrix}$ 给出，其中 $x_1(k)$ 和 $x_2(k)$ 是这两个部件的温度。\n\n为防止热应力并确保设备的使用寿命，施加了一项关键的操作约束：两个部件之间的温差绝对值不得超过一个指定的正值 $T_{lim}$。该约束在数学上表示为：\n$$|x_1(k) - x_2(k)| \\le T_{lim}$$\n\n为用于模型预测控制 (MPC) 算法，该约束必须被转换为标准的线性多面体形式 $Hx(k) \\le h$，其中 $H$ 是一个常数矩阵，$h$ 是一个常数列向量。\n\n你的任务是确定矩阵 $H$。所得矩阵 $H$ 的行数应为完全表示该约束所需的最小行数。", "solution": "给定关于状态分量 $x_1(k)$ 和 $x_2(k)$ 的绝对值约束：\n$$|x_1(k)-x_2(k)| \\le T_{lim}.$$\n对于任意标量 $z$，不等式 $|z| \\le T_{lim}$ 等价于一对线性不等式 $z \\le T_{lim}$ 和 $-z \\le T_{lim}$。令 $z = x_1(k) - x_2(k)$ 并应用此性质，我们得到\n$$x_1(k) - x_2(k) \\le T_{lim},$$\n$$-(x_1(k) - x_2(k)) \\le T_{lim} \\;\\;\\Longleftrightarrow\\;\\; -x_1(k) + x_2(k) \\le T_{lim}.$$\n令 $x(k) = \\begin{pmatrix} x_1(k) \\\\ x_2(k) \\end{pmatrix}$。将每个不等式写成标准多面体形式 $Hx(k) \\le h$，第一个不等式对应于行向量 $\\begin{pmatrix} 1 & -1 \\end{pmatrix}$，第二个不等式对应于 $\\begin{pmatrix} -1 & 1 \\end{pmatrix}$。将它们堆叠起来，得到\n$$H = \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}, \\quad h = \\begin{pmatrix} T_{lim} \\\\ T_{lim} \\end{pmatrix}.$$\n这里使用了最少的两个线性不等式来表示该绝对值约束，因此 $H$ 的行数是最小的。", "answer": "$$\\boxed{\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}}$$", "id": "1579663"}, {"introduction": "设定约束是一回事，但系统是否总能找到满足这些约束的控制策略呢？这个问题触及了 MPC 的核心概念：可行性（feasibility）。本练习是一个发人深省的思维实验，它揭示了控制问题的可行性深刻地依赖于系统的初始状态。通过这个练习，您将亲手计算出一个系统为了在未来保持在安全边界内，其初始状态必须满足的条件，从而理解为何可行性是 MPC 设计中一个必须被严肃对待的根本性问题 [@problem_id:1579647]。", "problem": "一位工程师的任务是为一个系统设计一个安全关键控制器，该系统的状态 $x(k)$ 在离散时间步 $k$ 根据以下线性方程演化：\n$$x(k+1) = \\alpha x(k) + \\beta u(k)$$\n系统参数给定为 $\\alpha = 0.5$ 和 $\\beta = 1$。由控制器施加的控制输入 $u(k)$ 受到物理约束的限制，即 $|u(k)| \\le u_{\\max}$，其中 $u_{\\max} = 1$。\n\n一个关键的操作要求是，系统状态必须在有限的时间内保持在某个最小阈值之上。具体来说，状态 $x(k)$ 必须在时间步 $k = 1, 2, 3, 4$ 满足约束 $x(k) \\ge x_{\\min}$。最小阈值指定为 $x_{\\min} = 2.5$。请注意，此状态约束不适用于初始状态 $x(0)$。\n\n你的任务是确定初始状态 $x(0)$ 的最小可能值，使得存在一个有效的控制序列 $u(0), u(1), u(2), u(3)$ 可以在要求的时间内成功地将系统状态维持在指定约束内。请以单个数值的形式提供答案。", "solution": "我们给定一个线性时不变离散时间系统 $x(k+1)=\\alpha x(k)+\\beta u(k)$，其中 $\\alpha=\\frac{1}{2}$，$\\beta=1$，且输入约束为 $|u(k)|\\leq u_{\\max}$，其中 $u_{\\max}=1$。状态必须在 $k=1,2,3,4$ 时满足 $x(k)\\geq x_{\\min}$，其中 $x_{\\min}=\\frac{5}{2}$。初始状态 $x(0)$ 不受约束，我们的目标是寻找最小的 $x(0)$，使得存在一个序列 $u(0),u(1),u(2),u(3)$，该序列满足输入边界条件并能在 $k=1,2,3,4$ 时保持 $x(k)\\geq \\frac{5}{2}$。\n\n在时间 $k$ 的状态作为 $x(0)$ 和输入的函数是\n$$\nx(k)=\\alpha^{k}x(0)+\\sum_{i=0}^{k-1}\\alpha^{k-1-i}\\beta\\,u(i).\n$$\n因为 $\\alpha>0$ 且 $\\beta>0$，所以 $x(k)$ 是关于每个 $u(i)$ 的增函数。因此，对于给定的 $x(0)$，为了最大化 $x(k)$，我们为所有的 $i$ 选择 $u(i)=u_{\\max}=1$。这个选择会使得满足下界约束所需的 $x(0)$ 最小化。\n\n当 $u(i)=1$ 且 $\\alpha=\\frac{1}{2}$ 时，我们得到\n$$\nx(k)=\\left(\\frac{1}{2}\\right)^{k}x(0)+\\sum_{j=0}^{k-1}\\left(\\frac{1}{2}\\right)^{j}\n=\\left(\\frac{1}{2}\\right)^{k}x(0)+\\frac{1-\\left(\\frac{1}{2}\\right)^{k}}{1-\\frac{1}{2}}\n=\\left(\\frac{1}{2}\\right)^{k}x(0)+2-2^{1-k}.\n$$\n施加 $k=1,2,3,4$ 时的约束 $x(k)\\geq \\frac{5}{2}$ 得到\n$$\n\\left(\\frac{1}{2}\\right)^{k}x(0)+2-2^{1-k}\\geq \\frac{5}{2}\n\\;\\;\\Longleftrightarrow\\;\\;\n\\left(\\frac{1}{2}\\right)^{k}x(0)\\geq \\frac{1}{2}+2^{1-k}\n\\;\\;\\Longleftrightarrow\\;\\;\nx(0)\\geq 2^{k-1}+2.\n$$\n因此，关于 $x(0)$ 的约束集是\n$$\nx(0)\\geq 2^{k-1}+2 \\quad \\text{for } k=1,2,3,4,\n$$\n即\n$x(0)\\geq 3,\\quad x(0)\\geq 4,\\quad x(0)\\geq 6,\\quad x(0)\\geq 10.$\n\n最严格的要求是 $x(0)\\geq 10$。选择 $x(0)=10$ 并在 $k=0,1,2,3$ 时取 $u(k)=1$ 会得出 $x(1),x(2),x(3),x(4)\\geq \\frac{5}{2}$，其中 $x(4)=\\frac{5}{2}$ 恰好成立。因此，最小的可行初始状态是 $10$。", "answer": "$$\\boxed{10}$$", "id": "1579647"}]}