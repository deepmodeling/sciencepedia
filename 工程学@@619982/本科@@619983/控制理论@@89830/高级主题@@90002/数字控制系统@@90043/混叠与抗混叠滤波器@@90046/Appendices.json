{"hands_on_practices": [{"introduction": "在我们能够对一个模拟信号进行数字分析或控制之前，我们必须首先准确地将其转换为数字形式。本练习将引导您应用数字信号处理中的一项基本准则：奈奎斯特-香农采样定理。通过为一个给定的信号计算避免信息丢失所需的最小采样率，您将掌握防止混叠现象的第一步。[@problem_id:1557482]", "problem": "一个音频工程师团队正在为专业录音棚设计一款定制的模数转换器 (ADC)。他们的目标是采集复杂的音频信号，并避免因混叠造成信息丢失。待数字化的信号，代表来自灵敏麦克风的电压 $V(t)$，可以精确地建模为三个正弦分量的叠加：\n\n$$V(t) = A_1 \\cos(2\\pi f_1 t + \\phi_1) + A_2 \\cos(2\\pi f_2 t + \\phi_2) + A_3 \\cos(2\\pi f_3 t + \\phi_3)$$\n\n已知这些分量的频率为 $f_1 = 18.0 \\text{ kHz}$，$f_2 = 35.5 \\text{ kHz}$ 和 $f_3 = 45.0 \\text{ kHz}$。振幅 ($A_1, A_2, A_3$) 和相位 ($\\phi_1, \\phi_2, \\phi_3$) 是任意的，并且可以变化。为了确保原始的连续时间信号能够从其离散采样中完美重构，必须谨慎选择采样率。\n\n确定避免此信号发生混叠所需的理论最小采样率。答案以千赫兹 (kHz) 表示。", "solution": "该信号是频率为 $f_1$、$f_2$ 和 $f_3$ 的三个正弦波之和，因此它是一个基带受限信号，其最高频率为 $f_{\\max}=\\max\\{f_1, f_2, f_3\\}$。根据奈奎斯特-香农采样定理，对于基带信号，要实现无混叠的完美重构，采样频率 $f_s$ 需满足\n$$\nf_s \\ge 2 f_{\\max}。\n$$\n在此情况下，$f_{\\max}=\\max\\{18.0, 35.5, 45.0\\} \\text{ kHz} = 45.0 \\text{ kHz}$，因此理论最小采样率为\n$$\nf_{s,\\min} = 2 f_{\\max} = 2 \\times 45.0 \\text{ kHz} = 90.0 \\text{ kHz}。\n$$\n振幅和相位不影响此界限。", "answer": "$$\\boxed{90.0}$$", "id": "1557482"}, {"introduction": "如果采样率低于奈奎斯特率，会发生什么？高频信号并不会简单消失，而是会“折叠”到低频区域，伪装成一个完全不同的频率，这就是所谓的“混叠”。这个练习将通过一个具体的例子，让您亲手计算出由于采样不足而产生的混叠频率，直观地理解不当采样如何导致数据失真和误判。[@problem_id:1557477]", "problem": "一个数字数据采集系统用于监测一个模拟传感器的输出电压。该电压信号 $v(t)$ 是两个正弦分量的叠加，由以下方程描述：\n$$v(t) = 3.0 \\cos(100\\pi t) + 2.0 \\sin(250\\pi t)$$\n其中 $v(t)$ 的单位是伏特，时间 $t$ 的单位是秒。\n\n该系统的模数转换器 (ADC) 以 $f_s = 150 \\text{ Hz}$ 的固定速率（每秒150次采样）对该信号进行采样。由于所选的采样率，原始信号中的一个频率分量将被欠采样，导致它在得到的数字数据中表现为一个不同的、更低的频率。这种现象被称为混叠。\n\n这个混叠分量在离散时间信号中表现出的频率是多少？\n\nA. 25 Hz\n\nB. 50 Hz\n\nC. 75 Hz\n\nD. 125 Hz\n\nE. 250 Hz", "solution": "给定的信号为 $v(t)=3.0\\cos(100\\pi t)+2.0\\sin(250\\pi t)$，因此其两个角频率为 $\\omega_1=100\\pi$ 和 $\\omega_2=250\\pi$ 弧度/秒。使用 $f=\\omega/(2\\pi)$ 将其转换为普通频率，得到\n$$f_1=\\frac{100\\pi}{2\\pi}=50\\ \\text{Hz},\\qquad f_2=\\frac{250\\pi}{2\\pi}=125\\ \\text{Hz}.$$\n采样频率为 $f_s=150\\ \\text{Hz}$，所以奈奎斯特频率为\n$$f_N=\\frac{f_s}{2}=75\\ \\text{Hz}.$$\n如果一个连续时间分量的频率超过 $f_N$，它将在离散时间中发生混叠。在这里，$f_1=50 \\text{ Hz}  f_N$ 不会发生混叠，而 $f_2=125 \\text{ Hz} > f_N$ 会发生混叠。混叠（表观）频率 $f_a$ 可通过以下公式将 $f$ 折叠到基带 $[0,f_s/2]$ 内得到：\n$$f_a=\\left|f-m f_s\\right|,$$\n其中 $m$ 是使 $f_a \\in [0,f_s/2]$ 成立的整数。对于 $f=125 \\text{ Hz}$ 和 $f_s=150 \\text{ Hz}$，取 $m=\\operatorname{round}\\!\\left(\\frac{125}{150}\\right)=1$，得到\n$$f_a=\\left|125-1\\cdot 150\\right|=25\\ \\text{Hz}.$$\n因此，频率为 $125\\ \\text{Hz}$ 的欠采样分量在离散时间信号中表现为 $25\\ \\text{Hz}$，这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "1557477"}, {"introduction": "理解了混叠的成因和后果后，下一步便是学习如何从工程上解决它。在实际系统中，我们通常在采样前使用抗混叠滤波器来滤除可能引起混叠的高频噪声。本练习要求您为一个控制系统设计一个巴特沃斯(Butterworth)低通滤波器，使其满足特定的噪声衰减要求，这是连接采样理论与硬件实现的桥梁。[@problem_id:1557475]", "problem": "正在为一个高精度制造过程设计一个数字控制系统。该系统依赖于以 $f_s = 20.0 \\text{ kHz}$ 频率采样的传感器测量值。该控制算法旨在有效管理系统动态，直至奈奎斯特频率。然而，制造环境中存在能产生强正弦电磁干扰的设备，该干扰以频率为 $f_n = 35.0 \\text{ kHz}$ 的噪声分量污染传感器信号。\n\n为防止此高频噪声混叠入控制器的工作频带，在采样器前的信号路径中放置了一个巴特沃斯低通抗混叠滤波器。此滤波器的截止频率 $f_c$ 被精确设置为采样系统的奈奎斯特频率。为使控制器能保持其所需的性能和稳定裕度，频率为 $f_n$ 的噪声分量的幅度必须至少衰减1000倍（即，其滤波后的幅度不得超过其原始幅度的 $0.1\\%$）。\n\n确定满足此衰减指标所需的巴特沃斯滤波器的最小整数阶数 $N$。", "solution": "采样频率为 $f_s = 20.0 \\text{ kHz}$。因此，奈奎斯特频率为 $f_N = \\frac{f_s}{2} = 10.0 \\text{ kHz}$，并且抗混叠巴特沃斯滤波器的截止频率为 $f_c = f_N$。干扰频率为 $f_n = 35.0 \\text{ kHz}$，因此相对于截止频率的频率比为\n$$\nr \\equiv \\frac{f_n}{f_c} = \\frac{f_n}{f_s/2} = \\frac{35.0 \\text{ kHz}}{10.0 \\text{ kHz}} = 3.5.\n$$\n\n对于一个 $N$ 阶巴特沃斯低通滤波器，其在频率 $f$ 处的幅度响应为\n$$\n|H(j2\\pi f)| = \\frac{1}{\\sqrt{1 + \\left(\\frac{f}{f_c}\\right)^{2N}}}.\n$$\n在 $f = f_n$ 处，该式变为\n$$\n|H(j2\\pi f_n)| = \\frac{1}{\\sqrt{1 + r^{2N}}}.\n$$\n\n指标要求幅度衰减因子至少为 $1000$，即\n$$\n|H(j2\\pi f_n)| \\leq \\frac{1}{1000}.\n$$\n将此条件施加于巴特沃斯响应，得到\n$$\n\\frac{1}{\\sqrt{1 + r^{2N}}} \\leq \\frac{1}{1000}\n\\;\\;\\Longrightarrow\\;\\;\n\\sqrt{1 + r^{2N}} \\geq 10^3\n\\;\\;\\Longrightarrow\\;\\;\n1 + r^{2N} \\geq 10^6\n\\;\\;\\Longrightarrow\\;\\;\nr^{2N} \\geq 10^6 - 1.\n$$\n取自然对数，\n$$\n2N \\ln r \\geq \\ln\\!\\left(10^6 - 1\\right)\n\\;\\;\\Longrightarrow\\;\\;\nN \\geq \\frac{1}{2}\\,\\frac{\\ln\\!\\left(10^6 - 1\\right)}{\\ln r}.\n$$\n当 $r = 3.5$ 时，\n$$\nN \\geq \\frac{1}{2}\\,\\frac{\\ln\\!\\left(10^6 - 1\\right)}{\\ln(3.5)} \\approx 5.514\\ldots\n$$\n因此，最小整数阶数为向上取整得到：\n$$\nN_{\\min} = 6.\n$$\n\n验证：\n- 对于 $N = 5$：$r^{2N} = 3.5^{10} \\approx 2.77 \\times 10^5$，因此 $|H| \\approx \\frac{1}{\\sqrt{1 + 2.77 \\times 10^5}} \\approx \\frac{1}{526}$，这不满足要求。\n- 对于 $N = 6$：$r^{2N} = 3.5^{12} \\approx 3.38 \\times 10^6$，因此 $|H| \\approx \\frac{1}{\\sqrt{1 + 3.38 \\times 10^6}} \\approx \\frac{1}{1838}$，这满足要求。\n\n因此，需要一个六阶巴特沃斯滤波器。", "answer": "$$\\boxed{6}$$", "id": "1557475"}]}