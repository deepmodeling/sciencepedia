{"hands_on_practices": [{"introduction": "在鲁棒控制中，我们经常需要处理未建模的动态，这可能表现为增益误差或相位滞后。小增益定理为此提供了一个强大的工具，但理解它到底关注不确定性的哪个属性至关重要。这个练习 [@problem_id:1611059] 旨在阐明，该定理本质上只关心不确定性的“大小”（即其范数），而不区分其具体形式，从而帮助我们建立一个统一的稳定性分析框架。", "problem": "一位控制工程师正在为一个单关节机械臂设计一个反馈系统。该机械臂的执行器和关节动力学的标称模型由一个一阶传递函数 $P_0(s) = \\frac{A}{s+a}$ 表示，其中 $A$ 和 $a$ 是正常数。一个简单的比例控制器 $C(s)=K$（其中 $K>0$）被用于一个标准的负反馈结构中。\n\n该工程师知道标称模型 $P_0(s)$ 是一个近似，而实际对象 $P(s)$ 具有乘性不确定性，使得 $P(s) = P_0(s)(1 + \\Delta(s))$。考虑了这种不确定性的两种可能来源：\n\n1.  **静态增益误差**：执行器的增益与标称值略有偏差。这种不确定性被建模为一个纯实数增益 $\\Delta_1(s) = \\delta_1$，其中 $\\delta_1$ 是一个未知的实常数。令 $|\\delta_1|_{\\max}$ 为此增益误差的最大容许幅值，它能保证对于在此界限内的所有可能的 $\\delta_1$ 值，闭环系统都是稳定的。\n\n2.  **未建模的相位滞后**：存在未建模的高频动力学，主要引入相位滞后。这被近似为一个缩放的一阶全通滤波器 $\\Delta_2(s) = \\delta_2 \\frac{s - \\omega_0}{s + \\omega_0}$，其中 $\\delta_2$ 是一个未知的实常数，$\\omega_0$ 是一个代表未建模动力学频率尺度的正常数。令 $|\\delta_2|_{\\max}$ 为缩放因子 $\\delta_2$ 的最大容许幅值，它能保证闭环稳定性。\n\n基于鲁棒稳定性分析，确定比率 $R = \\frac{|\\delta_1|_{\\max}}{|\\delta_2|_{\\max}}$ 的值。\n\n从以下选项中选择正确的一项：\n\nA. $R = \\frac{a}{AK}$\n\nB. $R = \\frac{AK}{a+AK}$\n\nC. $R = 1$\n\nD. $R = \\frac{a+AK}{AK}$\n\nE. $R$ 的值取决于 $\\omega_0$。", "solution": "标称对象为 $P_{0}(s)=\\frac{A}{s+a}$（其中 $A>0$ 和 $a>0$），控制器为 $C(s)=K$（其中 $K>0$）。标称回路传递函数为\n$$\nL_{0}(s)=C(s)P_{0}(s)=\\frac{AK}{s+a}.\n$$\n互补灵敏度函数为\n$$\nT_{0}(s)=\\frac{L_{0}(s)}{1+L_{0}(s)}=\\frac{\\frac{AK}{s+a}}{1+\\frac{AK}{s+a}}=\\frac{AK}{s+(a+AK)}.\n$$\n对于乘性对象不确定性 $P(s)=P_{0}(s)\\left(1+\\Delta(s)\\right)$，通过小增益定理得到的标准鲁棒稳定性条件是\n$$\n\\|\\Delta\\|_{\\infty}\\,\\|T_{0}\\|_{\\infty}<1,\n$$\n因此，最大容许幅值满足\n$$\n|\\delta|_{\\max}=\\frac{1}{\\|T_{0}\\|_{\\infty}}.\n$$\n我们现在计算 $\\|T_{0}\\|_{\\infty}$。由于 $T_{0}(s)=\\dfrac{AK}{s+(a+AK)}$ 是一个稳定的一阶低通传递函数，其在虚轴上的幅值为\n$$\n|T_{0}(j\\omega)|=\\frac{AK}{\\sqrt{(a+AK)^{2}+\\omega^{2}}}.\n$$\n在 $\\omega\\in\\mathbb{R}$ 上的最大值出现在 $\\omega=0$ 处，因此\n$$\n\\|T_{0}\\|_{\\infty}=|T_{0}(0)|=\\frac{AK}{a+AK}.\n$$\n所以，\n$$\n|\\delta|_{\\max}=\\frac{1}{\\|T_{0}\\|_{\\infty}}=\\frac{a+AK}{AK}.\n$$\n\n情况1（静态增益误差）：$\\Delta_{1}(s)=\\delta_{1}$ 有 $\\|\\Delta_{1}\\|_{\\infty}=|\\delta_{1}|$，所以\n$$\n|\\delta_{1}|_{\\max}=\\frac{a+AK}{AK}.\n$$\n这个界限通过直接分析极点位置也是精确的：当 $P(s)=\\dfrac{A(1+\\delta_{1})}{s+a}$ 时，闭环极点位于 $s=-(a+AK(1+\\delta_{1}))$，对于所有 $|\\delta_{1}|\\leq \\dfrac{a+AK}{AK}$，该极点都保持在开左半平面内；其临界稳定状态由最负的 $\\delta_{1}$ 值决定。\n\n情况2（未建模的相位滞后）：$\\Delta_{2}(s)=\\delta_{2}\\dfrac{s-\\omega_{0}}{s+\\omega_{0}}$ 是稳定且全通的，对于所有实数 $\\omega$ 满足，\n$$\n\\left|\\frac{j\\omega-\\omega_{0}}{j\\omega+\\omega_{0}}\\right|=1,\n$$\n因此 $\\|\\Delta_{2}\\|_{\\infty}=|\\delta_{2}|$。同样的小增益界限得出\n$$\n|\\delta_{2}|_{\\max}=\\frac{a+AK}{AK},\n$$\n该结果与 $\\omega_{0}$ 无关。\n\n因此，该比率为\n$$\nR=\\frac{|\\delta_{1}|_{\\max}}{|\\delta_{2}|_{\\max}}=\\frac{\\frac{a+AK}{AK}}{\\frac{a+AK}{AK}}=1,\n$$\n其值不依赖于 $\\omega_{0}$。", "answer": "$$\\boxed{C}$$", "id": "1611059"}, {"introduction": "理论分析之后，让我们转向几乎所有真实系统中都存在的物理约束：执行器饱和。这个实践 [@problem_id:1611071] 将带你把饱和这一非线性现象看作一个增益有界的算子。通过这种视角，我们可以运用小增益定理来确定保证系统稳定运行的最大控制器增益，这是连接理论与工程实践的关键一步。", "problem": "一个控制系统被设计用来调节一个生物反应器中化学过程的温度。该生物反应器的热动力学由一个线性时不变系统建模。从加热器的输入功率 $v(t)$（单位：瓦特 W）到归一化无量纲温度输出 $y(t)$ 的传递函数由下式给出：\n$$P(s) = \\frac{b}{s+a}$$\n其中参数为 $a = 0.15 \\text{ s}^{-1}$ 和 $b = 0.05 \\text{ W}^{-1}\\cdot\\text{s}^{-1}$。假设被控对象是稳定的，即 $a > 0$。\n\n使用一个具有正增益 $K$ 的简单比例控制器。它接收误差信号 $e(t) = r(t) - y(t)$，其中 $r(t)$ 是期望的参考温度，并计算出期望的加热器功率 $u(t) = K \\cdot e(t)$。\n\n加热器是执行器，它不能提供无限的功率。加热器实际提供的功率 $v(t)$ 受到饱和非线性的约束。如果控制器请求功率 $u(t)$，则提供的功率为 $v(t) = \\text{sat}(u(t))$，其定义如下：\n$$ v(t) = \\begin{cases} u(t) & \\text{if } |u(t)| \\le P_{max} \\\\ P_{max} \\cdot \\text{sgn}(u(t)) & \\text{if } |u(t)| > P_{max} \\end{cases} $$\n此处，$P_{max}$ 是加热器的正最大额定功率。\n\n该闭环系统可以被分析为一个线性系统和一个非线性算子的负反馈互联。使用小增益定理，确定能保证闭环系统对于任意参考输入 $r(t)$ 和任意正的最大功率值 $P_{max}$ 都稳定的正控制器增益 $K$ 的最大值。增益 $K$ 的单位是 $\\text{W}$。将您的答案表示为一个实数。将最终答案四舍五入到两位有效数字。", "solution": "我们将该闭环系统视为一个线性时不变系统和一个静态非线性之间的 Lur'e 互联。信号定义如下：控制器输出为 $u(t)=K e(t)=K(r(t)-y(t))$，执行器输出为 $v(t)=\\text{sat}(u(t))$，被控对象输出为 $y(t)$。从 $v$ 到 $y$ 的被控对象传递函数是 $P(s)=\\frac{b}{s+a}$，其中 $a>0, b>0$。\n\n引入 $w:=u$（非线性环节的输入）和 $z:=v$（非线性环节的输出）。互联方程为\n$$\ny = P z, \\quad w = K(r - y) = K r - K P z.\n$$\n因此，从 $z$ 到 $w$ 的线性映射是 $-K P(s)$，而 $r$ 作为外源输入 $K r$ 迭加进来。饱和算子 $\\text{sat}(\\cdot)$ 满足全局 Lipschitz 界\n$$\n|\\,\\text{sat}(u_{1}) - \\text{sat}(u_{2})\\,| \\le |u_{1} - u_{2}|\n$$\n对于所有的 $u_{1},u_{2}$，因此它在任何信号范数下的诱导增益都以 $1$ 为界。因此，根据小增益定理，对于任意参考输入和任意正的 $P_{max}$，反馈互联系统输入输出稳定的一个充分条件是\n$$\n\\| -K P \\|_{\\infty} \\cdot 1 < 1 \\quad \\Longleftrightarrow \\quad K \\, \\|P\\|_{\\infty} < 1.\n$$\n我们计算 $P(s)=\\frac{b}{s+a}$ 的 $\\mathcal{H}_{\\infty}$ 范数。对于 $\\omega \\in \\mathbb{R}$，\n$$\n|P(j\\omega)| = \\frac{b}{\\sqrt{\\omega^{2}+a^{2}}},\n$$\n此表达式在 $|\\omega|$ 上是严格递减的，因为分母 $\\sqrt{\\omega^{2}+a^{2}}$ 随着 $|\\omega|$ 的增加而增加。因此，最大值在 $\\omega=0$ 处取得，得到\n$$\n\\|P\\|_{\\infty} = \\sup_{\\omega} |P(j\\omega)| = \\frac{b}{a}.\n$$\n小增益条件变为\n$$\nK \\cdot \\frac{b}{a} < 1 \\quad \\Longleftrightarrow \\quad K < \\frac{a}{b}.\n$$\n代入给定的参数 $a=0.15$ 和 $b=0.05$，我们得到\n$$\nK_{\\max} = \\frac{a}{b} = \\frac{0.15}{0.05} = 3.\n$$\n四舍五入到两位有效数字得到 $3.0$。", "answer": "$$\\boxed{3.0}$$", "id": "1611071"}, {"introduction": "小增益定理的威力远不止于分析含静态非线性的系统。本练习 [@problem_id:1611065] 将其应用范围扩展到时变系统，具体来说是一个增益随时间周期性变化的场景。通过计算这个时变组件的诱导 $L_2$ 增益，你将学会如何为更广泛的动态系统建立稳定性保证，深刻体会小增益思想的普适性。", "problem": "一个反馈控制系统由一个稳定的线性时不变 (LTI) 系统 $G$ 与一个时变乘子 $k(t)$ 互联构成。$G$ 的输出（称其为 $y_G$）作为乘子的输入。乘子的输出 $y_k$ 再从一个外部参考信号 $u$ 中减去，以产生 $G$ 的输入。即，$G$ 的输入为 $e_G = u - y_k$。\n\n已知的稳定 LTI 系统 $G$ 具有 $\\gamma_G$ 的诱导 $L_2$ 增益。一个系统的诱导 $L_2$ 增益定义为最小的非负数 $\\gamma$，使得对于所有可能的输入，其输出的 $L_2$ 范数被输入 $L_2$ 范数的 $\\gamma$ 倍所界定。\n\n时变乘子 $k(t)$ 由关系式 $y_k(t) = k(t) y_G(t)$ 刻画，其中增益函数是一个带有直流偏置的纯正弦波，由下式给出：\n$$k(t) = A + B \\sin(\\omega t)$$\n此处，$A$、$B$ 和 $\\omega$ 是实常数。该模型可以表示一个标称增益为 $A$、受到幅值为 $|B|$ 的周期性波动影响的系统组件。\n\n为确保整个闭环系统对于所有可能的 $\\omega$ 值和任何初始状态都稳定，必须使用一个保守的稳定性判据。假设参数使得稳定解成为可能（具体来说，即 $1 - \\gamma_G |A| > 0$），请根据小增益定理，确定保证闭环系统稳定性的振荡分量 $|B|$ 的最大允许幅值。\n\n将您的答案表示为以 $\\gamma_G$ 和 $A$ 表示的闭式解析表达式。", "solution": "设 $G$ 是一个稳定的 LTI 系统，其诱导 $L_2$ 增益为 $\\gamma_G$，因此对所有输入 $e_G$ 都有：\n$$\n\\|y_{G}\\|_{2} \\leq \\gamma_{G}\\|e_{G}\\|_{2}.\n$$\n时变乘子 $k(t)$ 通过 $y_k(t) = k(t) y_G(t)$ 将 $y_G$ 映射到 $y_k$，其中 $k(t) = A+B\\sin(\\omega t)$。乘法算子 $K$ 的诱导 $L_2$ 增益是 $|k(t)|$ 的本性上确界：\n$$\n\\gamma_{K}=\\operatorname{ess\\,sup}_{t}|k(t)|=\\sup_{s\\in[-1,1]}|A+Bs|.\n$$\n由于 $A+Bs$ 在区间 $[A-|B|, A+|B|]$ 内取值，其最大绝对值为\n$$\n\\gamma_{K}=|A|+|B|.\n$$\n在反馈互联 $e_G = u-y_k$ 中，我们有\n$$\n\\|y_{G}\\|_{2} \\leq \\gamma_{G}\\|e_{G}\\|_{2}=\\gamma_{G}\\|u-y_{k}\\|_{2}\\leq \\gamma_{G}\\|u\\|_{2}+\\gamma_{G}\\|y_{k}\\|_{2}\\leq \\gamma_{G}\\|u\\|_{2}+\\gamma_{G}\\gamma_{K}\\|y_{G}\\|_{2}.\n$$\n整理可得\n$$\n\\left(1-\\gamma_{G}\\gamma_{K}\\right)\\|y_{G}\\|_{2}\\leq \\gamma_{G}\\|u\\|_{2}.\n$$\n根据小增益定理，如果\n$$\n\\gamma_{G}\\gamma_{K}<1.\n$$\n则闭环系统对所有 $\\omega$ 都是 $L_2$ 稳定的。\n将 $\\gamma_{K}=|A|+|B|$ 代入可得\n$$\n\\gamma_{G}\\left(|A|+|B|\\right)<1 \\quad \\Longrightarrow \\quad |B|<\\frac{1}{\\gamma_{G}}-|A|.\n$$\n在所述的 $1-\\gamma_{G}|A|>0$ 的假设下，上式右边为正，保证稳定性的最大允许振荡幅值为\n$$\n|B|_{\\max}=\\frac{1}{\\gamma_{G}}-|A|.\n$$\n这个界与 $\\omega$ 无关，因此对所有 $\\omega$ 都有效。", "answer": "$$\\boxed{\\frac{1}{\\gamma_{G}}-|A|}$$", "id": "1611065"}]}