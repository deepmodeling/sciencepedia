{"hands_on_practices": [{"introduction": "在设计分散控制系统时，首要的挑战是如何将控制变量（输入）与被控变量（输出）进行配对。相对增益矩阵（Relative Gain Array, RGA）是解决这一问题的基石，它提供了一种量化多变量系统内部相互作用强度的方法。通过计算和解读 RGA，我们可以为分散控制策略选择最有效的回路配对，避免因不当耦合导致的性能下降或不稳定。这个练习将带你计算一个典型 $2 \\times 2$ 系统的布里斯托 RGA 数值，并据此作出关键的设计决策 [@problem_id:1605982]。", "problem": "一位化学工程师正在为一个热混合单元设计一个分散控制系统。该系统有两个操纵输入：热流的流速 $u_1$ 和冷流的流速 $u_2$。目标是控制两个过程输出：混合流的总体积流量 $y_1$ 和混合流的最终温度 $y_2$。\n\n对于偏离期望操作点的微小偏差，输入和输出之间的稳态关系由线性模型 $\\Delta\\mathbf{y} = K \\Delta\\mathbf{u}$ 描述，其中 $\\mathbf{u} = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$，$\\mathbf{y} = \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix}$，且 $K$ 是系统的稳态增益矩阵。对于这个特定过程，增益矩阵已通过实验确定为：\n$$\nK = \\begin{pmatrix} 0.8 & 0.2 \\\\ 0.2 & 0.8 \\end{pmatrix}\n$$\n\n为了评估控制回路之间的相互作用程度，该工程师决定使用相对增益矩阵 (Relative Gain Array, RGA) 分析。RGA 矩阵 $\\Lambda$ 计算公式为 $\\Lambda = K \\circ (K^{-1})^T$，其中 $\\circ$ 表示逐元素（Hadamard）乘积。一个衡量相互作用的总结性指标是 Bristol 的 RGA 数 $\\eta_{RGA}$，对于一个 $n \\times n$ 的系统，其定义为：\n$$\n\\eta_{RGA} = \\sum_{i=1}^{n} \\sum_{j=1}^{n} |\\lambda_{ij} - \\delta_{ij}|\n$$\n其中 $\\lambda_{ij}$ 是 RGA 矩阵 $\\Lambda$ 的元素，而 $\\delta_{ij}$ 是克罗内克δ（Kronecker delta）（$\\delta_{ij}=1$ 如果 $i=j$ 且 $\\delta_{ij}=0$ 如果 $i \\neq j$）。\n\n您需要完成两个目标：\n1.  计算该系统的 Bristol RGA 数 $\\eta_{RGA}$ 的值。将您的最终答案四舍五入至三位有效数字。\n2.  根据您的分析，选择下面最能描述该系统特性和合适的控制配对策略的陈述。建议的“直接”配对是使用输入 $u_1$ 控制输出 $y_1$ 以及使用输入 $u_2$ 控制输出 $y_2$。\n\nA. 系统具有非常强的相互作用，强烈不建议使用直接配对的分散控制策略，因为它很可能导致不稳定。\n\nB. 系统具有显著的相互作用，虽然直接配对可能稳定，但与多变量控制器相比，其性能将严重下降。\n\nC. 系统是完全解耦的，这意味着直接配对将像两个独立的单回路控制器一样工作，没有任何交叉影响。\n\nD. 系统表现出弱相互作用，推荐使用直接配对 ($u_1 \\to y_1$, $u_2 \\to y_2$) 的分散控制策略，并且预计其性能良好。\n\nE. 系统的相互作用表明，为了实现有效控制，应反转配对 ($u_1 \\to y_2$, $u_2 \\to y_1$)。\n\n请以数对形式提供您的答案：$\\eta_{RGA}$ 的数值和正确陈述对应的字母。", "solution": "该问题要求计算给定 2x2 系统的 Bristol 相对增益矩阵 (RGA) 数 $\\eta_{RGA}$，并对此值进行解释。\n\n**步骤1：计算增益矩阵 K 的逆矩阵。**\n给定的稳态增益矩阵是：\n$$\nK = \\begin{pmatrix} 0.8 & 0.2 \\\\ 0.2 & 0.8 \\end{pmatrix}\n$$\n首先，我们求 $K$ 的行列式：\n$$\n\\det(K) = (0.8)(0.8) - (0.2)(0.2) = 0.64 - 0.04 = 0.60\n$$\n一个 2x2 矩阵 $\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$ 的逆矩阵是 $\\frac{1}{ad-bc} \\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$。\n将此公式应用于 $K$：\n$$\nK^{-1} = \\frac{1}{0.60} \\begin{pmatrix} 0.8 & -0.2 \\\\ -0.2 & 0.8 \\end{pmatrix} = \\begin{pmatrix} \\frac{0.8}{0.6} & -\\frac{0.2}{0.6} \\\\ -\\frac{0.2}{0.6} & \\frac{0.8}{0.6} \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{3} & -\\frac{1}{3} \\\\ -\\frac{1}{3} & \\frac{4}{3} \\end{pmatrix}\n$$\n\n**步骤2：计算 RGA 矩阵 $\\Lambda$。**\nRGA 矩阵定义为 $\\Lambda = K \\circ (K^{-1})^T$。\n首先，我们求 $K^{-1}$ 的转置矩阵。由于 $K^{-1}$ 是一个对称矩阵，其转置矩阵等于其自身：\n$$\n(K^{-1})^T = \\begin{pmatrix} \\frac{4}{3} & -\\frac{1}{3} \\\\ -\\frac{1}{3} & \\frac{4}{3} \\end{pmatrix}\n$$\n现在，我们对 $K$ 和 $(K^{-1})^T$ 进行逐元素（Hadamard）乘积：\n$$\n\\Lambda = K \\circ (K^{-1})^T = \\begin{pmatrix} 0.8 & 0.2 \\\\ 0.2 & 0.8 \\end{pmatrix} \\circ \\begin{pmatrix} \\frac{4}{3} & -\\frac{1}{3} \\\\ -\\frac{1}{3} & \\frac{4}{3} \\end{pmatrix}\n$$\n$$\n\\Lambda = \\begin{pmatrix} 0.8 \\times \\frac{4}{3} & 0.2 \\times (-\\frac{1}{3}) \\\\ 0.2 \\times (-\\frac{1}{3}) & 0.8 \\times \\frac{4}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{3.2}{3} & -\\frac{0.2}{3} \\\\ -\\frac{0.2}{3} & \\frac{3.2}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{16}{15} & -\\frac{1}{15} \\\\ -\\frac{1}{15} & \\frac{16}{15} \\end{pmatrix}\n$$\n作为检验，RGA 矩阵的任何行或列的元素之和必须为 1。对于第一行：$\\frac{16}{15} - \\frac{1}{15} = \\frac{15}{15} = 1$。计算是正确的。\n\n**步骤3：计算 Bristol 的 RGA 数 $\\eta_{RGA}$。**\n给出的定义是 $\\eta_{RGA} = \\sum_{i=1}^{2} \\sum_{j=1}^{2} |\\lambda_{ij} - \\delta_{ij}|$。\n对于一个 2x2 系统，克罗内克δ矩阵是单位矩阵 $I = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$。\n因此我们需要计算：\n$$\n\\eta_{RGA} = |\\lambda_{11}-1| + |\\lambda_{12}-0| + |\\lambda_{21}-0| + |\\lambda_{22}-1|\n$$\n代入我们计算出的 $\\Lambda$ 的值：\n$$\n\\eta_{RGA} = \\left|\\frac{16}{15}-1\\right| + \\left|-\\frac{1}{15}-0\\right| + \\left|-\\frac{1}{15}-0\\right| + \\left|\\frac{16}{15}-1\\right|\n$$\n$$\n\\eta_{RGA} = \\left|\\frac{1}{15}\\right| + \\left|-\\frac{1}{15}\\right| + \\left|-\\frac{1}{15}\\right| + \\left|\\frac{1}{15}\\right|\n$$\n$$\n\\eta_{RGA} = \\frac{1}{15} + \\frac{1}{15} + \\frac{1}{15} + \\frac{1}{15} = \\frac{4}{15}\n$$\n现在，我们将此分数转换为小数，并四舍五入至三位有效数字：\n$$\n\\eta_{RGA} = \\frac{4}{15} \\approx 0.26666...\n$$\n四舍五入至三位有效数字得到 $\\eta_{RGA} = 0.267$。\n\n**步骤4：解释结果并选择正确的陈述。**\nRGA 数 $\\eta_{RGA}$ 为 0 表示一个完全解耦的系统（对角或反对角）。随着该数值从 0 增加，表示相互作用的程度越强。$\\eta_{RGA} \\approx 0.267$ 这个值很小且接近 0，这表明控制回路之间的相互作用很弱。\n\n此外，我们检查 RGA 矩阵 $\\Lambda$ 本身。\n$$\n\\Lambda = \\begin{pmatrix} 16/15 & -1/15 \\\\ -1/15 & 16/15 \\end{pmatrix} \\approx \\begin{pmatrix} 1.067 & -0.067 \\\\ -0.067 & 1.067 \\end{pmatrix}\n$$\n配对的经验法则是选择对应于正值且接近 1 的 RGA 元素 ($\\lambda_{ij}$) 的输入-输出对。\n对于直接配对 ($u_1 \\to y_1$, $u_2 \\to y_2$)，对应的 RGA 元素是 $\\lambda_{11} = 16/15$ 和 $\\lambda_{22} = 16/15$。两者均为正值且非常接近 1。\n对于反转配对 ($u_1 \\to y_2$, $u_2 \\to y_1$)，RGA 元素是 $\\lambda_{21} = -1/15$ 和 $\\lambda_{12} = -1/15$。这些是负值，表明这种配对会导致回路不稳定或反向作用。\n\n因此，弱相互作用（小的 $\\eta_{RGA}$）和对角配对的 RGA 元素接近 1 强烈表明，直接配对 ($u_1 \\to y_1$, $u_2 \\to y_2$) 是分散控制策略的一个好选择。\n\n我们来评估一下各个选项：\nA：不正确。相互作用是弱的，不是强的。\nB：不正确。由于相互作用弱，性能下降应该是最小的。\nC：不正确。系统不是完全解耦的，因为 $\\eta_{RGA} \\neq 0$ 且 $\\Lambda$ 的非对角元素不为零。\nD：正确。相互作用很弱，推荐采用直接配对策略。\nE：不正确。负的 RGA 元素强烈不建议采用反转配对。\n\n最终答案由数值 0.267 和字母 D 组成。", "answer": "$$\\boxed{\\begin{pmatrix} 0.267 & D \\end{pmatrix}}$$", "id": "1605982"}, {"introduction": "当我们通过 RGA 分析发现系统各回路之间存在不可忽略的强相互作用时，简单的分散控制可能无法满足性能要求。此时，一个更主动的策略是设计一个“解耦器”（decoupler），从结构上消除或减弱回路间的耦合。这个练习将指导你如何为一个 $2 \\times 2$ 系统设计一个理想的前置补偿解耦器，将一个相互耦合的 MIMO 系统转变为两个独立的 SISO 系统，从而极大地简化后续的控制器设计 [@problem_id:1568170]。", "problem": "考虑一个线性的、时不变的、双输入双输出 (TITO) 过程，该过程模拟了化学反应器中两个变量之间的相互作用。该过程由以下传递函数矩阵 $G(s)$ 描述：\n$$\nG(s) = \\begin{pmatrix} G_{11}(s) & G_{12}(s) \\\\ G_{21}(s) & G_{22}(s) \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{s+1} & \\frac{1}{s+3} \\\\ \\frac{3/2}{s+4} & \\frac{3}{s+2} \\end{pmatrix}\n$$\n为了简化控制设计，引入了一个前置补偿器 $D(s)$，也称为解耦器。解耦器被设计为以下通用结构：\n$$\nD(s) = \\begin{pmatrix} 1 & d_{12}(s) \\\\ d_{21}(s) & 1 \\end{pmatrix}\n$$\n目标是选择非对角元素 $d_{12}(s)$ 和 $d_{21}(s)$ 的传递函数，使得由表观被控对象矩阵 $Q(s) = G(s)D(s)$ 描述的补偿后系统为对角阵。这种解耦作用确保了第一个输入只影响第一个输出，第二个输入只影响第二个输出。\n\n确定解耦器元素 $d_{12}(s)$ 和 $d_{21}(s)$ 的解析表达式。将最终答案表示为一个 1x2 的行矩阵，其中 $d_{12}(s)$ 为第一个元素，$d_{21}(s)$ 为第二个元素。", "solution": "我们得到 TITO 被控对象\n$$\nG(s)=\\begin{pmatrix}\nG_{11}(s) & G_{12}(s)\\\\\nG_{21}(s) & G_{22}(s)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{2}{s+1} & \\frac{1}{s+3}\\\\\n\\frac{3/2}{s+4} & \\frac{3}{s+2}\n\\end{pmatrix},\n$$\n和一个右前置补偿器（解耦器）\n$$\nD(s)=\\begin{pmatrix}\n1 & d_{12}(s)\\\\\nd_{21}(s) & 1\n\\end{pmatrix}.\n$$\n补偿后的（表观）被控对象为\n$$\nQ(s)=G(s)D(s).\n$$\n矩阵相乘得到\n$$\nQ(s)=\\begin{pmatrix}\nG_{11}+G_{12}d_{21} & G_{11}d_{12}+G_{12}\\\\\nG_{21}+G_{22}d_{21} & G_{21}d_{12}+G_{22}\n\\end{pmatrix}.\n$$\n为了实现解耦，我们要求非对角项为零：\n$$\nG_{11}d_{12}+G_{12}=0,\\qquad G_{21}+G_{22}d_{21}=0.\n$$\n解这些关于解耦器元素的线性方程，得到\n$$\nd_{12}(s)=-\\frac{G_{12}(s)}{G_{11}(s)},\\qquad d_{21}(s)=-\\frac{G_{21}(s)}{G_{22}(s)}.\n$$\n代入给定的传递函数，\n$$\nd_{12}(s)=-\\frac{\\frac{1}{s+3}}{\\frac{2}{s+1}}=-\\frac{s+1}{2(s+3)},\n\\qquad\nd_{21}(s)=-\\frac{\\frac{3/2}{s+4}}{\\frac{3}{s+2}}=-\\frac{(3/2)(s+2)}{3(s+4)}=-\\frac{s+2}{2(s+4)}.\n$$\n解耦验证：\n$$\nQ_{12}=G_{11}d_{12}+G_{12}=\\frac{2}{s+1}\\left(-\\frac{s+1}{2(s+3)}\\right)+\\frac{1}{s+3}=-\\frac{1}{s+3}+\\frac{1}{s+3}=0,\n$$\n$$\nQ_{21}=G_{21}+G_{22}d_{21}=\\frac{3/2}{s+4}+\\frac{3}{s+2}\\left(-\\frac{s+2}{2(s+4)}\\right)=\\frac{3/2}{s+4}-\\frac{3/2}{s+4}=0.\n$$\n因此，所选择的 $d_{12}(s)$ 和 $d_{21}(s)$ 实现了一个对角的表观被控对象 $Q(s)$。", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{s+1}{2(s+3)} & -\\frac{s+2}{2(s+4)}\\end{pmatrix}}$$", "id": "1568170"}, {"introduction": "虽然稳态 RGA（即在 $s=0$ 时评估）是一个极其有用的初步分析工具，但我们必须警惕它的局限性。系统间的相互作用是动态的，会随着频率变化而变化，仅依赖稳态信息有时会得出过于乐观或误导性的结论。本练习通过一个特殊的案例，揭示了当系统传递函数中存在近似的极点-零点对消时，动态 RGA 在某些工作频率下的表现可能与稳态分析截然不同，这强调了在进行控制配对决策时考虑系统动态特性的重要性 [@problem_id:1568180]。", "problem": "在为多输入多输出 (MIMO) 过程设计分散控制系统时，相对增益矩阵 (RGA) 是一个关键工具，用于选择操作变量（输入）和被控变量（输出）之间的适当配对。对于一个传递函数矩阵为 $G(s)$ 的 2x2 系统，RGA（记为 $\\Lambda(s)$）是一个 2x2 矩阵，定义为 $\\Lambda(s) = G(s) \\circ (G^{-1}(s))^T$，其中 $\\circ$ 表示逐元素（哈达玛）积。所有关于配对的信息都包含在主导元素 $\\lambda_{11}(s)$ 中，其计算公式为：\n$$\n\\lambda_{11}(s) = \\frac{g_{11}(s)g_{22}(s)}{g_{11}(s)g_{22}(s) - g_{12}(s)g_{21}(s)}\n$$\n通常，RGA 在稳态 ($s=0$) 进行评估。根据 Bristol 准则，推荐选择对应 $\\lambda_{ij}(0)$ 值接近 1 的配对。然而，如果过程具有某些动态特性，这种稳态分析可能会产生误导。其中一个这样的特性是非对角传递函数中存在近似的极点-零点对消，这在稳态时可能影响很小，但在工作频率下会引起显著的交互作用。\n\n考虑一个由以下传递函数矩阵描述的 2x2 过程：\n$$\nG(s) = \\begin{pmatrix} \\frac{2}{s+1} & \\frac{1}{s+1} \\\\ \\frac{0.2(-10s+1)}{10.1s+1} & \\frac{2}{s+1} \\end{pmatrix}\n$$\n非对角项 $g_{21}(s)$ 在 $s=0.1$ 处有一个右半平面零点，在 $s = -1/10.1 \\approx -0.099$ 处有一个左半平面极点。这些值在实轴上的邻近性构成了一个可能使稳态 RGA 分析不可靠的特性。\n\n为说明动态效应如何改变配对建议，请计算 RGA 元素 $\\lambda_{11}(s)$ 在角频率 $\\omega = 1.0$ rad/s 时的幅值。答案请四舍五入至三位有效数字。", "solution": "给定 2x2 传递函数矩阵的各项为：\n$$\ng_{11}(s) = \\frac{2}{s+1},\\quad g_{22}(s) = \\frac{2}{s+1},\\quad g_{12}(s) = \\frac{1}{s+1},\\quad g_{21}(s) = \\frac{0.2(-10s+1)}{10.1s+1}.\n$$\n对于一个 2x2 系统，RGA 的主导元素是\n$$\n\\lambda_{11}(s) = \\frac{g_{11}(s)g_{22}(s)}{g_{11}(s)g_{22}(s) - g_{12}(s)g_{21}(s)}.\n$$\n符号化计算乘积：\n$$\ng_{11}(s)g_{22}(s) = \\frac{4}{(s+1)^{2}},\\qquad g_{12}(s)g_{21}(s) = \\frac{0.2(-10s+1)}{(s+1)(10.1s+1)}.\n$$\n因此，\n$$\n\\lambda_{11}(s) = \\frac{\\frac{4}{(s+1)^{2}}}{\\frac{4}{(s+1)^{2}} - \\frac{0.2(-10s+1)}{(s+1)(10.1s+1)}}.\n$$\n分子和分母同乘以 $(s+1)^{2}(10.1s+1)$ 以消去分数：\n$$\n\\lambda_{11}(s) = \\frac{4(10.1s+1)}{4(10.1s+1) - 0.2(-10s+1)(s+1)}.\n$$\n在角频率 $\\omega=1$ rad/s 处进行评估，令 $s=\\mathrm{j}\\omega=\\mathrm{j}$：\n$$\n10.1s+1 = 1+10.1\\mathrm{j},\\quad -10s+1 = 1-10\\mathrm{j},\\quad s+1 = 1+\\mathrm{j}.\n$$\n计算中间乘积：\n$$\n(-10s+1)(s+1) = (1-10\\mathrm{j})(1+\\mathrm{j}) = 11 - 9\\mathrm{j}.\n$$\n然后\n$$\n4(10.1s+1) = 4 + 40.4\\mathrm{j},\\qquad 0.2(-10s+1)(s+1) = 2.2 - 1.8\\mathrm{j}.\n$$\n因此\n$$\n\\lambda_{11}(\\mathrm{j}) = \\frac{4 + 40.4\\mathrm{j}}{\\,\\left(4 + 40.4\\mathrm{j}\\right) - \\left(2.2 - 1.8\\mathrm{j}\\right)\\,} = \\frac{4 + 40.4\\mathrm{j}}{1.8 + 42.2\\mathrm{j}}.\n$$\n其幅值为\n$$\n|\\lambda_{11}(\\mathrm{j})| = \\frac{|4 + 40.4\\mathrm{j}|}{|1.8 + 42.2\\mathrm{j}|} = \\frac{\\sqrt{4^{2} + 40.4^{2}}}{\\sqrt{1.8^{2} + 42.2^{2}}} = \\frac{\\sqrt{1648.16}}{\\sqrt{1784.08}} = \\sqrt{\\frac{1648.16}{1784.08}}.\n$$\n数值上，\n$$\n\\frac{1648.16}{1784.08} \\approx 0.923815,\\quad \\Rightarrow\\quad |\\lambda_{11}(\\mathrm{j})| \\approx \\sqrt{0.923815} \\approx 0.961.\n$$\n四舍五入至三位有效数字，幅值为 $0.961$。", "answer": "$$\\boxed{0.961}$$", "id": "1568180"}]}