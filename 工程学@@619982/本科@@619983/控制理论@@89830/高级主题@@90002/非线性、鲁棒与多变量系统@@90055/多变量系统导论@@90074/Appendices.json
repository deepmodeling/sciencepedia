{"hands_on_practices": [{"introduction": "理论上，一个完全可控的系统允许我们将闭环极点放置在任何期望的位置。然而，在现实世界中，执行器故障等问题可能会限制我们的控制能力，导致某些系统动态无法改变。这个练习将通过一个执行器耦合的例子，探讨一个多输入系统如何因为内部约束而失去部分可控性，从而产生固定的、无法移动的极点 [@problem_id:1583841]。", "problem": "一个双输入、三状态的线性时不变（LTI）系统由状态空间方程 $\\dot{x}(t) = Ax(t) + Bu(t)$ 描述，其中 $x(t) \\in \\mathbb{R}^3$ 是状态向量，$u(t) = \\begin{pmatrix} u_1(t) \\\\ u_2(t) \\end{pmatrix}$ 是输入向量。系统矩阵由下式给出：\n$$\nA = \\begin{pmatrix}\n0 & 1 & 0 \\\\\n0 & 0 & 1 \\\\\n-6 & -11 & -6\n\\end{pmatrix}, \\quad\nB = \\begin{pmatrix}\n1 & 0 \\\\\n0 & 1 \\\\\n0 & 0\n\\end{pmatrix}\n$$\n初始时，该系统是完全能控的，这意味着对于任意一组期望的三个稳定复数，可以设计一个形式为 $u(t) = -Kx(t)$ 的状态反馈控制器，将闭环系统的极点精确地配置在这些位置。\n\n假设由于执行器连杆的机械故障，两个控制输入通过刚性约束 $u_1(t) = \\alpha u_2(t)$ 耦合在一起，其中常数 $\\alpha$ 为 $-\\frac{4}{3}$。这个故障实际上将独立的控制信号数量从两个减少到一个。其结果是，可实现的闭环极点位置集合被急剧地减小了。事实上，系统的一个或多个极点变成了固定的，并且无法通过施加于受约束系统的任何状态反馈律来移动。\n\n在执行器约束下，确定系统中任何此类固定的、不可移动的极点的数值。如果存在多个这样的极点，请全部列出。", "solution": "在约束条件 $u_{1}(t)=\\alpha u_{2}(t)$ 下，其中 $\\alpha=-\\frac{4}{3}$，定义单个输入 $v(t)=u_{2}(t)$，因此 $u(t)=\\begin{pmatrix}\\alpha \\\\ 1\\end{pmatrix}v(t)$。等效的输入矩阵变为\n$$\nb \\equiv B\\begin{pmatrix}\\alpha \\\\ 1\\end{pmatrix}=\\alpha b_{1}+b_{2}=\\begin{pmatrix}\\alpha \\\\ 1 \\\\ 0\\end{pmatrix},\\quad \\text{其中 }\\alpha=-\\frac{4}{3}.\n$$\n因此，受约束的系统是单输入单输出（SISO）的：\n$$\n\\dot{x}(t)=Ax(t)+b\\,v(t),\\qquad v(t)=-k^{T}x(t),\n$$\n得到闭环矩阵 $A_{\\text{cl}}=A-bk^{T}$。在单输入单输出系统中，$(A,b)$ 的任何一个不能控的特征值都是状态反馈下的一个固定（不可移动）的极点。根据 PBH 能控性测试，如果存在一个非零行向量 $w^{T}$ 满足以下条件，则 $A$ 的一个特征值 $\\lambda$ 是不能控的：\n$$\nw^{T}A=\\lambda w^{T},\\qquad w^{T}b=0.\n$$\n\n首先，计算 $A$ 的特征值。其特征多项式为\n$$\n\\det(sI-A)=s^{3}+6s^{2}+11s+6=(s+1)(s+2)(s+3),\n$$\n所以特征值为 $\\lambda\\in\\{-1,-2,-3\\}$。\n\n令 $q$ 为 $A^{T}$ 对应于特征值 $\\lambda$ 的一个（列）特征向量，即 $A^{T}q=\\lambda q$。记 $q=\\begin{pmatrix}q_{1}\\\\ q_{2}\\\\ q_{3}\\end{pmatrix}$ 并使用\n$$\nA^{T}=\\begin{pmatrix}\n0 & 0 & -6\\\\\n1 & 0 & -11\\\\\n0 & 1 & -6\n\\end{pmatrix},\n$$\n特征向量方程得出\n$$\n-6q_{3}=\\lambda q_{1},\\qquad q_{1}-11q_{3}=\\lambda q_{2},\\qquad q_{2}-6q_{3}=\\lambda q_{3}.\n$$\n由此可得，\n$$\nq_{2}=(\\lambda+6)q_{3},\\qquad q_{1}=-\\frac{6}{\\lambda}q_{3}.\n$$\nPBH 条件 $w^{T}b=0$ 变为 $q^{T}b=0$，即\n$$\n\\alpha q_{1}+q_{2}=0 \\;\\;\\Longleftrightarrow\\;\\; \\alpha\\left(-\\frac{6}{\\lambda}q_{3}\\right)+(\\lambda+6)q_{3}=0.\n$$\n对于非零的 $q_{3}$，这可以简化为\n$$\n-\\frac{6\\alpha}{\\lambda}+\\lambda+6=0 \\;\\;\\Longleftrightarrow\\;\\; \\lambda^{2}+6\\lambda-6\\alpha=0.\n$$\n代入 $\\alpha=-\\frac{4}{3}$ 得到\n$$\n\\lambda^{2}+6\\lambda+8=0 \\;\\;\\Longleftrightarrow\\;\\; (\\lambda+2)(\\lambda+4)=0,\n$$\n所以候选的不能控特征值为 $\\lambda=-2$ 和 $\\lambda=-4$。只有那些同时也是 $A$ 的特征值的才能成为固定极点。由于 $A$ 的特征值为 $\\{-1,-2,-3\\}$，唯一的公共值是 $\\lambda=-2$。\n\n因此，受约束的系统在 $\\lambda=-2$ 处有一个固定的、不可移动的极点；另外两个极点在能控子空间内仍然是可配置的。", "answer": "$$\\boxed{-2}$$", "id": "1583841"}, {"introduction": "多变量系统的一个显著特征是其复杂的内部耦合，这可能导致非直观的动态行为。这个练习模拟了一个化学反应器，其中对一个输入的改变，在另一个输出被严格控制的条件下，会引起非最小相位响应（即初始逆响应）。通过分析这个问题，你将亲身体会到多变量零点是如何影响系统暂态性能的，这是设计高性能控制器时必须考虑的关键因素 [@problem_id:1583833]。", "problem": "考虑一个在连续搅拌釜反应器（CSTR）中发生的化学过程。该过程被建模为一个2输入、2输出的线性系统，这是一种多输入多输出（MIMO）系统。输入为反应物A的流速，记为 $u_1(t)$，以及一种催化剂的流速 $u_2(t)$。输出为期望产物P的浓度 $y_1(t)$，以及反应器内的温度 $y_2(t)$。所有变量均表示与稳态工作点的偏差。\n\n在拉普拉斯域中，输入和输出之间的动态关系由传递函数矩阵 $G(s)$ 描述：\n$$\n\\begin{pmatrix} Y_1(s) \\\\ Y_2(s) \\end{pmatrix} = G(s) \\begin{pmatrix} U_1(s) \\\\ U_2(s) \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{2s+1} & \\frac{1}{s+1} \\\\ \\frac{4}{s+1} & \\frac{3}{s+1} \\end{pmatrix} \\begin{pmatrix} U_1(s) \\\\ U_2(s) \\end{pmatrix}\n$$\n初始时，系统处于稳态，对于 $t<0$，有 $u_1(t)=0$ 和 $u_2(t)=0$。一个控制系统被实施，其目标是完美地将反应器温度维持在初始设定点，即确保对于所有 $t \\geq 0$，都有 $y_2(t) = 0$。为实现这一目标，控制器操纵催化剂的流速 $u_2(t)$。\n\n在时间 $t=0$ 时，反应物A的流速经历一个单位阶跃增加，因此对于 $t \\geq 0$，有 $u_1(t) = 1$。\n\n对于 $t > 0$，以下哪个陈述最能描述产物浓度 $y_1(t)$ 的定性时间演变？\n\nA. $y_1(t)$ 从0单调增加到一个新的正稳态值。\n\nB. $y_1(t)$ 初始时减少，变为负值，然后上升到一个新的正稳态值。\n\nC. $y_1(t)$ 从0开始增加，超过其最终稳态值（超调），然后稳定在该值。\n\nD. $y_1(t)$ 从0单调减少到一个新的负稳态值。\n\nE. $y_1(t)$ 初始时增加，变为正值，然后下降到一个新的负稳态值。", "solution": "我们在拉普拉斯域中使用线性MIMO传递关系。输出为\n$$\n\\begin{pmatrix} Y_{1}(s) \\\\ Y_{2}(s) \\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{2}{2s+1} & \\frac{1}{s+1} \\\\\n\\frac{4}{s+1} & \\frac{3}{s+1}\n\\end{pmatrix}\n\\begin{pmatrix} U_{1}(s) \\\\ U_{2}(s) \\end{pmatrix}.\n$$\n控制目标是对于 $t\\geq 0$ 维持 $y_{2}(t)=0$。在拉普拉斯形式下，这表示 $Y_{2}(s)=0$，因此\n$$\nY_{2}(s)=\\frac{4}{s+1}U_{1}(s)+\\frac{3}{s+1}U_{2}(s)=0\n\\quad\\Longrightarrow\\quad\nU_{2}(s)=-\\frac{4}{3}U_{1}(s).\n$$\n在 $t=0$ 时，反应物流速经历一个单位阶跃，所以 $U_{1}(s)=\\frac{1}{s}$，因此\n$$\nU_{2}(s)=-\\frac{4}{3}\\cdot\\frac{1}{s}.\n$$\n产物浓度的输出为\n$$\nY_{1}(s)=\\frac{2}{2s+1}U_{1}(s)+\\frac{1}{s+1}U_{2}(s)\n=\\left(\\frac{2}{2s+1}-\\frac{4}{3}\\cdot\\frac{1}{s+1}\\right)\\frac{1}{s}\n=\\frac{2}{s(2s+1)}-\\frac{4}{3}\\cdot\\frac{1}{s(s+1)}.\n$$\n对每一项进行反变换。首先，\n$$\n\\frac{2}{s(2s+1)}=\\frac{2}{s}-\\frac{4}{2s+1}\n\\quad\\Longrightarrow\\quad\n\\mathcal{L}^{-1}\\left\\{\\frac{2}{s(2s+1)}\\right\\}=2-2\\exp\\!\\left(-\\frac{t}{2}\\right).\n$$\n其次，\n$$\n\\frac{4}{3}\\cdot\\frac{1}{s(s+1)}=\\frac{4}{3}\\left(\\frac{1}{s}-\\frac{1}{s+1}\\right)\n\\quad\\Longrightarrow\\quad\n\\mathcal{L}^{-1}\\left\\{\\frac{4}{3}\\cdot\\frac{1}{s(s+1)}\\right\\}=\\frac{4}{3}-\\frac{4}{3}\\exp(-t).\n$$\n因此\n$$\ny_{1}(t)=\\left[2-2\\exp\\!\\left(-\\frac{t}{2}\\right)\\right]-\\left[\\frac{4}{3}-\\frac{4}{3}\\exp(-t)\\right]\n=\\frac{2}{3}-2\\exp\\!\\left(-\\frac{t}{2}\\right)+\\frac{4}{3}\\exp(-t),\\quad t\\geq 0.\n$$\n定性特征：\n- 初始值：$y_{1}(0^{+})=\\frac{2}{3}-2+\\frac{4}{3}=0$。\n- 初始斜率：$y_{1}'(t)=\\exp\\!\\left(-\\frac{t}{2}\\right)-\\frac{4}{3}\\exp(-t)$，所以 $y_{1}'(0^{+})=1-\\frac{4}{3}=-\\frac{1}{3}<0$。因此 $y_{1}$ 初始时减少到零以下。\n- 稳态：$\\lim_{t\\to\\infty}y_{1}(t)=\\frac{2}{3}>0$。\n- 极值：$y_{1}'(t)=0$ 得到 $\\exp(t/2)=\\frac{4}{3}$，这是一个唯一的 $t>0$ 的最小值点。在此点求值得到 $y_{1}<0$，证实了存在一个下冲（undershoot）。当 $t\\to\\infty$ 时，瞬态项 $-2\\exp(-t/2)+\\frac{4}{3}\\exp(-t)$ 保持为负并趋于0，因此 $y_{1}(t)$ 从下方接近 $\\frac{2}{3}$ 而没有超调。\n\n因此, $y_{1}(t)$ 初始时减少并变为负值，然后上升到一个正的稳态值。这对应于选项B。", "answer": "$$\\boxed{B}$$", "id": "1583833"}, {"introduction": "在现代控制工程中，控制器通常由数字计算机实现，这要求我们将连续时间系统模型转换为离散时间形式。本练习将引导你完成这一关键步骤，使用零阶保持（ZOH）方法对一个简化的无人机模型进行离散化。掌握这种转换是连接控制理论与实际数字控制系统实现的桥梁 [@problem_id:1583869]。", "problem": "一个在垂直平面内运行的四旋翼无人机的简化横向动力学模型由连续时间状态空间表示 $\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t) + B\\mathbf{u}(t)$ 描述。状态向量定义为 $\\mathbf{x} = [p, \\dot{p}, \\phi, \\dot{\\phi}]^T$，其中 $p$ 是水平位置，$\\dot{p}$ 是水平速度，$\\phi$ 是相对于垂直轴的滚转角，$\\dot{\\phi}$ 是滚转角速度。输入向量为 $\\mathbf{u} = [u_1, u_2]^T$，其中 $u_1$ 是与滚转力矩相关的控制输入，$u_2$ 是一个直接的水平推力。\n\n系统动力学由以下矩阵给出：\n$$\nA = \\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 0 & 0 & g & 0 \\\\ 0 & 0 & 0 & 1 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 & 0 \\\\ 0 & 1/m \\\\ 0 & 0 \\\\ \\eta & 0 \\end{pmatrix}\n$$\n其中 $g$ 是重力加速度，$m$ 是无人机的质量，$\\eta$ 是一个代表滚转力矩控制有效性的正常数。\n\n为了实现数字控制器，这个连续时间模型必须被转换为形式为 $\\mathbf{x}_{k+1} = A_d \\mathbf{x}_k + B_d \\mathbf{u}_k$ 的等效离散时间模型，其中 $T_s$ 是采样周期。该转换是在假设控制输入向量 $\\mathbf{u}(t)$ 在每个采样区间 $[kT_s, (k+1)T_s)$ 内保持恒定的前提下进行的，这对应于对输入的零阶保持器 (ZOH)。\n\n确定离散时间输入矩阵 $B_d$。请用符号参数 $g$、$m$、$\\eta$ 和 $T_s$ 将您的答案表示为一个矩阵。", "solution": "在输入采用零阶保持器的情况下，精确的离散时间矩阵由下式给出\n$$\nA_{d}=\\exp(A T_{s}), \\quad B_{d}=\\int_{0}^{T_{s}} \\exp(A \\tau)\\, B \\, \\mathrm{d}\\tau.\n$$\n因此我们需要 $\\exp(A \\tau)$。由于 $A$ 是一个严格上三角矩阵，其高于三阶的幂均为零。计算所需的幂：\n$$\nA=\\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 0 & 0 & g & 0 \\\\ 0 & 0 & 0 & 1 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}, \\quad\nA^{2}=\\begin{pmatrix} 0 & 0 & g & 0 \\\\ 0 & 0 & 0 & g \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}, \\quad\nA^{3}=\\begin{pmatrix} 0 & 0 & 0 & g \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}, \\quad\nA^{4}=0.\n$$\n因此，\n$$\n\\exp(A \\tau)=I + A \\tau + \\frac{A^{2} \\tau^{2}}{2} + \\frac{A^{3} \\tau^{3}}{6}\n=\\begin{pmatrix}\n1 & \\tau & \\frac{g \\tau^{2}}{2} & \\frac{g \\tau^{3}}{6} \\\\\n0 & 1 & g \\tau & \\frac{g \\tau^{2}}{2} \\\\\n0 & 0 & 1 & \\tau \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}.\n$$\n接下来使用下式计算 $\\exp(A \\tau) B$\n$$\nB=\\begin{pmatrix} 0 & 0 \\\\ 0 & \\frac{1}{m} \\\\ 0 & 0 \\\\ \\eta & 0 \\end{pmatrix}.\n$$\n结果是\n$$\n\\exp(A \\tau) B\n=\n\\begin{pmatrix}\n\\frac{\\eta g \\tau^{3}}{6} & \\frac{\\tau}{m} \\\\\n\\frac{\\eta g \\tau^{2}}{2} & \\frac{1}{m} \\\\\n\\eta \\tau & 0 \\\\\n\\eta & 0\n\\end{pmatrix}.\n$$\n从 $\\tau=0$ 到 $\\tau=T_{s}$ 逐项积分，得到\n$$\nB_{d}=\\int_{0}^{T_{s}} \\exp(A \\tau) B \\, \\mathrm{d}\\tau\n=\n\\begin{pmatrix}\n\\frac{\\eta g T_{s}^{4}}{24} & \\frac{T_{s}^{2}}{2 m} \\\\\n\\frac{\\eta g T_{s}^{3}}{6} & \\frac{T_{s}}{m} \\\\\n\\frac{\\eta T_{s}^{2}}{2} & 0 \\\\\n\\eta T_{s} & 0\n\\end{pmatrix}.\n$$\n这就是在采样周期为 $T_s$ 的零阶保持器下的离散时间输入矩阵。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\eta g T_{s}^{4}}{24} & \\frac{T_{s}^{2}}{2 m} \\\\ \\frac{\\eta g T_{s}^{3}}{6} & \\frac{T_{s}}{m} \\\\ \\frac{\\eta T_{s}^{2}}{2} & 0 \\\\ \\eta T_{s} & 0\\end{pmatrix}}$$", "id": "1583869"}]}