{"hands_on_practices": [{"introduction": "在多变量控制中，最直接的处理交互的方法是设计一个补偿器来抵消不希望的交叉耦合。本练习将引导你为一假设的化学反应器设计一个静态预补偿器，其目标是在稳态下实现理想的解耦 [@problem_id:1581230]。通过计算过程增益矩阵的逆，你将学习如何从数学上消除输入-输出通道之间的稳态交互，使复杂的系统表现得像一组简单的独立单元。", "problem": "一个在连续搅拌釜反应器（CSTR）中进行的化学过程具有两个操作输入和两个测量输出。输入是反应物的摩尔流率 $u_1$ 和冷却剂的流率 $u_2$。输出是产物浓度 $y_1$ 和反应器温度 $y_2$。在标称工作点附近的小偏差范围内，反应器的稳态行为可用一个线性模型描述，该模型将输出变化量 $\\Delta y$ 与输入变化量 $\\Delta u$ 联系起来。该关系由过程增益矩阵 $K_p$ 给出，如下所示：\n$$\n\\Delta y = K_p \\Delta u \\quad \\text{其中} \\quad \\Delta y = \\begin{pmatrix} \\Delta y_1 \\\\ \\Delta y_2 \\end{pmatrix} \\quad \\text{且} \\quad \\Delta u = \\begin{pmatrix} \\Delta u_1 \\\\ \\Delta u_2 \\end{pmatrix}\n$$\n该系统的经验确定过程增益矩阵为：\n$$\nK_p = \\begin{pmatrix} 2.5 & -0.5 \\\\ 1.5 & 4.0 \\end{pmatrix}\n$$\n非零的非对角元素表明该系统是耦合的；改变一个输入会影响两个输出。为了简化反应器的控制，将实施一个静态预补偿器矩阵 $D$。该矩阵通过方程 $\\Delta u = D \\Delta v$ 将一组新的独立指令信号 $\\Delta v$ 与过程输入 $\\Delta u$ 联系起来。\n\n任务是找到能够实现理想稳态解耦的预补偿器矩阵 $D$。在此背景下，理想解耦意味着从新指令信号 $\\Delta v$ 到过程输出 $\\Delta y$ 的总体传递关系由 $2 \\times 2$ 的单位矩阵 $I$ 表示。\n\n确定静态预补偿器矩阵 $D$ 的元素。将答案表示为一个 $2 \\times 2$ 矩阵，每个元素需四舍五入至三位有效数字。", "solution": "稳态关系为 $\\Delta y = K_{p}\\Delta u$ 和 $\\Delta u = D\\Delta v$。因此，从 $\\Delta v$ 到 $\\Delta y$ 的总体映射为\n$$\n\\Delta y = K_{p}D\\Delta v.\n$$\n理想稳态解耦要求 $K_{p}D = I$，这意味着\n$$\nD = K_{p}^{-1}.\n$$\n对于一个 $2\\times 2$ 矩阵 $A = \\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$，其逆矩阵为\n$$\nA^{-1} = \\frac{1}{ad - bc}\\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}.\n$$\n对于 $K_{p} = \\begin{pmatrix} 2.5 & -0.5 \\\\ 1.5 & 4.0 \\end{pmatrix}$，我们有 $a = 2.5$，$b = -0.5$，$c = 1.5$，$d = 4.0$。行列式为\n$$\n\\det(K_{p}) = ad - bc = 2.5\\cdot 4.0 - (-0.5)\\cdot 1.5 = 10 + 0.75 = 10.75.\n$$\n因此\n$$\nK_{p}^{-1} = \\frac{1}{10.75}\\begin{pmatrix} 4.0 & 0.5 \\\\ -1.5 & 2.5 \\end{pmatrix}.\n$$\n计算每个元素并四舍五入至三位有效数字，得到\n$$\nD \\approx \\begin{pmatrix}\n0.372 & 0.0465 \\\\\n-0.140 & 0.233\n\\end{pmatrix}.\n$$\n在四舍五入前，该矩阵 $D$ 精确满足 $K_{p}D = I$，并实现了理想稳态解耦。", "answer": "$$\\boxed{\\begin{pmatrix}0.372 & 0.0465 \\\\ -0.140 & 0.233\\end{pmatrix}}$$", "id": "1581230"}, {"introduction": "虽然理想解耦是一个有用的概念，但在实际应用中，我们更常需要分析和管理现有的交互，而不是完全消除它。相对增益数组（Relative Gain Array, RGA）是用于量化交互和指导输入-输出配对决策的关键工具。本练习将通过计算一个系统在稳态（$s=0$）和特定频率下的 RGA，揭示一个核心原则：交互作用是频率相关的，因此最佳的控制配对策略也可能随频率而变化 [@problem_id:1581221]。", "problem": "一个两输入两输出 (2x2) 的多变量控制系统，其动态特性由拉普拉斯域关系式 $Y(s) = G(s)U(s)$ 描述，其中 $U(s)$ 是输入向量，$Y(s)$ 是输出向量。该系统的传递函数矩阵 $G(s)$ 如下所示：\n$$G(s) = \\begin{pmatrix} 1 & s+1 \\\\ s+1 & 2s^2+s+2 \\end{pmatrix}$$\n为了分析输入与输出之间的相互作用，一位控制工程师决定使用相对增益阵列 (Relative Gain Array, RGA)。对于一个通用的非奇异方阵 $G(s)$，RGA 定义为 $\\Lambda(s) = G(s) \\circ (G(s)^{-1})^T$，其中 $\\circ$ 表示哈达玛（逐元素）乘积。\n\n在分散控制方案中，用于将输入与输出配对的 RGA 解释依赖于其元素的值。对于一个 2x2 系统，控制器的性能由 RGA 的 (1,1) 元素 $\\lambda_{11}$ 决定。\n- 如果 $\\lambda_{11}$ 为正且接近 1，则推荐配对 ($u_1 \\to y_1$, $u_2 \\to y_2$)。\n- 如果 $\\lambda_{11}$ 接近 0，这意味着 $\\lambda_{12} = 1-\\lambda_{11}$ 接近 1，则推荐配对 ($u_1 \\to y_2$, $u_2 \\to y_1$)。\n- $\\lambda_{11}$ 的负值强烈不推荐 ($u_1 \\to y_1$, $u_2 \\to y_2$) 配对，因为当回路闭合时，这种配置可能导致不稳定。在此类情况下，应考虑备选的非对角线配对。\n\n您的任务是分析该系统的首选配对如何随频率变化。计算 RGA 元素 $\\lambda_{11}(s)$ 在两种不同条件下的值：稳态 ($s=0$) 和角频率为 $\\omega_c = 1$ rad/s (即 $s=j\\omega_c=j$) 时。\n\n根据您的计算，以下哪个陈述正确描述了配对建议？\n\nA. 在稳态和 $\\omega_c = 1$ rad/s 时，推荐的配对均为 ($u_1 \\to y_1$, $u_2 \\to y_2$)。\n\nB. 在稳态和 $\\omega_c = 1$ rad/s 时，推荐的配对均为 ($u_1 \\to y_2$, $u_2 \\to y_1$)。\n\nC. 配对建议从稳态时的 ($u_1 \\to y_1$, $u_2 \\to y_2$) 切换到 $\\omega_c = 1$ rad/s 时的 ($u_1 \\to y_2$, $u_2 \\to y_1$)。\n\nD. 配对建议从稳态时的 ($u_1 \\to y_2$, $u_2 \\to y_1$) 切换到 $\\omega_c = 1$ rad/s 时的 ($u_1 \\to y_1$, $u_2 \\to y_2$)。\n\nE. 系统在 $s=j$ 时是奇异的，因此该频率下的 RGA 未定义。", "solution": "相对增益阵列定义为 $\\Lambda(s) = G(s) \\circ (G(s)^{-1})^{T}$，因此对于一个 $2 \\times 2$ 系统，\n$$\n\\lambda_{11}(s) = g_{11}(s)\\,(G(s)^{-1})_{11}.\n$$\n对于一个 $2 \\times 2$ 矩阵 $G(s) = \\begin{pmatrix} g_{11} & g_{12} \\\\ g_{21} & g_{22} \\end{pmatrix}$，\n$$\nG(s)^{-1} = \\frac{1}{\\det G(s)} \\begin{pmatrix} g_{22} & -g_{12} \\\\ -g_{21} & g_{11} \\end{pmatrix},\n\\quad\n\\det G(s) = g_{11}g_{22} - g_{12}g_{21}.\n$$\n因此，\n$$\n\\lambda_{11}(s) = g_{11} \\cdot \\frac{g_{22}}{\\det G(s)}.\n$$\n对于给定的 $G(s) = \\begin{pmatrix} 1 & s+1 \\\\ s+1 & 2s^{2}+s+2 \\end{pmatrix}$，我们有 $g_{11}=1$, $g_{12}=s+1$, $g_{21}=s+1$, $g_{22}=2s^{2}+s+2$，并且\n$$\n\\det G(s) = 1\\cdot(2s^{2}+s+2) - (s+1)(s+1) = 2s^{2}+s+2 - (s^{2}+2s+1) = s^{2} - s + 1.\n$$\n所以，\n$$\n\\lambda_{11}(s) = \\frac{2s^{2}+s+2}{s^{2}-s+1}.\n$$\n\n在稳态 $s=0$ 时：\n$$\n\\lambda_{11}(0) = \\frac{2\\cdot 0^{2} + 0 + 2}{0^{2} - 0 + 1} = \\frac{2}{1} = 2.\n$$\n该值为正，其互补元素为 $\\lambda_{12}(0) = 1 - \\lambda_{11}(0) = -1$，为负值；因此强烈不推荐非对角线配对，推荐的配对是对角线配对 ($u_{1} \\to y_{1}$, $u_{2} \\to y_{2}$)。\n\n在 $\\omega_{c}=1$ rad/s 时，取 $s=j$ 且 $j^{2}=-1$：\n$$\n\\lambda_{11}(j) = \\frac{2j^{2} + j + 2}{j^{2} - j + 1} = \\frac{-2 + j + 2}{-1 - j + 1} = \\frac{j}{-j} = -1.\n$$\n该值为负，强烈不推荐对角线配对；因此在 $\\omega_{c}=1$ 时推荐非对角线配对 ($u_{1} \\to y_{2}$, $u_{2} \\to y_{1}$)。此外，$\\det G(j) = j^{2} - j + 1 = -j \\neq 0$，所以系统在 $s=j$ 时不是奇异的，RGA 在此点有明确定义。\n\n因此，配对建议从稳态时的对角线配对切换到 $\\omega_{c}=1$ rad/s 时的非对角线配对，这与选项 C 相符。", "answer": "$$\\boxed{C}$$", "id": "1581221"}, {"introduction": "我们已经看到交互是频率相关的，但这引出了一个更深层的问题：一个在稳态下看起来完全无交互的系统，在动态操作中是否仍然可靠？本练习通过一个在稳态下表现完美的假设系统来探讨这一挑战 [@problem_id:1581188]。你的任务是找出动态交互达到峰值的频率，这个过程将深刻地揭示为什么仅靠稳态分析是不足的，以及全面评估系统动态行为的重要性。", "problem": "一个双输入双输出(2x2)过程由以下传递函数矩阵 $G(s)$ 描述：\n$$\nG(s) = \\begin{pmatrix} 1 & \\frac{s}{s+1} \\\\ \\frac{-4s}{s+1} & 1 \\end{pmatrix}\n$$\n该系统表现出静态解耦特性，这可以通过观察其稳态增益矩阵 $G(0)$ 是单位矩阵来验证。分析多变量系统中相互作用的一个常用工具是相对增益矩阵(RGA)，它是一个由无量纲度量组成的数组，记为 $\\Lambda(G(s))$。对于一个2x2系统，RGA由其第一个元素 $\\lambda_{11}(s)$ 定义如下：\n$$\n\\Lambda(G(s)) = \\begin{pmatrix} \\lambda_{11}(s) & 1-\\lambda_{11}(s) \\\\ 1-\\lambda_{11}(s) & \\lambda_{11}(s) \\end{pmatrix}\n$$\n其中 $\\lambda_{11}(s) = \\frac{g_{11}(s)g_{22}(s)}{\\det(G(s))}$。\n\n尽管系统在稳态时是解耦的（$\\lambda_{11}(0) = 1$），但在非零频率下可能会表现出显著的相互作用。这种动态相互作用可以通过频率相关的RGA元素幅值 $|\\lambda_{11}(j\\omega)|$ 来量化。\n\n确定使动态相互作用度量 $|\\lambda_{11}(j\\omega)|$ 最大化的角频率 $\\omega > 0$。将最终答案以 rad/s 为单位表示，并四舍五入到三位有效数字。", "solution": "设给定的传递矩阵为\n$$\nG(s) = \\begin{pmatrix} g_{11}(s) & g_{12}(s) \\\\ g_{21}(s) & g_{22}(s) \\end{pmatrix} = \\begin{pmatrix} 1 & \\frac{s}{s+1} \\\\ \\frac{-4s}{s+1} & 1 \\end{pmatrix}.\n$$\n对于2x2情况，RGA元素为\n$$\n\\lambda_{11}(s) = \\frac{g_{11}(s)g_{22}(s)}{\\det(G(s))}.\n$$\n这里 $g_{11}(s)=1$ 且 $g_{22}(s)=1$，所以\n$$\n\\lambda_{11}(s) = \\frac{1}{\\det(G(s))}.\n$$\n计算行列式：\n$$\n\\det(G(s)) = g_{11}(s)g_{22}(s) - g_{12}(s)g_{21}(s) = 1 - \\frac{s}{s+1}\\cdot\\frac{-4s}{s+1} = 1 + \\frac{4s^{2}}{(s+1)^{2}}.\n$$\n将其重写为单个有理函数：\n$$\n\\det(G(s)) = \\frac{(s+1)^{2} + 4s^{2}}{(s+1)^{2}} = \\frac{5s^{2} + 2s + 1}{(s+1)^{2}}.\n$$\n因此\n$$\n\\lambda_{11}(s) = \\frac{(s+1)^{2}}{5s^{2} + 2s + 1}.\n$$\n在虚轴 $s = j\\omega$ 上求值并取其幅值的平方：\n$$\n|\\lambda_{11}(j\\omega)|^{2} = \\frac{|1 + j\\omega|^{4}}{|5(j\\omega)^{2} + 2(j\\omega) + 1|^{2}} = \\frac{(1 + \\omega^{2})^{2}}{(1 - 5\\omega^{2})^{2} + (2\\omega)^{2}} = \\frac{(1 + \\omega^{2})^{2}}{25\\omega^{4} - 6\\omega^{2} + 1}.\n$$\n定义 $x = \\omega^{2}$ 且 $x \\geq 0$。则\n$$\n|\\lambda_{11}(j\\omega)|^{2} = f(x) = \\frac{(x + 1)^{2}}{25x^{2} - 6x + 1}.\n$$\n为求 $x > 0$ 时 $f(x)$ 的最大值，令其导数为零：\n$$\nf'(x) = \\frac{2(x+1)(25x^{2} - 6x + 1) - (x+1)^{2}(50x - 6)}{(25x^{2} - 6x + 1)^{2}} = 0.\n$$\n通过提取公因式 $(x+1)$ 来简化分子：\n$$\n(x+1)\\left[2(25x^{2} - 6x + 1) - (x+1)(50x - 6)\\right] = 0.\n$$\n由于 $x+1 \\neq 0$，求解\n$$\n2(25x^{2} - 6x + 1) - (x+1)(50x - 6) = 0.\n$$\n计算每一项：\n$$\n2(25x^{2} - 6x + 1) = 50x^{2} - 12x + 2,\n$$\n$$\n(x+1)(50x - 6) = 50x^{2} + 44x - 6.\n$$\n因此\n$$\n50x^{2} - 12x + 2 - (50x^{2} + 44x - 6) = 8 - 56x = 0 \\quad \\Rightarrow \\quad x = \\frac{1}{7}.\n$$\n这给出了临界频率\n$$\n\\omega^{2} = \\frac{1}{7} \\quad \\Rightarrow \\quad \\omega = \\frac{1}{\\sqrt{7}}.\n$$\n为了验证这是一个最大值，评估其极限行为：当 $\\omega \\to 0$ 时， $|\\lambda_{11}(j\\omega)|^{2} \\to 1$；当 $\\omega \\to \\infty$ 时， $|\\lambda_{11}(j\\omega)|^{2} \\to \\frac{1}{25}$。在 $x = \\frac{1}{7}$ 处，\n$$\n|\\lambda_{11}(j\\omega)|^{2} = \\frac{(1 + \\frac{1}{7})^{2}}{25\\left(\\frac{1}{7}\\right)^{2} - 6\\left(\\frac{1}{7}\\right) + 1} = \\frac{\\left(\\frac{8}{7}\\right)^{2}}{\\frac{25}{49} - \\frac{6}{7} + 1} = \\frac{\\frac{64}{49}}{\\frac{32}{49}} = 2,\n$$\n该值超过了端点值，证实了这是一个全局最大值。因此，使 $|\\lambda_{11}(j\\omega)|$ 最大化的角频率为 $\\omega = \\frac{1}{\\sqrt{7}}$，其数值在四舍五入到三位有效数字后约等于 $0.378$。", "answer": "$$\\boxed{0.378}$$", "id": "1581188"}]}