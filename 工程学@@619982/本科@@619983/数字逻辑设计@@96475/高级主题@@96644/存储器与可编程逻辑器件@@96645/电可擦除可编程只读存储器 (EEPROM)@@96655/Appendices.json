{"hands_on_practices": [{"introduction": "在数字系统设计中，理解存储器的组织方式是第一步。存储器芯片的容量通常用 $N \\times M$ 的形式表示，例如 $4\\text{K} \\times 8$，这不仅描述了其存储能力，也直接决定了与处理器交互所需的硬件接口。这个练习将帮助你掌握如何从存储器的规格中计算出所需的地址线数量，这是为任何微处理器系统选择和集成存储器时的一项基本技能 [@problem_id:1932063]。", "problem": "一位数字系统工程师的任务是将一个非易失性存储模块集成到一个新的嵌入式系统中。所选的组件是一个电可擦除可编程只读存储器（EEPROM）芯片，其存储组织结构规格为 4K x 8。此标记法表示存储阵列由 4K 个独立的存储位置（称为“字”）组成，每个字能够存储 8 位数据。在数字存储系统中，为了寻址，前缀 ‘K’ 代表乘数 $1024$。为了让处理器能够读取或写入一个特定的字，它必须向 EEPROM 的地址输入引脚提供一个唯一的二进制地址。请确定地址总线必须具备的最少地址线数量，以便能够唯一指定该 EEPROM 芯片内的每一个不同的字位置。", "solution": "该存储器的组织结构为 $4\\text{K} \\times 8$，这意味着有 $N$ 个不同的字位置，其中\n$$\nN = 4 \\times \\text{K} = 4 \\times 1024.\n$$\n使用定义 $\\text{K} = 1024 = 2^{10}$，可得\n$$\nN = 4 \\times 2^{10} = 2^{2} \\times 2^{10} = 2^{12}.\n$$\n在二进制寻址的存储器中，$n$ 条地址线可以唯一选择 $2^{n}$ 个位置。所需的最小 $n$ 满足\n$$\n2^{n} \\geq N \\quad \\Longrightarrow \\quad n \\geq \\log_{2}(N).\n$$\n因此，所需的最少地址线数量是\n$$\nn_{\\min} = \\lceil \\log_{2}(N) \\rceil = \\lceil \\log_{2}(2^{12}) \\rceil = 12.\n$$\n$4\\text{K} \\times 8$ 中的 $8$ 指的是每个字的数据宽度，不影响地址线的数量。", "answer": "$$\\boxed{12}$$", "id": "1932063"}, {"introduction": "知道了如何对存储器进行寻址后，下一步是学习如何执行基本操作，比如写入数据。与存储器的通信并非瞬时完成，而是依赖于一系列精确计时的控制信号。本练习通过一个简化的时序图，引导你识别并行EEPROM写操作的关键阶段，重点关注片选 ($\\overline{CE}$) 和写使能 ($\\overline{WE}$) 信号的作用 [@problem_id:1932062]。掌握时序图的分析能力是调试硬件接口、确保系统稳定运行的核心技能。", "problem": "一位工程师正在分析一个并行电可擦除可编程只读存储器 (EEPROM) 芯片的字节写入周期。在几个离散的时间点，记录了控制信号以及数据/地址总线的状态。相关信号包括片选 ($\\overline{CE}$)、写使能 ($\\overline{WE}$)、地址总线和数据总线。对于低电平有效的信号 $\\overline{CE}$ 或 $\\overline{WE}$，“低”电平状态表示信号被断言（有效）。当总线驱动一个特定值时，其状态被称为“有效”；当不驱动时，则为“高阻态”(High-Z)。\n\n假设所提供的时序满足了地址和数据总线的所有建立和保持时间要求，对存储器阵列的写入操作会根据控制信号的状态被锁存。事件序列如下，时间 $t$ 以纳秒 (ns) 为单位：\n\n-   在 $t = 0$ ns 时，$\\overline{CE}$ 为高电平，$\\overline{WE}$ 为高电平，地址总线为高阻态，数据总线为高阻态。\n-   在 $t = 15$ ns 时，地址总线变为有效。\n-   在 $t = 25$ ns 时，$\\overline{CE}$ 转换为低电平。\n-   在 $t = 35$ ns 时，数据总线变为有效。\n-   在 $t = 50$ ns 时，$\\overline{WE}$ 转换为低电平。\n-   在 $t = 110$ ns 时，$\\overline{WE}$ 转换为高电平。\n-   在 $t = 120$ ns 时，$\\overline{CE}$ 转换为高电平。\n-   在 $t = 130$ ns 时，地址总线转换为高阻态。\n-   在 $t = 140$ ns 时，数据总线转换为高阻态。\n\n有效的写入操作定义为芯片被选中且写入命令被同时断言的时期。确定此有效写入周期的开始时间和结束时间。您的答案应包含两个整数值，分别代表开始时间和结束时间。答案以纳秒 (ns) 表示。", "solution": "一个有效的写入周期要求芯片被选中并且写入命令被同时断言。对于低电平有效的控制信号，断言对应于低电平。\n\n根据时间线：\n- $\\overline{CE}$ 在 $t=25$ 时转换为低电平，并在 $t=120$ 时恢复为高电平，因此芯片在 $t \\in [25,120)$ 期间被选中。\n- $\\overline{WE}$ 在 $t=50$ 时转换为低电平，并在 $t=110$ 时恢复为高电平，因此写入命令在 $t \\in [50,110)$ 期间被断言。\n\n有效的写入周期是这些区间的交集：\n$$[25,120) \\cap [50,110) = [50,110)。$$\n\n因此，有效的写入操作在 $t=50$ 时开始，在 $t=110$ 时结束。", "answer": "$$\\boxed{\\begin{pmatrix}50 & 110\\end{pmatrix}}$$", "id": "1932062"}, {"introduction": "我们已经了解了正确的写入周期是如何工作的，但如果时序不满足芯片数据手册中的规定，会发生什么呢？本练习模拟了一个由于不满足地址建立时间 ($t_{AS}$) 而导致的错误写操作场景，这是一个在实际工程中可能遇到的问题 [@problem_id:1932077]。通过分析这个有缺陷的时序，你将预测数据最终被写入的位置，从而深刻理解遵循数据手册时序参数对于保证数据完整性的重要性。", "problem": "一个微控制器与一个并行的电可擦除可编程只读存储器（EEPROM）芯片相连接。该存储器具有16位地址总线和8位数据总线。对EEPROM的写周期由几个信号控制，包括低电平有效的写使能信号（$\\overline{WE}$）。EEPROM的制造商数据手册规定了写周期的以下最小定时要求：\n\n-   地址建立时间（$t_{AS}$）：在$\\overline{WE}$从高电平转换到低电平之前，总线上的地址必须稳定至少20纳秒。\n-   地址保持时间（$t_{AH}$）：在$\\overline{WE}$从低电平转换到高电平之后，总线上的地址必须保持稳定至少5纳秒。\n-   数据建立时间（$t_{DS}$）：在$\\overline{WE}$从低电平转换到高电平之前，总线上的数据必须稳定至少15纳秒。\n-   写脉冲宽度（$t_{WP}$）：$\\overline{WE}$信号必须保持低电平至少40纳秒。\n\n假设所有其他定时要求（例如，$t_{AH}$，$t_{DS}$，$t_{WP}$）都由微控制器满足。\n\n微控制器尝试执行一次写操作。最初，地址总线上的值为`0xABCC`。在时间$t=0$时，微控制器将总线上的地址更改为`0xABCD`，并将数据值`0x55`放到数据总线上。在时间$t=12$纳秒时，微控制器将$\\overline{WE}$信号拉低以启动写入。50纳秒后（在$t=62$纳秒时），它将$\\overline{WE}$拉回高电平，结束写脉冲。\n\n在此操作之前，存储在地址`0xABCC`的数据为`0xFF`，存储在地址`0xABCD`的数据也为`0xFF`。\n\n在这个有故障的单个写周期完成后，分别存储在内存地址`0xABCC`和`0xABCD`的最终数据值是什么？请选择表示（`0xABCC`处的数据，`0xABCD`处的数据）这对值的选项。\n\nA. (`0x55`, `0x55`)\n\nB. (`0xFF`, `0x55`)\n\nC. (`0x55`, `0xFF`)\n\nD. (`0xFF`, `0xFF`)\n\nE. 两个位置的内容都已损坏且不确定。", "solution": "数据手册中的写周期时序约束要求，在$\\overline{WE}$的下降沿之前，地址必须有效并稳定至少$t_{AS}$，并且数据和地址在$\\overline{WE}$的上升沿前后满足其建立/保持时间。具体来说：\n- 地址建立：在$\\overline{WE}$从高电平转换到低电平之前，地址必须稳定至少$t_{AS}=20\\ \\text{ns}$。\n- 地址保持：在$\\overline{WE}$从低电平转换到高电平之后，地址必须保持稳定至少$t_{AH}=5\\ \\text{ns}$。\n- 数据建立：在$\\overline{WE}$从低电平转换到高电平之前，数据必须稳定至少$t_{DS}=15\\ \\text{ns}$。\n- 写脉冲宽度：$\\overline{WE}$低电平时间$t_{WP}\\geq 40\\ \\text{ns}$。\n\n尝试写入的时间线：\n- 最初，地址总线为0xABCC。\n- 在$t=0$时，微控制器将地址更改为0xABCD，并将数据0x55放到数据总线上。\n- 在$t=12\\ \\text{ns}$时，$\\overline{WE}$变为低电平。\n- 在$t=62\\ \\text{ns}$时，$\\overline{WE}$变为高电平（脉冲宽度$50\\ \\text{ns}$）。\n\n检查各项时序：\n1) 相对于$\\overline{WE}$低电平的地址建立时间：\n- 要求：在$t=12\\ \\text{ns}$的下降沿之前稳定$20\\ \\text{ns}$；即，在区间$[t-20\\ \\text{ns}, t]=[-8\\ \\text{ns},12\\ \\text{ns}]$内有效且不变。\n- 实际情况：地址在$t=0$时从0xABCC更改为0xABCD。因此，新地址0xABCD仅在$t=0$到$t=12\\ \\text{ns}$之间稳定，即$12\\ \\text{ns}<20\\ \\text{ns}$。因此，对于目标地址0xABCD，违反了$t_{AS}$。\n2) 相对于$\\overline{WE}$高电平的数据建立时间：\n- 要求：在$t=62\\ \\text{ns}$之前数据稳定$15\\ \\text{ns}$；即，在$[47\\ \\text{ns},62\\ \\text{ns}]$期间有效。\n- 实际情况：数据0x55在$t=0$时被放置并保持不变；因此满足要求。\n3) $\\overline{WE}$高电平后的地址保持时间：\n- 要求：在$t=62\\ \\text{ns}$后地址稳定$5\\ \\text{ns}$。\n- 根据问题陈述，假设满足要求。\n4) 写脉冲宽度：\n- 实际低电平时间为$50\\ \\text{ns}\\geq 40\\ \\text{ns}$，因此满足要求。\n\n$t_{AS}$违规的后果：\n- $t_{AS}$的目的是确保在$\\overline{WE}$变为低电平之前，内部地址译码器已经稳定到正确的字线，从而在写脉冲开始时选中正确的存储单元。由于地址在下降沿前仅$12\\ \\text{ns}$发生了变化，当$\\overline{WE}$变为低电平时，译码器可能尚未完全切换到0xABCD。在实际应用中，出现这种违规时，设备在启动写入时可能会选择先前寻址的位置（0xABCC）。\n- 所有其他时序（相对于上升沿的数据建立时间、上升沿后的地址保持时间以及脉冲宽度）均得到满足，因此写操作一旦启动，便会可靠地进行并完成。\n\n因此，字节0x55被写入到旧地址0xABCC，而目标地址0xABCD保持其先前的值0xFF不变。\n\n因此，在这次错误的写入之后，存储的数据是（0xABCC处为0x55，0xABCD处为0xFF），这对应于选项C。", "answer": "$$\\boxed{C}$$", "id": "1932077"}]}