{"hands_on_practices": [{"introduction": "三态缓冲器最核心的应用之一是构建共享数据总线，允许多个设备分时使用同一线路。本练习将引导你分析一个由三态缓冲器构成的基本电路——一个2对1数据选择器。通过推导其完整的真值表 [@problem_id:1973343]，你将亲身体验如何利用使能信号来精确控制数据流，这是数字系统设计中的一项基本技能。", "problem": "考虑一个用于在两个数据源之间进行选择的数字电路。该电路有三个二进制输入，分别指定为 $A$、$B$ 和 $S$，以及一个二进制输出 $Y$。该电路由两个三态缓冲器（我们称之为 $T_A$ 和 $T_B$）和一个非门构成。\n\n三态缓冲器的行为如下：它有一个数据输入 $D$ 和一个低电平有效的使能输入 $\\overline{E}$。如果使能输入 $\\overline{E}$ 为逻辑‘0’，则缓冲器被激活，其输出与其数据输入 $D$ 相同。如果使能输入 $\\overline{E}$ 为逻辑‘1’，则缓冲器处于高阻态（表示为‘Z’），这会有效地将其输出与所连接的任何电路断开。\n\n这些组件按以下配置接线：\n- 缓冲器 $T_A$ 的数据输入连接到电路输入 $A$。\n- 缓冲器 $T_B$ 的数据输入连接到电路输入 $B$。\n- 缓冲器 $T_A$ 的低电平有效使能输入直接连接到电路选择器输入 $S$。\n- 电路选择器输入 $S$ 也连接到非门的输入。该非门的输出再连接到缓冲器 $T_B$ 的低电平有效使能输入。\n- 缓冲器 $T_A$ 和缓冲器 $T_B$ 的输出被连接在一起，形成单个电路输出 $Y$。\n\n当一个缓冲器的输出是逻辑电平（0 或 1）而另一个处于高阻态‘Z’时，共享输出线 $Y$ 将呈现激活缓冲器的逻辑电平。电路的设计保证了输入绝不会导致两个缓冲器同时被激活。\n\n根据此配置，以下哪个表格正确表示了该电路的完整真值表，将输入（$S, A, B$）映射到输出（$Y$）？\n\nA.\n| S | A | B | Y |\n|:-:|:-:|:-:|:-:|\n| 0 | 0 | 0 | 0 |\n| 0 | 0 | 1 | 0 |\n| 0 | 1 | 0 | 1 |\n| 0 | 1 | 1 | 1 |\n| 1 | 0 | 0 | 0 |\n| 1 | 0 | 1 | 1 |\n| 1 | 1 | 0 | 0 |\n| 1 | 1 | 1 | 1 |\n\nB.\n| S | A | B | Y |\n|:-:|:-:|:-:|:-:|\n| 0 | 0 | 0 | 0 |\n| 0 | 0 | 1 | 1 |\n| 0 | 1 | 0 | 0 |\n| 0 | 1 | 1 | 1 |\n| 1 | 0 | 0 | 0 |\n| 1 | 0 | 1 | 0 |\n| 1 | 1 | 0 | 1 |\n| 1 | 1 | 1 | 1 |\n\nC.\n| S | A | B | Y |\n|:-:|:-:|:-:|:-:|\n| 0 | 0 | 0 | 0 |\n| 0 | 0 | 1 | 0 |\n| 0 | 1 | 0 | 1 |\n| 0 | 1 | 1 | 1 |\n| 1 | 0 | 0 | 0 |\n| 1 | 0 | 1 | 0 |\n| 1 | 1 | 0 | 1 |\n| 1 | 1 | 1 | 1 |\n\nD.\n| S | A | B | Y |\n|:-:|:-:|:-:|:-:|\n| 0 | 0 | 0 | 0 |\n| 0 | 0 | 1 | 1 |\n| 0 | 1 | 0 | 1 |\n| 0 | 1 | 1 | 1 |\n| 1 | 0 | 0 | 1 |\n| 1 | 0 | 1 | 1 |\n| 1 | 1 | 0 | 1 |\n| 1 | 1 | 1 | 1 |\n\nE.\n| S | A | B | Y |\n|:-:|:-:|:-:|:-:|\n| 0 | 0 | 0 | 0 |\n| 0 | 0 | 1 | 0 |\n| 0 | 1 | 0 | 0 |\n| 0 | 1 | 1 | 1 |\n| 1 | 0 | 0 | 0 |\n| 1 | 0 | 1 | 1 |\n| 1 | 1 | 0 | 1 |\n| 1 | 1 | 1 | 1 |", "solution": "一个具有数据输入 $D$ 和低电平有效使能 $\\overline{E}$ 的三态缓冲器其行为如下：\n- 如果 $\\overline{E}=0$，缓冲器被激活并输出 $D$。\n- 如果 $\\overline{E}=1$，缓冲器输出高阻态 $Z$。\n\n对于缓冲器 $T_{A}$，其使能为 $\\overline{E_{A}}=S$，因此当 $S=0$ 时，$T_{A}$ 被激活并输出 $A$，否则输出 $Z$。\n\n对于缓冲器 $T_{B}$，其使能由 $S$ 的非（NOT）驱动，所以 $\\overline{E_{B}}=\\overline{S}$。因此，当 $\\overline{S}=0$ 时，即当 $S=1$ 时，$T_{B}$ 被激活并输出 $B$，否则输出 $Z$。\n\n由于每次只有一个缓冲器被激活，连接后的输出 $Y$ 等于被激活缓冲器的数据。因此，\n$$\nY=\\overline{S}\\,A+S\\,B\n$$\n这意味着：\n- 当 $S=0$ 时：$Y=A$。列举 $A,B$ 的情况：\n  - $S=0,A=0,B=0 \\Rightarrow Y=0$\n  - $S=0,A=0,B=1 \\Rightarrow Y=0$\n  - $S=0,A=1,B=0 \\Rightarrow Y=1$\n  - $S=0,A=1,B=1 \\Rightarrow Y=1$\n- 当 $S=1$ 时：$Y=B$。列举 $A,B$ 的情况：\n  - $S=1,A=0,B=0 \\Rightarrow Y=0$\n  - $S=1,A=0,B=1 \\Rightarrow Y=1$\n  - $S=1,A=1,B=0 \\Rightarrow Y=0$\n  - $S=1,A=1,B=1 \\Rightarrow Y=1$\n\n这些行与选项 A 完全匹配。", "answer": "$$\\boxed{A}$$", "id": "1973343"}, {"introduction": "在学会了如何正确使用三态缓冲器之后，理解错误使用时会发生什么同样至关重要。本练习模拟了一个真实的硬件调试场景：在一个本应空闲的总线上，工程师却测量到了约 $V_{CC}/2$ 的异常电压。通过分析这个案例 [@problem_id:1973096]，你将把“总线冲突”这一抽象的逻辑概念与其在物理世界中的具体表现联系起来，这是硬件工程师必备的诊断技能。", "problem": "一位系统设计者正在调试一个定制构建的嵌入式系统。该系统包含一个中央处理器（CPU）和几个通过共享数据总线进行通信的外围设备。每个设备都通过其自己的一组三态缓冲器连接到总线。三态缓冲器是一种数字逻辑门，具有一个数据输入、一个数据输出和一个使能输入。当被使能时，缓冲器将其数据输入的逻辑电平传递到其数据输出。当被禁用时，数据输出进入高阻抗（Hi-Z）状态，从而在电气上将其与总线断开。该系统的逻辑由一个表示为 $V_{CC}$ 的供电电压供电，并以地（GND, 0 V）为参考。在正常操作中，一个控制单元确保在任何给定时间只有一个设备的缓冲器被使能，以向总线写入数据。\n\n在一次诊断测试中，系统理应处于空闲状态，所有设备的缓冲器均被禁用。然而，设计者使用高阻抗数字万用表测量其中一条总线线路上的电压，观察到一个稳定在约 $V_{CC}/2$ 的读数。这是一个无效的逻辑电平，表明存在故障。\n\n以下哪种情况是导致总线线路上出现此特定电压读数的最可能和最直接的电气原因？\n\nA. 连接到该总线线路的至少两个三态缓冲器同时被使能，其中一个试图将线路驱动为逻辑高电平，而另一个试图将其驱动为逻辑低电平。\nB. 连接到该线路的恰好一个缓冲器被使能，但其内部逻辑发生故障，导致其输出一个中间电压。\nC. 连接到该线路的所有缓冲器均按预期正确禁用，并处于高阻抗状态。\nD. 该总线线路出现了电阻性故障，形成了一个到 $V_{CC}$ 电源轨的中等电阻短路。\nE. 连接到该线路的单个缓冲器永久卡在使能状态，而所有其他缓冲器均被正确禁用。", "solution": "我们使用简单的电路原理对测量结果及每种情景进行建模。\n\n高阻抗数字万用表近似于一个开路，因此它测量的是总线线路的开路节点电压。因此，读数反映了连接到总线的内部等效网络，而不是由仪表负载引起的假象。\n\n一个稳定在 $V_{CC}/2$ 附近的中间轨电压值意味着，从该节点到电源轨同时存在两条有限且大致相当的导电通路，形成了一个有效的电阻分压器。在三态总线上，发生这种情况的典型方式是总线竞争：一个使能的缓冲器驱动高电平，而另一个使能的缓冲器驱动低电平。\n\n将两个竞争的输出建模为 Thevenin 电源：\n- 驱动高电平的缓冲器作为电压源 $V_{CC}$，其输出电阻为 $R_{H}$（上拉导通电阻）。\n- 驱动低电平的缓冲器作为电压源 $0$，其输出电阻为 $R_{L}$（下拉导通电阻）。\n\n当两者都被使能时，根据 KCL（基尔霍夫电流定律），总线节点电压 $V$ 满足：\n$$(V - V_{CC})\\frac{1}{R_{H}} + \\frac{V}{R_{L}} = 0$$\n求解 $V$ 可得\n$$V = V_{CC}\\frac{R_{L}}{R_{H}+R_{L}}$$\n当 $R_{H} \\approx R_{L}$ 时（对于对称的 CMOS 驱动器而言是典型情况），可得出\n$$V \\approx \\frac{V_{CC}}{2}$$，\n这与观察到的稳定的中间轨读数相符。此外，由于两个驱动器都是低阻抗的，该值是稳定的（尽管这意味着存在显著的直通电流）。\n\n现在评估其他选项：\n- 只有一个被使能的缓冲器因内部故障产生中间直流电平（选项 B）对于 CMOS 数字输出而言是非典型的，除非有外部负载，否则 CMOS 数字输出通常会饱和到接近电源轨的电平；这种故障的可能性较小，也不是产生稳定 $V_{CC}/2$ 电压的直接、标准机制。\n- 所有缓冲器都被禁用（选项 C）会使总线浮空。一个浮空节点用高阻抗仪表测量时，不会有一个明确定义的、稳定的中间轨电平；任何读数都是偶然的，并且通常不稳定。\n- 仅到 $V_{CC}$ 的电阻性故障（选项 D）会将节点电压拉向 $V_{CC}$；要得到 $V_{CC}/2$，还需要一条到 GND 的相当的电阻路径，而这一点并未说明。\n- 单个缓冲器卡在使能状态（选项 E）会将其输出稳定地驱动到高电平或低电平，而不是中间轨电平，除非存在竞争路径。\n\n因此，导致稳定读数接近 $V_{CC}/2$ 的最可能和最直接的电气原因是两个缓冲器同时被使能，一个驱动高电平，一个驱动低电平。\n\n因此，正确选项是 A。", "answer": "$$\\boxed{A}$$", "id": "1973096"}, {"introduction": "现在，让我们从理想的数字逻辑模型进入更真实的工程世界。当所有驱动器都处于高阻态时，共享总线会因微小的泄漏电流而“浮动”到不确定状态，这是一个常见的设计难题。本练习要求你设计一个“总线保持器”电路来解决此问题，并计算关键的设计参数 [@problem_id:1973087]。这个实践将让你深入思考泄漏电流 $I_{leak}$ 和噪声容限等非理想效应，从而学习如何构建在真实条件下依然稳健可靠的数字系统。", "problem": "在共享数据总线上实现了一个总线维持器电路（bus-keeper circuit），用于在所有驱动器处于高阻态时维持有效的逻辑电平，从而防止总线“浮空”。该维持器由一个弱同相缓冲器和一个连接成反馈回路的反相器构成。缓冲器的输出连接到总线上，并同时输入到反相器的输入端。反相器的输出则连接到缓冲器的输入端，形成一个简单的锁存器，主动保持总线上最后一次被驱动的稳定逻辑状态。\n\n该维持器缓冲器的“弱”特性表现为其相对较高的输出电阻，记作 $R_{weak}$。该总线由 $N$ 个相同的互补金属氧化物半导体（CMOS）器件共享。当一个器件的输出处于三态（置于高阻态）时，它仍可能会拉入或灌出一个虽小但非零的漏电流 $I_{leak}$。\n\n为使总线维持器正常工作，它必须足够强，以抵消所有 $N$ 个器件同时产生的累积最差情况下的漏电流，从而确保总线电压保持在有效的逻辑电平阈值范围内。系统工作电源电压为 $V_{DD}$。任何读取总线数据的器件的逻辑阈值定义为 $V_{IL}$（保证被识别为逻辑“0”的最高电压）和 $V_{IH}$（保证被识别为逻辑“1”的最低电压）。\n\n给定以下参数：\n- 电源电压, $V_{DD} = 5.0$ V\n- 总线上的器件数量, $N = 32$\n- 维持器的输出电阻, $R_{weak} = 10.0$ k$\\Omega$\n- 输入低电平阈值, $V_{IL} = 0.35 V_{DD}$\n- 输入高电平阈值, $V_{IH} = 0.65 V_{DD}$\n\n计算单个器件所允许的最大漏电流 $I_{leak}$。以微安（$\\mu$A）为单位表示答案，并四舍五入到三位有效数字。", "solution": "题目要求计算在总线维持器必须维持有效逻辑电平的情况下，总线上单个器件所允许的最大漏电流 $I_{leak}$。总线维持器的性能受其在高阻态下抵消所有 $N$ 个器件总漏电流的能力的限制。我们必须分析两种最差情况：维持逻辑高电平和维持逻辑低电平。\n\n首先，我们计算电压阈值的具体数值：\n$V_{IL} = 0.35 V_{DD} = 0.35 \\times 5.0 \\text{ V} = 1.75$ V\n$V_{IH} = 0.65 V_{DD} = 0.65 \\times 5.0 \\text{ V} = 3.25$ V\n\n**情况1：维持逻辑高电平**\n\n在这种情况下，总线维持器将总线保持在逻辑高电平。其弱缓冲器试图通过其输出电阻 $R_{weak}$ 将总线驱动至 $V_{DD}$。最差情况发生在所有 $N$ 个三态器件都在吸收漏电流（灌电流），实际上是试图将总线电压拉低至地。从总线吸取的总漏电流为 $I_{total\\_leak} = N \\times I_{leak}$。\n\n这个总漏电流流经维持器的电阻 $R_{weak}$，导致从 $V_{DD}$ 开始产生一个电压降。根据欧姆定律，总线上的最终电压 $V_{bus}$ 可以建模为：\n$V_{bus} = V_{DD} - I_{total\\_leak} \\times R_{weak}$\n\n为使总线被正确地解释为逻辑高电平，其电压不得低于最低高电平阈值 $V_{IH}$。\n$V_{bus} \\ge V_{IH}$\n$V_{DD} - (N \\times I_{leak}) \\times R_{weak} \\ge V_{IH}$\n\n我们可以重新整理这个不等式，以求解允许的最大 $I_{leak}$：\n$(N \\times I_{leak}) \\times R_{weak} \\le V_{DD} - V_{IH}$\n$I_{leak} \\le \\frac{V_{DD} - V_{IH}}{N \\times R_{weak}}$\n\n代入给定值：\n$I_{leak} \\le \\frac{5.0 \\text{ V} - 3.25 \\text{ V}}{32 \\times (10.0 \\times 10^3 \\, \\Omega)} = \\frac{1.75 \\text{ V}}{32 \\times 10^4 \\, \\Omega} = 5.46875 \\times 10^{-6}$ A\n\n**情况2：维持逻辑低电平**\n\n在这种情况下，总线维持器将总线保持在逻辑低电平。其弱缓冲器试图通过其输出电阻 $R_{weak}$ 将总线连接到地（0V）。最差情况发生在所有 $N$ 个三态器件都在输出漏电流（拉电流），实际上是试图将总线电压上拉至 $V_{DD}$。注入到总线的总漏电流同样是 $I_{total\\_leak} = N \\times I_{leak}$。\n\n这个电流流经维持器的电阻 $R_{weak}$ 到地，导致总线电压上升到0V以上。总线电压由下式给出：\n$V_{bus} = I_{total\\_leak} \\times R_{weak}$\n\n为使总线被正确地解释为逻辑低电平，其电压不得高于最高低电平阈值 $V_{IL}$。\n$V_{bus} \\le V_{IL}$\n$(N \\times I_{leak}) \\times R_{weak} \\le V_{IL}$\n\n重新整理以求解 $I_{leak}$：\n$I_{leak} \\le \\frac{V_{IL}}{N \\times R_{weak}}$\n\n代入给定值：\n$I_{leak} \\le \\frac{1.75 \\text{ V}}{32 \\times (10.0 \\times 10^3 \\, \\Omega)} = \\frac{1.75 \\text{ V}}{32 \\times 10^4 \\, \\Omega} = 5.46875 \\times 10^{-6}$ A\n\n**结论**\n\n两种情况都给出了漏电流 $I_{leak}$ 的上限。为了同时满足这两个条件，我们必须选择两个上限中更严格的（即更小的）一个。在这个具体问题中，由于 $V_{DD} - V_{IH} = 1.75$ V 且 $V_{IL} = 1.75$ V，两种情况得出了相同的结果。\n\n允许的最大漏电流为：\n$I_{leak, max} = 5.46875 \\times 10^{-6}$ A\n\n题目要求以微安（$\\mu$A）为单位给出答案。\n$1 \\, \\mu\\text{A} = 10^{-6}$ A\n$I_{leak, max} = 5.46875 \\, \\mu$A\n\n最后，我们需要将答案四舍五入到三位有效数字。\n$I_{leak, max} \\approx 5.47 \\, \\mu$A", "answer": "$$\\boxed{5.47}$$", "id": "1973087"}]}