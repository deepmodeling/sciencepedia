{"hands_on_practices": [{"introduction": "在连接不同逻辑家族的数字芯片时，首要的挑战是确保它们的电压电平相互兼容。噪声容限（Noise Margin）是衡量这种兼容性的关键指标，它量化了数字接口在不发生逻辑错误的情况下可以承受的噪声电压。这个练习将指导你计算一个经典的 TTL 驱动 CMOS 的接口的噪声容限，通过这个计算，你将亲身体会为什么这种直接连接在某些情况下是不可靠的 [@problem_id:1943189]。", "problem": "在数字系统设计中，连接来自不同逻辑系列的组件时，需要仔细考虑它们的电压特性，以确保可靠运行。一位设计者正试图将一个标准晶体管-晶体管逻辑（TTL）门的输出连接到一个高速CMOS（HCMOS）门的输入。两个系列都使用+5 V的共同电源供电。\n\n根据制造商的数据手册，相关的电压参数如下：\n\n对于标准TTL输出门：\n- 最小高电平输出电压 ($V_{OH,min}$): 2.4 V\n- 最大低电平输出电压 ($V_{OL,max}$): 0.4 V\n\n对于HCMOS输入门：\n- 最小高电平输入电压 ($V_{IH,min}$): 3.5 V\n- 最大低电平输入电压 ($V_{IL,max}$): 1.0 V\n\n计算此TTL到HCMOS接口的高电平噪声容限 $N_{MH}$。请用伏特（Volts）表示你的答案。", "solution": "驱动逻辑系列与接收逻辑系列之间的高电平噪声容限，在最坏情况下，定义为驱动器保证的最小高电平输出电压与接收器要求的最小高电平输入电压之间的差值。因此，\n$$\nN_{MH} = V_{OH,\\min}(\\text{driver}) - V_{IH,\\min}(\\text{receiver}).\n$$\n在此，驱动器是标准TTL门，接收器是HCMOS门。代入给定值，$N_{MH} = 2.4 - 3.5 = -1.1$。\n负值表明TTL的高电平不满足HCMOS的高电平输入要求，这意味着该接口在高电平上没有有效的噪声容限。", "answer": "$$\\boxed{-1.1}$$", "id": "1943189"}, {"introduction": "除了电压兼容性，电流驱动能力是另一个必须考虑的关键因素。一个逻辑门的输出端能够驱动的输入端数量是有限的，这个极限被称为“扇出”（Fan-out）。本练习将带你计算从 CMOS 输出到 TTL 输入的扇出能力，你将学会如何同时考虑高电平下的拉电流（sourcing current）和低电平下的灌电流（sinking current），并找出决定接口可靠性的瓶颈 [@problem_id:1943182]。", "problem": "一名工科学生接到一项任务，需要设计一个数字接口，用于连接一个使用高速互补金属氧化物半导体（HC-CMOS）逻辑的现代微控制器，和一个使用老式晶体管-晶体管逻辑（TTL）架构的旧实验室设备。为确保可靠运行，该学生必须计算单个HC-CMOS输出引脚能够驱动的老式TTL输入的最大数量，这个概念被称为扇出（fan-out）。\n\n制造商的数据手册提供了以下电流规格。\n\n对于单个 HC-CMOS 输出引脚：\n- 处于高逻辑电平状态时，其可源出的最大电流：$I_{OH_{max}} = 4.0 \\, \\text{mA}$\n- 处于低逻辑电平状态时，其可灌入的最大电流：$I_{OL_{max}} = 6.0 \\, \\text{mA}$\n\n对于单个老式 TTL 输入引脚：\n- 输入处于高逻辑电平状态时，从驱动器汲取的电流：$I_{IH} = 50 \\, \\mu\\text{A}$\n- 输入处于低逻辑电平状态时，向驱动器提供的电流：$I_{IL} = 1.8 \\, \\text{mA}$\n\n假设两种逻辑系列的高、低逻辑电平状态的电压是兼容的。单个HC-CMOS输出引脚能够安全可靠地驱动的老式TTL输入的最大整数数量是多少？", "solution": "为确保可靠运行，必须同时满足高电平状态下的源出电流要求和低电平状态下的灌入电流要求。设 $N$ 为一个 HC-CMOS 输出所驱动的 TTL 输入的数量。扇出由两个约束中更严格的一个决定：\n- 高电平（源出）约束：HC-CMOS 输出必须能够源出所有 TTL 输入高电平电流的总和，因此\n$$\nN \\leq \\frac{I_{OH_{\\max}}}{I_{IH}}.\n$$\n- 低电平（灌入）约束：HC-CMOS 输出必须能够灌入所有 TTL 输入低电平电流的总和，因此\n$$\nN \\leq \\frac{I_{OL_{\\max}}}{I_{IL}}.\n$$\n因此，允许的最大整数扇出为\n$$\nN_{\\max}=\\left\\lfloor \\min\\!\\left(\\frac{I_{OH_{\\max}}}{I_{IH}},\\,\\frac{I_{OL_{\\max}}}{I_{IL}}\\right) \\right\\rfloor.\n$$\n代入给定的最坏情况下的电流值：\n$$\n\\frac{I_{OH_{\\max}}}{I_{IH}}=\\frac{4.0\\times 10^{-3}}{50\\times 10^{-6}}=80,\n$$\n$$\n\\frac{I_{OL_{\\max}}}{I_{IL}}=\\frac{6.0\\times 10^{-3}}{1.8\\times 10^{-3}}=\\frac{10}{3}\\approx 3.33\\ldots.\n$$\n取较小值，然后向下取整，得到\n$$\nN_{\\max}=\\left\\lfloor \\min\\!\\left(80,\\,\\frac{10}{3}\\right) \\right\\rfloor=\\left\\lfloor \\frac{10}{3} \\right\\rfloor=3.\n$$\n因此，低电平状态的灌入电流要求是限制因素，该HC-CMOS输出最多可以安全可靠地驱动三个老式TTL输入。", "answer": "$$\\boxed{3}$$", "id": "1943182"}, {"introduction": "现代电子系统常常需要连接工作在不同电源电压下的设备，例如将一个 $3.3 \\text{V}$ 的微控制器与一个 $5 \\text{V}$ 的外设相连。在这种情况下，直接连接通常是行不通的，需要专门的电平转换电路。这项实践将让你分析一个广泛应用的解决方案——基于 MOSFET 的双向电平转换器，通过评估不同电阻值的选择是否满足多重约束条件，你将在一个真实的设计场景中综合运用关于电压、电流和元器件特性的知识 [@problem_id:1943207]。", "problem": "您的任务是设计一个简单的双向逻辑电平转换器，用于连接一个现代3.3V互补金属氧化物半导体（CMOS）微控制器的一个I/O引脚与一个旧式5V晶体管-晶体管逻辑（TTL）器件的一个I/O引脚。所提出的电路由一个N沟道增强型金属氧化物半导体场效应晶体管（MOSFET）和两个上拉电阻 $R_1$ 和 $R_2$ 组成。电阻 $R_1$ 将3.3V I/O线连接到3.3V电源（$V_{DD1}$），电阻 $R_2$ 将5V I/O线连接到5V电源（$V_{DD2}$）。MOSFET的源极连接到3.3V I/O线，其漏极连接到5V I/O线，其栅极直接连接到3.3V电源。\n\n该电路必须在以下直流规格下正常工作：\n\n**器件规格：**\n*   **3.3V CMOS微控制器：**\n    *   电源电压, $V_{DD1} = 3.3 \\text{ V}$\n    *   最小输入高电压, $V_{IH,CMOS} = 2.0 \\text{ V}$\n*   **5V TTL器件：**\n    *   电源电压, $V_{DD2} = 5.0 \\text{ V}$\n    *   最大输入低电压, $V_{IL,TTL} = 0.8 \\text{ V}$\n    *   最小输入高电压, $V_{IH,TTL} = 2.0 \\text{ V}$\n    *   最大输出低电压, $V_{OL,TTL} = 0.5 \\text{ V}$，在吸入最大电流 $I_{OL,TTL} = 8.0 \\text{ mA}$ 时。\n*   **N沟道MOSFET：**\n    *   阈值电压, $V_{GS(th)} = 1.5 \\text{ V}$\n    *   导通态漏源电阻, $R_{DS(on)} = 10 \\, \\Omega$ (在 $V_{GS} = 3.3 \\text{ V}$ 时)。\n*   **系统漏电流：**\n    *   假设每条I/O线处于高阻输入状态时，最坏情况下的总输入漏电流为 $I_{leak} = 50 \\, \\mu\\text{A}$。\n\n为了使该接口可靠工作，您必须为上拉电阻 $R_1$ 和 $R_2$ 选择合适的值。下列哪对 $(R_1, R_2)$ 是满足所有给定约束的有效设计选择？\n\nA. $(R_1, R_2) = (4.7 \\, \\text{k}\\Omega, 10 \\, \\text{k}\\Omega)$\n\nB. $(R_1, R_2) = (220 \\, \\Omega, 10 \\, \\text{k}\\Omega)$\n\nC. $(R_1, R_2) = (4.7 \\, \\text{k}\\Omega, 47 \\, \\Omega)$\n\nD. $(R_1, R_2) = (33 \\, \\text{k}\\Omega, 10 \\, \\text{k}\\Omega)$\n\nE. $(R_1, R_2) = (4.7 \\, \\text{k}\\Omega, 82 \\, \\text{k}\\Omega)$", "solution": "我们分析栅极接至较低电源的标准双向NMOS电平转换器。为保证直流正确性，我们强制执行以下条件：\n- 针对每个上拉输入的漏电流，确保高电平裕度。\n- 当3.3V侧驱动低电平时，考虑到MOSFET的 $R_{DS(on)}$，确保5V TTL输入为低电平。\n- 当5V TTL输出驱动低电平时，其最大吸入电流限制，需同时考虑两个上拉电阻和MOSFET的 $R_{DS(on)}$。\n\n所有计算均使用欧姆定律和给定的直流规格。\n\n1) 考虑漏电流的高电平约束\n当一条线作为输入（高阻态）时，最坏情况下的漏电流 $I_{leak}$ 到地会在上拉电阻上产生压降。为满足输入高电平要求，需强制执行\n$$\nV_{DD} - I_{leak} R \\geq V_{IH} \\quad \\Longrightarrow \\quad R \\leq \\frac{V_{DD} - V_{IH}}{I_{leak}}.\n$$\n- 在3.3V CMOS侧：\n$$\nR_{1} \\leq \\frac{3.3 - 2.0}{50 \\times 10^{-6}} = 2.6 \\times 10^{4} \\, \\Omega = 26 \\, \\text{k}\\Omega.\n$$\n- 在5V TTL侧：\n$$\nR_{2} \\leq \\frac{5.0 - 2.0}{50 \\times 10^{-6}} = 6.0 \\times 10^{4} \\, \\Omega = 60 \\, \\text{k}\\Omega.\n$$\n因此，任何 $R_{1} > 26 \\text{ k}\\Omega$ 或 $R_{2} > 60 \\text{ k}\\Omega$ 的选项都是不行的。这排除了选项D（因为 $R_{1}=33 \\, \\text{k}\\Omega$）和选项E（因为 $R_{2}=82 \\, \\text{k}\\Omega$）。\n\n2) 当3.3V侧驱动低电平时TTL的输入低电平\n假设3.3V输出被强下拉至地，MOSFET导通，其 $R_{DS(on)} = 10 \\, \\Omega$。5V侧节点（TTL输入）的电压 $V_{L2}$ 由流过 $R_{2}$ 的电流和MOSFET的导通电阻决定：\n$$\nI = \\frac{5 - V_{L2}}{R_{2}}, \\quad V_{L2} = I \\, R_{DS(on)}.\n$$\n消去 $I$ 得到\n$$\nV_{L2} = \\frac{5 \\, R_{DS(on)}}{R_{2} + R_{DS(on)}}.\n$$\n要求 $V_{L2} \\leq V_{IL,TTL} = 0.8$：\n$$\n\\frac{5 \\, R_{DS(on)}}{R_{2} + R_{DS(on)}} \\leq 0.8\n\\;\\Longrightarrow\\;\nR_{2} \\geq \\frac{5 \\, R_{DS(on)}}{0.8} - R_{DS(on)} = 5.25 \\, R_{DS(on)}.\n$$\n在 $R_{DS(on)} = 10 \\, \\Omega$ 的情况下，这得出 $R_{2} \\geq 52.5 \\, \\Omega$。因此 $R_{2} = 47 \\, \\Omega$（选项C）违反了 $V_{IL,TTL}$ 的要求；所有其他候选选项都满足此条件。\n\n3) 当TTL输出驱动低电平时，吸入两个上拉电阻电流的能力\n当5V TTL输出驱动低电平时，如果我们依赖其 $V_{OL,TTL} \\leq 0.5 \\text{ V}$ 的保证，则其吸入的电流不能超过 $I_{OL,TTL} = 8 \\text{ mA}$。在最坏情况下 $V_{d} = V_{OL,TTL} = 0.5$, 电流为：\n- 来自5V上拉电阻的电流：\n$$\nI_{2} = \\frac{5.0 - 0.5}{R_{2}} = \\frac{4.5}{R_{2}}.\n$$\n- 来自3.3V上拉电阻并流经MOSFET的电流：\n设 $I_{1}$ 是来自 $R_{1}$ 的电流。3.3V侧节点的电压为 $V_{s} = V_{d} + I_{1} R_{DS(on)}$，并且\n$$\nI_{1} = \\frac{3.3 - V_{s}}{R_{1}} = \\frac{3.3 - \\left(V_{d} + I_{1} R_{DS(on)}\\right)}{R_{1}}\n\\;\\Longrightarrow\\;\nI_{1} = \\frac{3.3 - V_{d}}{R_{1} + R_{DS(on)}} = \\frac{2.8}{R_{1} + 10}.\n$$\n总吸入电流为\n$$\nI_{tot} = I_{1} + I_{2} = \\frac{2.8}{R_{1} + 10} + \\frac{4.5}{R_{2}}.\n$$\n施加约束 $I_{tot} \\leq 8 \\times 10^{-3}$。\n\n评估候选选项：\n- A: $R_{1} = 4.7 \\, \\text{k}\\Omega$, $R_{2} = 10 \\, \\text{k}\\Omega$:\n$$\nI_{1} = \\frac{2.8}{4700 + 10} \\approx 5.94 \\times 10^{-4}, \\quad\nI_{2} = \\frac{4.5}{10000} = 4.5 \\times 10^{-4},\n$$\n$$\nI_{tot} \\approx 1.04 \\times 10^{-3} \\leq 8 \\times 10^{-3} \\quad \\text{（通过）}.\n$$\n- B: $R_{1} = 220 \\, \\Omega$, $R_{2} = 10 \\, \\text{k}\\Omega$:\n$$\nI_{1} = \\frac{2.8}{220 + 10} = \\frac{2.8}{230} \\approx 1.217 \\times 10^{-2} > 8 \\times 10^{-3} \\quad \\text{（不通过）}.\n$$\n- C: $R_{2} = 47 \\, \\Omega$ 已在步骤2中不满足低电平条件，并且 $I_{2} = \\frac{4.5}{47} \\approx 9.57 \\times 10^{-2} \\quad (\\text{远高于 } 8 \\times 10^{-3}).$\n- D: $R_{1}$ 违反了步骤1中的漏电流约束（尽管 $I_{tot}$ 会很小）。\n- E: $R_{2}$ 违反了步骤1中的漏电流约束（尽管 $I_{tot}$ 会很小）。\n\n综合所有约束，只有选项A满足：\n- $R_{1} \\leq 26 \\, \\text{k}\\Omega$ 且 $R_{2} \\leq 60 \\, \\text{k}\\Omega$（漏电流高电平）。\n- $R_{2} \\geq 52.5 \\, \\Omega$（当3.3V侧驱动低电平时TTL输入低电平）。\n- $\\frac{2.8}{R_{1} + 10} + \\frac{4.5}{R_{2}} \\leq 8 \\times 10^{-3}$（TTL输出低电平吸入电流限制）。\n\n因此，有效的设计选择是选项A。", "answer": "$$\\boxed{A}$$", "id": "1943207"}]}