{"hands_on_practices": [{"introduction": "在数字电路设计中，一个逻辑门的输出能够驱动多少个其他门的输入，是一个基本而关键的物理限制，这就是所谓的扇出（fan-out）。这个练习将带你动手计算当一个标准TTL逻辑门驱动多个低功耗肖特基TTL（LS-TTL）逻辑门输入时，其最大的扇出数。通过这个实践[@problem_id:1934517]，你将掌握基于直流电流规格（例如 $I_{OH}$ 和 $I_{IL}$）来确定电路可靠性的核心方法，并理解为何必须同时考虑高电平和低电平两种情况以确保电路正常工作。", "problem": "一位工程师正在设计一个数字电路接口，其中一个控制单元的单路输出必须驱动多个相同外围设备的输入。该控制单元的输出驱动器是一个标准的晶体管-晶体管逻辑（TTL）门。外围设备的输入则采用低功耗肖特基TTL（LS-TTL）门实现。为确保可靠运行，驱动门必须能够在高电平和低电平两种逻辑状态下，为所有连接的外围设备输入提供或吸收所需的电流。\n\n这些逻辑系列的电流规格如下：\n\n对于驱动门（标准TTL）：\n- 最大输出高电平电流，$I_{OH} = -400 \\text{ µA}$\n- 最大输出低电平电流，$I_{OL} = 16 \\text{ mA}$\n\n对于每个被驱动门（LS-TTL）：\n- 最大输入高电平电流，$I_{IH} = 20 \\text{ µA}$\n- 最大输入低电平电流，$I_{IL} = -360 \\text{ µA}$\n\n按照惯例，流出节点的电流为负，流入节点的电流为正。\n\n请确定单个控制单元输出能同时可靠驱动的外围设备输入的最大数量。您的答案必须是整数。", "solution": "该问题要求计算一个标准晶体管-晶体管逻辑（TTL）门在驱动多个低功耗肖特基TTL（LS-TTL）门输入时的扇出数（fan-out）。扇出数是指单个输出能够可靠驱动的输入的最大数量。这受限于驱动门的拉电流（current sourcing）和灌电流（current sinking）能力。我们必须分别计算高电平逻辑状态和低电平逻辑状态下的扇出数，然后取两者中的较小值，因为连接必须在所有条件下都可靠。\n\n**步骤1：计算高电平扇出数（$N_H$）**\n\n当驱动门的输出处于高电平逻辑时，它会向被驱动门的输入端提供源电流（拉电流）。驱动器提供的总拉电流 $|I_{OH}|$ 必须大于或等于所有被驱动输入所需电流的总和 $N_H \\times |I_{IH}|$。\n\n因此，高电平扇出数 $N_H$ 由驱动器的最大输出拉电流与负载所需输入电流的比值给出。由于门的数量必须是整数，我们对该比值向下取整。\n\n$$N_H = \\left\\lfloor \\frac{|I_{OH}|}{|I_{IH}|} \\right\\rfloor$$\n\n使用给定的值：\n$|I_{OH}| = |-400 \\text{ µA}| = 400 \\text{ µA}$\n$|I_{IH}| = |20 \\text{ µA}| = 20 \\text{ µA}$\n\n$$N_H = \\left\\lfloor \\frac{400 \\text{ µA}}{20 \\text{ µA}} \\right\\rfloor = \\lfloor 20 \\rfloor = 20$$\n\n因此，在高电平状态下，驱动门最多可以支持20个LS-TTL输入。\n\n**步骤2：计算低电平扇出数（$N_L$）**\n\n当驱动门的输出处于低电平逻辑时，它会吸收来自被驱动门输入的电流（灌电流）。驱动器能吸收的总灌电流 $|I_{OL}|$ 必须大于或等于所有被驱动输入流出的电流总和 $N_L \\times |I_{IL}|$。\n\n低电平扇出数 $N_L$ 由驱动器的最大输出灌电流与负载的输入电流的比值给出。同样，我们对该比值向下取整。\n\n$$N_L = \\left\\lfloor \\frac{|I_{OL}|}{|I_{IL}|} \\right\\rfloor$$\n\n使用给定的值，我们必须首先确保单位一致。我们将毫安（mA）转换为微安（µA），其中 $1 \\text{ mA} = 1000 \\text{ µA}$。\n$|I_{OL}| = |16 \\text{ mA}| = 16 \\text{ mA} = 16000 \\text{ µA}$\n$|I_{IL}| = |-360 \\text{ µA}| = 360 \\text{ µA}$\n\n$$N_L = \\left\\lfloor \\frac{16000 \\text{ µA}}{360 \\text{ µA}} \\right\\rfloor = \\left\\lfloor \\frac{1600}{36} \\right\\rfloor = \\left\\lfloor \\frac{400}{9} \\right\\rfloor = \\lfloor 44.44... \\rfloor = 44$$\n\n因此，在低电平状态下，驱动门最多可以支持44个LS-TTL输入。\n\n**步骤3：确定总扇出数**\n\n电路必须在高电平和低电平状态下都能可靠工作。因此，可驱动的门的最大数量受限于最坏情况。这个值是高电平扇出数和低电平扇出数中的最小值。\n\n$$N = \\min(N_H, N_L)$$\n\n代入计算出的值：\n\n$$N = \\min(20, 44) = 20$$\n\n因此，该标准TTL门最多可以可靠地驱动20个LS-TTL输入。尽管在低电平状态下它可以吸收44个输入的电流，但在高电平状态下它只能为20个输入提供足够的电流，因此高电平条件是限制因素。", "answer": "$$\\boxed{20}$$", "id": "1934517"}, {"introduction": "理论知识必须应用于实际设计才能发挥价值。本练习模拟了一个常见的设计场景：如何利用一个多输入逻辑门来实现一个较少输入的逻辑功能，并探讨如何处理未使用的输入引脚。通过分析这个关于CMOS与非门的案例[@problem_id:1934508]，你将学会处理悬空输入的正确工程实践，并理解这些实践选择如何反过来影响驱动该逻辑门的前级电路的扇出要求，从而将扇入（fan-in）与扇出（fan-out）的概念联系起来。", "problem": "一位数字电路设计师的任务是为一个新的控制系统实现一个双输入与非门（NAND）功能，其定义为 $F(A, B) = \\overline{A \\cdot B}$。在检查其元件库存时，他发现只有基于互补金属氧化物半导体（CMOS）技术的、包含三个三输入与非门的集成电路。其中一个门的输入是 $X_1, X_2, X_3$，其输出是 $Y$。设计师决定将输入 $A$ 和 $B$ 分别用于 $X_1$ 和 $X_2$，而将 $X_3$ 作为一个未使用的输入。\n\n请考虑以下关于处理未使用输入 $X_3$ 以实现所需的双输入与非门功能的策略的陈述。这些陈述中，哪些既在逻辑上正确，又代表了标准的、可靠的设计实践？\n\nA. 将输入 $X_3$ 连接到逻辑高电平电源电压（Vcc）可以正确实现所需功能。在此配置下，该门的有效扇入为 2。\n\nB. 将输入 $X_3$ 连接到地（GND）可以正确实现所需功能。在此配置下，该门的有效扇入为 2。\n\nC. 将输入 $X_3$ 连接到另一个已使用的输入，例如直接连接到 $X_1$，可以正确实现所需功能。这是首选方法，因为它最小化了驱动信号A上的电容负载。\n\nD. 将输入 $X_3$ 悬空（不连接）是实现该功能的一种有效且简单的方法，因为悬空的CMOS输入通常表现为逻辑高电平。在这种情况下，有效扇入为 2。\n\nE. 将输入 $X_3$ 连接到另一个已使用的输入，例如直接连接到 $X_1$，可以正确实现所需功能。这种配置增加了驱动输入A的逻辑级的扇出要求。", "solution": "设三输入CMOS与非门实现的功能为\n$$Y=\\overline{X_{1}X_{2}X_{3}}.$$\n指定 $X_{1}=A$ 和 $X_{2}=B$；目标函数是\n$$F(A,B)=\\overline{A\\cdot B}.$$\n为使用三输入与非门实现 $F$，我们要求 $X_{3}$ 对于所有的 $A,B$ 都满足\n$$\\overline{A\\,B\\,X_{3}}=\\overline{A\\,B}.$$\n使用恒等式 $A\\cdot 1=A$ 和 $A\\cdot 0=0$，\n- 如果 $X_{3}=1$，那么 $\\overline{A\\,B\\,1}=\\overline{A\\,B}$，这是正确的。\n- 如果 $X_{3}=0$，那么 $\\overline{A\\,B\\,0}=\\overline{0}=1$，这是不正确的。\n\n评估每个陈述：\n\nA. 当 $X_{3}=\\text{Vcc}$ 时， $Y=\\overline{A\\,B\\,1}=\\overline{A\\,B}$，所以逻辑功能是正确的。将未使用的与非门输入端接高电平是标准的CMOS实践。虽然物理门仍然包含三个串联的器件（因此延迟类似于一个三输入与非门），但独立输入变量的数量是两个；在这种情况下，将逻辑上的有效扇入描述为 $2$ 是可以接受的。这是一种标准的、可靠的方法。\n\nB. 当 $X_{3}=\\text{GND}$ 时， $Y=\\overline{A\\,B\\,0}=\\overline{0}=1$，这没有实现 $\\overline{A\\,B}$。不正确。\n\nC. 如果将 $X_{3}$ 连接到 $X_{1}$，那么 $Y=\\overline{A\\,B\\,A}=\\overline{A\\,B}$ （因为 $A\\cdot A=A$），所以逻辑是正确的。然而，这并不会最小化A上的电容负载；它通过向A的驱动器呈现两个门输入而增加了负载。因此，由于负载原因，这不是首选方法；该陈述的理由是不正确的。\n\nD. 将 $X_{3}$ 悬空不是一种可靠的做法。CMOS输入端绝不能悬空不接，因为悬空的门可能呈现不可预测的电压、拾取噪声并导致过大的静态电流。“悬空的CMOS输入通常表现为逻辑高电平”的说法没有保证，并且不是一种标准的、可靠的方法。\n\nE. 将 $X_{3}$ 连接到另一个已使用的输入（如 $X_{1}$）会得到 $Y=\\overline{A\\,B\\,A}=\\overline{A\\,B}$，这在逻辑上是正确的。由于增加了输入电容，这种配置确实增加了驱动A的逻辑级的扇出要求。这是一种公认的、可靠的做法，前提是驱动级能够支持增加的负载。\n\n因此，既在逻辑上正确又代表标准、可靠设计实践的陈述是A和E。", "answer": "$$\\boxed{AE}$$", "id": "1934508"}, {"introduction": "扇出不仅决定了电路的逻辑正确性，更是影响其性能（速度）的关键参数。本练习将你的视角从静态的直流分析提升到动态的性能优化层面，探讨了如何通过优化每级反相器的扇出 $h$ 来最小化驱动大电容负载时的总传播延迟[@problem_id:1934484]。解决这个问题将帮助你理解扇出在高速电路设计中的重要作用，并初步接触到逻辑努力（logical effort）等高级性能优化思想。", "problem": "在高速数字系统的设计中，反相器链常被用作缓冲器，以驱动大的电容性负载，例如长互连线或片外元件的输入。其目标是确定链中反相器的尺寸，以最小化总传播延迟。\n\n考虑一个由$N$个互补金属氧化物半导体（CMOS）反相器构成的缓冲器链。这些反相器的尺寸被缩放，使得每一级（一个反相器及其驱动的负载）具有相同的扇出，记为 $h$。该链的总延迟与 $N(h + p_{inv})$ 成正比，其中 $p_{inv}$ 是一个反相器的归一化寄生延迟，这是制造工艺的一个特性。为了在给定的总扇出下最小化总延迟，每级的最优扇出 $h_{opt}$ 必须满足以下超越方程：\n$$h(\\ln(h) - 1) = p_{inv}$$\n对于一个特定的45纳米CMOS工艺，一个标准反相器的有效寄生延迟特征为 $p_{inv} = 1.25$。\n\n计算该工艺下每级的最优扇出 $h_{opt}$ 的数值。报告你的答案，并四舍五入到三位有效数字。", "solution": "我们需要求解满足 $h(\\ln(h)-1)=p_{inv}$ 且 $p_{inv}=1.25$ 的 $h$。\n\n首先，使用朗伯W函数进行符号求解。令 $x=\\ln(h)$，则 $h=\\exp(x)$。代入方程得到\n$$\\exp(x)\\,(x-1)=p_{inv}.$$\n令 $y=x-1$，则 $x=y+1$，且\n$$y\\,\\exp(y+1)=p_{inv}\\quad\\Longrightarrow\\quad y\\,\\exp(y)\\,\\exp(1)=p_{inv}\\quad\\Longrightarrow\\quad y\\,\\exp(y)=\\frac{p_{inv}}{\\exp(1)}.$$\n根据朗伯W函数的定义，若 $y\\,\\exp(y)=z$，则 $y=W(z)$。因此\n$$y=W\\!\\left(\\frac{p_{inv}}{\\exp(1)}\\right),\\quad x=1+W\\!\\left(\\frac{p_{inv}}{\\exp(1)}\\right),\\quad h=\\exp\\!\\left(1+W\\!\\left(\\frac{p_{inv}}{\\exp(1)}\\right)\\right).$$\n使用 $\\exp(W(z))=\\frac{z}{W(z)}$，我们得到显式解\n$$h=\\frac{p_{inv}}{W\\!\\left(\\frac{p_{inv}}{\\exp(1)}\\right)}.$$\n\n对于 $p_{inv}=1.25$（因为自变量为正，所以使用主分支 $W_{0}$），\n$$h_{\\text{opt}}=\\frac{1.25}{W\\!\\left(\\frac{1.25}{\\exp(1)}\\right)}.$$\n\n为了进行数值计算，我们用牛顿法求解原方程 $f(h)=h(\\ln h - 1)-1.25=0$。设 $f'(h)=\\ln h$，初始猜测值为 $h_{0}=3.8$：\n- 计算 $\\ln(3.8)=1.335001067$，因此 $f(3.8)=3.8(1.335001067-1)-1.25=0.0230040546$，且 $f'(3.8)=1.335001067$。更新值给出\n$$h_{1}=3.8-\\frac{0.0230040546}{1.335001067}\\approx 3.78277.$$\n- 接下来，$\\ln(3.78277)\\approx 1.330456$，因此 $f(3.78277)\\approx 3.78277(1.330456-1)-1.25\\approx 3.7\\times 10^{-5}$，且 $f'(3.78277)\\approx 1.330456$。更新值给出\n$$h_{2}\\approx 3.78277-\\frac{3.7\\times 10^{-5}}{1.330456}\\approx 3.78274.$$\n\n因此 $h_{\\text{opt}}\\approx 3.78274$，四舍五入到三位有效数字后为 $3.78$。", "answer": "$$\\boxed{3.78}$$", "id": "1934484"}]}