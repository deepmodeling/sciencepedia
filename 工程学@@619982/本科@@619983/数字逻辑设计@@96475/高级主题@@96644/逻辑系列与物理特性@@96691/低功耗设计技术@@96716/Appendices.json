{"hands_on_practices": [{"introduction": "在数字设计中，控制动态功耗至关重要。降低功耗最直接、最有效的方法之一是调节电路的电源电压 $V_{DD}$。本练习将通过一个具体的处理器节能模式场景，带你亲手计算电压变化对动态功耗的显著影响。通过这个计算，你将深刻理解动态功耗与电源电压之间的二次方关系($P_{dyn} \\propto V_{DD}^2$)，并认识到电压调节在低功耗设计中的核心地位[@problem_id:1945207]。", "problem": "一个设计团队正在为一款电池供电设备开发一种新的低功耗处理器。该处理器采用互补金属氧化物半导体（CMOS）技术构建。在此类电路中，功耗的主要组成部分是动态功耗，它在逻辑门切换状态时耗散。动态功耗 $P_{dyn}$ 可以通过关系式 $P_{dyn} = \\alpha C V_{DD}^2 f_{clk}$ 精确建模，其中 $\\alpha$ 是每个时钟周期电容性负载切换的平均次数（开关活动因子），$C$ 是电路的总负载电容，$V_{DD}$ 是电源电压，$f_{clk}$ 是时钟频率。\n\n为了显著延长设备的电池续航时间，该团队实现了一种省电模式。当此模式激活时，处理器的电源电压 $V_{DD}$ 从其标称工作值降低20%。在本分析中，假设开关活动因子（$\\alpha$）、总负载电容（$C$）和时钟频率（$f_{clk}$）在进入此省电模式时保持不变。\n\n计算动态功耗的百分比变化。请用小数表示您的答案。例如，15%的增加应写为0.15，25%的减少应写为-0.25。", "solution": "CMOS中的动态功耗建模为 $P_{dyn}=\\alpha C V_{DD}^{2} f_{clk}$。设标称电源电压为 $V_{0}$，相应的动态功耗为\n$$\nP_{0}=\\alpha C V_{0}^{2} f_{clk}.\n$$\n电源电压降低20%意味着新的电源电压为\n$$\nV_{1}=(1-0.20)V_{0}=0.80\\,V_{0}.\n$$\n在 $\\alpha$、$C$ 和 $f_{clk}$ 保持不变的情况下，新的动态功耗为\n$$\nP_{1}=\\alpha C V_{1}^{2} f_{clk}=\\alpha C (0.80 V_{0})^{2} f_{clk}=0.64\\,\\alpha C V_{0}^{2} f_{clk}=0.64\\,P_{0}.\n$$\n以小数表示的百分比变化即相对变化\n$$\n\\frac{P_{1}-P_{0}}{P_{0}}=0.64-1=-0.36.\n$$\n因此，动态功耗以小数形式减少了0.36。", "answer": "$$\\boxed{-0.36}$$", "id": "1945207"}, {"introduction": "在动态功耗公式 $P_{dyn} = \\alpha C V_{DD}^2 f_{clk}$ 中，开关活动因子 $\\alpha$ 是另一个关键的可优化参数。即使输入信号的统计特性完全相同，选择不同的逻辑门来实现一个功能，其功耗也可能大相径庭。本练习将引导你对比一个与门（AND）和一个异或门（XOR）的输出开关活动，让你从门级设计的微观视角理解逻辑功能的选择如何直接影响电路的功耗[@problem_id:1945215]。", "problem": "在现代超大规模集成 (VLSI) 电路的设计中，最小化功耗是一个关键目标。动态功耗的一个主要组成部分是由逻辑门的开关活动引起的。考虑一位数字设计师正在为一个小型逻辑块评估两种替代实现方案。一种实现方案使用一个双输入与门，而另一种方案使用一个双输入异或门。与门的输出是 $Y = A \\cdot B$，异或门的输出是 $Z = A \\oplus B$。\n\n假设两个输入 $A$ 和 $B$ 是该电路块的主输入。统计分析表明，这些输入彼此完全不相关，并且它们的信号概率是均匀的。这意味着输入为高电平（逻辑‘1’）的概率是 0.5，这对输入 $A$ 和 $B$ 都成立。\n\n输出信号（例如 $F$）的开关活动定义为该信号在时间 $t$ 的值与其在前一时间 $t-1$ 的值不同的概率。假设输入信号 $A$ 和 $B$ 在时间上是不相关的（即，它们在一个时间步长的值与它们在前一个时间步长的值是独立的），则输出 $F$ 的开关活动 $\\alpha_F$ 可以使用其信号概率 $P(F=1)$ 通过公式 $\\alpha_F = 2 \\times P(F=1) \\times (1 - P(F=1))$ 来计算。\n\n为了根据功耗做出明智的设计选择，设计师希望比较这两个门的开关活动。计算比率 $R = \\alpha_{Z} / \\alpha_{Y}$，其中 $\\alpha_{Z}$ 是异或门输出的开关活动，$\\alpha_{Y}$ 是与门输出的开关活动。\n\n将比率 $R$ 的最终答案表示为四舍五入到三位有效数字的小数。", "solution": "设主输入满足 $P(A=1)=P(B=1)=\\frac{1}{2}$，且 $A$ 和 $B$ 相互独立且在时间上不相关。对于双输入与门 $Y=A \\cdot B$，信号概率为\n$$\nP(Y=1)=P(A=1,B=1)=P(A=1)P(B=1)=\\frac{1}{2}\\cdot\\frac{1}{2}=\\frac{1}{4}.\n$$\n对于双输入异或门 $Z=A\\oplus B$，信号概率为\n$$\nP(Z=1)=P(A\\neq B)=P(A=1,B=0)+P(A=0,B=1)=\\frac{1}{2}\\cdot\\frac{1}{2}+\\frac{1}{2}\\cdot\\frac{1}{2}=\\frac{1}{2}.\n$$\n对于时间上不相关的信号，给定开关活动公式 $\\alpha_{F}=2\\,P(F=1)\\left(1-P(F=1)\\right)$，计算可得\n$$\n\\alpha_{Y}=2\\cdot\\frac{1}{4}\\left(1-\\frac{1}{4}\\right)=2\\cdot\\frac{1}{4}\\cdot\\frac{3}{4}=\\frac{3}{8},\n$$\n$$\n\\alpha_{Z}=2\\cdot\\frac{1}{2}\\left(1-\\frac{1}{2}\\right)=2\\cdot\\frac{1}{2}\\cdot\\frac{1}{2}=\\frac{1}{2}.\n$$\n因此，比率为\n$$\nR=\\frac{\\alpha_{Z}}{\\alpha_{Y}}=\\frac{\\frac{1}{2}}{\\frac{3}{8}}=\\frac{4}{3}=1.333\\ldots\n$$\n四舍五入到三位有效数字，得到 $R=1.33$。", "answer": "$$\\boxed{1.33}$$", "id": "1945215"}, {"introduction": "低功耗设计不仅限于单个逻辑门，更体现在系统级的架构决策中。对于数字系统的核心——有限状态机（FSM）——其状态编码方式对功耗有着深远影响。本练习将带你分析一个具体的状态机，定量比较二进制编码和独热码（one-hot）在功耗上的优劣，帮助你理解在寄存器（状态存储）功耗和组合逻辑（下一状态译码）功耗之间的权衡[@problem_id:1945189]。", "problem": "一位数字系统工程师正在设计一个低功耗控制器，需要评估用于一个有限状态机 (FSM) 的两种不同状态编码方案。该 FSM 有 16 个不同的状态，$S_0, S_1, \\ldots, S_{15}$。在每个有效时钟沿，该机器从其当前状态 $S_i$ 顺序转换到下一个状态 $S_{i+1}$，序列从 $S_{15}$ 回绕到 $S_0$。此循环无限重复。\n\n正在考虑的两种编码方案是：\n1.  **二进制编码**：使用所需的最少位数来表示状态。\n2.  **独热编码**：每个状态由一个唯一的位为逻辑‘1’而所有其他位为逻辑‘0’来表示。\n\nFSM 的平均功耗 $P$ 与每个时钟周期耗散的平均能量 $E_{cycle}$ 成正比。该能量包括两个主要部分：组合下一状态逻辑耗散的能量 $E_{logic}$，以及状态寄存器的触发器耗散的能量 $E_{ff}$。\n\n来自触发器的能量 $E_{ff}$ 的计算方法是，将每个时钟周期内状态发生变化（从0到1或从1到0）的触发器平均数量乘以每次转换的恒定能量成本 $E_{tran}$。下一状态逻辑耗散的平均能量 $E_{logic}$ 是一个给定值，反映了每种实现的门级复杂度。\n\n假设有以下能量常数：\n-   每次触发器转换的能量：$E_{tran} = 1.0$ 任意能量单位。\n-   二进制编码的平均逻辑能量：$E_{logic, bin} = 12.0$ 任意能量单位/周期。\n-   独热编码的平均逻辑能量：$E_{logic, oh} = 0.5$ 任意能量单位/周期。\n\n计算独热编码实现的总平均功耗与二进制编码实现的总平均功耗之比，$\\frac{P_{oh}}{P_{bin}}$。将您的答案报告为一个实数，并四舍五入到三位有效数字。", "solution": "设 $P$ 为平均功耗，$E_{cycle}$ 为每个周期的平均能量。由于 $P$ 与 $E_{cycle}$ 成正比，并且两种实现的时钟条件相同，因此存在一个常数 $k$（与编码无关），使得 $P = k E_{cycle}$。因此，\n$$\n\\frac{P_{oh}}{P_{bin}}=\\frac{E_{cycle,oh}}{E_{cycle,bin}}。\n$$\n\n周期能量是逻辑能量和触发器转换能量之和：\n$$\nE_{cycle} = E_{logic} + E_{ff}。\n$$\n\n触发器能量为 $E_{ff} = (\\text{每周期触发器平均翻转次数}) \\cdot E_{tran}$。\n\n二进制编码：\n- 对于 16 个状态，所需的最少位数是 $\\lceil \\log_{2}(16) \\rceil = 4$。\n- 在从 $S_{i}$ 到 $S_{i+1}$ 的 4 位二进制计数中，每次增量操作的预期位翻转数等于每个位翻转概率的总和。位 $k$（最低有效位 LSB 是 $k=0$）在任何增量操作中以 $1/2^k$ 的概率翻转，因此每次转换的平均翻转次数是\n$$\n\\sum_{k=0}^{3}1/2^k = 1 + \\frac{1}{2} + \\frac{1}{4} + \\frac{1}{8} = \\frac{15}{8}。\n$$\n因此，\n$$\nE_{ff,bin} = \\frac{15}{8} E_{tran}。\n$$\n包括逻辑能量，\n$$\nE_{cycle,bin} = E_{logic,bin} + \\frac{15}{8} E_{tran}。\n$$\n\n独热编码：\n- 使用 16 个触发器，每次转换恰好有两个触发器发生变化（当前状态的触发器从 $1$ 变为 $0$，下一个状态的触发器从 $0$ 变为 $1$），所以\n$$\nE_{ff,oh} = 2 E_{tran}。\n$$\n包括逻辑能量，\n$$\nE_{cycle,oh} = E_{logic,oh} + 2 E_{tran}。\n$$\n\n代入给定的数值 $E_{tran} = 1.0$，$E_{logic,bin} = 12.0$ 和 $E_{logic,oh} = 0.5$：\n$$\nE_{cycle,bin} = 12.0 + \\frac{15}{8} \\cdot 1.0 = 12.0 + 1.875 = 13.875 = \\frac{111}{8},\n$$\n$$\nE_{cycle,oh} = 0.5 + 2 \\cdot 1.0 = 2.5 = \\frac{5}{2}。\n$$\n因此，\n$$\n\\frac{P_{oh}}{P_{bin}} = \\frac{E_{cycle,oh}}{E_{cycle,bin}} = \\frac{\\frac{5}{2}}{\\frac{111}{8}} = \\frac{5}{2} \\cdot \\frac{8}{111} = \\frac{20}{111} \\approx 0.180180\\ldots\n$$\n四舍五入到三位有效数字，结果是 $0.180$。", "answer": "$$\\boxed{0.180}$$", "id": "1945189"}]}