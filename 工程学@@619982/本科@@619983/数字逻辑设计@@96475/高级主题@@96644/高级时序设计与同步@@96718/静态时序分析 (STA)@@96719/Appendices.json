{"hands_on_practices": [{"introduction": "这个问题解决了一个数字设计中的核心问题：“我的电路能跑多快？” 我们将练习计算最大工作频率，该频率由电路上最慢路径的建立时间（setup time）约束决定。通过分析时钟到Q端的延迟（$t_{cq}$）、组合逻辑延迟和建立时间（$t_{su}$），并考虑时钟偏斜（clock skew），您将掌握静态时序分析的基本计算方法。", "problem": "在数字电路设计中，静态时序分析（STA）是一个关键过程，用于在不实际模拟输入向量的情况下，验证电路是否满足其时序约束。STA的一项关键任务是确定最高工作频率。\n\n考虑一个同步数字电路路径，它位于两个上升沿触发的寄存器之间，即寄存器A（源端）和寄存器B（目的端）。两个寄存器均由同一个时钟源驱动。来自寄存器A的数据输出在到达寄存器B的数据输入之前，会经过一个组合逻辑块。该组合逻辑块由一个2输入与门组成，其输出馈入一个3输入或门，该或门再驱动一个连接到寄存器B数据输入端的反相器。\n\n电路元件的时序参数如下：\n- 寄存器时钟到Q端延迟 ($t_{cq}$): 0.7 ns\n- 寄存器建立时间 ($t_{su}$): 1.1 ns\n- 寄存器保持时间 ($t_{h}$): 0.5 ns\n- 2输入与门的传播延迟 ($t_{AND2}$): 0.6 ns\n- 3输入或门的传播延迟 ($t_{OR3}$): 0.8 ns\n- 反相器的传播延迟 ($t_{INV}$): 0.3 ns\n\n由于硅片上的布线差异，寄存器之间存在时钟偏斜 ($t_{skew}$)。时钟信号到达寄存器B的时间比到达寄存器A的时间晚0.2 ns。\n\n计算此电路路径能正确工作的最大可能时钟频率。答案以兆赫兹（MHz）为单位表示，并四舍五入到三位有效数字。", "solution": "我们分析从寄存器A（发射端）通过组合逻辑到寄存器B（捕获端）的单个同步路径，两者都在同一时钟沿触发，且存在正的捕获偏斜。相关的时序约束是用于确定最高时钟频率的建立时间约束，以及用于保证正确性的保持时间约束。\n\n首先，计算从寄存器A的输出到寄存器B的输入的总组合逻辑传播延迟。该逻辑为一个2输入与门馈入一个3输入或门，再馈入一个反相器。将组合路径延迟定义为\n$$\nt_{\\text{pd,comb}}=t_{\\text{AND2}}+t_{\\text{OR3}}+t_{\\text{INV}}.\n$$\n代入给定值，\n$$\nt_{\\text{pd,comb}}=0.6\\ \\text{ns}+0.8\\ \\text{ns}+0.3\\ \\text{ns}=1.7\\ \\text{ns}.\n$$\n\n对于考虑时钟偏斜的建立时序，所需的时钟周期满足\n$$\nT_{\\text{clk}}\\geq t_{cq}+t_{\\text{pd,comb}}+t_{su}-t_{\\text{skew}},\n$$\n其中，当捕获时钟（在寄存器B处）比发射时钟（在寄存器A处）晚到达时，$t_{\\text{skew}}$ 取正值，这会放宽建立时间要求。当 $t_{cq}=0.7\\ \\text{ns}$，$t_{\\text{pd,comb}}=1.7\\ \\text{ns}$，$t_{su}=1.1\\ \\text{ns}$，且 $t_{\\text{skew}}=0.2\\ \\text{ns}$ 时，\n$$\nT_{\\text{clk}}\\geq 0.7+1.7+1.1-0.2=3.3\\ \\text{ns}.\n$$\n因此，最小周期为 $T_{\\min}=3.3\\ \\text{ns}$，最大时钟频率为\n$$\nf_{\\max}=\\frac{1}{T_{\\min}}=\\frac{1}{3.3\\ \\text{ns}}=0.30303\\ldots\\ \\text{GHz}=303.03\\ldots\\ \\text{MHz}.\n$$\n四舍五入到三位有效数字， $f_{\\max}=303\\ \\text{MHz}$。\n\n为了完整起见，验证保持时间约束未被违反。考虑时钟偏斜的保持时间要求为：\n$$\nt_{cq,min} + t_{cd,comb} \\ge t_h + t_{skew}\n$$\n其中正偏斜（捕获时钟较晚）会使保持时间约束更难满足。使用给定值并假设最短逻辑延迟 $t_{cd,comb} \\ge 0$，我们检查是否 $0.7\\ \\text{ns} \\ge 0.5\\ \\text{ns} + 0.2\\ \\text{ns}$。该不等式（$0.7\\ \\text{ns} \\ge 0.7\\ \\text{ns}$）成立，因此保持时序得到满足，并且不会限制频率。所以，最高工作频率由上面计算的建立时间约束决定。", "answer": "$$\\boxed{303}$$", "id": "1963736"}, {"introduction": "虽然前一个练习关注“慢路径”，但如果数据传输过快，电路也可能失效，这会导致保持时间（hold time）违例。本练习将展示一个“快路径”导致寄存器数据不稳定的真实场景。你将学习如何使用最小路径延迟来计算保持时间裕量（hold slack），并确定修复违例所需的精确延迟量，这是物理电路设计中一项常见且关键的任务。", "problem": "一名数字设计工程师正在对现场可编程门阵列 (FPGA) 内的一条同步数据路径进行静态时序分析 (STA)。该路径由一个源D型触发器 (FF1)、一个组合逻辑块和一个目标D型触发器 (FF2) 组成。两个触发器均为上升沿触发，并由同一个理想系统时钟驱动，这意味着它们之间的时钟偏斜为零。\n\n路径中各组件的时序特性如下：\n- 系统时钟周期 ($T_{clk}$)：1.0 ns\n- FF1 的时钟到Q端延迟 ($T_{c \\to q}$)：最小值为 120 ps，最大值为 200 ps。\n- 组合逻辑的传播延迟 ($T_{logic}$)：最小值为 80 ps，最大值为 150 ps。\n- FF2 的建立时间要求 ($T_{su}$)：150 ps。\n- FF2 的保持时间要求 ($T_{h}$)：250 ps。\n\n该工程师的分析正确地指出了此路径存在保持时间违规。为解决此问题，将在组合逻辑块中插入特殊的非反相缓冲单元以增加延迟。为了确保满足保持时间要求，必须向该数据路径添加的最小延迟量是多少？答案以皮秒 (ps) 为单位。", "solution": "目标是确定为解决保持时间违规而需要添加到数据路径的最小延迟。\n\n首先，我们来理解同步数字电路中的保持时间约束。触发器的保持时间 ($T_h$) 是指在有效时钟沿到达*之后*，数据输入 (D) 必须保持稳定的最短时间。如果由源触发器在同一时钟沿发出的数据，过快地传播通过组合逻辑，在保持时间结束前就覆盖了目标触发器的输入，此时就会发生违规。这被称为“快路径”问题。\n\n因此，在进行保持时间分析时，必须使用数据路径的最小延迟值。数据能够到达目标触发器 (FF2) 输入端的最早时间，是源触发器 (FF1) 的最小时钟到Q端延迟与互连组合逻辑的最小传播延迟之和。\n\n设 $T_{arrival, min}$ 为数据到达 FF2 输入端的最早时间。\n$$T_{arrival, min} = T_{c \\to q, min} + T_{logic, min}$$\n根据题目描述，我们有：\n$T_{c \\to q, min} = 120 \\text{ ps}$\n$T_{logic, min} = 80 \\text{ ps}$\n\n代入这些值：\n$$T_{arrival, min} = 120 \\text{ ps} + 80 \\text{ ps} = 200 \\text{ ps}$$\n\n保持时间约束要求这个最早到达时间必须大于或等于 FF2 的保持时间要求 ($T_h$)。\n保持时间裕量 ($S_h$) 是数据最早到达时间与保持时间要求 ($T_h$) 之间的差值。\n$$S_h = T_{arrival, min} - T_h$$\nFF2 的保持时间要求为 $T_h = 250 \\text{ ps}$。\n$$S_h = 200 \\text{ ps} - 250 \\text{ ps} = -50 \\text{ ps}$$\n保持时间裕量为负值表示存在违规。裕量的大小为 50 ps，表示数据路径比要求快了 50 ps。数据在 FF2 输入端的变化比允许的时间早了 50 ps。\n\n要修复此违规，我们必须为数据路径增加延迟，例如通过插入缓冲单元。设所需的最小附加延迟为 $T_{add}$。新的最早到达时间 $T'_{arrival, min}$ 将为：\n$$T'_{arrival, min} = T_{arrival, min} + T_{add}$$\n为了满足保持时间约束，新的保持时间裕量必须大于或等于零。为了求得最小附加延迟，我们将新的裕量设为恰好等于零。\n$$S'_{h} = T'_{arrival, min} - T_h = 0$$\n$$(T_{arrival, min} + T_{add}) - T_h = 0$$\n求解 $T_{add}$：\n$$T_{add} = T_h - T_{arrival, min}$$\n代入已知值：\n$$T_{add} = 250 \\text{ ps} - 200 \\text{ ps} = 50 \\text{ ps}$$\n或者，最小附加延迟必须等于负裕量的大小（绝对值）：\n$$T_{add} = |S_h| = |-50 \\text{ ps}| = 50 \\text{ ps}$$\n因此，必须为数据路径添加至少 50 ps 的延迟才能修复保持时间违规。其他参数（$T_{clk}$、最大延迟和 $T_{su}$）与建立时间分析相关，而与保持时间分析无关，因此在本计算中未使用。", "answer": "$$\\boxed{50}$$", "id": "1963767"}, {"introduction": "最后的这个练习综合了我们对建立时间与保持时间约束的理解。对于一个给定的时钟速度，逻辑延迟存在一个“最佳范围”——不能太长以致违反建立时间，也不能太短以致违反保持时间。本练习要求你确定这个有效的操作窗口，从而全面展示这两个基本时序检查如何协同工作以确保电路的可靠性。", "problem": "一个工程团队正在为一款高性能四轴飞行器的惯性测量单元（IMU）设计一款定制的专用集成电路（ASIC）。该设计中的一条关键数据路径由一个发送寄存器、一个组合逻辑块和一个捕获寄存器组成。该路径对于实时处理传感器数据至关重要。为了使电路正常工作，它必须满足时序约束，且不能有任何建立时间或保持时间违例。\n\n整个电路由一个理想时钟网络驱动，这意味着发送寄存器和捕获寄存器之间的时钟偏斜为零。时钟周期固定为 $T_{clk}$。这些寄存器（建模为D型触发器）均来自相同的标准单元库，并具有以下共同特性：时钟到Q端延迟为 $t_{cq}$，建立时间要求为 $t_{su}$，保持时间要求为 $t_h$。组合逻辑块的延迟用 $t_{comb}$ 表示。\n\n所使用的工艺节点具体时序参数如下：\n- 时钟周期, $T_{clk} = 2000 \\text{ ps}$\n- 时钟到Q端延迟, $t_{cq} = 80 \\text{ ps}$\n- 建立时间, $t_{su} = 110 \\text{ ps}$\n- 保持时间, $t_h = 95 \\text{ ps}$\n\n为确保可靠运行，组合逻辑延迟 $t_{comb}$ 必须落在特定的允许范围 $[t_{comb,\\,min}, t_{comb,\\,max}]$ 内。请确定组合逻辑块的最小和最大允许延迟的数值。\n\n请将最终答案表示为 $t_{comb,\\,min}$ 和 $t_{comb,\\,max}$ 的一对数值，并按此顺序排列。数值单位必须是皮秒（ps）。", "solution": "对于一个从发送寄存器经过组合逻辑到捕获寄存器的同步路径，在时钟偏斜为零的情况下，其时序约束包括建立时间约束和保持时间约束。\n\n对于建立时间约束，在一个时钟沿发送的数据必须在下一个时钟沿到来之前到达捕获寄存器并满足建立时间要求。在零偏斜的情况下，可得：\n$$\nt_{cq} + t_{comb} + t_{su} \\leq T_{clk}.\n$$\n求解 $t_{comb}$ 可得到最大允许组合逻辑延迟：\n$$\nt_{comb,\\,max} = T_{clk} - t_{cq} - t_{su}.\n$$\n\n对于保持时间约束，新发送的数据相对于同一个时钟沿，不能过早到达捕获寄存器的输入端。在零偏斜的情况下，可得：\n$$\nt_{cq} + t_{comb} \\geq t_{h}.\n$$\n求解 $t_{comb}$ 可得到最小允许组合逻辑延迟：\n$$\nt_{comb,\\,min} = t_{h} - t_{cq}.\n$$\n\n代入给定的数值 $T_{clk} = 2000\\,\\text{ps}$、$t_{cq} = 80\\,\\text{ps}$、$t_{su} = 110\\,\\text{ps}$ 和 $t_{h} = 95\\,\\text{ps}$：\n$$\nt_{comb,\\,max} = 2000 - 80 - 110 = 1810\\,\\text{ps},\n$$\n$$\nt_{comb,\\,min} = 95 - 80 = 15\\,\\text{ps}.\n$$\n\n因此，组合逻辑延迟的允许范围是 $[15\\,\\text{ps}, 1810\\,\\text{ps}]$。", "answer": "$$\\boxed{\\begin{pmatrix} 15 & 1810 \\end{pmatrix}}$$", "id": "1963715"}]}