{"hands_on_practices": [{"introduction": "在同步电路中，保持时间 ($T_{hold}$) 确保了在时钟沿到达后，输入数据能稳定足够长的时间，以被正确锁存。然而，正时钟偏斜 ($T_{skew} > 0$)，即时钟信号到达目标寄存器晚于源寄存器，会缩短满足保持时间要求的有效时间窗口。这个练习将指导你计算在特定路径上为防止保持时间违例所能容忍的最大正时钟偏斜，这是时序分析中的一个基本而关键的技能 [@problem_id:1921203]。", "problem": "一位数字设计工程师正在分析两个顺序流水线寄存器（`R1` 和 `R2`）之间关键数据路径的时序。这两个寄存器由同一时钟源驱动，但由于芯片物理布局中的布线差异，时钟信号到达寄存器 `R2` 的时间与到达寄存器 `R1` 的时间不同。这种时序差异称为时钟偏斜（clock skew）。正偏斜 $T_{skew}$ 意味着时钟沿到达 `R2` 的时间晚于到达 `R1` 的时间。\n\n连接 `R1` 输出和 `R2` 输入的组合逻辑电路具有最小传播延迟（或称污染延迟），为 $T_{cd} = 0.954$ ns。这是从 `R1` 输出的变化影响到 `R2` 输入所需的最短时间。寄存器本身有规定的保持时间 $T_{hold} = 0.221$ ns，这是在有效时钟沿*之后*，寄存器输入端的数据必须保持稳定的最短时间。\n\n为防止保持时间违例并确保可靠操作，这条特定的数据路径能容忍的最大正时钟偏斜 $T_{skew}$ 是多少？请用纳秒（ns）作答，并四舍五入到三位有效数字。", "solution": "为了在从寄存器 R1（发射端）到寄存器 R2（捕获端）的路径上避免正时钟偏斜下的保持时间违例，新数据到达 R2 输入端的最早时间不得早于捕获时钟沿之后所要求的保持窗口。假设 R1 处的发射时钟沿发生在时间零点。新数据能出现在 R2 输入端的最早时间是在发射沿之后的 $t_{ccq,\\min} + T_{cd}$，其中 $t_{ccq,\\min}$ 是源寄存器的最小 clock-to-Q 延迟，而 $T_{cd}$ 是从 R1 输出到 R2 输入的组合逻辑污染延迟。捕获时钟在时间 $T_{skew}$（正偏斜）到达 R2。保持时间要求规定，新数据的到达时间相对于捕获时钟必须满足\n$$(t_{ccq,\\min} + T_{cd}) - T_{skew} \\ge T_{hold}.$$\n重新整理可得允许的偏斜范围\n$$T_{skew} \\le t_{ccq,\\min} + T_{cd} - T_{hold}.$$\n题目没有提供 $t_{ccq,\\min}$，并将 $T_{cd}$ 定义为从 R1 输出变化到 R2 输入的时间，因此我们对这条路径采用标准的简化假设，即在保持时间检查中 $t_{ccq,\\min}$ 可以忽略不计。因此，\n$$T_{skew,\\max} = T_{cd} - T_{hold}.$$\n代入给定的数值（单位为纳秒）并计算，\n$$T_{skew,\\max} = 0.954 - 0.221 = 0.733.$$\n四舍五入到三位有效数字，最大可容忍的正时钟偏斜为 $0.733$（单位与题目指定一致）。", "answer": "$$\\boxed{0.733}$$", "id": "1921203"}, {"introduction": "基于前一个练习对保持时间的理解，我们来探讨一个更具挑战性的场景：当组合逻辑路径的延迟过短时，可能会出现无法通过调整时钟周期来解决的固有保持时间违例。这个练习将揭示一种反直觉但极为重要的设计技巧——有意引入负时钟偏斜 ($T_{skew} < 0$)，即让时钟提前到达目标寄存器，从而“借用”时间来满足保持要求。通过这个实践，你将学会如何利用时钟偏斜来修复关键路径上的时序问题 [@problem_id:1921176]。", "problem": "一个数字同步流水线正在设计中。考虑两个连续级之间的一条路径，该路径由一个发射触发器（FF1）、一个组合逻辑块和一个捕获触发器（FF2）组成。相同的时钟信号被分配到这两个触发器。\n\n触发器和逻辑电路的时序特性如下：\n- 触发器的时钟到Q端延迟，$t_{cq} = 0.3$ ns。\n- 触发器的建立时间要求，$t_{setup} = 0.5$ ns。\n- 触发器的保持时间要求，$t_{hold} = 0.6$ ns。\n- 组合逻辑的最大传播延迟（长路径），$t_{logic\\_max} = 3.0$ ns。\n- 组合逻辑的最小污染延迟（短路径），$t_{logic\\_min} = 0.2$ ns。\n\n时钟偏斜 $t_{skew}$ 定义为两个触发器之间时钟信号到达时间的差异：$t_{skew} = t_{clk2} - t_{clk1}$，其中 $t_{clk1}$ 和 $t_{clk2}$ 分别是时钟信号到达FF1和FF2的时间。初始设计假设时钟分配是理想的，偏斜为零（$t_{skew} = 0$）。\n\n初步的时序分析表明，该设计存在一个时序违例，无论选择何种时钟频率，都无法保证其正确运行。为了解决这个问题，设计者必须调整时钟路径布线以引入一个非零偏斜。假设所有其他时序参数都不能改变，为确保电路无此违例地运行，时钟偏斜 $t_{skew}$ 的最大允许值是多少？\n\n请用纳秒（ns）表示你的最终答案。将你的最终答案四舍五入到两位有效数字。", "solution": "设FF1处的时钟上升沿发生在时间 $t=0$，而FF2处的相应时钟沿发生在 $t=t_{skew}$，其中 $t_{skew}=t_{clk2}-t_{clk1}$。\n\n发射的数据能够到达FF2输入端的最早时间是\n$$\nt_{\\text{arrive, min}}=t_{cq}+t_{logic\\_min}\n$$。\n为了满足FF2的保持时间要求，新数据不能在FF2时钟沿之后的保持窗口结束前到达。因此，保持时间约束为\n$$\nt_{cq}+t_{logic\\_min} \\ge t_{skew}+t_{hold}\n$$，\n整理后得到\n$$\nt_{skew} \\le t_{cq}+t_{logic\\_min}-t_{hold}\n$$。\n代入给定值，\n$$\nt_{skew} \\le 0.3+0.2-0.6=-0.1 \\text{ ns}\n$$。\n因此，在初始设计 $t_{skew}=0$ 的情况下，该不等式被违背（因为 $0>-0.1$），产生了一个保持时间违例，该违例无法通过改变时钟周期来修复。为了消除这个违例，设计者必须引入负偏斜，使得仍然满足保持时间约束的 $t_{skew}$ 的最大允许值为\n$$\nt_{skew,\\max}=-0.1 \\text{ ns}\n$$。\n为了完整起见，建立时间约束为\n$$\nT \\ge t_{cq}+t_{logic\\_max}+t_{setup}-t_{skew}\n$$，\n当 $t_{skew}=-0.1 \\text{ ns}$ 时，对于足够大的 $T$，该约束仍然可以满足。因此，可行性的限制条件是上述的保持时间约束，所要求的最大偏斜值为 $-0.1 \\text{ ns}$。\n\n四舍五入到两位有效数字，得到 $-0.10$ ns。", "answer": "$$\\boxed{-0.10}$$", "id": "1921176"}, {"introduction": "在我们分别探讨了时钟偏斜对保持时间和建立时间的影响后，是时候将这两者结合起来进行综合分析了。时钟偏斜 ($T_{skew}$) 对建立时间 ($T_{setup}$) 和保持时间 ($T_{hold}$) 有着截然相反的影响，形成了一个必须同时满足两种约束的“时序窗口”。这个最终的练习将引导你完成一次完整的时序分析，通过建立相应的不等式来计算出确保电路可靠工作所允许的时钟偏斜范围，从而让你全面掌握时钟偏斜对同步系统性能的核心影响 [@problem_id:1921187]。", "problem": "在一个同步数字电路中，一个源触发器 (FF1) 和一个目标触发器 (FF2) 都由同一个时钟信号的上升沿触发。FF1 的输出通过一个组合逻辑块连接到 FF2 的输入。\n\n电路元件的时序参数如下：\n- 时钟周期，$T_{period}$：1000 ps\n- FF1 的时钟到 Q 输出延迟，$T_{c \\to q}$：60 ps\n- FF2 的建立时间，$T_{setup}$：70 ps\n- FF2 的保持时间，$T_{hold}$：50 ps\n- 组合逻辑块的传播延迟，$T_{logic}$，其最小值为 $T_{logic,min} = 200$ ps，最大值为 $T_{logic,max} = 800$ ps。\n\n时钟偏斜，$T_{skew}$，定义为时钟到达 FF2 的时间减去时钟到达 FF1 的时间（$T_{skew} = t_{clk2} - t_{clk1}$）。为使电路正常工作，必须同时满足 FF2 的建立时间和保持时间约束。计算时钟偏斜 $T_{skew}$ 的最大允许值。答案以皮秒 (ps) 为单位表示。", "solution": "假设时钟上升沿在时间 $t_{clk1}=0$ 到达 FF1。由于偏斜定义为 $T_{skew}=t_{clk2}-t_{clk1}$，时钟上升沿在时间 $t_{clk2}=T_{skew}$ 到达 FF2，而下一个上升沿在时间 $T_{period}+T_{skew}$ 到达 FF2。\n\n建立时间约束（在下一个时钟沿捕获）：由 FF1 在 $t=0$ 时刻发出的数据到达 FF2 输入端的时间为\n$$\nt_{arr,setup}=T_{c \\to q}+T_{logic,max}\n$$。\n对于建立时间，数据必须在 $T_{period}+T_{skew}-T_{setup}$ 之前到达：\n$$\nT_{c \\to q}+T_{logic,max} \\leq T_{period}+T_{skew}-T_{setup}\n$$。\n整理后得到偏斜的下限：\n$$\nT_{skew} \\geq T_{c \\to q}+T_{logic,max}+T_{setup}-T_{period}\n$$。\n代入给定值，\n$$\nT_{skew} \\geq 60+800+70-1000=-70 \\text{ ps}\n$$。\n\n保持时间约束（同一边沿）：最早的新数据到达 FF2 输入端的时间是\n$$\nt_{arr,hold}=T_{c \\to q}+T_{logic,min}\n$$。\n为满足保持时间要求，此到达时间必须不早于 $T_{skew}+T_{hold}$：\n$$\nT_{c \\to q}+T_{logic,min} \\geq T_{skew}+T_{hold}\n$$。\n整理后得到偏斜的上限：\n$$\nT_{skew} \\leq T_{c \\to q}+T_{logic,min}-T_{hold}\n$$。\n代入给定值，\n$$\nT_{skew} \\leq 60+200-50=210 \\text{ ps}\n$$。\n\n两个约束必须同时满足，因此允许的偏斜范围是\n$$\n-70 \\text{ ps} \\leq T_{skew} \\leq 210 \\text{ ps}\n$$。\n因此，$T_{skew}$ 的最大允许值为 $210$ ps。", "answer": "$$\\boxed{210}$$", "id": "1921187"}]}