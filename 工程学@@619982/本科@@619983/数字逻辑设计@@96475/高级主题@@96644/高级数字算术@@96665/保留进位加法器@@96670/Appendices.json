{"hands_on_practices": [{"introduction": "理解保留进位加法器的最佳方式莫过于亲手追踪其操作过程。本练习将引导你逐位计算一个4位保留进位加法器在处理三个输入数时产生的中间和向量与进位向量。通过这个实践，你将清晰地看到保留进位加法器如何在没有位间进位传播的情况下，一步将三个数压缩成两个数的核心机制。[@problem_id:1918731]", "problem": "一个专用的数字信号处理器（DSP）核心被设计用于执行快速的有限脉冲响应（FIR）滤波，这是音频处理中的一个常见操作。该核心的一个关键组件是一个必须能同时将三个4位无符号二进制数相加的电路。为了达到所需的速度，采用了进位保留加法器（CSA）。CSA是一种数字加法器，它从三个或更多的数中生成一个部分和以及一个进位位序列。它将最终的进位传播推迟到后面的阶段，从而避免了传统行波进位加法器的延迟。\n\n考虑一个4位CSA处理三个输入操作数的第一级：$X = 1010_2$，$Y = 0101_2$ 和 $Z = 1100_2$。这一级由四个并行的全加器组成，每个比特位一个。在比特位 $i$ 上的全加器接收输入位 $X_i$、$Y_i$ 和 $Z_i$，并产生一个和位 $S_i$ 和一个进位输出位 $c_{i+1}$。\n\n确定作为此CSA级输出的4位部分和向量 $S = S_3S_2S_1S_0$ 和4位进位向量 $C_{vec} = c_4c_3c_2c_1$。\n\n将你的答案以一个包含两个4位二进制字符串的行矩阵形式呈现。矩阵的第一个元素应为和向量 $S$，第二个元素应为进位向量 $C_{vec}$。", "solution": "在比特位 $i$ 上的一个进位保留全加器接收三个输入位 $(X_{i},Y_{i},Z_{i})$ 并产生：\n$$S_{i}=X_{i}\\oplus Y_{i}\\oplus Z_{i},\\qquad c_{i+1}=X_{i}Y_{i}+Y_{i}Z_{i}+Z_{i}X_{i}.$$\n对于 $X=1010_{2}$，$Y=0101_{2}$，$Z=1100_{2}$，各位的分配如下：\n$$(X_{3},X_{2},X_{1},X_{0})=(1,0,1,0),\\quad (Y_{3},Y_{2},Y_{1},Y_{0})=(0,1,0,1),\\quad (Z_{3},Z_{2},Z_{1},Z_{0})=(1,1,0,0).$$\n按位计算：\n- 对于 $i=0$：$(X_{0},Y_{0},Z_{0})=(0,1,0)$，所以 $S_{0}=0\\oplus 1\\oplus 0=1$，且 $c_{1}=0\\cdot 1+1\\cdot 0+0\\cdot 0=0$。\n- 对于 $i=1$：$(X_{1},Y_{1},Z_{1})=(1,0,0)$，所以 $S_{1}=1\\oplus 0\\oplus 0=1$，且 $c_{2}=1\\cdot 0+0\\cdot 0+1\\cdot 0=0$。\n- 对于 $i=2$：$(X_{2},Y_{2},Z_{2})=(0,1,1)$，所以 $S_{2}=0\\oplus 1\\oplus 1=0$，且 $c_{3}=0\\cdot 1+1\\cdot 1+0\\cdot 1=1$。\n- 对于 $i=3$：$(X_{3},Y_{3},Z_{3})=(1,0,1)$，所以 $S_{3}=1\\oplus 0\\oplus 1=0$，且 $c_{4}=1\\cdot 0+0\\cdot 1+1\\cdot 1=1$。\n因此，部分和向量为 $S=S_{3}S_{2}S_{1}S_{0}=0011$，进位向量为 $C_{vec}=c_{4}c_{3}c_{2}c_{1}=1100$。", "answer": "$$\\boxed{\\begin{pmatrix} 0011 & 1100 \\end{pmatrix}}$$", "id": "1918731"}, {"introduction": "保留进位加法器（CSA）完成了将三个操作数压缩为两个向量（和向量$S$与进位向量$C$）的任务，但这只是整个加法过程的第一步。本练习将聚焦于后续的关键步骤：如何使用一个常规的进位传播加法器（如行波进位加法器）将这两个中间向量合并，从而得到最终的求和结果。这个过程清晰地揭示了进位传播并没有被消除，而是被巧妙地推迟到了最后一级，这也是CSA实现高速运算的关键所在。[@problem_id:1918753]", "problem": "在高性能的数字信号处理 (DSP) 应用中，快速乘法至关重要。这通常通过对一系列部分积求和来实现。为了加速多个操作数的加法过程，经常采用进位保留加法器 (CSA)。与传统加法器不同，CSA 将三个输入数减少为两个输出数——一个和向量和一个进位向量——而没有完全进位传播的延迟。\n\n考虑一个定制设计的4位DSP核心，它使用CSA作为关键组件。该CSA接收三个4位操作数，并产生一个4位的和向量 $S$ 和一个4位的进位向量 $C$。进位向量 $C$ 是由四个内部全加器各自产生的进位位组成序列，并将该序列向左移动一位，最低有效位用零填充而形成的。这两个得到的向量 $S$ 和 $C$ 随后被传递到一个最终的4位行波进位加法器 (RCA) 以产生最终的和。这个最终RCA的进位输出成为整个结果的最高有效位。\n\n假设对于一次特定计算，CSA阶段输出的和向量为 $S = 1011_2$，进位向量为 $C = 0110_2$。计算将这两个向量相加得到的最终5位和。请用一个5位的二进制数给出答案。", "solution": "进位保留加法器产生一个和向量 $S$ 和一个移位的进位向量 $C$，然后由一个行波进位加法器 (RCA) 将它们合并。RCA通过将 $S$ 和 $C$ 相加来形成最终结果，其中进位从最低有效位 (LSB) 完全传播到最高有效位 (MSB)。令 $S = s_{3}s_{2}s_{1}s_{0} = 1011_{2}$ 且 $C = c_{3}c_{2}c_{1}c_{0} = 0110_{2}$。初始化输入进位为 $k_{0} = 0$。对于每个比特位置 $i \\in \\{0,1,2,3\\}$，RCA 计算\n$$\nr_{i} = s_{i} \\oplus c_{i} \\oplus k_{i}, \\quad\nk_{i+1} = (s_{i} \\land c_{i}) \\lor (s_{i} \\land k_{i}) \\lor (c_{i} \\land k_{i}).\n$$\n逐位计算：\n\n- LSB (最低有效位) ($i=0$): $s_{0}=1$, $c_{0}=0$, $k_{0}=0$,\n$$\nr_{0} = 1 \\oplus 0 \\oplus 0 = 1, \\quad\nk_{1} = (1 \\land 0) \\lor (1 \\land 0) \\lor (0 \\land 0) = 0.\n$$\n\n- $i=1$: $s_{1}=1$, $c_{1}=1$, $k_{1}=0$,\n$$\nr_{1} = 1 \\oplus 1 \\oplus 0 = 0, \\quad\nk_{2} = (1 \\land 1) \\lor (1 \\land 0) \\lor (1 \\land 0) = 1.\n$$\n\n- $i=2$: $s_{2}=0$, $c_{2}=1$, $k_{2}=1$,\n$$\nr_{2} = 0 \\oplus 1 \\oplus 1 = 0, \\quad\nk_{3} = (0 \\land 1) \\lor (0 \\land 1) \\lor (1 \\land 1) = 1.\n$$\n\n- 4位级的 MSB (最高有效位) ($i=3$): $s_{3}=1$, $c_{3}=0$, $k_{3}=1$,\n$$\nr_{3} = 1 \\oplus 0 \\oplus 1 = 0, \\quad\nk_{4} = (1 \\land 0) \\lor (1 \\land 1) \\lor (0 \\land 1) = 1.\n$$\n\n最终的5位结果是最终进位输出和四个和位相连接的结果：\n$$\nr_{4}r_{3}r_{2}r_{1}r_{0} = 1\\,0\\,0\\,0\\,1 = 10001_{2}.\n$$", "answer": "$$\\boxed{10001_{2}}$$", "id": "1918753"}, {"introduction": "掌握了基本原理后，让我们将保留进位加法器的思想应用到一个更接近实际工程的设计问题中。本练习要求你仅使用全加器（FA）作为基本单元，来构建一个能统计七个输入位中‘1’的个数的（7,3）计数器，并分析其关键路径延迟。这个问题不仅将CSA的概念推广到用于处理多个输入的层次化结构（如华莱士树），还引入了衡量其性能的核心指标——传播延迟，让你亲身体会这种并行架构为何能实现高速计算。[@problem_id:1918758]", "problem": "在设计一个专用的数据采集单元时，需要构建一个电路来统计七条并行输入线 $\\{x_0, x_1, x_2, x_3, x_4, x_5, x_6\\}$ 组成的总线上'1'的数量。该电路必须产生一个3位二进制加权数 $\\{y_2, y_1, y_0\\}$ 来表示这个计数值。唯一可用的构建模块是标准的全加器 (FA) 单元。\n\n一个全加器单元有三个输入 $A$、$B$ 和 $C_{in}$，以及两个输出：一个和位 $S$ 和一个进位输出位 $C_{out}$。它们的关系是 $S = A \\oplus B \\oplus C_{in}$ 和 $C_{out} = (A \\cdot B) + (B \\cdot C_{in}) + (A \\cdot C_{in})$。为了进行时序分析，假设从三个输入 ($A, B, C_{in}$) 中的任意一个到两个输出 ($S, C_{out}$) 中的任意一个的传播延迟是一个恒定值 $T_{FA}$。互连线的延迟可以忽略不计。\n\n你的任务是确定这个仅由全加器单元构建的7输入计数器的最优实现的关键路径延迟。请将最终答案表示为 $T_{FA}$ 的整数倍。", "solution": "我们将全加器 (FA) 建模为一个按位位置（列）操作的 3:2 压缩器：对于任何列，每个FA接收该列的三个输入位，并产生一个位于同一列的和位以及一个位于下一个更高位列的进位。根据时序模型，从任何FA输入到任一输出的传播延迟为 $T_{FA}$；因此，一条穿过 $n$ 个级联FA的路径的延迟为 $nT_{FA}$。\n\n我们从七个初始输入 $\\{x_{0},\\dots,x_{6}\\}$ 开始，它们都位于第0列（权重为1）。令 $h_{k}$ 表示在给定阶段第 $k$ 列的位数（或称高度）。初始时，\n$$\nh_{0}=7,\\quad h_{1}=0,\\quad h_{2}=0.\n$$\n\n阶段1（$T_{FA}$ 后）：在第0列并行使用 $\\lfloor 7/3\\rfloor=2$ 个FA。每个FA消耗第0列的3个位，产生一个在第0列的和位和一个到第1列的进位。更新后的各列高度为\n$$\nh_{0}= (7-2\\cdot 3)+2=3,\\quad h_{1}=0+2=2,\\quad h_{2}=0.\n$$\n具体来说，如果FA1接收 $(x_{0},x_{1},x_{2})$，FA2接收 $(x_{3},x_{4},x_{5})$，它们的和 $s_{1},s_{2}$ 仍留在第0列，它们的进位 $c_{1},c_{2}$ 进入第1列。剩余的位 $x_{6}$ 留在第0列。\n\n阶段2（$2T_{FA}$ 后）：使用一个在第0列的FA来压缩有 $h_{0}=3$ 个位的第0列。这会产生一个在第0列的和位和一个到第1列的进位。第1列原有2个位，再接收一个进位，变为3个位。因此，\n$$\nh_{0}=1,\\quad h_{1}=3,\\quad h_{2}=0.\n$$\n此时，第0列有一个单个位，即最终的 $y_{0}$（最低有效位 LSB），它在 $2T_{FA}$ 后可用。\n\n阶段3（$3T_{FA}$ 后）：使用一个在第1列的FA来压缩有 $h_{1}=3$ 个位的第1列。这会产生一个在第1列的和位和一个到第2列的进位：\n$$\nh_{0}=1,\\quad h_{1}=1,\\quad h_{2}=1.\n$$\n第1列和第2列中的这些单个位是最终的 $y_1$ 和 $y_2$，它们都在 $3T_{FA}$ 后可用。\n\n现在确定关键路径。根据上述构造，$y_{0}$ 在 $2T_{FA}$ 后就绪，而 $y_{1}$ 和 $y_{2}$ 在 $3T_{FA}$ 后就绪。为了说明 $3T_{FA}$ 确实是最长路径，我们追踪一个明确的输入到输出的依赖关系：例如，\n- 一个输入，在阶段1中贡献于 $s_1$ 或 $s_2$，然后在第0列的阶段2的FA中贡献于进位 $c_3$，最后在第1列的阶段3的FA中贡献于进位（或和），从而产生 $y_2$ 或 $y_1$，\n该路径穿过三个级联的FA，因此产生 $3T_{FA}$ 的延迟。\n\n为了证明其最优性（一个下界），我们观察到，要产生第2列的任何位，都需要一个来自第1列FA的进位。初始时 $h_{1}=0$。经过一级FA后，从第0列进入第1列的最大进位数量为 $\\lfloor 7/3\\rfloor=2$，这不足以操作第1列的FA（需要3个输入）。因此，任何第2列的位都不可能在少于三级FA内产生：需要一级来产生最多两个进入第1列的进位，第二级来产生至少第三个进入第1列的位，以及第三级来压缩第1列并产生进入第2列的进位。因此，任何实现的电路其关键路径都必须至少为 $3T_{FA}$，而上述构造达到了这个下界。\n\n因此，最优实现的关键路径延迟是 $3T_{FA}$。", "answer": "$$\\boxed{3T_{FA}}$$", "id": "1918758"}]}