{"hands_on_practices": [{"introduction": "理解主从JK触发器行为的第一步是能够精确追踪其在时钟信号驱动下的状态变化。本练习将引导你逐个时钟周期地分析触发器的内部和外部状态，这是一个在分析任何序向电路时都至关重要的基本功。通过这个实践，你将牢固掌握主锁存器和从锁存器如何协同工作，以响应变化的输入信号。[@problem_id:1945792]", "problem": "一个数字电路采用了一个主从JK触发器，其初始输出状态为 $Q=0$。该触发器的行为定义如下：当主锁存器在时钟信号 (CLK) 为高电平（逻辑 1）时是透明的，其状态 $Q_m$ 由特性方程 $Q_m = J\\bar{Q} + \\bar{K}Q$ 决定，其中 $J$ 和 $K$ 是输入，$Q$ 是触发器的当前输出。从锁存器仅在时钟信号 CLK 的下降沿将最终输出 $Q$ 更新为主锁存器的状态 $Q_m$。当时钟 CLK 为低电平（逻辑 0）时，主锁存器和从锁存器都保持其当前状态。\n\n该触发器由一个周期为 40 ns、占空比为 50% 的周期性时钟信号 CLK 驱动。在每个周期中，时钟在前 20 ns 为高电平，在接下来的 20 ns 为低电平。具体来说，对于任何整数 $n \\ge 0$，CLK 在时间区间 $[40n \\text{ ns}, (40n + 20) \\text{ ns})$ 内为高电平，在 $[(40n + 20) \\text{ ns}, (40n + 40) \\text{ ns})$ 内为低电平。\n\n输入 J 和 K 随时间变化如下：\n- 对于时间区间 $[0 \\text{ ns}, 30 \\text{ ns})$ 内的 $t$：$J=1$, $K=0$。\n- 对于时间区间 $[30 \\text{ ns}, 70 \\text{ ns})$ 内的 $t$：$J=1$, $K=1$。\n- 对于时间区间 $[70 \\text{ ns}, 120 \\text{ ns}]$ 内的 $t$：$J=0$, $K=1$。\n\n确定在 $t = 120$ ns 这个精确时刻，最终输出 $Q$ 的逻辑电平（0 或 1）。", "solution": "主锁存器仅在时钟为高电平时透明，并根据特性方程设置 $Q_{m}$\n$$\nQ_{m}=J\\bar{Q}+\\bar{K}Q\n$$\n而从锁存器仅在时钟下降沿将 $Q$ 更新为 $Q_{m}$。对于周期为 $40$ ns 且占空比为 50%，下降沿出现在 $t=20+40n$（整数 $n\\geq 0$）的时刻。在 $t=120$ ns 之前，下降沿出现在 $t=20$ ns、 $t=60$ ns 和 $t=100$ ns。初始条件是 $Q(0)=0$。\n\n在第一个高电平阶段 $t\\in[0,20)$，输入为 $J=1$，$K=0$，且 $Q=0$，因此透明的主锁存器产生\n$$\nQ_{m}=1\\cdot\\bar{0}+\\bar{0}\\cdot 0=1\\cdot 1+1\\cdot 0=1\n$$\n在 $t=20$ ns 的下降沿，从锁存器更新 $Q\\leftarrow Q_{m}=1$，所以 $Q$ 变为 $1$，并在低电平阶段 $t\\in[20,40)$ 保持不变。\n\n在下一个上升沿 $t=40$ ns，时钟变为高电平，此时输入为 $J=1$，$K=1$（它们在低电平期间的 $t=30$ ns 时刻发生变化），而 $Q=1$ 是上一次更新的结果。透明的主锁存器计算\n$$\nQ_{m}=1\\cdot\\bar{1}+\\bar{1}\\cdot 1=1\\cdot 0+0\\cdot 1=0\n$$\n并在高电平窗口 $t\\in[40,60)$ 期间保持这个值。在 $t=60$ ns 的下降沿，从锁存器更新 $Q\\leftarrow 0$，所以 $Q$ 变为 $0$，并在低电平阶段 $t\\in[60,80)$ 保持不变。\n\n在下一个上升沿 $t=80$ ns，输入为 $J=0$，$K=1$（它们在低电平期间的 $t=70$ ns 时刻发生变化），且 $Q=0$。透明的主锁存器计算\n$$\nQ_{m}=0\\cdot\\bar{0}+\\bar{1}\\cdot 0=0\\cdot 1+0\\cdot 0=0\n$$\n并在高电平窗口 $t\\in[80,100)$ 期间保持这个值。在 $t=100$ ns 的下降沿，从锁存器更新 $Q\\leftarrow 0$，所以 $Q$ 保持为 $0$，并在低电平阶段 $t\\in[100,120)$ 保持不变。\n\n在 $t=120$ ns 时刻是一个上升沿（下一个高电平的开始），根据定义，从锁存器在上升沿不会更新。因此，在 $t=120$ ns 这个精确时刻的最终输出是前一个下降沿确定的值，即 $Q=0$。", "answer": "$$\\boxed{0}$$", "id": "1945792"}, {"introduction": "主从结构的设计精髓在于它巧妙地解决了时序问题。为了深刻理解这一点，最好的方法莫过于分析一个“损坏”的电路，看看当关键设计被破坏时会发生什么。这个练习模拟了一个常见的制造缺陷，其结果会揭示一个被称为“竞争冒险” (race-around condition) 的经典问题，从而让你明白为何主、从锁存器必须由反相的时钟信号控制。[@problem_id:1945778]", "problem": "一位工程师正在分析一个有故障的数字电路，该电路原设计为主从JK触发器。该触发器由两个级联的电平敏感SR锁存器构成，分别称为主锁存器和从锁存器。一个标准的SR锁存器有两个输入，S（置位）和R（复位），以及一个输出Q。其行为定义如下：如果S=1且R=0，则Q变为1；如果S=0且R=1，则Q变为0；如果S=0且R=0，则Q保持其先前的值。假设S=1, R=1的输入组合永远不会出现。每个锁存器还有一个使能输入（EN）；当EN=1时，锁存器是“透明的”（输出跟随S/R输入），当EN=0时，锁存器处于“保持”状态。\n\n在原设计中，主锁存器的输入由逻辑 $S_{master} = J \\cdot \\overline{Q_{out}}$ 和 $R_{master} = K \\cdot Q_{out}$ 驱动，其中J和K是外部输入，$Q_{out}$是从锁存器的最终输出。从锁存器的输入由主锁存器的输出驱动：$S_{slave} = Q_{master}$ 和 $R_{slave} = \\overline{Q_{master}}$。主锁存器由主时钟信号 $CLK$ 使能，而从锁存器本应由反相时钟信号 $\\overline{CLK}$ 使能。\n\n然而，由于制造缺陷，用于从锁存器时钟输入端的反相器被一个同相缓冲器替换了。因此，主锁存器和从锁存器都由同一个信号 $CLK$ 使能。\n\n该电路处于以下条件：\n- 外部输入保持恒定：$J = 1$ 且 $K = 1$。\n- 时钟信号 $CLK$ 是一个周期性方波，在时间区间 $[2nT, (2n+1)T)$ 内为高电平（逻辑1），在时间区间 $[(2n+1)T, (2n+2)T)$ 内为低电平（逻辑0），其中T是一个恒定的时间长度，n是任意非负整数（$n=0, 1, 2, \\dots$）。\n- 在时间 $t=0$ 时，触发器输出的初始状态为 $Q_{out}(0) = 0$。\n\n以下哪个陈述最准确地描述了在时钟为高电平的第一个时间区间内，即当 $t$ 在 $[0, T)$ 时，输出 $Q_{out}$ 的行为？\n\nA. $Q_{out}$ 保持为 0。\n\nB. $Q_{out}$ 发生一次从 0 到 1 的跳变，然后保持为 1。\n\nC. $Q_{out}$ 发生一次从 0 到 1 的跳变，然后在时间 $T$ 之前跳变回 0。\n\nD. $Q_{out}$ 在 0 和 1 之间连续振荡。\n\nE. $Q_{out}$ 跳变到一个不确定的亚稳态。", "solution": "问题要求分析一个有故障的主从JK触发器的行为，其中主锁存器和从锁存器都由同一个时钟信号 $CLK$ 使能。\n\n首先，我们根据时钟 $CLK$ 的状态来分析电路的行为。\n问题指出，主、从SR锁存器都是电平敏感的。当它们的使能输入为高电平（1）时，它们是“透明的”；当使能输入为低电平（0）时，它们“保持”其状态。由于故障，两个锁存器都使用 $CLK$ 作为其使能信号。\n\n情况1：$CLK = 0$\n当时钟为低电平时，主锁存器和从锁存器都处于“保持”状态。这意味着它们的输出 $Q_{master}$ 和 $Q_{out}$ 不会改变，无论输入 J 和 K 是什么。整个电路保持其状态。\n\n情况2：$CLK = 1$\n当时钟为高电平时，主锁存器和从锁存器都是“透明的”。这意味着它们的输出会在一个传播延迟后改变以反映其输入。\n从锁存器的输入是 $S_{slave} = Q_{master}$ 和 $R_{slave} = \\overline{Q_{master}}$。由于从锁存器是透明的，其输出 $Q_{out}$ 将直接跟随其S输入（因为S和R是互补的）。因此，在此阶段，$Q_{out} = Q_{master}$。\n\n现在我们来分析主锁存器。其输入为 $S_{master} = J \\cdot \\overline{Q_{out}}$ 和 $R_{master} = K \\cdot Q_{out}$。由于主锁存器也是透明的，其输出 $Q_{master}$ 将由这些输入决定。\n由于我们发现在 $CLK=1$ 时 $Q_{out}=Q_{master}$，我们可以用 $Q_{out}$ 替换 $Q_{master}$。这意味着整个级联结构实际上表现为一个单一的反馈系统，其输出 $Q_{out}$ 由自身的逻辑函数决定。\n\n让我们写出当 $CLK=1$ 时 $Q_{out}$ 的控制方程。该结构的行为类似于一个单一的SR锁存器，其输入为 $S = J \\cdot \\overline{Q_{out}}$ 和 $R = K \\cdot Q_{out}$。给定当前状态 ($Q_{current}$)，SR锁存器的次态 ($Q_{next}$) 的特性方程是 $Q_{next} = S + \\bar{R} \\cdot Q_{current}$。\n在我们的透明系统中，“次态”会持续更新“现态”。因此我们可以将 $Q_{out}$ 的行为写为：\n$Q_{out} = (J \\cdot \\overline{Q_{out}}) + \\overline{(K \\cdot Q_{out})} \\cdot Q_{out}$\n\n这个方程描述了一个JK锁存器。现在我们将问题中给定的特定输入应用于时间区间 $t \\in [0, T)$。\n在此期间，$CLK=1$，且给定 $J=1$ 和 $K=1$。\n将这些值代入方程：\n$Q_{out} = (1 \\cdot \\overline{Q_{out}}) + \\overline{(1 \\cdot Q_{out})} \\cdot Q_{out}$\n$Q_{out} = \\overline{Q_{out}} + \\overline{Q_{out}} \\cdot Q_{out}$\n由于 $\\overline{Q_{out}} \\cdot Q_{out} = 0$，方程简化为：\n$Q_{out} = \\overline{Q_{out}}$\n\n这个结果 $Q_{out} = \\overline{Q_{out}}$ 意味着电路的输出在逻辑上必须是其自身的反相。这无法通过一个稳定状态来满足。如果 $Q_{out}$ 是 0，方程会强制它变为 1。一旦它变为 1（经过一个传播延迟后），方程又会强制它变为 0。这个过程不断重复，导致输出 $Q_{out}$ 连续翻转。这种现象被称为“竞态冒险”条件。\n\n因此，在 $CLK=1$ 的整个期间（区间 $[0, T)$），当 $J=1$ 且 $K=1$ 时，输出 $Q_{out}$ 将在逻辑0和逻辑1之间振荡。这与选项D相符。\n我们简要考虑一下其他选项。\nA是错误的，因为初始状态 $Q_{out}=0$ 在 $J=1, K=1$ 的条件下会立即引起变化。\nB是错误的，因为输出不会稳定在1；它会立即被强制回到0。\nC是错误的，因为其行为是连续振荡，而不是单个脉冲。\nE是错误的，因为虽然振荡是一种不理想的行为，但它是一个确定的振荡状态，而不是亚稳态（亚稳态通常是指卡在无效电压电平上的状态）。", "answer": "$$\\boxed{D}$$", "id": "1945778"}, {"introduction": "在数字逻辑的抽象世界里，我们习惯于处理确定的'0'和'1'，但物理现实更为微妙。一个常见的问题是：为什么触发器在刚上电时状态是未知的？本练习将带你跳出逻辑门符号，探讨构成触发器的晶体管的物理行为，解释微小的制造差异和随机热噪声是如何从根本上导致其初始状态不确定的。[@problem_id:1945801]", "problem": "一名数字系统专业的学生正在模拟一个简单电路的上电行为，该电路包含一个主从JK触发器。该触发器由基本逻辑门构成。在模拟中，J和K输入被连接到逻辑'0'，时钟输入保持低电平。该学生多次运行模拟，每次都将电路重新初始化到未上电状态。他们观察到初始输出状态 $Q$ 并非总是一致；有时它上电后为'0'，有时则为'1'。\n\n以下哪个选项为这种不可预测的上电状态提供了最根本的物理解释？\n\nA. 主锁存器和从锁存器之间发生竞争条件，先稳定下来的那个决定了触发器的整体状态。\n\nB. J和K输入即使连接到'0'，也存在少量电噪声，这些噪声在上电期间被放大，从而产生一个随机的输入信号。\n\nC. 构成内部锁存器的交叉耦合门（例如，与非门或或非门）具有固有的对称结构，可能导致一种被称为亚稳态的完美平衡状态。\n\nD. 需要时钟信号将状态从主锁存器传播到从锁存器，在上电时由于没有时钟信号，输出在逻辑上是断开的，因此是未定义的。\n\nE. 微观制造差异和随机热噪声在内部锁存器的电子元件中造成了微小的不对称性，导致反馈回路以一种不确定的方式稳定到其两个稳定状态之一。", "solution": "我们分析由基本逻辑门构成的主从JK触发器的上电行为。在内部，这种触发器包含由与非门或或非门构成的交叉耦合锁存器，它们实现正反馈并产生两个稳定平衡点，分别对应于 $Q=0$ 和 $Q=1$。\n\n第一步：交叉耦合锁存器中的双稳态和亚稳态。\n设 $v_{1}$ 和 $v_{2}$ 表示交叉耦合锁存器的内部节点电压。在对称工作点（亚稳态点）附近，可以对动力学进行线性化。定义差模变量 $v_{d}=v_{1}-v_{2}$。正反馈意味着，当电源电压上升使得环路增益超过1时，对称平衡点变为一个不稳定的平衡点。标准的小信号线性化得到一个形式如下的方程\n$$\n\\frac{d v_{d}}{d t}=a\\,v_{d}+\\eta(t)+\\delta\n$$\n其中 $a>0$ 反映了围绕亚稳态点的有效正反馈，$\\eta(t)$ 聚合了内部电子噪声源（例如热噪声），而 $\\delta$ 代表两个交叉耦合侧之间的任何确定性失配（微观参数不对称）。\n\n通解为\n$$\nv_{d}(t)=v_{d}(0)\\exp(a t)+\\int_{0}^{t}\\exp\\!\\big(a(t-\\tau)\\big)\\big[\\eta(\\tau)+\\delta\\big]\\,d\\tau\n$$\n由于对称点是不稳定的，任何无穷小的非零 $v_{d}$（来自初始条件、噪声或失配）都会被指数级放大，而 $v_{d}$ 的符号决定了锁存器最终稳定到哪个稳定状态（$Q=0$ 或 $Q=1$）。\n\n第二步：$\\eta(t)$ 和 $\\delta$ 的物理来源。\n- 在电阻和有源器件中，热噪声（Johnson-Nyquist噪声）是不可避免的，并对 $\\eta(t)$ 产生贡献，其功率谱密度对于温度为 $T$、电阻为 $R$ 的电阻器来说，与 $4 k_{B} T R$ 成正比，其中 $k_{B}$ 是玻尔兹曼常数。晶体管也会产生沟道噪声和闪烁噪声，所有这些噪声都有效地注入到锁存器的差模中。\n- 微观制造差异会产生阈值、增益和负载失配，这些失配表现为一个偏向某一方的微小偏移量 $\\delta$。即使 $\\delta$ 非常小，指数级放大也可能使其影响具有决定性；反之，如果 $\\delta$ 极小，随机噪声 $\\eta(t)$ 在某次上电过程中就可能占主导地位。\n\n第三步：在J=K=0且时钟为低电平时上电的后果。\n在时钟保持低电平且输入连接到0的情况下，门控电路在上电时不会强制一个唯一的内部状态；交叉耦合的核心仍然形成一个双稳态正反馈回路。随着电源电压上升，系统经过不稳定的对称点附近，并受到 $\\eta(t)$ 和 $\\delta$ 的扰动；最终产生的 $v_{d}$ 的符号决定了 $Q$ 的值。因此，在每次运行时，触发器都可能以不确定的方式上电为'0'或'1'。\n\n第四步：评估选项。\n- A是错误的：主从锁存器之间的竞争需要时钟活动；在时钟保持低电平的情况下，不存在这种决定上电状态的竞争。\n- B不是根本原因：J和K上的噪声并非必需；即使J和K保持恒定且在时钟为低电平时不被采样，不可预测性也产生于内部的交叉耦合锁存器。\n- C归因错误：亚稳态是接近完美对称时的不稳定平衡点；它不会持续存在并决定最终状态。最终结果是由噪声和失配在脱离亚稳态时如何打破对称性决定的。\n- D是错误的：尽管硬件描述语言（HDL）的语义可能将其标记为“未定义”，但在物理上，交叉耦合网络是连接的，并且必须稳定到两个稳定状态之一。\n- E正确地指出了最根本的物理原因：不可避免的微观制造差异和随机热噪声造成了微小的不对称性，这些不对称性在上电期间被正反馈指数级放大后，以不确定的方式选择了两个稳定状态之一。\n\n因此，最根本的物理解释是E。", "answer": "$$\\boxed{E}$$", "id": "1945801"}]}