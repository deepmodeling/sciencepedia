{"hands_on_practices": [{"introduction": "混合长度的概念为我们提供了一个与气体动理论的有力类比。本练习利用这一类比进行量级分析，这是物理学家和工程师的一项关键技能。通过基于大尺度流动特性来估算涡粘性 $(\\nu_{\\text{turb}})$，你将对湍流如何促进动量输运建立起基本的直觉 `[@problem_id:1921384]`。", "problem": "在天体物理吸积盘（例如形成太阳系的原行星盘）的研究中，角动量输运是一个关键过程，它使物质能够向内螺旋运动并吸积到中心恒星上。虽然分子粘性太弱，无法解释观测到的吸积率，但盘内的湍流提供了一种更有效的机制。\n\n这种湍流输运可以通过假设一个“涡粘性”来建模。考虑一个基于与气体动理论类比的湍流简化图像。在气体中，分子粘性源于分子在平均自由程上交换动量时的随机热运动。在湍流流体中，我们可以想象流体元，或称“涡”，扮演着分子的角色。\n\n让我们对这个过程进行建模。一个涡，即一个相干的流体团，携带其起源点的平均动量。它在溶解并将其动量与周围流体混合之前，会行进一个特征“混合长度”$l_m$。这些湍流涡相对于平均流的特征速度是 $v'$。通过与气体动理论的类比，湍流运动粘性 $\\nu_{turb}$ 预计在量级上等于特征涡速度与混合长度的乘积。\n\n对于大尺度流中最大、含能量最多的涡，可以合理地假设其性质由流本身的全局特征决定。假设该流由单一的大尺度速度 $U$ 和单一的大尺度长度 $L$ 表征。假设最大涡的特征速度与全局速度尺度在同一量级，即 $v' \\sim U$。此外，假设这些主导涡的混合长度与全局长度尺度在同一量级，即 $l_m \\sim L$。\n\n基于此模型和这些标度假设，找出用 $U$ 和 $L$ 表示湍流运动粘性 $\\nu_{turb}$ 的表达式。你的答案应该是与标度关系一致的最简表达式。", "solution": "从涡粘性与气体动理论的类比出发：由特征速度为 $v'$、混合长度为 $l_m$ 的涡所进行的动量湍流输运，导致湍流运动粘性的标度关系为\n$$\n\\nu_{turb} \\sim v' \\, l_m,\n$$\n因为动量通量正比于特征速度与动量交换距离的乘积。这个表达式具有正确的量纲，$[v'][l_m]=L^{2}T^{-1}$，与运动粘性的量纲相匹配。\n\n对于由单一全局速度和长度尺度表征的流中最大、含能量的涡，采用以下标度假设\n$$\nv' \\sim U, \\qquad l_m \\sim L.\n$$\n将这些代入 $\\nu_{turb}$ 的标度关系中，得到\n$$\n\\nu_{turb} \\sim U L.\n$$\n根据标度论证，舍去量级为1的常数，最简的一致表达式为\n$$\n\\nu_{turb} = U L.\n$$", "answer": "$$\\boxed{UL}$$", "id": "1921384"}, {"introduction": "在基本概念之上，我们现在将探讨一个有效的混合长度模型必须满足的物理约束。这个问题聚焦于流动的几何形状和对称性，要求你找出在管道中心混合长度 $(\\ell_m)$ 必须为零的根本原因。掌握这一概念是理解如何在不同坐标系中正确应用和构建湍流模型的关键 `[@problem_id:1812839]`。", "problem": "在流体力学的研究中，零方程湍流模型提供了一种估算湍流效应的简化方法，而无需求解额外的输运方程。其中最早且最著名的模型之一是 Prandtl 混合长度模型。该模型用于近似计算流动中的湍流切应力 $\\tau_t$。考虑一股在半径为 $R$ 的长直圆管中流动的充分发展、不可压缩的轴对称湍流。\n\n混合长度 $\\ell_m$ 的物理意义可解释为一个相干流体微团（一个“涡”）在与周围流体混合并失去其自身动量之前所经过的平均横向距离。对于管道中的轴对称流动，该模型的一个基本要求是混合长度 $\\ell_m$ 在管道中心线处（即径向位置 $r=0$ 处）必须为零。\n\n以下哪个陈述为这一要求提供了最准确和最基本的物理原因？\n\nA. 管壁（$r=R$）处的无滑移条件要求该处速度为零，而这一边界条件迫使中心线处的速度梯度以及混合长度为零。\n\nB. 由于轴对称性，不可能有动量净输运穿过中心线。这意味着引起湍流混合的横向速度脉动在 $r=0$ 处必须消失，这在运动学上阻止了涡旋穿过中心线，从而迫使其特征运动距离（混合长度）为零。\n\nC. 平均速度剖面在中心线处有最大值。根据微积分原理，任何平滑函数在其最大值处的一阶导数必须为零，因此平均速度梯度在 $r=0$ 处为零，这反过来又要求混合长度为零。\n\nD. 在管道中心线处，粘性切应力达到最大值，压倒了任何湍流效应。由于混合长度模型只描述湍流，因此在粘性效应完全占主导地位的地方，混合长度必须设置为零。\n\nE. 对于轴对称流动，在任何给定的径向截面上压力是恒定的。没有径向压力梯度意味着没有力来驱动湍流涡旋穿过中心线，因此混合长度必须为零。", "solution": "对于圆管中的充分发展、不可压缩、轴对称湍流，平均轴向速度为 $U(r)$，相关的切应力分量为\n$$\n\\tau_{rz}(r)= -\\rho\\,\\overline{u'v_r'}+\\mu \\frac{dU}{dr}.\n$$\n在充分发展的管流中，总切应力随 $r$ 线性变化，并满足\n$$\n\\tau_{rz}(r)=-\\frac{r}{2}\\frac{dp}{dz},\n$$\n因此 $\\tau_{rz}(0)=0$。在 Prandtl 的混合长度模型中，湍流切应力被封闭为\n$$\n\\tau_{t} \\equiv -\\rho\\,\\overline{u'v_r'}=\\rho\\,\\ell_{m}^{2}\\left|\\frac{dU}{dr}\\right|\\frac{dU}{dr}.\n$$\n因为中心线是一个对称点，平均速度 $U(r)$ 在该处达到最大值，所以\n$$\n\\left.\\frac{dU}{dr}\\right|_{r=0}=0.\n$$\n这立即得出 $\\tau_{t}(0)=0$，而与 $\\ell_{m}(0)$ 的值无关。因此，在 $r=0$ 处平均梯度的消失本身并不要求 $\\ell_{m}(0)=0$，所以仅仅援引 $\\frac{dU}{dr}(0)=0$（如陈述 C 中所述）并不是一个充分或根本的原因。\n\n为了确定 $\\ell_{m}$ 在轴线上的行为，必须利用轴对称性和速度场在 $r=0$ 处的正则性所蕴含的运动学。设 $(u,v_r)$ 表示瞬时速度脉动的轴向和径向分量，其中 $v_r$ 是横向（径向）分量。在柱坐标系中，径向分量为 $v_r=v_x \\cos\\theta+v_y\\sin\\theta$，其中 $(v_x,v_y)$ 是垂直于管轴的平面内的笛卡尔分量，$\\theta$ 是极角。对于一个平滑、单值的速度场，当 $r\\to 0$ 时 $v_r$ 的极限必须与 $\\theta$ 无关。对于任意 $\\theta$ 这能成立的唯一方式是\n$$\nv_r(0)=0.\n$$\n因此，根据对称性和正则性，瞬时横向（径向）速度脉动在中心线上精确地为零，因此穿过中心线的湍流输运在 $r=0$ 处是运动学上被禁止的。特别是，\n$$\n\\overline{u'v_r'}(0)=0,\n$$\n这反映了不存在穿过轴线的横向输运。\n\nPrandtl 的混合长度 $\\ell_{m}$ 是一个涡旋（相干微团）在失去其特性并混合之前可以运动的特征横向距离。在 $r=0$ 处，由于轴对称性引起的运动学约束，有 $v_r'=0$，因此涡旋不能穿过中心线；其在该处的特征横向运动距离因此必须为零：\n$$\n\\ell_{m}(0)=0.\n$$\n这一论点是该要求的基本物理原因。相比之下：(A) 错误地将中心线的行为归因于管壁的无滑移条件；(C) 将由于 $\\frac{dU}{dr}(0)=0$ 导致的 $\\tau_{t}(0)=0$ 与对 $\\ell_{m}$ 的独立要求相混淆；(D) 是错误的，因为粘性切应力在中心线处实际上为零；(E) 错误地将湍流输运归因于径向压力，而这并非湍流混合的机制。\n\n因此，最准确和最根本的原因是轴对称性施加的运动学约束，该约束禁止了轴线上的横向脉动和输运，从而迫使 $\\ell_{m}(0)=0$。", "answer": "$$\\boxed{B}$$", "id": "1812839"}, {"introduction": "这最后一个实践活动将理论与计算相结合，指导你为一个经典的槽道流实现一个混合长度模型。你将推导出速度梯度的控制方程，然后通过数值求解来预测整个速度剖面。这个练习展示了如何运用像混合长度这样的抽象概念来进行定量的、可验证的预测，这是计算流体力学的基石 `[@problem_id:2381390]`。", "problem": "实现一个完整、可运行的程序，该程序使用代数混合长度模型计算平面槽道中的湍流平均速度剖面，并将其与壁面普适律进行定量比较。该槽道为平面、充分发展、稳态且不可压缩，流向坐标为 $x$，壁面法向坐标为 $y$。流动由恒定的平均压力梯度驱动，平均速度为 $U(y)$。\n\n使用的出发点和建模假设：\n- 从针对平面槽道中稳态、充分发展、一维平均流的雷诺平均动量平衡（流向的雷诺平均Navier–Stokes (RANS) 方程）开始。平均动量方程简化为恒定压力梯度与总剪切应力沿壁面法向梯度之间的平衡。\n- 引入 Boussinesq 涡粘性假设来表示雷诺剪切应力，从而总剪切应力可以写为\n$$\n\\tau_{\\text{tot}}(y) \\;=\\; \\mu \\,\\frac{dU}{dy} \\;-\\; \\rho \\,\\overline{u'v'} \\;=\\; \\rho\\left(\\nu + \\nu_t\\right)\\,\\frac{dU}{dy},\n$$\n其中 $\\mu$ 是动力粘度，$\\rho$ 是密度，$\\nu=\\mu/\\rho$ 是运动粘度，$\\nu_t$ 是涡粘度。\n- 使用经过充分检验的事实：对于充分发展的平面槽道流，总剪切应力在半槽道内呈线性变化：\n$$\n\\tau_{\\text{tot}}(y) \\;=\\; \\tau_w\\left(1-\\frac{y}{\\delta}\\right),\n$$\n其中 $\\tau_w$ 是 $y=0$ 处的壁面剪切应力，$\\delta$ 是槽道半高。通过 $\\tau_w=\\rho\\,u_\\tau^2$ 定义摩擦速度 $u_\\tau$。\n- 采用带近壁阻尼（van Driest）的 Prandtl 混合长度模型：\n$$\n\\nu_t \\;=\\; \\ell_m^2 \\left|\\frac{dU}{dy}\\right|,\\qquad \n\\ell_m \\;=\\; \\kappa\\, y \\left[1-\\exp\\!\\left(-\\frac{y^+}{A^+}\\right)\\right],\\qquad\ny^+ \\;=\\; \\frac{y\\,u_\\tau}{\\nu},\n$$\n其中 $\\kappa$ 是 von Kármán 常数， $A^+$ 是 van Driest 阻尼常数， $y^+$ 是以壁面单位表示的壁面坐标。\n\n任务要求：\n1. 从以上基本陈述出发，推导平均剪切 $g(y)=dU/dy$ 与已知量 $\\nu$、$\\ell_m(y)$、$u_\\tau$ 和 $\\delta$ 之间的代数关系。您的推导必须消除压力梯度，转而使用整个槽道上的总应力分布。不要假设任何 $g(y)$ 的目标公式；应从给定的定义和平衡关系中明确推导。\n2. 使用您推导出的 $g(y)$ 的代数关系中物理上可接受的正值分支，并实现一个数值方法，通过对 $g(y)$ 进行积分，在满足无滑移边界条件 $U(0)=0$ 的情况下，获得在 $y\\in[0,\\delta]$ 上的 $U(y)$。计算无量纲剖面 $y^+=y\\,u_\\tau/\\nu$ 和 $U^+=U/u_\\tau$。\n3. 将计算出的 $U^+(y^+)$ 与对数区的壁面普适律进行比较：\n$$\nU^+_{\\log}(y^+) \\;=\\; \\frac{1}{\\kappa}\\,\\ln y^+ \\;+\\; B,\n$$\n其中给定常数 $\\kappa$ 和 $B$ 用于光滑壁面。使用在指定对数层窗口内的均方根 (RMS) 差异来量化偏差。\n4. 所有情况均使用以下物理常数：运动粘度 $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$，槽道半高 $\\delta = 0.05\\,\\mathrm{m}$，von Kármán 常数 $\\kappa = 0.41$，对数律截距 $B=5.2$，以及 van Driest 常数 $A^+=26$。对于每种情况，通过 $Re_\\tau = u_\\tau\\,\\delta/\\nu$ 从给定的摩擦雷诺数 $Re_\\tau$ 确定 $u_\\tau$。\n5. 计算 $U^+$ 和 $U^+_{\\log}$ 在区间 $y^+ \\in [30,\\; 0.3\\,Re_\\tau]$ 上的 RMS 误差。如果此区间不包含任何网格点，则在可用网格中 $y^+$ 最接近 $30$ 的单个网格点上评估绝对差，并将此值作为该情况的 RMS 误差返回。\n\n数值实现要求：\n- 对于每种情况，在 $y$ 方向上使用一个包含 $N$ 个点的均匀网格，包括 $y=0$ 处的壁面和 $y=\\delta$ 处的中心线。使用一致的二阶精度梯形法则对 $g(y)$ 进行积分以获得 $U(y)$。\n- 此问题中不出现角度；因此，不需要角度单位。\n- 所有报告的比较都必须是无量纲的；最终误差中无需报告物理单位。\n- 程序不得读取任何输入，并且必须逐字使用下面的测试用例。\n\n测试用例（按此确切顺序使用）：\n- 情况 1：$Re_\\tau = 180$, $N=1500$。\n- 情况 2：$Re_\\tau = 395$, $N=2000$。\n- 情况 3：$Re_\\tau = 1000$, $N=4000$。\n- 情况 4（一个对数区间非常小的边界情况）：$Re_\\tau = 90$, $N=1500$。\n\n最终输出规格：\n- 您的程序必须生成单行输出，其中包含一个 Python 风格的列表，内含与上述四种情况相对应的四个 RMS 误差，顺序相同。每个 RMS 误差必须是一个四舍五入到恰好三位小数的浮点数。打印的行必须采用以下格式：\n$[e_1,e_2,e_3,e_4]$\n其间没有任何空格。例如，一个有效的输出可能看起来像 $[0.123,0.456,0.789,1.234]$。", "solution": "该问题要求使用代数混合长度模型计算湍流平面槽道流中的平均速度剖面。解决方案涉及推导平均速度梯度的表达式，对其进行数值积分，并将得到的无量纲速度剖面与壁面普适律进行比较。\n\n出发点是稳态、充分发展槽道流的雷诺平均动量方程，该方程简化为平均压力梯度与总剪切应力 $\\tau_{\\text{tot}}$ 梯度之间的平衡。问题给出了总应力在槽道半高 $\\delta$ 内的线性剖面：\n$$\n\\tau_{\\text{tot}}(y) = \\tau_w \\left(1 - \\frac{y}{\\delta}\\right)\n$$\n其中 $\\tau_w$ 是壁面（$y=0$）处的剪切应力。壁面剪切应力通过 $\\tau_w = \\rho u_\\tau^2$ 定义了摩擦速度 $u_\\tau$，其中 $\\rho$ 是流体密度。\n\nBoussinesq 假设将雷诺剪切应力与平均速度梯度联系起来，使得总应力可以表示为：\n$$\n\\tau_{\\text{tot}}(y) = \\rho (\\nu + \\nu_t) \\frac{dU}{dy}\n$$\n这里，$\\nu$ 是运动粘度，$\\nu_t$ 是湍流或涡粘度。我们采用 Prandtl 混合长度模型来表示 $\\nu_t$，即 $\\nu_t = \\ell_m^2 |dU/dy|$，其中 $\\ell_m$ 是混合长度。对于半槽道 $y \\in [0, \\delta]$ 内的平均流，速度梯度 $dU/dy$ 是非负的，所以我们可以写成 $|dU/dy| = dU/dy$。令 $g(y) = dU/dy$，涡粘度变为 $\\nu_t = \\ell_m^2 g(y)$。\n\n将两个 $\\tau_{\\text{tot}}(y)$ 的表达式相等，并代入 $u_\\tau$ 的定义，得到：\n$$\n\\rho (\\nu + \\ell_m^2 g(y)) g(y) = \\rho u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right)\n$$\n两边同除以 $\\rho$，我们得到一个关于速度梯度 $g(y)$ 的代数方程：\n$$\n(\\nu + \\ell_m^2 g(y)) g(y) = u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right)\n$$\n这可以整理成一个关于 $g(y)$ 的二次方程：\n$$\n\\ell_m^2 [g(y)]^2 + \\nu g(y) - u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right) = 0\n$$\n这是一个标准形式为 $ax^2+bx+c=0$ 的二次方程，其中 $x=g(y)$，$a=\\ell_m^2$，$b=\\nu$，$c=-u_\\tau^2(1-y/\\delta)$。其解由二次公式给出：\n$$\ng(y) = \\frac{-\\nu \\pm \\sqrt{\\nu^2 - 4(\\ell_m^2)\\left[-u_\\tau^2\\left(1 - \\frac{y}{\\delta}\\right)\\right]}}{2\\ell_m^2} = \\frac{-\\nu \\pm \\sqrt{\\nu^2 + 4\\ell_m^2 u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right)}}{2\\ell_m^2}\n$$\n由于速度从壁面到中心线是增加的，梯度 $g(y)$ 必须是非负的。平方根下的项总是大于或等于 $\\sqrt{\\nu^2}=|\\nu|=\\nu$。因此，为确保 $g(y) \\ge 0$，我们必须选择正号。物理上可接受的根是：\n$$\ng(y) = \\frac{-\\nu + \\sqrt{\\nu^2 + 4\\ell_m^2 u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right)}}{2\\ell_m^2}\n$$\n此关系在 $y>0$ 时有效。在壁面处，$y=0$，混合长度 $\\ell_m$ 为零。在此极限下，二次方程简化为 $\\nu g(0) - u_\\tau^2 = 0$，得出 $g(0) = u_\\tau^2/\\nu$。在中心线处，$y=\\delta$，项 $(1-y/\\delta)$ 为零，导致 $g(\\delta) = (-\\nu + \\sqrt{\\nu^2})/(2\\ell_m^2) = 0$，正确地再现了由对称性导致的零斜率条件。混合长度 $\\ell_m$ 本身由 van Driest 阻尼模型给出：\n$$\n\\ell_m(y) = \\kappa y \\left[1 - \\exp\\left(-\\frac{y^+}{A^+}\\right)\\right]\n$$\n其中 $y^+ = yu_\\tau/\\nu$ 是以粘性壁面单位表示的壁面法向坐标，$\\kappa$ 是 von Kármán 常数， $A^+$ 是 van Driest 阻尼常数。\n\n数值解的获取首先需要将半槽道高度 $y \\in [0, \\delta]$ 离散化为一个包含 $N$ 个点的均匀网格，$y_i = i \\cdot \\Delta y$ for $i=0, \\dots, N-1$，网格间距为 $\\Delta y = \\delta/(N-1)$。在每个网格点上，使用推导出的公式计算速度梯度 $g(y_i)$，并处理 $y_0=0$ 处的特殊情况。\n然后，通过对 $g(y)$ 从壁面开始进行数值积分来找到平均速度剖面 $U(y)$，并满足无滑移边界条件 $U(0)=0$。我们采用二阶精度的梯形法则：\n$$\nU(y_{i+1}) = U(y_i) + \\frac{\\Delta y}{2}[g(y_i) + g(y_{i+1})], \\quad \\text{for } i=0, \\dots, N-2\n$$\n为提高效率，这可以实现为累积和。\n\n计算出 $U(y)$ 后，将剖面无量纲化为壁面单位：无量纲速度为 $U^+ = U/u_\\tau$，无量纲距离为 $y^+ = yu_\\tau/\\nu$。\n将计算出的剖面 $U^+(y^+)$ 与对数区的壁面律理论形式进行比较：\n$$\nU^+_{\\log}(y^+) = \\frac{1}{\\kappa}\\ln y^+ + B\n$$\n其中 $B$ 是对数律截距常数。偏差通过均方根 (RMS) 误差来量化，该误差在区间 $y^+ \\in [30, 0.3 Re_\\tau]$ 上计算，其中 $Re_\\tau = u_\\tau \\delta / \\nu$ 是摩擦雷诺数。如果此区间包含 $M$ 个由集合 $J$ 索引的网格点，则 RMS 误差为：\n$$\n\\text{Error}_{\\text{RMS}} = \\sqrt{\\frac{1}{M}\\sum_{i \\in J} \\left[U^+(y^+_i) - U^+_{\\log}(y^+_i)\\right]^2}\n$$\n对于网格未覆盖此区间的情况（即没有网格点落入其中），问题规定在最接近 $y^+=30$ 的单个网格点 $y^+_k$ 处计算绝对差 $|U^+(y^+_k) - U^+_{\\log}(y^+_k)|$。然后将此值报告为该情况的误差。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the turbulent mean velocity profile in a plane channel using a mixing length model\n    and compares it to the law of the wall to find the RMS error.\n    \"\"\"\n    # Physical and model constants\n    NU = 1.5e-5  # Kinematic viscosity (m^2/s)\n    DELTA = 0.05  # Channel half-height (m)\n    KAPPA = 0.41  # von Kármán constant\n    B = 5.2       # Log-law intercept\n    A_PLUS = 26.0 # van Driest damping constant\n\n    # Test cases: (Re_tau, N)\n    test_cases = [\n        (180, 1500),\n        (395, 2000),\n        (1000, 4000),\n        (90, 1500),\n    ]\n\n    results = []\n    \n    for Re_tau, N in test_cases:\n        # 1. Setup grid and flow parameters\n        u_tau = Re_tau * NU / DELTA\n        dy = DELTA / (N - 1)\n        y = np.linspace(0, DELTA, N, dtype=np.float64)\n        y_plus = y * u_tau / NU\n\n        # 2. Compute the mean velocity gradient g(y) = dU/dy\n        g = np.zeros(N, dtype=np.float64)\n\n        # At the wall (y=0), lm=0, the quadratic equation for g simplifies\n        g[0] = u_tau**2 / NU\n\n        # For y > 0\n        y_slice = y[1:]\n        y_plus_slice = y_plus[1:]\n        \n        # Mixing length with van Driest damping\n        lm = KAPPA * y_slice * (1.0 - np.exp(-y_plus_slice / A_PLUS))\n        \n        # Solve the quadratic equation for g(y): lm^2 * g^2 + nu * g - C = 0\n        # where C = u_tau^2 * (1 - y/delta)\n        # We use the positive root for g.\n        c_term = u_tau**2 * (1.0 - y_slice / DELTA)\n        discriminant = NU**2 + 4.0 * lm**2 * c_term\n        g[1:] = (-NU + np.sqrt(discriminant)) / (2.0 * lm**2)\n\n        # 3. Integrate g(y) to get U(y) using the trapezoidal rule\n        U = np.zeros(N, dtype=np.float64)\n        # U(0)=0 due to no-slip condition.\n        # U[i+1] = U[i] + 0.5 * dy * (g[i] + g[i+1])\n        # This is equivalent to a cumulative sum of the trapezoidal areas.\n        integrand = 0.5 * dy * (g[:-1] + g[1:])\n        U[1:] = np.cumsum(integrand)\n\n        # 4. Non-dimensionalize velocity\n        U_plus = U / u_tau\n\n        # 5. Compare with log law and compute RMS error\n        log_layer_start = 30.0\n        log_layer_end = 0.3 * Re_tau\n\n        # Find points within the logarithmic layer\n        log_mask = (y_plus >= log_layer_start) & (y_plus <= log_layer_end)\n        \n        num_points_in_log_layer = np.sum(log_mask)\n\n        if num_points_in_log_layer > 0:\n            # Normal case: compute RMS error over the log-layer points\n            y_plus_log = y_plus[log_mask]\n            U_plus_log = U_plus[log_mask]\n            \n            U_log_analytic = (1.0 / KAPPA) * np.log(y_plus_log) + B\n            \n            error = np.sqrt(np.mean((U_plus_log - U_log_analytic)**2))\n        else:\n            # Edge case: no grid points in the log layer interval\n            # Find the single grid point closest to y+=30\n            # Note: y_plus[0] is 0. Exclude it to avoid issues with log(0) and to ensure\n            # the search is in the physically relevant region. The closest point will not be y=0.\n            idx_closest = np.argmin(np.abs(y_plus[1:] - log_layer_start)) + 1\n            \n            y_p_eval = y_plus[idx_closest]\n            U_p_eval = U_plus[idx_closest]\n            \n            U_log_analytic_eval = (1.0 / KAPPA) * np.log(y_p_eval) + B\n            \n            error = np.abs(U_p_eval - U_log_analytic_eval)\n\n        results.append(error)\n\n    # Format output as specified\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2381390"}]}