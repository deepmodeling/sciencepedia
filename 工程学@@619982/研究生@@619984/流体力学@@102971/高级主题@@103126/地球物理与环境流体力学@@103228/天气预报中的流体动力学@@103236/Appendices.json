{"hands_on_practices": [{"introduction": "现代天气预报的起点是数据同化，一个将零散的观测数据与之前的预报模型相结合，以创建大气当前状态的最佳估计（即“分析场”）的过程。由于观测数据的不完整性，我们需要利用统计模型来描述预报误差的空间结构。这个实践将地转平衡这一基本动力学约束与统计方法相结合，让你亲手推导位势高度场和风场误差之间的协方差关系，这是构建多变量背景误差协方差矩阵的关键一步 [@problem_id:516520]。", "problem": "在气象数据同化中，统计模型被用来描述预报误差的空间结构。不同物理变量的误差之间的关系受大气运动控制方程的约束。对于中纬度地区的大尺度、缓慢演变的天气系统，地转平衡提供了质量场（由位势高度 $Z$ 表示）与风场之间的基本联系。\n\n考虑一个二维水平域 $(x, y)$，其中大气流动处于地转平衡状态。地转纬向风（东西分量）$u_g$ 与位势高度 $Z$ 之间的关系由以下方程给出：\n$$\nu_g = -\\frac{g}{f_0} \\frac{\\partial Z}{\\partial y}\n$$\n其中 $g$ 是重力加速度，$f_0$ 是科里奥利参数（假定为常数），$y$ 是向北的坐标。\n\n位势高度的预报误差，或称扰动，记为 $Z'$，被假定为统计上是均匀和各向同性的。描述两点 $\\mathbf{r}_1 = (x_1, y_1)$ 和 $\\mathbf{r}_2 = (x_2, y_2)$ 之间 $Z'$ 相关性的自协方差函数，由一个高斯模型给出：\n$$\nC_{ZZ}(\\mathbf{r}_1, \\mathbf{r}_2) = \\langle Z'(\\mathbf{r}_1) Z'(\\mathbf{r}_2) \\rangle = \\sigma_Z^2 \\exp\\left(-\\frac{(\\Delta x)^2 + (\\Delta y)^2}{2L^2}\\right)\n$$\n其中 $\\Delta x = x_2 - x_1$ 且 $\\Delta y = y_2 - y_1$。这里，$\\sigma_Z^2$ 是位势高度误差的方差，$L$ 是相关长度尺度，$\\langle \\cdot \\rangle$ 表示统计期望算子。\n\n假设扰动量 $u_g'$ 和 $Z'$ 本身通过地转近似相关，请推导在点 $\\mathbf{r}_1$ 的位势高度扰动与在点 $\\mathbf{r}_2$ 的地转纬向风扰动之间的互协方差函数，其定义为 $C_{Zu_g}(\\mathbf{r}_1, \\mathbf{r}_2) = \\langle Z'(\\mathbf{r}_1) u_g'(\\mathbf{r}_2) \\rangle$。请将结果表示为分离坐标 $\\Delta x$ 和 $\\Delta y$ 以及参数 $g, f_0, \\sigma_Z$ 和 $L$ 的函数。", "solution": "1. 扰动的地转关系：\n$$u_g'(\\mathbf r_2)=-\\frac{g}{f_0}\\,\\frac{\\partial Z'(\\mathbf r_2)}{\\partial y_2}.$$\n2. 互协方差的定义：\n$$C_{Zu_g}(\\mathbf r_1,\\mathbf r_2)=\\langle Z'(\\mathbf r_1)\\,u_g'(\\mathbf r_2)\\rangle.$$\n代入 $u_g'$：\n$$C_{Zu_g}(\\mathbf r_1,\\mathbf r_2)\n=-\\frac{g}{f_0}\\,\\Bigl\\langle Z'(\\mathbf r_1)\\,\\frac{\\partial Z'(\\mathbf r_2)}{\\partial y_2}\\Bigr\\rangle.$$\n3. 使用均匀性/各向同性：$C_{ZZ}(\\mathbf r_1,\\mathbf r_2)=C_{ZZ}(\\Delta x,\\Delta y)$，其形式为\n$$C_{ZZ}(\\Delta x,\\Delta y)=\\sigma_Z^2\\exp\\Bigl(-\\frac{\\Delta x^2+\\Delta y^2}{2L^2}\\Bigr).$$\n于是\n$$\\langle Z'(\\mathbf r_1)\\,\\partial_{y_2}Z'(\\mathbf r_2)\\rangle\n=\\frac{\\partial}{\\partial y_2}C_{ZZ}(\\Delta x,\\Delta y)\n=\\frac{\\partial}{\\partial(\\Delta y)}C_{ZZ}(\\Delta x,\\Delta y).$$\n4. 求导：\n$$\\frac{\\partial}{\\partial(\\Delta y)}\n\\exp\\Bigl(-\\frac{\\Delta x^2+\\Delta y^2}{2L^2}\\Bigr)\n=-\\frac{\\Delta y}{L^2}\\exp\\Bigl(-\\frac{\\Delta x^2+\\Delta y^2}{2L^2}\\Bigr).$$\n5. 组合各项因子：\n$$C_{Zu_g}(\\Delta x,\\Delta y)\n=-\\frac{g}{f_0}\\,\\sigma_Z^2\\Bigl(-\\frac{\\Delta y}{L^2}\\Bigr)\n\\exp\\Bigl(-\\frac{\\Delta x^2+\\Delta y^2}{2L^2}\\Bigr)\n=\\frac{g\\,\\sigma_Z^2\\,\\Delta y}{f_0\\,L^2}\n\\exp\\Bigl(-\\frac{\\Delta x^2+\\Delta y^2}{2L^2}\\Bigr).$$", "answer": "$$\\boxed{\\frac{g\\,\\sigma_Z^2\\,\\Delta y}{f_0\\,L^2}\\exp\\Bigl(-\\frac{(\\Delta x)^2+(\\Delta y)^2}{2L^2}\\Bigr)}$$", "id": "516520"}, {"introduction": "在获得了初始场之后，数值模型便开始向前积分，预测大气的未来状态。然而，初始场可能并非完全处于完美的平衡状态。这个实践通过一个经典的“地转适应”思想实验，揭示了当流体中的质量场和速度场出现不平衡时，系统将如何自发地调整并最终达到地转平衡状态 [@problem_id:516491]。通过分析这个过程中能量的重新分配，你将深入理解为何大部分能量被锁定在准地转的、缓慢演变的天气系统中，而另一部分则以惯性重力波的形式耗散掉。", "problem": "考虑一个 f-平面上的一维流体系统，该系统由线性化浅水方程控制。流体的平均深度为 $H$，初始时处于静止状态，即纬向速度 $u(x,0)=0$ 和经向速度 $v(x,0)=0$。初始状态的特征是自由面高度存在一个阶跃函数扰动，$h(x,0) = -h_0 \\operatorname{sgn}(x)$，其中 $h_0$ 是一个正常数振幅，$\\operatorname{sgn}(x)$ 是符号函数。这个初始状态对应于一个“溃坝”情景，在 $x<0$ 处流体水位较高，在 $x>0$ 处较低。\n\n控制方程为：\n$$\n\\frac{\\partial u}{\\partial t} - fv = -g \\frac{\\partial h}{\\partial x}\n$$\n$$\n\\frac{\\partial v}{\\partial t} + fu = 0\n$$\n$$\n\\frac{\\partial h}{\\partial t} + H \\frac{\\partial u}{\\partial x} = 0\n$$\n这里，$f$ 是常数科里奥利参数，$g$ 是重力加速度。\n\n初始扰动释放后，系统经历一个地转适应过程。部分初始能量通过惯性-重力波辐射到无穷远处，系统演化到一个由纯地转流 $(u_f, v_f)$ 和相应的高度场 $h_f(x)$ 表征的稳态最终状态。\n\n流的总动能由 $KE = \\int_{-\\infty}^{\\infty} \\frac{1}{2} H (u^2 + v^2) \\,dx$ 给出。与高度扰动相关的有效势能 (APE) 为 $APE = \\int_{-\\infty}^{\\infty} \\frac{1}{2} g h^2 \\,dx$。尽管对于给定的阶跃函数廓线，初始有效势能是无穷大的，但在适应过程中*释放*的势能是一个有限量，定义为 $\\Delta APE = APE_i - APE_f = \\frac{g}{2}\\int_{-\\infty}^{\\infty} \\left(h(x,0)^2 - h_f(x)^2\\right) dx$。\n\n推导最终动能 $KE_f$ 与释放的有效势能 $\\Delta APE$ 的比值的精确值。", "solution": "我们要求解比值\n$$\n\\frac{KE_f}{\\Delta APE}.\n$$\n\n1.  地转最终状态：在最终的稳态下，时间导数 $\\partial/\\partial t=0$。控制方程简化为 $-fv_f = -g \\partial_x h_f$ 和 $fu_f=0$。由此我们得到 $u_f=0$ 和 $fv_f = g \\partial_x h_f$。\n\n2.  平衡高度场 $h_f$ 是初始阶跃 $h_i(x)= -h_0\\sgn(x)$ 与 Helmholtz 格林函数 $G(x)=\\tfrac1{2R_d}e^{-|x|/R_d}$ 的卷积，其中 $R_d=\\sqrt{gH}/f$。可得\n$$\nh_f(x)=-h_0\\sgn(x)\\bigl(1-e^{-|x|/R_d}\\bigr).\n$$\n\n3.  根据地转关系\n$$\nv_f=\\frac g f\\,\\partial_x h_f\n=\\frac{g\\,h_0}{f\\,R_d}\\,\\sgn(x)\\,e^{-|x|/R_d}\n=\\frac{c\\,h_0}{H}\\,\\sgn(x)\\,e^{-|x|/R_d},\n\\quad c=\\sqrt{gH}.\n$$\n\n4.  最终动能：\n$$\nKE_f\n=\\frac12H\\int_{-\\infty}^{\\infty}v_f^2\\,dx\n=\\frac12H\\int_{-\\infty}^{\\infty}\n\\Bigl(\\frac{c\\,h_0}{H}\\Bigr)^2e^{-2|x|/R_d}\\,dx\n=\\frac12\\,\\frac{c^2}{H}\\,h_0^2\n\\int_{-\\infty}^{\\infty}e^{-2|x|/R_d}dx\n=\\frac12\\,g\\,h_0^2\\,R_d.\n$$\n\n5.  释放的有效势能：\n$$\n\\Delta APE\n=\\frac g2\\int\\bigl(h_i^2-h_f^2\\bigr)dx\n=\\frac g2\\,h_0^2\\int\\bigl[1-(1-e^{-|x|/R_d})^2\\bigr]dx\n=\\frac g2\\,h_0^2\\,(3R_d)\n=\\frac32\\,g\\,h_0^2\\,R_d.\n$$\n\n6.  比值：\n$$\n\\frac{KE_f}{\\Delta APE}\n=\\frac{\\tfrac12\\,g\\,h_0^2\\,R_d}{\\tfrac32\\,g\\,h_0^2\\,R_d}\n=\\frac13.\n$$", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "516491"}, {"introduction": "天气预报模型的核心是将流体力学和热力学的连续方程，转化为计算机可以求解的离散方程。然而，从连续到离散的转变并非没有风险，数值不稳定性是每个模型开发者都必须面对的挑战。这个实践将带领你分析一个最简单的平流过程的数值格式，并运用冯·诺依曼稳定性分析方法，来确定保证计算结果不会出现爆炸性增长的条件 [@problem_id:516477]。这为你揭示了时间步长、空间网格和物理速度之间必须满足的深刻联系，即著名的Courant-Friedrichs-Lewy (CFL)条件的雏形。", "problem": "在数值天气预报中，像位温或湿度这类量的平流是一个基本过程。一个简单的模型是一维线性平流方程：\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\n其中 $u(x, t)$ 是平流的物理量，$c$ 是一个恒定的正平流速度 ($c > 0$)。\n\n为了数值求解该方程，我们在空间上以均匀间距 $\\Delta x$、时间上以均匀间距 $\\Delta t$ 的网格上对其进行离散化。令 $U_j^n$ 代表 $u(j\\Delta x, n\\Delta t)$ 的数值近似。一种常见的显式格式是一阶迎风、时间向前差分法。对于 $c > 0$，“迎风”意味着空间导数是使用来自“上风”方向（即水流来源的方向）的值来近似的，也就是左侧。该格式由下式给出：\n$$\n\\frac{U_j^{n+1} - U_j^n}{\\Delta t} + c \\frac{U_j^n - U_{j-1}^n}{\\Delta x} = 0\n$$\n\n这种格式的稳定性可以使用 von Neumann 方法进行分析。这涉及到检验形如 $U_j^n = \\hat{U}(k)^n e^{i k j \\Delta x}$ 的单个傅里叶模式的放大情况，其中 $k$ 是波数，$\\hat{U}(k)^n$ 是时间步 $n$ 的振幅。振幅根据 $\\hat{U}(k)^{n+1} = G(k) \\hat{U}(k)^n$ 演化，其中 $G(k)$ 是每个时间步的复放大因子。为了使格式稳定，对于所有先验可能的波数 $k$，放大因子的模必须满足 $|G(k)| \\le 1$。\n\n网格上可以表示的最短波长是 $\\lambda_{min} = 2 \\Delta x$，它对应于相邻网格点之间的“锯齿”模式。\n\n推导与此最短可分辨波长 $\\lambda_{min} = 2 \\Delta x$ 对应的傅里叶模式的复放大因子 $G$ 的表达式。用 Courant 数 $\\sigma = \\frac{c \\Delta t}{\\Delta x}$ 表示您的答案。", "solution": "推导从所提供的一阶迎风、时间向前差分格式的有限差分方程开始：\n$$\n\\frac{U_j^{n+1} - U_j^n}{\\Delta t} + c \\frac{U_j^n - U_{j-1}^n}{\\Delta x} = 0\n$$\n\n首先，我们求解下一个时间步的值 $U_j^{n+1}$：\n$$\nU_j^{n+1} = U_j^n - \\frac{c \\Delta t}{\\Delta x} (U_j^n - U_{j-1}^n)\n$$\n\n我们引入 Courant 数，$\\sigma = \\frac{c \\Delta t}{\\Delta x}$。方程变为：\n$$\nU_j^{n+1} = U_j^n - \\sigma (U_j^n - U_{j-1}^n)\n$$\n$$\nU_j^{n+1} = (1 - \\sigma) U_j^n + \\sigma U_{j-1}^n\n$$\n\n接下来，我们应用 von Neumann 稳定性分析。我们将形如 $U_j^n = G^n e^{i k j \\Delta x}$ 的单个傅里叶模式解代入离散方程。请注意，我们可以使用 $G^n$ 作为随时间变化的振幅部分，因为它就是我们要求的放大因子。\n$$\nG^{n+1} e^{i k j \\Delta x} = (1 - \\sigma) G^n e^{i k j \\Delta x} + \\sigma G^n e^{i k (j-1) \\Delta x}\n$$\n\n为了找到放大因子 $G$，我们可以将整个方程除以 $G^n e^{i k j \\Delta x}$（假设它非零）：\n$$\nG = (1 - \\sigma) + \\sigma \\frac{e^{i k j \\Delta x} e^{-i k \\Delta x}}{e^{i k j \\Delta x}}\n$$\n$$\nG = 1 - \\sigma + \\sigma e^{-i k \\Delta x}\n$$\n这是放大因子 $G$ 作为波数 $k$ 的函数的一般表达式。\n\n题目要求的是网格上最短可分辨波长 $\\lambda_{min} = 2 \\Delta x$ 所对应的 $G$ 的特定值。与此波长对应的波数 $k$ 是：\n$$\nk = \\frac{2\\pi}{\\lambda_{min}} = \\frac{2\\pi}{2 \\Delta x} = \\frac{\\pi}{\\Delta x}\n$$\n\n现在，我们计算出现在 $G$ 表达式中复指数相位里的项 $k \\Delta x$：\n$$\nk \\Delta x = \\left(\\frac{\\pi}{\\Delta x}\\right) \\Delta x = \\pi\n$$\n\n将这个值代入 $G$ 的表达式中：\n$$\nG = 1 - \\sigma + \\sigma e^{-i \\pi}\n$$\n\n使用欧拉公式，$e^{-i\\pi} = \\cos(-\\pi) + i\\sin(-\\pi) = \\cos(\\pi) - i\\sin(\\pi) = -1$。\n$$\nG = 1 - \\sigma + \\sigma(-1)\n$$\n$$\nG = 1 - \\sigma - \\sigma\n$$\n$$\nG = 1 - 2\\sigma\n$$\n\n因此，具有最短可分辨波长的傅里叶模式的放大因子是 $1 - 2\\sigma$。", "answer": "$$\n\\boxed{1 - 2\\sigma}\n$$", "id": "516477"}]}