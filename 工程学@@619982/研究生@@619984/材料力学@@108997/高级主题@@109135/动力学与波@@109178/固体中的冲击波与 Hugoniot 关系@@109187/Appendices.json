{"hands_on_practices": [{"introduction": "冲击波分析的基石是代表质量、动量和能量守恒的朗金-雨贡纽关系。本练习将提供直接应用这些基本方程的机会，利用实验测量的冲击波速度 $U_s$ 和粒子速度 $u_p$ 来确定材料在冲击波后的状态（密度和压力）。这是冲击物理学中的一项基础计算技能。[@problem_id:2917190]", "problem": "一道平面定常冲击波传播到一种初始无应力、静止的晶体金属中，其初始质量密度为 $\\rho_0=2700 \\, \\mathrm{kg/m^3}$，初始压力为 $P_0=0$。测得的冲击波速度和粒子速度分别为 $U_s=6.4 \\, \\mathrm{km/s}$ 和 $u_p=1.0 \\, \\mathrm{km/s}$。从与冲击波前重合的静止控制面上的质量守恒和动量守恒（即从平衡律的积分形式得到的朗金-雨贡纽跳跃条件）出发，推导确定冲击波后方的压缩态密度 $\\rho_1$ 和压力 $P_1$ 所需的关系式。然后计算比容变化 $\\Delta v$，其定义为 $\\Delta v \\equiv v_1-v_0$，其中 $v_1=1/\\rho_1$ 且 $v_0=1/\\rho_0$。\n\n在整个计算过程中使用物理上一致的单位，将速度转换为 $\\mathrm{m/s}$。最终压力以吉帕斯卡 (GPa) 为单位，密度以 $\\mathrm{kg/m^3}$ 为单位，比容变化以 $\\mathrm{m^3/kg}$ 为单位表示。所有数值结果保留 $4$ 位有效数字。将最终数值结果以单个有序三元组 $(\\rho_1, P_1, \\Delta v)$ 的形式报告，其中 $P_1$ 的单位为吉帕斯卡 (GPa)。", "solution": "相应的基本原理是均匀固体中一维、平面、定常冲击波的质量和动量守恒，这些守恒律是在冲击波静止的坐标系中写出的。令状态 $0$ 表示上游（初始）状态，状态 $1$ 表示下游（冲击后）状态。在冲击波固定坐标系中，上游材料以速度 $u_0=U_s$ 流入冲击区，下游材料以速度 $u_1=U_s-u_p$ 流出。\n\n跨越冲击波的质量守恒给出\n$$\n\\rho_0 u_0 = \\rho_1 u_1,\n$$\n即，\n$$\n\\rho_0 U_s = \\rho_1 (U_s - u_p).\n$$\n解出冲击后密度 $\\rho_1$，\n$$\n\\rho_1 = \\rho_0 \\frac{U_s}{U_s - u_p}.\n$$\n\n跨越冲击波的线性动量守恒表明，动量通量加压力是连续的：\n$$\nP_1 + \\rho_1 u_1^2 = P_0 + \\rho_0 u_0^2.\n$$\n代入 $u_0=U_s$ 和 $u_1=U_s-u_p$，并利用质量跳跃关系消去 $\\rho_1$，可以得到标准的朗金-雨贡纽压力关系\n$$\nP_1 - P_0 = \\rho_0 U_s u_p.\n$$\n当 $P_0=0$ 时，此式简化为\n$$\nP_1 = \\rho_0 U_s u_p.\n$$\n\n比容分别为 $v_0=1/\\rho_0$ 和 $v_1=1/\\rho_1$，所以比容变化为\n$$\n\\Delta v = v_1 - v_0 = \\frac{1}{\\rho_1} - \\frac{1}{\\rho_0}.\n$$\n\n现在代入给定的数据，将其转换为一致的单位。将速度转换为 $\\mathrm{m/s}$：\n$$\nU_s = 6.4 \\times 10^3 \\, \\mathrm{m/s}, \\qquad u_p = 1.0 \\times 10^3 \\, \\mathrm{m/s}.\n$$\n计算冲击后密度：\n$$\n\\rho_1 = \\rho_0 \\frac{U_s}{U_s - u_p} = 2700 \\, \\mathrm{kg/m^3} \\times \\frac{6.4\\times 10^3}{6.4\\times 10^3 - 1.0\\times 10^3} = 2700 \\times \\frac{6400}{5400} \\, \\mathrm{kg/m^3}.\n$$\n由于 $\\frac{6400}{5400}=\\frac{32}{27}$，可得\n$$\n\\rho_1 = 2700 \\times \\frac{32}{27} = 3200 \\, \\mathrm{kg/m^3}.\n$$\n\n计算冲击后压力：\n$$\nP_1 = \\rho_0 U_s u_p = (2700 \\, \\mathrm{kg/m^3}) (6.4\\times 10^3 \\, \\mathrm{m/s}) (1.0\\times 10^3 \\, \\mathrm{m/s}).\n$$\n乘积为\n$$\nP_1 = 17.28\\times 10^9 \\, \\mathrm{Pa} = 17.28 \\, \\mathrm{GPa}.\n$$\n\n计算比容变化：\n$$\nv_0=\\frac{1}{\\rho_0}=\\frac{1}{2700} \\, \\mathrm{m^3/kg}, \\qquad v_1=\\frac{1}{\\rho_1}=\\frac{1}{3200} \\, \\mathrm{m^3/kg},\n$$\n所以\n$$\n\\Delta v = \\frac{1}{3200} - \\frac{1}{2700} = \\frac{2700-3200}{2700\\times 3200} \\, \\mathrm{m^3/kg}=-\\frac{500}{8.64\\times 10^6} \\, \\mathrm{m^3/kg}.\n$$\n数值上，\n$$\n\\Delta v \\approx -5.787037\\ldots\\times 10^{-5} \\, \\mathrm{m^3/kg}.\n$$\n\n保留 $4$ 位有效数字，并用所要求的单位表示各物理量，\n$$\n\\rho_1 = 3.200 \\times 10^3 \\, \\mathrm{kg/m^3}, \\qquad P_1 = 17.28 \\, \\mathrm{GPa}, \\qquad \\Delta v = -5.787 \\times 10^{-5} \\, \\mathrm{m^3/kg}.\n$$\n\n因此，有序三元组 $(\\rho_1, P_1, \\Delta v)$ 如上所示，其中 $P_1$ 的单位为吉帕斯卡 (GPa)。", "answer": "$$\\boxed{\\begin{pmatrix}3.200\\times 10^{3} & 17.28 & -5.787\\times 10^{-5}\\end{pmatrix}}$$", "id": "2917190"}, {"introduction": "虽然冲击波本质上是高度非线性的，但其在小振幅极限下的行为构成了连接非线性动力学与线性声学的桥梁。本练习将探讨经验性的 $U_s-u_p$ 关系与材料固有弹性特性（特别是体积模量）之间的关键联系。通过分析零粒子速度下的截距 $c_0$，您将学习如何从动态冲击实验中提取准静态材料参数。[@problem_id:2917217]", "problem": "一个致密的、各向同性的多晶固体，在其环境、无应力状态下，参考质量密度为 $\\rho_0 = 2.70 \\times 10^3\\ \\mathrm{kg/m^3}$。平面撞击实验产生的主雨贡纽线可以很好地用一个线性冲击波速度-粒子速度关系式 $U_s = c_0 + s\\,u_p$ 来表示，其中测量参数为 $c_0 = 5.2\\ \\mathrm{km/s}$ 和 $s = 1.3$。考虑进入初始无应力材料的一维冲击波，并假设绝热条件适用于高速率加载。\n\n仅使用跨越稳态平面冲击波前的质量和动量守恒，以及无穷小应变的线性弹性模量定义，完成以下任务：\n\n1. 从兰金-雨贡纽跳跃关系（质量和动量）出发，取小振幅极限 $u_p \\to 0$，并确定截距 $c_0$ 在固体中代表何种物理波速。据此，推导出以 $\\rho_0$ 和 $c_0$ 表示的小应变绝热体积模量 $K$ 的表达式。\n\n2. 使用给定数据数值计算体积模量。最终模量以吉帕斯卡（GPa）为单位表示，并将答案四舍五入至三位有效数字。\n\n3. 使用各向同性固体的线性弹性理论，简要论证有限剪切模量 $\\mu$ 的存在如何影响在小应变极限下对纵波波速与体波波速的解释。以符号形式写出如果错误地将 $c_0$ 等同于线弹性固体的纵波波速，所能得到的 $K$ 的替代表达式。此替代表达式无需进行数值计算。\n\n最终数值答案以吉帕斯卡为单位给出体积模量，并四舍五入至三位有效数字。", "solution": "所提出的问题是材料力学中的一个标准练习，具体涉及冲击波的非线性动力学与线性弹性理论之间的联系。该问题是适定的，有科学依据，并为获得唯一解提供了足够的信息。因此，我们着手进行分析。\n\n分析基于稳态一维平面冲击波的兰金-雨贡纽跳跃条件。设冲击波以速度 $U_s$ 传播进入一个静止材料，该材料处于参考状态，其密度为 $\\rho_0$，压力为 $p_0$，粒子速度为 $u_0 = 0$。问题指出材料初始无应力，因此初始纵向应力 $\\sigma_{xx,0}$ 为零。冲击波后的状态由密度 $\\rho$、纵向应力 $\\sigma_{xx}$ 和粒子速度 $u_p$ 描述。\n\n跨越冲击波前的质量和动量守恒由下式给出：\n$$ \\rho_0 U_s = \\rho (U_s - u_p) \\quad \\text{(质量)} $$\n$$ \\sigma_{xx} - \\sigma_{xx,0} = \\rho_0 U_s (u_p - u_0) \\quad \\text{(动量)} $$\n在初始条件 $\\sigma_{xx,0} = 0$ 和 $u_0 = 0$下，动量方程简化为：\n$$ \\sigma_{xx} = \\rho_0 U_s u_p $$\n\n问题提供了一个冲击波速度 $U_s$ 和粒子速度 $u_p$ 之间的经验线性关系：\n$$ U_s = c_0 + s u_p $$\n其中 $c_0$ 和 $s$ 是材料常数。\n\n**第 1 部分：$c_0$ 的识别与体积模量 $K$ 的推导**\n\n我们被要求考虑小振幅极限，即 $u_p \\to 0$。在此极限下，经验关系表明冲击波速度趋近于截距值：\n$$ \\lim_{u_p \\to 0} U_s = c_0 $$\n根据定义，无穷小振幅的冲击波即为声波。因此，$c_0$ 代表材料在零压条件下的声波速度。\n\n为了推导体积模量 $K$ 的表达式，我们必须将应力与应变联系起来。跨越冲击波的纵向应变为 $\\epsilon_{xx} = 1 - \\frac{\\rho_0}{\\rho}$。从质量守恒方程，我们发现 $\\frac{\\rho_0}{\\rho} = \\frac{U_s - u_p}{U_s} = 1 - \\frac{u_p}{U_s}$。因此，纵向应变为：\n$$ \\epsilon_{xx} = \\frac{u_p}{U_s} $$\n\n在冲击物理学的背景下，尤其是在高压下，一个常用且有用的近似是将纵向应力 $\\sigma_{xx}$ 等同于静水压力 $P$。这就是流体动力学近似，其中应力的偏量（剪切）分量与平均应力相比被认为是可忽略的。采用此近似，我们有 $P \\approx \\sigma_{xx}$。体积应变 $\\theta$ 定义为 $\\theta = 1 - V/V_0 = 1 - \\rho_0/\\rho$，对于一维应变，它等于纵向应变，即 $\\theta=\\epsilon_{xx}$。\n\n绝热体积模量定义为 $K = -V \\left(\\frac{\\partial P}{\\partial V}\\right)_S$。用密度表示，即为 $K = \\rho \\left(\\frac{\\partial P}{\\partial \\rho}\\right)_S$。在小应变极限下，这可以写成 $K \\approx \\frac{\\Delta P}{\\Delta V/V_0} \\approx \\frac{P}{\\theta}$。\n我们将压力 $P$ 表示为体积应变 $\\theta$ 的函数：\n$$ P \\approx \\sigma_{xx} = \\rho_0 U_s u_p = \\rho_0 U_s^2 \\left(\\frac{u_p}{U_s}\\right) = \\rho_0 U_s^2 \\theta $$\n在零应变极限（$\\theta \\to 0$，对应于 $u_p \\to 0$）下，冲击波速度 $U_s$ 趋近于 $c_0$。压力-应变关系变为线性：\n$$ P \\approx \\rho_0 c_0^2 \\theta $$\n零压下的体积模量 $K_0$ 是压力-应变曲线在原点处的斜率：\n$$ K \\equiv K_0 = \\left.\\frac{dP}{d\\theta}\\right|_{\\theta=0} = \\rho_0 c_0^2 $$\n在此流体动力学近似下，参数 $c_0$ 被识别为零压体声速，通常记为 $c_B$，其中 $c_B = \\sqrt{K/\\rho_0}$。\n\n**第 2 部分：体积模量的数值计算**\n\n使用推导出的表达式和给定的数据，我们计算体积模量 $K$。\n给定的值为：\n$\\rho_0 = 2.70 \\times 10^3\\ \\mathrm{kg/m^3}$\n$c_0 = 5.2\\ \\mathrm{km/s} = 5.2 \\times 10^3\\ \\mathrm{m/s}$\n将这些值代入 $K$ 的公式：\n$$ K = (2.70 \\times 10^3\\ \\mathrm{kg/m^3}) \\times (5.2 \\times 10^3\\ \\mathrm{m/s})^2 $$\n$$ K = 2.70 \\times 10^3 \\times (5.2)^2 \\times 10^6\\ \\mathrm{kg/(m \\cdot s^2)} $$\n$$ K = 2.70 \\times 27.04 \\times 10^9\\ \\mathrm{Pa} $$\n$$ K = 73.008 \\times 10^9\\ \\mathrm{Pa} = 73.008\\ \\mathrm{GPa} $$\n按要求将结果四舍五入至三位有效数字：\n$$ K \\approx 73.0\\ \\mathrm{GPa} $$\n\n**第 3 部分：剪切模量的影响与替代表达式**\n\n第 1 部分的分析依赖于流体动力学近似，该近似忽略了材料的剪切刚度。各向同性线弹性固体由两个独立的模量来表征，例如体积模量 $K$ 和剪切模量 $\\mu$。这种固体支持两种类型的声波。\n1. 纵波（P波），其粒子运动方向与波传播方向平行。这些波涉及体积变形和剪切变形。其速度由 $c_L = \\sqrt{\\frac{K + \\frac{4}{3}\\mu}{\\rho_0}}$ 给出。\n2. 横波（S波），其粒子运动方向与波传播方向垂直。这些波只涉及剪切变形，并以速度 $c_S = \\sqrt{\\frac{\\mu}{\\rho_0}}$ 传播。\n\n平面冲击波会引起一维应变状态。在小振幅极限下，这变成了一维弹性波，即纵波。因此，对于固体，一个物理上更严格的解释是，实验测得的零振幅波速 $c_0$ 对应于纵波波速 $c_L$。\n有限剪切模量（$\\mu > 0$）的存在为单轴应变下的压缩提供了额外的阻力，这就是为什么纵向模量 $M = K + \\frac{4}{3}\\mu$ 大于体积模量 $K$ 的原因。因此，纵波波速 $c_L$ 总是大于体声速 $c_B = \\sqrt{K/\\rho_0}$（假设$\\mu>0$）。第 1 部分中将 $c_0$ 识别为 $c_B$ 的解释因此是一种简化，它仅对流体（$\\mu=0$）是精确的。\n\n问题接着要求写出将 $c_0$ 等同于纵波波速所得到的 $K$ 的替代表达式。尽管问题将这种方法标记为“不正确的”，但从纯粹弹性的角度来看，这是正确的识别。我们按要求进行：\n$$ c_0 = c_L = \\sqrt{\\frac{K + \\frac{4}{3}\\mu}{\\rho_0}} $$\n为了找到 $K$ 的表达式，我们重新整理此方程：\n$$ c_0^2 = \\frac{K + \\frac{4}{3}\\mu}{\\rho_0} $$\n$$ \\rho_0 c_0^2 = K + \\frac{4}{3}\\mu $$\n解出 $K$ 得到替代的符号表达式：\n$$ K = \\rho_0 c_0^2 - \\frac{4}{3}\\mu $$\n此表达式明确表明，如果考虑固体的剪切刚度，体积模量 $K$ 将小于根据流体动力学近似计算出的值 $\\rho_0 c_0^2$。这是一致的，因为 $\\rho_0 c_0^2$ 将代表纵向模量 $M = K + \\frac{4}{3}\\mu$。", "answer": "$$\n\\boxed{73.0}\n$$", "id": "2917217"}, {"introduction": "在实验科学中，理论模型必须与真实的、总包含噪声和不确定性的数据进行验证。这个高级实践解决了将线性 $U_s-u_p$ 模型拟合到具有不同测量误差的实验数据点这一关键任务。您将应用加权最小二乘法，不仅确定最佳拟合参数 $c_0$ 和 $s$，还将量化它们的统计置信区间，这是任何实验科学家都需掌握的核心技能。[@problem_id:2684944]", "problem": "给定各向同性固体中稳态平面冲击波的实验测量数据，其中冲击波速度 $U_s$ 和粒子速度 $u_p$ 通过一个经验线性关系相关联。该关系常用于参数化中等压力下的朗金-雨贡纽轨迹。假设主要测量不确定度存在于测量的冲击波速度 $U_s$ 中，而粒子速度 $u_p$ 在本次拟合中具有可忽略的不确定度。$U_s$ 的测量误差是独立的，且服从具有已知但不相等标准差的高斯分布，即存在异方差误差。\n\n从最小二乘法的定义、独立测量的高斯似然以及参数线性模型 $U_s = c_0 + s\\,u_p$ 出发，您必须在已知异方差的情况下推导出参数 $c_0$ 和 $s$ 的估计量，并计算相关的参数协方差矩阵。在测量方差精确已知且估计量服从高斯分布的假设下，使用此结果为 $c_0$ 和 $s$ 构建置信水平为 $0.95$ 的双边置信区间。解释权重矩阵在估计量中的作用，以及为什么它能正确处理异方差性。\n\n实现一个程序，将您的推导应用于以下测试套件。在每个测试案例中，给定粒子速度 $u_p$（单位：m/s）、冲击波速度 $U_s$（单位：m/s）的数组，以及 $U_s$ 测量值对应的标准差 $\\sigma_{U_s}$（单位：m/s）。对每个测试案例，使用加权最小二乘法拟合线性模型 $U_s = c_0 + s\\,u_p$，权重等于 $1/\\sigma_{U_s}^2$，并报告参数估计值及其 $0.95$ 置信区间。\n\n测试套件：\n- 案例1（良态，中等异方差性）：\n  - $u_p$（单位：m/s）：$[400, 800, 1200, 1600, 2000]$\n  - $U_s$（单位：m/s）：$[5893, 6416, 6962, 7480, 8041]$\n  - $\\sigma_{U_s}$（单位：m/s）：$[12, 14, 16, 18, 20]$\n- 案例2（边界情况，恰好两个数据点且不确定度不相等）：\n  - $u_p$（单位：m/s）：$[1000, 2500]$\n  - $U_s$（单位：m/s）：$[7112, 8884]$\n  - $\\sigma_{U_s}$（单位：m/s）：$[15, 35]$\n- 案例3（包含 $u_p = 0$ 以强力约束 $c_0$，且不确定度动态范围大）：\n  - $u_p$（单位：m/s）：$[0, 300, 900, 1800, 2400]$\n  - $U_s$（单位：m/s）：$[3810, 4363, 5527, 7211, 8340]$\n  - $\\sigma_{U_s}$（单位：m/s）：$[8, 12, 20, 26, 32]$\n\n数值报告要求：\n- 报告 $c_0$ 及其置信区间边界，单位为 m/s。\n- 报告 $s$ 及其置信区间边界，为无量纲量。\n- 使用基于尾部概率为 $0.025$ 的高斯分位数的双边置信水平 $0.95$。\n- 将所有报告的数值四舍五入到小数点后 $3$ 位。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果。每个测试案例的结果必须是 $[c_0, s, c_{0,\\mathrm{lower}}, c_{0,\\mathrm{upper}}, s_{\\mathrm{lower}}, s_{\\mathrm{upper}}]$ 形式的列表。因此，对于所有三个案例，最终输出必须是包含三个此类列表的列表，例如 $[[\\dots],[\\dots],[\\dots]]$。", "solution": "所提出的问题是有效的。它在科学上基于固体力学和统计数据分析的原理，特别是针对冲击波的线性雨贡纽关系以及用于处理异方差误差的参数估计的加权最小二乘法。该问题是适定的、客观的，并包含获得唯一且有意义解所需的所有信息。我们继续进行推导和实现。\n\n基本任务是将形式为 $U_s = c_0 + s\\,u_p$ 的线性模型拟合到一组 $N$ 个实验数据点 $(u_{p,i}, U_{s,i})$（其中 $i = 1, \\dots, N$）。假定冲击波速度的测量值 $U_{s,i}$ 是独立的，并受到均值为零、方差已知但不相等（$\\sigma_i^2 = \\sigma_{U_s, i}^2$）的高斯噪声的干扰。粒子速度 $u_{p,i}$ 被视为不确定度可忽略的已知自变量。\n\n我们可以用矩阵表示法来表达该模型。令 $\\boldsymbol{y}$ 为观测到的冲击波速度 $U_{s,i}$ 构成的 $N \\times 1$ 列向量，$\\boldsymbol{\\beta}$ 为待估计参数构成的 $2 \\times 1$ 列向量，$\\boldsymbol{\\beta} = [c_0, s]^T$，$\\boldsymbol{X}$ 为 $N \\times 2$ 的设计矩阵。该模型可写为：\n$$\n\\boldsymbol{y} = \\boldsymbol{X}\\boldsymbol{\\beta} + \\boldsymbol{\\epsilon}\n$$\n其中 $\\boldsymbol{\\epsilon}$ 是测量误差构成的 $N \\times 1$ 向量。这些向量和矩阵的分量为：\n$$\n\\boldsymbol{y} = \\begin{pmatrix} U_{s,1} \\\\ U_{s,2} \\\\ \\vdots \\\\ U_{s,N} \\end{pmatrix}, \\quad\n\\boldsymbol{X} = \\begin{pmatrix} 1 & u_{p,1} \\\\ 1 & u_{p,2} \\\\ \\vdots & \\vdots \\\\ 1 & u_{p,N} \\end{pmatrix}, \\quad\n\\boldsymbol{\\beta} = \\begin{pmatrix} c_0 \\\\ s \\end{pmatrix}, \\quad\n\\boldsymbol{\\epsilon} = \\begin{pmatrix} \\epsilon_1 \\\\ \\epsilon_2 \\\\ \\vdots \\\\ \\epsilon_N \\end{pmatrix}\n$$\n误差 $\\epsilon_i$ 是独立的，因此它们的协方差矩阵 $\\boldsymbol{\\Sigma}$ 是对角矩阵。误差的期望为 $E[\\boldsymbol{\\epsilon}] = \\boldsymbol{0}$，协方差由下式给出：\n$$\n\\boldsymbol{\\Sigma} = \\text{Cov}(\\boldsymbol{\\epsilon}) = E[\\boldsymbol{\\epsilon}\\boldsymbol{\\epsilon}^T] = \\begin{pmatrix} \\sigma_1^2 & 0 & \\dots & 0 \\\\ 0 & \\sigma_2^2 & \\dots & 0 \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ 0 & 0 & \\dots & \\sigma_N^2 \\end{pmatrix}\n$$\n问题在于求参数向量 $\\boldsymbol{\\beta}$ 的最佳估计，记为 $\\hat{\\boldsymbol{\\beta}}$。鉴于误差是高斯分布的，最优估计量可由最大似然原理推导得出。单个观测值 $y_i$ 的概率密度函数为：\n$$\np(y_i | u_{p,i}, \\boldsymbol{\\beta}, \\sigma_i) = \\frac{1}{\\sqrt{2\\pi\\sigma_i^2}} \\exp\\left(-\\frac{(y_i - (c_0 + s u_{p,i}))^2}{2\\sigma_i^2}\\right)\n$$\n由于各测量值是独立的，整个数据集 $\\boldsymbol{y}$ 的似然函数是各个概率的乘积：\n$$\nL(\\boldsymbol{\\beta}; \\boldsymbol{y}) = \\prod_{i=1}^{N} p(y_i) = \\prod_{i=1}^{N} \\frac{1}{\\sqrt{2\\pi\\sigma_i^2}} \\exp\\left(-\\frac{(y_i - (\\boldsymbol{X}\\boldsymbol{\\beta})_i)^2}{2\\sigma_i^2}\\right)\n$$\n最大化似然函数 $L$ 等价于最大化其对数，即对数似然函数 $\\ln L$：\n$$\n\\ln L(\\boldsymbol{\\beta}; \\boldsymbol{y}) = -\\frac{N}{2}\\ln(2\\pi) - \\frac{1}{2}\\sum_{i=1}^{N}\\ln(\\sigma_i^2) - \\frac{1}{2}\\sum_{i=1}^{N}\\frac{(y_i - (\\boldsymbol{X}\\boldsymbol{\\beta})_i)^2}{\\sigma_i^2}\n$$\n为了对 $\\boldsymbol{\\beta}$ 最大化 $\\ln L$，我们必须最小化加权残差平方和，通常记为 $\\chi^2$：\n$$\n\\chi^2(\\boldsymbol{\\beta}) = \\sum_{i=1}^{N}\\frac{(y_i - (\\boldsymbol{X}\\boldsymbol{\\beta})_i)^2}{\\sigma_i^2}\n$$\n这是加权最小二乘法 (WLS) 的核心准则。我们引入权重矩阵 $\\boldsymbol{W}$，其定义为误差协方差矩阵的逆：\n$$\n\\boldsymbol{W} = \\boldsymbol{\\Sigma}^{-1} = \\text{diag}\\left(\\frac{1}{\\sigma_1^2}, \\frac{1}{\\sigma_2^2}, \\dots, \\frac{1}{\\sigma_N^2}\\right)\n$$\n权重矩阵的作用是给予不确定度较小的测量值更大的重要性。每个残差平方 $(y_i - \\text{model}_i)^2$ 都被乘以权重 $w_i = 1/\\sigma_i^2$。高精度（小 $\\sigma_i$）的数据点获得较大的权重，从而对拟合产生更强的影响。相反，噪声大的数据点（大 $\\sigma_i$）的权重则被降低。此过程确保估计量能最大程度地利用最可靠的数据，正如从最大似然推导所显示的，这是解决该问题的统计最优方法。\n\n以矩阵形式表示，$\\chi^2$ 函数为：\n$$\n\\chi^2(\\boldsymbol{\\beta}) = (\\boldsymbol{y} - \\boldsymbol{X}\\boldsymbol{\\beta})^T \\boldsymbol{W} (\\boldsymbol{y} - \\boldsymbol{X}\\boldsymbol{\\beta})\n$$\n为了找到最小值，我们计算 $\\chi^2$ 相对于 $\\boldsymbol{\\beta}$ 的梯度并将其设为零：\n$$\n\\nabla_{\\boldsymbol{\\beta}} \\chi^2 = -2\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{y} + 2\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X}\\boldsymbol{\\beta} = \\boldsymbol{0}\n$$\n这得到了加权最小二乘法的“正规方程组”：\n$$\n(\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})\\hat{\\boldsymbol{\\beta}} = \\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{y}\n$$\n求解参数估计量 $\\hat{\\boldsymbol{\\beta}}$ 可得：\n$$\n\\hat{\\boldsymbol{\\beta}} = (\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1} \\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{y}\n$$\n估计量 $\\hat{\\boldsymbol{\\beta}}$ 的协方差矩阵 $\\boldsymbol{C}_{\\beta} = \\text{Cov}(\\hat{\\boldsymbol{\\beta}})$，通过误差传播求得。\n$$\n\\text{Cov}(\\hat{\\boldsymbol{\\beta}}) = \\text{Cov}((\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1} \\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{y})\n$$\n由于 $\\boldsymbol{X}$ 和 $\\boldsymbol{W}$ 是常数，且 $\\text{Cov}(\\boldsymbol{y}) = \\boldsymbol{\\Sigma} = \\boldsymbol{W}^{-1}$：\n$$\n\\boldsymbol{C}_{\\beta} = [(\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1} \\boldsymbol{X}^T\\boldsymbol{W}] \\boldsymbol{\\Sigma} [(\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1} \\boldsymbol{X}^T\\boldsymbol{W}]^T\n$$\n$$\n\\boldsymbol{C}_{\\beta} = (\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1} \\boldsymbol{X}^T\\boldsymbol{W} \\boldsymbol{W}^{-1} \\boldsymbol{W}^T\\boldsymbol{X} (\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1}\n$$\n由于 $\\boldsymbol{W}$ 是对角矩阵，所以它是对称的（$\\boldsymbol{W}^T = \\boldsymbol{W}$）。这可以简化为：\n$$\n\\boldsymbol{C}_{\\beta} = (\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1} (\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X}) (\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1} = (\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1}\n$$\n参数估计值 $\\hat{c}_0$ 和 $\\hat{s}$ 的方差是该协方差矩阵的对角元素：\n$$\n\\sigma_{\\hat{c}_0}^2 = (\\boldsymbol{C}_{\\beta})_{11}, \\quad \\sigma_{\\hat{s}}^2 = (\\boldsymbol{C}_{\\beta})_{22}\n$$\n标准误差是这些方差的平方根。\n对于置信水平为 $1-\\alpha$ 的双边置信区间，我们使用公式 $\\hat{\\theta} \\pm z_{1-\\alpha/2} \\sigma_{\\hat{\\theta}}$。问题指定置信水平为 $0.95$，因此 $\\alpha = 0.05$ 且 $\\alpha/2 = 0.025$。我们需要标准正态分位数 $z_{0.975}$，其值约为 $1.96$。在计算中将使用一个精确值。测量方差精确已知的假设使得使用正态分布分位数而非t分布分位数是合理的。\n置信区间为：\n$$\nc_{0, \\text{interval}} = \\hat{c}_0 \\pm z_{0.975} \\sigma_{\\hat{c}_0}\n$$\n$$\ns_{\\text{interval}} = \\hat{s} \\pm z_{0.975} \\sigma_{\\hat{s}}\n$$\n实现部分将把这些公式应用于所提供的三个测试案例。所有数值结果将按要求四舍五入到小数点后三位。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Applies weighted least squares to fit a linear Hugoniot relation\n    and computes parameter confidence intervals.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (well-conditioned, moderate heteroscedasticity)\n        {\n            \"up_ms\": np.array([400, 800, 1200, 1600, 2000]),\n            \"Us_ms\": np.array([5893, 6416, 6962, 7480, 8041]),\n            \"sigma_Us_ms\": np.array([12, 14, 16, 18, 20]),\n        },\n        # Case 2 (boundary case with exactly two data points)\n        {\n            \"up_ms\": np.array([1000, 2500]),\n            \"Us_ms\": np.array([7112, 8884]),\n            \"sigma_Us_ms\": np.array([15, 35]),\n        },\n        # Case 3 (includes up=0 and high dynamic range in uncertainties)\n        {\n            \"up_ms\": np.array([0, 300, 900, 1800, 2400]),\n            \"Us_ms\": np.array([3810, 4363, 5527, 7211, 8340]),\n            \"sigma_Us_ms\": np.array([8, 12, 20, 26, 32]),\n        }\n    ]\n\n    all_results = []\n    \n    # Critical value z for 95% confidence interval (two-sided)\n    alpha = 0.05\n    z_critical = norm.ppf(1 - alpha / 2)\n\n    for case in test_cases:\n        up = case[\"up_ms\"]\n        Us = case[\"Us_ms\"]\n        sigma_Us = case[\"sigma_Us_ms\"]\n\n        # 1. Construct the design matrix X\n        # X has a column of ones for the intercept c0\n        # and a column of up values for the slope s.\n        X = np.vstack([np.ones_like(up), up]).T\n\n        # 2. Construct the observation vector y\n        y = Us\n\n        # 3. Construct the weight matrix W\n        # W is diagonal with entries 1 / sigma_i^2\n        # For matrix operations, we can form it as a diagonal matrix.\n        W = np.diag(1.0 / sigma_Us**2)\n\n        # 4. Calculate the parameter estimates beta_hat = (c0_hat, s_hat)\n        # beta_hat = (X^T * W * X)^-1 * X^T * W * y\n        # We compute the parts separately for clarity.\n        XT_W = X.T @ W\n        XT_W_X = XT_W @ X\n        XT_W_y = XT_W @ y\n        \n        # Invert the matrix (X^T * W * X)\n        XT_W_X_inv = np.linalg.inv(XT_W_X)\n\n        beta_hat = XT_W_X_inv @ XT_W_y\n        c0_hat = beta_hat[0]\n        s_hat = beta_hat[1]\n\n        # 5. Calculate the parameter covariance matrix C_beta\n        # C_beta = (X^T * W * X)^-1\n        C_beta = XT_W_X_inv\n\n        # 6. Extract standard errors for the parameters\n        # These are the square roots of the diagonal elements of C_beta\n        var_c0 = C_beta[0, 0]\n        var_s = C_beta[1, 1]\n        std_err_c0 = np.sqrt(var_c0)\n        std_err_s = np.sqrt(var_s)\n        \n        # 7. Calculate confidence intervals\n        c0_lower = c0_hat - z_critical * std_err_c0\n        c0_upper = c0_hat + z_critical * std_err_c0\n        s_lower = s_hat - z_critical * std_err_s\n        s_upper = s_hat + z_critical * std_err_s\n\n        # 8. Round all results to 3 decimal places and collect them.\n        case_results = [\n            round(c0_hat, 3),\n            round(s_hat, 3),\n            round(c0_lower, 3),\n            round(c0_upper, 3),\n            round(s_lower, 3),\n            round(s_upper, 3)\n        ]\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The str() representation of a list of lists is used, removing spaces.\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n\n```", "id": "2684944"}]}