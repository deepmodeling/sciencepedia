{"hands_on_practices": [{"introduction": "这个首个练习将引导您完成混合变分原理的基本构建。通过一个简单的一维杆件，您将为位移、应变和应力这三个独立场显式地写出 Hu-Washizu 泛函。这项练习对于理解混合公式如何同时强制执行平衡、运动协调性和本构关系至关重要，从而为解决力学问题提供了一个完整而稳健的框架。[@problem_id:2903841]", "problem": "考虑一根长度为 $L>0$、横截面积恒为 $A>0$、杨氏模量为 $E>0$ 的线性弹性棱柱形一维 ($1$D) 杆。该杆沿 $x$ 轴放置，占据区间 $x \\in [0,L]$，并承受单位长度上均匀分布的轴向体力 $q \\in \\mathbb{R}$（在 $+x$ 方向为正）。杆的轴向位移被指定为 $u(0)=0$ 和 $u(L)=U$，其中 $U \\in \\mathbb{R}$ 为给定值。假设小应变和线性弹性条件成立。使用 Hu–Washizu 混合变分原理，其中包含独立的标量场：轴向位移 $u(x)$、轴向应变 $\\varepsilon(x)$ 和轴向力 $n(x)$。\n\n任务：\n1) 从弹性应变能密度和外力功的定义以及虚功原理出发，使用标量场 $u(x)$、$\\varepsilon(x)$ 和 $n(x)$，为该一维杆问题明确写出 Hu–Washizu 泛函 $\\Pi_{HW}(u,\\varepsilon,n)$。\n2) 推导相对于各独立场的驻值条件，并求解满足 $u(x)$ 本质边界条件的驻值场 $(u,\\varepsilon,n)$。\n3) 简要证明所得到的控制方程与通过原始（仅位移）变分原理和 Hellinger–Reissner 混合变分原理得到的控制方程相一致。\n4) 从驻值解中，提取在 $x=L$ 处的反力，定义为 $R_L := n(L)$。以 $E$、$A$、$L$、$U$ 和 $q$ 表示的单一、闭合形式的符号表达式给出最终答案。将最终答案表示为符号表达式；其物理单位为牛顿（N）。不要进行任何数值计算或四舍五入。", "solution": "问题 ROLEName 已经过有效性审查，被认定为具有科学依据、提法恰当、客观且自洽。其中没有矛盾、歧义或违反物理原理之处。该问题是混合变分原理在一维线性弹性中的一个标准应用。我们开始进行解答。\n\n解答过程根据问题陈述中指定的四个任务进行组织。\n\n1) Hu–Washizu 泛函 $\\Pi_{HW}(u,\\varepsilon,n)$ 的推导\n\nHu–Washizu 原理将位移 $u(x)$、应变 $\\varepsilon(x)$ 和应力（此处由轴向力 $n(x)$ 代表）视为独立场。泛函 $\\Pi_{HW}$ 的构造使其驻值条件能够导出完整的控制方程组：平衡方程、运动协调方程和本构关系。\n\nHu–Washizu 泛函的一般形式为：\n$$ \\Pi_{HW}(u, \\varepsilon, \\sigma) = \\int_{V} W(\\varepsilon) dV - \\int_{V} \\sigma : (\\varepsilon - \\nabla_s u) dV - W_{ext} $$\n其中 $W(\\varepsilon)$ 是应变能密度，$\\sigma$ 和 $\\varepsilon$ 是应力张量和应变张量，$u$ 是位移矢量，$\\nabla_s u$ 是位移梯度的对称部分，$W_{ext}$ 是外力的势。\n\n对于给定的一维 ($1$D) 杆问题：\n- 线性弹性的应变能密度为 $W(\\varepsilon) = \\frac{1}{2}E\\varepsilon^2$。它在体积 $V$（横截面积为 $A$，长度为 $L$）上的积分为 $\\int_0^L \\frac{1}{2} A E \\varepsilon(x)^2 dx$。\n- 应力张量由单一分量 $\\sigma_{xx}$ 表示，它与轴向力 $n(x)$ 的关系为 $n(x) = A \\sigma_{xx}(x)$。应变张量只有一个分量 $\\varepsilon_{xx} = \\varepsilon(x)$。应变-位移关系为 $\\varepsilon(x) = \\frac{du}{dx}$。约束项 $\\int_V \\sigma : (\\varepsilon - \\nabla_s u) dV$ 变为 $\\int_0^L A \\sigma_{xx} (\\varepsilon - \\frac{du}{dx}) dx = \\int_0^L n (\\varepsilon - \\frac{du}{dx}) dx$。\n- 外力势包括体力 $q$和任何指定的边界力。体力的势为 $\\int_V b \\cdot u dV = \\int_0^L q u(x) dx$。由于位移 $u(0)$ 和 $u(L)$ 是指定的（本质边界条件），因此没有指定的边界面力，边界面力项为零。\n\n综合这些分量，我们构建泛函 $\\Pi_{HW}(u, \\varepsilon, n)$。注意，约束项和外力功项从应变能项中减去，以形成总势能。\n$$ \\Pi_{HW}(u, \\varepsilon, n) = \\int_{0}^{L} \\left[ \\frac{1}{2} A E \\varepsilon(x)^2 - n(x) \\left( \\varepsilon(x) - \\frac{du}{dx} \\right) - q u(x) \\right] dx $$\n这就是针对指定一维杆问题的 Hu–Washizu 泛函的显式形式。\n\n2) 驻值条件与场的求解\n\n泛函的驻点是通过要求其一阶变分 $\\delta \\Pi_{HW}$ 对所有容许的变分 $\\delta u$、$\\delta \\varepsilon$ 和 $\\delta n$ 均为零来求得的。主场 $\\delta u$ 的变分在位移指定的边界上必须为零，即 $\\delta u(0) = 0$ 和 $\\delta u(L) = 0$。\n\n一阶变分为：\n$$ \\delta \\Pi_{HW} = \\int_{0}^{L} \\left[ A E \\varepsilon \\delta\\varepsilon - \\delta n \\left( \\varepsilon - \\frac{du}{dx} \\right) - n \\left( \\delta\\varepsilon - \\frac{d(\\delta u)}{dx} \\right) - q \\delta u \\right] dx $$\n对项 $n \\frac{d(\\delta u)}{dx}$ 进行分部积分：$\\int_{0}^{L} n \\frac{d(\\delta u)}{dx} dx = [n \\delta u]_0^L - \\int_0^L \\frac{dn}{dx} \\delta u dx$。\n由于 $\\delta u(0)=\\delta u(L)=0$，边界项 $[n \\delta u]_0^L$ 为零。\n按变分项合并：\n$$ \\delta \\Pi_{HW} = \\int_{0}^{L} \\left( -\\frac{dn}{dx} - q \\right) \\delta u dx + \\int_{0}^{L} (A E \\varepsilon - n) \\delta\\varepsilon dx + \\int_{0}^{L} \\left( -\\varepsilon + \\frac{du}{dx} \\right) \\delta n dx = 0 $$\n为使此式对任意变分都成立，每个被积函数都必须为零，从而得到欧拉-拉格朗日方程：\ni. 关于 $u(x)$ 的驻值条件 ($\\delta u$)：$\\frac{dn}{dx} + q = 0$ (平衡方程)\nii. 关于 $\\varepsilon(x)$ 的驻值条件 ($\\delta \\varepsilon$)：$n(x) = A E \\varepsilon(x)$ (本构关系)\niii. 关于 $n(x)$ 的驻值条件 ($\\delta n$)：$\\varepsilon(x) = \\frac{du}{dx}$ (运动学关系)\n\n现在我们求解这个方程组。\n由 (i) 式，对 $x$ 积分得到轴向力：\n$n(x) = -qx + C_1$，其中 $C_1$ 是一个积分常数。\n\n由 (ii) 式，应变为：\n$\\varepsilon(x) = \\frac{n(x)}{AE} = \\frac{-qx + C_1}{AE}$。\n\n由 (iii) 式，我们对应变进行积分以求得位移：\n$u(x) = \\int \\varepsilon(x) dx = \\int \\frac{-qx + C_1}{AE} dx = \\frac{1}{AE} \\left( -\\frac{qx^2}{2} + C_1 x \\right) + C_2$。\n\n常数 $C_1$ 和 $C_2$ 由本质边界条件 $u(0)=0$ 和 $u(L)=U$ 确定：\n$u(0) = 0 \\implies \\frac{1}{AE}(0) + C_2 = 0 \\implies C_2 = 0$。\n$u(L) = U \\implies \\frac{1}{AE} \\left( -\\frac{qL^2}{2} + C_1 L \\right) = U$。\n解出 $C_1$：\n$C_1 L = A E U + \\frac{qL^2}{2} \\implies C_1 = \\frac{AEU}{L} + \\frac{qL}{2}$。\n\n将 $C_1$ 和 $C_2$ 代回场的表达式中，得到最终解：\n- 轴向力：$n(x) = -qx + \\frac{AEU}{L} + \\frac{qL}{2} = \\frac{AEU}{L} + \\frac{q}{2}(L-2x)$\n- 轴向应变：$\\varepsilon(x) = \\frac{n(x)}{AE} = \\frac{U}{L} + \\frac{q}{2AE}(L-2x)$\n- 轴向位移：$u(x) = \\frac{1}{AE} \\left( -\\frac{qx^2}{2} + \\left(\\frac{AEU}{L} + \\frac{qL}{2}\\right)x \\right) = \\frac{U}{L}x + \\frac{q}{2AE}(Lx-x^2)$\n\n3) 与其他变分原理的等价性\n\n我们简要证明这些控制方程与从原始变分原理和 Hellinger–Reissner 变分原理得到的方程是一致的。\n\n- **原始（仅位移）原理**：泛函是总势能 $\\Pi_p(u) = \\int_0^L \\left(\\frac{1}{2} AE (\\frac{du}{dx})^2 - qu\\right) dx$。其驻值条件是控制方程的强形式：$\\frac{d}{dx}\\left(AE\\frac{du}{dx}\\right) + q = 0$。根据我们的 Hu–Washizu 解，我们有 $n = AE\\varepsilon$ 和 $\\varepsilon = du/dx$，结合可得 $n = AE \\frac{du}{dx}$。将此代入平衡方程 $\\frac{dn}{dx} + q = 0$ 直接得到 $\\frac{d}{dx}\\left(AE\\frac{du}{dx}\\right) + q = 0$。结果完全相同。\n\n- **Hellinger–Reissner 原理**：独立场为位移 $u(x)$ 和力 $n(x)$。其泛函为 $\\Pi_{HR}(u,n) = \\int_0^L \\left(n\\frac{du}{dx} - \\frac{n^2}{2AE} - qu\\right)dx$。其驻值条件为：\n  - $\\delta u$: $\\frac{dn}{dx} + q = 0$\n  - $\\delta n$: $\\frac{du}{dx} - \\frac{n}{AE} = 0$\nHu–Washizu 原理导出三个方程：(i) $\\frac{dn}{dx} + q = 0$，(ii) $n=AE\\varepsilon$ 和 (iii) $\\varepsilon=du/dx$。将 (ii) 代入 (iii) 得到 $\\frac{n}{AE} = \\frac{du}{dx}$。因此，由 Hu–Washizu 原理得到的方程组直接包含了由 Hellinger–Reissner 原理得到的方程组。这两个原理因此是一致的。\n\n4) 在 $x=L$ 处的反力\n\n在 $x=L$ 处的反力，记为 $R_L$，是该点内轴力的值，即 $R_L := n(L)$。使用推导出的 $n(x)$ 表达式：\n$$ n(x) = \\frac{AEU}{L} + \\frac{q}{2}(L-2x) $$\n我们计算该表达式在 $x=L$ 处的值：\n$$ R_L = n(L) = \\frac{AEU}{L} + \\frac{q}{2}(L - 2L) = \\frac{AEU}{L} + \\frac{q}{2}(-L) $$\n因此，在 $x=L$ 处的反力为：\n$$ R_L = \\frac{AEU}{L} - \\frac{qL}{2} $$\n这个表达式在物理上是一致的。它是由指定位移 $U$ 引起的力和体力荷载 $q$ 引起的力的叠加。对于在均匀荷载 $q$ 作用下两端固定的杆（$U=0$），根据对称性可知，反力为 $-qL/2$。对于仅受端部位移作用的杆（$q=0$），力为 $AEU/L$，这与整根杆的胡克定律一致。", "answer": "$$\n\\boxed{\\frac{AEU}{L} - \\frac{qL}{2}}\n$$", "id": "2903841"}, {"introduction": "在掌握了基础知识之后，本练习将展示混合原理在处理更复杂情景（例如由多种材料制成的结构）时的强大功能。您将为一个复合杆推导余能泛函，并用它来确定在给定伸长量下的应力场。此练习突出了变分方法如何优雅地处理材料界面和运动学约束。[@problem_id:2903862]", "problem": "一根横截面积均匀的直棱杆沿坐标轴 $x \\in [0,L]$ 放置，由两段完美粘合的线弹性材料段组成，其杨氏模量 $E(x)$ 为分段常数，由下式给出\n$$\nE(x) \\;=\\; \\begin{cases}\nE_1, & 0 \\le x \\le L_1,\\\\\nE_2, & L_1 < x \\le L,\n\\end{cases}\n$$\n其中 $L = L_1 + L_2$。在无体力且无指定面力的情况下，准静态地施加一个总的端到端伸长量 $u(L) - u(0) = \\Delta$。应力场记为 $\\sigma(x)$，轴向应变记为 $\\varepsilon(x)$，位移记为 $u(x)$。假设小应变、线弹性和在界面 $x=L_1$ 处完美粘合。从混合变分框架出发，使用 Hellinger–Reissner (H–R) 原理或 Hu–Washizu (H–W) 原理，推导一个仅用应力场表示的、适用于这些位移边界条件的余能泛函。你的推导必须从一维线弹性的基本本构关系、运动协调性定义和无体力的平衡方程出发，并且不得先验地假设任何应力拟设。清楚地说明施加的伸长约束如何进入泛函（例如，通过拉格朗日乘子或通过消除位移场），并说明应力场的容许类。然后，确定使余能泛函取驻值的应力场，并验证界面平衡得到满足。\n\n对于一个具体的计算，设 $L_1 = 0.30\\,\\mathrm{m}$，$L_2 = 0.70\\,\\mathrm{m}$，$E_1 = 70\\,\\mathrm{GPa}$，$E_2 = 210\\,\\mathrm{GPa}$，以及 $\\Delta = 1.00\\times 10^{-3}\\,\\mathrm{m}$。计算在给定伸长量下，使所推导的余能泛函取极值的恒定应力值。以兆帕 (MPa) 为单位表示最终应力值，并将你的答案四舍五入到四位有效数字。", "solution": "在尝试任何解答之前，需要对问题陈述进行验证。\n\n步骤1：提取已知条件。\n- 杆是棱柱形的，沿 x 轴从 x=0 到 x=L。\n- 横截面积 $A$ 是均匀的。\n- 杨氏模量 $E(x)$ 是分段常数：当 $x \\in [0, L_1]$ 时，$E(x) = E_1$，当 $x \\in (L_1, L]$ 时，$E(x) = E_2$，其中 $L=L_1+L_2$。\n- 边界条件是给定的总伸长量：$u(L) - u(0) = \\Delta$。\n- 无体力或指定面力。\n- 场变量为应力 $\\sigma(x)$、应变 $\\varepsilon(x)$ 和位移 $u(x)$。\n- 假设：小应变、线弹性、完美粘合。\n- 任务是从混合变分原理（Hellinger–Reissner 或 Hu–Washizu）出发，推导一个纯粹用应力场表示的余能泛函，然后用它来求解应力场。\n- 用于计算的数值：$L_1 = 0.30\\,\\mathrm{m}$，$L_2 = 0.70\\,\\mathrm{m}$，$E_1 = 70\\,\\mathrm{GPa}$，$E_2 = 210\\,\\mathrm{GPa}$，$\\Delta = 1.00\\times 10^{-3}\\,\\mathrm{m}$。\n\n步骤2：使用提取的已知条件进行验证。\n- 该问题在科学上基于线弹性理论和力学中的变分原理。\n- 该问题是适定的。所提供的边界条件和材料属性足以确定唯一的应力状态。\n- 该问题是客观的，并使用了精确的术语。\n所有验证标准均已满足。该问题被认为是有效的。\n\n步骤3：结论和行动。\n该问题有效。将提供解答。\n\n在给定假设下，此一维问题的基本场方程为：\n1.  平衡方程（无体力）：$\\frac{d\\sigma}{dx} = 0$。\n2.  运动协调性（小应变）：$\\varepsilon = \\frac{du}{dx}$。\n3.  本构关系（线弹性）：$\\sigma = E(x)\\varepsilon$。\n\n问题要求从混合变分原理出发进行推导。我们从 Hellinger–Reissner 原理开始，该原理将应力 $\\sigma$ 和位移 $u$ 视为独立场。这个一维系统对应的泛函 $\\Pi_{HR}[\\sigma, u]$ 由下式给出：\n$$ \\Pi_{HR}[\\sigma, u] = \\int_0^L A \\left( \\sigma \\frac{du}{dx} - W_c(\\sigma) \\right) dx $$\n其中 $A$ 是横截面积，$W_c(\\sigma) = \\frac{\\sigma^2}{2E(x)}$ 是余应变能密度。泛函为：\n$$ \\Pi_{HR}[\\sigma, u] = \\int_0^L A \\left( \\sigma \\frac{du}{dx} - \\frac{\\sigma^2}{2E(x)} \\right) dx $$\n$\\Pi_{HR}$ 的驻值原理导出了控制方程。对位移场 $u$ 的变分给出：\n$$ \\delta_u \\Pi_{HR} = \\int_0^L A \\sigma \\frac{d(\\delta u)}{dx} dx = A \\left[ \\sigma \\delta u \\right]_0^L - \\int_0^L A \\frac{d\\sigma}{dx} \\delta u dx = 0 $$\n对于域 $(0,L)$ 内的任意变分 $\\delta u$，积分项要求 $\\frac{d\\sigma}{dx} = 0$。此即平衡方程。这个条件意味着静力容许的应力场在材料属性恒定的分段上必须是常数。此外，界面 $x=L_1$ 处的力平衡要求应力连续，即 $\\sigma(L_1^-) = \\sigma(L_1^+)$。因此，容许应力场 $\\sigma(x)$ 在整个域 $[0, L]$上必须是一个单一的常数值 $\\sigma_0$。\n因此，应力场的容许类是所有常数函数 $\\sigma(x) = \\sigma_0$ 的集合。\n\n为了推导余能泛函，我们将这种容许形式的应力场代入 Hellinger–Reissner 泛函：\n$$ \\Pi(\\sigma_0, u) = \\int_0^L A \\left( \\sigma_0 \\frac{du}{dx} - \\frac{\\sigma_0^2}{2E(x)} \\right) dx $$\n现在可以进行积分：\n$$ \\Pi(\\sigma_0, u) = A \\sigma_0 \\int_0^L \\frac{du}{dx} dx - \\frac{A \\sigma_0^2}{2} \\int_0^L \\frac{1}{E(x)} dx $$\n$$ \\Pi(\\sigma_0, u) = A \\sigma_0 [u(L) - u(0)] - \\frac{A \\sigma_0^2}{2} \\left( \\int_0^{L_1} \\frac{dx}{E_1} + \\int_{L_1}^{L} \\frac{dx}{E_2} \\right) $$\n$$ \\Pi(\\sigma_0, u) = A \\sigma_0 [u(L) - u(0)] - \\frac{A \\sigma_0^2}{2} \\left( \\frac{L_1}{E_1} + \\frac{L_2}{E_2} \\right) $$\n问题指定了运动学条件 $u(L) - u(0) = \\Delta$。我们通过将 $\\Delta$ 代入泛函来施加此约束。这就得到一个泛函，我们将其表示为 $\\Pi_c^*$，它只用应力场参数 $\\sigma_0$ 和给定的问题数据表示：\n$$ \\Pi_c^*[\\sigma] \\equiv \\Pi(\\sigma_0) = A \\sigma_0 \\Delta - \\frac{A \\sigma_0^2}{2} \\left( \\frac{L_1}{E_1} + \\frac{L_2}{E_2} \\right) $$\n这就是适用于给定边界条件的所要求的余能泛函。\n\n解决该问题的应力场是使该泛函取驻值的应力场。我们通过将 $\\Pi(\\sigma_0)$ 对 $\\sigma_0$ 的导数设为零来求这个应力值：\n$$ \\frac{d\\Pi}{d\\sigma_0} = A \\Delta - A \\sigma_0 \\left( \\frac{L_1}{E_1} + \\frac{L_2}{E_2} \\right) = 0 $$\n求解 $\\sigma_0$，我们得到：\n$$ \\sigma_0 = \\frac{\\Delta}{\\frac{L_1}{E_1} + \\frac{L_2}{E_2}} $$\n这个结果给出了整个杆内的恒定应力。如前所示，恒定应力场自动满足界面处的平衡条件 $\\sigma(L_1^-)=\\sigma(L_1^+)$。\n\n对于具体计算，我们代入给定的数值。所有量必须使用一致的国际单位制单位（米，帕斯卡）。\n$L_1 = 0.30\\,\\mathrm{m}$\n$L_2 = 0.70\\,\\mathrm{m}$\n$E_1 = 70\\,\\mathrm{GPa} = 70 \\times 10^9\\,\\mathrm{Pa}$\n$E_2 = 210\\,\\mathrm{GPa} = 210 \\times 10^9\\,\\mathrm{Pa}$\n$\\Delta = 1.00 \\times 10^{-3}\\,\\mathrm{m}$\n\n首先，我们计算分母：\n$$ \\frac{L_1}{E_1} + \\frac{L_2}{E_2} = \\frac{0.30}{70 \\times 10^9} + \\frac{0.70}{210 \\times 10^9} = \\frac{1}{10^9} \\left( \\frac{0.30}{70} + \\frac{0.70}{210} \\right) $$\n$$ = \\frac{1}{10^9} \\left( \\frac{3 \\times 0.30 + 0.70}{210} \\right) = \\frac{1}{10^9} \\left( \\frac{0.90 + 0.70}{210} \\right) = \\frac{1.60}{210 \\times 10^9} \\, \\frac{\\mathrm{m}}{\\mathrm{Pa}} $$\n现在，我们计算应力 $\\sigma_0$：\n$$ \\sigma_0 = \\frac{1.00 \\times 10^{-3}}{\\frac{1.60}{210 \\times 10^9}} = \\frac{1.00 \\times 10^{-3} \\times 210 \\times 10^9}{1.60} = \\frac{210 \\times 10^6}{1.60} \\,\\mathrm{Pa} $$\n$$ \\sigma_0 = 131.25 \\times 10^6 \\,\\mathrm{Pa} = 131.25 \\,\\mathrm{MPa} $$\n问题要求将答案四舍五入到四位有效数字。值 $131.25$ 四舍五入为 $131.3$。\n最终应力值为 $131.3\\,\\mathrm{MPa}$。", "answer": "$$\n\\boxed{131.3}\n$$", "id": "2903862"}, {"introduction": "变分原理的真正威力在计算力学中得以实现。这最后一个练习将通过引导您完成二维问题中 Hellinger-Reissner 原理的离散化过程，从而弥合连续介质理论与数值实现之间的差距。您将执行一个“斑块检验”（Patch Test），这是有限元分析中的一个基本程序，用以验证所选单元公式能否准确再现基本的常应变状态，从而确保其可靠性和收敛性。[@problem_id:2903888]", "problem": "考虑一个平面应变状态下的单位正方形域 $\\Omega = [0,1]\\times[0,1]$，该域由杨氏模量为 $E$、泊松比为 $\\nu$ 的均匀、各向同性、线弹性实体构成。假设材料服从三维线弹性定律，其拉梅参数为 $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu = \\dfrac{E}{2(1+\\nu)}$，因此，在二维平面应变下，使用 Voigt 记法 $\\{\\sigma_{xx},\\sigma_{yy},\\tau_{xy}\\}$ 和 $\\{\\varepsilon_{xx},\\varepsilon_{yy},\\gamma_{xy}\\}$，其本构矩阵为\n$$\n\\mathbf{C} \\;=\\;\n\\begin{bmatrix}\n\\lambda+2\\mu & \\lambda & 0 \\\\\n\\lambda & \\lambda+2\\mu & 0 \\\\\n0 & 0 & \\mu\n\\end{bmatrix}.\n$$\n通过从 $(0,0)$ 到 $(1,1)$ 的对角线将 $\\Omega$ 离散化为两个线性（$\\mathcal{P}_1$）三角形单元，节点坐标为\n$$\n\\mathbf{x}_1=(0,0),\\quad \\mathbf{x}_2=(1,0),\\quad \\mathbf{x}_3=(1,1),\\quad \\mathbf{x}_4=(0,1),\n$$\n单元连接关系为 $e=1:\\{1,2,3\\}$ 和 $e=2:\\{1,3,4\\}$。假设位移场是全局线性的，\n$$\n\\mathbf{u}(x,y) \\;=\\; \n\\begin{bmatrix}\nu_x(x,y)\\\\\nu_y(x,y)\n\\end{bmatrix}\n\\;=\\;\n\\begin{bmatrix}\na + b\\,x + c\\,y \\\\\nd + e\\,x + f\\,y\n\\end{bmatrix},\n$$\n其中常数 $a,b,c,d,e,f\\in\\mathbb{R}$。因此，精确的（工程）应变在 $\\Omega$ 上是常数，等于\n$$\n\\boldsymbol{\\varepsilon}^{\\star} \\;=\\; \n\\begin{bmatrix}\n\\varepsilon_{xx}\\\\\n\\varepsilon_{yy}\\\\\n\\gamma_{xy}\n\\end{bmatrix}\n\\;=\\;\n\\begin{bmatrix}\nb\\\\\nf\\\\\nc+e\n\\end{bmatrix},\n\\quad\n\\boldsymbol{\\sigma}^{\\star} \\;=\\; \\mathbf{C}\\,\\boldsymbol{\\varepsilon}^{\\star}.\n$$\n\n使用 Hellinger–Reissner 混合变分原理（将应力和位移作为独立场）和以下离散近似空间：\n\n- 每个单元上为 Voigt 形式的常数应力（分段 $\\mathcal{P}_0$），\n- 连续、分段线性的节点位移（全局 $\\mathcal{P}_1$），\n\n从第一性原理出发，执行以下步骤：\n\n1) 从 Hellinger–Reissner 泛函出发，推导离散驻值方程。证明单元矩阵可简化为\n$$\n\\mathbf{H}_e \\;=\\; \\int_{\\Omega_e} \\mathbf{C}^{-1}\\,\\mathrm{d}\\Omega \\;=\\; A_e\\,\\mathbf{C}^{-1},\n\\qquad\n\\mathbf{G}_e \\;=\\; \\int_{\\Omega_e} \\mathbf{B}_e\\,\\mathrm{d}\\Omega \\;=\\; A_e\\,\\mathbf{B}_e,\n$$\n其中 $A_e$ 是单元 $e$ 的面积，$\\mathbf{B}_e$ 是由其形函数梯度构建的线性三角形的常数应变-位移矩阵。\n\n2) 对应力参数 $\\mathbf{s}=\\begin{bmatrix}\\mathbf{s}_1\\\\ \\mathbf{s}_2\\end{bmatrix}$（其中 $\\mathbf{s}_e$ 是单元 $e$ 上的常数应力向量）和全局节点位移向量 $\\mathbf{d}$，以分块形式组装全局混合系统：\n$$\n\\begin{bmatrix}\n\\mathbf{H} & -\\mathbf{G}\\\\\n-\\mathbf{G}^{\\mathsf{T}} & \\mathbf{0}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{s}\\\\\n\\mathbf{d}\n\\end{bmatrix}\n\\;=\\;\n\\begin{bmatrix}\n\\mathbf{0}\\\\\n\\mathbf{f}\n\\end{bmatrix}.\n$$\n\n3) 构建“应力方程残差”向量\n$$\n\\mathbf{r}_s(\\mathbf{d},\\mathbf{s}) \\;=\\; \\mathbf{H}\\,\\mathbf{s} \\;-\\; \\mathbf{G}\\,\\mathbf{d},\n$$\n此向量的构建方法是：为给定的双单元网格显式计算 $\\mathbf{H}$ 和 $\\mathbf{G}$，将 $\\mathbf{d}$ 取为给定线性场在四个网格节点上的插值，并对 $e=1,2$ 取 $\\mathbf{s}_e=\\boldsymbol{\\sigma}^{\\star}$。\n\n4) 设 $A_{\\Omega}$ 表示网格的总面积。定义无量纲标量“分片检验”指示器\n$$\nR \\;=\\; \\dfrac{\\|\\mathbf{r}_s\\|_2}{A_{\\Omega}\\,\\|\\boldsymbol{\\varepsilon}^{\\star}\\|_2}.\n$$\n精确计算 $R$。将您的最终答案表示为一个纯数（无量纲）。无需四舍五入，答案不应包含任何物理单位。", "solution": "对于平面应变中的小应变线弹性问题，其中应力场 $\\boldsymbol{\\sigma}$ 和位移场 $\\mathbf{u}$ 相互独立，为清晰起见省略了体力和面力（它们在应力方程残差中不起作用），其 Hellinger–Reissner 泛函为\n$$\n\\Pi_{\\text{HR}}(\\mathbf{u},\\boldsymbol{\\sigma})\n\\;=\\;\n\\int_{\\Omega} \\left( \\tfrac{1}{2}\\,\\boldsymbol{\\sigma}^{\\mathsf{T}}\\mathbf{C}^{-1}\\boldsymbol{\\sigma} \\;-\\; \\boldsymbol{\\sigma}^{\\mathsf{T}}\\,\\boldsymbol{\\varepsilon}(\\mathbf{u}) \\right)\\,\\mathrm{d}\\Omega.\n$$\n关于 $\\boldsymbol{\\sigma}$ 和 $\\mathbf{u}$ 的驻值条件分别得出：\n$$\n\\delta_{\\boldsymbol{\\sigma}} \\Pi_{\\text{HR}}:\\quad \\int_{\\Omega}\\left(\\mathbf{C}^{-1}\\boldsymbol{\\sigma} - \\boldsymbol{\\varepsilon}(\\mathbf{u})\\right)^{\\mathsf{T}}\\delta\\boldsymbol{\\sigma}\\,\\mathrm{d}\\Omega \\;=\\; 0\n\\;\\;\\Rightarrow\\;\\; \\mathbf{C}^{-1}\\boldsymbol{\\sigma} - \\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\mathbf{0},\n$$\n$$\n\\delta_{\\mathbf{u}} \\Pi_{\\text{HR}}:\\quad -\\int_{\\Omega}\\boldsymbol{\\sigma}^{\\mathsf{T}}\\delta\\boldsymbol{\\varepsilon}(\\mathbf{u})\\,\\mathrm{d}\\Omega \\;=\\; 0\n\\;\\;\\Rightarrow\\;\\; \\nabla\\cdot\\boldsymbol{\\sigma} = \\mathbf{0}\n$$\n在适当的本质边界条件下，通过分部积分得到其弱形式。这些分别是本构方程和平衡方程。\n\n对于离散近似，我们为每个单元选择一个 Voigt 顺序为 $\\{\\sigma_{xx},\\sigma_{yy},\\tau_{xy}\\}$ 的常数应力向量 $\\boldsymbol{\\sigma}|_{\\Omega_e} \\approx \\mathbf{s}_e\\in\\mathbb{R}^{3}$，以及连续的分段线性位移 $\\mathbf{u}(\\mathbf{x}) \\approx \\mathbf{N}(\\mathbf{x})\\,\\mathbf{d}$，其中 $\\mathbf{N}$ 集合了节点形函数，$\\mathbf{d}$ 是全局节点位移向量。单元应变-位移矩阵 $\\mathbf{B}_e$ 集合了单元 $e$ 上线性形函数的常数梯度，它将单元的节点自由度映射到工程应变向量。对于节点为 $i=1,2,3$、形函数为 $N_i$ 的线性三角形，该矩阵为\n$$\n\\mathbf{B}_e \\;=\\;\n\\begin{bmatrix}\n\\frac{\\partial N_1}{\\partial x} & 0 & \\frac{\\partial N_2}{\\partial x} & 0 & \\frac{\\partial N_3}{\\partial x} & 0\\\\[4pt]\n0 & \\frac{\\partial N_1}{\\partial y} & 0 & \\frac{\\partial N_2}{\\partial y} & 0 & \\frac{\\partial N_3}{\\partial y}\\\\[4pt]\n\\frac{\\partial N_1}{\\partial y} & \\frac{\\partial N_1}{\\partial x} & \\frac{\\partial N_2}{\\partial y} & \\frac{\\partial N_2}{\\partial x} & \\frac{\\partial N_3}{\\partial y} & \\frac{\\partial N_3}{\\partial x}\n\\end{bmatrix}.\n$$\n根据这些选择，离散的 Hellinger–Reissner 泛函变为\n$$\n\\Pi_{\\text{HR}}^h(\\mathbf{d},\\mathbf{s}) \\;=\\; \\sum_{e=1}^{n_{\\text{el}}} \\int_{\\Omega_e} \\left( \\tfrac{1}{2}\\,\\mathbf{s}_e^{\\mathsf{T}}\\mathbf{C}^{-1}\\mathbf{s}_e \\;-\\; \\mathbf{s}_e^{\\mathsf{T}}\\,\\mathbf{B}_e\\,\\mathbf{d}_e \\right)\\,\\mathrm{d}\\Omega,\n$$\n其中 $\\mathbf{d}_e$ 是与单元 $e$ 的节点相关联的 $\\mathbf{d}$ 的子向量。关于 $\\mathbf{s}_e$ 和 $\\mathbf{d}$ 的驻值条件得出单元级方程\n$$\n\\underbrace{\\left(\\int_{\\Omega_e}\\mathbf{C}^{-1}\\,\\mathrm{d}\\Omega\\right)}_{\\mathbf{H}_e}\\,\\mathbf{s}_e \\;-\\; \\underbrace{\\left(\\int_{\\Omega_e}\\mathbf{B}_e\\,\\mathrm{d}\\Omega\\right)}_{\\mathbf{G}_e}\\,\\mathbf{d}_e \\;=\\; \\mathbf{0},\n\\qquad\n-\\mathbf{G}_e^{\\mathsf{T}}\\mathbf{s}_e \\;=\\; \\mathbf{0} \\;\\; \\text{(在 } \\Omega_e \\text{ 上无外力的情况下)}.\n$$\n由于 $\\mathbf{C}^{-1}$ 和 $\\mathbf{B}_e$ 在线性三角形上是常数，积分可简化为面积缩放：\n$$\n\\mathbf{H}_e \\;=\\; A_e\\,\\mathbf{C}^{-1}, \\qquad \\mathbf{G}_e \\;=\\; A_e\\,\\mathbf{B}_e,\n$$\n如题所求。对所有单元进行组装，得到全局系统\n$$\n\\begin{bmatrix}\n\\mathbf{H} & -\\mathbf{G}\\\\[2pt]\n-\\mathbf{G}^{\\mathsf{T}} & \\mathbf{0}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{s}\\\\[2pt]\n\\mathbf{d}\n\\end{bmatrix}\n\\;=\\;\n\\begin{bmatrix}\n\\mathbf{0}\\\\[2pt]\n\\mathbf{f}\n\\end{bmatrix},\n$$\n其中 $\\mathbf{H}=\\mathrm{diag}(\\mathbf{H}_1,\\mathbf{H}_2)$ 且 $\\mathbf{G}$ 由 $\\{\\mathbf{G}_e\\}$ 组装而成。\n\n我们现在为给定的两个单元显式计算矩阵。由于单位正方形被分成两个全等的三角形，每个单元都是一个面积为 $A_e=\\tfrac{1}{2}$ 的直角三角形。使用节点坐标：\n\n- 对于节点为 $\\{1,2,3\\}$ 的单元 $e=1$，其常数形函数梯度（通过标准面积坐标公式获得）为\n$$\n\\frac{\\partial N_1}{\\partial x}=-1,\\;\\; \\frac{\\partial N_1}{\\partial y}=0,\\qquad\n\\frac{\\partial N_2}{\\partial x}=1,\\;\\; \\frac{\\partial N_2}{\\partial y}=-1,\\qquad\n\\frac{\\partial N_3}{\\partial x}=0,\\;\\; \\frac{\\partial N_3}{\\partial y}=1,\n$$\n因此\n$$\n\\mathbf{B}_1 \\;=\\;\n\\begin{bmatrix}\n-1 & 0 & 1 & 0 & 0 & 0\\\\[2pt]\n0 & 0 & 0 & -1 & 0 & 1\\\\[2pt]\n0 & -1 & -1 & 1 & 1 & 0\n\\end{bmatrix}.\n$$\n\n- 对于节点为 $\\{1,3,4\\}$ 的单元 $e=2$，其梯度为\n$$\n\\frac{\\partial N_1}{\\partial x}=0,\\;\\; \\frac{\\partial N_1}{\\partial y}=-1,\\qquad\n\\frac{\\partial N_3}{\\partial x}=1,\\;\\; \\frac{\\partial N_3}{\\partial y}=0,\\qquad\n\\frac{\\partial N_4}{\\partial x}=-1,\\;\\; \\frac{\\partial N_4}{\\partial y}=1,\n$$\n因此\n$$\n\\mathbf{B}_2 \\;=\\;\n\\begin{bmatrix}\n0 & 0 & 1 & 0 & -1 & 0\\\\[2pt]\n0 & -1 & 0 & 0 & 0 & 1\\\\[2pt]\n-1 & 0 & 0 & 1 & 1 & -1\n\\end{bmatrix}.\n$$\n\n因此，\n$$\n\\mathbf{H}_1=\\mathbf{H}_2=\\tfrac{1}{2}\\,\\mathbf{C}^{-1}, \\qquad \\mathbf{G}_1 = \\tfrac{1}{2}\\,\\mathbf{B}_1,\\qquad \\mathbf{G}_2 = \\tfrac{1}{2}\\,\\mathbf{B}_2.\n$$\n\n接下来，我们通过在四个节点上对给定的线性场进行采样来构建节点位移向量 $\\mathbf{d}$：\n$$\n\\mathbf{u}(\\mathbf{x}_1) = \\begin{bmatrix} a\\\\ d \\end{bmatrix},\\quad\n\\mathbf{u}(\\mathbf{x}_2) = \\begin{bmatrix} a+b\\\\ d+e \\end{bmatrix},\\quad\n\\mathbf{u}(\\mathbf{x}_3) = \\begin{bmatrix} a+b+c\\\\ d+e+f \\end{bmatrix},\\quad\n\\mathbf{u}(\\mathbf{x}_4) = \\begin{bmatrix} a+c\\\\ d+f \\end{bmatrix}.\n$$\n采用标准的全局排序 $\\mathbf{d}=\\begin{bmatrix}u_{1x}&u_{1y}&u_{2x}&u_{2y}&u_{3x}&u_{3y}&u_{4x}&u_{4y}\\end{bmatrix}^{\\mathsf{T}}$，单元位移子向量为\n$$\n\\mathbf{d}_1 = \\begin{bmatrix}a\\\\ d\\\\ a+b\\\\ d+e\\\\ a+b+c\\\\ d+e+f\\end{bmatrix},\\qquad\n\\mathbf{d}_2 = \\begin{bmatrix}a\\\\ d\\\\ a+b+c\\\\ d+e+f\\\\ a+c\\\\ d+f\\end{bmatrix}.\n$$\n\n我们现在计算由有限元运动学计算出的单元应变：\n$$\n\\boldsymbol{\\varepsilon}_1^h \\;=\\; \\mathbf{B}_1\\,\\mathbf{d}_1\n\\;=\\;\n\\begin{bmatrix}\n-1 & 0 & 1 & 0 & 0 & 0\\\\\n0 & 0 & 0 & -1 & 0 & 1\\\\\n0 & -1 & -1 & 1 & 1 & 0\n\\end{bmatrix}\n\\begin{bmatrix}\na\\\\ d\\\\ a+b\\\\ d+e\\\\ a+b+c\\\\ d+e+f\n\\end{bmatrix}\n\\;=\\;\n\\begin{bmatrix}\nb\\\\ f\\\\ c+e\n\\end{bmatrix}\n\\;=\\; \\boldsymbol{\\varepsilon}^{\\star},\n$$\n同样地，\n$$\n\\boldsymbol{\\varepsilon}_2^h \\;=\\; \\mathbf{B}_2\\,\\mathbf{d}_2\n\\;=\\;\n\\begin{bmatrix}\n0 & 0 & 1 & 0 & -1 & 0\\\\\n0 & -1 & 0 & 0 & 0 & 1\\\\\n-1 & 0 & 0 & 1 & 1 & -1\n\\end{bmatrix}\n\\begin{bmatrix}\na\\\\ d\\\\ a+b+c\\\\ d+e+f\\\\ a+c\\\\ d+f\n\\end{bmatrix}\n\\;=\\;\n\\begin{bmatrix}\nb\\\\ f\\\\ c+e\n\\end{bmatrix}\n\\;=\\; \\boldsymbol{\\varepsilon}^{\\star}.\n$$\n因此，对于一个全局线性的位移场，每个单元都能精确地再现常数应变 $\\boldsymbol{\\varepsilon}^{\\star}$，这是分片检验的一个关键要求。\n\n我们选择与本构定律一致的单元应力参数，\n$$\n\\mathbf{s}_1 \\;=\\; \\mathbf{s}_2 \\;=\\; \\boldsymbol{\\sigma}^{\\star} \\;=\\; \\mathbf{C}\\,\\boldsymbol{\\varepsilon}^{\\star}.\n$$\n现在我们可以计算应力方程残差，\n$$\n\\mathbf{r}_s(\\mathbf{d},\\mathbf{s}) \\;=\\; \n\\begin{bmatrix}\n\\mathbf{H}_1 & \\mathbf{0}\\\\\n\\mathbf{0} & \\mathbf{H}_2\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{s}_1\\\\ \\mathbf{s}_2\n\\end{bmatrix}\n\\;-\\;\n\\begin{bmatrix}\n\\mathbf{G}_1\\\\ \\mathbf{G}_2\n\\end{bmatrix}\\mathbf{d}\n\\;=\\;\n\\begin{bmatrix}\n\\mathbf{H}_1\\,\\mathbf{s}_1 - \\mathbf{G}_1\\,\\mathbf{d}_1\\\\[2pt]\n\\mathbf{H}_2\\,\\mathbf{s}_2 - \\mathbf{G}_2\\,\\mathbf{d}_2\n\\end{bmatrix}.\n$$\n使用 $\\mathbf{H}_e = A_e\\mathbf{C}^{-1}$、$\\mathbf{G}_e=A_e\\mathbf{B}_e$、$\\mathbf{s}_e=\\mathbf{C}\\boldsymbol{\\varepsilon}^{\\star}$ 和 $\\mathbf{B}_e\\mathbf{d}_e=\\boldsymbol{\\varepsilon}^{\\star}$，我们对每个单元 $e$ 得到，\n$$\n\\mathbf{H}_e\\,\\mathbf{s}_e - \\mathbf{G}_e\\,\\mathbf{d}_e\n\\;=\\; A_e\\,\\mathbf{C}^{-1}\\,(\\mathbf{C}\\boldsymbol{\\varepsilon}^{\\star}) - A_e\\,\\mathbf{B}_e\\,\\mathbf{d}_e\n\\;=\\; A_e\\,\\boldsymbol{\\varepsilon}^{\\star} - A_e\\,\\boldsymbol{\\varepsilon}^{\\star}\n\\;=\\; \\mathbf{0}.\n$$\n因此，\n$$\n\\mathbf{r}_s(\\mathbf{d},\\mathbf{s}) \\;=\\; \\mathbf{0}.\n$$\n设 $A_{\\Omega}$ 表示网格的总面积，此处 $A_{\\Omega} = 1$。所要求的无量纲标量指示器为\n$$\nR \\;=\\; \\dfrac{\\|\\mathbf{r}_s\\|_2}{A_{\\Omega}\\,\\|\\boldsymbol{\\varepsilon}^{\\star}\\|_2}\n\\;=\\; \\dfrac{\\|\\,\\mathbf{0}\\,\\|_2}{A_{\\Omega}\\,\\|\\boldsymbol{\\varepsilon}^{\\star}\\|_2}\n\\;=\\; 0.\n$$\n这验证了在全局线性位移场下，所选的具有常数应力和线性位移的 Hellinger–Reissner 混合有限元在双三角形网格上通过了分片检验：应力方程残差精确为零，无量纲指示器等于零。", "answer": "$$\\boxed{0}$$", "id": "2903888"}]}