{"hands_on_practices": [{"introduction": "磁致伸缩的根源在于晶体点阵结构。本练习将引导你完成一个基础性推导，它将受三次晶系对称性约束的磁弹性能与可观测的各向异性磁致伸缩常数 $\\lambda_{100}$ 和 $\\lambda_{111}$ 联系起来。通过这个练习，你将深入理解材料的晶体各向异性如何决定其宏观磁致形变行为，这是掌握磁弹性理论的基石。[@problem_id:2899529]", "problem": "一个单畴立方铁磁晶体受到一个饱和磁场的作用，该磁场使磁化强度沿着一个预定的晶向排列。考虑与立方对称性和小应变相符的最低阶磁弹性耦合，并假设立方晶体满足线性弹性。设 $\\alpha_{i}$ 表示磁化强度相对于立方轴的方向余弦，$\\varepsilon_{ij}$ 表示小应变张量。磁弹性能量密度对于 $\\varepsilon_{ij}$ 是双线性的，对于 $\\alpha_{i}$ 是二次的；弹性能量密度对于 $\\varepsilon_{ij}$ 是二次的。在没有外加应力的情况下，平衡应变使总能量最小化。纵向磁致伸缩定义为沿着方向余弦为 $\\beta_{i}$ 的方向上测量的长度分数变化，由 $\\varepsilon_{\\ell}=\\beta_{i}\\beta_{j}\\varepsilon_{ij}$ 给出。在饱和状态下，取纵向磁致伸缩的测量方向为磁化方向，即 $\\beta_{i}=\\alpha_{i}$。\n\n仅使用这些基本出发点和对称性，推导立方晶体中沿磁化方向的纵向饱和磁致伸缩的一般形式，并确定沿晶向 $[100]$、$[110]$ 和 $[111]$ 饱和时的纵向应变值。最终结果仅用常规饱和磁致伸缩常数 $\\lambda_{100}$ 和 $\\lambda_{111}$ 表示，它们分别定义为当磁化沿 $[100]$ 和 $[111]$ 方向时，沿相同方向测得的纵向饱和应变。将你的三个最终答案按 $[100]$、$[110]$、$[111]$ 的顺序以单个行向量的形式呈现。无需进行数值近似，最终答案中不应包含单位。", "solution": "所述问题具有科学依据、提法恰当、客观且内部一致。它是磁弹性理论中的一个标准推导。因此，我们可以开始求解。\n\n在没有外磁场但受到内部饱和场影响的情况下，晶体的总自由能密度 $U_T$ 是弹性能量密度 $U_{el}$ 和磁弹性能量密度 $U_{me}$ 的和。\n$$\nU_T = U_{el} + U_{me}\n$$\n对于立方晶体，在线性弹性（小应变 $\\varepsilon_{ij}$）的假设下，其弹性能量密度由下式给出：\n$$\nU_{el} = \\frac{1}{2} c_{11}(\\varepsilon_{11}^2 + \\varepsilon_{22}^2 + \\varepsilon_{33}^2) + c_{12}(\\varepsilon_{11}\\varepsilon_{22} + \\varepsilon_{22}\\varepsilon_{33} + \\varepsilon_{33}\\varepsilon_{11}) + 2 c_{44}(\\varepsilon_{12}^2 + \\varepsilon_{23}^2 + \\varepsilon_{31}^2)\n$$\n其中 $c_{11}$、$c_{12}$ 和 $c_{44}$ 是立方晶体的三个独立弹性劲度常数。与立方对称性相符的最低阶磁弹性能量密度，对磁化强度方向余弦 $\\alpha_i$ 是二次的，对应变 $\\varepsilon_{ij}$ 是双线性的，其表达式为：\n$$\nU_{me} = b_1(\\varepsilon_{11}\\alpha_1^2 + \\varepsilon_{22}\\alpha_2^2 + \\varepsilon_{33}\\alpha_3^2) + 2b_2(\\varepsilon_{12}\\alpha_1\\alpha_2 + \\varepsilon_{23}\\alpha_2\\alpha_3 + \\varepsilon_{31}\\alpha_3\\alpha_1)\n$$\n其中 $b_1$ 和 $b_2$ 是磁弹性耦合常数。\n\n在没有外加应力的情况下，晶体变形至平衡态，此时总能量密度 $U_T$ 相对于应变分量 $\\varepsilon_{ij}$ 达到最小值。该条件表示为：\n$$\n\\frac{\\partial U_T}{\\partial \\varepsilon_{ij}} = 0 \\quad \\text{for all } i, j\n$$\n我们计算应变张量的对角和非对角分量的这些导数。\n\n对于对角分量 ($i=j$)：\n$$\n\\frac{\\partial U_T}{\\partial \\varepsilon_{11}} = c_{11}\\varepsilon_{11} + c_{12}(\\varepsilon_{22} + \\varepsilon_{33}) + b_1\\alpha_1^2 = 0\n$$\n$$\n\\frac{\\partial U_T}{\\partial \\varepsilon_{22}} = c_{11}\\varepsilon_{22} + c_{12}(\\varepsilon_{11} + \\varepsilon_{33}) + b_1\\alpha_2^2 = 0\n$$\n$$\n\\frac{\\partial U_T}{\\partial \\varepsilon_{33}} = c_{11}\\varepsilon_{33} + c_{12}(\\varepsilon_{11} + \\varepsilon_{22}) + b_1\\alpha_3^2 = 0\n$$\n这是关于正应变 $\\varepsilon_{11}, \\varepsilon_{22}, \\varepsilon_{33}$ 的一个线性方程组。它可以通过对弹性常数矩阵求逆来求解。$\\varepsilon_{11}$ 的解（其他分量可通过指数的循环置换得到）为：\n$$\n\\varepsilon_{11} = -\\frac{b_1}{(c_{11}-c_{12})(c_{11}+2c_{12})} \\left[ (c_{11}+c_{12})\\alpha_1^2 - c_{12}(\\alpha_2^2 + \\alpha_3^2) \\right]\n$$\n使用归一化条件 $\\alpha_1^2 + \\alpha_2^2 + \\alpha_3^2 = 1$，我们可以将其简化为：\n$$\n\\varepsilon_{11} = -\\frac{b_1}{c_{11}-c_{12}} \\alpha_1^2 + \\frac{b_1 c_{12}}{(c_{11}-c_{12})(c_{11}+2c_{12})}\n$$\n根据对称性，我们有 $\\varepsilon_{22}$ 和 $\\varepsilon_{33}$ 的类似表达式：\n$$\n\\varepsilon_{22} = -\\frac{b_1}{c_{11}-c_{12}} \\alpha_2^2 + \\frac{b_1 c_{12}}{(c_{11}-c_{12})(c_{11}+2c_{12})}\n$$\n$$\n\\varepsilon_{33} = -\\frac{b_1}{c_{11}-c_{12}} \\alpha_3^2 + \\frac{b_1 c_{12}}{(c_{11}-c_{12})(c_{11}+2c_{12})}\n$$\n\n对于非对角分量 ($i \\neq j$)：\n$$\n\\frac{\\partial U_T}{\\partial \\varepsilon_{12}} = 4c_{44}\\varepsilon_{12} + 2b_2\\alpha_1\\alpha_2 = 0 \\implies \\varepsilon_{12} = -\\frac{b_2}{2c_{44}}\\alpha_1\\alpha_2\n$$\n对于其他剪切应变也类似：\n$$\n\\varepsilon_{23} = -\\frac{b_2}{2c_{44}}\\alpha_2\\alpha_3\n$$\n$$\n\\varepsilon_{31} = -\\frac{b_2}{2c_{44}}\\alpha_3\\alpha_1\n$$\n\n纵向磁致伸缩 $\\varepsilon_{\\ell}$ 是沿磁化方向测量的长度分数变化。根据问题定义，这意味着我们将测量的方向余弦 $\\beta_i$ 设置为等于磁化的方向余弦 $\\alpha_i$。\n$$\n\\varepsilon_{\\ell} = \\sum_{i,j=1}^3 \\beta_i \\beta_j \\varepsilon_{ij} = \\sum_{i,j=1}^3 \\alpha_i \\alpha_j \\varepsilon_{ij} = \\sum_{i=1}^3 \\alpha_i^2\\varepsilon_{ii} + 2\\sum_{i<j} \\alpha_i\\alpha_j\\varepsilon_{ij}\n$$\n代入推导出的平衡应变分量：\n$$\n\\varepsilon_{\\ell} = \\sum_{i=1}^3 \\alpha_i^2 \\left( -\\frac{b_1}{c_{11}-c_{12}} \\alpha_i^2 + \\frac{b_1 c_{12}}{(c_{11}-c_{12})(c_{11}+2c_{12})} \\right) + 2 \\left( \\alpha_1\\alpha_2(-\\frac{b_2}{2c_{44}}\\alpha_1\\alpha_2) + \\dots \\right)\n$$\n$$\n\\varepsilon_{\\ell} = -\\frac{b_1}{c_{11}-c_{12}} \\sum_i \\alpha_i^4 + \\frac{b_1 c_{12}}{(c_{11}-c_{12})(c_{11}+2c_{12})} \\sum_i \\alpha_i^2 - \\frac{b_2}{c_{44}} \\sum_{i<j} \\alpha_i^2\\alpha_j^2\n$$\n使用 $\\sum_i \\alpha_i^2 = 1$ 和恒等式 $\\sum_i \\alpha_i^4 = (\\sum_i \\alpha_i^2)^2 - 2\\sum_{i<j} \\alpha_i^2\\alpha_j^2 = 1 - 2(\\alpha_1^2\\alpha_2^2 + \\alpha_2^2\\alpha_3^2 + \\alpha_3^2\\alpha_1^2)$：\n$$\n\\varepsilon_{\\ell} = -\\frac{b_1}{c_{11}-c_{12}} (1 - 2\\Phi) + \\frac{b_1 c_{12}}{(c_{11}-c_{12})(c_{11}+2c_{12})} - \\frac{b_2}{c_{44}}\\Phi\n$$\n其中 $\\Phi = \\alpha_1^2\\alpha_2^2 + \\alpha_2^2\\alpha_3^2 + \\alpha_3^2\\alpha_1^2$。\n重新整理各项，我们将常数部分和与 $\\Phi$ 相关的部分收集起来：\n$$\n\\varepsilon_{\\ell} = \\left( -\\frac{b_1}{c_{11}-c_{12}} + \\frac{b_1 c_{12}}{(c_{11}-c_{12})(c_{11}+2c_{12})} \\right) + \\left( \\frac{2b_1}{c_{11}-c_{12}} - \\frac{b_2}{c_{44}} \\right) \\Phi\n$$\n该表达式的形式为 $\\varepsilon_{\\ell} = C_0 + C_1 \\Phi$。我们现在用常规饱和磁致伸缩常数 $\\lambda_{100}$ 和 $\\lambda_{111}$ 来表示常数 $C_0$ 和 $C_1$。\n\n根据定义，$\\lambda_{100}$ 是沿 $[100]$ 方向的纵向饱和应变，此时 $(\\alpha_1, \\alpha_2, \\alpha_3) = (1, 0, 0)$。在这种情况下，$\\Phi = 1^2 \\cdot 0^2 + 0^2 \\cdot 0^2 + 0^2 \\cdot 1^2 = 0$。\n$$\n\\lambda_{100} = \\varepsilon_{\\ell}([100]) = C_0 + C_1(0) = C_0\n$$\n根据定义，$\\lambda_{111}$ 是沿 $[111]$ 方向的纵向饱和应变，此时 $(\\alpha_1, \\alpha_2, \\alpha_3) = (1/\\sqrt{3}, 1/\\sqrt{3}, 1/\\sqrt{3})$。在这种情况下，$\\alpha_1^2 = \\alpha_2^2 = \\alpha_3^2 = 1/3$，且 $\\Phi = (1/3)(1/3) + (1/3)(1/3) + (1/3)(1/3) = 3/9 = 1/3$。\n$$\n\\lambda_{111} = \\varepsilon_{\\ell}([111]) = C_0 + C_1(1/3) = \\lambda_{100} + C_1/3\n$$\n由此，我们解出 $C_1$：$C_1 = 3(\\lambda_{111} - \\lambda_{100})$。\n将这些代入 $\\varepsilon_{\\ell}$ 的一般表达式：\n$$\n\\varepsilon_{\\ell} = \\lambda_{100} + 3(\\lambda_{111} - \\lambda_{100})(\\alpha_1^2\\alpha_2^2 + \\alpha_2^2\\alpha_3^2 + \\alpha_3^2\\alpha_1^2)\n$$\n这就是立方晶体纵向饱和磁致伸缩的一般形式。现在我们针对三个指定的方向计算其值。\n\n1.  磁化沿 $[100]$ 方向：\n    $(\\alpha_1, \\alpha_2, \\alpha_3) = (1, 0, 0)$。如前计算，$\\Phi = 0$。\n    $$\n    \\varepsilon_{\\ell,[100]} = \\lambda_{100} + 3(\\lambda_{111} - \\lambda_{100})(0) = \\lambda_{100}\n    $$\n\n2.  磁化沿 $[110]$ 方向：\n    归一化的方向余弦为 $(\\alpha_1, \\alpha_2, \\alpha_3) = (1/\\sqrt{2}, 1/\\sqrt{2}, 0)$。\n    因此，$\\alpha_1^2=1/2$，$\\alpha_2^2=1/2$，$\\alpha_3^2=0$。\n    $\\Phi = (1/2)(1/2) + (1/2)(0) + (0)(1/2) = 1/4$。\n    $$\n    \\varepsilon_{\\ell,[110]} = \\lambda_{100} + 3(\\lambda_{111} - \\lambda_{100})\\left(\\frac{1}{4}\\right) = \\lambda_{100} + \\frac{3}{4}\\lambda_{111} - \\frac{3}{4}\\lambda_{100} = \\frac{1}{4}\\lambda_{100} + \\frac{3}{4}\\lambda_{111}\n    $$\n\n3.  磁化沿 $[111]$ 方向：\n    $(\\alpha_1, \\alpha_2, \\alpha_3) = (1/\\sqrt{3}, 1/\\sqrt{3}, 1/\\sqrt{3})$。如前计算，$\\Phi = 1/3$。\n    $$\n    \\varepsilon_{\\ell,[111]} = \\lambda_{100} + 3(\\lambda_{111} - \\lambda_{100})\\left(\\frac{1}{3}\\right) = \\lambda_{100} + \\lambda_{111} - \\lambda_{100} = \\lambda_{111}\n    $$\n\n因此，所求的三个值为 $\\lambda_{100}$、$\\frac{1}{4}\\lambda_{100} + \\frac{3}{4}\\lambda_{111}$ 和 $\\lambda_{111}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\lambda_{100} & \\frac{1}{4}\\lambda_{100} + \\frac{3}{4}\\lambda_{111} & \\lambda_{111} \\end{pmatrix}}\n$$", "id": "2899529"}, {"introduction": "从理想单晶转向更实际的多晶材料场景，我们来探讨实验边界条件的影响。本练习将分析样品是自由形变（应力控制）还是被夹持固定（应变控制）时，所测量的应变会如何截然不同。通过应用连续介质力学中的本征应变概念，你将能够更精确地分析和理解决定磁致伸缩测量结果的关键外部因素。[@problem_id:2899525]", "problem": "一个细长的、均匀的多晶铁磁体被建模为一个各向同性的线性弹性固体，其杨氏模量为 $E$，泊松比为 $\\nu$。当置于一个使磁化强度严格沿样品轴向（取为 $z$ 方向）排列的强匀磁场中时，磁致伸缩对应变的贡献由一个本征应变（也称为相变应变）张量表示：\n$$\n\\epsilon^{\\mathrm{m}}_{ij}=\\frac{3}{2}\\lambda_{s}\\left(m_i m_j-\\frac{1}{3}\\delta_{ij}\\right),\n$$\n其中 $\\lambda_s$ 是各向同性饱和磁致伸缩常数，$\\delta_{ij}$ 是克罗内克（Kronecker）$\\delta$ 符号，$m_i$ 是磁化强度的方向余弦。在沿 $z$ 方向磁化（因此 $m_z=1, m_x=m_y=0$）的情况下，该表达式简化为：\n$$\n\\epsilon^{\\mathrm{m}}_{zz}=\\lambda_s,\\quad \\epsilon^{\\mathrm{m}}_{xx}=\\epsilon^{\\mathrm{m}}_{yy}=-\\frac{\\lambda_s}{2},\\quad \\epsilon^{\\mathrm{m}}_{ij}=0\\ \\text{for } i\\neq j.\n$$\n假设体积磁致伸缩可忽略不计，除各向同性 $\\lambda_s$ 外的磁弹性各向异性可忽略不计，并且磁化强度保持沿 $z$ 方向固定（不因应力而发生转动）。总小应变可加性地分解为：\n$$\n\\epsilon_{ij} = S_{ijkl}\\,\\sigma_{kl} + \\epsilon^{\\mathrm{m}}_{ij},\n$$\n其中 $S_{ijkl}$ 是各向同性固体的柔度张量。侧面无牵引力，因此 $\\sigma_{xx}=\\sigma_{yy}=0$，并且剪切分量消失。\n\n考虑在磁致伸缩测量中使用的两种实验边界条件类别：\n\n- 应力控制，此处取为零轴向外加应力：$\\sigma_{zz}=0$。\n- 应变控制，此处取为总轴向应变为零：$\\epsilon_{zz}=0$（轴向夹紧），侧面仍然无牵引力。\n\n将测得的纵向应变和横向应变分别记为 $\\epsilon_{\\parallel}=\\epsilon_{zz}$ 和 $\\epsilon_{\\perp}=\\epsilon_{xx}=\\epsilon_{yy}$。\n\n哪个选项正确地陈述了两种边界条件下测得的纵向和横向应变，并且与夹紧情况下产生的内部反作用应力相符？\n\nA. 应力控制 ($\\sigma_{zz}=0$)：$\\epsilon_{\\parallel}=\\lambda_s$, $\\epsilon_{\\perp}=-\\dfrac{\\lambda_s}{2}$。应变控制 ($\\epsilon_{zz}=0$)：$\\epsilon_{\\parallel}=0$, $\\epsilon_{\\perp}=\\nu \\lambda_s - \\dfrac{\\lambda_s}{2}$，伴有反作用应力 $\\sigma_{zz}=-E\\,\\lambda_s$。\n\nB. 应力控制 ($\\sigma_{zz}=0$)：$\\epsilon_{\\parallel}=\\dfrac{3}{2}\\lambda_s$, $\\epsilon_{\\perp}=-\\dfrac{\\lambda_s}{2}$。应变控制 ($\\epsilon_{zz}=0$)：$\\epsilon_{\\parallel}=0$, $\\epsilon_{\\perp}=-\\nu \\lambda_s - \\dfrac{\\lambda_s}{2}$，伴有反作用应力 $\\sigma_{zz}=+E\\,\\lambda_s$。\n\nC. 应力控制 ($\\sigma_{zz}=0$)：$\\epsilon_{\\parallel}=\\lambda_s$, $\\epsilon_{\\perp}=+\\dfrac{\\lambda_s}{2}$。应变控制 ($\\epsilon_{zz}=0$)：$\\epsilon_{\\parallel}=0$, $\\epsilon_{\\perp}=-\\dfrac{\\lambda_s}{2}$，无反作用应力。\n\nD. 应力控制 ($\\sigma_{zz}=0$)：$\\epsilon_{\\parallel}=\\lambda_s$, $\\epsilon_{\\perp}=-\\dfrac{\\lambda_s}{2}$。应变控制 ($\\epsilon_{zz}=0$)：$\\epsilon_{\\parallel}=0$, $\\epsilon_{\\perp}=0$，伴有反作用应力 $\\sigma_{zz}=0$。", "solution": "问题陈述已经过验证，被认为具有科学依据、提法恰当且内部一致。它为分析各向同性固体中的磁弹性提供了一个来自连续介质力学的标准框架。所有必需的本构关系、材料属性和边界条件均已明确给出，从而可以推导出唯一解。因此，我们可以着手求解。\n\n总应变 $\\epsilon_{ij}$、应力 $\\sigma_{kl}$ 和磁致伸缩本征应变 $\\epsilon^{\\mathrm{m}}_{ij}$ 之间的基本关系由以下加性分解给出：\n$$\n\\epsilon_{ij} = S_{ijkl}\\,\\sigma_{kl} + \\epsilon^{\\mathrm{m}}_{ij}\n$$\n对于各向同性的线性弹性固体，使用柔度张量 $S_{ijkl}$ 并以其分量形式写出方程，可得：\n$$\n\\epsilon_{xx} = \\frac{1}{E}\\left[\\sigma_{xx} - \\nu(\\sigma_{yy} + \\sigma_{zz})\\right] + \\epsilon^{\\mathrm{m}}_{xx}\n$$\n$$\n\\epsilon_{yy} = \\frac{1}{E}\\left[\\sigma_{yy} - \\nu(\\sigma_{xx} + \\sigma_{zz})\\right] + \\epsilon^{\\mathrm{m}}_{yy}\n$$\n$$\n\\epsilon_{zz} = \\frac{1}{E}\\left[\\sigma_{zz} - \\nu(\\sigma_{xx} + \\sigma_{yy})\\right] + \\epsilon^{\\mathrm{m}}_{zz}\n$$\n问题指明侧面无牵引力，这施加了条件 $\\sigma_{xx} = \\sigma_{yy} = 0$。沿 $z$ 轴磁化时的磁致伸缩本征应变分量由下式给出：\n$$\n\\epsilon^{\\mathrm{m}}_{zz} = \\lambda_s, \\quad \\epsilon^{\\mathrm{m}}_{xx} = \\epsilon^{\\mathrm{m}}_{yy} = -\\frac{\\lambda_s}{2}\n$$\n将这些条件代入本构方程可以显著简化它们。我们将纵向应变记为 $\\epsilon_{\\parallel} = \\epsilon_{zz}$，横向应变记为 $\\epsilon_{\\perp} = \\epsilon_{xx} = \\epsilon_{yy}$。\n方程变为：\n$$\n\\epsilon_{\\perp} = \\frac{1}{E}\\left[0 - \\nu(0 + \\sigma_{zz})\\right] - \\frac{\\lambda_s}{2} = -\\frac{\\nu}{E}\\sigma_{zz} - \\frac{\\lambda_s}{2} \\quad (1)\n$$\n$$\n\\epsilon_{\\parallel} = \\frac{1}{E}\\left[\\sigma_{zz} - \\nu(0 + 0)\\right] + \\lambda_s = \\frac{1}{E}\\sigma_{zz} + \\lambda_s \\quad (2)\n$$\n现在我们使用这些控制方程来分析两种指定的边界条件类别。\n\n**情况1：应力控制 ($\\sigma_{zz}=0$)**\n这种情况代表一个可以自由进行轴向变形的样品。我们将条件 $\\sigma_{zz}=0$ 代入方程 $(1)$ 和 $(2)$。\n\n对于纵向应变 $\\epsilon_{\\parallel}$：\n$$\n\\epsilon_{\\parallel} = \\frac{1}{E}(0) + \\lambda_s = \\lambda_s\n$$\n对于横向应变 $\\epsilon_{\\perp}$：\n$$\n\\epsilon_{\\perp} = -\\frac{\\nu}{E}(0) - \\frac{\\lambda_s}{2} = -\\frac{\\lambda_s}{2}\n$$\n因此，对于应力控制条件，测得的应变为 $\\epsilon_{\\parallel} = \\lambda_s$ 和 $\\epsilon_{\\perp} = -\\frac{\\lambda_s}{2}$。\n\n**情况2：应变控制 ($\\epsilon_{zz}=0$)**\n这种情况代表一个轴向被夹紧的样品，其总轴向应变被约束为零。这种约束将引起一个内部反作用应力 $\\sigma_{zz}$。\n\n从条件 $\\epsilon_{zz} = \\epsilon_{\\parallel} = 0$ 和方程 $(2)$：\n$$\n0 = \\frac{1}{E}\\sigma_{zz} + \\lambda_s\n$$\n求解反作用应力 $\\sigma_{zz}$：\n$$\n\\frac{1}{E}\\sigma_{zz} = -\\lambda_s \\implies \\sigma_{zz} = -E\\,\\lambda_s\n$$\n负号表示产生了一个压应力，以抵消磁致伸缩膨胀（假设 $\\lambda_s > 0$）。\n现在，我们将此反作用应力代入方程 $(1)$ 来求横向应变 $\\epsilon_{\\perp}$：\n$$\n\\epsilon_{\\perp} = -\\frac{\\nu}{E}\\sigma_{zz} - \\frac{\\lambda_s}{2} = -\\frac{\\nu}{E}(-E\\,\\lambda_s) - \\frac{\\lambda_s}{2}\n$$\n$$\n\\epsilon_{\\perp} = \\nu\\lambda_s - \\frac{\\lambda_s}{2}\n$$\n因此，对于应变控制条件，纵向应变根据定义为零，横向应变为 $\\epsilon_{\\perp} = \\nu\\lambda_s - \\frac{\\lambda_s}{2}$，内部轴向应力为 $\\sigma_{zz} = -E\\,\\lambda_s$。\n\n我们现在根据这些推导出的结果来评估每个给出的选项。\n\n**A. 应力控制 ($\\sigma_{zz}=0$)：$\\epsilon_{\\parallel}=\\lambda_s$, $\\epsilon_{\\perp}=-\\dfrac{\\lambda_s}{2}$。应变控制 ($\\epsilon_{zz}=0$)：$\\epsilon_{\\parallel}=0$, $\\epsilon_{\\perp}=\\nu \\lambda_s - \\dfrac{\\lambda_s}{2}$，伴有反作用应力 $\\sigma_{zz}=-E\\,\\lambda_s$。**\n该选项给出的结果与我们对两种情况（应力控制和应变控制）的推导完全一致。所有量——纵向应变、横向应变和反作用应力——都是正确的。\n结论：**正确**。\n\n**B. 应力控制 ($\\sigma_{zz}=0$)：$\\epsilon_{\\parallel}=\\dfrac{3}{2}\\lambda_s$, $\\epsilon_{\\perp}=-\\dfrac{\\lambda_s}{2}$。应变控制 ($\\epsilon_{zz}=0$)：$\\epsilon_{\\parallel}=0$, $\\epsilon_{\\perp}=-\\nu \\lambda_s - \\dfrac{\\lambda_s}{2}$，伴有反作用应力 $\\sigma_{zz}=+E\\,\\lambda_s$。**\n在应力控制情况下，纵向应变给出为 $\\epsilon_{\\parallel}=\\dfrac{3}{2}\\lambda_s$，这是不正确的；我们的推导表明 $\\epsilon_{\\parallel}=\\lambda_s$。此外，在应变控制情况下，反作用应力给出为 $\\sigma_{zz}=+E\\,\\lambda_s$，其符号不正确。\n结论：**不正确**。\n\n**C. 应力控制 ($\\sigma_{zz}=0$)：$\\epsilon_{\\parallel}=\\lambda_s$, $\\epsilon_{\\perp}=+\\dfrac{\\lambda_s}{2}$。应变控制 ($\\epsilon_{zz}=0$)：$\\epsilon_{\\parallel}=0$, $\\epsilon_{\\perp}=-\\dfrac{\\lambda_s}{2}$，无反作用应力。**\n在应力控制情况下，横向应变给出为 $\\epsilon_{\\perp}=+\\dfrac{\\lambda_s}{2}$，其符号不正确。一个沿一个轴向膨胀（对于 $\\lambda_s>0$）的材料必须在横向收缩以保持体积变化为零，这与本征应变张量是一致的。在夹紧情况下“无反作用应力”的说法也从根本上是错误的；约束一个有自然长度变化趋势（由于 $\\epsilon^{\\mathrm{m}}_{zz} \\ne 0$）的材料必然会引起应力。\n结论：**不正确**。\n\n**D. 应力控制 ($\\sigma_{zz}=0$)：$\\epsilon_{\\parallel}=\\lambda_s$, $\\epsilon_{\\perp}=-\\dfrac{\\lambda_s}{2}$。应变控制 ($\\epsilon_{zz}=0$)：$\\epsilon_{\\parallel}=0$, $\\epsilon_{\\perp}=0$，伴有反作用应力 $\\sigma_{zz}=0$。**\n应力控制部分是正确的。然而，对于应变控制情况，它声称 $\\sigma_{zz}=0$，这只有在 $\\lambda_s=0$ 时才成立。它还声称 $\\epsilon_{\\perp}=0$，这将要求 $\\nu\\lambda_s - \\frac{\\lambda_s}{2} = 0$，即 $\\nu = \\frac{1}{2}$，这对于所有弹性固体来说通常不成立。$\\sigma_{zz}=0$ 的断言与具有非零磁致伸缩的夹紧条件的前提相矛盾。\n结论：**不正确**。\n\n基于这一严谨的分析，只有选项 A 与应用于该问题的连续介质力学原理完全一致。", "answer": "$$\\boxed{A}$$", "id": "2899525"}, {"introduction": "在掌握了解析方法之后，我们进入强大的计算建模领域。本练习将指导你推导一个耦合磁力学问题的切线刚度矩阵，这是实现有限元（FEM）求解器的关键步骤。完成这个实践，你将学会如何将磁弹性的连续介质理论转化为数值算法，这是现代工程分析与设计中一项至关重要的技能。[@problem_id:2899518]", "problem": "您的任务是推导、离散化并实现一个二维小应变、静磁、线性磁弹耦合问题的一致线性化（切线算子）的耦合磁力学弱形式，该形式适用于有限元法中的 Newton–Raphson 解法。耦合场为位移矢量场 $\\mathbf{u} = [u_x,u_y]^T$ 和磁标势 $\\phi$，其中磁场 $\\mathbf{h} = \\nabla \\phi$。在平面应变条件下进行计算，并假设为线性本构行为，其中弹性刚度张量和磁导率张量为对称正定，线性磁弹耦合张量为常数。所有推导必须基于势能密度从第一性原理出发。\n\n请基于以下经过充分检验的事实和基本关系进行推导：\n- 小应变运动学：无穷小应变张量为 $\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^T)$，其 Voigt 表示法为 $\\boldsymbol{\\varepsilon}_v = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^T$，其中 $\\gamma_{xy} = 2\\varepsilon_{xy}$。\n- 无自由电流的静磁学：$\\nabla \\times \\mathbf{h} = \\mathbf{0}$，因此 $\\mathbf{h} = \\nabla \\phi$，且当从下述定义的能量势推导时，磁通密度为 $\\mathbf{b} = \\boldsymbol{\\mu}\\,\\mathbf{h} - \\mathbf{P}^T \\boldsymbol{\\varepsilon}_v$。\n- 使用自由能密度\n$$\n\\psi(\\boldsymbol{\\varepsilon}_v,\\mathbf{h}) = \\tfrac{1}{2}\\,\\boldsymbol{\\varepsilon}_v^T \\mathbf{C}\\,\\boldsymbol{\\varepsilon}_v + \\tfrac{1}{2}\\,\\mathbf{h}^T \\boldsymbol{\\mu}\\,\\mathbf{h} - \\boldsymbol{\\varepsilon}_v^T \\mathbf{P}\\,\\mathbf{h},\n$$\n其中 $\\mathbf{C}\\in\\mathbb{R}^{3\\times 3}$ 是平面应变弹性刚度，$\\boldsymbol{\\mu}\\in\\mathbb{R}^{2\\times 2}$ 是磁导率张量，$\\mathbf{P}\\in\\mathbb{R}^{3\\times 2}$ 是将磁场映射到 Voigt 应力空间的线性磁弹耦合矩阵。所有张量在单元域内均为常数。\n\n从 $\\psi$ 定义本构关系\n$$\n\\boldsymbol{\\sigma}_v = \\frac{\\partial \\psi}{\\partial \\boldsymbol{\\varepsilon}_v} = \\mathbf{C}\\,\\boldsymbol{\\varepsilon}_v - \\mathbf{P}\\,\\mathbf{h}, \\qquad\n\\mathbf{b} = \\frac{\\partial \\psi}{\\partial \\mathbf{h}} = \\boldsymbol{\\mu}\\,\\mathbf{h} - \\mathbf{P}^T \\boldsymbol{\\varepsilon}_v.\n$$\n耦合弱形式（内虚功）为\n$$\n\\int_{\\Omega} \\delta \\boldsymbol{\\varepsilon}_v^T \\boldsymbol{\\sigma}_v \\, \\mathrm{d}\\Omega = 0,\n\\qquad\n\\int_{\\Omega} (\\nabla \\delta \\phi)^T \\mathbf{b}\\, \\mathrm{d}\\Omega = 0,\n$$\n其中 $\\mathbf{h}=\\nabla \\phi$。使用单个厚度为 $t$ 的常应变三角形 (CST) 单元对域进行离散化，位移和标量势均采用线性形函数。设单元几何由节点 $i=1,2,3$ 的节点坐标 $(x_i,y_i)$ 指定。应变和应力使用 Voigt 表示法，并将位移自由度集合在向量 $\\mathbf{u}_e\\in\\mathbb{R}^{6}$ 中，节点标量势集合在 $\\boldsymbol{\\phi}_e\\in\\mathbb{R}^{3}$ 中。\n\n任务：\n1. 从自由能密度 $\\psi$ 出发，推导耦合弱形式，并获得适用于 Newton–Raphson 方法的一致线性化，明确标识出切线子矩阵\n$$\n\\mathbf{K}_{uu} = \\int_{\\Omega_e} \\mathbf{B}^T \\mathbf{C}\\, \\mathbf{B}\\,\\mathrm{d}\\Omega,\\quad\n\\mathbf{K}_{u\\phi} = -\\int_{\\Omega_e} \\mathbf{B}^T \\mathbf{P}\\,\\mathbf{G}\\,\\mathrm{d}\\Omega,\\quad\n\\mathbf{K}_{\\phi u} = -\\int_{\\Omega_e} \\mathbf{G}^T \\mathbf{P}^T \\mathbf{B}\\,\\mathrm{d}\\Omega,\\quad\n\\mathbf{K}_{\\phi\\phi} = \\int_{\\Omega_e} \\mathbf{G}^T \\boldsymbol{\\mu}\\, \\mathbf{G}\\,\\mathrm{d}\\Omega,\n$$\n其中 $\\mathbf{B}\\in\\mathbb{R}^{3\\times 6}$ 是平面应变下 CST 的常应变-位移矩阵，$\\mathbf{G}\\in\\mathbb{R}^{2\\times 3}$ 集合了标量势形函数的常梯度。\n2. 对于平面应变，使用拉梅参数 $\\lambda$ 和 $G$（其中 $\\lambda = \\dfrac{E\\,\\nu}{(1+\\nu)(1-2\\nu)}$ 和 $G = \\dfrac{E}{2(1+\\nu)}$），将弹性刚度矩阵 $\\mathbf{C}$ 表示为杨氏模量 $E$ 和泊松比 $\\nu$ 的函数，使得\n$$\n\\mathbf{C} = \\begin{bmatrix}\n\\lambda + 2G & \\lambda & 0 \\\\\n\\lambda & \\lambda + 2G & 0 \\\\\n0 & 0 & G\n\\end{bmatrix}.\n$$\n3. 对于单个 CST 单元，矩阵 $\\mathbf{B}$ 和 $\\mathbf{G}$ 在该单元上是常数。使用标准的 CST 公式：对于节点坐标 $(x_i,y_i)$，面积 $A$ 满足 $2A = x_1(y_2-y_3) + x_2(y_3-y_1) + x_3(y_1-y_2)$，且\n$$\nb_1 = y_2 - y_3,\\quad b_2 = y_3 - y_1,\\quad b_3 = y_1 - y_2, \\\\\nc_1 = x_3 - x_2,\\quad c_2 = x_1 - x_3,\\quad c_3 = x_2 - x_1,\n$$\n其中 $\\partial N_i/\\partial x = b_i/(2A)$ 和 $\\partial N_i/\\partial y = c_i/(2A)$。则\n$$\n\\mathbf{B} = \\frac{1}{2A}\n\\begin{bmatrix}\nb_1 & 0 & b_2 & 0 & b_3 & 0 \\\\\n0 & c_1 & 0 & c_2 & 0 & c_3 \\\\\nc_1 & b_1 & c_2 & b_2 & c_3 & b_3\n\\end{bmatrix},\\qquad\n\\mathbf{G} = \\frac{1}{2A}\n\\begin{bmatrix}\nb_1 & b_2 & b_3 \\\\\nc_1 & c_2 & c_3\n\\end{bmatrix}.\n$$\n4. 使用 CST 的单点积分（即对于常数矩阵是精确的）实现单元切线，因此每个积分简化为乘以单元“体积” $tA$：\n$$\n\\mathbf{K}_{uu} = tA\\, \\mathbf{B}^T \\mathbf{C}\\, \\mathbf{B},\\quad\n\\mathbf{K}_{u\\phi} = -tA\\, \\mathbf{B}^T \\mathbf{P}\\,\\mathbf{G},\\quad\n\\mathbf{K}_{\\phi u} = -tA\\, \\mathbf{G}^T \\mathbf{P}^T \\mathbf{B},\\quad\n\\mathbf{K}_{\\phi\\phi} = tA\\, \\mathbf{G}^T \\boldsymbol{\\mu}\\, \\mathbf{G}.\n$$\n\n数值实现要求：\n- 使用以下 4 组单元参数的测试套件。对于每种情况，输入包括以米为单位的节点坐标、以帕斯卡为单位的杨氏模量 $E$、无量纲的泊松比 $\\nu$、以米为单位的厚度 $t$、以亨利/米为单位的磁导率张量 $\\boldsymbol{\\mu}$，以及以帕斯卡·米/安培为单位的耦合矩阵 $\\mathbf{P}$（因此当 $\\mathbf{h}$ 的单位为安培/米时，$\\boldsymbol{\\sigma}_v = \\mathbf{C}\\boldsymbol{\\varepsilon}_v - \\mathbf{P}\\mathbf{h}$ 的单位为帕斯卡）。所有矩阵均以行主序给出。\n- 测试用例 1：\n  - 节点：$(x_1,y_1)=(0.0,0.0)$，$(x_2,y_2)=(1.0,0.0)$，$(x_3,y_3)=(0.0,1.0)$，单位：米。\n  - $E = 2.10\\times 10^{11}$ Pa, $\\nu = 0.30$, $t = 1.0\\times 10^{-2}$ m。\n  - $\\boldsymbol{\\mu} = \\begin{bmatrix} 6.0\\times 10^{-6} & 1.0\\times 10^{-6} \\\\ 1.0\\times 10^{-6} & 4.0\\times 10^{-6} \\end{bmatrix}$ H/m。\n  - $\\mathbf{P} = \\begin{bmatrix} 1.2\\times 10^{5} & -0.8\\times 10^{5} \\\\ 0.6\\times 10^{5} & 1.1\\times 10^{5} \\\\ 0.2\\times 10^{5} & -0.4\\times 10^{5} \\end{bmatrix}$ Pa·m/A。\n- 测试用例 2：\n  - 节点：$(x_1,y_1)=(0.0,0.0)$，$(x_2,y_2)=(1.0,0.0)$，$(x_3,y_3)=(0.0,1.0)$，单位：米。\n  - $E = 7.0\\times 10^{10}$ Pa, $\\nu = 0.33$, $t = 2.0\\times 10^{-2}$ m。\n  - $\\boldsymbol{\\mu} = \\begin{bmatrix} 5.0\\times 10^{-6} & 0.0 \\\\ 0.0 & 5.0\\times 10^{-6} \\end{bmatrix}$ H/m。\n  - $\\mathbf{P} = \\mathbf{0}_{3\\times 2}$ (耦合完全为零)。\n- 测试用例 3：\n  - 节点：$(x_1,y_1)=(0.0,0.0)$，$(x_2,y_2)=(0.8,0.0)$，$(x_3,y_3)=(0.0,0.6)$，单位：米。\n  - $E = 3.5\\times 10^{9}$ Pa, $\\nu = 0.499$, $t = 5.0\\times 10^{-3}$ m。\n  - $\\boldsymbol{\\mu} = \\begin{bmatrix} 2.0\\times 10^{-6} & 0.0 \\\\ 0.0 & 7.0\\times 10^{-6} \\end{bmatrix}$ H/m。\n  - $\\mathbf{P} = \\begin{bmatrix} 5.0\\times 10^{4} & 3.0\\times 10^{4} \\\\ 1.0\\times 10^{4} & 2.0\\times 10^{4} \\\\ -2.0\\times 10^{4} & 1.0\\times 10^{4} \\end{bmatrix}$ Pa·m/A。\n- 测试用例 4：\n  - 节点：$(x_1,y_1)=(0.0,0.0)$，$(x_2,y_2)=(2.0,0.0)$，$(x_3,y_3)=(0.0,0.2)$，单位：米。\n  - $E = 1.10\\times 10^{11}$ Pa, $\\nu = 0.25$, $t = 1.5\\times 10^{-2}$ m。\n  - $\\boldsymbol{\\mu} = \\begin{bmatrix} 3.0\\times 10^{-6} & -0.5\\times 10^{-6} \\\\ -0.5\\times 10^{-6} & 3.5\\times 10^{-6} \\end{bmatrix}$ H/m。\n  - $\\mathbf{P} = \\begin{bmatrix} -9.0\\times 10^{4} & 4.0\\times 10^{4} \\\\ 2.0\\times 10^{4} & -7.0\\times 10^{4} \\\\ 3.0\\times 10^{4} & 3.0\\times 10^{4} \\end{bmatrix}$ Pa·m/A。\n\n计算与输出：\n- 对于每个测试用例，使用上述公式计算单元切线子矩阵 $\\mathbf{K}_{uu}\\in\\mathbb{R}^{6\\times 6}$、$\\mathbf{K}_{\\phi\\phi}\\in\\mathbb{R}^{3\\times 3}$ 和 $\\mathbf{K}_{u\\phi}\\in\\mathbb{R}^{6\\times 3}$。\n- 对于每个测试用例，报告以下三个标量值：\n  1. $\\mathbf{K}_{uu}$ 的弗罗贝尼乌斯范数，单位为牛顿/米 (N/m)，四舍五入到六位小数。\n  2. $\\mathbf{K}_{\\phi\\phi}$ 的弗罗贝尼乌斯范数，单位为亨利 (H)，四舍五入到六位小数。\n  3. $\\mathbf{K}_{u\\phi}$ 的弗罗贝尼乌斯范数，单位为牛顿/安培 (N/A)，四舍五入到六位小数。\n- 最终输出格式：您的程序应生成一行输出，其中包含按顺序串接的所有测试用例的结果，形式为方括号内以逗号分隔的列表。例如，输出应具有以下格式：\n  $$\n  [r_{1,1}, r_{1,2}, r_{1,3}, r_{2,1}, r_{2,2}, r_{2,3}, r_{3,1}, r_{3,2}, r_{3,3}, r_{4,1}, r_{4,2}, r_{4,3}],\n  $$\n  其中 $r_{k,1}$、$r_{k,2}$、$r_{k,3}$ 是测试用例 $k=1,2,3,4$ 的三个所求范数，每个都四舍五入到六位小数并以指定单位表示。", "solution": "问题陈述经过评估，是有效的。这是一个在计算磁力学领域定义明确、具备科学依据的问题，为获得唯一解提供了所有必要的定义、常数和数据。我们将着手进行推导和实现。\n\n目标是推导耦合线性磁弹问题的相容切线刚度矩阵，并实现其对常应变三角形（CST）单元的计算。推导从给定的单位体积自由能密度 $\\psi$ 开始。\n\n自由能密度由下式给出：\n$$\n\\psi(\\boldsymbol{\\varepsilon}_v,\\mathbf{h}) = \\tfrac{1}{2}\\,\\boldsymbol{\\varepsilon}_v^T \\mathbf{C}\\,\\boldsymbol{\\varepsilon}_v + \\tfrac{1}{2}\\,\\mathbf{h}^T \\boldsymbol{\\mu}\\,\\mathbf{h} - \\boldsymbol{\\varepsilon}_v^T \\mathbf{P}\\,\\mathbf{h}\n$$\n其中 $\\boldsymbol{\\varepsilon}_v$ 是 Voigt 表示法下的应变矢量，$\\mathbf{h}$ 是磁场，$\\mathbf{C}$ 是弹性刚度矩阵，$\\boldsymbol{\\mu}$ 是磁导率张量，$\\mathbf{P}$ 是磁弹耦合矩阵。问题陈述指出 $\\mathbf{C}$ 和 $\\boldsymbol{\\mu}$ 是对称正定的。\n\nVoigt 应力矢量 $\\boldsymbol{\\sigma}_v$ 和磁通密度矢量 $\\mathbf{b}$ 的本构关系从 $\\psi$ 推导得出：\n$$\n\\boldsymbol{\\sigma}_v = \\frac{\\partial \\psi}{\\partial \\boldsymbol{\\varepsilon}_v} = \\mathbf{C}\\,\\boldsymbol{\\varepsilon}_v - \\mathbf{P}\\,\\mathbf{h}\n$$\n$$\n\\mathbf{b} = \\frac{\\partial \\psi}{\\partial \\mathbf{h}} = \\boldsymbol{\\mu}\\,\\mathbf{h} - \\mathbf{P}^T \\boldsymbol{\\varepsilon}_v\n$$\n这些关系在场变量 $\\boldsymbol{\\varepsilon}_v$ 和 $\\mathbf{h}$ 中是线性的。\n\n控制方程以弱形式表示，代表了耦合系统的虚功原理。对于位移的任意容许变分 $\\delta\\mathbf{u}$ 和磁势的任意容许变分 $\\delta\\phi$，我们有：\n$$\n\\int_{\\Omega} \\delta \\boldsymbol{\\varepsilon}_v^T \\boldsymbol{\\sigma}_v \\, \\mathrm{d}\\Omega = 0 \\quad \\text{(力学平衡)}\n$$\n$$\n\\int_{\\Omega} (\\nabla \\delta \\phi)^T \\mathbf{b}\\, \\mathrm{d}\\Omega = 0 \\quad \\text{(磁高斯定律)}\n$$\n其中 $\\delta\\boldsymbol{\\varepsilon}_v$ 是对应于 $\\delta\\mathbf{u}$ 的虚应变，$\\nabla\\delta\\phi$ 是虚磁场。\n\n我们使用有限元法对场进行离散化。对于单个单元，位移场 $\\mathbf{u}$ 和标量势场 $\\phi$ 分别从其节点值 $\\mathbf{u}_e \\in \\mathbb{R}^6$ 和 $\\boldsymbol{\\phi}_e \\in \\mathbb{R}^3$ 插值得到：\n$$\n\\mathbf{u}(\\mathbf{x}) = \\mathbf{N}_u(\\mathbf{x}) \\mathbf{u}_e\n$$\n$$\n\\phi(\\mathbf{x}) = \\mathbf{N}_\\phi(\\mathbf{x}) \\boldsymbol{\\phi}_e\n$$\n这里，$\\mathbf{N}_u$ 和 $\\mathbf{N}_\\phi$ 是形函数矩阵。对于具有线性形函数的 CST 单元，应变-位移关系和势的梯度变为：\n$$\n\\boldsymbol{\\varepsilon}_v(\\mathbf{x}) = \\mathbf{B} \\mathbf{u}_e\n$$\n$$\n\\mathbf{h}(\\mathbf{x}) = \\nabla\\phi = \\mathbf{G} \\boldsymbol{\\phi}_e\n$$\n矩阵 $\\mathbf{B} \\in \\mathbb{R}^{3\\times 6}$ 和 $\\mathbf{G} \\in \\mathbb{R}^{2\\times 3}$ 在单元内部是常数。变分也类似地离散化：$\\delta\\boldsymbol{\\varepsilon}_v = \\mathbf{B}\\delta\\mathbf{u}_e$ 和 $\\nabla\\delta\\phi = \\mathbf{G}\\delta\\boldsymbol{\\phi}_e$。\n\n将本构关系和运动学关系代入弱形式，我们得到单元残差向量 $\\mathbf{R}_u$ 和 $\\mathbf{R}_\\phi$：\n$$\n\\mathbf{R}_u(\\mathbf{u}_e, \\boldsymbol{\\phi}_e) = \\int_{\\Omega_e} \\mathbf{B}^T \\boldsymbol{\\sigma}_v \\, \\mathrm{d}\\Omega = \\int_{\\Omega_e} \\mathbf{B}^T (\\mathbf{C} \\mathbf{B} \\mathbf{u}_e - \\mathbf{P} \\mathbf{G} \\boldsymbol{\\phi}_e) \\, \\mathrm{d}\\Omega\n$$\n$$\n\\mathbf{R}_\\phi(\\mathbf{u}_e, \\boldsymbol{\\phi}_e) = \\int_{\\Omega_e} \\mathbf{G}^T \\mathbf{b} \\, \\mathrm{d}\\Omega = \\int_{\\Omega_e} \\mathbf{G}^T (\\boldsymbol{\\mu} \\mathbf{G} \\boldsymbol{\\phi}_e - \\mathbf{P}^T \\mathbf{B} \\mathbf{u}_e) \\, \\mathrm{d}\\Omega\n$$\n\n对于 Newton-Raphson 迭代求解方案，需要切线刚度矩阵 $\\mathbf{K}$。它是残差向量 $\\mathbf{R} = [\\mathbf{R}_u^T, \\mathbf{R}_\\phi^T]^T$ 相对于节点未知量向量 $\\mathbf{d} = [\\mathbf{u}_e^T, \\boldsymbol{\\phi}_e^T]^T$ 的导数。切线矩阵是一个 $9 \\times 9$ 的分块矩阵：\n$$\n\\mathbf{K} = \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{d}} = \\begin{bmatrix} \\frac{\\partial \\mathbf{R}_u}{\\partial \\mathbf{u}_e} & \\frac{\\partial \\mathbf{R}_u}{\\partial \\boldsymbol{\\phi}_e} \\\\ \\frac{\\partial \\mathbf{R}_\\phi}{\\partial \\mathbf{u}_e} & \\frac{\\partial \\mathbf{R}_\\phi}{\\partial \\boldsymbol{\\phi}_e} \\end{bmatrix} = \\begin{bmatrix} \\mathbf{K}_{uu} & \\mathbf{K}_{u\\phi} \\\\ \\mathbf{K}_{\\phi u} & \\mathbf{K}_{\\phi\\phi} \\end{bmatrix}\n$$\n由于本构关系是线性的，导数是常数。进行微分可以得到子矩阵：\n$$\n\\mathbf{K}_{uu} = \\frac{\\partial \\mathbf{R}_u}{\\partial \\mathbf{u}_e} = \\int_{\\Omega_e} \\mathbf{B}^T \\mathbf{C} \\mathbf{B} \\, \\mathrm{d}\\Omega\n$$\n$$\n\\mathbf{K}_{u\\phi} = \\frac{\\partial \\mathbf{R}_u}{\\partial \\boldsymbol{\\phi}_e} = \\int_{\\Omega_e} \\mathbf{B}^T (-\\mathbf{P} \\mathbf{G}) \\, \\mathrm{d}\\Omega = -\\int_{\\Omega_e} \\mathbf{B}^T \\mathbf{P} \\mathbf{G} \\, \\mathrm{d}\\Omega\n$$\n$$\n\\mathbf{K}_{\\phi u} = \\frac{\\partial \\mathbf{R}_\\phi}{\\partial \\mathbf{u}_e} = \\int_{\\Omega_e} \\mathbf{G}^T (-\\mathbf{P}^T \\mathbf{B}) \\, \\mathrm{d}\\Omega = -\\int_{\\Omega_e} \\mathbf{G}^T \\mathbf{P}^T \\mathbf{B} \\, \\mathrm{d}\\Omega\n$$\n$$\n\\mathbf{K}_{\\phi\\phi} = \\frac{\\partial \\mathbf{R}_\\phi}{\\partial \\boldsymbol{\\phi}_e} = \\int_{\\Omega_e} \\mathbf{G}^T \\boldsymbol{\\mu} \\mathbf{G} \\, \\mathrm{d}\\Omega\n$$\n这些表达式与问题陈述中提供的一致。由于势 $\\psi$ 的存在，$\\mathbf{K}_{\\phi u} = \\mathbf{K}_{u\\phi}^T$ 成立，因此总切线矩阵 $\\mathbf{K}$ 是对称的。\n\n对于厚度为 $t$ 的 CST 单元，每个表达式中的被积函数在单元域 $\\Omega_e$ 上都是常数。积分简化为乘以单元的面积-厚度乘积 $t A_e$，其中 $A_e$ 是三角形的面积。\n$$\n\\mathbf{K}_{uu} = t A_e \\, \\mathbf{B}^T \\mathbf{C} \\mathbf{B}\n$$\n$$\n\\mathbf{K}_{u\\phi} = -t A_e \\, \\mathbf{B}^T \\mathbf{P} \\mathbf{G}\n$$\n$$\n\\mathbf{K}_{\\phi\\phi} = t A_e \\, \\mathbf{G}^T \\boldsymbol{\\mu} \\mathbf{G}\n$$\n\n实现要求为指定的测试用例计算这些矩阵。我们首先从节点坐标 $(x_i, y_i)$ 计算几何因子 $b_i, c_i$ 和单元面积 $A_e$，然后构建矩阵 $\\mathbf{B}$ 和 $\\mathbf{G}$。平面应变弹性刚度矩阵 $\\mathbf{C}$ 从杨氏模量 $E$ 和泊松比 $\\nu$ 构建。最后，组装切线子矩阵并计算它们的弗罗贝尼乌斯范数。该过程在提供的 Python 代码中实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Frobenius norms of the tangent submatrices for several\n    magnetoelastic CST element test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"nodes\": np.array([[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]]),\n            \"E\": 2.10e11,\n            \"nu\": 0.30,\n            \"t\": 1.0e-2,\n            \"mu\": np.array([[6.0e-6, 1.0e-6], [1.0e-6, 4.0e-6]]),\n            \"P\": np.array([[1.2e5, -0.8e5], [0.6e5, 1.1e5], [0.2e5, -0.4e5]])\n        },\n        {\n            \"nodes\": np.array([[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]]),\n            \"E\": 7.0e10,\n            \"nu\": 0.33,\n            \"t\": 2.0e-2,\n            \"mu\": np.array([[5.0e-6, 0.0], [0.0, 5.0e-6]]),\n            \"P\": np.zeros((3, 2))\n        },\n        {\n            \"nodes\": np.array([[0.0, 0.0], [0.8, 0.0], [0.0, 0.6]]),\n            \"E\": 3.5e9,\n            \"nu\": 0.499,\n            \"t\": 5.0e-3,\n            \"mu\": np.array([[2.0e-6, 0.0], [0.0, 7.0e-6]]),\n            \"P\": np.array([[5.0e4, 3.0e4], [1.0e4, 2.0e4], [-2.0e4, 1.0e4]])\n        },\n        {\n            \"nodes\": np.array([[0.0, 0.0], [2.0, 0.0], [0.0, 0.2]]),\n            \"E\": 1.10e11,\n            \"nu\": 0.25,\n            \"t\": 1.5e-2,\n            \"mu\": np.array([[3.0e-6, -0.5e-6], [-0.5e-6, 3.5e-6]]),\n            \"P\": np.array([[-9.0e4, 4.0e4], [2.0e4, -7.0e4], [3.0e4, 3.0e4]])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        nodes = case[\"nodes\"]\n        E = case[\"E\"]\n        nu = case[\"nu\"]\n        t = case[\"t\"]\n        mu_tensor = case[\"mu\"]\n        P_matrix = case[\"P\"]\n\n        x1, y1 = nodes[0]\n        x2, y2 = nodes[1]\n        x3, y3 = nodes[2]\n\n        # Calculate element area and geometric factors\n        area = 0.5 * (x1 * (y2 - y3) + x2 * (y3 - y1) + x3 * (y1 - y2))\n        vol = t * area\n\n        b1 = y2 - y3\n        b2 = y3 - y1\n        b3 = y1 - y2\n        c1 = x3 - x2\n        c2 = x1 - x3\n        c3 = x2 - x1\n\n        # Construct B matrix (strain-displacement)\n        B = (1.0 / (2.0 * area)) * np.array([\n            [b1, 0, b2, 0, b3, 0],\n            [0, c1, 0, c2, 0, c3],\n            [c1, b1, c2, b2, c3, b3]\n        ])\n\n        # Construct G matrix (potential gradient)\n        G = (1.0 / (2.0 * area)) * np.array([\n            [b1, b2, b3],\n            [c1, c2, c3]\n        ])\n\n        # Construct C matrix (plane strain elastic stiffness)\n        lame_G = E / (2.0 * (1.0 + nu))\n        lame_lambda = (E * nu) / ((1.0 + nu) * (1.0 - 2.0 * nu))\n        C = np.array([\n            [lame_lambda + 2 * lame_G, lame_lambda, 0],\n            [lame_lambda, lame_lambda + 2 * lame_G, 0],\n            [0, 0, lame_G]\n        ])\n\n        # Calculate tangent submatrices\n        # K_uu [N/m]\n        K_uu = vol * B.T @ C @ B\n        # K_uphi [N/A]\n        K_uphi = -vol * B.T @ P_matrix @ G\n        # K_phiphi [H]\n        K_phiphi = vol * G.T @ mu_tensor @ G\n\n        # Calculate Frobenius norms\n        norm_K_uu = np.linalg.norm(K_uu, 'fro')\n        norm_K_phiphi = np.linalg.norm(K_phiphi, 'fro')\n        norm_K_uphi = np.linalg.norm(K_uphi, 'fro')\n        \n        results.append(f\"{norm_K_uu:.6f}\")\n        results.append(f\"{norm_K_phiphi:.6f}\")\n        results.append(f\"{norm_K_uphi:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2899518"}]}