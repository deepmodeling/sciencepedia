{"hands_on_practices": [{"introduction": "深入研究变形固体的热力学，首先需要量化力学功如何转化为内能和耗散。本练习旨在阐明应力功率密度的核心作用，即它是在连续介质力学中表示单位体积内力做功速率的物理量，其表达式为 $\\boldsymbol{\\sigma}:\\mathbf{D}$。通过一个具体的计算 [@problem_id:2925232]，您将学习如何从给定的速度梯度 $\\mathbf{L}$ 中分离出变形率张量 $\\mathbf{D}$，并将其与柯西应力张量 $\\boldsymbol{\\sigma}$ 结合，以确定驱动热力学状态演化的机械能输入率。", "problem": "在当前构型的一点处，一个非极性、均匀可变形固体的均匀等温运动，由一个具有恒定速度梯度张量 $\\mathbf{L}$ 的速度场来表征。设同一点处的 Cauchy 应力张量为 $\\boldsymbol{\\sigma}$。在可变形固体热力学和 Clausius–Duhem 不等式的背景下，能够对自由能变化率和内耗散产生贡献的机械功率输入是内应力功率密度。\n\n从线性动量平衡、角动量平衡和热力学第一定律出发，推导用 $\\boldsymbol{\\sigma}$ 和速度梯度表示的内应力功率密度的局部表达式，并确保该表达式满足客观性原理。\n\n然后，对于给定的场\n$$\n\\mathbf{L}=\\begin{pmatrix}\n0.5 & 2.0 & 0.0\\\\\n-1.0 & 0.3 & 0.0\\\\\n0.0 & 0.0 & -0.8\n\\end{pmatrix}\\ \\text{s}^{-1},\\qquad\n\\boldsymbol{\\sigma}=\\begin{pmatrix}\n120 & 50 & 0\\\\\n50 & 80 & 0\\\\\n0 & 0 & 60\n\\end{pmatrix}\\ \\text{MPa},\n$$\n计算对称变形率张量 $\\mathbf{D}=\\tfrac{1}{2}\\left(\\mathbf{L}+\\mathbf{L}^{\\top}\\right)$，并求出该点处的内应力功率密度。\n\n将最终的应力功率密度以 $\\text{kW}\\,\\text{m}^{-3}$ 为单位表示，并将答案四舍五入到四位有效数字。", "solution": "目标是获得内应力功率密度的局部表达式，然后对给定的张量进行求值。我们从基本平衡定律和热力学第一定律出发。\n\n1. 运动学和内力功率：\n- 设 $\\mathbf{v}(\\mathbf{x},t)$ 是当前构型中的速度场，其速度梯度为 $\\mathbf{L}=\\nabla \\mathbf{v}$。$\\mathbf{L}$ 的对称部分是变形率张量 $\\mathbf{D}=\\tfrac{1}{2}\\left(\\mathbf{L}+\\mathbf{L}^{\\top}\\right)$，反对称部分是自旋张量 $\\mathbf{W}=\\tfrac{1}{2}\\left(\\mathbf{L}-\\mathbf{L}^{\\top}\\right)$，因此有 $\\mathbf{L}=\\mathbf{D}+\\mathbf{W}$。\n\n2. 全局机械功率平衡：\n- 对于一个占据体积 $V$、边界为 $\\partial V$ 的物体 $\\mathcal{B}$，外力的机械功率等于动能的变化率加上内部消耗的功率，后者在热力学第一定律中予以考虑。面力和体力的功率为\n$$\n\\mathcal{P}_{\\text{ext}}=\\int_{\\partial V}\\mathbf{t}\\cdot \\mathbf{v}\\,\\mathrm{d}A+\\int_{V}\\rho\\,\\mathbf{b}\\cdot \\mathbf{v}\\,\\mathrm{d}V,\n$$\n其中 $\\mathbf{t}=\\boldsymbol{\\sigma}\\,\\mathbf{n}$ 是面力矢量 (Cauchy 定理)，$\\rho$ 是密度，$\\mathbf{b}$ 是单位质量的体力。\n\n3. 内力功率的局部化：\n- 对面积分功率项使用散度定理：\n$$\n\\int_{\\partial V}\\mathbf{t}\\cdot \\mathbf{v}\\,\\mathrm{d}A=\\int_{\\partial V}(\\boldsymbol{\\sigma}\\mathbf{n})\\cdot \\mathbf{v}\\,\\mathrm{d}A=\\int_{V}\\nabla\\cdot(\\boldsymbol{\\sigma}^{\\top}\\mathbf{v})\\,\\mathrm{d}V.\n$$\n展开散度项：\n$$\n\\nabla\\cdot(\\boldsymbol{\\sigma}^{\\top}\\mathbf{v})=(\\nabla\\cdot \\boldsymbol{\\sigma}^{\\top})\\cdot \\mathbf{v}+\\boldsymbol{\\sigma}^{\\top}:\\nabla \\mathbf{v}=(\\nabla\\cdot \\boldsymbol{\\sigma})\\cdot \\mathbf{v}+\\boldsymbol{\\sigma}:\\nabla \\mathbf{v},\n$$\n这里我们利用了 $\\boldsymbol{\\sigma}^{\\top}:\\nabla \\mathbf{v}=\\boldsymbol{\\sigma}:\\nabla \\mathbf{v}$。然后，利用当前构型下的线性动量平衡方程，\n$$\n\\nabla\\cdot \\boldsymbol{\\sigma}+\\rho\\,\\mathbf{b}=\\rho\\,\\mathbf{a},\n$$\n可以将外力功率重排为\n$$\n\\mathcal{P}_{\\text{ext}}=\\int_{V}\\rho\\,\\mathbf{a}\\cdot \\mathbf{v}\\,\\mathrm{d}V+\\int_{V}\\boldsymbol{\\sigma}:\\nabla \\mathbf{v}\\,\\mathrm{d}V.\n$$\n第一项是动能的变化率，剩下的第二项代表内应力功率：\n$$\n\\mathcal{P}_{\\text{int}}=\\int_{V}\\boldsymbol{\\sigma}:\\nabla \\mathbf{v}\\,\\mathrm{d}V.\n$$\n因此，局部内应力功率密度为\n$$\np_{\\text{int}}=\\boldsymbol{\\sigma}:\\mathbf{L}.\n$$\n\n4. 客观性和对称性：\n- 对于非极性材料，角动量平衡意味着 Cauchy 应力张量是对称的，即 $\\boldsymbol{\\sigma}=\\boldsymbol{\\sigma}^{\\top}$。将 $\\mathbf{L}$ 分解为 $\\mathbf{L}=\\mathbf{D}+\\mathbf{W}$，其中 $\\mathbf{D}=\\mathbf{D}^{\\top}$ 且 $\\mathbf{W}=-\\mathbf{W}^{\\top}$。那么\n$$\np_{\\text{int}}=\\boldsymbol{\\sigma}:\\mathbf{L}=\\boldsymbol{\\sigma}:(\\mathbf{D}+\\mathbf{W})=\\boldsymbol{\\sigma}:\\mathbf{D}+\\boldsymbol{\\sigma}:\\mathbf{W}.\n$$\n由于 $\\boldsymbol{\\sigma}$ 是对称的而 $\\mathbf{W}$ 是反对称的，它们的双点积为零：\n$$\n\\boldsymbol{\\sigma}:\\mathbf{W}=\\operatorname{tr}(\\boldsymbol{\\sigma}^{\\top}\\mathbf{W})=\\operatorname{tr}(\\boldsymbol{\\sigma}\\mathbf{W})=\\operatorname{tr}((\\boldsymbol{\\sigma}\\mathbf{W})^{\\top})=\\operatorname{tr}(\\mathbf{W}^{\\top}\\boldsymbol{\\sigma}^{\\top})=\\operatorname{tr}(-\\mathbf{W}\\boldsymbol{\\sigma})=-\\operatorname{tr}(\\boldsymbol{\\sigma}\\mathbf{W})=0.\n$$\n因此，客观的局部内应力功率密度为\n$$\np_{\\text{int}}=\\boldsymbol{\\sigma}:\\mathbf{D}.\n$$\n这就是出现在局部 Clausius–Duhem 不等式右侧的机械功率输入项，它驱动自由能的变化率和耗散。\n\n5. 对给定的 $\\mathbf{L}$ 计算 $\\mathbf{D}$：\n- 计算 $\\mathbf{D}=\\tfrac{1}{2}\\left(\\mathbf{L}+\\mathbf{L}^{\\top}\\right)$。首先，计算 $\\mathbf{L}^{\\top}$：\n$$\n\\mathbf{L}^{\\top}=\\begin{pmatrix}\n0.5 & -1.0 & 0.0\\\\\n2.0 & 0.3 & 0.0\\\\\n0.0 & 0.0 & -0.8\n\\end{pmatrix}\\ \\text{s}^{-1}.\n$$\n那么，\n$$\n\\mathbf{L}+\\mathbf{L}^{\\top}=\\begin{pmatrix}\n1.0 & 1.0 & 0.0\\\\\n1.0 & 0.6 & 0.0\\\\\n0.0 & 0.0 & -1.6\n\\end{pmatrix}\\ \\text{s}^{-1},\n\\qquad\n\\mathbf{D}=\\frac{1}{2}\\begin{pmatrix}\n1.0 & 1.0 & 0.0\\\\\n1.0 & 0.6 & 0.0\\\\\n0.0 & 0.0 & -1.6\n\\end{pmatrix}=\\begin{pmatrix}\n0.5 & 0.5 & 0.0\\\\\n0.5 & 0.3 & 0.0\\\\\n0.0 & 0.0 & -0.8\n\\end{pmatrix}\\ \\text{s}^{-1}.\n$$\n\n6. $p_{\\text{int}}=\\boldsymbol{\\sigma}:\\mathbf{D}$ 的求值：\n- 已知\n$$\n\\boldsymbol{\\sigma}=\\begin{pmatrix}\n120 & 50 & 0\\\\\n50 & 80 & 0\\\\\n0 & 0 & 60\n\\end{pmatrix}\\ \\text{MPa},\\qquad\n\\mathbf{D}=\\begin{pmatrix}\n0.5 & 0.5 & 0.0\\\\\n0.5 & 0.3 & 0.0\\\\\n0.0 & 0.0 & -0.8\n\\end{pmatrix}\\ \\text{s}^{-1},\n$$\n双点积为\n$$\np_{\\text{int}}=\\sum_{i=1}^{3}\\sum_{j=1}^{3}\\sigma_{ij}D_{ij}\n=120\\cdot 0.5+50\\cdot 0.5+50\\cdot 0.5+80\\cdot 0.3+60\\cdot(-0.8).\n$$\n逐项计算：\n$$\n120\\cdot 0.5=60,\\quad 50\\cdot 0.5=25,\\quad 50\\cdot 0.5=25,\\quad 80\\cdot 0.3=24,\\quad 60\\cdot(-0.8)=-48.\n$$\n求和，\n$$\np_{\\text{int}}=60+25+25+24-48=86\\ \\text{MPa}\\,\\text{s}^{-1}.\n$$\n使用 $1\\ \\text{MPa}=10^{6}\\ \\text{Pa}=10^{6}\\ \\text{N}\\,\\text{m}^{-2}$ 和 $\\text{N}\\,\\text{m}^{-2}\\cdot \\text{s}^{-1}=\\text{W}\\,\\text{m}^{-3}$，我们得到\n$$\np_{\\text{int}}=86\\times 10^{6}\\ \\text{W}\\,\\text{m}^{-3}.\n$$\n转换为千瓦每立方米：\n$$\np_{\\text{int}}=86\\times 10^{6}\\ \\text{W}\\,\\text{m}^{-3} = 86 \\times 10^3\\ \\text{kW}\\,\\text{m}^{-3} = 8.6\\times 10^{4}\\ \\text{kW}\\,\\text{m}^{-3}.\n$$\n四舍五入到四位有效数字，得到\n$$\np_{\\text{int}}=8.600\\times 10^{4}\\ \\text{kW}\\,\\text{m}^{-3}.\n$$", "answer": "$$\\boxed{8.600 \\times 10^{4}}$$", "id": "2925232"}, {"introduction": "克劳修斯-杜亨不等式的一个关键推论是，非弹性过程必然伴随着能量耗散。这个练习将这一抽象概念与一个可观察的物理现象——塑性变形过程中的绝热温升——联系起来。您将应用热力学第一定律来模拟在塑性流动过程中，大部分不可恢复的机械功如何通过泰勒-奎尼系数 $\\beta$ 所描述的比例转化为热量，从而导致材料温度升高 [@problem_id:2925224]，并在此过程中考虑比热对温度的依赖性。", "problem": "一根细长的多晶金属棒在小应变下承受均匀单轴单调加载，导致塑性流动。假设整个加载过程为绝热条件（无热传导，无外部热量供应），所有场量空间均匀，且相对于塑性耗散，热弹性耦合可以忽略不计。材料密度为 $ \\rho = 7850 \\,\\mathrm{kg\\,m^{-3}}$。比热容依赖于绝对温度 $ \\theta $，其关系式为 $ c(\\theta) = c_{0} + c_{1}\\,\\theta $，其中 $ c_{0} = 400 \\,\\mathrm{J\\,kg^{-1}\\,K^{-1}} $ 且 $ c_{1} = 0.10 \\,\\mathrm{J\\,kg^{-1}\\,K^{-2}} $。塑性功率的一个恒定的 Taylor–Quinney 分数 $ \\beta = 0.90 $ 瞬间转化为热量，剩余部分则存储于内变量中。初始温度为 $ \\theta_{0} = 300 \\,\\mathrm{K} $。\n\n在单轴塑性流动中，Cauchy 应力与累积塑性应变 $ \\varepsilon^{p} $ 的关系遵循线性各向同性硬化定律：\n$$\n\\sigma(\\varepsilon^{p}) = \\sigma_{y0} + H\\,\\varepsilon^{p},\n$$\n其中 $ \\sigma_{y0} = 4.00 \\times 10^{8} \\,\\mathrm{Pa} $ 且 $ H = 1.00 \\times 10^{9} \\,\\mathrm{Pa} $。该金属棒从零塑性应变加载至 $ \\varepsilon^{p}_{f} = 0.100 $。\n\n使用变形固体的热力学第一定律和 Clausius–Duhem 不等式，推导由塑性耗散和随温度变化的比热容控制的绝热温度演化过程，并计算达到 $ \\varepsilon^{p}_{f} $ 时的最终均匀温度 $ \\theta_{f} $。请将您的最终数值答案 $ \\theta_{f} $ 以开尔文为单位表示，并四舍五入到四位有效数字。", "solution": "该问题陈述经核实具有科学依据，提法恰当且客观。它对金属固体中因塑性变形引起的绝热温升这一材料力学中的公认现象进行了自洽的描述。所有必要的数据、本构关系和边界条件都已给出，并且没有内部矛盾或不符合科学的论断。该问题是热力学第一定律在非弹性固体中的一个标准应用。\n\n推导从连续介质的热力学第一定律开始，该定律指出，内能的变化率等于输入的机械功率加上热量供应率。其局部形式表示为：\n$$\n\\rho \\dot{e} = \\boldsymbol{\\sigma} : \\mathbf{d} - \\nabla \\cdot \\mathbf{q} + \\rho r\n$$\n其中 $\\rho$ 是质量密度，$e$ 是比内能，$\\dot{e}$ 是其物质时间导数，$\\boldsymbol{\\sigma}$ 是 Cauchy 应力张量，$\\mathbf{d}$ 是变形率张量，$\\mathbf{q}$ 是热流矢量，$r$ 是比外部热量供应率。\n\n问题指定了几个简化条件：\n1.  **绝热过程**：与外界没有热交换，意味着没有外部热量供应（$r=0$）且没有热传导（$\\mathbf{q}=\\mathbf{0}$，这意味着 $\\nabla \\cdot \\mathbf{q} = 0$）。\n2.  **均匀变形**：所有场量在空间上是均匀的。这与 $\\nabla \\cdot \\mathbf{q} = 0$ 一致。\n3.  **单轴加载**：应力和应变张量可以有效地视为标量 $\\sigma$ 和 $\\varepsilon$。单位体积的机械功率从 $\\boldsymbol{\\sigma} : \\mathbf{d}$ 简化为 $\\sigma \\dot{\\varepsilon}$。\n4.  **可忽略的热弹性效应**：由于弹性变形引起的温度变化被忽略。\n\n在这些条件下，第一定律简化为：\n$$\n\\rho \\dot{e} = \\sigma \\dot{\\varepsilon}\n$$\n总应变率 $\\dot{\\varepsilon}$ 是弹性和塑性应变率之和，即 $\\dot{\\varepsilon} = \\dot{\\varepsilon}^{e} + \\dot{\\varepsilon}^{p}$。因此机械功率为 $\\sigma \\dot{\\varepsilon} = \\sigma \\dot{\\varepsilon}^{e} + \\sigma \\dot{\\varepsilon}^{p}$。这部分功率被分配为可恢复弹性储能的变化率、与塑性变形相关的储能率（例如，位错结构）以及以热量形式耗散的能量率。\n\n问题陈述，塑性功率 $\\sigma \\dot{\\varepsilon}^{p}$ 的一部分（比例为 $\\beta$）转化为热量。这个单位体积的耗散功率 $\\mathcal{D}_{p}$ 是温度升高的来源：\n$$\n\\mathcal{D}_{p} = \\beta \\sigma \\dot{\\varepsilon}^{p}\n$$\n单位体积热能的变化率由 $\\rho c(\\theta) \\dot{\\theta}$ 给出，其中 $c(\\theta)$ 是恒定变形下随温度变化的比热容。将产热率与热能增加率相等，得到温度演化的控制方程：\n$$\n\\rho c(\\theta) \\dot{\\theta} = \\beta \\sigma(\\varepsilon^{p}) \\dot{\\varepsilon}^{p}\n$$\n由于加载是单调的，$\\theta$ 和 $\\varepsilon^{p}$ 都是时间的函数。我们可以通过将方程写成微分形式来消除时间依赖性：\n$$\n\\rho c(\\theta) d\\theta = \\beta \\sigma(\\varepsilon^{p}) d\\varepsilon^{p}\n$$\n为了找到与最终塑性应变 $\\varepsilon^{p}_{f}$ 对应的最终温度 $\\theta_{f}$，我们将此方程从初始状态 $(\\theta_{0}, \\varepsilon^{p}_{0}=0)$ 积分到最终状态 $(\\theta_{f}, \\varepsilon^{p}_{f})$：\n$$\n\\int_{\\theta_{0}}^{\\theta_{f}} \\rho c(\\theta) d\\theta = \\int_{0}^{\\varepsilon^{p}_{f}} \\beta \\sigma(\\varepsilon^{p}) d\\varepsilon^{p}\n$$\n代入给定的 $c(\\theta)$ 和 $\\sigma(\\varepsilon^{p})$ 的本构定律：\n$$\nc(\\theta) = c_{0} + c_{1}\\theta\n$$\n$$\n\\sigma(\\varepsilon^{p}) = \\sigma_{y0} + H\\varepsilon^{p}\n$$\n积分变为：\n$$\n\\int_{\\theta_{0}}^{\\theta_{f}} \\rho (c_{0} + c_{1}\\theta) d\\theta = \\int_{0}^{\\varepsilon^{p}_{f}} \\beta (\\sigma_{y0} + H\\varepsilon^{p}) d\\varepsilon^{p}\n$$\n对两边进行积分得到：\n$$\n\\rho \\left[ c_{0}\\theta + \\frac{1}{2}c_{1}\\theta^{2} \\right]_{\\theta_{0}}^{\\theta_{f}} = \\beta \\left[ \\sigma_{y0}\\varepsilon^{p} + \\frac{1}{2}H(\\varepsilon^{p})^{2} \\right]_{0}^{\\varepsilon^{p}_{f}}\n$$\n$$\n\\rho \\left( c_{0}(\\theta_{f} - \\theta_{0}) + \\frac{c_{1}}{2}(\\theta_{f}^{2} - \\theta_{0}^{2}) \\right) = \\beta \\left( \\sigma_{y0}\\varepsilon^{p}_{f} + \\frac{H}{2}(\\varepsilon^{p}_{f})^{2} \\right)\n$$\n这个方程是关于最终温度 $\\theta_{f}$ 的二次方程。我们可以将其重新整理为标准形式 $A\\theta_{f}^{2} + B\\theta_{f} + C = 0$：\n$$\n\\left(\\frac{\\rho c_{1}}{2}\\right)\\theta_{f}^{2} + (\\rho c_{0})\\theta_{f} - \\left( \\rho c_{0}\\theta_{0} + \\frac{\\rho c_{1}}{2}\\theta_{0}^{2} + \\beta \\left[\\sigma_{y0}\\varepsilon^{p}_{f} + \\frac{H}{2}(\\varepsilon^{p}_{f})^{2}\\right] \\right) = 0\n$$\n让我们计算代表单位体积总产热量的项的值，$Q_{p} = \\beta \\int_{0}^{\\varepsilon^{p}_{f}} \\sigma d\\varepsilon^{p}$：\n$$\nQ_{p} = \\beta \\left( \\sigma_{y0}\\varepsilon^{p}_{f} + \\frac{H}{2}(\\varepsilon^{p}_{f})^{2} \\right)\n$$\n$$\nQ_{p} = 0.90 \\left( (4.00 \\times 10^{8} \\,\\mathrm{Pa})(0.100) + \\frac{1.00 \\times 10^{9} \\,\\mathrm{Pa}}{2}(0.100)^{2} \\right)\n$$\n$$\nQ_{p} = 0.90 \\left( 4.00 \\times 10^{7} \\,\\mathrm{J\\,m^{-3}} + 5.00 \\times 10^{6} \\,\\mathrm{J\\,m^{-3}} \\right) = 0.90 \\left( 4.50 \\times 10^{7} \\,\\mathrm{J\\,m^{-3}} \\right) = 4.05 \\times 10^{7} \\,\\mathrm{J\\,m^{-3}}\n$$\n现在我们计算 $\\theta_{f}$ 的二次方程的系数：\n$A = \\frac{\\rho c_{1}}{2} = \\frac{(7850 \\,\\mathrm{kg\\,m^{-3}})(0.10 \\,\\mathrm{J\\,kg^{-1}\\,K^{-2}})}{2} = 392.5 \\,\\mathrm{J\\,m^{-3}\\,K^{-2}}$\n$B = \\rho c_{0} = (7850 \\,\\mathrm{kg\\,m^{-3}})(400 \\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}) = 3.14 \\times 10^{6} \\,\\mathrm{J\\,m^{-3}\\,K^{-1}}$\n常数项 $C$ 为：\n$C = -\\left( \\rho c_{0}\\theta_{0} + \\frac{\\rho c_{1}}{2}\\theta_{0}^{2} + Q_{p} \\right)$\n$C = -\\left( (3.14 \\times 10^{6})(300) + (392.5)(300)^{2} + 4.05 \\times 10^{7} \\right)$\n$C = -\\left( 9.42 \\times 10^{8} + 3.5325 \\times 10^{7} + 4.05 \\times 10^{7} \\right) = -1.017825 \\times 10^{9} \\,\\mathrm{J\\,m^{-3}}$\n二次方程为：\n$$\n392.5 \\theta_{f}^{2} + (3.14 \\times 10^{6})\\theta_{f} - (1.017825 \\times 10^{9}) = 0\n$$\n使用求根公式 $\\theta_{f} = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$ 求解 $\\theta_{f}$，并选择具有物理意义的正根：\n$$\n\\theta_{f} = \\frac{-(3.14 \\times 10^{6}) + \\sqrt{(3.14 \\times 10^{6})^{2} - 4(392.5)(-1.017825 \\times 10^{9})}}{2(392.5)}\n$$\n$$\n\\theta_{f} = \\frac{-3.14 \\times 10^{6} + \\sqrt{9.8596 \\times 10^{12} + 1.59798525 \\times 10^{12}}}{785}\n$$\n$$\n\\theta_{f} = \\frac{-3.14 \\times 10^{6} + \\sqrt{1.145758525 \\times 10^{13}}}{785} = \\frac{-3.14 \\times 10^{6} + 3.3849055 \\times 10^{6}}{785}\n$$\n$$\n\\theta_{f} = \\frac{244905.5}{785} \\approx 312.000637 \\,\\mathrm{K}\n$$\n将最终答案四舍五入到四位有效数字得到 $\\theta_{f} = 312.0 \\,\\mathrm{K}$。", "answer": "$$\n\\boxed{312.0}\n$$", "id": "2925224"}, {"introduction": "这个高阶实践将带您进入计算材料力学的核心领域，在这里，复杂的本构关系需要通过数值方法求解。您将为一个一维粘塑性材料模型推导并实现一个数值积分算法（即所谓的“返回映射算法”） [@problem_id:2925217]。通过证明离散形式的克劳修斯-杜亨不等式得以满足，您将亲身体验到，坚实的理论框架（如基于凸耗散势的广义标准材料模型）如何直接保证数值解在任意时间步长下的稳定性和物理真实性。", "problem": "考虑一个等温、小应变的一维广义标准材料 (GSM)，其具有一个表示累积塑性应变的内变量。设单位参考体积的亥姆霍兹自由能密度为\n$$\n\\psi(\\varepsilon,p) = \\tfrac{1}{2} E (\\varepsilon - p)^2 + \\tfrac{1}{2} H p^2,\n$$\n其中 $E>0$ 是弹性模量，$H \\ge 0$ 是线性各向同性硬化模量，$\\varepsilon$ 是总应变，$p$ 是塑性应变。与 $p$ 共轭的热力学力为\n$$\nX = -\\frac{\\partial \\psi}{\\partial p}(\\varepsilon,p) = E(\\varepsilon - p) - Hp.\n$$\n假设耗散势（也称为速率势）是凸的、正常的和下半连续的，由下式给出\n$$\n\\Phi(\\dot{p}) = \\sigma_y |\\dot{p}| + \\tfrac{1}{2} \\eta \\dot{p}^2,\n$$\n其中 $\\sigma_y \\ge 0$ 是屈服应力，$\\eta > 0$ 是粘性系数。等温过程的 Clausius–Duhem 不等式可表示为\n$$\n\\mathcal{D} = \\sigma \\,\\dot{\\varepsilon} - \\dot{\\psi} \\ge 0,\n$$\n其中 Cauchy 应力为 $\\sigma = \\partial \\psi/\\partial \\varepsilon = E(\\varepsilon - p)$。\n\n您将利用 $\\Phi$ 的凸性，分析用于粘塑性演化 $p(t)$ 的后向欧拉时间积分格式的数值稳定性。\n\n任务：\n\n- 从广义标准材料的微观力平衡和 $\\Phi$ 的凸性出发，证明在时间步 $n \\to n+1$、时间增量为 $\\Delta t > 0$ 的后向欧拉时间离散化可以表示为变分包含关系\n$$\nX_{n+1} \\in \\partial \\Phi\\!\\left( \\frac{p_{n+1}-p_n}{\\Delta t} \\right),\n$$\n其中 $X_{n+1} = -\\partial \\psi/\\partial p(\\varepsilon_{n+1},p_{n+1})$，并且等价地表示为凸最小化问题\n$$\np_{n+1} \\in \\underset{p \\in \\mathbb{R}}{\\arg\\min}\\ \\left\\{ \\psi(\\varepsilon_{n+1},p) + \\Delta t\\, \\Phi\\!\\left(\\frac{p - p_n}{\\Delta t}\\right) \\right\\}。\n$$\n\n- 仅使用 $\\psi$ 关于 $\\varepsilon$ 的凸性和 $\\Phi$ 的凸性，证明离散 Clausius–Duhem 不等式\n$$\n\\mathcal{D}_{n+1}^{\\mathrm{disc}} := \\sigma_{n+1}(\\varepsilon_{n+1} - \\varepsilon_n) - \\big(\\psi_{n+1} - \\psi_n\\big) \\ge 0,\n$$\n其中 $\\sigma_{n+1} = E(\\varepsilon_{n+1} - p_{n+1})$，$\\psi_{n+1} = \\psi(\\varepsilon_{n+1},p_{n+1})$，$\\psi_n = \\psi(\\varepsilon_n,p_n)$。\n\n- 针对给定的 $\\psi$ 和 $\\Phi$，通过求解凸最小化问题的最优性条件，导出一个显式的闭式更新 $p_{n+1} = \\mathcal{T}(E,H,\\sigma_y,\\eta,\\Delta t,\\varepsilon_{n+1},p_n)$，该更新仅用在 $n$ 时刻的已知量和 $\\varepsilon_{n+1}$ 表示。您的推导必须从第一性原理（凸分析和次微分）出发，并且不得假设任何预先制定的返回映射公式。\n\n- 实现一个程序，对于每个提供的测试用例，使用您导出的闭式更新计算 $p_{n+1}$，然后计算 $\\sigma_{n+1}$、$\\psi_n$、$\\psi_{n+1}$，并评估离散耗散 $\\mathcal{D}_{n+1}^{\\mathrm{disc}}$。该程序必须返回一个布尔值，说明不等式 $\\mathcal{D}_{n+1}^{\\mathrm{disc}} \\ge 0$ 是否在以下定义的数值容差内成立：\n$$\n\\tau = 10^{-8}\\,\\max\\!\\big(1,\\ |\\psi_n|,\\ |\\psi_{n+1}|\\big).\n$$\n如果 $\\mathcal{D}_{n+1}^{\\mathrm{disc}} \\ge -\\tau$ 则返回 $\\mathrm{True}$，否则返回 $\\mathrm{False}$。\n\n使用以下测试套件（所有量均采用国际单位制，应变为无量纲，时间单位为秒）：\n\n- 测试 $1$：$(E,H,\\sigma_y,\\eta,\\Delta t,\\varepsilon_n,\\varepsilon_{n+1},p_n) = (210\\times 10^{9},\\ 1\\times 10^{9},\\ 250\\times 10^{6},\\ 1\\times 10^{9},\\ 1,\\ 0,\\ 10^{-4},\\ 0)$。\n- 测试 $2$：$(E,H,\\sigma_y,\\eta,\\Delta t,\\varepsilon_n,\\varepsilon_{n+1},p_n) = (210\\times 10^{9},\\ 0.5\\times 10^{9},\\ 200\\times 10^{6},\\ 1\\times 10^{9},\\ 1,\\ 0,\\ 2\\times 10^{-3},\\ 0)$。\n- 测试 $3$：$(E,H,\\sigma_y,\\eta,\\Delta t,\\varepsilon_n,\\varepsilon_{n+1},p_n) = (100\\times 10^{9},\\ 0,\\ 100\\times 10^{6},\\ 1\\times 10^{9},\\ 1,\\ 0,\\ 10^{-3},\\ 0)$。\n- 测试 $4$：$(E,H,\\sigma_y,\\eta,\\Delta t,\\varepsilon_n,\\varepsilon_{n+1},p_n) = (50\\times 10^{9},\\ 0,\\ 20\\times 10^{6},\\ 10^{10},\\ 10,\\ 10^{-3},\\ 10^{-3},\\ 0)$。\n- 测试 $5$：$(E,H,\\sigma_y,\\eta,\\Delta t,\\varepsilon_n,\\varepsilon_{n+1},p_n) = (70\\times 10^{9},\\ 2\\times 10^{9},\\ 150\\times 10^{6},\\ 10^{8},\\ 1000,\\ 0,\\ 5\\times 10^{-3},\\ 0)$。\n- 测试 $6$：$(E,H,\\sigma_y,\\eta,\\Delta t,\\varepsilon_n,\\varepsilon_{n+1},p_n) = (200\\times 10^{9},\\ 1\\times 10^{9},\\ 250\\times 10^{6},\\ 1\\times 10^{9},\\ 0.1,\\ 3\\times 10^{-3},\\ 3\\times 10^{-3},\\ 2\\times 10^{-4})$。\n\n最终输出格式：\n\n- 您的程序应生成一行输出，其中包含测试 $1$–$6$ 的布尔结果，形式为用逗号分隔并包含在方括号中的列表，例如，$[{\\rm True},{\\rm False},\\dots]$。", "solution": "问题陈述是有效的。它在科学上基于广义标准材料理论，是适定的，并提供了一套完整且一致的定义和数据。我们可以开始求解。根据要求，解答分为三个部分。\n\n### 第1部分：变分包含关系与凸最小化问题的等价性\n\n我们被要求证明后向欧拉离散化的微观力平衡（表示为变分包含关系）与一个凸最小化问题之间的等价性。\n\n广义标准材料 (GSM) 的本构框架假定内变量的演化由微观力平衡控制。与内变量 $p$ 共轭的热力学力 $X$ 必须与从凸耗散势 $\\Phi(\\dot{p})$ 导出的耗散阻力相平衡。这通过最大耗散原理来表达，从而得到变分包含关系：\n$$\nX(t) \\in \\partial \\Phi(\\dot{p}(t))\n$$\n其中 $\\partial \\Phi$ 表示凸函数 $\\Phi$ 的次微分。\n\n应用从时间 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 的后向欧拉时间离散化格式，我们将塑性应变率近似为 $\\dot{p}(t_{n+1}) \\approx \\frac{p_{n+1} - p_n}{\\Delta t}$，其中 $p_n = p(t_n)$ 且 $p_{n+1} = p(t_{n+1})$。所有依赖于状态的量都在时间 $t_{n+1}$ 进行评估。因此，离散微观力平衡变为：\n$$\nX_{n+1} \\in \\partial \\Phi\\left( \\frac{p_{n+1}-p_n}{\\Delta t} \\right)\n$$\n其中 $X_{n+1} = X(\\varepsilon_{n+1}, p_{n+1}) = -\\frac{\\partial \\psi}{\\partial p}(\\varepsilon_{n+1}, p_{n+1})$。这即是问题陈述中给出的变分包含关系。\n\n接下来，我们证明这个包含关系是给定凸最小化问题的一阶最优性条件。考虑在步骤 $n+1$ 要最小化的增量势泛函：\n$$\nJ(p) = \\psi(\\varepsilon_{n+1},p) + \\Delta t\\, \\Phi\\left(\\frac{p - p_n}{\\Delta t}\\right)\n$$\n我们寻求 $p_{n+1}$ 使得 $p_{n+1} \\in \\underset{p \\in \\mathbb{R}}{\\arg\\min}\\ J(p)$。亥姆霍兹自由能 $\\psi(\\varepsilon, p) = \\frac{1}{2} E (\\varepsilon - p)^2 + \\frac{1}{2} H p^2$ 关于 $p$ 是凸的，因为其二阶导数 $\\frac{\\partial^2 \\psi}{\\partial p^2} = E+H \\ge 0$ (因为 $E>0, H\\ge0$)。耗散势 $\\Phi$ 已知为凸函数。因此，泛函 $J(p)$ 是凸函数的和，其本身关于 $p$ 也是凸的。\n\n对于一个凸函数，在 $p_{n+1}$ 处取得最小值的充分必要条件是 $J$ 在 $p_{n+1}$ 处的次微分包含零元素：\n$$\n0 \\in \\partial J(p_{n+1})\n$$\n使用次微分的求和法则，我们有：\n$$\n\\partial J(p) = \\frac{\\partial}{\\partial p} \\psi(\\varepsilon_{n+1},p) + \\partial_p \\left[ \\Delta t\\, \\Phi\\left(\\frac{p - p_n}{\\Delta t}\\right) \\right]\n$$\n对于第二项，我们应用次微分的链式法则。令 $g(p) = \\frac{p-p_n}{\\Delta t}$。其导数为 $\\frac{dg}{dp} = \\frac{1}{\\Delta t}$。链式法则给出 $\\partial_p[\\Phi(g(p))] = \\frac{dg}{dp} \\partial\\Phi(g(p)) = \\frac{1}{\\Delta t}\\partial\\Phi\\left(\\frac{p-p_n}{\\Delta t}\\right)$。将此代入 $\\partial J(p)$ 的表达式中，得到：\n$$\n\\partial J(p) = \\frac{\\partial \\psi}{\\partial p}(\\varepsilon_{n+1},p) + \\Delta t \\left( \\frac{1}{\\Delta t} \\partial\\Phi\\left(\\frac{p - p_n}{\\Delta t}\\right) \\right) = \\frac{\\partial \\psi}{\\partial p}(\\varepsilon_{n+1},p) + \\partial\\Phi\\left(\\frac{p - p_n}{\\Delta t}\\right)\n$$\n因此，最优性条件 $0 \\in \\partial J(p_{n+1})$ 变为：\n$$\n0 \\in \\frac{\\partial \\psi}{\\partial p}(\\varepsilon_{n+1},p_{n+1}) + \\partial\\Phi\\left(\\frac{p_{n+1} - p_n}{\\Delta t}\\right)\n$$\n整理此表达式，我们得到：\n$$\n-\\frac{\\partial \\psi}{\\partial p}(\\varepsilon_{n+1},p_{n+1}) \\in \\partial\\Phi\\left(\\frac{p_{n+1} - p_n}{\\Delta t}\\right)\n$$\n根据热力学力 $X_{n+1} = -\\frac{\\partial \\psi}{\\partial p}(\\varepsilon_{n+1},p_{n+1})$ 的定义，我们得到变分包含关系 $X_{n+1} \\in \\partial \\Phi\\left( \\frac{p_{n+1}-p_n}{\\Delta t} \\right)$。这建立了最小化问题与离散化微观力平衡之间的等价性，从而证明了该公式的合理性。\n\n### 第2部分：离散Clausius-Duhem不等式的证明\n\n我们必须证明离散 Clausius–Duhem 不等式，这表明了后向欧拉格式的无条件热力学稳定性。需要证明的不等式是：\n$$\n\\mathcal{D}_{n+1}^{\\mathrm{disc}} := \\sigma_{n+1}(\\varepsilon_{n+1} - \\varepsilon_n) - \\big(\\psi_{n+1} - \\psi_n\\big) \\ge 0\n$$\n证明依赖于自由能 $\\psi(\\varepsilon,p)$ 和耗散势 $\\Phi(\\dot{p})$ 的凸性。\n\n首先，函数 $\\psi(\\varepsilon, p)$ 是关于 $(\\varepsilon, p)$ 的联合凸函数。这是因为其 Hessian 矩阵 $\\nabla^2\\psi = \\begin{pmatrix} E & -E \\\\ -E & E+H \\end{pmatrix}$ 对于 $E>0$ 和 $H\\ge0$ 是半正定的，因为其行列式为 $EH \\ge 0$ 且其迹为 $2E+H > 0$。可微函数的凸性定义指出，对于任意两点 $(\\varepsilon_{n+1}, p_{n+1})$ 和 $(\\varepsilon_n, p_n)$：\n$$\n\\psi(\\varepsilon_n, p_n) \\ge \\psi(\\varepsilon_{n+1}, p_{n+1}) + \\frac{\\partial \\psi}{\\partial \\varepsilon}(\\varepsilon_{n+1}, p_{n+1})(\\varepsilon_n - \\varepsilon_{n+1}) + \\frac{\\partial \\psi}{\\partial p}(\\varepsilon_{n+1}, p_{n+1})(p_n - p_{n+1})\n$$\n使用定义式 $\\psi_n = \\psi(\\varepsilon_n, p_n)$，$\\psi_{n+1} = \\psi(\\varepsilon_{n+1}, p_{n+1})$，$\\sigma_{n+1} = \\frac{\\partial \\psi}{\\partial \\varepsilon}(\\varepsilon_{n+1}, p_{n+1})$，以及 $X_{n+1} = -\\frac{\\partial \\psi}{\\partial p}(\\varepsilon_{n+1}, p_{n+1})$，该不等式变为：\n$$\n\\psi_n \\ge \\psi_{n+1} + \\sigma_{n+1}(\\varepsilon_n - \\varepsilon_{n+1}) - X_{n+1}(p_n - p_{n+1})\n$$\n重新整理此表达式以匹配 $\\mathcal{D}_{n+1}^{\\mathrm{disc}}$ 的形式：\n$$\n\\sigma_{n+1}(\\varepsilon_{n+1} - \\varepsilon_n) - (\\psi_{n+1} - \\psi_n) \\ge X_{n+1}(p_{n+1} - p_n)\n$$\n左侧恰好是 $\\mathcal{D}_{n+1}^{\\mathrm{disc}}$。因此我们有：\n$$\n\\mathcal{D}_{n+1}^{\\mathrm{disc}} \\ge X_{n+1}(p_{n+1} - p_n)\n$$\n我们定义离散速率 $\\dot{p}_{n+1} = (p_{n+1} - p_n)/\\Delta t$。那么 $p_{n+1} - p_n = \\dot{p}_{n+1}\\Delta t$。代入此式得到：\n$$\n\\mathcal{D}_{n+1}^{\\mathrm{disc}} \\ge X_{n+1}\\dot{p}_{n+1}\\Delta t\n$$\n现在，我们使用第1部分的变分包含关系：$X_{n+1} \\in \\partial\\Phi(\\dot{p}_{n+1})$。根据凸函数 $\\Phi$ 的次微分定义，对于任意元素 $\\xi \\in \\partial\\Phi(y)$，以下不等式对所有 $x$ 成立：$\\Phi(x) - \\Phi(y) \\ge \\xi(x-y)$。令 $y = \\dot{p}_{n+1}$，$\\xi = X_{n+1}$，并选择 $x=0$。这给出：\n$$\n\\Phi(0) - \\Phi(\\dot{p}_{n+1}) \\ge X_{n+1}(0 - \\dot{p}_{n+1}) = -X_{n+1}\\dot{p}_{n+1}\n$$\n根据给定的耗散势形式 $\\Phi(\\dot{p}) = \\sigma_y |\\dot{p}| + \\frac{1}{2} \\eta \\dot{p}^2$，显然 $\\Phi(0) = 0$。该不等式简化为：\n$$\n-\\Phi(\\dot{p}_{n+1}) \\ge -X_{n+1}\\dot{p}_{n+1} \\quad \\implies \\quad X_{n+1}\\dot{p}_{n+1} \\ge \\Phi(\\dot{p}_{n+1})\n$$\n结合我们的两个结果：\n$$\n\\mathcal{D}_{n+1}^{\\mathrm{disc}} \\ge X_{n+1}\\dot{p}_{n+1}\\Delta t \\ge \\Phi(\\dot{p}_{n+1})\\Delta t\n$$\n由于 $\\sigma_y \\ge 0$，$\\eta > 0$ 和 $\\Delta t>0$，耗散势 $\\Phi(\\dot{p}_{n+1}) \\ge 0$ 且 $\\Delta t > 0$。因此 $\\Phi(\\dot{p}_{n+1})\\Delta t \\ge 0$。我们证明了：\n$$\n\\mathcal{D}_{n+1}^{\\mathrm{disc}} \\ge 0\n$$\n这证实了后向欧拉离散化是无条件稳定的，并满足离散版本的热力学第二定律。\n\n### 第3部分：塑性应变闭式更新的推导\n\n我们必须通过求解第1部分中导出的最优性条件来推导显式更新法则 $p_{n+1} = \\mathcal{T}(E,H,\\sigma_y,\\eta,\\Delta t,\\varepsilon_{n+1},p_n)$。该条件是包含关系：\n$$\nX_{n+1} \\in \\partial \\Phi\\left( \\frac{p_{n+1}-p_n}{\\Delta t} \\right)\n$$\n我们首先计算给定耗散势 $\\Phi(\\dot{p}) = \\sigma_y |\\dot{p}| + \\frac{1}{2} \\eta \\dot{p}^2$ 的次微分。由于第二项是可微的，我们有 $\\partial\\Phi(\\dot{p}) = \\sigma_y \\partial|\\dot{p}| + \\eta \\dot{p}$。绝对值函数的次微分是：\n$$\n\\partial|\\dot{p}| = \\begin{cases} \\{1\\} & \\text{若 } \\dot{p} > 0 \\\\ [-1, 1] & \\text{若 } \\dot{p} = 0 \\\\ \\{-1\\} & \\text{若 } \\dot{p} < 0 \\end{cases}\n$$\n力为 $X_{n+1} = E(\\varepsilon_{n+1} - p_{n+1}) - H p_{n+1}$。令 $\\Delta p = p_{n+1} - p_n$。则 $p_{n+1} = p_n + \\Delta p$，且 $\\dot{p}_{n+1} = \\Delta p / \\Delta t$。\n力可以写成：\n$$\nX_{n+1} = E(\\varepsilon_{n+1} - (p_n + \\Delta p)) - H(p_n + \\Delta p) = \\underbrace{E(\\varepsilon_{n+1} - p_n) - H p_n}_{X_{n+1}^{\\mathrm{tr}}} - (E+H)\\Delta p\n$$\n$X_{n+1}^{\\mathrm{tr}}$ 是试探热力学力，是在假设塑性应变没有变化的情况下计算的。包含关系变为：\n$$\nX_{n+1}^{\\mathrm{tr}} - (E+H)\\Delta p \\in \\sigma_y \\partial\\left|\\frac{\\Delta p}{\\Delta t}\\right| + \\eta \\frac{\\Delta p}{\\Delta t}\n$$\n我们通过对 $\\Delta p$ 分情况来分析这个包含关系：\n\n情况1：弹性响应 ($\\Delta p = 0$)。\n如果 $\\Delta p = 0$，那么 $\\dot{p}_{n+1} = 0$。包含关系简化为 $X_{n+1}^{\\mathrm{tr}} \\in \\sigma_y[-1, 1] + 0$，这等价于 $|X_{n+1}^{\\mathrm{tr}}| \\le \\sigma_y$。这是弹性条件。如果试探力在屈服面内，则塑性应变没有演化。\n因此，如果 $|E(\\varepsilon_{n+1} - p_n) - H p_n| \\le \\sigma_y$，则 $\\Delta p = 0$ 且 $p_{n+1} = p_n$。\n\n情况2：粘塑性响应 ($\\Delta p \\ne 0$)。\n如果 $\\Delta p \\ne 0$，那么 $\\dot{p}_{n+1} \\ne 0$，且 $\\partial|\\dot{p}_{n+1}|$ 变为单点集 $\\{\\mathrm{sgn}(\\dot{p}_{n+1})\\} = \\{\\mathrm{sgn}(\\Delta p)\\}$。包含关系变为一个等式：\n$$\nX_{n+1}^{\\mathrm{tr}} - (E+H)\\Delta p = \\sigma_y \\mathrm{sgn}(\\Delta p) + \\frac{\\eta}{\\Delta t} \\Delta p\n$$\n当 $|X_{n+1}^{\\mathrm{tr}}| > \\sigma_y$ 时，会触发此情况。我们可以解出 $\\Delta p$：\n$$\nX_{n+1}^{\\mathrm{tr}} - \\sigma_y \\mathrm{sgn}(\\Delta p) = \\left(E+H+\\frac{\\eta}{\\Delta t}\\right)\\Delta p\n$$\n$$\n\\Delta p = \\frac{X_{n+1}^{\\mathrm{tr}} - \\sigma_y \\mathrm{sgn}(\\Delta p)}{E+H+\\frac{\\eta}{\\Delta t}}\n$$\n为保持一致性，解 $\\Delta p$ 的符号必须与假设的符号 $\\mathrm{sgn}(\\Delta p)$ 相匹配。如果 $|X_{n+1}^{\\mathrm{tr}}| > \\sigma_y$，那么 $\\mathrm{sgn}(\\Delta p)$ 将等于 $\\mathrm{sgn}(X_{n+1}^{\\mathrm{tr}})$。我们可以验证这一点：如果 $X_{n+1}^{\\mathrm{tr}} > \\sigma_y > 0$，分子 $X_{n+1}^{\\mathrm{tr}} - \\sigma_y$ 是正的，所以 $\\Delta p > 0$。如果 $X_{n+1}^{\\mathrm{tr}} < -\\sigma_y < 0$，分子 $X_{n+1}^{\\mathrm{tr}} + \\sigma_y$ 是负的，所以 $\\Delta p < 0$。假设成立。因此我们可以写成：\n$$\n\\Delta p = \\frac{X_{n+1}^{\\mathrm{tr}} - \\sigma_y \\mathrm{sgn}(X_{n+1}^{\\mathrm{tr}})}{E+H+\\frac{\\eta}{\\Delta t}} = \\frac{|X_{n+1}^{\\mathrm{tr}}|\\mathrm{sgn}(X_{n+1}^{\\mathrm{tr}}) - \\sigma_y \\mathrm{sgn}(X_{n+1}^{\\mathrm{tr}})}{E+H+\\frac{\\eta}{\\Delta t}} = \\frac{|X_{n+1}^{\\mathrm{tr}}| - \\sigma_y}{E+H+\\frac{\\eta}{\\Delta t}}\\mathrm{sgn}(X_{n+1}^{\\mathrm{tr}})\n$$\n这是塑性情况下的更新。\n\n使用 Macauley 尖括号 $\\langle x \\rangle = \\max(0,x)$ 合并两种情况：\n令 $X_{n+1}^{\\mathrm{tr}} = E(\\varepsilon_{n+1}-p_n) - H p_n$。试探屈服函数为 $f_{\\mathrm{tr}} = |X_{n+1}^{\\mathrm{tr}}| - \\sigma_y$。\n塑性应变增量 $\\Delta p$ 由下式给出：\n$$\n\\Delta p = \\frac{\\langle f_{\\mathrm{tr}} \\rangle}{E+H+\\frac{\\eta}{\\Delta t}}\\mathrm{sgn}(X_{n+1}^{\\mathrm{tr}})\n$$\n因此，显式更新法则是：\n$$\np_{n+1} = p_n + \\frac{\\max(0, |E(\\varepsilon_{n+1}-p_n) - H p_n| - \\sigma_y)}{E+H+\\frac{\\eta}{\\Delta t}}\\mathrm{sgn}(E(\\varepsilon_{n+1}-p_n) - H p_n)\n$$\n这个闭式表达式就是所要求的函数 $\\mathcal{T}$。注意，如果 $\\mathrm{sgn}$ 的参数为零，则 $\\langle f_{\\mathrm{tr}} \\rangle=0$，因此无论 $\\mathrm{sgn}(0)$ 的值如何，$\\Delta p=0$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test cases.\n    It calculates the plastic strain update for a 1D viscoplastic material\n    and verifies the discrete Clausius-Duhem inequality.\n    \"\"\"\n\n    # Test suite from the problem statement.\n    # (E, H, sigma_y, eta, dt, eps_n, eps_n1, p_n)\n    test_cases = [\n        # Test 1\n        (210e9, 1e9, 250e6, 1e9, 1.0, 0.0, 1e-4, 0.0),\n        # Test 2\n        (210e9, 0.5e9, 200e6, 1e9, 1.0, 0.0, 2e-3, 0.0),\n        # Test 3\n        (100e9, 0.0, 100e6, 1e9, 1.0, 0.0, 1e-3, 0.0),\n        # Test 4\n        (50e9, 0.0, 20e6, 1e10, 10.0, 1e-3, 1e-3, 0.0),\n        # Test 5\n        (70e9, 2e9, 150e6, 1e8, 1000.0, 0.0, 5e-3, 0.0),\n        # Test 6\n        (200e9, 1e9, 250e6, 1e9, 0.1, 3e-3, 3e-3, 2e-4),\n    ]\n\n    results = []\n\n    def psi(eps, p, E, H):\n        \"\"\"Calculates the Helmholtz free energy density.\"\"\"\n        return 0.5 * E * (eps - p)**2 + 0.5 * H * p**2\n\n    for case in test_cases:\n        E, H, sigma_y, eta, dt, eps_n, eps_n1, p_n = case\n\n        # Step 1: Derive plastic strain p_{n+1} using the closed-form update\n        # Calculate trial thermodynamic force\n        X_tr = E * (eps_n1 - p_n) - H * p_n\n\n        # Calculate trial yield function\n        f_tr = np.abs(X_tr) - sigma_y\n\n        p_n1 = 0.0\n        if f_tr <= 0:\n            # Elastic step\n            p_n1 = p_n\n        else:\n            # Plastic step (return mapping)\n            denominator = E + H + eta / dt\n            delta_p = (f_tr / denominator) * np.sign(X_tr)\n            p_n1 = p_n + delta_p\n\n        # Step 2: Compute quantities for the discrete dissipation\n        # Stress at step n+1\n        sigma_n1 = E * (eps_n1 - p_n1)\n\n        # Free energy at steps n and n+1\n        psi_n = psi(eps_n, p_n, E, H)\n        psi_n1 = psi(eps_n1, p_n1, E, H)\n        \n        # Step 3: Evaluate the discrete dissipation\n        D_disc = sigma_n1 * (eps_n1 - eps_n) - (psi_n1 - psi_n)\n        \n        # Step 4: Check if the inequality holds within the given tolerance\n        tolerance = 1e-8 * np.max([1.0, np.abs(psi_n), np.abs(psi_n1)])\n        \n        is_valid = D_disc >= -tolerance\n        results.append(is_valid)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2925217"}]}