{"hands_on_practices": [{"introduction": "为了建立坚实的理论基础，我们从一个典型的一维应变梯度弹性问题入手。通过将平稳势能原理应用于弹性杆，本练习将引导你从头推导其高阶控制方程及相关的边界条件。求解此问题能让你具体地观察到边界层的出现——这是依赖于材料内禀长度尺度 $l$ 的一个标志性特征，并与经典弹性理论形成清晰对比。", "problem": "考虑一根长度为 $L$ 的棱柱形线弹性一维杆，承受沿杆轴方向的均布体力密度 $b$（单位体积的力）。令 $x \\in [0,L]$ 表示轴向坐标，$u(x)$ 表示小位移场。该杆遵循亥姆霍兹（Helmholtz）型的单参数应变梯度弹性理论，其中单位体积的应变能密度取决于无穷小应变 $\\varepsilon(x)=u'(x)$ 及其梯度 $\\varepsilon'(x)$，其形式为\n$$\nW(\\varepsilon,\\varepsilon')=\\tfrac{1}{2} E\\,\\varepsilon^2+\\tfrac{1}{2} E\\,\\ell^2\\,(\\varepsilon')^2,\n$$\n其中 $E>0$ 是杨氏模量，$\\ell>0$ 是材料内禀长度。假设横截面恒定（为简化起见，可取为单位1，因为它会在控制方程中被消去）且应变为小应变。杆的两端受到本质边界条件 $u(0)=0$ 和 $u(L)=0$ 的运动学约束，且无高阶外部双力作用。\n\n仅以驻值势能原理和上述定义为出发点，完成以下任务：\n\n1) 当施加本质边界条件 $u(0)=0$ 和 $u(L)=0$ 时，推导与 $u(x)$ 变分相关的强形式平衡方程和自然边界条件。\n\n2) 求解所得到的关于均布体力密度 $b$ 的边值问题，并确定满足所有边界条件的位移场 $u(x)$ 的闭式表达式。\n\n3) 重写解答，以明确显示在 $x=0$ 和 $x=L$ 附近出现的任何边界层结构。将最终位移 $u(x)$（单位为米）表示为包含 $b$、$E$、$\\ell$、$L$ 和 $x$ 的单一闭式解析表达式。", "solution": "### 步骤1：验证问题陈述\n该问题基于一个完善的应变梯度弹性模型（特别是亥姆霍兹(Helmholtz)或Aifantis型）。应变能密度 $W$ 是关于 $\\varepsilon$ 和 $\\varepsilon'$ 的正定二次型，这对于线弹性材料是标准形式，并确保了变分问题具有良好的性态。驻值势能原理是推导控制方程的基本且正确的方法。该问题是适定的，它提供了拉格朗日密度（由 $W$ 和体力势得到）、积分域以及所得四阶微分方程的一整套边界条件。本质边界条件 $u(0)=0$ 和 $u(L)=0$ 防止了刚体运动，并与从变分原理推导出的自然边界条件相结合，足以确定唯一解。问题陈述使用了固体力学和变分法中精确、标准的术语。它没有歧义和主观内容。问题有效，可以开始解答。\n\n***\n\n杆的总势能 $\\Pi$ 是总应变能 $U$ 和外力势能 $V_{ext}$ 的和。在单位横截面积（$A=1$）下，它们由以下公式给出：\n$$\nU[u] = \\int_0^L W(u', u'') \\,dx = \\int_0^L \\left( \\frac{1}{2} E (u'(x))^2 + \\frac{1}{2} E \\ell^2 (u''(x))^2 \\right) dx,\n$$\n$$\nV_{ext}[u] = - \\int_0^L b u(x) \\,dx.\n$$\n总势能泛函为 $\\Pi[u] = U[u] + V_{ext}[u]$：\n$$\n\\Pi[u] = \\int_0^L \\left( \\frac{1}{2} E (u')^2 + \\frac{1}{2} E \\ell^2 (u'')^2 - b u \\right) dx.\n$$\n驻值势能原理要求 $\\Pi$ 关于 $u$ 的一阶变分在平衡时为零，即 $\\delta\\Pi = 0$。\n$$\n\\delta\\Pi = \\int_0^L \\left( E u' \\delta(u') + E \\ell^2 u'' \\delta(u'') - b \\delta u \\right) dx = 0.\n$$\n对前两项使用分部积分法：\n$$\n\\int_0^L E u' \\delta(u') dx = \\int_0^L E u' \\frac{d}{dx}(\\delta u) dx = \\Big[ E u' \\delta u \\Big]_0^L - \\int_0^L E u'' \\delta u \\,dx.\n$$\n$$\n\\int_0^L E \\ell^2 u'' \\delta(u'') dx = \\int_0^L E \\ell^2 u'' \\frac{d}{dx}(\\delta u') dx = \\Big[ E \\ell^2 u'' \\delta u' \\Big]_0^L - \\int_0^L (E \\ell^2 u'')' \\delta u' \\,dx.\n$$\n对最后一项再次进行分部积分：\n$$\n- \\int_0^L (E \\ell^2 u'')' \\delta u' \\,dx = - \\Big[ (E \\ell^2 u'')' \\delta u \\Big]_0^L + \\int_0^L (E \\ell^2 u'')'' \\delta u \\,dx.\n$$\n合并所有项，变分 $\\delta\\Pi$ 变为：\n$$\n\\delta\\Pi = \\int_0^L \\Big( (E \\ell^2 u'')'' - E u'' - b \\Big) \\delta u \\,dx + \\Big[ (E u' - (E \\ell^2 u'')') \\delta u \\Big]_0^L + \\Big[ E \\ell^2 u'' \\delta u' \\Big]_0^L = 0.\n$$\n\n**1) 强形式平衡方程和自然边界条件**\n\n为了使该变分陈述对在内部 $(0,L)$ 为零的任何容许变分 $\\delta u$ 都成立，被积函数必须为零。这就得到了强形式平衡方程（欧拉-拉格朗日方程）：\n$$\n(E \\ell^2 u'')'' - E u'' = b.\n$$\n由于 $E$ 和 $\\ell$ 是常数，这可以简化为：\n$$\nE \\ell^2 u'''' - E u'' = b \\quad \\implies \\quad u'''' - \\frac{1}{\\ell^2} u'' = \\frac{b}{E \\ell^2}.\n$$\n边界项也必须为零。本质边界条件为 $u(0)=0$ 和 $u(L)=0$，这意味着容许变分必须满足 $\\delta u(0)=0$ 和 $\\delta u(L)=0$。这自动使得第一个边界项 $\\Big[ (E u' - (E \\ell^2 u'')') \\delta u \\Big]_0^L$ 为零。剩下的边界项是：\n$$\n\\Big[ E \\ell^2 u'' \\delta u' \\Big]_0^L = (E \\ell^2 u''(L)) \\delta u'(L) - (E \\ell^2 u''(0)) \\delta u'(0) = 0.\n$$\n由于变分 $\\delta u'(0)$ 和 $\\delta u'(L)$ 是任意的，它们的系数必须为零。这些就是自然边界条件，其物理意义对应于没有外部施加的双力（力矩）：\n$$\nE \\ell^2 u''(0) = 0 \\quad \\text{和} \\quad E \\ell^2 u''(L) = 0.\n$$\n因为 $E>0$ 且 $\\ell>0$，这些条件简化为 $u''(0) = 0$ 和 $u''(L) = 0$。\n\n**2) 边值问题的解**\n\n完整的边值问题是：\n- 常微分方程(ODE): $u'''' - \\frac{1}{\\ell^2} u'' = \\frac{b}{E \\ell^2}$，对于 $x \\in (0,L)$。\n- 边界条件(BCs): $u(0)=0$, $u(L)=0$, $u''(0)=0$, $u''(L)=0$。\n\n通解是特解 $u_p(x)$ 和齐次解 $u_h(x)$ 的和。\n对于特解，我们尝试多项式形式 $u_p(x) = C x^2$。代入常微分方程：\n$0 - \\frac{1}{\\ell^2}(2C) = \\frac{b}{E \\ell^2} \\implies C = -\\frac{b}{2E}$。因此，$u_p(x) = -\\frac{b}{2E}x^2$。\n\n对于齐次解，特征方程为 $r^4 - \\frac{1}{\\ell^2}r^2 = 0$，即 $r^2(r^2 - 1/\\ell^2)=0$。根为 $r_1=r_2=0$，$r_3=1/\\ell$ 和 $r_4=-1/\\ell$。齐次解为：\n$$\nu_h(x) = C_1 + C_2 x + C_3 \\cosh(x/\\ell) + C_4 \\sinh(x/\\ell).\n$$\n通解是：\n$$\nu(x) = C_1 + C_2 x + C_3 \\cosh(x/\\ell) + C_4 \\sinh(x/\\ell) - \\frac{b}{2E} x^2.\n$$\n我们需要它的二阶导数来应用自然边界条件：\n$$\nu''(x) = \\frac{C_3}{\\ell^2} \\cosh(x/\\ell) + \\frac{C_4}{\\ell^2} \\sinh(x/\\ell) - \\frac{b}{E}.\n$$\n应用边界条件：\n- $u''(0)=0 \\implies \\frac{C_3}{\\ell^2} - \\frac{b}{E} = 0 \\implies C_3 = \\frac{b\\ell^2}{E}$。\n- $u''(L)=0 \\implies \\frac{C_3}{\\ell^2} \\cosh(L/\\ell) + \\frac{C_4}{\\ell^2} \\sinh(L/\\ell) - \\frac{b}{E} = 0$。代入 $C_3$：\n  $\\frac{b}{E} \\cosh(L/\\ell) + \\frac{C_4}{\\ell^2} \\sinh(L/\\ell) - \\frac{b}{E} = 0 \\implies C_4 = \\frac{b\\ell^2}{E} \\frac{1-\\cosh(L/\\ell)}{\\sinh(L/\\ell)} = -\\frac{b\\ell^2}{E} \\tanh(L/(2\\ell))$。\n- $u(0)=0 \\implies C_1 + C_3 = 0 \\implies C_1 = -C_3 = -\\frac{b\\ell^2}{E}$。\n- $u(L)=0 \\implies C_1 + C_2 L + C_3 \\cosh(L/\\ell) + C_4 \\sinh(L/\\ell) - \\frac{b}{2E} L^2 = 0$。\n  代入已知常数：\n  $-\\frac{b\\ell^2}{E} + C_2 L + \\frac{b\\ell^2}{E}\\cosh(L/\\ell) - \\frac{b\\ell^2}{E} \\tanh(L/(2\\ell)) \\sinh(L/\\ell) - \\frac{b}{2E} L^2 = 0$。\n  项 $\\frac{b\\ell^2}{E}\\cosh(L/\\ell) - \\frac{b\\ell^2}{E} \\tanh(L/(2\\ell)) \\sinh(L/\\ell)$ 可以简化。它等于 $C_3 \\cosh(L/\\ell) + C_4 \\sinh(L/\\ell) = \\ell^2 \\left( \\frac{C_3}{\\ell^2} \\cosh(L/\\ell) + \\frac{C_4}{\\ell^2} \\sinh(L/\\ell) \\right) = \\ell^2 (\\frac{b}{E}) = \\frac{b\\ell^2}{E}$。\n  所以关于 $C_2$ 的方程变为：\n  $-\\frac{b\\ell^2}{E} + C_2 L + \\frac{b\\ell^2}{E} - \\frac{b}{2E} L^2 = 0 \\implies C_2 L = \\frac{bL^2}{2E} \\implies C_2 = \\frac{bL}{2E}$。\n\n将常数代回通解：\n$$\nu(x) = -\\frac{b\\ell^2}{E} + \\frac{bL}{2E} x - \\frac{b}{2E} x^2 + \\frac{b\\ell^2}{E} \\cosh(x/\\ell) - \\frac{b\\ell^2}{E} \\tanh(L/(2\\ell)) \\sinh(x/\\ell).\n$$\n这个表达式可以重新整理，以组合经典项和非经典项。\n\n**3) 边界层结构**\n\n为了使结构更明确，我们将各项分组如下：\n$$\nu(x) = \\frac{b}{2E} (Lx - x^2) + \\frac{b\\ell^2}{E} \\left( \\cosh(x/\\ell) - \\tanh(L/(2\\ell)) \\sinh(x/\\ell) - 1 \\right).\n$$\n第一项 $u_{cl}(x)=\\frac{b}{2E}(Lx-x^2)$ 是无梯度效应时杆的经典抛物线位移分布。第二项是由于应变梯度引起的修正项。双曲函数部分可以使用恒等式 $\\cosh(A-B) = \\cosh A \\cosh B - \\sinh A \\sinh B$ 进行简化：\n$$\n\\cosh(x/\\ell) - \\tanh(L/(2\\ell)) \\sinh(x/\\ell) = \\frac{\\cosh(x/\\ell)\\cosh(L/(2\\ell)) - \\sinh(L/(2\\ell))\\sinh(x/\\ell)}{\\cosh(L/(2\\ell))} = \\frac{\\cosh(\\frac{x}{\\ell}-\\frac{L}{2\\ell})}{\\cosh(L/(2\\ell))}.\n$$\n由于 $\\cosh$ 是偶函数，这也等于 $\\frac{\\cosh(\\frac{L}{2\\ell}-\\frac{x}{\\ell})}{\\cosh(L/(2\\ell))}$ 或 $\\frac{\\cosh(\\frac{x-L/2}{\\ell})}{\\cosh(L/(2\\ell))}$。\n位移场的最终紧凑表达式为：\n$$\nu(x) = \\frac{b}{2E} x(L-x) + \\frac{b\\ell^2}{E} \\left( \\frac{\\cosh(\\frac{x-L/2}{\\ell})}{\\cosh(L/2\\ell)} - 1 \\right).\n$$\n这种形式明确地显示了由一个修正项修正的经典抛物线解。该修正由材料长度 $\\ell$ 控制。双曲余弦项在 $x=0$ 和 $x=L$ 附近创建了特征厚度为 $\\ell$ 的边界层。在这些层内部，梯度弹性解与经典解显著偏离，以满足高阶边界条件 $u''=0$。远离边界处，如果 $L \\gg \\ell$，修正项变得很小，解接近于经典解加上一个常数偏移。该表达式就是所要求的单一闭式结果。", "answer": "$$\n\\boxed{u(x) = \\frac{b}{2E} x(L-x) + \\frac{b \\ell^{2}}{E} \\left( \\frac{\\cosh\\left(\\frac{x - L/2}{\\ell}\\right)}{\\cosh\\left(\\frac{L}{2\\ell}\\right)} - 1 \\right)}\n$$", "id": "2688599"}, {"introduction": "在轴向杆模型的基础上，本实践利用应变梯度弹性公式来探究梁弯曲过程中的尺寸效应。核心任务是运用正则微扰展开这一强大的分析工具，将高阶模型与我们所熟悉的欧拉-伯努利梁理论联系起来。这个练习不仅揭示了经典理论是如何作为更普适模型的一种近似而出现的，还为量化主导阶的、依赖于尺寸的刚化效应提供了一种实用方法。", "problem": "考虑一个细长棱柱梁的一维弯曲模型，该模型通过应变梯度弹性理论引入了材料长度尺度。令 $x \\in [0,L]$ 表示梁的轴向坐标，令 $w(x)$ 表示在已知的静态横向载荷分布 $q(x)$（每单位长度）下的横向挠度。使用以下基本依据：\n- Euler–Bernoulli 梁理论的运动学：曲率为 $\\kappa(x) = w''(x)$。\n- 弯矩的静态平衡：内弯矩 $M(x)$ 满足 $M''(x) = q(x)$。\n- 包含应变梯度增强的能量学：总势能为\n$$\\Pi[w] = \\int_0^L \\frac{1}{2} E I \\left( \\kappa(x)^2 + \\ell^2 \\kappa'(x)^2 \\right) \\, dx \\;-\\; \\int_0^L q(x) \\, w(x) \\, dx,$$\n其中 $E I$ 是抗弯刚度，$\\ell$ 是一个内禀材料长度（两者均为严格为正的常数）。\n\n任务：\n1) 从与几何边界条件一致的容许变分 $\\delta w(x)$ 的驻值作用量条件 $\\delta \\Pi[w] = 0$ 出发，推导 $w(x)$ 的相关 Euler–Lagrange 方程，并完全用 $w(x)$ 和 $q(x)$ 表示。然后，严格论证 $\\ell \\to 0$ 的极限，并陈述其极限方程。\n\n2) 通过以下形式的正则微扰展开来量化小而有限的 $\\ell$ 的领头阶修正：\n$$w(x) = w_0(x) + \\ell^2 w_1(x) + \\mathcal{O}(\\ell^4),$$\n并推导一个可计算的关系式，以确定曲率的领头阶修正。将您最终的曲率关系式（最高到 $\\ell^2$ 阶）用经典弯矩 $M(x)$ 及其导数表示，然后才在适当的边界条件下积分以获得 $w(x)$。\n\n3) 使用您的领头阶关系式，构建一个算法来计算以下边值问题中挠度 $w(x)$ 的值（最高到 $\\ell^2$ 阶）。所有答案必须以米为单位表示，$x$ 的单位为米，$E I$ 的单位为 $\\mathrm{N}\\,\\mathrm{m}^2$，$q$ 的单位为 $\\mathrm{N}/\\mathrm{m}$，施加的端部弯矩单位为 $\\mathrm{N}\\,\\mathrm{m}$。使用指定的精确常数；不要对中间计算进行四舍五入。\n\n测试套件：\n- 情况 A (简支，均布载荷)：梁长 $L = 2.0\\,\\mathrm{m}$，抗弯刚度 $E I = 2.0 \\times 10^7\\,\\mathrm{N}\\,\\mathrm{m}^2$，内禀长度 $\\ell = 0.05\\,\\mathrm{m}$，常载荷 $q(x) = q_0$，其中 $q_0 = 1000\\,\\mathrm{N}/\\mathrm{m}$。几何边界条件为 $w(0) = 0$ 和 $w(L) = 0$。自然边界条件为简支支座处的弯矩为零。报告 $x = L/2$ 处的挠度。\n- 情况 B (悬臂，正弦载荷)：梁长 $L = 1.5\\,\\mathrm{m}$，抗弯刚度 $E I = 3.0 \\times 10^6\\,\\mathrm{N}\\,\\mathrm{m}^2$，内禀长度 $\\ell = 0.02\\,\\mathrm{m}$，载荷 $q(x) = q_0 \\sin\\left(\\pi x/L\\right)$，其中 $q_0 = 500\\,\\mathrm{N}/\\mathrm{m}$。固定端 $x = 0$ 处的几何边界条件为 $w(0) = 0$ 和 $w'(0) = 0$。自由端 $x = L$ 处的自然边界条件为弯矩和剪力为零。报告 $x = L$ 处的尖端挠度。\n- 情况 C (悬臂，纯端部弯矩)：梁长 $L = 1.0\\,\\mathrm{m}$，抗弯刚度 $E I = 5.0 \\times 10^6\\,\\mathrm{N}\\,\\mathrm{m}^2$，内禀长度 $\\ell = 0.10\\,\\mathrm{m}$，无分布载荷 $q(x) = 0$。在 $x = L$ 处施加一个恒定的端部弯矩 $M_0 = 2000\\,\\mathrm{N}\\,\\mathrm{m}$，在静态平衡状态下，这会导致沿跨度产生一个恒定的内弯矩 $M(x) = M_0$。$x = 0$ 处的几何边界条件为 $w(0) = 0$ 和 $w'(0) = 0$。报告 $x = L$ 处的尖端挠度。\n- 情况 D (恢复性检验，简支，均布载荷且 $\\ell = 0$)：与情况 A 相同，但 $\\ell = 0\\,\\mathrm{m}$。报告 $x = L/2$ 处的挠度。\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4]$），其中 $r_i$ 是情况 A-D 所要求的挠度（单位为米，以浮点数表示）。程序必须是自包含的，不得读取任何输入，并且必须使用本问题中的推导来计算答案，不使用外部文件或网络访问。", "solution": "### 步骤1：验证问题陈述\n该问题具有科学依据、适定且客观。它是将变分法和微扰理论应用于梁的一阶应变梯度弹性模型的标准应用。公式是自包含的，且为每个情况提供的数据是完整且一致的。该问题并非微不足道，需要基于力学基本原理进行详细推导。问题有效，可以开始解答。\n\n***\n\n**任务1：控制方程的推导**\n\n总势能由一个泛函 $\\Pi[w]$ 给出。通过对所有容许变分 $\\delta w(x)$ 将此泛函的一阶变分设为零，即 $\\delta\\Pi = 0$，可以找到控制微分方程和自然边界条件。拉格朗日密度为 $\\mathcal{L}(w, w'', w''') = \\frac{1}{2}EI\\left((w'')^2 + \\ell^2(w''')^2\\right) - q(x)w$。\n\n变分为：\n$$ \\delta\\Pi = \\int_0^L \\left( \\frac{\\partial \\mathcal{L}}{\\partial w}\\delta w + \\frac{\\partial \\mathcal{L}}{\\partial w''}\\delta w'' + \\frac{\\partial \\mathcal{L}}{\\partial w'''}\\delta w''' \\right) dx = \\int_0^L \\left( -q\\delta w + EIw''\\delta w'' + EI\\ell^2w'''\\delta w''' \\right) dx = 0 $$\n对包含 $\\delta w$ 导数的项使用分部积分法，并收集所有积分项，我们得到：\n$$ \\int_0^L \\left( \\frac{d^2(EIw'')}{dx^2} - \\frac{d^3(EI\\ell^2w''')}{dx^3} - q(x) \\right) \\delta w \\, dx + \\text{边界项} = 0 $$\n对于域 $(0, L)$ 内的任意变分 $\\delta w$，被积函数必须为零，从而得出欧拉-拉格朗日方程。假设 $EI$ 和 $\\ell$ 是常数：\n$$ EIw'''' - EI\\ell^2 w'''''' = q(x) $$\n这是控制挠度 $w(x)$ 的六阶微分方程。\n\n在 $\\ell \\to 0$ 的极限下，只要解 $w(x)$ 足够光滑以使其六阶导数保持有界，则 $EI\\ell^2w''''''$ 项消失。方程简化为：\n$$ EIw'''' = q(x) $$\n这正是经典的欧拉-伯努利梁方程。完整方程的解向简化方程的解的收敛构成了一个正则微扰问题，从而证明了该极限的合理性。\n\n**任务2：微扰展开**\n\n我们寻求一个形如 $w(x) = w_0(x) + \\ell^2 w_1(x) + \\mathcal{O}(\\ell^4)$ 的解。将其代入控制方程并按 $\\ell^2$ 的幂次收集各项：\n- $\\mathcal{O}(\\ell^0)$: $EIw_0'''' = q(x)$\n- $\\mathcal{O}(\\ell^2)$: $EIw_1'''' - EIw_0'''''' = 0 \\implies EIw_1'''' = EIw_0''''''$\n\n从零阶方程出发，我们可以求导两次得到 $EIw_0'''''' = q''(x)$。将其代入一阶方程得到：\n$$ EIw_1'''' = q''(x) $$\n这是一个系统性的算法。总挠度 $w = w_0 + \\ell^2 w_1$ 通过求解两个独立的边值问题得到：\n1.  **$w_0$ 的经典问题**：求解 $EIw_0'''' = q(x)$，并施加指定的经典边界条件。\n2.  **$w_1$ 的修正问题**：求解 $EIw_1'''' = q''(x)$，并施加从完整问题的边界条件展开得到的齐次几何边界条件和非齐次自然边界条件。对于简支或固定边界，自然边界条件（广义弯矩或剪力为零）的展开给出 $EIw_1''(x)=q(x)$ 和 $EIw_1'''(x)=q'(x)$。\n\n**任务3：算法与计算**\n\n**情况 A：简支，均布载荷**\n$q(x)=q_0=1000$。因此 $q''(x)=0$。\n$w_0$ 的问题是经典的简支梁均布载荷问题，其跨中挠度为 $w_0(L/2) = \\frac{5 q_0 L^4}{384 EI}$。\n$w_1$ 的问题是 $EIw_1''''=0$。几何边界条件为 $w_1(0)=0, w_1(L)=0$。展开的自然边界条件（广义弯矩为零）给出 $EIw_1''(0)=q(0)=q_0$ 和 $EIw_1''(L)=q(L)=q_0$。求解此边值问题得到 $w_1(x) = \\frac{q_0}{2EI}x(x-L)$。\n因此，总挠度为 $w(L/2) = w_0(L/2) + \\ell^2 w_1(L/2) = \\frac{5 q_0 L^4}{384 EI} - \\ell^2 \\frac{q_0 L^2}{8EI}$。\n代入数值：$w_A \\approx 1.035417 \\times 10^{-5}\\,\\mathrm{m}$。\n\n**情况 B：悬臂，正弦载荷**\n$q(x) = q_0 \\sin(\\alpha x)$，其中 $\\alpha = \\pi/L$。$q''(x) = -q_0 \\alpha^2 \\sin(\\alpha x)$。\n$w_0$ 的问题求解得到尖端挠度：$w_0(L) = \\frac{q_0}{EI} ( \\frac{L^3}{3\\alpha} - \\frac{L}{\\alpha^3} ) = \\frac{q_0 L^4}{EI \\pi} (\\frac{1}{3} - \\frac{1}{\\pi^2})$。\n$w_1$ 的问题是 $EIw_1'''' = -q_0 \\alpha^2 \\sin(\\alpha x)$，边界条件为 $w_1(0)=w_1'(0)=0$，自然边界条件为 $EIw_1''(L)=q(L)=0$ 和 $EIw_1'''(L)=q'(L)=-q_0\\alpha$。\n求解得到修正项的尖端挠度：$w_1(L) = \\frac{q_0 L^2}{EI \\pi}$。\n总尖端挠度为 $w(L) = w_0(L) + \\ell^2 w_1(L) = \\frac{q_0 L^2}{EI \\pi} [ L^2(\\frac{1}{3} - \\frac{1}{\\pi^2}) + \\ell^2 ]$。\n代入数值：$w_B \\approx 6.23493 \\times 10^{-5}\\,\\mathrm{m}$。\n\n**情况 C：悬臂，纯端部弯矩**\n$q(x)=0$，所以 $q''(x)=0$。修正问题 $EIw_1'''' = 0$ 的边界条件都是齐次的，因此唯一解是 $w_1(x) \\equiv 0$。梯度效应为零。\n解是悬臂梁在端部弯矩 $M_0$ 作用下的经典解：$w(L) = \\frac{M_0 L^2}{2EI}$。\n代入数值：$w_C = 2.0 \\times 10^{-4}\\,\\mathrm{m}$。\n\n**情况 D：恢复性检验, $\\ell=0$**\n此情况与情况 A 的计算公式相同，但 $\\ell=0$。因此，修正项为零，解就是经典解。\n$w_D = \\frac{5 q_0 L^4}{384 EI} \\approx 1.041667 \\times 10^{-5}\\,\\mathrm{m}$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes beam deflections for four cases based on a perturbation analysis\n    of strain gradient elasticity. The deflection is w(x) = w_0(x) + l^2 * w_1(x),\n    where w_0 is the classical solution (from EI*w_0''''=q) and w_1 is the\n    correction (from EI*w_1''''=q'').\n    \"\"\"\n\n    results = []\n\n    # Case A: Simply supported, uniform load\n    L_A = 2.0\n    EI_A = 2.0e7\n    l_A = 0.05\n    q0_A = 1000.0\n    # Classical solution at mid-span: w0 = 5*q0*L^4 / (384*EI)\n    w0_A = (5 * q0_A * L_A**4) / (384 * EI_A)\n    # Correction term w1 from EI*w1''''=q''=0 with BCs w1(0)=w1(L)=0\n    # and EI*w1''(0)=q0, EI*w1''(L)=q0.\n    # The solution is w1(x) = q0/(2*EI)*x*(x-L).\n    # At mid-span x=L/2, w1(L/2) = q0/(2*EI)*(L/2)*(-L/2) = -q0*L^2/(8*EI).\n    w1_A_midspan = - (q0_A * L_A**2) / (8 * EI_A)\n    w_A = w0_A + l_A**2 * w1_A_midspan\n    results.append(w_A)\n\n    # Case B: Cantilever, sinusoidal load\n    L_B = 1.5\n    EI_B = 3.0e6\n    l_B = 0.02\n    q0_B = 500.0\n    # Total tip deflection from derivation:\n    # w(L) = (q0 * L^2 / (EI * pi)) * [L^2 * (1/3 - 1/pi^2) + l^2]\n    pi = np.pi\n    term1_B = q0_B * L_B**2 / (EI_B * pi)\n    term2_B = L_B**2 * (1/3 - 1/pi**2)\n    term3_B = l_B**2\n    w_B = term1_B * (term2_B + term3_B)\n    results.append(w_B)\n\n    # Case C: Cantilever, pure end moment\n    L_C = 1.0\n    EI_C = 5.0e6\n    l_C = 0.10\n    M0_C = 2000.0\n    # For q(x) = 0, q''(x) = 0.\n    # The correction term w_1 is zero. The solution is purely classical.\n    # w(L) = M0 * L^2 / (2 * EI)\n    w_C = (M0_C * L_C**2) / (2 * EI_C)\n    results.append(w_C)\n\n    # Case D: Recovery check, simply supported, uniform load with l=0\n    L_D = 2.0\n    EI_D = 2.0e7\n    l_D = 0.0\n    q0_D = 1000.0\n    # Use the same formula as Case A, with l=0.\n    w0_D = (5 * q0_D * L_D**4) / (384 * EI_D)\n    w1_D_midspan = - (q0_D * L_D**2) / (8 * EI_D)\n    w_D = w0_D + l_D**2 * w1_D_midspan # Correction term is zero\n    results.append(w_D)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.12g}' for r in results)}]\")\n\nsolve()\n```", "id": "2919598"}, {"introduction": "解析解仅限于简单情况，因此像有限元法（FEM）这样的数值方法对于求解一般问题至关重要。本实践通过考察协调有限元列式（conforming FEM formulation）的要求，深入探讨了应变梯度弹性的计算挑战。你将发现为何能量泛函中的高阶导数要求单元之间具备 $C^1$ 连续性，并分析这一要求所带来的重大代数约束，尤其是在三维四面体单元中。", "problem": "考虑一个占据有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{d}$（其中 $d \\in \\{2,3\\}$）的小应变、线性、中心对称的应变梯度弹性固体。令 $u:\\Omega \\to \\mathbb{R}^{d}$ 表示位移场，$\\varepsilon(u) = \\tfrac{1}{2}(\\nabla u + \\nabla u^{\\top})$ 为对称应变。一个具有内禀材料长度 $\\ell > 0$ 的原型总势能泛函包含一个标准弹性部分和一个二次应变梯度部分，后者依赖于 $\\varepsilon(u)$ 的空间梯度。为简洁起见，假设没有惯性、体力或面力。虚功原理指出，对于所有容许的虚位移 $v$，总势能的一阶变分在平衡状态下必须为零。\n\n任务 A. 从虚功原理和 $\\varepsilon(u)$ 的定义出发，论证当存在涉及 $\\varepsilon(u)$ 一阶导数的二次梯度项时，$u$ 的哪些导数必须是平方可积的。对于包含和不含梯度项的两种情况，将此要求转化为形式为 $u \\in H^{m}(\\Omega)$（其中 $m \\ge 1$ 为整数）的 Sobolev 空间表述。解释出现在双线性形式中的 $u$ 的最高导数阶数如何确定 $m$，以及必须如何选择协调有限元，以使离散空间成为 $H^{m}(\\Omega)$ 的子空间。\n\n任务 B. 对于由分片多项式构成的协调离散化，令 $C^{r}$ 表示跨单元界面的 $r$ 阶单元间连续性。解释 $H^{m}$-协调性与标量分量的 $C^{m-1}$ 连续性之间的联系。定义一个函数，该函数将给定的导数阶数 $m$ 映射到最小单元间连续性阶数 $r=m-1$，并附带两个逻辑指标：一个在至少需要 $C^{1}$ 连续性时为真（即 $m \\ge 2$），另一个在恰好 $C^{1}$ 连续性足够时为真（即 $m=2$）。\n\n任务 C. 考虑一个基于单纯形的单元（$d=2$ 时为三角形，或 $d=3$ 时为四面体），其标量多项式形函数的总次数至多为 $p \\in \\mathbb{N}$。令 $N_{p}(d)$ 表示一个 $d$-单纯形上次数至多为 $p$ 的标量多项式空间的维度，即 $N_{p}(d) = \\binom{p+d}{d}$。对于 $d=3$，重点关注一个平面三角形面 $F$。要使标量分量跨 $F$ 面具有 $C^{1}$ 单元间连续性，独立的迹数据包括限制在 $F$ 上的函数值 $u|_{F}$（$F$ 上的一个次数至多为 $p$ 的多项式）和限制在 $F$ 上的法向导数 $\\partial u/\\partial n|_{F}$（$F$ 上的一个次数至多为 $p-1$ 的多项式）。令 $\\dim \\mathcal{P}_{q}(F) = \\binom{q+2}{2}$ 表示 $F$ 上次数至多为 $q$ 的多项式的维度。定义面迹数据维度\n$$\nT_{\\mathrm{face}}(p) = \\dim \\mathcal{P}_{p}(F) + \\dim \\mathcal{P}_{p-1}(F) = \\binom{p+2}{2} + \\binom{p+1}{2} = (p+1)^{2}.\n$$\n对于 $d=3$，定义比率\n$$\nR_{\\mathrm{face}}(p) = \\frac{T_{\\mathrm{face}}(p)}{N_{p}(3)}, \\quad R_{\\mathrm{all\\,faces}}(p) = \\frac{4\\,T_{\\mathrm{face}}(p)}{N_{p}(3)}.\n$$\n这些比率分别量化了单个面上所需的 $C^{1}$ 迹数据空间相对于内部多项式空间的大小，以及在假设所有四个面上的数据相互独立的情况下，对它们进行聚合的粗略上界指标。使用这些量来讨论在三维四面体上构造 $C^{1}$-协调标量多项式单元的挑战。\n\n编程要求。实现一个程序，执行以下操作：\n\n- 给定一个导数阶数列表 $m$，为每个 $m$ 计算：\n  - 最小连续性阶数 $r = m-1$，作为整数。\n  - 一个布尔标志 $\\mathrm{requires\\_at\\_least\\_C1}$，如果 $m \\ge 2$ 则为 true，否则为 false。\n  - 一个布尔标志 $\\mathrm{exactly\\_C1\\_sufficient}$，如果 $m = 2$ 则为 true，否则为 false。\n- 对于 $d=3$ 和一个多项式次数列表 $p$，为每个 $p$ 计算：\n  - $N_{p}(3) = \\binom{p+3}{3}$，作为整数。\n  - $T_{\\mathrm{face}}(p) = (p+1)^{2}$，作为整数。\n  - $R_{\\mathrm{face}}(p)$ 和 $R_{\\mathrm{all\\,faces}}(p)$，作为四舍五入到六位小数的浮点数。\n\n单位约定。此计算中不涉及物理单位。\n\n测试套件。您的程序必须严格使用以下测试参数：\n\n- 导数阶数 $m \\in \\{1,2,3\\}$。\n- 三维中的多项式次数 $p \\in \\{2,3,4,5,6\\}$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个扁平列表中的所有结果，顺序如下：\n\n- 对于 $m=1, m=2, m=3$ 顺序中的每个 $m$，附加三个条目：$r$, $\\mathrm{requires\\_at\\_least\\_C1}$, $\\mathrm{exactly\\_C1\\_sufficient}$。布尔值必须打印为整数，0 代表 false，1 代表 true。\n- 对于 $p=2,3,4,5,6$ 顺序中的每个 $p$，附加四个条目：$N_{p}(3)$, $T_{\\mathrm{face}}(p)$, $R_{\\mathrm{face}}(p)$, $R_{\\mathrm{all\\,faces}}(p)$，其中最后两个条目是四舍五入到六位小数的浮点数。\n\n例如，输出应具有以下结构\n$[r_{1},b_{1},c_{1},r_{2},b_{2},c_{2},r_{3},b_{3},c_{3},N_{2},T_{2},R_{\\mathrm{face}}(2),R_{\\mathrm{all\\,faces}}(2),\\dots,N_{6},T_{6},R_{\\mathrm{face}}(6),R_{\\mathrm{all\\,faces}}(6)]$，\n方括号内的条目之间用逗号分隔，没有空格。条目本身必须是基本类型：布尔值表示为 0 或 1，所有其他值按规定为整数或浮点数。", "solution": "### 问题验证\n问题陈述在科学上是合理的、适定的和客观的。它牢固地建立在成熟的弹性数学理论和有限元方法之上。提问方式清晰、逻辑性强，并能得出明确的结果。完成任务所需的所有必要信息和公式都已提供。没有矛盾或歧义。问题有效，可以开始解答。\n\n***\n\n**任务A：Sobolev空间要求**\n\n弹性体的总势能 $\\Pi$ 是应变能密度 $W$ 的体积积分。平衡状态通过最小化此势能找到，根据虚功原理，这要求其一阶变分 $\\delta\\Pi$ 对所有容许的虚位移 $v$ 均为零。这导致了边值问题的弱形式或变分形式。要使此形式在数学上有意义，任何容许位移场 $u$ 的能量 $\\Pi(u)$ 都必须是有限的。\n\n在经典线性弹性力学中，能量密度 $W$ 是 $u$ 的一阶导数的二次函数。要使总能量 $\\Pi(u) = \\int_{\\Omega} W(\\varepsilon(u)) \\, d\\Omega$ 有限， $u$ 的一阶导数必须在域 $\\Omega$ 上是平方可积的。其自身在 $L^{2}(\\Omega)$ 中且其一阶导数也在 $L^{2}(\\Omega)$ 中的函数空间是Sobolev空间 $H^{1}(\\Omega)$。因此，对于经典弹性力学，位移场必须满足 $u \\in [H^{1}(\\Omega)]^{d}$。这里，出现在能量中的最高导数阶数是 $m=1$。\n\n在给定的应变梯度弹性模型中，能量密度二次依赖于应变的梯度 $\\nabla\\varepsilon(u)$，因此是 $u$ 的二阶导数的二次函数。要使总能量有限，$u$ 的二阶导数必须是平方可积的。导数最高为 $m$ 阶都平方可积的函数空间是Sobolev空间 $H^{m}(\\Omega)$。对于此应变梯度理论，最高导数阶数为 $m=2$，因此位移场必须满足 $u \\in [H^{2}(\\Omega)]^{d}$。\n\n通常，对于一个变分问题，如果能量泛函中出现的未知场 $u$ 的最高导数是 $m$ 阶，则解的自然函数空间是 $H^{m}(\\Omega)$。协调有限元近似要求离散函数空间 $V_h$ 是连续解空间 $V$ 的一个子空间，即 $V_h \\subset V = [H^m(\\Omega)]^d$。这确保了离散空间中任何函数的能量都是有限的，这是该方法收敛的先决条件。\n\n**任务B：单元间连续性**\n\n对于一个被划分为单元网格 $\\Omega_e$ 的域 $\\Omega$，一个通过在每个单元上拼接多项式而构造的函数，当且仅当它在单元间边界上表现出一定程度的连续性时，才属于全局Sobolev空间 $H^m(\\Omega)$。泛函分析的一个基本结果指出，一个分片多项式函数要属于 $H^m(\\Omega)$，它必须在单元界面上是 $C^{m-1}$ 类的。\n\n-   对于 $m=1$（标准弹性力学，$H^1$-协调性），要求是 $C^{1-1} = C^0$ 连续性。这意味着函数值必须在单元边界上连续。标准的拉格朗日有限元满足此条件。\n-   对于 $m=2$（应变梯度弹性力学，$H^2$-协调性），要求是 $C^{2-1} = C^1$ 连续性。函数值及其一阶偏导数都必须在单元边界上连续。\n-   对于 $m=3$（例如，一个包含应变梯度之梯度的理论），要求将是 $C^{3-1} = C^2$ 连续性。\n\n因此，从导数阶数 $m$ 到连续性要求的映射如下：\n1.  所需的最小单元间连续性阶数：$r = m-1$。\n2.  条件“至少需要 $C^1$ 连续性”等价于 $m \\geq 2$。布尔指标 $\\mathrm{requires\\_at\\_least\\_C1}$ 在 $m \\geq 2$ 时为真。\n3.  条件“恰好 $C^1$ 连续性足够”等价于 $m=2$。布尔指标 $\\mathrm{exactly\\_C1\\_sufficient}$ 在 $m=2$ 时为真。\n\n**任务C：在三维中构造 $C^1$ 协调单元的挑战**\n\n在四面体（$d=3$）上构造 $C^1$-协调有限元是出了名的困难。对自由度（DoFs）的分析揭示了问题的核心。为了使标量分量 $u_i$ 在一个三角形面 $F$ 上具有 $C^1$ 连续性，函数的迹 $u_i|_F$ 和其法向导数的迹 $\\partial u_i/\\partial n|_F$ 必须是连续的。如果 $u_i$ 在四面体内是次数为 $p$ 的多项式，那么在一个面上定义 $C^1$-迹的独立参数数量为 $T_{\\mathrm{face}}(p) = (p+1)^2$。在一个四面体内，可用于定义 $p$ 次多项式的总系数数量是 $N_p(3) = \\binom{p+3}{3}$。\n\n比率 $R_{\\mathrm{all\\,faces}}(p) = 4 T_{\\mathrm{face}}(p) / N_p(3)$ 是对总约束的一个粗略的过高估计。\n- 对于 $p=2$：$N_2(3) = 10$， $T_{\\mathrm{face}}(2) = 9$。$R_{\\mathrm{all\\,faces}}(2) = 4 \\times 9 / 10 = 3.6$。\n- 对于 $p=3$：$N_3(3) = 20$， $T_{\\mathrm{face}}(3) = 16$。$R_{\\mathrm{all\\,faces}}(3) = 4 \\times 16 / 20 = 3.2$。\n- 对于 $p=5$：$N_5(3) = 56$， $T_{\\mathrm{face}}(5) = 36$。$R_{\\mathrm{all\\,faces}}(5) = 4 \\times 36 / 56 \\approx 2.571$。\n\n$R_{\\mathrm{all\\,faces}}(p)$ 显著大于 1 的事实说明了这一挑战。定义所有四个面上的迹所需的参数数量远超过可用的多项式系数数量。这表明这些迹不是独立的；它们通过单元边和顶点处的强相容性条件联系在一起。用一组局部自由度同时满足所有这些约束在代数上是非常困难的。这迫使人们使用非常高的多项式次数或采用非协调/不连续伽辽金方法，这些方法以更复杂的变分形式为代价，放宽了严格的连续性要求。这种现象被称为“迹的暴政”，是工程分析中实用 $C^1$-协调四面体单元稀少且复杂性的根本原因。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import comb\n\ndef solve():\n    \"\"\"\n    Computes results for Tasks B and C based on the problem statement.\n    \"\"\"\n    m_orders = [1, 2, 3]\n    p_degrees = [2, 3, 4, 5, 6]\n    \n    results = []\n\n    # Task B: Continuity requirements from derivative order m\n    for m in m_orders:\n        r = m - 1\n        requires_at_least_c1 = 1 if m >= 2 else 0\n        exactly_c1_sufficient = 1 if m == 2 else 0\n        results.extend([r, requires_at_least_c1, exactly_c1_sufficient])\n        \n    # Task C: Ratios for C1-conforming tetrahedral elements\n    d = 3 # Dimension is 3 for tetrahedra\n    for p in p_degrees:\n        # N_p(3) = C(p+3, 3)\n        # We use exact=True to ensure integer result\n        Np3 = comb(p + d, d, exact=True)\n        \n        # T_face(p) = (p+1)^2\n        T_face_p = (p + 1)**2\n        \n        # Calculate R_face(p)\n        R_face_p = T_face_p / Np3\n        \n        # Calculate R_all_faces(p)\n        R_all_faces_p = 4 * T_face_p / Np3\n        \n        results.extend([\n            Np3,\n            T_face_p,\n            round(R_face_p, 6),\n            round(R_all_faces_p, 6)\n        ])\n\n    # Final print statement in the exact required format.\n    # The output is a single flat list of numbers.\n    # Booleans are already converted to 0/1 integers.\n    # Floats are rounded as required.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2919600"}]}