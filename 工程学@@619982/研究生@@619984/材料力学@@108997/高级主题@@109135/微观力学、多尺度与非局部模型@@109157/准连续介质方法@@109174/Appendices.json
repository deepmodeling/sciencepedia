{"hands_on_practices": [{"introduction": "这个首个练习旨在为您打下坚实的基础。我们将把准连续介质 (Quasicontinuum, QC) 方法的核心原理——线性插值和柯西-玻恩法则 (Cauchy-Born rule)——应用于一个简单的一维原子链。通过亲手计算总能量和代表原子上的力，您将对 QC 方法如何将微观相互作用转化为粗粒化描述获得一个具体而深入的理解。[@problem_id:2923438]", "problem": "考虑一个由 $i=0,1,\\ldots,8$ 索引的 $9$ 个原子组成的一维链，其参考位置为 $X_i=i\\,a_0$，其中 $a_0>0$ 是参考最近邻间距。原子间相互作用仅限于最近邻，通过一个仅依赖于当前键长 $r$ 的对势 $\\phi(r)$ 来描述。该链通过准连续介质 (QuasiContinuum, QC) 方法进行粗粒化，使用一个双单元网格，其代表性原子（也称 repatom）位于 $i=0,4,8$ 处，从而定义了两个单元：单元 $1$ 跨越 $[X_0,X_4]$，单元 $2$ 跨越 $[X_4,X_8]$。假设在每个单元中采用局部 Cauchy–Born 近似，并在代表性原子之间进行位移的线性插值，同时使用均匀权重求和规则，该规则计算每个单元中的所有最近邻键。\n\n对势是关于 $a_0$ 的谐和势，即 $\\phi(r)=\\tfrac{1}{2}k\\,(r-a_0)^2$，其中刚度 $k>0$。设代表性原子的位移被指定为 $u_0=0$，$u_4=\\bar{u}$ 和 $u_8=2\\bar{u}$，其中 $\\bar{u}>0$ 是一个给定的常数。基于这些数据，QC 总势能定义为各单元贡献之和，每个单元的贡献通过计算该单元中 4 个键的能量得到，每个键的变形都与该单元的线性位移场保持一致。\n\n从线性位移场引起的键长变化和 Cauchy–Born 关系的定义出发，推导 QC 总能量 $E_{\\mathrm{QC}}(u)$ 作为代表性原子位移的函数。然后，使用具体值 $k=100~\\mathrm{N/m}$，$a_0=2.5\\times 10^{-10}~\\mathrm{m}$ 和 $\\bar{u}=4.0\\times 10^{-11}~\\mathrm{m}$ 计算 $E_{\\mathrm{QC}}(u)$。最后，通过微分 $\\mathbf{F}=-\\nabla E_{\\mathrm{QC}}(u)$ 求出代表性原子上的内部节点力，并在给定-位移处求值，然后报告 $F_0$，$F_4$ 和 $F_8$ 这三个分量。\n\n答案规格：\n- 能量以 $\\mathrm{J}$ 为单位，力以 $\\mathrm{N}$ 为单位表示。\n- 将所有报告的量四舍五入到三位有效数字。\n- 以单行矩阵的形式提供最终答案，矩阵中首先是 $E_{\\mathrm{QC}}(u)$，然后依次是 $F_0$，$F_4$ 和 $F_8$。", "solution": "首先对问题陈述进行验证。\n\n步骤 1：提取的已知条件。\n- 一个由 $i=0,1,\\ldots,8$ 索引的 $9$ 个原子组成的一维链。\n- 参考位置：$X_i=i\\,a_0$，其中晶格常数 $a_0>0$。\n- 相互作用势：最近邻谐和对势 $\\phi(r)=\\tfrac{1}{2}k\\,(r-a_0)^2$，其中刚度 $k>0$。\n- 粗粒化：准连续介质 (QC) 方法，代表性原子 (repatom) 位于索引 $0$、$4$ 和 $8$ 处。\n- 网格：两个单元，单元 $1$ 覆盖 $[X_0,X_4]$，单元 $2$ 覆盖 $[X_4,X_8]$。\n- 近似：局部 Cauchy–Born 规则及位移的线性插值。\n- 求和规则：均匀权重求和，每个单元计算 $4$ 个键。\n- 指定位移：$u_0=0$, $u_4=\\bar{u}$, $u_8=2\\bar{u}$。\n- 常数：$k=100~\\mathrm{N/m}$, $a_0=2.5\\times 10^{-10}~\\mathrm{m}$, $\\bar{u}=4.0\\times 10^{-11}~\\mathrm{m}$。\n- 要求输出：总 QC 能量 $E_{\\mathrm{QC}}(u)$ 和节点力 $F_0$，$F_4$，$F_8$，数值四舍五入到三位有效数字。\n\n步骤 2：使用提取的已知条件进行验证。\n该问题具有科学依据，因为它描述了准连续介质方法的一个标准应用，这是计算材料科学中一种成熟的多尺度技术。使用谐和势对应于线性弹性极限，而 Cauchy-Born 近似则是该方法的一个基本原则。该问题是适定的；它提供了所有必要的数据、参数和边界条件，以得出一个唯一的、有意义的解。定义清晰、自洽且一致。例如，单元 1 的域 $[X_0, X_4]$ 包含原子 $0, 1, 2, 3, 4$，因此包含四个最近邻键 $(0,1), (1,2), (2,3), (3,4)$，这与指定的 $4$ 个键的计数相符。单元 2 也是如此。数值对于原子体系而言是物理上合理的。该问题不违反任何无效标准。\n\n步骤 3：结论与行动。\n问题有效。将推导解答。\n\nQC 总能量 $E_{\\mathrm{QC}}(u)$ 的推导。\n总能量是两个单元能量之和，$E_{\\mathrm{QC}} = E^{(1)} + E^{(2)}$。\n\n对于单元 1，它跨越代表性原子 0 和 4，参考长度为 $L_1 = X_4 - X_0 = 4a_0$。对于 $X \\in [X_0, X_4]$，位移场 $u(X)$ 假设为线性：\n$$u(X) = u_0 \\left(1 - \\frac{X-X_0}{L_1}\\right) + u_4 \\left(\\frac{X-X_0}{L_1}\\right)$$\n宏观变形梯度 $F$ 在单元内是恒定的，由 $F = 1 + du/dX$ 给出。\n$$F^{(1)} = 1 + \\frac{u_4 - u_0}{X_4 - X_0} = 1 + \\frac{u_4 - u_0}{4a_0}$$\n根据局部 Cauchy–Born 近似，单元中的每个键都根据此宏观梯度变形。变形后的键长 $r^{(1)}$ 为：\n$$r^{(1)} = F^{(1)} a_0 = \\left(1 + \\frac{u_4 - u_0}{4a_0}\\right) a_0 = a_0 + \\frac{u_4 - u_0}{4}$$\n储存在单个此类键中的能量为：\n$$\\phi(r^{(1)}) = \\frac{1}{2}k(r^{(1)} - a_0)^2 = \\frac{1}{2}k\\left(\\frac{u_4 - u_0}{4}\\right)^2$$\n单元 1 包含 4 个键。使用均匀权重求和规则，单元 1 的能量为：\n$$E^{(1)} = 4 \\times \\phi(r^{(1)}) = 4 \\times \\frac{1}{2}k\\frac{(u_4 - u_0)^2}{16} = \\frac{k}{8}(u_4 - u_0)^2$$\n类似地，对于单元 2，它跨越代表性原子 4 和 8，参考长度为 $L_2 = X_8 - X_4 = 4a_0$：\n$$F^{(2)} = 1 + \\frac{u_8 - u_4}{X_8 - X_4} = 1 + \\frac{u_8 - u_4}{4a_0}$$\n$$r^{(2)} = F^{(2)} a_0 = a_0 + \\frac{u_8 - u_4}{4}$$\n单元 2 也包含 4 个键，其能量为：\n$$E^{(2)} = 4 \\times \\frac{1}{2}k(r^{(2)} - a_0)^2 = \\frac{k}{8}(u_8 - u_4)^2$$\nQC 总能量是各单元能量之和：\n$$E_{\\mathrm{QC}}(u_0, u_4, u_8) = E^{(1)} + E^{(2)} = \\frac{k}{8}(u_4 - u_0)^2 + \\frac{k}{8}(u_8 - u_4)^2$$\n\n能量的数值计算。\n代入指定的位移 $u_0=0$，$u_4=\\bar{u}$ 和 $u_8=2\\bar{u}$：\n$$E_{\\mathrm{QC}} = \\frac{k}{8}(\\bar{u} - 0)^2 + \\frac{k}{8}(2\\bar{u} - \\bar{u})^2 = \\frac{k}{8}\\bar{u}^2 + \\frac{k}{8}\\bar{u}^2 = \\frac{k}{4}\\bar{u}^2$$\n使用给定值 $k=100~\\mathrm{N/m}$ 和 $\\bar{u}=4.0\\times 10^{-11}~\\mathrm{m}$：\n$$E_{\\mathrm{QC}} = \\frac{100~\\mathrm{N/m}}{4} (4.0\\times 10^{-11}~\\mathrm{m})^2 = (25~\\mathrm{N/m}) \\times (16.0 \\times 10^{-22}~\\mathrm{m}^2) = 400 \\times 10^{-22}~\\mathrm{J} = 4.0 \\times 10^{-20}~\\mathrm{J}$$\n四舍五入到三位有效数字，能量为 $E_{\\mathrm{QC}} = 4.00 \\times 10^{-20}~\\mathrm{J}$。\n\n节点力的推导与计算。\n代表性原子上的内力由总势能的负梯度给出，$\\mathbf{F} = -\\nabla E_{\\mathrm{QC}}(u)$。其分量为 $F_i = -\\partial E_{\\mathrm{QC}} / \\partial u_i$。\n$$F_0 = -\\frac{\\partial E_{\\mathrm{QC}}}{\\partial u_0} = -\\frac{k}{8} \\cdot 2(u_4-u_0)(-1) = \\frac{k}{4}(u_4 - u_0)$$\n$$F_8 = -\\frac{\\partial E_{\\mathrm{QC}}}{\\partial u_8} = -\\frac{k}{8} \\cdot 2(u_8-u_4)(1) = -\\frac{k}{4}(u_8 - u_4)$$\n$$F_4 = -\\frac{\\partial E_{\\mathrm{QC}}}{\\partial u_4} = -\\left[ \\frac{k}{8} \\cdot 2(u_4-u_0)(1) + \\frac{k}{8} \\cdot 2(u_8-u_4)(-1) \\right] = -\\frac{k}{4}\\left[ (u_4-u_0) - (u_8-u_4) \\right] = -\\frac{k}{4}(2u_4 - u_0 - u_8)$$\n代入指定的位移 ($u_0=0, u_4=\\bar{u}, u_8=2\\bar{u}$) 和数值：\n$$F_0 = \\frac{k}{4}(\\bar{u} - 0) = \\frac{k}{4}\\bar{u} = \\frac{100}{4}(4.0\\times 10^{-11}) = 25 \\times 4.0\\times 10^{-11} = 100 \\times 10^{-11}~\\mathrm{N} = 1.0 \\times 10^{-9}~\\mathrm{N}$$\n保留三位有效数字，$F_0 = 1.00 \\times 10^{-9}~\\mathrm{N}$。\n\n$$F_8 = -\\frac{k}{4}(2\\bar{u} - \\bar{u}) = -\\frac{k}{4}\\bar{u} = -1.0 \\times 10^{-9}~\\mathrm{N}$$\n保留三位有效数字，$F_8 = -1.00 \\times 10^{-9}~\\mathrm{N}$。\n\n$$F_4 = -\\frac{k}{4}(2\\bar{u} - 0 - 2\\bar{u}) = -\\frac{k}{4}(0) = 0~\\mathrm{N}$$\n力 $F_4$ 恰好为零，因为应变在两个单元上是均匀的。均匀应变意味着单元 1 施加在代表性原子 4 上的力与单元 2 施加在代表性原子 4 上的力大小相等，方向相反。其值恰好为 $0$。\n\n最终结果为 $E_{\\mathrm{QC}} = 4.00 \\times 10^{-20}~\\mathrm{J}$，$F_0 = 1.00 \\times 10^{-9}~\\mathrm{N}$，$F_4 = 0~\\mathrm{N}$ 和 $F_8 = -1.00 \\times 10^{-9}~\\mathrm{N}$。", "answer": "$$\\boxed{\\begin{pmatrix} 4.00 \\times 10^{-20} & 1.00 \\times 10^{-9} & 0 & -1.00 \\times 10^{-9} \\end{pmatrix}}$$", "id": "2923438"}, {"introduction": "柯西-玻恩法则 (Cauchy-Born rule) 是准连续介质方法的基石，但它并非普遍适用。本练习将挑战您去研究一个该法则失效的场景，特别是在材料被驱动进入力学不稳定性区域时。通过比较均匀形变的柯西-玻恩假设所预测的应力与一个允许微结构变化的更精确原子计算结果，您将识别并量化其误差，从而揭示材料稳定性对于 QC 方法的关键重要性。[@problem_id:2923419]", "problem": "您将通过比较均匀变形预测的应力与在相同宏观应变下从最小原子微结构获得的应力，在准连续介质方法的情境下，为 Cauchy–Born 法则构建并量化一个严格的反例。考虑一个一维无限长的相同原子链，其最近邻相互作用由 Lennard–Jones 势描述\n$$\n\\phi(r) = 4 \\varepsilon \\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right],\n$$\n其中 $r$ 是键长，$\\varepsilon$ 是能量标度，$\\sigma$ 是长度标度。参考晶格间距 $a_0$ 是 $\\phi$ 的最小值点，即 $a_0 = \\operatorname{argmin}_r \\phi(r)$，该值在 $a_0 = 2^{1/6}\\sigma$ 处取得。您将施加一个宏观拉伸 $F$，使得平均键长等于 $F a_0$。Cauchy–Born 法则 (CB) 假设变形是均匀的，而原子计算可能会实现一个非均匀的周期倍增微结构，该结构具有两个交替的键长 $l_1$ 和 $l_2$，满足平均约束 $l_1 + l_2 = 2 F a_0$。\n\n仅从 Newton 定律、能量最小化原理以及第一 Piola–Kirchhoff (PK1) 应力是能量关于变形的导数的定义出发，您必须推导出：\n- 在均匀变形假设下，由 Cauchy-Born 法则预测的 PK1 应力。\n- 在平均约束 $l_1 + l_2 = 2 F a_0$ 下，使总势能最小化的原子双原子周期晶胞所产生的 PK1 应力（在 $\\phi$ 的非凸区域可能导致 $l_1 \\neq l_2$）。\n- 这两个应力预测值之间的绝对误差，由 $|P_{\\mathrm{atom}} - P_{\\mathrm{CB}}|$ 给出。\n\n假设使用约化单位，其中 $\\varepsilon = 1$ 和 $\\sigma = 1$，因此应力以 $\\varepsilon/\\sigma$ 为单位表示。您的程序必须：\n- 使用 $\\sigma = 1$ 计算 $a_0 = 2^{1/6}\\sigma$。\n- 对于每个给定的宏观拉伸 $F$，如上所述计算 Cauchy–Born PK1 应力和原子 PK1 应力。\n- 为每个测试用例输出 PK1 应力的绝对误差 $|P_{\\mathrm{atom}} - P_{\\mathrm{CB}}|$。\n\n测试套件：\n- 使用以下宏观拉伸 $F$：$[1.00, 1.10, 1.12, 1.20, 1.30]$。\n- 选择这些值是为了探测：一个稳定的均匀区域（$F=1.00$ 附近）、一个刚好在非凸性起始点以下的区域（$F=1.10$）、一个刚好在非凸性起始点以上的区域（$F=1.12$），以及更深入的非凸区域（$F=1.20$ 和 $F=1.30$），在这些区域 Cauchy–Born 法则可能会失效。\n\n要求输出：\n- 以 $\\varepsilon/\\sigma$ 为单位表示绝对误差。\n- 将每个结果四舍五入到 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[0.000000,0.123456,0.000001,0.500000,0.750000]$）。不应有多余的空格或文本。\n\n注意事项：\n- 此问题不涉及角度。\n- 所有计算都应在约化单位下执行，其中 $\\varepsilon = 1$ 和 $\\sigma = 1$。\n- 不应读取任何输入；指定的测试套件必须硬编码，并在程序运行时自动执行。", "solution": "该问题要求为一维原子链构建并分析一个对 Cauchy–Born 法则的反例。问题陈述的验证已经完成。该问题具有科学依据、是适定的、客观的，并包含严格求解所需的所有必要信息。我们可以继续。\n\n分析在约化单位下进行，其中 $\\varepsilon = 1$ 和 $\\sigma = 1$。\n\n**1. 原子间势与参考态**\n\n最近邻原子间的相互作用由 Lennard-Jones 势描述：\n$$\n\\phi(r) = 4\\varepsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6 \\right] = 4 \\left( r^{-12} - r^{-6} \\right)\n$$\n其中 $r$ 是原子间距离。\n\n参考晶格间距 $a_0$ 是使势能 $\\phi(r)$ 最小的键长。这可以通过将势的一阶导数设为零来找到：\n$$\n\\frac{d\\phi}{dr} = \\phi'(r) = 4 \\left( -12r^{-13} + 6r^{-7} \\right) = 0\n$$\n这得出 $6r^{-7} = 12r^{-13}$，简化为 $r^6 = 2$。因此，参考晶格间距为：\n$$\na_0 = 2^{1/6}\\sigma = 2^{1/6}\n$$\n在此间距下，原子间的力为零，因为 $\\phi'(a_0)=0$。\n\n**2. 第一 Piola-Kirchhoff (PK1) 应力的定义**\n\n在一维情况下，PK1 应力 $P$ 定义为能量密度 $\\mathcal{E}$ 对宏观变形梯度 $F$ 的导数。能量密度 $\\mathcal{E}$ 是单位参考长度的能量。对于一个由键组成的系统，这是每个键的能量除以每个键的参考长度 $a_0$。\n$$\nP = \\frac{\\partial \\mathcal{E}}{\\partial F} = \\frac{1}{a_0} \\frac{\\partial E_{\\text{bond}}}{\\partial F}\n$$\n\n**3. Cauchy–Born (CB) 应力预测**\n\nCauchy–Born 法则假设宏观变形 $F$ 在原子尺度上是均匀施加的。这意味着一个均匀变形，其中每个键的长度都相同，为 $r_{\\mathrm{CB}}$：\n$$\nr_{\\mathrm{CB}} = F a_0\n$$\n每个键的能量就是在此长度下计算的势能，即 $E_{\\mathrm{CB}}(F) = \\phi(r_{\\mathrm{CB}}) = \\phi(F a_0)$。\n\n那么，在 CB 假设下的 PK1 应力 $P_{\\mathrm{CB}}$ 为：\n$$\nP_{\\mathrm{CB}}(F) = \\frac{1}{a_0} \\frac{d}{dF} \\left[ \\phi(F a_0) \\right]\n$$\n应用链式法则，$\\frac{d}{dF} = \\frac{dr_{\\mathrm{CB}}}{dF} \\frac{d}{dr_{\\mathrm{CB}}} = a_0 \\frac{d}{dr_{\\mathrm{CB}}}$，我们得到：\n$$\nP_{\\mathrm{CB}}(F) = \\frac{1}{a_0} \\left( a_0 \\cdot \\phi'(F a_0) \\right) = \\phi'(F a_0)\n$$\n代入 $\\phi'(r)$ 的表达式：\n$$\nP_{\\mathrm{CB}}(F) = 24(F a_0)^{-7} - 48(F a_0)^{-13}\n$$\n\n**4. 原子应力预测**\n\n原子模型考虑一个最小微结构：一个具有两个交替键长 $l_1$ 和 $l_2$ 的周期倍增晶胞。宏观拉伸 $F$ 作为对平均键长的约束施加：\n$$\n\\frac{l_1 + l_2}{2} = F a_0 \\implies l_1 + l_2 = 2F a_0\n$$\n这个双键晶胞的能量是 $E_{\\mathrm{cell}} = \\phi(l_1) + \\phi(l_2)$。实际的键长是在约束条件下使 $E_{\\mathrm{cell}}$ 最小化的值。我们可以将能量表示为仅关于 $l_1$ 的函数：\n$$\nE_{\\mathrm{cell}}(l_1) = \\phi(l_1) + \\phi(2F a_0 - l_1)\n$$\n驻点的条件是 $\\frac{dE_{\\mathrm{cell}}}{dl_1} = 0$：\n$$\n\\frac{dE_{\\mathrm{cell}}}{dl_1} = \\phi'(l_1) - \\phi'(2F a_0 - l_1) = 0 \\implies \\phi'(l_1) = \\phi'(l_2)\n$$\n这个平衡条件意味着两个键中的内力必须相等。\n\n均匀解（其中 $l_1 = l_2 = F a_0$）的稳定性取决于晶胞能量的二阶导数，这对应于势 $\\phi(r)$ 的凸性。\n$$\n\\frac{d^2 E_{\\mathrm{cell}}}{dl_1^2} \\bigg|_{l_1 = F a_0} = \\phi''(F a_0) + \\phi''(F a_0) = 2\\phi''(F a_0)\n$$\n只有当 $2\\phi''(F a_0) > 0$ 时，均匀解才是稳定的。当 $\\phi''(r) < 0$ 时，势变为非凸。我们来求拐点 $r_c$，在该点处 $\\phi''(r_c) = 0$。\n$$\n\\phi''(r) = 4 \\left( 156 r^{-14} - 42 r^{-8} \\right) = 0\n$$\n这得出 $r_c^6 = \\frac{156}{42} = \\frac{26}{7}$。所以，$r_c = (26/7)^{1/6}$。如果键长 $F a_0$ 超过 $r_c$，均匀变形就不稳定。这定义了一个临界拉伸 $F_c$：\n$$\nF_c = \\frac{r_c}{a_0} = \\frac{(26/7)^{1/6}}{(2)^{1/6}} = \\left(\\frac{13}{7}\\right)^{1/6} \\approx 1.1086\n$$\n对于 $F \\le F_c$，稳定解是均匀的，$l_1 = l_2 = F a_0$。对于 $F > F_c$，均匀解是不稳定的，系统会分叉到一个 $l_1 \\neq l_2$ 的非均匀状态。\n\n原子应力 $P_{\\mathrm{atom}}$ 是从双键晶胞的能量推导出来的。能量密度为 $\\mathcal{E}_{\\mathrm{atom}} = \\frac{E_{\\mathrm{cell}}}{2a_0} = \\frac{\\phi(l_1(F)) + \\phi(l_2(F))}{2a_0}$。\n$$\nP_{\\mathrm{atom}}(F) = \\frac{\\partial \\mathcal{E}_{\\mathrm{atom}}}{\\partial F} = \\frac{1}{2a_0} \\left( \\phi'(l_1) \\frac{dl_1}{dF} + \\phi'(l_2) \\frac{dl_2}{dF} \\right)\n$$\n使用平衡条件 $\\phi'(l_1) = \\phi'(l_2) \\equiv \\phi'_{\\min}$ 和约束的导数 $\\frac{dl_1}{dF} + \\frac{dl_2}{dF} = 2a_0$，我们得到：\n$$\nP_{\\mathrm{atom}}(F) = \\frac{\\phi'_{\\min}}{2a_0} \\left( \\frac{dl_1}{dF} + \\frac{dl_2}{dF} \\right) = \\frac{\\phi'_{\\min}}{2a_0} (2a_0) = \\phi'_{\\min}\n$$\n因此，$P_{\\mathrm{atom}}(F) = \\phi'(l_1)$，其中 $l_1$是使能量最小化的键长。\n\n**5. 计算算法**\n\n对于每个给定的宏观拉伸 $F$：\n1. 计算 $a_0 = 2^{1/6}$ 和 $F_c = (13/7)^{1/6}$。\n2. 计算 Cauchy-Born 应力：$P_{\\mathrm{CB}} = \\phi'(F a_0)$。\n3. 将 $F$ 与 $F_c$ 进行比较：\n    * 如果 $F \\le F_c$，系统保持均匀。原子模型给出 $l_1 = l_2 = F a_0$，因此 $P_{\\mathrm{atom}} = \\phi'(F a_0) = P_{\\mathrm{CB}}$。误差为 $0$。\n    * 如果 $F > F_c$，系统发生分叉。我们必须通过数值求解关于 $l_1, l_2$ 的方程组来找到非均匀解：\n        $$\n        \\begin{cases}\n        \\phi'(l_1) = \\phi'(l_2) \\\\\n        l_1 + l_2 = 2F a_0\n        \\end{cases}\n        $$\n        这等价于为 $x \\neq F a_0$ 求解函数 $f(x) = \\phi'(x) - \\phi'(2F a_0 - x)$ 的一个根 $l_1^*$。基于对 $\\phi'(r)$ 的分析，较短键长 $l_1^*$ 的物理上有意义的解位于区间 $(a_0, r_c)$ 内。在此区间上使用数值求根算法。\n4. 一旦找到 $l_1^*$，原子应力即为 $P_{\\mathrm{atom}} = \\phi'(l_1^*)$。\n5. 绝对误差为 $|P_{\\mathrm{atom}} - P_{\\mathrm{CB}}|$。这个差值量化了 Cauchy-Born 法则的失效程度。\n\n这个过程提供了一个计算所需应力误差的严格方法。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Computes the absolute error between the Cauchy-Born and atomistic PK1 stress\n    for a 1D atomic chain with Lennard-Jones interactions.\n    \"\"\"\n\n    # Reduced units are used, with epsilon = 1 and sigma = 1.\n    SIGMA = 1.0\n    EPSILON = 1.0\n\n    # Test cases for macroscopic stretch F\n    test_cases = [1.00, 1.10, 1.12, 1.20, 1.30]\n\n    # Pre-calculated constants based on the problem statement\n    # Reference lattice spacing a0 minimizes the potential, a0 = 2^(1/6) * sigma\n    a0 = np.power(2.0, 1.0/6.0) * SIGMA\n    \n    # Critical bond length rc is the inflection point of the potential, rc^6 = 26/7\n    rc = np.power(26.0/7.0, 1.0/6.0) * SIGMA\n    \n    # Critical stretch Fc corresponds to the onset of instability, Fc = rc / a0\n    Fc = rc / a0\n\n    def phi_prime(r):\n        \"\"\"\n        First derivative of the Lennard-Jones potential (proportional to force).\n        phi'(r) = 4 * epsilon * (-12 * sigma^12 / r^13 + 6 * sigma^6 / r^7)\n        In reduced units, this simplifies to:\n        phi'(r) = 24 / r^7 - 48 / r^13\n        \"\"\"\n        r_inv = SIGMA / r\n        r_inv6 = np.power(r_inv, 6)\n        r_inv12 = r_inv6 * r_inv6\n        \n        # The true phi'(r) is below. The simplified form 24r^-7 - 48r^-13 works fine.\n        return 4.0 * EPSILON * (-12.0 * r_inv12 / r + 6.0 * r_inv6 / r)\n\n    results = []\n    \n    for F in test_cases:\n        # Calculate the bond length under homogeneous (Cauchy-Born) deformation\n        r_cb = F * a0\n        \n        # Calculate the Cauchy-Born PK1 stress\n        # P_CB = phi'(r_cb)\n        P_cb = phi_prime(r_cb)\n        \n        P_atom = 0.0\n        \n        # Check for stability. The CB rule holds if F = Fc.\n        if F = Fc:\n            # In the stable regime, the atomistic solution is homogeneous.\n            P_atom = P_cb\n        else:\n            # In the unstable regime (F > Fc), the system bifurcates.\n            # We need to find the non-homogeneous solution {l1, l2} that minimizes energy.\n            # This requires solving phi'(l1) = phi'(l2) with l1 + l2 = 2 * F * a0.\n            \n            # Define the function whose root we need to find.\n            def root_func(l1):\n                l2 = 2 * r_cb - l1\n                return phi_prime(l1) - phi_prime(l2)\n            \n            # The smaller bond length l1 must be in the interval (a0, rc).\n            # This bracket is guaranteed to contain the root for F > Fc.\n            bracket = [a0, rc]\n\n            # Use SciPy's root finder to find the energy-minimizing l1.\n            # Trivial solution is l1 = r_cb, we search for the other one.\n            sol = root_scalar(root_func, bracket=bracket, method='brentq')\n            \n            if sol.converged:\n                l1_sol = sol.root\n                # The atomistic stress is phi'(l1_sol)\n                P_atom = phi_prime(l1_sol)\n            else:\n                # Should not happen with the correct bracket and problem setup.\n                # In case of failure, treat as error.\n                P_atom = np.nan\n\n        # Calculate the absolute error between atomistic and CB stress predictions.\n        error = np.abs(P_atom - P_cb)\n        results.append(error)\n\n    # Format the output as a comma-separated list of strings, rounded to 6 decimal places.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2923419"}, {"introduction": "任何多尺度方法都面临一个重大挑战：如何确保不同描述尺度之间的“握手”是无缝的。本练习揭示了 QC 方法中一种常见的赝像，即“幽灵力” (ghost forces)——即使在均匀形变下，这些伪力也会在原子和连续介质区域的界面处出现。通过构建一个简单的一维模型，您将从解析上推导出这种幽灵力的来源和表达式，从而对原子/连续介质耦合的微妙复杂性获得批判性的洞察。[@problem_id:2678008]", "problem": "考虑一个一维 ($1$D) 无限长原子链，其参考晶格参数为 $a0$，原子由索引 $i \\in \\mathbb{Z}$ 标记，参考位置为 $x_i = i a$。形变后的位置用 $y_i \\in \\mathbb{R}$ 表示。总原子能量是直至次近邻的对相互作用之和，\n$$\nE^{\\mathrm{atom}}(y) \\;=\\; \\sum_{i \\in \\mathbb{Z}} \\Big[ \\phi_1\\!\\big(|y_{i+1}-y_i|\\big) + \\phi_2\\!\\big(|y_{i+2}-y_i|\\big) \\Big],\n$$\n其中 $\\phi_1$ 和 $\\phi_2$ 分别是最近邻和次近邻相互作用的光滑对势。力由能量梯度定义，即原子 $i$ 上的力为 $f_i(y) = -\\partial E/\\partial y_i$。\n\n对于一个固定的拉伸率 $F0$，均匀宏观形变由 $y_i = F x_i = F i a$ 给出。在全原子模型中，对称性意味着在这种均匀形变下，对所有 $i$ 都有 $f_i(y)=0$。\n\n在准连续介质 (QC) 方法中，将伪力定义为在均匀形变下预测出的非零力。在 $1$D 中构建如下基于能量的原子/连续介质 (a/c) 耦合，其界面位于原子区域 $\\mathcal{A} = \\{ i \\in \\mathbb{Z} : i \\le 0 \\}$ 和连续介质区域 $\\mathcal{C} = \\{ i \\in \\mathbb{Z} : i \\ge 1 \\}$ 之间：\n\n- 所有最近邻键在任何地方都精确保留，即每对 $\\{i,i+1\\}$ 对 QC 能量的贡献为 $\\phi_1(|y_{i+1}-y_i|)$。\n\n- 完全包含在 $\\mathcal{A}$ 内的次近邻键的贡献是精确的，即每对 $i+2 \\le 0$ 的 $\\{i,i+2\\}$ 的贡献为 $\\phi_2(|y_{i+2}-y_i|)$。\n\n- 完全包含在 $\\mathcal{C}$ 内的次近邻键由 Cauchy–Born 连续介质能量近似，该能量是 $\\mathcal{C}$ 中恒定形变梯度 $F$ 的函数；具体来说，每个这样的键的贡献为 $\\phi_2(2Fa)$，并且此连续介质能量仅依赖于 $\\mathcal{C}$ 中的自由度（因此其关于 $y_0$ 的变分为零）。\n\n- 跨越界面（即一端在 $\\mathcal{A}$ 中，另一端在 $\\mathcal{C}$ 中）的次近邻键在 QC 能量中没有被显式地表示。\n\n在均匀形变 $y_i = F i a$ 下，计算界面原子 $i=0$ 上的 QC 净力。这个非零力就是这种基于能量的 QC 耦合中 a/c 界面处的伪力。请以 $F$、$a$ 和在相关键长处求值的势函数导数的形式，提供您的最终答案，作为一个单一的闭式解析表达式。最终答案中不包含单位。如果可以简化，请提供与所述假设一致的最简表达式。", "solution": "该问题要求计算在均匀形变下，界面原子 $i=0$ 上的准连续介质 (QC) 净力。这个力被称为伪力，因为在一个完全一致的粗粒化模型中，它应该为零。\n\n首先，验证问题陈述。\n逐字提取已知条件：\n- 系统：$1$D 无限长原子链，参考位置 $x_i = i a$，其中 $i \\in \\mathbb{Z}$ 且 $a0$。形变后位置为 $y_i$。\n- 原子能量：$E^{\\mathrm{atom}}(y) = \\sum_{i \\in \\mathbb{Z}} [ \\phi_1(|y_{i+1}-y_i|) + \\phi_2(|y_{i+2}-y_i|) ]$。\n- 力：$f_i(y) = -\\partial E/\\partial y_i$。\n- 均匀形变：$y_i = F x_i = F i a$，其中 $F0$。\n- QC 划分：原子区域 $\\mathcal{A} = \\{ i \\in \\mathbb{Z} : i \\le 0 \\}$，连续介质区域 $\\mathcal{C} = \\{ i \\in \\mathbb{Z} : i \\ge 1 \\}$。\n- QC 能量构建：\n    1. 所有最近邻 (NN) 键 $\\{i,i+1\\}$ 的贡献为 $\\phi_1(|y_{i+1}-y_i|)$。\n    2. $i \\le -2$ 的次近邻 (NNN) 键 $\\{i,i+2\\}$ 的贡献为 $\\phi_2(|y_{i+2}-y_i|)$。\n    3. $i \\ge 1$ 的 NNN 键 $\\{i,i+2\\}$ 被近似，其能量贡献关于 $y_0$ 的变分为零。\n    4. 跨越界面的 NNN 键，即 $\\{ -1, 1 \\}$ 和 $\\{ 0, 2 \\}$，未在 QC 能量中表示。\n\n该问题具有科学依据，提法恰当，客观，并包含足够的信息以获得唯一解。这是研究准连续介质方法中的一个标准问题。因此，该问题是有效的。\n\n原子 $k$ 上的力定义为总能量对其位置 $y_k$ 的负梯度：$f_k^{\\mathrm{qc}} = -\\frac{\\partial E^{\\mathrm{qc}}}{\\partial y_k}$。我们被要求计算界面原子 $k=0$ 上的这个力。\n总 QC 能量 $E^{\\mathrm{qc}}$ 根据所提供的规则构建：\n$$\nE^{\\mathrm{qc}}(y) = \\sum_{i \\in \\mathbb{Z}} \\phi_1(|y_{i+1}-y_i|) + \\sum_{i \\in \\mathbb{Z}, i \\le -2} \\phi_2(|y_{i+2}-y_i|) + E_{\\mathcal{C}}^{\\mathrm{NNN}}(y_j | j \\ge 1)\n$$\n其中 $E_{\\mathcal{C}}^{\\mathrm{NNN}}$ 是来自连续介质区域 $\\mathcal{C}$ 中 NNN 键的能量，根据定义，它不依赖于 $y_0$。请注意，在全原子求和中对应于 $i=-1$ 和 $i=0$ 的跨界面 NNN 键，已从该能量表达式中省略。\n\n为了求出原子 0 上的力 $f_0^{\\mathrm{qc}}$，我们必须对 $E^{\\mathrm{qc}}$ 求关于 $y_0$ 的导数。我们只需要考虑 $E^{\\mathrm{qc}}$ 中是 $y_0$ 的函数的项。\n1. 从 NN 相互作用之和 $\\sum_i \\phi_1(|y_{i+1}-y_i|)$ 中，涉及 $y_0$ 的项是当 $i=0$ 和 $i=-1$ 时：$\\phi_1(|y_1 - y_0|)$ 和 $\\phi_1(|y_0 - y_{-1}|)$。\n2. 从 $\\mathcal{A}$ 中 NNN 相互作用之和 $\\sum_{i \\le -2} \\phi_2(|y_{i+2}-y_i|)$ 中，涉及 $y_0$ 的项是当 $i+2=0$ 时，即 $i=-2$。这满足条件 $i \\le -2$。所以，该项是 $\\phi_2(|y_0 - y_{-2}|)$。对应于 $i=0$ 的项不在此和中。\n3. 根据定义，连续介质能量 $E_{\\mathcal{C}}^{\\mathrm{NNN}}$ 满足 $\\frac{\\partial E_{\\mathcal{C}}^{\\mathrm{NNN}}}{\\partial y_0} = 0$。\n4. 原子 0 和原子 2 之间的 NNN 相互作用被明确排除。\n\n因此，QC 能量中依赖于 $y_0$ 的部分是：\n$$\nE_{y_0-\\text{dep}}^{\\mathrm{qc}} = \\phi_1(|y_1 - y_0|) + \\phi_1(|y_0 - y_{-1}|) + \\phi_2(|y_0 - y_{-2}|)\n$$\n原子 0 上的力为 $f_0^{\\mathrm{qc}} = -\\frac{\\partial}{\\partial y_0} E_{y_0-\\text{dep}}^{\\mathrm{qc}}$。让我们使用链式法则计算每一项的导数，其中 $\\phi'(r) = \\frac{d\\phi}{dr}(r)$。\n$$\n\\frac{\\partial}{\\partial y_k} \\phi(|y_j - y_i|) = \\phi'(|y_j - y_i|) \\cdot \\mathrm{sgn}(y_j - y_i) \\cdot (\\delta_{kj} - \\delta_{ki})\n$$\n将此应用于我们的各项：\n- 对于 $\\phi_1(|y_1-y_0|)$：$i=0, j=1, k=0$。导数为 $\\phi_1'(|y_1-y_0|) \\mathrm{sgn}(y_1-y_0) (-1) = -\\phi_1'(|y_1-y_0|) \\mathrm{sgn}(y_1-y_0)$。\n- 对于 $\\phi_1(|y_0-y_{-1}|)$：$i=-1, j=0, k=0$。导数为 $\\phi_1'(|y_0-y_{-1}|) \\mathrm{sgn}(y_0-y_{-1}) (1) = \\phi_1'(|y_0-y_{-1}|) \\mathrm{sgn}(y_0-y_{-1})$。\n- 对于 $\\phi_2(|y_0-y_{-2}|)$：$i=-2, j=0, k=0$。导数为 $\\phi_2'(|y_0-y_{-2}|) \\mathrm{sgn}(y_0-y_{-2}) (1) = \\phi_2'(|y_0-y_{-2}|) \\mathrm{sgn}(y_0-y_{-2})$。\n\n将这些导数相加得到 $\\frac{\\partial E^{\\mathrm{qc}}}{\\partial y_0}$。力是这个和的负值：\n$$\nf_0^{\\mathrm{qc}} = -\\left[ -\\phi_1'(|y_1-y_0|)\\mathrm{sgn}(y_1-y_0) + \\phi_1'(|y_0-y_{-1}|)\\mathrm{sgn}(y_0-y_{-1}) + \\phi_2'(|y_0-y_{-2}|)\\mathrm{sgn}(y_0-y_{-2}) \\right]\n$$\n现在，我们针对均匀形变 $y_i = F i a$ （其中 $F0$ 且 $a0$）计算此表达式的值。\n- 键长 $y_1 - y_0 = F(1)a - F(0)a = Fa$。由于 $Fa0$，所以 $|y_1-y_0| = Fa$ 且 $\\mathrm{sgn}(y_1-y_0)=1$。\n- 键长 $y_0 - y_{-1} = F(0)a - F(-1)a = Fa$。由于 $Fa0$，所以 $|y_0-y_{-1}| = Fa$ 且 $\\mathrm{sgn}(y_0-y_{-1})=1$。\n- 键长 $y_0 - y_{-2} = F(0)a - F(-2)a = 2Fa$。由于 $2Fa0$，所以 $|y_0-y_{-2}| = 2Fa$ 且 $\\mathrm{sgn}(y_0-y_{-2})=1$。\n\n将这些代入力表达式中：\n$$\nf_0^{\\mathrm{qc}} = -\\left[ -\\phi_1'(Fa) \\cdot (1) + \\phi_1'(Fa) \\cdot (1) + \\phi_2'(2Fa) \\cdot (1) \\right]\n$$\n$$\nf_0^{\\mathrm{qc}} = -\\left[ -\\phi_1'(Fa) + \\phi_1'(Fa) + \\phi_2'(2Fa) \\right]\n$$\n$$\nf_0^{\\mathrm{qc}} = - [ 0 + \\phi_2'(2Fa) ] = -\\phi_2'(2Fa)\n$$\n这个非零力就是界面处的伪力。它产生的原因是，在 QC 能量公式中，来自原子 2 对原子 0 的力贡献缺失了，从而打破了全原子系统中存在的力的平衡。在原子系统中，来自原子 2 对原子 0 的力将是 $\\phi_2'(|y_2-y_0|)\\mathrm{sgn}(y_2-y_0) = \\phi_2'(2Fa)$，这正好是在均匀形变下作用于原子 0 的所有其他力的总和的负值，从而确保总力为零。QC 方法对这单个相互作用项的忽略导致了计算出的残余力。\n最终表达式是用 $F$、$a$ 以及在 NNN 键长 $2Fa$ 处求值的势函数 $\\phi_2$ 的导数表示的。", "answer": "$$\n\\boxed{-\\phi_2'(2Fa)}\n$$", "id": "2678008"}]}