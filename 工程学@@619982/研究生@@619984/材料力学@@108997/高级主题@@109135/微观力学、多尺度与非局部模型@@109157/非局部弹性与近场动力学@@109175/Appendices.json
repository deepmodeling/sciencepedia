{"hands_on_practices": [{"introduction": "非局部理论的一个关键特征在于它们如何描述波的传播。本练习提供了一种直观的方法，让您了解非局部积分公式如何自然地导致色散现象，即波速依赖于波长——这是简单的经典模型无法捕捉的现象。通过分析一个在一维杆中传播的谐波位移场，您将亲自推导近场动力学模型的色散关系[@problem_id:2905383]。", "problem": "考虑一根由基于键的线性近场动力学 (PD) 建模的无限长、均匀一维弹性杆。设质量密度为 $\\,\\rho\\,$，视域为 $\\,\\delta>0\\,$。微模量函数规定如下：\n$$\nc(|\\xi|)=\n\\begin{cases}\nc_{0}, & |\\xi|\\le \\delta,\\\\\n0, & |\\xi|>\\delta,\n\\end{cases}\n$$\n其中 $\\,c_{0}>0\\,$ 为常数。在点 $\\,x\\,$ 和时间 $\\,t\\,$ 的近场动力学内力密度定义为\n$$\nf_{\\text{int}}(x,t)=\\int_{-\\delta}^{\\delta} c(|\\xi|)\\,\\big(u(x+\\xi,t)-u(x,t)\\big)\\,d\\xi,\n$$\n运动方程（体力为零）为\n$$\n\\rho\\,\\frac{\\partial^{2} u}{\\partial t^{2}}(x,t)=f_{\\text{int}}(x,t).\n$$\n假设一个空间谐波位移场\n$$\nu(x,t)=u_{0}\\,\\sin(k x)\\,\\exp(-\\mathrm{i}\\,\\omega t),\n$$\n其中振幅为 $\\,u_{0}\\in\\mathbb{R}\\,$，波数为 $\\,k>0\\,$，角频率为 $\\,\\omega>0\\,$。此处 $\\,k\\,$ 的单位为弧度/米，$\\,\\omega\\,$ 的单位为弧度/秒。\n\n仅使用上述定义和定律，首先计算任意点 $\\,x\\,$ 处的近场动力学内力密度 $\\,f_{\\text{int}}(x,t)\\,$，然后通过应用运动方程推导连接 $\\,\\omega\\,$ 和 $\\,k\\,$ 的色散关系。请以 $\\,\\rho\\,$, $\\,c_{0}\\,$, $\\,\\delta\\,$ 和 $\\,k\\,$ 表示 $\\,\\omega^{2}(k)\\,$ 的单个闭式解析表达式作为最终答案。最终的方框答案中请勿包含单位。无需进行四舍五入。", "solution": "问题陈述已经过验证，被认为是内容自洽、有科学依据且适定的。它属于非局部介质力学领域的一个标准练习。我们现在开始进行推导。\n\n目标是通过将假设的谐波位移场代入近场动力学运动方程来求出色散关系 $\\omega^{2}(k)$。\n\n运动方程如下：\n$$\n\\rho\\,\\frac{\\partial^{2} u}{\\partial t^{2}}(x,t)=f_{\\text{int}}(x,t)\n$$\n其中 $\\rho$ 是质量密度。\n\n假设的位移场为：\n$$\nu(x,t)=u_{0}\\,\\sin(k x)\\,\\exp(-\\mathrm{i}\\,\\omega t)\n$$\n其中振幅为 $u_{0}\\in\\mathbb{R}$，波数为 $k>0$，角频率为 $\\omega>0$。\n\n首先，我们计算运动方程的左侧 (LHS)。这需要计算 $u(x,t)$ 关于时间 $t$ 的二阶偏导数：\n$$\n\\frac{\\partial u}{\\partial t}(x,t) = u_{0}\\,\\sin(k x)\\,\\frac{\\partial}{\\partial t}\\exp(-\\mathrm{i}\\,\\omega t) = u_{0}\\,\\sin(k x)\\,(-\\mathrm{i}\\,\\omega)\\,\\exp(-\\mathrm{i}\\,\\omega t) = -\\mathrm{i}\\,\\omega\\,u(x,t)\n$$\n$$\n\\frac{\\partial^{2} u}{\\partial t^{2}}(x,t) = \\frac{\\partial}{\\partial t}(-\\mathrm{i}\\,\\omega\\,u(x,t)) = (-\\mathrm{i}\\,\\omega)^{2}\\,u(x,t) = -\\omega^{2}\\,u(x,t)\n$$\n因此，运动方程的左侧变为：\n$$\n\\text{LHS} = \\rho\\,\\frac{\\partial^{2} u}{\\partial t^{2}}(x,t) = -\\rho\\,\\omega^{2}\\,u(x,t)\n$$\n\n接下来，我们计算右侧 (RHS)，即近场动力学内力密度 $f_{\\text{int}}(x,t)$：\n$$\nf_{\\text{int}}(x,t)=\\int_{-\\delta}^{\\delta} c(|\\xi|)\\,\\big(u(x+\\xi,t)-u(x,t)\\big)\\,d\\xi\n$$\n鉴于当 $|\\xi| \\le \\delta$ 时微模量函数为 $c(|\\xi|) = c_{0}$，该表达式可简化为：\n$$\nf_{\\text{int}}(x,t)=c_{0}\\int_{-\\delta}^{\\delta} \\big(u(x+\\xi,t)-u(x,t)\\big)\\,d\\xi\n$$\n我们将谐波位移场代入被积函数中：\n$$\nu(x+\\xi,t)-u(x,t) = u_{0}\\,\\sin(k(x+\\xi))\\,\\exp(-\\mathrm{i}\\,\\omega t) - u_{0}\\,\\sin(k x)\\,\\exp(-\\mathrm{i}\\,\\omega t)\n$$\n$$\n= u_{0}\\,\\exp(-\\mathrm{i}\\,\\omega t)\\,\\big(\\sin(k x+k \\xi) - \\sin(k x)\\big)\n$$\n现在，我们将其代回到 $f_{\\text{int}}(x,t)$ 的积分中：\n$$\nf_{\\text{int}}(x,t) = c_{0}\\,u_{0}\\,\\exp(-\\mathrm{i}\\,\\omega t) \\int_{-\\delta}^{\\delta} \\big(\\sin(k x+k \\xi) - \\sin(k x)\\big)\\,d\\xi\n$$\n为了计算该积分，我们可以将其分为两部分：\n$$\n\\int_{-\\delta}^{\\delta} \\big(\\sin(k x+k \\xi) - \\sin(k x)\\big)\\,d\\xi = \\int_{-\\delta}^{\\delta} \\sin(k x+k \\xi)\\,d\\xi - \\int_{-\\delta}^{\\delta} \\sin(k x)\\,d\\xi\n$$\n第一个积分的计算如下：\n$$\n\\int_{-\\delta}^{\\delta} \\sin(k x+k \\xi)\\,d\\xi = \\left[-\\frac{\\cos(k x+k \\xi)}{k}\\right]_{-\\delta}^{\\delta} = -\\frac{1}{k}\\big(\\cos(k x+k \\delta) - \\cos(k x-k \\delta)\\big)\n$$\n使用三角恒等式 $\\cos(A) - \\cos(B) = -2\\sin(\\frac{A+B}{2})\\sin(\\frac{A-B}{2})$，其中 $A=kx+k\\delta$ 且 $B=kx-k\\delta$，我们得到：\n$$\n\\cos(k x+k \\delta) - \\cos(k x-k \\delta) = -2\\sin(k x)\\sin(k \\delta)\n$$\n所以，第一个积分为：\n$$\n-\\frac{1}{k}\\big(-2\\sin(k x)\\sin(k \\delta)\\big) = \\frac{2}{k}\\sin(k x)\\sin(k \\delta)\n$$\n第二个积分为：\n$$\n\\int_{-\\delta}^{\\delta} \\sin(k x)\\,d\\xi = \\sin(k x) \\int_{-\\delta}^{\\delta} 1\\,d\\xi = \\sin(k x) [\\xi]_{-\\delta}^{\\delta} = 2\\delta\\sin(k x)\n$$\n结合两个积分的结果：\n$$\n\\int_{-\\delta}^{\\delta} \\big(\\sin(k x+k \\xi) - \\sin(k x)\\big)\\,d\\xi = \\frac{2}{k}\\sin(k x)\\sin(k \\delta) - 2\\delta\\sin(k x) = 2\\sin(k x)\\left(\\frac{\\sin(k \\delta)}{k} - \\delta\\right)\n$$\n将此结果代回到 $f_{\\text{int}}(x,t)$ 的表达式中：\n$$\nf_{\\text{int}}(x,t) = c_{0}\\,u_{0}\\,\\exp(-\\mathrm{i}\\,\\omega t) \\left[ 2\\sin(k x)\\left(\\frac{\\sin(k \\delta)}{k} - \\delta\\right) \\right]\n$$\n注意到 $u_{0}\\,\\sin(k x)\\,\\exp(-\\mathrm{i}\\,\\omega t) = u(x,t)$，我们可以将右侧 (RHS) 写为：\n$$\n\\text{RHS} = f_{\\text{int}}(x,t) = 2c_{0}\\left(\\frac{\\sin(k \\delta)}{k} - \\delta\\right)u(x,t)\n$$\n现在我们通过令左侧 (LHS) 和右侧 (RHS) 相等来应用运动方程：\n$$\n-\\rho\\,\\omega^{2}\\,u(x,t) = 2c_{0}\\left(\\frac{\\sin(k \\delta)}{k} - \\delta\\right)u(x,t)\n$$\n由于 $u(x,t)$ 不恒为零，我们可以将其从等式两边消去，以获得色散关系：\n$$\n-\\rho\\,\\omega^{2} = 2c_{0}\\left(\\frac{\\sin(k \\delta)}{k} - \\delta\\right)\n$$\n最后，解出作为 $k$ 的函数的 $\\omega^{2}$：\n$$\n\\omega^{2}(k) = -\\frac{2c_{0}}{\\rho}\\left(\\frac{\\sin(k \\delta)}{k} - \\delta\\right)\n$$\n$$\n\\omega^{2}(k) = \\frac{2c_{0}}{\\rho}\\left(\\delta - \\frac{\\sin(k \\delta)}{k}\\right)\n$$\n这就是所求的色散关系的闭式解析表达式。对于任何具有物理意义且 $k>0$ 的波，$\\delta - \\frac{\\sin(k \\delta)}{k}$ 项均为正，这确保了 $\\omega^{2} > 0$ 且 $\\omega$ 为实数，符合要求。", "answer": "$$\n\\boxed{\\frac{2c_{0}}{\\rho}\\left(\\delta - \\frac{\\sin(k\\delta)}{k}\\right)}\n$$", "id": "2905383"}, {"introduction": "为了将近场动力学应用于实际工程问题，我们必须将连续的积分方程转化为适合计算机求解的离散形式。本练习将指导您推导一维杆的离散刚度矩阵，这是实现数值模拟的基石。这个过程不仅能加深您对近场动力学方程离散化的理解，还能让您洞察所生成矩阵的关键性质，如对称性和稀疏性[@problem_id:2905429]。", "problem": "考虑一个在一维均匀网格上离散化的杆的非局部、键基、线性微观弹性近场动力学模型。设材料占据一个周期性域，以避免在视界边界处发生混叠效应，并设节点位于位置 $x_i = i\\,h$ 处，其中 $i$ 为整数，$h$ 为均匀网格间距。近场动力学视界为 $\\delta = m\\,h$，其中整数 $m \\ge 1$。微模量函数取为\n$$\nc(|\\xi|) = \\begin{cases}\nc_0\\left(1 - \\dfrac{|\\xi|}{\\delta}\\right), & 0 \\le |\\xi| \\le \\delta \\\\\n0, & |\\xi| > \\delta\n\\end{cases}\n$$\n其中 $c_0 > 0$ 是一个常数。假设小变形和准静态设定，体力密度为 $b(x)$，从而线性动量守恒成立。\n\n从基本的微观弹性近场动力学内力表达式和线性动量守恒出发，通过在每个节点上使用配置法和中点法则对近场动力学积分进行求积，推导节点位移向量 $\\mathbf{u}$ 的离散线性系统。通过将组装后的方程写成 $\\mathbf{K}\\,\\mathbf{u} = \\mathbf{f}_b$ 的形式来定义离散刚度矩阵 $\\mathbf{K}$，其中 $\\mathbf{f}_b$ 是离散体力向量。请提供由此离散化得到的矩阵元 $K_{ij}$ 关于 $i$、$j$、$h$、$m$ 和 $c_0$ 的显式闭式表达式。然后，基于第一性原理和 $\\mathbf{K}$ 的构造，讨论 $\\mathbf{K}$ 是否对称，并描述其稀疏模式。\n\n你最终报告的答案应为 $K_{ij}$ 作为 $i$ 和 $j$ 的函数的单个闭式解析表达式（它可以是关于 $|i-j|$ 的分段函数）。最终表达式中不应包含单位。无需进行数值取整。", "solution": "用户需要一个非局部力学问题的解答，具体来说是一维键基近场动力学问题。该问题要求在给定一个特定微模量函数的情况下，推导周期性网格上杆的离散刚度矩阵。推导必须从基本原理出发。我还需要分析所得矩阵的性质。\n\n该问题经检验在科学上是合理的、适定的和客观的。所有提供的信息在近场动力学理论中都是标准的。我将开始解答。\n\n对于一个保守力学系统，推导刚度矩阵最基本的方法是从势能出发。平衡状态对应于系统总势能的驻点。\n\n总势能 $\\Pi$ 是内部应变能 $\\mathcal{E}$ 与外力势能之和，对于体力密度 $b(x)$，外力势能为 $W_{ext} = - \\int b(x) u(x) dx$。因此，$\\Pi = \\mathcal{E} - W_{ext}$。\n\n对于键基近场动力学材料，应变能 $\\mathcal{E}$ 是储存在所有键中的能量之和。对于线性微观弹性材料，键应变能密度由 $w = \\frac{1}{2} c(|\\boldsymbol{\\xi}|) s^2$ 给出，其中 $c$ 是微模量，$\\boldsymbol{\\xi} = \\mathbf{x}' - \\mathbf{x}$ 是键向量，$s$ 是键伸长率。\n\n在一维情况下，$\\xi = x' - x$，小变形的伸长率为 $s = \\frac{u(x') - u(x)}{x' - x}$。总应变能通过在材料域上对应变能密度 $W(x) = \\frac{1}{2}\\int_{\\mathcal{H}_x} w(x',x) dx'$ 进行积分得到。为避免双重计数，表达式为：\n$$ \\mathcal{E} = \\frac{1}{2} \\int \\left( \\frac{1}{2} \\int_{\\mathcal{H}_x} c(|x'-x|) \\left( \\frac{u(x')-u(x)}{x'-x} \\right)^2 dx' \\right) dx $$\n\n我们对指定网格离散化此表达式。节点位于 $x_i = i h$。域上的积分变为对节点的求和，每个节点有一个体积（长度）$h$。对视界内的积分使用中点法则近似，这变为对邻近节点的求和，间距为 $h$。令 $u_i = u(x_i)$。\n离散应变能为：\n$$ \\mathcal{E}_{discrete} = \\frac{1}{2} \\sum_i h \\left( \\frac{1}{2} \\sum_{j \\neq i, |j-i|\\le m} h \\, c(|x_j-x_i|) \\left(\\frac{u_j-u_i}{x_j-x_i}\\right)^2 \\right) $$\n代入 $x_j - x_i = (j-i)h$ 并化简：\n$$ \\mathcal{E}_{discrete} = \\frac{h^2}{4} \\sum_{i} \\sum_{j \\neq i, |j-i|\\le m} c(|(j-i)h|) \\frac{(u_j-u_i)^2}{((j-i)h)^2} $$\n$$ \\mathcal{E}_{discrete} = \\frac{1}{4} \\sum_{i} \\sum_{j \\neq i, |j-i|\\le m} \\frac{c(|(j-i)h|)}{(j-i)^2} (u_j-u_i)^2 $$\n双重求和将每个键 $(i,j)$ 计算了两次（一次为 $(i,j)$，一次为 $(j,i)$），因此有因子 $1/4$。\n\n外力势能的离散形式为 $W_{ext, discrete} = \\sum_i b(x_i) u_i h$。通过将总势能 $\\Pi_{discrete} = \\mathcal{E}_{discrete} - W_{ext, discrete}$ 对每个节点位移 $u_k$ 的导数设为零来找到平衡方程：\n$$ \\frac{\\partial \\Pi_{discrete}}{\\partial u_k} = \\frac{\\partial \\mathcal{E}_{discrete}}{\\partial u_k} - b_k h = 0 $$\n离散系统为 $\\mathbf{K}\\mathbf{u} = \\mathbf{f}_b$，其中刚度矩阵的矩阵元由应变能的黑塞矩阵（Hessian矩阵）给出，$K_{kj} = \\frac{\\partial^2 \\mathcal{E}_{discrete}}{\\partial u_k \\partial u_j}$，体力向量的元素为 $f_{b,k} = b_k h$。\n\n我们来计算 $\\mathbf{K}$ 的矩阵元：\n一阶导数（节点 $k$ 上的内力）：\n$$ \\frac{\\partial \\mathcal{E}_{discrete}}{\\partial u_k} = \\frac{1}{2} \\sum_{j \\neq k, |j-k|\\le m} \\frac{c(|(k-j)h|)}{(k-j)^2} (u_k-u_j) + \\frac{1}{2} \\sum_{i \\neq k, |i-k|\\le m} \\frac{c(|(i-k)h|)}{(i-k)^2} (u_k-u_i) $$\n$$ \\frac{\\partial \\mathcal{E}_{discrete}}{\\partial u_k} = \\sum_{j \\neq k, |j-k|\\le m} \\frac{c(|(k-j)h|)}{(k-j)^2} (u_k-u_j) $$\n\n二阶导数（刚度矩阵元）：\n对于非对角元（$j \\neq k$）：\n$$ K_{kj} = \\frac{\\partial}{\\partial u_j} \\left( \\frac{\\partial \\mathcal{E}_{discrete}}{\\partial u_k} \\right) = \\frac{\\partial}{\\partial u_j} \\left( \\dots + \\frac{c(|(k-j)h|)}{(k-j)^2}(u_k - u_j) + \\dots \\right) = - \\frac{c(|(k-j)h|)}{(k-j)^2} $$\n这适用于 $1 \\le |k-j| \\le m$。如果 $|k-j| > m$，相互作用为零，因此 $K_{kj}=0$。\n\n对于对角元（$j = k$）：\n$$ K_{kk} = \\frac{\\partial}{\\partial u_k} \\left( \\frac{\\partial \\mathcal{E}_{discrete}}{\\partial u_k} \\right) = \\frac{\\partial}{\\partial u_k} \\left( \\sum_{j \\neq k, |j-k|\\le m} \\frac{c(|(k-j)h|)}{(k-j)^2} (u_k - u_j) \\right) = \\sum_{j \\neq k, |j-k|\\le m} \\frac{c(|(k-j)h|)}{(k-j)^2} $$\n\n现在，我们代入给定的微模量函数：\n$$ c(|\\xi|) = c_0 \\left(1 - \\frac{|\\xi|}{\\delta}\\right) \\quad \\text{for } |\\xi| \\le \\delta $$\n当 $\\xi = (j-i)h$ 且 $\\delta=mh$ 时，对于 $|j-i| \\le m$：\n$$ c(|(j-i)h|) = c_0 \\left(1 - \\frac{|j-i|h}{mh}\\right) = c_0 \\left(1 - \\frac{|j-i|}{m}\\right) $$\n刚度矩阵的矩阵元变为：\n对于 $i \\neq j$ 且 $|i-j| \\le m$：\n$$ K_{ij} = - \\frac{c_0 \\left(1 - \\frac{|i-j|}{m}\\right)}{(i-j)^2} $$\n对于 $i=j$：\n$$ K_{ii} = \\sum_{p \\neq i, |p-i| \\le m} \\frac{c_0 \\left(1 - \\frac{|p-i|}{m}\\right)}{(p-i)^2} $$\n求和索引 $p$ 的范围是从 $i-m$ 到 $i+m$，不包括 $i$。令 $k=p-i$。\n$$ K_{ii} = \\sum_{k=-m, k \\neq 0}^{m} \\frac{c_0 \\left(1 - \\frac{|k|}{m}\\right)}{k^2} $$\n由于被加项是 $k$ 的偶函数，我们可以将其写为：\n$$ K_{ii} = 2c_0 \\sum_{k=1}^{m} \\frac{1 - \\frac{k}{m}}{k^2} = 2c_0 \\sum_{k=1}^{m} \\left( \\frac{1}{k^2} - \\frac{1}{mk} \\right) $$\n这是对角元的闭式表达式。\n\n矩阵 $\\mathbf{K}$ 的性质现在很明显了：\n1.  **对称性**：非对角元 $K_{ij}$ 依赖于 $(i-j)^2$ 和 $|i-j|$，这些项在交换 $i$ 和 $j$ 时是对称的。因此，$K_{ij}=K_{ji}$。该矩阵是对称的。这由其定义为一个标量势能函数的黑塞矩阵（Hessian矩阵）所保证。\n2.  **稀疏性**：矩阵元 $K_{ij}$ 仅在节点 $i$ 和 $j$ 之间的距离在近场动力学视界之内时才非零，即 $|i-j|h \\le \\delta = mh$，这意味着 $|i-j| \\le m$。这导致了一个带宽为 $2m+1$ 的带状矩阵结构。对于远大于 $m$ 的大量节点 $N$，该矩阵是稀疏的。\n3.  **结构**：由于 $K_{ij}$ 仅依赖于差值 $i-j$，该矩阵是一个托普利兹矩阵（Toeplitz matrix）。对于周期性域，它是一个循环矩阵。\n4.  **奇异性**：任意行的行和为 $\\sum_j K_{ij} = K_{ii} + \\sum_{j \\neq i} K_{ij}$。\n    $$ \\sum_j K_{ij} = \\sum_{j \\neq i, |j-i|\\le m} \\frac{c(|(j-i)h|)}{(j-i)^2} - \\sum_{j \\neq i, |j-i|\\le m} \\frac{c(|(j-i)h|)}{(j-i)^2} = 0 $$\n    零行和性质表明该矩阵是奇异的。对应于刚体平移的、所有元素为1的向量 $\\mathbf{1}$ 位于 $\\mathbf{K}$ 的零空间中（$\\mathbf{K}\\mathbf{1} = \\mathbf{0}$）。这在物理上是正确的，因为刚体运动不产生应变，因此不产生内力。\n\n刚度矩阵 $\\mathbf{K}$ 的矩阵元的最终表达式以基于距离 $|i-j|$ 的分段形式给出。", "answer": "$$\n\\boxed{\nK_{ij} = \n\\begin{cases}\n2c_0 \\sum_{p=1}^{m} \\left( \\frac{1}{p^2} - \\frac{1}{mp} \\right) & \\text{若 } i=j \\\\\n- \\frac{c_0}{(i-j)^2} \\left(1 - \\frac{|i-j|}{m}\\right) & \\text{若 } 1 \\le |i-j| \\le m \\\\\n0 & \\text{若 } |i-j| > m\n\\end{cases}\n}\n$$", "id": "2905429"}, {"introduction": "发展近场动力学的主要动机之一是为了更好地模拟断裂。本练习应用非局部拉伸准则来预测带缺口杆的裂纹萌生，展示这些理论如何处理应力集中并预测失效。通过建立一个计算模型来求解临界载荷，您将体验到如何将理论概念转化为解决具体工程断裂问题的实用工具[@problem_id:2905433]。", "problem": "考虑一根长度为 $L$ 的一维拉伸杆，其中心 $x = L/2$ 处有一个对称切口。其横截面积是分段恒定的，定义为\n- 对于 $|x - L/2| \\le a$，$A(x) = A_{\\min}$，\n- 对于 $|x - L/2| > a$，$A(x) = A_0$，\n参数满足 $0 < A_{\\min} \\le A_0$，$0 < a \\ll L/2$ 以及 $0 < \\delta \\le L/2$，其中 $\\delta$ 是非局部作用范围（nonlocal horizon）。该杆的两端承受轴向拉伸载荷 $P$，处于小应变条件和准静态平衡状态。材料是线弹性材料，杨氏模量为 $E$。将在点 $x$ 处的非局部键拉伸度量定义为在作用范围内使用三角形影响函数对键向轴向拉伸进行的归一化加权平均，\n$$w(r) = \\begin{cases}\n1 - \\dfrac{r}{\\delta}, & 0 \\le r \\le \\delta, \\\\\n0, & r > \\delta,\n\\end{cases}$$\n及其对于负 $r$ 的对称扩展。对于位移为 $u(x)$、局部轴向应变为 $\\varepsilon(x) = \\dfrac{du}{dx}$ 的单调拉伸变形，将 $x$ 处的非局部键拉伸近似为\n$$s(x) = \\dfrac{1}{M(\\delta)} \\int_{x-\\delta}^{x+\\delta} w(|y-x|)\\,\\dfrac{|u(y)-u(x)|}{|y-x|}\\,dy \\approx \\dfrac{1}{M(\\delta)} \\int_{x-\\delta}^{x+\\delta} w(|y-x|)\\,\\varepsilon(y)\\,dy,$$\n其中归一化因子为 $M(\\delta) = \\int_{-\\delta}^{\\delta} w(|r|)\\,dr$。假设准静态力平衡意味着沿杆的轴向力 $P$ 是恒定的，因此局部应变满足 $\\varepsilon(x) = \\dfrac{P}{E\\,A(x)}$。设 $s_c$ 表示临界拉伸。当 $x_0 = L/2$ 处的 $s(x_0) = s_c$ 时，预测切口根部会发生断裂起始。\n\n任务：从上述基本定义和假设出发，通过强制执行 $s(L/2) = s_c$，推导出一个显式的计算程序，以预测作为 $E$、$A_0$、$A_{\\min}$、$a$ 和 $\\delta$ 的函数的起始载荷 $P_c$。在一个程序中实现此过程，该程序为以下参数组测试套件（每个元组按 $(E, A_0, A_{\\min}, a, \\delta, s_c, L)$ 顺序排列）评估 $P_c$：\n- 情况1（$\\delta > a$ 的一般情况）： $(200 \\times 10^{9}\\,\\mathrm{Pa},\\; 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,\\; 2.0 \\times 10^{-5}\\,\\mathrm{m}^2,\\; 5.0 \\times 10^{-3}\\,\\mathrm{m},\\; 1.0 \\times 10^{-2}\\,\\mathrm{m},\\; 2.0 \\times 10^{-3},\\; 1.0\\,\\mathrm{m})$。\n- 情况2（$\\delta \\lt a$ 的边界情况）： $(200 \\times 10^{9}\\,\\mathrm{Pa},\\; 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,\\; 2.0 \\times 10^{-5}\\,\\mathrm{m}^2,\\; 5.0 \\times 10^{-3}\\,\\mathrm{m},\\; 3.0 \\times 10^{-3}\\,\\mathrm{m},\\; 2.0 \\times 10^{-3},\\; 1.0\\,\\mathrm{m})$。\n- 情况3（大作用范围）： $(200 \\times 10^{9}\\,\\mathrm{Pa},\\; 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,\\; 2.0 \\times 10^{-5}\\,\\mathrm{m}^2,\\; 5.0 \\times 10^{-3}\\,\\mathrm{m},\\; 1.0 \\times 10^{-1}\\,\\mathrm{m},\\; 2.0 \\times 10^{-3},\\; 1.0\\,\\mathrm{m})$。\n- 情况4（无切口，$A_{\\min} = A_0$）： $(200 \\times 10^{9}\\,\\mathrm{Pa},\\; 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,\\; 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,\\; 5.0 \\times 10^{-3}\\,\\mathrm{m},\\; 2.0 \\times 10^{-2}\\,\\mathrm{m},\\; 2.0 \\times 10^{-3},\\; 1.0\\,\\mathrm{m})$。\n- 情况5（非常小的作用范围）： $(200 \\times 10^{9}\\,\\mathrm{Pa},\\; 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,\\; 2.0 \\times 10^{-5}\\,\\mathrm{m}^2,\\; 5.0 \\times 10^{-3}\\,\\mathrm{m},\\; 1.0 \\times 10^{-6}\\,\\mathrm{m},\\; 2.0 \\times 10^{-3},\\; 1.0\\,\\mathrm{m})$。\n\n您的程序必须：\n- 使用上述带有三角形影响函数的非局部定义，获得对 $s(L/2)$ 的封闭形式解或数值精确评估，并从 $s(L/2) = s_c$ 求解 $P_c$。\n- 对于每种情况，以 $\\mathrm{N}$ 为单位输出预测的起始载荷 $P_c$，四舍五入到最接近的整数。\n- 生成一行输出，其中包含按上述情况顺序排列的结果，形式为逗号分隔的列表，并用方括号括起来（例如，格式为 [$p_1,p_2,p_3,p_4,p_5$]）。\n\n所有输入均采用国际单位制（SI）。以 $\\mathrm{N}$ 为单位表示最终载荷，四舍五入到最接近的整数，并确保在所有计算中 $0 < \\delta \\le L/2$。您的算法应具有通用性，不应依赖任何非物理性假设。", "solution": "问题陈述在非局部连续介质力学领域提出了一个定义明确的问题，具体涉及具有几何不连续性的一维杆中的断裂起始。该模型基于一个类似近场动力学的键拉伸度量。此问题在科学上是合理的、自洽的且可形式化的。因此，它被认为是有效的。我们继续推导临界载荷 $P_c$ 的计算过程。\n\n目标是确定在切口中心 $x_0 = L/2$ 处引发断裂的临界拉伸载荷 $P_c$。断裂准则由该点的非局部键拉伸 $s(x)$ 达到临界值 $s_c$ 的条件给出。\n$$s(L/2) = s_c$$\n为方便起见，我们平移空间坐标，使切口中心位于原点，即 $x' = x - L/2 = 0$。分析在 $x'=0$ 处进行。该点的非局部键拉伸定义为：\n$$s(0) = \\dfrac{1}{M(\\delta)} \\int_{-\\delta}^{\\delta} w(|y|)\\,\\varepsilon(y)\\,dy$$\n其中 $\\delta$ 是非局部作用范围（nonlocal horizon），$w(|y|)$ 是影响函数，$\\varepsilon(y)$ 是局部轴向应变。\n\n首先，我们必须确定归一化因子 $M(\\delta)$。影响函数被指定为对称的三角形函数：\n$$w(r) = 1 - \\dfrac{|r|}{\\delta} \\quad \\text{对于 } |r| \\le \\delta, \\text{ 否则为 } 0$$\n归一化因子是影响函数在作用范围内的积分：\n$$M(\\delta) = \\int_{-\\delta}^{\\delta} w(|r|)\\,dr = 2 \\int_{0}^{\\delta} \\left(1 - \\dfrac{r}{\\delta}\\right) dr = 2 \\left[ r - \\dfrac{r^2}{2\\delta} \\right]_0^\\delta = 2 \\left( \\delta - \\dfrac{\\delta^2}{2\\delta} \\right) = \\delta$$\n因此，归一化因子就是作用范围的长度，即 $M(\\delta) = \\delta$。\n\n局部应变 $\\varepsilon(y)$ 源于准静态平衡条件，该条件意味着整个杆的轴向力 $P$ 是恒定的。应变与局部横截面积 $A(y)$ 成反比：\n$$\\varepsilon(y) = \\dfrac{P}{E\\,A(y)}$$\n面积 $A(y)$ 是一个分段常数函数，关于原点对称：\n$$A(y) = \\begin{cases} A_{\\min} & \\text{对于 } |y| \\le a \\\\ A_0 & \\text{对于 } |y| > a \\end{cases}$$\n其中 $a$ 是切口的半宽。\n\n将这些表达式代入 $s(0)$ 的公式中，我们得到：\n$$s(0) = \\dfrac{1}{\\delta} \\int_{-\\delta}^{\\delta} \\left(1 - \\dfrac{|y|}{\\delta}\\right) \\dfrac{P}{E\\,A(y)} dy$$\n由于 $P$ 和 $E$ 是常数，我们可以将它们提出来。此外，被积函数是 $y$ 的偶函数，因此我们可以简化积分：\n$$s(0) = \\dfrac{2P}{E\\delta} \\int_{0}^{\\delta} \\left(1 - \\dfrac{y}{\\delta}\\right) \\dfrac{1}{A(y)} dy$$\n此积分的求值取决于作用范围 $\\delta$ 和切口半宽 $a$ 的相对大小。我们必须考虑两种不同的情况。\n\n情况1：作用范围小于或等于切口半宽（$\\delta \\le a$）。\n在这种情况下，对于整个积分域 $y \\in [0, \\delta]$，条件 $y \\le \\delta \\le a$ 成立。因此，横截面积是恒定的，$A(y) = A_{\\min}$。积分变为：\n$$\\int_{0}^{\\delta} \\left(1 - \\dfrac{y}{\\delta}\\right) \\dfrac{1}{A_{\\min}} dy = \\dfrac{1}{A_{\\min}} \\int_{0}^{\\delta} \\left(1 - \\dfrac{y}{\\delta}\\right) dy = \\dfrac{1}{A_{\\min}} \\left[ y - \\dfrac{y^2}{2\\delta} \\right]_0^\\delta = \\dfrac{1}{A_{\\min}} \\left( \\delta - \\dfrac{\\delta}{2} \\right) = \\dfrac{\\delta}{2A_{\\min}}$$\n将此结果代入 $s(0)$ 的表达式中：\n$$s(0) = \\dfrac{2P}{E\\delta} \\left( \\dfrac{\\delta}{2A_{\\min}} \\right) = \\dfrac{P}{E A_{\\min}}$$\n这恰好是切口根部的局部应变。对于 $\\delta \\le a$，非局部模型在最大应变点的预测与局部理论一致。对临界载荷 $P_c$ 应用断裂准则 $s(0) = s_c$：\n$$s_c = \\dfrac{P_c}{E A_{\\min}} \\implies P_c = s_c E A_{\\min}$$\n\n情况2：作用范围大于切口半宽（$\\delta > a$）。\n在这种情况下，积分必须分成两部分，对应于作用范围内的两个横截面积区域：\n$$\\int_{0}^{\\delta} \\dfrac{1 - y/\\delta}{A(y)} dy = \\int_{0}^{a} \\dfrac{1 - y/\\delta}{A_{\\min}} dy + \\int_{a}^{\\delta} \\dfrac{1 - y/\\delta}{A_0} dy$$\n计算第一个积分：\n$$\\int_{0}^{a} \\dfrac{1 - y/\\delta}{A_{\\min}} dy = \\dfrac{1}{A_{\\min}} \\left[ y - \\dfrac{y^2}{2\\delta} \\right]_0^a = \\dfrac{1}{A_{\\min}} \\left( a - \\dfrac{a^2}{2\\delta} \\right)$$\n计算第二个积分：\n$$\\int_{a}^{\\delta} \\dfrac{1 - y/\\delta}{A_0} dy = \\dfrac{1}{A_0} \\left[ y - \\dfrac{y^2}{2\\delta} \\right]_a^\\delta = \\dfrac{1}{A_0} \\left[ \\left(\\delta - \\dfrac{\\delta^2}{2\\delta}\\right) - \\left(a - \\dfrac{a^2}{2\\delta}\\right) \\right] = \\dfrac{1}{A_0} \\left( \\dfrac{\\delta}{2} - a + \\dfrac{a^2}{2\\delta} \\right)$$\n结合这些结果，总积分为：\n$$I = \\dfrac{1}{A_{\\min}} \\left( a - \\dfrac{a^2}{2\\delta} \\right) + \\dfrac{1}{A_0} \\left( \\dfrac{\\delta}{2} - a + \\dfrac{a^2}{2\\delta} \\right)$$\n现在我们通过代入这个积分 $I$ 来求 $s(0)$：\n$$s(0) = \\dfrac{2P}{E\\delta} I = \\dfrac{P}{E} \\left[ \\dfrac{2}{\\delta A_{\\min}} \\left( a - \\dfrac{a^2}{2\\delta} \\right) + \\dfrac{2}{\\delta A_0} \\left( \\dfrac{\\delta}{2} - a + \\dfrac{a^2}{2\\delta} \\right) \\right]$$\n$$s(0) = \\dfrac{P}{E} \\left[ \\left( \\dfrac{2a}{\\delta} - \\dfrac{a^2}{\\delta^2} \\right) \\dfrac{1}{A_{\\min}} + \\left( 1 - \\dfrac{2a}{\\delta} + \\dfrac{a^2}{\\delta^2} \\right) \\dfrac{1}{A_0} \\right]$$\n对这些项进行因式分解可以得到一个更紧凑的表达式：\n$$s(0) = \\dfrac{P}{E} \\left[ \\left(\\dfrac{a}{\\delta}\\left(2 - \\dfrac{a}{\\delta}\\right)\\right) \\dfrac{1}{A_{\\min}} + \\left(1 - \\dfrac{a}{\\delta}\\right)^2 \\dfrac{1}{A_0} \\right]$$\n应用断裂准则 $s(0) = s_c$ 并求解临界载荷 $P_c$：\n$$P_c = \\dfrac{s_c E}{\\left( \\dfrac{2a}{\\delta} - \\dfrac{a^2}{\\delta^2} \\right) \\dfrac{1}{A_{\\min}} + \\left( 1 - \\dfrac{a}{\\delta} \\right)^2 \\dfrac{1}{A_0}}$$\n此公式在 $\\delta > a$ 时有效。可以验证，当 $\\delta \\to a^+$ 时，此表达式平滑地收敛到情况1的结果，确保了连续性。\n\n因此，计算程序是：根据每个测试用例的输入参数确定是 $\\delta \\le a$ 还是 $\\delta > a$，应用相应的 $P_c$ 公式，并计算数值结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the critical fracture initiation load Pc for a notched bar\n    using a one-dimensional nonlocal bond-stretch model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is ordered as (E, A_0, A_min, a, delta, s_c, L) in SI units.\n    test_cases = [\n        # Case 1 (general case with delta > a)\n        (200e9, 1.0e-4, 2.0e-5, 5.0e-3, 1.0e-2, 2.0e-3, 1.0),\n        # Case 2 (boundary where delta < a)\n        (200e9, 1.0e-4, 2.0e-5, 5.0e-3, 3.0e-3, 2.0e-3, 1.0),\n        # Case 3 (large horizon)\n        (200e9, 1.0e-4, 2.0e-5, 5.0e-3, 1.0e-1, 2.0e-3, 1.0),\n        # Case 4 (no notch, A_min = A_0)\n        (200e9, 1.0e-4, 1.0e-4, 5.0e-3, 2.0e-2, 2.0e-3, 1.0),\n        # Case 5 (very small horizon)\n        (200e9, 1.0e-4, 2.0e-5, 5.0e-3, 1.0e-6, 2.0e-3, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        E_mod, A_0, A_min, a_notch, delta_horizon, s_crit, _ = case\n\n        # The calculation depends on the relationship between the horizon (delta)\n        # and the notch half-width (a).\n        if delta_horizon <= a_notch:\n            # Case 1: Horizon is within the notch region.\n            # The nonlocal stretch equals the local strain at the notch root.\n            # This recovers the local theory prediction.\n            # Formula: Pc = s_c * E * A_min\n            P_c = s_crit * E_mod * A_min\n        else:\n            # Case 2: Horizon extends beyond the notch region.\n            # The nonlocal stretch is a weighted average of strains from both\n            # the notched and un-notched regions.\n            # Formula: Pc = s_c * E / [ (2a/d - (a/d)^2)/A_min + (1-a/d)^2/A_0 ]\n            \n            # Ratio of notch half-width to horizon\n            ratio_a_delta = a_notch / delta_horizon\n            \n            # Geometric factor in the denominator of the Pc expression\n            geom_factor = ( (2 * ratio_a_delta - ratio_a_delta**2) / A_min \n                           + (1 - ratio_a_delta)**2 / A_0 )\n            \n            P_c = (s_crit * E_mod) / geom_factor\n        \n        # Round the result to the nearest integer as required.\n        results.append(int(np.round(P_c)))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2905433"}]}