{"hands_on_practices": [{"introduction": "理解屈曲的发生是分析板稳定性的第一步。本练习将引导你完成单轴受压简支板的经典特征值分析，这是结构力学中的一个基本问题。通过推导临界载荷并研究其如何依赖于板的纵横比，你将建立对屈曲模态和模态转换概念的基础理解 [@problem_id:2869820]。", "problem": "一块尺寸为 $a \\times b$、厚度为 $h$ 的各向同性、均匀的矩形薄板，在所有边缘上均受简支约束，并在 $x$ 方向上承受均匀的面内压缩合力 $N_{x}$（单位长度上的力）。该板遵循 Kirchhoff–Love 薄板理论，其抗弯刚度为 $D = \\dfrac{E h^{3}}{12(1-\\nu^{2})}$，其中 $E$ 是杨氏模量，$\\nu$ 是泊松比。设面外挠度为 $w(x,y)$，并考虑围绕屈曲前平坦状态的小挠度线性化稳定性。\n\n从线性屈曲方程 $D \\nabla^{4} w + N_{x} \\, \\dfrac{\\partial^{2} w}{\\partial x^{2}} = 0$ 出发，且所有边缘均为简支边界条件，使用分离变量法和容许模态振型 $w(x,y) = W \\sin\\!\\left(\\dfrac{m \\pi x}{a}\\right) \\sin\\!\\left(\\dfrac{n \\pi y}{b}\\right)$（其中 $m,n \\in \\mathbb{N}$），来求得屈曲特征值 $N_{x,cr}(m,n)$。\n\n定义纵横比 $\\beta = a/b$。对于给定的纵横比 $\\beta_{0} = 2.3$，确定使 $N_{x,cr}(m,n)$ 在 $m,n \\in \\mathbb{N}$ 上最小化的整数对 $(m^{\\star},n^{\\star})$。然后，通过分析最小化参数 $m^{\\star}$ 如何依赖于 $\\beta$，确定相邻流向模态数之间的转变：确定全局最小化模态从 $(m,1)$ 变为 $(m+1,1)$ 时的纵横比 $\\beta_{t}(m)$。\n\n你的任务是：\n1. 从控制方程和边界条件中符号化地推导出 $N_{x,cr}(m,n)$。\n2. 通过显式比较，说明对于固定的 $\\beta$ 和 $m$，哪个 $n$ 值可以使 $N_{x,cr}$ 最小。\n3. 对于 $\\beta_{0} = 2.3$，计算最小化整数对 $(m^{\\star},n^{\\star})$。\n4. 推导出作为 $m \\in \\mathbb{N}$ 函数的转变纵横比 $\\beta_{t}(m)$ 的闭式解析表达式。\n\n将最终答案表示为 $\\beta_{t}(m)$ 的闭式解析表达式。无需四舍五入。最终答案是无量纲的；不包括单位。你可以在推导中讨论临界模态随 $\\beta$ 变化的定性转变，但最终报告的答案应仅为所要求的 $\\beta_{t}(m)$ 表达式。", "solution": "在尝试任何解答之前，需对所述问题进行验证。\n\n**问题验证**\n\n步骤1：提取已知条件\n- 板的属性：各向同性、均匀、矩形、薄。\n- 尺寸：长度 $a$，宽度 $b$，厚度 $h$。\n- 边界条件：所有边缘简支。\n- 载荷：沿 $x$ 方向的均匀面内压缩合力 $N_{x}$（单位长度上的力）。\n- 控制理论：Kirchhoff–Love 薄板理论，抗弯刚度为 $D = \\dfrac{E h^{3}}{12(1-\\nu^{2})}$。$E$ 是杨氏模量，$\\nu$ 是泊松比。\n- 控制方程：$D \\nabla^{4} w + N_{x} \\, \\dfrac{\\partial^{2} w}{\\partial x^{2}} = 0$。\n- 假定的挠曲模态：$w(x,y) = W \\sin\\left(\\dfrac{m \\pi x}{a}\\right) \\sin\\left(\\dfrac{n \\pi y}{b}\\right)$，其中 $m,n \\in \\mathbb{N}$。\n- 定义：纵横比 $\\beta = a/b$。\n- 特定值：$\\beta_{0} = 2.3$。\n- 所需任务：\n  1. 推导屈曲特征值 $N_{x,cr}(m,n)$。\n  2. 对于任意固定的 $m$ 和 $\\beta$，确定使 $N_{x,cr}(m,n)$ 最小化的整数 $n$。\n  3. 对于 $\\beta_0 = 2.3$，找到最小化整数对 $(m^{\\star},n^{\\star})$。\n  4. 推导最小化模态从 $(m,1)$ 变为 $(m+1,1)$ 时的转变纵横比 $\\beta_{t}(m)$ 的闭式解析表达式。\n\n步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题是薄板线性稳定性分析中的一个经典练习，是结构力学的基石。其控制方程对于线性化屈曲是正确的，假定的挠曲形状是指定边界条件下的精确特征函数。该问题在科学和数学上是合理的。\n- **适定性**：该问题是适定的。它提供了一个控制方程、边界条件（由给定的模态形状隐式满足）和一个明确的目标。参数均已定义，各项任务导向一个唯一且有意义的解。\n- **客观性**：该问题以精确、客观和定量的术语陈述，没有歧义或主观内容。\n- **完整性与一致性**：该问题是自洽的。所提供的模态形状正确满足所有四个边缘上的简支边界条件（零挠度和零法向弯矩）。没有矛盾之处。\n- **可行性**：该设置在物理上是现实的，代表了工程分析中的一种标准配置。\n\n步骤3：结论与行动\n该问题被判定为 **有效**。我们可以继续进行解答。\n\n**解答推导**\n\n将通过完成问题陈述中指定的四个任务来展开解答。\n\n**任务1：推导 $N_{x,cr}(m,n)$**\n\n我们从板的线性屈曲方程开始：\n$$D \\nabla^{4} w + N_{x} \\dfrac{\\partial^{2} w}{\\partial x^{2}} = 0$$\n假定的挠曲模态为 $w(x,y) = W \\sin\\left(\\dfrac{m \\pi x}{a}\\right) \\sin\\left(\\dfrac{n \\pi y}{b}\\right)$。我们必须计算 $w(x,y)$ 的必要导数：\n$$ \\dfrac{\\partial w}{\\partial x} = W \\left(\\dfrac{m \\pi}{a}\\right) \\cos\\left(\\dfrac{m \\pi x}{a}\\right) \\sin\\left(\\dfrac{n \\pi y}{b}\\right) $$\n$$ \\dfrac{\\partial^{2} w}{\\partial x^{2}} = -W \\left(\\dfrac{m \\pi}{a}\\right)^{2} \\sin\\left(\\dfrac{m \\pi x}{a}\\right) \\sin\\left(\\dfrac{n \\pi y}{b}\\right) = -\\left(\\dfrac{m \\pi}{a}\\right)^{2} w $$\n根据对称性，\n$$ \\dfrac{\\partial^{2} w}{\\partial y^{2}} = -W \\left(\\dfrac{n \\pi}{b}\\right)^{2} \\sin\\left(\\dfrac{m \\pi x}{a}\\right) \\sin\\left(\\dfrac{n \\pi y}{b}\\right) = -\\left(\\dfrac{n \\pi}{b}\\right)^{2} w $$\n$w$ 的拉普拉斯算子为：\n$$ \\nabla^{2} w = \\dfrac{\\partial^{2} w}{\\partial x^{2}} + \\dfrac{\\partial^{2} w}{\\partial y^{2}} = -\\left[ \\left(\\dfrac{m \\pi}{a}\\right)^{2} + \\left(\\dfrac{n \\pi}{b}\\right)^{2} \\right] w $$\n因此，双调和算子 $\\nabla^{4} w = \\nabla^2(\\nabla^2 w)$ 为：\n$$ \\nabla^{4} w = \\nabla^{2} \\left( -\\left[ \\left(\\dfrac{m \\pi}{a}\\right)^{2} + \\left(\\dfrac{n \\pi}{b}\\right)^{2} \\right] w \\right) = \\left( -\\left[ \\left(\\dfrac{m \\pi}{a}\\right)^{2} + \\left(\\dfrac{n \\pi}{b}\\right)^{2} \\right] \\right) (\\nabla^{2} w) $$\n$$ \\nabla^{4} w = \\left[ \\left(\\dfrac{m \\pi}{a}\\right)^{2} + \\left(\\dfrac{n \\pi}{b}\\right)^{2} \\right]^{2} w $$\n将这些导数代回控制方程，得到：\n$$ D \\left[ \\left(\\dfrac{m \\pi}{a}\\right)^{2} + \\left(\\dfrac{n \\pi}{b}\\right)^{2} \\right]^{2} w - N_{x} \\left(\\dfrac{m \\pi}{a}\\right)^{2} w = 0 $$\n对于非平凡屈曲解，$w \\neq 0$，因此我们可以用 $w$ 去除。这就得到了对应于模态 $(m, n)$ 的屈曲载荷 $N_x$ 的代数方程：\n$$ N_{x,cr}(m,n) = D \\dfrac{\\left[ \\left(\\dfrac{m \\pi}{a}\\right)^{2} + \\left(\\dfrac{n \\pi}{b}\\right)^{2} \\right]^{2}}{\\left(\\dfrac{m \\pi}{a}\\right)^{2}} $$\n为了用纵横比 $\\beta = a/b$ 来表示这个表达式，我们可以将表达式改写为：\n$$ N_{x,cr}(m,n) = D \\dfrac{\\pi^4 \\left[ \\dfrac{m^2}{a^2} + \\dfrac{n^2}{b^2} \\right]^2}{\\pi^2 \\dfrac{m^2}{a^2}} = D \\dfrac{\\pi^2 a^2}{m^2} \\left[ \\dfrac{m^2 b^2 + n^2 a^2}{a^2 b^2} \\right]^2 $$\n$$ N_{x,cr}(m,n) = D \\dfrac{\\pi^2 a^2}{m^2} \\dfrac{b^4(m^2 + n^2 (a/b)^2)^2}{a^4 b^4} = D \\dfrac{\\pi^2}{a^2} \\dfrac{(m^2 + n^2 \\beta^2)^2}{m^2} $$\n通过以不同方式对尺寸进行因式分解，可以得到一种更标准的可选形式：\n$$ N_{x,cr}(m,n) = D \\dfrac{\\pi^2}{b^2} \\dfrac{(m^2/\\beta^2 + n^2)^2}{(m/\\beta)^2} = D \\dfrac{\\pi^2}{b^2} \\left( \\dfrac{m^2/\\beta^2 + n^2}{m/\\beta} \\right)^2 = D \\dfrac{\\pi^2}{b^2} \\left(\\dfrac{m}{\\beta} + \\dfrac{n^2 \\beta}{m}\\right)^2 $$\n至此完成第一个任务。\n\n**任务2：关于 $n$ 的最小化**\n\n临界屈曲载荷是 $N_{x,cr}(m,n)$ 在所有 $m,n \\in \\mathbb{N}$ 上的最小值。我们首先寻求对于任意给定的 $m \\in \\mathbb{N}$ 和纵横比 $\\beta > 0$，使 $N_{x,cr}$ 最小化的 $n$ 值。\n$N_{x,cr}(m,n)$ 的表达式为：\n$$ N_{x,cr}(m,n) = D \\dfrac{\\pi^2}{b^2} \\left(\\dfrac{m}{\\beta} + \\dfrac{n^2 \\beta}{m}\\right)^2 $$\n项 $D \\pi^2 / b^2$ 是一个正常数。最小化 $N_{x,cr}(m,n)$ 等价于最小化平方项，或其正的底数：\n$$ f(n) = \\dfrac{m}{\\beta} + \\dfrac{n^2 \\beta}{m} $$\n对于固定的 $m$ 和 $\\beta$，项 $m/\\beta$ 和 $\\beta/m$ 是正常数。函数 $f(n)$ 是关于 $n$ 的简单二次函数，形式为 $C_1 + C_2 n^2$，其中 $C_2 = \\beta/m > 0$。对于 $n > 0$，该函数是严格递增的。由于 $n$ 的定义域是正整数集 $\\mathbb{N} = \\{1, 2, 3, \\dots\\}$，所以 $f(n)$ 的最小值在 $n$ 的最小可能整数值处取得，即 $n=1$。\n因此，对于任意的 $m$ 和 $\\beta$，当 $n=1$ 时，屈曲载荷最小。板在横向屈曲成单个半正弦波。\n\n**任务3：针对 $\\beta_0 = 2.3$ 的最小化整数对**\n\n从任务2可知，最小化模态将具有 $n^{\\star}=1$。现在我们需要找到使 $N_{x,cr}(m,1)$ 在 $\\beta = \\beta_0 = 2.3$ 时最小化的整数 $m^{\\star}$。\n$$ N_{x,cr}(m,1) = D \\dfrac{\\pi^2}{b^2} \\left(\\dfrac{m}{\\beta} + \\dfrac{\\beta}{m}\\right)^2 $$\n我们必须关于 $m \\in \\mathbb{N}$ 最小化屈曲系数因子 $g(m, \\beta) = \\dfrac{m}{\\beta} + \\dfrac{\\beta}{m}$。\n为了找到最小值的近似位置，我们将 $m$ 视为一个连续的正实变量，并求其关于 $m$ 的导数：\n$$ \\dfrac{d g}{d m} = \\dfrac{1}{\\beta} - \\dfrac{\\beta}{m^2} $$\n将导数设为零得到 $m^2 = \\beta^2$，因此 $m=\\beta$。二阶导数 $\\dfrac{d^2 g}{d m^2} = \\dfrac{2\\beta}{m^3} > 0$，证实了这是一个最小值。\n使 $g(m,\\beta)$ 最小化的整数 $m^{\\star}$ 必定是位于实值最小值 $m=\\beta$ 两侧的两个整数之一。\n对于 $\\beta_0 = 2.3$，连续最小值出现在 $m=2.3$ 处。候选整数是 $m=2$ 和 $m=3$。我们比较这两个整数对应的 $g(m, 2.3)$ 的值：\n对于 $m=2$：\n$$ g(2, 2.3) = \\dfrac{2}{2.3} + \\dfrac{2.3}{2} \\approx 0.8696 + 1.15 = 2.0196 $$\n对于 $m=3$：\n$$ g(3, 2.3) = \\dfrac{3}{2.3} + \\dfrac{2.3}{3} \\approx 1.3043 + 0.7667 = 2.0710 $$\n由于 $g(2, 2.3) < g(3, 2.3)$，最小值在 $m^{\\star}=2$ 处取得。\n因此，对于纵横比 $\\beta_0 = 2.3$，最小化模态对是 $(m^{\\star},n^{\\star})=(2,1)$。\n\n**任务4：转变纵横比 $\\beta_t(m)$ 的推导**\n\n随着纵横比 $\\beta$ 的增加，最优的纵向半波数 $m^{\\star}$ 也随之增加。从 $m$ 个半波为最优模态到 $m+1$ 个半波为最优模态的转变发生在一个特定的纵横比 $\\beta_t(m)$ 处，此时这两种模态的屈曲载荷相等。如前所述，此分析是在 $n=1$ 的条件下进行的。\n转变的条件是：\n$$ N_{x,cr}(m,1) = N_{x,cr}(m+1,1) $$\n使用 $N_{x,cr}(m,1)$ 的表达式，并对两边取正平方根，这等价于：\n$$ \\dfrac{m}{\\beta} + \\dfrac{\\beta}{m} = \\dfrac{m+1}{\\beta} + \\dfrac{\\beta}{m+1} $$\n我们求解这个关于 $\\beta = \\beta_t(m)$ 的方程：\n$$ \\beta \\left( \\dfrac{1}{m} - \\dfrac{1}{m+1} \\right) = \\dfrac{m+1}{\\beta} - \\dfrac{m}{\\beta} $$\n$$ \\beta \\left( \\dfrac{m+1-m}{m(m+1)} \\right) = \\dfrac{1}{\\beta} $$\n$$ \\beta \\left( \\dfrac{1}{m(m+1)} \\right) = \\dfrac{1}{\\beta} $$\n$$ \\beta^2 = m(m+1) $$\n由于纵横比 $\\beta$ 必须为正，我们取正根：\n$$ \\beta_t(m) = \\sqrt{m(m+1)} $$\n这就是临界屈曲模态从 $(m,1)$ 转变到 $(m+1,1)$ 时的纵横比的闭式解析表达式。对于区间 $(\\sqrt{(m-1)m}, \\sqrt{m(m+1)})$ 内的任何 $\\beta$，使屈曲载荷最小化的整数模态数是 $m$。\n例如，从 $m=2$ 到 $m=3$ 的转变发生在 $\\beta_t(2) = \\sqrt{2(3)} = \\sqrt{6} \\approx 2.449$。由于 $\\beta_0 = 2.3 < \\sqrt{6}$，最优模态确实是 $m=2$，这证实了我们在任务3中的结果。\n最终要求的答案是 $\\beta_t(m)$ 的表达式。", "answer": "$$\\boxed{\\sqrt{m(m+1)}}$$", "id": "2869820"}, {"introduction": "线性理论预测了屈曲的开始，但板在此之后的行为由非线性效应控制。本练习引入 Föppl–von Kármán 板理论，以探索弱后屈曲行为和模态相互作用。通过双模态伽辽金展开，你将推导出耦合的振幅方程，揭示二次分岔如何发生，从而一窥后屈曲现象的复杂图景 [@problem_id:2869800]。", "problem": "考虑一块薄的、各向同性的、均匀的矩形板，其厚度为 $h$，边长为 $a$ 和 $b$，弯曲刚度为 $D = \\dfrac{E h^{3}}{12 (1-\\nu^{2})}$，四边简支，且在 $x$ 方向上承受单位长度为 $N$ 的均匀单轴面内压缩边缘载荷。使用 Föppl–von Kármán (FvK) 板理论来模拟其屈曲和弱后屈曲响应。\n\n令板的平面外挠度由双模态展开近似表示\n$$\nw(x,y) = \\eta_{1}\\,\\phi_{1}(x,y) + \\eta_{2}\\,\\phi_{2}(x,y),\n$$\n其中\n$$\n\\phi_{i}(x,y) = \\sin\\!\\left(\\frac{m_{i}\\pi x}{a}\\right)\\sin\\!\\left(\\frac{n_{i}\\pi y}{b}\\right), \\quad i\\in\\{1,2\\},\n$$\n此处 $m_{i}$ 和 $n_{i}$ 是固定的正整数。假设次模态与主模态是弱失谐的，即两个线性屈曲载荷是接近的，也就是说，\n$$\n\\frac{k_{2}}{p_{2}} = \\frac{k_{1}}{p_{1}}\\,(1+\\Delta), \\quad |\\Delta|\\ll 1,\n$$\n其中二次弯曲系数和几何系数定义为\n$$\nk_{i} := D \\iint_{\\Omega} \\phi_{i}\\,\\nabla^{4}\\phi_{i}\\, \\mathrm{d}A, \n\\qquad\np_{i} := \\iint_{\\Omega} \\left(\\frac{\\partial \\phi_{i}}{\\partial x}\\right)^{2} \\mathrm{d}A,\n$$\n此处 $\\Omega = [0,a]\\times[0,b]$。\n\n从第一性原理出发，即由弯曲能、面内载荷势能以及由非线性 von Kármán 应变产生的面内拉伸能组成的 Föppl–von Kármán 总势能，对振幅 $\\eta_{1}$ 和 $\\eta_{2}$ 进行四阶 Galerkin 降维。证明降维后的势能可以写成如下形式\n$$\n\\Pi(\\eta_{1},\\eta_{2};N) = \\frac{1}{2}\\,(k_{1}-N p_{1})\\,\\eta_{1}^{2} + \\frac{1}{2}\\,(k_{2}-N p_{2})\\,\\eta_{2}^{2} + \\frac{1}{4}\\,c_{11}\\,\\eta_{1}^{4} + \\frac{1}{2}\\,c_{12}\\,\\eta_{1}^{2}\\eta_{2}^{2} + \\frac{1}{4}\\,c_{22}\\,\\eta_{2}^{4},\n$$\n其中系数 $c_{11}$、$c_{12}$ 和 $c_{22}$ 源于面内拉伸能，并且是正的有限值。你不需要显式地计算 $c_{ij}$；它们是将 $w=\\eta_{1}\\phi_{1}+\\eta_{2}\\phi_{2}$ 代入拉伸能泛函并在 $\\Omega$ 上积分后产生的四次单项式的乘法常数。\n\n通过对 $\\Pi$ 关于 $\\eta_1$ 和 $\\eta_2$ 强制施行平稳性条件，推导出耦合的振幅方程，并确定二次分岔载荷 $N_{\\mathrm{sb}}$ 的精确闭式表达式。$N_{\\mathrm{sb}}$ 定义为当 $\\eta_2=0$ 且 $\\eta_1\\neq 0$ 的分支因 $\\eta_2$ 的扰动而失稳时的 $N$ 值。仅用 $k_{1}$、$k_{2}$、$p_{1}$、$p_{2}$、$c_{11}$ 和 $c_{12}$ 将你的最终结果表示为符号表达式。在你的最终方框答案中不要包含任何单位。为清楚起见：$N$ 是单位长度的压缩载荷，物理单位为牛顿/米，但你的最终答案应为一个不带单位的符号表达式。", "solution": "该问题已经过验证，是非线性结构力学领域中一个适定问题。我们可以开始求解。\n\n此分析的起点是为板挠度的双模态近似所给出的总势能泛函 $\\Pi$。势能是模态振幅 $\\eta_{1}$ 和 $\\eta_{2}$ 以及所施加的压缩载荷 $N$ 的函数：\n$$\n\\Pi(\\eta_{1},\\eta_{2};N) = \\frac{1}{2}\\,(k_{1}-N p_{1})\\,\\eta_{1}^{2} + \\frac{1}{2}\\,(k_{2}-N p_{2})\\,\\eta_{2}^{2} + \\frac{1}{4}\\,c_{11}\\,\\eta_{1}^{4} + \\frac{1}{2}\\,c_{12}\\,\\eta_{1}^{2}\\eta_{2}^{2} + \\frac{1}{4}\\,c_{22}\\,\\eta_{2}^{4}\n$$\n常数 $k_{i}$、$p_{i}$ 和 $c_{ij}$ 在问题描述中已定义。系数 $c_{ij}$ 被假定为正值。\n\n系统的平衡态对应于势能的驻点。这由最小势能原理表达，该原理要求 $\\Pi$ 相对于广义坐标 $\\eta_{1}$ 和 $\\eta_{2}$ 的一阶偏导数必须为零：\n$$\n\\frac{\\partial \\Pi}{\\partial \\eta_{1}} = 0, \\quad \\frac{\\partial \\Pi}{\\partial \\eta_{2}} = 0\n$$\n进行微分，得到平衡振幅的耦合非线性代数方程，也称为振幅方程：\n$$\n\\frac{\\partial \\Pi}{\\partial \\eta_{1}} = (k_{1} - N p_{1})\\eta_{1} + c_{11}\\eta_{1}^{3} + c_{12}\\eta_{1}\\eta_{2}^{2} = \\eta_{1}\\left[(k_{1} - N p_{1}) + c_{11}\\eta_{1}^{2} + c_{12}\\eta_{2}^{2}\\right] = 0\n$$\n$$\n\\frac{\\partial \\Pi}{\\partial \\eta_{2}} = (k_{2} - N p_{2})\\eta_{2} + c_{12}\\eta_{1}^{2}\\eta_{2} + c_{22}\\eta_{2}^{3} = \\eta_{2}\\left[(k_{2} - N p_{2}) + c_{12}\\eta_{1}^{2} + c_{22}\\eta_{2}^{2}\\right] = 0\n$$\n这些方程允许多个解分支。问题引导我们考虑主后屈曲路径，其定义为 $\\eta_{1} \\neq 0$ 且 $\\eta_{2}=0$。将 $\\eta_{2}=0$ 代入方程组，第二个方程被平凡满足（$0=0$），而第一个方程简化为：\n$$\n\\eta_{1}\\left[(k_{1} - N p_{1}) + c_{11}\\eta_{1}^{2}\\right] = 0\n$$\n对于 $\\eta_{1} \\neq 0$ 的非平凡主路径，我们必须有：\n$$\n(k_{1} - N p_{1}) + c_{11}\\eta_{1}^{2} = 0\n$$\n求解 $\\eta_{1}^{2}$ 得到此平衡路径上主模态的振幅：\n$$\n\\eta_{1}^{2} = \\frac{N p_{1} - k_{1}}{c_{11}}\n$$\n该解仅在 $\\eta_{1}^{2} \\ge 0$ 时具有物理意义，这意味着 $N p_{1} - k_{1} \\ge 0$，或 $N \\ge k_{1}/p_{1}$。主模态的临界屈曲载荷是 $N_{1} = k_{1}/p_{1}$。\n\n接下来，我们必须分析此主平衡路径的稳定性。如果势能处于局部最小值，则平衡状态是稳定的，这要求 $\\Pi$ 的二阶导数的海森矩阵是正定的。海森矩阵 $H$ 由下式给出：\n$$\nH = \\begin{pmatrix} \\frac{\\partial^{2} \\Pi}{\\partial \\eta_{1}^{2}} & \\frac{\\partial^{2} \\Pi}{\\partial \\eta_{1} \\partial \\eta_{2}} \\\\ \\frac{\\partial^{2} \\Pi}{\\partial \\eta_{2} \\partial \\eta_{1}} & \\frac{\\partial^{2} \\Pi}{\\partial \\eta_{2}^{2}} \\end{pmatrix}\n$$\n海森矩阵的分量为：\n$$\n\\frac{\\partial^{2} \\Pi}{\\partial \\eta_{1}^{2}} = (k_{1} - N p_{1}) + 3c_{11}\\eta_{1}^{2} + c_{12}\\eta_{2}^{2}\n$$\n$$\n\\frac{\\partial^{2} \\Pi}{\\partial \\eta_{2}^{2}} = (k_{2} - N p_{2}) + c_{12}\\eta_{1}^{2} + 3c_{22}\\eta_{2}^{2}\n$$\n$$\n\\frac{\\partial^{2} \\Pi}{\\partial \\eta_{1} \\partial \\eta_{2}} = 2c_{12}\\eta_{1}\\eta_{2}\n$$\n我们在主路径上计算这些分量，即代入 $\\eta_{2}=0$ 和 $\\eta_{1}^{2} = (N p_{1} - k_{1})/c_{11}$：\n$$\nH_{11} = (k_{1} - N p_{1}) + 3 c_{11} \\left(\\frac{N p_{1} - k_{1}}{c_{11}}\\right) = (k_{1} - N p_{1}) + 3(N p_{1} - k_{1}) = 2(N p_{1} - k_{1})\n$$\n$$\nH_{22} = (k_{2} - N p_{2}) + c_{12}\\left(\\frac{N p_{1} - k_{1}}{c_{11}}\\right)\n$$\n$$\nH_{12} = 2c_{12}\\eta_{1}(0) = 0\n$$\n因此，主路径上的海森矩阵是对角阵：\n$$\nH_{\\text{primary}} = \\begin{pmatrix} 2(N p_{1} - k_{1}) & 0 \\\\ 0 & (k_{2} - N p_{2}) + \\frac{c_{12}}{c_{11}}(N p_{1} - k_{1}) \\end{pmatrix}\n$$\n为了保证稳定性，该矩阵的特征值必须为正。由于该矩阵是对角阵，其特征值即为对角元素。为了使主路径存在，$N > k_{1}/p_{1}$，这确保了第一个特征值 $H_{11} = 2(N p_{1} - k_{1})$ 为正。\n\n当主路径失稳时，发生二次分岔。这发生在第二个特征值 $H_{22}$ 穿过零时。问题要求的是分支因 $\\eta_{2}$ 扰动而失稳时的载荷 $N_{\\mathrm{sb}}$，这恰好对应于条件 $H_{22}=0$。\n在 $N = N_{\\mathrm{sb}}$ 时，将 $H_{22}$ 的表达式设为零：\n$$\n(k_{2} - N_{\\mathrm{sb}} p_{2}) + \\frac{c_{12}}{c_{11}}(N_{\\mathrm{sb}} p_{1} - k_{1}) = 0\n$$\n我们现在求解这个关于 $N_{\\mathrm{sb}}$ 的线性方程。乘以 $c_{11}$ 以消去分母：\n$$\nc_{11}(k_{2} - N_{\\mathrm{sb}} p_{2}) + c_{12}(N_{\\mathrm{sb}} p_{1} - k_{1}) = 0\n$$\n$$\nc_{11}k_{2} - c_{11}N_{\\mathrm{sb}} p_{2} + c_{12}N_{\\mathrm{sb}} p_{1} - c_{12}k_{1} = 0\n$$\n将包含 $N_{\\mathrm{sb}}$ 的项归类：\n$$\nN_{\\mathrm{sb}}(c_{12}p_{1} - c_{11}p_{2}) = c_{12}k_{1} - c_{11}k_{2}\n$$\n分离出 $N_{\\mathrm{sb}}$ 得到二次分岔载荷的最终表达式：\n$$\nN_{\\mathrm{sb}} = \\frac{c_{12}k_{1} - c_{11}k_{2}}{c_{12}p_{1} - c_{11}p_{2}}\n$$\n该表达式仅依赖于刚度系数和几何系数 $k_i$、$p_i$ 以及非线性耦合系数 $c_{ij}$，符合要求。", "answer": "$$\n\\boxed{\\frac{c_{12}k_{1} - c_{11}k_{2}}{c_{12}p_{1} - c_{11}p_{2}}}\n$$", "id": "2869800"}, {"introduction": "对屈曲力学的深刻理解使我们能够设计出更高效、更稳固的结构。本练习通过要求你在体积约束下优化板的厚度分布以最大化其屈曲载荷，从而将分析与设计联系起来。你将从第一性原理推导最优性条件并实现一个数值算法，从而在计算结构优化方面获得实践经验，并学习如何策略性地放置材料以增强稳定性 [@problem_id:2869768]。", "problem": "考虑一个平面内受压的薄矩形 Kirchhoff–Love 板带的稳定性优化问题，该板带沿主承载路径被建模为一维代理模型。薄板的弯曲能量密度与厚度的三次方成正比。在此代理模型中，使用区间 $[0,1]$ 的一个均匀划分，将其分为 $n$ 个大小为 $h = 1/n$ 的相等线段，并在 $n-1$ 个内部节点处设置横向挠度未知数，这些未知数汇集在向量 $\\mathbf{w} \\in \\mathbb{R}^{m}$ 中，其中 $m = n-1$。板的厚度在内部曲率位置处由向量 $\\mathbf{t} \\in \\mathbb{R}^{m}$ 参数化，并带有设计界限 $t_i \\ge t_{\\min}$。离散弯曲刚度与 $t_i^3$ 成正比。\n\n令 $\\mathbf{L} \\in \\mathbb{R}^{m \\times m}$ 表示基于中心有限差分的离散二阶导数（曲率）算子，其简支端挠度为 $w(0)=0$ 和 $w(1)=0$，因此 $(\\mathbf{L}\\mathbf{w})_i \\approx (w_{i+1} - 2 w_i + w_{i-1})/h^2$，边界值为 $w_0 = 0$ 和 $w_n = 0$。令 $\\mathbf{G} \\in \\mathbb{R}^{n \\times m}$ 表示离散一阶导数（斜率）算子，其中对于单元 $i = 1, \\dots, n$，有 $(\\mathbf{G}\\mathbf{w})_i \\approx (w_i - w_{i-1})/h$，同样使用 $w_0 = 0$ 和 $w_n = 0$。定义一个作用于每个单元的正几何刚度权重场 $\\mathbf{g} \\in \\mathbb{R}^n$，它代表了平面内压缩合力的分布。\n\n离散弯曲刚度矩阵为\n$$\n\\mathbf{K}(\\mathbf{t}) \\;=\\; \\mathbf{L}^\\top \\, \\mathrm{diag}\\!\\big( \\mathbf{D}(\\mathbf{t}) \\big) \\, \\mathbf{L} \\, h, \n\\quad \\text{其中 } \\mathbf{D}(\\mathbf{t}) = \\big(D_i\\big)_{i=1}^m, \\; D_i = t_i^3,\n$$\n离散几何刚度矩阵为\n$$\n\\mathbf{K}_g(\\mathbf{g}) \\;=\\; \\mathbf{G}^\\top \\, \\mathrm{diag}(\\mathbf{g}) \\, \\mathbf{G} \\, h.\n$$\n用于求解临界载荷因子的线性化屈曲（广义）特征问题是\n$$\n\\mathbf{K}(\\mathbf{t}) \\, \\boldsymbol{\\phi} \\;=\\; \\lambda(\\mathbf{t}) \\, \\mathbf{K}_g(\\mathbf{g}) \\, \\boldsymbol{\\phi},\n$$\n其中最小特征值 $\\lambda(\\mathbf{t})$ 给出临界屈曲因子，$\\boldsymbol{\\phi} \\in \\mathbb{R}^m$ 为对应的振型。假设 $\\mathbf{g}$ 是严格为正的，因此 $\\mathbf{K}_g$ 是对称正定的。\n\n您必须解决以下厚度优化问题：\n- 目标：最大化临界屈曲因子 $\\lambda(\\mathbf{t})$（即上述广义特征问题的最小特征值）。\n- 约束：资源（体积）约束 $\\sum_{i=1}^m t_i = V$ 和对所有 $i \\in \\{1,\\dots,m\\}$ 的最小厚度约束 $t_i \\ge t_{\\min}$。\n\n任务：\n1) 仅从上述定义和薄板弯曲（弯曲刚度与 $t^3$ 成正比）及线性化屈曲（稳定性的广义特征值问题）的基本原理出发，推导在资源约束和边界约束下关于 $\\mathbf{t}$ 的最优性条件。具体来说，用特征值相对于 $t_i$ 的灵敏度来表达平稳性条件，并讨论 $t_i \\ge t_{\\min}$ 约束的存在如何通过互补条件改变激活集和自由集。不要使用任何预先推导的教科书公式；从 Rayleigh 商表征和链式法则开始。\n\n2) 实现一个程序，该程序使用从您得出的条件推导出的最优性准则型更新方法，对优化问题进行数值求解，并结合对资源约束的拉格朗日乘子进行二分法来强制执行 $\\sum_i t_i = V$。当目标函数 $\\lambda(\\mathbf{t})$ 的相对变化和厚度的最大绝对变化均低于 $10^{-6}$ 时，或者在达到 $200$ 次迭代后（以先到者为准）停止。\n\n3) 为了量化“材料向高几何刚度贡献区域分布”的程度，通过以下方式为曲率点定义一个节点几何权重：\n$$\n\\tilde{g}_i \\;=\\; g_i + g_{i+1}, \\quad i = 1,\\dots,m,\n$$\n其中 $g_i$ 是单元的几何刚度权重。收敛后，计算优化后的厚度向量 $\\mathbf{t}^\\star$ 和节点几何权重向量 $\\tilde{\\mathbf{g}}$ 之间的 Pearson 相关系数。如果任一向量的方差为零，则将相关性定义为 $0$。\n\n测试套件：\n使用以下测试用例。在每个用例中，使用 $h = 1/n$，内部未知数 $m = n-1$，以及对于 $i = 1,\\dots,n$，单元中心位于 $x_i = (i - 1/2)/n$。将几何刚度权重场定义为位置 $x$ 的一个平滑正函数。\n- 用例 A（理想情况）：$n=40$, $V = m \\cdot 1.0$, $t_{\\min} = 0.1$，以及 $g(x) = 1.0 + 4.0 \\exp\\!\\big(-((x - 0.5)/0.12)^2\\big)$。\n- 用例 B（高下界）：$n=40$, $V = m \\cdot 1.0$, $t_{\\min} = 0.95$，以及 $g(x) = 1.0 + 4.0 \\exp\\!\\big(-((x - 0.5)/0.12)^2\\big)$。\n- 用例 C（接近体积约束边界）：$n=60$, $t_{\\min} = 0.5$, $V = m \\cdot (t_{\\min} + 0.05)$，以及 $g(x) = 1.0 + 3.0 \\exp\\!\\big(-((x - 0.3)/0.07)^2\\big) + 3.0 \\exp\\!\\big(-((x - 0.7)/0.07)^2\\big)$。\n\n对于每个用例，均匀初始化厚度以满足约束（即 $t_i = \\max\\{t_{\\min}, V/m\\}$）。求解优化问题直至收敛，并报告：\n- 最优临界屈曲因子 $\\lambda^\\star$，\n- 处于下界的设计变量比例 $(\\#\\{i: t_i^\\star \\le t_{\\min}\\})/m$，\n- $\\mathbf{t}^\\star$ 与 $\\tilde{\\mathbf{g}}$ 之间如上定义的相关系数。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个逗号分隔的列表，该列表包含三个子列表，每个测试用例一个，顺序为 A、B、C。每个子列表必须按此顺序包含三个浮点数：$[\\lambda^\\star, \\text{fraction\\_at\\_bound}, \\text{correlation}]$。所有浮点数必须四舍五入到六位小数。例如，一个语法有效的输出行是：\n\"[[0.123456,0.500000,0.987654],[...],[...]]\"。", "solution": "所呈现的问题是一项经典的结构优化任务：在一维结构模型下，最大化薄板带的临界屈曲载荷，同时受限于材料体积和最小厚度约束。在进行求解之前，必须对问题陈述进行验证。\n\n### 问题验证\n\n**1. 提取已知条件：**\n- **模型：** $[0,1]$ 上简支 Kirchhoff-Love 板带的一维代理模型。\n- **离散化：** $n$ 个线段，大小为 $h=1/n$。$m=n-1$ 个内部自由度，用于挠度 $\\mathbf{w} \\in \\mathbb{R}^m$。\n- **设计变量：** 内部点处的厚度向量 $\\mathbf{t} \\in \\mathbb{R}^m$。\n- **刚度矩阵：**\n  - 弯曲刚度：$\\mathbf{K}(\\mathbf{t}) = h \\mathbf{L}^\\top \\mathrm{diag}(\\mathbf{D}(\\mathbf{t})) \\mathbf{L}$，其中 $D_i = t_i^3$。\n  - 几何刚度：$\\mathbf{K}_g(\\mathbf{g}) = h \\mathbf{G}^\\top \\mathrm{diag}(\\mathbf{g}) \\mathbf{G}$。\n- **算子：**\n  - $\\mathbf{L}$：离散二阶导数（三对角，来自零边界条件的中心差分）。\n  - $\\mathbf{G}$：离散一阶导数（双对角，来自前向/后向差分）。\n- **特征问题：** $\\mathbf{K}(\\mathbf{t}) \\boldsymbol{\\phi} = \\lambda(\\mathbf{t}) \\mathbf{K}_g(\\mathbf{g}) \\boldsymbol{\\phi}$。\n- **优化：**\n  - 目标：最大化最小特征值 $\\lambda(\\mathbf{t})$。\n  - 约束：$\\sum_{i=1}^m t_i = V$ 和对所有 $i$ 都有 $t_i \\ge t_{\\min}$。\n- **要求任务：**\n  1. 从第一性原理推导最优性条件。\n  2. 实现一个基于最优性准则的数值求解器。\n  3. 计算最优厚度 $\\mathbf{t}^\\star$ 与节点几何权重向量 $\\tilde{\\mathbf{g}}$ 之间的相关系数，其中 $\\tilde{g}_i = g_i+g_{i+1}$。\n- **测试用例：** 提供了三个不同的用例（A, B, C），包含所有必要的数值参数（$n, V, t_{\\min}$）和几何权重场 $g(x)$ 的函数形式。\n\n**2. 验证分析：**\n- **科学合理性：** 该公式根植于弹性稳定性和结构力学的既定原理。有限差分的使用、刚度矩阵的构建以及将屈曲问题表述为广义特征问题都是标准且正确的。设计目标和约束代表了结构优化中的一个典型问题。\n- **适定性：** 该问题对于数值求解是适定的。约束集是 $\\mathbb{R}^m$ 的一个紧、非空、凸子集。目标函数 $\\lambda(\\mathbf{t})$ 对 $\\mathbf{t}$ 是连续的。因此，解的存在性由极值定理保证。矩阵 $\\mathbf{K}(\\mathbf{t})$（对于 $t_i > 0$）和 $\\mathbf{K}_g(\\mathbf{g})$（对于 $g_i > 0$）是对称正定的，确保所有特征值 $\\lambda$ 都是实数且为正。\n- **完整性和一致性：** 该问题提供了构建和解决问题所需的所有定义、常数和函数形式。对三个测试用例的约束进行检查，确认在每种情况下可行域都是非空的（即 $V > m \\cdot t_{\\min}$）。不存在内部矛盾。\n\n**3. 结论：**\n该问题在科学上是合理的、适定的和自洽的。它是一个有效的问题陈述。我现在将进行推导和求解。\n\n### 第 1 部分：最优性条件的推导\n\n优化问题陈述如下：\n$$\n\\begin{aligned}\n\\text{最大化} \\quad & \\lambda(\\mathbf{t}) \\\\\n\\text{约束于} \\quad & C(\\mathbf{t}) = \\sum_{i=1}^m t_i - V = 0, \\\\\n& g_i(\\mathbf{t}) = t_i - t_{\\min} \\ge 0, \\quad \\text{对于 } i = 1, \\dots, m.\n\\end{aligned}\n$$\n这等价于最小化 $-\\lambda(\\mathbf{t})$。我们引入拉格朗日函数 $\\mathcal{L}$，其中 $\\mu$ 是等式约束的拉格朗日乘子，$\\eta_i$ 是不等式约束的拉格朗日乘子：\n$$\n\\mathcal{L}(\\mathbf{t}, \\mu, \\boldsymbol{\\eta}) = -\\lambda(\\mathbf{t}) + \\mu \\left( \\sum_{i=1}^m t_i - V \\right) - \\sum_{i=1}^m \\eta_i (t_i - t_{\\min})\n$$\n最优性的 Karush-Kuhn-Tucker (KKT) 条件为：\n1.  **平稳性：** $\\frac{\\partial \\mathcal{L}}{\\partial t_i} = 0 \\implies -\\frac{\\partial \\lambda}{\\partial t_i} + \\mu - \\eta_i = 0$ 对所有 $i=1, \\dots, m$ 成立。\n2.  **原始可行性：** $\\sum_{i=1}^m t_i = V$ 和 $t_i \\ge t_{\\min}$。\n3.  **对偶可行性：** $\\eta_i \\ge 0$。\n4.  **互补性：** $\\eta_i (t_i - t_{\\min}) = 0$。\n\n为了继续，我们必须推导特征值的灵敏度 $\\frac{\\partial \\lambda}{\\partial t_i}$。最小特征值 $\\lambda$ 由特征向量 $\\boldsymbol{\\phi}$ 的 Rayleigh 商给出：\n$$\n\\lambda = \\frac{\\boldsymbol{\\phi}^\\top \\mathbf{K}(\\mathbf{t}) \\boldsymbol{\\phi}}{\\boldsymbol{\\phi}^\\top \\mathbf{K}_g(\\mathbf{g}) \\boldsymbol{\\phi}}\n$$\n假设特征向量 $\\boldsymbol{\\phi}$ 已知，$\\lambda$ 对设计变量 $t_i$ 的导数可使用链式法则求得。注意到 $\\mathbf{K}_g$ 与 $\\mathbf{t}$ 无关：\n$$\n\\frac{\\partial \\lambda}{\\partial t_i} = \\frac{\\boldsymbol{\\phi}^\\top \\frac{\\partial \\mathbf{K}(\\mathbf{t})}{\\partial t_i} \\boldsymbol{\\phi}}{\\boldsymbol{\\phi}^\\top \\mathbf{K}_g(\\mathbf{g}) \\boldsymbol{\\phi}}\n$$\n弯曲刚度矩阵为 $\\mathbf{K}(\\mathbf{t}) = h \\mathbf{L}^\\top \\mathrm{diag}(t_1^3, \\dots, t_m^3) \\mathbf{L}$。它对 $t_i$ 的导数为：\n$$\n\\frac{\\partial \\mathbf{K}(\\mathbf{t})}{\\partial t_i} = h \\mathbf{L}^\\top \\left( \\frac{\\partial}{\\partial t_i} \\mathrm{diag}(t_1^3, \\dots, t_m^3) \\right) \\mathbf{L} = h \\mathbf{L}^\\top \\mathrm{diag}(0, \\dots, 3t_i^2, \\dots, 0) \\mathbf{L}\n$$\n其中非零项 $3t_i^2$ 位于第 $i$ 个对角线位置。该对角矩阵可以写成 $3t_i^2 \\mathbf{e}_i \\mathbf{e}_i^\\top$，其中 $\\mathbf{e}_i$ 是第 $i$ 个标准基向量。将其代入灵敏度表达式的分子中：\n$$\n\\boldsymbol{\\phi}^\\top \\frac{\\partial \\mathbf{K}(\\mathbf{t})}{\\partial t_i} \\boldsymbol{\\phi} = \\boldsymbol{\\phi}^\\top \\left( h \\mathbf{L}^\\top (3t_i^2 \\mathbf{e}_i \\mathbf{e}_i^\\top) \\mathbf{L} \\right) \\boldsymbol{\\phi} = 3 h t_i^2 (\\mathbf{L} \\boldsymbol{\\phi})^\\top (\\mathbf{e}_i \\mathbf{e}_i^\\top) (\\mathbf{L} \\boldsymbol{\\phi})\n$$\n令 $\\mathbf{v} = \\mathbf{L} \\boldsymbol{\\phi}$ 为离散曲率向量，表达式简化为 $3 h t_i^2 (\\mathbf{v}^\\top \\mathbf{e}_i)(\\mathbf{e}_i^\\top \\mathbf{v}) = 3 h t_i^2 v_i^2 = 3 h t_i^2 ((\\mathbf{L} \\boldsymbol{\\phi})_i)^2$。因此，灵敏度为：\n$$\n\\frac{\\partial \\lambda}{\\partial t_i} = \\frac{3 h t_i^2 ((\\mathbf{L} \\boldsymbol{\\phi})_i)^2}{\\boldsymbol{\\phi}^\\top \\mathbf{K}_g \\boldsymbol{\\phi}}\n$$\n此表达式表明，屈曲载荷对点 $i$ 处厚度变化的灵敏度与厚度的平方和屈曲振型中局部曲率的平方成正比。使用归一化的特征向量使得分母为 1 会很方便。我们定义一个归一化特征向量 $\\boldsymbol{\\psi}$，使得 $\\boldsymbol{\\psi}^\\top \\mathbf{K}_g \\boldsymbol{\\psi} = 1$。通过此归一化，灵敏度简化为：\n$$\n\\frac{\\partial \\lambda}{\\partial t_i} = S_i = 3 h t_i^2 ((\\mathbf{L} \\boldsymbol{\\psi})_i)^2\n$$\n现在我们分析设计变量的激活集和自由集的 KKT 条件。\n- **自由集：** 对于不在其下界的设计变量（$t_i > t_{\\min}$），互补条件要求其拉格朗日乘子 $\\eta_i$ 为零。平稳性条件则简化为 $\\frac{\\partial \\lambda}{\\partial t_i} = \\mu$。这意味着对于所有自由变量，目标函数的灵敏度必须等于一个常数值 $\\mu$。\n- **激活集：** 对于在其下界的设计变量（$t_i = t_{\\min}$），对于任何 $\\eta_i \\ge 0$，互补条件都得到满足。平稳性条件 $\\eta_i = \\mu - \\frac{\\partial \\lambda}{\\partial t_i}$ 结合 $\\eta_i \\ge 0$ 意味着 $\\frac{\\partial \\lambda}{\\partial t_i} \\le \\mu$。\n\n总结来说，最优性条件是：\n$$\n\\begin{cases}\n\\frac{\\partial \\lambda}{\\partial t_i} = \\mu & \\text{如果 } t_i > t_{\\min} \\\\\n\\frac{\\partial \\lambda}{\\partial t_i} \\le \\mu & \\text{如果 } t_i = t_{\\min}\n\\end{cases}\n$$\n这些条件表明，材料应被分布，以使得灵敏度（即“效费比”）处处相等，除非在厚度被固定在其最小值上的区域；在那些区域，灵敏度被允许更低。\n\n### 第 2 部分：最优性准则更新方案\n\nKKT 条件构成了最优性准则（OC）方法的基础。我们寻求找到满足这些条件的厚度分布 $\\mathbf{t}$。对于自由变量，我们有：\n$$\n3 h t_i^2 ((\\mathbf{L} \\boldsymbol{\\psi})_i)^2 = \\mu \\implies t_i = \\frac{\\sqrt{\\mu}}{\\sqrt{3h} |(\\mathbf{L} \\boldsymbol{\\psi})_i|}\n$$\n这提出了一个迭代更新规则。在每次迭代 $k$ 中，给定当前厚度 $\\mathbf{t}^{(k)}$，我们计算屈曲振型 $\\boldsymbol{\\psi}^{(k)}$，然后找到一个新的厚度分布 $\\mathbf{t}^{(k+1)}$，以满足最优性条件。我们定义一个灵敏度数 $B_i = \\sqrt{3h} |(\\mathbf{L} \\boldsymbol{\\psi}^{(k)})_i|$。那么自由变量的目标厚度就是 $t_i = \\sqrt{\\mu} / B_i$。\n\n令 $\\nu = \\sqrt{\\mu}$，每个厚度的更新，包括下界，变为：\n$$\nt_i^{(k+1)} = \\max\\left(t_{\\min}, \\frac{\\nu}{B_i^{(k)}}\\right)\n$$\n参数 $\\nu$ 是拉格朗日乘子 $\\mu$ 的一个代理，必须通过满足体积约束来确定：\n$$\n\\sum_{i=1}^m t_i^{(k+1)} = \\sum_{i=1}^m \\max\\left(t_{\\min}, \\frac{\\nu}{B_i^{(k)}}\\right) = V\n$$\n左侧是 $\\nu$ 的单调递增函数。因此，我们可以使用二分算法高效地求解这个非线性方程来获得 $\\nu$。\n\n完整的数值算法如下：\n1.  初始化厚度 $\\mathbf{t}^{(0)}$（例如，$t_i = \\max(t_{\\min}, V/m)$）。\n2.  对于 $k = 0, 1, 2, \\dots$ 直到最大迭代次数：\n    a. 构造 $\\mathbf{K}(\\mathbf{t}^{(k)})$ 并求解特征问题 $\\mathbf{K}\\boldsymbol{\\phi} = \\lambda \\mathbf{K}_g \\boldsymbol{\\phi}$，得到最小特征值 $\\lambda^{(k)}$ 和特征向量 $\\boldsymbol{\\phi}^{(k)}$。\n    b. 根据 $\\lambda$ 的相对变化和 $\\mathbf{t}$ 的变化量检查收敛性。\n    c. 归一化特征向量：$\\boldsymbol{\\psi}^{(k)} = \\boldsymbol{\\phi}^{(k)} / \\sqrt{(\\boldsymbol{\\phi}^{(k)})^\\top \\mathbf{K}_g \\boldsymbol{\\phi}^{(k)}}$。\n    d. 计算灵敏度数：$B_i^{(k)} = \\sqrt{3h} |(\\mathbf{L} \\boldsymbol{\\psi}^{(k)})_i|$。\n    e. 使用二分法求解 $\\sum_i \\max(t_{\\min}, \\nu/B_i) = V$ 来找到 $\\nu > 0$。\n    f. 更新厚度向量：$t_i^{(k+1)} = \\max(t_{\\min}, \\nu/B_i^{(k)})$。\n3.  收敛后，报告最终值。\n\n原理推导和算法设计至此结束。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Solves the buckling optimization problem for three test cases\n    using an optimality-criteria method.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"n\": 40, \"V_factor\": 1.0, \"t_min\": 0.1,\n            \"g_func\": lambda x: 1.0 + 4.0 * np.exp(-((x - 0.5) / 0.12)**2)\n        },\n        {\n            \"n\": 40, \"V_factor\": 1.0, \"t_min\": 0.95,\n            \"g_func\": lambda x: 1.0 + 4.0 * np.exp(-((x - 0.5) / 0.12)**2)\n        },\n        {\n            \"n\": 60, \"V_factor\": (0.5 + 0.05), \"t_min\": 0.5,\n            \"g_func\": lambda x: 1.0 + 3.0 * np.exp(-((x - 0.3) / 0.07)**2) + \\\n                                   3.0 * np.exp(-((x - 0.7)/0.07)**2)\n        }\n    ]\n\n    all_results = []\n    \n    # Convergence and control parameters\n    MAX_ITER = 200\n    REL_TOL_LAMBDA = 1e-6\n    ABS_TOL_T = 1e-6\n\n    for case_params in test_cases:\n        n = case_params[\"n\"]\n        t_min = case_params[\"t_min\"]\n        g_func = case_params[\"g_func\"]\n        \n        m = n - 1\n        h = 1.0 / n\n        \n        if case_params[\"n\"] == 40 and case_params[\"t_min\"] == 0.1: # Case A\n             V = m * case_params[\"V_factor\"]\n        elif case_params[\"n\"] == 40 and case_params[\"t_min\"] == 0.95: # Case B\n             V = m * case_params[\"V_factor\"]\n        else: # Case C\n             V = m * case_params[\"V_factor\"]\n\n\n        # --- Assemble constant matrices ---\n        # L matrix (discrete 2nd derivative)\n        L_mat = np.zeros((m, m))\n        L_mat += np.diag(np.full(m, -2.0))\n        L_mat += np.diag(np.ones(m - 1), k=1)\n        L_mat += np.diag(np.ones(m - 1), k=-1)\n        L_mat /= h**2\n\n        # G matrix (discrete 1st derivative)\n        G_mat = np.zeros((n, m))\n        G_mat[0, 0] = 1.0\n        for i in range(1, m):\n            G_mat[i, i-1] = -1.0\n            G_mat[i, i] = 1.0\n        G_mat[m, m-1] = -1.0\n        G_mat[n-1, m-1] = -1.0 # correcting for m -> n-1 index\n        G_mat /= h\n\n        # Geometric stiffness matrix Kg\n        x_g = (np.arange(1, n + 1) - 0.5) / n\n        g_vec = g_func(x_g)\n        Kg = h * G_mat.T @ np.diag(g_vec) @ G_mat\n\n        # --- Optimization Loop ---\n        # Initialize thickness\n        t_current = np.full(m, max(t_min, V / m))\n        if np.sum(t_current) != V: # Adjust if t_min dominates\n             t_current = np.full(m, V/m)\n        \n        lambda_prev = 0.0\n\n        for iter_count in range(MAX_ITER):\n            # Assemble bending stiffness matrix K\n            D_vec = t_current**3\n            K_mat = h * L_mat.T @ np.diag(D_vec) @ L_mat\n\n            # Solve generalized eigenvalue problem: K*phi = lambda*Kg*phi\n            try:\n                # eigh expects B to be positive definite, which Kg is.\n                eigenvalues, eigenvectors = eigh(K_mat, Kg)\n                # Smallest eigenvalue and corresponding eigenvector\n                lambda_current = eigenvalues[0]\n                phi = eigenvectors[:, 0]\n            except np.linalg.LinAlgError:\n                # Failsafe if matrices become singular for some t\n                # This should not happen with t_i >= t_min > 0\n                all_results.append([0.0, 0.0, 0.0]) # Indicate failure\n                break\n\n            # Check for convergence\n            rel_change_lambda = abs(lambda_current - lambda_prev) / (abs(lambda_current) + 1e-9)\n            if iter_count > 0 and rel_change_lambda < REL_TOL_LAMBDA:\n                _, t_new = update_thickness(t_current, phi, L_mat, Kg, h, V, t_min, m)\n                max_change_t = np.max(np.abs(t_new - t_current))\n                if max_change_t < ABS_TOL_T:\n                    t_current = t_new\n                    break\n            \n            lambda_prev = lambda_current\n            \n            # Update thickness using OC method\n            _, t_new = update_thickness(t_current, phi, L_mat, Kg, h, V, t_min, m)\n            t_current = t_new\n            \n        else: # Loop finished without breaking (max iterations reached)\n            # Perform one final calculation of lambda for the last t\n            D_vec = t_current**3\n            K_mat = h * L_mat.T @ np.diag(D_vec) @ L_mat\n            eigenvalues, _ = eigh(K_mat, Kg)\n            lambda_current = eigenvalues[0]\n        \n        # --- Post-processing ---\n        t_star = t_current\n        lambda_star = lambda_current\n\n        # Fraction of design variables at lower bound\n        frac_at_bound = np.sum(t_star <= t_min + 1e-9) / m\n\n        # Correlation coefficient\n        # Nodal geometric weight vector\n        g_tilde = g_vec[:-1] + g_vec[1:]\n        \n        # Pearson correlation\n        if np.std(t_star) == 0 or np.std(g_tilde) == 0:\n            correlation = 0.0\n        else:\n            correlation = np.corrcoef(t_star, g_tilde)[0, 1]\n            if np.isnan(correlation): # Handle potential NaN due to floating point nuances\n                 correlation = 0.0\n\n        all_results.append([lambda_star, frac_at_bound, correlation])\n\n    # Format output\n    output_str = \"[\"\n    for i, res in enumerate(all_results):\n        sublist = f\"[{res[0]:.6f},{res[1]:.6f},{res[2]:.6f}]\"\n        output_str += sublist\n        if i < len(all_results) - 1:\n            output_str += \",\"\n    output_str += \"]\"\n    \n    print(output_str)\n\ndef update_thickness(t_old, phi, L_mat, Kg, h, V, t_min, m):\n    \"\"\"\n    Performs one step of the Optimality Criteria update.\n    \"\"\"\n    # Normalize eigenvector\n    norm_factor = np.sqrt(phi.T @ Kg @ phi)\n    psi = phi / norm_factor\n    \n    # Calculate sensitivity numbers B_i\n    # Add small epsilon to avoid division by zero\n    L_psi = L_mat @ psi\n    B_i = np.sqrt(3.0 * h) * np.abs(L_psi) + 1e-12\n\n    # Bisection to find nu=sqrt(mu)\n    # Define volume function for bisection\n    def vol_func(nu, B, V_target, t_m):\n        return np.sum(np.maximum(t_m, nu / B)) - V_target\n    \n    # Bisection bounds for nu\n    nu_low = 0.0\n    nu_high = V * np.max(B_i) # Guaranteed to give volume > V\n    \n    for _ in range(100): # 100 iterations is more than enough for bisection\n        nu_mid = (nu_low + nu_high) / 2.0\n        if vol_func(nu_mid, B_i, V, t_min) > 0:\n            nu_high = nu_mid\n        else:\n            nu_low = nu_mid\n    \n    nu_opt = (nu_low + nu_high) / 2.0\n    \n    # Update thickness\n    t_new = np.maximum(t_min, nu_opt / B_i)\n\n    # Simple damping to improve stability (not requested but good practice)\n    # A move limit or damping would normally be used here. For this problem,\n    # the direct update is implemented as per the derivation.\n    # No damping is applied per problem structure.\n\n    return nu_opt, t_new\n\nsolve()\n```", "id": "2869768"}]}