{"hands_on_practices": [{"introduction": "本节的第一个练习将引导你完成瑞利-里兹法的一个经典应用。我们将通过一个三角级数来近似简支梁的挠度，这是一种非常适合该问题边界条件的试函数选择。这个实践旨在巩固整个方法的核心流程：从构建总势能，到代入试函数，再到对未知系数进行最小化求解 [@problem_id:2924072]。", "problem": "一根长度为 $L$ 的细长均质棱柱梁，其杨氏模量 $E$ 和截面二次矩 $I$ 为常数，在 $x=0$ 和 $x=L$ 处被简支。该梁承受一个沿 $0 \\le x \\le L$ 向下作用的线性变化横向分布荷载 $q(x)=q_{0}\\,x/L$。使用基于总势能的欧拉-伯努利梁理论和瑞利-里兹法，通过三角级数近似横向挠度：\n$$\nw(x)=\\sum_{n=1}^{N} a_{n} \\sin\\!\\left(\\frac{n\\pi x}{L}\\right),\n$$\n其中 $a_{n}$ 是未知系数，$N$ 是一个正整数。\n\n从第一性原理出发，不引用任何预先推导的梁解公式，建立关于系数 $\\{a_{n}\\}$ 的瑞利-里兹代数系统，并对其进行符号求解，以获得用 $E$、$I$、$L$、$q_{0}$ 和 $n$ 表示的 $a_{n}$ 的通用表达式。然后，确定此展开式中的第一个非零系数。\n\n将你的最终答案表示为用 $E$、$I$、$L$ 和 $q_{0}$ 表示的 $a_{1}$ 的单一闭式表达式。使用国际单位制 (SI)，并以米为单位表示该系数。不要代入数值，也不要对答案进行四舍五入。最终答案必须是单一的解析表达式。", "solution": "该问题要求使用瑞利-里兹法求解一根在简支条件下承受线性变化荷载的梁的挠度近似解。该方法的基础是最小总势能原理，该原理指出，当一个弹性体的总势能 $\\Pi$ 处于最小值时，它处于稳定平衡构型。总势能是储存在物体内的应变能 $U$ 和外力势能 $V$ 的和。\n\n对于具有恒定抗弯刚度 $EI$ 的欧拉-伯努利梁，由弯曲引起的应变能 $U$ 由下式给出：\n$$U = \\frac{1}{2} \\int_{0}^{L} EI (w''(x))^2 dx$$\n其中 $w(x)$ 是梁的横向挠度，$w''(x)$ 表示其曲率。\n\n所施加的向下横向荷载 $q(x) = q_0 x/L$ 的势能 $V$ 为：\n$$V = - \\int_{0}^{L} q(x) w(x) dx = - \\int_{0}^{L} \\frac{q_0 x}{L} w(x) dx$$\n\n因此，总势能泛函为：\n$$\\Pi[w] = U + V = \\frac{EI}{2} \\int_{0}^{L} (w''(x))^2 dx - \\frac{q_0}{L} \\int_{0}^{L} x w(x) dx$$\n\n瑞利-里兹法涉及选择一个带有未知系数的有限级数形式的 $w(x)$ 近似解。给定的试函数为：\n$$w(x) = \\sum_{n=1}^{N} a_{n} \\sin\\left(\\frac{n\\pi x}{L}\\right)$$\n这种基函数 $\\phi_n(x) = \\sin(n\\pi x/L)$ 的选择是巧妙的，因为每个函数都满足简支梁的几何边界条件：$w(0) = 0$ 和 $w(L) = 0$。\n\n我们将此试函数代入总势能泛函 $\\Pi$。首先，我们计算 $w(x)$ 的二阶导数：\n$$w''(x) = \\frac{d^2}{dx^2} \\left( \\sum_{n=1}^{N} a_{n} \\sin\\left(\\frac{n\\pi x}{L}\\right) \\right) = - \\sum_{n=1}^{N} a_{n} \\left(\\frac{n\\pi}{L}\\right)^2 \\sin\\left(\\frac{n\\pi x}{L}\\right)$$\n\n现在，我们计算应变能项 $U$：\n$$U = \\frac{EI}{2} \\int_{0}^{L} \\left( - \\sum_{n=1}^{N} a_{n} \\left(\\frac{n\\pi}{L}\\right)^2 \\sin\\left(\\frac{n\\pi x}{L}\\right) \\right)^2 dx$$\n$$U = \\frac{EI}{2} \\int_{0}^{L} \\left( \\sum_{n=1}^{N} \\sum_{m=1}^{N} a_n a_m \\frac{n^2 \\pi^2}{L^2} \\frac{m^2 \\pi^2}{L^2} \\sin\\left(\\frac{n\\pi x}{L}\\right) \\sin\\left(\\frac{m\\pi x}{L}\\right) \\right) dx$$\n交换积分和求和的顺序，并利用正弦函数在区间 $[0, L]$ 上的正交性：\n$$\\int_{0}^{L} \\sin\\left(\\frac{n\\pi x}{L}\\right) \\sin\\left(\\frac{m\\pi x}{L}\\right) dx = \\frac{L}{2}\\delta_{nm}$$\n其中 $\\delta_{nm}$ 是克罗内克δ函数，双重求和简化为单个求和：\n$$U = \\frac{EI \\pi^4}{2L^4} \\sum_{n=1}^{N} a_n^2 n^4 \\left(\\frac{L}{2}\\right) = \\frac{EI \\pi^4}{4L^3} \\sum_{n=1}^{N} n^4 a_n^2$$\n\n接下来，我们计算荷载的势能 $V$：\n$$V = - \\frac{q_0}{L} \\int_{0}^{L} x \\left( \\sum_{n=1}^{N} a_{n} \\sin\\left(\\frac{n\\pi x}{L}\\right) \\right) dx = - \\frac{q_0}{L} \\sum_{n=1}^{N} a_n \\int_{0}^{L} x \\sin\\left(\\frac{n\\pi x}{L}\\right) dx$$\n该积分使用分部积分法计算：\n$$\\int_{0}^{L} x \\sin\\left(\\frac{n\\pi x}{L}\\right) dx = \\left[x \\left(-\\frac{L}{n\\pi}\\cos\\left(\\frac{n\\pi x}{L}\\right)\\right)\\right]_{0}^{L} - \\int_{0}^{L} 1 \\cdot \\left(-\\frac{L}{n\\pi}\\cos\\left(\\frac{n\\pi x}{L}\\right)\\right) dx$$\n$$= -\\frac{L^2}{n\\pi}\\cos(n\\pi) + \\frac{L}{n\\pi} \\left[\\frac{L}{n\\pi}\\sin\\left(\\frac{n\\pi x}{L}\\right)\\right]_{0}^{L} = -\\frac{L^2}{n\\pi}(-1)^n + 0 = \\frac{L^2}{n\\pi}(-1)^{n+1}$$\n将此结果代入 V 的表达式中：\n$$V = - \\frac{q_0}{L} \\sum_{n=1}^{N} a_n \\left( \\frac{L^2}{n\\pi}(-1)^{n+1} \\right) = -\\frac{q_0 L}{\\pi} \\sum_{n=1}^{N} \\frac{a_n}{n}(-1)^{n+1}$$\n\n总势能 $\\Pi$ 现在是系数 $\\{a_n\\}$ 的函数：\n$$\\Pi(a_1, \\dots, a_N) = \\frac{EI \\pi^4}{4L^3} \\sum_{n=1}^{N} n^4 a_n^2 - \\frac{q_0 L}{\\pi} \\sum_{n=1}^{N} \\frac{a_n}{n}(-1)^{n+1}$$\n\n为了找到使 $\\Pi$ 最小化的 $a_n$ 值，我们将 $\\Pi$ 对每个系数 $a_m$ 的偏导数设为零：\n$$\\frac{\\partial \\Pi}{\\partial a_m} = 0 \\quad \\text{for } m = 1, 2, \\dots, N$$\n$$\\frac{\\partial}{\\partial a_m} \\left( \\frac{EI \\pi^4}{4L^3} \\sum_{n=1}^{N} n^4 a_n^2 - \\frac{q_0 L}{\\pi} \\sum_{n=1}^{N} \\frac{a_n}{n}(-1)^{n+1} \\right) = 0$$\n由于求和的结构，对 $a_m$ 求导只会保留 $n=m$ 的项：\n$$\\frac{EI \\pi^4}{4L^3} (2 m^4 a_m) - \\frac{q_0 L}{\\pi} \\frac{(-1)^{m+1}}{m} = 0$$\n$$\\frac{EI \\pi^4 m^4}{2L^3} a_m = \\frac{q_0 L}{\\pi m}(-1)^{m+1}$$\n求解通用系数 $a_m$：\n$$a_m = \\left( \\frac{q_0 L}{\\pi m}(-1)^{m+1} \\right) \\left( \\frac{2L^3}{EI \\pi^4 m^4} \\right) = \\frac{2q_0 L^4}{EI \\pi^5} \\frac{(-1)^{m+1}}{m^5}$$\n将索引 $m$ 替换为 $n$，得到任意系数 $a_n$ 的通用表达式：\n$$a_n = \\frac{2q_0 L^4}{EI \\pi^5} \\frac{(-1)^{n+1}}{n^5}$$\n对于任何正整数 $n \\ge 1$，此表达式均不为零。问题要求确定第一个非零系数，即 $a_1$。我们通过令 $n=1$来得到它：\n$$a_1 = \\frac{2q_0 L^4}{EI \\pi^5} \\frac{(-1)^{1+1}}{1^5} = \\frac{2q_0 L^4}{EI \\pi^5}$$\n这给出了挠度曲线第一阶模态的振幅。", "answer": "$$\\boxed{\\frac{2 q_{0} L^{4}}{EI \\pi^{5}}}$$", "id": "2924072"}, {"introduction": "瑞利-里兹法在能量泛函上进行最小化，这保证了位移等全局量的良好近似。但是，对于位移的导数（如曲率和弯矩）的近似效果如何呢？这个练习将通过一个简单的多项式试函数来探讨这一关键问题 [@problem_id:2924077]。你将发现，即使位移的近似相当准确，其导数（与应力直接相关）的误差可能会大得多，这是所有基于变分原理的近似方法中一个深刻且普遍的教训。", "problem": "考虑一根棱柱形、线性弹性的欧拉-伯努利梁，其长度为 $L$，抗弯刚度为常数 $EI$。该梁在 $x=0$ 和 $x=L$ 处为简支，并在 $0 \\le x \\le L$ 范围内承受集度为 $q_{0}$、方向向下的空间均匀横向荷载。其本质（几何）边界条件为 $w(0)=0$ 和 $w(L)=0$，其中 $w(x)$ 是横向挠度。采用最小势能原理和瑞利-里兹法，使用形式为 $w_{R}(x)=a\\,\\phi(x)$ 的单参数试探挠度函数，其中 $\\phi(x)=x(L-x)$，该函数满足本质边界条件。\n\n在此框架下：\n- 通过最小化总势能，确定瑞利-里兹近似解 $w_{R}(x)$ 的系数 $a$。\n- 根据 $w_{R}(x)$，计算弯矩分布 $M_{R}(x)=-EI\\,w_{R}''(x)$。\n- 对于给定荷载下的简支梁，根据静力平衡和本构关系 $M(x)=-EI\\,w''(x)$，求得精确的内弯矩分布 $M_{\\text{exact}}(x)$。\n- 通过对运动-曲率关系进行两次积分并应用适当的边界条件，确定精确的跨中挠度 $w_{\\text{exact}}(L/2)$。\n\n将跨中相对弯曲应力误差定义为 $x=L/2$ 处预测的与精确的边缘纤维弯曲应力之差的绝对值，再除以 $x=L/2$ 处的精确值。由于给定截面上的边缘纤维弯曲应力与 $M(x)$ 成正比，因此可以在此比率中用弯矩代替弯曲应力。类似地，使用 $w(L/2)$ 定义跨中的相对挠度误差。令\n$$\n\\mathcal{R}=\\frac{\\text{跨中相对弯曲应力误差}}{\\text{跨中相对挠度误差}}。\n$$\n精确计算 $\\mathcal{R}$，并将最终答案表示为一个无单位的最简分数。无需四舍五入。", "solution": "欧拉-伯努利梁的总势能 $\\Pi$ 是应变能 $U$ 和外荷载势能 $W_e$ 的总和。\n$$\n\\Pi = U + W_e\n$$\n对于抗弯刚度 $EI$ 为常数的梁，其应变能由下式给出：\n$$\nU = \\frac{1}{2} \\int_{0}^{L} EI (w''(x))^{2} dx\n$$\n方向向下的分布横向荷载 $q_{0}$ 的势能为：\n$$\nW_e = - \\int_{0}^{L} q_{0} w(x) dx\n$$\n因此，总势能为：\n$$\n\\Pi[w(x)] = \\frac{1}{2} \\int_{0}^{L} EI (w''(x))^{2} dx - \\int_{0}^{L} q_{0} w(x) dx\n$$\n我们采用瑞利-里兹法，使用给定的单参数试探函数 $w_{R}(x) = a \\phi(x)$，其中 $\\phi(x) = x(L-x)$。该函数满足本质边界条件 $w_{R}(0) = a (0)(L-0) = 0$ 和 $w_{R}(L) = a (L)(L-L) = 0$。\n首先，我们计算 $w_{R}(x)$ 的导数：\n$$\nw_{R}(x) = a(Lx - x^{2})\n$$\n$$\nw_{R}'(x) = a(L - 2x)\n$$\n$$\nw_{R}''(x) = -2a\n$$\n接下来，我们将这些导数代入总势能 $\\Pi$ 的表达式中，以获得一个关于未知系数 $a$ 的函数：\n$$\n\\Pi(a) = \\frac{1}{2} \\int_{0}^{L} EI (-2a)^{2} dx - \\int_{0}^{L} q_{0} a(Lx - x^{2}) dx\n$$\n我们分别计算积分。应变能项为：\n$$\nU(a) = \\frac{1}{2} EI (4a^{2}) \\int_{0}^{L} dx = 2a^{2}EI L\n$$\n外荷载势能项为：\n$$\nW_e(a) = -aq_{0} \\int_{0}^{L} (Lx - x^{2}) dx = -aq_{0} \\left[ \\frac{Lx^{2}}{2} - \\frac{x^{3}}{3} \\right]_{0}^{L} = -aq_{0} \\left( \\frac{L^{3}}{2} - \\frac{L^{3}}{3} \\right) = -aq_{0} \\frac{L^{3}}{6}\n$$\n因此，总势能为：\n$$\n\\Pi(a) = 2a^{2}EI L - a \\frac{q_{0}L^{3}}{6}\n$$\n根据最小势能原理，通过最小化 $\\Pi(a)$ 来求得 $a$ 的值：\n$$\n\\frac{d\\Pi}{da} = \\frac{d}{da} \\left( 2a^{2}EI L - a \\frac{q_{0}L^{3}}{6} \\right) = 4aEI L - \\frac{q_{0}L^{3}}{6} = 0\n$$\n求解 $a$：\n$$\n4aEI L = \\frac{q_{0}L^{3}}{6} \\implies a = \\frac{q_{0}L^{2}}{24EI}\n$$\n近似挠度为 $w_{R}(x) = \\frac{q_{0}L^{2}}{24EI} x(L-x)$。\n相应的近似弯矩为 $M_{R}(x) = -EI w_{R}''(x)$。由于 $w_{R}''(x) = -2a = -2 \\left( \\frac{q_{0}L^{2}}{24EI} \\right) = -\\frac{q_{0}L^{2}}{12EI}$，我们得到：\n$$\nM_{R}(x) = -EI \\left( -\\frac{q_{0}L^{2}}{12EI} \\right) = \\frac{q_{0}L^{2}}{12}\n$$\n在跨中 $x=L/2$ 处，近似弯矩为 $M_{R}(L/2) = \\frac{q_{0}L^{2}}{12}$。\n\n现在，我们推导精确解。对于均布荷载 $q_{0}$ 作用下的简支梁，支座反力为 $R_{A} = R_{B} = \\frac{q_{0}L}{2}$。内剪力为 $V(x) = \\frac{q_{0}L}{2} - q_{0}x$。通过对剪力积分，可求得精确的内弯矩 $M_{\\text{exact}}(x)$：\n$$\nM_{\\text{exact}}(x) = \\int (\\frac{q_{0}L}{2} - q_{0}x) dx = \\frac{q_{0}Lx}{2} - \\frac{q_{0}x^{2}}{2} + C\n$$\n根据边界条件 $M(0)=0$，积分常数 $C$ 为 $0$。因此：\n$$\nM_{\\text{exact}}(x) = \\frac{q_{0}}{2} x(L-x)\n$$\n在跨中 $x=L/2$ 处，精确弯矩为：\n$$\nM_{\\text{exact}}(L/2) = \\frac{q_{0}}{2} \\left(\\frac{L}{2}\\right) \\left(L-\\frac{L}{2}\\right) = \\frac{q_{0}}{2} \\frac{L}{2} \\frac{L}{2} = \\frac{q_{0}L^{2}}{8}\n$$\n跨中的相对弯曲应力误差用弯矩定义如下：\n$$\n\\text{err}_{M} = \\frac{|M_{R}(L/2) - M_{\\text{exact}}(L/2)|}{M_{\\text{exact}}(L/2)} = \\frac{|\\frac{q_{0}L^{2}}{12} - \\frac{q_{0}L^{2}}{8}|}{\\frac{q_{0}L^{2}}{8}} = \\frac{|\\frac{2-3}{24}|}{\\frac{1}{8}} = \\frac{1/24}{1/8} = \\frac{8}{24} = \\frac{1}{3}\n$$\n接下来，我们求解精确的跨中挠度 $w_{\\text{exact}}(L/2)$。控制方程为 $EI w''(x) = -M_{\\text{exact}}(x) = -\\frac{q_{0}}{2}(Lx - x^{2})$。积分两次并应用边界条件 $w(0)=0$ 和 $w(L)=0$（或对称条件 $w'(L/2)=0$），得到挠度函数：\n$$\nw_{\\text{exact}}(x) = \\frac{q_{0}x}{24EI} (L^{3} - 2Lx^{2} + x^{3})\n$$\n在 $x=L/2$ 处的精确跨中挠度为：\n$$\nw_{\\text{exact}}(L/2) = \\frac{q_{0}(L/2)}{24EI} \\left(L^{3} - 2L\\left(\\frac{L}{2}\\right)^{2} + \\left(\\frac{L}{2}\\right)^{3}\\right) = \\frac{q_{0}L}{48EI} \\left(L^{3} - \\frac{L^{3}}{2} + \\frac{L^{3}}{8}\\right) = \\frac{q_{0}L}{48EI} \\left(\\frac{8-4+1}{8}L^{3}\\right) = \\frac{5q_{0}L^{4}}{384EI}\n$$\n近似跨中挠度为：\n$$\nw_{R}(L/2) = \\frac{q_{0}L^{2}}{24EI} \\left(\\frac{L}{2}\\right) \\left(L-\\frac{L}{2}\\right) = \\frac{q_{0}L^{2}}{24EI} \\frac{L^{2}}{4} = \\frac{q_{0}L^{4}}{96EI}\n$$\n跨中的相对挠度误差为：\n$$\n\\text{err}_{w} = \\frac{|w_{R}(L/2) - w_{\\text{exact}}(L/2)|}{w_{\\text{exact}}(L/2)} = \\frac{|\\frac{q_{0}L^{4}}{96EI} - \\frac{5q_{0}L^{4}}{384EI}|}{\\frac{5q_{0}L^{4}}{384EI}} = \\frac{|\\frac{4}{384} - \\frac{5}{384}|}{\\frac{5}{384}} = \\frac{1/384}{5/384} = \\frac{1}{5}\n$$\n最后，我们计算相对误差之比 $\\mathcal{R}$：\n$$\n\\mathcal{R} = \\frac{\\text{err}_{M}}{\\text{err}_{w}} = \\frac{1/3}{1/5} = \\frac{5}{3}\n$$", "answer": "$$\\boxed{\\frac{5}{3}}$$", "id": "2924077"}, {"introduction": "在将瑞利-里兹法付诸计算实践时，基函数的选择不仅影响精度，还直接决定了数值求解的稳定性。此练习将揭示一个常见陷阱：直接使用诸如 $x^2$ 和 $x^3$ 等原始幂函数作为基函数，会导致刚度矩阵的条件数急剧恶化，使数值解不可靠 [@problem_id:2924102]。通过这个练习，你将学习如何通过对基函数进行适当的缩放来缓解此问题，这是连接理论与稳健计算实现的关键一步。", "problem": "考虑在区间 $[0,L]$ 上具有恒定弯曲刚度 $E I$ 的 Euler–Bernoulli 梁模型。挠度场 $w(x)$ 的总应变能为\n$$\n\\mathcal{U}[w] \\;=\\; \\frac{1}{2} \\int_{0}^{L} E I \\left(w''(x)\\right)^{2} \\, dx,\n$$\n它导出了如下对称双线性形式\n$$\na(u,v) \\;=\\; \\int_{0}^{L} E I \\, u''(x)\\, v''(x)\\, dx.\n$$\n在 Rayleigh–Ritz 方法中，使用一个基为 $\\{\\phi_i(x)\\}_{i=1}^{n}$ 的有限维试验子空间 $\\mathcal{V}_h$，刚度矩阵 $\\mathbf{K} \\in \\mathbb{R}^{n \\times n}$ 的元素为 $K_{ij} = a(\\phi_i,\\phi_j)$。为了进行条件数分析，假设容许子空间排除了刚体模态，并取在 $[0,L]$ 上的原始单项式基 $\\{\\phi_1(x),\\phi_2(x)\\} = \\{x^{2}, x^{3}\\}$。\n\n1) 从双线性形式 $a(u,v)$ 出发，推导对应于原始单项式基 $\\{x^{2}, x^{3}\\}$ 的刚度矩阵 $\\mathbf{K}(L)$。\n\n2) 使用对称正定矩阵的谱（二范数）条件数定义 $\\kappa_{2}(\\mathbf{K}) = \\lambda_{\\max}(\\mathbf{K})/\\lambda_{\\min}(\\mathbf{K})$，以 $L$ 的函数形式计算 $\\kappa_{2}\\!\\left(\\mathbf{K}(L)\\right)$ 的闭合解。\n\n3) 为了减轻病态问题，通过 $x = L \\hat{x}$ 对坐标进行无量纲化，并通过以下公式对基进行重新缩放\n$$\n\\tilde{\\phi}_{i}(x) \\;=\\; L^{-\\left(p_{i} - \\frac{3}{2}\\right)}\\, x^{p_{i}},\n\\quad \\text{其中} \\quad p_{1}=2,\\; p_{2}=3,\n$$\n以使刚度矩阵的大小与 $L$ 无关。推导相应的重缩放刚度矩阵 $\\tilde{\\mathbf{K}}$ 并计算其条件数 $\\kappa_{2}(\\tilde{\\mathbf{K}})$。\n\n4) 定义改善因子\n$$\n\\rho(L) \\;=\\; \\frac{\\kappa_{2}\\!\\left(\\mathbf{K}(L)\\right)}{\\kappa_{2}\\!\\left(\\tilde{\\mathbf{K}}\\right)}.\n$$\n将 $\\rho(L)$ 表示为仅含 $L$ 的单个简化解析表达式。不包含任何单位。你的最终答案必须是这个单一表达式。", "solution": "第一部分：刚度矩阵 $\\mathbf{K}(L)$ 的推导。\n\n问题定义了双线性形式 $a(u,v) = \\int_{0}^{L} E I \\, u''(x)\\, v''(x)\\, dx$ 以及一个基 $\\{\\phi_1(x), \\phi_2(x)\\} = \\{x^2, x^3\\}$。刚度矩阵 $\\mathbf{K}$ 的元素由 $K_{ij} = a(\\phi_i, \\phi_j)$ 给出。\n\n首先，我们计算基函数的二阶导数：\n$$\n\\phi_1'(x) = 2x, \\quad \\phi_1''(x) = 2\n$$\n$$\n\\phi_2'(x) = 3x^2, \\quad \\phi_2''(x) = 6x\n$$\n$2 \\times 2$ 刚度矩阵 $\\mathbf{K}(L)$ 的元素计算如下。恒定弯曲刚度 $EI$ 被视为一个标量因子。\n\n$K_{11} = a(\\phi_1, \\phi_1) = \\int_{0}^{L} E I (\\phi_1''(x))^2 dx = \\int_{0}^{L} E I (2)^2 dx = 4EI \\int_{0}^{L} dx = 4EI L$。\n\n$K_{12} = a(\\phi_1, \\phi_2) = \\int_{0}^{L} E I \\phi_1''(x) \\phi_2''(x) dx = \\int_{0}^{L} E I (2)(6x) dx = 12EI \\int_{0}^{L} x dx = 12EI \\left[\\frac{x^2}{2}\\right]_{0}^{L} = 6EI L^2$。\n\n由于双线性形式的对称性，$K_{21} = K_{12} = 6EI L^2$。\n\n$K_{22} = a(\\phi_2, \\phi_2) = \\int_{0}^{L} E I (\\phi_2''(x))^2 dx = \\int_{0}^{L} E I (6x)^2 dx = 36EI \\int_{0}^{L} x^2 dx = 36EI \\left[\\frac{x^3}{3}\\right]_{0}^{L} = 12EI L^3$。\n\n综合这些元素，刚度矩阵为：\n$$\n\\mathbf{K}(L) = E I \\begin{pmatrix} 4L & 6L^2 \\\\ 6L^2 & 12L^3 \\end{pmatrix}\n$$\n\n第二部分：谱条件数 $\\kappa_2(\\mathbf{K}(L))$ 的计算。\n\n谱条件数 $\\kappa_2(\\mathbf{K})$ 是最大特征值与最小特征值之比，即 $\\lambda_{\\max}/\\lambda_{\\min}$。标量因子 $EI$ 不影响条件数，因此我们求解矩阵 $\\mathbf{A}(L) = \\begin{pmatrix} 4L & 6L^2 \\\\ 6L^2 & 12L^3 \\end{pmatrix}$ 的特征值。特征值 $\\lambda$ 是特征方程 $\\det(\\mathbf{A}(L) - \\lambda \\mathbf{I}) = 0$ 的根。\n$$\n\\lambda^2 - \\text{tr}(\\mathbf{A}(L))\\lambda + \\det(\\mathbf{A}(L)) = 0\n$$\n迹为 $\\text{tr}(\\mathbf{A}(L)) = 4L + 12L^3$。\n行列式为 $\\det(\\mathbf{A}(L)) = (4L)(12L^3) - (6L^2)^2 = 48L^4 - 36L^4 = 12L^4$。\n特征方程为：\n$$\n\\lambda^2 - (4L + 12L^3)\\lambda + 12L^4 = 0\n$$\n使用二次公式，特征值为：\n$$\n\\lambda = \\frac{(4L + 12L^3) \\pm \\sqrt{(4L + 12L^3)^2 - 4(12L^4)}}{2}\n$$\n判别式为 $D = (4L(1+3L^2))^2 - 48L^4 = 16L^2(1+6L^2+9L^4) - 48L^4 = 16L^2 + 96L^4 + 144L^6 - 48L^4 = 144L^6 + 48L^4 + 16L^2 = 16L^2(9L^4+3L^2+1)$。\n判别式的平方根为 $\\sqrt{D} = 4L\\sqrt{9L^4+3L^2+1}$。\n特征值为：\n$$\n\\lambda = \\frac{4L(1+3L^2) \\pm 4L\\sqrt{9L^4+3L^2+1}}{2} = 2L \\left( (1+3L^2) \\pm \\sqrt{9L^4+3L^2+1} \\right)\n$$\n最大和最小特征值分别为：\n$$\n\\lambda_{\\max} = 2L \\left( (1+3L^2) + \\sqrt{9L^4+3L^2+1} \\right)\n$$\n$$\n\\lambda_{\\min} = 2L \\left( (1+3L^2) - \\sqrt{9L^4+3L^2+1} \\right)\n$$\n条件数是它们的比值：\n$$\n\\kappa_2(\\mathbf{K}(L)) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{(1+3L^2) + \\sqrt{9L^4+3L^2+1}}{(1+3L^2) - \\sqrt{9L^4+3L^2+1}}\n$$\n\n第三部分：重缩放刚度矩阵 $\\tilde{\\mathbf{K}}$ 及其条件数的推导。\n\n重缩放的基函数为 $\\tilde{\\phi}_{i}(x) = L^{-(p_i - 3/2)} x^{p_i}$，其中 $p_1=2$ 且 $p_2=3$。\n$$\n\\tilde{\\phi}_1(x) = L^{-(2 - 3/2)} x^2 = L^{-1/2} x^2\n$$\n$$\n\\tilde{\\phi}_2(x) = L^{-(3 - 3/2)} x^3 = L^{-3/2} x^3\n$$\n它们的二阶导数为：\n$$\n\\tilde{\\phi}_1''(x) = 2L^{-1/2}\n$$\n$$\n\\tilde{\\phi}_2''(x) = 6 L^{-3/2} x\n$$\n我们计算元素 $\\tilde{K}_{ij} = a(\\tilde{\\phi}_i, \\tilde{\\phi}_j)$：\n$$\n\\tilde{K}_{11} = \\int_0^L EI (2L^{-1/2})^2 dx = 4EI L^{-1} \\int_0^L dx = 4EI L^{-1} (L) = 4EI\n$$\n$$\n\\tilde{K}_{12} = \\int_0^L EI (2L^{-1/2})(6L^{-3/2}x) dx = 12EI L^{-2} \\int_0^L x dx = 12EI L^{-2} \\left(\\frac{L^2}{2}\\right) = 6EI\n$$\n$$\n\\tilde{K}_{22} = \\int_0^L EI (6L^{-3/2}x)^2 dx = 36EI L^{-3} \\int_0^L x^2 dx = 36EI L^{-3} \\left(\\frac{L^3}{3}\\right) = 12EI\n$$\n重缩放的刚度矩阵确实与 $L$ 无关：\n$$\n\\tilde{\\mathbf{K}} = EI \\begin{pmatrix} 4 & 6 \\\\ 6 & 12 \\end{pmatrix}\n$$\n为了求其条件数，我们求解矩阵 $\\tilde{\\mathbf{A}} = \\begin{pmatrix} 4 & 6 \\\\ 6 & 12 \\end{pmatrix}$ 的特征值。\n特征方程为 $\\lambda^2 - \\text{tr}(\\tilde{\\mathbf{A}})\\lambda + \\det(\\tilde{\\mathbf{A}}) = 0$。\n$\\text{tr}(\\tilde{\\mathbf{A}}) = 4+12=16$。\n$\\det(\\tilde{\\mathbf{A}}) = (4)(12) - (6)^2 = 48 - 36 = 12$。\n$$\n\\lambda^2 - 16\\lambda + 12 = 0\n$$\n特征值为 $\\lambda = \\frac{16 \\pm \\sqrt{16^2 - 4(12)}}{2} = \\frac{16 \\pm \\sqrt{256 - 48}}{2} = \\frac{16 \\pm \\sqrt{208}}{2}$。\n由于 $208 = 16 \\times 13$，所以 $\\sqrt{208} = 4\\sqrt{13}$。\n所以，$\\lambda = \\frac{16 \\pm 4\\sqrt{13}}{2} = 8 \\pm 2\\sqrt{13}$。\n条件数为：\n$$\n\\kappa_2(\\tilde{\\mathbf{K}}) = \\frac{8 + 2\\sqrt{13}}{8 - 2\\sqrt{13}} = \\frac{4 + \\sqrt{13}}{4 - \\sqrt{13}}\n$$\n\n第四部分：改善因子 $\\rho(L)$ 的推导。\n\n改善因子定义为 $\\rho(L) = \\frac{\\kappa_{2}(\\mathbf{K}(L))}{\\kappa_{2}(\\tilde{\\mathbf{K}})}$。为了得到一个简化的表达式，我们首先通过分母有理化来简化每个条件数。\n对于 $\\kappa_2(\\mathbf{K}(L))$：\n$$\n\\kappa_2(\\mathbf{K}(L)) = \\frac{(1+3L^2) + \\sqrt{9L^4+3L^2+1}}{(1+3L^2) - \\sqrt{9L^4+3L^2+1}} \\times \\frac{(1+3L^2) + \\sqrt{9L^4+3L^2+1}}{(1+3L^2) + \\sqrt{9L^4+3L^2+1}}\n$$\n$$\n= \\frac{\\left( (1+3L^2) + \\sqrt{9L^4+3L^2+1} \\right)^2}{(1+3L^2)^2 - (9L^4+3L^2+1)} = \\frac{\\left( (1+3L^2) + \\sqrt{9L^4+3L^2+1} \\right)^2}{1+6L^2+9L^4 - 9L^4-3L^2-1} = \\frac{\\left( (1+3L^2) + \\sqrt{9L^4+3L^2+1} \\right)^2}{3L^2}\n$$\n对于 $\\kappa_2(\\tilde{\\mathbf{K}})$：\n$$\n\\kappa_2(\\tilde{\\mathbf{K}}) = \\frac{4 + \\sqrt{13}}{4 - \\sqrt{13}} = \\frac{(4 + \\sqrt{13})^2}{4^2 - (\\sqrt{13})^2} = \\frac{16 + 8\\sqrt{13} + 13}{16-13} = \\frac{29 + 8\\sqrt{13}}{3}\n$$\n现在我们计算比值 $\\rho(L)$：\n$$\n\\rho(L) = \\frac{\\kappa_2(\\mathbf{K}(L))}{\\kappa_2(\\tilde{\\mathbf{K}})} = \\frac{\\frac{\\left( (1+3L^2) + \\sqrt{9L^4+3L^2+1} \\right)^2}{3L^2}}{\\frac{29 + 8\\sqrt{13}}{3}}\n$$\n通过消去分母中的因子 $3$ 来简化此表达式，得到最终结果。\n$$\n\\rho(L) = \\frac{\\left( (1+3L^2) + \\sqrt{9L^4+3L^2+1} \\right)^2}{(29 + 8\\sqrt{13})L^2}\n$$\n这就是改善因子的单个简化解析表达式。", "answer": "$$\\boxed{\\frac{\\left( 1+3L^2 + \\sqrt{9L^4+3L^2+1} \\right)^2}{\\left(29 + 8\\sqrt{13}\\right)L^2}}$$", "id": "2924102"}]}