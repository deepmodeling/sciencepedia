{"hands_on_practices": [{"introduction": "要扎实掌握基本概念，通过手动计算进行推导是必不可少的。简单剪切是力学中的一个典型例子，尽管其描述简单，却揭示了有限变形中拉伸与旋转之间深刻的相互作用。[@problem_id:2886430] 这项练习将引导你基于第一性原理，直接计算简单剪切的极分解，从而巩固你对右柯西-格林张量 ($\\mathbf{C}$) 和右拉伸张量 ($\\mathbf{U}$) 的理解。", "problem": "一个三维均匀单剪切变形由变形梯度 $\\,\\mathbf{F}=\\mathbf{I}+\\gamma\\,\\mathbf{e}_{1}\\otimes\\mathbf{e}_{2}\\,$ 描述，其中 $\\,\\gamma\\in\\mathbb{R}\\,$ 是一个常数剪切参数，$\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$ 是一个标准正交基。仅使用有限变形运动学的基本定义，通过确定一个旋转张量 $\\,\\mathbf{R}\\in\\mathrm{SO}(3)\\,$ 和一个对称正定的右拉伸张量 $\\,\\mathbf{U}\\,$ 来对 $\\,\\mathbf{F}\\,$ 进行右极分解，使得 $\\,\\mathbf{F}=\\mathbf{R}\\mathbf{U}\\,$。你的推导必须从定义 $\\,\\mathbf{C}=\\mathbf{F}^{\\mathsf{T}}\\mathbf{F}\\,$ 和 $\\,\\mathbf{U}=\\mathbf{C}^{1/2}\\,$（$\\,\\mathbf{C}\\,$ 唯一的对称正定平方根）开始，然后是 $\\,\\mathbf{R}=\\mathbf{F}\\mathbf{U}^{-1}\\,$，并应建立 $\\,\\mathbf{R}\\,$ 和 $\\,\\mathbf{U}\\,$ 关于 $\\,\\gamma\\,$ 的闭式表达式。验证 $\\,\\mathbf{U}^{2}=\\mathbf{C}\\,$ 和 $\\,\\mathbf{R}^{\\mathsf{T}}\\mathbf{R}=\\mathbf{I}\\,$。\n\n最后，将 $\\,\\mathbf{R}\\,$ 参数化为绕 $\\,\\mathbf{e}_{3}\\,$ 轴、带符号角度为 $\\,\\theta(\\gamma)\\,$ 的平面旋转，即 $\\,\\mathbf{R}=\\mathbf{Q}(\\theta)\\,$，其中 $\\,\\mathbf{Q}(\\theta)\\,$ 在 $\\,\\mathbf{e}_{1}\\text{--}\\mathbf{e}_{2}\\,$ 平面内限定为一个标准旋转矩阵且 $\\,\\mathbf{Q}_{33}=1\\,$。并从中提取出角度 $\\,\\theta(\\gamma)\\,$ 的显式闭式表达式。\n\n作为你最终提交的答案，仅需报告函数 $\\,\\theta(\\gamma)\\,$（以弧度为单位）的单个闭式解析表达式（无需数值舍入）。", "solution": "给定的变形梯度为 $\\mathbf{F}=\\mathbf{I}+\\gamma\\,\\mathbf{e}_{1}\\otimes\\mathbf{e}_{2}$，其中 $\\gamma$ 是剪切参数，$\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$ 是一个标准正交基。在此基下，$\\mathbf{F}$ 的矩阵表示为：\n$$\n[F] = \\begin{pmatrix} 1 & \\gamma & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n右极分解为 $\\mathbf{F}=\\mathbf{R}\\mathbf{U}$，其中 $\\mathbf{R}$ 是一个旋转张量，$\\mathbf{U}$ 是一个对称正定的右拉伸张量。推导从计算右柯西-格林形变张量 $\\mathbf{C}=\\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$ 开始。\n$$\n[F^{\\mathsf{T}}] = \\begin{pmatrix} 1 & 0 & 0 \\\\ \\gamma & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n$$\n[C] = [F^{\\mathsf{T}}][F] = \\begin{pmatrix} 1 & 0 & 0 \\\\ \\gamma & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & \\gamma & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & \\gamma & 0 \\\\ \\gamma & \\gamma^2 + 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n接下来，我们求解右拉伸张量 $\\mathbf{U}=\\mathbf{C}^{1/2}$。由于 $\\mathbf{C}$ 是对称且正定的，$\\mathbf{U}$ 是唯一的。我们寻求一个对称矩阵 $[U]$ 使得 $[U]^2=[C]$。根据 $[C]$ 的结构，我们假设 $[U]$ 具有以下形式：\n$$\n[U] = \\begin{pmatrix} a & b & 0 \\\\ b & c & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n其中分量 $U_{33}=1$ 是因为 $C_{33}=1$。将此矩阵平方可得：\n$$\n[U]^2 = \\begin{pmatrix} a^2+b^2 & b(a+c) & 0 \\\\ b(a+c) & b^2+c^2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & \\gamma & 0 \\\\ \\gamma & \\gamma^2 + 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n这为 $a, b, c$ 提供了一个代数方程组：\n1. $a^2+b^2=1$\n2. $b(a+c)=\\gamma$\n3. $b^2+c^2=\\gamma^2+1$\n\n为使 $\\mathbf{U}$ 是正定的，其所有主子式必须为正。这要求 $a>0$ 和 $ac-b^2>0$。从(2)式可知，若 $\\gamma \\ne 0$，则 $b \\ne 0$。我们可以假设 $b$ 与 $\\gamma$ 同号。\n从(1)和(3)式，我们得到 $c^2-a^2 = \\gamma^2$。从(2)式，我们得到 $a+c = \\gamma/b$。结合这两个式子可得 $c-a = \\gamma b$。解出 $a$ 和 $c$ 可得 $a=\\frac{1}{2}(\\frac{\\gamma}{b}-\\gamma b)$ 和 $c=\\frac{1}{2}(\\frac{\\gamma}{b}+\\gamma b)$。\n将 $a$ 代入(1)式，得到一个关于 $b^2$ 的二次方程：$(\\gamma^2+4)b^4 - 2(\\gamma^2+2)b^2 + \\gamma^2 = 0$。\n$b^2$ 的解为 $b^2 = \\frac{\\gamma^2}{\\gamma^2+4}$ 和 $b^2=1$。解 $b^2=1$ 会导出一个非正定的 $\\mathbf{U}$ 矩阵，因此舍弃。\n我们取 $b^2=\\frac{\\gamma^2}{\\gamma^2+4}$。我们选择 $b=\\frac{\\gamma}{\\sqrt{\\gamma^2+4}}$ 以使 $b$ 与 $\\gamma$ 同号。这得出：\n$a = \\frac{2}{\\sqrt{\\gamma^2+4}}$\n$c = \\frac{\\gamma^2+2}{\\sqrt{\\gamma^2+4}}$\n这些值满足所有三个方程以及正定性条件。因此，$\\mathbf{U}$ 的矩阵为：\n$$\n[U] = \\frac{1}{\\sqrt{\\gamma^2+4}} \\begin{pmatrix} 2 & \\gamma & 0 \\\\ \\gamma & \\gamma^2+2 & 0 \\\\ 0 & 0 & \\sqrt{\\gamma^2+4} \\end{pmatrix}\n$$\n为了求旋转张量 $\\mathbf{R}$，我们计算 $\\mathbf{R}=\\mathbf{F}\\mathbf{U}^{-1}$。首先，我们求 $\\mathbf{U}^{-1}$。$[U]$ 的左上 $2\\times2$ 子块的行列式为 $1$。其逆矩阵通过标准公式求得：\n$$\n[U^{-1}] = \\frac{1}{\\sqrt{\\gamma^2+4}} \\begin{pmatrix} \\gamma^2+2 & -\\gamma & 0 \\\\ -\\gamma & 2 & 0 \\\\ 0 & 0 & \\sqrt{\\gamma^2+4} \\end{pmatrix}\n$$\n现在我们计算 $[R]=[F][U^{-1}]$：\n$$\n[R] = \\begin{pmatrix} 1 & \\gamma & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\frac{1}{\\sqrt{\\gamma^2+4}} \\begin{pmatrix} \\gamma^2+2 & -\\gamma & 0 \\\\ -\\gamma & 2 & 0 \\\\ 0 & 0 & \\sqrt{\\gamma^2+4} \\end{pmatrix}\n$$\n$$\n[R] = \\frac{1}{\\sqrt{\\gamma^2+4}} \\begin{pmatrix} (1)(\\gamma^2+2)+(\\gamma)(-\\gamma) & (1)(-\\gamma)+(\\gamma)(2) & 0 \\\\ (0)(\\gamma^2+2)+(1)(-\\gamma) & (0)(-\\gamma)+(1)(2) & 0 \\\\ 0 & 0 & \\sqrt{\\gamma^2+4} \\end{pmatrix}\n$$\n$$\n[R] = \\frac{1}{\\sqrt{\\gamma^2+4}} \\begin{pmatrix} 2 & \\gamma & 0 \\\\ -\\gamma & 2 & 0 \\\\ 0 & 0 & \\sqrt{\\gamma^2+4} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{\\sqrt{\\gamma^2+4}} & \\frac{\\gamma}{\\sqrt{\\gamma^2+4}} & 0 \\\\ \\frac{-\\gamma}{\\sqrt{\\gamma^2+4}} & \\frac{2}{\\sqrt{\\gamma^2+4}} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n我们验证 $\\mathbf{R}$ 是一个旋转张量。\n$$\n[R^{\\mathsf{T}}R] = \\begin{pmatrix} \\frac{2}{k} & \\frac{-\\gamma}{k} & 0 \\\\ \\frac{\\gamma}{k} & \\frac{2}{k} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{2}{k} & \\frac{\\gamma}{k} & 0 \\\\ \\frac{-\\gamma}{k} & \\frac{2}{k} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\frac{1}{k^2}\\begin{pmatrix} 4+\\gamma^2 & 2\\gamma-2\\gamma & 0 \\\\ 2\\gamma-2\\gamma & \\gamma^2+4 & 0 \\\\ 0 & 0 & k^2 \\end{pmatrix}\n$$\n其中 $k=\\sqrt{\\gamma^2+4}$。由于 $k^2=\\gamma^2+4$，此式可简化为单位矩阵 $\\mathbf{I}$。\n其行列式为 $\\det[R] = (\\frac{2}{k})^2 - (\\frac{\\gamma}{k})(\\frac{-\\gamma}{k}) = \\frac{4+\\gamma^2}{k^2}=1$。因此 $\\mathbf{R} \\in \\mathrm{SO}(3)$。\n\n最后，我们将 $\\mathbf{R}$ 参数化为 $\\mathbf{e}_1$-$\\mathbf{e}_2$ 平面内的一个平面旋转。一个向量绕原点逆时针旋转一个带符号角度 $\\theta$ 的标准旋转矩阵为：\n$$\n[Q(\\theta)] = \\begin{pmatrix} \\cos\\theta & -\\sin\\theta & 0 \\\\ \\sin\\theta & \\cos\\theta & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n将 $[R]$ 与 $[Q(\\theta)]$ 进行比较，我们识别出以下分量：\n$$\n\\cos\\theta = \\frac{2}{\\sqrt{\\gamma^2+4}}\n$$\n$$\n-\\sin\\theta = \\frac{\\gamma}{\\sqrt{\\gamma^2+4}} \\quad \\implies \\quad \\sin\\theta = -\\frac{\\gamma}{\\sqrt{\\gamma^2+4}}\n$$\n角度 $\\theta$ 的正切是这些分量的比值：\n$$\n\\tan\\theta = \\frac{\\sin\\theta}{\\cos\\theta} = \\frac{-\\gamma/\\sqrt{\\gamma^2+4}}{2/\\sqrt{\\gamma^2+4}} = -\\frac{\\gamma}{2}\n$$\n因此，角度 $\\theta(\\gamma)$ 由反正切函数给出。标准 $\\arctan$ 函数的值域 $(-\\frac{\\pi}{2}, \\frac{\\pi}{2})$ 在此是合适的，因为对于所有的 $\\gamma$，都有 $\\cos\\theta > 0$。\n$$\n\\theta(\\gamma) = \\arctan\\left(-\\frac{\\gamma}{2}\\right)\n$$\n此表达式给出了所需的旋转的带符号角度，作为剪切参数 $\\gamma$ 的函数。", "answer": "$$\\boxed{\\arctan\\left(-\\frac{\\gamma}{2}\\right)}$$", "id": "2886430"}, {"introduction": "尽管极分解能将变形唯一地分解为一个拉伸和一个旋转，但理解这些操作的先后顺序通常会产生不同的结果，这一点至关重要。[@problem_id:2886415] 这个思想实验通过一个先纯拉伸后刚体旋转的变形来探究这种非交换性。通过推导其极分解并量化非交换性的程度，你将更深刻地理解材料方向与变形之间的相互作用。", "problem": "考虑一个均匀变形映射，它由一个有限拉伸后跟一个有限刚体旋转定义。变形梯度由乘积 $\\mathbf{F} = \\mathbf{Q}\\,\\mathbf{D}$ 给出，其中：\n- $\\mathbf{Q} \\in \\mathbb{R}^{3 \\times 3}$ 是一个正常正交张量，满足 $\\mathbf{Q}^{\\mathsf{T}}\\mathbf{Q} = \\mathbf{I}$ 且 $\\det \\mathbf{Q} = 1$，表示绕固定单位向量 $\\mathbf{e}_3$ 的一个右手旋转，旋转角度为 $\\theta$（以弧度为单位），\n- $\\mathbf{D} = \\operatorname{diag}(\\lambda_1,\\lambda_2,\\lambda_3)$ 是一个对称正定（SPD）拉伸张量，其主拉伸为 $\\lambda_i > 0$。\n\n您可以假定标准正交基 $\\{\\mathbf{e}_1,\\mathbf{e}_2,\\mathbf{e}_3\\}$ 和显式旋转\n$$\n\\mathbf{Q} = \\begin{pmatrix}\n\\cos \\theta & -\\sin \\theta & 0 \\\\\n\\sin \\theta & \\phantom{-}\\cos \\theta & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}.\n$$\n\n任务：\n1. 从右 Cauchy–Green 张量 $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$ 和右拉伸张量 $\\mathbf{U}$（作为 $\\mathbf{C}$ 的唯一 SPD 平方根）的定义出发，提取右极分解中的右拉伸 $\\mathbf{U}$ 和旋转 $\\mathbf{R}$，其中 $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$ 且 $\\mathbf{R}$ 是正常正交的。\n2. 仅使用第一性原理和上述定义，分析旋转和拉伸通常是否可交换。为量化此 $\\mathbf{Q}$ 和 $\\mathbf{D}$ 对可交换性的偏离，定义标量度量\n$$\n\\Gamma \\equiv \\|\\,[\\mathbf{Q},\\mathbf{U}]\\,\\|_F^{2} = \\|\\mathbf{Q}\\mathbf{U} - \\mathbf{U}\\mathbf{Q}\\|_F^{2},\n$$\n其中 $\\|\\cdot\\|_F$表示 Frobenius 范数。将 $\\Gamma$ 显式地推导为关于 $\\lambda_1,\\lambda_2,\\lambda_3$ 和 $\\theta$ 的封闭形式函数。\n\n您最终提交的答案必须是 $\\Gamma$ 的单一封闭形式解析表达式。不包含单位。无需进行数值计算。", "solution": "**任务1：确定右极分解**\n\n变形梯度 $\\mathbf{F}$ 的右极分解由 $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$ 给出，其中 $\\mathbf{R}$ 是一个正常正交张量，$\\mathbf{U}$ 是一个对称正定（SPD）张量，即右拉伸张量。\n\n右拉伸张量 $\\mathbf{U}$ 由右 Cauchy-Green 张量 $\\mathbf{C}$ 通过关系式 $\\mathbf{U} = \\sqrt{\\mathbf{C}}$ 确定。张量 $\\mathbf{C}$ 定义为 $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$。\n\n我们已知 $\\mathbf{F} = \\mathbf{Q}\\mathbf{D}$。我们通过代入此表达式来计算 $\\mathbf{C}$：\n$$\n\\mathbf{C} = (\\mathbf{Q}\\mathbf{D})^{\\mathsf{T}}(\\mathbf{Q}\\mathbf{D})\n$$\n使用矩阵乘积的转置性质 $(\\mathbf{A}\\mathbf{B})^{\\mathsf{T}} = \\mathbf{B}^{\\mathsf{T}}\\mathbf{A}^{\\mathsf{T}}$，我们有：\n$$\n\\mathbf{C} = (\\mathbf{D}^{\\mathsf{T}}\\mathbf{Q}^{\\mathsf{T}})(\\mathbf{Q}\\mathbf{D})\n$$\n根据矩阵乘法的结合律：\n$$\n\\mathbf{C} = \\mathbf{D}^{\\mathsf{T}}(\\mathbf{Q}^{\\mathsf{T}}\\mathbf{Q})\\mathbf{D}\n$$\n问题指出 $\\mathbf{Q}$ 是一个正交张量，因此 $\\mathbf{Q}^{\\mathsf{T}}\\mathbf{Q} = \\mathbf{I}$，其中 $\\mathbf{I}$ 是单位张量。$\\mathbf{C}$ 的表达式简化为：\n$$\n\\mathbf{C} = \\mathbf{D}^{\\mathsf{T}}\\mathbf{I}\\mathbf{D} = \\mathbf{D}^{\\mathsf{T}}\\mathbf{D}\n$$\n此外，$\\mathbf{D}$ 被指定为对称张量，所以 $\\mathbf{D}^{\\mathsf{T}} = \\mathbf{D}$。这导致：\n$$\n\\mathbf{C} = \\mathbf{D}\\mathbf{D} = \\mathbf{D}^2\n$$\n右拉伸张量 $\\mathbf{U}$ 是 $\\mathbf{C}$ 的唯一 SPD 平方根。因此：\n$$\n\\mathbf{U} = \\sqrt{\\mathbf{C}} = \\sqrt{\\mathbf{D}^2}\n$$\n由于 $\\mathbf{D}$ 是一个具有正主拉伸 $\\lambda_i > 0$ 的 SPD 张量，其唯一的 SPD 平方根就是 $\\mathbf{D}$ 本身。因此：\n$$\n\\mathbf{U} = \\mathbf{D} = \\begin{pmatrix} \\lambda_1 & 0 & 0 \\\\ 0 & \\lambda_2 & 0 \\\\ 0 & 0 & \\lambda_3 \\end{pmatrix}\n$$\n现在，我们从极分解公式 $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$ 中求出旋转张量 $\\mathbf{R}$。\n$$\n\\mathbf{R} = \\mathbf{F}\\mathbf{U}^{-1}\n$$\n代入给定的 $\\mathbf{F} = \\mathbf{Q}\\mathbf{D}$ 和推导出的 $\\mathbf{U} = \\mathbf{D}$：\n$$\n\\mathbf{R} = (\\mathbf{Q}\\mathbf{D})\\mathbf{D}^{-1}\n$$\n由于 $\\lambda_i > 0$，$\\mathbf{D}$ 是可逆的。根据结合律：\n$$\n\\mathbf{R} = \\mathbf{Q}(\\mathbf{D}\\mathbf{D}^{-1}) = \\mathbf{Q}\\mathbf{I} = \\mathbf{Q}\n$$\n因此，对于指定的变形，右极分解由 $\\mathbf{R} = \\mathbf{Q}$ 和 $\\mathbf{U} = \\mathbf{D}$ 给出。\n\n**任务2：非交换性度量 $\\Gamma$ 的推导**\n\n我们必须推导 $\\Gamma \\equiv \\|\\mathbf{Q}\\mathbf{U} - \\mathbf{U}\\mathbf{Q}\\|_F^{2}$ 的表达式。根据任务1的结果，我们有 $\\mathbf{U} = \\mathbf{D}$。因此，我们必须计算 $\\mathbf{Q}$ 和 $\\mathbf{D}$ 的对易子，记为 $[\\mathbf{Q}, \\mathbf{D}] = \\mathbf{Q}\\mathbf{D} - \\mathbf{D}\\mathbf{Q}$。\n\n让我们记 $c \\equiv \\cos\\theta$ 和 $s \\equiv \\sin\\theta$。矩阵为：\n$$\n\\mathbf{Q} = \\begin{pmatrix} c & -s & 0 \\\\ s & c & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}, \\quad \\mathbf{D} = \\begin{pmatrix} \\lambda_1 & 0 & 0 \\\\ 0 & \\lambda_2 & 0 \\\\ 0 & 0 & \\lambda_3 \\end{pmatrix}\n$$\n首先，我们计算乘积 $\\mathbf{Q}\\mathbf{D}$：\n$$\n\\mathbf{Q}\\mathbf{D} = \\begin{pmatrix} c & -s & 0 \\\\ s & c & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} \\lambda_1 & 0 & 0 \\\\ 0 & \\lambda_2 & 0 \\\\ 0 & 0 & \\lambda_3 \\end{pmatrix} = \\begin{pmatrix} c\\lambda_1 & -s\\lambda_2 & 0 \\\\ s\\lambda_1 & c\\lambda_2 & 0 \\\\ 0 & 0 & \\lambda_3 \\end{pmatrix}\n$$\n接下来，我们计算乘积 $\\mathbf{D}\\mathbf{Q}$：\n$$\n\\mathbf{D}\\mathbf{Q} = \\begin{pmatrix} \\lambda_1 & 0 & 0 \\\\ 0 & \\lambda_2 & 0 \\\\ 0 & 0 & \\lambda_3 \\end{pmatrix} \\begin{pmatrix} c & -s & 0 \\\\ s & c & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} c\\lambda_1 & -s\\lambda_1 & 0 \\\\ s\\lambda_2 & c\\lambda_2 & 0 \\\\ 0 & 0 & \\lambda_3 \\end{pmatrix}\n$$\n对易子矩阵是这两个乘积的差：\n$$\n[\\mathbf{Q},\\mathbf{D}] = \\mathbf{Q}\\mathbf{D} - \\mathbf{D}\\mathbf{Q} = \\begin{pmatrix} c\\lambda_1 - c\\lambda_1 & -s\\lambda_2 - (-s\\lambda_1) & 0 - 0 \\\\ s\\lambda_1 - s\\lambda_2 & c\\lambda_2 - c\\lambda_2 & 0 - 0 \\\\ 0 - 0 & 0 - 0 & \\lambda_3 - \\lambda_3 \\end{pmatrix}\n$$\n$$\n[\\mathbf{Q},\\mathbf{D}] = \\begin{pmatrix} 0 & s(\\lambda_1 - \\lambda_2) & 0 \\\\ s(\\lambda_1 - \\lambda_2) & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n量 $\\Gamma$ 是此对易子矩阵的 Frobenius 范数的平方。一个矩阵 $\\mathbf{A}$ 的 Frobenius 范数的平方 $\\|\\mathbf{A}\\|_F^2$ 是其所有元素平方的和。\n$$\n\\Gamma = \\|\\,[\\mathbf{Q},\\mathbf{D}]\\,\\|_F^{2} = (0)^{2} + (s(\\lambda_1 - \\lambda_2))^{2} + (0)^{2} + (s(\\lambda_1 - \\lambda_2))^{2} + (0)^{2} + (0)^{2} + (0)^{2} + (0)^{2} + (0)^{2}\n$$\n$$\n\\Gamma = s^2(\\lambda_1 - \\lambda_2)^2 + s^2(\\lambda_1 - \\lambda_2)^2 = 2s^2(\\lambda_1 - \\lambda_2)^2\n$$\n将 $s = \\sin\\theta$ 代回表达式，得到 $\\Gamma$ 的最终封闭形式结果：\n$$\n\\Gamma = 2(\\sin\\theta)^{2}(\\lambda_1 - \\lambda_2)^{2}\n$$\n当且仅当 $\\Gamma = 0$ 时，$\\mathbf{Q}$ 和 $\\mathbf{U}=\\mathbf{D}$ 满足可交换性。这种情况发生在 $\\sin\\theta = 0$（即旋转角 $\\theta$ 是 $\\pi$ 的整数倍，对应于平面内无旋转或平凡旋转）或 $\\lambda_1 = \\lambda_2$（即拉伸在旋转平面内是各向同性的）时。这证实了物理直觉。", "answer": "$$\n\\boxed{2(\\sin(\\theta))^{2}(\\lambda_1 - \\lambda_2)^{2}}\n$$", "id": "2886415"}, {"introduction": "从解析示例到实际应用，我们需要稳健的数值方法。奇异值分解（SVD）不仅为计算极分解提供了一个优雅而稳定的算法，更揭示了其深刻的几何意义。[@problem_id:2886399] 这项练习将抽象理论与计算实践联系起来，证明了极分解中的旋转部分是在所有旋转中与原始变形梯度“最接近”的一个，这是计算力学中的一个基石性原理。", "problem": "给定一个表示材料力学中有限变形梯度的方阵。设变形梯度为一个实矩阵 $\\mathbf{F} \\in \\mathbb{R}^{n \\times n}$，且 $\\det(\\mathbf{F}) > 0$。右极分解旨在求得一个真旋转矩阵 $\\mathbf{R} \\in \\mathrm{SO}(n)$ 和一个对称正定拉伸矩阵 $\\mathbf{U} \\in \\mathbb{R}^{n \\times n}$，使得 $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$。本问题中所有角度均须以弧度为单位进行解释。\n\n您的任务如下：\n\n1) 仅从奇异值分解、正交矩阵、弗罗贝尼乌斯范数和对称正定矩阵的基本定义出发，推导出一个使用奇异值分解计算 $\\mathbf{F}$ 的右极分解的算法。该算法必须对任何满足 $\\det(\\mathbf{F}) > 0$ 的 $\\mathbf{F}$ 都有效，并且必须返回一个真旋转矩阵 $\\mathbf{R} \\in \\mathrm{SO}(n)$ 和一个对称正定的 $\\mathbf{U}$。\n\n2) 证明您的算法所产生的旋转矩阵 $\\mathbf{R}$ 是以下问题的唯一最小化子\n$$\n\\min_{\\mathbf{Q} \\in \\mathrm{SO}(n)} \\|\\mathbf{F} - \\mathbf{Q}\\|_F,\n$$\n其中 $\\|\\cdot\\|_F$ 表示弗罗贝尼乌斯范数，并证明相关的 $\\mathbf{U} = \\mathbf{R}^\\top \\mathbf{F}$ 是对称正定的。您的证明必须基于基本原理，从弗罗贝尼乌斯范数的酉不变性和标准谱不等式出发，不得预先假设目标结果。\n\n3) 实现一个程序，该程序能够：\n- 计算每个给定测试矩阵 $\\mathbf{F}$ 的奇异值分解。\n- 使用您推导的算法为每种情况计算 $\\mathbf{R}$ 和 $\\mathbf{U}$。\n- 对每个测试用例，计算一个单一的实值诊断量，用以定量验证您的推导和证明所蕴含的核心属性之一。\n\n使用以下变形梯度测试集：\n- 情况 1 (二维对角拉伸): $\\mathbf{F}_1 = \\begin{bmatrix} 2.0 & 0.0 \\\\ 0.0 & 0.5 \\end{bmatrix}$。输出 $\\|\\mathbf{F}_1 - \\mathbf{R}_1\\|_F$ 与值 $\\sqrt{\\sum_{i=1}^2 (\\sigma_i - 1)^2}$ 之间的绝对差，其中 $\\sigma_i$ 是 $\\mathbf{F}_1$ 的奇异值。\n- 情况 2 (二维旋转拉伸): 设 $\\theta = 0.4$ (弧度)，$\\mathbf{R}_{\\mathrm{true}} = \\begin{bmatrix} \\cos\\theta & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta \\end{bmatrix}$，并且 $\\mathbf{U}_{\\mathrm{true}} = \\operatorname{diag}(1.2, 0.8)$。定义 $\\mathbf{F}_2 = \\mathbf{R}_{\\mathrm{true}} \\mathbf{U}_{\\mathrm{true}}$。输出 $\\|\\mathbf{R}_2 - \\mathbf{R}_{\\mathrm{true}}\\|_F$。\n- 情况 3 (具有非平凡本征基的三维一般对称拉伸): 设 $\\phi = 0.6$ (弧度)，$\\mathbf{Q} = \\begin{bmatrix} \\cos\\phi & -\\sin\\phi & 0 \\\\ \\sin\\phi & \\cos\\phi & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}$，$\\mathbf{D} = \\operatorname{diag}(1.5, 0.9, 1.1)$，以及 $\\mathbf{U}_{\\mathrm{true}} = \\mathbf{Q}\\mathbf{D}\\mathbf{Q}^\\top$。设 $\\alpha = -0.7$ (弧度) 且 $\\mathbf{R}_{\\mathrm{true}}^{(x)} = \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & \\cos\\alpha & -\\sin\\alpha \\\\ 0 & \\sin\\alpha & \\cos\\alpha \\end{bmatrix}$。定义 $\\mathbf{F}_3 = \\mathbf{R}_{\\mathrm{true}}^{(x)} \\mathbf{U}_{\\mathrm{true}}$。输出 $\\|\\mathbf{U}_3 - \\mathbf{U}_{\\mathrm{true}}\\|_F$。\n- 情况 4 (二维病态拉伸): 设 $\\beta = 1.1$ (弧度)，$\\mathbf{R}_{\\beta} = \\begin{bmatrix} \\cos\\beta & -\\sin\\beta \\\\ \\sin\\beta & \\cos\\beta \\end{bmatrix}$，并且 $\\mathbf{U}_{\\mathrm{true}} = \\operatorname{diag}(10^{-6}, 3.0)$。定义 $\\mathbf{F}_4 = \\mathbf{R}_{\\beta} \\mathbf{U}_{\\mathrm{true}}$。输出 $\\|\\mathbf{F}_4 - \\mathbf{R}_4\\|_F$ 与值 $\\sqrt{\\sum_{i=1}^2 (\\sigma_i - 1)^2}$ 之间的绝对差。\n\n所有计算都必须假定角度以弧度为单位。您的程序必须将四个诊断量汇总到单行输出中，结果以逗号分隔并用方括号括起，顺序为情况 1 至情况 4。每个诊断量都必须是一个实数 (浮点数)。可以将输出四舍五入到固定的小数位数，但所有四个输出必须保持一致。\n\n注：\n- 上述表达式中的奇异值指的是每种情况下相应 $\\mathbf{F}$ 的奇异值。\n- 确保所有使用的 $\\mathbf{F}_k$ 都具有严格为正的行列式，以便极分解中存在真旋转。", "solution": "### 1. 右极分解的算法推导\n\n目标是找到一个真旋转矩阵 $\\mathbf{R} \\in \\mathrm{SO}(n)$ (即 $\\mathbf{R}^\\top\\mathbf{R}=\\mathbf{I}$ 且 $\\det(\\mathbf{R})=+1$) 和一个对称正定拉伸张量 $\\mathbf{U}$，使得对于给定的变形梯度 $\\mathbf{F}$（满足 $\\det(\\mathbf{F}) > 0$），右极分解成立：\n$$ \\mathbf{F} = \\mathbf{R}\\mathbf{U} $$\n我们从 $\\mathbf{F}$ 的奇异值分解 (Singular Value Decomposition, SVD) 出发，对于任何实矩阵 $\\mathbf{F} \\in \\mathbb{R}^{n \\times n}$，其定义为：\n$$ \\mathbf{F} = \\mathbf{V} \\mathbf{\\Sigma} \\mathbf{W}^\\top $$\n此处，$\\mathbf{V}$ 和 $\\mathbf{W}$ 是正交矩阵（$\\mathbf{V}^\\top\\mathbf{V} = \\mathbf{I}$，$\\mathbf{W}^\\top\\mathbf{W} = \\mathbf{I}$），$\\mathbf{\\Sigma}$ 是一个对角矩阵，其对角元为 $\\mathbf{F}$ 的奇异值 $\\sigma_i \\ge 0$。由于问题陈述 $\\det(\\mathbf{F}) > 0$，$\\mathbf{F}$ 是可逆的，这意味着所有奇异值都严格为正，即 $\\sigma_i > 0$。\n\n我们试图用 $\\mathbf{V}$、$\\mathbf{\\Sigma}$ 和 $\\mathbf{W}$ 来表示 $\\mathbf{R}$ 和 $\\mathbf{U}$。一个自然的想法是将 SVD 中的正交部分和对称部分组合起来。我们提出以下 $\\mathbf{R}$ 和 $\\mathbf{U}$ 的候选形式：\n$$ \\mathbf{R} = \\mathbf{V}\\mathbf{W}^\\top $$\n$$ \\mathbf{U} = \\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top $$\n我们必须验证这些选择是否满足所需属性。\n\n首先，检查分解是否有效：\n$$ \\mathbf{R}\\mathbf{U} = (\\mathbf{V}\\mathbf{W}^\\top)(\\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top) = \\mathbf{V}(\\mathbf{W}^\\top\\mathbf{W})\\mathbf{\\Sigma}\\mathbf{W}^\\top = \\mathbf{V}\\mathbf{I}\\mathbf{\\Sigma}\\mathbf{W}^\\top = \\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top = \\mathbf{F} $$\n该分解是正确的。\n\n其次，验证 $\\mathbf{U}$ 的属性。\n对称性：\n$$ \\mathbf{U}^\\top = (\\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top)^\\top = (\\mathbf{W}^\\top)^\\top \\mathbf{\\Sigma}^\\top \\mathbf{W}^\\top = \\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top = \\mathbf{U} $$\n因为 $\\mathbf{\\Sigma}$ 是对角矩阵，因此是对称的。所以 $\\mathbf{U}$ 是对称的。\n\n正定性：对于任意非零向量 $\\mathbf{x} \\in \\mathbb{R}^n$，我们考察二次型 $\\mathbf{x}^\\top\\mathbf{U}\\mathbf{x}$：\n$$ \\mathbf{x}^\\top\\mathbf{U}\\mathbf{x} = \\mathbf{x}^\\top (\\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top) \\mathbf{x} = (\\mathbf{W}^\\top\\mathbf{x})^\\top \\mathbf{\\Sigma} (\\mathbf{W}^\\top\\mathbf{x}) $$\n令 $\\mathbf{y} = \\mathbf{W}^\\top\\mathbf{x}$。由于 $\\mathbf{W}$ 是正交的且 $\\mathbf{x} \\neq \\mathbf{0}$，因此 $\\mathbf{y} \\neq \\mathbf{0}$。表达式变为：\n$$ \\mathbf{y}^\\top \\mathbf{\\Sigma} \\mathbf{y} = \\sum_{i=1}^n \\sigma_i y_i^2 $$\n如前所述，对所有 $i$ 都有 $\\sigma_i > 0$。由于 $\\mathbf{y} \\neq \\mathbf{0}$，至少有一个 $y_i \\neq 0$。因此，$\\sum_{i=1}^n \\sigma_i y_i^2 > 0$。这证实了 $\\mathbf{U}$ 是正定的。\n\n第三，验证 $\\mathbf{R}$ 的属性。\n正交性：\n$$ \\mathbf{R}^\\top\\mathbf{R} = (\\mathbf{V}\\mathbf{W}^\\top)^\\top(\\mathbf{V}\\mathbf{W}^\\top) = (\\mathbf{W}\\mathbf{V}^\\top)(\\mathbf{V}\\mathbf{W}^\\top) = \\mathbf{W}(\\mathbf{V}^\\top\\mathbf{V})\\mathbf{W}^\\top = \\mathbf{W}\\mathbf{I}\\mathbf{W}^\\top = \\mathbf{W}\\mathbf{W}^\\top = \\mathbf{I} $$\n$\\mathbf{R}$ 是正交的。\n\n真旋转：我们必须确保 $\\det(\\mathbf{R}) = +1$。\n$$ \\det(\\mathbf{R}) = \\det(\\mathbf{V}\\mathbf{W}^\\top) = \\det(\\mathbf{V})\\det(\\mathbf{W}^\\top) = \\det(\\mathbf{V})\\det(\\mathbf{W}) $$\n从 SVD 可知，$\\det(\\mathbf{F}) = \\det(\\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top) = \\det(\\mathbf{V})\\det(\\mathbf{\\Sigma})\\det(\\mathbf{W}) = (\\det(\\mathbf{V})\\det(\\mathbf{W})) \\prod_{i=1}^n \\sigma_i$。\n给定 $\\det(\\mathbf{F}) > 0$ 且已知 $\\prod \\sigma_i > 0$，必然有 $\\det(\\mathbf{V})\\det(\\mathbf{W}) > 0$。\n正交矩阵的行列式只能是 $+1$ 或 $-1$。因此，$\\det(\\mathbf{V})$ 和 $\\det(\\mathbf{W})$ 必须同号。它们的乘积必然是 $+1$。\n$$ \\det(\\mathbf{R}) = \\det(\\mathbf{V})\\det(\\mathbf{W}) = +1 $$\n因此，$\\mathbf{R}$ 是一个真旋转矩阵，即 $\\mathbf{R} \\in \\mathrm{SO}(n)$。\n\n从这些第一性原理推导出的算法如下：\n1.  对于给定的矩阵 $\\mathbf{F}$（满足 $\\det(\\mathbf{F}) > 0$），计算其 SVD：$\\mathbf{F} = \\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top$。\n2.  旋转矩阵是 $\\mathbf{R} = \\mathbf{V}\\mathbf{W}^\\top$。\n3.  拉伸张量是 $\\mathbf{U} = \\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top$。或者，也可以通过 $\\mathbf{U} = \\mathbf{R}^\\top\\mathbf{F}$ 计算。\n\n### 2. 最小性和唯一性的证明\n\n我们必须证明 $\\mathbf{R} = \\mathbf{V}\\mathbf{W}^\\top$ 是问题 $\\min_{\\mathbf{Q} \\in \\mathrm{SO}(n)} \\|\\mathbf{F} - \\mathbf{Q}\\|_F$ 的唯一最小化子。\n\n弗罗贝尼乌斯范数的平方为 $\\|\\mathbf{A}\\|_F^2 = \\operatorname{Tr}(\\mathbf{A}^\\top\\mathbf{A})$。我们展开目标函数：\n$$ \\|\\mathbf{F} - \\mathbf{Q}\\|_F^2 = \\operatorname{Tr}((\\mathbf{F} - \\mathbf{Q})^\\top(\\mathbf{F} - \\mathbf{Q})) = \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{F} - \\mathbf{F}^\\top\\mathbf{Q} - \\mathbf{Q}^\\top\\mathbf{F} + \\mathbf{Q}^\\top\\mathbf{Q}) $$\n由于 $\\mathbf{Q} \\in \\mathrm{SO}(n)$，$\\mathbf{Q}$ 是正交的，所以 $\\mathbf{Q}^\\top\\mathbf{Q} = \\mathbf{I}$ 且 $\\operatorname{Tr}(\\mathbf{I}) = n$。并且，$\\operatorname{Tr}(\\mathbf{Q}^\\top\\mathbf{F}) = \\operatorname{Tr}((\\mathbf{F}^\\top\\mathbf{Q})^\\top) = \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{Q})$。\n$$ \\|\\mathbf{F} - \\mathbf{Q}\\|_F^2 = \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{F}) + n - 2\\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{Q}) = \\|\\mathbf{F}\\|_F^2 + n - 2\\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{Q}) $$\n最小化此表达式等价于最大化 $\\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{Q})$ 这一项。\n\n将 $\\mathbf{F}$ 的 SVD $\\mathbf{F} = \\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top$ 代入迹中：\n$$ \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{Q}) = \\operatorname{Tr}((\\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top)^\\top \\mathbf{Q}) = \\operatorname{Tr}(\\mathbf{W}\\mathbf{\\Sigma}\\mathbf{V}^\\top \\mathbf{Q}) $$\n利用迹的循环性质 $\\operatorname{Tr}(\\mathbf{ABC}) = \\operatorname{Tr}(\\mathbf{CAB})$：\n$$ \\operatorname{Tr}(\\mathbf{W}\\mathbf{\\Sigma}\\mathbf{V}^\\top \\mathbf{Q}) = \\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{V}^\\top \\mathbf{Q}\\mathbf{W}) $$\n令 $\\mathbf{Z} = \\mathbf{V}^\\top\\mathbf{Q}\\mathbf{W}$。由于 $\\mathbf{V}$、$\\mathbf{Q}$ 和 $\\mathbf{W}$ 都是正交的，它们的乘积 $\\mathbf{Z}$ 也是正交的。我们希望在所有可由 $\\mathbf{Q} \\in \\mathrm{SO}(n)$ 构成的正交矩阵 $\\mathbf{Z}$ 上最大化 $\\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z})$。\n$$ \\det(\\mathbf{Z}) = \\det(\\mathbf{V}^\\top)\\det(\\mathbf{Q})\\det(\\mathbf{W}) = \\det(\\mathbf{V})^{-1} (+1) \\det(\\mathbf{W}) = \\det(\\mathbf{V})\\det(\\mathbf{W}) = +1 $$\n最后一步是因为对于行列式为 $\\pm 1$ 的正交矩阵有 $\\det(\\mathbf{V}) = \\det(\\mathbf{V}^\\top)$。\n因此，我们必须在所有 $\\mathbf{Z} \\in \\mathrm{SO}(n)$ 上最大化 $\\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z})$。\n\n迹为 $\\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z}) = \\sum_{i=1}^n \\sigma_i Z_{ii}$。根据 von Neumann 迹不等式，$\\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z}) \\le \\sum_i \\sigma_i(\\mathbf{\\Sigma})\\sigma_i(\\mathbf{Z})$。$\\mathbf{\\Sigma}$ 的奇异值是 $\\sigma_i$，而正交矩阵 $\\mathbf{Z}$ 的奇异值全部为 $1$。\n$$ \\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z}) \\le \\sum_{i=1}^n \\sigma_i $$\n当且仅当 $\\mathbf{\\Sigma}$ 和 $\\mathbf{Z}$ 可由同一对正交矩阵同时对角化时，等号成立。由于 $\\mathbf{\\Sigma}$ 已经是-对角的，此条件意味着 $\\mathbf{Z}$ 也必须是对角矩阵。一个正交对角矩阵的对角元必须是 $\\pm 1$。\n为了在 $\\sigma_i > 0$ 和 $Z_{ii} = \\pm 1$ 的条件下最大化 $\\sum_i \\sigma_i Z_{ii}$，我们必须为所有 $i$ 选择 $Z_{ii}=+1$。这导出了唯一的选择 $\\mathbf{Z} = \\mathbf{I}$。\n单位矩阵 $\\mathbf{I}$ 属于 $\\mathrm{SO}(n)$，因为 $\\det(\\mathbf{I})=+1$。\n因此，$\\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z})$ 的最大值在且仅在 $\\mathbf{Z} = \\mathbf{I}$ 时取到。\n\n设 $\\mathbf{Z} = \\mathbf{I}$ 给出最优的 $\\mathbf{Q}$：\n$$ \\mathbf{V}^\\top\\mathbf{Q}\\mathbf{W} = \\mathbf{I} \\implies \\mathbf{Q} = \\mathbf{V}\\mathbf{I}\\mathbf{W}^\\top = \\mathbf{V}\\mathbf{W}^\\top $$\n这恰好是前一节中推导出的矩阵 $\\mathbf{R}$。这证明了 $\\mathbf{R} = \\mathbf{V}\\mathbf{W}^\\top$ 是 $\\|\\mathbf{F} - \\mathbf{Q}\\|_F$ 在 $\\mathbf{Q} \\in \\mathrm{SO}(n)$ 上的唯一最小化子。\n\n关于相关拉伸张量 $\\mathbf{U} = \\mathbf{R}^\\top\\mathbf{F}$ 是对称正定的证明已在算法推导部分给出。\n\n### 3. 实现与验证\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the right polar decomposition for several deformation gradients and\n    calculates specific diagnostic values to verify the theoretical results.\n    \"\"\"\n\n    # --- Test Case 1: 2D diagonal stretch ---\n    F1 = np.array([[2.0, 0.0], [0.0, 0.5]])\n\n    # --- Test Case 2: 2D rotated stretch ---\n    theta = 0.4\n    R_true2 = np.array([[np.cos(theta), -np.sin(theta)],\n                        [np.sin(theta), np.cos(theta)]])\n    U_true2 = np.diag([1.2, 0.8])\n    F2 = R_true2 @ U_true2\n\n    # --- Test Case 3: 3D general symmetric stretch ---\n    phi = 0.6\n    Q3 = np.array([[np.cos(phi), -np.sin(phi), 0.0],\n                   [np.sin(phi), np.cos(phi), 0.0],\n                   [0.0, 0.0, 1.0]])\n    D3 = np.diag([1.5, 0.9, 1.1])\n    U_true3 = Q3 @ D3 @ Q3.T\n    \n    alpha = -0.7\n    R_true3_x = np.array([[1.0, 0.0, 0.0],\n                          [0.0, np.cos(alpha), -np.sin(alpha)],\n                          [0.0, np.sin(alpha), np.cos(alpha)]])\n    F3 = R_true3_x @ U_true3\n\n    # --- Test Case 4: 2D ill-conditioned stretch ---\n    beta = 1.1\n    R_beta4 = np.array([[np.cos(beta), -np.sin(beta)],\n                        [np.sin(beta), np.cos(beta)]])\n    U_true4 = np.diag([1e-6, 3.0])\n    F4 = R_beta4 @ U_true4\n\n    test_cases = [\n        {'F': F1, 'type': 'diag_check'},\n        {'F': F2, 'type': 'R_check', 'R_true': R_true2},\n        {'F': F3, 'type': 'U_check', 'U_true': U_true3},\n        {'F': F4, 'type': 'diag_check'}\n    ]\n\n    results = []\n\n    for case in test_cases:\n        F = case['F']\n        \n        # Core algorithm: Right Polar Decomposition using SVD\n        # F = V @ Sigma @ Wt\n        V, S_vec, Wt = np.linalg.svd(F)\n        \n        # R = V @ Wt is the rotation tensor for the right polar decomposition F = R U\n        R = V @ Wt\n\n        if case['type'] == 'diag_check':\n            # Diagnostic: | ||F - R||_F - sqrt(sum((sigma_i - 1)^2)) |\n            norm_F_minus_R = np.linalg.norm(F - R, 'fro')\n            norm_s_minus_1 = np.sqrt(np.sum((S_vec - 1)**2))\n            diagnostic = np.abs(norm_F_minus_R - norm_s_minus_1)\n            results.append(diagnostic)\n            \n        elif case['type'] == 'R_check':\n            # Diagnostic: ||R - R_true||_F\n            R_true = case['R_true']\n            diagnostic = np.linalg.norm(R - R_true, 'fro')\n            results.append(diagnostic)\n\n        elif case['type'] == 'U_check':\n            # U can be computed as U = R.T @ F\n            U = R.T @ F\n            U_true = case['U_true']\n            # Diagnostic: ||U - U_true||_F\n            diagnostic = np.linalg.norm(U - U_true, 'fro')\n            results.append(diagnostic)\n\n    # Format the output as a comma-separated list of floats in a single line.\n    formatted_results = [f\"{res:.8e}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "answer": "[1.38777878e-16,1.11022302e-16,6.44297127e-16,2.22044605e-16]", "id": "2886399"}]}