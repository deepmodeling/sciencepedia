{"hands_on_practices": [{"introduction": "掌握弹性应变能概念最直接的方法就是从第一性原理出发进行计算。本练习 [@problem_id:2881874] 旨在通过一个材料和几何特性沿其长度变化的杆件来实践这一点。通过对从应力和应变场导出的应变能密度进行积分，您将加深对连续体中变形与储存能量之间基本关系的理解。", "problem": "一根长度为 $L$ 的直杆沿 $x$ 轴放置，其范围为 $x \\in [0,L]$。杆的横截面积 $A(x)$ 和杨氏模量 $E(x)$ 随空间位置变化，其表达式为\n$A(x) = A_{0}\\left(1 + a \\frac{x}{L}\\right)$ 和 $E(x) = E_{0}\\left(1 + b \\frac{x}{L}\\right)$，\n其中 $A_{0} = 8.00 \\times 10^{-4}\\ \\text{m}^{2}$，$E_{0} = 70 \\times 10^{9}\\ \\text{Pa}$，$a = 0.4$，$b = -0.2$，$L = 1.2\\ \\text{m}$。杆在 $x=L$ 处承受大小为 $P = 1.20 \\times 10^{5}\\ \\text{N}$ 的静态拉伸端部载荷，并在 $x=0$ 处由一大小相等、方向相反的轴向力平衡。假设小应变、线弹性且无体力。\n\n仅从一维轴向平衡、线弹性本构关系和运动协调性出发，确定杆在载荷 $P$ 作用下储存的总弹性应变能。使用线弹性材料的应变能密度定义，将应力场和应变场与能量联系起来。使用国际单位制 (SI) 将最终答案表示为焦耳 (Joules)，并将答案四舍五入至四位有效数字。", "solution": "问题陈述清晰、自洽且科学合理。这是一个关于非等截面杆件在轴向载荷作用下的材料力学标准问题。我们可以开始求解。\n\n问题要求从基本原理出发进行推导。这些原理是：\n1.  一维轴向平衡。\n2.  线弹性本构关系（胡克定律）。\n3.  弹性应变能的定义。\n\n步骤1：轴向平衡\n考虑杆从任意位置 $x$ 到端点 $x=L$ 的一段的自由体图。杆在 $x=L$ 处承受一个外部拉力 $P$。根据问题陈述，杆上没有体力作用。为使该段处于静力平衡状态，位置 $x$ 处横截面上的内轴向力 $N(x)$ 必须与外力 $P$ 平衡。\n$$N(x) - P = 0$$\n因此，内轴向力沿杆长是恒定的：\n$$N(x) = P$$\n\n步骤2：应力场和应变场\n轴向应力 $\\sigma(x)$ 定义为单位面积上的内力。由于横截面积 $A(x)$ 随位置变化，应力也将是 $x$ 的函数。\n$$\\sigma(x) = \\frac{N(x)}{A(x)} = \\frac{P}{A(x)}$$\n代入给定的 $A(x) = A_{0}(1 + a \\frac{x}{L})$ 表达式：\n$$\\sigma(x) = \\frac{P}{A_{0}\\left(1 + a \\frac{x}{L}\\right)}$$\n问题指出材料是线弹性的。本构关系由胡克定律给出，$\\sigma(x) = E(x)\\epsilon(x)$，其中 $\\epsilon(x)$ 是轴向应变，$E(x)$ 是随空间变化的杨氏模量。\n因此，轴向应变为：\n$$\\epsilon(x) = \\frac{\\sigma(x)}{E(x)} = \\frac{P}{A(x)E(x)}$$\n代入给定的 $A(x)$ 和 $E(x) = E_{0}(1 + b \\frac{x}{L})$ 表达式：\n$$\\epsilon(x) = \\frac{P}{A_{0}\\left(1 + a \\frac{x}{L}\\right) E_{0}\\left(1 + b \\frac{x}{L}\\right)}$$\n\n步骤3：弹性应变能\n对于线弹性材料，弹性应变能密度 $u(x)$（即单位体积的应变能）由下式给出：\n$$u(x) = \\frac{1}{2}\\sigma(x)\\epsilon(x)$$\n储存在杆中的总弹性应变能 $U$ 是应变能密度在杆的总體积 $V$ 上的积分。体积微元为 $dV = A(x)\\,dx$。\n$$U = \\int_{V} u(x)\\,dV = \\int_{0}^{L} u(x) A(x)\\,dx$$\n代入 $u(x)$、$\\sigma(x)$ 和 $\\epsilon(x)$ 的表达式：\n$$U = \\int_{0}^{L} \\frac{1}{2} \\sigma(x) \\epsilon(x) A(x)\\,dx = \\int_{0}^{L} \\frac{1}{2} \\left(\\frac{P}{A(x)}\\right) \\left(\\frac{P}{A(x)E(x)}\\right) A(x)\\,dx$$\n这可以简化为众所周知的轴向应变能表达式：\n$$U = \\int_{0}^{L} \\frac{P^2}{2 A(x) E(x)}\\,dx$$\n现在，我们代入给定的 $A(x)$ 和 $E(x)$ 函数：\n$$U = \\int_{0}^{L} \\frac{P^2}{2 \\left[A_{0}\\left(1 + a \\frac{x}{L}\\right)\\right] \\left[E_{0}\\left(1 + b \\frac{x}{L}\\right)\\right]}\\,dx$$\n我们可以将常数提取出来：\n$$U = \\frac{P^2}{2 A_{0} E_{0}} \\int_{0}^{L} \\frac{1}{\\left(1 + a \\frac{x}{L}\\right)\\left(1 + b \\frac{x}{L}\\right)}\\,dx$$\n为了计算该积分，我们进行变量替换。设无量纲变量 $\\xi = \\frac{x}{L}$。那么 $d\\xi = \\frac{dx}{L}$，因此 $dx = L\\,d\\xi$。积分限从 $x \\in [0, L]$ 变为 $\\xi \\in [0, 1]$。\n$$U = \\frac{P^2 L}{2 A_{0} E_{0}} \\int_{0}^{1} \\frac{1}{(1 + a\\xi)(1 + b\\xi)}\\,d\\xi$$\n被积函数是一个有理函数，可以使用部分分式分解法求解，假设 $a \\neq b$，这在本问题中是成立的（$a=0.4, b=-0.2$）。\n$$\\frac{1}{(1 + a\\xi)(1 + b\\xi)} = \\frac{C}{1 + a\\xi} + \\frac{D}{1 + b\\xi}$$\n求解系数 $C$ 和 $D$ 得到 $C = \\frac{a}{a-b}$ 和 $D = \\frac{-b}{a-b}$。\n积分变为：\n$$ \\int_{0}^{1} \\left(\\frac{a/(a-b)}{1 + a\\xi} + \\frac{-b/(a-b)}{1 + b\\xi}\\right)\\,d\\xi = \\frac{1}{a-b} \\int_{0}^{1} \\left(\\frac{a}{1 + a\\xi} - \\frac{b}{1 + b\\xi}\\right)\\,d\\xi $$\n$$= \\frac{1}{a-b} \\left[ \\ln(1 + a\\xi) - \\ln(1 + b\\xi) \\right]_{0}^{1}$$\n$$= \\frac{1}{a-b} \\left[ (\\ln(1+a) - \\ln(1+b)) - (\\ln(1) - \\ln(1)) \\right]$$\n$$= \\frac{1}{a-b} \\ln\\left(\\frac{1+a}{1+b}\\right)$$\n将此结果代回 $U$ 的表达式中：\n$$U = \\frac{P^2 L}{2 A_{0} E_{0}} \\left[ \\frac{1}{a-b} \\ln\\left(\\frac{1+a}{1+b}\\right) \\right]$$\n\n步骤4：数值计算\n我们已知以下数值：\n$P = 1.20 \\times 10^{5}\\ \\text{N}$\n$L = 1.2\\ \\text{m}$\n$A_{0} = 8.00 \\times 10^{-4}\\ \\text{m}^{2}$\n$E_{0} = 70 \\times 10^{9}\\ \\text{Pa}$\n$a = 0.4$\n$b = -0.2$\n\n首先，我们计算公式的各个组成部分：\n$P^2 = (1.20 \\times 10^{5})^{2} = 1.44 \\times 10^{10}\\ \\text{N}^2$\n$A_{0} E_{0} = (8.00 \\times 10^{-4}\\ \\text{m}^2)(70 \\times 10^{9}\\ \\text{Pa}) = 56 \\times 10^{6}\\ \\text{N} = 5.6 \\times 10^{7}\\ \\text{N}$\n$a-b = 0.4 - (-0.2) = 0.6$\n$\\frac{1+a}{1+b} = \\frac{1+0.4}{1-0.2} = \\frac{1.4}{0.8} = 1.75$\n\n现在将这些值代入 $U$ 的表达式：\n$$U = \\frac{(1.44 \\times 10^{10}) (1.2)}{2 (5.6 \\times 10^{7})} \\left[ \\frac{1}{0.6} \\ln(1.75) \\right]$$\n$$U = \\frac{1.728 \\times 10^{10}}{1.12 \\times 10^{8}} \\left[ \\frac{\\ln(1.75)}{0.6} \\right]$$\n$$U \\approx 154.2857 \\left[ \\frac{0.559616}{0.6} \\right]$$\n$$U \\approx 154.2857 \\times 0.932693$$\n$$U \\approx 143.9116\\ \\text{J}$$\n问题要求将答案四舍五入到四位有效数字。\n$$U \\approx 143.9\\ \\text{J}$$", "answer": "$$\\boxed{143.9}$$", "id": "2881874"}, {"introduction": "能量原理不仅用于计算，它们还是力学中一些最优雅定理的基石。本实践 [@problem_id:2881882] 将引导您从余能原理出发，推导麦克斯韦-贝蒂互易定理 (Maxwell's reciprocal theorem)，从而展示这一点。随后，您将应用这一定理高效地解决一个结构问题，体会能量方法如何提供深刻的见解和捷径，从而绕过复杂的直接计算。", "problem": "一根长度为 $L$ 的等截面细长梁在 $x=0$ 和 $x=L$ 处简支。梁具有恒定的抗弯刚度 $E I$，其中 $E=210\\,\\mathrm{GPa}$，$I=1.0\\times 10^{-4}\\,\\mathrm{m}^4$。假设为小挠度线性弹性行为；剪切变形和转动惯性效应可以忽略不计。考虑两种不同的静力荷载工况：\n\n- 工况 $\\mathcal{A}$：在 $x=a=2.0\\,\\mathrm{m}$ 处施加一个向下的集中荷载 $P_{1}=12\\,\\mathrm{kN}$。\n- 工况 $\\mathcal{B}$：在 $x=b=4.5\\,\\mathrm{m}$ 处施加一个向下的集中荷载 $P_{2}=9.0\\,\\mathrm{kN}$。\n\n在工况 $\\mathcal{B}$ 下的实验测量报告称，在 $x=a$ 处的竖向位移为 $\\Delta_{a|\\mathcal{B}}=1.37\\,\\mathrm{mm}$（以向下为正）。\n\n仅使用线性弹性弯曲的弹性应变能和余能的第一性原理，推导适用于该梁与这两个集中荷载的任何互易关系，然后用它来计算工况 $\\mathcal{A}$ 下 $x=b$ 处的竖向位移，记为 $\\Delta_{b|\\mathcal{A}}$。以 $\\mathrm{mm}$ 为单位表示最终位移（以向下为正），并将您的答案四舍五入到三位有效数字。", "solution": "问题陈述已经过验证，被认为是有效的。这是一个在线性弹性结构分析中定义明确的问题。所提供的数据在科学上是一致的。要求是从能量的第一性原理推导互易关系，并用它来求位移。提供了诸如抗弯刚度 $E I$ 以及特定荷载位置 $a$ 和 $b$ 等数据，而这些数据在最终的数值计算中并非必需，这是一种测试基本理解的常用方法，旨在促使学生认识到互易定理的先验适用性，而不是采取强力计算。\n\n我们从线性弹性系统的余能第一性原理开始。对于这样一个承受一组集中荷载 $P_i$ 的系统，余能 $\\Pi^*$ 是这些荷载的状态函数。在荷载 $P_j$ 作用点及 $P_j$ 方向上的位移 $\\Delta_j$ 由 Crotti-Engesser 定理给出：\n$$ \\Delta_j = \\frac{\\partial \\Pi^*}{\\partial P_j} $$\n对于以弯曲为主要变形模式的细长梁，余能以弯曲应变能的形式储存，并通过对梁的体积积分余能密度来计算。这得到以下表达式：\n$$ \\Pi^* = \\int_0^L \\frac{M(x)^2}{2 EI} dx $$\n其中 $M(x)$ 是位置 $x$ 处的弯矩，$E$ 是杨氏模量，$I$ 是横截面的截面二次矩，$L$ 是梁的长度。\n\n让我们考虑一个一般性的荷载情景，其中两个独立的竖向集中荷载 $P_a$ 和 $P_b$ 分别作用于位置 $x=a$ 和 $x=b$。根据线性弹性系统的叠加原理，梁上任意一点 $x$ 的总弯矩 $M(x)$ 是由每个荷载单独作用所引起的弯矩之和。我们可以将其写为：\n$$ M(x; P_a, P_b) = M_a(x) + M_b(x) $$\n其中 $M_a(x)$ 是由 $P_a$ 引起的弯矩，$M_b(x)$ 是由 $P_b$ 引起的弯矩。这些弯矩与引起它们的荷载成线性比例关系。因此，我们可以定义弯矩的影响函数 $m_a(x)$ 和 $m_b(x)$，使得：\n$$ M_a(x) = P_a m_a(x) \\quad \\text{and} \\quad M_b(x) = P_b m_b(x) $$\n其中 $m_a(x)$ 是由于在 $x=a$ 处施加单位荷载引起的弯矩，$m_b(x)$ 是由于在 $x=b$ 处施加单位荷载引起的弯矩。\n\n系统作为两个荷载函数的总余能是：\n$$ \\Pi^*(P_a, P_b) = \\int_0^L \\frac{[P_a m_a(x) + P_b m_b(x)]^2}{2 EI} dx $$\n$$ \\Pi^*(P_a, P_b) = \\frac{1}{2 EI} \\int_0^L [P_a^2 m_a(x)^2 + 2 P_a P_b m_a(x) m_b(x) + P_b^2 m_b(x)^2] dx $$\n在 $x=a$ 处的竖向位移，记为 $\\Delta_a$，通过对 $\\Pi^*$ 求关于 $P_a$ 的偏导数得到：\n$$ \\Delta_a(P_a, P_b) = \\frac{\\partial \\Pi^*}{\\partial P_a} = \\frac{1}{EI} \\int_0^L [P_a m_a(x)^2 + P_b m_a(x) m_b(x)] dx $$\n类似地，在 $x=b$ 处的竖向位移，记为 $\\Delta_b$，是：\n$$ \\Delta_b(P_a, P_b) = \\frac{\\partial \\Pi^*}{\\partial P_b} = \\frac{1}{EI} \\int_0^L [P_a m_a(x) m_b(x) + P_b m_b(x)^2] dx $$\n由于 $\\Pi^*$ 是一个具有连续二阶导数的连续状态函数，求导顺序无关紧要（Clairaut 的混合偏导数相等定理）。我们可以计算混合二阶偏导数：\n$$ \\frac{\\partial \\Delta_a}{\\partial P_b} = \\frac{\\partial}{\\partial P_b} \\left( \\frac{\\partial \\Pi^*}{\\partial P_a} \\right) = \\frac{\\partial^2 \\Pi^*}{\\partial P_b \\partial P_a} = \\frac{1}{EI} \\int_0^L m_a(x) m_b(x) dx $$\n$$ \\frac{\\partial \\Delta_b}{\\partial P_a} = \\frac{\\partial}{\\partial P_a} \\left( \\frac{\\partial \\Pi^*}{\\partial P_b} \\right) = \\frac{\\partial^2 \\Pi^*}{\\partial P_a \\partial P_b} = \\frac{1}{EI} \\int_0^L m_a(x) m_b(x) dx $$\n将这两个表达式相等，我们得到一个普遍的互易关系：\n$$ \\frac{\\partial \\Delta_a}{\\partial P_b} = \\frac{\\partial \\Delta_b}{\\partial P_a} $$\n项 $\\frac{\\partial \\Delta_a}{\\partial P_b}$ 表示在 $b$ 处施加单位荷载时在 $a$ 处的位移，这是一个柔度影响系数 $f_{ab}$。对于线性系统，仅由荷载 $P_b$ 引起的 $a$ 处位移为 $\\Delta_{a|P_b} = f_{ab} P_b$。因此，$f_{ab} = \\Delta_{a|P_b} / P_b$。\n类似地，$\\frac{\\partial \\Delta_b}{\\partial P_a} = f_{ba}$，且 $\\Delta_{b|P_a} = f_{ba} P_a$，所以 $f_{ba} = \\Delta_{b|P_a} / P_a$。\n等式 $f_{ab} = f_{ba}$ 意味着：\n$$ \\frac{\\Delta_{a|P_b}}{P_b} = \\frac{\\Delta_{b|P_a}}{P_a} \\implies P_a \\Delta_{a|P_b} = P_b \\Delta_{b|P_a} $$\n这就是我们从余能第一性原理推导出的 Maxwell 互易定理。它指出，第一个荷载 $P_a$ 在由第二个荷载 $P_b$ 引起的位移上所做的功，等于第二个荷载 $P_b$ 在由第一个荷载 $P_a$ 引起的位移上所做的功。\n\n现在我们将此定理应用于问题中给出的具体工况。\n工况 $\\mathcal{A}$：在 $x=a$ 处施加单个荷载 $P_1$。在 $x=b$ 处的位移是 $\\Delta_{b|\\mathcal{A}}$。这里，$P_a = P_1$ 且 $\\Delta_{b|P_a} = \\Delta_{b|\\mathcal{A}}$。\n工况 $\\mathcal{B}$：在 $x=b$ 处施加单个荷载 $P_2$。在 $x=a$ 处的位移是 $\\Delta_{a|\\mathcal{B}}$。这里，$P_b = P_2$ 且 $\\Delta_{a|P_b} = \\Delta_{a|\\mathcal{B}}$。\n\n将这些代入推导出的互易关系 $P_a \\Delta_{a|P_b} = P_b \\Delta_{b|P_a}$ 中：\n$$ P_1 \\Delta_{a|\\mathcal{B}} = P_2 \\Delta_{b|\\mathcal{A}} $$\n我们需要计算 $\\Delta_{b|\\mathcal{A}}$。重新整理方程：\n$$ \\Delta_{b|\\mathcal{A}} = \\frac{P_1}{P_2} \\Delta_{a|\\mathcal{B}} $$\n问题提供了以下数值：\n$P_1 = 12\\,\\mathrm{kN}$\n$P_2 = 9.0\\,\\mathrm{kN}$\n$\\Delta_{a|\\mathcal{B}} = 1.37\\,\\mathrm{mm}$\n\n将这些值代入 $\\Delta_{b|\\mathcal{A}}$ 的表达式中：\n$$ \\Delta_{b|\\mathcal{A}} = \\frac{12\\,\\mathrm{kN}}{9.0\\,\\mathrm{kN}} \\times 1.37\\,\\mathrm{mm} = \\frac{4}{3} \\times 1.37\\,\\mathrm{mm} $$\n计算得出：\n$$ \\Delta_{b|\\mathcal{A}} \\approx 1.3333... \\times 1.37\\,\\mathrm{mm} \\approx 1.82666...\\,\\mathrm{mm} $$\n问题要求答案四舍五入到三位有效数字。\n$$ \\Delta_{b|\\mathcal{A}} \\approx 1.83\\,\\mathrm{mm} $$\n正号表示位移是向下的，这与问题陈述中建立的约定一致。额外的数据（$E$、$I$、$a$、$b$ 以及隐含的 $L$）对于此计算不是必需的，正如应用互易定理所预期的那样。", "answer": "$$\\boxed{1.83}$$", "id": "2881882"}, {"introduction": "在现代工程中，理论概念的威力体现在其计算应用上。本练习 [@problem_id:2881876] 旨在连接弹性应变能理论与有限元法 (Finite Element Method, FEM) 的应用。您将编写一个程序，基于应变能 $U$ 与余能 $V$ 之间的“能量差”，来计算一种后验误差估计量 (a posteriori error estimator)，从而掌握一种评估结构分析中数值解质量的实用技术。", "problem": "您会收到几个小的、独立的测试实例，这些实例是关于一个二维、线性、各向同性的弹性体，该弹性体在平面应力下建模，并由常应变有限元进行离散化。对于每个实例，您都会获得材料参数，以及每个单元的恒定工程应变向量和一个恢复的、静力许可（平衡的）工程应力向量。请仅使用基本定义，推导出一个可计算的、程序化的后验误差估计量，该估计量基于计算出的总应变能和恢复的总余能之间的能量间隙。然后，实现一个程序，对指定的测试套件执行此计算，并以规定的格式输出估计量。\n\n基本和建模假设：\n- 环境设定为平面应力下的二维线性弹性。位移场是运动许可的，恢复的应力场是静力许可的（与相同载荷平衡）。适用小应变运动学和胡克定律。\n- 使用工程剪应变，因此应变向量为 $\\boldsymbol{\\varepsilon}_{\\text{eng}} = \\left[\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}\\right]^{\\mathsf{T}}$，应力向量为 $\\boldsymbol{\\sigma}_{\\text{eng}} = \\left[\\sigma_{xx}, \\sigma_{yy}, \\tau_{xy}\\right]^{\\mathsf{T}}$。\n- 对于杨氏模量为 $E$、泊松比为 $\\nu$ 的均质、各向同性材料，在平面应力下，本构（刚度）矩阵 $\\mathbf{D}$ 及其逆矩阵——柔度矩阵 $\\mathbf{S}$，将应力和应变关联起来，分别为 $\\boldsymbol{\\sigma}_{\\text{eng}} = \\mathbf{D}\\,\\boldsymbol{\\varepsilon}_{\\text{eng}}$ 和 $\\boldsymbol{\\varepsilon}_{\\text{eng}} = \\mathbf{S}\\,\\boldsymbol{\\sigma}_{\\text{eng}}$。这些是经过充分检验的公式，必须针对平面应力下的工程剪切进行一致地构建。\n- 应变能密度定义为 $w = \\dfrac{1}{2}\\,\\boldsymbol{\\varepsilon} : \\boldsymbol{\\sigma}$，余能密度定义为 $w^{\\ast} = \\dfrac{1}{2}\\,\\boldsymbol{\\sigma} : \\boldsymbol{\\varepsilon}$，其中“$:$”表示双点积。根据上述向量-矩阵约定，$w = \\dfrac{1}{2}\\,\\boldsymbol{\\varepsilon}_{\\text{eng}}^{\\mathsf{T}}\\,\\mathbf{D}\\,\\boldsymbol{\\varepsilon}_{\\text{eng}}$ 和 $w^{\\ast} = \\dfrac{1}{2}\\,\\boldsymbol{\\sigma}_{\\text{eng}}^{\\mathsf{T}}\\,\\mathbf{S}\\,\\boldsymbol{\\sigma}_{\\text{eng}}$。\n\n离散化和可计算量：\n- 考虑面积为 $A_e$、单位厚度的常应变三角形或四边形单元。单元应变能为 $U_e = \\int_{\\Omega_e} w\\,\\mathrm{d}\\Omega = \\dfrac{1}{2}\\,\\boldsymbol{\\varepsilon}_{\\text{eng},e}^{\\mathsf{T}}\\,\\mathbf{D}\\,\\boldsymbol{\\varepsilon}_{\\text{eng},e}\\,A_e$，单元余能为 $V_e = \\int_{\\Omega_e} w^{\\ast}\\,\\mathrm{d}\\Omega = \\dfrac{1}{2}\\,\\boldsymbol{\\sigma}_{\\text{eng},e}^{\\mathsf{T}}\\,\\mathbf{S}\\,\\boldsymbol{\\sigma}_{\\text{eng},e}\\,A_e$。总和为 $U = \\sum_e U_e$ 和 $V = \\sum_e V_e$。\n- 基于余能原理和线性弹性的 Prager–Synge 型能量恒等式，一个稳健的可计算能量范数误差指示符是基于 $V$ 和 $U$ 之间的能量间隙。在本任务中，您必须使用定义为差值非负部分的能量间隙估计量：\n  $$\\eta = \\max\\!\\left(0,\\, V - U\\right).$$\n  此估计量 $\\eta$ 的单位是能量。您必须以焦耳（J）为单位表示 $\\eta$。\n\n实现要求：\n- 根据 $E$ 和 $\\nu$ 为平面应力和工程剪切一致地构造 $\\mathbf{D}$ 和 $\\mathbf{S}$。\n- 对每个测试实例，通过对单元贡献求和来计算 $U$ 和 $V$，然后按照上述定义计算 $\\eta$。\n- 数值稳定性：如果浮点舍入导致 $V - U$ 出现一个微小的负值，请使用上面的 $\\max$ 将其钳制为零。\n\n物理单位：\n- 使用国际单位制（SI）。$E$ 的单位为帕斯卡（Pa），$\\nu$ 无量纲，面积 $A_e$ 的单位为平方米（$\\mathrm{m}^2$），应变和工程剪应变无量纲，应力单位为帕斯卡（Pa）。报告的 $\\eta$ 以焦耳（J）为单位，并精确到小数点后六位。\n\n测试套件（四个独立实例），每个实例提供材料参数和每个单元的数据 $(A_e, \\boldsymbol{\\varepsilon}_{\\text{eng},e}, \\boldsymbol{\\sigma}_{\\text{eng},e})$：\n- 实例 1:\n  - 材料: $E = 210\\times 10^{9}\\ \\mathrm{Pa}$, $\\nu = 0.3$。\n  - 单元:\n    - $A_1 = 0.50$, $\\boldsymbol{\\varepsilon}_{\\text{eng},1} = \\left[1.0\\times 10^{-4},\\ 0.5\\times 10^{-4},\\ 0.2\\times 10^{-4}\\right]$, $\\boldsymbol{\\sigma}_{\\text{eng},1} = \\left[30.0\\times 10^{6},\\ 18.0\\times 10^{6},\\ 7.0\\times 10^{6}\\right]$。\n    - $A_2 = 0.75$, $\\boldsymbol{\\varepsilon}_{\\text{eng},2} = \\left[0.8\\times 10^{-4},\\ 1.2\\times 10^{-4},\\ -0.1\\times 10^{-4}\\right]$, $\\boldsymbol{\\sigma}_{\\text{eng},2} = \\left[28.0\\times 10^{6},\\ 32.0\\times 10^{6},\\ -5.0\\times 10^{6}\\right]$。\n    - $A_3 = 0.60$, $\\boldsymbol{\\varepsilon}_{\\text{eng},3} = \\left[0.6\\times 10^{-4},\\ 0.4\\times 10^{-4},\\ 0.0\\right]$, $\\boldsymbol{\\sigma}_{\\text{eng},3} = \\left[20.0\\times 10^{6},\\ 15.0\\times 10^{6},\\ 0.0\\right]$。\n- 实例 2:\n  - 材料: $E = 70\\times 10^{9}\\ \\mathrm{Pa}$, $\\nu = 0.25$。\n  - 单元:\n    - $A_1 = 1.20$, $\\boldsymbol{\\varepsilon}_{\\text{eng},1} = \\left[0.0,\\ 0.0,\\ 0.0\\right]$, $\\boldsymbol{\\sigma}_{\\text{eng},1} = \\left[0.0,\\ 0.0,\\ 0.0\\right]$。\n    - $A_2 = 0.80$, $\\boldsymbol{\\varepsilon}_{\\text{eng},2} = \\left[0.0,\\ 0.0,\\ 0.0\\right]$, $\\boldsymbol{\\sigma}_{\\text{eng},2} = \\left[0.0,\\ 0.0,\\ 0.0\\right]$。\n- 实例 3:\n  - 材料: $E = 100\\times 10^{9}\\ \\mathrm{Pa}$, $\\nu = 0.30$。\n  - 单元:\n    - $A_1 = 1.00$, $\\boldsymbol{\\varepsilon}_{\\text{eng},1} = \\left[1.0\\times 10^{-4},\\ 1.0\\times 10^{-4},\\ 0.0\\right]$, $\\boldsymbol{\\sigma}_{\\text{eng},1} = \\left[5.0\\times 10^{6},\\ 5.0\\times 10^{6},\\ 0.0\\right]$。\n    - $A_2 = 0.50$, $\\boldsymbol{\\varepsilon}_{\\text{eng},2} = \\left[0.5\\times 10^{-4},\\ 0.5\\times 10^{-4},\\ 0.0\\right]$, $\\boldsymbol{\\sigma}_{\\text{eng},2} = \\left[2.5\\times 10^{6},\\ 2.5\\times 10^{6},\\ 0.0\\right]$。\n- 实例 4:\n  - 材料: $E = 70\\times 10^{9}\\ \\mathrm{Pa}$, $\\nu = 0.20$。\n  - 单元:\n    - $A_1 = 0.40$, $\\boldsymbol{\\varepsilon}_{\\text{eng},1} = \\left[1.5\\times 10^{-4},\\ 0.5\\times 10^{-4},\\ 0.3\\times 10^{-4}\\right]$, $\\boldsymbol{\\sigma}_{\\text{eng},1} = \\left[18.0\\times 10^{6},\\ 10.0\\times 10^{6},\\ 6.0\\times 10^{6}\\right]$。\n    - $A_2 = 0.60$, $\\boldsymbol{\\varepsilon}_{\\text{eng},2} = \\left[0.9\\times 10^{-4},\\ 1.2\\times 10^{-4},\\ -0.2\\times 10^{-4}\\right]$, $\\boldsymbol{\\sigma}_{\\text{eng},2} = \\left[14.0\\times 10^{6},\\ 16.0\\times 10^{6},\\ -4.0\\times 10^{6}\\right]$。\n\n最终输出格式：\n- 您的程序必须生成单行文本，其中包含一个 Python 列表字面量，内含四个估计量，单位为焦耳（J），每个估计量都精确到小数点后六位，没有额外的空白或文本。例如：“[$x_1,x_2,x_3,x_4$]”，其中每个 $x_i$ 是一个小数点后有六位数字的十进制数。", "solution": "该问题已经过严格验证，被认为是科学上可靠、适定、客观且内部一致的。它呈现了计算力学中的一个标准任务，特别是在有限元方法的后验误差估计方面。所有必要的数据和定义均已提供。我们着手求解。\n\n目标是为几个平面应力下二维弹性体的实例计算后验误差估计量 $\\eta$。该估计量被定义为恢复的、静力许可的应力场的总余能与运动许可的有限元位移场的总应变能之间的能量间隙。其定义如下：\n$$ \\eta = \\max\\!\\left(0,\\, V - U\\right) $$\n其中 $U$ 是总应变能，$V$ 是总余能。\n\n首先，我们必须建立线性、各向同性材料在平面应力下，使用工程应变约定的材料本构矩阵，即 $\\mathbf{D}$（刚度）和 $\\mathbf{S}$（柔度）。工程应力向量 $\\boldsymbol{\\sigma}_{\\text{eng}} = \\left[\\sigma_{xx}, \\sigma_{yy}, \\tau_{xy}\\right]^{\\mathsf{T}}$ 与工程应变向量 $\\boldsymbol{\\varepsilon}_{\\text{eng}} = \\left[\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}\\right]^{\\mathsf{T}}$ 之间的关系是 $\\boldsymbol{\\sigma}_{\\text{eng}} = \\mathbf{D}\\,\\boldsymbol{\\varepsilon}_{\\text{eng}}$。\n\n在平面应力假设下（$\\sigma_{zz} = \\sigma_{xz} = \\sigma_{yz} = 0$），对于杨氏模量为 $E$、泊松比为 $\\nu$ 的各向同性材料，应变-应力关系为：\n$$ \\varepsilon_{xx} = \\frac{1}{E}(\\sigma_{xx} - \\nu \\sigma_{yy}) $$\n$$ \\varepsilon_{yy} = \\frac{1}{E}(\\sigma_{yy} - \\nu \\sigma_{xx}) $$\n$$ \\gamma_{xy} = \\frac{1}{G}\\tau_{xy} $$\n其中 $G = \\frac{E}{2(1+\\nu)}$ 是剪切模量。这些方程可以写成矩阵形式 $\\boldsymbol{\\varepsilon}_{\\text{eng}} = \\mathbf{S}\\,\\boldsymbol{\\sigma}_{\\text{eng}}$，这定义了柔度矩阵 $\\mathbf{S}$：\n$$ \\mathbf{S} = \\begin{bmatrix} 1/E & -\\nu/E & 0 \\\\ -\\nu/E & 1/E & 0 \\\\ 0 & 0 & 1/G \\end{bmatrix} = \\frac{1}{E} \\begin{bmatrix} 1 & -\\nu & 0 \\\\ -\\nu & 1 & 0 \\\\ 0 & 0 & 2(1+\\nu) \\end{bmatrix} $$\n刚度矩阵 $\\mathbf{D}$ 是柔度矩阵的逆，即 $\\mathbf{D} = \\mathbf{S}^{-1}$。对上述矩阵求逆可得：\n$$ \\mathbf{D} = \\frac{E}{1-\\nu^2} \\begin{bmatrix} 1 & \\nu & 0 \\\\ \\nu & 1 & 0 \\\\ 0 & 0 & \\frac{1-\\nu}{2} \\end{bmatrix} $$\n这些矩阵是计算能量密度的基础。\n\n总应变能 $U$ 和总余能 $V$ 是通过对每个有限元（用下标 $e$ 标记）的贡献求和得到的。假设物体具有单位厚度。对于面积为 $A_e$ 的单元，其能量为：\n$$ U = \\sum_e U_e = \\sum_e \\left( \\frac{1}{2}\\,\\boldsymbol{\\varepsilon}_{\\text{eng},e}^{\\mathsf{T}}\\,\\mathbf{D}\\,\\boldsymbol{\\varepsilon}_{\\text{eng},e}\\,A_e \\right) $$\n$$ V = \\sum_e V_e = \\sum_e \\left( \\frac{1}{2}\\,\\boldsymbol{\\sigma}_{\\text{eng},e}^{\\mathsf{T}}\\,\\mathbf{S}\\,\\boldsymbol{\\sigma}_{\\text{eng},e}\\,A_e \\right) $$\n这里，$\\boldsymbol{\\varepsilon}_{\\text{eng},e}$ 是单元 $e$ 的有限元解的恒定应变向量，而 $\\boldsymbol{\\sigma}_{\\text{eng},e}$ 是相应的恢复的、静力许可的应力向量。\n\n每个测试实例的计算流程如下：\n1.  给定材料参数 $E$ 和 $\\nu$，构建矩阵 $\\mathbf{D}$ 和 $\\mathbf{S}$。\n2.  初始化总能量 $U \\leftarrow 0$ 和 $V \\leftarrow 0$。\n3.  对于测试用例中提供的每个单元 $e$：\n    a.  获取单元面积 $A_e$、应变向量 $\\boldsymbol{\\varepsilon}_{\\text{eng},e}$ 和应力向量 $\\boldsymbol{\\sigma}_{\\text{eng},e}$。\n    b.  使用上述公式计算单元应变能 $U_e$ 并将其加到总和中：$U \\leftarrow U + U_e$。\n    c.  使用其公式计算单元余能 $V_e$ 并将其加到总和中：$V \\leftarrow V + V_e$。\n4.  遍历所有单元后，计算最终的误差估计量 $\\eta = \\max(0, V - U)$。\n5.  所有计算必须使用国际单位制（SI），从而得到以焦耳（J）为单位的 $\\eta$。\n\n此精确流程已在随附的 Python 程序中实现。该程序处理四个指定的测试实例，为每个实例计算 $\\eta$，将结果四舍五入到小数点后六位，并以所需格式打印出来。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the a posteriori error estimation problem for the given test suite.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"material\": {\"E\": 210e9, \"nu\": 0.3},\n            \"elements\": [\n                {\"A\": 0.50, \"eps\": [1.0e-4, 0.5e-4, 0.2e-4],  \"sigma\": [30.0e6, 18.0e6, 7.0e6]},\n                {\"A\": 0.75, \"eps\": [0.8e-4, 1.2e-4, -0.1e-4], \"sigma\": [28.0e6, 32.0e6, -5.0e6]},\n                {\"A\": 0.60, \"eps\": [0.6e-4, 0.4e-4, 0.0],     \"sigma\": [20.0e6, 15.0e6, 0.0]}\n            ]\n        },\n        {\n            \"material\": {\"E\": 70e9, \"nu\": 0.25},\n            \"elements\": [\n                {\"A\": 1.20, \"eps\": [0.0, 0.0, 0.0], \"sigma\": [0.0, 0.0, 0.0]},\n                {\"A\": 0.80, \"eps\": [0.0, 0.0, 0.0], \"sigma\": [0.0, 0.0, 0.0]}\n            ]\n        },\n        {\n            \"material\": {\"E\": 100e9, \"nu\": 0.30},\n            \"elements\": [\n                {\"A\": 1.00, \"eps\": [1.0e-4, 1.0e-4, 0.0], \"sigma\": [5.0e6, 5.0e6, 0.0]},\n                {\"A\": 0.50, \"eps\": [0.5e-4, 0.5e-4, 0.0], \"sigma\": [2.5e6, 2.5e6, 0.0]}\n            ]\n        },\n        {\n            \"material\": {\"E\": 70e9, \"nu\": 0.20},\n            \"elements\": [\n                {\"A\": 0.40, \"eps\": [1.5e-4, 0.5e-4, 0.3e-4],  \"sigma\": [18.0e6, 10.0e6, 6.0e6]},\n                {\"A\": 0.60, \"eps\": [0.9e-4, 1.2e-4, -0.2e-4], \"sigma\": [14.0e6, 16.0e6, -4.0e6]}\n            ]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        E = case[\"material\"][\"E\"]\n        nu = case[\"material\"][\"nu\"]\n\n        # Construct constitutive (stiffness) matrix D for plane stress\n        d_factor = E / (1.0 - nu**2)\n        D_matrix = d_factor * np.array([\n            [1.0, nu, 0.0],\n            [nu, 1.0, 0.0],\n            [0.0, 0.0, (1.0 - nu) / 2.0]\n        ])\n\n        # Construct compliance matrix S for plane stress\n        s_factor = 1.0 / E\n        S_matrix = s_factor * np.array([\n            [1.0, -nu, 0.0],\n            [-nu, 1.0, 0.0],\n            [0.0, 0.0, 2.0 * (1.0 + nu)]\n        ])\n        \n        U_total = 0.0\n        V_total = 0.0\n\n        for elem in case[\"elements\"]:\n            A_e = elem[\"A\"]\n            eps_eng_e = np.array(elem[\"eps\"])\n            sigma_eng_e = np.array(elem[\"sigma\"])\n\n            # Calculate element strain energy U_e\n            # U_e = (1/2) * eps^T * D * eps * A\n            U_e = 0.5 * (eps_eng_e.T @ D_matrix @ eps_eng_e) * A_e\n            U_total += U_e\n            \n            # Calculate element complementary energy V_e\n            # V_e = (1/2) * sigma^T * S * sigma * A\n            V_e = 0.5 * (sigma_eng_e.T @ S_matrix @ sigma_eng_e) * A_e\n            V_total += V_e\n            \n        # Calculate the energy gap error estimator\n        eta = max(0.0, V_total - U_total)\n        results.append(eta)\n\n    # Format output to exactly six decimal places as specified\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2881876"}]}