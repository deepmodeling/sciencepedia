{"hands_on_practices": [{"introduction": "本练习旨在通过一个经典的平面应力问题，深入探讨张量在坐标旋转下的变换规律。通过亲手推导应力分量的变换公式，你将直观地看到它们如何随坐标系的选择而改变。更重要的是，这个练习将引导你运用不变量的思想，从看似复杂的变换中提炼出独立于坐标系的物理量，即偏应力张量的第二不变量 $J_2$，这是理解材料本构关系客观性的关键一步。[@problem_id:2922615]", "problem": "考虑一个处于平面应力状态的均匀线性弹性体，其在笛卡尔基 $\\{\\mathbf{e}_x,\\mathbf{e}_y,\\mathbf{e}_z\\}$ 中的柯西应力张量由下式描述\n$$\n\\boldsymbol{\\sigma}=\\begin{pmatrix}\n\\sigma_x & \\tau_{xy} & 0\\\\\n\\tau_{xy} & \\sigma_y & 0\\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\n其中 $\\sigma_x$、$\\sigma_y$ 和 $\\tau_{xy}$ 为实常数。令 $\\mathbf{Q}(\\theta)$ 表示绕 $\\mathbf{e}_z$ 轴旋转角度 $\\theta$ 的正交旋转，并令 $\\boldsymbol{\\sigma}'(\\theta)$ 为在旋转后的基中表示的应力张量，其通过标准的二阶张量变换法则 $\\boldsymbol{\\sigma}'=\\mathbf{Q}\\,\\boldsymbol{\\sigma}\\,\\mathbf{Q}^{\\mathsf{T}}$ 获得。\n\n仅从二阶张量的正交变换、迹的旋转不变性以及偏量分解 $\\boldsymbol{s}=\\boldsymbol{\\sigma} - \\tfrac{1}{3}(\\mathrm{tr}\\,\\boldsymbol{\\sigma})\\mathbf{I}$ 的定义出发，完成以下任务：\n\n- 推导变换后的面内分量 $\\sigma'_{x'x'}(\\theta)$、$\\sigma'_{y'y'}(\\theta)$ 和 $\\tau_{x'y'}(\\theta)$ 作为 $\\sigma_x$、$\\sigma_y$、$\\tau_{xy}$ 和 $\\theta$ 的函数表达式。\n- 仅使用基于正交相似和偏量分解的不变量论证，消除对 $\\theta$ 的显式依赖，并获得偏应力第二不变量 $J_2=\\tfrac{1}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}$ 的闭式表达式，该表达式纯粹用 $\\sigma_x$、$\\sigma_y$ 和 $\\tau_{xy}$ 表示。\n\n请给出 $J_2$ 的简化解析表达式作为你的最终答案。最终答案中不要提供中间步骤或多个表达式。不需要数值，也无需四舍五入。将你的最终答案表示为无单位的单个解析表达式。", "solution": "所述问题具有科学依据，是适定的、客观的。这是一个连续介质力学中的标准问题，基于张量分析的基本原理，并且没有任何逻辑矛盾、事实错误或含糊之处。所有必要信息均已提供。因此，我们开始求解。\n\n该问题分为两部分。首先，我们推导应力张量面内分量的变换法则。其次，我们利用偏应力第二不变量 $J_2$ 的不变性进行论证，推导其表达式。\n\n第 1 部分：变换后应力分量的推导\n\n在基变换下，二阶张量 $\\boldsymbol{\\sigma}$ 的变换由 $\\boldsymbol{\\sigma}' = \\mathbf{Q}\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}}$ 给出，其中 $\\mathbf{Q}$ 是正交变换矩阵。对于坐标系绕 $\\mathbf{e}_z$ 轴旋转角度 $\\theta$ 的情况，变换矩阵 $\\mathbf{Q}(\\theta)$ 及其转置 $\\mathbf{Q}^{\\mathsf{T}}(\\theta)$ 为：\n$$\n\\mathbf{Q}(\\theta) = \\begin{pmatrix}\n\\cos\\theta & \\sin\\theta & 0 \\\\\n-\\sin\\theta & \\cos\\theta & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}, \\quad \\mathbf{Q}^{\\mathsf{T}}(\\theta) = \\begin{pmatrix}\n\\cos\\theta & -\\sin\\theta & 0 \\\\\n\\sin\\theta & \\cos\\theta & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\n给定的平面应力状态下的应力张量为：\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix}\n\\sigma_x & \\tau_{xy} & 0 \\\\\n\\tau_{xy} & \\sigma_y & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\n我们执行矩阵乘法 $\\boldsymbol{\\sigma}'(\\theta) = \\mathbf{Q}(\\theta)\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}}(\\theta)$。由于这些矩阵的结构，我们只需考虑左上角的 $2 \\times 2$ 子块。令 $c = \\cos\\theta$ 和 $s = \\sin\\theta$。\n$$\n\\boldsymbol{\\sigma}'_{2D} = \\begin{pmatrix} c & s \\\\ -s & c \\end{pmatrix} \\begin{pmatrix} \\sigma_x & \\tau_{xy} \\\\ \\tau_{xy} & \\sigma_y \\end{pmatrix} \\begin{pmatrix} c & -s \\\\ s & c \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} c\\sigma_x + s\\tau_{xy} & c\\tau_{xy} + s\\sigma_y \\\\ -s\\sigma_x + c\\tau_{xy} & -s\\tau_{xy} + c\\sigma_y \\end{pmatrix} \\begin{pmatrix} c & -s \\\\ s & c \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix}\nc(c\\sigma_x + s\\tau_{xy}) + s(c\\tau_{xy} + s\\sigma_y) & -s(c\\sigma_x + s\\tau_{xy}) + c(c\\tau_{xy} + s\\sigma_y) \\\\\nc(-s\\sigma_x + c\\tau_{xy}) + s(-s\\tau_{xy} + c\\sigma_y) & -s(-s\\sigma_x + c\\tau_{xy}) + c(-s\\tau_{xy} + c\\sigma_y)\n\\end{pmatrix}\n$$\n变换后张量 $\\boldsymbol{\\sigma}'$ 的分量为：\n$\\sigma'_{x'x'} = \\sigma'_{11} = c^2\\sigma_x + s^2\\sigma_y + 2sc\\tau_{xy}$\n$\\sigma'_{y'y'} = \\sigma'_{22} = s^2\\sigma_x + c^2\\sigma_y - 2sc\\tau_{xy}$\n$\\tau'_{x'y'} = \\sigma'_{12} = (c^2-s^2)\\tau_{xy} - sc(\\sigma_x - \\sigma_y)$\n\n使用三角恒等式 $\\cos^2\\theta = \\frac{1}{2}(1+\\cos(2\\theta))$、$\\sin^2\\theta = \\frac{1}{2}(1-\\cos(2\\theta))$、$2\\sin\\theta\\cos\\theta = \\sin(2\\theta)$以及 $\\cos^2\\theta - \\sin^2\\theta = \\cos(2\\theta)$，我们简化这些表达式：\n$$\n\\sigma'_{x'x'}(\\theta) = \\sigma_x\\left(\\frac{1+\\cos(2\\theta)}{2}\\right) + \\sigma_y\\left(\\frac{1-\\cos(2\\theta)}{2}\\right) + \\tau_{xy}\\sin(2\\theta) = \\frac{\\sigma_x+\\sigma_y}{2} + \\frac{\\sigma_x-\\sigma_y}{2}\\cos(2\\theta) + \\tau_{xy}\\sin(2\\theta)\n$$\n$$\n\\sigma'_{y'y'}(\\theta) = \\sigma_x\\left(\\frac{1-\\cos(2\\theta)}{2}\\right) + \\sigma_y\\left(\\frac{1+\\cos(2\\theta)}{2}\\right) - \\tau_{xy}\\sin(2\\theta) = \\frac{\\sigma_x+\\sigma_y}{2} - \\frac{\\sigma_x-\\sigma_y}{2}\\cos(2\\theta) - \\tau_{xy}\\sin(2\\theta)\n$$\n$$\n\\tau'_{x'y'}(\\theta) = -\\left(\\frac{\\sigma_x-\\sigma_y}{2}\\right)\\sin(2\\theta) + \\tau_{xy}\\cos(2\\theta)\n$$\n\n第 2 部分：不变量 $J_2$ 的推导\n\n该问题要求基于不变量进行推导。量 $J_2 = \\frac{1}{2}\\boldsymbol{s}:\\boldsymbol{s}$ 根据其构造（张量与自身的标量积），是在正交变换下的一个标量不变量。我们对此进行形式化证明。\n\n偏应力张量 $\\boldsymbol{s}$ 定义为 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}(\\mathrm{tr}\\,\\boldsymbol{\\sigma})\\mathbf{I}$。\n在旋转坐标系中，变换后的偏应力为 $\\boldsymbol{s}' = \\boldsymbol{\\sigma}' - \\frac{1}{3}(\\mathrm{tr}\\,\\boldsymbol{\\sigma}')\\mathbf{I}$。\n迹在正交相似变换下是不变的：$\\mathrm{tr}\\,\\boldsymbol{\\sigma}' = \\mathrm{tr}(\\mathbf{Q}\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}}) = \\mathrm{tr}(\\boldsymbol{\\sigma})$。\n因此，我们可以将 $\\boldsymbol{s}'$ 写为：\n$$\n\\boldsymbol{s}' = \\mathbf{Q}\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}} - \\frac{1}{3}(\\mathrm{tr}\\,\\boldsymbol{\\sigma})\\mathbf{I}\n$$\n由于单位张量 $\\mathbf{I}$ 是各向同性的，所以 $\\mathbf{I} = \\mathbf{Q}\\mathbf{I}\\mathbf{Q}^{\\mathsf{T}}$。代入此式可得：\n$$\n\\boldsymbol{s}' = \\mathbf{Q}\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}} - \\frac{1}{3}(\\mathrm{tr}\\,\\boldsymbol{\\sigma})\\mathbf{Q}\\mathbf{I}\\mathbf{Q}^{\\mathsf{T}} = \\mathbf{Q}\\left(\\boldsymbol{\\sigma} - \\frac{1}{3}(\\mathrm{tr}\\,\\boldsymbol{\\sigma})\\mathbf{I}\\right)\\mathbf{Q}^{\\mathsf{T}} = \\mathbf{Q}\\boldsymbol{s}\\mathbf{Q}^{\\mathsf{T}}\n$$\n这表明偏应力张量 $\\boldsymbol{s}$ 与应力张量 $\\boldsymbol{\\sigma}$ 遵循相同的变换法则。\n旋转坐标系中的第二不变量 $J_2$ 是 $J'_2 = \\frac{1}{2}\\boldsymbol{s}':\\boldsymbol{s}'$。双点积定义为 $\\mathbf{A}:\\mathbf{B} = \\mathrm{tr}(\\mathbf{A}^{\\mathsf{T}}\\mathbf{B})$。对于对称张量 $\\boldsymbol{s}'$：\n$$\nJ'_2 = \\frac{1}{2}\\mathrm{tr}(\\boldsymbol{s}'\\boldsymbol{s}') = \\frac{1}{2}\\mathrm{tr}\\left((\\mathbf{Q}\\boldsymbol{s}\\mathbf{Q}^{\\mathsf{T}})(\\mathbf{Q}\\boldsymbol{s}\\mathbf{Q}^{\\mathsf{T}})\\right) = \\frac{1}{2}\\mathrm{tr}(\\mathbf{Q}\\boldsymbol{s}^2\\mathbf{Q}^{\\mathsf{T}})\n$$\n利用迹的循环性质：\n$$\nJ'_2 = \\frac{1}{2}\\mathrm{tr}(\\boldsymbol{s}^2\\mathbf{Q}^{\\mathsf{T}}\\mathbf{Q}) = \\frac{1}{2}\\mathrm{tr}(\\boldsymbol{s}^2\\mathbf{I}) = \\frac{1}{2}\\mathrm{tr}(\\boldsymbol{s}^2) = \\frac{1}{2}\\boldsymbol{s}:\\boldsymbol{s} = J_2\n$$\n这证实了 $J_2$ 是一个旋转不变量。其值与坐标系的朝向无关，因此也与 $\\theta$ 无关。\n\n为了求出其以给定应力分量表示的表达式，我们可以在原始的、未旋转的基 $\\{\\mathbf{e}_x, \\mathbf{e}_y, \\mathbf{e}_z\\}$ 中进行计算。\n首先，我们求 $\\boldsymbol{\\sigma}$ 的迹：\n$$\n\\mathrm{tr}\\,\\boldsymbol{\\sigma} = \\sigma_x + \\sigma_y + 0 = \\sigma_x + \\sigma_y\n$$\n接下来，我们构造偏应力张量 $\\boldsymbol{s}$：\n$$\n\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}(\\sigma_x+\\sigma_y)\\mathbf{I} = \\begin{pmatrix} \\sigma_x & \\tau_{xy} & 0 \\\\ \\tau_{xy} & \\sigma_y & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} - \\frac{\\sigma_x+\\sigma_y}{3}\\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{s} = \\begin{pmatrix} \\sigma_x - \\frac{\\sigma_x+\\sigma_y}{3} & \\tau_{xy} & 0 \\\\ \\tau_{xy} & \\sigma_y - \\frac{\\sigma_x+\\sigma_y}{3} & 0 \\\\ 0 & 0 & -\\frac{\\sigma_x+\\sigma_y}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{2\\sigma_x-\\sigma_y}{3} & \\tau_{xy} & 0 \\\\ \\tau_{xy} & \\frac{2\\sigma_y-\\sigma_x}{3} & 0 \\\\ 0 & 0 & -\\frac{\\sigma_x+\\sigma_y}{3} \\end{pmatrix}\n$$\n不变量 $J_2$ 由 $\\boldsymbol{s}$ 各分量的平方和计算得出：$J_2 = \\frac{1}{2}s_{ij}s_{ij} = \\frac{1}{2}(s_{xx}^2 + s_{yy}^2 + s_{zz}^2 + 2s_{xy}^2)$。\n$$\ns_{xx}^2 = \\left(\\frac{2\\sigma_x-\\sigma_y}{3}\\right)^2 = \\frac{1}{9}(4\\sigma_x^2 - 4\\sigma_x\\sigma_y + \\sigma_y^2)\n$$\n$$\ns_{yy}^2 = \\left(\\frac{2\\sigma_y-\\sigma_x}{3}\\right)^2 = \\frac{1}{9}(4\\sigma_y^2 - 4\\sigma_x\\sigma_y + \\sigma_x^2)\n$$\n$$\ns_{zz}^2 = \\left(-\\frac{\\sigma_x+\\sigma_y}{3}\\right)^2 = \\frac{1}{9}(\\sigma_x^2 + 2\\sigma_x\\sigma_y + \\sigma_y^2)\n$$\n$$\n2s_{xy}^2 = 2\\tau_{xy}^2\n$$\n对角分量的平方和为：\n$$\ns_{xx}^2 + s_{yy}^2 + s_{zz}^2 = \\frac{1}{9}\\left[ (4\\sigma_x^2 + \\sigma_x^2 + \\sigma_x^2) + (\\sigma_y^2 + 4\\sigma_y^2 + \\sigma_y^2) + (-4\\sigma_x\\sigma_y - 4\\sigma_x\\sigma_y + 2\\sigma_x\\sigma_y) \\right]\n$$\n$$\n= \\frac{1}{9}\\left[ 6\\sigma_x^2 + 6\\sigma_y^2 - 6\\sigma_x\\sigma_y \\right] = \\frac{2}{3}(\\sigma_x^2 + \\sigma_y^2 - \\sigma_x\\sigma_y)\n$$\n最后，我们整合出 $J_2$ 的表达式：\n$$\nJ_2 = \\frac{1}{2} \\left[ \\frac{2}{3}(\\sigma_x^2 + \\sigma_y^2 - \\sigma_x\\sigma_y) + 2\\tau_{xy}^2 \\right] = \\frac{1}{3}(\\sigma_x^2 + \\sigma_y^2 - \\sigma_x\\sigma_y) + \\tau_{xy}^2\n$$\n这就是所要求的偏应力第二不变量的闭式表达式。", "answer": "$$\\boxed{\\frac{1}{3}(\\sigma_x^{2} + \\sigma_y^{2} - \\sigma_x\\sigma_y) + \\tau_{xy}^{2}}$$", "id": "2922615"}, {"introduction": "在掌握了张量不变量的基本概念后，下一个关键问题是“我们如何运用它们？”。这个练习将带你进入非线性弹性力学的核心领域，通过对比两种经典的超弹性材料模型——新胡克（neo-Hookean）模型和Mooney-Rivlin模型，来探索如何利用应变不变量构建本构关系。你将通过分析简单剪切变形下的应力响应，推导出不同模型参数间的等效关系，从而深刻理解本构理论如何将抽象的数学不变量与具体的材料力学行为联系起来。[@problem_id:2922633]", "problem": "一个不可压缩的各向同性超弹性固体，其特性由依赖于右 Cauchy–Green 变形张量的等容不变量的等容应变能密度函数所描述。考虑由以下等容能量定义的两个模型：\n- 模型 A (广义 neo-Hookean): $W_{A} = \\dfrac{\\mu}{2}\\left(\\bar{I}_{1} - 3\\right)$。\n- 模型 B (双参数 Mooney–Rivlin): $W_{B} = C_{1}\\left(\\bar{I}_{1} - 3\\right) + C_{2}\\left(\\bar{I}_{2} - 3\\right)$。\n此处 $\\bar{I}_{1}$ 和 $\\bar{I}_{2}$ 是等容不变量，由右 Cauchy–Green 张量 $C$ 的主不变量 $I_{1}$ 和 $I_{2}$ 通过 $\\bar{I}_{1} = J^{-2/3} I_{1}$ 和 $\\bar{I}_{2} = J^{-4/3} I_{2}$ 获得，其中 $J = \\det F$，$F$ 是变形梯度。\n\n该物体承受大小为 $\\gamma$ 的简单剪切，其变形梯度如下：\n$$\nF = \\begin{pmatrix}\n1 & \\gamma & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix},\n$$\n且运动是等容的，因此 $\\det F = 1$ 成立。仅使用变形张量、不变量以及不可压缩各向同性材料的超弹性本构关系的基本定义，推导出每个模型中 Cauchy 应力的剪切分量 $\\sigma_{12}$ 作为 $\\gamma$ 和模型参数的函数。然后，施加条件，要求两个模型对于所有 $\\gamma$ 都产生相同的剪切响应（即，对于两个模型，整个函数 $\\sigma_{12}(\\gamma)$ 是相同的）。确定保证此等式成立的、用 $C_{1}$ 和 $C_{2}$ 表示的 $\\mu$ 的解析表达式。将您的最终答案表示为单个闭式表达式。无需进行数值计算或四舍五入。", "solution": "该问题要求在两个模型对任意大小 $\\gamma$ 的简单剪切变形都预测相同剪切应力响应的条件下，推导广义 neo-Hookean 模型的材料参数 $\\mu$ 关于 Mooney-Rivlin 模型参数 $C_{1}$ 和 $C_{2}$ 的表达式。\n\n问题陈述的验证已经完成。该问题具有科学依据、是适定的、客观且内部一致的。这是非线性弹性理论中的一个标准问题。我们可以开始求解。\n\n该变形为简单剪切，由变形梯度张量 $F$ 描述：\n$$\nF = \\begin{pmatrix}\n1 & \\gamma & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\n问题陈述该运动是等容的，意味着没有体积变化。我们通过计算 $F$ 的行列式（记为 $J$）来验证这一点：\n$$\nJ = \\det(F) = 1(1 \\cdot 1 - 0 \\cdot 0) - \\gamma(0 \\cdot 1 - 0 \\cdot 0) + 0 = 1\n$$\n这证实了变形的等容性质。因此，修正不变量 $\\bar{I}_{1}$ 和 $\\bar{I}_{2}$ 与主不变量 $I_{1}$ 和 $I_{2}$ 相同：\n$$\n\\bar{I}_{1} = J^{-2/3} I_{1} = 1^{-2/3} I_{1} = I_{1}\n$$\n$$\n\\bar{I}_{2} = J^{-4/3} I_{2} = 1^{-4/3} I_{2} = I_{2}\n$$\n因此，应变能密度函数可以写成用 $I_{1}$ 和 $I_{2}$ 表示的形式。\n模型 A: $W_{A} = \\dfrac{\\mu}{2}(I_{1} - 3)$。\n模型 B: $W_{B} = C_{1}(I_{1} - 3) + C_{2}(I_{2} - 3)$。\n\n为了确定应力，我们需要左 Cauchy-Green 变形张量 $B = F F^{T}$。\n$$\nB = F F^{T} = \\begin{pmatrix}\n1 & \\gamma & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n\\gamma & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n= \\begin{pmatrix}\n1 + \\gamma^{2} & \\gamma & 0 \\\\\n\\gamma & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\n主不变量 $I_{1}$ 和 $I_{2}$ 从 $B$ 计算得出。\n$$\nI_{1} = \\text{tr}(B) = (1 + \\gamma^{2}) + 1 + 1 = 3 + \\gamma^{2}\n$$\n$$\nI_{2} = \\frac{1}{2} \\left[ (\\text{tr}(B))^{2} - \\text{tr}(B^{2}) \\right]\n$$\n或者，$I_{2}$ 是 $B$ 的主子式之和：\n$$\nI_{2} = \\det \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} + \\det \\begin{pmatrix} 1+\\gamma^{2} & 0 \\\\ 0 & 1 \\end{pmatrix} + \\det \\begin{pmatrix} 1+\\gamma^{2} & \\gamma \\\\ \\gamma & 1 \\end{pmatrix}\n= 1 + (1+\\gamma^{2}) + ((1+\\gamma^{2}) - \\gamma^{2}) = 1 + 1 + \\gamma^{2} + 1 = 3 + \\gamma^{2}\n$$\n对于不可压缩的各向同性超弹性材料，Cauchy 应力张量 $\\sigma$ 由下式给出：\n$$\n\\sigma = -pI + 2 \\frac{\\partial W}{\\partial I_{1}} B - 2 \\frac{\\partial W}{\\partial I_{2}} B^{-1}\n$$\n其中 $p$ 是任意静水压力，$I$ 是单位张量。我们定义 $W_{1} = \\partial W / \\partial I_{1}$ 和 $W_{2} = \\partial W / \\partial I_{2}$。剪切分量 $\\sigma_{12}$ 为：\n$$\n\\sigma_{12} = 2 W_{1} B_{12} - 2 W_{2} (B^{-1})_{12}\n$$\n我们需要求 $B^{-1}$。$B$ 的行列式为 $\\det(B) = (1+\\gamma^{2})(1) - \\gamma^{2} = 1$。其逆矩阵为：\n$$\nB^{-1} = \\frac{1}{\\det(B)} \\text{adj}(B) = \\begin{pmatrix}\n1 & -\\gamma & 0 \\\\\n-\\gamma & 1+\\gamma^{2} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\n$\\sigma_{12}$ 所需的分量是 $B_{12} = \\gamma$ 和 $(B^{-1})_{12} = -\\gamma$。将这些代入 $\\sigma_{12}$ 的表达式中：\n$$\n\\sigma_{12} = 2 W_{1} (\\gamma) - 2 W_{2} (-\\gamma) = 2\\gamma(W_{1} + W_{2})\n$$\n现在我们对每个模型进行计算。\n\n对于模型 A (广义 neo-Hookean)：\n$W_{A} = \\dfrac{\\mu}{2}(I_{1} - 3)$。\n关于不变量的导数为：\n$W_{A,1} = \\dfrac{\\partial W_{A}}{\\partial I_{1}} = \\dfrac{\\mu}{2}$\n$W_{A,2} = \\dfrac{\\partial W_{A}}{\\partial I_{2}} = 0$\n模型 A 的剪切应力为：\n$$\n\\sigma_{12,A} = 2\\gamma(W_{A,1} + W_{A,2}) = 2\\gamma\\left(\\frac{\\mu}{2} + 0\\right) = \\mu\\gamma\n$$\n\n对于模型 B (双参数 Mooney-Rivlin)：\n$W_{B} = C_{1}(I_{1} - 3) + C_{2}(I_{2} - 3)$。\n关于不变量的导数为：\n$W_{B,1} = \\dfrac{\\partial W_{B}}{\\partial I_{1}} = C_{1}$\n$W_{B,2} = \\dfrac{\\partial W_{B}}{\\partial I_{2}} = C_{2}$\n模型 B 的剪切应力为：\n$$\n\\sigma_{12,B} = 2\\gamma(W_{B,1} + W_{B,2}) = 2\\gamma(C_{1} + C_{2})\n$$\n\n问题要求两个模型对所有 $\\gamma$ 值产生相同的剪切响应。这意味着 $\\sigma_{12,A}(\\gamma) = \\sigma_{12,B}(\\gamma)$ 必须对任意 $\\gamma$ 成立。\n$$\n\\mu\\gamma = 2(C_{1} + C_{2})\\gamma\n$$\n为使此等式对任意非零 $\\gamma$ 均有效，$\\gamma$ 的系数必须相等：\n$$\n\\mu = 2(C_{1} + C_{2})\n$$\n这就是保证在简单剪切下两种材料模型的剪切应力分量 $\\sigma_{12}$ 相同的、用 $C_{1}$ 和 $C_{2}$ 表示的 $\\mu$ 的解析表达式。", "answer": "$$\n\\boxed{2(C_1 + C_2)}\n$$", "id": "2922633"}, {"introduction": "理论的正确性最终需要通过实践来检验。本练习要求你构建一个“数值片检验”（numerical patch test），这是一个在计算力学中用于验证本构模型正确性的标准方法。你将通过编程实践，验证一个可压缩的新胡克（neo-Hookean）材料模型是否满足“物质标架无关性”（即客观性）这一基本物理原理。这项任务不仅能巩固你对张量在刚体运动下如何变换的理解，还能让你掌握在开发和使用有限元软件时验证本构模型有效性的关键技能。[@problem_id:2922635]", "problem": "通过在均匀变形上叠加刚体运动，为超弹性材料模型中的柯西应力构建并实现一个标架无关性（也称客观性）的数值片检验，并验证计算出的应力通过旋转进行变换，而其标量不变量保持不变。\n\n您的推导必须基于以下基本定义和经过充分检验的公式。一个叠加的刚体运动由一个真-正交旋转张量 $\\mathbf{Q} \\in \\mathrm{SO}(3)$（满足 $\\mathbf{Q}^{\\mathsf{T}}\\mathbf{Q}=\\mathbf{I}$ 和 $\\det \\mathbf{Q}=1$）和一个任意的平移向量 $\\mathbf{c}$ 定义，作用于位形 $\\mathbf{x}$ 上，即 $\\mathbf{x}^{\\prime}=\\mathbf{Q}\\mathbf{x}+\\mathbf{c}$。对于一个变形梯度为 $\\mathbf{F}$ 的均匀变形，叠加的刚性旋转将 $\\mathbf{F}$ 变换为 $\\mathbf{F}^{\\prime}=\\mathbf{Q}\\mathbf{F}$，而平移 $\\mathbf{c}$ 不影响任何梯度，因此也不影响应力。考虑一个剪切模量为 $\\mu$、体积模量为 $\\kappa$ 的可压缩 neo-Hookean 材料，其柯西应力 $\\boldsymbol{\\sigma}$ 由下式给出\n$$\n\\boldsymbol{\\sigma}(\\mathbf{F})=\\frac{\\mu}{J}\\left(\\mathbf{b}-\\mathbf{I}\\right)+\\frac{\\kappa \\,\\ln J}{J}\\,\\mathbf{I}\n$$\n其中 $J=\\det \\mathbf{F}$ 且 $\\mathbf{b}=\\mathbf{F}\\mathbf{F}^{\\mathsf{T}}$。所有使用的角度必须以弧度为单位。\n\n您的程序必须：\n- 对于下面指定的每个测试用例，计算 $\\boldsymbol{\\sigma}(\\mathbf{F})$ 和 $\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime})$，其中 $\\mathbf{F}^{\\prime}=\\mathbf{Q}\\mathbf{F}$。\n- 验证应力的旋转协变性，即\n$$\n\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime}) \\stackrel{?}{=} \\mathbf{Q}\\,\\boldsymbol{\\sigma}(\\mathbf{F})\\,\\mathbf{Q}^{\\mathsf{T}}.\n$$\n- 验证柯西应力主不变量在旋转下的不变性。将一个二阶张量 $\\mathbf{A}$ 的第一、第二和第三主不变量定义为\n$$\nI_{1}(\\mathbf{A})=\\operatorname{tr}(\\mathbf{A}),\\quad\nI_{2}(\\mathbf{A})=\\tfrac{1}{2}\\big(\\operatorname{tr}(\\mathbf{A})^{2}-\\operatorname{tr}(\\mathbf{A}^{2})\\big),\\quad\nI_{3}(\\mathbf{A})=\\det(\\mathbf{A}).\n$$\n检查对于 $k\\in\\{1,2,3\\}$，$I_{k}\\big(\\boldsymbol{\\sigma}(\\mathbf{F})\\big)$ 和 $I_{k}\\big(\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime})\\big)$ 在数值容差范围内是否一致。\n\n使用以下旋转参数化。令\n$$\n\\mathbf{R}_{x}(\\alpha)=\n\\begin{bmatrix}\n1 & 0 & 0\\\\\n0 & \\cos\\alpha & -\\sin\\alpha\\\\\n0 & \\sin\\alpha & \\cos\\alpha\n\\end{bmatrix},\\quad\n\\mathbf{R}_{y}(\\beta)=\n\\begin{bmatrix}\n\\cos\\beta & 0 & \\sin\\beta\\\\\n0 & 1 & 0\\\\\n-\\sin\\beta & 0 & \\cos\\beta\n\\end{bmatrix},\\quad\n\\mathbf{R}_{z}(\\gamma)=\n\\begin{bmatrix}\n\\cos\\gamma & -\\sin\\gamma & 0\\\\\n\\sin\\gamma & \\cos\\gamma & 0\\\\\n0 & 0 & 1\n\\end{bmatrix}.\n$$\n\n测试套件（角度以弧度为单位；所有矩阵均为无量纲；平移向量与梯度无关，可以忽略）：\n- 用例 1：\n  - $\\mu=12.0$，$\\kappa=120.0$，\n  - $\\mathbf{F}=\\begin{bmatrix}1.2 & 0.3 & 0.0\\\\ 0.1 & 0.9 & 0.2\\\\ 0.0 & -0.1 & 1.1\\end{bmatrix}$，\n  - $\\mathbf{Q}=\\mathbf{R}_{z}(0.7)$。\n- 用例 2：\n  - $\\mu=5.0$，$\\kappa=250.0$，\n  - $\\mathbf{F}=\\begin{bmatrix}1.0 & 0.5 & 0.0\\\\ 0.0 & 1.0 & 0.0\\\\ 0.0 & 0.0 & 1.0\\end{bmatrix}$，\n  - $\\mathbf{Q}=\\mathbf{R}_{z}(1.1)\\,\\mathbf{R}_{y}(-0.4)\\,\\mathbf{R}_{x}(0.3)$。\n- 用例 3：\n  - $\\mu=50.0$，$\\kappa=1500.0$，\n  - $\\mathbf{F}=\\begin{bmatrix}0.95 & 0.05 & 0.0\\\\ 0.0 & 1.10 & 0.02\\\\ 0.0 & -0.01 & 1.00\\end{bmatrix}$，\n  - $\\mathbf{Q}=\\mathbf{R}_{y}(0.6)$。\n- 用例 4：\n  - $\\mu=40.0$，$\\kappa=200.0$，\n  - $\\mathbf{F}=\\mathbf{R}_{x}(1.2)$，\n  - $\\mathbf{Q}=\\mathbf{R}_{y}(0.8)$。\n- 用例 5：\n  - $\\mu=30.0$，$\\kappa=90.0$，\n  - $\\mathbf{F}=\\begin{bmatrix}0.8 & 0.25 & 0.0\\\\ -0.15 & 1.05 & 0.1\\\\ 0.0 & -0.05 & 1.2\\end{bmatrix}$，\n  - $\\mathbf{Q}=\\mathbf{R}_{z}(-0.9)\\,\\mathbf{R}_{x}(0.4)$。\n\n数值验证标准：\n- 将旋转协变性的 Frobenius 范数误差定义为\n$$\ne_{\\mathrm{cov}}=\\frac{\\left\\|\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime})-\\mathbf{Q}\\,\\boldsymbol{\\sigma}(\\mathbf{F})\\,\\mathbf{Q}^{\\mathsf{T}}\\right\\|_{F}}{1+\\left\\|\\boldsymbol{\\sigma}(\\mathbf{F})\\right\\|_{F}+\\left\\|\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime})\\right\\|_{F}}.\n$$\n- 将 $k\\in\\{1,2,3\\}$ 的不变量误差定义为\n$$\ne_{I_{k}}=\\frac{\\left|I_{k}\\big(\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime})\\big)-I_{k}\\big(\\boldsymbol{\\sigma}(\\mathbf{F})\\big)\\right|}{1+\\left|I_{k}\\big(\\boldsymbol{\\sigma}(\\mathbf{F})\\big)\\right|+\\left|I_{k}\\big(\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime})\\big)\\right|}.\n$$\n- 使用标量容差 $\\varepsilon=10^{-10}$。如果一个用例满足 $e_{\\mathrm{cov}}\\le \\varepsilon$ 且对于所有 $k\\in\\{1,2,3\\}$ 都有 $e_{I_{k}}\\le \\varepsilon$，则该用例通过。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有五个用例的通过或失败结果，格式为一个逗号分隔的 Python 风格的布尔值列表，并用方括号括起来，例如 $[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{True},\\mathrm{False}]$。", "solution": "该问题要求为给定的可压缩 neo-Hookean 超弹性材料模型，构建并实现一个数值片检验，以验证材料标架无关性原理（也称客观性原理）。该原理是连续介质力学中的一个基本公理，它指出描述材料行为的本构方程必须独立于观察者的参考系。\n\n观察者参考系的变化由一个随时间变化的刚体运动表示。当叠加在由位形场 $\\mathbf{x}(\\mathbf{X}, t)$ 描述的变形构形上时，新的位形由 $\\mathbf{x}^{\\prime}(\\mathbf{X}, t) = \\mathbf{Q}(t)\\mathbf{x}(\\mathbf{X}, t) + \\mathbf{c}(t)$ 给出，其中 $\\mathbf{Q}(t)$ 是一个真-正交旋转张量（即 $\\mathbf{Q}^{\\mathsf{T}}\\mathbf{Q}=\\mathbf{I}$ 且 $\\det\\mathbf{Q}=1$），$\\mathbf{c}(t)$ 是一个平移向量。\n\n变形梯度是位形场相对于参考构形坐标 $\\mathbf{X}$ 的梯度，它在这一叠加运动下会发生变换。由于平移 $\\mathbf{c}$在空间上是常数，它不影响梯度。变形梯度 $\\mathbf{F}$ 的变换法则是：\n$$\n\\mathbf{F}^{\\prime} = \\frac{\\partial \\mathbf{x}^{\\prime}}{\\partial \\mathbf{X}} = \\mathbf{Q} \\frac{\\partial \\mathbf{x}}{\\partial \\mathbf{X}} = \\mathbf{Q}\\mathbf{F}\n$$\n标架无关性原理要求柯西应力张量 $\\boldsymbol{\\sigma}$（一个在当前构形中测量的物理量）必须作为一个客观的二阶张量进行变换。这意味着它在新（旋转后）标架中的分量通过旋转张量 $\\mathbf{Q}$ 与其在旧标架中的分量相关联：\n$$\n\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime}) = \\mathbf{Q}\\,\\boldsymbol{\\sigma}(\\mathbf{F})\\,\\mathbf{Q}^{\\mathsf{T}}\n$$\n我们现在必须验证给定的可压缩 neo-Hookean 应力-应变关系是否满足此要求。柯西应力 $\\boldsymbol{\\sigma}$ 的本构方程如下：\n$$\n\\boldsymbol{\\sigma}(\\mathbf{F})=\\frac{\\mu}{J}\\left(\\mathbf{b}-\\mathbf{I}\\right)+\\frac{\\kappa \\,\\ln J}{J}\\,\\mathbf{I}\n$$\n其中 $\\mu$ 是剪切模量，$\\kappa$ 是体积模量，$\\mathbf{I}$ 是二阶单位张量，$J = \\det \\mathbf{F}$ 是变形的体积部分，而 $\\mathbf{b} = \\mathbf{F}\\mathbf{F}^{\\mathsf{T}}$ 是左柯西-格林变形张量。\n\n让我们分析一下该方程中的各项在 $\\mathbf{F} \\to \\mathbf{F}^{\\prime} = \\mathbf{Q}\\mathbf{F}$ 的变换下的表现。\n首先，我们考察行列式 $J$ 的变换：\n$$\nJ^{\\prime} = \\det(\\mathbf{F}^{\\prime}) = \\det(\\mathbf{Q}\\mathbf{F}) = (\\det\\mathbf{Q})(\\det\\mathbf{F})\n$$\n由于 $\\mathbf{Q}$ 是真-旋转，$\\det\\mathbf{Q} = 1$。因此，$J^{\\prime} = J$。变形梯度的行列式在叠加的刚性旋转下是不变的。\n\n接下来，我们考察左柯西-格林张量 $\\mathbf{b}$ 的变换：\n$$\n\\mathbf{b}^{\\prime} = \\mathbf{F}^{\\prime}(\\mathbf{F}^{\\prime})^{\\mathsf{T}} = (\\mathbf{Q}\\mathbf{F})(\\mathbf{Q}\\mathbf{F})^{\\mathsf{T}} = (\\mathbf{Q}\\mathbf{F})(\\mathbf{F}^{\\mathsf{T}}\\mathbf{Q}^{\\mathsf{T}}) = \\mathbf{Q}(\\mathbf{F}\\mathbf{F}^{\\mathsf{T}})\\mathbf{Q}^{\\mathsf{T}} = \\mathbf{Q}\\mathbf{b}\\mathbf{Q}^{\\mathsf{T}}\n$$\n现在，我们可以写出新标架中的应力表达式 $\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime})$：\n$$\n\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime}) = \\frac{\\mu}{J^{\\prime}}\\left(\\mathbf{b}^{\\prime}-\\mathbf{I}\\right)+\\frac{\\kappa \\,\\ln J^{\\prime}}{J^{\\prime}}\\,\\mathbf{I}\n$$\n代入变换后的量 $J^{\\prime}=J$ 和 $\\mathbf{b}^{\\prime}=\\mathbf{Q}\\mathbf{b}\\mathbf{Q}^{\\mathsf{T}}$：\n$$\n\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime}) = \\frac{\\mu}{J}\\left(\\mathbf{Q}\\mathbf{b}\\mathbf{Q}^{\\mathsf{T}}-\\mathbf{I}\\right)+\\frac{\\kappa \\,\\ln J}{J}\\,\\mathbf{I}\n$$\n利用单位张量 $\\mathbf{I}$ 的各向同性，即 $\\mathbf{I} = \\mathbf{Q}\\mathbf{I}\\mathbf{Q}^{\\mathsf{T}}$，我们可以将该方程重写为：\n$$\n\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime}) = \\frac{\\mu}{J}\\left(\\mathbf{Q}\\mathbf{b}\\mathbf{Q}^{\\mathsf{T}}-\\mathbf{Q}\\mathbf{I}\\mathbf{Q}^{\\mathsf{T}}\\right)+\\frac{\\kappa \\,\\ln J}{J}\\,\\mathbf{Q}\\mathbf{I}\\mathbf{Q}^{\\mathsf{T}}\n$$\n通过在左侧提出因子 $\\mathbf{Q}$ 并在右侧提出因子 $\\mathbf{Q}^{\\mathsf{T}}$，我们得到：\n$$\n\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime}) = \\mathbf{Q} \\left[ \\frac{\\mu}{J}\\left(\\mathbf{b}-\\mathbf{I}\\right)+\\frac{\\kappa \\,\\ln J}{J}\\,\\mathbf{I} \\right] \\mathbf{Q}^{\\mathsf{T}}\n$$\n方括号中的表达式恰好是原始的应力张量 $\\boldsymbol{\\sigma}(\\mathbf{F})$。因此，我们证明了：\n$$\n\\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime}) = \\mathbf{Q}\\,\\boldsymbol{\\sigma}(\\mathbf{F})\\,\\mathbf{Q}^{\\mathsf{T}}\n$$\n这个解析结果证实了可压缩 neo-Hookean 材料模型是标架无关的。\n\n问题的第二部分是验证柯西应力张量主标量不变量的不变性。张量的主不变量是标量，其值不依赖于表示该张量所用的坐标系。对于二阶张量 $\\mathbf{A}$，变换 $\\mathbf{A}^{\\prime} = \\mathbf{Q}\\mathbf{A}\\mathbf{Q}^{\\mathsf{T}}$ 对应于基的变换。在这样的变换下，不变量必须保持不变。\n三个主不变量由下式给出：\n$$\nI_{1}(\\mathbf{A})=\\operatorname{tr}(\\mathbf{A}),\\quad\nI_{2}(\\mathbf{A})=\\tfrac{1}{2}\\big(\\operatorname{tr}(\\mathbf{A})^{2}-\\operatorname{tr}(\\mathbf{A}^{2})\\big),\\quad\nI_{3}(\\mathbf{A})=\\det(\\mathbf{A}).\n$$\n让我们验证它们对于 $\\boldsymbol{\\sigma}^{\\prime} = \\mathbf{Q}\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}}$ 的不变性。\n- 第一不变量：利用迹的轮换性质 $\\operatorname{tr}(\\mathbf{ABC}) = \\operatorname{tr}(\\mathbf{BCA})$。\n$$\nI_{1}(\\boldsymbol{\\sigma}^{\\prime}) = \\operatorname{tr}(\\mathbf{Q}\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}}) = \\operatorname{tr}(\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}}\\mathbf{Q}) = \\operatorname{tr}(\\boldsymbol{\\sigma}\\mathbf{I}) = \\operatorname{tr}(\\boldsymbol{\\sigma}) = I_{1}(\\boldsymbol{\\sigma})\n$$\n- 第三不变量：利用性质 $\\det(\\mathbf{ABC}) = \\det(\\mathbf{A})\\det(\\mathbf{B})\\det(\\mathbf{C})$。\n$$\nI_{3}(\\boldsymbol{\\sigma}^{\\prime}) = \\det(\\mathbf{Q}\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}}) = \\det(\\mathbf{Q})\\det(\\boldsymbol{\\sigma})\\det(\\mathbf{Q}^{\\mathsf{T}}) = (1)\\det(\\boldsymbol{\\sigma})(1) = \\det(\\boldsymbol{\\sigma}) = I_{3}(\\boldsymbol{\\sigma})\n$$\n- 第二不变量：我们首先需要计算 $\\operatorname{tr}((\\boldsymbol{\\sigma}^{\\prime})^2)$。\n$$\n(\\boldsymbol{\\sigma}^{\\prime})^2 = (\\mathbf{Q}\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}})(\\mathbf{Q}\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}}) = \\mathbf{Q}\\boldsymbol{\\sigma}(\\mathbf{Q}^{\\mathsf{T}}\\mathbf{Q})\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}} = \\mathbf{Q}\\boldsymbol{\\sigma}\\mathbf{I}\\boldsymbol{\\sigma}\\mathbf{Q}^{\\mathsf{T}} = \\mathbf{Q}\\boldsymbol{\\sigma}^2\\mathbf{Q}^{\\mathsf{T}}\n$$\n于是，$\\operatorname{tr}((\\boldsymbol{\\sigma}^{\\prime})^2) = \\operatorname{tr}(\\mathbf{Q}\\boldsymbol{\\sigma}^2\\mathbf{Q}^{\\mathsf{T}}) = \\operatorname{tr}(\\boldsymbol{\\sigma}^2\\mathbf{Q}^{\\mathsf{T}}\\mathbf{Q}) = \\operatorname{tr}(\\boldsymbol{\\sigma}^2)$。由于 $I_{1}(\\boldsymbol{\\sigma}^{\\prime}) = I_{1}(\\boldsymbol{\\sigma})$ 且 $\\operatorname{tr}((\\boldsymbol{\\sigma}^{\\prime})^2) = \\operatorname{tr}(\\boldsymbol{\\sigma}^2)$，从定义可以直接得出 $I_{2}(\\boldsymbol{\\sigma}^{\\prime}) = I_{2}(\\boldsymbol{\\sigma})$。\n\n数值实现将通过为每个测试用例计算这些量，并使用提供的误差度量和容差进行比较来进行。\n对于每个测试用例 $(\\mu, \\kappa, \\mathbf{F}, \\mathbf{Q})$：\n1.  计算 $\\boldsymbol{\\sigma}_{orig} = \\boldsymbol{\\sigma}(\\mathbf{F})$。\n2.  计算 $\\mathbf{F}^{\\prime} = \\mathbf{Q}\\mathbf{F}$。\n3.  计算 $\\boldsymbol{\\sigma}_{trans} = \\boldsymbol{\\sigma}(\\mathbf{F}^{\\prime})$。\n4.  计算预期的变换后应力 $\\boldsymbol{\\sigma}_{exp} = \\mathbf{Q}\\,\\boldsymbol{\\sigma}_{orig}\\,\\mathbf{Q}^{\\mathsf{T}}$。\n5.  评估协变性误差 $e_{\\mathrm{cov}} = \\frac{\\left\\|\\boldsymbol{\\sigma}_{trans}-\\boldsymbol{\\sigma}_{exp}\\right\\|_{F}}{1+\\left\\|\\boldsymbol{\\sigma}_{orig}\\right\\|_{F}+\\left\\|\\boldsymbol{\\sigma}_{trans}\\right\\|_{F}}$。\n6.  计算不变量 $I_k(\\boldsymbol{\\sigma}_{orig})$ 和 $I_k(\\boldsymbol{\\sigma}_{trans})$，其中 $k \\in \\{1, 2, 3\\}$。\n7.  评估不变量误差 $e_{I_{k}} = \\frac{|I_{k}(\\boldsymbol{\\sigma}_{trans}) - I_{k}(\\boldsymbol{\\sigma}_{orig})|}{1+|I_{k}(\\boldsymbol{\\sigma}_{orig})|+|I_{k}(\\boldsymbol{\\sigma}_{trans})|}$。\n8.  如果 $e_{\\mathrm{cov}} \\le 10^{-10}$ 且对所有 $k$ 都有 $e_{I_k} \\le 10^{-10}$，则测试用例通过。\n最终输出将是一个布尔值列表，表示每个用例的通过/失败状态。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a numerical patch test for frame-indifference of Cauchy stress\n    in a compressible neo-Hookean material model.\n    \"\"\"\n    TOLERANCE = 1e-10\n\n    def _build_rotation_matrix(x=0.0, y=0.0, z=0.0):\n        \"\"\"\n        Constructs a 3D rotation matrix from Euler angles (Z-Y-X convention).\n        The input Q_params order of keys does not matter, the composition order is fixed.\n        For Case 2: Q = Rz Ry Rx\n        For Case 5: Q = Rz Rx\n        \"\"\"\n        c_x, s_x = np.cos(x), np.sin(x)\n        c_y, s_y = np.cos(y), np.sin(y)\n        c_z, s_z = np.cos(z), np.sin(z)\n\n        Rx = np.array([[1, 0, 0], [0, c_x, -s_x], [0, s_x, c_x]])\n        Ry = np.array([[c_y, 0, s_y], [0, 1, 0], [-s_y, 0, c_y]])\n        Rz = np.array([[c_z, -s_z, 0], [s_z, c_z, 0], [0, 0, 1]])\n        \n        # Composition order: a vector is first rotated about x, then y, then z.\n        # The composite rotation matrix is Q = Rz @ Ry @ Rx.\n        return Rz @ Ry @ Rx\n\n    test_cases = [\n        {\n            \"mu\": 12.0, \"kappa\": 120.0,\n            \"F\": np.array([[1.2, 0.3, 0.0], [0.1, 0.9, 0.2], [0.0, -0.1, 1.1]]),\n            \"Q_params\": {\"z\": 0.7}\n        },\n        {\n            \"mu\": 5.0, \"kappa\": 250.0,\n            \"F\": np.array([[1.0, 0.5, 0.0], [0.0, 1.0, 0.0], [0.0, 0.0, 1.0]]),\n            \"Q_params\": {\"z\": 1.1, \"y\": -0.4, \"x\": 0.3}\n        },\n        {\n            \"mu\": 50.0, \"kappa\": 1500.0,\n            \"F\": np.array([[0.95, 0.05, 0.0], [0.0, 1.10, 0.02], [0.0, -0.01, 1.00]]),\n            \"Q_params\": {\"y\": 0.6}\n        },\n        {\n            \"mu\": 40.0, \"kappa\": 200.0,\n            \"F\": _build_rotation_matrix(x=1.2),\n            \"Q_params\": {\"y\": 0.8}\n        },\n        {\n            \"mu\": 30.0, \"kappa\": 90.0,\n            \"F\": np.array([[0.8, 0.25, 0.0], [-0.15, 1.05, 0.1], [0.0, -0.05, 1.2]]),\n            \"Q_params\": {\"z\": -0.9, \"x\": 0.4}\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        mu = case[\"mu\"]\n        kappa = case[\"kappa\"]\n        F = case[\"F\"]\n        Q = _build_rotation_matrix(**case[\"Q_params\"])\n\n        # Compute stresses\n        sigma_orig = _compute_cauchy_stress(F, mu, kappa)\n        F_prime = Q @ F\n        sigma_trans = _compute_cauchy_stress(F_prime, mu, kappa)\n\n        # Check rotational covariance\n        sigma_exp = Q @ sigma_orig @ Q.T\n        \n        # Calculate covariance error\n        cov_num = np.linalg.norm(sigma_trans - sigma_exp, 'fro')\n        cov_den = 1.0 + np.linalg.norm(sigma_orig, 'fro') + np.linalg.norm(sigma_trans, 'fro')\n        e_cov = cov_num / cov_den\n        \n        # Check invariance of principal invariants\n        I_orig = _compute_invariants(sigma_orig)\n        I_trans = _compute_invariants(sigma_trans)\n        \n        e_I = []\n        for k in range(3):\n            inv_num = abs(I_trans[k] - I_orig[k])\n            inv_den = 1.0 + abs(I_orig[k]) + abs(I_trans[k])\n            e_I.append(inv_num / inv_den)\n\n        # Verify against tolerance\n        passed = e_cov = TOLERANCE and all(err = TOLERANCE for err in e_I)\n        results.append(passed)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef _compute_cauchy_stress(F, mu, kappa):\n    \"\"\"\n    Computes Cauchy stress for a compressible neo-Hookean material.\n    sigma = (mu/J)*(b - I) + (kappa*ln(J)/J)*I\n    \"\"\"\n    J = np.linalg.det(F)\n    if J = 0:\n        raise ValueError(\"Deformation gradient must have a positive determinant.\")\n        \n    b = F @ F.T\n    I = np.identity(3)\n    \n    # deviatoric part + volumetric part\n    sigma = (mu / J) * (b - I) + (kappa * np.log(J) / J) * I\n    return sigma\n\ndef _compute_invariants(A):\n    \"\"\"\n    Computes the three principal invariants of a 3x3 matrix A.\n    I1 = tr(A)\n    I2 = 1/2 * (tr(A)^2 - tr(A^2))\n    I3 = det(A)\n    \"\"\"\n    I1 = np.trace(A)\n    I2 = 0.5 * (np.trace(A)**2 - np.trace(A @ A))\n    I3 = np.linalg.det(A)\n    return I1, I2, I3\n\nsolve()\n```", "id": "2922635"}]}