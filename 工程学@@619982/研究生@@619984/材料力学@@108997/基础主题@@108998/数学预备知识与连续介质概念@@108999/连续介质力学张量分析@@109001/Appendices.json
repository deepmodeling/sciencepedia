{"hands_on_practices": [{"introduction": "在连续介质力学中，我们必须超越纯粹基于分量的计算，为张量运算建立深刻的几何直观。本练习提供了一个基础实践，旨在将并矢积和双点积的抽象索引定义与向量投影这一直观的几何概念联系起来。掌握这种联系有助于更深刻地理解张量如何表示物理量及其相互作用 [@problem_id:2922055]。", "problem": "设 $\\mathcal{V}$ 是一个三维欧几里得向量空间，其标准内积 $\\boldsymbol{u}\\cdot\\boldsymbol{v}$ 由克罗内克δ $\\delta_{ij}$ 导出。对于向量 $\\boldsymbol{a},\\boldsymbol{b},\\boldsymbol{c}\\in\\mathcal{V}$，考虑二阶张量（并矢）积 $\\boldsymbol{a}\\otimes\\boldsymbol{b}$，其分量形式定义为 $(\\boldsymbol{a}\\otimes\\boldsymbol{b})_{ij}=a_{i}b_{j}$，以及两个二阶张量的双点积 $\\boldsymbol{A}:\\boldsymbol{B}$，其定义为 $\\boldsymbol{A}:\\boldsymbol{B}=A_{ij}B_{ij}$。\n\n仅从这些定义和内积的基本性质出发，计算标量\n$$\nS=(\\boldsymbol{a}\\otimes\\boldsymbol{b}):(\\boldsymbol{c}\\otimes\\boldsymbol{c})\n$$\n并将最终结果表示为仅包含 $\\boldsymbol{a}$、$\\boldsymbol{b}$ 和 $\\boldsymbol{c}$ 之间内积的闭式表达式。然后，根据向量 $\\boldsymbol{a}$、$\\boldsymbol{b}$、$\\boldsymbol{c}$ 的模长以及它们与向量 $\\boldsymbol{c}$ 的夹角，给出 $S$ 的几何解释。为了使您的解释更清晰，可以引入单位向量 $\\widehat{\\boldsymbol{c}}=\\boldsymbol{c}/\\|\\boldsymbol{c}\\|$。\n\n无需进行数值计算。最终答案必须是单个闭式解析表达式。请勿包含任何单位。无需进行舍入。", "solution": "问题陈述在科学上是合理的、适定的，并以足够的数学严谨性呈现。这是张量代数中的一个标准练习。我们将开始进行解答。\n\n该问题要求计算标量 $S = (\\boldsymbol{a}\\otimes\\boldsymbol{b}):(\\boldsymbol{c}\\otimes\\boldsymbol{c})$。题目给出了二阶张量积和双点积的分量形式定义，并假设在一个三维欧几里得空间 $\\mathcal{V}$ 中，内积由克罗内克δ $\\delta_{ij}$ 导出。\n\n设张量为 $\\boldsymbol{P} = \\boldsymbol{a}\\otimes\\boldsymbol{b}$ 和 $\\boldsymbol{Q} = \\boldsymbol{c}\\otimes\\boldsymbol{c}$。根据并矢积的定义，这些张量的分量为：\n$$\nP_{ij} = a_i b_j\n$$\n$$\nQ_{ij} = c_i c_j\n$$\n$S$ 的值可以通过应用双点积的定义 $\\boldsymbol{P}:\\boldsymbol{Q} = P_{ij}Q_{ij}$ 来求得，其中重复的下标表示求和（爱因斯坦求和约定）：\n$$\nS = P_{ij}Q_{ij} = (a_i b_j)(c_i c_j)\n$$\n由于分量 $a_i$、$b_j$、$c_i$ 和 $c_j$ 都是标量，我们可以对它们进行交换和重新组合：\n$$\nS = (a_i c_i)(b_j c_j)\n$$\n括号中的项是在具有标准正交基的欧几里得空间中标准内积的分量形式。具体而言，两个向量 $\\boldsymbol{u}$ 和 $\\boldsymbol{v}$ 的内积是 $\\boldsymbol{u}\\cdot\\boldsymbol{v} = u_k v_k$。因此，我们可以确定：\n$$\na_i c_i = \\sum_{i=1}^{3} a_i c_i = \\boldsymbol{a}\\cdot\\boldsymbol{c}\n$$\n$$\nb_j c_j = \\sum_{j=1}^{3} b_j c_j = \\boldsymbol{b}\\cdot\\boldsymbol{c}\n$$\n求和下标的选择（$i$ 或 $j$）是无关紧要的，因为它们是哑指标。将这些内积表达式代回 $S$ 的方程，即可得到所需形式的最终结果：\n$$\nS = (\\boldsymbol{a}\\cdot\\boldsymbol{c})(\\boldsymbol{b}\\cdot\\boldsymbol{c})\n$$\n这就完成了主要计算。\n\n对于几何解释，我们回顾内积根据向量模长和它们之间夹角的定义：$\\boldsymbol{u}\\cdot\\boldsymbol{v} = \\|\\boldsymbol{u}\\|\\|\\boldsymbol{v}\\|\\cos(\\theta_{\\boldsymbol{u}\\boldsymbol{v}})$。\n在我们关于 $S$ 的表达式中的两个内积是：\n$$\n\\boldsymbol{a}\\cdot\\boldsymbol{c} = \\|\\boldsymbol{a}\\|\\|\\boldsymbol{c}\\|\\cos(\\theta_{\\boldsymbol{a}\\boldsymbol{c}})\n$$\n$$\n\\boldsymbol{b}\\cdot\\boldsymbol{c} = \\|\\boldsymbol{b}\\|\\|\\boldsymbol{c}\\|\\cos(\\theta_{\\boldsymbol{b}\\boldsymbol{c}})\n$$\n其中 $\\theta_{\\boldsymbol{a}\\boldsymbol{c}}$ 和 $\\theta_{\\boldsymbol{b}\\boldsymbol{c}}$ 分别是相应向量对之间的夹角。\n\n使用单位向量 $\\widehat{\\boldsymbol{c}} = \\boldsymbol{c}/\\|\\boldsymbol{c}\\|$ 可以得到更清晰的解释。项 $\\boldsymbol{a}\\cdot\\widehat{\\boldsymbol{c}}$ 表示向量 $\\boldsymbol{a}$ 在向量 $\\boldsymbol{c}$ 方向上的标量投影。它是 $\\boldsymbol{a}$ 沿着包含 $\\boldsymbol{c}$ 的直线的分量的有符号大小。我们将此标量投影记为 $a_c = \\boldsymbol{a}\\cdot\\widehat{\\boldsymbol{c}}$。\n我们可以将内积 $\\boldsymbol{a}\\cdot\\boldsymbol{c}$ 重写为：\n$$\n\\boldsymbol{a}\\cdot\\boldsymbol{c} = \\boldsymbol{a}\\cdot(\\|\\boldsymbol{c}\\|\\widehat{\\boldsymbol{c}}) = \\|\\boldsymbol{c}\\|(\\boldsymbol{a}\\cdot\\widehat{\\boldsymbol{c}}) = \\|\\boldsymbol{c}\\|a_c\n$$\n类似地，对于向量 $\\boldsymbol{b}$，我们将其在 $\\boldsymbol{c}$ 方向上的标量投影定义为 $b_c = \\boldsymbol{b}\\cdot\\widehat{\\boldsymbol{c}}$，因此：\n$$\n\\boldsymbol{b}\\cdot\\boldsymbol{c} = \\|\\boldsymbol{c}\\| b_c\n$$\n将这些内积表达式代入我们关于 $S$ 的结果中：\n$$\nS = (\\|\\boldsymbol{c}\\|a_c)(\\|\\boldsymbol{c}\\|b_c) = \\|\\boldsymbol{c}\\|^2 a_c b_c\n$$\n这个表达式提供了一个清晰的几何解释：标量 $S$ 是向量 $\\boldsymbol{a}$ 和 $\\boldsymbol{b}$ 在向量 $\\boldsymbol{c}$ 方向上的标量投影的乘积，再乘以 $\\boldsymbol{c}$ 模长的平方。\n\n一种无坐标的替代验证方法是利用以下性质：对于任意二阶张量 $\\boldsymbol{T}$ 和向量 $\\boldsymbol{u}, \\boldsymbol{v}$，双点积为 $\\boldsymbol{T}:(\\boldsymbol{u}\\otimes\\boldsymbol{v}) = \\boldsymbol{u}\\cdot(\\boldsymbol{T}\\boldsymbol{v})$。令 $\\boldsymbol{T} = \\boldsymbol{a}\\otimes\\boldsymbol{b}$ 且 $\\boldsymbol{u}=\\boldsymbol{v}=\\boldsymbol{c}$。\n$$\nS = (\\boldsymbol{a}\\otimes\\boldsymbol{b}):(\\boldsymbol{c}\\otimes\\boldsymbol{c}) = \\boldsymbol{c}\\cdot((\\boldsymbol{a}\\otimes\\boldsymbol{b})\\boldsymbol{c})\n$$\n并矢作用于一个向量的结果由 $(\\boldsymbol{a}\\otimes\\boldsymbol{b})\\boldsymbol{c} = \\boldsymbol{a}(\\boldsymbol{b}\\cdot\\boldsymbol{c})$ 给出。代入此式可得：\n$$\nS = \\boldsymbol{c}\\cdot(\\boldsymbol{a}(\\boldsymbol{b}\\cdot\\boldsymbol{c}))\n$$\n由于 $\\boldsymbol{b}\\cdot\\boldsymbol{c}$ 是一个标量，它可以从内积中提出来：\n$$\nS = (\\boldsymbol{c}\\cdot\\boldsymbol{a})(\\boldsymbol{b}\\cdot\\boldsymbol{c})\n$$\n利用内积的交换律 $\\boldsymbol{c}\\cdot\\boldsymbol{a} = \\boldsymbol{a}\\cdot\\boldsymbol{c}$，我们证实了该结果：\n$$\nS = (\\boldsymbol{a}\\cdot\\boldsymbol{c})(\\boldsymbol{b}\\cdot\\boldsymbol{c})\n$$\n因此，这一结果是可靠且推导正确的。", "answer": "$$\n\\boxed{(\\boldsymbol{a}\\cdot\\boldsymbol{c})(\\boldsymbol{b}\\cdot\\boldsymbol{c})}\n$$", "id": "2922055"}, {"introduction": "内功耗散率，即功率密度，是连续介质热力学和本构模型中的核心概念。一个关键的洞见是，并非所有的应力张量和应变率张量都是“功率共轭”的，这意味着它们的直接乘积不一定能正确计算出功率密度。本练习通过一个精心设计的反例，阐明了为什么柯西应力张量 $\\boldsymbol{\\sigma}$ 和格林-拉格朗日应变张量的物质导数 $\\dot{\\boldsymbol{E}}$ 在空间描述下不构成一个功率共轭对，从而强化了对空间框架和物质框架之间关键区别的理解 [@problem_id:2922130]。", "problem": "连续介质力学中的一个核心概念是功率共轭对。考虑一个可压缩弹性体的均匀运动，其变形映射由 $\\boldsymbol{x}(\\boldsymbol{X},t)=\\boldsymbol{F}(t)\\,\\boldsymbol{X}$ 描述，其中变形梯度为 $\\boldsymbol{F}(t)=\\mathrm{diag}(\\exp(a t),\\,1,\\,1)$，$a$ 是一个单位为 $\\mathrm{s}^{-1}$ 的常数。设柯西应力张量为静水压力形式，$\\boldsymbol{\\sigma}(t)=p\\,\\boldsymbol{I}$，其中 $p>0$ 为常数。在一个质点上，单位当前体积的内机械功率定义为围绕该点的一个无穷小当前体积上的内功率的极限。\n\n任务：\n1) 从内功率定义为面力功率的体积分出发，利用柯西定理和角动量守恒，推导以柯西应力张量 $\\boldsymbol{\\sigma}$ 和速度梯度 $\\boldsymbol{L}=\\nabla\\boldsymbol{v}$ 表示的空间内功率密度，并将其表示为变形率张量 $\\boldsymbol{d}=\\tfrac{1}{2}(\\boldsymbol{L}+\\boldsymbol{L}^{\\mathsf{T}})$ 的形式。\n\n2) 使用 Green–Lagrange 应变张量的定义 $\\boldsymbol{E}=\\tfrac{1}{2}(\\boldsymbol{C}-\\boldsymbol{I})$（其中 $\\boldsymbol{C}=\\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}$），计算给定运动下的 $\\dot{\\boldsymbol{E}}$，并构造标量 $\\boldsymbol{\\sigma}:\\dot{\\boldsymbol{E}}$。将其与第 1 部分得到的正确空间功率密度 $\\boldsymbol{\\sigma}:\\boldsymbol{d}$进行比较，以确定 $\\boldsymbol{\\sigma}$ 和 $\\dot{\\boldsymbol{E}}$ 是否构成单位当前体积下的功率共轭对。\n\n3) 代入数值 $a=0.5\\,\\mathrm{s}^{-1}$，$p=100\\times 10^{6}\\,\\mathrm{Pa}$，计算在时间 $t=1.0\\,\\mathrm{s}$ 时的 $\\boldsymbol{\\sigma}:\\boldsymbol{d}$ 和 $\\boldsymbol{\\sigma}:\\dot{\\boldsymbol{E}}$。计算差值 \n$$\\Delta p=\\boldsymbol{\\sigma}:\\dot{\\boldsymbol{E}}-\\boldsymbol{\\sigma}:\\boldsymbol{d}.$$\n将 $\\Delta p$ 以 $\\mathrm{W/m^{3}}$ 为单位，四舍五入到四位有效数字，报告为一个实数。按要求以 $\\mathrm{W/m^{3}}$ 为单位说明最终结果；不要在方框内的最终答案中包含单位。", "solution": "所给问题是连续介质力学中的一个标准练习，要求推导功率密度并检验功率共轭对。该问题具有科学依据，提法恰当，并包含了所有必要信息。因此，该问题被认为是有效的，并将按所述进行求解。\n\n1) 空间内功率密度的推导。\n在边界为 $\\partial\\mathcal{V}$ 的当前材料体积 $\\mathcal{V}$ 内，内机械功率 $\\mathcal{P}_{int}$ 定义为表面面力的做功速率。\n$$ \\mathcal{P}_{int} = \\int_{\\partial\\mathcal{V}} \\boldsymbol{t} \\cdot \\boldsymbol{v} \\, dS $$\n此处，$\\boldsymbol{v}$ 是速度场，$\\boldsymbol{t}$ 是面元 $dS$ 上的面力矢量。根据柯西引理，面力与柯西应力张量 $\\boldsymbol{\\sigma}$ 的关系为 $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\boldsymbol{n}$，其中 $\\boldsymbol{n}$ 是表面的外法向单位矢量。将此代入功率积分可得：\n$$ \\mathcal{P}_{int} = \\int_{\\partial\\mathcal{V}} (\\boldsymbol{\\sigma}\\boldsymbol{n}) \\cdot \\boldsymbol{v} \\, dS $$\n用指标记法表示为 $\\int_{\\partial\\mathcal{V}} \\sigma_{ij}n_j v_i \\, dS = \\int_{\\partial\\mathcal{V}} v_i \\sigma_{ij} n_j \\, dS$。我们可以对分量为 $F_j = v_i \\sigma_{ij}$ 的矢量场应用散度定理。\n$$ \\int_{\\partial\\mathcal{V}} F_j n_j \\, dS = \\int_{\\mathcal{V}} \\frac{\\partial F_j}{\\partial x_j} \\, dV $$\n$$ \\mathcal{P}_{int} = \\int_{\\mathcal{V}} \\frac{\\partial (v_i \\sigma_{ij})}{\\partial x_j} \\, dV = \\int_{\\mathcal{V}} \\left( \\frac{\\partial v_i}{\\partial x_j} \\sigma_{ij} + v_i \\frac{\\partial \\sigma_{ij}}{\\partial x_j} \\right) dV $$\n根据柯西运动方程 $\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\rho \\dot{\\boldsymbol{v}}$，项 $v_i (\\partial \\sigma_{ij} / \\partial x_j)$ 代表惯性力和体积力的功率。单位当前体积的内功率 $p_{int}$，它对应于应力使材料变形所做的功的速率（即应力功率密度），是积分式中的第一项。\n$$ p_{int} = \\sigma_{ij} \\frac{\\partial v_i}{\\partial x_j} = \\boldsymbol{\\sigma} : (\\nabla \\boldsymbol{v})^{\\mathsf{T}} $$\n由于指标是哑指标，我们可以将其写为 $\\sigma_{ji} (\\partial v_j / \\partial x_i)$。用张量表示法，即为 $\\boldsymbol{\\sigma} : \\boldsymbol{L}$，其中 $\\boldsymbol{L} = \\nabla \\boldsymbol{v}$ 是空间速度梯度。\n$$ p_{int} = \\boldsymbol{\\sigma} : \\boldsymbol{L} $$\n速度梯度可以分解为其对称部分，即变形率张量 $\\boldsymbol{d} = \\frac{1}{2}(\\boldsymbol{L}+\\boldsymbol{L}^{\\mathsf{T}})$，和其反对称部分，即自旋张量 $\\boldsymbol{w} = \\frac{1}{2}(\\boldsymbol{L}-\\boldsymbol{L}^{\\mathsf{T}})$。\n$$ p_{int} = \\boldsymbol{\\sigma} : (\\boldsymbol{d} + \\boldsymbol{w}) = \\boldsymbol{\\sigma} : \\boldsymbol{d} + \\boldsymbol{\\sigma} : \\boldsymbol{w} $$\n根据角动量守恒，柯西应力张量 $\\boldsymbol{\\sigma}$ 必须是对称的，即 $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\mathsf{T}}$。一个对称张量与一个反对称张量的双点积为零。证明如下：$\\boldsymbol{\\sigma}:\\boldsymbol{w} = \\sigma_{ij}w_{ij}$。利用 $\\boldsymbol{\\sigma}$ 的对称性和 $\\boldsymbol{w}$ 的反对称性，我们有 $\\sigma_{ij} = \\sigma_{ji}$ 和 $w_{ij}=-w_{ji}$。因此，$\\sigma_{ij}w_{ij} = \\sigma_{ji}w_{ij}$。重新标记指标可得 $\\sigma_{ji}w_{ij} = \\sigma_{kl}w_{lk} = \\sigma_{kl}(-w_{kl}) = -\\sigma_{ij}w_{ij}$。这意味着 $2(\\boldsymbol{\\sigma}:\\boldsymbol{w})=0$，所以 $\\boldsymbol{\\sigma}:\\boldsymbol{w}=0$。\n因此，空间内功率密度完全由柯西应力与变形率张量的乘积给出。\n$$ p_{int} = \\boldsymbol{\\sigma} : \\boldsymbol{d} $$\n\n2) 功率共轭对的分析。\n给定的变形梯度为 $\\boldsymbol{F}(t) = \\mathrm{diag}(\\exp(at), 1, 1)$。右 Cauchy-Green 变形张量为 $\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}$。\n$$ \\boldsymbol{C} = \\begin{pmatrix} \\exp(at) & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} \\exp(at) & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} \\exp(2at) & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} $$\nGreen-Lagrange 应变张量为 $\\boldsymbol{E} = \\frac{1}{2}(\\boldsymbol{C}-\\boldsymbol{I})$。\n$$ \\boldsymbol{E} = \\frac{1}{2} \\left( \\begin{pmatrix} \\exp(2at) & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} - \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} \\exp(2at) - 1 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\nGreen-Lagrange 应变张量的率 $\\dot{\\boldsymbol{E}}$ 是其时间导数。\n$$ \\dot{\\boldsymbol{E}} = \\frac{d}{dt}\\boldsymbol{E} = \\frac{1}{2} \\begin{pmatrix} 2a\\exp(2at) & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} a\\exp(2at) & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\n指定的柯西应力是静水压力形式：$\\boldsymbol{\\sigma} = p\\boldsymbol{I}$。标量 $\\boldsymbol{\\sigma}:\\dot{\\boldsymbol{E}}$ 计算如下：\n$$ \\boldsymbol{\\sigma} : \\dot{\\boldsymbol{E}} = (p\\boldsymbol{I}) : \\dot{\\boldsymbol{E}} = p(\\boldsymbol{I} : \\dot{\\boldsymbol{E}}) = p\\,\\mathrm{tr}(\\dot{\\boldsymbol{E}}) = p(a\\exp(2at)) = pa\\exp(2at) $$\n现在，我们计算正确的空间功率密度 $\\boldsymbol{\\sigma}:\\boldsymbol{d}$。首先，我们求速度梯度 $\\boldsymbol{L} = \\dot{\\boldsymbol{F}}\\boldsymbol{F}^{-1}$。\n$$ \\dot{\\boldsymbol{F}} = \\frac{d}{dt}\\begin{pmatrix} \\exp(at) & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} a\\exp(at) & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\n$$ \\boldsymbol{F}^{-1} = \\begin{pmatrix} \\exp(-at) & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} $$\n$$ \\boldsymbol{L} = \\dot{\\boldsymbol{F}}\\boldsymbol{F}^{-1} = \\begin{pmatrix} a\\exp(at) & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} \\exp(-at) & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} a & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\n由于 $\\boldsymbol{L}$ 是对称的，所以 $\\boldsymbol{d} = \\boldsymbol{L}$ 且 $\\boldsymbol{w}=\\boldsymbol{0}$。空间功率密度为：\n$$ \\boldsymbol{\\sigma} : \\boldsymbol{d} = (p\\boldsymbol{I}) : \\boldsymbol{d} = p(\\boldsymbol{I} : \\boldsymbol{d}) = p\\,\\mathrm{tr}(\\boldsymbol{d}) = p(a) = pa $$\n比较这两个量，我们发现：\n$$ \\boldsymbol{\\sigma} : \\dot{\\boldsymbol{E}} = pa\\exp(2at) \\quad \\neq \\quad pa = \\boldsymbol{\\sigma} : \\boldsymbol{d} \\quad (\\text{for } t > 0) $$\n由于 $\\boldsymbol{\\sigma}:\\dot{\\boldsymbol{E}}$ 不等于单位当前体积的内功率密度 $\\boldsymbol{\\sigma}:\\boldsymbol{d}$，因此 $(\\boldsymbol{\\sigma}, \\dot{\\boldsymbol{E}})$ 对不构成单位当前体积下的功率共轭对。与 $\\dot{\\boldsymbol{E}}$ 正确共轭的应力是第二 Piola-Kirchhoff 应力张量 $\\boldsymbol{S}$，它产生单位*参考*体积的功率。\n\n3) 数值计算。\n给定 $a=0.5\\,\\mathrm{s}^{-1}$，$p=100\\times 10^{6}\\,\\mathrm{Pa}$，我们在 $t=1.0\\,\\mathrm{s}$ 时进行计算。\n正确的空间功率密度为：\n$$ \\boldsymbol{\\sigma}:\\boldsymbol{d} = pa = (100 \\times 10^{6}\\,\\mathrm{Pa}) \\times (0.5\\,\\mathrm{s}^{-1}) = 50 \\times 10^{6}\\,\\mathrm{W/m^{3}} $$\n量 $\\boldsymbol{\\sigma}:\\dot{\\boldsymbol{E}}$ 为：\n$$ \\boldsymbol{\\sigma}:\\dot{\\boldsymbol{E}} = pa\\exp(2at) = (50 \\times 10^{6})\\exp(2 \\times 0.5 \\times 1.0) = (50 \\times 10^{6})\\exp(1.0)\\,\\mathrm{W/m^{3}} $$\n差值 $\\Delta p$ 为：\n$$ \\Delta p = \\boldsymbol{\\sigma}:\\dot{\\boldsymbol{E}} - \\boldsymbol{\\sigma}:\\boldsymbol{d} = pa\\exp(2at) - pa = pa(\\exp(2at) - 1) $$\n代入数值：\n$$ \\Delta p = (50 \\times 10^{6}) (\\exp(1.0) - 1) = (50 \\times 10^{6}) (2.7182818... - 1) $$\n$$ \\Delta p = (50 \\times 10^{6}) (1.7182818...) = 85914091.4... \\,\\mathrm{W/m^{3}} $$\n将此结果四舍五入到四位有效数字，得到 $85910000\\,\\mathrm{W/m^{3}}$。按要求用标准科学记数法表示，即为 $8.591 \\times 10^7\\,\\mathrm{W/m^{3}}$。", "answer": "$$\\boxed{8.591 \\times 10^{7}}$$", "id": "2922130"}, {"introduction": "对称张量的谱定理是连续介质力学的理论基石，它为应力、应变等张量提供了主值和主方向。本动手实践将这个抽象的定理转化为具体的计算算法，这是现代分析和模拟的必要步骤。通过实现谱分解并诊断其数值稳定性，尤其是在处理重根或近似重根的特征值时，您将获得在计算环境中稳健处理张量数据的实用技能 [@problem_id:2922080]。", "problem": "实现一个程序，该程序针对一个实对称二阶张量 $A \\in \\mathbb{R}^{3 \\times 3}$，基于谱定理构建谱分解，评估投影算子性质并量化重构质量。实现必须从以下基本基础出发：线性变换的特征值和特征向量的定义、实对称张量的谱定理以及正交投影算子的定义。不得假定在这些基础之外给定了任何专门的简化公式；所有必需的计算步骤都必须从这些原理推导得出。\n\n对于每个测试张量 $A$，您的程序必须执行以下操作：\n- 计算特征值 $\\lambda_i$ 和一组相应的正交归一特征向量 $n_i$，其中 $i \\in \\{1,2,3\\}$。\n- 构建秩为一的本征投影算子 $P_i = n_i \\otimes n_i$，其中 $(P_i)_{jk} = (n_i)_j (n_i)_k$。\n- 将特征值分组为簇，以表示重复或数值上聚集的特征值。两个相邻的特征值 $\\lambda_i$ 和 $\\lambda_{i+1}$（按值排序后）如果满足 $|\\lambda_{i+1} - \\lambda_i| \\le \\tau$，则属于同一个簇，其中 $\\tau = a_{\\text{tol}} + r_{\\text{tol}} \\cdot \\max_j |\\lambda_j|$，$a_{\\text{tol}} = 10^{-12}$ 且 $r_{\\text{tol}} = 10^{-8}$。\n- 对于每个簇 $g$，定义簇投影算子 $P_g = \\sum_{i \\in g} P_i$ 和簇特征值 $\\bar{\\lambda}_g = \\frac{1}{|g|} \\sum_{i \\in g} \\lambda_i$。\n- 构建 $A$ 的两种重构：\n  - 完全重构 $A_{\\text{full}} = \\sum_{i=1}^{3} \\lambda_i P_i$。\n  - 分组重构 $A_{\\text{group}} = \\sum_{g} \\bar{\\lambda}_g P_g$。\n- 计算以下标量诊断指标：\n  1. 使用完全谱和的相对 Frobenius 范数重构误差：$E_{\\text{full}} = \\frac{\\| A - A_{\\text{full}} \\|_F}{\\max(\\|A\\|_F, 1)}$。\n  2. 使用分组簇的相对 Frobenius 范数重构误差：$E_{\\text{group}} = \\frac{\\| A - A_{\\text{group}} \\|_F}{\\max(\\|A\\|_F, 1)}$。\n  3. 秩为一的投影算子之间的最大正交性缺陷：$E_{\\text{orth}} = \\max_{i \\ne j} \\| P_i P_j \\|_F$。\n  4. 秩为一的投影算子之间的最大幂等性缺陷：$E_{\\text{idem}} = \\max_{i} \\| P_i^2 - P_i \\|_F$。\n此处 $\\|\\cdot\\|_F$ 表示 Frobenius 范数。当 $A$ 为零张量时，分母 $\\max(\\|A\\|_F, 1)$ 是为避免除以零而强制要求的。\n\n您的程序必须为以下包含五个案例的测试套件实现上述功能。所用角度必须以弧度为单位。\n\n- 测试 $1$ (离散特征值，非对角耦合):\n  $$A_1 = \\begin{bmatrix}\n  2.0 & 0.3 & 0.0 \\\\\n  0.3 & 1.0 & 0.1 \\\\\n  0.0 & 0.1 & 0.5\n  \\end{bmatrix}.$$\n\n- 测试 $2$ (对角线上近似重复的特征值):\n  $$A_2 = \\operatorname{diag}(1.0,\\, 1.0 + 10^{-8},\\, 2.0).$$\n\n- 测试 $3$ (旋转坐标系中精确重复的特征值)。令 $\\theta = \\pi/6$。定义绕 $z$ 轴的平面内旋转\n  $$Q = \\begin{bmatrix}\n  \\cos\\theta & -\\sin\\theta & 0 \\\\\n  \\sin\\theta & \\cos\\theta & 0 \\\\\n  0 & 0 & 1\n  \\end{bmatrix}, \\quad D = \\operatorname{diag}(3.0,\\, 3.0,\\, 1.0), \\quad A_3 = Q D Q^{\\mathsf{T}}.$$\n\n- 测试 $4$ (零张量):\n  $$A_4 = \\begin{bmatrix}\n  0.0 & 0.0 & 0.0 \\\\\n  0.0 & 0.0 & 0.0 \\\\\n  0.0 & 0.0 & 0.0\n  \\end{bmatrix}.$$\n\n- 测试 $5$ (不定对称张量):\n  $$A_5 = \\begin{bmatrix}\n  4.0 & -2.0 & 1.0 \\\\\n  -2.0 & 0.0 & 0.5 \\\\\n  1.0 & 0.5 & -1.0\n  \\end{bmatrix}.$$\n\n您的程序必须为每个测试张量 $A_k$ 输出列表 $[E_{\\text{full}}, E_{\\text{group}}, E_{\\text{orth}}, E_{\\text{idem}}]$（按此顺序）。将所有五个测试的结果汇总到一个列表中。\n\n最终输出格式：您的程序应生成一个单行输出，其中包含一个以逗号分隔的列表，该列表用方括号括起来，其中每个元素本身是按指定顺序排列的四个浮点数的列表。例如，打印的字符串必须如下所示：\n$$[\\,[x_{11},x_{12},x_{13},x_{14}],\\,[x_{21},x_{22},x_{23},x_{24}],\\,\\dots,\\,[x_{51},x_{52},x_{53},x_{54}]\\,].$$\n此问题不涉及单位，也不需要用户输入。", "solution": "我们从有限维内积空间上线性变换的基本陈述开始。一个实对称二阶张量 $A \\in \\mathbb{R}^{3 \\times 3}$ 代表一个线性映射 $A:\\mathbb{R}^3 \\to \\mathbb{R}^3$，对于所有 $x,y \\in \\mathbb{R}^3$ 满足 $x^{\\mathsf{T}} A y = y^{\\mathsf{T}} A x$。谱定理指出，这样的张量 $A$ 存在一组正交归一的特征向量基和实数特征值，因此存在实数标量 $\\lambda_1,\\lambda_2,\\lambda_3$ 和正交归一向量 $n_1,n_2,n_3$，满足 $A n_i = \\lambda_i n_i$ 和 $n_i^{\\mathsf{T}} n_j = \\delta_{ij}$。\n\n从这些特征向量，我们定义秩为一的正交投影算子 $P_i = n_i \\otimes n_i$，即 $(P_i)_{jk} = (n_i)_j (n_i)_k$。它们满足两个关键的代数性质：\n- 幂等性：$P_i^2 = (n_i \\otimes n_i)(n_i \\otimes n_i) = n_i (n_i^{\\mathsf{T}} n_i) n_i^{\\mathsf{T}} = n_i \\otimes n_i = P_i$，因为 $n_i$ 是单位范数向量。\n- 不同索引的正交性：当 $i \\ne j$ 时，$P_i P_j = (n_i \\otimes n_i)(n_j \\otimes n_j) = n_i (n_i^{\\mathsf{T}} n_j) n_j^{\\mathsf{T}} = 0$，因为 $n_i^{\\mathsf{T}} n_j = 0$。\n\n对于三个不同特征值的情况，谱分解唯一地（在特征向量变号的意义下）表示为\n$$\nA = \\sum_{i=1}^{3} \\lambda_i P_i.\n$$\n如果某些特征值重复，重复特征值对应的特征空间内的特征向量不唯一，但到该特征空间上的投影算子是唯一的。如果一个簇 $g$ 对应一个重复特征值 $\\lambda$，其特征空间维度为 $|g|$，则任何正交归一基 $\\{n_i\\}_{i \\in g}$ 都会产生相同的子空间投影算子 $P_g = \\sum_{i\\in g} P_i$。在具有精确重复的精确算术中，谱和简化为 $A = \\sum_{g} \\lambda P_g$。在浮点运算中，当特征值在数值上聚集时，检测簇并形成不变子空间投影算子 $P_g$ 是有意义且稳健的；簇内的一个有效代表性特征值是 $\\bar{\\lambda}_g = \\frac{1}{|g|}\\sum_{i\\in g}\\lambda_i$。\n\n对于数值实现：\n- 我们使用专门处理实对称张量的例程计算特征对 $(\\lambda_i, n_i)$，并确保特征向量是正交归一的（例如，通过使用保证正交性的算法）。\n- 我们对特征值及其特征向量进行一致的排序。排序提供了确定性的簇检测。\n- 簇检测由一个容差参数 $\\tau = a_{\\text{tol}} + r_{\\text{tol}} \\cdot \\max_j |\\lambda_j|$ 指导。这平衡了绝对和相对尺度，因此当 $A$ 很小时，$a_{\\text{tol}}$ 起主导作用；当 $A$ 很大时，阈值随谱的大小而缩放。此处我们强制规定 $a_{\\text{tol}} = 10^{-12}$ 和 $r_{\\text{tol}} = 10^{-8}$。\n- 对于每个簇 $g$，我们构建 $P_g = \\sum_{i\\in g} P_i$ 和 $\\bar{\\lambda}_g = \\{\\lambda_i\\}_{i\\in g} \\text{的均值}$。\n- 计算两种重构：\n  - 完全重构 $A_{\\text{full}} = \\sum_{i=1}^{3} \\lambda_i P_i$，在精确算术中，它等于 $A$。\n  - 分组重构 $A_{\\text{group}} = \\sum_{g} \\bar{\\lambda}_g P_g$，如果所有聚集的特征值都相等，则该重构是精确的；如果它们只是近似相等，则它是一个近似值。\n- 我们评估：\n  1. $E_{\\text{full}} = \\frac{\\| A - A_{\\text{full}} \\|_F}{\\max(\\|A\\|_F, 1)}$，预期其值处于浮点舍入误差的水平。\n  2. $E_{\\text{group}} = \\frac{\\| A - A_{\\text{group}} \\|_F}{\\max(\\|A\\|_F, 1)}$，当簇是精确的或紧密分组时，预期其值很小。\n  3. $E_{\\text{orth}} = \\max_{i\\ne j} \\| P_i P_j \\|_F$，其值应接近于零。\n  4. $E_{\\text{idem}} = \\max_i \\| P_i^2 - P_i \\|_F$，其值应接近于零。\n\n数值问题及其处理：\n- 特征值聚集情况下的特征向量敏感性：当 $|\\lambda_{i+1} - \\lambda_i|$ 很小时，与这些特征值相关的特征向量可能是不确定的；任何张成该簇不变子空间的正交归一基都是有效的。对特征值进行分组可以防止在连续介质力学中将不稳定的特征向量解释为物理上不同的方向。\n- 投影算子的稳定性：秩为一的投影算子 $P_i$ 对特征向量的方向很敏感，这些方向可能会在簇内发生符号翻转或旋转。不变子空间投影算子 $P_g$ 是唯一定义的，并在扰动下表现出更好的数值稳定性。\n- 排序和符号模糊性：特征向量的定义可相差一个符号；投影算子 $P_i$ 不受符号翻转的影响，因为 $n_i \\otimes n_i = (-n_i) \\otimes (-n_i)$。排序确保了一致的簇形成。\n- 分组容差的缩放：使用 $\\tau = a_{\\text{tol}} + r_{\\text{tol}} \\cdot \\max_j |\\lambda_j|$ 平衡了绝对和相对尺度，使得该方法对于零张量和大幅值张量都是稳健的。所选的 $a_{\\text{tol}} = 10^{-12}$ 和 $r_{\\text{tol}} = 10^{-8}$ 对于双精度计算是合理的。\n\n算法设计到代码的映射：\n- 使用对称特征值求解器获得 $(\\lambda, V)$，其中 $V = [n_1, n_2, n_3]$ 是正交归一的，$\\lambda$ 是排序的。\n- 构建 $P_i = n_i n_i^{\\mathsf{T}}$。\n- 通过使用阈值 $\\tau$ 对相邻的已排序特征值进行单次扫描来确定簇。\n- 从相应的和构建 $A_{\\text{full}}$ 和 $A_{\\text{group}}$。\n- 计算 Frobenius 范数和四个误差度量。\n- 对五个测试案例重复执行：\n  1. $A_1$ 测试一个通用的、非对角的、良态的、具有离散谱的情况。\n  2. $A_2$ 测试一对近似重复的特征值，揭示了间隙小于 $10^{-8}$ 时簇检测的行为。\n  3. $A_3$ 测试在旋转下精确重复的特征值，验证分组投影算子对于特征空间内基的选择的不变性；角度为 $\\theta = \\pi/6$ 弧度。\n  4. $A_4$ 测试零张量；分母 $\\max(\\|A\\|_F, 1)$ 防止了除以零。\n  5. $A_5$ 测试一个谱中特征值符号混合的不定张量。\n\n程序输出一个单行字符串，表示一个包含五个内部列表的外部列表，每个内部列表为对应测试案例的 $[E_{\\text{full}}, E_{\\text{group}}, E_{\\text{orth}}, E_{\\text{idem}}]$。这种设计遵循了所需的输出格式，并确保全面覆盖了在材料力学和连续介质力学张量分析中使用的对称张量谱分解中的相关数值问题。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef spectral_decomposition_with_groups(A, atol=1e-12, rtol=1e-8):\n    \"\"\"\n    Compute spectral decomposition of a real symmetric 3x3 tensor A.\n    Returns:\n        E_full: relative Frobenius error of full reconstruction\n        E_group: relative Frobenius error of grouped reconstruction\n        E_orth: max orthogonality defect among rank-one projectors\n        E_idem: max idempotency defect among rank-one projectors\n    \"\"\"\n    # Ensure symmetry numerically\n    A = 0.5 * (A + A.T)\n\n    # Eigen-decomposition for symmetric matrices: eigh returns eigenvalues in ascending order\n    w, V = np.linalg.eigh(A)\n\n    # Sort explicitly (though eigh returns sorted), keep ascending order\n    idx = np.argsort(w)\n    w = w[idx]\n    V = V[:, idx]\n\n    # Build rank-one projectors P_i = n_i n_i^T\n    projectors = []\n    for i in range(3):\n        ni = V[:, i]\n        Pi = np.outer(ni, ni)\n        projectors.append(Pi)\n\n    # Cluster detection using tolerance tau = atol + rtol * max(|lambda|)\n    max_abs_w = np.max(np.abs(w)) if w.size > 0 else 0.0\n    tau = atol + rtol * max_abs_w\n\n    # Determine clusters as contiguous groups in sorted eigenvalues\n    groups = []\n    current_group = [0]\n    for i in range(1, len(w)):\n        if abs(w[i] - w[i - 1]) <= tau:\n            current_group.append(i)\n        else:\n            groups.append(current_group)\n            current_group = [i]\n    if w.size > 0:\n        groups.append(current_group)\n\n    # Full reconstruction: sum_i lambda_i P_i\n    A_full = np.zeros_like(A)\n    for i in range(3):\n        A_full += w[i] * projectors[i]\n\n    # Grouped reconstruction: sum_g lambda_bar_g P_g\n    A_group = np.zeros_like(A)\n    if w.size > 0:\n      for g in groups:\n          lam_bar = float(np.mean(w[g]))\n          Pg = np.zeros_like(A)\n          for i in g:\n              Pg += projectors[i]\n          A_group += lam_bar * Pg\n\n    # Norms and error metrics\n    def fro_norm(M):\n        return np.sqrt(np.sum(M * M))\n\n    denom = max(fro_norm(A), 1.0)\n    E_full = fro_norm(A - A_full) / denom\n    E_group = fro_norm(A - A_group) / denom\n\n    # Orthogonality and idempotency defects for rank-one projectors\n    E_orth = 0.0\n    for i in range(3):\n        for j in range(3):\n            if i == j:\n                continue\n            pij = projectors[i] @ projectors[j]\n            E_orth = max(E_orth, fro_norm(pij))\n\n    E_idem = 0.0\n    for i in range(3):\n        Pi = projectors[i]\n        idem_def = fro_norm(Pi @ Pi - Pi)\n        E_idem = max(E_idem, idem_def)\n\n    return E_full, E_group, E_orth, E_idem\n\ndef rotation_z(theta):\n    c = np.cos(theta)\n    s = np.sin(theta)\n    Q = np.array([[c, -s, 0.0],\n                  [s,  c, 0.0],\n                  [0.0, 0.0, 1.0]], dtype=float)\n    return Q\n\ndef solve():\n    # Define the test cases from the problem statement.\n\n    # Test 1: distinct eigenvalues, off-diagonal couplings\n    A1 = np.array([\n        [2.0, 0.3, 0.0],\n        [0.3, 1.0, 0.1],\n        [0.0, 0.1, 0.5]\n    ], dtype=float)\n\n    # Test 2: nearly repeated eigenvalues on the diagonal\n    A2 = np.diag([1.0, 1.0 + 1e-8, 2.0]).astype(float)\n\n    # Test 3: exactly repeated eigenvalues in a rotated frame, theta = pi/6 radians\n    theta = np.pi / 6.0\n    Q = rotation_z(theta)\n    D = np.diag([3.0, 3.0, 1.0]).astype(float)\n    A3 = Q @ D @ Q.T\n\n    # Test 4: zero tensor\n    A4 = np.zeros((3, 3), dtype=float)\n\n    # Test 5: indefinite symmetric tensor\n    A5 = np.array([\n        [4.0, -2.0, 1.0],\n        [-2.0, 0.0, 0.5],\n        [1.0, 0.5, -1.0]\n    ], dtype=float)\n\n    test_cases = [A1, A2, A3, A4, A5]\n\n    results = []\n    for A in test_cases:\n        E_full, E_group, E_orth, E_idem = spectral_decomposition_with_groups(A, atol=1e-12, rtol=1e-8)\n        results.append([E_full, E_group, E_orth, E_idem])\n\n    # Final print statement in the exact required format.\n    # Single line: list of lists with floats\n    # Ensure default Python formatting with commas and brackets.\n    print(str(results))\n\nsolve()\n```", "id": "2922080"}]}