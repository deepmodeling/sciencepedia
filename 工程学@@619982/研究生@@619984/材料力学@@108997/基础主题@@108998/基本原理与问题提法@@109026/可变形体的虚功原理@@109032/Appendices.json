{"hands_on_practices": [{"introduction": "动手实践的第一步是巩固虚功原理作为平衡基本陈述的深刻内涵。这个练习将指导你从一个一维变截面杆的积分形式的虚功原理（即“弱形式”）出发，推导出其对应的微分平衡方程和自然边界条件（即“强形式”）。通过这个过程 [@problem_id:2676315]，你将亲身体验到弱形式如何蕴含了问题的完整物理描述，这是将虚功原理应用于更复杂问题（如有限元分析）的关键一步。", "problem": "一根直的、细长的、线性弹性杆沿其轴线占据区间 $x \\in [0, L]$。杨氏模量为常数 $E$。横截面积随 $x$ 线性变化，表达式为 $A(x) = A_{0}\\left(1 + \\alpha \\frac{x}{L}\\right)$，其中 $\\alpha > -1$ 以确保在整个杆上 $A(x) > 0$。杆受到沿正 $x$ 方向作用的轴向分布载荷 $q(x) = q_{0}\\left(1 + \\frac{x}{L}\\right)$，以及在自由端 $x=L$ 处沿正 $x$ 方向施加的末端轴向力 $P$。左端 $x=0$ 处是固定的，因此轴向位移满足 $u(0) = 0$。\n\n使用可变形体的虚功原理 (Principle of Virtual Work, PVW)，完成以下任务：\n- 为此边值问题指定一类容许的虚位移场，并运用 PVW 得到弱形式叙述。\n- 从弱形式叙述中，推导出控制平衡关系式以及在 $x=L$ 处的自然边界条件。\n- 从你通过 PVW 获得的关系式出发，通过直接积分求解精确的轴向位移场 $u(x)$。\n\n将最终位移场表示为关于 $x$、$E$、$A_{0}$、$\\alpha$、$L$、$q_{0}$ 和 $P$ 的单个闭式解析表达式。位移以米为单位表示。提供精确表达式，不要四舍五入。", "solution": "我们从可变形体的虚功原理 (PVW) 出发：对于所有容许的虚位移，内虚功等于外虚功。对于一维杆的轴向变形，轴向应变为 $\\varepsilon(x) = u'(x)$，轴向应力为 $\\sigma(x) = E\\,\\varepsilon(x) = E\\,u'(x)$。内虚功为\n$$\n\\delta W_{\\text{int}} = \\int_{0}^{L} \\sigma(x)\\,\\delta \\varepsilon(x)\\,A(x)\\,dx = \\int_{0}^{L} E\\,u'(x)\\,\\delta u'(x)\\,A(x)\\,dx.\n$$\n外虚功来源于分布轴向载荷 $q(x)$ 和在 $x=L$ 处的末端力 $P$：\n$$\n\\delta W_{\\text{ext}} = \\int_{0}^{L} q(x)\\,\\delta u(x)\\,dx + P\\,\\delta u(L).\n$$\n\n容许的虚位移场是那些运动学上容许的位移场，即它们满足与固定端相关的本质边界条件。由于位移被指定为 $u(0)=0$，容许的虚位移场必须满足 $\\delta u(0)=0$。我们要求 $\\delta u$ 足够光滑以使积分有明确定义，例如 $\\delta u \\in C^{1}[0,L]$，其中 $\\delta u(0)=0$，并且在其他地方 $\\delta u$ 是任意的。\n\n运用 PVW，\n$$\n\\int_{0}^{L} E\\,A(x)\\,u'(x)\\,\\delta u'(x)\\,dx \\;=\\; \\int_{0}^{L} q(x)\\,\\delta u(x)\\,dx \\;+\\; P\\,\\delta u(L),\n$$\n对所有容许的 $\\delta u$ 成立。\n\n我们对左侧进行分部积分：\n$$\n\\int_{0}^{L} E\\,A(x)\\,u'(x)\\,\\delta u'(x)\\,dx\n= \\left[E\\,A(x)\\,u'(x)\\,\\delta u(x)\\right]_{0}^{L} - \\int_{0}^{L} \\frac{d}{dx}\\!\\left(E\\,A(x)\\,u'(x)\\right)\\,\\delta u(x)\\,dx.\n$$\n使用 $\\delta u(0) = 0$，上式变为\n$$\n\\left[E\\,A(L)\\,u'(L)\\,\\delta u(L)\\right] - \\int_{0}^{L} \\frac{d}{dx}\\!\\left(E\\,A(x)\\,u'(x)\\right)\\,\\delta u(x)\\,dx.\n$$\n因此 PVW 可写为\n$$\n- \\int_{0}^{L} \\frac{d}{dx}\\!\\left(E\\,A(x)\\,u'(x)\\right)\\,\\delta u(x)\\,dx + E\\,A(L)\\,u'(L)\\,\\delta u(L)\n= \\int_{0}^{L} q(x)\\,\\delta u(x)\\,dx + P\\,\\delta u(L).\n$$\n因为 $\\delta u(x)$ 在内部是任意的，且 $\\delta u(L)$ 在 $x=L$ 处是任意的，我们得到强形式和自然边界条件：\n- 控制平衡方程：\n$$\n\\frac{d}{dx}\\!\\left(E\\,A(x)\\,u'(x)\\right) + q(x) = 0 \\quad \\text{in } (0,L).\n$$\n- 在 $x=L$ 处的自然边界条件：\n$$\nE\\,A(L)\\,u'(L) = P.\n$$\n本质边界条件是 $u(0)=0$。\n\n设轴向力为 $N(x) = E\\,A(x)\\,u'(x)$。平衡方程给出\n$$\nN'(x) + q(x) = 0 \\;\\;\\Rightarrow\\;\\; N(x) = C_{1} - \\int_{0}^{x} q(s)\\,ds,\n$$\n其中 $C_{1}$ 为某个常数。在 $x=L$ 处的自然边界条件给出\n$$\nN(L) = E\\,A(L)\\,u'(L) = P \\;\\;\\Rightarrow\\;\\; C_{1} - \\int_{0}^{L} q(s)\\,ds = P \\;\\;\\Rightarrow\\;\\; C_{1} = P + \\int_{0}^{L} q(s)\\,ds.\n$$\n利用 $q(x) = q_{0}\\left(1 + \\frac{x}{L}\\right)$，我们计算\n$$\n\\int_{0}^{x} q(s)\\,ds = q_{0}\\left(x + \\frac{x^{2}}{2L}\\right), \\qquad \\int_{0}^{L} q(s)\\,ds = q_{0}\\left(L + \\frac{L}{2}\\right) = \\frac{3}{2}\\,q_{0}\\,L.\n$$\n因此\n$$\nC_{1} = P + \\frac{3}{2}\\,q_{0}\\,L,\n$$\n并且\n$$\nu'(x) = \\frac{N(x)}{E\\,A(x)} = \\frac{C_{1} - q_{0}\\left(x + \\frac{x^{2}}{2L}\\right)}{E\\,A_{0}\\left(1 + \\alpha \\frac{x}{L}\\right)}.\n$$\n施加条件 $u(0)=0$，我们将 $u'$ 从 $0$ 积分到 $x$ 来得到 $u(x)$：\n$$\nu(x) = \\int_{0}^{x} u'(\\xi)\\,d\\xi\n= \\frac{1}{E\\,A_{0}} \\int_{0}^{x} \\frac{C_{1} - q_{0}\\left(\\xi + \\frac{\\xi^{2}}{2L}\\right)}{1 + \\alpha \\frac{\\xi}{L}}\\,d\\xi.\n$$\n为简洁起见，引入 $a = \\alpha/L$。那么\n$$\nu(x) = \\frac{1}{E\\,A_{0}} \\left[\nC_{1} \\int_{0}^{x} \\frac{d\\xi}{1 + a \\xi}\n- q_{0} \\int_{0}^{x} \\frac{\\xi}{1 + a \\xi}\\,d\\xi\n- \\frac{q_{0}}{2L} \\int_{0}^{x} \\frac{\\xi^{2}}{1 + a \\xi}\\,d\\xi\n\\right].\n$$\n所需的积分为\n$$\n\\int \\frac{d\\xi}{1 + a \\xi} = \\frac{1}{a}\\ln(1 + a \\xi),\n$$\n$$\n\\int \\frac{\\xi}{1 + a \\xi}\\,d\\xi = \\frac{1}{a}\\left(\\xi - \\frac{1}{a}\\ln(1 + a \\xi)\\right),\n$$\n$$\n\\int \\frac{\\xi^{2}}{1 + a \\xi}\\,d\\xi = \\frac{1}{2a}\\,\\xi^{2} - \\frac{1}{a^{2}}\\,\\xi + \\frac{1}{a^{3}} \\ln(1 + a \\xi),\n$$\n它们在下限 $\\xi=0$ 处的值都为零，因为 $\\ln(1)=0$ 且多项式为零。因此，\n$$\nu(x) = \\frac{1}{E\\,A_{0}} \\left[\n\\frac{C_{1}}{a}\\ln(1 + a x)\n- \\frac{q_{0}}{a}\\left(x - \\frac{1}{a}\\ln(1 + a x)\\right)\n- \\frac{q_{0}}{2L}\\left(\\frac{1}{2a}x^{2} - \\frac{1}{a^{2}}x + \\frac{1}{a^{3}}\\ln(1 + a x)\\right)\n\\right].\n$$\n使用 $a=\\alpha/L$ 将表达式用 $\\alpha$ 和 $L$ 重新表示，所以有 $\\frac{1}{a}=\\frac{L}{\\alpha}$、$\\frac{1}{a^{2}}=\\frac{L^{2}}{\\alpha^{2}}$ 和 $\\frac{1}{a^{3}}=\\frac{L^{3}}{\\alpha^{3}}$，并代入 $C_{1} = P + \\frac{3}{2} q_{0} L$，我们得到位移场的闭式解\n$$\nu(x) = \\frac{1}{E\\,A_{0}} \\Bigg\\{\n\\left[\n\\frac{L}{\\alpha}\\,P\n+ \\frac{3}{2}\\,\\frac{q_{0}\\,L^{2}}{\\alpha}\n+ \\frac{q_{0}\\,L^{2}}{\\alpha^{2}}\n- \\frac{q_{0}\\,L^{2}}{2\\,\\alpha^{3}}\n\\right] \\ln\\!\\left(1 + \\frac{\\alpha x}{L}\\right)\n+ \\left[\n- \\frac{q_{0}\\,L}{\\alpha} + \\frac{q_{0}\\,L}{2\\,\\alpha^{2}}\n\\right] x\n- \\frac{q_{0}}{4\\,\\alpha}\\,x^{2}\n\\Bigg\\}.\n$$\n当 $E$ 的单位是帕斯卡，$A_{0}$ 的单位是平方米，按规定 $q_{0}$ 和 $P$ 的单位分别为牛顿/米和牛顿，以及 $x$ 和 $L$ 的单位是米时，此表达式的单位是米。它是精确的，无需四舍五入。", "answer": "$$\\boxed{\\frac{1}{E\\,A_{0}}\\left\\{\\left[\\frac{L}{\\alpha}\\,P+\\frac{3}{2}\\,\\frac{q_{0}L^{2}}{\\alpha}+\\frac{q_{0}L^{2}}{\\alpha^{2}}-\\frac{q_{0}L^{2}}{2\\alpha^{3}}\\right]\\ln\\!\\left(1+\\frac{\\alpha x}{L}\\right)+\\left[-\\frac{q_{0}L}{\\alpha}+\\frac{q_{0}L}{2\\alpha^{2}}\\right]x-\\frac{q_{0}}{4\\alpha}x^{2}\\right\\}}$$", "id": "2676315"}, {"introduction": "掌握了从弱形式到强形式的推导后，我们来探索虚功原理在求解近似解中的强大威力。对于许多复杂结构，求得精确解析解是不现实的，而基于虚功原理的近似方法（如伽辽金法）则提供了有效的解决途径。本练习 [@problem_id:2676301] 要求你为一个简支梁选择一个满足运动学边界条件的近似函数空间，并利用虚功原理确定其中的待定参数，从而得到梁的挠度近似解。这个练习是理解有限元方法思想的绝佳起点。", "problem": "一根长度为 $L$、具有恒定抗弯刚度 $EI$ 的欧拉-伯努利梁，在 $x=0$ 和 $x=L$ 处为简支。该梁在整个跨度上承受集度为 $q_0$ 的空间均匀横向载荷。设横向挠度为 $w(x)$。从变形体虚功原理的基本原理出发，推导适用于此梁问题的弱形式，并指明其本质边界条件和自然边界条件。然后，使用一个满足所有本质边界条件的、容许的双参数三次多项式子空间来近似挠度 $w(x)$：\n$$\nw(x) = \\alpha\\,x(L-x) + \\beta\\,x^2(L-x),\n$$\n并对虚位移使用相同的空间。通过对所选子空间中的所有虚场强制施加弱形式，确定系数 $\\alpha$ 和 $\\beta$。根据你得到的近似场 $w(x)$，计算跨中挠度 $w(L/2)$，并将其表示为关于 $q_0$、$L$ 和 $EI$ 的符号表达式。\n\n将最终答案表示为关于 $q_0$、$L$ 和 $EI$ 的单一精确符号表达式 $w(L/2)$。不要代入数值。最终的方框答案中不要包含单位。如果要为 $w(L/2)$ 指定单位，当 $q_0$ 的单位是牛顿/米，$EI$ 的单位是牛顿·米²时，$w(L/2)$ 的单位是米。", "solution": "本问题要求利用虚功原理，推导并应用在均布载荷作用下欧拉-伯努利梁的弱形式。任务是在指定的多项式子空间内找到挠度的近似解，然后计算跨中挠度。\n\n首先，我们确认问题的有效性。\n已知条件：\n1.  一根长度为 $L$ 的欧拉-伯努利梁。\n2.  恒定的抗弯刚度 $EI$。\n3.  在 $x=0$ 和 $x=L$ 处简支。\n4.  集度为 $q_0$ 的均布横向载荷。\n5.  挠度记为 $w(x)$。\n6.  近似挠度的试函数为 $w(x) = \\alpha\\,x(L-x) + \\beta\\,x^2(L-x)$。\n7.  虚位移 $\\delta w(x)$ 的空间与 $w(x)$ 的空间相同。\n\n有效性验证：\n这个问题具有科学依据，是梁理论和虚功原理的标准应用，而虚功原理是固体力学的基石。这是一个适定问题，具有足够的边界条件和明确的载荷来确定一个解。所提供的试函数 $w(x)$ 正确地满足了简支的本质边界条件 $w(0)=0$ 和 $w(L)=0$，因此它是一个容许的选择。这个问题是客观的，并包含了求解参数 $\\alpha$ 和 $\\beta$ 的唯一解所需的所有信息。因此，该问题是有效的。\n\n我们现在开始求解。\n\n变形体虚功原理指出，外力所做的虚功 $\\delta W_{ext}$ 等于内应变能的变分 $\\delta U$。\n$$ \\delta W_{ext} = \\delta U $$\n对于给定的梁，外虚功由分布载荷 $q_0$ 产生。\n$$ \\delta W_{ext} = \\int_{0}^{L} q_0 \\delta w(x) \\, dx $$\n其中 $\\delta w(x)$ 是任意的、运动学上容许的虚位移。\n\n欧拉-伯努利梁的应变能 $U$ 由下式给出：\n$$ U = \\frac{1}{2} \\int_{0}^{L} M(x) \\kappa(x) \\, dx = \\frac{1}{2} \\int_{0}^{L} EI (w''(x))^2 \\, dx $$\n此处，$M(x)$ 是弯矩，$\\kappa(x) \\approx w''(x)$ 是曲率。应变能的一阶变分 $\\delta U$ 为：\n$$ \\delta U = \\delta \\left( \\frac{1}{2} \\int_{0}^{L} EI (w''(x))^2 \\, dx \\right) = \\int_{0}^{L} EI w''(x) \\delta(w''(x)) \\, dx = \\int_{0}^{L} EI w''(x) (\\delta w(x))'' \\, dx $$\n令 $\\delta U$ 和 $\\delta W_{ext}$ 相等，得到平衡方程的弱形式：\n$$ \\int_{0}^{L} EI w''(x) (\\delta w)''(x) \\, dx = \\int_{0}^{L} q_0 \\delta w(x) \\, dx $$\n该方程必须对所有容许的虚位移 $\\delta w(x)$ 成立。\n\n必须将边界条件区分为本质（运动学）边界条件或自然（静力学）边界条件。对于 $x=0$ 和 $x=L$ 处的简支：\n1.  挠度为零：$w(0)=0$ 和 $w(L)=0$。这些是对位移场的约束，因此是**本质**边界条件。容许的虚位移也必须满足这些条件，即 $\\delta w(0)=0$ 和 $\\delta w(L)=0$。\n2.  弯矩为零：$M(0) = EI w''(0) = 0$ 和 $M(L) = EI w''(L) = 0$。这些是对力（弯矩）的约束，是**自然**边界条件。它们由弱形式隐式满足，而非预先施加在试函数上。\n\n问题指定了一个近似解子空间：\n$$ w(x) = \\alpha \\phi_1(x) + \\beta \\phi_2(x) $$\n基函数为 $\\phi_1(x) = x(L-x)$ 和 $\\phi_2(x) = x^2(L-x)$。虚位移位于同一空间中：\n$$ \\delta w(x) = \\delta \\alpha \\phi_1(x) + \\delta \\beta \\phi_2(x) $$\n由于 $\\delta \\alpha$ 和 $\\delta \\beta$ 是任意的，伽辽金法要求弱形式对 $\\delta w = \\phi_1(x)$ 和 $\\delta w = \\phi_2(x)$ 独立成立。这就产生了一个关于两个未知数 $\\alpha$ 和 $\\beta$ 的二元线性方程组。\n\n我们计算基函数的必要二阶导数：\n$\\phi_1(x) = Lx - x^2 \\implies \\phi_1'(x) = L-2x \\implies \\phi_1''(x) = -2$\n$\\phi_2(x) = Lx^2 - x^3 \\implies \\phi_2'(x) = 2Lx - 3x^2 \\implies \\phi_2''(x) = 2L-6x$\n$w(x)$ 的二阶导数为：\n$w''(x) = \\alpha \\phi_1''(x) + \\beta \\phi_2''(x) = -2\\alpha + \\beta(2L-6x)$\n\n方程组为 $[K] \\begin{pmatrix} \\alpha \\\\ \\beta \\end{pmatrix} = \\{F\\}$，其中：\n$K_{ij} = \\int_{0}^{L} EI \\phi_i''(x) \\phi_j''(x) \\, dx$\n$F_i = \\int_{0}^{L} q_0 \\phi_i(x) \\, dx$\n\n让我们计算矩阵 $[K]$ 和向量 $\\{F\\}$ 的分量。\n$K_{11} = \\int_{0}^{L} EI (\\phi_1''(x))^2 \\, dx = EI \\int_{0}^{L} (-2)^2 \\, dx = 4EI \\int_{0}^{L} dx = 4EIL$\n\n$K_{12} = K_{21} = \\int_{0}^{L} EI \\phi_1''(x) \\phi_2''(x) \\, dx = EI \\int_{0}^{L} (-2)(2L-6x) \\, dx = -2EI [2Lx-3x^2]_0^L = -2EI(2L^2-3L^2) = 2EIL^2$\n\n$K_{22} = \\int_{0}^{L} EI (\\phi_2''(x))^2 \\, dx = EI \\int_{0}^{L} (2L-6x)^2 \\, dx = EI \\int_{0}^{L} (4L^2 - 24Lx + 36x^2) \\, dx = EI [4L^2x - 12Lx^2 + 12x^3]_0^L = EI(4L^3 - 12L^3 + 12L^3) = 4EIL^3$\n\n$F_1 = \\int_{0}^{L} q_0 \\phi_1(x) \\, dx = q_0 \\int_{0}^{L} (Lx - x^2) \\, dx = q_0 \\left[ \\frac{Lx^2}{2} - \\frac{x^3}{3} \\right]_0^L = q_0 \\left( \\frac{L^3}{2} - \\frac{L^3}{3} \\right) = \\frac{q_0 L^3}{6}$\n\n$F_2 = \\int_{0}^{L} q_0 \\phi_2(x) \\, dx = q_0 \\int_{0}^{L} (Lx^2 - x^3) \\, dx = q_0 \\left[ \\frac{Lx^3}{3} - \\frac{x^4}{4} \\right]_0^L = q_0 \\left( \\frac{L^4}{3} - \\frac{L^4}{4} \\right) = \\frac{q_0 L^4}{12}$\n\n线性系统为：\n$$ \\begin{pmatrix} 4EIL & 2EIL^2 \\\\ 2EIL^2 & 4EIL^3 \\end{pmatrix} \\begin{pmatrix} \\alpha \\\\ \\beta \\end{pmatrix} = \\begin{pmatrix} \\frac{q_0L^3}{6} \\\\ \\frac{q_0L^4}{12} \\end{pmatrix} $$\n我们求解这个系统。将第一个方程除以 $2EIL$，第二个方程除以 $2EIL^2$：\n1. $2\\alpha + L\\beta = \\frac{q_0L^2}{12EI}$\n2. $\\alpha + 2L\\beta = \\frac{q_0L^2}{24EI}$\n将第二个方程乘以 $2$：\n$2\\alpha + 4L\\beta = \\frac{q_0L^2}{12EI}$\n用此结果减去第一个方程：\n$(2\\alpha + 4L\\beta) - (2\\alpha + L\\beta) = \\frac{q_0L^2}{12EI} - \\frac{q_0L^2}{12EI}$\n$3L\\beta = 0 \\implies \\beta = 0$\n$\\beta=0$ 这个结果是正确的，它是问题对称性的一个推论。载荷和边界条件关于 $x=L/2$ 对称，因此精确挠度也必须是对称的。基函数 $\\phi_1(x)$ 是对称的，而 $\\phi_2(x)$ 不是。伽辽金法正确地指出，在给定子空间中的最佳近似需要消除反对称分量，在此基中这对应于令 $\\beta=0$。\n\n将 $\\beta=0$ 代入第一个方程：\n$2\\alpha = \\frac{q_0L^2}{12EI} \\implies \\alpha = \\frac{q_0L^2}{24EI}$\n\n因此，近似挠度场为：\n$$ w(x) = \\frac{q_0L^2}{24EI} x(L-x) $$\n问题要求计算跨中挠度 $w(L/2)$：\n$$ w\\left(\\frac{L}{2}\\right) = \\frac{q_0L^2}{24EI} \\left(\\frac{L}{2}\\right) \\left(L - \\frac{L}{2}\\right) = \\frac{q_0L^2}{24EI} \\left(\\frac{L}{2}\\right) \\left(\\frac{L}{2}\\right) = \\frac{q_0L^2}{24EI} \\frac{L^2}{4} $$\n$$ w\\left(\\frac{L}{2}\\right) = \\frac{q_0L^4}{96EI} $$\n这就是近似跨中挠度的最终符号表达式。", "answer": "$$ \\boxed{\\frac{q_0 L^4}{96EI}} $$", "id": "2676301"}, {"introduction": "最后，我们将虚功原理应用于现代计算力学中的一个核心实际任务。在有限元分析中，施加在结构上的连续分布载荷必须被等效地转换到单元的节点上，形成所谓的“等效节点力”。这个练习 [@problem_id:2676357] 将引导你从虚功原理出发，为一个二维四边形单元推导其在非均匀边界牵引力作用下的“一致性”等效节点力向量。完成这个练习将帮助你理解有限元软件是如何精确处理外加载荷的，并体会到虚功原理在工程实践中的直接应用价值。", "problem": "考虑一个处于平面应力状态的单位厚度二维等参双线性四边形有限元。该单元在物理 $(x,y)$ 平面内是一个矩形，其节点逆时针标记为：节点 $1$ 位于 $(0,0)$，节点 $2$ 位于 $(L,0)$，节点 $3$ 位于 $(L,H)$，节点 $4$ 位于 $(0,H)$，其中 $L>0$ 且 $H>0$。令 $H=2$，而 $L$ 为任意值，不参与以下计算。位于 $x=L$ 的右边界（连接节点 $2$ 和节点 $3$）受到一指定的线牵引力（单位长度上的力）$\\bar{\\boldsymbol{t}}(y)$，其笛卡尔分量为\n$$\n\\bar{t}_x(y)=1000+500\\,y, \\quad \\bar{t}_y(y)=200-100\\,y,\n$$\n对于 $y\\in[0,H]$，单位为牛顿/米。\n\n仅使用可变形体的虚功原理和双线性四边形的标准有限元位移插值，从第一性原理推导与此边界牵引力相关的一致等效节点荷载子向量的表达式，并精确计算节点 $2$ 和节点 $3$ 的值。清晰地定义受载边界上的插值、线积分的几何测度以及牵引力场沿边界的映射。然后，按 $[f_{2x}, f_{2y}, f_{3x}, f_{3y}]$ 的顺序计算一致等效节点荷载子向量。\n\n此外，简要地从概念上解释（无需公式）在此背景下一致荷载向量和集中荷载向量之间的区别，及其对斑块检验满足性和收敛性的影响。\n\n提供精确值（不要四舍五入）。最终答案以牛顿表示。在最终的方框答案中不要包含单位。角度单位不适用于此问题。", "solution": "所述问题具有科学依据，是适定的，并包含了唯一解所需的所有信息。这是有限元分析基本原理的标准应用。我们将开始推导过程。\n\n一致等效节点荷载向量的推导源于虚功原理。由作用在边界 $\\Gamma_t$ 上的给定表面牵引力 $\\bar{\\boldsymbol{t}}$ 所做的外虚功 $\\delta W_{ext}$，由牵引力与虚位移 $\\delta\\boldsymbol{u}$ 的点积积分给出：\n$$\n\\delta W_{ext} = \\int_{\\Gamma_t} (\\delta\\boldsymbol{u})^T \\bar{\\boldsymbol{t}} \\, d\\Gamma\n$$\n在有限元框架内，单元内任意点的位移场 $\\boldsymbol{u}$ 是由节点位移 $\\boldsymbol{d}$ 通过形函数矩阵 $\\boldsymbol{N}$ 插值得到的。对于一个二维问题，$\\boldsymbol{u}(x,y) = \\boldsymbol{N}(x,y) \\boldsymbol{d}$。因此，虚位移由 $\\delta\\boldsymbol{u} = \\boldsymbol{N} \\delta\\boldsymbol{d}$ 给出，其中 $\\delta\\boldsymbol{d}$ 是虚节点位移向量。\n\n将插值的虚位移代入虚功表达式，我们得到：\n$$\n\\delta W_{ext} = \\int_{\\Gamma_t} (\\boldsymbol{N} \\delta\\boldsymbol{d})^T \\bar{\\boldsymbol{t}} \\, d\\Gamma = (\\delta\\boldsymbol{d})^T \\int_{\\Gamma_t} \\boldsymbol{N}^T \\bar{\\boldsymbol{t}} \\, d\\Gamma\n$$\n外虚功也可以表示为虚节点位移和等效节点力向量 $\\boldsymbol{f}_{ext}$ 的乘积：$\\delta W_{ext} = (\\delta\\boldsymbol{d})^T \\boldsymbol{f}_{ext}$。通过比较 $\\delta W_{ext}$ 的两个表达式，我们确定一致节点荷载向量为：\n$$\n\\boldsymbol{f}_{ext} = \\int_{\\Gamma_t} \\boldsymbol{N}^T \\bar{\\boldsymbol{t}} \\, d\\Gamma\n$$\n本问题涉及一个双线性四边形单元，其几何形状和位移在自然坐标系 $(\\xi, \\eta)$ 中使用形函数进行插值，其中 $\\xi, \\eta \\in [-1, 1]$。形函数为：\n$N_1 = \\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_2 = \\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_3 = \\frac{1}{4}(1+\\xi)(1+\\eta)$, $N_4 = \\frac{1}{4}(1-\\xi)(1+\\eta)$。\n\n牵引力作用于连接节点 $2$（位于 $(L,0)$）和节点 $3$（位于 $(L,H)$）的边上。在自然坐标系中，这条边对应于 $\\xi = 1$，$\\eta$ 从 $-1$ 变化到 $1$。沿着这条边，节点 $1$ 和 $4$ 的形函数为零，而节点 $2$ 和 $3$ 的形函数为：\n$$\nN_2(1, \\eta) = \\frac{1}{2}(1-\\eta), \\quad N_3(1, \\eta) = \\frac{1}{2}(1+\\eta)\n$$\n限制在这条边及其活动节点（$2$ 和 $3$）上的形函数矩阵为：\n$$\n\\boldsymbol{N}_{edge}^T = \\begin{bmatrix} N_2 & 0 \\\\ 0 & N_2 \\\\ N_3 & 0 \\\\ 0 & N_3 \\end{bmatrix}\n$$\n积分必须相对于物理弧长 $d\\Gamma$ 进行。对于等参单元，我们将 $d\\Gamma$ 映射到自然坐标系中。沿 $\\xi$ 恒定的边的微分弧长为 $d\\Gamma = \\sqrt{(\\frac{\\partial x}{\\partial \\eta})^2 + (\\frac{\\partial y}{\\partial \\eta})^2} \\, d\\eta$。\n物理坐标 $(x,y)$ 通过单元形函数和节点坐标从 $(\\xi, \\eta)$ 映射而来：$x = \\sum_i N_i x_i$ 和 $y = \\sum_i N_i y_i$。在边 $\\xi=1$上：\n$x = N_2(1,\\eta)x_2 + N_3(1,\\eta)x_3 = \\frac{1}{2}(1-\\eta)L + \\frac{1}{2}(1+\\eta)L = L$。\n$y = N_2(1,\\eta)y_2 + N_3(1,\\eta)y_3 = \\frac{1}{2}(1-\\eta)(0) + \\frac{1}{2}(1+\\eta)H = \\frac{H}{2}(1+\\eta)$。\n当 $H=2$ 时，这简化为 $y = 1+\\eta$。\n关于 $\\eta$ 的导数为 $\\frac{\\partial x}{\\partial \\eta} = 0$ 和 $\\frac{\\partial y}{\\partial \\eta} = \\frac{H}{2} = \\frac{2}{2} = 1$。\n因此，微分弧长为 $d\\Gamma = \\sqrt{0^2 + 1^2} \\, d\\eta = d\\eta$。积分将在 $\\eta \\in [-1, 1]$ 的范围内进行。\n\n接下来，我们使用关系式 $y = 1+\\eta$ 将牵引力分量表示为 $\\eta$ 的函数：\n$\\bar{t}_x(y) = 1000 + 500y \\implies \\bar{t}_x(\\eta) = 1000 + 500(1+\\eta) = 1500 + 500\\eta$。\n$\\bar{t}_y(y) = 200 - 100y \\implies \\bar{t}_y(\\eta) = 200 - 100(1+\\eta) = 100 - 100\\eta$。\n牵引力向量为 $\\bar{\\boldsymbol{t}}(\\eta) = \\begin{Bmatrix} 1500 + 500\\eta \\\\ 100 - 100\\eta \\end{Bmatrix}$。\n\n节点 $2$ 和 $3$ 的一致节点荷载子向量 $[f_{2x}, f_{2y}, f_{3x}, f_{3y}]^T$ 计算如下：\n$$\n\\begin{Bmatrix} f_{2x} \\\\ f_{2y} \\\\ f_{3x} \\\\ f_{3y} \\end{Bmatrix} = \\int_{-1}^{1} \\begin{bmatrix} N_2 & 0 \\\\ 0 & N_2 \\\\ N_3 & 0 \\\\ 0 & N_3 \\end{bmatrix} \\begin{Bmatrix} \\bar{t}_x \\\\ \\bar{t}_y \\end{Bmatrix} \\, d\\eta\n$$\n我们计算每个分量：\n$f_{2x} = \\int_{-1}^{1} N_2(\\eta) \\bar{t}_x(\\eta) \\, d\\eta = \\int_{-1}^{1} \\frac{1}{2}(1-\\eta)(1500 + 500\\eta) \\, d\\eta = \\frac{1}{2} \\int_{-1}^{1} (1500 - 1000\\eta - 500\\eta^2) \\, d\\eta$\n$$\nf_{2x} = \\frac{1}{2} \\left[ 1500\\eta - 500\\eta^2 - \\frac{500}{3}\\eta^3 \\right]_{-1}^{1} = \\frac{1}{2} \\left[ (1500 - 500 - \\frac{500}{3}) - (-1500 - 500 + \\frac{500}{3}) \\right] = \\frac{1}{2} \\left( 3000 - \\frac{1000}{3} \\right) = \\frac{4000}{3}\n$$\n$f_{2y} = \\int_{-1}^{1} N_2(\\eta) \\bar{t}_y(\\eta) \\, d\\eta = \\int_{-1}^{1} \\frac{1}{2}(1-\\eta)(100 - 100\\eta) \\, d\\eta = \\frac{100}{2} \\int_{-1}^{1} (1-2\\eta+\\eta^2) \\, d\\eta$\n$$\nf_{2y} = 50 \\left[ \\eta - \\eta^2 + \\frac{\\eta^3}{3} \\right]_{-1}^{1} = 50 \\left[ (1-1+\\frac{1}{3}) - (-1-1-\\frac{1}{3}) \\right] = 50 \\left( \\frac{1}{3} - (-\\frac{7}{3}) \\right) = 50 \\left( \\frac{8}{3} \\right) = \\frac{400}{3}\n$$\n$f_{3x} = \\int_{-1}^{1} N_3(\\eta) \\bar{t}_x(\\eta) \\, d\\eta = \\int_{-1}^{1} \\frac{1}{2}(1+\\eta)(1500 + 500\\eta) \\, d\\eta = \\frac{1}{2} \\int_{-1}^{1} (1500 + 2000\\eta + 500\\eta^2) \\, d\\eta$\n$$\nf_{3x} = \\frac{1}{2} \\left[ 1500\\eta + 1000\\eta^2 + \\frac{500}{3}\\eta^3 \\right]_{-1}^{1} = \\frac{1}{2} \\left[ (1500 + 1000 + \\frac{500}{3}) - (-1500 + 1000 - \\frac{500}{3}) \\right] = \\frac{1}{2} \\left( 2500 + \\frac{500}{3} - (-500 - \\frac{500}{3}) \\right) = \\frac{1}{2} \\left( 3000 + \\frac{1000}{3} \\right) = \\frac{5000}{3}\n$$\n$f_{3y} = \\int_{-1}^{1} N_3(\\eta) \\bar{t}_y(\\eta) \\, d\\eta = \\int_{-1}^{1} \\frac{1}{2}(1+\\eta)(100 - 100\\eta) \\, d\\eta = \\frac{100}{2} \\int_{-1}^{1} (1-\\eta^2) \\, d\\eta$\n$$\nf_{3y} = 50 \\left[ \\eta - \\frac{\\eta^3}{3} \\right]_{-1}^{1} = 50 \\left[ (\\frac{2}{3}) - (-\\frac{2}{3}) \\right] = 50 \\left( \\frac{4}{3} \\right) = \\frac{200}{3}\n$$\n计算得到的子向量为 $[f_{2x}, f_{2y}, f_{3x}, f_{3y}] = [\\frac{4000}{3}, \\frac{400}{3}, \\frac{5000}{3}, \\frac{200}{3}]$。\n\n从概念上讲，**一致荷载向量**源于虚功原理，它确保在插值虚位移下等效节点荷载所做的功与实际分布牵引力所做的功完全相同。这种方法与单元的位移场假设是“一致的”。相比之下，**集中荷载向量**是一种近似方法，其中来自自分布牵引力的总力根据一些更简单的规则（如平均分配）分配（“集中”）到受载边界上的节点。这种方法忽略了节点之间位移场的变化。\n使用一致荷载向量在理论上更优越，并且是单元公式通过**斑块检验**的必要条件。满足斑块检验可保证单元能够精确地再现常应力状态，这是收敛性的一个基本要求。集中荷载向量通常会导致公式无法通过斑块检验，因为节点荷载与假设的位移函数并非能量共轭。因此，使用一致荷载可以确保随着网格的细化，有限元解以最优的**收敛**率逼近精确解。集中处理会降低此收敛率并引入误差，尽管它在计算上可能更简单，并且对于非常精细的网格可能会产生可接受的结果。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{4000}{3} & \\frac{400}{3} & \\frac{5000}{3} & \\frac{200}{3} \\end{pmatrix}}\n$$", "id": "2676357"}]}