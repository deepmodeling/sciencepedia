{"hands_on_practices": [{"introduction": "理论的基石是能够被验证的。这个练习将引导您在一个由多个弹簧构成的离散系统中，从最基本的原理出发，直接验证贝蒂定理。您将为两种不同的载荷情况计算位移，并明确证明互易功项 $P^{(1)} \\cdot u^{(2)}$ 与 $P^{(2)} \\cdot u^{(1)}$ 相等，从而具体地理解该定理的物理意义 [@problem_id:2618449]。", "problem": "一个线性弹性离散结构在标记为 $1$、$2$ 和 $3$ 的节点处具有 $3$ 个标量平移自由度 (DOF)。每对节点之间由一个线性 Hooke 弹簧连接，并且每个节点还通过一个线性 Hooke 弹簧接地。该弹簧网络是保守的，所有弹簧均遵循 Hooke 定律，具有恒定的刚度。弹簧及其刚度如下：\n- 节点 $1$ 与节点 $2$ 之间：刚度 $k_{12} = 2$。\n- 节点 $2$ 与节点 $3$ 之间：刚度 $k_{23} = 3$。\n- 节点 $1$ 与节点 $3$ 之间：刚度 $k_{13} = 1$。\n- 节点 $1$ 接地：刚度 $k_{1g} = 4$。\n- 节点 $2$ 接地：刚度 $k_{2g} = 5$。\n- 节点 $3$ 接地：刚度 $k_{3g} = 6$。\n\n施加了两个独立的静态载荷工况，以节点力向量表示：\n- 载荷工况 $1$：$P^{(1)} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 2 \\end{pmatrix}$。\n- 载荷工况 $2$：$P^{(2)} = \\begin{pmatrix} 0 \\\\ 3 \\\\ 1 \\end{pmatrix}$。\n\n任务：\n1. 使用平衡、协调和 Hooke 定律，组装此 $3$ 自由度系统的全局刚度矩阵 $K$。通过援引线性弹簧的能量势，解释为何 $K$ 是对称的。\n2. 对于每个载荷工况 $i \\in \\{1,2\\}$，求解线性系统 $K\\,u^{(i)} = P^{(i)}$ 以获得位移向量 $u^{(1)}$ 和 $u^{(2)}$。\n3. 计算标量积 $P^{(1)} \\cdot u^{(2)}$ 和 $P^{(2)} \\cdot u^{(1)}$，并基于 $K$ 的对称性所产生的互易性来验证它们的相等性。\n4. 使用线性保守系统的基本能量论证，从功的角度解释这些标量积的物理意义，并将其与总应变能和 Clapeyron 定理预测的形式进行简要联系。\n\n报告这两个标量积的共同值。将此单值表示为一个精确的有理数，不要四舍五入。如果您选择追踪单位，请以焦耳（Joules）表示结果，但最终报告的值应为无量纲的纯数。", "solution": "所述问题具有科学依据、是适定的且客观的。它提出了一个线性弹性结构分析中的标准问题，并提供了所有必要的数据。这是一个有效的问题。我们开始求解。\n\n该问题需要对一个线性弹性弹簧网络进行四部分分析。我们按顺序处理每个任务。\n\n首先，我们为这个 $3$ 自由度（$DOF$）系统组装全局刚度矩阵 $K$。自由度分别是节点 $1$、$2$ 和 $3$ 处的标量平移位移 $u_1$、$u_2$ 和 $u_3$。刚度矩阵的元素 $K_{ij}$ 是指在 $DOF$ $j$ 处维持单位位移（$u_j=1$），而所有其他位移为零（对于 $k \\ne j$，$u_k=0$）时，在 $DOF$ $i$ 处所需的力。\n\n对角线元素 $K_{ii}$ 表示连接到节点 $i$ 的总刚度。这是连接到节点 $i$ 的所有弹簧刚度之和。\n$$K_{11} = k_{12} + k_{13} + k_{1g} = 2 + 1 + 4 = 7$$\n$$K_{22} = k_{12} + k_{23} + k_{2g} = 2 + 3 + 5 = 10$$\n$$K_{33} = k_{13} + k_{23} + k_{3g} = 1 + 3 + 6 = 10$$\n\n非对角线元素 $K_{ij}$（当 $i \\ne j$ 时）表示节点 $j$ 处的单位位移传递到节点 $i$ 的力。该力等于连接这两个节点的弹簧刚度的负值。\n$$K_{12} = K_{21} = -k_{12} = -2$$\n$$K_{13} = K_{31} = -k_{13} = -1$$\n$$K_{23} = K_{32} = -k_{23} = -3$$\n\n将这些分量组装起来，得到全局刚度矩阵 $K$：\n$$K = \\begin{pmatrix} 7 & -2 & -1 \\\\ -2 & 10 & -3 \\\\ -1 & -3 & 10 \\end{pmatrix}$$\n\n刚度矩阵的对称性，$K = K^T$，是线性保守系统的一个基本性质。由 Hooke 弹簧组成的系统是保守的，这意味着内力所做的功与路径无关，并且可以表示为标量势能函数（即应变能 $U$）的变化。该系统的总应变能是节点位移 $u = \\begin{pmatrix} u_1 & u_2 & u_3 \\end{pmatrix}^T$ 的二次函数：\n$$U(u) = \\frac{1}{2} k_{12} (u_1-u_2)^2 + \\frac{1}{2} k_{13} (u_1-u_3)^2 + \\frac{1}{2} k_{23} (u_2-u_3)^2 + \\frac{1}{2} k_{1g} u_1^2 + \\frac{1}{2} k_{2g} u_2^2 + \\frac{1}{2} k_{3g} u_3^2$$\n这可以写成矩阵形式 $U(u) = \\frac{1}{2} u^T K u$。节点力向量 $P$ 是应变能相对于位移的梯度：$P = \\nabla_u U = K u$。刚度矩阵的分量是应变能势的二阶偏导数：$K_{ij} = \\frac{\\partial^2 U}{\\partial u_i \\partial u_j}$。根据混合偏导数的相等性（Clairaut 定理），如果 $U$ 是二阶连续可微的（它确实是，因为它是一个二次多项式），那么 $\\frac{\\partial^2 U}{\\partial u_i \\partial u_j} = \\frac{\\partial^2 U}{\\partial u_j \\partial u_i}$，这意味着 $K_{ij} = K_{ji}$。因此，对于线性保守系统，标量能量势的存在保证了其刚度矩阵的对称性。\n\n其次，我们求解两个载荷工况 $P^{(1)}$ 和 $P^{(2)}$ 的位移向量 $u^{(1)}$ 和 $u^{(2)}$。这需要求解线性系统 $K u^{(i)} = P^{(i)}$。我们求 $K$ 的逆矩阵。$K$ 的行列式为：\n$$\\det(K) = 7(10 \\cdot 10 - (-3)(-3)) - (-2)((-2)10 - (-3)(-1)) + (-1)((-2)(-3) - 10(-1))$$\n$$\\det(K) = 7(91) + 2(-23) -1(16) = 637 - 46 - 16 = 575$$\n$K$ 的伴随矩阵 $\\text{adj}(K)$ 是其代数余子式矩阵的转置。对于对称矩阵，其代数余子式矩阵也是对称的，因此 $\\text{adj}(K)$ 为：\n$$\\text{adj}(K) = \\begin{pmatrix} 100-9 & -(-20-3) & 6+10 \\\\ -(-20-3) & 70-1 & -(-21-2) \\\\ 6+10 & -(-21-2) & 70-4 \\end{pmatrix} = \\begin{pmatrix} 91 & 23 & 16 \\\\ 23 & 69 & 23 \\\\ 16 & 23 & 66 \\end{pmatrix}$$\n逆刚度矩阵，或称柔度矩阵，是 $K^{-1} = \\frac{1}{\\det(K)} \\text{adj}(K)$：\n$$K^{-1} = \\frac{1}{575} \\begin{pmatrix} 91 & 23 & 16 \\\\ 23 & 69 & 23 \\\\ 16 & 23 & 66 \\end{pmatrix}$$\n我们现在计算位移向量：\n$$u^{(1)} = K^{-1} P^{(1)} = \\frac{1}{575} \\begin{pmatrix} 91 & 23 & 16 \\\\ 23 & 69 & 23 \\\\ 16 & 23 & 66 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 2 \\end{pmatrix} = \\frac{1}{575} \\begin{pmatrix} 91(1) + 16(2) \\\\ 23(1) + 23(2) \\\\ 16(1) + 66(2) \\end{pmatrix} = \\frac{1}{575} \\begin{pmatrix} 123 \\\\ 69 \\\\ 148 \\end{pmatrix}$$\n$$u^{(2)} = K^{-1} P^{(2)} = \\frac{1}{575} \\begin{pmatrix} 91 & 23 & 16 \\\\ 23 & 69 & 23 \\\\ 16 & 23 & 66 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 3 \\\\ 1 \\end{pmatrix} = \\frac{1}{575} \\begin{pmatrix} 23(3) + 16(1) \\\\ 69(3) + 23(1) \\\\ 23(3) + 66(1) \\end{pmatrix} = \\frac{1}{575} \\begin{pmatrix} 69+16 \\\\ 207+23 \\\\ 69+66 \\end{pmatrix} = \\frac{1}{575} \\begin{pmatrix} 85 \\\\ 230 \\\\ 135 \\end{pmatrix}$$\n\n第三，我们计算标量积 $P^{(1)} \\cdot u^{(2)}$ 和 $P^{(2)} \\cdot u^{(1)}$。在矩阵表示法中，它们是 $(P^{(1)})^T u^{(2)}$ 和 $(P^{(2)})^T u^{(1)}$。\n$$(P^{(1)})^T u^{(2)} = \\begin{pmatrix} 1 & 0 & 2 \\end{pmatrix} \\frac{1}{575} \\begin{pmatrix} 85 \\\\ 230 \\\\ 135 \\end{pmatrix} = \\frac{1}{575} (1 \\cdot 85 + 0 \\cdot 230 + 2 \\cdot 135) = \\frac{85 + 270}{575} = \\frac{355}{575}$$\n$$(P^{(2)})^T u^{(1)} = \\begin{pmatrix} 0 & 3 & 1 \\end{pmatrix} \\frac{1}{575} \\begin{pmatrix} 123 \\\\ 69 \\\\ 148 \\end{pmatrix} = \\frac{1}{575} (0 \\cdot 123 + 3 \\cdot 69 + 1 \\cdot 148) = \\frac{207 + 148}{575} = \\frac{355}{575}$$\n等式得到验证。我们通过将分子和分母除以它们的最大公约数来简化这个有理数。$355 = 5 \\times 71$ 且 $575 = 5 \\times 115 = 5 \\times 5 \\times 23$。公因数为 $5$。\n$$\\frac{355}{575} = \\frac{71}{115}$$\n这些标量积的相等性是 Betti 互易定理的直接体现。该定理指出，对于一个承受两组力系 $\\{P^{(1)}, u^{(1)}\\}$ 和 $\\{P^{(2)}, u^{(2)}\\}$ 的线性弹性体，第一组力系在第二组位移上所做的功等于第二组力系在第一组位移上所做的功。在数学上表示为 $(P^{(1)})^T u^{(2)} = (P^{(2)})^T u^{(1)}$。证明如下：\n$$(P^{(1)})^T u^{(2)} = (K u^{(1)})^T u^{(2)} = (u^{(1)})^T K^T u^{(2)}$$\n$$(P^{(2)})^T u^{(1)} = (u^{(1)})^T P^{(2)} = (u^{(1)})^T K u^{(2)}$$\n由于我们已经确定 $K$ 是对称的（$K^T=K$），因此这两个表达式是相同的。\n\n第四，我们解释其物理意义。标量积 $P \\cdot u$ 表示外力 $P$ 通过位移 $u$ 对系统所做的功。因此，量 $(P^{(1)})^T u^{(2)}$ 和 $(P^{(2)})^T u^{(1)}$ 是互易功或‘相互作用功’项。\n\nClapeyron 定理指出，对于一个承受单一力系 $P$ 并产生位移 $u$ 的线性弹性系统，外力所做的功等于储存在物体中的应变能，且两者都等于最终力和最终位移标量积的一半：$W_{ext} = U = \\frac{1}{2} P \\cdot u$。因子 $\\frac{1}{2}$ 的出现是因为力是逐渐施加的，并且力-位移关系是线性的。\n如果我们考虑一个组合载荷 $P = P^{(1)} + P^{(2)}$，根据叠加原理，总位移为 $u = u^{(1)} + u^{(2)}$。总应变能为：\n$$U_{total} = \\frac{1}{2} (P^{(1)}+P^{(2)}) \\cdot (u^{(1)}+u^{(2)}) = \\frac{1}{2} P^{(1)}\\cdot u^{(1)} + \\frac{1}{2} P^{(2)}\\cdot u^{(2)} + \\frac{1}{2} (P^{(1)}\\cdot u^{(2)} + P^{(2)}\\cdot u^{(1)})$$\n对单个载荷工况使用 Clapeyron 定理，$U_1 = \\frac{1}{2} P^{(1)}\\cdot u^{(1)}$ 和 $U_2 = \\frac{1}{2} P^{(2)}\\cdot u^{(2)}$，我们可以写出：\n$$U_{total} = U_1 + U_2 + P^{(1)} \\cdot u^{(2)}$$\n这里我们使用了互易性 $P^{(1)} \\cdot u^{(2)} = P^{(2)} \\cdot u^{(1)}$。因此，项 $P^{(1)} \\cdot u^{(2)}$ 代表相互作用能，即由于同时施加两组载荷，在系统中储存的超出分别施加它们时能量总和的额外应变能。\n\n这两个标量积的共同值是所要求的最终答案。", "answer": "$$\\boxed{\\frac{71}{115}}$$", "id": "2618449"}, {"introduction": "一个定理的适用范围与其前提假设同样重要。贝蒂定理依赖于弹性张量的主对称性 ($C_{ijkl} = C_{klij}$)，而本练习将通过一个精心设计的思想实验带领您探索当此条件不满足时的情形。您将为一个不具备主对称性的假想材料计算其“互易缺陷” $\\Delta = s^{(1)}\\!\\cdot e^{(2)} - s^{(2)}\\!\\cdot e^{(1)}$，通过计算一个非零结果，您将深刻理解为何主对称性是贝蒂定理成立的根本前提 [@problem_id:2618441]。", "problem": "考虑一个均匀、线性响应、小应变的平面应变固体，其厚度为单位1，占据一个有界域，单位厚度的体积为 $V$，且不受体力作用。对对称张量采用 Mandel 矢量化表示，因此应变矢量为 $e = [\\,\\varepsilon_{xx}, \\varepsilon_{yy}, \\sqrt{2}\\,\\varepsilon_{xy}\\,]^{\\mathsf{T}}$，应力矢量为 $s = [\\,\\sigma_{xx}, \\sigma_{yy}, \\sqrt{2}\\,\\sigma_{xy}\\,]^{\\mathsf{T}}$。在此表示法中，柯西应力-应变定律为 $s = \\mathsf{C}\\,e$，其中 $\\mathsf{C}$ 是一个常数 $3\\times 3$ 矩阵，其元素单位为帕斯卡。根据 Mandel 映射的构造，其次对称性 $C_{ijkl}=C_{jikl}$ 和 $C_{ijkl}=C_{ijlk}$ 成立，而主对称性 $C_{ijkl}=C_{klij}$ 等价于矩阵 $\\mathsf{C}$ 是对称的。\n\n现在考虑一个缺乏主对称性的本构算子，\n$$\n\\mathsf{C} \\;=\\; \\begin{pmatrix}\n30\\times 10^{9} & 0 & 10\\times 10^{9} \\\\\n0 & 20\\times 10^{9} & 0 \\\\\n0 & 0 & 15\\times 10^{9}\n\\end{pmatrix}\\!,\n$$\n使得其反对称部分 $\\tfrac{1}{2}(\\mathsf{C}-\\mathsf{C}^{\\mathsf{T}})\\neq \\boldsymbol{0}$。考虑两个相容的、空间均匀的小应变状态（因此由线性位移场生成）：\n$$\ne^{(1)} \\;=\\; \\begin{bmatrix} 1.0\\times 10^{-3} \\\\ 0 \\\\ 0 \\end{bmatrix}, \n\\qquad\ne^{(2)} \\;=\\; \\begin{bmatrix} 0 \\\\ 0 \\\\ 2.0\\times 10^{-3} \\end{bmatrix}.\n$$\n对于每个状态 $k\\in\\{1,2\\}$，相应的均匀柯西应力为 $s^{(k)}=\\mathsf{C}\\,e^{(k)}$，边界面力是平衡均匀应力所需的面力（你可以假设对于每个状态，由于场是均匀的且体力为零，外功密度等于内功密度）。\n\n定义单位体积的互易性缺陷\n$$\n\\Delta \\;=\\; s^{(1)}\\!\\cdot e^{(2)} \\;-\\; s^{(2)}\\!\\cdot e^{(1)},\n$$\n其中点号表示 Mandel 内积，它与双点积 $s\\!\\cdot e = \\sigma:\\varepsilon$ 一致，单位为能量密度。显式计算 $\\Delta$。以 $\\mathrm{J/m^{3}}$ 为单位表示你的最终答案，并将其四舍五入到四位有效数字。", "solution": "首先对问题陈述进行验证。\n\n步骤1：提取已知条件。\n问题提供了以下信息：\n- 一个均匀、线性响应、小应变的平面应变固体，厚度为单位1。\n- 不存在体力。\n- 应变 $e = [\\,\\varepsilon_{xx}, \\varepsilon_{yy}, \\sqrt{2}\\,\\varepsilon_{xy}\\,]^{\\mathsf{T}}$ 和应力 $s = [\\,\\sigma_{xx}, \\sigma_{yy}, \\sqrt{2}\\,\\sigma_{xy}\\,]^{\\mathsf{T}}$ 的 Mandel 矢量化表示。\n- 本构定律为 $s = \\mathsf{C}\\,e$，其中 $\\mathsf{C}$ 是一个常数 $3 \\times 3$ 矩阵。\n- 缺乏主对称性（$\\mathsf{C} \\neq \\mathsf{C}^{\\mathsf{T}}$）的具体本构矩阵如下：\n$$\n\\mathsf{C} = \\begin{pmatrix}\n30 \\times 10^{9} & 0 & 10 \\times 10^{9} \\\\\n0 & 20 \\times 10^{9} & 0 \\\\\n0 & 0 & 15 \\times 10^{9}\n\\end{pmatrix} \\, \\text{Pa}\n$$\n- 给定了两个均匀的小应变状态：\n$$\ne^{(1)} = \\begin{bmatrix} 1.0 \\times 10^{-3} \\\\ 0 \\\\ 0 \\end{bmatrix}, \\qquad\ne^{(2)} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 2.0 \\times 10^{-3} \\end{bmatrix}\n$$\n- 相应的均匀应力状态为 $s^{(k)} = \\mathsf{C}\\,e^{(k)}$，其中 $k \\in \\{1, 2\\}$。\n- 单位体积的互易性缺陷定义为：\n$$\n\\Delta = s^{(1)} \\cdot e^{(2)} - s^{(2)} \\cdot e^{(1)}\n$$\n- 任务是计算 $\\Delta$，以 $\\mathrm{J/m^{3}}$ 表示最终答案，并四舍五入到四位有效数字。\n\n步骤2：使用提取的已知条件进行验证。\n该问题具有科学依据。对缺乏主对称性的本构关系的研究，是非超弹性材料（或所谓的亚弹性材料）的特征，是高等连续介质力学中的一个有效课题。作为线性弹性基石的 Betti 互易定理，依赖于应变能函数的存在，而应变能函数的存在又意味着弹性张量的主对称性。这个问题是一个精心设计的练习，旨在量化违反这种对称性所带来的后果。该问题是适定的，因为所有必要的数据和定义都已提供，可以进行直接且唯一的计算。对于小应变下的刚性材料，这些数值在物理上是合理的。该问题是客观的且陈述精确。这个问题并非无足轻重，因为它需要理解本构张量的结构与互易原理之间的联系。\n\n步骤3：结论与行动。\n问题被判定为有效。将提供完整的解答。\n\n任务是计算单位体积的互易性缺陷 $\\Delta$。其定义如下：\n$$\n\\Delta = s^{(1)} \\cdot e^{(2)} - s^{(2)} \\cdot e^{(1)}\n$$\n其中应力矢量 $s^{(1)}$ 和 $s^{(2)}$ 是通过将本构定律 $s = \\mathsf{C}\\,e$ 应用于给定的应变矢量 $e^{(1)}$ 和 $e^{(2)}$ 来确定的。\n\n首先，我们计算与应变状态 $e^{(1)}$ 对应的应力矢量 $s^{(1)}$：\n$$\ns^{(1)} = \\mathsf{C} e^{(1)} = \\begin{pmatrix}\n30 \\times 10^{9} & 0 & 10 \\times 10^{9} \\\\\n0 & 20 \\times 10^{9} & 0 \\\\\n0 & 0 & 15 \\times 10^{9}\n\\end{pmatrix}\n\\begin{bmatrix}\n1.0 \\times 10^{-3} \\\\\n0 \\\\\n0\n\\end{bmatrix}\n$$\n执行矩阵-矢量乘法：\n$$\ns^{(1)} = \\begin{bmatrix}\n(30 \\times 10^{9}) \\times (1.0 \\times 10^{-3}) + (0 \\times 0) + (10 \\times 10^{9} \\times 0) \\\\\n(0 \\times 1.0 \\times 10^{-3}) + (20 \\times 10^{9} \\times 0) + (0 \\times 0) \\\\\n(0 \\times 1.0 \\times 10^{-3}) + (0 \\times 0) + (15 \\times 10^{9} \\times 0)\n\\end{bmatrix}\n= \\begin{bmatrix}\n30 \\times 10^{6} \\\\\n0 \\\\\n0\n\\end{bmatrix} \\, \\text{Pa}\n$$\n\n接下来，我们计算与应变状态 $e^{(2)}$ 对应的应力矢量 $s^{(2)}$：\n$$\ns^{(2)} = \\mathsf{C} e^{(2)} = \\begin{pmatrix}\n30 \\times 10^{9} & 0 & 10 \\times 10^{9} \\\\\n0 & 20 \\times 10^{9} & 0 \\\\\n0 & 0 & 15 \\times 10^{9}\n\\end{pmatrix}\n\\begin{bmatrix}\n0 \\\\\n0 \\\\\n2.0 \\times 10^{-3}\n\\end{bmatrix}\n$$\n执行矩阵-矢量乘法：\n$$\ns^{(2)} = \\begin{bmatrix}\n(30 \\times 10^{9} \\times 0) + (0 \\times 0) + (10 \\times 10^{9}) \\times (2.0 \\times 10^{-3}) \\\\\n(0 \\times 0) + (20 \\times 10^{9} \\times 0) + (0 \\times 2.0 \\times 10^{-3}) \\\\\n(0 \\times 0) + (0 \\times 0) + (15 \\times 10^{9}) \\times (2.0 \\times 10^{-3})\n\\end{bmatrix}\n= \\begin{bmatrix}\n20 \\times 10^{6} \\\\\n0 \\\\\n30 \\times 10^{6}\n\\end{bmatrix} \\, \\text{Pa}\n$$\n\n现在我们计算 $\\Delta$ 表达式中的两项。点积是标准的欧几里得内积。结果的单位将是帕斯卡（$ \\text{Pa} $），等同于焦耳每立方米（$ \\text{J/m}^{3} $）。\n\n第一项是 $s^{(1)} \\cdot e^{(2)}$：\n$$\ns^{(1)} \\cdot e^{(2)} =\n\\begin{bmatrix}\n30 \\times 10^{6} \\\\\n0 \\\\\n0\n\\end{bmatrix}\n\\cdot\n\\begin{bmatrix}\n0 \\\\\n0 \\\\\n2.0 \\times 10^{-3}\n\\end{bmatrix}\n= (30 \\times 10^{6})(0) + (0)(0) + (0)(2.0 \\times 10^{-3}) = 0 \\, \\text{J/m}^{3}\n$$\n\n第二项是 $s^{(2)} \\cdot e^{(1)}$：\n$$\ns^{(2)} \\cdot e^{(1)} =\n\\begin{bmatrix}\n20 \\times 10^{6} \\\\\n0 \\\\\n30 \\times 10^{6}\n\\end{bmatrix}\n\\cdot\n\\begin{bmatrix}\n1.0 \\times 10^{-3} \\\\\n0 \\\\\n0\n\\end{bmatrix}\n= (20 \\times 10^{6})(1.0 \\times 10^{-3}) + (0)(0) + (30 \\times 10^{6})(0) = 20 \\times 10^{3} \\, \\text{J/m}^{3}\n$$\n\n最后，我们计算 $\\Delta$：\n$$\n\\Delta = 0 - 20 \\times 10^{3} = -20000 \\, \\text{J/m}^{3}\n$$\n问题要求答案四舍五入到四位有效数字。精确值为 $-20000$。为用四位有效数字表示，我们使用科学记数法：\n$$\n\\Delta = -2.000 \\times 10^{4} \\, \\text{J/m}^{3}\n$$\n这个非零结果证实了互易定理的违反，这是所给本构矩阵 $\\mathsf{C}$ 缺乏主对称性的直接后果。对于满足主对称性（$\\mathsf{C} = \\mathsf{C}^{\\mathsf{T}}$）的材料，对于任何一对状态，互易性缺陷 $\\Delta$ 都将恒等于零。", "answer": "$$\\boxed{-2.000 \\times 10^{4}}$$", "id": "2618441"}, {"introduction": "掌握理论的最终目的是为了应用。贝蒂定理不仅是一个优美的理论结果，更是现代计算力学中高效算法（如伴随法）的基石。本练习将引导您利用贝蒂定理设计一个伴随求解程序，从而在不求解整个复杂结构位移场的情况下，高效地计算出您关心的某一个特定点的位移。通过这个实践，您将体会到如何将一个经典理论转化为解决实际工程问题的强大计算工具 [@problem_id:2868483]。", "problem": "给定一些小型的静态线弹性模型，它们在代数层面表示为对称正定刚度矩阵和载荷向量。位移向量由线性系统 $K u = f$ 定义，其中 $K$ 是刚度矩阵，$f$ 是载荷向量，$u$ 是位移向量。您希望计算目标自由度（DOF）（索引为 $j$）上的单个标量位移分量，而无需计算在 $f$ 作用下的完整位移解。请使用从虚功原理和弹性应变能的对称性推导出的 Betti 互易定理，设计一个单次求解的伴随过程，该过程通过在目标自由度上施加单位载荷来进行一次辅助求解。结构是线性的，在每个测试中材料是均匀且各向同性的，并且代数系统已经简化为自由自由度（所有本质边界条件均已施加）。刚度矩阵的单位是牛顿/米，载荷向量的单位是牛顿，因此所求位移必须以米为单位报告。\n\n您的任务是实现一个程序，该程序针对每个测试用例，构造对应于目标自由度上单位力的辅助右端项，使用给定的刚度矩阵求解相关的辅助线性系统，然后利用互易性并使用给定的原始载荷向量来计算目标自由度上的标量位移。以米为单位报告结果，并四舍五入到六位小数。\n\n使用以下测试套件，目标自由度使用从 $0$ 开始的索引：\n- 测试用例 $1$:\n  - $K = \\begin{bmatrix} 12 & -3 & 0 \\\\ -3 & 10 & -2 \\\\ 0 & -2 & 5 \\end{bmatrix}$ (牛顿/米)\n  - $f = \\begin{bmatrix} 0 \\\\ 100 \\\\ 50 \\end{bmatrix}$ (牛顿)\n  - $j = 2$\n- 测试用例 $2$:\n  - $K = \\begin{bmatrix} 8 & -2 \\\\ -2 & 4 \\end{bmatrix}$ (牛顿/米)\n  - $f = \\begin{bmatrix} 0 \\\\ 10 \\end{bmatrix}$ (牛顿)\n  - $j = 0$\n- 测试用例 $3$:\n  - $K = \\begin{bmatrix} 6 & -2 & 0 \\\\ -2 & 5 & -1 \\\\ 0 & -1 & 3 \\end{bmatrix}$ (牛顿/米)\n  - $f = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix}$ (牛顿)\n  - $j = 1$\n- 测试用例 $4$:\n  - $K = \\begin{bmatrix} 20 & -5 & 0 & 0 \\\\ -5 & 15 & -3 & 0 \\\\ 0 & -3 & 12 & -4 \\\\ 0 & 0 & -4 & 9 \\end{bmatrix}$ (牛顿/米)\n  - $f = \\begin{bmatrix} 0 \\\\ 0 \\\\ 100 \\\\ 0 \\end{bmatrix}$ (牛顿)\n  - $j = 2$\n\n算法约束：\n- 独立处理每个测试。\n- 对每个测试，使用给定的刚度矩阵和一个在自由度 $j$ 处施加单位力、在其他地方为零的辅助右端项，执行恰好一次辅助线性求解。\n- 通过互易性，利用辅助位移场和给定的原始载荷向量来提取目标位移。\n- 将每个最终的标量位移以米为单位表示，并四舍五入到六位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含按测试用例 1 到 4 的顺序排列的结果，格式为用方括号括起来的、无空格的逗号分隔列表。\n- 每个条目必须是浮点数，小数点后恰好有六位数字（单位：米）。\n- 示例格式（仅供说明）：$[0.123456,1.000000,0.000000,2.500000]$。", "solution": "我们考虑一个在有限元法 (FEM) 中的静态、线性、小应变弹性系统，该系统在施加本质边界条件后被简化为自由自由度 (DOF)。设 $K \\in \\mathbb{R}^{n \\times n}$ 为全局对称正定刚度矩阵，$f \\in \\mathbb{R}^{n}$ 为外载荷向量，$u \\in \\mathbb{R}^{n}$ 为位移向量，它们通过以下线性系统相关联：\n$$\nK u = f.\n$$\n我们关心的是目标自由度索引 $j \\in \\{0,1,\\dots,n-1\\}$ 上的单个标量位移分量 $u_j$，以米为单位。通过求解 $K u = f$ 来直接计算是可行的，但如果只需要一个分量，这种方法的计算成本可能过高。Betti 互易定理（也称为 Maxwell–Betti 互易性）提供了一种通过单次辅助求解来计算 $u_j$ 的方法。\n\n理论基础：\n- 虚功原理指出，对于任何运动学容许的虚位移 $\\delta u$，内虚功等于外虚功：\n$$\n\\delta W_{\\text{int}} = \\delta W_{\\text{ext}}.\n$$\n- 在线弹性理论中，由于线性本构行为，内虚功在位移场中是双线性的，并与一个对称的应变能密度相关联。对于两个平衡状态 $(u^{(a)}, f^{(a)})$ 和 $(u^{(b)}, f^{(b)})$，它们具有相同的 $K$ 并满足 $K u^{(a)} = f^{(a)}$ 和 $K u^{(b)} = f^{(b)}$， $K$ 的对称性意味着以下互易恒等式成立：\n$$\n\\left(u^{(a)}\\right)^{\\!\\top} K u^{(b)} = \\left(u^{(b)}\\right)^{\\!\\top} K u^{(a)}.\n$$\n- 代入平衡方程 $K u^{(a)} = f^{(a)}$ 和 $K u^{(b)} = f^{(b)}$，得到 Maxwell–Betti 关系式：\n$$\n\\left(f^{(a)}\\right)^{\\!\\top} u^{(b)} = \\left(f^{(b)}\\right)^{\\!\\top} u^{(a)}.\n$$\n\n伴随构造：\n- 选择状态 $(a)$ 为原始载荷： $f^{(a)} = f$，其解为 $u^{(a)} = u$。\n- 选择状态 $(b)$ 为辅助（伴随）载荷，它在目标自由度 $j$ 处施加单位力，在其他地方为零：\n$$\nf^{(b)} = e_j,\n$$\n其中 $e_j \\in \\mathbb{R}^{n}$ 是第 $j$ 个标准基向量。相应的辅助位移是 $u^{(b)} = w$，由辅助系统得到：\n$$\nK w = e_j.\n$$\n- 应用 Maxwell–Betti 定理：\n$$\nf^{\\top} w = e_j^{\\top} u = u_j.\n$$\n因此，我们感兴趣的标量 $u_j$ 等于原始载荷向量 $f$ 在辅助位移场 $w$ 上所做的功。\n\n单位：\n- $K$ 的单位是牛顿/米。辅助右端项 $e_j$ 的单位是牛顿，大小为 1。因此，$w$ 的单位是米/牛顿，$f^{\\top} w$ 的单位是米，与目标位移分量的单位相匹配。\n\n每个测试用例的算法：\n- 构造 $e_j$，使其在索引 $j$ 处为 1，其他地方为 0。\n- 求解线性系统 $K w = e_j$ 以得到 $w$。\n- 计算标量 $u_j = f^{\\top} w$。\n- 将 $u_j$ 四舍五入到六位小数，并以米为单位报告。\n\n数值实现细节：\n- 测试套件中的矩阵 $K$ 是小型的、对称的、严格对角占优的，因此是对称正定的；一个直接稠密求解器就足够了。\n- 为确保零的清晰表示，如果对于一个小的容差 $\\varepsilon$ 有 $|u_j| < \\varepsilon$，我们可以在四舍五入前将 $u_j$ 设为 0，以避免带符号零的误差。\n- 最终输出为单行，采用所要求的精确格式：用方括号括起来、无空格的逗号分隔列表，每个值显示到小数点后六位。\n\n这个过程每个测试用例只使用一次辅助求解，并通过一次内积来计算所需的标量，从而实现了 Betti 互易定理所要求的单次求解伴随计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef adjoint_displacement(K: np.ndarray, f: np.ndarray, j: int) -> float:\n    \"\"\"\n    Compute the displacement at DOF j using a single auxiliary (adjoint) solve:\n    Solve K w = e_j, then return f^T w.\n    \"\"\"\n    n = K.shape[0]\n    e = np.zeros(n, dtype=float)\n    e[j] = 1.0  # unit load at target DOF\n    # Solve the auxiliary system\n    w = np.linalg.solve(K, e)\n    # Reciprocity: u_j = f^T w\n    uj = float(np.dot(f, w))\n    # Clean near-zero for formatting\n    if abs(uj) < 1e-12:\n        uj = 0.0\n    return uj\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (K, f, j)\n    test_cases = [\n        (\n            np.array([[12.0, -3.0,  0.0],\n                      [-3.0, 10.0, -2.0],\n                      [ 0.0, -2.0,  5.0]], dtype=float),\n            np.array([0.0, 100.0, 50.0], dtype=float),\n            2\n        ),\n        (\n            np.array([[ 8.0, -2.0],\n                      [-2.0,  4.0]], dtype=float),\n            np.array([0.0, 10.0], dtype=float),\n            0\n        ),\n        (\n            np.array([[ 6.0, -2.0,  0.0],\n                      [-2.0,  5.0, -1.0],\n                      [ 0.0, -1.0,  3.0]], dtype=float),\n            np.array([0.0, 0.0, 0.0], dtype=float),\n            1\n        ),\n        (\n            np.array([[20.0, -5.0,  0.0,  0.0],\n                      [-5.0, 15.0, -3.0,  0.0],\n                      [ 0.0, -3.0, 12.0, -4.0],\n                      [ 0.0,  0.0, -4.0,  9.0]], dtype=float),\n            np.array([0.0, 0.0, 100.0, 0.0], dtype=float),\n            2\n        ),\n    ]\n\n    results = []\n    for K, f, j in test_cases:\n        uj = adjoint_displacement(K, f, j)\n        results.append(f\"{uj:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2868483"}]}