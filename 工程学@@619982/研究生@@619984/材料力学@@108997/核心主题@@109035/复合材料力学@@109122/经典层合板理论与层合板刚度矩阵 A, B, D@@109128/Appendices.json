{"hands_on_practices": [{"introduction": "掌握经典层合板理论的第一步是深刻理解其基本构建单元——单向复合材料层。本练习将引导您从第一性原理出发，为一个离轴单层板推导其拉伸刚度矩阵 $[A]$。通过这个过程，您将揭示拉伸-剪切耦合项（$A_{16}$ 和 $A_{26}$）的物理来源，这是各向异性材料在非主轴方向上受力时表现出的独特行为。", "problem": "在经典层合板理论（CLT）框架下，对一个承受平面应力的单一正交各向异性单层板进行建模。该单层板的材料主轴记为 $\\{1,2\\}$，层合板的全局坐标系为 $\\{x,y\\}$。该单层板的弹性性能为 $E_{1}=135\\,\\mathrm{GPa}$，$E_{2}=10\\,\\mathrm{GPa}$，$\\nu_{12}=0.30$ 以及 $G_{12}=5\\,\\mathrm{GPa}$。该单层板作为单一离轴铺层铺设，其角度 $\\theta=30^{\\circ}$ 是在板平面内从 $x$ 轴到 $1$ 轴测量的。铺层厚度为 $h=0.25\\,\\mathrm{mm}$。铺层的中面与层合板的中面重合，因此该铺层占据 $z\\in[-h/2,+h/2]$ 的空间。\n\n仅从以下条件出发：\n- 材料坐标系下的正交各向异性平面应力本构关系，$\\{\\sigma_{1},\\sigma_{2},\\tau_{12}\\}^{\\mathsf{T}}=[Q]\\{\\epsilon_{1},\\epsilon_{2},\\gamma_{12}\\}^{\\mathsf{T}}$，其中 $[Q]$ 由平面应力条件下的 $(E_{1},E_{2},\\nu_{12},G_{12})$ 确定，以及\n- 在 $\\{1,2\\}$ 和 $\\{x,y\\}$ 坐标系之间旋转 $\\theta$ 角度的应力和应变张量变换关系，\n\n推导转换后的折算刚度矩阵 $[\\bar{Q}](\\theta)$，然后推导拉伸刚度矩阵 $[A]=\\int_{-h/2}^{+h/2}[\\bar{Q}]\\,\\mathrm{d}z=[\\bar{Q}](\\theta)\\,h$。明确指出并讨论对于单一离轴铺层，非对角线上的拉伸-剪切耦合项 $A_{16}$ 和 $A_{26}$ 不为零的条件，并根据力-应变耦合解释其物理意义。最后，根据CLT中沿厚度积分的基本原理，解析地验证当单个铺层关于中面对称放置时，耦合刚度矩阵 $[B]=\\int_{-h/2}^{+h/2}z[\\bar{Q}]\\,\\mathrm{d}z$ 为零。\n\n计算给定数据下标量项 $A_{16}$ 的数值。最终结果以 $\\mathrm{N/m}$ 为单位表示，并四舍五入到四位有效数字。角度使用度数。", "solution": "在尝试求解之前，对所提出的问题进行验证。\n\n### 步骤 1：提取已知条件\n- **系统**：承受平面应力的单一正交各向异性单层板。\n- **坐标系**：材料主轴为 $\\{1,2\\}$；层合板全局坐标系为 $\\{x,y\\}$。\n- **材料性能**：\n  - $E_{1}=135\\,\\mathrm{GPa}$\n  - $E_{2}=10\\,\\mathrm{GPa}$\n  - $\\nu_{12}=0.30$\n  - $G_{12}=5\\,\\mathrm{GPa}$\n- **几何与铺层**：\n  - 单一铺层，取向角 $\\theta=30^{\\circ}$。\n  - 铺层厚度 $h=0.25\\,\\mathrm{mm}$。\n  - 铺层位于 $z\\in[-h/2,+h/2]$，以层合板中面为中心。\n- **要求推导和完成的任务**：\n  1. 从材料坐标系中的平面应力本构关系 $\\{\\sigma\\}_1=[Q]\\{\\epsilon\\}_1$ 和张量变换关系出发。\n  2. 推导转换后的折算刚度矩阵 $[\\bar{Q}](\\theta)$。\n  3. 推导拉伸刚度矩阵 $[A]=[\\bar{Q}]h$。\n  4. 确定并讨论 $A_{16}$ 和 $A_{26}$ 不为零的条件，并解释其物理意义。\n  5. 解析地验证耦合刚度矩阵 $[B]$ 为零。\n  6. 计算 $A_{16}$ 的数值，单位为 $\\mathrm{N/m}$，并四舍五入至四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题完全基于经典层合板理论（CLT），这是复合材料力学中一个基础且成熟的框架。所有方程、性质和概念都是该领域的标准内容。材料性能对于单向纤维增强聚合物复合材料是符合实际的。该问题在科学上是合理的。\n- **适定性**：该问题是自洽的，为获得唯一解提供了所有必要的数据和边界条件。各项任务都规定得很清楚。\n- **客观性**：该问题以精确的技术语言陈述，没有任何主观性或模糊性。\n\n### 步骤 3：判定与行动\n该问题被判定为**有效**。这是一个材料力学中的标准、适定问题，旨在检验对基本原理的理解。将提供解答。\n\n***\n\n解答过程如下。我们按照要求，从基本原理出发推导所需的矩阵和关系。\n\n**1. 材料坐标系中的折算刚度矩阵 $[Q]$**\n\n对于处于平面应力状态（$\\sigma_3 = \\tau_{13} = \\tau_{23} = 0$）下的正交各向异性材料，其在材料主轴 $\\{1,2\\}$ 上的应力-应变关系由 $\\{\\sigma\\}_1 = [Q]\\{\\epsilon\\}_1$ 给出，即：\n$$\n\\begin{pmatrix} \\sigma_1 \\\\ \\sigma_2 \\\\ \\tau_{12} \\end{pmatrix} = \\begin{pmatrix} Q_{11} & Q_{12} & 0 \\\\ Q_{12} & Q_{22} & 0 \\\\ 0 & 0 & Q_{66} \\end{pmatrix} \\begin{pmatrix} \\epsilon_1 \\\\ \\epsilon_2 \\\\ \\gamma_{12} \\end{pmatrix}\n$$\n折算刚度矩阵 $[Q]$ 的各分量由工程常数定义如下：\n$Q_{11} = \\frac{E_1}{1-\\nu_{12}\\nu_{21}}$，$Q_{22} = \\frac{E_2}{1-\\nu_{12}\\nu_{21}}$，$Q_{12} = \\frac{\\nu_{12}E_2}{1-\\nu_{12}\\nu_{21}} = \\frac{\\nu_{21}E_1}{1-\\nu_{12}\\nu_{21}}$，以及 $Q_{66} = G_{12}$。\n根据互易关系 $\\frac{\\nu_{12}}{E_1} = \\frac{\\nu_{21}}{E_2}$，我们得到 $\\nu_{21} = \\nu_{12}\\frac{E_2}{E_1}$。\n\n**2. 转换后的折算刚度矩阵 $[\\bar{Q}]$ 的推导**\n\n转换后的矩阵 $[\\bar{Q}]$ 关联了全局坐标系 $\\{x,y\\}$ 中的应力和应变：$\\{\\sigma\\}_x = [\\bar{Q}]\\{\\epsilon\\}_x$。我们从应变能密度 $U$ 的不变性来推导 $[\\bar{Q}]$。\n$U = \\frac{1}{2}\\{\\epsilon\\}_1^\\mathsf{T}[Q]\\{\\epsilon\\}_1 = \\frac{1}{2}\\{\\epsilon\\}_x^\\mathsf{T}[\\bar{Q}]\\{\\epsilon\\}_x$。\n\n两个坐标系中的应变向量通过一个变换矩阵 $[T_\\epsilon]$ 相关联：$\\{\\epsilon\\}_1 = [T_\\epsilon]\\{\\epsilon\\}_x$。\n令 $c=\\cos\\theta$ 和 $s=\\sin\\theta$，变换关系为：\n$$\n\\begin{pmatrix} \\epsilon_1 \\\\ \\epsilon_2 \\\\ \\gamma_{12} \\end{pmatrix} = \\begin{pmatrix} c^2 & s^2 & sc \\\\ s^2 & c^2 & -sc \\\\ -2sc & 2sc & c^2-s^2 \\end{pmatrix} \\begin{pmatrix} \\epsilon_x \\\\ \\epsilon_y \\\\ \\gamma_{xy} \\end{pmatrix}\n$$\n将此代入应变能表达式：\n$U = \\frac{1}{2}([T_\\epsilon]\\{\\epsilon\\}_x)^\\mathsf{T}[Q]([T_\\epsilon]\\{\\epsilon\\}_x) = \\frac{1}{2}\\{\\epsilon\\}_x^\\mathsf{T}([T_\\epsilon]^\\mathsf{T}[Q][T_\\epsilon])\\{\\epsilon\\}_x$。\n通过比较，我们得到刚度矩阵的变换法则：\n$$\n[\\bar{Q}] = [T_\\epsilon]^\\mathsf{T}[Q][T_\\epsilon]\n$$\n为了求出对应于 $[\\bar{Q}]$ 第一行第三列的元素 $\\bar{Q}_{16}$，我们进行矩阵乘法运算。\n$$\n\\bar{Q}_{16} = ([T_\\epsilon]^\\mathsf{T})_{1k} Q_{kl} (T_\\epsilon)_{l3}\n$$\n$[T_\\epsilon]^\\mathsf{T}$ 的第一行为 $\\{c^2, s^2, -2sc\\}$。$[T_\\epsilon]$ 的第三列为 $\\{sc, -sc, c^2-s^2\\}^\\mathsf{T}$。\n首先进行 $[Q][T_\\epsilon]_{\\text{col 3}}$ 的乘法运算：\n$$\n\\begin{pmatrix} Q_{11} & Q_{12} & 0 \\\\ Q_{12} & Q_{22} & 0 \\\\ 0 & 0 & Q_{66} \\end{pmatrix} \\begin{pmatrix} sc \\\\ -sc \\\\ c^2-s^2 \\end{pmatrix} = \\begin{pmatrix} sc(Q_{11}-Q_{12}) \\\\ sc(Q_{12}-Q_{22}) \\\\ Q_{66}(c^2-s^2) \\end{pmatrix}\n$$\n然后，与 $[T_\\epsilon]^\\mathsf{T}$ 的第一行进行点积：\n$$\n\\bar{Q}_{16} = c^2[sc(Q_{11}-Q_{12})] + s^2[sc(Q_{12}-Q_{22})] -2sc[Q_{66}(c^2-s^2)]\n$$\n$$\n\\bar{Q}_{16} = sc^3(Q_{11}-Q_{12}) + s^3c(Q_{12}-Q_{22}) - 2sc(c^2-s^2)Q_{66}\n$$\n$$\n\\bar{Q}_{16} = sc^3 Q_{11} - sc^3 Q_{12} + s^3c Q_{12} - s^3c Q_{22} - 2sc^3 Q_{66} + 2s^3c Q_{66}\n$$\n将含 $sc^3$ 和 $s^3c$ 的项分组：\n$$\n\\bar{Q}_{16} = sc^3(Q_{11} - Q_{12} - 2Q_{66}) + s^3c(Q_{12} - Q_{22} + 2Q_{66})\n$$\n$$\n\\bar{Q}_{16} = sc^3(Q_{11} - Q_{12} - 2Q_{66}) - s^3c(Q_{22} - Q_{12} - 2Q_{66})\n$$\n这就是推导出的 $\\bar{Q}_{16}$ 表达式。类似的推导可得出 $\\bar{Q}_{26}$ 的表达式：$\\bar{Q}_{26} = s^3c(Q_{11}-Q_{12}-2Q_{66}) - sc^3(Q_{22}-Q_{12}-2Q_{66})$。\n\n**3. 刚度矩阵 $[A]$ 与拉伸-剪切耦合**\n\n拉伸刚度矩阵 $[A]$ 定义为转换后的折算刚度矩阵 $[\\bar{Q}]$ 沿层合板厚度 $H$ 的积分：\n$$\n[A] = \\int_{-H/2}^{H/2} [\\bar{Q}](z) \\mathrm{d}z\n$$\n对于厚度为 $h$ 的单个铺层，层合板厚度为 $H=h$，且 $[\\bar{Q}]$ 是常数。\n$$\n[A] = [\\bar{Q}] \\int_{-h/2}^{h/2} \\mathrm{d}z = [\\bar{Q}] [z]_{-h/2}^{h/2} = [\\bar{Q}]h\n$$\n拉伸-剪切耦合项为 $A_{16} = \\bar{Q}_{16}h$ 和 $A_{26} = \\bar{Q}_{26}h$。这些项不为零的充分必要条件是 $\\bar{Q}_{16}$ 和 $\\bar{Q}_{26}$ 不为零。从推导出的 $\\bar{Q}_{16}$ 表达式可以看出，它与 $sc = \\sin\\theta\\cos\\theta = \\frac{1}{2}\\sin(2\\theta)$ 成正比。此项仅在 $\\theta = 0$ 或 $\\theta = \\pi/2$（对于 $\\theta \\in [0, \\pi/2]$）时为零，这对应于在轴方向铺设。对于任何以离轴角度（$\\theta \\neq 0, \\pi/2$）放置的正交各向异性单层板，其项 $A_{16}$ 和 $A_{26}$ 都将不为零。\n\n**物理意义**：$A_{16}$ 和 $A_{26}$ 项代表了拉伸行为和剪切行为之间的耦合。层合板的本构方程为 $\\{N\\} = [A]\\{\\epsilon^0\\} + [B]\\{\\kappa\\}$。对于对称层合板，$[B]=[0]$，我们有：\n$$\n\\begin{pmatrix} N_x \\\\ N_y \\\\ N_{xy} \\end{pmatrix} = \\begin{pmatrix} A_{11} & A_{12} & A_{16} \\\\ A_{12} & A_{22} & A_{26} \\\\ A_{16} & A_{26} & A_{66} \\end{pmatrix} \\begin{pmatrix} \\epsilon_x^0 \\\\ \\epsilon_y^0 \\\\ \\gamma_{xy}^0 \\end{pmatrix}\n$$\n非零 $A_{16}$ 的存在意味着施加的轴向力 $N_x$ 会引起剪切应变 $\\gamma_{xy}^0$，而施加的面内剪切力 $N_{xy}$ 会引起轴向应变 $\\epsilon_x^0$。这是材料在全局坐标系中各向异性的直接结果。\n\n**4. 耦合刚度矩阵 $[B]$ 为零的验证**\n\n耦合刚度矩阵 $[B]$ 定义为：\n$$\n[B] = \\int_{-H/2}^{H/2} [\\bar{Q}](z) z \\, \\mathrm{d}z\n$$\n对于给定的、以中面（$z=0$）为中心、厚度为 $h$ 且 $[\\bar{Q}]$ 为常数的单个铺层，积分区间为 $-h/2$ 到 $+h/2$。\n$$\n[B] = [\\bar{Q}] \\int_{-h/2}^{+h/2} z \\, \\mathrm{d}z\n$$\n几何项的积分为：\n$$\n\\int_{-h/2}^{+h/2} z \\, \\mathrm{d}z = \\left[ \\frac{z^2}{2} \\right]_{-h/2}^{+h/2} = \\frac{1}{2} \\left[ \\left(\\frac{h}{2}\\right)^2 - \\left(-\\frac{h}{2}\\right)^2 \\right] = \\frac{1}{2} \\left( \\frac{h^2}{4} - \\frac{h^2}{4} \\right) = 0\n$$\n因为材料属性沿厚度方向是恒定的，且铺层相对于中面是几何对称的，所以面积一阶矩为零。因此，耦合矩阵是零矩阵：$[B] = [0]$。\n\n**5. $A_{16}$ 的数值计算**\n\n首先，以国际单位制（帕斯卡）计算 $[Q]$ 矩阵的各分量。\n$E_{1}=135 \\times 10^9 \\,\\mathrm{Pa}$, $E_{2}=10 \\times 10^9 \\,\\mathrm{Pa}$, $\\nu_{12}=0.30$, $G_{12}=5 \\times 10^9 \\,\\mathrm{Pa}$。\n$\\nu_{21} = \\nu_{12}\\frac{E_2}{E_1} = 0.30 \\times \\frac{10}{135} = \\frac{1}{45}$。\n$1 - \\nu_{12}\\nu_{21} = 1 - 0.30 \\times \\frac{1}{45} = 1 - \\frac{1}{150} = \\frac{149}{150}$。\n\n$Q_{11} = \\frac{135 \\times 10^9}{149/150} = \\frac{20250}{149} \\times 10^9 \\approx 135.91 \\times 10^9 \\,\\mathrm{Pa}$。\n$Q_{22} = \\frac{10 \\times 10^9}{149/150} = \\frac{1500}{149} \\times 10^9 \\approx 10.07 \\times 10^9 \\,\\mathrm{Pa}$。\n$Q_{12} = \\frac{0.30 \\times 10 \\times 10^9}{149/150} = \\frac{450}{149} \\times 10^9 \\approx 3.02 \\times 10^9 \\,\\mathrm{Pa}$。\n$Q_{66} = G_{12} = 5 \\times 10^9 \\,\\mathrm{Pa}$。\n\n现在计算 $\\bar{Q}_{16}$ 所需的项：\n$U_A = Q_{11} - Q_{12} - 2Q_{66} = (135.91 - 3.02 - 2 \\times 5) \\times 10^9 = 122.89 \\times 10^9 \\,\\mathrm{Pa}$。\n$U_B = Q_{22} - Q_{12} - 2Q_{66} = (10.07 - 3.02 - 2 \\times 5) \\times 10^9 = -2.95 \\times 10^9 \\,\\mathrm{Pa}$。\n\n对于 $\\theta = 30^{\\circ}$，我们有 $c = \\cos(30^{\\circ}) = \\frac{\\sqrt{3}}{2}$ 和 $s = \\sin(30^{\\circ}) = \\frac{1}{2}$。\n$sc^3 = (\\frac{1}{2})(\\frac{\\sqrt{3}}{2})^3 = \\frac{3\\sqrt{3}}{16}$。\n$s^3c = (\\frac{1}{2})^3(\\frac{\\sqrt{3}}{2}) = \\frac{\\sqrt{3}}{16}$。\n\n代入推导出的 $\\bar{Q}_{16}$ 公式中：\n$$\n\\bar{Q}_{16} = U_A (sc^3) - U_B (s^3c) = \\frac{3\\sqrt{3}}{16} U_A - \\frac{\\sqrt{3}}{16} U_B = \\frac{\\sqrt{3}}{16}(3U_A - U_B)\n$$\n$$\n\\bar{Q}_{16} = \\frac{\\sqrt{3}}{16}[3(122.89 \\times 10^9) - (-2.95 \\times 10^9)] \\,\\mathrm{Pa}\n$$\n$$\n\\bar{Q}_{16} = \\frac{\\sqrt{3}}{16}(368.67 + 2.95) \\times 10^9 = \\frac{\\sqrt{3}}{16}(371.62) \\times 10^9 \\approx 40.229 \\times 10^9 \\,\\mathrm{Pa}\n$$\n最后，计算 $A_{16} = \\bar{Q}_{16}h$。厚度为 $h=0.25\\,\\mathrm{mm} = 0.25 \\times 10^{-3}\\,\\mathrm{m}$。\n$$\nA_{16} = (40.229 \\times 10^9 \\,\\mathrm{N/m^2}) \\times (0.25 \\times 10^{-3} \\,\\mathrm{m}) = 10.05725 \\times 10^6 \\,\\mathrm{N/m}\n$$\n四舍五入到四位有效数字，我们得到：\n$$\nA_{16} = 1.006 \\times 10^7 \\,\\mathrm{N/m}\n$$", "answer": "$$\\boxed{1.006 \\times 10^{7}}$$", "id": "2870821"}, {"introduction": "对于非对称铺设的层合板，拉伸与弯曲行为不再是相互独立的，这一现象被称为弯曲-拉伸耦合。本练习提供了一个具体的实例，要求您利用给定的 $[A]$, $[B]$ 和 $[D]$ 矩阵，计算在一个纯弯曲力矩作用下，层合板中面产生的意外拉伸应变。这个实践将帮助您直观地理解非零 $[B]$ 矩阵在层合板设计中的重要性及其物理后果。", "problem": "一个平坦、均匀、正交各向异性的层合板在经典层合板理论（CLT）的框架内进行建模。该层合板的特性由其拉伸刚度矩阵 $[A]$ (单位 $\\mathrm{N/m}$)、弯曲-拉伸耦合矩阵 $[B]$ (单位 $\\mathrm{N}$) 和弯曲刚度矩阵 $[D]$ (单位 $\\mathrm{N\\cdot m}$) 来表征。每个矩阵都是对称的，并以层合板中面（$z=0$）为参考平面。对于一个非对称铺层，测得以下矩阵：\n$$\n[A] = \\begin{pmatrix}\n1.2\\times 10^{8} & 3.0\\times 10^{7} & 0 \\\\\n3.0\\times 10^{7} & 8.0\\times 10^{7} & 0 \\\\\n0 & 0 & 2.5\\times 10^{7}\n\\end{pmatrix} \\ \\mathrm{N/m},\\quad\n[B] = \\begin{pmatrix}\n5.0\\times 10^{3} & 1.0\\times 10^{3} & 0 \\\\\n1.0\\times 10^{3} & 2.5\\times 10^{3} & 0 \\\\\n0 & 0 & 8.0\\times 10^{2}\n\\end{pmatrix} \\ \\mathrm{N},\\quad\n[D] = \\begin{pmatrix}\n45 & 10 & 0 \\\\\n10 & 30 & 0 \\\\\n0 & 0 & 12\n\\end{pmatrix} \\ \\mathrm{N\\cdot m}.\n$$\n面内合力为零，层合板承受绕x轴的单位宽度的纯弯矩：$M_x = 1\\ \\mathrm{N\\cdot m}$，$M_y = 0$，$M_{xy} = 0$。不考虑横向剪切。\n\n从CLT的运动学假设（即面内应变沿厚度方向线性变化，且面内合力与合力矩是应力场的厚度积分）出发，推导从给定的$[A]、[B]、[D]$和力学合力/合力矩确定中面应变向量 $\\boldsymbol{\\epsilon}^0$ 和曲率向量 $\\boldsymbol{\\kappa}$ 所需的关系式。然后，计算由指定载荷引起的x方向正法向中面应变分量 $\\epsilon^0_{xx}$。\n\n将 $\\epsilon^0_{xx}$ 的最终数值答案四舍五入至四位有效数字。将答案表示为一个无量纲数。此外，在你的推导中简要解释，在绕x轴的纯弯曲作用下，非零的 $[B]$ 矩阵对弯曲与 $\\epsilon^0_{xx}$ 之间的耦合意味着什么。", "solution": "经典层合板理论（CLT）基于以下基本要素：\n- 运动学假设，即面内应变沿厚度方向线性变化：对于任意面内分量，可以写出\n$$\n\\boldsymbol{\\epsilon}(z) = \\boldsymbol{\\epsilon}^0 + z\\,\\boldsymbol{\\kappa},\n$$\n其中 $\\boldsymbol{\\epsilon}^0 = \\begin{pmatrix}\\epsilon^0_{xx} & \\epsilon^0_{yy} & \\gamma^0_{xy}\\end{pmatrix}^{\\!\\!T}$ 是中面应变向量，$\\boldsymbol{\\kappa} = \\begin{pmatrix}\\kappa_{x} & \\kappa_{y} & \\kappa_{xy}\\end{pmatrix}^{\\!\\!T}$ 是曲率/扭率向量。\n- 面内合力 $\\mathbf{N} = \\begin{pmatrix}N_x & N_y & N_{xy}\\end{pmatrix}^{\\!\\!T}$ 和合力矩 $\\mathbf{M} = \\begin{pmatrix}M_x & M_y & M_{xy}\\end{pmatrix}^{\\!\\!T}$ 分别定义为应力场乘以权重1和z后在厚度上的积分。利用正交各向异性单层板的本构律并在厚度上积分，可以得到层合板刚度矩阵 $[A]$、$[B]$ 和 $[D]$，这些矩阵将中面应变和曲率映射到合力和合力矩。\n\n通过厚度积分和各铺层的叠加，标准的层合板本构关系为\n$$\n\\mathbf{N} = [A]\\,\\boldsymbol{\\epsilon}^0 + [B]\\,\\boldsymbol{\\kappa},\\qquad\n\\mathbf{M} = [B]\\,\\boldsymbol{\\epsilon}^0 + [D]\\,\\boldsymbol{\\kappa}.\n$$\n这些关系直接来源于 $\\boldsymbol{\\epsilon}(z)$ 对z的线性依赖性以及 $\\mathbf{N}$ 和 $\\mathbf{M}$作为应力积分的定义。\n\n给定载荷 $\\mathbf{N}=\\mathbf{0}$ 和 $\\mathbf{M} = \\begin{pmatrix}1 & 0 & 0\\end{pmatrix}^{T}$ (单位 $\\mathrm{N\\cdot m}$ 每单位宽度)，我们求解 $\\boldsymbol{\\epsilon}^0$ 和 $\\boldsymbol{\\kappa}$。从第一个方程中消去 $\\boldsymbol{\\epsilon}^0$ 得到\n$$\n\\boldsymbol{\\epsilon}^0 = -[A]^{-1}[B]\\,\\boldsymbol{\\kappa}.\n$$\n代入第二个方程得到舒尔补 (Schur complement) 系统\n$$\n\\bigl([D] - [B][A]^{-1}[B]\\bigr)\\,\\boldsymbol{\\kappa} = \\mathbf{M}.\n$$\n一旦 $\\boldsymbol{\\kappa}$ 已知，中面应变即可由下式得出\n$$\n\\boldsymbol{\\epsilon}^0 = -[A]^{-1}[B]\\,\\boldsymbol{\\kappa}.\n$$\n\n因为所提供的 $[A]、[B]、[D]$ 矩阵中，x–y方向的正应力-剪切耦合项为零，所以剪切模式解耦，我们可以使用对应于 $\\{x,y\\}$ 面内正应力分量的左上角 $2\\times 2$ 子矩阵进行计算：\n$$\n[A]_2 = \\begin{pmatrix}1.2\\times 10^{8} & 3.0\\times 10^{7}\\\\ 3.0\\times 10^{7} & 8.0\\times 10^{7}\\end{pmatrix}\\ \\mathrm{N/m},\\quad\n[B]_2 = \\begin{pmatrix}5.0\\times 10^{3} & 1.0\\times 10^{3}\\\\ 1.0\\times 10^{3} & 2.5\\times 10^{3}\\end{pmatrix}\\ \\mathrm{N},\\quad\n[D]_2 = \\begin{pmatrix}45 & 10\\\\ 10 & 30\\end{pmatrix}\\ \\mathrm{N\\cdot m}.\n$$\n计算 $[A]_2^{-1}$。其行列式为\n$$\n\\det([A]_2) = (1.2\\times 10^{8})(8.0\\times 10^{7}) - (3.0\\times 10^{7})^{2} = 8.7\\times 10^{15}.\n$$\n因此\n$$\n[A]_2^{-1} = \\frac{1}{8.7\\times 10^{15}}\n\\begin{pmatrix}\n8.0\\times 10^{7} & -3.0\\times 10^{7}\\\\\n-3.0\\times 10^{7} & 1.2\\times 10^{8}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n9.1954023\\times 10^{-9} & -3.4482759\\times 10^{-9}\\\\\n-3.4482759\\times 10^{-9} & 1.3793103\\times 10^{-8}\n\\end{pmatrix}\\ \\mathrm{m/N}.\n$$\n构建舒尔补\n$$\n[H]_2 \\equiv [D]_2 - [B]_2[A]_2^{-1}[B]_2.\n$$\n首先计算 $[Y]_2 = [B]_2[A]_2^{-1}[B]_2$。利用对称性，其元素为\n$$\nY_{11} = a\\,p^{2} + 2b\\,pq + d\\,q^{2},\\quad\nY_{12} = a\\,pq + b\\,(pr + q^{2}) + d\\,qr,\\quad\nY_{22} = a\\,q^{2} + 2b\\,qr + d\\,r^{2},\n$$\n其中 $a=9.1954023\\times 10^{-9}$，$b=-3.4482759\\times 10^{-9}$，$d=1.3793103\\times 10^{-8}$，并且 $p=5.0\\times 10^{3}$，$q=1.0\\times 10^{3}$，$r=2.5\\times 10^{3}$。这得到\n$$\n[Y]_2 \\approx\n\\begin{pmatrix}\n0.2091954023 & 0.0339080460\\\\\n0.0339080460 & 0.07816091954\n\\end{pmatrix}\\ \\mathrm{N\\cdot m}.\n$$\n因此\n$\n[H]_2 = [D]_2 - [Y]_2\n$\n为\n$$\n[H]_2 \\approx\n\\begin{pmatrix}\n44.790804598 & 9.966091954\\\\\n9.966091954 & 29.9218390805\n\\end{pmatrix}\\ \\mathrm{N\\cdot m}.\n$$\n求解 $[H]_2\\,\\begin{pmatrix}\\kappa_x\\\\ \\kappa_y\\end{pmatrix} = \\begin{pmatrix}1\\\\ 0\\end{pmatrix}$。一个 $2\\times 2$ 对称矩阵的逆矩阵可得\n$$\n\\det([H]_2) \\approx (44.790804598)(29.9218390805) - (9.966091954)^{2} \\approx 1.240900258631\\times 10^{3},\n$$\n因此\n$$\n\\begin{pmatrix}\\kappa_x\\\\ \\kappa_y\\end{pmatrix}\n= [H]_2^{-1}\\begin{pmatrix}1\\\\ 0\\end{pmatrix}\n= \\frac{1}{\\det([H]_2)}\n\\begin{pmatrix}\n29.9218390805\\\\\n-9.966091954\n\\end{pmatrix}\n\\approx\n\\begin{pmatrix}\n2.4113014\\times 10^{-2}\\\\\n-8.0313408\\times 10^{-3}\n\\end{pmatrix}.\n$$\n现在根据 $\\boldsymbol{\\epsilon}^0 = -[A]_2^{-1}[B]_2\\,\\boldsymbol{\\kappa}$ 计算中面应变。首先计算 $[X]_2 \\equiv [A]_2^{-1}[B]_2$：\n$$\n[X]_2 = \n\\begin{pmatrix}\n4.2528735632\\times 10^{-5} & 5.7471264368\\times 10^{-7}\\\\\n-3.4482758621\\times 10^{-6} & 3.1034482759\\times 10^{-5}\n\\end{pmatrix}\\ \\mathrm{m/N}\\cdot \\mathrm{N} = \n\\begin{pmatrix}\n4.2528735632\\times 10^{-5} & 5.7471264368\\times 10^{-7}\\\\\n-3.4482758621\\times 10^{-6} & 3.1034482759\\times 10^{-5}\n\\end{pmatrix}.\n$$\n然后\n$$\n\\epsilon^0_{xx} = -\\Bigl( X_{11}\\,\\kappa_x + X_{12}\\,\\kappa_y \\Bigr)\n\\approx -\\Bigl( (4.2528735632\\times 10^{-5})(2.4113014\\times 10^{-2}) + (5.7471264368\\times 10^{-7})(-8.0313408\\times 10^{-3}) \\Bigr).\n$$\n数值上，\n$$\n(4.2528735632\\times 10^{-5})(2.4113014\\times 10^{-2}) \\approx 1.0254960\\times 10^{-6},\\quad\n(5.7471264368\\times 10^{-7})(-8.0313408\\times 10^{-3}) \\approx -4.615713\\times 10^{-9},\n$$\n所以\n$$\n\\epsilon^0_{xx} \\approx -\\bigl(1.0254960\\times 10^{-6} - 4.615713\\times 10^{-9}\\bigr) \\approx -1.0208803\\times 10^{-6}.\n$$\n四舍五入到四位有效数字，所求的无量纲中面应变分量为\n$$\n\\epsilon^0_{xx} \\approx -1.021\\times 10^{-6}.\n$$\n\n耦合效应解释：非零的弯曲-拉伸耦合矩阵 $[B]$ 直接将曲率与面内中面应变耦合起来。尽管施加的载荷是绕x轴的纯弯矩且面内合力为零，但只要 $[B]\\boldsymbol{\\kappa}\\neq \\mathbf{0}$，关系式 $\\mathbf{N}=[A]\\boldsymbol{\\epsilon}^0 + [B]\\boldsymbol{\\kappa}=\\mathbf{0}$ 就要求 $\\boldsymbol{\\epsilon}^0$ 非零。在此情况下，$B_{11}>0$ 且计算出的曲率 $\\kappa_x>0$，通过 $\\boldsymbol{\\epsilon}^0=-[A]^{-1}[B]\\boldsymbol{\\kappa}$ 导致了负的 $\\epsilon^0_{xx}$。因此，在绕x轴的正弯曲作用下，非对称层合板在x方向上会经历面内中面收缩，这展示了非对称铺层所固有的弯曲-拉伸耦合效应。", "answer": "$$\\boxed{-1.021\\times 10^{-6}}$$", "id": "2870898"}, {"introduction": "现代复合材料结构的设计与分析高度依赖于精确的计算工具。本练习旨在将您对层合板理论的理解从手动计算提升到算法层面。您将设计一个程序，为任意铺层顺序、厚度和角度的层合板系统地组装 $[A]$, $[B]$ 和 $[D]$ 矩阵，这是复合材料工程师必须掌握的一项核心计算技能。", "problem": "你的任务是在经典层合板理论 (Classical Lamination Theory, CLT) 的框架下，设计并实现一个数值稳定且单位一致的程序，用于组装任意层合复合材料的层合板刚度矩阵 $[A]$、$[B]$ 和 $[D]$。该层合板由 $N$ 个正交各向异性单层板组成，每个单层板都有其自身的取向角和厚度。最终目标是为一组测试层合板计算这些全局刚度矩阵的特定标量元素。\n\n请从以下基本原理出发，不要在问题陈述中使用任何预先推导的简化公式：\n- 每个单层板都被建模为均匀、线性弹性、正交各向异性的平面应力材料。\n- 在每个单层板的主材料轴系中，二维应力-应变关系由 $\\{\\sigma\\} = [Q]\\{\\epsilon\\}$ 给出，其中 $[Q]$ 是单层板坐标系中的折算刚度矩阵，$\\{\\sigma\\}$ 和 $\\{\\epsilon\\}$ 分别是面内应力和应变矢量。\n- 层合板中面是位于 $z = 0$ 的参考平面，单位宽度的合应力 $\\{N\\}$ 和单位宽度的合弯矩 $\\{M\\}$ 定义为 $\\{N\\} = \\int_{-h/2}^{h/2} \\{\\sigma\\}\\,dz$ 和 $\\{M\\} = \\int_{-h/2}^{h/2} z\\,\\{\\sigma\\}\\,dz$，其中 $h$ 是层合板的总厚度。\n- 单层板坐标系和层合板坐标系之间的坐标变换，是使用适用于平面应力状态下应力和应变场的适当旋转算子来执行的。\n\n程序要求：\n- 你的算法必须能够为具有可变铺层厚度和角度的任意铺层顺序组装 $[A]$、$[B]$ 和 $[D]$，并强调从第一性原理出发的数值稳定性和单位一致性。你必须实现将每个铺层的折算刚度矩阵从其材料坐标系到层合板坐标系的稳定旋转，使用合适的厚度方向坐标 $z$ 累加各层沿厚度的贡献，并进行严格的单位转换。\n- 所有输入的材料模量必须以吉帕斯卡（$\\mathrm{GPa}$）为单位，并转换为帕斯卡（$\\mathrm{Pa}$）。所有厚度以毫米（$\\mathrm{mm}$）给出，必须转换为米（$\\mathrm{m}$）。所有角度以度为单位给出，必须按度进行解释（在内部根据需要转换为弧度）。\n- 对于每个测试用例，程序必须输出列表 $[A_{11}, A_{12}, A_{22}, B_{16}, D_{66}]$，其单位如下：$[A]$ 的单位是牛顿每米（$\\mathrm{N/m}$），$[B]$ 的单位是牛顿（$\\mathrm{N}$），$[D]$ 的单位是牛顿-米（$\\mathrm{N\\cdot m}$）。输出的数字必须四舍五入到 6 位有效数字。\n- 通过谨慎的三角函数求值、保持刚度张量的对称性，以及采用能够最小化抵消误差的方式进行稳健的厚度方向累加，来强调数值稳定性，特别是在对称或近对称铺层顺序产生非常小的耦合项时。\n\n测试套件：\n你必须为以下 $3$ 个层合板计算结果。对于每个用例，从底面到顶面定义铺层顺序。在该用例中，所有铺层均使用指定的材料属性。\n\n- 用例 $1$ (一般非对称，厚度可变):\n  - 材料: $E_1 = 135\\,\\mathrm{GPa}$, $E_2 = 10\\,\\mathrm{GPa}$, $G_{12} = 5\\,\\mathrm{GPa}$, $\\nu_{12} = 0.3$。\n  - 角度 (度): $[0, 90, 45, -45]$。\n  - 厚度 (毫米): $[0.125, 0.250, 0.125, 0.125]$。\n\n- 用例 $2$ (对称，用于测试 $[B] \\approx [0]$):\n  - 材料: $E_1 = 40\\,\\mathrm{GPa}$, $E_2 = 10\\,\\mathrm{GPa}$, $G_{12} = 4\\,\\mathrm{GPa}$, $\\nu_{12} = 0.25$。\n  - 角度 (度): $[0, 90, 90, 0]$。\n  - 厚度 (毫米): $[0.2, 0.2, 0.2, 0.2]$。\n\n- 用例 $3$ (非对称，具有差别悬殊的铺层厚度，用于测试耦合灵敏度和稳定性):\n  - 材料: $E_1 = 181\\,\\mathrm{GPa}$, $E_2 = 10.3\\,\\mathrm{GPa}$, $G_{12} = 7.17\\,\\mathrm{GPa}$, $\\nu_{12} = 0.28$。\n  - 角度 (度): $[30, -30]$。\n  - 厚度 (毫米): $[0.01, 1.0]$。\n\n角度单位: 所有角度均以度为单位指定，并必须按度进行解释。\n\n输出单位:\n- $A_{11}$、$A_{12}$、$A_{22}$ 单位为 $\\mathrm{N/m}$。\n- $B_{16}$ 单位为 $\\mathrm{N}$。\n- $D_{66}$ 单位为 $\\mathrm{N\\cdot m}$。\n\n最终输出格式:\n- 你的程序应生成单行输出，其中包含每个用例的结果。结果格式为用方括号括起来的、由逗号分隔的列表的列表，不含空格，并严格按照测试用例的顺序排列。例如：$[[a_{11},a_{12},a_{22},b_{16},d_{66}],[...],[...]]$，其中每个条目是四舍五入到 6 位有效数字的浮点数，单位如上所述。", "solution": "所提出的问题是复合材料力学领域一个标准的、适定的问题。它要求基于经典层合板理论 (CLT) 从第一性原理出发，计算层合板刚度矩阵 $[A]$、$[B]$ 和 $[D]$。所提供的数据，包括材料属性和层合板铺层顺序，在物理上是真实的且完整的。不存在科学或逻辑上的缺陷。因此，该问题是有效的，解法推导如下。\n\n将合应力 $\\{N\\}$ 和合弯矩 $\\{M\\}$ 与中面应变 $\\{\\epsilon^0\\}$ 和曲率 $\\{\\kappa\\}$ 联系起来的层合复合材料板的本构关系由下式给出：\n$$\n\\begin{Bmatrix} N \\\\ M \\end{Bmatrix} = \\begin{bmatrix} [A] & [B] \\\\ [B] & [D] \\end{bmatrix} \\begin{Bmatrix} \\epsilon^0 \\\\ \\kappa \\end{Bmatrix}\n$$\n矩阵 $[A]$、$[B]$ 和 $[D]$ 分别是拉伸刚度矩阵、耦合刚度矩阵和弯曲刚度矩阵。我们的目标是为给定的层合板计算这些矩阵。该过程基于系统性的、逐层的分析。\n\n**步骤 1：单个单层板的折算刚度矩阵 $[Q]$**\n\n每个单层板都是处于平面应力状态下的正交各向异性材料。在单层板的主材料方向（$1$-$2$ 坐标系）上，其应力-应变关系为 $\\{\\sigma\\}_{12} = [Q]\\{\\epsilon\\}_{12}$。矩阵 $[Q]$ 是折算刚度矩阵，它是通过对折算柔度矩阵 $[S]$ 求逆得到的。$[S]$ 的分量由工程常数定义：杨氏模量 $E_1$ 和 $E_2$、剪切模量 $G_{12}$ 以及泊松比 $\\nu_{12}$。\n\n根据互易定理，$\\nu_{12} / E_1 = \\nu_{21} / E_2$，由此我们可以得到 $\\nu_{21} = \\nu_{12} (E_2 / E_1)$。那么 $[Q]$ 矩阵的非零元素为：\n$$\nQ_{11} = \\frac{E_1}{1 - \\nu_{12}\\nu_{21}} \\\\\nQ_{22} = \\frac{E_2}{1 - \\nu_{12}\\nu_{21}} \\\\\nQ_{12} = \\frac{\\nu_{12}E_2}{1 - \\nu_{12}\\nu_{21}} = \\frac{\\nu_{21}E_1}{1 - \\nu_{12}\\nu_{21}} \\\\\nQ_{66} = G_{12}\n$$\n且 $Q_{16} = Q_{26} = 0$。所有输入的模量单位 $\\mathrm{GPa}$ 必须转换为 $\\mathrm{Pa}$ ($1\\,\\mathrm{GPa} = 10^9\\,\\mathrm{Pa}$)。\n\n**步骤 2：转换后的折算刚度矩阵 $[\\bar{Q}]$**\n\n层合板内的每个单层板都相对于全局层合板坐标系（$x$-$y$）以一个特定的角度 $\\theta_k$ 取向。单层板的刚度矩阵必须转换到这个全局坐标系中。转换后的矩阵 $[\\bar{Q}]$ 关联了层合板坐标系中的应力和应变：$\\{\\sigma\\}_{xy} = [\\bar{Q}]\\{\\epsilon\\}_{xy}$。\n\n转换是使用铺层角 $\\theta$ 的三角函数来执行的。为了提高数值稳定性和计算效率，我们使用一种基于刚度不变量（$U_1, U_2, U_3, U_4, U_5$）的公式，这种方法将材料属性与铺层取向分离开来。\n\n不变量定义如下：\n$$\nU_1 = \\frac{1}{8}(3Q_{11} + 3Q_{22} + 2Q_{12} + 4Q_{66}) \\\\\nU_2 = \\frac{1}{2}(Q_{11} - Q_{22}) \\\\\nU_3 = \\frac{1}{8}(Q_{11} + Q_{22} - 2Q_{12} - 4Q_{66}) \\\\\nU_4 = \\frac{1}{8}(Q_{11} + Q_{22} + 6Q_{12} - 4Q_{66}) \\\\\nU_5 = \\frac{1}{8}(Q_{11} + Q_{22} - 2Q_{12} + 4Q_{66})\n$$\n对于角度为 $\\theta$（以弧度为单位）的铺层，$[\\bar{Q}]$ 的分量则为：\n$$\n\\bar{Q}_{11} = U_1 + U_2 \\cos(2\\theta) + U_3 \\cos(4\\theta) \\\\\n\\bar{Q}_{22} = U_1 - U_2 \\cos(2\\theta) + U_3 \\cos(4\\theta) \\\\\n\\bar{Q}_{12} = U_4 - U_3 \\cos(4\\theta) \\\\\n\\bar{Q}_{66} = U_5 - U_3 \\cos(4\\theta) \\\\\n\\bar{Q}_{16} = \\frac{1}{2} U_2 \\sin(2\\theta) + U_3 \\sin(4\\theta) \\\\\n\\bar{Q}_{26} = \\frac{1}{2} U_2 \\sin(2\\theta) - U_3 \\sin(4\\theta)\n$$\n\n**步骤 3：层合板刚度矩阵组装**\n\n层合板刚度矩阵 $[A]$、$[B]$ 和 $[D]$ 是通过将每个铺层的转换后刚度沿层合板厚度进行积分得到的。这些积分定义为：\n$$\nA_{ij} = \\int_{-h/2}^{h/2} \\bar{Q}_{ij}(z) \\,dz \\quad , \\quad B_{ij} = \\int_{-h/2}^{h/2} z \\bar{Q}_{ij}(z) \\,dz \\quad , \\quad D_{ij} = \\int_{-h/2}^{h/2} z^2 \\bar{Q}_{ij}(z) \\,dz\n$$\n其中 $z$ 是从层合板中面量起的厚度方向坐标，而 $h$ 是层合板的总厚度。\n\n对于由 $N$ 个离散铺层组成的层合板，这些积分变成了对各铺层的求和。为确保数值稳健性，特别是对于 $[D]$ 矩阵和近对称层合板，我们使用基于平行轴定理的公式。设 $h_k$ 为第 $k$ 个铺层的厚度，$\\bar{z}_k$ 为其铺层中面的坐标。刚度矩阵的分量为：\n$$\nA_{ij} = \\sum_{k=1}^N (\\bar{Q}_{ij})_k h_k \\\\\nB_{ij} = \\sum_{k=1}^N (\\bar{Q}_{ij})_k h_k \\bar{z}_k \\\\\nD_{ij} = \\sum_{k=1}^N (\\bar{Q}_{ij})_k \\left( h_k \\bar{z}_k^2 + \\frac{h_k^3}{12} \\right)\n$$\n坐标系定义如下：铺层从底面到顶面编号为 $k=1, 2, \\dots, N$。总厚度为 $h = \\sum_{k=1}^N h_k$。层合板的底面位于 $z = -h/2$。第 $k$ 个铺层的中面坐标则计算为 $\\bar{z}_k = -h/2 + (\\sum_{j=1}^{k-1} h_j) + h_k/2$。所有以毫米（$\\mathrm{mm}$）为单位的铺层厚度必须转换为米（$\\mathrm{m}$）（$1\\,\\mathrm{mm} = 10^{-3}\\,\\mathrm{m}$）。\n\n对所有的 $i,j \\in \\{1,2,6\\}$ 执行此求和过程，以组装完整的 $3 \\times 3$ 矩阵 $[A]$、$[B]$ 和 $[D]$。最后，提取所需的分量（$A_{11}$、$A_{12}$、$A_{22}$、$B_{16}$、$D_{66}$）。与计算中使用的国际单位制基本单位（$\\mathrm{Pa}$、$\\mathrm{m}$）一致，矩阵的单位将是：$[A]$ 为 $\\mathrm{N/m}$，$[B]$ 为 $\\mathrm{N}$，$[D]$ 为 $\\mathrm{N \\cdot m}$。最终的数值将被四舍五入到 6 位有效数字。", "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Computes the [A], [B], [D] matrix components for composite laminates\n    based on Classical Lamination Theory.\n    \"\"\"\n\n    def format_to_nsf(value, n_sf):\n        \"\"\"\n        Rounds a number to a specified number of significant figures.\n        Returns a float, using format specifiers for robustness.\n        \"\"\"\n        if not np.isfinite(value):\n            return value\n        if value == 0:\n            return 0.0\n        return float(f'{value:.{n_sf}g}')\n\n    # Define the test cases as specified in the problem statement.\n    test_cases = [\n        # Case 1 (general unsymmetric)\n        {\n            \"material\": {\"E1\": 135, \"E2\": 10, \"G12\": 5, \"nu12\": 0.3},\n            \"stackup\": {\"angles_deg\": [0, 90, 45, -45], \"thicknesses_mm\": [0.125, 0.250, 0.125, 0.125]}\n        },\n        # Case 2 (symmetric)\n        {\n            \"material\": {\"E1\": 40, \"E2\": 10, \"G12\": 4, \"nu12\": 0.25},\n            \"stackup\": {\"angles_deg\": [0, 90, 90, 0], \"thicknesses_mm\": [0.2, 0.2, 0.2, 0.2]}\n        },\n        # Case 3 (unsymmetric, disparate thicknesses)\n        {\n            \"material\": {\"E1\": 181, \"E2\": 10.3, \"G12\": 7.17, \"nu12\": 0.28},\n            \"stackup\": {\"angles_deg\": [30, -30], \"thicknesses_mm\": [0.01, 1.0]}\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        mat = case[\"material\"]\n        stack = case[\"stackup\"]\n\n        # Unit conversions to SI base units (Pa, m, rad)\n        E1 = mat[\"E1\"] * 1e9\n        E2 = mat[\"E2\"] * 1e9\n        G12 = mat[\"G12\"] * 1e9\n        nu12 = mat[\"nu12\"]\n        \n        angles_rad = [np.deg2rad(angle) for angle in stack[\"angles_deg\"]]\n        thicknesses_m = [t * 1e-3 for t in stack[\"thicknesses_mm\"]]\n        \n        # Step 1: Lamina reduced stiffness matrix [Q] in material coordinates (1-2)\n        nu21 = nu12 * E2 / E1\n        factor = 1.0 - nu12 * nu21\n        \n        Q11 = E1 / factor\n        Q22 = E2 / factor\n        Q12 = nu12 * E2 / factor\n        Q66 = G12\n        \n        # Step 2: Stiffness invariants for stable transformation\n        U1 = (1/8) * (3*Q11 + 3*Q22 + 2*Q12 + 4*Q66)\n        U2 = (1/2) * (Q11 - Q22)\n        U3 = (1/8) * (Q11 + Q22 - 2*Q12 - 4*Q66)\n        U4 = (1/8) * (Q11 + Q22 + 6*Q12 - 4*Q66)\n        U5 = (1/8) * (Q11 + Q22 - 2*Q12 + 4*Q66)\n        \n        # Initialize laminate global stiffness matrices\n        A = np.zeros((3, 3))\n        B = np.zeros((3, 3))\n        D = np.zeros((3, 3))\n        \n        total_thickness = sum(thicknesses_m)\n        num_plies = len(thicknesses_m)\n        \n        # Step 3: Loop through each ply to assemble [A], [B], [D]\n        # Plies are processed from bottom to top as per convention.\n        z_current = -total_thickness / 2.0\n        for k in range(num_plies):\n            h_k = thicknesses_m[k]\n            theta = angles_rad[k]\n            \n            # Calculate the mid-plane coordinate of the current ply (z_bar_k)\n            # relative to the laminate mid-plane.\n            z_bar_k = z_current + h_k / 2.0\n            z_current += h_k\n\n            # Calculate the transformed stiffness matrix [Q_bar] for the k-th ply\n            cos2t = np.cos(2*theta)\n            sin2t = np.sin(2*theta)\n            cos4t = np.cos(4*theta)\n            sin4t = np.sin(4*theta)\n\n            Qbar11 = U1 + U2 * cos2t + U3 * cos4t\n            Qbar22 = U1 - U2 * cos2t + U3 * cos4t\n            Qbar12 = U4 - U3 * cos4t\n            Qbar66 = U5 - U3 * cos4t\n            Qbar16 = 0.5 * U2 * sin2t + U3 * sin4t\n            Qbar26 = 0.5 * U2 * sin2t - U3 * sin4t\n            \n            Q_bar = np.array([\n                [Qbar11, Qbar12, Qbar16],\n                [Qbar12, Qbar22, Qbar26],\n                [Qbar16, Qbar26, Qbar66]\n            ])\n            \n            # Accumulate contributions using the numerically stable parallel axis theorem formulation\n            A += Q_bar * h_k\n            B += Q_bar * h_k * z_bar_k\n            D += Q_bar * (h_k * z_bar_k**2 + h_k**3 / 12.0)\n\n        # Extract required values, mapping (1,2,6) to (0,1,2) indices.\n        A11 = format_to_nsf(A[0, 0], 6)\n        A12 = format_to_nsf(A[0, 1], 6)\n        A22 = format_to_nsf(A[1, 1], 6)\n        \n        # Handle B16 which can be very close to zero in symmetric cases\n        b16_val = B[0, 2]\n        if np.isclose(b16_val, 0.0, atol=1e-9):\n            b16_val = 0.0\n        B16 = format_to_nsf(b16_val, 6)\n\n        D66 = format_to_nsf(D[2, 2], 6)\n\n        all_results.append([A11, A12, A22, B16, D66])\n\n    # Format the final output string as per the requirements: [[...],[...],[...]]\n    list_of_strings = []\n    for res in all_results:\n        # map each float to string to handle 'e' notation correctly\n        list_of_strings.append(f\"[{','.join(map(str, res))}]\")\n    \n    final_output = f\"[{','.join(list_of_strings)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2870858"}]}