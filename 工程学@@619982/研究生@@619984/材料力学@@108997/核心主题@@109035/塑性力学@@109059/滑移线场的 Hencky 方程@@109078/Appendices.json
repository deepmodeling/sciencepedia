{"hands_on_practices": [{"introduction": "Hencky方程为我们提供了理解塑性流动中应力状态如何随滑移线几何形状变化的强大工具。本节的第一个练习将直接应用这一核心原理。我们将通过一个典型的“扇形”区域来具体实践，这是一个在金属成形等问题中常见的塑性流动特征，我们将计算平均压力 $p$ 如何沿着弯曲的滑移线发生变化[@problem_id:2685849]。这个练习旨在巩固沿单一滑移线应用Hencky关系的基本技能。", "problem": "一种处于平面应变状态的刚性理想塑性金属遵循 von Mises 屈服条件。在滑移线场理论中，定义平均压应力为 $p = (\\sigma_{1} + \\sigma_{2})/2$，其中 $\\sigma_{1}$ 和 $\\sigma_{2}$ 是平面内主应力，并令 $k$ 表示恒定剪切屈服应力（因此，在纯剪切屈服时，剪应力等于 $k$）。考虑一个由从点 $O$ 辐射而出的 $\\alpha$族滑移线组成的中心滑移线扇。该扇形区域由两条直边界（标记为边界 $\\mathcal{A}$ 和边界 $\\mathcal{B}$）界定，并且有一条 $\\alpha$滑移线穿过该扇形区域连接 $\\mathcal{A}$ 和 $\\mathcal{B}$。边界 $\\mathcal{A}$ 上的局部滑移线角 $\\theta$（从 $x$轴到 $\\alpha$族方向测量）为 $\\theta_{1} = 15^\\circ$，边界 $\\mathcal{B}$ 上的为 $\\theta_{2} = 65^\\circ$。边界 $\\mathcal{A}$ 上的平均压应力为 $p_{1} = 210\\,\\mathrm{MPa}$。材料参数为 $k = 95\\,\\mathrm{MPa}$。\n\n从平面内的基本平衡方程、$p$ 和 $\\theta$ 的定义，以及 $k$ 为常数的刚性理想塑性 von Mises 响应出发，使用 Hencky 特征关系式来确定连接边界的 $\\alpha$滑移线上、边界 $\\mathcal{B}$ 处的平均压应力。给定数据中的所有角度都以度为单位；确保任何涉及 $\\theta$ 的微积分运算都将其视为弧度。将最终的平均应力 $p_{2}$ 以 $\\mathrm{MPa}$ 为单位表示，并将答案四舍五入到四位有效数字。", "solution": "该问题要求在给定边界 $\\mathcal{A}$ 上的状态和中心滑移线扇的几何形状的情况下，确定边界 $\\mathcal{B}$ 上的平均压应力。材料是刚性理想塑性的，处于平面应变状态，并遵循 von Mises 屈服条件。解答过程通过应用 Hencky 特征关系式进行，这是滑移线场理论的基础。\n\n首先，我们建立理论框架。对于在平面应变条件下满足 von Mises 屈服准则的刚性理想塑性材料，任何发生塑性变形的点的应力状态可以由两个量来确定：平均应力 $p$ 和滑移线的方向。问题将平均压应力定义为 $p = \\frac{\\sigma_{1} + \\sigma_{2}}{2}$，其中 $\\sigma_{1}$ 和 $\\sigma_{2}$ 是平面内主应力。平面应变下的屈服准则可以用恒定剪切屈服应力 $k$ 表示为 $\\frac{|\\sigma_{1} - \\sigma_{2}|}{2} = k$。因此，假设约定 $\\sigma_{1} > \\sigma_{2}$，主应力可以用 $p$ 和 $k$ 表示为 $\\sigma_{1} = p+k$ 和 $\\sigma_{2} = p-k$。\n\n平衡控制方程与屈服准则相结合，并用 $p$ 和滑移线角 $\\theta$ 表示时，构成一个双曲型偏微分方程组。该方程组的特征线就是滑移线本身，记为 $\\alpha$线和 $\\beta$线。沿着这些特征线，必须满足特定的关系，即 Hencky 关系式。这些关系是：\n沿 $\\alpha$滑移线：\n$$ p + 2k\\theta = \\text{常数} $$\n沿 $\\beta$滑移线：\n$$ p - 2k\\theta = \\text{常数} $$\n在这些关系式中，表示 $\\alpha$滑移线相对于固定参考轴（例如 $x$轴）方向的角度 $\\theta$ 必须以弧度为单位测量。\n\n问题陈述一条 $\\alpha$族滑移线连接了边界 $\\mathcal{A}$ 上的一个点和边界 $\\mathcal{B}$ 上的一个点。我们把边界 $\\mathcal{A}$ 上的点记为点1，边界 $\\mathcal{B}$ 上的点记为点2。已知信息如下：\n在点1处：平均应力 $p_{1} = 210\\,\\mathrm{MPa}$，滑移线角 $\\theta_{1} = 15^\\circ$。\n在点2处：滑移线角为 $\\theta_{2} = 65^\\circ$，我们需要求平均应力 $p_{2}$。\n材料参数为剪切屈服应力 $k = 95\\,\\mathrm{MPa}$。\n\n由于两个点都位于同一条 $\\alpha$滑移线上，因此 Hencky 关系式 $p + 2k\\theta = \\text{常数}$ 必须对两个点都成立。所以，我们可以写出：\n$$ p_{1} + 2k\\theta_{1} = p_{2} + 2k\\theta_{2} $$\n我们的目标是求出 $p_{2}$。重新整理方程以求解 $p_{2}$，得到：\n$$ p_{2} = p_{1} - 2k\\theta_{2} + 2k\\theta_{1} $$\n$$ p_{2} = p_{1} - 2k(\\theta_{2} - \\theta_{1}) $$\n\n在代入数值之前，我们必须按照 Hencky 关系式的要求，将角度从度转换为弧度。\n角度的变化量为 $\\Delta\\theta = \\theta_{2} - \\theta_{1}$。\n$$ \\Delta\\theta = 65^\\circ - 15^\\circ = 50^\\circ $$\n要将其转换为弧度，我们使用转换关系 $\\pi\\,\\mathrm{radians} = 180^\\circ$：\n$$ \\Delta\\theta_{\\text{rad}} = 50^\\circ \\times \\frac{\\pi}{180^\\circ} = \\frac{5\\pi}{18}\\,\\mathrm{radians} $$\n\n现在，我们将给定的 $p_{1}$、$k$ 和角度差 $\\Delta\\theta$ 的值代入 $p_{2}$ 的方程中：\n$$ p_{2} = 210\\,\\mathrm{MPa} - 2 \\times (95\\,\\mathrm{MPa}) \\times \\left(\\frac{5\\pi}{18}\\right) $$\n$$ p_{2} = 210 - 190 \\times \\left(\\frac{5\\pi}{18}\\right) $$\n$$ p_{2} = 210 - \\frac{950\\pi}{18} $$\n化简分数得到：\n$$ p_{2} = 210 - \\frac{475\\pi}{9} $$\n\n为了得到最终的数值答案，我们计算此表达式的值，并按要求四舍五入到四位有效数字。\n$$ p_{2} \\approx 210 - \\frac{475 \\times 3.14159265}{9} $$\n$$ p_{2} \\approx 210 - 165.806278... $$\n$$ p_{2} \\approx 44.193721... \\,\\mathrm{MPa} $$\n四舍五入到四位有效数字，我们得到：\n$$ p_{2} = 44.19\\,\\mathrm{MPa} $$\n这个值代表了在指定的 $\\alpha$滑移线上，边界 $\\mathcal{B}$ 处的平均压应力。", "answer": "$$\n\\boxed{44.19}\n$$", "id": "2685849"}, {"introduction": "掌握了基本计算后，我们进一步探讨理论的应用深度。滑移线理论的预测能力不仅取决于几何关系，还深刻地依赖于我们为材料选择的本构模型，特别是屈服准则。这个练习将引导我们分析，对于同一个经典的Prandtl压缩问题，采用Tresca和von Mises这两种不同的屈服准则会如何影响最终的载荷预测[@problem_id:2685824]。通过推导，我们将揭示这两种理论预测差异的根源，并理解剪切屈服应力 $k$ 与材料单轴屈服应力 $\\sigma_y$ 之间的关键联系。", "problem": "考虑经典的 Prandtl 平面应变压缩问题：一个高度为 $H$ 的非常长的、理想塑性的、不可压缩的带材，被置于两个刚性、完全粗糙的压板之间进行压缩。该带材是均匀且各向同性的，遵循关联流动法则，并且在特雷斯卡 (Tresca) 和冯·米塞斯 (von Mises, J$_{2}$) 两种屈服假设下，具有相同的单轴拉伸屈服应力 $\\sigma_{y}$。令 $\\bar{p}$ 表示传递到压板上的平均压缩压力（等效于单位平面外厚度的总载荷除以压板接触长度）。\n\n使用二维刚性-理想塑性流动的滑移线场理论：\n- 从二维平衡方程、塑性不可压缩性条件以及相应的屈服条件（特雷斯卡或冯·米塞斯）出发，建立以平均压缩应力 $p$ 和滑移线角度 $\\varphi$ 表示的特征（滑移线）方程。\n- 通过无量纲化论证，确定归一化压力 $p/(2k)$ 的场解是否依赖于 $k$ 的大小，其中 $k$ 是所选屈服准则下纯剪切状态的剪切屈服应力。\n- 仔细解释在特雷斯卡和冯·米塞斯假设下，从单轴屈服应力 $\\sigma_{y}$ 到剪切屈服应力 $k$ 的映射关系有何不同。\n\n然后，在不引用任何来自预先制表的滑移线解的特定问题数值常数的情况下，推导平均压板压力的精确比值，\n$$\n\\frac{\\bar{p}_{\\text{Mises}}}{\\bar{p}_{\\text{Tresca}}},\n$$\n在 $\\sigma_{y}$ 相同的情况下，并简要讨论两种预测之间任何差异的物理根源。将您的最终答案表示为一个精确的数值（无单位），无需四舍五入。", "solution": "所述问题是塑性力学中的一个经典问题。它具有科学依据，提法恰当，客观，并包含足够的信息以获得唯一解。我们认为该问题有效，并着手求解。\n\n求解过程需要基于滑移线场理论的基本原理进行循序推导。\n\n首先，我们建立特征方程。在平面应变条件下，处于屈服状态的刚性-理想塑性材料的应力状态由平均压缩应力 $p = -(\\sigma_{x} + \\sigma_{y})/2$ 和恒定的剪切屈服应力 $k$ 描述。应力分量可以用 $p$ 和第一主滑移线（$\\alpha$-线）与 $x$-轴的夹角 $\\varphi$ 表示：\n$$ \\sigma_{x} = -p - k \\sin(2\\varphi) $$\n$$ \\sigma_{y} = -p + k \\sin(2\\varphi) $$\n$$ \\tau_{xy} =  k \\cos(2\\varphi) $$\n这些分量必须满足无体力情况下的二维平衡方程 $\\frac{\\partial \\sigma_{ij}}{\\partial x_j} = 0$。\n将应力表达式代入平衡方程，并假设 $k$ 为常数（均匀材料），我们得到关于 $p(x,y)$ 和 $\\varphi(x,y)$ 的一阶偏微分方程组：\n$$\n\\frac{\\partial p}{\\partial x} + 2k\\left(\\cos(2\\varphi)\\frac{\\partial \\varphi}{\\partial x} + \\sin(2\\varphi)\\frac{\\partial \\varphi}{\\partial y}\\right) = 0\n$$\n$$\n\\frac{\\partial p}{\\partial y} + 2k\\left(\\sin(2\\varphi)\\frac{\\partial \\varphi}{\\partial x} - \\cos(2\\varphi)\\frac{\\partial \\varphi}{\\partial y}\\right) = 0\n$$\n这个双曲系统具有实特征线，即滑移线。为了找到它们，我们寻找方向 $m = dy/dx$ ，沿着这些方向，偏微分方程可以简化为常微分方程（相容性关系）。该条件导出一个关于特征斜率 $m$ 的二次方程：\n$$ m^{2}\\sin(2\\varphi) + 2m\\cos(2\\varphi) - \\sin(2\\varphi) = 0 $$\n该方程的根为：\n$m_1 = \\tan(\\varphi)$，对应于 $\\alpha$-线。\n$m_2 = -\\cot(\\varphi) = \\tan(\\varphi + \\pi/2)$，对应于 $\\beta$-线。\n沿着这些特征线，可以找到相容性关系，即 Hencky 方程。沿着一条 $\\alpha$-线（$dy/dx = \\tan(\\varphi)$），我们发现 $dp = -2k d\\varphi$，积分后得到：\n$$ p + 2k\\varphi = C_1 \\quad (\\text{沿 } \\alpha \\text{-线}) $$\n沿着一条 $\\beta$-线（$dy/dx = -\\cot(\\varphi)$），我们发现 $dp = 2k d\\varphi$，积分后得到：\n$$ p - 2k\\varphi = C_2 \\quad (\\text{沿 } \\beta \\text{-线}) $$\n这些就是所求的特征方程。\n\n其次，我们使用无量纲化论证。我们定义归一化压力 $P = p/(2k)$。亨基方程变为：\n$$ P + \\varphi = C_1 / (2k) = C_1^* \\quad (\\text{沿 } \\alpha \\text{-线}) $$\n$$ P - \\varphi = C_2 / (2k) = C_2^* \\quad (\\text{沿 } \\beta \\text{-线}) $$\n滑移线场的几何形状由角度 $\\varphi$ 和边界条件决定。对于完全粗糙压板间的 Prandtl 压缩问题，滑移线必须以 $\\pm \\pi/4$ 的角度与压板相交。自由表面上的任何应力边界条件，例如 $p=k$ ，在归一化形式下变为 $P=1/2$。关于无量纲场 $P(x/H, y/H)$ 和 $\\varphi(x/H, y/H)$ 的整个边值问题与 $H$ 和 $k$ 的具体值无关。因此，归一化压力 $p/(2k)$ 的解场是归一化坐标的一个普适函数，且不依赖于 $k$ 的大小。\n\n第三，我们解释从单轴屈服应力 $\\sigma_y$ 到剪切屈服应力 $k$ 的映射关系。这个映射关系取决于所选择的屈服准则。\n对于特雷斯卡准则，当最大剪切应力等于 $k_T$ 时，材料发生屈服。在单轴拉伸试验中，主应力为 $(\\sigma_y, 0, 0)$，因此最大剪切应力为 $\\tau_{\\max} = (\\sigma_y - 0)/2 = \\sigma_y/2$。因此，对于特雷斯卡准则：\n$$ k_T = \\frac{\\sigma_y}{2} $$\n对于冯·米塞斯准则，当偏应力张量的第二不变量 $J_2$ 达到一个临界值时，材料发生屈服。从单轴试验可知，该临界值为 $J_2 = \\sigma_y^2/3$。在平面应变条件下，适用于冯·米塞斯材料的滑移线场理论需要一个等效剪切屈服应力 $k_{VM}$。对于平面应变（$\\epsilon_z=0$）和关联流动法则，可以得到 $\\sigma_z = (\\sigma_x+\\sigma_y)/2$，其中 $\\sigma_z$ 是平面外应力。于是，冯·米塞斯准则 $J_2 = \\sigma_y^2/3$ 简化为 $\\frac{1}{4}(\\sigma_1-\\sigma_2)^2 = \\sigma_y^2/3$ ，其中 $\\sigma_1, \\sigma_2$ 是平面内主应力。由于最大平面内剪切应力定义为 $k = (\\sigma_1-\\sigma_2)/2$，我们有 $(2k_{VM})^2/4 = \\sigma_y^2/3$，可得：\n$$ k_{VM} = \\frac{\\sigma_y}{\\sqrt{3}} $$\n\n最后，我们推导平均压板压力的比值 $\\bar{p}_{\\text{Mises}}/\\bar{p}_{\\text{Tresca}}$。\n平均压力 $\\bar{p}$ 是单位厚度的总载荷除以接触长度。根据我们的无量纲化论证，归一化的平均压力 $\\bar{p}/(2k)$ 必须是一个常数，我们称之为 $C$。该常数仅取决于问题的几何形状（例如，压缩区域的纵横比）和边界条件（完全粗糙的压板）。问题陈述指明了两种情况下具有相同的几何形状和边界条件。\n$$ \\frac{\\bar{p}}{2k} = C \\implies \\bar{p} = 2kC $$\n对于特雷斯卡和冯·米塞斯分析，常数 $C$ 是相同的。因此，平均压力分别为：\n$$ \\bar{p}_{\\text{Tresca}} = 2k_T C $$\n$$ \\bar{p}_{\\text{Mises}} = 2k_{VM} C $$\n该比值就是各自剪切屈服应力的比值：\n$$ \\frac{\\bar{p}_{\\text{Mises}}}{\\bar{p}_{\\text{Tresca}}} = \\frac{2k_{VM}C}{2k_T C} = \\frac{k_{VM}}{k_T} $$\n代入在 $\\sigma_y$ 相同的情况下 $k_T$ 和 $k_{VM}$ 的表达式：\n$$ \\frac{\\bar{p}_{\\text{Mises}}}{\\bar{p}_{\\text{Tresca}}} = \\frac{\\sigma_y/\\sqrt{3}}{\\sigma_y/2} = \\frac{2}{\\sqrt{3}} $$\n\n这种差异的物理根源在于冯·米塞斯和特雷斯卡屈服准则并不完全相同。在主应力空间中，冯·米塞斯屈服面（圆柱体）外切于特雷斯卡屈服面（六角棱柱）。它们仅在某些特定的应力状态下重合，例如单轴或等双轴应力状态。对于一般的多轴应力状态，例如平面应变压缩中出现的状态，冯·米塞斯准则预测了更高的弹性极限。在冯·米塞斯假设下，材料实际上更强，这体现在 $k_{VM} \\approx 0.577\\sigma_y$ 大于 $k_T = 0.5\\sigma_y$。因此，需要更高的压力来引发并维持整个带材的塑性流动。", "answer": "$$\n\\boxed{\\frac{2}{\\sqrt{3}}}\n$$", "id": "2685824"}, {"introduction": "在工程实践中，许多滑移线场的几何形状非常复杂，无法像前两个练习那样得到简单的解析解。因此，数值方法成为求解这些问题的关键。本练习将带领我们从Hencky和Geiringer方程的微分形式出发，构建一个数值积分算法[@problem_id:2646134]。通过这种方法，我们可以逐点追踪滑移线的路径及其上的应力状态，这是掌握计算塑性力学和解决更复杂问题的基石。", "problem": "要求您设计并实现一种数值步进算法，该算法与固体力学中的平面理想塑性流动理论一致，用于根据给定的初始数据沿$\\alpha$-滑移线积分平均压力场。该算法必须遵循经典的 Hencky 和 Geiringer 滑移线关系，适用于具有恒定剪切屈服应力的理想塑性、不可压缩、平面应变材料。\n\n从以下基本依据出发：\n\n- 本构和屈服假设：理想塑性，具有恒定剪切屈服应力 $k$；平面应变，不可压缩流动；滑移线场理论适用。\n- 特征方向：在每一点，存在两个正交的滑移线族，$\\alpha$ 和 $\\beta$，它们与主应力方向成 $\\pm \\pi/4$ 角（等效地，相对于固定的 $x$-轴成 $\\theta \\pm \\pi/4$ 角，其中 $\\theta$ 是主应力方向的旋转角）。\n- Hencky 方程（特征应力关系）：沿 $\\alpha$-线，平均压力 $p$ 和应力方向 $\\theta$ 满足 $dp = -2 k\\, d\\theta$。\n- 沿曲线运动的几何关系：如果 $s$ 表示沿 $\\alpha$-线的弧长，则局部切线与 $x$-轴的夹角为 $\\theta + \\pi/4$，因此有 $dx/ds = \\cos(\\theta + \\pi/4)$ 和 $dy/ds = \\sin(\\theta + \\pi/4)$，其中 $x$ 和 $y$ 是笛卡尔坐标。\n- 曲率定义：$\\alpha$-线的曲率 $\\kappa_{\\alpha}$ 满足 $d\\theta/ds = \\kappa_{\\alpha}$，因为 $\\alpha$-线的切线角是 $\\theta + \\pi/4$，而切线角对弧长的导数等于曲率。在此问题中，沿 $\\alpha$-线，$\\kappa_{\\alpha}$ 被作为 $\\theta$ 的一个给定函数给出，记为 $\\kappa(\\theta)$。\n\n从以上关系中，推导出一个以应力方向 $\\theta$ 为自变量的常微分方程组。利用 $d\\theta/ds = \\kappa(\\theta)$ 得到 $ds/d\\theta = 1/\\kappa(\\theta)$，并与几何关系结合，得到\n$$\n\\frac{dx}{d\\theta} = \\frac{\\cos(\\theta + \\pi/4)}{\\kappa(\\theta)}, \\qquad\n\\frac{dy}{d\\theta} = \\frac{\\sin(\\theta + \\pi/4)}{\\kappa(\\theta)}, \\qquad\n\\frac{dp}{d\\theta} = -2 k.\n$$\n角度必须以弧度处理。位置必须以米为单位，压力以帕斯卡为单位。\n\n您的任务是实现一个四阶 Runge–Kutta 步进算法，在给定恒定屈服参数 $k$ 和指定曲率函数 $\\kappa(\\theta)$ 的情况下，沿 $\\alpha$-线从初始状态 $\\{x_0,y_0,p_0,\\theta_0\\}$ 积分到终点方向 $\\theta_f$。您必须确保 $\\kappa(\\theta)$ 在积分区间 $\\left[\\theta_0,\\theta_f\\right]$ 上不为零，以避免奇异点。该算法应能鲁棒地处理正曲率和负曲率，以及 $\\theta$ 的增加或减少。\n\n测试套件规范：\n实现您的程序以解决以下三种情况。角度使用弧度，$x$ 和 $y$ 使用米，$p$ 和 $k$ 使用帕斯卡。\n\n- 情况 1（恒定正曲率，解析基准）：\n  - $k = 1.0 \\times 10^{6}$,\n  - $\\kappa(\\theta) = 0.5$,\n  - $\\theta_0 = 0.0$, $\\theta_f = 0.5$,\n  - $x_0 = 0.0$, $y_0 = 0.0$, $p_0 = 5.0 \\times 10^{6}$。\n- 情况 2（非均匀正曲率）：\n  - $k = 2.5 \\times 10^{6}$,\n  - $\\kappa(\\theta) = 0.2 + 0.1 \\cos(\\theta)$,\n  - $\\theta_0 = 0.2$, $\\theta_f = 1.0$,\n  - $x_0 = 1.0$, $y_0 = -0.5$, $p_0 = 1.0 \\times 10^{6}$。\n- 情况 3（恒定负曲率，$\\theta$ 递减）：\n  - $k = 1.5 \\times 10^{6}$,\n  - $\\kappa(\\theta) = -0.3$,\n  - $\\theta_0 = 1.2$, $\\theta_f = 0.7$,\n  - $x_0 = -2.0$, $y_0 = 2.0$, $p_0 = 0.0$。\n\n数值和输出要求：\n\n- 实现一个以 $\\theta$ 为自变量的四阶 Runge–Kutta 积分器，用于求解 $x(\\theta)$、$y(\\theta)$ 和 $p(\\theta)$ 的耦合系统。\n- 所有三角函数求值均使用弧度。\n- 确保在每种情况下选择的步长足以充分解析区间 $\\left[\\theta_0,\\theta_f\\right]$；您可以选择对 $\\theta$ 进行均匀划分。\n- 对于每种情况，返回最终状态 $\\{x(\\theta_f), y(\\theta_f), p(\\theta_f)\\}$。\n- 将报告的每个 $x$、$y$ 和 $p$ 值四舍五入到六位小数。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个 Python 风格的列表的列表，内含与上述三种情况相对应的三个三元组，顺序与上文一致，不含多余的空格或文本。例如：\n\"[[x1,y1,p1],[x2,y2,p2],[x3,y3,p3]]\" 但为保持一致性不含空格，即：\"[[x1,y1,p1],[x2,y2,p2],[x3,y3,p3]]\"。\n\n注意：您不得假设超出所述基本原理之外的任何“捷径”公式；推导和实现必须基于给定的关系。通过检查测试套件中提供的积分区间上 $\\kappa(\\theta)$ 不为零，确保科学真实性。", "solution": "问题陈述经核实是科学上合理、适定且完整的。它提出了一个源于固体力学中滑移线场理论基本原理的标准初值问题。\n\n该物理系统是在平面应变条件下的理想塑性、不可压缩材料。沿 $\\alpha$-滑移线，材料的状态由笛卡尔坐标 $(x, y)$、平均压力 $p$ 和主应力方向 $\\theta$ 描述。这些变量的演化受 Hencky 和 Geiringer 关系支配。通过选择 $\\theta$ 作为自变量，我们得到以下一阶常微分方程组：\n$$\n\\frac{dx}{d\\theta} = \\frac{\\cos(\\theta + \\pi/4)}{\\kappa(\\theta)}\n$$\n$$\n\\frac{dy}{d\\theta} = \\frac{\\sin(\\theta + \\pi/4)}{\\kappa(\\theta)}\n$$\n$$\n\\frac{dp}{d\\theta} = -2k\n$$\n其中 $k$ 是恒定剪切屈服应力，$\\kappa(\\theta)$ 是作为 $\\theta$ 函数给出的 $\\alpha$-滑移线曲率。\n\n我们可以将此系统写成向量形式。设状态向量为 $\\mathbf{y}(\\theta) = [x(\\theta), y(\\theta), p(\\theta)]^T$。该系统则表示为：\n$$\n\\frac{d\\mathbf{y}}{d\\theta} = \\mathbf{F}(\\theta)\n$$\n其中向量函数 $\\mathbf{F}(\\theta)$ 由下式给出：\n$$\n\\mathbf{F}(\\theta) = \\begin{pmatrix} \\frac{\\cos(\\theta + \\pi/4)}{\\kappa(\\theta)} \\\\ \\frac{\\sin(\\theta + \\pi/4)}{\\kappa(\\theta)} \\\\ -2k \\end{pmatrix}\n$$\n这是一个初值问题，我们在 $\\theta = \\theta_0$ 处给定初始状态 $\\mathbf{y}_0 = [x_0, y_0, p_0]^T$，并求解在 $\\theta = \\theta_f$ 处的最终状态 $\\mathbf{y}_f$。\n\n为了数值求解此系统，我们实现四阶 Runge-Kutta (RK4) 方法。积分区间 $[\\theta_0, \\theta_f]$ 被离散化为 $N$ 个步长为 $h = (\\theta_f - \\theta_0) / N$ 的步。对于每一步，从在 $\\theta_n$ 处的状态 $\\mathbf{y}_n$ 开始，在 $\\theta_{n+1} = \\theta_n + h$ 处的状态 $\\mathbf{y}_{n+1}$ 计算如下：\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{1}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n$$\n对于一个一般的常微分方程系统 $\\frac{d\\mathbf{y}}{d\\theta} = \\mathbf{F}(\\theta, \\mathbf{y})$，其中间向量 $\\mathbf{k}_i$ 定义如下：\n$$\n\\mathbf{k}_1 = h \\cdot \\mathbf{F}(\\theta_n, \\mathbf{y}_n) \\\\\n\\mathbf{k}_2 = h \\cdot \\mathbf{F}(\\theta_n + h/2, \\mathbf{y}_n + \\mathbf{k}_1/2) \\\\\n\\mathbf{k}_3 = h \\cdot \\mathbf{F}(\\theta_n + h/2, \\mathbf{y}_n + \\mathbf{k}_2/2) \\\\\n\\mathbf{k}_4 = h \\cdot \\mathbf{F}(\\theta_n + h, \\mathbf{y}_n + \\mathbf{k}_3)\n$$\n对于这个特定问题，一个关键的观察是函数 $\\mathbf{F}$ 仅依赖于 $\\theta$ 而不依赖于状态向量 $\\mathbf{y}$。这使得中间向量的表达式简化为：\n$$\n\\mathbf{k}_1 = h \\cdot \\mathbf{F}(\\theta_n) \\\\\n\\mathbf{k}_2 = h \\cdot \\mathbf{F}(\\theta_n + h/2) \\\\\n\\mathbf{k}_3 = h \\cdot \\mathbf{F}(\\theta_n + h/2) \\\\\n\\mathbf{k}_4 = h \\cdot \\mathbf{F}(\\theta_n + h)\n$$\n将这些代入更新公式，我们得到：\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{h}{6} \\left( \\mathbf{F}(\\theta_n) + 4\\mathbf{F}(\\theta_n + h/2) + \\mathbf{F}(\\theta_n + h) \\right)\n$$\n这等同于对向量函数 $\\mathbf{F}(\\theta)$ 的每个分量在区间 $[\\theta_n, \\theta_{n+1}]$ 上应用 Simpson 1/3 法则进行数值积分。\n\n该实现将包含一个通用函数，该函数针对给定的函数 $\\mathbf{F}(\\theta)$、初始条件、积分范围和步数 $N$ 执行此 RK4 积分。为确保高精度并满足四舍五入到 6 位小数的要求，将使用大量的步数，例如 $N=10000$。这个 $N$ 的选择使得步长 $h$ 很小，并且由于 RK4 方法的全局误差是 $O(h^4)$ 阶的，数值解将非常接近精确解。\n\n该算法被应用于提供的三个测试用例中的每一个。对于每个用例，使用特定的参数 $k$、$x_0$、$y_0$、$p_0$、$\\theta_0$、$\\theta_f$ 和函数 $\\kappa(\\theta)$ 来定义相应的 $\\mathbf{F}(\\theta)$。该算法能够适应增加（$\\theta_f > \\theta_0$）和减少（$\\theta_f < \\theta_0$）的积分路径，因为步长 $h$ 会相应地为正或为负。有效性检查确认了对于所有测试用例，$\\kappa(\\theta)$ 在积分区间上都非零，从而确保了右端函数 $\\mathbf{F}(\\theta)$ 是良定义的。每个用例的最终计算值 $x(\\theta_f)$、$y(\\theta_f)$ 和 $p(\\theta_f)$ 都被四舍五入到 6 位小数并按指定格式化。", "answer": "```python\nimport numpy as np\n\ndef rk4_integrator(F_theta, y0, theta0, theta_f, N):\n    \"\"\"\n    Integrates the ODE system dy/d(theta) = F(theta) using a fourth-order Runge-Kutta method.\n    The method simplifies to Simpson's rule because F is independent of y.\n\n    Args:\n        F_theta (callable): The vector function F(theta) = [dx/dtheta, dy/dtheta, dp/dtheta].\n        y0 (list or np.ndarray): Initial state vector [x0, y0, p0].\n        theta0 (float): Initial value of the independent variable theta.\n        theta_f (float): Final value of the independent variable theta.\n        N (int): Number of integration steps.\n\n    Returns:\n        np.ndarray: The final state vector y(theta_f).\n    \"\"\"\n    h = (theta_f - theta0) / N\n    theta = theta0\n    y = np.array(y0, dtype=float)\n\n    for _ in range(N):\n        F1 = F_theta(theta)\n        F2 = F_theta(theta + h / 2.0)\n        # F3 = F_theta(theta + h / 2.0) is the same as F2\n        F4 = F_theta(theta + h)\n        \n        # The update formula simplifies from (F1 + 2*F2 + 2*F3 + F4) to (F1 + 4*F2 + F4)\n        y += (h / 6.0) * (F1 + 4.0 * F2 + F4)\n        theta += h\n        \n    return y\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the three specified test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"k\": 1.0e6,\n            \"kappa_func\": lambda theta: 0.5,\n            \"theta0\": 0.0,\n            \"theta_f\": 0.5,\n            \"initial_state\": [0.0, 0.0, 5.0e6]\n        },\n        {\n            \"k\": 2.5e6,\n            \"kappa_func\": lambda theta: 0.2 + 0.1 * np.cos(theta),\n            \"theta0\": 0.2,\n            \"theta_f\": 1.0,\n            \"initial_state\": [1.0, -0.5, 1.0e6]\n        },\n        {\n            \"k\": 1.5e6,\n            \"kappa_func\": lambda theta: -0.3,\n            \"theta0\": 1.2,\n            \"theta_f\": 0.7,\n            \"initial_state\": [-2.0, 2.0, 0.0]\n        }\n    ]\n\n    all_results = []\n    \n    # Use a large number of steps for high accuracy\n    num_steps = 10000\n\n    for case in test_cases:\n        k = case[\"k\"]\n        kappa_func = case[\"kappa_func\"]\n\n        # Define the derivative function F(theta) for the current case\n        def F_theta(theta):\n            kappa_val = kappa_func(theta)\n            # The problem guarantees kappa_val is non-zero on the interval\n            cos_term = np.cos(theta + np.pi / 4.0)\n            sin_term = np.sin(theta + np.pi / 4.0)\n            return np.array([\n                cos_term / kappa_val,\n                sin_term / kappa_val,\n                -2.0 * k  # Corrected sign based on consistent Hencky relations\n            ])\n\n        # Integrate the system of ODEs\n        y_final = rk4_integrator(\n            F_theta,\n            case[\"initial_state\"],\n            case[\"theta0\"],\n            case[\"theta_f\"],\n            num_steps\n        )\n\n        # Round the final results to six decimal places as required\n        x_f_rounded = round(y_final[0], 6)\n        y_f_rounded = round(y_final[1], 6)\n        p_f_rounded = round(y_final[2], 6)\n        \n        all_results.append([x_f_rounded, y_f_rounded, p_f_rounded])\n        \n    # Format the final output string to match the required format: \"[[x1,y1,p1],[x2,y2,p2],[x3,y3,p3]]\"\n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```", "id": "2646134"}]}