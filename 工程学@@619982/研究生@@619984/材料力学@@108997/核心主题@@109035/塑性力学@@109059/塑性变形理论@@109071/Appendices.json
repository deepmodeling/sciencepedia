{"hands_on_practices": [{"introduction": "本练习旨在巩固变形理论的核心思想：应力状态完全由当前的应变状态确定。我们将以一个简单的单轴拉伸为例，使用基于 Hencky 应变的二次应变能函数，从最基本的原理出发，计算材料的储存能、Kirchhoff 应力响应，以及沿加载路径的切线模量。这个实践将帮助你清晰地理解变形、应变、能量和应力之间的直接联系，并为更复杂的非线性分析奠定基础。", "problem": "在欧拉描述下，一个各向同性的可压缩材料由二次 Hencky (对数) 能量建模。令 Kirchhoff 应力 $\\,\\tau\\,$ 与欧拉 Hencky 应变 $\\,E\\,$ 功共轭，使得单位当前体积的内功微分为 $\\,\\mathrm{tr}(\\tau\\,\\mathrm{d}E)\\,$。物体经历保体积单轴拉伸，其变形梯度为\n$$F=\\mathrm{diag}(\\lambda,\\ \\lambda^{-1/2},\\ \\lambda^{-1/2}),\\qquad \\lambda>0,$$\n使得 $\\det F=1$。欧拉 Hencky 应变定义为 $\\,E=\\ln V\\,$，其中 $\\,V\\,$ 是来自极分解 $\\,F=VR\\,$ 的左拉伸张量，$\\,R\\,$ 为旋转张量。材料的单位当前体积储存能量密度为\n$$\\psi_H(E)=\\mu\\,\\| \\mathrm{dev}\\,E\\|^2+\\frac{\\kappa}{2}\\big(\\mathrm{tr}\\,E\\big)^2,$$\n式中剪切模量 $\\,\\mu>0\\,$，体积模量 $\\,\\kappa>0\\,$，并且 $\\,\\mathrm{dev}\\,E=E-\\tfrac{1}{3}(\\mathrm{tr}\\,E)\\,I\\,$ 以及 $\\,\\|A\\|^2=\\mathrm{tr}(A^T A)\\,$。\n\n从这些定义和原理出发，不假设任何额外的本构捷径，完成以下任务：\n\n1) 计算由 $\\,F\\,$ 引起的 Hencky 应变 $\\,E(\\lambda)\\,$，并用它来获得储存能量密度 $\\,\\psi_H(\\lambda)\\,$。\n\n2) 利用能量共轭关系确定 Kirchhoff 应力响应 $\\,\\tau(\\lambda)\\,$。\n\n3) 沿此单轴加载路径，令 $\\,E_{11}=\\ln\\lambda\\,$ 表示轴向对数应变，$\\,\\tau_{11}\\,$ 表示轴向 Kirchhoff 应力分量。计算轴向切线模量 $\\,\\mathrm{d}\\tau_{11}/\\mathrm{d}E_{11}\\,$。\n\n请以 $\\,\\lambda\\,$, $\\,\\mu\\,$ 和 $\\,\\kappa\\,$ 的闭合形式给出最终表达式。不需要数值近似，最终答案中也无需报告单位。", "solution": "问题陈述已经过审查，被认定为具有科学依据、内容自洽且提法适定。它提出了一个基于 Hencky 模型的有限应变弹性力学标准问题。所有定义、变量和条件均已提供，不存在矛盾或歧义。该问题有效可解。\n\n解答过程按要求分为三个部分。\n\n第 1 部分：计算 Hencky 应变 $E(\\lambda)$ 和储存能量密度 $\\psi_H(\\lambda)$。\n\n变形梯度以对角矩阵形式给出：\n$$F = \\mathrm{diag}(\\lambda, \\lambda^{-1/2}, \\lambda^{-1/2})$$\n由于 $F$ 是一个对称正定矩阵（因为 $\\lambda > 0$），其左极分解 $F = VR$ 是平凡的。旋转部分 $R$ 是单位矩阵，$R=I$，左拉伸张量 $V$ 等于变形梯度本身，$V=F$。\n$$V = \\mathrm{diag}(\\lambda, \\lambda^{-1/2}, \\lambda^{-1/2})$$\n欧拉 Hencky 应变 $E$ 定义为左拉伸张量 $V$ 的自然对数：\n$$E = \\ln V$$\n对于对角矩阵，其对数是逐元素计算的：\n$$E(\\lambda) = \\ln(\\mathrm{diag}(\\lambda, \\lambda^{-1/2}, \\lambda^{-1/2})) = \\mathrm{diag}(\\ln(\\lambda), \\ln(\\lambda^{-1/2}), \\ln(\\lambda^{-1/2}))$$\n$$E(\\lambda) = \\mathrm{diag}(\\ln\\lambda, -\\tfrac{1}{2}\\ln\\lambda, -\\tfrac{1}{2}\\ln\\lambda)$$\n接下来，我们计算储存能量密度 $\\psi_H$ 所需的量。Hencky 应变的迹为：\n$$\\mathrm{tr}\\,E = \\ln\\lambda + (-\\tfrac{1}{2}\\ln\\lambda) + (-\\tfrac{1}{2}\\ln\\lambda) = 0$$\n这一结果与变形是保体积的这一事实相符，即 $\\det F = \\lambda \\cdot \\lambda^{-1/2} \\cdot \\lambda^{-1/2} = 1$，这意味着 $\\mathrm{tr}\\,E = \\ln(\\det V) = \\ln(\\det F) = \\ln(1) = 0$。\n\nHencky 应变的偏量部分定义为 $\\mathrm{dev}\\,E = E - \\tfrac{1}{3}(\\mathrm{tr}\\,E)I$。由于 $\\mathrm{tr}\\,E = 0$，偏应变就是应变本身：\n$$\\mathrm{dev}\\,E = E$$\n偏应变的 Frobenius 范数平方为 $\\|\\mathrm{dev}\\,E\\|^2 = \\mathrm{tr}((\\mathrm{dev}\\,E)^T(\\mathrm{dev}\\,E)) = \\mathrm{tr}(E^T E)$。由于 $E$ 是对称的，这等于 $\\mathrm{tr}(E^2)$。\n$$E^2 = \\mathrm{diag}((\\ln\\lambda)^2, (-\\tfrac{1}{2}\\ln\\lambda)^2, (-\\tfrac{1}{2}\\ln\\lambda)^2) = \\mathrm{diag}((\\ln\\lambda)^2, \\tfrac{1}{4}(\\ln\\lambda)^2, \\tfrac{1}{4}(\\ln\\lambda)^2)$$\n$$\\|\\mathrm{dev}\\,E\\|^2 = \\mathrm{tr}(E^2) = (\\ln\\lambda)^2 + \\tfrac{1}{4}(\\ln\\lambda)^2 + \\tfrac{1}{4}(\\ln\\lambda)^2 = (1 + \\tfrac{1}{2})(\\ln\\lambda)^2 = \\tfrac{3}{2}(\\ln\\lambda)^2$$\n单位当前体积的储存能量密度由 $\\psi_H(E) = \\mu\\,\\| \\mathrm{dev}\\,E\\|^2 + \\frac{\\kappa}{2}(\\mathrm{tr}\\,E)^2$ 给出。代入推导出的量：\n$$\\psi_H(\\lambda) = \\mu \\left(\\tfrac{3}{2}(\\ln\\lambda)^2\\right) + \\tfrac{\\kappa}{2}(0)^2 = \\tfrac{3}{2}\\mu(\\ln\\lambda)^2$$\n这是第一个要求的结果。\n\n第 2 部分：确定 Kirchhoff 应力响应 $\\tau(\\lambda)$。\n\nKirchhoff 应力 $\\tau$ 与 Hencky 应变 $E$ 功共轭，这意味着本构关系为 $\\tau = \\frac{\\partial \\psi_H}{\\partial E}$。我们必须对储存能量函数求关于张量 $E$ 的导数。\n$$\\psi_H(E) = \\mu\\,\\mathrm{tr}((E - \\tfrac{1}{3}(\\mathrm{tr}\\,E)I)^T(E - \\tfrac{1}{3}(\\mathrm{tr}\\,E)I)) + \\tfrac{\\kappa}{2}(\\mathrm{tr}\\,E)^2$$\n$$\\psi_H(E) = \\mu\\,\\mathrm{tr}(E^2 - \\tfrac{2}{3}(\\mathrm{tr}\\,E)E + \\tfrac{1}{9}(\\mathrm{tr}\\,E)^2 I) + \\tfrac{\\kappa}{2}(\\mathrm{tr}\\,E)^2$$\n$$\\psi_H(E) = \\mu(\\mathrm{tr}(E^2) - \\tfrac{2}{3}(\\mathrm{tr}\\,E)^2 + \\tfrac{1}{3}(\\mathrm{tr}\\,E)^2) + \\tfrac{\\kappa}{2}(\\mathrm{tr}\\,E)^2$$\n$$\\psi_H(E) = \\mu(\\mathrm{tr}(E^2) - \\tfrac{1}{3}(\\mathrm{tr}\\,E)^2) + \\tfrac{\\kappa}{2}(\\mathrm{tr}\\,E)^2$$\n使用标准张量微积分恒等式 $\\frac{\\partial(\\mathrm{tr}(E^2))}{\\partial E} = 2E$ 和 $\\frac{\\partial((\\mathrm{tr}\\,E)^2)}{\\partial E} = 2(\\mathrm{tr}\\,E)I$，我们得到：\n$$\\tau = \\frac{\\partial \\psi_H}{\\partial E} = \\mu(2E - \\tfrac{2}{3}(\\mathrm{tr}\\,E)I) + \\tfrac{\\kappa}{2}(2(\\mathrm{tr}\\,E)I)$$\n$$\\tau = 2\\mu(E - \\tfrac{1}{3}(\\mathrm{tr}\\,E)I) + \\kappa(\\mathrm{tr}\\,E)I$$\n识别出偏应变张量，一般本构律为：\n$$\\tau = 2\\mu\\,\\mathrm{dev}\\,E + \\kappa(\\mathrm{tr}\\,E)I$$\n对于此特定的单轴变形路径，我们已经确定 $\\mathrm{tr}\\,E = 0$ 且 $\\mathrm{dev}\\,E = E$。因此，本构方程简化为：\n$$\\tau = 2\\mu E$$\n代入 $E(\\lambda)$ 的表达式：\n$$\\tau(\\lambda) = 2\\mu\\,\\mathrm{diag}(\\ln\\lambda, -\\tfrac{1}{2}\\ln\\lambda, -\\tfrac{1}{2}\\ln\\lambda)$$\n$$\\tau(\\lambda) = \\mathrm{diag}(2\\mu\\ln\\lambda, -\\mu\\ln\\lambda, -\\mu\\ln\\lambda)$$\n这是第二个要求的结果。\n\n第 3 部分：计算轴向切线模量 $\\mathrm{d}\\tau_{11}/\\mathrm{d}E_{11}$。\n\n根据前面部分的结果，我们确定 Kirchhoff 应力和 Hencky 应变的轴向分量。\n轴向 Kirchhoff 应力为：\n$$\\tau_{11} = 2\\mu\\ln\\lambda$$\n轴向对数应变为：\n$$E_{11} = \\ln\\lambda$$\n题目要求我们计算导数 $\\frac{\\mathrm{d}\\tau_{11}}{\\mathrm{d}E_{11}}$。通过直接代入，我们观察到轴向应力分量和轴向应变分量之间存在线性关系：\n$$\\tau_{11} = 2\\mu E_{11}$$\n对 $\\tau_{11}$ 求关于 $E_{11}$ 的导数，得到一个常数：\n$$\\frac{\\mathrm{d}\\tau_{11}}{\\mathrm{d}E_{11}} = \\frac{\\mathrm{d}}{\\mathrm{d}E_{11}}(2\\mu E_{11}) = 2\\mu$$\n或者，使用关于 $\\lambda$ 的链式法则：\n$$\\frac{\\mathrm{d}\\tau_{11}}{\\mathrm{d}\\lambda} = \\frac{\\mathrm{d}}{\\mathrm{d}\\lambda}(2\\mu\\ln\\lambda) = \\frac{2\\mu}{\\lambda}$$\n$$\\frac{\\mathrm{d}E_{11}}{\\mathrm{d}\\lambda} = \\frac{\\mathrm{d}}{\\mathrm{d}\\lambda}(\\ln\\lambda) = \\frac{1}{\\lambda}$$\n$$\\frac{\\mathrm{d}\\tau_{11}}{\\mathrm{d}E_{11}} = \\frac{\\mathrm{d}\\tau_{11}/\\mathrm{d}\\lambda}{\\mathrm{d}E_{11}/\\mathrm{d}\\lambda} = \\frac{2\\mu / \\lambda}{1 / \\lambda} = 2\\mu$$\n两种方法都证实了此加载路径上的轴向切线模量为 $2\\mu$。这是第三个也是最后一个结果。\n\n三个所要求的表达式为：\n1) $\\psi_H(\\lambda) = \\tfrac{3}{2}\\mu(\\ln\\lambda)^2$\n2) $\\tau(\\lambda) = \\mathrm{diag}(2\\mu\\ln\\lambda, -\\mu\\ln\\lambda, -\\mu\\ln\\lambda)$\n3) $\\frac{\\mathrm{d}\\tau_{11}}{\\mathrm{d}E_{11}} = 2\\mu$", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{3}{2}\\mu(\\ln\\lambda)^{2} & \\mathrm{diag}(2\\mu\\ln\\lambda, -\\mu\\ln\\lambda, -\\mu\\ln\\lambda) & 2\\mu \\end{pmatrix}}$$", "id": "2876930"}, {"introduction": "在非线性有限元分析中，迭代求解算法（如牛顿法）的效率和收敛性严重依赖于一致切线算子 (consistent tangent operator) 的精确性。本练习将引导你推导一个通用的 Hencky 型本构模型的切线算子 $\\mathbb{C}_t = \\partial \\boldsymbol{\\tau} / \\partial \\boldsymbol{E}$。通过运用张量微积分，你将学会如何将复杂的非线性应力-应变关系线性化，为编写高效的材料本构子程序打下坚实的理论基础。", "problem": "考虑 Hencky 意义下的各向同性塑性变形理论，其中 Kirchhoff 应力张量 $\\tau$ 是 Hencky (对数) 应变张量 $E$ 的函数，通过以下公式给出：\n$$\n\\tau(E) = 2\\,G_s\\!\\left(\\bar{E}\\right)\\,\\operatorname{dev}E \\;+\\; 3\\,K_s\\!\\left(\\operatorname{tr}E\\right)\\,\\operatorname{tr}(E)\\,I,\n$$\n其中 $E$ 为对称张量。此处 $I$ 是二阶单位张量，$\\operatorname{tr}(\\cdot)$ 是迹，$\\operatorname{dev}E := E - \\tfrac{1}{3}\\operatorname{tr}(E)\\,I$ 是偏量部分。等效 Hencky 应变定义为：\n$$\n\\bar{E} := \\sqrt{\\tfrac{2}{3}}\\,\\|\\operatorname{dev}E\\|, \\quad \\|\\cdot\\| := \\sqrt{(\\cdot):(\\cdot)},\n$$\n且标量函数 $G_s(\\cdot)$ 和 $K_s(\\cdot)$ 在其参数上是可微的。将四阶一致切线算子 $\\mathbb{C}_t$ 定义为 $\\tau$ 关于 $E$ 的 Fréchet 导数，即 $\\mathbb{C}_t := \\dfrac{\\partial \\tau}{\\partial E}$，使得对于任意对称变分 $dE$，都有 $d\\tau = \\mathbb{C}_t : dE$。\n\n从上述本构假设、$\\operatorname{tr}(\\cdot)$、$\\operatorname{dev}(\\cdot)$ 和 $\\bar{E}$ 的定义出发，仅使用基本张量微积分（双点积和外积），计算 $\\mathbb{C}_t$ 关于 $E$、$I$、四阶偏量投影算子以及导数 $\\dfrac{dG_s}{d\\bar{E}}$ 和 $\\dfrac{dK_s}{d(\\operatorname{tr}E)}$ 的闭式表达式。假设 $\\operatorname{dev}E \\neq 0$，因此 $\\bar{E} > 0$。\n\n符号和约定：\n- 双点积为 $A:B := \\operatorname{tr}(A^{\\mathsf{T}}B)$。\n- 对于二阶张量 $A$ 和 $B$，四阶张量 $A \\otimes B$ 作用于二阶张量 $X$ 的方式为 $(A \\otimes B):X = A\\,(B:X)$。\n- 四阶单位张量 $\\mathbb{I}$ 定义为：对于任意二阶张量 $X$，$\\mathbb{I}:X = X$。\n- 四阶偏量投影算子为 $\\mathbb{I}^{\\operatorname{dev}} := \\mathbb{I} - \\tfrac{1}{3}\\,I \\otimes I$。\n\n你的最终答案必须是 $\\mathbb{C}_t$ 的单个闭式解析表达式。无需进行数值计算，也不需要单位。将最终结果表示为单个表达式，除所要求的表达式外，不要包含任何不等式或方程式。", "solution": "在尝试任何求解之前，对问题陈述进行验证。\n\n逐字提取已知条件如下：\n- 本构律: $\\tau(E) = 2\\,G_s\\!\\left(\\bar{E}\\right)\\,\\operatorname{dev}E \\;+\\; 3\\,K_s\\!\\left(\\operatorname{tr}E\\right)\\,\\operatorname{tr}(E)\\,I$。\n- 应变张量 $E$ 是对称的。\n- $I$ 是二阶单位张量。\n- $\\operatorname{tr}(\\cdot)$ 是迹算子。\n- $\\operatorname{dev}E := E - \\tfrac{1}{3}\\operatorname{tr}(E)\\,I$。\n- 等效 Hencky 应变: $\\bar{E} := \\sqrt{\\tfrac{2}{3}}\\,\\|\\operatorname{dev}E\\|, \\quad \\|\\cdot\\| := \\sqrt{(\\cdot):(\\cdot)}$。\n- 标量函数 $G_s(\\cdot)$ 和 $K_s(\\cdot)$ 是可微的。\n- 四阶一致切线算子为 $\\mathbb{C}_t := \\dfrac{\\partial \\tau}{\\partial E}$，定义为 $d\\tau = \\mathbb{C}_t : dE$。\n- 假设 $\\operatorname{dev}E \\neq 0$，这意味着 $\\bar{E} > 0$。\n- 符号: $A:B := \\operatorname{tr}(A^{\\mathsf{T}}B)$，$(A \\otimes B):X = A\\,(B:X)$，$\\mathbb{I}:X = X$，$\\mathbb{I}^{\\operatorname{dev}} := \\mathbb{I} - \\tfrac{1}{3}\\,I \\otimes I$。\n\n对问题的有效性进行评估。\n1.  **科学依据**：该问题是非线性固体力学中的一个标准推导，特别涉及超弹性或塑性变形理论模型（Hencky 型模型）。所有概念和定义在连续介质力学和张量微积分中都是公认的。该问题具有科学合理性。\n2.  **适定性**：该问题要求计算一个定义良好、可微函数的 Fréchet 导数。所有必要的量都已定义，且假设 $\\bar{E} > 0$ 确保了函数 $G_s(\\bar{E})$ 的求值点远离 $\\bar{E}$ 本身的潜在不可微点（在 $\\operatorname{dev}E=0$ 处）。存在唯一解。\n3.  **客观性**：该问题以精确的数学语言陈述，没有歧义或主观内容。\n\n问题被判定为有效。将提供解答。\n\n目标是计算四阶切线算子 $\\mathbb{C}_t = \\dfrac{\\partial \\tau}{\\partial E}$。应力张量 $\\tau$ 由偏量部分 $\\tau_{\\text{dev}}$ 和体积部分 $\\tau_{\\text{vol}}$ 组成：\n$$\n\\tau(E) = \\tau_{\\text{dev}}(E) + \\tau_{\\text{vol}}(E)\n$$\n其中\n$$\n\\tau_{\\text{dev}}(E) = 2\\,G_s(\\bar{E})\\,\\operatorname{dev}E\n$$\n$$\n\\tau_{\\text{vol}}(E) = 3\\,K_s(\\operatorname{tr}E)\\,\\operatorname{tr}(E)\\,I\n$$\n根据微分的线性性质，切线算子是这两部分导数之和：\n$$\n\\mathbb{C}_t = \\frac{\\partial \\tau}{\\partial E} = \\frac{\\partial \\tau_{\\text{dev}}}{\\partial E} + \\frac{\\partial \\tau_{\\text{vol}}}{\\partial E}\n$$\n我们将分别计算每个导数。\n\n首先，我们处理体积部分 $\\tau_{\\text{vol}}$ 的导数。令 $\\theta := \\operatorname{tr}(E)$。体积应力为 $\\tau_{\\text{vol}} = 3\\,K_s(\\theta)\\,\\theta\\,I$。我们求其微分 $d\\tau_{\\text{vol}}$：\n$$\nd\\tau_{\\text{vol}} = d(3\\,K_s(\\theta)\\,\\theta\\,I) = 3\\,I\\,d(K_s(\\theta)\\,\\theta)\n$$\n使用标量微分的乘法法则：\n$$\nd(K_s(\\theta)\\,\\theta) = \\left( \\frac{d(K_s\\theta)}{d\\theta} \\right) d\\theta = \\left( \\frac{dK_s}{d\\theta}\\theta + K_s(\\theta) \\right) d\\theta\n$$\n迹的微分是 $d\\theta = d(\\operatorname{tr}(E)) = \\operatorname{tr}(dE) = I:dE$。将此代入 $d\\tau_{\\text{vol}}$ 的表达式中，得到：\n$$\nd\\tau_{\\text{vol}} = 3\\,I \\left( \\frac{dK_s}{d\\theta}\\theta + K_s(\\theta) \\right) (I:dE)\n$$\n回顾外积的定义 $(A \\otimes B):X = A(B:X)$，我们可以确定表示体积部分导数的四阶张量：\n$$\n\\frac{\\partial \\tau_{\\text{vol}}}{\\partial E} = 3\\left(K_s(\\operatorname{tr}E) + \\operatorname{tr}(E)\\frac{dK_s}{d(\\operatorname{tr}E)}\\right) I \\otimes I\n$$\n\n接下来，我们处理偏量部分 $\\tau_{\\text{dev}} = 2\\,G_s(\\bar{E})\\,\\operatorname{dev}E$ 的导数。我们应用对张量求导的乘法法则：\n$$\nd\\tau_{\\text{dev}} = d(2\\,G_s(\\bar{E})\\,\\operatorname{dev}E) = 2\\,(dG_s(\\bar{E}))\\,\\operatorname{dev}E + 2\\,G_s(\\bar{E})\\,d(\\operatorname{dev}E)\n$$\n我们分析和中的每一项。$E$ 的偏量部分的微分是：\n$$\nd(\\operatorname{dev}E) = d\\left(E - \\frac{1}{3}\\operatorname{tr}(E)I\\right) = dE - \\frac{1}{3}d(\\operatorname{tr}(E))I = dE - \\frac{1}{3}(I:dE)I\n$$\n该表达式可以使用四阶偏量投影算子 $\\mathbb{I}^{\\operatorname{dev}} = \\mathbb{I} - \\frac{1}{3}I \\otimes I$ 来书写：\n$$\nd(\\operatorname{dev}E) = \\mathbb{I}^{\\operatorname{dev}}:dE\n$$\n因此，$d\\tau_{\\text{dev}}$ 的第二项是 $2\\,G_s(\\bar{E})\\,(\\mathbb{I}^{\\operatorname{dev}}:dE)$，它对应于张量 $2\\,G_s(\\bar{E})\\,\\mathbb{I}^{\\operatorname{dev}}$。\n\n对于第一项 $2\\,(dG_s(\\bar{E}))\\,\\operatorname{dev}E$，我们使用链式法则：$dG_s(\\bar{E}) = \\frac{dG_s}{d\\bar{E}}d\\bar{E}$。我们必须求出等效应变的微分 $d\\bar{E}$。\n$$\n\\bar{E} = \\sqrt{\\frac{2}{3}}\\|\\operatorname{dev}E\\| = \\sqrt{\\frac{2}{3}} \\left(\\operatorname{dev}E:\\operatorname{dev}E\\right)^{1/2}\n$$\n微分是：\n$$\nd\\bar{E} = \\sqrt{\\frac{2}{3}} \\cdot \\frac{1}{2\\|\\operatorname{dev}E\\|} \\cdot d(\\operatorname{dev}E:\\operatorname{dev}E) = \\sqrt{\\frac{2}{3}} \\frac{1}{\\|\\operatorname{dev}E\\|} (\\operatorname{dev}E : d(\\operatorname{dev}E))\n$$\n由于 $\\operatorname{dev}E$ 是一个偏张量，它在 Frobenius 内积空间中与单位张量 $I$ 正交。此外，$d(\\operatorname{dev}E) = \\mathbb{I}^{\\operatorname{dev}}:dE$ 也是偏张量。一个偏张量与一个偏量投影结果的缩并可以简化：$\\operatorname{dev}E : d(\\operatorname{dev}E) = \\operatorname{dev}E : (\\mathbb{I}^{\\operatorname{dev}}:dE) = (\\operatorname{dev}E:\\mathbb{I}^{\\operatorname{dev}}):dE = \\operatorname{dev}E:dE$。因此：\n$$\nd\\bar{E} = \\sqrt{\\frac{2}{3}} \\frac{\\operatorname{dev}E}{\\|\\operatorname{dev}E\\|} : dE\n$$\n我们定义归一化偏应变张量 $N := \\frac{\\operatorname{dev}E}{\\|\\operatorname{dev}E\\|}$。那么 $d\\bar{E} = \\sqrt{\\frac{2}{3}}(N:dE)$。\n将此代入 $d\\tau_{\\text{dev}}$ 的第一项，得到：\n$$\n2\\,(dG_s(\\bar{E}))\\,\\operatorname{dev}E = 2\\,\\frac{dG_s}{d\\bar{E}} \\left( \\sqrt{\\frac{2}{3}}(N:dE) \\right) \\operatorname{dev}E = \\left( 2\\sqrt{\\frac{2}{3}}\\frac{dG_s}{d\\bar{E}} (\\operatorname{dev}E \\otimes N) \\right) : dE\n$$\n为了简化前置因子，我们使用关系式 $\\operatorname{dev}E = \\|\\operatorname{dev}E\\|N$ 和 $\\bar{E} = \\sqrt{\\frac{2}{3}}\\|\\operatorname{dev}E\\|$：\n$$\n2\\sqrt{\\frac{2}{3}}\\frac{dG_s}{d\\bar{E}} (\\operatorname{dev}E \\otimes N) = 2\\sqrt{\\frac{2}{3}}\\frac{dG_s}{d\\bar{E}} (\\|\\operatorname{dev}E\\|N \\otimes N) = 2\\frac{dG_s}{d\\bar{E}} \\left( \\sqrt{\\frac{2}{3}}\\|\\operatorname{dev}E\\| \\right) (N \\otimes N) = 2\\bar{E}\\frac{dG_s}{d\\bar{E}} (N \\otimes N)\n$$\n使用 $N \\otimes N = \\frac{\\operatorname{dev}E \\otimes \\operatorname{dev}E}{\\|\\operatorname{dev}E\\|^2}$ 和 $\\|\\operatorname{dev}E\\|^2 = \\frac{3}{2}\\bar{E}^2$，这变为：\n$$\n2\\bar{E}\\frac{dG_s}{d\\bar{E}} \\left( \\frac{\\operatorname{dev}E \\otimes \\operatorname{dev}E}{(3/2)\\bar{E}^2} \\right) = \\frac{4}{3\\bar{E}}\\frac{dG_s}{d\\bar{E}}(\\operatorname{dev}E \\otimes \\operatorname{dev}E)\n$$\n结合偏应力导数的两个部分，我们得到：\n$$\n\\frac{\\partial \\tau_{\\text{dev}}}{\\partial E} = 2\\,G_s(\\bar{E})\\,\\mathbb{I}^{\\operatorname{dev}} + \\frac{4}{3\\bar{E}}\\frac{dG_s}{d\\bar{E}}(\\operatorname{dev}E \\otimes \\operatorname{dev}E)\n$$\n\n最后，我们将体积和偏量贡献相加，得到完整的切线算子 $\\mathbb{C}_t$：\n$$\n\\mathbb{C}_t = 2\\,G_s(\\bar{E})\\,\\mathbb{I}^{\\operatorname{dev}} + \\frac{4}{3\\bar{E}}\\frac{dG_s}{d\\bar{E}}(\\operatorname{dev}E \\otimes \\operatorname{dev}E) + 3\\left(K_s(\\operatorname{tr}E) + \\operatorname{tr}(E)\\frac{dK_s}{d(\\operatorname{tr}E)}\\right) I \\otimes I\n$$\n这就是一致切线算子的闭式表达式。", "answer": "$$\n\\boxed{2\\,G_s(\\bar{E})\\,\\mathbb{I}^{\\operatorname{dev}} + \\frac{4}{3\\bar{E}}\\frac{dG_s}{d\\bar{E}}(\\operatorname{dev}E \\otimes \\operatorname{dev}E) + 3\\left(K_s(\\operatorname{tr}E) + \\operatorname{tr}(E)\\frac{dK_s}{d(\\operatorname{tr}E)}\\right) I \\otimes I}\n$$", "id": "2876868"}, {"introduction": "本练习将理论付诸实践，模拟了在有限元程序中处理平面应力单元时遇到的一个核心问题。当材料响应是非线性时，平面应力条件（例如 $\\tau_{33}=0$）会转化为一个关于平面外应变分量 $E_{33}$ 的非线性方程。你将通过推导和实现一个牛顿迭代求解器来解决这个问题，这需要用到前述练习中的切线刚度概念，从而深刻理解理论如何在实际计算中协同工作。", "problem": "考虑一个三维各向同性材料，在有限应变下通过一个二维平面应力有限元进行离散。本构假设遵循基于Hencky（对数）应变度量的塑性变形理论。面内对数应变分量 $E_{11}$、$E_{22}$ 和 $E_{12}$ 从单元运动学中已知，而面外对数应变分量 $E_{33}$ 未知，必须通过满足平面应力条件来确定。任务是为 $E_{33}$ 构建并实现一个迭代更新方案，该方案通过求解 $E_{33}$ 以强制满足平面应力约束，使得Kirchhoff应力的面外分量 $ \\tau_{33}$ 消失，即 $ \\tau_{33} = 0$，同时对平面内分量使用Hencky度量。\n\n假设以下基本定义和模型选择：\n- Kirchhoff应力 $ \\boldsymbol{\\tau}$ 通过与Hencky度量塑性变形理论一致的各向同性关系与对数应变 $ \\mathbf{E}$ 相关联：\n$$\n\\boldsymbol{\\tau} = K\\!\\left(\\bar{E}\\right) \\, \\mathrm{tr}(\\mathbf{E}) \\, \\mathbf{I} + 2 \\, G\\!\\left(\\bar{E}\\right) \\, \\mathbf{E}^{\\mathrm{dev}},\n$$\n其中 $ \\mathrm{tr}(\\cdot)$ 是迹， $ \\mathbf{I}$ 是二阶单位张量， $ \\mathbf{E}^{\\mathrm{dev}} = \\mathbf{E} - \\tfrac{1}{3}\\mathrm{tr}(\\mathbf{E}) \\mathbf{I}$ 是对数应变的偏量部分。\n- 等效Hencky应变 $ \\bar{E}$ 定义为 $ \\mathbf{E}^{\\mathrm{dev}}$ 的第二不变量度量：\n$$\n\\bar{E} = \\sqrt{\\tfrac{2}{3} \\, \\mathbf{E}^{\\mathrm{dev}} : \\mathbf{E}^{\\mathrm{dev}} }.\n$$\n- 体积模量取为常数 $ K(\\bar{E}) = K_0$，剪切模量随等效应变软化，关系如下\n$$\nG(\\bar{E}) = G_\\infty + \\frac{G_0 - G_\\infty}{1 + \\left(\\frac{\\bar{E}}{E_p}\\right)^{n}},\n$$\n其中材料参数为 $ K_0 > 0$, $ G_0 > 0$, $ 0 < G_\\infty < G_0$, $ E_p > 0$, and $ n \\ge 1$。\n- 平面应力在Kirchhoff应力层面强制施加，这等效于 $ \\sigma_{33} = 0$，因为 $ \\boldsymbol{\\tau} = J \\boldsymbol{\\sigma}$ 且 $ J > 0$。\n\n您必须：\n- 从第一性原理出发，推导进行稳健的Newton迭代所需的标量残差方程 $ r(E_{33}) = \\tau_{33}(E_{33})$ 及其导数 $ r'(E_{33}) = \\mathrm{d}\\tau_{33}/\\mathrm{d}E_{33}$。明确说明如何计算 $ \\mathrm{tr}(\\mathbf{E})$、$ \\mathbf{E}^{\\mathrm{dev}}$、$ \\bar{E}$ 和 $ \\mathrm{d}G/\\mathrm{d}E_{33}$，除了本构响应的基本各向同性假设和上述定义外，不做任何其他假设。\n- 提出并实现一个带回溯的阻尼Newton法，对以下每个测试用例求解 $ r(E_{33}) = 0$ 以得到 $ E_{33}$。当绝对残差 $ |r(E_{33})| < 10^{-12}$ 帕斯卡，或绝对更新量 $ |\\Delta E_{33}| < 10^{-14}$ 时，迭代必须终止；如果未达到收敛，则最多迭代 $ 50$ 次。使用一个具有物理动机的初始猜测值，该值通过将 $ G(\\bar{E})$ 固定在 $ G_0$ 并求解线性化平面应力条件得到。\n- 将面内剪切对数应变 $ E_{12}$ 视为张量分量（而非工程剪切应变），并假设 $ E_{13} = 0$ 和 $ E_{23} = 0$。\n\n所有测试用例的材料参数：\n- $ K_0 = 1.60 \\times 10^{11}$ 帕斯卡。\n- $ G_0 = 8.00 \\times 10^{10}$ 帕斯卡。\n- $ G_\\infty = 0.20 \\, G_0$。\n- $ E_p = 5.0 \\times 10^{-2}$ （无量纲）。\n- $ n = 2$。\n\n测试套件（提供 $ E_{11}$、$ E_{22}$、$ E_{12}$；所有应变均为无量纲）：\n1. $ \\left(E_{11}, E_{22}, E_{12}\\right) = \\left(2.0 \\times 10^{-2}, -1.0 \\times 10^{-2}, 3.0 \\times 10^{-2}\\right)$。\n2. $ \\left(E_{11}, E_{22}, E_{12}\\right) = \\left(5.0 \\times 10^{-2}, 5.0 \\times 10^{-2}, 0.0\\right)$。\n3. $ \\left(E_{11}, E_{22}, E_{12}\\right) = \\left(0.0, 0.0, 0.0\\right)$。\n4. $ \\left(E_{11}, E_{22}, E_{12}\\right) = \\left(0.0, 0.0, 2.0 \\times 10^{-1}\\right)$。\n5. $ \\left(E_{11}, E_{22}, E_{12}\\right) = \\left(1.5 \\times 10^{-1}, -2.0 \\times 10^{-2}, 1.0 \\times 10^{-2}\\right)$。\n\n您的程序必须：\n- 使用推导出的残差及其导数实现 $ E_{33}$ 的Newton求解器。\n- 对于每个测试用例，计算并返回 $ E_{33}$ 的收敛值（无量纲）。\n- 生成单行输出，包含一个用方括号括起来的逗号分隔列表形式的结果（例如，$ [x_1,x_2,x_3,x_4,x_5]$）。每个条目必须是一个浮点数。\n\n不应读取任何用户输入。所有计算必须使用上面提供的常数和测试用例进行。输出没有单位，因为 $ E_{33}$ 是无量纲的。", "solution": "所给出的问题是计算固体力学中的一个适定问题。它有科学依据、自洽，并要求推导和实现一个数值算法来求解一个非线性标量方程。应力、应变和本构模型的定义在采用对数应变度量的塑性变形理论框架内是标准的。所有必要的材料参数和边界条件，以给定的面内应变和平面应力约束的形式提供。因此，我将继续进行推导和求解。\n\n目标是找到满足平面应力条件 $\\tau_{33} = 0$ 的面外对数应变分量 $E_{33}$，给定面内分量 $E_{11}$、$E_{22}$ 和 $E_{12}$。对数应变张量 $\\mathbf{E}$ 由下式给出：\n$$\n\\mathbf{E} = \\begin{pmatrix} E_{11} & E_{12} & 0 \\\\ E_{12} & E_{22} & 0 \\\\ 0 & 0 & E_{33} \\end{pmatrix}\n$$\n求解需要一个Newton-Raphson迭代方案，为此我们必须推导残差函数 $r(E_{33}) = \\tau_{33}(E_{33})$ 及其关于 $E_{33}$ 的导数。\n\n首先，我们将基本运动学量表示为未知数 $E_{33}$ 的函数。应变张量的迹为：\n$$\n\\mathrm{tr}(\\mathbf{E}) = E_{11} + E_{22} + E_{33}\n$$\n对数应变偏量部分 $\\mathbf{E}^{\\mathrm{dev}} = \\mathbf{E} - \\frac{1}{3}\\mathrm{tr}(\\mathbf{E})\\mathbf{I}$ 的面外法向分量为：\n$$\nE_{33}^{\\mathrm{dev}} = E_{33} - \\frac{1}{3}\\mathrm{tr}(\\mathbf{E}) = E_{33} - \\frac{1}{3}(E_{11} + E_{22} + E_{33}) = \\frac{2}{3}E_{33} - \\frac{1}{3}(E_{11} + E_{22})\n$$\nKirchhoff应力 $\\boldsymbol{\\tau}$ 的本构关系如下：\n$$\n\\boldsymbol{\\tau} = K_0 \\mathrm{tr}(\\mathbf{E}) \\mathbf{I} + 2 G(\\bar{E}) \\mathbf{E}^{\\mathrm{dev}}\n$$\n其中 $K_0$ 是常数体积模量，$G(\\bar{E})$ 是应变相关的剪切模量。平面应力条件 $\\tau_{33} = 0$ 产生了标量残差方程：\n$$\nr(E_{33}) = \\tau_{33}(E_{33}) = K_0 \\mathrm{tr}(\\mathbf{E}) + 2 G(\\bar{E}) E_{33}^{\\mathrm{dev}} = 0\n$$\n代入 $\\mathrm{tr}(\\mathbf{E})$ 和 $E_{33}^{\\mathrm{dev}}$ 的表达式，我们得到残差函数的显式形式：\n$$\nr(E_{33}) = K_0 (E_{11} + E_{22} + E_{33}) + 2 G(\\bar{E}) \\left( \\frac{2}{3}E_{33} - \\frac{1}{3}(E_{11} + E_{22}) \\right)\n$$\n这是一个关于 $E_{33}$ 的非线性方程，因为剪切模量 $G$ 依赖于等效应变 $\\bar{E}$，而 $\\bar{E}$ 又依赖于 $E_{33}$。等效应变 $\\bar{E}$ 定义为：\n$$\n\\bar{E} = \\sqrt{\\frac{2}{3} \\mathbf{E}^{\\mathrm{dev}} : \\mathbf{E}^{\\mathrm{dev}}} = \\sqrt{\\frac{2}{3} \\left[ (E_{11}^{\\mathrm{dev}})^2 + (E_{22}^{\\mathrm{dev}})^2 + (E_{33}^{\\mathrm{dev}})^2 + 2(E_{12}^{\\mathrm{dev}})^2 \\right]}\n$$\n由于 $E_{13}=E_{23}=0$，我们有 $E_{13}^{\\mathrm{dev}}=E_{23}^{\\mathrm{dev}}=0$。注意 $E_{12}^{\\mathrm{dev}} = E_{12}$。\n\n对于Newton-Raphson方法，我们需要残差的导数 $r'(E_{33}) = \\mathrm{d}r/\\mathrm{d}E_{33}$。应用链式法则：\n$$\nr'(E_{33}) = \\frac{\\mathrm{d}}{\\mathrm{d}E_{33}} \\left[ K_0 \\mathrm{tr}(\\mathbf{E}) + 2 G(\\bar{E}) E_{33}^{\\mathrm{dev}} \\right] = K_0 \\frac{\\mathrm{d}(\\mathrm{tr}(\\mathbf{E}))}{\\mathrm{d}E_{33}} + 2 \\frac{\\mathrm{d}G}{\\mathrm{d}E_{33}} E_{33}^{\\mathrm{dev}} + 2 G(\\bar{E}) \\frac{\\mathrm{d}(E_{33}^{\\mathrm{dev}})}{\\mathrm{d}E_{33}}\n$$\n运动学项的导数很简单：\n$$\n\\frac{\\mathrm{d}(\\mathrm{tr}(\\mathbf{E}))}{\\mathrm{d}E_{33}} = \\frac{\\mathrm{d}}{\\mathrm{d}E_{33}}(E_{11} + E_{22} + E_{33}) = 1\n$$\n$$\n\\frac{\\mathrm{d}(E_{33}^{\\mathrm{dev}})}{\\mathrm{d}E_{33}} = \\frac{\\mathrm{d}}{\\mathrm{d}E_{33}}\\left(\\frac{2}{3}E_{33} - \\frac{1}{3}(E_{11} + E_{22})\\right) = \\frac{2}{3}\n$$\n剪切模量对 $E_{33}$ 的导数使用链式法则求得：\n$$\n\\frac{\\mathrm{d}G}{\\mathrm{d}E_{33}} = \\frac{\\mathrm{d}G}{\\mathrm{d}(\\bar{E}^2)} \\frac{\\mathrm{d}(\\bar{E}^2)}{\\mathrm{d}E_{33}}\n$$\n首先，我们求 $\\mathrm{d}(\\bar{E}^2)/\\mathrm{d}E_{33}$。我们有 $\\bar{E}^2 = \\frac{2}{3}\\mathbf{E}^{\\mathrm{dev}}:\\mathbf{E}^{\\mathrm{dev}}$。\n$$\n\\frac{\\mathrm{d}(\\bar{E}^2)}{\\mathrm{d}E_{33}} = \\frac{2}{3} \\left( 2 \\frac{\\mathrm{d}\\mathbf{E}^{\\mathrm{dev}}}{\\mathrm{d}E_{33}} : \\mathbf{E}^{\\mathrm{dev}} \\right)\n$$\n偏应变张量的导数为 $\\frac{\\mathrm{d}\\mathbf{E}^{\\mathrm{dev}}}{\\mathrm{d}E_{33}} = \\frac{\\mathrm{d}\\mathbf{E}}{\\mathrm{d}E_{33}} - \\frac{1}{3} \\frac{\\mathrm{d}(\\mathrm{tr}(\\mathbf{E}))}{\\mathrm{d}E_{33}} \\mathbf{I}$。设 $\\mathbf{N}$ 为一个张量，其分量 $N_{33}=1$ 且所有其他分量为零。则 $\\frac{\\mathrm{d}\\mathbf{E}}{\\mathrm{d}E_{33}} = \\mathbf{N}$。因此，$\\frac{\\mathrm{d}\\mathbf{E}^{\\mathrm{dev}}}{\\mathrm{d}E_{33}} = \\mathbf{N} - \\frac{1}{3}\\mathbf{I} = \\text{diag}(-\\frac{1}{3}, -\\frac{1}{3}, \\frac{2}{3})$。\n张量缩并得到 $(\\mathbf{N} - \\frac{1}{3}\\mathbf{I}) : \\mathbf{E}^{\\mathrm{dev}} = -\\frac{1}{3}E_{11}^{\\mathrm{dev}} -\\frac{1}{3}E_{22}^{\\mathrm{dev}} + \\frac{2}{3}E_{33}^{\\mathrm{dev}}$。利用性质 $\\mathrm{tr}(\\mathbf{E}^{\\mathrm{dev}})=0$，我们得到 $E_{11}^{\\mathrm{dev}}+E_{22}^{\\mathrm{dev}} = -E_{33}^{\\mathrm{dev}}$，所以缩并简化为 $E_{33}^{\\mathrm{dev}}$。\n因此，$\\frac{\\mathrm{d}(\\bar{E}^2)}{\\mathrm{d}E_{33}} = \\frac{4}{3}E_{33}^{\\mathrm{dev}}$。\n接下来，我们求 $\\mathrm{d}G/\\mathrm{d}(\\bar{E}^2)$。当 $n=2$ 时，剪切模量为 $G(\\bar{E}) = G_\\infty + \\frac{G_0 - G_\\infty}{1 + (\\bar{E}/E_p)^2} = G_\\infty + \\frac{G_0 - G_\\infty}{1 + \\bar{E}^2/E_p^2}$。\n设 $y = \\bar{E}^2$ 且 $\\Delta G = G_0 - G_\\infty$。\n$$\n\\frac{\\mathrm{d}G}{\\mathrm{d}y} = \\Delta G \\cdot (-1) \\left(1 + \\frac{y}{E_p^2}\\right)^{-2} \\cdot \\frac{1}{E_p^2} = -\\frac{\\Delta G / E_p^2}{(1 + \\bar{E}^2/E_p^2)^2}\n$$\n结合这些结果，我们得到 $\\frac{\\mathrm{d}G}{\\mathrm{d}E_{33}} = -\\frac{\\Delta G / E_p^2}{(1 + \\bar{E}^2/E_p^2)^2} \\frac{4}{3}E_{33}^{\\mathrm{dev}}$。\n将所有导数代入 $r'(E_{33})$ 的表达式中：\n$$\nr'(E_{33}) = K_0(1) + 2 \\left( -\\frac{\\Delta G / E_p^2}{(1 + \\bar{E}^2/E_p^2)^2} \\frac{4}{3}E_{33}^{\\mathrm{dev}} \\right) E_{33}^{\\mathrm{dev}} + 2 G(\\bar{E}) \\left( \\frac{2}{3} \\right)\n$$\n$$\nr'(E_{33}) = K_0 + \\frac{4}{3}G(\\bar{E}) - \\frac{8}{3} \\frac{\\Delta G}{E_p^2} \\frac{(E_{33}^{\\mathrm{dev}})^2}{(1+\\bar{E}^2/E_p^2)^2}\n$$\n此表达式对于所有 $\\bar{E}$ 的值（包括 $\\bar{E}=0$）都是数值上稳健和良定义的。\n\nNewton迭代的初始猜测值 $E_{33}^{(0)}$ 通过线性化问题得到，即假设 $G(\\bar{E}) = G_0$。残差方程 $r(E_{33})=0$ 变为线性的：\n$$\nK_0 (E_{11} + E_{22} + E_{33}) + 2 G_0 \\left( \\frac{2}{3}E_{33} - \\frac{1}{3}(E_{11} + E_{22}) \\right) = 0\n$$\n求解 $E_{33}$ 得到初始猜测值：\n$$\nE_{33}^{(0)} = \\frac{\\frac{2}{3}G_0 - K_0}{K_0 + \\frac{4}{3}G_0} (E_{11} + E_{22})\n$$\n\n迭代算法是阻尼Newton-Raphson法。从 $k=0$ 和 $E_{33}^{(0)}$ 开始：\n1. 计算残差 $r(E_{33}^{(k)})$ 和切线 $r'(E_{33}^{(k)})$。\n2. 检查收敛性：如果 $|r(E_{33}^{(k)})| < 10^{-12}$，则已找到解。\n3. 计算Newton更新量：$\\Delta E_{33} = -r(E_{33}^{(k)}) / r'(E_{33}^{(k)})$。\n4. 执行回溯线搜索以找到阻尼因子 $\\alpha \\in (0, 1]$，使得 $|r(E_{33}^{(k)} + \\alpha \\Delta E_{33})| < |r(E_{33}^{(k)})|$。从 $\\alpha=1$ 开始，并将其减半直到满足条件。\n5. 更新解：$E_{33}^{(k+1)} = E_{33}^{(k)} + \\alpha \\Delta E_{33}$。\n6. 检查增量收敛性：如果 $|\\alpha \\Delta E_{33}| < 10^{-14}$，则已找到解。\n7. 重复以上步骤直到收敛或达到最大迭代次数 $50$ 次。\n对提供的每个测试用例执行此过程。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the out-of-plane logarithmic strain E33 to enforce the\n    plane-stress condition tau_33 = 0 for a Hencky plasticity model.\n    \"\"\"\n\n    # Material parameters\n    K0 = 1.60e11  # Bulk modulus (Pascals)\n    G0 = 8.00e10  # Initial shear modulus (Pascals)\n    G_inf_ratio = 0.20\n    G_inf = G_inf_ratio * G0 # Asymptotic shear modulus\n    E_p = 5.0e-2  # Plasticity parameter (dimensionless)\n    n = 2.0       # Softening exponent\n\n    # Newton solver parameters\n    TOL_RESIDUAL = 1e-12  # Tolerance on the residual |tau_33|\n    TOL_UPDATE = 1e-14    # Tolerance on the strain update |dE33|\n    MAX_ITER = 50         # Maximum number of iterations\n\n    # Test suite: (E11, E22, E12)\n    test_cases = [\n        (2.0e-2, -1.0e-2, 3.0e-2),\n        (5.0e-2, 5.0e-2, 0.0),\n        (0.0, 0.0, 0.0),\n        (0.0, 0.0, 2.0e-1),\n        (1.5e-1, -2.0e-2, 1.0e-2),\n    ]\n\n    results = []\n    for e11, e22, e12 in test_cases:\n        e33 = _solve_for_e33(e11, e22, e12, K0, G0, G_inf, E_p, n, \n                             TOL_RESIDUAL, TOL_UPDATE, MAX_ITER)\n        results.append(e33)\n\n    # Print the final result in the specified format\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\ndef _solve_for_e33(e11, e22, e12, K0, G0, G_inf, E_p, n, \n                     tol_r, tol_du, max_iter):\n    \"\"\"\n    Helper function to perform the Newton iteration for a single test case.\n    \"\"\"\n    delta_G = G0 - G_inf\n    e11_plus_e22 = e11 + e22\n\n    # Initial guess from linearized elastic solution\n    e33 = ((2./3. * G0 - K0) / (K0 + 4./3. * G0)) * e11_plus_e22\n\n    for _ in range(max_iter):\n        # --- Calculate residual and tangent for current e33 ---\n        # Kinematic quantities\n        tr_E = e11_plus_e22 + e33\n        \n        # Deviatoric strains\n        e11_dev = e11 - tr_E / 3.0\n        e22_dev = e22 - tr_E / 3.0\n        e33_dev = e33 - tr_E / 3.0 # This is (2/3)*e33 - (1/3)*e11_plus_e22\n        \n        e_bar_sq = (2./3.) * (e11_dev**2 + e22_dev**2 + e33_dev**2 + 2 * e12**2)\n        e_bar = np.sqrt(max(0.0, e_bar_sq))\n\n        # Material properties G(e_bar)\n        e_bar_over_Ep_sq = (e_bar / E_p)**2\n        G = G_inf + delta_G / (1.0 + e_bar_over_Ep_sq) # Since n=2\n\n        # Residual r(e33) = tau_33\n        residual = K0 * tr_E + 2 * G * e33_dev\n\n        # Check for convergence on residual\n        if abs(residual)  tol_r:\n            return e33\n        \n        # Tangent r'(e33)\n        # Term for G derivative calculation, stable for e_bar -> 0\n        dG_term = -(8.0 / 3.0) * (delta_G / E_p**2) * (e33_dev**2) / (1.0 + e_bar_over_Ep_sq)**2\n        tangent = K0 + (4.0 / 3.0) * G + dG_term\n        \n        # Newton update\n        de33 = -residual / tangent\n\n        # --- Damped update with backtracking line search ---\n        alpha = 1.0\n        current_res_norm = abs(residual)\n\n        for _ in range(10): # Max 10 backtracking steps\n            e33_trial = e33 + alpha * de33\n            \n            # Recalculate residual at trial point\n            tr_E_trial = e11_plus_e22 + e33_trial\n            e33_dev_trial = e33_trial - tr_E_trial / 3.0\n            e11_dev_trial = e11 - tr_E_trial / 3.0\n            e22_dev_trial = e22 - tr_E_trial / 3.0\n\n            e_bar_sq_trial = (2./3.) * (e11_dev_trial**2 + e22_dev_trial**2 + \n                                       e33_dev_trial**2 + 2 * e12**2)\n            e_bar_trial = np.sqrt(max(0.0, e_bar_sq_trial))\n            \n            G_trial = G_inf + delta_G / (1.0 + (e_bar_trial / E_p)**2)\n            \n            res_trial = K0 * tr_E_trial + 2 * G_trial * e33_dev_trial\n            \n            if abs(res_trial)  current_res_norm:\n                break\n            alpha /= 2.0\n        \n        update = alpha * de33\n        e33 += update\n        \n        # Check for convergence on update\n        if abs(update)  tol_du:\n            return e33\n\n    # If max iterations are reached without convergence, return the last value.\n    # In a real application, an error should be raised.\n    return e33\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2876883"}]}