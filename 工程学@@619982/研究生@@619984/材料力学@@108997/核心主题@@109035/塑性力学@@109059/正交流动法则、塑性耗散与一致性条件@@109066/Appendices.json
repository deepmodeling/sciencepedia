{"hands_on_practices": [{"introduction": "塑性变形本质上是一个不可逆的耗散过程。本练习将深入探讨塑性理论的热力学基础，阐明材料本构定律如何与热力学第二定律保持一致。我们将通过分析克劳修斯-杜亥（Clausius-Duhem）不等式所要求的非负塑性耗散 $\\mathcal{D}$，来揭示它如何约束硬化演化规律，并证明硬化势能函数的凸性是保证材料热力学稳定性的一个基本要求 [@problem_id:2893874]。这项实践旨在帮助你理解塑性模型中数学结构的深刻物理根源，而不仅仅是将其视为一组经验公式。", "problem": "考虑一个小应变、等温弹塑性材料，其自由能密度由下式给出\n$$\n\\psi(\\epsilon,\\epsilon^{p},q)=\\tfrac{1}{2}\\,(\\epsilon-\\epsilon^{p}):\\mathbb{C}:(\\epsilon-\\epsilon^{p})+g(q),\n$$\n其中 $\\epsilon$ 是总应变，$\\epsilon^{p}$ 是塑性应变，$\\mathbb{C}$ 是一个四阶正定弹性刚度张量，$q$ 是一个标量内硬化变量，$g(q)$ 是一个二次连续可微的储存硬化势。与 $q$ 共轭的热力学力定义为 $A=\\partial g/\\partial q$。柯西应力为 $\\sigma=\\mathbb{C}:(\\epsilon-\\epsilon^{p})$。对于等温过程，克劳修斯-杜亥姆不等式要求耗散\n$$\n\\mathcal{D}=\\sigma_{ij}\\,\\dot{\\epsilon}^{p}_{ij}-A\\,\\dot{q}\n$$\n对于所有容许过程均为非负。\n\n采用关联、率无关的塑性模型，其屈服函数为\n$$\nf(\\sigma,A)=\\sqrt{\\tfrac{3}{2}}\\left\\| \\operatorname{dev}\\sigma \\right\\| - \\big(\\sigma_{y0}+A\\big),\n$$\n其中 $\\operatorname{dev}\\sigma=\\sigma-\\tfrac{1}{3}\\,(\\operatorname{tr}\\sigma)\\,\\mathbf{I}$，且 $\\sigma_{y0}>0$ 是初始屈服应力（一个正常数）。假设塑性加载的 Karush–Kuhn–Tucker 条件成立，并使用针对广义热力学力 $(\\sigma,-A)$ 的正交流动法则，即\n$$\n\\dot{\\epsilon}^{p}=\\lambda\\,\\frac{\\partial f}{\\partial \\sigma},\\qquad \\dot{q}=\\lambda\\,\\frac{\\partial f}{\\partial(-A)}=-\\lambda\\,\\frac{\\partial f}{\\partial A},\\qquad \\lambda\\ge 0,\n$$\n当 $\\lambda>0$ 时，需满足一致性条件。\n\n令硬化势为 $g(q)=\\tfrac{1}{2}H\\,q^{2}$，其中硬化模量为常数 $H>0$，因此 $A=\\partial g/\\partial q=H\\,q$。\n\n仅使用基本热力学不等式、上述本构结构和基础张量微积分，推导塑性加载过程中的塑性耗散率 $\\mathcal{D}$，并将其简化为仅含塑性乘子 $\\lambda$ 和材料参数 $\\sigma_{y0}$ 的单个闭式表达式。简要解释为何您使用的条件保证了耗散的非负性，以及 $\\mathcal{D}\\ge 0$ 的要求如何通过 $g(q)$ 的凸性来约束容许的演化律 $A=\\partial g/\\partial q$。\n\n以国际单位制基本单位（Pa/s）报告耗散率的最终表达式。最终的方框答案中不要包含单位。无需进行数值计算或四舍五入；以符号表达式给出您的结果。", "solution": "该问题要求针对一个给定的弹塑性本构模型，推导其塑性耗散率，并解释该公式的热力学一致性。\n\n首先，确认问题陈述的有效性。该问题在科学上基于连续介质热力学和塑性理论的原理。它提法良好、客观，并提供了一套完整且一致的本构方程。因此，可以构建解答。\n\n塑性耗散率 $\\mathcal{D}$ 由等温过程的克劳修斯-杜亥姆不等式定义为\n$$\n\\mathcal{D} = \\sigma : \\dot{\\epsilon}^{p} - A \\dot{q}\n$$\n其中 $\\sigma$ 是柯西应力张量，$\\dot{\\epsilon}^{p}$ 是塑性应变率，$A$ 是与硬化变量 $q$ 共轭的热力学力，$\\dot{q}$ 是其变化率。冒号算子表示双点积，即 $\\sigma : \\dot{\\epsilon}^{p} = \\sigma_{ij}\\,\\dot{\\epsilon}^{p}_{ij}$。\n\n问题指定了基于屈服函数 $f(\\sigma, A)$ 的关联流动法则。内变量的变化率由下式给出\n$$\n\\dot{\\epsilon}^{p} = \\lambda\\,\\frac{\\partial f}{\\partial \\sigma}\n$$\n$$\n\\dot{q} = \\lambda\\,\\frac{\\partial f}{\\partial(-A)} = -\\lambda\\,\\frac{\\partial f}{\\partial A}\n$$\n其中 $\\lambda \\ge 0$ 是塑性乘子。将这些流动法则代入耗散表达式，得到\n$$\n\\mathcal{D} = \\sigma : \\left(\\lambda\\,\\frac{\\partial f}{\\partial \\sigma}\\right) - A \\left(-\\lambda\\,\\frac{\\partial f}{\\partial A}\\right) = \\lambda \\left( \\sigma : \\frac{\\partial f}{\\partial \\sigma} + A \\frac{\\partial f}{\\partial A} \\right)\n$$\n为继续推导，必须计算屈服函数的偏导数。屈服函数为\n$$\nf(\\sigma,A)=\\sqrt{\\tfrac{3}{2}}\\left\\| \\operatorname{dev}\\sigma \\right\\| - \\big(\\sigma_{y0}+A\\big)\n$$\n其中 $s = \\operatorname{dev}\\sigma = \\sigma-\\tfrac{1}{3}\\,(\\operatorname{tr}\\sigma)\\,\\mathbf{I}$ 是偏应力张量，且 $\\|s\\| = \\sqrt{s:s}$。\n\n使用链式法则求得 $f$ 对 $\\sigma$ 的偏导数：\n$$\n\\frac{\\partial f}{\\partial \\sigma} = \\sqrt{\\frac{3}{2}} \\frac{\\partial}{\\partial \\sigma} (\\sqrt{s:s}) = \\sqrt{\\frac{3}{2}} \\frac{1}{2\\sqrt{s:s}} \\frac{\\partial (s:s)}{\\partial \\sigma} = \\sqrt{\\frac{3}{2}} \\frac{s}{\\|s\\|}\n$$\n这里使用了恒等式 $\\frac{\\partial (s:s)}{\\partial \\sigma} = 2s$，该恒等式可由 $\\frac{\\partial s_{kl}}{\\partial \\sigma_{ij}} = \\delta_{ki}\\delta_{lj} - \\frac{1}{3}\\delta_{kl}\\delta_{ij}$ 以及 $\\operatorname{tr}(s)=0$ 的事实推导出。\n\n$f$ 对 $A$ 的偏导数则很简单：\n$$\n\\frac{\\partial f}{\\partial A} = -1\n$$\n将这些导数代入 $\\mathcal{D}$ 的表达式中：\n$$\n\\mathcal{D} = \\lambda \\left( \\sigma : \\left( \\sqrt{\\frac{3}{2}} \\frac{s}{\\|s\\|} \\right) + A (-1) \\right) = \\lambda \\left( \\sqrt{\\frac{3}{2}} \\frac{\\sigma:s}{\\|s\\|} - A \\right)\n$$\n偏应力张量 $s$ 的一个性质是它与任何应力张量的球张量部分正交。应力张量 $\\sigma$ 可以分解为 $\\sigma = s + \\frac{1}{3}(\\operatorname{tr}\\sigma)\\mathbf{I}$。因此，双点积 $\\sigma:s$ 可简化如下：\n$$\n\\sigma:s = \\left(s + \\frac{1}{3}(\\operatorname{tr}\\sigma)\\mathbf{I}\\right):s = s:s + \\frac{1}{3}(\\operatorname{tr}\\sigma)(\\mathbf{I}:s)\n$$\n由于 $\\mathbf{I}:s = \\operatorname{tr}(s) = 0$，我们有 $\\sigma:s = s:s = \\|s\\|^2$。耗散表达式变为\n$$\n\\mathcal{D} = \\lambda \\left( \\sqrt{\\frac{3}{2}} \\frac{\\|s\\|^2}{\\|s\\|} - A \\right) = \\lambda \\left( \\sqrt{\\frac{3}{2}} \\|s\\| - A \\right)\n$$\n问题陈述我们处于塑性加载状态，这意味着 Karush-Kuhn-Tucker (KKT) 一致性条件是激活的，即 $\\lambda > 0$ 且 $f(\\sigma, A) = 0$。屈服条件为\n$$\nf(\\sigma, A) = \\sqrt{\\tfrac{3}{2}}\\|\\operatorname{dev}\\sigma\\| - (\\sigma_{y0}+A) = 0\n$$\n由此，我们可以将等效应力表示为 $\\sqrt{\\frac{3}{2}}\\|\\operatorname{dev}\\sigma\\| = \\sigma_{y0}+A$。将其代入简化后的 $\\mathcal{D}$ 表达式中：\n$$\n\\mathcal{D} = \\lambda \\left( (\\sigma_{y0}+A) - A \\right) = \\lambda \\sigma_{y0}\n$$\n这就是以塑性乘子 $\\lambda$ 和初始屈服应力 $\\sigma_{y0}$ 表示的塑性耗散率的闭式表达式。\n\n耗散非负的条件 $\\mathcal{D} \\ge 0$ 由模型的基本假设保证。根据定义，塑性乘子 $\\lambda$ 是非负的（$\\lambda \\ge 0$），而初始屈服应力 $\\sigma_{y0}$ 是一个给定的正常数材料常数（$\\sigma_{y0} > 0$）。因此，它们的乘积 $\\mathcal{D} = \\lambda \\sigma_{y0}$ 必须是非负的。对于塑性加载（$\\lambda > 0$），耗散是严格为正的。\n\n对于任何容许的热力学过程，$\\mathcal{D}\\ge 0$ 的要求对本构模型施加了稳定性约束，这又导致了对储存硬化势 $g(q)$ 的凸性要求。热力学稳定性的一个基本条件是，自由能势 $\\psi$ 必须是其内状态变量（此处为 $(\\epsilon^p, q)$）的凸函数。如果 $\\psi$ 不是凸的，就可能存在自发的状态内部重排，导致自由能降低，而这部分能量可被用来做功，从而违反热力学第二定律。自由能中依赖于内变量的部分是 $\\psi_{\\text{int}}(\\epsilon^e, q) = \\frac{1}{2}(\\epsilon-\\epsilon^p):\\mathbb{C}:(\\epsilon-\\epsilon^p) + g(q)$，其中 $\\epsilon^e = \\epsilon - \\epsilon^p$。稳定性条件要求 $\\psi$ 相对于内状态变量的 Hessian 矩阵是半正定的。将 $\\epsilon^e$ 和 $q$ 作为状态变量，Hessian 矩阵为：\n$$\n\\text{Hess}(\\psi) = \\begin{pmatrix} \\frac{\\partial^2 \\psi}{\\partial \\epsilon^e \\otimes \\partial \\epsilon^e} & \\frac{\\partial^2 \\psi}{\\partial \\epsilon^e \\partial q} \\\\ \\frac{\\partial^2 \\psi}{\\partial q \\partial \\epsilon^e} & \\frac{\\partial^2 \\psi}{\\partial q^2} \\end{pmatrix} = \\begin{pmatrix} \\mathbb{C} & \\mathbf{0} \\\\ \\mathbf{0} & g''(q) \\end{pmatrix}\n$$\n为使该矩阵是半正定的，其对角块必须是半正定的。弹性刚度张量 $\\mathbb{C}$ 已被给定为正定的。因此，我们必须有 $g''(q) \\ge 0$。这正是凸函数 $g(q)$ 的数学定义。对于特定情况 $g(q)=\\frac{1}{2}Hq^2$，这要求硬化模量 $H \\ge 0$。问题陈述中 $H>0$，这对应于一个严格凸的势，并确保了热力学稳定性。\n\n最后，我们讨论单位问题。参数 $\\lambda$ 是一个率，由 $\\dot{\\epsilon}^p$（单位为 $s^{-1}$）和 $\\partial f/\\partial \\sigma$（无量纲）导出，因此 $\\lambda$ 的单位是 $s^{-1}$。屈服应力 $\\sigma_{y0}$ 的单位是压力，即帕斯卡（$Pa$）。因此，耗散率 $\\mathcal{D} = \\lambda \\sigma_{y0}$ 的单位是 $Pa \\cdot s^{-1}$ 或 $Pa/s$。这对应于功率密度（$W/m^3$）。我们注意到，问题陈述中要求的单位与此记法问题无关。", "answer": "$$\n\\boxed{\\lambda \\sigma_{y0}}\n$$", "id": "2893874"}, {"introduction": "在塑性加载过程中，应力状态必须始终停留在不断演化的屈服面上，这一基本约束被称为一致性条件（Consistency Condition）。这个条件，即屈服函数的时间导数 $\\dot{f}=0$，是确定塑性流动量的关键。本练习将指导你如何将一致性条件与流动法则及弹性定律相结合，一步步推导出在给定应变率下量化塑性变形速率的塑性乘子 $\\dot{\\lambda}$ [@problem_id:2905738]。通过这个计算，你将掌握将抽象的本构理论转化为求解具体工程问题中塑性应变演化的核心分析技能。", "problem": "在小应变假设下，一个均质、各向同性的金属通过结合了线性各向同性硬化的关联 von Mises 塑性理论和线性弹性理论进行建模。弹性模量为杨氏模量 $E = 210$ GPa 和泊松比 $\\nu = 0.30$。硬化模量为 $H = 1.5$ GPa。屈服函数为\n$$\nf(\\boldsymbol{\\sigma},\\alpha) = \\sqrt{\\frac{3}{2}}\\,\\|\\boldsymbol{s}\\| - \\big(\\sigma_{y0} + H\\,\\alpha\\big),\n$$\n其中 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}\\,\\text{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}$ 是偏柯西应力，$\\alpha$ 是等效塑性应变。流动法则是关联的，即\n$$\n\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\lambda}\\,\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}},\n$$\n且硬化变量遵循 von Mises 定义\n$$\n\\dot{\\alpha} = \\sqrt{\\frac{2}{3}}\\,\\|\\dot{\\boldsymbol{\\varepsilon}}^{p}\\|.\n$$\n\n在当前时刻，应力状态处于均质单轴拉伸下的屈服面上，且塑性加载正在持续。施加的总应变率为\n$$\n\\dot{\\boldsymbol{\\varepsilon}} = \n\\begin{pmatrix}\n\\dot{\\varepsilon} & 0 & 0\\\\\n0 & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix},\n\\quad \\text{其中 } \\dot{\\varepsilon} = 1.0\\times 10^{-4}\\ \\text{s}^{-1}.\n$$\n\n仅使用上述定义、各向同性线性弹性中的弹性定律 $\\dot{\\boldsymbol{\\sigma}} = \\mathbb{C}:\\big(\\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\boldsymbol{\\varepsilon}}^{p}\\big)$、正交法则以及塑性加载过程中的一致性条件 $\\dot{f}=0$，构建流动方向并计算该时刻的塑性乘子率 $\\dot{\\lambda}$。\n\n将您的最终答案 $\\dot{\\lambda}$ 以 $\\text{s}^{-1}$ 为单位表示，并四舍五入到四位有效数字。", "solution": "该问题是适定的，并且在连续介质塑性力学理论中有充分的科学依据。所有必要的数据和本构关系都已给出，并与现有模型一致。我将开始求解。\n\n目标是利用一致性条件求出塑性乘子率 $\\dot{\\lambda}$。一致性条件指出，在塑性加载期间，应力状态必须保持在屈服面上。在数学上，这表示为屈服函数的时间导数为零：\n$$\n\\dot{f}(\\boldsymbol{\\sigma}, \\alpha) = 0\n$$\n使用链式法则，我们可以将此条件展开为：\n$$\n\\dot{f} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} : \\dot{\\boldsymbol{\\sigma}} + \\frac{\\partial f}{\\partial \\alpha} \\dot{\\alpha} = 0\n$$\n\n让我们分析该方程中的每一项。\n\n首先，项 $\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$ 表示应力空间中屈服面的法向量。我们用张量 $\\boldsymbol{N}$ 来表示它。根据给定的屈服函数 $f(\\boldsymbol{\\sigma},\\alpha) = \\sqrt{\\frac{3}{2}}\\,\\|\\boldsymbol{s}\\| - \\big(\\sigma_{y0} + H\\,\\alpha\\big) = \\sqrt{\\frac{3}{2}} (\\boldsymbol{s}:\\boldsymbol{s})^{1/2} - \\big(\\sigma_{y0} + H\\,\\alpha\\big)$，我们计算其关于 $\\boldsymbol{\\sigma}$ 的导数：\n$$\n\\boldsymbol{N} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\sqrt{\\frac{3}{2}} \\frac{\\partial}{\\partial \\boldsymbol{\\sigma}} (\\boldsymbol{s}:\\boldsymbol{s})^{1/2}\n$$\n已知 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}\\text{tr}(\\boldsymbol{\\sigma})\\boldsymbol{I}$，其关于 $\\boldsymbol{\\sigma}$ 的导数是四阶偏量投影张量。$\\boldsymbol{s}:\\boldsymbol{s}$ 关于 $\\boldsymbol{\\sigma}$ 的导数是 $2\\boldsymbol{s}$。因此：\n$$\n\\boldsymbol{N} = \\sqrt{\\frac{3}{2}} \\frac{1}{2\\|\\boldsymbol{s}\\|} (2\\boldsymbol{s}) = \\sqrt{\\frac{3}{2}} \\frac{\\boldsymbol{s}}{\\|\\boldsymbol{s}\\|}\n$$\n问题指出该金属处于均质单轴拉伸状态。应力张量的形式为：\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_{11} & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n迹为 $\\text{tr}(\\boldsymbol{\\sigma}) = \\sigma_{11}$。偏应力 $\\boldsymbol{s}$ 为：\n$$\n\\boldsymbol{s} = \\begin{pmatrix} \\sigma_{11} & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} - \\frac{1}{3}\\sigma_{11} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\sigma_{11} \\begin{pmatrix} 2/3 & 0 & 0 \\\\ 0 & -1/3 & 0 \\\\ 0 & 0 & -1/3 \\end{pmatrix}\n$$\n偏应力的 Frobenius 范数为 $\\|\\boldsymbol{s}\\| = \\sqrt{s_{ij}s_{ij}} = \\sqrt{(\\frac{2}{3}\\sigma_{11})^2 + (-\\frac{1}{3}\\sigma_{11})^2 + (-\\frac{1}{3}\\sigma_{11})^2} = \\sqrt{\\frac{6}{9}\\sigma_{11}^2} = \\sqrt{\\frac{2}{3}}\\sigma_{11}$ (假设为拉伸，$\\sigma_{11} > 0$)。\n将此代入 $\\boldsymbol{N}$ 的表达式中，我们得到流动方向：\n$$\n\\boldsymbol{N} = \\sqrt{\\frac{3}{2}} \\frac{\\sigma_{11} \\begin{pmatrix} 2/3 & 0 & 0 \\\\ 0 & -1/3 & 0 \\\\ 0 & 0 & -1/3 \\end{pmatrix}}{\\sqrt{2/3}\\sigma_{11}} = \\frac{3}{2} \\begin{pmatrix} 2/3 & 0 & 0 \\\\ 0 & -1/3 & 0 \\\\ 0 & 0 & -1/3 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & -1/2 & 0 \\\\ 0 & 0 & -1/2 \\end{pmatrix}\n$$\n这个张量 $\\boldsymbol{N}$ 就是问题所要求的流动方向。注意它是偏量的，$\\text{tr}(\\boldsymbol{N}) = 1 - 1/2 - 1/2 = 0$。\n\n第二，我们计算项 $\\frac{\\partial f}{\\partial \\alpha}$。从屈服函数可知，它就是：\n$$\n\\frac{\\partial f}{\\partial \\alpha} = -H\n$$\n\n第三，我们将硬化变量的变化率 $\\dot{\\alpha}$ 与塑性乘子 $\\dot{\\lambda}$ 联系起来。关联流动法则为 $\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\lambda} \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\dot{\\lambda}\\boldsymbol{N}$。使用给定的硬化法则：\n$$\n\\dot{\\alpha} = \\sqrt{\\frac{2}{3}} \\|\\dot{\\boldsymbol{\\varepsilon}}^{p}\\| = \\sqrt{\\frac{2}{3}} \\|\\dot{\\lambda}\\boldsymbol{N}\\|\n$$\n由于正在发生塑性加载，$\\dot{\\lambda} > 0$。$\\boldsymbol{N}$ 的范数为 $\\|\\boldsymbol{N}\\| = \\sqrt{1^2 + (-\\frac{1}{2})^2 + (-\\frac{1}{2})^2} = \\sqrt{1 + \\frac{1}{4} + \\frac{1}{4}} = \\sqrt{\\frac{3}{2}}$。\n因此，\n$$\n\\dot{\\alpha} = \\dot{\\lambda} \\sqrt{\\frac{2}{3}} \\sqrt{\\frac{3}{2}} = \\dot{\\lambda}\n$$\n\n最后，应力率 $\\dot{\\boldsymbol{\\sigma}}$ 由弹性定律给出，该定律将其与总应变率 $\\dot{\\boldsymbol{\\varepsilon}}$ 和塑性应变率 $\\dot{\\boldsymbol{\\varepsilon}}^{p}$ 联系起来：\n$$\n\\dot{\\boldsymbol{\\sigma}} = \\mathbb{C} : (\\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\boldsymbol{\\varepsilon}}^{p}) = \\mathbb{C} : (\\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\lambda}\\boldsymbol{N})\n$$\n其中 $\\mathbb{C}$ 是四阶各向同性弹性刚度张量。\n\n将所有这些分量代回一致性条件：\n$$\n\\boldsymbol{N} : [\\mathbb{C} : (\\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\lambda}\\boldsymbol{N})] - H \\dot{\\lambda} = 0\n$$\n展开此方程可得：\n$$\n\\boldsymbol{N} : \\mathbb{C} : \\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\lambda} (\\boldsymbol{N} : \\mathbb{C} : \\boldsymbol{N}) - H \\dot{\\lambda} = 0\n$$\n我们可以解出 $\\dot{\\lambda}$：\n$$\n\\dot{\\lambda} = \\frac{\\boldsymbol{N} : \\mathbb{C} : \\dot{\\boldsymbol{\\varepsilon}}}{\\boldsymbol{N} : \\mathbb{C} : \\boldsymbol{N} + H}\n$$\n对于各向同性弹性材料，刚度张量作用于一个对称二阶张量 $\\boldsymbol{A}$ 的结果为 $\\mathbb{C}:\\boldsymbol{A} = 2G\\,\\boldsymbol{A}_{dev} + K\\,\\text{tr}(\\boldsymbol{A})\\,\\boldsymbol{I}$，其中 $G$ 是剪切模量，$K$ 是体积模量，$\\boldsymbol{A}_{dev}$ 是 $\\boldsymbol{A}$ 的偏量部分，$\\boldsymbol{I}$ 是二阶单位张量。\n分子变为：$\\boldsymbol{N} : \\mathbb{C} : \\dot{\\boldsymbol{\\varepsilon}} = \\boldsymbol{N} : (2G\\,\\dot{\\boldsymbol{e}} + K\\,\\text{tr}(\\dot{\\boldsymbol{\\varepsilon}})\\,\\boldsymbol{I})$，其中 $\\dot{\\boldsymbol{e}}$ 是 $\\dot{\\boldsymbol{\\varepsilon}}$ 的偏量部分。由于 $\\boldsymbol{N}$ 是偏量的，$\\text{tr}(\\boldsymbol{N})=0$，所以 $\\boldsymbol{N}:\\boldsymbol{I}=0$。此外，$\\boldsymbol{N}:\\dot{\\boldsymbol{e}} = \\boldsymbol{N}:\\dot{\\boldsymbol{\\varepsilon}}$。因此，分子简化为 $2G\\,(\\boldsymbol{N} : \\dot{\\boldsymbol{\\varepsilon}})$。\n分母项 $\\boldsymbol{N} : \\mathbb{C} : \\boldsymbol{N}$ 变为：$\\boldsymbol{N} : \\mathbb{C} : \\boldsymbol{N} = \\boldsymbol{N} : (2G\\,\\boldsymbol{N}_{dev} + K\\,\\text{tr}(\\boldsymbol{N})\\,\\boldsymbol{I})$。因为 $\\boldsymbol{N}$ 是偏量的，所以 $\\boldsymbol{N}_{dev}=\\boldsymbol{N}$ 且 $\\text{tr}(\\boldsymbol{N}) = 0$。该项简化为 $2G\\,(\\boldsymbol{N} : \\boldsymbol{N}) = 2G\\,\\|\\boldsymbol{N}\\|^2$。由于 $\\|\\boldsymbol{N}\\|^2 = \\frac{3}{2}$，此项为 $2G(\\frac{3}{2}) = 3G$。\n因此，塑性乘子的表达式为：\n$$\n\\dot{\\lambda} = \\frac{2G\\,(\\boldsymbol{N} : \\dot{\\boldsymbol{\\varepsilon}})}{3G + H}\n$$\n现在我们计算数值。给定的弹性模量为杨氏模量 $E = 210$ GPa 和泊松比 $\\nu = 0.30$。剪切模量 $G$ 为：\n$$\nG = \\frac{E}{2(1+\\nu)} = \\frac{210\\,\\text{GPa}}{2(1+0.30)} = \\frac{210}{2.6}\\,\\text{GPa}\n$$\n施加的总应变率为 $\\dot{\\boldsymbol{\\varepsilon}} = \\begin{pmatrix} \\dot{\\varepsilon} & 0 & 0\\\\ 0 & 0 & 0\\\\ 0 & 0 & 0 \\end{pmatrix}$，其中 $\\dot{\\varepsilon} = 1.0\\times 10^{-4}\\ \\text{s}^{-1}$。\n标量积 $\\boldsymbol{N} : \\dot{\\boldsymbol{\\varepsilon}}$ 为：\n$$\n\\boldsymbol{N} : \\dot{\\boldsymbol{\\varepsilon}} = (1)(\\dot{\\varepsilon}) + (-\\frac{1}{2})(0) + (-\\frac{1}{2})(0) = \\dot{\\varepsilon}\n$$\n将此代入 $\\dot{\\lambda}$ 的表达式：\n$$\n\\dot{\\lambda} = \\frac{2G\\dot{\\varepsilon}}{3G + H}\n$$\n硬化模量为 $H = 1.5$ GPa。代入所有数值：\n$$\n\\dot{\\lambda} = \\frac{2 \\left(\\frac{210}{2.6}\\right) (1.0 \\times 10^{-4})}{3 \\left(\\frac{210}{2.6}\\right) + 1.5}\n$$\n$$\n\\dot{\\lambda} = \\frac{\\frac{420}{2.6} \\times 10^{-4}}{\\frac{630}{2.6} + 1.5} = \\frac{161.538... \\times 10^{-4}}{242.307... + 1.5} = \\frac{161.538... \\times 10^{-4}}{243.807...} \\ \\text{s}^{-1}\n$$\n$$\n\\dot{\\lambda} \\approx 0.66257 \\times 10^{-4}\\ \\text{s}^{-1} = 6.6257 \\times 10^{-5}\\ \\text{s}^{-1}\n$$\n四舍五入到四位有效数字，最终结果为 $6.626 \\times 10^{-5}\\ \\text{s}^{-1}$。", "answer": "$$\n\\boxed{6.626 \\times 10^{-5}}\n$$", "id": "2905738"}, {"introduction": "为了在工程模拟（如有限元分析）中应用塑性理论，连续的本构方程必须被离散化并通过数值方法求解。“返回映射算法”（Return Mapping Algorithm）是现代计算塑性力学的核心。本练习是一个综合性的编程实践，要求你将理论知识转化为一个具体的计算机程序，为更普适的压力相关材料模型（Drucker-Prager 模型）实现一个返回映射算法 [@problem_id:2905729]。这项实践不仅能巩固你对屈服、流动和一致性条件的理解，还将让你接触到非关联流动等高级概念，这些概念对于模拟土壤、岩石和聚合物等材料至关重要。", "problem": "实现一个用于各向同性弹塑性的单增量小应变算法，该算法使用 Drucker–Prager (DP) 压力相关屈服条件和可能的非关联流动法则，并用它来为一组给定的测试用例计算塑性乘子、塑性耗散和一个弹性/塑性标志。该公式体系必须基于小应变运动学、线性各向同性弹性、凸屈服函数、关联流动的正交性条件、为了一般性而采用的非关联流动法则以及一致性条件等基本原理进行构建。\n\n您将获得以下基本要素：\n\n- 小应变运动学，其应变增量可加法分解为 $d\\boldsymbol{\\varepsilon} = d\\boldsymbol{\\varepsilon}^{e} + d\\boldsymbol{\\varepsilon}^{p}$，其中 $d\\boldsymbol{\\varepsilon}$ 是总无限小应变增量，$d\\boldsymbol{\\varepsilon}^{e}$ 是弹性应变增量，$d\\boldsymbol{\\varepsilon}^{p}$ 是塑性应变增量。应变张量是对称的，并使用张量剪切分量。\n\n- 线性各向同性弹性，其四阶弹性张量 $\\mathbb{C}$ 由体积模量 $K$ 和剪切模量 $G$ 定义，使得 $d\\boldsymbol{\\sigma} = \\mathbb{C} : (d\\boldsymbol{\\varepsilon} - d\\boldsymbol{\\varepsilon}^{p})$，其中 $\\boldsymbol{\\sigma}$ 是 Cauchy 应力张量。使用 $K = \\dfrac{E}{3(1-2\\nu)}$ 和 $G = \\dfrac{E}{2(1+\\nu)}$，其中 $E$ 是杨氏模量，$\\nu$ 是泊松比。\n\n- Drucker–Prager (DP) 屈服函数 $F(\\boldsymbol{\\sigma}) \\le 0$ 满足\n$$\nF(\\boldsymbol{\\sigma}) = q + \\alpha\\, p - k,\n$$\n其中 $p = -\\dfrac{1}{3}\\,\\mathrm{tr}(\\boldsymbol{\\sigma})$ 是平均（压为正）应力，$\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\dfrac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})\\boldsymbol{I}$ 是偏应力，$q = \\sqrt{\\dfrac{3}{2}}\\,\\|\\boldsymbol{s}\\|$ 是 von Mises 等效应力，$\\alpha \\ge 0$ 是一个控制压力敏感性的材料参数，$k > 0$ 是一个类内聚力参数，$\\boldsymbol{I}$ 是二阶单位张量。\n\n- 非关联塑性流动法则 $d\\boldsymbol{\\varepsilon}^{p} = d\\lambda\\,\\dfrac{\\partial G}{\\partial \\boldsymbol{\\sigma}}$，其塑性势为\n$$\nG(\\boldsymbol{\\sigma}) = q + \\alpha_{\\psi}\\, p,\n$$\n其中 $\\alpha_{\\psi} \\ge 0$ 是剪胀参数。关联流动是 $\\alpha_{\\psi} = \\alpha$ 的特例。标量 $d\\lambda \\ge 0$ 是塑性乘子。\n\n- 一致性条件（Kuhn–Tucker 条件）：$F \\le 0$，$d\\lambda \\ge 0$ 以及 $d\\lambda\\,F = 0$。\n\n- 本问题为理想塑性，意味着 $k$ 在增量步内为常数（无硬化或软化）。\n\n在一个从无应力和无塑性应变状态开始的单一时间增量内，您需要：\n1) 计算弹性试探应力 $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathbb{C} : d\\boldsymbol{\\varepsilon}$。\n2) 计算试探屈服函数 $F^{\\mathrm{tr}} = F(\\boldsymbol{\\sigma}^{\\mathrm{tr}})$。\n3) 如果 $F^{\\mathrm{tr}} \\le 0$，则响应是弹性的：设置 $d\\lambda = 0$，$d\\boldsymbol{\\varepsilon}^{p} = \\boldsymbol{0}$，更新后的应力为 $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\mathrm{tr}}$，塑性耗散为 $D = 0$。\n4) 如果 $F^{\\mathrm{tr}} > 0$，则强制执行一致性条件以计算塑性乘子 $d\\lambda > 0$，并使用非关联流动法则返回到屈服面，更新 $\\boldsymbol{\\sigma}$ 和 $d\\boldsymbol{\\varepsilon}^{p}$。然后计算该增量步的塑性耗散\n$$\nD = \\boldsymbol{\\sigma} : d\\boldsymbol{\\varepsilon}^{p}.\n$$\n\n本问题中的所有结果都必须以一致的国际单位制（SI）表示。具体而言：\n- 使用 $E$ 和 $k$ 的单位为 $\\mathrm{Pa}$，$d\\boldsymbol{\\varepsilon}$ 是无量纲的，塑性耗散 $D$ 以 $\\mathrm{Pa}$ 报告。塑性乘子 $d\\lambda$ 是无量纲的。不使用角度单位，因为 $\\alpha$ 和 $\\alpha_{\\psi}$ 作为无量纲的压力敏感性参数和剪胀参数直接给出。\n\n您的程序必须实现上述算法并将其应用于以下测试用例集。每个测试用例提供 $(E,\\nu,\\alpha,\\alpha_{\\psi},k,d\\boldsymbol{\\varepsilon})$，其中 $d\\boldsymbol{\\varepsilon}$ 以 $[d\\varepsilon_{11}, d\\varepsilon_{22}, d\\varepsilon_{33}, d\\varepsilon_{12}, d\\varepsilon_{23}, d\\varepsilon_{31}]$ 的顺序指定，使用张量剪切分量。所有测试用例的初始状态均为 $\\boldsymbol{\\sigma}=\\boldsymbol{0}$ 和 $\\boldsymbol{\\varepsilon}^{p}=\\boldsymbol{0}$。\n\n测试用例集：\n- A用例（顺利路径，弹性）：$E = 210\\times 10^{9}\\ \\mathrm{Pa}$，$\\nu = 0.3$，$\\alpha = 0.1$，$\\alpha_{\\psi} = 0.05$，$k = 400\\times 10^{6}\\ \\mathrm{Pa}$，$d\\boldsymbol{\\varepsilon} = [1\\times 10^{-6}, 0, 0, 0, 0, 0]$。\n- B用例（塑性，非关联，类单轴加载下的偏应力与体积应力组合）：$E = 210\\times 10^{9}\\ \\mathrm{Pa}$，$\\nu = 0.3$，$\\alpha = 0.1$，$\\alpha_{\\psi} = 0.05$，$k = 400\\times 10^{6}\\ \\mathrm{Pa}$，$d\\boldsymbol{\\varepsilon} = [4\\times 10^{-3}, 0, 0, 0, 0, 0]$。\n- C用例（塑性，非关联，纯剪切试探加载）：$E = 210\\times 10^{9}\\ \\mathrm{Pa}$，$\\nu = 0.3$，$\\alpha = 0.1$，$\\alpha_{\\psi} = 0.05$，$k = 400\\times 10^{6}\\ \\mathrm{Pa}$，$d\\boldsymbol{\\varepsilon} = [0, 0, 0, 5\\times 10^{-3}, 0, 0]$。\n- D用例（塑性，非关联，静水压缩试探加载）：$E = 210\\times 10^{9}\\ \\mathrm{Pa}$，$\\nu = 0.3$，$\\alpha = 0.1$，$\\alpha_{\\psi} = 0.05$，$k = 400\\times 10^{6}\\ \\mathrm{Pa}$，$d\\boldsymbol{\\varepsilon} = [-2\\times 10^{-2}, -2\\times 10^{-2}, -2\\times 10^{-2}, 0, 0, 0]$。\n- E用例（塑性，关联流动极限情况检查）：$E = 210\\times 10^{9}\\ \\mathrm{Pa}$，$\\nu = 0.3$，$\\alpha = 0.1$，$\\alpha_{\\psi} = 0.1$，$k = 400\\times 10^{6}\\ \\mathrm{Pa}$，$d\\boldsymbol{\\varepsilon} = [1\\times 10^{-3}, -2\\times 10^{-4}, -2\\times 10^{-4}, 3\\times 10^{-3}, 0, 0]$。\n\n您的程序应为每个用例计算：\n- 布尔标志 $\\text{is\\_elastic}$，指示是否 $F^{\\mathrm{tr}} \\le 0$。\n- 塑性乘子增量 $d\\lambda$（无量纲）。\n- 塑性耗散 $D$，单位为 $\\mathrm{Pa}$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含五个测试用例的结果，形式为一个用逗号分隔并包含在方括号中的列表，其中每个元素本身是形式为 $[\\text{is\\_elastic}, d\\lambda, D]$ 的列表。例如，输出必须类似于\n$[[\\text{bool}, \\text{float}, \\text{float}], [\\text{bool}, \\text{float}, \\text{float}], [\\dots], [\\dots], [\\dots]]$\n不得包含任何附加文本。所有浮点数结果必须以编程语言默认的标准十进制形式打印，并且 $D$ 的单位必须是 $\\mathrm{Pa}$。", "solution": "所给出的问题是计算塑性力学中的一个标准练习。它有科学依据、是适定的、客观且完整的。所有必需的物理定律、材料参数和初始条件都已提供。该公式体系——基于小应变运动学、各向同性弹性、Drucker-Prager 屈服准则和非关联流动法则——是现代固体力学的基石之一。因此，该问题是有效的，并允许进行严格求解。我们将继续推导单增量返回映射算法。\n\n问题的核心是，从一个无应力状态开始，对于给定的总应变增量 $d\\boldsymbol{\\varepsilon}$，确定应力状态 $\\boldsymbol{\\sigma}$ 和内部塑性变量。该算法包括两个主要阶段：一个弹性预测步和一个塑性修正步。\n\n首先，我们根据给定的杨氏模量 $E$ 和泊松比 $\\nu$ 定义材料弹性常数，即体积模量 $K$ 和剪切模量 $G$：\n$$ K = \\frac{E}{3(1-2\\nu)} $$\n$$ G = \\frac{E}{2(1+\\nu)} $$\n线性弹性中的应力-应变关系可以分解为体积部分和偏量部分。平均应力 $p = - \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})$ 与体积应变 $\\varepsilon_v = \\mathrm{tr}(\\boldsymbol{\\varepsilon})$ 的关系为 $dp = -K\\,d\\varepsilon_v$。偏应力 $\\boldsymbol{s}$ 与偏应变 $\\boldsymbol{e} = \\boldsymbol{\\varepsilon} - \\frac{1}{3}\\varepsilon_v\\boldsymbol{I}$ 的关系为 $d\\boldsymbol{s} = 2G\\,d\\boldsymbol{e}$。\n\n计算增量步按以下方式进行：\n\n1.  弹性预测步：\n    我们首先假设整个应变增量 $d\\boldsymbol{\\varepsilon}$ 都是弹性的。这给出了一个试探应力状态，用上标 'tr' 表示。由于初始状态是无应力的，试探应力直接由应变增量计算得出：\n    $$ \\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathbb{C} : d\\boldsymbol{\\varepsilon} $$\n    用不变量表示，试探平均应力 $p^{\\mathrm{tr}}$ 和试探偏应力 $\\boldsymbol{s}^{\\mathrm{tr}}$ 分别为：\n    $$ p^{\\mathrm{tr}} = -K\\,\\mathrm{tr}(d\\boldsymbol{\\varepsilon}) $$\n    $$ \\boldsymbol{s}^{\\mathrm{tr}} = 2G\\,\\left(d\\boldsymbol{\\varepsilon} - \\frac{1}{3}\\mathrm{tr}(d\\boldsymbol{\\varepsilon})\\boldsymbol{I}\\right) $$\n    由此，我们计算试探 von Mises 等效应力 $q^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2}\\boldsymbol{s}^{\\mathrm{tr}}:\\boldsymbol{s}^{\\mathrm{tr}}}$。\n\n2.  屈服条件检查：\n    我们在试探应力状态下评估 Drucker-Prager 屈服函数 $F$：\n    $$ F^{\\mathrm{tr}} = F(\\boldsymbol{\\sigma}^{\\mathrm{tr}}) = q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k $$\n    如果 $F^{\\mathrm{tr}} \\le 0$，则试探应力位于屈服面内部或其上。假设正确，该步骤是纯弹性的。最终应力为 $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\mathrm{tr}}$，塑性乘子增量为 $d\\lambda = 0$，塑性耗散为 $D = 0$。\n\n3.  塑性修正步：\n    如果 $F^{\\mathrm{tr}} > 0$，则试探状态位于屈服面之外，这在物理上是不允许的。必须发生塑性变形。最终应力状态 $\\boldsymbol{\\sigma}$ 必须位于屈服面上，满足一致性条件 $F(\\boldsymbol{\\sigma}) = 0$。应力通过从试探状态中减去由塑性应变 $d\\boldsymbol{\\varepsilon}^p$ 引起的应力松弛来更新：\n    $$ \\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\mathbb{C} : d\\boldsymbol{\\varepsilon}^{p} $$\n    塑性应变增量由非关联流动法则给出：\n    $$ d\\boldsymbol{\\varepsilon}^{p} = d\\lambda \\frac{\\partial G}{\\partial \\boldsymbol{\\sigma}} $$\n    其中 $d\\lambda > 0$ 是塑性乘子，$G(\\boldsymbol{\\sigma})=q + \\alpha_{\\psi}p$ 是塑性势函数。势函数的梯度，代表塑性流动的方向，为：\n    $$ \\frac{\\partial G}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} + \\alpha_{\\psi} \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2}\\frac{\\boldsymbol{s}}{q} - \\frac{\\alpha_{\\psi}}{3}\\boldsymbol{I} $$\n    对于 $J_2$ 型塑性模型（如 von Mises 和 Drucker-Prager 模型），一个关键结果是偏应力方向在塑性返回过程中保持不变；也就是说，$\\boldsymbol{s}$ 的方向与 $\\boldsymbol{s}^{\\mathrm{tr}}$ 的方向相同。这简化了返回映射方程。\n    通过将流动法则代入应力更新公式，并分离为体积和偏量部分，我们得到不变量 $p$ 和 $q$ 的更新方程：\n    $$ p = p^{\\mathrm{tr}} - K \\alpha_{\\psi} d\\lambda $$\n    $$ q = q^{\\mathrm{tr}} - 3G d\\lambda $$\n    这个关于 $q$ 的表达式在 $q^{\\mathrm{tr}} > 0$ 时有效。如果 $q^{\\mathrm{tr}}=0$（静水试探状态），则更新后的偏应力也必须为零，因此 $q=0$。\n\n    为了找到未知的塑性乘子 $d\\lambda$，我们强制执行一致性条件 $F(\\boldsymbol{\\sigma}) = 0$：\n    $$ q + \\alpha p - k = 0 $$\n    代入 $p$ 和 $q$ 的更新方程，得到一个关于 $d\\lambda$ 的方程。我们必须区分两种情况：\n    -   情况 $q^{\\mathrm{tr}} > 0$（非顶点返回）：\n        $$ (q^{\\mathrm{tr}} - 3G d\\lambda) + \\alpha (p^{\\mathrm{tr}} - K \\alpha_{\\psi} d\\lambda) - k = 0 $$\n        注意到 $F^{\\mathrm{tr}} = q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k$，我们求解 $d\\lambda$：\n        $$ d\\lambda = \\frac{F^{\\mathrm{tr}}}{3G + \\alpha K \\alpha_{\\psi}} $$\n    -   情况 $q^{\\mathrm{tr}} = 0$（顶点返回）：\n        此时，$q=0$。一致性条件变为 $\\alpha p - k = 0$。\n        $$ \\alpha (p^{\\mathrm{tr}} - K \\alpha_{\\psi} d\\lambda) - k = 0 $$\n        注意到 $F^{\\mathrm{tr}} = \\alpha p^{\\mathrm{tr}} - k$，我们求解 $d\\lambda$：\n        $$ d\\lambda = \\frac{F^{\\mathrm{tr}}}{\\alpha K \\alpha_{\\psi}} $$\n        这种情况仅在 $\\alpha > 0$ 和 $\\alpha_{\\psi} > 0$ 时才具有物理意义。\n\n4.  塑性耗散计算：\n    一旦求得 $d\\lambda$，就可以计算最终状态的不变量 $p$ 和 $q$。增量步中单位体积的塑性耗散定义为 $D = \\boldsymbol{\\sigma} : d\\boldsymbol{\\varepsilon}^{p}$。代入 $\\boldsymbol{\\sigma}$ 和 $d\\boldsymbol{\\varepsilon}^{p}$ 的表达式并简化，得到一个通用公式：\n    $$ D = d\\lambda (q + \\alpha_{\\psi} p) $$\n    其中 $p$ 和 $q$ 是最终更新后的值。耗散必须为非负，如果流动势 $G$ 是凸的并且应力状态位于区域 $G \\ge 0$ 的内部或边界上，这一点可以得到保证。\n\n该算法至此已完全定义。我们将为每个给定的测试用例实现此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a single-increment small-strain algorithm for Drucker-Prager elastoplasticity\n    and applies it to a predefined test suite.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (E, nu, alpha, alpha_psi, k, deps_vec)\n    test_cases = [\n        # Case A: Elastic\n        (210e9, 0.3, 0.1, 0.05, 400e6, [1e-6, 0.0, 0.0, 0.0, 0.0, 0.0]),\n        # Case B: Plastic, non-associated, uniaxial-like loading\n        (210e9, 0.3, 0.1, 0.05, 400e6, [4e-3, 0.0, 0.0, 0.0, 0.0, 0.0]),\n        # Case C: Plastic, non-associated, pure shear loading\n        (210e9, 0.3, 0.1, 0.05, 400e6, [0.0, 0.0, 0.0, 5e-3, 0.0, 0.0]),\n        # Case D: Plastic, non-associated, hydrostatic loading (apex return)\n        (210e9, 0.3, 0.1, 0.05, 400e6, [-2e-2, -2e-2, -2e-2, 0.0, 0.0, 0.0]),\n        # Case E: Plastic, associated flow\n        (210e9, 0.3, 0.1, 0.1, 400e6, [1e-3, -2e-4, -2e-4, 3e-3, 0.0, 0.0])\n    ]\n\n    results = []\n    for case in test_cases:\n        E, nu, alpha, alpha_psi, k, deps_vec = case\n        \n        # 1. Compute elastic constants\n        G = E / (2 * (1 + nu))\n        K = E / (3 * (1 - 2 * nu))\n\n        # 2. Construct strain tensor from Voigt-like vector (with tensorial shear)\n        deps_mat = np.array([\n            [deps_vec[0], deps_vec[3], deps_vec[5]],\n            [deps_vec[3], deps_vec[1], deps_vec[4]],\n            [deps_vec[5], deps_vec[4], deps_vec[2]]\n        ])\n\n        # 3. Elastic predictor step\n        deps_vol = np.trace(deps_mat)\n        deps_dev = deps_mat - (deps_vol / 3.0) * np.identity(3)\n\n        p_tr = -K * deps_vol\n        s_tr = 2 * G * deps_dev\n\n        s_tr_dot_s_tr = np.sum(s_tr * s_tr)\n        q_tr = np.sqrt(3.0 / 2.0 * s_tr_dot_s_tr)\n        \n        # Use a small relative tolerance to check for the apex condition\n        q_tr_is_zero = (q_tr  1e-12 * k) \n        \n        F_tr = q_tr + alpha * p_tr - k\n\n        # 4. Yield check and corrector step\n        if F_tr = 0:\n            is_elastic = True\n            d_lambda = 0.0\n            D = 0.0\n        else:\n            is_elastic = False\n            \n            if q_tr_is_zero:\n                # Apex return: d_lambda = F_tr / (alpha * K * alpha_psi)\n                denom = alpha * K * alpha_psi\n                if abs(denom)  1e-12: # Physically, yielding should not occur here if denom is zero\n                    d_lambda = 0.0 \n                    is_elastic = True\n                else:\n                    d_lambda = F_tr / denom\n            else:\n                # Non-apex return: d_lambda = F_tr / (3*G + alpha * K * alpha_psi)\n                denom = 3 * G + alpha * K * alpha_psi\n                d_lambda = F_tr / denom\n\n            if is_elastic:\n                D = 0.0\n            else:\n                # Update invariants and compute plastic dissipation\n                p_final = p_tr - K * alpha_psi * d_lambda\n                \n                if q_tr_is_zero:\n                    q_final = 0.0\n                else:\n                    q_final = q_tr - 3 * G * d_lambda\n                \n                # Ensure q_final is non-negative due to potential floating point inaccuracies\n                q_final = max(0.0, q_final)\n                \n                D = d_lambda * (q_final + alpha_psi * p_final)\n                # Ensure dissipation is non-negative\n                D = max(0.0, D)\n\n        result = [is_elastic, d_lambda, D]\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The str() representation of a Python list is acceptable here.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2905729"}]}