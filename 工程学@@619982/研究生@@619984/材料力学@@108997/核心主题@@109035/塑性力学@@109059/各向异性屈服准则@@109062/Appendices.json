{"hands_on_practices": [{"introduction": "在使用任何本构模型进行工程分析之前，一个至关重要的步骤是根据实验数据确定其材料参数。这个练习提供了将希尔1948（Hill 1948）模型中抽象的各向异性系数 $F, G, H, N$ 与可测量的屈服应力直接联系起来的实践机会。通过这个计算过程，您将掌握如何为特定材料标定模型，从而将理论与实际材料行为紧密结合起来。[@problem_id:2866890]", "problem": "一块轧制板材在平面应力下表现出正交各向异性屈服。设材料轴分别与轧制方向、横向和厚度方向对齐，记为轴$1$、$2$和$3$。在室温下测得的初始屈服应力如下：沿轧制方向$0^{\\circ}$的单轴拉伸屈服应力为 $\\sigma_{Y}^{0} = 180\\,\\text{MPa}$，与轧制方向成$45^{\\circ}$角的单轴拉伸屈服应力为 $\\sigma_{Y}^{45} = 190\\,\\text{MPa}$，沿横向$90^{\\circ}$的单轴拉伸屈服应力为 $\\sigma_{Y}^{90} = 200\\,\\text{MPa}$，面内纯剪切屈服应力为 $\\tau_{Y} = 100\\,\\text{MPa}$（角度单位为度）。\n\n从Hill 1948年二次正交各向异性屈服函数在平面应力下的定义出发，该函数是应力分量的一个齐次二次型，且与材料的正交各向异性及凸性相符，并且在给定加载状态下测得的屈服点必须位于屈服面上，推导出一个将各向异性系数$(F,G,H,N)$与$(\\sigma_{Y}^{0},\\sigma_{Y}^{45},\\sigma_{Y}^{90},\\tau_{Y})$联系起来的方程组。求解此方程组，计算该板材的$(F,G,H,N)$的数值，并验证凸性条件$F0$、$G0$、$H0$、$N0$。\n\n将$F$、$G$、$H$和$N$以$\\text{MPa}^{-2}$为单位表示，并各自保留六位有效数字。最终答案必须以包含$(F,G,H,N)$的单行向量形式报告，向量内不含单位。", "solution": "其基本原理是，金属的屈服可以通过一个凸屈服函数来表征，对于二次准则，该函数是应力的二次齐次函数。对于平面应力下的正交各向异性板材，Hill的1948年屈服准则假设了一个尊重材料正交各向异性对称性的应力二次型。将材料轴中的柯西应力记为$(\\sigma_{1},\\sigma_{2},\\sigma_{3},\\tau_{23},\\tau_{31},\\tau_{12})$，并限定于平面应力情况$(\\sigma_{3}=\\tau_{23}=\\tau_{31}=0)$，该二次型可简化为\n$$\n\\Phi(\\sigma_{1},\\sigma_{2},\\tau_{12}) \\equiv F(\\sigma_{2}-\\sigma_{3})^{2} + G(\\sigma_{3}-\\sigma_{1})^{2} + H(\\sigma_{1}-\\sigma_{2})^{2} + 2N\\tau_{12}^{2}\n= F\\sigma_{2}^{2} + G\\sigma_{1}^{2} + H(\\sigma_{1}-\\sigma_{2})^{2} + 2N\\tau_{12}^{2}.\n$$\n经过隐式归一化后，当$\\Phi=1$时发生屈服；等效地，初次屈服时测得的应力状态必须满足$\\Phi=1$。我们确定四种校准状态：\n\n1. 沿轴$1$（轧制方向$0^{\\circ}$）的单轴拉伸：$\\sigma_{1}=\\sigma_{Y}^{0}$，$\\sigma_{2}=0$，$\\tau_{12}=0$。代入可得\n$$\n\\Phi = G(\\sigma_{Y}^{0})^{2} + H(\\sigma_{Y}^{0})^{2} = (G+H)(\\sigma_{Y}^{0})^{2} = 1,\n$$\n因此\n$$\nG+H = \\frac{1}{(\\sigma_{Y}^{0})^{2}}.\n$$\n\n2. 沿轴$2$（横向$90^{\\circ}$）的单轴拉伸：$\\sigma_{2}=\\sigma_{Y}^{90}$，$\\sigma_{1}=0$，$\\tau_{12}=0$。代入可得\n$$\n\\Phi = F(\\sigma_{Y}^{90})^{2} + H(\\sigma_{Y}^{90})^{2} = (F+H)(\\sigma_{Y}^{90})^{2} = 1,\n$$\n因此\n$$\nF+H = \\frac{1}{(\\sigma_{Y}^{90})^{2}}.\n$$\n\n3. 与轴$1$成$45^{\\circ}$角的单轴拉伸：对于沿相对于轴$1$旋转$\\theta$角的轴施加的单轴应力$\\sigma$，材料轴中的面内分量为$\\sigma_{1}=\\sigma\\cos^{2}\\theta$、$\\sigma_{2}=\\sigma\\sin^{2}\\theta$和$\\tau_{12}=\\sigma\\sin\\theta\\cos\\theta$。当$\\theta=45^{\\circ}$时，有$\\sigma_{1}=\\sigma_{2}=\\sigma/2$和$\\tau_{12}=\\sigma/2$。设$\\sigma=\\sigma_{Y}^{45}$并代入可得\n$$\n\\Phi = F\\left(\\frac{\\sigma_{Y}^{45}}{2}\\right)^{2} + G\\left(\\frac{\\sigma_{Y}^{45}}{2}\\right)^{2} + H(0)^{2} + 2N\\left(\\frac{\\sigma_{Y}^{45}}{2}\\right)^{2}\n= \\frac{(\\sigma_{Y}^{45})^{2}}{4}\\,(F+G+2N) = 1,\n$$\n因此\n$$\nF+G+2N = \\frac{4}{(\\sigma_{Y}^{45})^{2}}.\n$$\n\n4. 面内纯剪切：$\\sigma_{1}=\\sigma_{2}=0$，$\\tau_{12}=\\tau_{Y}$。代入可得\n$\n\\Phi = 2N\\tau_{Y}^{2} = 1,\n$\n因此\n$\nN = \\frac{1}{2\\tau_{Y}^{2}}.\n$\n\n这四个方程确定了$(F,G,H,N)$。首先，根据剪切试验计算$N$：\n$$\nN = \\frac{1}{2\\tau_{Y}^{2}}.\n$$\n在$N$已知的情况下，$45^{\\circ}$试验给出\n$$\nF+G = \\frac{4}{(\\sigma_{Y}^{45})^{2}} - 2N.\n$$\n根据两个单轴拉伸试验，\n$$\nG+H = \\frac{1}{(\\sigma_{Y}^{0})^{2}},\\qquad F+H = \\frac{1}{(\\sigma_{Y}^{90})^{2}}.\n$$\n将这两个方程相减得到\n$$\nF - G = \\frac{1}{(\\sigma_{Y}^{90})^{2}} - \\frac{1}{(\\sigma_{Y}^{0})^{2}}.\n$$\n因此\n$$\nF = \\frac{1}{2}\\Big[(F+G) + (F-G)\\Big],\\qquad G = \\frac{1}{2}\\Big[(F+G) - (F-G)\\Big],\n$$\n然后可以从$G+H=1/(\\sigma_{Y}^{0})^{2}$或$F+H=1/(\\sigma_{Y}^{90})^{2}$求出$H$。\n\n现在代入给定的数值，在最后一步之前保留符号：\n\n给定$\\sigma_{Y}^{0}=180\\,\\text{MPa}$、$\\sigma_{Y}^{45}=190\\,\\text{MPa}$、$\\sigma_{Y}^{90}=200\\,\\text{MPa}$和$\\tau_{Y}=100\\,\\text{MPa}$，\n$$\nN = \\frac{1}{2(100)^{2}} = \\frac{1}{20000} = 5.00000\\times 10^{-5}\\ \\text{MPa}^{-2}.\n$$\n然后\n$$\nF+G = \\frac{4}{(190)^{2}} - 2N = \\frac{4}{36100} - \\frac{1}{10000}\n= 1.10803324099723\\times 10^{-4} - 1.00000000000000\\times 10^{-4}\n= 1.08033240997230\\times 10^{-5}\\ \\text{MPa}^{-2}.\n$$\n接着，\n$$\nF - G = \\frac{1}{(200)^{2}} - \\frac{1}{(180)^{2}}\n= 2.50000000000000\\times 10^{-5} - 3.08641975308642\\times 10^{-5}\n= -5.86419753086420\\times 10^{-6}\\ \\text{MPa}^{-2}.\n$$\n因此，\n$$\nF = \\frac{(F+G)+(F-G)}{2}\n= \\frac{1.08033240997230\\times 10^{-5} - 5.86419753086420\\times 10^{-6}}{2}\n= 2.46956328442940\\times 10^{-6}\\ \\text{MPa}^{-2},\n$$\n$$\nG = \\frac{(F+G)-(F-G)}{2}\n= \\frac{1.08033240997230\\times 10^{-5} + 5.86419753086420\\times 10^{-6}}{2}\n= 8.33376081529360\\times 10^{-6}\\ \\text{MPa}^{-2}.\n$$\n最后，由$G+H=1/(\\sigma_{Y}^{0})^{2}$可得，\n$$\nH = \\frac{1}{(180)^{2}} - G\n= 3.08641975308642\\times 10^{-5} - 8.33376081529360\\times 10^{-6}\n= 2.25304367155706\\times 10^{-5}\\ \\text{MPa}^{-2}.\n$$\n\n以$\\text{MPa}^{-2}$为单位，保留六位有效数字，\n$$\nF = 2.46956\\times 10^{-6},\\quad\nG = 8.33376\\times 10^{-6},\\quad\nH = 2.25304\\times 10^{-5},\\quad\nN = 5.00000\\times 10^{-5}.\n$$\n\n该二次型（在平面应力下）的凸性验证要求$F0$、$G0$、$H0$、$N0$。计算出的值满足\n$$\nF=2.46956\\times 10^{-6}0,\\quad\nG=8.33376\\times 10^{-6}0,\\quad\nH=2.25304\\times 10^{-5}0,\\quad\nN=5.00000\\times 10^{-5}0,\n$$\n因此凸性条件得到满足。", "answer": "$$\\boxed{\\begin{pmatrix}2.46956\\times 10^{-6}  8.33376\\times 10^{-6}  2.25304\\times 10^{-5}  5.00000\\times 10^{-5}\\end{pmatrix}}$$", "id": "2866890"}, {"introduction": "虽然希尔1948模型是各向异性塑性理论的基石，但理解其局限性对于高级应用至关重要。本练习旨在引导您深入分析屈服准则的几何形状，通过比较二次（如希尔1948）与非二次屈服面的曲率，揭示模型的数学形式如何影响对复杂工程问题（如板料成形性）的预测精度。这个思辨过程有助于培养对模型选择的批判性思维。[@problem_id:2866847]", "problem": "轧制板材的初始屈服响应近似各向同性。单轴拉伸试验测得轧制方向的屈服应力为 $500\\,\\text{MPa}$，等双轴胀形试验确认，在平衡双轴拉伸下的初始屈服应力也是 $500\\,\\text{MPa}$（与各向同性一致）。考虑两个根据这一单次测量的初始屈服应力进行标定的屈服准则：标准的各向同性二次 Hill $1948$ 模型（可简化为各向同性的 von Mises 形式）和一个指数为 $m=6$ 的各向同性非二次 Hosford 模型。假设平面应力状态，并考虑第一象限（拉-拉）主应力空间 $\\sigma_1$–$\\sigma_2$ 中的屈服轨迹。\n\n使用第一性原理（将屈服轨迹定义为应力空间中的一个水平集，以及平面曲线的微分几何），确定每个模型在等双轴拉伸点 $\\sigma_1=\\sigma_2$ 处屈服轨迹的局部曲率半径，并用此评估哪个模型在等双轴拉伸点表现出更尖锐的角点。然后，根据预测的应变路径敏感性和成形性，推断在平衡双轴拉伸（例如，冲头胀形或半球形顶锻试验）下，使用返回映射塑性算法和相关流动法则的板材成形模拟的定性结果。\n\n下列哪个陈述与正确的推导和科学上合理的结果最一致？\n\nA. 当两个准则都标定到 $500\\,\\text{MPa}$ 时，在等双轴拉伸点的局部曲率半径，对于二次 Hill $1948$ (von Mises) 模型约为 $\\rho_{m=2}\\approx 2.36\\times 10^2\\,\\text{MPa}$，对于非二次 Hosford ($m=6$) 模型约为 $\\rho_{m=6}\\approx 1.41\\times 10^2\\,\\text{MPa}$，因此非二次轨迹更尖锐。因此，在平衡双轴拉伸的成形模拟中使用 Hill $1948$ 模型，会因平滑角点而倾向于高估拉伸成形性（非保守），延迟局部化并低估等双轴拉伸点附近的应变路径敏感性。\n\nB. 当两个准则都标定到 $500\\,\\text{MPa}$ 时，在等双轴拉伸点的局部曲率半径，对于 Hill $1948$ 模型约为 $\\rho_{m=2}\\approx 1.41\\times 10^2\\,\\text{MPa}$，对于 Hosford ($m=6$) 模型约为 $\\rho_{m=6}\\approx 2.36\\times 10^2\\,\\text{MPa}$，因此 Hill $1948$ 模型更尖锐。因此，Hill $1948$ 模型会低估成形性（保守）并在双轴拉伸模拟中引发过早的局部化。\n\nC. 对于 Hosford 模型中的任何指数 $m$，如果两个准则都标定到相同的单轴和等双轴屈服应力，则在等双轴拉伸点的局部曲率是相同的。因此，在二次 Hill $1948$ 模型和非二次准则之间的选择对双轴成形预测的影响可以忽略不计。\n\nD. 像 Hosford ($m=6$) 这样的非二次准则总是相对于二次形式平滑屈服轨迹的角点，导致在等双轴拉伸点有更大的局部曲率半径。因此，相对于 Hill $1948$ 模型，非二次模型系统地高估了双轴拉伸中的成形性。", "solution": "问题陈述具有科学依据、提法明确且客观。它基于连续介质力学和塑性理论的既定原则，特别是二次和非二次屈服准则的比较。所提供的数据是自洽且符合实际的。因此，该问题被认为是有效的，可以进行严格求解。\n\n问题的核心是确定屈服轨迹在等双轴拉伸点的局部曲率半径 $\\rho$。屈服轨迹是在主应力空间 ($\\sigma_1, \\sigma_2$) 中由形式为 $F(\\sigma_1, \\sigma_2) = 0$ 的隐函数定义的平面曲线。根据微分几何，这样一条曲线的曲率半径由以下公式给出：\n$$ \\rho = \\frac{(F_1^2 + F_2^2)^{3/2}}{|F_{11}F_2^2 - 2F_{12}F_1 F_2 + F_{22}F_1^2|} $$\n其中 $F_i = \\frac{\\partial F}{\\partial \\sigma_i}$ 和 $F_{ij} = \\frac{\\partial^2 F}{\\partial \\sigma_i \\partial \\sigma_j}$。我们将在等双轴拉伸点计算该值，在该点 $\\sigma_1 = \\sigma_2 = \\sigma_b$。问题陈述指出等双轴屈服应力为 $\\sigma_b = 500\\,\\text{MPa}$。\n\n**各向同性二次 Hill 1948 (von Mises) 准则分析**\n\n对于平面应力 ($\\sigma_3=0$) 下的各向同性材料，Hill 1948 准则简化为 von Mises 准则。屈服函数通常表示为 $\\bar{\\sigma}_{vM} = Y$，其中 $Y$ 是单轴屈服应力，给定值为 $Y=500\\,\\text{MPa}$。\n我们定义屈服轨迹函数为 $F(\\sigma_1, \\sigma_2) = \\sigma_1^2 - \\sigma_1\\sigma_2 + \\sigma_2^2 - Y^2 = 0$。\n在等双轴拉伸点 $\\sigma_1 = \\sigma_2 = \\sigma_b$，屈服条件给出 $\\sigma_b^2 - \\sigma_b^2 + \\sigma_b^2 = Y^2$，因此 $\\sigma_b = Y = 500\\,\\text{MPa}$，这与问题陈述一致。\n\n我们计算 $F$ 的必要偏导数：\n$F_1 = 2\\sigma_1 - \\sigma_2$\n$F_2 = 2\\sigma_2 - \\sigma_1$\n$F_{11} = 2$\n$F_{22} = 2$\n$F_{12} = -1$\n\n在等双轴拉伸点 ($\\sigma_1 = \\sigma_2 = \\sigma_b = Y$)：\n$F_1 = 2Y - Y = Y$\n$F_2 = 2Y - Y = Y$\n二阶偏导数是常数。\n\n现在，我们将这些代入曲率半径公式，记为 $\\rho_{m=2}$：\n分子：$(F_1^2 + F_2^2)^{3/2} = (Y^2 + Y^2)^{3/2} = (2Y^2)^{3/2} = 2\\sqrt{2}Y^3$。\n分母：$|F_{11}F_2^2 - 2F_{12}F_1 F_2 + F_{22}F_1^2| = |2(Y^2) - 2(-1)(Y)(Y) + 2(Y^2)| = |2Y^2 + 2Y^2 + 2Y^2| = 6Y^2$。\n\n曲率半径为：\n$$ \\rho_{m=2} = \\frac{2\\sqrt{2}Y^3}{6Y^2} = \\frac{\\sqrt{2}}{3}Y $$\n代入 $Y = 500\\,\\text{MPa}$：\n$$ \\rho_{m=2} = \\frac{\\sqrt{2}}{3}(500\\,\\text{MPa}) \\approx \\frac{1.41421}{3}(500\\,\\text{MPa}) \\approx 235.70\\,\\text{MPa} $$\n该值约为 $2.36 \\times 10^2\\,\\text{MPa}$。\n\n**各向同性非二次 Hosford 准则 ($m=6$) 分析**\n\n平面应力 ($\\sigma_3=0$) 下的各向同性 Hosford 屈服函数由下式给出：\n$$ \\Phi = \\frac{1}{2}(|\\sigma_1 - \\sigma_2|^m + |\\sigma_1|^m + |\\sigma_2|^m) = Y^m $$\n我们定义屈服轨迹函数为 $F(\\sigma_1, \\sigma_2) = \\frac{1}{2}(|\\sigma_1 - \\sigma_2|^m + \\sigma_1^m + \\sigma_2^m) - Y^m = 0$，考虑第一象限，其中 $\\sigma_1, \\sigma_2  0$。\n在等双轴拉伸点 $\\sigma_1 = \\sigma_2 = \\sigma_b$，这给出 $\\frac{1}{2}(0^m + \\sigma_b^m + \\sigma_b^m) = Y^m$，简化为 $\\sigma_b^m = Y^m$，因此 $\\sigma_b = Y = 500\\,\\text{MPa}$。\n\n为了计算导数，我们必须小心处理绝对值项 $|\\sigma_1 - \\sigma_2|^m$ 在其参数为零的点。对于 $m=6$，函数 $|\\sigma_1 - \\sigma_2|^6$ 在 $\\sigma_1 = \\sigma_2$ 处是光滑的（可多次微分），其直到5阶的导数在该点均为零。该项的二阶导数为零。\n\n$F$ 的偏导数是：\n$F_1 = \\frac{m}{2} \\left[ |\\sigma_1 - \\sigma_2|^{m-1}\\text{sgn}(\\sigma_1-\\sigma_2) + \\sigma_1^{m-1} \\right]$\n$F_2 = \\frac{m}{2} \\left[ -|\\sigma_1 - \\sigma_2|^{m-1}\\text{sgn}(\\sigma_1-\\sigma_2) + \\sigma_2^{m-1} \\right]$\n$F_{11} = \\frac{m(m-1)}{2} \\left[ |\\sigma_1 - \\sigma_2|^{m-2} + \\sigma_1^{m-2} \\right]$\n$F_{22} = \\frac{m(m-1)}{2} \\left[ |\\sigma_1 - \\sigma_2|^{m-2} + \\sigma_2^{m-2} \\right]$\n$F_{12} = -\\frac{m(m-1)}{2} |\\sigma_1 - \\sigma_2|^{m-2}$\n\n在等双轴拉伸点 ($\\sigma_1 = \\sigma_2 = Y$) 且 $m=6$ 时：\n$F_1 = \\frac{m}{2} (0 + Y^{m-1}) = \\frac{m}{2}Y^{m-1}$\n$F_2 = \\frac{m}{2} (0 + Y^{m-1}) = \\frac{m}{2}Y^{m-1}$\n由于 $m-2 = 4  0$：\n$F_{11} = \\frac{m(m-1)}{2} (0 + Y^{m-2}) = \\frac{m(m-1)}{2}Y^{m-2}$\n$F_{22} = \\frac{m(m-1)}{2} (0 + Y^{m-2}) = \\frac{m(m-1)}{2}Y^{m-2}$\n$F_{12} = 0$\n\n我们将这些代入 $\\rho_{m=6}$ 的曲率公式：\n分子：$(F_1^2 + F_2^2)^{3/2} = \\left[ 2 \\left( \\frac{m}{2}Y^{m-1} \\right)^2 \\right]^{3/2} = 2\\sqrt{2} \\left( \\frac{m}{2}Y^{m-1} \\right)^3 = \\frac{\\sqrt{2}m^3}{4}Y^{3m-3}$。\n分母：$|F_{11}F_2^2 - 2F_{12}F_1 F_2 + F_{22}F_1^2| = | 2 \\left( \\frac{m(m-1)}{2}Y^{m-2} \\right) \\left( \\frac{m}{2}Y^{m-1} \\right)^2 | = \\frac{m^3(m-1)}{4}Y^{3m-4}$。\n\n曲率半径为：\n$$ \\rho_{m} = \\frac{\\frac{\\sqrt{2}m^3}{4}Y^{3m-3}}{\\frac{m^3(m-1)}{4}Y^{3m-4}} = \\frac{\\sqrt{2}}{m-1}Y $$\n该公式对 $m2$ 有效。对于 $m=6$：\n$$ \\rho_{m=6} = \\frac{\\sqrt{2}}{6-1}Y = \\frac{\\sqrt{2}}{5}Y $$\n代入 $Y = 500\\,\\text{MPa}$：\n$$ \\rho_{m=6} = \\frac{\\sqrt{2}}{5}(500\\,\\text{MPa}) = 100\\sqrt{2}\\,\\text{MPa} \\approx 141.42\\,\\text{MPa} $$\n该值约为 $1.41 \\times 10^2\\,\\text{MPa}$。\n\n**比较与结论**\n\n我们计算得出 $\\rho_{m=2} \\approx 236\\,\\text{MPa}$ 和 $\\rho_{m=6} \\approx 141\\,\\text{MPa}$。由于 $\\rho_{m=6}  \\rho_{m=2}$，指数为 $m=6$ 的 Hosford 准则的屈服轨迹具有较小的曲率半径，这意味着它在等双轴拉伸点的尖锐程度明显高于 von Mises 屈服轨迹。\n\n在采用相关流动法则的塑性理论中，塑性应变增量矢量垂直于屈服面。更尖锐的角点（更小的 $\\rho$）意味着沿屈服轨迹的应力状态发生微小变化时，法向矢量的方向变化得更快。这导致了更高的应变路径敏感性。对于接近平衡双轴拉伸的成形过程，与较平滑的模型（如 von Mises）相比，具有更尖锐角点的模型（如 Hosford $m=6$）将预测流动局部化（颈缩）的发生更早。\n因此，使用具有较大曲率半径的 von Mises（或二次 Hill）准则，会平滑掉这种角点效应。这会导致对应变路径敏感性的低估和对塑性失稳的延迟预测，从而高估了材料的成形性（拉伸性）。从工程设计的角度来看，这是一种非保守的预测。\n\n**逐项分析**\n\nA. 计算出的值 $\\rho_{m=2} \\approx 2.36\\times 10^2\\,\\text{MPa}$ 和 $\\rho_{m=6} \\approx 1.41\\times 10^2\\,\\text{MPa}$ 是正确的。非二次轨迹 ($m=6$) 更尖锐的结论是正确的。所述的结论，即使用 Hill 1948 (von Mises) 由于平滑了屈服轨迹角点而导致高估成形性且非保守，是板材成形领域中正确且标准的解释。**正确**。\n\nB. 两个模型的曲率半径数值被互换了。这是不正确的。因此，Hill 1948 更尖锐并低估成形性的结论也是不正确的。**不正确**。\n\nC. 声称对于任何指数 $m$，局部曲率都是相同的，这显然是错误的。我们的推导表明 $\\rho_{m=2} = \\frac{\\sqrt{2}}{3}Y$ 和 $\\rho_{m=6} = \\frac{\\sqrt{2}}{5}Y$，它们并不相等。模型选择影响可忽略的结论与材料成形成形应用的既定发现直接矛盾。**不正确**。\n\nD. 该陈述声称像 Hosford ($m=6$) 这样的非二次准则相对于二次形式会平滑角点。我们的计算显示了相反的情况：$\\rho_{m=6}  \\rho_{m=2}$，意味着 Hosford 轨迹更尖锐，而不是更平滑。随后的结论是基于这个错误的前提。**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2866847"}, {"introduction": "本构模型的最终价值在于其在数值模拟中的应用。这个动手编程练习将挑战您从第一性原理出发，构建一个完整的应力更新算法。您需要将希尔1948各向异性屈服准则、相关的流动法则以及硬化规律，整合到现代有限元软件中广泛使用的稳健的后向欧拉返回映射（backward-Euler return-mapping）框架中，从而体验从理论到代码的完整实现过程。[@problem_id:2866860]", "problem": "您需要为一个具有 Hill 1948 各向异性屈服准则的小应变、率无关、相关联弹塑性模型实现一个单步应力更新。该更新使用后向欧拉积分。目标是在给定一个应变增量的情况下，从一个无应力、无塑性应变的状态开始，计算更新后的柯西应力张量和内变量。所有计算都必须在标准的 Voigt 向量表示法中进行，张量剪切分量的顺序为 $[\\sigma_{11},\\sigma_{22},\\sigma_{33},\\sigma_{23},\\sigma_{13},\\sigma_{12}]$ 和 $[\\varepsilon_{11},\\varepsilon_{22},\\varepsilon_{33},\\varepsilon_{23},\\varepsilon_{13},\\varepsilon_{12}]$。请使用以下基本依据和假设。\n\n1. 运动学和弹性力学。假设小应变运动学，其中总应变增量可加法分解为弹性和塑性部分，即 $\\Delta \\boldsymbol{\\varepsilon} = \\Delta \\boldsymbol{\\varepsilon}^{e} + \\Delta \\boldsymbol{\\varepsilon}^{p}$。线性各向同性弹性力学通过胡克定律将应力和弹性应变联系起来，其张量形式为 $\\boldsymbol{\\sigma} = 2\\mu \\boldsymbol{\\varepsilon}^{e} + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}^{e}) \\mathbf{I}$，其中 $\\mu$ 和 $\\lambda$ 是拉梅参数。在采用张量剪切分量的 Voigt 表示法中，弹性刚度矩阵 $\\mathbf{C}$ 是对称的，其 $3\\times3$ 的法向块对角线上元素为 $\\lambda + 2\\mu$，非对角线元素为 $\\lambda$，三个剪切对角线上的元素等于 $2\\mu$。\n\n2. 屈服函数。使用 Hill 1948 各向异性二次屈服函数，该函数写为关于应力的凸二次型，\n$$\nf(\\boldsymbol{\\sigma},\\kappa) = \\tfrac{1}{2}\\,\\boldsymbol{\\sigma}^{T}\\,\\mathbf{P}\\,\\boldsymbol{\\sigma} - \\tfrac{1}{2}\\,R(\\kappa)^{2} \\le 0,\n$$\n其中 $\\kappa$ 是一个标量硬化变量，$R(\\kappa)=\\sigma_{0}+H^{\\mathrm{iso}}\\kappa$ 是当前半径，$\\sigma_{0}$ 是初始屈服应力，$H^{\\mathrm{iso}}$ 是线性各向同性硬化模量，$\\mathbf{P}$ 是一个 $6\\times 6$ 的对称正定矩阵，用于编码 Hill 各向异性。设 Hill 系数为 $F_{a}$、$G_{a}$、$H_{a}$、$L_{a}$、$M_{a}$、$N_{a}$，并按所述 Voigt 顺序定义 $\\mathbf{P}$ 为\n$$\n\\mathbf{P} =\n\\begin{bmatrix}\nG_{a}+H_{a}  -H_{a}  -G_{a}  0  0  0\\\\\n-H_{a}  F_{a}+H_{a}  -F_{a}  0  0  0\\\\\n-G_{a}  -F_{a}  F_{a}+G_{a}  0  0  0\\\\\n0  0  0  2L_{a}  0  0\\\\\n0  0  0  0  2M_{a}  0\\\\\n0  0  0  0  0  2N_{a}\n\\end{bmatrix}.\n$$\n\n3. 流动法则和硬化。使用相关联流动法则 $\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta \\gamma\\,\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$，其中塑性乘子 $\\Delta\\gamma \\ge 0$，因此在后向欧拉时间离散化下，$\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta \\gamma\\,\\mathbf{P}\\,\\boldsymbol{\\sigma}_{n+1}$。内部硬化变量更新为 $\\kappa_{n+1} = \\kappa_{n} + \\Delta\\gamma$。\n\n4. 返回映射。给定前一状态 $(\\boldsymbol{\\sigma}_{n},\\boldsymbol{\\varepsilon}^{p}_{n},\\kappa_{n})$ 和一个应变增量 $\\Delta \\boldsymbol{\\varepsilon}$，定义弹性试探应力为 $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\boldsymbol{\\sigma}_{n} + \\mathbf{C}\\,\\Delta \\boldsymbol{\\varepsilon}$。如果 $f(\\boldsymbol{\\sigma}^{\\mathrm{tr}},\\kappa_{n}) \\le 0$，则该步为弹性步，且 $(\\boldsymbol{\\sigma}_{n+1},\\boldsymbol{\\varepsilon}^{p}_{n+1},\\kappa_{n+1}) = (\\boldsymbol{\\sigma}^{\\mathrm{tr}},\\boldsymbol{\\varepsilon}^{p}_{n},\\kappa_{n})$。否则，需强制满足一致性条件 $f(\\boldsymbol{\\sigma}_{n+1},\\kappa_{n+1})=0$ 和后向欧拉流动法则，以获得\n$$\n\\left(\\mathbf{I} + \\Delta\\gamma\\,\\mathbf{C}\\,\\mathbf{P}\\right)\\,\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}}.\n$$\n这通过求解一个线性系统，得到了作为 $\\Delta\\gamma$ 函数的 $\\boldsymbol{\\sigma}_{n+1}$，并将塑性修正问题简化为一个关于 $\\Delta\\gamma$ 的标量非线性方程：\n$$\ng(\\Delta\\gamma) = \\tfrac{1}{2}\\,\\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma)^{T}\\mathbf{P}\\,\\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma) - \\tfrac{1}{2}\\left(\\sigma_{0} + H^{\\mathrm{iso}}(\\kappa_{n}+\\Delta\\gamma)\\right)^{2} = 0.\n$$\n使用带线搜索的稳健牛顿类方法求解 $\\Delta\\gamma$，其中 $g'(\\Delta\\gamma)$ 可通过对线性系统进行隐式微分导出。然后设置 $\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta\\gamma\\,\\mathbf{P}\\,\\boldsymbol{\\sigma}_{n+1}$，并更新 $\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\boldsymbol{\\varepsilon}^{p}_{n} + \\Delta \\boldsymbol{\\varepsilon}^{p}$ 和 $\\kappa_{n+1}=\\kappa_{n}+\\Delta\\gamma$。\n\n参数值和单位。请一致地使用以下数值参数和单位：\n- 杨氏模量 $E = 210000$ 兆帕 (MPa)，泊松比 $\\nu = 0.30$，因此 $\\mu = \\dfrac{E}{2(1+\\nu)}$ 且 $\\lambda = \\dfrac{E\\nu}{(1+\\nu)(1-2\\nu)}$。\n- 初始屈服应力 $\\sigma_{0} = 250$ MPa，各向同性硬化模量 $H^{\\mathrm{iso}} = 1000$ MPa。\n- Hill 各向异性系数 $F_{a}=0.6$，$G_{a}=0.4$，$H_{a}=0.8$，$L_{a}=1.0$，$M_{a}=0.9$，$N_{a}=1.1$ (无量纲)。\n- 所有应变均为无量纲；所有应力必须以 MPa 为单位报告。\n\n初始化。对于所有测试用例，假设上一步的状态为 $\\boldsymbol{\\sigma}_{n}=\\mathbf{0}$，$\\boldsymbol{\\varepsilon}^{p}_{n}=\\mathbf{0}$ 和 $\\kappa_{n}=0$。\n\n测试套件。实现您的程序，以处理以下五个应变增量（按所述 Voigt 顺序，张量剪切分量），每个增量产生一个结果：\n- 用例 A (弹性小混合法向增量)：$\\Delta \\boldsymbol{\\varepsilon} = [1.0\\times 10^{-6},\\,-2.0\\times 10^{-7},\\,4.0\\times 10^{-7},\\,0,\\,0,\\,0]$。\n- 用例 B (沿 11 方向的主要单轴法向增量)：$\\Delta \\boldsymbol{\\varepsilon} = [1.0\\times 10^{-3},\\,0,\\,0,\\,0,\\,0,\\,0]$。\n- 用例 C (12 方向的纯剪切)：$\\Delta \\boldsymbol{\\varepsilon} = [0,\\,0,\\,0,\\,0,\\,0,\\,5.0\\times 10^{-3}]$。\n- 用例 D (零增量，边界情况)：$\\Delta \\boldsymbol{\\varepsilon} = [0,\\,0,\\,0,\\,0,\\,0,\\,0]$。\n- 用例 E (大的静水增量)：$\\Delta \\boldsymbol{\\varepsilon} = [1.0\\times 10^{-3},\\,1.0\\times 10^{-3},\\,1.0\\times 10^{-3},\\,0,\\,0,\\,0]$。\n\n所需输出和单位。对于每个用例，计算并返回包含八个浮点数的列表：\n- 更新后的柯西应力分量 $[\\sigma_{11},\\sigma_{22},\\sigma_{33},\\sigma_{23},\\sigma_{13},\\sigma_{12}]$，单位为 MPa，\n- 更新后的硬化变量 $\\kappa_{n+1}$ (无量纲)，\n- 塑性乘子增量 $\\Delta\\gamma$ (无量纲)。\n所有八个值需按顺序 $[\\sigma_{11},\\sigma_{22},\\sigma_{33},\\sigma_{23},\\sigma_{13},\\sigma_{12},\\kappa_{n+1},\\Delta\\gamma]$ 报告。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个由方括号括起来的、以逗号分隔的结果列表，每个用例贡献其自己的包含八个十进制数的子列表。例如，输出必须如下所示：\n$[\\,[\\dots \\text{用例 A 的 8 个浮点数}\\dots],\\,[\\dots \\text{用例 B 的 8 个浮点数}\\dots],\\,[\\dots],\\,[\\dots],\\,[\\dots]\\,]$\n不得包含空格。所有应力以 MPa 表示，并返回十进制数。此问题不涉及角度。", "solution": "我们仅使用基本的连续介质力学和率无关塑性理论的凸分析，推导了针对 Hill 1948 各向异性屈服函数的后向欧拉返回映射算法。\n\n1. 基本依据和本构结构。在小应变假设下，应变的可加性表述为 $\\Delta \\boldsymbol{\\varepsilon} = \\Delta \\boldsymbol{\\varepsilon}^{e} + \\Delta \\boldsymbol{\\varepsilon}^{p}$。线性各向同性弹性力学将柯西应力与弹性应变关联为 $\\boldsymbol{\\sigma} = 2\\mu \\boldsymbol{\\varepsilon}^{e} + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}^{e}) \\mathbf{I}$。在采用张量剪切分量且顺序为 $[11,22,33,23,13,12]$ 的 Voigt 表示法中，弹性刚度矩阵 $\\mathbf{C}$ 的法向块对角线上元素为 $\\lambda + 2\\mu$，非对角线元素为 $\\lambda$，剪切对角线上的元素等于 $2\\mu$。\n\n2. Hill 的二次屈服及其梯度。Hill 1948 提出了一个关于主应力差和剪应力的二次各向异性形式。引入一个编码各向异性的对称正定矩阵 $\\mathbf{P}$，屈服函数为\n$$\nf(\\boldsymbol{\\sigma},\\kappa) = \\tfrac{1}{2}\\,\\boldsymbol{\\sigma}^{T}\\mathbf{P}\\boldsymbol{\\sigma} - \\tfrac{1}{2}R(\\kappa)^{2} \\le 0,\n$$\n其中 $R(\\kappa)=\\sigma_{0}+H^{\\mathrm{iso}}\\kappa$。其关于应力的梯度为\n$$\n\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\mathbf{P}\\,\\boldsymbol{\\sigma},\n$$\n因为二次型 $\\tfrac{1}{2}\\boldsymbol{\\sigma}^{T}\\mathbf{P}\\boldsymbol{\\sigma}$ 的导数是 $\\mathbf{P}\\boldsymbol{\\sigma}$。对于标准的 Hill 系数 $F_{a},G_{a},H_{a},L_{a},M_{a},N_{a}$，$\\mathbf{P}$ 矩阵明确表示为\n$$\n\\mathbf{P} =\n\\begin{bmatrix}\nG_{a}+H_{a}  -H_{a}  -G_{a}  0  0  0\\\\\n-H_{a}  F_{a}+H_{a}  -F_{a}  0  0  0\\\\\n-G_{a}  -F_{a}  F_{a}+G_{a}  0  0  0\\\\\n0  0  0  2L_{a}  0  0\\\\\n0  0  0  0  2M_{a}  0\\\\\n0  0  0  0  0  2N_{a}\n\\end{bmatrix}.\n$$\n\n3. 相关联流动与硬化。率无关塑性理论与相关联流动法则假定 $\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta \\gamma\\,\\partial f/\\partial \\boldsymbol{\\sigma}$，因此对于 Hill 的形式，\n$$\n\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta \\gamma\\,\\mathbf{P}\\,\\boldsymbol{\\sigma}_{n+1}.\n$$\n内部标量硬化变量取为 $\\kappa_{n+1}=\\kappa_{n}+\\Delta\\gamma$，半径为 $R_{n+1}=\\sigma_{0}+H^{\\mathrm{iso}}\\kappa_{n+1}$。\n\n4. 后向欧拉应力更新。考虑从状态 $(\\boldsymbol{\\sigma}_{n},\\boldsymbol{\\varepsilon}^{p}_{n},\\kappa_{n})$ 开始，在给定的总应变增量 $\\Delta \\boldsymbol{\\varepsilon}$ 下的一个步骤。首先，形成弹性预测值\n$$\n\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\boldsymbol{\\sigma}_{n} + \\mathbf{C}\\,\\Delta \\boldsymbol{\\varepsilon}.\n$$\n计算试探屈服函数值 $f^{\\mathrm{tr}}=f(\\boldsymbol{\\sigma}^{\\mathrm{tr}},\\kappa_{n})$。如果 $f^{\\mathrm{tr}}\\le 0$，则该步为弹性步，$\\boldsymbol{\\sigma}_{n+1}=\\boldsymbol{\\sigma}^{\\mathrm{tr}}$，$\\boldsymbol{\\varepsilon}^{p}_{n+1}=\\boldsymbol{\\varepsilon}^{p}_{n}$，且 $\\kappa_{n+1}=\\kappa_{n}$。\n\n如果 $f^{\\mathrm{tr}}0$，则发生塑性流动，塑性修正必须在步末强制满足流动法则和一致性条件。使用后向欧拉离散化流动法则得到\n$$\n\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta \\gamma\\,\\mathbf{P}\\,\\boldsymbol{\\sigma}_{n+1},\\quad \\text{所以}\\quad\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\mathbf{C}\\,\\Delta \\boldsymbol{\\varepsilon}^{p}\n= \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\Delta \\gamma\\,\\mathbf{C}\\,\\mathbf{P}\\,\\boldsymbol{\\sigma}_{n+1}.\n$$\n整理后得到线性系统\n$$\n\\left(\\mathbf{I} + \\Delta\\gamma\\,\\mathbf{C}\\,\\mathbf{P}\\right)\\,\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}},\n$$\n对于任何固定的 $\\Delta\\gamma\\ge 0$，该系统通过求解一个对称正定线性系统来确定 $\\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma)$，因为 $\\mathbf{C}$ 和 $\\mathbf{P}$ 都是正定的。\n\n5. 作为标量方程的一致性条件。在步末强制满足屈服条件，\n$$\ng(\\Delta\\gamma) \\equiv f\\left(\\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma),\\,\\kappa_{n}+\\Delta\\gamma\\right) = \\tfrac{1}{2}\\,\\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma)^{T}\\mathbf{P}\\,\\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma) - \\tfrac{1}{2}\\left(\\sigma_{0}+H^{\\mathrm{iso}}(\\kappa_{n}+\\Delta\\gamma)\\right)^{2} = 0.\n$$\n这是一个关于 $\\Delta\\gamma$ 的标量非线性方程。为了用牛顿法稳健地求解它，需通过隐式微分计算其导数。记 $\\mathbf{A}(\\Delta\\gamma) = \\mathbf{I} + \\Delta\\gamma\\,\\mathbf{C}\\,\\mathbf{P}$ 并注意到\n$$\n\\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma) = \\mathbf{A}(\\Delta\\gamma)^{-1}\\,\\boldsymbol{\\sigma}^{\\mathrm{tr}}.\n$$\n对 $\\mathbf{A}\\,\\boldsymbol{\\sigma}_{n+1}=\\boldsymbol{\\sigma}^{\\mathrm{tr}}$ 关于 $\\Delta\\gamma$ 求导，得到\n$$\n\\frac{d\\boldsymbol{\\sigma}_{n+1}}{d\\Delta\\gamma} = -\\mathbf{A}(\\Delta\\gamma)^{-1}\\,\\mathbf{C}\\,\\mathbf{P}\\,\\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma).\n$$\n接着\n$$\ng'(\\Delta\\gamma) = \\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma)^{T}\\mathbf{P}\\,\\frac{d\\boldsymbol{\\sigma}_{n+1}}{d\\Delta\\gamma} - H^{\\mathrm{iso}}\\left(\\sigma_{0}+H^{\\mathrm{iso}}(\\kappa_{n}+\\Delta\\gamma)\\right),\n$$\n代入 $d\\boldsymbol{\\sigma}_{n+1}/d\\Delta\\gamma$ 的表达式后，得到\n$$\ng'(\\Delta\\gamma) = -\\,\\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma)^{T}\\,\\mathbf{P}\\,\\mathbf{A}(\\Delta\\gamma)^{-1}\\,\\mathbf{C}\\,\\mathbf{P}\\,\\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma) - H^{\\mathrm{iso}}\\left(\\sigma_{0}+H^{\\mathrm{iso}}(\\kappa_{n}+\\Delta\\gamma)\\right).\n$$\n该导数可以通过求解辅助线性系统 $\\mathbf{A}(\\Delta\\gamma)\\,\\mathbf{w} = \\mathbf{C}\\,\\mathbf{P}\\,\\boldsymbol{\\sigma}_{n+1}(\\Delta\\gamma)$，然后计算 $g'(\\Delta\\gamma) = -\\,\\boldsymbol{\\sigma}_{n+1}^{T}\\mathbf{P}\\,\\mathbf{w} - H^{\\mathrm{iso}}(\\sigma_{0}+H^{\\mathrm{iso}}(\\kappa_{n}+\\Delta\\gamma))$ 来获得。\n\n6. 算法步骤。一个增量步的完整算法如下：\n- 给定 $(\\boldsymbol{\\sigma}_{n},\\boldsymbol{\\varepsilon}^{p}_{n},\\kappa_{n})$ 和 $\\Delta \\boldsymbol{\\varepsilon}$，计算 $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\boldsymbol{\\sigma}_{n} + \\mathbf{C}\\,\\Delta \\boldsymbol{\\varepsilon}$ 和 $f^{\\mathrm{tr}} = \\tfrac{1}{2}\\boldsymbol{\\sigma}^{\\mathrm{tr}T}\\mathbf{P}\\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\tfrac{1}{2}(\\sigma_{0}+H^{\\mathrm{iso}}\\kappa_{n})^{2}$。\n- 如果 $f^{\\mathrm{tr}} \\le 0$，设置 $\\boldsymbol{\\sigma}_{n+1}=\\boldsymbol{\\sigma}^{\\mathrm{tr}}$，$\\boldsymbol{\\varepsilon}^{p}_{n+1}=\\boldsymbol{\\varepsilon}^{p}_{n}$，$\\kappa_{n+1}=\\kappa_{n}$。\n- 否则，初始化 $\\Delta\\gamma^{(0)}=0$。对于 $k=0,1,2,\\dots$ 直到收敛：\n  1. 构造 $\\mathbf{A}^{(k)}=\\mathbf{I}+\\Delta\\gamma^{(k)}\\mathbf{C}\\mathbf{P}$。\n  2. 求解 $\\mathbf{A}^{(k)}\\boldsymbol{\\sigma}^{(k)} = \\boldsymbol{\\sigma}^{\\mathrm{tr}}$。\n  3. 评估 $g^{(k)} = \\tfrac{1}{2}\\boldsymbol{\\sigma}^{(k)T}\\mathbf{P}\\boldsymbol{\\sigma}^{(k)} - \\tfrac{1}{2}(\\sigma_{0}+H^{\\mathrm{iso}}(\\kappa_{n}+\\Delta\\gamma^{(k)}))^{2}$。\n  4. 求解 $\\mathbf{A}^{(k)}\\mathbf{w}^{(k)} = \\mathbf{C}\\mathbf{P}\\boldsymbol{\\sigma}^{(k)}$ 并计算 $g'^{(k)} = -\\,\\boldsymbol{\\sigma}^{(k)T}\\mathbf{P}\\mathbf{w}^{(k)} - H^{\\mathrm{iso}}(\\sigma_{0}+H^{\\mathrm{iso}}(\\kappa_{n}+\\Delta\\gamma^{(k)}))$。\n  5. 使用带线搜索的保障性牛顿步进行更新：提出 $\\Delta\\gamma^{\\mathrm{trial}}=\\Delta\\gamma^{(k)} - g^{(k)}/g'^{(k)}$。如果 $\\Delta\\gamma^{\\mathrm{trial}}0$ 或未能减小 $|g|$，则沿牛顿步回溯，直到 $|g|$ 减小且 $\\Delta\\gamma\\ge 0$。\n  6. 检查收敛性，即 $|g^{(k)}|$ 是否低于相对于应力量级的某个容差；如果收敛，则设置 $\\Delta\\gamma=\\Delta\\gamma^{(k)}$，$\\boldsymbol{\\sigma}_{n+1}=\\boldsymbol{\\sigma}^{(k)}$。\n- 最后，计算塑性应变增量 $\\Delta \\boldsymbol{\\varepsilon}^{p}=\\Delta\\gamma\\,\\mathbf{P}\\,\\boldsymbol{\\sigma}_{n+1}$，并更新 $\\boldsymbol{\\varepsilon}^{p}_{n+1}=\\boldsymbol{\\varepsilon}^{p}_{n}+\\Delta \\boldsymbol{\\varepsilon}^{p}$ 和 $\\kappa_{n+1}=\\kappa_{n}+\\Delta\\gamma$。\n\n7. 单位与映射。当 $E$ 的单位为兆帕 (MPa) 且应变为无量纲时，计算出的应力单位为 MPa。张量剪切约定至关重要：采用此约定，$\\mathbf{C}$ 的剪切项为 $2\\mu$，$\\mathbf{P}$ 的剪切项为 $2L_{a},2M_{a},2N_{a}$，这与 $\\sigma_{12}=2\\mu\\,\\varepsilon_{12}$ 和 $\\partial f/\\partial \\sigma_{12}=2N_{a}\\sigma_{12}$ 相一致。\n\n8. 测试套件原理。五个用例分别探测：\n- A：小的混合法向增量，预期为弹性 ($f^{\\mathrm{tr}}0$)。\n- B：沿 11 方向的大法向增量，预期为塑性 ($f^{\\mathrm{tr}}0$)。\n- C：12 方向的大纯剪切，预期为塑性，且受到 $N_{a}$ 的各向异性影响。\n- D：零增量，边界情况 ($\\Delta\\gamma=0$)。\n- E：大的静水增量，预期为弹性，因为 Hill 函数仅依赖于类偏量组合。\n\n9. 程序输出。对于每个用例，以单行聚合列表的形式报告 $[\\sigma_{11},\\sigma_{22},\\sigma_{33},\\sigma_{23},\\sigma_{13},\\sigma_{12},\\kappa_{n+1},\\Delta\\gamma]$，其中应力单位为 MPa，值为十进制浮点数。\n\n此过程满足后向欧拉积分要求，通过 Hill 的二次型强制各向异性屈服，并且仅使用基本的、经过充分检验的关系来推导算法，没有走捷径。牛顿迭代利用一致性函数的凸性和单调性来确保稳健收敛。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef hill_P(Fa, Ga, Ha, La, Ma, Na):\n    \"\"\"\n    Build the 6x6 Hill anisotropy matrix P in Voigt order [11,22,33,23,13,12]\n    with tensorial shear components.\n    \"\"\"\n    P = np.zeros((6, 6), dtype=float)\n    # Normal-normal block\n    P[0, 0] = Ga + Ha\n    P[0, 1] = -Ha\n    P[0, 2] = -Ga\n\n    P[1, 0] = -Ha\n    P[1, 1] = Fa + Ha\n    P[1, 2] = -Fa\n\n    P[2, 0] = -Ga\n    P[2, 1] = -Fa\n    P[2, 2] = Fa + Ga\n\n    # Shear components (tensorial shear)\n    P[3, 3] = 2.0 * La\n    P[4, 4] = 2.0 * Ma\n    P[5, 5] = 2.0 * Na\n\n    return P\n\ndef isotropic_C(E, nu):\n    \"\"\"\n    Build the 6x6 isotropic elasticity matrix C in Voigt order [11,22,33,23,13,12]\n    for tensorial shear components (sigma_12 = 2 mu * eps_12).\n    \"\"\"\n    lam = E * nu / ((1.0 + nu) * (1.0 - 2.0 * nu))\n    mu = E / (2.0 * (1.0 + nu))\n    C = np.zeros((6, 6), dtype=float)\n    # Normal-normal block\n    for i in range(3):\n        for j in range(3):\n            C[i, j] = lam\n        C[i, i] += 2.0 * mu\n    # Shear block\n    C[3, 3] = 2.0 * mu\n    C[4, 4] = 2.0 * mu\n    C[5, 5] = 2.0 * mu\n    return C\n\ndef yield_radius(sig0, Hiso, kappa):\n    return sig0 + Hiso * kappa\n\ndef yield_function(sig, P, sig0, Hiso, kappa):\n    \"\"\"Hill yield function f = 0.5 sig^T P sig - 0.5 R(kappa)^2.\"\"\"\n    R = yield_radius(sig0, Hiso, kappa)\n    return 0.5 * float(sig.T @ P @ sig) - 0.5 * (R * R)\n\ndef plastic_update_be(sig_n, epsp_n, kappa_n, De, P, sig0, Hiso, deps,\n                      newton_tol=1e-10, max_iter=50):\n    \"\"\"\n    Backward-Euler update for one increment:\n    Inputs:\n      sig_n: previous stress (6,)\n      epsp_n: previous plastic strain (6,)\n      kappa_n: previous hardening variable (scalar)\n      De: elastic stiffness 6x6\n      P: Hill anisotropy 6x6\n      sig0: initial yield stress\n      Hiso: isotropic hardening modulus\n      deps: total strain increment (6,)\n    Returns:\n      sig_np1, epsp_np1, kappa_np1, dgamma\n    \"\"\"\n    # Elastic predictor\n    sig_tr = sig_n + De @ deps\n    f_tr = yield_function(sig_tr, P, sig0, Hiso, kappa_n)\n    if f_tr = 0.0:\n        # Elastic step\n        return sig_tr, epsp_n.copy(), float(kappa_n), 0.0\n\n    # Plastic step: solve for dgamma = 0\n    dgamma = 0.0  # initial guess\n    # Newton with simple backtracking\n    I6 = np.eye(6)\n    Rn = yield_radius(sig0, Hiso, kappa_n)\n    # Use a better initial guess based on local linearization at gamma=0\n    # g(0) = f_tr; g'(0) = - sig_tr^T P (De P sig_tr) - Hiso * Rn\n    DeP_sigtr = De @ (P @ sig_tr)\n    g0 = f_tr\n    gp0 = - float(sig_tr.T @ (P @ DeP_sigtr)) - Hiso * Rn\n    if gp0  0.0:\n        dgamma = max(0.0, -g0 / gp0)\n    else:\n        dgamma = 0.0\n\n    def solve_A(gamma, rhs):\n        A = I6 + gamma * (De @ P)\n        return np.linalg.solve(A, rhs)\n\n    # Newton iterations\n    for _ in range(max_iter):\n        # Solve for sigma(gamma)\n        sig = solve_A(dgamma, sig_tr)\n        Rk = yield_radius(sig0, Hiso, kappa_n + dgamma)\n        g = 0.5 * float(sig.T @ (P @ sig)) - 0.5 * (Rk * Rk)\n        if abs(g)  newton_tol * max(Rn * Rn, 1.0):\n            # Converged\n            break\n        # Compute derivative: need w = A^{-1} (De P sig)\n        w_rhs = De @ (P @ sig)\n        w = solve_A(dgamma, w_rhs)\n        gp = - float(sig.T @ (P @ w)) - Hiso * (yield_radius(sig0, Hiso, kappa_n + dgamma))\n        # Safeguarded step\n        if gp == 0.0:\n            step = 0.0\n        else:\n            step = - g / gp\n        # Backtracking line search to keep gamma = 0 and reduce |g|\n        alpha = 1.0\n        success = False\n        for _ls in range(20):\n            dgamma_trial = dgamma + alpha * step\n            if dgamma_trial  0.0:\n                alpha *= 0.5\n                continue\n            sig_trial = solve_A(dgamma_trial, sig_tr)\n            Rk_trial = yield_radius(sig0, Hiso, kappa_n + dgamma_trial)\n            g_trial = 0.5 * float(sig_trial.T @ (P @ sig_trial)) - 0.5 * (Rk_trial * Rk_trial)\n            if abs(g_trial)  abs(g) * (1.0 - 1e-4 * alpha):\n                dgamma = dgamma_trial\n                success = True\n                break\n            alpha *= 0.5\n        if not success:\n            # Fallback: take small positive step if possible\n            dgamma = max(0.0, dgamma + max(min(step, 1.0), -0.5))\n    # Final state\n    sig_np1 = solve_A(dgamma, sig_tr)\n    depsp = dgamma * (P @ sig_np1)\n    epsp_np1 = epsp_n + depsp\n    kappa_np1 = kappa_n + dgamma\n    return sig_np1, epsp_np1, float(kappa_np1), float(dgamma)\n\ndef solve():\n    # Material parameters (MPa, dimensionless)\n    E = 210000.0\n    nu = 0.30\n    sig0 = 250.0\n    Hiso = 1000.0\n\n    # Hill 1948 anisotropy coefficients (dimensionless)\n    Fa = 0.6\n    Ga = 0.4\n    Ha = 0.8  # Hill's H coefficient\n    La = 1.0\n    Ma = 0.9\n    Na = 1.1\n\n    # Build matrices\n    C = isotropic_C(E, nu)\n    P = hill_P(Fa, Ga, Ha, La, Ma, Na)\n\n    # Initial state\n    sig_n = np.zeros(6, dtype=float)\n    epsp_n = np.zeros(6, dtype=float)\n    kappa_n = 0.0\n\n    # Define the test cases (tensorial shear Voigt components)\n    test_cases = [\n        # Case A: elastic small mixed normal increment\n        np.array([1.0e-6, -2.0e-7, 4.0e-7, 0.0, 0.0, 0.0], dtype=float),\n        # Case B: dominant uniaxial normal increment along 11\n        np.array([1.0e-3, 0.0, 0.0, 0.0, 0.0, 0.0], dtype=float),\n        # Case C: pure shear in 12\n        np.array([0.0, 0.0, 0.0, 0.0, 0.0, 5.0e-3], dtype=float),\n        # Case D: zero increment\n        np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0], dtype=float),\n        # Case E: large hydrostatic increment\n        np.array([1.0e-3, 1.0e-3, 1.0e-3, 0.0, 0.0, 0.0], dtype=float),\n    ]\n\n    results_str = []\n    # Process each test case independently from the initial state\n    for deps in test_cases:\n        sig_np1, epsp_np1, kappa_np1, dgamma = plastic_update_be(\n            sig_n, epsp_n, kappa_n, C, P, sig0, Hiso, deps\n        )\n        # Prepare output: [sig11, sig22, sig33, sig23, sig13, sig12, kappa, dgamma]\n        out_vals = [\n            sig_np1[0], sig_np1[1], sig_np1[2], sig_np1[3], sig_np1[4], sig_np1[5],\n            kappa_np1, dgamma\n        ]\n        # Format with a reasonable number of decimals to ensure concise output\n        formatted = [\"{:.6f}\".format(v) for v in out_vals]\n        results_str.append(\"[\" + \",\".join(formatted) + \"]\")\n\n    # Final print statement in the exact required format (single line, no spaces)\n    print(\"[\" + \",\".join(results_str) + \"]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2866860"}]}