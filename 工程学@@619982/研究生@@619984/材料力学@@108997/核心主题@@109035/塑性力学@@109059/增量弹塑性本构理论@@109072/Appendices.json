{"hands_on_practices": [{"introduction": "第一个练习为计算塑性理论的核心逻辑提供了基础实践。通过手动追踪一根简单一维杆在单调加载下的应力和应变演化，你将亲手实现“弹性预测-塑性修正”这一基本算法。该练习旨在将试探状态、屈服检查和返回映射等抽象概念具体化和直观化，为解决更复杂的多维问题打下坚实的基础。[@problem_id:2893807]", "problem": "一根由率无关、具有线性弹性的理想塑性材料制成的小应变一维杆，承受单调拉伸应变控制加载。该材料遵循应变的加法分解、线性弹性定律以及具有拉压对称屈服函数的关联流动法则。具体而言，使用的基本关系如下：\n- 总应变分解为弹性和塑性部分：$\\epsilon = \\epsilon^{e} + \\epsilon^{p}$。\n- 线性弹性：$\\sigma = E\\,\\epsilon^{e}$。\n- 理想塑性的屈服函数：$f(\\sigma) = |\\sigma| - \\sigma_{y} \\le 0$。\n- 关联流动及 Kuhn-Tucker 条件：$\\dot{\\epsilon}^{p} = \\dot{\\lambda}\\,\\partial f/\\partial \\sigma$，$\\dot{\\lambda} \\ge 0$，$f \\le 0$ 且 $\\dot{\\lambda}\\,f = 0$。\n\n从上述基本关系出发，推导在单调拉伸下一个时间步内的一致性增量更新方法，使得给定一个应变增量 $\\Delta \\epsilon$，可以判断该步是弹性还是塑性，并相应地更新 $(\\epsilon,\\epsilon^{e},\\epsilon^{p},\\sigma)$。然后将你推导的更新方法应用于以下数据：\n\n- 弹性模量：$E = 210\\,\\mathrm{GPa}$。\n- 屈服应力：$\\sigma_{y} = 250\\,\\mathrm{MPa}$。\n- 步骤 $n=0$ 时的初始状态：$\\epsilon_{0} = 0$，$\\epsilon^{p}_{0} = 0$，$\\sigma_{0} = 0$。\n- 应变增量（单调拉伸）：$\\Delta \\epsilon_{1} = 6.0 \\times 10^{-4}$，$\\Delta \\epsilon_{2} = 7.0 \\times 10^{-4}$，$\\Delta \\epsilon_{3} = 4.0 \\times 10^{-4}$，$\\Delta \\epsilon_{4} = 2.5 \\times 10^{-4}$。\n\n对步骤 1 到 4 进行逐步更新，明确计算每一步 $k$ 结束时的 $\\epsilon_{k}$、$\\epsilon^{e}_{k}$、$\\epsilon^{p}_{k}$ 和 $\\sigma_{k}$。最后，将步骤 4 后的塑性应变值 $\\epsilon^{p}_{4}$ 报告为一个单一的数值。应变是无量纲的；将最终结果以小数形式表示，并四舍五入到六位有效数字。", "solution": "所给问题是计算塑性力学中的一个标准练习，要求推导并应用一维返回映射算法。在进行求解之前，必须对问题陈述进行验证。\n\n首先，我逐字提取给定信息。\n- 应变加法分解：$\\epsilon = \\epsilon^{e} + \\epsilon^{p}$。\n- 线性弹性：$\\sigma = E\\,\\epsilon^{e}$。\n- 屈服函数：$f(\\sigma) = |\\sigma| - \\sigma_{y} \\le 0$。\n- 关联流动法则：$\\dot{\\epsilon}^{p} = \\dot{\\lambda}\\,\\partial f/\\partial \\sigma$。\n- Kuhn-Tucker 条件：$\\dot{\\lambda} \\ge 0$，$f \\le 0$, $\\dot{\\lambda}\\,f = 0$。\n- 材料参数：杨氏模量 $E = 210\\,\\mathrm{GPa}$，屈服应力 $\\sigma_{y} = 250\\,\\mathrm{MPa}$。\n- 初始条件 ($n=0$)：$\\epsilon_{0} = 0$，$\\epsilon^{p}_{0} = 0$，$\\sigma_{0} = 0$。\n- 应变增量：$\\Delta \\epsilon_{1} = 6.0 \\times 10^{-4}$，$\\Delta \\epsilon_{2} = 7.0 \\times 10^{-4}$，$\\Delta \\epsilon_{3} = 4.0 \\times 10^{-4}$，$\\Delta \\epsilon_{4} = 2.5 \\times 10^{-4}$。\n- 加载是单调拉伸，意味着 $\\sigma \\ge 0$。\n\n该问题科学基础扎实、提法恰当且客观。这是弹塑性力学中的一个基本问题，没有矛盾、歧义或事实错误。所有必要的数据都已提供。因此，该问题是有效的，我将继续进行求解。\n\n解决方案需要两部分：首先，推导增量更新算法；其次，将其应用于给定数据。\n\n增量更新算法的推导：\n这个过程被称为弹性预测-塑性修正算法，它根据步骤 $n$ 的状态和总应变增量 $\\Delta \\epsilon$ 来确定时间步 $n+1$ 结束时的状态。任何步骤 $k$ 的状态由变量 $(\\epsilon_{k}, \\epsilon^{e}_{k}, \\epsilon^{p}_{k}, \\sigma_{k})$ 定义。首先更新总应变：$\\epsilon_{n+1} = \\epsilon_{n} + \\Delta \\epsilon$。\n\n由于加载是单调拉伸，应力 $\\sigma$ 始终为非负。屈服函数简化为 $f(\\sigma) = \\sigma - \\sigma_{y} \\le 0$。流动法则变为 $\\dot{\\epsilon}^{p} = \\dot{\\lambda}\\,\\frac{\\partial f}{\\partial \\sigma} = \\dot{\\lambda}\\,(1) = \\dot{\\lambda}$。增量塑性应变为 $\\Delta\\epsilon^{p} = \\Delta\\lambda$。增量形式的 Kuhn-Tucker 条件为 $\\Delta\\epsilon^{p} \\ge 0$，$\\sigma_{n+1} - \\sigma_{y} \\le 0$ 和 $\\Delta\\epsilon^{p}(\\sigma_{n+1} - \\sigma_{y}) = 0$。\n\n1.  弹性预测：假设整个应变增量 $\\Delta\\epsilon$ 都是弹性的。\n    试探塑性应变假定不变：$\\epsilon^{p, \\text{trial}}_{n+1} = \\epsilon^{p}_{n}$。\n    试探弹性应变为 $\\epsilon^{e, \\text{trial}}_{n+1} = \\epsilon_{n+1} - \\epsilon^{p, \\text{trial}}_{n+1} = (\\epsilon_{n} + \\Delta\\epsilon) - \\epsilon^{p}_{n} = (\\epsilon_{n} - \\epsilon^{p}_{n}) + \\Delta\\epsilon = \\epsilon^{e}_{n} + \\Delta\\epsilon$。\n    试探应力由试探弹性应变计算得出：$\\sigma^{\\text{trial}}_{n+1} = E\\,\\epsilon^{e, \\text{trial}}_{n+1} = E(\\epsilon^{e}_{n} + \\Delta\\epsilon) = \\sigma_{n} + E\\,\\Delta\\epsilon$。\n\n2.  屈服检查：在试探应力下评估屈服函数。\n    $f^{\\text{trial}}_{n+1} = \\sigma^{\\text{trial}}_{n+1} - \\sigma_{y}$。\n\n3.  判断与状态更新：\n    情况 A) $f^{\\text{trial}}_{n+1} \\le 0$：试探应力在屈服面内部或其上。弹性假设是正确的。该步为弹性步。\n    更新后的状态变量即为试探值：\n    - $\\sigma_{n+1} = \\sigma^{\\text{trial}}_{n+1}$\n    - $\\epsilon^{e}_{n+1} = \\epsilon^{e, \\text{trial}}_{n+1}$\n    - $\\epsilon^{p}_{n+1} = \\epsilon^{p}_{n}$ (无塑性流动)\n\n    情况 B) $f^{\\text{trial}}_{n+1} > 0$：试探应力超出了屈服面，这在物理上是不可接受的。该步涉及塑性变形。需要进行塑性修正。\n    最终的应力状态必须位于屈服面上。对于理想塑性和拉伸加载，这意味着 $\\sigma_{n+1} = \\sigma_{y}$。\n    更新后的状态变量为：\n    - $\\sigma_{n+1} = \\sigma_{y}$\n    - 最终的弹性应变由胡克定律确定：$\\epsilon^{e}_{n+1} = \\sigma_{n+1}/E = \\sigma_{y}/E$。\n    - 最终的塑性应变由加法分解得出：$\\epsilon^{p}_{n+1} = \\epsilon_{n+1} - \\epsilon^{e}_{n+1}$。\n\n现在，我将此算法应用于给定数据。\n材料参数：$E = 210\\,\\mathrm{GPa} = 210 \\times 10^{9}\\,\\mathrm{Pa}$，$\\sigma_{y} = 250\\,\\mathrm{MPa} = 250 \\times 10^{6}\\,\\mathrm{Pa}$。\n屈服时的弹性应变为 $\\epsilon_{y} = \\sigma_{y} / E = (250 \\times 10^{6}) / (210 \\times 10^{9}) = \\frac{250}{210000} \\approx 1.190476 \\times 10^{-3}$。\n\n初始状态 ($k=0$)：\n$\\epsilon_{0} = 0$，$\\epsilon^{p}_{0} = 0$，$\\epsilon^{e}_{0} = 0$，$\\sigma_{0} = 0$。\n\n步骤 $k=1$：$\\Delta \\epsilon_{1} = 6.0 \\times 10^{-4}$\n- 总应变：$\\epsilon_{1} = \\epsilon_{0} + \\Delta \\epsilon_{1} = 0 + 6.0 \\times 10^{-4} = 6.0 \\times 10^{-4}$。\n- 弹性预测：$\\sigma^{\\text{trial}}_{1} = \\sigma_{0} + E\\,\\Delta\\epsilon_{1} = 0 + (210 \\times 10^{9}\\,\\mathrm{Pa})(6.0 \\times 10^{-4}) = 126 \\times 10^{6}\\,\\mathrm{Pa} = 126\\,\\mathrm{MPa}$。\n- 屈服检查：$f^{\\text{trial}}_{1} = 126\\,\\mathrm{MPa} - 250\\,\\mathrm{MPa} = -124\\,\\mathrm{MPa} \\le 0$。该步为弹性步。\n- 状态更新：\n  - $\\sigma_{1} = 126\\,\\mathrm{MPa}$\n  - $\\epsilon^{p}_{1} = \\epsilon^{p}_{0} = 0$\n  - $\\epsilon^{e}_{1} = \\sigma_{1}/E = (126 \\times 10^{6}) / (210 \\times 10^{9}) = 6.0 \\times 10^{-4}$\n  - $\\epsilon_{1} = 6.0 \\times 10^{-4}$\n\n步骤 $k=2$：$\\Delta \\epsilon_{2} = 7.0 \\times 10^{-4}$\n- 总应变：$\\epsilon_{2} = \\epsilon_{1} + \\Delta \\epsilon_{2} = 6.0 \\times 10^{-4} + 7.0 \\times 10^{-4} = 1.3 \\times 10^{-3}$。\n- 弹性预测：$\\sigma^{\\text{trial}}_{2} = \\sigma_{1} + E\\,\\Delta\\epsilon_{2} = 126\\,\\mathrm{MPa} + (210 \\times 10^{9}\\,\\mathrm{Pa})(7.0 \\times 10^{-4}) = 126\\,\\mathrm{MPa} + 147\\,\\mathrm{MPa} = 273\\,\\mathrm{MPa}$。\n- 屈服检查：$f^{\\text{trial}}_{2} = 273\\,\\mathrm{MPa} - 250\\,\\mathrm{MPa} = 23\\,\\mathrm{MPa} > 0$。该步为弹塑性步。\n- 状态更新（塑性修正）：\n  - $\\sigma_{2} = \\sigma_{y} = 250\\,\\mathrm{MPa}$\n  - $\\epsilon^{e}_{2} = \\sigma_{y}/E = 1.190476... \\times 10^{-3}$\n  - $\\epsilon^{p}_{2} = \\epsilon_{2} - \\epsilon^{e}_{2} = 1.3 \\times 10^{-3} - 1.190476... \\times 10^{-3} = 0.1095238... \\times 10^{-3}$\n  - $\\epsilon_{2} = 1.3 \\times 10^{-3}$\n\n步骤 $k=3$：$\\Delta \\epsilon_{3} = 4.0 \\times 10^{-4}$\n- 总应变：$\\epsilon_{3} = \\epsilon_{2} + \\Delta \\epsilon_{3} = 1.3 \\times 10^{-3} + 4.0 \\times 10^{-4} = 1.7 \\times 10^{-3}$。\n- 弹性预测：由于状态已在屈服面上，并且我们施加了更大的拉伸应变，显然材料将继续屈服。然而，为了严谨起见，我们仍应用该算法。\n  $\\sigma^{\\text{trial}}_{3} = \\sigma_{2} + E\\,\\Delta\\epsilon_{3} = 250\\,\\mathrm{MPa} + (210 \\times 10^{9}\\,\\mathrm{Pa})(4.0 \\times 10^{-4}) = 250\\,\\mathrm{MPa} + 84\\,\\mathrm{MPa} = 334\\,\\mathrm{MPa}$。\n- 屈服检查：$f^{\\text{trial}}_{3} = 334\\,\\mathrm{MPa} - 250\\,\\mathrm{MPa} = 84\\,\\mathrm{MPa} > 0$。该步为弹塑性步。\n- 状态更新：\n  - $\\sigma_{3} = \\sigma_{y} = 250\\,\\mathrm{MPa}$\n  - $\\epsilon^{e}_{3} = \\sigma_{y}/E = 1.190476... \\times 10^{-3}$\n  - $\\epsilon^{p}_{3} = \\epsilon_{3} - \\epsilon^{e}_{3} = 1.7 \\times 10^{-3} - 1.190476... \\times 10^{-3} = 0.5095238... \\times 10^{-3}$\n  - $\\epsilon_{3} = 1.7 \\times 10^{-3}$\n\n步骤 $k=4$：$\\Delta \\epsilon_{4} = 2.5 \\times 10^{-4}$\n- 总应变：$\\epsilon_{4} = \\epsilon_{3} + \\Delta \\epsilon_{4} = 1.7 \\times 10^{-3} + 2.5 \\times 10^{-4} = 1.95 \\times 10^{-3}$。\n- 弹性预测：$\\sigma^{\\text{trial}}_{4} = \\sigma_{3} + E\\,\\Delta\\epsilon_{4} = 250\\,\\mathrm{MPa} + (210 \\times 10^{9}\\,\\mathrm{Pa})(2.5 \\times 10^{-4}) = 250\\,\\mathrm{MPa} + 52.5\\,\\mathrm{MPa} = 302.5\\,\\mathrm{MPa}$。\n- 屈服检查：$f^{\\text{trial}}_{4} = 302.5\\,\\mathrm{MPa} - 250\\,\\mathrm{MPa} = 52.5\\,\\mathrm{MPa} > 0$。该步为弹塑性步。\n- 状态更新：\n  - $\\sigma_{4} = \\sigma_{y} = 250\\,\\mathrm{MPa}$\n  - $\\epsilon^{e}_{4} = \\sigma_{y}/E = 1.190476... \\times 10^{-3}$\n  - $\\epsilon^{p}_{4} = \\epsilon_{4} - \\epsilon^{e}_{4} = 1.95 \\times 10^{-3} - 1.19047619... \\times 10^{-3} = 0.75952380... \\times 10^{-3}$\n  - $\\epsilon_{4} = 1.95 \\times 10^{-3}$\n\n步骤 4 结束时的最终塑性应变为 $\\epsilon^{p}_{4} = 0.75952380... \\times 10^{-3}$。问题要求该值以小数形式表示，并四舍五入到六位有效数字。\n$\\epsilon^{p}_{4} \\approx 0.000759524$。", "answer": "$$\n\\boxed{0.000759524}\n$$", "id": "2893807"}, {"introduction": "真实世界的工程构件经常承受复杂的、主轴方向随时间变化的多轴应力状态。这个思想实验将我们的分析从一维提升到通用的三维偏应力空间，以研究非比例加载下塑性流动的方向性。通过分析塑性应变增量如何响应屈服面上应力矢量的旋转，你将推导并应用著名的 Prandtl-Reuss 流动法则，这是 $J_2$ 塑性理论的基石之一。[@problem_id:2893825]", "problem": "考虑一个满足率无关、小应变、各向同性硬化的弹塑性实体，其遵循基于偏应力第二不变量（$J_{2}$）的塑性理论和相关联的流动法则。设柯西应力为 $\\boldsymbol{\\sigma}$，偏应力为 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\tfrac{1}{3}(\\operatorname{tr}\\boldsymbol{\\sigma})\\boldsymbol{I}$，第二不变量为 $J_{2} = \\tfrac{1}{2}\\boldsymbol{s}:\\boldsymbol{s}$。屈服函数的形式为 $f(\\boldsymbol{\\sigma},\\kappa) = \\sqrt{\\tfrac{3}{2}}\\|\\boldsymbol{s}\\| - \\sigma_{y}(\\kappa)$，其中 $\\kappa$ 是一个标量硬化变量，$\\sigma_{y}(\\kappa)$ 是当前屈服应力。塑性势与屈服函数相等（关联流动），且塑性应变增量满足 $\\mathrm{d}\\boldsymbol{\\varepsilon}^{p} \\propto \\partial f/\\partial \\boldsymbol{\\sigma}$。假设加载过程使得一旦开始屈服，状态便保持在屈服面上。\n\n在偏应力（$\\pi$-）平面中设计以下非比例加载路径，其中每个点代表 $\\boldsymbol{s}$ 的投影：\n步骤 1（径向）：从原点开始，沿固定方向增加偏应力 $\\boldsymbol{s}$，直至在 A 点达到屈服面。A 点位于极角 $\\varphi_{A}$（在 $\\pi$-平面中测量）处，其极径等于当前屈服半径。\n步骤 2（周向）：保持 $\\|\\boldsymbol{s}\\|$ 的大小等于当前屈服半径（即保持在屈服面上），在 $\\pi$-平面中将 $\\boldsymbol{s}$ 旋转一个角度 $\\Delta\\varphi = 37$ 度，到达 B 点。\n\n从上述基本定义出发，推导该关联 $J_{2}$ 塑性模型中塑性应变增量 $\\mathrm{d}\\boldsymbol{\\varepsilon}^{p}$ 相对于 $\\boldsymbol{s}$ 的方向，并确定在所描述的加载路径下，A 点和 B 点处 $\\mathrm{d}\\boldsymbol{\\varepsilon}^{p}$ 方向之间的夹角（以弧度为单位）。将你的最终答案以弧度表示，并四舍五入到四位有效数字。", "solution": "此问题要求我们分析关联 $J_2$ 塑性模型中塑性应变增量的方向，然后计算在指定的非比例加载路径上两个不同点处的塑性流动方向之间的夹角。\n\n首先，我们必须确定塑性应变增量 $\\mathrm{d}\\boldsymbol{\\varepsilon}^{p}$ 的方向。问题指出，该材料遵循关联流动法则，这意味着塑性势与屈服函数 $f(\\boldsymbol{\\sigma},\\kappa)$ 相同。塑性应变增量由流动法则给出：\n$$\n\\mathrm{d}\\boldsymbol{\\varepsilon}^{p} = \\mathrm{d}\\lambda \\, \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}\n$$\n其中 $\\mathrm{d}\\lambda \\ge 0$ 是塑性乘子，一个表示塑性流动大小的标量。因此，$\\mathrm{d}\\boldsymbol{\\varepsilon}^{p}$ 的方向由屈服函数相对于柯西应力 $\\boldsymbol{\\sigma}$ 的梯度 $\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$ 决定。\n\n屈服函数为：\n$$\nf(\\boldsymbol{\\sigma},\\kappa) = \\sqrt{\\frac{3}{2}}\\|\\boldsymbol{s}\\| - \\sigma_{y}(\\kappa)\n$$\n其中 $\\boldsymbol{s}$ 是偏应力张量。我们可以用 Frobenius 范数来表示偏应力的范数 $\\|\\boldsymbol{s}\\|$，其定义为 $\\|\\boldsymbol{s}\\| = \\sqrt{\\boldsymbol{s}:\\boldsymbol{s}}$。屈服函数可以重写为：\n$$\nf(\\boldsymbol{\\sigma},\\kappa) = \\sqrt{\\frac{3}{2}}(\\boldsymbol{s}:\\boldsymbol{s})^{\\frac{1}{2}} - \\sigma_{y}(\\kappa)\n$$\n为了找到塑性流动的方向，我们计算 $f$ 对 $\\boldsymbol{\\sigma}$ 的偏导数。硬化参数 $\\kappa$ 是塑性应变路径的函数，但在计算特定状态下 $f$ 对应力的梯度时，$\\kappa$ 被视为常数。因此，项 $\\sigma_{y}(\\kappa)$ 对相对于 $\\boldsymbol{\\sigma}$ 的梯度没有贡献。\n使用张量微积分的链式法则，梯度为：\n$$\n\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\sqrt{\\frac{3}{2}} \\cdot \\frac{1}{2} (\\boldsymbol{s}:\\boldsymbol{s})^{-\\frac{1}{2}} \\cdot \\frac{\\partial(\\boldsymbol{s}:\\boldsymbol{s})}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\sqrt{3}}{2\\sqrt{2}\\|\\boldsymbol{s}\\|} \\frac{\\partial(\\boldsymbol{s}:\\boldsymbol{s})}{\\partial \\boldsymbol{\\sigma}}\n$$\n我们需要计算 $\\frac{\\partial(\\boldsymbol{s}:\\boldsymbol{s})}{\\partial \\boldsymbol{\\sigma}}$。用分量形式表示，即为 $\\frac{\\partial(s_{kl}s_{kl})}{\\partial \\sigma_{ij}}$。\n$$\n\\frac{\\partial(s_{kl}s_{kl})}{\\partial \\sigma_{ij}} = 2 s_{kl} \\frac{\\partial s_{kl}}{\\partial \\sigma_{ij}}\n$$\n偏应力 $\\boldsymbol{s}$ 定义为 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}(\\operatorname{tr}\\boldsymbol{\\sigma})\\boldsymbol{I}$。用分量表示为 $s_{kl} = \\sigma_{kl} - \\frac{1}{3}\\sigma_{mm}\\delta_{kl}$。它对 $\\sigma_{ij}$ 的导数为：\n$$\n\\frac{\\partial s_{kl}}{\\partial \\sigma_{ij}} = \\frac{\\partial}{\\partial \\sigma_{ij}} \\left(\\sigma_{kl} - \\frac{1}{3}\\sigma_{mm}\\delta_{kl}\\right) = \\delta_{ki}\\delta_{lj} - \\frac{1}{3}\\delta_{mi}\\delta_{mj}\\delta_{kl} = \\delta_{ki}\\delta_{lj} - \\frac{1}{3}\\delta_{ij}\\delta_{kl}\n$$\n将此代入范数平方的梯度表达式中：\n$$\ns_{kl} \\frac{\\partial s_{kl}}{\\partial \\sigma_{ij}} = s_{kl} \\left( \\delta_{ki}\\delta_{lj} - \\frac{1}{3}\\delta_{ij}\\delta_{kl} \\right) = s_{ij} - \\frac{1}{3}\\delta_{ij}s_{kk}\n$$\n由于 $\\boldsymbol{s}$ 是一个偏量张量，其迹为零，即 $s_{kk} = \\operatorname{tr}(\\boldsymbol{s}) = 0$。因此：\n$$\ns_{kl} \\frac{\\partial s_{kl}}{\\partial \\sigma_{ij}} = s_{ij}\n$$\n用无下标的符号表示，即为 $\\frac{1}{2}\\frac{\\partial(\\boldsymbol{s}:\\boldsymbol{s})}{\\partial \\boldsymbol{\\sigma}} = \\boldsymbol{s}$。\n将此结果代回到 $\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$ 的表达式中：\n$$\n\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\sqrt{3}}{2\\sqrt{2}\\|\\boldsymbol{s}\\|} (2\\boldsymbol{s}) = \\sqrt{\\frac{3}{2}} \\frac{\\boldsymbol{s}}{\\|\\boldsymbol{s}\\|}\n$$\n因此流动法则变为：\n$$\n\\mathrm{d}\\boldsymbol{\\varepsilon}^{p} = \\mathrm{d}\\lambda \\sqrt{\\frac{3}{2}} \\frac{\\boldsymbol{s}}{\\|\\boldsymbol{s}\\|}\n$$\n此结果表明，对于关联 $J_2$ 塑性模型，塑性应变增量张量 $\\mathrm{d}\\boldsymbol{\\varepsilon}^{p}$ 始终与偏应力张量 $\\boldsymbol{s}$ 共轴（即方向相同）。这就是 Prandtl-Reuss 流动法则。$\\mathrm{d}\\boldsymbol{\\varepsilon}^{p}$ 的方向完全由 $\\boldsymbol{s}$ 的方向决定。\n\n现在，我们解决问题的第二部分。我们需要找出加载路径上 A 点和 B 点处塑性应变增量方向之间的夹角。设这两点的偏应力张量分别为 $\\boldsymbol{s}_A$ 和 $\\boldsymbol{s}_B$。\nA 点处塑性应变增量的方向，记为 $\\boldsymbol{N}_A$，是：\n$$\n\\boldsymbol{N}_A = \\frac{\\boldsymbol{s}_A}{\\|\\boldsymbol{s}_A\\|}\n$$\n同样地，B 点处塑性应变增量的方向，记为 $\\boldsymbol{N}_B$，是：\n$$\n\\boldsymbol{N}_B = \\frac{\\boldsymbol{s}_B}{\\|\\boldsymbol{s}_B\\|}\n$$\n这两个方向张量 $\\boldsymbol{N}_A$ 和 $\\boldsymbol{N}_B$ 之间的夹角 $\\psi$ 由它们的内积定义：\n$$\n\\cos \\psi = \\boldsymbol{N}_A : \\boldsymbol{N}_B = \\frac{\\boldsymbol{s}_A}{\\|\\boldsymbol{s}_A\\|} : \\frac{\\boldsymbol{s}_B}{\\|\\boldsymbol{s}_B\\|} = \\frac{\\boldsymbol{s}_A : \\boldsymbol{s}_B}{\\|\\boldsymbol{s}_A\\| \\|\\boldsymbol{s}_B\\|}\n$$\n右侧的项恰好是偏应力张量 $\\boldsymbol{s}_A$ 和 $\\boldsymbol{s}_B$ 在偏量张量的 5 维空间中夹角的余弦值。\n\n问题描述了在偏应力（$\\pi$-）平面中的加载路径。该平面中的一个点代表一个偏应力状态，其到原点的距离对应于 $\\sqrt{2J_2} = \\|\\boldsymbol{s}\\|$，其角位置描述了应力状态的性质（例如，单轴拉伸、纯剪切）。问题指出，从 A 点到 B 点，偏应力 $\\boldsymbol{s}$ 在 $\\pi$-平面中旋转了一个角度 $\\Delta\\varphi = 37$ 度。在 $\\pi$-平面中的这种几何旋转对应于张量 $\\boldsymbol{s}_A$ 和 $\\boldsymbol{s}_B$ 在其抽象向量空间中的夹角。设 $\\boldsymbol{s}_A$ 和 $\\boldsymbol{s}_B$ 之间的夹角为 $\\theta$。那么 $\\cos\\theta = \\frac{\\boldsymbol{s}_A : \\boldsymbol{s}_B}{\\|\\boldsymbol{s}_A\\| \\|\\boldsymbol{s}_B\\|}$。加载路径的描述意味着这个角度 $\\theta$ 等于 $\\Delta\\varphi$。\n因此，$\\cos \\psi = \\cos(\\Delta\\varphi)$，这意味着 $\\psi = \\Delta\\varphi$。\n\nA 点和 B 点处塑性应变增量方向之间的夹角等于偏应力张量在 $\\pi$-平面中旋转的角度。\n给定 $\\Delta\\varphi = 37$ 度。我们必须将此角度表示为弧度。\n$$\n\\psi = 37^{\\circ} \\times \\frac{\\pi}{180^{\\circ}} \\text{ radians}\n$$\n计算数值：\n$$\n\\psi = \\frac{37\\pi}{180} \\approx 0.6457718... \\text{ radians}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n\\psi \\approx 0.6458 \\text{ radians}\n$$", "answer": "$$\n\\boxed{0.6458}\n$$", "id": "2893825"}, {"introduction": "本构模型的选择必须反映材料的内在物理机制。这个综合性练习对比了适用于金属的压力无关 von Mises ($J_2$) 模型和对于土、岩石等岩土材料至关重要的压力相关 Drucker-Prager 模型。通过推导和实现两种模型的返回映射算法，你将理解为何压力敏感性与塑性体积应变（剪胀性）密不可分，这一关键区别主导了广泛工程应用中的力学响应。[@problem_id:2893781]", "problem": "要求您从第一性原理出发，为一个相关的 Drucker–Prager (DP) 塑性模型开发一个隐式后向欧拉返回映射算法，并将其与经典的 von Mises (也称为第二偏应力不变量或 $J_{2}$) 径向返回算法进行对比。您的推导和实现必须统一使用小应变各向同性线弹性理论和标准应力不变量。具体而言，您需要从以下基本依据和核心定义出发，不得引用任何预先推导好的更新公式。\n\n假设与定义：\n- 使用小应变运动学和各向同性线弹性理论，其中杨氏模量为 $E$，泊松比为 $\\nu$。拉梅常数为 $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu = \\dfrac{E}{2(1+\\nu)}$，体积模量为 $K = \\lambda + \\dfrac{2}{3}\\mu$。\n- 对柯西应力 $\\boldsymbol{\\sigma}$ 采用拉为正的符号约定。定义平均（压力）应力 $p$ 为 $p = -\\dfrac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma})$，因此 $p$ 在受压时为正。定义偏应力 $\\mathbf{s} = \\boldsymbol{\\sigma} - \\dfrac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma}) \\mathbf{I}$。定义等效应力 $q = \\sqrt{\\dfrac{3}{2}} \\lVert \\mathbf{s} \\rVert$，其中 $\\lVert \\cdot \\rVert$ 表示 Frobenius 范数。\n- Drucker–Prager 屈服函数为 $f_{\\mathrm{DP}}(\\boldsymbol{\\sigma}, \\bar{\\varepsilon}^{p}) = q + \\alpha p - \\left(k_{0} + H \\bar{\\varepsilon}^{p}\\right)$，其中 $\\alpha$ 为摩擦参数，$k_{0}$ 为初始类粘聚力参数，$H$ 为各向同性硬化模量，$\\bar{\\varepsilon}^{p}$ 为等效塑性应变。\n- von Mises ($J_{2}$) 屈服函数为 $f_{J_{2}}(\\boldsymbol{\\sigma}, \\bar{\\varepsilon}^{p}) = q - \\left(k_{0} + H \\bar{\\varepsilon}^{p}\\right)$。\n- 对两种模型均使用相关联塑性流动法则；即，塑性流动方向等于相应屈服函数对应力 $\\boldsymbol{\\sigma}$ 的梯度。对塑性修正步使用隐式后向欧拉时间离散化方法。\n- 弹性试探状态通过 $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\boldsymbol{\\sigma}_{n} + \\mathbb{C} : \\Delta \\boldsymbol{\\varepsilon}$ 获得，其中 $\\mathbb{C}$ 是弹性刚度张量，$\\Delta \\boldsymbol{\\varepsilon}$ 是总应变增量。仅当试探屈服函数值为正时，才需要进行塑性修正。\n\n任务：\n1. 从上述定义和相关联流动法则的最大塑性耗散原理出发，使用隐式后向欧拉格式推导 Drucker–Prager 模型的返回映射方程。您的推导必须明确地体现由参数 $\\alpha$ 引入的 $p$ 和 $q$ 之间的耦合关系，并且必须用标量塑性乘子增量 $\\Delta \\gamma$ 来表示。\n2. 从相同的基础出发，推导 von Mises ($J_{2}$) 模型的返回映射方程，强调其在偏应力空间中的径向返回结构，并解释为何在 $J_{2}$ 模型的塑性修正步中静水应力 $p$ 保持不变。\n3. 在控制更新方程的层面上，解释 Drucker–Prager 模型中 $p$ 和 $q$ 之间的耦合是如何以及为何在修正步中产生非零的体积塑性应变增量和 $p$ 的变化，而这与 $J_{2}$ 模型的情况形成对比。\n\n实现要求：\n- 实现一个程序，该程序针对下方的每个测试用例，计算在单个应变增量 $\\Delta \\boldsymbol{\\varepsilon}$ 作用后更新的 Drucker–Prager 和 von Mises 状态。假设初始应力为零，每个测试用例会给出初始等效塑性应变 $\\bar{\\varepsilon}^{p}_{n}$。使用一个 $3 \\times 3$ 的对称应变张量，其剪切分量为张量分量（而非工程剪切应变）。根据更新后的应力，报告不变量 $p$ 和 $q$、更新后的等效塑性应变 $\\bar{\\varepsilon}^{p}$ 以及塑性乘子增量 $\\Delta \\gamma$。如果该步为弹性步，则报告 $\\Delta \\gamma = 0$。\n- 物理单位：所有应力（$E$、$k_{0}$、$H$、$p$、$q$）均使用兆帕 (MPa)。应变和 $\\bar{\\varepsilon}^{p}$ 是无量纲的。所有浮点数输出均需四舍五入到恰好六位小数。\n- 角度单位在本问题中不适用。\n\n测试套件：\n为以下四个测试用例提供结果。对于每个用例，输入元组为 ($E$, $\\nu$, $k_0$, $H$, $\\alpha$, $\\bar{\\varepsilon}^p_n$, $\\Delta \\boldsymbol{\\varepsilon}$)，其中 $\\Delta \\boldsymbol{\\varepsilon}$ 以张量剪切分量 ($\\varepsilon_{11}$, $\\varepsilon_{22}$, $\\varepsilon_{33}$, $\\varepsilon_{12}$, $\\varepsilon_{23}$, $\\varepsilon_{13}$) 的形式给出：\n- 用例 1： ($E$, $\\nu$, $k_0$, $H$, $\\alpha$, $\\bar{\\varepsilon}^p_n$, $\\Delta \\boldsymbol{\\varepsilon}$) = (210000, 0.3, 200, 1000, 0.1, 0, ($1\\times 10^{-6}$, $1\\times 10^{-6}$, $1\\times 10^{-6}$, 0, 0, 0))\n- 用例 2： ($E$, $\\nu$, $k_0$, $H$, $\\alpha$, $\\bar{\\varepsilon}^p_n$, $\\Delta \\boldsymbol{\\varepsilon}$) = (210000, 0.3, 200, 1000, 0.1, 0, (0, 0, 0, $1\\times 10^{-3}$, 0, 0))\n- 用例 3： ($E$, $\\nu$, $k_0$, $H$, $\\alpha$, $\\bar{\\varepsilon}^p_n$, $\\Delta \\boldsymbol{\\varepsilon}$) = (210000, 0.29, 20, 100, 0.3, 0, ($-5\\times 10^{-3}$, $-5\\times 10^{-3}$, $-5\\times 10^{-3}$, 0, 0, 0))\n- 用例 4： ($E$, $\\nu$, $k_0$, $H$, $\\alpha$, $\\bar{\\varepsilon}^p_n$, $\\Delta \\boldsymbol{\\varepsilon}$) = (70000, 0.25, 100, 500, 0.2, 0.05, ($4\\times 10^{-4}$, $-1\\times 10^{-4}$, 0, $3\\times 10^{-4}$, 0, 0))\n\n对于每个用例，计算以下两组值：\n- Drucker–Prager 更新后的不变量和塑性量： ($p_{\\mathrm{DP}}, q_{\\mathrm{DP}}, \\bar{\\varepsilon}^{p}_{\\mathrm{DP}}, \\Delta \\gamma_{\\mathrm{DP}}$)\n- von Mises ($J_{2}$) 更新后的不变量和塑性量： ($p_{J_{2}}, q_{J_{2}}, \\bar{\\varepsilon}^{p}_{J_{2}}, \\Delta \\gamma_{J_{2}}$)\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果。每个测试用例对应一个内部列表，该列表按以下顺序包含恰好八个浮点数：\n$[\\,p_{\\mathrm{DP}}, q_{\\mathrm{DP}}, \\bar{\\varepsilon}^{p}_{\\mathrm{DP}}, \\Delta \\gamma_{\\mathrm{DP}}, p_{J_{2}}, q_{J_{2}}, \\bar{\\varepsilon}^{p}_{J_{2}}, \\Delta \\gamma_{J_{2}}\\,]$。\n因此，完整输出是一个包含四个此类内部列表的列表： $[\\,[\\cdot],\\,[\\cdot],\\,[\\cdot],\\,[\\cdot]\\,]$。所有应力必须以 MPa 为单位，所有数字必须四舍五入到恰好六位小数，不得包含任何额外文本。", "solution": "本问题要求推导并实现 Drucker-Prager 和 von Mises 塑性模型的返回映射算法。分析必须从第一性原理出发，假设采用小应变各向同性线弹性理论和隐式后向欧拉积分格式。\n\n增量弹塑性框架的基础是总应变增量 $\\Delta\\boldsymbol{\\varepsilon}$ 分解为弹性部分 $\\Delta\\boldsymbol{\\varepsilon}^e$ 和塑性部分 $\\Delta\\boldsymbol{\\varepsilon}^p$ 的加法形式：\n$$\n\\Delta\\boldsymbol{\\varepsilon} = \\Delta\\boldsymbol{\\varepsilon}^e + \\Delta\\boldsymbol{\\varepsilon}^p\n$$\n增量步结束时的应力 $\\boldsymbol{\\sigma}_{n+1}$ 通过各向同性线弹性定律与弹性应变 $\\boldsymbol{\\varepsilon}^e_{n+1}$ 相关联：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\mathbb{C} : \\boldsymbol{\\varepsilon}^e_{n+1} = \\mathbb{C} : (\\boldsymbol{\\varepsilon}^e_n + \\Delta\\boldsymbol{\\varepsilon}^e)\n$$\n其中 $\\mathbb{C}$ 是四阶弹性刚度张量。代入 $\\Delta\\boldsymbol{\\varepsilon}^e = \\Delta\\boldsymbol{\\varepsilon} - \\Delta\\boldsymbol{\\varepsilon}^p$ 并考虑到 $\\boldsymbol{\\sigma}_n = \\mathbb{C}:\\boldsymbol{\\varepsilon}^e_n$，我们得到应力更新关系：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_n + \\mathbb{C}:\\Delta\\boldsymbol{\\varepsilon} - \\mathbb{C}:\\Delta\\boldsymbol{\\varepsilon}^p\n$$\n该关系是返回映射算法的核心。该过程首先计算一个弹性试探应力 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$，假设整个应变增量都是弹性的 ($\\Delta\\boldsymbol{\\varepsilon}^p = \\mathbf{0}$)：\n$$\n\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\boldsymbol{\\sigma}_n + \\mathbb{C} : \\Delta\\boldsymbol{\\varepsilon}\n$$\n于是应力更新变为：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\mathbb{C} : \\Delta\\boldsymbol{\\varepsilon}^p\n$$\n只有当试探状态违反屈服条件时，才会发生塑性变形。对于一个通用的屈服函数 $f(\\boldsymbol{\\sigma}, \\bar{\\varepsilon}^p)$，如果 $f(\\boldsymbol{\\sigma}^{\\mathrm{tr}}, \\bar{\\varepsilon}^p_n) > 0$，则塑性开始发生。如果该条件成立，则进行塑性修正。\n\n塑性应变增量由相关联流动法则确定，并使用隐式后向欧拉格式进行离散化：\n$$\n\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\gamma \\mathbf{N}_{n+1} \\quad \\text{其中} \\quad \\mathbf{N}_{n+1} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} \\bigg|_{\\boldsymbol{\\sigma}_{n+1}}\n$$\n此处，$\\Delta\\gamma \\ge 0$ 是标量塑性乘子增量。各向同性硬化变量，即等效塑性应变 $\\bar{\\varepsilon}^p$ 的演化由 $\\Delta\\bar{\\varepsilon}^p = \\Delta\\gamma$ 给出。对于所选的屈服函数形式，这可从最大塑性耗散原理得出。\n\n最终状态 $(\\boldsymbol{\\sigma}_{n+1}, \\bar{\\varepsilon}^p_{n+1})$ 必须满足 Karush-Kuhn-Tucker (KKT) 条件：\n$f(\\boldsymbol{\\sigma}_{n+1}, \\bar{\\varepsilon}^p_{n+1}) \\le 0$, $\\Delta\\gamma \\ge 0$, 且 $\\Delta\\gamma f(\\boldsymbol{\\sigma}_{n+1}, \\bar{\\varepsilon}^p_{n+1}) = 0$。对于塑性步，这意味着最终状态必须位于更新后的屈服面上：$f_{n+1}=0$。\n\n对于各向同性弹性体，刚度张量对任意二阶张量 $\\mathbf{A}$ 的作用形式为 $\\mathbb{C} : \\mathbf{A} = \\lambda \\operatorname{tr}(\\mathbf{A})\\mathbf{I} + 2\\mu\\mathbf{A}$。应力更新可以分解为体积和偏量部分。平均压力 $p = -\\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})$ 和偏应力 $\\mathbf{s}$ 的更新如下：\n$$\np_{n+1} = p^{\\mathrm{tr}} + K \\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^p)\n$$\n$$\n\\mathbf{s}_{n+1} = \\mathbf{s}^{\\mathrm{tr}} - 2\\mu \\Delta\\boldsymbol{\\varepsilon}^p_{\\mathrm{dev}}\n$$\n其中 $K$ 是体积模量，$\\Delta\\boldsymbol{\\varepsilon}^p_{\\mathrm{dev}}$ 是塑性应变增量的偏量部分，试探状态的各量由 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$ 计算得到。注意 $p$ 的符号约定：$p_{n+1} = -\\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma}_{n+1})$ 且 $p^{\\mathrm{tr}} = -\\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma}^{\\mathrm{tr}})$。压力更新的推导可从 $\\operatorname{tr}(\\boldsymbol{\\sigma}_{n+1}) = \\operatorname{tr}(\\boldsymbol{\\sigma}^{\\mathrm{tr}}) - \\operatorname{tr}(\\mathbb{C}:\\Delta\\boldsymbol{\\varepsilon}^p)$ 开始。由于 $\\operatorname{tr}(\\mathbb{C}:\\Delta\\boldsymbol{\\varepsilon}^p) = 3K \\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^p)$，两侧同除以 $-3$ 得到 $p_{n+1} = p^{\\mathrm{tr}} + K \\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^p)$，这似乎与某些文献中的形式不同。为了确保正确性，我们从基本关系重新推导：$p_{n+1} - p^{\\mathrm{tr}} = -K(\\operatorname{tr}(\\boldsymbol{\\varepsilon}^e_{n+1}) - \\operatorname{tr}(\\boldsymbol{\\varepsilon}^e_{\\mathrm{tr}})) = -K \\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^e_{\\text{corr}})$。在修正步中，总应变增量是固定的，因此弹性应变修正量与塑性应变增量之和为零: $\\Delta\\boldsymbol{\\varepsilon}^e_{\\text{corr}} + \\Delta\\boldsymbol{\\varepsilon}^p_{\\text{corr}} = \\mathbf{0}$。由于试探步的塑性应变为零，$\\Delta\\boldsymbol{\\varepsilon}^p_{\\text{corr}} = \\Delta\\boldsymbol{\\varepsilon}^p_{n+1}$，故 $\\Delta\\boldsymbol{\\varepsilon}^e_{\\text{corr}} = -\\Delta\\boldsymbol{\\varepsilon}^p_{n+1}$。代入压力更新表达式，得 $p_{n+1} - p^{\\mathrm{tr}} = -K \\operatorname{tr}(-\\Delta\\boldsymbol{\\varepsilon}^p_{n+1}) = K\\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^p)$。此推导是可靠的。因此，正确的压力更新方程为 $p_{n+1} = p^{\\mathrm{tr}} + K \\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^p)$。\n\n### 任务1：Drucker–Prager 返回映射\n\nDP 屈服函数为 $f_{\\mathrm{DP}} = q + \\alpha p - k(\\bar{\\varepsilon}^p)$，其中 $k(\\bar{\\varepsilon}^p) = k_0 + H\\bar{\\varepsilon}^p$。\n$f_{\\mathrm{DP}}$ 对应力 $\\boldsymbol{\\sigma}$ 的梯度定义了塑性流动方向 $\\mathbf{N}$：\n$$\n\\mathbf{N} = \\frac{\\partial f_{\\mathrm{DP}}}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} + \\alpha \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2q}\\mathbf{s} - \\frac{\\alpha}{3}\\mathbf{I}\n$$\n塑性应变增量为 $\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\gamma \\mathbf{N}_{n+1} = \\Delta\\gamma \\left( \\frac{3}{2q_{n+1}}\\mathbf{s}_{n+1} - \\frac{\\alpha}{3}\\mathbf{I} \\right)$。\n塑性应变增量的迹为 $\\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^p) = \\Delta\\gamma \\operatorname{tr}(\\mathbf{N}_{n+1}) = \\Delta\\gamma (-\\alpha) = -\\alpha \\Delta\\gamma$。\n其偏量部分为 $\\Delta\\boldsymbol{\\varepsilon}^p_{\\mathrm{dev}} = \\Delta\\gamma \\frac{3}{2q_{n+1}}\\mathbf{s}_{n+1}$。\n\n将这些代入分解后的应力更新方程：\n1.  压力更新：$p_{n+1} = p^{\\mathrm{tr}} + K \\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^p) = p^{\\mathrm{tr}} - K\\alpha\\Delta\\gamma$。\n2.  偏应力更新：$\\mathbf{s}_{n+1} = \\mathbf{s}^{\\mathrm{tr}} - 2\\mu \\left( \\Delta\\gamma \\frac{3}{2q_{n+1}}\\mathbf{s}_{n+1} \\right) = \\mathbf{s}^{\\mathrm{tr}} - \\frac{3\\mu\\Delta\\gamma}{q_{n+1}}\\mathbf{s}_{n+1}$。\n第二个关系式表明 $\\mathbf{s}_{n+1}$ 与 $\\mathbf{s}^{\\mathrm{tr}}$ 共轴，即 $\\mathbf{s}_{n+1} \\left(1 + \\frac{3\\mu\\Delta\\gamma}{q_{n+1}}\\right) = \\mathbf{s}^{\\mathrm{tr}}$。取范数并转换为 $q = \\sqrt{3/2}\\|\\mathbf{s}\\|$：\n$q_{n+1} \\left(1 + \\frac{3\\mu\\Delta\\gamma}{q_{n+1}}\\right) = q^{\\mathrm{tr}}$，可简化为 $q_{n+1} + 3\\mu\\Delta\\gamma = q^{\\mathrm{tr}}$，或 $q_{n+1} = q^{\\mathrm{tr}} - 3\\mu\\Delta\\gamma$。\n\n我们现在得到了一个关于 $p_{n+1}$ 和 $q_{n+1}$（用 $\\Delta\\gamma$ 表示）的代数方程组，外加一个一致性条件 $f_{\\mathrm{DP}}(\\boldsymbol{\\sigma}_{n+1}, \\bar{\\varepsilon}^p_{n+1}) = 0$：\n$$\n\\begin{cases}\np_{n+1} = p^{\\mathrm{tr}} - K\\alpha\\Delta\\gamma \\\\\nq_{n+1} = q^{\\mathrm{tr}} - 3\\mu\\Delta\\gamma \\\\\nq_{n+1} + \\alpha p_{n+1} - \\left(k_0 + H(\\bar{\\varepsilon}^p_n + \\Delta\\gamma)\\right) = 0\n\\end{cases}\n$$\n将前两个方程代入第三个，得到一个关于 $\\Delta\\gamma$ 的单一方程：\n$$\n(q^{\\mathrm{tr}} - 3\\mu\\Delta\\gamma) + \\alpha(p^{\\mathrm{tr}} - K\\alpha\\Delta\\gamma) - \\left(k_0 + H\\bar{\\varepsilon}^p_n + H\\Delta\\gamma\\right) = 0\n$$\n重新整理以求解 $\\Delta\\gamma$：\n$$\n(q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - (k_0 + H\\bar{\\varepsilon}^p_n)) - \\Delta\\gamma(3\\mu + K\\alpha^2 + H) = 0\n$$\n第一项是试探屈服函数值，$f^{\\mathrm{tr}}_{\\mathrm{DP}} = q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k_n$，其中 $k_n = k_0 + H\\bar{\\varepsilon}^p_n$。因此，塑性乘子为：\n$$\n\\Delta\\gamma = \\frac{f^{\\mathrm{tr}}_{\\mathrm{DP}}}{3\\mu + K\\alpha^2 + H}\n$$\n此表达式在 $f^{\\mathrm{tr}}_{\\mathrm{DP}} > 0$ 时有效。如果 $f^{\\mathrm{tr}}_{\\mathrm{DP}} \\le 0$，则该步为弹性步，$\\Delta\\gamma = 0$。\n\n### 任务2：von Mises ($J_{2}$) 返回映射\n\nvon Mises 屈服函数是 Drucker-Prager 在 $\\alpha = 0$ 时的特例：\n$$\nf_{J_2} = q - k(\\bar{\\varepsilon}^p)\n$$\n推导过程完全相同，只需在 DP 方程中令 $\\alpha=0$。\n塑性流动方向 $\\mathbf{N}$ 变为纯偏量形式：\n$$\n\\mathbf{N} = \\frac{\\partial f_{J_2}}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2q}\\mathbf{s}\n$$\n其迹为 $\\operatorname{tr}(\\mathbf{N}) = 0$。因此，体积塑性应变增量为零：$\\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^p) = 0$。\n不变量的更新方程变为：\n1.  压力更新：$p_{n+1} = p^{\\mathrm{tr}} + K \\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^p) = p^{\\mathrm{tr}}$。在塑性修正过程中压力不发生改变。\n2.  等效应力更新：$q_{n+1} = q^{\\mathrm{tr}} - 3\\mu\\Delta\\gamma$。此形式与 DP 模型中的形式相同。\n\n一致性条件为 $q_{n+1} - (k_n + H\\Delta\\gamma) = 0$。代入 $q_{n+1}$ 的更新式：\n$$\n(q^{\\mathrm{tr}} - 3\\mu\\Delta\\gamma) - (k_n + H\\Delta\\gamma) = 0\n$$\n求解 $\\Delta\\gamma$：\n$$\nq^{\\mathrm{tr}} - k_n = \\Delta\\gamma(3\\mu + H)\n$$\n$q^{\\mathrm{tr}} - k_n$ 项是试探屈服函数值 $f^{\\mathrm{tr}}_{J_2}$。因此：\n$$\n\\Delta\\gamma = \\frac{f^{\\mathrm{tr}}_{J_2}}{3\\mu + H}\n$$\n$\\mathbf{s}_{n+1}$ 的更新算法为 $\\mathbf{s}_{n+1} = \\mathbf{s}^{\\mathrm{tr}} \\left(1 - \\frac{3\\mu\\Delta\\gamma}{q^{\\mathrm{tr}}}\\right)$。这表明，修正后的偏应力 $\\mathbf{s}_{n+1}$ 是通过将试探偏应力 $\\mathbf{s}^{\\mathrm{tr}}$ 沿同一方向缩放回到屈服面上得到的。这种几何操作在偏应力空间中被称为“径向返回”。\n\n### 任务3：Drucker-Prager 与 von Mises 模型的比较\n\n两种模型之间的根本区别在于它们对静水应力分量的依赖性。\n\n对于 von Mises ($J_2$) 模型，其屈服函数 $f_{J_2} = q - k(\\bar{\\varepsilon}^p)$ 仅依赖于偏应力的第二不变量（由 $q$ 表示）。它与平均压力 $p$ 无关。因此，梯度 $\\mathbf{N}_{J_2} = \\partial f_{J_2} / \\partial\\boldsymbol{\\sigma}$ 是一个纯偏量张量，这意味着 $\\operatorname{tr}(\\mathbf{N}_{J_2}) = 0$。根据相关联流动法则，塑性应变增量 $\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\gamma \\mathbf{N}_{J_2}$ 也是纯偏量的，即 $\\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^p) = 0$。这意味着塑性流动是不可压缩的。压力更新方程 $p_{n+1} = p^{\\mathrm{tr}} + K\\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^p)$ 简化为 $p_{n+1} = p^{\\mathrm{tr}}$，这证实了压力不受塑性修正步的影响。\n\n对于 Drucker-Prager 模型，其屈服函数 $f_{\\mathrm{DP}} = q + \\alpha p - k(\\bar{\\varepsilon}^p)$ 包含了平均压力 $p$。这种由摩擦参数 $\\alpha \\ne 0$ 引入的耦合关系具有深远的影响。梯度 $\\mathbf{N}_{\\mathrm{DP}} = \\partial f_{\\mathrm{DP}} / \\partial\\boldsymbol{\\sigma}$ 现在包含一个体积部分：\n$$\n\\mathbf{N}_{\\mathrm{DP}} = \\frac{3}{2q}\\mathbf{s} - \\frac{\\alpha}{3}\\mathbf{I}\n$$\n其迹非零：$\\operatorname{tr}(\\mathbf{N}_{\\mathrm{DP}}) = -\\alpha$。这导致了一个非零的体积塑性应变增量：$\\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^p) = -\\alpha \\Delta\\gamma$。对于典型的岩土材料，$\\alpha > 0$，因此屈服会导致塑性压实（$\\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^p) < 0$）（当处于受压状态时），或剪胀（当处于受拉状态时），具体取决于 $p$ 的符号。压力更新方程 $p_{n+1} = p^{\\mathrm{tr}} - K\\alpha\\Delta\\gamma$ 明确显示了在塑性修正步期间平均压力会发生变化。偏量响应和体积响应之间的这种耦合是压力敏感材料（如土壤、岩石和混凝土）的一个关键特征，而 Drucker-Prager 模型正是为描述这类材料而设计的。相比之下，von Mises 模型适用于金属，因为金属的塑性流动在很大程度上与压力无关。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the updated stress state for Drucker-Prager and von Mises models\n    for a suite of test cases.\n    \"\"\"\n    \n    # Test cases: (E, nu, k0, H, alpha, ep_n, (e11, e22, e33, e12, e23, e13))\n    test_cases = [\n        (210000.0, 0.3, 200.0, 1000.0, 0.1, 0.0, (1e-6, 1e-6, 1e-6, 0.0, 0.0, 0.0)),\n        (210000.0, 0.3, 200.0, 1000.0, 0.1, 0.0, (0.0, 0.0, 0.0, 1e-3, 0.0, 0.0)),\n        (210000.0, 0.29, 20.0, 100.0, 0.3, 0.0, (-5e-3, -5e-3, -5e-3, 0.0, 0.0, 0.0)),\n        (70000.0, 0.25, 100.0, 500.0, 0.2, 0.05, (4e-4, -1e-4, 0.0, 3e-4, 0.0, 0.0)),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        E, nu, k0, H, alpha, ep_n, delta_eps_vec = case\n\n        # --- 1. Pre-computation and Trial State ---\n\n        # Elastic constants\n        lame_lambda = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n        mu = E / (2 * (1 + nu))\n        K = lame_lambda + (2 / 3) * mu\n\n        # Construct strain increment tensor (tensorial shear)\n        delta_eps = np.zeros((3, 3))\n        delta_eps[0, 0], delta_eps[1, 1], delta_eps[2, 2] = delta_eps_vec[0], delta_eps_vec[1], delta_eps_vec[2]\n        delta_eps[0, 1] = delta_eps[1, 0] = delta_eps_vec[3]\n        delta_eps[1, 2] = delta_eps[2, 1] = delta_eps_vec[4]\n        delta_eps[0, 2] = delta_eps[2, 0] = delta_eps_vec[5]\n        \n        # Initial state (stress is zero)\n        sigma_n = np.zeros((3, 3))\n\n        # Trial stress (sigma_n is zero)\n        tr_delta_eps = np.trace(delta_eps)\n        sigma_tr = lame_lambda * tr_delta_eps * np.identity(3) + 2 * mu * delta_eps\n\n        # Trial invariants\n        tr_sigma_tr = np.trace(sigma_tr)\n        p_tr = -tr_sigma_tr / 3.0\n        s_tr = sigma_tr - (tr_sigma_tr / 3.0) * np.identity(3)\n        # Frobenius norm squared: np.sum(s_tr*s_tr)\n        q_tr = np.sqrt(3.0 / 2.0 * np.sum(s_tr * s_tr))\n        \n        # Initial yield strength\n        k_n = k0 + H * ep_n\n\n        # --- 2. Drucker-Prager Model ---\n\n        # Check trial yield condition\n        f_tr_dp = q_tr + alpha * p_tr - k_n\n        \n        if f_tr_dp <= 0:  # Elastic step\n            p_dp = p_tr\n            q_dp = q_tr\n            ep_dp = ep_n\n            dgamma_dp = 0.0\n        else:  # Plastic step\n            denominator_dp = 3 * mu + K * alpha**2 + H\n            dgamma_dp = f_tr_dp / denominator_dp\n            \n            p_dp = p_tr - K * alpha * dgamma_dp\n            q_dp = q_tr - 3 * mu * dgamma_dp\n            ep_dp = ep_n + dgamma_dp\n\n        # --- 3. von Mises (J2) Model ---\n\n        # Check trial yield condition\n        f_tr_j2 = q_tr - k_n\n\n        if f_tr_j2 <= 0: # Elastic step\n            p_j2 = p_tr\n            q_j2 = q_tr\n            ep_j2 = ep_n\n            dgamma_j2 = 0.0\n        else: # Plastic step\n            denominator_j2 = 3 * mu + H\n            dgamma_j2 = f_tr_j2 / denominator_j2\n            \n            p_j2 = p_tr # Pressure is unchanged\n            # q can be updated in two consistent ways:\n            # q_j2 = q_tr - 3 * mu * dgamma_j2\n            q_j2 = k_n + H * dgamma_j2 # Enforces return to updated surface\n            ep_j2 = ep_n + dgamma_j2\n\n        # --- 4. Collect and format results ---\n        \n        case_results = [\n            round(p_dp, 6), round(q_dp, 6), round(ep_dp, 6), round(dgamma_dp, 6),\n            round(p_j2, 6), round(q_j2, 6), round(ep_j2, 6), round(dgamma_j2, 6),\n        ]\n        all_results.append(case_results)\n\n    # Format output as a string representing a list of lists\n    # Each inner list is converted to a string, then joined by commas\n    # Example: \"[-0.525000,0.000000,...]\"\n    inner_lists_str = [f\"[{','.join(f'{x:.6f}' for x in res)}]\" for res in all_results]\n    print(f\"[{','.join(inner_lists_str)}]\")\n\n\nsolve()\n```", "id": "2893781"}]}