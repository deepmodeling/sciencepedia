{"hands_on_practices": [{"introduction": "连续介质损伤力学的核心在于一个热力学框架，其中损伤的演化由一个共轭的驱动力（即能量释放率 $Y$）来控制。本练习旨在夯实从亥姆霍兹自由能势函数 $\\psi$ 出发，推导损伤驱动力的基本技能。通过分析一个特定的双轴拉伸应变路径，你将把抽象的理论应用于一个具体的工程问题，并确定损伤起始的临界条件 [@problem_id:2876618]。", "problem": "一个线性弹性各向同性固体，在连续介质损伤力学（CDM）的有效应力概念框架下，使用一个各向同性标量损伤变量 $d \\in [0,1)$ 进行建模。在小应变假设下，单位参考体积的亥姆霍兹自由能具有以下可分离形式\n$$\n\\psi(\\boldsymbol{\\varepsilon},d) = (1-d)\\,\\psi_{0}(\\boldsymbol{\\varepsilon}), \\quad \\text{其中} \\quad \\psi_{0}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\lambda \\left(\\operatorname{tr}\\boldsymbol{\\varepsilon}\\right)^{2} + \\mu\\,\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon},\n$$\n其中 $\\lambda$ 和 $\\mu$ 是未损伤固体的拉梅参数，它们通过 $\\lambda = \\dfrac{E\\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu = \\dfrac{E}{2(1+\\nu)}$ 与杨氏模量 $E$ 和泊松比 $\\nu$ 相关联。忽略单边效应，并假设所有场都是均匀的。\n\n与 $d$ 共轭的热力学力（损伤能量释放率）$Y$ 定义为 $Y = -\\dfrac{\\partial \\psi}{\\partial d}\\big|_{\\boldsymbol{\\varepsilon}}$。该材料承受一个比例双轴拉伸路径，其主应变分量为 $\\left(\\varepsilon_{1},\\varepsilon_{2},\\varepsilon_{3}\\right) = \\left(\\varepsilon, \\beta\\,\\varepsilon, 0\\right)$，其中 $\\beta \\ge 0$ 为固定值，$\\varepsilon \\ge 0$ 为标量幅值。当 $Y$ 达到一个给定的正阈值 $Y_{0}$（其量纲为能量密度）时，损伤开始发生。\n\n仅从给定的定义和关系出发，完成以下任务：\n- 推导 $Y(\\varepsilon)$ 关于 $E$、$\\nu$、$\\beta$ 和 $\\varepsilon$ 的显式表达式。\n- 确定由条件 $Y(\\varepsilon_{\\text{onset}}) = Y_{0}$ 定义的损伤起始应变幅值 $\\varepsilon_{\\text{onset}}$ 的闭式解析表达式。\n\n将您的最终答案表示为 $\\varepsilon_{\\text{onset}}$ 关于 $E$、$\\nu$、$\\beta$ 和 $Y_{0}$ 的单个闭式表达式。最终答案中不包含单位。无需进行数值计算。", "solution": "所给问题是连续介质损伤力学中的一个标准练习，具有科学依据，提法恰当且自洽。它不包含任何逻辑矛盾、歧义或事实错误。因此，该问题是有效的，可以推导出严谨的解。\n\n目标是在特定的双轴加载条件下，求出损伤开始时的应变幅值 $\\varepsilon_{\\text{onset}}$。这需要两个主要步骤：首先，推导损伤能量释放率 $Y$ 作为应变幅值 $\\varepsilon$ 的函数表达式；其次，求解当 $Y$ 达到临界阈值 $Y_0$ 时的应变。\n\n单位体积的亥姆霍兹自由能表示为\n$$ \\psi(\\boldsymbol{\\varepsilon},d) = (1-d)\\,\\psi_{0}(\\boldsymbol{\\varepsilon}) $$\n其中 $d$ 是标量损伤变量，$\\psi_{0}(\\boldsymbol{\\varepsilon})$ 是未损伤材料的应变能密度，定义为\n$$ \\psi_{0}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\lambda \\left(\\operatorname{tr}\\boldsymbol{\\varepsilon}\\right)^{2} + \\mu\\,\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon} $$\n与损伤变量 $d$ 共轭的热力学力，即损伤能量释放率，定义为\n$$ Y = -\\frac{\\partial \\psi}{\\partial d}\\bigg|_{\\boldsymbol{\\varepsilon}} $$\n将 $\\psi(\\boldsymbol{\\varepsilon},d)$ 的表达式代入此定义，我们在保持应变张量 $\\boldsymbol{\\varepsilon}$ 不变的情况下，对 $d$ 进行偏微分：\n$$ Y = -\\frac{\\partial}{\\partial d} \\left[ (1-d)\\,\\psi_{0}(\\boldsymbol{\\varepsilon}) \\right] = -(-\\psi_{0}(\\boldsymbol{\\varepsilon})) = \\psi_{0}(\\boldsymbol{\\varepsilon}) $$\n这个基本结果表明，对于该模型，损伤能量释放率恰好等于虚拟未损伤材料的应变能密度。\n\n下一步是针对指定的加载路径计算 $\\psi_{0}$。应变张量 $\\boldsymbol{\\varepsilon}$ 的主分量为 $(\\varepsilon_{1},\\varepsilon_{2},\\varepsilon_{3}) = (\\varepsilon, \\beta\\varepsilon, 0)$。在其主坐标系中，应变张量由以下矩阵表示：\n$$ \\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon & 0 & 0 \\\\ 0 & \\beta\\varepsilon & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\n现在我们必须计算 $\\psi_{0}$ 所需的两个应变不变量：$\\boldsymbol{\\varepsilon}$ 的迹 $\\operatorname{tr}\\boldsymbol{\\varepsilon}$ 和双点积 $\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon}$。\n\n迹是主应变之和：\n$$ \\operatorname{tr}\\boldsymbol{\\varepsilon} = \\varepsilon_1 + \\varepsilon_2 + \\varepsilon_3 = \\varepsilon + \\beta\\varepsilon + 0 = (1+\\beta)\\varepsilon $$\n双点积是张量所有分量的平方和，对于对角张量，它简化为主应变的平方和：\n$$ \\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon} = \\varepsilon_1^2 + \\varepsilon_2^2 + \\varepsilon_3^2 = \\varepsilon^2 + (\\beta\\varepsilon)^2 + 0^2 = (1+\\beta^2)\\varepsilon^2 $$\n\n现在，我们将这些不变量代入 $Y = \\psi_{0}$ 的表达式中：\n$$ Y(\\varepsilon) = \\frac{1}{2}\\lambda \\left((1+\\beta)\\varepsilon\\right)^{2} + \\mu\\left((1+\\beta^2)\\varepsilon^2\\right) $$\n$$ Y(\\varepsilon) = \\left[ \\frac{1}{2}\\lambda (1+\\beta)^2 + \\mu (1+\\beta^2) \\right] \\varepsilon^2 $$\n为了得到以工程常数 $E$ 和 $\\nu$ 表示的表达式，我们代入给定的拉梅参数 $\\lambda$ 和 $\\mu$ 的关系式：\n$$ \\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}, \\quad \\mu = \\frac{E}{2(1+\\nu)} $$\n将这些代入 $Y(\\varepsilon)$ 的表达式中：\n$$ Y(\\varepsilon) = \\left[ \\frac{1}{2} \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} (1+\\beta)^2 + \\frac{E}{2(1+\\nu)} (1+\\beta^2) \\right] \\varepsilon^2 $$\n我们提取公因式 $\\frac{E}{2(1+\\nu)(1-2\\nu)}$：\n$$ Y(\\varepsilon) = \\frac{E\\varepsilon^2}{2(1+\\nu)(1-2\\nu)} \\left[ \\nu(1+\\beta)^2 + (1-2\\nu)(1+\\beta^2) \\right] $$\n现在，我们简化方括号内的表达式：\n$$ \\nu(1+\\beta)^2 + (1-2\\nu)(1+\\beta^2) = \\nu(1+2\\beta+\\beta^2) + (1+\\beta^2 - 2\\nu - 2\\nu\\beta^2) $$\n$$ = \\nu + 2\\nu\\beta + \\nu\\beta^2 + 1 + \\beta^2 - 2\\nu - 2\\nu\\beta^2 $$\n合并同类项，我们得到一个更紧凑的形式：\n$$ = 1 + \\beta^2 - \\nu - \\nu\\beta^2 + 2\\nu\\beta = 1 + \\beta^2 - \\nu(1 + \\beta^2 - 2\\beta) = 1 + \\beta^2 - \\nu(1-\\beta)^2 $$\n因此，损伤能量释放率作为 $\\varepsilon$ 函数的显式表达式为：\n$$ Y(\\varepsilon) = \\frac{E\\varepsilon^2}{2(1+\\nu)(1-2\\nu)} \\left[ 1 + \\beta^2 - \\nu(1-\\beta)^2 \\right] $$\n至此完成了任务的第一部分。\n\n最后，我们确定损伤开始时的应变 $\\varepsilon_{\\text{onset}}$。当 $Y$ 达到阈值 $Y_{0}$ 时，损伤开始发生。我们令 $Y(\\varepsilon_{\\text{onset}}) = Y_0$：\n$$ Y_0 = \\frac{E\\varepsilon_{\\text{onset}}^2}{2(1+\\nu)(1-2\\nu)} \\left[ 1 + \\beta^2 - \\nu(1-\\beta)^2 \\right] $$\n为了求得 $\\varepsilon_{\\text{onset}}$，我们通过分离 $\\varepsilon_{\\text{onset}}^2$ 来求解：\n$$ \\varepsilon_{\\text{onset}}^2 = \\frac{2(1+\\nu)(1-2\\nu)Y_0}{E \\left[ 1 + \\beta^2 - \\nu(1-\\beta)^2 \\right]} $$\n由于应变幅值 $\\varepsilon$ 定义为非负值（$\\varepsilon \\ge 0$），我们取其主（正）平方根，得到 $\\varepsilon_{\\text{onset}}$ 的最终表达式：\n$$ \\varepsilon_{\\text{onset}} = \\sqrt{\\frac{2(1+\\nu)(1-2\\nu)Y_0}{E \\left[ 1 + \\beta^2 - \\nu(1-\\beta)^2 \\right]}} $$\n对于所有物理上合理的材料属性（$E > 0$, $0 \\le \\nu < 0.5$）和加载条件（$\\beta \\ge 0$, $Y_{0} > 0$），平方根下的项均为正，因此该表达式在物理上是有效的。", "answer": "$$\\boxed{\\sqrt{\\frac{2(1+\\nu)(1-2\\nu)Y_{0}}{E\\left[1 + \\beta^{2} - \\nu(1-\\beta)^{2}\\right]}}}$$", "id": "2876618"}, {"introduction": "构建损伤本构模型时，研究者常采用不同的等效性假设，例如应变等效或能量等效，以将损伤变量引入未损伤材料的本构关系中。虽然这些假设在线弹性情况下可能给出相同的结果，但本练习将通过一个非线性弹性材料的反例，揭示它们在更一般情况下的分歧。这个实践旨在强调不同建模选择对预测损伤驱动力 $Y$ 的重要影响，并培养对模型基本假设的批判性思维 [@problem_id:2876594]。", "problem": "考虑一个一维超弹性杆，其标量各向同性损伤变量为 $D \\in [0,1)$，总小应变为 $\\varepsilon \\in \\mathbb{R}$。设未损伤的亥姆霍兹自由能是应变的非线性函数，\n$$\n\\psi_{0}(\\varepsilon) = \\frac{1}{2} E \\varepsilon^{2} + \\frac{1}{3} a \\varepsilon^{3},\n$$\n其中 $E>0$ 是常数模量，$a \\neq 0$ 是控制非线性的常数。热力学损伤驱动力定义为亥姆霍兹自由能在固定 $\\varepsilon$ 下对 $D$ 的负偏导数，即 $Y := -\\frac{\\partial \\psi}{\\partial D}$。\n\n为了引入损伤，通常会使用两种常见的等效性假设：\n(i) 基于能量的等效性，其中损伤自由能是未损伤自由能与一个退化函数 $g(D)$ 的标量积，该函数满足 $g(0)=1$ 和 $g(1)=0$；以及\n(ii) 基于应变的等效性，其中损伤自由能是通过在有效应变 $h(D)\\,\\varepsilon$ 处计算未损伤自由能得到的，其中 $h(0)=1$ 和 $h(1)=0$。\n\n假设最简单的线性选择 $g(D) = 1 - D$ 和 $h(D) = 1 - D$，并将它们视为针对同一未损伤非线性定律 $\\psi_{0}(\\varepsilon)$ 的两种不同建模途径。仅使用亥姆霍兹自由能和热力学驱动力的定义，构造一个明确的反例，证明这两种途径产生不同的损伤自由能，然后计算基于应变的构造和基于能量的构造在损伤驱动力上的差值，\n$$\n\\Delta Y(\\varepsilon,D,E,a) := Y_{\\mathrm{strain}}(\\varepsilon,D,E,a) - Y_{\\mathrm{energy}}(\\varepsilon,D,E,a).\n$$\n\n以 $\\varepsilon$、$D$、$E$ 和 $a$ 表示的单个闭式解析表达式的形式给出你的最终结果。不要进行任何数值计算，也不要为最终表达式附加单位。", "solution": "出发点是亥姆霍兹自由能和损伤的热力学驱动力的定义。对于自由能 $\\psi(\\varepsilon,D)$，损伤驱动力由标准热力学关系定义\n$$\nY(\\varepsilon,D) := -\\frac{\\partial \\psi(\\varepsilon,D)}{\\partial D}\\bigg|_{\\varepsilon}.\n$$\n我们给定了一个未损伤的超弹性定律\n$$\n\\psi_{0}(\\varepsilon) = \\frac{1}{2} E \\varepsilon^{2} + \\frac{1}{3} a \\varepsilon^{3},\n$$\n其中 $E>0$ 且 $a \\neq 0$，因此材料在应变上是非线性的。\n\n需要施加两种不同的等效性假设：\n\n1) 基于能量的等效性：损伤自由能是未损伤自由能与一个退化函数 $g(D)$ 的标量积。对于给定的线性选择 $g(D) = 1 - D$，损伤自由能表示为\n$$\n\\psi_{\\mathrm{energy}}(\\varepsilon,D) = g(D)\\,\\psi_{0}(\\varepsilon) = (1 - D)\\left(\\frac{1}{2} E \\varepsilon^{2} + \\frac{1}{3} a \\varepsilon^{3}\\right).\n$$\n根据损伤驱动力的定义，\n$$\nY_{\\mathrm{energy}}(\\varepsilon,D) = -\\frac{\\partial \\psi_{\\mathrm{energy}}}{\\partial D} = \\frac{1}{2} E \\varepsilon^{2} + \\frac{1}{3} a \\varepsilon^{3}.\n$$\n对于这种构造，驱动力与 $D$ 无关。\n\n2) 基于应变的等效性：损伤自由能等于在有效应变 $h(D)\\,\\varepsilon$ 处计算的未损伤自由能。对于给定的线性选择 $h(D) = 1 - D$，我们有\n$$\n\\psi_{\\mathrm{strain}}(\\varepsilon,D) = \\psi_{0}\\big((1 - D)\\,\\varepsilon\\big) = \\frac{1}{2} E \\big((1 - D)\\varepsilon\\big)^{2} + \\frac{1}{3} a \\big((1 - D)\\varepsilon\\big)^{3}.\n$$\n展开 $(1 - D)$ 的幂次，\n$$\n\\psi_{\\mathrm{strain}}(\\varepsilon,D) = \\frac{1}{2} E (1 - D)^{2} \\varepsilon^{2} + \\frac{1}{3} a (1 - D)^{3} \\varepsilon^{3}.\n$$\n通过在固定 $\\varepsilon$ 下对 $D$ 求导，可以获得相应的损伤驱动力：\n\n$$\n\\frac{\\partial \\psi_{\\mathrm{strain}}}{\\partial D}\n= \\frac{1}{2} E \\cdot 2(1 - D)(-1)\\,\\varepsilon^{2} + \\frac{1}{3} a \\cdot 3(1 - D)^{2}(-1)\\,\\varepsilon^{3}\n= - E (1 - D)\\varepsilon^{2} - a (1 - D)^{2}\\varepsilon^{3}.\n$$\n\n因此，\n$$\nY_{\\mathrm{strain}}(\\varepsilon,D) = -\\frac{\\partial \\psi_{\\mathrm{strain}}}{\\partial D} = E (1 - D)\\varepsilon^{2} + a (1 - D)^{2}\\varepsilon^{3}.\n$$\n\n反例的构造。因为 $a \\neq 0$ 且当映射 $h(D) = 1 - D$ 代入 $\\psi_{0}$ 时，其在 $D$ 中是非线性的，所以对于一般的 $\\varepsilon \\neq 0$ 和 $D \\in (0,1)$，这两种损伤自由能是不同的：\n\n$$\n\\psi_{\\mathrm{strain}}(\\varepsilon,D) = \\frac{1}{2} E (1 - D)^{2} \\varepsilon^{2} + \\frac{1}{3} a (1 - D)^{3} \\varepsilon^{3}\n\\neq (1 - D)\\left(\\frac{1}{2} E \\varepsilon^{2} + \\frac{1}{3} a \\varepsilon^{3}\\right) = \\psi_{\\mathrm{energy}}(\\varepsilon,D),\n$$\n\n因为对于 $D \\in (0,1)$，有 $(1 - D)^{2} \\neq (1 - D)$ 和 $(1 - D)^{3} \\neq (1 - D)$。\n\n所要求的对损伤驱动力的定量影响是其差值\n\n$$\n\\Delta Y(\\varepsilon,D,E,a) := Y_{\\mathrm{strain}}(\\varepsilon,D) - Y_{\\mathrm{energy}}(\\varepsilon,D).\n$$\n\n代入上面推导出的表达式可得\n\n$$\n\\Delta Y(\\varepsilon,D,E,a) = \\left[E (1 - D)\\varepsilon^{2} + a (1 - D)^{2}\\varepsilon^{3}\\right] - \\left[\\frac{1}{2} E \\varepsilon^{2} + \\frac{1}{3} a \\varepsilon^{3}\\right].\n$$\n\n一种方便的简化闭式形式是\n\n$$\n\\Delta Y(\\varepsilon,D,E,a) = E \\varepsilon^{2}\\left(\\frac{1}{2} - D\\right) + a \\varepsilon^{3}\\left(D^{2} - 2D + \\frac{2}{3}\\right).\n$$\n\n\n解释。对于 $a \\neq 0$ 的非线性弹性，尽管基于应变和基于能量的两种构造在 $D=0$ 时都满足相同的归一化条件，但它们会导致不同的损伤驱动力。因此，依赖于 $Y$ 的预测耗散和损伤演化律会因这些建模选择而异，这就是该反例的本质。", "answer": "$$\\boxed{E\\,\\varepsilon^{2}\\left(\\frac{1}{2}-D\\right)+a\\,\\varepsilon^{3}\\left(D^{2}-2D+\\frac{2}{3}\\right)}$$", "id": "2876594"}, {"introduction": "理论模型的实用价值最终体现在其数值实现上。本练习将带领你从一个率无关的损伤演化理论（包含阈值和加载/卸载条件）出发，推导并实现一个完整的数值更新算法。你将学习如何将连续的库恩-塔克（Kuhn-Tucker）条件离散化，并构建一个“弹性预测-损伤修正”的返回映射（return-mapping）算法，这是计算力学中求解非弹性本构关系的核心技术 [@problem_id:2876552]。", "problem": "考虑一个基于有效应力概念构建的小应变、一维、各向同性、标量、率无关损伤模型。设 Cauchy 应力由以下有效应力关系式给出\n$$\n\\sigma = \\left(1 - D\\right) E \\,\\varepsilon,\n$$\n其中 $E$ 是杨氏模量，$\\varepsilon$ 是轴向应变，$D \\in [0,1]$ 是标量损伤变量（$D=0$ 表示无损伤，$D=1$ 表示完全损伤）。采用以下自由能密度\n$$\n\\psi(\\varepsilon,D) = \\left(1 - D\\right)\\,\\psi_0(\\varepsilon),\n\\quad\n\\psi_0(\\varepsilon) = \\tfrac{1}{2} E \\,\\langle \\varepsilon \\rangle_+^2,\n$$\n其中 $\\langle \\varepsilon \\rangle_+ := \\max(\\varepsilon,0)$ 是应变的拉伸部分。热力学损伤驱动力是能量释放率\n$$\nY := -\\frac{\\partial \\psi}{\\partial D} = \\psi_0(\\varepsilon) = \\tfrac{1}{2} E \\,\\langle \\varepsilon \\rangle_+^2.\n$$\n引入一个单调非减的历史变量 $\\kappa \\ge 0$，它通过一个单调函数 $D = g(\\kappa)$（其中 $g(0)=0$ 且 $g(\\kappa) \\in [0,1)$）来控制损伤增长。一旦超过某个阈值，损伤开始萌生，并在由加载函数定义的率无关加载-卸载条件下增长\n$$\n\\Phi(Y,\\kappa) := Y - R(\\kappa) \\le 0,\n$$\n并满足 Kuhn–Tucker 条件\n$$\n\\dot{\\kappa} \\ge 0,\\quad \\Phi \\le 0,\\quad \\dot{\\kappa}\\,\\Phi = 0,\n$$\n其中 $R(\\kappa)$ 是一个递增的阻力（阈值）函数。在一个从 $n$ 步到 $n+1$ 步的隐式时间步进格式中，应变 $\\varepsilon_{n+1}$ 是给定的。目标是在给定 $(\\kappa_n,D_n)$ 和材料参数的情况下，计算 $(\\kappa_{n+1},D_{n+1},\\sigma_{n+1})$。\n\n为确保一个良定的类似返回映射的更新，使用以下具体但可推广的选择：\n- 阻力函数：$R(\\kappa) = Y_0 + H\\,\\kappa$，其中 $Y_0 > 0$ 且 $H > 0$。\n- 损伤法则：$D = g(\\kappa) = 1 - \\exp\\!\\left(-\\beta\\,\\kappa\\right)$，其中 $\\beta > 0$。\n\n仅从上述定义和率无关互补性出发，推导 $(\\kappa_{n+1},D_{n+1},\\sigma_{n+1})$ 的一致隐式算法更新。该更新在弹性预测步后跟一个强制满足离散加载-卸载条件的校正步的意义上，是类似返回映射的。你的推导必须从自由能、有效应力概念和 Kuhn–Tucker 条件出发，并得出一个对于给定的线性阻力函数而言无条件稳定的算法。不要事先假设最终更新的任何显式公式；相反，应将其作为所述原理的推论导出。\n\n然后，将推导出的算法实现为一个完整的、可运行的程序，以处理下面的测试套件。在所有计算中，使用：\n- 类应力量 $Y$、$Y_0$ 和 $H\\kappa$ 的单位为兆帕 (MPa)。\n- 应变 $\\varepsilon$ 为无量纲。\n- 杨氏模量 $E$ 的单位为兆帕 (MPa)。\n- 最终输出为更新后的损伤值 $D_{n+1}$（无量纲）。\n\n测试套件（每个算例是一个元组 $(E, Y_0, H, \\beta, \\varepsilon_{n+1}, \\kappa_n)$，其中 $D_n = g(\\kappa_n)$ 被隐式定义）：\n1. $(210000.0,\\; 0.1,\\; 0.5,\\; 1.5,\\; 0.0005,\\; 0.0)$\n2. $(210000.0,\\; 0.1,\\; 0.5,\\; 1.5,\\; 0.0015,\\; 0.0)$\n3. $(210000.0,\\; 0.1,\\; 0.5,\\; 1.5,\\; 0.01,\\; 0.0)$\n4. $(210000.0,\\; 0.1,\\; 0.5,\\; 1.5,\\; -0.002,\\; 0.5)$\n5. $(210000.0,\\; 0.1,\\; 0.5,\\; 1.5,\\; 0.001380131118684709,\\; 0.2)$\n\n对于每个测试算例，使用你的算法计算更新后的 $D_{n+1}$。你的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的十进制数列表，每个数字保留小数点后六位（例如，“[0.123456,0.000000,1.000000]”）。", "solution": "首先对问题陈述进行验证。\n\n逐字提取给定条件：\n- Cauchy 应力 $\\sigma$ 通过有效应力概念与应变 $\\varepsilon$ 和损伤 $D$ 相关联：$\\sigma = \\left(1 - D\\right) E \\,\\varepsilon$，其中 $E$ 是杨氏模量。\n- 损伤变量 $D$ 的范围是 $[0,1]$。\n- Helmholtz 自由能密度为 $\\psi(\\varepsilon,D) = \\left(1 - D\\right)\\,\\psi_0(\\varepsilon)$，其中弹性应变能部分为 $\\psi_0(\\varepsilon) = \\tfrac{1}{2} E \\,\\langle \\varepsilon \\rangle_+^2$。算子 $\\langle \\varepsilon \\rangle_+ := \\max(\\varepsilon,0)$ 用于分离出拉伸应变分量。\n- 与损伤共轭的热力学力，即能量释放率 $Y$，为 $Y := -\\frac{\\partial \\psi}{\\partial D} = \\psi_0(\\varepsilon) = \\tfrac{1}{2} E \\,\\langle \\varepsilon \\rangle_+^2$。\n- 一个非减的历史变量 $\\kappa \\ge 0$ 控制损伤演化。\n- 损伤法则是单调函数 $D = g(\\kappa)$。\n- 率无关演化由加载函数 $\\Phi(Y,\\kappa) := Y - R(\\kappa) \\le 0$ 和 Kuhn-Tucker 条件定义：$\\dot{\\kappa} \\ge 0, \\Phi \\le 0, \\dot{\\kappa}\\,\\Phi = 0$。\n- 阻力函数为 $R(\\kappa) = Y_0 + H\\,\\kappa$，其中材料参数 $Y_0 > 0$ 且 $H > 0$。\n- 具体的损伤法则是 $D = g(\\kappa) = 1 - \\exp\\!\\left(-\\beta\\,\\kappa\\right)$，其中参数 $\\beta > 0$。\n- 问题是从 $n$ 步到 $n+1$ 步的隐式时间步，其中 $\\varepsilon_{n+1}$ 是给定的，$(\\kappa_n, D_n)$ 是已知的。目标是计算 $(\\kappa_{n+1}, D_{n+1}, \\sigma_{n+1})$。\n\n验证过程如下：\n1.  **科学依据**：该公式基于连续介质损伤力学的既定原理。使用自由能势推导热力学力，以及应用带有 Kuhn-Tucker 条件的率无关演化法则，是该领域的标准且严谨的方法。该模型在科学上是可靠的。\n2.  **良定性与完备性**：问题提供了执行单步更新所需的所有必要本构函数（$g(\\kappa)$, $R(\\kappa)$）、材料参数（$E, Y_0, H, \\beta$）和状态变量（$\\kappa_n, \\varepsilon_{n+1}$）。任务是推导并实现一个标准返回映射算法，这是处理此类问题的正确程序，可确保更新存在唯一解。\n3.  **客观性**：问题是用精确的数学公式和客观的语言定义的。\n\n该问题被认为是有效的，有必要对求解算法进行形式化推导。\n\n目标是针对给定的应变 $\\varepsilon_{n+1}$，为状态更新 $(\\kappa_n) \\to (\\kappa_{n+1})$ 建立一个计算算法。该演化过程由从 $t_n$ 到 $t_{n+1}$ 步的 Kuhn-Tucker 条件的时间离散形式控制：\n$$ \\kappa_{n+1} \\ge \\kappa_n $$\n$$ \\Phi_{n+1} := Y_{n+1} - R(\\kappa_{n+1}) \\le 0 $$\n$$ (\\kappa_{n+1} - \\kappa_n)\\Phi_{n+1} = 0 $$\n其中 $Y_{n+1}$ 是在已知应变 $\\varepsilon_{n+1}$ 处计算的损伤驱动力。这组条件使用弹性预测-校正算法（也称为返回映射）求解。\n\n**第1步：弹性预测**\n首先，我们假设该步是弹性的，即内部损伤历史变量没有变化。在 $n+1$ 步的 $\\kappa$ 的试探值设为它在 $n$ 步的值：\n$$ \\kappa_{n+1}^{\\text{trial}} = \\kappa_n $$\n损伤驱动力 $Y_{n+1}$ 完全由给定的应变 $\\varepsilon_{n+1}$ 决定：\n$$ Y_{n+1} = \\frac{1}{2} E \\langle \\varepsilon_{n+1} \\rangle_+^2 $$\n注意，如果 $\\varepsilon_{n+1} \\le 0$，则 $Y_{n+1}=0$。\n使用这些试探值，我们计算加载函数的值，以检查弹性演化的假设是否正确。当前的损伤阈值为 $R(\\kappa_n)$。\n$$ \\Phi_{n+1}^{\\text{trial}} = Y_{n+1} - R(\\kappa_n) = Y_{n+1} - (Y_0 + H\\kappa_n) $$\n\n**第2步：校正（返回映射）**\n$\\Phi_{n+1}^{\\text{trial}}$ 的值决定了该步的性质。\n\n**情况 A：弹性步 ($\\Phi_{n+1}^{\\text{trial}} \\le 0$)**\n如果试探加载函数为非正，则弹性预测是正确的。系统处于弹性卸载或中性加载状态。不会发生进一步的损伤。新状态即为试探状态：\n$$ \\kappa_{n+1} = \\kappa_n $$\n这自然满足离散的 Kuhn-Tucker 条件：$\\kappa_{n+1} \\ge \\kappa_n$ 得到满足；根据情况定义，$\\Phi_{n+1} = \\Phi_{n+1}^{\\text{trial}} \\le 0$ 也得到满足；并且 $(\\kappa_{n+1} - \\kappa_n)\\Phi_{n+1} = 0 \\cdot \\Phi_{n+1} = 0$。\n\n**情况 B：损伤步 ($\\Phi_{n+1}^{\\text{trial}} > 0$)**\n如果试探加载函数为正，则弹性预测无效。损伤必须演化，以将状态带回到由 $\\Phi_{n+1} \\le 0$ 定义的容许域内。率无关一致性条件要求，对于损伤加载，最终状态必须位于容许域的边界上：\n$$ \\Phi_{n+1} = 0 $$\n这意味着 $Y_{n+1} - R(\\kappa_{n+1}) = 0$。我们必须解出满足此条件的未知数 $\\kappa_{n+1}$。代入给定的材料函数：\n$$ Y_{n+1} - (Y_0 + H\\kappa_{n+1}) = 0 $$\n该方程是关于 $\\kappa_{n+1}$ 的线性方程，可以得出解析解：\n$$ \\kappa_{n+1} = \\frac{Y_{n+1} - Y_0}{H} $$\n此更新被称为‘返回映射’，因为它将状态‘返回’到 $\\Phi = 0$ 的加载面上。我们必须验证 $\\kappa_{n+1} > \\kappa_n$。进入此情况的条件是 $\\Phi_{n+1}^{\\text{trial}} = Y_{n+1} - (Y_0 + H\\kappa_n) > 0$。整理此不等式可得 $Y_{n+1} - Y_0 > H\\kappa_n$。由于给定 $H > 0$，因此可以推断出 $\\frac{Y_{n+1} - Y_0}{H} > \\kappa_n$，这证实了 $\\kappa_{n+1} > \\kappa_n$，满足损伤演化的要求。\n\n**第3步：最终状态更新**\n在从情况 A 或情况 B 确定了 $\\kappa_{n+1}$ 的正确值之后，损伤 $D_{n+1}$ 和应力 $\\sigma_{n+1}$ 的最终值可直接由其定义计算得出：\n$$ D_{n+1} = g(\\kappa_{n+1}) = 1 - \\exp(-\\beta\\kappa_{n+1}) $$\n$$ \\sigma_{n+1} = (1-D_{n+1})E\\varepsilon_{n+1} $$\n问题要求报告 $D_{n+1}$。\n\n**算法总结：**\n1.  **输入**：材料参数 $E, Y_0, H, \\beta$；第 $n$ 步的状态：$\\kappa_n$；第 $n+1$ 步的给定应变：$\\varepsilon_{n+1}$。\n2.  **计算驱动力**：计算 $Y_{n+1} = \\frac{1}{2} E \\langle \\varepsilon_{n+1} \\rangle_+^2$。\n3.  **检查加载条件**：计算 $\\Phi_{n+1}^{\\text{trial}} = Y_{n+1} - (Y_0 + H \\kappa_n)$。\n4.  **更新历史变量**：\n    - 如果 $\\Phi_{n+1}^{\\text{trial}} \\le 0$，则设 $\\kappa_{n+1} = \\kappa_n$。\n    - 如果 $\\Phi_{n+1}^{\\text{trial}} > 0$，则设 $\\kappa_{n+1} = (Y_{n+1} - Y_0) / H$。\n5.  **计算最终损伤**：计算 $D_{n+1} = 1 - \\exp(-\\beta \\kappa_{n+1})$。\n6.  **返回**：值 $D_{n+1}$。\n\n该算法是鲁棒的，对于任何步长都是无条件稳定的（在给定的线性阻力和指数损伤函数下），并且是直接从所提供模型的基本原理推导出来的。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the damage mechanics problem for a suite of test cases.\n    \"\"\"\n\n    # Test suite provided in the problem statement.\n    # Each case is a tuple: (E, Y0, H, beta, eps_np1, kappa_n)\n    test_cases = [\n        (210000.0, 0.1, 0.5, 1.5, 0.0005, 0.0),\n        (210000.0, 0.1, 0.5, 1.5, 0.0015, 0.0),\n        (210000.0, 0.1, 0.5, 1.5, 0.01, 0.0),\n        (210000.0, 0.1, 0.5, 1.5, -0.002, 0.5),\n        (210000.0, 0.1, 0.5, 1.5, 0.001380131118684709, 0.2),\n    ]\n\n    def compute_damage_update(E, Y0, H, beta, eps_np1, kappa_n):\n        \"\"\"\n        Computes the updated damage variable D_np1 using a return-mapping algorithm.\n\n        Args:\n            E (float): Young's modulus (MPa)\n            Y0 (float): Initial damage threshold (MPa)\n            H (float): Damage hardening modulus (MPa)\n            beta (float): Damage evolution parameter (dimensionless)\n            eps_np1 (float): Prescribed strain at step n+1 (dimensionless)\n            kappa_n (float): History variable at step n (dimensionless)\n\n        Returns:\n            float: Updated damage variable D_np1 (dimensionless)\n        \"\"\"\n        # Step 1: Compute the damage driving force Y_np1.\n        # The Macaulay bracket <eps>_+ is applied.\n        eps_pos = np.maximum(eps_np1, 0.0)\n        Y_np1 = 0.5 * E * eps_pos**2\n\n        # Step 2: Evaluate the trial loading function Phi_trial.\n        # This checks if the elastic trial state is outside the admissible region.\n        # R(kappa_n) is the resistance at the start of the step.\n        R_kappa_n = Y0 + H * kappa_n\n        trial_phi = Y_np1 - R_kappa_n\n\n        # Step 3: Update the history variable kappa_np1 based on the\n        # discrete Kuhn-Tucker conditions (loading/unloading).\n        if trial_phi <= 0:\n            # Case A: Elastic step (or unloading/neutral loading). No damage evolution.\n            kappa_np1 = kappa_n\n        else:\n            # Case B: Damage step. The state is returned to the yield surface.\n            # The consistency condition Phi_np1 = 0 is enforced.\n            kappa_np1 = (Y_np1 - Y0) / H\n            \n        # Step 4: Compute the final damage D_np1 using the updated history variable.\n        D_np1 = 1.0 - np.exp(-beta * kappa_np1)\n\n        return D_np1\n\n    results = []\n    for case in test_cases:\n        D_np1 = compute_damage_update(*case)\n        results.append(D_np1)\n\n    # Format the output as a comma-separated list of numbers with 6 decimal places,\n    # enclosed in square brackets.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2876552"}]}