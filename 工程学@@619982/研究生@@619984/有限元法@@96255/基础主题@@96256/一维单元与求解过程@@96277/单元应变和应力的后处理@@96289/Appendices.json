{"hands_on_practices": [{"introduction": "有限元分析的主要输出是节点位移，但工程实践中我们更关心的是应力和应变。这个练习将带你从最基本的线性三角形单元出发，亲手完成从给定的节点位移计算单元内部恒定应变和应力张量的全过程。通过这个基础实践，你将巩固对位移梯度、应变张量和本构关系这些核心概念的理解。[@problem_id:2554896]", "problem": "在一个用于有限元法（FEM）的二维线性三角形单元中，考虑一个三角形上的分段线性位移场，其节点坐标为 $\\left(x_1,y_1\\right) = \\left(0,0\\right)$、$\\left(x_2,y_2\\right) = \\left(2,0\\right)$ 和 $\\left(x_3,y_3\\right) = \\left(0,1\\right)$。节点位移分量 $\\left(u_i,v_i\\right)$ 如下所示：节点 $1$：$\\left(u_1,v_1\\right) = \\left(0,0\\right)$，节点 $2$：$\\left(u_2,v_2\\right) = \\left(0.2,0.1\\right)$，节点 $3$：$\\left(u_3,v_3\\right) = \\left(0.02,0.08\\right)$，其中 $u$ 是 $x$ 方向的位移，$v$ 是 $y$ 方向的位移。假设小应变运动学，并且材料是各向同性、均匀的，处于平面应力状态，杨氏模量 $E = 30\\,\\text{GPa}$，泊松比 $\\nu = 0.25$。\n\n仅使用基本定义（单元上的线性形函数插值和基于位移梯度的微小应变张量定义），首先计算该单元的常数应变张量 $\\varepsilon$，然后推导出该单元在三维意义下的柯西应力张量的偏量部分 $\\mathrm{dev}\\left(\\sigma\\right)$。从以下选项中选择正确的 $\\mathrm{dev}\\left(\\sigma\\right)$（单位为 GPa）。\n\nA. $\\displaystyle \\begin{bmatrix} 1.44 & 0.84 & 0 \\\\ 0.84 & 0.96 & 0 \\\\ 0 & 0 & -2.40 \\end{bmatrix}$\n\nB. $\\displaystyle \\begin{bmatrix} 0.24 & 0.84 & 0 \\\\ 0.84 & -0.24 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}$\n\nC. $\\displaystyle \\begin{bmatrix} 0.96 & 0.84 & 0 \\\\ 0.84 & 0.48 & 0 \\\\ 0 & 0 & -1.44 \\end{bmatrix}$\n\nD. $\\displaystyle \\begin{bmatrix} 1.44 & 0.42 & 0 \\\\ 0.42 & 0.96 & 0 \\\\ 0 & 0 & -2.40 \\end{bmatrix}$", "solution": "问题陈述已经过验证，并且是合理的。在线性弹性和有限元方法的框架内，这是一个适定问题。所有必要的信息都已提供，并且内部一致。\n\n任务是确定一个二维线性三角形单元的柯西应力张量的偏量部分 $\\mathrm{dev}(\\sigma)$。我们将按照要求，通过一系列源于第一性原理的步骤来完成此任务。\n\n首先，我们确定单元上的位移场。对于线性三角形单元，位移分量 $u(x,y)$ 和 $v(x,y)$ 是坐标 $x$ 和 $y$ 的线性函数：\n$$ u(x,y) = a_1 + a_2 x + a_3 y $$\n$$ v(x,y) = b_1 + b_2 x + b_3 y $$\n系数 $a_i$ 和 $b_i$ 通过施加单元节点处的位移值来确定。\n节点坐标：$(x_1,y_1) = (0,0)$；$(x_2,y_2) = (2,0)$；$(x_3,y_3) = (0,1)$。\n节点位移：$(u_1,v_1) = (0,0)$；$(u_2,v_2) = (0.2,0.1)$；$(u_3,v_3) = (0.02,0.08)$。\n\n对于 $u$-位移：\n在节点 $1$ 处：$u_1 = u(0,0) = a_1 = 0$。\n在节点 $2$ 处：$u_2 = u(2,0) = a_1 + a_2(2) + a_3(0) = 2a_2 = 0.2 \\implies a_2 = 0.1$。\n在节点 $3$ 处：$u_3 = u(0,1) = a_1 + a_2(0) + a_3(1) = a_3 = 0.02$。\n所以，$u(x,y) = 0.1x + 0.02y$。\n\n对于 $v$-位移：\n在节点 $1$ 处：$v_1 = v(0,0) = b_1 = 0$。\n在节点 $2$ 处：$v_2 = v(2,0) = b_1 + b_2(2) + b_3(0) = 2b_2 = 0.1 \\implies b_2 = 0.05$。\n在节点 $3$ 处：$v_3 = v(0,1) = b_1 + b_2(0) + b_3(1) = b_3 = 0.08$。\n所以，$v(x,y) = 0.05x + 0.08y$。\n\n第二，我们使用小应变定义计算应变张量 $\\varepsilon$ 的分量。由于位移场是线性的，应变在整个单元内将是恒定的。\n$$ \\varepsilon_{xx} = \\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x}(0.1x + 0.02y) = 0.1 $$\n$$ \\varepsilon_{yy} = \\frac{\\partial v}{\\partial y} = \\frac{\\partial}{\\partial y}(0.05x + 0.08y) = 0.08 $$\n$$ \\varepsilon_{xy} = \\frac{1}{2}\\left(\\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}\\right) = \\frac{1}{2}\\left(\\frac{\\partial}{\\partial y}(0.1x + 0.02y) + \\frac{\\partial}{\\partial x}(0.05x + 0.08y)\\right) = \\frac{1}{2}(0.02 + 0.05) = 0.035 $$\n$xy$-平面内的应变张量为：\n$$ \\varepsilon_{\\text{2D}} = \\begin{bmatrix} 0.1 & 0.035 \\\\ 0.035 & 0.08 \\end{bmatrix} $$\n\n第三，我们使用平面应力条件下的线性各向同性本构关系计算应力张量 $\\sigma$。材料属性为杨氏模量 $E = 30\\,\\text{GPa}$ 和泊松比 $\\nu = 0.25$。\n平面应力的应力-应变关系为：\n$$ \\sigma_{xx} = \\frac{E}{1-\\nu^2}(\\varepsilon_{xx} + \\nu\\varepsilon_{yy}) $$\n$$ \\sigma_{yy} = \\frac{E}{1-\\nu^2}(\\varepsilon_{yy} + \\nu\\varepsilon_{xx}) $$\n$$ \\sigma_{xy} = G \\gamma_{xy} = \\frac{E}{2(1+\\nu)}(2\\varepsilon_{xy}) $$\n我们来计算常数：\n$$ \\frac{E}{1-\\nu^2} = \\frac{30\\,\\text{GPa}}{1 - (0.25)^2} = \\frac{30}{1 - 0.0625} = \\frac{30}{0.9375} = 32\\,\\text{GPa} $$\n$$ G = \\frac{E}{2(1+\\nu)} = \\frac{30\\,\\text{GPa}}{2(1+0.25)} = \\frac{30}{2.5} = 12\\,\\text{GPa} $$\n现在我们计算应力：\n$$ \\sigma_{xx} = 32 \\times (0.1 + 0.25 \\times 0.08) = 32 \\times (0.1 + 0.02) = 32 \\times 0.12 = 3.84\\,\\text{GPa} $$\n$$ \\sigma_{yy} = 32 \\times (0.08 + 0.25 \\times 0.1) = 32 \\times (0.08 + 0.025) = 32 \\times 0.105 = 3.36\\,\\text{GPa} $$\n$$ \\sigma_{xy} = 12 \\times (2 \\times 0.035) = 12 \\times 0.07 = 0.84\\,\\text{GPa} $$\n在平面应力条件下，$\\sigma_{zz} = \\sigma_{xz} = \\sigma_{yz} = 0$。完整的三维应力张量为：\n$$ \\sigma = \\begin{bmatrix} 3.84 & 0.84 & 0 \\\\ 0.84 & 3.36 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix} \\text{ GPa} $$\n\n第四，我们推导应力张量的偏量部分 $\\mathrm{dev}(\\sigma)$。偏应力张量 $\\mathbf{s}$ 定义为 $\\mathbf{s} = \\sigma - \\sigma_m I$，其中 $\\sigma_m$ 是平均（静水）应力，$I$ 是 $3 \\times 3$ 单位矩阵。\n平均应力是应力张量的迹除以 $3$：\n$$ \\sigma_m = \\frac{1}{3}(\\sigma_{xx} + \\sigma_{yy} + \\sigma_{zz}) = \\frac{1}{3}(3.84 + 3.36 + 0) = \\frac{7.20}{3} = 2.40\\,\\text{GPa} $$\n现在我们计算偏应力张量的分量：\n$$ s_{xx} = \\sigma_{xx} - \\sigma_m = 3.84 - 2.40 = 1.44\\,\\text{GPa} $$\n$$ s_{yy} = \\sigma_{yy} - \\sigma_m = 3.36 - 2.40 = 0.96\\,\\text{GPa} $$\n$$ s_{zz} = \\sigma_{zz} - \\sigma_m = 0 - 2.40 = -2.40\\,\\text{GPa} $$\n$$ s_{xy} = \\sigma_{xy} = 0.84\\,\\text{GPa} $$\n$$ s_{xz} = \\sigma_{xz} = 0\\,\\text{GPa} $$\n$$ s_{yz} = \\sigma_{yz} = 0\\,\\text{GPa} $$\n因此，偏应力张量为：\n$$ \\mathrm{dev}(\\sigma) = \\begin{bmatrix} 1.44 & 0.84 & 0 \\\\ 0.84 & 0.96 & 0 \\\\ 0 & 0 & -2.40 \\end{bmatrix} \\text{ GPa} $$\n\n最后，我们评估所提供的选项。\n\nA. $\\displaystyle \\begin{bmatrix} 1.44 & 0.84 & 0 \\\\ 0.84 & 0.96 & 0 \\\\ 0 & 0 & -2.40 \\end{bmatrix}$\n该矩阵与我们计算出的偏应力张量逐分量匹配。\n结论：**正确**。\n\nB. $\\displaystyle \\begin{bmatrix} 0.24 & 0.84 & 0 \\\\ 0.84 & -0.24 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}$\n对角分量 ($s_{xx}$, $s_{yy}$, $s_{zz}$) 不正确。要成为偏量张量，其迹必须为零。$0.24 + (-0.24) + 0 = 0$。虽然它是一个偏量张量，但它不是与计算出的应力状态相对应的那个。分量 $s_{zz}=0$ 意味着 $\\sigma_m = \\sigma_{zz} = 0$，而这对于本问题是不成立的。\n结论：**不正确**。\n\nC. $\\displaystyle \\begin{bmatrix} 0.96 & 0.84 & 0 \\\\ 0.84 & 0.48 & 0 \\\\ 0 & 0 & -1.44 \\end{bmatrix}$\n对角分量不正确。其迹为 $0.96 + 0.48 - 1.44 = 0$，所以它是一个偏量张量。然而，如果 $s_{xx} = 0.96$，那么 $\\sigma_m = \\sigma_{xx} - s_{xx} = 3.84 - 0.96 = 2.88\\,\\text{GPa}$。如果这是正确的，那么 $s_{yy}$ 将是 $\\sigma_{yy} - \\sigma_m = 3.36 - 2.88 = 0.48\\,\\text{GPa}$（与选项匹配），但 $s_{zz}$ 将是 $\\sigma_{zz} - \\sigma_m = 0 - 2.88 = -2.88\\,\\text{GPa}$，这与选项中提供的 $-1.44\\,\\text{GPa}$ 的值不匹配。因此，这个矩阵是不一致的。\n结论：**不正确**。\n\nD. $\\displaystyle \\begin{bmatrix} 1.44 & 0.42 & 0 \\\\ 0.42 & 0.96 & 0 \\\\ 0 & 0 & -2.40 \\end{bmatrix}$\n非对角分量 $s_{xy}$ 不正确。值 $0.42$ 恰好是正确值 $0.84$ 的一半。这个错误源于错误地将剪切应力计算为 $\\sigma_{xy} = G \\varepsilon_{xy}$，而不是正确的 $\\sigma_{xy} = G \\gamma_{xy} = 2G\\varepsilon_{xy}$。具体来说，$12 \\times 0.035 = 0.42$。对角分量与我们的计算相符，这表明平均应力是根据一个（除了剪切分量外）正确的应力张量计算出来的。\n结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2554896"}, {"introduction": "在有限元分析中，应力通常在单元内部的高斯点上计算，因为这些点具有超收敛性，即数值解的精度更高。然而，为了得到整个模型的应力云图，我们需要将这些离散点的值恢复到节点上。本练习将演示一种常用的方法——从高斯点应力值外推计算节点应力，并引导你探讨一个关键问题：当单元形状不规则（即发生扭曲）时，这种外推法的精度会受到怎样的影响。[@problem_id:2554915]", "problem": "在有限元法 (FEM) 的一个平面问题中，使用了一个四节点等参双线性四边形单元。该单元在物理空间中的节点坐标（单位：米）为：节点 1:(0,0)，节点 2:(2.3,0.1)，节点 3:(2.1,1.2)，以及节点 4:(-0.2,1.0)。一个标量应力分量（单位：兆帕，MPa）已通过高斯积分在父单元正方形的标准二乘二高斯点处计算得出，其自然坐标为 $(\\xi,\\eta)\\in\\{\\pm 1/\\sqrt{3}\\}\\times\\{\\pm 1/\\sqrt{3}\\}$。四个高斯点的顺序如下：\n- 高斯点 1: $(\\xi,\\eta)=(-1/\\sqrt{3},-1/\\sqrt{3})$，\n- 高斯点 2: $(\\xi,\\eta)=(+1/\\sqrt{3},-1/\\sqrt{3})$，\n- 高斯点 3: $(\\xi,\\eta)=(+1/\\sqrt{3},+1/\\sqrt{3})$，\n- 高斯点 4: $(\\xi,\\eta)=(-1/\\sqrt{3},+1/\\sqrt{3})$。\n在这些点上，计算出的应力值（单位：MPa）为\n$$\\sigma_{g,1}=102,\\quad \\sigma_{g,2}=110,\\quad \\sigma_{g,3}=125,\\quad \\sigma_{g,4}=115.$$\n\n仅使用与父单元上标量场的双线性插值一致的线性外推法，通过反转由双线性形函数定义的从节点值到高斯点值的映射，计算四个节点应力 $\\sigma_{n,1},\\sigma_{n,2},\\sigma_{n,3},\\sigma_{n,4}$。将最终答案表示为一个包含四个条目的单行向量（单位：MPa），并将每个条目四舍五入至四位有效数字。\n\n然后，基于等参映射和应变-位移形成的基本原理，利用给定的节点几何形状来支持您的论证，简要讨论网格畸变如何影响该单元节点应力外推的准确性和有界性。您的讨论应引用在等参框架中定义的量，并且任何定量说明都必须与该框架保持一致。\n\n答案规范：\n- 提供最终的节点应力，单位为 MPa。\n- 将四个值均四舍五入至四位有效数字。\n- 按节点顺序 $(1,2,3,4)$ 报告最终的行向量。", "solution": "问题陈述经评估有效。这是一个有限元后处理中的标准、适定问题，基于既定的科学原理，并提供了所有必要的数据。\n\n主要任务是根据给定的 $2 \\times 2$ 高斯积分点上的应力值 $\\sigma_{g,j}$ 计算节点应力 $\\sigma_{n,i}$。指定的方法是与父单元上标量场的双线性插值一致的线性外推法。这意味着假设父单元内的应力场 $\\sigma(\\xi, \\eta)$ 由用于等参单元的相同双线性形函数表示：\n$$ \\sigma(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) \\sigma_{n,i} $$\n其中 $\\sigma_{n,i}$ 是未知的节点应力，而 $N_i(\\xi, \\eta)$ 是定义在父单元正方形域 $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ 上的四节点四边形单元的双线性形函数。形函数为：\n$$ N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) $$\n$$ N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) $$\n$$ N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) $$\n$$ N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta) $$\n父单元中的节点坐标为：节点 $1: (-1, -1)$，节点 $2: (1, -1)$，节点 $3: (1, 1)$，以及节点 $4: (-1, 1)$。\n\n给定的应力值 $\\sigma_{g,j}$ 是在四个高斯点 $(\\xi_j, \\eta_j)$ 处评估的。令 $\\alpha = 1/\\sqrt{3}$。高斯点为：\n- 高斯点 $1$: $(\\xi_1, \\eta_1) = (-\\alpha, -\\alpha)$\n- 高斯点 $2$: $(\\xi_2, \\eta_2) = (\\alpha, -\\alpha)$\n- 高斯点 $3$: $(\\xi_3, \\eta_3) = (\\alpha, \\alpha)$\n- 高斯点 $4$: $(\\xi_4, \\eta_4) = (-\\alpha, \\alpha)$\n\n我们建立一个由四个线性方程组成的系统，将已知的高斯点应力与未知的节点应力联系起来：\n$$ \\sigma_{g,j} = \\sum_{i=1}^{4} N_i(\\xi_j, \\eta_j) \\sigma_{n,i} \\quad \\text{for } j = 1, 2, 3, 4 $$\n用矩阵形式表示为 $\\{\\sigma_g\\} = [N] \\{\\sigma_n\\}$，其中 $\\{\\sigma_g\\} = [\\sigma_{g,1}, \\sigma_{g,2}, \\sigma_{g,3}, \\sigma_{g,4}]^T$, $\\{\\sigma_n\\} = [\\sigma_{n,1}, \\sigma_{n,2}, \\sigma_{n,3}, \\sigma_{n,4}]^T$，而 $[N]$ 是在高斯点处求值的形函数矩阵，其元素为 $N_{ji} = N_i(\\xi_j, \\eta_j)$。\n\n为了求得节点应力，我们必须反转这个关系：$\\{\\sigma_n\\} = [N]^{-1} \\{\\sigma_g\\}$。矩阵 $[E] = [N]^{-1}$ 是外推矩阵。\n一种更直接求 $[E]$ 的方法是构造一组双线性形式的函数 $L_j(\\xi, \\eta)$，使得 $L_j(\\xi_k, \\eta_k) = \\delta_{jk}$，其中 $\\delta_{jk}$ 是克罗内克 delta。于是，应力场可以表示为从高斯点值进行的插值：$\\sigma(\\xi, \\eta) = \\sum_{j=1}^{4} L_j(\\xi, \\eta) \\sigma_{g,j}$。然后通过在节点坐标 $(\\xi_i, \\eta_i)$ 处评估此表达式来找到节点应力：$\\sigma_{n,i} = \\sigma(\\xi_i, \\eta_i) = \\sum_{j=1}^{4} L_j(\\xi_i, \\eta_i) \\sigma_{g,j}$。外推矩阵的元素为 $E_{ij} = L_j(\\xi_i, \\eta_i)$。\n\n函数 $L_j(\\xi, \\eta)$ 被确定为：\n$$ L_1(\\xi, \\eta) = \\frac{1}{4}(1 - \\sqrt{3}\\xi - \\sqrt{3}\\eta + 3\\xi\\eta) $$\n$$ L_2(\\xi, \\eta) = \\frac{1}{4}(1 + \\sqrt{3}\\xi - \\sqrt{3}\\eta - 3\\xi\\eta) $$\n$$ L_3(\\xi, \\eta) = \\frac{1}{4}(1 + \\sqrt{3}\\xi + \\sqrt{3}\\eta + 3\\xi\\eta) $$\n$$ L_4(\\xi, \\eta) = \\frac{1}{4}(1 - \\sqrt{3}\\xi + \\sqrt{3}\\eta - 3\\xi\\eta) $$\n我们在节点坐标 $(\\pm 1, \\pm 1)$ 处评估这些函数，以构造外推矩阵 $[E]$。对于节点 $1$，其坐标为 $(\\xi_1, \\eta_1)=(-1, -1)$：\n$E_{11} = L_1(-1, -1) = \\frac{1}{4}(1 + \\sqrt{3} + \\sqrt{3} + 3) = 1 + \\frac{\\sqrt{3}}{2}$\n$E_{12} = L_2(-1, -1) = \\frac{1}{4}(1 - \\sqrt{3} + \\sqrt{3} - 3) = -\\frac{1}{2}$\n$E_{13} = L_3(-1, -1) = \\frac{1}{4}(1 - \\sqrt{3} - \\sqrt{3} + 3) = 1 - \\frac{\\sqrt{3}}{2}$\n$E_{14} = L_4(-1, -1) = \\frac{1}{4}(1 + \\sqrt{3} - \\sqrt{3} - 3) = -\\frac{1}{2}$\n根据对称性，完整的外推矩阵为：\n$$ [E] = \\begin{pmatrix}\n1+\\frac{\\sqrt{3}}{2} & -\\frac{1}{2} & 1-\\frac{\\sqrt{3}}{2} & -\\frac{1}{2} \\\\\n-\\frac{1}{2} & 1+\\frac{\\sqrt{3}}{2} & -\\frac{1}{2} & 1-\\frac{\\sqrt{3}}{2} \\\\\n1-\\frac{\\sqrt{3}}{2} & -\\frac{1}{2} & 1+\\frac{\\sqrt{3}}{2} & -\\frac{1}{2} \\\\\n-\\frac{1}{2} & 1-\\frac{\\sqrt{3}}{2} & -\\frac{1}{2} & 1+\\frac{\\sqrt{3}}{2}\n\\end{pmatrix} $$\n给定的高斯点应力为 $\\{\\sigma_g\\} = [102, 110, 125, 115]^T$ MPa。我们执行矩阵-向量乘法 $\\{\\sigma_n\\} = [E]\\{\\sigma_g\\}$：\n\n$\\sigma_{n,1} = (1 + \\frac{\\sqrt{3}}{2})(102) - \\frac{1}{2}(110) + (1 - \\frac{\\sqrt{3}}{2})(125) - \\frac{1}{2}(115) = 114.5 - 11.5\\sqrt{3} \\approx 94.5814$\n$\\sigma_{n,2} = -\\frac{1}{2}(102) + (1 + \\frac{\\sqrt{3}}{2})(110) - \\frac{1}{2}(125) + (1 - \\frac{\\sqrt{3}}{2})(115) = 111.5 - 2.5\\sqrt{3} \\approx 107.1699$\n$\\sigma_{n,3} = (1 - \\frac{\\sqrt{3}}{2})(102) - \\frac{1}{2}(110) + (1 + \\frac{\\sqrt{3}}{2})(125) - \\frac{1}{2}(115) = 114.5 + 11.5\\sqrt{3} \\approx 134.4186$\n$\\sigma_{n,4} = -\\frac{1}{2}(102) + (1 - \\frac{\\sqrt{3}}{2})(110) - \\frac{1}{2}(125) + (1 + \\frac{\\sqrt{3}}{2})(115) = 111.5 + 2.5\\sqrt{3} \\approx 115.8301$\n\n四舍五入到四位有效数字，得到节点应力：\n$\\sigma_{n,1} = 94.58$ MPa\n$\\sigma_{n,2} = 107.2$ MPa\n$\\sigma_{n,3} = 134.4$ MPa\n$\\sigma_{n,4} = 115.8$ MPa\n\n关于网格畸变的影响，该外推过程的准确性和有界性会受到严重影响。\n这种外推的基本假设是应力场 $\\sigma(\\xi, \\eta)$ 在父单元内是双线性的。这个假设通常是不成立的。在等参格式中，应变以及应力是通过形函数对物理坐标 $(x, y)$ 的导数来计算的。这些导数通过雅可比矩阵 $\\mathbf{J}$ 的逆矩阵获得：\n$$ \\begin{Bmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{Bmatrix} = \\mathbf{J}^{-1} \\begin{Bmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{Bmatrix} \\quad \\text{其中} \\quad \\mathbf{J} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix} $$\n对于一个普遍的畸变四边形，$\\mathbf{J}$ 的分量是 $\\xi$ 和 $\\eta$ 的线性函数。因此，其行列式 $\\det(\\mathbf{J})$ 是一个二次函数，而 $\\mathbf{J}^{-1}$ 的分量是有理函数（一个关于 $\\xi, \\eta$ 的一次多项式除以一个二次多项式）。这意味着从假定的双线性位移场推导出的真实应变场和应力场不是简单的多项式，而是关于 $(\\xi, \\eta)$ 的复杂有理函数。\n\n对于给定的单元几何形状，其节点为 $1:(0,0)$、$2:(2.3,0.1)$、$3:(2.1,1.2)$、$4:(-0.2,1.0)$，雅可比行列式为 $\\det(\\mathbf{J}) = 0.61125 + 0.02875\\xi + 0.0025\\eta$。$\\det(\\mathbf{J})$ 不是常数这一事实，是该单元偏离平行四边形（其 $\\mathbf{J}$ 为常数）程度的定量度量。这种变化（尽管在本例中很小）确保了应变场不是线性的。用一个简单的双线性函数来近似这个复杂的有理应力场是外推误差的来源。当畸变变得更严重时（即，当 $\\det(\\mathbf{J})$ 在单元上的变化增大时），这个误差会增大。\n\n此外，外推过程是无界的。外推矩阵 $[E]$ 包含大于 $1$ 的系数（例如，$1 + \\frac{\\sqrt{3}}{2} \\approx 1.866$）和负系数（例如，$-0.5$）。这意味着外推得到的节点值不是高斯点值的凸组合，并且不保证位于这些值的范围之内。我们的结果证明了这一点：最小的外推节点应力（$\\sigma_{n,1} \\approx 94.58$ MPa）低于最小的高斯点应力（$102$ MPa），而最大的外推节点应力（$\\sigma_{n,3} \\approx 134.4$ MPa）高于最大的高斯点应力（$125$ MPa）。对于高度畸变的单元或在高应力梯度的区域，这种外推可能导致显著的、物理上不现实的过冲和振荡，从而损害节点应力结果的可靠性。", "answer": "$$\n\\boxed{\\begin{pmatrix} 94.58 & 107.2 & 134.4 & 115.8 \\end{pmatrix}}\n$$", "id": "2554915"}, {"introduction": "简单外推法在存在网格扭曲时会引入显著误差，为了获得更精确的节点应力，工程师们发展了更复杂的恢复技术。本练习将介绍一种强大且广泛使用的方法——超收敛片恢复（Superconvergent Patch Recovery, SPR）。你将学习如何通过对节点周围“片”内的多个高斯点应力值进行多项式最小二乘拟合，来构建一个连续且更高精度的局部应力场，从而得到更可靠的节点应力值。[@problem_id:2554876]", "problem": "在有限元法 (FEM) 中，采用一种片恢复程序进行应力后处理。考虑一个二维小应变线弹性分析，其中一个节点位于原点 $(x,y)=(0,0)$。在该节点周围的一个单元片中，给定了以下六个高斯点的全局坐标及其对应的计算出的柯西正应力分量 $\\sigma_{xx}$（单位一致，为简洁起见已省略）：\n- $(x,y)=(1,0)$ 处 $\\sigma_{xx}=6$，\n- $(x,y)=(-1,0)$ 处 $\\sigma_{xx}=0$，\n- $(x,y)=(0,1)$ 处 $\\sigma_{xx}=0$，\n- $(x,y)=(0,-1)$ 处 $\\sigma_{xx}=2$，\n- $(x,y)=(1,1)$ 处 $\\sigma_{xx}=6$，\n- $(x,y)=(-1,1)$ 处 $\\sigma_{xx}=-4$。\n\n假设在该节点邻域内，$\\sigma_{xx}(x,y)$ 可以用以下形式的二次多项式很好地近似\n$$\n\\sigma_{xx}(x,y)\\approx a_0 + a_1 x + a_2 y + a_3 x^2 + a_4 x y + a_5 y^2,\n$$\n其中系数向量为 $\\mathbf{a}=[a_0,\\;a_1,\\;a_2,\\;a_3,\\;a_4,\\;a_5]^T$。使用对给定高斯点数据的非加权最小二乘拟合，确定恢复的系数 $\\mathbf{a}$ 并评估该节点处的恢复节点应力 $\\sigma_{xx}$，即在 $(x,y)=(0,0)$ 处的值。\n\n选择正确的选项：\n- A. $\\mathbf{a}=[\\,2,\\;3,\\;-1,\\;1,\\;2,\\;-1\\,]^T$，节点 $\\sigma_{xx}=2$。\n- B. $\\mathbf{a}=[\\,3,\\;3,\\;-3,\\;0,\\;0,\\;0\\,]^T$，节点 $\\sigma_{xx}=3$。\n- C. $\\mathbf{a}=[\\,2,\\;3,\\;-1,\\;1,\\;0,\\;-1\\,]^T$，节点 $\\sigma_{xx}=2$。\n- D. $\\mathbf{a}=[\\,2,\\;3,\\;-1,\\;0,\\;2,\\;-1\\,]^T$，节点 $\\sigma_{xx}=2$。", "solution": "首先将对问题陈述的科学性和逻辑完整性进行验证。\n\n**步骤1：提取已知条件**\n\n给定的信息如下：\n- 一个二维小应变线弹性分析中的片恢复程序。\n- 目标节点位于原点，坐标为 $(x,y)=(0,0)$。\n- 提供了六个高斯点的位置和应力数据对：\n    1. 在 $(x,y)=(1,0)$ 处，应力为 $\\sigma_{xx}=6$。\n    2. 在 $(x,y)=(-1,0)$ 处，应力为 $\\sigma_{xx}=0$。\n    3. 在 $(x,y)=(0,1)$ 处，应力为 $\\sigma_{xx}=0$。\n    4. 在 $(x,y)=(0,-1)$ 处，应力为 $\\sigma_{xx}=2$。\n    5. 在 $(x,y)=(1,1)$ 处，应力为 $\\sigma_{xx}=6$。\n    6. 在 $(x,y)=(-1,1)$ 处，应力为 $\\sigma_{xx}=-4$。\n- 应力场 $\\sigma_{xx}(x,y)$ 由一个二次多项式近似：\n$$\n\\sigma_{xx}(x,y)\\approx a_0 + a_1 x + a_2 y + a_3 x^2 + a_4 x y + a_5 y^2\n$$\n- 需使用非加权最小二乘拟合来确定系数 $\\mathbf{a}=[a_0, a_1, a_2, a_3, a_4, a_5]^T$。\n- 目标是找到向量 $\\mathbf{a}$ 和在 $(x,y)=(0,0)$ 处的恢复节点应力 $\\sigma_{xx}$。\n\n**步骤2：使用提取的已知条件进行验证**\n\n该问题具有科学依据。片恢复，特别是 Zienkiewicz-Zhu 超收敛片恢复法，是有限元法中一种标准的、广泛使用的后处理技术，用于获得更准确的应力值，尤其是在节点处。该方法的核心包括对单元片内高斯点处的超收敛应力值进行多项式拟合，然后使用该多项式插值得到节点处的应力。\n\n该问题是适定的。它提供了六个数据点，并要求确定一个多项式展开的六个未知系数。这导出一个线性代数方程组。所提供的数据足以构建该方程组。该问题是客观的，并以数学精度陈述，不包含歧义或事实错误。这是计算力学背景下数值分析的一个标准应用。\n\n**步骤3：结论与行动**\n\n问题有效。将继续进行求解。\n\n**求解推导**\n\n目标是找到多项式近似\n$$\n\\sigma_{xx}(x,y) = a_0 + a_1 x + a_2 y + a_3 x^2 + a_4 xy + a_5 y^2\n$$\n的系数 $\\mathbf{a} = [a_0, a_1, a_2, a_3, a_4, a_5]^T$，使得该多项式以最小二乘意义上最佳地拟合给定数据。非加权最小二乘法旨在最小化残差平方和 $S$：\n$$\nS = \\sum_{i=1}^{6} \\left( (a_0 + a_1 x_i + a_2 y_i + a_3 x_i^2 + a_4 x_i y_i + a_5 y_i^2) - (\\sigma_{xx})_i \\right)^2\n$$\n最小值的必要条件是对于 $j=0, 1, \\dots, 5$，有 $\\frac{\\partial S}{\\partial a_j} = 0$。这导出一个线性方程组 $\\mathbf{H}^T \\mathbf{H} \\mathbf{a} = \\mathbf{H}^T \\mathbf{b}$，其中 $\\mathbf{H}$ 是设计矩阵，$\\mathbf{b}$ 是应力值向量。\n\n在这个具体问题中，数据点数量（$N=6$）等于未知系数的数量（$6$）。因此，矩阵 $\\mathbf{H}$ 是一个方阵，最小二乘问题简化为求解线性系统 $\\mathbf{H} \\mathbf{a} = \\mathbf{b}$，前提是 $\\mathbf{H}$ 可逆。\n\n让我们通过将每个数据点代入多项式来构建方程组：\n1. $(x,y)=(1,0), \\sigma_{xx}=6$: $a_0 + a_1(1) + a_2(0) + a_3(1)^2 + a_4(1)(0) + a_5(0)^2 = a_0 + a_1 + a_3 = 6$\n2. $(x,y)=(-1,0), \\sigma_{xx}=0$: $a_0 + a_1(-1) + a_2(0) + a_3(-1)^2 + a_4(-1)(0) + a_5(0)^2 = a_0 - a_1 + a_3 = 0$\n3. $(x,y)=(0,1), \\sigma_{xx}=0$: $a_0 + a_1(0) + a_2(1) + a_3(0)^2 + a_4(0)(1) + a_5(1)^2 = a_0 + a_2 + a_5 = 0$\n4. $(x,y)=(0,-1), \\sigma_{xx}=2$: $a_0 + a_1(0) + a_2(-1) + a_3(0)^2 + a_4(0)(-1) + a_5(-1)^2 = a_0 - a_2 + a_5 = 2$\n5. $(x,y)=(1,1), \\sigma_{xx}=6$: $a_0 + a_1(1) + a_2(1) + a_3(1)^2 + a_4(1)(1) + a_5(1)^2 = a_0 + a_1 + a_2 + a_3 + a_4 + a_5 = 6$\n6. $(x,y)=(-1,1), \\sigma_{xx}=-4$: $a_0 + a_1(-1) + a_2(1) + a_3(-1)^2 + a_4(-1)(1) + a_5(1)^2 = a_0 - a_1 + a_2 + a_3 - a_4 + a_5 = -4$\n\n我们得到了一个包含六个未知数的六个线性方程组。\n由方程(1)和(2)可得：\n(1) $a_0 + a_1 + a_3 = 6$\n(2) $a_0 - a_1 + a_3 = 0$\n将(1)和(2)相加：$2a_0 + 2a_3 = 6 \\implies a_0 + a_3 = 3$。\n将(1)减去(2)：$2a_1 = 6 \\implies a_1 = 3$。\n\n由方程(3)和(4)可得：\n(3) $a_0 + a_2 + a_5 = 0$\n(4) $a_0 - a_2 + a_5 = 2$\n将(3)和(4)相加：$2a_0 + 2a_5 = 2 \\implies a_0 + a_5 = 1$。\n将(3)减去(4)：$2a_2 = -2 \\implies a_2 = -1$。\n\n现在我们有 $a_1=3$ 和 $a_2=-1$。该方程组可以简化。根据我们推导出的关系：\n$a_3 = 3 - a_0$\n$a_5 = 1 - a_0$\n\n将这些已知值和表达式代入方程(5)和(6)。\n使用方程(5)：\n$6 = a_0 + a_1 + a_2 + a_3 + a_4 + a_5 = a_0 + (3) + (-1) + (3 - a_0) + a_4 + (1 - a_0)$\n$6 = (a_0 - a_0 - a_0) + (3 - 1 + 3 + 1) + a_4$\n$6 = -a_0 + 6 + a_4 \\implies -a_0 + a_4 = 0 \\implies a_4 = a_0$。\n\n使用方程(6)：\n$-4 = a_0 - a_1 + a_2 + a_3 - a_4 + a_5 = a_0 - (3) + (-1) + (3 - a_0) - a_4 + (1 - a_0)$\n$-4 = (a_0 - a_0 - a_0) + (-3 - 1 + 3 + 1) - a_4$\n$-4 = -a_0 + 0 - a_4 \\implies -a_0 - a_4 = -4 \\implies a_0 + a_4 = 4$。\n\n我们现在得到了一个关于 $a_0$ 和 $a_4$ 的简单方程组：\n$a_4 = a_0$\n$a_0 + a_4 = 4$\n将第一个方程代入第二个方程得到：$a_0 + a_0 = 4 \\implies 2a_0 = 4 \\implies a_0 = 2$。\n由此，我们得出 $a_4 = 2$。\n\n最后，我们确定剩余的系数：\n$a_3 = 3 - a_0 = 3 - 2 = 1$。\n$a_5 = 1 - a_0 = 1 - 2 = -1$。\n\n完整的系数向量是 $\\mathbf{a} = [a_0, a_1, a_2, a_3, a_4, a_5]^T = [2, 3, -1, 1, 2, -1]^T$。\n\n在原点 $(x,y)=(0,0)$ 处的恢复节点应力通过多项式计算得出：\n$\\sigma_{xx}(0,0) = a_0 + a_1(0) + a_2(0) + a_3(0)^2 + a_4(0)(0) + a_5(0)^2 = a_0$。\n因此，节点应力为 $\\sigma_{xx}(0,0) = 2$。\n\n**选项评估**\n\n- **A. $\\mathbf{a}=[\\,2,\\;3,\\;-1,\\;1,\\;2,\\;-1\\,]^T$，节点 $\\sigma_{xx}=2$。**\n计算出的系数向量为 $\\mathbf{a}=[2, 3, -1, 1, 2, -1]^T$，与该选项匹配。计算出的节点应力为 $\\sigma_{xx}(0,0) = a_0 = 2$，也匹配。\n**结论：正确。**\n\n- **B. $\\mathbf{a}=[\\,3,\\;3,\\;-3,\\;0,\\;0,\\;0\\,]^T$，节点 $\\sigma_{xx}=3$。**\n系数向量不正确。例如，我们的计算得出 $a_0=2$，而不是 $a_0=3$，以及 $a_2=-1$，而不是 $a_2=-3$。节点应力为 $\\sigma_{xx}=a_0=3$，也是不正确的。如果我们将此向量代入方程(4)进行检验，$a_0 - a_2 + a_5 = 3 - (-3) + 0 = 6$，而它应为 $2$。该选项无效。\n**结论：不正确。**\n\n- **C. $\\mathbf{a}=[\\,2,\\;3,\\;-1,\\;1,\\;0,\\;-1\\,]^T$，节点 $\\sigma_{xx}=2$。**\n该向量的 $a_4=0$，而我们的计算表明 $a_4=2$。尽管 $a_0=2$ 与节点应力部分匹配，但向量本身不正确。用此向量检验方程(5)：$a_0+a_1+a_2+a_3+a_4+a_5 = 2+3-1+1+0-1 = 4$，而它应为 $6$。该选项无效。\n**结论：不正确。**\n\n- **D. $\\mathbf{a}=[\\,2,\\;3,\\;-1,\\;0,\\;2,\\;-1\\,]^T$，节点 $\\sigma_{xx}=2$。**\n该向量的 $a_3=0$，而我们的计算表明 $a_3=1$。向量不正确。用此向量检验方程(1)：$a_0+a_1+a_3 = 2+3+0=5$，而它应为 $6$。该选项无效。\n**结论：不正确。**\n\n只有选项A与推导出的解答一致。", "answer": "$$\\boxed{A}$$", "id": "2554876"}]}