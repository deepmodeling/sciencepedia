{"hands_on_practices": [{"introduction": "理论知识只有通过实践才能真正掌握。本节的第一个练习将引导你详细地解决一个典型的一维泊松问题。我们将使用消除法，这是处理本质边界条件最直接的方法，它通过代数操作将已知的边界自由度从全局系统中移除，从而得到一个只包含内部未知数的简化系统。这个练习 [@problem_id:2555754] 不仅能让你练习组装全局刚度矩阵和载荷向量，还能让你通过推导和求解简化后的系统，深入理解消除法的核心机制。", "problem": "考虑在区间 $[0,1]$ 上的边值问题 $-u''(x)=1$，其本质（狄利克雷）边界条件为 $u(0)=0$ 和 $u(1)=1$。在大小为 $h=1/N$ 的 $N$ 个单元组成的均匀网格上，使用有限元法（FEM）和分片线性（$\\mathbb{P}_1$）基函数，节点为 $x_i=i h$，其中 $i=0,1,\\dots,N$。\n\na) 从弱形式出发，使用 $\\mathbb{P}_1$ 单元的标准单元矩阵和一致载荷向量，组装施加本质边界条件之前的全局线性系统。然后，通过消元法施加本质边界条件，推导出关于内部节点未知数 $u_1,\\dots,u_{N-1}$ 的降阶三对角线性系统。用 $h$ 明确写出这个降阶系统。\n\nb) 解析求解该降阶三对角系统，以获得每个内部节点值 $u_i$ 作为 $i$ 和 $N$ 的函数的闭式表达式。\n\nc) 为了与罚函数法建立联系，描述如何通过在边界节点上添加大的罚项来施加本质边界条件，并解释（无需计算）为什么当罚参数趋于 $+\\infty$ 时，施加罚函数后的系统的解会收敛到通过消元法获得的相同内部节点值。\n\n请提供您的最终答案，形式为关于任意内部节点索引 $i\\in\\{1,2,\\dots,N-1\\}$ 的 $u_i$ 以 $i$ 和 $N$ 表示的单个闭式解析表达式。无需四舍五入，不涉及单位。", "solution": "给定的问题陈述是关于一维边值问题的有限元法（FEM）的一个标准练习。它在数学上是适定的，在科学上是合理的，并包含了获得唯一解所需的所有信息。因此，该问题被认为是有效的。\n\n问题是求解边值问题（BVP）：\n$$ -u''(x) = 1, \\quad x \\in [0, 1] $$\n其狄利克雷边界条件为 $u(0)=0$ 和 $u(1)=1$。我们采用有限元离散化，在由 $N$ 个尺寸为 $h = 1/N$ 的单元组成的均匀网格上使用分片线性（$\\mathbb{P}_1$）基函数。\n\n首先，我们推导弱形式。我们将微分方程乘以一个来自在本质边界上为零的函数空间（即 $v \\in H_0^1(0,1)$）的检验函数 $v(x)$，并在定义域 $[0,1]$ 上积分：\n$$ -\\int_{0}^{1} u''(x) v(x) dx = \\int_{0}^{1} 1 \\cdot v(x) dx $$\n对左侧应用分部积分得到：\n$$ \\int_{0}^{1} u'(x) v'(x) dx - [u'(x)v(x)]_{0}^{1} = \\int_{0}^{1} v(x) dx $$\n由于检验函数 $v(x)$ 必须满足本质边界条件的齐次形式，我们有 $v(0)=0$ 和 $v(1)=0$。因此边界项 $[u'(x)v(x)]_{0}^{1}$ 为零。弱形式是：求 $u \\in H^1(0,1)$，使得 $u(0)=0$，$u(1)=1$，并且对于所有 $v \\in H_0^1(0,1)$：\n$$ \\int_{0}^{1} u'(x) v'(x) dx = \\int_{0}^{1} v(x) dx $$\n双线性形式为 $a(u,v) = \\int_{0}^{1} u'(x) v'(x) dx$，线性泛函为 $L(v) = \\int_{0}^{1} v(x) dx$。\n\n我们通过将解 $u(x)$ 近似为节点基函数 $\\phi_j(x)$ 的线性组合来离散化问题：$u_h(x) = \\sum_{j=0}^{N} u_j \\phi_j(x)$，其中 $u_j$ 是未知的节点值 $u_j \\approx u(x_j)$。伽辽金法将检验函数设置为基函数，即 $v(x) = \\phi_i(x)$，适用于所有自由节点 $i=1, 2, \\dots, N-1$。代入弱形式得到线性方程组：\n$$ \\sum_{j=0}^{N} u_j \\left( \\int_{0}^{1} \\phi_j'(x) \\phi_i'(x) dx \\right) = \\int_{0}^{1} \\phi_i(x) dx, \\quad \\text{对于 } i=1, \\dots, N-1 $$\n这就是系统 $K U = F$，其中 $K_{ij} = a(\\phi_j, \\phi_i)$ 是刚度矩阵，$F_i = L(\\phi_i)$ 是载荷向量。\n\n对于长度为 $h$ 的一个一般单元 $e = [x_k, x_{k+1}]$，对 $-u''=1$ 进行 $\\mathbb{P}_1$ 近似的标准单元刚度矩阵 $K^e$ 和一致单元载荷向量 $F^e$ 为：\n$$ K^e = \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}, \\quad F^e = \\int_{x_k}^{x_{k+1}} 1 \\cdot \\begin{pmatrix} \\phi_k(x) \\\\ \\phi_{k+1}(x) \\end{pmatrix} dx = \\frac{h}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\n将所有 $N$ 个单元的这些单元级贡献组装起来，得到全局 $(N+1) \\times (N+1)$ 系统 $K U = F$，其中 $U = [u_0, u_1, \\dots, u_N]^T$：\n$$ \\frac{1}{h} \\begin{pmatrix} 1 & -1 & 0 & \\dots & 0 \\\\ -1 & 2 & -1 & \\dots & 0 \\\\ 0 & -1 & 2 & \\ddots & \\vdots \\\\ \\vdots & & \\ddots & \\ddots & -1 \\\\ 0 & \\dots & \\dots & -1 & 1 \\end{pmatrix} \\begin{pmatrix} u_0 \\\\ u_1 \\\\ u_2 \\\\ \\vdots \\\\ u_N \\end{pmatrix} = \\begin{pmatrix} h/2 \\\\ h \\\\ h \\\\ \\vdots \\\\ h/2 \\end{pmatrix} $$\n这是施加边界条件*之前*的全局系统。\n\na) 通过消元法施加本质边界条件：\n给定 $u(0)=0$ 和 $u(1)=1$，这对应于节点值 $u_0=0$ 和 $u_N=1$。未知数是内部节点值 $u_1, u_2, \\dots, u_{N-1}$。我们考虑内部节点 $i=1, \\dots, N-1$ 的方程。\n全局系统的第 $i$ 个方程是：\n$$ \\frac{1}{h}(-u_{i-1} + 2u_i - u_{i+1}) = h $$\n对于 $i=1$：\n$$ \\frac{1}{h}(-u_0 + 2u_1 - u_2) = h $$\n代入已知值 $u_0=0$：\n$$ \\frac{1}{h}(2u_1 - u_2) = h $$\n对于 $i=2, \\dots, N-2$，方程保持不变：\n$$ \\frac{1}{h}(-u_{i-1} + 2u_i - u_{i+1}) = h $$\n对于 $i=N-1$：\n$$ \\frac{1}{h}(-u_{N-2} + 2u_{N-1} - u_N) = h $$\n代入已知值 $u_N=1$ 并重新整理：\n$$ \\frac{1}{h}(-u_{N-2} + 2u_{N-1}) = h + \\frac{1}{h} u_N = h + \\frac{1}{h} $$\n得到的关于未知数向量 $\\hat{U} = [u_1, \\dots, u_{N-1}]^T$ 的降阶系统是一个 $(N-1) \\times (N-1)$ 的三对角系统 $\\hat{K}\\hat{U}=\\hat{F}$：\n$$ \\frac{1}{h} \\begin{pmatrix} 2 & -1 & 0 & \\dots & 0 \\\\ -1 & 2 & -1 & & \\vdots \\\\ 0 & -1 & 2 & \\ddots & 0 \\\\ \\vdots & & \\ddots & \\ddots & -1 \\\\ 0 & \\dots & 0 & -1 & 2 \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\\\ u_3 \\\\ \\vdots \\\\ u_{N-1} \\end{pmatrix} = \\begin{pmatrix} h \\\\ h \\\\ h \\\\ \\vdots \\\\ h + \\frac{1}{h} \\end{pmatrix} $$\n\nb) 降阶系统的解析解：\n将方程组两边乘以 $h$ ，可将其写成关于节点值 $u_i$ 的二阶线性有限差分方程：\n$$ -u_{i-1} + 2u_i - u_{i+1} = h^2, \\quad \\text{对于 } i=1, \\dots, N-2 $$\n对于 $i=N-1$ 有一个特殊方程：\n$$ -u_{N-2} + 2u_{N-1} = h^2(1) + h(\\frac{1}{h}) = h^2+1 $$\n递推关系 $-u_{i-1} + 2u_i - u_{i+1} = h^2$ 的通解是齐次解（$u_i^h$）和特解（$u_i^p$）的和。\n齐次方程为 $-u_{i-1}^h + 2u_i^h - u_{i+1}^h = 0$。其特征方程为 $-1+2r-r^2=-(r-1)^2=0$，有一个重根 $r=1$。因此，齐次解为 $u_i^h = A \\cdot 1^i + B \\cdot i \\cdot 1^i = A + Bi$。\n对于特解，我们尝试一个关于 $i$ 的多项式。根据中心差分算子的形式，我们假设 $u_i^p = Ci^2$。将其代入方程得到 $-C(i-1)^2 + 2Ci^2 - C(i+1)^2 = h^2$，简化为 $-2C = h^2$，所以 $C = -h^2/2$。\n通解是 $u_i = A + Bi - \\frac{h^2}{2}i^2$。\n常数 $A$ 和 $B$ 由完整节点序列的边界条件 $u_0=0$ 和 $u_N=1$ 确定。\n使用 $u_0=0$：\n$$ u_0 = A + B(0) - \\frac{h^2}{2}(0)^2 = A = 0 $$\n所以，$u_i = Bi - \\frac{h^2}{2}i^2$。\n使用 $u_N=1$：\n$$ u_N = BN - \\frac{h^2}{2}N^2 = 1 $$\n因为 $h=1/N$，所以 $N=1/h$。代入得：\n$$ B(1/h) - \\frac{h^2}{2}(1/h)^2 = 1 \\implies \\frac{B}{h} - \\frac{1}{2} = 1 \\implies B = \\frac{3}{2}h $$\n因此，节点值的解析解是：\n$$ u_i = \\frac{3}{2}hi - \\frac{h^2}{2}i^2 $$\n我们必须验证该解是否满足 $i=N-1$ 处的特殊方程。根据构造，通用的递推关系 $-u_{i-1}+2u_i-u_{i+1}=h^2$ 是满足的。$u_0=0$ 条件是满足的。$u_N=1$ 条件被用来求 $B$ 且是满足的。因此，系统中的所有方程都得到满足。该解是正确的。\n通过代入 $h=1/N$，用 $i$ 和 $N$ 表示解：\n$$ u_i = \\frac{3}{2N}i - \\frac{1}{2N^2}i^2 = \\frac{3Ni - i^2}{2N^2} = \\frac{i(3N-i)}{2N^2} $$\n该表达式是在节点 $x_i = i/N$ 处取值的连续边值问题 $u(x) = -\\frac{1}{2}x^2 + \\frac{3}{2}x$ 的精确解。这种节点精确性是该特定问题 $\\mathbb{P}_1$ 有限元解的一个已知性质。\n\nc) 通过罚函数法施加：\n罚函数法通过向刚度矩阵的对角线添加大项和向载荷向量添加相应项来施加本质边界条件，而不改变系统的规模。对于一个一般条件 $u_k=g$，我们如下修改全局系统 $KU=F$ 的第 $k$ 个方程：\n$$ K_{kk} \\to K_{kk} + \\epsilon $$\n$$ F_k \\to F_k + \\epsilon g $$\n其中 $\\epsilon$ 是一个大的罚参数。这迫使解满足 $u_k \\approx g$。\n对于本问题，有 $u_0=0$ 和 $u_N=1$，我们修改全局系统的第一行（$i=0$）和最后一行（$i=N$）：\n$$ K_{00} \\to K_{00} + \\epsilon = \\frac{1}{h} + \\epsilon; \\quad F_0 \\to F_0 + \\epsilon \\cdot 0 = \\frac{h}{2} $$\n$$ K_{NN} \\to K_{NN} + \\epsilon = \\frac{1}{h} + \\epsilon; \\quad F_N \\to F_N + \\epsilon \\cdot 1 = \\frac{h}{2} + \\epsilon $$\n最终施加罚函数后的系统仍然是 $(N+1) \\times (N+1)$。当 $\\epsilon \\to +\\infty$时，施加罚函数后的系统的解 $U_\\epsilon$ 收敛到边界条件被精确满足的解。第一个方程 $(\\frac{1}{h}+\\epsilon)u_0 - \\frac{1}{h}u_1 = \\frac{h}{2}$ 意味着当 $\\epsilon \\to \\infty$ 时 $u_0 \\to 0$。类似地，最后一个方程 $-\\frac{1}{h}u_{N-1} + (\\frac{1}{h}+\\epsilon)u_N = \\frac{h}{2} + \\epsilon$ 意味着 $u_N \\to 1$。在此极限下，罚函数解的边界值与消元法中使用的边界值相匹配。内部节点（$i=1, \\dots, N-1$）的方程在形式上与原始全局系统中的方程相同，并且与收敛到正确给定值的边界值耦合。因此，从罚函数法获得的内部节点值 $u_1, \\dots, u_{N-1}$ 必然收敛到从消元法获得的相同值。", "answer": "$$ \\boxed{\\frac{i(3N-i)}{2N^{2}}} $$", "id": "2555754"}, {"introduction": "接下来，我们将探讨罚函数法，这是另一种应用广泛的边界条件施加技术，尤其适用于大型、复杂的有限元软件框架。与直接消除自由度不同，罚函数法通过在系统的对角线上增加一个巨大的“惩罚”项来近似地满足本质边界条件。这个练习 [@problem_id:2555746] 将让你在一个简单的二维单元网格上，解析地求解罚函数系统的解。通过计算罚参数 $\\alpha$ 趋于无穷大时的极限，你将亲眼见证罚函数法的解如何收敛到精确施加边界条件（消除法）的解，从而深刻理解其理论基础和有效性。", "problem": "考虑域 $\\Omega=[0,1]$ 上的一个一维模型问题：求解一个标量场 $u$，该场在 $(0,1)$ 上满足强形式 $-\\frac{d^{2}u}{dx^{2}}=0$，并带有本质边界条件 $u(0)=0$ 和 $u(1)=1$。使用协调有限元离散化，在节点为 $x_{1}=0$、$x_{2}=\\tfrac{1}{2}$ 和 $x_{3}=1$ 的均匀网格上（即2个等长的线性单元），采用连续的分段线性试探和检验空间。假设没有体力，没有自然边界条件，并且扩散系数取为 $1$。\n\n不直接施加本质边界条件，而是在边界节点 $x=0$ 和 $x=1$ 处通过罚函数法来施加，罚参数为 $\\alpha>0$，并在代数层面上添加到组装后的系统中。具体来说，组装由弱形式导出的离散双线性形式，并在第一个和最后一个全局自由度上添加罚项贡献，以获得一个依赖于 $\\alpha$ 的修正线性系统。求解该罚化系统，以获得全局节点解向量 $u(\\alpha)=[u_{1}(\\alpha),u_{2}(\\alpha),u_{3}(\\alpha)]$，然后计算当 $\\alpha\\to\\infty$ 时 $u(\\alpha)$ 的极限，并将其与通过消元法得到的解进行比较，消元法精确地施加了 $u_{1}=0$ 和 $u_{3}=1$，并且仅求解内部节点。\n\n所有量均为无量纲。请以单个行向量的形式，提供极限向量 $\\lim_{\\alpha\\to\\infty}u(\\alpha)$ 作为最终答案。最终答案请用精确形式表示（不要四舍五入）。", "solution": "在尝试求解之前，对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n-   微分方程（强形式）：在区间 $(0,1)$ 上为 $-\\frac{d^{2}u}{dx^{2}}=0$。\n-   域：$\\Omega=[0,1]$。\n-   本质边界条件：$u(0)=0$ 和 $u(1)=1$。\n-   有限元离散化：一个协调网格，包含三个节点 $x_{1}=0$、$x_{2}=\\tfrac{1}{2}$ 和 $x_{3}=1$。这对应于两个等长 $h=\\tfrac{1}{2}$ 的线性单元。试探和检验空间是连续的分段线性空间。\n-   模型参数：扩散系数为 $1$。体力为零。在施加本质条件的边界上未指定自然边界条件。\n-   任务：使用罚参数 $\\alpha > 0$ 的罚函数法施加本质边界条件。求解得到的代数系统，得到节点解向量 $u(\\alpha)=[u_{1}(\\alpha), u_{2}(\\alpha), u_{3}(\\alpha)]$。计算极限 $\\lim_{\\alpha\\to\\infty}u(\\alpha)$，并将其与通过消元法获得的解进行比较。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学依据**：该问题是一个标准的一维泊松方程，是物理学和工程学中的一个基本模型。有限元法 (FEM)、罚函数法和消元法都是标准的、成熟的数值技术。该问题是科学合理的。\n-   **适定性**：该边值问题是适定的，并有唯一的解析解。相应的有限元问题也是适定的。\n-   **客观性**：问题使用了精确、客观的数学语言进行陈述。\n-   **完整性**：所有必要信息（控制方程、域、边界条件、离散化细节）均已提供。问题是自包含的。\n-   **一致性**：所提供的数据或要求中没有矛盾之处。\n\n**步骤 3：结论与行动**\n问题被判定为有效。将提供一个完整、合理的解答。\n\n**弱形式的推导**\n问题的强形式由 $x \\in (0,1)$ 上的 $-\\frac{d^{2}u}{dx^{2}} = 0$ 给出。\n为推导弱形式，我们将方程乘以一个来自适当检验空间的检验函数 $v(x)$，并在域 $\\Omega=[0,1]$ 上积分：\n$$-\\int_{0}^{1} \\frac{d^{2}u}{dx^{2}} v(x) dx = 0$$\n对左侧进行分部积分，得到：\n$$\\int_{0}^{1} \\frac{du}{dx} \\frac{dv}{dx} dx - \\left[ \\frac{du}{dx} v(x) \\right]_{0}^{1} = 0$$\n边界项 $\\left[ \\frac{du}{dx} v(x) \\right]_{0}^{1}$ 为零，因为我们最终将在 $x=0$ 和 $x=1$ 处施加本质边界条件。\n弱形式是：求解 $u \\in V$，使得对于所有 $v \\in V$：\n$$a(u,v) = \\int_{0}^{1} \\frac{du}{dx} \\frac{dv}{dx} dx = 0$$\n此处，由于体力为零，右侧的线性泛函为零。\n\n**有限元离散化**\n我们将域离散为两个长度为 $h=\\frac{1}{2}$ 的线性单元。未知场 $u(x)$ 被近似为 $u_h(x) = \\sum_{j=1}^{3} u_j N_j(x)$，其中 $u_j$ 是节点值 $u(x_j)$，$N_j(x)$ 是分段线性的（帽状）基函数。这导出了代数系统 $\\mathbf{K}\\mathbf{u} = \\mathbf{F}$。\n\n对于长度为 $h_e$、扩散系数为单位值的单个线性单元，其刚度矩阵为：\n$$\\mathbf{k}^e = \\frac{1}{h_e} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$$\n对于我们的问题，$h_e = \\frac{1}{2}$，因此单元 1（节点 1, 2）和单元 2（节点 2, 3）的单元刚度矩阵是相同的：\n$$\\mathbf{k}^{(1)} = \\mathbf{k}^{(2)} = \\frac{1}{1/2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 2 & -2 \\\\ -2 & 2 \\end{pmatrix}$$\n将这些组装成 $3 \\times 3$ 的全局刚度矩阵 $\\mathbf{K}$，得到：\n$$\\mathbf{K} = \\begin{pmatrix} 2 & -2 & 0 \\\\ -2 & 2+2 & -2 \\\\ 0 & -2 & 2 \\end{pmatrix} = \\begin{pmatrix} 2 & -2 & 0 \\\\ -2 & 4 & -2 \\\\ 0 & -2 & 2 \\end{pmatrix}$$\n由于没有体力或自然边界条件，全局力向量 $\\mathbf{F}$ 是零向量，即 $\\mathbf{F}=[0, 0, 0]^T$。无约束系统为 $\\mathbf{K}\\mathbf{u}=\\mathbf{0}$。\n\n**罚函数法**\n我们使用罚函数法来施加本质边界条件 $u_1=0$ 和 $u_3=1$。这涉及到修改刚度矩阵的对角线元素以及力向量的相应元素。\n对于条件 $u_1 = 0$，我们修改第一个方程：$K_{11}$ 变为 $K_{11}+\\alpha$，$F_1$ 变为 $F_1 + \\alpha \\cdot 0$。\n对于条件 $u_3 = 1$，我们修改第三个方程：$K_{33}$ 变为 $K_{33}+\\alpha$，$F_3$ 变为 $F_3 + \\alpha \\cdot 1$。\n\n罚化方程组 $\\mathbf{K}_\\alpha \\mathbf{u}(\\alpha) = \\mathbf{F}_\\alpha$ 为：\n$$\\begin{pmatrix} 2+\\alpha & -2 & 0 \\\\ -2 & 4 & -2 \\\\ 0 & -2 & 2+\\alpha \\end{pmatrix} \\begin{pmatrix} u_1(\\alpha) \\\\ u_2(\\alpha) \\\\ u_3(\\alpha) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\alpha \\end{pmatrix}$$\n为了求解向量 $\\mathbf{u}(\\alpha)$，我们求 $\\mathbf{K}_\\alpha$ 的逆矩阵。其行列式为：\n$$\\det(\\mathbf{K}_\\alpha) = (2+\\alpha)[4(2+\\alpha)-4] - (-2)[-2(2+\\alpha)] = (2+\\alpha)(4\\alpha+4) - 4(2+\\alpha) = (2+\\alpha)(4\\alpha) = 4\\alpha(\\alpha+2)$$\n解为 $\\mathbf{u}(\\alpha) = \\mathbf{K}_\\alpha^{-1} \\mathbf{F}_\\alpha = \\frac{1}{\\det(\\mathbf{K}_\\alpha)} \\text{adj}(\\mathbf{K}_\\alpha) \\mathbf{F}_\\alpha$。伴随矩阵为：\n$$\\text{adj}(\\mathbf{K}_\\alpha) = \\begin{pmatrix} 4\\alpha+4 & 2\\alpha+4 & 4 \\\\ 2\\alpha+4 & (2+\\alpha)^2 & 2\\alpha+4 \\\\ 4 & 2\\alpha+4 & 4\\alpha+4 \\end{pmatrix}$$\n乘以力向量 $\\mathbf{F}_\\alpha$：\n$$\\mathbf{u}(\\alpha) = \\frac{1}{4\\alpha(\\alpha+2)} \\begin{pmatrix} 4\\alpha+4 & 2\\alpha+4 & 4 \\\\ 2\\alpha+4 & \\alpha^2+4\\alpha+4 & 2\\alpha+4 \\\\ 4 & 2\\alpha+4 & 4\\alpha+4 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ \\alpha \\end{pmatrix} = \\frac{1}{4\\alpha(\\alpha+2)} \\begin{pmatrix} 4\\alpha \\\\ \\alpha(2\\alpha+4) \\\\ \\alpha(4\\alpha+4) \\end{pmatrix}$$\n简化每个分量的表达式：\n$$u_1(\\alpha) = \\frac{4\\alpha}{4\\alpha(\\alpha+2)} = \\frac{1}{\\alpha+2}$$\n$$u_2(\\alpha) = \\frac{\\alpha(2\\alpha+4)}{4\\alpha(\\alpha+2)} = \\frac{2\\alpha(\\alpha+2)}{4\\alpha(\\alpha+2)} = \\frac{1}{2}$$\n$$u_3(\\alpha) = \\frac{\\alpha(4\\alpha+4)}{4\\alpha(\\alpha+2)} = \\frac{4\\alpha(\\alpha+1)}{4\\alpha(\\alpha+2)} = \\frac{\\alpha+1}{\\alpha+2}$$\n作为 $\\alpha$ 的函数的解向量是 $\\mathbf{u}(\\alpha) = \\begin{pmatrix} \\frac{1}{\\alpha+2} & \\frac{1}{2} & \\frac{\\alpha+1}{\\alpha+2} \\end{pmatrix}^T$。\n\n**当 $\\alpha \\to \\infty$ 时的极限**\n我们现在计算当罚参数 $\\alpha$ 趋近于无穷大时解的极限：\n$$\\lim_{\\alpha\\to\\infty} u_1(\\alpha) = \\lim_{\\alpha\\to\\infty} \\frac{1}{\\alpha+2} = 0$$\n$$\\lim_{\\alpha\\to\\infty} u_2(\\alpha) = \\lim_{\\alpha\\to\\infty} \\frac{1}{2} = \\frac{1}{2}$$\n$$\\lim_{\\alpha\\to\\infty} u_3(\\alpha) = \\lim_{\\alpha\\to\\infty} \\frac{\\alpha+1}{\\alpha+2} = \\lim_{\\alpha\\to\\infty} \\frac{1+1/\\alpha}{1+2/\\alpha} = 1$$\n极限解向量为 $\\lim_{\\alpha\\to\\infty} \\mathbf{u}(\\alpha) = \\begin{pmatrix} 0 & \\frac{1}{2} & 1 \\end{pmatrix}^T$。\n\n**与消元法的比较**\n消元法精确地施加边界条件。我们从无约束系统 $\\mathbf{K}\\mathbf{u}=\\mathbf{F}$ 开始：\n$$\\begin{pmatrix} 2 & -2 & 0 \\\\ -2 & 4 & -2 \\\\ 0 & -2 & 2 \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\\\ u_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n边界条件为 $u_1=0$ 和 $u_3=1$。系统的第二个方程只涉及唯一的未知数 $u_2$：\n$$-2u_1 + 4u_2 - 2u_3 = 0$$\n代入 $u_1$ 和 $u_3$ 的已知值：\n$$-2(0) + 4u_2 - 2(1) = 0$$\n$$4u_2 - 2 = 0$$\n$$4u_2 = 2 \\implies u_2 = \\frac{1}{2}$$\n通过消元法获得的解是 $\\mathbf{u} = \\begin{pmatrix} 0 & \\frac{1}{2} & 1 \\end{pmatrix}^T$。该结果与罚函数法解的极限相同。这是预料之中的，因为罚函数法在理论上是一致的，并且当 $\\alpha \\to \\infty$ 时，它收敛于约束系统的精确解。该微分方程的解析解是 $u(x)=x$，这给出 $u(\\frac{1}{2}) = \\frac{1}{2}$，从而证实了节点解的精确性。\n最终答案是代表罚函数解极限的行向量。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & \\frac{1}{2} & 1\n\\end{pmatrix}\n}\n$$", "id": "2555746"}, {"introduction": "掌握了理论和简单的解析计算后，真正的挑战在于如何将其转化为高效、可靠的计算机代码。本练习将你的视角从数学分析转向软件实现。在实际的有限元程序中，保持刚度矩阵 $K$ 的对称性至关重要，因为它允许我们使用高效的对称求解器。这个练习 [@problem_id:2555792] 让你评估几种不同的代数消除法伪代码实现，目标是找到既能精确施加非零狄利克雷边界条件，又能保持系统矩阵对称性的正确算法。这有助于你理解将理论转化为稳健代码时必须考虑的实际工程问题。", "problem": "考虑一个线性系统 $K u = f$，该系统由自伴标量偏微分方程 (PDE) 在有限元法 (FEM) 中使用本质 (Dirichlet) 边界条件进行 Galerkin 离散化而产生。假设 $K \\in \\mathbb{R}^{n \\times n}$ 是对称矩阵，$u \\in \\mathbb{R}^{n}$ 是节点未知量向量，$f \\in \\mathbb{R}^{n}$ 是载荷向量。令指定 (Dirichlet) 自由度的索引集为 $D \\subset \\{1,\\dots,n\\}$，其指定的非零值为 $u_D = g \\in \\mathbb{R}^{|D|}$，自由自由度的补集为 $I = \\{1,\\dots,n\\} \\setminus D$。消元法旨在通过对 $K$ 和 $f$ 进行代数操作来精确施加 Dirichlet 数据，并确保待解系统的对称性得以保持。\n\n从以下分块形式出发\n$$\n\\begin{bmatrix}\nK_{I I} & K_{I D} \\\\\nK_{D I} & K_{D D}\n\\end{bmatrix}\n\\begin{bmatrix}\nu_I \\\\ u_D\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nf_I \\\\ f_D\n\\end{bmatrix},\n$$\n并利用 $u_D = g$ 为已知这一事实，从第一性原理推导出一个保对称性的消元过程。然后，从以下伪代码选项中选择所有正确且完整地实现了代数消元法的选项，该消元法：\n- 使用 $K$ 中被消去的列来修改右端项（载荷向量），\n- 精确施加 $u_D = g$，\n- 并保持实际求解的系统中的矩阵对称性（无论是通过缩减到 $I \\times I$ 子系统还是通过生成一个全尺寸的对称修正系统）。\n\n假设采用稀疏线性代数，形式为 $x := y$ 的赋值操作会将 $x$ 覆盖为 $y$，而像 $K(:,D)$ 和 $K(D,:)$ 这样的操作分别表示由 $D$ 索引的列或行组成的子矩阵。所有向量均为列向量。选择所有适用选项。\n\nA. 伪代码：\n- 输入：$K$, $f$, $D$, $g$，其中 $I = \\{1,\\dots,n\\} \\setminus D$。\n- 计算 $t := K(:,D)\\, g$.\n- 设置 $f := f - t$.\n- 对每个 $d \\in D$：将 $K$ 的第 $d$ 行和第 $d$ 列置零；设置 $K_{d d} := 1$ 和 $f_d := g_d$。\n- 求解 $K u = f$。\n\nB. 伪代码：\n- 输入：$K$, $f$, $D$, $g$，其中 $I = \\{1,\\dots,n\\} \\setminus D$。\n- 计算 $t := K(:,D)\\, g$.\n- 设置 $f := f - t$.\n- 对每个 $d \\in D$：仅将 $K$ 的第 $d$ 行置零；设置 $K_{d d} := 1$ 和 $f_d := g_d$。\n- 求解 $K u = f$。\n\nC. 伪代码 (罚方法)：\n- 输入：$K$, $f$, $D$, $g$，其中 $I = \\{1,\\dots,n\\} \\setminus D$，以及一个大的罚参数 $\\alpha \\gg 0$。\n- 令 $P$ 为对角选择子，其中对于 $d \\in D$ 有 $P_{d d} = 1$，对于 $i \\in I$ 有 $P_{i i} = 0$。\n- 设置 $K := K + \\alpha P$ 和 $f := f + \\alpha P g$。\n- 求解 $K u = f$。\n\nD. 伪代码：\n- 输入：$K$, $f$, $D$, $g$，其中 $I = \\{1,\\dots,n\\} \\setminus D$。\n- 计算 $t := K(:,D)\\, g$.\n- 设置 $f := f - t$.\n- 对每个 $d \\in D$：仅将 $K$ 的第 $d$ 列置零；设置 $K_{d d} := 1$ 和 $f_d := g_d$。\n- 求解 $K u = f$。\n\nE. 伪代码 (缩减系统)：\n- 输入：$K$, $f$, $D$, $g$，其中 $I = \\{1,\\dots,n\\} \\setminus D$。\n- 构建 $K_{I I} := K(I,I)$ 和 $K_{I D} := K(I,D)$ 以及 $f_I := f(I)$。\n- 计算 $\\widehat{f}_I := f_I - K_{I D}\\, g$。\n- 求解 $K_{I I}\\, u_I = \\widehat{f}_I$ 以获得 $u_I$。\n- 设置 $u_D := g$ 并返回由 $u_I$ 和 $u_D$ 组装成的 $u$。\n\n选择所有正确选项。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 系统是一个线性方程组 $K u = f$。\n- $K \\in \\mathbb{R}^{n \\times n}$ 是一个对称矩阵。\n- $u \\in \\mathbb{R}^{n}$ 是未知量向量。\n- $f \\in \\mathbb{R}^{n}$ 是载荷向量。\n- 该系统源于一个自伴标量偏微分方程的 Galerkin 有限元法离散化。\n- $D$ 是具有指定本质 (Dirichlet) 边界条件的自由度的索引集。\n- 指定值为 $u_D = g$，其中 $g$ 是一个非零值向量。\n- $I = \\{1,\\dots,n\\} \\setminus D$ 是自由自由度的索引集。\n- 系统被分块为：\n$$\n\\begin{bmatrix}\nK_{I I} & K_{I D} \\\\\nK_{D I} & K_{D D}\n\\end{bmatrix}\n\\begin{bmatrix}\nu_I \\\\ u_D\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nf_I \\\\ f_D\n\\end{bmatrix}\n$$\n- 任务是推导并识别出正确的伪代码实现，该实现是一个保对称性的代数消元过程，用以精确施加 $u_D = g$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了计算力学和有限元方法中的一个典型过程。它是一个适定问题 (well-posed)，因为它要求推导和验证标准的、定义明确的算法。其语言客观而精确。为完成任务所提供的信息是完整和一致的。该问题是数值线性代数在工程应用中的一个标准练习，既不简单也非不适定 (ill-posed)。\n\n**步骤3：结论与行动**\n问题陈述是**有效的**。将首先从第一性原理推导出解决方案，然后对每个选项进行评估。\n\n---\n\n**从第一性原理推导**\n\n出发点是分块线性系统：\n$$\n\\begin{align*}\nK_{I I} u_I + K_{I D} u_D &= f_I \\quad &(1) \\\\\nK_{D I} u_I + K_{D D} u_D &= f_D \\quad &(2)\n\\end{align*}\n$$\n本质边界条件为 $u_D = g$，其中 $g$ 是一个已知向量。我们将其代入方程 $(1)$：\n$$\nK_{I I} u_I + K_{I D} g = f_I\n$$\n该方程仅涉及未知自由度 $u_I$。我们可以重新排列它，形成一个待解的关于 $u_I$ 的系统：\n$$\nK_{I I} u_I = f_I - K_{I D} g\n$$\n这是一个大小为 $|I| \\times |I|$ 的缩减方程组。由于原始矩阵 $K$ 是对称的，其主子矩阵 $K_{I I}$ 也是对称的。对于一个适定的偏微分方程问题，$K$ 也是正定的，这意味着 $K_{I I}$ 也是正定的，因此可逆。$u_I$ 存在唯一解。求解出 $u_I$ 后，完整的解向量 $u$ 由计算出的 $u_I$ 和已知的 $u_D = g$ 组装而成。这构成了**缩减系统法**。\n\n另一种方法是修改完整的 $n \\times n$ 系统 $K u = f$，将其变为一个新的系统 $K' u = f'$，该系统具有正确的解且其中 $K'$ 是对称的。解必须满足 $u_D = g$ 和 $K_{I I} u_I = f_I - K_{I D} g$。\n\n为了施加 $u_D = g$，我们可以修改系统中对应于索引集 $D$ 的行。对于每个 $d \\in D$，我们希望方程变为 $1 \\cdot u_d = g_d$。这可以通过将修正矩阵 $K'$ 的第 $d$ 行设置为除对角线位置 $(d,d)$ 上的 $1$ 之外全为零，并将右端向量 $f'$ 的第 $d$ 个元素设置为 $g_d$ 来实现。\n用分块形式表示，这意味着：\n- $K'_{D I} = 0$\n- $K'_{D D} = I$ (单位矩阵)\n- $f'_D = g$\n\n为了保持矩阵的对称性，我们还必须将相应的列置零。也就是说，对于每个 $d \\in D$，第 $d$ 列必须置零，而已设置为 $1$ 的对角元素除外。这意味着：\n- $K'_{I D} = 0$\n\n因此，修正矩阵 $K'$ 的分块结构为：\n$$\nK' = \\begin{bmatrix} K_{I I} & 0 \\\\ 0 & I \\end{bmatrix}\n$$\n该矩阵是对称的，符合要求。\n\n现在，我们必须确定修正后的右端项 $f'$。系统 $K'u = f'$ 的上部分块读作：\n$$\nK'_{I I} u_I + K'_{I D} u_D = f'_I\n$$\n经过我们的修改，这变成 $K_{I I} u_I = f'_I$。为了使这个方程能得到 $u_I$ 的正确解，我们必须有 $f'_I = f_I - K_{I D} g$。\n\n综合起来，最终的修正系统既对称又给出正确解，其形式为：\n$$\n\\begin{bmatrix} K_{I I} & 0 \\\\ 0 & I \\end{bmatrix} \\begin{bmatrix} u_I \\\\ u_D \\end{bmatrix} = \\begin{bmatrix} f_I - K_{I D} g \\\\ g \\end{bmatrix}\n$$\n在完整矩阵 $K$ 和向量 $f$ 上实现此修改的算法如下：\n1. 计算指定位移对力的贡献：$t = K(:,D) g$。\n2. 从原始力向量中减去此贡献：$f \\leftarrow f - t$。现在，$f_I$ 分块具有了正确的值 $f_I - K_{I D} g$。\n3. 对于每个 $d \\in D$，通过以下方式施加条件 $u_d=g_d$：\n    a. 将 $K$ 的第 $d$ 行和第 $d$ 列置零。\n    b. 设置 $K_{dd} = 1$。\n    c. 设置 $f_d = g_d$。此步骤用指定的位移值覆盖了步骤2中 $f_d$ 的临时值。\n\n这构成了**全系统修改法**。\n\n**逐项分析**\n\n**A. 伪代码：**\n- `Compute t := K(:,D) g`: 正确计算了其第 $i$ 个分量为 $\\sum_{j \\in D} K_{ij} g_j$ 的向量。\n- `Set f := f - t`: 正确更新了右端项。自由部分变为 $f_I \\leftarrow f_I - K_{I D} g$。\n- `For each d in D: zero the d-th row and d-th column of K; set K_dd := 1 and f_d := g_d`: 这实现了对受约束自由度的矩阵修改和右端项的最终确定。关键在于，将行和列同时置零保持了矩阵的对称性。设置 $K_{dd}=1$ 和 $f_d=g_d$ 正确地构成了方程 $1 \\cdot u_d = g_d$。\n- `Solve K u = f`: 求解了正确构建的、对称的系统。\n此算法与推导出的全系统修改法完全匹配。它满足所有问题要求。\n结论：**正确**。\n\n**B. 伪代码：**\n- 前两个步骤与A相同。\n- `For each d in D: zero only the d-th row of K; set K_dd := 1 and f_d := g_d`: 这是失败之处。对于 $d \\in D$，仅将行置零而未将相应的列置零，导致修改后的矩阵 $K'$ 不再对称，因为对于 $i \\ne d$ 有 $K'_{d,i} = 0$，但对于 $i \\in I$ 有 $K'_{i,d} = K_{i,d}$。这违反了问题的一个关键要求。此外，这种不对称性导致 $u_I$ 的解不正确，因为系统的上部分块变为 $K_{II} u_I + K_{ID} u_D = f_I - K_{ID} g$。代入 $u_D=g$（下部分块正确施加了此条件）得到 $K_{II} u_I = f_I - 2 K_{ID} g$，这是不正确的。\n结论：**不正确**。\n\n**C. 伪代码 (罚方法)：**\n这描述的是罚方法。问题明确要求采用“代数消元”过程。罚方法是一种基于近似的替代方法。它将系统修改为 $(K + \\alpha P) u = f + \\alpha P g$。此方法不能精确施加条件 $u_D = g$；相反，它产生一个解，其中 $u_D \\approx g$，其精度取决于罚参数 $\\alpha$ 的大小。问题要求精确施加。因此，此选项基于两个基本理由是不正确的：它不是消元法，并且它不是精确的。\n结论：**不正确**。\n\n**D. 伪代码：**\n- 前两个步骤与A相同。\n- `For each d in D: zero only the d-th column of K; set K_dd := 1 and f_d := g_d`: 这与选项B的缺陷类似。仅将列置零而未将相应的行置零，导致所得矩阵非对称。对称性要求被违反。此外，这导致边界条件的施加不正确。上部分块正确地得到 $K_{II} u_I = f_I - K_{ID} g$，因此 $u_I$ 可以被正确求出。然而，下部分块变为 $K_{DI} u_I + I u_D = g$，这意味着 $u_D = g - K_{DI} u_I$。这不等于 $g$，除非 $K_{DI} u_I = 0$，而这在一般情况下不成立。条件 $u_D = g$ 未被施加。\n结论：**不正确**。\n\n**E. 伪代码 (缩减系统)：**\n- `Form K_II := K(I,I) and K_ID := K(I,D) and f_I := f(I)`: 正确提取了缩减系统所需的子块。\n- `Compute \\hat{f}_I := f_I - K_ID g`: 根据第一性原理推导，正确计算了自由自由度的修正右端项。\n- `Solve K_II u_I = \\hat{f}_I for u_I`: 求解了正确的、缩减的系统。矩阵 $K_{II}$ 是对称矩阵 $K$ 的主子矩阵，因此其本身也是对称的。所以，待解系统具有一个对称矩阵。\n- `Set u_D := g and return u assembled from u_I and u_D`: 正确组装最终解向量，精确施加了 Dirichlet 条件。\n该算法与推导出的缩减系统法完全匹配。它满足所有问题要求。\n结论：**正确**。", "answer": "$$\\boxed{AE}$$", "id": "2555792"}]}