{"hands_on_practices": [{"introduction": "第一个实践是一项基础练习。我们将从一个简单的一维扩散问题的弱形式出发，使用线性基函数逐步推导刚度矩阵。这个动手过程将让你亲眼见证刚度矩阵的基本性质——稀疏性、对称性和正定性——是如何从基函数的局部性和底层物理的对称结构中自然产生的 [@problem_id:2600099]。", "problem": "考虑单位区间上的标量二阶椭圆边值问题，其具有齐次 Dirichlet 边界条件：求解 $u$ 使得在 $(0,1)$ 内满足 $- \\frac{d}{dx}\\!\\left(a(x)\\,\\frac{du}{dx}\\right) = f$ 且 $u(0)=u(1)=0$，其中 $a(x)$ 是严格为正且本性有界的。从强形式出发，通过乘以一个检验函数 $v$ 并在 $(0,1)$ 上分部积分得到弱形式，然后对均匀剖分 $0=x_0<x_1<x_2<x_3<x_4=1$（其中 $x_i = i/4$）和内部节点 $x_1$、$x_2$、$x_3$ 使用标准的连续分片线性有限元方法。设系数为常数 $a(x) \\equiv 1$，并令 $\\{\\varphi_1,\\varphi_2,\\varphi_3\\}$ 表示离散空间 $V_h \\subset H_0^1(0,1)$ 的典范节点基。\n\n仅使用双线性形式 $b(u,v) = \\int_0^1 a(x)\\,u'(x)\\,v'(x)\\,dx$ 的定义，推导组装后的刚度矩阵 $K \\in \\mathbb{R}^{3 \\times 3}$，其元素为 $K_{ij} = b(\\varphi_i,\\varphi_j)$。从基本原理出发，证明为什么 $K$ 是稀疏、对称和正定的。最后，以闭合形式确定 $K$ 的最小特征值。请给出最终答案的单个精确表达式（无数值舍入）。", "solution": "我们从强形式 $- \\frac{d}{dx}\\!\\left(a(x)\\,\\frac{du}{dx}\\right) = f$（在 $(0,1)$ 内）且 $u(0)=u(1)=0$ 出发。设 $v \\in H_0^1(0,1)$ 为任意函数。将强形式与 $v$ 相乘并在 $(0,1)$ 上积分，得到 $\\int_0^1 - \\frac{d}{dx}\\!\\left(a(x)\\,\\frac{du}{dx}\\right)v\\,dx = \\int_0^1 f\\,v\\,dx$。结合 $v(0)=v(1)=0$ 进行分部积分，得到弱形式\n\n$$\n\\int_0^1 a(x)\\,u'(x)\\,v'(x)\\,dx = \\int_0^1 f(x)\\,v(x)\\,dx,\n$$\n\n即 $b(u,v) = \\ell(v)$，其中双线性形式为 $b(u,v) = \\int_0^1 a(x)\\,u'(x)\\,v'(x)\\,dx$，线性泛函为 $\\ell(v) = \\int_0^1 f\\,v\\,dx$。\n\n我们使用连续分片线性函数在节点为 $x_i = i/4$（$i=0,1,2,3,4$）的均匀网格上进行离散化，并通过限制在内部节点 $x_1$、$x_2$、$x_3$ 来引入齐次 Dirichlet 边界条件。基函数 $\\{\\varphi_1,\\varphi_2,\\varphi_3\\}$ 满足 $\\varphi_i(x_j) = \\delta_{ij}$（对于 $i,j \\in \\{1,2,3\\}$），且 $\\varphi_i$ 的支集为 $[x_{i-1},x_{i+1}]$。在每个单元上，基函数的导数是常数：在 $[x_{i-1},x_i]$ 上，我们有 $\\varphi_i'(x) = \\frac{1}{h}$ 和 $\\varphi_{i-1}'(x) = -\\frac{1}{h}$；而在 $[x_i,x_{i+1}]$ 上，我们有 $\\varphi_i'(x) = -\\frac{1}{h}$ 和 $\\varphi_{i+1}'(x) = \\frac{1}{h}$，其中 $h = x_i - x_{i-1} = \\frac{1}{4}$。\n\n当 $a(x) \\equiv 1$ 时，对于局部节点基 $\\{\\widehat{\\varphi}_{e},\\widehat{\\varphi}_{e+1}\\}$，在任意区间 $[x_{e},x_{e+1}]$ 上的单元刚度矩阵是\n\n$$\nk^{(e)}_{lm} \\;=\\; \\int_{x_e}^{x_{e+1}} \\widehat{\\varphi}'_{l}(x)\\,\\widehat{\\varphi}'_{m}(x)\\,dx\n\\;=\\; \\frac{1}{h}\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}_{lm}.\n$$\n\n将来自单元 $[x_0,x_1]$、$[x_1,x_2]$、$[x_2,x_3]$ 和 $[x_3,x_4]$ 的贡献组装到内部节点基 $\\{\\varphi_1,\\varphi_2,\\varphi_3\\}$ 上，得到全局刚度矩阵\n\n$$\nK \\;=\\; \\frac{1}{h}\n\\begin{pmatrix}\n2 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 2\n\\end{pmatrix}\n\\;=\\;\n4\\begin{pmatrix}\n2 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 2\n\\end{pmatrix},\n$$\n\n因为 $h = \\frac{1}{4}$。\n\n我们现在来证明这三个性质。\n\n稀疏性：对于 $|i-j| \\geq 2$，$\\varphi_i$ 和 $\\varphi_j$ 的支集不相交，因此 $\\varphi_i'(x)\\,\\varphi_j'(x) = 0$ 几乎处处成立。所以，对于 $|i-j|\\geq 2$，$K_{ij} = \\int_0^1 \\varphi_i'(x)\\,\\varphi_j'(x)\\,dx = 0$。只有 $K_{ii}$ 和 $K_{i,i\\pm 1}$ 可能非零，这就得到了一个三对角矩阵。这种稀疏性完全源于基函数的局部性和双线性形式的逐单元定义。\n\n对称性：对任意基函数 $\\varphi_i$ 和 $\\varphi_j$，我们有\n\n$$\nK_{ij} \\;=\\; b(\\varphi_i,\\varphi_j) \\;=\\; \\int_0^1 a(x)\\,\\varphi_i'(x)\\,\\varphi_j'(x)\\,dx \\;=\\; \\int_0^1 a(x)\\,\\varphi_j'(x)\\,\\varphi_i'(x)\\,dx \\;=\\; b(\\varphi_j,\\varphi_i) \\;=\\; K_{ji},\n$$\n\n因为实值函数的乘法是可交换的，并且 $a(x)>0$ 是一个标量。因此 $K$ 是对称的。\n\n正定性：对任意非零系数向量 $c = (c_1,c_2,c_3)^{\\mathsf{T}}$，定义 $u_h = \\sum_{i=1}^{3} c_i\\,\\varphi_i \\in V_h$，如果 $c \\neq 0$，该函数不是零函数。那么\n\n$$\nc^{\\mathsf{T}} K c \\;=\\; \\sum_{i,j=1}^{3} c_i\\,c_j\\,K_{ij} \\;=\\; \\sum_{i,j=1}^{3} c_i\\,c_j\\,b(\\varphi_i,\\varphi_j) \\;=\\; b(u_h,u_h) \\;=\\; \\int_0^1 a(x)\\,|u_h'(x)|^2\\,dx.\n$$\n\n当 $a(x) \\equiv 1$ 时，我们有 $c^{\\mathsf{T}} K c = \\int_0^1 |u_h'(x)|^2\\,dx$。对于 $u_h \\in H_0^1(0,1)$ 且 $u_h \\neq 0$，有 $u_h' \\not\\equiv 0$，所以 $\\int_0^1 |u_h'(x)|^2\\,dx > 0$。因此 $K$ 是正定的。\n\n我们现在计算 $K$ 的最小特征值。令\n\n$$\nT \\;=\\; \\begin{pmatrix}\n2 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 2\n\\end{pmatrix}.\n$$\n\n因为 $K = \\frac{1}{h}\\,T$ 且 $h=\\frac{1}{4}$，所以 $K$ 的特征值是 $T$ 的特征值的 $\\frac{1}{h}$ 倍。只需求出 $T$ 的特征值即可。考虑向量 $w^{(m)} \\in \\mathbb{R}^3$，其分量为 $w^{(m)}_j = \\sin\\!\\left(j\\,\\theta_m\\right)$（$j \\in \\{1,2,3\\}$），其中 $\\theta_m = \\frac{m\\pi}{n+1}$，$n=3$，$m \\in \\{1,2,3\\}$。对于 $1 \\leq j \\leq 3$，我们计算\n\n$$\n(T w^{(m)})_j \\;=\\; 2 \\sin(j\\theta_m) - \\sin((j-1)\\theta_m) - \\sin((j+1)\\theta_m).\n$$\n\n使用三角恒等式 $\\sin((j+1)\\theta) + \\sin((j-1)\\theta) = 2\\sin(j\\theta)\\cos(\\theta)$，我们得到\n\n$$\n(T w^{(m)})_j \\;=\\; 2 \\sin(j\\theta_m) - 2\\sin(j\\theta_m)\\cos(\\theta_m) \\;=\\; 2\\bigl(1-\\cos(\\theta_m)\\bigr)\\,\\sin(j\\theta_m).\n$$\n\n因此，$w^{(m)}$ 是 $T$ 的一个特征向量，其特征值为\n\n$$\n\\mu_m \\;=\\; 2\\bigl(1-\\cos(\\theta_m)\\bigr) \\;=\\; 2 - 2\\cos\\!\\left(\\frac{m\\pi}{4}\\right), \\quad m \\in \\{1,2,3\\}.\n$$\n\n所以，$K$ 的特征值为\n\n$$\n\\lambda_m \\;=\\; \\frac{1}{h}\\,\\mu_m \\;=\\; 4\\,\\mu_m \\;=\\; 4\\left(2 - 2\\cos\\!\\left(\\frac{m\\pi}{4}\\right)\\right), \\quad m \\in \\{1,2,3\\}.\n$$\n\n最小的特征值对应于 $m=1$（因为 $\\cos(\\cdot)$ 在 $(0,\\pi)$ 上是递减的），得到\n\n$$\n\\lambda_{\\min}(K) \\;=\\; 4\\left(2 - 2\\cos\\!\\left(\\frac{\\pi}{4}\\right)\\right) \\;=\\; 8 - 8\\cdot\\frac{\\sqrt{2}}{2} \\;=\\; 8 - 4\\sqrt{2}.\n$$\n\n这是一个闭合形式的精确表达式。", "answer": "$$\\boxed{8-4\\sqrt{2}}$$", "id": "2600099"}, {"introduction": "在之前练习的基础上，本实践引入了一个更为实际的场景：混合边界条件。你将探索当一端施加狄利克雷（Dirichlet）条件而另一端施加诺伊曼（Neumann）条件时，如何正确地组装系统。这个练习对于理解不同类型的边界条件如何融入有限元框架至关重要，并能揭示它们如何直接影响最终简化刚度矩阵的性质，从而保证唯一解的存在性 [@problem_id:2600156]。", "problem": "考虑区间 $\\left(0,1\\right)$ 上的常系数标量扩散模型问题，\n求解 $u \\in H^{1}\\!\\left(0,1\\right)$ 使得\n$$\n- \\frac{d^{2}u}{dx^{2}} = f \\quad \\text{在 } \\left(0,1\\right) \\text{ 内},\n$$\n该问题服从本质（Dirichlet）边界条件 $u\\!\\left(0\\right)=0$ 和自然（Neumann）边界条件 $u'\\!\\left(1\\right)=0$。使用伽辽金有限元法（FEM），在包含 $N_{\\text{el}}=4$ 个等长子区间的均匀网格上，采用标准连续分片线性基函数对此问题进行离散化，单元尺寸为 $h = 1/4$。假设 $f$ 的形式可确保离散系统是良定的；其具体形式对后续步骤并非必要。\n\n从弱（变分）形式和有限元双线性形式的定义出发，根据第一性原理，证明在通过消元法施加本质边界条件后，对于剩余的自由度，组装的全局刚度矩阵为何是稀疏、对称且正定的。然后，为此网格符号化地组装全局刚度矩阵，通过消元法施加本质边界条件 $u\\!\\left(0\\right)=0$，并计算得到的缩减刚度矩阵（与自由节点值相关联）的行列式。\n\n给出该行列式的最终答案，形式为一个精确的实数。无需四舍五入，也无需物理单位。", "solution": "问题始于一维标量扩散方程的强形式：求解 $u \\in H^{1}\\!\\left(0,1\\right)$ 使得\n$$\n- \\frac{d^{2}u}{dx^{2}} = f \\quad \\text{在 } \\left(0,1\\right) \\text{ 内},\n$$\n边界条件为 $u\\!\\left(0\\right)=0$（本质）和 $u'\\!\\left(1\\right)=0$（自然）。\n\n为推导弱形式，我们将方程乘以一个属于合适的测试函数空间 $V$ 的测试函数 $v$。$V$ 中的函数必须足够光滑，且必须满足所有本质边界条件的齐次形式。在本问题中，$V = \\{ v \\in H^{1}\\!\\left(0,1\\right) \\mid v\\!\\left(0\\right)=0 \\}$。然后我们在定义域 $\\left(0,1\\right)$ 上积分：\n$$\n- \\int_{0}^{1} \\frac{d^{2}u}{dx^{2}} v(x) \\, dx = \\int_{0}^{1} f(x) v(x) \\, dx\n$$\n对左侧应用分部积分法，得到：\n$$\n\\int_{0}^{1} \\frac{du}{dx} \\frac{dv}{dx} \\, dx - \\left[ \\frac{du}{dx} v(x) \\right]_{0}^{1} = \\int_{0}^{1} f(x) v(x) \\, dx\n$$\n我们计算边界项 $\\left[ \\frac{du}{dx} v(x) \\right]_{0}^{1}$：\n在 $x=1$ 处，自然边界条件为 $u'\\!\\left(1\\right)=0$。因此，该项为 $\\frac{du}{dx}(1) v(1) = 0 \\cdot v(1) = 0$。\n在 $x=0$ 处，测试函数满足齐次本质边界条件 $v(0)=0$。因此，该项为 $\\frac{du}{dx}(0) v(0) = \\frac{du}{dx}(0) \\cdot 0 = 0$。\n边界项消失。问题的弱（变分）形式为：求解 $u \\in U = \\{ u \\in H^{1}\\!\\left(0,1\\right) \\mid u\\!\\left(0\\right)=0 \\}$ 使得对于所有 $v \\in V$：\n$$\na(u, v) = L(v)\n$$\n其中双线性形式为 $a(u,v) = \\int_{0}^{1} u'(x) v'(x) \\, dx$，线性泛函为 $L(v) = \\int_{0}^{1} f(x) v(x) \\, dx$。\n\n在有限元法中，我们在有限维子空间 $U_{h} \\subset U$ 中寻找近似解 $u_{h}$。我们用 $N_{\\text{el}}=4$ 个尺寸为 $h = 1/4$ 的单元来离散化定义域 $\\left[0,1\\right]$。这将在位置 $x_{i} = i h$（其中 $i \\in \\{0, 1, 2, 3, 4\\}$）处产生 5 个节点。我们使用连续分片线性基函数 $\\phi_{i}(x)$，满足 $\\phi_i(x_j) = \\delta_{ij}$。近似解写为 $u_{h}(x) = \\sum_{j=0}^{4} U_{j} \\phi_{j}(x)$，其中 $U_{j}$ 是未知的节点值。\n\n伽辽金法使用基函数本身作为测试函数。这会得到一个线性方程组 $K \\mathbf{U} = \\mathbf{F}$，其中全局刚度矩阵 $K$ 的元素由 $K_{ij} = a(\\phi_{j}, \\phi_{i})$ 给出，未知数向量为 $\\mathbf{U} = [U_0, U_1, U_2, U_3, U_4]^T$，载荷向量 $\\mathbf{F}$ 的元素为 $F_i = L(\\phi_i)$。\n\n现在，我们根据第一性原理，在通过消元法施加本质边界条件后，来证明刚度矩阵的性质。缩减后的系统涉及自由度，这些自由度对应于节点 $x_1, x_2, x_3, x_4$。缩减系统的试探函数 $u_h$ 和测试函数 $v_h$ 均位于空间 $V_h = \\text{span}\\{\\phi_1, \\phi_2, \\phi_3, \\phi_4\\}$ 中。对于任何 $v_h \\in V_h$，我们有 $v_h(0)=0$。缩减刚度矩阵 $K_{\\text{red}}$ 的元素为 $K_{ij} = a(\\phi_j, \\phi_i) = \\int_{0}^{1} \\phi_i'(x) \\phi_j'(x) \\, dx$，其中 $i,j \\in \\{1, 2, 3, 4\\}$。\n\n1.  **对称性**：实值函数乘法的交换律意味着 $\\phi_i'(x) \\phi_j'(x) = \\phi_j'(x) \\phi_i'(x)$。因此，双线性形式是对称的：\n    $K_{ij} = a(\\phi_j, \\phi_i) = \\int_{0}^{1} \\phi_j'(x) \\phi_i'(x) \\, dx = \\int_{0}^{1} \\phi_i'(x) \\phi_j'(x) \\, dx = a(\\phi_i, \\phi_j) = K_{ji}$。\n    因此，刚度矩阵 $K_{\\text{red}}$ 是对称的。\n\n2.  **稀疏性**：基函数 $\\phi_{i}(x)$ 仅在区间 $(x_{i-1}, x_{i+1})$ 上非零。其导数 $\\phi'_{i}(x)$ 因此也仅在这同一个局部支集上非零。积分 $\\int_{0}^{1} \\phi_i'(x) \\phi_j'(x) \\, dx$ 只有在 $\\phi'_{i}$ 和 $\\phi'_{j}$ 的支集重叠时才可能非零。这种情况仅在 $|i-j| \\le 1$ 时发生。对于 $|i-j| > 1$，导数之积恒为零，因此 $K_{ij}=0$。这意味着该矩阵的非零元素仅分布在主对角线、上对角线和下对角线上，使其成为一个三对角矩阵，因而是稀疏的。\n\n3.  **正定性**：对于缩减矩阵 $K_{\\text{red}}$，我们必须证明对于任何非零向量 $\\mathbf{v} = [v_1, v_2, v_3, v_4]^T$，都有 $\\mathbf{v}^T K_{\\text{red}} \\mathbf{v} > 0$。这种二次型对应于用相应函数 $v_h(x) = \\sum_{i=1}^{4} v_i \\phi_i(x)$ 求值的双线性形式：\n    $$\n    \\mathbf{v}^T K_{\\text{red}} \\mathbf{v} = a(v_h, v_h) = \\int_{0}^{1} (v_h'(x))^2 \\, dx\n    $$\n    由于被积函数 $(v_h'(x))^2$ 是非负的，该积分也必须是非负的，因此 $\\mathbf{v}^T K_{\\text{red}} \\mathbf{v} \\ge 0$。该矩阵至少是半正定的。为使积分为零，必须有 $v_h'(x) = 0$ 对所有 $x \\in (0,1)$ 成立。这意味着 $v_h(x)$ 必须是一个常数函数。然而，$V_h$ 空间中的任何函数都必须满足本质边界条件，所以 $v_h(0)=0$。一个在某点为零的常数函数必然处处为零。因此，$v_h(x)=0$ 对所有 $x$ 成立。这意味着所有节点值都必须为零，即 $v_1=v_2=v_3=v_4=0$，即 $\\mathbf{v}$ 是零向量。因此，对于任何非零向量 $\\mathbf{v}$，我们有 $\\mathbf{v}^T K_{\\text{red}} \\mathbf{v} > 0$。缩减刚度矩阵 $K_{\\text{red}}$ 是正定的。\n\n接下来，我们组装刚度矩阵。对于一个长度为 $h$ 的通用单元，其单元刚度矩阵 $k^{(e)}$ 由下式给出：\n$$\nk^{(e)} = \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n全局刚度矩阵 $K$ 是一个 $5 \\times 5$ 矩阵，通过对 4 个单元的贡献求和组装而成。当 $h=1/4$ 时，因子 $1/h=4$。\n$$\nK = \\frac{1}{h} \\begin{pmatrix}\n1 & -1 & 0 & 0 & 0 \\\\\n-1 & 1+1 & -1 & 0 & 0 \\\\\n0 & -1 & 1+1 & -1 & 0 \\\\\n0 & 0 & -1 & 1+1 & -1 \\\\\n0 & 0 & 0 & -1 & 1\n\\end{pmatrix}\n= \\frac{1}{h} \\begin{pmatrix}\n1 & -1 & 0 & 0 & 0 \\\\\n-1 & 2 & -1 & 0 & 0 \\\\\n0 & -1 & 2 & -1 & 0 \\\\\n0 & 0 & -1 & 2 & -1 \\\\\n0 & 0 & 0 & -1 & 1\n\\end{pmatrix}\n$$\n本质边界条件 $u(0)=0$ 固定了节点值 $U_0=0$。为了通过消元法施加此条件，我们移除与节点 0 对应的行和列（即第一行和第一列）。得到的缩减刚度矩阵 $K_{\\text{red}}$ 作用于自由节点值向量 $[U_1, U_2, U_3, U_4]^T$ 上。\n$$\nK_{\\text{red}} = \\frac{1}{h} \\begin{pmatrix}\n2 & -1 & 0 & 0 \\\\\n-1 & 2 & -1 & 0 \\\\\n0 & -1 & 2 & -1 \\\\\n0 & 0 & -1 & 1\n\\end{pmatrix}\n$$\n自然边界条件 $u'(1)=0$ 由弱形式自动满足，并反映在全局矩阵的 $K_{44}$ 元素为 $1/h$ 而不是 $2/h$ 上。\n\n最后，我们计算 $K_{\\text{red}}$ 的行列式。给定 $h=1/4$，所以 $1/h=4$。\n$$\nK_{\\text{red}} = 4 \\begin{pmatrix}\n2 & -1 & 0 & 0 \\\\\n-1 & 2 & -1 & 0 \\\\\n0 & -1 & 2 & -1 \\\\\n0 & 0 & -1 & 1\n\\end{pmatrix}\n$$\n对于一个 $n \\times n$ 矩阵 $A$，利用性质 $\\det(cA) = c^n \\det(A)$，我们有：\n$$\n\\det(K_{\\text{red}}) = 4^4 \\det \\begin{pmatrix}\n2 & -1 & 0 & 0 \\\\\n-1 & 2 & -1 & 0 \\\\\n0 & -1 & 2 & -1 \\\\\n0 & 0 & -1 & 1\n\\end{pmatrix}\n$$\n设 M 为该 $4 \\times 4$ 矩阵。我们用沿第一行的余子式展开来计算其行列式：\n$$\n\\det(M) = 2 \\det \\begin{pmatrix}\n2 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 1\n\\end{pmatrix}\n- (-1) \\det \\begin{pmatrix}\n-1 & -1 & 0 \\\\\n0 & 2 & -1 \\\\\n0 & -1 & 1\n\\end{pmatrix}\n$$\n我们计算这两个 $3 \\times 3$ 行列式：\n$$\n\\det \\begin{pmatrix}\n2 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 1\n\\end{pmatrix} = 2(2 \\cdot 1 - (-1)(-1)) - (-1)(-1 \\cdot 1 - 0 \\cdot (-1)) = 2(1) + 1(-1) = 1\n$$\n$$\n\\det \\begin{pmatrix}\n-1 & -1 & 0 \\\\\n0 & 2 & -1 \\\\\n0 & -1 & 1\n\\end{pmatrix} = -1(2 \\cdot 1 - (-1)(-1)) = -1(1) = -1\n$$\n将这些结果代回 $\\det(M)$ 的表达式中：\n$$\n\\det(M) = 2(1) + 1(-1) = 2 - 1 = 1\n$$\n矩阵 M 的行列式为 1。\n因此，缩减刚度矩阵的行列式为：\n$$\n\\det(K_{\\text{red}}) = 4^4 \\times 1 = 256\n$$\n行列式为 256。", "answer": "$$\\boxed{256}$$", "id": "2600156"}, {"introduction": "这项高级实践介绍了静态凝聚这一强大技术，它是大规模有限元分析中子结构和模型降阶的基石。通过手动消去一个内部自由度，你将推导出舒尔补（Schur complement）矩阵并分析其性质。此练习不仅能让你深入了解一种实用的计算方法，还能加深你对矩阵操作如何影响稀疏性，以及在有约束和无约束结构背景下正定与半正定系统之间关键区别的理解 [@problem_id:2600113]。", "problem": "考虑一个一维、双单元区域上的稳态扩散问题，该区域本身未施加本质边界条件（该区域将被视为一个自由子结构）。其强形式的控制方程为 $-\\frac{d}{dx}\\big(\\kappa(x)\\,u'(x)\\big)=0$，相关的能量泛函为\n$$\n\\mathcal{E}(u) \\;=\\; \\frac{1}{2}\\int_{\\Omega}\\kappa(x)\\,\\big(u'(x)\\big)^{2}\\,dx.\n$$\n使用位于 $x_{0}=0$，$x_{1}=1$ 和 $x_{2}=3$ 处的节点，通过线性有限元（帽函数）对该区域进行离散化。材料（扩散系数）是分段常数：在 $[x_{0},x_{1}]$ 上 $\\kappa(x)=\\kappa_{1}$，在 $[x_{1},x_{2}]$ 上 $\\kappa(x)=\\kappa_{2}$。将参数视为无量纲。令自由度为节点值 $(u_{0},u_{1},u_{2})$。\n\n1) 从能量泛函和有限元法（FEM）的伽辽金原理出发，推导该区域的 $3\\times 3$ 组装刚度矩阵 $\\mathbf{K}$。仅使用 $\\mathbf{K}$ 的变分定义，证明其对称性、半正定性，并确定其零空间的一组基。解释基函数的紧支集如何决定 $\\mathbf{K}$ 的稀疏模式。\n\n2) 将自由度划分为边界集 $b=\\{0,2\\}$ 和内部集 $i=\\{1\\}$。通过消去内部自由度 $u_{1}$ 来执行精确的静力凝聚，以获得作用于边界自由度 $u_{b}=(u_{0},u_{2})$ 的舒尔补 $\\mathbf{S}$。从基本原理（对被消去的内部自由度的能量最小化）证明，对于此自由子结构，$\\mathbf{S}$ 是对称和半正定的。简要讨论静力凝聚通常如何影响稀疏性。\n\n3) 现在，代入数值 $\\kappa_{1}=3$，$\\kappa_{2}=1$，$x_{1}-x_{0}=1$ 和 $x_{2}-x_{1}=2$。计算 $2\\times 2$ 舒尔补矩阵 $\\mathbf{S}$ 的唯一正特征值。将您的最终答案表示为一个精确的有理数。", "solution": "第1部分：刚度矩阵 $\\mathbf{K}$ 的推导及性质\n\n有限元近似解 $u_{h}(x)$ 是节点值 $\\mathbf{u} = \\{u_{0}, u_{1}, u_{2}\\}^{T}$ 与相应的线性基（帽）函数 $N_{j}(x)$ 的线性组合：\n$$\nu_{h}(x) = \\sum_{j=0}^{2} u_{j} N_{j}(x)\n$$\n基函数在两个单元 $\\Omega_{1} = [x_{0}, x_{1}]=[0, 1]$ 和 $\\Omega_{2} = [x_{1}, x_{2}]=[1, 3]$ 上分段定义，并满足性质 $N_{j}(x_{k}) = \\delta_{jk}$。单元的长度为 $L_{1} = x_{1}-x_{0} = 1$ 和 $L_{2} = x_{2}-x_{1} = 2$。\n基函数及其导数为：\n$$\nN_{0}(x) = \\begin{cases} 1 - \\frac{x}{L_{1}} & x \\in \\Omega_{1} \\\\ 0 & x \\in \\Omega_{2} \\end{cases} \\quad \\implies \\quad N'_{0}(x) = \\begin{cases} -\\frac{1}{L_{1}} & x \\in \\Omega_{1} \\\\ 0 & x \\in \\Omega_{2} \\end{cases}\n$$\n$$\nN_{1}(x) = \\begin{cases} \\frac{x}{L_{1}} & x \\in \\Omega_{1} \\\\ 1 - \\frac{x-x_{1}}{L_{2}} & x \\in \\Omega_{2} \\end{cases} \\quad \\implies \\quad N'_{1}(x) = \\begin{cases} \\frac{1}{L_{1}} & x \\in \\Omega_{1} \\\\ -\\frac{1}{L_{2}} & x \\in \\Omega_{2} \\end{cases}\n$$\n$$\nN_{2}(x) = \\begin{cases} 0 & x \\in \\Omega_{1} \\\\ \\frac{x-x_{1}}{L_{2}} & x \\in \\Omega_{2} \\end{cases} \\quad \\implies \\quad N'_{2}(x) = \\begin{cases} 0 & x \\in \\Omega_{1} \\\\ \\frac{1}{L_{2}} & x \\in \\Omega_{2} \\end{cases}\n$$\n将 $u_{h}(x)$ 代入能量泛函 $\\mathcal{E}(u)$ 得到离散能量表达式 $\\mathcal{E}(u_{h}) = \\frac{1}{2}\\mathbf{u}^{T}\\mathbf{K}\\mathbf{u}$，从中通过变分定义可以确定刚度矩阵分量 $K_{ij}$：\n$$\nK_{ij} = \\int_{\\Omega} \\kappa(x) N'_{i}(x) N'_{j}(x) dx = \\int_{\\Omega_{1}} \\kappa_{1} N'_{i}(x) N'_{j}(x) dx + \\int_{\\Omega_{2}} \\kappa_{2} N'_{i}(x) N'_{j}(x) dx\n$$\n$\\mathbf{K}$ 的组装是通过将两个单元刚度矩阵的贡献相加来完成的。对于长度为 $L$、扩散系数为常数 $\\kappa$ 的通用一维单元，其单元刚度矩阵为 $\\mathbf{k} = \\frac{\\kappa}{L}\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$。\n对于单元1（节点 $0, 1$）： $\\mathbf{k}^{(1)} = \\frac{\\kappa_1}{L_1} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$。\n对于单元2（节点 $1, 2$）： $\\mathbf{k}^{(2)} = \\frac{\\kappa_2}{L_2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$。\n将这些组装到节点 $(0, 1, 2)$ 的全局矩阵中：\n$$\n\\mathbf{K} = \\begin{pmatrix}\n\\frac{\\kappa_1}{L_1} & -\\frac{\\kappa_1}{L_1} & 0 \\\\\n-\\frac{\\kappa_1}{L_1} & \\frac{\\kappa_1}{L_1} + \\frac{\\kappa_2}{L_2} & -\\frac{\\kappa_2}{L_2} \\\\\n0 & -\\frac{\\kappa_2}{L_2} & \\frac{\\kappa_2}{L_2}\n\\end{pmatrix}\n$$\n$\\mathbf{K}$ 的性质证明如下：\n- **对称性**：定义式 $K_{ij} = \\int \\kappa N'_{i} N'_{j} dx$ 在交换索引 $i$ 和 $j$ 时是固有的对称，因为标量乘法是可交换的：$N'_{i}N'_{j} = N'_{j}N'_{i}$。因此，$K_{ij} = K_{ji}$，$\\mathbf{K}$ 是对称的。\n- **半正定性**：对于任意非零节点值向量 $\\mathbf{v}$，二次型 $\\mathbf{v}^{T}\\mathbf{K}\\mathbf{v}$ 对应于场 $v_{h}(x) = \\sum v_{j}N_{j}(x)$ 能量的两倍。\n$$\n\\mathbf{v}^{T}\\mathbf{K}\\mathbf{v} = 2\\mathcal{E}(v_{h}) = \\int_{\\Omega} \\kappa(x) (v'_{h}(x))^2 dx\n$$\n由于 $\\kappa(x) > 0$ 且 $(v'_{h}(x))^2 \\ge 0$，被积函数是非负的，因此积分也是非负的。所以，$\\mathbf{v}^{T}\\mathbf{K}\\mathbf{v} \\ge 0$，这证明了 $\\mathbf{K}$ 是半正定的。\n- **零空间**：能量 $\\mathbf{v}^{T}\\mathbf{K}\\mathbf{v}$ 为零当且仅当被积函数几乎处处为零，即 $v'_{h}(x) = 0$ 在 $\\Omega$上成立。这意味着 $v_{h}(x)$ 必须是一个常数函数。对于分段线性函数，这要求所有节点值相等：$v_0 = v_1 = v_2 = c$，其中 $c \\neq 0$ 是某个常数。因此，任何形如 $c\\{1, 1, 1\\}^{T}$ 的向量 $\\mathbf{v}$ 都属于 $\\mathbf{K}$ 的零空间。这个一维零空间的基是向量 $\\begin{pmatrix} 1 & 1 & 1 \\end{pmatrix}^{T}$。这对应于刚体模态，这对于没有本质边界条件的自由结构是预料之中的。\n- **稀疏性**：项 $K_{ij}$ 非零，当且仅当积分 $\\int N'_{i}N'_{j} dx$ 非零。基函数具有紧支集，这意味着 $N_{j}(x)$（及其导数）仅在与节点 $j$ 相邻的单元上非零。乘积 $N'_{i}(x) N'_{j}(x)$ 非零，当且仅当至少有一个单元同时包含节点 $i$ 和 $j$。对于一维单元链，这仅在 $|i-j| \\le 1$ 时发生。因此，对于 $|i-j| > 1$，$K_{ij}=0$，这使得 $\\mathbf{K}$ 成为一个三对角（稀疏）矩阵。\n\n第2部分：静力凝聚与舒尔补 $\\mathbf{S}$\n\n我们将自由度划分为内部集 $i=\\{1\\}$ 和边界集 $b=\\{0,2\\}$。方程组 $\\mathbf{K}\\mathbf{u}=\\mathbf{f}$（对于无源问题，$\\mathbf{f}=\\mathbf{0}$）被划分为：\n$$\n\\begin{pmatrix} K_{11} & \\mathbf{K}_{1b} \\\\ \\mathbf{K}_{b1} & \\mathbf{K}_{bb} \\end{pmatrix}\n\\begin{pmatrix} u_{1} \\\\ \\mathbf{u}_{b} \\end{pmatrix} =\n\\begin{pmatrix} 0 \\\\ \\mathbf{f}_{b} \\end{pmatrix}\n$$\n其中 $\\mathbf{u}_{b} = \\{u_{0}, u_{2}\\}^{T}$，$\\mathbf{K}_{1b} = \\begin{pmatrix} K_{10} & K_{12} \\end{pmatrix}$，且 $\\mathbf{K}_{b1} = \\mathbf{K}_{1b}^{T}$。分块后的矩阵为：\n$K_{11} = \\frac{\\kappa_1}{L_1} + \\frac{\\kappa_2}{L_2}$，$\\mathbf{K}_{1b} = \\begin{pmatrix} -\\frac{\\kappa_1}{L_1} & -\\frac{\\kappa_2}{L_2} \\end{pmatrix}$，以及 $\\mathbf{K}_{bb} = \\begin{pmatrix} \\frac{\\kappa_1}{L_1} & 0 \\\\ 0 & \\frac{\\kappa_2}{L_2} \\end{pmatrix}$。\n静力凝聚等价于对于固定的 $\\mathbf{u}_b$，关于内部自由度 $u_1$ 最小化能量泛函 $\\mathcal{E}(u_1, \\mathbf{u}_b)$。\n$$\n\\mathcal{E}(u_{1}, \\mathbf{u}_{b}) = \\frac{1}{2} \\left( K_{11}u_{1}^{2} + 2u_{1}\\mathbf{K}_{1b}\\mathbf{u}_{b} + \\mathbf{u}_{b}^{T}\\mathbf{K}_{bb}\\mathbf{u}_{b} \\right)\n$$\n最小值出现在 $\\frac{\\partial\\mathcal{E}}{\\partial u_{1}} = 0$ 的地方，这给出 $K_{11}u_{1} + \\mathbf{K}_{1b}\\mathbf{u}_{b} = 0$，所以 $u_1 = -K_{11}^{-1}\\mathbf{K}_{1b}\\mathbf{u}_{b}$。将此代回能量泛函，得到凝聚后的能量 $\\mathcal{E}_{cond}(\\mathbf{u}_{b}) = \\frac{1}{2}\\mathbf{u}_{b}^{T}\\mathbf{S}\\mathbf{u}_{b}$：\n$$\n\\mathcal{E}_{cond}(\\mathbf{u}_{b}) = \\frac{1}{2}\\mathbf{u}_{b}^{T}\\left( \\mathbf{K}_{bb} - \\mathbf{K}_{b1}K_{11}^{-1}\\mathbf{K}_{1b} \\right)\\mathbf{u}_{b}\n$$\n因此，舒尔补是 $\\mathbf{S} = \\mathbf{K}_{bb} - \\mathbf{K}_{b1}K_{11}^{-1}\\mathbf{K}_{1b}$。\n- **S 的对称性**：由于 $\\mathbf{K}$ 是对称的，$\\mathbf{K}_{bb}$ 是对称的且 $\\mathbf{K}_{b1} = \\mathbf{K}_{1b}^{T}$。那么 $\\mathbf{S}^{T} = \\mathbf{K}_{bb}^{T} - (\\mathbf{K}_{b1}K_{11}^{-1}\\mathbf{K}_{1b})^{T} = \\mathbf{K}_{bb} - \\mathbf{K}_{1b}^{T}(K_{11}^{-1})^{T}\\mathbf{K}_{b1}^{T} = \\mathbf{K}_{bb} - \\mathbf{K}_{b1}K_{11}^{-1}\\mathbf{K}_{1b} = \\mathbf{S}$。因此，$\\mathbf{S}$ 是对称的。\n- **S 的半正定性**：$\\mathbf{S}$ 的二次型代表了在给定边界位移 $\\mathbf{u}_b$ 下该区域最小能量的两倍。令 $\\mathbf{u}^{*} = \\{u_{1}^{*}, \\mathbf{u}_{b}\\}^{T}$，其中 $u_{1}^{*}$ 是能量最小化的内部位移。则 $\\mathbf{u}_{b}^{T}\\mathbf{S}\\mathbf{u}_{b} = (\\mathbf{u}^{*})^{T}\\mathbf{K}\\mathbf{u}^{*}$。由于 $\\mathbf{K}$ 是半正定的，所以 $(\\mathbf{u}^{*})^{T}\\mathbf{K}\\mathbf{u}^{*} \\ge 0$。因此，对于任意 $\\mathbf{u}_b$，$\\mathbf{u}_{b}^{T}\\mathbf{S}\\mathbf{u}_{b} \\ge 0$，这证明了 $\\mathbf{S}$ 是半正定的。\n- **对稀疏性的影响**：矩阵 $\\mathbf{S}$ 连接了边界节点 $\\{0,2\\}$。在原始矩阵 $\\mathbf{K}$ 中，这些节点没有直接连接（$K_{02}=K_{20}=0$）。然而，舒尔补 $\\mathbf{S}$ 通常会有一个非零项 $S_{02}$。这个在原来为零的位置创建非零项的过程，称为“填充”（fill-in）。静力凝聚通常会通过创建一个连接凝聚子结构所有边界节点的稠密块来降低系统的稀疏性。\n\n第3部分：特定参数的特征值计算\n\n给定参数 $\\kappa_1=3$，$\\kappa_2=1$，$L_1=1$ 和 $L_2=2$。\n具体的刚度矩阵 $\\mathbf{K}$ 为：\n$$\n\\mathbf{K} = \\begin{pmatrix}\n3 & -3 & 0 \\\\\n-3 & 3 + \\frac{1}{2} & -\\frac{1}{2} \\\\\n0 & -\\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix} = \\begin{pmatrix}\n3 & -3 & 0 \\\\\n-3 & \\frac{7}{2} & -\\frac{1}{2} \\\\\n0 & -\\frac{1}{2} & \\frac{1}{2}\n\\end{pmatrix}\n$$\n用于凝聚的分块矩阵分量为：\n$K_{11} = \\frac{7}{2}$\n$\\mathbf{K}_{bb} = \\begin{pmatrix} 3 & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix}$\n$\\mathbf{K}_{1b} = \\begin{pmatrix} -3 & -\\frac{1}{2} \\end{pmatrix}$\n$\\mathbf{K}_{b1} = \\begin{pmatrix} -3 \\\\ -\\frac{1}{2} \\end{pmatrix}$\n我们计算舒尔补 $\\mathbf{S} = \\mathbf{K}_{bb} - \\mathbf{K}_{b1}K_{11}^{-1}\\mathbf{K}_{1b}$：\n$$\n\\mathbf{S} = \\begin{pmatrix} 3 & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix} - \\begin{pmatrix} -3 \\\\ -\\frac{1}{2} \\end{pmatrix} \\left(\\frac{7}{2}\\right)^{-1} \\begin{pmatrix} -3 & -\\frac{1}{2} \\end{pmatrix}\n$$\n$$\n\\mathbf{S} = \\begin{pmatrix} 3 & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix} - \\frac{2}{7} \\begin{pmatrix} (-3)(-3) & (-3)(-\\frac{1}{2}) \\\\ (-\\frac{1}{2})(-3) & (-\\frac{1}{2})(-\\frac{1}{2}) \\end{pmatrix} = \\begin{pmatrix} 3 & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix} - \\frac{2}{7} \\begin{pmatrix} 9 & \\frac{3}{2} \\\\ \\frac{3}{2} & \\frac{1}{4} \\end{pmatrix}\n$$\n$$\n\\mathbf{S} = \\begin{pmatrix} 3 & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix} - \\begin{pmatrix} \\frac{18}{7} & \\frac{3}{7} \\\\ \\frac{3}{7} & \\frac{1}{14} \\end{pmatrix} = \\begin{pmatrix} 3 - \\frac{18}{7} & -\\frac{3}{7} \\\\ -\\frac{3}{7} & \\frac{1}{2} - \\frac{1}{14} \\end{pmatrix} = \\begin{pmatrix} \\frac{21-18}{7} & -\\frac{3}{7} \\\\ -\\frac{3}{7} & \\frac{7-1}{14} \\end{pmatrix}\n$$\n$$\n\\mathbf{S} = \\begin{pmatrix} \\frac{3}{7} & -\\frac{3}{7} \\\\ -\\frac{3}{7} & \\frac{6}{14} \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{7} & -\\frac{3}{7} \\\\ -\\frac{3}{7} & \\frac{3}{7} \\end{pmatrix} = \\frac{3}{7}\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n为了找到 $\\mathbf{S}$ 的特征值 $\\lambda$，我们求解特征方程 $\\det(\\mathbf{S} - \\lambda\\mathbf{I}) = 0$。\n$$\n\\det\\begin{pmatrix} \\frac{3}{7}-\\lambda & -\\frac{3}{7} \\\\ -\\frac{3}{7} & \\frac{3}{7}-\\lambda \\end{pmatrix} = \\left(\\frac{3}{7}-\\lambda\\right)^2 - \\left(-\\frac{3}{7}\\right)^2 = 0\n$$\n$$\n\\left(\\frac{3}{7}-\\lambda\\right)^2 - \\frac{9}{49} = 0 \\implies \\lambda^2 - \\frac{6}{7}\\lambda + \\frac{9}{49} - \\frac{9}{49} = 0\n$$\n$$\n\\lambda\\left(\\lambda - \\frac{6}{7}\\right) = 0\n$$\n特征值为 $\\lambda_1 = 0$ 和 $\\lambda_2 = \\frac{6}{7}$。零特征值对应于自由子结构的刚体模态。唯一的正特征值是 $\\frac{6}{7}$。", "answer": "$$\\boxed{\\frac{6}{7}}$$", "id": "2600113"}]}