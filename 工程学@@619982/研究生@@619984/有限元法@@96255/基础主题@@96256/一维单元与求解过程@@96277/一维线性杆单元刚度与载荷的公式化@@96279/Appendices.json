{"hands_on_practices": [{"introduction": "我们首先从一个基础问题入手：一根承受均布荷载的简单杆件。这项练习将引导你完成有限元法的核心步骤，从利用虚功原理推导单元方程，到求解支座反力。最关键的是，通过将我们的有限元结果与精确的解析解进行比较，我们将建立对方法的信心，并揭示伽辽金法在此特定问题中的一个有趣特性。", "problem": "一根长度为 $L$、横截面积恒为 $A$、杨氏模量为 $E$ 的直棱柱轴向变形杆，沿 $x$ 轴放置，其范围为 $x \\in [0,L]$。轴向位移场为 $u(x)$。两端固定，因此本质边界条件为 $u(0)=0$ 和 $u(L)=0$。杆在整个跨度上受到一个强度恒为 $b$（单位长度上的力）的均布轴向体力，其方向为正 $x$ 方向。采用正号约定，即正的轴向力和反力作用在正 $x$ 方向。\n\n使用有限元方法（FEM），采用一个跨越整个杆的单个双节点线性杆单元，从虚功原理出发，推导单元刚度矩阵和对应于均布体力的协调单元载荷向量。施加本质边界条件，并计算在 $x=0$ 和 $x=L$ 处的节点反力。然后，从给定边界条件的一维轴向平衡方程的强形式出发，求得精确的连续解以及相应的端点反力。比较两组反力。\n\n将最终反力表示为关于 $b$ 和 $L$ 的单个行向量 $(R_{0}\\; R_{L})$，其中 $R_{0}$ 是 $x=0$ 处的反力，$R_{L}$ 是 $x=L$ 处的反力。设 $b$ 的单位为牛顿/米，$L$ 的单位为米，这样反力的单位就是牛顿，但不要在最终的方框答案中包含单位。无需进行数值四舍五入；请提供精确的符号表达式。", "solution": "该问题提法恰当且科学上合理。我们将分两部分进行推导和求解：首先，使用有限元方法（FEM）；其次，通过求解控制微分方程得到精确的连续解。\n\n### 第一部分：有限元方法（FEM）求解\n\n我们用一个双节点线性单元来模拟长度为 $L$ 的杆。节点位于 $x_1=0$ 和 $x_2=L$。相应的节点位移为 $d_1$ 和 $d_2$。节点位移向量为 $\\mathbf{d} = \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix}$。\n\n单元内的位移场 $u(x)$ 使用线性形函数 $N_1(x)$ 和 $N_2(x)$ 进行近似：\n$$u(x) \\approx u_h(x) = N_1(x)d_1 + N_2(x)d_2 = \\mathbf{N}(x)\\mathbf{d}$$\n对于定义在域 $x \\in [0, L]$ 上的线性单元，其形函数为：\n$$N_1(x) = 1 - \\frac{x}{L}, \\quad N_2(x) = \\frac{x}{L}$$\n轴向应变 $\\epsilon(x)$ 是位移的导数：\n$$\\epsilon(x) = \\frac{du_h}{dx} = \\frac{dN_1}{dx}d_1 + \\frac{dN_2}{dx}d_2 = \\left[-\\frac{1}{L} \\quad \\frac{1}{L}\\right]\\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix} = \\mathbf{B}\\mathbf{d}$$\n因此，该单元的应变-位移矩阵 $\\mathbf{B}$ 是一个常数：\n$$\\mathbf{B} = \\frac{1}{L}\\begin{pmatrix} -1 & 1 \\end{pmatrix}$$\n\n我们从虚功原理推导单元方程，该原理指出内虚功（$\\delta W_{int}$）等于外虚功（$\\delta W_{ext}$）。\n$$\\delta W_{int} = \\delta W_{ext}$$\n\n内虚功由虚应变能在体积 $V$ 上的积分给出：\n$$\\delta W_{int} = \\int_V \\delta\\epsilon^T \\sigma dV = \\int_0^L \\delta\\epsilon^T (E\\epsilon) A dx$$\n代入有限元表达式 $\\epsilon = \\mathbf{B}\\mathbf{d}$ 和 $\\delta\\epsilon = \\mathbf{B}\\delta\\mathbf{d}$：\n$$\\delta W_{int} = \\int_0^L (\\mathbf{B}\\delta\\mathbf{d})^T E A (\\mathbf{B}\\mathbf{d}) dx = \\delta\\mathbf{d}^T \\left( \\int_0^L \\mathbf{B}^T E A \\mathbf{B} dx \\right) \\mathbf{d}$$\n这定义了单元刚度矩阵 $\\mathbf{K}$：\n$$\\mathbf{K} = \\int_0^L \\mathbf{B}^T E A \\mathbf{B} dx$$\n由于 $E$、$A$ 和 $\\mathbf{B}$ 在单元上是常数：\n$$\\mathbf{K} = EA \\mathbf{B}^T \\mathbf{B} \\int_0^L dx = EAL \\left( \\frac{1}{L}\\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} \\right) \\left( \\frac{1}{L}\\begin{pmatrix} -1 & 1 \\end{pmatrix} \\right) = \\frac{EA}{L} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$$\n\n外虚功是由均布体力 $b$（单位长度上的力）引起的：\n$$\\delta W_{ext} = \\int_0^L \\delta u(x) b dx$$\n代入 $\\delta u(x) = \\mathbf{N}(x)\\delta\\mathbf{d}$：\n$$\\delta W_{ext} = \\int_0^L (\\mathbf{N}(x)\\delta\\mathbf{d})^T b dx = \\delta\\mathbf{d}^T \\left( \\int_0^L \\mathbf{N}(x)^T b dx \\right)$$\n这定义了协调节点力向量 $\\mathbf{f}_b$：\n$$\\mathbf{f}_b = \\int_0^L \\mathbf{N}(x)^T b dx = b \\int_0^L \\begin{pmatrix} 1 - x/L \\\\ x/L \\end{pmatrix} dx$$\n积分后，我们得到：\n$$\\mathbf{f}_b = b \\begin{pmatrix} \\left[x - \\frac{x^2}{2L}\\right]_0^L \\\\ \\left[\\frac{x^2}{2L}\\right]_0^L \\end{pmatrix} = b \\begin{pmatrix} L - \\frac{L^2}{2L} \\\\ \\frac{L^2}{2L} \\end{pmatrix} = \\frac{bL}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$$\n\n单元的控制方程组为 $\\mathbf{K}\\mathbf{d} = \\mathbf{F}$，其中 $\\mathbf{F}$ 是外部节点力的总向量，包括施加的载荷和反力。设 $\\mathbf{R} = \\begin{pmatrix} R_0 \\\\ R_L \\end{pmatrix}$ 为节点反力向量。总力向量为 $\\mathbf{F} = \\mathbf{f}_b + \\mathbf{R}$。\n$$\\frac{EA}{L}\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix} = \\frac{bL}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} R_0 \\\\ R_L \\end{pmatrix}$$\n本质边界条件是 $u(0)=0$ 和 $u(L)=0$，这意味着 $d_1=0$ 和 $d_2=0$。将这些代入方程组：\n$$\\frac{EA}{L}\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\frac{bL}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} R_0 \\\\ R_L \\end{pmatrix}$$\n$$\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{bL}{2} + R_0 \\\\ \\frac{bL}{2} + R_L \\end{pmatrix}$$\n由此，我们求解反力：\n$$R_0 = -\\frac{bL}{2}, \\quad R_L = -\\frac{bL}{2}$$\n\n### 第二部分：精确解析解\n\n棱柱杆的轴向平衡方程的强形式为：\n$$\\frac{d}{dx}\\left(EA\\frac{du}{dx}\\right) + b(x) = 0$$\n鉴于 $E$ 和 $A$ 是常数，且 $b(x)=b$ 是一个恒定的体力，方程简化为：\n$$EA \\frac{d^2u}{dx^2} = -b$$\n对 $x$ 积分两次，得到位移场 $u(x)$ 的通解：\n$$\\frac{du}{dx} = -\\frac{b}{EA}x + C_1$$\n$$u(x) = -\\frac{b}{2EA}x^2 + C_1 x + C_2$$\n我们使用边界条件 $u(0)=0$ 和 $u(L)=0$ 来求解积分常数 $C_1$ 和 $C_2$。\n由 $u(0)=0$ 可得：\n$$u(0) = 0 + 0 + C_2 = 0 \\implies C_2=0$$\n由 $u(L)=0$ 可得：\n$$u(L) = -\\frac{bL^2}{2EA} + C_1 L = 0 \\implies C_1 = \\frac{bL}{2EA}$$\n精确的位移场为：\n$$u(x) = \\frac{b}{2EA}(Lx - x^2)$$\n内轴力为 $N(x) = EA \\frac{du}{dx}$。使用我们得到的一阶导数表达式：\n$$N(x) = EA \\left(-\\frac{bx}{EA} + \\frac{bL}{2EA}\\right) = b\\left(\\frac{L}{2} - x\\right)$$\n支座处的反力是平衡边界处内力所需的外部力。\n在左支座（$x=0$）处，内力为 $N(0) = b(\\frac{L}{2} - 0) = \\frac{bL}{2}$。这个正值表示拉力；杆正在向右拉动支座。支座必须对杆施加一个大小相等、方向相反的力。根据符号约定，作用在负 $x$ 方向的力为负。\n$$R_0 = -N(0) = -\\frac{bL}{2}$$\n在右支座（$x=L$）处，内力为 $N(L) = b(\\frac{L}{2} - L) = -\\frac{bL}{2}$。这个负值表示压力；杆正在向左推动支座。因此，支座必须对杆施加一个向左的反作用力以维持平衡。根据符号约定，向左的力为负。\n$$R_L = N(L) = -\\frac{bL}{2}$$\n\n### 第三部分：比较\n\n比较两种方法的结果：\nFEM 解： $(R_0, R_L) = (-\\frac{bL}{2}, -\\frac{bL}{2})$。\n精确解： $(R_0, R_L) = (-\\frac{bL}{2}, -\\frac{bL}{2})$。\n\n使用单个线性单元和协调载荷向量的有限元方法计算出的节点反力，与从控制微分方程的解析解中推导出的精确反力完全相同。这是有限元方法 Galerkin 公式应用于此特定问题（线性单元承受均布载荷）时的一个已知特性。虽然有限元模型得出的位移场近似解 $u_h(x)=0$ 是不正确的（精确解是抛物线形的），但节点力是精确的。", "answer": "$$\\boxed{\\begin{pmatrix} -\\frac{bL}{2} & -\\frac{bL}{2} \\end{pmatrix}}$$", "id": "2538095"}, {"introduction": "现实世界中的构件很少是完全均匀的，这项实践将探讨一个更贴近实际的场景：一根变截面杆。这种几何上的复杂性要求我们使用数值积分，这是大多数有限元软件的基石。你将探索高斯求积规则的选择如何影响单元刚度矩阵和荷载向量的计算精度，并量化当积分不精确时产生的误差。", "problem": "一根直杆沿空间坐标 $x \\in [0,h]$ 占据一段，并由单个 $2$ 节点线性杆有限元进行建模。该杆具有恒定的杨氏模量 $E$，但其横截面积呈线性锥形变化，$A(x) = A_{0} + a x$，其中 $A_{0} > 0$ 和 $a$ 是常数。该杆在轴向受到单位体积恒定的体力 $b_{0}$ 的作用；单元上没有其他外部面力。以虚功原理为基本出发点，考虑轴向变形的标准弱形式，\n$\\int_{0}^{h} E A(x) \\frac{du}{dx} \\frac{dv}{dx} \\, dx = \\int_{0}^{h} A(x) b_{0} v \\, dx$，\n以及单元上的 $2$ 节点线性形函数，来构建单元刚度矩阵和一致单元载荷向量。\n\n你的任务：\n- 从弱形式和定义在 $[0,h]$ 上的 $2$ 节点线性形函数出发，使用精确积分推导精确的单元刚度矩阵和精确的一致单元载荷向量。\n- 在参考区间上使用单点高斯积分和两点高斯积分计算相同的刚度和载荷积分，并确定每种法则能精确积分哪些量。\n- 当 $A(x)$ 是线性时，比较单点和两点高斯积分在单元刚度和单元载荷中产生的数值误差，并将你的发现与在光滑数据下由这类单元组成的网格的组装有限元解的预期收敛特性联系起来。\n\n最后，报告单点高斯积分相对于精确积分的单元级一致载荷误差向量，即一个两分量的行矩阵\n$e_{f}^{(1\\mathrm{G})} = \\big(f^{(1\\mathrm{G})} - f^{(\\mathrm{exact})}\\big)^{\\top}$，\n用 $A_{0}$、$a$、$b_{0}$ 和 $h$ 的符号形式表示。不要代入数值。不需要四舍五入。将最终答案表示为一个 $1 \\times 2$ 的行矩阵，使用 LaTeX 的 $\\mathrm{pmatrix}$ 环境，作为一个闭式解析表达式。", "solution": "问题陈述已经过验证，被认为是科学上可靠、适定且客观的。它提出了有限元方法中的一个标准问题，为得出唯一且有意义的解提供了所有必要信息。不存在矛盾、歧义或事实错误。该问题有效。\n\n我们继续进行推导和分析。该问题涉及一个横跨区域 $x \\in [0, h]$ 的单个 $2$ 节点线性杆单元。\n\n首先，我们定义物理域 $[0, h]$ 上 $2$ 节点单元的线性形函数。节点位于 $x_1 = 0$ 和 $x_2 = h$。形函数为：\n$$ N_1(x) = 1 - \\frac{x}{h} $$\n$$ N_2(x) = \\frac{x}{h} $$\n轴向位移场 $u(x)$ 是通过节点位移 $d_1$ 和 $d_2$ 插值得到的，$u(x) = N_1(x)d_1 + N_2(x)d_2 = \\mathbf{N}(x)\\mathbf{d}$，其中 $\\mathbf{N}(x) = \\begin{pmatrix} N_1(x) & N_2(x) \\end{pmatrix}$ 且 $\\mathbf{d} = \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix}$。\n\n轴向应变 $\\epsilon(x) = \\frac{du}{dx}$ 由下式给出：\n$$ \\frac{du}{dx} = \\begin{pmatrix} \\frac{dN_1}{dx} & \\frac{dN_2}{dx} \\end{pmatrix} \\mathbf{d} = \\mathbf{B}\\mathbf{d} $$\n其中，对于线性单元，应变-位移矩阵 $\\mathbf{B}$ 是一个常数：\n$$ \\mathbf{B} = \\begin{pmatrix} -\\frac{1}{h} & \\frac{1}{h} \\end{pmatrix} = \\frac{1}{h} \\begin{pmatrix} -1 & 1 \\end{pmatrix} $$\n\n单元刚度矩阵 $\\mathbf{K}$ 和一致载荷向量 $\\mathbf{f}$ 从弱形式推导得出：\n$$ \\mathbf{K} = \\int_{0}^{h} \\mathbf{B}^{\\top} E A(x) \\mathbf{B} \\, dx $$\n$$ \\mathbf{f} = \\int_{0}^{h} \\mathbf{N}(x)^{\\top} A(x) b_0 \\, dx $$\n其中 $E$ 是杨氏模量，$A(x) = A_0 + ax$ 是横截面积，$b_0$ 是单位体积的恒定体力。\n\n精确单元刚度矩阵 $\\mathbf{K}^{(\\mathrm{exact})}$ 的推导：\n我们将 $\\mathbf{B}$ 和 $A(x)$ 的表达式代入 $\\mathbf{K}$ 的公式中：\n$$ \\mathbf{K}^{(\\mathrm{exact})} = \\int_{0}^{h} \\frac{1}{h}\\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} E (A_0 + ax) \\frac{1}{h}\\begin{pmatrix} -1 & 1 \\end{pmatrix} \\, dx $$\n$$ \\mathbf{K}^{(\\mathrm{exact})} = \\frac{E}{h^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\int_{0}^{h} (A_0 + ax) \\, dx $$\n该积分的计算结果为：\n$$ \\int_{0}^{h} (A_0 + ax) \\, dx = \\left[ A_0x + \\frac{ax^2}{2} \\right]_{0}^{h} = A_0h + \\frac{ah^2}{2} = h \\left( A_0 + \\frac{ah}{2} \\right) $$\n如果单元的面积为 $A(x)$ 且长度为 $h$，则该积分代表单元的总体积再除以 $h$。它等价于 $h$ 乘以中点处的面积 $A(h/2)$。\n因此，精确的刚度矩阵是：\n$$ \\mathbf{K}^{(\\mathrm{exact})} = \\frac{E}{h^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} h \\left( A_0 + \\frac{ah}{2} \\right) = \\frac{E}{h} \\left( A_0 + \\frac{ah}{2} \\right) \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\n\n精确一致单元载荷向量 $\\mathbf{f}^{(\\mathrm{exact})}$ 的推导：\n我们将 $\\mathbf{N}(x)$ 和 $A(x)$ 代入 $\\mathbf{f}$ 的公式中：\n$$ \\mathbf{f}^{(\\mathrm{exact})} = b_0 \\int_{0}^{h} \\begin{pmatrix} 1 - x/h \\\\ x/h \\end{pmatrix} (A_0 + ax) \\, dx $$\n这需要为分量 $f_1$ 和 $f_2$ 计算两个积分：\n$$ f_1^{(\\mathrm{exact})} = b_0 \\int_{0}^{h} \\left(1 - \\frac{x}{h}\\right)(A_0 + ax) \\, dx = b_0 \\int_{0}^{h} \\left( A_0 + \\left(a - \\frac{A_0}{h}\\right)x - \\frac{a}{h}x^2 \\right) dx $$\n$$ f_1^{(\\mathrm{exact})} = b_0 \\left[ A_0x + \\left(a - \\frac{A_0}{h}\\right)\\frac{x^2}{2} - \\frac{a}{h}\\frac{x^3}{3} \\right]_{0}^{h} = b_0 \\left( A_0h + \\frac{ah^2}{2} - \\frac{A_0h}{2} - \\frac{ah^2}{3} \\right) = b_0 \\left( \\frac{A_0h}{2} + \\frac{ah^2}{6} \\right) = \\frac{b_0h}{6}(3A_0 + ah) $$\n$$ f_2^{(\\mathrm{exact})} = b_0 \\int_{0}^{h} \\frac{x}{h}(A_0 + ax) \\, dx = \\frac{b_0}{h} \\int_{0}^{h} (A_0x + ax^2) \\, dx $$\n$$ f_2^{(\\mathrm{exact})} = \\frac{b_0}{h} \\left[ A_0\\frac{x^2}{2} + a\\frac{x^3}{3} \\right]_{0}^{h} = \\frac{b_0}{h} \\left( \\frac{A_0h^2}{2} + \\frac{ah^3}{3} \\right) = b_0 \\left( \\frac{A_0h}{2} + \\frac{ah^2}{3} \\right) = \\frac{b_0h}{6}(3A_0 + 2ah) $$\n精确的载荷向量为：\n$$ \\mathbf{f}^{(\\mathrm{exact})} = \\frac{b_0h}{6} \\begin{pmatrix} 3A_0 + ah \\\\ 3A_0 + 2ah \\end{pmatrix} $$\n\n使用高斯积分进行计算：\n数值积分在参考区间 $\\xi \\in [-1, 1]$ 上进行。映射关系为 $x(\\xi) = \\frac{h}{2}(1+\\xi)$，雅可比行列式为 $J = \\frac{dx}{d\\xi} = \\frac{h}{2}$。\n刚度矩阵积分变换为：\n$$ \\mathbf{K} = \\int_{-1}^{1} \\mathbf{B}^{\\top} E A(x(\\xi)) \\mathbf{B} \\frac{h}{2} \\, d\\xi $$\n刚度积分的标量部分的被积函数是 $I_K(\\xi) = E(A_0 + a\\frac{h}{2}(1+\\xi))$。这是一个关于 $\\xi$ 的 $1$ 次多项式。单点高斯积分（积分点 $\\xi_1=0$，权重 $w_1=2$）对于最高 $2n-1 = 1$ 次的多项式是精确的。因此，单点高斯积分将能精确地积分刚度矩阵。\n$$ \\mathbf{K}^{(1\\mathrm{G})} = \\left( \\frac{E}{h^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\right) \\cdot w_1 \\left[ (A_0 + a x(0)) \\frac{h}{2} \\right] = \\left( \\dots \\right) \\cdot 2 \\left[ (A_0 + a\\frac{h}{2}) \\frac{h}{2} \\right] = \\frac{E}{h} \\left( A_0 + \\frac{ah}{2} \\right) \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\n因此，$\\mathbf{K}^{(1\\mathrm{G})} = \\mathbf{K}^{(\\mathrm{exact})}$。由于两点高斯积分对于最高 $3$ 次的多项式是精确的，因此它显然也是精确的，即 $\\mathbf{K}^{(2\\mathrm{G})} = \\mathbf{K}^{(\\mathrm{exact})}$。\n\n载荷向量积分变换为：\n$$ \\mathbf{f} = \\int_{-1}^{1} \\mathbf{N}(\\xi)^{\\top} A(x(\\xi)) b_0 \\frac{h}{2} \\, d\\xi $$\n其中 $\\mathbf{N}(\\xi) = \\begin{pmatrix} \\frac{1-\\xi}{2} & \\frac{1+\\xi}{2} \\end{pmatrix}$。被积函数的分量形式为 constant$\\times(1\\pm\\xi)(C_1+C_2\\xi)$，是关于 $\\xi$ 的 $2$ 次多项式。\n单点高斯积分对于二次多项式是不精确的。\n$$ \\mathbf{f}^{(1\\mathrm{G})} = w_1 \\left[ \\mathbf{N}(0)^{\\top} A(x(0)) b_0 \\frac{h}{2} \\right] = 2 \\begin{pmatrix} 1/2 \\\\ 1/2 \\end{pmatrix} (A_0 + a\\frac{h}{2}) b_0 \\frac{h}{2} = \\frac{b_0 h}{2} \\left(A_0 + \\frac{ah}{2}\\right) \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\n两点高斯积分对于最高 $3$ 次的多项式是精确的。因此，它将能精确地积分载荷向量。我们不需要进行计算；我们先验地知道 $\\mathbf{f}^{(2\\mathrm{G})} = \\mathbf{f}^{(\\mathrm{exact})}$。\n\n比较和误差分析：\n刚度矩阵可以被单点和两点高斯积分精确积分。两种情况下的误差都为零。\n载荷向量只能被两点法则精确积分。使用单点法则时会产生误差。误差向量定义为 $e_{f}^{(1\\mathrm{G})} = \\left(\\mathbf{f}^{(1\\mathrm{G})} - \\mathbf{f}^{(\\mathrm{exact})}\\right)^{\\top}$。\n误差向量的分量为：\n$$ e_{f,1}^{(1\\mathrm{G})} = \\frac{b_0h}{2}\\left(A_0 + \\frac{ah}{2}\\right) - \\frac{b_0h}{6}(3A_0+ah) = \\frac{b_0h}{12}\\left[ 6\\left(A_0 + \\frac{ah}{2}\\right) - 2(3A_0+ah) \\right] = \\frac{b_0h}{12} [6A_0 + 3ah - 6A_0 - 2ah] = \\frac{ab_0h^2}{12} $$\n$$ e_{f,2}^{(1\\mathrm{G})} = \\frac{b_0h}{2}\\left(A_0 + \\frac{ah}{2}\\right) - \\frac{b_0h}{6}(3A_0+2ah) = \\frac{b_0h}{12}\\left[ 6\\left(A_0 + \\frac{ah}{2}\\right) - 2(3A_0+2ah) \\right] = \\frac{b_0h}{12} [6A_0 + 3ah - 6A_0 - 4ah] = -\\frac{ab_0h^2}{12} $$\n因此，载荷误差向量为 $\\mathbf{e}_f^{(1\\mathrm{G})} = \\frac{ab_0h^2}{12} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n\n关于由这类单元组成的网格的收敛特性，使用非精确积分构成了一种“变分犯罪”。根据 Strang 第一引理，有限元解的总误差受最佳逼近误差和由积分误差引起的一致性项之和的限制。在这种情况下，刚度矩阵是精确的。载荷向量中的误差是 $O(h^2)$ 阶。标准误差分析表明，该积分误差的阶数高于能量范数中的插值误差，对于线性单元，插值误差为 $O(h)$。因此，对载荷向量使用单点积分虽然不精确，但不会降低能量范数中的最优 $O(h)$ 收敛率，也不会降低位移的 $L^2$-范数中的 $O(h^2)$ 收敛率。因此，从渐近的角度来看，对于这个特定的问题公式，单点积分是足够的。\n\n最后，我们将单点高斯积分的单元级一致载荷误差向量报告为一个 $1 \\times 2$ 的行矩阵。\n$$ e_{f}^{(1\\mathrm{G})} = \\left( \\mathbf{f}^{(1\\mathrm{G})} - \\mathbf{f}^{(\\mathrm{exact})} \\right)^{\\top} = \\begin{pmatrix} \\frac{ab_0h^2}{12} & -\\frac{ab_0h^2}{12} \\end{pmatrix} $$", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{ab_{0}h^{2}}{12} & -\\frac{ab_{0}h^{2}}{12} \\end{pmatrix}}$$", "id": "2538046"}, {"introduction": "我们如何确定所构建的有限元单元在大型仿真中能够正确工作？“小块检验”（Patch Test）是确保单元可靠性和收敛性的一个基本验证手段。在本练习中，你将对一小“块”单元施加一个已知的线性位移场，并验证有限元系统是否达到完美平衡，从而证实该单元能够精确表示恒定应变状态。", "problem": "考虑一根位于实数轴区间 $[0,L]$ 上的等截面线性弹性杆，其杨氏模量 $E>0$ 与横截面积 $A>0$ 均为常数。该杆被离散为 $2$ 个两节点线性（仿射）杆单元，节点分别位于 $x_1=0$、 $x_2=\\ell_1$ 和 $x_3=L$，其中 $\\ell_1>0$、 $\\ell_2>0$ 且 $\\ell_1+\\ell_2=L$。设精确位移场为线性函数 $u^{\\ast}(x)=\\alpha+\\beta x$，其中 $\\alpha,\\beta\\in\\mathbb{R}$ 为常数。不存在体力，即 $b(x)=0$。在边界上，施加与 $u^{\\ast}$ 一致的面力：Cauchy 应力为 $\\sigma^{\\ast}=E\\,\\beta$，外法线为 $n(0)=-1$ 和 $n(L)=+1$，单位面积上的边界面力为 $\\bar t(0)=\\sigma^{\\ast}\\,n(0)$ 和 $\\bar t(L)=\\sigma^{\\ast}\\,n(L)$。总边界力为这些面力与面积 $A$ 的乘积。\n\n使用带有精确积分的有限元法（FEM），构建与这个由 $2$ 个线性杆单元组成的网格相对应的组装后全局刚度矩阵，形成仅由边界面力引起的全局一致载荷向量，并计算组装后的残差向量 $r=K\\,u^{h}-f$，其中 $u^{h}$ 是通过在网格节点上对 $u^{\\ast}(x)$ 进行插值得到的节点值向量。计算欧几里得范数 $\\|r\\|_{2}$。用牛顿（Newtons）表示你的最终答案，并给出一个数值（方框内不带单位）。如果你的结果是精确的，则无需四舍五入。", "solution": "在尝试求解之前，需对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- **区域与离散化**：位于区间 $[0,L]$ 上的线性弹性杆被离散为 $2$ 个两节点线性杆单元。\n- **节点坐标**：$x_1=0$, $x_2=\\ell_1$, $x_3=L$。\n- **单元长度**：两个单元的长度分别为 $\\ell_1>0$ 和 $\\ell_2>0$，其中 $\\ell_1+\\ell_2=L$。\n- **材料与几何属性**：恒定的杨氏模量 $E>0$ 和恒定的横截面积 $A>0$。\n- **精确位移场**：$u^{\\ast}(x)=\\alpha+\\beta x$，其中 $\\alpha,\\beta\\in\\mathbb{R}$ 为常数。\n- **载荷**：无体力，$b(x)=0$。\n- **边界条件**：给定单位面积上的边界面力，且与 $u^{\\ast}(x)$ 一致。Cauchy 应力为 $\\sigma^{\\ast}=E\\,\\beta$。外法线为 $n(0)=-1$ 和 $n(L)=+1$。面力为 $\\bar t(0)=\\sigma^{\\ast}\\,n(0) = -E\\beta$ 和 $\\bar t(L)=\\sigma^{\\ast}\\,n(L) = E\\beta$。\n- **节点力**：总边界力为在 $x=0$ 处的 $F_0 = A\\,\\bar t(0) = -EA\\beta$ 和在 $x=L$ 处的 $F_L = A\\,\\bar t(L) = EA\\beta$。\n- **有限元未知量**：节点位移向量 $u^{h}$ 通过在节点处对 $u^{\\ast}(x)$ 进行插值得到。\n- **任务**：计算组装后的残差向量 $r=K\\,u^{h}-f$ 的欧几里得范数，其中 $K$ 是全局刚度矩阵，$f$ 是由边界面力产生的全局一致载荷向量。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题基于有限元法框架内的一维线性弹性力学的标准公式，具有科学依据。问题是适定的，提供了唯一确定计算所需量所必需的所有信息。其定义和关系与既有理论一致。问题不包含任何矛盾、歧义或不科学的前提。\n\n### 步骤 3：结论与行动\n问题有效。我们继续求解。\n\n求解过程需要系统地构建残差向量 $r=K\\,u^{h}-f$ 的各个分量。\n\n首先，我们定义长度为 $L_e$、杨氏模量为 $E$、横截面积为 $A$ 的一维线性杆单元的单元刚度矩阵。单元刚度矩阵 $k^{(e)}$ 由下式给出：\n$$ k^{(e)} = \\frac{EA}{L_e} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\n对于连接节点 $1$ 和 $2$ 的第一个单元，其长度为 $L_e = \\ell_1$。其刚度矩阵为：\n$$ k^{(1)} = \\frac{EA}{\\ell_1} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\n对于连接节点 $2$ 和 $3$ 的第二个单元，其长度为 $L_e = \\ell_2$。其刚度矩阵为：\n$$ k^{(2)} = \\frac{EA}{\\ell_2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\n全局刚度矩阵 $K$ 是一个 $3 \\times 3$ 的矩阵，通过组装 $k^{(1)}$ 和 $k^{(2)}$ 的贡献形成。$k^{(1)}$ 的自由度为 $(1,2)$，$k^{(2)}$ 的自由度为 $(2,3)$。\n$$ K = \\begin{pmatrix} k^{(1)}_{11} & k^{(1)}_{12} & 0 \\\\ k^{(1)}_{21} & k^{(1)}_{22} + k^{(2)}_{11} & k^{(2)}_{12} \\\\ 0 & k^{(2)}_{21} & k^{(2)}_{22} \\end{pmatrix} = EA \\begin{pmatrix} \\frac{1}{\\ell_1} & -\\frac{1}{\\ell_1} & 0 \\\\ -\\frac{1}{\\ell_1} & \\frac{1}{\\ell_1} + \\frac{1}{\\ell_2} & -\\frac{1}{\\ell_2} \\\\ 0 & -\\frac{1}{\\ell_2} & \\frac{1}{\\ell_2} \\end{pmatrix} $$\n接着，我们构建全局载荷向量 $f$。问题指明体力为零，$b(x)=0$，载荷仅由给定的边界面力产生。总节点力在边界 $x=0$（节点 $1$）和 $x=L$（节点 $3$）处给出。\n节点 $1$ 处的力为 $F_1 = -EA\\beta$。\n节点 $3$ 处的力为 $F_3 = EA\\beta$。\n节点 $2$ 是一个内部节点，没有外部施加的力，因此 $F_2 = 0$。\n因此，全局载荷向量 $f$ 为：\n$$ f = \\begin{pmatrix} F_1 \\\\ F_2 \\\\ F_3 \\end{pmatrix} = \\begin{pmatrix} -EA\\beta \\\\ 0 \\\\ EA\\beta \\end{pmatrix} $$\n接下来，我们确定节点位移向量 $u^h$。这些值是通过在节点坐标 $x_1=0$、$x_2=\\ell_1$ 和 $x_3=L$ 处计算精确位移场 $u^{\\ast}(x) = \\alpha + \\beta x$ 得到的。\n$$ u_1 = u^{\\ast}(0) = \\alpha + \\beta(0) = \\alpha $$\n$$ u_2 = u^{\\ast}(\\ell_1) = \\alpha + \\beta\\ell_1 $$\n$$ u_3 = u^{\\ast}(L) = \\alpha + \\beta L = \\alpha + \\beta(\\ell_1 + \\ell_2) $$\n节点位移向量为：\n$$ u^h = \\begin{pmatrix} u_1 \\\\ u_2 \\\\ u_3 \\end{pmatrix} = \\begin{pmatrix} \\alpha \\\\ \\alpha + \\beta\\ell_1 \\\\ \\alpha + \\beta(\\ell_1 + \\ell_2) \\end{pmatrix} $$\n现在，我们计算乘积 $K u^h$，它代表了节点上的内力向量。\n$$ K u^h = EA \\begin{pmatrix} \\frac{1}{\\ell_1} & -\\frac{1}{\\ell_1} & 0 \\\\ -\\frac{1}{\\ell_1} & \\frac{1}{\\ell_1} + \\frac{1}{\\ell_2} & -\\frac{1}{\\ell_2} \\\\ 0 & -\\frac{1}{\\ell_2} & \\frac{1}{\\ell_2} \\end{pmatrix} \\begin{pmatrix} \\alpha \\\\ \\alpha + \\beta\\ell_1 \\\\ \\alpha + \\beta(\\ell_1 + \\ell_2) \\end{pmatrix} $$\n我们计算结果向量的每个分量：\n第1行：\n$$ (K u^h)_1 = EA \\left[ \\frac{1}{\\ell_1}(\\alpha) - \\frac{1}{\\ell_1}(\\alpha + \\beta\\ell_1) \\right] = EA \\left[ \\frac{\\alpha}{\\ell_1} - \\frac{\\alpha}{\\ell_1} - \\frac{\\beta\\ell_1}{\\ell_1} \\right] = -EA\\beta $$\n第2行：\n$$ (K u^h)_2 = EA \\left[ -\\frac{1}{\\ell_1}(\\alpha) + \\left(\\frac{1}{\\ell_1} + \\frac{1}{\\ell_2}\\right)(\\alpha + \\beta\\ell_1) - \\frac{1}{\\ell_2}(\\alpha + \\beta(\\ell_1 + \\ell_2)) \\right] $$\n$$ = EA \\left[ -\\frac{\\alpha}{\\ell_1} + \\frac{\\alpha}{\\ell_1} + \\beta + \\frac{\\alpha}{\\ell_2} + \\frac{\\beta\\ell_1}{\\ell_2} - \\frac{\\alpha}{\\ell_2} - \\frac{\\beta\\ell_1}{\\ell_2} - \\beta \\right] = EA [0] = 0 $$\n第3行：\n$$ (K u^h)_3 = EA \\left[ -\\frac{1}{\\ell_2}(\\alpha + \\beta\\ell_1) + \\frac{1}{\\ell_2}(\\alpha + \\beta(\\ell_1 + \\ell_2)) \\right] $$\n$$ = EA \\left[ -\\frac{\\alpha}{\\ell_2} - \\frac{\\beta\\ell_1}{\\ell_2} + \\frac{\\alpha}{\\ell_2} + \\frac{\\beta\\ell_1}{\\ell_2} + \\beta \\right] = EA\\beta $$\n因此，内力向量为：\n$$ K u^h = \\begin{pmatrix} -EA\\beta \\\\ 0 \\\\ EA\\beta \\end{pmatrix} $$\n最后，我们计算残差向量 $r = K u^h - f$：\n$$ r = \\begin{pmatrix} -EA\\beta \\\\ 0 \\\\ EA\\beta \\end{pmatrix} - \\begin{pmatrix} -EA\\beta \\\\ 0 \\\\ EA\\beta \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n残差向量是零向量。这一结果是预料之中的，并验证了有限元法的一个基本原理。由于精确解 $u^{\\ast}(x)$ 是一个线性多项式，且离散化使用线性（仿射）基函数，因此有限元逼近空间包含了精确解。因此，从精确解获得的节点值在用于离散方程组时，必须精确地满足这些方程。残差向量 $r$ 代表了节点处离散平衡方程的不平衡量。零残差表明内力 $K u^h$ 与外力 $f$ 完全平衡。\n\n残差向量 $r$ 的欧几里得范数为：\n$$ \\|r\\|_{2} = \\sqrt{0^2 + 0^2 + 0^2} = 0 $$\n结果，以牛顿表示，是 $0$。", "answer": "$$\\boxed{0}$$", "id": "2538127"}]}