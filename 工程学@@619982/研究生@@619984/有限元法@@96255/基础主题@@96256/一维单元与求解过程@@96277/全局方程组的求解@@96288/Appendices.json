{"hands_on_practices": [{"introduction": "要高效求解有限元法产生的庞大线性系统，迭代法是不可或缺的工具。本练习将带您回到迭代法的基础，从第一性原理出发，为雅可比（Jacobi）、高斯-赛德尔（Gauss–Seidel）和逐次超松弛（SOR）等经典定常迭代法推导其核心的迭代矩阵。通过对一个具体的 $2 \\times 2$ 案例进行分析，您将亲手计算迭代矩阵及其谱半径，从而深刻理解迭代法收敛的根本条件 [@problem_id:2596855]。这一基础性实践是掌握更高级迭代技巧的坚实第一步。", "problem": "对一个具有强制性 (coercive) 的对称椭圆边值问题进行有限元方法 (FEM) 离散化，会得到一个形如 $K u = f$ 的线性系统，其中 $K \\in \\mathbb{R}^{n \\times n}$ 是对称正定 (SPD) 矩阵，且 $f \\in \\mathbb{R}^{n}$。求解 $K u = f$ 的定常迭代法可以由矩阵分裂 $K = M - N$ 构造，其中 $M$ 是非奇异的，这导出了形如 $u^{(k+1)} = M^{-1} N u^{(k)} + M^{-1} f$ 的不动点迭代。相应的迭代矩阵是 $T = M^{-1} N$，该方法从任意初始猜测收敛的充分必要条件是 $T$ 的谱半径严格小于1。\n\n仅利用这些基本事实和典范分解 $K = D - L - U$，其中 $D$ 是 $K$ 的对角部分，$-L$ 是 $K$ 的严格下三角部分，$-U$ 是 $K$ 的严格上三角部分，执行以下操作：\n\n- 从第一性原理出发，推导分别对应于 Jacobi 方法、Gauss–Seidel 方法和 Successive Over-Relaxation (SOR) 方法的迭代矩阵 $T_{\\text{J}}$、$T_{\\text{GS}}$ 和 $T_{\\text{SOR}}$。\n- 以谱半径的形式陈述每种方法的收敛条件，并根据迭代矩阵的特征值对其进行解释。\n\n最后，考虑模型问题 $-u'' = f$ 在 $[0,1]$ 上、带有齐次 Dirichlet 边界条件，在具有 2 个内部节点的均匀网格上通过标准线性 FEM 离散化得到的全局刚度矩阵 $K \\in \\mathbb{R}^{2 \\times 2}$。这得到\n$$\nK = \\begin{pmatrix}\n2 & -1 \\\\\n-1 & 2\n\\end{pmatrix}.\n$$\n对于这个 $K$，显式计算 Gauss–Seidel 迭代矩阵 $T_{\\text{GS}}$ 及其谱半径。将 $T_{\\text{GS}}$ 的谱半径作为最终答案报告。不需要四舍五入。", "solution": "问题陈述已解析并被认定为有效。它具有科学依据，是适定的，并且不包含任何模糊或矛盾之处。它提出了一个数值线性代数中的标准练习，特别涉及对由有限元离散化产生的线性系统的定常迭代法的分析。我们将着手进行求解。\n\n该问题要求推导几种经典定常方法的迭代矩阵，讨论它们的收敛性，并对给定的矩阵 $K$ 进行具体计算。迭代的一般形式由 $u^{(k+1)} = T u^{(k)} + c$ 给出，其中 $T$ 是迭代矩阵， $c = M^{-1} f$。该方法收敛的充分必要条件是迭代矩阵的谱半径 $\\rho(T)$ 严格小于1。谱半径定义为 $\\rho(T) = \\max_i |\\lambda_i(T)|$，其中 $\\lambda_i(T)$ 是 $T$ 的特征值。我们已知线性系统 $K u = f$ 以及矩阵 $K$ 的典范分裂，即将其分为对角部分（$D$）、严格下三角部分（$-L$）和严格上三角部分（$-U$），使得 $K = D - L - U$。\n\n首先，我们推导迭代矩阵 $T_{\\text{J}}$、$T_{\\text{GS}}$ 和 $T_{\\text{SOR}}$。迭代矩阵 $T$ 从 $K$ 的分裂 $K = M - N$ 推导而来，其中 $M$ 是非奇异的。迭代过程为 $M u^{(k+1)} = N u^{(k)} + f$，这等价于 $u^{(k+1)} = M^{-1} N u^{(k)} + M^{-1} f$。因此，迭代矩阵是 $T = M^{-1} N$。因为 $N = M - K$，所以这也可以表示为 $T = M^{-1}(M - K) = I - M^{-1}K$。\n\n对于 Jacobi 方法，选择分裂使得 $M$ 为 $K$ 的对角部分。\n- 分裂：$M_{\\text{J}} = D$ 和 $N_{\\text{J}} = L + U$。\n- 迭代矩阵：$T_{\\text{J}} = M_{\\text{J}}^{-1} N_{\\text{J}} = D^{-1}(L + U)$。\nJacobi 方法的收敛条件是其迭代矩阵的谱半径小于1：$\\rho(T_{\\text{J}}) < 1$。这意味着 $T_{\\text{J}}$ 模最大的特征值必须严格小于1。\n\n对于 Gauss-Seidel 方法，选择分裂使得 $M$ 为 $K$ 的下三角部分，包括对角线。\n- 分裂：$M_{\\text{GS}} = D - L$ 和 $N_{\\text{GS}} = U$。\n- 迭代矩阵：$T_{\\text{GS}} = M_{\\text{GS}}^{-1} N_{\\text{GS}} = (D - L)^{-1} U$。\nGauss-Seidel 方法的收敛条件是 $\\rho(T_{\\text{GS}}) < 1$，这要求 $(D-L)^{-1}U$ 模最大的特征值必须严格小于1。\n\n对于 Successive Over-Relaxation (SOR) 方法，引入一个松弛参数 $\\omega$。迭代过程被构建为前一个迭代解和 Gauss-Seidel 更新的加权平均值。这导出了以下分裂：\n- 分裂：$M_{\\text{SOR}} = \\frac{1}{\\omega}(D - \\omega L)$ 和 $N_{\\text{SOR}} = \\frac{1}{\\omega}((1-\\omega)D + \\omega U)$。\n为了验证这一点，我们检查 $M_{\\text{SOR}} - N_{\\text{SOR}} = \\frac{1}{\\omega}(D - \\omega L) - \\frac{1}{\\omega}((1-\\omega)D + \\omega U) = \\frac{1}{\\omega}(D - \\omega L - D + \\omega D - \\omega U) = D - L - U = K$。\n- 迭代矩阵：$T_{\\text{SOR}} = M_{\\text{SOR}}^{-1} N_{\\text{SOR}} = \\left(\\frac{1}{\\omega}(D - \\omega L)\\right)^{-1} \\left(\\frac{1}{\\omega}((1-\\omega)D + \\omega U)\\right) = (D - \\omega L)^{-1}((1-\\omega)D + \\omega U)$。\nSOR 方法的收敛条件是 $\\rho(T_{\\text{SOR}}) < 1$，这取决于松弛参数 $\\omega$ 的选择。\n\n接下来，我们处理给定矩阵的具体情况：\n$$\nK = \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}\n$$\n我们必须首先计算 Gauss-Seidel 迭代矩阵 $T_{\\text{GS}}$ 及其谱半径。我们将 $K$ 分解为 $D$、$L$ 和 $U$。\n- 对角部分是 $D = \\begin{pmatrix} 2 & 0 \\\\ 0 & 2 \\end{pmatrix}$。\n- 严格下三角部分是 $-L = \\begin{pmatrix} 0 & 0 \\\\ -1 & 0 \\end{pmatrix}$，这意味着 $L = \\begin{pmatrix} 0 & 0 \\\\ 1 & 0 \\end{pmatrix}$。\n- 严格上三角部分是 $-U = \\begin{pmatrix} 0 & -1 \\\\ 0 & 0 \\end{pmatrix}$，这意味着 $U = \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix}$。\n\nGauss-Seidel 迭代矩阵是 $T_{\\text{GS}} = (D-L)^{-1}U$。首先，我们计算 $D-L$：\n$$\nD - L = \\begin{pmatrix} 2 & 0 \\\\ 0 & 2 \\end{pmatrix} - \\begin{pmatrix} 0 & 0 \\\\ 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 2 & 0 \\\\ -1 & 2 \\end{pmatrix}\n$$\n接下来，我们求这个矩阵的逆，即 $(D-L)^{-1}$。对于一个通用的 $2 \\times 2$ 矩阵 $\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$，其逆矩阵是 $\\frac{1}{ad-bc}\\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$。\n$D-L$ 的行列式是 $(2)(2) - (0)(-1) = 4$。\n$$\n(D - L)^{-1} = \\frac{1}{4} \\begin{pmatrix} 2 & 0 \\\\ 1 & 2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} & 0 \\\\ \\frac{1}{4} & \\frac{1}{2} \\end{pmatrix}\n$$\n现在我们通过将 $(D-L)^{-1}$ 乘以 $U$ 来计算 $T_{\\text{GS}}$：\n$$\nT_{\\text{GS}} = (D-L)^{-1}U = \\begin{pmatrix} \\frac{1}{2} & 0 \\\\ \\frac{1}{4} & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} (\\frac{1}{2})(0) + (0)(0) & (\\frac{1}{2})(1) + (0)(0) \\\\ (\\frac{1}{4})(0) + (\\frac{1}{2})(0) & (\\frac{1}{4})(1) + (\\frac{1}{2})(0) \\end{pmatrix} = \\begin{pmatrix} 0 & \\frac{1}{2} \\\\ 0 & \\frac{1}{4} \\end{pmatrix}\n$$\n最后，我们计算 $T_{\\text{GS}}$ 的谱半径。我们通过求解特征方程 $\\det(T_{\\text{GS}} - \\lambda I) = 0$ 来找到特征值 $\\lambda$。\n$$\n\\det\\left(\\begin{pmatrix} 0 & \\frac{1}{2} \\\\ 0 & \\frac{1}{4} \\end{pmatrix} - \\begin{pmatrix} \\lambda & 0 \\\\ 0 & \\lambda \\end{pmatrix}\\right) = \\det\\begin{pmatrix} -\\lambda & \\frac{1}{2} \\\\ 0 & \\frac{1}{4} - \\lambda \\end{pmatrix} = 0\n$$\n行列式是 $(-\\lambda)(\\frac{1}{4} - \\lambda) - (\\frac{1}{2})(0) = -\\lambda(\\frac{1}{4} - \\lambda) = 0$。\n特征值是该方程的根：$\\lambda_1 = 0$ 和 $\\lambda_2 = \\frac{1}{4}$。\n谱半径是特征值绝对值的最大值：\n$$\n\\rho(T_{\\text{GS}}) = \\max(|\\lambda_1|, |\\lambda_2|) = \\max\\left(|0|, \\left|\\frac{1}{4}\\right|\\right) = \\max\\left(0, \\frac{1}{4}\\right) = \\frac{1}{4}\n$$\n对于给定的 $K$，Gauss-Seidel 迭代矩阵的谱半径是 $\\frac{1}{4}$。", "answer": "$$\n\\boxed{\\frac{1}{4}}\n$$", "id": "2596855"}, {"introduction": "在掌握了基本迭代法的原理之后，下一个关键问题是如何提升其收敛速度。预处理技术是解决这一问题的核心策略，本练习旨在深入剖析其背后的数学机理。我们将研究一个源自一维有限元离散的典型刚度矩阵 $K$，并分析应用雅可比预处理（即对角预处理）后的系统性质 [@problem_id:2596789]。通过推导预处理后矩阵的条件数 $\\kappa(J)$ 的精确表达式，您将清晰地看到网格密度 $n$ 如何直接影响求解效率，这对于设计和评估高性能的预处理共轭梯度（PCG）等现代求解器至关重要。", "problem": "考虑单位区间上一个标量、二阶、自伴椭圆算子的边值问题，其带有齐次Dirichlet边界条件。设其弱形式为：求 $u \\in H_{0}^{1}(0,1)$，使得对于任意 $v \\in H_{0}^{1}(0,1)$，\n$$\n\\int_{0}^{1} u'(x)\\,v'(x)\\,\\mathrm{d}x \\;=\\; \\int_{0}^{1} f(x)\\,v(x)\\,\\mathrm{d}x.\n$$\n使用连续分片线性有限元在均匀网格上对该问题进行离散化，网格尺寸为 $h = \\frac{1}{n+1}$，其中 $n$ 是内部节点（自由度）的数量。将得到的全局刚度矩阵记为 $K \\in \\mathbb{R}^{n \\times n}$。矩阵$K$是对称正定（SPD）的。考虑Jacobi预条件子 $M = D$，其中 $D$ 是 $K$ 的对角部分，以及对称预处理矩阵\n$$\nJ \\;=\\; D^{-\\frac{1}{2}}\\,K\\,D^{-\\frac{1}{2}}.\n$$\n从双线性形式的定义和节点基的构造出发，显式地组装 $K$ 和 $D$，然后分析 $J$ 的谱。推导 $J$ 的条件数的闭式表达式，该条件数定义为其最大特征值与最小特征值之比，并表示为$n$的函数。你的最终答案必须是一个关于$n$的、无单位的解析表达式。不要提供不等式；请给出精确的表达式。", "solution": "该问题提法科学严谨、适定，并包含了获得唯一解所需的所有信息。下面我们开始推导。\n\n问题是求解 $u \\in H_{0}^{1}(0,1)$，使得对于所有 $v \\in H_{0}^{1}(0,1)$，弱形式成立：\n$$\na(u,v) = \\int_{0}^{1} u'(x)\\,v'(x)\\,\\mathrm{d}x = \\int_{0}^{1} f(x)\\,v(x)\\,\\mathrm{d}x = L(v).\n$$\n我们使用均匀网格对区域 $[0, 1]$ 进行离散化，节点为 $x_i = i h$，其中 $i=0, 1, \\dots, n+1$，网格尺寸为 $h = \\frac{1}{n+1}$。自由度对应于 $n$ 个内部节点 $x_1, \\dots, x_n$。\n\n有限元空间 $V_h \\subset H_0^1(0,1)$ 由连续的分片线性函数组成。该空间由节点基函数 $\\{\\phi_i(x)\\}_{i=1}^n$ 张成，这些函数通常被称为“帽函数”。每个基函数 $\\phi_i(x)$ 都被定义为分片线性的，满足 $\\phi_i(x_j) = \\delta_{ij}$ (对于 $i,j \\in \\{1, \\dots, n\\}$) 并且 $\\phi_i(0) = \\phi_i(1) = 0$。\n\n$\\phi_i(x)$ 的显式形式为：\n$$\n\\phi_i(x) =\n\\begin{cases}\n\\frac{x - x_{i-1}}{h} & \\text{对于 } x \\in [x_{i-1}, x_i] \\\\\n\\frac{x_{i+1} - x}{h} & \\text{对于 } x \\in [x_i, x_{i+1}] \\\\\n0 & \\text{其他情况}\n\\end{cases}\n$$\n其导数 $\\phi_i'(x)$ 是一个分片常数函数：\n$$\n\\phi_i'(x) =\n\\begin{cases}\n\\frac{1}{h} & \\text{对于 } x \\in (x_{i-1}, x_i) \\\\\n-\\frac{1}{h} & \\text{对于 } x \\in (x_i, x_{i+1}) \\\\\n0 & \\text{其他情况}\n\\end{cases}\n$$\n全局刚度矩阵 $K \\in \\mathbb{R}^{n \\times n}$ 的元素由 $K_{ij} = a(\\phi_j, \\phi_i) = \\int_{0}^{1} \\phi_i'(x) \\phi_j'(x) \\,\\mathrm{d}x$ 给出。\n\n首先，我们计算对角元素 $K_{ii}$：\n$$\nK_{ii} = \\int_{0}^{1} (\\phi_i'(x))^2 \\,\\mathrm{d}x = \\int_{x_{i-1}}^{x_i} \\left(\\frac{1}{h}\\right)^2 \\,\\mathrm{d}x + \\int_{x_i}^{x_{i+1}} \\left(-\\frac{1}{h}\\right)^2 \\,\\mathrm{d}x\n$$\n$$\nK_{ii} = \\frac{1}{h^2}(x_i - x_{i-1}) + \\frac{1}{h^2}(x_{i+1} - x_i) = \\frac{1}{h^2}(h) + \\frac{1}{h^2}(h) = \\frac{2}{h}.\n$$\n接下来，我们计算非对角元素 $K_{i, i+1}$。$\\phi_i'(x)$ 和 $\\phi_{i+1}'(x)$ 的支集仅在区间 $(x_i, x_{i+1})$ 上重叠。\n$$\nK_{i,i+1} = \\int_{0}^{1} \\phi_i'(x) \\phi_{i+1}'(x) \\,\\mathrm{d}x = \\int_{x_i}^{x_{i+1}} \\left(-\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right) \\,\\mathrm{d}x = -\\frac{1}{h^2}(x_{i+1} - x_i) = -\\frac{1}{h}.\n$$\n根据双线性形式的对称性，有 $K_{i+1,i} = K_{i,i+1} = -\\frac{1}{h}$。\n对于 $|i-j| > 1$，$\\phi_i'(x)$ 和 $\\phi_j'(x)$ 的支集不相交，因此它们的乘积处处为零。于是，$K_{ij} = \\int_{0}^{1} 0 \\,\\mathrm{d}x = 0$。\n\n得到的刚度矩阵 $K$ 是一个对称三对角矩阵：\n$$\nK = \\frac{1}{h} \\begin{pmatrix}\n2 & -1 & 0 & \\cdots & 0 \\\\\n-1 & 2 & -1 & \\ddots & \\vdots \\\\\n0 & -1 & 2 & \\ddots & 0 \\\\\n\\vdots & \\ddots & \\ddots & \\ddots & -1 \\\\\n0 & \\cdots & 0 & -1 & 2\n\\end{pmatrix}_{n \\times n}.\n$$\nJacobi预条件子是 $M=D$，其中 $D$ 是 $K$ 的对角部分。根据我们对 $K_{ii}$ 的计算，有：\n$$\nD = \\mathrm{diag}(K) = \\frac{2}{h} I_n,\n$$\n其中 $I_n$ 是 $n \\times n$ 的单位矩阵。\n\n对称预处理矩阵 $J$ 定义为 $J = D^{-1/2} K D^{-1/2}$。我们有：\n$$\nD^{1/2} = \\sqrt{\\frac{2}{h}} I_n \\quad \\text{和} \\quad D^{-1/2} = \\sqrt{\\frac{h}{2}} I_n.\n$$\n将这些代入 $J$ 的表达式中：\n$$\nJ = \\left(\\sqrt{\\frac{h}{2}} I_n\\right) \\left(\\frac{1}{h} \\begin{pmatrix}\n2 & -1 & & \\\\\n-1 & 2 & \\ddots & \\\\\n& \\ddots & \\ddots & -1 \\\\\n& & -1 & 2\n\\end{pmatrix}\\right) \\left(\\sqrt{\\frac{h}{2}} I_n\\right)\n$$\n$$\nJ = \\frac{h}{2} K = \\frac{h}{2} \\frac{1}{h} \\begin{pmatrix}\n2 & -1 & & \\\\\n-1 & 2 & \\ddots & \\\\\n& \\ddots & \\ddots & -1 \\\\\n& & -1 & 2\n\\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix}\n2 & -1 & & \\\\\n-1 & 2 & \\ddots & \\\\\n& \\ddots & \\ddots & -1 \\\\\n& & -1 & 2\n\\end{pmatrix}.\n$$\n因此，$J$是标准三对角矩阵的一个缩放版本。设 $A$ 是一个 $n \\times n$ 矩阵，其对角元素等于2，次对角线和超对角线元素等于-1。则 $J = \\frac{1}{2} A$。\n\n矩阵 $A$ 的特征值是众所周知的，由下式给出：\n$$\n\\mu_k(A) = 2 - 2\\cos\\left(\\frac{k\\pi}{n+1}\\right) \\quad \\text{对于 } k=1, 2, \\dots, n.\n$$\n$J$ 的特征值 $\\lambda_k$ 就是 $A$ 的特征值的 $\\frac{1}{2}$ 倍：\n$$\n\\lambda_k(J) = \\frac{1}{2} \\mu_k(A) = \\frac{1}{2} \\left(2 - 2\\cos\\left(\\frac{k\\pi}{n+1}\\right)\\right) = 1 - \\cos\\left(\\frac{k\\pi}{n+1}\\right).\n$$\n使用三角恒等式 $1 - \\cos(2\\theta) = 2\\sin^2(\\theta)$，我们可以将特征值重写为：\n$$\n\\lambda_k(J) = 2\\sin^2\\left(\\frac{k\\pi}{2(n+1)}\\right) \\quad \\text{对于 } k=1, 2, \\dots, n.\n$$\n条件数 $\\kappa(J)$ 是最大特征值与最小特征值之比，即 $\\kappa(J) = \\frac{\\lambda_{\\max}(J)}{\\lambda_{\\min}(J)}$。\n函数 $\\sin^2(x)$ 在区间 $[0, \\frac{\\pi}{2}]$ 上是单调递增的。对于 $k \\in \\{1, \\dots, n\\}$，其参数 $\\frac{k\\pi}{2(n+1)}$ 位于区间 $(0, \\frac{\\pi}{2})$ 内。\n最小特征值对应于 $k=1$：\n$$\n\\lambda_{\\min}(J) = \\lambda_1 = 2\\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right).\n$$\n最大特征值对应于 $k=n$：\n$$\n\\lambda_{\\max}(J) = \\lambda_n = 2\\sin^2\\left(\\frac{n\\pi}{2(n+1)}\\right).\n$$\n我们可以使用恒等式 $\\sin(\\frac{\\pi}{2} - \\theta) = \\cos(\\theta)$ 来简化 $\\lambda_{\\max}(J)$ 的表达式：\n$$\n\\frac{n\\pi}{2(n+1)} = \\frac{(n+1-1)\\pi}{2(n+1)} = \\frac{\\pi}{2} - \\frac{\\pi}{2(n+1)}.\n$$\n因此，\n$$\n\\lambda_{\\max}(J) = 2\\sin^2\\left(\\frac{\\pi}{2} - \\frac{\\pi}{2(n+1)}\\right) = 2\\cos^2\\left(\\frac{\\pi}{2(n+1)}\\right).\n$$\n现在我们计算条件数：\n$$\n\\kappa(J) = \\frac{\\lambda_{\\max}(J)}{\\lambda_{\\min}(J)} = \\frac{2\\cos^2\\left(\\frac{\\pi}{2(n+1)}\\right)}{2\\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)} = \\left(\\frac{\\cos\\left(\\frac{\\pi}{2(n+1)}\\right)}{\\sin\\left(\\frac{\\pi}{2(n+1)}\\right)}\\right)^2.\n$$\n这可以简化为最终的表达式。\n$$\n\\kappa(J) = \\cot^2\\left(\\frac{\\pi}{2(n+1)}\\right).\n$$\n这就是作为 $n$ 的函数的、经Jacobi预处理的矩阵 $J$ 的条件数的精确闭式表达式。", "answer": "$$\\boxed{\\cot^2\\left(\\frac{\\pi}{2(n+1)}\\right)}$$", "id": "2596789"}, {"introduction": "理论分析与实际编程之间总有一段距离，本练习旨在帮助您跨越这段距离。我们将通过一个编码实践，将理论知识转化为可执行的算法，并解决一个在工程计算中至关重要的问题：迭代过程应在何时停止？[@problem_id:2596884]。您将亲手实现一个带阻尼的雅可比迭代，并采用基于残差范数相对减小的实用型停机准则。通过比较可计算的残差收敛情况与真实的误差（在能量范数下）收敛情况，本练习揭示了停机准则选择的精妙之处及其对最终解精度的深刻影响。", "problem": "给定一个对称正定全局刚度矩阵 $A \\in \\mathbb{R}^{n \\times n}$，该矩阵由区间 $[0,1]$ 上带有齐次狄利克雷边界条件的线性有限元一维均匀网格生成。该刚度矩阵是标准的三对角形式，其对角线元素为 $2/h$，非对角线元素为 $-1/h$，其中 $h = 1/(n+1)$。考虑线性系统 $A x = b$。\n\n您必须实现一种阻尼雅可比（damped Jacobi）类型的定常迭代法，该方法由对角分裂 $A = D + R$ 定义，其中 $D = \\mathrm{diag}(A)$，迭代式为\n$x^{k+1} = x^{k} + \\omega D^{-1} (b - A x^{k})$\n对于给定的松弛参数 $\\omega \\in (0,1]$，从 $x^{0} = 0$ 开始。\n\n定义残差 $r^{k} = b - A x^{k}$ 和误差 $e^{k} = x^{\\star} - x^{k}$，其中 $x^{\\star}$ 是线性系统的精确解。误差的能量范数为 $\\|e^{k}\\|_{A} = \\sqrt{(e^{k})^{\\top} A e^{k}}$，残差的欧几里得范数为 $\\|r^{k}\\|_{2} = \\sqrt{(r^{k})^{\\top} r^{k}}$。\n\n您的任务是：\n- 实现一个基于残差范数相对减小的停止准则：在第一个满足 $\\|r^{k}\\|_{2} / \\|r^{0}\\|_{2} \\le \\tau$ 的迭代指数 $k$ 处停止，其中 $\\tau \\in (0,1]$ 是一个预设的阈值。如果 $k = 0$ 时准则即被满足，则迭代立即终止。\n- 通过在终止时计算比率 $Q$ 来定量评估这个基于残差的停止准则与能量范数下的实际误差之间的关系：\n$Q = \\dfrac{\\|e^{k}\\|_{A} / \\|e^{0}\\|_{A}}{\\|r^{k}\\|_{2} / \\|r^{0}\\|_{2}}$。\n这个标量 $Q$ 比较了能量范数下误差的实际相对减小量与欧几里得范数下残差的强制相对减小量。\n\n为了在不因求解系统而产生数值舍入误差的情况下获得精确解 $x^{\\star}$，请使用构造解（manufactured solution）。令 $u_{i}^{\\star} = \\sin(\\pi i h)$，对于 $i = 1, 2, \\dots, n$ 且 $h = 1/(n+1)$，并定义 $b = A u^{\\star}$。使用初始猜测 $x^{0} = 0$，此时 $e^{0}$ 和 $r^{0}$ 都是非零向量。\n\n为以下参数值 $(n,\\omega,\\tau)$ 的测试套件实现上述过程：\n- 测试 1：$n = 20$，$\\omega = 2/3$，$\\tau = 10^{-6}$。\n- 测试 2：$n = 5$，$\\omega = 1$，$\\tau = 10^{-2}$。\n- 测试 3：$n = 50$，$\\omega = 1/2$，$\\tau = 10^{-4}$。\n- 测试 4（边界情况）：$n = 30$，$\\omega = 1$，$\\tau = 1$。\n\n您的程序必须：\n- 为每个 $n$ 构造 $A$，构造 $u^{\\star}$，设置 $b = A u^{\\star}$，并使用上述停止规则运行阻尼雅可比迭代。请为迭代次数设置一个足够大的上限以避免无限循环。\n- 对于每个测试，在终止迭代时生成标量 $Q$。\n- 输出单行，其中包含四个 $Q$ 值的列表，按测试 1 到 4 的顺序排列，形式为用方括号括起来的逗号分隔列表，例如 $[\\dots]$。\n\n本问题中不需要物理单位或角度单位。每个测试的最终输出是实数，程序必须将它们聚合到单行中：一个形式为 $[q_{1},q_{2},q_{3},q_{4}]$ 的列表，其中每个 $q_{j}$ 等于测试 $j$ 的 $Q$ 值。", "solution": "该问题陈述已经过严格验证，被认为是具有科学依据、适定且完整的。它描述了一个标准的数值实验，用于分析迭代求解器——阻尼雅可比方法——在一个源自有限元方法的模型问题上的收敛性质。使用构造解，其中初始误差与系统矩阵的一个特征向量对齐，是分析收敛行为的一种有效且富有洞察力的技术。我们将进行形式化的求解。\n\n该问题要求实现用于线性系统 $A x = b$ 的阻尼雅可比迭代，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是在一维均匀网格上的有限元问题的刚度矩阵。矩阵 $A$ 是三对角的，其元素为 $A_{ii} = 2/h$ 和 $A_{i,i\\pm 1} = -1/h$，其中 $h = 1/(n+1)$。该系统的定义使得精确解 $x^{\\star}$ 是一个已知向量 $u^{\\star}$，其分量为 $u_{i}^{\\star} = \\sin(\\pi i h)$。因此，右端项被构造为 $b = A u^{\\star}$。\n\n阻尼雅可比迭代由下式给出\n$$ x^{k+1} = x^{k} + \\omega D^{-1} (b - A x^{k}) $$\n其中 $x^0=0$，$D = \\mathrm{diag}(A)$ 是 $A$ 的对角部分，$\\omega \\in (0,1]$ 是一个松弛参数。由于 $A$ 的所有对角线元素都是 $2/h$，因此 $D$ 是标量矩阵 $D = (2/h)I$，其中 $I$ 是单位矩阵。其逆矩阵为 $D^{-1} = (h/2)I$。该迭代可以用残差 $r^k = b - A x^k$ 表示为：\n$$ x^{k+1} = x^{k} + \\omega \\frac{h}{2} r^{k} $$\n\n一个关键的洞见来自于对误差传播的分析。第 $k$ 步的误差是 $e^k = x^{\\star} - x^k$。误差传播公式推导如下：\n$$ e^{k+1} = x^{\\star} - x^{k+1} = x^{\\star} - (x^k + \\omega D^{-1}(b - A x^k)) = (x^{\\star} - x^k) - \\omega D^{-1}(A x^{\\star} - A x^k) $$\n$$ e^{k+1} = e^k - \\omega D^{-1} A e^k = (I - \\omega D^{-1} A) e^k $$\n矩阵 $M = I - \\omega D^{-1} A$ 是迭代矩阵。\n\n初始猜测是 $x^0 = 0$，所以初始误差是 $e^0 = x^{\\star} - 0 = u^{\\star}$。向量 $u^{\\star}$ 的分量 $u_i^{\\star} = \\sin(\\pi i h) = \\sin\\left(\\frac{i\\pi}{n+1}\\right)$ 是一个离散正弦函数。给定矩阵 $A$ 的一个已知性质是，这类向量是它的特征向量。具体来说，$u^{\\star}$ 是对应于 $A$ 的最小特征值 $\\lambda_1$ 的特征向量。\n因此，$A u^{\\star} = \\lambda_1 u^{\\star}$。\n\n由于 $e^0 = u^{\\star}$ 是 $A$ 的一个特征向量，它也是 $D^{-1}A$ 的一个特征向量，因此也是迭代矩阵 $M$ 的一个特征向量：\n$$ M e^0 = (I - \\omega D^{-1} A) e^0 = e^0 - \\omega D^{-1} (A e^0) = e^0 - \\omega D^{-1} (\\lambda_1 e^0) $$\n由于 $D^{-1} = (h/2)I$，我们有 $D^{-1}e^0 = (h/2)e^0$。\n$$ M e^0 = (1 - \\omega (h/2) \\lambda_1) e^0 $$\n这表明 $e^0$ 是 $M$ 的一个特征向量，其特征值为 $\\mu_1 = 1 - \\omega (h/2) \\lambda_1$。\n任何后续步骤的误差由 $e^k = M^k e^0 = \\mu_1^k e^0$ 给出。这意味着，在精确算术中，每次迭代的误差向量 $e^k$ 都保持在初始误差 $e^0$ 的方向上。\n\n问题要求计算在终止迭代 $k$ 时的量 $Q$：\n$$ Q = \\dfrac{\\|e^{k}\\|_{A} / \\|e^{0}\\|_{A}}{\\|r^{k}\\|_{2} / \\|r^{0}\\|_{2}} $$\n其中 $\\|v\\|_A = \\sqrt{v^\\top A v}$ 且 $\\|v\\|_2$ 是欧几里得范数。\n让我们分别分析分子和分母。\n关系式 $r^k = A e^k$ 对所有 $k$ 都成立。对于我们的特定情况，$e^k = \\mu_1^k e^0$。\n分子：\n$$ \\frac{\\|e^k\\|_A}{\\|e^0\\|_A} = \\frac{\\sqrt{(e^k)^\\top A e^k}}{\\sqrt{(e^0)^\\top A e^0}} = \\frac{\\sqrt{(\\mu_1^k e^0)^\\top A (\\mu_1^k e^0)}}{\\|e^0\\|_A} = \\frac{|\\mu_1^k| \\sqrt{(e^0)^\\top A e^0}}{\\|e^0\\|_A} = |\\mu_1^k| $$\n分母：\n$$ \\frac{\\|r^k\\|_2}{\\|r^0\\|_2} = \\frac{\\|A e^k\\|_2}{\\|A e^0\\|_2} = \\frac{\\|A (\\mu_1^k e^0)\\|_2}{\\|A e^0\\|_2} = \\frac{\\|\\mu_1^k (A e^0)\\|_2}{\\|A e^0\\|_2} = \\frac{|\\mu_1^k| \\|A e^0\\|_2}{\\|A e^0\\|_2} = |\\mu_1^k| $$\n因此，在精确算术中，$Q = |\\mu_1^k| / |\\mu_1^k| = 1$。这对任何终止迭代 $k > 0$ 都成立。对于边界情况 $k=0$（如在测试4中 $\\tau=1$），比率显然为 $\\|e^0\\|_A / \\|e^0\\|_A = 1$ 和 $\\|r^0\\|_2 / \\|r^0\\|_2 = 1$，所以 $Q=1$。\n\n任务是执行数值模拟。计算出的 $Q$ 值将是对这一理论恒等式在有限精度算术中如何成立的定量评估，在有限精度算术中，舍入误差可能会在多次迭代后将来自其他特征空间的的分量引入误差向量。\n\n对于每个测试案例 $(n, \\omega, \\tau)$ 的算法如下：\n1. 构造矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 和向量 $u^{\\star} \\in \\mathbb{R}^n$。\n2. 计算 $b = A u^{\\star}$。\n3. 初始化 $k=0$ 和 $x^0=0$。\n4. 计算初始误差 $e^0 = u^{\\star}$ 和初始残差 $r^0 = b$。计算它们的范数 $\\|e^0\\|_A$ 和 $\\|r^0\\|_2$。\n5. 检查停止准则：$\\|r^k\\|_2 / \\|r^0\\|_2 \\le \\tau$。如果满足，则在第 $k$ 步终止。\n6. 如果不满足，则进入迭代循环。对于每个后续步骤，更新解向量 $x^{k+1} = x^k + \\omega(h/2)r^k$，计算新残差 $r^{k+1} = b - A x^{k+1}$，并检查停止准则。\n7. 使用最大迭代次数来防止无限执行。\n8. 在第 $k$ 次迭代终止时，计算最终误差 $e^k = u^{\\star} - x^k$，其A-范数 $\\|e^k\\|_A$，以及最终残差的L2-范数 $\\|r^k\\|_2$。\n9. 计算最终量 $Q$。\n将为指定的四个测试案例中的每一个实施此程序。", "answer": "[1.0, 1.0, 1.0, 1.0]", "id": "2596884"}]}