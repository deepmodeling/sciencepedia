{"hands_on_practices": [{"introduction": "高斯求积法则以其卓越的精度在有限元方法中扮演着核心角色。然而，这些求积点和权重是如何确定的呢？本练习将通过从第一性原理出发，揭开两点高斯-勒让德求积法则的神秘面纱。你将通过强制该法则对低阶多项式（在此为最高三次）精确成立，来推导出一组非线性方程并求解，从而亲手计算出求积节点的位置和对应的权重[@problem_id:2591926]。这个实践旨在将抽象的“矩匹配”概念转化为具体的计算步骤，从而加深你对数值积分法则构造核心思想的理解。", "problem": "在有限元方法中，参考区间上的积分通常通过高斯求积来计算。考虑参考区间 $[-1,1]$ 和单位权函数 $w(x)=1$。求一个具有 $n=2$ 个节点的形式如下的求积法则\n$$\n\\int_{-1}^{1} f(x)\\,dx \\approx w_1 f(x_1) + w_2 f(x_2),\n$$\n其中 $x_1,x_2 \\in (-1,1)$ 且 $w_1,w_2>0$。仅使用该求积法则对所有次数至多为3的多项式 $f(x)$ 精确成立这一要求，构建与 $f(x)=x^k$（其中 $k\\in\\{0,1,2,3\\}$）相关的矩匹配方程组，并求解以确定 $x_1,x_2,w_1,w_2$。你的推导不得援引任何超出“对单项式精确成立”这一定义要求和基本多项式积分演算范畴的特殊函数表或性质。\n\n然后，通过对 $k\\in\\{0,1,2,3\\}$ 直接代入 $f(x)=x^k$，并在每种情况下确认精确积分值与求积和相等，来验证你的结果。\n\n将你的最终答案表示为一个满足排序约束 $x_1<0<x_2$ 的单行矩阵 $\\big(x_1,\\;x_2,\\;w_1,\\;w_2\\big)$。无需四舍五入，且不涉及单位。", "solution": "目标是在区间 $[-1,1]$ 上构建一个具有 $n=2$ 个节点的求积法则，该法则对所有次数至多为3的多项式都精确成立。根据定义，对次数至多为3的多项式精确成立意味着，对于 $f(x)=x^k$ (其中 $k\\in\\{0,1,2,3\\}$)，有\n$$\n\\int_{-1}^{1} x^k\\,dx \\;=\\; w_1 x_1^k + w_2 x_2^k.\n$$\n我们仅使用单项式的积分来建立相应的方程。所需的精确积分值通过基本微积分计算如下：\n- 当 $k=0$ 时，$\\displaystyle \\int_{-1}^{1} x^0\\,dx = \\int_{-1}^{1} 1\\,dx = 2$。\n- 当 $k=1$ 时，$\\displaystyle \\int_{-1}^{1} x\\,dx = 0$，根据对称性。\n- 当 $k=2$ 时，$\\displaystyle \\int_{-1}^{1} x^2\\,dx = \\left[\\frac{x^3}{3}\\right]_{-1}^{1} = \\frac{1}{3}-\\left(-\\frac{1}{3}\\right)=\\frac{2}{3}$。\n- 当 $k=3$ 时，$\\displaystyle \\int_{-1}^{1} x^3\\,dx = 0$，根据对称性。\n\n因此，矩匹配方程组为\n\n$$\n\\begin{aligned}\n&k=0:\\quad && w_1 + w_2 = 2, \\\\\n&k=1:\\quad && w_1 x_1 + w_2 x_2 = 0, \\\\\n&k=2:\\quad && w_1 x_1^2 + w_2 x_2^2 = \\frac{2}{3}, \\\\\n&k=3:\\quad && w_1 x_1^3 + w_2 x_2^3 = 0.\n\\end{aligned}\n$$\n\n\n现在我们仅利用这些方程来确定参数。考虑关于奇次矩的两个方程：\n\n$$\nw_1 x_1 + w_2 x_2 = 0,\\qquad w_1 x_1^3 + w_2 x_2^3 = 0.\n$$\n\n引入变量 $y_1 := w_1 x_1$ 和 $y_2 := w_2 x_2$。该方程组变为\n\n$$\n\\begin{pmatrix}\n1 & 1 \\\\\nx_1^2 & x_2^2\n\\end{pmatrix}\n\\begin{pmatrix}\ny_1 \\\\ y_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\ 0\n\\end{pmatrix}.\n$$\n\n为使非平凡解 $(y_1,y_2)$ 存在（这是必需的，除非 $x_1=x_2=0$，但这是不允许的，因为对于一个非零精确度的两点法则，节点必须是不同的），其行列式必须为零：\n\n$$\nx_2^2 - x_1^2 = 0 \\quad \\Rightarrow \\quad x_2^2 = x_1^2.\n$$\n\n因此 $|x_1|=|x_2|$。由于节点必须是不同的且位于 $(-1,1)$ 内，我们得出结论\n\n$$\nx_2 = -x_1.\n$$\n\n回到 $y_1 + y_2 = 0$ 并代入 $x_2=-x_1$ 可得\n\n$$\nw_1 x_1 + w_2 (-x_1) = 0 \\;\\Rightarrow\\; (w_1 - w_2) x_1 = 0.\n$$\n\n因为 $x_1 \\neq 0$，所以\n\n$$\nw_1 = w_2.\n$$\n\n将公共权重记为 $w$，正节点记为 $a>0$，则 $x_1=-a$，$x_2=+a$ 且 $w_1=w_2=w$。余下的两个方程变为\n\n$$\nw + w = 2 \\;\\Rightarrow\\; 2w = 2 \\;\\Rightarrow\\; w = 1,\n$$\n\n和\n\n$$\nw x_1^2 + w x_2^2 = \\frac{2}{3} \\;\\Rightarrow\\; 1\\cdot a^2 + 1\\cdot a^2 = \\frac{2}{3} \\;\\Rightarrow\\; 2a^2 = \\frac{2}{3} \\;\\Rightarrow\\; a^2 = \\frac{1}{3}.\n$$\n\n取 $a>0$ 可得 $a = \\frac{1}{\\sqrt{3}}$。施加排序约束 $x_1<0<x_2$ 可得\n\n$$\nx_1 = -\\frac{1}{\\sqrt{3}},\\quad x_2 = \\frac{1}{\\sqrt{3}},\\quad w_1 = 1,\\quad w_2 = 1.\n$$\n\n\n对 $k\\in\\{0,1,2,3\\}$ 进行验证：\n- 当 $k=0$ 时：$w_1+w_2 = 1+1 = 2 = \\int_{-1}^{1} 1\\,dx$。\n- 当 $k=1$ 时：$w_1 x_1 + w_2 x_2 = 1\\cdot\\left(-\\frac{1}{\\sqrt{3}}\\right) + 1\\cdot\\left(\\frac{1}{\\sqrt{3}}\\right) = 0 = \\int_{-1}^{1} x\\,dx$。\n- 当 $k=2$ 时：$w_1 x_1^2 + w_2 x_2^2 = 1\\cdot\\frac{1}{3} + 1\\cdot\\frac{1}{3} = \\frac{2}{3} = \\int_{-1}^{1} x^2\\,dx$。\n- 当 $k=3$ 时：$w_1 x_1^3 + w_2 x_2^3 = 1\\cdot\\left(-\\frac{1}{3\\sqrt{3}}\\right) + 1\\cdot\\left(\\frac{1}{3\\sqrt{3}}\\right) = 0 = \\int_{-1}^{1} x^3\\,dx$。\n\n因此，所构建的在 $[-1,1]$ 上的 $n=2$ 点高斯-勒让德求积法则的节点和权重为\n\n$$\nx_1 = -\\frac{1}{\\sqrt{3}},\\quad x_2 = \\frac{1}{\\sqrt{3}},\\quad w_1 = 1,\\quad w_2 = 1,\n$$\n\n这些值满足了对所有次数至多为3的多项式精确成立的要求。", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{1}{\\sqrt{3}} & \\frac{1}{\\sqrt{3}} & 1 & 1\\end{pmatrix}}$$", "id": "2591926"}, {"introduction": "在掌握了一维求积法则的构建方法后，我们自然地将目光投向了更贴近实际有限元应用的二维情况。本练习将引导你在一个标准的参考三角形单元上，构造一个对称的三点求积法则[@problem_id:2591977]。你将利用重心坐标和对称性来简化问题，并通过求解矩方程组来确定求积点的位置和权重，以确保该法则对二次多项式精确。这项实践不仅能让你熟悉在单纯形（如三角形）上进行积分的技巧，还能让你体会到如何利用几何对称性来高效地设计数值格式。", "problem": "在有限元法 (FEM) 中，单纯形上的单元积分通常通过求积法则来近似，这些求积法则被构造为对所有不超过给定总次数的多项式都是精确的。考虑参考三角形 $\\widehat{T} = \\{(x,y) \\in \\mathbb{R}^{2} : x \\ge 0,\\ y \\ge 0,\\ x + y \\le 1\\}$，其面积为 $\\lvert \\widehat{T} \\rvert = \\frac{1}{2}$。一个具有单一轨道点的完全对称求积法则有 $3$ 个节点，由重心三元组 $(a,a,1-2a)$ 的排列给出，并且每个节点有相同的权重 $w$，因此对于任何被积函数 $f$，\n$$\n\\int_{\\widehat{T}} f(x,y)\\,dx\\,dy = \\lvert \\widehat{T} \\rvert \\sum_{i=1}^{3} w\\, f(x_i,y_i),\n$$\n其中 $(x_i,y_i)$ 是相对于顶点 $(0,0)$、$(1,0)$、$(0,1)$ 的重心坐标 $(a,a,1-2a)$ 的 $3$ 个排列所对应的笛卡尔坐标。仅使用基本定义和矩的直接计算，确定参数 $w$ 和 $a$，使得该法则对 $\\widehat{T}$ 上所有总次数至多为 $2$ 的多项式都是精确的。施加内点条件，即所有重心坐标都严格为正，即 $a \\in (0,\\tfrac{1}{2})$。然后，通过对 $\\widehat{T}$ 进行直接积分，并与求积计算结果进行比较，使用测试集 $\\{1, x, y, x^{2}, xy, y^{2}\\}$ 显式地检验该法则的精确性来验证结果。\n\n以单行矩阵的形式给出你的最终答案，即数对 $(w,a)$。无需四舍五入。", "solution": "目标是为参考三角形 $\\widehat{T}$ 上的一个3点对称求积法则找到权重 $w$ 和重心坐标参数 $a$，该法则对所有总次数最高为 $2$ 的多项式都精确。总次数最多为 $2$ 的多项式空间，记作 $\\mathcal{P}_2(\\widehat{T})$，有一组基 $\\{1, x, y, x^2, xy, y^2\\}$。该求积法则必须能精确地积分这些基函数中的每一个。\n\n该求积法则由下式给出\n$$\n\\int_{\\widehat{T}} f(x,y)\\,dx\\,dy \\approx \\lvert \\widehat{T} \\rvert \\sum_{i=1}^{3} w\\, f(x_i,y_i) = \\frac{1}{2} w \\sum_{i=1}^{3} f(x_i,y_i)\n$$\n求积点 $(x_i, y_i)$ 是对应于由三元组 $(a, a, 1-2a)$ 给出的重心坐标 $(\\lambda_1, \\lambda_2, \\lambda_3)$ 的排列的笛卡尔坐标。参考三角形 $\\widehat{T}$ 的顶点是 $V_1=(0,0)$、$V_2=(1,0)$ 和 $V_3=(0,1)$。一个重心坐标为 $(\\lambda_1, \\lambda_2, \\lambda_3)$ 的点的笛卡尔坐标为 $(x,y) = \\lambda_1 V_1 + \\lambda_2 V_2 + \\lambda_3 V_3 = (\\lambda_2, \\lambda_3)$。$(a, a, 1-2a)$ 的三个排列导出以下求积点：\n\\begin{itemize}\n    \\item $P_1$: $(\\lambda_1, \\lambda_2, \\lambda_3) = (1-2a, a, a) \\implies (x_1, y_1) = (a, a)$\n    \\item $P_2$: $(\\lambda_1, \\lambda_2, \\lambda_3) = (a, 1-2a, a) \\implies (x_2, y_2) = (1-2a, a)$\n    \\item $P_3$: $(\\lambda_1, \\lambda_2, \\lambda_3) = (a, a, 1-2a) \\implies (x_3, y_3) = (a, 1-2a)$\n\\end{itemize}\n条件 $a \\in (0, \\frac{1}{2})$ 确保了 $a > 0$ 和 $1-2a > 0$，因此所有重心坐标都严格为正，从而将点置于三角形的内部。\n\n我们首先使用公式 $\\int_{\\widehat{T}} x^m y^n \\,dx\\,dy = \\frac{m! n!}{(m+n+2)!}$ 计算基多项式在 $\\widehat{T}$ 上的精确积分（矩）：\n$$\n\\begin{align*}\n    I(1) &= \\int_{\\widehat{T}} 1 \\,dx\\,dy = \\frac{0!0!}{2!} = \\frac{1}{2} \\\\\n    I(x) &= \\int_{\\widehat{T}} x \\,dx\\,dy = \\frac{1!0!}{3!} = \\frac{1}{6} \\\\\n    I(y) &= \\int_{\\widehat{T}} y \\,dx\\,dy = \\frac{0!1!}{3!} = \\frac{1}{6} \\\\\n    I(x^2) &= \\int_{\\widehat{T}} x^2 \\,dx\\,dy = \\frac{2!0!}{4!} = \\frac{2}{24} = \\frac{1}{12} \\\\\n    I(xy) &= \\int_{\\widehat{T}} xy \\,dx\\,dy = \\frac{1!1!}{4!} = \\frac{1}{24} \\\\\n    I(y^2) &= \\int_{\\widehat{T}} y^2 \\,dx\\,dy = \\frac{0!2!}{4!} = \\frac{2}{24} = \\frac{1}{12}\n\\end{align*}\n$$\n\n接下来，我们对每个基函数计算求积法则，记为 $Q(f)$：\n$$\n\\begin{align*}\n    Q(1) &= \\frac{1}{2} w (1 + 1 + 1) = \\frac{3w}{2} \\\\\n    Q(x) &= \\frac{1}{2} w (a + (1-2a) + a) = \\frac{w}{2} \\\\\n    Q(y) &= \\frac{1}{2} w (a + a + (1-2a)) = \\frac{w}{2} \\\\\n    Q(x^2) &= \\frac{1}{2} w (a^2 + (1-2a)^2 + a^2) = \\frac{1}{2} w (2a^2 + 1 - 4a + 4a^2) = \\frac{w}{2} (6a^2 - 4a + 1) \\\\\n    Q(xy) &= \\frac{1}{2} w (a \\cdot a + (1-2a)a + a(1-2a)) = \\frac{1}{2} w (a^2 + 2a - 4a^2) = \\frac{w}{2} (2a - 3a^2) \\\\\n    Q(y^2) &= \\frac{1}{2} w (a^2 + a^2 + (1-2a)^2) = \\frac{1}{2} w (2a^2 + 1 - 4a + 4a^2) = \\frac{w}{2} (6a^2 - 4a + 1)\n\\end{align*}\n$$\n\n我们令精确积分与求积近似值相等，即 $I(f) = Q(f)$，从而建立一个关于 $w$ 和 $a$ 的方程组。\n\n对于0次多项式：\n$I(1) = Q(1) \\implies \\frac{1}{2} = \\frac{3w}{2} \\implies w = \\frac{1}{3}$。\n\n对于1次多项式：\n$I(x) = Q(x) \\implies \\frac{1}{6} = \\frac{w}{2} \\implies w = \\frac{1}{3}$。\n$I(y) = Q(y) \\implies \\frac{1}{6} = \\frac{w}{2} \\implies w = \\frac{1}{3}$。\n这些结果与0次多项式的结果一致。法则的对称结构确保了如果 $I(x)=Q(x)$，那么 $I(y)=Q(y)$ 也成立。\n\n对于2次多项式，我们代入 $w = \\frac{1}{3}$：\n$I(x^2) = Q(x^2) \\implies \\frac{1}{12} = \\frac{1}{2} \\left(\\frac{1}{3}\\right) (6a^2 - 4a + 1) \\implies \\frac{1}{12} = \\frac{1}{6} (6a^2 - 4a + 1)$。\n两边乘以 $12$ 得到 $1 = 2(6a^2 - 4a + 1)$，化简为二次方程 $12a^2 - 8a + 1 = 0$。\n由 $I(y^2) = Q(y^2)$ 得到的方程因对称性而完全相同。\n\n$I(xy) = Q(xy) \\implies \\frac{1}{24} = \\frac{1}{2} \\left(\\frac{1}{3}\\right) (2a - 3a^2) \\implies \\frac{1}{24} = \\frac{1}{6} (2a - 3a^2)$。\n两边乘以 $24$ 得到 $1 = 4(2a - 3a^2)$，化简为 $1 = 8a - 12a^2$，即 $12a^2 - 8a + 1 = 0$。\n所有二次多项式都得出关于 $a$ 的相同条件。\n\n我们使用求根公式解二次方程 $12a^2 - 8a + 1 = 0$：\n$$ a = \\frac{-(-8) \\pm \\sqrt{(-8)^2 - 4(12)(1)}}{2(12)} = \\frac{8 \\pm \\sqrt{64 - 48}}{24} = \\frac{8 \\pm \\sqrt{16}}{24} = \\frac{8 \\pm 4}{24} $$\n两个解是 $a_1 = \\frac{8+4}{24} = \\frac{12}{24} = \\frac{1}{2}$ 和 $a_2 = \\frac{8-4}{24} = \\frac{4}{24} = \\frac{1}{6}$。\n问题施加了严格的内点条件 $a \\in (0, \\frac{1}{2})$。解 $a_1 = \\frac{1}{2}$ 位于此区间的边界上，因此被舍弃。解 $a_2 = \\frac{1}{6}$ 在该区间内。\n因此，所求的参数为 $w = \\frac{1}{3}$ 和 $a = \\frac{1}{6}$。\n\n最后，我们按要求对推导出的参数进行精确性验证。\n当 $w=\\frac{1}{3}$ 和 $a=\\frac{1}{6}$ 时，求积法则为 $Q(f) = \\frac{1}{6} \\sum_{i=1}^{3} f(x_i, y_i)$。\n点参数为 $1-2a = 1-2(\\frac{1}{6}) = 1-\\frac{1}{3} = \\frac{2}{3}$。\n笛卡尔点为 $P_1 = (\\frac{1}{6}, \\frac{1}{6})$，$P_2 = (\\frac{2}{3}, \\frac{1}{6})$ 和 $P_3 = (\\frac{1}{6}, \\frac{2}{3})$。\n将该法则应用于基函数：\n$$\n\\begin{align*}\n    Q(1) &= \\frac{1}{6}(1+1+1) = \\frac{3}{6} = \\frac{1}{2} = I(1) \\\\\n    Q(x) &= \\frac{1}{6}(\\frac{1}{6} + \\frac{2}{3} + \\frac{1}{6}) = \\frac{1}{6}(\\frac{1}{6} + \\frac{4}{6} + \\frac{1}{6}) = \\frac{1}{6}(\\frac{6}{6}) = \\frac{1}{6} = I(x) \\\\\n    Q(y) &= \\frac{1}{6}(\\frac{1}{6} + \\frac{1}{6} + \\frac{2}{3}) = \\frac{1}{6}(\\frac{1}{6} + \\frac{1}{6} + \\frac{4}{6}) = \\frac{1}{6}(\\frac{6}{6}) = \\frac{1}{6} = I(y) \\\\\n    Q(x^2) &= \\frac{1}{6}\\left((\\frac{1}{6})^2 + (\\frac{2}{3})^2 + (\\frac{1}{6})^2\\right) = \\frac{1}{6}\\left(\\frac{1}{36} + \\frac{16}{36} + \\frac{1}{36}\\right) = \\frac{1}{6}\\left(\\frac{18}{36}\\right) = \\frac{1}{6 \\cdot 2} = \\frac{1}{12} = I(x^2) \\\\\n    Q(xy) &= \\frac{1}{6}\\left(\\frac{1}{6}\\cdot\\frac{1}{6} + \\frac{2}{3}\\cdot\\frac{1}{6} + \\frac{1}{6}\\cdot\\frac{2}{3}\\right) = \\frac{1}{6}\\left(\\frac{1}{36} + \\frac{2}{18} + \\frac{2}{18}\\right) = \\frac{1}{6}\\left(\\frac{1}{36} + \\frac{4}{36} + \\frac{4}{36}\\right) = \\frac{1}{6}\\left(\\frac{9}{36}\\right) = \\frac{1}{6 \\cdot 4} = \\frac{1}{24} = I(xy) \\\\\n    Q(y^2) &= \\frac{1}{6}\\left((\\frac{1}{6})^2 + (\\frac{1}{6})^2 + (\\frac{2}{3})^2\\right) = \\frac{1}{6}\\left(\\frac{1}{36} + \\frac{1}{36} + \\frac{16}{36}\\right) = \\frac{1}{6}\\left(\\frac{18}{36}\\right) = \\frac{1}{6 \\cdot 2} = \\frac{1}{12} = I(y^2)\n\\end{align*}\n$$\n验证证实，参数为 $w=\\frac{1}{3}$ 和 $a=\\frac{1}{6}$ 的法则对所有次数最高为 $2$ 的基多项式都是精确的。因此，解是正确的。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{3} & \\frac{1}{6} \\end{pmatrix}}\n$$", "id": "2591977"}, {"introduction": "不同的高斯求积法则家族（如Gauss-Legendre, Gauss-Radau, Gauss-Lobatto）具有不同的节点分布和精度阶。本练习提供了一个精妙的诊断性挑战，旨在通过一个特殊构造的多项式，来精确地检验和比较不同求积法则的精度界限[@problem_id:2591954]。你将分析为何对于一个$2n-2$次的多项式，具有相同节点数的$n$点Gauss-Radau法则能够精确积分，而$n$点Gauss-Lobatto法则却会产生显著误差。这个练习将深化你对求积法则“精度阶”定义的理解，并揭示预设积分节点对法则性能的深刻影响。", "problem": "考虑在区间 $[-1,1]$ 上，针对有限元法 (FEM) 中出现的被积函数，使用单位权重的数值积分。令 $P_{k}(x)$ 表示 $k$ 次 Legendre 多项式，其经过归一化以满足 $P_{k}(1)=1$。定义多项式\n$$\nq_{n}(x) \\;=\\; \\bigl(1-x^{2}\\bigr)\\,\\bigl(P_{n-1}'(x)\\bigr)^{2},\n$$\n对于任意整数 $n\\ge 2$，该多项式的次数为 $2n-2$。\n\n你需要比较 $n$ 点 Gauss–Radau 积分（包含端点 $x=1$）和 $n$ 点 Gauss–Lobatto 积分（包含两个端点 $x=\\pm 1$）作用于此被积函数时的结果。\n\n任务：\n- 基于矩条件的精确度阶和参数计数的第一性原理，确定在 (i) 未预先指定端点，(ii) 预先指定一个端点，以及 (iii) 预先指定两个端点的情况下，$[-1,1]$ 上的 $n$ 点积分可达到的最高代数精确度阶。解释为何 Gauss–Radau 和 Gauss–Lobatto 构造能达到各自的最高值。\n- 证明对于 $n$ 点法则，$q_{n}(x)$ 在所有 Gauss–Lobatto 节点上均为零，并由此推断 Gauss–Lobatto 法则对 $\\int_{-1}^{1} q_{n}(x)\\,dx$ 返回的数值。\n- 利用 Legendre 多项式的性质，计算定积分 $\\int_{-1}^{1} q_{n}(x)\\,dx$ 的精确值，结果表示为关于 $n$ 的闭合形式表达式。\n- 解释为何 $n$ 点 Gauss–Radau 法则对 $\\int_{-1}^{1} q_{n}(x)\\,dx$ 返回精确值，而 $n$ 点 Gauss–Lobatto 法则却不能。\n\n你的最终答案必须是 $\\int_{-1}^{1} q_{n}(x)\\,dx$ 精确值的、关于 $n$ 的单一闭合形式表达式。无需进行舍入。", "solution": "给定的任务要求对 Gauss 型积分法则进行系统性分析。我们将按顺序处理每个要点。\n\n首先，我们确定在区间 $[-1,1]$ 上，对于单位权重函数 $w(x)=1$ 的一个 $n$ 点积分法则，其能达到的最高精确度阶。一个 $n$ 点积分法则的形式如下：\n$$\n\\int_{-1}^{1} f(x) \\,dx \\approx \\sum_{i=1}^{n} w_i f(x_i)\n$$\n其中 $\\{x_i\\}_{i=1}^{n}$ 是节点，$\\{w_i\\}_{i=1}^{n}$ 是权重。如果一个法则对于所有次数小于或等于 $d$ 的多项式都是精确的，但对于某个 $d+1$ 次多项式不精确，则称该法则具有 $d$ 阶精确度。为使该法则对所有次数最高为 $d$ 的多项式都精确，它必须满足以下 $d+1$ 个矩方程：\n$$\n\\int_{-1}^{1} x^k \\,dx = \\sum_{i=1}^{n} w_i x_i^k, \\quad \\text{for } k=0, 1, \\dots, d\n$$\n\n(i) 当没有预先指定节点时（Gauss-Legendre 积分），有 $2n$ 个自由参数：$n$ 个节点 $x_i$ 和 $n$ 个权重 $w_i$。这 $2n$ 个参数可被选择以满足 $2n$ 个方程。这对应于设 $d+1 = 2n$，意味着可能达到的最高精确度阶为 $d = 2n-1$。这个最大值确实由 Gauss-Legendre 积分达到，其节点是 $n$ 次 Legendre 多项式 $P_n(x)$ 的根。\n\n(ii) 当预先指定一个端点时，例如 $x_n = 1$（Gauss-Radau 积分），就失去了一个自由度。我们有 $n-1$ 个自由节点和 $n$ 个自由权重，总共有 $2n-1$ 个自由参数。这些参数可被选择以满足 $2n-1$ 个矩方程。这对应于 $d+1=2n-1$，得到最高精确度阶为 $d = 2n-2$。这由 Gauss-Radau 法则达到，其未指定的节点是某个 Legendre 多项式特定组合（例如，$P_n(x) - P_{n-1}(x)$）的根。\n\n(iii) 当预先指定两个端点时，例如 $x_1 = -1$ 和 $x_n = 1$（Gauss-Lobatto 积分），就失去了两个自由度。我们有 $n-2$ 个自由节点和 $n$ 个自由权重，共给出 $2n-2$ 个自由参数。这些参数最多能满足 $2n-2$ 个矩方程。这对应于 $d+1=2n-2$，给出最高精确度阶为 $d=2n-3$。这个最大值由 Gauss-Lobatto 积分达到，其内部节点是 $n-1$ 次 Legendre 多项式的一阶导数 $P_{n-1}'(x)$ 的根。\n\n第二，我们分析 $n$ 点 Gauss-Lobatto 法则对被积函数 $q_n(x) = (1-x^2)(P_{n-1}'(x))^2$ 的作用。如前所证，该法则的节点 $\\{x_i\\}_{i=1}^{n}$ 由端点 $x_1 = -1$ 和 $x_n = 1$ 以及 $P_{n-1}'(x)$ 的 $n-2$ 个根组成。让我们在这些节点上计算 $q_n(x)$ 的值：\n- 对于端点 $x = \\pm 1$，因子 $(1-x^2)$ 等于 $1 - (\\pm 1)^2 = 0$。因此，$q_n(1) = 0$ 且 $q_n(-1) = 0$。\n- 对于内部节点 $x_i$ ($i=2, \\dots, n-1$)，根据定义，它们是 $P_{n-1}'(x)$ 的根。因此，$P_{n-1}'(x_i) = 0$，这意味着 $(P_{n-1}'(x_i))^2 = 0$。所以，对于所有内部节点，$q_n(x_i) = 0$。\n\n由于 $q_n(x)$ 在 $n$ 点 Gauss-Lobatto 积分的每个节点 $x_i$ 上都为零，所以积分和为\n$$\n\\sum_{i=1}^{n} w_i q_n(x_i) = \\sum_{i=1}^{n} w_i \\cdot 0 = 0\n$$\n因此，Gauss-Lobatto 法则对 $q_n(x)$ 的积分返回的数值恰好是 $0$。\n\n第三，我们计算积分 $I = \\int_{-1}^{1} q_n(x) \\,dx$ 的精确值。被积函数是 $q_n(x) = (1-x^2)(P_{n-1}'(x))^2$。直接积分并不简单。我们将使用分部积分法，并结合 Legendre 多项式的性质。Legendre 微分方程由下式给出\n$$\n(1-x^2)y'' - 2xy' + k(k+1)y = 0\n$$\n其中 $y=P_k(x)$。对于 $k=n-1$，我们有：\n$$\n(1-x^2)P_{n-1}''(x) - 2xP_{n-1}'(x) + (n-1)n P_{n-1}(x) = 0\n$$\n这可以重排为如下关系：\n$$\n(1-x^2)P_{n-1}''(x) - 2xP_{n-1}'(x) = -n(n-1)P_{n-1}(x)\n$$\n左侧的表达式是 $(1-x^2)P_{n-1}'(x)$ 的导数。\n现在，我们来计算积分 $I = \\int_{-1}^{1} (1-x^2)(P_{n-1}'(x))^2 \\, dx$。我们使用分部积分法，令 $u = (1-x^2)P_{n-1}'(x)$ 和 $dv = P_{n-1}'(x)dx$。那么 $du = \\frac{d}{dx}[(1-x^2)P_{n-1}'(x)]dx$ 且 $v = P_{n-1}(x)$。\n$$\nI = \\left[ (1-x^2)P_{n-1}'(x)P_{n-1}(x) \\right]_{-1}^{1} - \\int_{-1}^{1} P_{n-1}(x) \\frac{d}{dx}\\left[(1-x^2)P_{n-1}'(x)\\right] \\,dx\n$$\n边界项因为因子 $(1-x^2)$ 在 $x=\\pm 1$ 处为零而消失。积分变为：\n$$\nI = - \\int_{-1}^{1} P_{n-1}(x) \\left[ (1-x^2)P_{n-1}''(x) - 2xP_{n-1}'(x) \\right] \\,dx\n$$\n使用从 Legendre 微分方程导出的恒等式，我们代入方括号中的项：\n$$\nI = - \\int_{-1}^{1} P_{n-1}(x) \\left[ -n(n-1)P_{n-1}(x) \\right] \\,dx = n(n-1) \\int_{-1}^{1} [P_{n-1}(x)]^2 \\,dx\n$$\nLegendre 多项式（在标准归一化 $P_k(1)=1$ 下）的正交性质为 $\\int_{-1}^{1} [P_k(x)]^2 \\, dx = \\frac{2}{2k+1}$。对于 $k=n-1$，这给出：\n$$\n\\int_{-1}^{1} [P_{n-1}(x)]^2 \\,dx = \\frac{2}{2(n-1)+1} = \\frac{2}{2n-1}\n$$\n将此结果代回 $I$ 的表达式中，我们得到积分的精确值：\n$$\nI = n(n-1) \\left(\\frac{2}{2n-1}\\right) = \\frac{2n(n-1)}{2n-1}\n$$\n\n第四，我们解释为何 Gauss-Radau 法则对此积分是精确的，而 Gauss-Lobatto 法则不然。\n被积函数是 $q_n(x) = (1-x^2)(P_{n-1}'(x))^2$。多项式 $P_{n-1}(x)$ 的次数是 $n-1$，所以其导数 $P_{n-1}'(x)$ 的次数是 $n-2$。其平方 $(P_{n-1}'(x))^2$ 的次数是 $2(n-2) = 2n-4$。乘以次数为 $2$ 的 $(1-x^2)$，我们发现多项式 $q_n(x)$ 的总次数是 $(2n-4) + 2 = 2n-2$。\n\n- $n$ 点 Gauss-Radau 法则的精确度阶为 $2n-2$。由于被积函数 $q_n(x)$ 的次数恰好是 $2n-2$，Gauss-Radau 法则能够无误差地积分该多项式。\n\n- $n$ 点 Gauss-Lobatto 法则的精确度阶为 $2n-3$。被积函数 $q_n(x)$ 的次数是 $2n-2$，比该法则的精确度阶大一（$2n-2 > 2n-3$）。因此，不保证该法则对 $q_n(x)$ 是精确的。我们已经证明，Gauss-Lobatto 近似得到的结果是 $0$，而精确积分值为 $\\frac{2n(n-1)}{2n-1}$。对于任何整数 $n \\ge 2$，这个精确值是非零的。例如，当 $n=2$ 时，其值为 $\\frac{2(2)(1)}{3} = \\frac{4}{3}$。因此，Gauss-Lobatto 法则可被证明是不精确的。被积函数在所有积分节点上都为零，这一事实是导致结果为零的该特定多项式的特殊性质，但这只是一个结构上的巧合，而非确保精确性的一般条件。Gauss-Lobatto 积分的误差项与被积函数的 $(2n-2)$ 阶导数成正比，对于多项式 $q_n(x)$ 来说，这是一个非零常数，这证实了误差是预料之中且确实发生的。", "answer": "$$\\boxed{\\frac{2n(n-1)}{2n-1}}$$", "id": "2591954"}]}