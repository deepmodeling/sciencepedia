{"hands_on_practices": [{"introduction": "我们从一个基础的二阶椭圆偏微分方程——泊松方程开始。本练习将引导你通过分部积分推导其弱形式，这是区分边界条件类型的核心步骤。通过专注于纯自然（Neumann）边界条件的设定，此练习将揭示一个深刻的结论：解的存在性依赖于一个必须满足的“相容性条件”，这是理解偏微分方程适定性的基石。 [@problem_id:2544240]", "problem": "考虑在有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{2}$ 上的一个标量椭圆边值问题（一个偏微分方程），其外单位法向量为 $\\boldsymbol{n}$：\n$$\n-\\Delta u = f \\quad \\text{in } \\Omega, \n\\qquad \n\\boldsymbol{n}\\cdot \\nabla u = q \\quad \\text{on } \\partial\\Omega.\n$$\n在有限元法（FEM）的框架内，从弱形式的基本原理出发，即分部积分和散度定理，以：\n(a) 在 Sobolev 空间 $H^{1}(\\Omega)$ 上推导其弱形式，并清楚地指明在此设置中哪些边界条件是本质的，哪些是自然的。解释为何给定的 Neumann 条件属于其所属的类别。\n(b) 仅利用弱形式和容许的测试函数，推导数据 $f$ 和 $q$ 满足可解性所需的必要相容性条件。将该条件表示为一个关于 $(f,q)$ 的标量泛函，其值必须为零才能保证可解性。\n(c) 解释此条件与解的存在性和唯一性的关系，并精确说明解在何种意义上是唯一的。\n(d) 现取具体数据\n$$\n\\Omega = \\{(x,y)\\in\\mathbb{R}^{2}:\\; x^{2}+y^{2}<1\\}, \n\\qquad \nf(x,y) = x^{2}+y^{2}-1,\n\\qquad \nq|_{\\partial\\Omega}(\\theta) = \\cos\\theta,\n$$\n其中 $\\theta \\in [0,2\\pi)$ 是以弧度度量的极角，用于参数化 $\\partial\\Omega$。计算 (b) 部分得到的标量相容性泛函的精确封闭形式。你的最终答案必须是一个没有单位、没有额外评注的精确数字。", "solution": "所提出的问题是一个带有纯 Neumann 边界条件的标准 Poisson 方程边值问题。我们将遵循严谨的数学原理，逐步对其进行分析。\n\n首先，我们验证问题陈述。\n**第 1 步：提取的已知条件**\n- 偏微分方程 (PDE)：在有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{2}$ 中，$-\\Delta u = f$。\n- 边界条件 (BC)：在边界 $\\partial\\Omega$ 上，$\\boldsymbol{n}\\cdot \\nabla u = q$，其中 $\\boldsymbol{n}$ 是外单位法向量。\n- 函数空间：解 $u$ 和测试函数在 Sobolev 空间 $H^{1}(\\Omega)$ 中寻找。\n- (a) 部分：推导弱形式，将边界条件分类为本质或自然，并为给定的 Neumann 条件的分类提供理由。\n- (b) 部分：推导数据 $(f,q)$ 的可解性所需的必要相容性条件。\n- (c) 部分：解释该条件与解的存在性和唯一性的关系。\n- (d) 部分：对于 $\\Omega = \\{(x,y)\\in\\mathbb{R}^{2}:\\; x^{2}+y^{2}<1\\}$，$f(x,y) = x^{2}+y^{2}-1$，以及 $q|_{\\partial\\Omega}(\\theta) = \\cos\\theta$ 的具体情况，计算在 (b) 部分推导出的相容性泛函。\n\n**第 2 步：使用提取的已知条件进行验证**\n该问题具有科学依据，（为分析）是良定的（尽管边值问题本身存在可解性问题，而这正是本题的主题），并且是客观的。它是偏微分方程理论及其通过有限元法进行数值求解中的一个典范问题。所有术语都有定义，所提供的数据在数学上是一致的，并且对于所要求的任务是完整的。该问题不违反任何无效性标准。\n\n**结论：** 问题有效。\n\n我们现在开始求解。\n\n**(a) 弱形式及边界条件的分类**\n\n为推导弱形式，我们从 PDE 的强形式 $-\\Delta u = f$ 开始。我们将此方程乘以一个来自适当函数空间（此处指定为 $H^{1}(\\Omega)$）的任意测试函数 $v$，并在域 $\\Omega$ 上积分：\n$$\n\\int_{\\Omega} (-\\Delta u) v \\, d\\boldsymbol{x} = \\int_{\\Omega} f v \\, d\\boldsymbol{x}\n$$\n核心步骤是对左侧进行分部积分。在多维情况下，这通过散度定理实现。具体来说，我们使用 Green 第一恒等式，其表述为：\n$$\n\\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{F}) \\phi \\, d\\boldsymbol{x} = - \\int_{\\Omega} \\boldsymbol{F} \\cdot \\nabla \\phi \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} \\phi (\\boldsymbol{F} \\cdot \\boldsymbol{n}) \\, dS\n$$\n令 $\\phi = v$ 且 $\\boldsymbol{F} = \\nabla u$，我们有 $\\nabla \\cdot \\boldsymbol{F} = \\Delta u$。因此，将此恒等式应用于我们的积分得到：\n$$\n\\int_{\\Omega} (-\\Delta u) v \\, d\\boldsymbol{x} = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\boldsymbol{x} - \\int_{\\partial\\Omega} v (\\nabla u \\cdot \\boldsymbol{n}) \\, dS\n$$\n将此代回我们的积分 PDE 方程，得到变分方程：\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\boldsymbol{x} - \\int_{\\partial\\Omega} v (\\boldsymbol{n} \\cdot \\nabla u) \\, dS = \\int_{\\Omega} f v \\, d\\boldsymbol{x}\n$$\n此时，我们引入边界条件 $\\boldsymbol{n}\\cdot \\nabla u = q$ on $\\partial\\Omega$。此条件被代入边界积分中：\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\boldsymbol{x} - \\int_{\\partial\\Omega} q v \\, dS = \\int_{\\Omega} f v \\, d\\boldsymbol{x}\n$$\n整理各项，我们得到最终的弱形式：求 $u \\in H^{1}(\\Omega)$，使得对于所有 $v \\in H^{1}(\\Omega)$，\n$$\na(u,v) = L(v)\n$$\n其中双线性形式 $a(u,v)$ 和线性泛函 $L(v)$ 定义为：\n$$\na(u,v) = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\boldsymbol{x}\n\\qquad \\text{and} \\qquad\nL(v) = \\int_{\\Omega} f v \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q v \\, dS\n$$\n变分形式中的边界条件分类如下：\n- **本质边界条件**：这些是试验（通常也是测试）空间中的函数必须明确满足的条件。例如，Dirichlet 条件 $u=g$ on $\\partial\\Omega_D \\subset \\partial\\Omega$ 将要求在仿射子空间 $\\{u \\in H^1(\\Omega) : u|_{\\partial\\Omega_D} = g \\}$ 中寻找解。它们是“本质的”，因为它们定义了函数空间本身。\n- **自然边界条件**：这些条件是作为变分方程对所有测试函数均成立的结果而被“弱”满足的。它们自然地产生于分部积分过程，并在弱形式中以边界积分的形式出现。\n\n在此问题中，条件 $\\boldsymbol{n} \\cdot \\nabla u = q$ 是一个**自然边界条件**。这是因为它不是施加于函数空间 $H^1(\\Omega)$ 上的，而是被纳入了线性泛函 $L(v)$ 的定义中。它的满足是弱形式有效性的一个推论。\n\n**(b) 相容性条件的推导**\n\n弱形式必须对所有测试函数 $v \\in H^{1}(\\Omega)$ 成立。对于有界域 $\\Omega$，空间 $H^{1}(\\Omega)$ 的一个特点是它包含常数函数。我们选择一个特定的测试函数 $v = c$，其中 $c$ 是一个非零实常数。对于这样的函数，其梯度恒为零：$\\nabla v = \\nabla c = \\boldsymbol{0}$。\n\n将 $v=c$ 代入弱形式 $a(u,v) = L(v)$：\n左侧变为：\n$$\na(u,c) = \\int_{\\Omega} \\nabla u \\cdot \\nabla c \\, d\\boldsymbol{x} = \\int_{\\Omega} \\nabla u \\cdot \\boldsymbol{0} \\, d\\boldsymbol{x} = 0\n$$\n右侧变为：\n$$\nL(c) = \\int_{\\Omega} f c \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q c \\, dS = c \\left( \\int_{\\Omega} f \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q \\, dS \\right)\n$$\n为使等式 $a(u,c)=L(c)$ 成立，我们必须有：\n$$\n0 = c \\left( \\int_{\\Omega} f \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q \\, dS \\right)\n$$\n由于这对任何非零常数 $c$ 都必须成立，它对数据 $f$ 和 $q$ 施加了一个必要条件：\n$$\n\\int_{\\Omega} f \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q \\, dS = 0\n$$\n这就是解存在的相容性条件。其值必须为零的标量泛函正是这个表达式。从物理角度（例如，稳态热传导）来看，该条件表示全局守恒：域内的总热源必须与通过边界的总热通量相平衡。\n\n**(c) 与存在性和唯一性的关系**\n\n- **存在性**：相容性条件 $\\int_{\\Omega} f \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q \\, dS = 0$ 是弱解存在的必要条件。对此类椭圆问题，可以引用 Fredholm 择一性，它表明此条件也是解 $u \\in H^{1}(\\Omega)$ 存在的充分条件。\n- **唯一性**：解不是唯一的。如果 $u$ 是弱形式的一个解，那么对于任何常数 $C$，函数 $u+C$ 也是一个解。这是因为 $\\nabla(u+C) = \\nabla u$，所以双线性形式 $a(u+C, v) = a(u,v)$ 对所有 $v$ 保持不变。线性泛函 $L(v)$ 仅依赖于数据 $(f,q)$，与 $u$ 无关。因此，如果 $a(u,v) = L(v)$，那么 $a(u+C, v) = L(v)$ 也成立。\n为了形式上证明这一点，假设 $u_1$ 和 $u_2$ 是两个解。它们的差 $w = u_1 - u_2$ 满足 $f=0$ 和 $q=0$ 的齐次问题。$w$ 的弱形式是：\n$$\n\\int_{\\Omega} \\nabla w \\cdot \\nabla v \\, d\\boldsymbol{x} = 0 \\quad \\forall v \\in H^1(\\Omega)\n$$\n通过选择测试函数 $v = w$，我们得到：\n$$\n\\int_{\\Omega} \\nabla w \\cdot \\nabla w \\, d\\boldsymbol{x} = \\int_{\\Omega} |\\nabla w|^2 \\, d\\boldsymbol{x} = 0\n$$\n由于被积函数 $|\\nabla w|^2$ 是非负的，此等式意味着 $\\nabla w = \\boldsymbol{0}$ 在 $\\Omega$ 中几乎处处成立。这意味着 $w$ 必须是一个常数函数，$w=C$。因此，任意两个解相差一个常数：$u_1 = u_2 + C$。解在相差一个加性常数的意义下是唯一的。为了获得完全唯一的解，需要一个额外的约束，例如强制施加 $\\int_{\\Omega} u \\, d\\boldsymbol{x} = 0$。\n\n**(d) 相容性泛函的计算**\n\n我们必须为给定的数据计算泛函 $F(f,q) = \\int_{\\Omega} f \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q \\, dS$ 的值。\n区域是单位圆盘，$\\Omega = \\{(x,y) : x^2+y^2 < 1\\}$。我们使用极坐标 $(r,\\theta)$，其中 $x=r\\cos\\theta$ 和 $y=r\\sin\\theta$。微分面积元为 $d\\boldsymbol{x} = r\\,dr\\,d\\theta$。区域由 $0 \\leq r < 1$ 和 $0 \\leq \\theta < 2\\pi$ 描述。源项是 $f(x,y) = x^2+y^2-1$，在极坐标中变为 $f(r,\\theta) = r^2-1$。\n\n第一个积分是在域 $\\Omega$ 上：\n$$\n\\int_{\\Omega} f \\, d\\boldsymbol{x} = \\int_{0}^{2\\pi} \\int_{0}^{1} (r^2 - 1) r \\, dr \\, d\\theta\n$$\n被积函数与 $\\theta$ 无关，所以我们可以分离积分：\n$$\n= \\left( \\int_{0}^{2\\pi} d\\theta \\right) \\left( \\int_{0}^{1} (r^3 - r) \\, dr \\right)\n$$\n$$\n= (2\\pi) \\left[ \\frac{r^4}{4} - \\frac{r^2}{2} \\right]_{0}^{1}\n$$\n$$\n= 2\\pi \\left( \\left(\\frac{1^4}{4} - \\frac{1^2}{2}\\right) - (0) \\right) = 2\\pi \\left( \\frac{1}{4} - \\frac{2}{4} \\right) = 2\\pi \\left( -\\frac{1}{4} \\right) = -\\frac{\\pi}{2}\n$$\n第二个积分是在边界 $\\partial\\Omega$ 上，即单位圆 $r=1$。微分弧长为 $dS = (1) d\\theta = d\\theta$。边界通量给出为 $q|_{\\partial\\Omega}(\\theta) = \\cos\\theta$。\n$$\n\\int_{\\partial\\Omega} q \\, dS = \\int_{0}^{2\\pi} \\cos\\theta \\, d\\theta\n$$\n$$\n= [\\sin\\theta]_{0}^{2\\pi} = \\sin(2\\pi) - \\sin(0) = 0 - 0 = 0\n$$\n最后，我们通过将两个结果相加来计算相容性泛函的值：\n$$\nF(f,q) = \\int_{\\Omega} f \\, d\\boldsymbol{x} + \\int_{\\partial\\Omega} q \\, dS = -\\frac{\\pi}{2} + 0 = -\\frac{\\pi}{2}\n$$\n计算出的值为 $-\\frac{\\pi}{2}$。由于该值非零，此特定边值问题的解不存在。但问题只要求计算此值。", "answer": "$$\n\\boxed{-\\frac{\\pi}{2}}\n$$", "id": "2544240"}, {"introduction": "在理解了基本理论之后，我们将知识应用于一个经典的工程问题：一维弹性杆的受力分析。实际问题通常包含指定位移（本质边界条件）和施加载荷（自然边界条件）的混合情况。本练习将演示如何在有限元框架下处理这种常见场景，并介绍一项至关重要的工程技能——计算支座处的反力。你将通过实践了解到，反力可以通过弱形式巧妙地求出，它是在数学上与本质约束相关联的拉格朗日乘子。 [@problem_id:2544278]", "problem": "考虑一根长度为 $L$、沿 $x$ 轴分布在区间 $[0,L]$ 上的等截面线性弹性杆，其杨氏模量 $E$ 和横截面积 $A$ 均为常数。轴向位移场为 $u(x)$。一维控制强形式为平衡方程 $- (EA\\,u^{\\prime})^{\\prime} = q(x)$，并需满足边界条件。在有限元法（FEM）中，狄氏（本质）边界条件指定主场量（此处为位移），诺伊曼（自然）边界条件指定面力，而罗宾边界条件则指定主场量与其通量之间的仿射关系。在本问题中，该杆承受：\n- 在 $\\Gamma_{D} = \\{0\\}$ 上的本质边界条件 $u(0) = \\bar{u} = 0$，\n- 在右端 $x = L$ 的 $\\Gamma_{N} = \\{L\\}$ 上施加的恒定自然面力 $\\bar{t}$，\n- 在 $[0,L]$ 上的恒定均布轴向载荷 $q(x) \\equiv q$，\n不存在罗宾边界条件。\n\n从适用于小应变线性弹性理论的虚功原理出发，其弱形式表述为：寻找 $u \\in H^{1}([0,L])$ 且满足 $u(0)=\\bar{u}$，使得对于所有满足 $v(0)=0$ 的 $v \\in H^{1}([0,L])$，下式均成立\n$$\n\\int_{0}^{L} EA\\,u^{\\prime}(x)\\,v^{\\prime}(x)\\,dx \\;=\\; \\int_{0}^{L} q\\,v(x)\\,dx \\;+\\; \\bar{t}\\,v(L)\n$$\n用 $[0,L]$ 上的一个线性有限元离散化该杆，节点位于 $x_{1}=0$ 和 $x_{2}=L$，试探空间和检验空间的节点基函数分别为 $N_{1}(x)$ 和 $N_{2}(x)$。强施加本质边界条件 $u(0)=\\bar{u}=0$。\n\n使用以下材料和载荷数据：\n- $E = 200 \\times 10^{9}\\,\\text{Pa}$，\n- $A = 1.0 \\times 10^{-4}\\,\\text{m}^{2}$，\n- $L = 2.0\\,\\text{m}$，\n- $q = 1.0 \\times 10^{3}\\,\\text{N/m}$，\n- $\\bar{t} = 3.0 \\times 10^{3}\\,\\text{N}$。\n\n任务：\n1. 将 $x=0$ 和 $x=L$ 处的边界条件分类为本质、自然或罗宾边界条件，并简要说明各自指定的物理量。\n2. 组装单单元离散系统，并求解 $x=L$ 处的未知节点位移。\n3. 将离散有限元解代入弱形式，并使用在 $\\Gamma_{D}$上有支集（具体而言，是在 $x=0$ 处不为零的节点基函数 $N_{1}$）的函数进行检验，从而计算本质边界 $\\Gamma_{D}$ 处的反力。将所得标量解释为与 $x=0$ 处本质约束相关的离散拉格朗日乘子。\n\n将最终的反力表示为一个以牛顿（N）为单位的带符号标量。无需四舍五入；提供由给定数据所隐含的精确值。", "solution": "对问题陈述进行验证。\n\n已知条件逐项摘录如下：\n- 域：位于区间 $[0,L]$ 上的长度为 $L$ 的等截面线性弹性杆。\n- 常数：杨氏模量 $E$ 和横截面积 $A$ 为常数。\n- 场变量：轴向位移 $u(x)$。\n- 强形式：$- (EA\\,u^{\\prime})^{\\prime} = q(x)$。\n- 边界条件：\n    - 本质边界条件：在 $\\Gamma_{D} = \\{0\\}$ 上，$u(0) = \\bar{u} = 0$。\n    - 自然面力：在 $x = L$ 处的 $\\Gamma_{N} = \\{L\\}$ 上施加 $\\bar{t}$。\n    - 均布载荷：在 $[0,L]$ 上，$q(x) \\equiv q$。\n- 弱形式：寻找 $u \\in H^{1}([0,L])$ 且满足 $u(0)=\\bar{u}$，使得对于所有满足 $v(0)=0$ 的 $v \\in H^{1}([0,L])$，$\\int_{0}^{L} EA\\,u^{\\prime}(x)\\,v^{\\prime}(x)\\,dx = \\int_{0}^{L} q\\,v(x)\\,dx + \\bar{t}\\,v(L)$ 均成立。\n- 离散化：在 $[0,L]$ 上使用一个线性有限元，节点位于 $x_{1}=0$ 和 $x_{2}=L$。节点基函数为 $N_{1}(x)$ 和 $N_{2}(x)$。强施加本质边界条件。\n- 数据：$E = 200 \\times 10^{9}\\,\\text{Pa}$，$A = 1.0 \\times 10^{-4}\\,\\text{m}^{2}$，$L = 2.0\\,\\text{m}$，$q = 1.0 \\times 10^{3}\\,\\text{N/m}$，$\\bar{t} = 3.0 \\times 10^{3}\\,\\text{N}$。\n- 任务：1. 分类边界条件。2. 求解 $x=L$ 处的节点位移。3. 计算本质边界处的反力。\n\n验证结论：问题有效。这是一个标准的、适定的线性弹性静力学问题，在有限元法框架内得到了正确的表述。控制方程、弱形式和所提供的数据在物理上和数学上都是一致的。所有必要信息均已提供。\n\n求解过程通过完成三个指定任务来进行。\n\n任务1：边界条件的分类\n$x=0$ 处的边界条件为 $u(0) = \\bar{u} = 0$。该条件直接指定了主场变量（位移 $u$）的值。根据定义，这是一个**本质**边界条件。在物理上，它代表一个固定支座，防止该点发生任何位移。\n$x=L$ 处的边界条件指定了一个面力 $\\bar{t}$。在弱形式的背景下，项 $\\bar{t}v(L)$ 源于对强形式进行分部积分，所产生的边界项为 $[(EA u')v]_0^L$。因此，自然边界条件为 $EA u'(L) = \\bar{t}$。量 $EA u'$ 代表杆内的轴向内力。因此，该条件指定了边界上的力。根据定义，这是一个**自然**边界条件。\n\n任务2：离散系统的组装和求解\n区域 $[0,L]$ 使用一个线性有限元进行离散化，节点位于 $x_1=0$ 和 $x_2=L$。位移场 $u(x)$ 近似为 $u^h(x) = d_1 N_1(x) + d_2 N_2(x)$，其中 $d_1$ 和 $d_2$ 分别是 $x_1$ 和 $x_2$ 处的节点位移。\n区间 $[0,L]$ 上的线性基函数为：\n$$\nN_{1}(x) = 1 - \\frac{x}{L} \\quad \\text{和} \\quad N_{2}(x) = \\frac{x}{L}\n$$\n它们的导数是常数：\n$$\nN_{1}^{\\prime}(x) = -\\frac{1}{L} \\quad \\text{和} \\quad N_{2}^{\\prime}(x) = \\frac{1}{L}\n$$\n离散方程组为 $\\mathbf{K}\\mathbf{d} = \\mathbf{f}$，其中 $\\mathbf{K}$ 是刚度矩阵，$\\mathbf{f}$ 是力向量。\n\n刚度矩阵的分量 $K_{ij} = \\int_{0}^{L} E A N_{i}^{\\prime}(x) N_{j}^{\\prime}(x) dx$ 为：\n$K_{11} = \\int_{0}^{L} E A (-\\frac{1}{L})(-\\frac{1}{L}) dx = \\frac{EA}{L}$\n$K_{12} = \\int_{0}^{L} E A (-\\frac{1}{L})(\\frac{1}{L}) dx = -\\frac{EA}{L}$\n$K_{21} = K_{12} = -\\frac{EA}{L}$\n$K_{22} = \\int_{0}^{L} E A (\\frac{1}{L})(\\frac{1}{L}) dx = \\frac{EA}{L}$\n因此，刚度矩阵为：\n$$\n\\mathbf{K} = \\frac{EA}{L} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n力向量的分量 $f_i = \\int_{0}^{L} q N_{i}(x) dx + \\bar{t} N_i(L)$ 为：\n$f_1 = \\int_{0}^{L} q (1-\\frac{x}{L}) dx + \\bar{t} N_1(L) = q \\left[x - \\frac{x^2}{2L}\\right]_{0}^{L} + \\bar{t}(0) = \\frac{qL}{2}$\n$f_2 = \\int_{0}^{L} q (\\frac{x}{L}) dx + \\bar{t} N_2(L) = q \\left[\\frac{x^2}{2L}\\right]_{0}^{L} + \\bar{t}(1) = \\frac{qL}{2} + \\bar{t}$\n因此，力向量为：\n$$\n\\mathbf{f} = \\begin{pmatrix} \\frac{qL}{2} \\\\ \\frac{qL}{2} + \\bar{t} \\end{pmatrix}\n$$\n完整的离散系统为：\n$$\n\\frac{EA}{L} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{qL}{2} \\\\ \\frac{qL}{2} + \\bar{t} \\end{pmatrix}\n$$\n强施加本质边界条件 $u(0)=0$，即设定节点位移 $d_1 = 0$。未知位移 $d_2$ 可从系统的第二个方程求得：\n$$\n\\frac{EA}{L} (-d_1 + d_2) = \\frac{qL}{2} + \\bar{t}\n$$\n代入 $d_1=0$：\n$$\n\\frac{EA}{L} d_2 = \\frac{qL}{2} + \\bar{t}\n$$\n求解 $d_2$：\n$$\nd_2 = \\frac{L}{EA} \\left( \\frac{qL}{2} + \\bar{t} \\right)\n$$\n使用所给数据：$E = 200 \\times 10^{9}\\,\\text{Pa}$，$A = 1.0 \\times 10^{-4}\\,\\text{m}^{2}$，$L = 2.0\\,\\text{m}$，$q = 1.0 \\times 10^{3}\\,\\text{N/m}$，$\\bar{t} = 3.0 \\times 10^{3}\\,\\text{N}$。\n轴向刚度为 $EA = (200 \\times 10^{9}) \\times (1.0 \\times 10^{-4}) = 2.0 \\times 10^{7}\\,\\text{N}$。\n均布载荷在节点2上的合力分量为 $\\frac{qL}{2} = \\frac{(1.0 \\times 10^{3})(2.0)}{2} = 1.0 \\times 10^{3}\\,\\text{N}$。\n$x=L$ 处的位移为：\n$$\nd_2 = \\frac{2.0}{2.0 \\times 10^{7}} \\left( 1.0 \\times 10^{3} + 3.0 \\times 10^{3} \\right) = 1.0 \\times 10^{-7} (4.0 \\times 10^{3}) = 4.0 \\times 10^{-4}\\,\\text{m}\n$$\n\n任务3：反力的计算\n本质边界 $x=0$ 处的反力 $R$ 是通过将有限元解 $u^h(x)$ 代入弱形式，并使用一个在 $x=0$ 处不为零的检验函数 $v(x)$ 来计算的。问题指定使用基函数 $v(x) = N_1(x)$。\n包含 $x=0$ 处反力 $R$ 所做功的完整虚功表达式为：\n$$\n\\int_{0}^{L} EA\\,u^{\\prime}(x)\\,v^{\\prime}(x)\\,dx = \\int_{0}^{L} q\\,v(x)\\,dx + \\bar{t}\\,v(L) + R\\,v(0)\n$$\n我们将 $u(x) = u^h(x) = d_2 N_2(x)$ (因为 $d_1=0$) 和 $v(x) = N_1(x)$ 代入此方程。对于此检验函数，$v(0)=N_1(0)=1$ 且 $v(L)=N_1(L)=0$。方程变为：\n$$\n\\int_{0}^{L} EA\\, (d_2 N_2'(x)) \\, N_1'(x)\\, dx = \\int_{0}^{L} q\\, N_1(x)\\, dx + \\bar{t}\\,(0) + R\\,(1)\n$$\n简化为：\n$$\nd_2 \\int_{0}^{L} EA\\, N_2'(x) N_1'(x)\\, dx = \\int_{0}^{L} q\\, N_1(x)\\, dx + R\n$$\n这些项可以从组装的系统中识别出来：\n左边的积分为 $d_2 K_{12} = d_2 (-\\frac{EA}{L})$。\n右边的积分为力向量的第一个分量 $f_1 = \\frac{qL}{2}$。\n所以我们有：\n$$\n-d_2 \\frac{EA}{L} = \\frac{qL}{2} + R\n$$\n求解反力 $R$：\n$$\nR = -d_2 \\frac{EA}{L} - \\frac{qL}{2}\n$$\n代入 $d_2 = \\frac{L}{EA}(\\frac{qL}{2} + \\bar{t})$ 的表达式：\n$$\nR = -\\left(\\frac{L}{EA} \\left( \\frac{qL}{2} + \\bar{t} \\right)\\right) \\frac{EA}{L} - \\frac{qL}{2} = - \\left( \\frac{qL}{2} + \\bar{t} \\right) - \\frac{qL}{2} = -qL - \\bar{t}\n$$\n此结果与静力平衡一致：反力必须平衡总外施力，即均布载荷的积分 $qL$ 和点载荷 $\\bar{t}$ 之和。\n现在，我们计算其数值：\n$$\nqL = (1.0 \\times 10^{3}\\,\\text{N/m}) \\times (2.0\\,\\text{m}) = 2.0 \\times 10^{3}\\,\\text{N}\n$$\n$$\n\\bar{t} = 3.0 \\times 10^{3}\\,\\text{N}\n$$\n反力为：\n$$\nR = -(2.0 \\times 10^{3}\\,\\text{N}) - (3.0 \\times 10^{3}\\,\\text{N}) = -5.0 \\times 10^{3}\\,\\text{N}\n$$\n负号表示支座施加在杆上的反力作用方向为 $x$ 轴负方向，这在物理上是正确的，因为它与所施加的载荷方向相反。", "answer": "$$\n\\boxed{-5.0 \\times 10^{3}}\n$$", "id": "2544278"}, {"introduction": "最后，我们挑战一个更高阶的系统——四阶欧拉-伯努利梁方程。本练习旨在揭示一个核心观点：边界条件的“本质”或“自然”分类并非绝对，而是取决于控制方程的阶数。对于四阶问题，你需要进行两次分部积分，这将导出一组更丰富的边界项，涉及转角、弯矩和剪力等物理量。通过这个推导，你将深入理解数学形式与系统物理行为之间的内在联系，并掌握如何为高阶问题正确地分类边界条件。 [@problem_id:2544282]", "problem": "考虑区间 $(0,L)$ 上的 Euler–Bernoulli 梁模型，其抗弯刚度 $EI>0$，横向挠度 $u:(0,L)\\to\\mathbb{R}$ 由强形式控制\n$$\nEI\\,u^{(4)}(x)=f(x)\\quad\\text{for }x\\in(0,L),\n$$\n其中 $f\\in L^{2}(0,L)$。令 $H^{2}(0,L)$ 表示其二阶弱导数是平方可积的函数的 Sobolev 空间。在检验函数 $v$ 与试探函数 $u$ 取自同一能量空间的设定下进行研究，这与弯曲能的矫顽性是一致的。\n\n1) 从强形式出发，仅使用分部积分法和 Sobolev 空间 $H^{2}(0,L)$ 的定义，推导一个弱形式，其双线性部分在 $H^{2}(0,L)$ 上是良定的和矫顽的。明确写出将 $v$ 和 $v'$ 的迹与 $u$ 的边界泛函配对的边界项。\n\n2) 使用第 1) 部分得到的弱形式，在单个边界点（例如 $x=0$）对下列力学边界集进行分类，将其分为有限元意义下的本质（Dirichlet 型）和自然（Neumann 型）边界条件：\n- 固支端：给定的挠度和转角，即 $u(0)=0$ 和 $u'(0)=0$。\n- 简支端：给定的挠度和零弯矩，即 $u(0)=0$ 和 $EI\\,u''(0)=0$（在弱意义下解释）。\n\n您的分类必须仅基于哪些条件是施加在试探空间（并因此也施加在检验空间）上的，而哪些条件是作为弱形式中的边界项出现的。\n\n将您的最终结果表示为行矩阵\n$$\n\\begin{pmatrix}\ne_{\\mathrm{clamped}} & n_{\\mathrm{clamped}} & e_{\\mathrm{supported}} & n_{\\mathrm{supported}}\n\\end{pmatrix},\n$$\n其中 $e_{\\mathrm{(\\cdot)}}$ 是边界上本质条件的数量，$n_{\\mathrm{(\\cdot)}}$ 是边界上自然条件的数量。无需四舍五入。答案必须为精确值，不带单位。", "solution": "所提出的问题具有科学依据、是适定、客观且完整的。它代表了边值问题变分形式化的一个标准练习，特别是在应用于弹性力学的有限元方法的背景下。该问题有效，我将继续进行求解。\n\n分析始于区域 $\\Omega = (0, L)$ 上的 Euler-Bernoulli 梁方程的强形式：\n$$\nEI\\,u^{(4)}(x) = f(x)\n$$\n其中 $u$ 是横向挠度，$EI$ 是常数抗弯刚度，$f$ 是分布式横向载荷。试探函数 $u$ 和检验函数 $v$ 都从 Sobolev 空间 $H^{2}(0,L)$ 中选取。\n\n为推导弱形式，我们将强形式乘以一个任意检验函数 $v \\in H^{2}(0,L)$ 并在区域 $\\Omega$ 上积分：\n$$\n\\int_{0}^{L} EI\\,u^{(4)}(x) v(x) \\,dx = \\int_{0}^{L} f(x) v(x) \\,dx\n$$\n主要任务是通过对左侧项应用分部积分法来降低试探函数 $u$ 的微分阶数。我们的目标是获得一个对称的双线性形式，其中 $u$ 和 $v$ 以相同的微分阶数出现。由于函数属于 $H^{2}(0,L)$，保证平方可积的最高阶导数是二阶导数。因此，我们进行两次分部积分。\n\n首先，我们对 $\\int_{0}^{L} EI\\,u^{(4)}(x) v(x) \\,dx$ 应用分部积分法：\n$$\n\\int_{0}^{L} EI\\,u^{(4)}(x) v(x) \\,dx = \\left[ EI\\,u^{(3)}(x) v(x) \\right]_{0}^{L} - \\int_{0}^{L} EI\\,u^{(3)}(x) v'(x) \\,dx\n$$\n这里，$u^{(3)}$ 与剪力 $V$ 相关，$u^{(4)}$ 是分布载荷。边界项涉及剪力与检验函数在边界处值的乘积。\n\n接下来，我们对余下的积分项 $-\\int_{0}^{L} EI\\,u^{(3)}(x) v'(x) \\,dx$ 应用分部积分法：\n$$\n- \\int_{0}^{L} EI\\,u^{(3)}(x) v'(x) \\,dx = - \\left[ EI\\,u''(x) v'(x) \\right]_{0}^{L} + \\int_{0}^{L} EI\\,u''(x) v''(x) \\,dx\n$$\n这里，$u''$ 与弯矩 $M = EIu''$ 相关。新的边界项涉及弯矩与检验函数在边界处导数的乘积。\n\n结合这些结果，原始的左侧项变为：\n$$\n\\int_{0}^{L} EI\\,u^{(4)}(x) v(x) \\,dx = \\int_{0}^{L} EI\\,u''(x) v''(x) \\,dx + \\left[ EI\\,u^{(3)}(x) v(x) - EI\\,u''(x) v'(x) \\right]_{0}^{L}\n$$\n将此代回积分方程，得到完整的弱形式陈述：\n$$\n\\int_{0}^{L} EI\\,u''(x) v''(x) \\,dx + \\left[ EI\\,u^{(3)}(x) v(x) - EI\\,u''(x) v'(x) \\right]_{x=L} - \\left[ EI\\,u^{(3)}(x) v(x) - EI\\,u''(x) v'(x) \\right]_{x=0} = \\int_{0}^{L} f(x) v(x) \\,dx\n$$\n标准的弱形式写作 $a(u,v) = l(v)$，其中 $a(u,v)$ 是一个双线性形式，$l(v)$ 是一个线性泛函。从上述方程可知，双线性形式为：\n$$\na(u,v) = \\int_{0}^{L} EI\\,u''(x) v''(x) \\,dx\n$$\n该形式在 $H^{2}(0,L)$（或其合适的子空间）上是良定和矫顽的。边界项为 $[EIu^{(3)}v - EIu''v']_{0}^{L}$。这些项对于分类边界条件至关重要。\n\n如果一个边界条件是对解空间本身的约束，那么它被分类为**本质**（或 Dirichlet 型）条件，这意味着它必须显式地施加在试探函数 $u$ 上。在检验空间和试探空间相同的 Galerkin 方法中，该条件的齐次形式也必须对检验函数 $v$ 成立。对于 Euler-Bernoulli 梁，这些是关于挠度 $u$ 和转角 $u'$ 的条件。\n\n如果一个边界条件是从变分形式中产生的，那么它被分类为**自然**（或 Neumann 型）条件。具体来说，如果检验函数的迹（$v$ 或 $v'$）在边界上不被约束为零，那么为了让弱形式对所有这类检验函数都成立，边界项中相应的系数必须为零。对于梁，这些条件涉及弯矩 $M = EIu''$ 和剪力 $V = EIu'''$。\n\n让我们分析在单点 $x=0$ 处的边界条件。在 $x=0$ 处对弱形式的边界贡献是 $EIu''(0)v'(0) - EIu^{(3)}(0)v(0)$。\n\n1) **$x=0$ 处的固支端**：条件是 $u(0)=0$ 和 $u'(0)=0$。\n- 这些条件是对挠度 $u$ 及其一阶导数 $u'$ 的约束。它们直接施加在试探解 $u$ 的函数空间上。\n- 因此，检验函数 $v$ 也必须满足齐次条件 $v(0)=0$ 和 $v'(0)=0$。\n- 当这些约束应用于检验函数 $v$ 时，在 $x=0$ 处的边界项 $EIu''(0)v'(0) - EIu^{(3)}(0)v(0)$ 会自动消失，因为 $v(0)$ 和 $v'(0)$ 均为零。\n- 这两个条件都施加在函数空间上，因此是**本质**的。\n- 本质条件的数量，$e_{\\mathrm{clamped}} = 2$。\n- 自然条件的数量，$n_{\\mathrm{clamped}} = 0$。\n\n2) **$x=0$ 处的简支端**：条件是 $u(0)=0$ 和 $EIu''(0)=0$。\n- 条件 $u(0)=0$ 是对挠度的约束。它施加在试探空间上，所以 $u(0)=0$。相应的检验函数也必须满足 $v(0)=0$。这是一个**本质**边界条件。\n- 因为 $v(0)=0$，所以边界项中涉及 $v(0)$ 的部分，即 $-EIu^{(3)}(0)v(0)$，消失了。\n- 在 $x=0$ 处边界项的剩余部分是 $EIu''(0)v'(0)$。检验函数 $v$ 在 $x=0$ 处的导数不受约束，这意味着 $v'(0)$ 可以取任意值。\n- 为了使弱形式对所有容许的检验函数 $v$ 都有效，非零 $v'(0)$ 的系数必须为零。这意味着解 $u$ 必须满足 $EIu''(0)=0$。\n- 这个条件 $EIu''(0)=0$ 并非施加在试探空间上，而是弱形式的一个推论。因此，它是一个**自然**边界条件。\n- 本质条件的数量，$e_{\\mathrm{supported}} = 1$。\n- 自然条件的数量，$n_{\\mathrm{supported}} = 1$。\n\n将这些结果组合成所需的矩阵格式 $\\begin{pmatrix} e_{\\mathrm{clamped}} & n_{\\mathrm{clamped}} & e_{\\mathrm{supported}} & n_{\\mathrm{supported}} \\end{pmatrix}$:\n$$\n\\begin{pmatrix} 2 & 0 & 1 & 1 \\end{pmatrix}\n$$\n这完成了基于第一性原理推导的分类。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2 & 0 & 1 & 1\n\\end{pmatrix}\n}\n$$", "id": "2544282"}]}