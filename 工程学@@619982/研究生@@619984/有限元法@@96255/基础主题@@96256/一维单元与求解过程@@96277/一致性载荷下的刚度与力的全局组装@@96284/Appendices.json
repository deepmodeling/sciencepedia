{"hands_on_practices": [{"introduction": "本练习将引导你完成有限元分析的核心流程。我们将从一个简单的一维杆件问题出发，基于虚功原理，亲手推导单元刚度矩阵 $\\mathbf{k}^{(e)}$ 和一致节点荷载向量 $\\mathbf{f}^{(e)}$。这个过程是掌握如何将连续介质力学问题离散化为代数方程组的关键，为解决更复杂的问题打下坚实的数学和物理基础 [@problem_id:2562929]。", "problem": "一根沿 $x$ 轴放置的直杆，占据区间 $x \\in [0, L]$，其中 $L = 2\\,\\mathrm{m}$。该杆具有恒定的横截面积 $A = 1.0 \\times 10^{-4}\\,\\mathrm{m}^{2}$ 和杨氏模量 $E = 200\\,\\mathrm{GPa}$。该杆受到一个沿 $x$ 轴正方向作用的均布轴向荷载（单位长度上的体力）$q(x) = q_{0}$，其中 $q_{0} = 1000\\,\\mathrm{N/m}$，并在 $x=L$ 处施加一个沿 $x$ 轴正方向的额外端部牵引力 $t_{L} = 500\\,\\mathrm{N}$。左端的位移是固定的，$u(0) = 0$。\n\n仅以虚功原理和小应变线弹性理论为出发点，使用有限元法（FEM）将该杆离散为两个等长的两节点线性单元。对于每个单元：\n- 推导单元刚度矩阵和由均布荷载 $q_{0}$ 引起的一致单元荷载向量，\n- 组装全局刚度矩阵和全局力向量（包括端部牵引力的贡献），\n- 施加本质边界条件并求解节点位移。\n\n最后，计算右端 $u(L)$ 的位移。将您的答案四舍五入到四位有效数字，并以 $\\mathrm{mm}$ 为单位表示。您的最终答案必须是一个实数。", "solution": "对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 区域：沿 $x$ 轴的直杆，$x \\in [0, L]$。\n- 长度：$L = 2\\,\\mathrm{m}$。\n- 横截面积：$A = 1.0 \\times 10^{-4}\\,\\mathrm{m}^{2}$。\n- 杨氏模量：$E = 200\\,\\mathrm{GPa} = 200 \\times 10^{9}\\,\\mathrm{N/m^2}$。\n- 均布轴向荷载：$q(x) = q_{0} = 1000\\,\\mathrm{N/m}$。\n- 端部牵引力：$t_{L} = 500\\,\\mathrm{N}$ 于 $x=L$。\n- 边界条件：$u(0) = 0$。\n- 离散化：两个等长的两节点线性单元。\n- 要求方法：虚功原理。\n- 要求输出：单元刚度矩阵、一致单元荷载向量、全局组装系统、节点位移，以及 $u(L)$ 的最终值（以 $\\mathrm{mm}$ 为单位，四舍五入到四位有效数字）。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题是一维线弹性和有限元法的标准应用，基于公认的虚功原理。所有物理量和材料属性都是标准的。该问题在科学上是合理的。\n- **适定性：** 该问题是一个二阶常微分方程的适定边值问题。本质边界条件（$u(0)=0$）和自然边界条件（荷载）的组合确保了唯一解的存在。\n- **客观性：** 问题陈述使用了精确、量化且无歧义的语言。\n- **完整性和一致性：** 提供了求解唯一解所需的所有必要参数（$L, A, E, q_{0}, t_{L}$）和边界条件。数据是自洽的，量纲正确。不存在矛盾。\n\n**步骤 3：结论与行动**\n该问题是有效的，因为它具有科学依据、适定、客观和完整。将提供解答。\n\n一维弹性杆的虚功原理如下：\n$$\n\\int_{0}^{L} \\delta\\epsilon(x) \\sigma(x) A \\, dx = \\int_{0}^{L} \\delta u(x) q(x) \\, dx + \\sum_{i} \\delta u(x_i) F_i\n$$\n其中 $\\delta u$ 是虚位移，$\\delta\\epsilon = \\frac{d(\\delta u)}{dx}$ 是虚应变，$\\sigma$ 是应力。这里的点力 $F_i$ 包括在 $x=L$ 处的端部牵引力 $t_L$。使用线弹性本构关系 $\\sigma(x) = E \\epsilon(x) = E \\frac{du}{dx}$，弱形式为：\n$$\n\\int_{0}^{L} E A \\frac{d(\\delta u)}{dx} \\frac{du}{dx} \\, dx = \\int_{0}^{L} \\delta u(x) q_0 \\, dx + \\delta u(L) t_{L}\n$$\n杆被离散为两个等长单元。每个单元的长度为 $l_e = L/2 = 2/2 = 1\\,\\mathrm{m}$。共有三个节点：节点 $1$ 位于 $x=0$，节点 $2$ 位于 $x=1$，节点 $3$ 位于 $x=2$。\n\n对于一个从局部坐标 $\\xi=0$ 到 $\\xi=l_e$ 的通用两节点线性单元，位移场 $u^{(e)}(\\xi)$ 由节点位移 $\\mathbf{d}^{(e)} = [u_i, u_j]^T$ 插值得到：\n$$\nu^{(e)}(\\xi) = N_1(\\xi) u_i + N_2(\\xi) u_j = \\mathbf{N}(\\xi) \\mathbf{d}^{(e)}\n$$\n线性形函数为 $N_1(\\xi) = 1 - \\frac{\\xi}{l_e}$ 和 $N_2(\\xi) = \\frac{\\xi}{l_e}$。\n应变为 $\\epsilon^{(e)}(\\xi) = \\frac{du^{(e)}}{d\\xi} = [-\\frac{1}{l_e}, \\frac{1}{l_e}] \\mathbf{d}^{(e)} = \\mathbf{B} \\mathbf{d}^{(e)}$。\n\n单元刚度矩阵 $\\mathbf{k}^{(e)}$ 由内虚功推导得出：\n$$\n\\mathbf{k}^{(e)} = \\int_{0}^{l_e} \\mathbf{B}^T (EA) \\mathbf{B} \\, d\\xi\n$$\n由于 $\\mathbf{B}$、$E$ 和 $A$ 在单元上是常数：\n$$\n\\mathbf{k}^{(e)} = EA l_e \\mathbf{B}^T \\mathbf{B} = E A l_e \\begin{bmatrix} -1/l_e \\\\ 1/l_e \\end{bmatrix} [ -1/l_e, 1/l_e ] = \\frac{EA}{l_e} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}\n$$\n由均布荷载 $q_0$ 引起的一致单元荷载向量 $\\mathbf{f}_q^{(e)}$ 由外虚功推导得出：\n$$\n\\mathbf{f}_q^{(e)} = \\int_{0}^{l_e} \\mathbf{N}^T q_0 \\, d\\xi = q_0 \\int_{0}^{l_e} \\begin{bmatrix} 1 - \\xi/l_e \\\\ \\xi/l_e \\end{bmatrix} d\\xi = q_0 \\begin{bmatrix} l_e/2 \\\\ l_e/2 \\end{bmatrix} = \\frac{q_0 l_e}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n$$\n对于本问题，$E = 200 \\times 10^9\\,\\mathrm{N/m^2}$，$A = 1.0 \\times 10^{-4}\\,\\mathrm{m^2}$，$l_e=1\\,\\mathrm{m}$，以及 $q_0 = 1000\\,\\mathrm{N/m}$。\n轴向刚度为 $EA = (200 \\times 10^9) \\times (1.0 \\times 10^{-4}) = 2 \\times 10^7\\,\\mathrm{N}$。\n对于两个单元（$e=1, 2$），刚度矩阵为：\n$$\n\\mathbf{k}^{(1)} = \\mathbf{k}^{(2)} = \\frac{2 \\times 10^7}{1} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix} = 2 \\times 10^7 \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix} \\,\\mathrm{N/m}\n$$\n每个单元的一致荷载向量为：\n$$\n\\mathbf{f}_q^{(1)} = \\mathbf{f}_q^{(2)} = \\frac{1000 \\times 1}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 500 \\\\ 500 \\end{bmatrix} \\,\\mathrm{N}\n$$\n现在，我们组装 $3 \\times 3$ 的全局刚度矩阵 $\\mathbf{K}$ 和 $3 \\times 1$ 的全局力向量 $\\mathbf{F}$。\n单元 $1$ 连接节点 $1$ 和 $2$。单元 $2$ 连接节点 $2$ 和 $3$。\n$$\n\\mathbf{K} = \\frac{EA}{l_e} \\begin{bmatrix} 1 & -1 & 0 \\\\ -1 & 1+1 & -1 \\\\ 0 & -1 & 1 \\end{bmatrix} = 2 \\times 10^7 \\begin{bmatrix} 1 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 1 \\end{bmatrix} \\,\\mathrm{N/m}\n$$\n全局力向量 $\\mathbf{F}$ 是来自均布荷载 $\\mathbf{F}_q$ 和点荷载 $\\mathbf{F}_t$ 的贡献之和。\n$$\n\\mathbf{F}_q = \\begin{bmatrix} (\\mathbf{f}_q^{(1)})_1 \\\\ (\\mathbf{f}_q^{(1)})_2 + (\\mathbf{f}_q^{(2)})_1 \\\\ (\\mathbf{f}_q^{(2)})_2 \\end{bmatrix} = \\begin{bmatrix} 500 \\\\ 500+500 \\\\ 500 \\end{bmatrix} = \\begin{bmatrix} 500 \\\\ 1000 \\\\ 500 \\end{bmatrix} \\,\\mathrm{N}\n$$\n端部牵引力 $t_L = 500\\,\\mathrm{N}$ 是作用在节点 $3$ 上的点荷载。\n$$\n\\mathbf{F}_t = \\begin{bmatrix} 0 \\\\ 0 \\\\ 500 \\end{bmatrix} \\,\\mathrm{N}\n$$\n总的全局力向量是：\n$$\n\\mathbf{F} = \\mathbf{F}_q + \\mathbf{F}_t = \\begin{bmatrix} 500 \\\\ 1000 \\\\ 500 \\end{bmatrix} + \\begin{bmatrix} 0 \\\\ 0 \\\\ 500 \\end{bmatrix} = \\begin{bmatrix} 500 \\\\ 1000 \\\\ 1000 \\end{bmatrix} \\,\\mathrm{N}\n$$\n全局方程组为 $\\mathbf{K}\\mathbf{U} = \\mathbf{F}$，其中 $\\mathbf{U}=[U_1, U_2, U_3]^T$：\n$$\n2 \\times 10^7 \\begin{bmatrix} 1 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 1 \\end{bmatrix} \\begin{bmatrix} U_1 \\\\ U_2 \\\\ U_3 \\end{bmatrix} = \\begin{bmatrix} 500 \\\\ 1000 \\\\ 1000 \\end{bmatrix}\n$$\n我们施加本质边界条件 $u(0)=0$，这意味着 $U_1=0$。我们通过移除对应于固定自由度的第一行和第一列来对矩阵进行划分。求解未知位移 $U_2$ 和 $U_3$ 的方程组变为：\n$$\n2 \\times 10^7 \\begin{bmatrix} 2 & -1 \\\\ -1 & 1 \\end{bmatrix} \\begin{bmatrix} U_2 \\\\ U_3 \\end{bmatrix} = \\begin{bmatrix} 1000 \\\\ 1000 \\end{bmatrix}\n$$\n这等价于以下方程组：\n$$\n\\begin{cases}\n2U_2 - U_3 = \\frac{1000}{2 \\times 10^7} = 0.5 \\times 10^{-4} \\\\\n-U_2 + U_3 = \\frac{1000}{2 \\times 10^7} = 0.5 \\times 10^{-4}\n\\end{cases}\n$$\n将两个方程相加得到：\n$$\n(2U_2 - U_3) + (-U_2 + U_3) = 0.5 \\times 10^{-4} + 0.5 \\times 10^{-4}\n$$\n$$\nU_2 = 1.0 \\times 10^{-4}\\,\\mathrm{m}\n$$\n将 $U_2$ 代入第二个方程：\n$$\n-(1.0 \\times 10^{-4}) + U_3 = 0.5 \\times 10^{-4}\n$$\n$$\nU_3 = (1.0 \\times 10^{-4}) + (0.5 \\times 10^{-4}) = 1.5 \\times 10^{-4}\\,\\mathrm{m}\n$$\n右端的位移为 $u(L) = U_3$。\n$$\nu(L) = 1.5 \\times 10^{-4}\\,\\mathrm{m}\n$$\n转换为毫米：\n$$\nu(L) = 1.5 \\times 10^{-4} \\times 1000\\,\\mathrm{mm} = 0.15\\,\\mathrm{mm}\n$$\n按要求四舍五入到四位有效数字：\n$$\nu(L) = 0.1500\\,\\mathrm{mm}\n$$", "answer": "$$\n\\boxed{0.1500}\n$$", "id": "2562929"}, {"introduction": "在掌握了基本流程后，本练习将引入更贴近实际的复杂性，例如非均匀截面和线性变化的体力。此练习的精髓在于，它不仅要求你更细致地处理单元积分，还要求你计算约束节点上的反力并用其验证整个结构的全局静力平衡。这一步骤将离散的数值解与基本力学原理紧密联系起来，是验证计算正确性的重要方法 [@problem_id:2538126]。", "problem": "考虑一根沿 $x$ 轴放置的直细杆，占据 $x \\in [0,L]$ 区间，处于小应变、线弹性、准静态的一维轴向变形状态。该杆的杨氏模量 $E$ 沿其长度为常数，截面积 $A(x)$ 为分段常数。杆身承受单位体积轴向体力 $b(x)$，其自由端承受一个指定的轴向点力。左端 $x=0$ 处为固定端（本质狄利克雷边界条件），右端 $x=L$ 处为牵引加载端（诺伊曼边界条件）。采用符号约定：$+x$ 方向的力为正，位移 $u(x)$ 沿 $+x$ 方向测量。\n\n将该杆离散为两个等长的两节点线性杆单元（一维线性有限元），并从虚功原理和线性形函数的定义出发，使用有限元法 (FEM) 组集全局系统。请勿调用任何预先包装的“快捷”公式；相反，应通过计算必要的积分来推导单元刚度矩阵和一致单元载荷向量。\n\n杆的数据如下：\n- 长度：$L = 2\\,\\mathrm{m}$，节点位于 $x_1 = 0\\,\\mathrm{m}$、$x_2 = 1\\,\\mathrm{m}$ 和 $x_3 = 2\\,\\mathrm{m}$。\n- 杨氏模量：$E = 2.10 \\times 10^{11}\\,\\mathrm{Pa}$。\n- 截面积：对于 $x \\in [0,1]$，$A(x) = 2.0 \\times 10^{-4}\\,\\mathrm{m}^2$；对于 $x \\in [1,2]$，$A(x) = 1.2 \\times 10^{-4}\\,\\mathrm{m}^2$。\n- 单位体积体力：$b(x) = b_0 + b_1 x$，其中 $b_0 = 2.0 \\times 10^{7}\\,\\mathrm{N/m}^3$，$b_1 = 1.0 \\times 10^{7}\\,\\mathrm{N/m}^4$。\n- 施加在 $x=L$ 处的轴向点力：$\\bar{T} = 1.50 \\times 10^{4}\\,\\mathrm{N}$，方向为 $+x$ 方向。\n- 本质边界条件：$u(0) = 0$。\n\n任务：\n1. 从一维轴向变形的虚功原理出发，为一个长度为 $\\ell$、单元内 $E$ 和 $A$ 为常数、体力 $b(x)$ 如上所述且限制在单元域内的通用两节点线性杆单元，推导其单元刚度矩阵和由体力引起的一致单元载荷向量。\n2. 为所描述的双单元网格组集全局刚度矩阵和全局载荷向量，包括右端 $x=L$ 处点力的贡献。\n3. 在 $x=0$ 处施加本质边界条件，以求解未知的节点位移。\n4. 使用组集好的全局算子和已解出的位移向量，根据约束节点 $x=0$ 处的离散平衡方程计算该点的反力。然后，通过检验 $x=0$ 处的反力、体力合力 $\\int_0^L A(x)\\,b(x)\\,dx$ 以及施加的端点力 $\\bar{T}$ 在所采用的符号约定下的代数和是否为零，来验证整个杆的全局平衡。\n\n请以千牛顿 (kN) 为单位，给出 $x=0$ 处的反力作为最终答案，并四舍五入至四位有效数字。仅报告以 kN 为单位的数值（最终的方框答案中不要包含单位）。", "solution": "在尝试任何解答之前，需对问题陈述进行验证。\n\n步骤1：提取已知条件\n- **域**: 一根长度为 $L=2\\,\\mathrm{m}$ 的直杆，位于区间 $x \\in [0,L]$。\n- **离散化**: 两个等长的两节点线性杆单元。节点位于 $x_1=0\\,\\mathrm{m}$、$x_2=1\\,\\mathrm{m}$ 和 $x_3=2\\,\\mathrm{m}$。单元1跨越 $[0,1]$，单元2跨越 $[1,2]$。每个单元的长度为 $\\ell_e = 1\\,\\mathrm{m}$。\n- **材料属性**: 杨氏模量为常数，$E = 2.10 \\times 10^{11}\\,\\mathrm{Pa}$。\n- **几何属性**: 截面积为分段常数：对于 $x \\in [0,1]$，$A(x) = A_1 = 2.0 \\times 10^{-4}\\,\\mathrm{m}^2$；对于 $x \\in [1,2]$，$A(x) = A_2 = 1.2 \\times 10^{-4}\\,\\mathrm{m}^2$。\n- **载荷**:\n    - 单位体积轴向体力：$b(x) = b_0 + b_1 x$，其中 $b_0 = 2.0 \\times 10^{7}\\,\\mathrm{N/m}^3$，$b_1 = 1.0 \\times 10^{7}\\,\\mathrm{N/m}^4$。\n    - $x=L$ 处的轴向点力：$\\bar{T} = 1.50 \\times 10^{4}\\,\\mathrm{N}$。\n- **边界条件**:\n    - $x=0$ 处的本质（狄利克雷）边界条件：$u(0) = 0$。\n    - $x=L$ 处的自然（诺伊曼）边界条件：牵引载荷，由 $\\bar{T}$ 体现。\n- **符号约定**: 位移 $u(x)$ 和力在 $+x$ 方向上为正。\n\n步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，是有限元法在线弹性静力学一维问题中的一个标准应用。这是一个适定问题，具有足够的数据和防止刚体运动的边界条件，从而保证了解的唯一性。语言客观而精确。数据在量纲上一致，并且对于承受显著载荷的钢杆而言是物理上合理的。该问题需要详细的推导和计算，因此具有相当的复杂性。它没有违反任何无效性标准。\n\n步骤3：结论与行动\n问题有效。将提供完整解答。\n\n有限元法公式从一维弹性体的虚功原理 (PVW) 开始：\n$$ \\int_{0}^{L} \\delta\\epsilon \\sigma A \\,dx = \\int_{0}^{L} \\delta u \\, b A \\,dx + \\sum_i \\delta u_i P_i $$\n其中 $\\sigma$ 是轴向应力，$\\epsilon$ 是轴向应变，$u$ 是轴向位移，$b$ 是单位体积体力，$A$ 是截面积，$P_i$ 是点载荷。对于线弹性，$\\sigma = E\\epsilon$。应变为 $\\epsilon = du/dx$。\n\n在一个局部域 $x' \\in [0, \\ell_e]$ 上定义一个两节点线性单元。单元内的位移场 $u(x')$ 通过线性形函数 $N_1(x')$ 和 $N_2(x')$ 从节点位移 $d_1^e, d_2^e$ 插值得到：\n$$ u(x') = N_1(x')d_1^e + N_2(x')d_2^e = \\mathbf{N}(x')\\mathbf{d}^e $$\n其中 $N_1(x') = 1 - x'/\\ell_e$ 和 $N_2(x') = x'/\\ell_e$。应变由下式给出：\n$$ \\epsilon(x') = \\frac{du}{dx'} = \\frac{d\\mathbf{N}}{dx'}\\mathbf{d}^e = \\mathbf{B}\\mathbf{d}^e = \\begin{bmatrix} -\\frac{1}{\\ell_e} & \\frac{1}{\\ell_e} \\end{bmatrix} \\mathbf{d}^e $$\n虚位移和虚应变为 $\\delta u = \\mathbf{N}\\delta\\mathbf{d}^e$ 和 $\\delta\\epsilon = \\mathbf{B}\\delta\\mathbf{d}^e$。\n\n**任务1：推导单元刚度矩阵和载荷向量**\n\n单元刚度矩阵 $\\mathbf{k}^e$ 由内虚功项导出：\n$$ \\delta\\mathbf{d}^{eT} \\mathbf{k}^e \\mathbf{d}^e = \\int_{0}^{\\ell_e} \\delta\\epsilon^T E \\epsilon A \\,dx' = \\int_{0}^{\\ell_e} (\\delta\\mathbf{d}^{eT}\\mathbf{B}^T) E (\\mathbf{B}\\mathbf{d}^e) A \\,dx' $$\n由于 $\\delta\\mathbf{d}^e$ 是任意的，我们有：\n$$ \\mathbf{k}^e = \\int_{0}^{\\ell_e} \\mathbf{B}^T E A \\mathbf{B} \\,dx' $$\n对于 $E$ 和 $A$ 恒定的单元：\n$$ \\mathbf{k}^e = EA \\int_{0}^{\\ell_e} \\begin{bmatrix} -1/\\ell_e \\\\ 1/\\ell_e \\end{bmatrix} \\begin{bmatrix} -1/\\ell_e & 1/\\ell_e \\end{bmatrix} \\,dx' = EA \\int_{0}^{\\ell_e} \\frac{1}{\\ell_e^2}\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\,dx' = \\frac{EA}{\\ell_e}\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\n由体力引起的一致单元载荷向量 $\\mathbf{f}_b^e$ 从体力的外虚功导出：\n$$ \\delta\\mathbf{d}^{eT} \\mathbf{f}_b^e = \\int_{0}^{\\ell_e} \\delta u \\, b A \\,dx' = \\int_{0}^{\\ell_e} (\\delta\\mathbf{d}^{eT}\\mathbf{N}^T) b(x') A \\,dx' $$\n$$ \\mathbf{f}_b^e = \\int_{0}^{\\ell_e} A \\mathbf{N}^T b(x') \\,dx' $$\n体力 $b(x)$ 是在全局坐标中定义的。设一个单元的起始全局坐标为 $x_{start}$。全局坐标为 $x = x_{start} + x'$。因此，$b(x') = b_0 + b_1(x_{start} + x')$。\n$$ \\mathbf{f}_b^e = A \\int_0^{\\ell_e} \\begin{pmatrix} 1 - x'/\\ell_e \\\\ x'/\\ell_e \\end{pmatrix} (b_0 + b_1 x_{start} + b_1 x') \\,dx' $$\n计算第一分量的积分：\n$$ f_{b,1}^e = A \\int_0^{\\ell_e} \\left( b_0+b_1 x_{start} + b_1 x' - \\frac{x'}{\\ell_e}(b_0+b_1 x_{start}) - \\frac{b_1 (x')^2}{\\ell_e} \\right) dx' \\\\ = A \\left[ (b_0+b_1 x_{start})x' + \\frac{b_1 (x')^2}{2} - \\frac{(x')^2}{2\\ell_e}(b_0+b_1 x_{start}) - \\frac{b_1 (x')^3}{3\\ell_e} \\right]_0^{\\ell_e} \\\\ = A\\ell_e \\left[ (b_0+b_1 x_{start}) + \\frac{b_1\\ell_e}{2} - \\frac{1}{2}(b_0+b_1 x_{start}) - \\frac{b_1\\ell_e}{3} \\right] \\\\ = A\\ell_e \\left[ \\frac{1}{2}(b_0+b_1 x_{start}) + \\frac{1}{6}b_1\\ell_e \\right] $$\n计算第二分量的积分：\n$$ f_{b,2}^e = A \\int_0^{\\ell_e} \\left( \\frac{x'}{\\ell_e}(b_0+b_1 x_{start}) + \\frac{b_1 (x')^2}{\\ell_e} \\right) dx' \\\\ = A \\left[ \\frac{(x')^2}{2\\ell_e}(b_0+b_1 x_{start}) + \\frac{b_1 (x')^3}{3\\ell_e} \\right]_0^{\\ell_e} \\\\ = A\\ell_e \\left[ \\frac{1}{2}(b_0+b_1 x_{start}) + \\frac{1}{3}b_1\\ell_e \\right] $$\n\n**任务2：组集全局系统**\n\n该杆有2个单元和3个节点。我们来计算每个单元的矩阵。两个单元的长度都为 $\\ell_e = 1\\,\\mathrm{m}$。\n\n*单元1（节点1-2）：* $x \\in [0,1]$，所以 $x_{start}^{(1)}=0$。$A_1 = 2.0 \\times 10^{-4}\\,\\mathrm{m}^2$。\n$$ \\frac{EA_1}{\\ell_1} = \\frac{(2.10 \\times 10^{11}\\,\\mathrm{Pa})(2.0 \\times 10^{-4}\\,\\mathrm{m}^2)}{1\\,\\mathrm{m}} = 4.2 \\times 10^7\\,\\mathrm{N/m} $$\n$$ \\mathbf{k}^{(1)} = 4.2 \\times 10^7 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\n对于载荷向量，其中 $b_0=2\\times 10^7, b_1=1\\times 10^7$：\n$$ f_{b,1}^{(1)} = (2.0 \\times 10^{-4})(1) \\left[ \\frac{1}{2}(2\\times 10^7) + \\frac{1}{6}(1\\times 10^7)(1) \\right] = 2\\times 10^{-4} \\left[ \\frac{7}{6}\\times 10^7 \\right] = \\frac{7000}{3}\\,\\mathrm{N} $$\n$$ f_{b,2}^{(1)} = (2.0 \\times 10^{-4})(1) \\left[ \\frac{1}{2}(2\\times 10^7) + \\frac{1}{3}(1\\times 10^7)(1) \\right] = 2\\times 10^{-4} \\left[ \\frac{4}{3}\\times 10^7 \\right] = \\frac{8000}{3}\\,\\mathrm{N} $$\n\n*单元2（节点2-3）：* $x \\in [1,2]$，所以 $x_{start}^{(2)}=1$。$A_2 = 1.2 \\times 10^{-4}\\,\\mathrm{m}^2$。\n$$ \\frac{EA_2}{\\ell_2} = \\frac{(2.10 \\times 10^{11}\\,\\mathrm{Pa})(1.2 \\times 10^{-4}\\,\\mathrm{m}^2)}{1\\,\\mathrm{m}} = 2.52 \\times 10^7\\,\\mathrm{N/m} $$\n$$ \\mathbf{k}^{(2)} = 2.52 \\times 10^7 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\n对于载荷向量：\n$$ f_{b,1}^{(2)} = (1.2 \\times 10^{-4})(1) \\left[ \\frac{1}{2}(2\\times 10^7 + 1\\times 10^7(1)) + \\frac{1}{6}(1\\times 10^7)(1) \\right] \\\\ = 1.2 \\times 10^{-4} \\left[ \\frac{3}{2}\\times 10^7 + \\frac{1}{6}\\times 10^7 \\right] = 1.2 \\times 10^{-4} \\left[ \\frac{10}{6}\\times 10^7 \\right] = 2000\\,\\mathrm{N} $$\n$$ f_{b,2}^{(2)} = (1.2 \\times 10^{-4})(1) \\left[ \\frac{1}{2}(2\\times 10^7 + 1\\times 10^7(1)) + \\frac{1}{3}(1\\times 10^7)(1) \\right] \\\\ = 1.2 \\times 10^{-4} \\left[ \\frac{3}{2}\\times 10^7 + \\frac{1}{3}\\times 10^7 \\right] = 1.2 \\times 10^{-4} \\left[ \\frac{11}{6}\\times 10^7 \\right] = 2200\\,\\mathrm{N} $$\n全局刚度矩阵 $\\mathbf{K}$ 组集如下：\n$$ \\mathbf{K} = \\begin{pmatrix} k_{11}^{(1)} & k_{12}^{(1)} & 0 \\\\ k_{21}^{(1)} & k_{22}^{(1)} + k_{11}^{(2)} & k_{12}^{(2)} \\\\ 0 & k_{21}^{(2)} & k_{22}^{(2)} \\end{pmatrix} = 10^7 \\begin{pmatrix} 4.2 & -4.2 & 0 \\\\ -4.2 & 4.2 + 2.52 & -2.52 \\\\ 0 & -2.52 & 2.52 \\end{pmatrix} \\\\ = 10^7 \\begin{pmatrix} 4.2 & -4.2 & 0 \\\\ -4.2 & 6.72 & -2.52 \\\\ 0 & -2.52 & 2.52 \\end{pmatrix} $$\n全局载荷向量 $\\mathbf{F}$ 是组集后的体力向量 $\\mathbf{F}_b$ 和点载荷向量 $\\mathbf{F}_p$ 的和。\n$$ \\mathbf{F}_b = \\begin{pmatrix} f_{b,1}^{(1)} \\\\ f_{b,2}^{(1)} + f_{b,1}^{(2)} \\\\ f_{b,2}^{(2)} \\end{pmatrix} = \\begin{pmatrix} 7000/3 \\\\ 8000/3 + 2000 \\\\ 2200 \\end{pmatrix} = \\begin{pmatrix} 7000/3 \\\\ 14000/3 \\\\ 2200 \\end{pmatrix}\\,\\mathrm{N} $$\n$$ \\mathbf{F}_p = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\bar{T} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 15000 \\end{pmatrix}\\,\\mathrm{N} $$\n$$ \\mathbf{F} = \\mathbf{F}_b + \\mathbf{F}_p = \\begin{pmatrix} 7000/3 \\\\ 14000/3 \\\\ 2200 + 15000 \\end{pmatrix} = \\begin{pmatrix} 7000/3 \\\\ 14000/3 \\\\ 17200 \\end{pmatrix}\\,\\mathrm{N} $$\n\n**任务3：求解节点位移**\n\n全局方程组为 $\\mathbf{K}\\mathbf{U} = \\mathbf{F}$。本质边界条件为 $u_1 = 0$。我们对系统进行分区，以求解未知位移 $u_2$ 和 $u_3$。\n$$ 10^7 \\begin{pmatrix} 6.72 & -2.52 \\\\ -2.52 & 2.52 \\end{pmatrix} \\begin{pmatrix} u_2 \\\\ u_3 \\end{pmatrix} = \\begin{pmatrix} 14000/3 \\\\ 17200 \\end{pmatrix} $$\n将这两个方程相加，得到一个关于 $u_2$ 的简单方程：\n$$ 10^7 (6.72 - 2.52) u_2 = \\frac{14000}{3} + 17200 \\\\ 4.2 \\times 10^7 u_2 = \\frac{14000 + 51600}{3} = \\frac{65600}{3} \\\\ u_2 = \\frac{65600}{3 \\times 4.2 \\times 10^7} = \\frac{65600}{12.6 \\times 10^7} \\approx 5.206349 \\times 10^{-4}\\,\\mathrm{m} $$\n从简化系统的第二个方程，我们求得 $u_3$：\n$$ 10^7 (-2.52 u_2 + 2.52 u_3) = 17200 \\implies u_3 - u_2 = \\frac{17200}{2.52 \\times 10^7} \\approx 6.825397 \\times 10^{-4}\\,\\mathrm{m} \\\\ u_3 = u_2 + 6.825397 \\times 10^{-4} \\approx 5.206349 \\times 10^{-4} + 6.825397 \\times 10^{-4} \\approx 1.203175 \\times 10^{-3}\\,\\mathrm{m} $$\n位移向量为 $\\mathbf{U} \\approx \\begin{pmatrix} 0 & 5.206 \\times 10^{-4} & 1.203 \\times 10^{-3} \\end{pmatrix}^T\\,\\mathrm{m}$。\n\n**任务4：计算反力并验证平衡**\n\n固定节点1处的反力 $R_1$ 可从全局方程组 $\\mathbf{R} = \\mathbf{K}\\mathbf{U} - \\mathbf{F}$ 的第一行求得。\n$$ R_1 = K_{11}u_1 + K_{12}u_2 + K_{13}u_3 - F_1 $$\n当 $u_1=0$ 且 $K_{13}=0$ 时：\n$$ R_1 = K_{12}u_2 - F_1 = (-4.2 \\times 10^7)u_2 - \\frac{7000}{3} $$\n代入 $u_2$ 的表达式：\n$$ R_1 = (-4.2 \\times 10^7) \\left( \\frac{65600}{3 \\times 4.2 \\times 10^7} \\right) - \\frac{7000}{3} = -\\frac{65600}{3} - \\frac{7000}{3} = -\\frac{72600}{3} = -24200\\,\\mathrm{N} $$\n负号表示该力作用在 $-x$ 方向。\n\n为验证全局平衡，我们对作用在杆上的所有外力求和。由分布体力产生的总力为：\n$$ F_{body} = \\int_0^L A(x)b(x)\\,dx = \\int_0^1 A_1(b_0+b_1x)\\,dx + \\int_1^2 A_2(b_0+b_1x)\\,dx $$\n$$ \\int_0^1 (2\\times 10^{-4})(2\\times 10^7+1\\times 10^7 x)\\,dx = (2\\times 10^{-4})[2\\times 10^7 x + 0.5\\times 10^7 x^2]_0^1 = 5000\\,\\mathrm{N} $$\n$$ \\int_1^2 (1.2\\times 10^{-4})(2\\times 10^7+1\\times 10^7 x)\\,dx = (1.2\\times 10^{-4})[2\\times 10^7 x + 0.5\\times 10^7 x^2]_1^2 = 4200\\,\\mathrm{N} $$\n总体力 $F_{body} = 5000 + 4200 = 9200\\,\\mathrm{N}$。\n所有外力的总和是：\n$$ \\sum F_{ext} = R_1 + F_{body} + \\bar{T} = -24200\\,\\mathrm{N} + 9200\\,\\mathrm{N} + 15000\\,\\mathrm{N} = 0 $$\n全局平衡得到满足，这验证了计算的正确性。\n\n$x=0$ 处的反力为 $-24200\\,\\mathrm{N}$。以千牛顿 (kN) 为单位，即 $-24.2\\,\\mathrm{kN}$。四舍五入到四位有效数字，其值为 $-24.20\\,\\mathrm{kN}$。", "answer": "$$\\boxed{-24.20}$$", "id": "2538126"}, {"introduction": "将纸笔上的推导转化为可执行的计算机代码，是学习计算方法的关键一步。本练习要求你将理论知识应用于实践，通过编程实现从单元到全局的组装过程，让你深刻理解单元矩阵如何根据连接性信息“散点相加”到全局系统矩阵中的过程。通过解决一系列测试案例，你将构建一个基础但完整的一维有限元求解器，为将来开发更复杂的分析工具奠定基础 [@problem_id:2562916]。", "problem": "考虑一根用线性两节点有限元离散的一维轴向杆。其强形式的控制方程是分布式载荷作用下的轴向力平衡。从虚功基本陈述出发，可以推导出杆的有限元方程。全局组装必须使用连接关系和单元组装算子来表示。你的任务是为所提供的测试集，使用组装算子公式实现刚度矩阵和一致性全局载荷向量的完整全局组装，通过消元法施加本质（狄利克雷）边界条件，求解节点位移，并计算所有约束节点上的总反力。最终程序必须输出一行包含下文指定的所请求值的文本。\n\n要使用的基本原理是虚功原理，对于轴向杆，该原理指出，对于所有容许的虚位移，内虚功等于外虚功。设杆占据域 $x \\in [0,L]$，其轴向刚度为 $E A(x)$，并承受轴向分布载荷 $q(x)$ 和可能的节点集中载荷。对于具有节点 $i$ 和 $j$ 的线性两节点单元，单元位移场近似为 $u^{e}(x) = N_{1}(x)\\,u_{i} + N_{2}(x)\\,u_{j}$，其中线性的形函数 $N_{1}$ 和 $N_{2}$ 在单元上定义。一致性单元载荷向量是通过对形函数加权的分布载荷进行积分得到的。单元刚度矩阵由 $E A$ 乘以形函数导数的积分得到。对于全局组装，使用从连接关系构建的布尔组装算子 $A^{e}$，使得 $u^{e} = A^{e} u$，其中 $u$ 是全局位移向量。然后将全局刚度和力构造成 $K = \\sum_{e} (A^{e})^{T} k^{e} A^{e}$ 和 $f = \\sum_{e} (A^{e})^{T} f^{e} + f^{p}$，其中 $k^{e}$ 是单元刚度， $f^{e}$ 是由分布载荷引起的一致性单元载荷，而 $f^{p}$ 是节点集中载荷的全局向量。通过分区施加本质边界条件，求解未知位移，并根据 $r = K u - f$（限制在约束指标上）计算约束自由度处的反力。采用正号约定，即正载荷和正位移沿杆的正轴方向。\n\n所有测试用例的几何与网格：\n- 节点坐标为 $x = [\\,0,\\,1,\\,2\\,]\\,\\mathrm{m}$，构成两个单元，其连接关系在零基索引下为 $[0,1]$ 和 $[1,2]$。\n- 每个单元 $e$ 的长度为 $L_{e} = 1\\,\\mathrm{m}$。\n\n从虚功原理推导并在实现中使用的单元级公式：\n- 对于单元上轴向刚度恒定的两节点线性单元，其刚度由积分 $k^{e} = \\int_{0}^{L_{e}} B^{T} E A \\, B \\,\\mathrm{d}x$ 给出，其中 $B$ 是形函数相对于 $x$ 的导数。\n- 对于单元 $e$ 上的均布轴向载荷 $q_{e}$，一致性单元载荷为 $f^{e} = \\int_{0}^{L_{e}} N^{T} q_{e} \\,\\mathrm{d}x$。\n- 组装算子 $A^{e}$ 是一个布尔矩阵，每个局部自由度都恰好有一个单位条目映射到其全局对应项，因此 $u^{e} = A^{e} u$。\n\n单位与所需输出：\n- 所有距离单位必须为 $\\mathrm{m}$，力单位为 $\\mathrm{N}$，轴向刚度 $E A$ 单位为 $\\mathrm{N}$。\n- 对于每个测试用例，返回两个数字：位于 $x=1\\,\\mathrm{m}$ 处的内部节点的位移（单位为 $\\mathrm{m}$，四舍五入到 $6$ 位小数）和总反力（所有约束节点上反力的总和，单位为 $\\mathrm{N}$，四舍五入到 $3$ 位小数）。\n- 你的程序必须生成一行输出，其中包含一个逗号分隔的列表，包含下述顺序的 $6$ 个结果，并用方括号括起来。\n\n测试集：\n- 用例 $1$ (正常路径)：单元轴向刚度 $E A = [\\,3.0\\times 10^{7},\\,6.0\\times 10^{7}\\,]\\,\\mathrm{N}$，单元分布载荷 $q = [\\,1000.0,\\,0.0\\,]\\,\\mathrm{N/m}$，施加于节点的集中载荷 $f^{p}$ 为 $[\\,0.0,\\,0.0,\\,500.0\\,]\\,\\mathrm{N}$，本质边界条件为 $u(0)=0\\,\\mathrm{m}$。\n- 用例 $2$ (边界条件覆盖)：单元轴向刚度 $E A = [\\,5.0\\times 10^{7},\\,5.0\\times 10^{7}\\,]\\,\\mathrm{N}$，单元分布载荷 $q = [\\,500.0,\\,500.0\\,]\\,\\mathrm{N/m}$，无集中载荷 $[\\,0.0,\\,0.0,\\,0.0\\,]\\,\\mathrm{N}$，本质边界条件为 $u(0)=0\\,\\mathrm{m}$ 和 $u(2)=0\\,\\mathrm{m}$。\n- 用例 $3$ (零分布载荷和内部集中载荷的边缘情况)：单元轴向刚度 $E A = [\\,4.0\\times 10^{7},\\,2.0\\times 10^{7}\\,]\\,\\mathrm{N}$，单元分布载荷 $q = [\\,0.0,\\,0.0\\,]\\,\\mathrm{N/m}$，集中载荷为 $[\\,0.0,\\,-100.0,\\,0.0\\,]\\,\\mathrm{N}$，本质边界条件为 $u(0)=0\\,\\mathrm{m}$。\n\n最终输出格式：\n- 程序必须输出形如 $[r_{1},r_{2},r_{3},r_{4},r_{5},r_{6}]$ 的单行文本，其中按顺序，数对分别对应于用例 $1$、$2$ 和 $3$，每对由 $x=1\\,\\mathrm{m}$ 处的内部节点位移（单位为 $\\mathrm{m}$，四舍五入到 $6$ 位小数）和总反力（单位为 $\\mathrm{N}$，四舍五入到 $3$ 位小数）组成。", "solution": "所提出的问题是计算固体力学中的一个标准的、适定的问题，具体是针对轴向杆应用一维有限元方法（FEM）。它在科学上是合理的，逻辑上是一致的，并为得到唯一解提供了所有必要的数据。我们将继续进行推导和求解。\n\n静力学固体力学问题的有限元公式的基础是虚功原理。对于在分布轴向载荷 $q(x)$ 和集中载荷 $P_i$ 作用下处于静力平衡状态的一维杆，该原理指出，对于任何任意的、运动学上容许的虚位移场 ${\\delta}u(x)$，内虚功 (${\\delta}W_{int}$) 等于外虚功 (${\\delta}W_{ext}$)。\n$${\\delta}W_{int} = {\\delta}W_{ext}$$\n$$ \\int_{L} {\\delta}\\epsilon(x) E A(x) \\epsilon(x) \\,dx = \\int_{L} {\\delta}u(x) q(x) \\,dx + \\sum_{i} {\\delta}u_{i} P_{i} $$\n其中 $\\epsilon(x) = \\frac{du}{dx}$ 是轴向应变，$E A(x)$ 是轴向刚度，${\\delta}\\epsilon = \\frac{d({\\delta}u)}{dx}$ 是虚应变。\n\n将域离散为有限元。在每个单元 $e$ 内，位移场 $u^e(x)$ 通过使用形函数 $N(x)$ 对节点位移 $u^e$ 进行插值来近似：\n$$ u^e(x) = N(x) u^e = [N_1(x) \\quad N_2(x)] \\begin{bmatrix} u_i \\\\ u_j \\end{bmatrix} $$\n对于长度为 $L_e$ 的线性两节点单元，形函数为 $N_1(x) = 1 - x/L_e$ 和 $N_2(x) = x/L_e$，其中 $x$ 是单元内的局部坐标 ($x \\in [0, L_e]$)。\n\n应变 $\\epsilon^e(x)$ 随后被近似为：\n$$ \\epsilon^e(x) = \\frac{du^e}{dx} = \\frac{dN}{dx} u^e = B u^e $$\n其中 $B = [\\frac{dN_1}{dx} \\quad \\frac{dN_2}{dx}] = [-\\frac{1}{L_e} \\quad \\frac{1}{L_e}]$ 是应变-位移矩阵。虚位移和虚应变也以类似方式近似：${\\delta}u^e(x) = N(x) {\\delta}u^e$ 且 ${\\delta}\\epsilon^e(x) = B {\\delta}u^e$。\n\n将这些近似值代入单个单元的虚功原理中，可得：\n$$ \\int_{L_e} ({\\delta}u^e)^T B^T E A B u^e \\,dx = \\int_{L_e} ({\\delta}u^e)^T N^T q_e \\,dx $$\n由于虚节点位移 $({\\delta}u^e)^T$ 是任意的，我们得到单元级矩阵方程 $k^e u^e = f^e$：\n$$ \\left( \\int_{L_e} B^T E A B \\,dx \\right) u^e = \\int_{L_e} N^T q_e \\,dx $$\n\n这给出了单元刚度矩阵 $k^e$ 和一致性单元载荷向量 $f^e$ 的公式：\n对于恒定的 $EA$ 和 $L_e=1$：\n$$ k^e = \\int_{0}^{1} \\begin{bmatrix} -1 \\\\ 1 \\end{bmatrix} EA \\begin{bmatrix} -1 & 1 \\end{bmatrix} \\,dx = EA \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix} $$\n对于恒定的分布载荷 $q_e$ 和 $L_e=1$：\n$$ f^e_{dist} = \\int_{0}^{1} \\begin{bmatrix} 1-x \\\\ x \\end{bmatrix} q_e \\,dx = q_e \\begin{bmatrix} [x-x^2/2]_0^1 \\\\ [x^2/2]_0^1 \\end{bmatrix} = \\frac{q_e}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} $$\n\n为构建整个杆的全局方程组 $K u = f$，其中总自由度 (DoFs) 为 $N_{dof}$，我们将所有单元的贡献相加。这个过程由组装算子 $A^e$ 正式描述，它们是将单元局部自由度映射到全局自由度向量的布尔矩阵。对于具有局部自由度向量 $u^e$ 的单元 $e$，我们有 $u^e = A^e u$。全局矩阵通过求和形成：\n$$ K = \\sum_{e} (A^e)^T k^e A^e \\quad \\text{and} \\quad f = \\sum_{e} (A^e)^T f^e_{dist} + f^p $$\n其中 $f^p$ 是节点集中载荷向量。在实践中，此操作通过遍历单元并根据单元的连接图谱将其矩阵和向量条目加到对应的全局位置来实现。\n\n几何结构由位于 $x=[0, 1, 2]$ 的 $3$ 个节点组成，形成两个长度为 $L_e=1$ 的单元。全局系统将是 $3 \\times 3$ 的。\n- 单元 $1$：连接节点 $0$ 和 $1$。连接关系为 `[0, 1]`。\n- 单元 $2$：连接节点 $1$ 和 $2$。连接关系为 `[1, 2]`。\n\n组装完全局矩阵 $K$ 和向量 $f$ 后，施加本质边界条件（例如 $u_i = \\bar{u_i}$）。我们将系统划分为自由（下标 $f$）和约束（下标 $c$）的自由度：\n$$ \\begin{bmatrix} K_{ff} & K_{fc} \\\\ K_{cf} & K_{cc} \\end{bmatrix} \\begin{bmatrix} u_f \\\\ u_c \\end{bmatrix} = \\begin{bmatrix} f_f \\\\ f_c \\end{bmatrix} $$\n未知位移 $u_f$ 通过求解简化的系统得到：\n$$ K_{ff} u_f = f_f - K_{fc} u_c $$\n在本问题中，所有指定位移均为零（$u_c = 0$），因此系统简化为 $K_{ff} u_f = f_f$。\n\n一旦知道了完整的位移向量 $u$（通过组合求解出的 $u_f$ 和指定的 $u_c$），就可以计算约束节点处的反力 $r$。反力是维持约束所需的外部力。它由约束自由度上的内力 $Ku$ 和施加的外力 $f$ 之差给出：\n$$ r_c = (K u)_c - f_c $$\n总反力是 $r_c$ 的所有分量之和。\n\n让我们将此过程应用于用例1：\n- 已知条件: $EA = [3\\times10^7, 6\\times10^7]$, $q = [1000, 0]$, $f^p=[0, 0, 500]$, 边界条件: $u_0=0$。\n- 单元矩阵 ($L_e=1$):\n  $k^1 = 3\\times10^7 \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}$, $f^1 = \\frac{1000}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 500 \\\\ 500 \\end{bmatrix}$\n  $k^2 = 6\\times10^7 \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}$, $f^2 = \\frac{0}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$\n- 全局组装 ($N_{dof}=3$):\n  $K = \\begin{bmatrix} 3\\times10^7 & -3\\times10^7 & 0 \\\\ -3\\times10^7 & 3\\times10^7+6\\times10^7 & -6\\times10^7 \\\\ 0 & -6\\times10^7 & 6\\times10^7 \\end{bmatrix} = 10^7 \\begin{bmatrix} 3 & -3 & 0 \\\\ -3 & 9 & -6 \\\\ 0 & -6 & 6 \\end{bmatrix}$\n  $f_{dist} = \\begin{bmatrix} 500 \\\\ 500 \\\\ 0 \\end{bmatrix}$。总力 $f = f_{dist} + f^p = \\begin{bmatrix} 500 \\\\ 500 \\\\ 0 \\end{bmatrix} + \\begin{bmatrix} 0 \\\\ 0 \\\\ 500 \\end{bmatrix} = \\begin{bmatrix} 500 \\\\ 500 \\\\ 500 \\end{bmatrix}$。\n- 施加边界条件：约束自由度为 $c=\\{0\\}$，自由自由度为 $f=\\{1, 2\\}$。$u_0=0$。\n  $K_{ff} = 10^7 \\begin{bmatrix} 9 & -6 \\\\ -6 & 6 \\end{bmatrix}$, $u_f = \\begin{bmatrix} u_1 \\\\ u_2 \\end{bmatrix}$, $f_f = \\begin{bmatrix} 500 \\\\ 500 \\end{bmatrix}$。\n- 求解 $K_{ff} u_f = f_f$：\n  $10^7 \\begin{bmatrix} 9 & -6 \\\\ -6 & 6 \\end{bmatrix} \\begin{bmatrix} u_1 \\\\ u_2 \\end{bmatrix} = \\begin{bmatrix} 500 \\\\ 500 \\end{bmatrix}$\n  求解此系统可得 $u_1 = \\frac{1}{3} \\times 10^{-4}\\,\\mathrm{m} \\approx 0.000033\\,\\mathrm{m}$ 和 $u_2 = \\frac{2.5}{6} \\times 10^{-4}\\,\\mathrm{m} \\approx 0.000042\\,\\mathrm{m}$。\n- 反力：完整位移向量为 $u = [0, \\frac{1}{3}\\times10^{-4}, \\frac{2.5}{6}\\times10^{-4}]^T$。\n  $r_0 = (Ku)_0 - f_0 = K_{00}u_0 + K_{01}u_1 + K_{02}u_2 - f_0$。\n  $r_0 = (0) + (-3\\times10^7)(\\frac{1}{3}\\times10^{-4}) + (0) - 500 = -1000 - 500 = -1500\\,\\mathrm{N}$。\n总反力为 $-1500\\,\\mathrm{N}$。\n其他测试用例的值通过应用相同的系统性步骤和以下实现得到。\n\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a 1D axial bar finite element problem for three test cases.\n    The implementation follows the principles of virtual work to derive element\n    matrices, assembles a global system, applies boundary conditions by\n    elimination, solves for displacements, and calculates reaction forces.\n    \"\"\"\n\n    test_cases = [\n        # Case 1\n        {\n            \"EA\": [3.0e7, 6.0e7],       # N\n            \"q\": [1000.0, 0.0],          # N/m\n            \"fp\": [0.0, 0.0, 500.0],    # N\n            \"bc\": {0: 0.0}               # node_idx: displacement (m)\n        },\n        # Case 2\n        {\n            \"EA\": [5.0e7, 5.0e7],\n            \"q\": [500.0, 500.0],\n            \"fp\": [0.0, 0.0, 0.0],\n            \"bc\": {0: 0.0, 2: 0.0}\n        },\n        # Case 3\n        {\n            \"EA\": [4.0e7, 2.0e7],\n            \"q\": [0.0, 0.0],\n            \"fp\": [0.0, -100.0, 0.0],\n            \"bc\": {0: 0.0}\n        }\n    ]\n\n    results = []\n    \n    # Mesh definition is common for all cases\n    nodes = np.array([0.0, 1.0, 2.0])\n    connectivity = [[0, 1], [1, 2]]\n    num_nodes = len(nodes)\n    num_elements = len(connectivity)\n    \n    for case in test_cases:\n        K_global = np.zeros((num_nodes, num_nodes))\n        F_global = np.zeros(num_nodes)\n        \n        # Assemble global stiffness matrix and consistent load vector\n        for i in range(num_elements):\n            EA_elem = case[\"EA\"][i]\n            q_elem = case[\"q\"][i]\n            \n            node_i, node_j = connectivity[i]\n            L_elem = nodes[node_j] - nodes[node_i]\n            \n            # Element stiffness matrix\n            k_elem = (EA_elem / L_elem) * np.array([[1, -1], [-1, 1]])\n            \n            # Consistent element load vector for uniform distributed load\n            f_elem_dist = (q_elem * L_elem / 2.0) * np.array([1, 1])\n            \n            # Assemble (scatter-add) into global matrices\n            # This is the practical implementation of K = sum( A.T @ k @ A )\n            # and F = sum( A.T @ f )\n            indices = np.ix_([node_i, node_j], [node_i, node_j])\n            K_global[indices] += k_elem\n            F_global[[node_i, node_j]] += f_elem_dist\n\n        # Add point loads\n        F_global += np.array(case[\"fp\"])\n        \n        # Apply boundary conditions by partitioning\n        all_dofs = list(range(num_nodes))\n        constrained_dofs = sorted(list(case[\"bc\"].keys()))\n        free_dofs = sorted(list(set(all_dofs) - set(constrained_dofs)))\n\n        K_ff = K_global[np.ix_(free_dofs, free_dofs)]\n        F_f = F_global[free_dofs]\n        \n        # In this problem, all prescribed displacements are 0, so the term\n        # -K_fc @ u_c is zero and omitted from the right hand side.\n        \n        # Solve for unknown displacements\n        u_f = np.linalg.solve(K_ff, F_f)\n        \n        # Reconstruct the full displacement vector\n        u_global = np.zeros(num_nodes)\n        u_global[free_dofs] = u_f\n        # u_global[constrained_dofs] is already 0 as per the problem.\n\n        # Calculate reaction forces using the formula r = K*u - f\n        # This is evaluated only for the constrained DoFs.\n        reactions = (K_global @ u_global - F_global)[constrained_dofs]\n        total_reaction = np.sum(reactions)\n        \n        # Extract displacement at the interior node (node 1)\n        u1 = u_global[1]\n        \n        # Format results as specified\n        results.extend([u1, total_reaction])\n        \n    # Format the final output string\n    # case 1: u1, R1; case 2: u2, R2; case 3: u3, R3\n    output_str = f\"[{results[0]:.6f},{results[1]:.3f},{results[2]:.6f},{results[3]:.3f},{results[4]:.6f},{results[5]:.3f}]\"\n    \n    return output_str\n\n# The actual call to the function is not part of the solution text but is needed to generate the answer.\n# print(solve())\n```", "answer": "```\n[0.000033,-1500.000,0.000005,-1000.000,-0.000003,100.000]\n```", "id": "2562916"}]}