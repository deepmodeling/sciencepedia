{"hands_on_practices": [{"introduction": "汇编有限元刚度矩阵的核心在于计算基函数及其导数的乘积的积分。虽然理论上这看起来很简单，但在实践中，我们依赖于数值积分（或称求积）来计算这些积分。本练习探讨了一个关键问题：为了避免引入积分误差，从而确保所汇编矩阵的精确性，我们需要多高阶的求积法则？[@problem_id:2558061] 这个基本问题将理论与高效的计算实践紧密联系起来。", "problem": "考虑一个设定在有界Lipschitz域 $\\Omega \\subset \\mathbb{R}^{d}$（其中 $d \\geq 1$）上的标量扩散模型问题，该问题通过标准Galerkin有限元法 (FEM) 进行离散化。设 $\\mathcal{T}_{h}$ 是 $\\Omega$ 的一个形状规则的单纯形网格，其具有从一个固定的参考单纯形 $\\hat{K}$ 到每个物理单元 $K \\in \\mathcal{T}_{h}$ 的仿射单元映射 $F_{K} : \\hat{K} \\to K$。在每个单元 $K$ 上，使用总次数为 $k \\geq 1$ 的连续Lagrange空间（记为 $P_{k}(K)$）来近似解。考虑与具有常数各向同性扩散系数 $\\kappa > 0$ 的泊松算子相关联的经典对称双线性形式，即\n$$\na(u,v) \\,=\\, \\int_{\\Omega} \\kappa \\,\\nabla u \\cdot \\nabla v \\, \\mathrm{d}x.\n$$\n单元刚度矩阵的项由下式给出\n$$\nK_{ij}^{K} \\,=\\, \\int_{K} \\kappa \\,\\nabla \\varphi_{i} \\cdot \\nabla \\varphi_{j} \\,\\mathrm{d}x,\n$$\n其中 $\\{\\varphi_{i}\\}$ 是 $K$ 上的局部 $P_{k}$ Lagrange 基函数。假设每个积分 $K_{ij}^{K}$ 的计算方法是：先将其拉回到 $\\hat{K}$ 上，然后应用一个对所有总次数不超过 $q$ 的多项式都精确的 $\\hat{K}$ 上的求积法则。\n\n仅从Lagrange多项式空间的定义、$F_{K}$ 映射下梯度的仿射变换以及双线性泛函 $a(\\cdot,\\cdot)$ 的形式出发，确定参考单纯形求积法则所需的最小多项式精确次数 $q_{\\min}(k)$，以确保对于所有的单元 $K \\in \\mathcal{T}_{h}$ 和所有的基函数索引对 $\\{i,j\\}$，$K_{ij}^{K}$ 都能被精确计算。\n\n请以 $k$ 的闭式表达式形式给出最终答案。不需要进行数值近似，也不涉及任何单位。", "solution": "我们从关于多项式次数、仿射映射和双线性形式结构的基本原理出发。\n\n在每个单元 $K$上，局部的试探函数和检验函数均取自Lagrange空间 $P_{k}(K)$，这意味着每个基函数 $\\varphi_{i}$ 在限制于 $K$ 上时，是一个总次数至多为 $k$ 的多项式。刚度项为\n$$\nK_{ij}^{K} \\,=\\, \\int_{K} \\kappa \\,\\nabla \\varphi_{i} \\cdot \\nabla \\varphi_{j} \\,\\mathrm{d}x,\n$$\n其中 $\\kappa$ 为常数。因为 $\\varphi_{i} \\in P_{k}(K)$，其梯度 $\\nabla \\varphi_{i}$ 是一个多项式向量，其中每个分量的总次数至多为 $k-1$。点积 $\\nabla \\varphi_{i} \\cdot \\nabla \\varphi_{j}$ 是分量多项式乘积之和，每个乘积的总次数至多为 $(k-1) + (k-1) = 2k - 2$。因此，作为 $K$ 上的函数，被积函数 $\\kappa \\,\\nabla \\varphi_{i} \\cdot \\nabla \\varphi_{j}$ 是一个总次数至多为 $2k - 2$ 的多项式。\n\n接下来我们考虑向参考单纯形的映射。设 $F_{K} : \\hat{K} \\to K$ 是一个仿射映射，其Jacobian矩阵为 $J_{K}$，行列式为 $\\det(J_{K}) \\neq 0$。在此映射下，对于 $\\hat{x} \\in \\hat{K}$ 和 $x = F_{K}(\\hat{x})$，根据链式法则可得\n$$\n\\nabla \\varphi_{i}(x) \\,=\\, J_{K}^{-T} \\,\\nabla_{\\hat{x}} \\hat{\\varphi}_{i}(\\hat{x}),\n$$\n其中 $\\hat{\\varphi}_{i} = \\varphi_{i} \\circ F_{K}$ 是在 $\\hat{K}$ 上的拉回基函数。由于 $F_{K}$ 是仿射映射，$J_{K}$ 和 $J_{K}^{-T}$ 在 $K$ 上是常数。单元积分变换如下：\n$$\nK_{ij}^{K} \\,=\\, \\int_{\\hat{K}} \\kappa \\,\\big(J_{K}^{-T}\\nabla_{\\hat{x}} \\hat{\\varphi}_{i}(\\hat{x})\\big) \\cdot \\big(J_{K}^{-T}\\nabla_{\\hat{x}} \\hat{\\varphi}_{j}(\\hat{x})\\big)\\, |\\det(J_{K})| \\, \\mathrm{d}\\hat{x}.\n$$\n定义常对称正定矩阵 $G_{K} = |\\det(J_{K})|\\, J_{K}^{-1} J_{K}^{-T}$。则\n$$\nK_{ij}^{K} \\,=\\, \\int_{\\hat{K}} \\kappa \\, \\nabla_{\\hat{x}} \\hat{\\varphi}_{i}(\\hat{x})^{T} \\, G_{K} \\, \\nabla_{\\hat{x}} \\hat{\\varphi}_{j}(\\hat{x}) \\,\\mathrm{d}\\hat{x}.\n$$\n由于 $G_{K}$ 和 $\\kappa$ 相对于 $\\hat{x}$ 是常数，它们不改变 $\\hat{K}$ 上被积函数的多项式次数。拉回基函数 $\\hat{\\varphi}_{i}$ 是 $\\hat{K}$ 上总次数至多为 $k$ 的多项式；因此 $\\nabla_{\\hat{x}} \\hat{\\varphi}_{i}$ 的每个分量总次数至多为 $k-1$，且标量 $\\nabla_{\\hat{x}} \\hat{\\varphi}_{i}^{T} \\, G_{K} \\, \\nabla_{\\hat{x}} \\hat{\\varphi}_{j}$ 在 $\\hat{K}$ 上仍然是一个总次数至多为 $2k - 2$ 的多项式。\n\n为了确定最小精确度要求，我们还必须检验这个上界 $2k - 2$ 是否能被某对基函数达到。考虑限制在 $\\hat{K}$ 上的 $\\hat{\\varphi}(\\hat{x}) = \\hat{x}_{1}^{k}$，它属于 $P_{k}(\\hat{K})$。那么\n$$\n\\nabla_{\\hat{x}} \\hat{\\varphi}(\\hat{x}) \\,=\\, \\big(k \\,\\hat{x}_{1}^{k-1},\\, 0,\\, \\dots,\\, 0\\big)^{T},\n$$\n所以标量积 $\\nabla_{\\hat{x}} \\hat{\\varphi} \\cdot \\nabla_{\\hat{x}} \\hat{\\varphi}$ 等于 $k^{2} \\hat{x}_{1}^{2k-2}$，这是一个总次数恰好为 $2k - 2$ 的多项式。因此，存在其被积函数次数达到 $2k - 2$ 的项 $K_{ij}^{K}$。任何一个对于所有总次数不超过 $2k-2$ 的多项式不精确的求积法则，对于某些网格单元和基函数对，都将无法精确地积分这类项。\n\n因此，对于任何仿射单纯形 $K$、任何 $k \\geq 1$ 的Lagrange空间 $P_{k}(K)$、以及在空间维度 $d \\geq 1$ 中的常数 $\\kappa > 0$，为了保证每个单元刚度项 $K_{ij}^{K}$ 都能被精确计算，一个在参考单纯形上对所有总次数不超过\n$$\nq_{\\min}(k) \\,=\\, 2k - 2\n$$\n的多项式都精确的求积法则是必要且充分的。", "answer": "$$\\boxed{2k-2}$$", "id": "2558061"}, {"introduction": "在全局刚度矩阵和载荷向量汇编完成后，我们必须施加狄利克雷（Dirichlet）边界条件，这是求解过程中的一个关键步骤。本练习将引导你实践标准的“消除法”，这是一种直接的代数操作，它能够正确地修改线性方程组以反映已知的节点值。通过这个练习，你将掌握如何在不破坏系统矩阵对称性的前提下，精确地处理本质边界条件。[@problem_id:2558097]", "problem": "考虑一个没有源项的杆上的稳态一维扩散问题，其强形式（经过无量纲化）简化为 $-u''(x)=0$，并带有狄利克雷边界条件。在包含三个单元（四个节点）的均匀网格上，使用带有线性单元的标准伽辽金有限元法，组装后的全局线性系统形式为 $K u = f$，其中 $K \\in \\mathbb{R}^{4 \\times 4}$ 是对称正定矩阵， $u \\in \\mathbb{R}^{4}$ 是节点未知数（自由度）的全局向量， $f \\in \\mathbb{R}^{4}$ 是全局载荷向量。对于此网格和归一化，组装后的刚度矩阵和载荷向量为\n$$\nK=\\begin{pmatrix}\n2 & -1 & 0 & 0\\\\\n-1 & 2 & -1 & 0\\\\\n0 & -1 & 2 & -1\\\\\n0 & 0 & -1 & 2\n\\end{pmatrix},\\qquad\nf=\\begin{pmatrix}\n0\\\\\n0\\\\\n0\\\\\n0\n\\end{pmatrix}.\n$$\n你需要通过消去与给定自由度（DOF）对应的行和列来施加狄利克雷本质边界条件，同时通过适当调整右端项来保持简化系统的对称性。具体来说，给定的值为 $u_1=0$ 和 $u_4=1$，自由度为 $u_2$ 和 $u_3$。\n\n从伽辽金弱形式得到的代数系统 $K u = f$ 出发，通过分块和代数操作，推导出用于移除给定自由度并为余下的自由度修正右端项的对称消元法。然后将你的结果应用于上述数据，计算出 $u_2$ 的精确值。\n\n请以单个精确数的形式提供最终答案。不要使用罚函数法或拉格朗日乘子法；仅使用保持对称性的消元法。无需四舍五入，也无需单位。", "solution": "在尝试求解之前，对问题进行验证。\n\n**步骤 1：提取已知条件**\n-   **控制方程：** $-u''(x)=0$（稳态，一维扩散，无源项，无量纲化）。\n-   **方法：** 标准伽辽金有限元法，使用线性单元。\n-   **网格：** 均匀网格，包含三个单元和四个节点。\n-   **全局系统：** $K u = f$。\n-   **刚度矩阵：**\n    $$\n    K=\\begin{pmatrix}\n    2 & -1 & 0 & 0\\\\\n    -1 & 2 & -1 & 0\\\\\n    0 & -1 & 2 & -1\\\\\n    0 & 0 & -1 & 2\n    \\end{pmatrix}\n    $$\n-   **载荷向量：**\n    $$\n    f=\\begin{pmatrix}\n    0\\\\\n    0\\\\\n    0\\\\\n    0\n    \\end{pmatrix}\n    $$\n-   **边界条件（本质/狄利克雷）：** $u_1 = 0$ 和 $u_4 = 1$。\n-   **未知数（自由度，DOF）：** $u_2$ 和 $u_3$。\n-   **任务：** 通过分块推导对称消元法，并应用该方法求出 $u_2$ 的精确值。\n-   **约束：** 仅使用保持对称性的消元法。不使用罚函数法或拉格朗日乘子法。\n\n**步骤 2：使用提取的已知条件进行验证**\n评估问题的有效性。\n-   **科学依据：** 该问题描述了将有限元法应用于一个简单的二阶边值问题。这是计算力学和应用数学中的一个标准且基础的课题。给定的刚度矩阵 $K$ 是一个众所周知的对称正定矩阵（离散拉普拉斯算子），零载荷向量 $f$ 与零源项一致。消元法是施加狄利克雷边界条件的标准程序。该问题在科学上和数学上都是合理的。\n-   **适定性：** 该问题是适定的。它提供了一个完整的代数系统和一组清晰的边界条件。任务是求解未知数的一个子集，预期存在唯一解且可以找到。具有给定边界值的基本微分方程也存在唯一解，这为离散系统的适定性提供了物理基础。\n-   **客观性：** 问题以精确、客观的数学语言陈述。\n-   **结论：** 该问题没有科学缺陷、矛盾或含糊之处。它是一个有效、适定的问题。\n\n**步骤 3：结论与行动**\n问题有效。将提供完整解答。\n\n**对称消元法的推导**\n\n通过有限元离散化得到的全局线性系统为 $K u = f$。我们将节点未知向量 $u$ 划分成自由（未知）自由度向量 $u_F$ 和给定（已知）自由度向量 $u_P$。根据此划分，系统可以重新排序并分块为：\n$$\n\\begin{pmatrix} K_{FF} & K_{FP} \\\\ K_{PF} & K_{PP} \\end{pmatrix}\n\\begin{pmatrix} u_F \\\\ u_P \\end{pmatrix}\n=\n\\begin{pmatrix} f_F \\\\ f_P \\end{pmatrix}\n$$\n此处，$K_{FF}$ 是 $K$ 中连接自由自由度与自由自由度的子矩阵，$K_{FP}$ 连接自由自由度与给定自由度，$K_{PF} = K_{FP}^T$ 连接给定自由度与自由自由度，而 $K_{PP}$ 连接给定自由度与给定自由度。向量 $f_F$ 和 $f_P$ 是全局载荷向量 $f$ 的相应分块。\n\n这个分块矩阵方程展开为两组方程：\n$1.$ $K_{FF} u_F + K_{FP} u_P = f_F$\n$2.$ $K_{PF} u_F + K_{PP} u_P = f_P$\n\n第一个方程控制未知自由度 $u_F$ 的行为。由于 $u_P$ 中的值是已知的，我们可以重新整理此方程以求解 $u_F$：\n$$\nK_{FF} u_F = f_F - K_{FP} u_P\n$$\n这就是自由自由度的简化线性系统。矩阵 $K_{FF}$ 是通过从 $K$ 中消去对应于给定自由度的行和列得到的。右端项被修正以计入给定值的影响，从而产生一个新的有效载荷向量 $\\hat{f}_F = f_F - K_{FP} u_P$。由于原始矩阵 $K$ 是对称的，其主子矩阵 $K_{FF}$ 也是对称的，因此保持了简化系统的对称性。如果 $K$ 是正定的，那么 $K_{FF}$ 也是正定的，这保证了 $u_F$ 的唯一解。求解 $u_F$ 不需要第二个分块方程，但它可以在之后用于计算与给定自由度相对应的反作用力。\n\n**具体问题应用**\n\n我们得到了一个由 $4 \\times 4$ 矩阵 $K$ 和向量 $f$ 组成的全局系统。自由度划分如下：\n-   自由自由度：$u_F = \\begin{pmatrix} u_2 \\\\ u_3 \\end{pmatrix}$\n-   给定自由度：$u_P = \\begin{pmatrix} u_1 \\\\ u_4 \\end{pmatrix}$，其已知值为 $u_1=0$ 和 $u_4=1$。\n\n我们根据此分块从给定的全局系统中提取子矩阵和子向量。$u_F$ 的索引是 $2$ 和 $3$，$u_P$ 的索引是 $1$ 和 $4$。\n\n子矩阵 $K_{FF}$ 由 $K$ 的第 $2$ 行和第 $3$ 行以及第 $2$ 列和第 $3$ 列组成：\n$$\nK_{FF} = \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}\n$$\n子矩阵 $K_{FP}$ 由 $K$ 的第 $2$ 行和第 $3$ 行以及第 $1$ 列和第 $4$ 列组成：\n$$\nK_{FP} = \\begin{pmatrix} -1 & 0 \\\\ 0 & -1 \\end{pmatrix}\n$$\n载荷向量的相应部分 $f_F$ 由 $f$ 的第 $2$ 行和第 $3$ 行组成：\n$$\nf_F = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n给定值的向量为：\n$$\nu_P = \\begin{pmatrix} u_1 \\\\ u_4 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n现在，我们构建修正后的右端项向量 $\\hat{f}_F = f_F - K_{FP} u_P$：\n$$\n\\hat{f}_F = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} -1 & 0 \\\\ 0 & -1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} (-1)(0) + (0)(1) \\\\ (0)(0) + (-1)(1) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n需要求解的简化系统是 $K_{FF} u_F = \\hat{f}_F$：\n$$\n\\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} \\begin{pmatrix} u_2 \\\\ u_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n这代表了以下二元线性方程组：\n$1.$ $2u_2 - u_3 = 0$\n$2.$ $-u_2 + 2u_3 = 1$\n\n由方程（1），我们用 $u_2$ 表示 $u_3$：\n$$\nu_3 = 2u_2\n$$\n将此表达式代入方程（2）：\n$$\n-u_2 + 2(2u_2) = 1\n$$\n$$\n-u_2 + 4u_2 = 1\n$$\n$$\n3u_2 = 1\n$$\n求解 $u_2$，我们得到：\n$$\nu_2 = \\frac{1}{3}\n$$\n为完整起见，我们也可以求出 $u_3 = 2(\\frac{1}{3}) = \\frac{2}{3}$。自由自由度的解是 $u_F = \\begin{pmatrix} 1/3 \\\\ 2/3 \\end{pmatrix}$。问题只要求 $u_2$ 的值。这个结果与问题 $-u''(x)=0$ 在区域 $[0,1]$ 上，边界条件为 $u(0)=0$ 和 $u(1)=1$ 的精确解析解 $u(x)=x$ 在节点位置 $x_2=1/3$ 处的值是一致的。对于这个特定问题，使用线性单元的有限元法在节点上提供了精确解。", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "2558097"}, {"introduction": "编写有限元代码是一个复杂的过程，其中的错误可能非常微妙且难以发现，因此代码验证至关重要。本练习介绍了“制造解方法”（Method of Manufactured Solutions, MMS），这是科学计算中用于代码验证的黄金标准。通过构建一个已知精确解的问题，MMS 允许我们系统地检验我们的程序是否以理论预期的收敛速度求解了目标偏微分方程。[@problem_id:2558001]", "problem": "考虑二阶线性椭圆型偏微分方程 (PDE)\n$$\n-\\nabla \\cdot \\big(\\kappa(x,y)\\,\\nabla u(x,y)\\big) + u(x,y) = f(x,y)\\quad \\text{在 } \\Omega=(0,1)^2 \\text{ 内},\n$$\n其狄利克雷边界条件为\n$$\nu(x,y) = g(x,y)\\quad \\text{在 } \\partial\\Omega \\text{ 上},\n$$\n其中 $\\kappa(x,y)=1+x+y$ 是一致正且光滑的。假设在一个网格尺寸 $h\\to 0$ 的形状规则、拟一致的网格族上，使用多项式次数为 $k\\in\\{1,2,3\\}$ 的连续拉格朗日单元的协调伽辽金有限元法 (FEM)。目标是通过人造解方法 (MMS) 来验证一个实现，具体步骤为：选择一个人造精确解 $u_{ex}$，推导相应的源项 $f$，指定一致的边界数据 $g$，然后通过实验确认在 $H^1(\\Omega)$ 范数和 $L^2(\\Omega)$ 范数下的预期收敛阶。\n\n在标准正则性假设下，对于多项式次数 $k$，以下哪个选项正确地概述了一个科学上合理的人造解方法 (MMS) 工作流程，该流程将在 $H^1(\\Omega)$ 范数和 $L^2(\\Omega)$ 范数下产生理论上预期的渐近收敛阶？\n\nA. 选择 $u_{ex}(x,y)=\\sin(\\pi x)\\sin(\\pi y)$，定义 $g=u_{ex}|_{\\partial\\Omega}$，并设置\n$$\nf(x,y)=-\\nabla\\cdot\\big(\\kappa(x,y)\\,\\nabla u_{ex}(x,y)\\big)+u_{ex}(x,y).\n$$\n使用精确积分（或足够高阶的数值积分，以使积分误差在渐近上可以忽略不计）来组装协调伽辽金有限元法，求解 $u_h\\in V_h$，并在一个 $h\\to 0$ 的加密序列上测量误差 $\\|u_{ex}-u_h\\|_{H^1(\\Omega)}$ 和 $\\|u_{ex}-u_h\\|_{L^2(\\Omega)}$。在 $u_{ex}\\in H^{k+1}(\\Omega)$ 和充分的椭圆正则性假设下，验证对数-对数图中 $H^1(\\Omega)$ 范数的斜率为 $k$，$L^2(\\Omega)$ 范数的斜率为 $k+1$。\n\nB. 选择 $u_{ex}(x,y)=\\sin(\\pi x)\\sin(\\pi y)$，为方便起见施加齐次边界数据 $g\\equiv 0$，并设置\n$$\nf(x,y)=-\\Delta u_{ex}(x,y)+u_{ex}(x,y),\n$$\n忽略空间变化的系数 $\\kappa$。使用低阶积分以降低成本，加密网格 $h\\to 0$，并验证 $H^1(\\Omega)$ 和 $L^2(\\Omega)$ 误差均以斜率 $k+1$ 收敛。\n\nC. 为测试鲁棒性，选择一个正则性较低的人造解 $u_{ex}(x,y)=\\sqrt{x}\\,\\sin(\\pi y)$，定义 $g=u_{ex}|_{\\partial\\Omega}$ 和 $f=-\\nabla\\cdot(\\kappa\\nabla u_{ex})+u_{ex}$，使用精确组装，并验证 $H^1(\\Omega)$ 和 $L^2(\\Omega)$ 误差仍然分别以斜率 $k$ 和 $k+1$ 收敛，不受 $u_{ex}$ 正则性降低的影响。\n\nD. 选择 $u_{ex}(x,y)=\\sin(\\pi x)\\sin(\\pi y)$，设置 $g=u_{ex}|_{\\partial\\Omega}$，并计算 $f=-\\nabla\\cdot(\\kappa\\nabla u_{ex})+u_{ex}$。为简化起见，在求解过程中用齐次诺伊曼边界条件替换狄利克雷边界条件，然后通过监测最大节点误差 $\\max_i|u_{ex}(x_i)-u_h(x_i)|$ 来验证正确性，期望对所有 $k$ 的斜率均为 $k+1$。\n\n选择正确的选项。", "solution": "科学的伟大任务在于辨别真伪。我们首先验证问题陈述。\n\n### 第 1 步：提取已知条件\n-   **偏微分方程 (PDE)**：$-\\nabla \\cdot \\big(\\kappa(x,y)\\,\\nabla u(x,y)\\big) + u(x,y) = f(x,y)$，在域 $\\Omega=(0,1)^2$ 内。\n-   **系数**：$\\kappa(x,y)=1+x+y$。这是一个光滑函数，对于 $(x,y) \\in \\bar{\\Omega} = [0,1]^2$，有 $1 \\leq \\kappa(x,y) \\leq 3$。一致正性确保算子是椭圆的。\n-   **边界条件**：$u(x,y) = g(x,y)$，在边界 $\\partial\\Omega$ 上（狄利克雷类型）。\n-   **数值方法**：协调伽辽金有限元法 (FEM)。\n-   **有限元空间**：多项式次数为 $k \\in \\{1,2,3\\}$ 的连续拉格朗日单元。\n-   **网格属性**：一个形状规则、拟一致的网格族，网格尺寸 $h$ 趋近于零。\n-   **目标**：确定正确的人造解方法 (MMS) 工作流程，通过确认在 $H^1(\\Omega)$ 和 $L^2(\\Omega)$ 范数下的理论收敛阶来验证一个实现。\n\n### 第 2 步：使用提取的已知条件进行验证\n所给问题是二阶线性椭圆型偏微分方程的一个典型例子，是数值分析研究的基石。人造解方法是科学计算中用于代码验证的标准、严谨的技术。它测试数值实现是否以预期的精度阶正确求解了指定的微分方程。该问题在科学上基于既定的数学和计算原理。所使用的术语精确无歧义。该问题是自洽且适定的。它没有任何验证协议中列出的缺陷。\n\n### 第 3 步：结论与行动\n问题陈述是有效的。它提出了一个在数值软件验证中清晰且标准的任务。我们将继续分析所提出的选项。\n\n### 解题推导\n对于这类椭圆问题，有限元法收敛的理论基础是完善的。设 $u$ 为精确解，$u_h$ 为在网格尺寸为 $h$ 的拟一致网格上，由次数为 $k$ 的连续拉格朗日多项式生成的有限元空间 $V_h$ 中的有限元解。\n\n来自逼近理论的核心结果如下：\n\n1.  **$H^1(\\Omega)$ 范数误差**：Céa 引理将能量范数（对于此问题，它等价于 $H^1(\\Omega)$ 范数）中的误差界定为来自空间 $V_h$ 的最佳逼近误差。如果精确解 $u$ 具有足够的正则性，特别是 $u \\in H^{k+1}(\\Omega)$，那么 $H^1(\\Omega)$ 范数下的误差有如下界：\n    $$\n    \\|u - u_h\\|_{H^1(\\Omega)} \\leq C h^k \\|u\\|_{H^{k+1}(\\Omega)}\n    $$\n    这预测了收敛阶为 $k$，对应于误差对 $h$ 的对数-对数图中斜率为 $k$。\n\n2.  **$L^2(\\Omega)$ 范数误差**：通过 Aubin-Nitsche 对偶论证，可以为 $L^2(\\Omega)$ 范数下的误差建立一个更高阶的收敛阶。该论证依赖于偏微分方程的椭圆正则性（对于在凸域 $\\Omega=(0,1)^2$ 上且具有光滑系数 $\\kappa$ 的本问题，此性质成立）。同样，假设 $u \\in H^{k+1}(\\Omega)$，误差有如下界：\n    $$\n    \\|u - u_h\\|_{L^2(\\Omega)} \\leq C' h^{k+1} \\|u\\|_{H^{k+1}(\\Omega)}\n    $$\n    这预测了收敛阶为 $k+1$，对应于对数-对数图中斜率为 $k+1$。\n\n人造解方法 (MMS) 的构建必须能够创建一个可以凭经验观察到这些理论预测的测试用例。关键步骤是：\n1.  选择一个足够光滑的函数 $u_{ex}$ 作为精确解。“足够光滑”意味着 $u_{ex} \\in H^{k+1}(\\Omega)$，以确保能观察到最优收敛阶。\n2.  将 $u_{ex}$ 代入微分算子以生成相应的源项 $f$。对于算子 $\\mathcal{L}u = -\\nabla \\cdot (\\kappa \\nabla u) + u$，这意味着 $f = \\mathcal{L}u_{ex}$。\n3.  将狄利克雷边界数据 $g$ 设置为人工解在边界上的迹，即 $g = u_{ex}|_{\\partial\\Omega}$。\n4.  使用有限元代码求解在边界 $\\partial\\Omega$ 上满足边界条件 $u_h=g$ 的偏微分方程 $\\mathcal{L}u_h=f$。\n5.  通过在所需的范数下比较数值解 $u_h$ 和已知的精确解 $u_{ex}$ 来计算误差。\n6.  进行网格加密研究，减小 $h$ 并验证计算出的误差是否以理论预测的速率减小。\n\n任何偏离此逻辑顺序的做法都会使验证测试无效。\n\n### 逐项分析\n\n**选项 A：** 该选项精确地遵循了正确的 MMS 流程。\n-   它选择了一个人造解 $u_{ex}(x,y)=\\sin(\\pi x)\\sin(\\pi y)$，该解属于 $C^\\infty$ 类，因此具有绰绰有余的正则性（对于所有 $s > 0$，都有 $u_{ex} \\in H^{s}(\\Omega)$）。\n-   它通过将包括空间变化系数 $\\kappa(x,y)$ 在内的完整微分算子应用于 $u_{ex}$，正确地定义了源项 $f$。\n-   它正确地将边界数据 $g$ 指定为 $u_{ex}$ 在 $\\partial\\Omega$ 上的迹。\n-   它正确地强调了任何数值积分的阶数必须足够高，以免污染离散误差，这是一个至关重要的实践细节。\n-   它正确地陈述了预期的渐近收敛阶：$H^1(\\Omega)$ 范数为 $k$ 阶，$L^2(\\Omega)$ 范数为 $k+1$ 阶。\n\n该工作流程是科学上合理且严谨的。\n**结论：正确**\n\n**选项 B：** 该选项包含多个基本错误。\n-   它建议通过“忽略空间变化的系数 $\\kappa$”来计算源项 $f$。这意味着计算的是 $f = -\\Delta u_{ex} + u_{ex}$，而不是正确的 $f = -\\nabla \\cdot (\\kappa \\nabla u_{ex}) + u_{ex}$。代码将求解一个 $u_{ex}$ 并非其解的问题。误差 $\\|u_{ex} - u_h\\|$ 将无法测试代码对目标偏微分方程的正确性。\n-   它建议使用“低阶积分以降低成本”。低阶积分会引入其自身的误差，该误差很容易主导离散误差，从而掩盖该方法的真实收敛阶。这与验证的目标相矛盾。\n-   它错误地指出 $H^1(\\Omega)$ 和 $L^2(\\Omega)$ 误差均以斜率 $k+1$ 收敛。$H^1(\\Omega)$ 范数的理论收敛阶是 $k$。\n\n该工作流程有严重缺陷。\n**结论：不正确**\n\n**选项 C：** 该选项显示了对解的正则性作用的误解。\n-   它建议选择 $u_{ex}(x,y)=\\sqrt{x}\\,\\sin(\\pi y)$。我们来检查其正则性。对 $x$ 的偏导数为 $\\frac{\\partial u_{ex}}{\\partial x} = \\frac{1}{2\\sqrt{x}}\\sin(\\pi y)$。该导数的 $L^2$ 范数涉及积分 $\\int_0^1 \\frac{1}{x} dx$，该积分是发散的。因此，$u_{ex} \\not\\in H^1(\\Omega)$。\n-   协调有限元法基于 $H^1(\\Omega)$ 子空间上的弱形式。选择一个甚至不属于 $H^1(\\Omega)$ 的人造解，会使该方法的整个理论基础以及因此进行的验证测试都不再适用。\n-   它做出了一个错误的断言，即收敛阶“不受正则性降低的影响”。这是一个严重的理论错误。$k$ 和 $k+1$ 的收convergence阶是*以*解至少具有 $H^{k+1}(\\Omega)$ 正则性为前提的。对于正则性较差的解，观察到的收敛阶会受到该正则性的限制。\n\n该工作流程基于一个谬误的前提。\n**结论：不正确**\n\n**选项 D：** 该选项在边界条件不匹配方面犯了一个关键错误。\n-   它正确地陈述了从 $u_{ex}$ 创建 $f$ 和 $g$ 的初始步骤。\n-   然而，它接着建议用“齐次诺伊曼边界条件”来求解问题，而不是为其构建问题的狄利克雷条件 $u=g$。这意味着代码正在求解一个完全不同的边值问题。数值解 $u_h$ 将收敛到诺伊曼问题的解，而该解不是 $u_{ex}$。测得的误差 $\\|u_{ex} - u_h\\|$ 将不会收敛到零，这个测试完全没有意义。不能通过求解一个诺伊曼问题来验证一个狄利克雷问题的实现。\n-   监测最大节点误差是衡量 $L^\\infty$ 范数收敛性的一种有效方法，但在这里是无关紧要的，因为整个测试设置都是无效的。\n\n该工作流程在逻辑上不一致。\n**结论：不正确**", "answer": "$$\\boxed{A}$$", "id": "2558001"}]}