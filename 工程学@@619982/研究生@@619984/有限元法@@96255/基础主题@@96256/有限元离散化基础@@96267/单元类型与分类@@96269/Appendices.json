{"hands_on_practices": [{"introduction": "有限元分析的基石在于形函数（shape functions）的构造。本练习将引导你亲手构建一个高阶$Q_2$四边形单元的张量积基函数，并用它来插值一个多项式场。这个过程不仅能加深你对拉格朗日插值从一维扩展到多维的理解，还能通过计算验证插值的一个关键理论特性，即当被插值函数本身属于单元的函数空间时，插值结果将精确地复现原函数 [@problem_id:2555221]。", "problem": "考虑参考正方形 $\\hat{\\Omega} = [-1,1] \\times [-1,1]$，其局部坐标为 $(\\xi,\\eta)$。令 $\\mathcal{Q}_p$ 表示张量积拉格朗日四边形单元族，该族由在 $\\xi$ 和 $\\eta$ 方向上次数最高为 $p$ 的所有多项式组成。节点自由度 (DOF) 是在每个坐标方向上 $[-1,1]$ 区间内 $p+1$ 个不同节点的张量积点上的函数值。对于 $p=2$ 的特定情况，在两个坐标方向上均取单变量节点 $\\{-1,0,1\\}$，因此总共有 $9$ 个张量积节点。\n\n仅使用单变量拉格朗日插值的定义属性和张量积构造，完成以下任务：\n\n1) 首先在每个坐标方向上构造单变量拉格朗日基多项式，然后取其乘积，从而构建在 $\\hat{\\Omega}$ 上的 $\\mathcal{Q}_2$ 的张量积基函数。\n\n2) 使用这些基函数和节点自由度，构造二元多项式\n$$\nu(\\xi,\\eta) = \\xi^2 \\eta - \\xi \\eta^2.\n$$\n的 $\\mathcal{Q}_2$ 节点插值 $I_{\\mathcal{Q}_2}u$。通过计算节点自由度并由基函数组装插值函数，来显式计算该插值，然后完全化简结果表达式。\n\n将你的最终结果报告为关于 $(\\xi,\\eta)$ 的单一简化多项式表达式。不需要进行数值舍入。最终答案必须是单一的闭式解析表达式。", "solution": "审阅问题陈述的有效性。\n\n步骤 1：提取已知条件\n- 参考域：正方形 $\\hat{\\Omega} = [-1,1] \\times [-1,1]$，局部坐标为 $(\\xi,\\eta)$。\n- 单元族：$\\mathcal{Q}_p$，张量积拉格朗日四边形单元族。\n- $\\mathcal{Q}_p$ 的多项式空间：在 $\\xi$ 和 $\\eta$ 方向上次数最高为 $p$ 的多项式。\n- 节点自由度 (DOF)：在每个坐标方向上 $[-1,1]$ 区间内 $p+1$ 个不同节点的张量积点上的函数值。\n- 特定情况：$p=2$。\n- $p=2$ 时的单变量节点：在每个坐标方向上为集合 $\\{-1,0,1\\}$。\n- $p=2$ 时的总节点数：$9$ 个张量积节点。\n- 任务 1：构建 $\\mathcal{Q}_2$ 单元的张量积基函数。\n- 任务 2：构造函数 $u(\\xi,\\eta) = \\xi^2 \\eta - \\xi \\eta^2$ 的 $\\mathcal{Q}_2$ 节点插值 $I_{\\mathcal{Q}_2}u$。\n- 要求方法：使用基函数和节点自由度进行显式计算，然后进行完全化简。\n\n步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，是有限元方法理论中的一个标准练习。此问题是适定的，提供了所有必要信息：单元类型 ($\\mathcal{Q}_2$)、参考域、特定节点、待插值函数以及所需的方法。定义和数据是自洽且一致的。函数 $u(\\xi,\\eta) = \\xi^2\\eta - \\xi\\eta^2$ 属于与 $\\mathcal{Q}_2$ 单元关联的多项式空间，该空间是每个变量次数最高为 2 的张量积多项式空间。根据拉格朗日插值的基本性质，一个已在基空间中的函数的插值必须是该函数本身。该问题要求通过显式构造来证明这一结果，这是一个有效且具有指导意义的练习。此问题并非无不足道或不适定。它是一个可形式化和可验证的数学问题。\n\n步骤 3：结论与行动\n问题有效。将按要求构造解答。\n\n解答过程按问题陈述分为两部分。首先，构造基函数。其次，组装并化简插值函数。\n\n第 1 部分：基函数的构建\n\n$\\mathcal{Q}_2$ 单元的基函数是通过在区间 $[-1,1]$ 上次数为 $p=2$ 的单变量拉格朗日基多项式的张量积来构造的。令单变量坐标表示为 $s$。节点为 $s_1 = -1$，$s_2 = 0$ 和 $s_3 = 1$。三个单变量拉格朗日基多项式（对于 $i \\in \\{-1, 0, 1\\}$ 表示为 $l_i(s)$）由属性 $l_i(s_j) = \\delta_{ij}$ 定义，其中 $\\delta_{ij}$ 是克罗内克 delta。\n\n对于一组 $n+1$ 个节点 $\\{x_0, ..., x_n\\}$，第 $k$ 个拉格朗日基多项式的一般公式为 $L_k(x) = \\prod_{j=0, j \\neq k}^{n} \\frac{x-x_j}{x_k-x_j}$。在我们的例子中，$n=2$ 且节点为 $\\{-1, 0, 1\\}$。\n\n对于节点 $s=-1$：\n$$l_{-1}(s) = \\frac{s-0}{-1-0} \\cdot \\frac{s-1}{-1-1} = \\frac{s}{-1} \\cdot \\frac{s-1}{-2} = \\frac{1}{2}s(s-1) = \\frac{1}{2}s^2 - \\frac{1}{2}s$$\n\n对于节点 $s=0$：\n$$l_{0}(s) = \\frac{s-(-1)}{0-(-1)} \\cdot \\frac{s-1}{0-1} = \\frac{s+1}{1} \\cdot \\frac{s-1}{-1} = -(s^2-1) = 1-s^2$$\n\n对于节点 $s=1$：\n$$l_{1}(s) = \\frac{s-(-1)}{1-(-1)} \\cdot \\frac{s-0}{1-0} = \\frac{s+1}{2} \\cdot \\frac{s}{1} = \\frac{1}{2}s(s+1) = \\frac{1}{2}s^2 + \\frac{1}{2}s$$\n\n在 $\\hat{\\Omega}$ 上的 $\\mathcal{Q}_2$ 单元的 $9$ 个二元张量积基函数由 $N_{ij}(\\xi,\\eta) = l_i(\\xi)l_j(\\eta)$ 给出，其中 $i,j \\in \\{-1, 0, 1\\}$。这些函数与 $9$ 个节点 $(\\xi_i, \\eta_j)$ 相关联。\n\n第 2 部分：插值函数的构造与化简\n\n函数 $u(\\xi,\\eta)$ 的节点插值 $I_{\\mathcal{Q}_2}u$ 定义为：\n$$ I_{\\mathcal{Q}_2}u(\\xi,\\eta) = \\sum_{i \\in \\{-1,0,1\\}} \\sum_{j \\in \\{-1,0,1\\}} u(\\xi_i, \\eta_j) N_{ij}(\\xi,\\eta) $$\n其中 $(\\xi_i, \\eta_j)$ 是 $9$ 个节点的网格。待插值的函数为 $u(\\xi,\\eta) = \\xi^2 \\eta - \\xi \\eta^2$。\n\n首先，我们必须计算节点值 $u(\\xi_i, \\eta_j):$\n- $u(-1, -1) = (-1)^2(-1) - (-1)(-1)^2 = -1 - (-1) = 0$\n- $u(-1, 0) = (-1)^2(0) - (-1)(0)^2 = 0 - 0 = 0$\n- $u(-1, 1) = (-1)^2(1) - (-1)(1)^2 = 1 - (-1) = 2$\n- $u(0, -1) = (0)^2(-1) - (0)(-1)^2 = 0 - 0 = 0$\n- $u(0, 0) = (0)^2(0) - (0)(0)^2 = 0 - 0 = 0$\n- $u(0, 1) = (0)^2(1) - (0)(1)^2 = 0 - 0 = 0$\n- $u(1, -1) = (1)^2(-1) - (1)(-1)^2 = -1 - 1 = -2$\n- $u(1, 0) = (1)^2(0) - (1)(0)^2 = 0 - 0 = 0$\n- $u(1, 1) = (1)^2(1) - (1)(1)^2 = 1 - 1 = 0$\n\n唯一非零的节点值是 $u(-1,1)=2$ 和 $u(1,-1)=-2$。因此，插值函数的求和简化为仅有两项：\n$$ I_{\\mathcal{Q}_2}u(\\xi,\\eta) = u(-1,1) N_{-1,1}(\\xi,\\eta) + u(1,-1) N_{1,-1}(\\xi,\\eta) $$\n$$ I_{\\mathcal{Q}_2}u(\\xi,\\eta) = 2 \\cdot N_{-1,1}(\\xi,\\eta) - 2 \\cdot N_{1,-1}(\\xi,\\eta) $$\n\n现在我们代入相应基函数的表达式：\n$N_{-1,1}(\\xi,\\eta) = l_{-1}(\\xi) l_1(\\eta) = \\left(\\frac{1}{2}\\xi(\\xi-1)\\right) \\left(\\frac{1}{2}\\eta(\\eta+1)\\right) = \\frac{1}{4}\\xi\\eta(\\xi-1)(\\eta+1)$\n$N_{1,-1}(\\xi,\\eta) = l_1(\\xi) l_{-1}(\\eta) = \\left(\\frac{1}{2}\\xi(\\xi+1)\\right) \\left(\\frac{1}{2}\\eta(\\eta-1)\\right) = \\frac{1}{4}\\xi\\eta(\\xi+1)(\\eta-1)$\n\n将这些代入插值公式：\n$$ I_{\\mathcal{Q}_2}u(\\xi,\\eta) = 2 \\left( \\frac{1}{4}\\xi\\eta(\\xi-1)(\\eta+1) \\right) - 2 \\left( \\frac{1}{4}\\xi\\eta(\\xi+1)(\\eta-1) \\right) $$\n$$ I_{\\mathcal{Q}_2}u(\\xi,\\eta) = \\frac{1}{2}\\xi\\eta \\left[ (\\xi-1)(\\eta+1) - (\\xi+1)(\\eta-1) \\right] $$\n\n现在，化简方括号内的表达式：\n$$ (\\xi-1)(\\eta+1) = \\xi\\eta + \\xi - \\eta - 1 $$\n$$ (\\xi+1)(\\eta-1) = \\xi\\eta - \\xi + \\eta - 1 $$\n差值为：\n$$ (\\xi\\eta + \\xi - \\eta - 1) - (\\xi\\eta - \\xi + \\eta - 1) = \\xi\\eta + \\xi - \\eta - 1 - \\xi\\eta + \\xi - \\eta + 1 = 2\\xi - 2\\eta = 2(\\xi-\\eta) $$\n将此结果代回插值函数的表达式中：\n$$ I_{\\mathcal{Q}_2}u(\\xi,\\eta) = \\frac{1}{2}\\xi\\eta \\left[ 2(\\xi-\\eta) \\right] $$\n$$ I_{\\mathcal{Q}_2}u(\\xi,\\eta) = \\xi\\eta(\\xi-\\eta) $$\n最后，展开此表达式得到简化的多项式形式：\n$$ I_{\\mathcal{Q}_2}u(\\xi,\\eta) = \\xi^2\\eta - \\xi\\eta^2 $$\n此结果与原始函数 $u(\\xi,\\eta)$ 完全相同，这是预期的结果，因为 $u(\\xi,\\eta)$ 是由 $\\mathcal{Q}_2$ 基函数所张成的多项式空间中的一个元素。显式构造证实了插值的理论性质。", "answer": "$$\n\\boxed{\\xi^{2}\\eta - \\xi\\eta^{2}}\n$$", "id": "2555221"}, {"introduction": "构建一个单元后，我们如何确保其能正确地用于物理分析？补丁测试（patch test）是验证单元性能的一个基本且至关重要的工具。在本练习中，你将对一个由$Q_1$单元组成的简单网格施加一个线性位移场，并通过计算证明其节点力残差精确为零 [@problem_id:2555200]。这个结果直接验证了单元的线性完备性（completeness），即它能够精确表示常应变状态，这是保证有限元解收敛性的理论基石。", "problem": "考虑对一个二维线性弹性平面应变体应用有限元法 (FEM)，该物体占据由三个单元组成的L形区域\n$$\\Omega = \\big([0,1] \\times [0,1]\\big) \\cup \\big([1,2] \\times [0,1]\\big) \\cup \\big([0,1] \\times [1,2]\\big),$$\n该区域由三个等参双线性四边形单元组成，通常记为 $Q_1$ 四边形族。设节点集为八个角点\n$$(0,0),\\ (1,0),\\ (2,0),\\ (0,1),\\ (1,1),\\ (2,1),\\ (0,2),\\ (1,2),$$\n单元连接关系（逆时针）如下：\n$$\\text{单元 } 1:\\ (0,0)\\text{-}(1,0)\\text{-}(1,1)\\text{-}(0,1),$$\n$$\\text{单元 } 2:\\ (1,0)\\text{-}(2,0)\\text{-}(2,1)\\text{-}(1,1),$$\n$$\\text{单元 } 3:\\ (0,1)\\text{-}(1,1)\\text{-}(1,2)\\text{-}(0,2).$$\n假设在平面应变条件下，材料服从各向同性、均匀的线性弹性本构律，其 Lamé 参数为 $\\lambda>0$ 和 $\\mu>0$，Cauchy 应力张量 $\\boldsymbol{\\sigma}$ 和小应变张量 $\\boldsymbol{\\varepsilon}$ 之间的关系由 $\\boldsymbol{\\sigma} = \\lambda \\,\\mathrm{tr}(\\boldsymbol{\\varepsilon})\\mathbf{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}$ 给出。不存在体力，即 $\\mathbf{b}=\\mathbf{0}$。\n\n给定精确的线性位移场\n$$\\mathbf{u}(x,y) = \\begin{pmatrix} 1 + 2x - 3y \\\\ -2 + 4x + y \\end{pmatrix},$$\n并在该区域的外边界 $\\Gamma$ 上施加 Neumann 牵引力 $\\mathbf{t} = \\boldsymbol{\\sigma}(\\mathbf{u})\\,\\mathbf{n}$，其中 $\\mathbf{n}$ 是外法向单位向量。使用标准等参 $Q_1$ 单元，对单元域积分采用完全的 $2 \\times 2$ Gauss 积分，并对每个边界边采用标准的 $2$ 点 Gauss 积分来计算一致性节点牵引力。\n\n令 $\\mathbf{d}$ 为通过在区域节点处对 $\\mathbf{u}(x,y)$ 采样而获得的节点位移值向量。组装全局内部节点力向量\n$$\\mathbf{f}_{\\mathrm{int}} = \\sum_{e} \\int_{\\Omega_e} \\mathbf{B}_e(\\mathbf{x})^{\\top}\\,\\boldsymbol{\\sigma}(\\mathbf{u}_h)\\, \\mathrm{d}\\Omega,$$\n和全局外部节点力向量\n$$\\mathbf{f}_{\\mathrm{ext}} = \\int_{\\Gamma} \\mathbf{N}(\\mathbf{x})^{\\top}\\,\\mathbf{t} \\,\\mathrm{d}\\Gamma,$$\n其中 $\\mathbf{u}_h$ 是从 $\\mathbf{d}$ 插值得到的有限元位移场，$\\mathbf{B}_e$ 是应用于单元形函数的对称梯度算子，$\\mathbf{N}$ 是将节点值映射到边界位移的形函数矩阵。定义全局残差\n$$\\mathbf{r} = \\mathbf{f}_{\\mathrm{int}} - \\mathbf{f}_{\\mathrm{ext}}.$$\n\n在给定的数据和数值积分规则下，计算这个三单元区域的全局残差的欧几里得范数 $\\|\\mathbf{r}\\|_{2}$。请将最终答案表示为一个无量纲实数。无需四舍五入；请提供精确值。", "solution": "我们从第一性原理出发：无体力的线性弹性体的平衡强形式为\n$$\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{u}) = \\mathbf{0} \\ \\text{in}\\ \\Omega,$$\n在 Neumann 边界部分 $\\Gamma$ 上的边界条件由以下公式给出\n$$\\mathbf{t} = \\boldsymbol{\\sigma}(\\mathbf{u})\\,\\mathbf{n} \\ \\text{on}\\ \\Gamma.$$\n平面应变下的本构律为\n$$\\boldsymbol{\\sigma}(\\mathbf{u}) = \\lambda \\,\\mathrm{tr}(\\boldsymbol{\\varepsilon}(\\mathbf{u}))\\mathbf{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}(\\mathbf{u}), \\quad \\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\tfrac{1}{2}\\big(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\top}\\big).$$\n\n步骤 $1$：证明精确场是线性的，并产生恒定的应变和应力。给定的位移场为\n$$\\mathbf{u}(x,y) = \\begin{pmatrix} 1 + 2x - 3y \\\\ -2 + 4x + y \\end{pmatrix},$$\n该位移场关于 $x$ 和 $y$ 是线性的。其梯度为常数：\n$$\\nabla \\mathbf{u} = \\begin{pmatrix} \\partial_x u_x & \\partial_y u_x \\\\ \\partial_x u_y & \\partial_y u_y \\end{pmatrix} = \\begin{pmatrix} 2 & -3 \\\\ 4 & 1 \\end{pmatrix}.$$\n因此，小应变张量为常数：\n$$\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\tfrac{1}{2}\\big(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\top}\\big) = \\tfrac{1}{2} \\begin{pmatrix} 2+2 & -3+4 \\\\ -3+4 & 1+1 \\end{pmatrix} = \\begin{pmatrix} 2 & \\tfrac{1}{2} \\\\ \\tfrac{1}{2} & 1 \\end{pmatrix}.$$\n因此 Cauchy 应力张量 $\\boldsymbol{\\sigma}(\\mathbf{u})$ 在 $\\Omega$ 内是常数：\n$$\\boldsymbol{\\sigma}(\\mathbf{u}) = \\lambda \\,\\mathrm{tr}(\\boldsymbol{\\varepsilon}(\\mathbf{u}))\\mathbf{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\lambda \\,(3)\\,\\mathbf{I} + 2\\mu \\begin{pmatrix} 2 & \\tfrac{1}{2} \\\\ \\tfrac{1}{2} & 1 \\end{pmatrix} = \\begin{pmatrix} 3\\lambda + 4\\mu & \\mu \\\\ \\mu & 3\\lambda + 2\\mu \\end{pmatrix}.$$\n由于 $\\boldsymbol{\\sigma}$ 是常数，其散度为零：\n$$\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{u}) = \\mathbf{0}.$$\n\n步骤 $2$：在直角网格上，使用等参双线性四边形 ($Q_1$) 进行插值可以精确地再现任何线性场。当单元映射是仿射的时，每个单元上的 $Q_1$ 形函数可以张成所有关于 $x$ 和 $y$ 至多为线性的多项式。在当前区域中，每个单元都是一个矩形，因此从母单元坐标到全局坐标的等参映射是仿射的，且其 Jacobian 矩阵为常数。因此，从 $\\mathbf{u}(x,y)$ 采样得到的节点值 $\\mathbf{d}$ 构建的有限元插值函数 $\\mathbf{u}_h$ 满足\n$$\\mathbf{u}_h(\\mathbf{x}) \\equiv \\mathbf{u}(\\mathbf{x}) \\ \\text{for all}\\ \\mathbf{x} \\in \\Omega,$$\n从而\n$$\\boldsymbol{\\varepsilon}(\\mathbf{u}_h) \\equiv \\boldsymbol{\\varepsilon}(\\mathbf{u}), \\quad \\boldsymbol{\\sigma}(\\mathbf{u}_h) \\equiv \\boldsymbol{\\sigma}(\\mathbf{u}),$$\n它们在每个单元上都是常数，并且在这里，在整个 $\\Omega$ 上是全局常数。\n\n步骤 $3$：在完全积分下，单元层级的内力和边界牵引力。单元 $e$ 的内力向量可以写为\n$$\\mathbf{f}_{\\mathrm{int}}^{(e)} = \\int_{\\Omega_e} \\mathbf{B}_e(\\mathbf{x})^{\\top}\\,\\boldsymbol{\\sigma}(\\mathbf{u}_h)\\,\\mathrm{d}\\Omega,$$\n其中 $\\mathbf{B}_e$ 汇集了 $Q_1$ 形函数的对称梯度。在矩形单元上，$\\mathbf{B}_e(\\mathbf{x})$ 在母单元坐标中至多是线性的，而 $\\boldsymbol{\\sigma}(\\mathbf{u}_h)$ 是常数。因此，被积函数在每个母单元坐标中至多是线性的。在矩形上的完全 $2 \\times 2$ Gauss 积分可以精确地积分任何在每个母单元坐标中至多是三次的多项式被积函数，因此这个域积分可以被精确计算。类似地，沿着每个边界边的一致性外部节点力为\n$$\\mathbf{f}_{\\mathrm{ext}} = \\int_{\\Gamma} \\mathbf{N}(\\mathbf{x})^{\\top}\\,\\mathbf{t}\\,\\mathrm{d}\\Gamma = \\sum_{\\text{edges}} \\int_{\\Gamma_{\\text{edge}}} \\mathbf{N}(\\mathbf{x})^{\\top}\\,\\boldsymbol{\\sigma}(\\mathbf{u})\\,\\mathbf{n}\\,\\mathrm{d}\\Gamma,$$\n其中 $\\mathbf{N}$ 在每条直边上是线性的。由于 $\\mathbf{t}$ 在每条直边上是常数（因为 $\\boldsymbol{\\sigma}(\\mathbf{u})$ 是常数，$\\mathbf{n}$ 在直边上也是常数），被积函数在每条边上是线性的，而边上的标准 $2$ 点 Gauss 求积可以精确地积分它。\n\n步骤 $4$：通过散度定理实现节点平衡。对于由 $Q_1$ 基张成的任何节点检验函数向量 $\\mathbf{w}_h$，其弱形式为\n$$\\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\mathbf{w}_h) : \\boldsymbol{\\sigma}(\\mathbf{u}_h)\\,\\mathrm{d}\\Omega - \\int_{\\Gamma} \\mathbf{w}_h \\cdot \\mathbf{t}\\,\\mathrm{d}\\Gamma = 0.$$\n依次选择 $\\mathbf{w}_h$ 为每个典则节点基向量，即可得到组装后的残差分量。由于 $\\boldsymbol{\\sigma}(\\mathbf{u}_h)$ 是常数且满足 $\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{u}_h) = \\mathbf{0}$，对于每个标量形函数 $N_i$ 和每个笛卡尔分量，根据散度定理可得：\n$$\\int_{\\Omega} \\nabla N_i \\cdot \\boldsymbol{\\sigma}(\\mathbf{u}_h)\\,\\mathbf{e}_k\\,\\mathrm{d}\\Omega = \\int_{\\Gamma} N_i \\,\\mathbf{e}_k \\cdot \\boldsymbol{\\sigma}(\\mathbf{u}_h)\\,\\mathbf{n}\\,\\mathrm{d}\\Gamma - \\int_{\\Omega} N_i \\,\\nabla \\cdot \\big(\\boldsymbol{\\sigma}(\\mathbf{u}_h)\\,\\mathbf{e}_k\\big)\\,\\mathrm{d}\\Omega = \\int_{\\Gamma} N_i \\,\\mathbf{t}_k\\,\\mathrm{d}\\Gamma,$$\n其中 $\\mathbf{e}_k$ 是第 $k$ 个单位向量，$\\mathbf{t}_k$ 是 $\\mathbf{t}$ 的第 $k$ 个分量。因此，在连续层面上，每个残差分量都精确为零。因为域积分和边界积分都通过所选的完全积分规则（如步骤 $3$ 所示）被精确计算，所以离散的组装残差向量等于精确的连续残差，因此\n$$\\mathbf{r} = \\mathbf{f}_{\\mathrm{int}} - \\mathbf{f}_{\\mathrm{ext}} = \\mathbf{0}.$$\n\n步骤 $5$：残差的欧几里得范数。由于 $\\mathbf{r}=\\mathbf{0}$，其欧几里得范数为\n$$\\|\\mathbf{r}\\|_{2} = 0.$$\n\n这个结论取决于三个事实：矩形上 $Q_1$ 四边形空间的线性完备性、线性位移场下精确应力的恒定性，以及指定的完全 Gauss 求积规则对所得多项式被积函数的精确性。因此，所要求的无量纲标量精确为零。", "answer": "$$\\boxed{0}$$", "id": "2555200"}, {"introduction": "在追求计算效率时，我们常采用减缩积分（reduced integration），但这可能导致单元产生非物理的、零能量的变形模式，即所谓的“沙漏模式”（hourglass modes）。本练习将带你深入这一高级主题，亲手识别一个欠积分四边形单元中的沙漏模式，并推导出一个稳定项参数$\\alpha$以恢复单元的刚度 [@problem_id:2555223]。掌握沙漏控制技术对于开发在实际工程中既高效又可靠的有限元模型至关重要。", "problem": "考虑一个二维线性弹性平面应变问题中的单个等参双线性四边形单元（通常表示为 $Q4$ 单元）。该单元为边长为 $L$ 的正方形，其节点从左下角开始逆时针标记，物理坐标为 $\\{(0,0),\\,(L,0),\\,(L,L),\\,(0,L)\\}$。材料是均匀且各向同性的，其 Lamé 参数为 $\\lambda$ 和 $\\mu$，应变能密度由标准线性弹性形式给出。在有限元法（FEM）中，使用单点高斯积分（减缩积分）计算的单元刚度是秩亏的，并会容许虚假的零能“沙漏”模式。\n\n从母单元正方形 $\\{(\\xi,\\eta)\\in[-1,1]^{2}\\}$ 上的双线性形函数、到物理单元的等参映射、小应变张量 $\\boldsymbol{\\varepsilon}=\\nabla^{s}\\boldsymbol{u}$ 以及弹性势能密度 $w(\\boldsymbol{\\varepsilon})=\\mu\\,\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon}+\\frac{\\lambda}{2}(\\operatorname{tr}\\boldsymbol{\\varepsilon})^{2}$ 的定义出发。请遵循以下步骤。\n\n1) 识别出由单点减缩积分 $Q4$ 单元刚度所容许的两个线性无关、非刚体的零能位移模式（沙漏模式）。具体而言，寻找节点位移向量 $\\boldsymbol{u}_{\\mathrm{hg}}$，使得在单元形心处计算的常应变算子作用于其上结果为零，即，由形心应变-位移矩阵计算出的三个应变分量均为零。\n\n2) 定义一个单元级稳定化泛函，该泛函通过沙漏广义坐标\n$$\nq_{1}=\\frac{u_{1x}-u_{2x}+u_{3x}-u_{4x}}{2},\\qquad\nq_{2}=\\frac{u_{1y}-u_{2y}+u_{3y}-u_{4y}}{2},\n$$\n和一个附加的稳定化能\n$$\nE_{\\mathrm{stab}}=\\alpha\\left(q_{1}^{2}+q_{2}^{2}\\right),\n$$\n来惩罚这两种沙漏模式，其中 $\\alpha$ 是一个待选的标量稳定化参数。\n\n3) 通过以下矫顽性恢复和一致性匹配准则来确定 $\\alpha$：对于第 (1) 部分中的每一种沙漏位移模式，添加到减缩积分单元上的稳定化能 $E_{\\mathrm{stab}}$ 必须等于通过对具有相应节点值的双线性位移场相关的弹性势能密度进行完全积分（使用 $2\\times 2$ 高斯积分法则）所得到的精确单元应变能。\n\n将您的最终答案表示为 $\\alpha$ 关于 $\\lambda$ 和 $\\mu$ 的单个闭式表达式。不需要数值近似或四舍五入，最终方框内的答案中不应包含单位。", "solution": "对问题陈述进行验证。\n\n**第 1 步：提取已知条件**\n- 单元：单个等参双线性四边形 ($Q4$) 单元。\n- 物理背景：二维线性弹性，平面应变条件。\n- 几何形状：边长为 $L$ 的正方形单元，节点 1-4 的物理坐标分别为 $(0,0)$、$(L,0)$、$(L,L)$ 和 $(0,L)$。\n- 材料：均匀、各向同性，Lamé 参数为 $\\lambda$ 和 $\\mu$。\n- 应变能密度：$w(\\boldsymbol{\\varepsilon})=\\mu\\,\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon}+\\frac{\\lambda}{2}(\\operatorname{tr}\\boldsymbol{\\varepsilon})^{2}$。\n- 有限元步骤：使用单点高斯积分，即减缩积分。\n- 任务：确定沙漏控制方案的稳定化参数 $\\alpha$。\n- 沙漏坐标：$q_{1}=\\frac{u_{1x}-u_{2x}+u_{3x}-u_{4x}}{2}$ 和 $q_{2}=\\frac{u_{1y}-u_{2y}+u_{3y}-u_{4y}}{2}$。\n- 稳定化能：$E_{\\mathrm{stab}}=\\alpha\\left(q_{1}^{2}+q_{2}^{2}\\right)$。\n- $\\alpha$ 的确定准则：对于两种基本的沙漏位移模式，稳定化能 $E_{\\mathrm{stab}}$ 必须等于使用完全 $2 \\times 2$ 高斯积分计算出的精确单元应变能。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据充足：** 该问题是有限元法理论中的一个经典基础课题。等参映射、平面应变弹性、减缩积分和沙漏不稳定性等概念在计算力学中是标准内容。所有给定的公式都是正确且成熟的。\n- **问题适定：** 该问题定义明确。它提供了清晰的步骤和特定的准则来确定参数 $\\alpha$ 的唯一值。所有必要信息均已提供。\n- **客观性：** 语言形式化、精确，没有任何主观或模糊的陈述。\n\n**第 3 步：结论与行动**\n该问题是有效的。可以构建一个严谨的解。\n\n**求解推导**\n\n求解过程需要通过将给定的稳定化能与沙漏变形模式的精确弹性势能相匹配来确定稳定化参数 $\\alpha$。我们假设平面应变单元的厚度为单位厚度，因此所有“能量”计算均指单位厚度的能量。\n\n首先，我们建立物理坐标 $(x,y)$ 和母单元坐标 $(\\xi, \\eta) \\in [-1,1]^2$ 之间的关系。双线性形函数为 $N_{1}(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_{2}(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_{3}(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$ 和 $N_{4}(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$。对于给定的正方形单元，等参映射 $x(\\xi,\\eta) = \\sum_i N_i(\\xi, \\eta) x_i$ 和 $y(\\xi,\\eta) = \\sum_i N_i(\\xi, \\eta) y_i$ 得到：\n$$x(\\xi,\\eta) = \\frac{L}{2}(1+\\xi)$$\n$$y(\\xi,\\eta) = \\frac{L}{2}(1+\\eta)$$\n此变换的雅可比矩阵是常数：\n$$\\boldsymbol{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{L}{2} & 0 \\\\ 0 & \\frac{L}{2} \\end{pmatrix}$$\n其行列式为 $\\det(\\boldsymbol{J}) = \\frac{L^2}{4}$，逆矩阵为 $\\boldsymbol{J}^{-1} = \\frac{2}{L}\\boldsymbol{I}$。\n\n沙漏模式是在单元中心 $(\\xi, \\eta) = (0,0)$ 处产生零应变的位移模式。这些模式与项 $\\xi\\eta$ 成正比，该项在坐标轴 $\\xi=0$ 和 $\\eta=0$ 上为零。基本沙漏形函数 $N_{\\mathrm{hg}}(\\xi,\\eta)$ 由以下线性组合给出：\n$$N_{\\mathrm{hg}}(\\xi,\\eta) = N_1 - N_2 + N_3 - N_4 = \\xi\\eta$$\n相应的节点向量为 $\\boldsymbol{h}^{*} = (1, -1, 1, -1)^T$。\n\n一个由广义坐标 $q_1$ 和 $q_2$ 表征的一般沙漏位移场可以写成：\n$$u_x(\\xi, \\eta) = c_1 N_{\\mathrm{hg}}(\\xi,\\eta) = c_1 \\xi\\eta$$\n$$u_y(\\xi, \\eta) = c_2 N_{\\mathrm{hg}}(\\xi,\\eta) = c_2 \\xi\\eta$$\n振幅 $c_1$ 和 $c_2$ 与 $q_1$ 和 $q_2$ 相关。节点位移为 $u_{ix} = c_1 (\\xi_i \\eta_i) = c_1 h^*_i$ 和 $u_{iy} = c_2 (\\xi_i \\eta_i) = c_2 h^*_i$。\n使用 $q_1$ 和 $q_2$ 的定义：\n$$q_1 = \\frac{1}{2}\\sum_{i=1}^4 h^*_i u_{ix} = \\frac{1}{2}\\sum_{i=1}^4 h^*_i (c_1 h^*_i) = \\frac{c_1}{2}\\sum_{i=1}^4 (h^*_i)^2 = \\frac{c_1}{2}(4) = 2c_1 \\implies c_1 = \\frac{q_1}{2}$$\n$$q_2 = \\frac{1}{2}\\sum_{i=1}^4 h^*_i u_{iy} = \\frac{1}{2}\\sum_{i=1}^4 h^*_i (c_2 h^*_i) = \\frac{c_2}{2}\\sum_{i=1}^4 (h^*_i)^2 = 2c_2 \\implies c_2 = \\frac{q_2}{2}$$\n因此，沙漏位移场为：\n$$u_x(\\xi,\\eta) = \\frac{q_1}{2}\\xi\\eta, \\quad u_y(\\xi,\\eta) = \\frac{q_2}{2}\\xi\\eta$$\n其中 $q_1$ 和 $q_2$ 具有长度单位。\n\n接下来，我们计算该位移场对应的应变张量场 $\\boldsymbol{\\varepsilon}$。\n梯度算子为 $\\nabla_{\\boldsymbol{x}} = \\boldsymbol{J}^{-T} \\nabla_{\\boldsymbol{\\xi}} = \\frac{2}{L}\\nabla_{\\boldsymbol{\\xi}}$。\n$$\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = \\frac{2}{L}\\frac{\\partial u_x}{\\partial\\xi} = \\frac{2}{L}\\left(\\frac{q_1}{2}\\eta\\right) = \\frac{q_1\\eta}{L}$$\n$$\\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = \\frac{2}{L}\\frac{\\partial u_y}{\\partial\\eta} = \\frac{2}{L}\\left(\\frac{q_2}{2}\\xi\\right) = \\frac{q_2\\xi}{L}$$\n$$2\\varepsilon_{xy} = \\gamma_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} = \\frac{2}{L}\\left(\\frac{\\partial u_x}{\\partial\\eta} + \\frac{\\partial u_y}{\\partial\\xi}\\right) = \\frac{2}{L}\\left(\\frac{q_1}{2}\\xi + \\frac{q_2}{2}\\eta\\right) = \\frac{q_1\\xi + q_2\\eta}{L}$$\n因此，$\\varepsilon_{xy} = \\frac{q_1\\xi + q_2\\eta}{2L}$。应变是正确的无量纲量。\n\n现在我们计算应变能密度 $w(\\boldsymbol{\\varepsilon})$。\n$$\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\varepsilon_{xx} + \\varepsilon_{yy} = \\frac{q_1\\eta + q_2\\xi}{L}$$\n$$\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon} = \\varepsilon_{xx}^2 + \\varepsilon_{yy}^2 + 2\\varepsilon_{xy}^2 = \\left(\\frac{q_1\\eta}{L}\\right)^2 + \\left(\\frac{q_2\\xi}{L}\\right)^2 + 2\\left(\\frac{q_1\\xi + q_2\\eta}{2L}\\right)^2$$\n$$w = \\mu \\left[ \\frac{q_1^2\\eta^2}{L^2} + \\frac{q_2^2\\xi^2}{L^2} + \\frac{(q_1\\xi + q_2\\eta)^2}{2L^2} \\right] + \\frac{\\lambda}{2} \\frac{(q_1\\eta + q_2\\xi)^2}{L^2}$$\n$$w = \\frac{1}{L^2} \\left\\{ \\mu \\left( q_1^2\\eta^2 + q_2^2\\xi^2 + \\frac{1}{2}(q_1^2\\xi^2 + q_2^2\\eta^2 + 2q_1q_2\\xi\\eta) \\right) + \\frac{\\lambda}{2} (q_1^2\\eta^2 + q_2^2\\xi^2 + 2q_1q_2\\xi\\eta) \\right\\}$$\n合并 $\\xi^2$、$\\eta^2$ 和 $\\xi\\eta$ 的项：\n$$w = \\frac{1}{L^2} \\left\\{ \\xi^2\\left(\\mu q_2^2 + \\frac{\\mu}{2}q_1^2 + \\frac{\\lambda}{2}q_2^2\\right) + \\eta^2\\left(\\mu q_1^2 + \\frac{\\mu}{2}q_2^2 + \\frac{\\lambda}{2}q_1^2\\right) + \\xi\\eta\\left(\\mu q_1q_2 + \\lambda q_1q_2\\right) \\right\\}$$\n单元总应变能（单位厚度）为 $E_{\\mathrm{exact}} = \\int_A w \\, dA = \\int_{-1}^1 \\int_{-1}^1 w(\\xi,\\eta) \\det(\\boldsymbol{J}) \\,d\\xi d\\eta$。由于 $\\det(\\boldsymbol{J}) = L^2/4$：\n$$E_{\\mathrm{exact}} = \\frac{L^2}{4} \\int_{-1}^1 \\int_{-1}^1 w(\\xi,\\eta) \\,d\\xi d\\eta$$\n$L^2$ 项相互抵消。我们使用积分 $\\int_{-1}^1 \\int_{-1}^1 \\xi^2 \\,d\\xi d\\eta = \\frac{4}{3}$、$\\int_{-1}^1 \\int_{-1}^1 \\eta^2 \\,d\\xi d\\eta = \\frac{4}{3}$ 以及 $\\int_{-1}^1 \\int_{-1}^1 \\xi\\eta \\,d\\xi d\\eta = 0$。\n含有 $\\xi\\eta$ 的项积分为零。\n$$E_{\\mathrm{exact}} = \\frac{1}{4} \\left[ \\frac{4}{3}\\left(\\mu q_2^2 + \\frac{\\mu}{2}q_1^2 + \\frac{\\lambda}{2}q_2^2\\right) + \\frac{4}{3}\\left(\\mu q_1^2 + \\frac{\\mu}{2}q_2^2 + \\frac{\\lambda}{2}q_1^2\\right) \\right]$$\n$$E_{\\mathrm{exact}} = \\frac{1}{3} \\left[ q_1^2\\left(\\frac{\\mu}{2}+\\mu+\\frac{\\lambda}{2}\\right) + q_2^2\\left(\\mu+\\frac{\\lambda}{2}+\\frac{\\mu}{2}\\right) \\right]$$\n$$E_{\\mathrm{exact}} = \\frac{1}{3} \\left[ q_1^2\\left(\\frac{3\\mu+\\lambda}{2}\\right) + q_2^2\\left(\\frac{3\\mu+\\lambda}{2}\\right) \\right]$$\n$$E_{\\mathrm{exact}} = \\left(\\frac{3\\mu+\\lambda}{6}\\right) (q_1^2 + q_2^2)$$\n稳定化能由 $E_{\\mathrm{stab}} = \\alpha (q_1^2 + q_2^2)$ 给出。匹配准则要求 $E_{\\mathrm{stab}} = E_{\\mathrm{exact}}$。\n$$\\alpha (q_1^2 + q_2^2) = \\left(\\frac{3\\mu+\\lambda}{6}\\right) (q_1^2 + q_2^2)$$\n这直接得出了稳定化参数 $\\alpha$ 的表达式。\n$$\\alpha = \\frac{3\\mu+\\lambda}{6} = \\frac{\\mu}{2} + \\frac{\\lambda}{6}$$\n该结果与单元尺寸 $L$ 以及 $q_1$ 和 $q_2$ 的具体值无关，这正是一个基于材料的稳定化参数所应具备的特性。", "answer": "$$\\boxed{\\frac{\\lambda+3\\mu}{6}}$$", "id": "2555223"}]}