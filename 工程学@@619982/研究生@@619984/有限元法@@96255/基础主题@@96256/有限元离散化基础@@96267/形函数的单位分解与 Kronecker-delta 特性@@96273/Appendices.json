{"hands_on_practices": [{"introduction": "有限元方法中最基本的构件是线性单元。本练习将引导你从第一性原理出发，为一个简单的三角形单元推导出形函数。然后，你将利用这些形函数来验证其对线性函数的插值是精确的，这一重要特性正是单位分解性质的直接体现 [@problem_id:2586144]。", "problem": "设平面内一个三角形的顶点为 $V_{1}=(1,2)$、$V_{2}=(4,3)$ 和 $V_{3}=(2,6)$。考虑在该三角形上用于有限元方法（FEM, finite element method）的线性拉格朗日元，其中节点形函数 $\\{N_{i}(x,y)\\}_{i=1}^{3}$ 是三角形上的仿射函数，并满足克罗内克-德尔塔性质 $N_{i}(V_{j})=\\delta_{ij}$ 和单位分解性质 $\\sum_{i=1}^{3}N_{i}(x,y)=1$。设点 $P$ 的坐标为 $P=\\left(\\frac{11}{4},\\frac{7}{2}\\right)$，该点严格位于三角形内部。\n\n任务：\n- 从三角形上线性拉格朗日形函数的定义性质（在单元上是仿射的、在顶点处满足克罗内克-德尔塔性质、以及单位分解）出发，构造 $N_{1}(x,y)$、$N_{2}(x,y)$ 和 $N_{3}(x,y)$ 的显式表达式。证明它们满足单位分解和克罗内克-德尔塔性质。\n- 计算点 $P$ 相对于该三角形的重心坐标，其定义为 $\\lambda_{i}=N_{i}(P)$，其中 $i\\in\\{1,2,3\\}$。\n- 设 $g(x,y)\\equiv c$ 为任意常数函数（常数 $c\\in\\mathbb{R}$），并设 $\\ell(x,y)=3x-2y+1$ 为一个线性函数。使用该单元上的节点插值算子 $I_{h}f(x,y)=\\sum_{i=1}^{3}N_{i}(x,y)f(V_{i})$，计算 $I_{h}g(P)$ 和 $I_{h}\\ell(P)$ 的值，并通过与 $g(P)$ 和 $\\ell(P)$ 比较来验证其精确性。\n\n请给出在点 $P$ 处插值线性函数的值，即 $I_{h}\\ell(P)$，作为您的最终答案，并以精确分数形式表示。不包含单位。无需四舍五入。", "solution": "所给问题是有限元方法中的一道标准练习题，其提法适定，具有科学依据，并包含了获得唯一解所需的所有信息。我们将分三个阶段进行所需的计算。\n\n首先，我们构造 $i \\in \\{1, 2, 3\\}$ 的线性拉格朗日形函数 $N_{i}(x,y)$。三角形上的一个线性形函数是 $N_{i}(x,y) = a_{i}x + b_{i}y + c_{i}$ 形式的仿射函数。系数 $(a_{i}, b_{i}, c_{i})$ 通过施加克罗内克-德尔塔性质 $N_{i}(V_{j}) = \\delta_{ij}$ 来确定，其中 $V_{j}$ 是三角形的顶点。给定的顶点为 $V_{1}=(1,2)$、$V_{2}=(4,3)$ 和 $V_{3}=(2,6)$。\n\n对于形函数 $N_{1}(x,y)$，条件如下：\n$N_{1}(V_{1}) = a_{1}(1) + b_{1}(2) + c_{1} = 1$\n$N_{1}(V_{2}) = a_{1}(4) + b_{1}(3) + c_{1} = 0$\n$N_{1}(V_{3}) = a_{1}(2) + b_{1}(6) + c_{1} = 0$\n这就构成了一个关于三个未知系数 $a_{1}$、$b_{1}$ 和 $c_{1}$ 的三元线性方程组。解此方程组可得 $a_{1} = -\\frac{3}{11}$，$b_{1} = -\\frac{2}{11}$ 以及 $c_{1} = \\frac{18}{11}$。因此，第一个形函数为：\n$$N_{1}(x,y) = \\frac{1}{11}(-3x - 2y + 18)$$\n\n对于形函数 $N_{2}(x,y)$，条件如下：\n$N_{2}(V_{1}) = a_{2}(1) + b_{2}(2) + c_{2} = 0$\n$N_{2}(V_{2}) = a_{2}(4) + b_{2}(3) + c_{2} = 1$\n$N_{2}(V_{3}) = a_{2}(2) + b_{2}(6) + c_{2} = 0$\n解此方程组可得 $a_{2} = \\frac{4}{11}$，$b_{2} = -\\frac{1}{11}$ 以及 $c_{2} = -\\frac{2}{11}$。第二个形函数为：\n$$N_{2}(x,y) = \\frac{1}{11}(4x - y - 2)$$\n\n对于形函数 $N_{3}(x,y)$，条件如下：\n$N_{3}(V_{1}) = a_{3}(1) + b_{3}(2) + c_{3} = 0$\n$N_{3}(V_{2}) = a_{3}(4) + b_{3}(3) + c_{3} = 0$\n$N_{3}(V_{3}) = a_{3}(2) + b_{3}(6) + c_{3} = 1$\n解此方程组可得 $a_{3} = -\\frac{1}{11}$，$b_{3} = \\frac{3}{11}$以及 $c_{3} = -\\frac{5}{11}$。第三个形函数为：\n$$N_{3}(x,y) = \\frac{1}{11}(-x + 3y - 5)$$\n\n克罗内克-德尔塔性质已通过构造得到满足。我们还必须验证单位分解性质，即 $\\sum_{i=1}^{3}N_{i}(x,y)=1$。将这些表达式相加：\n$$ \\sum_{i=1}^{3}N_{i}(x,y) = \\frac{1}{11}[(-3x - 2y + 18) + (4x - y - 2) + (-x + 3y - 5)] $$\n$$ = \\frac{1}{11}[(-3+4-1)x + (-2-1+3)y + (18-2-5)] $$\n$$ = \\frac{1}{11}[0 \\cdot x + 0 \\cdot y + 11] = \\frac{11}{11} = 1 $$\n因此，单位分解性质对所有 $(x,y)$ 均成立。\n\n其次，我们计算点 $P=\\left(\\frac{11}{4},\\frac{7}{2}\\right)$ 的重心坐标。重心坐标 $\\lambda_{i}$ 定义为 $\\lambda_{i} = N_{i}(P)$。\n$$\\lambda_{1} = N_{1}\\left(\\frac{11}{4},\\frac{7}{2}\\right) = \\frac{1}{11}\\left(-3\\left(\\frac{11}{4}\\right) - 2\\left(\\frac{7}{2}\\right) + 18\\right) = \\frac{1}{11}\\left(-\\frac{33}{4} - 7 + 18\\right) = \\frac{1}{11}\\left(-\\frac{33}{4} + 11\\right) = \\frac{1}{11}\\left(\\frac{-33+44}{4}\\right) = \\frac{1}{11}\\left(\\frac{11}{4}\\right) = \\frac{1}{4}$$\n$$\\lambda_{2} = N_{2}\\left(\\frac{11}{4},\\frac{7}{2}\\right) = \\frac{1}{11}\\left(4\\left(\\frac{11}{4}\\right) - \\frac{7}{2} - 2\\right) = \\frac{1}{11}\\left(11 - \\frac{7}{2} - \\frac{4}{2}\\right) = \\frac{1}{11}\\left(11 - \\frac{11}{2}\\right) = \\frac{1}{11}\\left(\\frac{22-11}{2}\\right) = \\frac{1}{11}\\left(\\frac{11}{2}\\right) = \\frac{1}{2}$$\n$$\\lambda_{3} = N_{3}\\left(\\frac{11}{4},\\frac{7}{2}\\right) = \\frac{1}{11}\\left(-\\frac{11}{4} + 3\\left(\\frac{7}{2}\\right) - 5\\right) = \\frac{1}{11}\\left(-\\frac{11}{4} + \\frac{21}{2} - 5\\right) = \\frac{1}{11}\\left(\\frac{-11+42-20}{4}\\right) = \\frac{1}{11}\\left(\\frac{11}{4}\\right) = \\frac{1}{4}$$\n点 $P$ 的重心坐标为 $(\\lambda_{1}, \\lambda_{2}, \\lambda_{3}) = (\\frac{1}{4}, \\frac{1}{2}, \\frac{1}{4})$。注意，它们的和为 $1$（$\\frac{1}{4}+\\frac{1}{2}+\\frac{1}{4}=1$）且均为正数，这证实了点 $P$ 严格位于三角形内部的说法。\n\n第三，我们计算插值。函数 $f(x,y)$ 的节点插值由 $I_{h}f(x,y)=\\sum_{i=1}^{3}N_{i}(x,y)f(V_{i})$ 给出。在点 $P$ 处，这变为 $I_{h}f(P)=\\sum_{i=1}^{3}N_{i}(P)f(V_{i}) = \\sum_{i=1}^{3}\\lambda_{i}f(V_{i})$。\n\n对于常数函数 $g(x,y) = c$，我们有对所有 $i$ 均成立的 $g(V_{i}) = c$。\n$$I_{h}g(P) = \\sum_{i=1}^{3}\\lambda_{i}g(V_{i}) = \\lambda_{1}c + \\lambda_{2}c + \\lambda_{3}c = c(\\lambda_{1} + \\lambda_{2} + \\lambda_{3}) = c(1) = c$$\n其精确值为 $g(P) = c$。插值是精确的，这与预期相符。\n\n对于线性函数 $\\ell(x,y) = 3x - 2y + 1$，我们首先计算它在各顶点处的值：\n$\\ell(V_{1}) = \\ell(1,2) = 3(1) - 2(2) + 1 = 3 - 4 + 1 = 0$\n$\\ell(V_{2}) = \\ell(4,3) = 3(4) - 2(3) + 1 = 12 - 6 + 1 = 7$\n$\\ell(V_{3}) = \\ell(2,6) = 3(2) - 2(6) + 1 = 6 - 12 + 1 = -5$\n现在我们计算在点 $P$ 的插值：\n$$I_{h}\\ell(P) = \\sum_{i=1}^{3}\\lambda_{i}\\ell(V_{i}) = \\lambda_{1}\\ell(V_{1}) + \\lambda_{2}\\ell(V_{2}) + \\lambda_{3}\\ell(V_{3})$$\n$$I_{h}\\ell(P) = \\left(\\frac{1}{4}\\right)(0) + \\left(\\frac{1}{2}\\right)(7) + \\left(\\frac{1}{4}\\right)(-5) = 0 + \\frac{7}{2} - \\frac{5}{4} = \\frac{14}{4} - \\frac{5}{4} = \\frac{9}{4}$$\n为了验证精确性，我们计算 $\\ell(P)$ 的真实值：\n$$\\ell(P) = \\ell\\left(\\frac{11}{4},\\frac{7}{2}\\right) = 3\\left(\\frac{11}{4}\\right) - 2\\left(\\frac{7}{2}\\right) + 1 = \\frac{33}{4} - 7 + 1 = \\frac{33}{4} - 6 = \\frac{33-24}{4} = \\frac{9}{4}$$\n插值 $I_{h}\\ell(P) = \\frac{9}{4}$ 与真实值 $\\ell(P) = \\frac{9}{4}$ 相同。这证实了一个理论性质，即线性拉格朗日元能够为其形函数所构造的多项式空间内的任何函数（本例中包括所有仿射函数）提供精确插值。最终要求的答案是 $I_{h}\\ell(P)$ 的值。", "answer": "$$\\boxed{\\frac{9}{4}}$$", "id": "2586144"}, {"introduction": "在第一个练习的基础上，我们现在转向更复杂的单元，因为许多实际问题需要更高的插值精度。本练习将介绍常见的9节点双二次四边形单元，其形函数可以通过张量积方法便捷地构建。你将通过直接计算来验证此单元在中心节点处满足关键的克罗内克-德尔塔 ($\\delta$) 性质和单位分解性质 [@problem_id:2586159]。", "problem": "考虑在有限元法 (FEM) 中使用的标准9节点双二次拉格朗日四边形单元。令自然坐标为 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$，节点位置为张量网格点 $\\{-1,0,1\\}\\times\\{-1,0,1\\}$。使用以下节点编号和坐标：\n- 节点 $1$：$(\\xi,\\eta)=(-1,-1)$，\n- 节点 $2$：$(\\xi,\\eta)=(1,-1)$，\n- 节点 $3$：$(\\xi,\\eta)=(1,1)$，\n- 节点 $4$：$(\\xi,\\eta)=(-1,1)$，\n- 节点 $5$：$(\\xi,\\eta)=(0,0)$，\n- 节点 $6$：$(\\xi,\\eta)=(0,-1)$，\n- 节点 $7$：$(\\xi,\\eta)=(1,0)$，\n- 节点 $8$：$(\\xi,\\eta)=(0,1)$，\n- 节点 $9$：$(\\xi,\\eta)=(-1,0)$。\n\n仅从节点 $\\{-1,0,1\\}$ 上的一维二次拉格朗日插值的定义出发——即基多项式 $\\ell_{-1}(\\xi)$、$\\ell_{0}(\\xi)$ 和 $\\ell_{1}(\\xi)$ 满足 $\\ell_{a}(b)=\\delta_{ab}$（其中 $a,b\\in\\{-1,0,1\\}$）并能再生常数——构造二维形函数。这些形函数是与每个节点 $(\\alpha,\\beta)\\in\\{-1,0,1\\}\\times\\{-1,0,1\\}$（映射到上述编号）相关联的张量积 $N_{(\\alpha,\\beta)}(\\xi,\\eta)=\\ell_{\\alpha}(\\xi)\\,\\ell_{\\beta}(\\eta)$。然后，通过在单元中心 $(\\xi,\\eta)=(0,0)$ 直接求值：\n1. 计算中心节点处的 $N_{5}(0,0)$。\n2. 计算所有角节点 $i\\in\\{1,2,3,4\\}$ 和所有边中点节点 $i\\in\\{6,7,8,9\\}$ 处的 $N_{i}(0,0)$。\n3. 使用这些值来验证节点 $5$ 处的克罗内克-德尔塔性质和单位分解性质。\n\n将您的最终答案以单行矩阵 $(N_{1}(0,0),N_{2}(0,0),\\dots,N_{9}(0,0))$ 的形式按此顺序报告。不需要四舍五入，也不涉及单位。", "solution": "这个问题提法良好且科学合理，是有限元法中的一个基础练习。问题已经过验证，我将继续进行解答。\n\n任务是为9节点双二次拉格朗\n日四边形单元构造形函数，并在单元中心 $(\\xi, \\eta) = (0,0)$ 对它们进行求值。构造是基于一维二次拉格朗日基多项式的张量积。\n\n首先，我们必须定义在区间 $[-1, 1]$ 上、节点位于 $\\{-1, 0, 1\\}$ 的一维二次拉格朗日基多项式 $\\ell_a(\\xi)$。这些多项式由性质 $\\ell_a(b) = \\delta_{ab}$ 定义，其中 $a, b \\in \\{-1, 0, 1\\}$，$\\delta_{ab}$ 是克罗内克-德尔塔符号。由于它们是二次的，可以写成 $c_2\\xi^2 + c_1\\xi + c_0$ 的形式。\n\n对于与节点 $\\xi = -1$ 相关的基函数，记为 $\\ell_{-1}(\\xi)$：\n它必须满足 $\\ell_{-1}(-1) = 1$, $\\ell_{-1}(0) = 0$ 和 $\\ell_{-1}(1) = 0$。\n条件 $\\ell_{-1}(0) = 0$ 和 $\\ell_{-1}(1) = 0$ 意味着该多项式在 $\\xi=0$ 和 $\\xi=1$ 处有根，因此其形式为 $C \\cdot \\xi(\\xi-1)$，其中 $C$ 是某个常数。\n条件 $\\ell_{-1}(-1) = 1$ 决定了常数 $C$：\n$C \\cdot (-1)(-1-1) = 1 \\implies C \\cdot (-1)(-2) = 1 \\implies 2C = 1 \\implies C = \\frac{1}{2}$。\n因此，$\\ell_{-1}(\\xi) = \\frac{1}{2}\\xi(\\xi-1) = \\frac{1}{2}(\\xi^2 - \\xi)$。\n\n对于与节点 $\\xi = 0$ 相关的基函数，记为 $\\ell_{0}(\\xi)$：\n它必须满足 $\\ell_{0}(-1) = 0$, $\\ell_{0}(0) = 1$ 和 $\\ell_{0}(1) = 0$。\n条件 $\\ell_{0}(-1) = 0$ 和 $\\ell_{0}(1) = 0$ 意味着该多项式形式为 $C \\cdot (\\xi+1)(\\xi-1) = C(\\xi^2-1)$。\n条件 $\\ell_{0}(0) = 1$ 决定了 $C$：\n$C \\cdot (0^2-1) = 1 \\implies -C = 1 \\implies C = -1$。\n因此，$\\ell_{0}(\\xi) = -(\\xi^2-1) = 1 - \\xi^2$。\n\n对于与节点 $\\xi = 1$ 相关的基函数，记为 $\\ell_{1}(\\xi)$：\n它必须满足 $\\ell_{1}(-1) = 0$, $\\ell_{1}(0) = 0$ 和 $\\ell_{1}(1) = 1$。\n条件 $\\ell_{1}(-1) = 0$ 和 $\\ell_{1}(0) = 0$ 意味着该多项式形式为 $C \\cdot (\\xi+1)\\xi$。\n条件 $\\ell_{1}(1) = 1$ 决定了 $C$：\n$C \\cdot (1+1)(1) = 1 \\implies 2C = 1 \\implies C = \\frac{1}{2}$。\n因此，$\\ell_{1}(\\xi) = \\frac{1}{2}\\xi(\\xi+1) = \\frac{1}{2}(\\xi^2 + \\xi)$。\n\n问题要求在中心点 $(\\xi, \\eta) = (0,0)$ 处计算二维形函数的值。为此，我们首先在 $\\xi=0$ 处计算一维基函数的值：\n$\\ell_{-1}(0) = \\frac{1}{2}(0^2 - 0) = 0$。\n$\\ell_{0}(0) = 1 - 0^2 = 1$。\n$\\ell_{1}(0) = \\frac{1}{2}(0^2 + 0) = 0$。\n这些结果是克罗内克-德尔塔性质的直接推论，因为 $\\ell_a(0) = \\delta_{a0}$。根据对称性，$\\eta$ 方向的基函数也具有相同的值：$\\ell_{-1}(0)=0$, $\\ell_{0}(0)=1$ 以及 $\\ell_{1}(0)=0$。\n\n与节点 $i$（其坐标为 $(\\xi_i, \\eta_i) = (\\alpha, \\beta)$，其中 $\\alpha, \\beta \\in \\{-1, 0, 1\\}$）相关联的二维形函数 $N_i(\\xi, \\eta)$ 由张量积给出：\n$N_i(\\xi, \\eta) = \\ell_{\\alpha}(\\xi) \\ell_{\\beta}(\\eta)$。\n题目要求我们在 $(\\xi, \\eta) = (0,0)$ 处计算每个 $N_i$ 的值。这得到 $N_i(0,0) = \\ell_{\\alpha}(0) \\ell_{\\beta}(0)$。\n\n我们现在使用提供的节点编号为所有9个节点计算这个值：\n- 节点 $1$：$(\\xi_1, \\eta_1) = (-1, -1)$。这对应于 $(\\alpha, \\beta) = (-1, -1)$。\n$N_1(0,0) = \\ell_{-1}(0) \\ell_{-1}(0) = 0 \\times 0 = 0$。\n- 节点 $2$：$(\\xi_2, \\eta_2) = (1, -1)$。这对应于 $(\\alpha, \\beta) = (1, -1)$。\n$N_2(0,0) = \\ell_{1}(0) \\ell_{-1}(0) = 0 \\times 0 = 0$。\n- 节点 $3$：$(\\xi_3, \\eta_3) = (1, 1)$。这对应于 $(\\alpha, \\beta) = (1, 1)$。\n$N_3(0,0) = \\ell_{1}(0) \\ell_{1}(0) = 0 \\times 0 = 0$。\n- 节点 $4$：$(\\xi_4, \\eta_4) = (-1, 1)$。这对应于 $(\\alpha, \\beta) = (-1, 1)$。\n$N_4(0,0) = \\ell_{-1}(0) \\ell_{1}(0) = 0 \\times 0 = 0$。\n- 节点 $5$：$(\\xi_5, \\eta_5) = (0, 0)$。这对应于 $(\\alpha, \\beta) = (0, 0)$。\n$N_5(0,0) = \\ell_{0}(0) \\ell_{0}(0) = 1 \\times 1 = 1$。\n- 节点 $6$：$(\\xi_6, \\eta_6) = (0, -1)$。这对应于 $(\\alpha, \\beta) = (0, -1)$。\n$N_6(0,0) = \\ell_{0}(0) \\ell_{-1}(0) = 1 \\times 0 = 0$。\n- 节点 $7$：$(\\xi_7, \\eta_7) = (1, 0)$。这对应于 $(\\alpha, \\beta) = (1, 0)$。\n$N_7(0,0) = \\ell_{1}(0) \\ell_{0}(0) = 0 \\times 1 = 0$。\n- 节点 $8$：$(\\xi_8, \\eta_8) = (0, 1)$。这对应于 $(\\alpha, \\beta) = (0, 1)$。\n$N_8(0,0) = \\ell_{0}(0) \\ell_{1}(0) = 1 \\times 0 = 0$。\n- 节点 $9$：$(\\xi_9, \\eta_9) = (-1, 0)$。这对应于 $(\\alpha, \\beta) = (-1, 0)$。\n$N_9(0,0) = \\ell_{-1}(0) \\ell_{0}(0) = 0 \\times 1 = 0$。\n\n问题还要求在中心点验证关键性质。\n1. 克罗内克-德尔塔性质：该性质表明 $N_i(\\xi_j, \\eta_j) = \\delta_{ij}$。我们必须在节点 $5$（位于 $(\\xi_5, \\eta_5) = (0,0)$）处检查这一点。我们的计算表明 $N_5(0,0) = 1$ 且对于所有 $i \\neq 5$ 都有 $N_i(0,0) = 0$。这正确地证明了对于所有 $i \\in \\{1, \\dots, 9\\}$，都有 $N_i(\\xi_5, \\eta_5) = \\delta_{i5}$。该性质得到验证。角节点 $(1,2,3,4)$ 和边中点节点 $(6,7,8,9)$ 的形函数在中心节点 $(5)$ 处的计算结果都为零，符合要求。\n2. 单位分解性质：该性质表明，对于单元内的所有 $(\\xi, \\eta)$，都有 $\\sum_{i=1}^9 N_i(\\xi, \\eta) = 1$。在中心点求值：\n$\\sum_{i=1}^9 N_i(0,0) = N_1(0,0) + N_2(0,0) + \\dots + N_9(0,0) = 0+0+0+0+1+0+0+0+0 = 1$。\n单位分解性质在中心点也得到了验证。\n\n最终结果是有序值集合 $(N_1(0,0), N_2(0,0), \\dots, N_9(0,0))$。\n该值向量为 $(0, 0, 0, 0, 1, 0, 0, 0, 0)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0\n\\end{pmatrix}\n}\n$$", "id": "2586159"}, {"introduction": "我们已经看到了标准拉格朗日形函数的便利性，但一个启发性的问题是：我们为什么偏爱这种形式的基函数？本练习通过一个反例来深化你的理解。你将分析一组虽然线性无关但不满足克罗内克-德尔塔性质的基函数，从而揭示在这种非标准基下将节点值与自由度直接关联的困难，进而凸显标准形函数设计的巧妙与实用价值 [@problem_id:2586154]。", "problem": "考虑平面上的参考三角形 $T$ ，其顶点为 $\\boldsymbol{v}_1=(0,0)$、$\\boldsymbol{v}_2=(1,0)$ 和 $\\boldsymbol{v}_3=(0,1)$。令 $L_1(x,y)=1-x-y$，$L_2(x,y)=x$ 和 $L_3(x,y)=y$ 表示 $T$ 上的重心坐标，它们满足基本性质 $L_1+L_2+L_3=1$ 和 $L_i(\\boldsymbol{v}_j)=\\delta_{ij}$，其中 $\\delta_{ij}$ 是 Kronecker delta。在 $T$ 上定义三个函数如下：\n$$\n\\phi_1 = L_1 + L_2, \\quad \\phi_2 = L_2 + L_3, \\quad \\phi_3 = L_3 + L_1.\n$$\n这些函数是有限元方法（FEM）中形函数的候选。\n\n仅使用重心坐标的性质和上述定义，完成以下任务：\n- 从第一性原理出发，证明 $\\{\\phi_1,\\phi_2,\\phi_3\\}$ 在 $T$ 上是线性无关集。\n- 计算节点值 $\\phi_i(\\boldsymbol{v}_j)$，并由此证明 Kronecker-delta 性质 $\\phi_i(\\boldsymbol{v}_j)=\\delta_{ij}$ 对此基不成立。说明单位分解性质是否成立。\n- 考虑一个形式为 $u_h = a_1 \\phi_1 + a_2 \\phi_2 + a_3 \\phi_3$ 的插值函数 $u_h \\in \\operatorname{span}\\{\\phi_1,\\phi_2,\\phi_3\\}$。设指定的节点值为 $u_1 = u_h(\\boldsymbol{v}_1)$、$u_2 = u_h(\\boldsymbol{v}_2)$ 和 $u_3 = u_h(\\boldsymbol{v}_3)$。解释为什么系数 $a_1,a_2,a_3$ 不能直接设为等于 $u_1,u_2,u_3$，并推导将 $\\begin{pmatrix}a_1 & a_2 & a_3\\end{pmatrix}^\\top$ 映射到 $\\begin{pmatrix}u_1 & u_2 & u_3\\end{pmatrix}^\\top$ 的线性系统。\n\n作为最终答案，提供系数向量 $\\begin{pmatrix}a_1 & a_2 & a_3\\end{pmatrix}$ 用节点值 $\\begin{pmatrix}u_1 & u_2 & u_3\\end{pmatrix}$ 表示的显式解析表达式。将最终答案表示为单个行矩阵。无需四舍五入。", "solution": "所提供的问题陈述是自洽的、逻辑一致且科学上合理的。它代表了有限元方法框架内基函数分析的一个标准练习。所有术语都有明确的定义，任务也清晰明确。因此，该问题是有效的，我们可以着手解决。\n\n基本原理是重心坐标 $\\{ L_1, L_2, L_3 \\}$ 的线性无关性。这些函数构成了三角形 $T$ 上线性多项式的一个基。因此，对于所有点 $(x,y) \\in T$，任何线性组合 $\\alpha_1 L_1 + \\alpha_2 L_2 + \\alpha_3 L_3 = 0$ 都意味着 $\\alpha_1 = \\alpha_2 = \\alpha_3 = 0$。我们将利用这一事实来回答问题的第一部分。\n\n首先，我们证明集合 $\\{\\phi_1, \\phi_2, \\phi_3\\}$ 的线性无关性。我们建立一个在 $T$ 上等于零函数的线性组合：\n$$\nc_1 \\phi_1 + c_2 \\phi_2 + c_3 \\phi_3 = 0\n$$\n将 $\\phi_i$ 用重心坐标 $L_i$ 的定义代入：\n$$\nc_1 (L_1 + L_2) + c_2 (L_2 + L_3) + c_3 (L_3 + L_1) = 0\n$$\n我们通过对每个重心坐标函数的系数进行分组来重新排列各项：\n$$\n(c_1 + c_3) L_1 + (c_1 + c_2) L_2 + (c_2 + c_3) L_3 = 0\n$$\n由于集合 $\\{L_1, L_2, L_3\\}$ 是线性无关的，这个线性组合的系数必须全部为零。这为未知常数 $c_1, c_2, c_3$ 产生了一个线性方程组：\n$$\n\\begin{cases}\nc_1 + c_3 = 0 \\\\\nc_1 + c_2 = 0 \\\\\nc_2 + c_3 = 0\n\\end{cases}\n$$\n由第一个方程可知 $c_3 = -c_1$。由第二个方程可知 $c_2 = -c_1$。将这些代入第三个方程得到 $(-c_1) + (-c_1) = 0$，化简为 $-2c_1 = 0$，这意味着 $c_1 = 0$。因此，$c_2 = 0$ 且 $c_3 = 0$。由于唯一的解是所有系数都为零的平凡解，函数集合 $\\{\\phi_1, \\phi_2, \\phi_3\\}$ 被证明是线性无关的。\n\n接下来，我们使用给定性质 $L_i(\\boldsymbol{v}_j) = \\delta_{ij}$（其中 $\\delta_{ij}$ 是 Kronecker delta）来计算节点值 $\\phi_i(\\boldsymbol{v}_j)$。\n对于 $\\phi_1 = L_1 + L_2$：\n$\\phi_1(\\boldsymbol{v}_1) = L_1(\\boldsymbol{v}_1) + L_2(\\boldsymbol{v}_1) = 1 + 0 = 1$。\n$\\phi_1(\\boldsymbol{v}_2) = L_1(\\boldsymbol{v}_2) + L_2(\\boldsymbol{v}_2) = 0 + 1 = 1$。\n$\\phi_1(\\boldsymbol{v}_3) = L_1(\\boldsymbol{v}_3) + L_2(\\boldsymbol{v}_3) = 0 + 0 = 0$。\n\n对于 $\\phi_2 = L_2 + L_3$：\n$\\phi_2(\\boldsymbol{v}_1) = L_2(\\boldsymbol{v}_1) + L_3(\\boldsymbol{v}_1) = 0 + 0 = 0$。\n$\\phi_2(\\boldsymbol{v}_2) = L_2(\\boldsymbol{v}_2) + L_3(\\boldsymbol{v}_2) = 1 + 0 = 1$。\n$\\phi_2(\\boldsymbol{v}_3) = L_2(\\boldsymbol{v}_3) + L_3(\\boldsymbol{v}_3) = 0 + 1 = 1$。\n\n对于 $\\phi_3 = L_3 + L_1$：\n$\\phi_3(\\boldsymbol{v}_1) = L_3(\\boldsymbol{v}_1) + L_1(\\boldsymbol{v}_1) = 0 + 1 = 1$。\n$\\phi_3(\\boldsymbol{v}_2) = L_3(\\boldsymbol{v}_2) + L_1(\\boldsymbol{v}_2) = 0 + 0 = 0$。\n$\\phi_3(\\boldsymbol{v}_3) = L_3(\\boldsymbol{v}_3) + L_1(\\boldsymbol{v}_3) = 1 + 0 = 1$。\n\nKronecker-delta 性质要求 $\\phi_i(\\boldsymbol{v}_j) = \\delta_{ij}$。例如，该性质要求 $\\phi_1(\\boldsymbol{v}_2) = \\delta_{12} = 0$，但我们计算出 $\\phi_1(\\boldsymbol{v}_2) = 1$。由于这些值与 Kronecker delta 不符，该性质对此基不成立。\n\n为了检验单位分解性质，我们必须验证在 $T$ 上是否有 $\\sum_{i=1}^3 \\phi_i = 1$。我们将这些函数相加：\n$$\n\\sum_{i=1}^3 \\phi_i = \\phi_1 + \\phi_2 + \\phi_3 = (L_1 + L_2) + (L_2 + L_3) + (L_3 + L_1) = 2L_1 + 2L_2 + 2L_3\n$$\n利用给定的性质 $L_1 + L_2 + L_3 = 1$，我们发现：\n$$\n\\sum_{i=1}^3 \\phi_i = 2(L_1 + L_2 + L_3) = 2(1) = 2\n$$\n由于和为 $2$，而不是 $1$，单位分解性质不满足。\n\n最后，我们考虑插值函数 $u_h = a_1 \\phi_1 + a_2 \\phi_2 + a_3 \\phi_3$。系数 $a_i$ 代表自由度。节点值 $u_j$ 由 $u_j = u_h(\\boldsymbol{v}_j)$ 给出。要使系数 $a_i$ 直接等于节点值 $u_i$，即 $a_j = u_j$，基函数必须满足 Kronecker-delta 性质。要理解这一点，如果 $\\phi_i(\\boldsymbol{v}_j) = \\delta_{ij}$，那么在节点 $\\boldsymbol{v}_j$ 处求值将得到 $u_h(\\boldsymbol{v}_j) = \\sum_{i=1}^3 a_i \\phi_i(\\boldsymbol{v}_j) = \\sum_{i=1}^3 a_i \\delta_{ij} = a_j$。由于我们已经证明 Kronecker-delta 性质对此基不成立，因此系数 $a_j$ 通常不等于节点值 $u_j$。\n\n为了找到系数 $\\boldsymbol{a} = \\begin{pmatrix} a_1 & a_2 & a_3 \\end{pmatrix}^\\top$ 和节点值 $\\boldsymbol{u} = \\begin{pmatrix} u_1 & u_2 & u_3 \\end{pmatrix}^\\top$ 之间的关系，我们在每个顶点处对插值函数求值：\n$u_1 = u_h(\\boldsymbol{v}_1) = a_1 \\phi_1(\\boldsymbol{v}_1) + a_2 \\phi_2(\\boldsymbol{v}_1) + a_3 \\phi_3(\\boldsymbol{v}_1) = a_1(1) + a_2(0) + a_3(1) = a_1 + a_3$。\n$u_2 = u_h(\\boldsymbol{v}_2) = a_1 \\phi_1(\\boldsymbol{v}_2) + a_2 \\phi_2(\\boldsymbol{v}_2) + a_3 \\phi_3(\\boldsymbol{v}_2) = a_1(1) + a_2(1) + a_3(0) = a_1 + a_2$。\n$u_3 = u_h(\\boldsymbol{v}_3) = a_1 \\phi_1(\\boldsymbol{v}_3) + a_2 \\phi_2(\\boldsymbol{v}_3) + a_3 \\phi_3(\\boldsymbol{v}_3) = a_1(0) + a_2(1) + a_3(1) = a_2 + a_3$。\n\n这给出了线性系统 $\\boldsymbol{u} = M \\boldsymbol{a}$：\n$$\n\\begin{pmatrix} u_1 \\\\ u_2 \\\\ u_3 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & 1 \\\\ 1 & 1 & 0 \\\\ 0 & 1 & 1 \\end{pmatrix} \\begin{pmatrix} a_1 \\\\ a_2 \\\\ a_3 \\end{pmatrix}\n$$\n为了求解 $\\boldsymbol{a}$，我们必须计算矩阵 $M$ 的逆。$M$ 的行列式为 $\\det(M) = 1(1-0) - 0(1-0) + 1(1-0) = 2$。\n逆矩阵 $M^{-1}$ 由 $\\frac{1}{\\det(M)}\\text{adj}(M)$ 给出。伴随矩阵是代数余子式矩阵的转置。\n代数余子式矩阵为：\n$$\nC = \\begin{pmatrix}\n\\begin{vmatrix} 1 & 0 \\\\ 1 & 1 \\end{vmatrix} & -\\begin{vmatrix} 1 & 0 \\\\ 0 & 1 \\end{vmatrix} & \\begin{vmatrix} 1 & 1 \\\\ 0 & 1 \\end{vmatrix} \\\\\n-\\begin{vmatrix} 0 & 1 \\\\ 1 & 1 \\end{vmatrix} & \\begin{vmatrix} 1 & 1 \\\\ 0 & 1 \\end{vmatrix} & -\\begin{vmatrix} 1 & 0 \\\\ 0 & 1 \\end{vmatrix} \\\\\n\\begin{vmatrix} 0 & 1 \\\\ 1 & 0 \\end{vmatrix} & -\\begin{vmatrix} 1 & 1 \\\\ 1 & 0 \\end{vmatrix} & \\begin{vmatrix} 1 & 0 \\\\ 1 & 1 \\end{vmatrix}\n\\end{pmatrix}\n= \\begin{pmatrix} 1 & -1 & 1 \\\\ 1 & 1 & -1 \\\\ -1 & 1 & 1 \\end{pmatrix}\n$$\n伴随矩阵为 $\\text{adj}(M) = C^\\top = \\begin{pmatrix} 1 & 1 & -1 \\\\ -1 & 1 & 1 \\\\ 1 & -1 & 1 \\end{pmatrix}$。\n因此，逆矩阵为：\n$$\nM^{-1} = \\frac{1}{2} \\begin{pmatrix} 1 & 1 & -1 \\\\ -1 & 1 & 1 \\\\ 1 & -1 & 1 \\end{pmatrix}\n$$\n系数 $\\boldsymbol{a}$ 通过 $\\boldsymbol{a} = M^{-1} \\boldsymbol{u}$ 求得：\n$$\n\\begin{pmatrix} a_1 \\\\ a_2 \\\\ a_3 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1 & 1 & -1 \\\\ -1 & 1 & 1 \\\\ 1 & -1 & 1 \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\\\ u_3 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} u_1 + u_2 - u_3 \\\\ -u_1 + u_2 + u_3 \\\\ u_1 - u_2 + u_3 \\end{pmatrix}\n$$\n这就给出了 $a_1, a_2$ 和 $a_3$ 的显式表达式。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}(u_1 + u_2 - u_3) & \\frac{1}{2}(-u_1 + u_2 + u_3) & \\frac{1}{2}(u_1 - u_2 + u_3)\n\\end{pmatrix}\n}\n$$", "id": "2586154"}]}