{"hands_on_practices": [{"introduction": "精通有限元方法始于对其基本构造单元——形函数的深刻理解。第一个练习提供了构造最常见形函数之一，即一维二次拉格朗日多项式的核心实践 [@problem_id:2595145]。通过从基本的克罗内克-德尔塔（$\\delta$）性质出发推导这些函数，您将掌握理解单元内物理场如何被近似表示所必需的基础技能。", "problem": "在有限元法 (FEM) 中，一维参考单元上的节点Lagrange形函数被定义为具有Kronecker-delta性质、用于插值节点值的多项式。考虑一个以参数坐标 $\\xi$ 表示的参考区间，以及一个次数至多为 $p=2$ 的二次多项式空间。设三个节点为 $\\xi_1=-1$、$\\xi_2=0$ 和 $\\xi_3=1$。从每个形函数 $N_i(\\xi)$ 都是次数至多为 2 的多项式且满足 $N_i(\\xi_j)=\\delta_{ij}$ (其中 $i,j\\in\\{1,2,3\\}$) 这一定义性质出发，完成以下任务：\n- 推导三个形函数 $N_1(\\xi)$、$N_2(\\xi)$ 和 $N_3(\\xi)$ 的显式表达式。\n- 通过计算所有 $i,j\\in\\{1,2,3\\}$ 的 $N_i'(\\xi_j)$，验证它们在节点处的一阶导数。\n- 验证单位分解(partition-of-unity)性质 $\\sum_{i=1}^{3}N_i(\\xi)=1$ 及其对节点处导数的推论。\n\n你的最终答案必须是这三个形函数，以一行关于 $\\xi$ 的解析表达式的形式写出。不要包含任何单位。最终答案中不要提供导数值。", "solution": "对问题陈述进行验证。\n\n逐字提取已知条件如下：\n- 领域：有限元法 (FEM)。\n- 主题：一维参考单元上的节点Lagrange形函数。\n- 性质：函数通过Kronecker-delta性质插值节点值。\n- 几何：以参数坐标 $\\xi$ 表示的参考区间。\n- 多项式空间：二次，次数至多为 $p=2$。\n- 节点：$\\xi_1=-1$、$\\xi_2=0$ 和 $\\xi_3=1$。\n- 形函数 $N_i(\\xi)$ 的定义性质：\n    1. $N_i(\\xi)$ 是一个次数至多为 $2$ 的多项式。\n    2. 对于 $i,j\\in\\{1,2,3\\}$，$N_i(\\xi_j)=\\delta_{ij}$，其中 $\\delta_{ij}$ 是克罗内克δ (Kronecker delta)。\n- 要求任务：\n    1. 推导 $N_1(\\xi)$、$N_2(\\xi)$ 和 $N_3(\\xi)$ 的显式表达式。\n    2. 通过计算所有 $i,j\\in\\{1,2,3\\}$ 的 $N_i'(\\xi_j)$ 来验证它们在节点处的一阶导数。\n    3. 验证单位分解性质 $\\sum_{i=1}^{3}N_i(\\xi)=1$ 及其对节点处导数的推论。\n\n经判定，该问题有效。这是一个在数值分析和有限元法中标准的、适定的问题。它具有科学依据，内容完整，逻辑一致，且陈述客观。推导唯一解所需的所有信息均已提供。我们可以继续求解。\n\n本任务要求在区间 $[\\!-1, 1\\!]$ 上，以节点 $\\xi_1 = -1$、$\\xi_2 = 0$ 和 $\\xi_3 = 1$ 构建三个二次Lagrange多项式 $N_1(\\xi)$、$N_2(\\xi)$ 和 $N_3(\\xi)$。其定义性质是Kronecker-delta条件：$N_i(\\xi_j) = \\delta_{ij}$。一个次数至多为 $2$ 的多项式形式为 $P(\\xi) = a\\xi^2 + b\\xi + c$。\n\n$N_1(\\xi)$ 的推导：\n根据定义，$N_1(\\xi)$ 必须满足：\n$N_1(\\xi_1) = N_1(-1) = 1$\n$N_1(\\xi_2) = N_1(0) = 0$\n$N_1(\\xi_3) = N_1(1) = 0$\n由于 $N_1(\\xi)$ 在 $\\xi=0$ 和 $\\xi=1$ 处为零，它必须具有形式 $N_1(\\xi) = C_1(\\xi - 0)(\\xi - 1)$，其中 $C_1$ 是某个常数。\n为了求出 $C_1$，我们使用条件 $N_1(-1) = 1$：\n$1 = C_1(-1)(-1 - 1) = C_1(-1)(-2) = 2C_1$\n这给出 $C_1 = \\frac{1}{2}$。\n因此，第一个形函数是：\n$N_1(\\xi) = \\frac{1}{2}\\xi(\\xi - 1) = \\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi$\n\n$N_2(\\xi)$ 的推导：\n根据定义，$N_2(\\xi)$ 必须满足：\n$N_2(\\xi_1) = N_2(-1) = 0$\n$N_2(\\xi_2) = N_2(0) = 1$\n$N_2(\\xi_3) = N_2(1) = 0$\n由于 $N_2(\\xi)$ 在 $\\xi=-1$ 和 $\\xi=1$ 处为零，它必须具有形式 $N_2(\\xi) = C_2(\\xi - (-1))(\\xi - 1) = C_2(\\xi + 1)(\\xi - 1)$，其中 $C_2$ 是某个常数。\n为了求出 $C_2$，我们使用条件 $N_2(0) = 1$：\n$1 = C_2(0 + 1)(0 - 1) = C_2(1)(-1) = -C_2$\n这给出 $C_2 = -1$。\n因此，第二个形函数是：\n$N_2(\\xi) = -1(\\xi^2 - 1) = 1 - \\xi^2$\n\n$N_3(\\xi)$ 的推导：\n根据定义，$N_3(\\xi)$ 必须满足：\n$N_3(\\xi_1) = N_3(-1) = 0$\n$N_3(\\xi_2) = N_3(0) = 0$\n$N_3(\\xi_3) = N_3(1) = 1$\n由于 $N_3(\\xi)$ 在 $\\xi=-1$ 和 $\\xi=0$ 处为零，它必须具有形式 $N_3(\\xi) = C_3(\\xi - (-1))(\\xi - 0) = C_3(\\xi + 1)\\xi$，其中 $C_3$ 是某个常数。\n为了求出 $C_3$，我们使用条件 $N_3(1) = 1$：\n$1 = C_3(1 + 1)(1) = C_3(2)(1) = 2C_3$\n这给出 $C_3 = \\frac{1}{2}$。\n因此，第三个形函数是：\n$N_3(\\xi) = \\frac{1}{2}\\xi(\\xi + 1) = \\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi$\n\n验证节点处的导数：\n首先，我们计算形函数的一阶导数：\n$N_1'(\\xi) = \\frac{d}{d\\xi}\\left(\\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi\\right) = \\xi - \\frac{1}{2}$\n$N_2'(\\xi) = \\frac{d}{d\\xi}(1 - \\xi^2) = -2\\xi$\n$N_3'(\\xi) = \\frac{d}{d\\xi}\\left(\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi\\right) = \\xi + \\frac{1}{2}$\n\n现在，我们在每个节点 $\\xi_j \\in \\{-1, 0, 1\\}$ 处计算这些导数的值。\n对于 $\\xi_1 = -1$：\n$N_1'(-1) = -1 - \\frac{1}{2} = -\\frac{3}{2}$\n$N_2'(-1) = -2(-1) = 2$\n$N_3'(-1) = -1 + \\frac{1}{2} = -\\frac{1}{2}$\n\n对于 $\\xi_2 = 0$：\n$N_1'(0) = 0 - \\frac{1}{2} = -\\frac{1}{2}$\n$N_2'(0) = -2(0) = 0$\n$N_3'(0) = 0 + \\frac{1}{2} = \\frac{1}{2}$\n\n对于 $\\xi_3 = 1$：\n$N_1'(1) = 1 - \\frac{1}{2} = \\frac{1}{2}$\n$N_2'(1) = -2(1) = -2$\n$N_3'(1) = 1 + \\frac{1}{2} = \\frac{3}{2}$\n\n节点处一阶导数的验证至此完成。\n\n单位分解性质的验证：\n单位分解性质指出，在整个单元域上，形函数的和必须等于 $1$。\n$\\sum_{i=1}^{3} N_i(\\xi) = N_1(\\xi) + N_2(\\xi) + N_3(\\xi)$\n$= \\left(\\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi\\right) + (1 - \\xi^2) + \\left(\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi\\right)$\n$= \\left(\\frac{1}{2}\\xi^2 - \\xi^2 + \\frac{1}{2}\\xi^2\\right) + \\left(-\\frac{1}{2}\\xi + \\frac{1}{2}\\xi\\right) + 1$\n$= (1 - 1)\\xi^2 + (0)\\xi + 1 = 1$\n该性质得到验证。\n\n单位分解性质的一个重要推论是，形函数导数的和必须为零。\n$\\frac{d}{d\\xi} \\left( \\sum_{i=1}^{3} N_i(\\xi) \\right) = \\frac{d}{d\\xi}(1) = 0$\n$\\implies \\sum_{i=1}^{3} N_i'(\\xi) = 0$\n我们使用先前计算出的导数值在每个节点上验证这个和。\n在 $\\xi_1 = -1$ 处：\n$\\sum_{i=1}^{3} N_i'(-1) = -\\frac{3}{2} + 2 - \\frac{1}{2} = -\\frac{4}{2} + 2 = -2 + 2 = 0$\n在 $\\xi_2 = 0$ 处：\n$\\sum_{i=1}^{3} N_i'(0) = -\\frac{1}{2} + 0 + \\frac{1}{2} = 0$\n在 $\\xi_3 = 1$ 处：\n$\\sum_{i=1}^{3} N_i'(1) = \\frac{1}{2} - 2 + \\frac{3}{2} = \\frac{4}{2} - 2 = 2 - 2 = 0$\n该推论得到验证。计算结果一致。推导出的形函数公式是正确的。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}\\xi(\\xi-1) & 1-\\xi^2 & \\frac{1}{2}\\xi(\\xi+1)\n\\end{pmatrix}\n}\n$$", "id": "2595145"}, {"introduction": "了解如何构造形函数后，我们必须思考：它们为何要具备某些特定性质？“单元验证测试”（Patch Test）是有限元分析中回答此问题的基本验证工具。本练习将引导您完成一个二维四边形单元的经典验证案例 [@problem_id:2595182]。您将亲眼见证，从形函数推导出的线性完备性这一数学性质，如何直接转化为单元精确捕捉恒定应变状态的物理能力，这是确保模拟结果可靠性的基石。", "problem": "考虑一个单一的双二次拉格朗日四边形单元，通常记为 $Q_9$ 单元，它占据物理域 $\\Omega = \\{(x,y)\\,|\\, x \\in [-1,1],\\, y \\in [-1,1]\\}$，具有恒定厚度 $t>0$。使用母坐标 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 进行等参描述，并将九个节点放置在张量积网格 $\\{ -1,0,1 \\}\\times\\{ -1,0,1 \\}$ 上，使得映射为恒等映射 $(x,y)=(\\xi,\\eta)$。\n\n从与节点 $\\xi\\in\\{-1,0,1\\}$ 相关的一维二次拉格朗日多项式的定义出发，通过张量积构建二维 $Q_9$ 形函数，并从第一性原理证明这些形函数能够在 $\\Omega$ 上再现所有关于 $x$ 和 $y$ 的线性多项式。\n\n假设为小应变、线性、各向同性的平面应力弹性问题，杨氏模量 $E>0$，泊松比 $\\nu\\in(-1,1)$，且体力为零 $\\boldsymbol{b}=\\boldsymbol{0}$。设精确位移场为代表性的线性场\n$$\nu(x,y)=x+2y+3,\\qquad v(x,y)=-2x+y-1.\n$$\n设边界上的面力指定为 $\\boldsymbol{t}=\\boldsymbol{\\sigma}\\,\\boldsymbol{n}$，其中 $\\boldsymbol{\\sigma}$ 是根据精确位移场计算出的柯西应力，$\\boldsymbol{n}$ 是外法向单位向量。使用带有已构建形函数的 $Q_9$ 单元和精确积分，定义内、外节点力向量\n$$\n\\boldsymbol{f}_{\\mathrm{int}}=\\int_{\\Omega} \\boldsymbol{B}^{\\top}\\,\\boldsymbol{\\sigma}\\,t\\,\\mathrm{d}A,\\qquad\n\\boldsymbol{f}_{\\mathrm{ext}}=\\int_{\\partial\\Omega} \\boldsymbol{N}^{\\top}\\,\\boldsymbol{t}\\,t\\,\\mathrm{d}\\Gamma,\n$$\n其中 $\\boldsymbol{N}$ 是汇集了向量值形函数的矩阵，$\\boldsymbol{B}$ 是二维标准应变-位移矩阵（使用小应变对称化梯度）。对于此单单元斑块检验，考虑离散残差 $\\boldsymbol{r}=\\boldsymbol{f}_{\\mathrm{int}}-\\boldsymbol{f}_{\\mathrm{ext}}$。\n\n使用精确的符号推理计算欧几里得范数 $\\|\\boldsymbol{r}\\|_{2}$。以牛顿为单位表示最终答案。无需四舍五入。", "solution": "本问题是一个单单元斑块检验（patch test），这是有限元方法中的一个基本验证程序。其目的是确定一个给定的单元格式能否精确表示一个常应变状态。如题目所提供的，线性位移场会导致一个常应变场，使其成为该检验的经典案例。如果离散方程组得到精确满足，则检验通过，这意味着残差向量（内节点力与外节点力之差）为零。\n\n首先，我们讨论双二次9节点（$Q_9$）四边形单元的形函数的构造与性质。单元节点位于母域 $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ 中点集 $\\{-1, 0, 1\\} \\times \\{-1, 0, 1\\}$ 的张量积网格上。形函数由一维二次拉格朗日多项式的张量积构成。\n\n我们定义与节点 $\\xi_1 = -1$、$\\xi_2 = 0$ 和 $\\xi_3 = 1$ 相关的一维拉格朗日多项式 $L_i(\\xi)$：\n$$\nL_1(\\xi) = \\frac{(\\xi - \\xi_2)(\\xi - \\xi_3)}{(\\xi_1 - \\xi_2)(\\xi_1 - \\xi_3)} = \\frac{(\\xi - 0)(\\xi - 1)}{(-1 - 0)(-1 - 1)} = \\frac{1}{2}\\xi(\\xi - 1)\n$$\n$$\nL_2(\\xi) = \\frac{(\\xi - \\xi_1)(\\xi - \\xi_3)}{(\\xi_2 - \\xi_1)(\\xi_2 - \\xi_3)} = \\frac{(\\xi - (-1))(\\xi - 1)}{(0 - (-1))(0 - 1)} = -(\\xi+1)(\\xi-1) = 1 - \\xi^2\n$$\n$$\nL_3(\\xi) = \\frac{(\\xi - \\xi_1)(\\xi - \\xi_2)}{(\\xi_3 - \\xi_1)(\\xi_3 - \\xi_2)} = \\frac{(\\xi - (-1))(\\xi - 0)}{(1 - (-1))(1 - 0)} = \\frac{1}{2}\\xi(\\xi + 1)\n$$\n这9个节点的二维形函数 $N_I(\\xi, \\eta)$ 由张量积 $N_{ij}(\\xi, \\eta) = L_i(\\xi) L_j(\\eta)$ 形成，其中单个索引 $I$ 映射到数对 $(i, j)$，且 $i, j \\in \\{1, 2, 3\\}$。问题陈述了等参映射 $(x, y) = (\\xi, \\eta)$，因此我们可以互换使用这两个坐标系。\n\n接下来，我们必须证明这些形函数可以再现任意形式为 $p(x, y) = a_0 + a_1 x + a_2 y$ 的线性多项式。这个性质被称为线性完备性，如果形函数满足以下条件，该性质即成立：\n1. 单位分解性：$\\sum_I N_I(x, y) = 1$\n2. 线性场再生性：$\\sum_I x_I N_I(x, y) = x$ 且 $\\sum_I y_I N_I(x, y) = y$\n\n为证明单位分解性，我们首先对一维多项式求和：\n$$\n\\sum_{i=1}^{3} L_i(\\xi) = \\frac{1}{2}\\xi(\\xi - 1) + (1 - \\xi^2) + \\frac{1}{2}\\xi(\\xi + 1) = \\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi + 1 - \\xi^2 + \\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi = 1\n$$\n二维形函数的和则为：\n$$\n\\sum_I N_I(\\xi, \\eta) = \\sum_{i=1}^{3} \\sum_{j=1}^{3} L_i(\\xi) L_j(\\eta) = \\left( \\sum_{i=1}^{3} L_i(\\xi) \\right) \\left( \\sum_{j=1}^{3} L_j(\\eta) \\right) = (1)(1) = 1\n$$\n这证实了单位分解性，它保证了常数项 $a_0$ 的精确再现。\n\n为证明线性场再生性，我们考察节点坐标 $\\xi_I$ 的加权和：\n$$\n\\sum_I \\xi_I N_I(\\xi, \\eta) = \\sum_{i=1}^{3} \\sum_{j=1}^{3} \\xi_i L_i(\\xi) L_j(\\eta) = \\left( \\sum_{i=1}^{3} \\xi_i L_i(\\xi) \\right) \\left( \\sum_{j=1}^{3} L_j(\\eta) \\right)\n$$\n第一项是：\n$$\n\\sum_{i=1}^{3} \\xi_i L_i(\\xi) = (-1) \\left( \\frac{1}{2}\\xi(\\xi - 1) \\right) + (0) \\left( 1 - \\xi^2 \\right) + (1) \\left( \\frac{1}{2}\\xi(\\xi + 1) \\right) = -\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi + \\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi = \\xi\n$$\n因此，使用恒等式 $\\sum_j L_j(\\eta)=1$，我们有：\n$$\n\\sum_I x_I N_I(x,y) = \\sum_I \\xi_I N_I(\\xi,\\eta) = \\xi \\cdot 1 = \\xi = x\n$$\n根据对称性，对 $y$ 坐标进行类似的计算可得：\n$$\n\\sum_I y_I N_I(x,y) = \\sum_I \\eta_I N_I(\\xi,\\eta) = \\left( \\sum_{i=1}^{3} L_i(\\xi) \\right) \\left( \\sum_{j=1}^{3} \\eta_j L_j(\\eta) \\right) = 1 \\cdot \\eta = \\eta = y\n$$\n这些结果证明了 $Q_9$ 形函数是线性完备的。一个推论是，如果将节点位移 $\\boldsymbol{d}$ 设置为线性位移场在节点处的值，那么插值场 $\\boldsymbol{u}_h = \\boldsymbol{N}\\boldsymbol{d}$ 将与精确的线性场 $\\boldsymbol{u}$ 完全相同。给定的位移场是线性的：\n$$\n\\boldsymbol{u}(x,y) = \\begin{pmatrix} u(x,y) \\\\ v(x,y) \\end{pmatrix} = \\begin{pmatrix} x+2y+3 \\\\ -2x+y-1 \\end{pmatrix}\n$$\n由于完备性，插值场 $\\boldsymbol{u}_h(x, y)$ 在单元内任何地方都与 $\\boldsymbol{u}(x, y)$ 完全相等。因此，从插值场导出的应变 $\\boldsymbol{\\epsilon}_h = \\boldsymbol{B}\\boldsymbol{d}$ 与精确应变 $\\boldsymbol{\\epsilon}$ 完全相同。让我们计算这些精确应变：\n$$\n\\epsilon_{xx} = \\frac{\\partial u}{\\partial x} = 1, \\quad \\epsilon_{yy} = \\frac{\\partial v}{\\partial y} = 1, \\quad \\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} = 2 + (-2) = 0\n$$\n由于应变是常数，应力场 $\\boldsymbol{\\sigma} = \\boldsymbol{C}\\boldsymbol{\\epsilon}$ 在整个单元内也是常数。在没有体力的情况下，局部平衡方程为 $\\nabla \\cdot \\boldsymbol{\\sigma} = \\boldsymbol{0}$。对于一个常数应力场，此条件被平凡地满足。\n\n节点力向量由应用于平衡方程弱形式的伽辽金法（Galerkin method）定义。对弱形式进行分部积分（格林-高斯散度定理）可以得到内力、外力和体力之间的一般关系：\n$$\n\\int_{\\Omega} \\boldsymbol{B}^{\\top} \\boldsymbol{\\sigma} \\, \\mathrm{d}A = \\int_{\\partial \\Omega} \\boldsymbol{N}^{\\top} (\\boldsymbol{\\sigma}\\boldsymbol{n}) \\, \\mathrm{d}\\Gamma + \\int_{\\Omega} \\boldsymbol{N}^{\\top} \\boldsymbol{b} \\, \\mathrm{d}A\n$$\n只要应力场 $\\boldsymbol{\\sigma}$ 在域内满足强形式平衡条件 $\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$，该恒等式就成立。\n乘以常数厚度 $t > 0$ 并使用问题陈述中给出的定义：\n$\\boldsymbol{f}_{\\mathrm{int}} = \\int_{\\Omega} \\boldsymbol{B}^{\\top}\\boldsymbol{\\sigma} \\, t \\, \\mathrm{d}A$\n$\\boldsymbol{f}_{\\mathrm{ext}} = \\int_{\\partial\\Omega} \\boldsymbol{N}^{\\top}\\boldsymbol{t} \\, t \\, \\mathrm{d}\\Gamma$，其中 $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\boldsymbol{n}$。\n该关系变为：\n$$\n\\boldsymbol{f}_{\\mathrm{int}} = \\boldsymbol{f}_{\\mathrm{ext}} + \\int_{\\Omega} \\boldsymbol{N}^{\\top} \\boldsymbol{b} \\, t \\, \\mathrm{d}A\n$$\n在本问题中，体力 $\\boldsymbol{b} = \\boldsymbol{0}$。应力场 $\\boldsymbol{\\sigma}$ 是常数，因此满足 $\\nabla \\cdot \\boldsymbol{\\sigma} = \\boldsymbol{0}$。此外，题目指定了“精确积分”，意味着没有数值积分误差。在这些条件下，恒等式 $\\boldsymbol{f}_{\\mathrm{int}} = \\boldsymbol{f}_{\\mathrm{ext}}$ 精确成立。\n\n离散残差向量定义为 $\\boldsymbol{r} = \\boldsymbol{f}_{\\mathrm{int}} - \\boldsymbol{f}_{\\mathrm{ext}}$。根据前面的推导，我们有：\n$$\n\\boldsymbol{r} = \\boldsymbol{f}_{\\mathrm{ext}} - \\boldsymbol{f}_{\\mathrm{ext}} = \\boldsymbol{0}\n$$\n残差向量恒为零向量。根据定义，零向量的欧几里得范数为零。物理参数 $E$、$\\nu$ 和 $t$ 进入了各个力向量的计算中，但在确定残差为零时被抵消或不相关。单元通过此检验的能力是一个纯粹的运动学性质，它源于其形函数的完备性。\n\n因此，计算出的残差的欧几里得范数精确为零。", "answer": "$$\n\\boxed{0}\n$$", "id": "2595182"}, {"introduction": "并非所有物理问题仅需保证待求变量的连续性（即 $C^0$ 连续）。在结构力学中，涉及梁和板的理论要求解的导数也必须是连续的，以确保物理上的真实性，这种性质被称为 $C^1$ 连续性。这一挑战将我们引向一类不同的插值函数：厄米特（Hermite）多项式 [@problem_id:2595153]。在此实践中，您将推导三次厄米特形函数，并将其应用于欧拉-伯努利梁单元，通过一个恒曲率的单元验证测试，来证明该单元公式能正确地捕捉纯弯曲状态。", "problem": "考虑一个长度为 $L$、抗弯刚度为 $E I$ 的 Euler–Bernoulli 梁单元，其横向位移场 $w(x)$ 采用标准的 $C^{1}$ 连续三次 Hermite 插值。节点自由度排序为 $d = [\\,w_{1},\\,\\theta_{1},\\,w_{2},\\,\\theta_{2}\\,]^{T}$，其中 $w_{a}$ 和 $\\theta_{a}$ 分别表示节点 $a \\in \\{1,2\\}$ 处的横向位移和转角，节点 1 位于 $x=0$，节点 2 位于 $x=L$。有限元插值为 $w_{h}(x) = \\sum_{i=1}^{4} N_{i}(x)\\, d_{i}$，其中形函数 $N_{i}(x)$ 是三次多项式，用于在单元端点插值 $w$ 和 $w^{\\prime}$。在构造形函数时，可以在无量纲局部坐标 $\\xi = x/L \\in [0,1]$ 中处理单元，但所有最终积分都应在 $x \\in [0,L]$ 上进行。\n\n从 $C^{1}$ Hermite 形函数的定义插值条件和 Euler–Bernoulli 梁的虚功原理（内虚功 $\\delta W_{\\text{int}} = \\int_{0}^{L} E I\\, w^{\\prime\\prime}(x)\\, \\delta w^{\\prime\\prime}(x)\\, dx$ 及由端点弯矩 $M$ 作用于端点转角产生的外虚功）出发，按以下步骤进行：\n\n$1.$ 通过在 $x=0$ 和 $x=L$ 处施加对 $w$ 和 $w^{\\prime}$ 的插值条件，从第一性原理推导四个三次 Hermite 形函数 $N_{1}(x)$、$N_{2}(x)$、$N_{3}(x)$、$N_{4}(x)$ 的显式表达式。\n\n$2.$ 考虑一个具有恒定曲率 $\\kappa$ 的精确二次位移场 $w(x) = \\dfrac{\\kappa}{2}\\, x^{2} + b\\, x + c$，其中 $b$ 和 $c$ 为常数。表达该场对应的节点自由度 $d$，并证明由 Hermite 插值计算出的有限元曲率 $w_{h}^{\\prime\\prime}(x)$ 在所有 $x \\in [0,L]$ 上均等于精确的恒定曲率 $\\kappa$。\n\n$3.$ 使用内虚功表达式和推导出的形函数，计算第2部分中精确二次场的内节点力向量 $f_{\\text{int}}(d) \\in \\mathbb{R}^{4}$。这里 $f_{\\text{int},i}(d) = \\int_{0}^{L} E I\\, w_{h}^{\\prime\\prime}(x)\\, N_{i}^{\\prime\\prime}(x)\\, dx$。\n\n$4.$ 现在特化到恒定弯矩（恒定曲率）分片检验：不存在分布荷载，在 $x=0$ 和 $x=L$ 处施加大小为 $M = E I\\, \\kappa$、方向相反的端点弯矩，使得内弯矩为常数且剪力为零。从端点弯矩对节点转角所做的外虚功中，推导一致外节点力向量 $f_{\\text{ext}} \\in \\mathbb{R}^{4}$。然后，构建单元残差 $r = f_{\\text{int}}(d) - f_{\\text{ext}}$。\n\n您的任务是通过计算残差的缩放欧几里得范数 $\\|r\\|_{2}/(E I)$（作为一个实数），来验证三次 Hermite 梁单元是否通过了恒定曲率分片检验。请将最终答案表示为一个无单位的纯数（无量纲）。如果得到数值，请以精确形式给出，无需四舍五入。", "solution": "该问题陈述在科学上是合理的、内容是自洽的，且提法是适定的。它为 Euler-Bernoulli 梁的 $C^{1}$ 连续 Hermite 有限元提供了一种称为分片检验的标准验证程序。在固体力学和有限元方法的框架内，所有提供的信息都是标准且正确的。因此，该问题被认定为是**有效的**。我们开始进行求解。\n\n按照要求，该问题分四个部分依次求解。\n\n**1. Hermite 形函数的推导**\n\n横向位移场 $w_{h}(x)$ 通过四个三次 Hermite 形函数 $N_{i}(x)$ 和节点自由度向量 $d = [w_{1}, \\theta_{1}, w_{2}, \\theta_{2}]^{T}$ 进行插值。插值公式如下：\n$$\nw_{h}(x) = N_{1}(x)w_{1} + N_{2}(x)\\theta_{1} + N_{3}(x)w_{2} + N_{4}(x)\\theta_{2}\n$$\n其中 $w_{1} = w(0)$，$\\theta_{1} = w^{\\prime}(0)$，$w_{2} = w(L)$ 以及 $\\theta_{2} = w^{\\prime}(L)$。形函数是三次多项式，$N_{i}(x) = a_{i}x^{3} + b_{i}x^{2} + c_{i}x + d_{i}$，并且必须在节点 $x=0$ 和 $x=L$ 处满足以下 Kronecker delta 型条件：\n\\begin{itemize}\n    \\item $N_{1}(x)$: $N_{1}(0)=1$, $N_{1}^{\\prime}(0)=0$, $N_{1}(L)=0$, $N_{1}^{\\prime}(L)=0$.\n    \\item $N_{2}(x)$: $N_{2}(0)=0$, $N_{2}^{\\prime}(0)=1$, $N_{2}(L)=0$, $N_{2}^{\\prime}(L)=0$.\n    \\item $N_{3}(x)$: $N_{3}(0)=0$, $N_{3}^{\\prime}(0)=0$, $N_{3}(L)=1$, $N_{3}^{\\prime}(L)=0$.\n    \\item $N_{4}(x)$: $N_{4}(0)=0$, $N_{4}^{\\prime}(0)=0$, $N_{4}(L)=0$, $N_{4}^{\\prime}(L)=1$.\n\\end{itemize}\n在无量纲局部坐标 $\\xi = x/L \\in [0,1]$ 中推导这些函数更为方便。令 $N_{i}(x) = \\hat{N}_{i}(\\xi)$。那么 $N_{i}^{\\prime}(x) = \\frac{d\\hat{N}_{i}}{d\\xi}\\frac{d\\xi}{dx} = \\frac{1}{L}\\hat{N}_{i}^{\\prime}(\\xi)$。条件变为：\n\\begin{itemize}\n    \\item 对于 $\\hat{N}_{1}(\\xi) = a\\xi^{3}+b\\xi^{2}+c\\xi+d$：\n    $\\hat{N}_{1}(0)=1 \\Rightarrow d=1$。$\\frac{1}{L}\\hat{N}_{1}^{\\prime}(0)=0 \\Rightarrow c=0$。$\\hat{N}_{1}(1)=0 \\Rightarrow a+b+1=0$。$\\frac{1}{L}\\hat{N}_{1}^{\\prime}(1)=0 \\Rightarrow 3a+2b=0$。求解得 $a=2, b=-3$。\n    所以，$N_{1}(x) = 2(x/L)^{3} - 3(x/L)^{2} + 1$。\n\n    \\item 对于 $\\hat{N}_{2}(\\xi) = a\\xi^{3}+b\\xi^{2}+c\\xi+d$：\n    $\\hat{N}_{2}(0)=0 \\Rightarrow d=0$。$\\frac{1}{L}\\hat{N}_{2}^{\\prime}(0)=1 \\Rightarrow c/L=1 \\Rightarrow c=L$。$\\hat{N}_{2}(1)=0 \\Rightarrow a+b+L=0$。$\\frac{1}{L}\\hat{N}_{2}^{\\prime}(1)=0 \\Rightarrow 3a+2b+L=0$。求解得 $a=L, b=-2L$。\n    所以，$N_{2}(x) = L(x/L)^{3} - 2L(x/L)^{2} + L(x/L) = x(1-x/L)^{2}$。\n\n    \\item 对于 $\\hat{N}_{3}(\\xi) = a\\xi^{3}+b\\xi^{2}+c\\xi+d$：\n    根据与 $N_{1}(x)$ 的对称性，我们可以推断出 $N_{3}(x)=N_{1}(L-x)$。或者，求解方程组：$\\hat{N}_{3}(0)=0 \\Rightarrow d=0$。$\\frac{1}{L}\\hat{N}_{3}^{\\prime}(0)=0 \\Rightarrow c=0$。$\\hat{N}_{3}(1)=1 \\Rightarrow a+b=1$。$\\frac{1}{L}\\hat{N}_{3}^{\\prime}(1)=0 \\Rightarrow 3a+2b=0$。求解得 $a=-2, b=3$。\n    所以，$N_{3}(x) = -2(x/L)^{3} + 3(x/L)^{2}$。\n\n    \\item 对于 $\\hat{N}_{4}(\\xi) = a\\xi^{3}+b\\xi^{2}+c\\xi+d$：\n    根据与 $N_{2}(x)$ 的对称性，我们期望 $N_{4}(x)=-N_{2}(L-x)$。求解方程组：$\\hat{N}_{4}(0)=0 \\Rightarrow d=0$。$\\frac{1}{L}\\hat{N}_{4}^{\\prime}(0)=0 \\Rightarrow c=0$。$\\hat{N}_{4}(1)=0 \\Rightarrow a+b=0$。$\\frac{1}{L}\\hat{N}_{4}^{\\prime}(1)=1 \\Rightarrow (3a+2b)/L=1 \\Rightarrow 3a+2b=L$。求解得 $a=L, b=-L$。\n    所以，$N_{4}(x) = L(x/L)^{3} - L(x/L)^{2} = (x^{2}/L)(x/L - 1)$。\n\\end{itemize}\n\n**2. 恒定曲率分片检验：场插值**\n\n我们给定一个精确的二次位移场 $w(x) = \\frac{\\kappa}{2}x^{2} + bx + c$。\n首先，我们计算该场对应的节点自由度：\n\\begin{itemize}\n    \\item $w_{1} = w(0) = c$。\n    \\item $\\theta_{1} = w^{\\prime}(0) = [\\kappa x + b]_{x=0} = b$。\n    \\item $w_{2} = w(L) = \\frac{\\kappa}{2}L^{2} + bL + c$。\n    \\item $\\theta_{2} = w^{\\prime}(L) = [\\kappa x + b]_{x=L} = \\kappa L + b$。\n\\end{itemize}\n节点自由度向量为 $d = [c, b, \\frac{\\kappa}{2}L^{2}+bL+c, \\kappa L+b]^{T}$。\n\n接下来，我们必须证明插值曲率 $w_{h}^{\\prime\\prime}(x)$ 等于精确曲率 $\\kappa$。精确场 $w(x)$ 是一个二次多项式，它是三次多项式的一个特例。Hermite 插值函数 $w_{h}(x)$ 被构造成一个三次多项式，它在两个不同的点（$x=0$ 和 $x=L$）精确匹配函数值 $w(x)$ 和导数值 $w^{\\prime}(x)$ 。一个三次多项式由这四个条件唯一确定。由于精确解 $w(x)$ 本身就是一个次数小于或等于 3 且满足这些条件的多项式，因此唯一的插值多项式 $w_{h}(x)$ 必须与 $w(x)$ 完全相同。\n$$\nw_{h}(x) \\equiv w(x) = \\frac{\\kappa}{2}x^{2} + bx + c\n$$\n因此，插值场的二阶导数为：\n$$\nw_{h}^{\\prime\\prime}(x) = \\frac{d^{2}}{dx^{2}}\\left(\\frac{\\kappa}{2}x^{2} + bx + c\\right) = \\kappa\n$$\n这表明三次 Hermite 单元能够精确再现恒定曲率状态，这是通过分片检验的必要条件。\n\n**3. 内节点力向量**\n\n内节点力向量 $f_{\\mathrm{int}}$ 是从内虚功计算得出的。其第 $i$ 个分量由下式给出：\n$$\nf_{\\mathrm{int},i}(d) = \\int_{0}^{L} E I\\, w_{h}^{\\prime\\prime}(x)\\, N_{i}^{\\prime\\prime}(x)\\, dx\n$$\n根据第 2 部分，我们有 $w_{h}^{\\prime\\prime}(x) = \\kappa$。表达式简化为：\n$$\nf_{\\mathrm{int},i}(d) = E I \\kappa \\int_{0}^{L} N_{i}^{\\prime\\prime}(x)\\, dx\n$$\n使用微积分基本定理，该积分可计算为：\n$$\n\\int_{0}^{L} N_{i}^{\\prime\\prime}(x)\\, dx = [N_{i}^{\\prime}(x)]_{0}^{L} = N_{i}^{\\prime}(L) - N_{i}^{\\prime}(0)\n$$\n我们使用在第 1 部分中建立的形函数的定义属性：\n\\begin{itemize}\n    \\item $ i=1: N_{1}^{\\prime}(L) - N_{1}^{\\prime}(0) = 0 - 0 = 0 \\implies f_{\\mathrm{int},1} = 0$。\n    \\item $ i=2: N_{2}^{\\prime}(L) - N_{2}^{\\prime}(0) = 0 - 1 = -1 \\implies f_{\\mathrm{int},2} = -E I \\kappa$。\n    \\item $ i=3: N_{3}^{\\prime}(L) - N_{3}^{\\prime}(0) = 0 - 0 = 0 \\implies f_{\\mathrm{int},3} = 0$。\n    \\item $ i=4: N_{4}^{\\prime}(L) - N_{4}^{\\prime}(0) = 1 - 0 = 1 \\implies f_{\\mathrm{int},4} = E I \\kappa$。\n\\end{itemize}\n内节点力向量为 $f_{\\mathrm{int}}(d) = [0, -E I \\kappa, 0, E I \\kappa]^{T}$。\n\n**4. 外节点力向量和残差**\n\n分片检验考虑的是恒定弯矩 $M = E I \\kappa$ 且剪力为零的状态。这是通过在单元两端施加大小相等、方向相反的外部弯矩来实现的。根据标准梁理论的符号约定，恒定的正内弯矩 $M$ 需要在节点2（$x=L$）处施加一个大小为 $M$ 的逆时针外部弯矩，并在节点1（$x=0$）处施加一个大小为 $M$ 的顺时针外部弯矩。\n由这些弯矩作用于虚节点转角 $\\delta\\theta_{1}$ 和 $\\delta\\theta_{2}$ 所产生的外虚功 $\\delta W_{\\text{ext}}$ 为：\n$$\n\\delta W_{\\text{ext}} = (-M)\\delta\\theta_{1} + (M)\\delta\\theta_{2}\n$$\n外力向量 $f_{\\text{ext}}$ 通过关系式 $\\delta W_{\\text{ext}} = f_{\\text{ext}}^{T} \\delta d$ 定义。由于 $\\delta d = [\\delta w_{1}, \\delta \\theta_{1}, \\delta w_{2}, \\delta \\theta_{2}]^{T}$，我们可以通过比较来确定 $f_{\\text{ext}}$ 的分量：\n$$\nf_{\\text{ext}} = [0, -M, 0, M]^{T}\n$$\n代入 $M = E I \\kappa$，我们得到：\n$$\nf_{\\text{ext}} = [0, -E I \\kappa, 0, E I \\kappa]^{T}\n$$\n单元残差向量 $r$ 是内节点力和外节点力之差：\n$$\nr = f_{\\text{int}}(d) - f_{\\text{ext}} = \\begin{pmatrix} 0 \\\\ -E I \\kappa \\\\ 0 \\\\ E I \\kappa \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ -E I \\kappa \\\\ 0 \\\\ E I \\kappa \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n残差是零向量，这证实了单元在恒定弯矩状态下处于平衡状态，因此通过了分片检验。\n\n最后，我们计算所需的残差的缩放欧几里得范数：\n$$\n\\|r\\|_{2} = \\sqrt{0^{2} + 0^{2} + 0^{2} + 0^{2}} = 0\n$$\n因此，缩放后的范数为：\n$$\n\\frac{\\|r\\|_{2}}{E I} = \\frac{0}{E I} = 0\n$$\n结果是一个纯的无量纲数。", "answer": "$$\\boxed{0}$$", "id": "2595153"}]}