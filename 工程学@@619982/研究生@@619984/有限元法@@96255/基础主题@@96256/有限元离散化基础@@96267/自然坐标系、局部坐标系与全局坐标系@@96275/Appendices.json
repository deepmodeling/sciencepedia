{"hands_on_practices": [{"introduction": "等参方法的精髓在于从简单参考单元到复杂物理单元的映射。本练习将引导你完成这一基本操作，将参考单元中的理论点（高斯积分点）映射到其在全局坐标系中的物理位置。你还将计算雅可比行列式，它衡量了局部面积的变形，是进行数值积分的关键，通过实践 [@problem_id:2582348] 你将巩固对这一核心机制的理解。", "problem": "考虑有限元法 (FEM) 中的一个二维等参双线性四边形单元。该单元由标准自然（也称为母）坐标系 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 定义，其节点自然坐标排序如下：节点 $\\#1:(-1,-1)$，节点 $\\#2:(1,-1)$，节点 $\\#3:(1,1)$，节点 $\\#4:(-1,1)$。节点的相应全局（物理）坐标 $(x,y)$ 如下：\n- 节点 $\\#1:(x_1,y_1)=(0,0)$，\n- 节点 $\\#2:(x_2,y_2)=(2,0)$，\n- 节点 $\\#3:(x_3,y_3)=(3,1)$，\n- 节点 $\\#4:(x_4,y_4)=(-1,1)$。\n\n使用从自然坐标 $(\\xi,\\eta)$（作为单元局部参数系统）到全局坐标 $(x,y)$ 的标准双线性等参映射，完成以下任务：\n- 将自然坐标系中的标准两点 Gauss–Legendre 积分点 $(\\xi,\\eta)\\in\\{(-g,-g),(g,-g),(g,g),(-g,g)\\}$（其中 $g=1/\\sqrt{3}$）映射到它们的全局坐标 $(x,y)$。\n- 计算映射的雅可比矩阵 $\\mathbf{J}(\\xi,\\eta)$ 以及在每个高斯点处其行列式的绝对值 $|\\det \\mathbf{J}(\\xi,\\eta)|$。\n\n将您的最终答案表示为在 $(\\xi,\\eta)=(-g,-g)$、$(g,-g)$、$(g,g)$、$(-g,g)$ 处求得的四个 $|\\det \\mathbf{J}|$ 值的有序行矩阵。无需四舍五入；所有值均以精确解析形式表示。无需报告物理单位，也不涉及角度。", "solution": "问题陈述已经过验证，被认定为具有科学依据、提法恰当、客观且完整。它提出了有限元法中一个涉及二维四边形单元等参映射的标准练习。所有必要数据均已提供，问题没有矛盾或歧义。因此，将推导其解。\n\n该问题要求计算在指定的高斯积分点处等参映射的雅可比行列式。该映射将母单元的自然坐标 $(\\xi, \\eta)$ 与物理单元的全局坐标 $(x, y)$ 联系起来。\n\n对于双线性四边形单元，等参映射由形函数 $N_i(\\xi, \\eta)$ 和节点坐标 $(x_i, y_i)$ 定义。与自然坐标对 $(\\xi, \\eta)$ 对应的全局坐标 $(x, y)$ 由下式给出：\n$$x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i$$\n$$y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i$$\n4 节点四边形单元的标准双线性形函数（从 $(\\xi, \\eta) = (-1, -1)$ 处的节点 1 开始逆时针排序）为：\n$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n\n给定的节点全局坐标为：\n- 节点 1： $(x_1, y_1) = (0, 0)$\n- 节点 2： $(x_2, y_2) = (2, 0)$\n- 节点 3： $(x_3, y_3) = (3, 1)$\n- 节点 4： $(x_4, y_4) = (-1, 1)$\n\n将这些坐标代入映射方程：\n$$x(\\xi, \\eta) = N_1(\\xi, \\eta)(0) + N_2(\\xi, \\eta)(2) + N_3(\\xi, \\eta)(3) + N_4(\\xi, \\eta)(-1)$$\n$$y(\\xi, \\eta) = N_1(\\xi, \\eta)(0) + N_2(\\xi, \\eta)(0) + N_3(\\xi, \\eta)(1) + N_4(\\xi, \\eta)(1)$$\n\n让我们展开并简化这些表达式：\n对于 $x(\\xi, \\eta)$:\n$$x(\\xi, \\eta) = \\frac{1}{4} [2(1+\\xi)(1-\\eta) + 3(1+\\xi)(1+\\eta) - (1-\\xi)(1+\\eta)]$$\n$$4x = 2(1-\\eta+\\xi-\\xi\\eta) + 3(1+\\eta+\\xi+\\xi\\eta) - (1+\\eta-\\xi-\\xi\\eta)$$\n$$4x = (2+3-1) + (-2+3-1)\\eta + (2+3+1)\\xi + (-2+3+1)\\xi\\eta$$\n$$4x = 4 + 0\\eta + 6\\xi + 2\\xi\\eta$$\n$$x(\\xi, \\eta) = 1 + \\frac{3}{2}\\xi + \\frac{1}{2}\\xi\\eta$$\n\n对于 $y(\\xi, \\eta)$:\n$$y(\\xi, \\eta) = \\frac{1}{4} [(1+\\xi)(1+\\eta) + (1-\\xi)(1+\\eta)]$$\n$$4y = (1+\\eta) [(1+\\xi) + (1-\\xi)]$$\n$$4y = (1+\\eta)(2)$$\n$$y(\\xi, \\eta) = \\frac{1}{2}(1+\\eta)$$\n\n从 $(\\xi, \\eta)$ 到 $(x, y)$ 变换的雅可比矩阵 $\\mathbf{J}$ 定义为：\n$$\\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}$$\n我们根据简化后的映射方程计算偏导数：\n$\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} (1 + \\frac{3}{2}\\xi + \\frac{1}{2}\\xi\\eta) = \\frac{3}{2} + \\frac{1}{2}\\eta$\n$\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} (1 + \\frac{3}{2}\\xi + \\frac{1}{2}\\xi\\eta) = \\frac{1}{2}\\xi$\n$\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} (\\frac{1}{2}(1+\\eta)) = 0$\n$\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} (\\frac{1}{2}(1+\\eta)) = \\frac{1}{2}$\n\n组装雅可比矩阵：\n$$\\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} \\frac{3}{2} + \\frac{1}{2}\\eta  \\frac{1}{2}\\xi \\\\ 0  \\frac{1}{2} \\end{pmatrix}$$\n\n雅可比行列式 $\\det \\mathbf{J}$ 为：\n$$\\det \\mathbf{J}(\\xi, \\eta) = \\left(\\frac{3}{2} + \\frac{1}{2}\\eta\\right)\\left(\\frac{1}{2}\\right) - \\left(\\frac{1}{2}\\xi\\right)(0) = \\frac{3}{4} + \\frac{1}{4}\\eta$$\n\n我们必须在 $2 \\times 2$ Gauss-Legendre 积分点 $(\\xi_i, \\eta_j)$ 处计算该行列式的绝对值，其中 $\\xi_i, \\eta_j \\in \\{-g, g\\}$ 且 $g = 1/\\sqrt{3}$。问题指定的求值顺序为：$(-g, -g)$、$(g, -g)$、$(g, g)$、$(-g, g)$。\n\n点 1： $(\\xi, \\eta) = (-g, -g) = (-1/\\sqrt{3}, -1/\\sqrt{3})$\n$$\\det \\mathbf{J} = \\frac{3}{4} + \\frac{1}{4}\\left(-\\frac{1}{\\sqrt{3}}\\right) = \\frac{3}{4} - \\frac{1}{4\\sqrt{3}} = \\frac{3\\sqrt{3}-1}{4\\sqrt{3}}$$\n为验证符号，我们检查 $3\\sqrt{3}  1$ 是否成立。两边平方得 $27  1$，此式成立。因此，行列式为正。\n$|\\det \\mathbf{J}| = \\frac{3}{4} - \\frac{1}{4\\sqrt{3}} = \\frac{3}{4} - \\frac{\\sqrt{3}}{12} = \\frac{9-\\sqrt{3}}{12}$。\n\n点 2： $(\\xi, \\eta) = (g, -g) = (1/\\sqrt{3}, -1/\\sqrt{3})$\n行列式表达式 $\\frac{3}{4} + \\frac{1}{4}\\eta$ 仅取决于 $\\eta$。由于 $\\eta = -1/\\sqrt{3}$ 与点 1 的情况相同，因此行列式的值也相同。\n$|\\det \\mathbf{J}| = \\frac{9-\\sqrt{3}}{12}$。\n\n点 3： $(\\xi, \\eta) = (g, g) = (1/\\sqrt{3}, 1/\\sqrt{3})$\n$$\\det \\mathbf{J} = \\frac{3}{4} + \\frac{1}{4}\\left(\\frac{1}{\\sqrt{3}}\\right) = \\frac{3}{4} + \\frac{1}{4\\sqrt{3}} = \\frac{3\\sqrt{3}+1}{4\\sqrt{3}}$$\n这个值显然是正的。\n$|\\det \\mathbf{J}| = \\frac{3}{4} + \\frac{1}{4\\sqrt{3}} = \\frac{3}{4} + \\frac{\\sqrt{3}}{12} = \\frac{9+\\sqrt{3}}{12}$。\n\n点 4： $(\\xi, \\eta) = (-g, g) = (-1/\\sqrt{3}, 1/\\sqrt{3})$\n行列式仅取决于 $\\eta$。由于 $\\eta = 1/\\sqrt{3}$ 与点 3 的情况相同，因此行列式的值也相同。\n$|\\det \\mathbf{J}| = \\frac{9+\\sqrt{3}}{12}$。\n\n最终答案是由这 4 个值组成的有序行矩阵。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{9-\\sqrt{3}}{12}  \\frac{9-\\sqrt{3}}{12}  \\frac{9+\\sqrt{3}}{12}  \\frac{9+\\sqrt{3}}{12}\n\\end{pmatrix}\n}\n$$", "id": "2582348"}, {"introduction": "在掌握了雅可比行列式的计算之后，本练习将探讨其直接带来的影响。当单元被扭曲时，其雅可比行列式不再是常数，这在使用简化的数值积分方案时可能会引入误差。本练习 [@problem_id:2582325] 通过让你计算所谓的“混淆误差”（aliasing error），清晰地揭示了在非理想单元形状下，计算效率（减缩积分）与精度之间的权衡。", "problem": "考虑一个等参双线性四边形有限元，它通过标准的双线性形函数 $N_{i}(\\xi,\\eta)$，$i=1,2,3,4$，将自然坐标 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 映射到全局坐标 $(x,y)$。在自然坐标系中，节点从左下角开始按逆时针顺序排列。该映射为\n$$\nx(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,x_{i},\\qquad\ny(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,y_{i},\n$$\n其中\n$$\nN_{1}(\\xi,\\eta)=\\frac{(1-\\xi)(1-\\eta)}{4},\\quad\nN_{2}(\\xi,\\eta)=\\frac{(1+\\xi)(1-\\eta)}{4},\\quad\nN_{3}(\\xi,\\eta)=\\frac{(1+\\xi)(1+\\eta)}{4},\\quad\nN_{4}(\\xi,\\eta)=\\frac{(1-\\xi)(1+\\eta)}{4}.\n$$\n设全局节点坐标为\n$$\n(x_{1},y_{1})=(0,0),\\quad (x_{2},y_{2})=(2,0),\\quad (x_{3},y_{3})=(2,2),\\quad (x_{4},y_{4})=(0,1).\n$$\n这一选择产生了一个扭曲的物理单元（不是参考正方形的仿射图像），因此雅可比行列式 $\\det J(\\xi,\\eta)$ 在单元上是变化的。考虑自然坐标系中的多项式被积函数\n$$\nq(\\xi,\\eta)=\\xi,\n$$\n以及相关的物理积分\n$$\nI=\\int_{-1}^{1}\\int_{-1}^{1} q(\\xi,\\eta)\\,\\det J(\\xi,\\eta)\\,d\\xi\\,d\\eta.\n$$\n使用在 $[-1,1]\\times[-1,1]$ 上的减缩单点高斯法则（在 $(\\xi,\\eta)=(0,0)$ 处采样，总权重为 $4$），定义 $I$ 的减缩求积近似值 $I_{\\mathrm{rq}}$。从等参映射和雅可比矩阵的基本定义出发，推导给定节点的 $\\det J(\\xi,\\eta)$，然后计算混淆误差\n$$\nE = I - I_{\\mathrm{rq}}.\n$$\n请给出精确值作为最终答案（不要四舍五入）。不需要物理单位。", "solution": "在尝试任何求解之前，首先对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n所提供的数据和定义如下：\n- 一个自然坐标为 $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ 的等参双线性四边形有限元。\n- 坐标映射由 $x(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,x_{i}$ 和 $y(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,y_{i}$ 给出。\n- 双线性形函数为：\n$N_{1}(\\xi,\\eta)=\\frac{(1-\\xi)(1-\\eta)}{4}$，$N_{2}(\\xi,\\eta)=\\frac{(1+\\xi)(1-\\eta)}{4}$，$N_{3}(\\xi,\\eta)=\\frac{(1+\\xi)(1+\\eta)}{4}$，$N_{4}(\\xi,\\eta)=\\frac{(1-\\xi)(1+\\eta)}{4}$。\n- 全局节点坐标为：\n$(x_{1},y_{1})=(0,0)$，$(x_{2},y_{2})=(2,0)$，$(x_{3},y_{3})=(2,2)$，$(x_{4},y_{4})=(0,1)$。\n- 自然坐标系中的多项式被积函数为 $q(\\xi,\\eta)=\\xi$。\n- 精确的物理积分为 $I=\\int_{-1}^{1}\\int_{-1}^{1} q(\\xi,\\eta)\\,\\det J(\\xi,\\eta)\\,d\\xi\\,d\\eta$。\n- 指定了减缩单点高斯求积法则，采样点为 $(\\xi,\\eta)=(0,0)$，权重为 $4$。积分的近似值记为 $I_{\\mathrm{rq}}$。\n- 目标是计算混淆误差 $E = I - I_{\\mathrm{rq}}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，是适定且客观的。这是有限元法（FEM）中的一个标准练习，具体涉及等参映射和数值积分。所有定义和数据都是一致且完整的。没有违反科学原理、逻辑矛盾或模糊不清之处。该问题是形式化的且可解的。\n\n**步骤 3：结论与行动**\n问题有效。将推导求解。\n\n求解过程首先确定从自然坐标到全局坐标映射的显式形式，然后计算雅可比矩阵及其行列式。接着，计算精确积分 $I$ 和数值近似积分 $I_{\\mathrm{rq}}$，它们的差值即为混淆误差 $E$。\n\n首先，我们将给定的节点坐标代入映射定义中，以建立坐标变换方程 $x(\\xi, \\eta)$ 和 $y(\\xi, \\eta)$。\n对于 $x$ 坐标：\n$$\nx(\\xi, \\eta) = N_{1}(\\xi,\\eta)x_{1} + N_{2}(\\xi,\\eta)x_{2} + N_{3}(\\xi,\\eta)x_{3} + N_{4}(\\xi,\\eta)x_{4}\n$$\n$$\nx(\\xi, \\eta) = \\frac{(1-\\xi)(1-\\eta)}{4}(0) + \\frac{(1+\\xi)(1-\\eta)}{4}(2) + \\frac{(1+\\xi)(1+\\eta)}{4}(2) + \\frac{(1-\\xi)(1+\\eta)}{4}(0)\n$$\n$$\nx(\\xi, \\eta) = \\frac{1}{2}(1+\\xi)(1-\\eta) + \\frac{1}{2}(1+\\xi)(1+\\eta) = \\frac{1}{2}(1+\\xi)[(1-\\eta) + (1+\\eta)] = \\frac{1}{2}(1+\\xi)(2) = 1+\\xi\n$$\n对于 $y$ 坐标：\n$$\ny(\\xi, \\eta) = N_{1}(\\xi,\\eta)y_{1} + N_{2}(\\xi,\\eta)y_{2} + N_{3}(\\xi,\\eta)y_{3} + N_{4}(\\xi,\\eta)y_{4}\n$$\n$$\ny(\\xi, \\eta) = \\frac{(1-\\xi)(1-\\eta)}{4}(0) + \\frac{(1+\\xi)(1-\\eta)}{4}(0) + \\frac{(1+\\xi)(1+\\eta)}{4}(2) + \\frac{(1-\\xi)(1+\\eta)}{4}(1)\n$$\n$$\ny(\\xi, \\eta) = \\frac{1}{2}(1+\\xi)(1+\\eta) + \\frac{1}{4}(1-\\xi)(1+\\eta) = \\frac{1+\\eta}{4}[2(1+\\xi) + (1-\\xi)] = \\frac{1+\\eta}{4}[2+2\\xi+1-\\xi] = \\frac{1}{4}(1+\\eta)(3+\\xi)\n$$\n因此，映射由 $x(\\xi, \\eta) = 1+\\xi$ 和 $y(\\xi, \\eta) = \\frac{1}{4}(1+\\eta)(3+\\xi)$ 给出。\n\n接下来，我们定义变换的雅可比矩阵 $J(\\xi, \\eta)$：\n$$\nJ(\\xi, \\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n我们计算必要的偏导数：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(1+\\xi) = 1\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(1+\\xi) = 0\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}\\left(\\frac{1}{4}(1+\\eta)(3+\\xi)\\right) = \\frac{1}{4}(1+\\eta)\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}\\left(\\frac{1}{4}(1+\\eta)(3+\\xi)\\right) = \\frac{1}{4}(3+\\xi)\n$$\n将这些代入雅可比矩阵：\n$$\nJ(\\xi, \\eta) = \\begin{pmatrix} 1  0 \\\\ \\frac{1}{4}(1+\\eta)  \\frac{1}{4}(3+\\xi) \\end{pmatrix}\n$$\n雅可比矩阵的行列式 $\\det J(\\xi, \\eta)$ 为：\n$$\n\\det J(\\xi, \\eta) = (1)\\left(\\frac{1}{4}(3+\\xi)\\right) - (0)\\left(\\frac{1}{4}(1+\\eta)\\right) = \\frac{1}{4}(3+\\xi)\n$$\n正如所料，行列式不是常数，这证实了这是一个非仿射映射。\n\n现在，我们计算精确积分 $I$：\n$$\nI = \\int_{-1}^{1}\\int_{-1}^{1} q(\\xi, \\eta) \\det J(\\xi, \\eta) \\,d\\xi\\,d\\eta = \\int_{-1}^{1}\\int_{-1}^{1} \\xi \\left(\\frac{1}{4}(3+\\xi)\\right) \\,d\\xi\\,d\\eta\n$$\n被积函数为 $f(\\xi,\\eta) = \\frac{3}{4}\\xi + \\frac{1}{4}\\xi^2$。我们可以分离积分：\n$$\nI = \\int_{-1}^{1} \\left[ \\int_{-1}^{1} \\left(\\frac{3}{4}\\xi + \\frac{1}{4}\\xi^2\\right) d\\eta \\right] d\\xi\n$$\n首先，对 $\\eta$ 进行积分：\n$$\n\\int_{-1}^{1} \\left(\\frac{3}{4}\\xi + \\frac{1}{4}\\xi^2\\right) d\\eta = \\left(\\frac{3}{4}\\xi + \\frac{1}{4}\\xi^2\\right) [\\eta]_{-1}^{1} = \\left(\\frac{3}{4}\\xi + \\frac{1}{4}\\xi^2\\right)(1 - (-1)) = 2\\left(\\frac{3}{4}\\xi + \\frac{1}{4}\\xi^2\\right) = \\frac{3}{2}\\xi + \\frac{1}{2}\\xi^2\n$$\n现在，将结果对 $\\xi$ 进行积分：\n$$\nI = \\int_{-1}^{1} \\left(\\frac{3}{2}\\xi + \\frac{1}{2}\\xi^2\\right) d\\xi = \\left[ \\frac{3}{2}\\frac{\\xi^2}{2} + \\frac{1}{2}\\frac{\\xi^3}{3} \\right]_{-1}^{1} = \\left[ \\frac{3}{4}\\xi^2 + \\frac{1}{6}\\xi^3 \\right]_{-1}^{1}\n$$\n$$\nI = \\left(\\frac{3}{4}(1)^2 + \\frac{1}{6}(1)^3\\right) - \\left(\\frac{3}{4}(-1)^2 + \\frac{1}{6}(-1)^3\\right) = \\left(\\frac{3}{4} + \\frac{1}{6}\\right) - \\left(\\frac{3}{4} - \\frac{1}{6}\\right) = \\frac{2}{6} = \\frac{1}{3}\n$$\n所以，积分的精确值为 $I = \\frac{1}{3}$。\n\n接下来，我们使用单点高斯法则计算近似积分 $I_{\\mathrm{rq}}$。该法则将函数 $f(\\xi,\\eta)$ 的积分近似为权重 $w$ 与函数在采样点 $(\\xi_p, \\eta_p)$ 处的值的乘积。\n这里，$w=4$ 且 $(\\xi_p, \\eta_p)=(0,0)$。被积函数为 $f(\\xi,\\eta) = q(\\xi,\\eta)\\det J(\\xi,\\eta) = \\frac{3}{4}\\xi + \\frac{1}{4}\\xi^2$。\n$$\nI_{\\mathrm{rq}} = w \\cdot f(\\xi_p, \\eta_p) = 4 \\cdot f(0,0)\n$$\n我们计算被积函数在 $(0,0)$ 处的值：\n$$\nf(0,0) = \\frac{3}{4}(0) + \\frac{1}{4}(0)^2 = 0\n$$\n因此，近似积分为：\n$$\nI_{\\mathrm{rq}} = 4 \\cdot 0 = 0\n$$\n\n最后，我们计算混淆误差 $E$，即精确积分与近似积分之差：\n$$\nE = I - I_{\\mathrm{rq}} = \\frac{1}{3} - 0 = \\frac{1}{3}\n$$\n出现误差的原因是，单点求积法则在域 $[-1,1] \\times [-1,1]$ 上只能对常数函数进行精确积分。被积函数包含关于 $\\xi$ 的线性和二次项，该法则无法正确积分这些项。线性项在对称区间上的积分为零，但二次项不为零，从而导致了非零误差。", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "2582325"}, {"introduction": "最后的这个实践深入探讨了等参单元中一个更为精妙但至关重要的方面：插值精度的损失。尽管高阶单元旨在精确表示复杂的场，但如果单元的几何形状本身是扭曲的，其插值能力就可能受到影响。本练习 [@problem_id:2582354] 将通过一个具体的例子，向你展示一个“巧凑”单元（serendipity element）即便拥有二次形函数，在非仿射映射的几何体上，也无法完美地捕捉一个简单的二次场，这对高级有限元分析从业者来说是一个关键的洞见。", "problem": "考虑一个在等参格式下构建的八节点 serendipity 四边形有限元。令自然（单元局部）坐标系表示为 $(\\xi,\\eta)\\in[-1,1]^2$，并令 $(x,y)$ 表示全局笛卡尔坐标。四个角节点在全局坐标系中的位置如下\n$$(x_1,y_1)=(0,0),\\quad (x_2,y_2)=(2,0),\\quad (x_3,y_3)=(2.5,1),\\quad (x_4,y_4)=(-0.5,1)。$$\n通过由四个角节点构建的标准双线性四节点等参映射，定义从 $(\\xi,\\eta)$ 到 $(x,y)$ 的几何映射。将八节点 serendipity 单元的四个边中节点置于此双线性几何映射下 $(\\xi,\\eta)=(0,-1)$, $(1,0)$, $(0,1)$ 和 $(-1,0)$ 的像点上。考虑全局坐标下的精确标量场\n$$u(x,y)=x^2+y^2+xy。$$\n通过将节点值赋为在八个节点全局坐标处计算的精确场的值，并使用 $(\\xi,\\eta)$ 中的标准八节点 serendipity 形函数，在自然坐标系中构建 serendipity 八节点拉格朗日插值 $u_h(\\xi,\\eta)$。\n\n仅使用这些定义，计算单元中心的插值误差，\n$$e:=u_h(0,0)-u\\bigl(x(0,0),y(0,0)\\bigr)。$$\n将最终答案表示为一个精确的有理数。无需四舍五入。答案是无量纲的。", "solution": "该问题是适定的且科学上合理的，是有限元方法中的一个标准练习。我们开始求解。任务是计算一个八节点 serendipity 单元中心的插值误差 $e = u_h(0,0) - u\\bigl(x(0,0),y(0,0)\\bigr)$。这需要以下几个步骤：\n1.  定义从自然坐标 $(\\xi, \\eta)$ 到全局坐标 $(x,y)$ 的几何映射。\n2.  确定所有八个节点的全局坐标。\n3.  在这些节点坐标处计算精确场 $u(x,y)$ 以获得节点值 $u_i$。\n4.  定义 serendipity 插值 $u_h(\\xi,\\eta)$ 并在单元中心 $(\\xi,\\eta)=(0,0)$ 处对其求值。\n5.  确定单元中心对应的全局坐标，并在该点计算精确场 $u(x,y)$。\n6.  计算中心点插值与精确值之间的差值。\n\n步骤 1：几何映射\n问题为几何形状指定了一个基于四个角节点的双线性四节点等参映射。该映射由下式给出\n$$x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i^{Q4}(\\xi, \\eta) x_i$$\n$$y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i^{Q4}(\\xi, \\eta) y_i$$\n其中 $(x_i, y_i)$ 是角节点的全局坐标，而 $N_i^{Q4}$ 是双线性形函数：\n$N_1^{Q4} = \\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_2^{Q4} = \\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_3^{Q4} = \\frac{1}{4}(1+\\xi)(1+\\eta)$, $N_4^{Q4} = \\frac{1}{4}(1-\\xi)(1+\\eta)$.\n角节点位于 $(x_1,y_1)=(0,0)$，$(x_2,y_2)=(2,0)$，$(x_3,y_3)=(2.5,1)$ 和 $(x_4,y_4)=(-0.5,1)$。\n将这些坐标代入映射方程：\n对于 $y$ 坐标：\n$$y(\\xi, \\eta) = 0 \\cdot N_1^{Q4} + 0 \\cdot N_2^{Q4} + 1 \\cdot N_3^{Q4} + 1 \\cdot N_4^{Q4} = N_3^{Q4} + N_4^{Q4}$$\n$$y(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) + \\frac{1}{4}(1-\\xi)(1+\\eta) = \\frac{1}{4}(1+\\eta) \\bigl( (1+\\xi) + (1-\\xi) \\bigr) = \\frac{1}{2}(1+\\eta)$$\n对于 $x$ 坐标：\n$$x(\\xi, \\eta) = 0 \\cdot N_1^{Q4} + 2 \\cdot N_2^{Q4} + 2.5 \\cdot N_3^{Q4} - 0.5 \\cdot N_4^{Q4}$$\n$$x(\\xi, \\eta) = 2 \\cdot \\frac{1}{4}(1+\\xi)(1-\\eta) + \\frac{5}{2} \\cdot \\frac{1}{4}(1+\\xi)(1+\\eta) - \\frac{1}{2} \\cdot \\frac{1}{4}(1-\\xi)(1+\\eta)$$\n$$x(\\xi, \\eta) = \\frac{1}{4} \\left[ 2(1+\\xi-\\eta-\\xi\\eta) + \\frac{5}{2}(1+\\xi+\\eta+\\xi\\eta) - \\frac{1}{2}(1-\\xi+\\eta-\\xi\\eta) \\right]$$\n按 $\\xi$ 和 $\\eta$ 的幂次合并项：\n$$x(\\xi, \\eta) = \\frac{1}{4} \\left[ (2 + \\frac{5}{2} - \\frac{1}{2}) + (2 + \\frac{5}{2} + \\frac{1}{2})\\xi + (-2 + \\frac{5}{2} - \\frac{1}{2})\\eta + (-2 + \\frac{5}{2} + \\frac{1}{2})\\xi\\eta \\right]$$\n$$x(\\xi, \\eta) = \\frac{1}{4} \\left[ 4 + 5\\xi + 0\\eta + 1\\xi\\eta \\right] = 1 + \\frac{5}{4}\\xi + \\frac{1}{4}\\xi\\eta$$\n因此，几何映射为 $(x(\\xi, \\eta), y(\\xi, \\eta)) = \\left(1 + \\frac{5}{4}\\xi + \\frac{1}{4}\\xi\\eta, \\frac{1}{2}(1+\\eta)\\right)$。\n\n步骤 2：节点坐标\nserendipity 单元的八个节点对应于 $i=1,\\dots,8$ 的自然坐标 $(\\xi_i, \\eta_i)$：\n角节点：$(\\xi_1, \\eta_1) = (-1,-1)$, $(\\xi_2, \\eta_2) = (1,-1)$, $(\\xi_3, \\eta_3) = (1,1)$, $(\\xi_4, \\eta_4) = (-1,1)$。\n边中节点：$(\\xi_5, \\eta_5) = (0,-1)$, $(\\xi_6, \\eta_6) = (1,0)$, $(\\xi_7, \\eta_7) = (0,1)$, $(\\xi_8, \\eta_8) = (-1,0)$。\n全局坐标 $(x_i, y_i)$ 如下：\n$(x_1, y_1) = (0,0)$ (给定)\n$(x_2, y_2) = (2,0)$ (给定)\n$(x_3, y_3) = (2.5, 1) = (\\frac{5}{2}, 1)$ (给定)\n$(x_4, y_4) = (-0.5, 1) = (-\\frac{1}{2}, 1)$ (给定)\n$x_5 = x(0,-1) = 1$, $y_5 = y(0,-1) = \\frac{1}{2}(1-1)=0$。所以，$(x_5, y_5) = (1,0)$。\n$x_6 = x(1,0) = 1 + \\frac{5}{4} = \\frac{9}{4}$, $y_6 = y(1,0) = \\frac{1}{2}(1+0)=\\frac{1}{2}$。所以，$(x_6, y_6) = (\\frac{9}{4}, \\frac{1}{2})$。\n$x_7 = x(0,1) = 1$, $y_7 = y(0,1) = \\frac{1}{2}(1+1)=1$。所以，$(x_7, y_7) = (1,1)$。\n$x_8 = x(-1,0) = 1 - \\frac{5}{4} = -\\frac{1}{4}$, $y_8 = y(-1,0) = \\frac{1}{2}(1+0)=\\frac{1}{2}$。所以，$(x_8, y_8) = (-\\frac{1}{4}, \\frac{1}{2})$。\n\n步骤 3：节点值\n我们在八个节点上计算精确场 $u(x,y)=x^2+y^2+xy$ 的值：\n$u_1=u(0,0)=0$。\n$u_2=u(2,0)=2^2+0^2+2\\cdot0=4$。\n$u_3=u(\\frac{5}{2},1)=(\\frac{5}{2})^2+1^2+(\\frac{5}{2})(1)=\\frac{25}{4}+1+\\frac{5}{2} = \\frac{25+4+10}{4} = \\frac{39}{4}$。\n$u_4=u(-\\frac{1}{2},1)=(-\\frac{1}{2})^2+1^2+(-\\frac{1}{2})(1)=\\frac{1}{4}+1-\\frac{1}{2} = \\frac{1+4-2}{4} = \\frac{3}{4}$。\n$u_5=u(1,0)=1^2+0^2+1\\cdot0=1$。\n$u_6=u(\\frac{9}{4},\\frac{1}{2})=(\\frac{9}{4})^2+(\\frac{1}{2})^2+(\\frac{9}{4})(\\frac{1}{2})=\\frac{81}{16}+\\frac{1}{4}+\\frac{9}{8} = \\frac{81+4+18}{16} = \\frac{103}{16}$。\n$u_7=u(1,1)=1^2+1^2+1\\cdot1=3$。\n$u_8=u(-\\frac{1}{4},\\frac{1}{2})=(-\\frac{1}{4})^2+(\\frac{1}{2})^2+(-\\frac{1}{4})(\\frac{1}{2})=\\frac{1}{16}+\\frac{1}{4}-\\frac{1}{8} = \\frac{1+4-2}{16} = \\frac{3}{16}$。\n\n步骤 4：中心点的插值\n插值场为 $u_h(\\xi,\\eta) = \\sum_{i=1}^8 N_i^{Q8s}(\\xi,\\eta) u_i$。我们必须在 $(\\xi,\\eta)=(0,0)$ 处计算该值。中心点的 serendipity 形函数 $N_i^{Q8s}$ 如下：\n对于角节点 $i=1,2,3,4$：$N_i^{Q8s}(0,0) = \\frac{1}{4}(1+\\xi_i\\cdot0)(1+\\eta_i\\cdot0)(\\xi_i\\cdot0+\\eta_i\\cdot0-1) = -\\frac{1}{4}$。\n对于边中节点 $i=5,7$（其中 $\\xi_i=0$）：$N_i^{Q8s}(0,0) = \\frac{1}{2}(1-0^2)(1+\\eta_i\\cdot0)=\\frac{1}{2}$。\n对于边中节点 $i=6,8$（其中 $\\eta_i=0$）：$N_i^{Q8s}(0,0) = \\frac{1}{2}(1+\\xi_i\\cdot0)(1-0^2)=\\frac{1}{2}$。\n所以，$u_h(0,0) = \\sum_{i=1}^8 N_i^{Q8s}(0,0) u_i = -\\frac{1}{4}(u_1+u_2+u_3+u_4) + \\frac{1}{2}(u_5+u_6+u_7+u_8)$。\n角节点值的总和：$u_1+u_2+u_3+u_4 = 0+4+\\frac{39}{4}+\\frac{3}{4} = 4+\\frac{42}{4} = 4+\\frac{21}{2}=\\frac{29}{2}$。\n边中节点值的总和：$u_5+u_6+u_7+u_8 = 1+\\frac{103}{16}+3+\\frac{3}{16} = 4+\\frac{106}{16} = 4+\\frac{53}{8}=\\frac{32+53}{8}=\\frac{85}{8}$。\n插值为：\n$$u_h(0,0) = -\\frac{1}{4}\\left(\\frac{29}{2}\\right) + \\frac{1}{2}\\left(\\frac{85}{8}\\right) = -\\frac{29}{8} + \\frac{85}{16} = \\frac{-58+85}{16} = \\frac{27}{16}$$\n\n步骤 5：中心点的精确值\n单元中心 $(\\xi,\\eta)=(0,0)$ 的全局坐标是：\n$x_c = x(0,0) = 1 + \\frac{5}{4}(0) + \\frac{1}{4}(0)(0) = 1$。\n$y_c = y(0,0) = \\frac{1}{2}(1+0) = \\frac{1}{2}$。\n在 $(x_c, y_c) = (1, \\frac{1}{2})$ 处的精确场值为：\n$$u(1, \\frac{1}{2}) = 1^2 + (\\frac{1}{2})^2 + (1)(\\frac{1}{2}) = 1 + \\frac{1}{4} + \\frac{1}{2} = \\frac{4+1+2}{4} = \\frac{7}{4}$$\n\n步骤 6：插值误差\n误差是插值与精确值之间的差值：\n$$e = u_h(0,0) - u(x(0,0), y(0,0)) = \\frac{27}{16} - \\frac{7}{4} = \\frac{27}{16} - \\frac{28}{16} = -\\frac{1}{16}$$", "answer": "$$\\boxed{-\\frac{1}{16}}$$", "id": "2582354"}]}