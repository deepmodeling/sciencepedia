{"hands_on_practices": [{"introduction": "在等参有限元方法中，所有计算的起点都源于父单元。本练习将带你实践一项核心技能：如何利用雅可比矩阵，将在简单的父单元上计算的梯度，转换为物理单元中的梯度[@problem_id:2585622]。掌握这一转换是计算单元刚度矩阵等后续步骤的基础。", "id": "2585622", "problem": "在用于二维问题的等参有限元法 (FEM) 中，从具有自然坐标的母域到物理域的映射使得能够使用链式法则计算物理空间中形函数的梯度。考虑一个四节点双线性四边形单元（通常称为Q4单元），其母（参考）域为自然坐标 $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$ 中的正方形。该物理单元是一个矩形，其节点按逆时针顺序排列：\n- 节点 $1$ 位于 $(x_1,y_1)=(0,0)$，\n- 节点 $2$ 位于 $(x_2,y_2)=(2,0)$，\n- 节点 $3$ 位于 $(x_3,y_3)=(2,1)$，\n- 节点 $4$ 位于 $(x_4,y_4)=(0,1)$。\n\n设母域上的双线性形函数为标准的四节点多项式，\n\n$$\nN_1(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_2(\\xi,\\eta)=\\tfrac{1}{4}(1+\\xi)(1-\\eta),\\quad\nN_3(\\xi,\\eta)=\\tfrac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_4(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1+\\eta).\n$$\n\n到物理坐标的等参映射定义为\n\n$$\nx(\\xi,\\eta)=\\sum_{a=1}^{4}N_a(\\xi,\\eta)\\,x_a,\\qquad\ny(\\xi,\\eta)=\\sum_{a=1}^{4}N_a(\\xi,\\eta)\\,y_a.\n$$\n\n\n仅使用这些定义和多元微积分的链式法则，推导该单元的映射雅可比矩阵及其逆转置，然后计算物理梯度 $\\nabla_{x} N_2$（其中 $\\nabla_{x}:=\\bigl[\\partial/\\partial x,\\ \\partial/\\partial y\\bigr]^{\\mathsf T}$）在母域中四个标准的两点张量积高斯求积点处的值，\n\n$$\n(\\xi,\\eta)\\in\\left\\{ \\left(-\\tfrac{1}{\\sqrt{3}},-\\tfrac{1}{\\sqrt{3}}\\right),\\ \\left(\\tfrac{1}{\\sqrt{3}},-\\tfrac{1}{\\sqrt{3}}\\right),\\ \\left(\\tfrac{1}{\\sqrt{3}},\\tfrac{1}{\\sqrt{3}}\\right),\\ \\left(-\\tfrac{1}{\\sqrt{3}},\\tfrac{1}{\\sqrt{3}}\\right) \\right\\}.\n$$\n\n\n将您的最终答案表示为一个单行矩阵，按以下顺序列出各分量\n\n$$\n\\bigl[\\ (\\partial N_2/\\partial x)\\text{ at }P_1,\\ (\\partial N_2/\\partial y)\\text{ at }P_1,\\ (\\partial N_2/\\partial x)\\text{ at }P_2,\\ (\\partial N_2/\\partial y)\\text{ at }P_2,\\ (\\partial N_2/\\partial x)\\text{ at }P_3,\\ (\\partial N_2/\\partial y)\\text{ at }P_3,\\ (\\partial N_2/\\partial x)\\text{ at }P_4,\\ (\\partial N_2/\\partial y)\\text{ at }P_4\\ \\bigr],\n$$\n\n其中点 $P_1,P_2,P_3,P_4$ 的顺序如上文所示。给出精确值，无需四舍五入。最终答案必须是按规定格式给出的单个解析表达式。", "solution": "该问题陈述经核实具有科学依据、适定且客观。这是有限元法等参格式化的一个标准练习。所有必要的数据均已提供，问题没有矛盾或歧义。因此，我将开始解答。\n\n问题的核心是将物理域 $(x,y)$ 中形函数的梯度与母域 $(\\xi,\\eta)$ 中其梯度联系起来。这通过多元微积分的链式法则来完成。对于任意函数 $f(\\xi,\\eta)$，其导数关系如下：\n\n$$\n\\frac{\\partial f}{\\partial \\xi} = \\frac{\\partial f}{\\partial x}\\frac{\\partial x}{\\partial \\xi} + \\frac{\\partial f}{\\partial y}\\frac{\\partial y}{\\partial \\xi}\n$$\n$$\n\\frac{\\partial f}{\\partial \\eta} = \\frac{\\partial f}{\\partial x}\\frac{\\partial x}{\\partial \\eta} + \\frac{\\partial f}{\\partial y}\\frac{\\partial y}{\\partial \\eta}\n$$\n\n该方程组可以写成矩阵形式：\n$$\n\\begin{pmatrix} \\frac{\\partial f}{\\partial \\xi} \\\\ \\frac{\\partial f}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial f}{\\partial x} \\\\ \\frac{\\partial f}{\\partial y} \\end{pmatrix}\n$$\n\n从母坐标 $(\\xi,\\eta)$ 到物理坐标 $(x,y)$ 的变换的映射雅可比矩阵（记为 $\\mathbf{J}$）的标准定义是：\n$$\n\\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n\n使用此定义，链式法则关系可用雅可比矩阵的转置 $\\mathbf{J}^{\\mathsf T}$ 表示：\n$$\n\\nabla_{\\xi} f = \\mathbf{J}^{\\mathsf T} \\nabla_{x} f\n$$\n为了求得物理梯度 $\\nabla_{x} f$，我们必须反演此关系：\n$$\n\\nabla_{x} f = (\\mathbf{J}^{\\mathsf T})^{-1} \\nabla_{\\xi} f = (\\mathbf{J}^{-1})^{\\mathsf T} \\nabla_{\\xi} f\n$$\n矩阵 $(\\mathbf{J}^{-1})^{\\mathsf T}$ 是雅可比矩阵的逆转置，这也是问题所要求的。\n\n首先，我们计算雅可比矩阵 $\\mathbf{J}$ 的分量。等参映射由 $x(\\xi,\\eta) = \\sum_{a=1}^{4} N_a(\\xi,\\eta) x_a$ 和 $y(\\xi,\\eta) = \\sum_{a=1}^{4} N_a(\\xi,\\eta) y_a$ 给出。其导数为：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\sum_{a=1}^{4} \\frac{\\partial N_a}{\\partial \\xi} x_a, \\quad \\frac{\\partial x}{\\partial \\eta} = \\sum_{a=1}^{4} \\frac{\\partial N_a}{\\partial \\eta} x_a\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\sum_{a=1}^{4} \\frac{\\partial N_a}{\\partial \\xi} y_a, \\quad \\frac{\\partial y}{\\partial \\eta} = \\sum_{a=1}^{4} \\frac{\\partial N_a}{\\partial \\eta} y_a\n$$\n\n形函数关于自然坐标的导数是：\n$$\n\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi)\n$$\n$$\n\\frac{\\partial N_2}{\\partial \\xi} = \\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_2}{\\partial \\eta} = -\\frac{1}{4}(1+\\xi)\n$$\n$$\n\\frac{\\partial N_3}{\\partial \\xi} = \\frac{1}{4}(1+\\eta), \\quad \\frac{\\partial N_3}{\\partial \\eta} = \\frac{1}{4}(1+\\xi)\n$$\n$$\n\\frac{\\partial N_4}{\\partial \\xi} = -\\frac{1}{4}(1+\\eta), \\quad \\frac{\\partial N_4}{\\partial \\eta} = \\frac{1}{4}(1-\\xi)\n$$\n\n节点坐标为 $(x_1,y_1)=(0,0)$、$(x_2,y_2)=(2,0)$、$(x_3,y_3)=(2,1)$ 和 $(x_4,y_4)=(0,1)$。\n将这些代入雅可比分量的表达式中：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial N_1}{\\partial \\xi}(0) + \\frac{\\partial N_2}{\\partial \\xi}(2) + \\frac{\\partial N_3}{\\partial \\xi}(2) + \\frac{\\partial N_4}{\\partial \\xi}(0) = \\frac{1}{4}(1-\\eta)(2) + \\frac{1}{4}(1+\\eta)(2) = \\frac{1}{2}(1-\\eta+1+\\eta) = 1\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial N_1}{\\partial \\eta}(0) + \\frac{\\partial N_2}{\\partial \\eta}(2) + \\frac{\\partial N_3}{\\partial \\eta}(2) + \\frac{\\partial N_4}{\\partial \\eta}(0) = -\\frac{1}{4}(1+\\xi)(2) + \\frac{1}{4}(1+\\xi)(2) = 0\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial N_1}{\\partial \\xi}(0) + \\frac{\\partial N_2}{\\partial \\xi}(0) + \\frac{\\partial N_3}{\\partial \\xi}(1) + \\frac{\\partial N_4}{\\partial \\xi}(1) = \\frac{1}{4}(1+\\eta)(1) - \\frac{1}{4}(1+\\eta)(1) = 0\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial N_1}{\\partial \\eta}(0) + \\frac{\\partial N_2}{\\partial \\eta}(0) + \\frac{\\partial N_3}{\\partial \\eta}(1) + \\frac{\\partial N_4}{\\partial \\eta}(1) = \\frac{1}{4}(1+\\xi)(1) + \\frac{1}{4}(1-\\xi)(1) = \\frac{1}{4}(1+\\xi+1-\\xi) = \\frac{1}{2}\n$$\n\n雅可比矩阵 $\\mathbf{J}$ 在整个单元上是常数，这对于仿射映射（一个矩形映射到另一个矩形）是预料之中的：\n$$\n\\mathbf{J} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix}\n$$\n雅可比矩阵的行列式为 $\\det(\\mathbf{J}) = (1)(\\frac{1}{2}) - (0)(0) = \\frac{1}{2}$。\n雅可比矩阵的逆为：\n$$\n\\mathbf{J}^{-1} = \\frac{1}{\\det(\\mathbf{J})} \\begin{pmatrix} \\frac{1}{2} & 0 \\\\ 0 & 1 \\end{pmatrix} = 2 \\begin{pmatrix} \\frac{1}{2} & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 2 \\end{pmatrix}\n$$\n所求的逆转置为：\n$$\n(\\mathbf{J}^{-1})^{\\mathsf T} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 2 \\end{pmatrix}^{\\mathsf T} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 2 \\end{pmatrix}\n$$\n\n现在，我们计算形函数 $N_2$ 的物理梯度。首先，我们求其在母域中的梯度：\n$$\n\\nabla_{\\xi} N_2 = \\begin{pmatrix} \\frac{\\partial N_2}{\\partial \\xi} \\\\ \\frac{\\partial N_2}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4}(1-\\eta) \\\\ -\\frac{1}{4}(1+\\xi) \\end{pmatrix}\n$$\n则物理梯度 $\\nabla_{x} N_2$ 为：\n$$\n\\nabla_{x} N_2 = \\begin{pmatrix} \\frac{\\partial N_2}{\\partial x} \\\\ \\frac{\\partial N_2}{\\partial y} \\end{pmatrix} = (\\mathbf{J}^{-1})^{\\mathsf T} \\nabla_{\\xi} N_2 = \\begin{pmatrix} 1 & 0 \\\\ 0 & 2 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{4}(1-\\eta) \\\\ -\\frac{1}{4}(1+\\xi) \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4}(1-\\eta) \\\\ -\\frac{1}{2}(1+\\xi) \\end{pmatrix}\n$$\n\n最后，我们在四个指定的高斯求积点处计算该梯度的值。\n令 $\\alpha = \\frac{1}{\\sqrt{3}}$。这些点是 $P_1(-\\alpha, -\\alpha)$、$P_2(\\alpha, -\\alpha)$、$P_3(\\alpha, \\alpha)$ 和 $P_4(-\\alpha, \\alpha)$。\n\n在点 $P_1: (\\xi,\\eta) = (-\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}})$ 处:\n$$\n\\frac{\\partial N_2}{\\partial x} = \\frac{1}{4}\\left(1 - (-\\frac{1}{\\sqrt{3}})\\right) = \\frac{1}{4}\\left(1 + \\frac{1}{\\sqrt{3}}\\right) = \\frac{\\sqrt{3}+1}{4\\sqrt{3}}\n$$\n$$\n\\frac{\\partial N_2}{\\partial y} = -\\frac{1}{2}\\left(1 + (-\\frac{1}{\\sqrt{3}})\\right) = -\\frac{1}{2}\\left(1 - \\frac{1}{\\sqrt{3}}\\right) = \\frac{1-\\sqrt{3}}{2\\sqrt{3}}\n$$\n\n在点 $P_2: (\\xi,\\eta) = (\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}})$ 处:\n$$\n\\frac{\\partial N_2}{\\partial x} = \\frac{1}{4}\\left(1 - (-\\frac{1}{\\sqrt{3}})\\right) = \\frac{1}{4}\\left(1 + \\frac{1}{\\sqrt{3}}\\right) = \\frac{\\sqrt{3}+1}{4\\sqrt{3}}\n$$\n$$\n\\frac{\\partial N_2}{\\partial y} = -\\frac{1}{2}\\left(1 + \\frac{1}{\\sqrt{3}}\\right) = -\\frac{\\sqrt{3}+1}{2\\sqrt{3}}\n$$\n\n在点 $P_3: (\\xi,\\eta) = (\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}})$ 处:\n$$\n\\frac{\\partial N_2}{\\partial x} = \\frac{1}{4}\\left(1 - \\frac{1}{\\sqrt{3}}\\right) = \\frac{\\sqrt{3}-1}{4\\sqrt{3}}\n$$\n$$\n\\frac{\\partial N_2}{\\partial y} = -\\frac{1}{2}\\left(1 + \\frac{1}{\\sqrt{3}}\\right) = -\\frac{\\sqrt{3}+1}{2\\sqrt{3}}\n$$\n\n在点 $P_4: (\\xi,\\eta) = (-\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}})$ 处:\n$$\n\\frac{\\partial N_2}{\\partial x} = \\frac{1}{4}\\left(1 - \\frac{1}{\\sqrt{3}}\\right) = \\frac{\\sqrt{3}-1}{4\\sqrt{3}}\n$$\n$$\n\\frac{\\partial N_2}{\\partial y} = -\\frac{1}{2}\\left(1 + (-\\frac{1}{\\sqrt{3}})\\right) = -\\frac{1}{2}\\left(1 - \\frac{1}{\\sqrt{3}}\\right) = \\frac{1-\\sqrt{3}}{2\\sqrt{3}}\n$$\n\n将这8个值按规定组合成一个单行矩阵，即可完成解答。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\sqrt{3}+1}{4\\sqrt{3}} & \\frac{1-\\sqrt{3}}{2\\sqrt{3}} & \\frac{\\sqrt{3}+1}{4\\sqrt{3}} & -\\frac{\\sqrt{3}+1}{2\\sqrt{3}} & \\frac{\\sqrt{3}-1}{4\\sqrt{3}} & -\\frac{\\sqrt{3}+1}{2\\sqrt{3}} & \\frac{\\sqrt{3}-1}{4\\sqrt{3}} & \\frac{1-\\sqrt{3}}{2\\sqrt{3}}\n\\end{pmatrix}\n}\n$$"}, {"introduction": "一个有效的有限元网格要求每个单元的几何映射都是一一对应的，这意味着单元不会发生“翻转”或“自相交”。雅可比行列式 $J$ 的符号为我们提供了一个直接的检验方法，即在整个单元域内 $J>0$。本练习将指导你计算一个普通四边形单元的雅可比行列式，并用它来确保映射的有效性[@problem_id:2585784]。", "id": "2585784", "problem": "考虑有限元方法（FEM）中使用的等参双线性映射，该映射从具有自然坐标 $(\\xi,\\eta)$ 的父正方形 $[-1,1] \\times [-1,1]$ 映射到一个物理四边形，其节点排序与父域中相同：节点 $1$ 位于 $(\\xi,\\eta)=(-1,-1)$，节点 $2$ 位于 $(\\xi,\\eta)=(1,-1)$，节点 $3$ 位于 $(\\xi,\\eta)=(1,1)$，节点 $4$ 位于 $(\\xi,\\eta)=(-1,1)$。节点的相应物理坐标为\n- 节点 $1$： $(x_1,y_1)=(0,0)$，\n- 节点 $2$： $(x_2,y_2)=(3,0)$，\n- 节点 $3$： $(x_3,y_3)=(2.5,1.2)$，\n- 节点 $4$： $(x_4,y_4)=(-0.5,1)$。\n\n从父正方形上四节点双线性形函数的标准定义以及等参映射 $x(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)\\,x_i$, $y(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)\\,y_i$ 出发，推导雅可比行列式 $J(\\xi,\\eta)=\\det\\left[\\partial(x,y)/\\partial(\\xi,\\eta)\\right]$ 作为 $(\\xi,\\eta)$ 的显式函数。通过检查物理边的方向以及在关键点的 $J(\\xi,\\eta)$ 符号，确定该映射在整个父正方形上是否为单射。然后计算 $J(\\xi,\\eta)$ 在 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 上的最小值。将您的最终答案表示为精确值。不包含单位。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 父域：在 $(\\xi,\\eta)$ 平面中由 $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$ 定义的正方形。\n- 单元类型：四节点等参双线性单元。\n- 节点映射（自然坐标到物理坐标）：\n  - 节点 $1$： $(\\xi,\\eta)=(-1,-1) \\rightarrow (x_1,y_1)=(0,0)$\n  - 节点 $2$： $(\\xi,\\eta)=(1,-1) \\rightarrow (x_2,y_2)=(3,0)$\n  - 节点 $3$： $(\\xi,\\eta)=(1,1) \\rightarrow (x_3,y_3)=(2.5,1.2)$\n  - 节点 $4$： $(\\xi,\\eta)=(-1,1) \\rightarrow (x_4,y_4)=(-0.5,1)$\n- 等参插值：物理坐标 $(x,y)$ 使用与场变量相同的形函数 $N_i(\\xi, \\eta)$ 从节点坐标插值得到：\n  $$x(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)\\,x_i$$\n  $$y(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)\\,y_i$$\n- 目标：\n  1. 推导雅可比行列式 $J(\\xi,\\eta)=\\det\\left[\\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)}\\right]$。\n  2. 评估映射的单射性。\n  3. 计算 $J(\\xi,\\eta)$ 在父域上的最小值。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题是有限元方法理论中的一个标准练习，涉及单元的几何映射。所有概念在计算力学和应用数学中都是公认的。\n- **适定性：** 该问题提供了构建唯一映射及其雅可比矩阵所需的所有数据（节点坐标）和定义（双线性形函数）。任务具体且在数学上是可解的。\n- **客观性与完整性：** 问题陈述语言精确、客观。它内容完备，没有歧义或矛盾。物理坐标定义了一个凸四边形，这是此类映射的标准情况。\n\n**步骤3：结论与行动**\n问题被判定为**有效**。这是一个计算工程领域中正确且适定的问题。将构建解答。\n\n**雅可比行列式的推导**\n\n四节点四边形单元的标准双线性形函数为：\n$$N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$$\n$$N_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$$\n$$N_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$$\n$$N_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$$\n\n坐标 $x$ 和 $y$ 的等参映射由下式给出：\n$$x(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) x_i$$\n$$y(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) y_i$$\n\n代入给定的节点坐标 $(x_i, y_i)$：\n$x_1=0$, $y_1=0$\n$x_2=3$, $y_2=0$\n$x_3=\\frac{5}{2}$, $y_3=\\frac{6}{5}$\n$x_4=-\\frac{1}{2}$, $y_4=1$\n\n坐标函数为：\n$$x(\\xi,\\eta) = N_2(\\xi,\\eta)(3) + N_3(\\xi,\\eta)(\\frac{5}{2}) + N_4(\\xi,\\eta)(-\\frac{1}{2})$$\n$$y(\\xi,\\eta) = N_3(\\xi,\\eta)(\\frac{6}{5}) + N_4(\\xi,\\eta)(1)$$\n\n展开这些表达式：\n$$x(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)(3) + \\frac{1}{4}(1+\\xi)(1+\\eta)(\\frac{5}{2}) + \\frac{1}{4}(1-\\xi)(1+\\eta)(-\\frac{1}{2})$$\n$$x(\\xi,\\eta) = \\frac{1}{4} \\left[ (3+3\\xi-3\\eta-3\\xi\\eta) + (\\frac{5}{2}+\\frac{5}{2}\\xi+\\frac{5}{2}\\eta+\\frac{5}{2}\\xi\\eta) + (-\\frac{1}{2}+\\frac{1}{2}\\xi-\\frac{1}{2}\\eta+\\frac{1}{2}\\xi\\eta) \\right]$$\n合并同类项：\n$$x(\\xi,\\eta) = \\frac{1}{4} \\left[ (3+\\frac{5}{2}-\\frac{1}{2}) + (3+\\frac{5}{2}+\\frac{1}{2})\\xi + (-3+\\frac{5}{2}-\\frac{1}{2})\\eta + (-3+\\frac{5}{2}+\\frac{1}{2})\\xi\\eta \\right]$$\n$$x(\\xi,\\eta) = \\frac{1}{4} [5 + 6\\xi - 1\\eta + 0\\xi\\eta] = \\frac{5}{4} + \\frac{3}{2}\\xi - \\frac{1}{4}\\eta$$\n\n对于 $y$ 坐标：\n$$y(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)(\\frac{6}{5}) + \\frac{1}{4}(1-\\xi)(1+\\eta)(1)$$\n$$y(\\xi,\\eta) = \\frac{1+\\eta}{4} \\left[ (1+\\xi)(\\frac{6}{5}) + (1-\\xi)(1) \\right] = \\frac{1+\\eta}{4} \\left[ \\frac{6}{5}+\\frac{6}{5}\\xi + 1-\\xi \\right]$$\n$$y(\\xi,\\eta) = \\frac{1+\\eta}{4} \\left[ \\frac{11}{5} + \\frac{1}{5}\\xi \\right] = \\frac{1}{20}(1+\\eta)(11+\\xi)$$\n$$y(\\xi,\\eta) = \\frac{1}{20}(11+\\xi+11\\eta+\\xi\\eta)$$\n\n雅可比矩阵 $\\mathbf{J}$ 定义为 $\\mathbf{J} = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix}$。我们计算其分量：\n$$\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( \\frac{5}{4} + \\frac{3}{2}\\xi - \\frac{1}{4}\\eta \\right) = \\frac{3}{2}$$\n$$\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left( \\frac{5}{4} + \\frac{3}{2}\\xi - \\frac{1}{4}\\eta \\right) = -\\frac{1}{4}$$\n$$\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( \\frac{1}{20}(11+\\xi+11\\eta+\\xi\\eta) \\right) = \\frac{1}{20}(1+\\eta)$$\n$$\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left( \\frac{1}{20}(11+\\xi+11\\eta+\\xi\\eta) \\right) = \\frac{1}{20}(11+\\xi)$$\n\n雅可比矩阵为：\n$$\\mathbf{J}(\\xi,\\eta) = \\begin{bmatrix} \\frac{3}{2} & -\\frac{1}{4} \\\\ \\frac{1}{20}(1+\\eta) & \\frac{1}{20}(11+\\xi) \\end{bmatrix}$$\n\n雅可比行列式 $J(\\xi,\\eta)$ 是该矩阵的行列式：\n$$J(\\xi,\\eta) = \\det(\\mathbf{J}) = \\left(\\frac{3}{2}\\right)\\left(\\frac{1}{20}(11+\\xi)\\right) - \\left(-\\frac{1}{4}\\right)\\left(\\frac{1}{20}(1+\\eta)\\right)$$\n$$J(\\xi,\\eta) = \\frac{3}{40}(11+\\xi) + \\frac{1}{80}(1+\\eta)$$\n为简化起见，我们使用公分母 $80$：\n$$J(\\xi,\\eta) = \\frac{6(11+\\xi)}{80} + \\frac{1+\\eta}{80} = \\frac{66+6\\xi+1+\\eta}{80}$$\n$$J(\\xi,\\eta) = \\frac{67+6\\xi+\\eta}{80}$$\n\n**映射的单射性**\n对于从凸父单元到凸物理单元的等参映射，映射为单射（一对一）的一个充分条件是雅可比行列式 $J(\\xi,\\eta)$ 在父域中的所有点 $(\\xi,\\eta)$ 处都严格为正（或严格为负）。\n推导出的雅可比行列式 $J(\\xi,\\eta) = \\frac{1}{80}(67+6\\xi+\\eta)$ 是一个关于 $\\xi$ 和 $\\eta$ 的线性函数。线性函数在矩形域上的极值必然出现在域的顶点上。我们在父正方形 $[-1,1] \\times [-1,1]$ 的四个角点处计算 $J(\\xi,\\eta)$ 的值：\n- 在 $(\\xi,\\eta)=(-1,-1)$ 处： $J(-1,-1) = \\frac{1}{80}(67 - 6 - 1) = \\frac{60}{80} = \\frac{3}{4}$\n- 在 $(\\xi,\\eta)=(1,-1)$ 处： $J(1,-1) = \\frac{1}{80}(67 + 6 - 1) = \\frac{72}{80} = \\frac{9}{10}$\n- 在 $(\\xi,\\eta)=(1,1)$ 处： $J(1,1) = \\frac{1}{80}(67 + 6 + 1) = \\frac{74}{80} = \\frac{37}{40}$\n- 在 $(\\xi,\\eta)=(-1,1)$ 处： $J(-1,1) = \\frac{1}{80}(67 - 6 + 1) = \\frac{62}{80} = \\frac{31}{40}$\n\n所有四个值均为正。由于 $J(\\xi,\\eta)$ 是一个线性函数，其在正方形内部的值是角点值的凸组合。因此，$J(\\xi,\\eta)$ 在域 $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$ 内处处为正。单射性条件得到满足。该映射是单射的。\n\n**雅可比行列式的最小值**\n如前所述，线性函数 $J(\\xi,\\eta)$ 在正方形域上的最小值必然出现在其角点之一。通过比较四个角点的值：$\\frac{3}{4}=0.75$，$\\frac{9}{10}=0.9$，$\\frac{37}{40}=0.925$ 和 $\\frac{31}{40}=0.775$。最小值为 $\\frac{3}{4}$。\n或者，要最小化的函数是 $f(\\xi,\\eta) = 67+6\\xi+\\eta$。其梯度为 $\\nabla f = (6,1)$，是一个常数向量。函数 $f$ 在域 $[-1,1]\\times[-1,1]$ 上的最小值将出现在点 $(\\xi,\\eta)=(-1,-1)$ 处，该点在与梯度相反的方向上最远。\n因此，雅可比行列式的最小值为：\n$$J_{min} = J(-1,-1) = \\frac{3}{4}$$", "answer": "$$\\boxed{\\frac{3}{4}}$$"}, {"introduction": "进行坐标变换的最终目的之一，是在物理单元上精确地计算积分，例如单元刚度矩阵。被积函数的复杂性取决于单元的几何形状和形函数，它决定了我们数值积分方案所需的精度。本练习将几何映射的性质与选择合适的高斯求积规则联系起来，以实现精确积分[@problem_id:2585641]。", "id": "2585641", "problem": "考虑有限元法 (FEM) 中的单个等参双线性四边形单元，其自然（参考）坐标为 $(\\xi,\\eta)\\in\\hat{\\Omega}=[-1,1]\\times[-1,1]$。到物理单元的等参映射由下式给出\n$$\n\\mathbf{x}(\\xi,\\eta)=\\sum_{i=1}^{4}\\hat{N}_i(\\xi,\\eta)\\,\\mathbf{x}_i,\n$$\n其中四个形函数是 $\\hat{\\Omega}$ 上的双线性多项式，\n$$\n\\hat{N}_1(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1-\\eta),\\quad\n\\hat{N}_2(\\xi,\\eta)=\\tfrac{1}{4}(1+\\xi)(1-\\eta),\\quad\n\\hat{N}_3(\\xi,\\eta)=\\tfrac{1}{4}(1+\\xi)(1+\\eta),\\quad\n\\hat{N}_4(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1+\\eta).\n$$\n令 $\\hat{\\nabla}$ 表示关于 $(\\xi,\\eta)$ 的梯度，令 $J(\\xi,\\eta)$ 表示映射 $\\mathbf{x}(\\xi,\\eta)$ 的雅可比矩阵，其元素为 $J_{ij}=\\partial x_i/\\partial \\xi_j$。考虑被积函数\n$$\nI(\\xi,\\eta) \\;=\\; \\big(J(\\xi,\\eta)^{-T}\\,\\hat{\\nabla}\\hat{N}_a(\\xi,\\eta)\\big)\\cdot\\big(J(\\xi,\\eta)^{-T}\\,\\hat{\\nabla}\\hat{N}_b(\\xi,\\eta)\\big)\\,\\det J(\\xi,\\eta),\n$$\n该函数出现在节点 $a$ 和 $b$ 的单元刚度矩阵项中。\n\n假设四个物理节点 $\\{\\mathbf{x}_i\\}_{i=1}^{4}$ 在平面上构成一个平行四边形，从而使得等参映射是仿射的。在此假设下：\n\n1. 确定 $I(\\xi,\\eta)$ 作为 $(\\xi,\\eta)$ 的二元多项式的总多项式次数。\n\n2. 利用张量积高斯-勒让德求积在每个坐标方向上的精确性，确定能够将 $I(\\xi,\\eta)$ 在 $\\hat{\\Omega}$ 上精确积分的最小整数 $n$（每个方向上的高斯-勒让德点数）。\n\n在最终答案中仅以单个整数形式给出 $n$ 的值。无需四舍五入。", "solution": "首先对问题进行验证。\n\n步骤1：提取已知条件\n-   计算域是自然（参考）单元，一个由 $(\\xi, \\eta) \\in \\hat{\\Omega} = [-1, 1] \\times [-1, 1]$ 定义的正方形。\n-   该单元是等参双线性四边形。\n-   从自然坐标到物理坐标的等参映射由 $\\mathbf{x}(\\xi, \\eta) = \\sum_{i=1}^{4} \\hat{N}_i(\\xi, \\eta) \\mathbf{x}_i$ 给出。\n-   双线性形函数为：\n    $\\hat{N}_1(\\xi, \\eta) = \\frac{1}{4}(1 - \\xi)(1 - \\eta)$\n    $\\hat{N}_2(\\xi, \\eta) = \\frac{1}{4}(1 + \\xi)(1 - \\eta)$\n    $\\hat{N}_3(\\xi, \\eta) = \\frac{1}{4}(1 + \\xi)(1 + \\eta)$\n    $\\hat{N}_4(\\xi, \\eta) = \\frac{1}{4}(1 - \\xi)(1 + \\eta)$\n-   $\\hat{\\nabla}$ 是关于自然坐标 $(\\xi, \\eta)$ 的梯度算子。\n-   $J(\\xi, \\eta)$ 是映射 $\\mathbf{x}(\\xi, \\eta)$ 的雅可比矩阵。\n-   所考虑的被积函数为 $I(\\xi, \\eta) = \\left(J(\\xi, \\eta)^{-T} \\hat{\\nabla} \\hat{N}_a(\\xi, \\eta)\\right) \\cdot \\left(J(\\xi, \\eta)^{-T} \\hat{\\nabla} \\hat{N}_b(\\xi, \\eta)\\right) \\det J(\\xi, \\eta)$。\n-   提供了一个关键假设：四个物理节点 $\\{\\mathbf{x}_i\\}_{i=1}^{4}$ 构成一个平行四边形，这意味着映射 $\\mathbf{x}(\\xi, \\eta)$ 是仿射的。\n-   任务是：(1) 确定 $I(\\xi, \\eta)$ 的总多项式次数，以及 (2) 找到在 $\\hat{\\Omega}$ 上精确积分 $I(\\xi, \\eta)$ 所需的最小整数 $n$（每个方向上的高斯-勒让德点数）。\n\n步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，是适定且客观的。它展示了有限元法中的一个标准场景。等参映射、雅可比矩阵和数值求积等核心概念是该领域的基础。单元是平行四边形的假设是一个具体的、明确定义的条件，它简化了一般情况并导向一个确定的解。该问题是自洽的，提供了所有必要的定义和条件。它没有违反任何科学原理，也不包含任何歧义。\n\n步骤3：结论与行动\n问题被认为是有效的。将构建解答。\n\n从参考单元到物理单元的坐标变换由下式给出\n$$\n\\mathbf{x}(\\xi, \\eta) = \\sum_{i=1}^{4} \\hat{N}_i(\\xi, \\eta) \\mathbf{x}_i\n$$\n其中 $\\mathbf{x}_i$ 是物理节点的坐标。我们可以通过代入形函数来展开此表达式：\n$$\n\\mathbf{x}(\\xi,\\eta) = \\frac{1}{4}\\left[ (1-\\xi)(1-\\eta)\\mathbf{x}_1 + (1+\\xi)(1-\\eta)\\mathbf{x}_2 + (1+\\xi)(1+\\eta)\\mathbf{x}_3 + (1-\\xi)(1+\\eta)\\mathbf{x}_4 \\right]\n$$\n根据 $\\xi$、$\\eta$ 和 $\\xi\\eta$ 的幂次重新整理各项：\n$$\n\\mathbf{x}(\\xi,\\eta) = \\frac{1}{4}(\\mathbf{x}_1+\\mathbf{x}_2+\\mathbf{x}_3+\\mathbf{x}_4) + \\frac{1}{4}(-\\mathbf{x}_1+\\mathbf{x}_2+\\mathbf{x}_3-\\mathbf{x}_4)\\xi + \\frac{1}{4}(-\\mathbf{x}_1-\\mathbf{x}_2+\\mathbf{x}_3+\\mathbf{x}_4)\\eta + \\frac{1}{4}(\\mathbf{x}_1-\\mathbf{x}_2+\\mathbf{x}_3-\\mathbf{x}_4)\\xi\\eta\n$$\n映射 $\\mathbf{x}(\\xi, \\eta)$ 是仿射的，当且仅当非线性项 $\\xi\\eta$ 的系数为零。这要求：\n$$\n\\mathbf{x}_1 - \\mathbf{x}_2 + \\mathbf{x}_3 - \\mathbf{x}_4 = \\mathbf{0}\n$$\n这恰好是四个节点构成平行四边形的几何条件，即 $\\mathbf{x}_2 - \\mathbf{x}_1 = \\mathbf{x}_3 - \\mathbf{x}_4$。在此假设下，映射简化为仿射变换：\n$$\n\\mathbf{x}(\\xi, \\eta) = \\mathbf{c} + \\mathbf{A}\\xi + \\mathbf{B}\\eta\n$$\n其中 $\\mathbf{c}$、$\\mathbf{A}$ 和 $\\mathbf{B}$ 是由节点坐标确定的常数向量。\n\n该变换的雅可比矩阵由下式给出：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} A_x & B_x \\\\ A_y & B_y \\end{pmatrix} = \\left[ \\mathbf{A} \\mid \\mathbf{B} \\right]\n$$\n由于 $\\mathbf{A}$ 和 $\\mathbf{B}$ 是常数向量，雅可比矩阵 $J$ 是一个常数矩阵；它不依赖于自然坐标 $(\\xi, \\eta)$。因此，它的逆 $J^{-1}$、逆转置 $J^{-T}$ 以及行列式 $\\det J$ 也都是常数。\n\n现在，我们分析被积函数：\n$$\nI(\\xi, \\eta) = \\left( J^{-T} \\hat{\\nabla} \\hat{N}_a \\right) \\cdot \\left( J^{-T} \\hat{\\nabla} \\hat{N}_b \\right) \\det J\n$$\n设常数矩阵 $J^{-T}$ 用 $C$ 表示。被积函数变为：\n$$\nI(\\xi, \\eta) = \\left( C \\hat{\\nabla} \\hat{N}_a \\right) \\cdot \\left( C \\hat{\\nabla} \\hat{N}_b \\right) \\det J\n$$\n由于 $C$ 和 $\\det J$ 是常数， $I(\\xi, \\eta)$ 的多项式性质完全由 $(\\hat{\\nabla} \\hat{N}_a) \\cdot (\\hat{\\nabla} \\hat{N}_b)$ 项决定，其中涉及一些常数缩放因子。我们来分析形函数的梯度。对于任何形函数 $\\hat{N}_i$，其梯度为 $\\hat{\\nabla} \\hat{N}_i = \\left( \\frac{\\partial \\hat{N}_i}{\\partial \\xi}, \\frac{\\partial \\hat{N}_i}{\\partial \\eta} \\right)^T$。\n例如，对于 $\\hat{N}_1(\\xi, \\eta) = \\frac{1}{4}(1 - \\xi - \\eta + \\xi\\eta)$：\n$$\n\\frac{\\partial \\hat{N}_1}{\\partial \\xi} = \\frac{1}{4}(-1+\\eta) \\quad \\text{和} \\quad \\frac{\\partial \\hat{N}_1}{\\partial \\eta} = \\frac{1}{4}(-1+\\xi)\n$$\n一般来说，对于四个形函数中的任意一个，$\\frac{\\partial \\hat{N}_i}{\\partial \\xi}$ 是一个关于 $\\eta$ 的 1 次多项式，关于 $\\xi$ 的 0 次多项式。类似地，$\\frac{\\partial \\hat{N}_i}{\\partial \\eta}$ 是一个关于 $\\xi$ 的 1 次多项式，关于 $\\eta$ 的 0 次多项式。\n\n暂不考虑常数矩阵乘法，被积函数中的点积项为：\n$$\n(\\hat{\\nabla} \\hat{N}_a) \\cdot (\\hat{\\nabla} \\hat{N}_b) = \\frac{\\partial \\hat{N}_a}{\\partial \\xi} \\frac{\\partial \\hat{N}_b}{\\partial \\xi} + \\frac{\\partial \\hat{N}_a}{\\partial \\eta} \\frac{\\partial \\hat{N}_b}{\\partial \\eta}\n$$\n第一项 $\\frac{\\partial \\hat{N}_a}{\\partial \\xi} \\frac{\\partial \\hat{N}_b}{\\partial \\xi}$ 是两个至多关于 $\\eta$ 是一次的多项式的乘积。结果是一个关于 $\\eta$ 至多 2 次、关于 $\\xi$ 0 次的多项式。\n第二项 $\\frac{\\partial \\hat{N}_a}{\\partial \\eta} \\frac{\\partial \\hat{N}_b}{\\partial \\eta}$ 是两个至多关于 $\\xi$ 是一次的多项式的乘积。结果是一个关于 $\\xi$ 至多 2 次、关于 $\\eta$ 0 次的多项式。\n这两项之和是一个形式为 $P(\\xi, \\eta) = P_{\\xi}(\\xi) + P_{\\eta}(\\eta)$ 的多项式，其中 $P_{\\xi}$ 是一个关于 $\\xi$ 至多 2 次的多项式，$P_{\\eta}$ 是一个关于 $\\eta$ 至多 2 次的多项式。\n例如，当 $a=b=1$ 时：\n$$\n(\\hat{\\nabla} \\hat{N}_1) \\cdot (\\hat{\\nabla} \\hat{N}_1) = \\left(\\frac{1}{4}\\right)^2 \\left( (-1+\\eta)^2 + (-1+\\xi)^2 \\right) = \\frac{1}{16} (\\eta^2 - 2\\eta + 1 + \\xi^2 - 2\\xi + 1)\n$$\n这是一个关于 $\\xi$ 的 2 次多项式，也是关于 $\\eta$ 的 2 次多项式。总多项式次数为 2。\n完整的被积函数 $I(\\xi, \\eta)$ 是此类点积的线性组合，并由从 $J$ 和 $\\det J$ 导出的常数进行缩放。因此，$I(\\xi, \\eta)$ 是一个关于 $(\\xi, \\eta)$ 的多项式，其中关于 $\\xi$ 的最高次数是 2，关于 $\\eta$ 的最高次数是 2。\n\n任务是找到在 $\\hat{\\Omega} = [-1, 1] \\times [-1, 1]$ 上精确积分 $I(\\xi, \\eta)$ 所需的每个方向上高斯-勒让德求积点的最小整数 $n$。\n一维 n 点高斯-勒让德求积法则能够精确积分最高 $2n-1$ 次的多项式。\n为了使二维张量积法则精确，一维法则必须对每个变量中出现的最高多项式次数是精确的。\n$I(\\xi, \\eta)$ 关于 $\\xi$ 的最高多项式次数为 $p_\\xi = 2$。\n$I(\\xi, \\eta)$ 关于 $\\eta$ 的最高多项式次数为 $p_\\eta = 2$。\n\n为了在 $\\xi$ 方向上精确积分，我们需要：\n$$\n2n - 1 \\geq p_\\xi \\implies 2n - 1 \\geq 2\n$$\n为了在 $\\eta$ 方向上精确积分，我们需要：\n$$\n2n - 1 \\geq p_\\eta \\implies 2n - 1 \\geq 2\n$$\n两个条件都给出了相同的不等式：\n$$\n2n \\geq 3 \\implies n \\geq 1.5\n$$\n由于求积点数 $n$ 必须是整数，满足此条件的最小整数值为 $n=2$。因此，需要一个 $2 \\times 2$ 的张量积高斯-勒让德求积方案才能实现精确积分。每个方向上的点数为 2。", "answer": "$$\\boxed{2}$$"}]}