{"hands_on_practices": [{"introduction": "在将有限元法应用于实际工程问题时，一个基本且常见的挑战是如何处理非齐次狄利克雷（Dirichlet）边界条件。本练习将引导你完成一个关键的标准流程：使用“提升函数”将问题转化为具有齐次边界条件的等价形式。通过这个具体的计算，你将掌握将复杂边界约束优雅地纳入加权余量法框架的核心技能。[@problem_id:2612124]", "problem": "考虑一个定义在开区间 $\\Omega=(0,1)$ 上的二阶线性标量边值问题，这是一个扩散-反应模型：\n$$\n-\\frac{d}{dx}\\Big(p(x)\\,\\frac{du}{dx}\\Big)+q(x)\\,u(x)=f(x)\\quad\\text{在 }\\Omega\\text{ 内},\\qquad u(0)=g_0,\\quad u(1)=g_1,\n$$\n其系数为 $p(x)=1$, $q(x)=2$，源项为 $f(x)=2$，非齐次狄利克雷边界数据为 $g_0=1$, $g_1=2$。令 $H^1(\\Omega)$ 表示一阶索博列夫空间，$H^1_0(\\Omega)$ 表示其在 $\\partial\\Omega$ 上具有齐次迹的子空间。\n\n您的任务是：\n1) 构造一个提升函数 $u_g\\in H^1(\\Omega)$，使得 $u_g$ 在 $\\partial\\Omega$ 上的迹等于给定的边界数据，并为扰动量 $\\tilde u=u-u_g\\in H^1_0(\\Omega)$ 在齐次空间上重新表述伽辽金加权余量问题。仅使用加权余量法和分部积分的基本原理，不使用任何现成公式。\n\n2) 具体到一维有限元法(FEM)近似，使用一维试探-检验空间 $W:=\\operatorname{span}\\{\\varphi\\}$，其中 $\\varphi(x)=x(1-x)$，并采用仿射提升函数 $u_g(x)=g_0(1-x)+g_1 x$。在权函数取自同一空间的情况下，求伽辽金近似解 $\\tilde u_h(x)=\\alpha\\,\\varphi(x)$。通过精确计算所有积分，确定唯一的标量伽辽金系数 $\\alpha$。\n\n报告 $\\alpha$ 的精确值作为最终答案（不要四舍五入）。无需单位。", "solution": "对提出的问题进行验证。\n\n**步骤 1：提取已知条件**\n- 微分方程：$-\\frac{d}{dx}\\Big(p(x)\\,\\frac{du}{dx}\\Big)+q(x)\\,u(x)=f(x)$，定义在区域 $\\Omega=(0,1)$ 上。\n- 边界条件：$u(0)=g_0$, $u(1)=g_1$。\n- 系数和源项：$p(x)=1$, $q(x)=2$, $f(x)=2$。\n- 边界数据：$g_0=1$, $g_1=2$。\n- 函数空间：$H^1(\\Omega)$ 和 $H^1_0(\\Omega)$。\n- 任务 1：为边界数据构造一个提升函数 $u_g\\in H^1(\\Omega)$，并为扰动量 $\\tilde u=u-u_g\\in H^1_0(\\Omega)$ 重新表述伽辽金问题。\n- 任务 2：使用有限元空间 $W=\\operatorname{span}\\{\\varphi\\}$（其中 $\\varphi(x)=x(1-x)$）和特定的提升函数 $u_g(x)=g_0(1-x)+g_1 x$，求近似解 $\\tilde u_h(x)=\\alpha\\,\\varphi(x)$ 中的伽辽金系数 $\\alpha$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题是一个标准的、适定的二阶线性边值问题。其科学基础是微分方程理论及其通过有限元法的数值求解。所有数据和函数形式均已提供，构成一个自洽且一致的数学练习。系数 $p(x)=1>0$ 和 $q(x)=2 \\ge 0$ 通过 Lax-Milgram 定理保证了解的存在性和唯一性。该问题是客观、明确且可解的。\n\n**步骤 3：结论与行动**\n该问题被判定为 **有效**。将提供解答。\n\n按要求，解答分为两部分。\n\n**第一部分：伽辽金问题的重新表述**\n\n控制方程是一个带有非齐次狄利克雷边界条件的二阶线性常微分方程：\n$$\n-\\frac{d}{dx}\\Big(p(x)\\,\\frac{du}{dx}\\Big)+q(x)\\,u(x)=f(x), \\quad x \\in \\Omega = (0,1)\n$$\n$$\nu(0)=g_0, \\quad u(1)=g_1\n$$\n标准的加权余量法从建立弱形式开始。我们将微分方程乘以一个足够光滑的检验函数 $v(x)$，该函数在指定狄利克雷条件的边界上为零。在这里，这个检验函数空间是 $H^1_0(\\Omega) = \\{v \\in H^1(\\Omega) \\,|\\, v(0)=v(1)=0\\}$。在区域 $\\Omega$ 上积分：\n$$\n\\int_{0}^{1} \\left( -\\frac{d}{dx}\\Big(p(x)\\,\\frac{du}{dx}\\Big)+q(x)\\,u(x) \\right) v(x) \\,dx = \\int_{0}^{1} f(x) v(x) \\,dx\n$$\n对二阶项应用分部积分：\n$$\n\\int_{0}^{1} -\\frac{d}{dx}\\Big(p(x)\\,\\frac{du}{dx}\\Big) v(x) \\,dx = - \\left[ p(x)\\frac{du}{dx}v(x) \\right]_{0}^{1} + \\int_{0}^{1} p(x)\\frac{du}{dx}\\frac{dv}{dx}\\,dx\n$$\n由于检验函数 $v(x)$ 在 $x=0$ 和 $x=1$ 处为零，边界项 $-[p(x)\\frac{du}{dx}v(x)]_0^1$ 消失。于是，弱形式为：求 $u \\in H^1(\\Omega)$，使得 $u(0)=g_0$, $u(1)=g_1$，并且对于所有 $v \\in H^1_0(\\Omega)$：\n$$\n\\int_{0}^{1} \\left( p(x)\\frac{du}{dx}\\frac{dv}{dx} + q(x)u(x)v(x) \\right) \\,dx = \\int_{0}^{1} f(x)v(x) \\,dx\n$$\n试探函数 $u$ 必须满足非齐次边界条件，这对于构造有限维试探空间来说很不方便。为解决此问题，我们将解 $u$ 分解为一个预设的“提升”函数 $u_g \\in H^1(\\Omega)$ 和一个“扰动量” $\\tilde{u} \\in H^1_0(\\Omega)$ 的和。提升函数 $u_g$ 的构造使其满足非齐次边界条件，即 $u_g(0)=g_0$ 和 $u_g(1)=g_1$。扰动量 $\\tilde{u} = u - u_g$ 则满足齐次边界条件：$\\tilde{u}(0) = u(0) - u_g(0) = g_0 - g_0 = 0$ 且 $\\tilde{u}(1) = u(1) - u_g(1) = g_1 - g_1 = 0$。因此，$\\tilde{u}$ 与检验函数位于同一空间 $H^1_0(\\Omega)$ 中。\n\n将 $u = \\tilde{u} + u_g$ 代入弱形式：\n$$\n\\int_{0}^{1} \\left( p(x)\\frac{d}{dx}(\\tilde{u} + u_g)\\frac{dv}{dx} + q(x)(\\tilde{u} + u_g)v \\right) \\,dx = \\int_{0}^{1} f(x)v \\,dx\n$$\n利用积分和导数的线性性质，我们将包含未知量 $\\tilde{u}$ 的项与包含已知量 $u_g$ 的项分开：\n$$\n\\int_{0}^{1} \\left( p(x)\\frac{d\\tilde{u}}{dx}\\frac{dv}{dx} + q(x)\\tilde{u}v \\right) \\,dx + \\int_{0}^{1} \\left( p(x)\\frac{du_g}{dx}\\frac{dv}{dx} + q(x)u_g v \\right) \\,dx = \\int_{0}^{1} f(x)v \\,dx\n$$\n重新整理，将所有已知量置于右侧，得到关于扰动量 $\\tilde{u}$ 的弱问题：求 $\\tilde{u} \\in H^1_0(\\Omega)$，使得对于所有 $v \\in H^1_0(\\Omega)$：\n$$\n\\int_{0}^{1} \\left( p(x)\\frac{d\\tilde{u}}{dx}\\frac{dv}{dx} + q(x)\\tilde{u}v \\right) \\,dx = \\int_{0}^{1} \\left( f(x)v - p(x)\\frac{du_g}{dx}\\frac{dv}{dx} - q(x)u_g v \\right) \\,dx\n$$\n这就是所要求的重新表述的伽辽金加权余量问题。它可以抽象地写为：求 $\\tilde{u} \\in H^1_0(\\Omega)$，使得对所有 $v \\in H^1_0(\\Omega)$ 都有 $a(\\tilde{u}, v) = L(v)$，其中双线性形式 $a(\\cdot, \\cdot)$ 和线性泛函 $L(\\cdot)$ 定义如下：\n$$\na(w, v) = \\int_{0}^{1} \\left( p(x)\\frac{dw}{dx}\\frac{dv}{dx} + q(x)wv \\right) \\,dx\n$$\n$$\nL(v) = \\int_{0}^{1} f(x)v \\,dx - a(u_g, v) = \\int_{0}^{1} \\left( f(x)v - p(x)\\frac{du_g}{dx}\\frac{dv}{dx} - q(x)u_g v \\right) \\,dx\n$$\n\n**第二部分：伽辽金系数的确定**\n\n现在我们具体到给定的数据和有限维近似。\n系数为 $p(x)=1$，$q(x)=2$，$f(x)=2$。边界数据为 $g_0=1$，$g_1=2$。\n指定的提升函数为 $u_g(x) = g_0(1-x)+g_1 x = 1(1-x)+2x = 1+x$。其导数为 $\\frac{du_g}{dx} = 1$。\n试探函数和检验函数均取自空间 $W=\\operatorname{span}\\{\\varphi\\}$，其中 $\\varphi(x)=x(1-x) = x-x^2$。其导数为 $\\frac{d\\varphi}{dx} = 1-2x$。\n扰动量的伽辽金近似解为 $\\tilde{u}_h(x) = \\alpha \\varphi(x)$，其中 $\\alpha$ 是未知的标量系数。检验函数为 $v(x) = \\varphi(x)$。\n将 $\\tilde{u}_h$ 代替 $\\tilde{u}$、将 $\\varphi$ 代替 $v$ 代入弱形式 $a(\\tilde{u}, v) = L(v)$：\n$$\na(\\alpha\\varphi, \\varphi) = L(\\varphi)\n$$\n根据双线性性质，上式变为 $\\alpha \\, a(\\varphi, \\varphi) = L(\\varphi)$，可得 $\\alpha = \\frac{L(\\varphi)}{a(\\varphi, \\varphi)}$。\n\n我们计算分母 $a(\\varphi, \\varphi)$：\n$$\na(\\varphi, \\varphi) = \\int_{0}^{1} \\left( p(x)\\left(\\frac{d\\varphi}{dx}\\right)^2 + q(x)\\varphi(x)^2 \\right) \\,dx\n$$\n$$\na(\\varphi, \\varphi) = \\int_{0}^{1} \\left( 1 \\cdot (1-2x)^2 + 2 \\cdot (x-x^2)^2 \\right) \\,dx\n$$\n$$\na(\\varphi, \\varphi) = \\int_{0}^{1} \\left( (1-4x+4x^2) + 2(x^2-2x^3+x^4) \\right) \\,dx\n$$\n$$\na(\\varphi, \\varphi) = \\int_{0}^{1} (1-4x+6x^2-4x^3+2x^4) \\,dx\n$$\n$$\na(\\varphi, \\varphi) = \\left[ x - \\frac{4x^2}{2} + \\frac{6x^3}{3} - \\frac{4x^4}{4} + \\frac{2x^5}{5} \\right]_{0}^{1} = \\left[ x - 2x^2 + 2x^3 - x^4 + \\frac{2}{5}x^5 \\right]_{0}^{1}\n$$\n$$\na(\\varphi, \\varphi) = \\left( 1 - 2 + 2 - 1 + \\frac{2}{5} \\right) - 0 = \\frac{2}{5}\n$$\n接下来，我们计算分子 $L(\\varphi)$：\n$$\nL(\\varphi) = \\int_{0}^{1} \\left( f(x)\\varphi(x) - p(x)\\frac{du_g}{dx}\\frac{d\\varphi}{dx} - q(x)u_g(x)\\varphi(x) \\right) \\,dx\n$$\n$$\nL(\\varphi) = \\int_{0}^{1} \\left( 2(x-x^2) - 1 \\cdot 1 \\cdot (1-2x) - 2(1+x)(x-x^2) \\right) \\,dx\n$$\n$$\nL(\\varphi) = \\int_{0}^{1} \\left( (2x-2x^2) - (1-2x) - 2(x-x^3) \\right) \\,dx\n$$\n$$\nL(\\varphi) = \\int_{0}^{1} (2x-2x^2-1+2x - 2x+2x^3) \\,dx\n$$\n$$\nL(\\varphi) = \\int_{0}^{1} (2x^3-2x^2+2x-1) \\,dx\n$$\n$$\nL(\\varphi) = \\left[ \\frac{2x^4}{4} - \\frac{2x^3}{3} + \\frac{2x^2}{2} - x \\right]_{0}^{1} = \\left[ \\frac{1}{2}x^4 - \\frac{2}{3}x^3 + x^2 - x \\right]_{0}^{1}\n$$\n$$\nL(\\varphi) = \\left( \\frac{1}{2} - \\frac{2}{3} + 1 - 1 \\right) - 0 = \\frac{3}{6} - \\frac{4}{6} = -\\frac{1}{6}\n$$\n最后，我们计算系数 $\\alpha$：\n$$\n\\alpha = \\frac{L(\\varphi)}{a(\\varphi, \\varphi)} = \\frac{-1/6}{2/5} = -\\frac{1}{6} \\cdot \\frac{5}{2} = -\\frac{5}{12}\n$$", "answer": "$$\\boxed{-\\frac{5}{12}}$$", "id": "2612124"}, {"introduction": "标准的伽辽金法虽然强大，但在处理特定类型的问题（如对流占优问题）时，可能会产生非物理的振荡解。本练习将深入探讨这一数值不稳定性的根源，通过分析离散矩阵的性质，揭示标准方法失效的原因。更重要的是，它将促使你思考和评估多种先进的“稳定化”技术，这些技术是确保在挑战性物理场景下获得有意义解的关键。[@problem_id:2612128]", "problem": "考虑区间 $[0,1]$ 上的具有常系数的稳态一维对流扩散边值问题\n$$\n- \\varepsilon \\, u''(x) + \\beta \\, u'(x) = 0 \\quad \\text{for } x \\in (0,1),\n$$\n其狄利克雷边界条件为 $u(0)=u_L$ 和 $u(1)=u_R$，其中 $\\varepsilon>0$ 和 $\\beta>0$ 是常数。设 $\\mathcal{T}_h$ 是 $[0,1]$ 的一个均匀剖分，将其分为 $N$ 个长度为 $h=1/N$ 的子区间，并设 $V_h$是相对于 $\\mathcal{T}_h$ 的满足本质边界条件的连续分片线性函数空间。使用标准 Galerkin 加权余量法，即从同一空间 $V_h$ 中选择权函数。\n\n从弱形式出发（将微分方程乘以一个检验函数并在 $[0,1]$ 上积分，对扩散项进行一次分部积分，并利用本质边界条件消除边界积分），导出关于内部节点未知数的组装线性系统 $\\mathbf{A}\\mathbf{u}=\\mathbf{b}$。具体来说：\n\n- 用 $\\varepsilon$、$\\beta$ 和 $h$ 表示内部节点 $x_i$ 处全局三对角系数矩阵 $\\mathbf{A}$ 的非零元素，除了均匀性和线性形函数外，不作任何特殊结构假设。\n\n- 定义单元 Péclet 数 $P_e:=\\dfrac{\\beta h}{2\\varepsilon}$，并确定对于哪些 $P_e$ 值，$\\mathbf{A}$ 的非对角线元素会改变符号。利用具有非正非对角线元素和适当对角占优性的三对角系统的单调矩阵（M-矩阵）的特征，解释为什么当对流占优时，标准 Galerkin 方法可能无法满足离散极值原理（DMP）。\n\n根据您的推导和分析，选择下面所有正确描述了在给定网格上，针对对流占优情况，可以恢复离散单调性（无虚假新极值）的修正方法的陈述：\n\nA. 用流线迎风 Petrov–Galerkin (SUPG) 检验空间替换标准检验空间，该检验空间增加了与流线方向一致的扩散，并对其进行调整，以使有效单元 Péclet 数不超过 1。\n\nB. 各向同性地添加人工扩散 $\\delta \\ge 0$，使得有效扩散系数 $\\varepsilon_{\\text{eff}}=\\varepsilon+\\delta$ 满足 $\\varepsilon_{\\text{eff}} \\ge \\dfrac{\\beta h}{2}$，从而在一维中恢复所需的非对角线符号模式。\n\nC. 切换到具有相同试探空间的节点配置法（强制残差在节点处为零）；这对任何 $P_e$ 都能产生单调格式。\n\nD. 添加非线性的、依赖于解的激波捕捉粘性或通量限制器，其设计目的是仅在需要时强制实施局部 M-矩阵结构，从而恢复单调性。\n\nE. 使用分片常数权重（在每个单元上等于 $1$）的子域加权法和中心数值通量；这等效于一个迎风格式，并且对于任何 $P_e$ 都是单调的。\n\nF. 均匀加密网格，直到处处满足 $\\dfrac{\\beta h}{2\\varepsilon} \\le 1$；在此类网格上，一维的标准 Galerkin 矩阵满足 DMP 所需的符号条件。\n\n选择所有适用的选项。", "solution": "问题陈述具有科学依据，是适定的，并包含进行严格分析所需的所有信息。它描述了一维稳态对流扩散方程的标准边值问题，并要求分析标准 Galerkin 有限元方法以及为确保离散极值原理而可能进行的修正。该问题是有效的。我们进行推导和分析。\n\n控制微分方程为：\n$$ - \\varepsilon \\, u''(x) + \\beta \\, u'(x) = 0 \\quad \\text{for } x \\in (0,1) $$\n其狄利克雷边界条件为 $u(0)=u_L$ 和 $u(1)=u_R$，其中 $\\varepsilon > 0$ 且 $\\beta > 0$。\n\n为推导弱形式，我们将方程乘以一个来自合适空间（这里是具有齐次边界条件 $v(0)=v(1)=0$ 的检验函数空间）的检验函数 $v(x)$，并在定义域 $[0,1]$ 上积分：\n$$ \\int_0^1 \\left( - \\varepsilon u''(x) + \\beta u'(x) \\right) v(x) \\, dx = 0 $$\n对扩散项进行分部积分，我们得到：\n$$ \\int_0^1 - \\varepsilon u'' v \\, dx = - \\left[ \\varepsilon u' v \\right]_0^1 + \\int_0^1 \\varepsilon u' v' \\, dx $$\n边界项 $- \\left[ \\varepsilon u' v \\right]_0^1$ 为零，因为检验函数 $v(x)$ 在 $x=0$ 和 $x=1$ 处为零。于是弱形式为：求 $u \\in H^1(0,1)$，使得 $u(0)=u_L$，$u(1)=u_R$，且对于所有检验函数 $v \\in H_0^1(0,1)$，\n$$ \\int_0^1 \\left( \\varepsilon u'(x)v'(x) + \\beta u'(x)v(x) \\right) \\, dx = 0 $$\n\n对于有限元离散化，我们使用均匀网格，节点为 $x_i = ih$，其中 $i=0, \\dots, N$，$h=1/N$。空间 $V_h$ 由连续分片线性函数构成。近似解为 $u_h(x) = \\sum_{j=0}^{N} u_j \\phi_j(x)$，其中 $\\phi_j(x)$ 是标准的线性“帽”状基函数，$u_j$ 是节点值。对于 Galerkin 方法，检验函数选自同一空间，即对于内部节点 $i=1, \\dots, N-1$，$v_h(x) = \\phi_i(x)$。\n\n得到的关于内部节点未知数 $u_1, \\dots, u_{N-1}$ 的线性系统由下式给出：\n$$ \\sum_{j=0}^{N} u_j \\left( \\int_0^1 \\left( \\varepsilon \\phi_j' \\phi_i' + \\beta \\phi_j' \\phi_i \\right) \\, dx \\right) = 0, \\quad \\text{for } i=1, \\dots, N-1 $$\n线性系统 $\\mathbf{A}\\mathbf{u}=\\mathbf{b}$ 的矩阵元素为 $A_{ij} = \\int_0^1 (\\varepsilon \\phi_j' \\phi_i' + \\beta \\phi_j' \\phi_i) \\, dx$。由于基函数的局部支集特性，对于内部行 $i$，只有元素 $A_{i,i-1}$、$A_{i,i}$ 和 $A_{i,i+1}$ 是非零的。\n\n我们来计算这些元素。在单元 $[x_{k-1}, x_k]$ 上，基函数的导数为 $\\phi_{k-1}' = -1/h$ 和 $\\phi_k' = 1/h$。\n对角线元素是：\n$$ A_{i,i} = \\int_{x_{i-1}}^{x_{i+1}} (\\varepsilon (\\phi_i')^2 + \\beta \\phi_i' \\phi_i) \\, dx = \\int_{x_{i-1}}^{x_i} \\varepsilon (\\frac{1}{h})^2 dx + \\int_{x_i}^{x_{i+1}} \\varepsilon (-\\frac{1}{h})^2 dx + \\int_{x_{i-1}}^{x_i} \\beta (\\frac{1}{h})\\phi_i dx + \\int_{x_i}^{x_{i+1}} \\beta (-\\frac{1}{h})\\phi_i dx $$\n$$ A_{i,i} = \\frac{\\varepsilon}{h} + \\frac{\\varepsilon}{h} + \\frac{\\beta}{2} - \\frac{\\beta}{2} = \\frac{2\\varepsilon}{h} $$\n次对角线元素是：\n$$ A_{i,i-1} = \\int_{x_{i-1}}^{x_i} (\\varepsilon \\phi_{i-1}' \\phi_i' + \\beta \\phi_{i-1}' \\phi_i) \\, dx = \\int_{x_{i-1}}^{x_i} \\varepsilon (-\\frac{1}{h})(\\frac{1}{h}) dx + \\int_{x_{i-1}}^{x_i} \\beta (-\\frac{1}{h})\\phi_i dx $$\n$$ A_{i,i-1} = -\\frac{\\varepsilon}{h} - \\frac{\\beta}{2} $$\n超对角线元素是：\n$$ A_{i,i+1} = \\int_{x_i}^{x_{i+1}} (\\varepsilon \\phi_{i+1}' \\phi_i' + \\beta \\phi_{i+1}' \\phi_i) \\, dx = \\int_{x_i}^{x_{i+1}} \\varepsilon (\\frac{1}{h})(-\\frac{1}{h}) dx + \\int_{x_i}^{x_{i+1}} \\beta (\\frac{1}{h})\\phi_i dx $$\n$$ A_{i,i+1} = -\\frac{\\varepsilon}{h} + \\frac{\\beta}{2} $$\n因此，内部节点 $x_i$ 的方程为：\n$$ \\left(-\\frac{\\varepsilon}{h} - \\frac{\\beta}{2}\\right) u_{i-1} + \\left(\\frac{2\\varepsilon}{h}\\right) u_i + \\left(-\\frac{\\varepsilon}{h} + \\frac{\\beta}{2}\\right) u_{i+1} = 0 $$\n使用单元 Péclet 数 $P_e = \\frac{\\beta h}{2\\varepsilon}$，我们可以将这些系数写成：\n$$ A_{i,i-1} = -\\frac{\\varepsilon}{h}(1+P_e) \\quad\\quad A_{i,i} = \\frac{2\\varepsilon}{h} \\quad\\quad A_{i,i+1} = -\\frac{\\varepsilon}{h}(1-P_e) $$\n如果系数矩阵 $\\mathbf{A}$ 是一个 M-矩阵，则离散极值原理（DMP）得到保证。对于三对角矩阵，这要求对角线元素为正（$A_{i,i} > 0$）、非对角线元素为非正（$A_{i,j} \\le 0$ for $i \\ne j$），以及对角占优。\n我们的矩阵有 $A_{i,i} = \\frac{2\\varepsilon}{h} > 0$。次对角线元素 $A_{i,i-1} = -\\frac{\\varepsilon}{h}(1+P_e)$ 总是负的，因为 $P_e > 0$。然而，超对角线元素 $A_{i,i+1} = -\\frac{\\varepsilon}{h}(1-P_e)$ 的符号会改变。它仅在 $1-P_e \\ge 0$ 时为非正，这意味着 $P_e \\le 1$。\n当对流占优时，$\\beta \\gg \\varepsilon$，这导致 $P_e > 1$。在这种情况下，$A_{i,i+1}$ 变为正值，矩阵不再是 M-矩阵，DMP 也不满足。这会导致数值解中出现非物理的振荡。\n\n我们现在来评估所提出的修正方法。\n\nA. **用流线迎风 Petrov–Galerkin (SUPG) 检验空间替换标准检验空间，该检验空间增加了与流线方向一致的扩散，并对其进行调整，以使有效单元 Péclet 数不超过 1。**\nSUPG 方法将检验函数修正为 $v_h + \\tau \\beta v_h'$，添加了一个与残差成正比的人工扩散类项。在一维情况下，这等同于在流线（流动）方向上添加扩散。该项可以通过参数 $\\tau$ 进行调整。正确选择 $\\tau$ 可以添加足够的人工扩散，以确保最终的系统矩阵满足 M-矩阵条件。该陈述描述的正是这样一个过程：调整方法以使有效 Péclet 数 $P_{e, \\text{eff}} \\le 1$。这恢复了单调性。因此，该陈述是**正确的**。\n\nB. **各向同性地添加人工扩散 $\\delta \\ge 0$，使得有效扩散系数 $\\varepsilon_{\\text{eff}}=\\varepsilon+\\delta$ 满足 $\\varepsilon_{\\text{eff}} \\ge \\dfrac{\\beta h}{2}$，从而在一维中恢复所需的非对角线符号模式。**\n这是一种强制实现单调性的直接方法。通过将 $\\varepsilon$ 替换为 $\\varepsilon_{\\text{eff}} = \\varepsilon+\\delta$，超对角线元素变为 $A'_{i,i+1} = -\\frac{\\varepsilon_{\\text{eff}}}{h} + \\frac{\\beta}{2}$。条件 $A'_{i,i+1} \\le 0$ 要求 $\\varepsilon_{\\text{eff}} \\ge \\frac{\\beta h}{2}$，这正是该陈述所提议的。这对应于强制使有效 Péclet 数 $P_{e, \\text{eff}} = \\frac{\\beta h}{2\\varepsilon_{\\text{eff}}} \\le 1$。该方法有效，尽管代价是增加了数值扩散并降低了精度（除非 $\\delta$ 随 $h$ 趋于 0，否则这是一个不一致的修正）。术语“各向同性地”在多维情况下更具相关性，但在 一维情况下仅意味着添加到二阶导数项。该陈述是**正确的**。\n\nC. **切换到具有相同试探空间的节点配置法（强制残差在节点处为零）；这对任何 $P_e$ 都能产生单调格式。**\n对于分片线性元，节点配置法是病态的，因为二阶导数 $u_h''$ 在节点处不是一个函数。如果我们将此解释为在节点处应用的中心有限差分格式，我们得到 $u_h'(x_i) \\approx \\frac{u_{i+1}-u_{i-1}}{2h}$ 和 $u_h''(x_i) \\approx \\frac{u_{i+1}-2u_i+u_{i-1}}{h^2}$。将这些代入偏微分方程会产生与标准 Galerkin 方法完全相同的代数系统。因此，它也存在相同的缺陷，并在 $P_e > 1$ 时产生振荡。其对于任何 $P_e$ 都是单调的说法是错误的。该陈述是**不正确的**。\n\nD. **添加非线性的、依赖于解的激波捕捉粘性或通量限制器，其设计目的是仅在需要时强制实施局部 M-矩阵结构，从而恢复单调性。**\n这描述了先进的现代技术，如通量修正输运（FCT）或具有总变差递减（TVD）性质的格式。这些方法以非线性和自适应的方式添加人工扩散，仅在可能出现振荡的高梯度区域（潜在的激波或层）应用它。这类限制器的目标正是强制实施局部单调性约束，从而在不处处添加过多扩散的情况下，实现全局性的 DMP。这是一个非常有效的策略。该陈述是**正确的**。\n\nE. **使用分片常数权重（在每个单元上等于 $1$）的子域加权法和中心数值通量；这等效于一个迎风格式，并且对于任何 $P_e$ 都是单调的。**\n在控制体上将残差积分为零的子域加权法是一种有限体积法。如果我们围绕每个节点定义控制体（例如 $[x_i-h/2, x_i+h/2]$），并在控制体边界面上使用中心差分类型的通量近似（基于节点值的线性插值），那么得到的代数系统与标准 Galerkin 方法和中心有限差分方法的代数系统是相同的。因此，该格式在 $P_e > 1$ 时不是单调的。此外，根据定义，中心通量格式不是迎风格式。迎风格式确实对任何 $P_e$ 都是单调的，但所描述的方法并不能产生迎风格式。该陈述包含多个事实错误。该陈述是**不正确的**。\n\nF. **均匀加密网格，直到处处满足 $\\dfrac{\\beta h}{2\\varepsilon} \\le 1$；在此类网格上，一维的标准 Galerkin 矩阵满足 DMP 所需的符号条件。**\n正如我们最初分析所确立的，如果条件 $P_e = \\frac{\\beta h}{2\\varepsilon} \\le 1$ 成立，标准 Galerkin 矩阵就成为一个 M-矩阵并满足 DMP。对于任何固定的问题参数 $\\beta$ 和 $\\varepsilon$，总可以通过充分减小网格尺寸 $h$ 来满足这个条件。虽然对于 $\\beta/\\varepsilon$ 比率非常高的问题，这在计算上可能代价高昂，但这是一种恢复单调性的数学上合理且有效的方法。该陈述是**正确的**。\n\n综上所述，选项 A、B、D 和 F 描述了为对流占优的对流扩散方程恢复离散单调性的有效方法。", "answer": "$$\\boxed{ABDF}$$", "id": "2612128"}, {"introduction": "许多复杂的物理现象，如不可压缩流体流动或近不可压缩弹性，最好通过包含多个未知场的“混合法”来建模。然而，这些高级方法的成功依赖于满足严格的稳定性条件。本练习将探讨混合有限元方法的核心挑战——体积锁定（volumetric locking）和伪压力模式，并让你辨析保证数值稳定性的关键（即LBB条件）以及如何设计稳定的单元对来克服这些问题。[@problem_id:2612186]", "problem": "考虑在有界域 $\\Omega \\subset \\mathbb{R}^d$ 上的小应变各向同性线弹性问题，体力为 $f \\in [L^2(\\Omega)]^d$，并在边界 $\\partial \\Omega$ 上施加齐次Dirichlet边界条件。设Lamé参数为 $\\,\\mu>0\\,$ 和 $\\,\\lambda \\gg \\mu\\,$（近不可压缩状态）。引入位移-压力混合格式，其中位移为 $u:\\Omega \\to \\mathbb{R}^d$，压力为 $p:\\Omega \\to \\mathbb{R}$，应力为 $\\sigma(u,p) = 2\\mu\\,\\varepsilon(u) - p\\,I$，运动学约束为 $\\nabla \\cdot u + \\frac{1}{\\lambda}p = 0$，其中 $\\varepsilon(u) = \\tfrac{1}{2}(\\nabla u + \\nabla u^\\top)$。其强形式为\n$\n-\\nabla \\cdot \\sigma(u,p) = f \\text{ in } \\Omega, \\quad \\nabla \\cdot u + \\tfrac{1}{\\lambda} p = 0 \\text{ in } \\Omega, \\quad u = 0 \\text{ on } \\partial \\Omega.\n$\nGalerkin加权余量法在空间 $V \\times W$ 中求解 $(u,p)$，其中 $V = [H_0^1(\\Omega)]^d$ 且 $W = L_2(\\Omega)$，使得对于所有检验函数 $(v,q)\\in V \\times W$，满足\n$\n\\int_{\\Omega} 2\\mu\\,\\varepsilon(u):\\varepsilon(v)\\,dx - \\int_{\\Omega} p\\,\\nabla \\cdot v\\,dx = \\int_{\\Omega} f \\cdot v\\,dx,\\quad \n-\\int_{\\Omega} q\\,\\nabla \\cdot u\\,dx - \\int_{\\Omega} \\tfrac{1}{\\lambda} p\\,q\\,dx = 0.\n$\n设 $(V_h,W_h)$ 为有限维试探空间，并使用相同的空间作为检验函数空间（标准Galerkin加权余量离散化）。在实践中，当 $\\lambda \\to \\infty$ 时，某些 $(V_h,W_h)$ 的选择会产生体积锁定或伪压力模式，而其他选择则能保持稳定。\n\n仅使用加权余量离散化的基本概念、强制 $\\nabla \\cdot u = 0$ 的约束极限 $\\lambda \\to \\infty$ 的概念，以及要求Ladyzhenskaya–Babuška–Brezzi (LBB) inf–sup 条件关于 $\\lambda$ 一致成立的稳定性要求，回答以下问题。选择所有正确的陈述。\n\nA. 在Galerkin加权余量混合格式中，如果 $(V_h,W_h)$ 不满足关于 $\\lambda$ 一致的离散LBB inf–sup条件，那么当 $\\lambda \\to \\infty$ 时，离散约束 $\\nabla \\cdot u_h \\approx 0$ 相对于 $V_h$ 会变得过度约束，从而导致体积锁定和伪压力模式。选择一个LBB稳定单元对（例如，在单纯形上使用连续二次位移和连续线性压力的Taylor–Hood单元，即 $P_2\\text{–}P_1$）可以消除锁定并得到最优收敛率。\n\nB. 对于位移和压力均使用同阶连续线性插值（即 $P_1\\text{–}P_1$）的标准Galerkin加权余量离散化，在 $\\lambda \\to \\infty$ 时是无条件稳定的，因为不可压缩约束只是被弱形式强制；因此，不需要对 $(V_h,W_h)$ 施加inf–sup约束，且不会发生锁定。\n\nC. 混合元中一种可行的补救措施是，在Galerkin加权余量格式中增加一个一致的压力稳定项（例如，单元间边界上的压力跳跃罚项或压力稳定的Petrov–Galerkin项），该项的缩放独立于 $\\lambda$，以便为同阶单元对提供一致的稳定性；如果设计得一致，这种稳定化方法可以避免锁定并保持最优收敛率。\n\nD. 通过配置法（选择 $q_h$ 为节点或求积点上的Dirac测度）取代压力方程中的Galerkin加权，会使得不可压缩约束变为逐点满足，因此总能抑制伪压力模式并为任意单元对 $(V_h,W_h)$ 消除锁定。\n\nE. 在纯位移格式中对体积项进行选择性减缩积分，严格等价于一种稳定的混合法，因此为近不可压缩响应提供了一种普遍有效的补救措施，且无需引入压力场，也与网格或单元类型无关。\n\n通过选择正确的选项来回答。", "solution": "问题陈述描述了近不可压缩状态下线弹性的位移-压力混合格式。该格式是标准的，在数学上是完善的。它正确地确定了函数空间、强形式以及相应的弱（Galerkin）形式。问题要求评估关于该问题有限元离散化数值稳定性的几个陈述，特别是在Lamé参数 $\\lambda \\to \\infty$ 的不可压缩极限情况下。涉及的关键概念是Ladyzhenskaya–Babuška–Brezzi (LBB) inf-sup条件、体积锁定和伪压力模式。该问题具有科学依据、是适定且客观的。我们可以开始进行分析。\n\n离散弱形式是一个鞍点问题。其稳定性取决于两个条件：\n1. 双线性形式 $a(u_h, v_h) = \\int_{\\Omega} 2\\mu\\,\\varepsilon(u_h):\\varepsilon(v_h)\\,dx$ 在离散散度算子的核空间上具有矫顽性。对于给定问题，只要区域不支持刚体运动，这一点就能得到保证，而边界 $\\partial\\Omega$ 上的齐次Dirichlet条件 $u=0$ 确保了这一点。\n2. 有限元空间对 $(V_h, W_h)$ 必须满足离散LBB inf-sup条件，该条件要求存在一个常数 $\\beta > 0$（与网格尺寸h无关），使得：\n$$ \\inf_{q_h \\in W_h/K_0} \\sup_{v_h \\in V_h} \\frac{-\\int_{\\Omega} q_h (\\nabla \\cdot v_h) \\,dx}{\\|v_h\\|_{[H^1(\\Omega)]^d} \\|q_h\\|_{L^2(\\Omega)/K_0}} \\ge \\beta $$\n此处，$W_h/K_0$ 表示压力空间模去连续散度算子的核空间（如果适用，即常数压力空间）。为了使方法在近不可压缩极限下保持稳定，此条件必须在 $\\lambda \\to \\infty$ 时一致成立。不满足此条件会导致数值不稳定性。\n\n现在我们来评估每个陈述。\n\n**A. 在Galerkin加权余量混合格式中，如果 $(V_h,W_h)$ 不满足关于 $\\lambda$ 一致的离散LBB inf–sup条件，那么当 $\\lambda \\to \\infty$ 时，离散约束 $\\nabla \\cdot u_h \\approx 0$ 相对于 $V_h$ 会变得过度约束，从而导致体积锁定和伪压力模式。选择一个LBB稳定单元对（例如，在单纯形上使用连续二次位移和连续线性压力的Taylor–Hood单元，即 $P_2\\text{–}P_1$）可以消除锁定并得到最优收敛率。**\n\n这个陈述是 **正确的**。LBB条件是像不可压缩弹性这样的约束问题的混合有限元方法稳定性的基本要求。当 $\\lambda \\to \\infty$ 时，弱形式方程第二项中的 $-\\int_{\\Omega} \\tfrac{1}{\\lambda} p\\,q\\,dx$ 消失，导致对于所有 $q_h \\in W_h$ 都有约束 $\\int_{\\Omega} q_h (\\nabla \\cdot u_h) \\,dx = 0$。如果压力空间 $W_h$ 太大或与位移空间 $V_h$ 没有正确配对（即LBB条件失效），可能会出现两种病态问题。首先，$V_h$ 中弱散度自由的函数集合可能变得平凡或过小，这会“锁定”解（体积锁定），产生过刚的响应和差的收敛性。其次，离散散度算子可能有很大的核空间，从而允许出现不受位移控制的、非物理的、振荡的压力解（伪模式）。LBB条件的失效是这些不稳定性的数学根源。Taylor–Hood单元族，例如 $P_2\\text{–}P_1$（二次位移，线性压力）单元，是LBB稳定单元对的经典例子，它规避了这些问题并提供了最优收敛率。\n\n**B. 对于位移和压力均使用同阶连续线性插值（即 $P_1\\text{–}P_1$）的标准Galerkin加权余量离散化，在 $\\lambda \\to \\infty$ 时是无条件稳定的，因为不可压缩约束只是被弱形式强制；因此，不需要对 $(V_h,W_h)$ 施加inf–sup约束，且不会发生锁定。**\n\n这个陈述是 **不正确的**。所提出的理由在根本上是错误的。位移和压力使用同阶连续线性函数，即 $P_1\\text{–}P_1$ 单元，是不可压缩问题中LBB不稳定单元对的一个众所周知的例子。约束的弱形式强制恰恰是LBB条件对稳定性之所以必要的原因；它确保了试探空间和检验空间之间的兼容性。$P_1\\text{–}P_1$ 单元远非无条件稳定，而是饱受伪棋盘状压力振荡的困扰。“不需要……inf-sup约束”的说法与已建立的混合有限元方法理论直接矛盾。此外，尽管该单元最著名的是伪压力问题，但在不可压缩极限下其性能会显著恶化，这也是锁定的一种表现。\n\n**C. 混合元中一种可行的补救措施是，在Galerkin加权余量格式中增加一个一致的压力稳定项（例如，单元间边界上的压力跳跃罚项或压力稳定的Petrov–Galerkin项），该项的缩放独立于 $\\lambda$，以便为同阶单元对提供一致的稳定性；如果设计得一致，这种稳定化方法可以避免锁定并保持最优收敛率。**\n\n这个陈述是 **正确的**。这准确地描述了稳定化有限元方法背后的原理。对于不满足LBB条件的单元对，例如同阶插值，可以通过向弱格式中添加精心设计的项来恢复稳定性。这些项，例如压力稳定的Petrov-Galerkin (PSPG) 或Galerkin/最小二乘 (GLS) 方法中的项，通常作用于控制方程的残差，并通过一个稳定化参数 $\\tau$ 进行缩放。为了使稳定化在近不可压缩极限下有效，$\\tau$ 必须被恰当地选择，通常取决于网格尺寸 $h$ 和剪切模量 $\\mu$，但关键的是，要保持独立于 $\\lambda$。这确保了方法在 $\\lambda \\to \\infty$ 时性能不会退化。一个“一致的”稳定化项是指当精确解代入时该项为零的项，这确保了该方法不会引入人为误差，并且仍然可以达到最优收敛率。这种方法是使用像 $P_1\\text{–}P_1$ 这样不稳定但在计算上方便的单元对的一种标准而有效的技术。\n\n**D. 通过配置法（选择 $q_h$ 为节点或求积点上的Dirac测度）取代压力方程中的Galerkin加权，会使得不可压缩约束变为逐点满足，因此总能抑制伪压力模式并为任意单元对 $(V_h,W_h)$ 消除锁定。**\n\n这个陈述是 **不正确的**。虽然配置法——在一组离散点上强制执行约束方程——是一种有效的加权余量策略，但声称它对“任何单元对”都“总是”有效是一种严重的过度简化并且是错误的。配置法的稳定性关键取决于配置点的数量和位置与位移场和压力场自由度的相对关系。这创造了其自身版本的LBB条件，而该条件并不会自动满足。如果配置点的数量与有限元空间的维数没有适当平衡，人们很容易遇到锁定（约束点过多）或欠定的压力场。配置法不是一种可以绕过稳定性考虑的普适解法。\n\n**E. 在纯位移格式中对体积项进行选择性减缩积分，严格等价于一种稳定的混合法，因此为近不可压缩响应提供了一种普遍有效的补救措施，且无需引入压力场，也与网格或单元类型无关。**\n\n这个陈述是 **不正确的**。这指的是像SRI（选择性减缩积分）或B-bar方法。Malkus和Hughes的等价理论表明，对于某些单元类型，对基于罚函数的纯位移格式的体积项应用减缩求积，与一种特定的混合方法是等价的。然而，其普遍有效性的说法是错误的。这种等价可能对应于一个*不稳定*的混合方法。例如，对4节点四边形位移单元（$Q_1$）的体积部分使用1点求积，等价于 $Q_1-P_0$（双线性位移，常数压力）混合法，而该方法本身就存在锁定和不稳定性问题。虽然对其他单元，如9节点四边形单元（$Q_2$），SRI等价于一种稳定的混合法（$Q_2\\text{–}P_1^{disc}$），但这种成功是高度依赖于单元的。因此，SRI并不是一种“不论……单元类型”都普遍有效的补救措施。\n\n总之，陈述A和C是关于近不可压缩弹性问题的混合有限元方法和稳定化有限元方法理论的正确表述。", "answer": "$$\\boxed{AC}$$", "id": "2612186"}]}