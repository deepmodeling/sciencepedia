{"hands_on_practices": [{"introduction": "泊松方程是数学物理的基石，描述了从静电学到热传导的多种现象。本练习将展示 Gâteaux 导数的威力，它能将一个能量最小化问题，如 $J(u)=\\frac{1}{2}\\int_{\\Omega} |\\nabla u|^{2}dx-\\int_{\\Omega} fu dx$，转化为偏微分方程的弱形式。这个弱形式是有限元法的基本出发点，通过本练习，您将巩固对变分法与边值问题提法之间联系的理解 [@problem_id:3035874]。", "problem": "设 $\\Omega \\subset \\mathbb{R}^{n}$ 是一个有界Lipschitz区域，其单位外法向量为 $\\nu$，并设 $f \\in L^{2}(\\Omega)$。考虑泊松能量泛函 $J:H^{1}(\\Omega)\\to \\mathbb{R}$，其定义为\n$$\nJ(u)\\equiv \\frac{1}{2}\\int_{\\Omega}|\\nabla u|^{2}\\,dx-\\int_{\\Omega}f\\,u\\,dx.\n$$\n使用变分法，从Gâteaux导数的定义和散度定理出发，完成以下步骤，过程中不得使用任何预先给出的Euler–Lagrange公式。\n\n(1) 通过计算在任意方向 $v \\in H^{1}(\\Omega)$ 上的一阶变分 $\\delta J(u;v)$，推导泛函 $J$ 在其极小值点 $u \\in H^{1}(\\Omega)$ 处的弱平稳性条件。\n\n(2) 将问题限定于Dirichlet类 $H^{1}_{0}(\\Omega)$，其中 $v$ 在 $\\partial\\Omega$ 上的迹为零。假设有足够的正则性，从弱平稳性条件出发，确定极小值点在经典意义下所满足的偏微分方程(PDE)和边界条件。\n\n(3) 对Neumann类重复此推导过程，其中 $u$ 在 $\\partial\\Omega$ 上是自由的，且变分 $v$ 在 $\\partial\\Omega$ 上不必为零。确定由平稳性所蕴含的自然边界条件，并陈述为保证可解性 $f$ 所需的任何相容性条件。\n\n(4) 对于Dirichlet类 $H^{1}_{0}(\\Omega)$，从弱形式中确定双线性形式 $a(u,v)$ 和线性泛函 $\\ell(v)$。使用范数 $\\|u\\|_{H^{1}_{0}(\\Omega)}\\equiv \\left(\\int_{\\Omega}|\\nabla u|^{2}\\,dx\\right)^{1/2}$，验证Lax–Milgram定理关于 $a(\\cdot,\\cdot)$ 的连续性和矫顽性假设，以及关于 $\\ell(\\cdot)$ 的连续性假设，并计算由下式定义的矫顽常数 $\\alpha$：\n$$\na(u,u)\\ge \\alpha\\,\\|u\\|_{H^{1}_{0}(\\Omega)}^{2}\\quad\\text{for all }u\\in H^{1}_{0}(\\Omega).\n$$\n\n你最终报告的答案应该是矫顽常数 $\\alpha$ 的值，表示为一个实数。无需四舍五入，也不涉及单位。不要在最终答案中报告任何中间方程。", "solution": "该问题要求完成一个关于泊松能量泛函、其平稳性条件以及Lax-Milgram定理应用的多步骤推导。我们将按照题目要求，从基本原理出发，依次解决每个部分。\n\n(1) 弱平稳性条件的推导。\n\n泛函 $J(u)$ 在点 $u \\in H^{1}(\\Omega)$ 处沿方向 $v \\in H^{1}(\\Omega)$ 的Gâteaux导数，或称一阶变分，定义为\n$$\n\\delta J(u;v) = \\frac{d}{d\\epsilon}\\bigg|_{\\epsilon=0} J(u+\\epsilon v) = \\lim_{\\epsilon \\to 0} \\frac{J(u+\\epsilon v) - J(u)}{\\epsilon}.\n$$\n我们首先对一个标量 $\\epsilon \\in \\mathbb{R}$ 计算 $J(u+\\epsilon v)$：\n$$\nJ(u+\\epsilon v) = \\frac{1}{2}\\int_{\\Omega}|\\nabla (u+\\epsilon v)|^{2}\\,dx - \\int_{\\Omega}f(u+\\epsilon v)\\,dx.\n$$\n梯度项的平方范数可以展开为：\n$$\n|\\nabla (u+\\epsilon v)|^{2} = |\\nabla u + \\epsilon \\nabla v|^{2} = (\\nabla u + \\epsilon \\nabla v) \\cdot (\\nabla u + \\epsilon \\nabla v) = |\\nabla u|^{2} + 2\\epsilon(\\nabla u \\cdot \\nabla v) + \\epsilon^{2}|\\nabla v|^{2}.\n$$\n将此代回 $J(u+\\epsilon v)$ 的表达式，并利用积分的线性性质，我们得到\n$$\nJ(u+\\epsilon v) = \\frac{1}{2}\\int_{\\Omega} (|\\nabla u|^{2} + 2\\epsilon(\\nabla u \\cdot \\nabla v) + \\epsilon^{2}|\\nabla v|^{2})\\,dx - \\int_{\\Omega} (fu + \\epsilon fv)\\,dx\n$$\n$$\nJ(u+\\epsilon v) = \\left(\\frac{1}{2}\\int_{\\Omega}|\\nabla u|^{2}\\,dx - \\int_{\\Omega}fu\\,dx\\right) + \\epsilon \\left(\\int_{\\Omega}(\\nabla u \\cdot \\nabla v)\\,dx - \\int_{\\Omega}fv\\,dx\\right) + \\frac{\\epsilon^{2}}{2}\\int_{\\Omega}|\\nabla v|^{2}\\,dx.\n$$\n第一项恰好是 $J(u)$。因此，差值为\n$$\nJ(u+\\epsilon v) - J(u) = \\epsilon \\left(\\int_{\\Omega}(\\nabla u \\cdot \\nabla v)\\,dx - \\int_{\\Omega}fv\\,dx\\right) + \\frac{\\epsilon^{2}}{2}\\int_{\\Omega}|\\nabla v|^{2}\\,dx.\n$$\n两边除以 $\\epsilon$ 并取 $\\epsilon \\to 0$ 的极限：\n$$\n\\delta J(u;v) = \\lim_{\\epsilon \\to 0} \\left[ \\left(\\int_{\\Omega}(\\nabla u \\cdot \\nabla v)\\,dx - \\int_{\\Omega}fv\\,dx\\right) + \\frac{\\epsilon}{2}\\int_{\\Omega}|\\nabla v|^{2}\\,dx \\right]\n$$\n$$\n\\delta J(u;v) = \\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx - \\int_{\\Omega}f v\\,dx.\n$$\n极小值点 $u$ 是泛函 $J$ 的一个驻点，这意味着其一阶变分对所有容许方向 $v$ 都必须为零。因此，弱平稳性条件为 $\\delta J(u;v) = 0$，其具体形式是：\n$$\n\\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx - \\int_{\\Omega}f v\\,dx = 0 \\quad \\text{for all } v \\in H^{1}(\\Omega).\n$$\n\n(2) 在 $H^{1}_{0}(\\Omega)$ 上的Dirichlet问题。\n\n我们现在将问题限定在函数空间为 $H^{1}_{0}(\\Omega)$ 的情况，这是在边界 $\\partial\\Omega$ 上迹为零的 $H^{1}$ 函数空间。极小值点 $u$ 必须属于 $H^{1}_{0}(\\Omega)$，变分 $v$ 也必须在 $H^{1}_{0}(\\Omega)$ 中。弱平稳性条件是\n$$\n\\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx = \\int_{\\Omega}f v\\,dx \\quad \\text{for all } v \\in H^{1}_{0}(\\Omega).\n$$\n为了推导PDE，我们假设极小值点 $u$ 具有足够的正则性（例如，$u \\in H^{2}(\\Omega)$），从而可以应用经典导数和散度定理。我们使用Green第一恒等式，它是将散度定理应用于向量场 $v\\nabla u$ 的一个推论：$\\text{div}(v\\nabla u) = v\\Delta u + \\nabla v \\cdot \\nabla u$。在 $\\Omega$ 上积分可得\n$$\n\\int_{\\Omega} (v\\Delta u + \\nabla v \\cdot \\nabla u) \\,dx = \\int_{\\partial\\Omega} (v\\nabla u) \\cdot \\nu \\,dS.\n$$\n整理后，我们得到\n$$\n\\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx = -\\int_{\\Omega}v \\Delta u \\,dx + \\int_{\\partial\\Omega}v (\\nabla u \\cdot \\nu)\\,dS.\n$$\n由于 $v \\in H^{1}_{0}(\\Omega)$，它在边界上的迹为零，即 $v|_{\\partial\\Omega}=0$。因此边界积分为零。将此代入弱形式中：\n$$\n-\\int_{\\Omega}v \\Delta u \\,dx = \\int_{\\Omega}f v\\,dx \\quad \\implies \\quad \\int_{\\Omega}(-\\Delta u - f)v\\,dx = 0.\n$$\n此方程必须对所有 $v \\in H^{1}_{0}(\\Omega)$ 成立。由于具有紧支集的光滑函数空间 $C_{c}^{\\infty}(\\Omega)$ 是 $H^{1}_{0}(\\Omega)$ 的一个稠密子空间，该等式对所有 $v \\in C_{c}^{\\infty}(\\Omega)$ 均成立。根据变分法基本引理，如果一个函数与所有光滑紧支集函数的乘积的积分为零，则该函数自身必须几乎处处为零。因此，我们得到该PDE：\n$$\n-\\Delta u = f \\quad \\text{in } \\Omega.\n$$\n边界条件是由解所在的函数空间 $u \\in H^{1}_{0}(\\Omega)$ 决定的，这意味着齐次Dirichlet边界条件：\n$$\nu = 0 \\quad \\text{on } \\partial\\Omega.\n$$\n\n(3) Neumann问题。\n\n对于Neumann问题，解 $u$ 和变分 $v$ 都在 $H^{1}(\\Omega)$ 中，对其边界值没有先验约束。弱平稳性条件同样是\n$$\n\\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx - \\int_{\\Omega}f v\\,dx = 0 \\quad \\text{for all } v \\in H^{1}(\\Omega).\n$$\n和之前一样应用Green第一恒等式（再次假设 $u$ 具有足够的正则性）：\n$$\n\\left(-\\int_{\\Omega}v \\Delta u \\,dx + \\int_{\\partial\\Omega}v (\\nabla u \\cdot \\nu)\\,dS\\right) - \\int_{\\Omega}f v\\,dx = 0.\n$$\n整理可得\n$$\n\\int_{\\Omega}(-\\Delta u - f)v\\,dx + \\int_{\\partial\\Omega} (\\nabla u \\cdot \\nu) v \\,dS = 0 \\quad \\text{for all } v \\in H^{1}(\\Omega).\n$$\n这个等式必须对 $v \\in H^{1}(\\Omega)$ 的任何选择都成立。我们可以首先从子空间 $H^{1}_{0}(\\Omega)$ 中选择变分 $v$，此时 $v|_{\\partial\\Omega}=0$。对于这样的 $v$，边界积分为零，我们得到 $\\int_{\\Omega}(-\\Delta u - f)v\\,dx = 0$。如同在第(2)部分中一样，这蕴含了PDE：\n$$\n-\\Delta u = f \\quad \\text{in } \\Omega.\n$$\n由于这个PDE必须成立，它在完整的平稳性条件中也必须被满足。将 $-\\Delta u = f$ 代回该条件中，得到：\n$$\n\\int_{\\partial\\Omega} (\\nabla u \\cdot \\nu) v \\,dS = 0 \\quad \\text{for all } v \\in H^{1}(\\Omega).\n$$\n由于从 $H^{1}(\\Omega)$ 到 $L^{2}(\\partial\\Omega)$ 的迹算子是满射的，我们可以选择 $v$ 使其在边界上的迹 $v|_{\\partial\\Omega}$ 可以是 $L^{2}(\\partial\\Omega)$ 中的任意函数（或其稠密子集中的函数）。为了让该积分对所有这些选择都为零，被积项中的另一个因子必须为零。这就给出了自然边界条件：\n$$\n\\nabla u \\cdot \\nu = \\frac{\\partial u}{\\partial \\nu} = 0 \\quad \\text{on } \\partial\\Omega.\n$$\n这是齐次Neumann边界条件。\n为了保证可解性，对 $f$ 有一个相容性条件。将PDE $-\\Delta u = f$ 在区域 $\\Omega$ 上积分：\n$$\n-\\int_{\\Omega}\\Delta u \\,dx = \\int_{\\Omega}f\\,dx.\n$$\n对左侧应用散度定理：\n$$\n-\\int_{\\Omega}\\text{div}(\\nabla u) \\,dx = -\\int_{\\partial\\Omega}\\nabla u \\cdot \\nu \\,dS.\n$$\n使用自然边界条件 $\\nabla u \\cdot \\nu = 0$，左侧变为 $0$。因此，为了使解存在，右侧也必须为零。这就给出了相容性条件：\n$$\n\\int_{\\Omega}f\\,dx = 0.\n$$\n\n(4) Dirichlet问题的Lax-Milgram假设。\n\nDirichlet问题的弱形式是：寻求 $u \\in H^{1}_{0}(\\Omega)$，使得\n$$\n\\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx = \\int_{\\Omega}f v\\,dx \\quad \\text{对所有 } v \\in H^{1}_{0}(\\Omega).\n$$\n它的形式为 $a(u,v) = \\ell(v)$，其中：\n- 双线性形式为 $a(u,v) = \\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx$。\n- 线性泛函为 $\\ell(v) = \\int_{\\Omega}f v\\,dx$。\nHilbert空间为 $V = H^{1}_{0}(\\Omega)$，其范数被指定为 $\\|w\\|_{H^{1}_{0}(\\Omega)} = \\left(\\int_{\\Omega}|\\nabla w|^{2}\\,dx\\right)^{1/2}$。根据Poincaré不等式，这是 $H^{1}_{0}(\\Omega)$ 上的一个有效范数。\n\n我们验证Lax-Milgram定理的假设：$a(\\cdot,\\cdot)$ 的连续性和矫顽性，以及 $\\ell(\\cdot)$ 的连续性。\n\n- **$a(u,v)$ 的连续性**：我们必须证明存在一个常数 $M > 0$ 使得对所有 $u, v \\in H^{1}_{0}(\\Omega)$，都有 $|a(u,v)| \\le M \\|u\\|_{H^{1}_{0}(\\Omega)}\\|v\\|_{H^{1}_{0}(\\Omega)}$。\n通过积分的Cauchy-Schwarz不等式:\n$$\n|a(u,v)| = \\left|\\int_{\\Omega}\\nabla u \\cdot \\nabla v\\,dx\\right| \\le \\int_{\\Omega}|\\nabla u \\cdot \\nabla v|\\,dx.\n$$\n根据$\\mathbb{R}^n$中向量的逐点Cauchy-Schwarz不等式：$|\\nabla u \\cdot \\nabla v| \\le |\\nabla u||\\nabla v|$。因此，\n$$\n\\int_{\\Omega}|\\nabla u \\cdot \\nabla v|\\,dx \\le \\int_{\\Omega}|\\nabla u||\\nabla v|\\,dx.\n$$\n再次应用积分的Cauchy-Schwarz不等式：\n$$\n\\int_{\\Omega}|\\nabla u||\\nabla v|\\,dx \\le \\left(\\int_{\\Omega}|\\nabla u|^{2}\\,dx\\right)^{1/2} \\left(\\int_{\\Omega}|\\nabla v|^{2}\\,dx\\right)^{1/2}.\n$$\n使用给定的范数定义，这便是\n$$\n|a(u,v)| \\le \\|u\\|_{H^{1}_{0}(\\Omega)}\\|v\\|_{H^{1}_{0}(\\Omega)}.\n$$\n因此，$a(\\cdot,\\cdot)$ 是连续的，其连续性常数 $M=1$。\n\n- **$\\ell(v)$ 的连续性**：我们必须证明存在一个常数 $C > 0$ 使得对所有 $v \\in H^{1}_{0}(\\Omega)$，都有 $|\\ell(v)| \\le C \\|v\\|_{H^{1}_{0}(\\Omega)}$。\n$$\n|\\ell(v)| = \\left|\\int_{\\Omega}f v\\,dx\\right|.\n$$\n根据Cauchy-Schwarz不等式，\n$$\n|\\ell(v)| \\le \\left(\\int_{\\Omega}|f|^{2}\\,dx\\right)^{1/2} \\left(\\int_{\\Omega}|v|^{2}\\,dx\\right)^{1/2} = \\|f\\|_{L^{2}(\\Omega)}\\|v\\|_{L^{2}(\\Omega)}.\n$$\n对于有界区域 $\\Omega$ 的Poincaré不等式表明，存在一个仅依赖于 $\\Omega$ 和 $n$ 的常数 $C_{P} > 0$，使得对任意 $v \\in H^{1}_{0}(\\Omega)$，\n$$\n\\|v\\|_{L^{2}(\\Omega)} \\le C_{P} \\|\\nabla v\\|_{L^{2}(\\Omega)} = C_{P} \\left(\\int_{\\Omega}|\\nabla v|^{2}\\,dx\\right)^{1/2}.\n$$\n使用问题中对 $H^{1}_{0}(\\Omega)$ 上范数的定义，这可以写作 $\\|v\\|_{L^{2}(\\Omega)} \\le C_{P} \\|v\\|_{H^{1}_{0}(\\Omega)}$。将此代入 $|\\ell(v)|$ 的不等式中：\n$$\n|\\ell(v)| \\le \\|f\\|_{L^{2}(\\Omega)} (C_{P} \\|v\\|_{H^{1}_{0}(\\Omega)}) = (C_{P}\\|f\\|_{L^{2}(\\Omega)}) \\|v\\|_{H^{1}_{0}(\\Omega)}.\n$$\n由于 $f \\in L^{2}(\\Omega)$，$\\|f\\|_{L^{2}(\\Omega)}$ 是有限的。因此，$\\ell(\\cdot)$ 是连续的，其连续性常数为 $C = C_{P}\\|f\\|_{L^{2}(\\Omega)}$。\n\n- **$a(u,u)$ 的矫顽性**：我们必须找到一个常数 $\\alpha > 0$，使得对所有 $u \\in H^{1}_{0}(\\Omega)$，都有 $a(u,u) \\ge \\alpha \\|u\\|_{H^{1}_{0}(\\Omega)}^{2}$。\n根据双线性形式的定义，\n$$\na(u,u) = \\int_{\\Omega}\\nabla u \\cdot \\nabla u\\,dx = \\int_{\\Omega}|\\nabla u|^{2}\\,dx.\n$$\n根据问题中提供的范数定义，\n$$\n\\|u\\|_{H^{1}_{0}(\\Omega)}^{2} = \\left(\\left(\\int_{\\Omega}|\\nabla u|^{2}\\,dx\\right)^{1/2}\\right)^{2} = \\int_{\\Omega}|\\nabla u|^{2}\\,dx.\n$$\n因此，我们有等式\n$$\na(u,u) = \\|u\\|_{H^{1}_{0}(\\Omega)}^{2}.\n$$\n通过选择 $\\alpha = 1$，这可以写成不等式 $a(u,u) \\ge \\alpha \\|u\\|_{H^{1}_{0}(\\Omega)}^{2}$。由于 $1 > 0$，该双线性形式是矫顽的。矫顽常数是 $\\alpha = 1$。", "answer": "$$\\boxed{1}$$", "id": "3035874"}, {"introduction": "尽管许多问题涉及具有唯一最小值的凸能量泛函，但许多物理系统要复杂得多。本练习将探索一个经典的非凸“双阱”泛函，揭示此类系统如何拥有多个驻定点，这些驻定点代表了系统不同的稳定状态 [@problem_id:2559350]。您将发现一阶变分的局限性：它能找出所有驻定点，但本身无法区分哪些是极小值点、极大值点或鞍点，从而凸显了二阶条件的重要性。", "problem": "考虑泛函 $J: H_0^1(0,1) \\to \\mathbb{R}$，其定义为\n$$\nJ(u) \\;=\\; \\int_0^1 \\left( \\frac{\\varepsilon^2}{2}\\,|u'(x)|^2 \\;-\\; \\frac{\\alpha}{2}\\,u(x)^2 \\;+\\; \\frac{\\beta}{4}\\,u(x)^4 \\right)\\,dx,\n$$\n其中参数 $\\varepsilon>0$，$\\alpha>0$，$\\beta>0$。该泛函源于一种双阱类型模型，由于二次项和四次项之间的竞争，它关于 $u$ 是非凸的。考虑在试探空间 $V_h=\\mathrm{span}\\{\\varphi\\}$ 上的一个一维 Galerkin 离散化，其中 $\\varphi(x)=\\sin(\\pi x)$，并通过 $u_h(x)=a\\,\\varphi(x)$ 将 $J$ 限制在 $V_h$ 上，得到一个标量泛函 $J_h:\\mathbb{R}\\to\\mathbb{R}$，$J_h(a)=J(a\\varphi)$。\n\n仅使用一阶变分（Gâteaux 导数）的定义\n$$\n\\delta J_h(a;\\delta a) \\;=\\; \\left.\\frac{d}{dt}\\,J_h(a+t\\,\\delta a)\\right|_{t=0},\n$$\n并结合标准微积分以及 $H_0^1(0,1)$ 和 $\\varphi$ 的性质，推导出 $J_h$ 的驻点条件，并确定 $J_h$ 存在多个驻点的参数范围。然后，回答以下关于一阶变分能揭示什么以及不能确定什么（关于极小值点）的多项选择题。此处，记\n$$\nI_0 \\;=\\;\\int_0^1 \\varphi(x)^2\\,dx,\\quad I_2 \\;=\\;\\int_0^1 |\\varphi'(x)|^2\\,dx,\\quad I_4 \\;=\\;\\int_0^1 \\varphi(x)^4\\,dx.\n$$\n\n选择所有正确的陈述。\n\nA. 如果 $\\alpha\\,I_0>\\varepsilon^2\\,I_2$，则 $J_h$ 有恰好三个驻点 $a=0$ 和 $a=\\pm a_\\star\\neq 0$，并且仅凭一阶变分无法确定哪些是极小值点。\n\nB. 因为一阶变分在 $a=0$ 处为零，所以对于所有参数值，点 $a=0$ 必然是 $J_h$ 的一个极小值点。\n\nC. 一阶变分导出欧拉方程，因此足以推断 $J$ 在 $H_0^1(0,1)$ 上是非凸的。\n\nD. 判断极小性需要考察二阶变分：当 $\\alpha\\,I_0>\\varepsilon^2\\,I_2$ 时，有 $J_h''(0)<0$（因此 $a=0$ 不是一个极小值点）和 $J_h''(\\pm a_\\star)>0$（因此 $a=\\pm a_\\star$ 是局部极小值点）。\n\nE. 在非凸情形 $\\alpha\\,I_0>\\varepsilon^2\\,I_2$ 下，两个非零驻点是 $J_h$ 的全局极小值点，但仅从一阶变分无法得出此结论。", "solution": "我们从标量简化泛函 $J_h(a)=J(a\\varphi)$ 的 Gâteaux 导数（一阶变分）的定义开始：\n$$\n\\delta J_h(a;\\delta a) \\;=\\; \\left.\\frac{d}{dt}J_h(a+t\\,\\delta a)\\right|_{t=0}.\n$$\n因为 $u_h(x)=a\\,\\varphi(x)$，我们有 $u_h'(x)=a\\,\\varphi'(x)$。代入 $J$ 得到\n$$\nJ_h(a) \\;=\\; \\int_0^1 \\left( \\frac{\\varepsilon^2}{2}\\,a^2\\,|\\varphi'(x)|^2 \\;-\\; \\frac{\\alpha}{2}\\,a^2\\,\\varphi(x)^2 \\;+\\; \\frac{\\beta}{4}\\,a^4\\,\\varphi(x)^4 \\right)\\,dx.\n$$\n引入积分\n$$\nI_0 = \\int_0^1 \\varphi^2\\,dx,\\qquad I_2 = \\int_0^1 |\\varphi'|^2\\,dx,\\qquad I_4=\\int_0^1 \\varphi^4\\,dx.\n$$\n于是\n$$\nJ_h(a) \\;=\\; \\frac{1}{2}\\left(\\varepsilon^2 I_2 - \\alpha I_0\\right)a^2 \\;+\\; \\frac{\\beta}{4} I_4\\, a^4.\n$$\n对于具体的 $\\varphi(x)=\\sin(\\pi x)$，我们可以显式计算\n$$\nI_0 \\;=\\; \\int_0^1 \\sin^2(\\pi x)\\,dx \\;=\\; \\frac{1}{2},\\qquad\nI_2 \\;=\\; \\int_0^1 \\pi^2\\cos^2(\\pi x)\\,dx \\;=\\; \\frac{\\pi^2}{2},\n$$\n并使用 $\\sin^4(\\theta)=\\tfrac{3}{8}-\\tfrac{1}{2}\\cos(2\\theta)+\\tfrac{1}{8}\\cos(4\\theta)$，\n$$\nI_4 \\;=\\; \\int_0^1 \\sin^4(\\pi x)\\,dx \\;=\\; \\frac{3}{8}.\n$$\n因此，从数值上看，\n$$\nJ_h(a) \\;=\\; \\frac{1}{2}\\left(\\varepsilon^2 \\frac{\\pi^2}{2} - \\alpha \\frac{1}{2}\\right)a^2 \\;+\\; \\frac{\\beta}{4}\\frac{3}{8}\\, a^4\n\\;=\\; c_2\\,a^2 + c_4\\,a^4,\n$$\n其中 $c_2 = \\frac{1}{4}(\\varepsilon^2\\pi^2 - \\alpha)$ 且 $c_4=\\frac{3\\beta}{32}>0$。然而，为便于下文的推导，保持用 $I_0$、$I_2$ 和 $I_4$ 表示的表达式会更方便。\n\n一阶变分。对 $a$ 求导：\n$$\n\\delta J_h(a;\\delta a) \\;=\\; \\left( (\\varepsilon^2 I_2 - \\alpha I_0)\\,a \\;+\\; \\beta I_4\\,a^3 \\right)\\,\\delta a.\n$$\n因此，对于所有 $\\delta a$，驻点条件 $\\delta J_h(a;\\delta a)=0$ 等价于\n$$\n(\\varepsilon^2 I_2 - \\alpha I_0)\\,a \\;+\\; \\beta I_4\\,a^3 \\;=\\; 0.\n$$\n解是\n$$\na=0,\\quad\\text{或}\\quad a^2 \\;=\\; \\frac{\\alpha I_0 - \\varepsilon^2 I_2}{\\beta I_4}.\n$$\n因此，当且仅当\n$$\n\\alpha I_0 \\;>\\; \\varepsilon^2 I_2,\n$$\n时，存在非零驻点，此时，存在另外两个驻点 $a=\\pm a_\\star$，其中 $a_\\star = \\sqrt{(\\alpha I_0 - \\varepsilon^2 I_2)/(\\beta I_4)}$。\n\n一阶变分能揭示什么以及不能确定什么。一阶变分通过求解 $\\delta J_h(a;\\delta a)=0$ 来刻画驻点。然而，它并不能分类这些驻点的性质（极小值、极大值或鞍点）。要进行分类，必须考察二阶变分（在此标量情况下，即二阶导数）。\n\n二阶变分与分类。计算\n$$\nJ_h''(a) \\;=\\; \\frac{d}{da}\\left( (\\varepsilon^2 I_2 - \\alpha I_0)\\,a \\;+\\; \\beta I_4\\,a^3 \\right) \\;=\\; (\\varepsilon^2 I_2 - \\alpha I_0) \\;+\\; 3\\beta I_4\\,a^2.\n$$\n当 $\\alpha I_0>\\varepsilon^2 I_2$ 时，我们有 $J_h''(0)=\\varepsilon^2 I_2 - \\alpha I_0 < 0$，因此 $a=0$ 不是一个极小值点（在这个一维设定中，它是一个局部极大值点）。在 $a=\\pm a_\\star$ 处，其中 $a_\\star^2 = (\\alpha I_0 - \\varepsilon^2 I_2)/(\\beta I_4)$，我们得到\n$$\nJ_h''(\\pm a_\\star) \\;=\\; (\\varepsilon^2 I_2 - \\alpha I_0) \\;+\\; 3\\beta I_4\\,\\frac{\\alpha I_0 - \\varepsilon^2 I_2}{\\beta I_4} \\;=\\; -2(\\varepsilon^2 I_2 - \\alpha I_0) \\;>\\; 0,\n$$\n因此 $a=\\pm a_\\star$ 是局部极小值点。此外，由于 $c_4>0$，当 $|a|\\to\\infty$ 时，$J_h(a)\\to +\\infty$，且唯一的驻点是 $a=0$ 和 $a=\\pm a_\\star$，因此这些局部极小值点实际上是 $\\mathbb{R}$ 上的全局极小值点：\n$$\nJ_h(a) \\;=\\; c_2 a^2 + c_4 a^4,\\quad c_4>0,\\quad c_2<0 \\implies J_h(\\pm a_\\star) \\;=\\; -\\frac{c_2^2}{4c_4} \\;<\\; J_h(0) \\;=\\; 0,\n$$\n并且当 $|a|\\to\\infty$ 时，$J_h(a) \\to +\\infty$。\n\n逐项分析。\n\nA. 条件 $\\alpha I_0>\\varepsilon^2 I_2$ 正是存在三个驻点 $a=0$ 和 $a=\\pm a_\\star\\neq 0$ 的条件。关于仅凭一阶变分无法确定哪些是极小值点的陈述是正确的：求解 $\\delta J_h=0$ 只能定位驻点，而不能对其进行分类。结论：正确。\n\nB. 一阶变分在 $a=0$ 处为零这一事实仅表示 $a=0$ 是驻点；它并不意味着是极小值点。实际上，当 $\\alpha I_0>\\varepsilon^2 I_2$ 时，我们发现 $J_h''(0)<0$，所以 $a=0$ 不是一个极小值点。结论：错误。\n\nC. 一阶变分在全空间上导出欧拉-拉格朗日方程，但仅凭该方程不足以推断 $J$ 的非凸性。非凸性是泛函的一个性质（例如，二阶变分的符号或被积函数的凸性），而不是由一阶变分决定的。结论：错误。\n\nD. 这重申了二阶变分检验及其在非凸情形 $\\alpha I_0>\\varepsilon^2 I_2$ 下的含义：$J_h''(0)<0$ 排除了 $a=0$ 作为极小值点的可能性，而 $J_h''(\\pm a_\\star)>0$ 表明 $a=\\pm a_\\star$ 是局部极小值点。这使用了超越一阶变分的信息，是正确的。结论：正确。\n\nE. 如上所示，当 $\\alpha I_0>\\varepsilon^2 I_2$ 且 $c_4>0$ 时，非零驻点确实是 $J_h$ 在 $\\mathbb{R}$ 上的全局极小值点，但这个结论需要对 $J_h$ 进行分析（通过二阶变分和/或直接求值），而不仅仅是使用一阶变分。结论：正确。\n\n因此，正确选项是 A、D 和 E。这个例子说明了非凸性如何导致多个驻点，并且一阶变分可以识别它们，但本身无法判断其极小性或全局极小性；需要通过二阶变分或凸性论证进行进一步分析。在这个离散的例子中，在非凸情形下，两个非零驻点是全局离散极小值点。", "answer": "$$\\boxed{ADE}$$", "id": "2559350"}, {"introduction": "最后的这个练习将抽象理论与计算实践直接联系起来，这是任何有志于成为计算科学家的学生的关键一步。在这里，我们将以双重方式使用 Gâteaux 导数：能量泛函 $\\Pi(u)$ 的一阶变分导出了数值求解器中的“残差”向量，而残差的 Gâteaux 导数则给出了雅可比矩阵 [@problem_id:2559329]。通过“人造解”(Method of Manufactured Solutions)方法，您将亲手计算牛顿法这些基本组成部分，这模拟了科学计算软件开发中的一个关键验证步骤。", "problem": "考虑作为能量泛函的欧拉-拉格朗日方程得到的一维非线性边值问题\n$$\\Pi(u) \\;=\\; \\int_{0}^{1} \\left( \\tfrac{1}{2}\\,(u'(x))^{2} \\;+\\; \\tfrac{\\alpha}{4}\\,u(x)^{4} \\;-\\; f(x)\\,u(x) \\right)\\,dx,$$\n其中 $\\alpha>0$ 是一个给定的常数。在有限元法（FEM, Finite Element Method）中，牛顿法中使用的单元级残差和雅可比矩阵源于 $\\Pi$ 的一阶变分和 Gâteaux 导数。您的任务是从第一性原理出发推导这些对象，然后为一个构造解对它们进行求值，以便在单元级别上测试牛顿求解器。\n\n在单个单元 $e=[0,1]$ 上进行计算，使用由 $\\varphi_{1}(x)=1-x$ 和 $\\varphi_{2}(x)=x$ 定义的线性节点基 $\\{\\varphi_{1}(x),\\varphi_{2}(x)\\}$。设 $\\alpha=2$。使用构造解\n$$u_{m}(x)\\;=\\;1+2x,$$\n并定义源项 $f$，使得 $u_{m}$ 在 $[0,1]$ 上满足强形式的欧拉-拉格朗日方程，即 $-u_{m}''(x)+\\alpha\\,u_{m}(x)^{3}=f(x)$。设 $u_{h}$ 是 $u_{m}$ 在单元 $e$ 上的线性有限元插值，即 $u_{h}(x)=u_{1}\\,\\varphi_{1}(x)+u_{2}\\,\\varphi_{2}(x)$，其中 $u_{1}=u_{m}(0)$ 且 $u_{2}=u_{m}(1)$。\n\n任务：\n- 严格从一阶变分的定义 $\\delta\\Pi(u;v)=\\left.\\dfrac{d}{d\\varepsilon}\\Pi(u+\\varepsilon v)\\right|_{\\varepsilon=0}$ 出发，推导单元 $e$ 上的单元级残差算子 $R(u_{h})[v_{h}]$。\n- 严格从残差的 Gâteaux 导数定义 $J(u_{h})[\\delta u_{h},v_{h}]=\\left.\\dfrac{d}{d\\varepsilon}R(u_{h}+\\varepsilon\\,\\delta u_{h})[v_{h}]\\right|_{\\varepsilon=0}$ 出发，推导单元 $e$ 上的单元级雅可比双线性形式。\n- 当 $\\alpha=2$ 且 $u_{m}(x)=1+2x$ 时，构建 $f(x)$，然后精确计算（无求积误差）单元残差向量 $\\boldsymbol{r}_{e}=\\big(R(u_{h})[\\varphi_{1}],\\,R(u_{h})[\\varphi_{2}]\\big)$ 和单元雅可比矩阵 $\\boldsymbol{K}_{e}=\\big(J(u_{h})[\\varphi_{j},\\varphi_{i}]\\big)_{i,j=1}^{2}$。\n- 最后，对于特定的选择 $\\psi_{h}=\\varphi_{1}+2\\,\\varphi_{2}$ 和 $\\delta u_{h}=3\\,\\varphi_{1}-\\varphi_{2}$，计算单个标量\n$$S \\;=\\; R(u_{h})[\\psi_{h}] \\;+\\; J(u_{h})[\\delta u_{h},\\psi_{h}],$$\n\n将 $S$ 的最终答案表示为一个精确的有理数。不要四舍五入。", "solution": "我们从定义开始。能量泛函 $\\Pi$ 在 $u$ 处沿方向 $v$ 的一阶变分是\n$$\\delta\\Pi(u;v)\\;=\\;\\left.\\dfrac{d}{d\\varepsilon}\\,\\Pi(u+\\varepsilon v)\\right|_{\\varepsilon=0}。$$\n对于\n$$\\Pi(u)\\;=\\;\\int_{0}^{1}\\left(\\tfrac{1}{2}(u')^{2}+\\tfrac{\\alpha}{4}u^{4}-f\\,u\\right)\\,dx,$$\n我们计算\n$$\\Pi(u+\\varepsilon v)\\;=\\;\\int_{0}^{1}\\left(\\tfrac{1}{2}(u'+\\varepsilon v')^{2}+\\tfrac{\\alpha}{4}(u+\\varepsilon v)^{4}-f\\,(u+\\varepsilon v)\\right)\\,dx。$$\n对 $\\varepsilon$ 求导并在 $\\varepsilon=0$ 处求值，得到\n$$\\delta\\Pi(u;v)\\;=\\;\\int_{0}^{1}\\left(u'\\,v'\\;+\\;\\alpha\\,u^{3}\\,v\\;-\\;f\\,v\\right)\\,dx。$$\n因此，对于支集在单元 $e=[0,1]$ 上的有限元函数 $u_{h}$ 和测试函数 $v_{h}$，单元残差算子是\n$$R(u_{h})[v_{h}]\\;=\\;\\int_{0}^{1}\\left(u_{h}'\\,v_{h}'\\;+\\;\\alpha\\,u_{h}^{3}\\,v_{h}\\;-\\;f\\,v_{h}\\right)\\,dx。$$\n\n接下来，残差在 $u_{h}$ 处沿方向 $\\delta u_{h}$ 作用于 $v_{h}$ 的 Gâteaux 导数是\n$$J(u_{h})[\\delta u_{h},v_{h}]\\;=\\;\\left.\\dfrac{d}{d\\varepsilon}\\,R(u_{h}+\\varepsilon\\,\\delta u_{h})[v_{h}]\\right|_{\\varepsilon=0}。$$\n我们将 $u_{h}+\\varepsilon\\,\\delta u_{h}$ 代入 $R$ 中：\n$$R(u_{h}+\\varepsilon\\,\\delta u_{h})[v_{h}]\\;=\\;\\int_{0}^{1}\\left((u_{h}'+\\varepsilon\\,\\delta u_{h}')\\,v_{h}'\\;+\\;\\alpha\\,(u_{h}+\\varepsilon\\,\\delta u_{h})^{3}\\,v_{h}\\;-\\;f\\,v_{h}\\right)\\,dx。$$\n在 $\\varepsilon=0$ 处求导，得出\n$$J(u_{h})[\\delta u_{h},v_{h}]\\;=\\;\\int_{0}^{1}\\left(\\delta u_{h}'\\,v_{h}'\\;+\\;3\\,\\alpha\\,u_{h}^{2}\\,\\delta u_{h}\\,v_{h}\\right)\\,dx。$$\n\n现在，特化到 $\\alpha=2$ 和构造解 $u_{m}(x)=1+2x$。选择相应的载荷 $f$ 以满足在 $[0,1]$ 上的强形式方程 $-u_{m}''+\\alpha\\,u_{m}^{3}=f$。由于 $u_{m}''(x)=0$，可得\n$$f(x)\\;=\\;\\alpha\\,u_{m}(x)^{3}\\;=\\;2\\,(1+2x)^{3}。$$\n设 $u_{h}$ 为 $u_{m}$ 在单元 $e=[0,1]$ 上的线性插值， $u_{h}(x)=u_{1}\\,\\varphi_{1}(x)+u_{2}\\,\\varphi_{2}(x)$，其中 $u_{1}=u_{m}(0)=1$ 且 $u_{2}=u_{m}(1)=3$。由于 $u_{m}$ 是线性的，因此在 $[0,1]$ 上 $u_{h}=u_{m}$ 逐点成立，所以 $u_{h}'(x)=2$ 且 $u_{h}(x)^{3}=(1+2x)^{3}$。\n\n单元残差向量。使用基函数作为测试函数 $v_{h}=\\varphi_{i}$，$i\\in\\{1,2\\}$，\n$$r_{i}\\;=\\;R(u_{h})[\\varphi_{i}]\\;=\\;\\int_{0}^{1}\\left(u_{h}'\\,\\varphi_{i}'\\;+\\;\\alpha\\,u_{h}^{3}\\,\\varphi_{i}\\;-\\;f\\,\\varphi_{i}\\right)\\,dx。$$\n由于 $f=\\alpha\\,u_{h}^{3}$，非导数项相互抵消，剩下\n$$r_{i}\\;=\\;\\int_{0}^{1}u_{h}'\\,\\varphi_{i}'\\,dx\\;=\\;\\int_{0}^{1}2\\,\\varphi_{i}'\\,dx。$$\n由于 $\\varphi_{1}(x)=1-x$ 且 $\\varphi_{2}(x)=x$，我们有 $\\varphi_{1}'(x)=-1$ 且 $\\varphi_{2}'(x)=1$。因此\n$$r_{1}\\;=\\;\\int_{0}^{1}2\\,(-1)\\,dx\\;=\\;-2,\\qquad r_{2}\\;=\\;\\int_{0}^{1}2\\,(1)\\,dx\\;=\\;2。$$\n因此 $\\boldsymbol{r}_{e}=(-2,\\,2)$。\n\n单元雅可比矩阵。其各项为\n$$a_{ij}\\;=\\;J(u_{h})[\\varphi_{j},\\varphi_{i}]\\;=\\;\\int_{0}^{1}\\left(\\varphi_{j}'\\,\\varphi_{i}'\\;+\\;3\\,\\alpha\\,u_{h}^{2}\\,\\varphi_{j}\\,\\varphi_{i}\\right)\\,dx。$$\n当 $\\alpha=2$ 且 $u_{h}(x)=1+2x$ 时，我们有 $3\\,\\alpha=6$ 且 $u_{h}(x)^{2}=(1+2x)^{2}=1+4x+4x^{2}$。定义梯度部分\n$$k^{(0)}_{ij}=\\int_{0}^{1}\\varphi_{j}'\\,\\varphi_{i}'\\,dx,$$\n和非线性质量类部分\n$$m_{ij}=\\int_{0}^{1}6\\,u_{h}^{2}\\,\\varphi_{j}\\,\\varphi_{i}\\,dx。$$\n在 $[0,1]$ 上使用线性基函数时，梯度部分的贡献为\n$$k^{(0)}_{11}=\\int_{0}^{1}(-1)(-1)\\,dx=1,\\quad k^{(0)}_{12}=\\int_{0}^{1}(1)(-1)\\,dx=-1,$$\n$$k^{(0)}_{21}=\\int_{0}^{1}(-1)(1)\\,dx=-1,\\quad k^{(0)}_{22}=\\int_{0}^{1}(1)(1)\\,dx=1。$$\n对于非线性部分，写出 $\\varphi_{1}\\varphi_{1}=(1-x)^{2}=1-2x+x^{2}$，$\\varphi_{1}\\varphi_{2}=(1-x)x=x-x^{2}$ 以及 $\\varphi_{2}\\varphi_{2}=x^{2}$。当 $u_{h}^{2}=1+4x+4x^{2}$ 时，\n\n$$\n\\begin{aligned}\nI_{11}&=\\int_{0}^{1}(1+4x+4x^{2})(1-2x+x^{2})\\,dx=\\int_{0}^{1}\\big(1+2x-3x^{2}-4x^{3}+4x^{4}\\big)\\,dx=\\tfrac{4}{5},\\\\\nI_{12}&=\\int_{0}^{1}(1+4x+4x^{2})(x-x^{2})\\,dx=\\int_{0}^{1}\\big(x+3x^{2}-4x^{4}\\big)\\,dx=\\tfrac{7}{10},\\\\\nI_{22}&=\\int_{0}^{1}(1+4x+4x^{2})x^{2}\\,dx=\\int_{0}^{1}\\big(x^{2}+4x^{3}+4x^{4}\\big)\\,dx=\\tfrac{32}{15}.\n\\end{aligned}\n$$\n\n乘以 $6$ 得到\n$$m_{11}=6\\,I_{11}=\\tfrac{24}{5},\\quad m_{12}=6\\,I_{12}=\\tfrac{21}{5},\\quad m_{22}=6\\,I_{22}=\\tfrac{64}{5},$$\n且 $m_{21}=m_{12}$。因此，\n\n$$\n\\boldsymbol{K}_{e}=\\big[a_{ij}\\big]=\\big[k^{(0)}_{ij}+m_{ij}\\big]\n=\\begin{pmatrix}\n1+\\tfrac{24}{5} & -1+\\tfrac{21}{5}\\\n$$4pt]\n-1+\\tfrac{21}{5} & 1+\\tfrac{64}{5}\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\tfrac{29}{5} & \\tfrac{16}{5}\\\n$$4pt]\n\\tfrac{16}{5} & \\tfrac{69}{5}\n\\end{pmatrix}.\n$$\n\n\n标量 $S$。设 $\\psi_{h}=\\varphi_{1}+2\\,\\varphi_{2}$ 且 $\\delta u_{h}=3\\,\\varphi_{1}-\\varphi_{2}$。以节点向量形式，记 $\\boldsymbol{w}=(1,\\,2)$ 和 $\\boldsymbol{d}=(3,\\,-1)$。则\n$$R(u_{h})[\\psi_{h}]=\\boldsymbol{r}_{e}\\cdot\\boldsymbol{w}=(-2,\\,2)\\cdot(1,\\,2)=-2+4=2。$$\n另外，\n$$J(u_{h})[\\delta u_{h},\\psi_{h}]=\\boldsymbol{d}^{\\top}\\,\\boldsymbol{K}_{e}\\,\\boldsymbol{w}。$$\n计算\n\n$$\n\\boldsymbol{K}_{e}\\,\\boldsymbol{w}\n=\n\\begin{pmatrix}\n\\tfrac{29}{5} & \\tfrac{16}{5}\\\n$$2pt]\n\\tfrac{16}{5} & \\tfrac{69}{5}\n\\end{pmatrix}\n\\begin{pmatrix}1\\\n$$2pt]2\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\tfrac{29}{5}+2\\,\\tfrac{16}{5}\\\n$$2pt]\n\\tfrac{16}{5}+2\\,\\tfrac{69}{5}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\tfrac{61}{5}\\\n$$2pt]\n\\tfrac{154}{5}\n\\end{pmatrix},\n$$\n\n因此\n$$\\boldsymbol{d}^{\\top}(\\boldsymbol{K}_{e}\\,\\boldsymbol{w})=3\\,\\tfrac{61}{5}-1\\cdot\\tfrac{154}{5}=\\tfrac{183}{5}-\\tfrac{154}{5}=\\tfrac{29}{5}。$$\n所以，\n$$S=R(u_{h})[\\psi_{h}]+J(u_{h})[\\delta u_{h},\\psi_{h}]=2+\\tfrac{29}{5}=\\tfrac{39}{5}。$$\n\n这个精确的有理数值同时检验了与非线性泛函的一阶变分和 Gâteaux 导数相一致的残差和雅可比矩阵。", "answer": "$$\\boxed{\\tfrac{39}{5}}$$", "id": "2559329"}]}