{"hands_on_practices": [{"introduction": "在有限元分析中，精确施加非齐次狄利克雷边界条件是一项基本功。提离法 (lifting strategy) 作为一种强大而简洁的技术，能够将原问题转化为具有齐次边界条件的形式，从而简化代数方程组的求解。本练习将引导你通过具体的推导和计算，亲手实践这一核心技巧，加深对非齐次本质边界条件处理方式的理解。[@problem_id:2543141]", "problem": "考虑由偏微分方程（PDE）控制的标量扩散模型问题\n$$-\\,\\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right)=f \\quad \\text{in } \\Omega=(0,1),$$\n其混合边界条件为\n$$u=g_{D}\\ \\text{on}\\ \\Gamma_{D}=\\{0\\}, \\qquad k\\,\\frac{du}{dx}=g_{N}\\ \\text{on}\\ \\Gamma_{N}=\\{1\\}.$$\n使用伽辽金有限元法（FEM），其试探空间和检验空间由在节点为 $x=0$ 和 $x=1$ 的单个单元网格上的连续分片线性函数构成。设离散的基本边界条件通过提升策略来施加：选择一个离散提升函数 $u_{L}$，使得 $u_{L}(0)=g_{D}$ 且 $u_{L}(1)=0$，并写作 $u_{h}=w_{h}+u_{L}$，其中 $w_{h}$ 在 $\\Gamma_{D}$ 上为零。从分部积分和双线性、线性形式的基本定义得到的变分陈述出发，推导 $u_{L}$ 的存在如何修正 $w_{h}$ 的简化离散系统的右端项。\n\n然后将您的推导应用于具体数据\n$$k=3,\\qquad f(x)=4,\\qquad g_{N}=5,\\qquad g_{D}=2,$$\n在具有标准节点基 $\\{N_{1},N_{2}\\}$ 的单单元网格上，其中 $N_{1}(x)=1-x$ 且 $N_{2}(x)=x$。选择提升函数为 $u_{L}(x)=g_{D}\\,N_{1}(x)$。使用唯一的自由基函数 $N_{2}$ 作为检验函数，计算与 $w_{h}$ 相关的简化单自由度系统的标量修正右端项。\n\n将您的最终答案表示为单个实数。无需四舍五入。", "solution": "该问题要求推导在使用提升策略处理非齐次狄利克雷边界条件时，有限元法（FEM）系统右端项的修正形式，然后针对一个具体案例计算此修正项。\n\n控制偏微分方程（PDE），即问题的强形式为：\n$$-\\frac{d}{dx}\\left(k\\,\\frac{du}{dx}\\right) = f \\quad \\text{for } x \\in \\Omega = (0,1)$$\n其混合边界条件为：\n$$u(0) = g_{D} \\quad (\\text{本质/狄利克雷})$$\n$$k\\,\\frac{du}{dx}(1) = g_{N} \\quad (\\text{自然/诺伊曼})$$\n为了推导变分（或弱）形式，我们将偏微分方程乘以一个来自合适的检验函数空间 $V$ 的检验函数 $v$，并在域 $\\Omega$ 上积分：\n$$-\\int_{0}^{1} v\\,\\frac{d}{dx}\\left(k\\,\\frac{du}{dx}\\right) dx = \\int_{0}^{1} v f dx$$\n对左端项应用分部积分得到：\n$$\\int_{0}^{1} \\frac{dv}{dx} k \\frac{du}{dx} dx - \\left[v k \\frac{du}{dx}\\right]_{0}^{1} = \\int_{0}^{1} v f dx$$\n选择检验函数空间 $V$，使其成员在指定了本质边界条件的位置上为零。在本例中，$v(0)=0$。边界项的计算结果为：\n$$\\left[v k \\frac{du}{dx}\\right]_{0}^{1} = v(1) k \\frac{du}{dx}(1) - v(0) k \\frac{du}{dx}(0) = v(1) g_{N} - 0 = v(1) g_{N}$$\n将其代回，变分问题即为：寻找 $u$，使得 $u(0)=g_D$ 成立，并且对于所有满足 $v(0)=0$ 的检验函数 $v$，下式成立：\n$$\\int_{0}^{1} k \\frac{du}{dx} \\frac{dv}{dx} dx = \\int_{0}^{1} v f dx + v(1) g_{N}$$\n这通常以抽象形式写作 $a(u, v) = l(v)$，其中 $a(u,v)$ 是双线性形式，$l(v)$ 是线性泛函。\n\n在伽辽金有限元法中，我们在有限维试探空间 $S_h$ 中寻找近似解 $u_h$，并用来自有限维检验空间 $V_h$ 的函数 $v_h$ 进行检验。对于本问题，两个空间都由连续分片线性函数构成。本质边界条件 $u(0)=g_D$ 通过提升策略来施加。我们将离散解 $u_h$ 分解为：\n$$u_h = w_h + u_L$$\n这里，$u_L$ 是一个已知的提升函数，它满足非齐次的本质边界条件，$u_L(0) = g_D$。函数 $w_h$ 是解的未知部分，属于离散检验空间 $V_h$，该空间由在狄利克雷边界 $\\Gamma_D$ 上为零的函数组成。因此，$w_h(0)=0$。\n\n将分解式 $u_h = w_h + u_L$ 代入变分形式，并使用离散检验函数 $v_h \\in V_h$：\n$$\\int_{0}^{1} k \\frac{d(w_h + u_L)}{dx} \\frac{dv_h}{dx} dx = \\int_{0}^{1} v_h f dx + v_h(1) g_{N}$$\n利用导数和积分的线性性质，我们将左端的项分开：\n$$\\int_{0}^{1} k \\frac{dw_h}{dx} \\frac{dv_h}{dx} dx + \\int_{0}^{1} k \\frac{du_L}{dx} \\frac{dv_h}{dx} dx = \\int_{0}^{1} v_h f dx + v_h(1) g_{N}$$\n对于未知函数 $w_h \\in V_h$ 的问题是，找到它使得对于所有 $v_h \\in V_h$：\n$$\\int_{0}^{1} k \\frac{dw_h}{dx} \\frac{dv_h}{dx} dx = \\int_{0}^{1} v_h f dx + v_h(1) g_{N} - \\int_{0}^{1} k \\frac{du_L}{dx} \\frac{dv_h}{dx} dx$$\n该方程的形式为 $a(w_h, v_h) = l_{mod}(v_h)$。双线性形式 $a(w_h, v_h)$ 构成了左端项（刚度矩阵），而修正后的线性泛函 $l_{mod}(v_h)$ 构成了右端项（载荷向量）。提升函数 $u_L$ 的存在通过引入项 $-\\int_{0}^{1} k \\frac{du_L}{dx} \\frac{dv_h}{dx} dx$ 修正了原始的右端项。这完成了问题的推导部分。\n\n现在，我们将其应用于给定数据：\n- 常数：$k=3$，$f(x)=4$，$g_{N}=5$，$g_{D}=2$。\n- 网格：在 $\\Omega=(0,1)$ 上的单个单元，节点位于 $x=0$ 和 $x=1$。\n- 节点基函数：$N_1(x) = 1-x$ 和 $N_2(x) = x$。\n- 它们的导数为：$\\frac{dN_1}{dx} = -1$ 和 $\\frac{dN_2}{dx} = 1$。\n- 提升函数：$u_L(x) = g_D N_1(x) = 2(1-x)$。\n- 提升函数的导数为：$\\frac{du_L}{dx} = 2 \\frac{dN_1}{dx} = 2(-1) = -2$。\n\n未知函数 $w_h$ 必须在 $x=0$ 处为零，因此它必须是 $N_2(x)$ 的倍数。$w_h$ 的试探空间是 $V_h = \\text{span}\\{N_2\\}$。$w_h$ 的简化系统只有一个自由度。为了找到右端向量中的相应项，我们必须使用该自由度的基函数 $N_2(x)$ 作为检验函数，即 $v_h = N_2(x)$。\n\n修正后的右端项为 $l_{mod}(N_2)$：\n$$l_{mod}(N_2) = \\int_{0}^{1} N_2(x) f(x) dx + N_2(1) g_{N} - \\int_{0}^{1} k \\frac{du_L}{dx} \\frac{d N_2}{dx} dx$$\n我们分别计算每一项：\n1. 来自源项 $f(x)$ 的贡献：\n$$\\int_{0}^{1} N_2(x) f(x) dx = \\int_{0}^{1} x \\cdot 4 dx = 4 \\left[ \\frac{x^2}{2} \\right]_{0}^{1} = 4 \\left( \\frac{1^2}{2} - 0 \\right) = 2$$\n2. 来自诺伊曼边界条件 $g_N$ 的贡献：\n$$N_2(1) g_{N} = 1 \\cdot 5 = 5$$\n3. 来自提升函数 $u_L$ 的贡献：\n$$- \\int_{0}^{1} k \\frac{du_L}{dx} \\frac{d N_2}{dx} dx = - \\int_{0}^{1} 3 \\cdot (-2) \\cdot (1) dx = - \\int_{0}^{1} (-6) dx = 6 \\int_{0}^{1} dx = 6[x]_0^1 = 6$$\n\n将这些贡献相加，得到修正后右端项的总值：\n$$l_{mod}(N_2) = 2 + 5 + 6 = 13$$\n这是与 $w_h$ 相关的简化单自由度系统右端项的单个标量值。", "answer": "$$\\boxed{13}$$", "id": "2543141"}, {"introduction": "从静态问题过渡到动态问题（如波动方程），空间离散化后会得到一个关于时间的常微分方程组 (ODEs)。本练习将探讨动态分析中的质量矩阵，特别是“一致质量矩阵” ($M_c$) 与“集总质量矩阵” ($M_l$) 之间的选择。你将通过分析发现，这个在空间离散化中的选择如何深刻地影响显式时间积分格式的稳定性，从而揭示时空离散化之间的内在联系。[@problem_id:2543157]", "problem": "考虑区间 $0 \\le x \\le 1$ 上的一维波动偏微分方程 (PDE)，\n$$u_{tt}(x,t) = u_{xx}(x,t),$$\n其具有齐次狄利克雷边界条件 $u(0,t)=0$ 和 $u(1,t)=0$，且初始数据足够光滑，以至于可以应用标准的半离散分析。使用有限元法 (FEM)，其空间离散化基于伽辽金法，采用在由三个等长单元（四个等距节点）组成的均匀网格上的连续分段线性基函数。取单位质量密度和单位波速，因此不会出现额外的物理参数。\n\n从弱形式和伽辽金构造出发，完成以下任务：\n1) 使用标准的线性形函数，推导长度为 $h$ 的单个单元的单元级一致质量矩阵和单元级刚度矩阵。然后，为此网格组装施加了狄利克雷边界条件的内部全局刚度矩阵 $K$ 和内部全局一致质量矩阵 $M_{\\mathrm{c}}$。\n2) 通过对组装好的一致质量矩阵应用标准的行求和集中法来定义集中质量矩阵。为此网格构建内部全局集中质量矩阵 $M_{\\mathrm{l}}$。\n3) 对于两个半离散系统 $M_{\\mathrm{c}} \\ddot{\\boldsymbol{u}} + K \\boldsymbol{u}=\\boldsymbol{0}$ 和 $M_{\\mathrm{l}} \\ddot{\\boldsymbol{u}} + K \\boldsymbol{u}=\\boldsymbol{0}$，通过广义特征值问题 $K \\boldsymbol{\\phi} = \\lambda M \\boldsymbol{\\phi}$ 来刻画其模态动力学，并确定每种情况下的最大广义特征值 $\\lambda_{\\max}$。\n4) 使用应用于标量振子 $\\ddot{y} + \\omega^{2} y = 0$ 的显式中心差分时间积分器的线性稳定性要求，为每个半离散模型确定以 $\\lambda_{\\max}$ 表示的最大稳定时间步长 $\\Delta t_{\\max}$，并计算比率\n$$r \\equiv \\frac{\\Delta t_{\\max}(M_{\\mathrm{l}})}{\\Delta t_{\\max}(M_{\\mathrm{c}})}.$$\n\n将 $r$ 的最终结果以最简根式的单个精确表达式给出。不要提供中间值。$r$ 不需要单位。", "solution": "所述问题具有科学依据，是适定的，并包含了唯一解所需的所有信息。它代表了使用有限元法对偏微分方程进行计算分析的一个标准练习。我们开始解题。\n\n该问题需要对一个半离散化的一维波动方程 $u_{tt} = u_{xx}$ 进行多步分析。\n\n1.  单元矩阵的推导\n偏微分方程 $u_{tt} - u_{xx} = 0$ 的弱形式，是通过乘以一个来自函数空间 $H_0^1([0,1])$ 的检验函数 $v(x)$ 并在定义域 $\\Omega = [0,1]$ 上积分得到的。对空间导数项进行分部积分后，我们有：\n$$ \\int_{0}^{1} v u_{tt} \\,dx + \\int_{0}^{1} v_x u_x \\,dx = 0 $$\n对于长度为 $h$ 的一个通用单元，我们引入线性形函数 $N_1(\\xi) = 1 - \\xi/h$ 和 $N_2(\\xi) = \\xi/h$，其中 $\\xi \\in [0,h]$。单元一致质量矩阵 $M^e$ 和刚度矩阵 $K^e$ 分别由这些形函数及其导数的乘积的积分给出。\n\n单元一致质量矩阵的分量 $M^e_{ij} = \\int_0^h N_i(\\xi) N_j(\\xi) \\,d\\xi$ 为：\n$M^e_{11} = \\int_0^h (1-\\frac{\\xi}{h})^2 \\,d\\xi = \\frac{h}{3}$\n$M^e_{12} = M^e_{21} = \\int_0^h (1-\\frac{\\xi}{h})(\\frac{\\xi}{h}) \\,d\\xi = \\frac{h}{6}$\n$M^e_{22} = \\int_0^h (\\frac{\\xi}{h})^2 \\,d\\xi = \\frac{h}{3}$\n由此组装成单元一致质量矩阵：\n$$ M^e = \\frac{h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} $$\n单元刚度矩阵的分量 $K^e_{ij} = \\int_0^h N'_i(\\xi) N'_j(\\xi) \\,d\\xi$（其中导数为 $N'_1(\\xi)=-1/h$ 和 $N'_2(\\xi)=1/h$）为：\n$K^e_{11} = \\int_0^h (-\\frac{1}{h})(-\\frac{1}{h}) \\,d\\xi = \\frac{1}{h}$\n$K^e_{12} = K^e_{21} = \\int_0^h (-\\frac{1}{h})(\\frac{1}{h}) \\,d\\xi = -\\frac{1}{h}$\n$K^e_{22} = \\int_0^h (\\frac{1}{h})(\\frac{1}{h}) \\,d\\xi = \\frac{1}{h}$\n由此组装成单元刚度矩阵：\n$$ K^e = \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\n\n2.  全局内部矩阵的组装\n定义域 $[0,1]$ 被划分为 $3$ 个等长单元，因此单元长度为 $h=1/3$。在 $x=0, x=1/3, x=2/3, x=1$ 处有 $4$ 个节点。齐次狄利克雷边界条件 $u(0,t)=0$ 和 $u(1,t)=0$ 意味着外部节点（$x=0$ 和 $x=1$）的自由度为零。我们只考虑 $2$ 个内部节点。这些内部自由度的全局矩阵是 $2 \\times 2$ 的。\n\n组装来自 $3$ 个单元的贡献，完整的全局刚度矩阵将是：\n$$ K_{\\mathrm{full}} = \\frac{1}{h} \\begin{pmatrix} 1 & -1 & 0 & 0 \\\\ -1 & 1+1 & -1 & 0 \\\\ 0 & -1 & 1+1 & -1 \\\\ 0 & 0 & -1 & 1 \\end{pmatrix} = \\frac{1}{h} \\begin{pmatrix} 1 & -1 & 0 & 0 \\\\ -1 & 2 & -1 & 0 \\\\ 0 & -1 & 2 & -1 \\\\ 0 & 0 & -1 & 1 \\end{pmatrix} $$\n完整的全局一致质量矩阵是：\n$$ M_{\\mathrm{c,full}} = \\frac{h}{6} \\begin{pmatrix} 2 & 1 & 0 & 0 \\\\ 1 & 2+2 & 1 & 0 \\\\ 0 & 1 & 2+2 & 1 \\\\ 0 & 0 & 1 & 2 \\end{pmatrix} = \\frac{h}{6} \\begin{pmatrix} 2 & 1 & 0 & 0 \\\\ 1 & 4 & 1 & 0 \\\\ 0 & 1 & 4 & 1 \\\\ 0 & 0 & 1 & 2 \\end{pmatrix} $$\n应用狄利克雷边界条件对应于提取内部节点（第 $2$ 和第 $3$ 行及列）的子矩阵。\n内部全局刚度矩阵 $K$ 是：\n$$ K = \\frac{1}{h} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} $$\n内部全局一致质量矩阵 $M_{\\mathrm{c}}$ 是：\n$$ M_{\\mathrm{c}} = \\frac{h}{6} \\begin{pmatrix} 4 & 1 \\\\ 1 & 4 \\end{pmatrix} $$\n\n3.  集中质量矩阵的构造\n集中质量矩阵 $M_{\\mathrm{l}}$ 通过在单元级别进行集中然后组装得到。对于长度为 $h$ 的单元，其一致质量矩阵 $M^e$ 的行和为 $[h/2, h/2]$，因此单元级集中质量矩阵为 $\\mathrm{diag}(h/2, h/2)$。组装三个这样的单元后，内部节点（节点2和3）的质量为 $h/2 + h/2 = h$。因此，内部全局集中质量矩阵为：\n$$ M_{\\mathrm{l}} = h \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = h I $$\n\n4.  广义特征值问题\n我们必须为每个系统 $K \\boldsymbol{\\phi} = \\lambda M \\boldsymbol{\\phi}$ 找到最大的广义特征值 $\\lambda_{\\max}$。\n\n对于一致质量矩阵 $M_{\\mathrm{c}}$：\n$$ \\frac{1}{h} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} \\boldsymbol{\\phi} = \\lambda_{\\mathrm{c}} \\frac{h}{6} \\begin{pmatrix} 4 & 1 \\\\ 1 & 4 \\end{pmatrix} \\boldsymbol{\\phi} $$\n我们求解 $\\det(K - \\lambda_{\\mathrm{c}} M_{\\mathrm{c}}) = 0$：\n$$ \\det \\left( \\frac{1}{h} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} - \\lambda_{\\mathrm{c}} \\frac{h}{6} \\begin{pmatrix} 4 & 1 \\\\ 1 & 4 \\end{pmatrix} \\right) = 0 $$\n$$ \\left( \\frac{2}{h} - \\frac{4h\\lambda_{\\mathrm{c}}}{6} \\right)^2 - \\left( -\\frac{1}{h} - \\frac{h\\lambda_{\\mathrm{c}}}{6} \\right)^2 = 0 $$\n这产生两个方程：\n$\\frac{2}{h} - \\frac{2h\\lambda_{\\mathrm{c}}}{3} = \\frac{1}{h} + \\frac{h\\lambda_{\\mathrm{c}}}{6} \\implies \\frac{1}{h} = \\frac{5h\\lambda_{\\mathrm{c}}}{6} \\implies \\lambda_{\\mathrm{c}} = \\frac{6}{5h^2}$\n$\\frac{2}{h} - \\frac{2h\\lambda_{\\mathrm{c}}}{3} = -(\\frac{1}{h} + \\frac{h\\lambda_{\\mathrm{c}}}{6}) \\implies \\frac{3}{h} = \\frac{3h\\lambda_{\\mathrm{c}}}{6} \\implies \\lambda_{\\mathrm{c}} = \\frac{6}{h^2}$\n最大特征值为 $\\lambda_{\\max}(M_{\\mathrm{c}}) = \\frac{6}{h^2}$。\n\n对于集中质量矩阵 $M_{\\mathrm{l}}$：\n$$ \\frac{1}{h} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} \\boldsymbol{\\phi} = \\lambda_{\\mathrm{l}} h \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} \\boldsymbol{\\phi} $$\n这是一个关于矩阵 $\\frac{1}{h^2}\\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}$ 的标准特征值问题。矩阵 $\\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}$ 的特征值由 $(2-\\mu)^2-1 = 0$ 求得，给出 $\\mu=1$ 和 $\\mu=3$。\n因此，特征值 $\\lambda_{\\mathrm{l}}$ 为 $\\frac{1}{h^2}$ 和 $\\frac{3}{h^2}$。\n最大特征值为 $\\lambda_{\\max}(M_{\\mathrm{l}}) = \\frac{3}{h^2}$。\n\n5.  稳定性分析与比率\n应用于谐振子 $\\ddot{y} + \\omega^2 y = 0$ 的显式中心差分时间积分方案在 $\\omega \\Delta t \\le 2$ 时是稳定的。对于一个振子系统，稳定性由最高频率 $\\omega_{\\max} = \\sqrt{\\lambda_{\\max}}$ 决定。\n因此，最大稳定时间步长为 $\\Delta t_{\\max} = \\frac{2}{\\omega_{\\max}} = \\frac{2}{\\sqrt{\\lambda_{\\max}}}$。\n\n对于一致质量矩阵系统：\n$$ \\Delta t_{\\max}(M_{\\mathrm{c}}) = \\frac{2}{\\sqrt{\\lambda_{\\max}(M_{\\mathrm{c}})}} = \\frac{2}{\\sqrt{6/h^2}} = \\frac{2h}{\\sqrt{6}} $$\n对于集中质量矩阵系统：\n$$ \\Delta t_{\\max}(M_{\\mathrm{l}}) = \\frac{2}{\\sqrt{\\lambda_{\\max}(M_{\\mathrm{l}})}} = \\frac{2}{\\sqrt{3/h^2}} = \\frac{2h}{\\sqrt{3}} $$\n比率 $r$ 为：\n$$ r = \\frac{\\Delta t_{\\max}(M_{\\mathrm{l}})}{\\Delta t_{\\max}(M_{\\mathrm{c}})} = \\frac{2h/\\sqrt{3}}{2h/\\sqrt{6}} = \\frac{\\sqrt{6}}{\\sqrt{3}} = \\sqrt{\\frac{6}{3}} = \\sqrt{2} $$\n结果与单元尺寸 $h$ 无关。", "answer": "$$\\boxed{\\sqrt{2}}$$", "id": "2543157"}, {"introduction": "除了标准的连续Galerkin方法，间断Galerkin (Discontinuous Galerkin, DG) 方法为处理复杂物理或网格问题提供了更大的灵活性。本练习将带领你从第一性原理出发，推导对称内部罚分 (Symmetric Interior Penalty, SIPG) DG格式的完整弱形式。你将接触到DG方法的核心概念，如内部“跳跃”([•])和“平均”({•})算子，以及用以保证稳定性和一致性的数值通量和罚函数。[@problem_id:2543104]", "problem": "考虑在有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{d}$ 上的标量扩散问题，其边界 $\\partial\\Omega = \\overline{\\Gamma_{D}} \\cup \\overline{\\Gamma_{N}}$ 为分片光滑，其中 $\\Gamma_{D}$ 和 $\\Gamma_{N}$ 不相交。其控制偏微分方程为\n$$\n-\\nabla \\cdot \\big(k \\nabla u \\big) = f \\quad \\text{in } \\Omega,\n$$\n带有 Dirichlet 数据 $u = g_{D}$ on $\\Gamma_{D}$ 和 Neumann 数据 $k \\nabla u \\cdot n = g_{N}$ on $\\Gamma_{N}$。系数 $k$ 在 $\\Omega$ 的一个由单纯形构成的形状正则网格 $\\mathcal{T}_{h}$ 上是严格为正且分片常数的。设 $\\mathcal{F}_{i}$表示所有内部面的集合，$\\mathcal{F}_{D}$ 和 $\\mathcal{F}_{N}$ 分别表示 $\\Gamma_{D}$ 和 $\\Gamma_{N}$ 上的面集合。设 $V_{h}$ 是在 $\\mathcal{T}_{h}$ 上的间断 Galerkin (DG) 有限元空间，由总次数至多为 $p \\in \\mathbb{N}$ 的分片多项式构成，且没有单元间的连续性约束。\n\n仅从强形式、散度定理以及对每个单元 $K \\in \\mathcal{T}_{h}$ 的边界 $\\partial K$ 上的迹的定义出发，推导此边值问题的对称内部罚间断 Galerkin (DG) 弱形式。在你的推导中，如下引入标准的内部面跳跃和平均算子。在一个内部面 $F = \\partial K^{-} \\cap \\partial K^{+} \\in \\mathcal{F}_{i}$上，设一固定的单位法向量 $n^{-}$ 指向 $K^{-}$ 的外部（因此 $n^{+} = - n^{-}$），对任意标量迹 $w^{\\pm}$ 和向量迹 $q^{\\pm}$ 定义\n$$\n[w] := w^{-} - w^{+}, \n\\qquad\n\\{q\\} := \\frac{1}{2}\\big(q^{-} + q^{+}\\big),\n\\qquad\n\\{q \\cdot n\\} := \\frac{1}{2}\\big(q^{-} \\cdot n^{-} + q^{+} \\cdot n^{+}\\big).\n$$\n在边界 $F \\subset \\partial\\Omega$ 上，将平均值解释为内部迹，并在适当情况下用边界数据替换外部迹。\n\n显式定义内部罚方法在以下位置的数值通量：\n1) 内部面 $F \\in \\mathcal{F}_{i}$，\n2) Dirichlet 边界面 $F \\in \\mathcal{F}_{D}$，以及\n3) Neumann 边界面 $F \\in \\mathcal{F}_{N}$，\n使得得到的双线性形式是对称且伴随一致的。使用逐面罚缩放 $\\sigma_{F}/h_{F}$，其中 $h_{F}$ 是特征面尺寸，$\\sigma_{F} > 0$ 是为保证稳定性而选取的足够大的罚参数。\n\n最后，在一个特定的内部面 $F_{\\star} \\in \\mathcal{F}_{i}$ 上，该面由两个扩散系数分别为 $k^{-} = 2.7$ 和 $k^{+} = 2.5$ 的单元共享，多项式次数为 $p = 3$，面尺寸为 $h_{F_{\\star}} = 0.085$，采用如下足以保证稳定性的选择\n$$\n\\sigma_{F_{\\star}} \\;=\\; C_{\\mathrm{ip}} \\; \\max\\!\\big(k^{-},k^{+}\\big)\\; \\frac{p\\,(p+1)}{h_{F_{\\star}}},\n$$\n其中 $C_{\\mathrm{ip}} = 8.5$。计算 $\\sigma_{F_{\\star}}$ 的数值，并将结果四舍五入到四位有效数字。最终值不包含单位。", "solution": "问题陈述经评估有效。它在科学上植根于偏微分方程数值方法的理论，特别是间断 Galerkin 方法这一成熟的学科。该问题是适定的、客观的，并为所要求的推导和计算提供了所有必要的数据。它没有矛盾、歧义和任何形式的科学不严谨性。我们可以继续。\n\n任务是推导标量扩散问题的对称内部罚间断 Galerkin (SIPG) 弱形式。我们从控制方程的强形式开始，它在域 $\\Omega$ 中有效：\n$$\n-\\nabla \\cdot \\big(k \\nabla u \\big) = f\n$$\n这里，$u$ 是精确解，假设其具有足够的正则性以进行以下运算。我们用 DG 空间 $V_h$ 中的一个测试函数 $v_h$ 乘以该方程，并在任意单元 $K \\in \\mathcal{T}_{h}$ 上积分：\n$$\n\\int_{K} -\\nabla \\cdot \\big(k \\nabla u \\big) v_h \\, dV = \\int_{K} f v_h \\, dV\n$$\n对左侧应用散度定理（分部积分）得到：\n$$\n\\int_{K} \\big(k \\nabla u \\big) \\cdot \\nabla v_h \\, dV - \\int_{\\partial K} \\big(k \\nabla u \\cdot n_K \\big) v_h \\, dS = \\int_{K} f v_h \\, dV\n$$\n其中 $n_K$ 是指向边界 $\\partial K$ 外部的单位法向量。对网格 $\\mathcal{T}_h$ 中所有单元 $K$ 求和，我们得到：\n$$\n\\sum_{K \\in \\mathcal{T}_h} \\int_{K} k \\nabla u \\cdot \\nabla v_h \\, dV - \\sum_{K \\in \\mathcal{T}_h} \\int_{\\partial K} (k \\nabla u \\cdot n_K) v_h \\, dS = \\int_{\\Omega} f v_h \\, dV\n$$\n单元边界上的积分之和 $\\sum_{K \\in \\mathcal{T}_h} \\int_{\\partial K} (\\dots) dS$ 可以重新表示为网格所有面上的和。设 $\\mathcal{F} = \\mathcal{F}_i \\cup \\mathcal{F}_D \\cup \\mathcal{F}_N$ 为所有网格面的集合。对于一个由单元 $K^-$ 和 $K^+$ 共享的内部面 $F \\in \\mathcal{F}_i$，其对总和的贡献涉及两项，每个单元一项。设 $n$ 为 $F$ 上的一个固定单位法向量，例如从 $K^-$ 指向 $K^+$。则 $n_{K^-} = n$ 且 $n_{K^+} = -n$。面 $F$ 的贡献是：\n$$\n\\int_F (k \\nabla u \\cdot n) v_h^- dS + \\int_F (k \\nabla u \\cdot (-n)) v_h^+ dS = \\int_F (k \\nabla u \\cdot n) (v_h^- - v_h^+) dS = \\int_F (k \\nabla u \\cdot n) [v_h] dS\n$$\n这里，我们利用了对于精确解 $u$，其通量 $k \\nabla u \\cdot n$ 跨过 $F$ 是连续的这一事实。对于一个只属于一个单元的边界面 $F \\in \\partial\\Omega$，其贡献就是 $\\int_F (k \\nabla u \\cdot n) v_h dS$。因此，对精确解 $u$ 求和得到的恒等式变为：\n$$\n\\sum_{K \\in \\mathcal{T}_h} \\int_K k \\nabla u \\cdot \\nabla v_h \\, dV - \\sum_{F \\in \\mathcal{F}_i} \\int_F (k \\nabla u \\cdot n) [v_h] \\, dS - \\sum_{F \\in \\partial\\Omega} \\int_F (k \\nabla u \\cdot n) v_h \\, dS = \\int_{\\Omega} f v_h \\, dV\n$$\n这个形式是一致的，意味着精确解满足它。然而，面上的项关于 $u$ 和 $v_h$ 并不对称。为了构造一个对称的双线性形式，我们添加一些当用精确解计算时为零的项。\n首先，我们添加一个对称化项。对于精确解，$u$ 在内部面上是连续的，所以其跳跃 $[u] = u^- - u^+$ 为零。因此，以下项恒等于零：\n$$\n-\\sum_{F \\in \\mathcal{F}_i} \\int_F \\{k \\nabla v_h \\cdot n\\} [u] \\, dS = 0\n$$\n其次，为了稳定性和弱施加 Dirichlet 条件，我们添加一个罚项，由于 $[u]=0$，该项对于精确解也为零：\n$$\n+\\sum_{F \\in \\mathcal{F}_i \\cup \\mathcal{F}_D} \\int_F \\frac{\\sigma_F}{h_F} [u] [v_h] dS = 0\n$$\n将这些对于精确解为零的项添加到我们的一致形式中，并用离散解 $u_h \\in V_h$ 替换 $u$，我们定义 DG 方法：求 $u_h \\in V_h$ 使得对所有 $v_h \\in V_h$：\n$$\na_h(u_h, v_h) = L(v_h)\n$$\n其中双线性形式 $a_h(u_h, v_h)$ 和线性泛函 $L(v_h)$ 是通过处理边界条件来定义的。在 $\\Gamma_D$ 上，我们有 $u=g_D$；在 $\\Gamma_N$ 上，$k \\nabla u \\cdot n = g_N$。在边界面上，跳跃算子 $[w]$ 和平均算子 $\\{q\\}$ 的解释如下：\n-   在 $F \\subset \\partial\\Omega$上，其内部单元为 $K$，设法向量 $n$ 指向 $K$ 的外部。则 $[w] = w|_K$，且 $\\{q\\} = q|_K$。\n-   在 $F \\in \\mathcal{F}_D$上，我们定义 $[u_h] = u_h - g_D$。\n-   在 $F \\in \\mathcal{F}_N$上，Neumann 条件被自然施加。\n\n得到的 SIPG 弱形式为：\n$$\n\\begin{aligned}\na_h(u_h, v_h) = & \\sum_{K \\in \\mathcal{T}_h} \\int_K k \\nabla u_h \\cdot \\nabla v_h \\, dV \\\\\n& - \\sum_{F \\in \\mathcal{F}_i} \\int_F \\big( \\{k\\nabla u_h \\cdot n\\}[v_h] + \\{k\\nabla v_h \\cdot n\\}[u_h] \\big) dS + \\sum_{F \\in \\mathcal{F}_i} \\int_F \\frac{\\sigma_F}{h_F} [u_h][v_h] dS \\\\\n& - \\sum_{F \\in \\mathcal{F}_D} \\int_F \\big( (k\\nabla u_h \\cdot n)v_h + (k\\nabla v_h \\cdot n)u_h \\big) dS + \\sum_{F \\in \\mathcal{F}_D} \\int_F \\frac{\\sigma_F}{h_F} u_h v_h dS\n\\end{aligned}\n$$\n以及\n$$\nL(v_h) = \\int_{\\Omega} f v_h \\, dV + \\sum_{F \\in \\mathcal{F}_N} \\int_F g_N v_h \\, dS - \\sum_{F \\in \\mathcal{F}_D} \\int_F \\big( (k\\nabla v_h \\cdot n)g_D \\big) dS + \\sum_{F \\in \\mathcal{F}_D} \\int_F \\frac{\\sigma_F}{h_F} g_D v_h dS\n$$\n问题要求显式定义数值通量。SIPG 形式并非通过将单个数值通量函数简单代入模板而得到。相反，面积分项集合本身就隐式地定义了数值通量格式。从推导出的弱形式中，我们可以识别出这些等效的数值通量项。\n\n1)  **内部面 $F \\in \\mathcal{F}_i$**：信息交换由以下各项控制：\n    $$ -\\int_F \\big( \\{k\\nabla u_h \\cdot n\\}[v_h] + \\{k\\nabla v_h \\cdot n\\}[u_h] \\big) dS + \\int_F \\frac{\\sigma_F}{h_F} [u_h][v_h] dS $$\n    这些项确保了对称性、一致性和稳定性。\n\n2)  **Dirichlet 边界面 $F \\in \\mathcal{F}_D$**：Dirichlet 条件通过这些项被弱施加，这些项被分置于双线性形式和线性泛函中：\n    $$ -\\int_F (k\\nabla u_h \\cdot n)v_h dS - \\int_F (k\\nabla v_h \\cdot n)(u_h-g_D) dS + \\int_F \\frac{\\sigma_F}{h_F} (u_h-g_D) v_h dS $$\n    这等价于将梯度的数值通量迹设为 $\\widehat{k \\nabla u_h \\cdot n} = k\\nabla u_h \\cdot n - \\frac{\\sigma_F}{h_F}(u_h - g_D)$，并将解的迹设为 $\\widehat{u_h} = g_D$。\n\n3)  **Neumann 边界面 $F \\in \\mathcal{F}_N$**：通过用给定数据 $g_N$ 替换精确通量来自然施加 Neumann 条件。这对应于右端的项：\n    $$ \\int_F g_N v_h \\, dS $$\n    这等价于将梯度的数值通量迹设为 $\\widehat{k \\nabla u_h \\cdot n} = g_N$。\n\n最后，我们计算指定内部面 $F_{\\star}$ 的罚参数 $\\sigma_{F_{\\star}}$ 的数值。\n给定数据为：\n-   扩散系数：$k^{-} = 2.7$ 和 $k^{+} = 2.5$。\n-   多项式次数：$p = 3$。\n-   面尺寸：$h_{F_{\\star}} = 0.085$。\n-   罚分量公式常数：$C_{\\mathrm{ip}} = 8.5$。\n\n罚参数的公式是：\n$$\n\\sigma_{F_{\\star}} = C_{\\mathrm{ip}} \\max(k^{-}, k^{+}) \\frac{p(p+1)}{h_{F_{\\star}}}\n$$\n我们将给定值代入此公式。\n首先，$\\max(k^{-}, k^{+}) = \\max(2.7, 2.5) = 2.7$。\n多项式项是 $p(p+1) = 3(3+1) = 3 \\times 4 = 12$。\n现在，我们计算 $\\sigma_{F_{\\star}}$：\n$$\n\\sigma_{F_{\\star}} = 8.5 \\times 2.7 \\times \\frac{12}{0.085}\n$$\n$$\n\\sigma_{F_{\\star}} = 22.95 \\times \\frac{12}{0.085}\n$$\n$$\n\\sigma_{F_{\\star}} = \\frac{275.4}{0.085} = 3240\n$$\n该值恰好为 $3240$。问题要求将结果四舍五入到四位有效数字。用科学记数法表示为 $3.240 \\times 10^3$。作为标准数，它是 $3240$。", "answer": "$$\n\\boxed{3240}\n$$", "id": "2543104"}]}