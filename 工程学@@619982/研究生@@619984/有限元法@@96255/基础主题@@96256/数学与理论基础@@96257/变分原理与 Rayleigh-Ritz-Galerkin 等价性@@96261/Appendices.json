{"hands_on_practices": [{"introduction": "让我们通过一个典型的边值问题，将理论付诸实践。这个练习将引导你完成计算瑞利-里兹有限元近似解的全过程，让你具体地验证伽辽金解是在试探空间上使能量泛函最小化的基本原理。通过计算精确解和近似解的能量，你将对“能量间隙”以及有限元解的最优性获得切实的理解 [@problem_id:2609997]。", "problem": "考虑标量边值问题\n$$\n-\\big((1+x)\\,u'(x)\\big)' \\;=\\; 1 \\quad \\text{for } x\\in(0,1), \\qquad u(0)=0,\\; u(1)=0.\n$$\n从基于能量原理的变分形式出发，定义能量泛函，并论证为何精确解是其在 Sobolev 空间 $H^{1}_{0}(0,1)$ 上的唯一极小化子。使用 Rayleigh–Ritz–Galerkin 等价性构建具有两个线性有限元的有限元方法，即在节点为 $x=0$、$x=\\tfrac{1}{2}$ 和 $x=1$ 的均匀剖分上，由满足在 $x=0$ 和 $x=1$ 处施加的齐次 Dirichlet 边界条件的连续分片线性函数构成的协调试验空间。显式计算：\n- 此空间中的唯一 Ritz–Galerkin 近似解 $u_{h}$，\n- 近似解的能量 $J(u_{h})$，\n- 精确解的能量 $J(u)$。\n\n最后，将能量差\n$$\nE_{\\mathrm{gap}} \\;=\\; J(u_{h}) - J(u)\n$$\n以单一的精确封闭形式表达式给出。无需舍入，不涉及单位。最终答案必须是这个单一的表达式。", "solution": "所给问题是一个来自应用数学领域的适定的、有科学依据的边值问题。该问题是自洽的，提供了所有必要的数据和条件。不存在科学或逻辑上的缺陷。这是微分方程变分形式和 Rayleigh-Ritz-Galerkin 方法的一个标准练习题。因此，该问题被认为是有效的，并将提供一个形式化的解。\n\n给定的标量边值问题是\n$$\n-\\big((1+x)\\,u'(x)\\big)' \\;=\\; 1 \\quad \\text{for } x\\in(0,1)\n$$\n其齐次 Dirichlet 边界条件为 $u(0)=0$ 和 $u(1)=0$。\n\n首先，我们推导变分形式。令解空间为 Sobolev 空间 $H^{1}_{0}(0,1)$，该空间由一阶弱导数平方可积且在边界 $x=0$ 和 $x=1$ 处为零的函数组成。我们将微分方程乘以一个任意的测试函数 $v \\in H^{1}_{0}(0,1)$，并在定义域 $(0,1)$ 上积分：\n$$\n-\\int_{0}^{1} \\big((1+x)\\,u'(x)\\big)' v(x) \\, dx \\;=\\; \\int_{0}^{1} 1 \\cdot v(x) \\, dx\n$$\n对左侧应用分部积分法，得到：\n$$\n-\\Big[(1+x)u'(x)v(x)\\Big]_{0}^{1} + \\int_{0}^{1} (1+x)u'(x)v'(x) \\, dx \\;=\\; \\int_{0}^{1} v(x) \\, dx\n$$\n由于 $v \\in H^{1}_{0}(0,1)$，我们有 $v(0)=0$ 和 $v(1)=0$，因此边界项消失。这导出了弱形式：求 $u \\in H^{1}_{0}(0,1)$，使得\n$$\na(u,v) \\;=\\; F(v) \\quad \\forall v \\in H^{1}_{0}(0,1)\n$$\n其中双线性形式 $a(\\cdot,\\cdot)$ 和线性泛函 $F(\\cdot)$ 定义为：\n$$\na(w,v) \\;=\\; \\int_{0}^{1} (1+x)w'(x)v'(x) \\, dx\n$$\n$$\nF(v) \\;=\\; \\int_{0}^{1} v(x) \\, dx\n$$\n相应的能量泛函 $J(v)$ 由 $J(v) = \\frac{1}{2}a(v,v) - F(v)$ 给出：\n$$\nJ(v) \\;=\\; \\frac{1}{2} \\int_{0}^{1} (1+x)(v'(x))^{2} \\, dx - \\int_{0}^{1} v(x) \\, dx\n$$\n精确解 $u$ 是该泛函在 $H^{1}_{0}(0,1)$ 上的唯一极小化子。这可以通过双线性形式 $a(\\cdot,\\cdot)$ 的性质来证明。它在 $H^{1}_{0}(0,1)$ 上是对称、连续和矫顽的。矫顽性可以通过观察到对于 $x \\in [0,1]$，我们有 $1+x \\ge 1$ 来建立。因此，\n$$\na(v,v) = \\int_{0}^{1} (1+x)(v'(x))^{2} \\, dx \\ge \\int_{0}^{1} (v'(x))^{2} \\, dx = \\|v'\\|_{L^{2}(0,1)}^{2}\n$$\n根据庞加莱不等式，存在一个常数 $C > 0$，使得 $\\|v\\|_{H^{1}(0,1)} \\le C \\|v'\\|_{L^{2}(0,1)}$ 对所有 $v \\in H^{1}_{0}(0,1)$ 成立。因此，$a(v,v)$ 在 $H^{1}_{0}(0,1)$ 上是矫顽的。对于一个对称、连续和矫顽的双线性形式，能量泛函 $J(v)$ 是严格凸和连续的。泛函分析中的一个标准定理保证了这样的泛函在 Hilbert 空间中拥有唯一的极小化子，该极小化子与弱形式的唯一解重合。\n\n接下来，我们构造 Rayleigh-Ritz-Galerkin 近似解 $u_{h}$。有限元空间 $V_{h}$ 由在节点为 $x_{0}=0$、$x_{1}=\\frac{1}{2}$ 和 $x_{2}=1$ 的均匀剖分上，满足齐次边界条件的连续分片线性函数组成。该空间是一维的，由与内部节点 $x_{1}=\\frac{1}{2}$ 相关联的单个基“帽”函数 $\\phi_{1}(x)$ 张成：\n$$\n\\phi_{1}(x) = \\begin{cases} 2x & \\text{if } x \\in [0, \\frac{1}{2}] \\\\ 2(1-x) & \\text{if } x \\in [\\frac{1}{2}, 1] \\end{cases}\n$$\n该基函数的导数是分片常数：\n$$\n\\phi'_{1}(x) = \\begin{cases} 2 & \\text{if } x \\in (0, \\frac{1}{2}) \\\\ -2 & \\text{if } x \\in (\\frac{1}{2}, 1) \\end{cases}\n$$\nRitz-Galerkin 近似解的形式为 $u_{h}(x) = c_{1}\\phi_{1}(x)$，其中系数 $c_{1}$ 由 Galerkin 方程 $a(u_{h}, \\phi_{1}) = F(\\phi_{1})$ 确定。这给出了线性系统 $c_{1} a(\\phi_{1}, \\phi_{1}) = F(\\phi_{1})$。我们计算其分量：\n$$\na(\\phi_{1},\\phi_{1}) = \\int_{0}^{1} (1+x)(\\phi'_{1}(x))^{2} \\, dx = \\int_{0}^{1/2} (1+x)(2)^{2} \\, dx + \\int_{1/2}^{1} (1+x)(-2)^{2} \\, dx\n$$\n$$\na(\\phi_{1},\\phi_{1}) = 4 \\int_{0}^{1} (1+x) \\, dx = 4 \\left[x + \\frac{x^{2}}{2}\\right]_{0}^{1} = 4 \\left(1 + \\frac{1}{2}\\right) = 6\n$$\n$$\nF(\\phi_{1}) = \\int_{0}^{1} \\phi_{1}(x) \\, dx = \\int_{0}^{1/2} 2x \\, dx + \\int_{1/2}^{1} 2(1-x) \\, dx = \\left[x^{2}\\right]_{0}^{1/2} + 2\\left[x - \\frac{x^{2}}{2}\\right]_{1/2}^{1} = \\frac{1}{4} + 2\\left(\\frac{1}{2} - \\frac{3}{8}\\right) = \\frac{1}{2}\n$$\n$c_{1}$ 的线性方程是 $6 c_{1} = \\frac{1}{2}$，解得 $c_{1} = \\frac{1}{12}$。因此，近似解为：\n$$\nu_{h}(x) = \\frac{1}{12} \\phi_{1}(x)\n$$\n近似解的能量 $J(u_{h})$ 计算为 $J(u_{h}) = \\frac{1}{2}a(u_{h}, u_{h}) - F(u_{h})$。根据 Galerkin 正交性，$a(u_{h}, u_{h}) = F(u_{h})$。因此，$J(u_{h}) = -\\frac{1}{2} F(u_{h})$。\n$$\nF(u_{h}) = F(c_{1}\\phi_{1}) = c_{1}F(\\phi_{1}) = \\frac{1}{12} \\cdot \\frac{1}{2} = \\frac{1}{24}\n$$\n所以，近似解的能量是：\n$$\nJ(u_{h}) = -\\frac{1}{2} \\left(\\frac{1}{24}\\right) = -\\frac{1}{48}\n$$\n现在，我们通过对微分方程直接积分来求精确解 $u(x)$：\n$$\n-\\big((1+x)u'(x)\\big)' = 1 \\implies -(1+x)u'(x) = x + C_{1} \\implies u'(x) = -\\frac{x+C_{1}}{1+x} = -1 - \\frac{C_{1}-1}{1+x}\n$$\n再次积分得到：\n$$\nu(x) = -x - (C_{1}-1)\\ln(1+x) + C_{2}\n$$\n应用边界条件：\n$u(0)=0 \\implies 0 = -0 - (C_{1}-1)\\ln(1) + C_{2} \\implies C_{2}=0$。\n$u(1)=0 \\implies 0 = -1 - (C_{1}-1)\\ln(2) \\implies C_{1}-1 = -\\frac{1}{\\ln(2)}$。\n精确解是：\n$$\nu(x) = -x - \\left(-\\frac{1}{\\ln(2)}\\right)\\ln(1+x) = \\frac{\\ln(1+x)}{\\ln(2)} - x\n$$\n精确解的能量 $J(u)$ 的确定方式类似：$J(u) = -\\frac{1}{2}F(u)$。\n$$\nF(u) = \\int_{0}^{1} u(x) \\, dx = \\int_{0}^{1} \\left(\\frac{\\ln(1+x)}{\\ln(2)} - x\\right) \\, dx = \\frac{1}{\\ln(2)} \\int_{0}^{1} \\ln(1+x) \\, dx - \\int_{0}^{1} x \\, dx\n$$\n积分的计算结果如下：\n$\\int_{0}^{1} x \\, dx = \\frac{1}{2}$。\n$\\int_{0}^{1} \\ln(1+x) \\, dx = \\Big[(1+x)\\ln(1+x) - (1+x)\\Big]_{0}^{1} = (2\\ln(2)-2) - (1\\ln(1)-1) = 2\\ln(2) - 1$。\n所以，\n$$\nF(u) = \\frac{1}{\\ln(2)}(2\\ln(2) - 1) - \\frac{1}{2} = 2 - \\frac{1}{\\ln(2)} - \\frac{1}{2} = \\frac{3}{2} - \\frac{1}{\\ln(2)}\n$$\n精确解的能量是：\n$$\nJ(u) = -\\frac{1}{2} F(u) = -\\frac{1}{2} \\left(\\frac{3}{2} - \\frac{1}{\\ln(2)}\\right) = \\frac{1}{2\\ln(2)} - \\frac{3}{4}\n$$\n最后，我们计算能量差 $E_{\\mathrm{gap}} = J(u_{h}) - J(u)$：\n$$\nE_{\\mathrm{gap}} = -\\frac{1}{48} - \\left(\\frac{1}{2\\ln(2)} - \\frac{3}{4}\\right) = -\\frac{1}{48} - \\frac{1}{2\\ln(2)} + \\frac{36}{48}\n$$\n$$\nE_{\\mathrm{gap}} = \\frac{35}{48} - \\frac{1}{2\\ln(2)}\n$$\n根据 Rayleigh-Ritz 原理，这个差值保证为非负，因为 $u$ 是 $J$ 的全局极小化子，而 $u_h$ 是子空间 $V_h$ 上的极小化子。", "answer": "$$\n\\boxed{\\frac{35}{48} - \\frac{1}{2\\ln(2)}}\n$$", "id": "2609997"}, {"introduction": "瑞利-里兹能量最小化原理与伽辽金方法之间的等价性，是自伴问题有限元方法的一块基石，但当底层的算子非对称时会发生什么呢？本练习通过构建一个非对称双线性型来探讨这一关键限制。通过证明得到的系统矩阵是非对称的，你将从第一性原理上理解为何在这种情况下，伽辽金方程不能由一个简单的二次能量泛函导出，从而突显出弱形式更广泛的普适性 [@problem_id:2609992]。", "problem": "令 $V$ 为索博列夫空间 $H^{1}(0,1)$，并令 $V_{h} \\subset V$ 是由两个线性无关函数 $\\phi_{1}(x)=x$ 和 $\\phi_{2}(x)=x^{2}$ 张成的有限维试探与检验空间。考虑双线性形式 $a:V\\times V\\to \\mathbb{R}$，其定义为\n$$\na(u,v)\\;=\\;\\int_{0}^{1} u'(x)\\,v(x)\\,dx\\;+\\;\\int_{0}^{1} u(x)\\,v(x)\\,dx,\n$$\n以及一个任意的连续线性形式 $\\ell:V\\to\\mathbb{R}$。伽辽金方法 (Galerkin method) 旨在找到 $u_{h}\\in V_{h}$ 使得对所有 $v_{h}\\in V_{h}$ 都有 $a(u_{h},v_{h})=\\ell(v_{h})$，此方法将导出一个关于系数向量 $\\mathbf{c}\\in\\mathbb{R}^{2}$ 的线性系统 $\\mathbf{K}\\,\\mathbf{c}=\\mathbf{f}$。其中，刚度矩阵 $\\mathbf{K}\\in\\mathbb{R}^{2\\times 2}$ 的元素为 $K_{ij}=a(\\phi_{j},\\phi_{i})$（对于 $i,j\\in\\{1,2\\}$），载荷向量 $\\mathbf{f}$ 的元素为 $f_{i}=\\ell(\\phi_{i})$。\n\n从关于 $\\mathbb{R}^{2}$ 上标准欧几里得内积中标量泛函梯度的第一性原理出发，解释为什么存在一个二次泛函 $J(\\mathbf{c})$，其一阶必要条件为对所有 $\\mathbf{c}\\in\\mathbb{R}^{2}$ 都有 $\\nabla J(\\mathbf{c})=\\mathbf{K}\\mathbf{c}-\\mathbf{f}$，这要求 $\\mathbf{K}$ 是对称的。然后，对于上面给出的 $a(\\cdot,\\cdot)$ 和 $V_{h}$ 的具体选择，显式计算 $K_{12}-K_{21}$ 的值，以确认 $\\mathbf{K}$ 不是对称的，因此伽辽金方程不能通过在标准欧几里得内积下最小化一个二次泛函得到。\n\n将 $K_{12}-K_{21}$ 的最终结果表示为一个无舍入的精确既约分数。", "solution": "该问题提出了两个任务。第一，从第一性原理出发，证明线性系统的二次势泛函的存在性意味着系统矩阵的对称性。第二，计算从一个非对称双线性形式导出的特定刚度矩阵的非对称性。该问题是适定且科学合理的。我们将开始解答。\n\n首先，我们处理理论要求。令 $J(\\mathbf{c})$ 为 $\\mathbb{R}^{n}$ 上的一个标量值泛函，其中 $\\mathbf{c} = (c_{1}, c_{2}, \\dots, c_{n})^{T}$。问题指出，$J$ 取极值的一阶必要条件由方程 $\\nabla J(\\mathbf{c}) = \\mathbf{K}\\mathbf{c} - \\mathbf{f}$ 给出，其中 $\\mathbf{K}$ 是一个 $n \\times n$ 矩阵，$\\mathbf{f}$ 是 $\\mathbb{R}^{n}$ 中的一个常向量。向量场 $\\mathbf{F}(\\mathbf{c}) = \\mathbf{K}\\mathbf{c} - \\mathbf{f}$ 被视为 $J$ 的梯度。\n\n对于一个向量场 $\\mathbf{F}$，若其为标量势 $J$ 的梯度（即 $\\mathbf{F} = \\nabla J$），一个必要条件是其雅可比矩阵必须是对称的。$\\mathbf{F}$ 的雅可比矩阵记为 $\\mathbf{J}_{\\mathbf{F}}$，其元素为 $(\\mathbf{J}_{\\mathbf{F}})_{ij} = \\frac{\\partial F_{i}}{\\partial c_{j}}$。\n给定 $F_{i} = \\frac{\\partial J}{\\partial c_{i}}$，雅可比矩阵的元素变为 $(\\mathbf{J}_{\\mathbf{F}})_{ij} = \\frac{\\partial}{\\partial c_{j}}\\left(\\frac{\\partial J}{\\partial c_{i}}\\right) = \\frac{\\partial^{2} J}{\\partial c_{j} \\partial c_{i}}$。这个矩阵是 $J$ 的海森矩阵，记为 $\\mathbf{H}_{J}$。\n\n根据关于混合偏导数相等的 Schwarz 定理（或 Clairaut 定理），如果一个函数的二阶偏导数是连续的，那么其海森矩阵是对称的。即，$\\frac{\\partial^{2} J}{\\partial c_{j} \\partial c_{i}} = \\frac{\\partial^{2} J}{\\partial c_{i} \\partial c_{j}}$，这意味着 $(\\mathbf{H}_{J})_{ij} = (\\mathbf{H}_{J})_{ji}$。\n该问题指定了一个二次泛函。这样一个泛函的二阶导数是常数，因此是连续的，所以该定理无条件适用。\n\n现在，我们计算特定向量场 $\\mathbf{F}(\\mathbf{c}) = \\mathbf{K}\\mathbf{c} - \\mathbf{f}$ 的雅可比矩阵。其第 $i$ 个分量是 $F_{i}(\\mathbf{c}) = \\sum_{k=1}^{n} K_{ik}c_{k} - f_{i}$。\n关于 $c_{j}$ 的偏导数是：\n$$\n\\frac{\\partial F_{i}}{\\partial c_{j}} = \\frac{\\partial}{\\partial c_{j}} \\left( \\sum_{k=1}^{n} K_{ik}c_{k} - f_{i} \\right) = \\sum_{k=1}^{n} K_{ik} \\frac{\\partial c_{k}}{\\partial c_{j}} = \\sum_{k=1}^{n} K_{ik} \\delta_{kj} = K_{ij}\n$$\n其中 $\\delta_{kj}$ 是克罗内克符号。\n因此，$\\mathbf{F}(\\mathbf{c})$ 的雅可比矩阵就是矩阵 $\\mathbf{K}$ 本身。\n将两个结果等同起来，我们得到 $\\mathbf{H}_{J} = \\mathbf{K}$。由于海森矩阵 $\\mathbf{H}_{J}$ 必须是对称的，因此必然得出矩阵 $\\mathbf{K}$ 也必须是对称的，即 $K_{ij} = K_{ji}$。这结束了第一部分的论证。\n\n接下来，我们计算该特定问题的刚度矩阵并验证其非对称性。空间 $V_{h}$ 由基函数 $\\phi_{1}(x) = x$ 和 $\\phi_{2}(x) = x^{2}$ 张成。它们的导数是 $\\phi_{1}'(x) = 1$ 和 $\\phi_{2}'(x) = 2x$。\n双线性形式由下式给出：\n$$\na(u,v) = \\int_{0}^{1} u'(x)v(x)dx + \\int_{0}^{1} u(x)v(x)dx\n$$\n刚度矩阵 $\\mathbf{K} \\in \\mathbb{R}^{2 \\times 2}$ 的元素定义为 $K_{ij} = a(\\phi_{j}, \\phi_{i})$，其中 $i,j \\in \\{1,2\\}$。我们需要计算 $K_{12} - K_{21}$。\n\n让我们计算 $K_{12}$ 项：\n$$\nK_{12} = a(\\phi_{2}, \\phi_{1}) = \\int_{0}^{1} \\phi_{2}'(x)\\phi_{1}(x)dx + \\int_{0}^{1} \\phi_{2}(x)\\phi_{1}(x)dx\n$$\n代入函数及其导数的表达式：\n$$\nK_{12} = \\int_{0}^{1} (2x)(x)dx + \\int_{0}^{1} (x^{2})(x)dx = \\int_{0}^{1} 2x^{2}dx + \\int_{0}^{1} x^{3}dx\n$$\n进行积分：\n$$\nK_{12} = \\left[\\frac{2x^{3}}{3}\\right]_{0}^{1} + \\left[\\frac{x^{4}}{4}\\right]_{0}^{1} = \\frac{2}{3} + \\frac{1}{4} = \\frac{8+3}{12} = \\frac{11}{12}\n$$\n现在，我们来计算 $K_{21}$ 项：\n$$\nK_{21} = a(\\phi_{1}, \\phi_{2}) = \\int_{0}^{1} \\phi_{1}'(x)\\phi_{2}(x)dx + \\int_{0}^{1} \\phi_{1}(x)\\phi_{2}(x)dx\n$$\n代入函数及其导数：\n$$\nK_{21} = \\int_{0}^{1} (1)(x^{2})dx + \\int_{0}^{1} (x)(x^{2})dx = \\int_{0}^{1} x^{2}dx + \\int_{0}^{1} x^{3}dx\n$$\n进行积分：\n$$\nK_{21} = \\left[\\frac{x^{3}}{3}\\right]_{0}^{1} + \\left[\\frac{x^{4}}{4}\\right]_{0}^{1} = \\frac{1}{3} + \\frac{1}{4} = \\frac{4+3}{12} = \\frac{7}{12}\n$$\n非对称性是显而易见的，因为 $K_{12} \\neq K_{21}$。所要求的量是差值：\n$$\nK_{12} - K_{21} = \\frac{11}{12} - \\frac{7}{12} = \\frac{4}{12} = \\frac{1}{3}\n$$\n另外，这个差值也可以更直接地计算：\n$$\nK_{12} - K_{21} = a(\\phi_{2}, \\phi_{1}) - a(\\phi_{1}, \\phi_{2}) = \\left(\\int_{0}^{1} \\phi_{2}'\\phi_{1}dx + \\int_{0}^{1} \\phi_{2}\\phi_{1}dx\\right) - \\left(\\int_{0}^{1} \\phi_{1}'\\phi_{2}dx + \\int_{0}^{1} \\phi_{1}\\phi_{2}dx\\right)\n$$\n包含 $\\int \\phi_{1}\\phi_{2}dx$ 的项会抵消，因为乘法是可交换的。非对称性完全源于双线性形式中的 $u'v$ 项。\n$$\nK_{12} - K_{21} = \\int_{0}^{1} (\\phi_{2}'\\phi_{1} - \\phi_{1}'\\phi_{2})dx = \\int_{0}^{1} ((2x)(x) - (1)(x^{2}))dx = \\int_{0}^{1} (2x^{2} - x^{2})dx = \\int_{0}^{1} x^{2}dx\n$$\n$$\n\\int_{0}^{1} x^{2}dx = \\left[\\frac{x^{3}}{3}\\right]_{0}^{1} = \\frac{1}{3}\n$$\n由于 $K_{12} - K_{21} \\neq 0$，刚度矩阵 $\\mathbf{K}$ 不是对称的。因此，对于这种双线性形式和基的特定选择，伽辽金系统 $\\mathbf{K}\\mathbf{c} = \\mathbf{f}$ 不能通过在标准欧几里得内积下最小化一个二次泛函 $J(\\mathbf{c})$ 来导出，因为这会要求矩阵 $\\mathbf{K}$ 是对称的。", "answer": "$$\n\\boxed{\\frac{1}{3}}\n$$", "id": "2609992"}, {"introduction": "在明确了瑞利-里兹/伽辽金等价性的局限后，我们现在转向一个实际且富有挑战性的应用：对流主导的输运问题。对于这类非自伴问题，标准的伽辽金方法常常会产生不符合物理规律的振荡。本练习将介绍流线迎风彼得罗夫-伽辽金 (SUPG) 方法，这是一种强大的稳定化技术，让你能够直观比较其相较于标准方法的优越表现，并体会如何调整弱形式以克服基本挑战 [@problem_id:2609999]。", "problem": "考虑在区间 $[0,1]$ 上的具有常系数的一维定常对流-扩散边值问题\n$$\n-\\,\\epsilon\\,u''(x) \\;+\\; b\\,u'(x) \\;=\\; 0,\\quad x\\in(0,1),\\qquad u(0)=0,\\;u(1)=1,\n$$\n其中 $\\epsilon>0$ 是扩散系数，$b>0$ 是对流速度。在有限元法 (FEM) 的框架下，从标准弱形式出发，该弱形式通过将强形式乘以一个检验函数 $v\\in H^{1}_{0}(0,1)$ 并进行分部积分得到。使用一个由两个尺寸为 $h=1/2$ 的相等单元组成的均匀网格，并使用连续分段仿射函数空间作为试探空间。处理标准的Galerkin方法（试探空间与检验空间相同）和流线迎风Petrov-Galerkin (SUPG) 方法，其中检验函数在每个单元上被修改为 $w=v+\\tau\\,b\\,v'$，每个单元具有一个常数稳定化参数 $\\tau$。\n\n(a) 在标准的Galerkin方法中，从第一性原理出发，通过精确的单元级积分，推导双线性形式中扩散项和对流项贡献的 $2\\times 2$ 单元矩阵，组装 $3\\times 3$ 全局矩阵，并在强加Dirichlet边界条件后，将其简化为关于内部节点未知数 $u_{1}$ 的单一方程。\n\n(b) 在变分层面使用SUPG方法的定义，并利用在每个单元上分段仿射函数 $v$ 满足 $v''=0$ 的事实，说明SUPG项如何修改双线性形式，并推导相应的单元矩阵。在双单元网格上组装SUPG稳定化的全局系统，并将其简化为关于内部节点未知数 $u_{1}^{\\mathrm{SUPG}}$ 的单一方程。\n\n(c) 对于数据 $\\epsilon=10^{-3}$ 和 $b=10$，并在每个单元上选择经典的一维SUPG稳定化参数 $\\tau = h/(2b)$，计算此双单元网格上稳定化的内部节点解 $u_{1}^{\\mathrm{SUPG}}$ 的精确值。将您的最终答案表示为最简形式的单个精确分数。无需四舍五入。此外, 简要比较标准Galerkin内部节点解的符号和大致数量级与SUPG的值，以说明SUPG对伪振荡的抑制作用。您的最终数值答案必须仅为 $u_{1}^{\\mathrm{SUPG}}$ 的精确值，作为一个数字。", "solution": "所述问题是偏微分方程数值分析中的一个标准的、适定的问题。它具有科学依据，内容自洽，并且所提供的所有数据都是一致且足以推导出唯一解的。因此，该问题是有效的。\n\n一维定常对流-扩散方程的强形式为\n$$\n-\\epsilon u''(x) + b u'(x) = 0, \\quad x \\in (0,1)\n$$\n边界条件为 $u(0)=0$ 和 $u(1)=1$。\n\n为了推导标准弱形式，我们将方程乘以一个检验函数 $v \\in H_0^1(0,1)$ 并在定义域 $(0,1)$ 上积分：\n$$\n\\int_0^1 (-\\epsilon u''(x) + b u'(x)) v(x) \\,dx = 0\n$$\n对扩散项应用分部积分，我们得到：\n$$\n\\int_0^1 \\epsilon u'(x) v'(x) \\,dx - [\\epsilon u'(x) v(x)]_0^1 + \\int_0^1 b u'(x) v(x) \\,dx = 0\n$$\n由于 $v \\in H_0^1(0,1)$，我们有 $v(0)=v(1)=0$，因此边界项消失。弱形式为：求 $u \\in H^1(0,1)$，使得 $u(0)=0$，$u(1)=1$，并且\n$$\nB(u,v) = \\int_0^1 (\\epsilon u'(x) v'(x) + b u'(x) v(x)) \\,dx = 0 \\quad \\forall v \\in H_0^1(0,1)\n$$\n在有限元法中，我们寻求一个近似解 $u_h(x) = \\sum_{j=0}^2 U_j \\phi_j(x)$，其中 $\\phi_j(x)$ 是在节点为 $x_0=0$，$x_1=1/2$ 和 $x_2=1$ 的均匀网格上的连续分段线性（仿射）基函数。网格尺寸为 $h=1/2$。边界条件被强加为 $U_0 = u(0) = 0$ 和 $U_2 = u(1) = 1$。唯一的未知数是内部节点值 $U_1$。\n\n(a) 标准Galerkin方法\n\nGalerkin方法对试探函数和检验函数使用相同的空间。我们计算双线性形式 $B(u,v)$ 的单元贡献。在一个长度为 $h$ 的通用单元 $I_e$ 上，局部线性基函数为 $N_1(\\xi) = 1 - \\xi/h$ 和 $N_2(\\xi) = \\xi/h$，其中 $\\xi \\in [0,h]$。它们的导数为 $N_1' = -1/h$ 和 $N_2' = 1/h$。\n\n单元扩散矩阵 $K^e_{\\text{diff}}$ 的元素为 $K^e_{ij, \\text{diff}} = \\int_0^h \\epsilon N_i' N_j' \\,d\\xi$。\n$$\nK^e_{\\text{diff}} = \\int_0^h \\epsilon \\begin{pmatrix} (-1/h)^2 & (-1/h)(1/h) \\\\ (1/h)(-1/h) & (1/h)^2 \\end{pmatrix} d\\xi = \\frac{\\epsilon}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n单元对流矩阵 $K^e_{\\text{conv}}$ 的元素为 $K^e_{ij, \\text{conv}} = \\int_0^h b u_j' v_i \\,d\\xi$，其中 $u_j$ 和 $v_i$ 是局部基函数 $N_j$ 和 $N_i$。因此 $K^e_{ij, \\text{conv}} = \\int_0^h b N_j' N_i \\,d\\xi$。\n$$\nK^e_{11, \\text{conv}} = \\int_0^h b N_1' N_1 \\,d\\xi = \\int_0^h b (-1/h)(1-\\xi/h) \\,d\\xi = -b/h [ \\xi - \\xi^2/(2h) ]_0^h = -b/2\n$$\n$$\nK^e_{12, \\text{conv}} = \\int_0^h b N_2' N_1 \\,d\\xi = \\int_0^h b (1/h)(1-\\xi/h) \\,d\\xi = b/h [ \\xi - \\xi^2/(2h) ]_0^h = b/2\n$$\n$$\nK^e_{21, \\text{conv}} = \\int_0^h b N_1' N_2 \\,d\\xi = \\int_0^h b (-1/h)(\\xi/h) \\,d\\xi = -b/h^2 [ \\xi^2/2 ]_0^h = -b/2\n$$\n$$\nK^e_{22, \\text{conv}} = \\int_0^h b N_2' N_2 \\,d\\xi = \\int_0^h b (1/h)(\\xi/h) \\,d\\xi = b/h^2 [ \\xi^2/2 ]_0^h = b/2\n$$\n这给出了对流矩阵：\n$$\nK^e_{\\text{conv}} = \\frac{b}{2} \\begin{pmatrix} -1 & -1 \\\\ 1 & 1 \\end{pmatrix}\n$$\n纠正：对流矩阵的计算应为：\n$K^e_{11} = -b/2, K^e_{12} = b/2, K^e_{21} = -b/2, K^e_{22} = b/2$。所以矩阵是\n$$\nK^e_{\\text{conv}} = \\frac{b}{2} \\begin{pmatrix} -1 & 1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n总的单元刚度矩阵为 $K^e = K^e_{\\text{diff}} + K^e_{\\text{conv}}$。对于我们的网格，$h=1/2$。\n$$\nK^e = \\frac{\\epsilon}{1/2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} + \\frac{b}{2} \\begin{pmatrix} -1 & 1 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 2\\epsilon - b/2 & -2\\epsilon + b/2 \\\\ -2\\epsilon - b/2 & 2\\epsilon + b/2 \\end{pmatrix}\n$$\n全局 $3 \\times 3$ 矩阵 $K$ 由两个单元矩阵组装而成。\n单元1（节点0, 1）和单元2（节点1, 2）是相同的。\n$K_{00} = (K^e)_{11} = 2\\epsilon - b/2$。\n$K_{01} = (K^e)_{12} = -2\\epsilon + b/2$。\n$K_{10} = (K^e)_{21} = -2\\epsilon - b/2$。\n$K_{11} = (K^e)_{22} + (K^e)_{11} = (2\\epsilon + b/2) + (2\\epsilon - b/2) = 4\\epsilon$。\n$K_{12} = (K^e)_{12} = -2\\epsilon + b/2$。\n$K_{21} = (K^e)_{21} = -2\\epsilon - b/2$。\n$K_{22} = (K^e)_{22} = 2\\epsilon + b/2$。\n全局矩阵为：\n$$\nK = \\begin{pmatrix} 2\\epsilon - b/2 & -2\\epsilon + b/2 & 0 \\\\ -2\\epsilon - b/2 & 4\\epsilon & -2\\epsilon + b/2 \\\\ 0 & -2\\epsilon - b/2 & 2\\epsilon + b/2 \\end{pmatrix}\n$$\n线性系统为 $K\\mathbf{U} = \\mathbf{F}$，其中 $\\mathbf{U} = [U_0, U_1, U_2]^T$ 且 $\\mathbf{F}$ 是载荷向量，由于偏微分方程的右侧为零，所以 $\\mathbf{F}$ 为零。内部节点 $U_1$ 的离散方程是该系统的第二行：\n$$\nK_{10}U_0 + K_{11}U_1 + K_{12}U_2 = 0\n$$\n代入 $U_0=0$ 和 $U_2=1$：\n$$\n(-2\\epsilon - b/2)(0) + (4\\epsilon)U_1 + (-2\\epsilon + b/2)(1) = 0\n$$\n这简化为关于内部节点未知数 $U_1$ 的单一方程：\n$$\n4\\epsilon U_1 - 2\\epsilon + \\frac{b}{2} = 0\n$$\n\n(b) 流线迎风Petrov-Galerkin (SUPG) 方法\n\nSUPG方法将检验函数修改为 $w=v+\\tau b v'$，其中 $v$ 是标准的Galerkin检验函数，$\\tau$ 是一个稳定化参数。SUPG的公式为：\n$$\nB_{\\text{SUPG}}(u_h, v_h) = \\int_0^1 (-\\epsilon u_h'' + b u_h') (v_h + \\tau b v_h') \\,dx = 0\n$$\n这是按单元计算的。在每个单元上，$u_h$ 是仿射的，所以 $u_h''=0$。积分变为：\n$$\n\\sum_k \\int_{I_k} (b u_h') (v_h + \\tau b v_h') \\,dx = 0\n$$\n这可以分为Galerkin部分和稳定化部分。更标准的做法是通过向Galerkin弱形式添加一个稳定化项来定义SUPG方法：\n$$\nB_{\\text{SUPG}}(u_h, v_h) = B(u_h, v_h) + \\sum_k \\int_{I_k} (-\\epsilon u_h'' + b u_h')(\\tau b v_h') \\,dx = 0\n$$\n同样，由于在每个单元内部 $u_h''=0$，稳定化项简化为 $\\sum_k \\int_{I_k} (b u_h')(\\tau b v_h') \\,dx$。因此，完整的SUPG双线性形式是：\n$$\nB_{\\text{SUPG}}(u_h, v_h) = \\int_0^1 (\\epsilon u_h' v_h' + b u_h' v_h) \\,dx + \\sum_k \\int_{I_k} \\tau b^2 u_h' v_h' \\,dx\n$$\n合并各项，我们看到扩散项被修改了：\n$$\nB_{\\text{SUPG}}(u_h, v_h) = \\int_0^1 b u_h' v_h \\,dx + \\sum_k \\int_{I_k} (\\epsilon + \\tau b^2) u_h' v_h' \\,dx\n$$\n这表明，对于此问题和所选的基函数，SUPG方法等效于在每个单元上向物理扩散 $\\epsilon$ 添加人工扩散 $\\tau b^2$。\nSUPG单元矩阵 $K^e_{\\text{SUPG}}$ 是通过在Galerkin单元矩阵的扩散部分中用 $\\epsilon' = \\epsilon + \\tau b^2$ 替换 $\\epsilon$得到的：\n$$\nK^e_{\\text{SUPG}} = \\frac{\\epsilon + \\tau b^2}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} + \\frac{b}{2} \\begin{pmatrix} -1 & 1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n组装全局系统的过程与Galerkin情况相同，只是将 $\\epsilon$ 替换为 $\\epsilon'$。全局SUPG矩阵 $K_{\\text{SUPG}}$ 为\n$$\nK_{\\text{SUPG}} = \\begin{pmatrix} 2\\epsilon' - b/2 & -2\\epsilon' + b/2 & 0 \\\\ -2\\epsilon' - b/2 & 4\\epsilon' & -2\\epsilon' + b/2 \\\\ 0 & -2\\epsilon' - b/2 & 2\\epsilon' + b/2 \\end{pmatrix}\n$$\n内部未知数 $U_1^{\\mathrm{SUPG}}$ 的方程由第二行得到：\n$$\nK_{\\text{SUPG},10}U_0 + K_{\\text{SUPG},11}U_1^{\\mathrm{SUPG}} + K_{\\text{SUPG},12}U_2 = 0\n$$\n代入 $U_0=0$，$U_2=1$：\n$$\n(4\\epsilon')U_1^{\\mathrm{SUPG}} + (-2\\epsilon' + b/2)(1) = 0\n$$\n这简化为关于内部节点未知数 $U_1^{\\mathrm{SUPG}}$ 的单一方程：\n$$\n4(\\epsilon + \\tau b^2) U_1^{\\mathrm{SUPG}} - 2(\\epsilon + \\tau b^2) + \\frac{b}{2} = 0\n$$\n\n(c) 数值计算与比较\n\n给定数据 $\\epsilon=10^{-3}$，$b=10$，网格尺寸为 $h=1/2$。稳定化参数选择为 $\\tau = h/(2b)$。\n$$\n\\tau = \\frac{1/2}{2 \\times 10} = \\frac{1}{40}\n$$\n根据(b)部分，$U_1^{\\mathrm{SUPG}}$ 的方程是 $4\\epsilon' U_1^{\\mathrm{SUPG}} = 2\\epsilon' - b/2$，这给出 $U_1^{\\mathrm{SUPG}} = \\frac{1}{2} - \\frac{b}{8\\epsilon'}$。\n我们计算有效扩散 $\\epsilon' = \\epsilon + \\tau b^2$：\n$$\n\\epsilon' = 10^{-3} + \\frac{1}{40} (10)^2 = \\frac{1}{1000} + \\frac{100}{40} = \\frac{1}{1000} + \\frac{5}{2} = \\frac{1}{1000} + \\frac{2500}{1000} = \\frac{2501}{1000}\n$$\n现在我们计算 $U_1^{\\mathrm{SUPG}}$：\n$$\nU_1^{\\mathrm{SUPG}} = \\frac{1}{2} - \\frac{b}{8\\epsilon'} = \\frac{1}{2} - \\frac{10}{8 \\left(\\frac{2501}{1000}\\right)} = \\frac{1}{2} - \\frac{10000}{8 \\times 2501} = \\frac{1}{2} - \\frac{1250}{2501}\n$$\n$$\nU_1^{\\mathrm{SUPG}} = \\frac{2501 - 2(1250)}{2 \\times 2501} = \\frac{2501 - 2500}{5002} = \\frac{1}{5002}\n$$\n为了比较，我们使用(a)部分的公式计算标准Galerkin解 $U_1$，$U_1 = \\frac{1}{2} - \\frac{b}{8\\epsilon}$：\n$$\nU_1 = \\frac{1}{2} - \\frac{10}{8 \\times 10^{-3}} = \\frac{1}{2} - \\frac{10}{0.008} = \\frac{1}{2} - 1250 = -1249.5\n$$\n精确解 $u(x)$ 是单调的，并界于 $u(0)=0$ 和 $u(1)=1$ 之间。对于这个对流占优的情况（$b/\\epsilon = 10000$），解在接近 $x=1$ 处的急剧边界层之前几乎为 $0$。在 $x=1/2$ 处的精确值非常小且为正。Galerkin解 $U_1 = -1249.5$ 是一个大的负数，完全不符合物理实际，表现出严重的伪振荡。相比之下，SUPG解 $U_1^{\\mathrm{SUPG}} = 1/5002$ 是一个小的正值，正确地捕捉了解的定性行为，并展示了对振荡的抑制。", "answer": "$$\n\\boxed{\\frac{1}{5002}}\n$$", "id": "2609999"}]}