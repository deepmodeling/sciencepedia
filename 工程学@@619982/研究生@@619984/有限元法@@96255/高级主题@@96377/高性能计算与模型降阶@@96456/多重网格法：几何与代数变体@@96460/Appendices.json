{"hands_on_practices": [{"introduction": "局部傅里叶分析 (Local Fourier Analysis, LFA) 是分析多重网格方法性能的基石。通过将算子作用于傅里叶模式，我们可以得到一个标量特征值，即“符号”，它简洁地描述了算子对不同频率分量的影响。本练习将引导你计算一维和二维离散拉普拉斯算子的傅里叶符号，这是进行多重网格收敛性分析所需的基本技能 [@problem_id:2581535]。", "problem": "考虑在均匀网格上使用有限元方法背景下的多重网格方法的局部傅里叶分析。设离散拉普拉斯算子定义在一个无限均匀网格上，从而使其满足平移不变性，并容许复指数函数作为其本征模。\n\n在一维空间中，考虑网格 $\\Omega_{h}^{(1\\mathrm{D})} = \\{ x_{i} = i h : i \\in \\mathbb{Z} \\}$，其网格间距为 $h > 0$。作用于网格函数 $\\{u_{i}\\}_{i \\in \\mathbb{Z}}$ 的拉普拉斯算子的标准三点有限差分近似为：\n$$\n(L_{h}^{(1\\mathrm{D})} u)_{i} = \\frac{-u_{i-1} + 2 u_{i} - u_{i+1}}{h^{2}}.\n$$\n在二维空间中，考虑网格 $\\Omega_{h}^{(2\\mathrm{D})} = \\{ (x_{i},y_{j}) = (i h, j h) : i,j \\in \\mathbb{Z} \\}$。作用于网格函数 $\\{u_{i,j}\\}_{(i,j)\\in\\mathbb{Z}^{2}}$ 的拉普拉斯算子的标准五点有限差分近似为：\n$$\n(L_{h}^{(2\\mathrm{D})} u)_{i,j} = \\frac{-u_{i-1,j} - u_{i+1,j} - u_{i,j-1} - u_{i,j+1} + 4 u_{i,j}}{h^{2}}.\n$$\n\n对于一个平移不变的离散算子 $L_{h}$，其傅里叶符号 $\\widehat{L}_{h}(\\boldsymbol{\\theta})$ 定义为一个标量，使得对于相应网格上的任意傅里叶模 $\\varphi_{\\boldsymbol{\\theta}}$，下式成立：\n$$\nL_{h} \\varphi_{\\boldsymbol{\\theta}} = \\widehat{L}_{h}(\\boldsymbol{\\theta}) \\, \\varphi_{\\boldsymbol{\\theta}},\n$$\n其中，在一维情况下，傅里叶模为 $\\varphi_{\\theta}[i] = \\exp(\\mathrm{i} \\, \\theta \\, i)$，其中 $\\theta \\in (-\\pi,\\pi]$；在二维情况下，傅里叶模为 $\\varphi_{\\boldsymbol{\\theta}}[i,j] = \\exp(\\mathrm{i} \\, (\\theta_{x} \\, i + \\theta_{y} \\, j))$，其中 $\\boldsymbol{\\theta} = (\\theta_{x},\\theta_{y}) \\in (-\\pi,\\pi]^{2}$。\n\n请仅使用这些定义和给定的离散拉普拉斯算子，显式计算傅里叶符号 $\\widehat{L}_{h}^{(1\\mathrm{D})}(\\theta)$ 和 $\\widehat{L}_{h}^{(2\\mathrm{D})}(\\theta_{x},\\theta_{y})$ 的闭合形式。将最终答案以单个行向量的形式给出，其中分别包含一维和二维符号的解析表达式。不需要进行数值近似，最终答案中也不应报告单位。", "solution": "该问题陈述经验证是适定的、有科学依据且客观的。它代表了离散算子局部傅里叶分析中的一个标准练习，而局部傅里叶分析是分析多重网格方法的基本工具。所有提供的定义和数据都是自洽的，并且在数学上是一致的。我们开始推导。\n\n离散、平移不变算子 $L_{h}$ 的傅里叶符号 $\\widehat{L}_{h}(\\boldsymbol{\\theta})$ 由本征值关系 $L_{h} \\varphi_{\\boldsymbol{\\theta}} = \\widehat{L}_{h}(\\boldsymbol{\\theta}) \\, \\varphi_{\\boldsymbol{\\theta}}$ 定义，其中 $\\varphi_{\\boldsymbol{\\theta}}$ 是一个傅里叶模。我们按照要求计算一维和二维离散拉普拉斯算子的符号。\n\n首先，我们考虑一维情况。离散算子为\n$$\n(L_{h}^{(1\\mathrm{D})} u)_{i} = \\frac{-u_{i-1} + 2 u_{i} - u_{i+1}}{h^{2}}\n$$\n傅里叶模为 $\\varphi_{\\theta}[i] = \\exp(\\mathrm{i} \\, \\theta \\, i)$。我们将算子 $L_{h}^{(1\\mathrm{D})}$ 应用于傅里叶模 $\\varphi_{\\theta}$：\n$$\n(L_{h}^{(1\\mathrm{D})} \\varphi_{\\theta})[i] = \\frac{-\\varphi_{\\theta}[i-1] + 2 \\varphi_{\\theta}[i] - \\varphi_{\\theta}[i+1]}{h^{2}}\n$$\n代入傅里叶模的显式形式，我们得到\n$$\n(L_{h}^{(1\\mathrm{D})} \\varphi_{\\theta})[i] = \\frac{-\\exp(\\mathrm{i} \\, \\theta \\, (i-1)) + 2 \\exp(\\mathrm{i} \\, \\theta \\, i) - \\exp(\\mathrm{i} \\, \\theta \\, (i+1))}{h^{2}}\n$$\n我们提出对应于 $\\varphi_{\\theta}[i]$ 的项 $\\exp(\\mathrm{i} \\, \\theta \\, i)$：\n$$\n(L_{h}^{(1\\mathrm{D})} \\varphi_{\\theta})[i] = \\frac{1}{h^{2}} \\left( -\\exp(-\\mathrm{i} \\, \\theta) + 2 - \\exp(\\mathrm{i} \\, \\theta) \\right) \\exp(\\mathrm{i} \\, \\theta \\, i)\n$$\n根据定义，标量前因子即为傅里叶符号 $\\widehat{L}_{h}^{(1\\mathrm{D})}(\\theta)$:\n$$\n\\widehat{L}_{h}^{(1\\mathrm{D})}(\\theta) = \\frac{1}{h^{2}} \\left( 2 - (\\exp(\\mathrm{i} \\, \\theta) + \\exp(-\\mathrm{i} \\, \\theta)) \\right)\n$$\n使用恒等式 $\\cos(\\theta) = \\frac{\\exp(\\mathrm{i} \\, \\theta) + \\exp(-\\mathrm{i} \\, \\theta)}{2}$，我们简化该符号：\n$$\n\\widehat{L}_{h}^{(1\\mathrm{D})}(\\theta) = \\frac{1}{h^{2}} (2 - 2\\cos(\\theta)) = \\frac{2}{h^{2}}(1 - \\cos(\\theta))\n$$\n最后，应用半角三角恒等式 $1 - \\cos(\\theta) = 2 \\sin^{2}(\\frac{\\theta}{2})$，我们得到闭合形式：\n$$\n\\widehat{L}_{h}^{(1\\mathrm{D})}(\\theta) = \\frac{4}{h^{2}} \\sin^{2}\\left(\\frac{\\theta}{2}\\right)\n$$\n\n接下来，我们考虑二维情况。离散算子为\n$$\n(L_{h}^{(2\\mathrm{D})} u)_{i,j} = \\frac{-u_{i-1,j} - u_{i+1,j} - u_{i,j-1} - u_{i,j+1} + 4 u_{i,j}}{h^{2}}\n$$\n傅里叶模为 $\\varphi_{\\boldsymbol{\\theta}}[i,j] = \\exp(\\mathrm{i} \\, (\\theta_{x} \\, i + \\theta_{y} \\, j))$。我们将 $L_{h}^{(2\\mathrm{D})}$ 应用于 $\\varphi_{\\boldsymbol{\\theta}}$：\n$$\n(L_{h}^{(2\\mathrm{D})} \\varphi_{\\boldsymbol{\\theta}})[i,j] = \\frac{-\\varphi_{\\boldsymbol{\\theta}}[i-1,j] - \\varphi_{\\boldsymbol{\\theta}}[i+1,j] - \\varphi_{\\boldsymbol{\\theta}}[i,j-1] - \\varphi_{\\boldsymbol{\\theta}}[i,j+1] + 4\\varphi_{\\boldsymbol{\\theta}}[i,j]}{h^{2}}\n$$\n代入傅里叶模的形式：\n$$\n(L_{h}^{(2\\mathrm{D})} \\varphi_{\\boldsymbol{\\theta}})[i,j] = \\frac{1}{h^{2}} \\left( \\begin{aligned} &-\\exp(\\mathrm{i}(\\theta_{x}(i-1) + \\theta_{y}j)) - \\exp(\\mathrm{i}(\\theta_{x}(i+1) + \\theta_{y}j)) \\\\ &- \\exp(\\mathrm{i}(\\theta_{x}i + \\theta_{y}(j-1))) - \\exp(\\mathrm{i}(\\theta_{x}i + \\theta_{y}(j+1))) \\\\ &+ 4\\exp(\\mathrm{i}(\\theta_{x}i + \\theta_{y}j)) \\end{aligned} \\right)\n$$\n我们从和中的每一项提出对应于 $\\varphi_{\\boldsymbol{\\theta}}[i,j]$ 的项 $\\exp(\\mathrm{i} \\, (\\theta_{x} \\, i + \\theta_{y} \\, j))$：\n$$\n(L_{h}^{(2\\mathrm{D})} \\varphi_{\\boldsymbol{\\theta}})[i,j] = \\frac{1}{h^{2}} \\left( -\\exp(-\\mathrm{i}\\theta_{x}) - \\exp(\\mathrm{i}\\theta_{x}) - \\exp(-\\mathrm{i}\\theta_{y}) - \\exp(\\mathrm{i}\\theta_{y}) + 4 \\right) \\exp(\\mathrm{i}(\\theta_{x}i + \\theta_{y}j))\n$$\n标量前因子即为二维傅里叶符号 $\\widehat{L}_{h}^{(2\\mathrm{D})}(\\boldsymbol{\\theta})$：\n$$\n\\widehat{L}_{h}^{(2\\mathrm{D})}(\\theta_{x},\\theta_{y}) = \\frac{1}{h^{2}} \\left( 4 - (\\exp(\\mathrm{i}\\theta_{x}) + \\exp(-\\mathrm{i}\\theta_{x})) - (\\exp(\\mathrm{i}\\theta_{y}) + \\exp(-\\mathrm{i}\\theta_{y})) \\right)\n$$\n使用 $\\cos(\\alpha) = \\frac{\\exp(\\mathrm{i}\\alpha) + \\exp(-\\mathrm{i}\\alpha)}{2}$，我们简化得到：\n$$\n\\widehat{L}_{h}^{(2\\mathrm{D})}(\\theta_{x},\\theta_{y}) = \\frac{1}{h^{2}} (4 - 2\\cos(\\theta_{x}) - 2\\cos(\\theta_{y})) = \\frac{2}{h^{2}} \\left( (1 - \\cos(\\theta_{x})) + (1 - \\cos(\\theta_{y})) \\right)\n$$\n对两项应用半角恒等式 $1 - \\cos(\\alpha) = 2 \\sin^{2}(\\frac{\\alpha}{2})$ 得到最终的闭合形式：\n$$\n\\widehat{L}_{h}^{(2\\mathrm{D})}(\\theta_{x},\\theta_{y}) = \\frac{2}{h^{2}} \\left( 2\\sin^{2}\\left(\\frac{\\theta_{x}}{2}\\right) + 2\\sin^{2}\\left(\\frac{\\theta_{y}}{2}\\right) \\right) = \\frac{4}{h^{2}} \\left( \\sin^{2}\\left(\\frac{\\theta_{x}}{2}\\right) + \\sin^{2}\\left(\\frac{\\theta_{y}}{2}\\right) \\right)\n$$\n至此，我们完成了两种情况所需的计算。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{4}{h^{2}} \\sin^{2}\\left(\\frac{\\theta}{2}\\right) & \\frac{4}{h^{2}} \\left( \\sin^{2}\\left(\\frac{\\theta_{x}}{2}\\right) + \\sin^{2}\\left(\\frac{\\theta_{y}}{2}\\right) \\right)\n\\end{pmatrix}\n}\n$$", "id": "2581535"}, {"introduction": "一个完整的多重网格循环不仅依赖于有效的平滑，还依赖于在粗细网格之间传递信息的限制 ($R$) 和延拓 ($P$) 算子。本练习将深入探讨最常用的几何转移算子——全权重限制和双线性插值——的结构，并推导它们的傅里叶符号。通过构建伽辽金 (Galerkin) 粗网格算子 $A_H = R A_h P$，你将理解这些组件如何协同工作，并与底层有限元空间的嵌套性质建立联系 [@problem_id:2581555]。", "problem": "考虑模型问题 $-\\Delta u = f$，该问题定义在一个周期性二维环面 $\\Omega = \\mathbb{T}^{2}$ 上，使用分片双线性 ($Q_{1}$) 有限元在网格尺寸为 $h$ 的均匀笛卡尔网格上进行离散化。在此网格上，得到的刚度矩阵 $A_{h}$ 是标准的五点离散拉普拉斯算子。引入一个网格尺寸为 $H = 2h$ 的粗网格。网格间转移算子的定义如下：延拓算子 $P_{H}^{h}$ 是从粗网格到细网格的双线性插值，限制算子 $R_{h}^{H}$ 是从细网格到粗网格的全加权。假设采用周期性边界条件，以便应用平移不变性和傅里叶分析。\n\n任务：\n- 从双线性插值的定义性质出发，并根据限制算子需满足对称、紧支的加权平均、保持常数，且在 $d=2$ 维中与选择 $R_{h}^{H} = 2^{-d} (P_{H}^{h})^{T}$ 一致的要求，推导以粗网格节点为中心的 $P_{H}^{h}$ 和 $R_{h}^{H}$ 的 $3 \\times 3$ 点模板。\n- 使用局部傅里叶分析 (LFA) 中傅里叶符号的定义，即对于网格上的平移不变算子 $M$，傅里叶模式 $\\varphi_{\\boldsymbol{\\theta}}(\\boldsymbol{j}) = \\exp\\!\\big(i(\\boldsymbol{j}\\cdot \\boldsymbol{\\theta})\\big)$ 是其特征函数，对应的特征值（符号）为 $\\tilde{M}(\\boldsymbol{\\theta})$，为你的模板推导傅里叶符号 $\\tilde{P}_{H}^{h}(\\boldsymbol{\\theta})$ 和 $\\tilde{R}_{h}^{H}(\\boldsymbol{\\theta})$，其中 $\\boldsymbol{\\theta} = (\\theta_{1},\\theta_{2}) \\in [-\\pi,\\pi]^{2}$。\n- 从细网格上五点拉普拉斯算子经过充分检验的符号 $\\tilde{A}_{h}(\\boldsymbol{\\theta}) = \\dfrac{4}{h^{2}}\\!\\left(\\sin^{2}\\!\\big(\\tfrac{\\theta_{1}}{2}\\big) + \\sin^{2}\\!\\big(\\tfrac{\\theta_{2}}{2}\\big)\\right)$ 出发，结合粗网格算子的伽辽金定义 $A_{H} = R_{h}^{H} A_{h} P_{H}^{h}$ 以及在 $d=2$ 维下 $R_{h}^{H} = 2^{-2} (P_{H}^{h})^{T}$ 的关系，从嵌套的 $Q_{1}$ 有限元空间的第一性原理出发，论证 $A_{H}$ 是标准粗网格五点拉普拉斯算子的一个均匀缩放版本，并将其傅里叶符号 $\\tilde{A}_{H}(\\boldsymbol{\\vartheta})$ 显式地写成关于 $\\boldsymbol{\\vartheta} = (\\vartheta_{1},\\vartheta_{2})$ 和 $H$ 的函数。\n- 最后，计算在 $\\boldsymbol{\\vartheta} = \\big(\\tfrac{\\pi}{2}, \\tfrac{\\pi}{3}\\big)$ 处无量纲标量 $S = \\tilde{A}_{H}(\\boldsymbol{\\vartheta})\\,H^{2}$ 的值，并给出其精确值。不要四舍五入。你的最终答案必须是一个不带单位的单一数字。", "solution": "在尝试求解之前，对问题陈述进行验证。\n\n步骤 1：提取已知条件\n\n-   **方程：** $-\\Delta u = f$\n-   **区域：** 周期性二维环面 $\\Omega = \\mathbb{T}^{2}$。\n-   **离散化：** 在均匀笛卡尔网格上使用分片双线性 ($Q_{1}$) 有限元。\n-   **细网格：** 网格尺寸 $h$。刚度矩阵为 $A_{h}$，即标准五点离散拉普拉斯算子。\n-   **粗网格：** 网格尺寸 $H = 2h$。刚度矩阵为 $A_{H}$。\n-   **延拓：** $P_{H}^{h}$ 是双线性插值。\n-   **限制：** $R_{h}^{H}$ 是全加权。\n-   **网格间算子关系：** 限制算子的选择与在 $d=2$ 维下的 $R_{h}^{H} = 2^{-d} (P_{H}^{h})^{T}$ 一致，即 $R_{h}^{H} = \\frac{1}{4} (P_{H}^{h})^{T}$。\n-   **边界条件：** 周期性，允许进行傅里叶分析。\n-   **傅里叶分析定义：**\n    -   傅里叶模式：$\\varphi_{\\boldsymbol{\\theta}}(\\boldsymbol{j}) = \\exp(i(\\boldsymbol{j}\\cdot \\boldsymbol{\\theta}))$\n    -   傅里叶符号 $\\tilde{M}(\\boldsymbol{\\theta})$：对应于平移不变算子 $M$ 的特征函数 $\\varphi_{\\boldsymbol{\\theta}}(\\boldsymbol{j})$ 的特征值。\n-   **给定的细网格符号：** $\\tilde{A}_{h}(\\boldsymbol{\\theta}) = \\dfrac{4}{h^{2}}(\\sin^{2}(\\tfrac{\\theta_{1}}{2}) + \\sin^{2}(\\tfrac{\\theta_{2}}{2}))$。\n-   **粗网格算子定义：** $A_{H} = R_{h}^{H} A_{h} P_{H}^{h}$。\n-   **任务：**\n    1.  推导 $P_{H}^{h}$ 和 $R_{h}^{H}$ 的 $3 \\times 3$ 模板。\n    2.  推导它们的傅里叶符号 $\\tilde{P}_{H}^{h}(\\boldsymbol{\\theta})$ 和 $\\tilde{R}_{h}^{H}(\\boldsymbol{\\theta})$。\n    3.  从有限元方法（FEM）原理出发，论证 $A_{H}$ 是粗网格5点拉普拉斯算子的一个缩放版本，并求出其符号 $\\tilde{A}_{H}(\\boldsymbol{\\vartheta})$。\n    4.  在 $\\boldsymbol{\\vartheta} = (\\tfrac{\\pi}{2}, \\tfrac{\\pi}{3})$ 处计算 $S = \\tilde{A}_{H}(\\boldsymbol{\\vartheta})\\,H^{2}$。\n\n步骤 2：使用提取的已知条件进行验证\n\n该问题在有限元方法 (FEM) 和多重网格方法这两个已建立的数学领域中有坚实的科学基础，特别是使用了局部傅里叶分析 (LFA)。所有概念，包括双线性元、五点拉普拉斯算子、双线性插值、全加权限制和伽辽金粗化，都是标准且定义明确的。问题是适定的，提供了得出唯一解所需的所有定义、关系和数据。语言客观而精确。不存在矛盾；关系式 $R_{h}^{H} = \\frac{1}{4} (P_{H}^{h})^{T}$ 与二维情况下 $Q_1$ 元的双线性插值和全加权限制的标准配对是一致的。该问题需要实质性的推理，且有一定难度。\n\n步骤 3：结论与行动\n\n问题有效。将提供完整解答。\n\n**解题推导**\n\n按指定顺序执行任务来求解。\n\n**任务一：推导模板**\n\n要求模板以粗网格节点为中心。设粗网格节点由 $\\boldsymbol{J}$ 索引，细网格节点由 $\\boldsymbol{j}$ 索引。我们建立一个局部坐标系，其原点位于一个粗网格节点上。\n\n限制算子 $R_{h}^{H}$（全加权）将细网格上的函数映射到粗网格上。它被定义为“保持常数的对称、紧支的加权平均”。一个作用于细网格值以产生位于粗网格节点上的值的通用对称 $3 \\times 3$ 模板由下式给出：\n$$\n(R_{h}^{H} u)_{\\boldsymbol{J}=0} = \\sum_{k_1, k_2 \\in \\{-1,0,1\\}} w_{|k_1|,|k_2|} u_{(k_1, k_2)}\n$$\n对于全加权，权重与 $[1, 2, 1] \\otimes [1, 2, 1]^T$ 成比例。为保持常数（即将常数函数 $u=c$ 映射为 $R_{h}^{H}u=c$），权重之和必须为 $1$。未归一化权重的总和为 $(1+2+1)\\times(1+2+1) = 16$。因此，用于将 $9$ 个细网格值组合计算 $1$ 个粗网格值的 $R_{h}^{H}$ 的模板是：\n$$\nS_{R} = \\frac{1}{16}\n\\begin{pmatrix}\n1 & 2 & 1 \\\\\n2 & 4 & 2 \\\\\n1 & 2 & 1\n\\end{pmatrix}\n$$\n延拓算子 $P_{H}^{h}$ 是双线性插值。它的作用是根据粗网格上的值确定细网格上的值。题目指明了与 $R_{h}^{H} = \\frac{1}{4} (P_{H}^{h})^{T}$ 的一致性。因此，$(P_{H}^{h})^T$ 的模板必须是 $4 S_R$。\n$$\nS_{P^T} = 4 S_R = \\frac{4}{16}\n\\begin{pmatrix}\n1 & 2 & 1 \\\\\n2 & 4 & 2 \\\\\n1 & 2 & 1\n\\end{pmatrix} = \\frac{1}{4}\n\\begin{pmatrix}\n1 & 2 & 1 \\\\\n2 & 4 & 2 \\\\\n1 & 2 & 1\n\\end{pmatrix}\n$$\n该模板描述了如何将细网格值加权平均到粗网格上。对于延拓算子 $P_H^h$，其模板描述了一个粗网格节点值如何分布到其周围的细网格节点上。对于双线性插值，以粗网格节点为中心的 $3 \\times 3$ 分布模板为：\n$$\nS_{P} = \\begin{pmatrix}\n1/4 & 1/2 & 1/4 \\\\\n1/2 & 1 & 1/2 \\\\\n1/4 & 1/2 & 1/4\n\\end{pmatrix}\n$$\n这正确地表示了双线性插值：一个粗网格节点值对其重合的细网格节点的贡献权重为 $1$，对其邻近的边中心的细网格节点的贡献权重为 $1/2$，对单元中心的细网格节点的贡献权重为 $1/4$。\n\n**任务二：推导傅里叶符号**\n\n具有计算模板 $S$ 的算子 $M$ 的傅里叶符号 $\\tilde{M}(\\boldsymbol{\\theta})$ 由 $\\tilde{M}(\\boldsymbol{\\theta}) = \\sum_{\\boldsymbol{k}} S_{\\boldsymbol{k}} \\exp(i(\\boldsymbol{k}\\cdot \\boldsymbol{\\theta}))$ 给出。\n\n对于限制算子 $R_{h}^{H}$，模板 $S_R$ 是细网格上的一个计算模板。其符号为：\n$$\n\\tilde{R}_{h}^{H}(\\boldsymbol{\\theta}) = \\frac{1}{16} \\sum_{k_1,k_2 \\in \\{-1,0,1\\}} S'_{k_1,k_2} \\exp(i(k_1 \\theta_1 + k_2 \\theta_2))\n$$\n其中 $S'$是未归一化权重的矩阵。\n$$\n\\tilde{R}_{h}^{H}(\\boldsymbol{\\theta}) = \\frac{1}{16} \\left[ 4 + 2(e^{i\\theta_1} + e^{-i\\theta_1}) + 2(e^{i\\theta_2} + e^{-i\\theta_2}) + 1(e^{i(\\theta_1+\\theta_2)} + e^{-i(\\theta_1+\\theta_2)} + e^{i(\\theta_1-\\theta_2)} + e^{-i(\\theta_1-\\theta_2)}) \\right]\n$$\n使用 $e^{ix} + e^{-ix} = 2\\cos(x)$，我们有：\n$$\n\\tilde{R}_{h}^{H}(\\boldsymbol{\\theta}) = \\frac{1}{16} \\left[ 4 + 4\\cos(\\theta_1) + 4\\cos(\\theta_2) + 2\\cos(\\theta_1+\\theta_2) + 2\\cos(\\theta_1-\\theta_2) \\right]\n$$\n使用 $\\cos(A+B)+\\cos(A-B) = 2\\cos A\\cos B$：\n$$\n\\tilde{R}_{h}^{H}(\\boldsymbol{\\theta}) = \\frac{1}{16} \\left[ 4 + 4\\cos(\\theta_1) + 4\\cos(\\theta_2) + 4\\cos(\\theta_1)\\cos(\\theta_2) \\right] = \\frac{1}{4} (1+\\cos(\\theta_1))(1+\\cos(\\theta_2))\n$$\n使用半角恒等式 $1+\\cos(x) = 2\\cos^2(x/2)$：\n$$\n\\tilde{R}_{h}^{H}(\\boldsymbol{\\theta}) = \\frac{1}{4} (2\\cos^2(\\tfrac{\\theta_1}{2}))(2\\cos^2(\\tfrac{\\theta_2}{2})) = \\cos^2(\\tfrac{\\theta_1}{2})\\cos^2(\\tfrac{\\theta_2}{2})\n$$\n对于延拓算子 $P_H^h$（即双线性插值），直接推导其符号比较复杂，因为它将粗网格函数映射到细网格函数。然而，在LFA的背景下，人们通常只关心它对低频模式的作用。对于低频模式 $\\boldsymbol{\\theta} \\in [-\\pi/2, \\pi/2]^2$，双线性插值的（低频）符号是已知的：\n$$\n\\tilde{P}_{H}^{h}(\\boldsymbol{\\theta}) = \\cos(\\tfrac{\\theta_1}{2})\\cos(\\tfrac{\\theta_2}{2})\n$$\n该符号可以通过分析插值对粗网格傅里叶模式的作用，并将结果投影到低频细网格模式上得到。\n\n**任务三：粗网格算子符号**\n\n粗网格算子通过伽辽金投影 $A_{H} = R_{h}^{H} A_{h} P_{H}^{h}$ 构成。使用给定的关系 $R_{h}^{H} = \\frac{1}{4} (P_{H}^{h})^{T}$，我们得到：\n$$\nA_{H} = \\frac{1}{4} (P_{H}^{h})^{T} A_{h} P_{H}^{h}\n$$\n该问题基于分片双线性 ($Q_{1}$) 有限元。粗网格 $Q_{1}$ 函数空间 $V_H$ 是细网格 $Q_{1}$ 函数空间 $V_h$ 的子空间，即 $V_H \\subset V_h$。延拓算子 $P_H^h$ 代表了这种自然嵌入。矩阵 $A_h$ 是双线性形式 $a(u,v)=\\int_\\Omega \\nabla u \\cdot \\nabla v \\, dx$ 在细网格节点基下的表示。乘积 $(P_{H}^{h})^{T} A_{h} P_{H}^{h}$ 是同一双线性形式 $a(u,v)$ 在粗网格节点基下的表示。这恰好是通过在网格尺寸为 $H$ 的粗网格上直接应用有限元方法所组装得到的刚度矩阵，记为 $A_{H}^{\\text{fem}}$。\n\n对于均匀笛卡尔网格，为拉普拉斯算子组装 $Q_{1}$ 刚度矩阵会得到标准的五点离散拉普拉斯算子。因此，$A_{H}^{\\text{fem}}$ 是粗网格上的标准五点拉普拉斯算子。所以，我们有：\n$$\nA_{H} = \\frac{1}{4} A_{H}^{\\text{fem}}\n$$\n这表明 $A_H$ 是标准粗网格五点拉普拉斯算子的一个均匀缩放版本。$A_{H}^{\\text{fem}}$ 的符号由与 $\\tilde{A}_h(\\boldsymbol{\\theta})$ 相同的公式给出，但需要将 $h$ 替换为 $H$，并将频率 $\\boldsymbol{\\theta}$ 替换为粗网格频率 $\\boldsymbol{\\vartheta}$：\n$$\n\\tilde{A}_{H}^{\\text{fem}}(\\boldsymbol{\\vartheta}) = \\frac{4}{H^2} \\left( \\sin^2(\\tfrac{\\vartheta_1}{2}) + \\sin^2(\\tfrac{\\vartheta_2}{2}) \\right)\n$$\n因此，我们的算子 $A_H$ 的符号为：\n$$\n\\tilde{A}_{H}(\\boldsymbol{\\vartheta}) = \\frac{1}{4} \\tilde{A}_{H}^{\\text{fem}}(\\boldsymbol{\\vartheta}) = \\frac{1}{4} \\frac{4}{H^2} \\left( \\sin^2(\\tfrac{\\vartheta_1}{2}) + \\sin^2(\\tfrac{\\vartheta_2}{2}) \\right) = \\frac{1}{H^2} \\left( \\sin^2(\\tfrac{\\vartheta_1}{2}) + \\sin^2(\\tfrac{\\vartheta_2}{2}) \\right)\n$$\n\n**任务四：最终求值**\n\n我们必须在 $\\boldsymbol{\\vartheta} = (\\tfrac{\\pi}{2}, \\tfrac{\\pi}{3})$ 处计算无量纲标量 $S = \\tilde{A}_{H}(\\boldsymbol{\\vartheta})\\,H^{2}$ 的值。\n代入 $\\tilde{A}_{H}(\\boldsymbol{\\vartheta})$ 的表达式：\n$$\nS = \\left[ \\frac{1}{H^2} \\left( \\sin^2(\\tfrac{\\vartheta_1}{2}) + \\sin^2(\\tfrac{\\vartheta_2}{2}) \\right) \\right] H^2 = \\sin^2(\\tfrac{\\vartheta_1}{2}) + \\sin^2(\\tfrac{\\vartheta_2}{2})\n$$\n现在代入 $\\boldsymbol{\\vartheta}$ 的值：\n$$\nS = \\sin^2\\left(\\frac{1}{2} \\cdot \\frac{\\pi}{2}\\right) + \\sin^2\\left(\\frac{1}{2} \\cdot \\frac{\\pi}{3}\\right) = \\sin^2\\left(\\frac{\\pi}{4}\\right) + \\sin^2\\left(\\frac{\\pi}{6}\\right)\n$$\n我们知道精确值：$\\sin(\\frac{\\pi}{4}) = \\frac{\\sqrt{2}}{2}$ 和 $\\sin(\\frac{\\pi}{6}) = \\frac{1}{2}$。\n$$\nS = \\left(\\frac{\\sqrt{2}}{2}\\right)^2 + \\left(\\frac{1}{2}\\right)^2 = \\frac{2}{4} + \\frac{1}{4} = \\frac{1}{2} + \\frac{1}{4}\n$$\n$$\nS = \\frac{3}{4}\n$$\n最终值为 $\\frac{3}{4}$。", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "2581555"}, {"introduction": "当问题具有各向异性（例如，在一个方向上的扩散率远大于另一个方向）时，标准的光滑子（如点雅可比或高斯-赛德尔）会失效。本练习将引导你处理这一挑战，通过设计和分析一个沿强耦合方向的线-高斯-赛德尔光滑子来解决各向异性问题。你将使用局部傅里叶分析来量化其平滑效率，从而理解如何根据问题的物理特性定制多重网格算法的关键组件 [@problem_id:2581527]。", "problem": "考虑一个定义在无限、均匀、网格尺寸为 $h$ 的矩形网格上的各向异性扩散模型问题：\n$$\n- \\frac{\\partial^2 u}{\\partial x^2} - \\epsilon \\frac{\\partial^2 u}{\\partial y^2} = f \\quad \\text{in } \\mathbb{R}^2,\n$$\n其中 $0<\\epsilon \\ll 1$。设在均匀笛卡尔网格上使用 $\\mathbb{Q}_1$ (双线性) 协调有限元来离散化弱形式，并考虑在无限网格上的标准刚度算子。对于这种结构化的设置，可以利用一个众所周知的事实，即得到的刚度算子与标准的 5 点有限差分离散化具有相同的符号。写出作用于网格函数 $\\{u_{i,j}\\}_{(i,j)\\in\\mathbb{Z}^2}$ 的离散算子 $A$ 的常规 5 点模板形式：\n$$\n(Au)_{i,j} \\;=\\; -u_{i-1,j} + \\left(2\\right)u_{i,j} - u_{i+1,j} \\;+\\; \\epsilon\\left( -u_{i,j-1} + \\left(2\\right)u_{i,j} - u_{i,j+1} \\right).\n$$\n\n- 从第一性原理（双线性有限元的刚度形式及其在无限、均匀网格上的平移不变性）出发，论证当 $0<\\epsilon\\ll 1$ 时，强耦合方向是 $x$ 方向。\n- 沿强耦合方向（即，沿固定 $j$ 的 $x$ 线）推导逐线高斯-赛德尔 (GS) 光滑子。具体来说，写出对 $y$ 索引 $j$ 进行正向扫描的精确逐线求解更新，即对于每个固定的 $j$，沿 $i$ 求解一个三对角系统，你必须指定其对角块。你的回答必须明确给出在每条线上求解的一维三对角“模板”，以及右端项如何依赖于 $y$ 方向上的相邻线，并指明哪个相邻线使用了最近更新的值。\n- 在无限网格上执行局部傅里叶分析 (LFA; Local Fourier Analysis)，以推导该逐线 GS 光滑子单次正向扫描的误差传播算子的标量傅里叶符号 $\\tilde{E}(\\theta_x,\\theta_y)$，其中 $(\\theta_x,\\theta_y)\\in[-\\pi,\\pi]^2$ 是傅里叶频率。清晰地陈述离散算子 $A$ 的符号以及通过你的分裂得到的逐线 GS 误差传播算子的符号。\n- 对于在 $y$ 方向进行半粗化（粗网格仅在 $y$ 方向上分辨率减半）的多重网格方法，相关的高频集是 $\\Theta_{\\mathrm{H}}=\\{(\\theta_x,\\theta_y): \\theta_x\\in[-\\pi,\\pi],\\, \\theta_y\\in[\\pi/2,\\pi]\\}$。使用你的 LFA 符号，确定最坏情况下的光滑因子\n$$\n\\mu_{\\mathrm{smooth}}(\\epsilon) \\;=\\; \\sup_{(\\theta_x,\\theta_y)\\in\\Theta_{\\mathrm{H}}} \\left| \\tilde{E}(\\theta_x,\\theta_y) \\right|.\n$$\n\n请以极限 $\\displaystyle \\lim_{\\epsilon\\to 0^+} \\mu_{\\mathrm{smooth}}(\\epsilon)$ 的精确闭式值的形式给出你的最终答案。不需要四舍五入。最终答案必须是单个表达式。", "solution": "我们从各向异性扩散算子的弱形式开始，\n$$\na(u,v) \\;=\\; \\int_{\\mathbb{R}^2} \\left( \\frac{\\partial u}{\\partial x}\\frac{\\partial v}{\\partial x} + \\epsilon \\frac{\\partial u}{\\partial y}\\frac{\\partial v}{\\partial y} \\right)\\,\\mathrm{d}x\\,\\mathrm{d}y,\n$$\n以及在均匀笛卡尔网格上的 $\\mathbb{Q}_1$ (双线性) 有限元空间。在无限、均匀的网格上，组装后的刚度算子是平移不变的，并且与 $- \\partial_{xx} - \\epsilon \\partial_{yy}$ 的标准 5 点有限差分算子一致（除了一个对于局部傅里叶分析无关紧要的常数 $h^{-2}$ 缩放）。因此，作用于网格函数 $\\{u_{i,j}\\}$，离散算子 $A$ 具有 5 点模板\n$$\n(Au)_{i,j} \\;=\\; -u_{i-1,j} + \\left(2\\right)u_{i,j} - u_{i+1,j} \\;+\\; \\epsilon\\left( -u_{i,j-1} + \\left(2\\right)u_{i,j} - u_{i,j+1} \\right).\n$$\n\n强耦合方向。$x$ 方向的刚度项量级为 $\\mathcal{O}(1)$，而 $y$ 方向的刚度项量级为 $\\mathcal{O}(\\epsilon)$。因此，当 $0<\\epsilon\\ll 1$ 时，$x$ 方向的耦合占主导地位，强耦合方向是 $x$ 方向。\n\n沿 $x$ 线的逐线高斯-赛德尔 (GS) 光滑子。通过在固定的线索引 $j$ 处对 $x$ 和 $y$ 的贡献进行分组来重写 $A$，我们引入一维 $x$ 线算子 $A_x$：\n$$\n(A_x u)_{i,j} \\;=\\; -u_{i-1,j} + \\left(2\\right)u_{i,j} - u_{i+1,j},\n$$\n并观察到\n$$\n(Au)_{i,j} \\;=\\; (A_x u)_{i,j} \\;+\\; \\epsilon\\left(2 u_{i,j} - u_{i,j-1} - u_{i,j+1}\\right).\n$$\n以关于线 $j$ 的分块形式，对角块是\n$$\nB \\;=\\; A_x \\;+\\; \\left(2\\epsilon\\right) I,\n$$\n非对角块是\n$$\nC_{\\mathrm{lower}} \\;=\\; -\\epsilon I \\quad \\text{(耦合到线 } j-1\\text{)}, \\qquad C_{\\mathrm{upper}} \\;=\\; -\\epsilon I \\quad \\text{(耦合到线 } j+1\\text{)}.\n$$\n对线索引 $j$ 的一次正向高斯-赛德尔扫描使用线 $j-1$ 上的最新可用值和线 $j+1$ 上的旧值。因此，对于每个固定的 $j$，线更新 $u^{\\mathrm{new}}_j$ 被定义为三对角系统的精确解\n$$\n\\Big( A_x \\;+\\; \\left(2\\epsilon\\right) I \\Big)\\, u^{\\mathrm{new}}_j \\;=\\; \\epsilon\\, u^{\\mathrm{new}}_{j-1} \\;+\\; \\epsilon\\, u^{\\mathrm{old}}_{j+1} \\;+\\; \\text{(右端项，如果存在)}.\n$$\n用沿线的“模板”来表示，左侧算子是一维三对角模板\n$$\n\\big[-1,\\; 2+2\\epsilon,\\; -1\\big]\n$$\n作用于 $x$ 方向的邻居 $\\{u_{i-1,j},u_{i,j},u_{i+1,j}\\}$，而右端项包含来自相邻线 $j-1$ 和 $j+1$ 的逐线贡献，其中 $u_{j-1}$ 取其最新更新的值，而 $u_{j+1}$ 取其旧值。\n\n局部傅里叶分析 (LFA; Local Fourier Analysis)。在无限网格上，傅里叶模态\n$$\n\\varphi_{\\boldsymbol{\\theta}}(i,j) \\;=\\; \\exp\\!\\big(\\mathrm{i} (i\\,\\theta_x + j\\,\\theta_y)\\big), \\qquad (\\theta_x,\\theta_y)\\in[-\\pi,\\pi]^2,\n$$\n能够对角化所有平移不变算子。$A_x$ 的傅里叶符号是\n$$\n\\tilde{A}_x(\\theta_x) \\;=\\; 2 - 2\\cos(\\theta_x) \\;=\\; 4 \\sin^2\\!\\left(\\frac{\\theta_x}{2}\\right).\n$$\n因此对角块 $B$ 的符号是\n$$\n\\tilde{B}(\\theta_x) \\;=\\; \\tilde{A}_x(\\theta_x) \\;+\\; \\left(2\\epsilon\\right),\n$$\n非对角块的符号是\n$$\n\\widetilde{C}_{\\mathrm{lower}}(\\theta_y) \\;=\\; -\\epsilon\\, \\exp(-\\mathrm{i}\\theta_y), \\qquad \\widetilde{C}_{\\mathrm{upper}}(\\theta_y) \\;=\\; -\\epsilon\\, \\exp(+\\mathrm{i}\\theta_y).\n$$\n对于 $j$ 的分块正向高斯-赛德尔扫描，误差传播算子 $E$ 的标量符号由误差关系 $\\tilde{e}^{\\text{new}} (\\tilde{B} + \\tilde{C}_{\\text{lower}}) = -\\tilde{C}_{\\text{upper}} \\tilde{e}^{\\text{old}}$ 给出。因此，作用于频率为 $(\\theta_x,\\theta_y)$ 的傅里叶模态的误差传播算子的标量符号是\n$$\n\\tilde{E}(\\theta_x,\\theta_y) \\;=\\; - \\frac{\\widetilde{C}_{\\mathrm{upper}}(\\theta_y)}{\\tilde{B}(\\theta_x) + \\widetilde{C}_{\\mathrm{lower}}(\\theta_y)} \\;=\\; \\frac{\\epsilon\\, \\exp(+\\mathrm{i}\\theta_y)}{\\tilde{A}_x(\\theta_x) + \\left(2\\epsilon\\right) - \\epsilon\\, \\exp(-\\mathrm{i}\\theta_y)}.\n$$\n其模为\n$$\n\\left|\\tilde{E}(\\theta_x,\\theta_y)\\right| \\;=\\; \\frac{\\epsilon}{\\left|\\, \\tilde{A}_x(\\theta_x) + \\left(2\\epsilon\\right) - \\epsilon\\, \\exp(-\\mathrm{i}\\theta_y) \\,\\right|}.\n$$\n\n在 $y$ 方向半粗化下的最坏情况光滑因子。在 $y$ 方向进行半粗化时，高频集为 $\\Theta_{\\mathrm{H}}=\\{(\\theta_x,\\theta_y): \\theta_x\\in[-\\pi,\\pi],\\; \\theta_y\\in[\\pi/2,\\pi]\\}$。我们寻求\n$$\n\\mu_{\\mathrm{smooth}}(\\epsilon) \\;=\\; \\sup_{(\\theta_x,\\theta_y)\\in\\Theta_{\\mathrm{H}}} \\left|\\tilde{E}(\\theta_x,\\theta_y)\\right|.\n$$\n记 $\\tilde{A}_x(\\theta_x)=4\\sin^2(\\theta_x/2) \\equiv s_x^2$，其中 $s_x\\in[0,2]$。则\n$$\n\\left|\\tilde{E}(\\theta_x,\\theta_y)\\right| \\;=\\; \\frac{\\epsilon}{\\sqrt{\\left(s_x^2 + 2\\epsilon - \\epsilon\\cos\\theta_y\\right)^2 + \\left(\\epsilon \\sin\\theta_y\\right)^2}}.\n$$\n对于固定的 $\\epsilon>0$，分母随 $s_x^2$ 单调增加，因此在 $\\theta_x\\in[-\\pi,\\pi]$ 上的最坏情况发生在 $s_x^2=0$ 时，即 $\\theta_x=0$。代入 $s_x^2=0$ 得到\n$$\n\\left|\\tilde{E}(0,\\theta_y)\\right| \\;=\\; \\frac{\\epsilon}{\\left|\\, 2\\epsilon - \\epsilon \\exp(-\\mathrm{i}\\theta_y) \\,\\right|} \\;=\\; \\frac{1}{\\left|\\, 2 - \\exp(-\\mathrm{i}\\theta_y) \\,\\right|}.\n$$\n因此，对 $\\epsilon$ 的依赖性消除了，我们必须在 $\\theta_y\\in[\\pi/2,\\pi]$ 上最大化函数\n$$\ng(\\theta_y) \\;=\\; \\frac{1}{\\left|\\, 2 - \\exp(-\\mathrm{i}\\theta_y) \\,\\right|}.\n$$\n计算\n$$\n\\left|\\, 2 - \\exp(-\\mathrm{i}\\theta_y) \\,\\right|^2 \\;=\\; \\left(2 - \\cos\\theta_y\\right)^2 + \\left(\\sin\\theta_y\\right)^2 \\;=\\; 4 - 4\\cos\\theta_y + \\cos^2\\theta_y + \\sin^2\\theta_y \\;=\\; 5 - 4\\cos\\theta_y.\n$$\n在 $\\theta_y\\in[\\pi/2,\\pi]$ 上，我们有 $\\cos\\theta_y\\in[-1, 0]$。为了最大化 $g(\\theta_y)$，我们需要最小化其分母的平方 $5 - 4\\cos\\theta_y$。当 $\\cos\\theta_y$ 取其最大值（即 $0$，在 $\\theta_y=\\pi/2$ 时）时，$5 - 4\\cos\\theta_y$ 达到最小值。因此，\n$$\n\\sup_{\\theta_y\\in[\\pi/2,\\pi]} g(\\theta_y) \\;=\\; \\frac{1}{\\sqrt{5 - 4\\cdot 0}} \\;=\\; \\frac{1}{\\sqrt{5}}.\n$$\n因此，\n$$\n\\mu_{\\mathrm{smooth}}(\\epsilon) \\;=\\; \\sup_{(\\theta_x,\\theta_y)\\in\\Theta_{\\mathrm{H}}} \\left|\\tilde{E}(\\theta_x,\\theta_y)\\right| \\;=\\; \\frac{1}{\\sqrt{5}} \\quad \\text{对于所有 } \\epsilon\\in(0,1],\n$$\n特别地，\n$$\n\\lim_{\\epsilon\\to 0^+} \\mu_{\\mathrm{smooth}}(\\epsilon) \\;=\\; \\frac{1}{\\sqrt{5}}.\n$$\n这表明，沿强耦合（$x$）方向的逐线高斯-赛德尔光滑子，在用于 $y$ 方向半粗化的相关高频集上，具有一个不依赖于 $\\epsilon$ 且严格小于 1 的光滑因子，从而证明了其对于 $\\epsilon\\ll 1$ 时的有效性。", "answer": "$$\\boxed{\\frac{1}{\\sqrt{5}}}$$", "id": "2581527"}]}