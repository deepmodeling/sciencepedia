{"hands_on_practices": [{"introduction": "降阶建模的第一步通常是基于一组高保真解（称为“快照”）来构建一个低维的基。本征正交分解 (Proper Orthogonal Decomposition, POD) 是一种强大的数据驱动方法，用于从快照数据中提取最优的基，它能以最少的基向量捕获最多的系统“能量”或方差。[@problem_id:2593061] 这项实践将指导您完成一个核心的POD计算：确定捕获预定能量阈值所需的最少模态数，并量化截断误差，这是评估降阶模型保真度的基本技能。", "problem": "考虑一族通过有限元法（FEM）离散化的线性、矫顽、参数化的偏微分方程。假设在三个参数值 $\\mu_{1}$、$\\mu_{2}$ 和 $\\mu_{3}$ 处对解流形进行采样，得到三个在 $\\mathbb{R}^{3}$ 中的快照向量，这些向量作为快照矩阵 $S \\in \\mathbb{R}^{3 \\times 3}$ 的列向量。设有限元质量矩阵为对称正定矩阵 $M \\in \\mathbb{R}^{3 \\times 3}$。您需要为这些快照计算关于 $M$-内积的本征正交分解（POD）。\n\n使用以下数据：\n- 质量矩阵为\n$$\nM \\;=\\; \\begin{pmatrix}\n2 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & \\tfrac{1}{2}\n\\end{pmatrix}.\n$$\n- 快照矩阵为\n$$\nS \\;=\\; \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}.\n$$\n\n采用$M$-内积 $\\langle u, v \\rangle_{M} \\equiv u^{\\top} M v$ 和相应的$M$-范数 $\\|u\\|_{M} \\equiv \\sqrt{u^{\\top} M u}$。根据POD的基本定义，定义快照相关矩阵为\n$$\nC \\;=\\; S^{\\top} M S \\;\\in\\; \\mathbb{R}^{3 \\times 3}.\n$$\n设$C$的特征值被记为并按非增顺序排列为 $\\lambda_{1} \\ge \\lambda_{2} \\ge \\lambda_{3} \\ge 0$。由前$r$个模态捕获的POD能量定义为\n$$\n\\mathcal{E}(r) \\;=\\; \\frac{\\sum_{i=1}^{r} \\lambda_{i}}{\\sum_{i=1}^{3} \\lambda_{i}}.\n$$\n\n您的任务是：\n1. 给定目标能量阈值 $\\eta = 0.85$，确定满足 $\\mathcal{E}(r) \\ge \\eta$ 的最小整数 $r$。\n2. 使用快照的POD基本误差恒等式，估计当使用$r$个模态时，在$M$-范数下的总快照重构截断误差，其定义为\n$$\nE_{\\text{trunc}} \\;=\\; \\sum_{i=r+1}^{3} \\lambda_{i}.\n$$\n\n将您的最终答案以双元素行矩阵 $\\begin{pmatrix} r & E_{\\text{trunc}} \\end{pmatrix}$ 的形式报告。不需要四舍五入，要求提供精确值。不需要物理单位。", "solution": "问题陈述已通过评估，被认为是有效的。它在降阶建模的既定理论，特别是本征正交分解（POD）中，具有科学依据。这是一个适定问题，所有必要的数据和定义都已提供，以确保解的唯一性、稳定性和意义。问题的结构是客观且逻辑一致的。我们开始进行求解。\n\n该问题要求计算与给定快照集的本征正交分解相关的两个量。第一个是捕获指定比例总能量所需的最小模态数 $r$。第二个是相应的截断误差。计算需在由质量矩阵 $M$ 导出的内积下进行。\n\n如前所述，POD方法的核心是快照相关矩阵 $C$ 的特征值问题。我们首先计算这个矩阵。提供的定义是\n$$\nC \\;=\\; S^{\\top} M S\n$$\n给定的快照矩阵 $S$ 是 $3 \\times 3$ 的单位矩阵，$S = I = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$。单位矩阵的转置是它本身，$S^{\\top} = I^{\\top} = I$。将这些代入 $C$ 的定义，得到：\n$$\nC \\;=\\; I^{\\top} M I \\;=\\; I M I \\;=\\; M\n$$\n因此，相关矩阵 $C$ 与质量矩阵 $M$ 相同：\n$$\nC \\;=\\; M \\;=\\; \\begin{pmatrix}\n2 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & \\tfrac{1}{2}\n\\end{pmatrix}\n$$\n下一步是确定 $C$ 的特征值。由于 $C$ 是一个对角矩阵，其特征值就是其对角线上的元素。问题要求将这些特征值按非增顺序排列：$\\lambda_{1} \\ge \\lambda_{2} \\ge \\lambda_{3}$。从 $C$ 的对角线，我们确定特征值为 $2$、$1$ 和 $\\frac{1}{2}$。将它们排序后得到：\n$$\n\\lambda_{1} = 2\n$$\n$$\n\\lambda_{2} = 1\n$$\n$$\n\\lambda_{3} = \\frac{1}{2}\n$$\n这些特征值代表了由$M$-内积缩放的快照矩阵的奇异值的平方，它们的和代表了快照中包含的总能量或方差。总能量是相关矩阵的迹，$\\mathrm{Tr}(C)$：\n$$\n\\sum_{i=1}^{3} \\lambda_{i} = \\lambda_{1} + \\lambda_{2} + \\lambda_{3} = 2 + 1 + \\frac{1}{2} = 3.5 = \\frac{7}{2}\n$$\n现在，我们解决第一个任务：找到最小整数 $r$，使得捕获的能量 $\\mathcal{E}(r)$ 达到或超过阈值 $\\eta = 0.85$。捕获的能量定义为：\n$$\n\\mathcal{E}(r) \\;=\\; \\frac{\\sum_{i=1}^{r} \\lambda_{i}}{\\sum_{i=1}^{3} \\lambda_{i}}\n$$\n我们对 $r = 1, 2, \\dots$ 计算 $\\mathcal{E}(r)$，直到满足条件 $\\mathcal{E}(r) \\ge 0.85$。阈值为 $\\eta = 0.85 = \\frac{85}{100} = \\frac{17}{20}$。\n\n对于 $r=1$：\n$$\n\\mathcal{E}(1) = \\frac{\\lambda_{1}}{\\sum_{i=1}^{3} \\lambda_{i}} = \\frac{2}{\\frac{7}{2}} = \\frac{4}{7}\n$$\n我们将此与阈值进行比较。$\\frac{4}{7} \\ge \\frac{17}{20}$ 成立吗？通过交叉相乘，我们比较 $4 \\times 20 = 80$ 和 $7 \\times 17 = 119$。因为 $80 < 119$，所以有 $\\frac{4}{7} < \\frac{17}{20}$。因此，$\\mathcal{E}(1) < 0.85$。一个模态是不够的。\n\n对于 $r=2$：\n$$\n\\mathcal{E}(2) = \\frac{\\lambda_{1} + \\lambda_{2}}{\\sum_{i=1}^{3} \\lambda_{i}} = \\frac{2 + 1}{\\frac{7}{2}} = \\frac{3}{\\frac{7}{2}} = \\frac{6}{7}\n$$\n我们将此与阈值进行比较。$\\frac{6}{7} \\ge \\frac{17}{20}$ 成立吗？通过交叉相乘，我们比较 $6 \\times 20 = 120$ 和 $7 \\times 17 = 119$。因为 $120 > 119$，所以有 $\\frac{6}{7} > \\frac{17}{20}$。因此，$\\mathcal{E}(2) > 0.85$。两个模态是足够的。\n\n因为 $r=1$ 不足而 $r=2$ 足够，所以最小整数是 $r=2$。\n\n第二个任务是计算使用 $r=2$ 个模态时的总快照重构截断误差 $E_{\\text{trunc}}$。提供的定义是：\n$$\nE_{\\text{trunc}} \\;=\\; \\sum_{i=r+1}^{3} \\lambda_{i}\n$$\n对于 $r=2$，这个和变为：\n$$\nE_{\\text{trunc}} \\;=\\; \\sum_{i=2+1}^{3} \\lambda_{i} \\;=\\; \\sum_{i=3}^{3} \\lambda_{i} \\;=\\; \\lambda_{3}\n$$\n代入 $\\lambda_{3}$ 的值：\n$$\nE_{\\text{trunc}} = \\frac{1}{2}\n$$\n这个值代表了被截断模态的能量含量，这恰好是未被前$r$个模态捕获的总能量部分。\n\n所需的两个值是 $r=2$ 和 $E_{\\text{trunc}} = \\frac{1}{2}$。最终答案必须以一个双元素行矩阵的形式报告。", "answer": "$$\n\\boxed{\\begin{pmatrix} 2 & \\frac{1}{2} \\end{pmatrix}}\n$$", "id": "2593061"}, {"introduction": "虽然POD方法对于已有的数据集非常有效，但在参数化问题中，我们如何智能地选择快照来构建一个对整个参数空间都有效的基呢？贪心算法 (Greedy Algorithm) 为此提供了标准的解决方案，它通过一个可靠的误差估计器来迭代地寻找当前降阶模型表现最差的参数点，并将其对应的解加入基中。[@problem_id:2593056] 在本练习中，您将模拟贪心算法的一个关键步骤，通过计算和比较不同参数点的误差指标来决定下一个要添加到基中的快照，从而深入理解降阶基的自适应构建过程。", "problem": "考虑一个通过有限元 (FE) 方法离散化的参数化、强制线性椭圆问题，对于每个参数值 $\\,\\mu \\in \\mathbb{R}_{+}\\,$，得到线性系统 $\\,A(\\mu) u(\\mu) = f\\,$，其具有仿射分解 $\\,A(\\mu) = \\Theta_{1}(\\mu) A_{1} + \\Theta_{2}(\\mu) A_{2}\\,$。假设 $\\,A_{1} \\in \\mathbb{R}^{3 \\times 3}\\,$ 和 $\\,A_{2} \\in \\mathbb{R}^{3 \\times 3}\\,$ 是对称正定矩阵，参数函数为 $\\,\\Theta_{1}(\\mu) = \\mu\\,$ 和 $\\,\\Theta_{2}(\\mu) = 1\\,$，右端项为 $\\,f \\in \\mathbb{R}^{3}\\,$。约化基 (RB) 贪婪算法从一个初始种子参数 $\\,\\mu_{1}\\,$ 和一个训练集 $\\,\\Xi_{\\mathrm{train}}\\,$ 开始。在一次贪婪迭代中，对于 $\\,\\Xi_{\\mathrm{train}}\\,$ 中的每个 $\\,\\mu\\,$，计算当前 RB 空间中的约化 Galerkin 解 $\\,u_{N}(\\mu)\\,$ 和基于残差的误差指示器\n$$\n\\eta(\\mu) \\;=\\; \\frac{\\|r(\\mu)\\|_{V^{*}}}{\\alpha_{\\mathrm{LB}}(\\mu)} \\,,\n$$\n其中 $\\,r(\\mu) = f - A(\\mu) u_{N}(\\mu)\\,$，$\\,\\|\\cdot\\|_{V^{*}}\\,$ 是由有限元试验空间范数诱导的对偶范数，而 $\\,\\alpha_{\\mathrm{LB}}(\\mu)\\,$ 是 $\\,A(\\mu)\\,$ 的强制性常数的一个可靠下界。贪婪更新选择在 $\\,\\Xi_{\\mathrm{train}}\\,$ 上使 $\\,\\eta(\\mu)\\,$ 最大化的参数 $\\,\\mu^{\\star}\\,$。\n\n给定以下具体数据：\n- $\\,A_{1} = \\mathrm{diag}(2,3,4)\\,$, $\\,A_{2} = I_{3}\\,$, and $\\,f = [1,\\,1,\\,1]^{T}\\,$.\n- 试验空间上的有限元内积是 $\\,\\mathbb{R}^{3}\\,$ 上的标准欧几里得内积，因此对偶范数 $\\,\\|r(\\mu)\\|_{V^{*}}\\,$ 等于欧几里得范数 $\\,\\|r(\\mu)\\|_{2}\\,$。\n- 初始种子为 $\\,\\mu_{1} = 1\\,$，RB 空间是一维的，由真值快照 $\\,\\phi = u_{h}(\\mu_{1})\\,$ 张成，其中 $\\,u_{h}(\\mu_{1})\\,$ 是 $\\,A(\\mu_{1}) u = f\\,$ 的精确有限元解。不对 $\\,\\phi\\,$ 进行归一化。\n- 训练集为 $\\,\\Xi_{\\mathrm{train}} = \\{\\,\\tfrac{1}{2},\\,\\tfrac{3}{2},\\,2\\,\\}\\,$.\n- 使用可靠的强制性下界 $\\,\\alpha_{\\mathrm{LB}}(\\mu) = 2\\mu + 1\\,$。\n\n仅使用上述信息并从第一性原理（当前 RB 空间中的 Galerkin 投影、残差的定义、欧几里得对偶范数以及给定的强制性下界）出发，执行一次贪婪迭代，步骤如下：\n1. 对于 $\\,\\Xi_{\\mathrm{train}}\\,$ 中的每个 $\\,\\mu\\,$，在 $\\,\\{\\phi\\}\\,$ 的张成空间中计算约化 Galerkin 近似解 $\\,u_{N}(\\mu)\\,$。\n2. 计算残差 $\\,r(\\mu) = f - A(\\mu) u_{N}(\\mu)\\,$ 及其欧几里得范数。\n3. 为每个候选 $\\mu$ 计算 $\\,\\eta(\\mu) = \\|r(\\mu)\\|_{2} / \\alpha_{\\mathrm{LB}}(\\mu)\\,$。\n4. 在 $\\,\\Xi_{\\mathrm{train}}\\,$ 上选择使 $\\,\\eta(\\mu)\\,$ 最大化的参数 $\\,\\mu^{\\star}\\,$。\n\n将所选参数值 $\\mu^{\\star}$ 报告为单个精确的有理数。不包括单位。无需四舍五入。", "solution": "问题陈述经过严格验证，确认有效。这是一个在降阶建模领域内适定的、有科学依据的、客观的问题。所有必要数据均已提供，不存在内部矛盾或逻辑缺陷。任务是执行标准约化基贪婪算法的一次迭代。我将开始解答。\n\n目标是找到在训练集 $\\Xi_{\\mathrm{train}}$ 上使误差指示器 $\\eta(\\mu)$ 最大化的参数 $\\mu^{\\star}$。\n$$\n\\mu^{\\star} = \\arg\\max_{\\mu \\in \\Xi_{\\mathrm{train}}} \\eta(\\mu) = \\arg\\max_{\\mu \\in \\{\\frac{1}{2}, \\frac{3}{2}, 2\\}} \\frac{\\|r(\\mu)\\|_{2}}{\\alpha_{\\mathrm{LB}}(\\mu)}\n$$\n问题设定在 $\\mathbb{R}^{3}$ 空间中，其中有限元试验空间的内积是标准的欧几里得内积。因此，对偶范数 $\\| \\cdot \\|_{V^*}$ 就是欧几里得范数 $\\| \\cdot \\|_2$。\n\n首先，我们确定一维约化基 (RB) 空间 $V_{N} = \\mathrm{span}\\{\\phi\\}$，其中 $N=1$。基向量 $\\phi$ 是种子参数 $\\mu_1 = 1$ 对应的“真值”有限元 (FE) 解 $u_h(\\mu_1)$。\n依赖于参数的矩阵 $A(\\mu)$ 由 $A(\\mu) = \\Theta_{1}(\\mu) A_{1} + \\Theta_{2}(\\mu) A_{2} = \\mu A_{1} + A_{2}$ 给出。\n给定 $A_{1} = \\mathrm{diag}(2, 3, 4)$ 和 $A_{2} = I_{3} = \\mathrm{diag}(1, 1, 1)$，我们有：\n$$\nA(\\mu) = \\mu \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 3 & 0 \\\\ 0 & 0 & 4 \\end{pmatrix} + \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 2\\mu+1 & 0 & 0 \\\\ 0 & 3\\mu+1 & 0 \\\\ 0 & 0 & 4\\mu+1 \\end{pmatrix}\n$$\n对于 $\\mu_1 = 1$，矩阵为 $A(1) = \\mathrm{diag}(3, 4, 5)$。基向量 $\\phi$ 是 $A(1) \\phi = f$ 的解，其中 $f = [1, 1, 1]^T$。\n$$\n\\begin{pmatrix} 3 & 0 & 0 \\\\ 0 & 4 & 0 \\\\ 0 & 0 & 5 \\end{pmatrix} \\begin{pmatrix} \\phi_1 \\\\ \\phi_2 \\\\ \\phi_3 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\implies \\phi = \\begin{pmatrix} 1/3 \\\\ 1/4 \\\\ 1/5 \\end{pmatrix}\n$$\nRB 空间为 $V_1 = \\mathrm{span}\\{\\phi\\}$。\n\n接下来，对于 $\\Xi_{\\mathrm{train}}$ 中的每个 $\\mu$，我们求解约化 Galerkin 解 $u_N(\\mu) \\in V_1$。该解可以写为 $u_N(\\mu) = c(\\mu) \\phi$，其中 $c(\\mu)$ 是某个标量系数。Galerkin 投影条件要求残差必须与 $V_1$ 的基正交。这里的内积是欧几里得点积。\n$$\n\\phi^T (A(\\mu) u_N(\\mu) - f) = 0\n$$\n代入 $u_N(\\mu) = c(\\mu)\\phi$：\n$$\n\\phi^T (A(\\mu) (c(\\mu)\\phi) - f) = 0 \\implies c(\\mu) (\\phi^T A(\\mu) \\phi) - \\phi^T f = 0\n$$\n这给出系数 $c(\\mu)$：\n$$\nc(\\mu) = \\frac{\\phi^T f}{\\phi^T A(\\mu) \\phi}\n$$\n我们来计算分子和分母。\n$$\n\\phi^T f = \\begin{pmatrix} 1/3 & 1/4 & 1/5 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{3} + \\frac{1}{4} + \\frac{1}{5} = \\frac{20+15+12}{60} = \\frac{47}{60}\n$$\n分母是 $\\mu$ 的一个仿射函数：\n$$\n\\phi^T A(\\mu) \\phi = \\phi^T (\\mu A_1 + A_2) \\phi = \\mu (\\phi^T A_1 \\phi) + (\\phi^T A_2 \\phi)\n$$\n$$\n\\phi^T A_1 \\phi = \\begin{pmatrix} \\frac{1}{3} & \\frac{1}{4} & \\frac{1}{5} \\end{pmatrix} \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 3 & 0 \\\\ 0 & 0 & 4 \\end{pmatrix} \\begin{pmatrix} 1/3 \\\\ 1/4 \\\\ 1/5 \\end{pmatrix} = 2\\left(\\frac{1}{3}\\right)^2 + 3\\left(\\frac{1}{4}\\right)^2 + 4\\left(\\frac{1}{5}\\right)^2 = \\frac{2}{9} + \\frac{3}{16} + \\frac{4}{25} = \\frac{800+675+576}{3600} = \\frac{2051}{3600}\n$$\n$$\n\\phi^T A_2 \\phi = \\phi^T I_3 \\phi = \\|\\phi\\|_2^2 = \\left(\\frac{1}{3}\\right)^2 + \\left(\\frac{1}{4}\\right)^2 + \\left(\\frac{1}{5}\\right)^2 = \\frac{1}{9} + \\frac{1}{16} + \\frac{1}{25} = \\frac{400+225+144}{3600} = \\frac{769}{3600}\n$$\n所以，$\\phi^T A(\\mu) \\phi = \\mu \\frac{2051}{3600} + \\frac{769}{3600} = \\frac{2051\\mu + 769}{3600}$。\n因此系数为：\n$$\nc(\\mu) = \\frac{47/60}{(2051\\mu + 769)/3600} = \\frac{47 \\cdot 60}{2051\\mu + 769} = \\frac{2820}{2051\\mu + 769}\n$$\n现在我们计算残差 $r(\\mu) = f - A(\\mu) u_N(\\mu) = f - c(\\mu) A(\\mu) \\phi$。一个关键的洞察是残差向量 $r(\\mu)$ 在 $\\mu = 1$ 时为零，因为 $u_N(1) = c(1)\\phi$，并且根据构造有 $\\phi = u_h(1)$。我们来检验一下：\n$$\nc(1) = \\frac{47/60}{\\phi^T A(1) \\phi} = \\frac{\\phi^T f}{\\phi^T f} = 1\n$$\n所以 $u_N(1) = 1 \\cdot \\phi = u_h(1)$，并且 $r(1) = f - A(1) u_h(1) = 0$。这意味着残差向量的每个分量都必须包含因子 $(\\mu-1)$。让我们推导 $r(\\mu)$ 的一般形式。\n第 $i$ 个分量是 $r_i(\\mu) = f_i - c(\\mu) (A(\\mu)\\phi)_i$。由于 $A(\\mu)$ 是对角矩阵，$(A(\\mu)\\phi)_i = A_{ii}(\\mu) \\phi_i = (d_i \\mu + 1) \\phi_i$，其中 $d_i$ 是 $A_1$ 的对角元素。\n$$\nr_i(\\mu) = 1 - \\frac{\\phi^T f}{\\phi^T A(\\mu) \\phi} (d_i \\mu + 1) \\phi_i = \\frac{(\\phi^T A(\\mu) \\phi) - (\\phi^T f)(d_i \\mu + 1)\\phi_i}{\\phi^T A(\\mu) \\phi}\n$$\n分子是 $\\mu$ 的线性函数。如前所述，当 $\\mu=1$ 时，它必须为零。因此，它与 $(\\mu-1)$ 成正比。\n我们发现对于某个常数向量 $v$，有 $r(\\mu) = \\frac{1-\\mu}{2051\\mu + 769} v$。我们来求 $v$。\n$$r(\\mu) = \\frac{1-\\mu}{2051\\mu + 769}\\begin{pmatrix} -171 \\\\ 64 \\\\ 205 \\end{pmatrix}$$\n让我们验证第一个分量。分子是 $(\\mu-1)(f_1 (\\phi^T A_1 \\phi) - (\\phi^T f)(A_1\\phi)_1) \\cdot 3600$。\n$(\\phi^T A_1 \\phi) = \\frac{2051}{3600}$，$\\phi^T f = \\frac{47}{60}$，$f_1=1$，$(A_1\\phi)_1 = 2 \\cdot \\frac{1}{3}$。\n$1 \\cdot \\frac{2051}{3600} - \\frac{47}{60} \\cdot \\frac{2}{3} = \\frac{2051 - 94 \\cdot 20}{3600} = \\frac{171}{3600}$。\n所以 $r_1(\\mu) = \\frac{171(\\mu-1)}{2051\\mu+769}$，这与 $\\frac{1-\\mu}{2051\\mu+769}(-171)$ 的形式相符。\n残差的范数为：\n$$\n\\|r(\\mu)\\|_2 = \\frac{|1-\\mu|}{2051\\mu+769} \\left\\| \\begin{pmatrix} -171 \\\\ 64 \\\\ 205 \\end{pmatrix} \\right\\|_2\n$$\n我们计算常数向量 $v = [-171, 64, 205]^T$ 的范数：\n$$\n\\|v\\|_2^2 = (-171)^2 + 64^2 + 205^2 = 29241 + 4096 + 42025 = 75362\n$$\n因此，$\\|r(\\mu)\\|_2 = \\frac{|1-\\mu|\\sqrt{75362}}{2051\\mu+769}$。\n误差指示器为 $\\eta(\\mu) = \\frac{\\|r(\\mu)\\|_2}{\\alpha_{\\mathrm{LB}}(\\mu)}$，其中 $\\alpha_{\\mathrm{LB}}(\\mu) = 2\\mu+1$。\n$$\n\\eta(\\mu) = \\frac{|1-\\mu|\\sqrt{75362}}{(2051\\mu+769)(2\\mu+1)}\n$$\n为了找到最大值点，我们可以忽略常数因子 $\\sqrt{75362}$，转而对 $\\mu \\in \\{\\frac{1}{2}, \\frac{3}{2}, 2\\}$ 最大化函数 $g(\\mu) = \\frac{|1-\\mu|}{(2051\\mu+769)(2\\mu+1)}$。\n\n对于 $\\mu = \\frac{1}{2}$：\n$g(\\frac{1}{2}) = \\frac{|1-\\frac{1}{2}|}{(2051(\\frac{1}{2})+769)(2(\\frac{1}{2})+1)} = \\frac{\\frac{1}{2}}{(1025.5+769)(1+1)} = \\frac{0.5}{1794.5 \\cdot 2} = \\frac{0.5}{3589} = \\frac{1}{7178}$。\n\n对于 $\\mu = \\frac{3}{2}$：\n$g(\\frac{3}{2}) = \\frac{|1-\\frac{3}{2}|}{(2051(\\frac{3}{2})+769)(2(\\frac{3}{2})+1)} = \\frac{\\frac{1}{2}}{(3076.5+769)(3+1)} = \\frac{0.5}{3845.5 \\cdot 4} = \\frac{0.5}{15382} = \\frac{1}{30764}$。\n\n对于 $\\mu = 2$：\n$g(2) = \\frac{|1-2|}{(2051(2)+769)(2(2)+1)} = \\frac{1}{(4102+769)(5)} = \\frac{1}{4871 \\cdot 5} = \\frac{1}{24355}$。\n\n我们必须比较这些值：$g(\\frac{1}{2}) = \\frac{1}{7178}$，$g(\\frac{3}{2}) = \\frac{1}{30764}$ 和 $g(2) = \\frac{1}{24355}$。\n最大值对应于最小的分母。\n因为 $7178 < 24355 < 30764$，所以有 $\\frac{1}{7178} > \\frac{1}{24355} > \\frac{1}{30764}$。\n$g(\\mu)$ 的最大值，也就是 $\\eta(\\mu)$ 的最大值，在 $\\mu = \\frac{1}{2}$ 处取得。\n所选参数为 $\\mu^{\\star} = \\frac{1}{2}$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2593056"}, {"introduction": "参数化降阶模型的真正威力在于其离线-在线 (Offline-Online) 计算分解策略，它将昂贵的、与高维自由度 $n_h$ 相关的计算全部转移到一次性的“离线”阶段完成。这使得在“在线”阶段，我们可以针对新的参数 $\\mu$ 以几乎实时的速度获得解，其计算成本仅依赖于降阶模型的微小规模 $r$。[@problem_id:2593090] 这项实践将让您亲自设计离线阶段的预计算内容，从而推导出支持高效在线查询所需的最小存储量，这对于理解和实现一个高效的降阶模型至关重要。", "problem": "考虑一个源于强制椭圆问题的依赖于参数的有限元法 (FEM) 线性系统，该系统在具有 $n_h$ 个自由度的固定网格上进行离散化。对于紧参数集中的每个参数向量 $\\mu$，组装后的高保真代数系统为\n$$\nA_h(\\mu)\\,u_h(\\mu)=b_h(\\mu), \\quad A_h(\\mu)\\in\\mathbb{R}^{n_h\\times n_h},\\; b_h(\\mu)\\in\\mathbb{R}^{n_h}.\n$$\n假设算子和右端项都具有包含 $Q$ 项的精确仿射参数依赖性，\n$$\nA_h(\\mu)=\\sum_{q=1}^{Q}\\theta_q(\\mu)\\,A_q,\\qquad b_h(\\mu)=\\sum_{q=1}^{Q}\\theta_q(\\mu)\\,b_q,\n$$\n其中 $A_q\\in\\mathbb{R}^{n_h\\times n_h}$ 和 $b_q\\in\\mathbb{R}^{n_h}$ 是独立于参数的系数对象，而 $\\theta_q(\\mu)$ 是已知的标量函数，其求值成本与维度为 $n_h$ 的线性代数运算相比可以忽略不计。令 $V_r\\in\\mathbb{R}^{n_h\\times r}$ 为一个降阶试探基，其中 $r\\ll n_h$ 且 $V_r^{T}V_r=I_r$。关于降阶坐标 $a_r(\\mu)\\in\\mathbb{R}^{r}$ 的降阶 Galerkin 系统是\n$$\nA_r(\\mu)\\,a_r(\\mu)=b_r(\\mu),\\qquad A_r(\\mu)=V_r^{T}A_h(\\mu)V_r,\\quad b_r(\\mu)=V_r^{T}b_h(\\mu).\n$$\n你的任务是针对 $\\mu$ 进行多查询评估，目标是在线组装 $A_r(\\mu)$ 和 $b_r(\\mu)$ 的过程与 $n_h$ 无关。请构建一个离线的、独立于参数的最小预计算集，使得能够仅使用随 $Q$ 和 $r$ 变化的运算来在线组装 $A_r(\\mu)$ 和 $b_r(\\mu)$。假设不利用任何对称性，并且你必须能够在线恢复高保真近似解 $u_h(\\mu)\\approx V_r a_r(\\mu)$。\n\n在这些假设下，确定一个单一表达式 $M(Q,n_h,r)$，给出在离线阶段后必须存储的浮点标量的总数，以支持 $A_r(\\mu)$ 和 $b_r(\\mu)$ 的在线组装以及 $u_h(\\mu)$ 的恢复，同时丢弃任何不再需要的高维对象。将 $M(Q,n_h,r)$ 以闭式符号表达式的形式报告。不要包括函数 $\\theta_q(\\mu)$ 的存储，也不要计算任何可以在线以 $\\mathcal{O}(r^2)$ 或更低的复杂度重新计算且不依赖于 $n_h$ 的量的存储。", "solution": "问题陈述已经过严格验证，并被确定为有效。它具有科学依据，是适定的，并以客观、明确的语言表述。该问题探讨了参数化系统降阶建模中离线-在线计算范式的一个基本方面，这是计算科学与工程中的一个标准课题。\n\n目标是推导出在离线预计算阶段后必须存储的浮点标量总数 $M(Q, n_h, r)$ 的表达式。在指定的约束条件下，这些存储的数据必须足以支持降阶系统的在线组装、其求解以及高保真近似解的重构。在线组装降阶矩阵和向量的过程必须与高保真维度 $n_h$ 无关。\n\n我们将分析在线阶段所需的不同组件的存储需求。\n\n1.  **降阶矩阵 $A_r(\\mu)$ 的组装**：\n    降阶矩阵由 Galerkin 投影 $A_r(\\mu) = V_r^{T}A_h(\\mu)V_r$ 定义。代入 $A_h(\\mu)$ 的给定仿射展开式：\n    $$A_r(\\mu) = V_r^{T}\\left(\\sum_{q=1}^{Q}\\theta_q(\\mu)A_q\\right)V_r$$\n    根据矩阵乘法的线性性质，我们可以将此表达式重新排列为：\n    $$A_r(\\mu) = \\sum_{q=1}^{Q}\\theta_q(\\mu)\\left(V_r^{T}A_qV_r\\right)$$\n    为了使在线组装与维度 $n_h$ 无关，必须在离线阶段计算并存储独立于参数的矩阵 $A_{r,q} \\equiv V_r^{T}A_qV_r$。此计算的输入是高保真分量矩阵 $A_q \\in \\mathbb{R}^{n_h \\times n_h}$ 和降阶基 $V_r \\in \\mathbb{R}^{n_h \\times r}$。每个得到的矩阵 $A_{r,q}$ 的维度是 $r \\times r$。由于问题陈述不利用对称性，我们必须为 $Q$ 个矩阵中的每一个存储全部 $r^2$ 个元素。因此，该分量的标量总数为 $Q r^2$。\n\n2.  **降阶向量 $b_r(\\mu)$ 的组装**：\n    类似地，降阶右端项为 $b_r(\\mu) = V_r^{T}b_h(\\mu)$。我们代入 $b_h(\\mu)$ 的仿射展开式：\n    $$b_r(\\mu) = V_r^{T}\\left(\\sum_{q=1}^{Q}\\theta_q(\\mu)b_q\\right) = \\sum_{q=1}^{Q}\\theta_q(\\mu)\\left(V_r^{T}b_q\\right)$$\n    为确保在线计算与 $n_h$ 无关，必须预先计算并存储独立于参数的向量 $b_{r,q} \\equiv V_r^{T}b_q$。每个向量 $b_{r,q}$ 是一个大小为 $r \\times n_h$ 的矩阵和一个大小为 $n_h \\times 1$ 的向量的乘积，得到一个维度为 $r$ 的向量。共有 $Q$ 个这样的向量。该分量的总存储成本为 $Q r$。\n\n3.  **高保真解 $u_h(\\mu)$ 的重构**：\n    问题要求高保真近似解必须能够使用公式 $u_h(\\mu) \\approx V_r a_r(\\mu)$ 在线恢复，其中 $a_r(\\mu) \\in \\mathbb{R}^r$ 是降阶系统的解。这种重构需要降阶基矩阵 $V_r \\in \\mathbb{R}^{n_h \\times r}$。因此，该矩阵必须作为离线计算数据的一部分进行存储。存储 $V_r$ 所需的标量数量为 $n_h r$。\n\n高维对象 $\\{A_q\\}_{q=1}^Q$ 和 $\\{b_q\\}_{q=1}^Q$ 仅在离线阶段用于计算 $\\{A_{r,q}\\}_{q=1}^Q$ 和 $\\{b_{r,q}\\}_{q=1}^Q$，然后根据问题的指示被丢弃。因此，为在线阶段需要存储的对象集是 $\\{A_{r,q}\\}_{q=1}^Q$、$\\{b_{r,q}\\}_{q=1}^Q$ 和 $V_r$。这是完成所有指定在线任务所需的最小集合。\n\n总存储量 $M(Q, n_h, r)$ 是这三个分量所需标量的总和。\n$$M(Q, n_h, r) = (\\text{存储 } \\{A_{r,q}\\} \\text{所需空间}) + (\\text{存储 } \\{b_{r,q}\\} \\text{所需空间}) + (\\text{存储 } V_r \\text{所需空间})$$\n$$M(Q, n_h, r) = Qr^2 + Qr + n_hr$$\n该表达式代表了为实现降阶模型的高效在线执行而必须存储的浮点标量总数。", "answer": "$$\n\\boxed{Qr^2 + Qr + n_hr}\n$$", "id": "2593090"}]}