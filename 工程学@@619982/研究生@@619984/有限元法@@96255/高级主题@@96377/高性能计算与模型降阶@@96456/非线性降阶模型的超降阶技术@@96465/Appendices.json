{"hands_on_practices": [{"introduction": "超简化的主要驱动力是克服评估非线性项时遇到的计算瓶颈，因为其成本通常与全阶模型的规模成正比。本练习通过建立一个简化的浮点运算（flop）计数模型，为您提供了一个量化该问题的实践机会。通过比较使用和不使用超简化时的在线计算成本，您将推导出理论加速比，从而巩固您对为何这些技术对于实现真正高效的在线仿真是必不可少的理解。[@problem_id:2566979]", "problem": "考虑一个非线性有限元法 (FEM) 半离散模型，其具有 $N$ 个自由度 (DOF)，其内力向量 $f_{\\text{int}}(u) \\in \\mathbb{R}^{N}$ 由空间域上的单元积分定义。设一个降阶模型 (ROM) 使用降阶基 $V \\in \\mathbb{R}^{N \\times r}$ 和降阶坐标 $q \\in \\mathbb{R}^{r}$ 将状态近似为 $u \\approx V q$。内力评估通过使用 $n_q$ 个求积点的数值求积来近似，从而得到 $n_q$ 个局部贡献之和。假设：\n- 每个求积点贡献的评估及其对全局内力的累加（包括本构更新、应变-位移应用和组装）耗费一个恒定的 $c_e$ 浮点运算 (flops)，该成本与 $N$、$r$ 和 $n_q$ 无关。\n- 规模为 $N \\times r$ 的稠密矩阵-向量乘法耗费 $2 N r$ flops。\n- 在超降阶设置中，使用一种基于样本的经验求积或插值，其中有 $s$ 个采样求积点和一个预计算的线性重构算子 $T \\in \\mathbb{R}^{N \\times s}$，使得完整内力可以通过一个线性映射由 $s$ 个采样贡献近似得出。假设评估 $s$ 个样本耗费 $s c_e$ flops，将预计算的采样算子（规模为 $s \\times r$）应用于 $q$ 耗费 $2 r s$ flops，并且通过 $T$ 将 $s$ 个贡献提升为一个 $N$ 维向量耗费 $2 N s$ flops。\n- 所有离线预计算均已完成，不产生在线成本。\n\n从内力定义为求积和以及上述成本模型出发，推导评估 $f_{\\text{int}}(V q)$ 的在线浮点运算计数：\n- 不使用超降阶，和\n- 使用超降阶。\n\n然后，提供加速因子 $S$ 的闭式解析表达式，该因子定义为非超降阶在线成本与超降阶在线成本之比，并用 $n_q$、$N$、$r$、$s$ 和 $c_e$ 表示。您的最终答案必须是关于 $S$ 的单个解析表达式。不要假设任何渐近状态进行简化。无需四舍五入。", "solution": "问题陈述已经过严格验证。\n\n### 步骤 1：提取已知条件\n- 系统：非线性有限元法 (FEM) 半离散模型。\n- 全阶自由度 (DOF)：$N$。\n- 内力向量：$f_{\\text{int}}(u) \\in \\mathbb{R}^{N}$。\n- 降阶基：$V \\in \\mathbb{R}^{N \\times r}$。\n- 降阶坐标：$q \\in \\mathbb{R}^{r}$。\n- 降阶模型 (ROM) 状态近似：$u \\approx V q$。\n- 全模型的求积点数量：$n_q$。\n- 每个求积点评估和组装的成本：$c_e$ flops。\n- 规模为 $N \\times r$ 的稠密矩阵-向量乘法的成本：$2 N r$ flops。\n- 超降阶的采样求积点数量：$s$。\n- 超降阶重构算子：$T \\in \\mathbb{R}^{N \\times s}$。\n- 成本分量 1（超降阶）：评估 $s$ 个样本耗费 $s c_e$ flops。\n- 成本分量 2（超降阶）：将规模为 $s \\times r$ 的预计算采样算子应用于 $q$ 耗费 $2 r s$ flops。\n- 成本分量 3（超降阶）：通过 $T$ 将 $s$ 个贡献提升为一个 $N$ 维向量耗费 $2 N s$ flops。\n- 离线预计算的在线成本为零。\n- 目标：推导在有和没有超降阶的情况下评估 $f_{\\text{int}}(V q)$ 的浮点运算计数，然后推导加速因子 $S$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据、适定且客观。其前提与计算力学中非线性问题的模型降阶和超降阶技术的既定理论一致。所提供的成本模型是用于复杂度分析的标准简化。该问题是自洽的，并提供了推导所需表达式的所有必要信息。不存在矛盾、歧义或事实不准确之处。\n\n### 步骤 3：结论与行动\n问题有效。我们将着手进行完整推导。\n\n目标是确定加速因子 $S$，该因子定义为不使用超降阶的在线计算成本与使用超降阶的成本之比。我们分别将这些成本表示为 $C_{\\text{full}}$ 和 $C_{\\text{hyper}}$。\n\n首先，我们推导非超降阶情况下评估内力向量 $f_{\\text{int}}(V q)$ 的成本。该评估涉及两个顺序步骤：\n1.  计算全阶状态近似向量，$u = V q$。这是降阶基矩阵 $V \\in \\mathbb{R}^{N \\times r}$ 和降阶坐标向量 $q \\in \\mathbb{R}^{r}$ 之间的矩阵-向量乘积。根据所提供的成本模型，此操作的浮点运算 (flops) 次数为 $2 N r$。\n2.  评估状态 $u$ 的非线性内力向量 $f_{\\text{int}}(u)$。问题陈述指出，这是通过在整个域上使用数值求积来执行的，涉及 $n_q$ 个求积点。评估每个求积点的贡献并将其累加到全局力向量中的成本给定为常数 $c_e$。因此，此步骤的总成本是点的数量乘以每个点的成本，即 $n_q c_e$。\n\n非超降阶情况下的总在线成本 $C_{\\text{full}}$ 是这两个步骤的成本之和：\n$$C_{\\text{full}} = n_q c_e + 2 N r$$\n\n接下来，我们推导超降阶评估的成本。问题陈述明确地将超降阶评估的在线成本划分为三个不同的部分：\n1.  在 $s$ 个采样求积点上评估非线性函数，耗费 $s c_e$ flops。\n2.  将预计算的算子应用于降阶坐标 $q$ 以获得采样评估所需的输入，耗费 $2 r s$ flops。\n3.  提升 $s$ 个评估的力贡献以重构完整的 $N$ 维内力向量，耗费 $2 N s$ flops。\n\n超降阶情况下的总在线成本 $C_{\\text{hyper}}$ 是这三个已定义部分的成本之和。\n$$C_{\\text{hyper}} = s c_e + 2 r s + 2 N s$$\n此成本与全系统求积点数量 $n_q$ 无关，这是超降阶的核心目的。\n\n最后，加速因子 $S$ 定义为非超降阶成本与超降阶成本之比。\n$$S = \\frac{C_{\\text{full}}}{C_{\\text{hyper}}}$$\n代入推导出的 $C_{\\text{full}}$ 和 $C_{\\text{hyper}}$ 的表达式，得到加速比的最终闭式表达式：\n$$S = \\frac{n_q c_e + 2 N r}{s c_e + 2 r s + 2 N s}$$\n该表达式也可以通过在分母中提出因子 $s$ 来书写，但这不是必需的。\n$$S = \\frac{n_q c_e + 2 N r}{s(c_e + 2 r + 2 N)}$$\n该表达式提供了指定超降阶方案所实现的理论加速比，它是问题参数 $n_q$、$N$、$r$、$s$ 和单位成本 $c_e$ 的函数。", "answer": "$$\n\\boxed{\\frac{n_q c_e + 2 N r}{s c_e + 2 r s + 2 N s}}\n$$", "id": "2566979"}, {"introduction": "在理解了超简化的动机之后，看清这些方法在机理层面如何运作至关重要。本实践问题将引导您在一个小而明确的非线性系统上，完成一次高斯-牛顿近似张量（Gauss–Newton with Approximated Tensors, GNAT）方法的迭代，这是一种卓越的超简化技术。通过执行这一具体计算，您将直接洞察采样、投影以及求解简化系统之间的相互作用。[@problem_id:2566919]", "problem": "考虑一个由有限元离散化产生的非线性代数残差 $R(u) \\in \\mathbb{R}^{3}$，其中 $u \\in \\mathbb{R}^{3}$ 且\n$$\nR(u) \\equiv \n\\begin{pmatrix}\nu_{1} + u_{2}^{2} - 1 \\\\\n2 u_{1} - u_{3} + \\sin(u_{2}) \\\\\nu_{1} u_{3} - \\tfrac{1}{2}\n\\end{pmatrix}.\n$$\n设降阶模型 (ROM) 的试验基为 $\\Phi \\in \\mathbb{R}^{3 \\times 2}$，残差基为 $Z \\in \\mathbb{R}^{3 \\times 2}$，由下式给出\n$$\n\\Phi = \n\\begin{pmatrix}\n1 & 0 \\\\\n0 & 1 \\\\\n1 & -1\n\\end{pmatrix},\n\\qquad\nZ =\n\\begin{pmatrix}\n1 & 0 \\\\\n0 & 1 \\\\\n0 & 1\n\\end{pmatrix}.\n$$\n设采样矩阵 $P \\in \\mathbb{R}^{3 \\times 2}$ 选择前两个残差分量，因此 $P^{T} \\in \\mathbb{R}^{2 \\times 3}$ 为\n$$\nP^{T} = \n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0\n\\end{pmatrix}.\n$$\n假设当前全状态迭代值为\n$$\nu^{k} = \n\\begin{pmatrix}\n1 \\\\\n0 \\\\\n1\n\\end{pmatrix}.\n$$\n使用带近似张量的高斯-牛顿(GNAT)超降阶法，在 $u^{k}$ 处，利用给定的采样矩阵 $P$ 和残差基 $Z$（可取参考状态为 $0$，以使降阶校正量通过 $\\Phi$ 作用），通过最小化在 $u^{k}$ 处高斯-牛顿线性化中的采样残差，来构建降阶坐标 $\\Delta a \\in \\mathbb{R}^{2}$ 的超降阶高斯-牛顿更新，并计算得到的降阶校正量。将降阶校正量 $\\Delta a$ 以行向量形式报告。无需四舍五入。", "solution": "首先对该问题进行验证，以确保其在科学上是合理的、适定的和客观的。\n\n**1. 已知条件提取：**\n- 非线性残差：$R(u) = \\begin{pmatrix} u_{1} + u_{2}^{2} - 1 \\\\ 2 u_{1} - u_{3} + \\sin(u_{2}) \\\\ u_{1} u_{3} - \\frac{1}{2} \\end{pmatrix} \\in \\mathbb{R}^{3}$，对于 $u \\in \\mathbb{R}^{3}$。\n- 试验基：$\\Phi = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & -1 \\end{pmatrix} \\in \\mathbb{R}^{3 \\times 2}$。\n- 残差基：$Z = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 0 & 1 \\end{pmatrix} \\in \\mathbb{R}^{3 \\times 2}$。\n- 采样矩阵转置：$P^{T} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\end{pmatrix} \\in \\mathbb{R}^{2 \\times 3}$。\n- 当前状态迭代值：$u^{k} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix} \\in \\mathbb{R}^{3}$。\n- 任务是使用带近似张量的高斯-牛顿 (GNAT) 方法计算降阶校正量 $\\Delta a \\in \\mathbb{R}^2$。\n\n**2. 验证：**\n该问题属于模型降阶的数值分析这一成熟领域。所有数学对象（$R(u)$, $\\Phi$, $Z$, $P$, $u^k$）都有明确定义，且它们的维度对于所涉及的运算是一致的。该问题要求应用 GNAT 算法的一个特定（尽管是简化的）版本。所用术语均为该学科的标准术语。不存在科学矛盾、信息缺失或主观因素。因此，该问题被认定为有效。\n\n**3. 求解：**\nGauss-Newton法是一种求解非线性方程组（如 $R(u)=0$）的迭代方法。在每次迭代 $k$ 中，它基于残差在当前迭代点 $u^k$ 处的一阶 Taylor 展开，求解一个线性系统以获得校正量 $\\Delta u$：\n$$R(u^k + \\Delta u) \\approx R(u^k) + J(u^k) \\Delta u$$\n其中 $J(u^k)$ 是 $R(u)$ 在 $u^k$ 处求得的 Jacobian 矩阵。通过将线性化残差设为零来求得更新量：$J(u^k) \\Delta u = -R(u^k)$。\n\n在降阶模型 (ROM) 中，状态校正量被限制在由试验基 $\\Phi$ 的列向量张成的子空间内，因此 $\\Delta u = \\Phi \\Delta a$，其中 $\\Delta a \\in \\mathbb{R}^2$ 是降阶校正向量。线性化残差变为：\n$$R_{lin}(\\Delta a) = R(u^k) + J(u^k) \\Phi \\Delta a$$\n\nGNAT 超降阶技术构建了一个更小、计算成本更低的系统。按照题目要求，这涉及到使用采样矩阵 $P$ 和残差基 $Z$。我们对采样后的线性化残差 $P^T R_{lin}(\\Delta a)$ 应用 Petrov-Galerkin 投影。该投影的测试基由残差基 $Z$ 和采样矩阵 $P$ 导出，得到测试算子 $(P^T Z)^T$。最终的超降阶系统为：\n$$ (P^T Z)^T \\left( P^T R(u^k) + P^T J(u^k) \\Phi \\Delta a \\right) = 0 $$\n这可以重排为一个关于未知降阶校正量 $\\Delta a$ 的线性系统：\n$$ \\left((P^T Z)^T P^T J(u^k) \\Phi\\right) \\Delta a = - (P^T Z)^T P^T R(u^k) $$\n\n我们现在计算必要的组成部分。首先，在当前迭代点 $u^k = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix}$ 处的残差为：\n$$ R(u^k) = \\begin{pmatrix} 1 + 0^2 - 1 \\\\ 2(1) - 1 + \\sin(0) \\\\ (1)(1) - \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ \\frac{1}{2} \\end{pmatrix} $$\n接下来，我们计算 Jacobian 矩阵 $J(u) = \\frac{\\partial R}{\\partial u}$：\n$$ J(u) = \\begin{pmatrix} 1 & 2u_2 & 0 \\\\ 2 & \\cos(u_2) & -1 \\\\ u_3 & 0 & u_1 \\end{pmatrix} $$\n在 $u^k$ 处求值：\n$$ J(u^k) = \\begin{pmatrix} 1 & 2(0) & 0 \\\\ 2 & \\cos(0) & -1 \\\\ 1 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & -1 \\\\ 1 & 0 & 1 \\end{pmatrix} $$\n\n现在我们计算该线性系统的矩阵。涉及测试基的项是：\n$$ P^T Z = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = I_2 $$\n由于 $P^T Z$ 是 $2 \\times 2$ 的单位矩阵 $I_2$，其转置也是如此。因此，关于 $\\Delta a$ 的线性系统简化为：\n$$ \\left(P^T J(u^k) \\Phi\\right) \\Delta a = - P^T R(u^k) $$\n这种简化是因为采样点和残差基的选择导致了投影测试基的配置条件。这也是通过求解采样线性化系统的精确解，即最小化 $\\| P^T R(u^k) + P^T J(u^k) \\Phi \\Delta a \\|_2^2$ 所得到的系统，因为矩阵 $P^T J(u^k) \\Phi$ 是方的且可逆。\n\n我们计算矩阵 $P^T J(u^k) \\Phi$：\n$$ J(u^k) \\Phi = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & -1 \\\\ 1 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & -1 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 2-1 & 1+1 \\\\ 1+1 & -1 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 1 & 2 \\\\ 2 & -1 \\end{pmatrix} $$\n$$ P^T (J(u^k) \\Phi) = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 1 & 2 \\\\ 2 & -1 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 1 & 2 \\end{pmatrix} $$\n以及右侧向量 $-P^T R(u^k)$：\n$$ P^T R(u^k) = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} $$\n因此，关于 $\\Delta a = \\begin{pmatrix} \\Delta a_1 \\\\ \\Delta a_2 \\end{pmatrix}$ 的线性系统是：\n$$ \\begin{pmatrix} 1 & 0 \\\\ 1 & 2 \\end{pmatrix} \\begin{pmatrix} \\Delta a_1 \\\\ \\Delta a_2 \\end{pmatrix} = - \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} $$\n该系统可以通过向前代入法求解。第一个方程是：\n$$ 1 \\cdot \\Delta a_1 + 0 \\cdot \\Delta a_2 = 0 \\implies \\Delta a_1 = 0 $$\n将此结果代入第二个方程：\n$$ 1 \\cdot \\Delta a_1 + 2 \\cdot \\Delta a_2 = -1 \\implies 1(0) + 2 \\Delta a_2 = -1 \\implies 2 \\Delta a_2 = -1 \\implies \\Delta a_2 = -\\frac{1}{2} $$\n降阶校正向量为 $\\Delta a = \\begin{pmatrix} 0 \\\\ -\\frac{1}{2} \\end{pmatrix}$。题目要求以行向量形式给出答案。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & -\\frac{1}{2}\n\\end{pmatrix}\n}\n$$", "id": "2566919"}, {"introduction": "实现计算加速并非唯一目标；保持原始系统的物理特性，如稳定性，是至关重要的。本练习在非线性弹性动力学的背景下，探讨了能量守恒采样与加权（Energy-Conserving Sampling and Weighting, ECSW）方法中的关键概念——能量耗散。您将分析超简化权重符号等看似微小的细节，如何深刻影响动态仿真的长期稳定性，从而突显结构保持近似的重要性。[@problem_id:2566977]", "problem": "考虑一个具有瑞利比例阻尼的半离散非线性弹性动力学有限元模型，其定义在节点位移向量 $\\mathbf{u}(t) \\in \\mathbb{R}^{n}$ 上：\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}} + \\mathbf{C}(\\mathbf{u})\\,\\dot{\\mathbf{u}} + \\mathbf{f}_{\\mathrm{int}}(\\mathbf{u}) = \\mathbf{f}_{\\mathrm{ext}}(t),\n$$\n其中 $\\mathbf{M} \\in \\mathbb{R}^{n \\times n}$ 是对称正定矩阵，$\\mathbf{C}(\\mathbf{u}) = \\alpha\\,\\mathbf{M} + \\beta\\,\\mathbf{K}(\\mathbf{u})$ 且 $\\alpha \\ge 0$ 和 $\\beta \\ge 0$，而 $\\mathbf{K}(\\mathbf{u})$ 是与内力 $\\mathbf{f}_{\\mathrm{int}}(\\mathbf{u}) = \\nabla_{\\mathbf{u}} \\Pi(\\mathbf{u})$ 相关的对称切线刚度，该内力对应于储存能量 $\\Pi(\\mathbf{u})$。离散总能量为\n$$\n\\mathcal{E}(\\mathbf{u},\\dot{\\mathbf{u}}) = \\tfrac{1}{2}\\,\\dot{\\mathbf{u}}^{T}\\mathbf{M}\\dot{\\mathbf{u}} + \\Pi(\\mathbf{u}),\n$$\n因此，在无外力情况 $\\mathbf{f}_{\\mathrm{ext}} = \\mathbf{0}$ 下，我们有能量耗散恒等式\n$$\n\\dot{\\mathcal{E}} = -\\,\\dot{\\mathbf{u}}^{T}\\mathbf{C}(\\mathbf{u})\\,\\dot{\\mathbf{u}} \\le 0.\n$$\n\n通过使用试探/检验基 $\\mathbf{V} \\in \\mathbb{R}^{n \\times r}$（其中 $r \\ll n$）进行伽辽金投影，构建了一个降阶模型（ROM），使得 $\\mathbf{u}(t) \\approx \\mathbf{V}\\mathbf{a}(t)$，其中 $\\mathbf{a}(t) \\in \\mathbb{R}^{r}$ 为降阶坐标。降阶质量为 $\\mathbf{M}_{r} = \\mathbf{V}^{T}\\mathbf{M}\\mathbf{V}$，并且，如果不对质量进行超降阶，$\\mathbf{M}_{r}$ 是对称正定的。为了降低在线成本，能量守恒采样与加权（ECSW）超降阶方法通过对一个采样单元集 $\\mathcal{S}$ 进行加权求和，来近似非线性内力和刚度：\n$$\n\\mathbf{f}_{\\mathrm{int},r}(\\mathbf{a}) \\approx \\sum_{e \\in \\mathcal{S}} w_{e}\\,\\mathbf{f}_{e,r}(\\mathbf{a}), \\qquad \n\\mathbf{K}_{r}(\\mathbf{a}) \\approx \\sum_{e \\in \\mathcal{S}} w_{e}\\,\\mathbf{K}_{e,r}(\\mathbf{a}),\n$$\n其中 $\\mathbf{f}_{e,r}(\\mathbf{a})$ 和 $\\mathbf{K}_{e,r}(\\mathbf{a})$ 分别是与单元 $e$ 相关的单元级降阶内力贡献和切线刚度，而 $w_{e} \\in \\mathbb{R}$ 是在离线阶段确定的恒定权重。假设对于感兴趣的状态区域，每个 $\\mathbf{K}_{e,r}(\\mathbf{a})$ 都是对称半正定的，并且每个单元储存能量 $\\Pi_{e,r}(\\mathbf{a})$ 都是凸的，因此 $\\mathbf{f}_{e,r}(\\mathbf{a}) = \\nabla_{\\mathbf{a}}\\Pi_{e,r}(\\mathbf{a})$。ROM中的刚度比例阻尼使用相同的权重进行超降阶：\n$$\n\\mathbf{C}_{r}(\\mathbf{a}) = \\alpha\\,\\mathbf{M}_{r} + \\beta\\,\\mathbf{K}_{r}(\\mathbf{a}) \\approx \\alpha\\,\\mathbf{M}_{r} + \\beta \\sum_{e \\in \\mathcal{S}} w_{e}\\,\\mathbf{K}_{e,r}(\\mathbf{a}).\n$$\n相应的降阶能量为\n$$\n\\mathcal{E}_{r}(\\mathbf{a},\\dot{\\mathbf{a}}) = \\tfrac{1}{2}\\,\\dot{\\mathbf{a}}^{T}\\mathbf{M}_{r}\\dot{\\mathbf{a}} + \\tilde{\\Pi}_{r}(\\mathbf{a}), \\qquad \\tilde{\\Pi}_{r}(\\mathbf{a}) := \\sum_{e \\in \\mathcal{S}} w_{e}\\,\\Pi_{e,r}(\\mathbf{a}).\n$$\n\n分析允许某些 $w_{e} < 0$ 对无外力ROM的离散能量稳定性造成的影响，并在离线权重确定过程中，找出能够强制权重为正值同时保持能量耗散不等式的合理约束或正则化方法。在上述假设下，选择所有正确的陈述。\n\nA. 如果使用负权重来超降阶瑞利阻尼中与刚度成比例的部分，降阶阻尼矩阵可能会失去半正定性，并且无外力的降阶模型可能违反离散能量耗散不等式，即存在状态使得 $\\dot{\\mathcal{E}}_{r} > 0$。\n\nB. 在离线识别中强制 $w_{e} \\ge 0$，并使用相同的非负权重来近似 $\\mathbf{f}_{\\mathrm{int},r}$ 和刚度比例阻尼，这足以保证在无外力情况下，对于 $\\alpha \\ge 0$ 和 $\\beta \\ge 0$，所有降阶状态都有 $\\dot{\\mathcal{E}}_{r} \\le 0$。\n\nC. 在离线最小二乘训练中，仅对权重添加一个 Tikhonov $\\ell_{2}$ 正则化项，同时允许 $w_{e}$ 为负，可以保证无外力降阶模型的能量稳定性。\n\nD. 将权重参数化为 $w_{e} = \\exp(z_{e})$ 并对无约束变量 $z_{e}$ 求解离线最小二乘问题（可选择性地加上 $\\ell_{2}$ 惩罚项），通过构造强制权重为正值；如果将这些相同的正权重用于刚度比例阻尼，则无外力ROM的离散能量耗散不等式将得到保持。\n\nE. 对降阶基进行关于质量的正交归一化，即选择 $\\mathbf{V}$ 使得 $\\mathbf{V}^{T}\\mathbf{M}\\mathbf{V} = \\mathbf{I}$，可以消除由负权重引起的能量增长的可能性，因此无需对 $w_{e}$ 进行显式的正性强制。", "solution": "问题陈述经核实是科学上合理、适定且自洽的。我们可以开始进行分析。\n\n核心问题是无外力、超降阶的降阶模型（ROM）的稳定性，该稳定性由能量耗散不等式决定。无外力ROM的运动方程为：\n$$\n\\mathbf{M}_{r}\\,\\ddot{\\mathbf{a}} + \\mathbf{C}_{r}(\\mathbf{a})\\,\\dot{\\mathbf{a}} + \\tilde{\\mathbf{f}}_{\\mathrm{int},r}(\\mathbf{a}) = \\mathbf{0}\n$$\n降阶总能量由 $\\mathcal{E}_{r}(\\mathbf{a},\\dot{\\mathbf{a}}) = \\tfrac{1}{2}\\,\\dot{\\mathbf{a}}^{T}\\mathbf{M}_{r}\\dot{\\mathbf{a}} + \\tilde{\\Pi}_{r}(\\mathbf{a})$ 给出。我们计算其时间导数：\n$$\n\\dot{\\mathcal{E}}_{r} = \\frac{d}{dt}\\left( \\tfrac{1}{2}\\,\\dot{\\mathbf{a}}^{T}\\mathbf{M}_{r}\\dot{\\mathbf{a}} + \\tilde{\\Pi}_{r}(\\mathbf{a}) \\right) = \\dot{\\mathbf{a}}^{T}\\mathbf{M}_{r}\\ddot{\\mathbf{a}} + (\\nabla_{\\mathbf{a}}\\tilde{\\Pi}_{r}(\\mathbf{a}))^{T}\\dot{\\mathbf{a}}\n$$\n这里我们利用了降阶质量矩阵 $\\mathbf{M}_{r}$ 的对称性。问题陈述提供了一个一致的表述，其中超降阶内力是超降阶势能的梯度，即 $\\tilde{\\mathbf{f}}_{\\mathrm{int},r}(\\mathbf{a}) = \\nabla_{\\mathbf{a}}\\tilde{\\Pi}_{r}(\\mathbf{a})$。将此代入能量速率表达式中，得到：\n$$\n\\dot{\\mathcal{E}}_{r} = \\dot{\\mathbf{a}}^{T}\\mathbf{M}_{r}\\ddot{\\mathbf{a}} + \\tilde{\\mathbf{f}}_{\\mathrm{int},r}(\\mathbf{a})^{T}\\dot{\\mathbf{a}} = \\dot{\\mathbf{a}}^{T} \\left( \\mathbf{M}_{r}\\ddot{\\mathbf{a}} + \\tilde{\\mathbf{f}}_{\\mathrm{int},r}(\\mathbf{a}) \\right)\n$$\n根据运动方程，我们代入 $\\mathbf{M}_{r}\\ddot{\\mathbf{a}} + \\tilde{\\mathbf{f}}_{\\mathrm{int},r}(\\mathbf{a}) = -\\mathbf{C}_{r}(\\mathbf{a})\\,\\dot{\\mathbf{a}}$。这给出了能量变化率：\n$$\n\\dot{\\mathcal{E}}_{r} = \\dot{\\mathbf{a}}^{T} \\left( -\\mathbf{C}_{r}(\\mathbf{a})\\,\\dot{\\mathbf{a}} \\right) = -\\dot{\\mathbf{a}}^{T}\\mathbf{C}_{r}(\\mathbf{a})\\dot{\\mathbf{a}}\n$$\n我们利用了 $\\mathbf{C}_{r}(\\mathbf{a})$ 是对称的这一事实，因为 $\\mathbf{M}_{r}$ 和所有 $\\mathbf{K}_{e,r}(\\mathbf{a})$ 都被给定为对称的。离散能量耗散不等式 $\\dot{\\mathcal{E}}_{r} \\le 0$ 对所有可能的运动都成立，当且仅当对于任意向量 $\\dot{\\mathbf{a}} \\in \\mathbb{R}^{r}$，二次型 $\\dot{\\mathbf{a}}^{T}\\mathbf{C}_{r}(\\mathbf{a})\\dot{\\mathbf{a}} \\ge 0$ 成立。这就是降阶阻尼矩阵 $\\mathbf{C}_{r}(\\mathbf{a})$ 为对称半正定（SPSD）的定义。\n\n降阶阻尼矩阵的结构为：\n$$\n\\mathbf{C}_{r}(\\mathbf{a}) = \\alpha\\,\\mathbf{M}_{r} + \\beta \\sum_{e \\in \\mathcal{S}} w_{e}\\,\\mathbf{K}_{e,r}(\\mathbf{a})\n$$\n给定条件是 $\\alpha \\ge 0$, $\\beta \\ge 0$，$\\mathbf{M}_{r}$ 是对称正定 (SPD) 的，并且每个单元降阶刚度 $\\mathbf{K}_{e,r}(\\mathbf{a})$ 是 SPSD 的。因此矩阵 $\\alpha\\,\\mathbf{M}_{r}$ 是 SPSD 的。$\\mathbf{C}_{r}(\\mathbf{a})$ 的正定性关键取决于 $\\beta \\sum_{e \\in \\mathcal{S}} w_{e}\\,\\mathbf{K}_{e,r}(\\mathbf{a})$ 这一项，从而取决于权重 $w_{e}$ 的符号。\n\n让我们逐一分析每个选项。\n\n**A. 如果使用负权重来超降阶瑞利阻尼中与刚度成比例的部分，降阶阻尼矩阵可能会失去半正定性，并且无外力的降阶模型可能违反离散能量耗散不等式，即存在状态使得 $\\dot{\\mathcal{E}}_{r} > 0$。**\n\n$\\mathbf{K}_{\\mathrm{hyp},r}(\\mathbf{a}) := \\sum_{e \\in \\mathcal{S}} w_{e}\\,\\mathbf{K}_{e,r}(\\mathbf{a})$ 这一项是 SPSD 矩阵 $\\mathbf{K}_{e,r}(\\mathbf{a})$ 的线性组合。如果一个或多个权重 $w_{e}$ 为负，这个组合不能保证是 SPSD 的。可以构造一个状态 $\\mathbf{a}$ 和一个向量 $\\mathbf{v} \\in \\mathbb{R}^{r}$ 使得 $\\mathbf{v}^{T}\\mathbf{K}_{\\mathrm{hyp},r}(\\mathbf{a})\\mathbf{v} < 0$。因此，完整阻尼矩阵的二次型 $\\mathbf{v}^{T}\\mathbf{C}_{r}(\\mathbf{a})\\mathbf{v} = \\alpha\\,\\mathbf{v}^{T}\\mathbf{M}_{r}\\mathbf{v} + \\beta\\,\\mathbf{v}^{T}\\mathbf{K}_{\\mathrm{hyp},r}(\\mathbf{a})\\mathbf{v}$ 可能变为负值，前提是第二项为负且其绝对值足够大，以至于超过了第一项的正值。如果 $\\mathbf{C}_{r}(\\mathbf{a})$ 不是 SPSD 的，那么对于某个降阶速度 $\\dot{\\mathbf{a}}$，我们有 $\\dot{\\mathbf{a}}^{T}\\mathbf{C}_{r}(\\mathbf{a})\\dot{\\mathbf{a}} < 0$。这将导致 $\\dot{\\mathcal{E}}_{r} = -\\dot{\\mathbf{a}}^{T}\\mathbf{C}_{r}(\\mathbf{a})\\dot{\\mathbf{a}} > 0$，表明了虚假的能量生成和不稳定性。因此，该陈述是对潜在后果的正确描述。\n\n**结论：正确**\n\n**B. 在离线识别中强制 $w_{e} \\ge 0$，并使用相同的非负权重来近似 $\\mathbf{f}_{\\mathrm{int},r}$ 和刚度比例阻尼，这足以保证在无外力情况下，对于 $\\alpha \\ge 0$ 和 $\\beta \\ge 0$，所有降阶状态都有 $\\dot{\\mathcal{E}}_{r} \\le 0$。**\n\n如果所有权重 $w_{e} \\ge 0$，那么矩阵 $\\sum_{e \\in \\mathcal{S}} w_{e}\\,\\mathbf{K}_{e,r}(\\mathbf{a})$ 成为 SPSD 矩阵的非负线性组合。这样的组合本身就是 SPSD 的。完整的降阶阻尼矩阵 $\\mathbf{C}_{r}(\\mathbf{a}) = \\alpha\\,\\mathbf{M}_{r} + \\beta\\,\\sum_{e \\in \\mathcal{S}} w_{e}\\,\\mathbf{K}_{e,r}(\\mathbf{a})$ 则是两个 SPSD 矩阵（因为 $\\alpha\\mathbf{M}_r$ 是 SPSD 的）的和，其结果也是一个 SPSD 矩阵。因此，对于所有的 $\\dot{\\mathbf{a}}$ 都有 $\\dot{\\mathbf{a}}^{T}\\mathbf{C}_{r}(\\mathbf{a})\\dot{\\mathbf{a}} \\ge 0$，这就保证了 $\\dot{\\mathcal{E}}_{r} \\le 0$。权重的非负性是保持耗散不等式的充分条件。\n\n**结论：正确**\n\n**C. 在离线最小二乘训练中，仅对权重添加一个 Tikhonov $\\ell_{2}$ 正则化项，同时允许 $w_{e}$ 为负，可以保证无外力降阶模型的能量稳定性。**\n\nTikhonov 或 $\\ell_{2}$ 正则化，是在待最小化的目标函数中增加一个与权重平方和 $\\lambda \\sum_{e} w_e^2$ 成比例的惩罚项。这会抑制产生较大的权重值，但并不约束其符号。最优权重 $w_e$ 仍然可能为负。正如在选项 A 的分析中所确立的，负权重的存在可能导致违反能量耗散不等式。因此，单独使用 $\\ell_{2}$ 正则化无法保证稳定性。\n\n**结论：不正确**\n\n**D. 将权重参数化为 $w_{e} = \\exp(z_{e})$ 并对无约束变量 $z_{e}$ 求解离线最小二乘问题（可选择性地加上 $\\ell_{2}$ 惩罚项），通过构造强制权重为正值；如果将这些相同的正权重用于刚度比例阻尼，则无外力ROM的离散能量耗散不等式将得到保持。**\n\n参数化 $w_{e} = \\exp(z_{e})$ 将任意实变量 $z_{e}$ 映射到一个严格为正的权重 $w_{e}$。通过对无约束变量 $z_e$ 进行优化，我们内在地强制了对所有 $e$ 的约束 $w_{e} > 0$。由于 $w_{e} > 0$ 意味着 $w_{e} \\ge 0$，该方法产生的权重满足选项 B 中分析的稳定性充分条件。将这些正权重同时用于内力和刚度比例阻尼，可确保降阶阻尼矩阵 $\\mathbf{C}_{r}(\\mathbf{a})$ 是 SPSD 的，从而保持耗散不等式 $\\dot{\\mathcal{E}}_{r} \\le 0$。对 $z_e$ 的可选惩罚项会影响最终的权重值，但不会改变其正性。\n\n**结论：正确**\n\n**E. 对降阶基进行关于质量的正交归一化，即选择 $\\mathbf{V}$ 使得 $\\mathbf{V}^{T}\\mathbf{M}\\mathbf{V} = \\mathbf{I}$，可以消除由负权重引起的能量增长的可能性，因此无需对 $w_{e}$ 进行显式的正性强制。**\n\n对基进行关于质量矩阵的正交归一化，将降阶质量矩阵简化为单位矩阵，即 $\\mathbf{M}_{r} = \\mathbf{I}$。降阶阻尼矩阵变为 $\\mathbf{C}_{r}(\\mathbf{a}) = \\alpha\\,\\mathbf{I} + \\beta \\sum_{e \\in \\mathcal{S}} w_{e}\\,\\mathbf{K}_{e,r}(\\mathbf{a})$。虽然这简化了质量比例项，但它并不影响刚度比例项，而后者才是潜在不稳定性的来源。如果使用负权重 $w_e$，矩阵 $\\sum_{e \\in \\mathcal{S}} w_{e}\\,\\mathbf{K}_{e,r}(\\mathbf{a})$ 仍然可能具有负特征值。如果这一项的最小特征值 $\\lambda_{\\min} < 0$，那么 $\\mathbf{C}_{r}(\\mathbf{a})$ 的最小特征值将是 $\\alpha + \\beta\\lambda_{\\min}$，这个值可能为负。基的变换不能解决由 SPSD 矩阵线性组合中的负系数引起的基本代数问题。能量增长的风险依然存在，为保证稳定性，仍需要对权重进行显式的正性强制。\n\n**结论：不正确**", "answer": "$$\\boxed{ABD}$$", "id": "2566977"}]}