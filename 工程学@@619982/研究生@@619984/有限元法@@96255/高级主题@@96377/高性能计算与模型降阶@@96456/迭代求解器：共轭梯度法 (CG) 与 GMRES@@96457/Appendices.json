{"hands_on_practices": [{"introduction": "本练习将引导你亲手完成共轭梯度（CG）算法的完整计算过程，该算法是求解对称正定（SPD）线性系统的基石。通过对一个简单的系统进行两轮迭代，你将具体地理解算法是如何系统性地最小化能量泛函的。这个实践将强化你对残差（$r_k$）、$A$-共轭搜索方向（$p_k$）以及最优步长（$\\alpha_k$）等核心概念的理解，从而揭示该方法优美的收敛特性。[@problem_id:2570866]", "problem": "考虑一个源于双自由度有限元模型的对称正定 (SPD) 线性系统，其刚度矩阵为 $A=\\begin{bmatrix}2&0\\\\0&1\\end{bmatrix}$，右端项为 $b=\\begin{bmatrix}2\\\\1\\end{bmatrix}$，初始猜测值为 $x_{0}=\\begin{bmatrix}0\\\\0\\end{bmatrix}$。从 $x_{0}$ 开始，应用共轭梯度 (CG) 法进行 2 次迭代。请从适用于 SPD 系统的第一性原理出发：二次能量 $J(x)=\\tfrac{1}{2}x^{\\mathsf{T}}A x-b^{\\mathsf{T}}x$、残差 $r_{k}=b-Ax_{k}$、搜索子空间 $x_{k+1}\\in x_{k}+\\operatorname{span}\\{p_{k}\\}$、搜索方向的 $A$-共轭性 $p_{i}^{\\mathsf{T}}A p_{j}=0$（对于 $i\\neq j$），以及通过沿 $p_{k}$ 方向最小化 $J$ 导出的残差与当前搜索方向的正交性。仅使用这些基本事实，首先推导出步长 $\\alpha_{k}$ 和递推系数 $\\beta_{k}$ 关于 $r_{k}$、$p_{k}$ 和 $A$ 的表达式，然后进行计算，以显式和精确有理数形式获得以下各量：$\\alpha_{0}$、$\\beta_{0}$、$\\alpha_{1}$、$\\beta_{1}$、迭代值 $x_{1}$ 和 $x_{2}$、残差 $r_{0}$、$r_{1}$、$r_{2}$ 以及搜索方向 $p_{0}$、$p_{1}$、$p_{2}$。\n\n将您的最终结果以单行矩阵的形式报告，并严格保持以下顺序：\n$$\\bigl[\\alpha_{0},\\,\\beta_{0},\\,\\alpha_{1},\\,\\beta_{1},\\,x_{0,1},\\,x_{0,2},\\,x_{1,1},\\,x_{1,2},\\,x_{2,1},\\,x_{2,2},\\,r_{0,1},\\,r_{0,2},\\,r_{1,1},\\,r_{1,2},\\,r_{2,1},\\,r_{2,2},\\,p_{0,1},\\,p_{0,2},\\,p_{1,1},\\,p_{1,2},\\,p_{2,1},\\,p_{2,2}\\bigr].$$\n\n所有量均需精确表示；无需进行舍入。", "solution": "所述问题具有科学性、适定性、客观性和自洽性。这是应用共轭梯度(CG)法的一个典型练习。因此，该问题被认为是有效的，并将提供完整的解答。\n\n该问题要求从第一性原理推导共轭梯度算法的参数，然后对给定的线性系统执行两次迭代。\n\n**1. CG 算法参数的推导**\n\n设线性系统为 $Ax = b$，其中 $A$ 是一个 $n \\times n$ 的对称正定 (SPD) 矩阵。解 $x$ 唯一地最小化二次能量泛函 $J(x) = \\frac{1}{2}x^{\\mathsf{T}}A x - b^{\\mathsf{T}}x$。CG 法是一个迭代过程，它生成一系列收敛于真实解的近似值 $x_k$。\n\n该方法由以下更新规则定义：\n$x_{k+1} = x_k + \\alpha_k p_k$\n$r_{k+1} = r_k - \\alpha_k A p_k$\n$p_{k+1} = r_{k+1} + \\beta_k p_k$\n其中 $r_k = b - Ax_k$ 是第 $k$ 步的残差，$p_k$ 是搜索方向，$\\alpha_k$ 是步长，$\\beta_k$ 是一个组合新残差与前一搜索方向的系数。\n\n**步长 $\\alpha_k$ 的推导：**\n选择步长 $\\alpha_k$ 以使能量泛函 $J(x_{k+1})$ 沿搜索方向 $p_k$ 最小化。也就是说，我们对 $J(x_k + \\alpha_k p_k)$ 关于 $\\alpha_k$ 进行最小化。\n$$J(x_k + \\alpha_k p_k) = \\frac{1}{2}(x_k + \\alpha_k p_k)^{\\mathsf{T}}A(x_k + \\alpha_k p_k) - b^{\\mathsf{T}}(x_k + \\alpha_k p_k)$$\n为求最小值，我们将关于 $\\alpha_k$ 的导数设为零：\n$$\\frac{d}{d\\alpha_k} J(x_k + \\alpha_k p_k) = 0$$\n利用矩阵微积分的乘法法则和 $A$ 的对称性，我们得到：\n$$p_k^{\\mathsf{T}}A(x_k + \\alpha_k p_k) - p_k^{\\mathsf{T}}b = 0$$\n$$p_k^{\\mathsf{T}}Ax_k + \\alpha_k p_k^{\\mathsf{T}}Ap_k - p_k^{\\mathsf{T}}b = 0$$\n$$\\alpha_k (p_k^{\\mathsf{T}}Ap_k) = p_k^{\\mathsf{T}}(b - Ax_k)$$\n利用残差的定义 $r_k = b - Ax_k$，我们得到：\n$$\\alpha_k = \\frac{p_k^{\\mathsf{T}}r_k}{p_k^{\\mathsf{T}}Ap_k}$$\n这是一个通用表达式。对于 CG 算法，可以证明 $p_k^{\\mathsf{T}}r_k = r_k^{\\mathsf{T}}r_k$。从 $p_0 = r_0$ 开始，对于 $k=0$ 这是平凡的。对于 $k>0$, $p_k = r_k + \\beta_{k-1}p_{k-1}$。因此，$p_k^{\\mathsf{T}}r_k = (r_k + \\beta_{k-1}p_{k-1})^{\\mathsf{T}}r_k = r_k^{\\mathsf{T}}r_k + \\beta_{k-1}p_{k-1}^{\\mathsf{T}}r_k$。产生 $\\alpha_{k-1}$ 的最优性条件等价于 $r_k^{\\mathsf{T}}p_{k-1}=0$。因此，$p_{k-1}^{\\mathsf{T}}r_k=0$，这将表达式简化为 $p_k^{\\mathsf{T}}r_k = r_k^{\\mathsf{T}}r_k$。\n因此，步长的标准公式为：\n$$\\alpha_k = \\frac{r_k^{\\mathsf{T}}r_k}{p_k^{\\mathsf{T}}Ap_k}$$\n\n**递推系数 $\\beta_k$ 的推导：**\n搜索方向必须是 $A$-共轭的，即 $p_{k+1}^{\\mathsf{T}}A p_j = 0$ 对所有 $j \\le k$ 成立。我们对 $j=k$ 强制执行此条件：\n$$p_{k+1}^{\\mathsf{T}}A p_k = 0$$\n代入新搜索方向的表达式 $p_{k+1} = r_{k+1} + \\beta_k p_k$：\n$$(r_{k+1} + \\beta_k p_k)^{\\mathsf{T}}A p_k = 0$$\n$$r_{k+1}^{\\mathsf{T}}A p_k + \\beta_k p_k^{\\mathsf{T}}A p_k = 0$$\n求解 $\\beta_k$：\n$$\\beta_k = - \\frac{r_{k+1}^{\\mathsf{T}}A p_k}{p_k^{\\mathsf{T}}A p_k}$$\n这个公式可以被简化。从残差更新公式 $r_{k+1} = r_k - \\alpha_k A p_k$，我们可以写出 $A p_k = \\frac{1}{\\alpha_k}(r_k - r_{k+1})$。将此代入分子中：\n$$\\beta_k = - \\frac{r_{k+1}^{\\mathsf{T}}\\left(\\frac{1}{\\alpha_k}(r_k - r_{k+1})\\right)}{p_k^{\\mathsf{T}}A p_k} = -\\frac{1}{\\alpha_k} \\frac{r_{k+1}^{\\mathsf{T}}r_k - r_{k+1}^{\\mathsf{T}}r_{k+1}}{p_k^{\\mathsf{T}}A p_k}$$\nCG 的一个基本性质是残差的正交性，即 $r_{k+1}^{\\mathsf{T}}r_k = 0$。这可以通过对搜索方向的 $A$-共轭性使用归纳法来证明。因此，表达式变为：\n$$\\beta_k = \\frac{1}{\\alpha_k} \\frac{r_{k+1}^{\\mathsf{T}}r_{k+1}}{p_k^{\\mathsf{T}}A p_k}$$\n现在，代入 $\\alpha_k = \\frac{r_k^{\\mathsf{T}}r_k}{p_k^{\\mathsf{T}}Ap_k}$ 的表达式，这意味着 $\\alpha_k p_k^{\\mathsf{T}}Ap_k = r_k^{\\mathsf{T}}r_k$：\n$$\\beta_k = \\frac{r_{k+1}^{\\mathsf{T}}r_{k+1}}{r_k^{\\mathsf{T}}r_k}$$\n\n**2. CG 算法的应用**\n\n问题给定：\n$A = \\begin{bmatrix} 2 & 0 \\\\ 0 & 1 \\end{bmatrix}$，$b = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix}$，以及初始猜测值 $x_0 = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$。\n\n**迭代 $k=0$：**\n初始残差：\n$r_0 = b - A x_0 = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix} - \\begin{bmatrix} 2 & 0 \\\\ 0 & 1 \\end{bmatrix}\\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix}$。\n初始搜索方向：\n$p_0 = r_0 = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix}$。\n残差的内积：\n$r_0^{\\mathsf{T}}r_0 = 2^2 + 1^2 = 5$。\n计算 $A p_0$：\n$A p_0 = \\begin{bmatrix} 2 & 0 \\\\ 0 & 1 \\end{bmatrix}\\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 4 \\\\ 1 \\end{bmatrix}$。\n计算 $p_0^{\\mathsf{T}}A p_0$：\n$p_0^{\\mathsf{T}}A p_0 = \\begin{bmatrix} 2 & 1 \\end{bmatrix} \\begin{bmatrix} 4 \\\\ 1 \\end{bmatrix} = 8 + 1 = 9$。\n步长 $\\alpha_0$：\n$\\alpha_0 = \\frac{r_0^{\\mathsf{T}}r_0}{p_0^{\\mathsf{T}}A p_0} = \\frac{5}{9}$。\n更新迭代值 $x_1$：\n$x_1 = x_0 + \\alpha_0 p_0 = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} + \\frac{5}{9}\\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 10/9 \\\\ 5/9 \\end{bmatrix}$。\n更新残差 $r_1$：\n$r_1 = r_0 - \\alpha_0 A p_0 = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix} - \\frac{5}{9}\\begin{bmatrix} 4 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 18/9 - 20/9 \\\\ 9/9 - 5/9 \\end{bmatrix} = \\begin{bmatrix} -2/9 \\\\ 4/9 \\end{bmatrix}$。\n新残差的内积：\n$r_1^{\\mathsf{T}}r_1 = (-\\frac{2}{9})^2 + (\\frac{4}{9})^2 = \\frac{4}{81} + \\frac{16}{81} = \\frac{20}{81}$。\n递推系数 $\\beta_0$：\n$\\beta_0 = \\frac{r_1^{\\mathsf{T}}r_1}{r_0^{\\mathsf{T}}r_0} = \\frac{20/81}{5} = \\frac{4}{81}$。\n更新搜索方向 $p_1$：\n$p_1 = r_1 + \\beta_0 p_0 = \\begin{bmatrix} -2/9 \\\\ 4/9 \\end{bmatrix} + \\frac{4}{81}\\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} -18/81 \\\\ 36/81 \\end{bmatrix} + \\begin{bmatrix} 8/81 \\\\ 4/81 \\end{bmatrix} = \\begin{bmatrix} -10/81 \\\\ 40/81 \\end{bmatrix}$。\n\n**迭代 $k=1$：**\n我们有 $r_1 = \\begin{bmatrix} -2/9 \\\\ 4/9 \\end{bmatrix}$、$p_1 = \\begin{bmatrix} -10/81 \\\\ 40/81 \\end{bmatrix}$ 以及 $r_1^{\\mathsf{T}}r_1 = \\frac{20}{81}$。\n计算 $A p_1$：\n$Ap_1 = \\begin{bmatrix} 2 & 0 \\\\ 0 & 1 \\end{bmatrix}\\begin{bmatrix} -10/81 \\\\ 40/81 \\end{bmatrix} = \\begin{bmatrix} -20/81 \\\\ 40/81 \\end{bmatrix}$。\n计算 $p_1^{\\mathsf{T}}A p_1$：\n$p_1^{\\mathsf{T}}A p_1 = \\begin{bmatrix} -10/81 & 40/81 \\end{bmatrix} \\begin{bmatrix} -20/81 \\\\ 40/81 \\end{bmatrix} = \\frac{200}{81^2} + \\frac{1600}{81^2} = \\frac{1800}{6561}$。\n步长 $\\alpha_1$：\n$\\alpha_1 = \\frac{r_1^{\\mathsf{T}}r_1}{p_1^{\\mathsf{T}}A p_1} = \\frac{20/81}{1800/6561} = \\frac{20}{81} \\cdot \\frac{6561}{1800} = \\frac{20 \\cdot 81}{1800} = \\frac{1620}{1800} = \\frac{9}{10}$。\n更新迭代值 $x_2$：\n$x_2 = x_1 + \\alpha_1 p_1 = \\begin{bmatrix} 10/9 \\\\ 5/9 \\end{bmatrix} + \\frac{9}{10}\\begin{bmatrix} -10/81 \\\\ 40/81 \\end{bmatrix} = \\begin{bmatrix} 10/9 \\\\ 5/9 \\end{bmatrix} + \\begin{bmatrix} -1/9 \\\\ 4/9 \\end{bmatrix} = \\begin{bmatrix} 9/9 \\\\ 9/9 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$。\n更新残差 $r_2$：\n$r_2 = r_1 - \\alpha_1 A p_1 = \\begin{bmatrix} -2/9 \\\\ 4/9 \\end{bmatrix} - \\frac{9}{10}\\begin{bmatrix} -20/81 \\\\ 40/81 \\end{bmatrix} = \\begin{bmatrix} -2/9 \\\\ 4/9 \\end{bmatrix} - \\begin{bmatrix} -2/9 \\\\ 4/9 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$。\n新残差的内积：\n$r_2^{\\mathsf{T}}r_2 = 0^2 + 0^2 = 0$。\n递推系数 $\\beta_1$：\n$\\beta_1 = \\frac{r_2^{\\mathsf{T}}r_2}{r_1^{\\mathsf{T}}r_1} = \\frac{0}{20/81} = 0$。\n更新搜索方向 $p_2$：\n$p_2 = r_2 + \\beta_1 p_1 = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} + 0 \\cdot \\begin{bmatrix} -10/81 \\\\ 40/81 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$。\n算法在 2 步内收敛到精确解 $x=\\begin{bmatrix}1\\\\1\\end{bmatrix}$，这对于一个 $2 \\times 2$ 系统是符合预期的。\n\n**各量汇总：**\n$\\alpha_0 = 5/9$\n$\\beta_0 = 4/81$\n$\\alpha_1 = 9/10$\n$\\beta_1 = 0$\n$x_0 = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$\n$x_1 = \\begin{bmatrix} 10/9 \\\\ 5/9 \\end{bmatrix}$\n$x_2 = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$\n$r_0 = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix}$\n$r_1 = \\begin{bmatrix} -2/9 \\\\ 4/9 \\end{bmatrix}$\n$r_2 = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$\n$p_0 = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix}$\n$p_1 = \\begin{bmatrix} -10/81 \\\\ 40/81 \\end{bmatrix}$\n$p_2 = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$\n这些量将被组装到最终的答案矩阵中。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{5}{9} & \\frac{4}{81} & \\frac{9}{10} & 0 & 0 & 0 & \\frac{10}{9} & \\frac{5}{9} & 1 & 1 & 2 & 1 & -\\frac{2}{9} & \\frac{4}{9} & 0 & 0 & 2 & 1 & -\\frac{10}{81} & \\frac{40}{81} & 0 & 0\n\\end{pmatrix}\n}\n$$", "id": "2570866"}, {"introduction": "从对称系统转向更普遍的非对称系统，本练习将带你入门广义最小残差（GMRES）方法。这个实践的核心是 Arnoldi 过程，它是 GMRES 方法的“引擎”，负责为克雷洛夫子空间构建一个标准正交基。通过执行单步计算，你将精确地看到 GMRES 如何构造一个小型最小二乘问题来寻找最佳近似解，并且在这个特例中，你将见证一次“幸运分解”（lucky breakdown），即算法瞬间收敛的有趣情况。[@problem_id:2570955]", "problem": "考虑一个由有限元离散化产生的线性系统 $A x = b$，其中\n$$\nA=\\begin{bmatrix}2 & 1 \\\\ 0 & 3\\end{bmatrix}, \\quad b=\\begin{bmatrix}1 \\\\ 1\\end{bmatrix}, \\quad x_{0}=\\begin{bmatrix}0 \\\\ 0\\end{bmatrix}.\n$$\n令 $\\|\\cdot\\|$ 表示欧几里得范数。您需要执行一步 Arnoldi 过程，并计算一步广义最小残差 (GMRES) 方法产生的残差范数。\n\n从初始残差 $r_{0}=b-A x_{0}$ 开始，定义第一个 Arnoldi 向量 $v_{1}=r_{0}/\\|r_{0}\\|$。执行一步 Arnoldi 步骤以获得标量 $h_{11}$ 和 $h_{21}$，使得\n$$\nA v_{1}=v_{1} h_{11}+v_{2} h_{21},\n$$\n其中，如果 $h_{21}\\neq 0$，则 $v_{2}$ 是下一个 Arnoldi 向量。使用这些结果来构建 $(1+1)\\times 1$ 的上海森堡矩阵 (upper Hessenberg matrix) $\\hat{H}_{1}=\\begin{bmatrix}h_{11} \\\\ h_{21}\\end{bmatrix}$ 和标量 $\\beta=\\|r_{0}\\|$。\n\n仅使用 Krylov 子空间的定义性质、Arnoldi 关系以及 Arnoldi 向量的正交规范性，推导单步 GMRES 最小二乘问题，并计算此单步后得到的 GMRES 残差范数。请给出残差范数的精确值作为最终答案（无需四舍五入）。", "solution": "该问题要求计算给定线性系统 $A x = b$ 在执行一步广义最小残差 (GMRES) 方法后的残差范数。在进行求解之前，我们必须首先验证问题陈述，该问题是适定的 (well-posed) 且科学上合理的。\n\n问题由矩阵 $A$、向量 $b$ 和初始猜测 $x_{0}$ 定义：\n$$\nA=\\begin{bmatrix}2 & 1 \\\\ 0 & 3\\end{bmatrix}, \\quad b=\\begin{bmatrix}1 \\\\ 1\\end{bmatrix}, \\quad x_{0}=\\begin{bmatrix}0 \\\\ 0\\end{bmatrix}\n$$\nGMRES 算法在 Krylov 子空间中迭代寻找近似解。该过程从计算初始残差 $r_{0}$ 开始。\n\n首先，我们计算初始残差 $r_{0}$：\n$$\nr_{0} = b - A x_{0} = \\begin{bmatrix}1 \\\\ 1\\end{bmatrix} - \\begin{bmatrix}2 & 1 \\\\ 0 & 3\\end{bmatrix} \\begin{bmatrix}0 \\\\ 0\\end{bmatrix} = \\begin{bmatrix}1 \\\\ 1\\end{bmatrix}\n$$\n初始残差的范数，记为 $\\beta$，使用欧几里得范数计算：\n$$\n\\beta = \\|r_{0}\\| = \\sqrt{1^{2} + 1^{2}} = \\sqrt{2}\n$$\nArnoldi 过程的第一步为 Krylov 子空间 $\\mathcal{K}_{1}(A, r_{0})$ 生成一个标准正交基。第一个基向量 $v_{1}$ 是归一化的初始残差：\n$$\nv_{1} = \\frac{r_{0}}{\\|r_{0}\\|} = \\frac{1}{\\sqrt{2}} \\begin{bmatrix}1 \\\\ 1\\end{bmatrix}\n$$\n接下来，我们执行一步 Arnoldi 迭代来求解海森堡矩阵 (Hessenberg matrix) $\\hat{H}_{1}$ 的元素。我们计算 $A$ 和 $v_{1}$ 的乘积：\n$$\nw_{1} = A v_{1} = \\begin{bmatrix}2 & 1 \\\\ 0 & 3\\end{bmatrix} \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix}1 \\\\ 1\\end{bmatrix} \\right) = \\frac{1}{\\sqrt{2}} \\begin{bmatrix}2(1)+1(1) \\\\ 0(1)+3(1)\\end{bmatrix} = \\frac{1}{\\sqrt{2}} \\begin{bmatrix}3 \\\\ 3\\end{bmatrix}\n$$\n系数 $h_{11}$ 是 $w_{1}$ 在 $v_{1}$ 上的投影。由于我们处理的是实向量，因此 $h_{11} = v_{1}^{T} w_{1}$：\n$$\nh_{11} = \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix}1 & 1\\end{bmatrix} \\right) \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix}3 \\\\ 3\\end{bmatrix} \\right) = \\frac{1}{2} (1 \\cdot 3 + 1 \\cdot 3) = \\frac{6}{2} = 3\n$$\n下一个 Arnoldi 向量 $v_{2}$ 是通过将 $w_{1}$ 相对于 $v_{1}$ 进行正交化得到的。令 $\\tilde{w}_{1} = w_{1} - h_{11} v_{1}$：\n$$\n\\tilde{w}_{1} = \\frac{1}{\\sqrt{2}} \\begin{bmatrix}3 \\\\ 3\\end{bmatrix} - 3 \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix}1 \\\\ 1\\end{bmatrix} \\right) = \\frac{1}{\\sqrt{2}} \\left( \\begin{bmatrix}3 \\\\ 3\\end{bmatrix} - \\begin{bmatrix}3 \\\\ 3\\end{bmatrix} \\right) = \\begin{bmatrix}0 \\\\ 0\\end{bmatrix}\n$$\n系数 $h_{21}$ 是该向量的范数：\n$$\nh_{21} = \\|\\tilde{w}_{1}\\| = \\sqrt{0^2 + 0^2} = 0\n$$\n这种情况，即 $h_{m+1, m} = 0$，被称为“幸运分解”(lucky breakdown)。这意味着 Krylov 子空间 $\\mathcal{K}_{m}(A, r_{0})$ 是 $A$ 的一个不变子空间。在本例中，对于 $m=1$，我们有 $A v_{1} = h_{11} v_{1}$，这意味着 $v_{1}$（以及 $r_{0}$）是矩阵 $A$ 的一个特征向量，其对应的特征值为 $h_{11}=3$。\n\nGMRES 方法寻找一个形如 $x_{m} = x_{0} + z_{m}$ 的近似解，其中 $z_{m}$ 位于 Krylov 子空间 $\\mathcal{K}_{m}(A, r_{0}) = \\text{span}\\{v_{1}, v_{2}, \\ldots, v_{m}\\}$ 中。向量 $z_{m}$ 的选择是为了最小化残差 $r_{m} = \\|b - A x_{m}\\|$ 的范数。\n对于第一步 ($m=1$)，我们寻求使 $\\|r_{1}\\|$ 最小化的解 $x_{1} = x_{0} + y_{1}v_{1}$。残差为：\n$$\nr_{1} = b - A x_{1} = b - A(x_{0} + y_{1}v_{1}) = (b - A x_{0}) - y_{1}A v_{1} = r_{0} - y_{1}A v_{1}\n$$\n使用 Arnoldi 关系 $r_{0} = \\beta v_{1}$ 和 $A v_{1} = h_{11}v_{1} + h_{21}v_{2}$，我们得到：\n$$\nr_{1} = \\beta v_{1} - y_{1}(h_{11}v_{1} + h_{21}v_{2}) = (\\beta - y_{1}h_{11})v_{1} - y_{1}h_{21}v_{2}\n$$\n由于 Arnoldi 向量是标准正交的，残差的范数为：\n$$\n\\|r_{1}\\|^{2} = \\|(\\beta - y_{1}h_{11})v_{1} - y_{1}h_{21}v_{2}\\|^{2} = (\\beta - y_{1}h_{11})^{2} + (-y_{1}h_{21})^{2}\n$$\n最小化 $\\|r_{1}\\|$ 等价于为 $y$ 求解以下 $(m+1) \\times m$ 的最小二乘问题：\n$$\n\\min_{y \\in \\mathbb{R}^{m}} \\|\\hat{H}_{m} y - \\beta e_{1}\\|\n$$\n其中 $\\hat{H}_{m}$ 是 Arnoldi 过程中产生的 $(m+1) \\times m$ 上海森堡矩阵，而 $e_{1}$ 是 $\\mathbb{R}^{m+1}$ 中的第一个标准基向量。GMRES 残差的范数 $\\|r_{m}\\|$ 是该最小化问题的直接结果。\n\n对于 $m=1$，我们有 $y \\in \\mathbb{R}^{1}$（一个标量 $y_1$）和 $e_{1} \\in \\mathbb{R}^{2}$。该问题是：\n$$\n\\min_{y_{1}} \\left\\| \\begin{bmatrix} h_{11} \\\\ h_{21} \\end{bmatrix} [y_{1}] - \\beta \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} \\right\\|\n$$\n代入计算出的值 $h_{11}=3$、$h_{21}=0$ 和 $\\beta=\\sqrt{2}$：\n$$\n\\min_{y_{1}} \\left\\| \\begin{bmatrix} 3 \\\\ 0 \\end{bmatrix} [y_{1}] - \\sqrt{2} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} \\right\\| = \\min_{y_{1}} \\left\\| \\begin{bmatrix} 3y_{1} - \\sqrt{2} \\\\ 0 \\end{bmatrix} \\right\\|\n$$\n该向量的范数是 $\\sqrt{(3y_{1} - \\sqrt{2})^{2} + 0^{2}} = |3y_{1} - \\sqrt{2}|$。\n当 $3y_{1} - \\sqrt{2} = 0$ 时，该表达式达到最小值，这意味着选择 $y_{1} = \\frac{\\sqrt{2}}{3}$。这个最小值本身就是一步 GMRES 迭代后残差的范数，其值为 $0$。\n\n因此，GMRES 在单步内收敛到精确解，因为初始残差 $r_{0}$ 是矩阵 $A$ 的一个特征向量。最终的残差范数 $\\|r_{1}\\|$ 为零。", "answer": "$$\\boxed{0}$$", "id": "2570955"}, {"introduction": "在实际应用中，迭代求解器的性能严重依赖于预处理技术。本练习将通过对一个线性系统应用简单的对角（Jacobi）预处理器，来展示预处理共轭梯度（PCG）方法的威力。你的任务是执行一次迭代，并且更重要的是，通过计算误差的 $A$-范数缩减因子来量化预处理器的效果，从而将收敛加速的理论概念与一个可衡量的指标联系起来。[@problem_id:2571007]", "problem": "一个由有限元离散化产生的对称正定线性系统由矩阵 $A=\\begin{bmatrix}4 & 1 \\\\ 1 & 3\\end{bmatrix}$ 和右端项 $b=\\begin{bmatrix}1 \\\\ 1\\end{bmatrix}$ 给出。考虑使用对称正定预处理器 $M=\\mathrm{diag}(4,3)$ 进行左预处理。从初始猜测 $x_{0}=\\begin{bmatrix}0 \\\\ 0\\end{bmatrix}$ 开始，执行一次左预处理共轭梯度 (CG) 方法的迭代。该方法从第一性原理上理解为在由预处理残差方向生成的仿射子空间上最小化二次能量 $J(x)=\\tfrac{1}{2}x^{\\top}A x - b^{\\top}x$ 的方法，其中第一个搜索方向是 $p_{0}=M^{-1}r_{0}$（$r_{0}=b-Ax_{0}$），步长通过最小化关于 $\\alpha$ 的 $J(x_{0}+\\alpha p_{0})$ 来确定。\n\n令 $x^{\\star}$ 表示 $Ax=b$ 的精确解，并定义误差 $e_{k}=x^{\\star}-x_{k}$ 和 $A$-范数 $\\|e\\|_{A}=\\sqrt{e^{\\top}A e}$。经过一次迭代后，计算精确的缩减因子\n$$\\rho \\;=\\; \\frac{\\|e_{1}\\|_{A}}{\\|e_{0}\\|_{A}}.$$\n只需报告 $\\rho$ 的值，形式为完全化简的精确表达式。不需要四舍五入。", "solution": "对问题陈述进行验证。\n\n逐字提取已知条件：\n- 系统矩阵：$A=\\begin{bmatrix}4 & 1 \\\\ 1 & 3\\end{bmatrix}$\n- 右端项向量：$b=\\begin{bmatrix}1 \\\\ 1\\end{bmatrix}$\n- 矩阵 $A$ 被描述为对称正定。\n- 预处理器矩阵：$M=\\mathrm{diag}(4,3) = \\begin{bmatrix}4 & 0 \\\\ 0 & 3\\end{bmatrix}$\n- 预处理类型：左预处理。\n- 初始猜测：$x_{0}=\\begin{bmatrix}0 \\\\ 0\\end{bmatrix}$\n- 方法：一次左预处理共轭梯度 (CG) 迭代。\n- 第一个搜索方向：$p_{0}=M^{-1}r_{0}$，其中 $r_{0}=b-Ax_{0}$。\n- 步长 $\\alpha$：通过最小化 $J(x_{0}+\\alpha p_{0})$ 确定，其中 $J(x)=\\tfrac{1}{2}x^{\\top}A x - b^{\\top}x$。\n- 精确解：$x^{\\star}$，其中 $Ax^{\\star}=b$。\n- 误差：$e_{k}=x^{\\star}-x_{k}$。\n- $A$-范数：$\\|e\\|_{A}=\\sqrt{e^{\\top}A e}$。\n- 待计算量：精确缩减因子 $\\rho = \\frac{\\|e_{1}\\|_{A}}{\\|e_{0}\\|_{A}}$。\n\n验证结论：\n该问题具有科学依据，涉及数值线性代数中求解线性系统的标准程序，特别是预处理共轭梯度法。矩阵 $A$ 是对称的；其行列式为 $\\det(A) = (4)(3) - (1)(1) = 11 > 0$，且其左上角元素为 $4>0$，这证实了它是正定的。预处理器 $M$ 也是对称正定的。所有定义和条件都是标准的、完整的且数学上一致的。该问题是适定的和客观的。因此，该问题是有效的。\n\n我们开始求解。任务是计算一次迭代后的缩减因子 $\\rho = \\|e_{1}\\|_{A} / \\|e_{0}\\|_{A}$。一种直接但繁琐的方法是计算 $x_{1}$，然后计算误差 $e_{0}$ 和 $e_{1}$ 的范数。一种更有洞察力的方法是推导缩减因子的一般表达式。\n\nCG 方法的第一次迭代将解更新为 $x_{1} = x_{0} + \\alpha_{0} p_{0}$。此步之后的误差为 $e_{1} = x^{\\star} - x_{1} = x^{\\star} - (x_{0} + \\alpha_{0} p_{0}) = (x^{\\star} - x_{0}) - \\alpha_{0} p_{0} = e_{0} - \\alpha_{0} p_{0}$。\n\n误差 $e_{1}$ 的 $A$-范数是关于步长 $\\alpha_{0}$ 最小化的。要最小化的目标函数是 $\\|e_{1}\\|_{A}^{2} = (e_{0} - \\alpha_{0} p_{0})^{\\top}A(e_{0} - \\alpha_{0} p_{0})$。\n展开此表达式得到：\n$$ \\|e_{1}\\|_{A}^{2} = e_{0}^{\\top}A e_{0} - 2\\alpha_{0} e_{0}^{\\top}A p_{0} + \\alpha_{0}^{2} p_{0}^{\\top}A p_{0} $$\n为求最小值，我们对 $\\alpha_{0}$ 求导并令导数为零：\n$$ \\frac{d}{d\\alpha_{0}} \\|e_{1}\\|_{A}^{2} = -2 e_{0}^{\\top}A p_{0} + 2\\alpha_{0} p_{0}^{\\top}A p_{0} = 0 $$\n解出最优步长 $\\alpha_{0}$ 得到：\n$$ \\alpha_{0} = \\frac{e_{0}^{\\top}A p_{0}}{p_{0}^{\\top}A p_{0}} $$\n问题陈述指出，$\\alpha$ 是通过最小化 $J(x_{0}+\\alpha p_{0})$ 求得的。$J(x)$ 的梯度是 $\\nabla J(x) = Ax-b$。$J(x_0+\\alpha_0 p_0)$ 的最小值出现在新点的梯度与搜索方向正交时：$\\nabla J(x_1)^{\\top} p_0 = 0$。这给出 $(A(x_0+\\alpha_0 p_0) - b)^{\\top}p_0 = 0$，从而得到 $\\alpha_0 = \\frac{(b-Ax_0)^{\\top}p_0}{p_0^{\\top}Ap_0} = \\frac{r_0^{\\top}p_0}{p_0^{\\top}Ap_0}$。由于 $r_{0} = b-Ax_{0} = Ax^{\\star}-Ax_{0}=A(x^{\\star}-x_{0})=Ae_{0}$，我们有 $r_{0}^{\\top}p_{0} = (Ae_{0})^{\\top}p_{0} = e_{0}^{\\top}A p_{0}$，这证实了 $\\alpha_{0}$ 的公式。\n\n将最优的 $\\alpha_{0}$ 代回 $\\|e_{1}\\|_{A}^{2}$ 的表达式中：\n$$ \\|e_{1}\\|_{A}^{2} = \\|e_{0}\\|_{A}^{2} - 2 \\left( \\frac{e_{0}^{\\top}A p_{0}}{p_0^{\\top}A p_{0}} \\right) e_{0}^{\\top}A p_{0} + \\left( \\frac{e_{0}^{\\top}A p_{0}}{p_0^{\\top}A p_{0}} \\right)^{2} p_{0}^{\\top}A p_{0} = \\|e_{0}\\|_{A}^{2} - \\frac{(e_{0}^{\\top}A p_{0})^{2}}{p_{0}^{\\top}A p_{0}} $$\n因此，缩减因子的平方为：\n$$ \\rho^{2} = \\frac{\\|e_{1}\\|_{A}^{2}}{\\|e_{0}\\|_{A}^{2}} = 1 - \\frac{(e_{0}^{\\top}A p_{0})^{2}}{ (\\|e_{0}\\|_{A}^{2}) (p_{0}^{\\top}A p_{0}) } $$\n现在我们计算这个表达式的各个组成部分。\n初始猜测为 $x_{0} = \\begin{bmatrix}0 \\\\ 0\\end{bmatrix}$。\n初始残差为 $r_{0} = b - Ax_{0} = b = \\begin{bmatrix}1 \\\\ 1\\end{bmatrix}$。\n预处理器为 $M = \\begin{bmatrix}4 & 0 \\\\ 0 & 3\\end{bmatrix}$，所以其逆矩阵为 $M^{-1} = \\begin{bmatrix}1/4 & 0 \\\\ 0 & 1/3\\end{bmatrix}$。\n第一个搜索方向为 $p_{0} = M^{-1}r_{0} = \\begin{bmatrix}1/4 & 0 \\\\ 0 & 1/3\\end{bmatrix} \\begin{bmatrix}1 \\\\ 1\\end{bmatrix} = \\begin{bmatrix}1/4 \\\\ 1/3\\end{bmatrix}$。\n\n初始误差为 $e_{0} = x^{\\star} - x_{0} = x^{\\star}$。精确解 $x^{\\star}$ 通过求解 $Ax=b$ 得到：\n$$ x^{\\star} = A^{-1}b = \\frac{1}{(4)(3)-(1)(1)} \\begin{bmatrix}3 & -1 \\\\ -1 & 4\\end{bmatrix} \\begin{bmatrix}1 \\\\ 1\\end{bmatrix} = \\frac{1}{11} \\begin{bmatrix}2 \\\\ 3\\end{bmatrix} $$\n所以，$e_{0} = \\frac{1}{11} \\begin{bmatrix}2 \\\\ 3\\end{bmatrix}$。\n\n现在我们计算 $\\rho^2$ 公式中的各项：\n1. $\\|e_{0}\\|_{A}^{2} = e_{0}^{\\top} A e_{0}$。因为 $Ae_{0} = A(x^{\\star}-x_0) = b-Ax_0 = r_{0}$，我们有 $\\|e_{0}\\|_{A}^{2} = e_{0}^{\\top} r_{0}$。\n$$ \\|e_{0}\\|_{A}^{2} = \\left(\\frac{1}{11} \\begin{bmatrix}2 \\\\ 3\\end{bmatrix}\\right)^{\\top} \\begin{bmatrix}1 \\\\ 1\\end{bmatrix} = \\frac{1}{11}(2 \\cdot 1 + 3 \\cdot 1) = \\frac{5}{11} $$\n2. $p_{0}^{\\top}A p_{0}$:\n$$ p_{0}^{\\top}A p_{0} = \\begin{bmatrix}1/4 & 1/3\\end{bmatrix} \\begin{bmatrix}4 & 1 \\\\ 1 & 3\\end{bmatrix} \\begin{bmatrix}1/4 \\\\ 1/3\\end{bmatrix} = \\begin{bmatrix}1/4 & 1/3\\end{bmatrix} \\begin{bmatrix}4(1/4)+1(1/3) \\\\ 1(1/4)+3(1/3)\\end{bmatrix} = \\begin{bmatrix}1/4 & 1/3\\end{bmatrix} \\begin{bmatrix}1+1/3 \\\\ 1/4+1\\end{bmatrix} $$\n$$ p_{0}^{\\top}A p_{0} = \\begin{bmatrix}1/4 & 1/3\\end{bmatrix} \\begin{bmatrix}4/3 \\\\ 5/4\\end{bmatrix} = (1/4)(4/3) + (1/3)(5/4) = 1/3 + 5/12 = 4/12 + 5/12 = \\frac{9}{12} = \\frac{3}{4} $$\n3. $e_{0}^{\\top}A p_{0}$。再次使用 $Ae_{0}=r_{0}$，这等于 $r_{0}^{\\top} p_{0}$：\n$$ e_{0}^{\\top}A p_{0} = r_{0}^{\\top}p_{0} = \\begin{bmatrix}1 & 1\\end{bmatrix} \\begin{bmatrix}1/4 \\\\ 1/3\\end{bmatrix} = 1/4 + 1/3 = 3/12 + 4/12 = \\frac{7}{12} $$\n将这些值代入 $\\rho^{2}$ 的表达式中：\n$$ \\rho^{2} = 1 - \\frac{(7/12)^{2}}{(5/11)(3/4)} = 1 - \\frac{49/144}{15/44} = 1 - \\left(\\frac{49}{144} \\cdot \\frac{44}{15}\\right) $$\n我们化简分数：\n$$ \\frac{49}{144} \\cdot \\frac{44}{15} = \\frac{49}{36 \\cdot 4} \\cdot \\frac{4 \\cdot 11}{15} = \\frac{49 \\cdot 11}{36 \\cdot 15} = \\frac{539}{540} $$\n因此，\n$$ \\rho^{2} = 1 - \\frac{539}{540} = \\frac{1}{540} $$\n缩减因子 $\\rho$ 是正平方根：\n$$ \\rho = \\sqrt{\\frac{1}{540}} = \\frac{1}{\\sqrt{540}} $$\n为化简，我们对平方根内的项进行因式分解：$540 = 54 \\times 10 = 9 \\times 6 \\times 10 = 9 \\times 2 \\times 3 \\times 2 \\times 5 = 36 \\times 15$。\n$$ \\rho = \\frac{1}{\\sqrt{36 \\times 15}} = \\frac{1}{6\\sqrt{15}} $$\n分母有理化后得到完全化简的形式：\n$$ \\rho = \\frac{\\sqrt{15}}{6 \\cdot 15} = \\frac{\\sqrt{15}}{90} $$\n这就是最终的精确表达式。", "answer": "$$ \\boxed{\\frac{\\sqrt{15}}{90}} $$", "id": "2571007"}]}