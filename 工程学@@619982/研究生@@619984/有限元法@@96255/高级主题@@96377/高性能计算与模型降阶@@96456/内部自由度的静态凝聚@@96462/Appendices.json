{"hands_on_practices": [{"introduction": "第一个练习将引导您通过一个直接的数值示例，完整地走一遍静态凝聚的流程。您将使用预先定义的单元矩阵，练习构建凝聚系统，求解边界自由度，然后恢复被消除的内部自由度。这项实践旨在巩固作为该技术核心的基本代数操作。[@problem_id:2598762]", "problem": "考虑一个一维三节点有限元，其具有两个边界自由度 (DOF) 和一个内部自由度。边界自由度为两个端点节点的 $u_1$ 和 $u_2$，内部自由度为 $u_3$，与一个不出现在单元间耦合中的气泡模式相关。单元平衡方程以有限元法 (FEM) 的标准分块形式写出：\n$$\n\\begin{pmatrix}\nK_{bb} & K_{bi} \\\\\nK_{ib} & K_{ii}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{u}_{b} \\\\\n\\mathbf{u}_{i}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{f}_{b} \\\\\n\\mathbf{f}_{i}\n\\end{pmatrix},\n$$\n其中 $\\mathbf{u}_{b} = \\begin{pmatrix} u_{1} \\\\ u_{2} \\end{pmatrix}$ 且 $\\mathbf{u}_{i} = \\begin{pmatrix} u_{3} \\end{pmatrix}$。对于此单元，矩阵和向量的数值由下式给出：\n$$\nK_{bb} = \\begin{pmatrix} 4 & -1 \\\\ -1 & 3 \\end{pmatrix}, \\quad\nK_{bi} = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}, \\quad\nK_{ib} = \\begin{pmatrix} 2 & 1 \\end{pmatrix}, \\quad\nK_{ii} = \\begin{pmatrix} 5 \\end{pmatrix},\n$$\n以及\n$$\n\\mathbf{f}_{b} = \\begin{pmatrix} 0 \\\\ 10 \\end{pmatrix}, \\quad\n\\mathbf{f}_{i} = \\begin{pmatrix} 3 \\end{pmatrix}.\n$$\n假设施加了一个本质边界条件 $u_1 = 0$，而 $u_2$ 保持自由。从平衡方程和内部自由度静态凝聚的定义出发，消去内部自由度 $\\mathbf{u}_i$，以获得关于边界自由度的凝聚方程，并显式计算凝聚边界右端项 $f_{b}^{\\mathrm{cond}}$。然后，求解凝聚系统（在施加本质边界条件后）以确定 $u_2$，并回代求解内部自由度 $u_3$。\n\n您的最终答案必须以单行矩阵的形式，按顺序报告 $f_{b}^{\\mathrm{cond}}$ 的两个分量和回代求得的 $u_3$。答案请用精确有理数形式表示，无需四舍五入，也无需物理单位。", "solution": "该问题已经过验证，在科学上是可靠、适定且完整的。这是一个在有限元法中应用静态凝聚程序的标准练习。求解过程如下。\n\n该有限元的控制线性方程组以分块形式给出如下：\n$$\n\\begin{pmatrix} K_{bb} & K_{bi} \\\\ K_{ib} & K_{ii} \\end{pmatrix} \\begin{pmatrix} \\mathbf{u}_{b} \\\\ \\mathbf{u}_{i} \\end{pmatrix} = \\begin{pmatrix} \\mathbf{f}_{b} \\\\ \\mathbf{f}_{i} \\end{pmatrix}\n$$\n该矩阵方程代表两个耦合方程组：\n$$\nK_{bb} \\mathbf{u}_{b} + K_{bi} \\mathbf{u}_{i} = \\mathbf{f}_{b} \\quad (1)\n$$\n$$\nK_{ib} \\mathbf{u}_{b} + K_{ii} \\mathbf{u}_{i} = \\mathbf{f}_{i} \\quad (2)\n$$\n其中 $\\mathbf{u}_{b}$ 包含边界自由度 (DOF)，而 $\\mathbf{u}_{i}$ 包含内部自由度。静态凝聚过程旨在从系统中消去内部自由度 $\\mathbf{u}_{i}$，从而得到一个仅含边界自由度 $\\mathbf{u}_{b}$ 的更小的系统。\n\n从方程 $(2)$ 中，我们将 $\\mathbf{u}_{i}$ 用 $\\mathbf{u}_{b}$ 表示：\n$$\nK_{ii} \\mathbf{u}_{i} = \\mathbf{f}_{i} - K_{ib} \\mathbf{u}_{b}\n$$\n由于子矩阵 $K_{ii}$ 是可逆的（在本例中，它是一个非零标量矩阵 $K_{ii} = \\begin{pmatrix} 5 \\end{pmatrix}$），我们可以写出：\n$$\n\\mathbf{u}_{i} = K_{ii}^{-1} (\\mathbf{f}_{i} - K_{ib} \\mathbf{u}_{b}) \\quad (3)\n$$\n这是内部自由度的回代求解方程。\n\n将方程 $(3)$ 代入方程 $(1)$ 以消去 $\\mathbf{u}_{i}$：\n$$\nK_{bb} \\mathbf{u}_{b} + K_{bi} [K_{ii}^{-1} (\\mathbf{f}_{i} - K_{ib} \\mathbf{u}_{b})] = \\mathbf{f}_{b}\n$$\n整理各项，将包含 $\\mathbf{u}_{b}$ 的项组合在左侧，得到：\n$$\nK_{bb} \\mathbf{u}_{b} - K_{bi} K_{ii}^{-1} K_{ib} \\mathbf{u}_{b} = \\mathbf{f}_{b} - K_{bi} K_{ii}^{-1} \\mathbf{f}_{i}\n$$\n这可以写成凝聚形式 $K_{bb}^{\\mathrm{cond}} \\mathbf{u}_{b} = \\mathbf{f}_{b}^{\\mathrm{cond}}$，其中凝聚刚度矩阵和凝聚力向量定义为：\n$$\nK_{bb}^{\\mathrm{cond}} = K_{bb} - K_{bi} K_{ii}^{-1} K_{ib}\n$$\n$$\n\\mathbf{f}_{b}^{\\mathrm{cond}} = \\mathbf{f}_{b} - K_{bi} K_{ii}^{-1} \\mathbf{f}_{i}\n$$\n题目要求显式计算 $\\mathbf{f}_{b}^{\\mathrm{cond}}$。我们使用题目给出的数值：\n$$\nK_{bb} = \\begin{pmatrix} 4 & -1 \\\\ -1 & 3 \\end{pmatrix}, \\quad K_{bi} = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}, \\quad K_{ib} = \\begin{pmatrix} 2 & 1 \\end{pmatrix}, \\quad K_{ii} = \\begin{pmatrix} 5 \\end{pmatrix}\n$$\n$$\n\\mathbf{f}_{b} = \\begin{pmatrix} 0 \\\\ 10 \\end{pmatrix}, \\quad \\mathbf{f}_{i} = \\begin{pmatrix} 3 \\end{pmatrix}\n$$\n首先，我们求 $K_{ii}$ 的逆矩阵：\n$$\nK_{ii}^{-1} = \\begin{pmatrix} 5 \\end{pmatrix}^{-1} = \\begin{pmatrix} \\frac{1}{5} \\end{pmatrix}\n$$\n现在，我们计算 $K_{bi} K_{ii}^{-1} \\mathbf{f}_{i}$ 这一项：\n$$\nK_{bi} K_{ii}^{-1} \\mathbf{f}_{i} = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{5} \\end{pmatrix} \\begin{pmatrix} 3 \\end{pmatrix} = \\frac{1}{5} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} (3) = \\frac{1}{5} \\begin{pmatrix} 6 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} \\frac{6}{5} \\\\ \\frac{3}{5} \\end{pmatrix}\n$$\n现在我们可以计算凝聚力向量 $\\mathbf{f}_{b}^{\\mathrm{cond}}$：\n$$\n\\mathbf{f}_{b}^{\\mathrm{cond}} = \\mathbf{f}_{b} - K_{bi} K_{ii}^{-1} \\mathbf{f}_{i} = \\begin{pmatrix} 0 \\\\ 10 \\end{pmatrix} - \\begin{pmatrix} \\frac{6}{5} \\\\ \\frac{3}{5} \\end{pmatrix} = \\begin{pmatrix} 0 - \\frac{6}{5} \\\\ 10 - \\frac{3}{5} \\end{pmatrix} = \\begin{pmatrix} -\\frac{6}{5} \\\\ \\frac{50}{5} - \\frac{3}{5} \\end{pmatrix} = \\begin{pmatrix} -\\frac{6}{5} \\\\ \\frac{47}{5} \\end{pmatrix}\n$$\n$\\mathbf{f}_{b}^{\\mathrm{cond}}$ 的两个分量是 $-\\frac{6}{5}$ 和 $\\frac{47}{5}$。\n\n接下来，我们求解关于边界自由度的凝聚系统。首先，我们计算凝聚刚度矩阵 $K_{bb}^{\\mathrm{cond}}$：\n$$\nK_{bi} K_{ii}^{-1} K_{ib} = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{5} \\end{pmatrix} \\begin{pmatrix} 2 & 1 \\end{pmatrix} = \\frac{1}{5} \\begin{pmatrix} 2 \\times 2 & 2 \\times 1 \\\\ 1 \\times 2 & 1 \\times 1 \\end{pmatrix} = \\frac{1}{5} \\begin{pmatrix} 4 & 2 \\\\ 2 & 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{5} & \\frac{2}{5} \\\\ \\frac{2}{5} & \\frac{1}{5} \\end{pmatrix}\n$$\n$$\nK_{bb}^{\\mathrm{cond}} = \\begin{pmatrix} 4 & -1 \\\\ -1 & 3 \\end{pmatrix} - \\begin{pmatrix} \\frac{4}{5} & \\frac{2}{5} \\\\ \\frac{2}{5} & \\frac{1}{5} \\end{pmatrix} = \\begin{pmatrix} 4 - \\frac{4}{5} & -1 - \\frac{2}{5} \\\\ -1 - \\frac{2}{5} & 3 - \\frac{1}{5} \\end{pmatrix} = \\begin{pmatrix} \\frac{16}{5} & -\\frac{7}{5} \\\\ -\\frac{7}{5} & \\frac{14}{5} \\end{pmatrix}\n$$\n关于 $\\mathbf{u}_{b} = \\begin{pmatrix} u_{1} \\\\ u_{2} \\end{pmatrix}$ 的凝聚方程组为：\n$$\n\\begin{pmatrix} \\frac{16}{5} & -\\frac{7}{5} \\\\ -\\frac{7}{5} & \\frac{14}{5} \\end{pmatrix} \\begin{pmatrix} u_{1} \\\\ u_{2} \\end{pmatrix} = \\begin{pmatrix} -\\frac{6}{5} \\\\ \\frac{47}{5} \\end{pmatrix}\n$$\n施加本质边界条件 $u_1 = 0$。该系统只涉及自由的自由度。对于本问题，只有 $u_2$ 是自由的。我们从系统中提取第二个方程：\n$$\n-\\frac{7}{5} u_{1} + \\frac{14}{5} u_{2} = \\frac{47}{5}\n$$\n代入 $u_1=0$：\n$$\n\\frac{14}{5} u_{2} = \\frac{47}{5}\n$$\n求解 $u_2$：\n$$\nu_{2} = \\frac{47/5}{14/5} = \\frac{47}{14}\n$$\n最后，我们使用方程 $(3)$ 回代求解内部自由度 $u_3$：\n$$\n\\mathbf{u}_{i} = K_{ii}^{-1} (\\mathbf{f}_{i} - K_{ib} \\mathbf{u}_{b})\n$$\n已知 $\\mathbf{u}_{b} = \\begin{pmatrix} u_{1} \\\\ u_{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\frac{47}{14} \\end{pmatrix}$，我们有：\n$$\n\\mathbf{u}_{i} = \\begin{pmatrix} u_3 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{5} \\end{pmatrix} \\left( \\begin{pmatrix} 3 \\end{pmatrix} - \\begin{pmatrix} 2 & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ \\frac{47}{14} \\end{pmatrix} \\right)\n$$\n首先，计算矩阵-向量乘积：\n$$\n\\begin{pmatrix} 2 & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ \\frac{47}{14} \\end{pmatrix} = (2)(0) + (1)\\left(\\frac{47}{14}\\right) = \\frac{47}{14}\n$$\n现在将此结果代回回代方程：\n$$\nu_{3} = \\frac{1}{5} \\left( 3 - \\frac{47}{14} \\right) = \\frac{1}{5} \\left( \\frac{42}{14} - \\frac{47}{14} \\right) = \\frac{1}{5} \\left( -\\frac{5}{14} \\right) = -\\frac{1}{14}\n$$\n题目要求报告 $\\mathbf{f}_{b}^{\\mathrm{cond}}$ 的两个分量和回代求得的 $u_3$。这些值分别为 $-\\frac{6}{5}$、$\\frac{47}{5}$ 和 $-\\frac{1}{14}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{6}{5} & \\frac{47}{5} & -\\frac{1}{14} \\end{pmatrix}}\n$$", "id": "2598762"}, {"introduction": "这项实践将您从纯代数运算带入到单元的构建中，要求您为一个带有内部“气泡”自由度的增强三角形单元推导其刚度矩阵。通过直接根据形函数的梯度计算矩阵分块，您将揭示分层基函数的一个关键特性，并了解这种选择如何简化静态凝聚过程。该练习展示了基函数的选择与计算效率之间的深刻联系。[@problem_id:2598715]", "problem": "考虑一个具有恒定电导率 $\\kappa > 0$ 的标量扩散模型问题，该问题由以下弱形式支配：求解 $u \\in H^{1}(\\Omega)$，使得对于所有 $v \\in H^{1}(\\Omega)$，\n$$\n\\int_{\\Omega} \\kappa \\,\\nabla u \\cdot \\nabla v \\, \\mathrm{d}\\Omega = \\int_{\\Omega} f\\, v \\,\\mathrm{d}\\Omega,\n$$\n其中 $\\Omega \\subset \\mathbb{R}^{2}$ 是计算域。专注于有限元方法 (FEM) 中的单个有限元，即参考三角形 $\\Omega_{e} = \\{(x,y)\\in\\mathbb{R}^{2} \\,:\\, x \\ge 0,\\; y \\ge 0,\\; x+y \\le 1\\}$，其顶点位于 $(0,0)$、$(1,0)$ 和 $(0,1)$。用一个内部气泡自由度 (DOF) 来丰富标准的线性三角形单元：使用三个顶点形函数 $N_{1}(x,y)=1-x-y$、 $N_{2}(x,y)=x$、 $N_{3}(x,y)=y$，以及内部气泡函数 $N_{b}(x,y)=27\\,x\\,y\\,(1-x-y)$。将此单元的节点未知量向量记为 $(u_{1},u_{2},u_{3},u_{b})$，其中 $u_{1},u_{2},u_{3}$ 是顶点处的值，$u_{b}$ 是气泡自由度。\n\n仅使用单元刚度的弱形式定义和上述形函数，对该单元执行以下操作：\n- 集成单元刚度矩阵项 $K_{ab}^{e} = \\int_{\\Omega_{e}} \\kappa \\,\\nabla N_{a}\\cdot \\nabla N_{b}\\,\\mathrm{d}\\Omega$ (其中 $a,b \\in \\{1,2,3,b\\}$)，并将它们组织成块结构，其中边界（顶点）自由度排在前面，内部（气泡）自由度排在最后。识别并计算内部-内部块 $K_{ii}^{e}$ 和内部-边界块 $K_{ib}^{e}$。\n- 从该单元的分块平衡方程出发，通过对内自由度进行静态凝聚来消除内部气泡自由度，以获得仅与顶点自由度相关的舒尔补凝聚刚度。用先前集成的块符号化地表示凝聚矩阵。\n\n最后，报告与凝聚刚度矩阵中耦合顶点自由度 $1$ 和顶点自由度 $2$ 的项（即，凝聚的 $3 \\times 3$ 单元刚度的 $(1,2)$ 项）相对应的单个标量值。您的最终答案必须是一个关于 $\\kappa$ 的、无单位、无四舍五入的精确代数表达式。", "solution": "该问题要求对线性三角形有限元的内部气泡自由度进行静态凝聚，并随后报告凝聚刚度矩阵中的一个特定项。该过程从验证问题陈述开始。\n\n该问题是有效的。它在科学上基于有限元方法的理论，特别是关于增益单元和静态凝聚的理论。弱形式、单元几何形状和形函数的定义是标准的且数学上是精确的。该问题是适定的、自洽的、客观的，并为获得唯一解提供了所有必要的信息。\n\n解题过程分为三个主要步骤：\n1.  集成单元刚度矩阵的相关块。\n2.  执行静态凝聚以获得凝聚刚度矩阵。\n3.  从凝聚矩阵中提取所要求的项。\n\n设单元节点未知量排序为 $\\mathbf{u}^e = (u_1, u_2, u_3, u_b)^T$。我们将自由度 (DOF) 分为边界（顶点）自由度（用下标 'b' 表示）和内部（气泡）自由度（用下标 'i' 表示）。\n边界自由度为 $\\mathbf{u}_b = (u_1, u_2, u_3)^T$。\n内部自由度为 $\\mathbf{u}_i = (u_b)$。\n单元刚度矩阵 $K^e$ 的项为 $K_{ab}^{e} = \\int_{\\Omega_{e}} \\kappa \\,\\nabla N_{a}\\cdot \\nabla N_{b}\\,\\mathrm{d}\\Omega$ (其中 $a,b \\in \\{1,2,3,b\\}$)。它可以被分块成一个 $2 \\times 2$ 的块矩阵：\n$$\nK^e = \\begin{pmatrix} K_{bb}^e & K_{bi}^e \\\\ K_{ib}^e & K_{ii}^e \\end{pmatrix}\n$$\n其中 $K_{bb}^e$ 是 $3 \\times 3$ 的边界-边界块，$K_{bi}^e$ 是 $3 \\times 1$ 的边界-内部块，$K_{ib}^e$ 是 $1 \\times 3$ 的内部-边界块，而 $K_{ii}^e$ 是 $1 \\times 1$ 的内部-内部块。\n\n首先，我们计算所需的块 $K_{ii}^e$ 和 $K_{ib}^e$。这需要形函数的梯度。\n顶点形函数为 $N_1(x,y)=1-x-y$、$N_2(x,y)=x$ 和 $N_3(x,y)=y$。它们的梯度是常数：\n$$ \\nabla N_1 = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}, \\quad \\nabla N_2 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad \\nabla N_3 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} $$\n内部气泡形函数为 $N_b(x,y) = 27xy(1-x-y)$。它的梯度是：\n$$ \\nabla N_b = 27 \\begin{pmatrix} \\frac{\\partial}{\\partial x}(xy - x^2y - xy^2) \\\\ \\frac{\\partial}{\\partial y}(xy - x^2y - xy^2) \\end{pmatrix} = 27 \\begin{pmatrix} y - 2xy - y^2 \\\\ x - x^2 - 2xy \\end{pmatrix} = 27 \\begin{pmatrix} y(1-2x-y) \\\\ x(1-x-2y) \\end{pmatrix} $$\n\n内部-边界块 $K_{ib}^e$ 是一个 $1 \\times 3$ 的行矩阵，其项为 $K_{b j}^e = \\int_{\\Omega_e} \\kappa \\nabla N_b \\cdot \\nabla N_j \\mathrm{d}\\Omega$ (其中 $j \\in \\{1,2,3\\}$)。\n对于 $j=2$：\n$$ K_{b2}^e = \\int_{\\Omega_e} \\kappa (\\nabla N_b \\cdot \\nabla N_2) \\mathrm{d}\\Omega = \\int_{\\Omega_e} \\kappa \\left( 27 y(1-2x-y) \\right) \\mathrm{d}\\Omega = 27\\kappa \\int_{\\Omega_e} \\frac{\\partial N_b}{\\partial x} \\frac{1}{27} \\mathrm{d}\\Omega = \\kappa \\int_{\\Omega_e} \\frac{\\partial N_b}{\\partial x} \\mathrm{d}\\Omega $$\n使用散度定理（二维中的格林定理），这个面积分可以转换成边界积分：\n$$ \\int_{\\Omega_e} \\frac{\\partial N_b}{\\partial x} \\mathrm{d}\\Omega = \\oint_{\\partial \\Omega_e} N_b n_x \\mathrm{d}S $$\n其中 $n_x$ 是边界 $\\partial \\Omega_e$ 的向外单位法线的 $x$ 分量。根据构造，气泡函数 $N_b(x,y)=27xy(1-x-y)$ 在参考三角形 $\\Omega_e$ 的所有三条边上（其中 $x=0$、$y=0$ 或 $x+y=1$）都为零。因此，边界积分为零，且 $K_{b2}^e = 0$。\n类似地，对于 $j=3$：\n$$ K_{b3}^e = \\kappa \\int_{\\Omega_e} \\nabla N_b \\cdot \\nabla N_3 \\mathrm{d}\\Omega = \\kappa \\int_{\\Omega_e} \\frac{\\partial N_b}{\\partial y} \\mathrm{d}\\Omega = \\kappa \\oint_{\\partial \\Omega_e} N_b n_y \\mathrm{d}S = 0 $$\n对于 $j=1$，我们利用线性形函数梯度之和为 $\\nabla N_1 + \\nabla N_2 + \\nabla N_3 = \\mathbf{0}$ 的性质，这意味着 $\\nabla N_1 = -(\\nabla N_2 + \\nabla N_3)$。\n$$ K_{b1}^e = \\kappa \\int_{\\Omega_e} \\nabla N_b \\cdot \\nabla N_1 \\mathrm{d}\\Omega = -\\kappa \\int_{\\Omega_e} \\nabla N_b \\cdot (\\nabla N_2 + \\nabla N_3) \\mathrm{d}\\Omega = -(K_{b2}^e + K_{b3}^e) = 0 $$\n因此，内部-边界块是一个零向量：$K_{ib}^e = \\begin{pmatrix} 0 & 0 & 0 \\end{pmatrix}$。从而，边界-内部块也是零：$K_{bi}^e = (K_{ib}^e)^T = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n\n内部-内部块 $K_{ii}^e$ 是一个 $1 \\times 1$ 的矩阵（一个标量），由下式给出：\n$$ K_{ii}^e = \\int_{\\Omega_e} \\kappa (\\nabla N_b \\cdot \\nabla N_b) \\mathrm{d}\\Omega = \\kappa \\int_{\\Omega_e} |\\nabla N_b|^2 \\mathrm{d}\\Omega $$\n被积函数是 $|\\nabla N_b|^2 = (27)^2 [y^2(1-2x-y)^2 + x^2(1-x-2y)^2]$。为在参考三角形上计算此积分，我们使用面积坐标 $L_1 = 1-x-y, L_2 = x, L_3 = y$ 的公式：$\\int_{\\Omega_e} L_1^a L_2^b L_3^c d\\Omega = \\frac{a!b!c!}{(a+b+c+2)!} 2A$ (其中 $A=1/2$ 为单元面积，所以因子为1)。该公式的正确分母是 $(a+b+c+n)!$ 其中 $n$ 是空间维度。此处为2D，所以是 $(a+b+c+2)!$。\n被积函数变为 $(27)^2 [L_3^2(L_1-L_2)^2 + L_2^2(L_1-L_3)^2]$。如详细推导所示，此表达式的积分为：\n$$ \\int_{\\Omega_e} [L_3^2(L_1-L_2)^2 + L_2^2(L_1-L_3)^2] d\\Omega = \\frac{1}{90} $$\n因此，$K_{ii}^e = \\kappa (27)^2 \\frac{1}{90} = \\kappa \\frac{729}{90} = \\frac{81}{10}\\kappa$。\n\n现在，我们执行静态凝聚。分块方程组为：\n$$\n\\begin{cases}\nK_{bb}^e \\mathbf{u}_b + K_{bi}^e \\mathbf{u}_i = \\mathbf{f}_b \\\\\nK_{ib}^e \\mathbf{u}_b + K_{ii}^e \\mathbf{u}_i = \\mathbf{f}_i\n\\end{cases}\n$$\n从第二个方程，我们用边界自由度 $\\mathbf{u}_b$ 来表示内部自由度 $\\mathbf{u}_i$：\n$$ \\mathbf{u}_i = (K_{ii}^e)^{-1} (\\mathbf{f}_i - K_{ib}^e \\mathbf{u}_b) $$\n将此代入第一个方程，得到一个仅关于 $\\mathbf{u}_b$ 的凝聚系统：\n$$ (K_{bb}^e - K_{bi}^e (K_{ii}^e)^{-1} K_{ib}^e) \\mathbf{u}_b = \\mathbf{f}_b - K_{bi}^e (K_{ii}^e)^{-1} \\mathbf{f}_i $$\n凝聚刚度矩阵是舒尔补，$K_{cond}^e = K_{bb}^e - K_{bi}^e (K_{ii}^e)^{-1} K_{ib}^e$。\n由于我们发现 $K_{ib}^e = \\mathbf{0}$ 且 $K_{bi}^e = \\mathbf{0}$，校正项消失：\n$$ K_{cond}^e = K_{bb}^e - \\mathbf{0} = K_{bb}^e $$\n这意味着凝聚刚度矩阵就是原始的边界-边界块，也就是线性三角形单元的标准刚度矩阵。\n\n最后一步是计算 $K_{cond}^e$ 的 $(1,2)$ 项，也就是 $K_{bb}^e$ 的 $(1,2)$ 项。参考单元 $\\Omega_e$ 的面积为 $A = 1/2$。\n$$ (K_{cond}^e)_{12} = (K_{bb}^e)_{12} = \\int_{\\Omega_e} \\kappa \\nabla N_1 \\cdot \\nabla N_2 \\mathrm{d}\\Omega $$\n被积函数是常数：$\\nabla N_1 \\cdot \\nabla N_2 = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix} \\cdot \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = -1$。\n所以积分为：\n$$ (K_{cond}^e)_{12} = \\kappa \\int_{\\Omega_e} (-1) \\mathrm{d}\\Omega = -\\kappa \\cdot A = -\\kappa \\cdot \\frac{1}{2} = -\\frac{\\kappa}{2} $$\n所求的凝聚刚度矩阵项为 $-\\frac{\\kappa}{2}$。", "answer": "$$ \\boxed{-\\frac{\\kappa}{2}} $$", "id": "2598715"}, {"introduction": "尽管静态凝聚能够为边界未知数提供精确解，但它将原始刚度矩阵转换为了舒尔补矩阵。这最后一个练习旨在探讨这种转换带来的数值影响，揭示了凝聚后的矩阵可能丧失对角占优等重要性质。您将分析这一变化如何影响常见迭代方法（如雅可比法）的收敛性，从而为大规模实际计算提供关键的见解。[@problem_id:2598749]", "problem": "考虑一个线性静态有限元平衡系统，其位移向量按边界自由度和内部自由度分块为 $\\mathbf{u} = \\begin{pmatrix} \\mathbf{u}_{b} \\\\ \\mathbf{u}_{i} \\end{pmatrix}$，刚度矩阵分块为\n$$\n\\mathbf{K} =\n\\begin{pmatrix}\n\\mathbf{K}_{bb} & \\mathbf{K}_{bi} \\\\\n\\mathbf{K}_{ib} & \\mathbf{K}_{ii}\n\\end{pmatrix},\n$$\n以及力向量 $\\mathbf{f} = \\begin{pmatrix} \\mathbf{f}_{b} \\\\ \\mathbf{f}_{i} \\end{pmatrix}$。平衡方程为\n$$\n\\begin{pmatrix}\n\\mathbf{K}_{bb} & \\mathbf{K}_{bi} \\\\\n\\mathbf{K}_{ib} & \\mathbf{K}_{ii}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{u}_{b} \\\\\n\\mathbf{u}_{i}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{f}_{b} \\\\\n\\mathbf{f}_{i}\n\\end{pmatrix}.\n$$\n取如下具体、对称正定的分块数据：\n$$\n\\mathbf{K}_{bb} =\n\\begin{pmatrix}\n5.6 & -3 \\\\\n-3  & 10\n\\end{pmatrix},\\qquad\n\\mathbf{K}_{bi} =\n\\begin{pmatrix}\n6 \\\\\n0\n\\end{pmatrix},\\qquad\n\\mathbf{K}_{ii} = (10),\n$$\n使得 $\\mathbf{K}_{ib} = \\mathbf{K}_{bi}^{\\top}$。对内部自由度 $\\mathbf{u}_{i}$ 进行静态凝聚，以得到简化的边界系统\n$$\n\\mathbf{S}\\,\\mathbf{u}_{b} = \\mathbf{f}_{b}^{\\star},\n$$\n其中 $\\mathbf{S}$ 为舒尔补，$\\mathbf{f}_{b}^{\\star}$ 为凝聚右端项。然后：\n\n- 显式计算简化刚度矩阵 $\\mathbf{S}$。\n- 判断 $\\mathbf{S}$ 是否为严格对角占优，并陈述您的结论。\n- 考虑将线性定常雅可比方法应用于 $\\mathbf{S}\\,\\mathbf{u}_{b} = \\mathbf{f}_{b}^{\\star}$。令 $\\mathbf{D} = \\operatorname{diag}(S_{11}, S_{22})$ 且 $\\mathbf{T}_{J} = \\mathbf{I} - \\mathbf{D}^{-1}\\mathbf{S}$ 为雅可比迭代矩阵。以精确的封闭形式计算谱半径 $\\rho(\\mathbf{T}_{J})$。\n- 根据您的计算和标准收敛理论，简要解释：因凝聚而丧失的严格对角占优性是否必然阻碍雅可比方法的收敛，以及高斯-赛德尔方法对此简化系统是否收敛。\n\n请以 $\\rho(\\mathbf{T}_{J})$ 的精确封闭形式表达式作为最终答案。无需四舍五入，也无需单位。", "solution": "该问题已根据指定标准进行验证，并被认定为具有科学依据、提法恰当、客观且完整。它展示了计算力学中一个标准的数值线性代数问题。下面我们开始解答。\n\n线性平衡方程组以分块形式给出：\n$$\n\\begin{pmatrix}\n\\mathbf{K}_{bb} & \\mathbf{K}_{bi} \\\\\n\\mathbf{K}_{ib} & \\mathbf{K}_{ii}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{u}_{b} \\\\\n\\mathbf{u}_{i}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{f}_{b} \\\\\n\\mathbf{f}_{i}\n\\end{pmatrix}\n$$\n这对应于两个矩阵方程：\n$$\n\\mathbf{K}_{bb} \\mathbf{u}_{b} + \\mathbf{K}_{bi} \\mathbf{u}_{i} = \\mathbf{f}_{b} \\quad (1)\n$$\n$$\n\\mathbf{K}_{ib} \\mathbf{u}_{b} + \\mathbf{K}_{ii} \\mathbf{u}_{i} = \\mathbf{f}_{i} \\quad (2)\n$$\n静态凝聚是消除内部自由度 $\\mathbf{u}_{i}$ 的过程。从方程 $(2)$，假设 $\\mathbf{K}_{ii}$ 可逆，我们求解 $\\mathbf{u}_{i}$。题目说明 $\\mathbf{K}$ 是对称正定 (SPD) 的，这意味着它的对角块（如 $\\mathbf{K}_{ii}$）也是对称正定且因此可逆的。\n$$\n\\mathbf{K}_{ii} \\mathbf{u}_{i} = \\mathbf{f}_{i} - \\mathbf{K}_{ib} \\mathbf{u}_{b}\n$$\n$$\n\\mathbf{u}_{i} = \\mathbf{K}_{ii}^{-1} (\\mathbf{f}_{i} - \\mathbf{K}_{ib} \\mathbf{u}_{b})\n$$\n将此 $\\mathbf{u}_{i}$ 的表达式代入方程 $(1)$：\n$$\n\\mathbf{K}_{bb} \\mathbf{u}_{b} + \\mathbf{K}_{bi} \\left[ \\mathbf{K}_{ii}^{-1} (\\mathbf{f}_{i} - \\mathbf{K}_{ib} \\mathbf{u}_{b}) \\right] = \\mathbf{f}_{b}\n$$\n重新整理各项以分离出 $\\mathbf{u}_{b}$：\n$$\n(\\mathbf{K}_{bb} - \\mathbf{K}_{bi} \\mathbf{K}_{ii}^{-1} \\mathbf{K}_{ib}) \\mathbf{u}_{b} = \\mathbf{f}_{b} - \\mathbf{K}_{bi} \\mathbf{K}_{ii}^{-1} \\mathbf{f}_{i}\n$$\n这就是简化系统 $\\mathbf{S}\\,\\mathbf{u}_{b} = \\mathbf{f}_{b}^{\\star}$，其中简化刚度矩阵，或称 $\\mathbf{K}$ 中关于 $\\mathbf{K}_{ii}$ 的舒尔补，是 $\\mathbf{S} = \\mathbf{K}_{bb} - \\mathbf{K}_{bi} \\mathbf{K}_{ii}^{-1} \\mathbf{K}_{ib}$。\n\n我们现在使用所提供的数据计算 $\\mathbf{S}$：\n$$\n\\mathbf{K}_{bb} = \\begin{pmatrix} 5.6 & -3 \\\\ -3 & 10 \\end{pmatrix}, \\quad \\mathbf{K}_{bi} = \\begin{pmatrix} 6 \\\\ 0 \\end{pmatrix}, \\quad \\mathbf{K}_{ii} = (10)\n$$\n鉴于 $\\mathbf{K}$ 是对称的，$\\mathbf{K}_{ib} = \\mathbf{K}_{bi}^{\\top} = \\begin{pmatrix} 6 & 0 \\end{pmatrix}$。$1 \\times 1$ 矩阵 $\\mathbf{K}_{ii}$ 的逆是 $\\mathbf{K}_{ii}^{-1} = (1/10) = (0.1)$。\n现在，我们计算修正项：\n$$\n \\mathbf{K}_{bi} \\mathbf{K}_{ii}^{-1} \\mathbf{K}_{ib} = \\begin{pmatrix} 6 \\\\ 0 \\end{pmatrix} (0.1) \\begin{pmatrix} 6 & 0 \\end{pmatrix} = \\begin{pmatrix} 6 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 0.6 & 0 \\end{pmatrix} = \\begin{pmatrix} 3.6 & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\n简化刚度矩阵 $\\mathbf{S}$ 为：\n$$\n\\mathbf{S} = \\mathbf{K}_{bb} - \\mathbf{K}_{bi} \\mathbf{K}_{ii}^{-1} \\mathbf{K}_{ib} = \\begin{pmatrix} 5.6 & -3 \\\\ -3 & 10 \\end{pmatrix} - \\begin{pmatrix} 3.6 & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 2 & -3 \\\\ -3 & 10 \\end{pmatrix}\n$$\n接下来，我们判断 $\\mathbf{S}$ 是否为严格对角占优。一个 $n \\times n$ 的矩阵 $\\mathbf{A} = (a_{ij})$，如果对所有行 $i=1, \\dots, n$ 都满足 $|a_{ii}| > \\sum_{j=1, j\\neq i}^{n} |a_{ij}|$，则该矩阵是严格对角占优的。对于 $\\mathbf{S}$：\n第 1 行：$|S_{11}| = |2| = 2$。非对角元素绝对值之和为 $|S_{12}| = |-3| = 3$。条件 $2 > 3$ 不成立。\n第 2 行：$|S_{22}| = |10| = 10$。非对角元素绝对值之和为 $|S_{21}| = |-3| = 3$。条件 $10 > 3$ 成立。\n由于该条件对第一行不成立，矩阵 $\\mathbf{S}$ 不是严格对角占优的。\n\n现在我们计算系统 $\\mathbf{S}\\,\\mathbf{u}_{b} = \\mathbf{f}_{b}^{\\star}$ 的雅可比迭代矩阵 $\\mathbf{T}_{J}$ 的谱半径。该迭代矩阵定义为 $\\mathbf{T}_{J} = \\mathbf{I} - \\mathbf{D}^{-1}\\mathbf{S}$，其中 $\\mathbf{D}$ 是 $\\mathbf{S}$ 的对角部分。\n$$\n\\mathbf{S} = \\begin{pmatrix} 2 & -3 \\\\ -3 & 10 \\end{pmatrix}, \\quad \\mathbf{D} = \\begin{pmatrix} 2 & 0 \\\\ 0 & 10 \\end{pmatrix}\n$$\n$\\mathbf{D}$ 的逆矩阵为 $\\mathbf{D}^{-1} = \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 1/10 \\end{pmatrix}$。\n$$\n\\mathbf{D}^{-1}\\mathbf{S} = \\begin{pmatrix} 1/2 & 0 \\\\ 0 & 1/10 \\end{pmatrix} \\begin{pmatrix} 2 & -3 \\\\ -3 & 10 \\end{pmatrix} = \\begin{pmatrix} 1 & -3/2 \\\\ -3/10 & 1 \\end{pmatrix}\n$$\n$$\n\\mathbf{T}_{J} = \\mathbf{I} - \\mathbf{D}^{-1}\\mathbf{S} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} - \\begin{pmatrix} 1 & -3/2 \\\\ -3/10 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 3/2 \\\\ 3/10 & 0 \\end{pmatrix}\n$$\n为了求谱半径 $\\rho(\\mathbf{T}_{J})$，我们通过特征方程 $\\det(\\mathbf{T}_{J} - \\lambda\\mathbf{I}) = 0$ 求解 $\\mathbf{T}_{J}$ 的特征值 $\\lambda$。\n$$\n\\det \\begin{pmatrix} -\\lambda & 3/2 \\\\ 3/10 & -\\lambda \\end{pmatrix} = (-\\lambda)(-\\lambda) - (\\frac{3}{2})(\\frac{3}{10}) = \\lambda^2 - \\frac{9}{20} = 0\n$$\n特征值为 $\\lambda^2 = \\frac{9}{20}$，所以 $\\lambda = \\pm\\sqrt{\\frac{9}{20}} = \\pm\\frac{3}{\\sqrt{20}} = \\pm\\frac{3}{2\\sqrt{5}}$。\n谱半径是特征值绝对值的最大值：\n$$\n\\rho(\\mathbf{T}_{J}) = \\max\\left(\\left|\\frac{3}{2\\sqrt{5}}\\right|, \\left|-\\frac{3}{2\\sqrt{5}}\\right|\\right) = \\frac{3}{2\\sqrt{5}} = \\frac{3\\sqrt{5}}{10}\n$$\n关于收敛性：\n雅可比方法收敛的充要条件是 $\\rho(\\mathbf{T}_{J}) < 1$。我们有 $\\rho(\\mathbf{T}_{J}) = \\frac{3\\sqrt{5}}{10}$。由于 $\\sqrt{5} \\approx 2.236$，$\\rho(\\mathbf{T}_{J}) \\approx \\frac{3 \\times 2.236}{10} = 0.6708 < 1$。更严谨地，$(\\frac{3\\sqrt{5}}{10})^2 = \\frac{9 \\times 5}{100} = \\frac{45}{100} < 1$。因此，雅可比方法收敛。这说明严格对角占优是雅可比方法收敛的充分条件，但非必要条件。\n\n对于高斯-赛德尔方法，如果系数矩阵 $\\mathbf{S}$ 是对称正定 (SPD) 的，则收敛性得到保证。\n矩阵 $\\mathbf{S} = \\begin{pmatrix} 2 & -3 \\\\ -3 & 10 \\end{pmatrix}$ 是对称的。为检验其正定性，我们使用西尔维斯特准则。其顺序主子式为：\n一阶主子式为 $\\det(S_{11}) = 2 > 0$。\n二阶主子式为 $\\det(\\mathbf{S}) = (2)(10) - (-3)(-3) = 20 - 9 = 11 > 0$。\n由于所有顺序主子式都为正，$\\mathbf{S}$ 是正定的。因此，高斯-赛德尔方法对此简化系统保证收敛。", "answer": "$$\n\\boxed{\\frac{3\\sqrt{5}}{10}}\n$$", "id": "2598749"}]}