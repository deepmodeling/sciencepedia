{"hands_on_practices": [{"introduction": "在构建完整的误差估计子之前，我们先从其最基本的组成部分入手：逐单元的强残差。本练习要求您使用线性有限元方法，为一个简单的一维问题计算该残差。通过这个过程，您将亲眼看到为什么仅有这一项是不够的，以及它的量级与源项的关系，从而理解估计子中为何需要包含其他项。[@problem_id:2594006]", "id": "2594006", "problem": "考虑区间 $[0,1]$ 上的一维边界值问题：求 $u \\in H_{0}^{1}(0,1)$，使得\n$$\n- u''(x) = f(x) \\quad \\text{for } x \\in (0,1), \\qquad u(0) = 0, \\quad u(1) = 0,\n$$\n给定右端项为\n$$\nf(x) = 2 + \\sin(2\\pi x).\n$$\n令 $\\mathcal{T}_h$ 是 $[0,1]$ 上的均匀剖分，包含两个长度均为 $h_K = \\tfrac{1}{2}$ 的单元 $K_{1} = (0,\\tfrac{1}{2})$ 和 $K_{2} = (\\tfrac{1}{2},1)$。令 $V_h \\subset H_{0}^{1}(0,1)$ 是从属于 $\\mathcal{T}_h$ 的标准连续分片线性函数空间。记 $u_h \\in V_h$ 为由 Galerkin 条件定义的协调有限元解\n$$\n\\int_{0}^{1} u_h'(x)\\,v_h'(x)\\,dx = \\int_{0}^{1} f(x)\\,v_h(x)\\,dx \\quad \\text{for all } v_h \\in V_h.\n$$\n对每个单元 $K \\in \\mathcal{T}_h$，定义强单元残差为内部量\n$$\nr_K(x) := f(x) + u_h''(x) \\quad \\text{for } x \\in K,\n$$\n即，离散解在 $K$ 内部的强残差。\n\n任务：\n- 仅使用上述定义和连续分片线性基函数的标准性质，显式计算每个单元 $K \\in \\{K_{1},K_{2}\\}$ 上的 $r_K(x)$。\n- 然后，将 $h_K$ 视为可变单元长度，确定强残差的大小在 $L^{\\infty}(K)$ 范数意义下如何随 $h_K$ 缩放，即，刻画 $\\|r_K\\|_{L^{\\infty}(K)}$ 对 $h_K$ 的依赖关系。\n\n答案规格：\n- 将 $\\|r_K\\|_{L^{\\infty}(K)}$ 关于 $h_K$ 的最终缩放定律表示为 $h_K^{\\alpha}$ 形式的单项式。最终答案必须仅为此单项式（无解释性文本）。", "solution": "首先必须验证所述问题的正确性、一致性和科学依据。\n\n**第 1 步：提取已知条件**\n所提供的信息如下：\n- **边界值问题 (BVP)：** 求 $u \\in H_{0}^{1}(0,1)$，使得当 $x \\in (0,1)$ 时有 $- u''(x) = f(x)$，且边界条件为 $u(0) = 0$ 和 $u(1) = 0$。\n- **强迫函数：** $f(x) = 2 + \\sin(2\\pi x)$。\n- **网格：** $[0,1]$ 上的一个均匀剖分 $\\mathcal{T}_h$，包含两个单元 $K_{1} = (0,\\tfrac{1}{2})$ 和 $K_{2} = (\\tfrac{1}{2},1)$。单元长度为 $h_K = \\tfrac{1}{2}$。\n- **有限元空间：** $V_h \\subset H_{0}^{1}(0,1)$ 是从属于 $\\mathcal{T}_h$ 且满足零边界条件的连续分片线性函数空间。\n- **Galerkin 提法：** 有限元解 $u_h \\in V_h$ 由 $\\int_{0}^{1} u_h'(x)\\,v_h'(x)\\,dx = \\int_{0}^{1} f(x)\\,v_h(x)\\,dx$ 对所有 $v_h \\in V_h$ 定义。\n- **强单元残差：** 对于一个单元 $K \\in \\mathcal{T}_h$，残差定义为 $r_K(x) := f(x) + u_h''(x)$，其中 $x \\in K$。\n- **任务：**\n    1. 显式计算在 $K_{1}$ 和 $K_{2}$ 上的 $r_K(x)$。\n    2. 以单项式 $h_K^{\\alpha}$ 的形式，刻画 $\\|r_K\\|_{L^{\\infty}(K)}$ 关于可变单元长度 $h_K$ 的缩放关系。\n\n**第 2 步：使用提取的已知条件进行验证**\n该问题是有限元方法后验误差分析中的一个标准练习。\n- **科学依据：** 该问题坚实地基于求解二阶椭圆偏微分方程的有限元方法的数学理论。所有定义都是标准且正确的。\n- **适定性：** 带齐次 Dirichlet 边界条件的一维 Poisson 方程是一个经典的适定边界值问题。相应的 Galerkin 问题也是适定的。\n- **客观性：** 该问题以精确、客观的数学语言陈述。\n- **完备性与一致性：** 该问题是自洽且内部一致的。它提供了确定有限元解和所得残差所需的所有信息。\n\n**第 3 步：结论与行动**\n问题有效。我将继续进行完整解答。\n\n对于给定的网格，有限元空间 $V_h$ 在 $x_0=0$, $x_1=\\tfrac{1}{2}$ 和 $x_2=1$ 处有节点。由于齐次 Dirichlet 条件 $u_h(0)=u_h(1)=0$，空间 $V_h$ 是一维的，由单个基函数——以内部节点 $x_1=\\tfrac{1}{2}$ 为中心的“帽子”函数 $\\phi_1(x)$——张成。该基函数定义为：\n$$\n\\phi_1(x) = \\begin{cases} 2x & \\text{if } x \\in [0, \\tfrac{1}{2}] \\\\ 2(1-x) & \\text{if } x \\in [\\tfrac{1}{2}, 1] \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\n有限元解 $u_h(x)$ 可写为 $u_h(x) = c_1 \\phi_1(x)$，其中 $c_1$ 是一个待定标量系数。Galerkin 条件要求对 $V_h$ 中的所有函数进行测试，这可以通过对基函数 $\\phi_1(x)$ 进行测试来满足。\n$$\n\\int_{0}^{1} (c_1 \\phi_1(x))' (\\phi_1(x))' dx = \\int_{0}^{1} f(x) \\phi_1(x) dx\n$$\n这可以简化为关于 $c_1$ 的一个线性方程：\n$$\nc_1 \\left( \\int_{0}^{1} |\\phi_1'(x)|^2 dx \\right) = \\int_{0}^{1} f(x) \\phi_1(x) dx\n$$\n我们计算积分。基函数的导数为：\n$$\n\\phi_1'(x) = \\begin{cases} 2 & \\text{if } x \\in (0, \\tfrac{1}{2}) \\\\ -2 & \\text{if } x \\in (\\tfrac{1}{2}, 1) \\end{cases}\n$$\n左侧的积分为：\n$$\n\\int_{0}^{1} |\\phi_1'(x)|^2 dx = \\int_{0}^{1/2} (2)^2 dx + \\int_{1/2}^{1} (-2)^2 dx = 4 \\cdot \\frac{1}{2} + 4 \\cdot \\frac{1}{2} = 4\n$$\n右侧的积分为：\n$$\n\\int_{0}^{1} f(x) \\phi_1(x) dx = \\int_{0}^{1} (2 + \\sin(2\\pi x)) \\phi_1(x) dx = \\int_{0}^{1} 2\\phi_1(x) dx + \\int_{0}^{1} \\sin(2\\pi x) \\phi_1(x) dx\n$$\n第一项是 $\\phi_1(x)$ 定义的三角形面积的两倍。不对，高是 $1$，底是 $1$。面积是 $\\tfrac{1}{2} \\cdot 1 \\cdot 1 = \\tfrac{1}{2}$。$\\phi_1(x)$ 的最大值在 $x=1/2$ 处为 $1$。所以面积是 $\\frac{1}{2} \\times 1 \\times 1 = \\frac{1}{2}$。因此，$\\int_{0}^{1} 2\\phi_1(x) dx = 2 \\times \\frac{1}{2} = 1$。\n第二项由于对称性为零。函数 $\\phi_1(x)$ 关于 $x=\\tfrac{1}{2}$ 是偶函数，而函数 $\\sin(2\\pi x)$ 关于 $x=\\tfrac{1}{2}$ 是奇函数（因为 $\\sin(2\\pi(\\tfrac{1}{2}-z)) = \\sin(\\pi - 2\\pi z) = \\sin(2\\pi z)$ 且 $\\sin(2\\pi(\\tfrac{1}{2}+z)) = \\sin(\\pi + 2\\pi z) = -\\sin(2\\pi z)$）。它们的乘积在对称/反对称点周围的对称区间 $[0,1]$ 上的积分为零。\n因此，右侧积分的计算结果为 $1$。\n\n关于 $c_1$ 的方程变为 $4c_1 = 1$，得出 $c_1 = \\tfrac{1}{4}$。有限元解为：\n$$\nu_h(x) = \\frac{1}{4} \\phi_1(x) = \\begin{cases} \\frac{1}{2}x & \\text{if } x \\in [0, \\tfrac{1}{2}] \\\\ \\frac{1}{2}(1-x) & \\text{if } x \\in [\\tfrac{1}{2}, 1] \\end{cases}\n$$\n现在我们处理第一个任务：计算强单元残差 $r_K(x) = f(x) + u_h''(x)$。\n函数 $u_h(x)$ 在每个单元 $K \\in \\{K_{1}, K_{2}\\}$ 的内部是线性的。因此，其二阶导数 $u_h''(x)$ 对于所有 $x \\in K_1 \\cup K_2$ 恒为零。\n$$\nu_h''(x) = 0 \\quad \\text{for } x \\in (0,\\tfrac{1}{2}) \\cup (\\tfrac{1}{2},1)\n$$\n因此，每个单元内部的强单元残差就是强迫函数 $f(x)$：\n$$\nr_K(x) = f(x) + 0 = 2 + \\sin(2\\pi x) \\quad \\text{for } x \\in K\n$$\n这个结果对 $K_1 = (0,\\tfrac{1}{2})$ 和 $K_2 = (\\tfrac{1}{2},1)$ 都有效。这完成了第一个任务。\n\n接下来，我们处理第二个任务：确定 $\\|r_K\\|_{L^{\\infty}(K)}$ 随可变单元长度 $h_K$ 的缩放关系。\n从上一步中，我们已经确定，对于任何网格中的任何单元 $K$，分片线性逼近的强单元残差由 $r_K(x) = f(x)$ 给出，其中 $x \\in K$。因此，其在 $L^{\\infty}(K)$ 范数下的量值为：\n$$\n\\|r_K\\|_{L^{\\infty}(K)} = \\sup_{x \\in K} |r_K(x)| = \\sup_{x \\in K} |f(x)|\n$$\n问题要求我们确定当单元尺寸 $h_K$ 趋于零时，这个量如何缩放。让我们考虑一个网格序列，其中 $h_K \\to 0$。对于这样的网格中的任何单元 $K$，令 $x_K$ 为 $K$ 中的一个点。当 $h_K \\to 0$ 时，区间 $K$ 会收缩到一个点。由于强迫函数 $f(x) = 2 + \\sin(2\\pi x)$ 处处连续，在一个收缩的区间 $K$ 上 $|f(x)|$ 的上确界将收敛到极限点处 $|f|$ 的值。\n$$\n\\lim_{h_K \\to 0} \\|r_K\\|_{L^{\\infty}(K)} = \\lim_{h_K \\to 0} \\sup_{x \\in K} |f(x)| = |f(x^*)|\n$$\n其中 $x^*$ 是单元 $K$ 收缩到的点。\n通常，对于任何非零点 $x^*$， $|f(x^*)|$ 是一个正常数。例如，对于我们特定的 $f(x)$，对所有 $x$ 都有 $|f(x)| \\ge 2 - 1 = 1$。当参数 $h_K$ 趋于零时，一个收敛到非零常数的量，被称为关于该参数是零阶的。这可以写成 $O(h_K^0)$，或简写为 $O(1)$。\n因此，缩放定律的形式为 $C \\cdot h_K^{\\alpha}$，其中 $\\alpha=0$。表达这种依赖关系的单项式是 $h_K^0$。这反映了分片线性单元的一个基本性质：强内部残差在 $L^{\\infty}$ 范数下不收敛于零；它只是变成了源项的局部值。", "answer": "$$\\boxed{h_{K}^{0}}$$"}, {"introduction": "误差估计子不仅仅是理论上的构造，其主要目的是指导自适应网格加密。本练习将场景转换到一个二维非结构化网格，要求您计算完整的局部误差指示子，它既包括了单元内部残差，也包括了单元间的通量跳跃项。通过比较这些指示子，您将能够量化地识别出哪部分网格对误差的贡献最大，从而确定需要加密的首要目标。[@problem_id:2594040]", "id": "2594040", "problem": "考虑一个多边形域上的标量泊松问题，其带有齐次狄利克雷边界条件：求解 $u \\in H_{0}^{1}(\\Omega)$ 使得\n$$\n-\\Delta u = f \\quad \\text{在 } \\Omega \\text{ 内}, \n\\qquad u = 0 \\quad \\text{在 } \\partial\\Omega \\text{ 上}.\n$$\n设 $\\Omega$ 是以 $V_{1}=(0,0)$、$V_{2}=(2,0)$ 和 $V_{3}=(0,1)$ 为顶点的三角形。考虑一个协调网格，该网格通过添加内点 $M=(0.6,0.4)$ 并将区域分割为三个三角形而得到：\n$$\nK_{1} = \\triangle(V_{1},V_{2},M), \n\\quad \nK_{2} = \\triangle(V_{2},V_{3},M),\n\\quad \nK_{3} = \\triangle(V_{3},V_{1},M).\n$$\n在此网格上使用标准的连续分片线性（即 $\\mathbb{P}_{1}$）有限元空间。设计算出的有限元近似解 $u_{h}$ 由以下节点值给出：\n$$\nu_{h}(V_{1})=0, \\quad u_{h}(V_{2})=0, \\quad u_{h}(V_{3})=0, \\quad u_{h}(M)=1.\n$$\n假设源项在每个单元上是分片常数，\n$$\nf|_{K_{1}}=1, \n\\qquad \nf|_{K_{2}}=-2, \n\\qquad \nf|_{K_{3}}=\\tfrac{1}{2}.\n$$\n采用以下几何尺度：对每个单元 $K$，令 $h_{K}$ 为单元直径，定义为 $K$ 的最大边长；对每条边 $E$，令 $h_{E}$ 为边长 $|E|$。考虑有限元方法（FEM）中经典的基于残差的后验误差估计框架，其中误差由单元残差和法向通量跨内边的跳跃所控制。\n\n从弱形式和残差的单元分部积分表示出发，并利用标准的反向不等式和迹不等式来推导网格相关的权重，推导出针对 $\\mathbb{P}_{1}$ 单元和内边的基于残差的局部指标 $\\eta_{K}$，用单元残差 $r_{K}$ 和内边跳跃残差 $j_{E}$ 来表示。然后，对于上面给出的具体 $u_{h}$、网格和 $f$，显式地计算：\n- 三个局部指标 $\\eta_{K_{1}}$、$\\eta_{K_{2}}$ 和 $\\eta_{K_{3}}$，\n- 全局估计子 $\\eta = \\left(\\sum_{K} \\eta_{K}^{2}\\right)^{1/2}$，\n- 以及具有主导贡献（即最大的 $\\eta_{K}$）的单元 $K$ 的索引，如果是 $K_{1}$ 则报告为 $1$，如果是 $K_{2}$ 则报告为 $2$，如果是 $K_{3}$ 则报告为 $3$。\n\n将你的最终答案表示为一个单行矩阵，顺序为 $\\bigl[\\eta_{K_{1}},\\,\\eta_{K_{2}},\\,\\eta_{K_{3}},\\,\\eta,\\,\\text{主导单元的索引}\\bigr]$，使用精确值（不要四舍五入）。", "solution": "所述问题具有科学依据、是适定的、客观且自洽的。它提出了一个关于有限元方法后验误差分析的标准练习。所有必要的数据和定义均已提供，且没有矛盾或含糊之处。因此，该问题是有效的，我将着手进行解答。\n\n该问题涉及在区域 $\\Omega$ 上的泊松方程 $-\\Delta u = f$，带有齐次狄利克雷边界条件 $u=0$ on $\\partial\\Omega$。其弱形式是求解 $u \\in H_0^1(\\Omega)$ 使得\n$$ a(u,v) := \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\mathbf{x} = \\int_{\\Omega} f v \\, d\\mathbf{x} =: (f,v) \\quad \\forall v \\in H_0^1(\\Omega) $$\n设 $u_h$ 是来自协调空间 $V_h \\subset H_0^1(\\Omega)$ 的有限元近似解。误差 $e = u - u_h$ 对所有 $v_h \\in V_h$ 满足 Galerkin 正交性条件 $a(e,v_h) = 0$。对于任意测试函数 $v \\in H_0^1(\\Omega)$，误差方程为\n$$ a(e,v) = a(u,v) - a(u_h,v) = (f,v) - a(u_h,v) $$\n我们可以通过逐单元进行分部积分来表示右端项：\n$$ a(e,v) = \\sum_{K \\in \\mathcal{T}_h} \\left( \\int_K f v \\, d\\mathbf{x} - \\int_K \\nabla u_h \\cdot \\nabla v \\, d\\mathbf{x} \\right) = \\sum_{K \\in \\mathcal{T}_h} \\left( \\int_K (f + \\Delta u_h) v \\, d\\mathbf{x} + \\int_{\\partial K} (\\nabla u_h \\cdot \\mathbf{n}_K) v \\, ds \\right) $$\n其中 $\\mathbf{n}_K$ 是单元 $K$ 边界 $\\partial K$ 的单位外法向量。由于 $u_h$ 是一个连续分片线性函数（$\\mathbb{P}_1$），其拉普拉斯算子 $\\Delta u_h$ 在每个单元 $K$ 内部为零。单元残差为 $r_K = f|_{K}$。\n边界积分的和可以分解为内边 $\\mathcal{E}_I$ 和边界边 $\\mathcal{E}_B$ 上的积分：\n$$ \\sum_{K \\in \\mathcal{T}_h} \\int_{\\partial K} (\\nabla u_h \\cdot \\mathbf{n}_K) v \\, ds = \\sum_{E \\in \\mathcal{E}_I} \\int_E \\llbracket \\nabla u_h \\cdot \\mathbf{n} \\rrbracket v \\, ds + \\sum_{E \\in \\mathcal{E}_B} \\int_E (\\nabla u_h \\cdot \\mathbf{n}) v \\, ds $$\n在单元 $K_+$ 和 $K_-$ 之间的内边 $E$ 上的跳跃 $\\llbracket \\nabla u_h \\cdot \\mathbf{n} \\rrbracket$ 为 $(\\nabla u_h)|_{K_+} \\cdot \\mathbf{n}_+ + (\\nabla u_h)|_{K_-} \\cdot \\mathbf{n}_-$。由于 $v \\in H_0^1(\\Omega)$，其在 $\\partial\\Omega$ 上的迹为零，因此边界边上的积分为零。令 $j_E = \\llbracket \\nabla u_h \\cdot \\mathbf{n} \\rrbracket$。误差方程变为：\n$$ a(e,v) = \\sum_{K \\in \\mathcal{T}_h} \\int_K r_K v \\, d\\mathbf{x} + \\sum_{E \\in \\mathcal{E}_I} \\int_E j_E v \\, ds $$\n标准的后验误差分析，利用柯西-施瓦茨不等式和迹不等式，可得到误差能量范数 $\\|e\\|_{E}^2 = a(e,e)$ 的一个上界，形式为 $\\|e\\|_{E}^2 \\le C \\sum_K \\eta_K^2$。局部误差指标 $\\eta_K$ 由下式给出\n$$ \\eta_K^2 = C_R^2 h_K^2 \\|r_K\\|_{L^2(K)}^2 + \\frac{1}{2} C_J^2 \\sum_{E \\subset \\partial K \\cap \\Omega} h_E \\|j_E\\|_{L^2(E)}^2 $$\n其中 $h_K$ 是单元直径，$h_E$ 是边长。因子 $C_R$ 和 $C_J$ 是依赖于形状正则性的常数，但在实践中通常设为 $1$。根据问题的提法，我们假设 $C_R=C_J=1$。由于源项 $f$ 和 $\\mathbb{P}_1$ 近似解 $u_h$ 的梯度在每个单元上都是常数，局部指标简化为：\n$$ \\eta_K^2 = h_K^2 (f|_K)^2 |K| + \\frac{1}{2} \\sum_{E \\subset \\partial K \\cap \\Omega} h_E (j_E^2 h_E) = h_K^2 (f|_K)^2 |K| + \\frac{1}{2} \\sum_{E \\subset \\partial K \\cap \\Omega} j_E^2 h_E^2 $$\n我们现在针对该具体问题计算这些量。\n\n**1. 几何属性**\n顶点为 $V_1=(0,0)$、$V_2=(2,0)$、$V_3=(0,1)$ และ $M=(0.6,0.4)$。\n单元 $K_1=\\triangle(V_1,V_2,M)$、$K_2=\\triangle(V_2,V_3,M)$、$K_3=\\triangle(V_3,V_1,M)$ 的面积为：\n$|K_1| = \\frac{1}{2}|(2)(0.4)-(0)(0.6)| = 0.4 = \\frac{2}{5}$\n$|K_2| = \\frac{1}{2}|(2-0.6)(1-0.4) - (0-0.6)(0-0.4)| = \\frac{1}{2} |1.4 \\times 0.6 - 0.6 \\times 0.4| = 0.3 = \\frac{3}{10}$\n$|K_3| = \\frac{1}{2}|(0-0.6)(0-0.4) - (0.6-0.6)(1-0.4)| = 0.3 = \\frac{3}{10}$\n边长 ($h_E = |E|$) 为：\n$h_{V_1V_2}=2$, $h_{V_2V_3}=\\sqrt{(2-0)^2+(0-1)^2}=\\sqrt{5}$, $h_{V_3V_1}=1$.\n$h_{V_1M}=\\sqrt{0.6^2+0.4^2}=\\sqrt{0.52}=\\frac{\\sqrt{13}}{5}$.\n$h_{V_2M}=\\sqrt{(2-0.6)^2+(0-0.4)^2}=\\sqrt{1.4^2+0.4^2}=\\sqrt{2.12}=\\frac{\\sqrt{53}}{5}$.\n$h_{V_3M}=\\sqrt{(0-0.6)^2+(1-0.4)^2}=\\sqrt{0.6^2+0.6^2}=\\sqrt{0.72}=\\frac{3\\sqrt{2}}{5}$.\n单元直径 ($h_K = \\max_{E \\subset \\partial K} h_E$) 为：\n$h_{K_1}=\\max\\{2, \\frac{\\sqrt{13}}{5}, \\frac{\\sqrt{53}}{5}\\} = 2$.\n$h_{K_2}=\\max\\{\\sqrt{5}, \\frac{\\sqrt{53}}{5}, \\frac{3\\sqrt{2}}{5}\\} = \\sqrt{5}$.\n$h_{K_3}=\\max\\{1, \\frac{\\sqrt{13}}{5}, \\frac{3\\sqrt{2}}{5}\\} = 1$.\n\n**2. 有限元解的梯度**\n解 $u_h$ 由节点值 $u_h(V_1)=u_h(V_2)=u_h(V_3)=0$ 和 $u_h(M)=1$ 指定。梯度 $\\nabla u_h$ 在每个单元 $K_i$ 上是常数：\n在 $K_1=\\triangle(V_1,V_2,M)$ 上：$u_h(x,y)=ax+by+c$。由 $u_h(0,0)=0 \\implies c=0$；$u_h(2,0)=0 \\implies 2a=0 \\implies a=0$；$u_h(0.6,0.4)=1 \\implies 0.4b=1 \\implies b=5/2$。因此，$\\nabla u_h|_{K_1} = (0, \\frac{5}{2})$。\n在 $K_2=\\triangle(V_2,V_3,M)$ 上：$u_h(2,0)=0 \\implies 2a+c=0$；$u_h(0,1)=0 \\implies b+c=0$；$u_h(0.6,0.4)=1 \\implies 0.6a+0.4b+c=1$。解此方程组可得 $a=-5/3, b=-10/3, c=10/3$。因此，$\\nabla u_h|_{K_2} = (-\\frac{5}{3}, -\\frac{10}{3})$。\n在 $K_3=\\triangle(V_3,V_1,M)$ 上：$u_h(0,1)=0 \\implies b+c=0$；$u_h(0,0)=0 \\implies c=0 \\implies b=0$；$u_h(0.6,0.4)=1 \\implies 0.6a=1 \\implies a=5/3$。因此，$\\nabla u_h|_{K_3} = (\\frac{5}{3}, 0)$。\n\n**3. 跳跃残差**\n内边为 $E_{1M} = K_1 \\cap K_3$，$E_{2M} = K_1 \\cap K_2$ 和 $E_{3M} = K_2 \\cap K_3$。\n对于 $E_{1M}$：从 $K_3$ 到 $K_1$ 的法向量为 $\\mathbf{n}_{1M} = \\frac{1}{h_{V_1M}}(-0.4, 0.6)$。\n$j_{1M} = (\\nabla u_h|_{K_3} - \\nabla u_h|_{K_1}) \\cdot \\mathbf{n}_{1M} = ((\\frac{5}{3},0) - (0, \\frac{5}{2})) \\cdot \\frac{5}{\\sqrt{13}}(-\\frac{2}{5},\\frac{3}{5}) = (\\frac{5}{3}, -\\frac{5}{2}) \\cdot \\frac{1}{\\sqrt{13}}(-2,3) = \\frac{1}{\\sqrt{13}}(-\\frac{10}{3}-\\frac{15}{2}) = -\\frac{65}{6\\sqrt{13}} = -\\frac{5\\sqrt{13}}{6}$。\n对于 $E_{2M}$：从 $K_1$ 到 $K_2$ 的法向量为 $\\mathbf{n}_{2M} = \\frac{1}{h_{V_2M}}(0.4, 1.4)$。\n$j_{2M} = (\\nabla u_h|_{K_1} - \\nabla u_h|_{K_2}) \\cdot \\mathbf{n}_{2M} = ((0, \\frac{5}{2}) - (-\\frac{5}{3},-\\frac{10}{3})) \\cdot \\frac{5}{\\sqrt{53}}(\\frac{2}{5},\\frac{7}{5}) = (\\frac{5}{3}, \\frac{35}{6}) \\cdot \\frac{1}{\\sqrt{53}}(2,7) = \\frac{1}{\\sqrt{53}}(\\frac{10}{3}+\\frac{245}{6}) = \\frac{265}{6\\sqrt{53}} = \\frac{5\\sqrt{53}}{6}$。\n对于 $E_{3M}$：从 $K_2$ 到 $K_3$ 的法向量为 $\\mathbf{n}_{3M} = \\frac{1}{h_{V_3M}}(0.6, 0.6)$。\n$j_{3M} = (\\nabla u_h|_{K_2} - \\nabla u_h|_{K_3}) \\cdot \\mathbf{n}_{3M} = ((-\\frac{5}{3},-\\frac{10}{3}) - (\\frac{5}{3},0)) \\cdot \\frac{1}{0.6\\sqrt{2}}(0.6,0.6) = (-\\frac{10}{3},-\\frac{10}{3}) \\cdot \\frac{1}{\\sqrt{2}}(1,1) = -\\frac{20}{3\\sqrt{2}} = -\\frac{10\\sqrt{2}}{3}$。\n\n**4. 局部指标**\n我们计算 $\\eta_K^2$ 的两个部分：单元残差项 $h_K^2 (f|_K)^2 |K|$ 和跳跃项 $\\frac{1}{2} \\sum j_E^2 h_E^2$。\n源项：$f|_{K_1} = 1$, $f|_{K_2} = -2$, $f|_{K_3} = 1/2$。\n跳跃项的平方 $j_E^2 h_E^2$：\n$j_{1M}^2 h_{1M}^2 = (-\\frac{5\\sqrt{13}}{6})^2 (\\frac{\\sqrt{13}}{5})^2 = \\frac{25 \\cdot 13}{36} \\frac{13}{25} = \\frac{169}{36}$。\n$j_{2M}^2 h_{2M}^2 = (\\frac{5\\sqrt{53}}{6})^2 (\\frac{\\sqrt{53}}{5})^2 = \\frac{25 \\cdot 53}{36} \\frac{53}{25} = \\frac{2809}{36}$。\n$j_{3M}^2 h_{3M}^2 = (-\\frac{10\\sqrt{2}}{3})^2 (\\frac{3\\sqrt{2}}{5})^2 = \\frac{200}{9} \\frac{18}{25} = 16$。\n\n对于 $K_1$：\n$\\eta_{K_1}^2 = (2)^2 (1)^2 (\\frac{2}{5}) + \\frac{1}{2}(j_{1M}^2 h_{1M}^2 + j_{2M}^2 h_{2M}^2) = \\frac{8}{5} + \\frac{1}{2}(\\frac{169}{36} + \\frac{2809}{36}) = \\frac{8}{5} + \\frac{2978}{72} = \\frac{8}{5} + \\frac{1489}{36} = \\frac{288+7445}{180} = \\frac{7733}{180}$。\n$\\eta_{K_1} = \\sqrt{\\frac{7733}{180}} = \\frac{\\sqrt{7733}}{6\\sqrt{5}} = \\frac{\\sqrt{38665}}{30}$。\n\n对于 $K_2$：\n$\\eta_{K_2}^2 = (\\sqrt{5})^2 (-2)^2 (\\frac{3}{10}) + \\frac{1}{2}(j_{2M}^2 h_{2M}^2 + j_{3M}^2 h_{3M}^2) = 5 \\cdot 4 \\cdot \\frac{3}{10} + \\frac{1}{2}(\\frac{2809}{36} + 16) = 6 + \\frac{1}{2}(\\frac{2809+576}{36}) = 6 + \\frac{3385}{72} = \\frac{432+3385}{72} = \\frac{3817}{72}$。\n$\\eta_{K_2} = \\sqrt{\\frac{3817}{72}} = \\frac{\\sqrt{3817}}{6\\sqrt{2}} = \\frac{\\sqrt{7634}}{12}$。\n\n对于 $K_3$：\n$\\eta_{K_3}^2 = (1)^2 (\\frac{1}{2})^2 (\\frac{3}{10}) + \\frac{1}{2}(j_{3M}^2 h_{3M}^2 + j_{1M}^2 h_{1M}^2) = \\frac{3}{40} + \\frac{1}{2}(16 + \\frac{169}{36}) = \\frac{3}{40} + \\frac{1}{2}(\\frac{576+169}{36}) = \\frac{3}{40} + \\frac{745}{72} = \\frac{27+3725}{360} = \\frac{3752}{360} = \\frac{469}{45}$。\n$\\eta_{K_3} = \\sqrt{\\frac{469}{45}} = \\frac{\\sqrt{469}}{3\\sqrt{5}} = \\frac{\\sqrt{2345}}{15}$。\n\n**5. 全局估计子和主导单元**\n全局估计子 $\\eta$ 由 $\\eta^2 = \\sum_K \\eta_K^2$ 给出。\n$\\eta^2 = \\frac{7733}{180} + \\frac{3817}{72} + \\frac{469}{45} = \\frac{2 \\cdot 7733}{360} + \\frac{5 \\cdot 3817}{360} + \\frac{8 \\cdot 469}{360} = \\frac{15466 + 19085 + 3752}{360} = \\frac{38303}{360}$。\n$\\eta = \\sqrt{\\frac{38303}{360}} = \\frac{\\sqrt{38303}}{6\\sqrt{10}} = \\frac{\\sqrt{383030}}{60}$。\n\n为了找到主导单元，我们比较 $\\eta_{K_1}^2$、$\\eta_{K_2}^2$ 和 $\\eta_{K_3}^2$。\n$\\eta_{K_1}^2 = \\frac{7733}{180} = \\frac{15466}{360}$。\n$\\eta_{K_2}^2 = \\frac{3817}{72} = \\frac{19085}{360}$。\n$\\eta_{K_3}^2 = \\frac{469}{45} = \\frac{3752}{360}$。\n由于 $19085 > 15466 > 3752$，最大的指标是 $\\eta_{K_2}$。主导单元的索引是 $2$。\n\n最终结果被组合成所要求的矩阵格式。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\sqrt{38665}}{30} & \\frac{\\sqrt{7634}}{12} & \\frac{\\sqrt{2345}}{15} & \\frac{\\sqrt{383030}}{60} & 2 \\end{pmatrix}}\n$$"}, {"introduction": "我们的误差估计子到底有多好？最终的检验是将其预测值与真实的（但通常未知的）误差进行比较。这个总结性练习将指导您计算一个具有已知解析解问题的完整基于残差的误差估计子和能量范数下的真实误差。通过计算这两者之比——即有效性指数（$I_{\\mathrm{eff}}$）——您将可以直接衡量估计子的质量。[@problem_id:2594031]", "id": "2594031", "problem": "考虑单位区间上具有齐次狄利克雷边界条件的一维泊松边值问题：求 $u : [0,1] \\to \\mathbb{R}$ 使得\n$$\n- u''(x) = f(x) \\quad \\text{for } x \\in (0,1), \\qquad u(0) = 0, \\quad u(1) = 0,\n$$\n其中 $f(x) = x$。令 $\\mathcal{T}_h$ 为由两个单元 $K_1 = [0, \\tfrac{1}{2}]$ 和 $K_2 = [\\tfrac{1}{2}, 1]$ 组成的网格。考虑与网格 $\\mathcal{T}_h$ 相关的二次拉格朗日有限元空间 $V_h \\subset H_0^1(0,1)$，其局部插值节点位于单元的端点和中点。令 $u_h \\in V_h$ 为伽辽金有限元解。\n\n从弱形式以及单元强残差和单元间通量跳跃的定义出发，推导一个形如下式的基于残差的后验误差估计子\n$$\n\\eta := \\left( \\sum_{K \\in \\mathcal{T}_h} \\eta_K^2 + \\sum_{x_i \\in \\mathcal{N}_h^{\\mathrm{int}}} \\eta_{x_i}^2 \\right)^{1/2},\n$$\n其中 $\\eta_K$ 仅依赖于单元 $K$ 上的单元强残差和单元尺寸，而 $\\eta_{x_i}$ 仅依赖于离散通量在内部节点 $x_i$ 处的跳跃和代表性的局部长度尺度。显式计算：\n- 二次有限元解 $u_h$，\n- 单元残差指标 $\\eta_{K_1}$ 和 $\\eta_{K_2}$ 以及在 $x = \\tfrac{1}{2}$ 处的单个内部节点跳跃指标，\n- 全局估计子 $\\eta$，\n- 真实能量误差 $\\| u - u_h \\|_E$，其中能量范数定义为 $\\| v \\|_E := \\left( \\int_0^1 |v'(x)|^2 \\, dx \\right)^{1/2}$，\n\n以及最后的效应指数\n$$\nI_{\\mathrm{eff}} := \\frac{\\eta}{\\| u - u_h \\|_E}.\n$$\n请以 $I_{\\mathrm{eff}}$ 的闭式解析表达式的形式给出最终答案。不需要数值舍入，也不涉及单位。", "solution": "所给问题是有限元法后验误差估计领域中的一个标准的、适定的问题。所有必需信息均已提供且一致。该问题具有科学依据且是客观的。因此，我将着手求解。\n\n问题是求解在 $x \\in (0,1)$ 上的 $u(x)$，使得\n$$\n-u''(x) = x, \\quad u(0) = 0, \\quad u(1) = 0.\n$$\n相应的弱形式是：求 $u \\in H_0^1(0,1)$，使得对所有 $v \\in H_0^1(0,1)$ 都有 $a(u,v) = L(v)$，其中双线性形式为 $a(u,v) = \\int_0^1 u'(x)v'(x) \\, dx$，线性泛函为 $L(v) = \\int_0^1 f(x)v(x) \\, dx$ 且 $f(x)=x$。能量范数为 $\\|v\\|_E = \\sqrt{a(v,v)}$。\n\n首先，我们求精确解。对 $-u''(x)=x$ 积分两次得到 $u(x) = -\\frac{x^3}{6} + C_1 x + C_2$。边界条件 $u(0)=0$ 和 $u(1)=0$ 意味着 $C_2=0$ 和 $-\\frac{1}{6} + C_1 = 0$，所以 $C_1 = \\frac{1}{6}$。精确解为\n$$\nu(x) = \\frac{x-x^3}{6}.\n$$\n其导数为 $u'(x) = \\frac{1-3x^2}{6}$。\n\n接下来，我们计算伽辽金有限元解 $u_h \\in V_h$。空间 $V_h$ 由网格 $\\mathcal{T}_h = \\{K_1, K_2\\}$（其中 $K_1 = [0, \\frac{1}{2}]$ 和 $K_2 = [\\frac{1}{2}, 1]$）上的连续分片二次多项式组成，并满足齐次边界条件。自由度是内部节点 $x_1=\\frac{1}{4}$，$x_2=\\frac{1}{2}$ 和 $x_3=\\frac{3}{4}$ 处的函数值。我们用 $U_1, U_2, U_3$ 表示这些值。因此，$u_h(x) = \\sum_{i=1}^3 U_i \\phi_i(x)$，其中 $\\phi_i$ 是对应于这些节点的二次拉格朗日基函数。\n\n伽辽金系统为 $A U = b$，其中 $A_{ij} = a(\\phi_i, \\phi_j)$ 是刚度矩阵，$b_i = L(\\phi_i)$ 是载荷向量。\n长度为 $h$ 的二次单元的局部刚度矩阵为 $k^e = \\frac{1}{3h} \\begin{pmatrix} 7 & -8 & 1 \\\\ -8 & 16 & -8 \\\\ 1 & -8 & 7 \\end{pmatrix}$。当 $h=\\frac{1}{2}$ 时，该矩阵变为 $k^e = \\frac{2}{3} \\begin{pmatrix} 7 & -8 & 1 \\\\ -8 & 16 & -8 \\\\ 1 & -8 & 7 \\end{pmatrix}$。\n组装节点 $\\frac{1}{4}, \\frac{1}{2}, \\frac{3}{4}$ 对应的全局刚度矩阵，可得：\n$A_{11} = k^e_{22} = \\frac{2}{3}(16) = \\frac{32}{3}$。\n$A_{22} = k^e_{33} + k^e_{11} = \\frac{2}{3}(7) + \\frac{2}{3}(7) = \\frac{28}{3}$。\n$A_{33} = k^e_{22} = \\frac{32}{3}$。\n$A_{12} = k^e_{23} = \\frac{2}{3}(-8) = -\\frac{16}{3}$。\n$A_{23} = k^e_{12} = \\frac{2}{3}(-8) = -\\frac{16}{3}$。\n$A_{13} = 0$。\n所以，$A = \\frac{1}{3} \\begin{pmatrix} 32 & -16 & 0 \\\\ -16 & 28 & -16 \\\\ 0 & -16 & 32 \\end{pmatrix}$。\n载荷向量的分量为 $b_i = \\int_0^1 x \\phi_i(x) dx$。\n$b_1 = \\int_0^{1/2} x \\phi_1(x) dx = \\frac{1}{12}$。\n$b_2 = \\int_0^1 x \\phi_2(x) dx = \\int_0^{1/2} x \\phi_2(x) dx + \\int_{1/2}^1 x \\phi_2(x) dx = \\frac{1}{24} + \\frac{1}{24} = \\frac{1}{12}$。\n$b_3 = \\int_{1/2}^1 x \\phi_3(x) dx = \\frac{1}{4}$。\n需要求解的系统是 $\\frac{1}{3} \\begin{pmatrix} 32 & -16 & 0 \\\\ -16 & 28 & -16 \\\\ 0 & -16 & 32 \\end{pmatrix} \\begin{pmatrix} U_1 \\\\ U_2 \\\\ U_3 \\end{pmatrix} = \\begin{pmatrix} 1/12 \\\\ 1/12 \\\\ 1/4 \\end{pmatrix}$。\n解为 $U_1 = \\frac{5}{128}$，$U_2 = \\frac{1}{16}$，$U_3 = \\frac{7}{128}$。\n有限元解为：\n对于 $x \\in K_1 = [0, \\frac{1}{2}]$，$u_h(x) = \\frac{5}{128} \\phi_1(x) + \\frac{1}{16} \\phi_2(x)|_{K_1} = \\frac{3}{16}x - \\frac{1}{8}x^2$。\n对于 $x \\in K_2 = [\\frac{1}{2}, 1]$，$u_h(x) = \\frac{1}{16} \\phi_2(x)|_{K_2} + \\frac{7}{128} \\phi_3(x) = -\\frac{1}{16} + \\frac{7}{16}x - \\frac{3}{8}x^2$。\n\n基于残差的后验误差估计子为 $\\eta = \\left( \\sum_{K \\in \\mathcal{T}_h} \\eta_K^2 + \\sum_{x_i \\in \\mathcal{N}_h^{\\mathrm{int}}} \\eta_{x_i}^2 \\right)^{1/2}$。\n单元指标为 $\\eta_K^2 = C_R^2 h_K^2 \\|f+u_h''\\|_{L^2(K)}^2$。取常数 $C_R=1$：\n在 $K_1$ 上：$h_{K_1}=\\frac{1}{2}$，$u_h''(x)=-\\frac{1}{4}$。残差为 $R_{K_1} = x - \\frac{1}{4}$。\n$\\eta_{K_1}^2 = (\\frac{1}{2})^2 \\int_0^{1/2} (x-\\frac{1}{4})^2 dx = \\frac{1}{4} \\left[ \\frac{(x-1/4)^3}{3} \\right]_0^{1/2} = \\frac{1}{12} \\left[ (\\frac{1}{4})^3 - (-\\frac{1}{4})^3 \\right] = \\frac{1}{12} \\left( \\frac{2}{64} \\right) = \\frac{1}{384}$。\n在 $K_2$ 上：$h_{K_2}=\\frac{1}{2}$，$u_h''(x)=-\\frac{3}{4}$。残差为 $R_{K_2} = x - \\frac{3}{4}$。\n$\\eta_{K_2}^2 = (\\frac{1}{2})^2 \\int_{1/2}^1 (x-\\frac{3}{4})^2 dx = \\frac{1}{4} \\left[ \\frac{(x-3/4)^3}{3} \\right]_{1/2}^1 = \\frac{1}{12} \\left[ (\\frac{1}{4})^3 - (-\\frac{1}{4})^3 \\right] = \\frac{1}{384}$。\n\n跳跃指标为 $\\eta_{x_i}^2 = C_J^2 h_{x_i} |[u_h'](x_i)|^2$。取 $C_J=1$，唯一的内部节点位于 $x_i = \\frac{1}{2}$。局部长度尺度为 $h_{1/2} = (h_{K_1}+h_{K_2})/2 = \\frac{1}{2}$。\n跳跃值为 $[u_h'](\\frac{1}{2}) = u_h'|_{K_2}(\\frac{1}{2}) - u_h'|_{K_1}(\\frac{1}{2})$。\n在 $K_1$ 上，$u_h'(x)$ 为 $\\frac{3}{16} - \\frac{x}{4}$，因此 $u_h'(\\frac{1}{2}^-) = \\frac{3}{16} - \\frac{1}{8} = \\frac{1}{16}$。\n在 $K_2$ 上，$u_h'(x)$ 为 $\\frac{7}{16} - \\frac{3x}{4}$，因此 $u_h'(\\frac{1}{2}^+) = \\frac{7}{16} - \\frac{3}{8} = \\frac{1}{16}$。\n跳跃值 $[u_h'](\\frac{1}{2}) = \\frac{1}{16} - \\frac{1}{16} = 0$。这是在线性源项下，二次单元在均匀网格上的一个已知的超收敛性质。\n所以，$\\eta_{1/2}^2 = 0$。\n\n全局估计子为 $\\eta^2 = \\eta_{K_1}^2 + \\eta_{K_2}^2 + \\eta_{1/2}^2 = \\frac{1}{384} + \\frac{1}{384} + 0 = \\frac{2}{384} = \\frac{1}{192}$。\n因此，$\\eta = \\sqrt{\\frac{1}{192}} = \\frac{1}{\\sqrt{64 \\cdot 3}} = \\frac{1}{8\\sqrt{3}} = \\frac{\\sqrt{3}}{24}$。\n\n真实能量误差为 $\\|e\\|_E = \\|u-u_h\\|_E$。根据伽辽金正交性，$\\|e\\|_E^2 = a(u,u) - a(u_h,u_h)$。\n$a(u,u) = \\|u'\\|_E^2 = \\int_0^1 (\\frac{1-3x^2}{6})^2 dx = \\frac{1}{36} \\int_0^1 (1-6x^2+9x^4) dx = \\frac{1}{36}[x-2x^3+\\frac{9}{5}x^5]_0^1 = \\frac{1}{36}(1-2+\\frac{9}{5}) = \\frac{1}{45}$。\n$a(u_h, u_h) = U^T A U = U^T b$。\n$U^T b = \\begin{pmatrix} \\frac{5}{128} & \\frac{1}{16} & \\frac{7}{128} \\end{pmatrix} \\begin{pmatrix} 1/12 \\\\ 1/12 \\\\ 1/4 \\end{pmatrix} = \\frac{5}{128 \\cdot 12} + \\frac{1}{16 \\cdot 12} + \\frac{7}{128 \\cdot 4} = \\frac{5}{1536} + \\frac{1}{192} + \\frac{7}{512}$。\n$a(u_h, u_h) = \\frac{5}{1536} + \\frac{8}{1536} + \\frac{21}{1536} = \\frac{34}{1536} = \\frac{17}{768}$。\n$\\|e\\|_E^2 = \\frac{1}{45} - \\frac{17}{768} = \\frac{1 \\cdot 256 - 17 \\cdot 15}{11520} = \\frac{256 - 255}{11520} = \\frac{1}{11520}$。\n$\\|e\\|_E = \\sqrt{\\frac{1}{11520}} = \\frac{1}{\\sqrt{24^2 \\cdot 20}} = \\frac{1}{24\\sqrt{20}} = \\frac{1}{24 \\cdot 2\\sqrt{5}} = \\frac{1}{48\\sqrt{5}} = \\frac{\\sqrt{5}}{240}$。\n\n最后，效应指数为\n$$\nI_{\\mathrm{eff}} = \\frac{\\eta}{\\| u - u_h \\|_E} = \\frac{\\sqrt{3}/24}{\\sqrt{5}/240} = \\frac{\\sqrt{3}}{24} \\cdot \\frac{240}{\\sqrt{5}} = \\frac{10\\sqrt{3}}{\\sqrt{5}} = \\frac{10\\sqrt{15}}{5} = 2\\sqrt{15}.\n$$", "answer": "$$\\boxed{2\\sqrt{15}}$$"}]}