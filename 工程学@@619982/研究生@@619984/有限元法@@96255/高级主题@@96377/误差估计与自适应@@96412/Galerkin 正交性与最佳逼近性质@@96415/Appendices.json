{"hands_on_practices": [{"introduction": "理论的理解最好通过具体的计算来巩固。本练习旨在通过一个简单的一维泊松问题，让您亲手验证伽辽金正交性的核心思想 [@problem_id:2561440]。您将组装一个小型有限元系统，求解近似解，并直接计算其残差与基函数的内积，从而直观地证明伽辽金方法如何系统性地“消除”在近似空间中的误差。", "problem": "考虑定义在区间 $[0,1]$ 上的边值问题：求解满足 $-u'' = f$ 的 $u$，边界条件为 $u(0)=0$ 和 $u(1)=0$，其中 $f(x) = 1$。其变分形式为：寻求 $u \\in H_0^1(0,1)$，使得\n$$\na(u,v) = \\ell(v) \\quad \\text{对所有 } v \\in H_0^1(0,1),\n$$\n其中双线性形式和线性泛函分别为\n$$\na(u,v) := \\int_0^1 u'(x) v'(x)\\,dx, \n\\qquad \n\\ell(v) := \\int_0^1 f(x)\\,v(x)\\,dx.\n$$\n设 $V_h \\subset H_0^1(0,1)$ 为在均匀网格上的连续分片线性有限元空间（有限元方法 (FEM)），其节点为 $x_0=0$、$x_1=\\frac{1}{3}$、$x_2=\\frac{2}{3}$、$x_3=1$。用 $\\{\\phi_1, \\phi_2\\}$ 分别表示与内部节点 $x_1=\\frac{1}{3}$ 和 $x_2=\\frac{2}{3}$ 相关联的 $V_h$ 的节点基。伽辽金近似解 $u_h \\in V_h$ 满足\n$$\na(u_h, v_h) = \\ell(v_h) \\quad \\text{对所有 } v_h \\in V_h.\n$$\n任务：\n- 仅使用上述定义以及网格和基的具体信息，组装刚度矩阵 $K \\in \\mathbb{R}^{2 \\times 2}$ 和载荷向量 $F \\in \\mathbb{R}^{2}$，其元素为 $K_{ij} := a(\\phi_j,\\phi_i)$ 和 $F_i := \\ell(\\phi_i)$。\n- 求解组装好的线性系统，以获得 $u_h = u_1 \\phi_1 + u_2 \\phi_2$ 的系数向量 $U_h = (u_1, u_2)^{\\top}$。\n- 定义弱残差泛函 $R: V_h \\to \\mathbb{R}$ 为 $R(v_h) := a(u_h, v_h) - \\ell(v_h)$。通过计算定义 $a(\\cdot,\\cdot)$ 和 $\\ell(\\cdot)$ 的积分来显式计算 $R(\\phi_1)$ 和 $R(\\phi_2)$。使用这些值来验证对所有 $v_h \\in V_h$ 成立的伽辽金正交性 $R(v_h)=0$。\n- 设\n$$\nE := |R(\\phi_1)|^2 + |R(\\phi_2)|^2.\n$$\n给出 $E$ 的值作为你的最终答案。无需四舍五入，也不应包含任何单位。", "solution": "空间 $V_h$ 的节点基函数 $\\{\\phi_1, \\phi_2\\}$ 是分片线性的“帽”函数。给定网格节点 $x_0=0$、$x_1=\\frac{1}{3}$、$x_2=\\frac{2}{3}$、$x_3=1$，$\\phi_1(x)$ 和 $\\phi_2(x)$ 的显式表达式为：\n$$\n\\phi_1(x) = \\begin{cases} 3x & x \\in [0, \\frac{1}{3}] \\\\ 2 - 3x & x \\in [\\frac{1}{3}, \\frac{2}{3}] \\\\ 0 & \\text{其他} \\end{cases}\n\\quad \\text{和} \\quad\n\\phi_2(x) = \\begin{cases} 3x - 1 & x \\in [\\frac{1}{3}, \\frac{2}{3}] \\\\ 3 - 3x & x \\in [\\frac{2}{3}, 1] \\\\ 0 & \\text{其他} \\end{cases}\n$$\n它们的导数是分片常数：\n$$\n\\phi_1'(x) = \\begin{cases} 3 & x \\in (0, \\frac{1}{3}) \\\\ -3 & x \\in (\\frac{1}{3}, \\frac{2}{3}) \\\\ 0 & \\text{其他} \\end{cases}\n\\quad \\text{和} \\quad\n\\phi_2'(x) = \\begin{cases} 3 & x \\in (\\frac{1}{3}, \\frac{2}{3}) \\\\ -3 & x \\in (\\frac{2}{3}, 1) \\\\ 0 & \\text{其他} \\end{cases}\n$$\n第一个任务是组装刚度矩阵 $K$ 和载荷向量 $F$。刚度矩阵的元素 $K_{ij} = a(\\phi_j, \\phi_i) = \\int_0^1 \\phi_j'(x) \\phi_i'(x) dx$ 按如下方式计算：\n$$\nK_{11} = a(\\phi_1, \\phi_1) = \\int_0^1 (\\phi_1'(x))^2 dx = \\int_0^{1/3} (3)^2 dx + \\int_{1/3}^{2/3} (-3)^2 dx = 9(\\frac{1}{3}) + 9(\\frac{1}{3}) = 6\n$$\n$$\nK_{22} = a(\\phi_2, \\phi_2) = \\int_0^1 (\\phi_2'(x))^2 dx = \\int_{1/3}^{2/3} (3)^2 dx + \\int_{2/3}^{1} (-3)^2 dx = 9(\\frac{1}{3}) + 9(\\frac{1}{3}) = 6\n$$\n$$\nK_{12} = a(\\phi_2, \\phi_1) = \\int_0^1 \\phi_2'(x) \\phi_1'(x) dx = \\int_{1/3}^{2/3} (3)(-3) dx = -9(\\frac{1}{3}) = -3\n$$\n由于双线性形式 $a(\\cdot, \\cdot)$ 是对称的，因此 $K_{21} = a(\\phi_1, \\phi_2) = K_{12} = -3$。所以，刚度矩阵为：\n$$\nK = \\begin{pmatrix} 6 & -3 \\\\ -3 & 6 \\end{pmatrix}\n$$\n载荷向量的元素 $F_i = \\ell(\\phi_i) = \\int_0^1 f(x) \\phi_i(x) dx$（其中 $f(x)=1$）计算如下：\n$$\nF_1 = \\ell(\\phi_1) = \\int_0^1 \\phi_1(x) dx = \\int_0^{1/3} 3x \\,dx + \\int_{1/3}^{2/3} (2-3x) \\,dx = \\left[\\frac{3x^2}{2}\\right]_0^{1/3} + \\left[2x - \\frac{3x^2}{2}\\right]_{1/3}^{2/3} = \\frac{1}{6} + \\left( (\\frac{4}{3} - \\frac{2}{3}) - (\\frac{2}{3} - \\frac{1}{6}) \\right) = \\frac{1}{6} + (\\frac{2}{3} - \\frac{3}{6}) = \\frac{1}{6} + \\frac{1}{6} = \\frac{1}{3}\n$$\n$$\nF_2 = \\ell(\\phi_2) = \\int_0^1 \\phi_2(x) dx = \\int_{1/3}^{2/3} (3x-1) \\,dx + \\int_{2/3}^{1} (3-3x) \\,dx = \\left[\\frac{3x^2}{2} - x\\right]_{1/3}^{2/3} + \\left[3x - \\frac{3x^2}{2}\\right]_{2/3}^{1} = \\left( (\\frac{2}{3} - \\frac{2}{3}) - (\\frac{1}{6} - \\frac{1}{3}) \\right) + \\left( (3 - \\frac{3}{2}) - (2 - \\frac{2}{3}) \\right) = \\frac{1}{6} + (\\frac{3}{2} - \\frac{4}{3}) = \\frac{1}{6} + \\frac{1}{6} = \\frac{1}{3}\n$$\n因此，载荷向量为：\n$$\nF = \\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{1}{3} \\end{pmatrix}\n$$\n下一个任务是求解线性系统 $K U_h = F$ 以得到系数向量 $U_h = (u_1, u_2)^\\top$：\n$$\n\\begin{pmatrix} 6 & -3 \\\\ -3 & 6 \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{1}{3} \\end{pmatrix}\n$$\n$K$ 的逆矩阵是 $K^{-1} = \\frac{1}{\\det(K)} \\begin{pmatrix} 6 & 3 \\\\ 3 & 6 \\end{pmatrix}$，其中 $\\det(K) = (6)(6) - (-3)(-3) = 36-9=27$。\n$$\nK^{-1} = \\frac{1}{27} \\begin{pmatrix} 6 & 3 \\\\ 3 & 6 \\end{pmatrix} = \\frac{1}{9} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}\n$$\n求解 $U_h$：\n$$\nU_h = K^{-1}F = \\frac{1}{9} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{1}{3} \\end{pmatrix} = \\frac{1}{9} \\begin{pmatrix} \\frac{2}{3} + \\frac{1}{3} \\\\ \\frac{1}{3} + \\frac{2}{3} \\end{pmatrix} = \\frac{1}{9} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{9} \\\\ \\frac{1}{9} \\end{pmatrix}\n$$\n所以，$u_1 = \\frac{1}{9}$ 且 $u_2 = \\frac{1}{9}$，伽辽金解为 $u_h(x) = \\frac{1}{9}\\phi_1(x) + \\frac{1}{9}\\phi_2(x)$。\n\n第三个任务是计算基函数 $v_h=\\phi_1$ 和 $v_h=\\phi_2$ 的弱残差 $R(v_h) = a(u_h, v_h) - \\ell(v_h)$。\n对于 $v_h=\\phi_1$：\n$$\nR(\\phi_1) = a(u_h, \\phi_1) - \\ell(\\phi_1) = a\\left(\\frac{1}{9}\\phi_1 + \\frac{1}{9}\\phi_2, \\phi_1\\right) - \\ell(\\phi_1)\n$$\n根据 $a(\\cdot,\\cdot)$ 的线性性质：\n$$\na(u_h, \\phi_1) = \\frac{1}{9} a(\\phi_1, \\phi_1) + \\frac{1}{9} a(\\phi_2, \\phi_1) = \\frac{1}{9} K_{11} + \\frac{1}{9} K_{12} = \\frac{1}{9}(6) + \\frac{1}{9}(-3) = \\frac{3}{9} = \\frac{1}{3}\n$$\n我们之前计算过 $\\ell(\\phi_1) = F_1 = \\frac{1}{3}$。因此，\n$$\nR(\\phi_1) = \\frac{1}{3} - \\frac{1}{3} = 0\n$$\n对于 $v_h=\\phi_2$：\n$$\nR(\\phi_2) = a(u_h, \\phi_2) - \\ell(\\phi_2) = a\\left(\\frac{1}{9}\\phi_1 + \\frac{1}{9}\\phi_2, \\phi_2\\right) - \\ell(\\phi_2)\n$$\n根据线性性质：\n$$\na(u_h, \\phi_2) = \\frac{1}{9} a(\\phi_1, \\phi_2) + \\frac{1}{9} a(\\phi_2, \\phi_2) = \\frac{1}{9} K_{21} + \\frac{1}{9} K_{22} = \\frac{1}{9}(-3) + \\frac{1}{9}(6) = \\frac{3}{9} = \\frac{1}{3}\n$$\n我们之前计算过 $\\ell(\\phi_2) = F_2 = \\frac{1}{3}$。因此，\n$$\nR(\\phi_2) = \\frac{1}{3} - \\frac{1}{3} = 0\n$$\n伽辽金正交性表明，对于所有 $v_h \\in V_h$，有 $a(u_h, v_h) - \\ell(v_h) = 0$。任何 $v_h \\in V_h$ 都可以写成 $v_h = c_1 \\phi_1 + c_2 \\phi_2$。残差泛函 $R$ 是线性的，所以 $R(v_h) = R(c_1 \\phi_1 + c_2 \\phi_2) = c_1 R(\\phi_1) + c_2 R(\\phi_2)$。由于我们已经显式计算出 $R(\\phi_1)=0$ 和 $R(\\phi_2)=0$，因此对于所有 $v_h \\in V_h$，都有 $R(v_h)=0$，从而验证了该性质。\n\n最后，我们计算 $E := |R(\\phi_1)|^2 + |R(\\phi_2)|^2$。使用计算出的值：\n$$\nE = |0|^2 + |0|^2 = 0\n$$", "answer": "$$\n\\boxed{0}\n$$", "id": "2561440"}, {"introduction": "伽辽金正交性不仅是一个优美的数学性质，它还是有限元方法误差分析的基石，直接导出了著名的Céa引理。本练习将引导您从伽辽金正交性出发，推导最佳逼近性质，并针对一类具有可变系数的物理问题，具体计算Céa引理中的连续性常数 $M$ 和矫顽性常数 $\\alpha$ [@problem_id:2561496]。这有助于您理解问题的物理性质（如材料系数）如何直接影响近似解的误差界。", "problem": "考虑单位区间上具有可变扩散系数的一维泊松边值问题。令 $V := H_{0}^{1}(0,1)$，并定义双线性形式 $a(\\cdot,\\cdot)$ 和线性泛函 $\\ell(\\cdot)$ 如下：\n$$\na(u,v) := \\int_{0}^{1} p(x)\\, u'(x)\\, v'(x)\\, dx, \\qquad \\ell(v) := \\int_{0}^{1} f(x)\\, v(x)\\, dx,\n$$\n其中 $p \\in L^{\\infty}(0,1)$ 几乎处处满足 $p(x) \\geq p_{\\min} > 0$。该模型问题的弱形式为：求 $u \\in V$ 使得\n$$\na(u,v) = \\ell(v) \\quad \\text{对所有 } v \\in V.\n$$\n设 $V_{h} \\subset V$ 是 $[0,1]$ 上具有 $N$ 个等长子区间的均匀网格上的协调分片线性 Lagrange 有限元空间，并设 $u_{h} \\in V_{h}$ 解离散问题\n$$\na(u_{h}, v_{h}) = \\ell(v_{h}) \\quad \\text{对所有 } v_{h} \\in V_{h}.\n$$\n在 $V$ 上采用能量半范数 $\\|v\\|_{E} := \\left(\\int_{0}^{1} |v'(x)|^{2}\\, dx\\right)^{1/2}$。仅从 $a(\\cdot,\\cdot)$ 关于 $\\|\\cdot\\|_{E}$ 的连续性和矫顽性的定义出发（即，存在常数 $\\alpha > 0$ 和 $M \\geq \\alpha$ 使得对所有 $v \\in V$ 有 $a(v,v) \\geq \\alpha \\|v\\|_{E}^{2}$，且对所有 $w,z \\in V$ 有 $|a(w,z)| \\leq M \\|w\\|_{E}\\|z\\|_{E}$），进行具体推导以：\n- 建立伽辽金正交性 $a(u-u_{h}, v_{h}) = 0$ 对所有 $v_{h} \\in V_{h}$ 成立，\n- 并证明能量半范数下的最佳逼近界，\n$$\n\\|u - u_{h}\\|_{E} \\leq \\frac{M}{\\alpha} \\inf_{v_{h} \\in V_{h}} \\|u - v_{h}\\|_{E}.\n$$\n\n然后，针对 $[0,1]$ 上的显式扩散系数 $p(x) := 1 + x$ 进行分析。仅使用上述定义，不借助这些定义之外的任何捷径，计算关于 $\\|\\cdot\\|_{E}$ 的连续性常数和矫顽性常数的精确值，并由此确定对于此 $p(x)$，比值 $M/\\alpha$ 的精确值。将您的最终答案以单个实数的形式给出。无需单位。请勿四舍五入。", "solution": "我们按要求推导伽辽金方法的一般性质。\n\n问题的弱形式为：求 $u \\in V$ 使得\n$$a(u,v) = \\ell(v) \\quad \\forall v \\in V.$$\n有限元逼近为：求 $u_{h} \\in V_{h}$ 使得\n$$a(u_{h}, v_{h}) = \\ell(v_{h}) \\quad \\forall v_{h} \\in V_{h}.$$\n这里，$V = H_{0}^{1}(0,1)$ 且 $V_{h}$ 是一个协调的有限维子空间，即 $V_{h} \\subset V$。\n\n**1. 伽辽金正交性的推导**\n\n被称为伽辽金正交性的性质建立了误差 $u - u_{h}$ 和离散空间 $V_{h}$ 之间的一种关系。\n由于 $V_{h} \\subset V$，精确解 $u$ 的弱形式也必须对任何测试函数 $v_{h} \\in V_{h}$ 成立。因此，我们有\n$$a(u, v_{h}) = \\ell(v_{h}) \\quad \\forall v_{h} \\in V_{h}.$$\n我们有 $u_{h}$ 满足的离散问题：\n$$a(u_{h}, v_{h}) = \\ell(v_{h}) \\quad \\forall v_{h} \\in V_{h}.$$\n用第一个方程减去第二个方程得到\n$$a(u, v_{h}) - a(u_{h}, v_{h}) = 0 \\quad \\forall v_{h} \\in V_{h}.$$\n根据双线性形式 $a(\\cdot, \\cdot)$ 对其第一个自变量的线性，我们可以合并这些项：\n$$a(u - u_{h}, v_{h}) = 0 \\quad \\forall v_{h} \\in V_{h}.$$\n这就是伽辽金正交性。它表明误差 $u-u_{h}$ 关于双线性形式 $a(\\cdot, \\cdot)$ 与整个逼近空间 $V_h$ “正交”。\n\n**2. 最佳逼近界的推导**\n\n这个结果通常被称为 Céa 引理，它给出了有限元解误差的一个上界。推导依赖于伽辽金正交性和双线性形式的假定性质。\n\n令 $e = u - u_{h}$ 为误差。根据 $a(\\cdot, \\cdot)$ 关于能量半范数 $\\| \\cdot \\|_{E}$ 的矫顽性定义，对任意 $v \\in V$ 我们有：\n$$a(v,v) \\geq \\alpha \\|v\\|_{E}^{2},$$\n其中 $\\alpha > 0$ 是矫顽性常数。将此应用于误差 $e = u-u_h \\in V$，我们得到\n$$\\alpha \\|u - u_{h}\\|_{E}^{2} \\leq a(u - u_{h}, u - u_{h}).$$\n现在，对任意函数 $v_{h} \\in V_{h}$，我们可以写出 $u - u_h = (u - v_h) + (v_h - u_h)$。利用 $a(\\cdot, \\cdot)$ 的双线性，我们有\n$$a(u - u_{h}, u - u_{h}) = a(u - u_{h}, (u - v_{h}) + (v_{h} - u_{h})) = a(u - u_{h}, u - v_{h}) + a(u - u_{h}, v_{h} - u_{h}).$$\n$v_{h} - u_{h}$ 这一项是子空间 $V_{h}$ 中两个函数的差，并且由于 $V_{h}$ 是一个向量空间，所以 $v_{h} - u_{h} \\in V_{h}$。根据上面推导的伽辽金正交性，第二项为零：\n$$a(u - u_{h}, v_{h} - u_{h}) = 0.$$\n这可将表达式简化为\n$$a(u - u_{h}, u - u_{h}) = a(u - u_{h}, u - v_{h}).$$\n我们现在应用双线性形式 $a(\\cdot, \\cdot)$ 的连续性，其定义为\n$$|a(w,z)| \\leq M \\|w\\|_{E}\\|z\\|_{E}$$\n对于某个常数 $M \\geq \\alpha$。应用此不等式，我们得到\n$$a(u - u_{h}, u - u_{h}) = a(u - u_{h}, u - v_{h}) \\leq |a(u - u_{h}, u - v_{h})| \\leq M \\|u - u_{h}\\|_{E} \\|u - v_{h}\\|_{E}.$$\n结合我们的不等式，我们有：\n$$\\alpha \\|u - u_{h}\\|_{E}^{2} \\leq a(u - u_{h}, u - u_{h}) \\leq M \\|u - u_{h}\\|_{E} \\|u - v_{h}\\|_{E}.$$\n如果 $\\|u - u_{h}\\|_{E} = 0$，所求不等式不言自明。如果 $\\|u - u_{h}\\|_{E} > 0$，我们可以两边同除以 $\\alpha \\|u - u_{h}\\|_{E}$得到\n$$\\|u - u_{h}\\|_{E} \\leq \\frac{M}{\\alpha} \\|u - v_{h}\\|_{E}.$$\n此不等式对任意 $v_{h} \\in V_{h}$ 均成立。因此，我们可以在右边对 $V_{h}$ 中 $v_{h}$ 的所有可能选择取下确界，从而得到最佳逼近界：\n$$\\|u - u_{h}\\|_{E} \\leq \\frac{M}{\\alpha} \\inf_{v_{h} \\in V_{h}} \\|u - v_{h}\\|_{E}.$$\n至此，完成了所要求的推导。\n\n接下来，我们计算在 $p(x) = 1+x$ 的特定情况下常数 $\\alpha$ 和 $M$ 的显式值。这些常数被定义为最优（最紧）界。\n\n**3. 矫顽性常数 $\\alpha$ 的计算**\n\n矫顽性常数 $\\alpha$ 是使得对所有 $v \\in V = H_0^1(0,1)$ 都有 $a(v,v) \\geq \\alpha \\|v\\|_{E}^{2}$ 成立的最大实数。根据定义，这意味着：\n$$\\alpha = \\inf_{v \\in V \\setminus \\{0\\}} \\frac{a(v,v)}{\\|v\\|_{E}^{2}} = \\inf_{v \\in V \\setminus \\{0\\}} \\frac{\\int_{0}^{1} p(x) |v'(x)|^{2} dx}{\\int_{0}^{1} |v'(x)|^{2} dx}.$$\n代入 $p(x) = 1+x$：\n$$\\alpha = \\inf_{v \\in V \\setminus \\{0\\}} \\frac{\\int_{0}^{1} (1+x) |v'(x)|^{2} dx}{\\int_{0}^{1} |v'(x)|^{2} dx}.$$\n令 $g(x) = |v'(x)|^2$。那么 $g(x)$ 是 $L^1(0,1)$ 中的一个非负函数，且不恒为零。该表达式是函数 $p(x)=1+x$ 以权函数 $g(x)$ 进行的加权平均。这种加权平均的下确界就是被平均函数的本性下确界。\n$$\\alpha = \\underset{x \\in (0,1)}{\\mathrm{ess\\,inf}} \\, p(x) = \\underset{x \\in (0,1)}{\\mathrm{ess\\,inf}} \\, (1+x).$$\n由于 $p(x)=1+x$ 是闭区间 $[0,1]$ 上的连续函数，其本性下确界就是它的最小值。函数 $1+x$ 是严格递增的，因此它在 $[0,1]$ 上的最小值在 $x=0$ 处取得。\n$$\\alpha = \\min_{x \\in [0,1]} (1+x) = 1+0 = 1.$$\n\n**4. 连续性常数 $M$ 的计算**\n\n连续性常数 $M$ 是使得对所有 $w,z \\in V$ 都有 $|a(w,z)| \\leq M \\|w\\|_{E}\\|z\\|_{E}$ 成立的最小实数。这等价于该双线性形式的算子范数：\n$$M = \\sup_{w,z \\in V \\setminus \\{0\\}} \\frac{|a(w,z)|}{\\|w\\|_{E}\\|z\\|_{E}} = \\sup_{w,z \\in V \\setminus \\{0\\}} \\frac{|\\int_{0}^{1} p(x) w'(x) z'(x) dx|}{\\left(\\int_{0}^{1} |w'(x)|^{2} dx\\right)^{1/2} \\left(\\int_{0}^{1} |z'(x)|^{2} dx\\right)^{1/2}}.$$\n泛函分析中的一个标准结果指出，对于一个实对称双线性形式，其上确界在 $w=z$ 时达到。因此，\n$$M = \\sup_{v \\in V \\setminus \\{0\\}} \\frac{|a(v,v)|}{\\|v\\|_{E}^{2}} = \\sup_{v \\in V \\setminus \\{0\\}} \\frac{\\int_{0}^{1} p(x) |v'(x)|^{2} dx}{\\int_{0}^{1} |v'(x)|^{2} dx}.$$\n代入 $p(x)=1+x$：\n$$M = \\sup_{v \\in V \\setminus \\{0\\}} \\frac{\\int_{0}^{1} (1+x) |v'(x)|^{2} dx}{\\int_{0}^{1} |v'(x)|^{2} dx}.$$\n与矫顽性常数类似，此表达式代表 $p(x)=1+x$ 的一个加权平均。这种平均的上确界是函数 $p(x)$ 的本性上确界。\n$$M = \\underset{x \\in (0,1)}{\\mathrm{ess\\,sup}} \\, p(x) = \\underset{x \\in (0,1)}{\\mathrm{ess\\,sup}} \\, (1+x).$$\n同样，由于 $p(x)=1+x$ 是连续的，其本性上确界是它在 $[0,1]$ 上的最大值。这个值在 $x=1$ 处取得。\n$$M = \\max_{x \\in [0,1]} (1+x) = 1+1 = 2.$$\n\n**5. 最终比值**\n\n问题要求比值 $M/\\alpha$ 的精确值。使用计算出的常数：\n$$ \\frac{M}{\\alpha} = \\frac{2}{1} = 2. $$\n这个比值量化了问题在能量半范数下的性态。", "answer": "$$\n\\boxed{2}\n$$", "id": "2561496"}, {"introduction": "理论的边界往往是加深理解的最佳试验场。标准有限元理论的一个关键假设是协调性，即近似空间 $V_h$ 是真实解空间 $V$ 的子空间。本练习通过一个精心设计的非协调元，挑战了这一假设 [@problem_id:2561497]。您将发现伽辽金正交性不再成立，并需要计算由此产生的“正交性缺陷”，从而揭示其与方法的一致性误差之间的深刻联系。", "problem": "设 $V := H_{0}^{1}(0,1)$，考虑一维线性偏微分方程（PDE）的边值问题\n$$\n-u'' = x \\quad \\text{在 } (0,1) \\text{ 中}, \\qquad u(0)=u(1)=0,\n$$\n其弱形式为：求 $u \\in V$ 使得\n$$\na(u,v) = \\ell(v) \\quad \\text{对所有 } v \\in V,\n$$\n其中\n$$\na(w,v) := \\int_{0}^{1} w'(x)\\,v'(x)\\,dx, \n\\qquad \n\\ell(v) := \\int_{0}^{1} x\\,v(x)\\,dx.\n$$\n定义一个非协调离散空间 $V_{h}$ 为\n$$\nV_{h} := \\left\\{ v_{h} \\,\\middle|\\, v_{h}\\big|_{(0,\\frac{1}{2})} \\text{ 和 } v_{h}\\big|_{(\\frac{1}{2},1)} \\text{ 是线性的, } v_{h}(0)=0,\\ v_{h}(1)=0 \\right\\},\n$$\n在 $x=\\tfrac{1}{2}$ 处不强制要求连续性。设基函数 $\\{\\varphi_{L},\\varphi_{R}\\} \\subset V_{h}$ 定义为\n$$\n\\varphi_{L}(x) := \n\\begin{cases}\n2x, & x \\in [0,\\tfrac{1}{2}],\\\\\n0, & x \\in (\\tfrac{1}{2},1],\n\\end{cases}\n\\qquad\n\\varphi_{R}(x) := \n\\begin{cases}\n0, & x \\in [0,\\tfrac{1}{2}),\\\\\n2(1-x), & x \\in [\\tfrac{1}{2},1].\n\\end{cases}\n$$\n考虑朴素的非协调有限元法（FEM），其定义为：求 $u_{h} \\in V_{h}$ 使得\n$$\na_{h}(u_{h},v_{h}) = \\ell(v_{h}) \\quad \\text{对所有 } v_{h} \\in V_{h},\n$$\n其中\n$$\na_{h}(w_{h},v_{h}) := \\int_{0}^{\\frac{1}{2}} w_{h}'(x)\\,v_{h}'(x)\\,dx \\;+\\; \\int_{\\frac{1}{2}}^{1} w_{h}'(x)\\,v_{h}'(x)\\,dx.\n$$\n任务：\n1) 从强形式偏微分方程和边界条件出发，确定精确解 $u$。\n2) 将 $u_{h} \\in V_{h}$ 参数化为在 $[0,\\tfrac{1}{2}]$ 上 $u_{h}(x) = \\alpha x$ 和在 $[\\tfrac{1}{2},1]$ 上 $u_{h}(x) = \\beta(1-x)$，并用 $\\varphi_{L}$ 和 $\\varphi_{R}$ 测试离散方程以确定系数 $\\alpha$ 和 $\\beta$。\n3) 仅使用上述定义，计算伽辽金正交性缺陷\n$$\n\\delta := a(u-u_{h},\\varphi_{L}).\n$$\n4) 精确指出常规伽辽金正交性证明（即推导得出对所有 $v_{h}$ 都有 $a(u-u_{h},v_{h})=0$ 的过程）中，哪一步因 $V_{h} \\not\\subset V$ 而在此不适用，并写出本例中替代它的界面协调性项；验证其值与您计算的 $\\delta$ 相等。\n\n将单个实数 $\\delta$ 作为您的最终答案，以精确形式报告（无四舍五入）。无需单位。", "solution": "问题分为四个任务，我们将按顺序解决。\n\n**1. 确定精确解 $u$**\n\n该边值问题的强形式由微分方程 $-u'' = x$（对于 $x \\in (0,1)$）和齐次狄利克雷边界条件 $u(0)=0$ 及 $u(1)=0$ 给出。\n\n我们首先对微分方程关于 $x$ 积分两次。\n第一次积分得到：\n$$\n-u'(x) = \\int x \\,dx = \\frac{x^2}{2} + C_1\n$$\n其中 $C_1$ 是一个积分常数。\n第二次积分得到：\n$$\n-u(x) = \\int \\left(\\frac{x^2}{2} + C_1\\right) dx = \\frac{x^3}{6} + C_1 x + C_2\n$$\n其中 $C_2$ 是第二个积分常数。因此，通解为 $u(x) = -\\frac{x^3}{6} - C_1 x - C_2$。\n\n现在我们应用边界条件来确定常数 $C_1$ 和 $C_2$。\n条件 $u(0)=0$ 意味着：\n$$\nu(0) = -\\frac{0^3}{6} - C_1(0) - C_2 = 0 \\implies C_2 = 0\n$$\n条件 $u(1)=0$ 意味着：\n$$\nu(1) = -\\frac{1^3}{6} - C_1(1) - 0 = 0 \\implies -\\frac{1}{6} - C_1 = 0 \\implies C_1 = -\\frac{1}{6}\n$$\n将 $C_1$ 和 $C_2$ 的值代回通解，我们得到精确解：\n$$\nu(x) = -\\frac{x^3}{6} - \\left(-\\frac{1}{6}\\right)x = \\frac{x - x^3}{6}\n$$\n为了后续使用，我们也计算精确解的导数：\n$$\nu'(x) = \\frac{d}{dx}\\left(\\frac{x - x^3}{6}\\right) = \\frac{1 - 3x^2}{6}\n$$\n\n**2. 确定离散解 $u_h$**\n\n离散解 $u_h \\in V_h$ 通过求解离散弱形式 $a_h(u_h,v_h) = \\ell(v_h)$（对所有 $v_h \\in V_h$）来找到。用基函数 $\\{\\varphi_L, \\varphi_R\\}$ 来测试此方程是充分的。\n\n离散解参数化为在 $[0,\\tfrac{1}{2}]$ 上 $u_h(x) = \\alpha x$ 和在 $[\\tfrac{1}{2},1]$ 上 $u_h(x) = \\beta(1-x)$。因此，其导数为在 $(0,\\tfrac{1}{2})$ 上 $u_h'(x) = \\alpha$ 和在 $(\\tfrac{1}{2},1)$ 上 $u_h'(x) = -\\beta$。\n\n基函数的导数为在 $(0,\\tfrac{1}{2})$ 上 $\\varphi_L'(x) = 2$ 且在 $(\\tfrac{1}{2},1)$ 上 $\\varphi_L'(x) = 0$，而 在 $(0,\\tfrac{1}{2})$ 上 $\\varphi_R'(x) = 0$ 且在 $(\\tfrac{1}{2},1)$ 上 $\\varphi_R'(x) = -2$。\n\n我们为系数 $\\alpha$ 和 $\\beta$ 建立一个 $2 \\times 2$ 的线性系统。\n\n对于第一个方程，我们用 $v_h = \\varphi_L$ 进行测试：\n$$\na_h(u_h, \\varphi_L) = \\ell(\\varphi_L)\n$$\n左边是：\n$$\na_h(u_h, \\varphi_L) = \\int_0^{\\frac{1}{2}} u_h'(x)\\varphi_L'(x) dx + \\int_{\\frac{1}{2}}^1 u_h'(x)\\varphi_L'(x) dx = \\int_0^{\\frac{1}{2}} (\\alpha)(2)\\,dx + \\int_{\\frac{1}{2}}^1 (-\\beta)(0)\\,dx = 2\\alpha \\int_0^{\\frac{1}{2}} dx = 2\\alpha\\left(\\frac{1}{2}\\right) = \\alpha\n$$\n右边是：\n$$\n\\ell(\\varphi_L) = \\int_0^1 x \\varphi_L(x) dx = \\int_0^{\\frac{1}{2}} x(2x) dx = 2\\int_0^{\\frac{1}{2}} x^2 dx = 2\\left[\\frac{x^3}{3}\\right]_0^{\\frac{1}{2}} = 2\\left(\\frac{(1/2)^3}{3}\\right) = 2\\left(\\frac{1}{24}\\right) = \\frac{1}{12}\n$$\n因此，第一个方程是 $\\alpha = \\frac{1}{12}$。\n\n对于第二个方程，我们用 $v_h = \\varphi_R$ 进行测试：\n$$\na_h(u_h, \\varphi_R) = \\ell(\\varphi_R)\n$$\n左边是：\n$$\na_h(u_h, \\varphi_R) = \\int_0^{\\frac{1}{2}} u_h'(x)\\varphi_R'(x) dx + \\int_{\\frac{1}{2}}^1 u_h'(x)\\varphi_R'(x) dx = \\int_0^{\\frac{1}{2}} (\\alpha)(0)\\,dx + \\int_{\\frac{1}{2}}^1 (-\\beta)(-2)\\,dx = 2\\beta \\int_{\\frac{1}{2}}^1 dx = 2\\beta\\left(\\frac{1}{2}\\right) = \\beta\n$$\n右边是：\n$$\n\\ell(\\varphi_R) = \\int_0^1 x \\varphi_R(x) dx = \\int_{\\frac{1}{2}}^1 x(2(1-x)) dx = 2\\int_{\\frac{1}{2}}^1 (x - x^2) dx = 2\\left[\\frac{x^2}{2} - \\frac{x^3}{3}\\right]_{\\frac{1}{2}}^1\n$$\n$$\n= 2\\left[ \\left(\\frac{1}{2}-\\frac{1}{3}\\right) - \\left(\\frac{(1/2)^2}{2} - \\frac{(1/2)^3}{3}\\right) \\right] = 2\\left[ \\frac{1}{6} - \\left(\\frac{1}{8} - \\frac{1}{24}\\right) \\right] = 2\\left[ \\frac{1}{6} - \\frac{2}{24} \\right] = 2\\left[ \\frac{1}{6} - \\frac{1}{12} \\right] = 2\\left(\\frac{1}{12}\\right) = \\frac{1}{6}\n$$\n因此，第二个方程是 $\\beta = \\frac{1}{6}$。\n\n离散解为在 $[0,\\tfrac{1}{2}]$ 上 $u_h(x) = \\frac{1}{12}x$，在 $[\\tfrac{1}{2},1]$ 上 $u_h(x) = \\frac{1}{6}(1-x)$。\n\n**3. 计算伽辽金正交性缺陷 $\\delta$**\n\n缺陷定义为 $\\delta := a(u-u_h,\\varphi_{L})$。双线性形式 $a(\\cdot,\\cdot)$ 是在整个定义域 $(0,1)$ 上的积分。\n$$\n\\delta = \\int_0^1 (u'(x) - u_h'(x))\\varphi_L'(x) dx\n$$\n由于当 $x > \\frac{1}{2}$ 时 $\\varphi_L'(x) = 0$，积分简化为在区间 $(0, \\frac{1}{2})$ 上：\n$$\n\\delta = \\int_0^{\\frac{1}{2}} (u'(x) - u_h'(x))\\varphi_L'(x) dx\n$$\n在此区间上，我们有 $u'(x) = \\frac{1-3x^2}{6}$， $u_h'(x) = \\alpha = \\frac{1}{12}$，以及 $\\varphi_L'(x) = 2$。\n$$\n\\delta = \\int_0^{\\frac{1}{2}} \\left( \\frac{1-3x^2}{6} - \\frac{1}{12} \\right) (2) dx = 2 \\int_0^{\\frac{1}{2}} \\frac{2(1-3x^2) - 1}{12} dx = \\frac{1}{6} \\int_0^{\\frac{1}{2}} (1 - 6x^2) dx\n$$\n计算该积分：\n$$\n\\delta = \\frac{1}{6} \\left[ x - 2x^3 \\right]_0^{\\frac{1}{2}} = \\frac{1}{6} \\left( \\left(\\frac{1}{2}\\right) - 2\\left(\\frac{1}{2}\\right)^3 \\right) = \\frac{1}{6} \\left( \\frac{1}{2} - 2\\left(\\frac{1}{8}\\right) \\right) = \\frac{1}{6} \\left( \\frac{1}{2} - \\frac{1}{4} \\right) = \\frac{1}{6} \\left( \\frac{1}{4} \\right) = \\frac{1}{24}\n$$\n\n**4. 伽辽金正交性失效分析**\n\n对于一个标准的协调方法，其中离散空间 $V_h$ 是连续空间 $V$ 的一个子空间（即 $V_h \\subset V$），伽辽金正交性成立：对所有 $v_h \\in V_h$ 有 $a(u-u_h, v_h) = 0$。证明如下：\n$$\na(u-u_h, v_h) = a(u, v_h) - a(u_h, v_h)\n$$\n由于 $v_h \\in V_h \\subset V$，我们可以在连续弱形式中使用 $v_h$ 作为测试函数，得到 $a(u, v_h) = \\ell(v_h)$。协调离散形式为 $a(u_h, v_h) = \\ell(v_h)$。代入这些可得：\n$$\na(u-u_h, v_h) = \\ell(v_h) - \\ell(v_h) = 0\n$$\n在当前问题中失效的步骤是 $V_h \\subset V$ 这个假设。空间 $V=H_0^1(0,1)$ 包含的函数（等价于）是连续函数。离散空间 $V_h$ 由分段线性函数组成，但这些函数在界面 $x=\\frac{1}{2}$ 处不要求是连续的。例如，对于基函数 $\\varphi_L$，我们有 $\\varphi_L(\\frac{1}{2}^-) = 1$ 和 $\\varphi_L(\\frac{1}{2}^+) = 0$。这种跳跃间断意味着 $\\varphi_L \\notin H^1(0,1)$，因此 $V_h \\not\\subset V$。所以，我们不能在连续弱形式 $a(u,v) = \\ell(v)$ 中令 $v = v_h$。\n\n为了找到正确的关系，我们必须回到第一性原理。对于一个光滑解 $u$ 和一个测试函数 $v_h \\in V_h$，我们将 $-u''=x$ 乘以 $v_h$ 进行积分，并按单元进行分部积分：\n$$\n\\ell(v_h) = \\int_0^1 x v_h(x) dx = \\int_0^1 (-u''(x)) v_h(x) dx = \\int_0^{\\frac{1}{2}} (-u'') v_h dx + \\int_{\\frac{1}{2}}^1 (-u'') v_h dx\n$$\n对每个积分应用分部积分：\n$$\n\\ell(v_h) = \\left[-u'v_h\\right]_0^{\\frac{1}{2}^-} + \\int_0^{\\frac{1}{2}} u' v_h' dx + \\left[-u'v_h\\right]_{\\frac{1}{2}^+}^1 + \\int_{\\frac{1}{2}}^1 u' v_h' dx\n$$\n根据定义，这些积分的和是 $a(u, v_h)$。在 $x=0$ 和 $x=1$ 处的边界项因为 $v_h(0)=v_h(1)=0$ 而消失。剩下的项是在 $x=\\frac{1}{2}$ 处的界面项：\n$$\n\\left(-u'(\\tfrac{1}{2})v_h(\\tfrac{1}{2}^-)\\right) - \\left(-u'(\\tfrac{1}{2})v_h(\\tfrac{1}{2}^+)\\right) = u'(\\tfrac{1}{2}) \\left( v_h(\\tfrac{1}{2}^+) - v_h(\\tfrac{1}{2}^-) \\right) = u'(\\tfrac{1}{2}) [|v_h|]_{\\frac{1}{2}}\n$$\n其中 $[|v_h|]_{\\frac{1}{2}}$ 是 $v_h$ 在 $x=\\frac{1}{2}$ 处的跳跃。\n这给出了一个恒等式（格林恒等式的一种形式）：\n$$\n\\ell(v_h) = a(u, v_h) + u'(\\tfrac{1}{2})[|v_h|]_{\\frac{1}{2}}\n$$\n这可以重写为 $a(u, v_h) = \\ell(v_h) - u'(\\tfrac{1}{2})[|v_h|]_{\\frac{1}{2}}$。项 $u'(\\tfrac{1}{2})[|v_h|]_{\\frac{1}{2}}$ 是界面协调性项。对于协调元（其跳跃为零），此项为零，但在这里不为零。\n\n现在，我们可以表示误差：\n$$\na(u-u_h, v_h) = a(u,v_h) - a(u_h, v_h)\n$$\n在这个问题中，$a_h(w_h, v_h)$ 定义为单元积分之和，因此 $a_h(u_h, v_h) = a(u_h, v_h)$。从离散形式可知，$a(u_h, v_h) = \\ell(v_h)$。\n$$\na(u-u_h, v_h) = \\left( \\ell(v_h) - u'(\\tfrac{1}{2})[|v_h|]_{\\frac{1}{2}} \\right) - \\ell(v_h) = -u'(\\tfrac{1}{2})[|v_h|]_{\\frac{1}{2}}\n$$\n伽辽金正交关系被此表达式所取代，该表达式衡量了方法的一致性误差。\n\n我们对 $v_h = \\varphi_L$ 验证这个公式，其缺陷为 $\\delta$。\n首先，计算 $u'(\\frac{1}{2})$：\n$$\nu'(\\tfrac{1}{2}) = \\frac{1-3(\\frac{1}{2})^2}{6} = \\frac{1 - \\frac{3}{4}}{6} = \\frac{\\frac{1}{4}}{6} = \\frac{1}{24}\n$$\n接下来，计算跳跃 $[|\\varphi_L|]_{\\frac{1}{2}}$：\n$$\n\\varphi_L(\\tfrac{1}{2}^-) = 2x \\big|_{x=\\frac{1}{2}} = 1, \\qquad \\varphi_L(\\tfrac{1}{2}^+) = 0\n$$\n$$\n[|\\varphi_L|]_{\\frac{1}{2}} = \\varphi_L(\\tfrac{1}{2}^+) - \\varphi_L(\\tfrac{1}{2}^-) = 0 - 1 = -1\n$$\n使用推导出的缺陷公式：\n$$\n\\delta = a(u-u_h, \\varphi_L) = -u'(\\tfrac{1}{2})[|\\varphi_L|]_{\\frac{1}{2}} = -\\left(\\frac{1}{24}\\right)(-1) = \\frac{1}{24}\n$$\n这个结果与任务3中直接计算的 $\\delta$ 值相匹配，从而验证了我们的分析。", "answer": "$$\\boxed{\\frac{1}{24}}$$", "id": "2561497"}]}