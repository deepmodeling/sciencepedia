{"hands_on_practices": [{"introduction": "在有限元分析中，补片测试 (patch test) 是验证数值格式有效性的一个基本标准。它确保了当精确解是一个简单的常数或线性场时，我们的离散化方法能够精确地重现该解。本练习将通过一个经典的接触牵引力补片测试，来检验和比较几种常见的接触离散化方法，包括点-面法 (node-to-segment)、面-面法 (segment-to-segment) 和砂浆法 (mortar method)，验证它们是否能在一个均匀压力场景下保持一致性。[@problem_id:2584061]", "problem": "一个直的、平面的接触界面被建模为沿 $x$ 轴的一维线段 $\\Gamma = [0,1]$，其单位外法线向量 $\\boldsymbol{n}$ 固定不变。两个线弹性体沿着 $\\Gamma$ 被压合在一起，其精确的法向接触牵引力（接触压力）是均匀的：$p(x) \\equiv p_{0}$，其中 $p_{0} > 0$。法向的精确运动间隙函数在 $\\Gamma$ 上处处为 $g(x) \\equiv 0$，并且不可穿透互补条件简化为一致状态 $g(x)=0$, $p(x)=p_{0}$。\n\n考虑牵引力分片检验：在 $\\Gamma$ 上的弱形式接触平衡方程陈述为，对于所有容许的虚法向间隙 $w(x)$，\n$$\n\\int_{\\Gamma} p(x)\\,w(x)\\,\\mathrm{d}x \\;=\\; \\int_{0}^{1} p_{0}\\,w(x)\\,\\mathrm{d}x.\n$$\n设主侧由单个线性有限元离散，节点形函数为 $N_{1}(x)=1-x$ 和 $N_{2}(x)=x$，定义在 $[0,1]$ 上。设从侧由两个线性单元离散，从节点位于 $x^{s}=\\{0,\\,0.3,\\,1\\}$，形成单元子区间 $[0,0.3]$ 和 $[0.3,1]$。\n\n使用三种不同的界面离散化方法来近似接触牵引力，每种方法都通过上述基本弱形式在 $\\Gamma$ 上定义一个离散牵引力场 $p_{h}(x)$：\n\n1) 点到段(Node-to-segment)方法：取从侧节点形函数 $\\{\\psi_{i}\\}_{i=1}^{3}$ 作为接触相互作用的检验函数，并在从网格上采用节点集中质量求积，使得 $\\int_{0}^{1} q(x)\\,\\psi_{i}(x)\\,\\mathrm{d}x \\approx w_{i}\\,q(x_{i}^{s})$，其中节点权重是标准的分片长度 $w_{1}=\\tfrac{1}{2}(0.3-0)$，$w_{2}=\\tfrac{1}{2}[(0.3-0)+(1-0.3)]$ 和 $w_{3}=\\tfrac{1}{2}(1-0.3)$。推导该离散化所蕴含的离散牵引力场 $p_{h}^{\\mathrm{N2S}}(x)$，并计算其相对于 $p_{0}$ 的归一化 $L^{2}$ 误差。\n\n2) 段到段(Segment-to-segment)方法：将牵引力近似为每个从分段上的分片常数，$p_{h}^{\\mathrm{S2S}}(x)=t_{1}$ (对于 $x\\in[0,0.3]$) 和 $p_{h}^{\\mathrm{S2S}}(x)=t_{2}$ (对于 $x\\in[0.3,1]$)。使用主侧检验函数 $N_{1}(x)$ 和 $N_{2}(x)$ 施加弱形式平衡，并在每个子区间上使用精确积分来确定 $t_{1}$ 和 $t_{2}$。计算 $p_{h}^{\\mathrm{S2S}}(x)$ 相对于 $p_{0}$ 的归一化 $L^{2}$ 误差。\n\n3) Mortar方法：假设采用一种保持常数的对偶（双正交）Mortar离散化，即离散界面双线性形式能够精确地再现常数牵引力与由 $\\{N_{1},N_{2}\\}$ 张成的主检验空间所作的积分。推导离散牵引力场 $p_{h}^{\\mathrm{M}}(x)$ 并计算其相对于 $p_{0}$ 的归一化 $L^{2}$ 误差。\n\n使用在 $\\Gamma$ 上的归一化 $L^{2}$ 误差，\n$$\nE\\big(p_{h}\\big) \\;=\\; \\frac{\\big\\|p_{h}-p_{0}\\big\\|_{L^{2}(0,1)}}{\\big\\|p_{0}\\big\\|_{L^{2}(0,1)}}\n\\;=\\; \\frac{\\left(\\int_{0}^{1}\\big(p_{h}(x)-p_{0}\\big)^{2}\\,\\mathrm{d}x\\right)^{1/2}}{\\left(\\int_{0}^{1}p_{0}^{2}\\,\\mathrm{d}x\\right)^{1/2}}.\n$$\n最后，计算单个标量值\n$$\nE_{\\max} \\;=\\; \\max\\!\\big\\{\\,E\\!\\big(p_{h}^{\\mathrm{N2S}}\\big),\\;E\\!\\big(p_{h}^{\\mathrm{S2S}}\\big),\\;E\\!\\big(p_{h}^{\\mathrm{M}}\\big)\\big\\}.\n$$\n将您的最终答案表示为一个纯数字（无单位）。无需四舍五入。", "solution": "问题陈述为三种不同的一维接触界面离散化方法构成了一个适定的牵引力分片检验。任务是确定每种方法的离散牵引力场 $p_h(x)$，并计算其相对于精确均匀牵引力 $p(x) = p_0$ 的归一化 $L^2$ 误差。该问题具有科学依据，并提供了所有必要的数据和定义。我将开始解题。\n\n为简单起见且不失一般性，我们可以设定常数牵引力 $p_0=1$。最终误差是一个归一化量，与 $p_0$ 的值无关。对于一个离散牵引力场 $p_h(x)$ 和一个检验函数 $w(x)$，弱形式接触平衡方程为\n$$\n\\int_{0}^{1} p_h(x)\\,w(x)\\,\\mathrm{d}x = \\int_{0}^{1} 1 \\cdot w(x)\\,\\mathrm{d}x\n$$\n归一化 $L^2$ 误差由下式给出\n$$\nE(p_h) = \\frac{\\left(\\int_{0}^{1}(p_h(x)-1)^{2}\\,\\mathrm{d}x\\right)^{1/2}}{\\left(\\int_{0}^{1}1^{2}\\,\\mathrm{d}x\\right)^{1/2}} = \\left(\\int_{0}^{1}(p_h(x)-1)^{2}\\,\\mathrm{d}x\\right)^{1/2}\n$$\n\n**1) 点到段 (N2S) 方法**\n\n对于点到段方法，检验函数是从侧节点形函数，$w(x) = \\psi_i(x)$，$i=1,2,3$。每个检验函数的离散弱形式为\n$$\n\\int_{0}^{1} p_h^{\\mathrm{N2S}}(x)\\,\\psi_{i}(x)\\,\\mathrm{d}x = \\int_{0}^{1} 1 \\cdot \\psi_i(x)\\,\\mathrm{d}x\n$$\n问题指定对左侧积分使用节点集中质量求积，其定义为 $\\int_{0}^{1} q(x)\\,\\psi_{i}(x)\\,\\mathrm{d}x \\approx w_{i}\\,q(x_{i}^{s})$。从节点位于 $x^s_1=0$，$x^s_2=0.3$ 和 $x^s_3=1$。应用此规则，弱形式变为：\n$$\nw_i\\,p_h^{\\mathrm{N2S}}(x_i^s) = \\int_{0}^{1} \\psi_i(x)\\,\\mathrm{d}x\n$$\n一个线性有限元形函数在定义域上的积分是其“帽子”函数下方的面积，这恰好是节点集中权重的标准定义 $w_i$。问题给出了这些权重：$w_1 = 0.15$，$w_2 = 0.5$ 和 $w_3 = 0.35$。我们来验证一下：\n$$\n\\int_0^1 \\psi_1(x)dx = \\int_0^{0.3} \\frac{0.3-x}{0.3} dx = \\frac{1}{2} \\times 0.3 \\times 1 = 0.15 = w_1\n$$\n$$\n\\int_0^1 \\psi_2(x)dx = \\int_0^{0.3} \\frac{x}{0.3} dx + \\int_{0.3}^1 \\frac{1-x}{0.7} dx = \\frac{1}{2}(0.3) + \\frac{1}{2}(0.7) = 0.5 = w_2\n$$\n$$\n\\int_0^1 \\psi_3(x)dx = \\int_{0.3}^1 \\frac{x-0.3}{0.7} dx = \\frac{1}{2}(0.7) = 0.35 = w_3\n$$\n因此，牵引力节点值的方程简化为：\n$w_i\\,p_h^{\\mathrm{N2S}}(x_i^s) = w_i \\implies p_h^{\\mathrm{N2S}}(x_i^s) = 1$ for $i=1,2,3$.\n所以，我们得到牵引力值为 $p_h^{\\mathrm{N2S}}(0)=1$，$p_h^{\\mathrm{N2S}}(0.3)=1$ 和 $p_h^{\\mathrm{N2S}}(1)=1$。\n离散牵引力场 $p_h(x)$ 是主侧上的一个场，主侧由单个线性单元离散化。因此，很自然地使用主侧形函数 $N_1(x)=1-x$ 和 $N_2(x)=x$ 来表示 $p_h(x)$：\n$$\np_h^{\\mathrm{N2S}}(x) = c_1 N_1(x) + c_2 N_2(x)\n$$\n其中 $c_1$ 和 $c_2$ 是主节点（$x=0$ 和 $x=1$）处的节点牵引力值。\n使用从节点评估的结果：\n在 $x=0$ 处：$p_h^{\\mathrm{N2S}}(0) = c_1 N_1(0) + c_2 N_2(0) = c_1$。因为 $p_h^{\\mathrm{N2S}}(0)=1$，我们有 $c_1=1$。\n在 $x=1$ 处：$p_h^{\\mathrm{N2S}}(1) = c_1 N_1(1) + c_2 N_2(1) = c_2$。因为 $p_h^{\\mathrm{N2S}}(1)=1$，我们有 $c_2=1$。\n因此，牵引力场为：\n$$\np_h^{\\mathrm{N2S}}(x) = 1 \\cdot (1-x) + 1 \\cdot x = 1\n$$\n这也满足了中间从节点 $x=0.3$ 处的条件：$p_h^{\\mathrm{N2S}}(0.3) = 1 \\cdot (1-0.3) + 1 \\cdot 0.3 = 0.7 + 0.3 = 1$。\n离散牵引力场与精确场相同，$p_h^{\\mathrm{N2S}}(x)=1$。误差为：\n$$\nE(p_h^{\\mathrm{N2S}}) = \\left(\\int_{0}^{1}(1-1)^{2}\\,\\mathrm{d}x\\right)^{1/2} = 0\n$$\n\n**2) 段到段 (S2S) 方法**\n\n牵引力场被近似为分片常数：$p_h^{\\mathrm{S2S}}(x) = t_1$ (对于 $x \\in [0,0.3]$) 和 $p_h^{\\mathrm{S2S}}(x) = t_2$ (对于 $x \\in [0.3,1]$)。检验函数是主侧形函数 $N_1(x)=1-x$ 和 $N_2(x)=x$。我们为 $t_1$ 和 $t_2$ 建立一个 $2 \\times 2$ 的方程组。\n\n对于检验函数 $w(x)=N_1(x)$：\n$$\n\\int_0^{0.3} t_1(1-x)dx + \\int_{0.3}^1 t_2(1-x)dx = \\int_0^1 (1-x)dx\n$$\n$$\nt_1 \\left[x-\\frac{x^2}{2}\\right]_0^{0.3} + t_2 \\left[x-\\frac{x^2}{2}\\right]_{0.3}^1 = \\left[x-\\frac{x^2}{2}\\right]_0^1\n$$\n$$\nt_1 (0.3 - \\frac{0.09}{2}) + t_2 \\left((1-\\frac{1}{2}) - (0.3 - \\frac{0.09}{2})\\right) = \\frac{1}{2}\n$$\n$$\n0.255\\,t_1 + 0.245\\,t_2 = 0.5\n$$\n对于检验函数 $w(x)=N_2(x)$：\n$$\n\\int_0^{0.3} t_1 x dx + \\int_{0.3}^1 t_2 x dx = \\int_0^1 x dx\n$$\n$$\nt_1 \\left[\\frac{x^2}{2}\\right]_0^{0.3} + t_2 \\left[\\frac{x^2}{2}\\right]_{0.3}^1 = \\left[\\frac{x^2}{2}\\right]_0^1\n$$\n$$\nt_1 (\\frac{0.09}{2}) + t_2 (\\frac{1}{2} - \\frac{0.09}{2}) = \\frac{1}{2}\n$$\n$$\n0.045\\,t_1 + 0.455\\,t_2 = 0.5\n$$\n我们得到一个由两个线性方程组成的方程组：\n1) $0.255\\,t_1 + 0.245\\,t_2 = 0.5$\n2) $0.045\\,t_1 + 0.455\\,t_2 = 0.5$\n将第一个方程减去第二个方程得到：\n$$\n(0.255 - 0.045)t_1 + (0.245 - 0.455)t_2 = 0 \\implies 0.21 t_1 - 0.21 t_2 = 0 \\implies t_1 = t_2\n$$\n将 $t_1=t_2$ 代入第一个方程：\n$0.255\\,t_1 + 0.245\\,t_1 = 0.5 \\implies 0.5\\,t_1 = 0.5 \\implies t_1 = 1$\n因此，$t_1 = t_2 = 1$。离散牵引力场对所有 $x \\in [0,1]$ 均为 $p_h^{\\mathrm{S2S}}(x)=1$。这是因为试探函数空间（分片常数）包含了精确解（一个常数）。精确解在该空间上的投影就是其自身。误差为：\n$$\nE(p_h^{\\mathrm{S2S}}) = \\left(\\int_{0}^{1}(1-1)^{2}\\,\\mathrm{d}x\\right)^{1/2} = 0\n$$\n\n**3) Mortar 方法**\n\n问题指出 Mortar 离散化“保持常数”。这是构造良好的 Mortar 方法的一个基本性质，确保它们能够通过常数场的分片检验。形式上，这意味着对于一个常数牵引力场 $p(x) = p_0$，相应的离散牵引力场 $p_h^{\\mathrm{M}}(x)$ 精确地等于 $p_0$。\n让我们确认为何必须如此。该方法在乘子函数空间 $M_h$ 中寻找 $p_h^{\\mathrm{M}}$，使得对于主空间 $W_h = \\text{span}\\{N_1, N_2\\}$ 中的所有检验函数 $w_h$，下式成立：\n$$\n\\int_0^1 p_h^{\\mathrm{M}}(x) w_h(x) dx = \\int_0^1 p_0 w_h(x) dx\n$$\n一个保持常数的方法要求常数函数本身是乘子空间 $M_h$ 的一个元素。如果 $p_0 \\in M_h$，那么设定 $p_h^{\\mathrm{M}}(x) = p_0$ 会自然地满足弱形式：\n$$\n\\int_0^1 p_0 w_h(x) dx = \\int_0^1 p_0 w_h(x) dx\n$$\n假设该方法是适定的（即解是唯一的），那么这必定是解。因此，$p_h^{\\mathrm{M}}(x) = p_0$（在我们的例子中是 1）。\n因此，离散牵引力场为 $p_h^{\\mathrm{M}}(x) = 1$。误差为：\n$$\nE(p_h^{\\mathrm{M}}) = \\left(\\int_{0}^{1}(1-1)^{2}\\,\\mathrm{d}x\\right)^{1/2} = 0\n$$\n\n**结论**\n\n所有三种指定的接触离散化方法都通过了常数压力场的牵引力分片检验，这意味着它们完美地再现了精确的常数解。\n每种方法的归一化 $L^2$ 误差均为零。\n$$\nE(p_{h}^{\\mathrm{N2S}}) = 0\n$$\n$$\nE(p_{h}^{\\mathrm{S2S}}) = 0\n$$\n$$\nE(p_{h}^{\\mathrm{M}}) = 0\n$$\n因此，这些误差的最大值也为零。\n$$\nE_{\\max} = \\max\\{0, 0, 0\\} = 0\n$$", "answer": "$$\\boxed{0}$$", "id": "2584061"}, {"introduction": "虽然补片测试处理的是理想的平直界面，但真实世界的工程问题常常涉及复杂的曲面。本练习将探讨因近似几何而引入的“变分犯罪” (variational crime) 问题，这是接触分析中一个关键的误差来源。你将推导几何表达的精度如何限制有限元解的整体收敛阶 $s(k_{u}, r_{g}) = \\min(k_{u}, r_{g}+1)$，这是在复杂接触模拟中获得高精度结果的核心考量。[@problem_id:2584008]", "problem": "考虑一个在 $2$ 维空间中的无摩擦法向接触问题，作用双方为一个占据有界域 $\\Omega \\subset \\mathbb{R}^{2}$ 的可变形体和一个具有光滑边界 $\\Gamma_{m} \\subset \\mathbb{R}^{2}$ 的刚性障碍物。设可变形体的潜在接触部分为 $\\Gamma_{s} \\subset \\partial \\Omega$。假设 $\\Gamma_{m}$ 是 $C^{3}$ 类的，其曲率一致有界，上界为 $\\kappa_{\\max} < \\infty$，并且精确参考构型满足 $\\Gamma_{s}$ 上的精确法向间隙为零，即对于所有 $x \\in \\Gamma_{s}$ 都有 $g_{n}(x) = 0$，其中 $g_{n}(x)$ 表示从 $x \\in \\Gamma_{s}$ 到 $\\Gamma_{m}$ 沿着 $\\Gamma_{s}$ 的单位外法向量 $\\boldsymbol{n}_{s}(x)$ 测量的有符号法向距离。\n\n在有限元法 (FEM) 近似中，假设：\n- 位移场在特征尺寸为 $h$ 的拟一致网格上使用多项式次数为 $k_{u} \\in \\mathbb{N}$ 的等参元进行近似，且精确解足够正则，使得最佳逼近能量范数误差以 $h^{k_{u}}$ 的速度衰减。\n- 刚性障碍物边界 $\\Gamma_{m}$ 由一个次数为 $r_{g} \\in \\mathbb{N}$ 的等参多项式几何 $\\Gamma_{m,h}$ 近似，该几何构建于具有相同特征尺寸 $h$ 的边界网格之上。从边界 $\\Gamma_{s}$ 及其法向量 $\\boldsymbol{n}_{s}$ 被精确表示。\n\n令 $p_{\\Gamma_{m}}(x)$ 表示点 $x \\in \\Gamma_{s}$ 在 $\\Gamma_{m}$ 上的最近点投影，令 $p_{\\Gamma_{m,h}}(x)$ 表示在 $\\Gamma_{m,h}$ 上的最近点投影。将计算（离散）间隙定义为 $g_{n,h}(x) := \\boldsymbol{n}_{s}(x) \\cdot \\left(p_{\\Gamma_{m,h}}(x) - x\\right)$。纯几何间隙误差为 $e_{g}(x) := g_{n}(x) - g_{n,h}(x)$，在当前参考构型中，其等于 $-g_{n,h}(x)$。\n\n任务：\n$1.$ 从有符号法向距离的定义出发，并使用关于 $C^{3}$ 类曲线的标准等参几何近似结果，量化逐点几何间隙误差 $\\|e_{g}\\|_{L^{\\infty}(\\Gamma_{s})}$ 关于 $h$ 和 $r_{g}$ 的阶。\n\n$2.$ 考虑一种接触离散化方法（例如，砂浆拉格朗日乘子法或一致性Nitsche型方法），其离散变分问题与精确问题的唯一区别在于接触项中用 $g_{n,h}$ 替换了 $g_{n}$。将由此产生的一致性误差建模为一个残差泛函 $R_{h}$，它在弱形式中对于离散空间中的所有测试函数 $v_{h}$ 满足形式为 $|R_{h}(v_{h})| \\leq C \\,\\|e_{g}\\|_{L^{2}(\\Gamma_{s})}\\,\\|v_{h}\\|_{V}$ 的界，其中 $\\|\\cdot\\|_{V}$ 是能量范数。使用针对“变分犯罪”的Strang型论证，并结合位移空间的最佳逼近性质，推导能量范数中的渐近收敛率指数 $s = s(k_{u}, r_{g})$，其定义如下：\n$$\n\\|u - u_{h}\\|_{V} = \\mathcal{O}\\!\\left(h^{\\,s(k_{u}, r_{g})}\\right) \\quad \\text{当} \\quad h \\to 0.\n$$\n\n以单个闭式表达式的形式给出 $s(k_{u}, r_{g})$ 关于 $k_{u}$ 和 $r_{g}$ 的最终答案。不需要数值，也不需要单位。不要提供不等式；只提供 $s(k_{u}, r_{g})$ 的表达式作为最终答案。", "solution": "所提出的问题是计算接触力学领域一个适定的理论问题，它基于有限元法和变分不等式数值分析的既定原理。该问题是自洽的、有科学依据的，并存在一个唯一且有意义的解。我们将对其进行形式化推导。\n\n该问题分为两个部分。首先，我们必须确定由主边界的等参近似所产生的逐点几何间隙误差的阶。其次，我们必须在Strang型误差估计中利用该结果，来推导位移场在V-范数（或能量范数）下的最终收敛率。\n\n让我们从第一个任务开始：量化几何间隙误差。\n几何间隙误差定义为 $e_{g}(x) := g_{n}(x) - g_{n,h}(x)$。问题陈述，在参考构型中，对于从边界 $\\Gamma_{s}$ 上的所有点 $x$，精确法向间隙 $g_{n}(x)$ 为零。这意味着在这种特定构型下，$\\Gamma_{s}$ 是主边界 $\\Gamma_{m}$ 的一个子集。因此，间隙误差简化为 $e_{g}(x) = -g_{n,h}(x)$。\n\n计算间隙 $g_{n,h}(x)$ 被定义为连接点 $x \\in \\Gamma_{s}$ 到其在近似主边界 $p_{\\Gamma_{m,h}}(x)$ 上的最近点投影的向量，在从法向量 $\\boldsymbol{n}_{s}(x)$ 上的投影。即，$g_{n,h}(x) := \\boldsymbol{n}_{s}(x) \\cdot \\left(p_{\\Gamma_{m,h}}(x) - x\\right)$。\n因此，几何误差为 $e_{g}(x) = - \\boldsymbol{n}_{s}(x) \\cdot \\left(p_{\\Gamma_{m,h}}(x) - x\\right)$。\n\n为了找到逐点界 $\\|e_{g}\\|_{L^{\\infty}(\\Gamma_{s})}$，我们取绝对值并应用在 $\\mathbb{R}^{2}$ 中的柯西-施瓦茨不等式：\n$$\n|e_{g}(x)| = |\\boldsymbol{n}_{s}(x) \\cdot \\left(p_{\\Gamma_{m,h}}(x) - x\\right)| \\le \\|\\boldsymbol{n}_{s}(x)\\| \\, \\|p_{\\Gamma_{m,h}}(x) - x\\|\n$$\n根据定义，$\\boldsymbol{n}_{s}(x)$ 是一个单位法向量，因此其欧几里得范数 $\\|\\boldsymbol{n}_{s}(x)\\|$ 等于 $1$。这将不等式简化为：\n$$\n|e_{g}(x)| \\le \\|p_{\\Gamma_{m,h}}(x) - x\\|\n$$\n项 $\\|p_{\\Gamma_{m,h}}(x) - x\\|$ 是从点 $x$ 到近似边界 $\\Gamma_{m,h}$ 的欧几里得距离。由于 $x \\in \\Gamma_{s}$ 且 $\\Gamma_{s} \\subseteq \\Gamma_{m}$，$x$ 是精确主边界 $\\Gamma_{m}$ 上的一个点。因此，$\\|p_{\\Gamma_{m,h}}(x) - x\\|$ 是精确边界上一点到近似边界的距离。\n\n边界的等参有限元近似理论的标准结果表明，对于一个 $C^{N}$ 类（这里 $N=3$）的边界 $\\Gamma_m$，如果用次数为 $r_g$ 的分段多项式曲线 $\\Gamma_{m,h}$ 在尺寸为 $h$ 的拟一致网格上进行近似，只要 $N \\ge r_g+1$，两条曲线之间的逐点距离为 $h^{r_g+1}$ 阶。给定的条件 $\\Gamma_m \\in C^3$，对于典型的单元次数（例如 $r_g=1, 2$）是足够的。豪斯多夫距离 $d_{H}(\\Gamma_{m}, \\Gamma_{m,h})$ 的界为 $C h^{r_g+1}$，这意味着：\n$$\n\\sup_{x \\in \\Gamma_{m}} \\|x - p_{\\Gamma_{m,h}}(x)\\| \\le C h^{r_{g}+1}\n$$\n对于一个与 $h$ 无关的常数 $C$。由于 $\\Gamma_s \\subseteq \\Gamma_m$，此界对所有 $x \\in \\Gamma_s$ 都成立。因此，对于所有 $x \\in \\Gamma_s$，我们有 $|e_g(x)| \\le C h^{r_g+1}$。在 $\\Gamma_s$ 上取上确界，我们完成了问题的第一部分：\n$$\n\\|e_{g}\\|_{L^{\\infty}(\\Gamma_{s})} = \\mathcal{O}(h^{r_{g}+1})\n$$\n\n现在，我们进行第二项任务：推导收敛率指数 $s(k_{u}, r_{g})$。\n涉及“变分犯罪”（如此接触问题中的几何近似）的有限元方法的分析，通常使用第二Strang引理或其对变分不等式的推广来进行。能量范数下的总误差由两项之和界定：最佳逼近误差和一致性误差。\n$$\n\\|u - u_{h}\\|_{V} \\le C \\left( \\inf_{v_{h} \\in V_{h}} \\|u - v_{h}\\|_{V} + \\sup_{w_{h} \\in V_{h}, \\|w_{h}\\|_{V}=1} |R_{h}(w_{h})| \\right)\n$$\n此处，$u$ 是精确解，$u_h$ 是离散解，$V_h$ 是位移的有限元空间，$R_h$ 是一致性残差泛函。\n\n第一项是最佳逼近误差。问题陈述，位移场由次数为 $k_u$ 的单元近似，并且精确解 $u$ 具有足够的正则性，使得能量范数下的最佳逼近误差具有最优速率：\n$$\n\\inf_{v_{h} \\in V_{h}} \\|u - v_{h}\\|_{V} = \\mathcal{O}(h^{k_{u}})\n$$\n第二项代表了由接触边界的几何近似引起的一致性误差。问题为残差泛函提供了一个界：\n$$\n|R_{h}(v_{h})| \\le C \\,\\|e_{g}\\|_{L^{2}(\\Gamma_{s})}\\,\\|v_{h}\\|_{V}\n$$\n由此，Strang估计中的一致性误差项的界为：\n$$\n\\sup_{w_{h} \\in V_{h}, \\|w_{h}\\|_{V}=1} |R_{h}(w_{h})| \\le \\sup_{w_{h} \\in V_{h}, \\|w_{h}\\|_{V}=1} C \\,\\|e_{g}\\|_{L^{2}(\\Gamma_{s})}\\,\\|w_{h}\\|_{V} = C \\|e_{g}\\|_{L^{2}(\\Gamma_{s})}\n$$\n为了找到此项的阶，我们必须估计 $\\|e_{g}\\|_{L^{2}(\\Gamma_{s})}$ 的阶。使用前面推导的 $L^{\\infty}$ 估计：\n$$\n\\|e_{g}\\|_{L^{2}(\\Gamma_{s})} = \\left(\\int_{\\Gamma_{s}} |e_{g}(x)|^{2} ds\\right)^{1/2} \\le \\left(\\int_{\\Gamma_{s}} \\left(\\|e_{g}\\|_{L^{\\infty}(\\Gamma_{s})}\\right)^{2} ds\\right)^{1/2} = \\|e_{g}\\|_{L^{\\infty}(\\Gamma_{s})} \\sqrt{\\text{meas}(\\Gamma_{s})}\n$$\n由于 $\\Gamma_{s}$ 是边界的固定部分，其测度（长度）是一个常数。因此，误差的 $L^2$ 范数的阶与 $L^{\\infty}$ 范数的阶相同：\n$$\n\\|e_{g}\\|_{L^{2}(\\Gamma_{s})} = \\mathcal{O}(h^{r_{g}+1})\n$$\n因此，一致性误差项的阶为 $\\mathcal{O}(h^{r_{g}+1})$。\n\n结合两个误差贡献，总误差估计变为：\n$$\n\\|u - u_{h}\\|_{V} \\le C_{1} h^{k_{u}} + C_{2} h^{r_{g}+1}\n$$\n当 $h \\to 0$ 时，渐近收敛率由两项中较慢的一项决定，即对应于较小的指数。因此，总误差为 $\\mathcal{O}(h^{s(k_{u}, r_{g})})$，其中指数 $s$ 是两个指数中的较小者：\n$$\ns(k_{u}, r_{g}) = \\min(k_{u}, r_{g}+1)\n$$\n这个结果阐明了接触问题有限元分析中的一个基本原则：几何近似的精度可能成为解的整体精度的瓶颈。为了保持高阶位移近似（次数为 $k_u$）的最优收敛率，几何近似必须具有足够高的次数 $r_g$ 以满足 $r_g+1 \\ge k_u$。如果不满足此条件，则几何离散化带来的误差将占主导地位，高阶位移单元的全部潜力将无法实现。", "answer": "$$\\boxed{\\min(k_{u}, r_{g}+1)}$$", "id": "2584008"}, {"introduction": "求解接触问题的非线性方程组极具挑战性，常常会遇到收敛困难，例如“抖动” (chatter) 现象，即接触点在激活和非激活状态之间快速切换。本实践将引导你设计并测试一种鲁棒的接触状态更新算法。通过采用迟滞 (hysteresis) 或“死区” (deadband) 策略，该算法可以有效稳定牛顿迭代过程，确保求解的可靠收敛。[@problem_id:2584002]", "problem": "在有限元法 (FEM) 的背景下，考虑一个可变形体与一个刚性障碍物之间的无摩擦单边接触。沿接触法向的接触运动学由一个标量法向间隙函数 $g \\colon \\mathbb{R}^{n} \\to \\mathbb{R}$ 表示，其中 $g(\\boldsymbol{u}) \\ge 0$ 表示非穿透，$g(\\boldsymbol{u}) = 0$ 表示激活接触，$g(\\boldsymbol{u}) < 0$ 表示穿透。无摩擦单边接触的互补条件是著名的 Karush–Kuhn–Tucker (KKT) 条件：$g \\ge 0$, $\\lambda \\ge 0$, 以及 $g\\,\\lambda = 0$，其中 $\\lambda$ 是非负接触压力拉格朗日乘子。Newton 法通过求解线性化平衡方程，在每次迭代中获得一个试探位移增量 $\\Delta \\boldsymbol{u}^{\\text{trial}}$。下一个间隙的线性化预测使用 $g$ 沿接触法向的方向导数，即 $g_{\\text{pred}} = g_k + Dg(\\boldsymbol{u}_k) \\cdot \\Delta \\boldsymbol{u}^{\\text{trial}}$，其中 $g_k = g(\\boldsymbol{u}_k)$ 是当前间隙。\n\n设计、实现并测试一个在 Newton 迭代过程中用于接触状态的鲁棒激活/失活准则，该准则：\n- 使用从线性化中获得的预测间隙值 $g_{\\text{pred}}$，\n- 与互补条件一致地强制非穿透，\n- 当预测间隙在零附近振荡时，防止接触状态的抖动（虚假的快速切换）。\n\n您必须从第一性原理推导该算法，并使用双阈值滞回来避免抖动。设 $\\alpha < 0$ 和 $\\beta > 0$ 为满足 $\\alpha < 0 < \\beta$ 的固定阈值。使用以下一维法向模型进行测试，以便法向间隙更新可直接由标量增量表示，即 $Dg(\\boldsymbol{u}_k) \\cdot \\Delta \\boldsymbol{u}^{\\text{trial}} = \\Delta g^{\\text{trial}}$，因此有\n$$\ng_{\\text{pred}} = g_k + \\Delta g^{\\text{trial}}.\n$$\n在此设置中，接触状态变量 $s \\in \\{0,1\\}$ 表示未激活 ($s=0$) 或激活 ($s=1$) 的接触。您的算法必须在每次 Newton 迭代 $k$ 中为每个候选接触点实现以下规则：\n- 预测间隙：$g_{\\text{pred}} = g_k + \\Delta g^{\\text{trial}}$。\n- 激活规则（滞回）：如果 $s_k = 0$ 且 $g_k \\le 0$ 或 $g_{\\text{pred}} \\le \\alpha$，则设置 $s_{k+1} = 1$；否则保持 $s_{k+1} = s_k$。\n- 失活规则（带有单边释放的滞回）：如果 $s_k = 1$ 且 $g_{\\text{pred}} \\ge \\beta$ 且 $\\Delta g^{\\text{trial}} \\ge 0$ 且 $g_k \\ge 0$，则设置 $s_{k+1} = 0$；否则保持 $s_{k+1} = s_k$。\n- 状态更新：接受此模型测试的试探增量，并设置 $g_{k+1} = g_{\\text{pred}}$。\n\n这种双阈值滞回创建了一个死区 $(\\alpha, \\beta)$，在该区域内，先前的接触状态被保留，从而防止 $g_{\\text{pred}}$ 在零附近小幅振荡时产生抖动。\n\n程序要求：\n- 实现上述算法，并将其应用于下面提供的测试套件。\n- 对每个测试用例，从给定的初始接触状态 $s_0$ 和初始间隙 $g_0$ 开始，然后处理给定的试探间隙增量序列 $\\{\\Delta g^{\\text{trial}}_k\\}$，在每一步更新状态和间隙。\n- 为每个测试用例计算序列中状态切换的总次数（一次激活或失活计为一次切换）。\n- 生成单行输出，其中包含所有测试用例的结果，形式为方括号括起来的逗号分隔列表。第 $i$ 个条目必须是第 $i$ 个测试用例的整数切换次数。\n\n所有距离单位均为米 (m)。对所有测试用例使用固定阈值 $\\alpha = -1\\times 10^{-6}$ m 和 $\\beta = 3\\times 10^{-6}$ m。\n\n测试套件：\n- 测试用例 1（接近、激活，然后在小分离下保持激活）：$s_0 = 0$，$g_0 = 5\\times 10^{-4}$ m，$\\{\\Delta g^{\\text{trial}}_k\\} = \\{-2\\times 10^{-4}, -2\\times 10^{-4}, -2\\times 10^{-4}, +5\\times 10^{-5}, -2\\times 10^{-5}\\}$ m。\n- 测试用例 2（零附近振荡，通过滞回防止抖动）：$s_0 = 0$，$g_0 = 2\\times 10^{-6}$ m，$\\{\\Delta g^{\\text{trial}}_k\\} = \\{-3\\times 10^{-6}, +3\\times 10^{-6}, -3\\times 10^{-6}, +3\\times 10^{-6}, -3\\times 10^{-6}\\}$ m。\n- 测试用例 3（分离时的受控释放）：$s_0 = 1$，$g_0 = 0$ m，$\\{\\Delta g^{\\text{trial}}_k\\} = \\{+1\\times 10^{-6}, +1\\times 10^{-6}, +1\\times 10^{-6}, +1\\times 10^{-6}\\}$ m。\n- 测试用例 4（恰好在阈值相等时激活）：$s_0 = 0$，$g_0 = 1\\times 10^{-5}$ m，$\\{\\Delta g^{\\text{trial}}_k\\} = \\{-1.1\\times 10^{-5}\\}$ m。\n- 测试用例 5（恰好在阈值相等时失活）：$s_0 = 1$，$g_0 = 2\\times 10^{-6}$ m，$\\{\\Delta g^{\\text{trial}}_k\\} = \\{+1\\times 10^{-6}\\}$ m。\n- 测试用例 6（因已存在穿透而立即激活）：$s_0 = 0$，$g_0 = -1\\times 10^{-5}$ m，$\\{\\Delta g^{\\text{trial}}_k\\} = \\{0\\}$ m。\n- 测试用例 7（始终张开，无切换）：$s_0 = 0$，$g_0 = 1\\times 10^{-3}$ m，$\\{\\Delta g^{\\text{trial}}_k\\} = \\{+1\\times 10^{-4}, +1\\times 10^{-4}\\}$ m。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含结果，形式为方括号括起来的逗号分隔列表（例如，$[r_1,r_2,\\dots,r_7]$），其中 $r_i$ 是您的算法为测试用例 $i$ 计算出的整数状态切换次数。", "solution": "我们从无摩擦单边接触的基本互补条件开始：$g \\ge 0$, $\\lambda \\ge 0$, 以及 $g\\,\\lambda = 0$。在有限元法 (FEM) 的背景下，状态变量是位移向量 $\\boldsymbol{u}$，间隙函数 $g(\\boldsymbol{u})$ 描述了法向分离。在牛顿迭代的第 $k$ 步，线性化的平衡方程组产生一个试探增量 $\\Delta \\boldsymbol{u}^{\\text{trial}}$，间隙的一阶泰勒展开为\n$$\ng_{\\text{pred}} = g(\\boldsymbol{u}_k + \\Delta \\boldsymbol{u}^{\\text{trial}}) \\approx g_k + Dg(\\boldsymbol{u}_k)\\cdot \\Delta \\boldsymbol{u}^{\\text{trial}},\n$$\n其中 $g_k = g(\\boldsymbol{u}_k)$。$g_{\\text{pred}}$ 的符号指示了下一个迭代步预测是会分离 ($g_{\\text{pred}} > 0$) 还是穿透 ($g_{\\text{pred}}  0$)。\n\n鲁棒切换的基本原理：在每次迭代中直接根据 $g_{\\text{pred}}$ 的符号来切换状态，当 $g_{\\text{pred}}$ 由于牛顿法过冲和线搜索调整而在零附近振荡时，这种做法已知会导致抖动。为防止这种情况，我们引入一个由两个阈值 $\\alpha  0$ 和 $\\beta > 0$ 界定的迟滞带，使得当 $g_{\\text{pred}} \\in (\\alpha,\\beta)$ 时，先前的状态被保留。这类似于引入一个稳定的“死区”：只有当 $g_{\\text{pred}}$ 足够小（小于 $\\alpha$）时，接触才会被激活；只有当 $g_{\\text{pred}}$ 足够大（大于 $\\beta$）时，接触才会被失活。要求在失活时 $\\Delta g^{\\text{trial}} \\ge 0$ 和 $g_k \\ge 0$ 是一个额外的单边一致性检查，它避免了在模型指示存在持续穿透或闭合步时释放接触。\n\n对一维法向模型的特化：为了测试，我们考虑单个标量法向自由度，因此 $Dg(\\boldsymbol{u}_k) \\cdot \\Delta \\boldsymbol{u}^{\\text{trial}} = \\Delta g^{\\text{trial}}$，所以\n$$\ng_{\\text{pred}} = g_k + \\Delta g^{\\text{trial}}.\n$$\n接触状态变量 $s \\in \\{0,1\\}$ 表示未激活 ($s=0$) 或激活 ($s=1$) 的接触。\n\n算法推导：\n1. 预测下一个间隙：$g_{\\text{pred}} = g_k + \\Delta g^{\\text{trial}}$。\n2. 激活条件。如果当前存在穿透或预测的穿透足够大，则必须激活接触。因此，如果 $s_k=0$ 并且 ($g_k \\le 0$ (当前穿透) 或 $g_{\\text{pred}} \\le \\alpha$ (预测穿透超出了负阈值))，则设置 $s_{k+1}=1$。否则，保持 $s_{k+1}=s_k$。\n3. 失活条件。为了仅在明确分离且伴随分离步时释放接触，要求 $g_{\\text{pred}} \\ge \\beta$ (超出正阈值) 并且 $\\Delta g^{\\text{trial}} \\ge 0$ (分离试探步) 并且 $g_k \\ge 0$ (无当前穿透)。如果 $s_k=1$ 且这些条件都成立，则设置 $s_{k+1}=0$。否则，保持 $s_{k+1}=s_k$。\n4. 状态更新。对于此测试模型，接受试探增量，并设置 $g_{k+1} = g_{\\text{pred}}$。\n\n防止抖动的原理：假设牛顿迭代在零附近产生振荡预测，例如，$g_{\\text{pred}}$ 在两个值 $a$ 和 $b$ 之间切换，其中 $a \\in (\\alpha,0)$ 且 $b \\in (0,\\beta)$。在简单的基于符号的规则下，状态可能在每次迭代中都发生切换。而在迟滞规则下，一旦状态变为激活，后续的 $g_{\\text{pred}} \\in (\\alpha,\\beta)$ 不会触发失活；类似地，一旦状态变为未激活，$g_{\\text{pred}} \\in (\\alpha,\\beta)$ 也不会触发激活。因此，状态切换被限制在预测间隙以有限的余量超过阈值的情况下。附加的单边检查防止了在检测到闭合步或当前穿透时释放接触，否则如果线性预测有噪声，将导致不一致的切换。\n\n数值参数和单位：我们指定 $\\alpha = -1\\times 10^{-6}$ m 和 $\\beta = 3\\times 10^{-6}$ m。所有间隙和增量都以米为单位。测试套件的用例检验了算法在接近、零附近振荡、分离时释放、阈值相等边界情况、已存在穿透以及始终张开情景下的表现。\n\n程序的实现细节：\n- 对每个测试用例，初始化 $(s_0,g_0)$ 并遍历给定的序列 $\\{\\Delta g^{\\text{trial}}_k\\}$，应用规则从 $s_k$ 和 $g_k$ 计算 $s_{k+1}$ 和 $g_{k+1}$。\n- 每当 $s_{k+1} \\ne s_k$ 时，计为一次切换。\n- 将每个用例的总切换次数附加到结果列表中。\n- 以要求的格式打印列表。\n\n迟滞确保了在振荡测试中，只发生一次激活，然后状态保持稳定；而在释放测试中，在分离步上越过正阈值后发生一次失活。等式条件 $g_{\\text{pred}}=\\alpha$ 或 $g_{\\text{pred}}=\\beta$ 满足各自的不等式，因此会触发激活或失活，从而在边界上提供了一个确定性的决胜规则。", "answer": "```python\nimport numpy as np\n\ndef simulate_contact(g0, increments, s0, alpha, beta):\n    \"\"\"\n    Simulate contact status evolution given initial gap g0, a sequence of trial\n    gap increments, initial status s0, and hysteresis thresholds alpha  0  beta.\n\n    Returns the total number of status switches.\n    \"\"\"\n    g = float(g0)\n    s = int(s0)\n    switches = 0\n\n    for dg_trial in increments:\n        g_pred = g + dg_trial\n        s_next = s\n\n        # Activation rule\n        if s == 0:\n            if (g = 0.0) or (g_pred = alpha):\n                s_next = 1\n\n        # Deactivation rule\n        else:  # s == 1\n            if (g_pred >= beta) and (dg_trial >= 0.0) and (g >= 0.0):\n                s_next = 0\n\n        if s_next != s:\n            switches += 1\n\n        # Accept the trial increment for this test model\n        g = g_pred\n        s = s_next\n\n    return switches\n\ndef solve():\n    # Hysteresis thresholds (in meters)\n    alpha = -1e-6\n    beta = 3e-6\n\n    # Define the test cases as tuples: (g0, increments_list, s0)\n    test_cases = [\n        # 1) Approach, activation, then remain active despite small separation\n        (5e-4, [-2e-4, -2e-4, -2e-4, +5e-5, -2e-5], 0),\n\n        # 2) Oscillation near zero, chatter prevention by hysteresis\n        (2e-6, [-3e-6, +3e-6, -3e-6, +3e-6, -3e-6], 0),\n\n        # 3) Controlled release on separation\n        (0.0, [+1e-6, +1e-6, +1e-6, +1e-6], 1),\n\n        # 4) Activation exactly at threshold equality\n        (1e-5, [-1.1e-5], 0),\n\n        # 5) Deactivation exactly at threshold equality\n        (2e-6, [+1e-6], 1),\n\n        # 6) Immediate activation due to existing penetration\n        (-1e-5, [0.0], 0),\n\n        # 7) Always open, no switching\n        (1e-3, [+1e-4, +1e-4], 0),\n    ]\n\n    results = []\n    for g0, increments, s0 in test_cases:\n        switches = simulate_contact(g0, increments, s0, alpha, beta)\n        results.append(switches)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2584002"}]}