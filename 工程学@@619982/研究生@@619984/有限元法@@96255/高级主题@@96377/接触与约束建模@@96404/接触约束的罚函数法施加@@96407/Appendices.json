{"hands_on_practices": [{"introduction": "在实践中，一个核心问题是如何选择合适的罚参数 $\\epsilon$。本练习将提供一个具体的方法来估算其大小，演示如何基于局部材料刚度和单元尺寸来确定该参数 [@problem_id:2586592]。这种方法确保了罚参数具有物理意义，而不仅仅是一个任意的大数，从而为建立有效的接触模型奠定了基础。", "problem": "一个宽度为 $2a = 20\\,\\text{mm}$ 的刚性、完美平直的线状冲头被压入一个二维、均匀、各向同性、线弹性固体的顶面，该固体在平面应变条件下建模。冲头在垂直方向上产生一个给定量的位移 $\\Delta = 0.05\\,\\text{mm}$。该固体的杨氏模量为 $E = 210{,}000\\,\\text{MPa}$，泊松比为 $\\nu = 0.3$。冲头下方的有限元网格使用线性单元，其在接触面法向的特征尺寸为 $h = 1\\,\\text{mm}$。刚性冲头与弹性固体之间的接触由罚函数法强制施加，其中法向接触牵引力 $t_n$ 与法向间隙（侵入深度）$g_n$ 的关系为 $t_n = \\epsilon\\, g_n$，其中 $\\epsilon$ 是沿冲头单位长度定义的罚参数（在二维平面应变设置中）。\n\n请仅使用 (i) 线性弹性胡克定律，(ii) 平面应变本构关系，以及 (iii) 高度为 $h$ 的单元柱的局部法向刚度的一维弹簧类比，估算一个合适的罚参数 $\\epsilon$ ，使得在施加的冲头位移 $\\Delta$ 下，最大法向侵入深度被限制在 $g_{\\max} = 1\\,\\mu\\text{m}$。将单位接触长度上的局部法向刚度建模为由一个具有有效平面应变模量、高度为 $h$ 的柱体的压缩变形所产生。假设代表性的接触牵引力尺度由局部法向刚度乘以施加的位移设定。\n\n数值计算 $\\epsilon$ 并以 $\\text{N}/\\text{mm}^3$ 为单位表示您的最终结果。将答案四舍五入到三位有效数字。", "solution": "此问题要求估算在有限元模型中用于施加接触约束的罚参数 $\\epsilon$。该估算必须基于一系列指定的假设和类比。\n\n首先，我们必须对问题陈述进行验证。\n\n**第一步：提取已知条件**\n-   冲头宽度：$2a = 20\\,\\text{mm}$\n-   冲头位移：$\\Delta = 0.05\\,\\text{mm}$\n-   杨氏模量：$E = 210{,}000\\,\\text{MPa}$\n-   泊松比：$\\nu = 0.3$\n-   特征单元尺寸：$h = 1\\,\\text{mm}$\n-   接触定律：$t_n = \\epsilon g_n$\n-   罚参数：$\\epsilon$\n-   最大允许侵入深度：$g_{\\max} = 1\\,\\mu\\text{m}$\n-   模型为二维平面应变。\n-   问题要求使用一维弹簧类比来处理高度为 $h$ 的单元柱的局部法向刚度。\n-   局部法向刚度需使用有效平面应变模量计算。\n-   估算提供了一个具体假设：代表性的接触牵引力尺度由局部法向刚度乘以施加的位移 $\\Delta$ 给出。\n\n**第二步：使用提取的已知条件进行验证**\n该问题在连续介质力学和计算力学领域具有科学依据。其提法是适定的，因为它提供了一个明确的目标和一种具体（尽管简化）的实现方法。语言客观而精确。所提供的数据在物理上是一致的，并且对于规定的估算方法是完备的。例如，$E$ 和 $\\nu$ 的值是钢的典型值。此问题并非显而易见，因为它要求为给定条件推导合适的模量。它不包含矛盾或谬误。\n\n**第三步：结论与行动**\n问题被认为是有效的。将根据提供的说明构建解答。\n\n罚函数法通过罚参数 $\\epsilon$ 将法向接触牵引力 $t_n$ 与侵入深度 $g_n$ 联系起来：\n$$t_n = \\epsilon g_n$$\n为了将最大侵入深度限制在值 $g_{\\max}$，在此侵入深度下的牵引力将是 $t_{n, \\max} = \\epsilon g_{\\max}$。\n\n问题为估算提供了一个关键的、非标准的指令：“假设代表性的接触牵引力尺度由局部法向刚度乘以施加的位移设定。” 我们将单位面积上的局部法向刚度表示为 $k_{loc}$，施加的冲头位移表示为 $\\Delta$。该指令可表示为：\n$$t_{n, \\text{rep}} = k_{loc} \\Delta$$\n为确保侵入深度不超过 $g_{\\max}$，我们将此代表性牵引力与最大允许牵引力 $t_{n, \\max}$ 等同。\n$$t_{n, \\text{rep}} = t_{n, \\max}$$\n$$k_{loc} \\Delta = \\epsilon g_{\\max}$$\n此方程使我们能够解出所需的罚参数 $\\epsilon$：\n$$\\epsilon = \\frac{k_{loc} \\Delta}{g_{\\max}}$$\n下一步是确定局部刚度 $k_{loc}$。问题指示我们将此刚度建模为由高度为 $h$ 的材料柱的压缩变形产生。刚度 $k_{loc}$ 是法向应力（牵引力）与产生它的法向位移之比。对于高度为 $h$ 的柱体，压缩应变为 $\\varepsilon_{yy} = \\delta_y / h$，其中 $\\delta_y$是压缩量。相应的法向应力是 $\\sigma_{yy} = M \\varepsilon_{yy}$，其中 $M$ 是合适的模量。因此，刚度为：\n$$k_{loc} = \\frac{\\sigma_{yy}}{\\delta_y} = \\frac{M \\varepsilon_{yy}}{\\varepsilon_{yy} h} = \\frac{M}{h}$$\n问题设定在平面应变条件下。压缩柱体的类比暗示了在垂直方向（$y$ 方向）上的单轴应变状态，因为周围材料限制了横向膨胀。因此，我们有 $\\varepsilon_{yy} \\neq 0$，但 $\\varepsilon_{xx} = 0$。根据平面应变的定义，我们也有 $\\varepsilon_{zz} = 0$。因此，我们必须使用适用于单轴应变的平面应变模量。\n\n通用的各向同性线弹性本构关系为 $\\sigma_{ij} = \\lambda \\varepsilon_{kk} \\delta_{ij} + 2\\mu \\varepsilon_{ij}$，其中 $\\lambda$ 和 $\\mu$ 是拉梅参数。\n对于 $y$ 方向的单轴应变，体积应变为 $\\varepsilon_{kk} = \\varepsilon_{yy}$。应力分量 $\\sigma_{yy}$ 是：\n$$\\sigma_{yy} = \\lambda \\varepsilon_{yy} + 2\\mu \\varepsilon_{yy} = (\\lambda + 2\\mu) \\varepsilon_{yy}$$\n有效模量为 $M = \\lambda + 2\\mu$，即 P 波模量。我们用杨氏模量 $E$ 和泊松比 $\\nu$ 来表示 $M$。\n$$M = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} + \\frac{E}{1+\\nu} = \\frac{E\\nu + E(1-2\\nu)}{(1+\\nu)(1-2\\nu)} = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)}$$\n这是针对指定物理情况的正确模量。\n\n于是，局部刚度 $k_{loc}$ 为：\n$$k_{loc} = \\frac{M}{h} = \\frac{E(1-\\nu)}{h(1+\\nu)(1-2\\nu)}$$\n将此代回 $\\epsilon$ 的表达式中：\n$$\\epsilon = \\frac{\\Delta}{g_{\\max}} \\left( \\frac{E(1-\\nu)}{h(1+\\nu)(1-2\\nu)} \\right)$$\n现在我们代入给定的数值，确保单位一致。\n-   $E = 210{,}000\\,\\text{MPa} = 210{,}000\\,\\text{N}/\\text{mm}^2$\n-   $\\nu = 0.3$\n-   $\\Delta = 0.05\\,\\text{mm}$\n-   $h = 1\\,\\text{mm}$\n-   $g_{\\max} = 1\\,\\mu\\text{m} = 0.001\\,\\text{mm}$\n\n我们计算各项：\n-   $1 - \\nu = 1 - 0.3 = 0.7$\n-   $1 + \\nu = 1 + 0.3 = 1.3$\n-   $1 - 2\\nu = 1 - 2(0.3) = 1 - 0.6 = 0.4$\n\n现在我们计算 $\\epsilon$：\n$$\\epsilon = \\frac{0.05\\,\\text{mm}}{0.001\\,\\text{mm}} \\left( \\frac{(210000\\,\\text{N}/\\text{mm}^2)(0.7)}{(1\\,\\text{mm})(1.3)(0.4)} \\right)$$\n$$\\epsilon = 50 \\left( \\frac{147000}{0.52} \\right) \\text{N}/\\text{mm}^3$$\n$$\\epsilon = 50 \\times 282692.307... \\,\\text{N}/\\text{mm}^3$$\n$$\\epsilon = 14134615.38... \\,\\text{N}/\\text{mm}^3$$\n问题要求将结果四舍五入到三位有效数字。\n$$\\epsilon \\approx 1.41 \\times 10^7\\,\\text{N}/\\text{mm}^3$$\n冲头宽度 $2a$ 与此特定估算过程无关。", "answer": "$$\\boxed{1.41 \\times 10^{7}}$$", "id": "2586592"}, {"introduction": "在上一练习的估算基础上，本练习深入探讨了罚参数为何应依赖于网格尺寸的理论依据 [@problem_id:2586598]。通过平衡体材料的应变能与接触界面的罚能量，你将推导出基本的标度律。这一深刻见解对于设计稳健的有限元模型至关重要，因为它能确保在网格细化过程中同时保持数值稳定性和计算精度。", "problem": "考虑一个杨氏模量为 $E$ 的小应变线性弹性体，在二维平面应变或三维弹性情况下，被压在一个刚性无摩擦平面上。在潜在接触边界 $\\Gamma_{c}$ 上的单边不可穿透接触约束通过罚函数法施加，通过 $t_{n}=\\epsilon\\,g_{n}$ 引入法向接触牵引力 $t_{n}$，其中 $g_{n}$ 是法向间隙，$\\epsilon$ 是罚参数。该物体通过特征局部网格尺寸为 $h$ 的一阶（线性）有限元进行离散，接触边界 $\\Gamma_{c}$ 通过与体离散一致的线性面（三维中）或线（二维中）接触单元进行离散。假设解场足够光滑，以至于尺寸为 $h$ 的单个单元片足以代表局部标度关系。\n\n从体应变能和罚接触能的定义出发，并仅使用以下基本事实：（i）在小应变线性弹性中，应变能密度与 $E\\,\\varepsilon^{2}$ 成比例，其中 $\\varepsilon$ 为小应变；（ii）对于线性有限元，当施加位移幅值 $U$ 时，单元片上的位移梯度与 $U/h$ 成比例；（iii）在 $d$ 维空间中，单元内部的测度与 $h^{d}$ 成比例，而其接触面的测度与 $h^{d-1}$ 成比例，推导罚参数 $\\epsilon$ 的一个与网格相关的标度关系，使得在接触边界上，罚函数对离散刚度的贡献与相邻单元片的体刚度具有相同的数量级。引入一个无量纲调节常数 $\\alpha$ 来反映施加强度，该常数不改变量纲一致性。\n\n以 $E$、$h$ 和 $\\alpha$ 的函数形式报告 $\\epsilon$ 的最终表达式。将您的答案表示为关于 $E$、$h$ 和 $\\alpha$ 的单个解析表达式。最终表达式中不要包含单位。$\\epsilon$ 的隐含单位是帕斯卡每米 (Pa/m)。不需要进行数值舍入。", "solution": "我们的目标是确定线性有限元中罚参数 $\\epsilon$ 的标度关系，以使罚函数对接触刚度的贡献在数量级上与相邻的体刚度相当。这确保了数值条件不会恶化，并且所施加的不可穿透约束相对于离散化的体响应既不会太弱也不会太强。\n\n我们从小应变线性弹性理论出发。区域 $\\Omega$ 的体应变能为\n$$\n\\Pi_{\\text{bulk}} = \\frac{1}{2}\\int_{\\Omega} \\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}\\,\\mathrm{d}\\Omega,\n$$\n其中 $\\boldsymbol{\\sigma}$ 是柯西应力，$\\boldsymbol{\\varepsilon}$ 是小应变。对于各向同性线性弹性材料，能量密度与 $E\\,\\varepsilon^{2}$ 成比例，其中 $E$ 是杨氏模量。在 $d$ 维空间中一个特征尺寸为 $h$ 的代表性单元片上，令 $U$ 表示一个代表性位移幅值。对于线性插值，位移梯度以及应变成比例于\n$$\n\\boldsymbol{\\varepsilon} \\sim \\frac{U}{h}.\n$$\n因此，一个单元片上的体应变能按以下比例变化\n$$\n\\Pi_{\\text{bulk}} \\sim \\frac{1}{2}\\,E\\,\\left(\\frac{U}{h}\\right)^{2}\\,h^{d} \\;=\\; \\frac{1}{2}\\,E\\,U^{2}\\,h^{d-2}.\n$$\n\n接下来，我们考虑在接触边界 $\\Gamma_{c}$ 的接触部分上的罚接触能。罚函数法将法向牵引力规定为 $t_{n}=\\epsilon\\,g_{n}$，并在间隙 $g_{n}$ 处于压缩状态时产生接触势能\n$$\n\\Pi_{\\text{pen}} = \\frac{1}{2}\\int_{\\Gamma_{c}} \\epsilon\\, g_{n}^{2}\\,\\mathrm{d}\\Gamma,\n$$\n在与单元片相关联的接触面上，几何测度与 $h^{d-1}$ 成比例。法向间隙 $g_{n}$ 是位移跳跃沿法向的投影；对于线性插值和代表性位移幅值 $U$，我们有\n$$\ng_{n} \\sim U.\n$$\n因此，罚能量按以下比例变化\n$$\n\\Pi_{\\text{pen}} \\sim \\frac{1}{2}\\,\\epsilon\\,U^{2}\\,h^{d-1}.\n$$\n\n为确保接触面上的离散罚刚度与相邻单元的离散体刚度具有相同的数量级，我们平衡在相同的代表性位移 $U$ 下计算的两种能量贡献的数量级：\n$$\n\\Pi_{\\text{pen}} \\sim \\Pi_{\\text{bulk}}.\n$$\n使用上述标度关系，\n$$\n\\frac{1}{2}\\,\\epsilon\\,U^{2}\\,h^{d-1} \\;\\sim\\; \\frac{1}{2}\\,E\\,U^{2}\\,h^{d-2}.\n$$\n消去公因数 $\\frac{1}{2}$ 和 $U^{2}$，我们得到\n$$\n\\epsilon\\,h^{d-1} \\sim E\\,h^{d-2}\n\\quad\\Longrightarrow\\quad\n\\epsilon \\sim \\frac{E}{h}.\n$$\n\n这个结果与空间维度 $d$ 无关，并且与量纲分析一致：由于 $t_{n}$ 的单位是应力，$g_{n}$ 的单位是长度，所以 $\\epsilon$ 的单位必须是应力每长度，这与 $E/h$ 相匹配。引入一个无量纲调节因子 $\\alpha$ 来调整施加强度而不改变标度或单位，得到通用形式\n$$\n\\epsilon \\;=\\; \\alpha\\,\\frac{E}{h}.\n$$\n这就在小应变弹性理论中，为线性单元实现了接触罚刚度与体刚度之间的期望平衡。", "answer": "$$\\boxed{\\alpha\\,\\frac{E}{h}}$$", "id": "2586598"}, {"introduction": "最后的这项实践将前面练习中的概念综合应用于一个完整的数值实验中 [@problem_id:2586560]。你将为一个经典的赫兹接触问题设计并实施一个收敛性研究。通过系统地细化网格并根据推导出的标度律调整罚参数，你将亲眼观察到数值解如何逼近解析解，以及约束违例（即穿透量）是如何被有效控制的。", "problem": "设计并实现一个完整的、可运行的程序，该程序使用罚函数法施加法向接触约束，对刚性球体与各向同性线弹性半空间之间的轴对称接触问题进行网格细化研究。其目标是验证随着网格的细化，当罚参数以耦合方式增加时，离散最大接触压力和最大（违反约束的）侵入深度的收敛性。\n\n从以下基本原理出发：\n- 线弹性理论以及刚性球体压入弹性半空间的经典轴对称接触问题。\n- 轴对称无摩擦法向接触问题的等效模量的标准构造方法。\n- 单边接触约束的罚函数公式的定义，其中接触压力与间隙的负值部分成正比。\n- 细化径向轴对称网格可减少离散误差，而增加罚参数可减少约束违反这一概念。\n\n您必须基于这些基本原理推导出所需的表达式。除了从这些基本原理推导出的公式外，不要假设任何其他特殊公式。\n\n建模和离散化要求：\n- 考虑一个半径为 $R$ 的刚性球体，压入一个由杨氏模量 $E$ 和泊松比 $\\nu$ 表征的均匀各向同性弹性半空间。指定的压入深度为 $\\delta \\gt 0$。\n- 假设连续极限下的接触解为指定压入深度下球体-平面接触的经典轴对称无摩擦法向接触解。据此，确定接触半径 $a$ 和在 $0 \\le r \\le a$ 范围内的接触压力 $p(r)$ 的连续径向分布。\n- 将接触区域 $[0,a]$ 离散化为 $N$ 个径向厚度相等的同心圆环，厚度为 $h = a/N$。对于内半径为 $r_i$、外半径为 $r_{i+1}$ 的圆环 $i$，将环平均离散压力定义为连续压力在该圆环上的面积平均值。使用精确的面积平均（即，将压力在圆环面积上积分，然后除以圆环面积）。\n- 将离散最大压力 $p_{\\max}^h$ 定义为所有圆环中的最大环平均压力。\n- 在环平均层面上，通过罚函数关系施加单边法向接触。设单位面积的法向罚刚度为 $\\epsilon$（单位为压力/长度）。使用非侵入约束的罚函数施加方法，根据离散最大压力，并假设罚函数公式中使用的接触压力和负间隙之间的局部关系，确定所隐含的最大侵入深度量值 $g_{\\max}^h$。\n- 通过关系式 $\\epsilon = \\alpha \\, E^\\star / h$ 将罚参数与网格尺寸耦合，其中 $E^\\star$ 是等效模量，$\\alpha \\gt 0$ 是一个无量纲的缩放因子。这种耦合确保了当 $h \\to 0$ 时，$\\epsilon \\to \\infty$。\n\n测试套件和参数：\n- 一致使用国际单位制 (SI)。压力以帕斯卡 (Pa) 为单位，长度以米 (m) 为单位报告。\n- 材料和几何参数：\n  - $E = 7.0 \\times 10^{10} \\,\\mathrm{Pa}$\n  - $\\nu = 0.33$\n  - $R = 1.0 \\times 10^{-2} \\,\\mathrm{m}$\n  - $\\delta = 2.0 \\times 10^{-5} \\,\\mathrm{m}$\n- 程序必须评估以下四个测试用例，每个用例由 $(N,\\alpha)$ 指定：\n  1. $N = 8$, $\\alpha = 10$\n  2. $N = 16$, $\\alpha = 10$\n  3. $N = 32$, $\\alpha = 10$\n  4. $N = 32$, $\\alpha = 50$\n\n对于每个测试用例，您的程序必须计算：\n- 离散最大环平均压力 $p_{\\max}^h$（单位：$\\mathrm{Pa}$）。\n- 在该离散最大压力下，由罚函数施加所隐含的最大侵入深度量值 $g_{\\max}^h$（单位：$\\mathrm{m}$）。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。对于每个测试用例，该列表必须按顺序首先包含 $p_{\\max}^h$（单位：$\\mathrm{Pa}$），然后是 $g_{\\max}^h$（单位：$\\mathrm{m}$）。因此，对于上述四个测试用例，输出必须按以下顺序包含八个数字：\n  - $[p_{\\max}^h(N{=}8,\\alpha{=}10), g_{\\max}^h(N{=}8,\\alpha{=}10), p_{\\max}^h(N{=}16,\\alpha{=}10), g_{\\max}^h(N{=}16,\\alpha{=}10), p_{\\max}^h(N{=}32,\\alpha{=}10), g_{\\max}^h(N{=}32,\\alpha{=}10), p_{\\max}^h(N{=}32,\\alpha{=}50), g_{\\max}^h(N{=}32,\\alpha{=}50)]$\n\n本问题不涉及角度单位。\n\n您的实现必须是完全自包含的，并且不得要求任何用户输入。其正确性应通过推导的内部一致性以及针对指定测试套件的数值结果来证明。预期的定性行为是：当 $\\alpha$ 固定时，随着 $N$ 的增加，$p_{\\max}^h$ 趋近于连续最大压力；当 $N$ 随着耦合关系 $\\epsilon = \\alpha E^\\star/h$ 增加时，最大侵入深度 $g_{\\max}^h$ 趋于零。", "solution": "我们从线弹性、轴对称无摩擦接触和罚函数施加的基本原理出发，推导必要的关系。考虑一个半径为 $R$ 的刚性球体，以指定的压入深度 $\\delta \\gt 0$ 压入一个由杨氏模量 $E$ 和泊松比 $\\nu$ 表征的均匀各向同性线弹性半空间。刚性压头与弹性半空间之间的轴对称无摩擦法向接触的等效模量为\n$$\nE^\\star = \\frac{E}{1-\\nu^2}.\n$$\n对于指定压入深度下刚性球体压入弹性半空间的经典 Hertz 接触问题，其解是轴对称的，且为纯法向接触，无摩擦牵引力。以下关系式联系了压入深度 $\\delta$、接触半径 $a$ 以及接触区域上的压力分布 $p(r)$。这些关系可以通过将法向牵引力下半空间的轴对称位移与球形轮廓的几何形状以及互补条件相结合来建立。首先，轴上的协调性与轴对称弹性力学共同得出，压入深度 $\\delta$ 与接触半径的关系为\n$$\na^2 = R \\, \\delta.\n$$\n接触圆 $0 \\le r \\le a$ 内的接触压力必须呈著名的 Hertz 形式\n$$\np(r) = p_0 \\sqrt{1 - \\left(\\frac{r}{a}\\right)^2},\n$$\n中心 $r=0$ 处的峰值压力由下式给出\n$$\np_0 = \\frac{2 E^\\star a}{\\pi R}.\n$$\n这些结果源于两个独立的关系：(i) 在上述压力分布下，$r=0$ 处的半空间解析位移等于压入深度 $\\delta$；(ii) $p(r)$ 在接触区域上的积分得到总作用力，将其与几何关系结合，也能得出相同的关系。一个一致性检验来自于计算总载荷 $P$：\n$$\nP = \\int_0^a 2\\pi r p(r)\\,dr = \\frac{2}{3}\\pi a^2 p_0,\n$$\n将其与 $P = \\frac{4}{3} \\frac{E^\\star a^3}{R}$ 结合，可重新得到 $p_0 = \\frac{2 E^\\star a}{\\pi R}$ 和 $a^2 = R \\delta$。\n\n为了研究网格细化，我们将径向区间 $[0,a]$ 离散化为 $N$ 个径向厚度相等的同心圆环，厚度为 $h = a/N$。对于 $i = 0,1,\\dots,N-1$，圆环 $i$ 覆盖区间 $[r_i, r_{i+1}]$，其中 $r_i = i h$，$r_{i+1} = (i+1) h$。圆环的面积为\n$$\nA_i = \\pi \\left(r_{i+1}^2 - r_i^2\\right).\n$$\n将环平均离散压力定义为连续压力在该圆环上的精确面积平均值：\n$$\n\\bar{p}_i = \\frac{1}{A_i} \\int_{r_i}^{r_{i+1}} 2\\pi r \\, p(r) \\, dr.\n$$\n代入 $p(r) = p_0 \\sqrt{1-(r/a)^2}$ 并通过 $s = r/a$（其中 $dr = a\\, ds$，$r = a s$）进行变量替换，可得\n$$\n\\bar{p}_i = \\frac{2}{r_{i+1}^2 - r_i^2} \\int_{r_i}^{r_{i+1}} r \\, p_0 \\sqrt{1-(r/a)^2} \\, dr\n= \\frac{2 p_0}{a^2(s_{i+1}^2 - s_i^2)} \\int_{s_i}^{s_{i+1}} a^2 s \\sqrt{1-s^2} \\, ds,\n$$\n其中 $s_i = r_i/a$，$s_{i+1} = r_{i+1}/a$。积分 $\\int s \\sqrt{1-s^2} \\, ds$ 是一个初等积分：\n$$\n\\int s \\sqrt{1-s^2} \\, ds = -\\frac{1}{3} \\left(1 - s^2\\right)^{3/2} + C.\n$$\n因此，\n$$\n\\bar{p}_i = \\frac{2 p_0}{3 \\left(s_{i+1}^2 - s_i^2\\right)} \\left[ \\left(1 - s_i^2\\right)^{3/2} - \\left(1 - s_{i+1}^2\\right)^{3/2} \\right].\n$$\n网格上的离散最大压力为\n$$\np_{\\max}^h = \\max_{0 \\le i \\le N-1} \\bar{p}_i.\n$$\n由于在 $0 \\le r \\le a$ 区间内，$p(r)$ 随 $r$ 的增加而严格递减，并且中心圆环的环平均值小于 $p_0$ 但在 $h \\to 0$ 时趋近于 $p_0$，因此当 $N \\to \\infty$ 时，我们有 $p_{\\max}^h \\to p_0$。\n\n对于单边法向接触约束的罚函数施加，我们使用罚函数方法中接触压力与负间隙之间的标准局部关系。设 $g(r)$ 表示法向间隙，符号约定为 $g(r) \\le 0$ 表示发生侵入。在罚函数公式中，接触压力被建模为\n$$\np(r) \\approx -\\epsilon \\, g^-(r),\n$$\n其中 $g^-(r) = \\min(g(r), 0)$，$\\epsilon$ 是单位面积的法向罚刚度，单位为 $\\mathrm{Pa/m}$。等价地，在真实解中接触压力不为零的任何地方，罚函数法都会导致一个大小约为 $|g(r)| \\approx p(r)/\\epsilon$ 的负间隙。在离散层面上使用环平均压力，由罚函数施加所隐含的最大侵入深度量值因此为\n$$\ng_{\\max}^h \\approx \\frac{p_{\\max}^h}{\\epsilon}.\n$$\n为了确保在网格细化时 $\\epsilon \\to \\infty$，我们将 $\\epsilon$ 与网格尺寸通过以下公式耦合\n$$\n\\epsilon = \\alpha \\, \\frac{E^\\star}{h},\n$$\n其中 $\\alpha \\gt 0$ 是一个无量纲参数。由于 $h = a/N$，这种缩放使得 $\\epsilon$ 随 $N$ 线性增长，从而在极限情况下抑制了罚的违反。\n\n现在我们指定测试参数并计算所要求的量。\n\n材料和几何参数：\n- $E = 7.0 \\times 10^{10} \\,\\mathrm{Pa}$，\n- $\\nu = 0.33$，\n- $R = 1.0 \\times 10^{-2} \\,\\mathrm{m}$，\n- $\\delta = 2.0 \\times 10^{-5} \\,\\mathrm{m}$。\n\n根据这些参数，\n$$\nE^\\star = \\frac{E}{1-\\nu^2}, \\quad a = \\sqrt{R \\delta}, \\quad p_0 = \\frac{2 E^\\star a}{\\pi R}.\n$$\n\n对于每个测试用例 $(N,\\alpha)$，我们计算：\n- $h = a/N$，\n- $\\epsilon = \\alpha E^\\star/h$，\n- 使用上述精确公式计算环平均压力 $\\bar{p}_i$，\n- $p_{\\max}^h = \\max_i \\bar{p}_i$，\n- $g_{\\max}^h = p_{\\max}^h / \\epsilon$。\n\n四个测试用例如下：\n1. $N = 8$, $\\alpha = 10$,\n2. $N = 16$, $\\alpha = 10$,\n3. $N = 32$, $\\alpha = 10$,\n4. $N = 32$, $\\alpha = 50$.\n\n定性预期：\n- 当 $\\alpha$ 固定时，随着 $N$ 的增加，$p_{\\max}^h$ 会单调增加并趋近于 $p_0$，因为中心环的平均值成为 $r=0$ 处点最大值的更精确近似。\n- 在耦合关系 $\\epsilon = \\alpha E^\\star/h$ 和固定的 $\\alpha$ 下，对于较大的 $N$，$g_{\\max}^h$ 与 $h$ 成比例减小，因为 $p_{\\max}^h$ 趋近于一个常数 $p_0$，而 $\\epsilon$ 的增长方式类似于 $1/h$。\n- 在固定的 $N$ 下增加 $\\alpha$ 会使 $g_{\\max}^h$ 与 $1/\\alpha$ 成比例减小，而 $p_{\\max}^h$ 保持不变（因为离散平均与 $\\alpha$ 无关）。\n\n程序精确地实现了这些计算，并以要求的格式输出单行结果：\n$$\n[p_{\\max}^h(N{=}8,\\alpha{=}10), g_{\\max}^h(N{=}8,\\alpha{=}10), p_{\\max}^h(N{=}16,\\alpha{=}10), g_{\\max}^h(N{=}16,\\alpha{=}10), p_{\\max}^h(N{=}32,\\alpha{=}10), g_{\\max}^h(N{=}32,\\alpha{=}10), p_{\\max}^h(N{=}32,\\alpha{=}50), g_{\\max}^h(N{=}32,\\alpha{=}50)].\n$$\n所有压力单位均为 $\\mathrm{Pa}$，所有长度单位均为 $\\mathrm{m}$。", "answer": "```python\nimport numpy as np\n\ndef hertz_contact_parameters(E, nu, R, delta):\n    # Effective modulus for rigid sphere on elastic half-space\n    E_star = E / (1.0 - nu**2)\n    # Contact radius a\n    a = np.sqrt(R * delta)\n    # Maximum (center) pressure p0\n    p0 = (2.0 * E_star * a) / (np.pi * R)\n    return E_star, a, p0\n\ndef ring_average_pressures(p0, a, N):\n    # Compute exact ring-averaged pressures over N equal-thickness rings in [0,a]\n    # Using the analytic integral of r * p(r) with p(r) = p0 * sqrt(1 - (r/a)^2)\n    p_avg = np.zeros(N)\n    # In normalized coordinates s = r/a, rings are [i/N, (i+1)/N]\n    for i in range(N):\n        s_i = i / N\n        s_o = (i + 1) / N\n        denom = (s_o**2 - s_i**2)\n        # Avoid division by zero (should not occur for finite ring width)\n        if denom <= 0.0:\n            p_avg[i] = 0.0\n        else:\n            term_i = (1.0 - s_i**2)**1.5\n            term_o = (1.0 - s_o**2)**1.5\n            p_avg[i] = (2.0 * p0 / (3.0 * denom)) * (term_i - term_o)\n    return p_avg\n\ndef solve():\n    # Material and geometry (SI units)\n    E = 7.0e10      # Pa\n    nu = 0.33       # -\n    R = 1.0e-2      # m\n    delta = 2.0e-5  # m\n\n    # Test cases: (N, alpha)\n    test_cases = [\n        (8, 10.0),\n        (16, 10.0),\n        (32, 10.0),\n        (32, 50.0),\n    ]\n\n    # Compute base Hertz parameters\n    E_star, a, p0 = hertz_contact_parameters(E, nu, R, delta)\n\n    results = []\n    for N, alpha in test_cases:\n        h = a / N\n        eps = alpha * E_star / h  # penalty parameter per unit area\n        # Discrete ring-averaged pressures\n        p_avg = ring_average_pressures(p0, a, N)\n        pmax_h = float(np.max(p_avg))\n        # Maximum penetration magnitude from penalty relation\n        gmax_h = pmax_h / eps\n        results.extend([pmax_h, gmax_h])\n\n    # Print results in the exact required format (single line, list of numbers)\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2586560"}]}