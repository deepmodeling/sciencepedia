{"hands_on_practices": [{"introduction": "我们的动手实践始于接触分析最基本的构件：节点-表面（node-to-surface）公式。这个练习 [@problem_id:2548022] 关注于单个从节点与一个主平面之间的相互作用。通过亲手计算几何间隙 $g_n$、由此产生的罚函数力 $f_c$ 以及一致切向刚度 $k_c$，您将直接体会到接触约束是如何在数值上被施加的。", "problem": "考虑有限元法（FEM）中的一个点到面（节点到表面）单边接触情景，其中，一个位于当前位置 $\\boldsymbol{x}_s \\in \\mathbb{R}^3$ 的从节点与一个平面主表面相互作用。该主表面由一个点 $\\boldsymbol{x}_0 \\in \\mathbb{R}^3$ 和一个单位法向量 $\\boldsymbol{n} \\in \\mathbb{R}^3$ 定义。假设为小变形运动学，且相互作用是无摩擦的纯法向作用。\n\n从接触运动学的基本原理和带有单边接触二次罚函数正则化的虚功原理出发，按以下步骤进行：\n- 对于平面主表面，用 $\\boldsymbol{x}_s$、$\\boldsymbol{x}_0$ 和 $\\boldsymbol{n}$ 定义带符号法向间隙 $g_n$，并解释接触激活条件。\n- 从一个容许的单边法向接触罚函数势能出发，推导标量法向接触力 $f_c$ 及相关的标量一致性切线 $k_c := \\partial f_c / \\partial g_n$。\n- 根据下面给出的数值数据，计算 $g_n$、$f_c$ 和 $k_c$。\n\n使用以下数据：\n- 从节点位置 $\\boldsymbol{x}_s = \\left(0.3998,\\, -0.1,\\, 0.1998\\right)\\,\\text{米}$，\n- 平面上的点 $\\boldsymbol{x}_0 = \\left(0.4,\\, -0.1,\\, 0.2\\right)\\,\\text{米}$，\n- 平面的单位法向量 $\\boldsymbol{n} = \\dfrac{1}{3}\\left(1,\\, 2,\\, 2\\right)$，\n- 法向罚参数 $\\epsilon_n = 3.5 \\times 10^{7}\\,\\text{牛顿/米}$。\n\n采用符号约定：$g_n < 0$ 表示侵入（接触激活），$g_n \\ge 0$ 表示分离（无接触）。请将 $g_n$ 以米表示，$f_c$ 以牛顿表示，$k_c$ 以牛顿/米表示。将最终数值结果四舍五入至四位有效数字。\n\n最终答案必须按 $(g_n,\\ f_c,\\ k_c)$ 的顺序报告这三个值。", "solution": "经形式审查，所给出的问题陈述有效。它在科学上基于计算接触力学的原理，特别是有限元法中的罚函数法。问题提法良好，为获得唯一解提供了所有必要数据。语言客观明确。因此，我们可以着手求解。\n\n该问题要求评估从节点与主平面之间的接触状态。这首先需要精确定义几何关系（间隙），其次需要基于此几何关系建立相互作用力的本构律。\n\n首先，我们定义带符号法向间隙 $g_n$。对于一个位于位置 $\\boldsymbol{x}_s$ 的从节点和一个由点 $\\boldsymbol{x}_0$ 及外指向单位法向量 $\\boldsymbol{n}$ 定义的主平面，间隙是该节点到平面的带符号正交距离。该距离通过将连接平面上一点到从节点的向量 $(\\boldsymbol{x}_s - \\boldsymbol{x}_0)$ 投影到法向量 $\\boldsymbol{n}$ 上来计算。\n$$g_n = (\\boldsymbol{x}_s - \\boldsymbol{x}_0) \\cdot \\boldsymbol{n}$$\n符号约定如下：$g_n < 0$ 意味着侵入，即从节点沿与 $\\boldsymbol{n}$ 相反的方向穿过了平面。$g_n \\ge 0$ 的条件意味着节点位于接触表面上或之外，处于分离状态。因此，该单边约束的接触激活条件，即Kuhn-Tucker条件，是 $g_n < 0$。\n\n其次，我们从罚函数势能推导接触力和切线刚度。罚函数法通过允许一个小的、非物理的侵入来对严格的非侵入约束进行正则化，该侵入会受到一个与侵入深度成正比的排斥力的惩罚。一个标准的单边法向接触二次罚函数势能 $\\Pi_p$ 由下式给出：\n$$\\Pi_p(g_n) = \\begin{cases} \\frac{1}{2} \\epsilon_n g_n^2 & \\text{if } g_n < 0 \\\\ 0 & \\text{if } g_n \\ge 0 \\end{cases}$$\n其中 $\\epsilon_n > 0$ 是罚参数。\n\n标量法向接触力必须为非负值，即 $f_c \\ge 0$。它源于Karush-Kuhn-Tucker (KKT) 条件，在罚函数法中近似为 $f_c \\approx \\epsilon_n \\max(0, -g_n)$。这导致：\n$$f_c(g_n) = \\begin{cases} -\\epsilon_n g_n & \\text{if } g_n < 0 \\\\ 0 & \\text{if } g_n \\ge 0 \\end{cases}$$\n当 $g_n < 0$ 时，侵入深度为 $|g_n| = -g_n$，因此力 $f_c = \\epsilon_n |g_n|$ 为正，正确地表示了排斥作用。\n\n相关的标量一致性切线定义为 $k_c := \\partial f_c / \\partial g_n$。我们对 $f_c$ 的表达式求导：\n$$k_c(g_n) = \\frac{\\partial f_c}{\\partial g_n} = \\begin{cases} \\frac{\\partial}{\\partial g_n}(-\\epsilon_n g_n) & \\text{if } g_n < 0 \\\\ \\frac{\\partial}{\\partial g_n}(0) & \\text{if } g_n \\ge 0 \\end{cases} = \\begin{cases} -\\epsilon_n & \\text{if } g_n < 0 \\\\ 0 & \\text{if } g_n \\ge 0 \\end{cases}$$\n对于激活的接触，$k_c$ 的负号是正确的，并且符合这些定义。它表示力的大小增加（$df_c > 0$）对应于侵入的增加，这意味着间隙的代数值减小（$dg_n < 0$）。\n\n现在我们使用所提供的数值数据来计算这些量：\n- 从节点位置 $\\boldsymbol{x}_s = \\begin{pmatrix} 0.3998 \\\\ -0.1 \\\\ 0.1998 \\end{pmatrix}\\,\\text{米}$\n- 平面上的点 $\\boldsymbol{x}_0 = \\begin{pmatrix} 0.4 \\\\ -0.1 \\\\ 0.2 \\end{pmatrix}\\,\\text{米}$\n- 平面的单位法向量 $\\boldsymbol{n} = \\frac{1}{3}\\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\end{pmatrix}$\n- 法向罚参数 $\\epsilon_n = 3.5 \\times 10^{7}\\,\\text{牛顿/米}$\n\n首先，我们计算从 $\\boldsymbol{x}_0$ 到 $\\boldsymbol{x}_s$ 的向量：\n$$\\boldsymbol{x}_s - \\boldsymbol{x}_0 = \\begin{pmatrix} 0.3998 - 0.4 \\\\ -0.1 - (-0.1) \\\\ 0.1998 - 0.2 \\end{pmatrix} = \\begin{pmatrix} -0.0002 \\\\ 0 \\\\ -0.0002 \\end{pmatrix}\\,\\text{米}$$\n\n接下来，我们计算带符号法向间隙 $g_n$：\n$$g_n = (\\boldsymbol{x}_s - \\boldsymbol{x}_0) \\cdot \\boldsymbol{n} = \\begin{pmatrix} -0.0002 \\\\ 0 \\\\ -0.0002 \\end{pmatrix} \\cdot \\left(\\frac{1}{3}\\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\end{pmatrix}\\right)$$\n$$g_n = \\frac{1}{3} \\left( (-0.0002)(1) + (0)(2) + (-0.0002)(2) \\right) = \\frac{1}{3} (-0.0002 - 0.0004) = \\frac{-0.0006}{3}$$\n$$g_n = -0.0002\\,\\text{米}$$\n四舍五入至四位有效数字，得到 $g_n = -2.000 \\times 10^{-4}\\,\\text{米}$。\n\n由于 $g_n < 0$，接触是激活的（发生侵入）。我们继续计算力 $f_c$ 和刚度 $k_c$。\n对于激活的接触：\n$$f_c = -\\epsilon_n g_n = -(3.5 \\times 10^{7}\\,\\text{牛顿/米})(-0.0002\\,\\text{米})$$\n$$f_c = (3.5 \\times 10^{7})(2 \\times 10^{-4})\\,\\text{牛顿} = 7 \\times 10^{3}\\,\\text{牛顿}$$\n$$f_c = 7000\\,\\text{牛顿}$$\n四舍五入至四位有效数字，得到 $f_c = 7.000 \\times 10^{3}\\,\\text{牛顿}$。\n\n对于激活的接触，切线刚度为：\n$$k_c = -\\epsilon_n = -3.5 \\times 10^{7}\\,\\text{牛顿/米}$$\n四舍五入至四位有效数字，得到 $k_c = -3.500 \\times 10^{7}\\,\\text{牛顿/米}$。\n\n最终结果为 $(g_n, f_c, k_c)$。", "answer": "$$\\boxed{\\begin{pmatrix} -2.000 \\times 10^{-4} & 7.000 \\times 10^{3} & -3.500 \\times 10^{7} \\end{pmatrix}}$$", "id": "2548022"}, {"introduction": "现实世界中的部件通常具有边和角等尖锐特征。本实践 [@problem_id:2547993] 探讨了一个节点与主边接触的运动学问题，在这种情况下，接触法向不是唯一确定的。您将应用法向锥（normal cone）的概念来确定合适的接触方向并计算相应的间隙 $g_n$，从而提高您处理几何不连续性接触这一关键问题的能力。", "problem": "在一次有限元法 (FEM) 接触分析中，一个从节点在三维空间中接近一条直线主边。该主边是从点 $\\boldsymbol{x}_A = (0,0,0)$ 到点 $\\boldsymbol{x}_B = (2,0,0)$ 的闭合线段。从节点的位置为 $\\boldsymbol{x}_s = (0.8,0.2,0.6)$。该主边由两个平面小面共享，其在该边上的单位外法向量分别为 $\\boldsymbol{n}_1 = \\left(0,\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}}\\right)$ 和 $\\boldsymbol{n}_2 = \\left(0,-\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}}\\right)$。根据几何相容性要求，边的切线与两个小面的法向量均正交。\n\n使用以下基本定义和事实：\n- 点在线上的正交投影是通过从“点到线段起点向量”中移除垂直于线的单位切线的那个分量来获得的。如果投影参数位于线段之外，则将其钳位至线段的端点。\n- 边法向锥是由相邻小面法向量生成的凸锥，即集合 $\\mathcal{C} = \\{\\alpha\\,\\boldsymbol{n}_1 + \\beta\\,\\boldsymbol{n}_2 \\,|\\, \\alpha \\ge 0,\\ \\beta \\ge 0\\}$。沿该边的容许单位接触法向量是 $\\boldsymbol{n} \\in \\mathcal{C}$ 且 $\\|\\boldsymbol{n}\\|=1$。\n- 法向间隙是沿锥内某一容许单位法向量的最大法向接近量，即“从节点到边的向量”在锥内所有单位向量上的法向分量的上确界。\n\n任务：\n1) 确定 $\\boldsymbol{x}_s$ 在主边线段 $\\overline{AB}$ 上的正交投影 $\\boldsymbol{x}_p$。\n2) 使用边法向锥 $\\mathcal{C}$，确定由下式定义的相应接触法向间隙 $g_n$：\n$$\ng_n \\;=\\; \\max\\limits_{\\boldsymbol{n} \\in \\mathcal{C},\\ \\|\\boldsymbol{n}\\|=1} \\ \\boldsymbol{n} \\cdot \\big(\\boldsymbol{x}_s - \\boldsymbol{x}_p\\big).\n$$\n\n只报告 $g_n$ 的值。将你的答案四舍五入到 $4$ 位有效数字，并以米为单位表示。", "solution": "该问题要求确定一个从节点接近主边时的接触法向间隙，这是接触有限元分析中的一项标准计算。求解过程分两个阶段：首先，找到从节点在主边线段上的正交投影；其次，通过将从节点到投影点的向量在容许单位接触法向量集合上的投影最大化来计算法向间隙。\n\n已知条件如下：\n主边端点：$\\boldsymbol{x}_A = (0, 0, 0)$ 和 $\\boldsymbol{x}_B = (2, 0, 0)$。\n从节点位置：$\\boldsymbol{x}_s = (0.8, 0.2, 0.6)$。\n相邻小面法向量：$\\boldsymbol{n}_1 = \\left(0, \\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}\\right)$ 和 $\\boldsymbol{n}_2 = \\left(0, -\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}\\right)$。\n\n首先，我们确定从节点 $\\boldsymbol{x}_s$ 在线段 $\\overline{AB}$ 上的正交投影 $\\boldsymbol{x}_p$。主边所在的直线可以参数化为 $\\boldsymbol{x}(l) = \\boldsymbol{x}_A + l(\\boldsymbol{x}_B - \\boldsymbol{x}_A)$，其中 $l \\in [0, 1]$。$\\boldsymbol{x}_s$ 在包含 $\\overline{AB}$ 的无限长直线上的正交投影所对应的参数 $l$ 由以下公式给出：\n$$\nl = \\frac{(\\boldsymbol{x}_s - \\boldsymbol{x}_A) \\cdot (\\boldsymbol{x}_B - \\boldsymbol{x}_A)}{\\|\\boldsymbol{x}_B - \\boldsymbol{x}_A\\|^2}\n$$\n从线段起点 $\\boldsymbol{x}_A$ 到从节点的向量是 $\\boldsymbol{v}_{As} = \\boldsymbol{x}_s - \\boldsymbol{x}_A = (0.8, 0.2, 0.6)$。代表主线段的向量是 $\\boldsymbol{v}_{AB} = \\boldsymbol{x}_B - \\boldsymbol{x}_A = (2, 0, 0)$。\n\n将这些向量代入 $l$ 的公式中：\n$$\nl = \\frac{(0.8, 0.2, 0.6) \\cdot (2, 0, 0)}{\\|(2, 0, 0)\\|^2} = \\frac{(0.8)(2) + (0.2)(0) + (0.6)(0)}{2^2} = \\frac{1.6}{4} = 0.4\n$$\n由于该值 $l=0.4$ 位于区间 $[0, 1]$ 内，投影点 $\\boldsymbol{x}_p$ 位于线段 $\\overline{AB}$ 上。问题描述中的钳位操作在此不是必需的。投影点的坐标为：\n$$\n\\boldsymbol{x}_p = \\boldsymbol{x}_A + l (\\boldsymbol{x}_B - \\boldsymbol{x}_A) = (0, 0, 0) + 0.4 \\cdot (2, 0, 0) = (0.8, 0, 0)\n$$\n\n接下来，我们计算接触法向间隙 $g_n$。其定义为：\n$$\ng_n = \\max\\limits_{\\boldsymbol{n} \\in \\mathcal{C},\\ \\|\\boldsymbol{n}\\|=1} \\boldsymbol{n} \\cdot \\boldsymbol{d}\n$$\n其中 $\\boldsymbol{d} = \\boldsymbol{x}_s - \\boldsymbol{x}_p$。该向量为：\n$$\n\\boldsymbol{d} = (0.8, 0.2, 0.6) - (0.8, 0, 0) = (0, 0.2, 0.6)\n$$\n容许单位接触法向量 $\\boldsymbol{n}$ 的集合是凸锥 $\\mathcal{C} = \\{\\alpha\\,\\boldsymbol{n}_1 + \\beta\\,\\boldsymbol{n}_2 \\,|\\, \\alpha \\ge 0,\\ \\beta \\ge 0\\}$ 内的单位向量。$\\mathcal{C}$ 中的任意向量 $\\boldsymbol{n}$ 是小面法向量 $\\boldsymbol{n}_1$ 和 $\\boldsymbol{n}_2$ 的一个非负线性组合。\n\n我们必须在 $\\boldsymbol{n} = \\alpha \\boldsymbol{n}_1 + \\beta \\boldsymbol{n}_2$、$\\alpha \\ge 0$、$\\beta \\ge 0$ 和 $\\|\\boldsymbol{n}\\|=1$ 的约束下，最大化函数 $f(\\boldsymbol{n}) = \\boldsymbol{n} \\cdot \\boldsymbol{d}$。首先，我们检查生成法向量的点积：\n$$\n\\boldsymbol{n}_1 \\cdot \\boldsymbol{n}_2 = \\left(0, \\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}\\right) \\cdot \\left(0, -\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}\\right) = 0 - \\frac{1}{2} + \\frac{1}{2} = 0\n$$\n由于 $\\boldsymbol{n}_1$ 和 $\\boldsymbol{n}_2$ 是正交单位向量，归一化约束 $\\|\\boldsymbol{n}\\|^2=1$ 简化为：\n$$\n\\|\\alpha \\boldsymbol{n}_1 + \\beta \\boldsymbol{n}_2\\|^2 = \\alpha^2 \\|\\boldsymbol{n}_1\\|^2 + \\beta^2 \\|\\boldsymbol{n}_2\\|^2 + 2\\alpha\\beta(\\boldsymbol{n}_1 \\cdot \\boldsymbol{n}_2) = \\alpha^2 + \\beta^2 = 1\n$$\n因此，参数 $(\\alpha, \\beta)$ 必须位于第一象限的单位圆弧上。\n需要最大化的目标函数是：\n$$\n\\boldsymbol{n} \\cdot \\boldsymbol{d} = (\\alpha \\boldsymbol{n}_1 + \\beta \\boldsymbol{n}_2) \\cdot \\boldsymbol{d} = \\alpha (\\boldsymbol{n}_1 \\cdot \\boldsymbol{d}) + \\beta (\\boldsymbol{n}_2 \\cdot \\boldsymbol{d})\n$$\n让我们计算系数 $c_1 = \\boldsymbol{n}_1 \\cdot \\boldsymbol{d}$ 和 $c_2 = \\boldsymbol{n}_2 \\cdot \\boldsymbol{d}$：\n$$\nc_1 = \\left(0, \\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}\\right) \\cdot (0, 0.2, 0.6) = \\frac{0.2}{\\sqrt{2}} + \\frac{0.6}{\\sqrt{2}} = \\frac{0.8}{\\sqrt{2}}\n$$\n$$\nc_2 = \\left(0, -\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}\\right) \\cdot (0, 0.2, 0.6) = -\\frac{0.2}{\\sqrt{2}} + \\frac{0.6}{\\sqrt{2}} = \\frac{0.4}{\\sqrt{2}}\n$$\n我们要在 $\\alpha^2 + \\beta^2 = 1$、$\\alpha \\ge 0$、$\\beta \\ge 0$ 的约束下最大化 $c_1 \\alpha + c_2 \\beta$。由于 $c_1$ 和 $c_2$ 均为正，当向量 $(\\alpha, \\beta)$ 与 $(c_1, c_2)$ 平行时，达到最大值。这给出了最优参数 $\\alpha = \\frac{c_1}{\\sqrt{c_1^2 + c_2^2}}$ 和 $\\beta = \\frac{c_2}{\\sqrt{c_1^2 + c_2^2}}$。最大值 $g_n$ 是：\n$$\ng_n = c_1 \\left( \\frac{c_1}{\\sqrt{c_1^2 + c_2^2}} \\right) + c_2 \\left( \\frac{c_2}{\\sqrt{c_1^2 + c_2^2}} \\right) = \\frac{c_1^2 + c_2^2}{\\sqrt{c_1^2 + c_2^2}} = \\sqrt{c_1^2 + c_2^2}\n$$\n代入 $c_1$ 和 $c_2$ 的值：\n$$\ng_n = \\sqrt{\\left(\\frac{0.8}{\\sqrt{2}}\\right)^2 + \\left(\\frac{0.4}{\\sqrt{2}}\\right)^2} = \\sqrt{\\frac{0.64}{2} + \\frac{0.16}{2}} = \\sqrt{\\frac{0.80}{2}} = \\sqrt{0.4}\n$$\n另外，可以发现向量 $\\boldsymbol{d} = (0, 0.2, 0.6)$ 与边切线 $\\boldsymbol{t} = (1, 0, 0)$ 正交。这意味着 $\\boldsymbol{d}$ 完全位于由 $\\boldsymbol{n}_1$ 和 $\\boldsymbol{n}_2$ 张成的平面内。由于表示式 $\\boldsymbol{d} = c_1 \\boldsymbol{n}_1 + c_2 \\boldsymbol{n}_2$ 的系数 $c_1$ 和 $c_2$ 均为正，$\\boldsymbol{d}$ 位于锥 $\\mathcal{C}$ 内。在这种情况下，最优单位法向量 $\\boldsymbol{n}$ 与 $\\boldsymbol{d}$同向，即 $\\boldsymbol{n} = \\boldsymbol{d}/\\|\\boldsymbol{d}\\|$。那么最大间隙为：\n$$\ng_n = \\frac{\\boldsymbol{d}}{\\|\\boldsymbol{d}\\|} \\cdot \\boldsymbol{d} = \\frac{\\|\\boldsymbol{d}\\|^2}{\\|\\boldsymbol{d}\\|} = \\|\\boldsymbol{d}\\|\n$$\n$$\n\\|\\boldsymbol{d}\\| = \\sqrt{0^2 + 0.2^2 + 0.6^2} = \\sqrt{0.04 + 0.36} = \\sqrt{0.40}\n$$\n这证实了之前的结果。我们现在必须对其进行数值计算并四舍五入到 $4$ 位有效数字。\n$$\ng_n = \\sqrt{0.4} \\approx 0.6324555...\n$$\n四舍五入到 $4$ 位有效数字，我们得到 $0.6325$。", "answer": "$$\n\\boxed{0.6325}\n$$", "id": "2547993"}, {"introduction": "在单点相互作用的基础上，我们现在转向更通用、更稳健的表面-表面（surface-to-surface）接触公式。这种方法通过在分布式区域上考虑相互作用，缓解了节点-表面方法中存在的许多问题。在这个编程练习 [@problem_id:2548018] 中，您将实现对从单元上接触压力的数值积分，以计算一致的单元接触力向量 $\\mathbf{f}_e$，这是现代接触仿真的核心任务之一。", "problem": "给定一个与刚性平面接触的单个等参双线性四边形从面单元。该单元有四个节点，其在方形母域 $[-1,1]\\times[-1,1]$ 上的标准母坐标分别为 $(-1,-1)$、$(+1,-1)$、$(+1,+1)$、$(-1,+1)$，并使用标准双线性形函数 $N_I(\\xi,\\eta)$（$I=1,\\dots,4$）。刚性平面由平面上的一个点 $\\mathbf{x}_0$ 和一个从平面指向从体的单位法向量 $\\mathbf{n}$ 定义。物理位置为 $\\mathbf{x}(\\xi,\\eta)$ 的曲面点处的法向间隙场定义为 $g_n(\\xi,\\eta)=\\mathbf{n}\\cdot\\left(\\mathbf{x}(\\xi,\\eta)-\\mathbf{x}_0\\right)$。使用罚函数接触定律，法向拉格朗日乘子（接触压力）为 $\\lambda_n(\\xi,\\eta)=k_p\\,\\langle -g_n(\\xi,\\eta)\\rangle_+$，其中 $k_p$ 是罚刚度，$\\langle\\cdot\\rangle_+=\\max(0,\\cdot)$ 表示 Macaulay 括号。仅当积分点的 $g_n(\\xi,\\eta)<0$ 时，接触才被激活。单元接触力向量 $\\mathbf{f}_e$ 的计算方式为，首先计算每个节点 $I$ 的力向量 $\\mathbf{f}_I = \\int_{\\mathcal{A}_c} N_I(\\xi,\\eta)\\,\\lambda_n(\\xi,\\eta)\\,\\mathbf{n}\\, \\mathrm{d}A$，然后将它们组装成一个12维的向量。曲面微分 $\\mathrm{d}A$ 通过等参映射计算，$\\mathrm{d}A=\\left\\|\\mathbf{a}_1(\\xi,\\eta)\\times\\mathbf{a}_2(\\xi,\\eta)\\right\\|\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$，其中协变基向量为 $\\mathbf{a}_1=\\sum_{I=1}^4 \\frac{\\partial N_I}{\\partial \\xi}\\,\\mathbf{X}_I$ 和 $\\mathbf{a}_2=\\sum_{I=1}^4 \\frac{\\partial N_I}{\\partial \\eta}\\,\\mathbf{X}_I$，以物理节点坐标 $\\mathbf{X}_I$ 表示。使用 $2\\times 2$ Gauss 积分对积分进行近似，积分点位于 $(\\pm 1/\\sqrt{3},\\pm 1/\\sqrt{3})$，每个点的权重 $w=1$。仅使用激活的 Gauss 点进行组装。\n\n实现一个程序，对于下面指定的每个测试用例，计算以牛顿为单位的 12 分量单元接触力向量 $\\mathbf{f}_e=\\left[f_{1x},f_{1y},f_{1z},f_{2x},f_{2y},f_{2z},f_{3x},f_{3y},f_{3z},f_{4x},f_{4y},f_{4z}\\right]$。请遵循以下约定：\n- 从面单元节点按物理顺序排列为 $\\mathbf{X}_1=(0,0,z_1)$、$\\mathbf{X}_2=(L_x,0,z_2)$、$\\mathbf{X}_3=(L_x,L_y,z_3)$、$\\mathbf{X}_4=(0,L_y,z_4)$，其中给定的 $L_x$ 和 $L_y$ 单位为米，给定的节点离面坐标 $z_I$ 单位为米。\n- 刚性平面的参数为 $\\mathbf{x}_0=(0,0,0)$ 和 $\\mathbf{n}=\\left[0,0,1\\right]^T$。\n- 使用指定的罚刚度 $k_p$。\n- 使用 $2\\times 2$ Gauss 积分，积分点为 $(\\xi,\\eta)\\in\\{\\left(-1/\\sqrt{3},-1/\\sqrt{3}\\right),\\left(+1/\\sqrt{3},-1/\\sqrt{3}\\right),\\left(+1/\\sqrt{3},+1/\\sqrt{3}\\right),\\left(-1/\\sqrt{3},+1/\\sqrt{3}\\right)\\}$，每个点的权重 $w=1$。\n- 当且仅当 $g_n(\\xi,\\eta)<0$ 时，将一个 Gauss 点视为激活状态。\n- 以牛顿表示最终的节点力分量，并将每个分量四舍五入到恰好 6 位小数。\n\n测试套件（所有长度单位为米，力单位为牛顿）：\n- 情况 A（一般激活情况）：$L_x=0.2$，$L_y=0.1$，$k_p=10^9$，$(z_1,z_2,z_3,z_4)=(-0.001,-0.001,-0.001,-0.001)$。\n- 情况 B（无激活点）：$L_x=0.2$，$L_y=0.1$，$k_p=10^9$，$(z_1,z_2,z_3,z_4)=(+0.001,+0.001,+0.001,+0.001)$。\n- 情况 C（激活/非激活混合情况）：$L_x=0.2$，$L_y=0.1$，$k_p=10^9$，$(z_1,z_2,z_3,z_4)=(-0.004,+0.001,+0.001,+0.001)$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含三个用例的结果，格式为一个包含三个子列表的列表（每个用例一个）。每个子列表是按上述节点主序展开的 12 分量力向量。该行不应包含空格，每个浮点数必须四舍五入到恰好 6 位小数。例如，一个有效的输出格式为 $[[a_1,a_2,\\dots,a_{12}],[b_1,b_2,\\dots,b_{12}],[c_1,c_2,\\dots,c_{12}]]$，其中每个 $a_i$，$b_i$，$c_i$ 是小数点后恰好有 6 位数字的十进制数。", "solution": "首先对问题进行验证，以确保其在科学上是合理的、提法是正确的并且是完整的。\n\n### 步骤1：提取已知条件\n- **单元**：等参双线性四边形从面单元，节点 1-4 的母坐标为 $(−1,−1)$、$(+1,−1)$、$(+1,+1)$、$(−1,+1)$。\n- **形函数**：$N_I(\\xi,\\eta)$，$I=1,\\dots,4$。\n- **刚性平面**：由点 $\\mathbf{x}_0=(0,0,0)$ 和法向量 $\\mathbf{n}=\\left[0,0,1\\right]^T$ 定义。\n- **法向间隙**：$g_n(\\xi,\\eta)=\\mathbf{n}\\cdot\\left(\\mathbf{x}(\\xi,\\eta)-\\mathbf{x}_0\\right)$。\n- **接触定律**：罚函数法，压力为 $\\lambda_n(\\xi,\\eta)=k_p\\,\\langle -g_n(\\xi,\\eta)\\rangle_+$，其中 $\\langle\\cdot\\rangle_+=\\max(0,\\cdot)$。当 $g_n(\\xi,\\eta)<0$ 时接触被激活。\n- **单元接触力**：$\\mathbf{f}_e$ 的每个节点分量 $\\mathbf{f}_I$ 通过积分 $\\int N_I \\lambda_n \\mathbf{n} \\, \\mathrm{d}A$ 计算。\n- **曲面微分面积**：$\\mathrm{d}A=\\left\\|\\mathbf{a}_1(\\xi,\\eta)\\times\\mathbf{a}_2(\\xi,\\eta)\\right\\|\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$，协变基向量为 $\\mathbf{a}_1=\\sum_{I=1}^4 \\frac{\\partial N_I}{\\partial \\xi}\\,\\mathbf{X}_I$ 和 $\\mathbf{a}_2=\\sum_{I=1}^4 \\frac{\\partial N_I}{\\partial \\eta}\\,\\mathbf{X}_I$。\n- **数值积分**：$2\\times 2$ Gauss 积分，积分点 $(\\xi,\\eta)\\in\\{\\left(\\pm 1/\\sqrt{3},\\pm 1/\\sqrt{3}\\right)\\}$，每个点的权重 $w=1$。积分仅在激活的 Gauss 点上执行。\n- **节点坐标**：$\\mathbf{X}_1=(0,0,z_1)$、$\\mathbf{X}_2=(L_x,0,z_2)$、$\\mathbf{X}_3=(L_x,L_y,z_3)$、$\\mathbf{X}_4=(0,L_y,z_4)$。\n- **测试用例**：\n    - **A**：$L_x=0.2$，$L_y=0.1$，$k_p=10^9$，$(z_1,z_2,z_3,z_4)=(-0.001,-0.001,-0.001,-0.001)$。\n    - **B**：$L_x=0.2$，$L_y=0.1$，$k_p=10^9$，$(z_1,z_2,z_3,z_4)=(+0.001,+0.001,+0.001,+0.001)$。\n    - **C**：$L_x=0.2$，$L_y=0.1$，$k_p=10^9$，$(z_1,z_2,z_3,z_4)=(-0.004,+0.001,+0.001,+0.001)$。\n- **输出格式**：每个用例一个 12 分量的力向量，每个分量四舍五入到 6 位小数。\n\n### 步骤2：验证\n该问题在科学上基于有限元方法中的计算接触力学理论。它提法正确、客观，并提供了计算唯一解所需的所有数据。原始问题陈述中对力向量积分的符号表示有些模糊，但通过遵循与问题描述文本一致的、物理上一致的标准列式，可以解决这个问题。因此，该问题被认定为**有效**。\n\n### 步骤3：求解\n节点接触力向量 $\\mathbf{f}_e$ 是通过对接触虚功的弱形式进行数值积分来计算的。该积分通过对 $M=4$ 个 Gauss 积分点的求和来近似：\n$$\n\\mathbf{f}_e \\approx \\sum_{q=1}^{M} w_q \\, \\left( \\lambda_n(\\xi_q, \\eta_q) \\, \\mathbf{F}_{dist}(\\xi_q, \\eta_q) \\, J_A(\\xi_q, \\eta_q) \\right)\n$$\n其中求和仅对激活点（$g_n < 0$ 的点）进行。这里，$w_q=1$ 是 Gauss 权重，$(\\xi_q, \\eta_q)$ 是 Gauss 点坐标，$\\lambda_n$ 是罚函数压力，$\\mathbf{F}_{dist}$ 是力分布向量，$J_A$ 是曲面协变基向量叉积的模（曲面雅可比）。\n\n每个测试用例的步骤如下：\n\n1.  **定义单元几何形状和参数**：对于每个用例，根据给定的 $L_x$、$L_y$ 和 $z_I$ 定义节点坐标 $\\mathbf{X}_I$。设置罚刚度 $k_p$。\n\n2.  **遍历 Gauss 点**：我们遍历四个 Gauss 点 $(\\xi_q, \\eta_q) = (\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$。\n\n3.  **在每个 Gauss 点评估间隙**：\n    - 双线性形函数 $N_I(\\xi, \\eta)$ 为：\n    $$\n    N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta), \\quad N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)\n    $$\n    $$\n    N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta), \\quad N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n    $$\n    - Gauss 点的物理位置为 $\\mathbf{x}(\\xi_q, \\eta_q) = \\sum_{I=1}^4 N_I(\\xi_q, \\eta_q) \\mathbf{X}_I$。\n    - 间隙为 $g_n = \\mathbf{n} \\cdot (\\mathbf{x} - \\mathbf{x}_0)$。由于 $\\mathbf{n}=[0,0,1]^T$ 且 $\\mathbf{x}_0=\\mathbf{0}$，这简化为插值得到的 z 坐标：$g_n(\\xi_q, \\eta_q) = x_z(\\xi_q, \\eta_q) = \\sum_{I=1}^4 N_I(\\xi_q, \\eta_q) z_I$。\n\n4.  **检查激活接触**：如果 $g_n < 0$，则 Gauss 点被激活。如果一个点未被激活，其对力向量的贡献为零。\n\n5.  **计算来自激活点的力贡献**：对于每个激活的 Gauss 点：\n    - 接触压力为 $\\lambda_n = k_p \\langle -g_n \\rangle_+ = -k_p g_n$。\n    - 计算形函数的导数，例如 $\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta)$，$\\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi)$ 等。\n    - 计算协变基向量：$\\mathbf{a}_1 = \\sum_{I=1}^4 \\frac{\\partial N_I}{\\partial \\xi} \\mathbf{X}_I$ 和 $\\mathbf{a}_2 = \\sum_{I=1}^4 \\frac{\\partial N_I}{\\partial \\eta} \\mathbf{X}_I$。\n    - 计算曲面雅可比行列式：$J_A = \\|\\mathbf{a}_1 \\times \\mathbf{a}_2\\|$。\n    - 力分布向量为 $\\mathbf{F}_{dist} = [N_1\\mathbf{n}^T, \\dots, N_4\\mathbf{n}^T]^T$。由于 $\\mathbf{n}=[0,0,1]^T$，该向量仅在 z 方向自由度上有非零项：$\\mathbf{F}_{dist} = [0, 0, N_1, 0, 0, N_2, 0, 0, N_3, 0, 0, N_4]^T$。\n    - 来自当前 Gauss 点的力增量为 $\\Delta\\mathbf{f}_q = w_q \\lambda_n J_A \\mathbf{F}_{dist}$。由于 $w_q=1$，这简化为 $\\Delta\\mathbf{f}_q = \\lambda_n J_A \\mathbf{F}_{dist}$。\n\n6.  **组装总力向量**：总单元力向量 $\\mathbf{f}_e$ 是所有激活 Gauss 点的增量之和：$\\mathbf{f}_e = \\sum_{\\text{active } q} \\Delta\\mathbf{f}_q$。\n\n7.  **最终格式化**：将得到的 12 分量向量 $\\mathbf{f}_e$ 的各分量按要求四舍五入到 6 位小数。对所有测试用例重复此过程。", "answer": "[[0.000000,0.000000,5000.000000,0.000000,0.000000,5000.000000,0.000000,0.000000,5000.000000,0.000000,0.000000,5000.000000],[0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000],[0.000000,0.000000,3112.553316,0.000000,0.000000,834.336496,0.000000,0.000000,223.705574,0.000000,0.000000,834.336496]]", "id": "2548018"}]}