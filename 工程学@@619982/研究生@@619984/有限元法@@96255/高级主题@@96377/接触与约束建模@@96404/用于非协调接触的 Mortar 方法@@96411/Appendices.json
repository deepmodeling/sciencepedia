{"hands_on_practices": [{"introduction": "砂浆法的核心在于精确处理非协调网格之间的耦合积分。当一个从单元的边界与多个主单元的边界重叠时，若直接在整个从边界上使用单一的求积法则，会因被积函数不光滑而导致显著的积分误差。本练习引导您完成砂浆法中最基本也最关键的几何操作：将从边界分割成与不同主单元对应的区段，并为每个区段构建独立的高斯求积方案，从而确保积分的准确性。通过这个计算 [@problem_id:2581175]，您将掌握处理复杂接触几何的底层技术。", "problem": "在使用砂浆法处理非协调接触的有限元方法背景下，考虑一个平面界面。其中，主边是由共享一个公共顶点的两条线性边构成的折线，从边是一条单一的直线段，该直线段在最近点正交投影的意义上与两条主边均有重叠。\n\n设主边为从 $\\mathbf{A}=(0,0)$ 到 $\\mathbf{B}=(1,0)$ 的 $\\Gamma_{M,1}$ 和从 $\\mathbf{B}=(1,0)$ 到 $\\mathbf{C}=(1,1)$ 的 $\\Gamma_{M,2}$。设从边为从 $\\mathbf{P}_0=(0.4,-0.2)$ 到 $\\mathbf{P}_1=(1.1,0.9)$ 的 $\\Gamma_{S}$。通过从双单位区间 $s\\in[-1,1]$ 到该线段的标准仿射映射来参数化从边，即 $\\mathbf{x}_{S}(s)=\\mathbf{x}_{m}+s\\,\\mathbf{x}_{d}$，其中 $\\mathbf{x}_{m}=(\\mathbf{P}_0+\\mathbf{P}_1)/2$ 且 $\\mathbf{x}_{d}=(\\mathbf{P}_1-\\mathbf{P}_0)/2$。采用到主折线的最近点正交投影，边的选择通过比较到 $\\Gamma_{M,1}$ 的距离 $d_1(s)=|y_{S}(s)|$ 和到 $\\Gamma_{M,2}$ 的距离 $d_2(s)=|x_{S}(s)-1|$ 来确定，并要求正交垂足落在相应的边内（对于此几何构型，该要求在激活部分上是满足的）。将激活接触界面定义为 $\\Gamma_{S}$ 上其投影落在 $\\Gamma_{M,1}\\cup\\Gamma_{M,2}$ 上的那部分。\n\n任务：\n- 计算从参数分割点 $s^{\\star}$，在该点处激活主边发生改变，即满足 $x_{S}(s)\\le 1$ 和 $y_{S}(s)\\ge 0$ 条件下 $d_1(s)=d_2(s)$ 的唯一点。用此点确定与 $\\Gamma_{M,1}$ 配对的从子线段 $I_1=[-1,s^{\\star}]$ 和与 $\\Gamma_{M,2}$ 配对的从子线段 $I_2=[s^{\\star},1]$。\n- 对每个子线段 $I_j=[a_j,b_j]$，在从参数 $s$ 上构造2点高斯-勒让德求积，其节点为 $s_{j}^{\\pm}=\\frac{a_j+b_j}{2}\\pm\\frac{b_j-a_j}{2}\\,\\frac{1}{\\sqrt{3}}$，参数权重为 $w_{j}^{\\pm}=\\frac{b_j-a_j}{2}$。给出相应的物理线积分权重 $\\widehat{w}_{j}^{\\pm}=J_{S}\\,w_{j}^{\\pm}$，其中 $J_{S}=\\|\\mathbf{x}_{d}\\|$ 是 $\\Gamma_{S}$ 上的常线雅可比。对于每个求积节点 $s_{j}^{\\pm}$，也给出相关联的主边局部坐标 $t\\in[-1,1]$：对于 $\\Gamma_{M,1}$，使用 $\\mathbf{x}_{M,1}(t)=\\big(\\frac{1+t}{2},0\\big)$，因此 $t_{1}(s)=2\\,x_{S}(s)-1$；对于 $\\Gamma_{M,2}$，使用 $\\mathbf{x}_{M,2}(t)=\\big(1,\\frac{1+t}{2}\\big)$，因此 $t_{2}(s)=2\\,y_{S}(s)-1$。\n- 使用上述在 $I_1\\cup I_2$ 上的复合求积法，计算砂浆线积分\n$$\nI=\\int_{\\Gamma_{S}^{\\text{act}}}\\big(x+2y\\big)\\,\\mathrm{d}\\ell,\n$$\n其中 $(x,y)$ 是 $\\Gamma_{S}$ 上的坐标，$\\mathrm{d}\\ell$ 是线元。将 $I$ 的最终值表示为一个无单位的精确解析表达式。不要进行四舍五入。", "solution": "在尝试任何解答之前，需对问题陈述进行验证。\n\n逐字提取已知条件如下：\n- 主边：从 $\\mathbf{A}=(0,0)$ 到 $\\mathbf{B}=(1,0)$ 的 $\\Gamma_{M,1}$；从 $\\mathbf{B}=(1,0)$ 到 $\\mathbf{C}=(1,1)$ 的 $\\Gamma_{M,2}$。\n- 从边：从 $\\mathbf{P}_0=(0.4,-0.2)$ 到 $\\mathbf{P}_1=(1.1,0.9)$ 的 $\\Gamma_{S}$。\n- 从边参数化：$\\mathbf{x}_{S}(s)=\\mathbf{x}_{m}+s\\,\\mathbf{x}_{d}$，对于 $s\\in[-1,1]$，其中 $\\mathbf{x}_{m}=(\\mathbf{P}_0+\\mathbf{P}_1)/2$ 且 $\\mathbf{x}_{d}=(\\mathbf{P}_1-\\mathbf{P}_0)/2$。\n- 投影规则：到主折线的最近点正交投影。边的选择通过比较到 $\\Gamma_{M,1}$ 的距离 $d_1(s)=|y_{S}(s)|$ 和到 $\\Gamma_{M,2}$ 的距离 $d_2(s)=|x_{S}(s)-1|$ 来确定。\n- 激活界面条件：正交垂足落在相应的主边内。\n- 任务1：求分割点 $s^{\\star}$，在该点处 $d_1(s)=d_2(s)$ 且 $x_{S}(s)\\le 1$ 和 $y_{S}(s)\\ge 0$。这定义了子线段 $I_1=[-1,s^{\\star}]$ 和 $I_2=[s^{\\star},1]$。\n- 任务2：对每个子线段 $I_j$，构造一个2点高斯-勒让德求积，包含节点 $s_{j}^{\\pm}$、参数权重 $w_{j}^{\\pm}$、物理权重 $\\widehat{w}_{j}^{\\pm}$ 以及相关联的主边局部坐标 $t(s)$。\n- 任务3：使用此求积法计算积分 $I=\\int_{\\Gamma_{S}^{\\text{act}}}\\big(x+2y\\big)\\,\\mathrm{d}\\ell$。\n\n该问题具有科学依据、是适定且客观的。这是一个计算力学中的标准练习，涉及在分段区域上的数值积分。数据是完整、一致且计算上可行的。该问题没有违反任何基本原理，其结构可以得到一个唯一的、可验证的解。因此，该问题被视为有效，并将提供解答。\n\n首先，我们确定从边的参数化。中点 $\\mathbf{x}_m$ 和方向向量 $\\mathbf{x}_d$ 为：\n$$\n\\mathbf{x}_{m} = \\frac{\\mathbf{P}_0+\\mathbf{P}_1}{2} = \\frac{1}{2}\\big((0.4,-0.2) + (1.1,0.9)\\big) = (0.75, 0.35) = \\left(\\frac{3}{4}, \\frac{7}{20}\\right)\n$$\n$$\n\\mathbf{x}_{d} = \\frac{\\mathbf{P}_1-\\mathbf{P}_0}{2} = \\frac{1}{2}\\big((1.1,0.9) - (0.4,-0.2)\\big) = (0.35, 0.55) = \\left(\\frac{7}{20}, \\frac{11}{20}\\right)\n$$\n从边 $\\Gamma_S$ 的参数化为 $\\mathbf{x}_S(s) = (x_S(s), y_S(s))$：\n$$\nx_S(s) = \\frac{3}{4} + \\frac{7}{20}s\n$$\n$$\ny_S(s) = \\frac{7}{20} + \\frac{11}{20}s\n$$\n\n接下来，我们求从参数分割点 $s^{\\star}$。这是投影从 $\\Gamma_{M,1}$ 切换到 $\\Gamma_{M,2}$ 的点，由条件 $x_S(s)\\le 1$ 和 $y_S(s)\\ge 0$ 下的 $d_1(s)=d_2(s)$ 定义。距离为 $d_1(s)=|y_S(s)|$ 和 $d_2(s)=|x_S(s)-1|$。这些条件意味着我们可以将等式写为 $y_S(s) = 1 - x_S(s)$。\n$$\n\\frac{7}{20} + \\frac{11}{20}s = 1 - \\left(\\frac{3}{4} + \\frac{7}{20}s\\right) = \\frac{1}{4} - \\frac{7}{20}s\n$$\n$$\n\\left(\\frac{11}{20} + \\frac{7}{20}\\right)s = \\frac{1}{4} - \\frac{7}{20} = \\frac{5-7}{20}\n$$\n$$\n\\frac{18}{20}s = -\\frac{2}{20} \\implies \\frac{9}{10}s = -\\frac{1}{10} \\implies s^{\\star} = -\\frac{1}{9}\n$$\n从子线段为 $I_1=[-1, -1/9]$ 和 $I_2=[-1/9, 1]$。\n\n现在我们构造复合2点高斯-勒让德求积。线雅可比 $J_S$ 是一个常数：\n$$\nJ_{S} = \\|\\mathbf{x}_{d}\\| = \\sqrt{\\left(\\frac{7}{20}\\right)^2 + \\left(\\frac{11}{20}\\right)^2} = \\sqrt{\\frac{49+121}{400}} = \\frac{\\sqrt{170}}{20}\n$$\n\n对于子线段 $I_1 = [-1, -1/9]$：\n- 中点：$\\frac{a_1+b_1}{2} = -\\frac{5}{9}$。半长：$\\frac{b_1-a_1}{2} = \\frac{4}{9}$。\n- 节点：$s_{1}^{\\pm} = -\\frac{5}{9} \\pm \\frac{4}{9\\sqrt{3}}$。\n- 参数权重：$w_{1}^{\\pm} = \\frac{4}{9}$。\n- 物理权重：$\\widehat{w}_{1}^{\\pm} = J_S w_{1}^{\\pm} = \\frac{\\sqrt{170}}{20} \\cdot \\frac{4}{9} = \\frac{\\sqrt{170}}{45}$。\n- 针对 $\\Gamma_{M,1}$ 的主坐标映射：$t_1(s) = 2x_S(s)-1 = 2(\\frac{3}{4}+\\frac{7}{20}s)-1 = \\frac{1}{2}+\\frac{7}{10}s$。\n- 节点处的主坐标：$t_1(s_{1}^{\\pm}) = \\frac{1}{2} + \\frac{7}{10}\\left(-\\frac{5}{9} \\pm \\frac{4}{9\\sqrt{3}}\\right) = \\frac{1}{9} \\pm \\frac{14\\sqrt{3}}{135}$。\n\n对于子线段 $I_2 = [-1/9, 1]$：\n- 中点：$\\frac{a_2+b_2}{2} = \\frac{4}{9}$。半长：$\\frac{b_2-a_2}{2} = \\frac{5}{9}$。\n- 节点：$s_{2}^{\\pm} = \\frac{4}{9} \\pm \\frac{5}{9\\sqrt{3}}$。\n- 参数权重：$w_{2}^{\\pm} = \\frac{5}{9}$。\n- 物理权重：$\\widehat{w}_{2}^{\\pm} = J_S w_{2}^{\\pm} = \\frac{\\sqrt{170}}{20} \\cdot \\frac{5}{9} = \\frac{\\sqrt{170}}{36}$。\n- 针对 $\\Gamma_{M,2}$ 的主坐标映射：$t_2(s) = 2y_S(s)-1 = 2(\\frac{7}{20}+\\frac{11}{20}s)-1 = -\\frac{3}{10}+\\frac{11}{10}s$。\n- 节点处的主坐标：$t_2(s_{2}^{\\pm}) = -\\frac{3}{10} + \\frac{11}{10}\\left(\\frac{4}{9} \\pm \\frac{5}{9\\sqrt{3}}\\right) = \\frac{17}{90} \\pm \\frac{11\\sqrt{3}}{54}$。\n\n最后，我们计算积分 $I=\\int_{\\Gamma_{S}^{\\text{act}}}\\big(x+2y\\big)\\,\\mathrm{d}\\ell$。在 $\\Gamma_S$ 上的被积函数是：\n$$\nf(s) = x_S(s)+2y_S(s) = \\left(\\frac{3}{4}+\\frac{7}{20}s\\right) + 2\\left(\\frac{7}{20}+\\frac{11}{20}s\\right) = \\frac{29}{20} + \\frac{29}{20}s = \\frac{29}{20}(1+s)\n$$\n该积分由以下和式近似：$I \\approx \\sum_{k \\in \\{-,+\\}} f(s_{1}^{k}) \\widehat{w}_{1}^{k} + \\sum_{k \\in \\{-,+\\}} f(s_{2}^{k}) \\widehat{w}_{2}^{k}$。\n来自 $I_1$ 的贡献：\n$$\nI_1 = \\widehat{w}_{1}^{\\pm} \\left( f(s_1^-) + f(s_1^+) \\right) = \\frac{\\sqrt{170}}{45} \\left( \\frac{29}{20}(1+s_1^-) + \\frac{29}{20}(1+s_1^+) \\right)\n$$\n$$\nI_1 = \\frac{29\\sqrt{170}}{900} \\left( (1+s_1^-) + (1+s_1^+) \\right) = \\frac{29\\sqrt{170}}{900} \\left( 2 + 2\\left(-\\frac{5}{9}\\right) \\right) = \\frac{29\\sqrt{170}}{900} \\left( \\frac{8}{9} \\right) = \\frac{58\\sqrt{170}}{2025}\n$$\n来自 $I_2$ 的贡献：\n$$\nI_2 = \\widehat{w}_{2}^{\\pm} \\left( f(s_2^-) + f(s_2^+) \\right) = \\frac{\\sqrt{170}}{36} \\left( \\frac{29}{20}(1+s_2^-) + \\frac{29}{20}(1+s_2^+) \\right)\n$$\n$$\nI_2 = \\frac{29\\sqrt{170}}{720} \\left( (1+s_2^-) + (1+s_2^+) \\right) = \\frac{29\\sqrt{170}}{720} \\left( 2 + 2\\left(\\frac{4}{9}\\right) \\right) = \\frac{29\\sqrt{170}}{720} \\left( \\frac{26}{9} \\right) = \\frac{377\\sqrt{170}}{3240}\n$$\n总积分：\n$$\nI = I_1 + I_2 = \\frac{58\\sqrt{170}}{2025} + \\frac{377\\sqrt{170}}{3240}\n$$\n$2025=3^4 \\cdot 5^2$ 和 $3240=2^3 \\cdot 3^4 \\cdot 5$ 的最小公倍数是 $16200$。\n$$\nI = \\frac{58 \\cdot 8}{16200}\\sqrt{170} + \\frac{377 \\cdot 5}{16200}\\sqrt{170} = \\frac{464 + 1885}{16200}\\sqrt{170} = \\frac{2349\\sqrt{170}}{16200}\n$$\n化简分数，因为 $2349 = 29 \\cdot 81 = 29 \\cdot 3^4$ 且 $16200 = 200 \\cdot 81 = 200 \\cdot 3^4$：\n$$\nI = \\frac{29 \\cdot 3^4}{200 \\cdot 3^4}\\sqrt{170} = \\frac{29\\sqrt{170}}{200}\n$$\n由于被积函数是关于 $s$ 的线性多项式，2点高斯求积在每个子区间上都能提供积分的精确值，因此复合求积对总积分也是精确的。", "answer": "$$\n\\boxed{\\frac{29\\sqrt{170}}{200}}\n$$", "id": "2581175"}, {"introduction": "在掌握了砂浆积分的几何构造之后，一个关键的实践问题随之而来：在两个不匹配的网格中，哪一个应该被选为主面（master side），哪一个应该被选为从面（slave side）？这个选择并非无关紧要，它直接关系到接触压力计算结果的稳定性和准确性。本练习 [@problem_id:2581181] 将引导您基于有限元混合法中的 LBB (Ladyzhenskaya–Babuška–Brezzi) 稳定性条件进行推理，从而理解为何将较粗的网格选为主面是保证解稳定、避免压力出现伪振荡的标准做法。", "problem": "在有限元法（FEM）中，考虑两个线性弹性体之间的无摩擦小变形接触，其接触界面为非协调的。设界面表示为 $\\Gamma_c$，两侧网格的特征尺寸分别为 $h_M$ 和 $h_S$，且满足 $h_S < h_M$。一种经典的 Mortar 接触格式通过定义在界面一侧（Mortar 侧，或称主侧）的拉格朗日乘子（LM）场 $\\lambda$ 来弱形式施加不可穿透约束，该场作用于另一侧（非 Mortar 侧，或称从侧）位移场的迹。假设两侧的多项式阶次相当，且界面积格式是一致的。\n\n从包含接触贡献项的虚功原理出发，并考虑混合格式的稳定性要求（Ladyzhenskaya–Babuška–Brezzi (LBB) inf-sup 条件），论证主从面的分配如何影响计算接触压力的精度。特别地，重点讨论将较密的网格选为主面与选为从面的情况。哪个陈述最能描述这种选择对接触压力精度的影响并提供合理的建议？\n\nA. 选择较密的网格作为主面（Mortar 侧）总能提高接触压力的精度，因为此时拉格朗日乘子场 $\\lambda$ 具有更高的分辨率；这种选择是无条件稳定的，无论 $h_M$ 和 $h_S$如何，都应推荐使用。\n\nB. 选择较密的网格作为从面（非 Mortar 侧），较疏的网格作为主面（Mortar 侧），通常能更好地满足离散 inf-sup 条件，从而避免接触压力出现伪振荡；此时压力场在较疏的一侧表示，可能会被略微抹平，但在变分意义上是一致的。当 $h_S \\ll h_M$ 时，推荐使用此分配方式。\n\nC. 在 Mortar 方法中，主从面的分配是无关紧要的；只要积分格式一致，两种选择下的接触压力精度基本相同，因此无需特别推荐。\n\nD. 将较密的网格设置为主面（Mortar 侧），并通过在界面上施加一个足够大的罚参数来补偿任何不匹配，可以获得最佳精度；这既保证了稳定性，又提高了压力分辨率，是推荐的做法。", "solution": "首先必须确定问题陈述的有效性。\n\n步骤 1：提取给定条件\n-   **系统**：两个线性弹性体之间的无摩擦小变形接触。\n-   **界面**：$\\Gamma_c$，非协调的有限元网格。\n-   **网格尺寸**：特征尺寸 $h_M$ 和 $h_S$，明确条件为 $h_S < h_M$。\n-   **方法论**：基于有限元法（FEM）的经典 Mortar 接触格式。\n-   **约束施加**：使用拉格朗日乘子（LM）场 $\\lambda$ 以弱形式施加不可穿透约束。\n-   **场定义**：LM 场 $\\lambda$ 定义在 Mortar（主）侧。它作用于非 Mortar（从）侧位移场的迹。\n-   **假设**：两侧基函数的多项式阶次相当。界面积分是一致的。\n-   **指导原则**：分析必须从虚功原理出发，并考虑稳定性的 Ladyzhenskaya–Babuška–Brezzi (LBB) inf-sup 条件。\n-   **问题**：确定主从面的分配（特别是，选择较密的网格与较疏的网格作为主面）如何影响计算接触压力的精度，并提供一个合理的建议。\n\n步骤 2：使用提取的给定条件进行验证\n-   **科学依据**：该问题完全位于计算接触力学这一成熟的理论框架内，该学科是计算固体力学的一个分支。Mortar 方法、非协调网格、拉格朗日乘子和 LBB 稳定性条件等概念都是标准且基本正确的。\n-   **适定性**：该问题是适定的。它要求基于已建立的稳定性理论进行定性分析，而不是求一个单一的数值答案。所提供的前提足以推导出关于推荐做法的合乎逻辑且唯一的结论。\n-   **客观性**：该问题使用有限元法领域中精确、客观和标准的术语进行陈述。没有主观或含糊不清的陈述。\n-   **验证结论**：问题陈述在科学上是合理的、自洽的、适定的和客观的。它不包含任何矛盾、含糊之处或伪科学元素。这是一个高等计算力学中的有效问题。\n\n步骤 3：定论与行动\n问题有效。将推导完整解答。\n\n该问题描述了一种用于接触问题的混合有限元格式。包含弹性势能和接触约束弱形式的拉格朗日泛函的驻点导出一个鞍点系统。未知量是位移场 $u$ 和代表接触压力的拉格朗日乘子场 $\\lambda$。在离散形式下，我们在合适的有限元空间 $V^h \\times M^h$ 中求解 $(u_h, \\lambda_h)$。\n\n这种鞍点问题的稳定性由离散的 Ladyzhenskaya–Babuška–Brezzi (LBB) 条件（或称 inf-sup 条件）控制。该条件将拉格朗日乘子空间 $M^h$（$\\lambda_h$ 所在的空间）与位移空间 $V^h$（从该空间取检验函数 $\\delta u_h$ 在从边界上的迹）关联起来。该条件指出，必须存在一个与网格离散化参数 h 无关的常数 $\\beta > 0$，使得：\n$$ \\inf_{\\lambda_h \\in M^h} \\sup_{\\delta u_h \\in V^h} \\frac{c(\\delta u_h, \\lambda_h)}{\\|\\delta u_h\\|_{V^h} \\|\\lambda_h\\|_{M^h}} \\ge \\beta $$\n此处，$c(\\delta u_h, \\lambda_h) = \\int_{\\Gamma_c} \\lambda_h (\\text{trace}(\\delta u_h))_n d\\Gamma$ 是耦合两个场的双线性形式。不满足此条件会导致不稳定的格式，通常表现为计算出的拉格朗日乘子场（即接触压力 $\\lambda_h$）中出现严重的、非物理的振荡。\n\n在 Mortar 接触方法的背景下，拉格朗日乘子空间 $M^h$ 是由定义在**主**网格上的基函数构建的。位移检验函数 $\\delta u_h$ 当然是定义在整个求解域上的，但耦合项 $c(\\cdot, \\cdot)$ 涉及它们在**从**面上的迹。LBB 条件本质上要求，从侧位移迹的空间必须足够“丰富”，以约束主侧拉格朗日乘子空间中的每一种模态。\n\n鉴于 $h_S < h_M$，我们来分析两种可能的主从面分配选择：\n\n1.  **选择 1：较密的网格（$h_S$）作为主面，较疏的网格（$h_M$）作为从面。**\n    在这种情况下，拉格朗日乘子空间 $M^h$ 定义在密网格上。这是一个丰富的空间，包含能够表示高频压力变化的自由度。位移检验函数在从面上求值，而从面是疏网格。这个疏网格上的位移迹空间是“贫乏”的，仅包含低频模态。\n    考虑密主网格上的一个高频压力模态 $\\lambda_h$。这种模态很可能与疏从面上的所有可能的位移检验函数近似正交。对于这样的 $\\lambda_h$，分子 $c(\\delta u_h, \\lambda_h)$ 对所有 $\\delta u_h$ 都会非常小。这将违反 inf-sup 条件，因为 infimum 会趋近于零。其结果是数值不稳定以及计算出的接触压力出现伪振荡。\n\n2.  **选择 2：较疏的网格（$h_M$）作为主面，较密的网格（$h_S$）作为从面。**\n    此时，拉格朗日乘子空间 $M^h$ 定义在疏网格上。这是一个“贫乏”的空间，仅能表示光滑、缓变的压力场。位移检验函数在从面上求值，而从面是密网格。这提供了一个“丰富”的位移迹空间。\n    对于来自疏主空间的任何拉格朗日乘子 $\\lambda_h$，总能在密从面上的丰富空间中找到一个位移模态 $\\delta u_h$ 与之有效耦合（即，使积分 $c(\\delta u_h, \\lambda_h)$ 非零且足够大）。从面位移空间的丰富性相对于主面乘子空间的贫乏性，确保了 LBB 条件更容易得到满足。这会得到一个稳定的接触压力解。得到的压力场 $\\lambda_h$ 自然是光滑的，因为它是定义在疏网格上的空间中的一个元素。虽然它无法捕捉尺度小于 $h_M$ 的压力变化，但它提供了一个稳定且变分一致的近似，这是在所选的易于不稳定的空间 $M^h$ 内最好的表示。这种效应有时被描述为对真实压力的“抹平”或平均，但它没有非物理噪声。\n\n因此，为确保数值稳定性，推荐的做法是选择较疏的网格作为主面，较密的网格作为从面。\n\n现在，我们基于此推导评估给定的选项。\n\nA. 选择较密的网格作为主面（Mortar 侧）总能提高接触压力的精度，因为此时拉格朗日乘子场 $\\lambda$ 具有更高的分辨率；这种选择是无条件稳定的，无论 $h_M$ 和 $h_S$如何，都应推荐使用。\n这个陈述根本上是错误的。虽然 LM 场定义在较密的网格上理论上允许更高的分辨率，但这种选择恰恰是导致 LBB 条件失效和数值不稳定的原因。声称其“无条件稳定”是错误的。这种选择是众所周知的会导致伪压力振荡。\n**结论：不正确。**\n\nB. 选择较密的网格作为从面（非 Mortar 侧），较疏的网格作为主面（Mortar 侧），通常能更好地满足离散 inf-sup 条件，从而避免接触压力出现伪振荡；此时压力场在较疏的一侧表示，可能会被略微抹平，但在变分意义上是一致的。当 $h_S \\ll h_M$ 时，推荐使用此分配方式。\n这个陈述准确地反映了理论分析。它正确地指出了稳定的主从面分配方式（疏为主，密为从）。它给出了正确的理由：更好地满足离散 inf-sup (LBB) 条件并避免伪振荡。它正确地描述了最终的压力场是在较疏的网格上表示的（可能被“抹平”，意味着它是一个平滑的近似）并且是“变分一致的”。这是该领域的标准、正确的推理。\n**结论：正确。**\n\nC. 在 Mortar 方法中，主从面的分配是无关紧要的；只要积分格式一致，两种选择下的接触压力精度基本相同，因此无需特别推荐。\n这个陈述是错误的。根据 LBB 条件的规定，主从面的分配对于经典拉格朗日乘子格式的稳定性至关重要。一致的积分格式确保了正确的积分计算，但无法修复离散函数空间的不适定选择。两种选择的精度远非相同；一种选择是稳定的，另一种则是不稳定的。\n**结论：不正确。**\n\nD. 将较密的网格设置为主面（Mortar 侧），并通过在界面上施加一个足够大的罚参数来补偿任何不匹配，可以获得最佳精度；这既保证了稳定性，又提高了压力分辨率，是推荐的做法。\n这个陈述引入了一个问题指导原则中未指定的概念：罚函数稳定化。该问题要求基于经典 Mortar 方法（纯拉格朗日乘子）及其 LBB 条件进行分析。添加罚函数项从根本上将格式改变为增广拉格朗日方法或稳定化方法。虽然这类方法可以稳定原本不稳定的选择（较密的网格作为主面），但该选项并非对经典格式的分析。此外，声称它“保证”了稳定性和改进的分辨率，这种说法过于绝对。过大的罚参数可能引入其他数值问题，如病态。这不是在指定框架内的答案。\n**结论：不正确。**", "answer": "$$\\boxed{B}$$", "id": "2581181"}, {"introduction": "将连续介质力学的控制方程转化为可求解的代数系统，是有限元方法的核心步骤。对于非线性的接触问题，这通常涉及到牛顿法求解，需要计算系统的残差向量和切向刚度矩阵。本练习 [@problem_id:2581208] 聚焦于一个简化的接触场景，要求您从虚功原理出发，为砂浆接触模型推导其对全局系统的局部贡献。通过完成这个推导，您将深刻理解接触约束是如何通过其能量势的梯度（残差）和Hessian矩阵（切向刚度）体现在代数方程组中的。", "problem": "考虑一个二维空间中单个从节点与单个双节点主线单元之间的小变形、无摩擦、法向接触相互作用。假设只有法向位移分量对接触起作用，并将它们收集在有序的未知量向量 $\\{u\\} = \\big(u_{s}^{n},\\,u_{A}^{n},\\,u_{B}^{n}\\big)^{\\mathsf{T}}$ 中，其中 $u_{s}^{n}$ 是从节点的法向位移，$u_{A}^{n}$ 和 $u_{B}^{n}$ 是主节点的法向位移。主线单元使用标准等参形函数 $N_{A}(\\xi) = \\frac{1-\\xi}{2}$ 和 $N_{B}(\\xi) = \\frac{1+\\xi}{2}$，其参数坐标为 $\\xi \\in [-1,1]$。主线单元上的（已知）接触点位于 $\\xi=\\xi_{c} \\in [-1,1]$。\n\n对法向接触使用砂浆罚函数法，罚参数为 $k_{n}>0$。假设在从节点处采用单点砂浆积分，其权重为 $w>0$，且该点的对偶形函数值为单位值，因此从节点侧的检验函数在该积分点的值为1。将有符号法向间隙定义为\n$$\ng(u) \\equiv u_{s}^{n} - N_{A}(\\xi_{c})\\,u_{A}^{n} - N_{B}(\\xi_{c})\\,u_{B}^{n} + g_{0},\n$$\n其中 $g_{0}$ 是法向的初始几何间隙（可能非零但已知）。假设在当前迭代步接触是激活的，因此罚贡献在 $g(u)$ 的邻域内是光滑的。\n\n从罚接触贡献的虚功原理出发，推导对应于 $\\{u\\}$ 的全局系统中的局部砂浆残差向量贡献 $\\{r_{c}\\}$ 和一致切向矩阵贡献 $[K_{c}]$，并用 $w$、$k_{n}$ 以及在 $\\xi_{c}$ 处求值的主形函数来表示。然后，利用你得到的表达式，确定切向矩阵中耦合主节点 A 和 B 法向的单个标量项，即 $[K_{c}]$ 的 $(A,B)$ 分量，将其表示为关于 $w$、$k_{n}$ 和 $\\xi_{c}$ 的闭式符号表达式。\n\n你的最终答案必须是该标量项的单个解析表达式。最终方框内的答案不要包含单位。", "solution": "所述问题具有科学依据，提法恰当，并包含了进行严格推导所需的所有信息。它代表了计算接触力学领域的一个标准练习。因此，我将开始进行求解。\n\n推导的起点是来自罚接触项的势能贡献，记为 $\\Pi_c$。对于问题中假设的激活接触状态，势能是法向间隙 $g$ 平方的函数。\n$$ \\Pi_c = \\frac{1}{2} k_{n} \\int_{\\Gamma_c} g^{2} \\, d\\Gamma $$\n这里，$k_{n} > 0$ 是罚参数，$\\Gamma_c$ 代表接触界面。问题指定了采用砂浆法，并在从节点处使用单点积分法则，其关联权重为 $w > 0$，对偶形函数为单位值。这种离散化将积分简化为一个代数表达式：\n$$ \\Pi_c \\approx \\frac{1}{2} w k_{n} g^{2} $$\n有符号法向间隙 $g$ 定义为节点法向位移 $\\{u\\} = (u_{s}^{n}, u_{A}^{n}, u_{B}^{n})^{\\mathsf{T}}$ 的函数：\n$$ g(\\{u\\}) \\equiv u_{s}^{n} - N_{A}(\\xi_{c}) u_{A}^{n} - N_{B}(\\xi_{c}) u_{B}^{n} + g_{0} $$\n其中 $N_{A}(\\xi_{c})$ 和 $N_{B}(\\xi_{c})$ 是在接触点 $\\xi_c$ 处求值的主单元形函数，$g_0$ 是已知的初始间隙。该关系可以表示为矩阵形式：\n$$ g = \\{c\\}^{\\mathsf{T}}\\{u\\} + g_{0} $$\n其中常向量 $\\{c\\}$ 定义为：\n$$ \\{c\\}^{\\mathsf{T}} = \\begin{pmatrix} 1 & -N_{A}(\\xi_{c}) & -N_{B}(\\xi_{c}) \\end{pmatrix} $$\n\n对残差向量的贡献 $\\{r_c\\}$ 由虚功原理推导得出，这等同于求势能相对于位移向量 $\\{u\\}$ 的负梯度。\n$$ \\{r_c\\} = -\\frac{\\partial\\Pi_c}{\\partial\\{u\\}} = -\\frac{\\partial}{\\partial\\{u\\}} \\left( \\frac{1}{2} w k_{n} g^{2} \\right) $$\n应用链式法则，我们得到：\n$$ \\{r_c\\} = -w k_{n} g \\frac{\\partial g}{\\partial\\{u\\}} $$\n间隙函数 $g$ 相对于 $\\{u\\}$ 的梯度就是常向量 $\\{c\\}$：\n$$ \\frac{\\partial g}{\\partial\\{u\\}} = \\{c\\} $$\n因此，残差向量的贡献是：\n$$ \\{r_c\\} = -w k_{n} g \\{c\\} = -w k_{n} \\left( \\{c\\}^{\\mathsf{T}}\\{u\\} + g_{0} \\right) \\{c\\} $$\n\n接下来，一致切向矩阵贡献 $[K_c]$ 通过求残差向量贡献 $\\{r_c\\}$ 相对于位移向量 $\\{u\\}$ 的负偏导数得到。\n$$ [K_c] = -\\frac{\\partial\\{r_c\\}}{\\partial\\{u\\}} = -\\frac{\\partial}{\\partial\\{u\\}} \\left( -w k_{n} g \\{c\\} \\right) = w k_{n} \\frac{\\partial}{\\partial\\{u\\}} \\left( g \\{c\\} \\right) $$\n使用微分的乘法法则：\n$$ [K_c] = w k_{n} \\left( \\frac{\\partial g}{\\partial\\{u\\}} \\{c\\}^{\\mathsf{T}} + g \\frac{\\partial\\{c\\}}{\\partial\\{u\\}} \\right) $$\n标量间隙 $g$ 相对于向量 $\\{u\\}$ 的梯度是向量 $\\{c\\}$，而向量 $\\{c\\}$ 本身不依赖于 $\\{u\\}$，所以其梯度为零。\n$$ \\frac{\\partial g}{\\partial\\{u\\}} = \\{c\\}, \\quad \\frac{\\partial\\{c\\}}{\\partial\\{u\\}} = [0] $$\n代入这些结果，得到切向矩阵的表达式：\n$$ [K_c] = w k_{n} (\\{c\\}\\{c\\}^{\\mathsf{T}} + g[0]) = w k_{n} \\{c\\}\\{c\\}^{\\mathsf{T}} $$\n将此外积显式写出：\n$$ [K_c] = w k_{n} \\begin{pmatrix} 1 \\\\ -N_{A}(\\xi_{c}) \\\\ -N_{B}(\\xi_{c}) \\end{pmatrix} \\begin{pmatrix} 1 & -N_{A}(\\xi_{c}) & -N_{B}(\\xi_{c}) \\end{pmatrix} $$\n$$ [K_c] = w k_{n} \\begin{pmatrix} 1 & -N_A(\\xi_c) & -N_B(\\xi_c) \\\\ -N_A(\\xi_c) & N_A(\\xi_c)^2 & N_A(\\xi_c)N_B(\\xi_c) \\\\ -N_B(\\xi_c) & N_A(\\xi_c)N_B(\\xi_c) & N_B(\\xi_c)^2 \\end{pmatrix} $$\n这个 $3 \\times 3$ 矩阵的行和列对应于有序自由度 $(u_{s}^{n}, u_{A}^{n}, u_{B}^{n})$。问题要求的是耦合主节点 A 和 B 的单个标量项，即分量 $[K_c]_{AB}$。这对应于上面推导出的矩阵的第二行第三列的元素。\n$$ [K_c]_{AB} = w k_{n} N_{A}(\\xi_{c}) N_{B}(\\xi_{c}) $$\n现在我们代入给定的等参形函数表达式：\n$$ N_{A}(\\xi_c) = \\frac{1-\\xi_c}{2} $$\n$$ N_{B}(\\xi_c) = \\frac{1+\\xi_c}{2} $$\n这给出了所求分量的最终表达式：\n$$ [K_c]_{AB} = w k_{n} \\left( \\frac{1-\\xi_c}{2} \\right) \\left( \\frac{1+\\xi_c}{2} \\right) = w k_{n} \\frac{1 - \\xi_c^2}{4} $$\n该表达式表示了由单个从节点的接触罚约束产生的两个主节点法向位移之间的耦合剛度。", "answer": "$$\n\\boxed{w k_{n} \\frac{1 - \\xi_{c}^{2}}{4}}\n$$", "id": "2581208"}]}