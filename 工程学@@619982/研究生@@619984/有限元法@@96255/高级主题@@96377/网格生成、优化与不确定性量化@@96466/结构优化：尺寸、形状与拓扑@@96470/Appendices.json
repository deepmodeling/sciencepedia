{"hands_on_practices": [{"introduction": "掌握梯度计算是所有基于梯度的优化算法的核心。本练习将引导你使用伴随法（adjoint method）来计算一个热顺应性问题对于单元密度的灵敏度。通过这个实践，你将亲身体验在拓扑优化中计算设计更新方向的关键步骤，并加深对伴随法强大效率的理解 [@problem_id:2604234]。", "problem": "一个一维稳态热传导问题设置在一根长度为 $L$、横截面积均匀为 $A$ 的杆上，使用两个线性单元（节点 $1$–$3$）通过有限元法（FEM）进行离散化。单元 $e$ 中的热导率通过固体各向同性材料惩罚模型（SIMP）进行插值，\n$$\nk(\\rho_e) \\;=\\; k_{\\min} \\;+\\; \\rho_e^{\\,p}\\,\\big(k_0 - k_{\\min}\\big),\n$$\n其中 $\\rho_e \\in [0,1]$ 是单元密度，$k_0$ 是固体材料的热导率，$k_{\\min}$ 是分配给类空隙材料的微小热导率，$p$ 是惩罚指数。控制方程的强形式为 $-\\frac{d}{dx}\\!\\left(k(\\rho)\\,\\frac{dT}{dx}\\right)=0$，边界条件为左端 $T(0)=0$ 和右端指定的向外法向热通量 $\\bar{q}$。伽辽金弱形式为\n$$\n\\int_{0}^{L} k(\\rho)\\,\\frac{dT}{dx}\\,\\frac{dv}{dx}\\,dx \\;=\\; \\int_{\\Gamma_N} \\bar{q}\\,v\\,d\\Gamma,\n$$\n离散化后得到全局系统\n$$\n\\mathbf{K}(\\boldsymbol{\\rho})\\,\\mathbf{T}\\;=\\;\\mathbf{Q},\n$$\n其中 $\\mathbf{K}$ 是自由度的对称正定热导矩阵，$\\mathbf{T}$ 是节点温度向量，$\\mathbf{Q}$ 是节点热载荷向量。\n\n考虑具体数据：\n- $L = 2$, $A=1$,\n- $k_0 = 2$, $k_{\\min}=0.2$, $p=3$,\n- 单元密度 $\\rho_1=0.5$，$\\rho_2=1$,\n- 边界条件为左端 $T(0)=0$ 以及右端施加的均匀向外热通量 $\\bar{q}=1$，因此最右侧节点的等效节点载荷为 $Q_3 = \\bar{q}\\,A = 1$，而其他节点载荷为零。\n\n令热柔度定义为\n$$\n\\mathcal{C}(\\mathbf{T},\\boldsymbol{\\rho}) \\;=\\; \\mathbf{Q}^{\\mathsf{T}}\\,\\mathbf{T},\n$$\n其中 $\\mathbf{Q}$ 与 $\\boldsymbol{\\rho}$ 无关。使用热伴随法，在给定的设计点计算灵敏度 $\\frac{d\\mathcal{C}}{d\\rho_1}$。您必须从第一性原理出发，明确地构建伴随问题，然后评估得到的灵敏度表达式。以 $\\mathrm{W\\cdot K}$ 为单位表示最终灵敏度，并将答案四舍五入到四位有效数字。", "solution": "该问题是适定的，有科学依据，并为获得唯一解提供了所有必要的信息。我们接下来将进行分析。\n\n该问题要求使用伴随法计算热柔度相对于单元设计变量的灵敏度 $\\frac{d\\mathcal{C}}{d\\rho_1}$。求解的结构如下：首先，我们建立系统的有限元模型；其次，我们求解原始热传导问题以找出节点温度；第三，我们构建并求解伴随问题；最后，我们计算所需的灵敏度。\n\n**1. 有限元离散化**\n\n计算域为一根长度 $L=2$ 的杆，被离散为两个等长的线性有限元。\n- 单元 1 连接节点 1 ($x=0$) 和节点 2 ($x=1$)。其长度为 $l_1=1$，密度为 $\\rho_1=0.5$。\n- 单元 2 连接节点 2 ($x=1$) 和节点 3 ($x=2$)。其长度为 $l_2=1$，密度为 $\\rho_2=1.0$。\n\n单元热导率 $k_e$ 由固体各向同性材料惩罚模型（SIMP）给出：\n$$k(\\rho_e) = k_{\\min} + \\rho_e^p (k_0 - k_{\\min})$$\n使用所提供的数据 $k_0 = 2$，$k_{\\min} = 0.2$ 和 $p = 3$：\n对于单元 1 ($\\rho_1=0.5$)：\n$$k_1 = 0.2 + (0.5)^3 (2 - 0.2) = 0.2 + 0.125 \\times 1.8 = 0.2 + 0.225 = 0.425$$\n对于单元 2 ($\\rho_2=1.0$)：\n$$k_2 = 0.2 + (1.0)^3 (2 - 0.2) = 0.2 + 1.8 = 2.0$$\n\n一维线性单元的热导矩阵由下式给出：\n$$\\mathbf{k}^e = \\frac{k_e A_e}{l_e} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$$\n给定 $A=1$ 和 $l_1=l_2=1$，单元矩阵为：\n$$\\mathbf{k}^1 = k_1 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = 0.425 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$$\n$$\\mathbf{k}^2 = k_2 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = 2.0 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$$\n\n将这些矩阵组装成一个针对节点 1、2 和 3 的全局 $3 \\times 3$ 热导矩阵：\n$$\\mathbf{K}_{global} = \\begin{pmatrix} k_1 & -k_1 & 0 \\\\ -k_1 & k_1+k_2 & -k_2 \\\\ 0 & -k_2 & k_2 \\end{pmatrix} = \\begin{pmatrix} 0.425 & -0.425 & 0 \\\\ -0.425 & 2.425 & -2.0 \\\\ 0 & -2.0 & 2.0 \\end{pmatrix}$$\n\n边界条件 $T(0)=0$ 意味着 $T_1=0$。我们对系统的自由度进行划分，即节点 2 和节点 3 的温度 $T_2$ 和 $T_3$。简化的热导矩阵 $\\mathbf{K}$ 和温度向量 $\\mathbf{T}$ 为：\n$$\\mathbf{K} = \\begin{pmatrix} k_1+k_2 & -k_2 \\\\ -k_2 & k_2 \\end{pmatrix} = \\begin{pmatrix} 2.425 & -2.0 \\\\ -2.0 & 2.0 \\end{pmatrix}$$\n$$\\mathbf{T} = \\begin{pmatrix} T_2 \\\\ T_3 \\end{pmatrix}$$\n外部热载荷是在右端 ($x=L=2$) 的向外热通量 $\\bar{q}=1$，对应于节点 3。等效节点载荷为 $Q_3 = \\bar{q} A = 1 \\times 1 = 1$。节点 2 没有热源，因此 $Q_2=0$。自由度的载荷向量为：\n$$\\mathbf{Q} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$$\n\n**2. 原始分析：状态方程的求解**\n\n用于求解未知温度的控制方程组为 $\\mathbf{K}\\mathbf{T} = \\mathbf{Q}$：\n$$\\begin{pmatrix} 2.425 & -2.0 \\\\ -2.0 & 2.0 \\end{pmatrix} \\begin{pmatrix} T_2 \\\\ T_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$$\n由第二个方程得：\n$$-2.0 T_2 + 2.0 T_3 = 1 \\implies T_3 = T_2 + 0.5$$\n将此代入第一个方程：\n$$2.425 T_2 - 2.0 (T_2 + 0.5) = 0 \\implies 2.425 T_2 - 2.0 T_2 - 1.0 = 0$$\n$$0.425 T_2 = 1.0 \\implies T_2 = \\frac{1}{0.425} = \\frac{1}{17/40} = \\frac{40}{17}$$\n现在我们求 $T_3$：\n$$T_3 = \\frac{40}{17} + 0.5 = \\frac{40}{17} + \\frac{1}{2} = \\frac{80+17}{34} = \\frac{97}{34}$$\n温度向量为 $\\mathbf{T} = \\begin{pmatrix} 40/17 \\\\ 97/34 \\end{pmatrix}$。\n\n**3. 伴随灵敏度分析**\n\n目标函数为热柔度 $\\mathcal{C} = \\mathbf{Q}^{\\mathsf{T}}\\mathbf{T}$。我们求取其关于设计变量 $\\rho_1$ 的导数。根据从第一性原理推导伴随问题的要求，我们使用拉格朗日乘子向量 $\\boldsymbol{\\lambda}$（伴随变量）来引入状态方程 $\\mathbf{K}\\mathbf{T} = \\mathbf{Q}$ 的约束，定义一个增广目标泛函 $\\hat{\\mathcal{C}}$：\n$$\\hat{\\mathcal{C}}(\\mathbf{T}, \\boldsymbol{\\rho}, \\boldsymbol{\\lambda}) = \\mathcal{C}(\\mathbf{T}) + \\boldsymbol{\\lambda}^{\\mathsf{T}} (\\mathbf{Q} - \\mathbf{K}(\\boldsymbol{\\rho})\\mathbf{T})$$\n由于约束项为零，$\\mathcal{C}$ 对 $\\rho_1$ 的全导数等于 $\\hat{\\mathcal{C}}$ 对 $\\rho_1$ 的全导数。\n$$\\frac{d\\mathcal{C}}{d\\rho_1} = \\frac{d\\hat{\\mathcal{C}}}{d\\rho_1} = \\frac{\\partial\\hat{\\mathcal{C}}}{\\partial\\rho_1} + \\frac{\\partial\\hat{\\mathcal{C}}}{\\partial\\mathbf{T}} \\frac{d\\mathbf{T}}{d\\rho_1}$$\n我们选择 $\\boldsymbol{\\lambda}$，使得包含状态变量未知灵敏度 $\\frac{d\\mathbf{T}}{d\\rho_1}$ 的项消失。我们将其系数设为零：\n$$\\frac{\\partial\\hat{\\mathcal{C}}}{\\partial\\mathbf{T}} = \\frac{\\partial}{\\partial\\mathbf{T}} (\\mathbf{Q}^{\\mathsf{T}}\\mathbf{T} + \\boldsymbol{\\lambda}^{\\mathsf{T}}\\mathbf{Q} - \\boldsymbol{\\lambda}^{\\mathsf{T}}\\mathbf{K}\\mathbf{T}) = \\mathbf{Q}^{\\mathsf{T}} - \\boldsymbol{\\lambda}^{\\mathsf{T}}\\mathbf{K} = \\mathbf{0}$$\n这得到了伴随方程：\n$$\\mathbf{K}^{\\mathsf{T}}\\boldsymbol{\\lambda} = \\mathbf{Q}$$\n由于热导矩阵 $\\mathbf{K}$ 是对称的（$\\mathbf{K}^{\\mathsf{T}}=\\mathbf{K}$），伴随方程为 $\\mathbf{K}\\boldsymbol{\\lambda} = \\mathbf{Q}$。该方程在形式上与原始状态方程 $\\mathbf{K}\\mathbf{T} = \\mathbf{Q}$ 相同。因此，该问题是自伴随的，伴随问题的解与原始问题的解相同：\n$$\\boldsymbol{\\lambda} = \\mathbf{T} = \\begin{pmatrix} 40/17 \\\\ 97/34 \\end{pmatrix}$$\n通过这样选择 $\\boldsymbol{\\lambda}$，灵敏度的计算简化为 $\\hat{\\mathcal{C}}$ 对 $\\rho_1$ 的偏导数：\n$$\\frac{d\\mathcal{C}}{d\\rho_1} = \\frac{\\partial\\hat{\\mathcal{C}}}{\\partial\\rho_1} = \\frac{\\partial}{\\partial\\rho_1} (\\mathbf{Q}^{\\mathsf{T}}\\mathbf{T} + \\boldsymbol{\\lambda}^{\\mathsf{T}}\\mathbf{Q} - \\boldsymbol{\\lambda}^{\\mathsf{T}}\\mathbf{K}\\mathbf{T}) = -\\boldsymbol{\\lambda}^{\\mathsf{T}} \\frac{\\partial\\mathbf{K}}{\\partial\\rho_1} \\mathbf{T}$$\n\n**4. 灵敏度计算**\n\n我们必须求出热导矩阵 $\\mathbf{K}$ 关于 $\\rho_1$ 的导数：\n$$\\frac{\\partial\\mathbf{K}}{\\partial\\rho_1} = \\frac{\\partial}{\\partial\\rho_1} \\begin{pmatrix} k_1+k_2 & -k_2 \\\\ -k_2 & k_2 \\end{pmatrix}$$\n只有 $k_1$ 是 $\\rho_1$ 的函数。因此：\n$$\\frac{\\partial\\mathbf{K}}{\\partial\\rho_1} = \\begin{pmatrix} \\frac{dk_1}{d\\rho_1} & 0 \\\\ 0 & 0 \\end{pmatrix}$$\n导数 $\\frac{dk_1}{d\\rho_1}$ 由 SIMP 法则得到：\n$$\\frac{dk_1}{d\\rho_1} = \\frac{d}{d\\rho_1} \\left(k_{\\min} + \\rho_1^p(k_0 - k_{\\min})\\right) = p \\rho_1^{p-1} (k_0 - k_{\\min})$$\n代入给定值 $p=3$，$\\rho_1=0.5$，$k_0=2$ 和 $k_{\\min}=0.2$：\n$$\\frac{dk_1}{d\\rho_1} = 3 \\times (0.5)^{3-1} \\times (2 - 0.2) = 3 \\times (0.5)^2 \\times 1.8 = 3 \\times 0.25 \\times 1.8 = 0.75 \\times 1.8 = 1.35$$\n所以，热导矩阵的导数为：\n$$\\frac{\\partial\\mathbf{K}}{\\partial\\rho_1} = \\begin{pmatrix} 1.35 & 0 \\\\ 0 & 0 \\end{pmatrix}$$\n现在我们将所有部分代入灵敏度表达式。由于 $\\boldsymbol{\\lambda} = \\mathbf{T}$：\n$$\\frac{d\\mathcal{C}}{d\\rho_1} = -\\mathbf{T}^{\\mathsf{T}} \\frac{\\partial\\mathbf{K}}{\\partial\\rho_1} \\mathbf{T} = - \\begin{pmatrix} T_2 & T_3 \\end{pmatrix} \\begin{pmatrix} 1.35 & 0 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} T_2 \\\\ T_3 \\end{pmatrix}$$\n$$\\frac{d\\mathcal{C}}{d\\rho_1} = -1.35 \\times T_2^2$$\n代入 $T_2 = \\frac{40}{17}$ 的值：\n$$\\frac{d\\mathcal{C}}{d\\rho_1} = -1.35 \\times \\left(\\frac{40}{17}\\right)^2 = -1.35 \\times \\frac{1600}{289} \\approx -7.47404844...$$\n问题要求将结果四舍五入到四位有效数字。\n$$\\frac{d\\mathcal{C}}{d\\rho_1} \\approx -7.474$$\n柔度 $\\mathcal{C}$ 的单位是热载荷（功率，W）乘以温度（K），即 W·K。设计变量 $\\rho_1$ 是无量纲的。因此，灵敏度 $\\frac{d\\mathcal{C}}{d\\rho_1}$ 的单位是 W·K，符合要求。", "answer": "$$\\boxed{-7.474}$$", "id": "2604234"}, {"introduction": "除了拓扑和尺寸优化，形状优化是结构优化的另一个重要分支，其目标是寻找最佳的结构边界。本练习将带你进入连续介质力学的世界，利用形状微积分（shape calculus）的基本原理，推导并计算一个经典弹性力学问题中的形状灵敏度。这个分析练习将展示如何将抽象的数学工具应用于评估几何微小变化对结构性能的影响 [@problem_id:2604201]。", "problem": "考虑一个单位厚度的二维、各向同性、线性弹性板，其内部含有一个半径为 $a$ 的无牵引力圆孔。该板为无限大，并在无穷远处受到沿 $x$ 轴方向的均匀单轴拉应力 $\\sigma_0$ 的作用。假设为平面应力状态，杨氏模量为 $E$，泊松比为 $\\nu$，且无体力。令 $\\Omega$ 表示弹性（材料）域，$\\Gamma_h$ 表示孔洞边界。柔度泛函 $J(\\Omega)$ 定义为载荷功，根据 Clapeyron 定理，在线性弹性中其值等于总应变能的两倍。\n\n要求计算由一个速度场 $\\mathbf{V}$ 在 $\\Gamma_h$ 上引起的局部光滑法向边界扰动所导致的柔度 $J(\\Omega)$ 的一阶变分（形状导数）。该速度场的法向分量为\n$$\n\\mathbf{V}\\cdot \\mathbf{n} \\;=\\; \\varepsilon \\cos(2\\theta)\\,,\n$$\n其中 $\\theta$ 是从 $x$ 轴测量的极角（以弧度为单位），$\\varepsilon$ 是一个量纲为长度的微小常数振幅，$\\mathbf{n}$ 是材料域的外单位法向量（在 $\\Gamma_h$ 上指向孔洞内部）。在所有其他边界上，扰动为零，且无穷远处的远场载荷在空间上保持固定。\n\n仅从线性弹性形状微积分的基本原理（包括柔度的定义、Clapeyron 定理、域变分的输运定理以及域泛函一阶变分的结构）出发，推导形状导数 $dJ[\\mathbf{V}]$ 的边界积分表达式，并利用圆孔周围的精确应力场（Kirsch 解）以及平面应力本构律对其进行求值。用 $a$、$\\sigma_0$、$E$ 和 $\\varepsilon$ 的符号形式表示最终结果。报告每单位厚度 $dJ[\\mathbf{V}]$ 的最终值，单位为牛顿-米。最终的方框表达式中不要包含单位。角度必须以弧度处理。答案必须是单一的闭合形式解析表达式。", "solution": "所述问题具有科学依据、是适定且客观的。这是连续介质力学中形状优化领域的标准问题。所有必要的数据和条件均已提供，且不存在矛盾。该问题适用于进行完整的解析求解。\n\n目标是计算柔度泛函 $J(\\Omega)$ 对于在圆孔边界 $\\Gamma_h$ 上的指定法向速度场 $\\mathbf{V}$ 的一阶变分（或称形状导数）$dJ[\\mathbf{V}]$。\n\n柔度 $J(\\Omega)$ 定义为外加载荷所做的功。对于线性弹性体，根据 Clapeyron 定理，其值等于总弹性应变能 $U$ 的两倍。总应变能是应变能密度 $W(\\boldsymbol{\\varepsilon}) = \\frac{1}{2}\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}$ 在材料域 $\\Omega$ 上的积分。\n$$\nJ(\\Omega) = 2U = 2 \\int_{\\Omega} W(\\boldsymbol{\\varepsilon}) \\, dV = \\int_{\\Omega} \\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon} \\, dV\n$$\n此处，$\\boldsymbol{\\sigma}$ 是应力张量，$\\boldsymbol{\\varepsilon}$ 是应变张量。\n\n对于一个仅在无牵引力边界 $\\Gamma_h$ 上非零的速度场 $\\mathbf{V}$ 所定义的扰动，柔度泛函的形状导数由经典的边界积分公式给出：\n$$\ndJ[\\mathbf{V}] = \\int_{\\Gamma_h} (\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}) (\\mathbf{V} \\cdot \\mathbf{n}) \\, dS\n$$\n其中 $\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon}$ 是在边界 $\\Gamma_h$ 上求值的应变能密度，$\\mathbf{V}\\cdot\\mathbf{n}$ 是速度场的法向分量。单位法向量 $\\mathbf{n}$ 从材料域向外指出，即指向孔洞内部。\n\n问题给出了孔洞边界 $\\Gamma_h$ 上的法向速度为 $\\mathbf{V}\\cdot\\mathbf{n} = \\varepsilon \\cos(2\\theta)$。边界 $\\Gamma_h$ 是一个半径为 $a$ 的圆。对于单位厚度，弧长微分元为 $dS = a\\,d\\theta$。因此，形状导数为：\n$$\ndJ[\\mathbf{V}] = \\int_{0}^{2\\pi} (\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon})|_{r=a} \\, (\\varepsilon \\cos(2\\theta)) \\, (a \\, d\\theta)\n$$\n\n为计算此积分，我们需要孔洞边界上的应力场和应变场。我们使用 Kirsch 解，该解描述了在沿 $x$ 轴的单轴远场拉力 $\\sigma_0$ 作用下，无限大板中圆孔周围的应力场。在极坐标 $(r, \\theta)$ 中，孔洞边界 ($r=a$) 上的应力分量为：\n$$\n\\sigma_{rr}|_{r=a} = 0\n$$\n$$\n\\sigma_{\\theta\\theta}|_{r=a} = \\sigma_0(1 - 2\\cos(2\\theta))\n$$\n$$\n\\sigma_{r\\theta}|_{r=a} = 0\n$$\n$\\sigma_{rr}$ 和 $\\sigma_{r\\theta}$ 为零证实了孔洞上的无牵引力边界条件。\n\n边界上的应变能密度为 $\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon} = \\sigma_{rr}\\varepsilon_{rr} + \\sigma_{\\theta\\theta}\\varepsilon_{\\theta\\theta} + 2\\sigma_{r\\theta}\\varepsilon_{r\\theta}$。考虑边界应力后，该式简化为：\n$$\n(\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon})|_{r=a} = \\sigma_{\\theta\\theta}|_{r=a} \\, \\varepsilon_{\\theta\\theta}|_{r=a}\n$$\n应变分量 $\\varepsilon_{\\theta\\theta}$ 通过平面应力的本构律与应力分量相关：\n$$\n\\varepsilon_{\\theta\\theta} = \\frac{1}{E}(\\sigma_{\\theta\\theta} - \\nu \\sigma_{rr})\n$$\n其中 $E$ 是杨氏模量，$\\nu$ 是泊松比。\n在边界 $r=a$ 处（其中 $\\sigma_{rr}=0$）对此进行求值：\n$$\n\\varepsilon_{\\theta\\theta}|_{r=a} = \\frac{1}{E}\\sigma_{\\theta\\theta}|_{r=a}\n$$\n因此，边界上的应变能密度可以完全用环向应力 $\\sigma_{\\theta\\theta}$ 来表示：\n$$\n(\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon})|_{r=a} = \\sigma_{\\theta\\theta}|_{r=a} \\left(\\frac{\\sigma_{\\theta\\theta}|_{r=a}}{E}\\right) = \\frac{(\\sigma_{\\theta\\theta}|_{r=a})^2}{E}\n$$\n代入环向应力的 Kirsch 解：\n$$\n(\\boldsymbol{\\sigma}:\\boldsymbol{\\varepsilon})|_{r=a} = \\frac{[\\sigma_0(1 - 2\\cos(2\\theta))]^2}{E} = \\frac{\\sigma_0^2}{E}(1 - 4\\cos(2\\theta) + 4\\cos^2(2\\theta))\n$$\n现在我们将此表达式代入 $dJ[\\mathbf{V}]$ 的积分中：\n$$\ndJ[\\mathbf{V}] = \\int_{0}^{2\\pi} \\left[ \\frac{\\sigma_0^2}{E}(1 - 4\\cos(2\\theta) + 4\\cos^2(2\\theta)) \\right] (\\varepsilon \\cos(2\\theta)) (a \\, d\\theta)\n$$\n我们将常数项移到积分符号外：\n$$\ndJ[\\mathbf{V}] = \\frac{a \\varepsilon \\sigma_0^2}{E} \\int_{0}^{2\\pi} (1 - 4\\cos(2\\theta) + 4\\cos^2(2\\theta)) \\cos(2\\theta) \\, d\\theta\n$$\n让我们展开被积函数：\n$$\n(1 - 4\\cos(2\\theta) + 4\\cos^2(2\\theta)) \\cos(2\\theta) = \\cos(2\\theta) - 4\\cos^2(2\\theta) + 4\\cos^3(2\\theta)\n$$\n该积分逐项计算：\n$$\n\\int_{0}^{2\\pi} (\\cos(2\\theta) - 4\\cos^2(2\\theta) + 4\\cos^3(2\\theta)) \\, d\\theta\n$$\n我们使用以下标准定积分：\n1.  $\\int_{0}^{2\\pi} \\cos(n\\theta) \\, d\\theta = 0$ 对于任何整数 $n \\neq 0$。\n2.  $\\int_{0}^{2\\pi} \\cos^2(n\\theta) \\, d\\theta = \\int_{0}^{2\\pi} \\frac{1+\\cos(2n\\theta)}{2} \\, d\\theta = \\pi$。\n3.  $\\int_{0}^{2\\pi} \\cos^3(n\\theta) \\, d\\theta = \\int_{0}^{2\\pi} \\frac{\\cos(3n\\theta) + 3\\cos(n\\theta)}{4} \\, d\\theta = 0$。\n\n应用这些结果：\n$$\n\\int_{0}^{2\\pi} \\cos(2\\theta) \\, d\\theta = 0\n$$\n$$\n-4 \\int_{0}^{2\\pi} \\cos^2(2\\theta) \\, d\\theta = -4\\pi\n$$\n$$\n4 \\int_{0}^{2\\pi} \\cos^3(2\\theta) \\, d\\theta = 0\n$$\n将这些贡献相加，积分的总值为 $0 - 4\\pi + 0 = -4\\pi$。\n\n最后，我们将此结果代回 $dJ[\\mathbf{V}]$ 的表达式中：\n$$\ndJ[\\mathbf{V}] = \\frac{a \\varepsilon \\sigma_0^2}{E} (-4\\pi)\n$$\n这就得到了每单位厚度柔度一阶变分的最终符号表达式。", "answer": "$$\n\\boxed{- \\frac{4\\pi a \\varepsilon \\sigma_0^2}{E}}\n$$", "id": "2604201"}, {"introduction": "计算出灵敏度之后，更重要的是理解其物理意义以及如何利用它来指导设计决策。本练习将引导你从第一性原理出发，探讨拓扑导数（topological derivative）的符号和大小与局部应变能密度 $W(\\mathbf{x})$ 之间的关系。通过这个概念性问题，你将揭示拓扑优化中“从低应力区域移除材料”这一核心策略背后的深刻物理直觉 [@problem_id:2604256]。", "problem": "考虑一个线性弹性体，其占据一个有界域 $\\Omega \\subset \\mathbb{R}^d$，其中 $d \\in \\{2,3\\}$。该物体在 $\\Gamma_D$ 上受到给定位移约束，在 $\\Gamma_N$ 上受到给定牵引力 $\\mathbf{t}$ 的作用，其中 $\\partial \\Omega = \\Gamma_D \\cup \\Gamma_N$，$\\Gamma_D \\cap \\Gamma_N = \\emptyset$。设 $\\mathbf{u}$ 表示位移场，它满足平衡方程、小应变运动学关系以及具有正定四阶弹性张量 $\\mathbf{C}$ 的线性弹性本构行为。柔度目标定义为 $J(\\Omega) = \\int_{\\Gamma_N} \\mathbf{t} \\cdot \\mathbf{u} \\, \\mathrm{d}\\Gamma$。应变能密度为 $W(\\mathbf{x}) = \\tfrac{1}{2}\\,\\boldsymbol{\\varepsilon}(\\mathbf{u}):\\mathbf{C}:\\boldsymbol{\\varepsilon}(\\mathbf{u})$，其中 $\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\tfrac{1}{2}\\big(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^\\top\\big)$。假设位移场 $\\mathbf{u}$ 是通过协调的基于位移的有限元法 (FEM) 离散化计算得到的，并且 $W(\\mathbf{x})$ 在 $\\Omega$ 中是良定义且有界的。\n\n对于域内一点 $\\mathbf{x}_0 \\in \\Omega$，定义柔度关于一个无穷小球形（在 $d=3$ 时）或圆形（在 $d=2$ 时）空腔成核的拓扑导数为\n$$\nD_T J(\\mathbf{x}_0) \\;=\\; \\lim_{\\varepsilon \\to 0^+} \\frac{J\\!\\left(\\Omega \\setminus B_\\varepsilon(\\mathbf{x}_0)\\right) - J(\\Omega)}{|B_\\varepsilon(\\mathbf{x}_0)|},\n$$\n其中 $B_\\varepsilon(\\mathbf{x}_0)$ 是以 $\\mathbf{x}_0$ 为中心、半径为 $\\varepsilon$ 的球体，而 $|B_\\varepsilon(\\mathbf{x}_0)|$ 是其体积（在 $d=2$ 时为面积）。通过将 $B_\\varepsilon(\\mathbf{x}_0)$ 中的实体替换为一个弹性张量为 $\\eta\\,\\mathbf{C}$（其中 $\\eta \\to 0^+$，即空洞极限）的相来模拟材料移除，同时保持所有外部载荷和边界条件不变。\n\n基于线性弹性的基本原理和能量论证，评估在 $W(\\mathbf{x}_0)$ 高和 $W(\\mathbf{x}_0)$ 低的点处 $D_T J(\\mathbf{x}_0)$ 的符号和相对大小，并解释其在体积约束下最小化柔度的材料移除决策中的含义。\n\n哪个陈述最准确？\n\nA. 对于通过空洞成核最小化柔度的问题，$D_T J(\\mathbf{x}_0)$ 在 $W(\\mathbf{x}_0)$ 高的点处为负，表明在此处移除材料会降低柔度；此外，$D_T J(\\mathbf{x}_0)$ 的大小随着 $W(\\mathbf{x}_0)$ 的增加而减小。\n\nB. 对于通过空洞成核最小化柔度的问题，$D_T J(\\mathbf{x}_0)$ 为正，并且在 $W(\\mathbf{x}_0)$ 高的点处值更大；在此处移除材料会最大程度地增加柔度，因此最优设计应避免在高 $W$ 区域移除材料，而倾向于在 $W(\\mathbf{x}_0)$ 小的地方移除。\n\nC. 对于通过空洞成核最小化柔度的问题，只要 $\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{u})=\\mathbf{0}$ 成立，$D_T J(\\mathbf{x}_0)$ 就为零，因此它与 $W(\\mathbf{x}_0)$ 不相关。\n\nD. 对于通过空洞成核最小化柔度的问题，$D_T J(\\mathbf{x}_0)$ 的符号是不确定的，仅由泊松比决定，与局部力学状态无关，因此它不能指导材料移除。", "solution": "问题陈述需进行验证。\n\n### 第一步：提取已知条件\n-   **域**：一个线性弹性体占据一个有界域 $\\Omega \\subset \\mathbb{R}^d$，其中 $d \\in \\{2,3\\}$。\n-   **边界条件**：在 $\\Gamma_D$ 上有给定位移，在 $\\Gamma_N$ 上有给定牵引力 $\\mathbf{t}$。边界划分为 $\\partial \\Omega = \\Gamma_D \\cup \\Gamma_N$，且 $\\Gamma_D \\cap \\Gamma_N = \\emptyset$。\n-   **状态变量**：$\\mathbf{u}$ 是位移场。$\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\tfrac{1}{2}\\big(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^\\top\\big)$ 是小应变张量。$\\boldsymbol{\\sigma}$ 是应力张量。\n-   **本构定律**：线性弹性行为，具有正定四阶弹性张量 $\\mathbf{C}$，因此 $\\boldsymbol{\\sigma} = \\mathbf{C} : \\boldsymbol{\\varepsilon}(\\mathbf{u})$。\n-   **平衡**：位移场 $\\mathbf{u}$ 满足平衡方程。\n-   **目标函数（柔度）**：$J(\\Omega) = \\int_{\\Gamma_N} \\mathbf{t} \\cdot \\mathbf{u} \\, \\mathrm{d}\\Gamma$。\n-   **应变能密度**：$W(\\mathbf{x}) = \\tfrac{1}{2}\\,\\boldsymbol{\\varepsilon}(\\mathbf{u}):\\mathbf{C}:\\boldsymbol{\\varepsilon}(\\mathbf{u})$。假设 $W(\\mathbf{x})$ 在 $\\Omega$ 中是良定义且有界的。\n-   **拓扑导数定义**：对于一个小球 $B_\\varepsilon(\\mathbf{x}_0)$，$D_T J(\\mathbf{x}_0) = \\lim_{\\varepsilon \\to 0^+} \\frac{J\\!\\left(\\Omega \\setminus B_\\varepsilon(\\mathbf{x}_0)\\right) - J(\\Omega)}{|B_\\varepsilon(\\mathbf{x}_0)|}$。\n-   **空洞模型**：通过将 $B_\\varepsilon(\\mathbf{x}_0)$ 中的实体替换为空洞材料来模拟材料移除，即其弹性张量为 $\\eta\\,\\mathbf{C}$，其中 $\\eta \\to 0^+$。\n-   **假设**：分析基于协调的基于位移的有限元法 (FEM) 离散化。在拓扑变化期间，外部载荷和边界条件保持不变。\n\n### 第二步：使用提取的已知条件进行验证\n问题陈述在科学上是合理的、适定的和客观的。\n1.  **科学合理性**：所提出的概念——线性弹性、柔度、应变能和拓扑导数——在连续介质力学和结构优化中是标准和基础性的。\n2.  **适定性**：该问题要求对一个良定义的数学对象（$D_T J$）进行定性行为分析和解释。其设定是此类分析的标准设定，并且存在一个唯一的概念性答案。\n3.  **客观性**：该问题使用精确的数学语言陈述，没有歧义或主观内容。\n4.  **完整性**：提供了所有必要的定义和背景。柔度和应变能之间的关系是一个关键要素，它是所给定义和线性弹性原理（克拉佩龙定理）的直接结果。\n\n### 第三步：结论与行动\n问题陈述有效。将推导解答。\n\n### 推导\n目标是最小化柔度，柔度是衡量结构整体柔性的指标。问题要求评估拓扑导数 $D_T J(\\mathbf{x}_0)$ 的符号和大小，它量化了柔度对于在点 $\\mathbf{x}_0$ 引入一个无穷小孔洞的敏感性。\n\n首先，我们建立柔度与总应变能之间的关系。对于一个在固定外部载荷下处于平衡状态的线性弹性体，克拉佩龙定理成立。假设体力为零且 $\\Gamma_D$ 上的给定位移为零（这是此类问题的标准假设，尽管结果在更一般情况下也成立），则外部牵引力所做的功等于储存在物体中的总应变能的两倍。\n总应变能 $U(\\Omega)$ 由下式给出：\n$$\nU(\\Omega) = \\int_\\Omega W(\\mathbf{x}) \\, \\mathrm{d}V = \\int_\\Omega \\frac{1}{2} \\boldsymbol{\\sigma} : \\boldsymbol{\\varepsilon}(\\mathbf{u}) \\, \\mathrm{d}V\n$$\n柔度定义为 $J(\\Omega) = \\int_{\\Gamma_N} \\mathbf{t} \\cdot \\mathbf{u} \\, \\mathrm{d}\\Gamma$。根据虚功原理和本构关系，可以得出：\n$$\nJ(\\Omega) = \\int_\\Omega \\boldsymbol{\\sigma} : \\boldsymbol{\\varepsilon}(\\mathbf{u}) \\, \\mathrm{d}V = 2 U(\\Omega)\n$$\n因此，最小化柔度等同于最小化总应变能。\n\n接下来，我们分析在域 $\\Omega$ 内创建一个小空洞 $B_\\varepsilon(\\mathbf{x}_0)$ 的影响。新的域是 $\\Omega_\\varepsilon = \\Omega \\setminus B_\\varepsilon(\\mathbf{x}_0)$。设新域上的解为 $\\mathbf{u}_\\varepsilon$。新的柔度为 $J(\\Omega_\\varepsilon) = \\int_{\\Gamma_N} \\mathbf{t} \\cdot \\mathbf{u}_\\varepsilon \\, \\mathrm{d}\\Gamma$。\n\n根据最小势能原理，结构会以最小化其总势能的方式变形。从结构中移除材料绝不会增加其刚度。在相同施加载荷下，刚度较小的结构会变形更大。因此，沿施加牵引力方向的积分位移将会增加，或者在极限情况下保持不变。这意味着：\n$$\nJ(\\Omega_\\varepsilon) \\ge J(\\Omega)\n$$\n因此，柔度的变化量 $\\Delta J = J(\\Omega_\\varepsilon) - J(\\Omega)$ 是非负的。由此直接得出，作为这个非负变化量与一个正体积之比的极限，拓扑导数也必须是非负的：\n$$\nD_T J(\\mathbf{x}_0) = \\lim_{\\varepsilon \\to 0^+} \\frac{J(\\Omega_\\varepsilon) - J(\\Omega)}{|B_\\varepsilon(\\mathbf{x}_0)|} \\ge 0\n$$\n只有当 $\\mathbf{x}_0$ 处的材料不承受应力，即 $W(\\mathbf{x}_0) = 0$ 时，导数 $D_T J(\\mathbf{x}_0)$ 才可能为零。否则，$D_T J(\\mathbf{x}_0)$ 严格为正。\n\n现在，我们必须将 $D_T J(\\mathbf{x}_0)$ 的大小与局部应变能密度 $W(\\mathbf{x}_0)$ 联系起来。量 $D_T J(\\mathbf{x}_0)$ 代表了在 $\\mathbf{x}_0$ 处移除单位体积材料所需付出的代价（以柔度增加的形式）。点 $\\mathbf{x}_0$ 处的材料对结构的整体刚度有贡献。这种贡献与该点材料所承载的载荷直接相关，而载荷由应力 $\\boldsymbol{\\sigma}(\\mathbf{x}_0)$ 和应变 $\\boldsymbol{\\varepsilon}(\\mathbf{x}_0)$ 量化，进而由应变能密度 $W(\\mathbf{x}_0) = \\frac{1}{2} \\boldsymbol{\\sigma}(\\mathbf{x}_0) : \\boldsymbol{\\varepsilon}(\\mathbf{x}_0)$ 量化。\n\n如果从高应变能密度（高应力）区域移除材料，载荷路径必须显著地重新分配到周围的材料中。这会导致整体变形大幅增加，从而使柔度大幅增加。相反，如果从低应变能密度（低应力）区域移除材料，由于它对结构刚度的贡献很小，其移除对整体变形和柔度的影响也较小。\n因此，柔度增加的幅度，也就是 $D_T J(\\mathbf{x}_0)$ 的大小，是局部应变能密度 $W(\\mathbf{x}_0)$ 的单调递增函数。更高的 $W(\\mathbf{x}_0)$ 意味着一个更大的、正的 $D_T J(\\mathbf{x}_0)$。\n\n在旨在体积约束下最小化柔度的优化背景中，对材料移除的启示如下：为实现最优设计，必须从惩罚（柔度的增加）最小的位置移除材料。这对应于 $D_T J(\\mathbf{x}_0)$ 最小的区域。由于 $D_T J(\\mathbf{x}_0)$ 在 $W(\\mathbf{x}_0)$ 最低的地方最小，最优的材料移除策略倾向于从低应力区域移除材料，同时保留高应力区域的材料。\n\n### 逐项分析选项\n\n**A. 对于通过空洞成核最小化柔度的问题，$D_T J(\\mathbf{x}_0)$ 在 $W(\\mathbf{x}_0)$ 高的点处为负，表明在此处移除材料会降低柔度；此外，$D_T J(\\mathbf{x}_0)$ 的大小随着 $W(\\mathbf{x}_0)$ 的增加而减小。**\n-   关于 $D_T J(\\mathbf{x}_0)$ 为负的陈述是**不正确**的。移除承载材料会增加柔性，从而增加柔度，所以 $D_T J(\\mathbf{x}_0) \\ge 0$。\n-   关于其大小随着 $W(\\mathbf{x}_0)$ 增加而减小的陈述是**不正确**的。柔度对材料移除的敏感性在高度受力区域最大。\n-   结论：**不正确**。\n\n**B. 对于通过空洞成核最小化柔度的问题，$D_T J(\\mathbf{x}_0)$ 为正，并且在 $W(\\mathbf{x}_0)$ 高的点处值更大；在此处移除材料会最大程度地增加柔度，因此最优设计应避免在高 $W$ 区域移除材料，而倾向于在 $W(\\mathbf{x}_0)$ 小的地方移除。**\n-   关于 $D_T J(\\mathbf{x}_0)$ 为正的陈述是**正确**的。\n-   关于其在 $W(\\mathbf{x}_0)$ 高的点处值更大的陈述是**正确**的。\n-   “在此处移除材料会最大程度地增加柔度”的解释是**正确**的。\n-   “最优设计倾向于在 $W(\\mathbf{x}_0)$ 小的地方移除”的结论是**正确**的。这是许多拓扑优化方法的基本原则。\n-   结论：**正确**。\n\n**C. 对于通过空洞成核最小化柔度的问题，只要 $\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{u})=\\mathbf{0}$ 成立，$D_T J(\\mathbf{x}_0)$ 就为零，因此它与 $W(\\mathbf{x}_0)$ 不相关。**\n-   方程 $\\nabla \\cdot \\boldsymbol{\\sigma}(\\mathbf{u})=\\mathbf{0}$ 代表局部静态平衡（假设无体力），并且在整个材料域内都成立。如果 $D_T J$ 在此条件成立的任何地方都为零，那它将处处为零，这在物理上是荒谬的。拓扑导数取决于应力和应变的局部值，而不是它们的空间导数。\n-   因此，“它与 $W(\\mathbf{x}_0)$ 不相关”的结论是基于一个错误的前提，是**不正确**的。\n-   结论：**不正确**。\n\n**D. 对于通过空洞成核最小化柔度的问题，$D_T J(\\mathbf{x}_0)$ 的符号是不确定的，仅由泊松比决定，与局部力学状态无关，因此它不能指导材料移除。**\n-   其符号不是不确定的；根据基本原理推导，它应为非负。这个陈述是**不正确**的。\n-   $D_T J(\\mathbf{x}_0)$ 的值根本上取决于局部力学状态（应力和应变）。它在无应力区域为零，在高度受力区域值很大。其依赖性不只取决于泊松比。这个陈述是**不正确**的。\n-   “它不能指导材料移除”的结论是**不正确**的。它恰恰是拓扑优化中用于此目的的量。\n-   结论：**不正确**。", "answer": "$$\\boxed{B}$$", "id": "2604256"}]}