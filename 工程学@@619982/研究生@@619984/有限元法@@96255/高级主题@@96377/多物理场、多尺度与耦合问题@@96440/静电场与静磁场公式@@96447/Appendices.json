{"hands_on_practices": [{"introduction": "在构建有限元方程时，我们需要通过数值积分来计算单元矩阵。本练习将引导你推导出一个至关重要的法则：确定为精确计算静电问题中的单元刚度矩阵所需的最小求积阶数，从而避免因积分不准确而导致的“变分犯罪”。这项实践对于编写可靠的有限元代码至关重要。 [@problem_id:2553561]", "problem": "在静电学中，对于介电常数为 $\\,\\epsilon(\\mathbf{x})\\,$ 且自由电荷密度为 $\\,\\rho(\\mathbf{x})\\,$ 的非均匀介电介质，电势 $\\,\\phi\\,$ 的控制强形式为 $\\,\\nabla\\cdot\\big(\\epsilon(\\mathbf{x})\\,\\nabla \\phi(\\mathbf{x})\\big) = -\\rho(\\mathbf{x})\\,$。其标准的弱形式旨在求解 $\\,\\phi \\in H^{1}(\\Omega)\\,$，使得对于所有测试函数 $\\,\\psi \\in H^{1}(\\Omega)\\,$，双线性形式 $\\,a(\\phi,\\psi) := \\int_{\\Omega} \\epsilon(\\mathbf{x})\\,\\nabla \\phi \\cdot \\nabla \\psi \\,\\mathrm{d}\\mathbf{x}\\,$ 等于源项的线性泛函。考虑在二维三角形网格上进行协调有限元离散化，该离散化使用仿射单元映射，并在每个单元 $\\,K\\,$ 上使用多项式阶次为 $\\,p \\geq 1\\,$ 的连续拉格朗日基函数。假设在每个单元 $\\,K\\,$ 上，介电常数 $\\,\\epsilon|_{K}\\,$ 在物理坐标系下是一个总次数为 $\\,r \\geq 0\\,$ 的多项式。对于单元双线性形式\n$$\na_{K}(u,v) \\;=\\; \\int_{K} \\epsilon(\\mathbf{x})\\, \\nabla u(\\mathbf{x}) \\cdot \\nabla v(\\mathbf{x}) \\,\\mathrm{d}\\mathbf{x}\\,,\n$$\n您将通过在单元 $\\,K\\,$ 上使用单个三角形求积法则来精确计算该积分，该求积法则的精度由其多项式精确度 $\\,t\\,$ 来表征，即它可以精确积分 $\\,K\\,$ 上所有总次数不超过 $\\,t\\,$ 的多项式。\n\n从上述基本公式和定义出发，确定所需的最小多项式精确度 $\\,t\\,$，以确保对于 $\\,K\\,$ 上的任意一对次数为 $\\,p\\,$ 的局部基函数 $\\,u\\,$ 和 $\\,v\\,$，以及任意总次数为 $\\,r\\,$ 的多项式系数场 $\\,\\epsilon|_{K}\\,$，该求积法则都能精确计算 $\\,a_{K}(u,v)\\,$。以 $\\,p\\,$ 和 $\\,r\\,$ 的闭式表达式形式给出您的答案。基于被积函数的结构和仿射映射假设，通过严格的次数计算来证明您的法则。您的最终答案必须是单一的解析表达式。", "solution": "问题所述要求确定在有限元背景下，用于计算单元刚度矩阵的求积法则所需的最小多项式精确度（用符号 $t$ 表示）。其目标是确保对于任意选择的多项式基函数和多项式材料系数，单元双线性形式都能被精确积分。该问题是适定的、有科学依据的，并且包含进行严格推导所需的足够信息。这是有限元方法分析中的一个标准问题。我们开始求解。\n\n单元双线性形式由下式给出\n$$\na_{K}(u,v) = \\int_{K} \\epsilon(\\mathbf{x})\\, \\nabla u(\\mathbf{x}) \\cdot \\nabla v(\\mathbf{x}) \\,\\mathrm{d}\\mathbf{x}\n$$\n其中 $K$ 是二维域中的一个三角形单元。求积法则必须能够精确地对被积函数 $I(\\mathbf{x}) = \\epsilon(\\mathbf{x})\\, \\nabla u(\\mathbf{x}) \\cdot \\nabla v(\\mathbf{x})$ 进行积分。因此，所需的最小精确度 $t$ 等于被积函数 $I(\\mathbf{x})$ 的总多项式次数。为了求出这个次数，我们必须分析乘积中的每一项。\n\n令 $\\mathcal{P}_{k}(D)$ 表示在域 $D$ 上总次数至多为 $k$ 的多项式空间。\n\n首先，考虑基函数 $u$ 和 $v$。问题指出，这些是多项式阶次为 $p \\ge 1$ 的连续拉格朗日基函数。这意味着在参考单元 $\\hat{K}$ 上，形函数是次数为 $p$ 的多项式。从参考单元 $\\hat{K}$ 到物理单元 $K$ 的映射是仿射的。设此映射为 $\\mathbf{F}: \\hat{K} \\to K$，使得 $\\mathbf{x} = \\mathbf{F}(\\boldsymbol{\\xi})$，其中 $\\mathbf{x} \\in K$ 是物理坐标，$\\boldsymbol{\\xi} \\in \\hat{K}$ 是参考坐标。仿射映射具有 $\\mathbf{x} = \\mathbf{J}\\boldsymbol{\\xi} + \\mathbf{b}$ 的形式，其中 $\\mathbf{J}$ 是常数雅可比矩阵，$\\mathbf{b}$ 是常数平移向量。\n\n物理单元 $K$ 上的基函数 $u$ 是通过与逆映射复合得到的：$u(\\mathbf{x}) = \\hat{u}(\\mathbf{F}^{-1}(\\mathbf{x}))$，其中 $\\hat{u}$是参考单元上的相应基函数。由于 $\\mathbf{F}$ 是仿射的，其逆映射 $\\mathbf{F}^{-1}$ 也是仿射的。一个次数为 $p$ 的多项式与一个仿射映射的复合结果仍然是次数为 $p$ 的多项式。因此，基函数 $u(\\mathbf{x})$ 和 $v(\\mathbf{x})$ 是物理坐标 $\\mathbf{x}$ 下总次数为 $p$ 的多项式。我们记作 $u, v \\in \\mathcal{P}_{p}(K)$。\n\n接下来，我们考察梯度 $\\nabla u$ 和 $\\nabla v$。梯度算子 $\\nabla$ 将一个次数为 $k$ 的多项式映射为一个矢量场，其分量是次数为 $k-1$ 的多项式。由于 $u, v \\in \\mathcal{P}_{p}(K)$，它们的梯度 $\\nabla u$ 和 $\\nabla v$ 是矢量场，其分量的总次数至多为 $p-1$。例如，$\\frac{\\partial u}{\\partial x} \\in \\mathcal{P}_{p-1}(K)$ 和 $\\frac{\\partial u}{\\partial y} \\in \\mathcal{P}_{p-1}(K)$。\n\n现在，考虑点积 $\\nabla u \\cdot \\nabla v$。它由下式给出：\n$$\n\\nabla u \\cdot \\nabla v = \\frac{\\partial u}{\\partial x}\\frac{\\partial v}{\\partial x} + \\frac{\\partial u}{\\partial y}\\frac{\\partial v}{\\partial y}\n$$\n此和中的每一项都是两个次数为 $p-1$ 的多项式的乘积。多项式乘积的次数是它们各自次数的和。因此，$\\frac{\\partial u}{\\partial x}\\frac{\\partial v}{\\partial x}$ 的次数至多为 $(p-1) + (p-1) = 2p-2$。同样，$\\frac{\\partial u}{\\partial y}\\frac{\\partial v}{\\partial y}$ 的次数也至多为 $2p-2$。多项式和的次数是它们各自次数的最大值。因此，多项式 $\\nabla u \\cdot \\nabla v$ 的总次数是 $2p-2$。\n所以，$\\nabla u \\cdot \\nabla v \\in \\mathcal{P}_{2p-2}(K)$。\n\n最后，我们分析完整的被积函数 $I(\\mathbf{x}) = \\epsilon(\\mathbf{x})\\left(\\nabla u(\\mathbf{x}) \\cdot \\nabla v(\\mathbf{x})\\right)$。问题指出，单元 $K$ 上的介电常数（记作 $\\epsilon|_{K}$）是一个总次数为 $r \\ge 0$ 的多项式。所以，$\\epsilon(\\mathbf{x}) \\in \\mathcal{P}_{r}(K)$。\n\n被积函数是多项式 $\\epsilon(\\mathbf{x})$ 和多项式 $\\nabla u \\cdot \\nabla v$ 的乘积。所得多项式的次数是其因式次数之和：\n$$\n\\text{deg}(I) = \\text{deg}(\\epsilon) + \\text{deg}(\\nabla u \\cdot \\nabla v)\n$$\n代入我们求得的次数：\n$$\n\\text{deg}(I) = r + (2p-2)\n$$\n为了使求积法则能精确计算积分 $\\int_K I(\\mathbf{x}) \\,\\mathrm{d}\\mathbf{x}$，它必须对所有次数不超过被积函数次数的多项式都是精确的。这意味着求积法则所需的最小精确度 $t$ 必须等于 $I(\\mathbf{x})$ 的次数。\n\n因此，最小多项式精确度为：\n$$\nt = 2p - 2 + r\n$$\n这个结果对于有限元方法的正确实施至关重要，因为使用精度不足的求积法则会导致“变分犯罪”(variational crime)，并可能导致失去最优收敛率。仿射单元映射的假设是至关重要的；对于具有非仿射映射的等参单元，分析会更加复杂，因为变换本身会引入有理函数，并且物理坐标系中被积函数的次数将不再是一个简单的多项式。", "answer": "$$\n\\boxed{2p + r - 2}\n$$", "id": "2553561"}, {"introduction": "有限元法的理论收敛率通常假设解是“光滑”的。然而，在包含尖锐凹角的实际几何中，这一假设常常失效，导致数值解的精度下降。本练习将带你分析解在角点附近的奇异性，并设计一种自适应的网格加密策略，以恢复模拟的最佳精度。 [@problem_id:2553552]", "problem": "考虑一个平面多边形域 $\\Omega \\subset \\mathbb{R}^{2}$ 中的静电学问题，该域在原点处有一个内角为 $\\omega \\in (\\pi,2\\pi)$ 的凹角。静电势 $\\phi$ 满足从静态场的麦克斯韦方程组推导出的无源控制方程，\n$$\n-\\nabla \\cdot (\\varepsilon \\nabla \\phi) = 0 \\quad \\text{in } \\Omega,\n$$\n附带齐次狄利克雷边界条件 $\\phi = 0$ on $\\partial \\Omega$，其中介电常数 $\\varepsilon$ 在角点附近的一个邻域内为正常数。假设在一个形状规则的三角形剖分族上采用协调的分片线性有限元方法（FEM）离散，并且网格加密通过径向分级策略局限在凹角附近的一个邻域内，而在远离角点的区域保持准均匀。\n\n您的任务是确定角点附近 $\\phi$ 的主阶行为，并选择一个径向网格分级律 $h(r) \\simeq C r^{\\alpha}$（其中 $r$ 是到角点的距离，$C>0$ 是一个常数），使得关于总自由度数 $N$ 的 $H^{1}$-误差率恢复到可能的最优值。此处，“可能的最优”指的是在二维情况下对光滑解成立的收敛率，即\n$$\n\\|\\nabla(\\phi - \\phi_{h})\\|_{L^{2}(\\Omega)} = \\mathcal{O}(N^{-1/2}).\n$$\n请选择一个选项，该选项正确且一致地陈述了：(i) 角点附近 $\\phi$ 主导项的奇异指数和角度依赖性，(ii) 达到可能的最优 $H^{1}$-误差率的分级指数 $\\alpha$，以及 (iii) 最终用 $N$ 表示的 $H^{1}$-误差率。\n\nA. 主导项为 $\\phi(r,\\theta) \\approx r^{\\lambda} \\sin(\\lambda \\theta)$，其中 $\\lambda = \\pi/\\omega$。采用网格 $h(r) \\simeq C r^{\\,1 - \\lambda/2}$ 可得到 $\\|\\nabla(\\phi - \\phi_{h})\\|_{L^{2}(\\Omega)} \\lesssim C N^{-1/2}$。\n\nB. 主导项为 $\\phi(r,\\theta) \\approx r^{\\lambda} \\sin(\\lambda \\theta)$，其中 $\\lambda = \\omega/\\pi$。采用网格 $h(r) \\simeq C r^{\\,1 - \\lambda/2}$ 可得到 $\\|\\nabla(\\phi - \\phi_{h})\\|_{L^{2}(\\Omega)} \\lesssim C N^{-1/2}$。\n\nC. 主导项为 $\\phi(r,\\theta) \\approx r^{\\lambda} \\cos(\\lambda \\theta)$，其中 $\\lambda = \\pi/\\omega$。采用网格 $h(r) \\simeq C r^{\\,1 - \\lambda}$ 可得到 $\\|\\nabla(\\phi - \\phi_{h})\\|_{L^{2}(\\Omega)} \\lesssim C N^{-1/2}$。\n\nD. 主导项为 $\\phi(r,\\theta) \\approx r^{\\lambda} \\sin(\\lambda \\theta)$，其中 $\\lambda = \\pi/\\omega$。准均匀网格（无分级，$h$ 与 $r$ 无关）已可得到 $\\|\\nabla(\\phi - \\phi_{h})\\|_{L^{2}(\\Omega)} \\lesssim C N^{-1/2}$。", "solution": "首先必须验证问题陈述的科学性和逻辑完整性。\n\n### 步骤 1：提取已知条件\n-   **域**：一个平面多边形域 $\\Omega \\subset \\mathbb{R}^{2}$，在原点处有一个凹角。\n-   **角点内角**：角点的内角为 $\\omega \\in (\\pi, 2\\pi)$。\n-   **控制方程**：静电势 $\\phi$ 满足 $-\\nabla \\cdot (\\varepsilon \\nabla \\phi) = 0$ in $\\Omega$。\n-   **介电常数**：$\\varepsilon$ 在角点附近为正常数。\n-   **边界条件**：齐次狄利克雷条件，$\\phi = 0$ on $\\partial \\Omega$。\n-   **数值方法**：在形状规则的三角形剖分上采用协调的分片线性有限元方法（FEM）。\n-   **网格策略**：角点附近采用径向分级网格，单元尺寸 $h(r) \\simeq C r^{\\alpha}$（$r>0$），其中 $r$ 是距角点的距离。网格在远离角点处是准均匀的。\n-   **目标**：确定角点附近 $\\phi$ 的主阶行为，以及为达到“可能的最优”$H^1$-误差率所需的分级指数 $\\alpha$。该最优误差率定义为 $\\|\\nabla(\\phi - \\phi_{h})\\|_{L^{2}(\\Omega)} = \\mathcal{O}(N^{-1/2})$，其中 $N$ 是自由度数。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题描述了非凸多边形域上的拉普拉斯方程（因为 $\\varepsilon$ 是常数，故为 $\\Delta \\phi = 0$）。这是势论和计算电磁学中的一个经典问题。解中存在角点奇异性是一个公认的数学事实。在有限元法中使用分级网格来改善奇异解的收敛率是数值分析中一种标准且有充分根据的技术。该问题在科学上和数学上是合理的。\n2.  **良定性**：在有界域上带有齐次狄利克雷边界条件的拉普拉斯方程是一个良定的椭圆边值问题，在索博列夫空间 $H_0^1(\\Omega)$ 中存在唯一弱解。所提出的问题是精确的，并且在有限元理论框架内有确定的答案。\n3.  **客观性**：语言是形式化且明确的。诸如“$H^1$-误差”、“自由度”和“形状规则”等术语都有精确的数学定义。\n4.  **完整性**：问题提供了确定解的奇异性并推导最优网格分级策略所需的所有信息。\n\n### 步骤 3：结论与行动\n问题陈述是有效的。这是一个标准的、良定的偏微分方程数值分析问题。可以开始求解过程。\n\n---\n\n### 解的推导\n\n分析过程分为三个部分：确定解的奇异性，推导最优网格分级，以及评估最终的收敛率。\n\n**第 1 部分：凹角处的解的奇异性**\n\n在原点附近，由于 $\\varepsilon$ 是常数，控制方程为拉普拉斯方程。在极坐标 $(r, \\theta)$ 中，拉普拉斯方程为：\n$$\n\\frac{\\partial^2 \\phi}{\\partial r^2} + \\frac{1}{r} \\frac{\\partial \\phi}{\\partial r} + \\frac{1}{r^2} \\frac{\\partial^2 \\phi}{\\partial \\theta^2} = 0\n$$\n我们寻求一个形如 $\\phi(r, \\theta) = R(r) \\Theta(\\theta)$ 的分离变量解。将其代入方程得到：\n$$\n\\frac{r^2 R''(r) + r R'(r)}{R(r)} = - \\frac{\\Theta''(\\theta)}{\\Theta(\\theta)} = \\mu\n$$\n其中 $\\mu$ 是分离常数。这引出两个常微分方程：\n$$\n\\Theta''(\\theta) + \\mu \\Theta(\\theta) = 0\n$$\n$$\nr^2 R''(r) + r R'(r) - \\mu R(r) = 0\n$$\n第二个方程是柯西-欧拉方程，其通解为 $R(r) = c_1 r^{\\sqrt{\\mu}} + c_2 r^{-\\sqrt{\\mu}}$。为了使解具有有限能量（即 $\\phi \\in H^1(\\Omega)$），必须舍弃带有负幂次 $r^{-\\sqrt{\\mu}}$ 的项，因为它会在 $r=0$ 附近导致能量积分发散。因此，我们设 $c_2=0$，并令 $\\lambda = \\sqrt{\\mu}$，所以 $R(r) = c_1 r^\\lambda$ 且 $\\lambda > 0$。\n\n角度部分由 $\\Theta''(\\theta) + \\lambda^2 \\Theta(\\theta) = 0$ 控制，其通解为 $\\Theta(\\theta) = A \\cos(\\lambda \\theta) + B \\sin(\\lambda \\theta)$。齐次狄利克雷边界条件 $\\phi=0$ 应用于构成角点的两条边。我们调整坐标系，使这两条边对应于 $\\theta=0$ 和 $\\theta=\\omega$。\n-   $\\phi(r, 0) = 0 \\implies \\Theta(0) = 0 \\implies A \\cos(0) + B \\sin(0) = A = 0$。\n解的形式必须是 $\\Theta(\\theta) = B \\sin(\\lambda \\theta)$。\n-   $\\phi(r, \\omega) = 0 \\implies \\Theta(\\omega) = 0 \\implies B \\sin(\\lambda \\omega) = 0$。\n为了得到非平凡解（$B \\neq 0$），我们要求 $\\sin(\\lambda \\omega) = 0$。这意味着 $\\lambda \\omega = k \\pi$，其中 $k \\ge 1$ 为整数。\n\n解是一个级数，形式为 $\\phi(r, \\theta) = \\sum_{k=1}^{\\infty} c_k r^{k\\pi/\\omega} \\sin(k\\pi\\theta/\\omega)$。在角点附近（$r \\to 0$）的主阶行为由具有最小正指数 $\\lambda$ 的项决定。这对应于 $k=1$：\n$$\n\\lambda = \\frac{\\pi}{\\omega}\n$$\n因为角点是凹角，$\\omega \\in (\\pi, 2\\pi)$，这意味着奇异指数 $\\lambda = \\pi/\\omega$ 在范围 $(1/2, 1)$ 内。解不属于 $H^2(\\Omega)$，因为其二阶导数的行为类似于 $r^{\\lambda-2}$，在 $r=0$ 附近不是平方可积的。\n因此，主导项为 $\\phi(r,\\theta) \\approx C r^{\\lambda} \\sin(\\lambda \\theta)$，其中 $\\lambda = \\pi/\\omega$。\n\n**第 2 部分：最优网格分级**\n\n对于光滑解，二维（$d=2$）中的分片线性有限元法（$p=1$）得到的 $H^1$-误差率为 $\\|\\nabla(\\phi-\\phi_h)\\|_{L^2(\\Omega)} = \\mathcal{O}(h)$，其中 $h$ 是网格尺寸。对于准均匀网格（$h = \\text{const}$），自由度数 $N$ 的缩放关系为 $N \\propto h^{-2}$，因此收敛率为 $\\mathcal{O}(N^{-1/2})$。\n\n由于奇异性 $\\phi \\sim r^\\lambda$ 且 $\\lambda < 1$，在准均匀网格上的收敛率会恶化为 $\\|\\nabla(\\phi-\\phi_h)\\|_{L^2(\\Omega)} = \\mathcal{O}(h^\\lambda) = \\mathcal{O}(N^{-\\lambda/2})$。因为 $\\lambda < 1$，这个收敛率是次优的。\n\n为了恢复最优收敛率 $\\mathcal{O}(N^{-1/2})$，必须对网格进行分级。最优网格设计的原则是在所有单元上均分插值误差。单元 $K$ 上的局部 $H^1$ 插值误差由 $C h_K |\\phi|_{H^2(K)}$ 界定。我们希望对所有单元 $K$，$h_K |\\phi|_{H^2(K)}$ 近似为常数。\n解的奇异部分的二阶导数行为如 $|\\nabla^2 \\phi| \\sim r^{\\lambda-2}$。严格分析表明，在距离角点为 $r$、尺寸为 $h(r)$ 的单元 $K$ 上，局部 $H^2$ 半范数行为如 $|\\phi|_{H^2(K)} \\sim h(r) r^{\\lambda-2}$。\n均分原则 $h(r) |\\phi|_{H^2(K)} \\approx \\text{const}$ 变为：\n$$\nh(r) \\cdot [h(r) r^{\\lambda-2}] \\approx \\text{const} \\implies h(r)^2 r^{\\lambda-2} \\approx \\text{const}\n$$\n$$\nh(r)^2 \\propto r^{2-\\lambda} \\implies h(r) \\propto r^{1-\\lambda/2}\n$$\n因此，所需的分级指数为 $\\alpha = 1 - \\lambda/2$。\n\n采用这种分级 $h(r) = C r^{1-\\lambda/2}$，误差得到控制。总单元/顶点数 $N$ 由奇异点附近最精细的网格部分主导。设 $h_{min}$ 是最小的单元尺寸。更有效地说，设 $h_{max}$ 是网格准均匀部分的单元尺寸。可以证明总顶点数 $N$ 的缩放关系为 $N \\propto h_{max}^{-2}$。误差分析证实，采用这种分级后，$\\|\\nabla(\\phi-\\phi_h)\\|_{L^2(\\Omega)} = \\mathcal{O}(h_{max}) = \\mathcal{O}(N^{-1/2})$，恢复了最优收敛率。\n\n### 逐项分析选项\n\n**A. 主导项为 $\\phi(r,\\theta) \\approx r^{\\lambda} \\sin(\\lambda \\theta)$，其中 $\\lambda = \\pi/\\omega$。采用网格 $h(r) \\simeq C r^{\\,1 - \\lambda/2}$ 可得到 $\\|\\nabla(\\phi - \\phi_{h})\\|_{L^{2}(\\Omega)} \\lesssim C N^{-1/2}$。**\n-   主导项的形式和指数 $\\lambda = \\pi/\\omega$ 是正确的，如上文推导。\n-   分级律 $h(r) \\simeq C r^{\\alpha}$ 中，$\\alpha = 1 - \\lambda/2$ 是恢复分片线性元最优 $H^1$-误差率的正确选择。\n-   得到的误差率 $\\mathcal{O}(N^{-1/2})$ 确实是这种分级策略所能达到的“可能的最优”收敛率。\n该陈述完全一致且正确。\n结论：**正确**。\n\n**B. 主导项为 $\\phi(r,\\theta) \\approx r^{\\lambda} \\sin(\\lambda \\theta)$，其中 $\\lambda = \\omega/\\pi$。采用网格 $h(r) \\simeq C r^{\\,1 - \\lambda/2}$ 可得到 $\\|\\nabla(\\phi - \\phi_{h})\\|_{L^{2}(\\Omega)} \\lesssim C N^{-1/2}$。**\n-   奇异指数被陈述为 $\\lambda = \\omega/\\pi$。由于 $\\omega \\in (\\pi, 2\\pi)$，该指数将大于 1。决定主导奇异行为的最小正指数是 $\\pi/\\omega < 1$。因此，该陈述不正确。\n结论：**不正确**。\n\n**C. 主导项为 $\\phi(r,\\theta) \\approx r^{\\lambda} \\cos(\\lambda \\theta)$，其中 $\\lambda = \\pi/\\omega$。采用网格 $h(r) \\simeq C r^{\\,1 - \\lambda}$ 可得到 $\\|\\nabla(\\phi - \\phi_{h})\\|_{L^{2}(\\Omega)} \\lesssim C N^{-1/2}$。**\n-   角度依赖性被给出为 $\\cos(\\lambda \\theta)$。这违反了在 $\\theta=0$ 处的边界条件 $\\phi=0$，因此不正确。\n-   分级指数被陈述为 $\\alpha = 1-\\lambda$。这不是优化 $H^1$-误差的正确指数。\n结论：**不正确**。\n\n**D. 主导项为 $\\phi(r,\\theta) \\approx r^{\\lambda} \\sin(\\lambda \\theta)$，其中 $\\lambda = \\pi/\\omega$。准均匀网格（无分级，$h$ 与 $r$ 无关）已可得到 $\\|\\nabla(\\phi - \\phi_{h})\\|_{L^{2}(\\Omega)} \\lesssim C N^{-1/2}$。**\n-   准均匀网格能达到最优收敛率的说法根本上是错误的。如推导所示，准均匀网格导致次优的收敛率 $\\mathcal{O}(N^{-\\lambda/2})$，其中 $\\lambda = \\pi/\\omega < 1$。网格分级的目的正是为了克服这一缺陷。\n结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2553552"}, {"introduction": "现在，我们将从静电学的标量势转向通常需要矢量势的静磁学问题。本练习将为你提供使用矢量有限元构建模块的直接实践经验，特别是最低阶的 Nédélec 棱单元。通过为旋度-旋度方程推导单元刚度矩阵，你将具体理解这些复杂的单元是如何捕捉矢量场物理特性的。 [@problem_id:2553591]", "problem": "考虑一个单连通、无源、各向同性的区域，其磁导率 $\\mu$ 为常数，研究该区域中的静磁学问题。从麦克斯韦方程组导出的旋度-旋度公式出发，对单个四面体单元使用有限元法 (FEM)，并采用最低阶 Nedelec (第一类) 边元。设该四面体为参考单纯形，其顶点为 $x_{1}=(0,0,0)$、$x_{2}=(1,0,0)$、$x_{3}=(0,1,0)$ 和 $x_{4}=(0,0,1)$。局部边的方向定义为从编号较小的顶点指向编号较大的顶点，顺序为 $(1,2)$、$(1,3)$、$(1,4)$、$(2,3)$、$(2,4)$、$(3,4)$。用 $\\lambda_{a}$（$a=1,2,3,4$）表示重心坐标，并使用定义在边 $(a,b)$ 上的规范最低阶 Nedelec 基函数 $\\mathbf{N}_{ab}=\\lambda_{a}\\nabla \\lambda_{b}-\\lambda_{b}\\nabla \\lambda_{a}$。\n\n1) 导出单元刚度矩阵 $\\mathbf{K}_{e}$，其矩阵元为\n$$\nK_{(ab),(cd)} \\;=\\; \\int_{K} \\mu^{-1} \\big(\\nabla \\times \\mathbf{N}_{ab}\\big)\\cdot\\big(\\nabla \\times \\mathbf{N}_{cd}\\big)\\, \\mathrm{d}V,\n$$\n其中 $(a,b)$ 和 $(c,d)$ 是按给定顺序排列的所有局部边。\n\n2) 假设此单个四面体的全局边编号（全局方向从编号较小的顶点指向编号较大的顶点，与局部方向一致）由以下边到索引的无序关联列表给出：\n$$\n(1,3)\\mapsto 7,\\quad (1,2)\\mapsto 4,\\quad (3,4)\\mapsto 12,\\quad (1,4)\\mapsto 9,\\quad (2,4)\\mapsto 11,\\quad (2,3)\\mapsto 8.\n$$\n请指明从局部自由度 (DOF)到全局自由度的映射，包括每条局部边相对于其全局方向的方向符号。\n\n作为最终答案，报告此单元的标量值 $S=\\mu\\, \\mathrm{tr}(\\mathbf{K}_{e})$。无需四舍五入，应提供一个精确值。最终报告的标量 $S$ 根据其构造是无量纲的，并且必须以单个实数的形式给出。", "solution": "所述问题具有科学依据，提法恰当且信息完整。这是一个关于静磁学有限元法 (FEM) 的标准练习。所有必要数据，包括单元的几何形状、基函数的定义以及刚度矩阵的公式，均已提供。因此，该问题被视为有效。我将继续进行求解。\n\n问题要求推导单元刚度矩阵 $\\mathbf{K}_e$ 并计算标量 $S = \\mu \\, \\mathrm{tr}(\\mathbf{K}_e)$。\n\n无源区域中静磁学的控制方程为 $\\nabla \\times (\\mu^{-1} \\nabla \\times \\mathbf{A}) = \\mathbf{0}$，其中 $\\mathbf{A}$ 是磁矢量势。相应的弱形式可导出单元刚度矩阵的矩阵元：\n$$\nK_{(ab),(cd)} = \\int_{K} \\mu^{-1} (\\nabla \\times \\mathbf{N}_{ab}) \\cdot (\\nabla \\times \\mathbf{N}_{cd}) \\, \\mathrm{d}V\n$$\n其中 $K$ 是四面体单元的体积，$\\mathbf{N}_{ab}$ 是最低阶 Nedelec 边基函数。连接顶点 $a$ 和 $b$ 的边的基函数由下式给出：\n$$\n\\mathbf{N}_{ab} = \\lambda_a \\nabla \\lambda_b - \\lambda_b \\nabla \\lambda_a\n$$\n其中 $\\lambda_i$ 是重心坐标。\n\n首先，我们确定指定的参考四面体的属性。其顶点为 $x_1=(0,0,0)$、$x_2=(1,0,0)$、$x_3=(0,1,0)$ 和 $x_4=(0,0,1)$。重心坐标 $\\lambda_i(\\mathbf{x})$ 是位置 $\\mathbf{x}=(x,y,z)$ 的线性函数，满足 $\\lambda_i(x_j) = \\delta_{ij}$。对于这个特定的四面体，它们是：\n$$\n\\lambda_1(\\mathbf{x}) = 1 - x - y - z\n$$\n$$\n\\lambda_2(\\mathbf{x}) = x\n$$\n$$\n\\lambda_3(\\mathbf{x}) = y\n$$\n$$\n\\lambda_4(\\mathbf{x}) = z\n$$\n重心坐标的梯度是常向量：\n$$\n\\mathbf{g}_1 = \\nabla \\lambda_1 = \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\end{pmatrix}, \\quad\n\\mathbf{g}_2 = \\nabla \\lambda_2 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{g}_3 = \\nabla \\lambda_3 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{g}_4 = \\nabla \\lambda_4 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n该四面体的体积为 $V_K = \\frac{1}{6} |(x_2-x_1) \\cdot ((x_3-x_1) \\times (x_4-x_1))| = \\frac{1}{6}$。\n\n接下来，我们计算基函数 $\\mathbf{N}_{ab}$ 的旋度。使用矢量恒等式 $\\nabla \\times (f \\mathbf{G}) = (\\nabla f) \\times \\mathbf{G} + f(\\nabla \\times \\mathbf{G})$ 并注意到 $\\nabla \\lambda_i$ 是常向量（因此其旋度为零），我们得到：\n$$\n\\nabla \\times \\mathbf{N}_{ab} = \\nabla \\times (\\lambda_a \\nabla \\lambda_b) - \\nabla \\times (\\lambda_b \\nabla \\lambda_a)\n= (\\nabla \\lambda_a \\times \\nabla \\lambda_b) - (\\nabla \\lambda_b \\times \\nabla \\lambda_a)\n= 2 (\\nabla \\lambda_a \\times \\nabla \\lambda_b)\n$$\n由于梯度是常数，每个基函数的旋度 $\\nabla \\times \\mathbf{N}_{ab}$ 在单元 $K$ 上是一个常向量。我们记 $\\mathbf{C}_{ab} = \\nabla \\lambda_a \\times \\nabla \\lambda_b$。\n\n刚度矩阵的积分可大幅简化：\n$$\nK_{(ab),(cd)} = \\int_{K} \\mu^{-1} (2 \\mathbf{C}_{ab}) \\cdot (2 \\mathbf{C}_{cd}) \\, \\mathrm{d}V = \\frac{4}{\\mu} (\\mathbf{C}_{ab} \\cdot \\mathbf{C}_{cd}) \\int_{K} \\mathrm{d}V = \\frac{4 V_K}{\\mu} (\\mathbf{C}_{ab} \\cdot \\mathbf{C}_{cd})\n$$\n代入 $V_K = 1/6$，我们得到：\n$$\nK_{(ab),(cd)} = \\frac{4}{6\\mu} (\\mathbf{C}_{ab} \\cdot \\mathbf{C}_{cd}) = \\frac{2}{3\\mu} (\\mathbf{C}_{ab} \\cdot \\mathbf{C}_{cd})\n$$\n\n局部边按 $e_1=(1,2)$、$e_2=(1,3)$、$e_3=(1,4)$、$e_4=(2,3)$、$e_5=(2,4)$、$e_6=(3,4)$ 顺序排列。我们计算相应的旋度向量 $\\mathbf{C}_{ab}$：\n$$\n\\mathbf{C}_{12} = \\mathbf{g}_1 \\times \\mathbf{g}_2 = \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\end{pmatrix} \\times \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\end{pmatrix}\n$$\n$$\n\\mathbf{C}_{13} = \\mathbf{g}_1 \\times \\mathbf{g}_3 = \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\end{pmatrix} \\times \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}\n$$\n$$\n\\mathbf{C}_{14} = \\mathbf{g}_1 \\times \\mathbf{g}_4 = \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\end{pmatrix} \\times \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\mathbf{C}_{23} = \\mathbf{g}_2 \\times \\mathbf{g}_3 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\times \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n$$\n\\mathbf{C}_{24} = \\mathbf{g}_2 \\times \\mathbf{g}_4 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\times \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\mathbf{C}_{34} = \\mathbf{g}_3 \\times \\mathbf{g}_4 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} \\times \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n现在，我们计算点积矩阵 $[\\mathbf{C}_{ab} \\cdot \\mathbf{C}_{cd}]$。设旋度向量的有序集合为 $\\{\\mathbf{v}_1, \\dots, \\mathbf{v}_6\\} = \\{\\mathbf{C}_{12}, \\mathbf{C}_{13}, \\mathbf{C}_{14}, \\mathbf{C}_{23}, \\mathbf{C}_{24}, \\mathbf{C}_{34}\\}$。点积矩阵 $\\mathbf{v}_i \\cdot \\mathbf{v}_j$ 为：\n$$\n\\begin{pmatrix}\n2 & -1 & -1 & 1 & 1 & 0 \\\\\n-1 & 2 & -1 & -1 & 0 & 1 \\\\\n-1 & -1 & 2 & 0 & -1 & -1 \\\\\n1 & -1 & 0 & 1 & 0 & 0 \\\\\n1 & 0 & -1 & 0 & 1 & 0 \\\\\n0 & 1 & -1 & 0 & 0 & 1\n\\end{pmatrix}\n$$\n\n1) 单元刚度矩阵 $\\mathbf{K}_e$ 是该矩阵乘以 $\\frac{2}{3\\mu}$：\n$$\n\\mathbf{K}_{e} = \\frac{2}{3\\mu}\n\\begin{pmatrix}\n2 & -1 & -1 & 1 & 1 & 0 \\\\\n-1 & 2 & -1 & -1 & 0 & 1 \\\\\n-1 & -1 & 2 & 0 & -1 & -1 \\\\\n1 & -1 & 0 & 1 & 0 & 0 \\\\\n1 & 0 & -1 & 0 & 1 & 0 \\\\\n0 & 1 & -1 & 0 & 0 & 1\n\\end{pmatrix} = \\frac{1}{3\\mu} \\begin{pmatrix}\n4 & -2 & -2 & 2 & 2 & 0 \\\\\n-2 & 4 & -2 & -2 & 0 & 2 \\\\\n-2 & -2 & 4 & 0 & -2 & -2 \\\\\n2 & -2 & 0 & 2 & 0 & 0 \\\\\n2 & 0 & -2 & 0 & 2 & 0 \\\\\n0 & 2 & -2 & 0 & 0 & 2\n\\end{pmatrix}\n$$\n\n2) 确定从局部自由度 (DOF) 到全局自由度的映射。\n局部自由度按边排序：$1 \\to (1,2)$、$2 \\to (1,3)$、$3 \\to (1,4)$、$4 \\to (2,3)$、$5 \\to (2,4)$、$6 \\to (3,4)$。\n对于边 $(a,b)$ 且 $a < b$，局部方向是从 $a$ 到 $b$。\n全局自由度由以下映射给出：$(1,2) \\mapsto 4, (1,3) \\mapsto 7, (1,4) \\mapsto 9, (2,3) \\mapsto 8, (2,4) \\mapsto 11, (3,4) \\mapsto 12$。\n全局方向也是从编号较小的顶点到编号较大的顶点。\n由于所有边的局部方向和全局方向都匹配，所有自由度的方向符号均为 $+1$。映射关系如下：\n- 局部自由度 1 (边 $(1,2)$) 映射到全局自由度 $4$，符号为 $+1$。\n- 局部自由度 2 (边 $(1,3)$) 映射到全局自由度 $7$，符号为 $+1$。\n- 局部自由度 3 (边 $(1,4)$) 映射到全局自由度 $9$，符号为 $+1$。\n- 局部自由度 4 (边 $(2,3)$) 映射到全局自由度 $8$，符号为 $+1$。\n- 局部自由度 5 (边 $(2,4)$) 映射到全局自由度 $11$，符号为 $+1$。\n- 局部自由度 6 (边 $(3,4)$) 映射到全局自由度 $12$，符号为 $+1$。\n\n最后，我们计算标量 $S = \\mu \\, \\mathrm{tr}(\\mathbf{K}_e)$。这是矩阵 $\\mu \\mathbf{K}_e$ 的迹。\n$$\n\\mu \\mathbf{K}_e = \\frac{2}{3}\n\\begin{pmatrix}\n2 & -1 & -1 & 1 & 1 & 0 \\\\\n-1 & 2 & -1 & -1 & 0 & 1 \\\\\n-1 & -1 & 2 & 0 & -1 & -1 \\\\\n1 & -1 & 0 & 1 & 0 & 0 \\\\\n1 & 0 & -1 & 0 & 1 & 0 \\\\\n0 & 1 & -1 & 0 & 0 & 1\n\\end{pmatrix}\n$$\n迹是主对角线元素之和：\n$$\nS = \\mathrm{tr}(\\mu \\mathbf{K}_e) = \\frac{2}{3} (2 + 2 + 2 + 1 + 1 + 1) = \\frac{2}{3} (9) = 6\n$$\n该问题是在一个具有无量纲坐标的参考单元上设定的，这使得计算出的值 $S$ 是无量纲的，正如问题描述中所述。", "answer": "$$\\boxed{6}$$", "id": "2553591"}]}