{"hands_on_practices": [{"introduction": "理论知识需要通过实践来巩固。本节的第一个练习将引导您从最基本的层面开始，即单个有限元。通过从虚功原理和热传导方程的弱形式出发，为一维热弹性杆推导单元级矩阵，您将深入理解热力耦合效应是如何在有限元框架中被数学描述的。这个基础性练习是掌握更复杂的热力耦合问题分析的基石 [@problem_id:2605803]。", "problem": "一根横截面恒定的细长直热弹性杆发生耦合变形和热传导。考虑一个长度为 $L$、横截面积为 $A$ 的双节点有限元，其轴向位移场 $u(x)$ 和温度场 $\\Theta(x)$ 均由线性形函数插值。设弹性模量为 $E$，线热膨胀系数为 $\\alpha$，导热系数为 $k$。假设小应变、准静态力学、稳态热传导，无机械体力，无内部热源。参考温度为 $T_{0}$，节点温度是相对于 $T_{0}$ 给出的。\n\n从第一性原理出发，使用：\n- 机械虚功原理，其中 Cauchy 应力为 $\\sigma = E\\left(\\epsilon - \\epsilon_{\\text{th}}\\right)$，轴向应变为 $\\epsilon = \\frac{du}{dx}$，热应变为 $\\epsilon_{\\text{th}} = \\alpha\\left(\\Theta - T_{0}\\right)$，以及\n- 稳态热方程的弱形式以及 Fourier 定律（热通量 $q = -k\\,\\frac{d\\Theta}{dx}$），\n\n推导此双节点线性单元的单元级表达式：\n- 机械刚度矩阵，\n- 将节点温度映射到机械内力的热-机耦合矩阵，\n- 热传导矩阵，以及\n- 由热应变产生的等效机械热载荷向量。\n\n然后，根据以下给定数据，计算该单元的等效机械热载荷向量的第二个分量：\n- $L = 0.40~\\text{米}$，\n- $A = 2.0 \\times 10^{-4}~\\text{米}^{2}$，\n- $E = 210 \\times 10^{9}~\\text{帕}$，\n- $\\alpha = 12 \\times 10^{-6}~\\text{K}^{-1}$，\n- $k = 50~\\text{瓦}\\,\\text{米}^{-1}\\,\\text{K}^{-1}$，\n- 相对于 $T_{0}$ 的节点温度为 $\\Theta_{1} = 0~\\text{K}$ 和 $\\Theta_{2} = 60~\\text{K}$。\n\n在单元上对 $u$ 和 $\\Theta$ 均使用线性 Lagrange 形函数，并假定横截面和材料属性在单元内是常数。将所求的最终数值以牛顿（N）为单位表示，并四舍五入到四位有效数字。", "solution": "该问题陈述已经过严格验证，并被认定为有效。它具有科学依据，问题定义明确，是客观的，并包含足够的信息以获得唯一解。因此，我们可以进行推导和计算。\n\n问题要求推导一个长度为 $L$、横截面积恒为 $A$ 的双节点线性热弹性杆单元的单元矩阵。该单元沿 $x$ 轴放置，节点 1 位于 $x=0$，节点 2 位于 $x=L$。\n\n轴向位移场 $u(x)$ 和温度场 $\\Theta(x)$（相对于参考温度 $T_0$）由其节点值通过线性 Lagrange 形函数插值得到：\n$$\nu(x) = N_1(x) u_1 + N_2(x) u_2 = \\mathbf{N}(x) \\mathbf{u}^e\n$$\n$$\n\\Theta(x) = N_1(x) \\Theta_1 + N_2(x) \\Theta_2 = \\mathbf{N}(x) \\mathbf{\\Theta}^e\n$$\n其中 $u_1, u_2$ 是节点位移，$\\Theta_1, \\Theta_2$ 是节点温度。形函数向量为 $\\mathbf{N} = \\begin{pmatrix} N_1(x)  N_2(x) \\end{pmatrix}$，节点向量为 $\\mathbf{u}^e = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$ 和 $\\mathbf{\\Theta}^e = \\begin{pmatrix} \\Theta_1 \\\\ \\Theta_2 \\end{pmatrix}$。线性形函数为：\n$$\nN_1(x) = 1 - \\frac{x}{L}, \\quad N_2(x) = \\frac{x}{L}\n$$\n轴向应变 $\\epsilon = \\frac{du}{dx}$ 通过应变-位移矩阵 $\\mathbf{B}_u$ 与节点位移相关联：\n$$\n\\epsilon(x) = \\frac{d\\mathbf{N}}{dx} \\mathbf{u}^e = \\begin{pmatrix} -\\frac{1}{L}  \\frac{1}{L} \\end{pmatrix} \\mathbf{u}^e = \\mathbf{B}_u \\mathbf{u}^e\n$$\n因此，$\\mathbf{B}_u = \\frac{1}{L}\\begin{pmatrix} -1  1 \\end{pmatrix}$。\n类似地，温度梯度 $\\frac{d\\Theta}{dx}$ 通过 $\\mathbf{B}_\\Theta$ 与节点温度相关联：\n$$\n\\frac{d\\Theta}{dx} = \\frac{d\\mathbf{N}}{dx} \\mathbf{\\Theta}^e = \\begin{pmatrix} -\\frac{1}{L}  \\frac{1}{L} \\end{pmatrix} \\mathbf{\\Theta}^e = \\mathbf{B}_\\Theta \\mathbf{\\Theta}^e\n$$\n其中 $\\mathbf{B}_\\Theta = \\frac{1}{L}\\begin{pmatrix} -1  1 \\end{pmatrix}$。\n\n首先，我们推导力学部分。对于无体力的准静态问题，虚功原理指出，内虚功等于节点力 $\\mathbf{F}_{\\text{ext}}^e$ 所做的外虚功：\n$$\n\\delta W_{\\text{int}} = \\int_{V} \\delta\\epsilon^T \\sigma \\, dV = (\\delta \\mathbf{u}^e)^T \\mathbf{F}_{\\text{ext}}^e\n$$\n代入 $\\delta\\epsilon = \\mathbf{B}_u \\delta\\mathbf{u}^e$，我们得到 $\\int_{V} (\\delta\\mathbf{u}^e)^T \\mathbf{B}_u^T \\sigma \\, dV = (\\delta\\mathbf{u}^e)^T \\mathbf{F}_{\\text{ext}}^e$。由于虚位移 $\\delta\\mathbf{u}^e$ 是任意的，这导出了单元平衡方程：\n$$\n\\mathbf{F}_{\\text{int}}^e = \\int_{V} \\mathbf{B}_u^T \\sigma \\, dV = \\mathbf{F}_{\\text{ext}}^e\n$$\n使用本构关系 $\\sigma = E(\\epsilon - \\epsilon_{\\text{th}})$，其中 $\\epsilon = \\mathbf{B}_u \\mathbf{u}^e$，热应变 $\\epsilon_{\\text{th}} = \\alpha \\Theta = \\alpha \\mathbf{N} \\mathbf{\\Theta}^e$：\n$$\n\\int_V \\mathbf{B}_u^T E (\\mathbf{B}_u \\mathbf{u}^e - \\alpha \\mathbf{N} \\mathbf{\\Theta}^e) \\, dV = \\mathbf{F}_{\\text{ext}}^e\n$$\n分离各项，我们得到：\n$$\n\\left( \\int_V E \\mathbf{B}_u^T \\mathbf{B}_u \\, dV \\right) \\mathbf{u}^e - \\left( \\int_V E \\alpha \\mathbf{B}_u^T \\mathbf{N} \\, dV \\right) \\mathbf{\\Theta}^e = \\mathbf{F}_{\\text{ext}}^e\n$$\n平衡方程的标准形式是 $\\mathbf{K}_{uu} \\mathbf{u}^e = \\mathbf{F}_{\\text{ext}}^e + \\mathbf{F}_{\\text{th}}^{\\text{eq}}$。因此，我们可以识别出这些矩阵。\n\n$1$. 机械刚度矩阵, $\\mathbf{K}_{uu}$:\n$$\n\\mathbf{K}_{uu} = \\int_V E \\mathbf{B}_u^T \\mathbf{B}_u \\, dV = \\int_0^L A E \\mathbf{B}_u^T \\mathbf{B}_u \\, dx\n$$\n由于 $A$、$E$ 和 $\\mathbf{B}_u$ 在单元上是常数：\n$$\n\\mathbf{K}_{uu} = A E L (\\mathbf{B}_u^T \\mathbf{B}_u) = A E L \\left( \\frac{1}{L^2} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} -1  1 \\end{pmatrix} \\right) = \\frac{AE}{L} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\n\n$2$. 等效机械热载荷向量 $\\mathbf{F}_{\\text{th}}^{\\text{eq}}$ 是移到等式右边的项：\n$$\n\\mathbf{F}_{\\text{th}}^{\\text{eq}} = \\left( \\int_V E \\alpha \\mathbf{B}_u^T \\mathbf{N} \\, dV \\right) \\mathbf{\\Theta}^e = \\left( \\int_0^L A E \\alpha \\mathbf{B}_u^T \\mathbf{N} \\, dx \\right) \\mathbf{\\Theta}^e\n$$\n这就定义了将节点温度映射到机械力的热-机耦合矩阵 $\\mathbf{K}_{u\\Theta}$。\n\n$3$. 热-机耦合矩阵, $\\mathbf{K}_{u\\Theta}$:\n$$\n\\mathbf{K}_{u\\Theta} = \\int_0^L A E \\alpha \\mathbf{B}_u^T \\mathbf{N}(x) \\, dx\n$$\n将 $\\mathbf{N}(x)$ 在单元长度上积分： $\\int_0^L \\mathbf{N}(x) dx = \\int_0^L \\begin{pmatrix} 1 - \\frac{x}{L}  \\frac{x}{L} \\end{pmatrix} dx = \\begin{pmatrix} \\frac{L}{2}  \\frac{L}{2} \\end{pmatrix}$。\n$$\n\\mathbf{K}_{u\\Theta} = A E \\alpha \\mathbf{B}_u^T \\int_0^L \\mathbf{N}(x) \\, dx = A E \\alpha \\left( \\frac{1}{L} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} \\right) \\begin{pmatrix} \\frac{L}{2}  \\frac{L}{2} \\end{pmatrix} = \\frac{AE\\alpha}{2} \\begin{pmatrix} -1  -1 \\\\ 1  1 \\end{pmatrix}\n$$\n\n$4$. 因此，等效机械热载荷向量为：\n$$\n\\mathbf{F}_{\\text{th}}^{\\text{eq}} = \\mathbf{K}_{u\\Theta} \\mathbf{\\Theta}^e = \\frac{AE\\alpha}{2} \\begin{pmatrix} -1  -1 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} \\Theta_1 \\\\ \\Theta_2 \\end{pmatrix}\n$$\n\n接下来，我们推导热学部分。稳态热方程 $-\\frac{d}{dx}(k \\frac{d\\Theta}{dx})=0$ 的弱形式是通过乘以一个权函数 $w(x)$ 并分部积分得到的。这得到了 Galerkin 形式：\n$$\n\\int_0^L A k \\frac{dw}{dx} \\frac{d\\Theta}{dx} \\, dx = \\mathbf{Q}^e\n$$\n其中 $\\mathbf{Q}^e$ 是节点热通量向量。使用 $w = \\mathbf{N}\\mathbf{w}^e$ 和 $\\Theta = \\mathbf{N}\\mathbf{\\Theta}^e$，我们得到：\n$$\n\\left( \\int_0^L A k \\mathbf{B}_\\Theta^T \\mathbf{B}_\\Theta \\, dx \\right) \\mathbf{\\Theta}^e = \\mathbf{Q}^e\n$$\n\n$5$. 热传导矩阵, $\\mathbf{K}_{\\Theta\\Theta}$:\n$$\n\\mathbf{K}_{\\Theta\\Theta} = \\int_0^L A k \\mathbf{B}_\\Theta^T \\mathbf{B}_\\Theta \\, dx\n$$\n其形式与机械刚度矩阵相同，只是将 $E$ 替换为 $k$：\n$$\n\\mathbf{K}_{\\Theta\\Theta} = A k L (\\mathbf{B}_\\Theta^T \\mathbf{B}_\\Theta) = A k L \\left( \\frac{1}{L^2} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} \\right) = \\frac{Ak}{L} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\n\n推导表达式总结：\n- 机械刚度矩阵: $\\mathbf{K}_{uu} = \\frac{AE}{L} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$\n- 热-机耦合矩阵: $\\mathbf{K}_{u\\Theta} = \\frac{AE\\alpha}{2} \\begin{pmatrix} -1  -1 \\\\ 1  1 \\end{pmatrix}$\n- 热传导矩阵: $\\mathbf{K}_{\\Theta\\Theta} = \\frac{Ak}{L} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$\n- 等效机械热载荷向量: $\\mathbf{F}_{\\text{th}}^{\\text{eq}} = \\frac{AE\\alpha}{2} (\\Theta_1+\\Theta_2) \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$\n\n现在，我们使用给定数据计算等效机械热载荷向量的第二个分量 $(\\mathbf{F}_{\\text{th}}^{\\text{eq}})_2$。\n第二个分量的公式是：\n$$\n(\\mathbf{F}_{\\text{th}}^{\\text{eq}})_2 = \\frac{AE\\alpha}{2} (1 \\cdot \\Theta_1 + 1 \\cdot \\Theta_2) = \\frac{AE\\alpha}{2} (\\Theta_1 + \\Theta_2)\n$$\n给定的数值是：\n- $L = 0.40~\\text{m}$\n- $A = 2.0 \\times 10^{-4}~\\text{m}^2$\n- $E = 210 \\times 10^9~\\text{Pa}$\n- $\\alpha = 12 \\times 10^{-6}~\\text{K}^{-1}$\n- $\\Theta_1 = 0~\\text{K}$\n- $\\Theta_2 = 60~\\text{K}$\n\n将这些值代入表达式：\n$$\n(\\mathbf{F}_{\\text{th}}^{\\text{eq}})_2 = \\frac{(2.0 \\times 10^{-4}) \\times (210 \\times 10^9) \\times (12 \\times 10^{-6})}{2} (0 + 60)\n$$\n首先，计算乘积 $AE\\alpha$：\n$$\nAE\\alpha = (2.0 \\times 10^{-4}~\\text{m}^2) \\times (210 \\times 10^9~\\text{N/m}^2) \\times (12 \\times 10^{-6}~\\text{K}^{-1})\n$$\n$$\nAE\\alpha = (2.0 \\times 210 \\times 12) \\times (10^{-4} \\times 10^9 \\times 10^{-6})~\\text{N/K}\n$$\n$$\nAE\\alpha = (5040) \\times (10^{-1})~\\text{N/K} = 504~\\text{N/K}\n$$\n现在，将此结果代回力分量的方程中：\n$$\n(\\mathbf{F}_{\\text{th}}^{\\text{eq}})_2 = \\frac{504~\\text{N/K}}{2} \\times (60~\\text{K}) = 252~\\text{N} \\times 60 = 15120~\\text{N}\n$$\n问题要求答案四舍五入到四位有效数字。计算值 $15120$ 已恰好是四位有效数字。", "answer": "$$\\boxed{15120}$$", "id": "2605803"}, {"introduction": "在掌握了单个元素的构建之后，下一步是学习如何将它们组装成一个结构并求解。本练习通过分析一个由两种不同材料组成的杆在均匀温度变化下的响应，提供了一个绝佳的实践机会。您不仅需要构建有限元模型，还需要推导其精确的解析解，并将两者进行比较；这是一个在开发和验证计算代码时至关重要的步骤，能够加深您对有限元方法准确性的理解 [@problem_id:2605808]。", "problem": "考虑一根由两个串联杆段组成的、完美粘合的、等截面的一维双材料杆。杆段$1$的长度为$L_{1}$，杨氏模量为$E_{1}$，热膨胀系数为$\\alpha_{1}$；杆段$2$的长度为$L_{2}$，杨氏模量为$E_{2}$，热膨胀系数为$\\alpha_{2}$。横截面积$A$在两个杆段中是均匀且相同的。整根杆（包括两个杆段）经历一个均匀的温度变化$\\Delta T$。杆的左端（$x=0$）和右端（$x=L_{1}+L_{2}$）均被轴向固定，因此$u(0)=0$且$u(L_{1}+L_{2})=0$。杆上没有施加外部的机械分布或集中轴向载荷。假设为小应变和小位移。\n\n任务A（推导）。仅从适用于固体热-力耦合和有限元法的基本原理出发，即：(i) 无轴向体力情况下的轴向平衡，(ii) 一维小应变运动学关系，以及 (iii) 每个杆段的线性热弹性本构关系，推导出杆的精确解析轴向应力分布$\\sigma(x)$。您的推导必须明确使用：\n- 以轴力$N(x)$表示的一维轴向平衡。\n- 一维小应变运动学关系 $\\varepsilon(x)=\\dfrac{du}{dx}$。\n- 每个杆段的一维线性热弹性本构关系，它关联了在温度变化$\\Delta T$下的应力$\\sigma$、总应变$\\varepsilon$、杨氏模量$E$和热膨胀系数$\\alpha$。\n- 双材料界面处的位移协调性以及在 $x=0$ 和 $x=L_{1}+L_{2}$ 处的本质边界条件。\n\n任务B（有限元列式）。使用两节点线性杆单元，为每个杆段构建一个单元，从而建立一维有限元模型。对于一个长度为$\\ell$、模量为$E$、横截面积为$A$、热膨胀系数为$\\alpha$的单元，在均匀温度变化$\\Delta T$下，请从基本原理出发，推导其单元刚度矩阵和协调热等效节点力向量。清楚地说明热应变是如何进入弱形式的，以及它是如何产生协调节点力的。组集全局系统，施加本质边界条件$u(0)=0$和$u(L_{1}+L_{2})=0$，求解节点位移，并根据恢复的应变计算每个单元内的恒定应力。\n\n任务C（比较和数值测试套件）。实现一个程序，该程序：\n- 计算任务A中推导出的解析应力分布。\n- 计算任务B中每个单元的有限元应力。\n- 对于每个测试用例，报告一个标量值，该值定义为解析应力与有限元单元应力之间的最大绝对差。该标量必须以帕斯卡（Pa）为单位，并表示为浮点数。\n\n您的程序必须评估以下测试套件。请严格按照规定的物理单位使用：\n- 案例$1$（一般非对称情况）：$L_{1}=0.6$ m, $L_{2}=0.4$ m, $E_{1}=70\\times 10^{9}$ Pa, $E_{2}=210\\times 10^{9}$ Pa, $\\alpha_{1}=23\\times 10^{-6}$ K$^{-1}$, $\\alpha_{2}=12\\times 10^{-6}$ K$^{-1}$, $\\Delta T=50$ K, $A=1\\times 10^{-3}$ m$^{2}$。\n- 案例$2$（对称材料情况）：$L_{1}=1.0$ m, $L_{2}=1.0$ m, $E_{1}=200\\times 10^{9}$ Pa, $E_{2}=200\\times 10^{9}$ Pa, $\\alpha_{1}=10\\times 10^{-6}$ K$^{-1}$, $\\alpha_{2}=10\\times 10^{-6}$ K$^{-1}$, $\\Delta T=100$ K, $A=2\\times 10^{-4}$ m$^{2}$。\n- 案例$3$（高失配和冷却）：$L_{1}=0.8$ m, $L_{2}=0.2$ m, $E_{1}=1\\times 10^{9}$ Pa, $E_{2}=200\\times 10^{9}$ Pa, $\\alpha_{1}=100\\times 10^{-6}$ K$^{-1}$, $\\alpha_{2}=12\\times 10^{-6}$ K$^{-1}$, $\\Delta T=-30$ K, $A=5\\times 10^{-4}$ m$^{2}$。\n- 案例$4$（一个杆段为负热膨胀）：$L_{1}=0.5$ m, $L_{2}=0.5$ m, $E_{1}=100\\times 10^{9}$ Pa, $E_{2}=50\\times 10^{9}$ Pa, $\\alpha_{1}=12\\times 10^{-6}$ K$^{-1}$, $\\alpha_{2}=-5\\times 10^{-6}$ K$^{-1}$, $\\Delta T=75$ K, $A=1\\times 10^{-3}$ m$^{2}$。\n\n最终输出格式。您的程序应生成单行输出，其中包含四个案例的结果，格式为方括号内由逗号分隔的列表，且无空格。例如，该行应类似于 $[$result\\_1,result\\_2,result\\_3,result\\_4$]$，其中每个结果是对应案例的最大绝对应力差（单位为Pa），以浮点数表示。", "solution": "所给出的问题是一维热弹性力学中的一个标准的、适定的问题。它在科学上是合理的，包含了所有必要的信息，并且没有矛盾或含糊之处。它要求应用连续介质力学和有限元法的基本原理。我们将直接进行推导和求解。\n\n按照要求，分析分为三个部分：解析推导、有限元列式和数值比较。\n\n**任务A：解析推导**\n\n应力分布$\\sigma(x)$的推导基于三大支柱：平衡、运动学和本构定律。\n\n1.  **轴向平衡**：问题陈述中没有轴向体力。一维轴向平衡的微分方程是$\\frac{dN}{dx} + b(x) = 0$，其中$N(x)$是轴力，$b(x)$是单位长度上的分布轴向力。当$b(x)=0$时，该方程简化为$\\frac{dN}{dx}=0$。这意味着轴力$N(x)$在杆的全长上是恒定的。由于横截面积$A$也是均匀的，轴向应力$\\sigma(x) = N(x)/A$在整根杆上必为常数。我们将此常数应力记为$\\sigma_0$。因此，对于$x \\in [0, L_{1}+L_{2}]$，有$\\sigma(x) = \\sigma_0$。\n\n2.  **本构关系**：一维线性热弹性本构关系关联了应力$\\sigma$、总应变$\\varepsilon$、杨氏模量$E$、热膨胀系数$\\alpha$和温度变化$\\Delta T$。总应变$\\varepsilon$是机械应变$\\varepsilon_m$和热应变$\\varepsilon_{th}$之和。\n    $$ \\varepsilon = \\varepsilon_m + \\varepsilon_{th} $$\n    应力与机械应变成正比，$\\sigma = E \\varepsilon_m$，而热应变为$\\varepsilon_{th} = \\alpha \\Delta T$。将这些关系结合起来，得到总的应力-应变关系：\n    $$ \\sigma = E (\\varepsilon - \\alpha \\Delta T) $$\n    该关系可以整理以表示总应变与应力的关系：\n    $$ \\varepsilon = \\frac{\\sigma}{E} + \\alpha \\Delta T $$\n    将此关系应用于每个杆段，并使用恒定应力$\\sigma_0$：\n    - 对于杆段1（$0 \\leq x \\leq L_{1}$）：$\\varepsilon_{1}(x) = \\frac{\\sigma_0}{E_{1}} + \\alpha_{1} \\Delta T$\n    - 对于杆段2（$L_{1}  x \\leq L_{1}+L_{2}$）：$\\varepsilon_{2}(x) = \\frac{\\sigma_0}{E_{2}} + \\alpha_{2} \\Delta T$\n    由于$\\sigma_0$、$E$、$\\alpha$和$\\Delta T$在每个杆段内都是常数，因此每个杆段内的应变也是恒定的。\n\n3.  **运动学和边界条件**：总应变由小应变运动学关系$\\varepsilon(x) = \\frac{du}{dx}$定义，其中$u(x)$是轴向位移。杆的总长度变化可以通过对整个长度上的应变进行积分得到：\n    $$ \\Delta L_{total} = u(L_{1}+L_{2}) - u(0) = \\int_{0}^{L_{1}+L_{2}} \\varepsilon(x) dx $$\n    由于杆的两端都是固定的，所以本质边界条件为$u(0)=0$和$u(L_{1}+L_{2})=0$。这施加了总伸长量为零的约束：\n    $$ \\int_{0}^{L_{1}+L_{2}} \\varepsilon(x) dx = 0 $$\n    我们可以将积分分为两个杆段：\n    $$ \\int_{0}^{L_{1}} \\varepsilon_{1}(x) dx + \\int_{L_{1}}^{L_{1}+L_{2}} \\varepsilon_{2}(x) dx = 0 $$\n    由于$\\varepsilon_{1}$和$\\varepsilon_{2}$在各自的域内是常数：\n    $$ \\varepsilon_{1} L_{1} + \\varepsilon_{2} L_{2} = 0 $$\n    代入应变的本构表达式：\n    $$ \\left( \\frac{\\sigma_0}{E_{1}} + \\alpha_{1} \\Delta T \\right) L_{1} + \\left( \\frac{\\sigma_0}{E_{2}} + \\alpha_{2} \\Delta T \\right) L_{2} = 0 $$\n    现在我们求解未知的恒定应力$\\sigma_0$：\n    $$ \\sigma_0 \\left( \\frac{L_{1}}{E_{1}} + \\frac{L_{2}}{E_{2}} \\right) + (\\alpha_{1} L_{1} + \\alpha_{2} L_{2}) \\Delta T = 0 $$\n    $$ \\sigma_0 = - \\frac{(\\alpha_{1} L_{1} + \\alpha_{2} L_{2}) \\Delta T}{\\frac{L_{1}}{E_{1}} + \\frac{L_{2}}{E_{2}}} $$\n    这是在整个杆上均匀分布的轴向应力的精确解析表达式。为了便于计算，可以将其写为：\n    $$ \\sigma_0 = - \\frac{E_{1} E_{2} (\\alpha_{1} L_{1} + \\alpha_{2} L_{2})}{E_{1} L_{2} + E_{2} L_{1}} \\Delta T $$\n\n**任务B：有限元列式**\n\n我们使用两个两节点线性杆单元来对系统建模。单元1跨越节点1和2（从$x=0$到$x=L_{1}$），单元2跨越节点2和3（从$x=L_{1}$到$x=L_{1}+L_{2}$）。\n\n1.  **从基本原理出发的单元列式**：\n    该列式基于虚功原理。对于一个长度为$\\ell$的单元，虚功方程为：\n    $$ \\int_{0}^{\\ell} \\delta \\varepsilon^T \\sigma A dx = \\delta \\mathbf{d}^{eT} \\mathbf{f}_{ext}^{e} $$\n    其中$\\delta \\varepsilon$是虚应变，$\\sigma$是应力，$A$是面积，$\\delta \\mathbf{d}^{e}$是虚节点位移向量，$\\mathbf{f}_{ext}^{e}$是外部节点力向量。\n\n    线性单元内的位移场$u(x)$由节点位移$\\mathbf{d}^e=[u_1, u_2]^T$通过形函数$\\mathbf{N}(x) = [1-x/\\ell, x/\\ell]$插值得到：$u(x) = \\mathbf{N}(x) \\mathbf{d}^e$。\n    应变$\\varepsilon(x)$由$\\varepsilon(x) = \\frac{du}{dx} = \\frac{d\\mathbf{N}}{dx} \\mathbf{d}^e = \\mathbf{B} \\mathbf{d}^e$给出，其中$\\mathbf{B} = [-1/\\ell, 1/\\ell]$是应变-位移矩阵。\n    虚应变为$\\delta\\varepsilon = \\mathbf{B} \\delta\\mathbf{d}^e$。\n    应力由热弹性本构定律给出：$\\sigma = E(\\varepsilon - \\varepsilon_{th}) = E(\\mathbf{B}\\mathbf{d}^e - \\alpha\\Delta T)$。\n\n    将这些代入虚功方程：\n    $$ \\int_{0}^{\\ell} (\\mathbf{B} \\delta\\mathbf{d}^e)^T E(\\mathbf{B}\\mathbf{d}^e - \\alpha\\Delta T) A dx = \\delta\\mathbf{d}^{eT} \\mathbf{f}_{ext}^{e} $$\n    $$ \\delta\\mathbf{d}^{eT} \\int_{0}^{\\ell} \\mathbf{B}^T E \\mathbf{B} A dx \\ \\mathbf{d}^e - \\delta\\mathbf{d}^{eT} \\int_{0}^{\\ell} \\mathbf{B}^T E \\alpha \\Delta T A dx = \\delta\\mathbf{d}^{eT} \\mathbf{f}_{ext}^{e} $$\n    由于这对任意$\\delta\\mathbf{d}^e$都成立，我们得到单元矩阵方程：\n    $$ \\left( \\int_{0}^{\\ell} \\mathbf{B}^T E \\mathbf{B} A dx \\right) \\mathbf{d}^e = \\mathbf{f}_{ext}^{e} + \\left( \\int_{0}^{\\ell} \\mathbf{B}^T E \\alpha \\Delta T A dx \\right) $$\n    其形式为$\\mathbf{k}^e \\mathbf{d}^e = \\mathbf{f}_{ext}^{e} + \\mathbf{f}_{th}^{e}$。\n\n2.  **单元刚度矩阵和热力向量**：\n    单元刚度矩阵$\\mathbf{k}^e$为：\n    $$ \\mathbf{k}^e = A \\int_{0}^{\\ell} \\begin{bmatrix} -1/\\ell \\\\ 1/\\ell \\end{bmatrix} E [-1/\\ell \\ 1/\\ell] dx = \\frac{EA}{\\ell^2} \\int_{0}^{\\ell} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} dx = \\frac{EA}{\\ell} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} $$\n    热应变$\\varepsilon_{th} = \\alpha \\Delta T$通过本构定律进入弱形式。它的贡献产生了协调热等效节点力向量$\\mathbf{f}_{th}^e$：\n    $$ \\mathbf{f}_{th}^e = A \\int_{0}^{\\ell} \\mathbf{B}^T E \\alpha \\Delta T dx = A E \\alpha \\Delta T \\int_{0}^{\\ell} \\begin{bmatrix} -1/\\ell \\\\ 1/\\ell \\end{bmatrix} dx = A E \\alpha \\Delta T \\begin{bmatrix} -1 \\\\ 1 \\end{bmatrix} $$\n\n3.  **全局系统组集与求解**：\n    全局系统包含三个节点，位移为$\\mathbf{U} = [U_1, U_2, U_3]^T$。由于没有外部机械载荷，$\\mathbf{F}_{ext} = \\mathbf{0}$。全局系统为$\\mathbf{K}\\mathbf{U} = \\mathbf{F}_{th}$。\n    - 单元1 ($e=1$): $\\ell=L_1$, $E=E_1$, $\\alpha=\\alpha_1$。连接节点1, 2。\n    - 单元2 ($e=2$): $\\ell=L_2$, $E=E_2$, $\\alpha=\\alpha_2$。连接节点2, 3。\n    组集后的全局刚度矩阵$\\mathbf{K}$和热力向量$\\mathbf{F}_{th}$为：\n    $$ \\mathbf{K} = A \\begin{bmatrix} \\frac{E_{1}}{L_{1}}  -\\frac{E_{1}}{L_{1}}  0 \\\\ -\\frac{E_{1}}{L_{1}}  \\frac{E_{1}}{L_{1}} + \\frac{E_{2}}{L_{2}}  -\\frac{E_{2}}{L_{2}} \\\\ 0  -\\frac{E_{2}}{L_{2}}  \\frac{E_{2}}{L_{2}} \\end{bmatrix}, \\quad \\mathbf{F}_{th} = A \\Delta T \\begin{Bmatrix} -E_{1}\\alpha_{1} \\\\ E_{1}\\alpha_{1} - E_{2}\\alpha_{2} \\\\ E_{2}\\alpha_{2} \\end{Bmatrix} $$\n    施加边界条件$U_1=0$和$U_3=0$后，我们只需解系统中的第二个方程来求得未知位移$U_2$：\n    $$ A \\left( \\frac{E_{1}}{L_{1}} + \\frac{E_{2}}{L_{2}} \\right) U_2 = A \\Delta T (E_{1}\\alpha_{1} - E_{2}\\alpha_{2}) $$\n    $$ U_2 = \\frac{(E_{1}\\alpha_{1} - E_{2}\\alpha_{2}) \\Delta T}{\\frac{E_{1}}{L_{1}} + \\frac{E_{2}}{L_{2}}} $$\n\n4.  **单元应力恢复**：\n    每个单元内的应力是恒定的，计算公式为$\\sigma^e = E(\\varepsilon^e - \\alpha\\Delta T)$。\n    - 对于单元1：$\\varepsilon^{(1)} = \\mathbf{B}^{(1)} [U_1, U_2]^T = [-1/L_1, 1/L_1] [0, U_2]^T = U_2/L_1$。\n        $$ \\sigma^{(1)} = E_{1} \\left( \\frac{U_2}{L_{1}} - \\alpha_{1}\\Delta T \\right) $$\n    - 对于单元2：$\\varepsilon^{(2)} = \\mathbf{B}^{(2)} [U_2, U_3]^T = [-1/L_2, 1/L_2] [U_2, 0]^T = -U_2/L_2$。\n        $$ \\sigma^{(2)} = E_{2} \\left( -\\frac{U_2}{L_{2}} - \\alpha_{2}\\Delta T \\right) $$\n\n**任务C：比较与数值实现**\n\n问题要求计算解析应力$\\sigma_0$与逐单元的有限元应力$\\sigma^{(1)}$和$\\sigma^{(2)}$之间的最大绝对差。\n\n让我们将推导出的$U_2$表达式代入$\\sigma^{(1)}$的方程：\n$$ \\sigma^{(1)} = E_{1} \\left( \\frac{1}{L_{1}} \\frac{(E_{1}\\alpha_{1} - E_{2}\\alpha_{2})\\Delta T}{\\frac{E_{1}}{L_{1}} + \\frac{E_{2}}{L_{2}}} - \\alpha_{1}\\Delta T \\right) $$\n$$ \\sigma^{(1)} = \\Delta T \\frac{\\frac{E_{1}}{L_1}(E_{1}\\alpha_{1} - E_{2}\\alpha_{2}) - E_{1}\\alpha_{1}(\\frac{E_{1}}{L_1} + \\frac{E_{2}}{L_2})}{\\frac{E_{1}}{L_{1}} + \\frac{E_{2}}{L_{2}}} $$\n$$ \\sigma^{(1)} = \\Delta T \\frac{ - \\frac{E_{1}E_{2}\\alpha_{2}}{L_1} - \\frac{E_{1}E_{2}\\alpha_{1}}{L_2} }{\\frac{E_{1}L_{2} + E_{2}L_{1}}{L_1 L_2}} = \\Delta T \\frac{ - E_{1}E_{2} \\frac{\\alpha_{2}L_{2} + \\alpha_{1}L_{1}}{L_1 L_2} }{\\frac{E_{1}L_{2} + E_{2}L_{1}}{L_1 L_2}} $$\n$$ \\sigma^{(1)} = - \\frac{E_{1}E_{2}(\\alpha_{1}L_{1} + \\alpha_{2}L_{2})}{E_{1}L_{2} + E_{2}L_{1}} \\Delta T $$\n这个表达式与解析应力$\\sigma_0$完全相同。对$\\sigma^{(2)}$进行类似的代入可以证实$\\sigma^{(2)}=\\sigma_0$。\n\n因此，具有两个线性单元的有限元模型对于此问题是精确的。这是因为应变的精确解析解是分段常数，而线性单元恰好可以精确表示这种状态。从有限元模型中求得的节点位移$U_2$是材料界面的精确位移。因此，解析应力与有限元应力之间的计算差异应该为零，仅受数值实现中浮点精度的限制。下面的程序将验证这一点。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares analytical and FEM solutions for stress in a bi-material bar.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (general asymmetric case)\n        {\n            \"L1\": 0.6, \"L2\": 0.4,\n            \"E1\": 70e9, \"E2\": 210e9,\n            \"a1\": 23e-6, \"a2\": 12e-6,\n            \"dT\": 50.0,\n        },\n        # Case 2 (symmetric material case)\n        {\n            \"L1\": 1.0, \"L2\": 1.0,\n            \"E1\": 200e9, \"E2\": 200e9,\n            \"a1\": 10e-6, \"a2\": 10e-6,\n            \"dT\": 100.0,\n        },\n        # Case 3 (high mismatch and cooling)\n        {\n            \"L1\": 0.8, \"L2\": 0.2,\n            \"E1\": 1e9, \"E2\": 200e9,\n            \"a1\": 100e-6, \"a2\": 12e-6,\n            \"dT\": -30.0,\n        },\n        # Case 4 (one segment with negative thermal expansion)\n        {\n            \"L1\": 0.5, \"L2\": 0.5,\n            \"E1\": 100e9, \"E2\": 50e9,\n            \"a1\": 12e-6, \"a2\": -5e-6,\n            \"dT\": 75.0,\n        },\n    ]\n\n    results = []\n    for params in test_cases:\n        L1, L2 = params[\"L1\"], params[\"L2\"]\n        E1, E2 = params[\"E1\"], params[\"E2\"]\n        a1, a2 = params[\"a1\"], params[\"a2\"]\n        dT = params[\"dT\"]\n\n        # ----------------------------------------------------------------------\n        # Task A: Analytical Stress Calculation\n        # sigma_an = - (a1*L1 + a2*L2) * dT / (L1/E1 + L2/E2)\n        # The form below is more numerically stable for a wide range of E values.\n        # ----------------------------------------------------------------------\n        numerator_an = - (a1 * L1 + a2 * L2) * dT\n        denominator_an = (L1 / E1) + (L2 / E2)\n        \n        # Avoid division by zero if both segments have infinite stiffness (hypothetical)\n        if denominator_an == 0:\n            sigma_an = 0.0 # No strain is possible, so stress is from constrained thermal expansion\n                           # In a more complete model, this would be -E*a*dT, but here we assume nonzero compliance\n        else:\n            sigma_an = numerator_an / denominator_an\n\n        # ----------------------------------------------------------------------\n        # Task B: Finite Element Stress Calculation\n        # 1. Solve for nodal displacement U2 at the interface\n        # ----------------------------------------------------------------------\n        numerator_U2 = (E1 * a1 - E2 * a2) * dT\n        denominator_U2 = (E1 / L1) + (E2 / L2)\n\n        # Avoid division by zero\n        if denominator_U2 == 0:\n            U2 = 0.0\n        else:\n            U2 = numerator_U2 / denominator_U2\n\n        # ----------------------------------------------------------------------\n        # 2. Compute stress in each element\n        # ----------------------------------------------------------------------\n        # Strain in element 1\n        epsilon1 = U2 / L1\n        # Stress in element 1\n        sigma_fem1 = E1 * (epsilon1 - a1 * dT)\n\n        # Strain in element 2\n        epsilon2 = -U2 / L2\n        # Stress in element 2\n        sigma_fem2 = E2 * (epsilon2 - a2 * dT)\n\n        # ----------------------------------------------------------------------\n        # Task C: Comparison\n        # Calculate the maximum absolute difference between analytical and FEM stresses.\n        # This is expected to be near zero, limited by floating-point precision.\n        # ----------------------------------------------------------------------\n        diff1 = abs(sigma_an - sigma_fem1)\n        diff2 = abs(sigma_an - sigma_fem2)\n        \n        max_abs_diff = max(diff1, diff2)\n        results.append(max_abs_diff)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2605808"}, {"introduction": "真实的有限元分析不仅需要正确的物理公式，还需要对数值稳定性有深刻的理解。这个高级实践将带您直面一个在热力学模拟中常见的陷阱：体积锁定。本练习将探讨当材料接近不可压缩（例如，由热膨胀引起大的体积应变时）时，为何看似正确的公式会导致错误的、过于刚硬的计算结果，并介绍如何通过选择性减缩积分这一高级技巧来有效缓解此问题 [@problem_id:2605832]。", "problem": "考虑一个小应变、线性的各向同性热弹性固体，其 Lamé 参数为 $\\lambda$ 和 $\\mu$，体积模量为 $\\kappa = \\lambda + \\tfrac{2}{3}\\mu$，以及一个恒定的热膨胀系数 $\\alpha$。假设绝对温度变化在空间上是均匀的，其值为 $\\Delta T$。Cauchy 应力与总应变 $\\boldsymbol{\\varepsilon}$ 的关系如下\n$$\n\\boldsymbol{\\sigma} = 2\\mu\\,\\boldsymbol{\\varepsilon}^{\\text{dev}} + \\kappa\\left(\\operatorname{tr}\\boldsymbol{\\varepsilon} - 3\\alpha \\Delta T\\right)\\mathbf{I},\n$$\n其中 $\\boldsymbol{\\varepsilon}^{\\text{dev}} = \\boldsymbol{\\varepsilon} - \\tfrac{1}{3}(\\operatorname{tr}\\boldsymbol{\\varepsilon})\\mathbf{I}$。假设在 $x$-$y$ 平面内为平面应变运动学。考虑一个单独的等参双线性四边形 ($Q4$) 单元，其位移采用标准的 $C^{0}$ 插值，组装成全局位移向量 $\\mathbf{d}$，使得有限元（Finite Element Method (FEM)）位移场为 $\\mathbf{u}^{h}(\\mathbf{x}) = \\mathbf{N}(\\mathbf{x})\\,\\mathbf{d}$，小应变张量为 $\\boldsymbol{\\varepsilon}^{h} = \\mathbf{B}(\\mathbf{x})\\,\\mathbf{d}$。假设边界为无牵引力边界，且仅施加最小约束以消除刚体运动。在单元层面上进行分析，并考虑与内虚功线性化相对应的位移-位移切向刚度 $\\mathbf{K}_{uu}$。\n\n严格从热弹性内能泛函及其一阶变分出发，且不借助任何专门的单元公式，进行以下概念性推导和论证：\n\n- 展示内虚功如何自然地分解为偏量和体积贡献两部分，其形式如下\n$$\n\\delta W_{\\text{int}} = \\int_{\\Omega_{e}} \\left[ 2\\mu\\,\\boldsymbol{\\varepsilon}^{\\text{dev}}(\\mathbf{d}) : \\delta\\boldsymbol{\\varepsilon}^{\\text{dev}}(\\delta\\mathbf{d}) + \\kappa\\left(\\operatorname{tr}\\boldsymbol{\\varepsilon}(\\mathbf{d}) - 3\\alpha \\Delta T\\right)\\,\\operatorname{tr}\\delta\\boldsymbol{\\varepsilon}(\\delta\\mathbf{d}) \\right]\\mathrm{d}\\Omega.\n$$\n\n- 使用 $\\boldsymbol{\\varepsilon}^{h}=\\mathbf{B}\\mathbf{d}$ 和迹算子，确定对切向刚度的单元级偏量和体积贡献，\n$$\n\\mathbf{K}_{uu}^{\\text{dev}} = \\int_{\\Omega_{e}} 2\\mu\\,\\mathbf{B}_{\\text{dev}}^{T}\\mathbf{B}_{\\text{dev}}\\,\\mathrm{d}\\Omega,\\qquad\n\\mathbf{K}_{uu}^{\\text{vol}} = \\int_{\\Omega_{e}} \\kappa\\,\\mathbf{m}(\\mathbf{x})\\,\\mathbf{m}(\\mathbf{x})^{T}\\,\\mathrm{d}\\Omega,\n$$\n其中 $\\mathbf{m}(\\mathbf{x})$ 是与 $\\mathbf{d}$ 缩并后产生 $\\operatorname{tr}\\boldsymbol{\\varepsilon}^{h}(\\mathbf{x})$ 的向量场，$\\mathbf{B}_{\\text{dev}}$ 将 $\\mathbf{d}$ 映射到 $\\boldsymbol{\\varepsilon}^{\\text{dev}}$。解释为什么对于各向同性的 $\\alpha$ 和均匀的 $\\Delta T$，热驱动仅进入体积部分，并给出相应的一致单元热载荷向量。\n\n- 在 $\\kappa \\gg \\mu$ 的极限情况下，论证 $\\mathbf{K}_{uu}^{\\text{vol}}$ 的数值积分方案选择如何决定了施加在离散体积应变 $\\operatorname{tr}\\boldsymbol{\\varepsilon}^{h}(\\mathbf{x})$ 上的独立约束数量。对比对体积项使用完全 $2\\times 2$ Gauss 积分与选择性减缩 $1\\times 1$ Gauss 积分，同时保持 $\\mathbf{K}_{uu}^{\\text{dev}}$ 完全积分。将此与平面应变条件下热驱动体积应变引起的体积自锁机理联系起来。\n\n根据您的推导和论证，选出所有正确的陈述。\n\nA. 在平面应变、均匀 $\\Delta T$ 和无牵引力边界条件下的双线性四边形单元中，当 $\\kappa \\gg \\mu$ 时，对 $\\mathbf{K}_{uu}^{\\text{vol}}$ 进行完全 $2\\times 2$ 积分会在四个 Gauss 点上施加条件 $\\operatorname{tr}\\boldsymbol{\\varepsilon}^{h} \\approx 3\\alpha\\Delta T$，这会过度约束双线性场并产生体积自锁。选择性 $1\\times 1$ 积分仅施加单元平均体积应变约束，从而使得热驱动的体积应变能够被表示出来，而不会产生伪刚化。\n\nB. 在 $\\kappa \\gg \\mu$ 的情况下，自锁主要由偏量刚度引起，因此对于具有大热体积应变的热力学问题，适当的补救措施是降低 $\\mathbf{K}_{uu}^{\\text{dev}}$ 的积分阶数（同时保持 $\\mathbf{K}_{uu}^{\\text{vol}}$ 完全积分）。\n\nC. 对体积项进行选择性减缩积分，在主阶上等效于一种 $\\bar{\\mathbf{B}}$ 型投影，该投影将 $\\operatorname{tr}\\boldsymbol{\\varepsilon}^{h}$ 替换为其单元平均值。因此，当 $\\kappa/\\mu \\to \\infty$ 时，在均匀 $\\Delta T$ 下计算出的静水压力会趋近于正确的有界连续介质值，而不是伪发散。\n\nD. 在均匀 $\\Delta T$ 下的双线性单元中，即使 $\\mathbf{K}_{uu}^{\\text{dev}}$ 是完全积分的，仅对 $\\mathbf{K}_{uu}^{\\text{vol}}$ 使用减缩积分也必然会引入沙漏模式和秩亏。\n\n选择所有适用项。", "solution": "首先将验证问题陈述，然后基于连续介质力学和有限元法的基本原理推导解决方案。\n\n### 问题验证\n\n**第1步：提取已知条件**\n-   **理论**：小应变、线性、各向同性热弹性。\n-   **材料常数**：Lamé 参数 $\\lambda$ 和 $\\mu$；体积模量 $\\kappa = \\lambda + \\frac{2}{3}\\mu$；热膨胀系数 $\\alpha$。\n-   **热载荷**：均匀绝对温度变化 $\\Delta T$。\n-   **本构律**：Cauchy 应力 $\\boldsymbol{\\sigma} = 2\\mu\\,\\boldsymbol{\\varepsilon}^{\\text{dev}} + \\kappa\\left(\\operatorname{tr}\\boldsymbol{\\varepsilon} - 3\\alpha \\Delta T\\right)\\mathbf{I}$，其中偏应变为 $\\boldsymbol{\\varepsilon}^{\\text{dev}} = \\boldsymbol{\\varepsilon} - \\frac{1}{3}(\\operatorname{tr}\\boldsymbol{\\varepsilon})\\mathbf{I}$。\n-   **运动学**：$x$-$y$ 平面内的平面应变。\n-   **有限元离散化**：一个单独的等参双线性四边形 ($Q4$) 单元，采用 $C^{0}$ 位移插值 $\\mathbf{u}^{h}(\\mathbf{x}) = \\mathbf{N}(\\mathbf{x})\\,\\mathbf{d}$ 和应变 $\\boldsymbol{\\varepsilon}^{h} = \\mathbf{B}(\\mathbf{x})\\,\\mathbf{d}$。\n-   **边界条件**：无牵引力，施加最小约束以防止刚体运动。\n-   **目标**：分析单元级切向刚度 $\\mathbf{K}_{uu}$ 以及热载荷下的体积自锁现象。\n\n**第2步：使用提取的已知条件进行验证**\n问题陈述在科学上基于标准线性热弹性和有限元理论。本构律是偏量和体积分量的标准表示法。将力学响应分解为这些部分是固体力学的基石。平面应变、双线性插值和数值积分的概念是计算力学的基础。用低阶单元模拟近不可压缩材料时出现的体积自锁现象是一个经典的、适定的主题。该问题是自洽的，提供了进行所需概念推导的所有必要定义和背景。没有科学缺陷、歧义或矛盾。\n\n**第3步：结论和行动**\n问题是有效的。可以进行严谨的分析。\n\n### 推导与论证\n\n按照指示，我们从第一性原理出发，推导所需的关系。\n\n**1. 内虚功表达式的推导**\n\n内虚功 $\\delta W_{\\text{int}}$ 是应变能对位移场的变分，表示为应力在虚应变场 $\\delta\\boldsymbol{\\varepsilon}$ 上所做的功：\n$$\n\\delta W_{\\text{int}} = \\int_{\\Omega_{e}} \\boldsymbol{\\sigma} : \\delta\\boldsymbol{\\varepsilon} \\, \\mathrm{d}\\Omega\n$$\n应力张量 $\\boldsymbol{\\sigma}$ 和虚应变张量 $\\delta\\boldsymbol{\\varepsilon}$ 可以加法分解为其偏量部分和体积（球量）部分：\n$$\n\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\text{dev}} + \\frac{1}{3}(\\operatorname{tr}\\boldsymbol{\\sigma})\\mathbf{I}\n$$\n$$\n\\delta\\boldsymbol{\\varepsilon} = \\delta\\boldsymbol{\\varepsilon}^{\\text{dev}} + \\frac{1}{3}(\\operatorname{tr}\\delta\\boldsymbol{\\varepsilon})\\mathbf{I}\n$$\n偏张量和球张量的双点积为零。因此，乘积 $\\boldsymbol{\\sigma} : \\delta\\boldsymbol{\\varepsilon}$ 简化为：\n$$\n\\boldsymbol{\\sigma} : \\delta\\boldsymbol{\\varepsilon} = \\boldsymbol{\\sigma}^{\\text{dev}} : \\delta\\boldsymbol{\\varepsilon}^{\\text{dev}} + \\frac{1}{9}(\\operatorname{tr}\\boldsymbol{\\sigma})(\\operatorname{tr}\\delta\\boldsymbol{\\varepsilon})(\\mathbf{I}:\\mathbf{I})\n$$\n假设在三维背景下，$\\mathbf{I}:\\mathbf{I} = 3$，则上式变为：\n$$\n\\boldsymbol{\\sigma} : \\delta\\boldsymbol{\\varepsilon} = \\boldsymbol{\\sigma}^{\\text{dev}} : \\delta\\boldsymbol{\\varepsilon}^{\\text{dev}} + \\frac{1}{3}(\\operatorname{tr}\\boldsymbol{\\sigma})(\\operatorname{tr}\\delta\\boldsymbol{\\varepsilon})\n$$\n给定的本构律为 $\\boldsymbol{\\sigma} = 2\\mu\\,\\boldsymbol{\\varepsilon}^{\\text{dev}} + \\kappa\\left(\\operatorname{tr}\\boldsymbol{\\varepsilon} - 3\\alpha \\Delta T\\right)\\mathbf{I}$。由此，我们确定偏应力为 $\\boldsymbol{\\sigma}^{\\text{dev}} = 2\\mu\\,\\boldsymbol{\\varepsilon}^{\\text{dev}}$，应力迹为 $\\operatorname{tr}\\boldsymbol{\\sigma} = 3\\kappa\\left(\\operatorname{tr}\\boldsymbol{\\varepsilon} - 3\\alpha \\Delta T\\right)$。将这些代入 $\\boldsymbol{\\sigma} : \\delta\\boldsymbol{\\varepsilon}$ 的表达式中，得到：\n$$\n\\boldsymbol{\\sigma} : \\delta\\boldsymbol{\\varepsilon} = (2\\mu\\,\\boldsymbol{\\varepsilon}^{\\text{dev}}) : \\delta\\boldsymbol{\\varepsilon}^{\\text{dev}} + \\frac{1}{3}\\left[3\\kappa\\left(\\operatorname{tr}\\boldsymbol{\\varepsilon} - 3\\alpha \\Delta T\\right)\\right](\\operatorname{tr}\\delta\\boldsymbol{\\varepsilon})\n$$\n$$\n\\boldsymbol{\\sigma} : \\delta\\boldsymbol{\\varepsilon} = 2\\mu\\,\\boldsymbol{\\varepsilon}^{\\text{dev}} : \\delta\\boldsymbol{\\varepsilon}^{\\text{dev}} + \\kappa\\left(\\operatorname{tr}\\boldsymbol{\\varepsilon} - 3\\alpha \\Delta T\\right)\\,\\operatorname{tr}\\delta\\boldsymbol{\\varepsilon}\n$$\n偏应变的变分 $\\delta(\\boldsymbol{\\varepsilon}^{\\text{dev}})$ 记作 $\\delta\\boldsymbol{\\varepsilon}^{\\text{dev}}$。代入有限元近似 $\\boldsymbol{\\varepsilon}(\\mathbf{d})$ 和 $\\delta\\boldsymbol{\\varepsilon}(\\delta\\mathbf{d})$，我们对单元体积 $\\Omega_e$ 进行积分，得到所要求的内虚功：\n$$\n\\delta W_{\\text{int}} = \\int_{\\Omega_{e}} \\left[ 2\\mu\\,\\boldsymbol{\\varepsilon}^{\\text{dev}}(\\mathbf{d}) : \\delta\\boldsymbol{\\varepsilon}^{\\text{dev}}(\\delta\\mathbf{d}) + \\kappa\\left(\\operatorname{tr}\\boldsymbol{\\varepsilon}(\\mathbf{d}) - 3\\alpha \\Delta T\\right)\\,\\operatorname{tr}\\delta\\boldsymbol{\\varepsilon}(\\delta\\mathbf{d}) \\right]\\mathrm{d}\\Omega\n$$\n这展示了内虚功向偏量和体积贡献的自然分解。\n\n**2. 单元刚度和热载荷向量**\n\n切向刚度矩阵 $\\mathbf{K}_{uu}$ 是通过取内力向量的方向导数得到的，这等效于内能泛函的二阶变分。从 $\\delta W_{\\text{int}}$ 的表达式中，我们可以对位移向量 $\\mathbf{d}$ 进行线性化。关于位移变分的二次项对切向刚度有贡献。\n$$\n\\delta^2 W_{\\text{int}} = \\int_{\\Omega_{e}} \\left[ 2\\mu\\,\\delta\\boldsymbol{\\varepsilon}^{\\text{dev}} : \\delta\\boldsymbol{\\varepsilon}^{\\text{dev}} + \\kappa\\,\\operatorname{tr}\\delta\\boldsymbol{\\varepsilon}\\,\\operatorname{tr}\\delta\\boldsymbol{\\varepsilon} \\right]\\mathrm{d}\\Omega\n$$\n离散自由度 $\\mathbf{d}$ 与应变场之间的关系由 $\\boldsymbol{\\varepsilon}^h = \\mathbf{B}\\mathbf{d}$ 给出。应变的迹为 $\\operatorname{tr}\\boldsymbol{\\varepsilon}^h(\\mathbf{x}) = \\mathbf{m}(\\mathbf{x})^T\\mathbf{d}$，其中 $\\mathbf{m}(\\mathbf{x})^T$ 由 $\\mathbf{B}(\\mathbf{x})$ 的相应分量构成。偏应变通过另一个算子 $\\mathbf{B}_{\\text{dev}}$ 从 $\\mathbf{d}$ 映射而来。\n\n对刚度的体积贡献由第二项推导得出：\n$$\n\\delta^2 W_{\\text{int}}^{\\text{vol}} = \\int_{\\Omega_{e}} \\kappa \\left( \\operatorname{tr}\\delta\\boldsymbol{\\varepsilon} \\right)^2 \\mathrm{d}\\Omega = \\int_{\\Omega_{e}} \\kappa (\\mathbf{m}^T \\delta\\mathbf{d})^2 \\mathrm{d}\\Omega = \\delta\\mathbf{d}^T \\left( \\int_{\\Omega_e} \\kappa\\,\\mathbf{m}\\,\\mathbf{m}^T \\mathrm{d}\\Omega \\right) \\delta\\mathbf{d}\n$$\n因此，$\\mathbf{K}_{uu}^{\\text{vol}} = \\int_{\\Omega_{e}} \\kappa\\,\\mathbf{m}(\\mathbf{x})\\,\\mathbf{m}(\\mathbf{x})^{T}\\,\\mathrm{d}\\Omega$。\n\n偏量贡献同样由第一项推导得出：\n$$\n\\delta^2 W_{\\text{int}}^{\\text{dev}} = \\int_{\\Omega_{e}} 2\\mu\\,\\delta\\boldsymbol{\\varepsilon}^{\\text{dev}} : \\delta\\boldsymbol{\\varepsilon}^{\\text{dev}} \\mathrm{d}\\Omega = \\delta\\mathbf{d}^T \\left( \\int_{\\Omega_e} 2\\mu\\,\\mathbf{B}_{\\text{dev}}^{T}\\mathbf{B}_{\\text{dev}}\\,\\mathrm{d}\\Omega \\right) \\delta\\mathbf{d}\n$$\n因此，$\\mathbf{K}_{uu}^{\\text{dev}} = \\int_{\\Omega_{e}} 2\\mu\\,\\mathbf{B}_{\\text{dev}}^{T}\\mathbf{B}_{\\text{dev}}\\,\\mathrm{d}\\Omega$。\n\n对于各向同性材料，热载荷仅进入体积部分，因为热应变张量 $\\boldsymbol{\\varepsilon}^{th} = \\alpha\\Delta T \\mathbf{I}$ 是纯球量的。其偏量部分为零。应力由弹性应变 $\\boldsymbol{\\varepsilon}^e = \\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{th}$ 产生。偏应力为 $\\boldsymbol{\\sigma}^{\\text{dev}} = 2\\mu(\\boldsymbol{\\varepsilon}^e)^{\\text{dev}} = 2\\mu(\\boldsymbol{\\varepsilon}^{\\text{dev}} - (\\boldsymbol{\\varepsilon}^{th})^{\\text{dev}}) = 2\\mu\\boldsymbol{\\varepsilon}^{\\text{dev}}$，它独立于 $\\Delta T$。然而，体积应力取决于 $\\operatorname{tr}\\boldsymbol{\\varepsilon}^e = \\operatorname{tr}\\boldsymbol{\\varepsilon} - \\operatorname{tr}\\boldsymbol{\\varepsilon}^{th} = \\operatorname{tr}\\boldsymbol{\\varepsilon} - 3\\alpha\\Delta T$。\n\n一致热载荷向量 $\\mathbf{F}_{\\text{th}}$ 是从 $\\delta W_{\\text{int}}$ 中对 $\\delta\\mathbf{d}$ 线性但独立于 $\\mathbf{d}$ 的项推导出来的。该项为 $\\int_{\\Omega_e} \\kappa(-3\\alpha\\Delta T) \\operatorname{tr}\\delta\\boldsymbol{\\varepsilon}\\,\\mathrm{d}\\Omega$。\n$$\n\\delta W_{\\text{th}} = \\int_{\\Omega_e} -3\\kappa\\alpha\\Delta T (\\mathbf{m}^T\\delta\\mathbf{d}) \\mathrm{d}\\Omega = \\delta\\mathbf{d}^T \\left( -\\int_{\\Omega_e} 3\\kappa\\alpha\\Delta T \\mathbf{m}(\\mathbf{x})\\,\\mathrm{d}\\Omega \\right)\n$$\n内力向量包含一个热分量 $\\mathbf{F}_{\\text{th,int}} = -\\int 3\\kappa\\alpha\\Delta T \\mathbf{m}\\,\\mathrm{d}\\Omega$。施加在外部的等效节点力向量为 $\\mathbf{F}_{\\text{th}} = - \\mathbf{F}_{\\text{th,int}} = \\int_{\\Omega_e} 3\\kappa\\alpha\\Delta T \\mathbf{m}(\\mathbf{x}) \\mathrm{d}\\Omega$。\n\n**3. 体积自锁与数值积分**\n\n在近不可压缩极限下，$\\kappa \\gg \\mu$，体积刚度 $\\mathbf{K}_{uu}^{\\text{vol}}$ 在总刚度 $\\mathbf{K}_{uu}$ 中占主导地位。控制离散方程 $\\mathbf{K}_{uu}\\mathbf{d} = \\mathbf{F}_{\\text{th}}$ 变成一种约束的罚函数法施加。两边除以 $\\kappa$：\n$$\n\\left(\\frac{1}{\\kappa}\\mathbf{K}_{uu}^{\\text{dev}} + \\int_{\\Omega_e} \\mathbf{m}\\mathbf{m}^T \\mathrm{d}\\Omega \\right)\\mathbf{d} \\approx \\int_{\\Omega_e} 3\\alpha\\Delta T \\mathbf{m}\\,\\mathrm{d}\\Omega\n$$\n当 $\\kappa \\to \\infty$ 时，这施加了约束 $\\left(\\int \\mathbf{m}\\mathbf{m}^T \\mathrm{d}\\Omega\\right)\\mathbf{d} = \\int 3\\alpha\\Delta T\\mathbf{m}\\,\\mathrm{d}\\Omega$。\n\n使用具有 $N_q$ 个积分点的数值积分，这变为：\n$$\n\\left( \\sum_{i=1}^{N_q} w_i J_i \\mathbf{m}_i \\mathbf{m}_i^T \\right)\\mathbf{d} \\approx \\sum_{i=1}^{N_q} w_i J_i (3\\alpha\\Delta T)\\mathbf{m}_i\n$$\n这是对条件 $\\mathbf{m}_i^T\\mathbf{d} = 3\\alpha\\Delta T$（即 $\\operatorname{tr}\\boldsymbol{\\varepsilon}^h(\\boldsymbol{\\xi}_i) = 3\\alpha\\Delta T$）在 $N_q$ 个积分点 $\\boldsymbol{\\xi}_i$ 上的加权最小二乘施加。\n\n对于双线性四边形 ($Q4$) 单元，位移场分量是坐标的双线性函数，例如 $u_x = c_1+c_2x+c_3y+c_4xy$。应变分量 $\\varepsilon_{xx}=\\partial u_x/\\partial x$ 和 $\\varepsilon_{yy}=\\partial u_y/\\partial y$ 是一个坐标的线性函数。因此，体积应变 $\\operatorname{tr}\\boldsymbol{\\varepsilon}^h = \\varepsilon_{xx}+\\varepsilon_{yy}$ 是位置的一般线性函数，例如 $A+Bx+Cy$。该场由 $3$ 个独立参数描述。\n\n-   **完全 ($2\\times 2$) 积分**：有 $N_q=4$ 个 Gauss 点。这在仅有 $3$ 个自由度的函数空间上施加了 $4$ 个独立约束 $\\operatorname{tr}\\boldsymbol{\\varepsilon}^h(\\boldsymbol{\\xi}_i) = 3\\alpha\\Delta T$（对于 $i=1..4$）。这会过度约束单元。唯一可能的解是平凡解，即体积应变场的线性部分为零，迫使其为常数。这阻止了单元表示其本应能够表示的变形模式，导致一种人为的刚性响应，称为**体积自锁**。\n\n-   **选择性减缩 ($1\\times 1$) 积分**：在单元中心 $(\\boldsymbol{\\xi}_1 = \\mathbf{0})$ 只有一个 $N_q=1$ 的 Gauss 点。这施加了一个单一约束：$\\operatorname{tr}\\boldsymbol{\\varepsilon}^h(\\mathbf{0}) = 3\\alpha\\Delta T$。对于矩形/平行四边形域上的线性函数，其中心点的值等于其在域上的平均值。因此，这个单一约束施加了单元平均体积应变与热体积应变相匹配的条件：$\\frac{1}{V_e}\\int_{\\Omega_e} \\operatorname{tr}\\boldsymbol{\\varepsilon}^h \\mathrm{d}\\Omega = 3\\alpha\\Delta T$。这是对 $3$ 参数体积应变场施加的一个单一的、物理上合理的约束，它不会过度约束单元，并允许其正确变形而不会产生伪刚化。\n\n### 逐项分析\n\n**A. 在平面应变、均匀 $\\Delta T$ 和无牵引力边界条件下的双线性四边形单元中，当 $\\kappa \\gg \\mu$ 时，对 $\\mathbf{K}_{uu}^{\\text{vol}}$ 进行完全 $2\\times 2$ 积分会在四个 Gauss 点上施加条件 $\\operatorname{tr}\\boldsymbol{\\varepsilon}^{h} \\approx 3\\alpha\\Delta T$，这会过度约束双线性场并产生体积自锁。选择性 $1\\times 1$ 积分仅施加单元平均体积应变约束，从而使得热驱动的体积应变能够被表示出来，而不会产生伪刚化。**\n\n这个陈述是对上述分析的精确和准确的总结。完全积分导致对一个 $3$ 自由度场施加 $4$ 个约束，引起自锁。减缩积分施加一个单一的、有意义的平均约束，从而解决了这个问题。\n**结论：正确。**\n\n**B. 在 $\\kappa \\gg \\mu$ 的情况下，自锁主要由偏量刚度引起，因此对于具有大热体积应变的热力学问题，适当的补救措施是降低 $\\mathbf{K}_{uu}^{\\text{dev}}$ 的积分阶数（同时保持 $\\mathbf{K}_{uu}^{\\text{vol}}$ 完全积分）。**\n\n这个陈述有根本性错误。在大体积模量 $\\kappa$ 的极限下发生的自锁称为体积自锁，是由体积刚度项引起的，而不是偏量刚度项。补救措施是处理体积项 $\\mathbf{K}_{uu}^{\\text{vol}}$ 的积分。降低偏量项的积分与此问题无关，它解决的是不同的问题（如剪切自锁），或者可能引入其他病态问题（如沙漏）。\n**结论：不正确。**\n\n**C. 对体积项进行选择性减缩积分，在主阶上等效于一种 $\\bar{\\mathbf{B}}$ 型投影，该投影将 $\\operatorname{tr}\\boldsymbol{\\varepsilon}^{h}$ 替换为其单元平均值。因此，当 $\\kappa/\\mu \\to \\infty$ 时，在均匀 $\\Delta T$ 下计算出的静水压力会趋近于正确的有界连续介质值，而不是伪发散。**\n\n这个陈述是正确的。对于双线性单元，体积应变是线性的，其积分精确等于其中心点（$1\\times1$ Gauss 点）的值乘以面积。这使得选择性减缩积分（SRI）在分析上等效于用其单元平均值替换体积应变场，这种技术被称为 $\\bar{\\mathbf{B}}$ 方法。通过仅在平均意义上满足体积约束，单元避免了伪刚化，使得计算出的应力能够收敛到正确的物理值，而不是表现出大而不符合物理的、自锁特有的振荡。\n**结论：正确。**\n\n**D. 在均匀 $\\Delta T$ 下的双线性单元中，即使 $\\mathbf{K}_{uu}^{\\text{dev}}$ 是完全积分的，仅对 $\\mathbf{K}_{uu}^{\\text{vol}}$ 使用减缩积分也必然会引入沙漏模式和秩亏。**\n\n这个陈述是错误的。当刚度矩阵秩亏时，会出现沙漏模式（伪零能变形模式）。在 $Q4$ 单元中，如果刚度的偏量部分也被欠积分（$1\\times 1$ 积分），就会发生这种情况。然而，在选择性减缩积分中，偏量刚度 $\\mathbf{K}_{uu}^{\\text{dev}}$ 使用 $2\\times 2$ 规则进行完全积分。这为刚度矩阵的偏量部分提供了正确的秩，从而确保总刚度矩阵 $\\mathbf{K}_{uu} = \\mathbf{K}_{uu}^{\\text{dev}} + \\mathbf{K}_{uu}^{\\text{vol}}$ 具有适当的秩，能够抵抗所有非刚体运动模式。该方法专门设计用于在避免沙漏不稳定性的同时解决自锁问题。\n**结论：不正确。**", "answer": "$$\\boxed{AC}$$", "id": "2605832"}]}