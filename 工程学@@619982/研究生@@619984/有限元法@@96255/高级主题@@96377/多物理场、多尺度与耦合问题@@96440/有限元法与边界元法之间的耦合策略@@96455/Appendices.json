{"hands_on_practices": [{"introduction": "第一个实践是进入边界元方法世界的基础踏脚石。我们将直接对单层势进行解析计算，该积分算子代表了边界上源分布的影响。通过这个练习 [@problem_id:2551147]，您将把积分算子的形式化定义与经典势理论中的具体数值联系起来，从而巩固您对边界元方法如何表示物理场的理解。", "problem": "考虑在圆盘内部使用有限元法（FEM）和在外部使用边界元法（BEM）对二维拉普拉斯方程进行的非重叠耦合。设界面为圆周 $\\Gamma = \\{ \\mathbf{y} \\in \\mathbb{R}^{2} : |\\mathbf{y}| = R \\}$，其中 $R>0$。在对称的FEM–BEM耦合中，外部的调和势由支集在 $\\Gamma$ 上的密度为 $\\sigma$ 的单层拟设表示。假设单层密度为常数 $\\sigma(\\mathbf{y}) = \\sigma_{0}$，其中 $\\sigma_{0}$ 是一个给定的常数。\n\n在点 $\\mathbf{x} \\in \\mathbb{R}^{2}$ 处的单层势由二维拉普拉斯算子的基本解定义为\n$$\n\\mathcal{S}\\sigma(\\mathbf{x}) \\equiv \\int_{\\Gamma} G(\\mathbf{x},\\mathbf{y}) \\, \\sigma(\\mathbf{y}) \\, \\mathrm{d}s_{\\mathbf{y}}, \\quad \\text{其中} \\quad G(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi} \\ln |\\mathbf{x} - \\mathbf{y}|.\n$$\n\n根据经典势理论，由圆周上均匀分布的边界源产生的势是调和的，跨越 $\\Gamma$ 是连续的，并且在整个内部区域 $\\{ \\mathbf{x} : |\\mathbf{x}| < R \\}$ 上是一个常数。\n\n计算 $\\mathcal{S}\\sigma(\\mathbf{0})$，并将其与经典势理论预测的解析内部值进行比较。请以 $\\sigma_{0}$ 和 $R$ 的封闭形式表达式给出您的最终答案。不需要单位。最终答案必须是单一的解析表达式。", "solution": "该问题要求计算单层势 $\\mathcal{S}\\sigma(\\mathbf{x})$ 在原点 $\\mathbf{x} = \\mathbf{0}$ 处的值。该势是由半径为 $R$ 的圆形边界 $\\Gamma$ 上的恒定密度分布 $\\sigma(\\mathbf{y}) = \\sigma_{0}$ 生成的。\n\n单层势定义为：\n$$\n\\mathcal{S}\\sigma(\\mathbf{x}) = \\int_{\\Gamma} G(\\mathbf{x},\\mathbf{y}) \\, \\sigma(\\mathbf{y}) \\, \\mathrm{d}s_{\\mathbf{y}}\n$$\n二维拉普拉斯算子的基本解由下式给出：\n$$\nG(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi} \\ln |\\mathbf{x} - \\mathbf{y}|\n$$\n我们必须在特定点 $\\mathbf{x} = \\mathbf{0}$ 处计算此势：\n$$\n\\mathcal{S}\\sigma(\\mathbf{0}) = \\int_{\\Gamma} G(\\mathbf{0},\\mathbf{y}) \\, \\sigma(\\mathbf{y}) \\, \\mathrm{d}s_{\\mathbf{y}}\n$$\n代入核函数 $G(\\mathbf{0},\\mathbf{y})$ 和常数密度 $\\sigma(\\mathbf{y}) = \\sigma_{0}$ 的表达式：\n$$\n\\mathcal{S}\\sigma(\\mathbf{0}) = \\int_{\\Gamma} \\left( -\\frac{1}{2\\pi} \\ln |\\mathbf{0} - \\mathbf{y}| \\right) \\sigma_{0} \\, \\mathrm{d}s_{\\mathbf{y}}\n$$\n项 $|\\mathbf{0} - \\mathbf{y}|$ 简化为 $|\\mathbf{y}|$。由于密度 $\\sigma_{0}$ 和因子 $-\\frac{1}{2\\pi}$ 是常数，可以把它们提到积分号外：\n$$\n\\mathcal{S}\\sigma(\\mathbf{0}) = -\\frac{\\sigma_{0}}{2\\pi} \\int_{\\Gamma} \\ln |\\mathbf{y}| \\, \\mathrm{d}s_{\\mathbf{y}}\n$$\n积分是在边界 $\\Gamma$ 上进行的，$\\Gamma$ 是一个由 $\\{ \\mathbf{y} \\in \\mathbb{R}^{2} : |\\mathbf{y}| = R \\}$ 定义的圆周。对于此圆周 $\\Gamma$ 上的任意一点 $\\mathbf{y}$，其模长是常数，等于半径 $R$。因此，对所有 $\\mathbf{y} \\in \\Gamma$ 都有 $|\\mathbf{y}| = R$。\n\n我们可以将其代入被积函数中：\n$$\n\\mathcal{S}\\sigma(\\mathbf{0}) = -\\frac{\\sigma_{0}}{2\\pi} \\int_{\\Gamma} \\ln(R) \\, \\mathrm{d}s_{\\mathbf{y}}\n$$\n项 $\\ln(R)$ 对于积分变量 $\\mathbf{y}$ 也是一个常数，所以也可以移到积分号外：\n$$\n\\mathcal{S}\\sigma(\\mathbf{0}) = -\\frac{\\sigma_{0} \\ln(R)}{2\\pi} \\int_{\\Gamma} \\mathrm{d}s_{\\mathbf{y}}\n$$\n剩下的积分 $\\int_{\\Gamma} \\mathrm{d}s_{\\mathbf{y}}$ 表示边界 $\\Gamma$ 的总弧长。由于 $\\Gamma$ 是一个半径为 $R$ 的圆周，其周长为 $2\\pi R$。\n$$\n\\int_{\\Gamma} \\mathrm{d}s_{\\mathbf{y}} = \\text{Circumference of } \\Gamma = 2\\pi R\n$$\n将此结果代回到我们的势表达式中：\n$$\n\\mathcal{S}\\sigma(\\mathbf{0}) = -\\frac{\\sigma_{0} \\ln(R)}{2\\pi} (2\\pi R)\n$$\n通过消去 $2\\pi$ 项来简化表达式，我们得到原点处势的最终结果：\n$$\n\\mathcal{S}\\sigma(\\mathbf{0}) = - \\sigma_{0} R \\ln(R)\n$$\n问题陈述指出，经典势理论预测在圆盘内部的势值是恒定的。我们在原点 $\\mathbf{x}=\\mathbf{0}$ 处的计算确定了这个常数值。这个结果与调和函数的已知性质一致；由均匀圆形源产生的势在圆内部确实是恒定的。该计算以给定的参数 $\\sigma_{0}$ 和 $R$ 的形式提供了这个恒定势的显式值。", "answer": "$$\n\\boxed{- \\sigma_{0} R \\ln(R)}\n$$", "id": "2551147"}, {"introduction": "在积分算子概念的基础上，下一个实践将指导您构建一个完整的、离散化的有限元-边界元耦合系统。您将从一个模型问题的弱形式出发，应用有限元和边界元基函数，推导出这些耦合方法特有的分块矩阵结构。这个练习 [@problem_id:2551154] 将为您提供宝贵的实践经验，帮助您将连续的数学理论转化为可用于计算的具体代数系统。", "problem": "考虑二维空间中的标量拉普拉斯传输问题。设内部计算域为 $\\Omega \\subset \\mathbb{R}^{2}$，它是一个顶点为 $(0,0)$、$(1,0)$ 和 $(0,1)$ 的直角三角形。将斜边记为 $\\Gamma := \\{(x,y) \\in \\partial \\Omega : x+y=1,\\ x \\ge 0,\\ y \\ge 0\\}$。假设在三角形的两条直角边上，即在 $\\partial \\Omega \\setminus \\Gamma$ 上，施加齐次狄利克雷边界条件，并通过单层势与跨越 $\\Gamma$ 的无界拉普拉斯外部问题耦合。该单层势涉及二维拉普拉斯基本解 $G(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi}\\ln|\\mathbf{x}-\\mathbf{y}|$。\n\n您将在以下设定中构建一个有限元方法-边界元方法 (FEM–BEM) 耦合：\n\n- 在 $\\Omega$ 上使用与单个三角形单元相关的协调分片仿射 ($P_{1}$) 有限元空间，其节点基函数为 $\\{\\varphi_{1},\\varphi_{2},\\varphi_{3}\\}$，分别对应于顶点 $(0,0)$、$(1,0)$ 和 $(0,1)$。\n\n- 在 $\\Gamma$ 上使用分片常数边界元空间，该空间由单个单元构成，其基函数 $\\psi_{1}$ 在 $\\Gamma$ 上恒等于 $1$。\n\n采用以下弱耦合策略：引入一个未知密度 $\\lambda \\in H^{-1/2}(\\Gamma)$，使得 $\\Gamma$ 上的外部势由单层势表示，并通过弱约束（即内部迹等于单层边界迹）来施加传输条件，也即在变分意义上强制 $\\gamma u - V \\lambda = 0$ 在 $\\Gamma$ 上成立。其中 $\\gamma$ 是内部狄利克雷迹，而 $V$ 是边界单层算子，定义为 $(V\\lambda)(\\mathbf{x}) = \\int_{\\Gamma} G(\\mathbf{x},\\mathbf{y})\\lambda(\\mathbf{y})\\,\\mathrm{d}s_{\\mathbf{y}}$（对于 $\\mathbf{x} \\in \\Gamma$）。\n\n从 Green 恒等式和 $\\Omega$ 中拉普拉斯方程的标准变分形式出发，结合上述对传输条件的弱施加方式，推导耦合的 FEM–BEM 未知量 $(u_{h},\\lambda_{h})$ 的离散鞍点系统，其形式为\n$$\n\\begin{pmatrix}\nA & B^{\\top} \\\\\nB & -V\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{u} \\\\\n\\boldsymbol{\\lambda}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{f} \\\\\n\\mathbf{0}\n\\end{pmatrix},\n$$\n并根据其底层的双线性形式来确定每个矩阵块：\n- 内部刚度矩阵 $A$，\n- 由 $\\Gamma$ 上的迹项产生的 FEM–BEM 耦合矩阵 $B$，\n- 以及边界单层矩阵 $V$。\n\n请用包含基函数 $\\{\\varphi_{i}\\}$、$\\{\\psi_{1}\\}$ 及核函数 $G$ 的积分显式地写出这些矩阵块。\n\n最后，对于给定的单单元几何形状，计算单层矩阵 $V$ 的唯一元素，即\n$$\nV_{11} \\;=\\; \\int_{\\Gamma}\\int_{\\Gamma} G(\\mathbf{x},\\mathbf{y})\\,\\psi_{1}(\\mathbf{x})\\,\\psi_{1}(\\mathbf{y})\\,\\mathrm{d}s_{\\mathbf{x}}\\,\\mathrm{d}s_{\\mathbf{y}},\n$$\n的闭式解。最终答案可以用 $\\pi$ 和自然对数表示。请仅提供此 $V_{11}$ 作为您的最终答案，形式为一个闭式解析表达式（不要进行数值取整）。", "solution": "出发点是内部区域中带有齐次源项的拉普拉斯方程，\n$$\n-\\Delta u = 0 \\quad \\text{in } \\Omega,\n$$\n以及在 $\\partial \\Omega \\setminus \\Gamma$ 上的齐次狄利克雷边界条件。在边界 $\\Gamma$ 上，我们通过单层势表示与外部拉普拉斯问题耦合。传输条件是内部势的迹等于由单层势引起的外部迹，即在 $\\Gamma$ 上有 $\\gamma u = V\\lambda$，其中单层算子 $V$ 定义为\n$$\n(V\\lambda)(\\mathbf{x}) = \\int_{\\Gamma} G(\\mathbf{x},\\mathbf{y})\\,\\lambda(\\mathbf{y})\\,\\mathrm{d}s_{\\mathbf{y}}, \\quad G(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi}\\ln|\\mathbf{x}-\\mathbf{y}|.\n$$\n我们通过使用边界测试函数 $\\mu$ 进行测试来弱施加此约束，并要求\n$$\n\\langle \\mu,\\gamma u - V\\lambda \\rangle_{\\Gamma} = 0.\n$$\n\n为了推导耦合变分形式，令 $V(\\Omega)$ 表示 $H^{1}(\\Omega)$ 中在 $\\partial \\Omega \\setminus \\Gamma$ 上为零的函数所构成的子空间。取 $v \\in V(\\Omega)$ 作为内部测试函数，$\\mu \\in H^{-1/2}(\\Gamma)$（实践中为离散迹空间）作为边界测试函数，则内部弱形式（根据 Green 恒等式）为\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v\\,\\mathrm{d}x = 0 \\quad \\text{for all } v \\in V(\\Omega),\n$$\n而耦合约束为\n$$\n\\int_{\\Gamma} \\mu\\,\\gamma u\\,\\mathrm{d}s - \\int_{\\Gamma} \\mu\\,(V\\lambda)\\,\\mathrm{d}s = 0 \\quad \\text{for all } \\mu.\n$$\n结合起来，全局变分问题是：求 $(u,\\lambda) \\in V(\\Omega) \\times H^{-1/2}(\\Gamma)$，使得\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v\\,\\mathrm{d}x \\;+\\; \\int_{\\Gamma} \\mu\\,\\gamma u\\,\\mathrm{d}s \\;-\\; \\int_{\\Gamma} \\mu\\,(V\\lambda)\\,\\mathrm{d}s \\;=\\; 0\n$$\n对所有 $(v,\\mu) \\in V(\\Omega) \\times H^{-1/2}(\\Gamma)$ 成立。如果存在内部强迫项 $f \\in H^{-1}(\\Omega)$，则等式右端将是 $\\langle f, v\\rangle$，但此处为 $0$。\n\n我们现在使用以下方法进行离散化：\n- 在单个三角形上使用 $P_{1}$ 有限元空间，其节点基为 $\\{\\varphi_{1},\\varphi_{2},\\varphi_{3}\\}$，对应于顶点 $(0,0)$、$(1,0)$ 和 $(0,1)$，\n- 在 $\\Gamma$ 上使用分片常数边界元空间，其基函数为 $\\psi_{1}$，其中对于 $x \\in \\Gamma$ 有 $\\psi_{1}(x) \\equiv 1$。\n\n写出 $u_{h} = \\sum_{j=1}^{3} \\mathbf{u}_{j}\\,\\varphi_{j}$ 和 $\\lambda_{h} = \\boldsymbol{\\lambda}_{1}\\,\\psi_{1}$。用 $v_{h} = \\varphi_{i}$ 和 $\\mu_{h} = \\psi_{1}$ 进行测试，得到分块形式的离散系统：\n$$\n\\begin{pmatrix}\nA & B^{\\top} \\\\\nB & -V\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{u} \\\\\n\\boldsymbol{\\lambda}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{f} \\\\\n\\mathbf{0}\n\\end{pmatrix},\n$$\n其矩阵块由以下双线性形式定义：\n- 内部刚度矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$，其元素为\n$$\nA_{ij} = \\int_{\\Omega} \\nabla \\varphi_{i} \\cdot \\nabla \\varphi_{j}\\,\\mathrm{d}x.\n$$\n- FEM–BEM 耦合矩阵 $B \\in \\mathbb{R}^{1 \\times 3}$，其元素为\n$$\nB_{1j} = \\int_{\\Gamma} \\psi_{1}\\,(\\gamma \\varphi_{j})\\,\\mathrm{d}s = \\int_{\\Gamma} \\varphi_{j}\\,\\mathrm{d}s,\n$$\n因为在 $\\Gamma$ 上 $\\psi_{1} \\equiv 1$。\n- 单层矩阵 $V \\in \\mathbb{R}^{1 \\times 1}$，其元素为\n$$\nV_{11} = \\int_{\\Gamma}\\int_{\\Gamma} G(\\mathbf{x},\\mathbf{y})\\,\\psi_{1}(\\mathbf{x})\\,\\psi_{1}(\\mathbf{y})\\,\\mathrm{d}s_{\\mathbf{x}}\\,\\mathrm{d}s_{\\mathbf{y}} = \\int_{\\Gamma}\\int_{\\Gamma} G(\\mathbf{x},\\mathbf{y})\\,\\mathrm{d}s_{\\mathbf{x}}\\,\\mathrm{d}s_{\\mathbf{y}}.\n$$\n\n我们确定所需的几何量。斜边 $\\Gamma$ 是从 $(1,0)$ 到 $(0,1)$ 的线段，其长度为\n$$\nL = \\sqrt{(1-0)^{2} + (0-1)^{2}} = \\sqrt{2}.\n$$\n由于边界元空间在 $\\Gamma$ 上是常数，且核函数 $G(\\mathbf{x},\\mathbf{y})$ 仅依赖于欧几里得距离 $|\\mathbf{x}-\\mathbf{y}|$，我们可以用弧长来参数化 $\\Gamma$。设 $s \\in [0,L]$ 为沿 $\\Gamma$ 的弧长坐标；同样地，有 $t \\in [0,L]$。于是\n$$\nV_{11} \\;=\\; \\int_{0}^{L}\\int_{0}^{L} G(s,t)\\,\\mathrm{d}t\\,\\mathrm{d}s \\;=\\; -\\frac{1}{2\\pi}\\int_{0}^{L}\\int_{0}^{L} \\ln|s-t|\\,\\mathrm{d}t\\,\\mathrm{d}s.\n$$\n定义\n$$\nI(L) := \\int_{0}^{L}\\int_{0}^{L} \\ln|s-t|\\,\\mathrm{d}t\\,\\mathrm{d}s.\n$$\n我们显式计算 $I(L)$。根据对称性，\n$$\nI(L) = 2\\int_{0}^{L}\\int_{0}^{s} \\ln(s-t)\\,\\mathrm{d}t\\,\\mathrm{d}s.\n$$\n在内层积分中使用换元法 $u = s-t$，其中 $t=0 \\Rightarrow u=s$ 且 $t=s \\Rightarrow u=0$，得到\n$$\nI(L) = 2\\int_{0}^{L}\\left(\\int_{0}^{s} \\ln u\\,\\mathrm{d}u\\right)\\mathrm{d}s.\n$$\n其不定积分为 $\\int \\ln u\\,\\mathrm{d}u = u\\ln u - u$。因此，\n$$\nI(L) = 2\\int_{0}^{L} \\big[s\\ln s - s\\big]\\,\\mathrm{d}s.\n$$\n我们使用 $\\int s\\ln s\\,\\mathrm{d}s = \\frac{s^{2}}{2}\\ln s - \\frac{s^{2}}{4}$ 和 $\\int s\\,\\mathrm{d}s = \\frac{s^{2}}{2}$ 来计算剩余的积分：\n$$\nI(L) = 2\\left[\\left(\\frac{s^{2}}{2}\\ln s - \\frac{s^{2}}{4}\\right) - \\frac{s^{2}}{2}\\right]_{0}^{L}\n= 2\\left[\\frac{s^{2}}{2}\\ln s - \\frac{3}{4}s^{2}\\right]_{0}^{L}.\n$$\n利用 $\\lim_{s\\to 0^{+}} s^{2}\\ln s = 0$，我们得到闭式解\n$$\nI(L) = L^{2}\\ln L - \\frac{3}{2}L^{2}.\n$$\n因此，\n$$\nV_{11} = -\\frac{1}{2\\pi}\\,I(L) \\;=\\; -\\frac{1}{2\\pi}\\left(L^{2}\\ln L - \\frac{3}{2}L^{2}\\right).\n$$\n对于我们的几何形状，$L = \\sqrt{2}$，因此 $L^{2} = 2$ 且 $L^{2}\\ln L = 2\\ln(\\sqrt{2}) = 2\\cdot \\frac{1}{2}\\ln 2 = \\ln 2$。代入可得\n$$\nV_{11} = -\\frac{1}{2\\pi}\\left(\\ln 2 - 3\\right) = \\frac{3 - \\ln 2}{2\\pi}.\n$$\n\n为完整起见，我们还确定耦合矩阵 $B$ 的非零元素。在 $\\Gamma$ 上，节点基函数的迹在端点之间是线性的。具体来说，$\\varphi_{2}$ 在 $(1,0)$ 处为 $1$，在 $(0,1)$ 处为 $0$；$\\varphi_{3}$ 在 $(1,0)$ 处为 $0$，在 $(0,1)$ 处为 $1$；而 $\\varphi_{1}$ 在 $\\Gamma$ 上为零。因此，\n$$\nB_{1,1} = \\int_{\\Gamma} \\varphi_{1}\\,\\mathrm{d}s = 0,\\quad\nB_{1,2} = \\int_{\\Gamma} \\varphi_{2}\\,\\mathrm{d}s = \\frac{L}{2} = \\frac{\\sqrt{2}}{2},\\quad\nB_{1,3} = \\int_{\\Gamma} \\varphi_{3}\\,\\mathrm{d}s = \\frac{L}{2} = \\frac{\\sqrt{2}}{2}.\n$$\n刚度矩阵 $A$ 是映射到 $\\Omega$ 上的参考三角形上的标准 $3\\times 3$ $P_{1}$ 单元刚度矩阵，其元素为 $A_{ij} = \\int_{\\Omega} \\nabla \\varphi_{i}\\cdot \\nabla \\varphi_{j}\\,\\mathrm{d}x$。这些确定工作完成了分块系统的推导和单层矩阵元素的显式计算。所要求的闭式值为 $V_{11} = \\frac{3 - \\ln 2}{2\\pi}$。", "answer": "$$\\boxed{\\frac{3-\\ln 2}{2\\pi}}$$", "id": "2551154"}, {"introduction": "一个形式上正确的公式并不能保证数值方法的稳定性；稳定性是最终离散系统的一个关键属性。最后一个实践将我们的重心从公式构建转移到分析，通过一个数值实验，利用一个简化但功能强大的谱模型来探索一种常见的对称耦合格式的稳定性。通过编写一个简短的程序来计算系统的最小特征值 [@problem_id:2551171]，您将对稳定化参数的作用以及获得一个鲁棒且可靠的数值解所需的条件有切实的理解。", "problem": "考虑在 $\\mathbb{R}^3$ 中的单位球上建模的、一个内部区域与其外部补域之间的拉普拉斯传输问题。设 $\\Omega \\subset \\mathbb{R}^3$ 表示单位球体，$\\Gamma = \\partial \\Omega$ 表示半径为 $1$ 的单位球面。内部场 $u$ 求解 $\\Omega$ 内的拉普拉斯方程，外部场 $u^{\\mathrm{ext}}$ 求解 $\\mathbb{R}^3 \\setminus \\overline{\\Omega}$ 内的拉普拉斯方程，并在无穷远处衰减。内部问题和外部问题之间的耦合通过迹的连续性和法向通量的平衡在 $\\Gamma$ 上施加。\n\n有限元法 (FEM) 和边界元法 (BEM) 之间的一种稳定化对称耦合可以通过结合以下内容推导得出：\n- 内部变分形式 $a(u,v) = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, dx$，\n- 通过单层势与迹算子（即单层边界积分算子）$V : H^{-1/2}(\\Gamma) \\to H^{1/2}(\\Gamma)$ 实现的外部表示，\n- 通过一个罚参数 $\\gamma > 0$ 对连续性约束 $u|_{\\Gamma} = V \\phi$ 进行弱施加和稳定，该参数缩放一个边界 $L^2(\\Gamma)$ 内积。\n\n在单位球面上，球谐函数 $Y_{\\ell m}$ 构成 $L^2(\\Gamma)$ 的一组标准正交基，且单层算子在此基下是对角的，其特征值是已知的。在一个使用以下模式匹配基的降阶谱伽辽金模型中：\n- 内部基函数 $u_{\\ell m}(x) = r^{\\ell} Y_{\\ell m}(\\hat{x})$（在 $\\Omega$ 中是调和的），\n- 用于 BEM 未知密度的边界基函数 $\\phi_{\\ell m} = Y_{\\ell m}$，\n\n在进行标准化 $\\int_{\\Gamma} Y_{\\ell m}^2 \\, dS = 1$ 后，可以得到一个块对角代数系统，该系统按球谐函数的阶 $\\ell \\in \\{0,1,2,\\dots,L\\}$ 和级 $m \\in \\{-\\ell,\\dots,\\ell\\}$ 解耦。对于每个固定的 $\\ell$，与系数对 $\\left(u_{\\ell m}, \\phi_{\\ell m}\\right)$ 相关联的 $2 \\times 2$ 块具有以下形式\n$$\nK_{\\ell}(\\gamma) \\;=\\; \n\\begin{bmatrix}\n\\ell + \\gamma & -1 \\\\\n-1 & v_{\\ell}\n\\end{bmatrix},\n$$\n其中 $v_{\\ell}$ 是单位球面上阶为 $\\ell$ 的单层边界积分算子 $V$ 的特征值，由下式给出\n$$\nv_{\\ell} \\;=\\; \\frac{1}{2\\ell + 1}.\n$$\n在所选基中，内部能量满足 $\\int_{\\Omega} |\\nabla (r^{\\ell} Y_{\\ell m})|^2 \\, dx = \\ell \\int_{\\Gamma} Y_{\\ell m}^2 \\, dS = \\ell$，并且由于所选定的标准正交化和符号约定，FEM–BEM 耦合项简化为值为 $-1$ 的元素。\n\n将给定罚参数 $\\gamma$ 下耦合稳定化系统的最小特征值定义为所有球谐函数块和所有级的 $K_{\\ell}(\\gamma)$ 最小特征值的最小值。由于对于一个固定的 $\\ell$，所有级 $m$ 都是相同的副本，因此重复度不改变最小值。因此，对于截断参数 $L \\in \\mathbb{N}$，我们关心的量是\n$$\n\\lambda_{\\min}^{(L)}(\\gamma) \\;=\\; \\min_{0 \\le \\ell \\le L} \\, \\lambda_{\\min}\\!\\left( K_{\\ell}(\\gamma) \\right),\n$$\n其中\n$$\n\\lambda_{\\min}\\!\\left( K_{\\ell}(\\gamma) \\right) \\;=\\; \\frac{(\\ell+\\gamma) + v_{\\ell} - \\sqrt{\\left((\\ell+\\gamma) - v_{\\ell}\\right)^2 + 4}}{2}.\n$$\n\n任务：\n- 从单位球面上球谐函数的基本性质以及单层边界积分算子的谱映射出发，构建一个程序。该程序通过计算上述闭式表达式并在 $\\ell \\in \\{0,\\dots,L\\}$ 上取最小值，来计算给定截断参数 $L$ 和稳定化参数 $\\gamma$ 下的 $\\lambda_{\\min}^{(L)}(\\gamma)$。\n- 解释当 $\\gamma$ 变化时 $\\lambda_{\\min}^{(L)}(\\gamma)$ 的行为，并结合稳定化 FEM–BEM 耦合的鲁棒性进行分析。特别地，讨论每个 $K_{\\ell}(\\gamma)$ 矩阵关于 $\\gamma$ 和 $L$ 的正定性条件，以及这如何影响全局最小值。\n\n你的程序必须实现以下测试套件，其中截断参数 $L = 8$，稳定化参数为\n- $\\gamma \\in \\{\\,0,\\;0.1,\\;1.0,\\;5.0,\\;9.0,\\;9.1,\\;20.0\\,\\}$。\n\n对于套件中的每个 $\\gamma$，计算如上定义的单个浮点数值 $\\lambda_{\\min}^{(L)}(\\gamma)$。将结果聚合为单行，形式为用方括号括起来的逗号分隔列表。输出中的每个浮点数必须四舍五入到小数点后 $8$ 位。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含按给定 $\\gamma$ 值的精确顺序排列的结果，形式为用方括号括起来的逗号分隔列表，例如\n$$\n[\\text{result}_{1},\\text{result}_{2},\\dots,\\text{result}_{7}],\n$$\n其中每个 $\\text{result}_{k}$ 都四舍五入到小数点后 8 位。\n此计算不涉及物理单位，也没有出现角度。", "solution": "问题陈述经验证具有科学依据、适定且客观。它为单位球面上的拉普拉斯传输问题提供了一种稳定化对称 FEM-BEM 耦合格式的标准谱分析。所有给出的数学定义和公式都是正确的，并与计算数学领域的既定理论一致。\n\n任务是计算一个离散耦合系统的最小特征值并解释其行为。所考虑的系统由一组 $2 \\times 2$ 的块矩阵表示，每个矩阵对应一个球谐函数阶 $\\ell \\in \\{0, 1, \\dots, L\\}$。对于一个固定的阶 $\\ell$ 和稳定化参数 $\\gamma$，该矩阵由下式给出：\n$$\nK_{\\ell}(\\gamma) \\;=\\; \n\\begin{bmatrix}\n\\ell + \\gamma & -1 \\\\\n-1 & v_{\\ell}\n\\end{bmatrix}\n$$\n其中 $v_{\\ell} = \\frac{1}{2\\ell + 1}$ 是阶为 $\\ell$ 模式的单层边界积分算子的特征值。该矩阵的特征值是其特征多项式 $\\det(K_{\\ell}(\\gamma) - \\lambda I) = 0$ 的根。较小的特征值由以下显式公式给出：\n$$\n\\lambda_{\\min}\\!\\left( K_{\\ell}(\\gamma) \\right) \\;=\\; \\frac{(\\ell+\\gamma) + v_{\\ell} - \\sqrt{\\left((\\ell+\\gamma) - v_{\\ell}\\right)^2 + 4}}{2}\n$$\n对于给定的截断水平 $L$，我们寻求在所有考虑的模式上的全局最小特征值：\n$$\n\\lambda_{\\min}^{(L)}(\\gamma) \\;=\\; \\min_{0 \\le \\ell \\le L} \\, \\lambda_{\\min}\\!\\left( K_{\\ell}(\\gamma) \\right)\n$$\n\n系统矩阵的一个基本性质是其正定性，这是数值方法稳定性和唯一可解性的要求。一个对称矩阵是正定的，当且仅当其所有特征值都严格为正。对于 $2 \\times 2$ 矩阵 $K_{\\ell}(\\gamma)$，这等价于其所有顺序主子式为正。\n第一个主子式是左上角的元素 $\\ell + \\gamma$。由于 $\\ell \\ge 0$ 且问题考虑 $\\gamma \\ge 0$，该子式为正，除了 $\\ell=0, \\gamma=0$ 的边界情况。\n第二个主子式是矩阵的行列式：\n$$\n\\det(K_{\\ell}(\\gamma)) \\;=\\; (\\ell + \\gamma)v_{\\ell} - 1\n$$\n为使 $K_{\\ell}(\\gamma)$ 是正定的，我们需要 $\\det(K_{\\ell}(\\gamma)) > 0$。代入 $v_{\\ell} = \\frac{1}{2\\ell + 1}$：\n$$\n(\\ell + \\gamma)\\frac{1}{2\\ell + 1} - 1 > 0 \\quad \\implies \\quad \\ell + \\gamma > 2\\ell + 1 \\quad \\implies \\quad \\gamma > \\ell + 1\n$$\n全局系统矩阵是块对角的，其块为 $K_{\\ell}(\\gamma)$，该矩阵是正定的当且仅当每个块都是正定的。这要求条件 $\\gamma > \\ell + 1$ 对所有 $\\ell \\in \\{0, 1, \\dots, L\\}$ 都成立。最严格的情况发生在最高阶 $\\ell = L$ 时。因此，整个系统保证为正定的当且仅当：\n$$\n\\gamma > L + 1\n$$\n该条件对于稳定化 FEM–BEM 耦合的鲁棒性具有直接且关键的解释。\n1. 如果 $\\gamma > L+1$，系统是正定的。所有特征值 $\\lambda_{\\min}(K_{\\ell}(\\gamma))$ 均为正，因此 $\\lambda_{\\min}^{(L)}(\\gamma) > 0$。该数值方法是稳定的。\n2. 如果 $\\gamma \\le L+1$，则至少存在一个索引为 $\\ell$ 的块（具体而言，是任何满足 $\\ell \\ge \\gamma - 1$ 的 $\\ell$），使得 $\\det(K_{\\ell}(\\gamma)) \\le 0$。一个非正的行列式意味着至少有一个特征值为非正。因此，全局最小特征值 $\\lambda_{\\min}^{(L)}(\\gamma)$ 将为非正。这标志着数值模型丧失了稳定性。\n3. 在临界阈值 $\\gamma = L+1$ 处，我们有 $\\det(K_L(L+1)) = (L + (L+1))v_L - 1 = (2L+1)\\frac{1}{2L+1} - 1 = 0$。这个块有一个零特征值。对于所有 $\\ell < L$，我们有 $\\gamma = L+1 > \\ell+1$，所以 $\\det(K_{\\ell}(\\gamma)) > 0$。因此，系统的最小特征值恰好为零：$\\lambda_{\\min}^{(L)}(L+1) = 0$。\n\n这一分析表明，稳定化参数 $\\gamma$ 必须选择得足够大，以克服耦合中固有的不稳定性，其所需的大小直接取决于离散化的谱分辨率 $L$。这是罚方法和稳定化方法的一个典型特征。\n\n为指定的测试套件（$L=8$ 和各种 $\\gamma$ 值）找到 $\\lambda_{\\min}^{(L)}(\\gamma)$ 的计算步骤如下：\n对于每个给定的 $\\gamma$ 值：\n1. 初始化变量 `current_min_lambda` 为一个大的正数。\n2. 遍历所有从 $0$ 到 $L=8$ 的整数模式阶 $\\ell$。\n3. 在每次迭代中，计算 $v_{\\ell} = \\frac{1}{2\\ell + 1}$。\n4. 使用提供的公式计算该模式的最小特征值 $\\lambda_{\\min}(K_{\\ell}(\\gamma))$。\n5. 更新 `current_min_lambda = min(current_min_lambda, \\lambda_{\\min}(K_{\\ell}(\\gamma)))`。\n6. 遍历完所有的 $\\ell$ 后，`current_min_lambda` 的最终值即为结果 $\\lambda_{\\min}^{(8)}(\\gamma)$。\n该过程在提供的程序中实现。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the smallest eigenvalue of a stabilized FEM-BEM coupled system\n    for a range of stabilization parameters.\n    \"\"\"\n    # Truncation parameter for spherical harmonic degree\n    L = 8\n\n    # List of stabilization parameters to test\n    gamma_values = [0.0, 0.1, 1.0, 5.0, 9.0, 9.1, 20.0]\n\n    # Store results for final output\n    results = []\n\n    # Iterate over each stabilization parameter\n    for gamma in gamma_values:\n        # Initialize the minimum eigenvalue for the current gamma to infinity\n        min_eigenvalue_for_gamma = float('inf')\n\n        # Iterate through each spherical harmonic degree from 0 to L\n        for l in range(L + 1):\n            # Eigenvalue of the single-layer operator for degree l\n            v_l = 1.0 / (2.0 * l + 1.0)\n            \n            # The 2x2 matrix block is K_l(gamma) = [[l + gamma, -1], [-1, v_l]]\n            # Let a = l + gamma and d = v_l. The eigenvalues are given by:\n            # lambda = ( (a + d) +/- sqrt((a - d)^2 + 4) ) / 2\n            a = float(l) + gamma\n            d = v_l\n            \n            # We need the smallest eigenvalue, which corresponds to the '-' sign\n            lambda_min_l = ( (a + d) - np.sqrt((a - d)**2 + 4.0) ) / 2.0\n            \n            # Update the minimum eigenvalue if the current one is smaller\n            if lambda_min_l < min_eigenvalue_for_gamma:\n                min_eigenvalue_for_gamma = lambda_min_l\n        \n        # Append the formatted result to the list\n        results.append(f\"{min_eigenvalue_for_gamma:.8f}\")\n\n    # Print the final output in the required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2551171"}]}