{"hands_on_practices": [{"introduction": "边界积分方程 (Boundary Integral Equation, BIE) 理论上必须在边界上的每一点都成立，但在处理像角点这样的非光滑点时，必须格外小心。本练习将引导你通过严格的极限过程，推导出现在 BIE 中的自由项系数 $c(\\mathbf{x})$，该系数能够精确地反映角点处的局部几何特征。正确理解和计算此系数是构建精确、稳健的边界元法 (BEM) 模型的关键第一步。[@problem_id:2560772]", "problem": "考虑一个二维空间中的有界多边形域 $\\Omega \\subset \\mathbb{R}^{2}$ 上的内部拉普拉斯问题，其边界为 $\\Gamma$，其中 $u$ 在 $\\Omega$ 内满足 $\\nabla^{2} u = 0$。设 $\\mathbf{x}_{0} \\in \\Gamma$ 为两条直边相交的角点，并设 $\\theta \\in (0,2\\pi)$ 表示 $\\Omega$ 在 $\\mathbf{x}_{0}$ 处的内角，以弧度为单位。基于 Green 第三恒等式的直接边界积分方程 (BIE) 是利用二维基本解 $U(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi}\\ln|\\mathbf{x}-\\mathbf{y}|$、$\\Gamma$ 上的外法向单位向量 $\\mathbf{n}(\\mathbf{y})$ 以及法向导数 $q(\\mathbf{y}) = \\frac{\\partial u}{\\partial n}(\\mathbf{y})$ 建立的。当源点趋近于边界时，会出现一个系数 $c(\\mathbf{x}_{0})$ 与 $u(\\mathbf{x}_{0})$ 相乘。\n\n从 Green 恒等式和基本解的性质 $\\nabla^{2}_{\\mathbf{y}} U(\\mathbf{x},\\mathbf{y}) = -\\delta(\\mathbf{y}-\\mathbf{x})$ 出发，通过分析将以 $\\mathbf{x}_{0}$ 为中心、半径为 $\\varepsilon$ 的小圆盘从 $\\Omega$ 中移除并令 $\\varepsilon \\to 0^{+}$ 的极限过程，推导出用内角 $\\theta$ 表示 $c(\\mathbf{x}_{0})$ 的表达式。然后，计算凹角情况下 $\\theta = \\frac{3\\pi}{2}$ 时 $c(\\mathbf{x}_{0})$ 的值。\n\n最后，简要解释在基于配置点的直接边界元法 (BEM) 对 BIE 的离散化中，该系数 $c(\\mathbf{x})$ 如何确定系统矩阵的正确对角元，并说明为何在角点处使用与角度相关的值对于保证一致性至关重要。\n\n请以精确分数的形式给出 $\\theta = \\frac{3\\pi}{2}$ 时的 $c(\\mathbf{x}_{0})$ 值。无需四舍五入，也无需单位。", "solution": "问题陈述经分析后被认定为有效。这是边界元法数学理论中的一个适定问题，不含任何科学或逻辑矛盾。所有必要信息均已提供。\n\n该问题要求推导二维域 $\\Omega$ 边界 $\\Gamma$ 上角点 $\\mathbf{x}_{0}$ 处直接边界积分方程 (BIE) 的系数 $c(\\mathbf{x}_{0})$。推导的起点是针对调和函数 $u$ (即 $\\nabla^{2} u = 0$) 的 Green 第二恒等式，以及拉普拉斯方程的基本解 $U(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi}\\ln|\\mathbf{x}-\\mathbf{y}|$。基本解的性质为 $\\nabla^{2}_{\\mathbf{y}} U(\\mathbf{x},\\mathbf{y}) = -\\delta(\\mathbf{y}-\\mathbf{x})$，其中 $\\delta$ 是 Dirac delta 函数。\n\nGreen 第二恒等式表述为：\n$$ \\int_{\\Omega} \\left( u(\\mathbf{y}) \\nabla^{2}_{\\mathbf{y}} U(\\mathbf{x},\\mathbf{y}) - U(\\mathbf{x},\\mathbf{y}) \\nabla^{2}_{\\mathbf{y}} u(\\mathbf{y}) \\right) d\\Omega_{\\mathbf{y}} = \\int_{\\Gamma} \\left( u(\\mathbf{y}) \\frac{\\partial U(\\mathbf{x},\\mathbf{y})}{\\partial n_{\\mathbf{y}}} - U(\\mathbf{x},\\mathbf{y}) \\frac{\\partial u(\\mathbf{y})}{\\partial n_{\\mathbf{y}}} \\right) d\\Gamma_{\\mathbf{y}} $$\n将 $\\nabla^{2}u = 0$ 和 $\\nabla^{2}_{\\mathbf{y}} U = -\\delta(\\mathbf{y}-\\mathbf{x})$ 代入，对于域 $\\Omega$ 内的源点 $\\mathbf{x}$，该恒等式变为：\n$$ \\int_{\\Omega} u(\\mathbf{y}) (-\\delta(\\mathbf{y}-\\mathbf{x})) d\\Omega_{\\mathbf{y}} = -u(\\mathbf{x}) $$\n令 $q(\\mathbf{y}) = \\frac{\\partial u}{\\partial n}(\\mathbf{y})$，我们得到对于 $\\mathbf{x} \\in \\Omega$ 的 $u(\\mathbf{x})$ 的积分表达式：\n$$ -u(\\mathbf{x}) = \\int_{\\Gamma} \\left( u(\\mathbf{y}) \\frac{\\partial U(\\mathbf{x},\\mathbf{y})}{\\partial n_{\\mathbf{y}}} - U(\\mathbf{x},\\mathbf{y}) q(\\mathbf{y}) \\right) d\\Gamma_{\\mathbf{y}} $$\n这通常重新整理为：\n$$ u(\\mathbf{x}) = \\int_{\\Gamma} \\left( U(\\mathbf{x},\\mathbf{y}) q(\\mathbf{y}) - u(\\mathbf{y}) \\frac{\\partial U(\\mathbf{x},\\mathbf{y})}{\\partial n_{\\mathbf{y}}} \\right) d\\Gamma_{\\mathbf{y}} $$\n为了推导边界上源点 $\\mathbf{x}_{0}$ 的 BIE，我们必须考虑核函数 $U$ 和 $\\frac{\\partial U}{\\partial n}$ 的奇异性。我们遵循以下步骤：从域中排除一个以 $\\mathbf{x}_{0}$ 为中心、半径为 $\\varepsilon$ 的小圆盘 $B(\\mathbf{x}_{0}, \\varepsilon)$。新域为 $\\Omega_{\\varepsilon} = \\Omega \\setminus B(\\mathbf{x}_{0}, \\varepsilon)$。点 $\\mathbf{x}_{0}$ 位于 $\\Omega_{\\varepsilon}$ 外部，因此 Dirac delta 函数的筛选性质给出零。在 $\\Omega_{\\varepsilon}$ 上，源点位于 $\\mathbf{x}_{0}$ 处的 Green 恒等式为：\n$$ 0 = \\int_{\\partial \\Omega_{\\varepsilon}} \\left( U(\\mathbf{x}_{0},\\mathbf{y}) q(\\mathbf{y}) - u(\\mathbf{y}) \\frac{\\partial U(\\mathbf{x}_{0},\\mathbf{y})}{\\partial n_{\\mathbf{y}}} \\right) d\\Gamma_{\\mathbf{y}} $$\n边界 $\\partial \\Omega_{\\varepsilon}$ 由除去圆盘内部部分的原始边界（我们记为 $\\Gamma'$）和圆弧 $\\Gamma_{\\varepsilon} = \\partial B(\\mathbf{x}_{0}, \\varepsilon) \\cap \\Omega$ 组成。积分变为：\n$$ 0 = \\int_{\\Gamma'} \\left( U q - u \\frac{\\partial U}{\\partial n} \\right) d\\Gamma + \\int_{\\Gamma_{\\varepsilon}} \\left( U q - u \\frac{\\partial U}{\\partial n} \\right) d\\Gamma $$\n我们现在取 $\\varepsilon \\to 0$ 的极限。在此极限下，$\\Gamma'$ 上的积分变为 $\\Gamma$ 上的 Cauchy 主值 (p.v.) 积分：\n$$ \\lim_{\\varepsilon \\to 0} \\int_{\\Gamma'} (\\dots) d\\Gamma = \\text{p.v.} \\int_{\\Gamma} (\\dots) d\\Gamma $$\n我们必须计算圆弧 $\\Gamma_{\\varepsilon}$ 上积分的极限。让我们分别分析这两项。\n对于第一项，涉及 $Uq$：在 $\\Gamma_{\\varepsilon}$ 上，$|\\mathbf{y}-\\mathbf{x}_{0}|=\\varepsilon$，因此 $U(\\mathbf{x}_{0},\\mathbf{y}) = -\\frac{1}{2\\pi}\\ln(\\varepsilon)$。弧 $\\Gamma_{\\varepsilon}$ 的长度为 $\\theta\\varepsilon$，其中 $\\theta$ 是角点 $\\mathbf{x}_{0}$ 处的内角。假设 $q(\\mathbf{y})$ 在 $\\mathbf{x}_{0}$ 附近有界，我们有：\n$$ \\lim_{\\varepsilon \\to 0} \\int_{\\Gamma_{\\varepsilon}} U q \\, d\\Gamma = \\lim_{\\varepsilon \\to 0} \\left( -\\frac{1}{2\\pi}\\ln(\\varepsilon) \\right) \\cdot (\\text{average } q) \\cdot (\\theta\\varepsilon) = 0 $$\n因为 $\\lim_{\\varepsilon \\to 0} \\varepsilon \\ln(\\varepsilon) = 0$。\n\n对于第二项，涉及 $-u \\frac{\\partial U}{\\partial n}$：在圆弧 $\\Gamma_{\\varepsilon}$ 上，相对于域 $\\Omega_{\\varepsilon}$ 的外法向单位向量 $\\mathbf{n}$ 指向中心 $\\mathbf{x}_{0}$。它由 $\\mathbf{n} = -\\frac{\\mathbf{y}-\\mathbf{x}_{0}}{|\\mathbf{y}-\\mathbf{x}_{0}|}$ 给出。基本解的梯度为 $\\nabla_{\\mathbf{y}} U = -\\frac{1}{2\\pi} \\frac{\\mathbf{y}-\\mathbf{x}_{0}}{|\\mathbf{y}-\\mathbf{x}_{0}|^2}$。\nU的法向导数为：\n$$ \\frac{\\partial U}{\\partial n_{\\mathbf{y}}} = \\nabla_{\\mathbf{y}} U \\cdot \\mathbf{n} = \\left( -\\frac{1}{2\\pi} \\frac{\\mathbf{y}-\\mathbf{x}_{0}}{|\\mathbf{y}-\\mathbf{x}_{0}|^2} \\right) \\cdot \\left( -\\frac{\\mathbf{y}-\\mathbf{x}_{0}}{|\\mathbf{y}-\\mathbf{x}_{0}|} \\right) = \\frac{1}{2\\pi} \\frac{|\\mathbf{y}-\\mathbf{x}_{0}|^2}{|\\mathbf{y}-\\mathbf{x}_{0}|^3} = \\frac{1}{2\\pi|\\mathbf{y}-\\mathbf{x}_{0}|} $$\n在 $\\Gamma_{\\varepsilon}$ 上，$|\\mathbf{y}-\\mathbf{x}_{0}| = \\varepsilon$，因此 $\\frac{\\partial U}{\\partial n} = \\frac{1}{2\\pi\\varepsilon}$。假设 $u$ 在 $\\mathbf{x}_{0}$ 处是连续的，那么当 $\\varepsilon \\to 0$ 时，$u(\\mathbf{y}) \\to u(\\mathbf{x}_{0})$。积分的极限为：\n$$ \\lim_{\\varepsilon \\to 0} \\int_{\\Gamma_{\\varepsilon}} -u(\\mathbf{y}) \\frac{\\partial U}{\\partial n} \\, d\\Gamma = \\lim_{\\varepsilon \\to 0} \\int_{\\Gamma_{\\varepsilon}} -u(\\mathbf{y}) \\frac{1}{2\\pi\\varepsilon} \\, d\\Gamma = \\lim_{\\varepsilon \\to 0} -u(\\mathbf{x}_{0}) \\frac{1}{2\\pi\\varepsilon} (\\theta\\varepsilon) = -u(\\mathbf{x}_{0}) \\frac{\\theta}{2\\pi} $$\n将这些极限代回积分方程：\n$$ 0 = \\text{p.v.} \\int_{\\Gamma} \\left( U q - u \\frac{\\partial U}{\\partial n} \\right) d\\Gamma - u(\\mathbf{x}_{0})\\frac{\\theta}{2\\pi} $$\n直接边界积分方程的标准形式写作：\n$$ c(\\mathbf{x}_{0})u(\\mathbf{x}_{0}) + \\int_{\\Gamma} u \\frac{\\partial U}{\\partial n} \\, d\\Gamma = \\int_{\\Gamma} U q \\, d\\Gamma $$\n其中积分是在主值意义下理解的。重新整理我们推导的方程：\n$$ u(\\mathbf{x}_{0})\\frac{\\theta}{2\\pi} = \\text{p.v.} \\int_{\\Gamma} \\left( U q - u \\frac{\\partial U}{\\partial n} \\right) d\\Gamma \\implies u(\\mathbf{x}_{0})\\frac{\\theta}{2\\pi} + \\text{p.v.}\\int_{\\Gamma} u \\frac{\\partial U}{\\partial n} \\, d\\Gamma = \\text{p.v.}\\int_{\\Gamma} U q \\, d\\Gamma $$\n通过将其与标准 BIE 形式进行比较，我们确定系数 $c(\\mathbf{x}_{0})$：\n$$ c(\\mathbf{x}_{0}) = \\frac{\\theta}{2\\pi} $$\n该系数表示域在点 $\\mathbf{x}_{0}$ 处所张内角占整个圆周角（$2\\pi$）的比例。对于光滑点，$\\theta=\\pi$，所以 $c(\\mathbf{x}_{0}) = \\frac{1}{2}$。对于内部点，$\\theta=2\\pi$，所以 $c(\\mathbf{x}_{0})=1$。\n\n对于内角为 $\\theta = \\frac{3\\pi}{2}$ 的凹角，该系数为：\n$$ c(\\mathbf{x}_{0}) = \\frac{3\\pi/2}{2\\pi} = \\frac{3\\pi}{4\\pi} = \\frac{3}{4} $$\n\n在基于配置点的边界元法 (BEM) 中，BIE 在边界上的一组离散节点 $\\{\\mathbf{x}_i\\}$ 处强制成立。这会产生一个线性代数方程组 $[H]\\{u\\} = [G]\\{q\\}$。系数矩阵 $[H]$ 由包含自由项系数 $c(\\mathbf{x}_i)$ 和核函数 $\\frac{\\partial U}{\\partial n}$ 积分的项组装而成。作用于未知向量 $\\{u\\}$ 的完整矩阵在节点 $i$ 处的对角元为 $\\hat{H}_{ii} = c(\\mathbf{x}_i) + \\text{p.v.}\\int_{\\Gamma_i} \\frac{\\partial U(\\mathbf{x}_i, \\mathbf{y})}{\\partial n_y} d\\Gamma_y$，其中 $\\Gamma_i$ 是包含节点 $\\mathbf{x}_i$ 的边界元。因此，系数 $c(\\mathbf{x}_i)$ 是系统矩阵对角项的一个显式的、必要的组成部分。\n\n在角点处为 $c(\\mathbf{x}_i)$ 使用正确的、与角度相关的值对于保证一致性至关重要，因为该值是从 Green 恒等式推导出的控制积分方程的直接结果。它在数学上表示了配置点处的局部几何特征。使用不正确的值，例如假设各处 $c(\\mathbf{x}_i) = \\frac{1}{2}$，将意味着离散化后的方程不能正确地表示角点处的潜在物理学。这会给数值模型引入一个基本误差，导致系统不一致和解不准确，尤其是在像角点这样的高梯度区域。BEM 的一致性依赖于每个离散方程都是积分恒等式的忠实表示，而正确的几何因子 $c(\\mathbf{x}_i)$ 对此是不可或缺的。", "answer": "$$\n\\boxed{\\frac{3}{4}}\n$$", "id": "2560772"}, {"introduction": "在理解了角点的几何效应之后，本练习将深入探讨它们对解本身行为的深远影响。我们将通过变量分离法分析，对于特定角度的凹角，解的梯度为何会趋于无穷大，这种现象被称为“奇异性”。掌握这种奇异行为的特性，对于预估 BEM 模拟在带角点区域的准确性和收敛阶，以及为后续开发高级修正技术（如网格加密或奇异基函数）打下基础，都至关重要。[@problem_id:2560760]", "problem": "考虑一个在原点处有一个凹角的平面域。在以该角点为中心的局部极坐标系 $\\left(r,\\varphi\\right)$ 中，角点附近的区域是一个楔形域 $\\{(r,\\varphi)\\,:\\, r>0,\\; 0<\\varphi<\\theta\\}$，其内角 $\\theta$ 满足 $\\theta>\\pi$。设 $u$ 为拉普拉斯方程的狄利克雷问题的解，\n$$\n\\Delta u \\,=\\, 0 \\quad \\text{在楔形域内}, \\qquad u\\,=\\,g \\quad \\text{在 } \\{\\varphi=0\\}\\cup\\{\\varphi=\\theta\\} \\text{ 上},\n$$\n其中 $g$ 在角点处连续，并且在角点的任何邻域内不恒为零。假设边界数据 $g$ 会激发主奇异角点模态。您的任务是：\n\n- 从拉普拉斯算子的极坐标形式出发，利用分离变量法和楔形几何固有的边界条件，确定当 $r\\to 0^{+}$ 时 $u(r,\\varphi)$ 的主阶渐近行为。\n- 基于此分析，确定唯一的正奇异指数 $\\lambda(\\theta)$，使得存在一个非平凡的角度函数 $\\Phi(\\varphi)$ 满足\n$$\nu(r,\\varphi)\\sim r^{\\lambda(\\theta)}\\,\\Phi(\\varphi)\\quad \\text{当 } r\\to 0^{+} \\text{ 时}.\n$$\n- 简要解释为什么该指数决定了角点处迹和通量的光滑性降低，而光滑性的降低又限制了狄利克雷问题边界元离散化的收敛阶。\n\n只需报告指数 $\\lambda(\\theta)$ 作为 $\\theta$（以弧度为单位）的函数的显式闭式表达式。不需要数值近似。", "solution": "所述问题是关于非光滑域上椭圆型偏微分方程理论中的一个标准的适定问题。该问题有科学依据，无内在矛盾，并包含足够的信息以推导出唯一解。我们可以继续。\n\n任务是确定拉普拉斯方程在具有凹角的平面楔形域中的解的主阶奇异行为。控制方程是拉普拉斯方程，$\\Delta u = 0$。在以角点为中心的极坐标系 $(r, \\varphi)$ 中，拉普拉斯算子由下式给出：\n$$\n\\Delta = \\frac{\\partial^{2}}{\\partial r^{2}} + \\frac{1}{r} \\frac{\\partial}{\\partial r} + \\frac{1}{r^{2}} \\frac{\\partial^{2}}{\\partial \\varphi^{2}}\n$$\n因此，待解方程为：\n$$\n\\frac{\\partial^{2} u}{\\partial r^{2}} + \\frac{1}{r} \\frac{\\partial u}{\\partial r} + \\frac{1}{r^{2}} \\frac{\\partial^{2} u}{\\partial \\varphi^{2}} = 0\n$$\n我们采用分离变量法，假设解的形式为 $u(r, \\varphi) = R(r)\\Phi(\\varphi)$。将此拟设代入拉普拉斯方程，得到：\n$$\nR''(r)\\Phi(\\varphi) + \\frac{1}{r}R'(r)\\Phi(\\varphi) + \\frac{1}{r^{2}}R(r)\\Phi''(\\varphi) = 0\n$$\n两边同乘以 $\\frac{r^{2}}{R(r)\\Phi(\\varphi)}$ 以分离变量：\n$$\n\\frac{r^{2}R''(r) + rR'(r)}{R(r)} = -\\frac{\\Phi''(\\varphi)}{\\Phi(\\varphi)}\n$$\n由于左侧仅依赖于 $r$，右侧仅依赖于 $\\varphi$，因此两边都必须等于一个常数，我们记为 $k$。这就得到了两个常微分方程：\n$$\nr^{2}R''(r) + rR'(r) - k R(r) = 0 \\quad (\\text{Radial Equation})\n$$\n$$\n\\Phi''(\\varphi) + k \\Phi(\\varphi) = 0 \\quad (\\text{Angular Equation})\n$$\n我们关心的是角点几何固有的奇异行为。奇异函数是具有齐次边界条件的问题的解。一般解可以展开为这些奇异函数的级数。因此，我们对角向部分施加对应于楔形域边界的齐次狄利克雷条件：$\\Phi(0) = 0$ 和 $\\Phi(\\theta) = 0$。\n\n让我们求解角向方程。满足这些边界条件的非平凡解要求 $k > 0$。设 $k = \\lambda^{2}$，其中 $\\lambda > 0$。$\\Phi(\\varphi)$ 的通解为：\n$$\n\\Phi(\\varphi) = A \\cos(\\lambda\\varphi) + B \\sin(\\lambda\\varphi)\n$$\n应用第一个边界条件 $\\Phi(0) = 0$，得到：\n$$\nA \\cos(0) + B \\sin(0) = A = 0\n$$\n因此，解必须具有 $\\Phi(\\varphi) = B \\sin(\\lambda\\varphi)$ 的形式。应用第二个边界条件 $\\Phi(\\theta)=0$，得到：\n$$\nB \\sin(\\lambda\\theta) = 0\n$$\n为得到非平凡解（$B \\neq 0$），必须有 $\\sin(\\lambda\\theta) = 0$。这意味着 $\\lambda\\theta = n\\pi$，其中 $n$ 为任意非零整数。我们取 $n$ 为正整数，即 $n=1, 2, 3, \\dots$，因为负整数不会产生线性无关的解。\n因此，特征值为 $\\lambda_{n} = \\frac{n\\pi}{\\theta}$，相应的分离常数为 $k_{n} = \\lambda_{n}^{2} = \\left(\\frac{n\\pi}{\\theta}\\right)^{2}$。特征函数为 $\\Phi_{n}(\\varphi) = \\sin\\left(\\frac{n\\pi\\varphi}{\\theta}\\right)$。\n\n接下来，我们求解径向方程，这是一个柯西-欧拉方程：\n$$\nr^{2}R''(r) + rR'(r) - k_{n} R(r) = 0\n$$\n我们寻求形式为 $R(r) = r^{\\alpha}$ 的解。将其代入方程，得到关于 $\\alpha$ 的特征方程：\n$$\n\\alpha(\\alpha-1) + \\alpha - k_{n} = 0 \\implies \\alpha^{2} = k_{n} \\implies \\alpha = \\pm\\sqrt{k_{n}} = \\pm\\lambda_{n}\n$$\n径向部分的通解为 $R_{n}(r) = C_{1}r^{\\lambda_{n}} + C_{2}r^{-\\lambda_{n}}$。为使解具有物理意义（例如，在原点邻域内具有有限能量 $\\int |\\nabla u|^2$），指数必须为正。这使我们舍弃带有负指数的项。\n$u(r,\\varphi)$ 的通解可以写为这些分离变量解的叠加：\n$$\nu(r, \\varphi) = \\sum_{n=1}^{\\infty} c_{n} r^{\\lambda_{n}} \\Phi_{n}(\\varphi) = \\sum_{n=1}^{\\infty} c_{n} r^{n\\pi/\\theta} \\sin\\left(\\frac{n\\pi\\varphi}{\\theta}\\right)\n$$\n当 $r \\to 0^{+}$ 时的渐近行为由具有最小正指数的项决定。指数为 $\\lambda_{n} = \\frac{n\\pi}{\\theta}$（$n=1, 2, 3, \\ldots$）。最小的指数对应于 $n=1$：\n$$\n\\lambda_{1} = \\frac{\\pi}{\\theta}\n$$\n问题指明了是一个凹角，其内角 $\\theta > \\pi$。这意味着主指数 $\\lambda_{1} = \\frac{\\pi}{\\theta}$ 小于 1。小于 1 的指数表示解的梯度存在奇异性，因为 $\\nabla u \\sim \\nabla(r^{\\pi/\\theta}) \\sim r^{\\pi/\\theta - 1}$，当 $r \\to 0$ 时，该式趋于无穷大，因为指数 $\\frac{\\pi}{\\theta}-1$ 是负的。\n因此，当 $r \\to 0^{+}$ 时的的主阶渐近行为是：\n$$\nu(r,\\varphi) \\sim c_{1} r^{\\pi/\\theta} \\sin\\left(\\frac{\\pi\\varphi}{\\theta}\\right)\n$$\n这与 $r^{\\lambda(\\theta)}\\Phi(\\varphi)$ 的形式相匹配，其中奇异指数 $\\lambda(\\theta)$ 是 $\\frac{\\pi}{\\theta}$。\n\n最后，我们讨论这对边界元法 (BEM) 的影响。BEM 求解定义在边界 $\\partial\\Omega$ 上的未知数据的边界积分方程。对于狄利克雷问题，未知量是法向导数（通量），即 $q = \\frac{\\partial u}{\\partial n}$。在角点附近，于 $\\varphi=0$ 的边上，通量的行为如下：\n$$\nq = \\frac{\\partial u}{\\partial n} \\approx -\\frac{1}{r} \\frac{\\partial u}{\\partial \\varphi}\\bigg|_{\\varphi=0} \\sim -\\frac{1}{r} r^{\\pi/\\theta} \\frac{\\pi}{\\theta} \\cos(0) \\sim r^{\\pi/\\theta - 1}\n$$\n如前所述，对于内角 $\\theta > \\pi$ 的凹角，指数 $\\frac{\\pi}{\\theta}-1$ 是负的。这证明了通量在角点尖端是奇异的。标准的 BEM 离散化采用多项式基函数（分片常数、线性等）来逼近未知的边界数据。这类函数是光滑的，根本无法精确地表示 $r^{\\pi/\\theta-1}$ 这种奇异性。这种糟糕的局部逼近会引入巨大误差，污染全局解，并严重降低该方法的收敛率。收敛阶不再由基函数的多项式次数决定，而是受奇异指数 $\\lambda(\\theta) = \\frac{\\pi}{\\theta}$ 的值限制。解的这种正则性降低是在具有凹角的域中使用标准 BEM 实现高精度的主要障碍。\n\n指数 $\\lambda(\\theta)$ 的显式闭式表达式是指数级数 $\\frac{n\\pi}{\\theta}$ 的首项。", "answer": "$$\\boxed{\\frac{\\pi}{\\theta}}$$", "id": "2560760"}, {"introduction": "现在，让我们从理论分析转向编程实践。本练习提供了一个独特的机会，为一个理想化的圆形域编写一个简化的 BEM 程序，在这种特殊几何下，复杂的空间卷积积分算子在傅里叶域中转变成了简单的代数乘法。你将亲手实现狄利克雷-诺伊曼 (Dirichlet-to-Neumann) 映射——这是 BEM 理论与应用中的一个核心概念——并以数值方式验证其理论预测，从而具体而深刻地理解 BEM 如何在不同物理域之间传递边界信息。[@problem_id:2560737]", "problem": "考虑平面上的二维拉普拉斯方程，其中半径为 $a$ 的圆形界面将区域分隔为内部圆盘 $\\Omega^{-}$ 和无界外部区域 $\\Omega^{+}$。设单位外法向量 $\\mathbf{n}$ 从 $\\Omega^{-}$ 指向 $\\Omega^{+}$。势函数 $u$ 在 $\\Omega^{-}$ 和 $\\Omega^{+}$ 中均满足 $\\Delta u = 0$。在界面 $\\Gamma = \\{ (x,y) : x^{2} + y^{2} = a^{2} \\}$ 上，无源的完美耦合的连续性条件为迹的连续性 $u^{-}|_{\\Gamma} = u^{+}|_{\\Gamma}$ 和法向通量的平衡 $q^{-} + q^{+} = 0$，其中 $q^{\\pm} = \\partial u^{\\pm} / \\partial \\mathbf{n}$ 表示沿从 $\\Omega^{-}$ 指向 $\\Omega^{+}$ 的法线方向的法向导数。假设 $\\Omega^{+}$ 中的外部解在无穷远处衰减。\n\n仅从以下基本基础出发：\n- 拉普拉斯算子的二维基本解，$G(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi} \\ln \\lvert \\mathbf{x} - \\mathbf{y} \\rvert$。\n- Green 恒等式和调和函数的边界积分表示。\n- 单层势和双层势的定义及其在光滑曲线上的边界迹。\n\n推导通过边界积分算子将圆上的给定 Dirichlet 数据 $u|_{\\Gamma}$ 与未知的外部 Neumann 数据 $q^{+}$ 耦合的边界方程。将此方程特化到圆形界面的情况，并推导外部 Dirichlet-to-Neumann 映射在傅里叶模态 $\\cos(n\\theta)$ 上的作用，其中 $\\theta$ 是 $\\Gamma$ 上的极角，以弧度为单位。\n\n然后，实现一个数值格式，该格式使用此边界积分耦合来施加外部域的 Dirichlet-to-Neumann 映射。对于内部场，在极坐标 $(r,\\theta)$ 中使用解析调和多项式 $u^{-}(r,\\theta) = r^{n} \\cos(n\\theta)$；这提供了边界 Dirichlet 数据 $g(\\theta) = u^{-}(a,\\theta)$ 和内部法向通量 $q^{-}(\\theta) = \\partial u^{-}/\\partial r \\big|_{r=a}$。使用特化于圆的、基于傅里叶的边界积分耦合实现，将 $g(\\theta)$ 映射到外部通量 $q^{+}(\\theta)$ 的一个近似，并验证以下两点：\n- 数值施加的外部 Dirichlet-to-Neumann 映射与从第一性原理推导的精确映射一致。\n- 耦合条件 $q^{-} + q^{+} = 0$ 在 $\\Gamma$ 上成立。\n\n你的程序必须：\n- 用 $N$ 个等距角 $\\theta_{j} = 2\\pi j / N$（其中 $j = 0,\\dots,N-1$，角度以弧度为单位）对圆 $\\Gamma$ 进行参数化，在这些点上对 $g(\\theta_{j})$ 进行采样，并使用特化于圆的边界积分耦合的傅里叶符号应用来计算数值外部 Neumann 数据 $q^{+}_{\\mathrm{num}}(\\theta_{j})$。\n- 基于你对圆的精确 Dirichlet-to-Neumann 映射的推导，计算与从 $u^{-}(r,\\theta) = r^{n}\\cos(n\\theta)$ 得到的 $g(\\theta)$ 相对应的精确外部 Neumann 数据 $q^{+}_{\\mathrm{exact}}(\\theta_{j})$。\n- 为每个测试用例报告两个标量误差：\n  1. 外部 Dirichlet-to-Neumann 映射在节点上的最大绝对误差，$E_{\\mathrm{DtN}} = \\max_{j} \\lvert q^{+}_{\\mathrm{num}}(\\theta_{j}) - q^{+}_{\\mathrm{exact}}(\\theta_{j}) \\rvert$。\n  2. 耦合条件的最大绝对违反量，$E_{\\mathrm{cpl}} = \\max_{j} \\lvert q^{-}(\\theta_{j}) + q^{+}_{\\mathrm{num}}(\\theta_{j}) \\rvert$。\n\n测试套件：\n- 使用以下参数三元组 $(a,n,N):$\n  1. $(a,n,N) = (1.0, 1, 128)$。\n  2. $(a,n,N) = (1.0, 5, 128)$。\n  3. $(a,n,N) = (2.0, 3, 128)$。\n  4. $(a,n,N) = (1.0, 30, 64)$。\n  5. $(a,n,N) = (1.0, 10, 16)$。\n这些分别涵盖了典型情况、更高次的谐波、不同的半径、一个接近奈奎斯特 (Nyquist) 的模态和一个欠分辨的边界情况。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每一项都是一个包含两个浮点数 $[E_{\\mathrm{DtN}}, E_{\\mathrm{cpl}}]$ 的列表，对应于相应测试用例的结果，顺序与上面列出的一致。例如：[[e1_dtn,e1_cpl],[e2_dtn,e2_cpl],...].\n\n不需要外部输入。所有角度都必须以弧度处理，不涉及物理单位；所有量均为无量纲。代码必须是完全自包含的，并且按原样即可运行。", "solution": "该问题要求推导并数值实现一种边界积分方程（BIE）方法，以确定二维拉普拉斯方程在圆形界面上的外部 Dirichlet-to-Neumann（DtN）映射。\n\n### 第一部分：边界积分方程的推导\n\n设 $\\Omega^{-}$ 为半径为 $a$ 的内部圆盘，$\\Omega^{+}$ 为无界外部区域。界面为圆 $\\Gamma$。势函数 $u$ 在 $\\Omega^{-}$ 和 $\\Omega^{+}$ 中是调和的，即 $\\Delta u = 0$。设 $g = u|_{\\Gamma}$ 为界面上的 Dirichlet 数据， $q^{\\pm} = \\partial u^{\\pm}/\\partial\\mathbf{n}$ 为法向导数，其中 $\\mathbf{n}$ 是从 $\\Omega^{-}$ 指向外部的法向量。\n\n对于域 $\\Omega$ 中边界为 $\\partial\\Omega$ 的调和函数 $u$，其 Green 第三恒等式为：\n$$\nu(\\mathbf{x}) = \\int_{\\partial\\Omega} \\left( G(\\mathbf{x}, \\mathbf{y}) \\frac{\\partial u}{\\partial \\mathbf{n}_{\\mathbf{y}}}(\\mathbf{y}) - u(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial \\mathbf{n}_{\\mathbf{y}}} \\right) dS_{\\mathbf{y}}, \\quad \\mathbf{x} \\in \\Omega\n$$\n其中 $G(\\mathbf{x}, \\mathbf{y}) = -\\frac{1}{2\\pi} \\ln|\\mathbf{x} - \\mathbf{y}|$ 是基本解，$\\mathbf{n}_{\\mathbf{y}}$ 是点 $\\mathbf{y} \\in \\partial\\Omega$ 处的外法线。\n\n我们将此恒等式应用于外部域 $\\Omega^{+}$。$\\Omega^{+}$ 的边界是 $\\Gamma \\cup \\Gamma_{\\infty}$，其中 $\\Gamma_{\\infty}$ 是无穷远处的圆。在 $\\Gamma$ 上，指向 $\\Omega^{+}$ 外部的法向量是 $-\\mathbf{n}$。由于 $u^{+}$ 的衰减条件，来自 $\\Gamma_{\\infty}$ 的贡献为零。如果 $u^{+}$ 以 $O(1/|\\mathbf{x}|)$ 衰减，则 $u_{\\infty}$ 项为零。我们假设一个对此问题而言是标准的更强衰减条件，以确保 $u \\to 0$ 在无穷远处。对于点 $\\mathbf{x} \\in \\Omega^{+}$，将 Green 恒等式应用于 $\\Omega^{+}$ 中的 $u^{+}$：\n$$\nu^{+}(\\mathbf{x}) = \\int_{\\Gamma} \\left( G(\\mathbf{x}, \\mathbf{y}) \\frac{\\partial u^{+}}{\\partial (-\\mathbf{n})}(\\mathbf{y}) - u^{+}(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial (-\\mathbf{n})} \\right) dS_{\\mathbf{y}}\n$$\n代入 $g=u^{+}|_{\\Gamma}$，$q^{+} = \\partial u^{+}/\\partial\\mathbf{n}$ 和 $\\partial/\\partial(-\\mathbf{n}) = -\\partial/\\partial\\mathbf{n}$：\n$$\nu^{+}(\\mathbf{x}) = \\int_{\\Gamma} \\left( -G(\\mathbf{x}, \\mathbf{y}) q^{+}(\\mathbf{y}) + g(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial \\mathbf{n}_{\\mathbf{y}}} \\right) dS_{\\mathbf{y}}\n$$\n我们定义单层势算子 $\\mathcal{S}_{\\Gamma}$ 和双层势算子 $\\mathcal{D}_{\\Gamma}$：\n$$\n(\\mathcal{S}_{\\Gamma} \\sigma)(\\mathbf{x}) = \\int_{\\Gamma} G(\\mathbf{x}, \\mathbf{y}) \\sigma(\\mathbf{y}) dS_{\\mathbf{y}}\n$$\n$$\n(\\mathcal{D}_{\\Gamma} \\mu)(\\mathbf{x}) = \\int_{\\Gamma} \\mu(\\mathbf{y}) \\frac{\\partial G(\\mathbf{x}, \\mathbf{y})}{\\partial \\mathbf{n}_{\\mathbf{y}}} dS_{\\mathbf{y}}\n$$\n因此，对于 $\\mathbf{x} \\in \\Omega^{+}$，$u^{+}$ 的表示式为 $u^{+}(\\mathbf{x}) = -(\\mathcal{S}_{\\Gamma} q^{+})(\\mathbf{x}) + (\\mathcal{D}_{\\Gamma} g)(\\mathbf{x})$。\n\n为了获得一个边界积分方程，我们取点 $\\mathbf{x}$ 从外部 $\\Omega^{+}$ 趋近于 $\\mathbf{p} \\in \\Gamma$ 的极限。使用层势在光滑边界上的标准跳跃关系：\n$$\n\\lim_{\\mathbf{x} \\to \\mathbf{p}^{+}} (\\mathcal{S}_{\\Gamma} \\sigma)(\\mathbf{x}) = (S_{\\Gamma} \\sigma)(\\mathbf{p})\n$$\n$$\n\\lim_{\\mathbf{x} \\to \\mathbf{p}^{+}} (\\mathcal{D}_{\\Gamma} \\mu)(\\mathbf{x}) = (K_{\\Gamma} \\mu)(\\mathbf{p}) + \\frac{1}{2}\\mu(\\mathbf{p})\n$$\n其中 $S_{\\Gamma}$ 和 $K_{\\Gamma}$ 是边界积分算子（即势函数在 $\\Gamma$ 上的非奇异部分）。将这些极限应用于 $u^{+}$ 的表示式：\n$$\ng(\\mathbf{p}) = -(S_{\\Gamma} q^{+})(\\mathbf{p}) + \\left((K_{\\Gamma} g)(\\mathbf{p}) + \\frac{1}{2}g(\\mathbf{p})\\right)\n$$\n整理可得所求的、耦合 Dirichlet 数据 $g$ 和外部 Neumann 数据 $q^{+}$ 的边界积分方程：\n$$\n\\left(\\frac{1}{2}I - K_{\\Gamma}\\right)g = -S_{\\Gamma} q^{+}\n$$\n\n### 第二部分：对圆的特化及 DtN 映射\n\n对于半径为 $a$ 的圆形边界，$S_{\\Gamma}$ 和 $K_{\\Gamma}$ 算子是卷积算子，并可被复傅里叶基 $\\{e^{ik\\theta}\\}_{k \\in \\mathbb{Z}}$ 对角化。我们求出它们的特征值（符号），记为 $\\hat{S}_k$ 和 $\\hat{K}_k$。\n对于 $\\mathbf{x}, \\mathbf{y} \\in \\Gamma$，$K_{\\Gamma}$ 的核函数为 $K(\\mathbf{x},\\mathbf{y}) = \\frac{\\partial G}{\\partial n_y} = -\\frac{1}{4\\pi a}$。其符号被确定为：\n$$\n\\hat{K}_k =\n\\begin{cases}\n-1/2 & \\text{if } k=0 \\\\\n0 & \\text{if } k \\neq 0\n\\end{cases}\n$$\n$S_{\\Gamma}$ 的核函数为 $G(\\mathbf{x},\\mathbf{y}) = -\\frac{1}{2\\pi} \\ln \\lvert \\mathbf{x} - \\mathbf{y} \\rvert = -\\frac{1}{2\\pi} \\ln \\left( 2a \\left|\\sin\\left(\\frac{\\theta'-\\theta}{2}\\right)\\right| \\right)$。其符号为：\n$$\n\\hat{S}_k =\n\\begin{cases}\n-a\\ln a & \\text{if } k=0 \\text{ and } a \\neq 1 \\\\\na/(2|k|) & \\text{if } k \\neq 0\n\\end{cases}\n$$\n当 $a=1$ 时，单位圆的容量在位势论中导致一个对数奇点，使得 $\\hat{S}_0=0$。这意味着数据需要满足一个相容性条件。\n\n傅里叶空间中的 BIE 成为关于傅里叶系数 $\\hat{g}_k$ 和 $\\hat{q}^{+}_k$ 的一个代数方程：\n$$\n(\\frac{1}{2} - \\hat{K}_k)\\hat{g}_k = -\\hat{S}_k \\hat{q}^{+}_k\n$$\n现在我们可以解出 $\\hat{q}^{+}_k$，它定义了 DtN 映射 $\\Lambda^{+}: g \\mapsto q^{+}$。\n\n对于 $k \\neq 0$：\n$$\n(\\frac{1}{2} - 0)\\hat{g}_k = -\\frac{a}{2|k|} \\hat{q}^{+}_k \\quad \\implies \\quad \\hat{q}^{+}_k = -\\frac{|k|}{a}\\hat{g}_k\n$$\n\n题目指定了从内部解 $u^{-}(r,\\theta)=r^n\\cos(n\\theta)$ 导出的边界数据，因此 $g(\\theta)=a^n\\cos(n\\theta)$。对于 $n>0$，该函数均值为零，所以 $\\hat{g}_0=0$，这又意味着 $\\hat{q}^{+}_0=0$。对于给定的测试用例，我们无需进一步分析 $k=0$ 的情况。\n\n我们来求 $\\Lambda^{+}$ 在 $g(\\theta) = a^n \\cos(n\\theta)$ 上的作用。\n$g(\\theta) = \\frac{a^n}{2}(e^{in\\theta} + e^{-in\\theta})$。其非零傅里叶系数为 $\\hat{g}_n = \\hat{g}_{-n} = \\frac{a^n}{2\\pi} \\pi = a^n/2$（采用 $\\frac{1}{2\\pi}\\int$ 傅里叶积分约定）。为了与 `numpy.fft` 兼容进行归一化，我们直接对整个函数进行操作。\n$g$ 的模态 $e^{in\\theta}$ 映射为 $q^+$ 的 $-\\frac{|n|}{a}e^{in\\theta}$ 模态。根据线性性质可得：\n$$\n\\Lambda^{+}(a^n\\cos(n\\theta)) = a^n \\Lambda^{+}(\\cos(n\\theta)) = a^n \\left( -\\frac{n}{a} \\cos(n\\theta) \\right) = -n a^{n-1} \\cos(n\\theta)\n$$\n这就是精确的外部 Neumann 数据 $q^{+}_{\\mathrm{exact}}(\\theta)$。\n\n### 第三部分：数值实现与验证\n\n数值格式按如下步骤进行：\n1. 用 $N$ 个点 $\\theta_j = 2\\pi j/N$ 对 $\\Gamma$ 进行离散化。采样 $g(\\theta_j) = a^n \\cos(n\\theta_j)$。\n2. 计算 $g$ 的离散傅里叶变换（DFT），得到 $\\hat{g}_k$。\n3. 在傅里叶空间中应用 DtN 映射：对每个波数 $k$，计算 $\\hat{q}^{+}_{k, \\text{num}} = - \\frac{|k|}{a} \\hat{g}_k$。对于 $k=0$，则 $\\hat{q}^{+}_{0, \\text{num}}=0$。\n4. 通过对 $\\hat{q}^{+}_{k, \\text{num}}$ 应用逆离散傅里叶变换（Inverse DFT），计算数值外部通量 $q^{+}_{\\mathrm{num}}$。\n5. 计算精确内部通量 $q^{-}(\\theta_j) = \\partial_r(r^n\\cos(n\\theta))|_{r=a} = na^{n-1}\\cos(n\\theta_j)$。\n6. 计算精确外部通量 $q^{+}_{\\mathrm{exact}}(\\theta_j) = -na^{n-1}\\cos(n\\theta_j) = -q^{-}(\\theta_j)$。\n7. 计算误差：\n   - $E_{\\mathrm{DtN}} = \\max_{j} \\lvert q^{+}_{\\mathrm{num}}(\\theta_{j}) - q^{+}_{\\mathrm{exact}}(\\theta_{j}) \\rvert$\n   - $E_{\\mathrm{cpl}} = \\max_{j} \\lvert q^{-}(\\theta_{j}) + q^{+}_{\\mathrm{num}}(\\theta_{j}) \\rvert$\n\n由于 $q^{-}(\\theta_j) = -q^{+}_{\\mathrm{exact}}(\\theta_j)$，这两种误差度量在数学上是等价的：\n$E_{\\mathrm{cpl}} = \\max_{j} \\lvert -q^{+}_{\\mathrm{exact}}(\\theta_{j}) + q^{+}_{\\mathrm{num}}(\\theta_{j}) \\rvert = E_{\\mathrm{DtN}}$。\n数值实现将证实这一点。误差来源于傅里叶变换的离散化和浮点运算。对于欠分辨情况（$n > N/2$），混叠将是主要的误差来源。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    This program implements a Fourier-based boundary integral method to solve for the\n    exterior Dirichlet-to-Neumann (DtN) map for the 2D Laplace equation on a circle.\n    It verifies the numerical DtN map against the exact analytical map for specific\n    harmonic boundary data derived from an interior solution.\n    \"\"\"\n\n    # Test suite: (a, n, N)\n    # a: radius of the circular interface\n    # n: mode number of the harmonic data (cos(n*theta))\n    # N: number of discretization points on the circle\n    test_cases = [\n        (1.0, 1, 128),\n        (1.0, 5, 128),\n        (2.0, 3, 128),\n        (1.0, 30, 64),\n        (1.0, 10, 16),\n    ]\n\n    results = []\n\n    for a, n, N in test_cases:\n        # 1. Discretize the boundary and define data from the interior problem.\n        # N equispaced points on the circle of radius a.\n        theta = 2 * np.pi * np.arange(N) / N\n\n        # The interior potential is u^-(r, theta) = r^n * cos(n*theta).\n        # This provides the Dirichlet data g(theta) on the boundary r=a.\n        g = (a**n) * np.cos(n * theta)\n\n        # The interior normal flux is q^-(theta) = du^-/dr |_(r=a).\n        # For n=0, q- is 0. For n>0, it is n*a^(n-1)*cos(n*theta).\n        if n == 0:\n            q_minus = np.zeros(N)\n        else:\n            q_minus = n * (a**(n - 1)) * np.cos(n * theta)\n\n        # 2. Compute the numerical exterior flux q_plus_num using BIE in Fourier space.\n        # The BIE relating exterior flux q+ to Dirichlet data g is:\n        # (1/2 * I - K) * g = -S * q+\n        # This implies the DtN map in Fourier space for mode k is:\n        # q_hat_k = -inv(S_k) * (1/2 - K_k) * g_hat_k\n        \n        g_hat = np.fft.fft(g)\n        k = np.fft.fftfreq(N) * N\n\n        # The DtN map symbol (eigenvalue) for mode k is -(k/a).\n        # For k=0, the map is more complex, but for mean-zero data, flux is mean-zero.\n        # Since n>0 for all test cases, g has zero mean, so g_hat[0] is zero.\n        # This implies q_plus_hat_num[0] is also zero.\n        \n        dtn_symbol = np.zeros(N, dtype=float)\n        k_nonzero_indices = np.where(k != 0)\n        k_nonzero = k[k_nonzero_indices]\n        dtn_symbol[k_nonzero_indices] = -np.abs(k_nonzero) / a\n        \n        q_plus_hat_num = dtn_symbol * g_hat\n\n        # Transform back to physical space. Result should be real.\n        q_plus_num = np.fft.ifft(q_plus_hat_num).real\n\n        # 3. Compute the exact exterior flux q_plus_exact.\n        # The exterior solution is u^+(r,theta) = a^(2n)*r^(-n)*cos(n*theta).\n        # q_plus_exact = du+/dr |_(r=a) = -n*a^(n-1)*cos(n*theta).\n        if n == 0:\n            q_plus_exact = np.zeros(N)\n        else:\n            q_plus_exact = -n * (a**(n - 1)) * np.cos(n * theta)\n        \n        # 4. Calculate errors.\n        # Error 1: DtN map error\n        e_dtn = np.max(np.abs(q_plus_num - q_plus_exact))\n\n        # Error 2: Coupling condition violation\n        e_cpl = np.max(np.abs(q_minus + q_plus_num))\n        \n        results.append([e_dtn, e_cpl])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str(res) for res in results)}]\")\n\nsolve()\n```", "id": "2560737"}]}