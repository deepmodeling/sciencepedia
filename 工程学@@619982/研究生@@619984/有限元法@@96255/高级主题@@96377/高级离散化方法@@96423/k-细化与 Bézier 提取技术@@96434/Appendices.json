{"hands_on_practices": [{"introduction": "在将样条应用于分析之前，理解节点向量所定义的基本属性至关重要。本练习旨在训练如何“解读”一个给定的节点向量，以确定诸如连续性、单元数量和样条空间维度等关键特征，这些都是等几何分析的基石。[@problem_id:2572161]", "problem": "在有限元法以及等几何分析中 k-细化和Bézier提取概念的背景下，考虑一个单变量开放节点向量 $\\Xi=(0,0,0,0.25,0.5,0.5,0.75,1,1,1)$ 和多项式次数 $p=2$。假设此样条空间用于为等几何分析构建基函数，并且将应用Bézier提取以获得单元级别的伯恩斯坦基。\n\n从B样条和节点重复度的核心定义出发，确定：\n- 每个内部节点（即 $0.25$, $0.5$, 和 $0.75$）处的连续性阶数 $C^{s}$，\n- 由Bézier提取生成的单元数量（解释为非零长度节点区间的数量），\n- 样条空间 $S_{p,\\Xi}$ 的维数。\n\n将您的最终答案以单行向量的形式，并按照 $\\big($$0.25$ 处的连续性阶数、$0.5$ 处的连续性阶数、$0.75$ 处的连续性阶数、单元数量、$S_{p,\\Xi}$ 的维数$\\big)$ 的顺序给出。无需四舍五入。无需单位。最终答案必须是指定的单行向量。", "solution": "所提出的问题是有效的，因为它在科学上基于B样条的数学理论，而B样条理论是等几何分析的基础。这是一个适定问题，提供了所有必要信息——节点向量和多项式次数——以唯一地确定样条空间所需的性质。该问题是客观且可形式化的。我们将着手进行解答。\n\n该问题要求确定由给定节点向量和多项式次数定义的B样条空间的三个性质。让我们系统地分析每个要求。\n\n首先，给定多项式次数 $p=2$ 和开放节点向量 $\\Xi=(\\xi_1, \\xi_2, ..., \\xi_{10}) = (0,0,0,0.25,0.5,0.5,0.75,1,1,1)$。\n\n第一个任务是确定每个内部节点的连续性阶数，记为 $C^s$。内部节点是严格位于最小和最大节点值之间的节点。$\\Xi$ 中的唯一节点为 $\\hat{\\Xi}=\\{0, 0.25, 0.5, 0.75, 1\\}$。因此，内部节点为 $\\{0.25, 0.5, 0.75\\}$。\n\nB样条函数在节点 $\\xi$ 处的连续性由该节点在节点向量中的重复度决定。如果一个节点 $\\xi$ 的重复度为 $m$，则样条基函数在该节点处是 $C^{p-m}$ 阶连续的。因此，连续性阶数 $s$ 为 $s = p - m$。\n\n1.  在节点 $\\xi = 0.25$ 处：该节点在节点向量 $\\Xi$ 中出现一次。因此，其重复度为 $m=1$。该节点的连续性阶数 $s$ 计算如下：\n    $$s_{0.25} = p - m = 2 - 1 = 1$$\n    所以，样条在 $\\xi = 0.25$ 处是 $C^1$ 连续的。\n\n2.  在节点 $\\xi = 0.5$ 处：该节点在节点向量 $\\Xi$ 中出现两次。因此，其重复度为 $m=2$。该节点的连续性阶数 $s$ 为：\n    $$s_{0.5} = p - m = 2 - 2 = 0$$\n    所以，样条在 $\\xi = 0.5$ 处是 $C^0$ 连续的。\n\n3.  在节点 $\\xi = 0.75$ 处：该节点在节点向量 $\\Xi$ 中出现一次。因此，其重复度为 $m=1$。该节点的连续性阶数 $s$ 为：\n    $$s_{0.75} = p - m = 2 - 1 = 1$$\n    所以，样条在 $\\xi = 0.75$ 处是 $C^1$ 连续的。\n\n第二个任务是确定由Bézier提取生成的单元数量。在等几何分析的背景下，一个“单元”对应于一个非零长度的节点区间。Bézier提取是产生B样条基的单元局部伯恩斯坦表示的过程。此类单元的数量等于由节点向量中的唯一节点定义的区间数量。\n\n唯一节点的集合为 $\\hat{\\Xi}=\\{0, 0.25, 0.5, 0.75, 1\\}$。这些节点定义了以下非零长度的节点区间（区间）：$[0, 0.25]$、$[0.25, 0.5]$、$[0.5, 0.75]$ 和 $[0.75, 1]$。共有 $4$ 个这样的区间。因此，单元数量为 $4$。\n\n第三个任务是求样条空间 $S_{p,\\Xi}$ 的维数。B样条空间的维数等于B样条基函数的数量，由以下公式给出：\n$$\\text{dim}(S_{p,\\Xi}) = n = (\\text{number of knots}) - p - 1$$\n给定节点向量 $\\Xi$ 的长度为 $10$。多项式次数为 $p=2$。\n将这些值代入公式中：\n$$\\text{dim}(S_{p,\\Xi}) = 10 - 2 - 1 = 7$$\n因此，该样条空间的维数为 $7$。\n\n最后，我们被要求将结果以指定顺序的单个行向量形式呈现：（$0.25$ 处的连续性阶数、$0.5$ 处的连续性阶数、$0.75$ 处的连续性阶数、单元数量、$S_{p,\\Xi}$ 的维数）。根据我们的计算，该向量为 $(1, 0, 1, 4, 7)$。", "answer": "$$\\boxed{\\begin{pmatrix} 1 & 0 & 1 & 4 & 7 \\end{pmatrix}}$$", "id": "2572161"}, {"introduction": "等几何分析的一个主要优势是能够轻易构建具有高阶精度和高阶光滑度的基函数。本练习将演示 k-细化 过程，这是一种通过同时提升多项式次数和插入节点来控制连续性，从而创建功能更强大的基函数的系统性技术。[@problem_id:2572192]", "problem": "考虑一个一维参数域，其由开放节点向量 $\\Xi=(0,0,0,1,1,1)$ 和多项式次数 $p=2$ (二次) 表示。要求你应用 k-细化，以获得两个参数长度均匀的单元，并为所得的三次基函数强制实现 $C^{2}$ 内部连续性。请仅从 B 样条和 k-细化 的核心定义出发，按以下方式进行：\n\n- 使用开放节点向量的定义来刻画一个 $p$ 次样条的端点重数以及升阶如何影响它们。\n- 使用内部节点重数 $r$ 和连续性 $C^{p-r}$ 之间的关系，确定在三次情况下，为达到 $C^{2}$ 连续性，内部节点所需的重数。\n- 使用开放 B 样条的节点数量和基函数数量之间的标准计数关系，来确定细化后新的基函数数量。\n- 在 Bézier 提取的背景下解释结果，以证明所得的参数化支持逐单元的 $p$ 次 Bernstein 多项式表示，而无需显式构造任何提取矩阵。\n\n具体执行以下步骤：\n1. 将次数从 $p=2$ 提升到 $p=3$，同时保持开放端点条件。\n2. 在 $\\xi=\\frac{1}{2}$ 处插入一个内部节点，其重数为实现三次基函数 $C^{2}$ 内部连续性所需的最小重数。\n3. 确定最终的节点向量和基函数的总数。\n\n将最终结果表示为一个行矩阵，其中第一个条目是最终的节点向量（写成加括号的非递减序列），第二个条目是基函数的数量。无需四舍五入，也不涉及任何单位。你的最终答案必须是按规定形式的单一数学对象。", "solution": "该问题要求对给定的一维 B 样条空间应用 k-细化，该过程包括升阶和节点插入。我们将通过系统地应用 B 样条理论的定义和定理来求解。\n\n初始配置是一个由开放节点向量 $\\Xi = (0, 0, 0, 1, 1, 1)$ 定义的次数为 $p=2$ 的样条。节点数量为 $m+1 = 6$。对于一个开放节点向量，基函数的数量 $n$ 由关系式 $n = (m+1) - p - 1$ 给出，从而得到 $n = 6 - 2 - 1 = 3$。端点节点 $0$ 和 $1$ 的重数为 $k=3$。由于该重数等于 $p+1$，此配置描述了参数域 $[0, 1]$ 上的一条单一二次 Bézier 曲线。\n\n第一步是从 $p=2$ 升阶到 $p'=3$。为保持样条的几何形状和参数化，每个多项式段的次数都增加一。这是通过将每个现有节点的重数增加一来实现的。初始节点向量 $\\Xi = (0, 0, 0, 1, 1, 1)$ 包含唯一节点 $0$ 和 $1$，两者重数均为 $3$。将每个重数增加 $1$ 会得到三次样条的新节点向量 $\\Xi'$：\n$$\n\\Xi' = (0, 0, 0, 0, 1, 1, 1, 1)\n$$\n这个新的节点向量有 $m'+1 = 8$ 个节点。现在的次数是 $p'=3$。基函数的数量为 $n' = (m'+1) - p' - 1 = 8 - 3 - 1 = 4$。端点重数现在为 $4$，这正确地满足了 $3$ 次开放节点向量的条件（重数为 $p'+1 = 3+1=4$）。此空间表示一条单一的三次 Bézier 曲线，它是原始二次曲线的升阶形式。\n\n第二步是插入一个内部节点以创建两个单元，并在新的界面上达到特定的连续性。问题要求在域 $[0, 1]$ 上有两个参数长度均匀的单元，这需要在 $\\xi=\\frac{1}{2}$ 处插入一个节点。所得三次基 ($p'=3$) 要求的内部连续性被指定为 $C^{2}$。B 样条在节点处的连续性由关系 $C^{p-r}$ 确定，其中 $p$ 是多项式次数，$r$ 是节点的重数。为了用三次 ($p'=3$) 基达到 $C^2$ 连续性，我们必须满足以下方程：\n$$\n2 = p' - r = 3 - r\n$$\n解出所需的重数 $r$ 得到 $r=1$。因此，我们必须将节点 $\\xi=\\frac{1}{2}$ 以重数 $1$ 插入到节点向量 $\\Xi'$ 中。从 $\\Xi' = (0, 0, 0, 0, 1, 1, 1, 1)$ 开始，我们插入数值 $\\frac{1}{2}$ 一次，同时保持节点的非递减顺序。\n\n第三步是确定最终的节点向量和相应的基函数数量。插入过程产生最终的节点向量 $\\Xi_{final}$：\n$$\n\\Xi_{final} = (0, 0, 0, 0, \\frac{1}{2}, 1, 1, 1, 1)\n$$\n该节点向量总共有 $m_{final}+1 = 9$ 个节点。当次数为 $p_{final}=p'=3$ 时，基函数的总数 $n_{final}$ 计算如下：\n$$\nn_{final} = (m_{final}+1) - p_{final} - 1 = 9 - 3 - 1 = 5\n$$\n所以，最终细化后的空间由 5 个三次 B 样条基函数组成。唯一节点是 $0$、$\\frac{1}{2}$ 和 $1$，它们定义了两个不同的单元（长度非零的区间）：$[0, \\frac{1}{2}]$ 和 $[\\frac{1}{2}, 1]$。\n\n最后，我们讨论在 Bézier 提取背景下的解释。Bézier 提取过程建立在这样一个原理之上：任何 B 样条都可以表示为一组 Bézier 段的集合，每个单元对应一个 Bézier 段。这是通过使用节点插入来增加单元边界节点的重数，直到这些边界处的连续性降至 $C^0$ 来实现的。对于一个次数为 $p$ 的样条，这要求内部节点的重数为 $p$。我们最终的样条次数为 $p=3$，且内部节点 $\\xi=\\frac{1}{2}$ 的重数为 $r=1$。其连续性为 $C^{3-1} = C^2$。通过应用 Boehm 节点插入算法，我们可以在不改变几何形状的情况下，将节点 $\\xi=\\frac{1}{2}$ 额外插入 $p-r = 3-1=2$ 次。这会将其重数提高到 3。此时，在 $\\xi=\\frac{1}{2}$ 处的连续性变为 $C^{3-3}=C^0$。单元 $[0, \\frac{1}{2}]$ 上所得的基函数成为缩放到该区间的三次 Bernstein 多项式。对于单元 $[\\frac{1}{2}, 1]$ 也是如此。这个不改变样条的细化路径的存在，证实了该参数化支持一个逐单元的 3 次 Bernstein 多项式表示。原始 B 样条基和分段 Bernstein 基通过一个线性变换相关联，该变换的矩阵即为 Bézier 提取算子。\n\n最终答案由最终的节点向量和基函数的总数组成。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n(0, 0, 0, 0, \\frac{1}{2}, 1, 1, 1, 1) & 5\n\\end{pmatrix}\n}\n$$", "id": "2572192"}, {"introduction": "当 B样条在有限元框架内用于解决物理问题时，其在工程领域的全部潜力才得以释放。这项综合性练习阐释了 Bézier 提取技术如何提供一个以单元为中心的视角，从而简化系统矩阵的组装过程，并将几何表示与分析模型有效地联系起来。[@problem_id:2572110]", "problem": "考虑一个占据参数区间 $[0,1]$ 的一维杆。假设无量纲化的质量密度乘以横截面积等于 $1$，因此相容质量矩阵是纯几何的。试探空间是通过在开放、均匀的节点向量\n$\\Xi = \\left[0,0,0,\\frac{1}{4},\\frac{1}{2},\\frac{3}{4},1,1,1\\right]$,\n上进行 k-细化得到的二次、$C^{1}$-连续的 B样条基，这产生了一个由大小为 $h=\\frac{1}{4}$ 的四个单元组成的均匀网格和 $6$ 个全局基函数。使用 Bézier 提取，从第一性原理出发，完成以下步骤：\n\n1. 在单位区间 $t\\in[0,1]$ 上定义二次 Bernstein 基 $\\{B_{0}(t),B_{1}(t),B_{2}(t)\\}$，并定义从 $[0,1]$ 到每个大小为 $h=\\frac{1}{4}$ 的单元 $e$ 的单元仿射映射 $x = x_{e}(t)$。将单元 $e$ 的 Bézier 提取算子表示为 $C^{(e)}\\in\\mathbb{R}^{3\\times 3}$，使得限制在单元 $e$ 上的单元 B样条基函数向量可以写成 $N^{(e)}(t) = C^{(e)}\\,b(t)$，其中 $b(t) = [B_{0}(t),B_{1}(t),B_{2}(t)]^{T}$。\n\n2. 利用相容质量矩阵的定义和单元映射下的变量替换，推导单元质量矩阵 $M^{(e)}\\in\\mathbb{R}^{3\\times 3}$ 关于 $h$、提取矩阵 $C^{(e)}$ 和 Bernstein Gram 矩阵 $G_{B} = \\int_{0}^{1} b(t)b(t)^{T}\\,\\mathrm{d}t$ 的表达式。\n\n3. 通过积分在 $[0,1]$ 上的二次 Bernstein 多项式的乘积来精确计算 $G_{B}$。\n\n4. 使用由 $\\Xi$ 所蕴含的规范 $C^{1}$ B样条连通性，从四个单元矩阵 $\\{M^{(e)}\\}_{e=1}^{4}$ 组装全局质量矩阵 $M\\in\\mathbb{R}^{6\\times 6}$。组装过程必须用 $h$、$G_{B}$ 和提取矩阵 $\\{C^{(e)}\\}$ 明确表示。\n\n5. 仅使用 B样条和 Bézier 提取的定义属性，验证组装的矩阵 $M$ 是对称和对称正定的 (SPD)，其中对称正定 (SPD) 意味着对于所有非零向量 $\\mathbf{v}$，都有 $M^{T}=M$ 和 $\\mathbf{v}^{T}M\\mathbf{v}>0$。\n\n6. 令 $\\mathbf{1}\\in\\mathbb{R}^{6}$ 表示所有分量都为 $1$ 的向量。计算标量\n$$q \\;=\\; \\mathbf{1}^{T} M \\mathbf{1}.$$\n将 $q$ 作为一个无单位的精确实数报告。\n\n您的最终答案必须仅为 $q$ 的单个值。不要在最终答案中包含任何中间表达式。", "solution": "本问题要求使用由特定节点向量定义的 $C^{1}$-连续二次 B样条基，为一维杆组装全局相容质量矩阵，然后计算标量 $q = \\mathbf{1}^{T} M \\mathbf{1}$。\n\n此问题是有效的。它在科学上基于有限元法和等几何分析的原理。该问题是适定的、客观的，并包含了推导出唯一解所需的所有必要信息。\n\n将遵循问题陈述中规定的六个步骤来构建解答。\n\n步骤 1：Bernstein 基和单元映射\n\n在单位区间 $t \\in [0,1]$ 上的二次 Bernstein 基函数定义如下：\n$$B_{0}(t) = \\binom{2}{0} (1-t)^{2}t^{0} = (1-t)^{2}$$\n$$B_{1}(t) = \\binom{2}{1} (1-t)^{1}t^{1} = 2t(1-t)$$\n$$B_{2}(t) = \\binom{2}{2} (1-t)^{0}t^{2} = t^{2}$$\nBernstein 基函数向量为 $b(t) = [B_{0}(t), B_{1}(t), B_{2}(t)]^{T}$。这些函数构成单位分解，即 $\\sum_{i=0}^{2} B_{i}(t) = 1$。\n\n网格由四个大小为 $h=\\frac{1}{4}$ 的均匀单元组成：$[0,\\frac{1}{4}]$, $[\\frac{1}{4},\\frac{1}{2}]$, $[\\frac{1}{2},\\frac{3}{4}]$, 和 $[\\frac{3}{4},1]$。从参数坐标 $t \\in [0,1]$ 到跨越区间 $[x_{e-1}, x_{e}]$ 的单元 $e$ 中的物理坐标 $x$ 的仿射映射由下式给出：\n$$x_{e}(t) = x_{e-1} + (x_{e} - x_{e-1})t = (e-1)h + ht$$\n该变换的雅可比行列式为 $\\frac{\\mathrm{d}x}{\\mathrm{d}t} = h = \\frac{1}{4}$。\n\n步骤 2：单元质量矩阵的构建\n\n单元质量矩阵 $M^{(e)}$ 的各项是针对在单元 $e$ 上活跃的基函数而言的，这些基函数由向量 $N^{(e)}(x)$ 表示，其各项由下式给出：\n$$(M^{(e)})_{ij} = \\int_{x_{e-1}}^{x_e} N^{(e)}_i(x) N^{(e)}_j(x) \\,\\mathrm{d}x$$\n使用变量替换 $x=x_e(t)$ 和 $\\mathrm{d}x = h\\,\\mathrm{d}t$，我们得到：\n$$M^{(e)} = \\int_{0}^{1} N^{(e)}(x_e(t)) (N^{(e)}(x_e(t)))^{T} h \\,\\mathrm{d}t$$\n使用 Bézier 提取关系 $N^{(e)}(t) = C^{(e)} b(t)$，其中 $C^{(e)}$ 是单元 $e$ 的常数提取算子：\n$$M^{(e)} = h \\int_{0}^{1} (C^{(e)} b(t)) (C^{(e)} b(t))^{T} \\,\\mathrm{d}t = h \\int_{0}^{1} C^{(e)} b(t) b(t)^{T} (C^{(e)})^{T} \\,\\mathrm{d}t$$\n由于 $C^{(e)}$ 是常数，可以将其从积分中提出：\n$$M^{(e)} = h C^{(e)} \\left( \\int_{0}^{1} b(t) b(t)^{T} \\,\\mathrm{d}t \\right) (C^{(e)})^{T}$$\n这就得到了以 Bernstein Gram 矩阵 $G_{B} = \\int_{0}^{1} b(t)b(t)^{T}\\,\\mathrm{d}t$ 表示的单元质量矩阵的表达式：\n$$M^{(e)} = h C^{(e)} G_{B} (C^{(e)})^{T}$$\n\n步骤 3：计算 Bernstein Gram 矩阵 $G_B$\n\n$G_{B}$ 的项为 $(G_{B})_{ij} = \\int_{0}^{1} B_{i-1}(t) B_{j-1}(t) \\,\\mathrm{d}t$。我们计算所需的积分：\n$\\int_{0}^{1} B_{0}(t)^2 \\,\\mathrm{d}t = \\int_{0}^{1} (1-t)^4 \\,\\mathrm{d}t = \\frac{1}{5}$\n$\\int_{0}^{1} B_{1}(t)^2 \\,\\mathrm{d}t = \\int_{0}^{1} 4t^2(1-t)^2 \\,\\mathrm{d}t = 4 \\frac{2!2!}{5!} = \\frac{2}{15}$\n$\\int_{0}^{1} B_{2}(t)^2 \\,\\mathrm{d}t = \\int_{0}^{1} t^4 \\,\\mathrm{d}t = \\frac{1}{5}$\n$\\int_{0}^{1} B_{0}(t)B_{1}(t) \\,\\mathrm{d}t = \\int_{0}^{1} 2t(1-t)^3 \\,\\mathrm{d}t = 2 \\frac{1!3!}{5!} = \\frac{1}{10}$\n$\\int_{0}^{1} B_{0}(t)B_{2}(t) \\,\\mathrm{d}t = \\int_{0}^{1} t^2(1-t)^2 \\,\\mathrm{d}t = \\frac{2!2!}{5!} = \\frac{1}{30}$\n$\\int_{0}^{1} B_{1}(t)B_{2}(t) \\,\\mathrm{d}t = \\int_{0}^{1} 2t^3(1-t) \\,\\mathrm{d}t = 2 \\frac{3!1!}{5!} = \\frac{1}{10}$\n得到的 Bernstein Gram 矩阵是：\n$$G_{B} = \\begin{pmatrix} \\frac{1}{5} & \\frac{1}{10} & \\frac{1}{30} \\\\ \\frac{1}{10} & \\frac{2}{15} & \\frac{1}{10} \\\\ \\frac{1}{30} & \\frac{1}{10} & \\frac{1}{5} \\end{pmatrix} = \\frac{1}{30} \\begin{pmatrix} 6 & 3 & 1 \\\\ 3 & 4 & 3 \\\\ 1 & 3 & 6 \\end{pmatrix}$$\n\n步骤 4：组装全局质量矩阵 $M$\n\n节点向量 $\\Xi = \\left[0,0,0,\\frac{1}{4},\\frac{1}{2},\\frac{3}{4},1,1,1\\right]$ 定义了 $n=6$ 个二次 ($p=2$) B样条基函数。每个单元上的活跃基函数为：\n- 单元 $1 \\ [0, \\frac{1}{4}]$: $\\{N_1, N_2, N_3\\}$\n- 单元 $2 \\ [\\frac{1}{4}, \\frac{1}{2}]$: $\\{N_2, N_3, N_4\\}$\n- 单元 $3 \\ [\\frac{1}{2}, \\frac{3}{4}]$: $\\{N_3, N_4, N_5\\}$\n- 单元 $4 \\ [\\frac{3}{4}, 1]$: $\\{N_4, N_5, N_6\\}$\n\n对于均匀的 $C^1$-连续二次样条，标准的 Bézier 提取矩阵是：\n$$C^{(1)} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & \\frac{1}{2} \\\\ 0 & 0 & \\frac{1}{2} \\end{pmatrix}, \\quad C^{(2)}=C^{(3)}=C^{(\\text{int})} = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ \\frac{1}{2} & 1 & \\frac{1}{2} \\\\ 0 & 0 & \\frac{1}{2} \\end{pmatrix}, \\quad C^{(4)} = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ \\frac{1}{2} & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\n我们计算 $h=\\frac{1}{4}$ 时的单元质量矩阵：\n$$M^{(1)} = \\frac{1}{4} C^{(1)} G_B (C^{(1)})^{T} = \\frac{1}{240} \\begin{pmatrix} 12 & 7 & 1 \\\\ 7 & 17 & 6 \\\\ 1 & 6 & 3 \\end{pmatrix} = \\frac{1}{480} \\begin{pmatrix} 24 & 14 & 2 \\\\ 14 & 34 & 12 \\\\ 2 & 12 & 6 \\end{pmatrix}$$\n$$M^{(2)} = M^{(3)} = \\frac{1}{4} C^{(\\text{int})} G_B (C^{(\\text{int})})^{T} = \\frac{1}{480} \\begin{pmatrix} 6 & 13 & 1 \\\\ 13 & 54 & 13 \\\\ 1 & 13 & 6 \\end{pmatrix}$$\n$$M^{(4)} = \\frac{1}{4} C^{(4)} G_B (C^{(4)})^{T} = \\frac{1}{240} \\begin{pmatrix} 3 & 6 & 1 \\\\ 6 & 17 & 7 \\\\ 1 & 7 & 12 \\end{pmatrix} = \\frac{1}{480} \\begin{pmatrix} 6 & 12 & 2 \\\\ 12 & 34 & 14 \\\\ 2 & 14 & 24 \\end{pmatrix}$$\n全局质量矩阵 $M \\in \\mathbb{R}^{6 \\times 6}$ 是通过根据自由度对单元贡献求和来组装的：\n$M(1:3, 1:3) \\mathrel{+}= M^{(1)}$\n$M(2:4, 2:4) \\mathrel{+}= M^{(2)}$\n$M(3:5, 3:5) \\mathrel{+}= M^{(3)}$\n$M(4:6, 4:6) \\mathrel{+}= M^{(4)}$\n这产生了全局质量矩阵：\n$$M = \\frac{1}{480} \\begin{pmatrix}\n24 & 14 & 2 & 0 & 0 & 0 \\\\\n14 & 40 & 25 & 1 & 0 & 0 \\\\\n2 & 25 & 66 & 26 & 1 & 0 \\\\\n0 & 1 & 26 & 66 & 25 & 2 \\\\\n0 & 0 & 1 & 25 & 40 & 14 \\\\\n0 & 0 & 0 & 2 & 14 & 24\n\\end{pmatrix}$$\n\n步骤 5：对称性和正定性的验证\n\n对称性：质量矩阵定义为 $M_{ij} = \\int_{0}^{1} N_i(x)N_j(x)\\,\\mathrm{d}x$。由于标量乘法是可交换的，$N_i(x)N_j(x) = N_j(x)N_i(x)$，这意味着 $M_{ij} = M_{ji}$。因此，$M$ 根据定义是对称的。我们组装的矩阵显然是对称的。\n\n对称正定 (SPD)：我们必须证明对于任何非零向量 $\\mathbf{v} \\in \\mathbb{R}^6$，都有 $\\mathbf{v}^{T}M\\mathbf{v}>0$。设 $u(x) = \\sum_{i=1}^6 v_i N_i(x)$ 是 B样条空间中的一个函数。其二次型为：\n$$\\mathbf{v}^{T}M\\mathbf{v} = \\sum_{i=1}^6 \\sum_{j=1}^6 v_i M_{ij} v_j = \\sum_{i=1}^6 \\sum_{j=1}^6 v_i \\left( \\int_0^1 N_i(x) N_j(x) \\,\\mathrm{d}x \\right) v_j = \\int_0^1 \\left(\\sum_{i=1}^6 v_i N_i(x)\\right)\\left(\\sum_{j=1}^6 v_j N_j(x)\\right) \\,\\mathrm{d}x = \\int_0^1 [u(x)]^2 \\,\\mathrm{d}x$$\nB样条基函数 $\\{N_i(x)\\}_{i=1}^6$ 是线性无关的。因此，如果 $\\mathbf{v} \\neq \\mathbf{0}$，那么 $u(x)$ 不是零函数。由于 $u(x)$ 是连续的且不恒为零，其平方 $[u(x)]^2$ 是非负的，并且在 $[0,1]$ 的某个子区间上是严格为正的。因此，积分 $\\int_0^1 [u(x)]^2 \\,\\mathrm{d}x$ 是严格为正的。这证明了 $M$ 是对称正定的。\n\n步骤 6：计算 $q = \\mathbf{1}^{T} M \\mathbf{1}$\n\n通过在上面推导的二次型中设置 $\\mathbf{v} = \\mathbf{1} = [1, 1, 1, 1, 1, 1]^T$，可以计算出量 $q$。对应的函数是 $u(x) = \\sum_{i=1}^6 (1) \\cdot N_i(x)$。在开放节点向量（其中首尾节点具有 $p+1$ 的重数）上定义的 B样条基的一个基本性质是，基函数在定义域上构成单位分解。节点向量 $\\Xi$ 的首尾节点对于次数 $p=2$ 具有 $3$ 的重数，因此基函数在定义域 $[0,1]$ 上的和为 1：\n$$\\sum_{i=1}^6 N_i(x) = 1, \\quad \\forall x \\in [0,1]$$\n因此，$u(x)=1$。$q$ 的计算变得非常简单：\n$$q = \\mathbf{1}^{T} M \\mathbf{1} = \\int_0^1 \\left( \\sum_{i=1}^6 N_i(x) \\right)^2 \\,\\mathrm{d}x = \\int_0^1 (1)^2 \\,\\mathrm{d}x = \\int_0^1 1 \\,\\mathrm{d}x = [x]_0^1 = 1$$\n这个结果可以通过直接对组装的矩阵 $M$ 的所有项求和来验证：\n$$q = \\sum_{i=1}^6 \\sum_{j=1}^6 M_{ij} = \\frac{1}{480} \\left( (24+14+2) + (14+40+25+1) + \\dots \\right)$$\n对行和求和：\n$$q = \\frac{1}{480} (40 + 80 + 120 + 120 + 80 + 40) = \\frac{480}{480} = 1$$\n直接求和证实了理论结果。", "answer": "$$\\boxed{1}$$", "id": "2572110"}]}