{"hands_on_practices": [{"introduction": "要真正理解拉格朗日单元族和偶遇单元族之间的区别，关键在于掌握它们各自所包含的多项式空间。本练习通过一个具体的例子——分解一个高阶单项式 $\\xi^2\\eta^2$——来直接探讨这一核心差异 [@problem_id:2594813]。通过这个过程，你将清晰地看到偶遇单元是如何通过省略内部的“气泡函数”而成为拉格朗日单元的一个真子集，从而在保持边界精度的同时降低计算复杂性。", "problem": "令 $\\hat K=[-1,1]^{2}$ 为参考四边形，其坐标为 $(\\xi,\\eta)$。令 $\\mathcal{Q}_{2}(\\hat K)$ 为每个变量的次数至多为 $2$ 的多项式空间，二次偶遇 (serendipity) 空间 $\\mathcal{S}_{2}(\\hat K)$ 由超线性次数特征定义：单项式 $\\xi^{a}\\eta^{b}$ 属于 $\\mathcal{S}_{r}(\\hat K)$ 当且仅当其大于或等于2的指数之和不大于 $r$。等价地，二次偶遇空间 $\\mathcal{S}_{2}(\\hat K)$ 是 $\\mathcal{Q}_{2}(\\hat K)$ 的一个 $8$ 维子空间，其在边界 $\\partial\\hat K$ 上的迹与 $\\mathcal{Q}_{2}(\\hat K)$ 的迹重合，并且不包含内部气泡模式。\n\n定义二次气泡函数为 $b(\\xi,\\eta)=(1-\\xi^{2})(1-\\eta^{2})$。已知任何 $p\\in \\mathcal{Q}_{2}(\\hat K)$ 都存在唯一的分解 $p=\\alpha\\,b+s$，其中 $\\alpha\\in\\mathbb{R}$ 且 $s\\in \\mathcal{S}_{2}(\\hat K)$。\n\n仅使用上述基本定义并从第一性原理出发进行推理，确定在下述分解式中唯一的标量 $\\alpha\\in\\mathbb{R}$：\n$$\np(\\xi,\\eta)=\\xi^{2}\\eta^{2}=\\alpha\\,b(\\xi,\\eta)+s(\\xi,\\eta),\\quad s\\in \\mathcal{S}_{2}(\\hat K).\n$$\n推导过程必须通过显式构造 $s$ 或展示一个能够湮没 $\\mathcal{S}_{2}(\\hat K)$ 但不能湮没 $\\xi^{2}\\eta^{2}$ 的约束泛函，来论证 $\\xi^{2}\\eta^{2}$ 是否属于 $\\mathcal{S}_{2}(\\hat K)$。请给出 $\\alpha$ 的值作为最终答案。无需四舍五入。", "solution": "问题在于，在将多项式 $p(\\xi, \\eta) = \\xi^{2}\\eta^{2}$ 分解为一个与二次气泡函数 $b(\\xi, \\eta)$ 成比例的分量和一个来自二次偶遇空间 $\\mathcal{S}_{2}(\\hat K)$ 的分量 $s(\\xi, \\eta)$ 时，确定唯一的标量 $\\alpha \\in \\mathbb{R}$。给定的分解式为\n$$\np(\\xi, \\eta) = \\alpha \\, b(\\xi, \\eta) + s(\\xi, \\eta)\n$$\n其中 $p(\\xi, \\eta) = \\xi^{2}\\eta^{2}$，$b(\\xi, \\eta) = (1 - \\xi^{2})(1 - \\eta^{2})$，且 $s(\\xi, \\eta) \\in \\mathcal{S}_{2}(\\hat K)$。\n\n首先，我们必须精确地刻画空间 $\\mathcal{S}_{2}(\\hat K)$。问题基于其单项式基给出了一个明确的刻画。一个单项式 $\\xi^{a}\\eta^{b}$ 是 $\\mathcal{S}_{r}(\\hat K)$ 的基元，当且仅当其大于或等于2的指数之和不大于 $r$。在我们的情况中，$r=2$。参考正方形 $\\hat K = [-1, 1]^{2}$ 上的双二次多项式空间 $\\mathcal{Q}_{2}(\\hat K)$ 由 $9$ 个单项式 $\\{ \\xi^{a}\\eta^{b} \\mid a, b \\in \\{0, 1, 2\\} \\}$ 张成。我们检验每个单项式是否属于 $\\mathcal{S}_{2}(\\hat K)$ 的基。令 $\\delta(k) = k$ 如果 $k \\ge 2$，且 $\\delta(k)=0$ 如果 $k < 2$。单项式 $\\xi^{a}\\eta^{b}$ 被包含的条件是 $\\delta(a) + \\delta(b) \\le 2$。\n\n- 对于 $\\{1, \\xi, \\eta, \\xi\\eta\\}$，两个指数都小于 $2$，所以 $\\delta(a)+\\delta(b) = 0 \\le 2$。它们属于 $\\mathcal{S}_{2}(\\hat K)$。\n- 对于 $\\xi^{2}$，我们有 $a=2, b=0$。$\\delta(2) + \\delta(0) = 2+0=2 \\le 2$。它属于 $\\mathcal{S}_{2}(\\hat K)$。\n- 对于 $\\eta^{2}$，我们有 $a=0, b=2$。$\\delta(0) + \\delta(2) = 0+2=2 \\le 2$。它属于 $\\mathcal{S}_{2}(\\hat K)$。\n- 对于 $\\xi^{2}\\eta$，我们有 $a=2, b=1$。$\\delta(2) + \\delta(1) = 2+0=2 \\le 2$。它属于 $\\mathcal{S}_{2}(\\hat K)$。\n- 对于 $\\xi\\eta^{2}$，我们有 $a=1, b=2$。$\\delta(1) + \\delta(2) = 0+2=2 \\le 2$。它属于 $\\mathcal{S}_{2}(\\hat K)$。\n- 对于 $\\xi^{2}\\eta^{2}$，我们有 $a=2, b=2$。$\\delta(2) + \\delta(2) = 2+2=4 > 2$。这个单项式不属于 $\\mathcal{S}_{2}(\\hat K)$。\n\n该分析明确地证明了多项式 $p(\\xi, \\eta) = \\xi^{2}\\eta^{2}$ 不属于空间 $\\mathcal{S}_{2}(\\hat K)$，正如题目所要求的那样。空间 $\\mathcal{S}_{2}(\\hat K)$ 是由单项式基 $\\{1, \\xi, \\eta, \\xi\\eta, \\xi^{2}, \\eta^{2}, \\xi^{2}\\eta, \\xi\\eta^{2}\\}$ 张成的 $8$ 维空间。因此，任何多项式 $s \\in \\mathcal{S}_{2}(\\hat K)$，当用 $\\mathcal{Q}_{2}(\\hat K)$ 的单项式基表示时，其 $\\xi^{2}\\eta^{2}$ 项的系数必须为零。\n\n现在我们来求 $\\alpha$。气泡函数展开为\n$$\nb(\\xi, \\eta) = (1 - \\xi^{2})(1 - \\eta^{2}) = 1 - \\xi^{2} - \\eta^{2} + \\xi^{2}\\eta^{2}.\n$$\n将此式与 $p(\\xi, \\eta) = \\xi^{2}\\eta^{2}$ 代入分解方程中：\n$$\n\\xi^{2}\\eta^{2} = \\alpha (1 - \\xi^{2} - \\eta^{2} + \\xi^{2}\\eta^{2}) + s(\\xi, \\eta).\n$$\n为了确定 $s(\\xi, \\eta)$ 的性质，我们将其分离出来：\n$$\ns(\\xi, \\eta) = \\xi^{2}\\eta^{2} - \\alpha (1 - \\xi^{2} - \\eta^{2} + \\xi^{2}\\eta^{2})\n$$\n$$\ns(\\xi, \\eta) = \\xi^{2}\\eta^{2} - \\alpha + \\alpha\\xi^{2} + \\alpha\\eta^{2} - \\alpha\\xi^{2}\\eta^{2}.\n$$\n按单项式合并同类项，我们得到 $s(\\xi, \\eta)$ 在标准单项式基下的表达式：\n$$\ns(\\xi, \\eta) = (1 - \\alpha)\\xi^{2}\\eta^{2} + \\alpha\\xi^{2} + \\alpha\\eta^{2} - \\alpha.\n$$\n为使 $s(\\xi, \\eta)$ 成为 $\\mathcal{S}_{2}(\\hat K)$ 中的一个元素，$\\xi^{2}\\eta^{2}$ 项的系数必须为零。这为 $\\alpha$ 提供了一个充要条件：\n$$\n1 - \\alpha = 0.\n$$\n解出 $\\alpha$ 得到唯一值：\n$$\n\\alpha = 1.\n$$\n当 $\\alpha=1$ 时，我们可以按要求显式构造偶遇分量 $s(\\xi, \\eta)$：\n$$\ns(\\xi, \\eta) = (1 - 1)\\xi^{2}\\eta^{2} + (1)\\xi^{2} + (1)\\eta^{2} - 1 = \\xi^{2} + \\eta^{2} - 1.\n$$\n这个多项式 $s(\\xi, \\eta) = \\xi^{2} + \\eta^{2} - 1$ 是基元 $\\{1, \\xi^{2}, \\eta^{2}\\}$ 的线性组合，而这些基元都属于 $\\mathcal{S}_{2}(\\hat K)$。因此，$s(\\xi, \\eta)$ 确实在 $\\mathcal{S}_{2}(\\hat K)$ 中。因此，唯一的分解是：\n$$\n\\xi^{2}\\eta^{2} = 1 \\cdot (1 - \\xi^{2})(1 - \\eta^{2}) + (\\xi^{2} + \\eta^{2} - 1).\n$$\n标量 $\\alpha$ 的值被唯一地确定为 $1$。", "answer": "$$\n\\boxed{1}\n$$", "id": "2594813"}, {"introduction": "在理解了偶遇单元背后的多项式空间之后，下一步是亲手构建它的形函数。本练习将引导你从有限元的基本定义出发，仅利用节点特性和边界约束，推导出二次偶遇单元 ($S_2$) 的八个节点形函数 [@problem_id:2594808]。这个推导过程不仅能让你对教科书中给出的公式有更深刻的理解，还能强化你对拉格朗日插值原理在二维空间中应用的掌握。", "problem": "令 $\\hat K = [-1,1] \\times [-1,1]$ 为参考正方形，其坐标为 $(\\xi,\\eta)$。考虑张量积二次拉格朗日 (Lagrange) 族 $Q_2(\\hat K)$，其节点位于四个顶点 $(\\pm 1,\\pm 1)$、四个边中点 $(0,\\pm 1)$ 和 $(\\pm 1,0)$，以及内部节点 $(0,0)$。偶遇 (Serendipity) 二次族 $S_2(\\hat K)$ 使用相同的八个边界节点，但省略了内部节点，其多项式空间是所有关于 $\\xi$ 和 $\\eta$ 的多项式集合，这些多项式的超线性次数至多为2。\n\n仅使用有限元三元组定义 $(\\hat K, \\mathcal{P}, \\mathcal{N})$ （区域、多项式空间和节点泛函）以及 Lagrange 插值原理，推导八个节点形函数 $\\{N_i\\}_{i=1}^{8} \\subset S_2(\\hat K)$ 的显式公式（用 $\\xi$ 和 $\\eta$ 表示），这些形函数在有序节点集上满足 Kronecker 属性 $N_i(\\xi_j,\\eta_j)=\\delta_{ij}$：\n- $N_1$ 在 $(-1,-1)$，$N_2$ 在 $(1,-1)$，$N_3$ 在 $(1,1)$，$N_4$ 在 $(-1,1)$，\n- $N_5$ 在 $(0,-1)$，$N_6$ 在 $(1,0)$，$N_7$ 在 $(0,1)$，$N_8$ 在 $(-1,0)$。\n\n然后，从 $\\{-1,0,1\\}$ 上的一维二次Lagrange基出发，并根据形函数限制到边上时能再现该基的要求，验证：\n- 在每条边 $\\eta=\\pm 1$ 或 $\\xi=\\pm 1$ 上，与该边关联的三个形函数的限制构成了 $\\{-1,0,1\\}$ 上的一维二次 Lagrange 基（即，保留了边上的二次多项式）。\n- $Q_2(\\hat K)$ 的内部气泡函数，即 $\\beta(\\xi,\\eta) = (1-\\xi^2)(1-\\eta^2)$，在 $S_2(\\hat K)$ 中被消除了，其意义是 $\\beta \\notin \\operatorname{span}\\{N_1,\\dots,N_8\\}$。\n\n将最终答案表示为与上述节点顺序对应的有序八元组 $(N_1,\\dots,N_8)$。无需进行数值舍入，也不涉及物理单位。", "solution": "我们从有限元定义开始：$\\hat K$ 上的一个 Lagrange 有限元由一个多项式空间 $\\mathcal{P}$ 和节点泛函 $\\mathcal{N}=\\{\\delta_{(\\xi_i,\\eta_i)}\\}$ 确定，其形函数 $\\{N_i\\}$ 定义为 $N_i \\in \\mathcal{P}$ 且 $N_i(\\xi_j,\\eta_j)=\\delta_{ij}$。对于 $Q_2(\\hat K)$，节点 $\\{-1,0,1\\}$ 上的一维二次 Lagrange 基由下式给出：\n$$\n\\ell_{-1}(t)=\\tfrac{1}{2}t(t-1),\\qquad \\ell_0(t)=1-t^2,\\qquad \\ell_{1}(t)=\\tfrac{1}{2}t(t+1).\n$$\n在边上，二维形函数必须限制为用相应的边变量表示的这些一维多项式。二变量二阶偶遇空间 $S_2(\\hat K)$ 是超线性次数至多为2的单项式的张成空间，即\n$$\n\\mathcal{P}_{\\mathrm{ser},2}=\\operatorname{span}\\{1,\\ \\xi,\\ \\eta,\\ \\xi\\eta,\\ \\xi^2,\\ \\eta^2,\\ \\xi^2\\eta,\\ \\xi\\eta^2\\},\n$$\n该空间维数为八，且对于八个边界节点是单解的 (unisolvent)。\n\n我们首先构造边中点形函数，因为根据边上限制的要求，它们的因式分解是直接的。对于底边 $(0,-1)$ 处的中点，我们希望其在 $\\eta=-1$ 上的限制等于 $\\ell_0(\\xi)=1-\\xi^2$，并在其他三条边上为零。因子 $(1-\\eta)$ 在 $\\eta=1$ 上为零，在 $\\eta=-1$ 上非零，而因子 $(1-\\xi^2)$ 在 $\\xi=\\pm 1$ 处为零。因此\n$$\nN_5(\\xi,\\eta)=\\tfrac{1}{2}(1-\\xi^2)(1-\\eta),\n$$\n因为 $N_5(0,-1)=\\tfrac{1}{2}\\cdot 1\\cdot 2=1$ 强制满足了在该节点上的 Kronecker 条件。通过对称性，其他边中点函数为\n$$\nN_6(\\xi,\\eta)=\\tfrac{1}{2}(1+\\xi)(1-\\eta^2),\\quad\nN_7(\\xi,\\eta)=\\tfrac{1}{2}(1-\\xi^2)(1+\\eta),\\quad\nN_8(\\xi,\\eta)=\\tfrac{1}{2}(1-\\xi)(1-\\eta^2).\n$$\n每个函数都满足其自身的节点条件，并在其他七个节点处为零。此外，在它们各自对应的边上，它们都简化为用边变量表示的 $\\ell_0$ ：例如，$N_6(1,\\eta)=\\tfrac{1}{2}\\cdot 2\\cdot (1-\\eta^2)=1-\\eta^2=\\ell_0(\\eta)$，并且在 $\\xi=-1$ 或 $\\eta=\\pm 1$ 的其他三条边上，它们为零。\n\n对于一个顶点，比如左下角 $(-1,-1)$，我们要求在底边 $\\eta=-1$ 上，其限制等于 $\\ell_{-1}(\\xi)=\\tfrac{1}{2}\\xi(\\xi-1)$，而在左边 $\\xi=-1$ 上，其限制等于 $\\ell_{-1}(\\eta)=\\tfrac{1}{2}\\eta(\\eta-1)$。我们寻求形为\n$$\nN_1(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1-\\eta)\\big(\\alpha+\\beta\\,\\xi+\\gamma\\,\\eta\\big)\n$$\n的 $N_1$，该式位于 $S_2(\\hat K)$ 空间中，因为其乘积只生成 $\\mathcal{P}_{\\mathrm{ser},2}$ 中的单项式：展开后得到的项均在 $\\{1,\\xi,\\eta,\\xi\\eta,\\xi^2,\\eta^2,\\xi^2\\eta,\\xi\\eta^2\\}$ 之中，绝不会出现 $\\xi^2\\eta^2$。施加边上限制：\n- 在 $\\eta=-1$ 上，\n$$\nN_1(\\xi,-1)=\\tfrac{1}{4}(1-\\xi)\\cdot 2\\cdot (\\alpha+\\beta\\,\\xi-\\gamma)=\\tfrac{1}{2}(1-\\xi)\\big((\\alpha-\\gamma)+\\beta\\,\\xi\\big)\\stackrel{!}{=}\\tfrac{1}{2}\\xi(\\xi-1)=-\\tfrac{1}{2}(1-\\xi)\\xi,\n$$\n因此 $(\\alpha-\\gamma)+\\beta\\,\\xi=-\\xi$，这给出 $\\beta=-1$ 和 $\\alpha-\\gamma=0$。\n- 在 $\\xi=-1$ 上，\n$$\nN_1(-1,\\eta)=\\tfrac{1}{4}\\cdot 2\\cdot (1-\\eta)\\cdot (\\alpha-\\beta+\\gamma\\,\\eta)=\\tfrac{1}{2}(1-\\eta)\\big((\\alpha-\\beta)+\\gamma\\,\\eta\\big)\\stackrel{!}{=}\\tfrac{1}{2}\\eta(\\eta-1)=-\\tfrac{1}{2}(1-\\eta)\\eta,\n$$\n因此 $(\\alpha-\\beta)+\\gamma\\,\\eta=-\\eta$，这给出 $\\gamma=-1$ 和 $\\alpha-\\beta=0$。\n\n综合起来，$\\beta=-1$，$\\gamma=-1$，且 $\\alpha=-1$。因此，\n$$\nN_1(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1-\\eta)\\big(-1-\\xi-\\eta\\big)=\\tfrac{1}{4}(1-\\xi)(1-\\eta)(-\\xi-\\eta-1).\n$$\n通过对称性，满足相应边上限制的余下顶点函数为\n\\begin{align*}\nN_2(\\xi,\\eta)&=\\tfrac{1}{4}(1+\\xi)(1-\\eta)(\\xi-\\eta-1),\\\\\nN_3(\\xi,\\eta)&=\\tfrac{1}{4}(1+\\xi)(1+\\eta)(\\xi+\\eta-1),\\\\\nN_4(\\xi,\\eta)&=\\tfrac{1}{4}(1-\\xi)(1+\\eta)(-\\xi+\\eta-1).\n\\end{align*}\n可以立即检验其 Kronecker 属性：例如，$N_1(-1,-1)=\\tfrac{1}{4}\\cdot 2\\cdot 2\\cdot (1+1-1)=1$，并且 $N_1$ 在其他七个节点处为零，因为在每个节点上，至少有一个线性因子 $(1\\pm \\xi)$ 或 $(1\\pm \\eta)$ 或括号项强制其值为零。\n\n**边上二次性的保留。**在一条边上，与该边关联的三个形函数简化为 $\\{-1,0,1\\}$ 上的一维 Lagrange 基。考虑底边 $\\eta=-1$。我们有\n\\begin{align*}\nN_1(\\xi,-1)&=\\tfrac{1}{2}\\xi(\\xi-1)=\\ell_{-1}(\\xi),\\\\\nN_5(\\xi,-1)&=(1-\\xi^2)=\\ell_0(\\xi),\\\\\nN_2(\\xi,-1)&=\\tfrac{1}{2}\\xi(\\xi+1)=\\ell_{1}(\\xi),\n\\end{align*}\n而其他五个形函数在此处为零。通过对称性，对于其他三条边也有类似的结论。因此，边上限制在每条边上都再现了二次 Lagrange 族。\n\n**$Q_2$ 内部气泡函数的消除。**$Q_2$ 内部气泡函数是 $\\beta(\\xi,\\eta)=(1-\\xi^2)(1-\\eta^2)$，它在所有八个偶遇节点上为零，但在内部非零（例如, $\\beta(0,0)=1$）。反设 $\\beta$ 位于 $\\operatorname{span}\\{N_1,\\dots,N_8\\}$ 中。那么，对于某些系数 $c_i$，有\n$$\n\\beta=\\sum_{i=1}^{8} c_i N_i\n$$\n在每个节点 $(\\xi_j,\\eta_j)$ 处求值得，对于所有八个节点，$\\beta(\\xi_j,\\eta_j)=0$。但根据构造，$N_i(\\xi_j,\\eta_j)=\\delta_{ij}$，因此对于每个 $j$，有 $0=\\beta(\\xi_j,\\eta_j)=c_j$。因此所有 $c_j=0$，这意味着 $\\beta\\equiv 0$，这是一个矛盾。故 $\\beta\\notin \\operatorname{span}\\{N_1,\\dots,N_8\\}$，所以 $Q_2(\\hat K)$ 的内部气泡函数在 $S_2(\\hat K)$ 中被消除了。\n\n按要求的顺序收集八个形函数，得到下面的显式公式。", "answer": "$$\\boxed{\\begin{pmatrix}\n\\tfrac{1}{4}(1-\\xi)(1-\\eta)(-\\xi-\\eta-1) & \\tfrac{1}{4}(1+\\xi)(1-\\eta)(\\xi-\\eta-1) & \\tfrac{1}{4}(1+\\xi)(1+\\eta)(\\xi+\\eta-1) & \\tfrac{1}{4}(1-\\xi)(1+\\eta)(-\\xi+\\eta-1) & \\tfrac{1}{2}(1-\\xi^2)(1-\\eta) & \\tfrac{1}{2}(1+\\xi)(1-\\eta^2) & \\tfrac{1}{2}(1-\\xi^2)(1+\\eta) & \\tfrac{1}{2}(1-\\xi)(1-\\eta^2)\n\\end{pmatrix}}$$", "id": "2594808"}, {"introduction": "理论上的单元选择会直接影响有限元分析的计算成本和精度，尤其是在组装刚度矩阵的数值积分阶段。本练习将理论与计算实践联系起来，要求你确定精确积分拉格朗日 ($Q_k$) 单元族刚度矩阵所需的最小高斯求积阶数 [@problem_id:2594823]。通过分析被积函数的最高多项式次数，你将学会如何为特定的单元类型选择合适的数值积分方案，这是确保计算结果准确性的关键一步。", "problem": "设 $K \\subset \\mathbb{R}^2$ 是一个单个的仿射四边形有限元，它是通过一个仿射映射 $F : \\hat{K} \\to K$ 从参考正方形 $\\hat{K} = [-1,1]^2$ 获得的。该映射具有常雅可比矩阵 $J$ 和常数行列式 $\\det J \\neq 0$。考虑在 $\\hat{K}$ 上的拉格朗日 ($Q_k$) 张量积四边形族，即在每个变量上次数最高为 $k$ 的多项式空间。设 $\\{\\hat{\\phi}_i\\}$表示 $Q_k$ 在 $\\hat{K}$ 上的节点基，并设 $\\phi_i = \\hat{\\phi}_i \\circ F^{-1}$ 表示在 $K$ 上的对应基。泊松双线性形式的局部刚度矩阵项为\n$$\nA_{ij} \\;=\\; \\int_{K} \\nabla \\phi_i(x) \\cdot \\nabla \\phi_j(x) \\, dx.\n$$\n假设在 $\\hat{K}$ 上使用每个坐标方向有 $n$ 个点的张量积Gauss–Legendre求积法，通过将积分拉回到 $\\hat{K}$ 来精确计算这些积分。仅使用仿射映射的基本性质、微分后多项式的次数以及一维Gauss–Legendre求积的精确性，确定为使求积对任何仿射四边形 $K$ 的所有矩阵项 $A_{ij}$ 都精确，每个坐标方向所需的Gauss点的最小数量 $n$（作为 $k$ 的函数）。为您的选择的 $n$ 提供数学证明。将最终答案表示为关于 $k$ 的闭式表达式。", "solution": "所述问题是适定的且有科学依据。我们进行形式推导。\n\n局部刚度矩阵项由在物理单元 $K$ 上的积分给出：\n$$\nA_{ij} = \\int_{K} \\nabla_x \\phi_i(x) \\cdot \\nabla_x \\phi_j(x) \\, dx\n$$\n此处，$\\phi_i$ 是物理单元 $K$ 上的基函数，$\\nabla_x$ 表示关于物理坐标 $x \\in \\mathbb{R}^2$ 的梯度。为了使用定义在参考单元 $\\hat{K} = [-1,1]^2$ 上的求积法则来计算此积分，我们必须使用仿射映射 $x = F(\\hat{x})$ 进行变量替换，其中 $\\hat{x} = (\\xi, \\eta) \\in \\hat{K}$。\n\n梯度向量的变换由链式法则给出：\n$$\n\\nabla_{\\hat{x}} (\\psi \\circ F)(\\hat{x}) = J^T \\nabla_x \\psi(F(\\hat{x}))\n$$\n其中 $J$ 是映射 $F$ 的雅可比矩阵。由于 $F$ 是仿射映射，其雅可比矩阵 $J$ 是一个常数矩阵。根据变换法则，我们将物理梯度用参考梯度表示：\n$$\n\\nabla_x \\psi(x) = J^{-T} \\nabla_{\\hat{x}} (\\psi \\circ F)(\\hat{x})\n$$\n基函数定义为 $\\phi_i = \\hat{\\phi}_i \\circ F^{-1}$，这意味着 $\\phi_i(x) = \\hat{\\phi}_i(\\hat{x})$。应用梯度变换，我们得到：\n$$\n\\nabla_x \\phi_i(x) = J^{-T} \\nabla_{\\hat{x}} \\hat{\\phi}_i(\\hat{x})\n$$\n被积函数中的点积变为：\n$$\n\\nabla_x \\phi_i(x) \\cdot \\nabla_x \\phi_j(x) = \\left( J^{-T} \\nabla_{\\hat{x}} \\hat{\\phi}_i(\\hat{x}) \\right) \\cdot \\left( J^{-T} \\nabla_{\\hat{x}} \\hat{\\phi}_j(\\hat{x}) \\right) = \\left( \\nabla_{\\hat{x}} \\hat{\\phi}_i \\right)^T (J^{-1} J^{-T}) \\left( \\nabla_{\\hat{x}} \\hat{\\phi}_j \\right)\n$$\n微分面积元的变换为 $dx = |\\det J| \\, d\\hat{x}$。将这些代入 $A_{ij}$ 的积分中，我们得到在参考单元上的积分：\n$$\nA_{ij} = \\int_{\\hat{K}} \\left[ \\left( \\nabla_{\\hat{x}} \\hat{\\phi}_i \\right)^T (J^{-1} J^{-T}) \\left( \\nabla_{\\hat{x}} \\hat{\\phi}_j \\right) \\right] |\\det J| \\, d\\hat{x}\n$$\n设常数矩阵 $C = |\\det J| (J^{-1} J^{-T})$ 的元素为 $C_{ab}$。被积函数可以用参考坐标 $(\\xi, \\eta)$ 展开：\n$$\nI(\\xi, \\eta) = C_{11} \\frac{\\partial \\hat{\\phi}_i}{\\partial \\xi} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\xi} + C_{12} \\frac{\\partial \\hat{\\phi}_i}{\\partial \\xi} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\eta} + C_{21} \\frac{\\partial \\hat{\\phi}_i}{\\partial \\eta} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\xi} + C_{22} \\frac{\\partial \\hat{\\phi}_i}{\\partial \\eta} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\eta}\n$$\n基函数 $\\hat{\\phi}_i$ 和 $\\hat{\\phi}_j$ 属于空间 $Q_k$，该空间由在每个变量 $\\xi$ 和 $\\eta$ 上次数最高为 $k$ 的多项式组成。\n设 $\\text{deg}_{\\xi}(p)$ 和 $\\text{deg}_{\\eta}(p)$ 分别表示多项式 $p$ 在变量 $\\xi$ 和 $\\eta$ 中的次数。对于任何 $\\hat{\\phi} \\in Q_k$，我们有 $\\text{deg}_{\\xi}(\\hat{\\phi}) \\le k$ 和 $\\text{deg}_{\\eta}(\\hat{\\phi}) \\le k$。\n\n微分后，次数变化如下：\n$$\n\\text{deg}_{\\xi}\\left(\\frac{\\partial \\hat{\\phi}}{\\partial \\xi}\\right) \\le k-1, \\quad \\text{deg}_{\\eta}\\left(\\frac{\\partial \\hat{\\phi}}{\\partial \\xi}\\right) \\le k\n$$\n$$\n\\text{deg}_{\\xi}\\left(\\frac{\\partial \\hat{\\phi}}{\\partial \\eta}\\right) \\le k, \\quad \\text{deg}_{\\eta}\\left(\\frac{\\partial \\hat{\\phi}}{\\partial \\eta}\\right) \\le k-1\n$$\n现在我们分析被积函数 $I(\\xi, \\eta)$ 中每一项的次数：\n1. 对于项 $\\frac{\\partial \\hat{\\phi}_i}{\\partial \\xi} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\xi}$：\n   $$ \\text{deg}_{\\xi}\\left(\\frac{\\partial \\hat{\\phi}_i}{\\partial \\xi} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\xi}\\right) \\le (k-1) + (k-1) = 2k-2 $$\n   $$ \\text{deg}_{\\eta}\\left(\\frac{\\partial \\hat{\\phi}_i}{\\partial \\xi} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\xi}\\right) \\le k + k = 2k $$\n2. 对于项 $\\frac{\\partial \\hat{\\phi}_i}{\\partial \\xi} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\eta}$ (及其对称项)：\n   $$ \\text{deg}_{\\xi}\\left(\\frac{\\partial \\hat{\\phi}_i}{\\partial \\xi} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\eta}\\right) \\le (k-1) + k = 2k-1 $$\n   $$ \\text{deg}_{\\eta}\\left(\\frac{\\partial \\hat{\\phi}_i}{\\partial \\xi} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\eta}\\right) \\le k + (k-1) = 2k-1 $$\n3. 对于项 $\\frac{\\partial \\hat{\\phi}_i}{\\partial \\eta} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\eta}$：\n   $$ \\text{deg}_{\\xi}\\left(\\frac{\\partial \\hat{\\phi}_i}{\\partial \\eta} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\eta}\\right) \\le k + k = 2k $$\n   $$ \\text{deg}_{\\eta}\\left(\\frac{\\partial \\hat{\\phi}_i}{\\partial \\eta} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\eta}\\right) \\le (k-1) + (k-1) = 2k-2 $$\n\n被积函数 $I(\\xi, \\eta)$ 是这些项乘以常数的和。$I(\\xi, \\eta)$ 在 $\\xi$ 中的最高次数是各个项在 $\\xi$ 中次数的最大值，即 $\\max(2k-2, 2k-1, 2k) = 2k$。类似地，$I(\\xi, \\eta)$ 在 $\\eta$ 中的最高次数是 $\\max(2k, 2k-1, 2k-2) = 2k$。\n\n该积分使用每个坐标方向有 $n$ 个点的张量积Gauss-Legendre求积法则进行计算：\n$$\n\\int_{-1}^{1} \\int_{-1}^{1} I(\\xi, \\eta) \\, d\\xi \\, d\\eta \\approx \\sum_{p=1}^{n} \\sum_{q=1}^{n} w_p w_q I(\\xi_p, \\eta_q)\n$$\n为使此求积精确，每个变量上的一维求积必须是精确的。一个具有 $n$ 个点的一维Gauss-Legendre求积对于次数最高为 $2n-1$ 的任何多项式都是精确的。\n为了精确地对 $I(\\xi, \\eta)$ 关于 $\\xi$ 进行积分，我们要求求积对于次数最高为 $\\text{deg}_{\\xi}(I) = 2k$ 的多项式是精确的。这施加了以下条件：\n$$\n2n - 1 \\ge 2k\n$$\n为了精确地关于 $\\eta$ 积分，我们类似地要求对于次数最高为 $\\text{deg}_{\\eta}(I) = 2k$ 的多项式是精确的。这给出了相同的条件：\n$$\n2n - 1 \\ge 2k\n$$\n对该不等式求解 $n$：\n$$\n2n \\ge 2k + 1 \\implies n \\ge k + \\frac{1}{2}\n$$\n由于求积点数 $n$ 必须是整数，满足此条件的 $n$ 的最小值是大于或等于 $k + \\frac{1}{2}$ 的最小整数，即 $k+1$。选择此 $n$ 值可保证对任何仿射四边形单元 $K$ 的刚度矩阵的所有项 $A_{ij}$ 的积分都是精确的。", "answer": "$$\n\\boxed{k+1}\n$$", "id": "2594823"}]}