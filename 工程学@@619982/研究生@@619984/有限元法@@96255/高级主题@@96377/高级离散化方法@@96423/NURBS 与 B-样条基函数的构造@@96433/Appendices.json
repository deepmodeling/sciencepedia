{"hands_on_practices": [{"introduction": "在任意给定点上评估基函数值是等几何分析的基石。本练习将引导你直接动手实践著名的 Cox–de Boor 递归算法，这是 B 样条求值的核心工具。通过解决一个二维张量积的例子，你将对基函数的局部支撑特性以及如何从零开始计算其具体数值建立起扎实的理解。[@problem_id:2584836]", "problem": "考虑在有限元法 (FEM) 框架下，用于等几何分析中的二维张量积多项式 B 样条基函数的构造。在每个参数方向上使用开、非均匀节点矢量，且双次数为 $(p,q)=(2,2)$。两个开节点矢量为\n$$\\Xi = [\\,0,\\,0,\\,0,\\,0.25,\\,0.5,\\,1,\\,1,\\,1\\,],\\qquad \\mathcal{H} = [\\,0,\\,0,\\,0,\\,0.5,\\,0.75,\\,1,\\,1,\\,1\\,].$$\n关注对应于参数区域 $[0.25,0.5]\\times[0.5,0.75]$ 的单元，以及严格位于该单元内部的点 $(\\xi,\\eta)=(0.375,\\,0.625)$。\n\n仅从 $p$ 次单变量 B 样条的 Cox–de Boor 递推公式出发，\n$$N_{i,0}(u)=\\begin{cases}\n1, & u\\in[\\xi_i,\\xi_{i+1}),\\\\\n0, & \\text{otherwise},\n\\end{cases}\n\\qquad\nN_{i,p}(u)=\\frac{u-\\xi_i}{\\xi_{i+p}-\\xi_i}N_{i,p-1}(u)+\\frac{\\xi_{i+p+1}-u}{\\xi_{i+p+1}-\\xi_{i+1}}N_{i+1,p-1}(u),$$\n以及类似地对使用节点矢量 $\\mathcal{H}$ 的 $\\eta$ 方向，执行以下操作：\n- 在点 $(\\xi,\\eta)$ 处，识别并列举每个方向上的非零单变量 B 样条基函数，并计算它们在该点的值。\n- 构造非零的双二次张量积基函数 $B_{i,j}(\\xi,\\eta)=N_{i,2}(\\xi)\\,M_{j,2}(\\eta)$，并确定它们在点 $(\\xi,\\eta)$ 处的值，其中 $N_{i,2}$ 由 $\\Xi$ 定义，$M_{j,2}$ 由 $\\mathcal{H}$ 定义。\n\n最后，定义\n$$S=\\sum_{\\text{nonzero }(i,j)}\\left(B_{i,j}(\\xi,\\eta)\\right)^{2}.$$\n精确计算 $S$，并将最终结果表示为单个简化的有理数。不要进行四舍五入。", "solution": "在尝试解答之前，对问题陈述进行验证。\n\n首先，逐字提取已知条件。\n- **问题领域**: 用于等几何分析的二维张量积B样条基函数的构造。\n- **次数**: $(p,q)=(2,2)$。\n- **节点矢量**:\n  - $\\xi$方向: $\\Xi = [\\,0,\\,0,\\,0,\\,0.25,\\,0.5,\\,1,\\,1,\\,1\\,]$\n  - $\\eta$方向: $\\mathcal{H} = [\\,0,\\,0,\\,0,\\,0.5,\\,0.75,\\,1,\\,1,\\,1\\,]$\n- **求值点**: $(\\xi,\\eta)=(0.375,\\,0.625)$。\n- **参数单元**: $[\\,0.25,\\,0.5\\,]\\times[\\,0.5,\\,0.75\\,]$。\n- **控制方程**: $p$ 次单变量 B 样条的 Cox–de Boor 递推公式：\n  $$N_{i,0}(u)=\\begin{cases}\n  1, & u\\in[\\xi_i,\\xi_{i+1}),\\\\\n  0, & \\text{otherwise},\n  \\end{cases}\n  \\qquad\n  N_{i,p}(u)=\\frac{u-\\xi_i}{\\xi_{i+p}-\\xi_i}N_{i,p-1}(u)+\\frac{\\xi_{i+p+1}-u}{\\xi_{i+p+1}-\\xi_{i+1}}N_{i+1,p-1}(u)$$\n- **定义**:\n  - 双二次张量积基函数: $B_{i,j}(\\xi,\\eta)=N_{i,2}(\\xi)\\,M_{j,2}(\\eta)$。\n  - 待计算量: $S=\\sum_{\\text{nonzero }(i,j)}\\left(B_{i,j}(\\xi,\\eta)\\right)^{2}$。\n\n接下来，根据所需标准对问题进行验证。\n- **科学依据**: 该问题完全属于计算几何和数值分析领域，特别是等几何分析。B 样条、节点矢量和 Cox-de Boor 递推公式的使用是该领域的基本概念。该问题在科学上是合理的。\n- **适定性**: 该问题提供了所有必要参数：节点矢量、多项式次数和用于求值的特定点。B 样条的结构保证了在任何给定点上基函数及其值的存在性和唯一性。该问题是适定的。\n- **客观性**: 该问题以精确的数学语言陈述，没有歧义或主观内容。\n\n该问题没有违反任何无效标准。它具有科学依据、适定、客观、完整且可形式化。\n\n**结论**: 问题有效。将提供解答。\n\n设节点矢量从1开始索引。\n对于 $\\xi$ 方向，我们有 $\\Xi = [\\xi_1, \\xi_2, \\xi_3, \\xi_4, \\xi_5, \\xi_6, \\xi_7, \\xi_8] = [\\,0,\\,0,\\,0,\\,0.25,\\,0.5,\\,1,\\,1,\\,1\\,]$。多项式次数为 $p=2$。求值点为 $\\xi = 0.375$。\n对于 $\\eta$ 方向，我们有 $\\mathcal{H} = [\\eta_1, \\eta_2, \\eta_3, \\eta_4, \\eta_5, \\eta_6, \\eta_7, \\eta_8] = [\\,0,\\,0,\\,0,\\,0.5,\\,0.75,\\,1,\\,1,\\,1\\,]$。多项式次数为 $q=2$。求值点为 $\\eta = 0.625$。\n\nB 样条基函数 $N_{i,p}(\\xi)$ 仅当 $\\xi \\in [\\xi_i, \\xi_{i+p+1})$ 时非零。求值点 $\\xi=0.375$ 位于节点区间 $[\\xi_4, \\xi_5) = [0.25, 0.5)$ 内。对于一个 $p$ 次基，在任何给定的非空节点区间 $[\\xi_k, \\xi_{k+1})$ 上有 $p+1$ 个函数具有支撑集。这里，$k=4$ 且 $p=2$。非零的基函数为 $N_{k-p,p}(\\xi), \\dots, N_{k,p}(\\xi)$，即 $N_{2,2}(\\xi)$、$N_{3,2}(\\xi)$ 和 $N_{4,2}(\\xi)$。\n类似地，$\\eta=0.625$ 位于节点区间 $[\\eta_4, \\eta_5) = [0.5, 0.75)$ 内。当 $q=2$ 时，非零的基函数为 $M_{2,2}(\\eta)$、 $M_{3,2}(\\eta)$ 和 $M_{4,2}(\\eta)$。\n\n我们使用 Cox-de Boor 递推公式计算这些函数的值。\n\n**在 $\\xi=0.375$ 处对 $\\xi$ 方向的计算**：\n\n对于 $p=0$：$\\xi \\in [\\xi_4, \\xi_5)$，所以 $N_{4,0}(\\xi)=1$ 且所有其他 $N_{i,0}(\\xi)=0$。\n\n对于 $p=1$：我们需要用于构造非零 $p=2$ 函数的基函数。它们是 $N_{3,1}$ 和 $N_{4,1}$。\n$N_{i,1}(\\xi) = \\frac{\\xi-\\xi_i}{\\xi_{i+1}-\\xi_i}N_{i,0}(\\xi) + \\frac{\\xi_{i+2}-\\xi}{\\xi_{i+2}-\\xi_{i+1}}N_{i+1,0}(\\xi)$。\n$N_{3,1}(\\xi) = \\frac{\\xi-\\xi_3}{\\xi_4-\\xi_3}N_{3,0}(\\xi) + \\frac{\\xi_5-\\xi}{\\xi_5-\\xi_4}N_{4,0}(\\xi) = 0 + \\frac{0.5-0.375}{0.5-0.25}(1) = \\frac{0.125}{0.25} = \\frac{1}{2}$。\n$N_{4,1}(\\xi) = \\frac{\\xi-\\xi_4}{\\xi_5-\\xi_4}N_{4,0}(\\xi) + \\frac{\\xi_6-\\xi}{\\xi_6-\\xi_5}N_{5,0}(\\xi) = \\frac{0.375-0.25}{0.5-0.25}(1) + 0 = \\frac{0.125}{0.25} = \\frac{1}{2}$。\n在 $\\xi=0.375$ 处，所有其他 $N_{i,1}(\\xi)$ 均为零。\n\n对于 $p=2$：\n$N_{i,2}(\\xi) = \\frac{\\xi-\\xi_i}{\\xi_{i+2}-\\xi_i}N_{i,1}(\\xi) + \\frac{\\xi_{i+3}-\\xi}{\\xi_{i+3}-\\xi_{i+1}}N_{i+1,1}(\\xi)$。\n$N_{2,2}(\\xi) = \\frac{\\xi-\\xi_2}{\\xi_4-\\xi_2}N_{2,1}(\\xi) + \\frac{\\xi_5-\\xi}{\\xi_5-\\xi_3}N_{3,1}(\\xi) = 0 + \\frac{0.5-0.375}{0.5-0}(\\frac{1}{2}) = \\frac{0.125}{0.5} \\cdot \\frac{1}{2} = \\frac{1}{4} \\cdot \\frac{1}{2} = \\frac{1}{8}$。\n$N_{3,2}(\\xi) = \\frac{\\xi-\\xi_3}{\\xi_5-\\xi_3}N_{3,1}(\\xi) + \\frac{\\xi_6-\\xi}{\\xi_6-\\xi_4}N_{4,1}(\\xi) = \\frac{0.375-0}{0.5-0}(\\frac{1}{2}) + \\frac{1-0.375}{1-0.25}(\\frac{1}{2}) = \\frac{0.375}{0.5}\\frac{1}{2} + \\frac{0.625}{0.75}\\frac{1}{2} = \\frac{3}{4}\\frac{1}{2} + \\frac{5}{6}\\frac{1}{2} = \\frac{3}{8} + \\frac{5}{12} = \\frac{9+10}{24} = \\frac{19}{24}$。\n$N_{4,2}(\\xi) = \\frac{\\xi-\\xi_4}{\\xi_6-\\xi_4}N_{4,1}(\\xi) + \\frac{\\xi_7-\\xi}{\\xi_7-\\xi_5}N_{5,1}(\\xi) = \\frac{0.375-0.25}{1-0.25}(\\frac{1}{2}) + 0 = \\frac{0.125}{0.75} \\cdot \\frac{1}{2} = \\frac{1}{6} \\cdot \\frac{1}{2} = \\frac{1}{12}$。\n其和为 $N_{2,2}+N_{3,2}+N_{4,2} = \\frac{1}{8}+\\frac{19}{24}+\\frac{1}{12} = \\frac{3+19+2}{24} = \\frac{24}{24} = 1$，这验证了单位分解性质。\n\n**在 $\\eta = 0.625$ 处对 $\\eta$ 方向的计算**：\n\n对于 $q=0$：$\\eta \\in [\\eta_4, \\eta_5)$，所以 $M_{4,0}(\\eta)=1$ 且所有其他 $M_{j,0}(\\eta)=0$。\n\n对于 $q=1$：\n$M_{3,1}(\\eta) = \\frac{\\eta_5-\\eta}{\\eta_5-\\eta_4}M_{4,0}(\\eta) = \\frac{0.75-0.625}{0.75-0.5}(1) = \\frac{0.125}{0.25} = \\frac{1}{2}$。\n$M_{4,1}(\\eta) = \\frac{\\eta-\\eta_4}{\\eta_5-\\eta_4}M_{4,0}(\\eta) = \\frac{0.625-0.5}{0.75-0.5}(1) = \\frac{0.125}{0.25} = \\frac{1}{2}$。\n在 $\\eta=0.625$ 处，所有其他 $M_{j,1}(\\eta)$ 均为零。\n\n对于 $q=2$：\n$M_{2,2}(\\eta) = \\frac{\\eta_5-\\eta}{\\eta_5-\\eta_3}M_{3,1}(\\eta) = \\frac{0.75-0.625}{0.75-0}(\\frac{1}{2}) = \\frac{0.125}{0.75} \\cdot \\frac{1}{2} = \\frac{1}{6} \\cdot \\frac{1}{2} = \\frac{1}{12}$。\n$M_{3,2}(\\eta) = \\frac{\\eta-\\eta_3}{\\eta_5-\\eta_3}M_{3,1}(\\eta) + \\frac{\\eta_6-\\eta}{\\eta_6-\\eta_4}M_{4,1}(\\eta) = \\frac{0.625-0}{0.75-0}(\\frac{1}{2}) + \\frac{1-0.625}{1-0.5}(\\frac{1}{2}) = \\frac{0.625}{0.75}\\frac{1}{2} + \\frac{0.375}{0.5}\\frac{1}{2} = \\frac{5}{6}\\frac{1}{2} + \\frac{3}{4}\\frac{1}{2} = \\frac{5}{12} + \\frac{3}{8} = \\frac{10+9}{24} = \\frac{19}{24}$。\n$M_{4,2}(\\eta) = \\frac{\\eta-\\eta_4}{\\eta_6-\\eta_4}M_{4,1}(\\eta) = \\frac{0.625-0.5}{1-0.5}(\\frac{1}{2}) = \\frac{0.125}{0.5} \\cdot \\frac{1}{2} = \\frac{1}{4} \\cdot \\frac{1}{2} = \\frac{1}{8}$。\n其和为 $M_{2,2}+M_{3,2}+M_{4,2} = \\frac{1}{12}+\\frac{19}{24}+\\frac{1}{8} = \\frac{2+19+3}{24} = \\frac{24}{24} = 1$，验证了单位分解性质。\n\n非零的单变量基函数及其值为：\n$N_{2,2}(0.375) = \\frac{1}{8}$, $N_{3,2}(0.375) = \\frac{19}{24}$, $N_{4,2}(0.375) = \\frac{1}{12}$。\n$M_{2,2}(0.625) = \\frac{1}{12}$, $M_{3,2}(0.625) = \\frac{19}{24}$, $M_{4,2}(0.625) = \\frac{1}{8}$。\n\n非零的双二次基函数 $B_{i,j}(\\xi,\\eta)=N_{i,2}(\\xi)M_{j,2}(\\eta)$ 对应的索引为 $(i,j)$，其中 $i,j \\in \\{2,3,4\\}$。\n\n我们需要计算 $S = \\sum_{\\text{nonzero }(i,j)}\\left(B_{i,j}(\\xi,\\eta)\\right)^{2}$。\n$$S = \\sum_{i=2}^{4}\\sum_{j=2}^{4} \\left(N_{i,2}(\\xi)M_{j,2}(\\eta)\\right)^2 = \\sum_{i=2}^{4}\\sum_{j=2}^{4} N_{i,2}(\\xi)^2 M_{j,2}(\\eta)^2$$\n这个和可以因式分解：\n$$S = \\left(\\sum_{i=2}^{4} N_{i,2}(\\xi)^2\\right) \\left(\\sum_{j=2}^{4} M_{j,2}(\\eta)^2\\right)$$\n首先，计算 $N_{i,2}$ 函数的平方和：\n$$ \\sum_{i=2}^{4} N_{i,2}(\\xi)^2 = \\left(\\frac{1}{8}\\right)^2 + \\left(\\frac{19}{24}\\right)^2 + \\left(\\frac{1}{12}\\right)^2 = \\frac{1}{64} + \\frac{361}{576} + \\frac{1}{144} $$\n最小公分母是 $576$。\n$$ \\sum_{i=2}^{4} N_{i,2}(\\xi)^2 = \\frac{9}{576} + \\frac{361}{576} + \\frac{4}{576} = \\frac{9+361+4}{576} = \\frac{374}{576} $$\n将分子和分母除以 $2$ 来简化此分数：$\\frac{187}{288}$。（$187 = 11 \\times 17$，$288 = 2^5 \\times 3^2$，所以该分数已最简）。\n\n接下来，计算 $M_{j,2}$ 函数的平方和：\n$$ \\sum_{j=2}^{4} M_{j,2}(\\eta)^2 = \\left(\\frac{1}{12}\\right)^2 + \\left(\\frac{19}{24}\\right)^2 + \\left(\\frac{1}{8}\\right)^2 = \\frac{1}{144} + \\frac{361}{576} + \\frac{1}{64} $$\n这与 $N_{i,2}$ 函数的平方和相同，所以其值也为 $\\frac{187}{288}$。\n\n最后，计算 $S$：\n$$S = \\left(\\frac{187}{288}\\right) \\cdot \\left(\\frac{187}{288}\\right) = \\left(\\frac{187}{288}\\right)^2$$\n$$S = \\frac{187^2}{288^2} = \\frac{34969}{82944}$$\n这就是最终的简化有理数。", "answer": "$$\\boxed{\\frac{34969}{82944}}$$", "id": "2584836"}, {"introduction": "除了能对样条进行求值，设计师或分析师的一项关键技能是控制其属性。本练习将深入探讨 B 样条最强大的特性之一：可调节的连续性。你将应用连接节点重复度 $k$ 与光滑度阶数 $C^{p-k}$ 之间的基本原理来解决一个设计问题：构造一个满足特定位置上不同连续性要求的节点矢量。[@problem_id:2584870]", "problem": "考虑一条单变量非均匀有理B样条（NURBS）曲线，其标量B样条基函数构建在一个位于参数域 $\\left[0,1\\right]$ 上的开放（钳位）、非递减的节点向量上。该曲线的多项式次数为 $p=4$。您的任务是在两个内部参数位置施加不同的光滑度要求：在 $\\xi=a$ 处强制实现 $C^{1}$ 连续性，在 $\\xi=b$ 处强制实现 $C^{0}$ 连续性，其中 $0<a<b<1$。\n\n请仅使用B样条基函数的 Cox–de Boor 递推定义、节点重复度的概念以及B样条的分段多项式结构，首先推导出为产生所述连续性而在 $\\xi=a$ 和 $\\xi=b$ 处所需的内部节点重复度。然后，构造满足以下条件的最短的开放、钳位节点向量：\n- 参数域为 $\\left[0,1\\right]$，\n- 仅使用两个内部参数值 $\\xi=a$ 和 $\\xi=b$ 作为内部节点（无其他内部值），\n- 在 $\\xi=a$ 处达到 $C^{1}$ 连续性，在 $\\xi=b$ 处达到 $C^{0}$ 连续性，\n- 并且是非递减的。\n\n最后，将该向量特化为具体值 $a=\\tfrac{1}{4}$ 和 $b=\\tfrac{3}{4}$，并以单行矩阵的形式给出最终的节点向量。无需四舍五入。最终答案必须以单行矩阵表达式的形式呈现。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n-   对象是单变量非均匀有理B样条（NURBS）曲线。\n-   基函数是标量B样条基函数。\n-   节点向量是开放（钳位）且非递减的。\n-   参数域为 $\\left[0,1\\right]$。\n-   多项式次数为 $p=4$。\n-   内部参数位置 $\\xi=a$ 处要求 $C^{1}$ 连续性。\n-   内部参数位置 $\\xi=b$ 处要求 $C^{0}$ 连续性。\n-   内部节点的约束条件为 $0<a<b<1$。\n-   仅使用 $\\xi=a$ 和 $\\xi=b$ 处的节点作为内部节点。\n-   任务是推导内部节点的重复度，并构造满足这些条件的最短节点向量。\n-   方法被限制为仅使用B样条基函数的 Cox–de Boor 递推定义、节点重复度的概念以及B样条的分段多项式结构。\n-   最后，必须给出特定值 $a=\\tfrac{1}{4}$ 和 $b=\\tfrac{3}{4}$ 下的节点向量。\n\n**步骤2：使用提取的已知条件进行验证**\n这个问题具有科学依据，是适定的、客观的。这是B样条理论中的一个标准练习，是计算几何和等几何分析中的一个核心课题。所有术语都有明确定义，约束条件是一致且充分的，足以确定一个唯一的、有意义的最短节点向量解。问题陈述没有科学或事实上的不健全之处，不是比喻性的，是完整的，并且不是微不足道的。\n\n**步骤3：结论与行动**\n问题是**有效的**。将构建一个解。\n\n我们首先回顾次数为 $p$ 的B样条曲线在某节点处的连续性与该节点重复度之间的基本关系。对于定义在节点向量 $\\Xi$ 上的B样条曲线，如果一个内部节点 $\\xi_i$ 的重复度为 $k$ (即，它在节点向量中连续出现 $k$ 次)，那么曲线在该参数值 $\\xi_i$ 处至多是 $C^{p-k}$ 连续的。在任何简单节点（其中 $k=1$）处，曲线通常具有 $C^{p-1}$ 连续性。\n\n问题要求我们为一个多项式次数为 $p=4$ 的B样条，在两个不同的内部位置 $\\xi=a$ 和 $\\xi=b$ 强制施加特定的连续性水平。\n\n首先，考虑在 $\\xi=a$ 处的连续性要求。我们必须强制实现 $C^{1}$ 连续性。设 $\\xi=a$ 处节点的重复度为 $k_a$。应用连续性公式：\n$$\nC^{p-k_a} = C^{1}\n$$\n给定次数 $p=4$，我们有：\n$$\n4 - k_a = 1\n$$\n求解 $k_a$ 得到 $\\xi=a$ 处所需的重复度：\n$$\nk_a = 4 - 1 = 3\n$$\n因此，为了在 $\\xi=a$ 处精确达到 $C^{1}$ 连续性，节点值 $a$ 必须在节点向量中重复3次。\n\n其次，考虑在 $\\xi=b$ 处的连续性要求。我们必须强制实现 $C^{0}$ 连续性。设 $\\xi=b$ 处节点的重复度为 $k_b$。再次应用连续性公式：\n$$\nC^{p-k_b} = C^{0}\n$$\n对于 $p=4$，我们有：\n$$\n4 - k_b = 0\n$$\n求解 $k_b$ 得到 $\\xi=b$ 处所需的重复度：\n$$\nk_b = 4 - 0 = 4\n$$\n因此，为了在 $\\xi=b$ 处达到 $C^{0}$ 连续性，节点值 $b$ 必须在节点向量中重复4次。\n\n现在，我们构造在定义域 $\\left[0,1\\right]$ 上包含这些重复度的最短的开放、钳位节点向量。对于一个次数为 $p$ 的曲线，其开放（或钳位）节点向量的首 $p+1$ 个节点等于起始参数值，末 $p+1$ 个节点等于结束参数值。这确保了B样条曲线插值于第一个和最后一个控制点。\n\n在我们的情况下，$p=4$ 且参数域为 $\\left[0,1\\right]$。这规定了节点向量必须以 $p+1=5$ 个值为0的节点开始，并以 $p+1=5$ 个值为1的节点结束。\n\n问题规定唯一的内部节点位于 $\\xi=a$ 和 $\\xi=b$。我们将内部节点放置在钳位的两端之间，并保持非递减序列。节点向量 $\\Xi$ 的结构如下：\n1.  首 $p+1=5$ 个节点为 $0$。\n2.  接着是在 $a$ 处的内部节点，重复度为 $k_a=3$。\n3.  接着是在 $b$ 处的内部节点，重复度为 $k_b=4$。\n4.  最后的 $p+1=5$ 个节点为 $1$。\n\n条件 $0 < a < b < 1$ 确保了这个排序是非递减的。组合成完整的节点向量，我们得到：\n$$\n\\Xi = \\{\\underbrace{0, 0, 0, 0, 0}_{p+1 \\text{ 次}}, \\underbrace{a, a, a}_{k_a=3 \\text{ 次}}, \\underbrace{b, b, b, b}_{k_b=4 \\text{ 次}}, \\underbrace{1, 1, 1, 1, 1}_{p+1 \\text{ 次}}\\}\n$$\n\n最后，我们将这个通用形式特化为给定的具体值：$a = \\frac{1}{4}$ 和 $b = \\frac{3}{4}$。将这些值代入节点向量结构中，得到：\n$$\n\\Xi = \\left\\{0, 0, 0, 0, 0, \\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4}, \\frac{3}{4}, \\frac{3}{4}, \\frac{3}{4}, \\frac{3}{4}, 1, 1, 1, 1, 1\\right\\}\n$$\n这是在 $\\left[0,1\\right]$ 上次数为 $p=4$ 的最短开放、钳位节点向量，它在 $\\xi=\\frac{1}{4}$ 处具有 $C^{1}$ 连续性，在 $\\xi=\\frac{3}{4}$ 处具有 $C^{0}$ 连续性，并且仅使用这两个值作为内部节点。\n节点总数为 $m+1 = 5 + 3 + 4 + 5 = 17$。基函数的数量为 $n+1 = m - p = 16 - 4 = 12$。这是一个一致且有效的B样条构造。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 0 & 0 & 0 & 0 & \\frac{1}{4} & \\frac{1}{4} & \\frac{1}{4} & \\frac{3}{4} & \\frac{3}{4} & \\frac{3}{4} & \\frac{3}{4} & 1 & 1 & 1 & 1 & 1 \\end{pmatrix}}\n$$", "id": "2584870"}, {"introduction": "为了将样条的强大功能整合到传统的有限元软件中，我们需要在全局 B 样条基和局部单元框架之间建立一座桥梁。本练习将介绍关键的“贝塞尔提取” (Bézier extraction) 技术，它优雅地实现了这一连接。通过为一个具体单元推导提取矩阵，你将揭示 B 样条片段底层的 Bernstein-Bézier 表示，并理解它如何促进等几何分析的实际代码实现。[@problem_id:2584863]", "problem": "考虑一个开的、夹持的三次B样条（次数为 $p=3$），定义在节点向量 $\\boldsymbol{U} = [\\,0,\\,0,\\,0,\\,0,\\,0.25,\\,0.5,\\,0.75,\\,1,\\,1,\\,1,\\,1\\,]$ 上，其内节点为单节点。在等几何有限元分析中，通过Bézier提取来构造单元级的Bernstein–Bézier表示，以将样条基与标准有限元装配过程连接起来。关注第二个单元（区间 $[\\,0.25,\\,0.5\\,]$），并设该单元上的局部非零B样条基函数为 $\\{N_{1,3}, N_{2,3}, N_{3,3}, N_{4,3}\\}$（索引相对于$\\boldsymbol{U}$是全局的）。\n\n通过 $u = 0.25 + 0.25\\,s$ 定义单元局部仿射坐标 $s \\in [\\,0,1\\,]$。从B样条的Cox–de Boor递归公式和$\\boldsymbol{U}$上的零次函数 $N_{i,0}(u)$ 出发，推导 $N_{i,3}(u)$（$i \\in \\{1,2,3,4\\}$）在单元 $[\\,0.25,\\,0.5\\,]$ 上的显式多项式形式，并用 $s$ 表示。然后，使用 $[\\,0,1\\,]$ 上的三次Bernstein多项式，\n$$\nB_{0}(s) = (1-s)^{3},\\quad B_{1}(s) = 3\\,s\\,(1-s)^{2},\\quad B_{2}(s) = 3\\,s^{2}\\,(1-s),\\quad B_{3}(s) = s^{3},\n$$\n将每个 $N_{i,3}(u(s))$ 表示为 $\\{B_{0},B_{1},B_{2},B_{3}\\}$ 的线性组合，并为该单元组装 $4 \\times 4$ 的Bézier提取矩阵 $C^{(e)}$，其定义如下\n$$\n\\begin{pmatrix}\nN_{1,3}(u(s))\\\\[4pt]\nN_{2,3}(u(s))\\\\[4pt]\nN_{3,3}(u(s))\\\\[4pt]\nN_{4,3}(u(s))\n\\end{pmatrix}\n=\nC^{(e)}\n\\begin{pmatrix}\nB_{0}(s)\\\\[4pt]\nB_{1}(s)\\\\[4pt]\nB_{2}(s)\\\\[4pt]\nB_{3}(s)\n\\end{pmatrix}.\n$$\n\n通过计算中点 $s = 1/2$（即 $u = 0.375$）处等式两边的值来验证重构，证明从Cox–de Boor递归得到的值与通过 $C^{(e)} \\boldsymbol{B}(1/2)$ 得到的值相匹配。作为最终答案，报告 $N_{3,3}(u)$ 在 $u = 0.375$ 处的精确值。以既约分数形式提供该值。无需四舍五入，且不涉及单位。", "solution": "该问题要求推导三次B样条曲线上特定单元的Bézier提取矩阵，并在特定参数值处对基函数求值。该问题定义明确且在数学上是合理的。我们按以下步骤进行求解。\n\nB样条的次数为 $p=3$，定义在节点向量 $\\boldsymbol{U} = [u_0, u_1, \\dots, u_{10}] = [0, 0, 0, 0, 0.25, 0.5, 0.75, 1, 1, 1, 1]$ 上。我们关注的是第二个非零单元，即区间 $[u_4, u_5] = [0.25, 0.5]$。在此区间上，非零的基函数为 $N_{1,3}(u)$、$N_{2,3}(u)$、$N_{3,3}(u)$ 和 $N_{4,3}(u)$。局部坐标 $s \\in [0, 1]$ 通过仿射映射 $u = 0.25 + 0.25s$（等价于 $s = 4u - 1$）与全局坐标 $u$ 相关联。\n\n我们使用Cox-de Boor递归公式：\n$$N_{i,p}(u) = \\frac{u - u_i}{u_{i+p} - u_i} N_{i, p-1}(u) + \\frac{u_{i+p+1} - u}{u_{i+p+1} - u_{i+1}} N_{i+1, p-1}(u)$$\n其中分母为零的项取值为零。对于 $p=0$，基函数是阶跃函数：如果 $u \\in [u_i, u_{i+1})$，则 $N_{i,0}(u) = 1$，否则为 $0$。对于 $u \\in [0.25, 0.5)$，唯一非零的零次基函数是 $N_{4,0}(u) = 1$。\n\n我们将基函数从次数 $p=0$ 逐步构建到 $p=3$。所有计算都是针对 $u \\in [0.25, 0.5)$ 进行的。\n\n对于 $p=1$：\n在此区间上非零的基函数仅有那些定义中包含 $N_{4,0}(u)$ 的函数。这些函数是 $N_{3,1}(u)$ 和 $N_{4,1}(u)$。\n$$N_{3,1}(u) = \\frac{u-u_3}{u_4-u_3}N_{3,0}(u) + \\frac{u_5-u}{u_5-u_4}N_{4,0}(u) = 0 + \\frac{0.5-u}{0.5-0.25}(1) = \\frac{0.5-u}{0.25} = 2 - 4u$$\n$$N_{4,1}(u) = \\frac{u-u_4}{u_5-u_4}N_{4,0}(u) + \\frac{u_6-u}{u_6-u_5}N_{5,0}(u) = \\frac{u-0.25}{0.5-0.25}(1) + 0 = \\frac{u-0.25}{0.25} = 4u-1$$\n用 $s$ 表示：\n$N_{3,1}(u(s)) = 2 - 4(0.25+0.25s) = 2 - (1+s) = 1-s$。\n$N_{4,1}(u(s)) = 4(0.25+0.25s) - 1 = (1+s) - 1 = s$。\n\n对于 $p=2$：\n非零函数为 $N_{2,2}(u)$、$N_{3,2}(u)$ 和 $N_{4,2}(u)$，它们依赖于 $N_{2,1}, N_{3,1}, N_{4,1}$。在 $(0.25, 0.5)$ 上，$N_{2,1}(u)$ 为零，因为其支撑域为 $[u_2, u_4] = [0, 0.25]$。\n$$N_{2,2}(u) = \\frac{u-u_2}{u_4-u_2}N_{2,1}(u) + \\frac{u_5-u}{u_5-u_3}N_{3,1}(u) = 0 + \\frac{0.5-u}{0.5-0}(2-4u) = 2(0.5-u) \\cdot 2(1-2u) = 2(1-2u)^2$$\n用 $s$ 表示: $1-2u = 1 - 2(0.25+0.25s) = 1 - 0.5 - 0.5s = 0.5(1-s)$。\n$N_{2,2}(u(s)) = 2(0.5(1-s))^2 = 2 \\cdot 0.25(1-s)^2 = \\frac{1}{2}(1-s)^2$。\n\n$$N_{3,2}(u) = \\frac{u-u_3}{u_5-u_3}N_{3,1}(u) + \\frac{u_6-u}{u_6-u_4}N_{4,1}(u) = \\frac{u}{0.5}(2-4u) + \\frac{0.75-u}{0.5}(4u-1)$$\n用 $s$ 表示：\n$N_{3,2}(u(s)) = \\frac{0.25(1+s)}{0.5}(1-s) + \\frac{0.75-0.25(1+s)}{0.5}(s) = \\frac{1}{2}(1+s)(1-s) + \\frac{0.5-0.25s}{0.5}s = \\frac{1}{2}(1-s^2) + (1-0.5s)s = \\frac{1}{2} - \\frac{1}{2}s^2 + s - \\frac{1}{2}s^2 = -s^2+s+\\frac{1}{2}$。\n\n$$N_{4,2}(u) = \\frac{u-u_4}{u_6-u_4}N_{4,1}(u) + \\frac{u_7-u}{u_7-u_5}N_{5,1}(u)$$\n在 $(0.25, 0.5)$ 上，$N_{5,1}(u)$ 为零，因为其支撑域为 $[u_5, u_7]=[0.5, 1]$。\n$$N_{4,2}(u) = \\frac{u-0.25}{0.75-0.25}(4u-1) = \\frac{u-0.25}{0.5}(4u-1)$$\n用 $s$ 表示：$N_{4,2}(u(s)) = \\frac{0.25s}{0.5}(s) = \\frac{1}{2}s^2$。\n检验 $p=2$ 的单位分解性：$N_{2,2}+N_{3,2}+N_{4,2} = \\frac{1}{2}(1-s)^2 + (-s^2+s+\\frac{1}{2}) + \\frac{1}{2}s^2 = \\frac{1}{2}-s+\\frac{1}{2}s^2-s^2+s+\\frac{1}{2}+\\frac{1}{2}s^2 = 1$。计算正确。\n\n对于 $p=3$：\n非零基函数是 $N_{1,3}, N_{2,3}, N_{3,3}, N_{4,3}$。\n$N_{1,2}(u)$ 在 $(0.25, 0.5)$ 上为零，因为其支撑域为 $[u_1, u_4]=[0, 0.25]$。因此，\n$$N_{1,3}(u) = \\frac{u_5-u}{u_5-u_2}N_{2,2}(u) = \\frac{0.5-u}{0.5} N_{2,2}(u)$$\n用 $s$ 表示：$N_{1,3}(u(s)) = \\frac{0.5-(0.25+0.25s)}{0.5} \\frac{1}{2}(1-s)^2 = \\frac{0.25-0.25s}{0.5} \\frac{1}{2}(1-s)^2 = \\frac{1}{2}(1-s)\\frac{1}{2}(1-s)^2 = \\frac{1}{4}(1-s)^3$。\n\n$$N_{2,3}(u) = \\frac{u-u_2}{u_5-u_2}N_{2,2}(u) + \\frac{u_6-u}{u_6-u_3}N_{3,2}(u) = \\frac{u}{0.5}N_{2,2}(u) + \\frac{0.75-u}{0.75}N_{3,2}(u)$$\n用 $s$ 表示：\n$N_{2,3}(s) = \\frac{0.25(1+s)}{0.5}\\frac{1}{2}(1-s)^2 + \\frac{0.75-0.25(1+s)}{0.75}(-s^2+s+\\frac{1}{2})$\n$= \\frac{1}{4}(1+s)(1-s)^2 + \\frac{1-1/3(1+s)}{1}(-s^2+s+\\frac{1}{2}) = \\frac{1}{4}(1-s-s^2+s^3) + \\frac{2-s}{3}(-s^2+s+\\frac{1}{2})$\n$= \\frac{1}{4}(s^3-s^2-s+1) + \\frac{1}{3}(s^3-3s^2+1.5s+1)$\n$= s^3(\\frac{1}{4}+\\frac{1}{3}) + s^2(-\\frac{1}{4}-1) + s(-\\frac{1}{4}+\\frac{1}{2}) + (\\frac{1}{4}+\\frac{1}{3}) = \\frac{7}{12}s^3 - \\frac{5}{4}s^2 + \\frac{1}{4}s + \\frac{7}{12} = \\frac{1}{12}(7s^3 - 15s^2 + 3s + 7)$。\n\n$$N_{3,3}(u) = \\frac{u-u_3}{u_6-u_3}N_{3,2}(u) + \\frac{u_7-u}{u_7-u_4}N_{4,2}(u) = \\frac{u}{0.75}N_{3,2}(u) + \\frac{1-u}{0.75}N_{4,2}(u)$$\n用 $s$ 表示：\n$N_{3,3}(s) = \\frac{0.25(1+s)}{0.75}(-s^2+s+\\frac{1}{2}) + \\frac{1-0.25(1+s)}{0.75}(\\frac{1}{2}s^2) = \\frac{1}{3}(1+s)(-s^2+s+\\frac{1}{2}) + \\frac{0.75-0.25s}{0.75}(\\frac{1}{2}s^2)$\n$= \\frac{1}{3}(-s^3+1.5s+0.5) + (1-\\frac{1}{3}s)(\\frac{1}{2}s^2) = -\\frac{1}{3}s^3+\\frac{1}{2}s+\\frac{1}{6} + \\frac{1}{2}s^2-\\frac{1}{6}s^3 = -\\frac{1}{2}s^3+\\frac{1}{2}s^2+\\frac{1}{2}s+\\frac{1}{6} = \\frac{1}{6}(-3s^3+3s^2+3s+1)$。\n\n$N_{5,2}(u)$ 在 $(0.25, 0.5)$ 上为零，因为其支撑域为 $[u_5, u_8]=[0.5, 1]$。\n$$N_{4,3}(u) = \\frac{u-u_4}{u_7-u_4}N_{4,2}(u) = \\frac{u-0.25}{1-0.25} N_{4,2}(u) = \\frac{u-0.25}{0.75}N_{4,2}(u)$$\n用 $s$ 表示：$N_{4,3}(s) = \\frac{0.25s}{0.75}(\\frac{1}{2}s^2) = \\frac{1}{3}s(\\frac{1}{2}s^2) = \\frac{1}{6}s^3$。\n\n单元上的B样条基函数为：\n$N_{1,3}(s) = \\frac{1}{4}(1-s)^3$\n$N_{2,3}(s) = \\frac{1}{12}(7s^3 - 15s^2 + 3s + 7)$\n$N_{3,3}(s) = \\frac{1}{6}(-3s^3+3s^2+3s+1)$\n$N_{4,3}(s) = \\frac{1}{6}s^3$\n我们将这些表达式写在三次Bernstein基 $\\{B_0, B_1, B_2, B_3\\}$下，其中 $B_k(s) = \\binom{3}{k} s^k (1-s)^{3-k}$。\n$N_{1,3}(s) = \\frac{1}{4}B_0(s)$。\n$N_{4,3}(s) = \\frac{1}{6}B_3(s)$。\n对于 $N_{2,3}(s)$ 和 $N_{3,3}(s)$，我们寻找系数 $c_{ij}$ 使得 $N_{i,3}(s) = \\sum_{j=0}^3 c_{ij} B_j(s)$。这可以通过从单项式基 $\\{1, s, s^2, s^3\\}$ 到Bernstein基的基变换来完成。\n$N_{i,3}$ 在单项式基下的系数构成了矩阵 $A_N$ 的行：\n$$A_N = \\begin{pmatrix} 1/4 & -3/4 & 3/4 & -1/4 \\\\ 7/12 & 3/12 & -15/12 & 7/12 \\\\ 1/6 & 3/6 & 3/6 & -3/6 \\\\ 0 & 0 & 0 & 1/6 \\end{pmatrix}$$\n从单项式基到Bernstein基的变换矩阵为 $M_{P \\to B}$：\n$$M_{P \\to B} = \\begin{pmatrix} 1 & 1 & 1 & 1 \\\\ 0 & 1/3 & 2/3 & 1 \\\\ 0 & 0 & 1/3 & 1 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix}$$\nBézier提取矩阵 $C^{(e)}$ 由 $C^{(e)} = A_N M_{P \\to B}$ 给出。\n$C^{(e)}$ 的第一行：$[\\frac{1}{4}, 0, 0, 0]$。\n$C^{(e)}$ 的第四行：$[0, 0, 0, \\frac{1}{6}]$。\n第二行：$c_{21} = \\frac{7}{12}$，\n$c_{22} = \\frac{7}{12} + \\frac{3}{12}\\frac{1}{3} = \\frac{8}{12} = \\frac{2}{3}$，\n$c_{23} = \\frac{7}{12} + \\frac{3}{12}\\frac{2}{3} - \\frac{15}{12}\\frac{1}{3} = \\frac{7+2-5}{12} = \\frac{4}{12} = \\frac{1}{3}$，\n$c_{24} = \\frac{7+3-15+7}{12} = \\frac{2}{12} = \\frac{1}{6}$。\n第三行：$c_{31} = \\frac{1}{6}$，\n$c_{32} = \\frac{1}{6} + \\frac{3}{6}\\frac{1}{3} = \\frac{2}{6} = \\frac{1}{3}$，\n$c_{33} = \\frac{1}{6} + \\frac{3}{6}\\frac{2}{3} + \\frac{3}{6}\\frac{1}{3} = \\frac{1+2+1}{6} = \\frac{4}{6} = \\frac{2}{3}$，\n$c_{34} = \\frac{1+3+3-3}{6} = \\frac{4}{6} = \\frac{2}{3}$。\nBézier提取矩阵是：\n$$C^{(e)} = \\begin{pmatrix} 1/4 & 0 & 0 & 0 \\\\ 7/12 & 2/3 & 1/3 & 1/6 \\\\ 1/6 & 1/3 & 2/3 & 2/3 \\\\ 0 & 0 & 0 & 1/6 \\end{pmatrix} = \\frac{1}{12} \\begin{pmatrix} 3 & 0 & 0 & 0 \\\\ 7 & 8 & 4 & 2 \\\\ 2 & 4 & 8 & 8 \\\\ 0 & 0 & 0 & 2 \\end{pmatrix}$$\n\n最后，我们在 $s=1/2$（对应于 $u=0.375$）处验证结果。\n首先，在 $u=0.375$ 处使用de Boor算法：\n$p=0$: $N_{4,0}=1$。\n$p=1$: $N_{3,1}=\\frac{0.5-0.375}{0.25}=1/2$, $N_{4,1}=\\frac{0.375-0.25}{0.25}=1/2$。\n$p=2$: $N_{2,2}=\\frac{0.5-0.375}{0.5}N_{3,1}=1/8$, $N_{3,2}=\\frac{0.375}{0.5}N_{3,1}+\\frac{0.75-0.375}{0.5}N_{4,1}=3/4$, $N_{4,2}=\\frac{0.375-0.25}{0.5}N_{4,1}=1/8$。\n$p=3$:\n$N_{1,3} = \\frac{0.5-0.375}{0.5} N_{2,2} = \\frac{1}{4}\\frac{1}{8} = \\frac{1}{32}$。\n$N_{2,3} = \\frac{0.375}{0.5}N_{2,2}+\\frac{0.75-0.375}{0.75}N_{3,2} = \\frac{3}{4}\\frac{1}{8}+\\frac{1}{2}\\frac{3}{4}=\\frac{3}{32}+\\frac{12}{32}=\\frac{15}{32}$。\n$N_{3,3} = \\frac{0.375}{0.75}N_{3,2}+\\frac{1-0.375}{0.75}N_{4,2} = \\frac{1}{2}\\frac{3}{4}+\\frac{0.625}{0.75}\\frac{1}{8}=\\frac{3}{8}+\\frac{5}{6}\\frac{1}{8} = \\frac{18+5}{48}=\\frac{23}{48}$。\n$N_{4,3} = \\frac{0.375-0.25}{0.75}N_{4,2} = \\frac{0.125}{0.75}\\frac{1}{8}=\\frac{1}{6}\\frac{1}{8}=\\frac{1}{48}$。\nB样条值的向量为 $\\boldsymbol{N}(1/2) = (1/32, 15/32, 23/48, 1/48)^T$。\n\n其次，使用提取矩阵。在 $s=1/2$ 处，Bernstein多项式为 $\\boldsymbol{B}(1/2) = (1/8, 3/8, 3/8, 1/8)^T$。\n$$C^{(e)}\\boldsymbol{B}(\\frac{1}{2}) = \\frac{1}{12} \\begin{pmatrix} 3 & 0 & 0 & 0 \\\\ 7 & 8 & 4 & 2 \\\\ 2 & 4 & 8 & 8 \\\\ 0 & 0 & 0 & 2 \\end{pmatrix} \\frac{1}{8} \\begin{pmatrix} 1 \\\\ 3 \\\\ 3 \\\\ 1 \\end{pmatrix} = \\frac{1}{96} \\begin{pmatrix} 3 \\\\ 7+24+12+2 \\\\ 2+12+24+8 \\\\ 2 \\end{pmatrix} = \\frac{1}{96} \\begin{pmatrix} 3 \\\\ 45 \\\\ 46 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 3/96 \\\\ 45/96 \\\\ 46/96 \\\\ 2/96 \\end{pmatrix} = \\begin{pmatrix} 1/32 \\\\ 15/32 \\\\ 23/48 \\\\ 1/48 \\end{pmatrix}$$\n结果完全匹配，证实了所推导的提取矩阵的正确性。$N_{3,3}(u)$ 在 $u=0.375$ 处的值为 $23/48$。", "answer": "$$\\boxed{\\frac{23}{48}}$$", "id": "2584863"}]}