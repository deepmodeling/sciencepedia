{"hands_on_practices": [{"introduction": "等几何分析 (Isogeometric Analysis, IGA) 的核心在于其使用相同的基函数统一表示几何与分析场。本练习为此核心原则提供了基础实践。通过从头构建一条非均匀有理B样条 (Non-Uniform Rational B-Splines, NURBS) 曲线并推导其几何映射的雅可比行列式 (Jacobian)，您将具体理解计算机辅助设计 (CAD) 的几何体是如何被直接整合进分析框架中的 [@problem_id:2555182]。", "problem": "考虑一个由次数为 $p=2$ 的二次非均匀有理B样条（NURBS）曲线导出的一维等几何单元，其开放节点矢量为 $\\{0,0,0,\\tfrac{1}{2},1,1,1\\}$，控制点为 $\\mathbf{P}_0=(0,0)$、$\\mathbf{P}_1=(1,2)$、$\\mathbf{P}_2=(3,2)$、$\\mathbf{P}_3=(4,0)$，权因子为 $w_0=1$、$w_1=2$、$w_2=1$、$w_3=1$。关注对应于参数节点区间 $[0,\\tfrac{1}{2}]$ 的第一个单元，并使用一个线性映射到该区间的父单元坐标 $s \\in [-1,1]$。\n\n仅从B样条基函数的定义、通过权因子构造有理基函数的方法，以及等几何分析中使用的等参映射出发，执行以下操作：\n\n- 构造在第一个区间上活跃的二次B样条基函数及其关于曲线参数的一阶导数。\n- 构造第一个区间上相应的二次NURBS曲线，以及通过将NURBS曲线与从 $s$ 到曲线参数的线性映射进行复合而得到的等几何单元映射 $\\mathbf{x}(s)$。\n- 使用一维映射的标量雅可比定义 $J(s) = \\|\\mathrm{d}\\mathbf{x}/\\mathrm{d}s\\|$，计算 $J(s)$ 及其在父单元高斯点 $s=0$ 处关于 $s$ 的一阶导数。\n\n最后，报告 $J(0)$ 的精确封闭形式表达式。使用与控制点坐标相同的长度单位；在最终的方框答案中不要附加单位。", "solution": "目标是为一条二次非均匀有理B样条（NURBS）曲线构造单元映射，并在 $s=0$ 处计算标量雅可比 $J(s)=\\|\\mathrm{d}\\mathbf{x}/\\mathrm{d}s\\|$。我们从基本定义出发：用于B样条基函数的 Cox–de Boor 递推公式，定义NURBS基函数的有理化过程，以及单元上的标准等参父单元到参数的映射。\n\n数据：次数 $p=2$，节点矢量 $\\{0,0,0,\\tfrac{1}{2},1,1,1\\}$，控制点 $\\mathbf{P}_0=(0,0)$, $\\mathbf{P}_1=(1,2)$, $\\mathbf{P}_2=(3,2)$, $\\mathbf{P}_3=(4,0)$，权因子 $w_0=1$, $w_1=2$, $w_2=1$, $w_3=1$。\n\n在第一个节点区间 $[0,\\tfrac{1}{2})$ 上，只有三个二次B样条基函数 $N_{0,2}$、$N_{1,2}$ 和 $N_{2,2}$ 是非零的。使用 Cox–de Boor 递推公式和给定的节点矢量，在 $u \\in [0,\\tfrac{1}{2})$ 上可以得到：\n- $N_{0,2}(u) = 4\\left(\\tfrac{1}{2}-u\\right)^{2} = 1 - 4u + 4u^{2}$,\n- $N_{1,2}(u) = 4u - 6u^{2}$,\n- $N_{2,2}(u) = 2u^{2}$.\n\n它们在 $[0,\\tfrac{1}{2})$ 上关于 $u$ 的一阶和二阶导数是：\n- $N_{0,2}'(u) = -4 + 8u$, $N_{0,2}''(u)=8$,\n- $N_{1,2}'(u) = 4 - 12u$, $N_{1,2}''(u)=-12$,\n- $N_{2,2}'(u) = 4u$, $N_{2,2}''(u)=4$.\n\n在此区间上的有理二次NURBS基函数为\n$$\nR_i(u) = \\frac{w_i N_{i,2}(u)}{W(u)},\\quad W(u)=\\sum_{j=0}^{2} w_j N_{j,2}(u),\n$$\n因为对于 $u \\in [0,\\tfrac{1}{2})$，$N_{3,2}(u)=0$。NURBS曲线为\n$$\n\\mathbf{x}(u) = \\sum_{i=0}^{2} R_i(u)\\,\\mathbf{P}_i = \\frac{\\sum_{i=0}^{2} w_i N_{i,2}(u)\\,\\mathbf{P}_i}{W(u)}.\n$$\n定义齐次分子\n$$\n\\mathbf{S}(u) = \\sum_{i=0}^{2} w_i N_{i,2}(u)\\,\\mathbf{P}_i = 2 N_{1,2}(u)\\,\\mathbf{P}_1 + N_{2,2}(u)\\,\\mathbf{P}_2,\n$$\n因为 $w_0 N_{0,2}(u)\\,\\mathbf{P}_0 = \\mathbf{0}$。那么 $\\mathbf{x}(u) = \\mathbf{S}(u)/W(u)$。\n\n关于 $u$ 的一阶和二阶导数可由商法则得到：\n$$\n\\mathbf{x}'(u) = \\frac{\\mathbf{S}'(u) W(u) - \\mathbf{S}(u) W'(u)}{[W(u)]^{2}},\\qquad\n\\mathbf{x}''(u) = \\frac{\\left[\\mathbf{S}''(u) W(u) - \\mathbf{S}(u) W''(u)\\right] W(u) - 2\\left[\\mathbf{S}'(u) W(u) - \\mathbf{S}(u) W'(u)\\right] W'(u)}{[W(u)]^{3}}.\n$$\n这里，\n$$\n\\mathbf{S}'(u) = 2 N_{1,2}'(u)\\,\\mathbf{P}_1 + N_{2,2}'(u)\\,\\mathbf{P}_2,\\quad\n\\mathbf{S}''(u) = 2 N_{1,2}''(u)\\,\\mathbf{P}_1 + N_{2,2}''(u)\\,\\mathbf{P}_2,\\quad\nW'(u) = N_{0,2}'(u) + 2 N_{1,2}'(u) + N_{2,2}'(u),\\quad\nW''(u) = N_{0,2}''(u) + 2 N_{1,2}''(u) + N_{2,2}''(u).\n$$\n\n等几何单元由父单元坐标 $s \\in [-1,1]$ 线性映射到 $u \\in [0,\\tfrac{1}{2}]$ 来定义：\n$$\nu(s) = \\frac{s+1}{4},\\quad \\frac{\\mathrm{d}u}{\\mathrm{d}s} = \\frac{1}{4},\\quad \\frac{\\mathrm{d}^{2}u}{\\mathrm{d}s^{2}}=0.\n$$\n物理映射为 $\\mathbf{x}(s) = \\mathbf{x}(u(s))$。根据链式法则，\n$$\n\\frac{\\mathrm{d}\\mathbf{x}}{\\mathrm{d}s} = \\mathbf{x}'(u)\\,\\frac{\\mathrm{d}u}{\\mathrm{d}s},\\qquad\n\\frac{\\mathrm{d}^{2}\\mathbf{x}}{\\mathrm{d}s^{2}} = \\mathbf{x}''(u)\\left(\\frac{\\mathrm{d}u}{\\mathrm{d}s}\\right)^{2},\n$$\n因为 $\\mathrm{d}^{2}u/\\mathrm{d}s^{2}=0$。这个一维映射的标量雅可比为\n$$\nJ(s) = \\left\\|\\frac{\\mathrm{d}\\mathbf{x}}{\\mathrm{d}s}\\right\\| = \\left\\|\\mathbf{x}'\\big(u(s)\\big)\\right\\|\\,\\frac{1}{4}.\n$$\n\n我们现在计算在父单元高斯点 $s=0$ 处的所有量，此时 $u=\\tfrac{1}{4}$。\n\n在 $u=\\tfrac{1}{4}$ 处，计算基函数及其导数：\n- $N_{0,2}\\!\\left(\\tfrac{1}{4}\\right) = 1 - 4\\cdot \\tfrac{1}{4} + 4\\cdot \\tfrac{1}{16} = \\tfrac{1}{4}$,\n- $N_{1,2}\\!\\left(\\tfrac{1}{4}\\right) = 4\\cdot \\tfrac{1}{4} - 6\\cdot \\tfrac{1}{16} = \\tfrac{5}{8}$,\n- $N_{2,2}\\!\\left(\\tfrac{1}{4}\\right) = 2\\cdot \\tfrac{1}{16} = \\tfrac{1}{8}$,\n- $N_{0,2}'\\!\\left(\\tfrac{1}{4}\\right) = -4 + 8\\cdot \\tfrac{1}{4} = -2$,\n- $N_{1,2}'\\!\\left(\\tfrac{1}{4}\\right) = 4 - 12\\cdot \\tfrac{1}{4} = 1$,\n- $N_{2,2}'\\!\\left(\\tfrac{1}{4}\\right) = 4\\cdot \\tfrac{1}{4} = 1$,\n- $N_{0,2}''=8$, $N_{1,2}''=-12$, $N_{2,2}''=4$.\n\n计算权函数及其导数：\n$$\nW\\!\\left(\\tfrac{1}{4}\\right) = N_{0,2}\\cdot 1 + 2 N_{1,2} + N_{2,2} = \\tfrac{1}{4} + 2\\cdot \\tfrac{5}{8} + \\tfrac{1}{8} = \\tfrac{13}{8},\n$$\n$$\nW'\\!\\left(\\tfrac{1}{4}\\right) = N_{0,2}' + 2 N_{1,2}' + N_{2,2}' = -2 + 2\\cdot 1 + 1 = 1,\n$$\n$$\nW''\\!\\left(\\tfrac{1}{4}\\right) = N_{0,2}'' + 2 N_{1,2}'' + N_{2,2}'' = 8 + 2\\cdot(-12) + 4 = -12.\n$$\n\n计算 $\\mathbf{S}$, $\\mathbf{S}'$, $\\mathbf{S}''$：\n$$\n\\mathbf{S}\\!\\left(\\tfrac{1}{4}\\right) = 2 N_{1,2}\\,\\mathbf{P}_1 + N_{2,2}\\,\\mathbf{P}_2 = 2\\cdot \\tfrac{5}{8}(1,2) + \\tfrac{1}{8}(3,2) = \\left(\\tfrac{13}{8}, \\tfrac{11}{4}\\right),\n$$\n$$\n\\mathbf{S}'\\!\\left(\\tfrac{1}{4}\\right) = 2 N_{1,2}'\\,\\mathbf{P}_1 + N_{2,2}'\\,\\mathbf{P}_2 = 2\\cdot 1\\cdot (1,2) + 1\\cdot (3,2) = (5,6),\n$$\n$$\n\\mathbf{S}''\\!\\left(\\tfrac{1}{4}\\right) = 2 N_{1,2}''\\,\\mathbf{P}_1 + N_{2,2}''\\,\\mathbf{P}_2 = 2\\cdot (-12)(1,2) + 4(3,2) = (-12,-40).\n$$\n\n现在构造曲线的一阶导数：\n$$\n\\mathbf{x}'\\!\\left(\\tfrac{1}{4}\\right) = \\frac{\\mathbf{S}' W - \\mathbf{S} W'}{W^{2}} = \\frac{(5,6)\\cdot \\tfrac{13}{8} - \\left(\\tfrac{13}{8}, \\tfrac{11}{4}\\right)\\cdot 1}{\\left(\\tfrac{13}{8}\\right)^{2}}.\n$$\n计算分子：\n$$\n(5,6)\\cdot \\tfrac{13}{8} = \\left(\\tfrac{65}{8}, \\tfrac{78}{8}\\right),\\quad\n\\left(\\tfrac{65}{8}, \\tfrac{78}{8}\\right) - \\left(\\tfrac{13}{8}, \\tfrac{11}{4}\\right) = \\left(\\tfrac{52}{8}, \\tfrac{56}{8}\\right) = \\left(\\tfrac{13}{2}, 7\\right).\n$$\n除以 $W^{2} = \\left(\\tfrac{13}{8}\\right)^{2} = \\tfrac{169}{64}$：\n$$\n\\mathbf{x}'\\!\\left(\\tfrac{1}{4}\\right) = \\left(\\tfrac{13}{2}, 7\\right)\\cdot \\frac{64}{169} = \\left(\\frac{416}{169}, \\frac{448}{169}\\right).\n$$\n\n因此，在 $s=0$ 处（即 $u=\\tfrac{1}{4}$），\n$$\n\\frac{\\mathrm{d}\\mathbf{x}}{\\mathrm{d}s} = \\mathbf{x}'(u)\\,\\frac{\\mathrm{d}u}{\\mathrm{d}s} = \\left(\\frac{416}{169}, \\frac{448}{169}\\right)\\cdot \\frac{1}{4} = \\left(\\frac{104}{169}, \\frac{112}{169}\\right).\n$$\n因此，标量雅可比的大小为\n$$\nJ(0) = \\left\\|\\frac{\\mathrm{d}\\mathbf{x}}{\\mathrm{d}s}\\right\\| = \\sqrt{\\left(\\frac{104}{169}\\right)^{2} + \\left(\\frac{112}{169}\\right)^{2}} = \\frac{1}{169}\\sqrt{104^{2} + 112^{2}} = \\frac{1}{169}\\sqrt{10816 + 12544} = \\frac{1}{169}\\sqrt{23360}.\n$$\n将 23360 因式分解为 $23360 = 64\\cdot 365$，所以\n$$\nJ(0) = \\frac{1}{169}\\cdot 8\\sqrt{365} = \\frac{8\\sqrt{365}}{169}.\n$$\n\n为了完整起见，也可以求出一阶导数 $J'(0)$。使用 $\\mathbf{v}(s)=\\mathrm{d}\\mathbf{x}/\\mathrm{d}s$ 和 $\\mathbf{v}'(s)=\\mathrm{d}^{2}\\mathbf{x}/\\mathrm{d}s^{2}$，\n$$\nJ'(s) = \\frac{\\mathbf{v}(s)\\cdot \\mathbf{v}'(s)}{\\|\\mathbf{v}(s)\\|}.\n$$\n我们有 $\\mathbf{v}'(s) = \\mathbf{x}''(u)\\left(\\tfrac{\\mathrm{d}u}{\\mathrm{d}s}\\right)^{2} = \\tfrac{1}{16}\\mathbf{x}''(u)$。根据商法则表达式和以上数值，通过高效计算可得\n$$\n\\mathbf{x}''\\!\\left(\\tfrac{1}{4}\\right) = \\frac{\\left[\\mathbf{S}'' W - \\mathbf{S} W''\\right] W - 2\\left[\\mathbf{S}' W - \\mathbf{S} W'\\right] W'}{W^{3}} = \\frac{(-13,-66)}{\\left(\\tfrac{13}{8}\\right)^{3}} = \\left(-\\frac{512}{169}, -\\frac{33792}{2197}\\right).\n$$\n因此，\n$$\n\\mathbf{v}'(0) = \\frac{1}{16}\\mathbf{x}''\\!\\left(\\tfrac{1}{4}\\right) = \\left(-\\frac{32}{169}, -\\frac{2112}{2197}\\right),\n$$\n并且\n$$\n\\mathbf{v}(0)\\cdot \\mathbf{v}'(0) = \\left(\\frac{104}{169}\\right)\\left(-\\frac{32}{169}\\right) + \\left(\\frac{112}{169}\\right)\\left(-\\frac{2112}{2197}\\right) = -\\frac{279808}{371293}.\n$$\n由 $J(0)=\\tfrac{8\\sqrt{365}}{169}$，可得\n$$\nJ'(0) = \\frac{-\\tfrac{279808}{371293}}{\\tfrac{8\\sqrt{365}}{169}} = -\\frac{34976}{2197\\,\\sqrt{365}}.\n$$\n\n单元分类备注：所构造的映射定义了一个一维、二次（$p=2$）、有理、基于开放非均匀B样条的等几何单元，在内部节点（重复度为1）处具有 $C^{1}$ 单元间连续性，并且是一个非仿射的曲线几何映射。上面计算的标量雅可比 $J(0)$ 量化了从父单元坐标到第一个单元中心高斯点处物理曲线的局部长度缩放比例。\n\n所要求的最终量是 $J(0)$ 的精确封闭形式：\n$$\nJ(0) = \\frac{8\\sqrt{365}}{169}.\n$$", "answer": "$$\\boxed{\\frac{8\\sqrt{365}}{169}}$$", "id": "2555182"}, {"introduction": "在掌握了等几何映射的概念后，一个重要的实践问题是如何在IGA框架内高效地执行计算。贝塞尔提取 (Bézier extraction) 通过将全局B样条基与便于计算的单元局部伯恩斯坦 (Bernstein) 基联系起来，为此提供了优雅的解决方案。本练习将引导您从第一性原理出发，推导提取矩阵，从而揭示IGA在保持B样条全局光滑性的同时，利用贝塞尔单元简洁结构进行高效计算的数学机理 [@problem_id:2569829]。", "problem": "考虑在参数域 $[0,1]$ 上的一个一维等几何分析 (IGA) 设定，其二次 ($p=2$) B样条基由开、非均匀节点矢量 $\\Xi = [0,0,0,a,1,1,1]$ 定义，其中 $a \\in (0,1)$。我们关注与参数区间 $[0,a]$ 相关的左单元 $e$。令 $\\xi \\in [0,a]$ 表示参数坐标，并通过 $t = \\xi/a$ 定义到参考单元 $[0,1]$ 的局部仿射映射。令 $\\{B_0(t), B_1(t), B_2(t)\\}$ 表示 $[0,1]$ 上的二次 Bernstein 多项式，其中 $B_0(t) = (1-t)^2$，$B_1(t) = 2t(1-t)$，$B_2(t) = t^2$。\n\n根据 Bézier 提取的定义，B样条基 $\\{N_0^2(\\xi), N_1^2(\\xi), N_2^2(\\xi)\\}$ 在区间 $[0,a]$ 上的单元限制可以通过一个 $3 \\times 3$ 的 Bézier 提取矩阵 $C^{e}$ 表示为 $\\{B_0(t), B_1(t), B_2(t)\\}$ 的线性组合，使得\n$$\n\\begin{pmatrix}\nN_0^2(\\xi)\\\\\nN_1^2(\\xi)\\\\\nN_2^2(\\xi)\n\\end{pmatrix}\n= C^{e}\n\\begin{pmatrix}\nB_0(t)\\\\\nB_1(t)\\\\\nB_2(t)\n\\end{pmatrix},\n\\qquad t=\\xi/a,\\ \\xi\\in[0,a].\n$$\n\n仅从B样条的 Cox–de Boor 递推公式、Bernstein 基的定义以及仿射重参数化 $t=\\xi/a$ 出发，推导单元 $[0,a]$ 的矩阵 $C^{e}$，然后计算 $\\det(C^{e})$，将其表示为关于 $a$ 的闭式解析表达式。\n\n您的最终答案必须是关于 $a$ 的单个闭式表达式（无单位）。不需要进行数值近似或四舍五入。", "solution": "我们从基本定义开始。二次 ($p=2$) B样条基函数 $\\{N_i^2(\\xi)\\}$ 是通过 Cox–de Boor 递推公式定义的。开节点矢量为 $\\Xi = [\\xi_0,\\xi_1,\\xi_2,\\xi_3,\\xi_4,\\xi_5,\\xi_6]=[0,0,0,a,1,1,1]$。在左单元 $[0,a]$ 上，非零的 B样条基函数是 $N_0^2(\\xi)$、$N_1^2(\\xi)$ 和 $N_2^2(\\xi)$。\n\n我们将使用 Cox–de Boor 递推公式推导这三个函数在区间 $\\xi\\in[0,a]$ 上的显式形式，然后用 $t=\\xi/a$ 在 Bernstein 基 $\\{B_0(t),B_1(t),B_2(t)\\}$ 中重新表示它们，以确定 Bézier 提取矩阵 $C^{e}$。\n\n第一步：零次基。根据定义，\n- 如果 $\\xi_i \\le \\xi < \\xi_{i+1}$，$N_i^0(\\xi)=1$，否则为 $0$。\n在 $\\xi\\in[0,a)$ 上，唯一的非零零次基是 $N_2^0(\\xi)=1$（在 $[\\xi_2,\\xi_3)=[0,a)$ 上）；所有其他的在该区间上都为零。\n\n第二步：通过 Cox–de Boor 递推计算一次基。对于一次基，\n$$\nN_i^1(\\xi) = \\frac{\\xi-\\xi_i}{\\xi_{i+1}-\\xi_i}N_i^0(\\xi) + \\frac{\\xi_{i+2}-\\xi}{\\xi_{i+2}-\\xi_{i+1}}N_{i+1}^0(\\xi),\n$$\n约定任何分母为零的项都取零。\n\n计算在 $[0,a)$ 上的两个相关的非零函数：\n\n- 对于 $i=1$，\n$$\nN_1^1(\\xi) = \\frac{\\xi-\\xi_1}{\\xi_2-\\xi_1}N_1^0(\\xi) + \\frac{\\xi_3-\\xi}{\\xi_3-\\xi_2}N_2^0(\\xi).\n$$\n这里 $\\xi_1=\\xi_2=0$ 使得第一项按约定为零，而 $\\xi_3=a$，$\\xi_2=0$，并且在 $[0,a)$ 上 $N_2^0(\\xi)=1$。因此\n$$\nN_1^1(\\xi) = \\frac{a-\\xi}{a}.\n$$\n\n- 对于 $i=2$，\n$$\nN_2^1(\\xi) = \\frac{\\xi-\\xi_2}{\\xi_3-\\xi_2}N_2^0(\\xi) + \\frac{\\xi_4-\\xi}{\\xi_4-\\xi_3}N_3^0(\\xi).\n$$\n在 $[0,a)$ 上，$N_3^0(\\xi)=0$，且 $\\xi_2=0$，$\\xi_3=a$，我们得到\n$$\nN_2^1(\\xi) = \\frac{\\xi}{a}.\n$$\n\n所有其他 $N_i^1(\\xi)$ 在 $[0,a)$ 上都为零。\n\n第三步：通过 Cox–de Boor 递推计算二次基。对于二次基，\n$$\nN_i^2(\\xi) = \\frac{\\xi-\\xi_i}{\\xi_{i+2}-\\xi_i}N_i^1(\\xi) + \\frac{\\xi_{i+3}-\\xi}{\\xi_{i+3}-\\xi_{i+1}}N_{i+1}^1(\\xi),\n$$\n同样遵循分母为零的约定。\n\n计算在 $[0,a)$ 上的 $N_0^2(\\xi)$、$N_1^2(\\xi)$ 和 $N_2^2(\\xi)$：\n\n- 对于 $i=0$，\n$$\nN_0^2(\\xi) = \\frac{\\xi-\\xi_0}{\\xi_2-\\xi_0}N_0^1(\\xi) + \\frac{\\xi_3-\\xi}{\\xi_3-\\xi_1}N_1^1(\\xi).\n$$\n这里 $\\xi_0=\\xi_2=0$ 使得第一项为零，且有 $\\xi_3=a$，$\\xi_1=0$，我们得到\n$$\nN_0^2(\\xi) = \\frac{a-\\xi}{a}\\,N_1^1(\\xi) = \\frac{a-\\xi}{a}\\cdot \\frac{a-\\xi}{a} = \\frac{(a-\\xi)^2}{a^2}.\n$$\n\n- 对于 $i=1$，\n$$\nN_1^2(\\xi) = \\frac{\\xi-\\xi_1}{\\xi_3-\\xi_1}N_1^1(\\xi) + \\frac{\\xi_4-\\xi}{\\xi_4-\\xi_2}N_2^1(\\xi).\n$$\n使用 $\\xi_1=0$，$\\xi_3=a$，$\\xi_4=1$，$\\xi_2=0$ 以及第二步的表达式，\n$$\nN_1^2(\\xi) = \\frac{\\xi}{a}\\cdot \\frac{a-\\xi}{a} + \\frac{1-\\xi}{1}\\cdot \\frac{\\xi}{a} = \\frac{\\xi(a-\\xi)}{a^2} + \\frac{\\xi(1-\\xi)}{a}.\n$$\n\n- 对于 $i=2$，\n$$\nN_2^2(\\xi) = \\frac{\\xi-\\xi_2}{\\xi_4-\\xi_2}N_2^1(\\xi) + \\frac{\\xi_5-\\xi}{\\xi_5-\\xi_3}N_3^1(\\xi).\n$$\n在 $[0,a)$ 上，$N_3^1(\\xi)=0$，且 $\\xi_2=0$，$\\xi_4=1$，\n$$\nN_2^2(\\xi) = \\xi \\cdot \\frac{\\xi}{a} = \\frac{\\xi^2}{a}.\n$$\n\n第四步：重参数化到参考单元，并用 Bernstein 基表示。设 $t=\\xi/a$，所以 $\\xi = a t$ 且 $t\\in[0,1]$。代入：\n\n- $N_0^2(\\xi) = \\dfrac{(a-\\xi)^2}{a^2} = \\dfrac{(a-a t)^2}{a^2} = (1-t)^2 = B_0(t).$\n\n- $N_1^2(\\xi) = \\dfrac{\\xi(a-\\xi)}{a^2} + \\dfrac{\\xi(1-\\xi)}{a} = t(1-t) + t(1-a t) = 2t - (1+a)t^2.$\n\n- $N_2^2(\\xi) = \\dfrac{\\xi^2}{a} = \\dfrac{a^2 t^2}{a} = a\\,t^2 = a\\,B_2(t).$\n\n现在将 $N_1^2(\\xi)$ 用 Bernstein 基 $\\{B_0(t),B_1(t),B_2(t)\\}$ 表示，其中\n$$\nB_0(t)=(1-t)^2=1-2t+t^2,\\quad B_1(t)=2t(1-t)=2t-2t^2,\\quad B_2(t)=t^2.\n$$\n寻求系数 $c_0,c_1,c_2$ 使得\n$$\nN_1^2(\\xi) = c_0 B_0(t) + c_1 B_1(t) + c_2 B_2(t).\n$$\n匹配 $t$ 的各次幂的系数。等式左边是 $2t-(1+a)t^2$，其常数项为零，因此 $c_0=0$。$t$ 的系数给出 $2c_1 = 2$，所以 $c_1=1$。$t^2$ 的系数得出 $(-2)c_1 + c_2 = -(1+a)$，即 $-2 + c_2 = -(1+a)$，所以 $c_2 = 1 - a$。\n\n因此，在单元 $[0,a]$ 上我们有\n$$\n\\begin{aligned}\nN_0^2(\\xi) &= 1\\cdot B_0(t) + 0\\cdot B_1(t) + 0\\cdot B_2(t),\\\\\nN_1^2(\\xi) &= 0\\cdot B_0(t) + 1\\cdot B_1(t) + (1-a)\\cdot B_2(t),\\\\\nN_2^2(\\xi) &= 0\\cdot B_0(t) + 0\\cdot B_1(t) + a\\cdot B_2(t).\n\\end{aligned}\n$$\n\n因此，满足\n$$\n\\begin{pmatrix}\nN_0^2(\\xi)\\\\\nN_1^2(\\xi)\\\\\nN_2^2(\\xi)\n\\end{pmatrix}\n= C^{e}\n\\begin{pmatrix}\nB_0(t)\\\\\nB_1(t)\\\\\nB_2(t)\n\\end{pmatrix}\n$$\n的 Bézier 提取矩阵 $C^{e}$ 是\n$$\nC^{e} =\n\\begin{pmatrix}\n1 & 0 & 0\\\\\n0 & 1 & 1-a\\\\\n0 & 0 & a\n\\end{pmatrix}.\n$$\n\n这是一个上三角矩阵，所以其行列式是对角元素的乘积：\n$$\n\\det(C^{e}) = 1 \\cdot 1 \\cdot a = a.\n$$\n\n因此，对于左单元 $[0,a]$ 的 Bézier 提取矩阵的行列式是 $a$。", "answer": "$$\\boxed{a}$$", "id": "2569829"}, {"introduction": "与传统有限元法 (Finite Element Method, FEM) 的一个显著区别是，B样条基函数通常在边界不具备插值性，这使得强加狄利克雷 (Dirichlet) 边界条件变得困难。本练习介绍了Nitsche方法，这是一种用于弱形式施加本质边界条件的强大变分技术。通过推导完整的离散系统并确定保证稳定性所需的罚参数 $\\gamma$，您将掌握一项对于开发稳健IGA模型至关重要的高级技术 [@problem_id:2569894]。", "problem": "考虑在物理域 $\\Omega = (a,b) = (0.5, 0.75)$ 上的一维稳态扩散问题，其齐次Dirichlet边界条件为 $u(a) = 0$ 和 $u(b) = 0$，由 $-u''(x) = 0$ 控制。使用由次数为 $p=2$ 的非有理B样条构建的等几何分析 (IGA) 空间来离散化 $\\Omega$，其节点向量为非开放、均匀分布的 $\\Xi = \\{0,\\, 0.25,\\, 0.5,\\, 0.75,\\, 1,\\, 1.25\\}$，几何映射为恒等映射 $x(\\xi) = \\xi$。在此参数化上，活动参数区间为 $[\\xi_{p+1}, \\xi_{n_k - p}] = [0.5, 0.75]$，与 $\\Omega$ 重合。由于端点重复度为1（非夹持），基函数在边界 $\\partial \\Omega$ 上是非插值的，因此无法通过控制变量强加本质边界条件。\n\n从标准弱形式出发，并使用Nitsche法的对称形式来弱施加本质边界条件，导出由以下各项组装而成的离散双线性形式：\n- 体积项 $\\int_{\\Omega} u'(x)\\,v'(x)\\,dx$，\n- 在 $\\partial \\Omega$ 上的两个一致性边界项，\n- 以及带有罚参数 $\\gamma/h$ 的对称罚项，其中 $h = b - a$。\n\n使用 Cox–de Boor 递推公式得到在唯一的非零单元上的显式基函数，并精确计算所有必需的积分，以组装关于 $\\gamma$ 的全局 $3 \\times 3$ 刚度矩阵。确定使得所得离散双线性形式在离散空间上是矫顽的（等价地，全局刚度矩阵是对称正定的）最小$\\gamma$值。以一个精确、无单位的数字形式给出最终答案。不需要四舍五入。", "solution": "问题要求解使得Nitsche法的离散双线性形式是矫顽的最小罚参数$\\gamma$值。这等价于找到使全局刚度矩阵对称正定的最小$\\gamma$。\n\n问题由 $-u''(x) = 0$ 在 $\\Omega = (a, b) = (0.5, 0.75)$ 上控制，齐次Dirichlet边界条件为 $u(0.5) = u(0.75) = 0$。\n离散化使用节点向量 $\\Xi = \\{0, 0.25, 0.5, 0.75, 1, 1.25\\}$ 上的二次B样条（$p=2$）。\n基函数的数量为 $n = n_k - p - 1 = 6 - 2 - 1 = 3$。记为 $N_1(x), N_2(x), N_3(x)$。\n物理域 $\\Omega = (0.5, 0.75)$ 对应于单个参数单元 $[\\xi_3, \\xi_4] = [0.5, 0.75]$，因为几何映射是恒等映射 $x(\\xi)=\\xi$。单元长度为 $h = 0.75 - 0.5 = 0.25$。\n所有三个基函数（$N_1, N_2, N_3$）在该单元上均非零。\n\n首先，我们确定基函数 $N_i(x)$ 及其导数 $N_i'(x)$ 在区间 $[0.5, 0.75]$ 上的解析表达式。我们使用从参考区间 $\\eta \\in [0, 1]$ 到物理单元 $x \\in [0.5, 0.75]$ 的标准映射 $x = 0.5 + h\\eta = 0.5 + 0.25\\eta$。因此，$\\eta = (x - 0.5)/0.25 = 4x-2$。根据链式法则可得 $\\frac{d}{dx} = \\frac{d\\eta}{dx}\\frac{d}{d\\eta} = 4\\frac{d}{d\\eta}$。\n参考单元上的二次B样条基函数为：\n$$\n\\hat{N}_1(\\eta) = \\frac{1}{2}(1-\\eta)^2, \\quad \\hat{N}_2(\\eta) = \\frac{1}{2}(-2\\eta^2+2\\eta+1), \\quad \\hat{N}_3(\\eta) = \\frac{1}{2}\\eta^2\n$$\n限制在该单元上的全局基函数 $N_i(x)$ 为 $N_i(x) = \\hat{N}_i(\\eta(x))$：\n$N_1(x) = \\frac{1}{2}(1 - (4x-2))^2 = \\frac{1}{2}(3-4x)^2 = 8x^2 - 12x + 4.5$\n$N_2(x) = \\frac{1}{2}(-2(4x-2)^2 + 2(4x-2) + 1) = -16x^2 + 20x - 5.5$\n$N_3(x) = \\frac{1}{2}(4x-2)^2 = 8x^2 - 8x + 2$\n关于 $x$ 的导数为：\n$N_1'(x) = 16x - 12$\n$N_2'(x) = -32x + 20$\n$N_3'(x) = 16x - 8$\n\n此问题的对称Nitsche双线性形式为：\n$$\nB(u_h, v_h) = \\int_a^b u_h' v_h' dx - \\left( u_h'(b)v_h(b) - u_h'(a)v_h(a) \\right) - \\left( u_h(b)v_h'(b) - u_h(a)v_h'(a) \\right) + \\frac{\\gamma}{h}\\left( u_h(a)v_h(a) + u_h(b)v_h(b) \\right)\n$$\n全局刚度矩阵 $K$ 的项为 $K_{ij} = B(N_j, N_i)$。我们计算基函数及其导数在边界 $a=0.5$ 和 $b=0.75$ 处的值：\n在 $x=a=0.5$ 处：\n$N_1(0.5)=0.5$, $N_2(0.5)=0.5$, $N_3(0.5)=0$\n$N_1'(0.5)=-4$, $N_2'(0.5)=4$, $N_3'(0.5)=0$\n在 $x=b=0.75$ 处：\n$N_1(0.75)=0$, $N_2(0.75)=0.5$, $N_3(0.75)=0.5$\n$N_1'(0.75)=0$, $N_2'(0.75)=-4$, $N_3'(0.75)=4$\n\n刚度矩阵 $K$ 是三个分量之和：$K = K_{vol} + K_{bound} + K_{pen}$。\n\n1.  体积项 $K_{vol}$，其项为 $(K_{vol})_{ij} = \\int_{0.5}^{0.75} N_i' N_j' dx$。\n    使用参考单元，$(K_{vol})_{ij} = \\int_0^1 (4\\hat{N}_i'(\\eta))(4\\hat{N}_j'(\\eta)) (h d\\eta) = 16h \\int_0^1 \\hat{N}_i'\\hat{N}_j' d\\eta = 4 \\int_0^1 \\hat{N}_i'\\hat{N}_j' d\\eta$。\n    积分矩阵 $\\int_0^1 \\hat{N}_i'\\hat{N}_j' d\\eta$ 是 $\\frac{1}{6}\\begin{pmatrix} 2 & -1 & -1 \\\\ -1 & 2 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix}$。\n    $$\n    K_{vol} = 4 \\cdot \\frac{1}{6} \\begin{pmatrix} 2 & -1 & -1 \\\\ -1 & 2 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix} = \\frac{2}{3} \\begin{pmatrix} 2 & -1 & -1 \\\\ -1 & 2 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix} = \\begin{pmatrix} 4/3 & -2/3 & -2/3 \\\\ -2/3 & 4/3 & -2/3 \\\\ -2/3 & -2/3 & 4/3 \\end{pmatrix}\n    $$\n\n2.  边界项（一致性和伴随项）$K_{bound}$，其项为 $(K_{bound})_{ij} = -(N_i(b)N_j'(b) - N_i(a)N_j'(a)) - (N_i'(b)N_j(b) - N_i'(a)N_j(a))$。\n    令 $\\mathbf{N}(x) = [N_1(x), N_2(x), N_3(x)]^T$。\n    $C = \\mathbf{N}(a)\\mathbf{N}'(a)^T = \\begin{pmatrix} 0.5 \\\\ 0.5 \\\\ 0 \\end{pmatrix} [-4, 4, 0] = \\begin{pmatrix} -2 & 2 & 0 \\\\ -2 & 2 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$\n    $D = \\mathbf{N}(b)\\mathbf{N}'(b)^T = \\begin{pmatrix} 0 \\\\ 0.5 \\\\ 0.5 \\end{pmatrix} [0, -4, 4] = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & -2 & 2 \\\\ 0 & -2 & 2 \\end{pmatrix}$\n    边界矩阵为 $-(D-C) - (D-C)^T$。\n    $D-C = \\begin{pmatrix} 2 & -2 & 0 \\\\ 2 & -4 & 2 \\\\ 0 & -2 & 2 \\end{pmatrix}$\n    $$\n    K_{bound} = -\\begin{pmatrix} 2 & -2 & 0 \\\\ 2 & -4 & 2 \\\\ 0 & -2 & 2 \\end{pmatrix} - \\begin{pmatrix} 2 & 2 & 0 \\\\ -2 & -4 & -2 \\\\ 0 & 2 & 2 \\end{pmatrix} = \\begin{pmatrix} -4 & 0 & 0 \\\\ 0 & 8 & 0 \\\\ 0 & 0 & -4 \\end{pmatrix}\n    $$\n\n3.  罚项 $K_{pen}$，其项为 $(K_{pen})_{ij} = \\frac{\\gamma}{h}(N_i(a)N_j(a) + N_i(b)N_j(b))$。给定 $h=0.25$，则 $\\frac{\\gamma}{h} = 4\\gamma$。\n    $A = \\mathbf{N}(a)\\mathbf{N}(a)^T = \\begin{pmatrix} 0.25 & 0.25 & 0 \\\\ 0.25 & 0.25 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$\n    $B = \\mathbf{N}(b)\\mathbf{N}(b)^T = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0.25 & 0.25 \\\\ 0 & 0.25 & 0.25 \\end{pmatrix}$\n    $$\n    K_{pen} = 4\\gamma (A+B) = 4\\gamma \\begin{pmatrix} 0.25 & 0.25 & 0 \\\\ 0.25 & 0.5 & 0.25 \\\\ 0 & 0.25 & 0.25 \\end{pmatrix} = \\gamma \\begin{pmatrix} 1 & 1 & 0 \\\\ 1 & 2 & 1 \\\\ 0 & 1 & 1 \\end{pmatrix}\n    $$\n\n总刚度矩阵为 $K(\\gamma) = K_{vol} + K_{bound} + K_{pen}$：\n$$\nK(\\gamma) = \\begin{pmatrix} 4/3 & -2/3 & -2/3 \\\\ -2/3 & 4/3 & -2/3 \\\\ -2/3 & -2/3 & 4/3 \\end{pmatrix} + \\begin{pmatrix} -4 & 0 & 0 \\\\ 0 & 8 & 0 \\\\ 0 & 0 & -4 \\end{pmatrix} + \\gamma \\begin{pmatrix} 1 & 1 & 0 \\\\ 1 & 2 & 1 \\\\ 0 & 1 & 1 \\end{pmatrix}\n$$\n$$\nK(\\gamma) = \\begin{pmatrix} -8/3+\\gamma & -2/3+\\gamma & -2/3 \\\\ -2/3+\\gamma & 28/3+2\\gamma & -2/3+\\gamma \\\\ -2/3 & -2/3+\\gamma & -8/3+\\gamma \\end{pmatrix}\n$$\n为使双线性形式是矫顽的，$K(\\gamma)$ 必须是对称正定的。该矩阵根据其构造是对称的。根据Sylvester准则，所有主子式必须为正。\n1.  第一个主子式 $M_1 > 0$：\n    $K_{11} = -8/3 + \\gamma > 0 \\implies \\gamma > 8/3$。\n\n2.  第二个主子式 $M_2 > 0$：\n    $\\det \\begin{pmatrix} -8/3+\\gamma & -2/3+\\gamma \\\\ -2/3+\\gamma & 28/3+2\\gamma \\end{pmatrix} > 0$\n    $(-8/3+\\gamma)(28/3+2\\gamma) - (-2/3+\\gamma)^2 > 0$\n    $(2\\gamma^2 + 4\\gamma - 224/9) - (\\gamma^2 - 4/3\\gamma + 4/9) > 0$\n    $\\gamma^2 + \\frac{16}{3}\\gamma - \\frac{228}{9} > 0 \\implies 3\\gamma^2 + 16\\gamma - 76 > 0$。\n    $3y^2+16y-76=0$ 的根是 $y = \\frac{-16 \\pm \\sqrt{16^2 - 4(3)(-76)}}{6} = \\frac{-16 \\pm \\sqrt{256+912}}{6} = \\frac{-16 \\pm \\sqrt{1168}}{6} = \\frac{-16 \\pm 4\\sqrt{73}}{6} = \\frac{-8 \\pm 2\\sqrt{73}}{3}$。\n    因为我们需要 $\\gamma>0$，所以条件是 $\\gamma > \\frac{-8 + 2\\sqrt{73}}{3}$。由于 $8 < \\sqrt{73} < 9$，该值为正。$\\frac{-8+2(8.54)}{3} \\approx 3.03$。这比 $\\gamma > 8/3 \\approx 2.67$ 更具限制性。\n\n3.  第三个主子式 $M_3 = \\det(K) > 0$。\n    令 $K' = 3K$。$\\det(K) = (1/27)\\det(K')$。我们需要 $\\det(K')>0$。\n    $$K' = \\begin{pmatrix} -8+3\\gamma & -2+3\\gamma & -2 \\\\ -2+3\\gamma & 28+6\\gamma & -2+3\\gamma \\\\ -2 & -2+3\\gamma & -8+3\\gamma \\end{pmatrix}$$\n    由于矩阵的结构（$K'_{11}=K'_{33}$，$K'_{12}=K'_{23}=K'_{32}=K'_{21}$），行列式的计算简化为：\n    $\\det(K') = (K'_{11}-K'_{13})[(K'_{11}+K'_{13})K'_{22} - 2(K'_{12})^2]$\n    $K'_{11}-K'_{13} = (-8+3\\gamma) - (-2) = 3\\gamma-6 = 3(\\gamma-2)$。\n    $K'_{11}+K'_{13} = (-8+3\\gamma) + (-2) = 3\\gamma-10$。\n    $(K'_{11}+K'_{13})K'_{22} - 2(K'_{12})^2 = (3\\gamma-10)(28+6\\gamma) - 2(-2+3\\gamma)^2$\n    $= (18\\gamma^2 + 24\\gamma - 280) - 2(9\\gamma^2 - 12\\gamma + 4)$\n    $= (18\\gamma^2 + 24\\gamma - 280) - (18\\gamma^2 - 24\\gamma + 8) = 48\\gamma - 288 = 48(\\gamma-6)$。\n    所以，$\\det(K') = 3(\\gamma-2) \\cdot 48(\\gamma-6) = 144(\\gamma-2)(\\gamma-6)$。\n    条件 $\\det(K) > 0$ 要求 $(\\gamma-2)(\\gamma-6) > 0$，这意味着 $\\gamma > 6$ 或 $\\gamma < 2$。\n\n综合所有条件：\n(1) $\\gamma > 8/3 \\approx 2.67$\n(2) $\\gamma > \\frac{-8 + 2\\sqrt{73}}{3} \\approx 3.03$\n(3) $\\gamma > 6$ 或 $\\gamma < 2$\n\n这些条件的交集是 $\\gamma > 6$。使得双线性形式是矫顽的 $\\gamma$ 值的集合是 $(6, \\infty)$。问题要求的是满足此条件的最小 $\\gamma$ 值。这对应于该集合的下确界。\n\n因此，最小值为 $6$。当 $\\gamma=6$ 时，矩阵是半正定的，但不是正定的，因为其行列式为零。对于任何 $\\gamma > 6$，该矩阵都是严格正定的。", "answer": "$$\\boxed{6}$$", "id": "2569894"}]}