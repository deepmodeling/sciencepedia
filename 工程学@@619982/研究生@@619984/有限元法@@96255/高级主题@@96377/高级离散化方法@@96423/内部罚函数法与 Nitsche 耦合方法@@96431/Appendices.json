{"hands_on_practices": [{"introduction": "要实现非连续伽辽金（DG）方法，关键在于精确处理单元交界面上的积分。本练习聚焦于对称内部罚（SIPG）方法和 Nitsche 方法的核心数学构造。掌握这些公式是确保代码实现正确性和稳定性的首要且至关重要的一步，它将帮助您检验自己对于构建双线性和线性形式的理解，确保对称性和方向独立性等关键性质得到满足。[@problem_id:2569501]", "problem": "考虑在多面体区域 $\\Omega \\subset \\mathbb{R}^d$ 上具有 Dirichlet 边界数据的标量扩散模型问题：\n$$\n-\\nabla \\cdot (\\kappa \\nabla u) = f \\quad \\text{in } \\Omega, \n\\qquad\nu = g \\quad \\text{on } \\Gamma_D = \\partial \\Omega,\n$$\n其中 $\\kappa(x) > 0$ 在一个形状正则的单纯形或六面体网格 $\\mathcal{T}_h$ 上是分片常数。令 $\\mathcal{F}_h^{\\mathrm{int}}$ 表示内部面的集合，$\\mathcal{F}_h^{\\mathrm{D}}$ 表示 $\\Gamma_D$ 上边界面的集合。考虑在 $\\mathcal{T}_h$ 上，由次数 $\\le p \\ge 1$ 的分片多项式构成的间断 Galerkin (DG) 有限元空间 $V_h$。\n\n关于面的实现约定。对于每个由单元 $K_L$ 和 $K_R$ 共享的内部面 $F \\in \\mathcal{F}_h^{\\mathrm{int}}$，存储一个从 $K_L$ 指向 $K_R$ 的任意但固定的单位法向量 $\\boldsymbol{n}_F$。定义 $F$ 上的迹为 $u_L := u|_{K_L}$ 和 $u_R := u|_{K_R}$。定义标量跳跃和向量平均为\n$$\n[w] := u_L - u_R, \n\\qquad\n\\{\\boldsymbol{\\phi}\\} := \\tfrac{1}{2}\\left( \\boldsymbol{\\phi}_L + \\boldsymbol{\\phi}_R \\right),\n$$\n对于在 $F$ 上有良定义迹的任意向量场 $\\boldsymbol{\\phi}$。对于边界面 $F \\in \\mathcal{F}_h^{\\mathrm{D}}$，令 $\\boldsymbol{n}$ 表示指向 $\\Omega$ 外部的单位法向量，并使用相同的跳跃/平均记号，约定在边界面上只有一个来自内部的迹。\n\n令 $h_F$ 表示面直径，并假设一个按面定义的罚参数形式为 $\\eta_F \\simeq C_{\\mathrm{IP}} \\,\\overline{\\kappa}_F \\, p^2$，其中 $\\overline{\\kappa}_F$ 是一个与网格和系数相关的正平均值（例如，在内部面上是算术平均值 $\\overline{\\kappa}_F := \\tfrac{1}{2}(\\kappa|_{K_L}+\\kappa|_{K_R})$，在边界面上是 $\\overline{\\kappa}_F := \\kappa|_K$），并且 $C_{\\mathrm{IP}} > 0$ 是一个足够大的常数。在整个过程中，双线性和线性形式通过对单元体积项和面项求和来组装。\n\n问题。在上述跳跃/平均约定下，对于双线性形式 $a_h(\\cdot,\\cdot)$ 和线性形式 $\\ell_h(\\cdot)$ 的面贡献，以下哪种表述为内部面上的对称内部罚 Galerkin (SIPG) 方法和 Dirichlet 边界面上的 Nitsche 方法提供了一个方向无关、对称且伴随一致的耦合？\n\nA. 内部面 $F \\in \\mathcal{F}_h^{\\mathrm{int}}$:\n$$\na_F(u,v) \\;=\\; -\\int_F \\{\\kappa \\nabla u\\}\\cdot \\boldsymbol{n}_F \\,[v] \\;-\\; \\int_F \\{\\kappa \\nabla v\\}\\cdot \\boldsymbol{n}_F \\,[u] \\;+\\; \\int_F \\frac{\\eta_F}{h_F}\\,[u]\\,[v].\n$$\nDirichlet 边界面 $F \\in \\mathcal{F}_h^{\\mathrm{D}}$ (Nitsche):\n$$\na_F(u,v) \\;=\\; -\\int_F \\kappa \\nabla u \\cdot \\boldsymbol{n}\\, v \\;-\\; \\int_F \\kappa \\nabla v \\cdot \\boldsymbol{n}\\, u \\;+\\; \\int_F \\frac{\\eta_F}{h_F}\\, u\\, v,\n$$\n$$\n\\ell_F(v) \\;=\\; \\int_F \\frac{\\eta_F}{h_F}\\, g\\, v \\;-\\; \\int_F \\kappa \\nabla v \\cdot \\boldsymbol{n}\\, g.\n$$\n\nB. 内部面 $F \\in \\mathcal{F}_h^{\\mathrm{int}}$:\n$$\na_F(u,v) \\;=\\; -\\int_F \\{\\kappa \\nabla u \\cdot \\boldsymbol{n}_{\\mathrm{out}}\\}\\,[v] \\;-\\; \\int_F \\{\\kappa \\nabla v \\cdot \\boldsymbol{n}_{\\mathrm{out}}\\}\\,[u] \\;+\\; \\int_F \\frac{\\eta_F}{h_F}\\,[u]\\,[v],\n$$\n其中 $\\{\\kappa \\nabla u \\cdot \\boldsymbol{n}_{\\mathrm{out}}\\} := \\tfrac{1}{2}\\big(\\kappa_L \\nabla u_L \\cdot \\boldsymbol{n}_{L\\!,F} + \\kappa_R \\nabla u_R \\cdot \\boldsymbol{n}_{R\\!,F}\\big)$ 使用 $K_L$ 的外法向量 $\\boldsymbol{n}_{L\\!,F}$ 和 $K_R$ 的外法向量 $\\boldsymbol{n}_{R\\!,F}$ 在 $F$ 上的值。Dirichlet 边界面 $F \\in \\mathcal{F}_h^{\\mathrm{D}}$:\n$$\na_F(u,v) \\;=\\; -\\int_F \\kappa \\nabla u \\cdot \\boldsymbol{n}\\, v \\;-\\; \\int_F \\kappa \\nabla v \\cdot \\boldsymbol{n}\\, u \\;+\\; \\int_F \\frac{\\eta_F}{h_F}\\, u\\, v,\n\\qquad\n\\ell_F(v) \\;=\\; \\int_F \\frac{\\eta_F}{h_F}\\, g\\, v \\;-\\; \\int_F \\kappa \\nabla v \\cdot \\boldsymbol{n}\\, g.\n$$\n\nC. 内部面 $F \\in \\mathcal{F}_h^{\\mathrm{int}}$:\n$$\na_F(u,v) \\;=\\; -\\int_F \\{\\kappa \\nabla u\\}\\cdot \\boldsymbol{n}_F \\,[v] \\;+\\; \\int_F \\frac{\\eta_F}{h_F}\\,[u]\\,[v],\n$$\n即，省略含 $\\{\\kappa \\nabla v\\}$ 的项。Dirichlet 边界面 $F \\in \\mathcal{F}_h^{\\mathrm{D}}$:\n$$\na_F(u,v) \\;=\\; -\\int_F \\kappa \\nabla u \\cdot \\boldsymbol{n}\\, v \\;+\\; \\int_F \\frac{\\eta_F}{h_F}\\, u\\, v,\n\\qquad\n\\ell_F(v) \\;=\\; \\int_F \\frac{\\eta_F}{h_F}\\, g\\, v.\n$$\n\nD. 内部面 $F \\in \\mathcal{F}_h^{\\mathrm{int}}$:\n$$\na_F(u,v) \\;=\\; -\\int_F \\{\\kappa \\nabla u\\}\\cdot \\boldsymbol{n}_F \\,[v] \\;-\\; \\int_F \\{\\kappa \\nabla v\\}\\cdot \\boldsymbol{n}_F \\,[u] \\;+\\; \\int_F \\eta_F\\, h_F\\,[u]\\,[v],\n$$\n即，用 $h_F$ 而不是 $h_F^{-1}$ 来缩放罚项。Dirichlet 边界面 $F \\in \\mathcal{F}_h^{\\mathrm{D}}$:\n$$\na_F(u,v) \\;=\\; \\int_F \\kappa \\nabla u \\cdot \\boldsymbol{n}\\, v \\;+\\; \\int_F \\kappa \\nabla v \\cdot \\boldsymbol{n}\\, u \\;+\\; \\int_F \\eta_F\\, h_F\\, u\\, v,\n\\qquad\n\\ell_F(v) \\;=\\; \\int_F \\eta_F\\, h_F\\, g\\, v \\;+\\; \\int_F \\kappa \\nabla v \\cdot \\boldsymbol{n}\\, g.\n$$\n\n根据所述约定和要求，选择正确的选项（可能有一个或多个正确答案）。", "solution": "任务是为标量扩散问题确定间断 Galerkin 方法的面贡献的正确格式。要求的性质是该格式方向无关、对称且伴随一致。该方法在内部面上应为对称内部罚 Galerkin (SIPG) 方法，在 Dirichlet 边界条件上应为对称 Nitsche 方法。\n\n首先，我们从第一性原理推导正确的格式。\n\n起点是网格 $\\mathcal{T}_h$ 中每个单元 $K$ 上的弱形式。我们将偏微分方程 $-\\nabla \\cdot (\\kappa \\nabla u) = f$ 乘以一个测试函数 $v \\in V_h$ 并在 $K$ 上积分：\n$$\n-\\int_K (\\nabla \\cdot (\\kappa \\nabla u)) v \\, d\\boldsymbol{x} = \\int_K f v \\, d\\boldsymbol{x}\n$$\n对左手边应用分部积分（Green 第一恒等式）可得：\n$$\n\\int_K \\kappa \\nabla u \\cdot \\nabla v \\, d\\boldsymbol{x} - \\int_{\\partial K} (\\kappa \\nabla u \\cdot \\boldsymbol{n}_K) v \\, ds = \\int_K f v \\, d\\boldsymbol{x}\n$$\n其中 $\\boldsymbol{n}_K$ 是单元 $K$ 边界 $\\partial K$ 的外单位法向量。\n\n对所有单元 $K \\in \\mathcal{T}_h$ 求和，得到全局格式：\n$$\n\\sum_{K \\in \\mathcal{T}_h} \\int_K \\kappa \\nabla u \\cdot \\nabla v \\, d\\boldsymbol{x} - \\sum_{K \\in \\mathcal{T}_h} \\int_{\\partial K} (\\kappa \\nabla u \\cdot \\boldsymbol{n}_K) v \\, ds = \\int_\\Omega f v \\, d\\boldsymbol{x}\n$$\n单元边界上的积分可以分解为来自内部面 $\\mathcal{F}_h^{\\mathrm{int}}$ 和边界面 $\\mathcal{F}_h^{\\mathrm{D}}$ 的贡献。这就是引入 DG 方法数值通量的地方。\n\n**内部面 ($F \\in \\mathcal{F}_h^{\\mathrm{int}}$)**\n\n对于由两个单元 $K_L$ 和 $K_R$ 共享的内部面 $F$，对单元边界的求和包含两项。根据给定一个从 $K_L$ 指向 $K_R$ 的固定法向 $\\boldsymbol{n}_F$ 的约定，$K_L$ 的外法向量是 $\\boldsymbol{n}_{L,F} = \\boldsymbol{n}_F$，$K_R$ 的外法向量是 $\\boldsymbol{n}_{R,F} = -\\boldsymbol{n}_F$。$F$ 上的边界积分变为：\n$$\n\\int_F (\\kappa \\nabla u_L \\cdot \\boldsymbol{n}_{L,F}) v_L \\, ds + \\int_F (\\kappa \\nabla u_R \\cdot \\boldsymbol{n}_{R,F}) v_R \\, ds = \\int_F ((\\kappa \\nabla u_L \\cdot \\boldsymbol{n}_F) v_L - (\\kappa \\nabla u_R \\cdot \\boldsymbol{n}_F) v_R) \\, ds\n$$\n使用跳跃 $[w] := w_L - w_R$ 和平均 $\\{\\boldsymbol{\\phi}\\} := \\frac{1}{2}(\\boldsymbol{\\phi}_L + \\boldsymbol{\\phi}_R)$ 的定义，以及恒等式 $[ab] = \\{a\\}[b] + [a]\\{b\\}$，被积函数可以写成 $[(\\kappa \\nabla u \\cdot \\boldsymbol{n}_F) v] = \\{\\kappa \\nabla u \\cdot \\boldsymbol{n}_F\\}[v] + [\\kappa \\nabla u \\cdot \\boldsymbol{n}_F]\\{v\\}$。对于精确解 $u$，通量是连续的，即 $[\\kappa \\nabla u \\cdot \\boldsymbol{n}_F] = 0$。因此，对于精确解，分部积分得到的边界项简化为 $\\sum_{F \\in \\mathcal{F}_h^{\\mathrm{int}}} \\int_F \\{\\kappa \\nabla u \\cdot \\boldsymbol{n}_F\\}[v] \\, ds$。\n\n间断 Galerkin 格式用数值通量项替换了分部积分中的边界项。为了伴随一致性，精确解的格式必须恢复原始弱形式。项 $-\\int_F \\{\\kappa \\nabla u \\cdot \\boldsymbol{n}_F\\}[v]$ 是一致性项。\n\n对于必须对称的 SIPG 方法，我们必须加上相应的“伴随”项，该项通过交换 $u$ 和 $v$ 得到：$-\\int_F \\{\\kappa \\nabla v \\cdot \\boldsymbol{n}_F\\}[u]$。\n最后，为确保稳定性（矫顽性），添加一个罚项，该项惩罚解的跳跃：$+\\int_F \\frac{\\eta_F}{h_F} [u][v]$。该项是对称的，并且对于精确解（其中 $[u]=0$）为零，从而保持一致性。\n\n结合这些，得到内部面 $F$ 的 SIPG 双线性形式：\n$$\na_F(u,v) = -\\int_F \\{\\kappa \\nabla u\\}\\cdot \\boldsymbol{n}_F \\,[v] - \\int_F \\{\\kappa \\nabla v\\}\\cdot \\boldsymbol{n}_F \\,[u] + \\int_F \\frac{\\eta_F}{h_F}\\,[u]\\,[v]\n$$\n该形式根据构造是对称的。我们必须验证其方向无关性。如果我们反转法向，$\\boldsymbol{n}_F \\to -\\boldsymbol{n}_F$，标签 $L$ 和 $R$ 会互换。这意味着 $[w] \\to -[w]$ 且 $\\{\\boldsymbol{\\phi}\\} \\to \\{\\boldsymbol{\\phi}\\}$。\n第一项变为 $-\\int_F \\{\\kappa \\nabla u\\}\\cdot (-\\boldsymbol{n}_F) \\,(-[v]) = -\\int_F \\{\\kappa \\nabla u\\}\\cdot \\boldsymbol{n}_F \\,[v]$。\n第二项同样是不变的。\n第三项变为 $\\int_F \\frac{\\eta_F}{h_F} (-[u])(-[v]) = \\int_F \\frac{\\eta_F}{h_F} [u][v]$。\n所有项都是不变的。因此，该格式是方向无关的。\n\n**Dirichlet 边界面 ($F \\in \\mathcal{F}_h^{\\mathrm{D}}$)**\n\nNitsche 方法弱形式地施加边界条件 $u=g$。我们需要一个对称、伴随一致的格式。起点是分部积分得到的边界项 $-\\int_F (\\kappa \\nabla u \\cdot \\boldsymbol{n}) v \\, ds$，其中 $\\boldsymbol{n}$ 是指向 $\\Omega$ 外部的单位法向量。\n\n1.  **一致性项**：项 $-\\int_F (\\kappa \\nabla u \\cdot \\boldsymbol{n}) v$ 被包括进来以确保与原始偏微分方程的一致性。\n2.  **对称性项**：为了使格式对称，我们添加伴随项 $-\\int_F (\\kappa \\nabla v \\cdot \\boldsymbol{n}) u$。\n3.  **罚项**：为了稳定性，添加一个罚项 $+\\int_F \\frac{\\eta_F}{h_F} u v$。\n\n结合这些，来自边界面贡献的双线性形式是：\n$$\na_F(u,v) = -\\int_F \\kappa \\nabla u \\cdot \\boldsymbol{n}\\, v - \\int_F \\kappa \\nabla v \\cdot \\boldsymbol{n}\\, u + \\int_F \\frac{\\eta_F}{h_F}\\, u\\, v\n$$\n该形式根据构造是对称的。线性形式 $\\ell_F(v)$ 源于并入边界数据 $g$。在完整格式的对称项和罚项中，我们将试探函数 $u$ 替换为给定的数据 $g$。相应的项然后被移到最终方程 $a_h(u,v) = \\ell_h(v)$ 的右边。\n方程的完整边界面贡献是：\n$-\\int_F \\kappa \\nabla u \\cdot \\boldsymbol{n}\\, v - \\int_F \\kappa \\nabla v \\cdot \\boldsymbol{n}\\, g + \\int_F \\frac{\\eta_F}{h_F}(u-g)v$。\n展开此式: $-\\int_F \\kappa \\nabla u \\cdot \\boldsymbol{n}\\, v - \\int_F \\kappa \\nabla v \\cdot \\boldsymbol{n}\\, g + \\int_F \\frac{\\eta_F}{h_F}u v - \\int_F \\frac{\\eta_F}{h_F}g v$。\n$u$ 的线性项构成 $a_F(u,v)$。只涉及数据 ($g$) 和测试函数 ($v$) 的项构成 $-\\ell_F(v)$。\n因此，线性形式是：\n$$\n\\ell_F(v) = \\int_F \\kappa \\nabla v \\cdot \\boldsymbol{n}\\, g - \\int_F \\frac{\\eta_F}{h_F} g v\n$$\n等等，我的推导给出了一个不同的符号。让我通过添加一个对于精确解为零的项来重新推导，这是一种更稳健的方法。\n从精确解 $u$ 的一致性方程开始：\n$\\sum_K \\int_K \\kappa \\nabla u \\cdot \\nabla v - \\sum_{F \\in \\mathcal{F}_h^{\\mathrm{int}}} \\int_F \\{\\kappa \\nabla u \\cdot \\boldsymbol{n}_F\\}[v] - \\sum_{F \\in \\mathcal{F}_h^{\\mathrm{D}}} \\int_F (\\kappa \\nabla u \\cdot \\boldsymbol{n})v = \\int_\\Omega f v$。\n我们加上以下项，这些项对于精确解 $u$（因为在 $\\Gamma_D$ 上 $u=g$）求和为零：\n$0 = \\sum_{F \\in \\mathcal{F}_h^{\\mathrm{D}}} \\left( -\\int_F \\kappa \\nabla v \\cdot \\boldsymbol{n}(u-g) + \\int_F \\frac{\\eta_F}{h_F}(u-g)v \\right)$。\n将此加到一致性方程中，我们可以识别出 $a_h(u,v)$ 和 $\\ell_h(v)$。\n含有试探函数 $u$ 的项是：\n$$\na_F(u,v) = -\\int_F \\kappa \\nabla u \\cdot \\boldsymbol{n}\\, v - \\int_F \\kappa \\nabla v \\cdot \\boldsymbol{n}\\, u + \\int_F \\frac{\\eta_F}{h_F}\\, u\\, v\n$$\n含有数据 $g$ 的项是：\n$$\n+\\int_F \\kappa \\nabla v \\cdot \\boldsymbol{n}\\, g - \\int_F \\frac{\\eta_F}{h_F} gv\n$$\n这些项移到右边时，构成 $\\ell_F(v)$。符号会改变：\n$$\n\\ell_F(v) = -\\int_F \\kappa \\nabla v \\cdot \\boldsymbol{n}\\, g + \\int_F \\frac{\\eta_F}{h_F} gv\n$$\n$a_F(u,v)$ 和 $\\ell_F(v)$ 的这个格式是标准的对称 Nitsche 方法。\n\n现在我们评估给定的选项。\n\n**选项 A:**\n-   **内部面:** $a_F(u,v) = -\\int_F \\{\\kappa \\nabla u\\}\\cdot \\boldsymbol{n}_F \\,[v] - \\int_F \\{\\kappa \\nabla v\\}\\cdot \\boldsymbol{n}_F \\,[u] + \\int_F \\frac{\\eta_F}{h_F}\\,[u]\\,[v]$。这与我们推导的 SIPG 格式相匹配，该格式是对称、方向无关且伴随一致的。\n-   **Dirichlet 边界面:**\n    $a_F(u,v) = -\\int_F \\kappa \\nabla u \\cdot \\boldsymbol{n}\\, v - \\int_F \\kappa \\nabla v \\cdot \\boldsymbol{n}\\, u + \\int_F \\frac{\\eta_F}{h_F}\\, u\\, v$。这与我们推导的对称 Nitsche 双线性形式相匹配。\n    $\\ell_F(v) = \\int_F \\frac{\\eta_F}{h_F}\\, g\\, v - \\int_F \\kappa \\nabla v \\cdot \\boldsymbol{n}\\, g$。这也与我们推导的线性形式相匹配。\n此选项中的所有形式都是正确的。\n结论：**正确**。\n\n**选项 B:**\n-   **内部面:** 该格式使用 $\\{\\kappa \\nabla u \\cdot \\boldsymbol{n}_{\\mathrm{out}}\\} := \\tfrac{1}{2}\\big(\\kappa_L \\nabla u_L \\cdot \\boldsymbol{n}_{L\\!,F} + \\kappa_R \\nabla u_R \\cdot \\boldsymbol{n}_{R\\!,F}\\big)$。当 $\\boldsymbol{n}_{L\\!,F}=\\boldsymbol{n}_F$ 和 $\\boldsymbol{n}_{R\\!,F}=-\\boldsymbol{n}_F$ 时，这变为 $\\tfrac{1}{2}(\\kappa_L \\nabla u_L - \\kappa_R \\nabla u_R) \\cdot \\boldsymbol{n}_F = \\tfrac{1}{2}[\\kappa \\nabla u]\\cdot\\boldsymbol{n}_F$。对于精确解，通量是连续的，所以 $[\\kappa \\nabla u \\cdot \\boldsymbol{n}_F]=0$。该项将为零，但是一致性项需要通量的平均值 $\\{\\kappa \\nabla u \\cdot \\boldsymbol{n}_F\\}$，而它不为零。因此，该格式不是伴随一致的。\n结论：**不正确**。\n\n**选项 C:**\n-   **内部面:** $a_F(u,v) = -\\int_F \\{\\kappa \\nabla u\\}\\cdot \\boldsymbol{n}_F \\,[v] + \\int_F \\frac{\\eta_F}{h_F}\\,[u]\\,[v]$。该形式缺少对称化项 $-\\int_F \\{\\kappa \\nabla v\\}\\cdot \\boldsymbol{n}_F \\,[u]$，因此不是对称的。这对应于 NIPG (非对称内部罚 Galerkin) 方法。问题要求一个对称的方法。\n-   **Dirichlet 边界面:** 双线性形式 $a_F(u,v)$ 同样缺少其对称化项。它不是对称的。\n结论：**不正确**。\n\n**选项 D:**\n-   **内部面:** 罚项被给出为 $\\int_F \\eta_F\\, h_F\\,[u]\\,[v]$。缩放因子是 $h_F$，而不是正确的 $h_F^{-1}$。对于二阶椭圆问题，罚项必须与面直径的倒数成比例，以平衡梯度项并确保稳定性（以及最优收敛率）。这种缩放是不正确的。\n-   **Dirichlet 边界面:** $a_F(u,v)$ 中的一致性项和对称性项的符号为正，这是不正确的，并违反了一致性。罚项也具有错误的缩放 $h_F$。线性形式 $\\ell_F(v)$ 也有不正确的符号。\n结论：**不正确**。\n\n基于详细分析，只有选项 A 提供了满足所有规定要求的正确格式。", "answer": "$$\\boxed{A}$$", "id": "2569501"}, {"introduction": "在构建了 DG 方法的离散格式后，我们将得到一个全局线性方程组。本练习深入探讨了由 SIPG 离散化产生的全局刚度矩阵的性质，特别是罚参数 $\\eta$ 与矩阵关键特性（如对称性、矫顽性及条件数）之间的内在联系。理解这些特性对于理论分析和成功的实际应用都至关重要，因为它能指导我们选择合适的线性求解器并帮助诊断稳定性问题。[@problem_id:2596888]", "problem": "考虑在一个有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^d$ 上的 Poisson 偏微分方程 (PDE) $-\\Delta u = f$，其边界 $\\partial\\Omega$ 上具有齐次 Dirichlet 边界条件 $u=0$。设 $\\mathcal{T}_h$ 是将 $\\Omega$ 剖分为单纯形或平行多面体的形状规则网格，并设 $V_h$ 是定义在 $\\mathcal{T}_h$ 上的分片多项式间断有限元空间。记 $\\mathcal{E}_h^{\\mathrm{int}}$ 为内部面集合，$\\mathcal{E}_h^{\\partial}$ 为边界面集合。对于一个由单元 $K$ 和 $L$ 共享的内部面 $e \\in \\mathcal{E}_h^{\\mathrm{int}}$，设 $\\mathbf{n}_K$ 和 $\\mathbf{n}_L$ 分别是 $e$ 上相对于 $K$ 和 $L$ 的单位外法向量。对于一个标量场 $w$，定义其在 $e$ 上的跳跃和平均为 $[w] := w|_K \\,\\mathbf{n}_K + w|_L \\,\\mathbf{n}_L$ 和 $\\{\\nabla w\\} := \\tfrac{1}{2}\\left(\\nabla w|_K + \\nabla w|_L\\right)$。在 $e \\in \\mathcal{E}_h^{\\partial}$ 上，定义 $[w] := w \\,\\mathbf{n}$ 和 $\\{\\nabla w\\} := \\nabla w$，其中 $\\mathbf{n}$ 是 $\\partial\\Omega$ 的单位外法向量。考虑间断伽辽金 (DG) 框架下的对称内部罚分片伽辽金 (SIPG) 离散格式，其中逐面罚参数为 $\\eta_e > 0$，特征面尺寸为 $h_e$。离散解 $u_h \\in V_h$ 由一个通过在单元和面上组装的对称双线性形式以及一个关于 $f$ 的线性泛函定义。\n\n下列哪个陈述正确地描述了组装的全局矩阵的结构以及罚参数 $\\eta_e$ 对对称性和条件数的影响？\n\nA. 组装的全局刚度矩阵是块对称和稀疏的，非零耦合仅存在于共享一个面（包括边界面）的单元所关联的自由度之间。其块是单元上的体积贡献 $\\int_K \\nabla \\varphi_i \\cdot \\nabla \\varphi_j \\, \\mathrm{d}x$ 和来自两类项的面贡献之和：耦合跨面迹的对称相容性项，以及作用于跳跃项的、形如 $\\int_e (\\eta_e/h_e) \\, \\varphi_i \\, \\varphi_j \\, \\mathrm{d}s$ 的内部罚项。增加 $\\eta_e$ 会保持对称性不变，但会恶化谱条件，最大特征值与 $\\eta_e/h_e$ 成比例增长，而将 $\\eta_e$ 取值过小则会破坏矫顽性和正定性。\n\nB. SIPG 全局矩阵通常是非对称的，除非在每个面上 $\\eta_e = 1$；只有将罚参数调整为 $\\eta_e = 1$ 才能恢复对称性。\n\nC. 选择非常大的 $\\eta_e$ 总能改善条件数，因为它增加了对角占优性；当 $\\eta_e \\to \\infty$ 时，条件数减小，系统变得更容易求解。\n\nD. 为了保持矫顽性，罚项在每个面上的尺度必须是 $\\eta_e \\, h_e$ 而非 $\\eta_e/h_e$；使用 $\\eta_e/h_e$ 会导致矩阵在 $h_e \\to 0$ 时变得奇异，无论 $\\eta_e$ 的大小如何。", "solution": "该问题要求评估由 Poisson 方程的对称内部罚分片伽辽金 (SIPG) 离散化得到的全局刚度矩阵的性质。该偏微分方程为 $-\\Delta u = f$，定义在域 $\\Omega$ 上，并在边界 $\\partial\\Omega$ 上有 $u=0$。\n\nSIPG 方法在间断有限元空间 $V_h$ 中寻找一个解 $u_h$，该解由对所有 $v_h \\in V_h$ 成立的变分问题 $a_h(u_h, v_h) = \\ell(v_h)$ 定义。此处，$\\ell(v_h) = \\int_\\Omega f v_h \\, \\mathrm{d}x$。双线性形式 $a_h(\\cdot, \\cdot)$ 是本问题的核心。根据所给定义，其表达式为：\n$$\na_h(u_h, v_h) = \\sum_{K \\in \\mathcal{T}_h} \\int_K \\nabla u_h \\cdot \\nabla v_h \\, d\\mathbf{x} - \\sum_{e \\in \\mathcal{E}_h} \\int_e \\left( \\{\\nabla u_h\\} \\cdot [v_h] + \\{\\nabla v_h\\} \\cdot [u_h] \\right) dS + \\sum_{e \\in \\mathcal{E}_h} \\int_e \\frac{\\eta_e}{h_e} [u_h] \\cdot [v_h] dS\n$$\n其中 $\\mathcal{E}_h$ 是所有内部面和边界面的集合。全局刚度矩阵 $A$ 由该双线性形式组装而成，其元素为 $A_{ij} = a_h(\\varphi_j, \\varphi_i)$，其中 $\\{\\varphi_i\\}$ 是 $V_h$ 的基。\n\n我们来分析该矩阵的性质并评估每个选项。\n\n**矩阵结构：稀疏性与对称性**\n间断伽辽金空间 $V_h$ 的基函数 $\\varphi_i$ 具有局部支集，通常局限于单个单元 $K_i$。\n1.  体积积分 $\\sum_K \\int_K \\nabla \\varphi_i \\cdot \\nabla \\varphi_j \\, d\\mathbf{x}$ 仅当 $\\varphi_i$ 和 $\\varphi_j$ 的支集是同一单元时才非零，即 $K_i = K_j$。该项贡献于按单元分块的全局矩阵的对角块。\n2.  面积分是在网格的骨架 $\\mathcal{E}_h$ 上进行的。涉及 $\\varphi_i$ 和 $\\varphi_j$ 的面积分项仅当两个基函数在该面上的迹都非零时才非零。这发生在 $K_i = K_j$（贡献于对角块）或单元 $K_i$ 和 $K_j$ 是直接相邻、共享一个公共面（贡献于非对角块）时。\n因此，矩阵 $A$ 的非零元素仅存在于属于相同或相邻单元的自由度对之间。这使得矩阵是稀疏的。\n\n该方法的名称，“对称内部罚分片伽辽金”，已经表明了双线性形式的对称性。我们来验证这一点。\n- 项 $\\sum_K \\int_K \\nabla u_h \\cdot \\nabla v_h \\, d\\mathbf{x}$ 显然关于 $u_h$ 和 $v_h$ 是对称的。\n- 罚项 $\\sum_e \\int_e \\frac{\\eta_e}{h_e} [u_h] \\cdot [v_h] \\, dS$ 是对称的，因为点积是可交换的。\n- 相容性项 $-\\sum_e \\int_e ( \\{\\nabla u_h\\} \\cdot [v_h] + \\{\\nabla v_h\\} \\cdot [u_h] ) dS$ 的结构是 $C(u_h, v_h) + C(v_h, u_h)$，这是对称的。\n因此，对于 $V_h$ 中的任意 $u_h, v_h$，都有 $a_h(u_h, v_h) = a_h(v_h, u_h)$。这意味着全局刚度矩阵 $A$ 是对称的。这种对称性是该公式所固有的，不依赖于罚参数 $\\eta_e$ 的值。\n\n**罚参数 $\\eta_e$ 的作用**\n1.  **矫顽性与正定性**：双线性形式的矫顽性，即对于某个合适的范数和常数 $C > 0$ 满足 $a_h(v_h, v_h) \\ge C \\|v_h\\|_{DG}^2$，是线性系统唯一可解性的基础。在 SIPG 中，相容性项可能为负。罚项是正的，必须足够大以主导这些项。通过使用迹不等式，可以证明矫顽性成立的充分必要条件是：在每个面上选择的罚参数 $\\eta_e$ 足够大，即 $\\eta_e > \\eta_0$，其中 $\\eta_0 > 0$ 是一个依赖于多项式次数和网格形状规则性，但不依赖于网格尺寸 $h$ 的常数。如果 $\\eta_e$ 过小，矫顽性会丧失，矩阵 $A$ 不再保证是正定的，并可能奇异。\n\n2.  **谱条件**：矩阵 $A$ 的条件数是 $\\kappa(A) = \\lambda_{\\max}(A) / \\lambda_{\\min}(A)$。\n    -   最大特征值 $\\lambda_{\\max}(A)$ 与双线性形式的连续性常数有关。罚项 $\\frac{\\eta_e}{h_e}$ 对形式的大小有很大的贡献。标准分析表明，$\\lambda_{\\max}(A)$ 与 $\\max_e(\\eta_e/h_e)$ 成比例增长。\n    -   最小特征值 $\\lambda_{\\min}(A)$ 与矫顽性常数有关。对于一个足够大但固定的 $\\eta_e$，$\\lambda_{\\min}(A)$ 有一个远离零的正下界。\n    -   因此，随着 $\\eta_e$ 的增加，$\\lambda_{\\max}(A)$ 增加，而 $\\lambda_{\\min}(A)$ 通常趋于稳定。这导致条件数 $\\kappa(A)$ 增长，近似与 $\\eta_e$ 呈线性关系。一个非常大的罚参数会导致一个非常病态的系统，使其在数值上难以求解。\n\n现在我们基于此分析评估给出的选项。\n\n**A. 组装的全局刚度矩阵是块对称和稀疏的，非零耦合仅存在于共享一个面（包括边界面）的单元所关联的自由度之间。其块是单元上的体积贡献 $\\int_K \\nabla \\varphi_i \\cdot \\nabla \\varphi_j \\, \\mathrm{d}x$ 和来自两类项的面贡献之和：耦合跨面迹的对称相容性项，以及作用于跳跃项的、形如 $\\int_e (\\eta_e/h_e) \\, \\varphi_i \\, \\varphi_j \\, \\mathrm{d}s$ 的内部罚项。增加 $\\eta_e$ 会保持对称性不变，但会恶化谱条件，最大特征值与 $\\eta_e/h_e$ 成比例增长，而将 $\\eta_e$ 取值过小则会破坏矫顽性和正定性。**\n\n这个陈述提供了一个全面且准确的描述。该矩阵是稀疏和对称的（“块对称”这个术语在此上下文中是可以接受的，因为全局矩阵是对称的）。对各贡献项的描述在概念上是正确的，尽管记法 $\\int_e (\\eta_e/h_e) \\, \\varphi_i \\, \\varphi_j \\, \\mathrm{d}s$ 是对跳跃-跳跃项 $\\int_e (\\eta_e/h_e) \\, [\\varphi_i] \\cdot [\\varphi_j] \\, \\mathrm{d}s$ 的简化。短语“作用于跳跃项”澄清了其意图。最重要的是，该陈述的后半部分正确地描述了罚参数 $\\eta_e$ 的影响：对称性不受其值影响，大的 $\\eta_e$ 会恶化条件数，而小的 $\\eta_e$ 则有失去矫顽性的风险。\n结论：**正确**。\n\n**B. SIPG 全局矩阵通常是非对称的，除非在每个面上 $\\eta_e = 1$；只有将罚参数调整为 $\\eta_e = 1$ 才能恢复对称性。**\n\n这个陈述是根本错误的。SIPG 的双线性形式被构造为对于任何正罚参数 $\\eta_e > 0$ 都是对称的。对称性是该方法的一个决定性特征。其他的 DG 变体，如 NIPG (非对称 IPG)，会导致非对称矩阵，但 SIPG 总是对称的。\n结论：**错误**。\n\n**C. 选择非常大的 $\\eta_e$ 总能改善条件数，因为它增加了对角占优性；当 $\\eta_e \\to \\infty$ 时，条件数减小，系统变得更容易求解。**\n\n这个陈述与事实恰恰相反。如前所述，增加 $\\eta_e$会增加刚度矩阵的最大特征值，从而恶化条件数。虽然罚项确实增加了某些矩阵元素的大小，但它并不能改善条件数。极限 $\\eta_e \\to \\infty$ 对应于一个严重病态的系统。\n结论：**错误**。\n\n**D. 为了保持矫顽性，罚项在每个面上的尺度必须是 $\\eta_e \\, h_e$ 而非 $\\eta_e/h_e$；使用 $\\eta_e/h_e$ 会导致矩阵在 $h_e \\to 0$ 时变得奇异，无论 $\\eta_e$ 的大小如何。**\n\n这个陈述给出了一个错误的罚项尺度。在涉及迹不等式和逆不等式的矫顽性证明中，能平衡各项的正确尺度是 $\\eta_e/h_e$。量纲分析也证实了这一点：双线性形式中的所有项必须具有相同的物理单位，对于 Poisson 方程，只有罚参数与 $1/h_e$ 成比例的尺度才能实现这一点。只要 $\\eta_e$ 足够大，尺度 $\\eta_e/h_e$ 正是确保在网格加密 ($h_e \\to 0$) 时稳定性（矫顽性）一致所需的。\n结论：**错误**。", "answer": "$$\\boxed{A}$$", "id": "2596888"}, {"introduction": "在罚方法中，选择一个合适的罚参数是一个经典难题：参数太小会导致不稳定，太大则会损害精度和条件数。本练习超越了静态罚参数的范畴，引入了一种动态的自适应策略。您将通过编程实现一个算法，该算法能基于后验误差指标（特别是平衡通量残差）来局部调整罚参数，从而将理论与高级计算实践联系起来，并为提升 DG 方法在复杂问题中的性能提供了具体方案。[@problem_id:2569500]", "problem": "您的任务是设计并实现一个算法，以基于平衡通量信息，自适应调整用于间断 Galerkin (dG) 方法的对称内部罚 (SIP) 参数以及用于 Nitsche 方法的边界罚参数。考虑在区域 $\\Omega \\subset \\mathbb{R}^d$ 上的一个标量扩散模型问题，其扩散系数为 $\\kappa(\\boldsymbol{x})$，定义在形状正则的网格 $\\mathcal{T}_h$ 上，网格骨架为 $\\mathcal{E}_h$。对于一个内部面 $e \\in \\mathcal{E}_h$，令 $h_e$ 表示其代表性尺寸，$p_e$ 为相邻单元上的局部多项式次数，并根据标准约定定义算术跳跃和平均。对于 SIP 方法，罚项以如下形式出现\n$$\n\\sum_{e \\in \\mathcal{E}_h} \\int_e \\sigma_e \\frac{\\kappa_e}{h_e} \\, [[u_h]] \\, [[v_h]] \\, \\mathrm{d}s,\n$$\n其中 $\\sigma_e$ 是一个无量纲稳定化参数，$\\kappa_e$ 是一个有效面扩散系数。对于 Dirichlet 边界上的 Nitsche 边界耦合，使用了一个类似的罚项 $\\int_{\\partial \\Omega_D} \\sigma_e \\frac{\\kappa_e}{h_e} \\, u_h \\, v_h \\, \\mathrm{d}s$。\n\n基本出发点是：\n- 形状正则网格上的离散迹不等式：存在一个与面相关的常数 $C_{\\mathrm{tr}}$，使得对于单元 $K$ 上的任意一个次数为 $p_e$ 的多项式 $v_h$（其中面 $e \\subset \\partial K$），有\n$$\n\\| v_h \\|_{L^2(e)}^2 \\le C_{\\mathrm{tr}} \\frac{(p_e + 1)^2}{h_e} \\, \\| v_h \\|_{L^2(K)}^2.\n$$\n- 当罚项被缩放为 $\\sigma_e \\frac{\\kappa_e}{h_e}$ 时，在不考虑普适的形状正则性常数和维度相关因子的前提下，如果满足以下条件，SIP 形式的矫顽性便可得到保证：\n$$\n\\sigma_e \\ge C_{\\mathrm{tr}} (p_e + 1)^2,\n$$\n- 平衡通量 $\\hat{\\boldsymbol{q}} \\in H(\\mathrm{div};\\Omega)$ 是一个经过后处理的通量场，它在单元上局部守恒，并与数值解一致。其逐面的法向跳跃提供了一种稳健的残差度量。对于具有单位法向量 $\\boldsymbol{n}_e$ 的内部面 $e$，定义通量残差大小为 $r_e := \\| [[ \\hat{\\boldsymbol{q}} \\cdot \\boldsymbol{n}_e ]] \\|_{L^2(e)}$。对于 Dirichlet 边界面 $e \\subset \\partial \\Omega_D$，定义 $r_e := \\| \\hat{\\boldsymbol{q}} \\cdot \\boldsymbol{n} - t_e \\|_{L^2(e)}$，其中 $t_e$ 是目标边界牵引力，此处通过数值方式提供。令 $j_e := \\| [[u_h]] \\|_{L^2(e)}$ 表示内部面上的解跳跃，$j_e := \\| u_h \\|_{L^2(e)}$ 表示 Dirichlet 边界面上的解。\n\n您必须从这些基础出发，为 $\\sigma_e$ 推导出一个量纲一致的自适应规则，该规则需保持矫顽性下界，并使 $\\sigma_e$ 的增长与一个归一化的通量不平衡量成正比。该自适应规则必须使用以下结构：\n- 对于内部面，令 $\\kappa_e$ 为相邻扩散系数的调和平均值，即\n$$\n\\kappa_e = \\frac{2 \\kappa^- \\kappa^+}{\\kappa^- + \\kappa^+},\n$$\n对于边界面，则设置 $\\kappa_e = \\kappa^-$。\n- 令最低稳定水平为\n$$\n\\sigma_{\\min,e} := C_{\\mathrm{tr}} (p_e + 1)^2.\n$$\n- 令归一化的不平衡量为\n$$\n\\phi_e := \\min \\left\\{ \\frac{h_e \\, r_e}{\\kappa_e \\, (j_e + \\delta)}, \\, \\phi_{\\max} \\right\\},\n$$\n其中有一个微小的正正则化项 $\\delta$ 用以防止除以零，以及一个上限 $\\phi_{\\max}$ 用以防止无界增长。\n- 令最终的自适应罚参数为\n$$\n\\sigma_e := \\sigma_{\\min,e} \\left( 1 + \\theta \\, \\phi_e \\right).\n$$\n\n您的程序必须使用给定的常数 $C_{\\mathrm{tr}} = 1$、$\\theta = 2.5$、$\\phi_{\\max} = 10$ 和 $\\delta = 10^{-12}$，为给定的测试套件计算 $\\sigma_e$。所有计算都是无量纲的纯数学计算，不涉及任何物理单位。\n\n测试套件：\n- 测试用例 $1$ (均匀扩散，中等残差，内部面)：\n  - 边由元组 $(h_e, p_e, \\kappa^-, \\kappa^+, r_e, j_e)$ 描述：\n    - $(0.25, 1, 1.0, 1.0, 0.02, 0.20)$，\n    - $(0.25, 1, 1.0, 1.0, 0.01, 0.15)$，\n    - $(0.25, 1, 1.0, 1.0, 0.005, 0.10)$。\n- 测试用例 $2$ (混合次数、网格尺寸和扩散对比度，内部面)：\n  - $(0.10, 2, 1.0, 1.0, 0.20, 0.05)$，\n  - $(0.10, 3, 5.0, 0.2, 0.05, 0.10)$，\n  - $(0.05, 1, 0.5, 0.5, 0.10, 0.01)$，\n  - $(0.20, 1, 1.0, 1.0, 0.00, 0.20)$。\n- 测试用例 $3$ (通过 Nitsche 方法处理的 Dirichlet 边界以及小尺寸内部面，高次数情况)：\n  - 对于 Dirichlet 边界面，通过将第二个扩散系数设置为 0 来表示；元组被解释为 $(h_e, p_e, \\kappa^-, 0, r_e, j_e)$：\n    - $(0.05, 2, 2.0, 0, 0.10, 0.00)$，\n  - 内部面：\n    - $(0.01, 1, 1.0, 1.0, 0.01, 0.05)$，\n    - $(0.20, 4, 10.0, 10.0, 0.20, 1.00)$。\n\n要求：\n- 实施上述指定的自适应公式，按所给顺序为每个测试用例计算罚参数 $\\sigma_e$ 列表。\n- 精确使用给定的常数 $C_{\\mathrm{tr}} = 1$、$\\theta = 2.5$、$\\phi_{\\max} = 10$ 和 $\\delta = 10^{-12}$。\n- 程序必须生成单行输出，其中包含结果，格式为一个用方括号括起来的逗号分隔列表。每个测试用例的结果是一个浮点数列表，四舍五入到六位小数。例如，输出格式必须类似于\n$[[\\sigma_{1,1}, \\sigma_{1,2}], [\\sigma_{2,1}], [\\sigma_{3,1}, \\sigma_{3,2}]]$\n，其中填充了四舍五入到六位小数的实际数值。", "solution": "所提出的问题是一个有效且适定的计算任务，其理论基础是偏微分方程的数值方法。该任务要求实现一个自适应算法，用于计算对称内部罚间断 Galerkin (SIP-dG) 方法以及施加 Dirichlet 边界条件的 Nitsche 方法中所使用的罚参数 $\\sigma_e$。所提供的公式在科学上是合理的、内部一致的，并包含获得唯一解所需的所有必要信息。我们将着手对该计算算法进行合理的推导。\n\n目标是为有限元网格中的一组面（或在 $\\mathbb{R}^2$ 中的边）计算稳定化参数 $\\sigma_e$。此参数对于确保离散问题的稳定性（或更形式化地说，矫顽性）至关重要。该自适应策略旨在根据解质量的局部指标（特别是后处理数值通量的不平衡量）来调整 $\\sigma_e$。\n\n罚参数设计的基础在于离散迹不等式，该不等式对于一个单元 $K$ 及其面 $e$ 表明：\n$$\n\\| v_h \\|_{L^2(e)}^2 \\le C_{\\mathrm{tr}} \\frac{(p_e + 1)^2}{h_e} \\, \\| v_h \\|_{L^2(K)}^2\n$$\n其中 $v_h$ 是一个次数为 $p_e$ 的多项式，$h_e$ 是面尺寸，$C_{\\mathrm{tr}}$ 是一个取决于单元形状正则性的常数。为保证 SIP-dG 双线性形式的矫顽性，罚参数 $\\sigma_e$ 必须足够大，以控制由解跨面跳跃产生的项。这导出条件 $\\sigma_e \\ge C_{\\mathrm{tr}} (p_e + 1)^2$。因此，问题定义了一个最小允许罚参数：\n$$\n\\sigma_{\\min,e} := C_{\\mathrm{tr}} (p_e + 1)^2\n$$\n这可作为确保理论稳定性的基线。对于给定的问题，$C_{\\mathrm{tr}} = 1$，因此 $\\sigma_{\\min,e} = (p_e + 1)^2$。\n\n自适应算法的核心是根据局部数值误差来增强此基线罚参数。这类误差的一种稳健度量由平衡通量 $\\hat{\\boldsymbol{q}}$ 提供，它是一个满足局部守恒性质的后处理向量场。该通量法向分量穿过内部面 $e$ 的跳跃大小，记为 $r_e = \\| [[ \\hat{\\boldsymbol{q}} \\cdot \\boldsymbol{n}_e ]] \\|_{L^2(e)}$，量化了局部的通量不平衡。较大的 $r_e$ 表明局部近似较差。\n\n为了使该指标可用于自适应调整 $\\sigma_e$，必须将其无量纲化并进行适当缩放。所提出的自适应规则引入了一个归一化的不平衡指标 $\\phi_e$。该指标将通量残差 $r_e$ 与同一面上的解跳跃 $j_e = \\| [[u_h]] \\|_{L^2(e)}$ 联系起来。其公式为：\n$$\n\\phi_e := \\min \\left\\{ \\frac{h_e \\, r_e}{\\kappa_e \\, (j_e + \\delta)}, \\, \\phi_{\\max} \\right\\}\n$$\n此处，$\\kappa_e$ 是面上的有效扩散系数，它适当地缩放通量残差与解跳跃的比值。项 $h_e / \\kappa_e$ 确保该比率是无量纲的，因为在积分意义上，$r_e$ 的单位近似为 $[\\kappa][u]/[L]$，而 $j_e$ 的单位是 $[u]$。微小的正则化参数 $\\delta > 0$ 可防止在解跳跃 $j_e$ 接近零时发生除以零的情况。参数 $\\phi_{\\max}$ 提供了一个上限（或封顶值），以防止罚参数 $\\sigma_e$ 变得过大，从而避免恶化全局系统矩阵的条件数。\n\n最后，通过使用此不平衡指标增强最小罚参数 $\\sigma_{\\min,e}$ 来构造自适应罚参数 $\\sigma_e$：\n$$\n\\sigma_e := \\sigma_{\\min,e} \\left( 1 + \\theta \\, \\phi_e \\right)\n$$\n参数 $\\theta$ 控制自适应响应的强度。$\\theta=0$ 的值将恢复到最小的非自适应罚。正的 $\\theta$ 会在高通量不平衡区域增强稳定性。\n\n对于每个具有给定参数 $(h_e, p_e, \\kappa^-, \\kappa^+, r_e, j_e)$ 的面 $e$，使用指定的常数 $C_{\\mathrm{tr}} = 1$、$\\theta = 2.5$、$\\phi_{\\max} = 10$ 和 $\\delta = 10^{-12}$，其计算步骤如下：\n\n1.  **计算有效扩散系数 $\\kappa_e$**：\n    -   对于内部面，其中相邻单元的扩散系数为 $\\kappa^-$ 和 $\\kappa^+$，使用调和平均值：$\\kappa_e = \\frac{2 \\kappa^- \\kappa^+}{\\kappa^- + \\kappa^+}$。这是为了精确捕捉两种不同介质间的有效传导率的标准选择。\n    -   对于由 $\\kappa^+=0$ 表示的边界面，该参数取自单个相邻单元：$\\kappa_e = \\kappa^-$。\n\n2.  **计算最小罚参数 $\\sigma_{\\min,e}$**：\n    -   使用局部多项式次数 $p_e$ 和 $C_{\\mathrm{tr}} = 1$，计算 $\\sigma_{\\min,e} = (p_e + 1)^2$。\n\n3.  **计算归一化的不平衡量 $\\phi_e$**：\n    -   计算比率 $\\frac{h_e \\, r_e}{\\kappa_e \\, (j_e + \\delta)}$。\n    -   应用上限：$\\phi_e = \\min\\left(\\frac{h_e \\, r_e}{\\kappa_e \\, (j_e + \\delta)}, \\phi_{\\max}\\right)$。\n\n4.  **计算最终自适应罚参数 $\\sigma_e$**：\n    -   组合以上分量：$\\sigma_e = \\sigma_{\\min,e} (1 + \\theta \\, \\phi_e)$。\n\n该算法将应用于测试套件中指定的每个面，以生成所需的数值结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the adaptive penalty parameter sigma_e for a suite of test cases\n    based on the provided formulation for discontinuous Galerkin and Nitsche methods.\n    \"\"\"\n\n    # Constants provided in the problem statement.\n    C_TR = 1.0\n    THETA = 2.5\n    PHI_MAX = 10.0\n    DELTA = 1e-12\n\n    # Test suite defined in the problem.\n    test_cases = [\n        # Test case 1 (uniform diffusion, moderate residuals, interior faces)\n        [\n            (0.25, 1, 1.0, 1.0, 0.02, 0.20),\n            (0.25, 1, 1.0, 1.0, 0.01, 0.15),\n            (0.25, 1, 1.0, 1.0, 0.005, 0.10)\n        ],\n        # Test case 2 (mixed degrees, mesh sizes, and diffusion contrast, interior faces)\n        [\n            (0.10, 2, 1.0, 1.0, 0.20, 0.05),\n            (0.10, 3, 5.0, 0.2, 0.05, 0.10),\n            (0.05, 1, 0.5, 0.5, 0.10, 0.01),\n            (0.20, 1, 1.0, 1.0, 0.00, 0.20)\n        ],\n        # Test case 3 (Dirichlet boundary, high-degree case)\n        [\n            (0.05, 2, 2.0, 0.0, 0.10, 0.00),  # Dirichlet boundary face\n            (0.01, 1, 1.0, 1.0, 0.01, 0.05),  # Interior face\n            (0.20, 4, 10.0, 10.0, 0.20, 1.00) # Interior face\n        ]\n    ]\n\n    def calculate_sigma_e(h_e, p_e, kappa_minus, kappa_plus, r_e, j_e):\n        \"\"\"\n        Calculates the adaptive penalty parameter sigma_e for a single face.\n        \n        Args:\n            h_e (float): Face size.\n            p_e (int): Local polynomial degree.\n            kappa_minus (float): Diffusion coefficient in one element.\n            kappa_plus (float): Diffusion coefficient in the other; 0 for boundary.\n            r_e (float): Flux residual norm.\n            j_e (float): Solution jump norm.\n            \n        Returns:\n            float: The calculated penalty parameter sigma_e.\n        \"\"\"\n        \n        # Step 1: Compute Effective Diffusion kappa_e\n        if kappa_plus == 0.0:  # Boundary face\n            kappa_e = kappa_minus\n        else:  # Interior face\n            # Harmonic mean, check for zero denominator though problem data avoids this.\n            if kappa_minus + kappa_plus == 0:\n                 kappa_e = 0\n            else:\n                 kappa_e = (2 * kappa_minus * kappa_plus) / (kappa_minus + kappa_plus)\n\n        # Step 2: Compute Minimum Penalty sigma_min_e\n        sigma_min_e = C_TR * (p_e + 1)**2\n\n        # Step 3: Compute Normalized Disequilibrium phi_e\n        denominator = kappa_e * (j_e + DELTA)\n        if denominator == 0:\n            # This case happens if kappa_e is zero. Assign large number to be capped by PHI_MAX.\n            raw_phi = float('inf')\n        else:\n            raw_phi = (h_e * r_e) / denominator\n        \n        phi_e = min(raw_phi, PHI_MAX)\n        \n        # Step 4: Compute Final Adaptive Penalty sigma_e\n        sigma_e = sigma_min_e * (1 + THETA * phi_e)\n        \n        return sigma_e\n\n    all_results = []\n    for case in test_cases:\n        case_results = []\n        for face_params in case:\n            sigma_e = calculate_sigma_e(*face_params)\n            case_results.append(sigma_e)\n        all_results.append(case_results)\n\n    # Format the output to six decimal places and the required string structure.\n    formatted_results = []\n    for case_res in all_results:\n        rounded_vals = [f\"{val:.6f}\" for val in case_res]\n        formatted_results.append(f'[{\",\".join(rounded_vals)}]')\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2569500"}]}