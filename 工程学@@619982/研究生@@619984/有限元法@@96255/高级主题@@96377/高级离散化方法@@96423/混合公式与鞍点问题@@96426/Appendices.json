{"hands_on_practices": [{"introduction": "本练习将带你深入探究混合方法稳定性的核心：inf-sup（或LBB）条件。通过在一个简单的一维问题中显式地计算该常数，你将具体理解试探函数空间和检验函数空间的选择如何直接决定问题的适定性。这个实践将帮助你从抽象的理论走向切实的计算，从而揭示稳定性的本质。[@problem_id:2577764]", "problem": "考虑一维域 $\\Omega=(0,1)$ 以及由下式定义的双线性形式 $b:V\\times Q\\to\\mathbb{R}$ 的混合提法\n$$\nb(v,q)=\\int_{0}^{1} v'(x)\\,q(x)\\,dx,\n$$\n其中 $V$ 和 $Q$ 为下文指定的希尔伯特空间，其范数由 $\\|v\\|_{V}=\\|v'\\|_{L^{2}(0,1)}$ 和 $\\|q\\|_{Q}=\\|q\\|_{L^{2}(0,1)}$ 给出。与 $b$ 相关联的 inf-sup 常数 $\\beta$ 定义为\n$$\n\\beta=\\inf_{q\\in Q\\setminus\\{0\\}}\\ \\sup_{v\\in V\\setminus\\{0\\}}\\ \\frac{b(v,q)}{\\|v\\|_{V}\\,\\|q\\|_{Q}}.\n$$\n假设主要设定为 $V=H_{0}^{1}(0,1)$ 和 $Q=L_{0}^{2}(0,1)$，其中 $H_{0}^{1}(0,1)$ 表示在 $x=0$ 和 $x=1$ 处迹为零的索博列夫空间，而 $L_{0}^{2}(0,1)$ 表示 $L^{2}(0,1)$ 中在 $(0,1)$ 上均值为零的函数构成的子空间。从索博列夫空间 $H^{1}(0,1)$ 的基本定义和柯西-施瓦茨不等式出发，计算此主要设定下 inf-sup 常数 $\\beta$ 的精确值。\n\n在您的解法中，请简要而严格地讨论在以下备选的边界和余定义域选择下，$\\beta$ 会如何变化（增大、减小或保持不变），并从第一性原理出发论证您的结论，而不使用任何现成的公式：\n- 情形 $\\mathrm{A}$：$V=H_{0}^{1}(0,1)$ 且 $Q=L^{2}(0,1)$。\n- 情形 $\\mathrm{B}$：$V=\\{v\\in H^{1}(0,1): v(0)=0\\}$ 且 $Q=L^{2}(0,1)$。\n\n您最终提交的答案必须是主要设定下 $\\beta$ 的精确值，表示为一个无单位的单个实数。", "solution": "本问题在于计算与双线性形式 $b(v,q)=\\int_{0}^{1} v'(x)\\,q(x)\\,dx$ 相关联的 inf-sup 常数 $\\beta$，其中 $V$ 和 $Q$ 为指定的希尔伯特空间。该常数定义为\n$$\n\\beta=\\inf_{q\\in Q\\setminus\\{0\\}}\\ \\sup_{v\\in V\\setminus\\{0\\}}\\ \\frac{b(v,q)}{\\|v\\|_{V}\\,\\|q\\|_{Q}}\n$$\n其中范数由 $\\|v\\|_{V}=\\|v'\\|_{L^{2}(0,1)}$ 和 $\\|q\\|_{Q}=\\|q\\|_{L^{2}(0,1)}$ 给出。$L^2(0,1)$ 内积表示为 $(f,g)_{L^2} = \\int_{0}^{1} f(x)g(x)\\,dx$。\n\n该问题在数学上是适定的。由于 Poincaré-Friedrichs 不等式，半范数 $\\|v'\\|_{L^2(0,1)}$ 可作为 $V=H_0^1(0,1)$ 和 $V=\\{v\\in H^1(0,1):v(0)=0\\}$ 上的范数。该不等式保证了对于在定义域上至少一点为零的函数，其 $\\|v\\|_{L^2(0,1)}$ 范数可被 $\\|v'\\|_{L^2(0,1)}$ 范数所控制。我们分情形进行求解。\n\n**主要设定：$V=H_{0}^{1}(0,1)$ 和 $Q=L_{0}^{2}(0,1)$**\n\n在此设定下，inf-sup 常数为\n$$\n\\beta=\\inf_{q\\in L_{0}^{2}(0,1)\\setminus\\{0\\}}\\ \\sup_{v\\in H_{0}^{1}(0,1)\\setminus\\{0\\}}\\ \\frac{(v',q)_{L^2}}{\\|v'\\|_{L^{2}(0,1)}\\,\\|q\\|_{L^{2}(0,1)}}.\n$$\n我们固定一个任意的 $q \\in Q \\setminus \\{0\\}$，即 $q \\in L_{0}^{2}(0,1)$；这意味着 $\\int_{0}^{1} q(x)\\,dx=0$ 且 $\\|q\\|_{L^2(0,1)} \\neq 0$。我们首先计算上确界项：\n$$\nS_q = \\sup_{v\\in H_{0}^{1}(0,1)\\setminus\\{0\\}}\\ \\frac{(v',q)_{L^2}}{\\|v'\\|_{L^{2}(0,1)}}.\n$$\n令 $V'$ 为 $V$ 中函数的导数空间，即 $V'=\\{u=v' : v \\in H_{0}^{1}(0,1)\\}$。项 $S_q$ 可重写为\n$$\nS_q = \\sup_{u\\in V'\\setminus\\{0\\}}\\ \\frac{(u,q)_{L^2}}{\\|u\\|_{L^{2}(0,1)}}.\n$$\n我们必须刻画空间 $V'$。\n如果 $v$ 及其弱导数 $v'$ 均在 $L^2(0,1)$ 中，则函数 $v$ 属于 $H^1(0,1)$。这意味着 $v$ 是绝对连续的。根据 Lebesgue 积分的微积分基本定理，对任意 $v \\in H_0^1(0,1)$，我们有 $v(1)-v(0) = \\int_0^1 v'(x) dx$。由于 $v \\in H_0^1(0,1)$，有 $v(0)=v(1)=0$，这蕴含 $\\int_0^1 v'(x) dx = 0$。这表明 $v' \\in L_0^2(0,1)$。因此，$V' \\subseteq L_0^2(0,1)$。\n\n反之，令 $u$ 为 $L_0^2(0,1)$ 中的任意函数。定义函数 $v$ 为 $v(x) = \\int_0^x u(t) dt$。由于 $u \\in L^2(0,1)$，$v$ 是绝对连续的，且其导数几乎处处为 $v'(x)=u(x)$。因此 $v \\in H^1(0,1)$。我们检查边界条件：\n- $v(0) = \\int_0^0 u(t) dt = 0$。\n- $v(1) = \\int_0^1 u(t) dt = 0$，因为 $u \\in L_0^2(0,1)$。\n因此，$v \\in H_0^1(0,1)$ 且 $v'=u$。这证明了对任意 $u \\in L_0^2(0,1)$，都存在一个 $v \\in H_0^1(0,1)$ 使得 $v'=u$。所以，$L_0^2(0,1) \\subseteq V'$。\n\n结合两个包含关系，我们得到 $V' = L_0^2(0,1)$，这恰好是空间 $Q$。\n因此，上确界项 $S_q$ 是在 $u \\in L_0^2(0,1)$ 上取值：\n$$\nS_q = \\sup_{u\\in L_{0}^{2}(0,1)\\setminus\\{0\\}}\\ \\frac{(u,q)_{L^2}}{\\|u\\|_{L^{2}(0,1)}}.\n$$\n因为 $q$ 本身就在 $L_0^2(0,1)$ 中，我们可以选择 $u=q$。此选择给出 $\\frac{(q,q)_{L^2}}{\\|q\\|_{L^2(0,1)}} = \\|q\\|_{L^2(0,1)}$。根据柯西-施瓦茨不等式， $|(u,q)_{L^2}| \\le \\|u\\|_{L^2(0,1)}\\|q\\|_{L^2(0,1)}$，因此当 $u$ 与 $q$ 成比例时，确实达到上确界，其值为 $\\|q\\|_{L^2(0,1)}$。从而，$S_q = \\|q\\|_{Q}$。\n\n最后，我们将此结果代回 $\\beta$ 的定义：\n$$\n\\beta = \\inf_{q\\in Q\\setminus\\{0\\}} \\frac{S_q}{\\|q\\|_Q} = \\inf_{q\\in L_0^2(0,1)\\setminus\\{0\\}} \\frac{\\|q\\|_{L^2(0,1)}}{\\|q\\|_{L^2(0,1)}} = \\inf_{q\\in L_0^2(0,1)\\setminus\\{0\\}} 1 = 1.\n$$\ninf-sup 常数的精确值为 $1$。\n\n**备选设定的分析**\n\n**情形 A：$V=H_{0}^{1}(0,1)$ 和 $Q=L^{2}(0,1)$**\n$V$ 空间不变，因此其导数空间 $V'$ 仍为 $L_0^2(0,1)$。$Q$ 空间现在是整个 $L^2(0,1)$。inf-sup 常数为\n$$\n\\beta_A = \\inf_{q\\in L^{2}(0,1)\\setminus\\{0\\}}\\ \\sup_{v\\in H_{0}^{1}(0,1)\\setminus\\{0\\}}\\ \\frac{(v',q)_{L^2}}{\\|v'\\|_{L^{2}(0,1)}\\,\\|q\\|_{L^{2}(0,1)}}.\n$$\n固定一个任意的 $q \\in L^2(0,1) \\setminus \\{0\\}$。上确界是在 $v' = u \\in L_0^2(0,1)$ 上取的。\n任何 $q \\in L^2(0,1)$ 都可以唯一地分解为 $q = q_0 + c$，其中 $q_0 \\in L_0^2(0,1)$，$c$ 是一个常函数。该常数是 $q$ 的均值，$c=\\int_0^1 q(x) dx$。此分解是正交的，即 $(q_0, c)_{L^2}=0$。\n对任意 $u \\in L_0^2(0,1)$，与 $q$ 的内积为\n$$\n(u,q)_{L^2} = (u, q_0+c)_{L^2} = (u,q_0)_{L^2} + (u,c)_{L^2}.\n$$\n第二项为 $(u,c)_{L^2} = \\int_0^1 u(x)c\\,dx = c \\int_0^1 u(x)\\,dx = 0$，因为 $u \\in L_0^2(0,1)$。\n因此，$(u,q)_{L^2} = (u,q_0)_{L^2}$。上确界项为\n$$\n\\sup_{u\\in L_0^2(0,1)\\setminus\\{0\\}} \\frac{(u,q_0)_{L^2}}{\\|u\\|_{L^2(0,1)}} = \\|q_0\\|_{L^2(0,1)}.\n$$\ninf-sup 常数是该上确界与 $\\|q\\|_{L^2(0,1)}$ 之比的下确界：\n$$\n\\beta_A = \\inf_{q\\in L^2(0,1)\\setminus\\{0\\}} \\frac{\\|q_0\\|_{L^2(0,1)}}{\\|q\\|_{L^2(0,1)}}.\n$$\n根据正交性，$\\|q\\|_{L^2(0,1)}^2 = \\|q_0\\|_{L^2(0,1)}^2 + \\|c\\|_{L^2(0,1)}^2$。我们寻求 $\\frac{\\|q_0\\|_{L^2(0,1)}}{\\sqrt{\\|q_0\\|_{L^2(0,1)}^2 + \\|c\\|_{L^2(0,1)}^2}}$ 的下确界。\n考虑一个非零常函数 $q(x) = C \\neq 0$。对于这样的函数，其均值为 $c=C$，其零均值部分为 $q_0 = q-c = 0$。对于这个 $q$ 的选择，比值为 $\\frac{0}{\\|C\\|_{L^2(0,1)}} = 0$。\n因此，下确界是 $0$。所以 $\\beta_A=0$。常数从 $1$ 减小到 $0$。这表明对于此空间选择，问题是不适定的，因为 $Q$ 中存在一些函数（常函数）位于伴随算子的核中。\n\n**情形 B：$V=\\{v\\in H^{1}(0,1): v(0)=0\\}$ 和 $Q=L^{2}(0,1)$**\n在这种情况下，$V$ 空间被扩大，只施加一个边界条件。$Q$ 空间是 $L^2(0,1)$。inf-sup 常数为\n$$\n\\beta_B = \\inf_{q\\in L^{2}(0,1)\\setminus\\{0\\}}\\ \\sup_{v\\in V\\setminus\\{0\\}}\\ \\frac{(v',q)_{L^2}}{\\|v'\\|_{L^{2}(0,1)}\\,\\|q\\|_{L^{2}(0,1)}}.\n$$\n我们来刻画导数空间 $V' = \\{u=v' : v \\in V\\}$。\n令 $u$ 为 $L^2(0,1)$ 中的任意函数。定义 $v(x) = \\int_0^x u(t) dt$。则 $v \\in H^1(0,1)$，且几乎处处有 $v'=u$，并且 $v(0)=0$。因此 $v \\in V$。这个构造表明任何 $u \\in L^2(0,1)$ 都是 $V$ 中某个函数的导数。因此，$V'=L^2(0,1)$，这与空间 $Q$ 相同。\n对于一个固定的 $q \\in Q \\setminus \\{0\\}$，上确界为\n$$\n\\sup_{v\\in V\\setminus\\{0\\}} \\frac{(v',q)_{L^2}}{\\|v'\\|_{L^2(0,1)}} = \\sup_{u\\in L^2(0,1)\\setminus\\{0\\}} \\frac{(u,q)_{L^2}}{\\|u\\|_{L^2(0,1)}}.\n$$\n因为 $q$ 本身就在 $L^2(0,1)$ 中，通过选择 $u=q$ 并引用柯西-施瓦茨不等式，我们发现上确界为 $\\|q\\|_{L^2(0,1)}$。\n将此代入 $\\beta_B$ 的定义：\n$$\n\\beta_B = \\inf_{q\\in L^2(0,1)\\setminus\\{0\\}} \\frac{\\|q\\|_{L^2(0,1)}}{\\|q\\|_{L^2(0,1)}} = 1.\n$$\n在这种情况下，inf-sup 常数的值为 $1$，这意味着它与主要设定中的值保持不变。通过放宽对 $v$ 在 $x=1$ 处的边界条件，我们扩大了测试函数空间 $V$，使得其导数空间 $V'$ 成为整个 $L^2(0,1)$。这个更大的导数集合足以克服在情形 A 中看到的问题，从而得到一个稳定的提法。", "answer": "$$\n\\boxed{1}\n$$", "id": "2577764"}, {"introduction": "当一组有限元空间不满足LBB条件时，所得到的离散系统可能会变得不稳定，从而产生伪解。本练习探讨了一种常见的补救措施：稳定化方法。我们将为斯托克斯方程推导一个基于压力稳定/Petrov-Galerkin (PSPG) 方法的稳定化弱形式，展示如何通过在原始格式中添加相容的稳定化项来确保数值解的鲁棒性。[@problem_id:2577752]", "problem": "考虑在有界 Lipschitz 区域 $\\Omega \\subset \\mathbb{R}^{d}$（其中 $d \\in \\{2,3\\}$）上的稳态不可压缩 Stokes 系统，其粘度为 $\\mu > 0$，彻体力为 $\\boldsymbol{f} \\in [L^{2}(\\Omega)]^{d}$，速度在边界 $\\partial \\Omega$ 上满足齐次 Dirichlet 边界条件：\n$$\n-\\mu \\Delta \\boldsymbol{u} + \\nabla p = \\boldsymbol{f} \\quad \\text{in } \\Omega, \n\\qquad \n\\nabla \\cdot \\boldsymbol{u} = 0 \\quad \\text{in } \\Omega,\n\\qquad \n\\boldsymbol{u} = \\boldsymbol{0} \\quad \\text{on } \\partial \\Omega.\n$$\n从标准变分形式出发，该形式通过将动量方程乘以一个速度检验函数 $\\boldsymbol{v} \\in [H_{0}^{1}(\\Omega)]^{d}$，将不可压缩性方程乘以一个压力检验函数 $q \\in L_{0}^{2}(\\Omega)$，然后在 $\\Omega$ 上积分，并在给定边界条件下适当地进行分部积分得到。假设速度和压力的协调同阶有限元空间分别为 $V_{h} \\subset [H_{0}^{1}(\\Omega)]^{d}$ 和 $Q_{h} \\subset L_{0}^{2}(\\Omega)$，它们由 $\\Omega$ 的形状正则网格 $\\mathcal{T}_{h}$ 上相同次数的连续分片多项式构成。\n\n为规避同阶空间违反 Ladyzhenskaya–Babuška–Brezzi (LBB) inf-sup 条件的问题，采用一种压力稳定/Petrov–Galerkin (PSPG) 稳定化方法：通过一个由压力检验函数梯度加权动量残差构成的一致的单元最小二乘项，来增广离散连续性方程。具体来说，在每个单元 $K \\in \\mathcal{T}_{h}$ 上，加上稳定化参数 $\\tau_{K} > 0$ 后的项\n$$\n\\sum_{K \\in \\mathcal{T}_{h}} \\tau_{K} \\, \\big( -\\mu \\Delta \\boldsymbol{u}_{h} + \\nabla p_{h} - \\boldsymbol{f} , \\nabla q_{h} \\big)_{K},\n$$\n其中 $(\\cdot,\\cdot)_{K}$ 表示 $L^{2}(K)$ 内积。在采用分片线性试探和检验空间的常见同阶选择下，速度在每个单元上是仿射的，因此在每个 $K$ 中 $\\Delta \\boldsymbol{u}_{h} = \\boldsymbol{0}$，上述 PSPG 项简化为压力梯度稳定化项\n$$\n\\sum_{K \\in \\mathcal{T}_{h}} \\tau_{K} \\, \\big( \\nabla p_{h}, \\nabla q_{h} \\big)_{K} - \\sum_{K \\in \\mathcal{T}_{h}} \\tau_{K} \\, \\big( \\boldsymbol{f}, \\nabla q_{h} \\big)_{K}.\n$$\n推导稳定化的弱形式，并写出包含 Galerkin 项和上述简化的 PSPG 压力梯度稳定化项的完整稳定化双线性形式 $A_{h} \\big( (\\boldsymbol{u}_{h},p_{h}), (\\boldsymbol{v}_{h}, q_{h}) \\big)$ 和稳定化线性泛函 $F_{h}(\\boldsymbol{v}_{h},q_{h})$。\n\n然后，为验证稳定化项的一致性，考虑单单元情况 $\\Omega = K = (0,1)^{2}$，其中稳定化参数为常数 $\\tau_{K} = \\tau > 0$。对于仅涉及压力和压力检验函数的纯稳定化贡献部分，取\n$$\np_{h}(x,y) = \\kappa x + \\lambda y, \n\\qquad \nq_{h}(x,y) = \\zeta (x + y),\n$$\n其中 $\\kappa, \\lambda, \\zeta \\in \\mathbb{R}$ 为常数。计算单元稳定化项\n$$\ns_{p}(p_{h}, q_{h}) := \\tau \\, \\big( \\nabla p_{h}, \\nabla q_{h} \\big)_{K}\n$$\n的值。请用 $\\tau, \\kappa, \\lambda, \\zeta$ 将您的最终结果表示为单个符号表达式。无需进行数值舍入，也无需单位。", "solution": "该问题是偏微分方程数值分析中的一个标准练习，具体涉及不可压缩 Stokes 方程的有限元方法。该问题在科学上是合理的，在数学上是适定的，并包含了求解所需的所有信息。我们将按要求进行推导和计算。\n\n稳态不可压缩 Stokes 问题的强形式如下：\n$$\n-\\mu \\Delta \\boldsymbol{u} + \\nabla p = \\boldsymbol{f} \\quad \\text{in } \\Omega\n$$\n$$\n\\nabla \\cdot \\boldsymbol{u} = 0 \\quad \\text{in } \\Omega\n$$\n$$\n\\boldsymbol{u} = \\boldsymbol{0} \\quad \\text{on } \\partial \\Omega\n$$\n这里，$\\boldsymbol{u}$ 是速度场，$p$ 是压力，$\\boldsymbol{f}$ 是彻体力，$\\mu > 0$ 是常数流体粘度。区域 $\\Omega \\subset \\mathbb{R}^{d}$（其中 $d \\in \\{2, 3\\}$）是一个有界 Lipschitz 区域。\n\n为了推导标准弱形式，我们从适当的函数空间中为动量方程选择检验函数 $\\boldsymbol{v}$，为连续性方程选择检验函数 $q$。我们从 $[H_{0}^{1}(\\Omega)]^{d}$ 中选择速度检验函数 $\\boldsymbol{v}$ 以自然地引入齐次 Dirichlet 边界条件，并从 $L_{0}^{2}(\\Omega)$（即在 $\\Omega$ 上均值为零的平方可积函数空间）中选择压力检验函数 $q$。\n\n我们将动量方程乘以 $\\boldsymbol{v}$，在 $\\Omega$ 上积分，并对粘性项和压力梯度项应用分部积分。\n对于粘性项，使用 Green 第一恒等式：\n$$\n\\int_{\\Omega} (-\\mu \\Delta \\boldsymbol{u}) \\cdot \\boldsymbol{v} \\, d\\Omega = \\int_{\\Omega} \\mu \\nabla \\boldsymbol{u} : \\nabla \\boldsymbol{v} \\, d\\Omega - \\int_{\\partial \\Omega} \\mu (\\nabla \\boldsymbol{u} \\cdot \\boldsymbol{n}) \\cdot \\boldsymbol{v} \\, dS\n$$\n由于在 $\\partial \\Omega$ 上 $\\boldsymbol{v} = \\boldsymbol{0}$，边界积分为零。\n对于压力项，使用散度算子的定义及其与梯度的伴随关系：\n$$\n\\int_{\\Omega} (\\nabla p) \\cdot \\boldsymbol{v} \\, d\\Omega = - \\int_{\\Omega} p (\\nabla \\cdot \\boldsymbol{v}) \\, d\\Omega + \\int_{\\partial \\Omega} p (\\boldsymbol{v} \\cdot \\boldsymbol{n}) \\, dS\n$$\n同样，由于在 $\\partial \\Omega$ 上 $\\boldsymbol{v} = \\boldsymbol{0}$，边界积分为零。\n因此，动量方程的弱形式为：\n$$\n\\mu (\\nabla \\boldsymbol{u}, \\nabla \\boldsymbol{v})_{\\Omega} - (p, \\nabla \\cdot \\boldsymbol{v})_{\\Omega} = (\\boldsymbol{f}, \\boldsymbol{v})_{\\Omega}\n$$\n其中 $(\\cdot, \\cdot)_{\\Omega}$ 表示 $L^{2}(\\Omega)$ 内积。\n\n连续性方程的弱形式通过乘以 $q$ 并在 $\\Omega$ 上积分得到：\n$$\n(\\nabla \\cdot \\boldsymbol{u}, q)_{\\Omega} = 0\n$$\n\n将这两个方程结合起来，得到标准的混合变分形式：求 $(\\boldsymbol{u}, p) \\in [H_{0}^{1}(\\Omega)]^{d} \\times L_{0}^{2}(\\Omega)$，使得对于所有 $(\\boldsymbol{v}, q) \\in [H_{0}^{1}(\\Omega)]^{d} \\times L_{0}^{2}(\\Omega)$：\n$$\n\\mu (\\nabla \\boldsymbol{u}, \\nabla \\boldsymbol{v})_{\\Omega} - (p, \\nabla \\cdot \\boldsymbol{v})_{\\Omega} + (\\nabla \\cdot \\boldsymbol{u}, q)_{\\Omega} = (\\boldsymbol{f}, \\boldsymbol{v})_{\\Omega}\n$$\n\n使用协调有限元空间 $V_{h} \\subset [H_{0}^{1}(\\Omega)]^{d}$ 和 $Q_{h} \\subset L_{0}^{2}(\\Omega)$进行离散化后，问题变为：求 $(\\boldsymbol{u}_{h}, p_{h}) \\in V_{h} \\times Q_{h}$，使得对于所有 $(\\boldsymbol{v}_{h}, q_{h}) \\in V_{h} \\times Q_{h}$：\n$$\n\\mu (\\nabla \\boldsymbol{u}_{h}, \\nabla \\boldsymbol{v}_{h})_{\\Omega} - (p_{h}, \\nabla \\cdot \\boldsymbol{v}_{h})_{\\Omega} + (\\nabla \\cdot \\boldsymbol{u}_{h}, q_{h})_{\\Omega} = (\\boldsymbol{f}, \\boldsymbol{v}_{h})_{\\Omega}\n$$\n\n问题指出，对于同阶插值，必须添加一个压力稳定/Petrov-Galerkin (PSPG) 项以满足离散 inf-sup 条件。该指定项（在分片线性单元上简化为 $\\Delta \\boldsymbol{u}_{h} = \\boldsymbol{0}$）被添加到弱形式中。此项作用于检验压力函数 $q_{h}$，形式如下：\n$$\n\\sum_{K \\in \\mathcal{T}_{h}} \\tau_{K} \\, \\big( \\nabla p_{h}, \\nabla q_{h} \\big)_{K} - \\sum_{K \\in \\mathcal{T}_{h}} \\tau_{K} \\, \\big( \\boldsymbol{f}, \\nabla q_{h} \\big)_{K}\n$$\n将此项添加到标准 Galerkin 形式中，得到稳定化问题：求 $(\\boldsymbol{u}_{h}, p_{h}) \\in V_{h} \\times Q_{h}$，使得对于所有 $(\\boldsymbol{v}_{h}, q_{h}) \\in V_{h} \\times Q_{h}$：\n$$\n\\mu (\\nabla \\boldsymbol{u}_{h}, \\nabla \\boldsymbol{v}_{h})_{\\Omega} - (p_{h}, \\nabla \\cdot \\boldsymbol{v}_{h})_{\\Omega} + (\\nabla \\cdot \\boldsymbol{u}_{h}, q_{h})_{\\Omega} + \\sum_{K \\in \\mathcal{T}_{h}} \\tau_{K} (\\nabla p_{h}, \\nabla q_{h})_{K} = (\\boldsymbol{f}, \\boldsymbol{v}_{h})_{\\Omega} + \\sum_{K \\in \\mathcal{T}_{h}} \\tau_{K} (\\boldsymbol{f}, \\nabla q_{h})_{K}\n$$\n\n我们被要求将其写成 $A_{h} \\big( (\\boldsymbol{u}_{h},p_{h}), (\\boldsymbol{v}_{h}, q_{h}) \\big) = F_{h}(\\boldsymbol{v}_{h},q_{h})$ 的形式。双线性形式 $A_{h}$ 包含依赖于试探函数 $(\\boldsymbol{u}_{h},p_{h})$ 的项，而线性泛函 $F_{h}$ 仅包含依赖于检验函数 $(\\boldsymbol{v}_{h},q_{h})$ 和数据的项。\n通过观察，我们确定：\n稳定化双线性形式为：\n$$\nA_{h} \\big( (\\boldsymbol{u}_{h},p_{h}), (\\boldsymbol{v}_{h}, q_{h}) \\big) = \\mu (\\nabla \\boldsymbol{u}_{h}, \\nabla \\boldsymbol{v}_{h})_{\\Omega} - (p_{h}, \\nabla \\cdot \\boldsymbol{v}_{h})_{\\Omega} + (\\nabla \\cdot \\boldsymbol{u}_{h}, q_{h})_{\\Omega} + \\sum_{K \\in \\mathcal{T}_{h}} \\tau_{K} (\\nabla p_{h}, \\nabla q_{h})_{K}\n$$\n稳定化线性泛函为：\n$$\nF_{h}(\\boldsymbol{v}_{h},q_{h}) = (\\boldsymbol{f}, \\boldsymbol{v}_{h})_{\\Omega} + \\sum_{K \\in \\mathcal{T}_{h}} \\tau_{K} (\\boldsymbol{f}, \\nabla q_{h})_{K}\n$$\n注意到在 $\\Omega$ 上的积分可以写成在单元 $K$ 上的积分之和，这些形式为：\n$$\nA_{h} \\big( (\\boldsymbol{u}_{h},p_{h}), (\\boldsymbol{v}_{h}, q_{h}) \\big) = \\sum_{K \\in \\mathcal{T}_{h}} \\Big[ \\mu (\\nabla \\boldsymbol{u}_{h}, \\nabla \\boldsymbol{v}_{h})_{K} - (p_{h}, \\nabla \\cdot \\boldsymbol{v}_{h})_{K} + (\\nabla \\cdot \\boldsymbol{u}_{h}, q_{h})_{K} + \\tau_{K} (\\nabla p_{h}, \\nabla q_{h})_{K} \\Big]\n$$\n$$\nF_{h}(\\boldsymbol{v}_{h},q_{h}) = \\sum_{K \\in \\mathcal{T}_{h}} \\Big[ (\\boldsymbol{f}, \\boldsymbol{v}_{h})_{K} + \\tau_{K} (\\boldsymbol{f}, \\nabla q_{h})_{K} \\Big]\n$$\n\n接下来，我们处理问题的第二部分。我们必须在单个单元上计算稳定化项中压力-压力部分的值，$s_{p}(p_{h}, q_{h}) := \\tau \\, \\big( \\nabla p_{h}, \\nabla q_{h} \\big)_{K}$。\n给定的数据是：\n-   区域：单个正方形单元 $K = (0,1)^{2}$。\n-   稳定化参数：一个常数 $\\tau > 0$。\n-   压力试探函数：$p_{h}(x,y) = \\kappa x + \\lambda y$，其中 $\\kappa, \\lambda \\in \\mathbb{R}$。\n-   压力检验函数：$q_{h}(x,y) = \\zeta (x + y)$，其中 $\\zeta \\in \\mathbb{R}$。\n\n首先，我们计算 $p_{h}$ 和 $q_{h}$ 的梯度。\n$p_{h}$ 的梯度为：\n$$\n\\nabla p_{h}(x,y) = \\begin{pmatrix} \\frac{\\partial}{\\partial x}(\\kappa x + \\lambda y) \\\\ \\frac{\\partial}{\\partial y}(\\kappa x + \\lambda y) \\end{pmatrix} = \\begin{pmatrix} \\kappa \\\\ \\lambda \\end{pmatrix}\n$$\n$q_{h}$ 的梯度为：\n$$\n\\nabla q_{h}(x,y) = \\begin{pmatrix} \\frac{\\partial}{\\partial x}(\\zeta x + \\zeta y) \\\\ \\frac{\\partial}{\\partial y}(\\zeta x + \\zeta y) \\end{pmatrix} = \\begin{pmatrix} \\zeta \\\\ \\zeta \\end{pmatrix}\n$$\n两个梯度在单元 $K$ 上都是常向量。\n\n接下来，我们计算这些梯度的点积：\n$$\n\\nabla p_{h} \\cdot \\nabla q_{h} = \\begin{pmatrix} \\kappa \\\\ \\lambda \\end{pmatrix} \\cdot \\begin{pmatrix} \\zeta \\\\ \\zeta \\end{pmatrix} = \\kappa \\zeta + \\lambda \\zeta = (\\kappa + \\lambda) \\zeta\n$$\n这个乘积也是一个常数。\n\n最后，我们通过在单元 $K$ 上对这个常数点积进行积分并乘以 $\\tau$ 来计算 $s_{p}(p_{h}, q_{h})$ 项：\n$$\ns_{p}(p_{h}, q_{h}) = \\tau \\int_{K} (\\nabla p_{h} \\cdot \\nabla q_{h}) \\, dK = \\tau \\int_{(0,1)^2} (\\kappa + \\lambda) \\zeta \\, dx dy\n$$\n由于被积函数是常数，我们可以将其从积分中提出：\n$$\ns_{p}(p_{h}, q_{h}) = \\tau (\\kappa + \\lambda) \\zeta \\int_{0}^{1} \\int_{0}^{1} \\, dx dy\n$$\n积分 $\\int_{0}^{1} \\int_{0}^{1} \\, dx dy$ 恰好是单位正方形 $K$ 的面积，即为 1。\n因此，稳定化项的值为：\n$$\ns_{p}(p_{h}, q_{h}) = \\tau (\\kappa + \\lambda) \\zeta \\cdot 1 = \\tau \\zeta (\\kappa + \\lambda)\n$$\n这就是所求项的最终符号表达式。", "answer": "$$\\boxed{\\tau \\zeta (\\kappa + \\lambda)}$$", "id": "2577752"}, {"introduction": "理论上的稳定性分析通常假设积分是精确的，但在实际的有限元程序中，我们使用数值积分来计算单元上的积分。本练习深入探讨了这一关键的实现细节，揭示了不精确的积分格式如何可能破坏理论上已证明的稳定性。你的任务是确定为保证斯托克斯问题中泰勒-胡德（Taylor-Hood）单元的稳定性，所需要的最小积分精度。[@problem_id:2577726]", "problem": "考虑在一个有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{2}$ 上，黏度为 $\\nu>0$ 的稳态 Stokes 方程：寻找速度 $u \\in [H_{0}^{1}(\\Omega)]^{2}$ 和压力 $p \\in L_{0}^{2}(\\Omega)$，使得对所有 $v \\in [H_{0}^{1}(\\Omega)]^{2}$ 和 $q \\in L_{0}^{2}(\\Omega)$，鞍点变分问题成立，\n$$\na(u,v)+b(v,p)+b(u,q)=\\ell(v),\n$$\n其中 $a(u,v):=\\int_{\\Omega} 2\\nu\\,\\varepsilon(u):\\varepsilon(v)\\,dx$，$b(v,q):=-\\int_{\\Omega} q\\,\\nabla\\cdot v\\,dx$ 以及 $\\ell(v):=\\int_{\\Omega} f\\cdot v\\,dx$，其中 $\\varepsilon(u):=\\tfrac{1}{2}(\\nabla u+\\nabla u^{\\top})$。设 $\\mathcal{T}_{h}$ 是 $\\Omega$ 的一个形状正则的三角形剖分。考虑 Taylor–Hood 有限元对：对于一个整数 $k\\geq 1$，离散空间为 $V_{h}:=\\{v_{h}\\in [C^{0}(\\Omega)]^{2}: v_{h}|_{K}\\in [\\mathbb{P}_{k+1}(K)]^{2}\\ \\forall K\\in \\mathcal{T}_{h},\\ v_{h}|_{\\partial\\Omega}=0\\}$ 和 $Q_{h}:=\\{q_{h}\\in C^{0}(\\Omega): q_{h}|_{K}\\in \\mathbb{P}_{k}(K)\\ \\forall K\\in \\mathcal{T}_{h},\\ \\int_{\\Omega} q_{h}\\,dx=0\\}$，其中 $\\mathbb{P}_{r}(K)$ 表示在单元 $K$ 上总次数至多为 $r$ 的标量多项式。\n\n假设存在一个 Fortin 算子 $\\Pi_{F}:[H_{0}^{1}(\\Omega)]^{2}\\to V_{h}$，使得对所有 $v\\in [H_{0}^{1}(\\Omega)]^{2}$，有 $\\|\\Pi_{F} v\\|_{H^{1}(\\Omega)}\\leq C\\|v\\|_{H^{1}(\\Omega)}$，并且对所有 $q_{h}\\in Q_{h}$，\n$$\nb(\\Pi_{F}v,q_{h})=b(v,q_{h}).\n$$\n为组装离散方法，假设耦合双线性形式 $b$ 被逐单元的数值求积所替代。具体来说，对于每个 $K\\in \\mathcal{T}_{h}$，设 $Q_{K}$ 是一个对 $K$ 上所有总次数至多为 $q$（求积精度次数）的多项式都精确的求积法则，并定义\n$$\nb_{h}(v,q):=-\\sum_{K\\in \\mathcal{T}_{h}} Q_{K}\\big(q\\,\\nabla\\cdot v\\big).\n$$\n\n你的任务是：\n- 仅使用 Taylor–Hood 空间的多项式次数结构和求积精度次数的定义，分析当 $b$ 被 $b_{h}$ 替代时，一个非精确的求积法则如何破坏 Fortin 性质，并可能因此破坏离散 inf–sup 稳定性。\n- 推导一个关于求积精度次数 $q$（作为速度-压力多项式次数参数 $k$ 的函数）的充分条件，该条件保证对所有的 $v_{h}\\in V_{h}$ 和 $q_{h}\\in Q_{h}$，\n$$\nb_{h}(v_{h},q_{h})=b(v_{h},q_{h}).\n$$\n这个条件足以确保从 Fortin 算子继承的稳定性在数值求积下得以保持。\n\n作为最终答案，请报告最小的此类精度次数 $q_{\\min}$，其形式为关于 $k$ 的封闭表达式。你的最终答案必须是一个没有单位的单一解析表达式。", "solution": "首先必须对问题陈述进行严格的验证。\n\n步骤 1：提取已知条件。\n问题涉及在有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{2}$ 上，黏度为 $\\nu > 0$ 的稳态 Stokes 方程。其弱形式是一个鞍点问题，旨在寻找速度 $u \\in [H_{0}^{1}(\\Omega)]^{2}$ 和压力 $p \\in L_{0}^{2}(\\Omega)$，使得对所有测试函数 $v \\in [H_{0}^{1}(\\Omega)]^{2}$ 和 $q \\in L_{0}^{2}(\\Omega)$，下式成立：\n$$a(u,v)+b(v,p)+b(u,q)=\\ell(v)$$\n双线性和线性形式定义如下：\n$a(u,v):=\\int_{\\Omega} 2\\nu\\,\\varepsilon(u):\\varepsilon(v)\\,dx$\n$b(v,q):=-\\int_{\\Omega} q\\,\\nabla\\cdot v\\,dx$\n$\\ell(v):=\\int_{\\Omega} f\\cdot v\\,dx$\n其中应变率张量为 $\\varepsilon(u):=\\tfrac{1}{2}(\\nabla u+\\nabla u^{\\top})$。\n该域使用形状正则的三角剖分 $\\mathcal{T}_{h}$ 进行离散化。\n有限元空间是 Taylor–Hood 对，为整数 $k \\geq 1$ 定义：\n$V_{h}:=\\{v_{h}\\in [C^{0}(\\Omega)]^{2}: v_{h}|_{K}\\in [\\mathbb{P}_{k+1}(K)]^{2}\\ \\forall K\\in \\mathcal{T}_{h},\\ v_{h}|_{\\partial\\Omega}=0\\}$\n$Q_{h}:=\\{q_{h}\\in C^{0}(\\Omega): q_{h}|_{K}\\in \\mathbb{P}_{k}(K)\\ \\forall K\\in \\mathcal{T}_{h},\\ \\int_{\\Omega} q_{h}\\,dx=0\\}$\n其中 $\\mathbb{P}_{r}(K)$ 是在单元 $K$ 上总次数至多为 $r$ 的标量多项式空间。\n假设存在一个 Fortin 算子 $\\Pi_{F}:[H_{0}^{1}(\\Omega)]^{2}\\to V_{h}$，满足：\n对所有 $v\\in [H_{0}^{1}(\\Omega)]^{2}$，有 $\\|\\Pi_{F} v\\|_{H^{1}(\\Omega)}\\leq C\\|v\\|_{H^{1}(\\Omega)}$。\n对所有 $q_{h}\\in Q_{h}$ 和 $v\\in [H_{0}^{1}(\\Omega)]^{2}$，有 $b(\\Pi_{F}v,q_{h})=b(v,q_{h})$。\n为耦合形式 $b(v,q)$ 引入了数值求积，定义了一个近似形式 $b_{h}(v,q)$：\n$b_{h}(v,q):=-\\sum_{K\\in \\mathcal{T}_{h}} Q_{K}\\big(q\\,\\nabla\\cdot v\\big)$，其中 $Q_{K}$ 是在单元 $K$ 上的一个求积法则，它对所有总次数至多为 $q$ 的多项式都是精确的。\n\n步骤 2：使用提取的已知条件进行验证。\n该问题具有科学基础，植根于不可压缩流问题有限元方法的标准理论。Stokes 方程、其混合变分形式、Taylor-Hood 单元、Fortin 算子的概念以及数值积分的分析，都是偏微分方程数值分析中的标准且成熟的课题。该问题是适定的；它要求一个充分条件，这是该领域的标准任务，并提供了推导它所需的所有必要定义。语言客观且数学上精确。设置是自洽和一致的。该问题既不平凡也非故作高深，因为它需要对函数空间中的多项式次数进行正确分析。\n\n步骤 3：结论与行动。\n问题有效。将提供完整解答。\n\nStokes 问题的混合有限元方法的稳定性取决于是否满足离散 inf-sup（或 Ladyzhenskaya-Babuška-Brezzi）条件。对于精确的双线性形式 $b$，该条件表明存在一个与网格尺寸 $h$ 无关的常数 $\\beta > 0$，使得\n$$\n\\sup_{v_{h}\\in V_{h}\\setminus\\{0\\}} \\frac{b(v_{h}, q_{h})}{\\|v_{h}\\|_{[H^{1}(\\Omega)]^{2}}} \\geq \\beta \\|q_{h}\\|_{L^{2}(\\Omega)} \\quad \\forall q_{h} \\in Q_{h}.\n$$\nFortin 算子 $\\Pi_{F}$ 的存在是证明该条件对 Taylor-Hood 单元成立的标准工具。\n\n第一个任务是分析使用近似双线性形式 $b_{h}$ 会如何损害稳定性分析。采用数值求积的离散系统的稳定性取决于一个类似的关于 $b_{h}$ 的 inf-sup 条件：\n$$\n\\sup_{v_{h}\\in V_{h}\\setminus\\{0\\}} \\frac{b_{h}(v_{h}, q_{h})}{\\|v_{h}\\|_{[H^{1}(\\Omega)]^{2}}} \\geq \\beta_{h} \\|q_{h}\\|_{L^{2}(\\Omega)} \\quad \\forall q_{h} \\in Q_{h}.\n$$\n使用 Fortin 算子证明 $b$ 的 inf-sup 条件的过程是，取任意 $q_{h} \\in Q_{h}$，并利用连续 inf-sup 条件找到一个 $v \\in [H^{1}_{0}(\\Omega)]^{2}$ 使得 $b(v, q_{h}) = \\|q_{h}\\|_{L^{2}(\\Omega)}^{2}$ 且 $\\|v\\|_{[H^{1}(\\Omega)]^{2}} \\leq C \\|q_{h}\\|_{L^{2}(\\Omega)}$。然后，选择 $v_{h} = \\Pi_{F}v \\in V_{h}$。利用 Fortin 算子的性质，我们有 $b(\\Pi_{F}v, q_{h}) = b(v, q_{h}) = \\|q_{h}\\|_{L^{2}(\\Omega)}^{2}$。结合算子的稳定性 $\\|\\Pi_{F}v\\|_{[H^{1}(\\Omega)]^{2}} \\leq C_{F}\\|v\\|_{[H^{1}(\\Omega)]^{2}}$，即可建立离散 inf-sup 条件。\n\n当 $b$ 被 $b_{h}$ 替代时，这条推理思路就失效了。论证的核心是恒等式 $b(\\Pi_{F}v, q_{h}) = b(v, q_{h})$。如果我们尝试对 $b_{h}$ 进行类似的论证，我们必须分析 $b_{h}(\\Pi_{F}v, q_{h})$ 这一项。一般而言，如果求积对被积函数 $q_{h}(\\nabla \\cdot v_{h})$ 不精确，则 $b_{h}(v_{h}, q_{h}) \\neq b(v_{h}, q_{h})$。其差异是求积误差：\n$$\nb(v_{h}, q_{h}) - b_{h}(v_{h}, q_{h}) = \\sum_{K\\in\\mathcal{T}_{h}} \\left( Q_{K}(q_{h} \\nabla \\cdot v_{h}) - \\int_{K} q_{h} \\nabla \\cdot v_{h} \\,dx \\right).\n$$\n这个误差项依赖于被积函数的高阶导数，可能会破坏稳定性证明。在基于 Fortin 的证明中，我们会有 $b_{h}(\\Pi_{F}v, q_{h}) = b(\\Pi_{F}v, q_{h}) - \\text{误差} = b(v, q_{h}) - \\text{误差}$。如果求积不够精确，误差项就无法得到控制，我们无法保证 $b_{h}(\\Pi_{F}v, q_{h})$ 有界地远离零。可以构造一个对 $(v_h, q_h)$，使得被积函数 $q_{h}\\nabla \\cdot v_{h}$ 是一个在 $L^1$ 范数下很大，但在一个不够精确的求积法则的求积点上求值为零的多项式。在这种情况下，$b(v_{h}, q_{h})$ 可能很大，而 $b_{h}(v_{h}, q_{h}) = 0$，这标志着灾难性的稳定性损失。Fortin 性质本身并未被“破坏”——它是算子 $\\Pi_F$ 相对于精确形式 $b$ 的一个性质。相反，其在证明近似系统稳定性方面的功用丧失了，因为关键的恒等式对 $b_h$ 不再成立。\n\n第二个任务是找到关于求积精度次数 $q$ 的一个充分条件，以确保稳定性论证得以保持。确保对 $(V_{h}, Q_{h})$ 的稳定性不因求积而降低的最直接方法是，要求求积法则在用于离散函数时对双线性形式 $b(\\cdot, \\cdot)$ 是精确的。也就是说，我们寻求关于 $q$ 的条件，使得\n$$\nb_{h}(v_{h}, q_{h}) = b(v_{h}, q_{h}) \\quad \\forall v_{h} \\in V_{h}, \\forall q_{h} \\in Q_{h}.\n$$\n如果求积法则 $Q_{K}$ 对每个单元 $K \\in \\mathcal{T}_{h}$ 上的被积函数 $q_{h}(\\nabla \\cdot v_{h})$ 都是精确的，那么这个等式就成立。为了确定所需的精度次数，我们必须找到该被积函数的最大可能多项式次数。\n\n设 $v_{h} \\in V_{h}$ 和 $q_{h} \\in Q_{h}$。在单个三角单元 $K \\in \\mathcal{T}_{h}$ 上：\n1.  离散压力 $q_{h}|_{K}$ 是一个总次数至多为 $k$ 的多项式。因此，$q_{h}|_{K} \\in \\mathbb{P}_{k}(K)$。\n2.  离散速度 $v_{h}|_{K}$ 是一个多项式向量，其每个分量的总次数至多为 $k+1$。所以，$v_{h}|_{K} \\in [\\mathbb{P}_{k+1}(K)]^{2}$。\n3.  离散速度的散度 $\\nabla \\cdot v_{h}$，涉及求 $v_{h}$ 各分量的一阶偏导数。次数为 $m$ 的多项式的导数是次数至多为 $m-1$ 的多项式。因此，对于 $v_{h}|_K = (v_{h,1}, v_{h,2})^T$，其中 $v_{h,1}, v_{h,2} \\in \\mathbb{P}_{k+1}(K)$，其散度为 $\\nabla \\cdot v_{h}|_{K} = \\frac{\\partial v_{h,1}}{\\partial x} + \\frac{\\partial v_{h,2}}{\\partial y}$。由于 $\\frac{\\partial v_{h,1}}{\\partial x}$ 和 $\\frac{\\partial v_{h,2}}{\\partial y}$ 都是 $\\mathbb{P}_{k}(K)$ 中的多项式，它们的和也是 $\\mathbb{P}_{k}(K)$ 中的多项式。因此，$\\nabla \\cdot v_{h}|_{K} \\in \\mathbb{P}_{k}(K)$。\n4.  被积函数是离散压力与离散速度散度的乘积：$q_{h}|_{K} (\\nabla \\cdot v_{h}|_{K})$。这是一个来自 $\\mathbb{P}_{k}(K)$ 的多项式和另一个来自 $\\mathbb{P}_{k}(K)$ 的多项式的乘积。一个次数为 $d_{1}$ 的多项式与一个次数为 $d_{2}$ 的多项式的乘积是一个次数至多为 $d_{1} + d_{2}$ 的多项式。\n5.  因此，在单元 $K$ 上的被积函数 $q_{h}(\\nabla \\cdot v_{h})$ 是一个总次数至多为 $k+k = 2k$ 的多项式。\n\n为了使求积法则 $Q_{K}$ 能够精确计算积分 $\\int_{K} q_{h}(\\nabla \\cdot v_{h}) \\,dx$，它必须对所有次数达到被积函数次数的多项式都是精确的。这就得出了充分条件：\n$$\nq \\geq 2k.\n$$\n问题要求的是能保证对所有离散函数的选择都成立的最小精度次数 $q_{\\min}$。当不等式取等时，达到这个最小值。\n\n因此，最小的充分求积精度次数是 $q_{\\min} = 2k$。", "answer": "$$\n\\boxed{2k}\n$$", "id": "2577726"}]}