{"hands_on_practices": [{"introduction": "我们从一个基本但至关重要的问题开始：为什么标准位移有限元法在处理不可压缩材料时会失效？这个练习将通过一个具体的计算，揭示即使一个精确的无散度（完全不可压缩）位移场，在经过标准的双线性单元插值后，也会在单元内部产生虚假的体积应变。这个现象是体积锁定的核心，也是我们转向更复杂的 U-p 列式法的根本原因 [@problem_id:2609062]。", "problem": "考虑在有限元法 (FEM) 中，对于一个近不可压缩材料，使用位移-压力 ($u$-$p$) 列式的单个平面应变等参双线性四边形单元 ($Q_1$) 。在此列式中，弱不可压缩性约束是通过压力测试函数来施加的，因此关键的运动学量是体积应变（位移的散度），记为 $\\varepsilon_v = \\nabla \\cdot u$。\n\n假设物理单元占据正方形区域 $\\Omega = \\{(x,y) \\,|\\, -1 \\le x \\le 1,\\, -1 \\le y \\le 1\\}$，其标准双线性形函数为\n$$\nN_1(x,y) = \\tfrac{1}{4}(1-x)(1-y),\\quad\nN_2(x,y) = \\tfrac{1}{4}(1+x)(1-y),\\quad\nN_3(x,y) = \\tfrac{1}{4}(1+x)(1+y),\\quad\nN_4(x,y) = \\tfrac{1}{4}(1-x)(1+y).\n$$\n假设精确的运动学容许位移场是无散度的（完全不可压缩），并且由流函数 $\\psi(x,y) = x y^{2}$ 通过以下方式生成：\n$$\nu_x(x,y) = \\frac{\\partial \\psi}{\\partial y} = 2 x y,\\qquad\nu_y(x,y) = -\\frac{\\partial \\psi}{\\partial x} = - y^{2},\n$$\n因此在 $\\Omega$ 内精确满足 $\\nabla \\cdot u = 0$。\n\n通过对精确值进行节点插值来构造离散 $Q_1$ 位移场 $u^h = (u_x^h,u_y^h)$，即：\n$$\nu_x^h(x,y) = \\sum_{a=1}^{4} N_a(x,y)\\,u_x(x_a,y_a),\\qquad\nu_y^h(x,y) = \\sum_{a=1}^{4} N_a(x,y)\\,u_y(x_a,y_a),\n$$\n其中 $(x_a,y_a)$ 是四个单元角点坐标 $(\\pm 1,\\pm 1)$。将离散体积应变定义为 $\\varepsilon_v^h(x,y) := \\nabla \\cdot u^h(x,y)$。\n\n使用位于 $(x,y) = \\big(\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3}\\big)$ 的标准 $2\\times 2$ 高斯积分点，计算离散体积应变 $\\varepsilon_v^h$ 在高斯点 $(x,y) = \\big(1/\\sqrt{3}, -1/\\sqrt{3}\\big)$ 处的值。请以精确值的形式给出答案，无需四舍五入。", "solution": "所述问题具有科学依据、是适定的、客观且自洽的。这是有限元法中的一个标准练习，旨在检验双线性插值的基本性质及其在施加不可压缩性约束时带来的后果。所有必要的数据和函数都已提供，不存在矛盾或含糊之处。该问题是有效的。\n\n目标是计算离散体积应变 $\\varepsilon_v^h(x,y) = \\nabla \\cdot u^h(x,y)$ 在高斯点 $(x_g, y_g) = (1/\\sqrt{3}, -1/\\sqrt{3})$ 处的值。离散位移场 $u^h = (u_x^h, u_y^h)$ 是通过对一个精确的、无散度的位移场进行节点插值得到的。\n\n首先，我们必须确定节点位移值。单元节点是正方形区域 $\\Omega$ 的角点，我们按标准逆时针顺序对其进行编号：\n节点 1: $(x_1, y_1) = (-1, -1)$\n节点 2: $(x_2, y_2) = (1, -1)$\n节点 3: $(x_3, y_3) = (1, 1)$\n节点 4: $(x_4, y_4) = (-1, 1)$\n\n精确位移场由 $u_x(x,y) = 2xy$ 和 $u_y(x,y) = -y^2$ 给出。我们在节点坐标处计算这些函数的值，以求得节点位移。\n\n对于位移的x分量，$u_x$：\n$u_{x1} = u_x(-1, -1) = 2(-1)(-1) = 2$\n$u_{x2} = u_x(1, -1) = 2(1)(-1) = -2$\n$u_{x3} = u_x(1, 1) = 2(1)(1) = 2$\n$u_{x4} = u_x(-1, 1) = 2(-1)(1) = -2$\n\n对于位移的y分量，$u_y$：\n$u_{y1} = u_y(-1, -1) = -(-1)^2 = -1$\n$u_{y2} = u_y(1, -1) = -(-1)^2 = -1$\n$u_{y3} = u_y(1, 1) = -(1)^2 = -1$\n$u_{y4} = u_y(-1, 1) = -(1)^2 = -1$\n\n离散位移场 $u^h(x,y)$ 则由以下插值公式给出：\n$$u_x^h(x,y) = \\sum_{a=1}^{4} N_a(x,y)\\,u_{xa}$$\n$$u_y^h(x,y) = \\sum_{a=1}^{4} N_a(x,y)\\,u_{ya}$$\n离散体积应变是此插值场的散度：\n$$\\varepsilon_v^h(x,y) = \\frac{\\partial u_x^h}{\\partial x} + \\frac{\\partial u_y^h}{\\partial y} = \\sum_{a=1}^{4} \\frac{\\partial N_a(x,y)}{\\partial x} u_{xa} + \\sum_{a=1}^{4} \\frac{\\partial N_a(x,y)}{\\partial y} u_{ya}$$\n\n我们来分析包含 $u_y$ 的项。由于所有节点值 $u_{ya}$ 都等于 $-1$，插值场 $u_y^h$ 为：\n$$u_y^h(x,y) = \\sum_{a=1}^{4} N_a(x,y)(-1) = -1 \\cdot \\sum_{a=1}^{4} N_a(x,y)$$\n等参形函数的一个基本性质是它们构成单位分解，即对于单元内所有的 $(x,y)$，都有 $\\sum_{a=1}^{4} N_a(x,y) = 1$。因此，$u_y^h(x,y) = -1$。\n常数的导数为零，所以：\n$$\\frac{\\partial u_y^h}{\\partial y} = \\frac{\\partial}{\\partial y}(-1) = 0$$\n这极大地简化了离散体积应变的计算。总表达式简化为：\n$$\\varepsilon_v^h(x,y) = \\frac{\\partial u_x^h}{\\partial x} = \\sum_{a=1}^{4} \\frac{\\partial N_a(x,y)}{\\partial x} u_{xa}$$\n\n我们现在需要形函数关于 $x$ 的导数：\n$\\frac{\\partial N_1}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\frac{1}{4}(1-x)(1-y)\\right) = -\\frac{1}{4}(1-y)$\n$\\frac{\\partial N_2}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\frac{1}{4}(1+x)(1-y)\\right) = \\frac{1}{4}(1-y)$\n$\\frac{\\partial N_3}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\frac{1}{4}(1+x)(1+y)\\right) = \\frac{1}{4}(1+y)$\n$\\frac{\\partial N_4}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\frac{1}{4}(1-x)(1+y)\\right) = -\\frac{1}{4}(1+y)$\n\n接下来，我们在指定的高斯点 $(x_g, y_g) = (1/\\sqrt{3}, -1/\\sqrt{3})$ 处计算这些导数的值：\n$\\frac{\\partial N_1}{\\partial x}\\bigg|_{(x_g, y_g)} = -\\frac{1}{4}(1 - (-\\frac{1}{\\sqrt{3}})) = -\\frac{1}{4}(1 + \\frac{1}{\\sqrt{3}})$\n$\\frac{\\partial N_2}{\\partial x}\\bigg|_{(x_g, y_g)} = \\frac{1}{4}(1 - (-\\frac{1}{\\sqrt{3}})) = \\frac{1}{4}(1 + \\frac{1}{\\sqrt{3}})$\n$\\frac{\\partial N_3}{\\partial x}\\bigg|_{(x_g, y_g)} = \\frac{1}{4}(1 + (-\\frac{1}{\\sqrt{3}})) = \\frac{1}{4}(1 - \\frac{1}{\\sqrt{3}})$\n$\\frac{\\partial N_4}{\\partial x}\\bigg|_{(x_g, y_g)} = -\\frac{1}{4}(1 + (-\\frac{1}{\\sqrt{3}})) = -\\frac{1}{4}(1 - \\frac{1}{\\sqrt{3}})$\n\n最后，我们使用节点值 $u_{xa} = \\{2, -2, 2, -2\\}$ 来计算 $\\varepsilon_v^h(x_g, y_g)$ 的和：\n$\\varepsilon_v^h = \\left(-\\frac{1}{4}(1 + \\frac{1}{\\sqrt{3}})\\right)(2) + \\left(\\frac{1}{4}(1 + \\frac{1}{\\sqrt{3}})\\right)(-2) + \\left(\\frac{1}{4}(1 - \\frac{1}{\\sqrt{3}})\\right)(2) + \\left(-\\frac{1}{4}(1 - \\frac{1}{\\sqrt{3}})\\right)(-2)$\n$\\varepsilon_v^h = -\\frac{1}{2}(1 + \\frac{1}{\\sqrt{3}}) - \\frac{1}{2}(1 + \\frac{1}{\\sqrt{3}}) + \\frac{1}{2}(1 - \\frac{1}{\\sqrt{3}}) + \\frac{1}{2}(1 - \\frac{1}{\\sqrt{3}})$\n$\\varepsilon_v^h = -1 \\cdot (1 + \\frac{1}{\\sqrt{3}}) + 1 \\cdot (1 - \\frac{1}{\\sqrt{3}})$\n$\\varepsilon_v^h = -1 - \\frac{1}{\\sqrt{3}} + 1 - \\frac{1}{\\sqrt{3}}$\n$\\varepsilon_v^h = -\\frac{2}{\\sqrt{3}}$\n\n为了用有理分母表示结果：\n$\\varepsilon_v^h = -\\frac{2\\sqrt{3}}{3}$\n\n这个离散体积应变的非零结果，源于一个完全不可压缩 ($\\nabla \\cdot u = 0$) 的连续场，是低阶有限元中称为体积闭锁现象的一种表现。", "answer": "$$\n\\boxed{-\\frac{2\\sqrt{3}}{3}}\n$$", "id": "2609062"}, {"introduction": "引入压力作为独立变量的 U-p 列式法是解决体积锁定的有效途径，但这并非没有代价。我们必须谨慎选择位移和压力的插值函数空间，以避免数值不稳定性。本练习通过构造一个特定的“棋盘”压力模式，展示了在均匀网格上使用等阶线性（$P_1$-$P_1$）单元偶如何违反离散的 inf-sup (LBB) 条件，从而导致非物理的解 [@problem_id:2609099]。", "problem": "考虑在有限元法 (FEM) 中，用于近似不可压缩固体的线性弹性问题的平面应变位移-压力混合格式。设计算域为单位正方形 $\\Omega = (0,1)^{2}$，通过均匀的 $2\\times 2$ 宏观划分剖分成四个全等的正方形，每个正方形再沿左下角到右上角的相同对角线分割成两个三角形。将此协调三角剖分记为 $\\mathcal{T}_{h}$，并设 $V_{h}\\subset [H^{1}_{0}(\\Omega)]^{2}$ 为连续的分片线性向量值空间（位移采用同阶 $P_{1}$），$Q_{h}\\subset L^{2}_{0}(\\Omega)$ 为均值为零的连续分片线性标量值空间（压力采用同阶 $P_{1}$）。混合双线性耦合项为\n$$\nb(u,p) \\;=\\; -\\int_{\\Omega} p\\,\\nabla\\cdot u\\,\\mathrm{d}x,\n$$\n离散 inf-sup (Ladyzhenskaya–Babuška–Brezzi (LBB)) 常数为\n$$\n\\beta_{h} \\;=\\; \\inf_{\\substack{p_{h}\\in Q_{h}\\\\ \\|p_{h}\\|_{0}=1}} \\;\\; \\sup_{\\substack{u_{h}\\in V_{h}\\\\ u_{h}\\neq 0}} \\frac{b(u_{h},p_{h})}{\\|u_{h}\\|_{1}},\n$$\n其中 $\\|\\cdot\\|_{0}$ 和 $\\|\\cdot\\|_{1}$ 分别是标准的 $L^{2}(\\Omega)$ 范数和 $H^{1}(\\Omega)$ 范数。\n\n仅使用：\n- 以上定义，\n- 对于 $P_{1}$ 函数，$u_h$ 的散度 $\\nabla\\cdot u_{h}$ 在每个三角形 $K\\in\\mathcal{T}_{h}$ 上是常数这一事实，\n- 以及对于顶点为 $\\{z_{1},z_{2},z_{3}\\}$ 的三角形 $K$ 上的线性函数 $\\ell$ 的初等恒等式，\n$$\n\\int_{K} \\ell\\,\\mathrm{d}x \\;=\\; \\frac{|K|}{3}\\,\\big(\\ell(z_{1})+\\ell(z_{2})+\\ell(z_{3})\\big),\n$$\n在此网格上构造一个显式的非零 $p_{h}\\in Q_{h}$，使得对于任意 $u_{h}\\in V_{h}$ 都有 $b(u_{h},p_{h})=0$。推断在这种均匀、一致对角化的网格上，对于这种同阶 $P_{1}$–$P_{1}$ 配对，离散 inf-sup 常数 $\\beta_{h}$ 的值。\n\n你的最终答案必须是 $\\beta_{h}$ 的值，形式为一个单独的实数。无需单位。不要四舍五入。", "solution": "该问题要求构造一个特定的伪压力模式，并随后确定给定有限元离散化的离散 inf-sup 常数 $\\beta_{h}$。分析过程如下。\n\n首先，我们来研究双线性形式 $b(u_{h}, p_{h})$。计算域 $\\Omega$ 是三角剖分 $\\mathcal{T}_{h}$ 中所有三角形 $K$ 的并集。我们可以将 $\\Omega$ 上的积分写成在每个三角形 $K$ 上的积分之和：\n$$\nb(u_{h}, p_{h}) = -\\int_{\\Omega} p_{h} \\nabla \\cdot u_{h} \\, \\mathrm{d}x = -\\sum_{K \\in \\mathcal{T}_{h}} \\int_{K} p_{h} \\nabla \\cdot u_{h} \\, \\mathrm{d}x\n$$\n题目给定，对于函数 $u_{h} \\in V_{h}$（由连续分片线性向量场构成），其散度 $\\nabla \\cdot u_{h}$ 在每个三角形 $K$ 上为常数。我们将此常数值记为 $(\\nabla \\cdot u_{h})|_{K}$。因此，我们可以将此常数从每个三角形的积分中提出来：\n$$\nb(u_{h}, p_{h}) = -\\sum_{K \\in \\mathcal{T}_{h}} (\\nabla \\cdot u_{h})|_{K} \\int_{K} p_{h} \\, \\mathrm{d}x\n$$\n函数 $p_{h} \\in Q_{h}$ 是连续且分片线性的。问题提供了一个在顶点为 $\\{z_{1}, z_{2}, z_{3}\\}$ 的三角形 $K$ 上对线性函数 $\\ell$ 进行积分的恒等式：\n$$\n\\int_{K} \\ell \\, \\mathrm{d}x = \\frac{|K|}{3} \\left( \\ell(z_{1}) + \\ell(z_{2}) + \\ell(z_{3}) \\right)\n$$\n将此恒等式应用于 $p_{h}$，我们得到：\n$$\nb(u_{h}, p_{h}) = -\\sum_{K \\in \\mathcal{T}_{h}} (\\nabla \\cdot u_{h})|_{K} \\frac{|K|}{3} \\sum_{i=1}^{3} p_{h}(z_{K,i})\n$$\n其中 $\\{z_{K,i}\\}_{i=1}^{3}$ 是三角形 $K$ 的顶点。\n\n我们的目标是找到一个非零的压力场 $p_{h} \\in Q_{h}$，使得对于任意 $u_{h} \\in V_{h}$ 都有 $b(u_{h}, p_{h})=0$。对于这种特定的网格和单元选择，该压力场被称为伪压力模式或棋盘格模式。\n\n让我们在 $3 \\times 3$ 节点网格上定义 $p_h$ 的节点值。节点位于坐标 $(0.5i, 0.5j)$ 处，其中 $i, j \\in \\{0, 1, 2\\}$。我们使用棋盘格模式在这些节点上定义压力：\n$$\np_{h}(0.5i, 0.5j) = (-1)^{i+j}\n$$\n这定义了一个非零的连续分片线性函数 $p_h$。要成为 $Q_h$ 中的元素，它在 $\\Omega$ 上的均值也必须为零，即 $\\int_{\\Omega} p_{h} \\, \\mathrm{d}x = 0$。让我们来验证这个条件。\n区域 $\\Omega$ 由 8 个面积相等的三角形组成，每个三角形的面积为 $|K| = \\frac{1}{2}(0.5)^{2} = 0.125$。积分为 $\\int_{\\Omega} p_{h} \\, \\mathrm{d}x = \\sum_{K \\in \\mathcal{T}_{h}} \\int_{K} p_{h} \\, \\mathrm{d}x = \\frac{|K|}{3} \\sum_{K \\in \\mathcal{T}_{h}} \\sum_{i=1}^{3} p_{h}(z_{K,i})$。\n让我们根据指定的网格结构，列出 8 个三角形中每个三角形的节点压力值之和。该结构中，四个 $0.5 \\times 0.5$ 的正方形均由左下到右上的对角线分割。\n节点值为：$p(0,0)=1, p(0.5,0)=-1, p(1,0)=1, p(0,0.5)=-1, p(0.5,0.5)=1, p(1,0.5)=-1, p(0,1)=1, p(0.5,1)=-1, p(1,1)=1$。\n- 左下角正方形（2个三角形）：顶点为 $(0,0), (0.5,0), (0,0.5), (0.5,0.5)$，节点值为 $1, -1, -1, 1$。每个三角形的节点值之和为 $1 - 1 + 1 = 1$。\n- 右下角正方形（2个三角形）：顶点为 $(0.5,0), (1,0), (0.5,0.5), (1,0.5)$，节点值为 $-1, 1, 1, -1$。每个三角形的节点值之和为 $-1 + 1 - 1 = -1$。\n- 左上角正方形（2个三角形）：顶点为 $(0,0.5), (0.5,0.5), (0,1), (0.5,1)$，节点值为 $-1, 1, 1, -1$。每个三角形的节点值之和为 $-1 + 1 - 1 = -1$。\n- 右上角正方形（2个三角形）：顶点为 $(0.5,0.5), (1,0.5), (0.5,1), (1,1)$，节点值为 $1, -1, -1, 1$。每个三角形的节点值之和为 $1 - 1 + 1 = 1$。\n将所有 8 个三角形的贡献相加：$\\frac{|K|}{3} (2 \\times 1 + 2 \\times (-1) + 2 \\times (-1) + 2 \\times 1) = \\frac{|K|}{3} (2-2-2+2) = 0$。\n因此，这个棋盘格压力 $p_{h}$ 的均值为零，是 $Q_{h}$ 中的一个元素。\n\n现在我们必须证明对于所有 $u_{h} \\in V_{h}$，都有 $b(u_{h}, p_{h}) = 0$。空间 $V_{h} \\subset [H^{1}_{0}(\\Omega)]^{2}$ 由在边界 $\\partial\\Omega$ 上为零的向量函数组成。这意味着对于任何 $u_{h} \\in V_{h}$，唯一可能非零的节点值只出现在单个内部节点 $z_{c} = (0.5, 0.5)$ 处。因此，任何函数 $u_{h} \\in V_{h}$ 都可以写成两个向量基函数的线性组合：一个对应于在 $z_{c}$ 处 $x$ 方向的单位位移，另一个对应于在 $z_{c}$ 处 $y$ 方向的单位位移。设这些基函数为 $u_{h}^{(1)}$ 和 $u_{h}^{(2)}$。如果我们证明 $b(u_{h}^{(1)}, p_{h}) = 0$ 和 $b(u_{h}^{(2)}, p_{h}) = 0$，那么根据线性性质，对于所有 $u_{h} \\in V_{h}$，都有 $b(u_{h}, p_{h}) = 0$。\n\n让我们考虑围绕中心节点 $z_c$ 的四个正方形子域。对于任何一个这样的正方形 $S_j$，在其上的位移场 $u_h$（可以是 $u_h^{(1)}$ 或 $u_h^{(2)}$）在正方形的三个角上为零，在 $z_c$ 处有一个非零值。根据散度定理，在每个正方形子域上的散度积分为：\n$$ \\int_{S_j} \\nabla \\cdot u_h \\, dV = \\int_{\\partial S_j} u_h \\cdot n \\, dS $$\n由于在四个相邻的正方形之间，$u_h$ 及其法向分量的贡献相互抵消，而在整个 $2 \\times 2$ 宏观单元的外部边界上 $u_h=0$，我们有 $\\int_{\\Omega} \\nabla \\cdot u_h \\, dV = 0$。\n对于 $P_1$ 有限元，散度 $\\nabla \\cdot u_h$ 在每个三角形上是常数。由于网格和中心节点位移的对称性，对于中心节点周围对角的正方形，$u_h$ 的分布是反对称的。这导致在这些正方形的三角形中，散度值的和为零。更具体地说，对于一个基函数（例如 $u_h^{(1)}$），散度值在围绕中心节点的 8 个三角形上表现出对称性，它与棋盘格压力模式 $p_h$ 的和 $\\sum p_h(z_{K,i})$ 的乘积在整个域上的总和为零。\n\n由于对于 $V_h$ 的基函数有 $b(u_{h}, p_{h})=0$，所以该式对所有 $u_{h} \\in V_{h}$ 都成立。\n\n我们构造了一个非零的 $p_{h}^{*} \\in Q_{h}$（我们的棋盘格模式），使得对于所有 $u_{h} \\in V_{h}$ 都有 $b(u_{h}, p_{h}^{*}) = 0$。现在，考虑离散 inf-sup 常数的定义：\n$$\n\\beta_{h} = \\inf_{\\substack{p_{h}\\in Q_{h}\\\\ \\|p_{h}\\|_{0}=1}} \\;\\; \\sup_{\\substack{u_{h}\\in V_{h}\\\\ u_{h}\\neq 0}} \\frac{b(u_{h},p_{h})}{\\|u_{h}\\|_{1}}\n$$\n让我们选择特定的压力 $\\hat{p}_{h} = p_{h}^{*}/\\|p_{h}^{*}\\|_{0}$。这是一个有效的压力，可用于 infimum 的计算，因为它属于 $Q_h$ 并且具有单位 $L^2$ 范数。对于这个 $\\hat{p}_{h}$，supremum 为：\n$$\n\\sup_{\\substack{u_{h}\\in V_{h}\\\\ u_{h}\\neq 0}} \\frac{b(u_{h},\\hat{p}_{h})}{\\|u_{h}\\|_{1}} = \\sup_{\\substack{u_{h}\\in V_{h}\\\\ u_{h}\\neq 0}} \\frac{b(u_{h}, p_{h}^{*}/\\|p_{h}^{*}\\|_{0})}{\\|u_{h}\\|_{1}} = \\frac{1}{\\|p_{h}^{*}\\|_{0}} \\sup_{\\substack{u_{h}\\in V_{h}\\\\ u_{h}\\neq 0}} \\frac{b(u_{h},p_{h}^{*})}{\\|u_{h}\\|_{1}}\n$$\n因为我们证明了对于所有 $u_{h} \\in V_{h}$ 都有 $b(u_{h}, p_{h}^{*}) = 0$，所以 supremum 为 0。\n对所有可能的归一化压力的 infimum 必须小于或等于这个特定的值 0。\n$$\n\\beta_{h} \\leq 0\n$$\n此外，对于任何 $p_h$，项 $\\sup_{u_{h}} \\frac{b(u_{h},p_{h})}{\\|u_{h}\\|_{1}}$ 是非负的。如果它是负的，比如说 $-C$（其中 $C>0$），那么对于位移场 $-u_h$，我们将有 $\\frac{b(-u_{h},p_{h})}{\\|-u_{h}\\|_{1}} = \\frac{-b(u_{h},p_{h})}{\\|u_{h}\\|_{1}}$，并且 supremum 将包含正值。因此，$\\sup(\\ldots) \\geq 0$。这意味着对所有 $p_h$ 的 infimum 也必须是非负的，即 $\\beta_{h} \\geq 0$。\n结合这两个不等式，我们必然得到 $\\beta_{h}=0$。\n这个结果证明了在这种类型的均匀网格上，对于 Stokes 或混合弹性问题，同阶 $P_1-P_1$ 单元配对是众所周知不稳定的。", "answer": "$$\n\\boxed{0}\n$$", "id": "2609099"}, {"introduction": "在深入了解了离散化带来的挑战之后，让我们回到问题的源头：连续介质力学的控制方程。本练习采用“制造解方法”(Method of Manufactured Solutions)，这是一个用于验证有限元代码正确性的强大技术。您将为一个给定的精确解（位移和压力场）反向推导出力和边界条件，这将加深您对线弹性理论中应力、应变和动量平衡之间关系的理解 [@problem_id:2609089]。", "problem": "考虑在二维单位正方形域 $\\Omega = (0,1)\\times(0,1)$ 上的静态、不可压缩线性弹性问题的位移-压力混合格式（u-p 格式）。设未知位移为 $u:\\Omega\\to\\mathbb{R}^{2}$，压力为 $p:\\Omega\\to\\mathbb{R}$。控制方程为线性动量平衡和不可压缩约束，\n$$-\\nabla\\cdot\\sigma = f \\quad\\text{in } \\Omega,\\qquad \\nabla\\cdot u = 0 \\quad\\text{in } \\Omega,$$\n其中柯西应力为\n$$\\sigma = 2\\mu\\,\\varepsilon(u) - p\\,I,$$\n此处 $\\mu>0$ 是常数剪切模量，$I$ 是二阶单位张量，$\\varepsilon(u) = \\tfrac{1}{2}\\left(\\nabla u + (\\nabla u)^{\\top}\\right)$ 是线性化应变。设自然边界条件为面力\n$$t = \\sigma n \\quad\\text{on } \\partial\\Omega,$$\n此处 $n$ 是 $\\partial\\Omega$ 的单位外法线。\n\n使用制造解方法，考虑流函数 $\\psi(x,y) = \\sin(\\pi x)\\sin(\\pi y)$ 并通过其定义位移场和压力场：\n$$u(x,y) = \\begin{pmatrix}\\dfrac{\\partial\\psi}{\\partial y}(x,y) \\\\ -\\dfrac{\\partial\\psi}{\\partial x}(x,y)\\end{pmatrix} = \\begin{pmatrix}\\pi \\cos(\\pi y)\\sin(\\pi x) \\\\ -\\pi \\cos(\\pi x)\\sin(\\pi y)\\end{pmatrix},\\qquad p(x,y) = \\cos(\\pi x)\\cos(\\pi y).$$\n这样的选择确保了在 $\\Omega$ 内 $\\nabla\\cdot u = 0$，并且压力非零且在 $\\Omega$ 上的均值为零。\n\n任务：仅从已陈述的场方程、定义以及给定的 $(u,p)$ 出发，推导出体力 $f:\\Omega\\to\\mathbb{R}^{2}$ 和在 $\\partial\\Omega$ 各边上的边界面力 $t$，使得 $(u,p)$ 精确满足该模型。在正方形的每一条边上，使用 $x=0$、$x=1$、$y=0$ 和 $y=1$ 处的单位外法线，用边界坐标表示面力。\n\n答案规格：\n- 将最终答案以单行矩阵的形式给出，包含以下十个解析表达式，顺序如下：\n$$\\big(f_{x}(x,y),\\ f_{y}(x,y),\\ t_{x}(0,y),\\ t_{y}(0,y),\\ t_{x}(1,y),\\ t_{y}(1,y),\\ t_{x}(x,0),\\ t_{y}(x,0),\\ t_{x}(x,1),\\ t_{y}(x,1)\\big).$$\n- 不包含单位。不要对任何常数进行近似；保留 $\\pi$ 和 $\\mu$ 为符号形式。", "solution": "对问题陈述进行验证。\n\n**步骤 1：提取给定信息**\n- 域：$\\Omega = (0,1)\\times(0,1)$。\n- 控制方程：\n  - 动量平衡：$-\\nabla\\cdot\\sigma = f$ in $\\Omega$。\n  - 不可压缩性：$\\nabla\\cdot u = 0$ in $\\Omega$。\n- 本构关系（柯西应力）：$\\sigma = 2\\mu\\,\\varepsilon(u) - p\\,I$，其中 $\\mu>0$。\n- 线性化应变：$\\varepsilon(u) = \\tfrac{1}{2}\\left(\\nabla u + (\\nabla u)^{\\top}\\right)$。\n- 边界面力：$t = \\sigma n$ on $\\partial\\Omega$。\n- 制造位移：$u(x,y) = \\begin{pmatrix}\\pi \\cos(\\pi y)\\sin(\\pi x) \\\\ -\\pi \\cos(\\pi x)\\sin(\\pi y)\\end{pmatrix}$。\n- 制造压力：$p(x,y) = \\cos(\\pi x)\\cos(\\pi y)$。\n\n**步骤 2：使用提取的信息进行验证**\n该问题具有科学依据，因为它涉及标准的线性弹性静力学方程。该问题是适定的，因为它要求为给定的制造解 $(u, p)$ 计算源项（$f$, $t$），这是制造解方法中用于代码验证的标准流程。该问题是客观的，并提供了进行推导所需的所有必要信息。陈述正确地断言给定的位移场 $u$ 是无散的（散度为零）：\n$$ \\nabla \\cdot u = \\frac{\\partial u_x}{\\partial x} + \\frac{\\partial u_y}{\\partial y} = \\frac{\\partial}{\\partial x}(\\pi \\cos(\\pi y)\\sin(\\pi x)) + \\frac{\\partial}{\\partial y}(-\\pi \\cos(\\pi x)\\sin(\\pi y)) $$\n$$ = \\pi^2 \\cos(\\pi y)\\cos(\\pi x) - \\pi^2 \\cos(\\pi x)\\cos(\\pi y) = 0 $$\n该问题是自洽的、一致的，并且在科学上是合理的。\n\n**步骤 3：结论与操作**\n问题有效。将推导一个完整的解。\n\n任务是确定与所提供的位移场 $u$ 和压力场 $p$ 一致的体力 $f$ 和边界面力 $t$。这需要计算应力张量 $\\sigma$，然后计算其散度以及其与边界法向量的乘积。\n\n首先，我们计算线性化应变张量 $\\varepsilon(u)$ 的分量。位移的分量为 $u_x = \\pi \\sin(\\pi x) \\cos(\\pi y)$ 和 $u_y = -\\pi \\cos(\\pi x) \\sin(\\pi y)$。位移梯度 $\\nabla u$ 的分量为：\n$$ \\frac{\\partial u_x}{\\partial x} = \\pi^2 \\cos(\\pi x) \\cos(\\pi y) $$\n$$ \\frac{\\partial u_x}{\\partial y} = -\\pi^2 \\sin(\\pi x) \\sin(\\pi y) $$\n$$ \\frac{\\partial u_y}{\\partial x} = \\pi^2 \\sin(\\pi x) \\sin(\\pi y) $$\n$$ \\frac{\\partial u_y}{\\partial y} = -\\pi^2 \\cos(\\pi x) \\cos(\\pi y) $$\n应变张量的对角分量为：\n$$ \\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = \\pi^2 \\cos(\\pi x) \\cos(\\pi y) $$\n$$ \\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = -\\pi^2 \\cos(\\pi x) \\cos(\\pi y) $$\n应变张量的非对角分量为：\n$$ \\varepsilon_{xy} = \\varepsilon_{yx} = \\frac{1}{2} \\left( \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} \\right) = \\frac{1}{2} \\left( -\\pi^2 \\sin(\\pi x) \\sin(\\pi y) + \\pi^2 \\sin(\\pi x) \\sin(\\pi y) \\right) = 0 $$\n因此，应变张量为：\n$$ \\varepsilon(u) = \\begin{pmatrix} \\pi^2 \\cos(\\pi x) \\cos(\\pi y) & 0 \\\\ 0 & -\\pi^2 \\cos(\\pi x) \\cos(\\pi y) \\end{pmatrix} $$\n\n接下来，我们计算柯西应力张量 $\\sigma = 2\\mu\\,\\varepsilon(u) - p\\,I$。当 $p(x,y) = \\cos(\\pi x)\\cos(\\pi y)$ 时，应力张量的分量为：\n$$ \\sigma_{xx} = 2\\mu\\varepsilon_{xx} - p = 2\\mu\\pi^2 \\cos(\\pi x) \\cos(\\pi y) - \\cos(\\pi x) \\cos(\\pi y) = (2\\mu\\pi^2 - 1) \\cos(\\pi x) \\cos(\\pi y) $$\n$$ \\sigma_{yy} = 2\\mu\\varepsilon_{yy} - p = -2\\mu\\pi^2 \\cos(\\pi x) \\cos(\\pi y) - \\cos(\\pi x) \\cos(\\pi y) = -(2\\mu\\pi^2 + 1) \\cos(\\pi x) \\cos(\\pi y) $$\n$$ \\sigma_{xy} = \\sigma_{yx} = 2\\mu\\varepsilon_{xy} = 0 $$\n所以，应力张量为：\n$$ \\sigma = \\cos(\\pi x)\\cos(\\pi y) \\begin{pmatrix} 2\\mu\\pi^2 - 1 & 0 \\\\ 0 & -(2\\mu\\pi^2 + 1) \\end{pmatrix} $$\n\n现在，我们推导体力 $f = - \\nabla \\cdot \\sigma$。$f$ 的分量为：\n$$ f_x = -\\left(\\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{yx}}{\\partial y}\\right) = -\\frac{\\partial \\sigma_{xx}}{\\partial x} $$\n$$ f_x = -\\frac{\\partial}{\\partial x} \\left[ (2\\mu\\pi^2 - 1) \\cos(\\pi x) \\cos(\\pi y) \\right] = -(2\\mu\\pi^2 - 1) (-\\pi \\sin(\\pi x)) \\cos(\\pi y) $$\n$$ f_x(x,y) = \\pi(2\\mu\\pi^2 - 1) \\sin(\\pi x) \\cos(\\pi y) $$\n$$ f_y = -\\left(\\frac{\\partial \\sigma_{xy}}{\\partial x} + \\frac{\\partial \\sigma_{yy}}{\\partial y}\\right) = -\\frac{\\partial \\sigma_{yy}}{\\partial y} $$\n$$ f_y = -\\frac{\\partial}{\\partial y} \\left[ -(2\\mu\\pi^2 + 1) \\cos(\\pi x) \\cos(\\pi y) \\right] = (2\\mu\\pi^2 + 1) \\cos(\\pi x) (-\\pi \\sin(\\pi y)) $$\n$$ f_y(x,y) = -\\pi(2\\mu\\pi^2 + 1) \\cos(\\pi x) \\sin(\\pi y) $$\n\n最后，我们计算单位正方形 $\\partial\\Omega$ 四条边上各自的边界面力 $t = \\sigma n$。\n面力向量为 $t = \\begin{pmatrix} t_x \\\\ t_y \\end{pmatrix} = \\begin{pmatrix} \\sigma_{xx} n_x + \\sigma_{xy} n_y \\\\ \\sigma_{yx} n_x + \\sigma_{yy} n_y \\end{pmatrix} = \\begin{pmatrix} \\sigma_{xx} n_x \\\\ \\sigma_{yy} n_y \\end{pmatrix}$。\n\n1.  在边界 $x=0$上，外法线为 $n = (-1, 0)^T$。\n    $$ t_x(0,y) = \\sigma_{xx}|_{x=0} \\cdot (-1) = -(2\\mu\\pi^2 - 1) \\cos(0) \\cos(\\pi y) = (1 - 2\\mu\\pi^2) \\cos(\\pi y) $$\n    $$ t_y(0,y) = \\sigma_{yy}|_{x=0} \\cdot (0) = 0 $$\n\n2.  在边界 $x=1$上，外法线为 $n = (1, 0)^T$。\n    $$ t_x(1,y) = \\sigma_{xx}|_{x=1} \\cdot (1) = (2\\mu\\pi^2 - 1) \\cos(\\pi) \\cos(\\pi y) = -(2\\mu\\pi^2 - 1) \\cos(\\pi y) = (1 - 2\\mu\\pi^2) \\cos(\\pi y) $$\n    $$ t_y(1,y) = \\sigma_{yy}|_{x=1} \\cdot (0) = 0 $$\n\n3.  在边界 $y=0$上，外法线为 $n = (0, -1)^T$。\n    $$ t_x(x,0) = \\sigma_{xx}|_{y=0} \\cdot (0) = 0 $$\n    $$ t_y(x,0) = \\sigma_{yy}|_{y=0} \\cdot (-1) = -[-(2\\mu\\pi^2 + 1) \\cos(\\pi x) \\cos(0)] = (2\\mu\\pi^2 + 1) \\cos(\\pi x) $$\n\n4.  在边界 $y=1$上，外法线为 $n = (0, 1)^T$。\n    $$ t_x(x,1) = \\sigma_{xx}|_{y=1} \\cdot (0) = 0 $$\n    $$ t_y(x,1) = \\sigma_{yy}|_{y=1} \\cdot (1) = -(2\\mu\\pi^2 + 1) \\cos(\\pi x) \\cos(\\pi) = (2\\mu\\pi^2 + 1) \\cos(\\pi x) $$\n\n将所需的十个表达式组合成一个单行矩阵，作为最终答案。\n- $f_{x}(x,y) = \\pi(2\\mu\\pi^2 - 1) \\sin(\\pi x) \\cos(\\pi y)$\n- $f_{y}(x,y) = -\\pi(2\\mu\\pi^2 + 1) \\cos(\\pi x) \\sin(\\pi y)$\n- $t_{x}(0,y) = (1 - 2\\mu\\pi^2) \\cos(\\pi y)$\n- $t_{y}(0,y) = 0$\n- $t_{x}(1,y) = (1 - 2\\mu\\pi^2) \\cos(\\pi y)$\n- $t_{y}(1,y) = 0$\n- $t_{x}(x,0) = 0$\n- $t_{y}(x,0) = (2\\mu\\pi^2 + 1) \\cos(\\pi x)$\n- $t_{x}(x,1) = 0$\n- $t_{y}(x,1) = (2\\mu\\pi^2 + 1) \\cos(\\pi x)$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\pi(2\\mu\\pi^2 - 1) \\sin(\\pi x) \\cos(\\pi y) & -\\pi(2\\mu\\pi^2 + 1) \\cos(\\pi x) \\sin(\\pi y) & (1 - 2\\mu\\pi^2) \\cos(\\pi y) & 0 & (1 - 2\\mu\\pi^2) \\cos(\\pi y) & 0 & 0 & (2\\mu\\pi^2 + 1) \\cos(\\pi x) & 0 & (2\\mu\\pi^2 + 1) \\cos(\\pi x)\n\\end{pmatrix}\n}\n$$", "id": "2609089"}]}