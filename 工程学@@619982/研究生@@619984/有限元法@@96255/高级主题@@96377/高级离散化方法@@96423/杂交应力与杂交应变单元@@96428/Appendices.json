{"hands_on_practices": [{"introduction": "实现混合有限元法需要精确地数值计算单元矩阵。本练习将引导你通过仔细计算被积函数的最高多项式次数，来确定精确积分所需的最小高斯积分阶数。掌握这项技能对于开发准确且计算高效的有限元程序至关重要。[@problem_id:2566136]", "problem": "考虑一个在有限元法 (FEM) 框架下，基于 Hellinger–Reissner (HR) 变分原理构建的二维杂交应力有限元。在父单元正方形 $[-1,1]^2$ 上，通过等参映射到物理单元，设位移场由每个父坐标方向上次数为 $r$ 的张量积 Lagrange 多项式近似，几何也使用相同的形函数进行等参映射。假设的应力场在父域中表示为一个应力模式矩阵 $M(\\xi,\\eta)$ 乘以一个应力参数向量，其中 $M(\\xi,\\eta)$ 的每个元素都是 $(\\xi,\\eta)$ 的多项式，其在每个父坐标方向上的次数最多为 $s$，其中 $s \\in \\mathbb{N}_0$。用 $S$ 表示常数柔度矩阵（平面应力或平面应变中弹性刚度张量的逆）。\n\n定义单元矩阵\n$$\nH \\;=\\; \\int_{\\Omega_e} M(\\xi,\\eta)^{\\mathsf{T}}\\, S\\, M(\\xi,\\eta)\\, \\mathrm{d}\\Omega,\n\\qquad\nG \\;=\\; \\int_{\\Omega_e} M(\\xi,\\eta)^{\\mathsf{T}}\\, B(\\xi,\\eta)\\, \\mathrm{d}\\Omega,\n$$\n其中 $B(\\xi,\\eta)$ 是标准的物理应变-位移矩阵，$\\mathrm{d}\\Omega$ 是物理面积微元。假设为一般的 $r$ 阶弯曲等参几何（即，不假设仿射映射）。\n\n您将通过变量替换到父正方形，使用每个父坐标方向上有 $m$ 个点的张量积 Gauss–Legendre (GL) 求积法（即 $m \\times m$ 法则）来计算这些积分。仅使用基本的多项式次数计数和一维 GL 求积的精确性（一个 $m$ 点 GL 法则对次数最高为 $2m-1$ 的多项式是精确的），确定保证对该等参族中任何单元的 $H$ 和 $G$ 都能精确积分的最小整数 $m$（作为 $r$ 和 $s$ 的显式函数）。以 $r$ 和 $s$ 的单个闭式表达式的形式给出您的答案。", "solution": "该问题要求确定在父正方形域 $[-1,1]^2$ 的每个方向上所需的 Gauss-Legendre 求积点的最小数量 $m$，以确保对一个二维杂交应力有限元的单元矩阵 $H$ 和 $G$ 进行精确积分。\n\n所用的求积法则是张量积 $m \\times m$ Gauss-Legendre 方案。一维 $m$ 点 Gauss-Legendre 法则可以精确积分任何次数最高为 $2m-1$ 的多项式。因此，$m \\times m$ 张量积法则可以精确积分任何二元多项式 $P(\\xi, \\eta)$，其中 $\\xi$ 的最高次数最多为 $2m-1$，$\\eta$ 的最高次数最多也为 $2m-1$。我们的任务是找出 $H$ 和 $G$ 的被积函数相对于每个父坐标 $\\xi$ 和 $\\eta$ 的最高多项式次数。\n\n令 $\\deg_\\xi(f)$ 和 $\\deg_\\eta(f)$ 分别表示函数 $f(\\xi, \\eta)$ 在变量 $\\xi$ 和 $\\eta$ 中的最高多项式次数。对于函数乘积，次数是次数之和：$\\deg_\\xi(f \\cdot g) = \\deg_\\xi(f) + \\deg_\\xi(g)$。对于函数和，次数是各部分次数的最大值。所需的求积阶数 $m$ 必须满足 $2m-1 \\ge \\max(\\deg_\\xi(\\text{被积函数}), \\deg_\\eta(\\text{被积函数}))$。\n\n积分是在物理单元域 $\\Omega_e$ 上进行的。我们必须首先使用等参映射 $\\mathbf{x}(\\xi, \\eta) = \\sum_k N_k(\\xi, \\eta) \\mathbf{x}_k$ 将积分转换到父域 $[-1,1]^2$ 上。面积微元转换为 $\\mathrm{d}\\Omega = \\det(J) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta$，其中 $J$ 是映射的 Jacobian 矩阵：\n$$\nJ(\\xi, \\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n用于几何的形函数 $N_k(\\xi, \\eta)$ 是每个坐标方向上次数为 $r$ 的张量积 Lagrange 多项式。因此，$\\deg_\\xi(N_k) = r$ 且 $\\deg_\\eta(N_k) = r$。形函数的导数次数为：\n$\\deg_\\xi(\\frac{\\partial N_k}{\\partial \\xi}) = r-1$, $\\deg_\\eta(\\frac{\\partial N_k}{\\partial \\xi}) = r$。\n$\\deg_\\xi(\\frac{\\partial N_k}{\\partial \\eta}) = r$, $\\deg_\\eta(\\frac{\\partial N_k}{\\partial \\eta}) = r-1$。\n\nJacobian 矩阵 $J$ 的元素是这些导数的线性组合。它们的次数是：\n$\\deg_\\xi(\\frac{\\partial x}{\\partial \\xi}) = r-1$, $\\deg_\\eta(\\frac{\\partial x}{\\partial \\xi}) = r$。\n$\\deg_\\xi(\\frac{\\partial x}{\\partial \\eta}) = r$, $\\deg_\\eta(\\frac{\\partial x}{\\partial \\eta}) = r-1$。\n这也适用于 $y$ 的导数。\n\nJacobian 矩阵的行列式为 $\\det(J) = \\frac{\\partial x}{\\partial \\xi} \\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial y}{\\partial \\xi} \\frac{\\partial x}{\\partial \\eta}$。我们通过检查每一项来确定其多项式次数。对于第一项 $\\frac{\\partial x}{\\partial \\xi} \\frac{\\partial y}{\\partial \\eta}$：\n$\\deg_\\xi = \\deg_\\xi(\\frac{\\partial x}{\\partial \\xi}) + \\deg_\\xi(\\frac{\\partial y}{\\partial \\eta}) = (r-1) + r = 2r-1$。\n$\\deg_\\eta = \\deg_\\eta(\\frac{\\partial x}{\\partial \\xi}) + \\deg_\\eta(\\frac{\\partial y}{\\partial \\eta}) = r + (r-1) = 2r-1$。\n第二项 $\\frac{\\partial y}{\\partial \\xi} \\frac{\\partial x}{\\partial \\eta}$ 具有相同的次数。因此，$\\det(J)$ 在每个变量中的最高次数为 $2r-1$。\n$\\deg_\\xi(\\det(J)) \\le 2r-1$ 且 $\\deg_\\eta(\\det(J)) \\le 2r-1$。\n\n现在，我们分析 $H$ 和 $G$ 的被积函数。\n\n1.  **$H$ 矩阵分析：**\n    $H$ 的积分为 $H_i = \\int_{-1}^1 \\int_{-1}^1 (M^{\\mathsf{T}} S M)_i \\, \\det(J) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta$，其中 $(\\cdot)_i$ 表示结果矩阵的一个元素。\n    应力模式矩阵 $M(\\xi, \\eta)$ 包含多项式元素，其次数满足 $\\deg_\\xi(M_{ij}) \\le s$ 和 $\\deg_\\eta(M_{ij}) \\le s$。柔度矩阵 $S$ 是常数。\n    乘积 $M^{\\mathsf{T}} S M$ 的元素将是 $M$ 中元素的乘积之和。$M^{\\mathsf{T}} S M$ 中任何元素的最高次数为：\n    $\\deg_\\xi(M^{\\mathsf{T}} S M) \\le s+s = 2s$。\n    $\\deg_\\eta(M^{\\mathsf{T}} S M) \\le s+s = 2s$。\n    被积函数为 $(M^{\\mathsf{T}} S M) \\det(J)$。被积函数多项式在每个变量中的最高次数为：\n    $\\deg_\\xi(\\text{integrand}_H) \\le \\deg_\\xi(M^{\\mathsf{T}} S M) + \\deg_\\xi(\\det(J)) \\le 2s + (2r-1) = 2r+2s-1$。\n    $\\deg_\\eta(\\text{integrand}_H) \\le 2r+2s-1$。\n    为实现精确积分，求积法则必须对该次数的多项式精确。令 $p_H = 2r+2s-1$。条件是 $2m-1 \\ge p_H$。\n    $2m-1 \\ge 2r+2s-1 \\implies 2m \\ge 2r+2s \\implies m \\ge r+s$。\n\n2.  **$G$ 矩阵分析：**\n    $G$ 的积分为 $G_i = \\int_{-1}^1 \\int_{-1}^1 (M^{\\mathsf{T}} B)_i \\, \\det(J) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta$。\n    应变-位移矩阵 $B(\\xi, \\eta)$ 将节点位移与物理应变联系起来。其元素由位移形函数 $N_k$ 的物理导数构成，这些形函数与几何形函数相同。物理导数使用 Jacobian 矩阵的逆 $J^{-1}$ 求得：\n    $$\n    \\begin{pmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{pmatrix} = J^{-1} \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{pmatrix} = \\frac{1}{\\det(J)} \\begin{pmatrix} \\frac{\\partial y}{\\partial \\eta} & -\\frac{\\partial y}{\\partial \\xi} \\\\ -\\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial x}{\\partial \\xi} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{pmatrix}\n    $$\n    例如，$B$ 中的一个元素形式为 $\\frac{\\partial N_k}{\\partial x} = \\frac{1}{\\det(J)} \\left( \\frac{\\partial y}{\\partial \\eta} \\frac{\\partial N_k}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi} \\frac{\\partial N_k}{\\partial \\eta} \\right)$。\n    $G$ 的被积函数为 $M^{\\mathsf{T}} B \\det(J)$。当我们代入 $B$ 的表达式时，$B$ 分母中的 $\\det(J)$ 与面积变换中的 $\\det(J)$ 相消。\n    被积函数$_G = M^{\\mathsf{T}} B_{num}$，其中 $B_{num}$ 是包含 $B$ 的元素分子的矩阵。\n    $B_{num}$ 中的一个元素，例如，是 $\\frac{\\partial y}{\\partial \\eta} \\frac{\\partial N_k}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi} \\frac{\\partial N_k}{\\partial \\eta}$。此表达式的多项式次数的确定方法与我们对 $\\det(J)$ 的处理方式相同：\n    $\\deg_\\xi(\\frac{\\partial y}{\\partial \\eta} \\frac{\\partial N_k}{\\partial \\xi}) = \\deg_\\xi(\\frac{\\partial y}{\\partial \\eta}) + \\deg_\\xi(\\frac{\\partial N_k}{\\partial \\xi}) = r + (r-1) = 2r-1$。\n    在 $\\eta$ 方向的次数也是 $2r-1$。$B_{num}$ 中的所有项在每个变量中的最高次数都是 $2r-1$。\n    $\\deg_\\xi(B_{num}) \\le 2r-1$ 且 $\\deg_\\eta(B_{num}) \\le 2r-1$。\n    $G$ 的被积函数是一个多项式 $M^{\\mathsf{T}} B_{num}$。其最高次数为：\n    $\\deg_\\xi(\\text{integrand}_G) \\le \\deg_\\xi(M) + \\deg_\\xi(B_{num}) \\le s + (2r-1) = 2r+s-1$。\n    $\\deg_\\eta(\\text{integrand}_G) \\le 2r+s-1$。\n    令 $p_G = 2r+s-1$。精确积分的条件是 $2m-1 \\ge p_G$。\n    $2m-1 \\ge 2r+s-1 \\implies 2m \\ge 2r+s \\implies m \\ge r + \\frac{s}{2}$。\n\n3.  **$m$ 的最终确定：**\n    为保证 $H$ 和 $G$ 的积分都能精确计算，$m$ 必须同时满足两个推导出的条件：\n    $m \\ge r+s$\n    $m \\ge r + \\frac{s}{2}$\n    我们必须选择更严格的条件。由于 $s \\in \\mathbb{N}_0$，我们有 $s \\ge 0$，这意味着 $s \\ge s/2$。因此，$r+s \\ge r+s/2$。\n    更严格的要求是 $m \\ge r+s$。\n    由于 $m$ 必须是整数，且 $r$ 和 $s$ 也是整数，因此 $m$ 的最小整数值为 $r+s$。", "answer": "$$\n\\boxed{r+s}\n$$", "id": "2566136"}, {"introduction": "任何有限元的一个关键基准是其通过“检验平台测试”(patch test)的能力，这确保了单元能够精确表示一个常数应力状态。本实践要求你运用连续介质力学的基本原理，来确定一个扭曲单元为了满足此测试所需的面力插值函数。这个练习展示了一个核心的验证原则，并加深了你对单元构造选择如何确保收敛性的理解。[@problem_id:2566178]", "problem": "考虑一个处于平面应力状态的二维面片，该面片由两个共享一条公共边的四节点等参四边形单元组成。单元$\\mathrm{E}_{1}$是一个单位正方形，在$\\left(x,y\\right)$平面内的节点位于$\\left(0,0\\right)$、$\\left(1,0\\right)$、$\\left(1,1\\right)$和$\\left(0,1\\right)$。单元$\\mathrm{E}_{2}$是一个附着在$\\mathrm{E}_{1}$右侧的凸扭曲四边形，其节点位于$\\left(1,0\\right)$、$\\left(2,-0.2\\right)$、$\\left(2.4,1.1\\right)$和$\\left(1,1\\right)$。这两个单元共享从$\\left(1,0\\right)$到$\\left(1,1\\right)$的竖直边。每个单元都通过双线性等参变换从双单位父正方形$\\left(\\xi,\\eta\\right)\\in[-1,1]\\times[-1,1]$映射而来。\n\n假设该面片承受一个恒定的物理应力状态\n$$\n\\boldsymbol{\\sigma}^{0}=\\begin{bmatrix}\\sigma_{xx}^{0} & \\tau_{xy}^{0}\\\\ \\tau_{xy}^{0} & \\sigma_{yy}^{0}\\end{bmatrix},\n$$\n其中$\\sigma_{xx}^{0}$、$\\sigma_{yy}^{0}$和$\\tau_{xy}^{0}$为任意常数。不存在体力。采用一种混合杂交格式，其中单元间的平衡通过在每个单元边上独立插值的边界牵引力场来强制施加。在任意边上，设边界牵引力插值是关于相应的一维自然边坐标$s\\in[-1,1]$的$p$次多项式。\n\n仅使用连续介质力学的基本原理和双线性等参映射的几何特性，确定扭曲单元$\\mathrm{E}_{2}$的边界牵引力插值所需的最小整数次数$p$，以使该双单元面片能够精确通过常应力分片检验（即，它能够以单元内平衡和相容的界面牵引力来表示精确的常应力状态$\\boldsymbol{\\sigma}^{0}$）。将你的最终答案表示为单个整数$p$。", "solution": "该问题要求确定在一个扭曲的四节点等参单元上，边界牵引力多项式插值的最小整数次数$p$，以使得该单元在混合杂交格式下能够通过常应力分片检验。\n\n常应力分片检验的核心原理是，有限元格式必须能够精确地、零误差地再现承受常应力状态的连续体的行为。在边界牵引力$\\mathbf{t}_h$被独立插值的混合杂交格式中，这要求假定的牵引力空间必须足够丰富，以包含由常应力状态在单元边界上产生的精确牵引力场。\n\n设常应力状态由张量$\\boldsymbol{\\sigma}^0$表示。根据连续介质力学中的柯西基本公式，作用在具有单位外法向量$\\mathbf{n}$的表面上的牵引力向量$\\mathbf{t}$由下式给出：\n$$\n\\mathbf{t} = \\boldsymbol{\\sigma}^0 \\cdot \\mathbf{n}\n$$\n由于$\\boldsymbol{\\sigma}^0$是常数张量，牵引力向量$\\mathbf{t}$沿单元边的变化仅由单位法向量$\\mathbf{n}$沿同一条边的变化决定。\n\n问题指明单元是四节点等参四边形。从父坐标$(\\xi, \\eta)$到物理坐标$(x,y)$的几何映射是双线性的：\n$$\n\\mathbf{x}(\\xi, \\eta) = \\begin{pmatrix} x(\\xi, \\eta) \\\\ y(\\xi, \\eta) \\end{pmatrix} = \\sum_{i=1}^{4} N_i(\\xi, \\eta) \\mathbf{x}_i\n$$\n其中$\\mathbf{x}_i$是节点坐标，$N_i(\\xi, \\eta)$是双线性形函数：\n$$\nN_i(\\xi, \\eta) = \\frac{1}{4}(1 + \\xi_i \\xi)(1 + \\eta_i \\eta)\n$$\n其中$(\\xi_i, \\eta_i)$是父域中第$i$个节点的坐标，例如$(-1,-1)$、$(1,-1)$、$(1,1)$、$(-1,1)$。\n\n这种双线性映射的一个基本特性是，它将父正方形的直边（其中一个坐标是常数，例如$\\xi=1$）映射到物理$(x,y)$域中的直线段。为了证明这一点，考虑一条边，其上$\\xi = \\xi_0$（其中$\\xi_0 = \\pm 1$），而$\\eta$变化。映射变为：\n$$\n\\mathbf{x}(\\xi_0, \\eta) = \\sum_{i=1}^{4} N_i(\\xi_0, \\eta) \\mathbf{x}_i = \\sum_{i=1}^{4} \\frac{1}{4}(1 + \\xi_i \\xi_0)(1 + \\eta_i \\eta) \\mathbf{x}_i\n$$\n此表达式是$\\eta$的线性函数。我们可以将其写成$\\mathbf{x}(\\eta) = \\mathbf{A} + \\mathbf{B}\\eta$的形式，其中$\\mathbf{A}$和$\\mathbf{B}$是常向量。这是一个直线的参数方程。对于$\\eta = \\eta_0 = \\pm 1$的边，同样成立。\n\n由于扭曲单元$\\mathrm{E}_2$的每条边都是一条直线，所以任何给定边的切向量沿其长度都是恒定的。因此，每条边的单位法向量$\\mathbf{n}$也沿该边恒定。\n\n由于应力张量$\\boldsymbol{\\sigma}^0$和法向量$\\mathbf{n}$在单元$\\mathrm{E}_2$的任何给定边上都是恒定的，物理牵引力向量$\\mathbf{t} = \\boldsymbol{\\sigma}^0 \\cdot \\mathbf{n}$也必定在每条边上是恒定的。\n\n假定的边界牵引力场$\\mathbf{t}_h$是沿每条边、以自然坐标$s \\in [-1,1]$的$p$次多项式进行插值的。为了精确通过分片检验，该插值必须能够表示真实的牵引力场。由于真实的牵引力场在每条边上都是一个常数向量，因此多项式插值必须能够表示一个常数函数。\n\n一个一般的$p$次多项式形式为$f(s) = c_0 + c_1 s + c_2 s^2 + \\dots + c_p s^p$。要表示一个常数函数，我们需要能够将$c_0$设置为所需的常数值，并将所有其他系数$c_i$（当$i > 0$时）设置为零。这当且仅当多项式基包含常数项时才可能。一个$p=0$次的多项式是一个常数函数，$f(s) = c_0$。这是能够精确表示任何常数值的最小次数。\n\n因此，边界牵引力插值所需的最小整数次数是$p=0$。$\\mathrm{E}_2$的扭曲几何形状是一个关键细节，因为已知它会导致许多单元格式失效，但这并不能改变其边界在双线性等参映射下是直线这一事实。这一几何事实是求解的关键。", "answer": "$$\\boxed{0}$$", "id": "2566178"}, {"introduction": "混合有限元的稳定性由关键的 Babuška–Brezzi (或 inf-sup) 条件所决定。本动手实践通过对比一个稳定单元和一个不稳定单元，清晰地展示了违反此条件的实际后果。通过特征值分析，你将直接观察到一个不充分的应力插值空间如何导致非物理的、零能量的“沙漏”模式，从而在高等理论与数值实践之间建立起切实的联系。[@problem_id:2566183]", "problem": "考虑二维线性弹性问题的双场 Hellinger–Reissner 泛函，其位移场 $u \\in \\mathcal{V}_h$，应力场 $\\sigma \\in \\Sigma_h$，表达式为\n$$\n\\Pi(u,\\sigma) \\;=\\; \\int_{\\Omega_e} \\sigma : \\varepsilon(u) \\,\\mathrm{d}\\Omega \\;-\\; \\tfrac{1}{2}\\int_{\\Omega_e} \\sigma : \\mathbb{C}^{-1} : \\sigma \\,\\mathrm{d}\\Omega \\;-\\; \\int_{\\Gamma_t\\cap \\partial\\Omega_e} t \\cdot u \\,\\mathrm{d}\\Gamma,\n$$\n其中 $\\varepsilon(u)$ 是 $u$ 的对称梯度，$\\mathbb{C}$ 是平面应变问题的四阶弹性张量，$\\Omega_e$ 是单个四边形单元。在杂交应力格式中，应力在单元内部通过假定应力模式进行插值，而位移仅存在于边界上（节点值）。设位移场由标准的双线性四节点四边形形函数插值，应力场通过假定应力矩阵 $P(\\xi,\\eta)$ 以 Voigt 记法表示为 $\\sigma = [\\sigma_{xx},\\sigma_{yy},\\tau_{xy}]^\\top$，使得 $\\sigma(\\xi,\\eta) = P(\\xi,\\eta)\\,\\beta$，其中 $\\beta$ 是应力参数向量。\n\n根据 $\\Pi(u,\\sigma)$ 的驻值条件，单元系统可以写成如下分块形式\n$$\n\\begin{bmatrix}\n0 & G^\\top \\\\\nG & -H\n\\end{bmatrix}\n\\begin{bmatrix}\nu_e \\\\ \\beta\n\\end{bmatrix}\n\\;=\\;\n\\begin{bmatrix}\nf_e \\\\ 0\n\\end{bmatrix},\n$$\n其中\n$$\nG \\;=\\; \\int_{\\Omega_e} P(\\xi,\\eta)^\\top\\,B(\\xi,\\eta)\\,\\mathrm{d}\\Omega, \n\\qquad\nH \\;=\\; \\int_{\\Omega_e} P(\\xi,\\eta)^\\top\\,\\mathbb{C}^{-1}\\,P(\\xi,\\eta)\\,\\mathrm{d}\\Omega,\n$$\n这里 $B(\\xi,\\eta)$ 是四节点双线性单元的标准的 $3\\times 8$ 应变-位移矩阵。对 $\\beta$ 进行静力凝聚，可得到凝聚单元刚度\n$$\nK_e \\;=\\; G^\\top H^{-1} G.\n$$\n为保证单元上混合格式的稳定性，Babuška–Brezzi (inf–sup) 条件要求\n$$\n\\inf_{\\sigma \\in \\Sigma_h} \\sup_{u \\in \\mathcal{V}_h} \\frac{\\int_{\\Omega_e} \\sigma : \\varepsilon(u)\\,\\mathrm{d}\\Omega}{\\|\\sigma\\|_{0,\\Omega_e}\\,\\|u\\|_{1,\\Omega_e}} \\;\\ge\\; \\beta_0 \\;>\\; 0,\n$$\n对于某个与网格无关的常数 $\\beta_0$ 成立。如果此条件不满足，$G$ 会发生秩亏，因此 $K_e$ 在刚体模态之外会变得奇异，并表现出零能（沙漏状）伪模态。\n\n您的任务是使用上述框架，在单个四边形上构造并分析两种杂交应力单元：\n\n- 一个不稳定的单元，它通过采用一个由常应力组成的、过于贫乏的应力空间 $\\Sigma_h$ 来违背 inf-sup 条件，即\n$$\nP_{\\text{const}}(\\xi,\\eta) \\;=\\; \n\\begin{bmatrix}\n1 & 0 & 0\\\\\n0 & 1 & 0\\\\\n0 & 0 & 1\n\\end{bmatrix},\n$$\n因此 $\\beta \\in \\mathbb{R}^3$。\n\n- 一个表达能力更强的单元，它在相同的位移空间上满足 inf-sup 条件，通过采用一个具有弱线性变化的五参数应力模式，\n$$\nP_{\\text{lin5}}(\\xi,\\eta) \\;=\\;\n\\begin{bmatrix}\n1 & 0 & 0 & \\xi & 0\\\\\n0 & 1 & 0 & 0 & \\eta\\\\\n0 & 0 & 1 & 0 & 0\n\\end{bmatrix},\n$$\n因此 $\\beta \\in \\mathbb{R}^5$。\n\n在物理空间中具有节点 $\\{(X_i,Y_i)\\}_{i=1}^4$ 和自然坐标 $(\\xi,\\eta)\\in[-1,1]^2$ 的四边形上，使用标准的等参双线性位移插值。设弹性材料为各向同性、平面应变，其 Young 模量为 $E$，Poisson 比为 $\\nu$，因此\n$$\n\\lambda \\;=\\; \\frac{\\nu E}{(1+\\nu)(1-2\\nu)}, \n\\qquad\n\\mu \\;=\\; \\frac{E}{2(1+\\nu)},\n$$\n并且在使用工程剪应变 $\\gamma_{xy}$ 的 Voigt 记法中，本构矩阵为\n$$\n\\mathbb{C} \\;=\\;\n\\begin{bmatrix}\n\\lambda + 2\\mu & \\lambda & 0 \\\\\n\\lambda & \\lambda + 2\\mu & 0 \\\\\n0 & 0 & \\mu\n\\end{bmatrix}.\n$$\n使用 $\\mathbb{C}^{-1}$ 构成 $H$。通过精确数值积分（使用 $2\\times 2$ 点的张量积 Gauss 积分）组装 $K_e = G^\\top H^{-1} G$。对 $K_e$ 进行特征值分析，确定其零空间的维数，并减去刚体模态以计算沙漏状零能模态的数量。取由两个平动和一个绕单元形心的面内转动所张成的刚体空间。\n\n实现一个程序，构造 $K_e$，计算其特征对，并对以下四个测试用例中的每一个，识别沙漏模态的数量（坐标以米为单位，但最终答案是无量纲的计数）：\n\n- 测试用例 1（不稳定，方形）：$E=210\\times 10^9$，$\\nu=0.3$，节点 $(-1,-1)$、$(1,-1)$、$(1,1)$、$(-1,1)$，应力模式 $P_{\\text{const}}$。\n- 测试用例 2（稳定，方形）：与测试用例 1 相同，但应力模式为 $P_{\\text{lin5}}$。\n- 测试用例 3（不稳定，轻度扭曲）：$E=210\\times 10^9$，$\\nu=0.3$，节点 $(-1.0,-1.0)$、$(1.2,-0.8)$、$(1.1,1.1)$、$(-1.1,0.9)$，应力模式 $P_{\\text{const}}$。\n- 测试用例 4（稳定，轻度扭曲）：与测试用例 3 相同，但应力模式为 $P_{\\text{lin5}}$。\n\n对于每个测试用例，计算 $K_e$ 的特征值，若特征值小于容差 $\\varepsilon = 10^{-8}\\,\\lambda_{\\max}$，则判定其为零，其中 $\\lambda_{\\max}$ 是该测试中 $K_e$ 的最大特征值。设 $n_0$ 为零特征值的数量，$n_{\\text{rbm}}$ 为零空间与刚体模态空间交集的维数；定义沙漏模态计数为 $n_{\\text{hg}} = n_0 - n_{\\text{rbm}}$。您的程序必须在单行中输出一个 Python 风格的列表，其中包含四个测试用例对应的四个整数 $[n_{\\text{hg},1}, n_{\\text{hg},2}, n_{\\text{hg},3}, n_{\\text{hg},4}]$，不带任何附加文本。\n\n所有数学推导都必须从 Hellinger–Reissner 泛函以及 $\\mathbb{C}$、$\\lambda$、$\\mu$、$B(\\xi,\\eta)$、$P(\\xi,\\eta)$、$G$ 和 $H$ 的定义出发。请勿使用超出这些定义的任何捷径公式，并确保所有数值积分都按规定使用精确的 Gauss 积分执行。最终答案是无量纲整数，输出中不应出现物理单位。", "solution": "我们从二维 Hellinger–Reissner 泛函开始，\n$$\n\\Pi(u,\\sigma) \\;=\\; \\int_{\\Omega_e} \\sigma : \\varepsilon(u)\\,\\mathrm{d}\\Omega \\;-\\; \\tfrac{1}{2}\\int_{\\Omega_e}\\sigma:\\mathbb{C}^{-1}:\\sigma\\,\\mathrm{d}\\Omega \\;-\\; \\int_{\\Gamma_t \\cap \\partial\\Omega_e} t \\cdot u\\,\\mathrm{d}\\Gamma,\n$$\n其中 $u$ 由四节点四边形的双线性形函数插值，$\\sigma$ 在 $\\Sigma_h$ 中独立地插值为 $\\sigma(\\xi,\\eta) = P(\\xi,\\eta)\\,\\beta$，参数矢量为 $\\beta$。在采用工程剪应变的 Voigt 记法中，我们写出 $\\varepsilon(u) = B(\\xi,\\eta)\\,u_e$，其中 $B(\\xi,\\eta)$ 是用于等参双线性映射的标准的 $3\\times 8$ 应变-位移矩阵，通过形函数对物理坐标的导数构造，即\n$$\nB(\\xi,\\eta) \\;=\\;\n\\begin{bmatrix}\n\\frac{\\partial N_1}{\\partial x} & 0 & \\cdots & \\frac{\\partial N_4}{\\partial x} & 0 \\\\\n0 & \\frac{\\partial N_1}{\\partial y} & \\cdots & 0 & \\frac{\\partial N_4}{\\partial y} \\\\\n\\frac{\\partial N_1}{\\partial y} & \\frac{\\partial N_1}{\\partial x} & \\cdots & \\frac{\\partial N_4}{\\partial y} & \\frac{\\partial N_4}{\\partial x}\n\\end{bmatrix}.\n$$\n$\\Pi$ 关于 $u_e$ 和 $\\beta$ 的驻值条件给出单元系统\n$$\n\\frac{\\partial \\Pi}{\\partial u_e} \\;=\\; \\int_{\\Omega_e} B(\\xi,\\eta)^\\top \\sigma(\\xi,\\eta)\\,\\mathrm{d}\\Omega \\;-\\; f_e \\;=\\; 0,\n\\qquad\n\\frac{\\partial \\Pi}{\\partial \\beta} \\;=\\; \\int_{\\Omega_e} P(\\xi,\\eta)^\\top \\varepsilon(u)\\,\\mathrm{d}\\Omega \\;-\\; \\int_{\\Omega_e} P(\\xi,\\eta)^\\top \\mathbb{C}^{-1} P(\\xi,\\eta)\\,\\beta\\,\\mathrm{d}\\Omega \\;=\\; 0.\n$$\n引入\n$$\nG \\;=\\; \\int_{\\Omega_e} P(\\xi,\\eta)^\\top B(\\xi,\\eta)\\,\\mathrm{d}\\Omega,\n\\qquad\nH \\;=\\; \\int_{\\Omega_e} P(\\xi,\\eta)^\\top \\mathbb{C}^{-1} P(\\xi,\\eta)\\,\\mathrm{d}\\Omega,\n$$\n并注意到 $\\sigma(\\xi,\\eta) = P(\\xi,\\eta)\\,\\beta$，我们写出鞍点线性系统\n$$\n\\begin{bmatrix}\n0 & G^\\top \\\\\nG & -H\n\\end{bmatrix}\n\\begin{bmatrix}\nu_e \\\\ \\beta\n\\end{bmatrix}\n\\;=\\;\n\\begin{bmatrix}\nf_e \\\\ 0\n\\end{bmatrix}.\n$$\n通过求解 $G u_e - H \\beta = 0 \\Rightarrow \\beta = H^{-1} G u_e$ 进行静力凝聚消去 $\\beta$，将其代入第一个分块方程，得到凝聚单元刚度\n$$\nK_e \\;=\\; G^\\top H^{-1} G.\n$$\nBabuška–Brezzi inf-sup 条件\n$$\n\\inf_{\\sigma \\in \\Sigma_h} \\sup_{u \\in \\mathcal{V}_h} \\frac{\\int_{\\Omega_e} \\sigma : \\varepsilon(u)\\,\\mathrm{d}\\Omega}{\\|\\sigma\\|_{0,\\Omega_e}\\,\\|u\\|_{1,\\Omega_e}} \\;\\ge\\; \\beta_0 \\;>\\; 0\n$$\n确保了混合有限元的稳定性。在代数上，它要求当 $\\Sigma_h$ 与 $\\mathcal{V}_h$ 配对时，$G$ 在 $\\Sigma_h$ 上具有满列秩，因此 $G$ 在 $\\Sigma_h^\\top$ 上是单射的，且 Schur 补 $K_e = G^\\top H^{-1} G$ 是半正定的，其零空间恰好由刚体模态组成。如果该条件不满足，则存在非零的 $u_e$ 使得 $G u_e = 0$，这意味着 $K_e u_e = 0$，从而产生伪零能（沙漏状）模态。\n\n为使此具体化，我们考虑 $P(\\xi,\\eta)$ 的两种选择：\n\n1. 一个不稳定的、欠丰富的常应力空间，\n$$\nP_{\\text{const}}(\\xi,\\eta) \\;=\\;\n\\begin{bmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{bmatrix},\n$$\n因此 $\\beta \\in \\mathbb{R}^3$。在这种情况下，$G$ 是对常数积分 $B$，因此其秩不能超过 $3$。对于具有八个位移自由度的四节点双线性四边形，凝聚刚度 $K_e$ 的秩至多为 $3$，这意味着其零空间的维数至少为 $8-3=5$。在这五个模态中，正好有三个对应于刚体运动（两个平动和一个面内转动），剩下至少两个伪零能模态。这些就是众所周知的沙漏模态：它们是在单元上导致三个 Voigt 分量的平均应变为零的位移模式，因此对任何常应力场产生的内虚功为零。这直接表现出对 inf-sup 条件的违背，因为对于非平凡的 $u$ 和应力空间中的任何 $\\sigma$，分子 $\\int_{\\Omega_e} \\sigma : \\varepsilon(u)\\,\\mathrm{d}\\Omega$ 可为零，导致 $\\beta_0 = 0$。\n\n2. 一个表达能力更强的、具有弱线性变化的五参数应力空间，\n$$\nP_{\\text{lin5}}(\\xi,\\eta) \\;=\\;\n\\begin{bmatrix}\n1 & 0 & 0 & \\xi & 0 \\\\\n0 & 1 & 0 & 0 & \\eta \\\\\n0 & 0 & 1 & 0 & 0\n\\end{bmatrix},\n$$\n因此 $\\beta \\in \\mathbb{R}^5$。这里，$G$ 的秩增加到至多为 $5$，对于非退化的四边形， $P_{\\text{lin5}}$ 的五列与双线性的 $B$ 非平凡地耦合，因此 $G$ 通常能达到秩 $5$。因此，$K_e$ 的秩为 $5$，其零空间维数为 $8-5=3$，这恰好与刚体模态相匹配，不留下任何伪模态。这满足了单元上的 inf-sup 条件，且 $\\beta_0 > 0$。\n\n数值构造过程如下：\n\n- 使用双线性形函数 $N_i(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi\\xi_i)(1+\\eta\\eta_i)$，其中 $(\\xi_i,\\eta_i)\\in\\{(-1,-1),(1,-1),(1,1),(-1,1)\\}$，建立从 $(\\xi,\\eta)\\in[-1,1]^2$ 到物理坐标的等参映射。计算 Jacobian 矩阵 $J(\\xi,\\eta)$ 及其行列式。通过 $J^{-1}$ 从 $\\partial N_i/\\partial \\xi$ 和 $\\partial N_i/\\partial \\eta$ 计算 $\\partial N_i/\\partial x$ 和 $\\partial N_i/\\partial y$。\n\n- 从物理导数构成 $B(\\xi,\\eta)$，并使用 $2\\times 2$ Gauss 积分来计算 $G = \\int P^\\top B\\,\\mathrm{d}\\Omega$ 和 $H = \\int P^\\top \\mathbb{C}^{-1} P\\,\\mathrm{d}\\Omega$，该积分对于此处出现的多项式次数（被积函数中至多为二次）是精确的。\n\n- 计算凝聚刚度 $K_e = G^\\top H^{-1} G$。\n\n- 求解特征问题 $K_e \\phi_i = \\lambda_i \\phi_i$，若特征值 $\\lambda_i < \\varepsilon = 10^{-8} \\lambda_{\\max}$（其中 $\\lambda_{\\max} = \\max_i \\lambda_i$），则判定其为零。设 $n_0$ 为此类零特征值的数量。在单元上构造刚体模态基，作为 $\\mathbb{R}^8$ 中的三个向量：$x$ 和 $y$ 方向的两个平动（所有节点处单位位移），以及一个绕形心 $(\\bar X,\\bar Y)$ 的面内转动（在节点 $i$ 处由 $u_x = -(Y_i-\\bar Y)$ 和 $u_y = (X_i-\\bar X)$ 给出）。设 $N_0$ 是张成零空间（对应零特征值）的特征向量矩阵。零空间与刚体模态空间交集的有效维数 $n_{\\text{rbm}}$ 是 $N_0^\\top R$ 的数值秩，其中 $R$ 是 $8\\times 3$ 的刚体基。沙漏计数为 $n_{\\text{hg}} = n_0 - n_{\\text{rbm}}$。\n\n将此应用于四个指定的测试：\n\n- 测试用例 1（不稳定，方形），使用 $P_{\\text{const}}$：我们期望 $\\operatorname{rank}(G)=3$，因此 $n_0=5$，沙漏模态数为 $n_{\\text{hg}}=5-3=2$。\n\n- 测试用例 2（稳定，方形），使用 $P_{\\text{lin5}}$：我们期望 $\\operatorname{rank}(G)=5$，因此 $n_0=3$，$n_{\\text{hg}}=0$。\n\n- 测试用例 3（不稳定，扭曲），使用 $P_{\\text{const}}$：几何扭曲会改变 $B$，但不会将 $G$ 的最大秩增加到超过 $3$，因此 $n_0=5$，$n_{\\text{hg}}=2$ 保持不变。\n\n- 测试用例 4（稳定，扭曲），使用 $P_{\\text{lin5}}$：耦合仍然足以使 $\\operatorname{rank}(G)=5$，因此 $n_0=3$，$n_{\\text{hg}}=0$。\n\n因此，该算法为每个测试用例计算沙漏模态数（一个整数）。最终程序输出一个单行，其中包含四个整数的 Python 风格列表，即 $[n_{\\text{hg},1},n_{\\text{hg},2},n_{\\text{hg},3},n_{\\text{hg},4}]$。", "answer": "[2,0,2,0]", "id": "2566183"}]}