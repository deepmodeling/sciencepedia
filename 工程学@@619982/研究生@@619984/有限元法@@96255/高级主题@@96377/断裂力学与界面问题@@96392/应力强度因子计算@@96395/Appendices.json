{"hands_on_practices": [{"introduction": "我们首先从一个基本练习开始，它将巩固你对断裂力学中两个核心参数——能量释放率 ($J$积分) 和应力强度因子 (SIF, $K$) 之间关系的理解。这个练习要求你运用它们之间的基本换算公式，在平面应力与平面应变这两种理想化二维假设下，分别从一个给定的 $J$ 积分值计算出I型应力强度因子 $K_I$。这项实践不仅能让你熟练掌握线性弹性断裂力学 (LEFM) 的基础知识，还能让你深刻体会到选择不同二维简化模型对计算结果的具体影响。[@problem_id:2602833]", "problem": "考虑一个二维线性弹性断裂力学分析，该分析使用有限元法 (FEM) 对一个具有固定几何形状和载荷的含裂纹板进行。分析得到了收敛的路径无关 $J$ 积分的域积分评估值，为 $J = 2{,}500\\,\\text{N/m}$。材料是均匀各向同性的，其杨氏模量 $E = 210\\,\\text{GPa}$，泊松比 $\\nu = 0.30$。假设 $J$ 积分是在小范围屈服区内评估的，并且裂纹承受纯 I 型载荷。\n\n仅使用 $J$ 积分作为能量释放率的基本定义以及线性弹性断裂力学的近尖端渐近场，确定对应于以下两种情况的 I 型应力强度因子 $K_I$：\n- 平面应力，和\n- 平面应变。\n\n将每个 $K_I$ 以 $\\text{MPa}\\sqrt{\\text{m}}$ 为单位表示，并四舍五入到四位有效数字。\n\n然后，对于相同的几何形状和外部载荷，定性讨论在平面应力和平面应变理想化下计算的 $K_I$ 是否存在差异，并解释 $J$ 积分在该比较中的作用。\n\n最后，为了量化若对两种理想化情况使用相同的 $J$ 数值所引入的表观差异，报告平面应变与平面应力应力强度因子之比 $\\displaystyle \\frac{K_{I,\\text{psn}}}{K_{I,\\text{pst}}}$，并四舍五入到四位有效数字。将此比率作为你的最终答案（无量纲）。", "solution": "所述问题具有科学依据，提法恰当，并包含足够的信息以获得唯一解。我们将着手进行分析。\n\n路径无关 $J$ 积分与 I 型应力强度因子 $K_I$ 之间的关系是线性弹性断裂力学 (LEFM) 中的一个基本概念。$J$ 积分表示裂纹扩展的能量释放率。对于线性弹性、各向同性且均匀的材料，此关系由下式给出：\n$$ J = \\frac{K_I^2}{E'} $$\n此处，$E'$ 是有效杨氏模量，其定义对于平面应力和平面应变这两种二维理想化情况是不同的。\n\n对于**平面应力**，这是一种适用于薄板的近似，其中面外应力分量可忽略不计 ($\\sigma_{zz} = \\sigma_{xz} = \\sigma_{yz} = 0$)，有效模量等于杨氏模量 $E$：\n$$ E'_{\\text{pst}} = E $$\n对于**平面应变**，这适用于厚板，其中面外应变受到约束 ($\\epsilon_{zz} = \\epsilon_{xz} = \\epsilon_{yz} = 0$)，材料表现出更大的面内刚度。有效模量为：\n$$ E'_{\\text{psn}} = \\frac{E}{1 - \\nu^2} $$\n其中 $\\nu$ 是泊松比。\n\n我们已知的数值如下：\n- $J$ 积分：$J = 2{,}500\\,\\text{N/m}$\n- 杨氏模量：$E = 210\\,\\text{GPa} = 210 \\times 10^9\\,\\text{N/m}^2$\n- 泊松比：$\\nu = 0.30$\n\n现在我们可以通过重新整理公式为 $K_I = \\sqrt{J E'}$ 来计算每种情况下的 $K_I$ 值。\n\n**平面应力下 $K_I$ 的计算**\n\n对于平面应力条件，我们使用 $E' = E$。\n$$ K_{I,\\text{pst}} = \\sqrt{J E} = \\sqrt{(2{,}500\\,\\text{N/m}) \\times (210 \\times 10^9\\,\\text{N/m}^2)} $$\n$$ K_{I,\\text{pst}} = \\sqrt{5.25 \\times 10^{14}\\,\\text{N}^2/\\text{m}^3} \\approx 2.2912878 \\times 10^7\\,\\text{N/m}^{3/2} $$\n为了将结果以 $\\text{MPa}\\sqrt{\\text{m}}$ 为单位表示，我们使用转换关系 $1\\,\\text{MPa}\\sqrt{\\text{m}} = 10^6\\,\\text{N/m}^{3/2}$。\n$$ K_{I,\\text{pst}} \\approx \\frac{2.2912878 \\times 10^7}{10^6}\\,\\text{MPa}\\sqrt{\\text{m}} \\approx 22.912878\\,\\text{MPa}\\sqrt{\\text{m}} $$\n四舍五入到四位有效数字，我们得到 $K_{I,\\text{pst}} = 22.91\\,\\text{MPa}\\sqrt{\\text{m}}$。\n\n**平面应变下 $K_I$ 的计算**\n\n对于平面应变条件，我们使用 $E' = E / (1-\\nu^2)$。\n$$ K_{I,\\text{psn}} = \\sqrt{J \\frac{E}{1 - \\nu^2}} = \\sqrt{(2{,}500\\,\\text{N/m}) \\times \\frac{210 \\times 10^9\\,\\text{N/m}^2}{1 - (0.30)^2}} $$\n$$ K_{I,\\text{psn}} = \\sqrt{\\frac{5.25 \\times 10^{14}}{0.91}\\,\\text{N}^2/\\text{m}^3} \\approx \\sqrt{5.7692307 \\times 10^{14}\\,\\text{N}^2/\\text{m}^3} \\approx 2.4019223 \\times 10^7\\,\\text{N/m}^{3/2} $$\n转换为 $\\text{MPa}\\sqrt{\\text{m}}$：\n$$ K_{I,\\text{psn}} \\approx \\frac{2.4019223 \\times 10^7}{10^6}\\,\\text{MPa}\\sqrt{\\text{m}} \\approx 24.019223\\,\\text{MPa}\\sqrt{\\text{m}} $$\n四舍五入到四位有效数字，得到 $K_{I,\\text{psn}} = 24.02\\,\\text{MPa}\\sqrt{\\text{m}}$。\n\n**定性讨论**\n\n问题要求对*相同几何形状和外部载荷*下，为平面应力和平面应变计算出的 $K_I$ 之间的差异进行定性讨论。在线性弹性理论中，应力强度因子 $K_I$ 是弹性应力场奇点的一个参数，由几何形状和载荷条件定义。根据其定义 $K_I = \\lim_{r\\to 0} \\sigma_{yy}(r, \\theta=0)\\sqrt{2\\pi r}$，其值与材料属性（如 $E$ 和 $\\nu$）无关，因此也与假设是平面应力还是平面应变状态无关。因此，对于一个在固定载荷下的给定含裂纹体， $K_I$ 的值是相同的。\n\n然而，能量释放率 $J$ 并*不*相同。对于一个固定的 $K_I$，$J$ 和 $K_I$ 之间的关系清楚地表明了这一点：\n$$ J_{\\text{pst}} = \\frac{K_I^2}{E} \\quad \\text{和} \\quad J_{\\text{psn}} = \\frac{K_I^2(1-\\nu^2)}{E} $$\n由于对大多数材料而言 $0 < \\nu < 0.5$，所以 $(1-\\nu^2)$ 小于 1。因此，对于相同的 $K_I$，我们必然有 $J_{\\text{psn}} < J_{\\text{pst}}$。这意味着，对于相同的载荷和几何形状，在平面应变条件下进行的有限元分析所得到的 $J$ 积分数值会低于在平面应力条件下进行的分析。\n\n因此，问题中对两种理想化情况使用单一 $J$ 数值的假设，是为了本练习目的而设立的一个假设性构想。它并不代表单个试样的自洽物理模型，而是用来说明在两种理想化状态下 $J$ 和 $K_I$ 之间不同的代数转换关系。\n\n**比率计算**\n\n最后，我们需要根据问题中单一 $J$ 值的构想来计算比率 $\\frac{K_{I,\\text{psn}}}{K_{I,\\text{pst}}}$。使用推导出的 $K_I$ 表达式：\n$$ K_{I,\\text{psn}} = \\sqrt{\\frac{J E}{1 - \\nu^2}} $$\n$$ K_{I,\\text{pst}} = \\sqrt{J E} $$\n该比率通过直接相除得出：\n$$ \\frac{K_{I,\\text{psn}}}{K_{I,\\text{pst}}} = \\frac{\\sqrt{\\frac{J E}{1 - \\nu^2}}}{\\sqrt{J E}} = \\sqrt{\\frac{1}{1 - \\nu^2}} = \\frac{1}{\\sqrt{1 - \\nu^2}} $$\n这表明，对于一个给定的 $J$ 积分值，在平面应变条件下推断出的应力强度因子必然更高。代入 $\\nu = 0.30$：\n$$ \\frac{K_{I,\\text{psn}}}{K_{I,\\text{pst}}} = \\frac{1}{\\sqrt{1 - (0.30)^2}} = \\frac{1}{\\sqrt{1 - 0.09}} = \\frac{1}{\\sqrt{0.91}} \\approx 1.0482848... $$\n将此无量纲量四舍五入到四位有效数字，得到 $1.048$。", "answer": "$$\n\\boxed{1.048}\n$$", "id": "2602833"}, {"introduction": "在掌握了基本换算之后，我们进入一个更贴近工程实践的练习：验证。这个练习模拟了有限元软件开发或使用中的一个关键环节——将数值计算结果与已知的解析解进行对比，以评估其准确性。你将需要首先推导并计算一个倾斜裂纹在双轴远场应力作用下的精确解析解 $K_I$ 和 $K_{II}$，然后用它来量化一组模拟的“有限元提取值”的误差，包括I型、II型分量以及重要的混合模式角。通过这项练习，你将学会如何设计并执行一个完整的验证测试，这是确保计算分析可靠性的基石，同时也能加深你对混合模式断裂问题的理解。[@problem_id:2602853]", "problem": "设计一个完全指定、自洽的验证实验，使用有限元法（FEM）提取线性弹性固体中的应力强度因子。考虑一个无限大板的理想化模型，该板内嵌一个半长为 $a$ 的直裂纹，处于均匀、各向同性、线性弹性的介质中，承受远场平面应力。该裂纹沿一条直线分布，其单位切线方向与全局 $x$ 轴的夹角为 $\\beta$（从全局 $x$ 轴到裂纹切线，逆时针方向测量）。远场柯西应力张量是均匀的，其在全局基下的分量为 $\\sigma_x$、$\\sigma_y$ 和 $\\tau_{xy}$。任务是，对于一组测试用例，基于第一性原理计算解析的模式I和模式II应力强度因子 $K_I$ 和 $K_{II}$，将它们与给定的“提取”值（代表从有限元法后处理器获得的值）进行比较，并分别量化 $K_I$ 和 $K_{II}$ 以及混合模式角的精度。\n\n使用以下经过充分检验的基本原理：\n- 作用在单位法向量为 $\\mathbf{n}$ 的平面上的牵引力矢量 $\\mathbf{t}$ 满足 $\\mathbf{t} = \\boldsymbol{\\sigma} \\mathbf{n}$，其中 $\\boldsymbol{\\sigma}$ 是柯西应力张量。\n- 对于单位法向量为 $\\mathbf{n} = (-\\sin\\beta, \\cos\\beta)$、切向量为 $\\mathbf{t}_\\tau = (\\cos\\beta, \\sin\\beta)$ 的平面，作用在该平面上的法向牵引力 $\\sigma_n$ 和面内剪切牵引力 $\\tau_{nt}$ 可通过柯西应力变换获得，并可由 $\\sigma_x$、$\\sigma_y$、$\\tau_{xy}$ 和 $\\beta$ 计算得出。\n- 对于一个半长为 $a$ 的直裂纹的无限大板，在其表面受到均匀牵引力加载时，近尖端渐近场表明模式I和模式II应力强度因子分别与施加的裂纹面法向和剪切牵引力成正比，即 $K_I \\propto \\sigma_n \\sqrt{\\pi a}$ 和 $K_{II} \\propto \\tau_{nt} \\sqrt{\\pi a}$。在线性弹性理论中，叠加原理使得这些关系在将远场应力分解到裂纹平面后，同样适用于当前的远场加载配置。\n\n您的程序必须对下面的每个测试用例执行以下操作：\n1. 使用柯西应力变换，将远场应力 $(\\sigma_x,\\sigma_y,\\tau_{xy})$ 分解为裂纹平面的法向和切向分量，以获得 $\\sigma_n(\\beta)$ 和 $\\tau_{nt}(\\beta)$。\n2. 由此计算出解析的模式I和模式II应力强度因子 $K_I = \\sigma_n \\sqrt{\\pi a}$ 和 $K_{II} = \\tau_{nt} \\sqrt{\\pi a}$。\n3. 计算解析的混合模式角 $\\psi = \\operatorname{atan2}(K_{II}, K_I)$，单位为弧度。\n4. 与提供的“提取”值 $K_I^{\\mathrm{ext}}$ 和 $K_{II}^{\\mathrm{ext}}$（模拟有限元法后处理结果）进行比较，并量化：\n   - $K_I$ 的相对误差，定义为 $e_I = \\lvert K_I^{\\mathrm{ext}} - K_I \\rvert / \\lvert K_I \\rvert$（当 $\\lvert K_I \\rvert > 0$ 时）。\n   - $K_{II}$ 的相对误差，定义为 $e_{II} = \\lvert K_{II}^{\\mathrm{ext}} - K_{II} \\rvert / \\lvert K_{II} \\rvert$（当 $\\lvert K_{II} \\rvert > 0$ 时）。\n   - 如果任一模式的解析目标值恰好为零，则通过一个特征尺度 $K_0 = \\sqrt{\\pi a}\\,\\sigma_{\\mathrm{ref}}$ 对绝对误差进行归一化，以获得无量纲误差。使用 $\\sigma_{\\mathrm{ref}} = \\max(\\lvert \\sigma_x \\rvert, \\lvert \\sigma_y \\rvert, \\lvert \\tau_{xy} \\rvert)$，即如果 $K_I = 0$，则 $e_I = \\lvert K_I^{\\mathrm{ext}} - K_I \\rvert / K_0$；如果 $K_{II} = 0$，则对 $e_{II}$ 进行类似处理。\n   - 混合模式角的绝对误差，定义为 $\\Delta \\psi = \\lvert \\mathrm{wrap}_{[-\\pi,\\pi]}(\\psi^{\\mathrm{ext}} - \\psi) \\rvert$，其中 $\\psi^{\\mathrm{ext}} = \\operatorname{atan2}(K_{II}^{\\mathrm{ext}}, K_I^{\\mathrm{ext}})$，$\\mathrm{wrap}_{[-\\pi,\\pi]}$ 函数将角度包装到 $[-\\pi,\\pi]$ 区间内，以避免分支不连续性。\n5. 输入角度 $\\beta$ 必须以度为单位解释，而 $\\psi$ 和 $\\Delta\\psi$ 则以弧度为单位。应力单位必须是帕斯卡（Pascals），长度单位是米（meters），应力强度因子单位是 $\\mathrm{Pa}\\sqrt{\\mathrm{m}}$。将误差度量 $e_I$ 和 $e_{II}$ 作为无量纲小数输出，$\\Delta\\psi$ 以弧度输出。\n\n测试套件：\n- 案例1（双轴正向加载，混合模式）：\n  - $a = 0.02\\,\\mathrm{m}$，$\\beta = 30^\\circ$，$\\sigma_x = 120\\times 10^6\\,\\mathrm{Pa}$，$\\sigma_y = 30\\times 10^6\\,\\mathrm{Pa}$，$\\tau_{xy} = 0\\,\\mathrm{Pa}$。\n  - 提取值定义为 $K_I^{\\mathrm{ext}} = (1.01)\\,K_I$，$K_{II}^{\\mathrm{ext}} = (0.98)\\,K_{II}$。\n- 案例2（垂直于裂纹的单轴正向加载，解析上为纯模式I）：\n  - $a = 0.01\\,\\mathrm{m}$，$\\beta = 0^\\circ$，$\\sigma_x = 0\\,\\mathrm{Pa}$，$\\sigma_y = 30\\times 10^6\\,\\mathrm{Pa}$，$\\tau_{xy} = 0\\,\\mathrm{Pa}$。\n  - 令 $K_0 = \\sqrt{\\pi a}\\,\\sigma_{\\mathrm{ref}}$，其中 $\\sigma_{\\mathrm{ref}} = \\max(\\lvert \\sigma_x \\rvert, \\lvert \\sigma_y \\rvert, \\lvert \\tau_{xy} \\rvert)$。定义提取值为 $K_I^{\\mathrm{ext}} = (0.995)\\,K_I$，$K_{II}^{\\mathrm{ext}} = (0.01)\\,K_0$。\n- 案例3（等双轴正向加载，解析上为纯模式I且与 $\\beta$ 无关）：\n  - $a = 0.015\\,\\mathrm{m}$，$\\beta = 45^\\circ$，$\\sigma_x = 80\\times 10^6\\,\\mathrm{Pa}$，$\\sigma_y = 80\\times 10^6\\,\\mathrm{Pa}$，$\\tau_{xy} = 0\\,\\mathrm{Pa}$。\n  - 按上文定义 $K_0 = \\sqrt{\\pi a}\\,\\sigma_{\\mathrm{ref}}$。定义提取值为 $K_I^{\\mathrm{ext}} = (1.0)\\,K_I$，$K_{II}^{\\mathrm{ext}} = (0.005)\\,K_0$。\n\n要求的最终输出格式：\n- 您的程序必须生成单行输出，其中包含一个逗号分隔的 Python 风格列表，该列表按顺序连接了所有案例的误差度量。对于每个案例，依次附加 $e_I$、$e_{II}$，然后是 $\\Delta\\psi$（以弧度为单位）。因此，最终输出是一个扁平列表，每个案例包含3个数字，按上面列出的案例顺序排列。\n\n所有计算必须使用国际单位制（SI）：应力单位为帕斯卡，长度单位为米，角度按指定单位。$e_I$ 和 $e_{II}$ 的输出值必须报告为小数（无单位），$\\Delta\\psi$ 必须以弧度报告。输出中不允许出现百分号。程序不读取任何输入；它必须是完全自洽的，并按原样运行。", "solution": "该问题是计算断裂力学中的一个标准验证练习。它具有科学依据、问题良态且客观。没有矛盾、歧义或违反物理原理之处。我们将着手解决。\n\n目标是计算无限弹性板中直裂纹在远场均匀应力作用下的解析应力强度因子 $K_I$ 和 $K_{II}$，并将这些值与模拟数值方法（如有限元法 FEM）结果的合成“提取”值进行比较。\n\n首先，我们必须建立远场应力场与作用在裂纹面上的牵引力之间的关系。远场应力状态由全局 $(x, y)$ 坐标系中的柯西应力张量给出：\n$$\n\\boldsymbol{\\sigma} =\n\\begin{pmatrix}\n\\sigma_x & \\tau_{xy} \\\\\n\\tau_{xy} & \\sigma_y\n\\end{pmatrix}\n$$\n裂纹是与全局 $x$ 轴成 $\\beta$ 角的一条线段。一个局部坐标系 $(x', y')$ 与裂纹对齐，其中 $x'$ 与裂纹相切，$y'$ 与其垂直。从全局坐标系到局部坐标系的变换是一个绕 $\\beta$ 角的旋转。\n\n裂纹面的单位法向量 $\\mathbf{n}$ 对应于 $y'$ 轴方向。在全局基中，此向量为：\n$$\n\\mathbf{n} = \\begin{pmatrix} -\\sin\\beta \\\\ \\cos\\beta \\end{pmatrix}\n$$\n裂纹的单位切向量 $\\mathbf{t}_\\tau$ 对应于 $x'$ 轴方向：\n$$\n\\mathbf{t}_\\tau = \\begin{pmatrix} \\cos\\beta \\\\ \\sin\\beta \\end{pmatrix}\n$$\n根据柯西应力原理，作用在法向量为 $\\mathbf{n}$ 的表面上的牵引力矢量 $\\mathbf{t}$ 由 $\\mathbf{t} = \\boldsymbol{\\sigma} \\mathbf{n}$ 给出。\n$$\n\\mathbf{t} =\n\\begin{pmatrix}\n\\sigma_x & \\tau_{xy} \\\\\n\\tau_{xy} & \\sigma_y\n\\end{pmatrix}\n\\begin{pmatrix}\n-\\sin\\beta \\\\\n\\cos\\beta\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-\\sigma_x \\sin\\beta + \\tau_{xy} \\cos\\beta \\\\\n-\\tau_{xy} \\sin\\beta + \\sigma_y \\cos\\beta\n\\end{pmatrix}\n$$\n法向牵引力 $\\sigma_n$ 是牵引力矢量 $\\mathbf{t}$ 在法线方向 $\\mathbf{n}$ 上的投影。这是旋转坐标系中的应力分量 $\\sigma_{y'}$。\n$$\n\\sigma_n = \\mathbf{t} \\cdot \\mathbf{n} = (-\\sigma_x \\sin\\beta + \\tau_{xy} \\cos\\beta)(-\\sin\\beta) + (-\\tau_{xy} \\sin\\beta + \\sigma_y \\cos\\beta)(\\cos\\beta)\n$$\n$$\n\\sigma_n = \\sigma_x \\sin^2\\beta - 2\\tau_{xy} \\sin\\beta \\cos\\beta + \\sigma_y \\cos^2\\beta\n$$\n使用三角恒等式，这可简化为标准的应力变换方程：\n$$\n\\sigma_n = \\frac{\\sigma_x + \\sigma_y}{2} - \\frac{\\sigma_x - \\sigma_y}{2}\\cos(2\\beta) - \\tau_{xy}\\sin(2\\beta)\n$$\n剪切牵引力 $\\tau_{nt}$ 是 $\\mathbf{t}$ 在切线方向 $\\mathbf{t}_\\tau$ 上的投影。这对应于旋转坐标系中的剪应力分量 $\\tau_{x'y'}$。\n$$\n\\tau_{nt} = \\mathbf{t} \\cdot \\mathbf{t}_\\tau = (-\\sigma_x \\sin\\beta + \\tau_{xy} \\cos\\beta)(\\cos\\beta) + (-\\tau_{xy} \\sin\\beta + \\sigma_y \\cos\\beta)(\\sin\\beta)\n$$\n$$\n\\tau_{nt} = (\\sigma_y - \\sigma_x)\\sin\\beta\\cos\\beta + \\tau_{xy}(\\cos^2\\beta - \\sin^2\\beta)\n$$\n这可简化为：\n$$\n\\tau_{nt} = -\\frac{\\sigma_x - \\sigma_y}{2}\\sin(2\\beta) + \\tau_{xy}\\cos(2\\beta)\n$$\n对于无限板中半长为 $a$ 的裂纹，线性弹性断裂力学给出了这些由远场引起的牵引力与应力强度因子（SIFs）之间的关系：\n$$\nK_I = \\sigma_n \\sqrt{\\pi a}\n$$\n$$\nK_{II} = \\tau_{nt} \\sqrt{\\pi a}\n$$\n这些是解析参考值。\n\n然后我们按规定计算误差度量。对于给定的解析SIF $K_i$ 及其提取对应值 $K_i^{\\mathrm{ext}}$，相对误差 $e_i$ 为：\n$$\ne_i = \\frac{\\lvert K_i^{\\mathrm{ext}} - K_i \\rvert}{\\lvert K_i \\rvert} \\quad \\text{若 } \\lvert K_i \\rvert > 0\n$$\n如果 $K_i=0$，则误差由特征SIF $K_0$ 进行归一化：\n$$\ne_i = \\frac{\\lvert K_i^{\\mathrm{ext}} - K_i \\rvert}{K_0} \\quad \\text{若 } K_i = 0\n$$\n其中 $K_0 = \\sqrt{\\pi a}\\,\\sigma_{\\mathrm{ref}}$ 且 $\\sigma_{\\mathrm{ref}} = \\max(\\lvert \\sigma_x \\rvert, \\lvert \\sigma_y \\rvert, \\lvert \\tau_{xy} \\rvert)$。\n\n混合模式角 $\\psi$ 定义为 $\\psi = \\operatorname{atan2}(K_{II}, K_I)$。此角度的误差 $\\Delta\\psi$ 必须考虑周期性：\n$$\n\\Delta\\psi = \\lvert \\mathrm{wrap}_{[-\\pi,\\pi]}(\\psi^{\\mathrm{ext}} - \\psi) \\rvert\n$$\n其中 $\\psi^{\\mathrm{ext}} = \\operatorname{atan2}(K_{II}^{\\mathrm{ext}}, K_I^{\\mathrm{ext}})$，$\\mathrm{wrap}$ 函数将其参数映射到区间 $[-\\pi, \\pi]$。\n\n现在我们将此框架应用于每个测试案例。所有计算都必须使用国际单位制。以度为单位提供的角度 $\\beta$ 必须转换为弧度以用于三角函数。\n\n案例1：\n- 已知条件：$a = 0.02\\,\\mathrm{m}$，$\\beta = 30^\\circ$，$\\sigma_x = 120 \\times 10^6\\,\\mathrm{Pa}$，$\\sigma_y = 30 \\times 10^6\\,\\mathrm{Pa}$，$\\tau_{xy} = 0\\,\\mathrm{Pa}$。\n- $\\beta = \\pi/6$ 弧度。$2\\beta = \\pi/3$ 弧度。\n- $\\sigma_n = \\frac{120+30}{2} \\times 10^6 - \\frac{120-30}{2}\\times 10^6 \\cos(\\pi/3) = (75 - 45 \\times 0.5) \\times 10^6 = 52.5 \\times 10^6\\,\\mathrm{Pa}$。\n- $\\tau_{nt} = -\\frac{120-30}{2}\\times 10^6 \\sin(\\pi/3) = -45 \\times 10^6 \\times \\frac{\\sqrt{3}}{2} \\approx -38.971 \\times 10^6\\,\\mathrm{Pa}$。\n- $\\sqrt{\\pi a} = \\sqrt{\\pi \\times 0.02} \\approx 0.25066\\,\\mathrm{m}^{1/2}$。\n- $K_I = 52.5 \\times 10^6 \\times 0.25066 \\approx 13.1598 \\times 10^6\\,\\mathrm{Pa}\\sqrt{\\mathrm{m}}$。\n- $K_{II} = -38.971 \\times 10^6 \\times 0.25066 \\approx -9.7688 \\times 10^6\\,\\mathrm{Pa}\\sqrt{\\mathrm{m}}$。\n- 提取值：$K_I^{\\mathrm{ext}} = 1.01 K_I$，$K_{II}^{\\mathrm{ext}} = 0.98 K_{II}$。\n- $e_I = \\lvert 1.01 K_I - K_I \\rvert / \\lvert K_I \\rvert = 0.01$。\n- $e_{II} = \\lvert 0.98 K_{II} - K_{II} \\rvert / \\lvert K_{II} \\rvert = 0.02$。\n- $\\psi = \\operatorname{atan2}(K_{II}, K_I) \\approx -0.6378\\,\\mathrm{rad}$。\n- $\\psi^{\\mathrm{ext}} = \\operatorname{atan2}(0.98 K_{II}, 1.01 K_I) \\approx -0.6247\\,\\mathrm{rad}$。\n- $\\Delta\\psi = \\lvert -0.6247 - (-0.6378) \\rvert \\approx 0.0131\\,\\mathrm{rad}$。\n\n案例2：\n- 已知条件：$a = 0.01\\,\\mathrm{m}$，$\\beta = 0^\\circ$，$\\sigma_x = 0\\,\\mathrm{Pa}$，$\\sigma_y = 30 \\times 10^6\\,\\mathrm{Pa}$，$\\tau_{xy} = 0\\,\\mathrm{Pa}$。\n- $\\beta = 0$。$2\\beta = 0$。\n- $\\sigma_n = \\frac{0+30}{2} \\times 10^6 - \\frac{0-30}{2}\\times 10^6 \\cos(0) = (15 - (-15)) \\times 10^6 = 30 \\times 10^6\\,\\mathrm{Pa}$。\n- $\\tau_{nt} = -\\frac{0-30}{2}\\times 10^6 \\sin(0) = 0\\,\\mathrm{Pa}$。\n- $K_I = 30 \\times 10^6 \\sqrt{\\pi \\times 0.01} \\approx 5.3174 \\times 10^6\\,\\mathrm{Pa}\\sqrt{\\mathrm{m}}$。$K_{II} = 0\\,\\mathrm{Pa}\\sqrt{\\mathrm{m}}$。\n- $\\sigma_{\\mathrm{ref}} = 30 \\times 10^6\\,\\mathrm{Pa}$。$K_0 = 30 \\times 10^6 \\sqrt{\\pi \\times 0.01} = K_I$。\n- 提取值：$K_I^{\\mathrm{ext}} = 0.995 K_I$，$K_{II}^{\\mathrm{ext}} = 0.01 K_0$。\n- $e_I = \\lvert 0.995 K_I - K_I \\rvert / \\lvert K_I \\rvert = 0.005$。\n- $e_{II} = \\lvert 0.01 K_0 - 0 \\rvert / K_0 = 0.01$。\n- $\\psi = \\operatorname{atan2}(0, K_I) = 0\\,\\mathrm{rad}$。\n- $\\psi^{\\mathrm{ext}} = \\operatorname{atan2}(0.01 K_0, 0.995 K_I) = \\operatorname{atan2}(0.01, 0.995) \\approx 0.01005\\,\\mathrm{rad}$。\n- $\\Delta\\psi = \\lvert 0.01005 - 0 \\rvert \\approx 0.01005\\,\\mathrm{rad}$。\n\n案例3：\n- 已知条件：$a = 0.015\\,\\mathrm{m}$，$\\beta = 45^\\circ$，$\\sigma_x = 80 \\times 10^6\\,\\mathrm{Pa}$，$\\sigma_y = 80 \\times 10^6\\,\\mathrm{Pa}$，$\\tau_{xy} = 0\\,\\mathrm{Pa}$。\n- $\\beta = \\pi/4$ 弧度。$2\\beta = \\pi/2$ 弧度。\n- $\\sigma_n = \\frac{80+80}{2} \\times 10^6 - \\frac{80-80}{2}\\times 10^6 \\cos(\\pi/2) = 80 \\times 10^6\\,\\mathrm{Pa}$。对于静水压力，正应力是不变的。\n- $\\tau_{nt} = -\\frac{80-80}{2}\\times 10^6 \\sin(\\pi/2) = 0\\,\\mathrm{Pa}$。所有平面上的剪应力均为零。\n- $K_I = 80 \\times 10^6 \\sqrt{\\pi \\times 0.015} \\approx 17.3627 \\times 10^6\\,\\mathrm{Pa}\\sqrt{\\mathrm{m}}$。$K_{II} = 0\\,\\mathrm{Pa}\\sqrt{\\mathrm{m}}$。\n- $\\sigma_{\\mathrm{ref}} = 80 \\times 10^6\\,\\mathrm{Pa}$。$K_0 = 80 \\times 10^6 \\sqrt{\\pi \\times 0.015} = K_I$。\n- 提取值：$K_I^{\\mathrm{ext}} = 1.0 K_I = K_I$，$K_{II}^{\\mathrm{ext}} = 0.005 K_0$。\n- $e_I = \\lvert K_I - K_I \\rvert / \\lvert K_I \\rvert = 0$。\n- $e_{II} = \\lvert 0.005 K_0 - 0 \\rvert / K_0 = 0.005$。\n- $\\psi = \\operatorname{atan2}(0, K_I) = 0\\,\\mathrm{rad}$。\n- $\\psi^{\\mathrm{ext}} = \\operatorname{atan2}(0.005 K_0, K_I) = \\operatorname{atan2}(0.005, 1.0) \\approx 0.005\\,\\mathrm{rad}$。\n- $\\Delta\\psi = \\lvert 0.005 - 0 \\rvert \\approx 0.005\\,\\mathrm{rad}$。\n\n这些计算构成了所需程序的基础。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the verification experiment for stress intensity factors.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"name\": \"Case 1\",\n            \"a\": 0.02, # m\n            \"beta_deg\": 30.0, # degrees\n            \"sigma_x\": 120e6, # Pa\n            \"sigma_y\": 30e6, # Pa\n            \"tau_xy\": 0.0, # Pa\n            \"ext_rule\": lambda KI, KII, K0: (1.01 * KI, 0.98 * KII)\n        },\n        {\n            \"name\": \"Case 2\",\n            \"a\": 0.01,\n            \"beta_deg\": 0.0,\n            \"sigma_x\": 0.0,\n            \"sigma_y\": 30e6,\n            \"tau_xy\": 0.0,\n            \"ext_rule\": lambda KI, KII, K0: (0.995 * KI, 0.01 * K0)\n        },\n        {\n            \"name\": \"Case 3\",\n            \"a\": 0.015,\n            \"beta_deg\": 45.0,\n            \"sigma_x\": 80e6,\n            \"sigma_y\": 80e6,\n            \"tau_xy\": 0.0,\n            \"ext_rule\": lambda KI, KII, K0: (1.0 * KI, 0.005 * K0)\n        }\n    ]\n\n    results = []\n\n    def wrap_angle(angle):\n        \"\"\"Wraps an angle in radians to the interval [-pi, pi].\"\"\"\n        return (angle + np.pi) % (2 * np.pi) - np.pi\n\n    for case in test_cases:\n        a = case[\"a\"]\n        beta_rad = np.deg2rad(case[\"beta_deg\"])\n        sx = case[\"sigma_x\"]\n        sy = case[\"sigma_y\"]\n        txy = case[\"tau_xy\"]\n        \n        # 1. Resolve remote stresses into crack-plane components\n        sigma_n = (sx + sy) / 2.0 - (sx - sy) / 2.0 * np.cos(2 * beta_rad) - txy * np.sin(2 * beta_rad)\n        tau_nt = -(sx - sy) / 2.0 * np.sin(2 * beta_rad) + txy * np.cos(2 * beta_rad)\n\n        # 2. Compute analytical Stress Intensity Factors\n        sqrt_pi_a = np.sqrt(np.pi * a)\n        K_I = sigma_n * sqrt_pi_a\n        K_II = tau_nt * sqrt_pi_a\n\n        # 3. Compute analytical mode-mixity angle\n        psi = np.arctan2(K_II, K_I)\n\n        # 4. Compute extracted values and quantify errors\n        sigma_ref = np.max([np.abs(sx), np.abs(sy), np.abs(txy)])\n        \n        # Handle the case where all stresses are zero\n        if np.isclose(sigma_ref, 0):\n            K0 = 0.0\n        else:\n            K0 = sqrt_pi_a * sigma_ref\n\n        K_I_ext, K_II_ext = case[\"ext_rule\"](K_I, K_II, K0)\n\n        # Relative error in K_I\n        if not np.isclose(K_I, 0):\n            e_I = np.abs(K_I_ext - K_I) / np.abs(K_I)\n        else:\n            # Handle case where K_I is zero, normalize by K0\n            if np.isclose(K0, 0):\n                 # If K_I and K0 are zero, error is zero if K_I_ext is also zero\n                e_I = 0.0 if np.isclose(K_I_ext, 0) else np.inf\n            else:\n                e_I = np.abs(K_I_ext - K_I) / K0\n        \n        # Relative error in K_II\n        if not np.isclose(K_II, 0):\n            e_II = np.abs(K_II_ext - K_II) / np.abs(K_II)\n        else:\n             # Handle case where K_II is zero, normalize by K0\n            if np.isclose(K0, 0):\n                e_II = 0.0 if np.isclose(K_II_ext, 0) else np.inf\n            else:\n                e_II = np.abs(K_II_ext - K_II) / K0\n\n        # Absolute error in mode-mixity angle\n        psi_ext = np.arctan2(K_II_ext, K_I_ext)\n        delta_psi = np.abs(wrap_angle(psi_ext - psi))\n        \n        results.extend([e_I, e_II, delta_psi])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```", "id": "2602853"}, {"introduction": "最后的这项实践将验证的概念推向了更深的层次，我们不再仅仅关注单次模拟的准确性，而是要考察数值方法本身的*渐近行为*。你将设计一个模拟的 $h$ 网格细化研究，旨在验证使用功能强大的季点单元 (quarter-point elements) 计算SIF时，其计算误差是否遵循理论预测的收敛率。这项练习将引导你完成一个严谨的收敛性验证流程，展示如何确认你的数值方法是否如理论所预期的那样表现，这是衡量一个数值模型是否稳健的最终标准。[@problem_id:2602782]", "problem": "您的任务是设计并实施一项计算研究，以验证从使用四分之一点单元的边缘裂纹板有限元法（FEM）模拟中提取的I型应力强度因子（SIF）（记为 $K_I$）的渐近收敛率。该研究必须纯粹以数学术语进行表述，基于线性弹性断裂力学（LEFM）原理，并且必须模拟在使用四分之一点单元时，网格$h$-细化对$K_I$误差的影响。\n\n基本假设与事实：\n- 在线性弹性断裂力学（LEFM）中，对于I型裂纹，裂纹尖端附近的应力场表现为 $\\sigma_{ij}(r,\\theta) \\sim \\frac{K_I}{\\sqrt{2\\pi r}} f_{ij}(\\theta)$，其中 $r$ 是距裂纹尖端的径向距离，$\\theta$ 是极角。\n- 四分之一点等参单元通过一种特殊的节点映射再现了位移场的 $r^{1/2}$ 奇异性。这意味着，在充分细化的情况下，提取的 $K_I$ 的误差会随着裂纹尖端附近特征单元尺寸 $h$ 的幂函数衰减：$|K_I(h) - K_I^\\star| \\approx C h^p$，其中 $C$ 为某个常数，$p$ 为收敛率指数，其期望值与二次四分之一点单元相关。\n- 对于在均匀远场拉伸应力 $\\sigma$ 下的边缘裂纹有限宽度板，其真实的 $K_I$ 由一个经过充分检验的公式给出，\n$$\nK_I^\\star = \\sigma \\sqrt{\\pi a} \\, F\\!\\left(\\frac{a}{W}\\right),\n$$\n其中 $a$ 是裂纹长度，$W$ 是板的宽度，且\n$$\nF(x) = 1.12 - 0.231 x + 10.55 x^2 - 21.72 x^3 + 30.39 x^4.\n$$\n该表达式被广泛用作对边缘裂纹板中有限宽度效应的精确经验修正。\n\n您的任务是：\n- 对于每个测试用例，使用上述 $F(x)$ 计算 $K_I^\\star$。\n- 根据模型\n$$\nK_I(h) = K_I^\\star \\left(1 + c\\, h^p + d\\, h^{p+1}\\right),\n$$\n在一系列网格细化序列 $\\{h_k\\}$ 上模拟一系列有限元提取值 $K_I(h_k)$，其中 $c$ 和 $d$ 是特定于用例的正或负常数，$p$ 是待您通过回归验证的未知指数。项 $d\\,h^{p+1}$ 模拟了误差中的渐近前曲率。\n- 对于每个用例，通过对 $\\log e(h)$ 与 $\\log h$ 进行最小二乘线性回归来估计观察到的收敛率 $\\hat p$，其中 $e(h) = |K_I(h) - K_I^\\star|$。即，拟合模型 $\\log e(h) \\approx \\log C + p \\log h$ 并将斜率报告为 $\\hat p$。\n- 使用自然对数。\n- 所有物理单位必须按以下方式统一处理：\n  - 输入应力 $\\sigma$ 的单位为 $\\mathrm{MPa}$，几何尺寸 $a$ 和 $W$ 及网格尺寸 $h$ 的单位为 $\\mathrm{m}$，最终得到的 $K_I$ 单位必须为 $\\mathrm{MPa}\\sqrt{\\mathrm{m}}$。\n- 最终输出是每个测试用例的无量纲估计值 $\\hat p$。将每个 $\\hat p$ 表示为四舍五入到 $6$ 位小数的浮点数。\n\n测试套件：\n请为以下 $3$ 个测试用例提供结果。在每个元组 $\\left(W, a/W, \\sigma, \\{h_k\\}, c, d\\right)$ 中，$W$ 是宽度，$a/W$ 是用于计算 $a$ 的裂纹比，$\\sigma$ 是施加的远场拉伸应力，$\\{h_k\\}$ 是以米为单位的细化序列，$c,d$ 是 $K_I(h)$ 模型中的渐近前误差系数。\n\n- 用例 1：$\\left(W=\\;1.0,\\; a/W=\\;0.3,\\; \\sigma=\\;100.0,\\; \\{h_k\\} = [0.1,\\,0.05,\\,0.025,\\,0.0125],\\; c=\\;1.0,\\; d=\\;0.5\\right)$\n- 用例 2：$\\left(W=\\;2.0,\\; a/W=\\;0.05,\\; \\sigma=\\;250.0,\\; \\{h_k\\} = [0.04,\\,0.02,\\,0.01,\\,0.005],\\; c=\\;0.5,\\; d=\\;-0.2\\right)$\n- 用例 3：$\\left(W=\\;1.0,\\; a/W=\\;0.6,\\; \\sigma=\\;150.0,\\; \\{h_k\\} = [0.2,\\,0.1,\\,0.05],\\; c=\\;2.0,\\; d=\\;2.0\\right)$\n\n程序要求：\n- 对于每个用例，您的程序必须计算 $K_I^\\star$，并使用上述模型、提供的 $c$ 和 $d$ 以及假定的四分之一点单元方案生成 $K_I(h)$ 值。然后按照描述估计 $\\hat p$，并将三个估计出的指数收集到一个列表中。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $\\left[\\hat p_1,\\hat p_2,\\hat p_3\\right]$，其中每个 $\\hat p_i$ 都四舍五入到 $6$ 位小数。", "solution": "我们从线性弹性断裂力学（LEFM）对裂纹尖端场的表征开始。对于I型裂纹，当 $r \\to 0$ 时，主导应力项的行为表现为 $\\sigma_{ij}(r,\\theta) \\sim \\dfrac{K_I}{\\sqrt{2\\pi r}} f_{ij}(\\theta)$，其中 $K_I$ 是I型应力强度因子（SIF）。在有限元法（FEM）中，如果使用标准的多项式插值，应力中的奇异 $r^{-1/2}$ 行为（等效于位移中的 $r^{1/2}$ 行为）无法被表示，导致收敛性不佳。四分之一点单元通过将边中节点重新定位到与裂纹尖端相连的边的四分之一点处来解决此问题。这种等参映射创建的形函数能够精确地产生 $r^{1/2}$ 的主导阶位移奇异性。因此，对于足够细化的网格，提取的 $K_I$ 的误差行为类似于 Williams 展开中的一个高阶项。\n\n基于原理的收敛性论证：\n- 对于各向同性线弹性材料，裂纹尖端附近位移场的 Williams 展开可写为 $u(r,\\theta) = A_1 r^{1/2} \\Phi_1(\\theta) + A_2 r^{3/2} \\Phi_2(\\theta) + \\cdots$，其中 $A_1$ 与 $K_I$ 成正比。四分之一点单元在有限元插值空间中精确再现了 $r^{1/2}$ 项。因此，$K_I$ 离散化误差的主要来源是第一个被忽略的项，该项在精确场中按 $r^{3/2}$ 比例变化，但在尺寸为 $h$ 的单元上被近似。\n- 线性依赖于裂纹尖端场系数的目标量（例如，通过与LEFM一致的路径无关的 $J$-积分或位移/牵引力外推法提取的 $K_I$）的误差，继承了级数中下一项的插值误差。这导致了渐近行为 $|K_I(h) - K_I^\\star| \\approx C h^p$，其中整数指数 $p$ 与有效再现阶数相关。对于二次四分之一点单元，期望指数为 $p = 2$，这反映了奇异主导项被精确捕捉，而下一项在误差中贡献了 $h^2$ 项。\n\n用于验证的真值：\n- 对于在均匀拉伸下的边缘裂纹有限宽度板，一个经过充分检验的 $K_I$ 真值封闭形式为 $K_I^\\star = \\sigma \\sqrt{\\pi a} F(a/W)$，其中\n$$\nF(x) = 1.12 - 0.231 x + 10.55 x^2 - 21.72 x^3 + 30.39 x^4,\n$$\n这是广泛使用的经验修正（例如，Tada–Paris–Irwin 型表达式）。当 $a$ 的单位为 $\\mathrm{m}$，$\\sigma$ 的单位为 $\\mathrm{MPa}$ 时，$K_I^\\star$ 的单位为 $\\mathrm{MPa}\\sqrt{\\mathrm{m}}$。\n\n合成有限元数据模型：\n- 为模拟使用四分之一点单元进行 $h$-细化的一系列 FEM 计算结果，我们假设\n$$\nK_I(h) = K_I^\\star \\left(1 + c\\, h^p + d\\, h^{p+1}\\right),\n$$\n其中 $c$ 和 $d$ 是分别模拟主导贡献和渐近前贡献的、与用例相关的常数，$p$ 是待验证的收敛率。附加的 $d\\,h^{p+1}$ 项在对数-对数数据中引入了曲率，以模仿在较粗网格上可观察到的渐近前效应。\n\n估计流程：\n- 定义误差 $e(h) = |K_I(h) - K_I^\\star|$。取自然对数可得\n$$\n\\log e(h) = \\log\\!\\left(K_I^\\star |c| \\right) + p \\log h + \\log\\!\\left(1 + \\operatorname{sgn}(c)\\frac{d}{|c|} h \\right),\n$$\n其中当 $h \\to 0$ 时，最后一项对数趋于 $0$。因此，对于足够小的 $h$，线性模型 $\\log e(h) \\approx \\alpha + p \\log h$ 成立。通过普通最小二乘法将一条直线拟合到 $\\{(\\log h_k, \\log e(h_k))\\}$，得到估计值\n$$\n\\hat p = \\frac{\\sum_k \\left(\\log h_k - \\overline{\\log h}\\right) \\left(\\log e(h_k) - \\overline{\\log e}\\right)}{\\sum_k \\left(\\log h_k - \\overline{\\log h}\\right)^2}。\n$$\n\n程序中实现的算法步骤：\n1. 对于每个用例，计算 $a = (a/W)\\,W$。\n2. 计算 $K_I^\\star = \\sigma \\sqrt{\\pi a} F(a/W)$。\n3. 使用提供的网格尺寸 $\\{h_k\\}$ 和常数 $(c,d)$，利用上述模型在四分之一点单元方案下生成 $K_I(h_k)$。\n4. 计算误差列表 $e_k = |K_I(h_k) - K_I^\\star|$。\n5. 对 $\\log e_k$ 与 $\\log h_k$ 进行最小二乘拟合以获得 $\\hat p$。\n6. 输出列表 $[\\hat p_1, \\hat p_2, \\hat p_3]$，并四舍五入到 $6$ 位小数。\n\n测试套件的数值期望：\n- 用例 1：当 $\\{h_k\\} = [0.1, 0.05, 0.025, 0.0125]$ 且 $(c,d)=(1.0,0.5)$ 时，渐近前项影响温和，$\\hat p$ 应非常接近 $2$，通常由于误差中的正曲率而略高于 $2$，例如 $\\hat p \\approx 2.02$。\n- 用例 2：当 $h$ 值较小且 $(c,d)=(0.5,-0.2)$ 时，渐近前修正是负的，会使表观斜率有非常轻微的降低，得到 $\\hat p \\approx 1.99$。\n- 用例 3：当网格较粗且 $(c,d)=(2.0,2.0)$ 时，渐近前项为正且影响相对较强，使得在此较短范围内观察到的斜率超过 $2$，例如 $\\hat p \\approx 2.096$。\n\n这些观察结果与理论预期一致：对于能够捕捉 $r^{1/2}$ 奇异性的四分之一点单元，其渐近收敛率为 $p=2$，而有限 $h$ 效应会使观察到的速率略高于或低于 $2$，具体取决于渐近前项的符号和大小。\n\n程序遵循这些步骤，并以要求的单行格式打印三个估计出的速率，每个值都四舍五入到 $6$ 位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef correction_F(x: float) -> float:\n    \"\"\"\n    Finite-width correction factor F(x) for an edge-cracked plate.\n    Polynomial widely used in fracture mechanics literature.\n    \"\"\"\n    return 1.12 - 0.231*x + 10.55*(x**2) - 21.72*(x**3) + 30.39*(x**4)\n\ndef true_K_I(sigma: float, a: float, W: float) -> float:\n    \"\"\"\n    True Mode I SIF for edge-cracked finite width plate:\n    K_I = sigma * sqrt(pi * a) * F(a/W)\n    Units: sigma [MPa], a,W [m], K_I [MPa * sqrt(m)]\n    \"\"\"\n    return sigma * np.sqrt(np.pi * a) * correction_F(a / W)\n\ndef simulate_K_I_series(K_true: float, hs: np.ndarray, c: float, d: float, p_model: float) -> np.ndarray:\n    \"\"\"\n    Simulate K_I(h) values for a refinement sequence hs given an asymptotic model:\n    K_I(h) = K_true * (1 + c*h^p + d*h^(p+1))\n    \"\"\"\n    return K_true * (1.0 + c * hs**p_model + d * hs**(p_model + 1.0))\n\ndef estimate_rate_from_series(hs: np.ndarray, K_series: np.ndarray, K_true: float) -> float:\n    \"\"\"\n    Estimate convergence rate p by least-squares fit of log error vs log h.\n    \"\"\"\n    errors = np.abs(K_series - K_true)\n    # Guard against any non-positive errors (should not occur with our model)\n    # Add tiny epsilon if necessary to avoid log(0), though model prevents exact zero.\n    eps = 1e-300\n    x = np.log(hs)\n    y = np.log(np.maximum(errors, eps))\n    # Linear regression slope: use numpy.polyfit for robustness.\n    slope, intercept = np.polyfit(x, y, 1)\n    return slope\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (W [m], a_over_W [-], sigma [MPa], hs [m], c [-], d [-])\n    test_cases = [\n        (1.0, 0.3, 100.0, np.array([0.1, 0.05, 0.025, 0.0125]), 1.0, 0.5),\n        (2.0, 0.05, 250.0, np.array([0.04, 0.02, 0.01, 0.005]), 0.5, -0.2),\n        (1.0, 0.6, 150.0, np.array([0.2, 0.1, 0.05]), 2.0, 2.0),\n    ]\n\n    # Assumed quarter-point element asymptotic model exponent (used to synthesize data)\n    p_quarter_point = 2.0\n\n    results = []\n    for W, a_over_W, sigma, hs, c, d in test_cases:\n        a = a_over_W * W\n        K_true = true_K_I(sigma, a, W)\n        K_series = simulate_K_I_series(K_true, hs, c, d, p_quarter_point)\n        p_hat = estimate_rate_from_series(hs, K_series, K_true)\n        results.append(p_hat)\n\n    # Final print statement in the exact required format, rounded to 6 decimals.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2602782"}]}