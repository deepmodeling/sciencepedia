{"hands_on_practices": [{"introduction": "本练习关注于在有限元软件中实现相场模型的关键组成部分：算法切线模量。您将为一个采用拉压分离的一维杆推导应力和切线模量，这对于牛顿法求解器的有效和精确收敛至关重要。此练习将巩固您对材料刚度在拉伸下如何退化，同时在压缩下保持不变的理解。[@problem_id:2587040]", "problem": "一根一维小应变杆在有限元法 (FEM) 框架内采用断裂相场法进行建模。未损伤材料的弹性自由能密度被设为应变的二次函数，并采用拉压分解来防止材料在受压时发生损伤演化。该分解作用于应变能，其正（拉伸）和负（压缩）部分通过麦卡利括号 (Macaulay brackets) 定义如下。设小应变为 $\\,\\varepsilon\\,$。定义 $\\,\\langle x \\rangle_{+} = \\max(x,0)\\,$ 和 $\\,\\langle x \\rangle_{-} = \\min(x,0)\\,$。未损伤能量密度为 $\\,\\psi_{0}(\\varepsilon) = \\tfrac{1}{2} E \\varepsilon^{2}\\,$，其中杨氏模量 (Young’s modulus) $\\,E>0\\,$，分解后的能量为\n$$\n\\psi_{0}^{+}(\\varepsilon) = \\tfrac{1}{2} E \\langle \\varepsilon \\rangle_{+}^{2},\n\\qquad\n\\psi_{0}^{-}(\\varepsilon) = \\tfrac{1}{2} E \\langle \\varepsilon \\rangle_{-}^{2}.\n$$\n退化仅通过一个标量退化函数 $\\,g(d)\\,$ 作用于拉伸能，其中损伤变量 $\\,d\\,$ 满足 $\\,0 \\le d \\le 1\\,$。考虑以下广泛使用的函数形式\n$$\ng(d) = (1-d)^{2} + k,\n$$\n其中 $\\,k \\in (0,1)\\,$ 为一个小的残余刚度。退化后的弹性自由能密度表示为\n$$\n\\psi(\\varepsilon,d) = g(d)\\,\\psi_{0}^{+}(\\varepsilon) + \\psi_{0}^{-}(\\varepsilon).\n$$\n假设在有限元求解的全局 Newton 迭代过程中，在一个局部高斯点 (Gauss point) 处，损伤变量 $\\,d\\,$ 保持固定，并且用于线性化的算法（一致）切向模量为 $\\,\\mathbb{C}_{\\mathrm{alg}} = \\dfrac{\\partial \\sigma}{\\partial \\varepsilon}\\,$，其中柯西应力 (Cauchy stress) 由超弹性定义为 $\\,\\sigma(\\varepsilon,d) = \\dfrac{\\partial \\psi(\\varepsilon,d)}{\\partial \\varepsilon}\\,$。\n\n从给定的自由能分解和定义出发，推导一维情况下 $\\,\\sigma(\\varepsilon,d)\\,$ 以及算法切向模量 $\\,C_{\\mathrm{alg}}(\\varepsilon,d) = \\dfrac{\\partial \\sigma}{\\partial \\varepsilon}\\,$ 的分段表达式，并注意考虑拉压分解。然后，使用参数 $\\,E = 210 \\text{ GPa}\\,$, $\\,k = 1.0 \\times 10^{-6}\\,$, $\\,d = 0.6\\,$ 和应变 $\\,\\varepsilon = 2.0 \\times 10^{-3}\\,$，计算算法切向模量的值。\n\n将最终数值答案四舍五入到四位有效数字，并以 $\\text{GPa}$ 为单位表示。最终报告的答案必须仅为指定状态下的算法切向模量的值。", "solution": "我们从给定的带拉压分解的超弹性自由能密度开始，\n$$\n\\psi(\\varepsilon,d) = g(d)\\,\\psi_{0}^{+}(\\varepsilon) + \\psi_{0}^{-}(\\varepsilon),\n\\qquad\n\\psi_{0}^{+}(\\varepsilon) = \\tfrac{1}{2} E \\langle \\varepsilon \\rangle_{+}^{2},\n\\qquad\n\\psi_{0}^{-}(\\varepsilon) = \\tfrac{1}{2} E \\langle \\varepsilon \\rangle_{-}^{2},\n$$\n以及退化函数 $\\,g(d) = (1-d)^{2} + k\\,$，其中 $\\,0<k\\ll 1\\,$。\n\n根据超弹性理论，柯西应力 (Cauchy stress) 是自由能对应变的导数，\n$$\n\\sigma(\\varepsilon,d) = \\frac{\\partial \\psi}{\\partial \\varepsilon}(\\varepsilon,d).\n$$\n为计算该导数，我们使用麦卡利括号 (Macaulay brackets) 的性质。回顾一下，\n$$\n\\langle \\varepsilon \\rangle_{+} =\n\\begin{cases}\n\\varepsilon, & \\varepsilon \\ge 0,\\\\\n0, & \\varepsilon < 0,\n\\end{cases}\n\\qquad\n\\langle \\varepsilon \\rangle_{-} =\n\\begin{cases}\n0, & \\varepsilon \\ge 0,\\\\\n\\varepsilon, & \\varepsilon < 0,\n\\end{cases}\n$$\n并且注意到映射 $\\,\\varepsilon \\mapsto \\tfrac{1}{2}E\\langle \\varepsilon \\rangle_{\\pm}^{2}\\,$ 在 $\\,\\varepsilon \\neq 0\\,$ 时是可微的，其导数为\n$$\n\\frac{\\partial}{\\partial \\varepsilon}\\!\\left(\\tfrac{1}{2}E\\langle \\varepsilon \\rangle_{+}^{2}\\right) =\n\\begin{cases}\nE \\varepsilon, & \\varepsilon > 0,\\\\\n0, & \\varepsilon < 0,\n\\end{cases}\n\\qquad\n\\frac{\\partial}{\\partial \\varepsilon}\\!\\left(\\tfrac{1}{2}E\\langle \\varepsilon \\rangle_{-}^{2}\\right) =\n\\begin{cases}\n0, & \\varepsilon > 0,\\\\\nE \\varepsilon, & \\varepsilon < 0.\n\\end{cases}\n$$\n点 $\\,\\varepsilon=0\\,$ 是一个拐点，其导数不唯一，但在有限元计算中，该点的测度为零，因此可以分别处理两侧的情况。因此，对于 $\\,\\varepsilon \\ne 0\\,$，\n$$\n\\sigma(\\varepsilon,d)\n= g(d)\\,E\\,\\langle \\varepsilon \\rangle_{+} + E\\,\\langle \\varepsilon \\rangle_{-}\n=\n\\begin{cases}\ng(d)\\,E\\,\\varepsilon, & \\varepsilon > 0,\\\\\nE\\,\\varepsilon, & \\varepsilon < 0.\n\\end{cases}\n$$\n\n对于固定 $\\,d\\,$ 的 Newton 迭代，其算法（一致）切向模量是 $\\,\\sigma(\\varepsilon,d)\\,$ 对应变 $\\,\\varepsilon\\,$ 的导数，\n$$\nC_{\\mathrm{alg}}(\\varepsilon,d) = \\frac{\\partial \\sigma}{\\partial \\varepsilon}(\\varepsilon,d).\n$$\n对 $\\,\\sigma\\,$ 的分段表达式求导，并保持 $\\,d\\,$ 固定，可得\n$$\nC_{\\mathrm{alg}}(\\varepsilon,d) =\n\\begin{cases}\ng(d)\\,E, & \\varepsilon > 0,\\\\\nE, & \\varepsilon < 0.\n\\end{cases}\n$$\n\n现在我们在指定状态下计算该表达式的值。参数如下：\n$$\nE = 210 \\text{ GPa}, \\quad k = 1.0 \\times 10^{-6}, \\quad d = 0.6, \\quad \\varepsilon = 2.0 \\times 10^{-3}.\n$$\n由于 $\\,\\varepsilon = 2.0 \\times 10^{-3} > 0\\,$，我们使用拉伸分支的表达式，\n$$\nC_{\\mathrm{alg}} = g(d)\\,E.\n$$\n计算退化函数：\n$$\ng(d) = (1-d)^{2} + k = (1 - 0.6)^{2} + 1.0 \\times 10^{-6} = (0.4)^{2} + 1.0 \\times 10^{-6} = 0.16 + 1.0 \\times 10^{-6} = 0.160001.\n$$\n因此，\n$$\nC_{\\mathrm{alg}} = 0.160001 \\times 210 \\text{ GPa} = 33.60021 \\text{ GPa}.\n$$\n四舍五入到四位有效数字，得到\n$$\nC_{\\mathrm{alg}} \\approx 33.60 \\text{ GPa}.\n$$", "answer": "$$\\boxed{33.60}$$", "id": "2587040"}, {"introduction": "在一维概念的基础上，本练习将难度提升至二维平面应变情景，这更能代表现实世界中的问题。您将实现一个程序来计算总能量密度，该程序包含用于处理混合模式断裂的拉压谱分解。这项实践让您直接体验计算相场模拟中被最小化的核心能量泛函。[@problem_id:2586994]", "problem": "构建一个程序，用于在小应变、平面应变线弹性条件下，采用拉压谱分解方法，计算一个材料点的相场混合模式脆性断裂能量密度。其基础是弹性应变能密度和裂纹表面密度泛函。从各向同性线弹性的基本弹性能、小应变张量的谱分解以及一个标准的相场二次退化函数开始。\n\n从以下基本陈述开始：\n- 无穷小应变张量为 $\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\mathsf{T}}\\right)$，其中 $\\boldsymbol{u}$ 是位移场。\n- 对于各向同性线弹性（平面应变），未损伤应变能密度为 $\\psi_{0}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\lambda \\left(\\operatorname{tr}\\boldsymbol{\\varepsilon}\\right)^{2} + \\mu\\,\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon}$，其中 Lamé 参数 $\\lambda$ 和 $\\mu$ 与 Young 模量 $E$ 和 Poisson 比 $\\nu$ 的关系为 $\\mu = \\dfrac{E}{2(1+\\nu)}$ 和 $\\lambda = \\dfrac{E\\nu}{(1+\\nu)(1-2\\nu)}$。\n- 设 $\\boldsymbol{\\varepsilon}$ 的谱分解为 $\\boldsymbol{\\varepsilon} = \\sum_{i=1}^{2}\\varepsilon_{i}\\,\\boldsymbol{n}_{i}\\otimes \\boldsymbol{n}_{i}$，其中主应变为 $\\varepsilon_{i}$，平面内的标准正交特征向量为 $\\boldsymbol{n}_{i}$。定义正、负应变张量为\n$$\n\\boldsymbol{\\varepsilon}_{+} = \\sum_{i=1}^{2}\\langle \\varepsilon_{i}\\rangle_{+}\\,\\boldsymbol{n}_{i}\\otimes \\boldsymbol{n}_{i},\\qquad \n\\boldsymbol{\\varepsilon}_{-} = \\sum_{i=1}^{2}\\langle \\varepsilon_{i}\\rangle_{-}\\,\\boldsymbol{n}_{i}\\otimes \\boldsymbol{n}_{i},\n$$\n其中 $\\langle x\\rangle_{+} = \\max(x,0)$ 且 $\\langle x\\rangle_{-} = \\min(x,0)$。\n- 未损伤能量的拉压分解由下式给出\n$$\n\\psi_{+}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\lambda\\,\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_{+}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}_{+}:\\boldsymbol{\\varepsilon}_{+},\\qquad\n\\psi_{-}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\lambda\\,\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_{-}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}_{-}:\\boldsymbol{\\varepsilon}_{-}.\n$$\n这种分解方式可以防止压缩状态驱动损伤演化，同时保留其弹性能。\n- 设退化函数为 $g(d) = (1-d)^{2} + \\kappa$，其中 $\\kappa > 0$ 为一个小的残余刚度。单位体积的裂纹表面密度项为\n$$\n\\gamma(d,\\nabla d) = \\frac{G_{c}}{2\\ell}d^{2} + \\frac{G_{c}\\ell}{2}\\,|\\nabla d|^{2},\n$$\n其中 $G_{c}$ 是临界能量释放率，$\\ell$ 是内禀长度尺度。\n- 采用拉压分解的总混合模式断裂能量密度为\n$$\nW(\\boldsymbol{\\varepsilon},d,\\nabla d) = g(d)\\,\\psi_{+}(\\boldsymbol{\\varepsilon}) + \\psi_{-}(\\boldsymbol{\\varepsilon}) + \\gamma(d,\\nabla d).\n$$\n\n你的任务是实现一个程序，该程序针对一组给定的材料参数以及 $\\boldsymbol{\\varepsilon}$、$d$ 和 $\\nabla d$ 的多个测试用例，计算一个点上的 $W(\\boldsymbol{\\varepsilon},d,\\nabla d)$。计算必须：\n- 使用 $\\boldsymbol{\\varepsilon}$ 的谱分解来构建 $\\boldsymbol{\\varepsilon}_{+}$ 和 $\\boldsymbol{\\varepsilon}_{-}$。\n- 使用拉压分解，以便只有 $\\psi_{+}$ 被 $g(d)$ 退化。\n- 使用与 $E$ 和 $\\nu$ 相关的、一致的平面应变表达式来计算 $\\lambda$ 和 $\\mu$。\n\n所有输入均采用国际单位制（SI）：\n- Young 模量 $E$ 的单位是帕斯卡（$\\mathrm{Pa}$）。\n- Poisson 比 $\\nu$ 是无量纲的。\n- 临界能量释放率 $G_{c}$ 的单位是焦耳/平方米（$\\mathrm{J}/\\mathrm{m}^{2}$）。\n- 长度尺度 $\\ell$ 的单位是米（$\\mathrm{m}$）。\n- 应变张量分量是无量纲的。\n- 相场变量 $d$ 是无量纲的。\n- 相场梯度分量的单位是米的倒数（$\\mathrm{m}^{-1}$）。\n- 输出的能量密度 $W$ 必须以焦耳/立方米（$\\mathrm{J}/\\mathrm{m}^{3}$）为单位报告。\n\n测试套件和要求的数值：\n- 所有用例的通用材料参数：$E = 2.10\\times 10^{11}\\ \\mathrm{Pa}$，$\\nu = 0.30$，$G_{c} = 2.70\\times 10^{3}\\ \\mathrm{J}/\\mathrm{m}^{2}$，$\\ell = 1.0\\times 10^{-3}\\ \\mathrm{m}$，$\\kappa = 1.0\\times 10^{-6}$。\n- 用例 $1$（单轴拉伸，通过分解进行混合模式检查）：\n  - $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} 1.0\\times 10^{-3} & 0 \\\\ 0 & 0 \\end{bmatrix}$，\n  - $d = 4.0\\times 10^{-1}$，\n  - $\\nabla d = \\begin{bmatrix} 1.0\\times 10^{2} \\\\ -5.0\\times 10^{1} \\end{bmatrix}\\ \\mathrm{m}^{-1}$。\n- 用例 $2$（纯剪切，II 型）：\n  - 设 $\\gamma = 2.0\\times 10^{-3}$，$\\boldsymbol{\\varepsilon} = \\begin{bmatrix} 0 & \\gamma/2 \\\\ \\gamma/2 & 0 \\end{bmatrix}$，\n  - $d = 2.0\\times 10^{-1}$，\n  - $\\nabla d = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}\\ \\mathrm{m}^{-1}$。\n- 用例 $3$（均匀压缩，压缩分解）：\n  - $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} -8.0\\times 10^{-4} & 0 \\\\ 0 & -8.0\\times 10^{-4} \\end{bmatrix}$，\n  - $d = 9.0\\times 10^{-1}$，\n  - $\\nabla d = \\begin{bmatrix} 2.0\\times 10^{2} \\\\ 2.0\\times 10^{2} \\end{bmatrix}\\ \\mathrm{m}^{-1}$。\n- 用例 $4$（零应变，仅含梯度的裂纹表面项）：\n  - $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} 0 & 0 \\\\ 0 & 0 \\end{bmatrix}$，\n  - $d = 5.0\\times 10^{-1}$，\n  - $\\nabla d = \\begin{bmatrix} 1.0\\times 10^{1} \\\\ -1.0\\times 10^{1} \\end{bmatrix}\\ \\mathrm{m}^{-1}$。\n- 用例 $5$（双轴混合拉压）：\n  - $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} 1.5\\times 10^{-3} & 0 \\\\ 0 & -5.0\\times 10^{-4} \\end{bmatrix}$，\n  - $d = 1.0\\times 10^{-1}$，\n  - $\\nabla d = \\begin{bmatrix} 0 \\\\ 1.0\\times 10^{2} \\end{bmatrix}\\ \\mathrm{m}^{-1}$。\n\n你的程序必须为上述每个用例计算 $W$，并生成一行输出，该行输出包含一个用方括号括起来的、以逗号分隔的结果列表，例如 $[w_{1},w_{2},w_{3},w_{4},w_{5}]$，其中每个 $w_{i}$ 是用例 $i$ 的 $W$ 值（单位为 $\\mathrm{J}/\\mathrm{m}^{3}$），以小数点后保留六位的小数浮点数格式打印（例如，$123.456789$ 应打印为 $123.456789$，$1.0\\times 10^{3}$ 应打印为 $1000.000000$）。不应打印任何额外文本。程序不得读取任何输入，并且必须能直接执行。", "solution": "该问题要求计算在平面应变线弹性条件下，一个材料点的总相场断裂能量密度，记作 $W(\\boldsymbol{\\varepsilon},d,\\nabla d)$。该模型采用了弹性应变能的拉压分解，以确保只有拉伸状态对材料退化有贡献。任务是在给定一组材料参数和状态变量的情况下，对五个不同的测试用例评估该能量密度。\n\n首先，我们根据所提供的定义建立理论框架。总能量密度 $W$ 由三部分组成：退化的拉伸弹性能、未退化的压缩弹性能以及裂纹表面能。其控制方程为：\n$$\nW(\\boldsymbol{\\varepsilon},d,\\nabla d) = g(d)\\,\\psi_{+}(\\boldsymbol{\\varepsilon}) + \\psi_{-}(\\boldsymbol{\\varepsilon}) + \\gamma(d,\\nabla d)\n$$\n其中 $\\boldsymbol{\\varepsilon}$ 是无穷小应变张量，$d$ 是代表损伤的相场变量（$d=0$ 表示材料完好，$d=1$ 表示完全断裂），$\\nabla d$ 是其梯度。\n\n总能量的各分量定义如下：\n1.  **应变能分解**：应变能被加法分解为一个拉伸部分 $\\psi_{+}(\\boldsymbol{\\varepsilon})$ 和一个压缩部分 $\\psi_{-}(\\boldsymbol{\\varepsilon})$。该分解基于应变张量 $\\boldsymbol{\\varepsilon} = \\sum_{i=1}^{2}\\varepsilon_{i}\\,\\boldsymbol{n}_{i}\\otimes \\boldsymbol{n}_{i}$ 的谱分解，其中 $\\varepsilon_{i}$ 是主应变。\n    拉伸和压缩能量部分为：\n    $$\n    \\psi_{+}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\lambda\\,\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_{+}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}_{+}:\\boldsymbol{\\varepsilon}_{+}\n    $$\n    $$\n    \\psi_{-}(\\boldsymbol{\\varepsilon}) = \\tfrac{1}{2}\\lambda\\,\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_{-}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}_{-}:\\boldsymbol{\\varepsilon}_{-}\n    $$\n    此处，$\\langle x\\rangle_{+} = \\max(x,0)$ 且 $\\langle x\\rangle_{-} = \\min(x,0)$。项 $\\boldsymbol{\\varepsilon}_{+}:\\boldsymbol{\\varepsilon}_{+}$ 和 $\\boldsymbol{\\varepsilon}_{-}:\\boldsymbol{\\varepsilon}_{-}$ 分别由主应变计算得出，即 $\\sum_{i=1}^{2}(\\langle \\varepsilon_{i}\\rangle_{+})^{2}$ 和 $\\sum_{i=1}^{2}(\\langle \\varepsilon_{i}\\rangle_{-})^{2}$。Lamé 参数 $\\lambda$ 和 $\\mu$ 在平面应变条件下由 Young 模量 $E$ 和 Poisson 比 $\\nu$ 定义：\n    $$\n    \\mu = \\frac{E}{2(1+\\nu)}, \\qquad \\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}\n    $$\n2.  **退化函数**：能量的拉伸部分由函数 $g(d)$ 退化：\n    $$\n    g(d) = (1-d)^{2} + \\kappa\n    $$\n    其中 $\\kappa$ 是一个小参数，用以确保问题在完全退化（$d=1$）时的适定性。\n\n3.  **裂纹表面密度**：与裂纹表面形成相关的能量使用相场及其梯度进行正则化：\n    $$\n    \\gamma(d,\\nabla d) = \\frac{G_{c}}{2\\ell}d^{2} + \\frac{G_{c}\\ell}{2}\\,|\\nabla d|^{2}\n    $$\n    其中 $G_c$ 是材料的临界能量释放率，$\\ell$ 是一个控制正则化裂纹宽度的长度尺度参数。\n\n每个测试用例的计算过程如下：\n\n1.  根据给定的材料属性 $E = 2.10\\times 10^{11}\\,\\mathrm{Pa}$ 和 $\\nu = 0.30$ 计算 Lamé 参数 $\\lambda$ 和 $\\mu$。\n    $$\n    \\mu = \\frac{2.10\\times 10^{11}}{2(1+0.30)} = \\frac{2.10\\times 10^{11}}{2.6} \\approx 8.076923 \\times 10^{10}\\,\\mathrm{Pa}\n    $$\n    $$\n    \\lambda = \\frac{(2.10\\times 10^{11})(0.30)}{(1+0.30)(1-2 \\times 0.30)} = \\frac{0.63\\times 10^{11}}{1.3 \\times 0.4} = \\frac{0.63\\times 10^{11}}{0.52} \\approx 1.211538 \\times 10^{11}\\,\\mathrm{Pa}\n    $$\n2.  对于给定的应变张量 $\\boldsymbol{\\varepsilon}$，通过求解 $\\boldsymbol{\\varepsilon}$ 矩阵表示的特征值来计算其主应变 $\\varepsilon_1, \\varepsilon_2$。\n3.  计算主应变和迹的正、负部分：$\\langle \\varepsilon_{i}\\rangle_{+}$、$\\langle \\varepsilon_{i}\\rangle_{-}$、$\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_{+}$ 和 $\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_{-}$。\n4.  计算能量分量 $\\psi_{+}(\\boldsymbol{\\varepsilon})$ 和 $\\psi_{-}(\\boldsymbol{\\varepsilon})$。\n5.  使用给定的 $d$ 值和 $\\kappa = 1.0\\times 10^{-6}$ 计算退化函数 $g(d)$。\n6.  使用给定的 $d$、$\\nabla d$、$G_{c} = 2.70\\times 10^{3}\\,\\mathrm{J}/\\mathrm{m}^{2}$ 和 $\\ell = 1.0\\times 10^{-3}\\,\\mathrm{m}$ 计算裂纹表面密度 $\\gamma(d,\\nabla d)$。\n7.  最后，使用主公式组装总能量密度 $W$。\n\n我们现在将此过程应用于每个测试用例。\n\n**用例 1**：\n- $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} 1.0\\times 10^{-3} & 0 \\\\ 0 & 0 \\end{bmatrix}$，$d = 0.4$，$\\nabla d = [100, -50]^{\\mathsf{T}}\\,\\mathrm{m}^{-1}$。\n- 主应变：$\\varepsilon_1 = 1.0\\times 10^{-3}$, $\\varepsilon_2 = 0$。\n- 应变部分：$\\langle \\varepsilon_1 \\rangle_+ = 1.0\\times 10^{-3}$, $\\langle \\varepsilon_2 \\rangle_+ = 0$。$\\langle \\varepsilon_1 \\rangle_- = 0$, $\\langle \\varepsilon_2 \\rangle_- = 0$。$\\operatorname{tr}\\boldsymbol{\\varepsilon} = 1.0\\times 10^{-3}$，所以 $\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_+ = 1.0\\times 10^{-3}$ 且 $\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_- = 0$。\n- 能量分量：\n  $\\psi_+ = \\frac{1}{2}\\lambda(10^{-3})^2 + \\mu(10^{-3})^2 = (\\frac{\\lambda}{2} + \\mu) \\times 10^{-6} \\approx 141346.15\\,\\mathrm{J}/\\mathrm{m}^3$。\n  $\\psi_- = 0$。\n- 退化：$g(0.4) = (1-0.4)^2 + 10^{-6} = 0.360001$。\n- 裂纹能：$|\\nabla d|^2 = 100^2 + (-50)^2 = 12500$。\n  $\\gamma = \\frac{2700}{2\\times 10^{-3}}(0.4)^2 + \\frac{2700 \\times 10^{-3}}{2}(12500) = 216000 + 16875 = 232875\\,\\mathrm{J}/\\mathrm{m}^3$。\n- 总能量：$W_1 = (0.360001) \\times 141346.15... + 0 + 232875 \\approx 50884.76 + 232875 \\approx 283759.76\\,\\mathrm{J}/\\mathrm{m}^3$。\n\n**用例 2**：\n- $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} 0 & 1.0\\times 10^{-3} \\\\ 1.0\\times 10^{-3} & 0 \\end{bmatrix}$，$d = 0.2$，$\\nabla d = [0, 0]^{\\mathsf{T}}\\,\\mathrm{m}^{-1}$。\n- 主应变：$\\varepsilon_1 = 1.0\\times 10^{-3}$, $\\varepsilon_2 = -1.0\\times 10^{-3}$。\n- 应变部分：$\\langle \\varepsilon_1 \\rangle_+ = 1.0\\times 10^{-3}$, $\\langle \\varepsilon_2 \\rangle_+ = 0$。$\\langle \\varepsilon_1 \\rangle_- = 0$, $\\langle \\varepsilon_2 \\rangle_- = -1.0\\times 10^{-3}$。$\\operatorname{tr}\\boldsymbol{\\varepsilon} = 0$，所以 $\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_+ = 0$ 且 $\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_- = 0$。\n- 能量部分：\n  $\\psi_+ = \\mu(10^{-3})^2 \\approx 80769.23\\,\\mathrm{J}/\\mathrm{m}^3$。\n  $\\psi_- = \\mu(-10^{-3})^2 \\approx 80769.23\\,\\mathrm{J}/\\mathrm{m}^3$。\n- 退化：$g(0.2) = (1-0.2)^2 + 10^{-6} = 0.640001$。\n- 裂纹能：$|\\nabla d|^2 = 0$。\n  $\\gamma = \\frac{2700}{2\\times 10^{-3}}(0.2)^2 + 0 = 54000\\,\\mathrm{J}/\\mathrm{m}^3$。\n- 总能量：$W_2 = (0.640001) \\times 80769.23... + 80769.23... + 54000 \\approx 51692.39 + 80769.23 + 54000 \\approx 186461.62\\,\\mathrm{J}/\\mathrm{m}^3$。\n\n**用例 3**：\n- $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} -8.0\\times 10^{-4} & 0 \\\\ 0 & -8.0\\times 10^{-4} \\end{bmatrix}$，$d = 0.9$，$\\nabla d = [200, 200]^{\\mathsf{T}}\\,\\mathrm{m}^{-1}$。\n- 主应变：$\\varepsilon_1 = -8.0\\times 10^{-4}$, $\\varepsilon_2 = -8.0\\times 10^{-4}$。\n- 应变部分：所有正部分均为零。$\\langle \\varepsilon_1 \\rangle_- = -8.0\\times 10^{-4}$, $\\langle \\varepsilon_2 \\rangle_- = -8.0\\times 10^{-4}$。$\\operatorname{tr}\\boldsymbol{\\varepsilon} = -1.6\\times 10^{-3}$，所以 $\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_- = -1.6\\times 10^{-3}$。\n- 能量部分：\n  $\\psi_+ = 0$。\n  $\\psi_- = \\frac{1}{2}\\lambda(-1.6\\times 10^{-3})^2 + \\mu(2 \\times (-8.0\\times 10^{-4})^2) = 1.28(\\lambda+\\mu)\\times 10^{-6} \\approx 258461.54\\,\\mathrm{J}/\\mathrm{m}^3$。\n- 退化：$g(0.9) = (1-0.9)^2 + 10^{-6} = 0.010001$。\n- 裂纹能：$|\\nabla d|^2 = 200^2 + 200^2 = 80000$。\n  $\\gamma = \\frac{2700}{2\\times 10^{-3}}(0.9)^2 + \\frac{2700 \\times 10^{-3}}{2}(80000) = 1093500 + 108000 = 1201500\\,\\mathrm{J}/\\mathrm{m}^3$。\n- 总能量：$W_3 = 0 + 258461.54... + 1201500 \\approx 1459961.54\\,\\mathrm{J}/\\mathrm{m}^3$。\n\n**用例 4**：\n- $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} 0 & 0 \\\\ 0 & 0 \\end{bmatrix}$，$d = 0.5$，$\\nabla d = [10, -10]^{\\mathsf{T}}\\,\\mathrm{m}^{-1}$。\n- 主应变：$\\varepsilon_1 = 0$, $\\varepsilon_2 = 0$。\n- 应变部分：所有与应变相关的项均为零。\n- 能量部分：$\\psi_+ = 0$, $\\psi_- = 0$。\n- 退化：$g(0.5) = (1-0.5)^2 + 10^{-6} = 0.250001$。\n- 裂纹能：$|\\nabla d|^2 = 10^2 + (-10)^2 = 200$。\n  $\\gamma = \\frac{2700}{2\\times 10^{-3}}(0.5)^2 + \\frac{2700 \\times 10^{-3}}{2}(200) = 337500 + 270 = 337770\\,\\mathrm{J}/\\mathrm{m}^3$。\n- 总能量：$W_4 = 0 + 0 + 337770 = 337770.00\\,\\mathrm{J}/\\mathrm{m}^3$。\n\n**用例 5**：\n- $\\boldsymbol{\\varepsilon} = \\begin{bmatrix} 1.5\\times 10^{-3} & 0 \\\\ 0 & -5.0\\times 10^{-4} \\end{bmatrix}$，$d = 0.1$，$\\nabla d = [0, 100]^{\\mathsf{T}}\\,\\mathrm{m}^{-1}$。\n- 主应变：$\\varepsilon_1 = 1.5\\times 10^{-3}$, $\\varepsilon_2 = -5.0\\times 10^{-4}$。\n- 应变部分：$\\langle \\varepsilon_1 \\rangle_+ = 1.5\\times 10^{-3}$, $\\langle \\varepsilon_2 \\rangle_+ = 0$。$\\langle \\varepsilon_1 \\rangle_- = 0$, $\\langle \\varepsilon_2 \\rangle_- = -5.0\\times 10^{-4}$。$\\operatorname{tr}\\boldsymbol{\\varepsilon} = 1.0\\times 10^{-3}$，所以 $\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_+ = 1.0\\times 10^{-3}$ 且 $\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon}\\rangle_- = 0$。\n- 能量部分：\n  $\\psi_+ = \\frac{1}{2}\\lambda(10^{-3})^2 + \\mu(1.5\\times 10^{-3})^2 = (0.5\\lambda + 2.25\\mu)\\times 10^{-6} \\approx 242307.69\\,\\mathrm{J}/\\mathrm{m}^3$。\n  $\\psi_- = \\mu(-5.0\\times 10^{-4})^2 = 0.25\\mu\\times 10^{-6} \\approx 20192.31\\,\\mathrm{J}/\\mathrm{m}^3$。\n- 退化：$g(0.1) = (1-0.1)^2 + 10^{-6} = 0.810001$。\n- 裂纹能：$|\\nabla d|^2 = 0^2 + 100^2 = 10000$。\n  $\\gamma = \\frac{2700}{2\\times 10^{-3}}(0.1)^2 + \\frac{2700 \\times 10^{-3}}{2}(10000) = 13500 + 13500 = 27000\\,\\mathrm{J}/\\mathrm{m}^3$。\n- 总能量：$W_5 = (0.810001) \\times 242307.69... + 20192.31... + 27000 \\approx 196270.00 + 20192.31 + 27000 \\approx 243462.31\\,\\mathrm{J}/\\mathrm{m}^3$。\n\n五个用例计算出的能量密度总结如下：\n$W_1 \\approx 283759.756795\\,\\mathrm{J}/\\mathrm{m}^3$\n$W_2 \\approx 186461.619231\\,\\mathrm{J}/\\mathrm{m}^3$\n$W_3 \\approx 1459961.538462\\,\\mathrm{J}/\\mathrm{m}^3$\n$W_4 = 337770.000000\\,\\mathrm{J}/\\mathrm{m}^3$\n$W_5 \\approx 243462.307692\\,\\mathrm{J}/\\mathrm{m}^3$\n实现将基于这些计算进行。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the phase-field mixed-mode brittle fracture energy density\n    for a set of test cases.\n    \"\"\"\n    # Common material parameters (SI units)\n    E = 2.10e11  # Young's modulus (Pa)\n    nu = 0.30    # Poisson's ratio\n    Gc = 2.70e3  # Critical energy release rate (J/m^2)\n    l = 1.0e-3   # Length scale (m)\n    kappa = 1.0e-6 # Residual stiffness parameter\n\n    # Define the test cases\n    test_cases = [\n        # Case 1: Uniaxial tension, mixed-mode check via split\n        {\n            \"eps\": np.array([[1.0e-3, 0.0], [0.0, 0.0]]),\n            \"d\": 4.0e-1,\n            \"grad_d\": np.array([1.0e2, -5.0e1])\n        },\n        # Case 2: Pure shear, Mode II\n        {\n            \"eps\": np.array([[0.0, 1.0e-3], [1.0e-3, 0.0]]), # gamma = 2e-3, eps_xy = gamma/2\n            \"d\": 2.0e-1,\n            \"grad_d\": np.array([0.0, 0.0])\n        },\n        # Case 3: Uniform compression, compression split\n        {\n            \"eps\": np.array([[-8.0e-4, 0.0], [0.0, -8.0e-4]]),\n            \"d\": 9.0e-1,\n            \"grad_d\": np.array([2.0e2, 2.0e2])\n        },\n        # Case 4: Zero strain, gradient-only crack surface term\n        {\n            \"eps\": np.array([[0.0, 0.0], [0.0, 0.0]]),\n            \"d\": 5.0e-1,\n            \"grad_d\": np.array([1.0e1, -1.0e1])\n        },\n        # Case 5: Biaxial mixed tension-compression\n        {\n            \"eps\": np.array([[1.5e-3, 0.0], [0.0, -5.0e-4]]),\n            \"d\": 1.0e-1,\n            \"grad_d\": np.array([0.0, 1.0e2])\n        }\n    ]\n\n    # Calculate Lamé parameters for plane strain\n    mu = E / (2 * (1 + nu))\n    lambda_ = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n\n    results = []\n    for case in test_cases:\n        eps = case[\"eps\"]\n        d = case[\"d\"]\n        grad_d = case[\"grad_d\"]\n\n        # 1. Spectral decomposition of the strain tensor\n        # For a 2x2 symmetric matrix, eigenvalues are the principal strains\n        principal_strains = np.linalg.eigvalsh(eps)\n\n        # 2. Compute positive and negative parts\n        tr_eps = np.sum(principal_strains)\n        tr_eps_plus = max(tr_eps, 0)\n        tr_eps_minus = min(tr_eps, 0)\n\n        eps_plus_vals = np.maximum(principal_strains, 0)\n        eps_minus_vals = np.minimum(principal_strains, 0)\n        \n        # The term eps_p:eps_p is sum(eps_p_i^2)\n        eps_plus_dot_eps_plus = np.sum(eps_plus_vals**2)\n        # The term eps_m:eps_m is sum(eps_m_i^2)\n        eps_minus_dot_eps_minus = np.sum(eps_minus_vals**2)\n        \n        # 3. Calculate tensile and compressive strain energy densities\n        psi_plus = 0.5 * lambda_ * tr_eps_plus**2 + mu * eps_plus_dot_eps_plus\n        psi_minus = 0.5 * lambda_ * tr_eps_minus**2 + mu * eps_minus_dot_eps_minus\n\n        # 4. Calculate degradation function\n        g_d = (1 - d)**2 + kappa\n\n        # 5. Calculate crack surface density\n        grad_d_norm_sq = np.sum(grad_d**2)\n        gamma = (Gc / (2 * l)) * d**2 + (Gc * l / 2) * grad_d_norm_sq\n\n        # 6. Assemble total energy density\n        W = g_d * psi_plus + psi_minus + gamma\n        results.append(W)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n```", "id": "2586994"}, {"introduction": "一个理论模型的优劣取决于其描述物理现实的能力，这需要根据实验数据校准其参数。本练习将引导您推导模型内部参数（$G_c$ 和 $\\ell$）与可测量的宏观属性（如抗拉强度和断裂过程区宽度）之间的解析关系。接着，您将编写一个程序来执行此校准，从而弥合理论与实际工程应用之间的鸿沟。[@problem_id:2587016]", "problem": "考虑一根长度为 $L$、横截面积为 $A$ 的一维小应变单轴杆，其两端受到单调递增的拉伸位移。该过程使用 Ambrosio-Tortorelli 类型（AT2）的脆性相场方法进行建模。设 $u(x)$ 表示位移，$d(x) \\in [0,1]$ 表示裂纹相场变量，其中 $d=0$ 对应于完好状态，$d=1$ 对应于完全断裂状态。假设材料具有线性弹性本构行为，杨氏模量为 $E$，并采用标准的 AT2 能量正则化方法处理脆性断裂，其中内禀长度尺度为 $\\ell$，临界能量释放率为 $G_c$。\n\n单位面积的总能量泛函（忽略恒定的横截面并将能量在杆上积分）由下式给出：\n$$\n\\mathcal{E}[u,d] \\;=\\; \\int_{0}^{L} \\left( g(d)\\,\\psi_e(\\varepsilon(u)) \\;+\\; G_c\\,\\gamma_\\ell(d,d') \\right)\\,\\mathrm{d}x,\n$$\n其中，小应变张量简化为一维应变 $\\varepsilon(u)=u'(x)$，弹性应变能密度为 $\\psi_e(\\varepsilon) = \\tfrac{1}{2}E\\,\\varepsilon^2$，退化函数为 $g(d)=(1-d)^2+\\eta$ (其中 $\\eta \\to 0^{+}$)，裂纹面密度为\n$$\n\\gamma_\\ell(d,d') \\;=\\; \\frac{1}{2\\ell}\\,d^2 \\;+\\; \\frac{\\ell}{2}\\,(d')^2.\n$$\n\n从变分法和能量最小化原理出发，并且仅使用上述定义和标准的小应变线性弹性理论，完成以下任务：\n\n1) 对于均匀应变 $\\varepsilon$ 状态，推导关于均匀相场 $d$ 的驻值条件，并由此获得在能量驻定状态下名义应力 $\\sigma(\\varepsilon)$ 作为 $\\varepsilon$ 的函数。在一个位移控制试验中，使用软化现象的分岔起始论证，确定均匀响应达到峰值并开始退化时的临界名义应力 $\\sigma_c$。您的推导必须明确显示，仅基于所提供的能量结构，$\\sigma_c$ 的标度关系如何依赖于 $E$、$G_c$ 和 $\\ell$。\n\n2) 考虑在一个无限一维域中，零载荷下的静态孤立裂纹剖面。该剖面通过仅最小化断裂正则化项来确定，并满足边界条件 $d(0)=1$ 和 $\\lim_{|x|\\to\\infty}d(x)=0$。推导 $d(x)$ 的闭式解，并用它来定义相场剖面的半峰全宽 (full width at half maximum) $w$，即 $d(x)=\\tfrac{1}{2}$ 的两点之间的距离。用 $\\ell$ 表示 $w$。\n\n3) 使用您在 (1) 和 (2) 中得到的结果，消去 $\\ell$ 和 $G_c$，代之以可测量的物理量。给定弹性模量 $E$、在峰值载荷下测得的临界名义应力 $\\sigma_c$ 以及观测到的损伤带的半峰全宽 $w$，使用您获得的 AT2 模型方程，推导 $G_c$ 和 $\\ell$ 的显式标定公式。\n\n4) 实现一个程序，对于下方的每个测试用例，该程序接收输入的 $E$ (单位：帕斯卡)、$\\sigma_c$ (单位：帕斯卡) 和 $w$ (单位：米)，计算 $\\ell$ (单位：米) 和 $G_c$ (单位：焦耳/平方米)，并返回数对 $(G_c, \\ell)$。\n\n使用以下测试套件（每个测试是一个三元组 $(E, \\sigma_c, w)$，单位为国际单位制）：\n- 测试 1：$(7.0\\times 10^{10},\\; 3.0\\times 10^{8},\\; 6.0\\times 10^{-4})$\n- 测试 2：$(2.10\\times 10^{11},\\; 1.0\\times 10^{9},\\; 2.0\\times 10^{-4})$\n- 测试 3：$(3.0\\times 10^{9},\\; 6.0\\times 10^{7},\\; 3.0\\times 10^{-3})$\n- 测试 4：$(5.0\\times 10^{10},\\; 2.0\\times 10^{8},\\; 1.0\\times 10^{-6})$\n\n最终输出要求：\n- 单位：$G_c$ 以焦耳/平方米报告，$\\ell$ 以米报告。\n- 输出格式：您的程序应生成一行输出，其中包含所有测试的结果，格式为一个由方括号括起来的逗号分隔列表，数对按顺序平铺展开，即 $[G_{c}^{(1)},\\ell^{(1)},G_{c}^{(2)},\\ell^{(2)},G_{c}^{(3)},\\ell^{(3)},G_{c}^{(4)},\\ell^{(4)}]$。\n- 数值格式：每个数字必须打印为具有六位有效数字的浮点值。", "solution": "**第一部分：临界应力的推导**\n\n问题要求分析一个均匀状态，其中应变 $\\varepsilon$ 和相场 $d$ 在整个杆上都是均匀的。因此，$\\varepsilon(x) = \\varepsilon$ 和 $d(x) = d$ 是常数，这意味着 $d' = 0$。总能量的被积函数（代表能量密度 $\\Psi$）简化为：\n$$\n\\Psi(\\varepsilon, d) = g(d)\\,\\psi_e(\\varepsilon) + G_c\\,\\gamma_\\ell(d,0) = (1-d)^2 \\frac{1}{2}E\\varepsilon^2 + \\frac{G_c}{2\\ell}d^2\n$$\n能量驻定性要求对于给定的施加应变 $\\varepsilon$，能量密度相对于内部变量 $d$ 最小化。此条件通过将 $\\Psi$ 对 $d$ 的偏导数设为零来找到：\n$$\n\\frac{\\partial \\Psi}{\\partial d} = 2(1-d)(-1) \\frac{1}{2}E\\varepsilon^2 + \\frac{G_c}{\\ell}d = 0\n$$\n$$\n-(1-d)E\\varepsilon^2 + \\frac{G_c}{\\ell}d = 0\n$$\n求解平衡相场值 $d$ 作为应变 $\\varepsilon$ 的函数：\n$$\nd\\left(E\\varepsilon^2 + \\frac{G_c}{\\ell}\\right) = E\\varepsilon^2 \\quad \\implies \\quad d(\\varepsilon) = \\frac{E\\varepsilon^2}{E\\varepsilon^2 + G_c/\\ell}\n$$\n退化材料中的名义应力 $\\sigma$ 由弹性应变能密度对应变的导数给出，并由退化函数进行缩放：\n$$\n\\sigma = \\frac{\\partial (g(d)\\psi_e)}{\\partial \\varepsilon} = g(d) \\frac{\\partial \\psi_e}{\\partial \\varepsilon} = (1-d)^2 E \\varepsilon\n$$\n将 $d(\\varepsilon)$ 的平衡表达式代入应力关系式需要首先计算 $(1-d)$：\n$$\n1 - d(\\varepsilon) = 1 - \\frac{E\\varepsilon^2}{E\\varepsilon^2 + G_c/\\ell} = \\frac{E\\varepsilon^2 + G_c/\\ell - E\\varepsilon^2}{E\\varepsilon^2 + G_c/\\ell} = \\frac{G_c/\\ell}{E\\varepsilon^2 + G_c/\\ell}\n$$\n现在，我们得到应力作为应变的显式函数：\n$$\n\\sigma(\\varepsilon) = \\left(\\frac{G_c/\\ell}{E\\varepsilon^2 + G_c/\\ell}\\right)^2 E\\varepsilon = \\frac{(G_c/\\ell)^2 E \\varepsilon}{(E\\varepsilon^2 + G_c/\\ell)^2}\n$$\n临界应力 $\\sigma_c$ 是 $\\sigma(\\varepsilon)$ 的最大值，它对应于材料软化的开始。我们通过将 $\\sigma(\\varepsilon)$ 对应变 $\\varepsilon$ 的导数设为零来找到这个峰值：\n$$\n\\frac{\\mathrm{d}\\sigma}{\\mathrm{d}\\varepsilon} = (G_c/\\ell)^2 E \\frac{\\mathrm{d}}{\\mathrm{d}\\varepsilon} \\left[ \\frac{\\varepsilon}{(E\\varepsilon^2 + G_c/\\ell)^2} \\right] = 0\n$$\n应用商法则求导：\n$$\n1 \\cdot (E\\varepsilon^2 + G_c/\\ell)^2 - \\varepsilon \\cdot 2(E\\varepsilon^2 + G_c/\\ell)(2E\\varepsilon) = 0\n$$\n假设 $\\varepsilon \\neq 0$，我们可以除以 $(E\\varepsilon^2 + G_c/\\ell)$：\n$$\n(E\\varepsilon^2 + G_c/\\ell) - 4E\\varepsilon^2 = 0\n$$\n$$\nG_c/\\ell - 3E\\varepsilon^2 = 0\n$$\n这给出了应力达到最大值时的临界应变 $\\varepsilon_c$：\n$$\n\\varepsilon_c^2 = \\frac{G_c}{3E\\ell} \\quad \\implies \\quad \\varepsilon_c = \\sqrt{\\frac{G_c}{3E\\ell}}\n$$\n将 $\\varepsilon_c$ 代回 $\\sigma(\\varepsilon)$ 的表达式中，得到临界应力 $\\sigma_c$：\n$$\n\\sigma_c = \\sigma(\\varepsilon_c) = \\frac{(G_c/\\ell)^2 E \\varepsilon_c}{(E\\varepsilon_c^2 + G_c/\\ell)^2} = \\frac{(G_c/\\ell)^2 E \\sqrt{G_c/(3E\\ell)}}{(E(G_c/(3E\\ell)) + G_c/\\ell)^2}\n$$\n分母简化为：\n$$\n\\left(\\frac{G_c}{3\\ell} + \\frac{G_c}{\\ell}\\right)^2 = \\left(\\frac{4G_c}{3\\ell}\\right)^2 = \\frac{16}{9}\\left(\\frac{G_c}{\\ell}\\right)^2\n$$\n因此，临界应力为：\n$$\n\\sigma_c = \\frac{(G_c/\\ell)^2 E \\sqrt{G_c/(3E\\ell)}}{\\frac{16}{9}(G_c/\\ell)^2} = \\frac{9}{16} E \\sqrt{\\frac{G_c}{3E\\ell}} = \\frac{9}{16} \\sqrt{E^2 \\frac{G_c}{3E\\ell}} = \\frac{9}{16} \\sqrt{\\frac{EG_c}{3\\ell}}\n$$\n这可以写成：\n$$\n\\sigma_c = \\frac{3\\sqrt{3}}{16}\\sqrt{\\frac{EG_c}{\\ell}}\n$$\n这个结果按要求显示了 $\\sigma_c$ 与 $E$、$G_c$ 和 $\\ell$ 的标度关系。\n\n**第二部分：孤立裂纹剖面及宽度**\n\n对于无限域中零载荷下的孤立裂纹，弹性应变能项为零（$\\psi_e=0$）。总能量完全来自断裂正则化项。我们必须最小化：\n$$\n\\mathcal{E}[d] = \\int_{-\\infty}^{\\infty} G_c \\gamma_\\ell(d,d') \\mathrm{d}x = \\int_{-\\infty}^{\\infty} G_c \\left( \\frac{d^2}{2\\ell} + \\frac{\\ell (d')^2}{2} \\right) \\mathrm{d}x\n$$\n对应的最小化函数 $d(x)$ 的 Euler-Lagrange 方程是：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial d} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{\\partial \\mathcal{L}}{\\partial d'}\\right) = 0 \\quad \\text{其中 } \\mathcal{L} = G_c \\left( \\frac{d^2}{2\\ell} + \\frac{\\ell (d')^2}{2} \\right)\n$$\n$$\nG_c\\frac{d}{\\ell} - \\frac{\\mathrm{d}}{\\mathrm{d}x}(G_c\\ell d') = 0 \\quad \\implies \\quad \\frac{d}{\\ell} - \\ell d'' = 0\n$$\n$$\nd''(x) - \\frac{1}{\\ell^2}d(x) = 0\n$$\n这是一个标准的齐次二阶线性常微分方程。其通解为 $d(x) = C_1 e^{x/\\ell} + C_2 e^{-x/\\ell}$。我们应用边界条件：$d(0)=1$ 和 $\\lim_{|x|\\to\\infty}d(x)=0$。\n- 为了使解在 $x \\to \\infty$ 时衰减，必须有 $C_1=0$。因此，对于 $x \\ge 0$，$d(x) = C_2 e^{-x/\\ell}$。\n- 为了使解在 $x \\to -\\infty$ 时衰减，必须有 $C_2=0$。因此，对于 $x \\le 0$，$d(x) = C_1 e^{x/\\ell}$。\n结合这些条件并强制连续性和对称性（$d(x)=d(-x)$），解的形式为 $d(x) = C e^{-|x|/\\ell}$。应用中心点的条件，$d(0)=1$：\n$$\nC e^{-|0|/\\ell} = C = 1 \\implies d(x) = e^{-|x|/\\ell}\n$$\n半峰全宽 (full width at half maximum) $w$ 是 $d(x) = \\frac{1}{2}$ 的两点之间的距离。设 $x_h > 0$ 是满足该条件的点：\n$$\nd(x_h) = e^{-x_h/\\ell} = \\frac{1}{2}\n$$\n取两边的自然对数：\n$$\n-\\frac{x_h}{\\ell} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2) \\quad \\implies \\quad x_h = \\ell\\ln(2)\n$$\n根据对称性，另一个点在 $-x_h$ 处。全宽 $w$ 是这两点之间的距离：\n$$\nw = x_h - (-x_h) = 2x_h = 2\\ell\\ln(2)\n$$\n\n**第三部分：$G_c$ 和 $\\ell$ 的标定公式**\n\n我们已经推导了两个关键关系，将模型参数（$\\ell, G_c$）与可测量（$w, \\sigma_c, E$）联系起来：\n1.  $\\sigma_c = \\frac{3\\sqrt{3}}{16}\\sqrt{\\frac{EG_c}{\\ell}}$\n2.  $w = 2\\ell\\ln(2)$\n\n我们现在对这些方程进行代数操作，以用 $E$、$ \\sigma_c$ 和 $w$ 表示 $\\ell$ 和 $G_c$。\n从方程（2），我们可以直接解出长度尺度 $\\ell$：\n$$\n\\ell = \\frac{w}{2\\ln(2)}\n$$\n接下来，我们重新整理方程（1）来求解 $G_c$：\n$$\n\\sqrt{\\frac{EG_c}{\\ell}} = \\frac{16\\sigma_c}{3\\sqrt{3}}\n$$\n两边平方得到：\n$$\n\\frac{EG_c}{\\ell} = \\left(\\frac{16\\sigma_c}{3\\sqrt{3}}\\right)^2 = \\frac{256\\sigma_c^2}{27}\n$$\n$$\nG_c = \\frac{256\\sigma_c^2 \\ell}{27E}\n$$\n最后，我们将第一个标定公式中 $\\ell$ 的表达式代入这个 $G_c$ 的方程中以消去 $\\ell$：\n$$\nG_c = \\frac{256\\sigma_c^2}{27E} \\left(\\frac{w}{2\\ln(2)}\\right) = \\frac{128\\sigma_c^2 w}{27E\\ln(2)}\n$$\n最终的标定公式是：\n$$\n\\ell = \\frac{w}{2\\ln(2)} \\quad \\text{和} \\quad G_c = \\frac{128\\sigma_c^2 w}{27E\\ln(2)}\n$$\n这些公式允许直接从实验测量值计算相场模型参数。\n\n**第四部分：程序实现**\n该程序要求为给定的测试用例实现推导出的标定公式。这是第三部分结果的直接应用。代码将在最终答案块中按规定提供。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the phase-field parameters Gc and l based on macroscopic\n    material properties E, sigma_c, and w for the AT2 model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (E, sigma_c, w) in SI units.\n    test_cases = [\n        (7.0e10, 3.0e8, 6.0e-4),    # Test 1\n        (2.10e11, 1.0e9, 2.0e-4),   # Test 2\n        (3.0e9, 6.0e7, 3.0e-3),     # Test 3\n        (5.0e10, 2.0e8, 1.0e-6),    # Test 4\n    ]\n\n    results = []\n    \n    # Pre-calculate the natural logarithm of 2 for efficiency.\n    ln2 = np.log(2)\n\n    for E, sigma_c, w in test_cases:\n        # Based on the derived calibration formulas:\n        # l = w / (2 * ln(2))\n        # Gc = (128 * sigma_c^2 * w) / (27 * E * ln(2))\n\n        # Calculate the internal length scale, l (in meters).\n        ell = w / (2 * ln2)\n\n        # Calculate the critical energy release rate, Gc (in J/m^2).\n        # numerator = 128 * sigma_c**2 * w\n        # denominator = 27 * E * ln2\n        # Gc = numerator / denominator\n        \n        # Alternatively, using the derived relation involving ell:\n        # Gc = (256 * sigma_c**2 / (27 * E)) * ell\n        # This form is also valid but reuses a calculated value. Let's use the\n        # primary formula derived in the solution.\n        Gc = (128 * sigma_c**2 * w) / (27 * E * ln2)\n\n        # Append the formatted results to the list.\n        # The format specifier \".6g\" ensures 6 significant figures.\n        results.append(f\"{Gc:.6g}\")\n        results.append(f\"{ell:.6g}\")\n\n    # Final print statement in the exact required format:\n    # [Gc_1, l_1, Gc_2, l_2, ...]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2587016"}]}