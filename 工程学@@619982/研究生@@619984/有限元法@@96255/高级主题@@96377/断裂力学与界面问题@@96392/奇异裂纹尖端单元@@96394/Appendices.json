{"hands_on_practices": [{"introduction": "奇异裂纹尖端单元的核心优势在于其能够精确模拟裂纹尖端的 $\\sqrt{r}$ 位移场。本练习将通过一个直接的数值验证来揭示这一特性。你将对比标准二次单元和四分之一点单元在近似解析解时的表现，从而亲手验证特殊的节点设置为什们能让简单的单元精确地插值出奇异场 [@problem_id:2596472]。这个实践将为你理解奇异单元的工作原理奠定坚实的基础。", "problem": "考虑在平面应变条件下，针对I型裂纹，根据二维各向同性线性弹性断裂力学（LEFM）中的尖端附近解析场，对奇异裂纹尖端插值进行验证。假设材料为均质、各向同性，其杨氏模量为 $E$，泊松比为 $\\nu$。令剪切模量为 $\\mu = \\dfrac{E}{2(1+\\nu)}$，Kolosov 常数为 $\\kappa = 3 - 4 \\nu$（平面应变）。在裂纹尖端附近，以尖端为中心的极坐标系 $(r,\\theta)$ 中（裂纹沿 $x$ 轴负向），对于应力强度因子为 $K_I$ 的 I 型裂纹，在 $\\theta = \\pm \\pi$ 裂纹面上的主导阶渐近位移是经过充分检验的 LEFM 结果：\n$$\nu_y^{\\pm}(r) = \\pm \\frac{K_I}{2 \\mu} \\sqrt{\\frac{r}{2 \\pi}} \\, (\\kappa + 1), \\quad u_x^{\\pm}(r) = 0,\n$$\n其中角度以弧度为单位，$r$ 的单位为米。定义常数\n$$\nC = \\frac{K_I}{2 \\mu} \\sqrt{\\frac{1}{2 \\pi}} (\\kappa + 1),\n$$\n使得在上裂纹面 $\\theta = \\pi$ 上有 $u_y^{+}(r) = C \\sqrt{r}$。\n\n重点是使用单个二次边（三节点）等参插值来近似上裂纹面 $r \\in [0, L]$ 段上的 $u_y^{+}(r)$，其中自然坐标为 $\\xi \\in [-1,1]$，边上的二次拉格朗日形函数为：\n- 尖端节点 $\\xi = -1$ 处，$N_1(\\xi) = \\dfrac{1}{2} \\xi (\\xi - 1)$，\n- 边中节点 $\\xi = 0$ 处，$N_5(\\xi) = 1 - \\xi^2$，\n- 远端节点 $\\xi = +1$ 处，$N_2(\\xi) = \\dfrac{1}{2} \\xi (\\xi + 1)$。\n\n对于等参关系 $r(\\xi) = N_1(\\xi) r_1 + N_5(\\xi) r_5 + N_2(\\xi) r_2$，需要考虑两种几何映射：\n- 标准非奇异映射：$r_1 = 0$, $r_5 = L/2$, $r_2 = L$。\n- 四分之一点奇异裂纹尖端映射：$r_1 = 0$, $r_5 = L/4$, $r_2 = L$。\n\n在两种情况下，节点位移值都取自节点物理位置处的解析解：$u_1 = C \\sqrt{r_1}$，$u_5 = C \\sqrt{r_5}$，$u_2 = C \\sqrt{r_2}$。沿边的有限元插值为\n$$\nu_h(\\xi) = N_1(\\xi) u_1 + N_5(\\xi) u_5 + N_2(\\xi) u_2.\n$$\n在参数位置 $\\xi$ 处的精确解析值为 $u_{\\text{ex}}(\\xi) = C \\sqrt{r(\\xi)}$。\n\n你的任务：\n- 对于每种映射，在参数点样本集 $\\Xi = [-0.5, 0.0, 0.5, 0.8]$ 上评估近似误差。使用相对离散 $L^2$ 误差\n$$\ne_{L^2} = \\sqrt{\\frac{\\sum_{\\xi \\in \\Xi} \\left(u_h(\\xi) - u_{\\text{ex}}(\\xi)\\right)^2}{\\sum_{\\xi \\in \\Xi} u_{\\text{ex}}(\\xi)^2}}.\n$$\n- 对于每种映射，在边中点位置 $\\xi=0$ 处使用位移相关法估算 $K_I$。令 $\\delta = 2 u_h(0)$ 表示上裂纹面的裂纹张开位移（上裂纹面位移大小的两倍），并令 $r_m = r(0)$ 为边中点距离尖端的物理距离。反演解析关系 $\\delta = 2 C \\sqrt{r}$ 以计算\n$$\nK_{\\text{est}} = \\delta \\, \\mu \\, \\sqrt{2 \\pi} \\Big/ \\left((\\kappa + 1) \\sqrt{r_m}\\right),\n$$\n并计算相对误差 $e_K = \\left|K_{\\text{est}} - K_I\\right|/K_I$。\n\n所有量均采用国际单位制（SI）：$E$ 的单位是 $\\text{Pa}$，$K_I$ 的单位是 $\\text{Pa} \\cdot \\sqrt{\\text{m}}$，$L$ 的单位是 $\\text{m}$，位移单位是 $\\text{m}$。角度以弧度为单位。计算出的误差 $e_{L^2}$ 和 $e_K$ 是无量纲的。\n\n测试套件：\n- 情况 1：$E = 210\\times 10^9$, $\\nu = 0.3$, $K_I = 25\\times 10^6$, $L = 1\\times 10^{-3}$。\n- 情况 2：$E = 70\\times 10^9$, $\\nu = 0.33$, $K_I = 1\\times 10^6$, $L = 1\\times 10^{-2}$。\n- 情况 3：$E = 3\\times 10^9$, $\\nu = 0.49$, $K_I = 5\\times 10^5$, $L = 5\\times 10^{-4}$。\n\n对于每种情况，计算四个数值：标准映射的相对离散 $L^2$ 误差 $e_{L^2}^{\\text{std}}$，四分之一点映射的相对离散 $L^2$ 误差 $e_{L^2}^{\\text{qp}}$，标准映射的相对 $K$ 误差 $e_{K}^{\\text{std}}$，以及四分之一点映射的相对 $K$ 误差 $e_{K}^{\\text{qp}}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个 Python 风格的列表的列表，每个内部列表对应一个测试用例，并按给定顺序排列。每个内部列表必须是 $[e_{L^2}^{\\text{std}}, e_{L^2}^{\\text{qp}}, e_{K}^{\\text{std}}, e_{K}^{\\text{qp}}]$，使用十进制表示法。例如，一行如 $[[0.1,0.0,0.2,0.0],[\\dots],\\dots]$。", "solution": "问题陈述已经过严格审查，并被确定为有效。其科学基础在于线性弹性断裂力学和有限元法的原理，提法适定，数据充分且一致，并以客观、明确的语言表述。这些任务构成了计算断裂力学中的一个标准验证练习。因此，我们可以开始求解。\n\n该问题要求针对用于模拟裂纹面上尖端附近位移场的二次线单元的两种不同等参映射，评估两种类型的误差。在应用于具体的测试案例之前，可以对分析进行推广。\n\n让我们首先根据给定的杨氏模量 $E$ 和泊松比 $\\nu$ 来定义材料常数：\n剪切模量 $\\mu$ 由下式给出\n$$ \\mu = \\frac{E}{2(1+\\nu)} $$\n平面应变下的 Kolosov 常数 $\\kappa$ 为\n$$ \\kappa = 3 - 4\\nu $$\n上裂纹面 $(\\theta = \\pi)$ 上的解析位移为 $u_y^+(r) = C \\sqrt{r}$，其中常数 $C$ 定义为\n$$ C = \\frac{K_I}{2 \\mu} \\sqrt{\\frac{1}{2 \\pi}} (\\kappa + 1) $$\n此处，$K_I$ 是 I 型应力强度因子。\n\n有限元近似使用三节点二次拉格朗日形函数：\n$N_1(\\xi) = \\frac{1}{2}\\xi(\\xi-1)$, $N_5(\\xi) = 1-\\xi^2$, and $N_2(\\xi) = \\frac{1}{2}\\xi(\\xi+1)$.\n几何坐标 $r(\\xi)$ 和位移 $u_h(\\xi)$ 通过等参插值得到：\n$$ r(\\xi) = N_1(\\xi) r_1 + N_5(\\xi) r_5 + N_2(\\xi) r_2 $$\n$$ u_h(\\xi) = N_1(\\xi) u_1 + N_5(\\xi) u_5 + N_2(\\xi) u_2 $$\n节点坐标是相对于单元长度 $L$ 定义的，裂纹尖端位于 $r_1=0$。节点位移由解析解设定：$u_1 = C\\sqrt{r_1}$, $u_5 = C\\sqrt{r_5}$, $u_2 = C\\sqrt{r_2}$。由于 $r_1=0$，因此 $u_1=0$。\n\n首先，我们分析四分之一点映射，其节点坐标为 $r_1=0$, $r_5=L/4$ 和 $r_2=L$。几何映射为：\n$$ r(\\xi) = N_1(\\xi)(0) + N_5(\\xi)\\frac{L}{4} + N_2(\\xi)L = (1-\\xi^2)\\frac{L}{4} + \\frac{1}{2}\\xi(\\xi+1)L $$\n$$ r(\\xi) = \\frac{L}{4} (1-\\xi^2 + 2\\xi(\\xi+1)) = \\frac{L}{4} (1-\\xi^2 + 2\\xi^2 + 2\\xi) = \\frac{L}{4} (1 + 2\\xi + \\xi^2) = \\frac{L}{4}(1+\\xi)^2 $$\n在参数位置 $\\xi$ 处的精确位移为 $u_{\\text{ex}}(\\xi) = C\\sqrt{r(\\xi)}$。代入该映射可得：\n$$ u_{\\text{ex}}(\\xi) = C \\sqrt{\\frac{L}{4}(1+\\xi)^2} = \\frac{C\\sqrt{L}}{2}(1+\\xi) $$\n现在我们计算有限元插值 $u_h(\\xi)$。节点位移为 $u_1 = 0$, $u_5 = C\\sqrt{L/4} = C\\sqrt{L}/2$ 和 $u_2 = C\\sqrt{L}$。\n$$ u_h(\\xi) = N_1(\\xi)(0) + N_5(\\xi)\\frac{C\\sqrt{L}}{2} + N_2(\\xi)C\\sqrt{L} = C\\sqrt{L} \\left( \\frac{1}{2}(1-\\xi^2) + \\frac{1}{2}\\xi(\\xi+1) \\right) $$\n$$ u_h(\\xi) = \\frac{C\\sqrt{L}}{2} (1-\\xi^2 + \\xi^2+\\xi) = \\frac{C\\sqrt{L}}{2}(1+\\xi) $$\n我们发现对于所有 $\\xi \\in [-1,1]$ 都有 $u_h(\\xi) = u_{\\text{ex}}(\\xi)$。这是四分之一点单元的一个基本特性：它能精确再现其边上的 $\\sqrt{r}$ 奇异性行为。因此，对于所有样本点，近似误差 $(u_h(\\xi) - u_{\\text{ex}}(\\xi))$ 恒等于零。所以，四分之一点映射的相对离散 $L^2$ 误差必定为零：\n$$ e_{L^2}^{\\text{qp}} = 0 $$\n\n接下来，我们分析估算应力强度因子的误差 $e_K$。其估算公式为：\n$$ K_{\\text{est}} = \\frac{\\delta \\mu \\sqrt{2\\pi}}{(\\kappa+1)\\sqrt{r_m}} $$\n其中 $\\delta = 2 u_h(0)$ 并且 $r_m = r(0)$。在边中点位置 $\\xi=0$ 处，形函数为 $N_1(0)=0$, $N_5(0)=1$ 和 $N_2(0)=0$。\n这得到 $r_m = r(0) = r_5$ 和 $u_h(0) = u_5$。裂纹张开位移为 $\\delta = 2u_5$。将这些代入 $K_{\\text{est}}$ 公式中：\n$$ K_{\\text{est}} = \\frac{(2u_5) \\mu \\sqrt{2\\pi}}{(\\kappa+1)\\sqrt{r_5}} $$\n节点位移 $u_5$ 是根据解析解 $u_5 = C\\sqrt{r_5}$ 设定的。代入此式以及 $C$ 的定义：\n$$ K_{\\text{est}} = \\frac{2 \\left( \\frac{K_I}{2 \\mu} \\sqrt{\\frac{1}{2 \\pi}} (\\kappa + 1) \\sqrt{r_5} \\right) \\mu \\sqrt{2\\pi}}{(\\kappa+1)\\sqrt{r_5}} $$\n各项在代数上相互抵消：\n$$ K_{\\text{est}} = \\frac{2 K_I (\\kappa+1) \\sqrt{r_5} \\mu \\sqrt{2\\pi}}{2 \\mu \\sqrt{2\\pi} (\\kappa+1) \\sqrt{r_5}} = K_I $$\n该结果的成立与边中节点的位置 $r_5$ 无关。它同时适用于标准映射 ($r_5 = L/2$) 和四分之一点映射 ($r_5 = L/4$)。考虑到节点位移是根据解析解设定的，这种估算 $K_I$ 的方法是同义反复的。因此，对于两种映射，相对误差 $e_K = |K_{\\text{est}} - K_I|/K_I$ 均为零：\n$$ e_{K}^{\\text{std}} = 0 \\quad \\text{and} \\quad e_{K}^{\\text{qp}} = 0 $$\n\n最后，我们分析标准非奇异映射的 $L^2$ 误差，其中 $r_1=0, r_5=L/2, r_2=L$。其几何映射为：\n$$ r(\\xi) = (1-\\xi^2)\\frac{L}{2} + \\frac{1}{2}\\xi(\\xi+1)L = \\frac{L}{2}(1-\\xi^2 + \\xi^2+\\xi) = \\frac{L}{2}(1+\\xi) $$\n精确位移为 $u_{\\text{ex}}(\\xi) = C\\sqrt{r(\\xi)} = C\\sqrt{\\frac{L}{2}(1+\\xi)}$。\n节点位移为 $u_1=0$, $u_5=C\\sqrt{L/2}$, $u_2=C\\sqrt{L}$。插值结果为：\n$$ u_h(\\xi) = u_5 N_5(\\xi) + u_2 N_2(\\xi) = C\\sqrt{L/2}\\,(1-\\xi^2) + C\\sqrt{L}\\,\\frac{1}{2}\\xi(\\xi+1) $$\n$$ u_h(\\xi) = C\\sqrt{L} \\left( \\frac{1-\\xi^2}{\\sqrt{2}} + \\frac{\\xi(\\xi+1)}{2} \\right) $$\n与四分之一点情况不同，$u_h(\\xi)$ 不等于 $u_{\\text{ex}}(\\xi)$。我们必须计算其相对误差：\n$$ e_{L^2}^{\\text{std}} = \\sqrt{\\frac{\\sum_{\\xi \\in \\Xi} \\left(u_h(\\xi) - u_{\\text{ex}}(\\xi)\\right)^2}{\\sum_{\\xi \\in \\Xi} u_{\\text{ex}}(\\xi)^2}} $$\n注意到 $u_h(\\xi)$ 和 $u_{\\text{ex}}(\\xi)$ 都与因子 $C\\sqrt{L}$ 成正比。该因子在相对误差表达式的分子和分母中被消掉。因此，$e_{L^2}^{\\text{std}}$ 是一个不依赖于 $E, \\nu, K_I, L$ 的常数。我们在样本点 $\\Xi = [-0.5, 0.0, 0.5, 0.8]$ 上计算这个值。\n让我们定义归一化位移 $\\tilde{u}_h(\\xi) = u_h(\\xi)/(C\\sqrt{L})$ 和 $\\tilde{u}_{\\text{ex}}(\\xi) = u_{\\text{ex}}(\\xi)/(C\\sqrt{L})$。\n$$ \\tilde{u}_{\\text{ex}}(\\xi) = \\sqrt{\\frac{1+\\xi}{2}} $$\n$$ \\tilde{u}_h(\\xi) = \\frac{1-\\xi^2}{\\sqrt{2}} + \\frac{\\xi(\\xi+1)}{2} $$\n我们对 $\\xi \\in \\Xi$ 进行求和计算：\n- 对于 $\\xi = -0.5$：$\\tilde{u}_{\\text{ex}} = \\sqrt{0.25} = 0.5$, $\\tilde{u}_h = \\frac{0.75}{\\sqrt{2}} - 0.125 \\approx 0.40533$。\n- 对于 $\\xi = 0.0$：$\\tilde{u}_{\\text{ex}} = \\sqrt{0.5} \\approx 0.70711$, $\\tilde{u}_h = \\frac{1}{\\sqrt{2}} \\approx 0.70711$。（节点处误差为零）。\n- 对于 $\\xi = 0.5$：$\\tilde{u}_{\\text{ex}} = \\sqrt{0.75} \\approx 0.86603$, $\\tilde{u}_h = \\frac{0.75}{\\sqrt{2}} + 0.375 \\approx 0.90533$。\n- 对于 $\\xi = 0.8$：$\\tilde{u}_{\\text{ex}} = \\sqrt{0.9} \\approx 0.94868$, $\\tilde{u}_h = \\frac{0.36}{\\sqrt{2}} + 0.72 \\approx 0.97456$。\n\n误差平方和：$\\sum (\\tilde{u}_h - \\tilde{u}_{\\text{ex}})^2 \\approx (-0.09467)^2 + 0^2 + (0.03930)^2 + (0.02588)^2 \\approx 0.008962 + 0 + 0.001545 + 0.000670 = 0.011177$。\n精确值的平方和：$\\sum \\tilde{u}_{\\text{ex}}^2 = 0.25 + 0.5 + 0.75 + 0.9 = 2.4$。\n相对误差为：\n$$ e_{L^2}^{\\text{std}} = \\sqrt{\\frac{0.011177}{2.4}} \\approx \\sqrt{0.004657} \\approx 0.06824 $$\n因此，对于任何有效的物理参数集，计算出的四个误差度量将是 $[0.06824, 0.0, 0.0, 0.0]$。此结果适用于所有提供的三个测试用例。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the FEM crack-tip interpolation verification problem for three test cases.\n    \"\"\"\n\n    # Define the set of parametric points for error evaluation.\n    xi_points = np.array([-0.5, 0.0, 0.5, 0.8])\n\n    # Define the quadratic Lagrange shape functions.\n    # N1 is not needed since r1=u1=0.\n    def N5(xi):\n        return 1 - xi**2\n\n    def N2(xi):\n        return 0.5 * xi * (xi + 1)\n\n    test_cases = [\n        # Case 1: E (Pa), nu, K_I (Pa.sqrt(m)), L (m)\n        (210e9, 0.3, 25e6, 1e-3),\n        # Case 2\n        (70e9, 0.33, 1e6, 1e-2),\n        # Case 3\n        (3e9, 0.49, 5e5, 5e-4),\n    ]\n\n    all_results = []\n\n    for E, nu, K_I, L in test_cases:\n        \n        # As derived in the solution, the relative errors e_L2^qp, e_K^std, and e_K^qp\n        # are analytically zero for this problem setup.\n        # The error e_L2^std is a constant, independent of the physical parameters.\n        # The full calculation is performed here for completeness and to demonstrate\n        # the procedure for a general case.\n\n        # ----- 1. Standard Mapping -----\n        \n        # Midside node at L/2\n        r5_std = L / 2.0\n        r2_std = L\n        \n        # Normalized displacements (division by C*sqrt(L)) for error calculation\n        # This makes the calculation independent of C and L.\n        # u_h_norm = u_h / (C*sqrt(L))\n        # u_ex_norm = u_ex / (C*sqrt(L))\n\n        sum_sq_err_std = 0.0\n        sum_sq_ex_std = 0.0\n        \n        for xi in xi_points:\n            # Physical coordinate r(xi) = L/2 * (1+xi)\n            r_val = (L / 2.0) * (1 + xi)\n            \n            # Exact solution (normalized)\n            u_ex_norm = np.sqrt(r_val / L) # = sqrt(0.5*(1+xi))\n            \n            # Interpolated solution (normalized)\n            # u5_norm = sqrt(r5_std/L) = sqrt(0.5)\n            # u2_norm = sqrt(r2_std/L) = 1.0\n            u_h_norm = np.sqrt(0.5) * N5(xi) + 1.0 * N2(xi)\n\n            sum_sq_err_std += (u_h_norm - u_ex_norm)**2\n            sum_sq_ex_std += u_ex_norm**2\n        \n        # The denominator sum_sq_ex_std cannot be zero for the given Xi.\n        e_L2_std = np.sqrt(sum_sq_err_std / sum_sq_ex_std) if sum_sq_ex_std > 0 else 0.0\n        \n        # As shown analytically, K_est = K_I, so the error is zero.\n        e_K_std = 0.0\n\n        # ----- 2. Quarter-Point Mapping -----\n        \n        # The QP element exactly reproduces the sqrt(r) field.\n        # Therefore, the interpolation error is identically zero.\n        e_L2_qp = 0.0\n        \n        # As shown analytically, K_est = K_I, so the error is zero.\n        e_K_qp = 0.0\n\n        all_results.append([e_L2_std, e_L2_qp, e_K_std, e_K_qp])\n\n    # Final print statement in the exact required format.\n    print(f\"{all_results}\")\n\nsolve()\n```", "id": "2596472"}, {"introduction": "理解了奇异单元如何在一维边上插值位移场后，我们需进一步探究其在二维区域内的积分能力，这对于计算应变能和J积分等断裂参数至关重要。本练习将引导你实现一个高斯求积程序，用以计算一个包含 $r^{-1/2}$ 奇异性的面积分。你将通过编码实践，揭示四分之一点映射的雅可比行列式如何“正则化”被积函数，从而使数值积分在奇异点附近依然保持稳定和精确 [@problem_id:2602837]。", "problem": "你的任务是实现一个单元级的高斯求积程序，用于评估在有限元法（FEM）中计算应力强度因子（SIF）时出现的域积分。评估必须在等参单元中执行，并正确处理在裂纹尖端使用四分之一点映射的单元。你的程序将计算一个奇异但可积的域积分，该积分可作为用于SIF提取的路径无关积分的域形式中出现的奇异核的代理。\n\n从适合线性弹性裂纹尖端场高级计算的基本原理出发：\n- 能量守恒和能量释放率的定义，这是路径无关裂纹积分的基础。\n- 散度定理，它为将线积分转换为域积分提供了依据。\n- 线性弹性断裂力学中近尖端场的渐近性质，这意味着在裂纹尖端附近存在奇异的被积函数，并促使了特殊等参映射的使用。\n\n你不能使用任何预封装或简化的SIF公式。相反，你的实现应基于以下原则：\n- 从具有局部坐标 $(\\xi,\\eta)\\in[-1,1]^2$ 的方形参考域到物理单元的等参映射。\n- 使用高斯求积通过在参考域中的求积点上对被积函数进行采样，并乘以等参映射的雅可比行列式来评估面积分。\n- 对于裂纹尖端附近的具有四分之一点映射的单元需要进行特殊处理，其中从裂纹尖端延伸出的边上的中点节点被移动到四分之一点，使得该映射能够再现应变场中正确的平方根奇异性，并使复合的被积函数与雅可比行列式的乘积正则化，以便于数值积分。\n\n目标计算积分：\n- 定义裂纹尖端位于笛卡尔坐标系的原点。令 $r=\\sqrt{x^2+y^2}$ 表示到裂纹尖端的距离。考虑标量函数 $g(x,y)=r^{-1/2}$，它在代理意义上捕捉了与裂纹尖端能量相关的代数奇异性结构。\n- 对于一个给定的物理矩形单元，其尺寸为 $L$（$x$方向）和 $H$（$y$方向的半高），其排列方式为裂纹沿$x$轴，裂纹尖端位于$x=0$的左边缘。单个单元的物理域定义为 $\\Omega=\\{(x,y): 0\\le x\\le L,\\ -H\\le y\\le H\\}$。\n- 待评估的积分是域积分\n$$\nI(L,H)=\\iint_{\\Omega} g(x,y)\\,d\\Omega=\\iint_{\\Omega} r^{-1/2}\\,dx\\,dy.\n$$\n当 $L$ 和 $H$ 以米表示时，该积分的单位为 $\\mathrm{m}^{3/2}$。\n\n单元类型和映射：\n- 情况A使用一个$4$节点双线性等参四边形（通常表示为Q4）将参考方块映射到 $\\Omega$，其角节点位于 $(0,-H)$、$(L,-H)$、$(L,H)$、$(0,H)$。\n- 情况B和情况C使用一个$8$节点“巧”族等参四边形（通常表示为Q8），并采用四分之一点布置来模拟裂纹尖端：尖端位于左边缘的边中点节点上。$8$个节点的物理坐标（按标准“巧”族约定顺序，含边中点节点）为：\n    - 节点 $1$：$(0,-H)$ 位于 $(\\xi,\\eta)=(-1,-1)$\n    - 节点 $2$：$(L,-H)$ 位于 $(\\xi,\\eta)=(1,-1)$\n    - 节点 $3$：$(L,H)$ 位于 $(\\xi,\\eta)=(1,1)$\n    - 节点 $4$：$(0,H)$ 位于 $(\\xi,\\eta)=(-1,1)$\n    - 节点 $5$：$(L/4,-H)$ 位于 $(\\xi,\\eta)=(0,-1)$（底边中点移至四分之一点）\n    - 节点 $6$：$(L,0)$ 位于 $(\\xi,\\eta)=(1,0)$（右边中点）\n    - 节点 $7$：$(L/4,H)$ 位于 $(\\xi,\\eta)=(0,1)$（顶边中点移至四分之一点）\n    - 节点 $8$：$(0,0)$ 位于 $(\\xi,\\eta)=(-1,0)$（位于裂纹尖端的左边中点）\n这种四分之一点映射通过使物理径向坐标沿从尖端发出的边与参考坐标呈二次方关系，来模拟裂纹尖端场的平方根行为。\n\n求积和算法要求：\n- 对每个单元在参考方块上使用每个方向 $n$ 阶的张量积高斯求积。在每个求积点 $(\\xi_i,\\eta_j)$（权重为 $(w_i,w_j)$）处：\n    1. 评估等参形函数及其导数，以计算物理坐标 $(x,y)$ 和雅可比矩阵 $J(\\xi,\\eta)$。\n    2. 计算行列式 $\\det J(\\xi,\\eta)$。\n    3. 评估 $g(x,y)=\\left(x^2+y^2\\right)^{-1/4}$，注意在 $r=0$ 处通过适当的极限处理来避免除以零。\n    4. 累加贡献项 $g(x,y)\\,\\det J(\\xi,\\eta)\\,w_i\\,w_j$。\n- 确保所有计算均采用国际单位制（SI），其中 $L$ 和 $H$ 以米为单位，积分 $I$ 以 $\\mathrm{m}^{3/2}$ 报告。\n\n特殊处理的理由：\n- 在你的方法中，解释为什么在裂纹尖端附近需要四分之一点映射以实现奇异场的精确数值积分，以及它如何改变雅可比行列式以使参考空间中的被积函数正则化。\n\n测试套件和必需的输出：\n- 为以下三个测试用例实现并评估积分 $I(L,H)$：\n    1. 情况A（基准，标准等参Q4）：$L=1.0, H=0.5$, 求积阶数 $n=8$.\n    2. 情况B（四分之一点等参Q8）：$L=1.0, H=0.5$, 求积阶数 $n=8$.\n    3. 情况C（四分之一点等参Q8，更小域和更高分辨率）：$L=0.1, H=0.05$, 求积阶数 $n=16$.\n- 你的程序应产生单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表，例如，“[result1,result2,result3]”。每个结果必须是一个浮点数，代表相应测试用例的 $I(L,H)$（单位为 $\\mathrm{m}^{3/2}$），使用标准十进制表示法，文本输出中不含单位。在内部，你必须始终使用国际单位制。\n\n交付物：\n- 一个完整的、可运行的程序，该程序实现上述要求，遵循指定的求积和等参映射，计算所要求的三个积分，并以指定的单行格式准确输出它们。", "solution": "该问题要求对一个奇异域积分进行数值评估，这是计算断裂力学中，在使用基于域的守恒积分（如J积分）计算应力强度因子时经常遇到的任务。该积分定义为：\n$$\nI(L,H) = \\iint_{\\Omega} g(x,y)\\,d\\Omega = \\iint_{\\Omega} (x^2+y^2)^{-1/4}\\,dx\\,dy\n$$\n函数 $g(x,y) = r^{-1/2} = (x^2+y^2)^{-1/4}$，其中 $r = \\sqrt{x^2+y^2}$ 是到原点的径向距离，在位于 $(0,0)$ 的裂纹尖端处具有奇异性。这种奇异性是可积的，因为转换到极坐标后会显示形式为 $r^{-1/2} \\cdot r \\,dr\\,d\\theta = r^{1/2}\\,dr\\,d\\theta$ 的被积函数，它在 $r=0$ 处是有限的。然而，标准的数值求积方案在处理奇异被积函数时表现不佳。解决方法是使用从一个规则的参考域，即正方形 $(\\xi,\\eta) \\in [-1,1]^2$，到物理单元域 $\\Omega$ 的等参映射。\n\n积分变换如下：\n$$\nI = \\iint_{\\Omega} g(x,y)\\,dx\\,dy = \\int_{-1}^{1}\\int_{-1}^{1} g\\left(x(\\xi,\\eta), y(\\xi,\\eta)\\right) \\det[J(\\xi,\\eta)] \\,d\\xi\\,d\\eta\n$$\n其中 $J(\\xi,\\eta)$ 是映射 $(x,y) = \\mathbf{X}(\\xi,\\eta)$ 的雅可比矩阵。然后使用张量积高斯求积法则来近似这个变换后的积分：\n$$\nI \\approx \\sum_{i=1}^{n} \\sum_{j=1}^{n} w_i w_j g\\left(x(\\xi_i,\\eta_j), y(\\xi_i,\\eta_j)\\right) \\det[J(\\xi_i,\\eta_j)]\n$$\n这里，$(\\xi_i, \\eta_j)$ 是求积点，$(w_i, w_j)$ 是相应的 n 阶法则的权重。问题的核心在于映射 $\\mathbf{X}(\\xi,\\eta)$ 及其雅可比行列式的构建。映射使用形函数 $N_k(\\xi,\\eta)$ 和节点坐标 $(x_k, y_k)$ 定义：\n$$\nx(\\xi,\\eta) = \\sum_{k} N_k(\\xi,\\eta) x_k \\quad , \\quad y(\\xi,\\eta) = \\sum_{k} N_k(\\xi,\\eta) y_k\n$$\n雅可比矩阵的分量计算如下：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\sum_k \\frac{\\partial N_k}{\\partial \\xi} x_k & \\sum_k \\frac{\\partial N_k}{\\partial \\xi} y_k \\\\ \\sum_k \\frac{\\partial N_k}{\\partial \\eta} x_k & \\sum_k \\frac{\\partial N_k}{\\partial \\eta} y_k \\end{pmatrix}\n$$\n我们按规定分析每种情况。\n\n情况 A：$4$节点双线性四边形（Q4）\n对于指定的物理角节点 $(0,-H), (L,-H), (L,H), (0,H)$，从 $(\\xi,\\eta) \\in [-1,1]^2$ 的标准Q4等参映射简化为：\n$$\nx(\\xi,\\eta) = \\frac{L}{2}(1+\\xi) \\quad , \\quad y(\\xi,\\eta) = H\\eta\n$$\n雅可比矩阵是常数对角矩阵：\n$$\nJ = \\begin{pmatrix} L/2 & 0 \\\\ 0 & H \\end{pmatrix} \\implies \\det(J) = \\frac{LH}{2}\n$$\n参考空间中的被积函数是 $g \\det(J) = \\left( (\\frac{L}{2}(1+\\xi))^2 + (H\\eta)^2 \\right)^{-1/4} \\frac{LH}{2}$。物理原点 $(0,0)$ 处 $g$ 的奇异性被映射到参考域边界上的点 $(\\xi,\\eta)=(-1,0)$。标准的高斯-勒让德求积点位于 $(-1,1)$ 内，因此不会遇到除以零的情况，但被积函数在该点附近急剧变化，从而影响了低阶求积的准确性。\n\n情况B和C：带四分之一点映射的$8$节点“巧”族四边形（Q8）\n此配置专为处理裂纹尖端奇异性而设计。裂纹尖端位于节点8，其物理坐标为 $(0,0)$，参考坐标为 $(\\xi,\\eta)=(-1,0)$。关键特征是将边中点节点5和7放置在物理上下边缘的四分之一点上（$x=L/4$），而不是中点上（$x=L/2$）。\n\n特殊处理的理由：\n四分之一点单元的目的是将近尖端场的已知渐近行为嵌入到单元的映射中。对于I型裂纹，位移与 $\\sqrt{r}$ 成正比，应变/应力与 $1/\\sqrt{r}$ 成正比，其中 $r$ 是距尖端的距离。与应变平方相关的能量密度与 $1/r$ 成正比。当前的被积函数 $g(x,y)$ 具有 $1/\\sqrt{r}$ 的行为，这是域积分公式中某些项的特征。\n\n让我们分析指定的Q8单元沿 $\\eta=0$ 线（对应于物理裂纹线 $y=0$）提供的映射。映射简化为：\n$$\nx(\\xi,0) = \\frac{L}{4}(1+\\xi)^2\n$$\n在裂纹尖端附近（$\\xi \\to -1$），令 $\\zeta = 1+\\xi$。物理径向坐标 $r$ 的缩放关系为 $r=x \\propto \\zeta^2$。这意味着 $\\sqrt{r} \\propto \\zeta = 1+\\xi$。\n\n现在，我们检查雅可比行列式。详细分析表明，在裂纹尖端 $(\\xi,\\eta)=(-1,0)$ 附近，雅可比矩阵具有渐近形式 $J \\approx \\begin{pmatrix} \\frac{L}{2}(1+\\xi) & 0 \\\\ 0 & H \\end{pmatrix}$，从而得到一个行列式：\n$$\n\\det(J) \\propto (1+\\xi) \\propto \\sqrt{r}\n$$\n在参考空间中要积分的项是乘积 $g(x,y)\\det(J)$。在尖端附近，其行为是：\n$$\ng \\cdot \\det(J) \\propto \\frac{1}{\\sqrt{r}} \\cdot \\sqrt{r} = 1\n$$\n原始函数 $g(x,y)$ 中的奇异性被嵌入在雅可比行列式中的奇异性所抵消。得到的被积函数 $g\\det(J)$ 在参考空间 $(\\xi,\\eta)$ 中是正则的（且近似为常数），即使在对应于裂纹尖端的点也是如此。因此，标准高斯求积可以高精度地评估该积分。这种正则化是在断裂力学中使用四分之一点单元的根本原因。\n\n实现将通过为Q4和Q8单元定义形函数及其导数、在每个高斯点上构造雅可比行列式，并累加加权和来进行。", "answer": "```python\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef shape_functions_q4(xi, eta):\n    \"\"\"\n    Computes shape functions and their derivatives for a 4-node quad element.\n    Nodes are ordered CCW from bottom-left (-1,-1).\n    \"\"\"\n    xi_nodes = np.array([-1, 1, 1, -1])\n    eta_nodes = np.array([-1, -1, 1, 1])\n\n    N = 0.25 * (1 + xi * xi_nodes) * (1 + eta * eta_nodes)\n    \n    dN_dxi = 0.25 * xi_nodes * (1 + eta * eta_nodes)\n    dN_deta = 0.25 * eta_nodes * (1 + xi * xi_nodes)\n\n    return N, dN_dxi, dN_deta\n\ndef shape_functions_q8(xi, eta):\n    \"\"\"\n    Computes shape functions and their derivatives for an 8-node serendipity quad element.\n    Node numbering is as specified in the problem statement.\n    \"\"\"\n    N = np.zeros(8)\n    dN_dxi = np.zeros(8)\n    dN_deta = np.zeros(8)\n    \n    xi2 = xi * xi\n    eta2 = eta * eta\n\n    # Corner nodes (i=0 to 3, corresponding to nodes 1 to 4)\n    xi_n = np.array([-1, 1, 1, -1])\n    eta_n = np.array([-1, -1, 1, 1])\n\n    for i in range(4):\n        s = xi * xi_n[i]\n        t = eta * eta_n[i]\n        N[i] = 0.25 * (1 + s) * (1 + t) * (s + t - 1)\n        dN_dxi[i] = 0.25 * xi_n[i] * (1 + t) * (2 * s + t)\n        dN_deta[i] = 0.25 * eta_n[i] * (1 + s) * (s + 2 * t)\n\n    # Midside nodes (i=4 to 7, corresponding to nodes 5 to 8)\n    # Node 5: (xi=0, eta=-1)\n    N[4] = 0.5 * (1 - xi2) * (1 - eta)\n    dN_dxi[4] = -xi * (1 - eta)\n    dN_deta[4] = -0.5 * (1 - xi2)\n    \n    # Node 6: (xi=1, eta=0)\n    N[5] = 0.5 * (1 + xi) * (1 - eta2)\n    dN_dxi[5] = 0.5 * (1 - eta2)\n    dN_deta[5] = -eta * (1 + xi)\n\n    # Node 7: (xi=0, eta=1)\n    N[6] = 0.5 * (1 - xi2) * (1 + eta)\n    dN_dxi[6] = -xi * (1 + eta)\n    dN_deta[6] = 0.5 * (1 - xi2)\n    \n    # Node 8: (xi=-1, eta=0)\n    N[7] = 0.5 * (1 - xi) * (1 - eta2)\n    dN_dxi[7] = -0.5 * (1 - eta2)\n    dN_deta[7] = -eta * (1 - xi)\n    \n    return N, dN_dxi, dN_deta\n\ndef evaluate_integral(L, H, n, element_type):\n    \"\"\"\n    Evaluates the domain integral using Gaussian quadrature.\n    \"\"\"\n    # Get Gaussian quadrature points and weights\n    xi_p, w = roots_legendre(n)\n    \n    # Physical nodal coordinates\n    if element_type == 'Q4':\n        x_nodes = np.array([0, L, L, 0])\n        y_nodes = np.array([-H, -H, H, H])\n        shape_func = shape_functions_q4\n    elif element_type == 'Q8':\n        x_nodes = np.array([0, L, L, 0, L/4, L, L/4, 0])\n        y_nodes = np.array([-H, -H, H, H, -H, 0, H, 0])\n        shape_func = shape_functions_q8\n    else:\n        raise ValueError(\"Unknown element type\")\n\n    integral_val = 0.0\n\n    # Tensor product quadrature loop\n    for i in range(n):\n        for j in range(n):\n            xi = xi_p[i]\n            eta = xi_p[j]\n            wi = w[i]\n            wj = w[j]\n\n            N, dN_dxi, dN_deta = shape_func(xi, eta)\n\n            # Isoparametric mapping\n            x = np.dot(N, x_nodes)\n            y = np.dot(N, y_nodes)\n\n            # Jacobian matrix\n            J11 = np.dot(dN_dxi, x_nodes)\n            J12 = np.dot(dN_dxi, y_nodes)\n            J21 = np.dot(dN_deta, x_nodes)\n            J22 = np.dot(dN_deta, y_nodes)\n\n            detJ = J11 * J22 - J12 * J21\n            \n            # Integrand a(x,y) = (x^2 + y^2)^(-1/4)\n            # Quadrature points are in (-1,1), so r will not be exactly 0\n            # for the mappings used.\n            r_squared = x*x + y*y\n            g = r_squared**(-0.25)\n            \n            integral_val += g * detJ * wi * wj\n            \n    return integral_val\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # (L, H, n, element_type)\n        (1.0, 0.5, 8, 'Q4'),\n        (1.0, 0.5, 8, 'Q8'),\n        (0.1, 0.05, 16, 'Q8'),\n    ]\n\n    results = []\n    for case in test_cases:\n        L, H, n, element_type = case\n        result = evaluate_integral(L, H, n, element_type)\n        results.append(result)\n        \n    # Format the output as specified\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```", "id": "2602837"}, {"introduction": "掌握了单个奇异单元的力学行为后，下一步是如何在完整的有限元模型中高效地使用它们。一个优化的网格设计是在计算精度和成本之间取得平衡的关键。本练习将挑战你从分析师的视角出发，评估不同的裂尖网格划分策略，通过权衡奇异单元的布置、径向网格的疏密梯度以及环向单元的数量，来确定能够最快收敛到精确应力强度因子的最优设计 [@problem_id:2596483]。", "problem": "一个处于平面应变状态的均质、各向同性、线弹性体，包含一条直裂纹，其尖端位于与裂纹尖端固连的极坐标系 $\\left(r,\\theta\\right)$ 的原点。在线性弹性断裂力学（LEFM）中，I型加载下位移场和应力场的近尖端主导阶渐近形式为 $u \\sim C_{u} \\, K \\, r^{1/2} \\, \\Phi_{u}\\!\\left(\\theta,\\nu\\right)$ 和 $\\sigma \\sim C_{\\sigma} \\, K \\, r^{-1/2} \\, \\Phi_{\\sigma}\\!\\left(\\theta,\\nu\\right)$，其中 $K$ 是应力强度因子，$\\nu$ 是泊松比，$C_{u}$、$C_{\\sigma}$、$\\Phi_{u}$、$\\Phi_{\\sigma}$ 是与 $r$ 无关的常数和角度函数。在有限元法（FEM）中，“奇异裂纹尖端单元”旨在通过适当的等参映射（例如，通过四分之一点节点布置）和网格分级，将这种 $r^{\\pm 1/2}$ 行为引入近似空间中。\n\n要求您在以下候选的近尖端网格设计中，选择一个或多个对于在近尖端区域自由度数量固定的情况下，能精确恢复I型应力强度因子 $K$ 且是渐近最优的设计。这里的“渐近最优”指的是，对于集中在裂纹尖端一个小的环形邻域内的给定数量的未知量，该设计同时满足：\n(i) 将正确的 $r^{1/2}$ 位移奇性嵌入到沿径向的有限元形函数中，从而使主导阶奇异场能够被表示出来，而不受正则项的污染；并且\n(ii) 通过适当的径向网格分级，在近尖端环形区域内均匀分布能量范数误差密度，并足够好地解析角度相关性 $\\left(\\sim \\sin\\!\\left(\\theta/2\\right), \\cos\\!\\left(\\theta/2\\right)\\right)$，以避免由角度分辨率控制的误差。\n\n假设使用具有适用于所选插值阶数的标准高斯积分的等参单元，并且 $K$ 是通过收敛的等效域积分（例如，域形式的$J$积分）提取的。考虑围绕尖端的前几圈单元的以下四种设计：\n\nA. 使用排列成同心环的$8$节点等参四边形单元。在从裂纹尖端发出并构成裂纹面的两条边上，将边中点节点放置在四分之一点处，使得沿裂纹线的径向映射满足 $r\\!\\left(\\xi\\right)\\propto \\left(1+\\xi\\right)^{2}$，其中 $\\xi\\in[-1,1]$ 是径向上的母单元坐标。选择成等比级数的径向单元厚度，使得 $\\Delta r_{k}=\\alpha\\, r_{k}$，其中 $\\alpha\\in\\left(0,1\\right)$ 为常数，并且在第一圈的周向上每环至少放置$8$个单元。\n\nB. 使用$6$节点等参三角形单元，所有边中点节点都位于边的中点（无四分之一点映射）。在尖端附近进行强局部$h$-细化，但在前几圈保持径向单元厚度均匀，即 $\\Delta r_{k}=\\text{const}$，并在第一圈围绕尖端使用$4$个单元。\n\nC. 在尖端周围的小圆盘区域内，使用在径向和周向上都具有均匀网格间距的$4$节点等参四边形单元。不修改节点位置（无奇性映射），但使网格足够细，以至于最小单元的径向尺寸与过程区相当，并在第一圈围绕尖端使用$12$个单元。\n\nD. 仅对第一圈使用如设计A中的$8$节点等参四边形四分之一点单元，但对接下来的几圈保持径向间距均匀 $\\left(\\Delta r_{k}=\\text{const}\\right)$，并且每圈仅使用$2$个周向单元。\n\n哪种（或哪些）设计满足上述标准 $(i)$ 和 $(ii)$，从而在计算出的 $K$ 相对于近尖端自由度数量的收敛性方面，提供最快的渐近收敛速度？\n\n从以下选项中选择一个或多个：\n\nA. 设计 A\n\nB. 设计 B\n\nC. 设计 C\n\nD. 设计 D", "solution": "用户提供了一个计算断裂力学领域的问题，具体涉及为精确计算I型应力强度因子 $K_I$ 而进行的有限元网格设计。我将首先验证问题陈述，然后进行详细解答。\n\n### 第一步：提取已知条件\n- **物理系统**：一个处于平面应变状态的均质、各向同性、线弹性体。\n- **几何**：一条直裂纹，其尖端位于极坐标系 $(r, \\theta)$ 的原点。\n- **LEFM 渐近式**：对于I型加载，近尖端场由以下公式给出：\n  - 位移：$u \\sim C_{u} \\, K \\, r^{1/2} \\, \\Phi_{u}\\!\\left(\\theta,\\nu\\right)$\n  - 应力：$\\sigma \\sim C_{\\sigma} \\, K \\, r^{-1/2} \\, \\Phi_{\\sigma}\\!\\left(\\theta,\\nu\\right)$\n- **FEM 目标**：使用“奇异裂纹尖端单元”，通过等参映射来包含 $r^{\\pm 1/2}$ 行为。\n- **“渐近最优”网格设计的定义**：\n  - (i) 将正确的 $r^{1/2}$ 位移奇性嵌入到沿径向的形函数中。\n  - (ii) 通过适当的径向网格分级和充分的角度分辨率，在近尖端环形区域内均匀分布能量范数误差密度。\n- **假设**：\n  - 具有合适高斯积分的等参单元。\n  - $K$ 通过收敛的等效域积分（例如$J$积分）提取。\n- **问题**：从给定选项中选择满足标准(i)和(ii)的网格设计。\n\n### 第二步：使用提取的已知条件进行验证\n根据验证标准评估问题陈述。\n\n- **科学基础**：该问题基于线性弹性断裂力学（LEFM）和有限元法（FEM）的成熟理论。$r^{1/2}$ 的位移奇性和 $r^{-1/2}$ 的应力奇性是线弹性材料中裂纹的经典结果。使用四分之一点奇异单元来模拟这种奇性的技术是计算断裂力学中的一个标准且经过验证的程序，最早由 R.S. Barsoum 及 R.D. Henshell 和 K.G. Shaw 提出。渐近最优网格的概念也是高等有限元理论的基石。该问题在科学上和事实上都是合理的。\n- **适定性**：该问题是适定的。它明确定义了目标（精确恢复 $K$），并为“渐近最优”设计提供了两个明确的标准。这些标准是精确的，并允许基于已建立的有限元原则确定唯一的正确答案。\n- **客观性**：该问题以精确、客观和技术性的语言陈述。诸如“等参映射”、“四分之一点节点”、“能量范数误差”和“等比级数”等术语在此上下文中具有明确的含义。\n\n### 第三步：结论与行动\n该问题陈述是**有效**的。这是一个高等计算力学领域的标准、适定的问题，旨在测试关于断裂分析的有限元技术的基础知识。我现在将进行解答。\n\n### 推导与分析\n\n目标是找到对于恢复应力强度因子 $K$ 而言“渐近最优”的网格设计。这需要满足两个标准：(i) 正确表示场的奇性，以及 (ii) 有效地分布离散化误差。\n\n**标准(i)分析：嵌入奇性**\n\n近尖端位移场的行为像 $u \\sim r^{1/2}$。因此，应变 $\\varepsilon = \\nabla_s u$ 和应力 $\\sigma = C:\\varepsilon$ 场的行为像 $\\sigma, \\varepsilon \\sim r^{-1/2}$。有限元法中使用的标准多项式形函数无法表示这样一个在 $r=0$ 处具有奇性的函数。这会导致精度差和收敛速率次优，除非在尖端附近使用极度细化的网格。\n\n奇异单元的设计正是为了克服这个问题。标准方法是使用二次等参单元（8节点四边形或6节点三角形），并将边中点节点移动到“四分之一点”位置。\n\n考虑一个从裂纹尖端（$r=0$）开始的长度为 $L$ 的二次单元的直边。沿此边的节点分别位于尖端、边中点和远端。设此边上的母单元坐标为 $\\xi \\in [-1, 1]$，其中 $\\xi=-1$ 对应裂纹尖端。母单元中的节点坐标为 $\\xi_1 = -1$, $\\xi_2 = 0$, $\\xi_3 = 1$。用于映射的二阶形函数为 $N_1(\\xi)=-\\frac{1}{2}\\xi(1-\\xi)$，$N_2(\\xi)=1-\\xi^2$ 和 $N_3(\\xi)=\\frac{1}{2}\\xi(1+\\xi)$。\n\n四分之一点技术将物理节点放置在 $r_1=0$，$r_2=L/4$ 和 $r_3=L$ 处。沿此边的径向坐标 $r$ 的等参映射则为：\n$$r(\\xi) = N_1(\\xi)r_1 + N_2(\\xi)r_2 + N_3(\\xi)r_3 = (1-\\xi^2)\\frac{L}{4} + \\frac{1}{2}\\xi(1+\\xi)L$$\n$$r(\\xi) = \\frac{L}{4}(1-\\xi^2+2\\xi+2\\xi^2) = \\frac{L}{4}(1+2\\xi+\\xi^2) = \\frac{L}{4}(1+\\xi)^2$$\n这证实了选项A中给出的关系。现在，我们来考察位移场。位移 $u$ 使用相同的形函数从节点位移 $u_1, u_2, u_3$ 进行插值：\n$$u(\\xi) = N_1(\\xi)u_1 + N_2(\\xi)u_2 + N_3(\\xi)u_3$$\n这是一个关于 $\\xi$ 的一般二次多项式：$u(\\xi) = A_0 + A_1\\xi + A_2\\xi^2$。从坐标映射中，我们有 $(1+\\xi) = \\sqrt{4r/L}$，所以 $\\xi = \\sqrt{4r/L} - 1$。将此代入位移插值中：\n$$u(r) = A_0 + A_1\\left(\\sqrt{\\frac{4r}{L}}-1\\right) + A_2\\left(\\sqrt{\\frac{4r}{L}}-1\\right)^2$$\n$$u(r) = (A_0 - A_1 + A_2) + \\left(\\frac{2A_1}{\\sqrt{L}} - \\frac{4A_2}{\\sqrt{L}}\\right)\\sqrt{r} + \\left(\\frac{4A_2}{L}\\right)r$$\n这表明沿径向边上的位移场具有 $u(r) = C_1 + C_2\\sqrt{r} + C_3 r$ 的形式。此函数空间包含了所需的 $r^{1/2}$ 项，使得单元能够精确表示主导阶奇异位移场。因此，应变场 $\\varepsilon_{rr} = \\partial u/\\partial r$ 将包含必要的 $r^{-1/2}$ 项。\n\n因此，标准(i) **仅**能由采用带四分之一点节点布置的二次单元的设计来满足。\n\n**标准(ii)分析：误差均匀分布与角度分辨率**\n\n裂纹尖端附近的应变能密度 $U_0$ 的标度为 $U_0 \\sim (\\sigma \\cdot \\varepsilon) \\sim (r^{-1/2})^2 \\sim r^{-1}$。对于最优网格，能量范数中的误差应尽可能均匀地分布在所有单元中。对于这类奇性问题，理论和实践都已确立，最优的径向分级是等比级数。这意味着单元的径向尺寸 $\\Delta r_k$ 应与其距尖端的距离 $r_k$ 成比例增加。即 $\\Delta r_k / r_k = \\text{constant}$，或对于某个常数比率 $\\alpha$ 有 $\\Delta r_k = \\alpha r_k$。均匀网格（$\\Delta r_k = \\text{constant}$）是次优的，它将过多的误差集中在最靠近尖端的单元中，并且要达到相同的精度需要显著更多的自由度。\n\n对于角度分辨率，近尖端场具有特征性的良性角度相关性，通常涉及 $\\sin(\\theta/2)$ 和 $\\cos(\\theta/2)$。这些是平滑函数。然而，它们必须被充分解析。一个周向仅有 $2$ 或 $4$ 个单元的设计（分别为每个单元$180^\\circ$或$90^\\circ$）会在角度方向上引入大的插值误差。需要一个合理的数量，例如8个或更多单元，以防止角度误差主导总误差。\n\n### 逐项分析\n\n**A. 设计 A**\n- **标准(i)**：使用8节点（二次）等参单元，并带有四分之一点边中节点。如上推导，这正确地嵌入了 $r^{1/2}$ 位移奇性。此标准**得到满足**。\n- **标准(ii)**：采用等比级数（$\\Delta r_{k}=\\alpha\\, r_{k}$）的径向网格分级。这是径向误差均匀分布的渐近最优策略。每环使用至少8个单元，提供了充分的角度分辨率。此标准**得到满足**。\n- **结论**：设计A满足渐近最优网格设计的两个标准。它是LEFM问题中最先进网格的教科书式范例。**正确**。\n\n**B. 设计 B**\n- **标准(i)**：使用6节点（二次）三角形单元，但明确说明“无四分之一点映射”。没有这种映射，单元无法捕捉 $r^{1/2}$ 奇性。此标准**未得到满足**。\n- **标准(ii)**：采用均匀的径向厚度（$\\Delta r_{k}=\\text{const}$），这是一个次优的分级方案。它还在尖端周围仅使用4个单元，这是一个粗糙的角度分辨率。此标准**未得到满足**。\n- **结论**：此设计在所有关键方面均不合格。**不正确**。\n\n**C. 设计 C**\n- **标准(i)**：使用4节点（线性）四边形单元。这些单元缺少四分之一点映射所需的边中节点，无法嵌入奇性。此标准**未得到满足**。\n- **标准(ii)**：在两个方向上都采用均匀的网格间距，这对于径向是次优的。此标准**未得到满足**。\n- **结论**：对奇性问题使用线性单元进行粗暴的均匀细化效率极低。此设计远非最优。**不正确**。\n\n**D. 设计 D**\n- **标准(i)**：在第一圈使用四分之一点单元，这是捕捉奇性的正确步骤。此标准**部分满足**，因为最关键的区域被正确处理了。\n- **标准(ii)**：后续几圈采用均匀的径向间距，这是一个次优的分级策略。更关键的是，它“每圈仅使用2个周向单元”。这个角度分辨率是灾难性地差。一个跨越 $180^\\circ$ 的单元不可能解析Williams展开式的角度函数（例如 $\\cos(\\theta/2)$）。由此产生的角度误差将是巨大的，并将完全主导整个解。此标准**未得到满足**。\n- **结论**：尽管在第一圈中使用了正确的单元类型，但极差的角度分辨率和次优的径向分级使其成为一个非常糟糕的设计。**不正确**。\n\n### 总结\n根据分析，只有设计A包含了解决此类问题的渐近最优网格所必需的所有特征：正确的奇性单元公式、最优的径向网格分级以及充分的角度分辨率。", "answer": "$$\\boxed{A}$$", "id": "2596483"}]}