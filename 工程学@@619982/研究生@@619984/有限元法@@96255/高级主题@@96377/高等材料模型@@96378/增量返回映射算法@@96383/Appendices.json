{"hands_on_practices": [{"introduction": "任何返回映射算法的核心都是塑性修正步骤，我们必须在此确定塑性流动的量值。对于具有非线性硬化的模型，这归结为求解一个关于塑性乘子增量 $\\Delta \\gamma$ 的标量非线性方程。本练习 [@problem_id:2568881] 挑战您去分析并选择一种稳健的数值方法，例如有界牛顿法，以确保这个核心计算的全局收敛性，从而为可靠的本构更新奠定基础。", "id": "2568881", "problem": "考虑小应变相关联弹塑性，其具有各向同性 von Mises 屈服条件和带饱和的非线性各向同性硬化。设 Cauchy 应力分解为 $\\boldsymbol{\\sigma} = \\mathbf{C} : (\\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{p})$，其中 $\\mathbf{C}$ 是各向同性弹性刚度，偏应力为 $\\mathbf{s} = \\operatorname{dev}(\\boldsymbol{\\sigma})$。屈服函数为 $f(\\boldsymbol{\\sigma}, \\alpha) = \\lVert \\mathbf{s} \\rVert - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}(\\alpha)$，其中硬化应力 $\\sigma_{y}(\\alpha)$ 是 $C^{1}$、严格递增且有上界（饱和）的，例如 $\\sigma_{y}(\\alpha) = \\sigma_{\\infty} - (\\sigma_{\\infty} - \\sigma_{0}) \\exp(-b\\,\\alpha)$，其参数为 $\\sigma_{\\infty} > \\sigma_{0} > 0$ 和 $b > 0$。内变量 $\\alpha$ 是累积塑性应变，其演化规律为 $d\\alpha = \\sqrt{\\tfrac{2}{3}}\\, d\\gamma$，其中塑性乘子增量 $d\\gamma \\ge 0$。\n\n使用从 $n$ 到 $n+1$ 时间步的隐式后向欧拉返回映射算法，在 $n+1$ 步定义试探状态为 $\\mathbf{s}_{\\mathrm{tr}} = \\mathbf{s}_{n} + 2\\mu\\, \\Delta \\boldsymbol{\\varepsilon}^{\\mathrm{dev}}$，其中 $\\mu$ 是剪切模量，$\\Delta \\boldsymbol{\\varepsilon}^{\\mathrm{dev}}$ 是偏应变增量。假设试探状态是塑性容许的，即 $f(\\boldsymbol{\\sigma}_{\\mathrm{tr}}, \\alpha_{n}) > 0$。带有相关联流动的后向欧拉更新导出一个关于塑性乘子增量 $\\Delta \\gamma \\ge 0$ 的标量一致性条件，其形式为\n$$\nr(\\Delta \\gamma) \\equiv \\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - 2\\mu\\, \\Delta \\gamma - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma \\right) = 0.\n$$\n我们希望使用带区间限定的防护型 Newton 方法，或基于合适优值函数的线搜索全局化方法来稳健地求解 $r(\\Delta \\gamma) = 0$。\n\n对于上述模型，选择所有给出充分条件和构造，以确保对 $r(\\Delta \\gamma) = 0$ 的唯一解 $\\Delta \\gamma^{\\star} \\in (0,\\infty)$ 实现全局收敛的陈述。\n\nA. 定义优值函数 $\\phi(\\Delta \\gamma) = \\tfrac{1}{2} \\, r(\\Delta \\gamma)^{2}$。假设 $r$ 在闭区间 $[0,\\Delta \\gamma_{\\max}]$ 上连续可微，其导数 $r'(\\Delta \\gamma)$ 在 $[0,\\Delta \\gamma_{\\max}]$ 上 Lipschitz 连续，并且存在一个常数 $c_{0} > 0$ 使得对于所有 $\\Delta \\gamma \\in [0,\\Delta \\gamma_{\\max}]$ 都有 $r'(\\Delta \\gamma) \\le -c_{0} < 0$。在每个迭代点使用由 $r'(\\Delta \\gamma_{k})\\, p_{k} = - r(\\Delta \\gamma_{k})$ 给出的 Newton 方向 $p_{k}$，并使用参数为 $c \\in (0,\\tfrac{1}{2})$ 和收缩因子为 $\\rho \\in (0,1)$ 的 Armijo 回溯线搜索来强制满足\n$$\n\\phi(\\Delta \\gamma_{k} + s_{k} p_{k}) \\le \\phi(\\Delta \\gamma_{k}) + c\\, s_{k}\\, \\phi'(\\Delta \\gamma_{k})\\, p_{k},\n$$\n从任何初始猜测值 $\\Delta \\gamma_{0} \\in [0,\\Delta \\gamma_{\\max}]$ 开始，所生成的序列会全局收敛到 $r$ 的唯一根。\n\nB. 如果可以构造一个区间 $[0,\\Delta \\gamma_{\\max}]$ 使得 $r(0) \\ge 0$ 和 $r(\\Delta \\gamma_{\\max}) \\le 0$，并且如果 $r$ 在 $[0,\\Delta \\gamma_{\\max}]$上连续且严格单调，那么一个防护型 Newton 方法，它在每次迭代中计算一个 Newton 试探步并将其投影回该区间，当试探步离开该区间或未能减小 $|r|$ 时回退到二分法，该方法将全局收敛到唯一的根。\n\nC. 因为对于给定的带饱和硬化律，$r$ 是严格单调的，所以从 $\\Delta \\gamma_{0} = 0$ 开始的、没有任何线搜索或防护措施的纯 Newton 法，保证对所有容许数据都能全局收敛到唯一的根。\n\nD. 使用残差本身 $\\phi(\\Delta \\gamma) = r(\\Delta \\gamma)$ 作为优值函数，并对 $\\phi$ 使用 Newton 方向强制执行 Armijo 下降条件，可确保全局收敛，因为由于饱和效应，$\\phi$ 随 $\\Delta \\gamma$ 严格减小。\n\nE. 为构造一个包含变号点的区间，一个充分且可计算的上界是\n$$\n\\Delta \\gamma_{\\max} = \\frac{\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sqrt{\\tfrac{2}{3}}\\, \\sigma_{0}}{2\\mu} \\, ,\n$$\n只要它为正，就能保证对于任何 $\\alpha_{n}$ 都有 $r(\\Delta \\gamma_{\\max}) \\le 0$，因为在 $\\sigma_{\\infty} > \\sigma_{0} > 0$ 的饱和律中，对于所有 $\\alpha$ 都有 $\\sigma_{y}(\\alpha) \\ge \\sigma_{0}$。\n\n选择所有适用项。", "solution": "用户要求对问题陈述进行严格验证，然后给出详细的解答和对所提供选项的评估。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n*   **框架**：小应变相关联弹塑性。\n*   **屈服条件**：各向同性 von Mises。\n*   **硬化**：带饱和的非线性各向同性硬化。屈服应力 $\\sigma_{y}(\\alpha)$ 是累积塑性应变 $\\alpha$ 的一个 $C^{1}$ 函数，严格递增且有上界。例如：$\\sigma_{y}(\\alpha) = \\sigma_{\\infty} - (\\sigma_{\\infty} - \\sigma_{0}) \\exp(-b\\,\\alpha)$，其中 $\\sigma_{\\infty} > \\sigma_{0} > 0$, $b > 0$。\n*   **屈服函数**：$f(\\boldsymbol{\\sigma}, \\alpha) = \\lVert \\mathbf{s} \\rVert - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}(\\alpha)$，其中 $\\mathbf{s}$ 是偏应力。\n*   **累积塑性应变演化**：$d\\alpha = \\sqrt{\\tfrac{2}{3}}\\, d\\gamma$，其中 $d\\gamma \\ge 0$。\n*   **数值格式**：隐式后向欧拉返回映射。\n*   **试探状态**：$\\mathbf{s}_{\\mathrm{tr}} = \\mathbf{s}_{n} + 2\\mu\\, \\Delta \\boldsymbol{\\varepsilon}^{\\mathrm{dev}}$。\n*   **塑性加载条件**：试探状态是塑性容许的，即 $f(\\boldsymbol{\\sigma}_{\\mathrm{tr}}, \\alpha_{n}) > 0$。\n*   **一致性方程**：问题被简化为求解关于塑性乘子增量 $\\Delta \\gamma \\ge 0$ 的标量非线性方程 $r(\\Delta \\gamma) = 0$：\n    $$r(\\Delta \\gamma) \\equiv \\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - 2\\mu\\, \\Delta \\gamma - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma \\right) = 0.$$\n*   **目标**：找出所有描述充分条件和构造，以确保对唯一解 $\\Delta \\gamma^{\\star} \\in (0,\\infty)$ 实现全局收敛的陈述。\n\n**步骤2：使用提取的已知条件进行验证**\n\n1.  **科学基础**：该问题是计算非弹性力学中的一个经典课题，代表了有限元模拟中的局部本构更新。该模型（带各向同性硬化的 von Mises 模型）和算法（后向欧拉返回映射）都是标准的，在根本上是合理的。\n2.  **良定性**：我们来分析函数 $r(\\Delta \\gamma)$（对于 $\\Delta \\gamma \\ge 0$）。\n    *   **在原点的值**：塑性加载条件 $f(\\boldsymbol{\\sigma}_{\\mathrm{tr}}, \\alpha_{n}) > 0$ 等价于 $\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sqrt{\\frac{2}{3}}\\sigma_{y}(\\alpha_n) > 0$。这恰好是 $r(0)$。所以，$r(0) > 0$。\n    *   **单调性**：$r(\\Delta \\gamma)$ 的导数为：\n        $$r'(\\Delta \\gamma) = \\frac{d}{d(\\Delta \\gamma)} \\left( \\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - 2\\mu\\, \\Delta \\gamma - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma \\right) \\right)$$\n        $$r'(\\Delta \\gamma) = -2\\mu - \\sqrt{\\tfrac{2}{3}} \\cdot \\sigma_{y}'\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma \\right) \\cdot \\sqrt{\\tfrac{2}{3}}$$\n        $$r'(\\Delta \\gamma) = -2\\mu - \\tfrac{2}{3}\\, \\sigma_{y}'\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma \\right)$$\n        由于剪切模量 $\\mu > 0$ 且硬化是严格递增的（$\\sigma_{y}' > 0$），我们有 $r'(\\Delta \\gamma) < -2\\mu < 0$ 对于所有 $\\Delta \\gamma \\ge 0$ 成立。因此，$r(\\Delta \\gamma)$ 是一个严格递减函数。\n    *   **渐进行为**：当 $\\Delta \\gamma \\to \\infty$ 时，$-2\\mu \\Delta \\gamma \\to -\\infty$。硬化函数 $\\sigma_{y}(\\alpha)$ 有上界 $\\sigma_{\\infty}$。因此，当 $\\Delta \\gamma \\to \\infty$ 时，$r(\\Delta \\gamma) \\to -\\infty$。\n    *   **解的存在性和唯一性**：由于 $r(\\Delta \\gamma)$ 是连续的，$r(0) > 0$，且 $r(\\Delta \\gamma) \\to -\\infty$，根据介值定理，至少存在一个根。因为 $r(\\Delta \\gamma)$ 是严格递减的，这个根必定是唯一的。我们称之为 $\\Delta \\gamma^{\\star}$。由于 $r(0)>0$，我们有 $\\Delta \\gamma^{\\star} > 0$。求解该问题在数学上是良定的。\n3.  **客观性**：问题是用精确的数学和技术语言陈述的，没有主观性。\n\n**步骤3：结论与行动**\n\n问题陈述在科学上是合理的，在数学上是良定的，并且是客观地阐述的。这是一个有效的问题。我们继续进行解答。\n\n### 推导与逐项分析\n\n我们必须找出关于求解 $r(\\Delta \\gamma) = 0$ 的全局收敛算法的正确陈述。\n\n**选项A的分析**\n该陈述提出了使用优值函数 $\\phi(\\Delta \\gamma) = \\frac{1}{2} r(\\Delta \\gamma)^{2}$ 对 Newton 法进行线搜索全局化。这是数值优化中的一种标准技术。\n优值函数的导数是 $\\phi'(\\Delta \\gamma) = r(\\Delta \\gamma) r'(\\Delta \\gamma)$。求根问题 $r(\\Delta \\gamma)=0$ 的 Newton 方向是 $p_{k} = -r(\\Delta \\gamma_{k}) / r'(\\Delta \\gamma_{k})$。\n优值函数沿此方向的方向导数是：\n$$\\phi'(\\Delta \\gamma_{k})\\, p_{k} = r(\\Delta \\gamma_{k}) r'(\\Delta \\gamma_{k}) \\left( \\frac{-r(\\Delta \\gamma_{k})}{r'(\\Delta \\gamma_{k})} \\right) = -[r(\\Delta \\gamma_{k})]^2 = -2\\phi(\\Delta \\gamma_{k})$$\n由于 $\\phi(\\Delta \\gamma_{k}) \\ge 0$，对于任何非根的 $\\Delta \\gamma_{k}$，方向导数都是负的，这意味着 $p_{k}$ 始终是 $\\phi$ 的一个下降方向。\nArmijo 条件和回溯过程确保了每一步都能在优值函数上实现充分下降。\n该陈述包括了证明此类方法全局收敛的标准假设：优值函数梯度的 Lipschitz 连续性（如果 $\\sigma_y$ 是 $C^2$ 的，这对于光滑的硬化律是合理的假设，那么 $r$ 是 $C^2$ 的，这也就隐含了该条件）以及搜索方向是下降方向。对 $r'(\\Delta \\gamma)$ 的条件已由物理模型满足。在这些条件下，线搜索 Newton 方法保证收敛到 $\\phi$ 的一个驻点，即 $\\phi'(\\Delta \\gamma)=0$ 的点。这意味着 $r(\\Delta \\gamma)r'(\\Delta \\gamma) = 0$。由于我们已经证明 $r'(\\Delta \\gamma) < -2\\mu < 0$，极限点必须满足 $r(\\Delta \\gamma) = 0$。因此，该方法收敛到唯一的根 $\\Delta \\gamma^{\\star}$。\n**对A的结论**：正确。\n\n**选项B的分析**\n该陈述提出了一种防护型 Newton 方法，该方法将 Newton 步与在区间 $[0, \\Delta \\gamma_{\\max}]$ 内的二分法相结合，其中 $r(0) > 0$ 且 $r(\\Delta \\gamma_{\\max}) \\le 0$。\n这种区间的存在性是有保证的，因为 $r(0) > 0$ 且对于大的 $\\Delta \\gamma$，$r(\\Delta \\gamma) \\to -\\infty$。问题还要求 $r$ 在该区间上是连续且严格单调的，这一点我们已经验证过。\n防护型方法的工作原理如下：在每次迭代中，它尝试一个快速收敛的步骤（如 Newton 步）。如果这一步是“好的”（例如，停留在区间内并充分减小残差 $|r|$），则接受它。否则，算法将回退到一个稳健但较慢的步骤（如二分法）。对于区间上的连续变号函数，二分法保证收敛。通过始终确保根被限定在区间内，并在必要时回退到二分法，这种混合算法保证了全局收敛。该选项中的描述虽然略显非正式，但正确地指出了这种保证的所有关键要素。\n**对B的结论**：正确。\n\n**选项C的分析**\n该陈述声称纯 Newton 法（$\\Delta \\gamma_{k+1} = \\Delta \\gamma_k - r(\\Delta \\gamma_k)/r'(\\Delta \\gamma_k)$），从 $\\Delta \\gamma_0 = 0$ 开始，保证全局收敛。\n对于标量方程 $r(x)=0$，一个已知定理指出：如果从 $r(x_0)>0$ 的 $x_0$ 开始，并且对于所有 $x \\ge x_0$ 都有 $r'(x)<0$ 和 $r''(x) \\ge 0$，那么 Newton 迭代会形成一个单调递增并收敛到根的序列。\n在我们的问题中，我们有 $r(0) > 0$ 和 $r'(\\Delta\\gamma) < 0$。第三个条件是 $r''(\\Delta \\gamma) \\ge 0$。我们来计算二阶导数：\n$$r''(\\Delta \\gamma) = -\\frac{2}{3} \\frac{d}{d(\\Delta \\gamma)} \\sigma_{y}'\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma \\right) = -\\left(\\frac{2}{3}\\right)^{3/2} \\sigma_{y}''\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma \\right)$$\n因此，条件 $r''(\\Delta \\gamma) \\ge 0$ 等价于对于所有相关的 $\\alpha$，$\\sigma_{y}''(\\alpha) \\le 0$。这意味着硬化函数 $\\sigma_y(\\alpha)$ 必须是凹函数。\n虽然所给的例子硬化律是凹的，但问题只规定了 $\\sigma_y(\\alpha)$ 是 $C^1$、严格递增且有界的。可以构造具有这些性质但并非全局凹的函数（即，它可能有拐点）。如果 $\\sigma_y(\\alpha)$ 有一个凸性区域（$\\sigma_y'' > 0$），那么 $r(\\Delta \\gamma)$ 将是凹的（$r'' < 0$），Newton 法可能会越过根，可能导致发散或收敛到无物理意义的负值。因此，这个保证对于问题定义所涵盖的所有硬化律并非普遍有效。\n**对C的结论**：不正确。\n\n**选项D的分析**\n该陈述建议使用 $\\phi(\\Delta \\gamma) = r(\\Delta \\gamma)$ 作为线搜索方法的优值函数。\n在线搜索算法的背景下，优值函数是一个待最小化的函数，其最小值对应于原始问题（这里是求根问题）的解。标准的 Armijo 条件和相关的收敛定理是为这种最小化设定推导出来的。优值函数的一个关键要求是它在搜索路径上必须有下界。\n这里，所提议的优值函数 $\\phi(\\Delta \\gamma) = r(\\Delta \\gamma)$ 没有下界；我们知道当 $\\Delta \\gamma \\to \\infty$ 时，$r(\\Delta \\gamma) \\to -\\infty$。一个试图最小化这个“优值函数”的线搜索算法会尝试将 $\\Delta \\gamma$ 驱向无穷大，而不是在 $r(\\Delta \\gamma) = 0$ 的根处停止。在这里，基于最小化的线搜索框架被从根本上误用了。虽然可以为求根设计专门的阻尼 Newton 方案，但用“优值函数”和“Armijo 下降条件”等标准术语来描述它在概念上是有缺陷的，因为目标不是最小化 $r$，而是找到它为零的点。\n**对D的结论**：不正确。\n\n**选项E的分析**\n该陈述提出了一个可计算的上界 $\\Delta \\gamma_{\\max}$ 来构成一个区间 $[0, \\Delta \\gamma_{\\max}]$。\n提议的上界是 $\\Delta \\gamma_{\\max} = \\frac{\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sqrt{\\tfrac{2}{3}}\\, \\sigma_{0}}{2\\mu}$。\n首先，我们必须检查这个量是否为正。塑性加载条件是 $\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert > \\sqrt{\\frac{2}{3}} \\sigma_y(\\alpha_n)$。由于 $\\sigma_y(\\alpha)$ 是一个严格递增函数且 $\\alpha_n \\ge 0$，我们有 $\\sigma_y(\\alpha_n) \\ge \\sigma_y(0) = \\sigma_0$。因此，$\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert > \\sqrt{\\frac{2}{3}} \\sigma_y(\\alpha_n) \\ge \\sqrt{\\frac{2}{3}} \\sigma_0$。这意味着 $\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sqrt{\\frac{2}{3}} \\sigma_0 > 0$，所以 $\\Delta \\gamma_{\\max}$ 总是正的。“只要它为正”的附带条件是多余的，但并不会使该陈述无效。\n接下来，我们必须检查是否 $r(\\Delta \\gamma_{\\max}) \\le 0$。\n$$r(\\Delta \\gamma_{\\max}) = \\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - 2\\mu \\Delta \\gamma_{\\max} - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma_{\\max} \\right)$$\n根据 $\\Delta \\gamma_{\\max}$ 的构造，我们有 $2\\mu \\Delta \\gamma_{\\max} = \\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sqrt{\\tfrac{2}{3}}\\, \\sigma_{0}$。将此代入 $r$ 的表达式：\n$$r(\\Delta \\gamma_{\\max}) = \\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\left(\\lVert \\mathbf{s}_{\\mathrm{tr}} \\rVert - \\sqrt{\\tfrac{2}{3}}\\, \\sigma_{0}\\right) - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma_{\\max} \\right)$$\n$$r(\\Delta \\gamma_{\\max}) = \\sqrt{\\tfrac{2}{3}}\\, \\sigma_{0} - \\sqrt{\\tfrac{2}{3}}\\,\\sigma_{y}\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma_{\\max} \\right) = \\sqrt{\\tfrac{2}{3}} \\left( \\sigma_{0} - \\sigma_{y}\\!\\left(\\alpha_{n} + \\sqrt{\\tfrac{2}{3}}\\, \\Delta \\gamma_{\\max} \\right) \\right)$$\n硬化函数的自变量是 $\\alpha_{n+1} = \\alpha_n + \\sqrt{\\frac{2}{3}}\\Delta\\gamma_{\\max}$。由于 $\\alpha_n \\ge 0$ 且 $\\Delta\\gamma_{\\max} > 0$，该自变量为正。由于 $\\sigma_y$ 是严格递增的，所以 $\\sigma_y(\\alpha_{n+1}) > \\sigma_y(0) = \\sigma_0$。\n因此，$\\sigma_0 - \\sigma_y(\\alpha_{n+1}) < 0$，这意味着 $r(\\Delta \\gamma_{\\max}) < 0$。这满足条件 $r(\\Delta \\gamma_{\\max}) \\le 0$。一个有效的含变号点的区间 $[0, \\Delta \\gamma_{\\max}]$ 被成功构造出来。\n**对E的结论**：正确。\n\n**正确选项总结**\n正确的选项是 A、B 和 E，因为它们描述了求解一致性方程唯一解的有效且稳健的方法或构造。", "answer": "$$\\boxed{ABE}$$"}, {"introduction": "一个稳健的算法必须能正确处理弹性与塑性行为之间的转换。在有限精度计算中，简单地检查试探屈服函数是否为正是不够的，这可能导致伪塑性或降低收敛速度。此实践 [@problem_id:2673914] 聚焦于屈服面边界上的关键决策过程，探讨如何设计按比例缩放且具有物理意义的容差，以可靠地区分真实的塑性加载步和数值噪声。", "id": "2673914", "problem": "一个各向同性小应变弹塑性实体遵循 Prandtl-Reuss 方程（带有 von Mises $J_2$ 屈服准则的关联流动法则）和线性各向同性硬化。设 Cauchy 应力为 $\\boldsymbol{\\sigma}$，偏应力为 $\\mathbf{s} = \\boldsymbol{\\sigma} - \\tfrac{1}{3} \\mathrm{tr}(\\boldsymbol{\\sigma}) \\mathbf{I}$，塑性乘子增量为 $\\Delta \\gamma \\ge 0$，累积塑性应变为 $\\alpha \\ge 0$。屈服函数为\n$$\nf(\\boldsymbol{\\sigma},\\alpha) = \\sqrt{\\tfrac{3}{2}} \\, \\|\\mathbf{s}\\| - \\sigma_y - H' \\alpha,\n$$\n其中初始屈服应力 $\\sigma_y > 0$，硬化模量 $H' \\ge 0$。一个标准的隐式返回映射算法通过一个弹性试探预测器进行：它使用应变增量以及弹性模量 $K$ 和 $G$ 来计算试探应力 $\\boldsymbol{\\sigma}^{\\mathrm{trial}}$ 和试探屈服函数\n$$\nf^{\\mathrm{trial}} = f(\\boldsymbol{\\sigma}^{\\mathrm{trial}}, \\alpha_n).\n$$\n互补条件即 Karush-Kuhn-Tucker (KKT) 条件：$f \\le 0$，$\\Delta \\gamma \\ge 0$，以及 $\\Delta \\gamma \\, f = 0$。在精确算术中，如果 $f^{\\mathrm{trial}} \\le 0$，则该步为弹性步，且 $\\Delta \\gamma = 0$；如果 $f^{\\mathrm{trial}} > 0$，则该步为塑性步，且 $\\Delta \\gamma > 0$，并在步末满足 $f = 0$。\n\n在有限精度算术中，当 $f^{\\mathrm{trial}}$ 接近于零时，仅根据 $f^{\\mathrm{trial}}$ 的符号进行朴素分类可能导致错误分类、非物理的负塑性乘子、伪塑性或在耦合 Newton 迭代中失去二次收敛性。考虑到 $f^{\\mathrm{trial}}$ 具有应力单位，并且弹性预测器通过剪切模量 $G$ 将 $\\mathbf{s}^{\\mathrm{trial}}$ 与偏应变增量关联起来。要求你根据 KKT 条件以及带有线性各向同性硬化的 $J_2$ 塑性的返回映射结构进行推断，以确定在浮点舍入、步长和应力量级方面使弹性与塑性决策具有鲁棒性的准则。\n\n当 $f^{\\mathrm{trial}}$ 接近于零时，以下哪种策略是区分弹性步和塑性步的合理且鲁棒的方法？\n\nA. 仅根据双精度计算出的 $f^{\\mathrm{trial}}$ 的符号进行分类：如果 $f^{\\mathrm{trial}} > 0$ 则断定为塑性，否则为弹性。不使用任何容差、标度或额外检查。\n\nB. 对屈服函数使用组合的绝对-相对容差，并对塑性乘子设置阈值：定义一个与问题应力量级相当的应力标度 $\\sigma_{\\mathrm{scale}}$，例如 $\\sigma_{\\mathrm{scale}} = \\max\\!\\big(\\sigma_y + H' \\alpha_n, \\sqrt{\\tfrac{3}{2}} \\, \\|\\mathbf{s}^{\\mathrm{trial}}\\|\\big)$，以及一个容差 $\\tau_f = \\epsilon_{\\mathrm{abs}} + \\epsilon_{\\mathrm{rel}} \\, \\sigma_{\\mathrm{scale}}$，其中 $\\epsilon_{\\mathrm{rel}} \\in (0,1)$ 且 $\\epsilon_{\\mathrm{abs}} \\ge 0$。如果 $f^{\\mathrm{trial}} \\le \\tau_f$，则将该步视为弹性步。如果 $f^{\\mathrm{trial}} > \\tau_f$，则根据返回映射的一致性条件预测 $\\Delta \\gamma^{\\star}$，并在声明为塑性步之前要求 $\\Delta \\gamma^{\\star} \\ge \\tau_{\\gamma}$，其中 $\\tau_{\\gamma} = c_{\\gamma} \\, \\|\\Delta \\boldsymbol{\\varepsilon}^{\\mathrm{dev}}\\|$，对于某个小的 $c_{\\gamma} \\in (0,1)$；否则视为弹性步。在修正后，始终强制 $f \\approx 0$ 在 $\\tau_f$ 容差范围内。\n\nC. 仅通过剪切模量对试探屈服函数进行归一化，并使用一个独立于应力状态和增量的固定容差：如果对于一个预设的 $\\epsilon_0 > 0$，有 $f^{\\mathrm{trial}}/(3G) > \\epsilon_0$，则声明为塑性；否则为弹性。不考虑硬化、$\\sigma_y$ 或步长。\n\nD. 对应变增量采用子步法或回溯线搜索，以确保试探状态穿过屈服面的裕度大于一个组合的绝对-相对容差，然后执行塑性返回。仅当修正后的状态在容差范围内满足 KKT 条件时才接受塑性步；否则减小步长并重试。\n\nE. 基于近似塑性耗散 $\\mathcal{D} \\approx \\Delta \\gamma^{\\star} \\, \\sigma_y$ 的符号做决定：如果 $\\mathcal{D} > 0$ 但对于一个独立于应力量级和步长的固定能量阈值 $\\mathcal{D}_{\\min}$，有 $\\mathcal{D} < \\mathcal{D}_{\\min}$，则分类为弹性；否则，无论 $f^{\\mathrm{trial}}$ 或硬化如何，都分类为塑性。\n\n选择所有适用项。使用 KKT 条件、$J_2$ 返回映射的结构以及量纲和标度方面的考量来提供你的理由。不要诉诸于未经解释的经验法则；从第一性原理和数值分析的角度证明每个选择的合理性。", "solution": "该问题要求评估在 $J_2$ 塑性理论的计算实现中，鲁棒地区分弹性步和塑性步的策略，特别是在试探屈服函数 $f^{\\mathrm{trial}}$ 接近于零时。这是数值塑性学中的一个关键问题，因为朴素的实现会受到与有限精度算术相关的问题的影响，导致伪塑性变形或在全局 Newton-Raphson 迭代中失去二次收敛性。一个鲁棒的准则必须基于模型的物理原理和数值分析的原则，特别是在标度和容差方面。\n\n首先，让我们为给定模型建立塑性乘子 $\\Delta \\gamma$ 的解析形式。该问题使用隐式返回映射算法。弹性试探应力 $\\boldsymbol{\\sigma}^{\\mathrm{trial}}$ 是根据增量步开始时的状态（第 $n$ 步）和总应变增量 $\\Delta \\boldsymbol{\\varepsilon}$ 计算得出的。试探偏应力为 $\\mathbf{s}^{\\mathrm{trial}} = \\mathbf{s}_n + 2G \\Delta \\boldsymbol{\\varepsilon}^{\\mathrm{dev}}$，其中 $G$ 是剪切模量，$\\Delta \\boldsymbol{\\varepsilon}^{\\mathrm{dev}}$ 是应变增量的偏量部分。\n\n试探屈服函数计算如下\n$$f^{\\mathrm{trial}} = \\sqrt{\\tfrac{3}{2}} \\|\\mathbf{s}^{\\mathrm{trial}}\\| - (\\sigma_y + H' \\alpha_n)$$\n如果 $f^{\\mathrm{trial}} > 0$，则需要进行塑性修正。最终应力状态 $\\boldsymbol{\\sigma}_{n+1}$ 必须满足一致性条件 $f(\\boldsymbol{\\sigma}_{n+1}, \\alpha_{n+1}) = 0$。关联 $J_2$ 塑性的返回映射规定，修正后的偏应力 $\\mathbf{s}_{n+1}$ 是试探应力 $\\mathbf{s}^{\\mathrm{trial}}$ 在更新后的屈服面上的径向投影。这导出了关系式：\n$$\\mathbf{s}_{n+1} = \\mathbf{s}^{\\mathrm{trial}} - 2G \\Delta \\boldsymbol{\\varepsilon}^p$$\n其中塑性应变增量由关联流动法则给出，$\\Delta \\boldsymbol{\\varepsilon}^p = \\Delta \\gamma \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$。累积塑性应变 $\\alpha$ 的演化由 $\\Delta \\alpha = \\alpha_{n+1} - \\alpha_n = \\Delta \\gamma$ 给出。\n\n结合一致性条件、流动法则和硬化定律，可以推导出塑性乘子增量的精确表达式：\n$$ \\Delta \\gamma = \\frac{f^{\\mathrm{trial}}}{3G + H'} $$\n这个表达式是基础。由于 $G > 0$ 且 $H' \\ge 0$，如果在 $f^{\\mathrm{trial}} \\le 0$ 时取 $\\Delta \\gamma = 0$ 并在 $f^{\\mathrm{trial}} > 0$ 时取 $\\Delta \\gamma > 0$，那么在精确算术中，Karush-Kuhn-Tucker (KKT) 条件（$\\Delta \\gamma \\ge 0, f \\le 0, \\Delta \\gamma f = 0$）是满足的。挑战在于当 $f^{\\mathrm{trial}}$ 接近于零时，如何对这个切换进行数值实现。\n\n现在，我们来评估每种提议的策略。\n\n**A. 仅根据双精度计算出的 $f^{\\mathrm{trial}}$ 的符号进行分类：如果 $f^{\\mathrm{trial}} > 0$ 则断定为塑性，否则为弹性。不使用任何容差、标度或额外检查。**\n\n这是对数学理论的直接、朴素的转译。在有限精度算术中，一个本应精确位于屈服面上 ($f=0$) 的状态，可能会计算出一个小的正或负残差，例如 $f^{\\mathrm{trial}} \\approx \\pm 10^{-15}$。这种策略会将一个微小的正残差（可能由舍入误差引起）解释为真实的塑性加载，从而触发一个在物理上无意义的（伪塑性）且计算成本高昂的塑性修正。反之，它也可能错过一个非常小的塑性步。这种在弹塑性边界上的“抖动”现象，众所周知会降低或破坏全局求解算法的二次收敛性。该策略根本上不具有鲁棒性，并且忽略了问题的核心。\n\n结论：**不正确**。\n\n**B. 对屈服函数使用组合的绝对-相对容差，并对塑性乘子设置阈值...**\n\n该策略提出了一个多方面的、按比例缩放的方法。\n1.  **对屈服函数的缩放容差**：它定义了一个容差 $\\tau_f = \\epsilon_{\\mathrm{abs}} + \\epsilon_{\\mathrm{rel}} \\, \\sigma_{\\mathrm{scale}}$，其中应力标度 $\\sigma_{\\mathrm{scale}}$ 根据当前屈服应力和试探等效应力动态更新。这是数值分析中的一种标准、鲁棒的技术。它确保容差相对于问题中的应力量级是有意义的，防止容差对于低应力问题过于宽松，或对于高应力问题过于严格。如果 $f^{\\mathrm{trial}} \\le \\tau_f$，则将该步视为弹性步的决定在屈服面周围创建了一个“容差带”，它可以鲁棒地滤除数值噪声，并防止因无足轻重的屈服面穿透而产生伪塑性。\n2.  **对塑性乘子的阈值**：如果 $f^{\\mathrm{trial}} > \\tau_f$，它提出了第二个检查：预测的塑性乘子 $\\Delta \\gamma^{\\star}$ 必须大于一个容差 $\\tau_{\\gamma}$。这个容差是根据偏应变增量进行缩放的，即 $\\tau_{\\gamma} = c_{\\gamma} \\, \\|\\Delta \\boldsymbol{\\varepsilon}^{\\mathrm{dev}}\\|$。这是对塑性*效应*的检查。由于 $\\Delta \\gamma$ 代表塑性应变的大小，这个条件询问的是产生的塑性流动相对于驱动它的应变增量是否显著。这是一个在物理上和数值上都合理的检查。它提供了额外的一层鲁棒性，确保只有当塑性步对应于有意义的物理变形，而不仅仅是数值假象时才被激活。\n3.  **一致性强制**：要求在修正后强制 $f \\approx 0$ 在 $\\tau_f$ 容差范围内，是正确的塑性更新的标准部分。\n\n该策略结合了多个合理的原则：适当的标度、使用绝对和相对容差，以及基于“驱动力”($f^{\\mathrm{trial}}$)和产生的“流动”($\\Delta \\gamma$)的双重阈值判断。\n\n结论：**正确**。\n\n**C. 仅通过剪切模量对试探屈服函数进行归一化，并使用一个独立于应力状态和增量的固定容差...**\n\n该策略建议对 $f^{\\mathrm{trial}}$ 进行归一化以使其无量纲，这是一个很好的出发点。建议的归一化是 $f^{\\mathrm{trial}} / (3G)$。对于理想塑性（$H'=0$）的情况，这个量正好是塑性乘子 $\\Delta \\gamma$。于是准则变为 $\\Delta \\gamma > \\epsilon_0$。然而，该策略有两个主要缺陷：\n1.  **不完全的归一化**：它忽略了硬化模量 $H'$。在 $\\Delta \\gamma$ 的表达式中，正确的分母是 $3G + H'$。因此，这种归一化仅对理想塑性有效，并且随着硬化变得越显著，其不准确性也越高。\n2.  **固定的容差**：它使用一个固定的、预设的容差 $\\epsilon_0$，该容差“独立于应力状态和增量”。一个固定的容差无法在具有不同特征应力、应变或能量标度的问题中保持鲁棒性。一个适用于宏观结构分析的 $\\epsilon_0$ 值可能完全不适用于微观尺度的模拟。鲁棒性要求容差相对于当前问题的特征量进行缩放，正如选项 B 所做的那样。\n\n结论：**不正确**。\n\n**D. 对应变增量采用子步法或回溯线搜索...**\n\n这个选项描述了一种根本不同但同样有效的实现鲁棒性的方法。它不是为给定的固定应变增量设计一个复杂的分类准则，而是建议主动控制增量本身的大小。\n如果状态不明确（$f^{\\mathrm{trial}}$ 接近于零）或者塑性修正器未能收敛，算法会减小应变增量（$\\Delta \\boldsymbol{\\varepsilon}$）。这是鲁棒非线性求解器中一种经典而强大的技术。通过减小步长，算法可以更谨慎地处理材料行为的急剧变化（例如塑性的开始）。其目标是确保试探状态要么是明确的弹性（$f^{\\mathrm{trial}} \\ll 0$），要么是明确的塑性（$f^{\\mathrm{trial}}$ 超过一个鲁棒的容差），从而避免模糊区域。\n最后的检查，即修正后的状态必须在容差范围内满足 KKT 条件，是接受任何步的必要条件，而在失败时减小步长并重试的措施是鲁棒时间积分方案的基石。这种策略将鲁棒性的重担放在步长控制算法上，而不仅仅是弹塑性切换上，这是高质量有限元代码中常见且有效的方法。\n\n结论：**正确**。\n\n**E. 基于近似塑性耗散的符号做决定...**\n\n该策略尝试使用一个物理量，即塑性耗散 $\\mathcal{D}$，作为判据。检查耗散能量是否显著的想法在物理上是吸引人的。近似式 $\\mathcal{D} \\approx \\Delta \\gamma^{\\star} \\, \\sigma_y$ 是对塑性功增量的一个合理的一阶估计。然而，该策略因其阈值 $\\mathcal{D}_{\\min}$ 是一个“独立于应力量级和步长的固定能量阈值”这一条件而存在致命缺陷。这与选项 C 中的基本错误相同。对能量或耗散等广延量设置固定阈值是无法做到鲁棒的。什么构成“最小”耗散完全取决于具体情况：单元的大小、应变增量的大小以及系统中的总能量水平。一个鲁棒的准则必须将耗散增量与当前步的某个特征能量进行比较，例如弹性应变能增量。依赖于固定的、未缩放的阈值使得该策略不具有鲁棒性。\n\n结论：**不正确**。", "answer": "$$\\boxed{BD}$$"}, {"introduction": "为了在全局有限元分析中实现牛顿-拉弗森（Newton-Raphson）求解器所期望的快速二次收敛，局部本构更新必须提供其精确的线性化形式。这种“算法切线模量”（algorithmic tangent modulus）不同于连续介质切线模量，它是通过对更新算法本身进行微分而导出的。这项高级实践 [@problem_id:2612466] 将指导您完成J2塑性一致性切线的基本推导，这是开发高效隐式有限元程序的关键技能。", "id": "2612466", "problem": "考虑小应变、各向同性、率无关的 von Mises ($J_2$) 塑性，并采用线性各向同性硬化，该模型将用于有限元方法 (FEM) 中的 Newton 法。弹性响应由体积模量 $K$ 和剪切模量 $\\mu$ 表征，屈服应力为 $\\sigma_y(\\alpha) = \\sigma_{y0} + H \\alpha$，其中 $\\alpha$ 是累积塑性应变。应力被加法分解为体积部分和偏量部分，其中偏应力为 $s$，体积压力为 $p$。弹性本构律为 $p = K \\,\\text{tr}(\\varepsilon)$ 和 $s = 2 \\mu (\\varepsilon^{\\text{dev}} - \\varepsilon^{p,\\text{dev}})$。流动法则是相关的，在一个时间增量上的后向欧拉积分（隐式返回映射）使用塑性乘子增量 $\\Delta \\gamma$ 和流动方向 $m_{n+1} = \\dfrac{3}{2} \\dfrac{s_{n+1}}{\\|s_{n+1}\\|}$。累积塑性应变通过 $\\alpha_{n+1} = \\alpha_n + \\sqrt{\\dfrac{2}{3}} \\,\\|\\varepsilon^{p}_{n+1} - \\varepsilon^{p}_n\\|$ 进行更新。该步结束时的返回映射残差为\n$$\nr_s := s_{n+1} - s_{\\text{tr}} + 2 \\mu \\,\\Delta \\gamma\\, m_{n+1} = 0, \n\\qquad\nr_f := \\sqrt{\\frac{3}{2}}\\,\\|s_{n+1}\\| - \\sigma_y\\!\\Big(\\alpha_n + \\sqrt{\\frac{2}{3}}\\,\\|\\varepsilon^{p}_{n+1} - \\varepsilon^{p}_n\\|\\Big) = 0,\n$$\n其中 $s_{\\text{tr}} := 2 \\mu \\big(\\varepsilon^{\\text{dev}}_{n+1} - \\varepsilon^{p,\\text{dev}}_{n}\\big)$。使用一致性线性化（即，残差对总应变增量的精确微分），推导闭式算法切线模量 $\\boldsymbol{C}^{\\text{alg}}$。该模量将该步结束时的对称总应变增量 $\\delta \\varepsilon_{n+1}$ 映射到相应的应力增量 $\\delta \\sigma_{n+1}$，并用已知的步末状态 $(s_{n+1}, \\Delta \\gamma_{n+1})$ 和材料参数 $(K,\\mu,H)$ 表示。\n\n定义二阶单位张量 $I$、四阶对称单位张量 $\\mathbb{I}$ 和四阶偏量投影张量 $\\mathbb{I}_{\\text{dev}} := \\mathbb{I} - \\dfrac{1}{3} I \\otimes I$。令 $n_{n+1} := \\dfrac{s_{n+1}}{\\|s_{n+1}\\|}$，$\\mathbb{N} := n_{n+1} \\otimes n_{n+1}$ 以及 $\\mathbb{P} := \\mathbb{I}_{\\text{dev}} - \\mathbb{N}$。您的最终表达式必须是 $\\boldsymbol{C}^{\\text{alg}}$ 的单一解析表达式，并用这些张量和标量\n$$\n\\beta := \\frac{3 \\mu \\,\\Delta \\gamma_{n+1}}{\\|s_{n+1}\\|}\n$$\n来书写。\n\n将您的最终答案表示为闭式解析表达式。无需进行数值计算。最终答案必须是单一解析表达式。最终答案中不要包含单位。", "solution": "该问题要求推导具有线性各向同性硬化的 $J_2$ 塑性模型的算法切线模量 $\\boldsymbol{C}^{\\text{alg}}$。该模量在一个时间步结束时，将总应变的无穷小增量 $\\delta\\varepsilon_{n+1}$ 与相应的总应力的无穷小增量 $\\delta\\sigma_{n+1}$ 关联起来，即 $\\delta\\sigma_{n+1} = \\boldsymbol{C}^{\\text{alg}} : \\delta\\varepsilon_{n+1}$。推导过程基于后向欧拉返回映射算法残差方程的一致性线性化。\n\n应力张量 $\\sigma$ 被加法分解为其体积部分 $pI$ 和其偏量部分 $s$，使得 $\\sigma = pI+s$。体积响应是纯弹性的：\n$$p_{n+1} = K \\, \\text{tr}(\\varepsilon_{n+1})$$\n对该方程进行线性化，得到应力增量的体积部分：\n$$\\delta p_{n+1} = K \\, \\text{tr}(\\delta\\varepsilon_{n+1}) = K (I : \\delta\\varepsilon_{n+1})$$\n这意味着总应力增量为 $\\delta\\sigma_{n+1} = \\delta p_{n+1} I + \\delta s_{n+1}$。因此，切线模量的体积分量为 $K (I \\otimes I)$。中心任务是求出偏量切线模量 $\\boldsymbol{C}^{\\text{alg}}_{\\text{dev}}$，它关联了 $\\delta\\varepsilon_{n+1}$ 与 $\\delta s_{n+1}$。\n\n步末状态 $(s_{n+1}, \\Delta\\gamma_{n+1})$ 是通过对给定的应变 $\\varepsilon_{n+1}$ 求解非线性残差方程组来确定的：\n$$r_s := s_{n+1} - s_{\\text{tr}} + 2 \\mu \\,\\Delta \\gamma_{n+1}\\, m_{n+1} = 0$$\n$$r_f := \\sqrt{\\frac{3}{2}}\\,\\|s_{n+1}\\| - \\sigma_y(\\alpha_{n+1}) = 0$$\n其中 $s_{\\text{tr}} := 2 \\mu (\\varepsilon^{\\text{dev}}_{n+1} - \\varepsilon^{p,\\text{dev}}_{n})$，$\\alpha_{n+1}$ 是累积塑性应变。\n\n为了求出切线模量，我们对这个系统进行一致性线性化。我们对每个残差方程关于自变量 $\\varepsilon_{n+1}$ 和因变量 $s_{n+1}$、$\\Delta\\gamma_{n+1}$ 进行变分。第 $n$ 步的状态是已知且固定的，因此其变分为零。\n\n让我们对第一个残差进行线性化，$\\delta r_s = 0$：\n$$\\delta s_{n+1} - \\delta s_{\\text{tr}} + 2 \\mu \\,(\\delta(\\Delta\\gamma_{n+1}))\\, m_{n+1} + 2 \\mu \\,\\Delta \\gamma_{n+1}\\, \\delta m_{n+1} = 0$$\n我们计算各项的变分：\n试探应力的变分为 $\\delta s_{\\text{tr}} = 2 \\mu (\\delta\\varepsilon^{\\text{dev}}_{n+1} - \\delta\\varepsilon^{p,\\text{dev}}_{n}) = 2\\mu\\,\\delta\\varepsilon^{\\text{dev}}_{n+1}$，因为 $\\varepsilon^{p,\\text{dev}}_{n}$ 是一个过去的值。\n流动方向是 $m_{n+1} = \\frac{3}{2}\\frac{s_{n+1}}{\\|s_{n+1}\\|} = \\frac{3}{2}n_{n+1}$。它的变分是：\n$$\\delta m_{n+1} = \\frac{3}{2}\\delta n_{n+1} = \\frac{3}{2} \\left( \\frac{1}{\\|s_{n+1}\\|} (\\mathbb{I}_{\\text{dev}} - n_{n+1} \\otimes n_{n+1}) : \\delta s_{n+1} \\right) = \\frac{3}{2\\|s_{n+1}\\|} \\mathbb{P} : \\delta s_{n+1}$$\n将这些代入 $r_s$ 的线性化方程中：\n$$\\delta s_{n+1} - 2\\mu\\,\\delta\\varepsilon^{\\text{dev}}_{n+1} + 3 \\mu \\,n_{n+1} \\delta(\\Delta\\gamma_{n+1}) + 2 \\mu \\,\\Delta \\gamma_{n+1}\\, \\left(\\frac{3}{2\\|s_{n+1}\\|} \\mathbb{P} : \\delta s_{n+1}\\right) = 0$$\n重新整理并合并包含 $\\delta s_{n+1}$ 的项：\n$$\\left(\\mathbb{I}_{\\text{dev}} + \\frac{3 \\mu \\Delta\\gamma_{n+1}}{\\|s_{n+1}\\|} \\mathbb{P}\\right) : \\delta s_{n+1} + 3 \\mu\\, n_{n+1} \\delta(\\Delta\\gamma_{n+1}) = 2\\mu\\,\\delta\\varepsilon^{\\text{dev}}_{n+1}$$\n使用给定的定义 $\\beta = \\frac{3 \\mu \\Delta\\gamma_{n+1}}{\\|s_{n+1}\\|}$，我们得到第一个线性化方程：\n$$(1) \\quad (\\mathbb{I}_{\\text{dev}} + \\beta \\mathbb{P}) : \\delta s_{n+1} + 3 \\mu\\, n_{n+1} \\delta(\\Delta\\gamma_{n+1}) = 2\\mu\\,\\mathbb{I}_{\\text{dev}}:\\delta\\varepsilon_{n+1}$$\n\n接下来，我们对屈服条件残差进行线性化，$\\delta r_f = 0$：\n$$\\sqrt{\\frac{3}{2}}\\,\\delta\\|s_{n+1}\\| - \\delta\\sigma_y(\\alpha_{n+1}) = 0$$\n范数的变分为 $\\delta\\|s_{n+1}\\| = \\frac{s_{n+1}}{\\|s_{n+1}\\|} : \\delta s_{n+1} = n_{n+1} : \\delta s_{n+1}$。\n屈服应力的变分为 $\\delta\\sigma_y(\\alpha_{n+1}) = H \\delta\\alpha_{n+1}$。\n累积塑性应变 $\\alpha$ 的更新法则给出为 $\\alpha_{n+1} = \\alpha_n + \\sqrt{\\frac{2}{3}} \\,\\|\\varepsilon^{p}_{n+1} - \\varepsilon^{p}_n\\|$。\n塑性应变增量为 $\\Delta\\varepsilon^p = \\varepsilon^p_{n+1} - \\varepsilon^p_n = \\Delta\\gamma_{n+1} m_{n+1} = \\frac{3}{2}\\Delta\\gamma_{n+1} n_{n+1}$。\n其范数为 $\\|\\Delta\\varepsilon^p\\| = \\frac{3}{2}\\Delta\\gamma_{n+1}$。\n因此，$\\alpha$ 的增量为 $\\Delta\\alpha_{n+1} = \\alpha_{n+1}-\\alpha_n = \\sqrt{\\frac{2}{3}}\\left(\\frac{3}{2}\\Delta\\gamma_{n+1}\\right) = \\sqrt{\\frac{3}{2}}\\Delta\\gamma_{n+1}$。\n因此 $\\alpha_{n+1}$ 的变分为 $\\delta\\alpha_{n+1} = \\sqrt{\\frac{3}{2}}\\delta(\\Delta\\gamma_{n+1})$。\n将这些代入线性化的屈服条件中：\n$$\\sqrt{\\frac{3}{2}}(n_{n+1} : \\delta s_{n+1}) - H \\left(\\sqrt{\\frac{3}{2}}\\delta(\\Delta\\gamma_{n+1})\\right) = 0$$\n这可简化为我们的第二个线性化方程：\n$$(2) \\quad n_{n+1} : \\delta s_{n+1} - H \\delta(\\Delta\\gamma_{n+1}) = 0$$\n从方程 $(2)$，我们可以用 $\\delta s_{n+1}$ 来表示 $\\delta(\\Delta\\gamma_{n+1})$：\n$$\\delta(\\Delta\\gamma_{n+1}) = \\frac{1}{H} (n_{n+1} : \\delta s_{n+1})$$\n现在，将此代入方程 $(1)$ 中：\n$$(\\mathbb{I}_{\\text{dev}} + \\beta \\mathbb{P}) : \\delta s_{n+1} + 3 \\mu\\, n_{n+1} \\left(\\frac{1}{H} (n_{n+1} : \\delta s_{n+1})\\right) = 2\\mu\\,\\delta\\varepsilon^{\\text{dev}}_{n+1}$$\n带有标量积的项可以使用秩1张量 $\\mathbb{N} = n_{n+1} \\otimes n_{n+1}$ 重写：\n$$\\left[ \\mathbb{I}_{\\text{dev}} + \\beta \\mathbb{P} + \\frac{3\\mu}{H} \\mathbb{N} \\right] : \\delta s_{n+1} = 2\\mu\\,\\delta\\varepsilon^{\\text{dev}}_{n+1}$$\n令 $\\mathbb{A} = \\mathbb{I}_{\\text{dev}} + \\beta \\mathbb{P} + \\frac{3\\mu}{H} \\mathbb{N}$。我们需要求它的逆。使用谱分解 $\\mathbb{I}_{\\text{dev}} = \\mathbb{P} + \\mathbb{N}$：\n$$\\mathbb{A} = (\\mathbb{P} + \\mathbb{N}) + \\beta \\mathbb{P} + \\frac{3\\mu}{H} \\mathbb{N} = (1+\\beta)\\mathbb{P} + \\left(1 + \\frac{3\\mu}{H}\\right)\\mathbb{N}$$\n由于 $\\mathbb{P}$ 和 $\\mathbb{N}$ 是正交投影张量（$\\mathbb{P}:\\mathbb{N}=0$, $\\mathbb{P}:\\mathbb{P}=\\mathbb{P}$, $\\mathbb{N}:\\mathbb{N}=\\mathbb{N}$），$\\mathbb{A}$ 的逆是：\n$$\\mathbb{A}^{-1} = \\frac{1}{1+\\beta}\\mathbb{P} + \\frac{1}{1 + \\frac{3\\mu}{H}}\\mathbb{N} = \\frac{1}{1+\\beta}\\mathbb{P} + \\frac{H}{H+3\\mu}\\mathbb{N}$$\n现在我们可以解出 $\\delta s_{n+1}$：\n$$\\delta s_{n+1} = 2\\mu\\,\\mathbb{A}^{-1} : \\delta\\varepsilon^{\\text{dev}}_{n+1}$$\n算子 $\\mathbb{P}$ 和 $\\mathbb{N}$ 投影到偏量空间，所以 $\\mathbb{A}^{-1}: \\delta\\varepsilon^{\\text{dev}}_{n+1} = \\mathbb{A}^{-1}: \\delta\\varepsilon_{n+1}$。\n因此，算法切线的偏量部分为：\n$$\\boldsymbol{C}^{\\text{alg}}_{\\text{dev}} = 2\\mu\\,\\mathbb{A}^{-1} = 2\\mu \\left( \\frac{1}{1+\\beta}\\mathbb{P} + \\frac{H}{H+3\\mu}\\mathbb{N} \\right)$$\n完整的算法切线模量 $\\boldsymbol{C}^{\\text{alg}}$ 是体积部分和偏量部分之和：\n$$\\boldsymbol{C}^{\\text{alg}} = K (I \\otimes I) + \\boldsymbol{C}^{\\text{alg}}_{\\text{dev}}$$\n代入推导出的 $\\boldsymbol{C}^{\\text{alg}}_{\\text{dev}}$ 表达式，即可得到最终结果。", "answer": "$$\\boxed{K (I \\otimes I) + 2\\mu \\left( \\frac{1}{1+\\beta} \\mathbb{P} + \\frac{H}{H+3\\mu} \\mathbb{N} \\right)}$$"}]}