{"hands_on_practices": [{"introduction": "这项基础练习至关重要，它为计算塑性学奠定了基石。通过为一个具有线性各向同性硬化的简单一维杆计算应力响应，你将亲手实践“返回映射算法”（return-mapping algorithm）的核心逻辑——即“弹性预测”和“塑性修正”。这个逻辑是几乎所有现代有限元商业软件中塑性力学分析的根基。", "problem": "一根一维杆在小应变和小位移条件下建模，并采用一个带有一个高斯积分点的线性有限元进行离散化。材料为具有线性各向同性硬化的关联率无关弹塑性固体。本构基础包括加法应变分解 $ \\varepsilon = \\varepsilon^{e} + \\varepsilon^{p} $，胡克定律 $ \\sigma = E \\, \\varepsilon^{e} $，以及带有屈服函数 $ f(\\sigma,\\alpha) = |\\sigma| - (\\sigma_{0} + H \\alpha) $ 的塑性力学 KKT (Karush–Kuhn–Tucker) 条件，其中 $ \\alpha $ 是累积等效塑性应变。流动法则是关联的，因此塑性应变率满足 $ \\dot{\\varepsilon}^{p} = \\dot{\\lambda} \\, \\partial f / \\partial \\sigma $，其中 $ \\dot{\\lambda} \\ge 0 $；硬化定律为 $ \\dot{\\alpha} = \\dot{\\lambda} $。\n\n在时刻 $ t^{n} $，高斯点处的状态为无应力且无塑性应变，即 $ \\sigma^{n} = 0 $，$ \\varepsilon^{p,n} = 0 $，$ \\alpha^{n} = 0 $。在一个到时刻 $ t^{n+1} $ 的单位移控制加载步内，高斯点处的总应变在拉伸作用下单调增加至 $ \\varepsilon^{n+1} = 0.003 $。材料参数为：杨氏模量 $ E = 210~\\text{GPa} $，初始屈服应力 $ \\sigma_{0} = 250~\\text{MPa} $，以及线性各向同性硬化模量 $ H = 1.5~\\text{GPa} $。\n\n仅从上述原理（加法分解、弹性、屈服函数、KKT 条件、关联性以及线性各向同性硬化）出发，通过强制执行一致性条件的返回算法推导此单增量步的应力更新，并计算高斯点处更新后的柯西应力 $ \\sigma^{n+1} $。最终应力以 $ \\text{MPa} $ 为单位表示，并四舍五入至四位有效数字。", "solution": "该问题陈述有效。这是一个在计算弹塑性力学领域内适定、有科学依据的问题，所有必要数据均已提供，且无内部矛盾。我们将着手进行求解。\n\n求解框架是返回映射算法，该算法包含一个弹性预测步，以及在违反屈服准则时进行的一个塑性修正步。所有计算都将使用一致的单位，应力和模量均采用兆帕 ($ \\text{MPa} $), 其中 $ E = 210~\\text{GPa} = 2.1 \\times 10^{5}~\\text{MPa} $，$ H = 1.5~\\text{GPa} = 1500~\\text{MPa} $。\n\n首先，我们执行弹性预测步。我们假设整个应变增量 $ \\Delta \\varepsilon $ 都是弹性的。时刻 $ t^{n} $ 的初始状态为 $ \\sigma^{n} = 0 $，$ \\varepsilon^{p,n} = 0 $，$ \\alpha^{n} = 0 $。最终总应变为 $ \\varepsilon^{n+1} = 0.003 $。初始总应变 $ \\varepsilon^{n} $ 也为零，因为 $ \\varepsilon^{n} = \\varepsilon^{e,n} + \\varepsilon^{p,n} $ 且 $ \\sigma^n=E\\varepsilon^{e,n}=0 \\implies \\varepsilon^{e,n}=0 $。因此，应变增量为 $ \\Delta\\varepsilon = \\varepsilon^{n+1} - \\varepsilon^n = 0.003 $。\n\n假设塑性应变没有变化（$ \\Delta\\varepsilon^p = 0 $），通过胡克定律计算试探应力 $ \\sigma^{\\text{trial}} $：\n$$ \\sigma^{\\text{trial}} = \\sigma^{n} + E \\Delta\\varepsilon = 0 + (2.1 \\times 10^{5}~\\text{MPa}) \\times 0.003 = 630~\\text{MPa} $$\n\n接下来，我们检查该试探状态是否违反屈服条件。屈服函数为 $ f(\\sigma,\\alpha) = |\\sigma| - (\\sigma_{0} + H \\alpha) $。我们使用试探应力和该增量步开始时的内变量 $ \\alpha^{n} = 0 $ 对其进行求值：\n$$ f^{\\text{trial}} = f(\\sigma^{\\text{trial}}, \\alpha^{n}) = |\\sigma^{\\text{trial}}| - (\\sigma_{0} + H \\alpha^{n}) = |630| - (250 + 1500 \\times 0) = 380~\\text{MPa} $$\n由于 $ f^{\\text{trial}} > 0 $，弹性假设无效，发生了塑性变形。需要进行塑性修正步来强制执行一致性条件，以确保最终状态位于屈服面上。\n\n塑性修正步将状态从 $ (\\sigma^{\\text{trial}}, \\alpha^n) $ 更新到最终状态 $ (\\sigma^{n+1}, \\alpha^{n+1}) $，使得 $ f(\\sigma^{n+1}, \\alpha^{n+1}) = 0 $。我们对该增量步上的流动法则和硬化法则采用后向欧拉积分方案。\n关联流动法则是 $ \\dot{\\varepsilon}^{p} = \\dot{\\lambda} \\frac{\\partial f}{\\partial \\sigma} $。在拉伸加载下，我们预期 $ \\sigma > 0 $，因此 $ f = \\sigma - (\\sigma_{0} + H \\alpha) $ 且 $ \\frac{\\partial f}{\\partial \\sigma} = 1 $。\n硬化定律是 $ \\dot{\\alpha} = \\dot{\\lambda} $。\n在增量步上积分，我们得到塑性应变和硬化变量的增量：\n$$ \\Delta\\varepsilon^{p} = \\varepsilon^{p,n+1} - \\varepsilon^{p,n} = \\Delta\\lambda \\frac{\\partial f}{\\partial \\sigma}\\bigg|_{n+1} = \\Delta\\lambda \\cdot \\text{sgn}(\\sigma^{n+1}) $$\n$$ \\Delta\\alpha = \\alpha^{n+1} - \\alpha^{n} = \\Delta\\lambda $$\n由于是拉伸加载（$ \\sigma^{\\text{trial}} > 0 $），最终应力 $ \\sigma^{n+1} $ 也必须为正。因此，$ \\text{sgn}(\\sigma^{n+1})=1 $，这得出 $ \\Delta\\varepsilon^{p} = \\Delta\\lambda $。\n根据初始条件 $ \\varepsilon^{p,n} = 0 $ 和 $ \\alpha^{n} = 0 $，我们有：\n$$ \\varepsilon^{p,n+1} = \\Delta\\lambda $$\n$$ \\alpha^{n+1} = \\Delta\\lambda $$\n更新后的应力 $ \\sigma^{n+1} $ 与试探应力相关。根据胡克定律，$ \\sigma^{n+1} = E \\varepsilon^{e,n+1} = E (\\varepsilon^{n+1} - \\varepsilon^{p,n+1}) $。\n代入 $ \\varepsilon^{p,n+1} = \\Delta\\lambda $ 并注意到 $ \\sigma^{\\text{trial}} = E \\varepsilon^{n+1} $：\n$$ \\sigma^{n+1} = E \\varepsilon^{n+1} - E \\Delta\\lambda = \\sigma^{\\text{trial}} - E \\Delta\\lambda $$\n这就是“返回”方程，它将应力从试探点映射回屈服面。最终状态必须满足塑性一致性条件 $ f(\\sigma^{n+1}, \\alpha^{n+1}) = 0 $：\n$$ |\\sigma^{n+1}| - (\\sigma_{0} + H \\alpha^{n+1}) = 0 $$\n因为 $ \\sigma^{n+1} > 0 $，上式简化为：\n$$ \\sigma^{n+1} - \\sigma_{0} - H \\alpha^{n+1} = 0 \\implies \\sigma^{n+1} = \\sigma_{0} + H \\Delta\\lambda $$\n我们现在得到一个关于两个未知数 $ \\sigma^{n+1} $ 和 $ \\Delta\\lambda $ 的方程组：\n$$ \\sigma^{n+1} = \\sigma^{\\text{trial}} - E \\Delta\\lambda $$\n$$ \\sigma^{n+1} = \\sigma_{0} + H \\Delta\\lambda $$\n令这两个表达式相等，我们可以求解一致性参数 $ \\Delta\\lambda $：\n$$ \\sigma^{\\text{trial}} - E \\Delta\\lambda = \\sigma_{0} + H \\Delta\\lambda $$\n$$ \\sigma^{\\text{trial}} - \\sigma_{0} = (E + H) \\Delta\\lambda $$\n$$ \\Delta\\lambda = \\frac{\\sigma^{\\text{trial}} - \\sigma_{0}}{E + H} = \\frac{f^{\\text{trial}}}{E+H} $$\n现在我们代入数值：\n$$ \\Delta\\lambda = \\frac{630~\\text{MPa} - 250~\\text{MPa}}{2.1 \\times 10^{5}~\\text{MPa} + 1500~\\text{MPa}} = \\frac{380}{211500} \\approx 0.00179669 $$\n最后，我们使用最直接的关系式计算更新后的应力 $ \\sigma^{n+1} $：\n$$ \\sigma^{n+1} = \\sigma_{0} + H \\Delta\\lambda = 250~\\text{MPa} + 1500~\\text{MPa} \\times \\left( \\frac{380}{211500} \\right) $$\n$$ \\sigma^{n+1} = 250 + \\frac{570000}{211500} = 250 + 2.69503546... \\approx 252.695035...~\\text{MPa} $$\n题目要求答案以 $ \\text{MPa} $ 表示，并四舍五入至四位有效数字。\n$$ \\sigma^{n+1} \\approx 252.7~\\text{MPa} $$\n这个结果在物理上是合理的：由于硬化效应，最终应力大于初始屈服应力 $ \\sigma_{0} = 250~\\text{MPa} $，但由于塑性流动，它显著小于试探应力 $ \\sigma^{\\text{trial}} = 630~\\text{MPa} $。", "answer": "$$\\boxed{252.7}$$", "id": "2570543"}, {"introduction": "现在，我们将从简单的屈服面扩张，转向其在应力空间中的平移。本练习将通过把运动硬化与著名的“包申格效应”（Bauschinger effect）这一物理现象联系起来，揭开其神秘面纱。“包申格效应”指的是材料在反向加载时屈服应力的降低。你将确定反向屈服发生时的确切应力，并计算塑性流动的方向，从而对背应力张量 $\\boldsymbol{\\alpha}$ 如何模拟材料的“记忆效应”获得直观的理解。", "problem": "一个经历小应变的固体在三维空间中通过有限元法（FEM）中使用的标准弹塑性本构更新进行建模。采用带有随动硬化的 von Mises (基于第二偏应力不变量 $J_{2}$) 屈服条件。总 Cauchy 应力张量表示为 $\\boldsymbol{\\sigma}$，其偏量部分为 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\tfrac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma}) \\boldsymbol{I}$。背应力张量为 $\\boldsymbol{\\alpha}$（其构造使其为偏张量），单轴拉伸中的屈服应力为常数 $\\sigma_{y}$。\n\n从由单调单轴拉伸产生的先前已塑性化的状态开始，假设在反向加载之前，主基中的背应力是已知的，并且是对角张量，其主值为\n$$\n\\boldsymbol{\\alpha} = \\operatorname{diag}(100,\\,-50,\\,-50)\\ \\text{MPa},\n$$\n且屈服应力为 $\\sigma_{y} = 300\\ \\text{MPa}$。现在，您在主应力空间中指定一个由应力控制的路径，定义为\n$$\n\\boldsymbol{\\sigma}(t) = \\operatorname{diag}(\\sigma_{a}(t),\\,0,\\,0),\n$$\n其中 $\\sigma_{a}(t)$ 从一个正值单调减小，经过零，然后变为负值（反向加载）。\n\n仅使用以下基本要素：\n- 偏量分解 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\tfrac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma}) \\boldsymbol{I}$，\n- 带有随动平移的 von Mises 屈服函数 $f(\\boldsymbol{\\sigma},\\boldsymbol{\\alpha}) = \\sqrt{\\tfrac{3}{2}}\\,\\|\\boldsymbol{s} - \\boldsymbol{\\alpha}\\| - \\sigma_{y}$，\n- 塑性应变的相关联流动（正交）法则，\n\n完成以下任务：\n\n1) 在主应力空间中明确构建反向加载路径，并证明它在压缩主应力 $\\sigma_{a} < 0$（反向屈服）处与平移后的屈服面相交。通过在路径上施加 $f=0$ 条件来确定该反向屈服主应力 $\\sigma_{a}$。\n\n2) 在反向屈服的瞬间，计算塑性应变增量方向，该方向被理解为在活动点处主应力空间中屈服面的单位法向量。将您的答案表示为塑性应变增量方向主分量的单位向量。您只需报告此单位向量。将最终的方向向量表示为主基中的无量纲分量。无需四舍五入；请提供精确表达式。", "solution": "我们从带有随动硬化的小应变 $J_{2}$ 塑性理论的核心定义开始。带有背应力平移的屈服函数为\n$$\nf(\\boldsymbol{\\sigma},\\boldsymbol{\\alpha}) \\;=\\; \\sqrt{\\frac{3}{2}}\\,\\|\\boldsymbol{s} - \\boldsymbol{\\alpha}\\| \\;-\\; \\sigma_{y},\n$$\n其中 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\tfrac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma}) \\boldsymbol{I}$ 是偏应力。塑性加载需要满足 $f=0$ 和 $\\dot{\\lambda} \\ge 0$，而相关联流动（正交）法则给出塑性应变率为\n$$\n\\dot{\\boldsymbol{\\varepsilon}}^{p} \\;=\\; \\dot{\\lambda}\\,\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}.\n$$\n通过对 $f$ 求导，并利用 $\\boldsymbol{s}$ 是 $\\boldsymbol{\\sigma}$ 的偏量投影以及 $\\boldsymbol{\\alpha}$ 是偏张量的事实，我们得到\n$$\n\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} \\;=\\; \\sqrt{\\frac{3}{2}}\\,\\frac{\\boldsymbol{s}-\\boldsymbol{\\alpha}}{\\|\\boldsymbol{s}-\\boldsymbol{\\alpha}\\|},\n$$\n因此，塑性应变增量方向与 $\\boldsymbol{s}-\\boldsymbol{\\alpha}$ 共线（精确的标量因子对方向而言无关紧要）。因此，在屈服时，主基中塑性应变增量的单位方向是沿着 $\\boldsymbol{\\eta} := \\boldsymbol{s}-\\boldsymbol{\\alpha}$ 的单位向量。\n\n我们现在构建指定的路径并定位反向屈服点。\n\n1) 路径构建与反向屈服点。主应力路径为\n$$\n\\boldsymbol{\\sigma}(t) \\;=\\; \\operatorname{diag}(\\sigma_{a}(t),\\,0,\\,0),\n$$\n其中 $\\sigma_{a}(t)$ 从正值减小到负值。其偏量部分由下式获得\n$$\n\\operatorname{tr}(\\boldsymbol{\\sigma}) \\;=\\; \\sigma_{a}, \n\\qquad\n\\boldsymbol{s} \\;=\\; \\boldsymbol{\\sigma} - \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I},\n$$\n因此在主基中\n$$\n\\boldsymbol{s} \\;=\\; \\operatorname{diag}\\!\\Big(\\frac{2}{3}\\sigma_{a},\\,-\\frac{1}{3}\\sigma_{a},\\,-\\frac{1}{3}\\sigma_{a}\\Big).\n$$\n利用给定的背应力\n$$\n\\boldsymbol{\\alpha} \\;=\\; \\operatorname{diag}(100,\\,-50,\\,-50)\\ \\text{MPa},\n$$\n相对偏应力为\n$$\n\\boldsymbol{\\eta} \\;=\\; \\boldsymbol{s} - \\boldsymbol{\\alpha}\n\\;=\\;\n\\operatorname{diag}\\!\\Big(\\frac{2}{3}\\sigma_{a} - 100,\\,-\\frac{1}{3}\\sigma_{a} + 50,\\,-\\frac{1}{3}\\sigma_{a} + 50\\Big)\\ \\text{MPa}.\n$$\n沿该路径的屈服条件是\n$$\nf(\\sigma_{a}) \\;=\\; \\sqrt{\\frac{3}{2}}\\,\\|\\boldsymbol{\\eta}\\| \\;-\\; \\sigma_{y} \\;=\\; 0,\n\\qquad \\sigma_{y} \\;=\\; 300\\ \\text{MPa}.\n$$\n在主基中计算 $\\boldsymbol{\\eta}$ 的欧几里得范数：\n$$\n\\|\\boldsymbol{\\eta}\\|^{2}\n\\;=\\;\n\\Big(\\frac{2}{3}\\sigma_{a} - 100\\Big)^{2}\n\\;+\\;\n\\Big(-\\frac{1}{3}\\sigma_{a} + 50\\Big)^{2}\n\\;+\\;\n\\Big(-\\frac{1}{3}\\sigma_{a} + 50\\Big)^{2}.\n$$\n注意到 $(-\\frac{1}{3}\\sigma_a + 50) = -\\frac{1}{2}(\\frac{2}{3}\\sigma_a - 100)$，我们可以简化范数的计算。令 $X = \\frac{2}{3}\\sigma_a - 100$，则 $\\boldsymbol{\\eta}$ 的主分量为 $(X, -X/2, -X/2)$。\n$$\n\\|\\boldsymbol{\\eta}\\|^{2} = X^2 + (-\\frac{X}{2})^2 + (-\\frac{X}{2})^2 = X^2 + \\frac{X^2}{4} + \\frac{X^2}{4} = \\frac{3}{2}X^2.\n$$\n因此 $\\|\\boldsymbol{\\eta}\\| = \\sqrt{\\frac{3}{2}} |X|$。代入屈服条件：\n$$\n\\sqrt{\\frac{3}{2}} \\left(\\sqrt{\\frac{3}{2}}|X|\\right) = \\sigma_y \\implies \\frac{3}{2}|X| = \\sigma_y \\implies |X| = \\frac{2}{3}\\sigma_y.\n$$\n将 $\\sigma_y=300$ MPa 代入，我们得到 $|X|=200$ MPa。\n$$\n|\\frac{2}{3}\\sigma_a - 100| = 200.\n$$\n这给出了两个解：\n- $\\frac{2}{3}\\sigma_a - 100 = 200 \\implies \\frac{2}{3}\\sigma_a = 300 \\implies \\sigma_a = 450$ MPa (正向屈服)。\n- $\\frac{2}{3}\\sigma_a - 100 = -200 \\implies \\frac{2}{3}\\sigma_a = -100 \\implies \\sigma_a = -150$ MPa (反向屈服)。\n这证实了在压缩应力 $\\sigma_a = -150$ MPa 下发生了反向屈服。在这一点上，\n$$\nX = \\frac{2}{3}(-150) - 100 = -100-100 = -200 \\text{ MPa}.\n$$\n$$\n\\boldsymbol{\\eta} = \\operatorname{diag}(X, -X/2, -X/2) = \\operatorname{diag}(-200,\\,100,\\,100)\\ \\text{MPa}.\n$$\n\n2) 反向屈服时的塑性应变增量方向。根据相关联流动法则，塑性应变增量方向与 $\\partial f / \\partial \\boldsymbol{\\sigma}$ 共线，而后者又与 $\\boldsymbol{\\eta}$ 共线。因此，在主基中，所要求的单位方向向量为\n$$\n\\widehat{\\boldsymbol{n}}_{p}\n\\;=\\;\n\\frac{\\boldsymbol{\\eta}}{\\|\\boldsymbol{\\eta}\\|}\n\\;=\\;\n\\frac{1}{\\sqrt{(-200)^{2} + 100^{2} + 100^{2}}}\\,\\big(-200,\\,100,\\,100\\big)\n\\;=\\;\n\\frac{1}{100\\sqrt{6}}\\,\\big(-200,\\,100,\\,100\\big)\n\\;=\\;\n\\Big(-\\frac{2}{\\sqrt{6}},\\,\\frac{1}{\\sqrt{6}},\\,\\frac{1}{\\sqrt{6}}\\Big).\n$$\n该单位向量是沿所构建路径在反向屈服瞬间塑性应变增量的无量纲主分量方向。注意，来自 $\\partial f/\\partial \\boldsymbol{\\sigma}$ 的任何标量乘子在归一化时都会被消去，只留下方向。", "answer": "$$\\boxed{\\begin{pmatrix}-\\dfrac{2}{\\sqrt{6}} & \\dfrac{1}{\\sqrt{6}} & \\dfrac{1}{\\sqrt{6}}\\end{pmatrix}}$$", "id": "2570566"}, {"introduction": "这最后一个练习将从纸笔计算过渡到编程实现，解决一个复杂且具有重要工程意义的问题。你将编写一个完整的本构模型，该模型结合了非线性运动硬化（Chaboche 模型）和各向同性硬化（Voce 模型），用以预测在存在平均应力下的循环加载过程中出现的“棘轮效应”（ratcheting）——即塑性应变的逐周期累积。这项练习将你所学的所有知识融会贯通，构建出一个强大的预测工具，从而展示了高级硬化模型在工程分析中的实际应用价值。", "problem": "考虑一个单轴材料点，其本构关系由小应变相关联塑性理论描述，屈服条件为 von Mises（第二偏应力不变量 J2）类型，硬化模型为包含两个背应力分量的 Chaboche 型组合各向同性-随动硬化，并处于应力控制下。令总应变为 $\\varepsilon$，弹性应变为 $\\varepsilon^{e}$，塑性应变为 $\\varepsilon^{p}$。线性弹性关系成立，杨氏模量为 $E$，因此有 $\\sigma = E \\left( \\varepsilon - \\varepsilon^{p} \\right)$，其中 $\\sigma$ 是 Cauchy 应力。单轴屈服函数为\n$$\nf = \\left| \\sigma - \\alpha \\right| - \\left( \\sigma_{y0} + R \\right),\n$$\n其中 $\\sigma_{y0}$ 是初始屈服应力，$\\alpha = \\alpha_{1} + \\alpha_{2}$ 是两个背应力分量之和，而 $R$ 是各向同性硬化变量。使用塑性乘子增量 $d p \\ge 0$ 的相关联流动法则给出塑性应变增量 $d \\varepsilon^{p} = d p \\, \\text{sign}\\!\\left( \\sigma - \\alpha \\right)$。双项 Chaboche 随动硬化准则和一个 Voce 型各向同性硬化准则以率形式假定为\n$$\nd \\alpha_{i} = \\frac{2}{3} C_{i} \\, d p \\, \\text{sign}\\!\\left( \\sigma - \\alpha \\right) - \\gamma_{i} \\, \\alpha_{i} \\, d p \\quad \\text{对于 } i \\in \\{1,2\\},\n$$\n$$\nd R = b \\left( Q - R \\right) d p,\n$$\n其中材料参数为 $C_{i} > 0$, $\\gamma_{i} \\ge 0$, $b \\ge 0$, 以及 $Q \\ge 0$。应力被规定为一个随时间变化的函数，在一个周期内呈具有非零均值的正弦形式：\n$$\n\\sigma(t) = \\sigma_{m} + \\sigma_{a} \\sin \\left( \\omega t \\right),\n$$\n其中 $\\sigma_{m}$ 是平均应力，$\\sigma_{a}$ 是振幅，$\\omega$ 是角频率。所有角度均以弧度为单位。\n\n从周期开始时的初始状态（即 $\\varepsilon^{p}(0) = 0$, $\\alpha_{1}(0) = 0$, $\\alpha_{2}(0) = 0$, 和 $R(0) = 0$）出发，使用 $N$ 个均匀子步，在应力控制下对本构方程进行数值积分，覆盖整整一个周期 $T = \\frac{2\\pi}{\\omega}$，并计算每周期的净塑性应变累积\n$$\n\\Delta \\varepsilon^{p}_{\\text{cycle}} = \\varepsilon^{p}(T) - \\varepsilon^{p}(0).\n$$\n您必须在塑性步中使用无条件稳定的后向欧拉离散化来处理内禀变量 $\\alpha_{i}$ 和 $R$，在每个子步结束时强制满足屈服条件，并一致地处理弹塑性转换。流动方向 $\\text{sign}\\!\\left( \\sigma - \\alpha \\right)$ 必须在每个子步内保持一致使用。\n\n您的程序必须：\n- 在应力控制下，于每个子步中实现一个稳健的标量返回映射算法。对于塑性子步，通过求解关于塑性乘子增量 $\\Delta p$ 的单个非线性方程，以强制在子步结束时满足 $f_{n+1} = 0$。\n- 使用一个带安全保护的求根程序来求解 $\\Delta p$，该程序对所有测试用例都能收敛。使用二分法的区间法或带安全保护的牛顿法都是可接受的。\n- 用 $N$ 个均匀步长离散化一个周期，并将 $\\Delta \\varepsilon^{p}_{\\text{cycle}}$ 作为带符号的塑性增量之和进行累积。\n\n物理单位与数值精度要求：\n- 应力 $\\sigma$、$\\sigma_{y0}$、$C_{i}$ 和 $Q$ 的单位是兆帕 (MPa)。\n- 应变 $\\varepsilon$、$\\varepsilon^{p}$ 和 $\\Delta \\varepsilon^{p}_{\\text{cycle}}$ 是无量纲的。\n- 角频率 $\\omega$ 的单位是弧度/秒，时间 $t$ 的单位是秒。\n- 最终答案表示为精确到六位小数的无量纲浮点数。\n\n测试套件与参数：\n对于每个测试用例，材料参数和加载条件如下指定。对所有用例，使用 $T = 1$ 秒（即 $\\omega = 2\\pi$ 弧度/秒）和 $N = 4000$ 个子步/周期。\n\n- 测试用例 $1$（平均应力下的广义棘轮效应）：\n  - $E = 210000$ MPa, $\\sigma_{y0} = 250$ MPa.\n  - $C_{1} = 150000$ MPa, $\\gamma_{1} = 300$; $C_{2} = 3000$ MPa, $\\gamma_{2} = 30$.\n  - $b = 5$, $Q = 100$ MPa.\n  - $\\sigma_{m} = 150$ MPa, $\\sigma_{a} = 150$ MPa, $\\omega = 2\\pi$ rad/s.\n\n- 测试用例 $2$（弹性参考，无塑性）：\n  - $E = 210000$ MPa, $\\sigma_{y0} = 250$ MPa.\n  - $C_{1} = 150000$ MPa, $\\gamma_{1} = 300$; $C_{2} = 3000$ MPa, $\\gamma_{2} = 30$.\n  - $b = 5$, $Q = 100$ MPa.\n  - $\\sigma_{m} = 100$ MPa, $\\sigma_{a} = 50$ MPa, $\\omega = 2\\pi$ rad/s.\n\n- 测试用例 $3$（每半周期的单向塑性；预期有净棘轮效应）：\n  - $E = 210000$ MPa, $\\sigma_{y0} = 250$ MPa.\n  - $C_{1} = 150000$ MPa, $\\gamma_{1} = 300$; $C_{2} = 3000$ MPa, $\\gamma_{2} = 30$.\n  - $b = 5$, $Q = 100$ MPa.\n  - $\\sigma_{m} = 230$ MPa, $\\sigma_{a} = 60$ MPa, $\\omega = 2\\pi$ rad/s.\n\n- 测试用例 $4$（更强的各向同性硬化对棘轮效应的影响）：\n  - $E = 210000$ MPa, $\\sigma_{y0} = 250$ MPa.\n  - $C_{1} = 150000$ MPa, $\\gamma_{1} = 300$; $C_{2} = 3000$ MPa, $\\gamma_{2} = 30$.\n  - $b = 30$, $Q = 200$ MPa.\n  - $\\sigma_{m} = 230$ MPa, $\\sigma_{a} = 60$ MPa, $\\omega = 2\\pi$ rad/s.\n\n所有测试用例的初始条件均为 $\\varepsilon^{p}(0) = 0$, $\\alpha_{1}(0) = 0$, $\\alpha_{2}(0) = 0$, $R(0) = 0$。\n\n一个从时间 $t_{n}$ 到 $t_{n+1}$ 的子步的算法要求：\n- 给定预设的 $\\sigma_{n+1}$ 和前一步的状态 $\\left( \\varepsilon^{p}_{n}, \\alpha_{1,n}, \\alpha_{2,n}, R_{n} \\right)$，首先计算试探屈服函数 $f_{\\text{trial}} = \\left| \\sigma_{n+1} - \\alpha_{n} \\right| - \\left( \\sigma_{y0} + R_{n} \\right)$，其中 $\\alpha_{n} = \\alpha_{1,n} + \\alpha_{2,n}$。\n- 如果 $f_{\\text{trial}} \\le 0$，则该步为弹性步，状态不变。\n- 如果 $f_{\\text{trial}} > 0$，则确定流动方向 $s = \\text{sign}\\!\\left( \\sigma_{n+1} - \\alpha_{n} \\right)$，并求解塑性乘子增量 $\\Delta p \\ge 0$，该增量通过后向欧拉更新强制在该步结束时满足屈服条件：\n  - $\\alpha_{i,n+1} = \\dfrac{ \\alpha_{i,n} + \\dfrac{2}{3} C_{i} \\, s \\, \\Delta p }{ 1 + \\gamma_{i} \\Delta p }$ 对于 $i \\in \\{1,2\\}$，\n  - $R_{n+1} = \\dfrac{ R_{n} + b Q \\, \\Delta p }{ 1 + b \\Delta p }$，\n  - 强制满足 $\\left| \\sigma_{n+1} - \\alpha_{n+1} \\right| - \\left( \\sigma_{y0} + R_{n+1} \\right) = 0$，其中 $\\alpha_{n+1} = \\alpha_{1,n+1} + \\alpha_{2,n+1}$。\n  - 更新 $\\varepsilon^{p}_{n+1} = \\varepsilon^{p}_{n} + s \\, \\Delta p$。\n\n数值容差必须足够严格，以确保最终四舍五入到六位小数的结果有意义。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$\\left[ r_{1}, r_{2}, r_{3}, r_{4} \\right]$），其中每个 $r_{k}$ 是为测试用例 $k$ 计算的 $\\Delta \\varepsilon^{p}_{\\text{cycle}}$，并四舍五入到六位小数。", "solution": "问题陈述是有效的。它提出了一个在计算固体力学领域中定义明确、有科学依据的任务。它是客观、完整且无矛盾的。该问题要求在给定的应力循环下，对一个具有 Chaboche 型组合各向同性-随动硬化的标准单轴弹塑性本构模型进行数值积分。所有必要的材料参数、加载条件、初始条件和算法规范均已提供，从而可以得到唯一且有意义的解。\n\n解决方案涉及模拟材料在一个完整加载周期内的响应，该周期被离散为大量的均匀时间子步。对于每个子步，执行一次应力控制的更新。算法的核心是返回映射过程，该过程在任何导致塑性变形的子步中被调用。\n\n材料点的状态由其状态变量定义：塑性应变 $\\varepsilon^{p}$、两个背应力分量 $\\alpha_{1}$ 和 $\\alpha_{2}$，以及一个各向同性硬化变量 $R$。初始状态为原始状态，意味着所有这些变量在时间 $t=0$ 时均为零。\n\n在每个从时间 $t_{n}$ 到 $t_{n+1}$ 的子步中，应力 $\\sigma_{n+1} = \\sigma(t_{n+1})$ 是已知的。在 $t_{n}$ 的状态，表示为 $(\\varepsilon^{p}_{n}, \\alpha_{1,n}, \\alpha_{2,n}, R_{n})$，也是已知的。在 $t_{n}$ 的总背应力为 $\\alpha_{n} = \\alpha_{1,n} + \\alpha_{2,n}$。\n\n首先，假定一个弹性试探步。使用上一步的状态来评估试探屈服函数 $f_{\\text{trial}}$：\n$$\nf_{\\text{trial}} = \\left| \\sigma_{n+1} - \\alpha_{n} \\right| - \\left( \\sigma_{y0} + R_{n} \\right)\n$$\n如果 $f_{\\text{trial}} \\le 0$，则假设正确：该步是弹性的。内禀状态变量不发生演化。\n$$\n\\varepsilon^{p}_{n+1} = \\varepsilon^{p}_{n}, \\quad \\alpha_{i,n+1} = \\alpha_{i,n}, \\quad R_{n+1} = R_{n}\n$$\n\n如果 $f_{\\text{trial}} > 0$，则该步涉及塑性变形。在 $t_{n+1}$ 的状态必须满足屈服条件 $f_{n+1}=0$。我们必须找到一致的塑性乘子增量 $\\Delta p > 0$。塑性应变增量为 $d\\varepsilon^{p} = d p \\, \\text{sign}(\\sigma - \\alpha)$。内禀变量的演化由率方程控制，这些方程使用隐式后向欧拉格式进行积分以确保无条件稳定性。\n\n该子步的流动方向由试探状态确定：\n$$\ns = \\text{sign}\\!\\left( \\sigma_{n+1} - \\alpha_{n} \\right)\n$$\n后向欧拉离散化的内禀变量更新规则如下：\n$$\n\\alpha_{i,n+1} = \\frac{ \\alpha_{i,n} + \\frac{2}{3} C_{i} \\, s \\, \\Delta p }{ 1 + \\gamma_{i} \\Delta p } \\quad \\text{for } i \\in \\{1,2\\}\n$$\n$$\nR_{n+1} = \\frac{ R_{n} + b Q \\, \\Delta p }{ 1 + b \\Delta p }\n$$\n该步结束时的总背应力为 $\\alpha_{n+1} = \\alpha_{1,n+1} + \\alpha_{2,n+1}$。在 $t_{n+1}$ 的屈服条件变成一个关于 $\\Delta p$ 的非线性标量方程：\n$$\ng(\\Delta p) = \\left| \\sigma_{n+1} - \\alpha_{n+1}(\\Delta p) \\right| - \\left( \\sigma_{y0} + R_{n+1}(\\Delta p) \\right) = 0\n$$\n由于流动方向 $s$ 是固定的，可以去掉绝对值写成：\n$$\ng(\\Delta p) = s \\left( \\sigma_{n+1} - \\sum_{i=1}^{2} \\frac{ \\alpha_{i,n} + \\frac{2}{3} C_{i} \\, s \\, \\Delta p }{ 1 + \\gamma_{i} \\Delta p } \\right) - \\left( \\sigma_{y0} + \\frac{ R_{n} + b Q \\, \\Delta p }{ 1 + b \\Delta p } \\right) = 0\n$$\n必须求解这个关于 $\\Delta p$ 的函数。在 $\\Delta p=0$ 时，我们有 $g(0) = f_{\\text{trial}} > 0$。可以证明，在物理上合理的假设下（特别是动态恢复项不超过线性硬化项，这是模型稳定性的一个条件），导数 $g'(\\Delta p)$ 是严格为负的。这种单调递减性质保证了 $\\Delta p$ 存在唯一的正根，前提是应力水平是材料模型可以达到的。\n\n一个稳健的数值求根方法，如 Brent 法，适合求解 $g(\\Delta p) = 0$。这需要确定根的区间。我们知道根大于 $0$，所以下界是 $a=0$。可以通过从一个较小的值开始并不断增加它直到 $g(b)$ 变为负值来找到上界 $b$。\n\n一旦找到正确的 $\\Delta p$，就使用上述后向欧拉方程更新状态变量。塑性应变被累积：\n$$\n\\varepsilon^{p}_{n+1} = \\varepsilon^{p}_{n} + s \\, \\Delta p\n$$\n这个过程在周期 $T=1$ 秒内重复 $N=4000$ 个子步。每个测试用例的最终结果是周期内的净累积塑性应变 $\\Delta\\varepsilon^{p}_{\\text{cycle}} = \\varepsilon^{p}(T)$。\n\n实现将遵循此逻辑，对所提供的四个测试用例分别使用指定的材料和加载参数。最终结果按要求四舍五入到六位小数。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the Chaboche hardening problem for the specified test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1 (general ratcheting)\n        {\n            \"E\": 210000.0, \"sig_y0\": 250.0,\n            \"C1\": 150000.0, \"gamma1\": 300.0,\n            \"C2\": 3000.0, \"gamma2\": 30.0,\n            \"b\": 5.0, \"Q\": 100.0,\n            \"sigma_m\": 150.0, \"sigma_a\": 150.0,\n        },\n        # Test case 2 (elastic reference)\n        {\n            \"E\": 210000.0, \"sig_y0\": 250.0,\n            \"C1\": 150000.0, \"gamma1\": 300.0,\n            \"C2\": 3000.0, \"gamma2\": 30.0,\n            \"b\": 5.0, \"Q\": 100.0,\n            \"sigma_m\": 100.0, \"sigma_a\": 50.0,\n        },\n        # Test case 3 (unilateral plasticity)\n        {\n            \"E\": 210000.0, \"sig_y0\": 250.0,\n            \"C1\": 150000.0, \"gamma1\": 300.0,\n            \"C2\": 3000.0, \"gamma2\": 30.0,\n            \"b\": 5.0, \"Q\": 100.0,\n            \"sigma_m\": 230.0, \"sigma_a\": 60.0,\n        },\n        # Test case 4 (stronger isotropic hardening)\n        {\n            \"E\": 210000.0, \"sig_y0\": 250.0,\n            \"C1\": 150000.0, \"gamma1\": 300.0,\n            \"C2\": 3000.0, \"gamma2\": 30.0,\n            \"b\": 30.0, \"Q\": 200.0,\n            \"sigma_m\": 230.0, \"sigma_a\": 60.0,\n        },\n    ]\n\n    results = []\n    for params in test_cases:\n        result = compute_ratcheting(**params)\n        results.append(f\"{result:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef compute_ratcheting(E, sig_y0, C1, gamma1, C2, gamma2, b, Q, sigma_m, sigma_a):\n    \"\"\"\n    Numerically integrates the constitutive model over one cycle.\n\n    Args:\n        E (float): Young's modulus\n        sig_y0 (float): Initial yield stress\n        C1, gamma1 (float): Parameters for backstress component 1\n        C2, gamma2 (float): Parameters for backstress component 2\n        b, Q (float): Parameters for isotropic hardening\n        sigma_m, sigma_a (float): Mean stress and stress amplitude\n\n    Returns:\n        float: Net plastic strain accumulation over one cycle.\n    \"\"\"\n    N = 4000\n    T = 1.0\n    omega = 2.0 * np.pi / T\n    dt = T / N\n\n    # Initial conditions\n    eps_p = 0.0\n    alpha1 = 0.0\n    alpha2 = 0.0\n    R = 0.0\n    \n    times = np.linspace(dt, T, N)\n    \n    for t_np1 in times:\n        sigma_np1 = sigma_m + sigma_a * np.sin(omega * t_np1)\n        \n        # State at step n (current state)\n        eps_p_n, alpha1_n, alpha2_n, R_n = eps_p, alpha1, alpha2, R\n        alpha_n = alpha1_n + alpha2_n\n        \n        # Trial yield function\n        f_trial = np.abs(sigma_np1 - alpha_n) - (sig_y0 + R_n)\n        \n        if f_trial <= 1e-9: # Elastic step (with tolerance)\n            # State remains unchanged\n            eps_p_np1, alpha1_np1, alpha2_np1, R_np1 = eps_p_n, alpha1_n, alpha2_n, R_n\n        else: # Plastic step\n            s = np.sign(sigma_np1 - alpha_n)\n            \n            # Define the residual function for the return mapping\n            def residual(dp):\n                # Calculate updated state variables based on dp\n                a1_np1 = (alpha1_n + (2.0/3.0) * C1 * s * dp) / (1.0 + gamma1 * dp)\n                a2_np1 = (alpha2_n + (2.0/3.0) * C2 * s * dp) / (1.0 + gamma2 * dp)\n                R_np1_val = (R_n + b * Q * dp) / (1.0 + b * dp)\n                \n                alpha_np1_val = a1_np1 + a2_np1\n                \n                # Enforce yield condition at the end of the step\n                return s * (sigma_np1 - alpha_np1_val) - (sig_y0 + R_np1_val)\n\n            # Find a bracket for the root-finder\n            a_bracket, b_bracket = 0.0, 1e-6\n            try:\n                while residual(b_bracket) > 0:\n                    b_bracket *= 2.0\n                    if b_bracket > 1.0: # Safeguard against infinite loops\n                        raise RuntimeError(\"Failed to find root bracket below dp=1.0\")\n            except Exception as e:\n                # Can happen if residual is always positive, indicates issue in model/params\n                print(f\"Error finding bracket for brentq: {e}\")\n                dp = 0 # Assume no plastic step if bracket is not found\n            \n            # Solve for plastic multiplier increment dp\n            if residual(b_bracket) <= 0:\n                dp = brentq(residual, a_bracket, b_bracket, xtol=1e-12, rtol=1e-12)\n            else: # Fallback if bracketing failed\n                dp = 0.0\n\n\n            # Update state variables with the found dp\n            alpha1_np1 = (alpha1_n + (2.0/3.0) * C1 * s * dp) / (1.0 + gamma1 * dp)\n            alpha2_np1 = (alpha2_n + (2.0/3.0) * C2 * s * dp) / (1.0 + gamma2 * dp)\n            R_np1 = (R_n + b * Q * dp) / (1.0 + b * dp)\n            eps_p_np1 = eps_p_n + s * dp\n            \n        # Update state for the next step\n        eps_p, alpha1, alpha2, R = eps_p_np1, alpha1_np1, alpha2_np1, R_np1\n        \n    return eps_p\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2570605"}]}