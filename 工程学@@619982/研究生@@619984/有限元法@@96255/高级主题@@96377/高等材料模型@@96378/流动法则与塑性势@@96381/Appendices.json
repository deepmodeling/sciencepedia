{"hands_on_practices": [{"introduction": "掌握计算塑性力学的核心在于理解并能亲手执行应力更新算法。本练习将引导你完成最基础也是最重要的一个案例：针对服从 von Mises ($J_2$) 屈服准则和相关联流动法则的材料，进行完整的返回映射计算 [@problem_id:2559758]。对于这类常用于描述金属的材料模型，一个关键特性是塑性流动不引起体积变化，此练习将清晰地展示这一原理的计算过程。", "problem": "在一个弹塑性固体的标准小应变有限元中的单个 Gauss 点上，考虑使用带有后向 Euler 积分的弹性预测/塑性修正格式，在一个时间步内进行增量本构更新。该材料是各向同性线弹性体，其 Young’s 模量 $E=80\\,\\text{GPa}$，Poisson’s 比 $\\nu=\\tfrac{1}{3}$。材料遵循 von Mises (J2) 屈服准则，并伴有线性各向同性硬化，其特征为初始屈服应力 $\\sigma_{y}=250\\,\\text{MPa}$ 和硬化模量 $H=10{,}000\\,\\text{MPa}$。小应变加法分解成立，即 $\\boldsymbol{\\varepsilon}=\\boldsymbol{\\varepsilon}^{e}+\\boldsymbol{\\varepsilon}^{p}$。\n\n在该时间步开始时，内变量为 $\\boldsymbol{\\varepsilon}^{p}_{n}=\\boldsymbol{0}$，累积等效塑性应变为 $\\alpha_{n}=0$。忽略塑性流动得到的弹性试探 Cauchy 应力由下式给出\n$$\n\\boldsymbol{\\sigma}^{\\text{tr}}=\\begin{pmatrix}\n300 & 0 & 0\\\\\n0 & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix}\\,\\text{MPa}.\n$$\n其偏量部分记为 $\\boldsymbol{s}^{\\text{tr}}=\\boldsymbol{\\sigma}^{\\text{tr}}-\\tfrac{1}{3}\\text{tr}(\\boldsymbol{\\sigma}^{\\text{tr}})\\boldsymbol{I}$，偏应力的第二不变量记为 $J_{2}^{\\text{tr}}=\\tfrac{1}{2}\\boldsymbol{s}^{\\text{tr}}:\\boldsymbol{s}^{\\text{tr}}$。von Mises 等效应力为 $\\sigma_{\\text{eq}}=\\sqrt{3J_{2}}$。对于给定数据，已知 $\\sqrt{3J_{2}^{\\text{tr}}}>\\sigma_{y}$。\n\n使用关联流动法则（塑性势等于屈服函数）和一致性条件，对该时间步执行完整的返回映射应力更新，以获得更新后的 Cauchy 应力 $\\boldsymbol{\\sigma}_{n+1}$ 和塑性应变增量 $\\Delta\\boldsymbol{\\varepsilon}^{p}=\\boldsymbol{\\varepsilon}^{p}_{n+1}-\\boldsymbol{\\varepsilon}^{p}_{n}$。假设小应变和标准各向同性线弹性，剪切模量为 $\\mu=E/[2(1+\\nu)]$，体积模量为 $K=E/[3(1-2\\nu)]$。\n\n作为最终答案，请报告塑性乘子增量 $\\Delta\\gamma$（对于关联 $J_{2}$ 塑性，其值等于等效塑性应变增量），结果为一个无量纲数。将您的答案四舍五入到四位有效数字。", "solution": "问题陈述科学严谨、提法恰当且完整。它描述了计算塑性力学中的一个标准流程。因此，我们可以开始求解。\n\n该问题要求使用后向 Euler 积分格式，计算一个遵循 $J_2$ 塑性理论和线性各向同性硬化的材料的塑性乘子增量 $\\Delta\\gamma$。\n\n本构模型定义如下：\n$1$. 带有线性各向同性硬化的 von Mises 屈服函数 $\\Phi$：\n$$\n\\Phi(\\boldsymbol{\\sigma}, \\alpha) = \\sigma_{\\text{eq}}(\\boldsymbol{\\sigma}) - \\sigma_Y(\\alpha) = \\sqrt{3J_{2}(\\boldsymbol{\\sigma})} - (\\sigma_{y} + H\\alpha) \\le 0\n$$\n其中 $\\boldsymbol{\\sigma}$ 是 Cauchy 应力张量，$\\sigma_{\\text{eq}}$ 是 von Mises 等效应力，$J_2$ 是偏应力张量 $\\boldsymbol{s}$ 的第二不变量，$\\sigma_y$ 是初始屈服应力，$H$ 是硬化模量，$\\alpha$ 是累积等效塑性应变。\n\n$2$. 关联流动法则，其中塑性势即屈服函数本身。塑性应变增量由下式给出：\n$$\n\\Delta\\boldsymbol{\\varepsilon}^{p} = \\Delta\\gamma \\frac{\\partial \\Phi}{\\partial \\boldsymbol{\\sigma}}\\bigg|_{n+1}\n$$\n其中 $\\Delta\\gamma$ 是塑性乘子增量，梯度在时间步末端（时间 $t_{n+1}$）计算，与后向 Euler 格式一致。von Mises 等效应力的梯度为 $\\frac{\\partial\\sigma_{\\text{eq}}}{\\partial\\boldsymbol{\\sigma}} = \\frac{3}{2\\sigma_{\\text{eq}}}\\boldsymbol{s}$。因此，流动法则为：\n$$\n\\Delta\\boldsymbol{\\varepsilon}^{p} = \\Delta\\gamma \\frac{3\\boldsymbol{s}_{n+1}}{2\\sigma_{\\text{eq},n+1}}\n$$\n该法则意味着塑性流动是体积不变的，即 $\\text{tr}(\\Delta\\boldsymbol{\\varepsilon}^{p})=0$。\n\n$3$. 线性各向同性硬化定律。对于关联 $J_2$ 塑性，累积塑性应变增量等于塑性乘子增量：\n$$\n\\Delta\\alpha = \\Delta\\gamma\n$$\n时间步末端的累积塑性应变为 $\\alpha_{n+1} = \\alpha_n + \\Delta\\alpha$。\n\n返回映射算法包括一个弹性预测步和一个塑性修正步。试探应力 $\\boldsymbol{\\sigma}^{\\text{tr}}$ 是弹性预测值。由于其等效应力 $\\sigma_{\\text{eq}}^{\\text{tr}}$ 超过了当前的屈服强度 $\\sigma_Y(\\alpha_n)$，因此需要进行塑性修正。\n\n时间步末端的应力 $\\boldsymbol{\\sigma}_{n+1}$ 与试探应力的关系如下：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\text{tr}} - \\mathbb{C}:\\Delta\\boldsymbol{\\varepsilon}^{p}\n$$\n对于各向同性线弹性材料，并且考虑到塑性流动是纯偏量的，该方程可简化为：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\text{tr}} - 2\\mu\\Delta\\boldsymbol{\\varepsilon}^{p}\n$$\n其中 $\\mu$ 是剪切模量。通过将应力分解为静水压力部分（$p = \\frac{1}{3}\\text{tr}(\\boldsymbol{\\sigma})$）和偏量部分（$\\boldsymbol{s}$），我们发现静水压力保持不变，即 $p_{n+1}=p^{\\text{tr}}$，而偏应力更新如下：\n$$\n\\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\text{tr}} - 2\\mu\\Delta\\boldsymbol{\\varepsilon}^{p}\n$$\n将流动法则代入此方程可得：\n$$\n\\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\text{tr}} - 2\\mu \\left( \\Delta\\gamma \\frac{3\\boldsymbol{s}_{n+1}}{2\\sigma_{\\text{eq},n+1}} \\right) = \\boldsymbol{s}^{\\text{tr}} - 3\\mu\\Delta\\gamma \\frac{\\boldsymbol{s}_{n+1}}{\\sigma_{\\text{eq},n+1}}\n$$\n对 $\\boldsymbol{s}_{n+1}$ 重新整理可得：\n$$\n\\boldsymbol{s}_{n+1} \\left( 1 + \\frac{3\\mu\\Delta\\gamma}{\\sigma_{\\text{eq},n+1}} \\right) = \\boldsymbol{s}^{\\text{tr}}\n$$\n此方程表明 $\\boldsymbol{s}_{n+1}$ 与 $\\boldsymbol{s}^{\\text{tr}}$ 共轴且方向相同。对两边取 von Mises 等效应力（注意 $\\sigma_{\\text{eq}}$ 是偏量张量的一种范数）可得：\n$$\n\\sigma_{\\text{eq},n+1} \\left( 1 + \\frac{3\\mu\\Delta\\gamma}{\\sigma_{\\text{eq},n+1}} \\right) = \\sigma_{\\text{eq}}^{\\text{tr}}\n$$\n这可以简化为一个关键关系式：\n$$\n\\sigma_{\\text{eq},n+1} + 3\\mu\\Delta\\gamma = \\sigma_{\\text{eq}}^{\\text{tr}} \\quad (1)\n$$\n第二个方程来自一致性条件，该条件要求在塑性加载步结束时，应力状态必须位于更新后的屈服面上：\n$$\n\\Phi(\\boldsymbol{\\sigma}_{n+1}, \\alpha_{n+1}) = 0 \\implies \\sigma_{\\text{eq},n+1} - (\\sigma_y + H\\alpha_{n+1}) = 0\n$$\n使用 $\\alpha_{n+1} = \\alpha_n + \\Delta\\gamma$ 以及给定的初始条件 $\\alpha_n=0$：\n$$\n\\sigma_{\\text{eq},n+1} - (\\sigma_y + H\\Delta\\gamma) = 0 \\implies \\sigma_{\\text{eq},n+1} - H\\Delta\\gamma = \\sigma_y \\quad (2)\n$$\n我们现在求解由方程 $(1)$ 和 $(2)$ 组成的关于两个未知数 $\\sigma_{\\text{eq},n+1}$ 和 $\\Delta\\gamma$ 的线性方程组。将方程 $(2)$ 从方程 $(1)$ 中减去：\n$$\n(\\sigma_{\\text{eq},n+1} + 3\\mu\\Delta\\gamma) - (\\sigma_{\\text{eq},n+1} - H\\Delta\\gamma) = \\sigma_{\\text{eq}}^{\\text{tr}} - \\sigma_y\n$$\n$$\n(3\\mu + H)\\Delta\\gamma = \\sigma_{\\text{eq}}^{\\text{tr}} - \\sigma_y\n$$\n这就得出了塑性乘子增量的闭式解：\n$$\n\\Delta\\gamma = \\frac{\\sigma_{\\text{eq}}^{\\text{tr}} - \\sigma_y}{3\\mu + H}\n$$\n现在，我们代入给定的数值。\n材料属性如下：\n$E=80\\,\\text{GPa} = 80000\\,\\text{MPa}$\n$\\nu=\\frac{1}{3}$\n$\\sigma_y=250\\,\\text{MPa}$\n$H=10000\\,\\text{MPa}$\n\n首先，我们计算剪切模量 $\\mu$：\n$$\n\\mu = \\frac{E}{2(1+\\nu)} = \\frac{80000\\,\\text{MPa}}{2(1+\\frac{1}{3})} = \\frac{80000\\,\\text{MPa}}{2(\\frac{4}{3})} = \\frac{80000\\,\\text{MPa}}{8/3} = 30000\\,\\text{MPa}\n$$\n接下来，我们根据给定的试探应力张量 $\\boldsymbol{\\sigma}^{\\text{tr}}$ 计算试探 von Mises 等效应力 $\\sigma_{\\text{eq}}^{\\text{tr}}$：\n$$\n\\boldsymbol{\\sigma}^{\\text{tr}}=\\begin{pmatrix}\n300 & 0 & 0\\\\\n0 & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix}\\,\\text{MPa}\n$$\n试探应力的静水压力部分是：\n$$\np^{\\text{tr}} = \\frac{1}{3}\\text{tr}(\\boldsymbol{\\sigma}^{\\text{tr}}) = \\frac{1}{3}(300+0+0)\\,\\text{MPa} = 100\\,\\text{MPa}\n$$\n偏试探应力张量 $\\boldsymbol{s}^{\\text{tr}} = \\boldsymbol{\\sigma}^{\\text{tr}} - p^{\\text{tr}}\\boldsymbol{I}$ 为：\n$$\n\\boldsymbol{s}^{\\text{tr}} = \\begin{pmatrix}\n300 & 0 & 0\\\\\n0 & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix} - \\begin{pmatrix}\n100 & 0 & 0\\\\\n0 & 100 & 0\\\\\n0 & 0 & 100\n\\end{pmatrix} = \\begin{pmatrix}\n200 & 0 & 0\\\\\n0 & -100 & 0\\\\\n0 & 0 & -100\n\\end{pmatrix}\\,\\text{MPa}\n$$\n偏试探应力的第二不变量 $J_{2}^{\\text{tr}} = \\frac{1}{2}\\boldsymbol{s}^{\\text{tr}}:\\boldsymbol{s}^{\\text{tr}}$ 为：\n$$\nJ_{2}^{\\text{tr}} = \\frac{1}{2}\\left( (200)^2 + (-100)^2 + (-100)^2 \\right) = \\frac{1}{2}(40000 + 10000 + 10000) = 30000\\,(\\text{MPa})^2\n$$\n试探 von Mises 等效应力为：\n$$\n\\sigma_{\\text{eq}}^{\\text{tr}} = \\sqrt{3J_{2}^{\\text{tr}}} = \\sqrt{3 \\times 30000}\\, \\text{MPa} = \\sqrt{90000}\\,\\text{MPa} = 300\\,\\text{MPa}\n$$\n屈服检查确认发生了塑性加载：$\\sigma_{\\text{eq}}^{\\text{tr}} = 300\\,\\text{MPa} > \\sigma_y = 250\\,\\text{MPa}$。\n\n最后，我们计算 $\\Delta\\gamma$：\n$$\n\\Delta\\gamma = \\frac{\\sigma_{\\text{eq}}^{\\text{tr}} - \\sigma_y}{3\\mu + H} = \\frac{300\\,\\text{MPa} - 250\\,\\text{MPa}}{3(30000\\,\\text{MPa}) + 10000\\,\\text{MPa}} = \\frac{50}{90000 + 10000} = \\frac{50}{100000} = 0.0005\n$$\n塑性乘子增量 $\\Delta\\gamma$ 是一个无量纲量。问题要求将答案四舍五入到四位有效数字。精确结果 $0.0005$ 用四位有效数字表示为 $5.000 \\times 10^{-4}$。", "answer": "$$\n\\boxed{5.000 \\times 10^{-4}}\n$$", "id": "2559758"}, {"introduction": "许多岩土材料（如土壤和混凝土）的力学行为不仅与剪切应力有关，还对静水压力敏感，并且其塑性流动方向通常与屈服面法线不一致。本练习引入了能够描述此类现象的非关联 Drucker-Prager 模型，其核心特征是塑性势函数 $g$ 与屈服函数 $f$ 不同 [@problem_id:2559771]。你将通过计算，亲身体验非关联流动法则如何导致塑性体积应变（即剪胀），这是理解土力学和岩石力学中材料行为的关键一步。", "problem": "在一个使用非关联 Drucker–Prager 模型的弹塑性材料的有限元法 (FEM) 实现中，考虑一个承受三轴压缩应力状态的高斯点，其主应力与材料轴方向一致。围压（径向）应力为 $\\sigma_{1}=\\sigma_{2}=100\\ \\text{kPa}$，轴向应力为 $\\sigma_{3}=300\\ \\text{kPa}$。平均压力定义为 $p=\\tfrac{1}{3}\\operatorname{tr}\\boldsymbol{\\sigma}$，第二偏应力不变量定义为 $J_{2}=\\tfrac{1}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}$，其中 $\\boldsymbol{s}=\\boldsymbol{\\sigma}-p\\,\\boldsymbol{I}$。\n\n屈服函数由 $f(\\boldsymbol{\\sigma})=\\sqrt{J_{2}}+\\alpha\\,p-k$ 给出，其中 $\\alpha=0.250$ 且 $k=120\\ \\text{kPa}$。塑性势不同（非关联），由 $g(\\boldsymbol{\\sigma})=\\sqrt{J_{2}}+\\beta\\,p$ 给出，其中 $\\beta=0.150$。塑性流动法则为 $\\Delta\\boldsymbol{\\varepsilon}^{p}=\\Delta\\lambda\\,\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}}$，其中 $\\Delta\\lambda>0$ 是此荷载步的算法一致性条件返回的塑性乘子增量。对于此高斯点和增量步，计算出的塑性乘子为 $\\Delta\\lambda=2.500\\times 10^{-4}$（无量纲）。\n\n仅使用基于不变量的塑性理论和张量微积分的第一性原理，推导塑性应变增量的体积分量，其定义为 $\\Delta\\varepsilon^{p}_{v}=\\operatorname{tr}\\left(\\Delta\\boldsymbol{\\varepsilon}^{p}\\right)$，并根据给定数据进行数值计算。将最终答案表示为一个无量纲数，并四舍五入至四位有效数字。", "solution": "首先验证该问题，以确保其具有科学依据、自洽且提法得当。已知条件如下：\n-   主应力：$\\sigma_{1}=\\sigma_{2}=100\\ \\text{kPa}$，$\\sigma_{3}=300\\ \\text{kPa}$。\n-   平均压力：$p=\\tfrac{1}{3}\\operatorname{tr}\\boldsymbol{\\sigma} = \\tfrac{1}{3}(\\sigma_{1}+\\sigma_{2}+\\sigma_{3})$。\n-   第二偏应力不变量：$J_{2}=\\tfrac{1}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}$，其中 $\\boldsymbol{s}=\\boldsymbol{\\sigma}-p\\,\\boldsymbol{I}$。\n-   屈服函数：$f(\\boldsymbol{\\sigma})=\\sqrt{J_{2}}+\\alpha\\,p-k$，其中 $\\alpha=0.250$ 且 $k=120\\ \\text{kPa}$。\n-   塑性势：$g(\\boldsymbol{\\sigma})=\\sqrt{J_{2}}+\\beta\\,p$，其中 $\\beta=0.150$。\n-   塑性流动法则：$\\Delta\\boldsymbol{\\varepsilon}^{p}=\\Delta\\lambda\\,\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}}$。\n-   塑性乘子增量：$\\Delta\\lambda=2.500\\times 10^{-4}$。\n-   待求量：塑性应变增量的体积分量，$\\Delta\\varepsilon^{p}_{v}=\\operatorname{tr}\\left(\\Delta\\boldsymbol{\\varepsilon}^{p}\\right)$。\n\n该问题是非关联弹塑性力学中的一个标准练习，基于连续介质力学的既定原理。所有必要的参数都已给出，且该状态与塑性屈服一致。因此，该问题是有效的。\n\n目标是推导塑性应变增量的体积分量 $\\Delta\\varepsilon^{p}_{v}$ 的表达式。根据定义，这是塑性应变增量张量 $\\Delta\\boldsymbol{\\varepsilon}^{p}$ 的迹。\n$$\n\\Delta\\varepsilon^{p}_{v} = \\operatorname{tr}\\left(\\Delta\\boldsymbol{\\varepsilon}^{p}\\right)\n$$\n代入给定的塑性流动法则 $\\Delta\\boldsymbol{\\varepsilon}^{p}=\\Delta\\lambda\\,\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}}$，我们得到：\n$$\n\\Delta\\varepsilon^{p}_{v} = \\operatorname{tr}\\left(\\Delta\\lambda\\,\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\right)\n$$\n由于塑性乘子 $\\Delta\\lambda$ 是一个标量，可以将其从迹算子中提出：\n$$\n\\Delta\\varepsilon^{p}_{v} = \\Delta\\lambda\\,\\operatorname{tr}\\left(\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\right)\n$$\n问题的核心是计算塑性势梯度 $\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}}$ 的迹。塑性势函数为 $g(\\boldsymbol{\\sigma})=\\sqrt{J_{2}}+\\beta\\,p$。我们必须对该函数关于应力张量 $\\boldsymbol{\\sigma}$ 求导。\n根据求导的加法法则：\n$$\n\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}} = \\dfrac{\\partial}{\\partial\\boldsymbol{\\sigma}}\\left(\\sqrt{J_{2}}\\right) + \\dfrac{\\partial}{\\partial\\boldsymbol{\\sigma}}\\left(\\beta\\,p\\right)\n$$\n我们分别计算每一项。\n\n对于第一项，我们应用链式法则：\n$$\n\\dfrac{\\partial \\left(\\sqrt{J_{2}}\\right)}{\\partial\\boldsymbol{\\sigma}} = \\dfrac{d\\left(\\sqrt{J_{2}}\\right)}{dJ_{2}} \\dfrac{\\partial J_{2}}{\\partial\\boldsymbol{\\sigma}} = \\frac{1}{2\\sqrt{J_{2}}}\\dfrac{\\partial J_{2}}{\\partial\\boldsymbol{\\sigma}}\n$$\n为了继续推导，我们必须求第二偏应力不变量 $J_{2}=\\tfrac{1}{2}\\boldsymbol{s}:\\boldsymbol{s}$ 关于 $\\boldsymbol{\\sigma}$ 的导数。偏应力张量 $\\boldsymbol{s}$ 定义为 $\\boldsymbol{s}=\\boldsymbol{\\sigma}-p\\,\\boldsymbol{I}$，其中 $p=\\tfrac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})$。连续介质力学中的一个基本恒等式是：\n$$\n\\dfrac{\\partial J_{2}}{\\partial\\boldsymbol{\\sigma}} = \\boldsymbol{s}\n$$\n因此，梯度的第一项是：\n$$\n\\dfrac{\\partial \\left(\\sqrt{J_{2}}\\right)}{\\partial\\boldsymbol{\\sigma}} = \\frac{1}{2\\sqrt{J_{2}}}\\boldsymbol{s}\n$$\n对于第二项 $\\dfrac{\\partial}{\\partial\\boldsymbol{\\sigma}}\\left(\\beta\\,p\\right)$，我们注意到 $\\beta$ 是一个常数：\n$$\n\\dfrac{\\partial}{\\partial\\boldsymbol{\\sigma}}\\left(\\beta\\,p\\right) = \\beta\\,\\dfrac{\\partial p}{\\partial\\boldsymbol{\\sigma}}\n$$\n我们将平均压力 $p=\\tfrac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})=\\tfrac{1}{3}\\sigma_{kk}$ 对 $\\boldsymbol{\\sigma}$ 求导。用分量形式表示，该导数为 $\\frac{\\partial p}{\\partial \\sigma_{ij}} = \\frac{1}{3}\\frac{\\partial \\sigma_{kk}}{\\partial \\sigma_{ij}} = \\frac{1}{3}\\delta_{ij}$。用直接张量表示法，这给出了另一个基本恒等式：\n$$\n\\dfrac{\\partial p}{\\partial\\boldsymbol{\\sigma}} = \\frac{1}{3}\\boldsymbol{I}\n$$\n其中 $\\boldsymbol{I}$ 是二阶单位张量。因此，梯度的第二项是：\n$$\n\\dfrac{\\partial}{\\partial\\boldsymbol{\\sigma}}\\left(\\beta\\,p\\right) = \\frac{\\beta}{3}\\boldsymbol{I}\n$$\n结合两项，我们得到塑性势的完整梯度：\n$$\n\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}} = \\frac{1}{2\\sqrt{J_{2}}}\\boldsymbol{s} + \\frac{\\beta}{3}\\boldsymbol{I}\n$$\n现在，我们计算这个张量表达式的迹：\n$$\n\\operatorname{tr}\\left(\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\right) = \\operatorname{tr}\\left(\\frac{1}{2\\sqrt{J_{2}}}\\boldsymbol{s} + \\frac{\\beta}{3}\\boldsymbol{I}\\right)\n$$\n利用迹算子的线性性质：\n$$\n\\operatorname{tr}\\left(\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\right) = \\frac{1}{2\\sqrt{J_{2}}}\\operatorname{tr}(\\boldsymbol{s}) + \\frac{\\beta}{3}\\operatorname{tr}(\\boldsymbol{I})\n$$\n根据定义，偏应力张量 $\\boldsymbol{s}$ 是无迹的，所以 $\\operatorname{tr}(\\boldsymbol{s}) = 0$。三维空间中单位张量的迹是 $\\operatorname{tr}(\\boldsymbol{I}) = 3$。代入这些值：\n$$\n\\operatorname{tr}\\left(\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\right) = \\frac{1}{2\\sqrt{J_{2}}}(0) + \\frac{\\beta}{3}(3) = \\beta\n$$\n这个推导表明，塑性势梯度的迹就是剪胀参数 $\\beta$。因此，塑性体积应变增量与应力状态无关，这是该模型的一个关键特征。\n\n将此结果代回 $\\Delta\\varepsilon^{p}_{v}$ 的表达式：\n$$\n\\Delta\\varepsilon^{p}_{v} = \\Delta\\lambda \\cdot \\beta\n$$\n我们已知数值 $\\Delta\\lambda = 2.500 \\times 10^{-4}$ 和 $\\beta=0.150$。现在我们进行最终计算。\n$$\n\\Delta\\varepsilon^{p}_{v} = (2.500 \\times 10^{-4}) \\times 0.150\n$$\n$$\n\\Delta\\varepsilon^{p}_{v} = (2.500 \\times 10^{-4}) \\times (1.50 \\times 10^{-1})\n$$\n$$\n\\Delta\\varepsilon^{p}_{v} = 3.75 \\times 10^{-5}\n$$\n题目要求答案四舍五入到四位有效数字。\n$$\n\\Delta\\varepsilon^{p}_{v} = 3.750 \\times 10^{-5}\n$$\n这就是塑性应变增量体积分量的最终数值。", "answer": "$$\\boxed{3.750 \\times 10^{-5}}$$", "id": "2559771"}, {"introduction": "将理论模型转化为可执行的计算机代码，是有限元方法实践的精髓所在。本练习要求你将前述的非关联 Drucker-Prager 模型的返回映射算法付诸实践，编写一个完整的程序 [@problem_id:2559759]。通过处理一系列包含不同工况的测试案例，你将加深对弹塑性本构积分算法鲁棒性和准确性的理解，并为在实际有限元程序中开发和应用高级材料模型打下坚实基础。", "problem": "实现一个用于非关联 Drucker–Prager 模型的后向欧拉返回映射算法，在轴对称三轴压缩运动学条件下，计算单个应变增量下的体积塑性应变增量。对应力和应变采用压为正的符号约定。本构响应为线性弹性-理想塑性，具有各向同性弹性和非关联流动法则。\n\n从以下基本和核心定义开始：\n- 无穷小应变增量可加性地分解为弹性和塑性部分，$\\mathrm{d}\\boldsymbol{\\varepsilon} = \\mathrm{d}\\boldsymbol{\\varepsilon}^{\\mathrm{e}} + \\mathrm{d}\\boldsymbol{\\varepsilon}^{\\mathrm{p}}$。\n- 线性各向同性弹性：$\\mathrm{d}\\boldsymbol{\\sigma} = \\mathbb{C}:\\mathrm{d}\\boldsymbol{\\varepsilon}^{\\mathrm{e}}$，其中 $\\mathbb{C}$ 是由体积模量 $K$ 和剪切模量 $G$ 表征的四阶弹性张量。\n- Cauchy 应力平均压力为 $p = \\tfrac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})$，偏应力为 $\\mathbf{s} = \\boldsymbol{\\sigma} - p \\mathbf{I}$，其中 $\\mathbf{I}$ 是单位张量。\n- 偏应力第二不变量为 $J_2 = \\tfrac{1}{2}\\mathbf{s}:\\mathbf{s}$，所谓的 $q$-不变量为 $q = \\sqrt{3J_2}$。\n- Drucker–Prager 屈服函数为 $f(\\boldsymbol{\\sigma}) = q + \\alpha p - k$，其中材料参数 $\\alpha \\ge 0$ 和 $k \\ge 0$。\n- 非关联塑性势函数为 $g(\\boldsymbol{\\sigma}) = q + \\alpha_{\\psi} p$，其中剪胀参数 $\\alpha_{\\psi} \\ge 0$。\n- 塑性流动法则为 $\\mathrm{d}\\boldsymbol{\\varepsilon}^{\\mathrm{p}} = \\mathrm{d}\\lambda \\, \\dfrac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$，其中塑性乘子 $\\mathrm{d}\\lambda \\ge 0$，且塑性加载步结束时的一致性条件为 $f(\\boldsymbol{\\sigma}) = 0$。\n\n您必须根据这些定义和单个应变增量下的后向欧拉（隐式）积分方案，推导出塑性乘子增量 $\\Delta\\lambda$ 和体积塑性应变增量 $\\Delta \\varepsilon_v^{\\mathrm{p}} = \\operatorname{tr}(\\Delta \\boldsymbol{\\varepsilon}^{\\mathrm{p}})$ 的闭式表达式，该表达式应以弹性试探不变量 $p^{\\mathrm{tr}}$ 和 $q^{\\mathrm{tr}}$、弹性模量 $K$ 和 $G$ 以及 Drucker–Prager 参数 $\\alpha$、$\\alpha_{\\psi}$ 和 $k$ 表示。\n\n假设应变增量满足轴对称三轴压缩运动学，因此应变增量张量为对角张量，其分量为 $\\Delta\\boldsymbol{\\varepsilon} = \\operatorname{diag}(\\Delta\\varepsilon_a, \\Delta\\varepsilon_r, \\Delta\\varepsilon_r)$，其中 $\\Delta\\varepsilon_a$ 是轴向分量，$\\Delta\\varepsilon_r$ 是相等的径向分量。在这些运动学条件下，从弹性预测（试探状态）开始，并且仅当试探状态违反屈服条件时才使用返回映射。您可以使用以下两个不变量关系，它们可以从上述定义和轴对称对角结构中推导得出：\n- 试探压力为 $p^{\\mathrm{tr}} = K(\\Delta\\varepsilon_a + 2\\Delta\\varepsilon_r)$。\n- 试探 $q$-不变量为 $q^{\\mathrm{tr}} = 2G\\,|\\Delta\\varepsilon_a - \\Delta\\varepsilon_r|$。\n\n您的程序必须为每个测试用例实现以下逻辑：\n- 计算 $p^{\\mathrm{tr}}$、$q^{\\mathrm{tr}}$ 和 $f^{\\mathrm{tr}} = q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k$。\n- 如果 $f^{\\mathrm{tr}} \\le 0$，则该步为弹性步，且 $\\Delta \\varepsilon_v^{\\mathrm{p}} = 0$。\n- 如果 $f^{\\mathrm{tr}} > 0$，则执行与非关联流动法则和 Drucker–Prager 屈服面一致的后向欧拉返回映射，以获得 $\\Delta \\varepsilon_v^{\\mathrm{p}}$。\n\n科学和数值细节：\n- 所有应变均为无量纲，应力和模量共享一致的单位，但由于所要求的输出是无量纲的 $\\Delta \\varepsilon_v^{\\mathrm{p}}$，因此无需报告单位。\n- 不涉及角度。\n- 不应出现百分比；任何分数都必须表示为小数。\n\n测试套件：\n提供以下五组参数集以测试实现。每个测试用例是一个元组 $(K,G,\\alpha,\\alpha_{\\psi},k,\\Delta\\varepsilon_a,\\Delta\\varepsilon_r)$，您的程序必须按给定顺序生成包含五个结果的列表。\n1. $(10000, 5000, 0.2, 0.05, 150, 0.0005, 0.0)$ 弹性区域检查。\n2. $(1000, 1000, 0.5, 0.1, 23, 0.01, 0.002)$ 恰好在屈服边界上的情况。\n3. $(8000, 6000, 0.2, 0.1, 20, 0.005, 0.001)$ 考虑剪胀的塑性修正。\n4. $(10000, 5000, 0.3, 0.0, 12, 0.003, 0.0)$ 零剪胀的塑性修正。\n5. $(5000, 2000, 0.5, 0.2, 10, 0.002, 0.002)$ 零偏应力试探状态下的静水压力驱动塑性。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的浮点数列表（例如，“[0.0,0.0,0.12345,0.0,0.6789]”）。每个条目必须是按上文所列顺序为相应测试用例计算出的 $\\Delta \\varepsilon_v^{\\mathrm{p}}$。", "solution": "我们采用压为正的符号约定。本构框架由加性分解 $\\mathrm{d}\\boldsymbol{\\varepsilon} = \\mathrm{d}\\boldsymbol{\\varepsilon}^{\\mathrm{e}} + \\mathrm{d}\\boldsymbol{\\varepsilon}^{\\mathrm{p}}$ 和线性各向同性弹性 $\\mathrm{d}\\boldsymbol{\\sigma} = \\mathbb{C}:\\mathrm{d}\\boldsymbol{\\varepsilon}^{\\mathrm{e}}$ 定义。Drucker–Prager 屈服函数和非关联势函数分别为 $f = q + \\alpha p - k$ 和 $g = q + \\alpha_{\\psi} p$。塑性流动法则为 $\\mathrm{d}\\boldsymbol{\\varepsilon}^{\\mathrm{p}} = \\mathrm{d}\\lambda \\,\\partial g/\\partial \\boldsymbol{\\sigma}$，其中 $\\mathrm{d}\\lambda \\ge 0$。\n\n不变量为 $p = \\tfrac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})$ 和 $q = \\sqrt{3J_2}$，其中 $J_2 = \\tfrac{1}{2}\\mathbf{s}:\\mathbf{s}$ 且 $\\mathbf{s} = \\boldsymbol{\\sigma} - p\\mathbf{I}$。作用于体积和偏量方向的弹性张量满足 $\\mathbb{C}:\\left(\\tfrac{1}{3}\\mathbf{I}\\right) = K \\mathbf{I}$ 和 $\\mathbb{C}:\\mathbf{X}^{\\mathrm{dev}} = 2G\\,\\mathbf{X}^{\\mathrm{dev}}$（对于任何偏张量 $\\mathbf{X}^{\\mathrm{dev}}$）。\n\n单步后向欧拉积分通过弹性预测，必要时再进行塑性修正。给定轴对称三轴运动学下的应变增量 $\\Delta\\boldsymbol{\\varepsilon} = \\operatorname{diag}(\\Delta\\varepsilon_a,\\Delta\\varepsilon_r,\\Delta\\varepsilon_r)$，试探不变量可从弹性定律得出：\n- 体积应变增量为 $\\Delta\\varepsilon_v = \\Delta\\varepsilon_a + 2\\Delta\\varepsilon_r$，因此试探压力为 $p^{\\mathrm{tr}} = K\\,\\Delta\\varepsilon_v = K(\\Delta\\varepsilon_a + 2\\Delta\\varepsilon_r)$。\n- 偏应变增量的主值为 $\\Delta\\varepsilon_a - \\tfrac{1}{3}\\Delta\\varepsilon_v = \\tfrac{2}{3}(\\Delta\\varepsilon_a - \\Delta\\varepsilon_r)$ 和 $\\Delta\\varepsilon_r - \\tfrac{1}{3}\\Delta\\varepsilon_v = -\\tfrac{1}{3}(\\Delta\\varepsilon_a - \\Delta\\varepsilon_r)$（重数为 2）。相应的试探偏应力为 $\\mathbf{s}^{\\mathrm{tr}} = 2G\\,\\operatorname{dev}(\\Delta\\boldsymbol{\\varepsilon})$，通过直接计算 $q = \\sqrt{3J_2}$ 得到不变量 $q^{\\mathrm{tr}} = 2G\\,|\\Delta\\varepsilon_a - \\Delta\\varepsilon_r|$。\n\n试探屈服值为 $f^{\\mathrm{tr}} = q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k$。如果 $f^{\\mathrm{tr}} \\le 0$，则该步为弹性步，塑性量为零，导致 $\\Delta \\varepsilon_v^{\\mathrm{p}} = 0$。\n\n如果 $f^{\\mathrm{tr}} > 0$，我们执行塑性修正。以后向欧拉形式，更新后的应力为\n$$\n\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\mathbb{C}:\\Delta\\boldsymbol{\\varepsilon}^{\\mathrm{p}} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\Delta\\lambda\\, \\mathbb{C}:\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}.\n$$\n我们需要计算 $\\partial g / \\partial \\boldsymbol{\\sigma}$。由于 $g = q + \\alpha_{\\psi} p$，并使用标准的不变量导数，\n$$\n\\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2q}\\,\\mathbf{s}, \\qquad \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = \\frac{1}{3}\\mathbf{I},\n$$\n我们得到\n$$\n\\mathbf{N} := \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2q}\\,\\mathbf{s} + \\frac{\\alpha_{\\psi}}{3}\\mathbf{I}.\n$$\n应用弹性张量，\n$$\n\\mathbb{C}:\\mathbf{N} = 2G\\left(\\frac{3}{2q}\\,\\mathbf{s}\\right) + K\\left(\\frac{\\alpha_{\\psi}}{3}\\mathbf{I}\\right)\\cdot 3 = \\frac{3G}{q}\\,\\mathbf{s} + K \\alpha_{\\psi}\\,\\mathbf{I}.\n$$\n将后向欧拉更新分解为偏量和体量部分，可得\n$$\n\\mathbf{s} = \\mathbf{s}^{\\mathrm{tr}} - \\Delta\\lambda\\,\\frac{3G}{q}\\,\\mathbf{s}, \\qquad p = p^{\\mathrm{tr}} - \\Delta\\lambda\\,K\\alpha_{\\psi}.\n$$\n在此各向同性设置中，由于 $\\mathbf{s}$ 和 $\\mathbf{s}^{\\mathrm{tr}}$ 是共轴的，它们在修正过程中保持共线，因此偏量更新可简化为对 $q$ 的标量更新：\n$$\n\\mathbf{s} = \\beta\\,\\mathbf{s}^{\\mathrm{tr}} \\quad \\Rightarrow \\quad q = \\beta\\,q^{\\mathrm{tr}}.\n$$\n代入偏量方程，\n$$\n\\beta\\,\\mathbf{s}^{\\mathrm{tr}} = \\mathbf{s}^{\\mathrm{tr}} - \\Delta\\lambda\\,\\frac{3G}{q}\\,\\beta\\,\\mathbf{s}^{\\mathrm{tr}} \\quad \\Rightarrow \\quad \\beta = 1 - \\Delta\\lambda\\,\\frac{3G}{q^{\\mathrm{tr}}}.\n$$\n因此，\n$$\nq = \\beta q^{\\mathrm{tr}} = q^{\\mathrm{tr}} - 3G\\,\\Delta\\lambda, \\qquad p = p^{\\mathrm{tr}} - K\\alpha_{\\psi}\\,\\Delta\\lambda.\n$$\n施加步末的一致性条件，\n$$\n0 = f(\\boldsymbol{\\sigma}) = q + \\alpha p - k = \\left(q^{\\mathrm{tr}} - 3G\\,\\Delta\\lambda\\right) + \\alpha\\left(p^{\\mathrm{tr}} - K\\alpha_{\\psi}\\,\\Delta\\lambda\\right) - k.\n$$\n求解塑性乘子增量，\n$$\n\\Delta\\lambda = \\frac{q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k}{3G + \\alpha K \\alpha_{\\psi}}.\n$$\n最后，体积塑性应变增量为\n$$\n\\Delta \\varepsilon_v^{\\mathrm{p}} = \\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}^{\\mathrm{p}}) = \\Delta\\lambda\\,\\operatorname{tr}\\left(\\frac{3}{2q}\\,\\mathbf{s} + \\frac{\\alpha_{\\psi}}{3}\\mathbf{I}\\right) = \\Delta\\lambda\\,\\alpha_{\\psi},\n$$\n因为 $\\operatorname{tr}(\\mathbf{s}) = 0$ 且 $\\operatorname{tr}(\\mathbf{I}) = 3$。\n\n每个测试用例的算法摘要：\n1. 计算 $p^{\\mathrm{tr}} = K(\\Delta\\varepsilon_a + 2\\Delta\\varepsilon_r)$ 和 $q^{\\mathrm{tr}} = 2G\\,|\\Delta\\varepsilon_a - \\Delta\\varepsilon_r|$。\n2. 计算 $f^{\\mathrm{tr}} = q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k$。\n3. 如果 $f^{\\mathrm{tr}} \\le 0$，则设置 $\\Delta \\varepsilon_v^{\\mathrm{p}} = 0$。\n4. 如果 $f^{\\mathrm{tr}} > 0$，则计算 $\\Delta\\lambda = \\dfrac{f^{\\mathrm{tr}}}{3G + \\alpha K \\alpha_{\\psi}}$，然后计算 $\\Delta \\varepsilon_v^{\\mathrm{p}} = \\alpha_{\\psi}\\,\\Delta\\lambda$。\n\n将此算法应用于所提供的测试套件，对每个用例都会产生一个标量 $\\Delta \\varepsilon_v^{\\mathrm{p}}$（无量纲）。程序应按规定顺序计算这些值，并在一行内以方括号括起来的逗号分隔列表形式打印它们。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_delta_eps_v_p(K, G, alpha, alpha_psi, k, eps_a, eps_r):\n    # Trial invariants under axisymmetric diagonal strain increment\n    p_tr = K * (eps_a + 2.0 * eps_r)\n    q_tr = 2.0 * G * abs(eps_a - eps_r)\n    f_tr = q_tr + alpha * p_tr - k\n\n    if f_tr <= 0.0:\n        return 0.0\n    # Denominator of the plastic multiplier for non-associated DP\n    denom = 3.0 * G + alpha * K * alpha_psi\n    # Guard against pathological zero denominator\n    if denom <= 0.0:\n        # If denom is zero or negative (non-physical in this context), return 0.0 safely.\n        return 0.0\n    dlam = f_tr / denom\n    # Volumetric plastic strain increment\n    delta_eps_v_p = alpha_psi * dlam\n    return delta_eps_v_p\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (K, G, alpha, alpha_psi, k, eps_a, eps_r)\n    test_cases = [\n        (10000.0, 5000.0, 0.2, 0.05, 150.0, 0.0005, 0.0),      # Elastic regime\n        (1000.0, 1000.0, 0.5, 0.1, 23.0, 0.01, 0.002),         # At yield boundary\n        (8000.0, 6000.0, 0.2, 0.1, 20.0, 0.005, 0.001),        # Plastic with dilatancy\n        (10000.0, 5000.0, 0.3, 0.0, 12.0, 0.003, 0.0),         # Plastic with zero dilatancy\n        (5000.0, 2000.0, 0.5, 0.2, 10.0, 0.002, 0.002),        # Hydrostatic-driven plasticity\n    ]\n\n    results = []\n    for case in test_cases:\n        K, G, alpha, alpha_psi, k, eps_a, eps_r = case\n        result = compute_delta_eps_v_p(K, G, alpha, alpha_psi, k, eps_a, eps_r)\n        # Convert very small negative zeros to 0.0 for clean output\n        if abs(result) < 1e-18:\n            result = 0.0\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(lambda x: repr(float(x)), results))}]\")\n\nsolve()\n```", "id": "2559759"}]}