{"hands_on_practices": [{"introduction": "在深入研究复杂的数值代码之前，理解核心正则化方程的数学行为至关重要。本练习聚焦于一维亥姆霍兹方程，它是许多隐式梯度模型的基石。通过使用格林函数解析求解该方程，我们可以直接洞察内部长度尺度 $\\ell$ 如何平滑尖锐的应变分布，将一个局部化的输入转化为一个扩散的、正则化的输出 [@problem_id:2593442]。", "problem": "在有限元法（FEM）中应变局部化的隐式梯度正则化背景下，考虑在无限直线上由线性Helmholtz型方程定义的一维非局部等效应变场 $\\bar{\\varepsilon}(x)$：\n$$\n\\left(1-\\ell^{2}\\frac{d^{2}}{dx^{2}}\\right)\\bar{\\varepsilon}(x)=\\varepsilon_{\\mathrm{eq}}(x),\n$$\n其中 $\\ell>0$ 是一个材料内禀长度尺度，$\\varepsilon_{\\mathrm{eq}}(x)$ 是一个当 $|x|\\to\\infty$ 时消失的局部化、平方可积源。假设与物理相关的解 $\\bar{\\varepsilon}(x)$ 是有界的，并且当 $|x|\\to\\infty$ 时衰减得足够快。\n\n从线性、平移不变常微分方程的线性算子和格林函数的定义出发，并仅使用狄拉克分布和分部积分的基本性质，执行以下操作：\n\n- 推导算子 $1-\\ell^{2}d^{2}/dx^{2}$ 在 $\\mathbb{R}$ 上且在无穷远处衰减的格林函数 $G_{\\ell}(x)$，并证明非局部场是空间卷积\n$$\n\\bar{\\varepsilon}(x)=\\int_{-\\infty}^{\\infty} G_{\\ell}(x-\\xi)\\,\\varepsilon_{\\mathrm{eq}}(\\xi)\\,d\\xi.\n$$\n\n- 然后，对于特定的局部化载荷\n$$\n\\varepsilon_{\\mathrm{eq}}(x)=\\begin{cases}\n\\varepsilon_{0}, & |x|\\le a,\\\\\n0, & |x|>a,\n\\end{cases}\n$$\n其中 $\\varepsilon_{0}>0$ 且 $a>0$，计算中心点处正则化应变的闭式解值，\n$$\n\\bar{\\varepsilon}(0).\n$$\n\n你的最终答案必须是关于 $\\varepsilon_{0}$、$a$ 和 $\\ell$ 的单个闭式解析表达式。不需要数值近似，也不应报告单位，因为应变是无量纲的。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 控制微分方程为 $\\left(1-\\ell^{2}\\frac{d^{2}}{dx^{2}}\\right)\\bar{\\varepsilon}(x)=\\varepsilon_{\\mathrm{eq}}(x)$。\n- 定义域为无限直线，$x \\in \\mathbb{R}$。\n- 参数 $\\ell > 0$ 是一个材料内禀长度尺度。\n- 函数 $\\varepsilon_{\\mathrm{eq}}(x)$ 是一个当 $|x|\\to\\infty$ 时消失的局部化、平方可积源项。\n- 解 $\\bar{\\varepsilon}(x)$ 是有界的，并且当 $|x|\\to\\infty$ 时衰减得足够快。\n- 任务是推导算子 $1-\\ell^{2}d^{2}/dx^{2}$ 的格林函数 $G_{\\ell}(x)$，并证明解是一个卷积。\n- 对于一个特定的源项 $\\varepsilon_{\\mathrm{eq}}(x)=\\begin{cases} \\varepsilon_{0}, & |x|\\le a, \\\\ 0, & |x|>a, \\end{cases}$，其中常数 $\\varepsilon_{0}>0$ 且 $a>0$，必须计算 $\\bar{\\varepsilon}(0)$ 的值。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学基础性**：该问题在科学上是合理的。Helmholtz方程是一个标准的、成熟的模型，用于固体力学和有限元法中应变局部化的正则化。\n- **适定性**：该问题是适定的。它包含一个具有常系数的线性、二阶常微分方程和在无穷远处指定的边界条件。对于一个平方可积的源项，可以预期存在一个唯一的、稳定的、衰减的解，并且可以用格林函数构造。\n- **客观性**：该问题使用精确的数学语言表述，没有任何主观或模棱两可的陈述。\n- **完整性**：所有必要的信息，包括微分算子、定义域、边界条件以及用于最终计算的特定源项，均已提供。\n\n**步骤3：结论与行动**\n该问题被认为是有效的。这是一个数学物理和工程科学中标准的、自洽的、适定的问题。将提供解答。\n\n线性、平移不变算子 $L = 1 - \\ell^2 \\frac{d^2}{dx^2}$ 的格林函数 $G_{\\ell}(x)$ 由以下分布微分方程定义：\n$$L G_{\\ell}(x) = \\left(1-\\ell^{2}\\frac{d^{2}}{dx^{2}}\\right)G_{\\ell}(x)=\\delta(x)$$\n其中 $\\delta(x)$ 是狄拉克δ分布。边界条件要求当 $|x| \\to \\infty$ 时，$G_{\\ell}(x) \\to 0$。\n\n对于 $x \\neq 0$，方程是齐次的：\n$$G_{\\ell}(x) - \\ell^2 \\frac{d^2G_{\\ell}}{dx^2}(x) = 0$$\n特征方程为 $1 - \\ell^2 r^2 = 0$，其根为 $r = \\pm \\frac{1}{\\ell}$。对于 $x \\neq 0$ 的通解是指数函数的线性组合：\n$$G_{\\ell}(x) = c_1 \\exp\\left(\\frac{x}{\\ell}\\right) + c_2 \\exp\\left(-\\frac{x}{\\ell}\\right)$$\n应用边界条件当 $|x| \\to \\infty$ 时 $G_{\\ell}(x) \\to 0$ 来约束解。\n对于 $x>0$，为确保当 $x \\to \\infty$ 时解衰减，必须有 $c_1=0$。因此，对于某个常数 $A$，$G_{\\ell}(x) = A \\exp\\left(-\\frac{x}{\\ell}\\right)$。\n对于 $x<0$，为确保当 $x \\to -\\infty$ 时解衰减，必须有 $c_2=0$。因此，对于某个常数 $B$，$G_{\\ell}(x) = B \\exp\\left(\\frac{x}{\\ell}\\right)$。\n这可以使用绝对值紧凑地写为 $G_{\\ell}(x) = C \\exp\\left(-\\frac{|x|}{\\ell}\\right)$，其中 $C$ 是某个常数。这种形式满足格林函数在 $x=0$ 处的连续性。\n\n为了确定常数 $C$，我们将 $G_{\\ell}(x)$ 的定义方程在 $x=0$ 附近的一个无穷小区间 $[-\\eta, \\eta]$ 上积分：\n$$\\int_{-\\eta}^{\\eta} \\left(G_{\\ell}(x) - \\ell^2 \\frac{d^2G_{\\ell}}{dx^2}(x)\\right) dx = \\int_{-\\eta}^{\\eta} \\delta(x) dx = 1$$\n当 $\\eta \\to 0$ 时，连续函数 $G_{\\ell}(x)$ 的积分消失：$\\lim_{\\eta\\to 0} \\int_{-\\eta}^{\\eta} G_{\\ell}(x) dx = 0$。\n二阶导数项的积分产生一阶导数的跳跃：\n$$-\\ell^2 \\int_{-\\eta}^{\\eta} \\frac{d^2G_{\\ell}}{dx^2}(x) dx = -\\ell^2 \\left[ \\frac{dG_{\\ell}}{dx} \\right]_{-\\eta}^{\\eta} = -\\ell^2 \\left( \\frac{dG_{\\ell}}{dx}(0^+) - \\frac{dG_{\\ell}}{dx}(0^-) \\right)$$\n因此，我们得到跳跃条件：\n$$-\\ell^2 \\left( \\frac{dG_{\\ell}}{dx}(0^+) - \\frac{dG_{\\ell}}{dx}(0^-) \\right) = 1$$\n$G_{\\ell}(x) = C \\exp\\left(-\\frac{|x|}{\\ell}\\right)$ 的导数是：\n对于 $x>0$：$\\frac{dG_{\\ell}}{dx} = -\\frac{C}{\\ell} \\exp\\left(-\\frac{x}{\\ell}\\right) \\implies \\frac{dG_{\\ell}}{dx}(0^+) = -\\frac{C}{\\ell}$。\n对于 $x<0$：$\\frac{dG_{\\ell}}{dx} = \\frac{C}{\\ell} \\exp\\left(\\frac{x}{\\ell}\\right) \\implies \\frac{dG_{\\ell}}{dx}(0^-) = \\frac{C}{\\ell}$。\n将这些代入跳跃条件：\n$$-\\ell^2 \\left( -\\frac{C}{\\ell} - \\frac{C}{\\ell} \\right) = -\\ell^2 \\left( -\\frac{2C}{\\ell} \\right) = 2C\\ell = 1$$\n这给出 $C = \\frac{1}{2\\ell}$。因此，格林函数为：\n$$G_{\\ell}(x) = \\frac{1}{2\\ell} \\exp\\left(-\\frac{|x|}{\\ell}\\right)$$\n由于算子 $L$ 是线性和平移不变的，方程 $L\\bar{\\varepsilon}(x) = \\varepsilon_{\\mathrm{eq}}(x)$ 的解由源项与格林函数的卷积给出。令 $u(x) = \\int_{-\\infty}^{\\infty} G_{\\ell}(x-\\xi) \\varepsilon_{\\mathrm{eq}}(\\xi) d\\xi$。将 $L$ 应用于 $u(x)$：\n$$L u(x) = L \\int_{-\\infty}^{\\infty} G_{\\ell}(x-\\xi) \\varepsilon_{\\mathrm{eq}}(\\xi) d\\xi = \\int_{-\\infty}^{\\infty} L G_{\\ell}(x-\\xi) \\varepsilon_{\\mathrm{eq}}(\\xi) d\\xi$$\n根据格林函数的性质和平移不变性，$L G_{\\ell}(x-\\xi) = \\delta(x-\\xi)$。\n$$L u(x) = \\int_{-\\infty}^{\\infty} \\delta(x-\\xi) \\varepsilon_{\\mathrm{eq}}(\\xi) d\\xi = \\varepsilon_{\\mathrm{eq}}(x)$$\n因此，$u(x)$ 满足控制微分方程。考虑到它也满足无穷远处的衰减条件（因为 $G_{\\ell}$ 衰减且 $\\varepsilon_{\\mathrm{eq}}$ 是局部的），根据唯一性，$u(x)=\\bar{\\varepsilon}(x)$。这便确立了所要求的卷积形式：\n$$\\bar{\\varepsilon}(x)=\\int_{-\\infty}^{\\infty} G_{\\ell}(x-\\xi)\\,\\varepsilon_{\\mathrm{eq}}(\\xi)\\,d\\xi$$\n现在，我们计算针对指定的矩形源项 $\\varepsilon_{\\mathrm{eq}}(x)$ 的 $\\bar{\\varepsilon}(0)$。\n$$\\bar{\\varepsilon}(0) = \\int_{-\\infty}^{\\infty} G_{\\ell}(0-\\xi) \\varepsilon_{\\mathrm{eq}}(\\xi) d\\xi = \\int_{-\\infty}^{\\infty} G_{\\ell}(-\\xi) \\varepsilon_{\\mathrm{eq}}(\\xi) d\\xi$$\n格林函数是一个偶函数，$G_{\\ell}(-\\xi) = G_{\\ell}(\\xi)$。源项仅在 $|\\xi| \\le a$ 时非零。\n$$\\bar{\\varepsilon}(0) = \\int_{-a}^{a} G_{\\ell}(\\xi) \\varepsilon_{0} d\\xi = \\varepsilon_{0} \\int_{-a}^{a} \\frac{1}{2\\ell} \\exp\\left(-\\frac{|\\xi|}{\\ell}\\right) d\\xi$$\n被积函数是 $\\xi$ 的偶函数，所以从 $-a$ 到 $a$ 的积分是从 $0$ 到 $a$ 的积分的两倍。\n$$\\bar{\\varepsilon}(0) = \\varepsilon_{0} \\cdot 2 \\int_{0}^{a} \\frac{1}{2\\ell} \\exp\\left(-\\frac{\\xi}{\\ell}\\right) d\\xi = \\frac{\\varepsilon_{0}}{\\ell} \\int_{0}^{a} \\exp\\left(-\\frac{\\xi}{\\ell}\\right) d\\xi$$\n进行初等积分：\n$$\\bar{\\varepsilon}(0) = \\frac{\\varepsilon_{0}}{\\ell} \\left[ -\\ell \\exp\\left(-\\frac{\\xi}{\\ell}\\right) \\right]_{0}^{a}$$\n$$\\bar{\\varepsilon}(0) = \\frac{\\varepsilon_{0}}{\\ell} \\left( -\\ell \\exp\\left(-\\frac{a}{\\ell}\\right) - \\left(-\\ell \\exp\\left(-0\\right)\\right) \\right)$$\n$$\\bar{\\varepsilon}(0) = \\frac{\\varepsilon_{0}}{\\ell} \\left( -\\ell \\exp\\left(-\\frac{a}{\\ell}\\right) + \\ell \\right) = \\varepsilon_{0} \\left( 1 - \\exp\\left(-\\frac{a}{\\ell}\\right) \\right)$$\n这就是局部化载荷中心处正则化应变的闭式表达式。", "answer": "$$\\boxed{\\varepsilon_{0} \\left(1 - \\exp\\left(-\\frac{a}{\\ell}\\right)\\right)}$$", "id": "2593442"}, {"introduction": "在解析理解的基础上，本练习将带我们迈出下一步：使用有限元方法（FEM）实现一个梯度损伤模型。你将从控制方程出发推导其弱形式，并组装一个线性系统来求解非局部场 $\\kappa(x)$。这个练习展示了正则化这一抽象概念如何转化为具体的数值算法，以及内部长度尺度 $\\ell$ 如何有效地控制损伤区的宽度，从而防止病态的网格依赖性 [@problem_id:2593449]。", "problem": "考虑一根占据域 $\\Omega = [-L,L]$ 并承受单轴拉伸的一维杆。在材料软化开始后，必须对应变局部化进行正则化，以防止病态的网格依赖性。在显式梯度损伤正则化中，非局部历史场 $\\kappa(x)$ 是通过求解以下二次泛函的极小值得到的\n$$\n\\mathcal{J}[\\kappa] \\;=\\; \\frac{1}{2} \\int_{-L}^{L} \\left(\\kappa(x) - \\kappa_{\\mathrm{loc}}(x)\\right)^2 \\,\\mathrm{d}x \\;+\\; \\frac{1}{2}\\ell^2 \\int_{-L}^{L} \\left(\\kappa'(x)\\right)^2 \\,\\mathrm{d}x,\n$$\n其中 $\\kappa_{\\mathrm{loc}}(x)$ 是一个给定的局部历史驱动量，$\\ell > 0$ 是一个内禀长度。这种选择代表了亥姆霍兹型 (Helmholtz-type) 显式梯度正则化，该方法广泛用于控制率无关损伤模型中的应变局部化。边界条件取为齐次诺伊曼 (homogeneous Neumann) 条件，即在 $x=\\pm L$ 处 $\\kappa'(x)\\,\\nu = 0$，其中 $\\nu$ 是外单位法向量。\n\n假设在均匀拉伸下形成局部化后，在 $x=0$ 附近存在一个狭窄的损伤核心，使得局部驱动量为\n$$\n\\kappa_{\\mathrm{loc}}(x) \\;=\\; \\begin{cases}\n\\kappa_0, & |x|\\le a,\\\\\n0, & |x|>a,\n\\end{cases}\n$$\n其中常量 $\\kappa_0 > 0$ 且 $a \\ll \\ell$。你需要通过设 $\\kappa_0 = 1$ 来完全在无量纲形式下进行计算，以使所有报告的量均为无量纲。\n\n任务：\n1) 从泛函 $\\mathcal{J}[\\kappa]$ 和变分法基本定理出发，推导 $\\kappa(x)$ 满足的欧拉-拉格朗日方程和自然边界条件。\n\n2) 推导适用于伽辽金离散化 (Galerkin discretization) 的弱形式：找到 $\\kappa \\in H^1(\\Omega)$，使得在齐次诺伊曼边界条件下，双线性和线性形式是适定的。你的推导必须与上述显式梯度正则化的意义相符。\n\n3) 使用有限元法 (FEM)，在包含 $N$ 个单元的均匀网格上采用线性形函数，为 $\\Omega=[-L,L]$ 上的 $\\kappa_h(x)$ 构建离散线性系统。使用由弱形式产生的协调的单元质量和刚度矩阵。明确说明右端项是如何通过在节点处求值的 $\\kappa_{\\mathrm{loc}}(x)$ 组装而成的。\n\n4) 实现一个一维求解器，为下面给出的每个测试用例组装并求解得到的关于 $\\kappa_h(x)$ 的线性系统。通过弱形式隐式地采用齐次诺伊曼边界条件。\n\n5) 将损伤区宽度定义为 $\\kappa_h(x)$ 的半峰全宽 (FWHM)，即 $\\kappa_h(x)$ 等于其最大值一半的两个点之间的距离。通过定位 $\\frac{1}{2}\\max_x \\kappa_h(x)$ 水平线的两个交叉点，并在线性插值节点值以估算交叉位置的基础上，从离散的 $\\kappa_h(x)$ 计算 FWHM。如果在到达边界前未能穿过 $\\frac{1}{2}\\max_x \\kappa_h(x)$ 水平线，则该情况下的 FWHM 定义为 $2L$。\n\n6) 为证明正则化效果，对每个测试用例计算并报告比率 $\\mathrm{FWHM}/\\ell$。对于足够大的 $L/\\ell$ 和足够小的 $a/\\ell$，理论预测该比率趋于一个与 $L$ 和 $a$ 无关的常数，从而表明损伤区宽度与 $\\ell$ 成比例。\n\n必须使用的数学和算法基础：\n- 欧拉-拉格朗日方程源于将一阶变分 $\\delta \\mathcal{J}$ 对任意容许扰动设为零。\n- 弱形式通过将强形式与一个检验函数相乘，在 $\\Omega$ 上积分，并对包含二阶导数的项应用分部积分得到。\n- 对于单元尺寸为 $h = 2L/N$ 的均匀网格上的线性有限元，使用标准的协调单元质量矩阵 $M_e = \\frac{h}{6}\\begin{bmatrix}2 & 1\\\\ 1 & 2\\end{bmatrix}$ 和刚度矩阵 $K_e = \\frac{1}{h}\\begin{bmatrix}1 & -1\\\\ -1 & 1\\end{bmatrix}$。全局系统具有一般结构 $(M + \\ell^2 K)\\boldsymbol{\\kappa} = M\\boldsymbol{g}$，其中 $\\boldsymbol{g}$ 是 $\\kappa_{\\mathrm{loc}}(x)$ 的节点采样。\n\n测试套件：\n- 情况 A：$L=1.0$, $\\ell=0.05$, $a=0.002$, $N=2000$。\n- 情况 B：$L=1.0$, $\\ell=0.10$, $a=0.002$, $N=2000$。\n- 情况 C：$L=1.0$, $\\ell=0.02$, $a=0.002$, $N=2000$。\n- 情况 D（受边界影响的）：$L=0.03$, $\\ell=0.05$, $a=0.002$, $N=600$。\n\n所有量均为无量纲。无需物理单位。不涉及角度。输出必须为浮点数。\n\n要求的最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表，顺序为 [情况 A, 情况 B, 情况 C, 情况 D]，其中每个条目是比率 $\\mathrm{FWHM}/\\ell$，四舍五入到小数点后恰好六位。例如，一个有效的输出格式是 \"[1.386200,1.385900,1.386300,1.210000]\"。", "solution": "在尝试任何求解之前，对所提供的问题进行验证。\n\n逐字提取给定条件：\n- 域为 $\\Omega = [-L,L]$。\n- 泛函为 $\\mathcal{J}[\\kappa] = \\frac{1}{2} \\int_{-L}^{L} \\left(\\kappa(x) - \\kappa_{\\mathrm{loc}}(x)\\right)^2 \\,\\mathrm{d}x + \\frac{1}{2}\\ell^2 \\int_{-L}^{L} \\left(\\kappa'(x)\\right)^2 \\,\\mathrm{d}x$。\n- 局部历史驱动量为 $\\kappa_{\\mathrm{loc}}(x) = \\begin{cases} \\kappa_0, & |x|\\le a,\\\\ 0, & |x|>a, \\end{cases}$，其中 $\\kappa_0=1$。\n- 边界条件为齐次诺伊曼 (homogeneous Neumann) 条件：在 $x=\\pm L$ 处 $\\kappa'(x)\\,\\nu = 0$。\n- 有限元近似使用均匀网格上包含 $N$ 个单元的线性形函数。\n- 单元矩阵指定为 $M_e = \\frac{h}{6}\\begin{bmatrix}2 & 1\\\\ 1 & 2\\end{bmatrix}$ 和 $K_e = \\frac{1}{h}\\begin{bmatrix}1 & -1\\\\ -1 & 1\\end{bmatrix}$。\n- 全局系统结构为 $(M + \\ell^2 K)\\boldsymbol{\\kappa} = M\\boldsymbol{g}$。\n- 损伤区宽度定义为 $\\kappa_h(x)$ 的半峰全宽 (FWHM)。如果未穿过半峰值水平线，FWHM 定义为 $2L$。\n\n验证结论：该问题具有科学依据，是适定且客观的。它描述了一种用于应变局部化的标准亥姆霍兹型 (Helmholtz-type) 正则化，这是连续介质力学中的一个有效课题。其数学表述是完整且一致的。提供了数值求解所需的所有参数。该问题被认定为有效。我们开始求解。\n\n解答是按照指定顺序完成各项任务来构建的。\n\n1) 欧拉-拉格朗日方程和自然边界条件的推导。\n\n泛函 $\\mathcal{J}[\\kappa]$ 的极小化子 $\\kappa(x)$ 必须满足对于任何容许扰动 $\\delta\\kappa(x)$，一阶变分 $\\delta \\mathcal{J}$ 为零的条件。泛函由下式给出\n$$\n\\mathcal{J}[\\kappa] = \\int_{-L}^{L} F(x, \\kappa, \\kappa') \\,\\mathrm{d}x\n$$\n其中被积函数为 $F(x, \\kappa, \\kappa') = \\frac{1}{2}(\\kappa - \\kappa_{\\mathrm{loc}})^2 + \\frac{1}{2}\\ell^2(\\kappa')^2$。\n\n一阶变分计算如下\n$$\n\\delta \\mathcal{J} = \\int_{-L}^{L} \\left( \\frac{\\partial F}{\\partial \\kappa}\\delta\\kappa + \\frac{\\partial F}{\\partial \\kappa'}\\delta\\kappa' \\right) \\,\\mathrm{d}x = 0\n$$\n$F$ 的偏导数为：\n$$\n\\frac{\\partial F}{\\partial \\kappa} = \\kappa - \\kappa_{\\mathrm{loc}}\n$$\n$$\n\\frac{\\partial F}{\\partial \\kappa'} = \\ell^2 \\kappa'\n$$\n将这些代入 $\\delta\\mathcal{J}$ 的表达式中：\n$$\n\\delta \\mathcal{J} = \\int_{-L}^{L} \\left( (\\kappa - \\kappa_{\\mathrm{loc}})\\delta\\kappa + \\ell^2\\kappa'\\delta\\kappa' \\right) \\,\\mathrm{d}x = 0\n$$\n对第二项应用分部积分：\n$$\n\\int_{-L}^{L} \\ell^2\\kappa'\\delta\\kappa' \\,\\mathrm{d}x = \\left[ \\ell^2\\kappa'\\delta\\kappa \\right]_{-L}^{L} - \\int_{-L}^{L} (\\ell^2\\kappa'')\\delta\\kappa \\,\\mathrm{d}x\n$$\n将其代回变分方程：\n$$\n\\delta \\mathcal{J} = \\int_{-L}^{L} \\left( \\kappa - \\kappa_{\\mathrm{loc}} - \\ell^2\\kappa'' \\right) \\delta\\kappa \\,\\mathrm{d}x + \\left[ \\ell^2\\kappa'\\delta\\kappa \\right]_{-L}^{L} = 0\n$$\n为使此方程对任意容许扰动 $\\delta\\kappa$ 成立，积分项和边界项必须各自独立为零。根据变分法基本引理，从积分项我们得到欧拉-拉格朗日方程：\n$$\n\\kappa(x) - \\ell^2\\kappa''(x) = \\kappa_{\\mathrm{loc}}(x) \\quad \\text{for } x \\in (-L, L)\n$$\n边界项提供了自然边界条件。由于没有对 $\\kappa$ 施加本质 (Dirichlet) 条件，扰动 $\\delta\\kappa(\\pm L)$ 是任意的。因此，它们的系数必须为零：\n$$\n\\ell^2 \\kappa'(L) = 0 \\quad \\text{和} \\quad -\\ell^2 \\kappa'(-L) = 0\n$$\n因为 $\\ell > 0$，这意味着 $\\kappa'(L)=0$ 和 $\\kappa'(-L)=0$。外单位法向量在 $x=L$ 处为 $\\nu=1$，在 $x=-L$ 处为 $\\nu=-1$。因此，条件 $\\kappa'(x)\\nu = 0$ 在两个边界上都得到满足。\n\n2) 弱形式的推导。\n\n弱形式由强形式（欧拉-拉格朗日方程）推导而来，方法是用一个来自合适空间（此处为 $H^1(\\Omega)$）的检验函数 $v(x)$ 乘以强形式，并在域 $\\Omega = [-L, L]$ 上进行积分。\n从强形式 $-\\ell^2\\kappa'' + \\kappa = \\kappa_{\\mathrm{loc}}$ 开始：\n$$\n\\int_{-L}^{L} (-\\ell^2\\kappa'' + \\kappa) v \\,\\mathrm{d}x = \\int_{-L}^{L} \\kappa_{\\mathrm{loc}} v \\,\\mathrm{d}x\n$$\n我们对二阶导数项应用分部积分以降低微分阶数：\n$$\n\\int_{-L}^{L} (-\\ell^2\\kappa'')v \\,\\mathrm{d}x = \\left[ -\\ell^2\\kappa'v \\right]_{-L}^{L} + \\int_{-L}^{L} \\ell^2\\kappa'v' \\,\\mathrm{d}x\n$$\n由于齐次诺伊曼边界条件 $\\kappa'(\\pm L)=0$，边界项 $\\left[ -\\ell^2\\kappa'v \\right]_{-L}^{L} = -\\ell^2\\kappa'(L)v(L) + \\ell^2\\kappa'(-L)v(-L)$ 恒为零。这就是自然边界条件如何被隐式地并入弱形式中的。\n\n得到的弱形式为：找到 $\\kappa \\in H^1(\\Omega)$，使得对于所有 $v \\in H^1(\\Omega)$，\n$$\n\\int_{-L}^{L} \\left(\\ell^2\\kappa'(x)v'(x) + \\kappa(x)v(x)\\right) \\,\\mathrm{d}x = \\int_{-L}^{L} \\kappa_{\\mathrm{loc}}(x)v(x) \\,\\mathrm{d}x\n$$\n这定义了一个双线性形式 $a(\\kappa, v) = \\int_{-L}^{L} (\\ell^2\\kappa'v' + \\kappa v)\\,\\mathrm{d}x$ 和一个线性泛函 $l(v) = \\int_{-L}^{L} \\kappa_{\\mathrm{loc}}v\\,\\mathrm{d}x$。根据 Lax-Milgram 定理，问题 $a(\\kappa, v) = l(v)$ 是适定的，因为该双线性形式在 $H^1(\\Omega)$ 上是连续和强制的。\n\n3) 离散线性系统的构建。\n\n我们将域 $\\Omega = [-L, L]$ 离散为 $N$ 个尺寸均匀为 $h = 2L/N$ 的线性有限元。解 $\\kappa(x)$ 由分段线性函数 $\\kappa_h(x) = \\sum_{j=1}^{N+1} \\kappa_j N_j(x)$ 近似，其中 $\\kappa_j$ 是节点值，而 $N_j(x)$ 是线性“帽形”形函数。\n使用伽辽金法 (Galerkin method)，我们从同一离散空间中选择检验函数，即 $v(x) = N_i(x)$，其中 $i=1, \\dots, N+1$。将 $\\kappa_h$ 的近似代入弱形式，得到一个线性方程组：\n$$\n\\sum_{j=1}^{N+1} \\kappa_j \\left( \\ell^2 \\int_{-L}^{L} N_i' N_j' \\,\\mathrm{d}x + \\int_{-L}^{L} N_i N_j \\,\\mathrm{d}x \\right) = \\int_{-L}^{L} \\kappa_{\\mathrm{loc}} N_i \\,\\mathrm{d}x\n$$\n这是一个线性系统 $A\\boldsymbol{\\kappa} = \\boldsymbol{f}$，其中 $\\boldsymbol{\\kappa}$ 是节点未知量向量 $[\\kappa_1, \\dots, \\kappa_{N+1}]^T$。系统矩阵 $A$ 由 $A_{ij} = \\ell^2 K_{ij} + M_{ij}$ 给出，其中\n- $K_{ij} = \\int_{-L}^{L} N_i'(x) N_j'(x) \\,\\mathrm{d}x$ 是全局刚度矩阵 $K$ 的项。\n- $M_{ij} = \\int_{-L}^{L} N_i(x) N_j(x) \\,\\mathrm{d}x$ 是全局质量矩阵 $M$ 的项。\n\n矩阵 $K$ 和 $M$ 是通过对每个单元的刚度矩阵 $K_e$ 和质量矩阵 $M_e$ 的贡献求和来组装的。对于长度为 $h$ 的线性单元，这些矩阵如题中所给 $K_e = \\frac{1}{h}\\begin{bmatrix}1 & -1\\\\ -1 & 1\\end{bmatrix}$ 和 $M_e = \\frac{h}{6}\\begin{bmatrix}2 & 1\\\\ 1 & 2\\end{bmatrix}$。\n\n右端向量 $\\boldsymbol{f}$ 的分量为 $f_i = \\int_{-L}^{L} \\kappa_{\\mathrm{loc}}(x) N_i(x) \\,\\mathrm{d}x$。按照建议，我们使用一种协调的公式来近似它。我们将 $\\kappa_{\\mathrm{loc}}(x)$ 用其节点插值来近似，即 $\\kappa_{\\mathrm{loc}}(x) \\approx \\sum_{j=1}^{N+1} g_j N_j(x)$，其中 $g_j = \\kappa_{\\mathrm{loc}}(x_j)$ 是局部驱动量的节点值。该积分变为：\n$$\nf_i = \\int_{-L}^{L} \\left(\\sum_{j=1}^{N+1} g_j N_j(x)\\right) N_i(x) \\,\\mathrm{d}x = \\sum_{j=1}^{N+1} M_{ij} g_j = (M\\boldsymbol{g})_i\n$$\n因此，右端向量为 $\\boldsymbol{f} = M\\boldsymbol{g}$。最终的离散系统是：\n$$\n(M + \\ell^2 K)\\boldsymbol{\\kappa} = M\\boldsymbol{g}\n$$\n该系统是对称正定的，可以求解得到节点值 $\\boldsymbol{\\kappa}$。\n\n4-6) 实现、FWHM 计算和报告。\n\n步骤 1-3 中描述的逻辑在 Python 中实现。求解器为每个测试用例执行以下序列：\n- 定义网格节点和单元尺寸。\n- 从所提供的单元矩阵组装全局质量 ($M$) 和刚度 ($K$) 矩阵。\n- 通过在节点处采样 $\\kappa_{\\mathrm{loc}}(x)$ 来构建节点向量 $\\boldsymbol{g}$。\n- 构造系统矩阵 $A = M + \\ell^2 K$ 和右端向量 $\\boldsymbol{f} = M\\boldsymbol{g}$。\n- 求解线性系统 $A\\boldsymbol{\\kappa} = \\boldsymbol{f}$ 以找到节点解 $\\boldsymbol{\\kappa}$。\n- 计算解的最大值 $\\kappa_{\\max} = \\max(\\boldsymbol{\\kappa})$ 和半峰值水平 $\\kappa_{hm} = 0.5 \\kappa_{\\max}$。\n- 检查边界处的解 $\\kappa_h(L)$ 是否大于 $\\kappa_{hm}$。如果是，则 FWHM 被设为 $2L$。\n- 否则，它从域的中心向外搜索，找到解穿过 $\\kappa_{hm}$ 水平线的单元。在该单元内使用线性插值来找到精确的交叉坐标 $x_{cross}$。然后 FWHM 为 $2x_{cross}$。\n- 最后，计算并报告比率 $\\mathrm{FWHM}/\\ell$。\n\n对于无限域情况的理论分析（在 $a \\ll \\ell$ 和 $L \\gg \\ell$ 时有效）预测 $\\mathrm{FWHM} / \\ell = 2\\ln(2) \\approx 1.386294$。情况 A、B 和 C 的结果预计将接近该值，从而展示了长度尺度 $\\ell$ 的正则化性质。情况 D 涉及一个边界主导的情景，预计会有不同的结果。提供的代码实现了此过程以获得所需的数值。", "answer": "```python\nimport numpy as np\n\ndef solve_fem_1d(L, ell, a, N):\n    \"\"\"\n    Solves the 1D Helmholtz-type equation using the Finite Element Method.\n\n    Args:\n        L (float): Half-length of the domain [-L, L].\n        ell (float): Internal length scale.\n        a (float): Half-width of the local driver pulse.\n        N (int): Number of elements.\n\n    Returns:\n        tuple: A tuple containing:\n            - np.ndarray: Nodal coordinates.\n            - np.ndarray: Solution vector kappa at nodes.\n    \"\"\"\n    num_nodes = N + 1\n    h = 2.0 * L / N\n\n    # Element matrices\n    M_e = (h / 6.0) * np.array([[2, 1], [1, 2]])\n    K_e = (1.0 / h) * np.array([[1, -1], [-1, 1]])\n\n    # Global matrices\n    M = np.zeros((num_nodes, num_nodes))\n    K = np.zeros((num_nodes, num_nodes))\n\n    for i in range(N):\n        # Assembly of global matrices from element matrices\n        M[i:i+2, i:i+2] += M_e\n        K[i:i+2, i:i+2] += K_e\n\n    # Nodal coordinates\n    nodes = np.linspace(-L, L, num_nodes)\n\n    # Local history driver vector g\n    g = np.zeros(num_nodes)\n    g[np.abs(nodes) <= a] = 1.0\n\n    # System matrix and right-hand side vector\n    A = M + ell**2 * K\n    b = M @ g\n\n    # Solve the linear system\n    kappa = np.linalg.solve(A, b)\n\n    return nodes, kappa\n\ndef calculate_fwhm(nodes, kappa, L):\n    \"\"\"\n    Calculates the Full Width at Half Maximum (FWHM) of the solution kappa.\n\n    Args:\n        nodes (np.ndarray): Nodal coordinates.\n        kappa (np.ndarray): Solution vector.\n        L (float): Half-length of the domain.\n\n    Returns:\n        float: The calculated FWHM.\n    \"\"\"\n    kappa_max = np.max(kappa)\n    if kappa_max == 0:\n        return 0.0\n        \n    kappa_hm = 0.5 * kappa_max\n\n    # Check if the value at the boundary is above half-maximum\n    if kappa[-1] > kappa_hm:\n        return 2.0 * L\n\n    # Find the crossing point on the positive side (x > 0)\n    # The solution is symmetric, peaking at x=0\n    # The center node index is N//2 where N is the number of elements\n    center_idx = len(nodes) // 2\n    x_cross = None\n\n    for i in range(center_idx, len(nodes) - 1):\n        if kappa[i] >= kappa_hm and kappa[i+1] <= kappa_hm:\n            # Linear interpolation to find the crossing coordinate\n            x_i = nodes[i]\n            x_i1 = nodes[i+1]\n            kappa_i = kappa[i]\n            kappa_i1 = kappa[i+1]\n            \n            # Interpolation formula: x = x1 + (x2-x1)*(y-y1)/(y2-y1)\n            x_cross = x_i + (x_i1 - x_i) * (kappa_hm - kappa_i) / (kappa_i1 - kappa_i)\n            break\n    \n    if x_cross is None:\n        # This case should be prevented by the boundary value check,\n        # but as a fallback, return 2L\n        return 2.0 * L\n\n    # FWHM is twice the distance from the center to the crossing point\n    return 2.0 * x_cross\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    test_cases = [\n        # (L, ell, a, N)\n        (1.0, 0.05, 0.002, 2000),  # Case A\n        (1.0, 0.10, 0.002, 2000),  # Case B\n        (1.0, 0.02, 0.002, 2000),  # Case C\n        (0.03, 0.05, 0.002, 600),   # Case D\n    ]\n\n    results = []\n    for L, ell, a, N in test_cases:\n        nodes, kappa = solve_fem_1d(L, ell, a, N)\n        fwhm = calculate_fwhm(nodes, kappa, L)\n        fwhm_ratio = fwhm / ell\n        results.append(fwhm_ratio)\n\n    # Format the output string as required\n    output_str = f\"[{','.join(f'{r:.6f}' for r in results)}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2593449"}, {"introduction": "一个数值模型的优劣取决于其离散化的质量。最后一个练习深入探讨了实现非局部模型时一个至关重要的方面：物理内部长度 $\\ell$ 与数值网格尺寸 $h$ 之间的关系。我们将分析离散化过程本身如何引入一种人为的“数值扩散”，从而有效地加宽了核函数。通过量化这一效应，你将推导出一个关于 $\\ell/h$ 比例的实用准则，以确保数值模拟能够忠实地再现预期的连续介质物理行为 [@problem_id:2593483]。", "problem": "考虑在有限元法 (FEM) 中用于对应变局部化进行正则化的积分型非局部平均。在一维 ($1$D) 无限域中，标量场 $q(x)$ 的非局部平均定义为\n$$\\bar{q}(x) = \\int_{-\\infty}^{\\infty} w(|x-\\xi|)\\, q(\\xi)\\, d\\xi,$$\n其中 $w(r)$ 是一个归一化的对称核函数，其特征内禀长度为 $\\ell$，例如指数核函数 $w(r)=\\dfrac{1}{2\\ell}\\exp(-r/\\ell)$，它是一维亥姆霍兹算子的格林函数。该场在尺寸为 $h$ 的均匀网格上使用连续分片线性 ($P1$) 形函数 $N_i(x)$ 进行离散化。通过集中的 $L^2$ 投影定义非局部平均的节点表示\n$$\\bar{q}_i := \\frac{1}{m_i}\\int_{\\mathbb{R}} N_i(x)\\, \\bar{q}(x)\\, dx,\\qquad m_i := \\int_{\\mathbb{R}} N_i(x)\\, dx,$$\n在均匀网格上，因此对于所有 $i$ 都有 $m_i = h$。对于此节点投影算子，将连续场 $q$ 映射到节点平均值 $\\bar{q}_i$ 的等效核函数是物理核函数 $w$ 与以节点为中心的归一化帽形函数 $p(x):=N_0(x)/h$ 的卷积，即 $w_{\\text{eff}} = w * p$。设 $\\mu_2[k] := \\int_{\\mathbb{R}} r^2 k(r)\\, dr$ 表示任何对称、归一化核函数 $k$ 的二阶中心矩；回想一下，对于对称、归一化的核函数，卷积的二阶中心矩等于二阶中心矩之和，即 $\\mu_2[k_1 * k_2] = \\mu_2[k_1] + \\mu_2[k_2]$。\n\n仅使用这些基本原理和均匀网格上 $P1$ 形函数的标准属性，推断比率 $\\ell/h$ 对节点投影算子所产生的等效非局部平均的影响。特别是，确定在低波数下，等效内禀长度的平方 $\\ell_{\\text{eff}}^2$ 与 $\\ell^2$ 有何不同，并提出一个关于 $\\ell/h$ 的定量指导原则，该原则将网格引入的附加数值扩散（展宽）限制在相对于目标连续介质核函数的 $5\\%$ 以内。\n\n哪个选项是正确的？\n\nA. 归一化帽形函数 $p$ 的二阶矩为 $\\mu_2[p]=h^2/6$，因此 $\\mu_2[w_{\\text{eff}}]=\\mu_2[w]+\\mu_2[p]=2\\ell^2 + h^2/6$，这意味着 $\\ell_{\\text{eff}}^2 = \\ell^2 + h^2/12$。相对扩散增加量为 $(h/\\ell)^2/12$。为使其 $\\le 5\\%$，需要 $\\ell/h \\ge \\sqrt{1/0.6} \\approx 1.29$（实际上，$\\ell/h \\gtrsim 1.3$）。\n\nB. 归一化帽形函数 $p$ 的二阶矩为 $\\mu_2[p]=h^2/3$，因此 $\\mu_2[w_{\\text{eff}}]=2\\ell^2 + h^2/3$，这意味着 $\\ell_{\\text{eff}}^2 = \\ell^2 + h^2/6$。相对扩散增加量为 $(h/\\ell)^2/6$。为使其 $\\le 5\\%$，需要 $\\ell/h \\ge \\sqrt{1/0.3} \\approx 1.83$。\n\nC. 网格不引入展宽，因为伽辽金投影在有限元空间上是精确的，所以对于所有 $h$ 都有 $\\ell_{\\text{eff}}^2=\\ell^2$。因此，不需要对 $\\ell/h$ 进行约束来控制数值扩散。\n\nD. 由于积分不足，网格减少了扩散，得到 $\\ell_{\\text{eff}}^2=\\ell^2 - h^2/12$。因此，为避免过度扩散，应取 $\\ell/h \\le 1$，以便物理核函数补偿扩散的减少。", "solution": "在进行求解之前，对问题陈述进行验证。\n\n### 第一步：提取已知条件\n- 在一维无限域中的非局部平均定义：$\\bar{q}(x) = \\int_{-\\infty}^{\\infty} w(|x-\\xi|)\\, q(\\xi)\\, d\\xi$。\n- 核函数 $w(r)$：归一化、对称，具有特征内禀长度 $\\ell$。\n- 核函数示例：指数核函数 $w(r)=\\dfrac{1}{2\\ell}\\exp(-r/\\ell)$，它是一维亥姆霍兹算子的格林函数。\n- 离散化：尺寸为 $h$ 的均匀网格，使用连续分片线性 ($P1$) 形函数 $N_i(x)$。\n- 节点表示（集中 $L^2$ 投影）：$\\bar{q}_i := \\frac{1}{m_i}\\int_{\\mathbb{R}} N_i(x)\\, \\bar{q}(x)\\, dx$。\n- 质量积分：$m_i := \\int_{\\mathbb{R}} N_i(x)\\, dx$。对于均匀网格，$m_i = h$。\n- 等效核函数定义：$w_{\\text{eff}} = w * p$，其中 $p(x):=N_0(x)/h$。\n- 二阶中心矩定义：对于对称、归一化的核函数 $k$，$\\mu_2[k] := \\int_{\\mathbb{R}} r^2 k(r)\\, dr$。\n- 卷积的二阶矩：对于对称、归一化的核函数 $k_1$ 和 $k_2$，$\\mu_2[k_1 * k_2] = \\mu_2[k_1] + \\mu_2[k_2]$。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学基础**：该问题在非局部连续介质力学理论及其使用有限元法的数值实现方面有充分的依据。所提出的概念——非局部平均、核函数、集中投影、作为弥散度量的二阶矩以及卷积的性质——在计算力学中用于应变局部化现象的正则化是标准的。\n- **适定性**：问题陈述清晰。它提供了一组定义和关系，并要求基于这些前提进行定量分析。问题具体，通过逻辑推导和计算可以得出唯一答案。\n- **客观性**：问题以精确、客观的数学和物理语言表述，没有歧义或主观内容。\n\n### 第三步：结论与行动\n问题陈述有效。它是自洽的、科学上合理的且适定的。将推导解答。\n\n### 推导\n目标是量化节点投影算子引入的数值展宽，并建立网格尺寸 $h$ 相对于物理内禀长度 $\\ell$ 的指导原则。问题表明，可以通过检查等效核函数的二阶矩来分析这种展宽。\n\n特征长度的平方 $\\ell^2$ 与物理核函数 $w(r)$ 的二阶中心矩 $\\mu_2[w]$ 相关。问题提到指数核函数是一维亥姆霍兹算子 $(1 - \\ell^2 \\frac{d^2}{dx^2})$ 的格林函数。在傅里叶空间中，该算子的符号为 $(1 + \\ell^2 k^2)$，其中 $k$ 是波数。核函数的傅里叶变换 $\\hat{w}(k)$ 是该符号的倒数，$\\hat{w}(k) = (1 + \\ell^2 k^2)^{-1}$。对于小波数 ($k \\to 0$)，我们可以将其展开为泰勒级数：\n$$ \\hat{w}(k) = 1 - \\ell^2 k^2 + O(k^4) $$\n另外，任何对称、归一化核函数 $w(r)$ 的傅里叶变换可以根据其矩展开：\n$$ \\hat{w}(k) = \\int_{-\\infty}^\\infty w(r) e^{-ikr} dr = \\int_{-\\infty}^\\infty w(r) \\left(1 - ikr - \\frac{k^2r^2}{2} + \\dots\\right) dr $$\n由于 $w(r)$ 是归一化的（$\\int w(r) dr = 1$）和对称的（$\\int r w(r) dr = 0$），这简化为：\n$$ \\hat{w}(k) = 1 - \\frac{k^2}{2} \\int_{-\\infty}^\\infty r^2 w(r) dr + O(k^4) = 1 - \\frac{k^2}{2}\\mu_2[w] + O(k^4) $$\n比较 $\\hat{w}(k)$ 在低波数下的两种展开式，我们建立了基本关系：\n$$ \\ell^2 = \\frac{1}{2}\\mu_2[w] \\implies \\mu_2[w] = 2\\ell^2 $$\n这证实了指数核函数的关系，因为直接计算其二阶矩得到 $\\mu_2[w] = \\int_{-\\infty}^\\infty r^2 \\frac{1}{2\\ell}e^{-|r|/\\ell} dr = 2\\ell^2$。\n\n接下来，我们分析网格离散化所做的贡献。这体现在归一化的帽形函数 $p(x) = N_0(x)/h$ 中。均匀网格上的标准 $P1$ 帽形函数 $N_0(x)$ 定义为 $N_0(x) = \\max(0, 1 - |x/h|)$。它仅在 $x \\in [-h, h]$ 上非零。函数 $p(x)$ 是一个对称的概率密度函数，因为 $\\int_{-\\infty}^\\infty p(x) dx = \\frac{1}{h} \\int_{-h}^h N_0(x) dx = \\frac{1}{h} \\times h = 1$。我们计算其二阶中心矩 $\\mu_2[p]$：\n$$ \\mu_2[p] = \\int_{-\\infty}^\\infty r^2 p(r) dr = \\frac{1}{h} \\int_{-h}^h r^2 N_0(r) dr $$\n由于被积函数 $r^2 N_0(r)$ 的对称性，我们可以写成：\n$$ \\mu_2[p] = \\frac{2}{h} \\int_0^h r^2 (1 - r/h) dr = \\frac{2}{h} \\int_0^h (r^2 - r^3/h) dr $$\n$$ \\mu_2[p] = \\frac{2}{h} \\left[ \\frac{r^3}{3} - \\frac{r^4}{4h} \\right]_0^h = \\frac{2}{h} \\left( \\frac{h^3}{3} - \\frac{h^4}{4h} \\right) = \\frac{2}{h} \\left( \\frac{h^3}{3} - \\frac{h^3}{4} \\right) = \\frac{2}{h} \\left( \\frac{h^3}{12} \\right) = \\frac{h^2}{6} $$\n所以，归一化帽形函数的二阶矩是 $\\mu_2[p] = h^2/6$。\n\n等效核函数由 $w_{\\text{eff}} = w * p$ 给出。使用所提供的卷积二阶矩的性质：\n$$ \\mu_2[w_{\\text{eff}}] = \\mu_2[w] + \\mu_2[p] $$\n代入计算出的矩：\n$$ \\mu_2[w_{\\text{eff}}] = 2\\ell^2 + \\frac{h^2}{6} $$\n我们使用与物理核函数相同的关系来定义等效内禀长度的平方 $\\ell_{\\text{eff}}^2$：$\\ell_{\\text{eff}}^2 = \\frac{1}{2}\\mu_2[w_{\\text{eff}}]$。\n$$ \\ell_{\\text{eff}}^2 = \\frac{1}{2} \\left( 2\\ell^2 + \\frac{h^2}{6} \\right) = \\ell^2 + \\frac{h^2}{12} $$\n这个方程表明，等效长度的平方是物理长度平方与一个数值项 $h^2/12$ 的和，该数值项代表了附加的数值扩散或展宽。\n\n该扩散度量的相对增加量为：\n$$ \\text{相对增加量} = \\frac{\\ell_{\\text{eff}}^2 - \\ell^2}{\\ell^2} = \\frac{(\\ell^2 + h^2/12) - \\ell^2}{\\ell^2} = \\frac{h^2/12}{\\ell^2} = \\frac{1}{12}\\left(\\frac{h}{\\ell}\\right)^2 $$\n我们需要将此相对增量限制在最多 $5\\%$ 或 $0.05$：\n$$ \\frac{1}{12}\\left(\\frac{h}{\\ell}\\right)^2 \\le 0.05 $$\n$$ \\left(\\frac{h}{\\ell}\\right)^2 \\le 12 \\times 0.05 = 0.6 $$\n取平方根并反转分数以求解 $\\ell/h$：\n$$ \\frac{h}{\\ell} \\le \\sqrt{0.6} \\implies \\frac{\\ell}{h} \\ge \\frac{1}{\\sqrt{0.6}} $$\n$$ \\frac{\\ell}{h} \\ge \\sqrt{\\frac{1}{0.6}} = \\sqrt{\\frac{10}{6}} = \\sqrt{\\frac{5}{3}} \\approx 1.29099... $$\n因此，为使数值展宽低于 $5\\%$，必须满足条件 $\\ell/h \\gtrsim 1.29$。\n\n### 逐项分析\n\n**A. 归一化帽形函数 $p$ 的二阶矩为 $\\mu_2[p]=h^2/6$，因此 $\\mu_2[w_{\\text{eff}}]=\\mu_2[w]+\\mu_2[p]=2\\ell^2 + h^2/6$，这意味着 $\\ell_{\\text{eff}}^2 = \\ell^2 + h^2/12$。相对扩散增加量为 $(h/\\ell)^2/12$。为使其 $\\le 5\\%$，需要 $\\ell/h \\ge \\sqrt{1/0.6} \\approx 1.29$ （实际上，$\\ell/h \\gtrsim 1.3$）。**\n该选项正确地陈述了 $\\mu_2[p]=h^2/6$。它正确地使用了卷积的性质和联系内禀长度与二阶矩的定义，推导出 $\\ell_{\\text{eff}}^2 = \\ell^2 + h^2/12$。相对扩散增加量的计算以及得出的条件 $\\ell/h \\ge \\sqrt{1/0.6} \\approx 1.29$ 也是正确的。此选项推理中的每一步都与我们的推导一致。\n**结论：正确。**\n\n**B. 归一化帽形函数 $p$ 的二阶矩为 $\\mu_2[p]=h^2/3$，因此 $\\mu_2[w_{\\text{eff}}]=2\\ell^2 + h^2/3$，这意味着 $\\ell_{\\text{eff}}^2 = \\ell^2 + h^2/6$。相对扩散增加量为 $(h/\\ell)^2/6$。为使其 $\\le 5\\%$，需要 $\\ell/h \\ge \\sqrt{1/0.3} \\approx 1.83$。**\n该选项从一个错误的前提开始。归一化帽形函数的二阶矩是 $\\mu_2[p] = h^2/6$，而不是 $h^2/3$。这个错误贯穿了整个计算过程，导致最终的建议是错误的。\n**结论：错误。**\n\n**C. 网格不引入展宽，因为伽辽金投影在有限元空间上是精确的，所以对于所有 $h$ 都有 $\\ell_{\\text{eff}}^2=\\ell^2$。因此，不需要对 $\\ell/h$ 进行约束来控制数值扩散。**\n这种说法根本上是错误的。首先，问题指定的是*集中 $L^2$ 投影*，而不是伽辽金投影。其次，即使是伽辽金投影，在不引入误差的意义上也不是“精确”的。被投影的函数 $\\bar{q}(x) = (w*q)(x)$ 是物理核函数与场 $q(x)$ 的卷积。这个结果函数通常是光滑的，并且不属于分片线性函数的有限维空间。因此，任何到这个空间上的投影都会引入误差。我们的推导明确地显示了一个展宽项 $h^2/12$，这与 $\\ell_{\\text{eff}}^2 = \\ell^2$ 的主张相矛盾。\n**结论：错误。**\n\n**D. 由于积分不足，网格减少了扩散，得到 $\\ell_{\\text{eff}}^2=\\ell^2 - h^2/12$。因此，为避免过度扩散，应取 $\\ell/h \\le 1$，以便物理核函数补偿扩散的减少。**\n该选项错误地声称网格*减少*了扩散，导致修正项中出现负号。我们的推导表明，涉及与帽形函数卷积的投影算子*增加*了总体的弥散，导致 $\\ell_{\\text{eff}}^2 = \\ell^2 + h^2/12$。其效果是数值展宽（扩散），而不是锐化。\n**结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "2593483"}]}