{"hands_on_practices": [{"introduction": "将应变能密度函数 $W$ 与应力-应变响应联系起来，是建立任何超弹性本构模型的核心步骤。本练习将指导您为经典的不可压缩 Mooney-Rivlin 模型推导其 Kirchhoff 应力 $\\boldsymbol{\\tau}$ 和一致切线模量 $\\mathbb{c}$，这是在有限元程序中实现该模型所必需的关键组成部分。通过这个推导过程，您将加深对连续介质力学中基本关系的理解。[@problem_id:2545790]", "problem": "考虑一个三维、各向同性、不可压缩的超弹性固体，采用空间（欧拉）有限元列式。假设应变能密度纯粹是等容的，并由 Mooney–Rivlin 形式给出\n$$\nW(\\bar{I}_{1},\\bar{I}_{2}) \\;=\\; c_{1}\\,(\\bar{I}_{1}-3) \\;+\\; c_{2}\\,(\\bar{I}_{2}-3),\n$$\n其中 $c_{1}$ 和 $c_{2}$ 是正的材料参数，$\\bar{I}_{1}$ 和 $\\bar{I}_{2}$ 是等容左柯西-格林张量 $\\bar{\\boldsymbol{B}}$ 的第一和第二不变量，且不可压缩性意味着 $J=\\det \\boldsymbol{F}=1$，因此 $\\bar{\\boldsymbol{B}}=J^{-2/3}\\boldsymbol{B}=\\boldsymbol{B}$。这里 $\\boldsymbol{F}$ 是变形梯度，$\\boldsymbol{B}=\\boldsymbol{F}\\boldsymbol{F}^{\\mathsf{T}}$ 是左柯西-格林张量。令 $\\boldsymbol{\\tau}$ 表示 Kirchhoff 应力，$\\boldsymbol{\\sigma}=\\boldsymbol{\\tau}/J$ 表示 Cauchy 应力。不可压缩性由一个拉格朗日乘子（压力）$p$ 来强制施加。\n\n仅从标准的超弹性关系（Kirchhoff 应力由 $\\partial W/\\partial \\boldsymbol{C}$ 前推得到，其中 $\\boldsymbol{C}=\\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}$，以及 $\\boldsymbol{C}$ 或 $\\boldsymbol{B}$ 的不变量的定义）出发，推导：\n\n1) 以 $\\bar{\\boldsymbol{B}}$ 和 $\\bar{\\boldsymbol{B}}^{-1}$ 表示的 Kirchhoff 应力 $\\boldsymbol{\\tau}$。\n\n2) 空间、算法一致的切线（弹性）张量 $\\mathbb{c}$，它将变形率张量 $\\boldsymbol{d}=\\tfrac{1}{2}(\\boldsymbol{L}+\\boldsymbol{L}^{\\mathsf{T}})$ 映射到 Kirchhoff 应力等容部分的 Jaumann 率，即 $\\overset{\\nabla}{\\boldsymbol{\\tau}}_{\\text{iso}}=\\mathbb{c}:\\boldsymbol{d}$，该张量纯粹用 $\\bar{\\boldsymbol{B}}$ 和 $\\bar{\\boldsymbol{B}}^{-1}$ 以及材料参数 $c_{1},c_{2}$ 来表示。涡量 $\\boldsymbol{w}=\\tfrac{1}{2}(\\boldsymbol{L}-\\boldsymbol{L}^{\\mathsf{T}})$ 定义了 Jaumann 率 $\\overset{\\nabla}{(\\cdot)}=\\dot{(\\cdot)}-\\boldsymbol{w}(\\cdot)+(\\cdot)\\,\\boldsymbol{w}$，您可以使用 $\\overset{\\nabla}{\\bar{\\boldsymbol{B}}}=\\boldsymbol{d}\\,\\bar{\\boldsymbol{B}}+\\bar{\\boldsymbol{B}}\\,\\boldsymbol{d}-\\tfrac{2}{3}(\\mathrm{tr}\\,\\boldsymbol{d})\\,\\bar{\\boldsymbol{B}}$ 和 $\\overset{\\nabla}{\\bar{\\boldsymbol{B}}^{-1}}=-\\bar{\\boldsymbol{B}}^{-1}\\,\\overset{\\nabla}{\\bar{\\boldsymbol{B}}}\\,\\bar{\\boldsymbol{B}}^{-1}$ 作为运动学恒等式。使用由 $(\\boldsymbol{A}\\otimes\\boldsymbol{C}):\\boldsymbol{X}=\\boldsymbol{A}\\,\\boldsymbol{X}\\,\\boldsymbol{C}^{\\mathsf{T}}$ 定义的左右并矢积 $\\otimes$ 和单位张量 $\\boldsymbol{I}$ 写出 $\\mathbb{c}$ 的最终张量表达式。\n\n请提供您的最终结果，该结果是由 $\\boldsymbol{\\tau}$ 和 $\\mathbb{c}$ 的符号表达式组成的对，不进行数值代入。您的最终答案必须是一个单一的闭式解析表达式；请使用 LaTeX pmatrix 格式将两个条目放在单行中。不需要单位。不适用四舍五入。", "solution": "该问题被验证为自洽、有科学依据且适定的。我们继续进行推导。\n\n该问题要求求解不可压缩 Mooney-Rivlin 超弹性材料的两个量：Kirchhoff 应力张量 $\\boldsymbol{\\tau}$ 和空间弹性张量 $\\mathbb{c}$。\n\n第 1 部分：Kirchhoff 应力张量 $\\boldsymbol{\\tau}$ 的推导\n\n对于超弹性材料，单位当前体积的做功率由 Kirchhoff 应力张量 $\\boldsymbol{\\tau}$ 与变形率张量 $\\boldsymbol{d}$ 的缩并给出。这必须等于储存的应变能密度 $W$ 的变化率。对于不可压缩材料，$J=\\det\\boldsymbol{F}=1$，这意味着 $\\text{tr}(\\boldsymbol{d})=0$。应力响应由源于应变能的部分和由于不可压缩约束引起的静水压力部分组成。因此，Kirchhoff 应力 $\\boldsymbol{\\tau}$ 写为：\n$$\n\\boldsymbol{\\tau} = -p\\boldsymbol{I} + \\boldsymbol{\\tau}_{\\text{iso}}\n$$\n其中 $p$ 是拉格朗日乘子（压力），$\\boldsymbol{\\tau}_{\\text{iso}}$ 是从应变能函数 $W$ 导出的应力部分。功率方程为 $\\boldsymbol{\\tau}:\\boldsymbol{d} = \\dot{W}$。由于对于不可压缩材料，$(\\text{-}p\\boldsymbol{I}):\\boldsymbol{d} = -p\\,\\text{tr}(\\boldsymbol{d}) = 0$，我们有 $\\boldsymbol{\\tau}_{\\text{iso}}:\\boldsymbol{d} = \\dot{W}$。\n\n应变能密度由 $W = c_{1}\\,(\\bar{I}_{1}-3) + c_{2}\\,(\\bar{I}_{2}-3)$ 给出。对于 $J=1$ 的不可压缩材料，等容左柯西-格林张量 $\\bar{\\boldsymbol{B}} = J^{-2/3}\\boldsymbol{B}$ 变得与左柯西-格林张量 $\\boldsymbol{B}$ 相同。因此，$\\bar{\\boldsymbol{B}} = \\boldsymbol{B}$。不变量则由下式给出：\n$$\n\\bar{I}_{1} = \\mathrm{tr}(\\bar{\\boldsymbol{B}}) = \\mathrm{tr}(\\boldsymbol{B})\n$$\n$$\n\\bar{I}_{2} = \\frac{1}{2}\\left( (\\mathrm{tr}(\\bar{\\boldsymbol{B}}))^{2} - \\mathrm{tr}(\\bar{\\boldsymbol{B}}^{2}) \\right) = \\mathrm{tr}(\\bar{\\boldsymbol{B}}^{-1}) = \\mathrm{tr}(\\boldsymbol{B}^{-1})\n$$\n$\\bar{I}_{2}$ 的最后一个等式来自于行列式为 1 的张量的 Cayley-Hamilton 定理。所以，应变能为 $W = c_{1}(\\mathrm{tr}(\\boldsymbol{B})-3) + c_{2}(\\mathrm{tr}(\\boldsymbol{B}^{-1})-3)$。\n\n为求得 $\\boldsymbol{\\tau}_{\\text{iso}}$，我们计算 $W$ 的物质时间导数：\n$$\n\\dot{W} = \\frac{\\partial W}{\\partial \\bar{I}_1}\\dot{\\bar{I}}_1 + \\frac{\\partial W}{\\partial \\bar{I}_2}\\dot{\\bar{I}}_2 = c_1 \\frac{d}{dt}(\\mathrm{tr}(\\boldsymbol{B})) + c_2 \\frac{d}{dt}(\\mathrm{tr}(\\boldsymbol{B}^{-1}))\n$$\n左柯西-格林张量 $\\boldsymbol{B}$ 的物质时间导数是 $\\dot{\\boldsymbol{B}} = \\boldsymbol{L}\\boldsymbol{B} + \\boldsymbol{B}\\boldsymbol{L}^{\\mathsf{T}}$，其中 $\\boldsymbol{L}=\\dot{\\boldsymbol{F}}\\boldsymbol{F}^{-1}$ 是速度梯度。使用 $\\boldsymbol{L}=\\boldsymbol{d}+\\boldsymbol{w}$，其中 $\\boldsymbol{d}$ 是对称的，$\\boldsymbol{w}$ 是反对称的，我们有：\n$$\n\\dot{\\bar{I}}_1 = \\frac{d}{dt}(\\mathrm{tr}(\\boldsymbol{B})) = \\mathrm{tr}(\\dot{\\boldsymbol{B}}) = \\mathrm{tr}(\\boldsymbol{L}\\boldsymbol{B} + \\boldsymbol{B}\\boldsymbol{L}^{\\mathsf{T}}) = \\mathrm{tr}(\\boldsymbol{B}(\\boldsymbol{L}^{\\mathsf{T}} + \\boldsymbol{L})) = \\mathrm{tr}(2\\boldsymbol{B}\\boldsymbol{d}) = 2\\boldsymbol{B}:\\boldsymbol{d}\n$$\n逆张量 $\\boldsymbol{B}^{-1}$ 的时间导数是 $\\dot{\\boldsymbol{B}^{-1}} = -\\boldsymbol{B}^{-1}\\dot{\\boldsymbol{B}}\\boldsymbol{B}^{-1}$。所以：\n$$\n\\dot{\\bar{I}}_2 = \\frac{d}{dt}(\\mathrm{tr}(\\boldsymbol{B}^{-1})) = \\mathrm{tr}(\\dot{\\boldsymbol{B}^{-1}}) = -\\mathrm{tr}(\\boldsymbol{B}^{-1}\\dot{\\boldsymbol{B}}\\boldsymbol{B}^{-1}) = -\\mathrm{tr}(\\dot{\\boldsymbol{B}}\\boldsymbol{B}^{-2})\n$$\n这条路径不太直接。换一种方法：\n$$\n\\dot{\\bar{I}}_2 = \\mathrm{tr}(-\\boldsymbol{B}^{-1}(\\boldsymbol{L}\\boldsymbol{B}+\\boldsymbol{B}\\boldsymbol{L}^{\\mathsf{T}})\\boldsymbol{B}^{-1}) = -\\mathrm{tr}(\\boldsymbol{B}^{-1}\\boldsymbol{L}+\\boldsymbol{L}^{\\mathsf{T}}\\boldsymbol{B}^{-1}) = -\\mathrm{tr}(\\boldsymbol{B}^{-1}(\\boldsymbol{L}+\\boldsymbol{L}^{\\mathsf{T}})) = -2\\mathrm{tr}(\\boldsymbol{B}^{-1}\\boldsymbol{d}) = -2\\boldsymbol{B}^{-1}:\\boldsymbol{d}\n$$\n将这些率代入 $\\dot{W}$ 的表达式中：\n$$\n\\dot{W} = c_1(2\\boldsymbol{B}:\\boldsymbol{d}) + c_2(-2\\boldsymbol{B}^{-1}:\\boldsymbol{d}) = (2c_1\\boldsymbol{B} - 2c_2\\boldsymbol{B}^{-1}):\\boldsymbol{d}\n$$\n通过将其与 $\\dot{W} = \\boldsymbol{\\tau}_{\\text{iso}}:\\boldsymbol{d}$ 进行比较，我们确定：\n$$\n\\boldsymbol{\\tau}_{\\text{iso}} = 2c_1\\boldsymbol{B} - 2c_2\\boldsymbol{B}^{-1}\n$$\n对于不可压缩情况，使用 $\\bar{\\boldsymbol{B}}=\\boldsymbol{B}$，总的 Kirchhoff 应力为：\n$$\n\\boldsymbol{\\tau} = -p\\boldsymbol{I} + 2c_1\\bar{\\boldsymbol{B}} - 2c_2\\bar{\\boldsymbol{B}}^{-1}\n$$\n\n第 2 部分：空间弹性张量 $\\mathbb{c}$ 的推导\n\n问题要求由关系式 $\\overset{\\nabla}{\\boldsymbol{\\tau}}_{\\text{iso}}=\\mathbb{c}:\\boldsymbol{d}$ 定义的空间弹性张量 $\\mathbb{c}$，其中 $\\overset{\\nabla}{(\\cdot)}$ 是 Jaumann 率。我们需要计算 $\\boldsymbol{\\tau}_{\\text{iso}}$ 的 Jaumann 率：\n$$\n\\overset{\\nabla}{\\boldsymbol{\\tau}}_{\\text{iso}} = \\overset{\\nabla}{(2c_1\\bar{\\boldsymbol{B}} - 2c_2\\bar{\\boldsymbol{B}}^{-1})} = 2c_1\\overset{\\nabla}{\\bar{\\boldsymbol{B}}} - 2c_2\\overset{\\nabla}{\\bar{\\boldsymbol{B}}^{-1}}\n$$\n问题提供了运动学恒等式 $\\overset{\\nabla}{\\bar{\\boldsymbol{B}}}=\\boldsymbol{d}\\,\\bar{\\boldsymbol{B}}+\\bar{\\boldsymbol{B}}\\,\\boldsymbol{d}-\\tfrac{2}{3}(\\mathrm{tr}\\,\\boldsymbol{d})\\,\\bar{\\boldsymbol{B}}$。对于不可压缩材料，$\\mathrm{tr}(\\boldsymbol{d})=0$。因此，该恒等式简化为：\n$$\n\\overset{\\nabla}{\\bar{\\boldsymbol{B}}} = \\boldsymbol{d}\\,\\bar{\\boldsymbol{B}} + \\bar{\\boldsymbol{B}}\\,\\boldsymbol{d}\n$$\n使用第二个恒等式 $\\overset{\\nabla}{\\bar{\\boldsymbol{B}}^{-1}} = -\\bar{\\boldsymbol{B}}^{-1}\\,\\overset{\\nabla}{\\bar{\\boldsymbol{B}}}\\,\\bar{\\boldsymbol{B}}^{-1}$，我们发现：\n$$\n\\overset{\\nabla}{\\bar{\\boldsymbol{B}}^{-1}} = -\\bar{\\boldsymbol{B}}^{-1}(\\boldsymbol{d}\\,\\bar{\\boldsymbol{B}} + \\bar{\\boldsymbol{B}}\\,\\boldsymbol{d})\\bar{\\boldsymbol{B}}^{-1} = -(\\bar{\\boldsymbol{B}}^{-1}\\boldsymbol{d} + \\boldsymbol{d}\\bar{\\boldsymbol{B}}^{-1})\n$$\n将这些率代入 $\\overset{\\nabla}{\\boldsymbol{\\tau}}_{\\text{iso}}$ 的表达式中：\n$$\n\\overset{\\nabla}{\\boldsymbol{\\tau}}_{\\text{iso}} = 2c_1(\\boldsymbol{d}\\,\\bar{\\boldsymbol{B}} + \\bar{\\boldsymbol{B}}\\,\\boldsymbol{d}) - 2c_2(-(\\bar{\\boldsymbol{B}}^{-1}\\boldsymbol{d} + \\boldsymbol{d}\\bar{\\boldsymbol{B}}^{-1}))\n$$\n$$\n\\overset{\\nabla}{\\boldsymbol{\\tau}}_{\\text{iso}} = 2c_1(\\boldsymbol{d}\\,\\bar{\\boldsymbol{B}} + \\bar{\\boldsymbol{B}}\\,\\boldsymbol{d}) + 2c_2(\\bar{\\boldsymbol{B}}^{-1}\\boldsymbol{d} + \\boldsymbol{d}\\bar{\\boldsymbol{B}}^{-1})\n$$\n现在我们必须使用并矢积定义 $(\\boldsymbol{A}\\otimes\\boldsymbol{C}):\\boldsymbol{X}=\\boldsymbol{A}\\,\\boldsymbol{X}\\,\\boldsymbol{C}^{\\mathsf{T}}$ 将此结果表示为 $\\mathbb{c}:\\boldsymbol{d}$ 的形式。鉴于 $\\boldsymbol{d}$ 和 $\\bar{\\boldsymbol{B}}$ 是对称的：\n项 $\\bar{\\boldsymbol{B}}\\boldsymbol{d}$ 可以写成 $(\\bar{\\boldsymbol{B}}\\otimes\\boldsymbol{I}):\\boldsymbol{d} = \\bar{\\boldsymbol{B}}\\boldsymbol{d}\\boldsymbol{I}^{\\mathsf{T}} = \\bar{\\boldsymbol{B}}\\boldsymbol{d}$。\n项 $\\boldsymbol{d}\\bar{\\boldsymbol{B}}$ 可以写成 $(\\boldsymbol{I}\\otimes\\bar{\\boldsymbol{B}}):\\boldsymbol{d} = \\boldsymbol{I}\\boldsymbol{d}\\bar{\\boldsymbol{B}}^{\\mathsf{T}} = \\boldsymbol{d}\\bar{\\boldsymbol{B}}$。\n将此应用于 $\\overset{\\nabla}{\\boldsymbol{\\tau}}_{\\text{iso}}$ 表达式中的所有项，得到：\n$$\n\\overset{\\nabla}{\\boldsymbol{\\tau}}_{\\text{iso}} = \\left[ 2c_1(\\boldsymbol{I}\\otimes\\bar{\\boldsymbol{B}} + \\bar{\\boldsymbol{B}}\\otimes\\boldsymbol{I}) + 2c_2(\\boldsymbol{I}\\otimes\\bar{\\boldsymbol{B}}^{-1} + \\bar{\\boldsymbol{B}}^{-1}\\otimes\\boldsymbol{I}) \\right] : \\boldsymbol{d}\n$$\n由此，我们确定四阶张量 $\\mathbb{c}$：\n$$\n\\mathbb{c} = 2c_1(\\boldsymbol{I}\\otimes\\bar{\\boldsymbol{B}} + \\bar{\\boldsymbol{B}}\\otimes\\boldsymbol{I}) + 2c_2(\\boldsymbol{I}\\otimes\\bar{\\boldsymbol{B}}^{-1} + \\bar{\\boldsymbol{B}}^{-1}\\otimes\\boldsymbol{I})\n$$\n然而，求和项的顺序对于最终表达式很重要。$\\boldsymbol{d}\\bar{\\boldsymbol{B}}+\\bar{\\boldsymbol{B}}\\boldsymbol{d} = (\\boldsymbol{I}\\otimes\\bar{\\boldsymbol{B}}):\\boldsymbol{d} + (\\bar{\\boldsymbol{B}}\\otimes\\boldsymbol{I}):\\boldsymbol{d}$。由于可加性，顺序并不关键。让我们重写表达式以更清晰地匹配推导步骤，避免错误：\n$\\overset{\\nabla}{\\boldsymbol{\\tau}}_{\\text{iso}} = 2c_1\\bar{\\boldsymbol{B}}\\boldsymbol{d} + 2c_1\\boldsymbol{d}\\bar{\\boldsymbol{B}} + 2c_2\\bar{\\boldsymbol{B}}^{-1}\\boldsymbol{d} + 2c_2\\boldsymbol{d}\\bar{\\boldsymbol{B}}^{-1}$。\n使用并矢积定义：\n$\\left( 2c_1(\\bar{\\boldsymbol{B}}\\otimes\\boldsymbol{I}) + 2c_1(\\boldsymbol{I}\\otimes\\bar{\\boldsymbol{B}}) + 2c_2(\\bar{\\boldsymbol{B}}^{-1}\\otimes\\boldsymbol{I}) + 2c_2(\\boldsymbol{I}\\otimes\\bar{\\boldsymbol{B}}^{-1}) \\right) : \\boldsymbol{d}$。\n因此张量 $\\mathbb{c}$ 是括号中的算子。\n$$\n\\mathbb{c} = 2c_1(\\bar{\\boldsymbol{B}}\\otimes\\boldsymbol{I} + \\boldsymbol{I}\\otimes\\bar{\\boldsymbol{B}}) + 2c_2(\\bar{\\boldsymbol{B}}^{-1}\\otimes\\boldsymbol{I} + \\boldsymbol{I}\\otimes\\bar{\\boldsymbol{B}}^{-1})\n$$\n这是空间弹性张量的最终表达式。", "answer": "$$\n\\boxed{\\begin{pmatrix} -p\\boldsymbol{I} + 2c_{1}\\bar{\\boldsymbol{B}} - 2c_{2}\\bar{\\boldsymbol{B}}^{-1} & 2c_{1}(\\bar{\\boldsymbol{B}}\\otimes\\boldsymbol{I} + \\boldsymbol{I}\\otimes\\bar{\\boldsymbol{B}}) + 2c_{2}(\\bar{\\boldsymbol{B}}^{-1}\\otimes\\boldsymbol{I} + \\boldsymbol{I}\\otimes\\bar{\\boldsymbol{B}}^{-1}) \\end{pmatrix}}\n$$", "id": "2545790"}, {"introduction": "在可压缩超弹性理论中，体积应变能函数 $U(J)$ 的选择是一项关键的建模决策，直接影响材料在大体积变形下的行为预测。本练习将探讨两种常见的体积能函数形式，并分析它们在强压缩下的响应差异。这个对比分析旨在强调，为特定的物理问题选择合适的本构模型是至关重要的。[@problem_id:2545813]", "problem": "一种可压缩的新胡克超弹性材料由应变能密度的标准等容-体积分裂建模\n$$\nW(\\mathbf{F}) \\;=\\; \\bar{W}(\\bar{\\mathbf{C}}) \\;+\\; U(J),\n$$\n其中 $\\mathbf{F}$ 是变形梯度，$\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$ 是右 Cauchy–Green 张量，$J = \\det \\mathbf{F}$ 是局部体积变化，而 $\\bar{\\mathbf{C}} = J^{-2/3} \\mathbf{C}$ 是等容右 Cauchy–Green 张量。在纯体积变形中，取 $\\mathbf{F} = J^{1/3} \\mathbf{I}$，其中 $J \\in (0,1)$ 代表体积压缩，并假设等容部分 $\\bar{W}$ 在这种纯体积状态下不产生应力（对于标准的可压缩新胡克等容项，情况正是如此）。\n\n从超弹性应力关系式\n$$\n\\boldsymbol{\\sigma} \\;=\\; \\frac{2}{J} \\,\\mathbf{F}\\,\\frac{\\partial W}{\\partial \\mathbf{C}}\\,\\mathbf{F}^{\\mathsf{T}},\n$$\n以及静水 Cauchy 应力 $\\boldsymbol{\\sigma} = -\\,p_{h}\\,\\mathbf{I}$（压缩时 $p_{h} > 0$）的定义出发，推导静水压力 $p_{h}(J)$ 仅用 $U(J)$ 表示的表达式。然后，考虑两种常见的体积能量选择\n$$\nU_{1}(J) \\;=\\; \\frac{\\kappa}{2}\\,\\big(\\ln J\\big)^{2}, \n\\qquad\nU_{2}(J) \\;=\\; \\frac{\\kappa}{2}\\,\\big(J - 1\\big)^{2},\n$$\n其中体积模量参数 $\\kappa > 0$。对于体积压缩水平 $J^{\\ast} = 0.5$，计算比率\n$$\nR \\;=\\; \\frac{p_{h}^{(1)}(J^{\\ast})}{p_{h}^{(2)}(J^{\\ast})},\n$$\n其中 $p_{h}^{(i)}$ 是对于 $i \\in \\{1,2\\}$ 从 $U_{i}$ 得到的静水压力。将您的最终答案表示为精确表达式（不要近似），并注意 $R$ 是无量纲的。最终答案无需单位。", "solution": "此问题要求推导静水压力 $p_{h}$ 的表达式，并计算两种不同体积应变能函数下的压力比率。\n\n首先，我们确认问题陈述。给定的条件如下：\n应变能密度函数：$W(\\mathbf{F}) = \\bar{W}(\\bar{\\mathbf{C}}) + U(J)$。\n右 Cauchy-Green 张量：$\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$。\n变形梯度的行列式：$J = \\det \\mathbf{F}$。\n等容右 Cauchy-Green 张量：$\\bar{\\mathbf{C}} = J^{-2/3} \\mathbf{C}$。\nCauchy 应力张量：$\\boldsymbol{\\sigma} = \\frac{2}{J} \\mathbf{F} \\frac{\\partial W}{\\partial \\mathbf{C}} \\mathbf{F}^{\\mathsf{T}}$。\n对于纯体积变形：$\\mathbf{F} = J^{1/3} \\mathbf{I}$，其中 $J \\in (0,1)$，相应的 Cauchy 应力为静水应力，$\\boldsymbol{\\sigma} = -p_{h} \\mathbf{I}$，压力 $p_{h} > 0$。\n一个关键假设是，应变能的等容部分 $\\bar{W}$ 在此状态下不产生应力。\n给定了两种体积能量函数：$U_{1}(J) = \\frac{\\kappa}{2} (\\ln J)^{2}$ 和 $U_{2}(J) = \\frac{\\kappa}{2} (J - 1)^{2}$，其中体积模量 $\\kappa > 0$。\n问题要求在特定压缩水平 $J^{\\ast} = 0.5$ 下的比率 $R = \\frac{p_{h}^{(1)}(J^{\\ast})}{p_{h}^{(2)}(J^{\\ast})}$。\n\n该问题在科学上基于有限弹性理论，提法明确、客观且自洽。没有矛盾或谬误。所提供的模型是计算力学中的标准模型。该问题被认为是有效的，并将提供解答。\n\n推导从给定的 Cauchy 应力 $\\boldsymbol{\\sigma}$ 的表达式开始。我们将分解的应变能函数 $W = \\bar{W} + U$ 代入应力关系式中：\n$$\n\\boldsymbol{\\sigma} \\;=\\; \\frac{2}{J} \\,\\mathbf{F}\\,\\frac{\\partial (\\bar{W} + U)}{\\partial \\mathbf{C}}\\,\\mathbf{F}^{\\mathsf{T}} \\;=\\; \\frac{2}{J} \\,\\mathbf{F}\\,\\frac{\\partial \\bar{W}}{\\partial \\mathbf{C}}\\,\\mathbf{F}^{\\mathsf{T}} \\;+\\; \\frac{2}{J} \\,\\mathbf{F}\\,\\frac{\\partial U}{\\partial \\mathbf{C}}\\,\\mathbf{F}^{\\mathsf{T}}\n$$\n该表达式表明总应力张量 $\\boldsymbol{\\sigma}$ 可以分解为等容部分 $\\boldsymbol{\\sigma}_{\\text{iso}}$ 和体积部分 $\\boldsymbol{\\sigma}_{\\text{vol}}$：\n$$\n\\boldsymbol{\\sigma}_{\\text{iso}} = \\frac{2}{J} \\,\\mathbf{F}\\,\\frac{\\partial \\bar{W}}{\\partial \\mathbf{C}}\\,\\mathbf{F}^{\\mathsf{T}}, \\qquad \\boldsymbol{\\sigma}_{\\text{vol}} = \\frac{2}{J} \\,\\mathbf{F}\\,\\frac{\\partial U}{\\partial \\mathbf{C}}\\,\\mathbf{F}^{\\mathsf{T}}\n$$\n问题陈述指出，对于纯体积变形，等容部分 $\\bar{W}$ 不产生应力。这意味着在所讨论的状态下 $\\boldsymbol{\\sigma}_{\\text{iso}} = \\mathbf{0}$。因此，总应力是纯体积的：$\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}_{\\text{vol}}$。\n\n现在我们专注于推导体积应力 $\\boldsymbol{\\sigma}_{\\text{vol}}$ 的表达式。能量函数 $U$ 仅通过标量 $J = (\\det \\mathbf{C})^{1/2}$ 依赖于 $\\mathbf{C}$。我们应用链式法则来求 $U$ 对 $\\mathbf{C}$ 的导数：\n$$\n\\frac{\\partial U}{\\partial \\mathbf{C}} \\;=\\; \\frac{dU}{dJ} \\frac{\\partial J}{\\partial \\mathbf{C}}\n$$\n我们将普通导数 $\\frac{dU}{dJ}$ 记为 $U'(J)$。$J$ 对 $\\mathbf{C}$ 的导数是张量微积分中的一个标准结果：\n$$\n\\frac{\\partial J}{\\partial \\mathbf{C}} \\;=\\; \\frac{\\partial (\\det \\mathbf{C})^{1/2}}{\\partial \\mathbf{C}} \\;=\\; \\frac{1}{2} (\\det \\mathbf{C})^{-1/2} \\frac{\\partial (\\det \\mathbf{C})}{\\partial \\mathbf{C}}\n$$\n使用 Jacobi 公式，$\\frac{\\partial (\\det \\mathbf{C})}{\\partial \\mathbf{C}} = (\\det \\mathbf{C})\\,\\mathbf{C}^{-1} = J^{2}\\,\\mathbf{C}^{-1}$。将其代回可得：\n$$\n\\frac{\\partial J}{\\partial \\mathbf{C}} \\;=\\; \\frac{1}{2} J^{-1} (J^{2}\\,\\mathbf{C}^{-1}) \\;=\\; \\frac{1}{2} J \\mathbf{C}^{-1}\n$$\n因此，$U$ 对 $\\mathbf{C}$ 的导数为：\n$$\n\\frac{\\partial U}{\\partial \\mathbf{C}} \\;=\\; U'(J) \\left( \\frac{1}{2} J \\mathbf{C}^{-1} \\right) \\;=\\; \\frac{1}{2} J U'(J) \\mathbf{C}^{-1}\n$$\n现在我们将此结果代入体积应力 $\\boldsymbol{\\sigma}_{\\text{vol}}$ 的表达式中：\n$$\n\\boldsymbol{\\sigma}_{\\text{vol}} \\;=\\; \\frac{2}{J} \\,\\mathbf{F}\\, \\left( \\frac{1}{2} J U'(J) \\mathbf{C}^{-1} \\right) \\,\\mathbf{F}^{\\mathsf{T}} \\;=\\; U'(J) \\,\\mathbf{F}\\,\\mathbf{C}^{-1}\\,\\mathbf{F}^{\\mathsf{T}}\n$$\n使用定义 $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}}\\mathbf{F}$，其逆为 $\\mathbf{C}^{-1} = (\\mathbf{F}^{\\mathsf{T}}\\mathbf{F})^{-1} = \\mathbf{F}^{-1}\\mathbf{F}^{-\\mathsf{T}}$。代入可得：\n$$\n\\boldsymbol{\\sigma}_{\\text{vol}} \\;=\\; U'(J) \\,\\mathbf{F}\\, (\\mathbf{F}^{-1}\\mathbf{F}^{-\\mathsf{T}}) \\,\\mathbf{F}^{\\mathsf{T}} \\;=\\; U'(J) \\,(\\mathbf{F}\\mathbf{F}^{-1}) (\\mathbf{F}^{-\\mathsf{T}}\\mathbf{F}^{\\mathsf{T}}) \\;=\\; U'(J) \\,\\mathbf{I}\\,\\mathbf{I} \\;=\\; U'(J)\\,\\mathbf{I}\n$$\n所以，纯体积变形下的总应力为 $\\boldsymbol{\\sigma} = U'(J)\\,\\mathbf{I}$。问题也指定了应力是静水应力，$\\boldsymbol{\\sigma} = -p_{h}\\,\\mathbf{I}$。令这两个表达式相等，可得到静水压力 $p_{h}$ 和体积能量函数 $U(J)$ 之间的关系：\n$$\nU'(J)\\,\\mathbf{I} \\;=\\; -p_{h}\\,\\mathbf{I} \\quad \\implies \\quad p_{h}(J) = -U'(J)\n$$\n这是静水压力的通用表达式。接下来，我们将此结果应用于所提供的两个特定能量函数。\n\n对于第一个函数，$U_{1}(J) = \\frac{\\kappa}{2} (\\ln J)^{2}$：\n其对 $J$ 的导数为：\n$$\nU_{1}'(J) \\;=\\; \\frac{d}{dJ} \\left[ \\frac{\\kappa}{2} (\\ln J)^{2} \\right] \\;=\\; \\frac{\\kappa}{2} \\cdot 2 (\\ln J) \\cdot \\frac{1}{J} \\;=\\; \\frac{\\kappa \\ln J}{J}\n$$\n相应的静水压力为：\n$$\np_{h}^{(1)}(J) \\;=\\; -U_{1}'(J) \\;=\\; -\\frac{\\kappa \\ln J}{J}\n$$\n对于第二个函数，$U_{2}(J) = \\frac{\\kappa}{2} (J - 1)^{2}$：\n其对 $J$ 的导数为：\n$$\nU_{2}'(J) \\;=\\; \\frac{d}{dJ} \\left[ \\frac{\\kappa}{2} (J - 1)^{2} \\right] \\;=\\; \\frac{\\kappa}{2} \\cdot 2 (J - 1) \\;=\\; \\kappa(J - 1)\n$$\n相应的静水压力为：\n$$\np_{h}^{(2)}(J) \\;=\\; -U_{2}'(J) \\;=\\; -\\kappa(J - 1) \\;=\\; \\kappa(1 - J)\n$$\n问题要求在压缩水平 $J^{\\ast} = 0.5$ 时这些压力的比率。首先，我们计算每个压力在此值处的大小。\n对于 $p_{h}^{(1)}$：\n$$\np_{h}^{(1)}(J^{\\ast}) \\;=\\; p_{h}^{(1)}(0.5) \\;=\\; -\\frac{\\kappa \\ln(0.5)}{0.5} \\;=\\; -2\\kappa \\ln(0.5)\n$$\n使用对数性质 $\\ln(0.5) = \\ln(1/2) = -\\ln(2)$，我们有：\n$$\np_{h}^{(1)}(0.5) \\;=\\; -2\\kappa (-\\ln 2) \\;=\\; 2\\kappa \\ln(2)\n$$\n对于 $p_{h}^{(2)}$：\n$$\np_{h}^{(2)}(J^{\\ast}) \\;=\\; p_{h}^{(2)}(0.5) \\;=\\; \\kappa(1 - 0.5) \\;=\\; \\kappa(0.5) \\;=\\; \\frac{\\kappa}{2}\n$$\n最后，我们计算所要求的比率 $R$：\n$$\nR \\;=\\; \\frac{p_{h}^{(1)}(J^{\\ast})}{p_{h}^{(2)}(J^{\\ast})} \\;=\\; \\frac{2\\kappa \\ln(2)}{\\frac{\\kappa}{2}}\n$$\n体积模量参数 $\\kappa$ 被消去，这对于无量纲比率是符合预期的：\n$$\nR \\;=\\; \\frac{2 \\ln(2)}{1/2} \\;=\\; 4 \\ln(2)\n$$\n这就是比率的最终精确表达式。", "answer": "$$\n\\boxed{4 \\ln(2)}\n$$", "id": "2545813"}, {"introduction": "将本构理论应用于有限元分析时，常会遇到诸如“体积锁定”之类的数值难题，尤其是在处理近不可压缩材料时。本实践将通过一个编码练习，演示如何通过分析单元刚度矩阵的特征值来诊断锁定现象。您将进一步实现并验证一种名为“选择性减缩积分”的经典技术，以有效克服此问题，从而确保模拟结果的准确性。[@problem_id:2545811]", "problem": "在有限元法 (FEM) 的背景下，考虑一个具有 $8$ 个节点（一个 $8$ 节点砖块单元）的单个三维三线性六面体单元。该材料是可压缩的超弹性 neo-Hookean 材料，分析在未变形构型和小应变条件下进行，以允许一致的切线线性化。请使用虚功原理和超弹性的定义作为基本依据。\n\n从超弹性的虚功原理出发，对于一个占据参考区域坐标为 $\\mathbf{X}$ 的物体，其内虚功是总应变能的变分。在未变形构型附近的小应变情况下，一致性切线简化为一个各向同性的线性映射，其中应变能密度的偏量部分和体积部分是分离的。在此体系中，设剪切模量为 $\\mu$，体积模量为 $\\kappa$，应力响应算子解耦为一个由 $\\mu$ 加权的偏量部分和一个由 $\\kappa$ 加权的体积部分，作用于小应变张量上。您必须使用参考构型下的这个小应变切线来组装单元刚度矩阵。\n\n设单元占据一个边长为 $L_x$、$L_y$、$L_z$ 且与坐标轴对齐的长方体。位移场在等参域 $\\{(\\xi,\\eta,\\zeta)\\in[-1,1]^3\\}$ 中使用三线性形函数进行插值。使用标准的 $6$ 分量工程应变向量 $\\boldsymbol{\\varepsilon} = [\\varepsilon_{11},\\varepsilon_{22},\\varepsilon_{33},\\gamma_{23},\\gamma_{13},\\gamma_{12}]^\\top$，其中对于 $i\\neq j$，$\\gamma_{ij} = 2 \\varepsilon_{ij}$。单元刚度为\n$$\n\\mathbf{K} = \\int_{\\Omega_0} \\mathbf{B}^\\top \\mathbf{C} \\,\\mathbf{B}\\, \\mathrm{d}V,\n$$\n其中 $\\mathbf{B}$ 是 $8$ 节点砖块单元的标准应变-位移矩阵，$\\mathbf{C}$ 是未变形状态下的小应变切线，它可以加性分离为一个偏量算子和一个体积算子。\n\n您的任务是实现三种积分方案来组装 $\\mathbf{K}$：\n- 方案 $\\mathsf{full}$：对体积和偏量部分均使用完全积分，采用 $2\\times 2\\times 2$ 个 Gauss 点，在每个方向上点的位置为 $\\xi,\\eta,\\zeta \\in \\{\\pm 1/\\sqrt{3}\\}$，权重为单位权重。\n- 方案 $\\mathsf{reduced}$：对整个刚度使用单点减缩积分，采用位于 $(\\xi,\\eta,\\zeta)=(0,0,0)$ 的单个 Gauss 点，在每个方向上的权重为 $2$（三维空间中总权重为 $8$）。\n- 方案 $\\mathsf{sri}$（选择性减缩积分）：对偏量部分使用如 $\\mathsf{full}$ 方案中的完全积分，对体积部分使用如 $\\mathsf{reduced}$ 方案中的单点减缩积分。\n\n通过计算一个自由单元（即没有本质边界条件）组装的单元刚度矩阵 $\\mathbf{K}$ 的特征值，来分析对沙漏模式的影响。在一个一致的小应变公式中，刚体运动贡献了零能模式。当积分不足无法捕捉所有应变模式时，沙漏模式会作为额外的伪零能模式出现。为了量化这一点，设 $\\lambda_i$ 为 $\\mathbf{K}$ 的特征值，并将一个近零特征值定义为幅值小于容差 $\\tau$ 的特征值，其中\n$$\n\\tau = \\max\\left(10^{-7} \\max_i \\lambda_i,\\; 10^{-12}\\right).\n$$\n计算绝对值小于或等于 $\\tau$ 的特征值的数量。\n\n实现一个完整、可运行的程序，该程序：\n- 使用在未变形状态下分为体积和偏量部分的小应变切线，以及上述指定的适当积分法则，为每种方案构建 $8$ 节点砖块单元的刚度矩阵 $\\mathbf{K}$。\n- 计算 $\\mathbf{K}$ 的特征值，并对每个测试用例计算近零特征值的数量，作为零能模式（刚体运动加上可能的沙漏模式）的度量。\n\n最终的整数计数不需要物理输出单位。不涉及角度。所有计算必须在任何选定的单位系统中保持内部一致。\n\n测试套件：\n- 用例 1：$\\mu = 8.0\\times 10^{4}$，$\\kappa = 1.6\\times 10^{5}$，$L_x=1$，$L_y=1$，$L_z=1$，方案 $\\mathsf{full}$。\n- 用例 2：与用例 1 参数相同，方案 $\\mathsf{reduced}$。\n- 用例 3：与用例 1 参数相同，方案 $\\mathsf{sri}$。\n- 用例 4：$\\mu = 8.0\\times 10^{4}$，$\\kappa = 1.6\\times 10^{5}$，$L_x=2$，$L_y=1$，$L_z=0.5$，方案 $\\mathsf{sri}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[r_1,r_2,r_3,r_4]$），其中 $r_j$ 是按上面列出的顺序对应用例 $j$ 的近零特征值的整数数量。", "solution": "所述问题具有科学依据、是适定的、客观的，并包含了解决所需的所有必要信息。它代表了有限元法理论与应用中的一个标准且基础的练习。我们着手进行求解。\n\n分析的基础是虚功原理，对于超弹性材料，该原理指出内虚功是总应变能的变分，即 $\\delta W_{int} = \\delta \\Pi$。刚度矩阵 $\\mathbf{K}$ 关联了节点力与节点位移，是通过应变能势的二次变分得到的。对于单个有限单元，这给出了表达式：\n$$\n\\mathbf{K} = \\frac{\\partial^2 \\Pi}{\\partial \\mathbf{d}^2} = \\int_{\\Omega_0} \\mathbf{B}^\\top \\mathbf{C} \\mathbf{B} \\, \\mathrm{d}V\n$$\n其中 $\\mathbf{d}$ 是节点位移向量，$\\Omega_0$ 是单元在参考构型中的体积，$\\mathbf{B}$ 是应变-位移矩阵，$\\mathbf{C}$ 是本构切线模量。问题指定了在未变形状态下的小应变公式，此时 $\\mathbf{C}$ 成为标准的各向同性线弹性张量。\n\n解决方案需要三部分的构建：\n1. 本构矩阵 $\\mathbf{C}$ 的公式及其分解。\n2. 8 节点六面体单元的应变-位移矩阵 $\\mathbf{B}$ 的公式。\n3. 使用指定的积分方案对刚度矩阵 $\\mathbf{K}$ 进行数值积分。\n最后，对得到的矩阵 $\\mathbf{K}$ 进行特征值分析，以确定零能模式的数量。\n\n**1. 本构矩阵 $\\mathbf{C}$**\n\n对于各向同性线弹性材料，本构矩阵 $\\mathbf{C}$ 将工程应变向量 $\\boldsymbol{\\varepsilon} = [\\varepsilon_{11}, \\varepsilon_{22}, \\varepsilon_{33}, \\gamma_{23}, \\gamma_{13}, \\gamma_{12}]^\\top$ 映射到应力向量 $\\boldsymbol{\\sigma}$。该矩阵由剪切模量 $\\mu$ 和体积模量 $\\kappa$ 定义。\n\n应变能可加性地分解为偏量和体积部分。这导致本构矩阵的加性分解：$\\mathbf{C} = \\mathbf{C}_{\\text{dev}} + \\mathbf{C}_{\\text{vol}}$。\n\n体积部分与体积应变 $\\varepsilon_v = \\varepsilon_{11} + \\varepsilon_{22} + \\varepsilon_{33}$ 相关。在向量形式中，$\\varepsilon_v = \\mathbf{m}^\\top \\boldsymbol{\\varepsilon}$，其中 $\\mathbf{m} = [1, 1, 1, 0, 0, 0]^\\top$。本构矩阵的体积部分是：\n$$\n\\mathbf{C}_{\\text{vol}} = \\kappa \\mathbf{m} \\mathbf{m}^\\top = \\kappa \\begin{bmatrix} 1 & 1 & 1 & 0 & 0 & 0 \\\\ 1 & 1 & 1 & 0 & 0 & 0 \\\\ 1 & 1 & 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 & 0 & 0 \\end{bmatrix}\n$$\n完整的各向同性本构矩阵 $\\mathbf{C}$ 由下式给出：\n$$\n\\mathbf{C} = \\begin{bmatrix} \\kappa + \\frac{4}{3}\\mu & \\kappa - \\frac{2}{3}\\mu & \\kappa - \\frac{2}{3}\\mu & 0 & 0 & 0 \\\\ \\kappa - \\frac{2}{3}\\mu & \\kappa + \\frac{4}{3}\\mu & \\kappa - \\frac{2}{3}\\mu & 0 & 0 & 0 \\\\ \\kappa - \\frac{2}{3}\\mu & \\kappa - \\frac{2}{3}\\mu & \\kappa + \\frac{4}{3}\\mu & 0 & 0 & 0 \\\\ 0 & 0 & 0 & \\mu & 0 & 0 \\\\ 0 & 0 & 0 & 0 & \\mu & 0 \\\\ 0 & 0 & 0 & 0 & 0 & \\mu \\end{bmatrix}\n$$\n然后，偏量部分是 $\\mathbf{C}_{\\text{dev}} = \\mathbf{C} - \\mathbf{C}_{\\text{vol}}$：\n$$\n\\mathbf{C}_{\\text{dev}} = \\mu \\begin{bmatrix} 4/3 & -2/3 & -2/3 & 0 & 0 & 0 \\\\ -2/3 & 4/3 & -2/3 & 0 & 0 & 0 \\\\ -2/3 & -2/3 & 4/3 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 0 & 0 & 1 \\end{bmatrix}\n$$\n\n**2. 应变-位移矩阵 $\\mathbf{B}$**\n\n位移场 $\\mathbf{u}(\\mathbf{X})$ 是通过三线性形函数 $N_i(\\xi, \\eta, \\zeta)$ 从节点位移 $\\mathbf{d}$ 插值得到的：\n$$\n\\mathbf{u}(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) \\mathbf{u}_i\n$$\n节点 $i$ 的形函数，其等参坐标为 $(\\xi_i, \\eta_i, \\zeta_i) \\in \\{-1, 1\\}^3$，是：\n$$\nN_i(\\xi, \\eta, \\zeta) = \\frac{1}{8}(1+\\xi_i\\xi)(1+\\eta_i\\eta)(1+\\zeta_i\\zeta)\n$$\n应变-位移矩阵 $\\mathbf{B}$ 由 $\\boldsymbol{\\varepsilon} = \\mathbf{B}\\mathbf{d}$ 定义。它是一个 $6\\times24$ 的矩阵，由对应每个节点的 $8$ 个块 $\\mathbf{B}_i$（每个为 $6\\times3$）组成：$\\mathbf{B} = [\\mathbf{B}_1, \\mathbf{B}_2, \\ldots, \\mathbf{B}_8]$。每个块 $\\mathbf{B}_i$ 由形函数 $N_i$ 的空间导数构建：\n$$\n\\mathbf{B}_i = \\begin{bmatrix} \\frac{\\partial N_i}{\\partial x} & 0 & 0 \\\\ 0 & \\frac{\\partial N_i}{\\partial y} & 0 \\\\ 0 & 0 & \\frac{\\partial N_i}{\\partial z} \\\\ 0 & \\frac{\\partial N_i}{\\partial z} & \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial z} & 0 & \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x} & 0 \\end{bmatrix}\n$$\n空间导数通过链式法则，使用从等参坐标到物理坐标映射的 Jacobian 矩阵求得：\n$$\n\\begin{Bmatrix} \\partial N_i/\\partial x \\\\ \\partial N_i/\\partial y \\\\ \\partial N_i/\\partial z \\end{Bmatrix} = \\mathbf{J}^{-1} \\begin{Bmatrix} \\partial N_i/\\partial \\xi \\\\ \\partial N_i/\\partial \\eta \\\\ \\partial N_i/\\partial \\zeta \\end{Bmatrix}\n$$\n对于以原点为中心、尺寸为 $L_x, L_y, L_z$ 的长方体，映射为 $x = L_x\\xi/2, y = L_y\\eta/2, z = L_z\\zeta/2$。Jacobian 矩阵是对角且恒定的：\n$$\n\\mathbf{J} = \\begin{bmatrix} L_x/2 & 0 & 0 \\\\ 0 & L_y/2 & 0 \\\\ 0 & 0 & L_z/2 \\end{bmatrix} \\implies \\mathbf{J}^{-1} = \\begin{bmatrix} 2/L_x & 0 & 0 \\\\ 0 & 2/L_y & 0 \\\\ 0 & 0 & 2/L_z \\end{bmatrix}\n$$\n积分的体积元是 $\\mathrm{d}V = \\det(\\mathbf{J})\\mathrm{d}\\xi\\mathrm{d}\\eta\\mathrm{d}\\zeta = \\frac{L_x L_y L_z}{8} \\mathrm{d}\\xi\\mathrm{d}\\eta\\mathrm{d}\\zeta$。\n\n**3. 刚度矩阵 $\\mathbf{K}$ 的数值积分**\n\n$\\mathbf{K}$ 的积分使用 Gauss 积分进行数值计算：\n$$\n\\mathbf{K} = \\int_{-1}^1\\int_{-1}^1\\int_{-1}^1 \\mathbf{B}(\\xi,\\eta,\\zeta)^\\top \\mathbf{C} \\mathbf{B}(\\xi,\\eta,\\zeta) \\det(\\mathbf{J}) \\mathrm{d}\\xi\\mathrm{d}\\eta\\mathrm{d}\\zeta \\approx \\sum_{k} w_k \\mathbf{B}(\\xi_k, \\eta_k, \\zeta_k)^\\top \\mathbf{C} \\mathbf{B}(\\xi_k, \\eta_k, \\zeta_k) \\det(\\mathbf{J})\n$$\n其中 $(\\xi_k, \\eta_k, \\zeta_k)$ 是 Gauss 点， $w_k$ 是对应的权重。\n\n- 方案 $\\mathsf{full}$：使用 $2\\times2\\times2$ 的 Gauss 积分。有 $8$ 个点位于 $(\\xi, \\eta, \\zeta) \\in \\{\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3}\\}$，每个点的权重 $w_k=1$。该法则足以精确积分矩形单元的刚度矩阵。预计将产生 $6$ 个零能模式，对应于 $3$ 个刚体平移和 $3$ 个刚体旋转。\n\n- 方案 $\\mathsf{reduced}$：对整个矩阵使用位于 $(\\xi, \\eta, \\zeta)=(0,0,0)$ 的单个 Gauss 点，权重 $w_k=8$。该方案计算效率高，但无法检测到在单元中心产生零应变的某些变形模式（沙漏模式）。对于 $8$ 节点砖块单元，这会导致除了 $6$ 个刚体模式外，还有 $5$ 个伪零能模式，总共 $11$ 个。\n\n- 方案 $\\mathsf{sri}$ (选择性减缩积分)：刚度矩阵被拆分：$\\mathbf{K} = \\mathbf{K}_{\\text{dev}} + \\mathbf{K}_{\\text{vol}}$。\n  - $\\mathbf{K}_{\\text{dev}} = \\int \\mathbf{B}^\\top \\mathbf{C}_{\\text{dev}} \\mathbf{B} \\,\\mathrm{d}V$ 使用 `full` $2\\times2\\times2$ 方案进行积分。\n  - $\\mathbf{K}_{\\text{vol}} = \\int \\mathbf{B}^\\top \\mathbf{C}_{\\text{vol}} \\mathbf{B} \\,\\mathrm{d}V$ 使用 `reduced` 单点方案进行积分。\n该技术用于防止近不可压缩材料中的体积锁定，同时保持足够的秩以抵抗沙漏。对偏量部分的完全积分提供了抵抗剪切沙漏模式的刚度。此方案预计只产生 $6$ 个真实的刚体零能模式。\n\n**4. 特征值分析**\n\n为每种情况组装好 $\\mathbf{K}$ 后，计算其特征值 $\\lambda_i$。近零特征值的数量对应于零能模式的数量。如果一个特征值的幅值小于容差 $\\tau = \\max(10^{-7} \\max_i \\lambda_i, 10^{-12})$，则认为它是近零的。这种双重相对/绝对容差能正确识别浮点计算中的数值零。矩阵 $\\mathbf{K}$ 是对称正半定的，所以其特征值是实数且非负。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that orchestrates the FEM analysis for the given test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1: mu, kappa, Lx, Ly, Lz, scheme\n        (8.0e4, 1.6e5, 1.0, 1.0, 1.0, 'full'),\n        # Case 2\n        (8.0e4, 1.6e5, 1.0, 1.0, 1.0, 'reduced'),\n        # Case 3\n        (8.0e4, 1.6e5, 1.0, 1.0, 1.0, 'sri'),\n        # Case 4\n        (8.0e4, 1.6e5, 2.0, 1.0, 0.5, 'sri'),\n    ]\n\n    results = []\n    for mu, kappa, Lx, Ly, Lz, scheme in test_cases:\n        K = assemble_stiffness_matrix(mu, kappa, Lx, Ly, Lz, scheme)\n        \n        # Eigenvalue analysis\n        # K is symmetric, use eigvalsh for efficiency and stability\n        eigenvalues = np.linalg.eigvalsh(K)\n        \n        # As K is positive-semidefinite, max(abs(lambda)) is just the max eigenvalue.\n        max_eig = eigenvalues[-1]\n        tolerance = max(1e-7 * max_eig, 1e-12)\n        \n        # Count near-zero eigenvalues\n        zero_modes_count = np.sum(eigenvalues <= tolerance)\n        results.append(zero_modes_count)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef get_constitutive_matrices(mu, kappa):\n    \"\"\"\n    Constructs the deviatoric and volumetric parts of the constitutive matrix C.\n    \"\"\"\n    C_vol = np.zeros((6, 6))\n    m = np.array([1.0, 1.0, 1.0, 0.0, 0.0, 0.0])\n    C_vol = kappa * np.outer(m, m)\n\n    C_dev = np.zeros((6, 6))\n    C_dev[0, 0] = C_dev[1, 1] = C_dev[2, 2] = 4.0 / 3.0 * mu\n    C_dev[0, 1] = C_dev[1, 0] = C_dev[0, 2] = C_dev[2, 0] = C_dev[1, 2] = C_dev[2, 1] = -2.0 / 3.0 * mu\n    C_dev[3, 3] = C_dev[4, 4] = C_dev[5, 5] = mu\n    \n    return C_dev, C_vol\n\ndef get_shape_func_derivatives(xi, eta, zeta, node_iso_coords):\n    \"\"\"\n    Computes derivatives of 8-node hex shape functions w.r.t. isoparametric coordinates.\n    \"\"\"\n    dN_dxi_eta_zeta = np.zeros((8, 3))\n    for i in range(8):\n        xi_i, eta_i, zeta_i = node_iso_coords[i]\n        dN_dxi_eta_zeta[i, 0] = 0.125 * xi_i * (1 + eta_i * eta) * (1 + zeta_i * zeta)\n        dN_dxi_eta_zeta[i, 1] = 0.125 * eta_i * (1 + xi_i * xi) * (1 + zeta_i * zeta)\n        dN_dxi_eta_zeta[i, 2] = 0.125 * zeta_i * (1 + xi_i * xi) * (1 + eta_i * eta)\n    return dN_dxi_eta_zeta\n\ndef get_B_matrix(dN_dxi_eta_zeta, Lx, Ly, Lz):\n    \"\"\"\n    Constructs the strain-displacement matrix B.\n    \"\"\"\n    J_inv_diag = np.array([2.0 / Lx, 2.0 / Ly, 2.0 / Lz])\n    dN_dxyz = dN_dxi_eta_zeta @ np.diag(J_inv_diag)\n\n    B = np.zeros((6, 24))\n    for i in range(8):\n        # Derivatives for node i in x, y, z\n        dN_dx_i = dN_dxyz[i, 0]\n        dN_dy_i = dN_dxyz[i, 1]\n        dN_dz_i = dN_dxyz[i, 2]\n        \n        # Populate the B matrix for node i (columns 3*i, 3*i+1, 3*i+2)\n        B[0, 3 * i] = dN_dx_i\n        B[1, 3 * i + 1] = dN_dy_i\n        B[2, 3 * i + 2] = dN_dz_i\n        B[3, 3 * i + 1] = dN_dz_i\n        B[3, 3 * i + 2] = dN_dy_i\n        B[4, 3 * i] = dN_dz_i\n        B[4, 3 * i + 2] = dN_dx_i\n        B[5, 3 * i] = dN_dy_i\n        B[5, 3 * i + 1] = dN_dx_i\n        \n    return B\n\ndef assemble_stiffness_matrix(mu, kappa, Lx, Ly, Lz, scheme):\n    \"\"\"\n    Assembles the element stiffness matrix K using the specified quadrature scheme.\n    \"\"\"\n    K = np.zeros((24, 24))\n    det_J = Lx * Ly * Lz / 8.0\n\n    # Isoparametric coordinates of the 8 nodes\n    node_iso_coords = np.array([\n        [-1, -1, -1], [1, -1, -1], [1, 1, -1], [-1, 1, -1],\n        [-1, -1, 1], [1, -1, 1], [1, 1, 1], [-1, 1, 1]\n    ])\n\n    C_dev, C_vol = get_constitutive_matrices(mu, kappa)\n\n    # Define Gauss quadrature points and weights\n    a = 1.0 / np.sqrt(3.0)\n    gp_8pt = [\n        (-a, -a, -a), ( a, -a, -a), ( a,  a, -a), (-a,  a, -a),\n        (-a, -a,  a), ( a, -a,  a), ( a,  a,  a), (-a,  a,  a)\n    ]\n    w_8pt = [1.0] * 8\n\n    gp_1pt = [(0.0, 0.0, 0.0)]\n    w_1pt = [8.0]\n\n    if scheme == 'full':\n        C = C_dev + C_vol\n        for i, (xi, eta, zeta) in enumerate(gp_8pt):\n            dN = get_shape_func_derivatives(xi, eta, zeta, node_iso_coords)\n            B = get_B_matrix(dN, Lx, Ly, Lz)\n            K += w_8pt[i] * B.T @ C @ B * det_J\n\n    elif scheme == 'reduced':\n        C = C_dev + C_vol\n        xi, eta, zeta = gp_1pt[0]\n        dN = get_shape_func_derivatives(xi, eta, zeta, node_iso_coords)\n        B = get_B_matrix(dN, Lx, Ly, Lz)\n        K += w_1pt[0] * B.T @ C @ B * det_J\n\n    elif scheme == 'sri':\n        # Deviatoric part with full integration\n        K_dev = np.zeros((24, 24))\n        for i, (xi, eta, zeta) in enumerate(gp_8pt):\n            dN = get_shape_func_derivatives(xi, eta, zeta, node_iso_coords)\n            B = get_B_matrix(dN, Lx, Ly, Lz)\n            K_dev += w_8pt[i] * B.T @ C_dev @ B * det_J\n        \n        # Volumetric part with reduced integration\n        K_vol = np.zeros((24, 24))\n        xi, eta, zeta = gp_1pt[0]\n        dN = get_shape_func_derivatives(xi, eta, zeta, node_iso_coords)\n        B = get_B_matrix(dN, Lx, Ly, Lz)\n        K_vol += w_1pt[0] * B.T @ C_vol @ B * det_J\n        \n        K = K_dev + K_vol\n        \n    return K\n\n# Execute the solver\nsolve()\n```", "id": "2545811"}]}