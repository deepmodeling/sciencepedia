{"hands_on_practices": [{"introduction": "当我们为有限元模型引入额外的自由度（如钻孔转动）及其稳定化项时，一个首要原则是不能在刚体运动中引入虚假的能量。任何有效的稳定化方案都必须对刚体运动“免疫”，否则单元将表现出非物理的刚度。本练习将引导你从第一性原理出发，推导出一个通用的二次稳定化能量密度需要满足的代数条件，以确保单元在经历纯刚体旋转时，不会产生任何内部节点力或力矩 [@problem_id:2552865]。这项推导揭示了许多成功的钻孔自由度处理方法背后的核心数学结构。", "problem": "考虑一个由单个等参有限元离散化的平面线性弹性连续体，其节点位移向量为 $\\mathbf{d}_{u}$（集合了所有面内平移自由度），以及一个独立的、由相同单元形函数 $\\{N_{i}(\\mathbf{x})\\}_{i=1}^{n}$ 插值的标量钻孔转动场 $\\varphi(\\mathbf{x})$。设连续体（材料）绕面外轴的转动定义为 $\\omega_z(\\mathbf{x}) = \\tfrac{1}{2}\\left(\\frac{\\partial u_{y}}{\\partial x} - \\frac{\\partial u_{x}}{\\partial y}\\right)$，其中 $(u_{x},u_{y})$ 是面内位移分量。该单元通过以下在单元域 $\\Omega^{e}$ 上为常数的二次能量密度进行稳定：\n$$\nw_{\\mathrm{stab}}(\\mathbf{x}) \\;=\\; \\tfrac{1}{2}\\,a\\,\\varphi^{2} \\;+\\; \\tfrac{1}{2}\\,b\\,\\varphi\\,\\omega_z \\;+\\; \\tfrac{1}{2}\\,c\\,\\omega_z^{2} \\;+\\; \\tfrac{1}{2}\\,d\\,\\nabla\\varphi\\cdot\\nabla\\varphi,\n$$\n其中 $a$、$b$、$c$ 和 $d$ 为常数稳定化系数（与 $\\mathbf{x}$ 无关）。总稳定化能为 $U_{\\mathrm{stab}}^{e} = \\int_{\\Omega^{e}} w_{\\mathrm{stab}}\\,\\mathrm{d}\\Omega$。假设为自由边界条件（无外部牵引力或力偶），并且弹性膜能对于刚体运动为零。\n\n从虚功原理和 $\\omega_z$ 的定义出发，推导常数 $a$、$b$ 和 $c$ 所需满足的代数条件，使得对于任意形式为 $\\mathbf{u}(\\mathbf{x}) = \\theta\\,\\mathbf{e}_{z}\\times\\mathbf{x}$（其中 $\\theta \\in \\mathbb{R}$ 为常数）的均匀刚体转动场，并且钻孔场也设为相同的均匀值 $\\varphi(\\mathbf{x})=\\theta$ 时，单元从 $U_{\\mathrm{stab}}^{e}$ 产生的内节点力和内节点力矩均为零。您可以将 $d$ 视为任意值，并可以假设有足够的正则性来进行标准的分部积分。\n\n请将您的最终答案表示为比值向量 $(a:b:c)$，并进行归一化使得 $a=1$，最终以单行矩阵的形式呈现。无需四舍五入，也无需单位。最终答案必须是单一的解析表达式。", "solution": "该问题要求推导稳定化参数 $a$、$b$ 和 $c$ 需满足的条件，使得单个有限元在经受刚体转动时，不产生内节点力或力矩。此分析的出发点是将虚功原理应用于给定的稳定化能 $U_{\\mathrm{stab}}^{e}$。\n\n稳定化能由 $U_{\\mathrm{stab}}^{e} = \\int_{\\Omega^{e}} w_{\\mathrm{stab}}\\,\\mathrm{d}\\Omega$ 给出，其能量密度为：\n$$\nw_{\\mathrm{stab}}(\\mathbf{x}) = \\tfrac{1}{2}\\,a\\,\\varphi^{2} + \\tfrac{1}{2}\\,b\\,\\varphi\\,\\omega_z + \\tfrac{1}{2}\\,c\\,\\omega_z^{2} + \\tfrac{1}{2}\\,d\\,\\nabla\\varphi\\cdot\\nabla\\varphi\n$$\n内节点力和力矩与节点自由度功共轭，可通过能量的一阶变分 $\\delta U_{\\mathrm{stab}}^{e}$ 获得。\n$$\n\\delta U_{\\mathrm{stab}}^{e} = \\int_{\\Omega^{e}} \\delta w_{\\mathrm{stab}}\\,\\mathrm{d}\\Omega\n$$\n能量密度的变分为：\n$$\n\\delta w_{\\mathrm{stab}} = \\frac{\\partial w_{\\mathrm{stab}}}{\\partial \\varphi} \\delta\\varphi + \\frac{\\partial w_{\\mathrm{stab}}}{\\partial \\omega_z} \\delta\\omega_z + \\frac{\\partial w_{\\mathrm{stab}}}{\\partial(\\nabla\\varphi)} \\cdot \\delta(\\nabla\\varphi)\n$$\n计算 $w_{\\mathrm{stab}}$ 的偏导数：\n$$\n\\frac{\\partial w_{\\mathrm{stab}}}{\\partial \\varphi} = a\\varphi + \\tfrac{1}{2}b\\omega_z\n$$\n$$\n\\frac{\\partial w_{\\mathrm{stab}}}{\\partial \\omega_z} = \\tfrac{1}{2}b\\varphi + c\\omega_z\n$$\n$$\n\\frac{\\partial w_{\\mathrm{stab}}}{\\partial(\\nabla\\varphi)} = d\\nabla\\varphi\n$$\n将这些代入 $\\delta U_{\\mathrm{stab}}^{e}$ 的表达式：\n$$\n\\delta U_{\\mathrm{stab}}^{e} = \\int_{\\Omega^{e}} \\left[ (a\\varphi + \\tfrac{1}{2}b\\omega_z)\\delta\\varphi + (\\tfrac{1}{2}b\\varphi + c\\omega_z)\\delta\\omega_z + d\\nabla\\varphi \\cdot \\nabla(\\delta\\varphi) \\right] \\mathrm{d}\\Omega\n$$\n场 $\\mathbf{u}=(u_x, u_y)$ 和 $\\varphi$ 是通过形函数 $N_i(\\mathbf{x})$ 从其节点值插值得到的：\n$$\n\\mathbf{u}(\\mathbf{x}) = \\sum_{i=1}^{n} N_i(\\mathbf{x}) \\mathbf{d}_{u,i} \\quad \\text{和} \\quad \\varphi(\\mathbf{x}) = \\sum_{i=1}^{n} N_i(\\mathbf{x}) d_{\\varphi,i}\n$$\n其中 $\\mathbf{d}_{u,i} = (d_{u_x,i}, d_{u_y,i})^T$ 和 $d_{\\varphi,i}$ 是节点 $i$ 处的节点自由度。场的变分与虚节点位移相关：\n$$\n\\delta\\varphi = \\sum_{i=1}^{n} N_i \\delta d_{\\varphi,i} \\quad \\text{和} \\quad \\nabla(\\delta\\varphi) = \\sum_{i=1}^{n} \\nabla N_i \\delta d_{\\varphi,i}\n$$\n连续体转动 $\\omega_z = \\tfrac{1}{2}(\\partial_x u_y - \\partial_y u_x)$ 的变分为：\n$$\n\\delta\\omega_z = \\tfrac{1}{2} \\sum_{i=1}^{n} \\left( \\frac{\\partial N_i}{\\partial x} \\delta d_{u_y,i} - \\frac{\\partial N_i}{\\partial y} \\delta d_{u_x,i} \\right)\n$$\n将这些代入 $\\delta U_{\\mathrm{stab}}^{e}$ 的表达式，我们可以确定内节点力和力矩。内虚功表示为 $\\delta U_{\\mathrm{stab}}^{e} = \\sum_{i=1}^{n} (\\mathbf{f}_{i,\\text{int}} \\cdot \\delta \\mathbf{d}_{u,i} + m_{i,\\text{int}} \\delta d_{\\varphi,i})$。节点 $i$ 处的节点力和力矩分别是 $\\delta\\mathbf{d}_{u,i}$ 和 $\\delta d_{\\varphi,i}$ 的系数：\n$$\nf_{u_x,i,\\text{int}} = \\int_{\\Omega^{e}} - \\tfrac{1}{2} (\\tfrac{1}{2}b\\varphi + c\\omega_z) \\frac{\\partial N_i}{\\partial y} \\mathrm{d}\\Omega\n$$\n$$\nf_{u_y,i,\\text{int}} = \\int_{\\Omega^{e}} \\tfrac{1}{2} (\\tfrac{1}{2}b\\varphi + c\\omega_z) \\frac{\\partial N_i}{\\partial x} \\mathrm{d}\\Omega\n$$\n$$\nm_{\\varphi,i,\\text{int}} = \\int_{\\Omega^{e}} \\left[ (a\\varphi + \\tfrac{1}{2}b\\omega_z) N_i + d\\nabla\\varphi \\cdot \\nabla N_i \\right] \\mathrm{d}\\Omega\n$$\n问题要求在对刚体转动进行求值时，这些内力和内力矩为零。指定的刚体转动由 $\\mathbf{u}(\\mathbf{x}) = \\theta\\,\\mathbf{e}_{z}\\times\\mathbf{x}$ 和 $\\varphi(\\mathbf{x})=\\theta$ 给出，其中 $\\theta$ 为常数。\n令 $\\mathbf{x} = (x, y, 0)$。位移场为 $\\mathbf{u}(x,y) = (-\\theta y, \\theta x)$。\n我们为该运动计算相关的运动学量：\n1.  钻孔转动为常数：$\\varphi(\\mathbf{x}) = \\theta$。\n2.  钻孔转动的梯度为零：$\\nabla\\varphi = \\mathbf{0}$。\n3.  连续体转动为：\n$$\n\\omega_z = \\tfrac{1}{2}\\left(\\frac{\\partial u_{y}}{\\partial x} - \\frac{\\partial u_{x}}{\\partial y}\\right) = \\tfrac{1}{2}\\left(\\frac{\\partial(\\theta x)}{\\partial x} - \\frac{\\partial(-\\theta y)}{\\partial y}\\right) = \\tfrac{1}{2}(\\theta - (-\\theta)) = \\theta\n$$\n现在，将这些值（$\\varphi=\\theta$、$\\omega_z=\\theta$、$\\nabla\\varphi=\\mathbf{0}$）代入内节点力和力矩的表达式中：\n$$\nf_{u_x,i,\\text{int}} = \\int_{\\Omega^{e}} - \\tfrac{1}{2} (\\tfrac{1}{2}b\\theta + c\\theta) \\frac{\\partial N_i}{\\partial y} \\mathrm{d}\\Omega = -\\tfrac{\\theta}{2}(\\tfrac{b}{2} + c) \\int_{\\Omega^{e}} \\frac{\\partial N_i}{\\partial y} \\mathrm{d}\\Omega\n$$\n$$\nf_{u_y,i,\\text{int}} = \\int_{\\Omega^{e}} \\tfrac{1}{2} (\\tfrac{1}{2}b\\theta + c\\theta) \\frac{\\partial N_i}{\\partial x} \\mathrm{d}\\Omega = \\tfrac{\\theta}{2}(\\tfrac{b}{2} + c) \\int_{\\Omega^{e}} \\frac{\\partial N_i}{\\partial x} \\mathrm{d}\\Omega\n$$\n$$\nm_{\\varphi,i,\\text{int}} = \\int_{\\Omega^{e}} \\left[ (a\\theta + \\tfrac{1}{2}b\\theta) N_i + d(\\mathbf{0}) \\cdot \\nabla N_i \\right] \\mathrm{d}\\Omega = \\theta(a + \\tfrac{b}{2}) \\int_{\\Omega^{e}} N_i \\mathrm{d}\\Omega\n$$\n为使这些力和力矩对于任何单元（即，对于任何有效的形函数集 $N_i$）和任何非零转动 $\\theta$ 均为零，乘以积分的常数系数必须为零。积分 $\\int \\partial_y N_i d\\Omega$、$\\int \\partial_x N_i d\\Omega$ 和 $\\int N_i d\\Omega$ 通常不为零。\n这导出了关于参数 $a$、$b$ 和 $c$ 的两个独立的代数条件：\n1.  从节点力表达式得出：\n$$\n\\tfrac{b}{2} + c = 0 \\implies b + 2c = 0\n$$\n2.  从节点力矩表达式得出：\n$$\na + \\tfrac{b}{2} = 0 \\implies 2a + b = 0\n$$\n我们现在求解这个线性方程组，以得到比值 $(a:b:c)$。\n从第二个方程，我们得到 $b = -2a$。\n将此代入第一个方程得到：\n$$\n(-2a) + 2c = 0 \\implies 2c = 2a \\implies c = a\n$$\n因此，参数必须满足比值 $(a:b:c) = (a : -2a : a)$。对于任何非零的 $a$，这可以简化为比值 $(1 : -2 : 1)$。\n问题要求最终答案以比值向量 $(a:b:c)$ 的形式给出，并归一化使得 $a=1$。这得出 $a=1$，$b=-2$ 和 $c=1$。\n该结果意味着稳定化能的二次项部分（依赖于 $a$、$b$和$c$）与 $(\\varphi - \\omega_z)^2$ 成正比：\n$$\n\\tfrac{1}{2}a\\varphi^2 + \\tfrac{1}{2}b\\varphi\\omega_z + \\tfrac{1}{2}c\\omega_z^2 = \\tfrac{a}{2}(\\varphi^2 - 2\\varphi\\omega_z + \\omega_z^2) = \\tfrac{a}{2}(\\varphi - \\omega_z)^2\n$$\n对于刚体转动，$\\varphi = \\omega_z = \\theta$，因此该能量项恒为零，这是所产生的力和力矩为零的充分条件。我们的推导从第一性原理证实了这一点。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & -2 & 1\n\\end{pmatrix}\n}\n$$", "id": "2552865"}, {"introduction": "理论上的正确性必须通过数值实验来验证，而在有限元方法中，“单元检验”（Patch Test）就是验证单元一致性和收敛性的黄金标准。一个通过检验的单元必须能够精确地再现任意常应变状态。本练习挑战你设计一个适用于带有钻孔自由度单元的单元检验，你需要明确定义边界条件以及在精确解中钻孔转动场应有的表现 [@problem_id:2552936]。正确理解单元检验不仅是开发新单元的必备技能，也是作为有限元分析师评判商业软件中单元性能的重要依据。", "problem": "考虑二维空间中平面应力或平面应变条件下的小应变、线性弹性膜行为。设 $\\Omega \\subset \\mathbb{R}^2$ 是一个由多个膜有限元组装而成的单连通凸片区域，这些单元除了具有平面内位移分量 $u(x,y)$ 和 $v(x,y)$ 外，还带有一个节点钻孔自由度 (DOF) $\\theta_z$，该自由度近似了面外微旋转。在经典的膜 Cauchy 连续介质理论中，不存在力偶应力，应变能仅取决于位移梯度的对称部分。小应变张量定义为 $\\boldsymbol{\\epsilon} = \\tfrac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}}\\right)$，其分量为 $\\epsilon_{xx} = \\partial u/\\partial x$、$\\epsilon_{yy} = \\partial v/\\partial y$ 和 $\\epsilon_{xy} = \\tfrac{1}{2}\\left(\\partial u/\\partial y + \\partial v/\\partial x\\right)$。平面内连续介质自旋（面外标量）为 $\\omega_z = \\tfrac{1}{2}\\left(\\partial v/\\partial x - \\partial u/\\partial y\\right)$。许多钻孔自由度的处理方法通过将 $\\theta_z$ 与 $\\omega_z$ 弱耦合来稳定 $\\theta_z$，使得当 $\\theta_z = \\omega_z$ 时，任何稳定能都为零。\n\n你的任务是选择唯一正确的选项，该选项正确地指定了一种斑块检验（Patch Test），用于验证带有钻孔自由度的单元能否精确再现恒定的膜应变场，包括精确的边界数据和精确解中应出现的钻孔场。\n\nA. 使用牵引力斑块检验：在 $\\partial\\Omega$ 上施加与恒定膜应力张量 $\\bar{\\boldsymbol{\\sigma}}$ 对应的边界面力 $\\mathbf{t} = \\bar{\\boldsymbol{\\sigma}}\\mathbf{n}$，释放所有钻孔自由度，并期望精确解展现出仿射位移，且钻孔转动恒等于零，即 $\\theta_z(x,y)\\equiv 0$。\n\nB. 使用 Dirichlet 斑块检验：在 $\\partial\\Omega$ 上指定一个仿射位移场 $u(x,y) = a_0 + a_1 x + a_2 y$ 和 $v(x,y) = b_0 + b_1 x + b_2 y$，其中 $a_0,a_1,a_2,b_0,b_1,b_2$ 为任意常数，并且除了消除刚体零模态外不约束 $\\theta_z$。此时，精确解在 $\\Omega$ 处处具有恒定的膜应变 $\\epsilon_{xx} = a_1$、$\\epsilon_{yy} = b_2$ 和 $\\epsilon_{xy} = \\tfrac{1}{2}\\left(a_2 + b_1\\right)$，并且应出现的钻孔场是连续介质自旋 $\\theta_z(x,y) \\equiv \\omega_z = \\tfrac{1}{2}\\left(b_1 - a_2\\right)$，该自旋为常数。\n\nC. 使用高阶斑块检验：在 $\\partial\\Omega$ 上指定二次边界位移，如果单元能够再现线性膜应力，则认为通过检验；钻孔场可以是任意线性函数 $\\theta_z(x,y) = c_0 + c_1 x + c_2 y$。\n\nD. 使用约束 Dirichlet 斑块检验：指定与选项 B 相同的仿射边界位移，但在每个节点上将所有钻孔转动设为零，即 $\\theta_z \\equiv 0$，以反映膜连续介质中缺乏钻孔刚度；此时的精确解具有恒定的膜应变和零钻孔转动。\n\nE. 使用体力斑块检验：固定一个角节点上的所有位移自由度，在 $\\Omega$ 中施加单位面积上的恒定体力 $b_x$ 和 $b_y$，如果计算出的位移场能产生均匀的膜应变，则认为单元通过检验；应出现的钻孔场是 $x$ 和 $y$ 的线性函数。", "solution": "题目陈述需要进行验证。\n\n### 步骤1：提取已知条件\n- **模型**：二维(2D)小应变、线性弹性膜，处于平面应力或平面应变状态。\n- **区域**：由多个有限元组装而成的单连通凸片区域 $\\Omega \\subset \\mathbb{R}^2$。\n- **自由度 (DOF)**：平面内位移 $u(x,y)$ 和 $v(x,y)$，以及一个节点钻孔自由度 $\\theta_z$。\n- **连续介质理论**：经典 Cauchy 连续介质，无力偶应力；应变能仅取决于位移梯度的对称部分。\n- **应变定义**：小应变张量 $\\boldsymbol{\\epsilon} = \\tfrac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}}\\right)$，其分量为 $\\epsilon_{xx} = \\partial u/\\partial x$、$\\epsilon_{yy} = \\partial v/\\partial y$ 和 $\\epsilon_{xy} = \\tfrac{1}{2}\\left(\\partial u/\\partial y + \\partial v/\\partial x\\right)$。\n- **自旋定义**：平面内连续介质自旋 $\\omega_z = \\tfrac{1}{2}\\left(\\partial v/\\partial x - \\partial u/\\partial y\\right)$。\n- **钻孔自由度处理**：通过将 $\\theta_z$ 与 $\\omega_z$ 弱耦合来稳定 $\\theta_z$，使得当 $\\theta_z = \\omega_z$ 时，稳定能为零。\n- **任务**：确定正确的斑块检验规范，以验证对恒定膜应变场的精确再现。\n\n### 步骤2：使用提取的已知条件进行验证\n审查题目陈述的有效性。\n- **科学依据**：该问题基于连续介质力学和有限元法（FEM）的公认原理。膜单元、钻孔自由度、斑块检验、应变和自旋等概念在计算固体力学中都是标准的。通过将钻孔自由度与连续介质自旋相耦合进行稳定是一种常见且具有物理动机的技术。\n- **良定性**：问题是良定的。它要求在特定、明确定义的条件下，为一类特定的有限元找到一种标准收敛性测试（斑块检验）的正确程序。\n- **客观性**：语言技术性强、精确且客观。\n\n### 步骤3：结论与行动\n题目陈述在科学上是合理的、自洽的且无歧义的。它描述了有限元列式验证中的一个标准问题。因此，该问题是 **有效的**。将推导解答。\n\n斑块检验的基本要求是，有限元的集合必须能精确再现任意的恒定应变状态，包括刚体运动。二维空间中的恒定应变状态由恒定的应变分量 $\\bar{\\epsilon}_{xx}$、$\\bar{\\epsilon}_{yy}$ 和 $\\bar{\\epsilon}_{xy}$ 来表征。\n\n能够产生这种恒定应变状态的位移场 $\\mathbf{u}(x,y) = [u(x,y), v(x,y)]^{\\mathsf{T}}$ 必须是坐标 $x$ 和 $y$ 的仿射函数。这可以表示为：\n$$\n\\begin{aligned}\nu(x,y) &= a_0 + a_1 x + a_2 y \\\\\nv(x,y) &= b_0 + b_1 x + b_2 y\n\\end{aligned}\n$$\n其中 $a_0, a_1, a_2, b_0, b_1, b_2$ 是任意实数常数。常数 $a_0$ 和 $b_0$ 代表刚体平动。其他常数定义了应变和转动。\n\n小应变张量的分量随后计算为：\n$$\n\\epsilon_{xx} = \\frac{\\partial u}{\\partial x} = a_1\n$$\n$$\n\\epsilon_{yy} = \\frac{\\partial v}{\\partial y} = b_2\n$$\n$$\n\\epsilon_{xy} = \\frac{1}{2}\\left(\\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}\\right) = \\frac{1}{2}(a_2 + b_1)\n$$\n这些都是常数，符合要求。\n\n连续介质自旋的面外分量（或位移梯度的反对称部分）为：\n$$\n\\omega_z = \\frac{1}{2}\\left(\\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}\\right) = \\frac{1}{2}(b_1 - a_2)\n$$\n对于仿射位移场，自旋 $\\omega_z$ 也是一个常数。\n\n题目陈述指出，单元列式包含一个钻孔自由度 $\\theta_z$，旨在近似自旋 $\\omega_z$。引入了一个稳定能，该能量当且仅当 $\\theta_z = \\omega_z$ 时为零。为了使有限元解精确，它必须再现连续介质解而没有任何虚假能量。这意味着，要使一片单元通过检验，钻孔自由度的节点值 $\\theta_z$ 必须等于连续介质自旋的恒定值 $\\omega_z$。\n\n现在我们将基于这一理解来评估每个选项。\n\n**A. 使用牵引力斑块检验：在 $\\partial\\Omega$ 上施加与恒定膜应力张量 $\\bar{\\boldsymbol{\\sigma}}$ 对应的边界面力 $\\mathbf{t} = \\bar{\\boldsymbol{\\sigma}}\\mathbf{n}$，释放所有钻孔自由度，并期望精确解展现出仿射位移，且钻孔转动恒等于零，即 $\\theta_z(x,y)\\equiv 0$。**\n\n基于牵引力的斑块检验是一种有效的方法。恒定的应力状态 $\\bar{\\boldsymbol{\\sigma}}$ 对应于恒定的应变状态，从而对应于仿射位移场。然而，该选项错误地指出钻孔转动应恒等于零，即 $\\theta_z(x,y)\\equiv 0$。一个普遍的仿射位移场具有一个非零的、恒定的自旋 $\\omega_z = \\tfrac{1}{2}(b_1 - a_2)$。条件 $\\theta_z \\equiv 0$ 仅在无旋应变的特殊情况下才正确，即 $\\omega_z=0$（也即 $b_1 = a_2$）。斑块检验必须对*任意*恒定应变状态都通过，这包括那些具有非零自旋的状态。因此，期望 $\\theta_z \\equiv 0$ 是不正确的。\n结论：**不正确**。\n\n**B. 使用 Dirichlet 斑块检验：在 $\\partial\\Omega$ 上指定一个仿射位移场 $u(x,y) = a_0 + a_1 x + a_2 y$ 和 $v(x,y) = b_0 + b_1 x + b_2 y$，其中 $a_0,a_1,a_2,b_0,b_1,b_2$ 为任意常数，并且除了消除刚体零模态外不约束 $\\theta_z$。此时，精确解在 $\\Omega$ 处处具有恒定的膜应变 $\\epsilon_{xx} = a_1$、$\\epsilon_{yy} = b_2$ 和 $\\epsilon_{xy} = \\tfrac{1}{2}\\left(a_2 + b_1\\right)$，并且应出现的钻孔场是连续介质自旋 $\\theta_z(x,y) \\equiv \\omega_z = \\tfrac{1}{2}\\left(b_1 - a_2\\right)$，该自旋为常数。**\n\n该选项描述了一种 Dirichlet 斑块检验，其中精确解（一个仿射位移场）在边界上被指定。如果单元列式能为所有内部节点精确地再现该场，则认为通过检验。关键部分涉及钻孔自由度 $\\theta_z$。该选项正确地指出 $\\theta_z$ 在边界上不应被约束。它还正确地推断出，为使解精确，稳定能必须为零。当节点钻孔转动 $\\theta_z$ 等于连续介质自旋 $\\omega_z$ 时，此条件得到满足。对于指定的仿射场，$\\omega_z = \\tfrac{1}{2}(b_1 - a_2)$ 是一个常数。因此，精确的有限元解必须展现出一个恒定的钻孔转动场 $\\theta_z \\equiv \\omega_z$。此陈述的所有部分都与斑块检验的原理和给定的稳定机制相符。\n结论：**正确**。\n\n**C. 使用高阶斑块检验：在 $\\partial\\Omega$ 上指定二次边界位移，如果单元能够再现线性膜应力，则认为通过检验；钻孔场可以是任意线性函数 $\\theta_z(x,y) = c_0 + c_1 x + c_2 y$。**\n\n问题明确要求一种检验，用于验证对*恒定*膜应变场的再现。涉及二次边界位移的检验是一种高阶斑块检验，旨在验证对*线性*应变场的再现。这没有回答所提出的问题。此外，关于期望的钻孔场的陈述是任意的，且没有任何原理解释。\n结论：**不正确**。\n\n**D. 使用约束 Dirichlet 斑块检验：指定与选项 B 相同的仿射边界位移，但在每个节点上将所有钻孔转动设为零，即 $\\theta_z \\equiv 0$，以反映膜连续介质中缺乏钻孔刚度；此时的精确解具有恒定的膜应变和零钻孔转动。**\n\n这是一个根本上错误的检验程序。通过在所有节点上施加 $\\theta_z \\equiv 0$，引入了一个人为约束，该约束与普遍的仿射位移场不一致，因为对于后者，$\\omega_z$ 通常不为零。当 $\\omega_z \\neq 0$ 时强制 $\\theta_z=0$ 会激活稳定罚能，从而阻止单元再现精确的（在罚函数意义上的）无应力状态。这个检验并不检查单元是否能再现正确的物理现象，而是检查它是否能解决一个病态的、过约束的问题。认为因为没有连续介质钻孔刚度所以 $\\theta_z$ 应为零的逻辑是错误的；$\\theta_z$ 自由度的存在正是为了与非零的连续介质自旋 $\\omega_z$ 相联系。\n结论：**不正确**。\n\n**E. 使用体力斑块检验：固定一个角节点上的所有位移自由度，在 $\\Omega$ 中施加单位面积上的恒定体力 $b_x$ 和 $b_y$，如果计算出的位移场能产生均匀的膜应变，则认为单元通过检验；应出现的钻孔场是 $x$ 和 $y$ 的线性函数。**\n\n在存在体力 $\\mathbf{b}$ 的情况下，平衡方程为 $\\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{b} = \\mathbf{0}$。如果体力 $b_x$ 和 $b_y$ 是恒定的，那么 $\\nabla \\cdot \\boldsymbol{\\sigma}$ 必须是一个常数向量。这意味着应力张量 $\\boldsymbol{\\sigma}$ 的分量必须是 $x$ 和 $y$ 的线性函数，而非恒定。线性的应力场对应于线性的应变场，从而对应于二次位移场。这种设置测试了单元再现线性应变场的能力，这是一个比基本斑块检验要求更强的条件。问题要求的是对*恒定*应变场的检验。\n结论：**不正确**。", "answer": "$$\\boxed{B}$$", "id": "2552936"}, {"introduction": "将理论付诸实践是掌握任何工程概念的最终环节。在本练习中，你将从零开始，亲手编写代码实现一个包含钻孔自由度稳定化的四节点双线性膜单元。通过与标准的、仅有平动自由度的单元进行对比，你将直观地观察到钻孔自由度的引入及其稳定化处理对单元位移解的具体影响 [@problem_id:2552917]。这个全面的编程任务不仅会巩固你对有限元列式、高斯积分和边界条件应用的理解，还将为你提供一个可用于未来研究和开发的实用代码框架。", "problem": "要求您从线性弹性力学和有限元法 (FEM) 的第一性原理出发，在单位正方形域上实现一个带有可选钻孔自由度 (DOF) 稳定化的双线性四边形膜单元。该域为单位正方形，节点坐标为：节点 $1$位于$(0,0)$，节点 $2$位于$(1,0)$，节点 $3$位于$(1,1)$，节点 $4$位于$(0,1)$。该膜在右边界（$x=1$）上承受沿 $x$ 轴正方向、大小为 $T_0$ 的均布牵引力，而所有其他边界均无牵引力。该膜在平面应力条件下建模，其杨氏模量为 $E$，泊松比为 $\\nu$，厚度为 $t$。在整个计算中使用一致的无量纲单位。\n\n您的任务是计算以下两种模型的节点位移矢量场：\n- 模型 A：一个标准的双线性四边形膜单元，每个节点仅有面内平动自由度，记为 $u$ 和 $v$。\n- 模型 B：相同的单元，但每个节点增广了一个钻孔转动自由度 $\\theta$，通过对钻孔转动和面内连续体转动之间的差值施加罚函数进行稳定。稳定化使用一个参数 $\\alpha$，并在弱形式中增加了在单元面积上对 $\\alpha (\\theta - \\omega_z)^2$ 的积分，其中 $\\omega_z$ 是由 $\\omega_z = \\tfrac{1}{2} \\left( \\dfrac{\\partial v}{\\partial x} - \\dfrac{\\partial u}{\\partial y} \\right)$ 定义的面外连续体转动。\n\n您必须从基本定义出发，推导并实现以下内容：\n- 线性弹性力学中，关于应力矢量 $\\sigma$ 和应变矢量 $\\varepsilon$ 的平面应力本构关系，使用本构矩阵 $D$ 表示。其中应变为 $\\varepsilon = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^T$，且 $\\varepsilon_{xx} = \\dfrac{\\partial u}{\\partial x}$，$\\varepsilon_{yy} = \\dfrac{\\partial v}{\\partial y}$，$\\gamma_{xy} = \\dfrac{\\partial u}{\\partial y} + \\dfrac{\\partial v}{\\partial x}$。\n- 四边形单元的等参映射和双线性形函数，使用 2x2 高斯求积，其求积点位于 $\\xi, \\eta \\in \\{ -1/\\sqrt{3}, +1/\\sqrt{3} \\}$，权重为 $1$。通过对 $B^T D B \\, t \\, \\det(J)$ 进行积分来组装单元刚度矩阵 $K_{uv}$，其中 $B$ 是线性化应变-位移矩阵，而 $J$ 是映射的雅可比矩阵。\n- 施加在右边界上的牵引力矢量，使用一致节点力表示。通过在边界 $\\xi = 1$ 上进行一维高斯求积，对边界形函数、牵引力 $[T_0, 0]^T$、厚度 $t$ 以及对应于参数到物理空间线映射的边界雅可比因子的乘积进行积分来计算。\n- 钻孔转动稳定化。引入钻孔自由度场 $\\theta \\approx \\sum_{i=1}^4 N_i \\, \\theta_i$，其中 $N_i$ 是双线性形函数。在每个求积点定义连续体转动映射 $\\omega_z = \\tfrac{1}{2} ( \\partial v / \\partial x - \\partial u / \\partial y )$。向单元弱形式中添加罚函数稳定项 $\\int_\\Omega \\alpha (\\theta - \\omega_z)^2 \\, t \\, \\mathrm{d}\\Omega$。证明这将为单元矩阵贡献对称块：$K_{\\theta \\theta} = \\int \\alpha N^T N \\, t \\, \\mathrm{d}\\Omega$，$K_{u \\theta} = - \\int \\alpha B_\\omega^T N \\, t \\, \\mathrm{d}\\Omega$（其中 $B_\\omega$ 是从平动自由度到 $\\omega_z$ 的 $1 \\times 8$ 映射），以及 $K_{uu}^{\\text{stab}} = \\int \\alpha B_\\omega^T B_\\omega \\, t \\, \\mathrm{d}\\Omega$。模型 B 的完整稳定化单元矩阵则为\n$$\nK^{(B)} = \\begin{bmatrix}\nK_{uv} + K_{uu}^{\\text{stab}} & K_{u \\theta} \\\\\nK_{u \\theta}^T & K_{\\theta \\theta}\n\\end{bmatrix}.\n$$\n- 本质边界条件：为消除刚体运动，在节点 $1$ 和 $4$（即左边界 $x=0$）上约束 $u=0$，并额外仅在节点 $1$ 上约束 $v=0$。不对 $\\theta$ 施加任何本质边界条件。对模型 A 和模型 B 应用相同的本质边界条件。对于模型 A，全局系统仅包含平动自由度；对于模型 B，它既包含平动自由度也包含钻孔自由度。在模型 A 中，外力仅作用于平动自由度；在模型 B 中，钻孔自由度上的外荷载为零。\n\n计算两种模型的解，并通过计算模型 A 和模型 B 之间所有节点上所有 $u$ 和 $v$ 自由度的最大绝对差，来比较它们的平动节点位移矢量。\n\n您的程序必须实现以上内容，并使用以下被视为无量纲的参数集运行一个测试套件：\n- 情况 1：$E = 1000$，$\\nu = 0.3$，$t = 1$，$T_0 = 1$，$\\alpha = 0.1$。\n- 情况 2：$E = 1000$，$\\nu = 0.3$，$t = 1$，$T_0 = 1$，$\\alpha = 10$。\n- 情况 3：$E = 1000$，$\\nu = 0.49$，$t = 1$，$T_0 = 1$，$\\alpha = 1$。\n- 情况 4：$E = 1000$，$\\nu = 0.3$，$t = 0.1$，$T_0 = 1$，$\\alpha = 1$。\n\n对于每种情况，输出一个浮点数，该数等于模型 A 和模型 B 之间平动节点位移的最大绝对差。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3,result4]”），其中每个结果按顺序对应于上述情况。", "solution": "所提出的问题是计算固体力学领域，特别是在有限元法 (FEM) 框架内的一个适定且科学上合理的练习。它要求实现并比较两种平面应力膜单元模型：一种是标准的双线性四边形单元，另一种是采用罚函数法对钻孔自由度 (DOF) 进行稳定化增广的单元。所有必要的数据，包括材料属性、几何形状、载荷、边界条件和数值参数，都已提供。该问题没有矛盾、歧义和事实错误。因此，它被认为是有效的，并将提供完整的解决方案。\n\n解决方案将从线性弹性力学和等参有限元理论的第一性原理推导得出。\n\n**1. 平面应力的本构关系**\n\n对于处于平面应力条件（$\\sigma_{zz} = \\sigma_{xz} = \\sigma_{yz} = 0$）下的线性、各向同性、弹性材料，面内应力矢量 $\\sigma = [\\sigma_{xx}, \\sigma_{yy}, \\tau_{xy}]^T$ 和应变矢量 $\\varepsilon = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^T$ 之间的关系由 $\\sigma = D \\varepsilon$ 给出。本构矩阵 $D$ 源自胡克定律，其表达式为：\n$$\nD = \\frac{E}{1 - \\nu^2}\n\\begin{bmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1 - \\nu}{2}\n\\end{bmatrix}\n$$\n其中 $E$ 是杨氏模量，$\\nu$ 是泊松比。\n\n**2. 等参双线性四边形单元**\n\n几何场和位移场都使用同一组形函数从节点值插值得到，这是等参概念的核心。\n\n形函数：对于在由 $\\xi, \\eta \\in [-1, 1]$ 定义的父域中的四节点四边形单元，其双线性形函数 $N_i(\\xi, \\eta)$ 为：\n$$\nN_1 = \\frac{1}{4}(1-\\xi)(1-\\eta), \\quad N_2 = \\frac{1}{4}(1+\\xi)(1-\\eta), \\quad N_3 = \\frac{1}{4}(1+\\xi)(1+\\eta), \\quad N_4 = \\frac{1}{4}(1-\\xi)(1+\\eta)\n$$\n几何映射：物理坐标 $(x, y)$ 通过以下方式从父坐标 $(\\xi, \\eta)$ 映射得到：\n$$\nx(\\xi, \\eta) = \\sum_{i=1}^4 N_i(\\xi, \\eta) x_i, \\quad y(\\xi, \\eta) = \\sum_{i=1}^4 N_i(\\xi, \\eta) y_i\n$$\n对于指定的单位正方形，其节点为 $1(0,0)$, $2(1,0)$, $3(1,1)$, $4(0,1)$，该映射简化为 $x = \\frac{1}{2}(1+\\xi)$ 和 $y = \\frac{1}{2}(1+\\eta)$。\n\n雅可比矩阵：从物理坐标系到父坐标系的导数变换由雅可比矩阵 $J$ 控制：\n$$\nJ = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix} = \\begin{bmatrix} 1/2 & 0 \\\\ 0 & 1/2 \\end{bmatrix}\n$$\n雅可比行列式为 $\\det(J) = 1/4$。面积微元为 $dA = \\det(J) \\, d\\xi \\, d\\eta$。\n\n应变-位移矩阵 ($B$)：应变分量由位移场 $u(x,y) = \\sum N_i u_i$ 和 $v(x,y) = \\sum N_i v_i$ 的空间导数定义。关系式 $\\varepsilon = B d_{uv}$ 将应变矢量 $\\varepsilon$ 与节点位移矢量 $d_{uv} = [u_1, v_1, u_2, v_2, u_3, v_3, u_4, v_4]^T$ 联系起来。矩阵 $B$ 由形函数的空间导数构造而成：\n$$\nB = [B_1, B_2, B_3, B_4], \\quad \\text{其中} \\quad B_i = \\begin{bmatrix} \\frac{\\partial N_i}{\\partial x} & 0 \\\\ 0 & \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x} \\end{bmatrix}\n$$\n关于 $x$ 和 $y$ 的导数可以使用雅可比矩阵的逆求得：\n$$\n\\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix} = J^{-1} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{pmatrix} = \\begin{bmatrix} 2 & 0 \\\\ 0 & 2 \\end{bmatrix} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{pmatrix}\n$$\n\n**3. 单元刚度和力矢量**\n\n标准刚度矩阵 ($K_{uv}$): 平动自由度的单元刚度矩阵通过对单元体积内的应变能进行积分来计算：\n$$\nK_{uv} = \\int_A B^T D B \\, t \\, dA = \\int_{-1}^1 \\int_{-1}^1 B^T(\\xi, \\eta) D B(\\xi, \\eta) \\, t \\det(J) \\, d\\xi \\, d\\eta\n$$\n该积分使用 $2 \\times 2$ 高斯求积进行数值计算。\n\n一致节点力：施加在右边界（节点 2到节点 3，其中 $\\xi=1$）上的均布牵引力 $\\vec{T} = [T_0, 0]^T$ 生成一个一致节点力矢量 $F_{uv}$：\n$$\nF_{uv} = \\int_{\\text{edge 2-3}} N_{\\text{edge}}^T \\vec{T} \\, t \\, dL\n$$\n其中 $N_{\\text{edge}}$ 包含在边界上求值的形函数。在此边界上，$N_1 = N_4 = 0$, $N_2 = \\frac{1}{2}(1-\\eta)$, $N_3 = \\frac{1}{2}(1+\\eta)$。线微元为 $dL = \\sqrt{(\\partial x/\\partial\\eta)^2 + (\\partial y/\\partial\\eta)^2} \\, d\\eta = 1/2 \\, d\\eta$。积分后仅在节点 $2$ 和 $3$ 的 $u$ 位移上产生非零力：$F_{2,u} = F_{3,u} = T_0 t / 2$。总力矢量为 $F_{uv} = [0, 0, T_0 t/2, 0, T_0 t/2, 0, 0, 0]^T$。\n\n**4. 钻孔自由度稳定化 (模型 B)**\n\n模型 B 在每个节点引入一个钻孔转动自由度 $\\theta_i$。稳定化是通过在总势能中增加一个罚能量项来实现的，该项惩罚节点钻孔转动场 $\\theta = \\sum N_i \\theta_i$ 与连续体转动 $\\omega_z = \\frac{1}{2}(\\partial v/\\partial x - \\partial u/\\partial y)$ 之间的不匹配。\n\n稳定能为：\n$$\n\\Pi_{\\text{stab}} = \\frac{1}{2} \\int_A \\alpha (\\theta - \\omega_z)^2 \\, t \\, dA\n$$\n其中 $\\alpha$ 是一个罚参数。我们可以用节点自由度表示 $\\theta$ 和 $\\omega_z$：\n$$\n\\theta = N d_\\theta, \\quad \\omega_z = B_\\omega d_{uv}\n$$\n这里 $d_\\theta = [\\theta_1, \\theta_2, \\theta_3, \\theta_4]^T$，$N = [N_1, N_2, N_3, N_4]$ 是形函数的行向量，$B_\\omega$ 是一个 $1 \\times 8$ 的矩阵，它将平动位移映射到连续体转动：\n$$\nB_\\omega = \\frac{1}{2} \\left[-\\frac{\\partial N_1}{\\partial x}, \\frac{\\partial N_1}{\\partial y}, -\\frac{\\partial N_2}{\\partial x}, \\frac{\\partial N_2}{\\partial y}, \\dots, -\\frac{\\partial N_4}{\\partial x}, \\frac{\\partial N_4}{\\partial y}\\right]\n$$\n将这些代入罚能量并对节点自由度取二次变分，得到被加到系统中的稳定化刚度矩阵。对于自由度排序为 $[d_{uv}^T, d_\\theta^T]^T$ 的模型 B，其总刚度矩阵 $K^{(B)}$ 为：\n$$\nK^{(B)} = \\begin{bmatrix}\nK_{uv} + K_{uu}^{\\text{stab}} & K_{u \\theta} \\\\\nK_{u \\theta}^T & K_{\\theta \\theta}\n\\end{bmatrix}\n$$\n其中稳定化分量由以下积分给出：\n$$\nK_{uu}^{\\text{stab}} = \\int_A \\alpha B_\\omega^T B_\\omega \\, t \\, dA, \\quad K_{u \\theta} = - \\int_A \\alpha B_\\omega^T N \\, t \\, dA, \\quad K_{\\theta \\theta} = \\int_A \\alpha N^T N \\, t \\, dA\n$$\n这些矩阵也使用 $2 \\times 2$ 高斯求积进行计算。\n\n**5. 系统求解与边界条件**\n\n模型 A：方程组为 $K_{uv} d_{uv} = F_{uv}$。\n模型 B：系统为 $K^{(B)} d = F^{(B)}$，其中 $d = [d_{uv}^T, d_\\theta^T]^T$ 且 $F^{(B)} = [F_{uv}^T, 0, 0, 0, 0]^T$。\n\n边界条件 (BCs)：为了消除刚体模态，对两个模型都应用以下本质边界条件：\n- $u_1 = 0$ (自由度索引为 $0$)\n- $v_1 = 0$ (自由度索引为 $1$)\n- $u_4 = 0$ (自由度索引为 $6$)\n这些条件通过修改全局刚度矩阵和力矢量来施加。对于一个被约束的自由度 $k$ ($d_k=0$)，将刚度矩阵的第 $k$ 行和第 $k$ 列设为零，对角元素 $K_{kk}$ 设为 $1$，力矢量的第 $k$ 个元素 $F_k$ 设为 $0$。\n\n求解得到的线性系统，得到节点位移 $d_{uv}^{(A)}$ 和 $d_{uv}^{(B)}$。最终的比较是这两个平动位移矢量之间的最大绝对差：$\\max(|d_{uv}^{(A)} - d_{uv}^{(B)}|)$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and compares a standard bilinear quadrilateral membrane element (Model A)\n    with an element enriched with stabilized drilling degrees of freedom (Model B).\n    \"\"\"\n    \n    test_cases = [\n        # (E, nu, t, T0, alpha)\n        (1000.0, 0.3, 1.0, 1.0, 0.1),\n        (1000.0, 0.3, 1.0, 1.0, 10.0),\n        (1000.0, 0.49, 1.0, 1.0, 1.0),\n        (1000.0, 0.3, 0.1, 1.0, 1.0),\n    ]\n\n    results = []\n\n    for E, nu, t, T0, alpha in test_cases:\n        # Nodal coordinates for the unit square element\n        coords = np.array([\n            [0.0, 0.0],  # Node 1\n            [1.0, 0.0],  # Node 2\n            [1.0, 1.0],  # Node 3\n            [0.0, 1.0],  # Node 4\n        ])\n\n        # Gaussian quadrature points and weights for 2x2 rule\n        gauss_points = [-1.0 / np.sqrt(3.0), 1.0 / np.sqrt(3.0)]\n        gauss_weights = [1.0, 1.0]\n\n        # Constitutive matrix for plane stress\n        D = (E / (1.0 - nu**2)) * np.array([\n            [1.0, nu, 0.0],\n            [nu, 1.0, 0.0],\n            [0.0, 0.0, (1.0 - nu) / 2.0]\n        ])\n\n        # Initialize element matrices\n        K_uv = np.zeros((8, 8))\n        K_uu_stab = np.zeros((8, 8))\n        K_utheta = np.zeros((8, 4))\n        K_thetatheta = np.zeros((4, 4))\n\n        # Numerical integration over the element area\n        for i in range(len(gauss_points)):\n            for j in range(len(gauss_points)):\n                xi = gauss_points[i]\n                eta = gauss_points[j]\n                weight = gauss_weights[i] * gauss_weights[j]\n\n                # Shape functions and their derivatives in parent domain\n                N = 0.25 * np.array([\n                    (1 - xi) * (1 - eta),\n                    (1 + xi) * (1 - eta),\n                    (1 + xi) * (1 + eta),\n                    (1 - xi) * (1 + eta)\n                ])\n\n                # Derivatives w.r.t. xi and eta\n                dN_dxi = 0.25 * np.array([\n                    -(1 - eta), (1 - eta), (1 + eta), -(1 + eta)\n                ])\n                dN_deta = 0.25 * np.array([\n                    -(1 - xi), -(1 + xi), (1 + xi), (1 - xi)\n                ])\n\n                # Jacobian matrix, its inverse and determinant\n                # For the unit square, J is constant\n                J = np.array([[0.5, 0.0], [0.0, 0.5]])\n                J_inv = np.array([[2.0, 0.0], [0.0, 2.0]])\n                det_J = 0.25\n                \n                # Shape function derivatives in physical domain\n                dN_dxy = J_inv @ np.vstack((dN_dxi, dN_deta))\n                dN_dx = dN_dxy[0, :]\n                dN_dy = dN_dxy[1, :]\n\n                # Strain-displacement matrix B\n                B = np.zeros((3, 8))\n                for k in range(4):\n                    B[0, 2 * k] = dN_dx[k]\n                    B[1, 2 * k + 1] = dN_dy[k]\n                    B[2, 2 * k] = dN_dy[k]\n                    B[2, 2 * k + 1] = dN_dx[k]\n\n                # Continuum rotation matrix B_omega\n                B_omega = np.zeros((1, 8))\n                for k in range(4):\n                    B_omega[0, 2 * k] = -0.5 * dN_dy[k]\n                    B_omega[0, 2 * k + 1] = 0.5 * dN_dx[k]\n\n                # Assemble stiffness matrices\n                factor = t * det_J * weight\n                K_uv += B.T @ D @ B * factor\n                \n                # Stabilization matrices\n                stab_factor = alpha * factor\n                K_uu_stab += B_omega.T @ B_omega * stab_factor\n                K_utheta -= B_omega.T @ N.reshape(1, 4) * stab_factor\n                K_thetatheta += N.reshape(4, 1) @ N.reshape(1, 4) * stab_factor\n        \n        # --- MODEL A ---\n        K_A = K_uv.copy()\n        F_A = np.zeros(8)\n        # Consistent nodal forces from traction T0 on edge 2-3\n        F_A[2] = T0 * t * 0.5  # u2\n        F_A[4] = T0 * t * 0.5  # u3\n\n        # Apply boundary conditions for Model A\n        # u1=0 (DOF 0), v1=0 (DOF 1), u4=0 (DOF 6)\n        constrained_dofs_A = [0, 1, 6]\n        for dof in constrained_dofs_A:\n            K_A[dof, :] = 0.0\n            K_A[:, dof] = 0.0\n            K_A[dof, dof] = 1.0\n            F_A[dof] = 0.0\n        \n        d_uv_A = np.linalg.solve(K_A, F_A)\n        \n        # --- MODEL B ---\n        K_B = np.zeros((12, 12))\n        K_B[0:8, 0:8] = K_uv + K_uu_stab\n        K_B[0:8, 8:12] = K_utheta\n        K_B[8:12, 0:8] = K_utheta.T\n        K_B[8:12, 8:12] = K_thetatheta\n\n        F_B = np.zeros(12)\n        F_B[2] = T0 * t * 0.5\n        F_B[4] = T0 * t * 0.5\n        \n        # Apply boundary conditions for Model B (same translational DOFs)\n        constrained_dofs_B = [0, 1, 6]\n        for dof in constrained_dofs_B:\n            K_B[dof, :] = 0.0\n            K_B[:, dof] = 0.0\n            K_B[dof, dof] = 1.0\n            F_B[dof] = 0.0\n        \n        d_B = np.linalg.solve(K_B, F_B)\n        d_uv_B = d_B[:8]\n\n        # Calculate the maximum absolute difference\n        max_diff = np.max(np.abs(d_uv_A - d_uv_B))\n        results.append(max_diff)\n        \n    # Format and print the final output\n    print(f\"[{','.join(f'{r:.8e}' for r in results)}]\")\n\nsolve()\n```", "id": "2552917"}]}