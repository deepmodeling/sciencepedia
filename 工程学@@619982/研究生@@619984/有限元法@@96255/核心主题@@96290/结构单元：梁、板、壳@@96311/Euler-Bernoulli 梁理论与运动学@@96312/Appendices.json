{"hands_on_practices": [{"introduction": "在深入研究有限元法等数值技术之前，掌握经典梁理论的解析解法至关重要。本练习将带您从第一性原理出发，推导一个典型的结构问题——末端受载荷的悬臂梁的精确挠度曲线 $w(x)$。通过这个过程，您将加深对平衡方程、本构关系和边界条件如何共同确定梁行为的理解，并为后续验证数值模型提供一个精确的基准 [@problem_id:2556579]。", "problem": "考虑一根长度为 $L$、抗弯刚度为 $E I$（其中 $E$ 为杨氏模量，$I$ 为截面二次矩，二者沿梁长保持不变）的细长棱柱梁。其微小横向挠度 $w(x)$ 以向下为正方向。该梁在 $x=0$ 处为固定端，在 $x=L$ 处为自由端。一个大小为 $P$ 的静态集中横向载荷作用在自由端 $x=L$ 处，方向为正（向下）。假设满足欧拉-伯努利运动学假设（平截面在变形后仍保持为平面且垂直于变形后的中性轴）和线性弹性条件，并忽略轴向变形和转动惯量。\n\n从适用于有限元法（FEM）中欧拉-伯努利梁的第一性原理出发——即：\n- 基于小转角、线性弹性本构律和欧拉-伯努利运动学的曲率-弯矩关系，\n- 以及根据牛顿定律推导出的内剪力和弯矩的静力平衡关系——\n\n推导在无分布载荷情况下的横向位移 $w(x)$ 的控制微分方程，确定带有端部载荷 $P$ 的悬臂梁的相应边界条件，并求解该边值问题以获得在 $0 \\le x \\le L$ 区间上横向挠度场 $w(x)$ 的闭式解。\n\n将最终答案表示为 $w(x)$ 关于 $P$、$E$、$I$、$L$ 和 $x$ 的单一闭式解析表达式。不要代入数值。最终方框内的答案不应包含单位。无需四舍五入。", "solution": "所述问题是线性梁理论中的一个经典练习。该问题提法适定，有科学依据，并包含了推导唯一解所需的所有信息。因此，该问题是有效的。我们进行推导。\n\n推导过程需要从第一性原理建立控制微分方程，然后在给定的边界条件下求解该方程。\n\n首先，我们建立一个一致的符号约定：\n1.  坐标 $x$ 从固定端 $x=0$ 延伸到自由端 $x=L$。\n2.  横向挠度 $w(x)$ 以向下为正方向。\n3.  如果弯矩 $M(x)$ 导致梁的底部纤维受拉，则其为正。正弯矩使梁向下弯曲，产生向上凹的曲率。\n4.  内剪力 $V(x)$ 和分布载荷 $q(x)$ 也以向下为正方向。\n\n我们从**静力平衡关系**开始。考虑位于位置 $x$ 处，长度为 $dx$ 的梁微元。\n对于竖向力平衡，向下的力之和为零：\n$$V(x) + q(x)dx - V(x+dx) = 0$$\n使用泰勒展开 $V(x+dx) = V(x) + \\frac{dV}{dx}dx + O(dx^2)$，上式简化为：\n$$q(x)dx - \\frac{dV}{dx}dx = 0 \\implies \\frac{dV(x)}{dx} = q(x)$$\n对于绕微元右端（位于 $x+dx$ 处）的力矩平衡：\n$$M(x+dx) - M(x) - V(x)dx - q(x)dx \\frac{dx}{2} = 0$$\n两边同除以 $dx$ 并取 $dx \\to 0$ 的极限，我们忽略高阶项：\n$$\\frac{dM(x)}{dx} = V(x)$$\n\n接下来，我们建立**曲率-弯矩关系**。曲率 $\\kappa$ 定义为曲率半径的倒数。对于小挠度，它可以用挠度函数的二阶导数来近似。一个关键细节是符号。正弯矩 $M$ 导致梁向下弯曲，这是一个向上凹的形状。当 $f''(x)>0$ 时，函数 $f(x)$ 是向上凹的。如果我们的挠度以向上为正，记为 $w_{up}(x)$，那么我们有 $\\kappa \\approx w_{up}''(x)$。由于我们的挠度 $w(x)$ 以向下为正，我们有 $w(x) = -w_{up}(x)$，这意味着 $w''(x) = -w_{up}''(x)$。因此，用我们以向下为正的挠度 $w(x)$ 表示的曲率为：\n$$\\kappa \\approx -w_{up}''(x) = -(-w''(x)) = w''(x)$$\n等等，这不正确。我们重新陈述一下。\n对于一个函数 $f(x)$，如果函数是向上凹的（$f''>0$），则曲率为正。我们的坐标 $w(x)$ 是向下为正。所以一个向下弯曲的形状（向上凹）对应于当 $x$ 远离最小值点时 $w(x)$ 的值变得不那么负或更正；简而言之，$w''(x)>0$ 代表一个向上凹的形状。不，这也不正确。如果 $w(x)$ 描述形状，那么 $w''>0$ 是向上凹的。但 $w$ 是位移，不是形状。让我们精确一点。变形梁的形状由 $(x,y)$ 平面中的曲线 $y=w(x)$ 给出，其中 $y$ 是向下的坐标。向上凹意味着 $w''(x)>0$。根据我们的符号约定，正弯矩 $M$ 导致一个向上凹的形状。因此，正的 $M$ 对应于正的 $w''(x)$。\n线性弹性的本构关系与欧拉-伯努利运动学结合，给出 $M(x) = EI\\kappa$。在小挠度下，$\\kappa \\approx w''(x)$。这得出了关系式 $M(x) = EI \\frac{d^2w}{dx^2}$。我们来重新验证一下。如果 $w$ 以向上为正，标准关系式是 $M = EI w''$。如果我们改变坐标为 $z=-w$（这样 $z$ 向下为正），那么 $w'' = -z''$。代入后得到 $M = -EI z''$。这对于向下为正的坐标系是正确的关系式。上述推理中的错误是微妙的。正弯矩使底部受拉，使梁呈微笑状（向上凹）。在一个以“下”为正的坐标系中，微笑形状的二阶导数为负。例如，$w(x) = A - kx^2$（其中 $k>0$），其二阶导数为 $w''=-2k<0$。因此，正弯矩 $M$ 必须对应于负的 $w''(x)$。\n正确的弯矩-曲率关系是：\n$$M(x) = -EI \\frac{d^2w(x)}{dx^2}$$\n\n现在，我们将平衡关系和本构关系结合起来，以推导**控制微分方程**。\n$$V(x) = \\frac{dM(x)}{dx} = -EI \\frac{d^3w(x)}{dx^3}$$\n$$\\frac{dV(x)}{dx} = q(x) \\implies -EI \\frac{d^4w(x)}{dx^4} = q(x)$$\n$$EI \\frac{d^4w(x)}{dx^4} = -q(x)$$\n问题指明没有分布载荷，因此 $q(x)=0$。所以，梁的控制微分方程是：\n$$EI \\frac{d^4w(x)}{dx^4} = 0$$\n\n这个常微分方程的通解是一个三次多项式，通过对 $x$ 积分四次得到：\n$$w(x) = \\frac{C_1}{6}x^3 + \\frac{C_2}{2}x^2 + C_3x + C_4$$\n四个积分常数（$C_1$、$C_2$、$C_3$、$C_4$）由四个**边界条件**确定。\n\n梁在 $x=0$ 处是固定的，这意味着挠度和转角都为零：\n1.  $w(0) = 0$（零挠度）\n2.  $\\frac{dw}{dx}(0) = 0$（零转角）\n\n梁在 $x=L$ 处是自由的，但有一个方向为正（向下）的集中载荷 $P$ 作用。自由端意味着内部弯矩为零，且剪力与所施加的任何点载荷相平衡。\n3.  $M(L) = 0$（零弯矩）。使用我们推导的关系式：\n    $$-EI \\frac{d^2w}{dx^2}(L) = 0 \\implies \\frac{d^2w}{dx^2}(L) = 0$$\n4.  $V(L) = P$（剪力等于点载荷）。在 $x=L^-$ 处的横截面上的剪力必须与向下的载荷 $P$ 平衡。根据我们的符号约定（剪力向下为正），这意味着 $V(L)=P$。使用我们推导的关系式：\n    $$-EI \\frac{d^3w}{dx^3}(L) = P \\implies \\frac{d^3w}{dx^3}(L) = -\\frac{P}{EI}$$\n\n现在我们将这四个边界条件应用于通解：\n由 $w(0)=0$ 可得：\n$$w(0) = \\frac{C_1}{6}(0)^3 + \\frac{C_2}{2}(0)^2 + C_3(0) + C_4 = 0 \\implies C_4 = 0$$\n\n由 $\\frac{dw}{dx}(0)=0$ 可得：\n首先，求通解的导数：$\\frac{dw}{dx} = \\frac{C_1}{2}x^2 + C_2x + C_3$。\n$$\\frac{dw}{dx}(0) = \\frac{C_1}{2}(0)^2 + C_2(0) + C_3 = 0 \\implies C_3 = 0$$\n\n由 $\\frac{d^2w}{dx^2}(L)=0$ 可得：\n求二阶导数：$\\frac{d^2w}{dx^2} = C_1x + C_2$。\n$$\\frac{d^2w}{dx^2}(L) = C_1L + C_2 = 0 \\implies C_2 = -C_1L$$\n\n由 $\\frac{d^3w}{dx^3}(L) = -\\frac{P}{EI}$ 可得：\n求三阶导数：$\\frac{d^3w}{dx^3} = C_1$。\n$$\\frac{d^3w}{dx^3}(L) = C_1 = -\\frac{P}{EI}$$\n\n现在我们可以确定所有常数。\n$$C_1 = -\\frac{P}{EI}$$\n$$C_2 = -C_1L = - \\left(-\\frac{P}{EI}\\right)L = \\frac{PL}{EI}$$\n$$C_3 = 0$$\n$$C_4 = 0$$\n\n最后，将这些常数代回 $w(x)$ 的通解中：\n$$w(x) = \\left(-\\frac{P}{EI}\\right) \\frac{x^3}{6} + \\left(\\frac{PL}{EI}\\right) \\frac{x^2}{2} + 0 \\cdot x + 0$$\n$$w(x) = \\frac{P}{EI} \\left(-\\frac{x^3}{6} + \\frac{Lx^2}{2}\\right)$$\n提取公因子，得到横向挠度场的最终闭式表达式：\n$$w(x) = \\frac{Px^2}{6EI} (3L - x)$$\n该表达式正确地给出了在 $0 \\le x \\le L$ 区间上为正（向下）的挠度，并且在自由端正确地计算出众所周知的最大挠度 $w(L) = \\frac{PL^3}{3EI}$。", "answer": "$$\n\\boxed{\\frac{P x^{2}}{6 E I} (3 L - x)}\n$$", "id": "2556579"}, {"introduction": "有限元法（FEM）的精髓在于将连续的物理问题离散化为代数方程组。本练习是您理解这一过程的核心，您将推导欧拉-伯努利梁单元的刚度矩阵 $\\mathbf{K}_{e}$，这是有限元分析的基石。通过运用虚功原理和三次埃尔米特插值，您将亲手构建连接节点位移与节点力的关键矩阵，从而揭示有限元软件内部的数学机制 [@problem_id:2556574]。", "problem": "考虑有限元法（FEM）中的一个等截面欧拉-伯努利梁有限元，其杨氏模量 $E$、截面二次矩 $I$ 和单元长度 $L_{e}$ 均为常数。采用经典的小挠度弯曲欧拉-伯努利运动学假设：横截面在变形后保持为平面且垂直于变形后的中性轴，因此转角场等于斜率，$\\theta(x)=\\dfrac{dw}{dx}$，曲率为 $\\kappa(x)=\\dfrac{d\\theta}{dx}=\\dfrac{d^{2}w}{dx^{2}}$。设该单元有两个节点，节点自由度集合为\n$$\n\\mathbf{q}_{e}=\\begin{pmatrix} w_{1} & \\theta_{1} & w_{2} & \\theta_{2}\\end{pmatrix}^{\\mathsf{T}},\n$$\n其中 $w_{a}$ 是节点 $a\\in\\{1,2\\}$ 处的横向位移，$\\theta_{a}$ 是该节点的转角。利用虚功原理和能够精确再现节点位移和转角的 $C^{1}$ 连续插值，推导精确的 $4\\times 4$ 弯曲刚度矩阵 $\\mathbf{K}_{e}$，使得在无分布荷载的情况下，节点力向量 $\\mathbf{f}_{e}=\\begin{pmatrix} V_{1} & M_{1} & V_{2} & M_{2}\\end{pmatrix}^{\\mathsf{T}}$ 满足 $\\mathbf{f}_{e}=\\mathbf{K}_{e}\\mathbf{q}_{e}$，其中 $V_{a}$ 和 $M_{a}$ 分别是节点 $a$ 处的剪力和弯矩。\n\n仅从基本定义出发：内虚功 $\\delta U=\\displaystyle\\int_{0}^{L_{e}} M\\,\\delta\\kappa\\,dx$，线性弹性弯曲关系 $M=E I\\,\\kappa$，以及运动学关系 $\\kappa=\\dfrac{d^{2}w}{dx^{2}}$。为 $w(x)$ 构造所需的插值，该插值需保证 $C^{1}$ 连续性以及节点值和转角的再现，并由此得到曲率-位移算子。将单元刚度矩阵组集为此算子的一个相容二次型，并在单元上进行积分。\n\n将最终答案表示为由 $E$、$I$ 和 $L_{e}$ 表示的单个封闭形式的 $4\\times 4$ 矩阵。无需进行数值计算，也无需四舍五入。在最终的方框表达式中不要包含物理单位。", "solution": "该问题要求推导一个两节点欧拉-伯努利梁单元的弯曲刚度矩阵。该推导必须基于虚功原理，并利用适用于横向位移场 $w(x)$ 的恰当插值方案。\n\n虚功原理的基本陈述是将内虚功 $\\delta U$ 与外虚功 $\\delta W_{\\text{ext}}$ 相等。对于一个仅受节点力和力矩作用的梁单元，这表示为：\n$$\n\\delta U = \\delta W_{\\text{ext}}\n$$\n外虚功是由节点力 $\\mathbf{f}_{e}$ 在虚节点位移 $\\delta\\mathbf{q}_{e}$ 上所做的功：\n$$\n\\delta W_{\\text{ext}} = \\delta w_1 V_1 + \\delta \\theta_1 M_1 + \\delta w_2 V_2 + \\delta \\theta_2 M_2 = \\delta\\mathbf{q}_{e}^{\\mathsf{T}} \\mathbf{f}_{e}\n$$\n内虚功，或称虚应变能，由弯矩 $M$ 和虚曲率 $\\delta\\kappa$ 的乘积在单元长度 $L_{e}$ 上的积分给出：\n$$\n\\delta U = \\int_{0}^{L_{e}} M \\, \\delta\\kappa \\, dx\n$$\n问题指定了线性弹性本构关系 $M = EI\\kappa$，其中 $E$ 是杨氏模量，$I$ 是截面二次矩，两者均为常数。将此代入 $\\delta U$ 的表达式中：\n$$\n\\delta U = \\int_{0}^{L_{e}} (EI\\kappa) \\, \\delta\\kappa \\, dx\n$$\n为了继续推导，位移场 $w(x)$ 必须由节点自由度 $\\mathbf{q}_{e} = \\begin{pmatrix} w_{1} & \\theta_{1} & w_{2} & \\theta_{2}\\end{pmatrix}^{\\mathsf{T}}$ 插值得到。欧拉-伯努利梁的控制微分方程是四阶的，而我们有四个节点自由度。这表明应为 $w(x)$ 采用三次多项式插值，这是能够满足四个节点条件并确保跨单元边界的 $C^{1}$ 连续性（位移 $w$ 和转角 $\\theta = dw/dx$ 的连续性）的最低阶多项式。\n设位移场表示为 $w(x) = \\mathbf{N}(x)\\mathbf{q}_{e}$，其中 $\\mathbf{N}(x)$ 是一个 $1 \\times 4$ 的形函数行向量。\n$$\nw(x) = N_1(x) w_1 + N_2(x) \\theta_1 + N_3(x) w_2 + N_4(x) \\theta_2\n$$\n这些形函数是标准的 Hermite 三次多项式，定义在局部坐标域 $x \\in [0, L_{e}]$ 上。它们通过施加以下节点条件来确定：\n\\begin{itemize}\n    \\item $w(0) = w_1$, $\\frac{dw}{dx}(0) = \\theta_1$\n    \\item $w(L_{e}) = w_2$, $\\frac{dw}{dx}(L_{e}) = \\theta_2$\n\\end{itemize}\n得到的形函数为：\n$$\n\\begin{aligned}\nN_1(x) &= 1 - 3\\left(\\frac{x}{L_{e}}\\right)^2 + 2\\left(\\frac{x}{L_{e}}\\right)^3 \\\\\nN_2(x) &= x - 2L_{e}\\left(\\frac{x}{L_{e}}\\right)^2 + L_{e}\\left(\\frac{x}{L_{e}}\\right)^3 = x \\left(1 - \\frac{x}{L_{e}}\\right)^2 \\\\\nN_3(x) &= 3\\left(\\frac{x}{L_{e}}\\right)^2 - 2\\left(\\frac{x}{L_{e}}\\right)^3 \\\\\nN_4(x) &= -L_{e}\\left(\\frac{x}{L_{e}}\\right)^2 + L_{e}\\left(\\frac{x}{L_{e}}\\right)^3 = \\frac{x^2}{L_{e}} \\left(\\frac{x}{L_{e}} - 1\\right)\n\\end{aligned}\n$$\n曲率 $\\kappa$ 是位移的二阶导数：$\\kappa(x) = \\frac{d^2w}{dx^2}$。对插值位移场求导，我们得到曲率-位移关系：\n$$\n\\kappa(x) = \\frac{d^2}{dx^2} \\left( \\mathbf{N}(x)\\mathbf{q}_{e} \\right) = \\left( \\frac{d^2\\mathbf{N}(x)}{dx^2} \\right) \\mathbf{q}_{e} = \\mathbf{B}(x) \\mathbf{q}_{e}\n$$\n其中 $\\mathbf{B}(x)$ 是应变-位移算子，一个包含形函数二阶导数的 $1 \\times 4$ 行向量：\n$$\n\\mathbf{B}(x) = \\begin{pmatrix} N_1''(x) & N_2''(x) & N_3''(x) & N_4''(x) \\end{pmatrix}\n$$\n二阶导数为：\n$$\n\\begin{aligned}\nN_1''(x) &= \\frac{1}{L_{e}^2}\\left(-6 + 12\\frac{x}{L_{e}}\\right) \\\\\nN_2''(x) &= \\frac{1}{L_{e}}\\left(-4 + 6\\frac{x}{L_{e}}\\right) \\\\\nN_3''(x) &= \\frac{1}{L_{e}^2}\\left(6 - 12\\frac{x}{L_{e}}\\right) \\\\\nN_4''(x) &= \\frac{1}{L_{e}}\\left(-2 + 6\\frac{x}{L_{e}}\\right)\n\\end{aligned}\n$$\n于是，虚曲率为 $\\delta\\kappa(x) = \\mathbf{B}(x)\\delta\\mathbf{q}_{e}$。将 $\\kappa$ 和 $\\delta\\kappa$ 的表达式代入内虚功方程：\n$$\n\\delta U = \\int_{0}^{L_{e}} EI \\left( \\mathbf{B}(x) \\mathbf{q}_{e} \\right)^{\\mathsf{T}} \\left( \\mathbf{B}(x) \\delta\\mathbf{q}_{e} \\right) dx = \\int_{0}^{L_{e}} \\left( \\delta\\mathbf{q}_{e}^{\\mathsf{T}} \\mathbf{B}(x)^{\\mathsf{T}} \\right) EI \\left( \\mathbf{B}(x) \\mathbf{q}_{e} \\right) dx\n$$\n由于 $\\mathbf{q}_{e}$ 和 $\\delta\\mathbf{q}_{e}$ 是相对于 $x$ 的积分而言的常数向量，我们可以写出：\n$$\n\\delta U = \\delta\\mathbf{q}_{e}^{\\mathsf{T}} \\left( \\int_{0}^{L_{e}} EI \\mathbf{B}(x)^{\\mathsf{T}} \\mathbf{B}(x) \\, dx \\right) \\mathbf{q}_{e}\n$$\n令内虚功与外虚功相等，即 $\\delta\\mathbf{q}_{e}^{\\mathsf{T}} \\mathbf{f}_{e} = \\delta U$，我们得到：\n$$\n\\delta\\mathbf{q}_{e}^{\\mathsf{T}} \\mathbf{f}_{e} = \\delta\\mathbf{q}_{e}^{\\mathsf{T}} \\left( \\int_{0}^{L_{e}} EI \\mathbf{B}(x)^{\\mathsf{T}} \\mathbf{B}(x) \\, dx \\right) \\mathbf{q}_{e}\n$$\n由于此式必须对任意虚位移 $\\delta\\mathbf{q}_{e} \\neq \\mathbf{0}$ 成立，我们得到单元力-位移关系 $\\mathbf{f}_{e} = \\mathbf{K}_{e}\\mathbf{q}_{e}$，其中刚度矩阵 $\\mathbf{K}_{e}$ 为：\n$$\n\\mathbf{K}_{e} = \\int_{0}^{L_{e}} EI \\, \\mathbf{B}(x)^{\\mathsf{T}} \\mathbf{B}(x) \\, dx\n$$\n刚度矩阵的分量 $K_{ij}$ 按 $K_{ij} = \\int_{0}^{L_{e}} EI \\, B_i(x) B_j(x) \\, dx$ 计算。我们进行变量替换，引入无量纲坐标 $\\xi = x/L_{e}$，因此 $dx = L_{e} d\\xi$。积分限变为 $0$ 到 $1$。$\\mathbf{B}$ 的分量变为：\n$B_1(\\xi) = \\frac{1}{L_{e}^2}(-6+12\\xi)$，$B_2(\\xi) = \\frac{1}{L_{e}}(-4+6\\xi)$，$B_3(\\xi) = \\frac{1}{L_{e}^2}(6-12\\xi)$，$B_4(\\xi) = \\frac{1}{L_{e}}(-2+6\\xi)$。\n我们计算必要的积分。例如，对于分量 $K_{11}$：\n$$\nK_{11} = EI \\int_0^1 \\left(\\frac{1}{L_{e}^2}(-6+12\\xi)\\right)^2 L_{e} \\, d\\xi = \\frac{EI}{L_{e}^3} \\int_0^1 (36 - 144\\xi + 144\\xi^2) \\, d\\xi = \\frac{EI}{L_{e}^3} [36\\xi - 72\\xi^2 + 48\\xi^3]_0^1 = \\frac{12EI}{L_{e}^3}\n$$\n对于分量 $K_{12}$：\n$$\nK_{12} = EI \\int_0^1 \\left(\\frac{-6+12\\xi}{L_{e}^2}\\right)\\left(\\frac{-4+6\\xi}{L_{e}}\\right) L_{e} \\, d\\xi = \\frac{EI}{L_{e}^2} \\int_0^1 (24 - 84\\xi + 72\\xi^2) \\, d\\xi = \\frac{EI}{L_{e}^2} [24\\xi - 42\\xi^2 + 24\\xi^3]_0^1 = \\frac{6EI}{L_{e}^2}\n$$\n对于分量 $K_{22}$：\n$$\nK_{22} = EI \\int_0^1 \\left(\\frac{-4+6\\xi}{L_{e}}\\right)^2 L_{e} \\, d\\xi = \\frac{EI}{L_{e}} \\int_0^1 (16 - 48\\xi + 36\\xi^2) \\, d\\xi = \\frac{EI}{L_{e}} [16\\xi - 24\\xi^2 + 12\\xi^3]_0^1 = \\frac{4EI}{L_{e}}\n$$\n剩余的分量可类似计算，或由形函数导数的对称和反对称性质（$N_3''(x) = -N_1''(x)$）推得。这导出了诸如 $K_{13} = -K_{11}$ 和 $K_{33} = K_{11}$ 之类的关系。在计算完所有独立分量并将其组集后，我们得到单元刚度矩阵。提出公因子 $\\frac{EI}{L_{e}^3}$，便得到最终的矩阵。\n$$\n\\mathbf{K}_{e} = \\frac{EI}{L_{e}^3}\n\\begin{pmatrix}\n12 & 6L_{e} & -12 & 6L_{e} \\\\\n6L_{e} & 4L_{e}^2 & -6L_{e} & 2L_{e}^2 \\\\\n-12 & -6L_{e} & 12 & -6L_{e} \\\\\n6L_{e} & 2L_{e}^2 & -6L_{e} & 4L_{e}^2\n\\end{pmatrix}\n$$\n这就是在三次位移场假设下，等截面欧拉-伯努利梁单元的精确弯曲刚度矩阵。", "answer": "$$\n\\boxed{\\frac{EI}{L_{e}^{3}} \\begin{pmatrix} 12 & 6 L_{e} & -12 & 6 L_{e} \\\\ 6 L_{e} & 4 L_{e}^{2} & -6 L_{e} & 2 L_{e}^{2} \\\\ -12 & -6 L_{e} & 12 & -6 L_{e} \\\\ 6 L_{e} & 2 L_{e}^{2} & -6 L_{e} & 4 L_{e}^{2} \\end{pmatrix}}\n$$", "id": "2556574"}, {"introduction": "本练习将理论知识与计算实践相结合，要求您实现一个完整的有限元程序来解决结构稳定性问题。您将不仅使用在之前练习中建立的弯曲刚度矩阵概念，还将推导并应用几何刚度矩阵来分析梁的线性屈曲。通过编写代码解决一个广义特征值问题以确定临界载荷 $P_{\\text{cr}}$ 并与精确解进行比较，您将体验到有限元方法在预测结构失效和验证模型方面的强大功能 [@problem_id:2556607]。", "problem": "考虑一根细长、等截面梁，其运动学遵循Euler-Bernoulli理论：在长度为 $L$ 的跨度上，横向位移场为 $w(x)$，挠度和转角均为小量，平面横截面在变形后保持为平面且垂直于中性轴，曲率为 $\\kappa(x) = d^2 w/dx^2$。设梁具有恒定的抗弯刚度 $E I$ 并承受均匀轴向压缩荷载 $P$，从而产生经典的线性弹性屈曲。使用有限元法（FEM），每个节点具有两个自由度，即横向位移 $w$ 和横截面转角 $\\theta = dw/dx$，并在每个单元上通过三次Hermite插值进行近似。从虚功原理和内弯曲能的定义出发，构建单元抗弯刚度矩阵以及由轴向力的二阶功产生的几何刚度矩阵。组装全局系统，并在两端施加简支约束（两端铰支）：$w(0)=0$ 和 $w(L)=0$，端点转角不受约束。建立并求解广义线性屈曲特征值问题，以获得最小的正临界荷载。\n\n您的推导和实现必须仅基于基本定律和核心定义，例如Euler-Bernoulli梁运动学、虚功原理以及弯曲和轴向预应力的能量表达式。请勿使用任何绕过这些基础的预先推导的简化公式。用于验证的基准，即两端铰支梁基本屈曲荷载的连续介质解析解，必须从同一理论的第一性原理推导得出。所有计算必须采用国际单位制（SI）：$E$ 的单位为帕斯卡（牛顿/平方米），$I$ 的单位为$米^4$，$L$ 的单位为$米$，屈曲荷载的单位为牛顿。下文要求的最终数值输出是无量纲的相对误差；因此，这些输出没有物理单位。\n\n实现一个程序，对下述每个测试用例，计算：\n- 从组装的有限元模型的广义特征值问题中得到的最小正屈曲特征值 $P_{\\text{FE}}$（单位：牛顿），以及\n- 相对误差 $|P_{\\text{FE}} - P_{\\text{exact}}| / P_{\\text{exact}}$，其中 $P_{\\text{exact}}$ 是从连续介质理论推导出的两端铰支边界条件下的精确解析基本屈曲荷载。\n\n您的程序必须求解以下测试套件，每个测试用例指定为一个元组 $(E, I, L, N)$，其中 $N$ 是等长度有限单元的数量：\n- 测试 A（类钢梁的网格细化）：$(E, I, L, N) = (210 \\times 10^9, 8.1 \\times 10^{-6}, 2.0, 1)$\n- 测试 B：$(E, I, L, N) = (210 \\times 10^9, 8.1 \\times 10^{-6}, 2.0, 2)$\n- 测试 C：$(E, I, L, N) = (210 \\times 10^9, 8.1 \\times 10^{-6}, 2.0, 4)$\n- 测试 D：$(E, I, L, N) = (210 \\times 10^9, 8.1 \\times 10^{-6}, 2.0, 8)$\n- 测试 E：$(E, I, L, N) = (210 \\times 10^9, 8.1 \\times 10^{-6}, 2.0, 16)$\n- 测试 F（不同材料和几何形状）：$(E, I, L, N) = (70 \\times 10^9, 3.2 \\times 10^{-6}, 1.5, 12)$\n- 测试 G（非常细长的梁）：$(E, I, L, N) = (200 \\times 10^9, 5.0 \\times 10^{-8}, 10.0, 40)$\n\n对于每个测试用例，将相对误差计算为十进制数。您的程序应生成单行输出，其中包含一个逗号分隔的结果列表，该列表用方括号括起，顺序为A到G，例如 `[a,b,c,d,e,f,g]`。角度（如果处理任何中间角度）必须以弧度为单位。不提供用户输入；所有数据均如上所述。数值方法必须具有通用性：不要硬编码任何精确的屈曲荷载值；在程序中从连续介质Euler-Bernoulli理论推导解析基准，并用其进行比较。最终输出是对应于测试A到G的七个浮点数相对误差列表，需严格按此顺序，并以十进制数表示。", "solution": "问题陈述经评估后被认为是有效的。它具有科学依据、问题设定合理、客观，并包含构建和求解所需量的所有必要信息。该问题是有限元法在线性弹性梁屈曲分析中的经典应用，基于连续介质力学和虚功的既定原理。\n\n求解过程如下。首先，使用连续介质力学公式推导出基本屈曲荷载的精确解析解，该解将用作基准。其次，从虚功原理推导出有限元公式，从而得到单元刚度矩阵和几何刚度矩阵。第三，详细说明组装全局系统、施加边界条件以及求解由此产生的广义特征值问题的过程。\n\n线性弹性屈曲的控制原理源于总势能的二阶变分为零，即 $\\delta^2 \\Pi = 0$。对于承受压缩轴向荷载 $P$、抗弯刚度为 $EI$ 的梁，此条件可通过虚功原理表示为弯曲应力的内虚功与轴向力 $P$ 在屈曲构型的位移上所做的虚功之间的平衡。对于虚横向位移 $\\delta w$，得到的弱形式为：\n$$ \\delta U - \\delta W_P = \\int_{0}^{L} EI \\frac{d^2w}{dx^2} \\frac{d^2(\\delta w)}{dx^2} \\,dx - P \\int_{0}^{L} \\frac{dw}{dx} \\frac{d(\\delta w)}{dx} \\,dx = 0 $$\n其中 $w(x)$ 是横向位移场。\n\n首先，我们从控制方程的强形式推导精确解析解。这是通过对弱形式进行分部积分并应用变分法基本引理得到的。得到的Euler-Lagrange方程是著名的梁屈曲四阶常微分方程：\n$$ EI \\frac{d^4 w}{dx^4} + P \\frac{d^2 w}{dx^2} = 0 $$\n我们定义 $k^2 = P / (EI)$。方程变为 $\\frac{d^4 w}{dx^4} + k^2 \\frac{d^2 w}{dx^2} = 0$。其通解为：\n$$ w(x) = C_1 \\sin(kx) + C_2 \\cos(kx) + C_3 x + C_4 $$\n两端铰支梁（简支）的边界条件是两端位移为零和弯矩为零：\n$1.$ $w(0) = 0$\n$2.$ $w(L) = 0$\n$3.$ $M(0) = -EI \\frac{d^2 w}{dx^2}|_{x=0} = 0$\n$4.$ $M(L) = -EI \\frac{d^2 w}{dx^2}|_{x=L} = 0$\n\n依次应用这些条件：\n由 $w(0)=0$ 得：$C_2 + C_4 = 0$。\n由 $M(0)=0$ 得：$\\frac{d^2 w}{dx^2} = -k^2(C_1 \\sin(kx) + C_2 \\cos(kx))$。在 $x=0$ 处，这给出 $-k^2 C_2 = 0$。由于对于非平凡解，$k \\neq 0$，因此必须有 $C_2 = 0$。这意味着 $C_4 = 0$。\n解简化为 $w(x) = C_1 \\sin(kx) + C_3 x$。\n由 $w(L)=0$ 得：$C_1 \\sin(kL) + C_3 L = 0$。\n由 $M(L)=0$ 得：$-EI(-k^2 C_1 \\sin(kL)) = 0$，简化为 $C_1 \\sin(kL) = 0$。\n对于非平凡的屈曲形态，$C_1$ 不能为零。因此，必须有 $\\sin(kL) = 0$。这也从前一个条件中意味着 $C_3 L = 0$，所以 $C_3 = 0$。\n特征值方程是 $\\sin(kL) = 0$，这得出 $kL = n\\pi$ 对于任何整数 $n \\geq 1$。\n代入 $k = \\sqrt{P/(EI)}$，我们找到临界荷载：\n$$ P_n = \\frac{n^2 \\pi^2 EI}{L^2} $$\n基本（最小正）屈曲荷载对应于 $n=1$：\n$$ P_{\\text{exact}} = \\frac{\\pi^2 EI}{L^2} $$\n该解析结果将用于计算有限元解的相对误差。\n\n接下来，我们构建有限元法解。梁被离散为 $N$ 个等长度的单元，单元长度 $l_e = L/N$。每个单元有两个节点，每个节点有两个自由度（DOF）：横向位移 $w$ 和转角 $\\theta = dw/dx$。单元节点位移向量为 $\\mathbf{d}_e = \\{w_1, \\theta_1, w_2, \\theta_2\\}^T$。\n单元内的位移场使用三次Hermite形函数 $\\mathbf{N}(\\xi) = [N_1(\\xi), N_2(\\xi), N_3(\\xi), N_4(\\xi)]$ 进行插值，其中 $\\xi = x/l_e$ 是自然坐标（$0 \\le \\xi \\le 1$）：\n$$ w(\\xi) = \\mathbf{N}(\\xi) \\mathbf{d}_e $$\n形函数为：\n$N_1(\\xi) = 1 - 3\\xi^2 + 2\\xi^3$\n$N_2(\\xi) = l_e(\\xi - 2\\xi^2 + \\xi^3)$\n$N_3(\\xi) = 3\\xi^2 - 2\\xi^3$\n$N_4(\\xi) = l_e(-\\xi^2 + \\xi^3)$\n\n将插值位移场代入弱形式，得到单元级矩阵方程。\n第一项给出单元抗弯刚度矩阵 $\\mathbf{k}_e$：\n$$ \\delta\\mathbf{d}_e^T \\mathbf{k}_e \\mathbf{d}_e = \\int_{0}^{l_e} EI \\left(\\frac{d^2w}{dx^2}\\right) \\left(\\frac{d^2(\\delta w)}{dx^2}\\right) \\,dx = \\delta\\mathbf{d}_e^T \\left( \\int_{0}^{l_e} EI (\\mathbf{B}_{\\text{curv}})^T \\mathbf{B}_{\\text{curv}} \\,dx \\right) \\mathbf{d}_e $$\n其中 $\\mathbf{B}_{\\text{curv}} = d^2\\mathbf{N}/dx^2$。积分得到标准的单元抗弯刚度矩阵：\n$$ \\mathbf{k}_e = \\frac{EI}{l_e^3} \\begin{bmatrix} 12 & 6l_e & -12 & 6l_e \\\\ 6l_e & 4l_e^2 & -6l_e & 2l_e^2 \\\\ -12 & -6l_e & 12 & -6l_e \\\\ 6l_e & 2l_e^2 & -6l_e & 4l_e^2 \\end{bmatrix} $$\n弱形式中的第二项给出单元几何刚度矩阵 $\\mathbf{k}_{g,e}$，它考虑了轴向力 $P$ 的影响：\n$$ \\delta\\mathbf{d}_e^T (P \\mathbf{k}_{g,e}) \\mathbf{d}_e = P \\int_{0}^{l_e} \\left(\\frac{dw}{dx}\\right) \\left(\\frac{d(\\delta w)}{dx}\\right) \\,dx = P \\delta\\mathbf{d}_e^T \\left( \\int_{0}^{l_e} (\\mathbf{B}_{\\text{slope}})^T \\mathbf{B}_{\\text{slope}} \\,dx \\right) \\mathbf{d}_e $$\n其中 $\\mathbf{B}_{\\text{slope}} = d\\mathbf{N}/dx$。积分得到单元几何刚度矩阵：\n$$ \\mathbf{k}_{g,e} = \\frac{1}{30l_e} \\begin{bmatrix} 36 & 3l_e & -36 & 3l_e \\\\ 3l_e & 4l_e^2 & -3l_e & -l_e^2 \\\\ -36 & -3l_e & 36 & -3l_e \\\\ 3l_e & -l_e^2 & -3l_e & 4l_e^2 \\end{bmatrix} $$\n单元矩阵被组装成全局矩阵 $\\mathbf{K}$ 和 $\\mathbf{K}_g$，从而得到线性屈曲的全局系统：\n$$ \\mathbf{K} \\mathbf{D} = P \\mathbf{K}_g \\mathbf{D} $$\n其中 $\\mathbf{D}$ 是全局节点自由度向量。对于 $N$ 个单元（以及 $N+1$ 个节点），全局系统的大小为 $(2(N+1)) \\times (2(N+1))$。\n\n施加两端铰支边界条件，$w(0)=0$ 和 $w(L)=0$。这对应于第一个自由度（$w_0$）和索引为 $2N$ 的自由度（$w_N$）为零。我们通过从全局矩阵 $\\mathbf{K}$ 和 $\\mathbf{K}_g$ 中消除相应的行和列来强制执行这些条件，以形成缩减后的系统：\n$$ \\mathbf{K}_{\\text{red}} \\mathbf{D}_{\\text{red}} = P \\mathbf{K}_{g, \\text{red}} \\mathbf{D}_{\\text{red}} $$\n这是一个广义特征值问题。特征值 $P$ 是临界屈曲荷载，特征向量 $\\mathbf{D}_{\\text{red}}$ 是对应的屈曲模态振型。我们求解此系统以找到最小的正特征值，该值对应于有限元模型预测的基本屈曲荷载 $P_{\\text{FE}}$。\n\n最后，使用以下公式为每个测试用例计算相对误差：\n$$ \\text{相对误差} = \\frac{|P_{\\text{FE}} - P_{\\text{exact}}|}{P_{\\text{exact}}} $$\n该实现将为每组提供的参数 $(E, I, L, N)$ 执行这些步骤。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eig\n\ndef solve():\n    \"\"\"\n    Solves for the fundamental buckling load of a pinned-pinned beam using FEM\n    and compares it to the exact analytical solution.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (E, I, L, N).\n    test_cases = [\n        (210e9, 8.1e-6, 2.0, 1),   # Test A\n        (210e9, 8.1e-6, 2.0, 2),   # Test B\n        (210e9, 8.1e-6, 2.0, 4),   # Test C\n        (210e9, 8.1e-6, 2.0, 8),   # Test D\n        (210e9, 8.1e-6, 2.0, 16),  # Test E\n        (70e9, 3.2e-6, 1.5, 12),   # Test F\n        (200e9, 5.0e-8, 10.0, 40), # Test G\n    ]\n\n    results = []\n    for E, I, L, N in test_cases:\n        # Step 1: Calculate the exact analytical fundamental buckling load\n        P_exact = (np.pi**2 * E * I) / (L**2)\n\n        # Step 2: FEM formulation\n        num_nodes = N + 1\n        num_dofs = 2 * num_nodes\n        le = L / N\n\n        # Define element bending stiffness matrix (ke)\n        ke = (E * I / le**3) * np.array([\n            [12, 6 * le, -12, 6 * le],\n            [6 * le, 4 * le**2, -6 * le, 2 * le**2],\n            [-12, -6 * le, 12, -6 * le],\n            [6 * le, 2 * le**2, -6 * le, 4 * le**2]\n        ])\n\n        # Define element geometric stiffness matrix (kge)\n        kge = (1 / (30 * le)) * np.array([\n            [36, 3 * le, -36, 3 * le],\n            [3 * le, 4 * le**2, -3 * le, -le**2],\n            [-36, -3 * le, 36, -3 * le],\n            [3 * le, -le**2, -3 * le, 4 * le**2]\n        ])\n\n        # Step 3: Assemble global matrices\n        K_global = np.zeros((num_dofs, num_dofs))\n        Kg_global = np.zeros((num_dofs, num_dofs))\n\n        for i in range(N):\n            # Global DOFs for element i (connecting nodes i and i+1)\n            # DOFs are w_i, theta_i, w_{i+1}, theta_{i+1}\n            dof_indices = np.array([2*i, 2*i + 1, 2*i + 2, 2*i + 3])\n            \n            # Add element matrices to global matrices\n            K_global[np.ix_(dof_indices, dof_indices)] += ke\n            Kg_global[np.ix_(dof_indices, dof_indices)] += kge\n\n        # Step 4: Apply pinned-pinned boundary conditions\n        # w(0) = 0 -> DOF 0 is constrained\n        # w(L) = 0 -> DOF 2*N is constrained\n        \n        # Identify degrees of freedom to keep\n        all_dofs = list(range(num_dofs))\n        constrained_dofs = [0, 2 * N]\n        kept_dofs = [dof for dof in all_dofs if dof not in constrained_dofs]\n        \n        # Reduce the global matrices\n        K_red = K_global[np.ix_(kept_dofs, kept_dofs)]\n        Kg_red = Kg_global[np.ix_(kept_dofs, kept_dofs)]\n\n        # Step 5: Solve the generalized eigenvalue problem K_red*v = P*Kg_red*v\n        eigenvalues, _ = eig(K_red, Kg_red)\n        \n        # The eigenvalues are the critical loads P. We need the smallest positive one.\n        # Eigenvalues may be complex due to numerical precision, so we take the real part.\n        positive_eigenvalues = np.real(eigenvalues[eigenvalues > 1e-6]) # Filter for positive\n        \n        if len(positive_eigenvalues) == 0:\n            # This case should not happen for a valid physical problem setup\n            P_fe = np.nan \n        else:\n            P_fe = np.min(positive_eigenvalues)\n\n        # Step 6: Calculate the relative error\n        relative_error = abs(P_fe - P_exact) / P_exact\n        results.append(relative_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n\nsolve()\n```", "id": "2556607"}]}