{"hands_on_practices": [{"introduction": "本次实践是有限元梁分析的基石。我们将从第一性原理出发——即应变能和 Hermite 插值函数——来推导欧拉-伯努利梁单元经典的 $4 \\times 4$ 刚度矩阵。掌握这一基本推导对于理解材料属性 ($E$)、几何形状 ($I$, $L$) 和节点自由度如何通过数学方式联系起来，以表示梁的弯曲行为至关重要。[@problem_id:2599805]", "problem": "一个长度为 $L$、抗弯刚度 $E I$ 恒定的直等截面欧拉-伯努利梁单元，被建模用于分析其绕主轴的平面弯曲。该单元有两个节点，分别位于 $x=0$ 和 $x=L$ 处。节点自由度 (DOF) 包括横向位移 $w_1$、$w_2$ 和转角 $\\theta_1$、$\\theta_2$，它们被组合成向量 $\\mathbf{d} = [\\, w_1 \\ \\ \\theta_1 \\ \\ w_2 \\ \\ \\theta_2 \\,]^{\\mathsf{T}}$。假设采用欧拉-伯努利运动学，因此曲率为 $\\kappa(x) = w''(x)$，且忽略剪切变形。\n\n从弯曲应变能\n$$\nU = \\frac{1}{2} \\int_{0}^{L} E I \\big(w''(x)\\big)^{2} \\, dx,\n$$\n和驻定总势能原理出发，推导协调单元弯曲刚度矩阵 $\\mathbf{K}_e$，使得 $\\mathbf{K}_e \\, \\mathbf{d}$ 能够给出该单元的节点弯曲力和力矩。对 $w(x)$ 使用一个 $C^1$ 连续的三次插值，该插值能精确地插值节点位移和转角，即由条件 $w(0)=w_1$、$w'(0)=\\theta_1$、$w(L)=w_2$ 和 $w'(L)=\\theta_2$ 定义的埃尔米特型插值。\n\n计算对于常数 $E I$ 和长度 $L$ 的 $4 \\times 4$ 弯曲刚度矩阵的闭合形式。将最终答案表示为一个以 $E$、$I$ 和 $L$ 表示的符号矩阵，并提出标量因子 $\\dfrac{E I}{L^3}$。无需进行数值计算，最终表达式中不应包含任何单位。", "solution": "该问题是有效的。这是结构分析有限元方法理论中的一个标准的、良态的推导。所有物理原理和数学要求都是合理且自洽的。\n\n目标是为一个平面欧拉-伯努利梁单元推导其单元刚度矩阵 $\\mathbf{K}_e$。应变能 $U$ 由下式给出\n$$\nU = \\frac{1}{2} \\int_{0}^{L} E I \\big(w''(x)\\big)^{2} \\, dx\n$$\n其中 $w(x)$ 是横向位移场，$E I$ 是恒定的抗弯刚度，$L$ 是单元长度。刚度矩阵通过二次型\n$$\nU = \\frac{1}{2} \\mathbf{d}^{\\mathsf{T}} \\mathbf{K}_e \\mathbf{d}\n$$\n将节点自由度 (DOF) $\\mathbf{d}$ 与应变能 $U$ 联系起来。\n节点自由度向量定义为 $\\mathbf{d} = [\\, w_1 \\ \\ \\theta_1 \\ \\ w_2 \\ \\ \\theta_2 \\,]^{\\mathsf{T}}$，其中 $w_1$、$\\theta_1$ 是位于 $x=0$ 处节点的位移和转角，而 $w_2$、$\\theta_2$ 是位于 $x=L$ 处节点的位移和转角。\n\n位移场 $w(x)$ 是使用 $C^1$ 连续的三次埃尔米特形函数 $N_i(x)$ 从节点自由度插值得到的：\n$$\nw(x) = N_1(x) w_1 + N_2(x) \\theta_1 + N_3(x) w_2 + N_4(x) \\theta_2 = \\mathbf{N}(x) \\mathbf{d}\n$$\n其中 $\\mathbf{N}(x) = [\\, N_1(x) \\ \\ N_2(x) \\ \\ N_3(x) \\ \\ N_4(x) \\,]$ 是形函数的行向量。这些函数是通过施加条件 $w(0)=w_1$、$w'(0)=\\theta_1$、$w(L)=w_2$ 和 $w'(L)=\\theta_2$ 推导出来的。得到的形函数为：\n$$\n\\begin{aligned}\nN_1(x) = 1 - 3\\left(\\frac{x}{L}\\right)^2 + 2\\left(\\frac{x}{L}\\right)^3 \\\\\nN_2(x) = x\\left(1 - \\frac{x}{L}\\right)^2 \\\\\nN_3(x) = 3\\left(\\frac{x}{L}\\right)^2 - 2\\left(\\frac{x}{L}\\right)^3 \\\\\nN_4(x) = \\frac{x^2}{L}\\left(\\frac{x}{L} - 1\\right)\n\\end{aligned}\n$$\n曲率是位移的二阶导数，即 $\\kappa(x) = w''(x)$。对 $w(x)$ 的表达式求导两次，得到：\n$$\nw''(x) = N_1''(x) w_1 + N_2''(x) \\theta_1 + N_3''(x) w_2 + N_4''(x) \\theta_2 = \\mathbf{B}(x) \\mathbf{d}\n$$\n其中 $\\mathbf{B}(x) = \\mathbf{N}''(x) = [\\, N_1''(x) \\ \\ N_2''(x) \\ \\ N_3''(x) \\ \\ N_4''(x) \\,]$ 是应变-位移矩阵。形函数的二阶导数为：\n$$\n\\begin{aligned}\nN_1''(x) = -\\frac{6}{L^2} + \\frac{12x}{L^3} = \\frac{6}{L^2}\\left(\\frac{2x}{L} - 1\\right) \\\\\nN_2''(x) = -\\frac{4}{L} + \\frac{6x}{L^2} = \\frac{2}{L}\\left(\\frac{3x}{L} - 2\\right) \\\\\nN_3''(x) = \\frac{6}{L^2} - \\frac{12x}{L^3} = \\frac{6}{L^2}\\left(1 - \\frac{2x}{L}\\right) \\\\\nN_4''(x) = -\\frac{2}{L} + \\frac{6x}{L^2} = \\frac{2}{L}\\left(\\frac{3x}{L} - 1\\right)\n\\end{aligned}\n$$\n将 $w''(x) = \\mathbf{B}(x) \\mathbf{d}$ 代入应变能积分，得到：\n$$\nU = \\frac{1}{2} \\int_{0}^{L} E I \\big(\\mathbf{B}(x) \\mathbf{d}\\big)^2 \\, dx = \\frac{1}{2} \\int_{0}^{L} E I \\left(\\mathbf{d}^{\\mathsf{T}} \\mathbf{B}(x)^{\\mathsf{T}} \\mathbf{B}(x) \\mathbf{d}\\right) \\, dx\n$$\n由于 $\\mathbf{d}$ 相对于 $x$ 是常数，我们可以写出：\n$$\nU = \\frac{1}{2} \\mathbf{d}^{\\mathsf{T}} \\left( \\int_{0}^{L} E I \\, \\mathbf{B}(x)^{\\mathsf{T}} \\mathbf{B}(x) \\, dx \\right) \\mathbf{d}\n$$\n与 $U = \\frac{1}{2} \\mathbf{d}^{\\mathsf{T}} \\mathbf{K}_e \\mathbf{d}$ 进行比较，可以确定刚度矩阵 $\\mathbf{K}_e$ 为：\n$$\n\\mathbf{K}_e = \\int_{0}^{L} E I \\, \\mathbf{B}(x)^{\\mathsf{T}} \\mathbf{B}(x) \\, dx\n$$\n刚度矩阵的元素 $K_{ij}$ 由以下积分给出：\n$$\nK_{ij} = E I \\int_{0}^{L} N_i''(x) N_j''(x) \\, dx\n$$\n我们现在计算对称 $4 \\times 4$ 矩阵 $\\mathbf{K}_e$ 的各元素。\n\n对于 $K_{11}$:\n$K_{11} = E I \\int_{0}^{L} \\left(N_1''(x)\\right)^2 dx = E I \\int_{0}^{L} \\left(\\frac{6}{L^2}\\left(\\frac{2x}{L} - 1\\right)\\right)^2 dx = \\frac{36 E I}{L^4} \\int_{0}^{L} \\left(\\frac{4x^2}{L^2} - \\frac{4x}{L} + 1\\right) dx = \\frac{12 E I}{L^3}$.\n\n对于 $K_{12} = K_{21}$:\n$K_{12} = E I \\int_{0}^{L} N_1''(x) N_2''(x) \\, dx = E I \\int_{0}^{L} \\frac{6}{L^2}\\left(\\frac{2x}{L} - 1\\right) \\frac{2}{L}\\left(\\frac{3x}{L} - 2\\right) dx = \\frac{12 E I}{L^3} \\int_{0}^{L} \\left(\\frac{6x^2}{L^2} - \\frac{7x}{L} + 2\\right) dx = \\frac{6 E I}{L^2}$.\n\n对于 $K_{13} = K_{31}$:\n由于 $N_3''(x) = -N_1''(x)$，我们有 $K_{13} = E I \\int_{0}^{L} N_1''(x) (-N_1''(x)) \\, dx = -K_{11} = -\\frac{12 E I}{L^3}$.\n\n对于 $K_{14} = K_{41}$:\n$K_{14} = E I \\int_{0}^{L} N_1''(x) N_4''(x) \\, dx = E I \\int_{0}^{L} \\frac{6}{L^2}\\left(\\frac{2x}{L} - 1\\right) \\frac{2}{L}\\left(\\frac{3x}{L} - 1\\right) dx = \\frac{12 E I}{L^3} \\int_{0}^{L} \\left(\\frac{6x^2}{L^2} - \\frac{5x}{L} + 1\\right) dx = \\frac{6 E I}{L^2}$.\n\n对于 $K_{22}$:\n$K_{22} = E I \\int_{0}^{L} \\left(N_2''(x)\\right)^2 dx = E I \\int_{0}^{L} \\left(\\frac{2}{L}\\left(\\frac{3x}{L} - 2\\right)\\right)^2 dx = \\frac{4 E I}{L^2} \\int_{0}^{L} \\left(\\frac{9x^2}{L^2} - \\frac{12x}{L} + 4\\right) dx = \\frac{4 E I}{L}$.\n\n对于 $K_{23} = K_{32}$:\n$K_{23} = E I \\int_{0}^{L} N_2''(x) N_3''(x) \\, dx = E I \\int_{0}^{L} N_2''(x) (-N_1''(x)) \\, dx = -K_{12} = -\\frac{6 E I}{L^2}$.\n\n对于 $K_{24} = K_{42}$:\n$K_{24} = E I \\int_{0}^{L} N_2''(x) N_4''(x) \\, dx = E I \\int_{0}^{L} \\frac{2}{L}\\left(\\frac{3x}{L} - 2\\right) \\frac{2}{L}\\left(\\frac{3x}{L} - 1\\right) dx = \\frac{4 E I}{L^2} \\int_{0}^{L} \\left(\\frac{9x^2}{L^2} - \\frac{9x}{L} + 2\\right) dx = \\frac{2 E I}{L}$.\n\n对于 $K_{33}$:\n$K_{33} = E I \\int_{0}^{L} \\left(N_3''(x)\\right)^2 dx = E I \\int_{0}^{L} \\left(-N_1''(x)\\right)^2 dx = K_{11} = \\frac{12 E I}{L^3}$.\n\n对于 $K_{34} = K_{43}$:\n$K_{34} = E I \\int_{0}^{L} N_3''(x) N_4''(x) \\, dx = E I \\int_{0}^{L} (-N_1''(x)) N_4''(x) \\, dx = -K_{14} = -\\frac{6 E I}{L^2}$.\n\n对于 $K_{44}$:\n$K_{44} = E I \\int_{0}^{L} \\left(N_4''(x)\\right)^2 dx = E I \\int_{0}^{L} \\left(\\frac{2}{L}\\left(\\frac{3x}{L} - 1\\right)\\right)^2 dx = \\frac{4 E I}{L^2} \\int_{0}^{L} \\left(\\frac{9x^2}{L^2} - \\frac{6x}{L} + 1\\right) dx = \\frac{4 E I}{L}$.\n\n将这些元素组装成矩阵 $\\mathbf{K}_e$：\n$$\n\\mathbf{K}_e = \\begin{pmatrix}\n\\frac{12 E I}{L^3}  \\frac{6 E I}{L^2}  -\\frac{12 E I}{L^3}  \\frac{6 E I}{L^2} \\\\\n\\frac{6 E I}{L^2}  \\frac{4 E I}{L}  -\\frac{6 E I}{L^2}  \\frac{2 E I}{L} \\\\\n-\\frac{12 E I}{L^3}  -\\frac{6 E I}{L^2}  \\frac{12 E I}{L^3}  -\\frac{6 E I}{L^2} \\\\\n\\frac{6 E I}{L^2}  \\frac{2 E I}{L}  -\\frac{6 E I}{L^2}  \\frac{4 E I}{L}\n\\end{pmatrix}\n$$\n按要求提出标量项 $\\dfrac{E I}{L^3}$：\n$$\n\\mathbf{K}_e = \\frac{E I}{L^3} \\begin{pmatrix}\n12  6L  -12  6L \\\\\n6L  4L^2  -6L  2L^2 \\\\\n-12  -6L  12  -6L \\\\\n6L  2L^2  -6L  4L^2\n\\end{pmatrix}\n$$\n这就是欧拉-伯努利梁单元协调弯曲刚度矩阵的最终表达式。", "answer": "$$\n\\boxed{\\frac{E I}{L^3} \\begin{pmatrix} 12  6L  -12  6L \\\\ 6L  4L^2  -6L  2L^2 \\\\ -12  -6L  12  -6L \\\\ 6L  2L^2  -6L  4L^2 \\end{pmatrix}}\n$$", "id": "2599805"}, {"introduction": "建立了刚度矩阵之后，一个实际问题随之而来：我们如何在节点有限元模型中表示像自重或压力这样的分布载荷？本练习将探讨两种常用方法：直观的“集总”载荷向量和从虚功原理推导出的更严谨的“一致”载荷向量。通过将两种方法应用于悬臂梁计算所得的结果与精确解析解进行比较，您将更深刻地理解一致载荷公式的准确性和理论完备性。[@problem_id:2599801]", "problem": "一根长度为 $L$、具有常数抗弯刚度 $E I$ 的欧拉-伯努利梁，在 $x=0$ 处固支，在 $x=L$ 处自由。一个集度为常数 $q$ 的均布横向荷载沿整个跨度作用，方向为正横向位移方向。使用有限元法 (FEM)，采用单个双节点欧拉-伯努利梁单元，并对横向位移场使用三次 Hermite 插值，按以下步骤进行。\n\n- 从欧拉-伯努利梁的弱形式出发，\n$$\\int_{0}^{L} E I\\, w''(x)\\, \\delta w''(x)\\, dx=\\int_{0}^{L} q\\, \\delta w(x)\\, dx,$$\n推导单元刚度矩阵项 $k_{ij}=\\int_{0}^{L} E I\\, N_i''(x)\\, N_j''(x)\\, dx$ 和一致单元荷载向量项 $f_i^{\\mathrm{(cons)}}=\\int_{0}^{L} q\\, N_i(x)\\, dx$，其中 $N_i(x)$ 是与节点自由度 $\\{w_1,\\theta_1,w_2,\\theta_2\\}$ 相关联的三次 Hermite 形函数。\n\n- 定义一个集中荷载向量 $f_i^{\\mathrm{(lump)}}$，方法是将分布荷载的总合力等量地集中在两个节点上作为节点横向力，并指定节点弯矩为零；即，每个节点的横向力等于 $q L/2$，节点弯矩为零。\n\n- 施加固支边界条件 $w_1=0$ 和 $\\theta_1=0$，并对两种荷载 $f^{\\mathrm{(cons)}}$ 和 $f^{\\mathrm{(lump)}}$ 分别建立用于求解未知梁端自由度 $\\{w_2,\\theta_2\\}$ 的简化 $2\\times 2$ 线性系统。求解这些系统，以获得梁端挠度的有限元预测值 $w_2^{\\mathrm{(cons)}}$ 和 $w_2^{\\mathrm{(lump)}}$。\n\n- 单独地，通过求解带有边界条件 $w(0)=0$，$w'(0)=0$，$w''(L)=0$ 和 $w'''(L)=0$ 的欧拉-伯努利梁微分方程 $E I\\, w^{(4)}(x)=q$，推导出精确的梁端挠度 $w_{\\mathrm{exact}}(L)$。\n\n最后，量化由单单元集中荷载引起的梁端挠度的相对误差，其定义为\n$$\\varepsilon=\\frac{w_2^{\\mathrm{(lump)}}-w_{\\mathrm{exact}}(L)}{w_{\\mathrm{exact}}(L)},$$\n并将 $\\varepsilon$ 的值以单个简化分数或小数（无量纲）的形式报告。不包括单位。无需四舍五入。", "solution": "问题陈述需进行验证。\n\n**步骤1：提取已知条件**\n- 长度为 $L$ 且抗弯刚度为常数 $EI$ 的欧拉-伯努利梁。\n- 边界条件：在 $x=0$ 处固支，在 $x=L$ 处自由。\n- 荷载：集度为常数 $q$ 的均布横向荷载。\n- 有限元法：单个双节点欧拉-伯努利梁单元，对横向位移场采用三次 Hermite 插值。\n- 弱形式：$\\int_{0}^{L} E I\\, w''(x)\\, \\delta w''(x)\\, dx=\\int_{0}^{L} q\\, \\delta w(x)\\, dx$。\n- 刚度矩阵项定义：$k_{ij}=\\int_{0}^{L} E I\\, N_i''(x)\\, N_j''(x)\\, dx$。\n- 一致荷载向量项定义：$f_i^{\\mathrm{(cons)}}=\\int_{0}^{L} q\\, N_i(x)\\, dx$。\n- 节点自由度 (DOFs)：$\\{w_1, \\theta_1, w_2, \\theta_2\\}$。\n- 集中荷载向量定义 ($f_i^{\\mathrm{(lump)}}$): 节点1和2的节点横向力各为 $qL/2$。节点弯矩为零。\n- 给定边界条件：$w_1=0$, $\\theta_1=0$。\n- 精确解由欧拉-伯努利梁的微分方程 $E I\\, w^{(4)}(x)=q$ 以及边界条件 $w(0)=0$、$w'(0)=0$、$w''(L)=0$ 和 $w'''(L)=0$ 确定。\n- 最终任务：量化相对误差 $\\varepsilon=\\frac{w_2^{\\mathrm{(lump)}}-w_{\\mathrm{exact}}(L)}{w_{\\mathrm{exact}}(L)}$。\n\n**步骤2：使用提取的已知条件进行验证**\n根据验证标准评估问题。\n- **科学依据：** 该问题是有限元法应用于结构力学的一个标准基础练习，特别是使用了欧拉-伯努利梁理论。所有原理和方程都是公认的。\n- **适定性：** 该问题提供了明确的目标、所有必要的数据和明确的边界条件，确保存在唯一且有意义的解。\n- **客观性：** 该问题使用精确、正式的语言陈述，没有歧义或主观内容。\n该问题没有任何缺陷。它在科学上是合理的，结构上是正式的，内容是完整的，并且是可验证的。\n\n**步骤3：结论与行动**\n问题有效。将提供完整解答。\n\n解题过程分为几个步骤：推导单元矩阵，求解有限元系统，推导精确解析解，最后计算所需的相对误差。\n\n首先，我们为长度为 $L$ 的单元定义三次 Hermite 形函数 $N_i(x)$。横向位移插值为 $w(x) = N_1(x)w_1 + N_2(x)\\theta_1 + N_3(x)w_2 + N_4(x)\\theta_2$，其中 $\\theta \\equiv w'$。使用无量纲坐标 $\\xi = x/L$（其中 $\\xi \\in [0, 1]$），形函数为：\n$N_1(\\xi) = 1 - 3\\xi^2 + 2\\xi^3$\n$N_2(\\xi) = L(\\xi - 2\\xi^2 + \\xi^3)$\n$N_3(\\xi) = 3\\xi^2 - 2\\xi^3$\n$N_4(\\xi) = L(-\\xi^2 + \\xi^3)$\n\n为了计算单元刚度矩阵 $K$（其中 $k_{ij}=\\int_{0}^{L} E I\\, N_i''(x)\\, N_j''(x)\\, dx$），我们需要形函数关于 $x$ 的二阶导数。使用链式法则，$\\frac{d}{dx} = \\frac{1}{L}\\frac{d}{d\\xi}$，我们得到 $\\frac{d^2}{dx^2} = \\frac{1}{L^2}\\frac{d^2}{d\\xi^2}$。\n$N_1''(x) = \\frac{1}{L^2}(-6 + 12\\xi)$\n$N_2''(x) = \\frac{1}{L}(-4 + 6\\xi)$\n$N_3''(x) = \\frac{1}{L^2}(6 - 12\\xi)$\n$N_4''(x) = \\frac{1}{L}(-2 + 6\\xi)$\n\n每个 $k_{ij}$ 的积分在单元长度上进行。例如，\n$k_{11} = EI \\int_0^L (N_1''(x))^2 dx = EI \\int_0^1 \\left(\\frac{1}{L^2}(-6+12\\xi)\\right)^2 L d\\xi = \\frac{12EI}{L^3}$。\n执行所有16个积分，得到标准的欧拉-伯努利梁单元刚度矩阵：\n$$K = \\frac{EI}{L^3} \\begin{pmatrix} 12  6L  -12  6L \\\\ 6L  4L^2  -6L  2L^2 \\\\ -12  -6L  12  -6L \\\\ 6L  2L^2  -6L  4L^2 \\end{pmatrix}$$\n\n接下来，我们推导一致节点荷载向量 $f^{\\mathrm{(cons)}}$，其各项为 $f_i^{\\mathrm{(cons)}} = \\int_0^L q N_i(x) dx$。\n$f_1^{\\mathrm{(cons)}} = qL \\int_0^1 (1 - 3\\xi^2 + 2\\xi^3) d\\xi = \\frac{qL}{2}$\n$f_2^{\\mathrm{(cons)}} = qL \\int_0^1 L(\\xi - 2\\xi^2 + \\xi^3) d\\xi = \\frac{qL^2}{12}$\n$f_3^{\\mathrm{(cons)}} = qL \\int_0^1 (3\\xi^2 - 2\\xi^3) d\\xi = \\frac{qL}{2}$\n$f_4^{\\mathrm{(cons)}} = qL \\int_0^1 L(-\\xi^2 + \\xi^3) d\\xi = -\\frac{qL^2}{12}$\n因此，一致荷载向量为：\n$$f^{\\mathrm{(cons)}} = \\begin{pmatrix} qL/2 \\\\ qL^2/12 \\\\ qL/2 \\\\ -qL^2/12 \\end{pmatrix}$$\n根据问题陈述，集中荷载向量为：\n$$f^{\\mathrm{(lump)}} = \\begin{pmatrix} qL/2 \\\\ 0 \\\\ qL/2 \\\\ 0 \\end{pmatrix}$$\n\n有限元方程组为 $K \\mathbf{d} = \\mathbf{f}$，其中 $\\mathbf{d} = \\{w_1, \\theta_1, w_2, \\theta_2\\}^T$。我们施加在 $x=0$ 处的固支边界条件 $w_1=0$ 和 $\\theta_1=0$。这将 $4 \\times 4$ 系统简化为求解未知自由度 $\\{w_2, \\theta_2\\}$ 的 $2 \\times 2$ 系统。通过提取与自由自由度对应的子矩阵和子向量，得到简化系统：\n$$\n\\frac{EI}{L^3} \\begin{pmatrix} 12  -6L \\\\ -6L  4L^2 \\end{pmatrix} \\begin{pmatrix} w_2 \\\\ \\theta_2 \\end{pmatrix} = \\begin{pmatrix} f_3 \\\\ f_4 \\end{pmatrix}\n$$\n对于一致荷载情况：\n$$\n\\frac{EI}{L^3} \\begin{pmatrix} 12  -6L \\\\ -6L  4L^2 \\end{pmatrix} \\begin{pmatrix} w_2^{\\mathrm{(cons)}} \\\\ \\theta_2^{\\mathrm{(cons)}} \\end{pmatrix} = \\begin{pmatrix} qL/2 \\\\ -qL^2/12 \\end{pmatrix}\n$$\n求解该系统得到梁端挠度 $w_2^{\\mathrm{(cons)}}$。\n$12 w_2^{\\mathrm{(cons)}} - 6L \\theta_2^{\\mathrm{(cons)}} = \\frac{qL^4}{2EI}$\n$-6L w_2^{\\mathrm{(cons)}} + 4L^2 \\theta_2^{\\mathrm{(cons)}} = -\\frac{qL^5}{12EI}$\n将第一个方程乘以 $2L/3$ 并加到第二个方程上：\n$8L w_2^{\\mathrm{(cons)}} - 4L^2 \\theta_2^{\\mathrm{(cons)}} - 6L w_2^{\\mathrm{(cons)}} + 4L^2 \\theta_2^{\\mathrm{(cons)}} = \\frac{qL^5}{3EI} - \\frac{qL^5}{12EI}$\n$2L w_2^{\\mathrm{(cons)}} = \\frac{3qL^5}{12EI} = \\frac{qL^5}{4EI}$\n$w_2^{\\mathrm{(cons)}} = \\frac{qL^4}{8EI}$\n\n对于集中荷载情况：\n$$\n\\frac{EI}{L^3} \\begin{pmatrix} 12  -6L \\\\ -6L  4L^2 \\end{pmatrix} \\begin{pmatrix} w_2^{\\mathrm{(lump)}} \\\\ \\theta_2^{\\mathrm{(lump)}} \\end{pmatrix} = \\begin{pmatrix} qL/2 \\\\ 0 \\end{pmatrix}\n$$\n第二个方程给出 $-6L w_2^{\\mathrm{(lump)}} + 4L^2 \\theta_2^{\\mathrm{(lump)}} = 0$，因此 $\\theta_2^{\\mathrm{(lump)}} = \\frac{3}{2L} w_2^{\\mathrm{(lump)}}$。代入第一个方程：\n$12 w_2^{\\mathrm{(lump)}} - 6L \\left( \\frac{3}{2L} w_2^{\\mathrm{(lump)}} \\right) = \\frac{qL^4}{2EI}$\n$12 w_2^{\\mathrm{(lump)}} - 9 w_2^{\\mathrm{(lump)}} = \\frac{qL^4}{2EI}$\n$3 w_2^{\\mathrm{(lump)}} = \\frac{qL^4}{2EI}$\n$w_2^{\\mathrm{(lump)}} = \\frac{qL^4}{6EI}$\n\n接下来，我们通过求解控制微分方程 $EI w^{(4)}(x) = q$ 来找到精确的梁端挠度。积分4次：\n$EI w'''(x) = qx + C_1$\n$EI w''(x) = \\frac{q}{2}x^2 + C_1 x + C_2$\n$EI w'(x) = \\frac{q}{6}x^3 + \\frac{C_1}{2}x^2 + C_2 x + C_3$\n$EI w(x) = \\frac{q}{24}x^4 + \\frac{C_1}{6}x^3 + \\frac{C_2}{2}x^2 + C_3 x + C_4$\n应用边界条件：\n- $w(0)=0 \\implies C_4=0$\n- $w'(0)=0 \\implies C_3=0$\n- $w'''(L)=0$ (自由端剪力为零): $qL + C_1 = 0 \\implies C_1 = -qL$\n- $w''(L)=0$ (自由端弯矩为零): $\\frac{qL^2}{2} + C_1 L + C_2 = 0 \\implies \\frac{qL^2}{2} - qL^2 + C_2 = 0 \\implies C_2 = \\frac{qL^2}{2}$\n精确挠度为：\n$w_{\\mathrm{exact}}(x) = \\frac{1}{EI} (\\frac{q}{24}x^4 - \\frac{qL}{6}x^3 + \\frac{qL^2}{4}x^2)$\n在梁端 $x=L$ 处求值：\n$w_{\\mathrm{exact}}(L) = \\frac{qL^4}{EI} (\\frac{1}{24} - \\frac{1}{6} + \\frac{1}{4}) = \\frac{qL^4}{EI} (\\frac{1-4+6}{24}) = \\frac{3qL^4}{24EI} = \\frac{qL^4}{8EI}$\n\n最后，我们计算集中荷载解的相对误差 $\\varepsilon$。\n$$\\varepsilon = \\frac{w_2^{\\mathrm{(lump)}}-w_{\\mathrm{exact}}(L)}{w_{\\mathrm{exact}}(L)} = \\frac{\\frac{qL^4}{6EI} - \\frac{qL^4}{8EI}}{\\frac{qL^4}{8EI}}$$\n分子和分母中的项 $\\frac{qL^4}{EI}$ 被消去：\n$$\\varepsilon = \\frac{\\frac{1}{6} - \\frac{1}{8}}{\\frac{1}{8}} = \\frac{\\frac{4-3}{24}}{\\frac{1}{8}} = \\frac{\\frac{1}{24}}{\\frac{1}{8}} = \\frac{1}{24} \\cdot 8 = \\frac{8}{24} = \\frac{1}{3}$$\n相对误差为正，表明与精确解相比，集中荷载模型高估了梁端挠度。", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "2599801"}, {"introduction": "从解析公式到计算代码的转换涉及到使用数值积分来组装刚度矩阵。本实践将深入探讨这一关键的实现步骤，特别是研究“欠积分”（即使用过少的积分点）所带来的后果。通过一个动手编程练习，您将发现欠积分如何导致刚度矩阵的秩亏，并催生非物理的“伪零能模式”，从而危及模拟的稳定性和准确性。[@problem_id:2599733]", "problem": "您将分析在有限元法 (FEM) 中，数值积分对欧拉-伯努利梁单元刚度的影响。从虚功原理和欧拉-伯努利假设的运动学出发，为两节点三次 Hermite 梁单元构建抗弯刚度矩阵。仅使用以下基本依据：(i) 欧拉-伯努利运动学假设，即横截面保持为平面且垂直于中性轴，因此曲率由 $\\kappa(x)=d^{2}w/dx^{2}$ 给出；(ii) 弹性弯曲能 $U=\\tfrac{1}{2}\\int_{0}^{L} E I \\,\\kappa(x)^{2}\\,dx$；以及 (iii) 标准的 Galerkin 有限元离散化，其中横向位移 $w(x)$ 和转角 $\\theta(x)=dw/dx$ 采用 $C^{1}$ 连续的三次 Hermite 插值。不得使用或假定任何预先组装的封闭形式刚度矩阵；相反，应通过 Hermite 形函数的二阶导数构建被积函数，并执行数值求积来组装单元刚度。讨论并证明积分不足如何改变刚度矩阵的数值秩，并可能引入伪零能模式。\n\n具体来说，该两节点单元具有节点自由度 $\\{w_{1},\\theta_{1},w_{2},\\theta_{2}\\}$，并在映射到物理坐标 $x\\in[0,L]$ 的母坐标 $\\xi\\in[-1,1]$ 上使用三次 Hermite 插值。单元抗弯刚度为\n$$\n\\mathbf{K}_{e}=\\int_{0}^{L} (E I)\\,\\mathbf{B}(x)^{\\mathsf{T}}\\mathbf{B}(x)\\,dx,\n$$\n其中 $\\mathbf{B}(x)$ 汇集了 Hermite 形函数关于 $x$ 的二阶导数，使得 $\\kappa(x)=\\mathbf{B}(x)\\,\\mathbf{q}_{e}$，且 $\\mathbf{q}_{e}=[w_{1},\\theta_{1},w_{2},\\theta_{2}]^{\\mathsf{T}}$。使用在 $\\xi\\in[-1,1]$ 上的 $n_g$ 点 Gauss–Legendre 求积法，通过映射 $x(\\xi)=\\tfrac{L}{2}(1+\\xi)$ 和 $dx=(L/2)\\,d\\xi$ 对该积分进行数值计算。\n\n您的程序必须：\n- 通过 Gauss–Legendre 求积法实现单元刚度的组装，其中积分点数 $n_{g}\\in\\{1,2,3\\}$ 由用户指定。\n- 对于无约束的单个单元，计算 $\\mathbf{K}_{e}$ 的数值零特征值的数量，其定义为满足 $|\\lambda|\\le \\varepsilon\\cdot \\max_{i}|\\lambda_{i}|$（其中 $\\varepsilon=10^{-10}$）的特征值 $\\lambda$ 的个数。\n- 对于由单个单元建模的悬臂梁（节点1被夹紧，因此 $w_{1}=0$ 且 $\\theta_{1}=0$），组装节点2的缩减刚度矩阵，并求解在节点2节点荷载矢量作用下的静态响应。考虑两种不同的荷载情况：(i) 一个横向端点力 $P$，使得作用于 $\\{w_{2},\\theta_{2}\\}$ 的缩减荷载为 $[P,\\,0]^{\\mathsf{T}}$；以及 (ii) 一个纯端点弯矩 $M$，使得缩减荷载为 $[0,\\,M]^{\\mathsf{T}}$。\n\n使用以下参数集（在所有测试中保持不变，单位为国际单位制）：\n- 长度 $L=2.0$ m,\n- 杨氏模量 $E=210\\times 10^{9}$ Pa,\n- 截面二次矩 $I=1.0\\times 10^{-6}$ m$^{4}$,\n- 横向端点力 $P=1000$ N,\n- 端点弯矩 $M=1.0$ N·m.\n\n测试套件。实现并计算以下四个测试用例：\n1) 无约束单元，使用 $n_{g}=2$ 进行精确积分。输出与 $\\mathbf{K}_{e}$ 的数值零特征值数量相等的整数。\n2) 无约束单元，使用 $n_{g}=1$ 进行积分不足。输出与 $\\mathbf{K}_{e}$ 的数值零特征值数量相等的整数。\n3) 悬臂梁（节点1夹紧），使用 $n_{g}=2$ 并在节点2施加端点力 $P$。求解关于 $\\{w_{2},\\theta_{2}\\}$ 的缩减 $2\\times 2$ 方程组，并输出与 $w_{2}$（单位为米）相等的浮点数。结果以米为单位，用普通十进制数表示。\n4) 悬臂梁（节点1夹紧），使用 $n_{g}=1$ 并在节点2施加端点力 $P$。判断关于 $\\{w_{2},\\theta_{2}\\}$ 的缩减 $2\\times 2$ 刚度矩阵是否为奇异的（秩亏的）。如果奇异则输出布尔值 $\\mathtt{True}$，否则输出 $\\mathtt{False}$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果严格按照上述测试的顺序排列：$[\\text{test1},\\text{test2},\\text{test3},\\text{test4}]$。", "solution": "该问题是结构有限元分析中一个有效的基础练习。它在科学上基于成熟的欧拉-伯努利梁理论和 Galerkin 方法，是一个信息完备的适定问题，并以客观、正式的语言陈述。因此，我们将从第一性原理出发，推导出一个完整的解答。\n\n核心任务是为两节点欧拉-伯努利梁单元构建刚度矩阵 $\\mathbf{K}_{e}$，并研究数值积分对其性质的影响。根据虚功原理，单元抗弯刚度矩阵由应变能导出。对于长度为 $L$、抗弯刚度为 $EI$ 的梁，其弯曲应变能 $U$ 由下式给出\n$$\nU = \\frac{1}{2} \\int_{0}^{L} EI \\, \\kappa(x)^2 \\, dx\n$$\n其中 $\\kappa(x)$ 是曲率。根据欧拉-伯努利假设，曲率是横向位移 $w(x)$ 的二阶导数，即 $\\kappa(x) = \\frac{d^2w}{dx^2}$。\n\n我们使用 $C^1$ 连续的三次 Hermite 形函数来离散化位移场 $w(x)$。对于位于 $x=0$ 和 $x=L$ 的两节点单元，节点自由度 (DOF) 是每个节点的横向位移和转角，汇集在向量 $\\mathbf{q}_{e} = [w_1, \\theta_1, w_2, \\theta_2]^\\mathsf{T}$ 中。位移插值表示为\n$$\nw(x) = \\mathbf{N}(x) \\mathbf{q}_{e} = \\sum_{i=1}^{4} N_i(x) q_i\n$$\n其中 $\\mathbf{N}(x)$ 是形函数的行向量。于是曲率为\n$$\n\\kappa(x) = \\frac{d^2w}{dx^2} = \\frac{d^2\\mathbf{N}(x)}{dx^2} \\mathbf{q}_{e} = \\mathbf{B}(x) \\mathbf{q}_{e}\n$$\n矩阵 $\\mathbf{B}(x)$ 是一个 $1 \\times 4$ 的行向量，包含形函数的二阶导数。将此代入能量表达式，得到二次型 $U = \\frac{1}{2} \\mathbf{q}_{e}^\\mathsf{T} \\mathbf{K}_{e} \\mathbf{q}_{e}$，由此可确定单元刚度矩阵为\n$$\n\\mathbf{K}_{e} = \\int_{0}^{L} EI \\, \\mathbf{B}(x)^\\mathsf{T} \\mathbf{B}(x) \\, dx\n$$\n为执行积分，我们使用线性映射 $x(\\xi) = \\frac{L}{2}(1+\\xi)$ 将物理域 $x \\in [0, L]$ 映射到母域 $\\xi \\in [-1, 1]$ 上。微分关系为 $dx = \\frac{L}{2} d\\xi$ 和 $\\frac{d}{dx} = \\frac{2}{L}\\frac{d}{d\\xi}$，这意味着 $\\frac{d^2}{dx^2} = \\left(\\frac{2}{L}\\right)^2 \\frac{d^2}{d\\xi^2}$。\n\n母域 $\\xi$ 中的标准三次 Hermite 基函数为：\n$h_1(\\xi) = \\frac{1}{4}(2 - 3\\xi + \\xi^3)$\n$h_2(\\xi) = \\frac{1}{4}(1 - \\xi - \\xi^2 + \\xi^3)$\n$h_3(\\xi) = \\frac{1}{4}(2 + 3\\xi - \\xi^3)$\n$h_4(\\xi) = \\frac{1}{4}(-1 - \\xi + \\xi^2 + \\xi^3)$\n\n位移场 $w(\\xi)$ 的构造是为了在 $\\xi=-1$ 处插值节点值 $w_1, \\theta_1$，在 $\\xi=1$ 处插值节点值 $w_2, \\theta_2$。注意 $\\theta = \\frac{dw}{dx} = \\frac{2}{L}\\frac{dw}{d\\xi}$。因此，插值形式为 $w(\\xi) = h_1(\\xi)w_1 + h_2(\\xi)(\\frac{L}{2}\\theta_1) + h_3(\\xi)w_2 + h_4(\\xi)(\\frac{L}{2}\\theta_2)$。这定义了形函数 $N_i(\\xi)$ 如下：\n$N_1(\\xi) = h_1(\\xi)$\n$N_2(\\xi) = \\frac{L}{2}h_2(\\xi)$\n$N_3(\\xi) = h_3(\\xi)$\n$N_4(\\xi) = \\frac{L}{2}h_4(\\xi)$\n\n$\\mathbf{B}$ 矩阵的分量为 $B_i(\\xi) = \\frac{d^2 N_i}{dx^2} = (\\frac{4}{L^2}) \\frac{d^2 N_i}{d\\xi^2}$。我们计算其二阶导数：\n$\\frac{d^2 N_1}{d\\xi^2} = \\frac{3}{2}\\xi$\n$\\frac{d^2 N_2}{d\\xi^2} = \\frac{L}{2} \\frac{d^2 h_2}{d\\xi^2} = \\frac{L}{2} \\frac{1}{4}(-2+6\\xi) = \\frac{L}{4}(3\\xi-1)$\n$\\frac{d^2 N_3}{d\\xi^2} = -\\frac{3}{2}\\xi$\n$\\frac{d^2 N_4}{d\\xi^2} = \\frac{L}{2} \\frac{d^2 h_4}{d\\xi^2} = \\frac{L}{2} \\frac{1}{4}(2+6\\xi) = \\frac{L}{4}(3\\xi+1)$\n\n这得到了母坐标系中的 $\\mathbf{B}$ 矩阵：\n$$\n\\mathbf{B}(\\xi) = \\left[ \\frac{6\\xi}{L^2}, \\quad \\frac{3\\xi-1}{L}, \\quad -\\frac{6\\xi}{L^2}, \\quad \\frac{3\\xi+1}{L} \\right]\n$$\n刚度矩阵积分被转换到母域中：\n$$\n\\mathbf{K}_{e} = \\int_{-1}^{1} EI \\, \\mathbf{B}(\\xi)^\\mathsf{T} \\mathbf{B}(\\xi) \\, \\frac{L}{2} \\, d\\xi\n$$\n被积函数 $\\mathbf{B}(\\xi)^\\mathsf{T} \\mathbf{B}(\\xi)$ 包含最高为 2 次的 $\\xi$ 多项式项。$n_g$ 点的 Gauss-Legendre 求积法对于最高 $2n_g-1$ 次的多项式是精确的。要精确积分一个二次多项式，需要满足 $2n_g-1 \\ge 2$，即 $n_g \\ge 1.5$。因此，$n_g=2$ 个积分点是精确积分的充分必要条件。使用 $n_g=1$ 则构成积分不足。\n\n对于 $n_g=2$ 个点（精确积分），得到的刚度矩阵必须有两个零特征值，对应于无约束梁的两种刚体运动模式：纯平移（$w(x)=\\text{const}$）和纯转动（$w(x)=ax+b$）。这些模式不产生曲率，因此不产生应变能。精确的 $\\mathbf{K}_e$ 的秩必须为 $4-2=2$。这是测试1的主题。\n\n对于 $n_g=1$（积分不足），我们使用位于 $\\xi_1=0$ 且权重为 $w_1=2$ 的单个 Gauss 点。在该点，$\\mathbf{B}$ 矩阵的计算结果为：\n$$\n\\mathbf{B}(\\xi=0) = \\left[ 0, \\quad -1/L, \\quad 0, \\quad 1/L \\right]\n$$\n刚度矩阵近似为 $\\mathbf{K}_{e} \\approx EI \\frac{L}{2} w_1 \\mathbf{B}(0)^\\mathsf{T}\\mathbf{B}(0) = EIL \\cdot \\mathbf{B}(0)^\\mathsf{T}\\mathbf{B}(0)$。由于 $\\mathbf{B}(0)$ 是一个非零行向量，其结果矩阵 $\\mathbf{B}(0)^\\mathsf{T}\\mathbf{B}(0)$ 的秩为1。因此，完整的 $4 \\times 4$ 刚度矩阵 $\\mathbf{K}_e$ 的秩也将为1。根据秩-零度定理，其零度为 $4-1=3$。这意味着积分不足的刚度矩阵将有三个零特征值。除了两种物理刚体模式外，额外的零能模式是一种导致数值不稳定的伪（非物理）模式。该模式对应于在积分点 $\\xi=0$ 处曲率为零、但在其他地方曲率非零的任何变形。这是测试2的主题。\n\n对于悬臂梁分析（测试3和4），单元在节点1处被夹紧，施加了边界条件 $w_1=0$ 和 $\\theta_1=0$。控制方程组 $\\mathbf{K}_e \\mathbf{q}_e = \\mathbf{F}_e$ 被简化为只包含未知自由度 $\\{w_2, \\theta_2\\}$ 的系统。我们将矩阵和向量进行分块：\n$$\n\\begin{bmatrix} \\mathbf{K}_{11}  \\mathbf{K}_{12} \\\\ \\mathbf{K}_{21}  \\mathbf{K}_{22} \\end{bmatrix} \\begin{Bmatrix} \\mathbf{q}_1 \\\\ \\mathbf{q}_2 \\end{Bmatrix} = \\begin{Bmatrix} \\mathbf{F}_1 \\\\ \\mathbf{F}_2 \\end{Bmatrix}\n$$\n其中 $\\mathbf{q}_1 = [w_1, \\theta_1]^\\mathsf{T}$ 且 $\\mathbf{q}_2 = [w_2, \\theta_2]^\\mathsf{T}$。当 $\\mathbf{q}_1 = \\mathbf{0}$ 时，系统简化为 $\\mathbf{K}_{22} \\mathbf{q}_2 = \\mathbf{F}_2$。缩减后的 $2 \\times 2$ 刚度矩阵是 $\\mathbf{K}_{red} = \\mathbf{K}_{22}$，即 $\\mathbf{K}_e$ 的右下角 $2 \\times 2$ 子块。\n\n在测试3中，采用精确积分（$n_g=2$），$\\mathbf{K}_{red}$ 是非奇异的，我们在端点力 $P=1000$ N 作用下求解端点位移 $w_2$。荷载向量为 $\\mathbf{F}_2 = [P, 0]^\\mathsf{T}$。该解应与解析解 $w_2 = \\frac{PL^3}{3EI}$ 相匹配。\n\n在测试4中，采用积分不足（$n_g=1$），我们必须检验缩减刚度矩阵 $\\mathbf{K}_{red}$ 的奇异性。完整的积分不足矩阵为 $\\mathbf{K}_e \\approx \\frac{EI}{L} \\begin{bsmallmatrix} 0  0  0  0 \\\\ 0  1  0  -1 \\\\ 0  0  0  0 \\\\ 0  -1  0  1 \\end{bsmallmatrix}$。缩减矩阵是对应于自由度 $\\{w_2, \\theta_2\\}$（索引3和4）的子块：\n$$\n\\mathbf{K}_{red} = \\begin{bmatrix} K_{33}  K_{34} \\\\ K_{43}  K_{44} \\end{bmatrix} = \\frac{EI}{L} \\begin{bmatrix} 0  0 \\\\ 0  1 \\end{bmatrix}\n$$\n该矩阵的行列式为0，因此显然是奇异的。其秩为1，小于其维度2。这种奇异性表明，被夹紧的、积分不足的单元无法抵抗横向端点力，因为它对应一个未被边界条件抑制的零能变形模式。\n下面的程序实现了这些计算，以提供所需的具体数值答案。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes an Euler-Bernoulli beam element using the Finite Element Method,\n    focusing on the effects of numerical integration on the stiffness matrix.\n    \"\"\"\n\n    # --- Problem Parameters (SI units) ---\n    L = 2.0  # Length (m)\n    E = 210.0e9  # Young's modulus (Pa)\n    I = 1.0e-6  # Second moment of area (m^4)\n    P = 1000.0  # Transverse tip force (N)\n    M = 1.0  # Tip moment (N*m)\n\n    # --- Helper Functions ---\n\n    def get_gauss_quadrature(ng):\n        \"\"\"Returns Gauss-Legendre quadrature points and weights for xi in [-1, 1].\"\"\"\n        if ng == 1:\n            return [(0.0, 2.0)]\n        elif ng == 2:\n            p = 1.0 / np.sqrt(3.0)\n            return [(-p, 1.0), (p, 1.0)]\n        elif ng == 3:\n            p = np.sqrt(3.0 / 5.0)\n            return [(-p, 5.0 / 9.0), (0.0, 8.0 / 9.0), (p, 5.0 / 9.0)]\n        else:\n            raise ValueError(\"Number of Gauss points (ng) must be 1, 2, or 3.\")\n\n    def get_B_matrix_at_xi(xi, L_val):\n        \"\"\"\n        Computes the B-matrix (1x4) at a given point xi in the parent domain.\n        B(xi) = [d^2N1/dx^2, d^2N2/dx^2, d^2N3/dx^2, d^2N4/dx^2]\n        \"\"\"\n        L2 = L_val * L_val\n        B_vec = np.array([\n            6.0 * xi / L2,\n            (3.0 * xi - 1.0) / L_val,\n            -6.0 * xi / L2,\n            (3.0 * xi + 1.0) / L_val\n        ])\n        return B_vec.reshape(1, 4)\n\n    def assemble_stiffness_matrix(ng, L_val, E_val, I_val):\n        \"\"\"\n        Assembles the 4x4 element stiffness matrix using Gauss quadrature.\n        \"\"\"\n        Ke = np.zeros((4, 4))\n        gauss_points = get_gauss_quadrature(ng)\n        jacobian_det = L_val / 2.0\n        \n        for xi, weight in gauss_points:\n            B = get_B_matrix_at_xi(xi, L_val)\n            Ke += weight * (B.T @ B)\n        \n        Ke *= E_val * I_val * jacobian_det\n        return Ke\n\n    # --- Test Case Execution ---\n    results = []\n\n    # Test 1: Unconstrained element, ng=2 (exact integration)\n    ng_1 = 2\n    Ke_1 = assemble_stiffness_matrix(ng_1, L, E, I)\n    eigenvalues_1 = np.linalg.eigvalsh(Ke_1)\n    # Numerical tolerance for zero eigenvalue check\n    tol_1 = 1e-10 * np.max(np.abs(eigenvalues_1))\n    zero_eigenvalues_1 = np.sum(np.abs(eigenvalues_1) = tol_1)\n    results.append(zero_eigenvalues_1)\n\n    # Test 2: Unconstrained element, ng=1 (under-integration)\n    ng_2 = 1\n    Ke_2 = assemble_stiffness_matrix(ng_2, L, E, I)\n    eigenvalues_2 = np.linalg.eigvalsh(Ke_2)\n    # Check for non-zero max eigenvalue to avoid tol=0\n    max_eig_2 = np.max(np.abs(eigenvalues_2))\n    tol_2 = 1e-10 * max_eig_2 if max_eig_2  0 else 1e-10\n    zero_eigenvalues_2 = np.sum(np.abs(eigenvalues_2) = tol_2)\n    results.append(zero_eigenvalues_2)\n\n    # Test 3: Cantilever, ng=2, tip force P\n    ng_3 = 2\n    Ke_3 = assemble_stiffness_matrix(ng_3, L, E, I)\n    # Reduced system for DOFs {w2, theta2} (indices 2, 3)\n    K_red_3 = Ke_3[2:4, 2:4]\n    F_red_3 = np.array([P, 0.0])\n    u_red_3 = np.linalg.solve(K_red_3, F_red_3)\n    w2 = u_red_3[0]\n    results.append(w2)\n\n    # Test 4: Cantilever, ng=1, check for singularity\n    ng_4 = 1\n    Ke_4 = assemble_stiffness_matrix(ng_4, L, E, I)\n    K_red_4 = Ke_4[2:4, 2:4]\n    # A matrix is singular if its rank is less than its dimension\n    rank_4 = np.linalg.matrix_rank(K_red_4)\n    is_singular = (rank_4  2)\n    results.append(is_singular)\n\n    # --- Final Output ---\n    # Convert all results to string format for printing\n    # Ensure boolean is 'True'/'False' as per standard string conversion\n    formatted_results = [\n        str(results[0]),\n        str(results[1]),\n        f\"{results[2]:.10f}\".rstrip('0').rstrip('.'), # Format float nicely\n        str(results[3])\n    ]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2599733"}]}