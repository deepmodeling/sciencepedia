{"hands_on_practices": [{"introduction": "在任何瞬态有限元分析中，一个核心步骤是将时间导数项 $\\rho \\partial_t \\boldsymbol{u}$ 离散化，这自然地引出了质量矩阵的概念。本练习将通过一个具体的算例，指导您从弱形式出发，逐步推导矢量值元的局部质量矩阵，并学习如何将这些局部矩阵组装成全局系统。掌握这一从积分形式到代数系统的过程，是进行任何时间相关有限元模拟的基础技能 [@problem_id:2582614]。", "problem": "考虑在有界多边形域 $\\Omega \\subset \\mathbb{R}^{2}$ 上，具有恒定密度 $\\rho$ 的牛顿流体的不可压缩Navier–Stokes方程，其速度满足齐次Dirichlet边界条件：\n$$\n\\rho\\,\\partial_{t}\\boldsymbol{u} + \\rho\\,(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u} - \\mu\\,\\Delta \\boldsymbol{u} + \\nabla p = \\boldsymbol{f}, \\quad \\nabla\\cdot \\boldsymbol{u} = 0 \\quad \\text{in } \\Omega.\n$$\n使用Galerkin有限元方法（Finite Element Method (FEM)），其中速度采用连续分片仿射（即 $\\mathbb{P}_{1}$）矢量形函数，并设半离散（空间上）速度场为\n$$\n\\boldsymbol{u}_{h}(t,\\boldsymbol{x}) = \\sum_{a=1}^{N} U_{a}^{x}(t)\\,\\boldsymbol{e}_{x}\\,\\varphi_{a}(\\boldsymbol{x}) + \\sum_{a=1}^{N} U_{a}^{y}(t)\\,\\boldsymbol{e}_{y}\\,\\varphi_{a}(\\boldsymbol{x}),\n$$\n其中 $\\{\\varphi_{a}\\}_{a=1}^{N}$ 是与网格顶点相关联的标量节点帽函数，而 $\\{\\boldsymbol{e}_{x},\\boldsymbol{e}_{y}\\}$ 是笛卡尔基向量。动量方程的半离散Galerkin格式包含一个形式如下的质量项\n$$\n\\rho\\int_{\\Omega} \\boldsymbol{w}_{h}\\cdot \\partial_{t}\\boldsymbol{u}_{h}\\,d\\boldsymbol{x},\n$$\n其中 $\\boldsymbol{w}_{h}$ 与 $\\boldsymbol{u}_{h}$ 属于同一向量空间。该项导出了全局质量矩阵 $\\boldsymbol{M}$。\n\n从弱形式和 $\\mathbb{P}_{1}$ 节点基的定义出发，完成以下任务。\n\n$1.$ 推导任意单元 $K$ 上的局部质量矩阵的单元表达式，\n$$\n\\boldsymbol{M}^{(K)}_{(i,\\alpha),(j,\\beta)} = \\rho \\int_{K} \\big(\\boldsymbol{e}_{\\alpha}\\,\\varphi_{i}\\big)\\cdot \\big(\\boldsymbol{e}_{\\beta}\\,\\varphi_{j}\\big)\\,d\\boldsymbol{x},\n$$\n其中 $i,j$ 为单元 $K$ 上的局部节点索引，$\\alpha,\\beta\\in\\{x,y\\}$ 为分量索引。将其简化为标量基函数 $\\varphi_{i},\\varphi_{j}$ 的积分，并根据分量的正交性确定哪些项为零。\n\n$2.$ 具体到单位正方形 $\\Omega = (0,1)\\times(0,1)$ 上的网格 $\\mathcal{T}_{h}$，该正方形被从 $(0,0)$ 到 $(1,1)$ 的对角线划分为2个三角形：\n$$\nK_{1} = \\operatorname{conv}\\{(0,0),(1,0),(1,1)\\}, \\qquad K_{2} = \\operatorname{conv}\\{(0,0),(1,1),(0,1)\\}.\n$$\n设全局顶点标记为 $N_{1}=(0,0)$, $N_{2}=(1,0)$, $N_{3}=(1,1)$, $N_{4}=(0,1)$，其关联的标量帽函数为 $\\{\\varphi_{1},\\varphi_{2},\\varphi_{3},\\varphi_{4}\\}$。仅使用三角形上重心坐标的基本性质以及由任意三角形上 $\\lambda_{1}+\\lambda_{2}+\\lambda_{3}\\equiv 1$ 导出的积分恒等式，计算 $K=K_{1}$ 和 $K=K_{2}$ 所需的局部标量积分 $\\int_{K}\\varphi_{i}\\varphi_{j}\\,d\\boldsymbol{x}$。\n\n$3.$ 简要说明将每个局部单元矩阵 $\\boldsymbol{M}^{(K)}$ 映射到全局质量矩阵 $\\boldsymbol{M}$ 的组装规则，使用与 $(i,\\alpha)$ 和 $(j,\\beta)$ 对应的全局自由度（DoF）索引来表示。\n\n最后，利用以上结果，计算一致质量矩阵中，对应于节点 $N_{3}$ 处的 $x$ 分量与自身作测试的单个全局项，即\n$$\nM_{(N_{3},x),(N_{3},x)}.\n$$\n将你的最终答案表示为关于 $\\rho$ 的简化精确表达式，不带单位。最终答案必须是单个闭式解析表达式。", "solution": "该问题陈述是有效的。这是一个将有限元方法（FEM）应用于流体动力学的标准的、良定的练习题，没有任何科学或逻辑上的缺陷。我们着手进行求解。\n\n该问题要求一步步推导，最终计算出半离散化Navier-Stokes方程的全局一致质量矩阵中的一个特定项。\n\n首先，我们推导三角形单元 $K$ 上的局部质量矩阵 $\\boldsymbol{M}^{(K)}$ 的通用表达式。速度场使用连续分片仿射（$\\mathbb{P}_{1}$）矢量基函数进行离散化。与局部节点 $i$ 和笛卡尔分量 $\\alpha \\in \\{x,y\\}$ 相关联的矢量基函数为 $\\boldsymbol{\\psi}_{i,\\alpha}(\\boldsymbol{x}) = \\boldsymbol{e}_{\\alpha}\\varphi_{i}(\\boldsymbol{x})$，其中 $\\varphi_{i}$ 是标量节点基函数（“帽函数”）。半离散速度为 $\\boldsymbol{u}_{h}(t,\\boldsymbol{x}) = \\sum_{j,\\beta} U_{j,\\beta}(t) \\boldsymbol{\\psi}_{j,\\beta}(\\boldsymbol{x})$。测试函数 $\\boldsymbol{w}_{h}$ 从同一空间中选取。一个一般的测试函数是 $\\boldsymbol{w}_{h}(\\boldsymbol{x}) = \\boldsymbol{\\psi}_{i,\\alpha}(\\boldsymbol{x})$。\n\n来自单元 $K$ 的质量项贡献为 $\\rho\\int_{K} \\boldsymbol{w}_{h}\\cdot \\partial_{t}\\boldsymbol{u}_{h}\\,d\\boldsymbol{x}$。代入基函数，我们得到局部质量矩阵的各项：\n$$\n\\boldsymbol{M}^{(K)}_{(i,\\alpha),(j,\\beta)} = \\rho \\int_{K} \\boldsymbol{\\psi}_{i,\\alpha}(\\boldsymbol{x}) \\cdot \\boldsymbol{\\psi}_{j,\\beta}(\\boldsymbol{x}) \\,d\\boldsymbol{x}\n$$\n$$\n\\boldsymbol{M}^{(K)}_{(i,\\alpha),(j,\\beta)} = \\rho \\int_{K} \\big(\\boldsymbol{e}_{\\alpha}\\,\\varphi_{i}(\\boldsymbol{x})\\big) \\cdot \\big(\\boldsymbol{e}_{\\beta}\\,\\varphi_{j}(\\boldsymbol{x})\\big) \\,d\\boldsymbol{x}\n$$\n由于标量基函数 $\\varphi_{i}$ 和 $\\varphi_{j}$ 与分量索引无关，且笛卡尔基向量 $\\{\\boldsymbol{e}_{x}, \\boldsymbol{e}_{y}\\}$ 是常数，我们可以写出：\n$$\n\\boldsymbol{M}^{(K)}_{(i,\\alpha),(j,\\beta)} = \\rho \\, (\\boldsymbol{e}_{\\alpha}\\cdot \\boldsymbol{e}_{\\beta}) \\int_{K} \\varphi_{i}(\\boldsymbol{x})\\varphi_{j}(\\boldsymbol{x})\\,d\\boldsymbol{x}\n$$\n笛卡尔基向量是标准正交的，即 $\\boldsymbol{e}_{\\alpha}\\cdot \\boldsymbol{e}_{\\beta} = \\delta_{\\alpha\\beta}$，其中 $\\delta_{\\alpha\\beta}$ 是克罗内克δ函数。因此，表达式简化为：\n$$\n\\boldsymbol{M}^{(K)}_{(i,\\alpha),(j,\\beta)} = \\rho \\, \\delta_{\\alpha\\beta} \\int_{K} \\varphi_{i}(\\boldsymbol{x})\\varphi_{j}(\\boldsymbol{x})\\,d\\boldsymbol{x}\n$$\n这个结果表明，只有当 $\\alpha=\\beta$ 时，矩阵项才非零。在质量矩阵中，$x$ 和 $y$ 速度分量之间的耦合为零，意味着它是块对角的。用于 $x-x$ 和 $y-y$ 分量的两个对角块是相同的，等于 $\\rho$ 乘以标量质量矩阵 $M^{\\text{scalar}}_{ij} = \\int_{K} \\varphi_{i}\\varphi_{j}\\,d\\boldsymbol{x}$。\n\n第二，我们为所给定的特定网格计算标量积分 $\\int_{K}\\varphi_{i}\\varphi_{j}\\,d\\boldsymbol{x}$。区域 $\\Omega = (0,1)\\times(0,1)$ 被划分为两个三角形 $K_{1}$ 和 $K_{2}$，面积为 $|K_1| = |K_2| = 1/2$。对于一个 $\\mathbb{P}_{1}$ 单元，与一个顶点相关联的标量基函数 $\\varphi_{i}$ 与该顶点对应的重心坐标 $\\lambda_{i}$ 完全相同。我们使用三角形 $K$（面积为 $|K|$）上重心坐标的标准积分公式：\n$$\n\\int_{K} \\lambda_{1}^{a}\\lambda_{2}^{b}\\lambda_{3}^{c} \\, d\\boldsymbol{x} = \\frac{a!\\,b!\\,c!}{(a+b+c+2)!} \\, 2|K|\n$$\n对于标量质量矩阵的对角项（$i=j$），我们需要计算 $\\int_{K} \\varphi_{i}^{2}\\,d\\boldsymbol{x} = \\int_{K} \\lambda_{i}^{2}\\,d\\boldsymbol{x}$。使用指数为 $(a,b,c)=(2,0,0)$ 的公式，我们得到：\n$$\n\\int_{K} \\varphi_{i}^{2}\\,d\\boldsymbol{x} = \\frac{2!\\,0!\\,0!}{(2+0+0+2)!} \\, 2|K| = \\frac{2}{4!} \\, 2|K| = \\frac{4|K|}{24} = \\frac{|K|}{6}\n$$\n对于非对角项（$i\\neq j$），我们计算 $\\int_{K} \\varphi_{i}\\varphi_{j}\\,d\\boldsymbol{x} = \\int_{K} \\lambda_{i}\\lambda_{j}\\,d\\boldsymbol{x}$。使用指数为 $(a,b,c)=(1,1,0)$ 的公式，我们得到：\n$$\n\\int_{K} \\varphi_{i}\\varphi_{j}\\,d\\boldsymbol{x} = \\frac{1!\\,1!\\,0!}{(1+1+0+2)!} \\, 2|K| = \\frac{1}{4!} \\, 2|K| = \\frac{2|K|}{24} = \\frac{|K|}{12}\n$$\n对于给定网格中的两个三角形 $K_1$ 和 $K_2$，面积均为 $|K| = 1/2$。因此，对于此网格中的任何三角形 $K$ 和任何局部索引 $i,j$：\n$$\n\\int_{K} \\varphi_{i}^{2}\\,d\\boldsymbol{x} = \\frac{1/2}{6} = \\frac{1}{12}\n$$\n$$\n\\int_{K} \\varphi_{i}\\varphi_{j}\\,d\\boldsymbol{x} = \\frac{1/2}{12} = \\frac{1}{24} \\quad (i\\neq j)\n$$\n\n第三，从局部单元矩阵 $\\boldsymbol{M}^{(K)}$ 构建全局质量矩阵 $\\boldsymbol{M}$ 的组装规则是一个求和过程。全局矩阵的每一项 $\\boldsymbol{M}_{I,J}$ 是所有单元矩阵 $\\boldsymbol{M}^{(K)}$ 的贡献之和，这些单元矩阵的局部自由度对应于全局自由度 $I$ 和 $J$。设 $\\text{map}(K, i)$ 是单元 $K$ 的第 $i$ 个局部节点的全局索引，并设全局自由度 $I$ 对应于序对（全局节点，分量）。那么，（节点 $n$，分量 $\\alpha$）与（节点 $m$，分量 $\\beta$）作测试的全局项为：\n$$\nM_{(n,\\alpha),(m,\\beta)} = \\sum_{K \\in \\mathcal{T}_{h}} \\boldsymbol{M}^{(K)}_{(i_n,\\alpha),(j_m,\\beta)},\n$$\n其中，求和遍及所有同时包含全局节点 $n$ 和 $m$ 的单元 $K$，$i_n$，$j_m$ 是在 $K$ 内对应的局部索引。如果一个单元不包含其中某个节点，其贡献为零。\n\n最后，我们计算特定的全局质量矩阵项 $M_{(N_{3},x),(N_{3},x)}$。这是对应于全局节点 $N_{3}=(1,1)$ 处速度的 $x$ 分量的对角项。根据组装规则，该值是所有共享节点 $N_3$ 的单元的相应局部对角项之和。节点 $N_3$ 是三角形 $K_{1}$ 和 $K_{2}$ 的共同顶点。\n$$\nM_{(N_{3},x),(N_{3},x)} = \\boldsymbol{M}^{(K_1)}_{(i_3,x),(i_3,x)} + \\boldsymbol{M}^{(K_2)}_{(j_3,x),(j_3,x)}\n$$\n其中 $i_3$ 和 $j_3$ 分别是三角形 $K_1$ 和 $K_2$ 中对应于全局节点 $N_3$ 的局部索引。\n根据我们的第一个结果，局部矩阵项为：\n$$\n\\boldsymbol{M}^{(K)}_{(i,x),(i,x)} = \\rho \\int_{K} \\varphi_{i}^{2}(\\boldsymbol{x})\\,d\\boldsymbol{x}\n$$\n使用我们计算的积分值，对于 $K_1$：\n$$\n\\boldsymbol{M}^{(K_1)}_{(i_3,x),(i_3,x)} = \\rho \\int_{K_1} \\varphi_{i_3}^{2}\\,d\\boldsymbol{x} = \\rho \\frac{|K_1|}{6} = \\rho \\frac{1/2}{6} = \\frac{\\rho}{12}\n$$\n对于 $K_2$：\n$$\n\\boldsymbol{M}^{(K_2)}_{(j_3,x),(j_3,x)} = \\rho \\int_{K_2} \\varphi_{j_3}^{2}\\,d\\boldsymbol{x} = \\rho \\frac{|K_2|}{6} = \\rho \\frac{1/2}{6} = \\frac{\\rho}{12}\n$$\n将这两个贡献相加，得到全局矩阵项的最终值：\n$$\nM_{(N_{3},x),(N_{3},x)} = \\frac{\\rho}{12} + \\frac{\\rho}{12} = \\frac{2\\rho}{12} = \\frac{\\rho}{6}\n$$", "answer": "$$\n\\boxed{\\frac{\\rho}{6}}\n$$", "id": "2582614"}, {"introduction": "虽然“一致质量矩阵”直接源于伽辽金法的严格推导，但在实践中，特别是对于显式时间积分格式，常采用“集总质量矩阵”以获得对角矩阵，从而极大地提高计算效率。本练习将引导您计算这两种质量矩阵，并通过计算它们的差的 Frobenius 范数 $\\lVert \\Delta \\mathbf{M}^{K} \\rVert_{F}$ 来量化集总近似引入的误差。通过这个过程，您将深入理解这种近似的本质，以及它如何依赖于单元的几何形状和空间维度 $d$ [@problem_id:2582645]。", "problem": "考虑在空间维度 $d \\in \\mathbb{N}$ 的单纯形网格上，使用线性 Lagrange 基函数，通过有限元法 (FEM) 求解速度场的不可压缩 Navier–Stokes 方程的半离散 Galerkin 格式。在一个测度为 $\\lvert K \\rvert$（当 $d=1$ 时为长度，当 $d=2$ 时为面积，当 $d=3$ 时为体积，依此类推）的 $d$-单纯形单元 $K$ 上，令 $\\{ \\varphi_{a} \\}_{a=1}^{d+1}$ 表示与 $K$ 的 $d+1$ 个顶点相关联的节点基函数。局部一致速度质量矩阵 $\\mathbf{M}^{K}$ 的元素为 $M^{K}_{ab} = \\int_{K} \\varphi_{a} \\varphi_{b} \\, \\mathrm{d}x$。相应的行和集中质量矩阵 $\\mathbf{M}^{K}_{\\mathrm{L}}$ 定义为：当 $a \\neq b$ 时，$(M^{K}_{\\mathrm{L}})_{ab} = 0$；当 $a=b$ 时，$(M^{K}_{\\mathrm{L}})_{aa} = \\sum_{b=1}^{d+1} M^{K}_{ab}$。\n\n请仅使用单纯形上重心坐标的基本性质和基本积分恒等式（例如，仿射不变性和对称性），首先用 $\\lvert K \\rvert$ 和 $d$ 明确地确定一致质量矩阵 $\\mathbf{M}^{K}$ 和集中质量矩阵 $\\mathbf{M}^{K}_{\\mathrm{L}}$ 的元素。然后，令 $\\Delta \\mathbf{M}^{K} := \\mathbf{M}^{K}_{\\mathrm{L}} - \\mathbf{M}^{K}$，通过计算 Frobenius 范数来量化集中质量矩阵和一致质量矩阵之间的差异\n$$\n\\| \\Delta \\mathbf{M}^{K} \\|_{F} = \\sqrt{ \\sum_{a=1}^{d+1} \\sum_{b=1}^{d+1} \\left( \\Delta M^{K}_{ab} \\right)^{2} }.\n$$\n你的最终答案必须是 $\\| \\Delta \\mathbf{M}^{K} \\|_{F}$ 关于 $\\lvert K \\rvert$ 和 $d$ 的单一闭式解析表达式。不要对结果进行四舍五入或近似。最终答案中不带单位。", "solution": "单元 $K$ 上的半离散 Galerkin 速度质量矩阵定义为\n$$\nM^{K}_{ab} = \\int_{K} \\varphi_{a} \\varphi_{b} \\, \\mathrm{d}x,\n$$\n其中 $\\{ \\varphi_{a} \\}_{a=1}^{d+1}$ 是线性 Lagrange 基函数。在单纯形上，这些基函数正是重心坐标 $\\{ \\lambda_{a} \\}_{a=1}^{d+1}$。因此，我们需要求解重心坐标乘积的积分。\n\n我们使用以下关于测度为 $\\lvert K \\rvert$ 的 $d$-单纯形 $K$ 上重心坐标的、经过充分验证的积分性质：\n- 根据对称性，对于所有的 $a$，$\\int_{K} \\lambda_{a} \\, \\mathrm{d}x$ 的值是相同的，并且由于 $\\sum_{a=1}^{d+1} \\lambda_{a} \\equiv 1$，我们有\n$$\n\\sum_{a=1}^{d+1} \\int_{K} \\lambda_{a} \\, \\mathrm{d}x = \\int_{K} 1 \\, \\mathrm{d}x = \\lvert K \\rvert \\quad \\Longrightarrow \\quad \\int_{K} \\lambda_{a} \\, \\mathrm{d}x = \\frac{\\lvert K \\rvert}{d+1}.\n$$\n- 对于二阶乘积，根据对称性，存在常数 $a$ 和 $b$ 使得\n$$\n\\int_{K} \\lambda_{i}^{2} \\, \\mathrm{d}x = a, \\qquad \\int_{K} \\lambda_{i} \\lambda_{j} \\, \\mathrm{d}x = b \\quad \\text{for } i \\neq j.\n$$\n我们利用单纯形上的 Dirichlet（均匀）分布恒等式，或等价地，利用标准的单纯形-单项式积分公式来确定 $a$ 和 $b$，这会得出\n$$\n\\int_{K} \\lambda_{i}^{2} \\, \\mathrm{d}x = \\frac{2 \\lvert K \\rvert}{(d+1)(d+2)}, \\qquad\n\\int_{K} \\lambda_{i} \\lambda_{j} \\, \\mathrm{d}x = \\frac{\\lvert K \\rvert}{(d+1)(d+2)} \\quad (i \\neq j).\n$$\n这些结果可由一般单项式积分公式\n$$\n\\int_{K} \\prod_{m=1}^{d+1} \\lambda_{m}^{\\alpha_{m}} \\, \\mathrm{d}x\n= \\lvert K \\rvert \\, \\frac{\\prod_{m=1}^{d+1} \\alpha_{m}!}{\\left(d + \\sum_{m=1}^{d+1} \\alpha_{m}\\right)!} \\, d!,\n$$\n推导得出，该公式在特化到 $\\alpha_{i}=2$，其余为 $0$，以及 $\\alpha_{i}=\\alpha_{j}=1$，其余为 $0$ 的情况时，若对 $\\lvert K \\rvert$ 进行归一化，公共因子 $d!$ 会被适当地消去。\n\n因此，一致单元质量矩阵的元素为\n$$\nM^{K}_{ii} = \\int_{K} \\lambda_{i}^{2} \\, \\mathrm{d}x = \\frac{2 \\lvert K \\rvert}{(d+1)(d+2)}, \\qquad\nM^{K}_{ij} = \\int_{K} \\lambda_{i} \\lambda_{j} \\, \\mathrm{d}x = \\frac{\\lvert K \\rvert}{(d+1)(d+2)} \\quad (i \\neq j).\n$$\n等价地，以矩阵形式表示，其中 $n = d+1$，\n$$\n\\mathbf{M}^{K} = \\frac{\\lvert K \\rvert}{(d+1)(d+2)} \\left( \\mathbf{1}\\mathbf{1}^{\\top} + \\mathbf{I} \\right),\n$$\n这里 $\\mathbf{1} \\in \\mathbb{R}^{n}$ 是全一向量，$\\mathbf{I}$ 是 $n \\times n$ 单位矩阵。\n\n接下来，行和集中质量矩阵定义为：当 $i \\neq j$ 时，$(M^{K}_{\\mathrm{L}})_{ij} = 0$，且\n$$\n(M^{K}_{\\mathrm{L}})_{ii} = \\sum_{j=1}^{d+1} M^{K}_{ij}.\n$$\n由于 $\\mathbf{M}^{K}$ 的每一行之和等于\n$$\n\\sum_{j=1}^{d+1} M^{K}_{ij} = M^{K}_{ii} + d \\cdot \\sum_{j \\neq i} M^{K}_{ij}\n= \\frac{2 \\lvert K \\rvert}{(d+1)(d+2)} + d \\cdot \\frac{\\lvert K \\rvert}{(d+1)(d+2)}\n= \\frac{\\lvert K \\rvert}{d+1},\n$$\n我们得到\n$$\n\\mathbf{M}^{K}_{\\mathrm{L}} = \\frac{\\lvert K \\rvert}{d+1} \\, \\mathbf{I}.\n$$\n\n定义差值\n$$\n\\Delta \\mathbf{M}^{K} := \\mathbf{M}^{K}_{\\mathrm{L}} - \\mathbf{M}^{K}.\n$$\n其元素为\n$$\n\\Delta M^{K}_{ii} = \\frac{\\lvert K \\rvert}{d+1} - \\frac{2 \\lvert K \\rvert}{(d+1)(d+2)} = \\frac{\\lvert K \\rvert}{d+1} \\left( 1 - \\frac{2}{d+2} \\right) = \\frac{\\lvert K \\rvert \\, d}{(d+1)(d+2)},\n$$\n且当 $i \\neq j$ 时，\n$$\n\\Delta M^{K}_{ij} = 0 - \\frac{\\lvert K \\rvert}{(d+1)(d+2)} = - \\frac{\\lvert K \\rvert}{(d+1)(d+2)}.\n$$\n\n我们现在计算 Frobenius 范数\n$$\n\\| \\Delta \\mathbf{M}^{K} \\|_{F}^{2}\n= \\sum_{i=1}^{d+1} \\sum_{j=1}^{d+1} \\left( \\Delta M^{K}_{ij} \\right)^{2}\n= (d+1) \\left( \\frac{\\lvert K \\rvert \\, d}{(d+1)(d+2)} \\right)^{2}\n+ (d+1)d \\left( -\\frac{\\lvert K \\rvert}{(d+1)(d+2)} \\right)^{2}.\n$$\n提出公因式：\n$$\n\\| \\Delta \\mathbf{M}^{K} \\|_{F}^{2}\n= \\left( \\frac{\\lvert K \\rvert}{(d+1)(d+2)} \\right)^{2}\n\\left[ (d+1) d^{2} + (d+1) d \\right]\n= \\left( \\frac{\\lvert K \\rvert}{(d+1)(d+2)} \\right)^{2} (d+1) d (d+1).\n$$\n因此，\n$$\n\\| \\Delta \\mathbf{M}^{K} \\|_{F}^{2}\n= \\frac{\\lvert K \\rvert^{2} \\, d \\, (d+1)^{2}}{(d+1)^{2} (d+2)^{2}}\n= \\frac{\\lvert K \\rvert^{2} \\, d}{(d+2)^{2}}.\n$$\n取平方根得到闭式表达式\n$$\n\\| \\Delta \\mathbf{M}^{K} \\|_{F} = \\frac{\\lvert K \\rvert \\, \\sqrt{d}}{d+2}.\n$$\n\n此式以单元几何（通过 $\\lvert K \\rvert$）和空间维度 $d$ 的形式，量化了在 $d$-单纯形上的线性 Lagrange 有限元中，由行和质量集中所引起的、相对于一致局部质量矩阵的 Frobenius 范数偏差。", "answer": "$$\\boxed{\\frac{|K|\\,\\sqrt{d}}{d+2}}$$", "id": "2582645"}, {"introduction": "在掌握了单个矩阵（如质量矩阵）的组装之后，我们将把这些知识综合起来，构建一个更完整的方程系统。本练习作为一个综合性实践，将处理线性化的 Navier-Stokes 方程（即 Oseen 方程），要求您对一个包含对流、扩散、压力梯度和稳定化项的完整系统进行组装。通过识别和计算系统矩阵的各个分块，您将对一个实际的、已稳定的半离散流动问题如何转化为代数方程组获得一个全面的认识 [@problem_id:2582638]。", "problem": "考虑在给定对流速度场 $\\boldsymbol{U}$ 下的二维空间中的Oseen线性化形式的不可压缩Navier-Stokes方程，该方程通过有限元法（FEM）在空间上进行离散，对速度和压力均采用同阶连续分片线性元（$P_1/P_1$），并对压力进行稳定化处理。计算域为单位正方形，其顶点为 $(0,0)$、$(1,0)$、$(1,1)$和$(0,1)$，通过从 $(0,0)$ 到 $(1,1)$ 的对角线将其三角剖分为两个单元。将节点记为 $1:(0,0)$、$2:(1,0)$、$3:(1,1)$和$4:(0,1)$。这两个三角形是 $K_1 = \\operatorname{conv}\\{(0,0),(1,0),(1,1)\\}$ 和 $K_2 = \\operatorname{conv}\\{(0,0),(1,1),(0,1)\\}$。设运动粘度为 $\\nu>0$，密度为 $\\rho=1$。设线性化（对流）速度为均匀的 $\\boldsymbol{U}=(2,1)$。\n\n设 $\\boldsymbol{u}$ 表示速度场，$p$ 表示压力。其（时间上）半离散的稳定化弱形式旨在 $P_1/P_1$ 空间中求解 $\\boldsymbol{u}_h(t)$ 和 $p_h(t)$，使得对于同一空间中的所有测试函数 $\\boldsymbol{w}_h$ 和 $q_h$，\n- 动量平衡方程表述为\n$\\displaystyle (\\boldsymbol{w}_h,\\dot{\\boldsymbol{u}}_h) + \\nu \\sum_{K} (\\nabla \\boldsymbol{u}_h,\\nabla \\boldsymbol{w}_h)_K + \\sum_{K} ((\\boldsymbol{U}\\cdot \\nabla)\\boldsymbol{u}_h,\\boldsymbol{w}_h)_K - (p_h,\\nabla\\cdot \\boldsymbol{w}_h) = (\\boldsymbol{f},\\boldsymbol{w}_h)$，\n- 不可压缩性与稳定化方程表述为\n$\\displaystyle (q_h,\\nabla\\cdot \\boldsymbol{u}_h) + \\sum_{K} \\tau_{p,K} (\\nabla p_h,\\nabla q_h)_K = 0$，\n其中 $(\\cdot,\\cdot)_K$ 是单元 $K$ 上的 $L^2$ 内积，$\\tau_{p,K}$ 是一个压力稳定化参数，选择为 $\\tau_{p,K}=\\alpha h_K^2$，其中 $\\alpha>0$ 为常数，$h_K$ 为单元尺寸（对于此网格，你可以假设 $h_{K_1}=h_{K_2}=1$）。未采用其他稳定化方法。\n\n采用节点 $P_1$ 标量形函数 $\\{N_i\\}_{i=1}^4$ 和标准的矢量值速度基 $\\{\\boldsymbol{\\phi}_{i}^{x},\\boldsymbol{\\phi}_{i}^{y}\\}_{i=1}^4$，定义为 $\\boldsymbol{\\phi}_{i}^{x} = N_i \\boldsymbol{e}_x$ 和 $\\boldsymbol{\\phi}_{i}^{y} = N_i \\boldsymbol{e}_y$，其中 $\\boldsymbol{e}_x$ 和 $\\boldsymbol{e}_y$ 是笛卡尔单位向量。设全局未知量向量按 $\\big(u_1^x,u_2^x,u_3^x,u_4^x,u_1^y,u_2^y,u_3^y,u_4^y,p_1,p_2,p_3,p_4\\big)^\\top$ 的顺序排列。\n\n1. 从以上弱形式和每个三角形上的 $P_1$ 基函数定义出发，组装线性化半离散块系统矩阵 $\\mathbb{A}(\\boldsymbol{U})$，使得半离散系统表述为\n$\\displaystyle \\mathbb{M}\\,\\dot{\\mathbf{z}}(t) + \\mathbb{A}(\\boldsymbol{U})\\,\\mathbf{z}(t) = \\mathbf{F}(t),$\n其中 $\\mathbf{z}(t)$ 按给定顺序汇集了速度和压力的节点值。并指出 $\\mathbb{M}$ 和 $\\mathbb{A}(\\boldsymbol{U})$ 中每个块的数学意义（扩散、线性化对流、散度/梯度耦合和压力稳定化）。你的组装过程必须与所述的双单元网格和所选基函数一致。\n\n2. 仅使用单元级双线性形式和 $P_1$ 形函数的基本定义，显式计算速度-速度对流-扩散块中对应于节点1处x分量的全局对角线元，即单元对\n$\\displaystyle a^{xx}_{11}(\\boldsymbol{U}) \\equiv \\nu \\sum_{K} \\int_K \\nabla N_1 \\cdot \\nabla N_1 \\,\\mathrm{d}x + \\sum_{K} \\int_K (\\boldsymbol{U}\\cdot \\nabla N_1)\\,N_1 \\,\\mathrm{d}x.$\n的贡献在 $K_1$ 和 $K_2$ 上的总和。将最终答案表示为仅含 $\\nu$ 的单个闭式解析表达式。此组装不施加边界条件。不进行数值取整；给出精确表达式。", "solution": "所述问题具有科学依据、适定且客观。它是在使用同阶插值空间的稳定化格式对不可压缩Navier-Stokes方程进行有限元分析中的一个标准练习。所有提供的信息都是一致且充分的，足以进行求解。\n\n半离散系统的形式为 $\\mathbb{M}\\,\\dot{\\mathbf{z}}(t) + \\mathbb{A}(\\boldsymbol{U})\\,\\mathbf{z}(t) = \\mathbf{F}(t)$，其中未知量向量 $\\mathbf{z}(t)$ 被划分为速度和压力分量。根据指定的顺序，我们有 $\\mathbf{z} = [\\mathbf{u}^x, \\mathbf{u}^y, \\mathbf{p}]^\\top$，其中 $\\mathbf{u}^x, \\mathbf{u}^y, \\mathbf{p}$ 是大小为 $4 \\times 1$ 的节点值向量。系统矩阵 $\\mathbb{M}$ 和 $\\mathbb{A}$ 将是 $12 \\times 12$ 的块矩阵。\n\n速度场和压力场在有限元基中展开为：\n$$ \\boldsymbol{u}_h(t) = \\sum_{j=1}^4 u_j^x(t) (N_j \\boldsymbol{e}_x) + \\sum_{j=1}^4 u_j^y(t) (N_j \\boldsymbol{e}_y) $$\n$$ p_h(t) = \\sum_{j=1}^4 p_j(t) N_j $$\n测试函数从相同的基中选择：$\\boldsymbol{w}_h$ 是 $\\{N_i \\boldsymbol{e}_x\\}_{i=1}^4$ 或 $\\{N_i \\boldsymbol{e}_y\\}_{i=1}^4$ 中的一个，而 $q_h$ 是 $\\{N_i\\}_{i=1}^4$ 中的一个。\n\n**第1部分：系统矩阵的块结构**\n\n我们通过将展开式代入弱形式并用每个基函数进行测试来推导 $\\mathbb{M}$ 和 $\\mathbb{A}$ 的块结构。\n\n质量矩阵 $\\mathbb{M}$ 源于时间导数项 $(\\boldsymbol{w}_h, \\dot{\\boldsymbol{u}}_h)$。由于压力方程没有时间导数，$\\mathbb{M}$ 的最后一个块行和块列均为零。速度-速度块是相同的。\n对于测试函数 $\\boldsymbol{w}_h = N_i \\boldsymbol{e}_x$，该项变为 $\\sum_j (\\int_\\Omega N_i N_j d\\Omega) \\dot{u}_j^x$。\n$\\mathbb{M}$ 的最终块结构是：\n$$ \\mathbb{M} = \\begin{pmatrix} \\mathbf{M}_s & \\mathbf{0} & \\mathbf{0} \\\\ \\mathbf{0} & \\mathbf{M}_s & \\mathbf{0} \\\\ \\mathbf{0} & \\mathbf{0} & \\mathbf{0} \\end{pmatrix} $$\n其中 $\\mathbf{M}_s$ 是 $4 \\times 4$ 的标量质量矩阵，其元为 $(\\mathbf{M}_s)_{ij} = \\int_\\Omega N_i N_j d\\Omega$。\n\n系统矩阵 $\\mathbb{A}(\\boldsymbol{U})$ 包含来自扩散、对流、梯度、散度和稳定化项的贡献。我们根据其数学作用来识别每个块。\n$$ \\mathbb{A}(\\boldsymbol{U}) = \\begin{pmatrix} \\mathbf{A}_{uu}(\\boldsymbol{U}) & \\mathbf{0} & \\mathbf{G}_x \\\\ \\mathbf{0} & \\mathbf{A}_{uu}(\\boldsymbol{U}) & \\mathbf{G}_y \\\\ \\mathbf{D}_x & \\mathbf{D}_y & \\mathbf{L}_p \\end{pmatrix} $$\n每个块都是一个 $4 \\times 4$ 的矩阵，定义如下：\n\n1.  **速度-速度块 $\\mathbf{A}_{uu}(\\boldsymbol{U})$**：该块结合了扩散和线性化对流对速度场的影响。由于算子的标量性质，它对于x和y方向的动量方程是相同的。\n    $$ \\mathbf{A}_{uu}(\\boldsymbol{U}) = \\nu \\mathbf{K}_s + \\mathbf{C}(\\boldsymbol{U}) $$\n    -   $\\mathbf{K}_s$ 是**标量扩散矩阵**（或刚度矩阵），来自项 $\\nu \\sum_K (\\nabla \\boldsymbol{u}_h, \\nabla \\boldsymbol{w}_h)_K$。其元为 $(\\mathbf{K}_s)_{ij} = \\sum_K \\int_K \\nabla N_i \\cdot \\nabla N_j dx$。\n    -   $\\mathbf{C}(\\boldsymbol{U})$ 是**标量对流矩阵**，来自项 $\\sum_K ((\\boldsymbol{U} \\cdot \\nabla)\\boldsymbol{u}_h, \\boldsymbol{w}_h)_K$。其元为 $(\\mathbf{C}(\\boldsymbol{U}))_{ij} = \\sum_K \\int_K N_i (\\boldsymbol{U} \\cdot \\nabla N_j) dx$。非对角速度块为零，因为测试函数与笛卡尔坐标轴对齐。\n\n2.  **速度-压力耦合块 ($\\mathbf{G}_x$, $\\mathbf{G}_y$)**：这些块代表离散**梯度算子**。它们将压力场耦合到动量方程。\n    -   从项 $-(p_h, \\nabla \\cdot \\boldsymbol{w}_h)$中，当 $\\boldsymbol{w}_h = N_i\\boldsymbol{e}_x$时，我们得到将压力耦合到x方向动量的块 $\\mathbf{G}_x$。其元为 $(\\mathbf{G}_x)_{ij} = -\\int_{\\Omega} N_i \\frac{\\partial N_j}{\\partial x} d\\Omega$。\n    -   类似地，当 $\\boldsymbol{w}_h = N_i\\boldsymbol{e}_y$时，我们得到将压力耦合到y方向动量的块 $\\mathbf{G}_y$。其元为 $(\\mathbf{G}_y)_{ij} = -\\int_{\\Omega} N_i \\frac{\\partial N_j}{\\partial y} d\\Omega$。\n\n3.  **压力-速度耦合块 ($\\mathbf{D}_x$, $\\mathbf{D}_y$)**：这些块代表离散**散度算子**。它们将速度场耦合到连续性方程。\n    -   从项 $(q_h, \\nabla \\cdot \\boldsymbol{u}_h)$中，当 $q_h = N_i$时，与x速度分量 $\\boldsymbol{u}^x$ 的耦合给出了块 $\\mathbf{D}_x$。其元为 $(\\mathbf{D}_x)_{ij} = \\int_{\\Omega} N_i \\frac{\\partial N_j}{\\partial x} d\\Omega$。\n    -   与y速度分量 $\\boldsymbol{u}^y$ 的耦合给出了块 $\\mathbf{D}_y$。其元为 $(\\mathbf{D}_y)_{ij} = \\int_{\\Omega} N_i \\frac{\\partial N_j}{\\partial y} d\\Omega$。\n    注意，在没有分部积分产生的边界项的情况下，$\\mathbf{D}_x = -\\mathbf{G}_x^T$ 且 $\\mathbf{D}_y = -\\mathbf{G}_y^T$。\n\n4.  **压力-压力块 ($\\mathbf{L}_p$)**：此块源于压力稳定化项 $\\sum_K \\tau_{p,K} (\\nabla p_h, \\nabla q_h)_K$。\n    -   在 $\\tau_{p,K} = \\alpha h_K^2$ 和给定假设 $h_K=1$ 的条件下，稳定化项变为 $\\alpha \\sum_K (\\nabla p_h, \\nabla q_h)_K$。此块是一个**压力拉普拉斯矩阵** $\\mathbf{L}_p = \\alpha \\mathbf{K}_s$，其中 $\\mathbf{K}_s$ 是与前面定义的相同的标量扩散矩阵。\n\n**第2部分：矩阵元 $a^{xx}_{11}(\\boldsymbol{U})$ 的显式计算**\n\n我们需要计算对应于节点1（位于 $(0,0)$）处x速度的对角元。这是块 $\\mathbf{A}_{uu}(\\boldsymbol{U})$ 的 $(1,1)$ 元。\n$$ a^{xx}_{11}(\\boldsymbol{U}) = \\nu \\left( \\sum_{K} \\int_K \\nabla N_1 \\cdot \\nabla N_1 \\,\\mathrm{d}x \\right) + \\left( \\sum_{K} \\int_K (\\boldsymbol{U}\\cdot \\nabla N_1)\\,N_1 \\,\\mathrm{d}x \\right) $$\n节点 $1$ 是两个三角形 $K_1 = \\operatorname{conv}\\{(0,0),(1,0),(1,1)\\}$ 和 $K_2 = \\operatorname{conv}\\{(0,0),(1,1),(0,1)\\}$ 的共同顶点。我们必须计算来自这两个单元的贡献。\n\n首先，我们确定每个单元上的形函数 $N_1(x,y)$ 及其梯度。\n-   在具有节点 $(0,0), (1,0), (1,1)$ 的单元 $K_1$ 上，对应于节点1 $(0,0)$ 的形函数是 $N_1^{K_1}(x,y) = 1-x$。其梯度是常数：$\\nabla N_1^{K_1} = (-1, 0)$。\n-   在具有节点 $(0,0), (1,1), (0,1)$ 的单元 $K_2$ 上，对应于节点1 $(0,0)$ 的形函数是 $N_1^{K_2}(x,y) = 1-y$。其梯度是常数：$\\nabla N_1^{K_2} = (0, -1)$。\n\n现在，我们计算 $a^{xx}_{11}(\\boldsymbol{U})$ 的两个部分。\n\n**扩散分量：**\n来自 $K_1$ 的贡献是 $\\int_{K_1} |\\nabla N_1^{K_1}|^2 \\,\\mathrm{d}x = \\int_{K_1} |(-1,0)|^2 \\,\\mathrm{d}x = \\int_{K_1} 1 \\,\\mathrm{d}x = \\text{Area}(K_1) = \\frac{1}{2}$。\n来自 $K_2$ 的贡献是 $\\int_{K_2} |\\nabla N_1^{K_2}|^2 \\,\\mathrm{d}x = \\int_{K_2} |(0,-1)|^2 \\,\\mathrm{d}x = \\int_{K_2} 1 \\,\\mathrm{d}x = \\text{Area}(K_2) = \\frac{1}{2}$。\n总扩散项为 $\\nu (\\frac{1}{2} + \\frac{1}{2}) = \\nu$。\n\n**对流分量：**\n对流速度为 $\\boldsymbol{U}=(2,1)$。\n-   在 $K_1$ 上：$\\boldsymbol{U}\\cdot \\nabla N_1^{K_1} = (2,1) \\cdot (-1,0) = -2$。被积函数为 $(-2) N_1^{K_1}(x,y) = -2(1-x)$。这是线性的，所以我们可以使用对线性函数精确的求积法则：$\\int_K f dK = \\frac{\\text{Area}(K)}{3}\\sum_{i=1}^3 f(\\text{vertex}_i)$。\n    $K_1$ 的顶点是 $(0,0), (1,0), (1,1)$。被积函数 $-2(1-x)$ 在这些顶点的值分别为 $-2$、$0$ 和 $0$。\n    积分为 $\\frac{1/2}{3} (-2+0+0) = \\frac{1}{6}(-2) = -\\frac{1}{3}$。\n-   在 $K_2$ 上：$\\boldsymbol{U}\\cdot \\nabla N_1^{K_2} = (2,1) \\cdot (0,-1) = -1$。被积函数为 $(-1) N_1^{K_2}(x,y) = -1(1-y)$。\n    $K_2$ 的顶点是 $(0,0), (1,1), (0,1)$。被积函数 $-1(1-y)$ 在这些顶点的值分别为 $-1$、$0$ 和 $0$。\n    积分为 $\\frac{1/2}{3} (-1+0+0) = \\frac{1}{6}(-1) = -\\frac{1}{6}$。\n总对流项为 $(-\\frac{1}{3}) + (-\\frac{1}{6}) = -\\frac{2}{6} - \\frac{1}{6} = -\\frac{3}{6} = -\\frac{1}{2}$。\n\n**总值：**\n结合扩散和对流分量，我们得到该矩阵元的最终值为：\n$$ a^{xx}_{11}(\\boldsymbol{U}) = \\nu - \\frac{1}{2} $$\n此表达式符合要求，仅依赖于参数 $\\nu$。", "answer": "$$\n\\boxed{\\nu - \\frac{1}{2}}\n$$", "id": "2582638"}]}