{"hands_on_practices": [{"introduction": "SUPG 方法的核心思想是沿着流线方向，为标准的伽辽金法增加一个与残差成正比的稳定项。为了掌握这一概念，我们首先需要理解“流线导数”和“强残差”这两个基本构成要素。本练习 [@problem_id:2602075] 将引导您通过一个具体的例子，将这些抽象的定义应用于一个给定的速度场和解函数，从而为理解 SUPG 稳定项的构造打下坚实的数学基础。", "problem": "考虑一个在光滑单连通域 $\\Omega \\subset \\mathbb{R}^{2}$ 上设定的、带有齐次狄利克雷边界条件的稳态、无量纲线性对流-扩散-反应模型问题。其强形式为\n$$\n-\\epsilon\\,\\Delta u + \\boldsymbol{\\beta}\\cdot\\nabla u + \\sigma\\,u = f \\quad \\text{在 } \\Omega \\text{ 内},\n$$\n其中 $\\epsilon>0$ 是（常数）扩散系数，$\\boldsymbol{\\beta}\\in\\mathbb{R}^{2}$ 是一个常数对流场，$\\sigma\\ge 0$ 是一个（常数）反应系数，$f$ 是给定的源项。与一个足够光滑的函数 $u$ 相关的强残差定义为\n$$\nr(u) \\coloneqq -\\epsilon\\,\\Delta u + \\boldsymbol{\\beta}\\cdot\\nabla u + \\sigma\\,u - f.\n$$\n在 Streamline Upwind/Petrov–Galerkin (SUPG) 稳定化方法中，流线方向取为沿流场 $\\boldsymbol{\\beta}$ 的方向，流线导数定义为\n$$\n\\partial_{\\boldsymbol{t}} u \\coloneqq \\boldsymbol{t}\\cdot\\nabla u, \\quad \\boldsymbol{t} \\coloneqq \\frac{\\boldsymbol{\\beta}}{\\lVert\\boldsymbol{\\beta}\\rVert}.\n$$\n设对流场为常数 $\\boldsymbol{\\beta}=(2,1)$，候选解为 $u(x,y)=\\exp(x+2y)$。假设 $f(x,y)=0$。\n\n从上述定义和仅有的基本矢量微积分恒等式出发，推导 $\\partial_{\\boldsymbol{t}} u$ 并用它将残差重写为以下形式\n$$\nr(u)= -\\epsilon\\,\\Delta u + \\lVert\\boldsymbol{\\beta}\\rVert\\,\\partial_{\\boldsymbol{t}} u + \\sigma\\,u - f,\n$$\n然后对给定的 $u$、$\\boldsymbol{\\beta}$ 和 $f$ 计算 $r(u)(x,y)$。请以 $x$、$y$、$\\epsilon$ 和 $\\sigma$ 的单一闭式解析表达式形式提供您的最终答案。不包含单位。无需进行数值取整。", "solution": "对问题陈述进行验证。\n\n第一步：提取已知条件。\n- 稳态、无量纲线性对流-扩散-反应方程的强形式：$-\\epsilon\\,\\Delta u + \\boldsymbol{\\beta}\\cdot\\nabla u + \\sigma\\,u = f$，在 $\\Omega \\subset \\mathbb{R}^{2}$ 内。\n- 扩散系数：$\\epsilon > 0$，常数。\n- 对流场：$\\boldsymbol{\\beta} \\in \\mathbb{R}^{2}$，常数。\n- 反应系数：$\\sigma \\ge 0$，常数。\n- 源项：$f$。\n- 强残差的定义：$r(u) \\coloneqq -\\epsilon\\,\\Delta u + \\boldsymbol{\\beta}\\cdot\\nabla u + \\sigma\\,u - f$。\n- 流线方向的定义：$\\boldsymbol{t} \\coloneqq \\frac{\\boldsymbol{\\beta}}{\\lVert\\boldsymbol{\\beta}\\rVert}$。\n- 流线导数的定义：$\\partial_{\\boldsymbol{t}} u \\coloneqq \\boldsymbol{t}\\cdot\\nabla u$。\n- 特定的对流场：$\\boldsymbol{\\beta}=(2,1)$。\n- 特定的候选解：$u(x,y)=\\exp(x+2y)$。\n- 特定的源项：$f(x,y)=0$。\n\n第二步：使用已提取的已知条件进行验证。\n- **科学依据：** 该问题基于对流-扩散-反应偏微分方程，这是输运现象中的一个基本模型。Streamline Upwind/Petrov-Galerkin (SUPG) 方法是计算流体动力学和有限元法中一种标准且成熟的稳定化技术。所有定义都是标准的且数学上是正确的。\n- **适定性：** 该问题要求推导一个恒等式并计算一个结果表达式。这是一个具有唯一、明确定义结果的直接计算。\n- **客观性：** 该问题以精确的数学语言陈述，不含主观性。\n- **完整性与一致性：** 为执行所需计算，提供了所有必要的函数 ($u$, $\\boldsymbol{\\beta}$, $f$) 和定义 ($r(u)$, $\\partial_{\\boldsymbol{t}} u$) 。不存在矛盾。\n\n第三步：结论与行动。\n该问题是有效的。它是矢量微积分和偏微分方程分析中的一个标准练习。可以继续求解过程。\n\n该任务包含两部分：首先，将残差 $r(u)$ 用流线导数 $\\partial_{\\boldsymbol{t}} u$ 重写；其次，对给定的函数计算此残差。\n\n第一部分：用流线导数表示残差的推导。\n\n强残差定义为：\n$$\nr(u) = -\\epsilon\\,\\Delta u + \\boldsymbol{\\beta}\\cdot\\nabla u + \\sigma\\,u - f\n$$\n流线方向 $\\boldsymbol{t}$ 定义为对流场 $\\boldsymbol{\\beta}$ 方向上的单位矢量：\n$$\n\\boldsymbol{t} = \\frac{\\boldsymbol{\\beta}}{\\lVert\\boldsymbol{\\beta}\\rVert}\n$$\n从此定义直接得出，对流场可以表示为：\n$$\n\\boldsymbol{\\beta} = \\lVert\\boldsymbol{\\beta}\\rVert\\,\\boldsymbol{t}\n$$\n流线导数 $\\partial_{\\boldsymbol{t}} u$ 定义为 $u$ 在 $\\boldsymbol{t}$ 方向上的方向导数：\n$$\n\\partial_{\\boldsymbol{t}} u = \\boldsymbol{t}\\cdot\\nabla u\n$$\n现在，考虑残差中的对流项 $\\boldsymbol{\\beta}\\cdot\\nabla u$。将 $\\boldsymbol{\\beta}$ 用 $\\boldsymbol{t}$ 表示的表达式代入：\n$$\n\\boldsymbol{\\beta}\\cdot\\nabla u = (\\lVert\\boldsymbol{\\beta}\\rVert\\,\\boldsymbol{t})\\cdot\\nabla u\n$$\n使用标量-矢量乘积的性质，我们可以写出：\n$$\n\\boldsymbol{\\beta}\\cdot\\nabla u = \\lVert\\boldsymbol{\\beta}\\rVert\\,(\\boldsymbol{t}\\cdot\\nabla u)\n$$\n将流线导数 $\\partial_{\\boldsymbol{t}} u$ 的定义代入此表达式，得到：\n$$\n\\boldsymbol{\\beta}\\cdot\\nabla u = \\lVert\\boldsymbol{\\beta}\\rVert\\,\\partial_{\\boldsymbol{t}} u\n$$\n最后，我们将此结果代回残差 $r(u)$ 的原始定义中：\n$$\nr(u) = -\\epsilon\\,\\Delta u + \\lVert\\boldsymbol{\\beta}\\rVert\\,\\partial_{\\boldsymbol{t}} u + \\sigma\\,u - f\n$$\n这就完成了任务的第一部分，证明了所需的关系。\n\n第二部分：计算残差 $r(u)(x,y)$。\n\n我们已知候选解 $u(x,y) = \\exp(x+2y)$，对流场 $\\boldsymbol{\\beta} = (2,1)$，以及源项 $f(x,y)=0$。为计算 $r(u)$，我们必须计算 $u$ 的必要导数。\n\n首先，我们计算 $u$ 的梯度 $\\nabla u$：\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} \\exp(x+2y) = \\exp(x+2y)\n$$\n$$\n\\frac{\\partial u}{\\partial y} = \\frac{\\partial}{\\partial y} \\exp(x+2y) = 2\\exp(x+2y)\n$$\n因此，梯度为：\n$$\n\\nabla u = \\begin{pmatrix} \\exp(x+2y) \\\\ 2\\exp(x+2y) \\end{pmatrix}\n$$\n接下来，我们计算 $u$ 的拉普拉斯算子 $\\Delta u = \\nabla \\cdot \\nabla u$。我们需要二阶偏导数：\n$$\n\\frac{\\partial^2 u}{\\partial x^2} = \\frac{\\partial}{\\partial x} \\left(\\exp(x+2y)\\right) = \\exp(x+2y)\n$$\n$$\n\\frac{\\partial^2 u}{\\partial y^2} = \\frac{\\partial}{\\partial y} \\left(2\\exp(x+2y)\\right) = 4\\exp(x+2y)\n$$\n拉普拉斯算子是这些纯二阶导数之和：\n$$\n\\Delta u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = \\exp(x+2y) + 4\\exp(x+2y) = 5\\exp(x+2y)\n$$\n现在，我们可以计算原始残差表达式 $r(u) = -\\epsilon\\,\\Delta u + \\boldsymbol{\\beta}\\cdot\\nabla u + \\sigma\\,u - f$ 中的每一项。\n扩散项为：\n$$\n-\\epsilon\\,\\Delta u = -\\epsilon(5\\exp(x+2y)) = -5\\epsilon\\exp(x+2y)\n$$\n对流项为：\n$$\n\\boldsymbol{\\beta}\\cdot\\nabla u = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} \\cdot \\begin{pmatrix} \\exp(x+2y) \\\\ 2\\exp(x+2y) \\end{pmatrix} = 2\\exp(x+2y) + 1 \\cdot 2\\exp(x+2y) = 4\\exp(x+2y)\n$$\n反应项为：\n$$\n\\sigma\\,u = \\sigma\\exp(x+2y)\n$$\n源项给定为 $f=0$。\n\n我们将这些项相加来组合成残差：\n$$\nr(u)(x,y) = -5\\epsilon\\exp(x+2y) + 4\\exp(x+2y) + \\sigma\\exp(x+2y) - 0\n$$\n提取公因式 $\\exp(x+2y)$，得到残差的最终表达式：\n$$\nr(u)(x,y) = (4 + \\sigma - 5\\epsilon)\\exp(x+2y)\n$$\n这就是残差所要求的闭式解析表达式。", "answer": "$$\n\\boxed{(4 + \\sigma - 5\\epsilon)\\exp(x+2y)}\n$$", "id": "2602075"}, {"introduction": "SUPG 稳定化的效果在很大程度上取决于稳定参数 $\\tau$ 的选择，而该参数的计算是实现 SUPG 方法的核心步骤之一。这个参数的取值并非任意，它依赖于单元的局部特性，如单元尺寸、流速和物理扩散系数。本练习 [@problem_id:2602150] 将指导您针对一个具体的二维三角形单元，亲手计算沿流线方向的特征长度 $h_{\\boldsymbol{t}}$，并进一步推导出最优的稳定参数 $\\tau$，从而掌握在实际有限元程序中实施 SUPG 方法的关键计算技能。", "problem": "考虑二维空间中的稳态、无量纲的平流–扩散–反应边值问题，\n$$-\\,\\epsilon\\,\\Delta u + \\boldsymbol{\\beta}\\cdot\\nabla u + \\sigma\\,u = f \\quad \\text{in a polygonal domain},$$\n其系数为常数。重点研究一个顶点位于\n$$\\boldsymbol{x}_1=(0,0),\\quad \\boldsymbol{x}_2=(0.04,0),\\quad \\boldsymbol{x}_3=(0,0.03),$$\n的仿射线性三角形有限元，及其相关的线性 Lagrange 节点形函数 $N_i$，这些形函数满足单位分解和线性完备性。设平流速度为 $\\boldsymbol{\\beta}=(10,0.5)$，扩散系数为 $\\epsilon=10^{-4}$，反应系数为 $\\sigma=0$。\n\n(a) 仅从 (i) 线性两节点单元的一维恒等式，即形函数导数的绝对值之和等于 $2/h$（其中 $h$ 是单元长度），以及 (ii) 三角形的仿射映射和方向导数概念出发，推导沿流线方向 $\\boldsymbol{t}=\\boldsymbol{\\beta}/\\|\\boldsymbol{\\beta}\\|$ 的方向单元长度 $h_{\\boldsymbol{t}}$ 的公式，该公式用常梯度 $\\nabla N_i$ 和 $\\boldsymbol{t}$ 表示。然后，对给定的三角形和 $\\boldsymbol{\\beta}$ 计算 $h_{\\boldsymbol{t}}$ 的值。\n\n(b) 使用一维常系数分析，该分析可得到沿流线方向的最优流线迎风/Petrov–Galerkin (SUPG) 稳定化参数，推导稳定化参数 $\\tau$ 的表达式，该表达式用 $h_{\\boldsymbol{t}}$、$\\|\\boldsymbol{\\beta}\\|$、$\\epsilon$ 和单元 Péclet 数表示。然后，根据给定数据计算 $\\tau$ 的值。\n\n提供 $h_{\\boldsymbol{t}}$ 和 $\\tau$ 的最终数值。将两者均四舍五入至六位有效数字。将最终答案表示为有序对 $(h_{\\boldsymbol{t}},\\ \\tau)$，不带单位。", "solution": "问题陈述经验证是适定的、有科学依据且自洽的。这是一个关于平流主导问题有限元分析的标准（尽管不简单）练习。我们开始求解。\n\n问题分为两部分。我们依次解决。\n\n(a) 方向单元长度 $h_{\\boldsymbol{t}}$ 的推导与计算。\n\n对于线性三角形单元，Lagrange 节点形函数 $N_i(\\boldsymbol{x})$ 是空间坐标 $\\boldsymbol{x}=(x,y)$ 的线性函数。因此，它们的梯度 $\\nabla N_i$ 在单元上是常向量。这些梯度由单元的几何形状确定。给定顶点 $\\boldsymbol{x}_1=(0,0)$、$\\boldsymbol{x}_2=(0.04,0)$ 和 $\\boldsymbol{x}_3=(0,0.03)$，三角形的面积为 $A = \\frac{1}{2}(0.04)(0.03) = 0.0006$。梯度计算如下：\n$$\n\\nabla N_i = \\frac{1}{2A} \\begin{pmatrix} y_j - y_k \\\\ x_k - x_j \\end{pmatrix}\n$$\n其中 $(i,j,k)$ 是 $(1,2,3)$ 的循环排列。对于给定的顶点：\n$$\n\\nabla N_1 = \\frac{1}{0.0012} \\begin{pmatrix} 0 - 0.03 \\\\ 0 - 0.04 \\end{pmatrix} = \\begin{pmatrix} -25 \\\\ -100/3 \\end{pmatrix}\n$$\n$$\n\\nabla N_2 = \\frac{1}{0.0012} \\begin{pmatrix} 0.03 - 0 \\\\ 0 - 0 \\end{pmatrix} = \\begin{pmatrix} 25 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\nabla N_3 = \\frac{1}{0.0012} \\begin{pmatrix} 0 - 0 \\\\ 0.04 - 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 100/3 \\end{pmatrix}\n$$\n线性完备性条件 $\\sum_{i=1}^3 \\nabla N_i = \\boldsymbol{0}$ 得到满足。\n\n问题要求从长度为 $h$ 的线性两节点单元的一维恒等式 $\\sum_{i=1}^2 |N_i'| = \\frac{2}{h}$ 出发。该恒等式可以重排以定义单元长度为 $h = 2 / (\\sum_{i=1}^2 |N_i'|)$。\n\n我们将此概念推广到多维情况。沿单一空间坐标的导数 $N_i'$ 的角色被 $N_i$ 沿指定流线方向（由单位向量 $\\boldsymbol{t}$ 给出）的方向导数所取代。方向导数为 $\\nabla N_i \\cdot \\boldsymbol{t}$。求和遍及单元的所有节点，本例中为 $i=1, 2, 3$。这就得到了方向单元长度 $h_{\\boldsymbol{t}}$ 的定义：\n$$\nh_{\\boldsymbol{t}} = \\frac{2}{\\sum_{i=1}^3 |\\nabla N_i \\cdot \\boldsymbol{t}|}\n$$\n流线方向与平流速度 $\\boldsymbol{\\beta}=(10, 0.5)$ 一致。单位向量为 $\\boldsymbol{t} = \\boldsymbol{\\beta} / \\|\\boldsymbol{\\beta}\\|$。\n首先，我们计算点积 $\\nabla N_i \\cdot \\boldsymbol{\\beta}$：\n$$\n\\nabla N_1 \\cdot \\boldsymbol{\\beta} = (-25)(10) + (-\\frac{100}{3})(0.5) = -250 - \\frac{50}{3} = -\\frac{800}{3}\n$$\n$$\n\\nabla N_2 \\cdot \\boldsymbol{\\beta} = (25)(10) + (0)(0.5) = 250\n$$\n$$\n\\nabla N_3 \\cdot \\boldsymbol{\\beta} = (0)(10) + (\\frac{100}{3})(0.5) = \\frac{50}{3}\n$$\n它们的绝对值之和为：\n$$\n\\sum_{i=1}^3 |\\nabla N_i \\cdot \\boldsymbol{\\beta}| = |-\\frac{800}{3}| + |250| + |\\frac{50}{3}| = \\frac{800}{3} + \\frac{750}{3} + \\frac{50}{3} = \\frac{1600}{3}\n$$\n平流速度的大小为 $\\|\\boldsymbol{\\beta}\\| = \\sqrt{10^2 + 0.5^2} = \\sqrt{100.25}$。\n现在我们可以写出方向导数绝对值的和：\n$$\n\\sum_{i=1}^3 |\\nabla N_i \\cdot \\boldsymbol{t}| = \\sum_{i=1}^3 \\left|\\nabla N_i \\cdot \\frac{\\boldsymbol{\\beta}}{\\|\\boldsymbol{\\beta}\\|}\\right| = \\frac{1}{\\|\\boldsymbol{\\beta}\\|} \\sum_{i=1}^3 |\\nabla N_i \\cdot \\boldsymbol{\\beta}| = \\frac{1600/3}{\\sqrt{100.25}}\n$$\n将此代入 $h_{\\boldsymbol{t}}$ 的公式中：\n$$\nh_{\\boldsymbol{t}} = \\frac{2}{\\frac{1600/3}{\\sqrt{100.25}}} = \\frac{6 \\sqrt{100.25}}{1600} = \\frac{3 \\sqrt{100.25}}{800}\n$$\n对此表达式进行数值计算，我们得到：\n$$\nh_{\\boldsymbol{t}} \\approx \\frac{3 \\times 10.0124922}{800} \\approx 0.03754684575\n$$\n四舍五入至六位有效数字，得到 $h_{\\boldsymbol{t}} = 0.0375468$。\n\n(b) SUPG 稳定化参数 $\\tau$ 的推导与计算。\n\n对于长度为 $h$ 的线性单元上的一维常系数平流-扩散方程，最优的 SUPG 稳定化参数由下式给出：\n$$\n\\tau_{\\text{1D}} = \\frac{h}{2\\beta} \\left( \\coth(Pe_{\\text{1D}}) - \\frac{1}{Pe_{\\text{1D}}} \\right)\n$$\n其中一维 Péclet 数为 $Pe_{\\text{1D}} = \\frac{\\beta h}{2\\epsilon}$。\n\n为了推导多维情况下的表达式，我们通过将一维量统一替换为其多维对应量来推广此公式。单元长度 $h$ 被沿流线的方向单元长度 $h_{\\boldsymbol{t}}$ 所取代。标量速度 $\\beta$ 被其大小 $\\|\\boldsymbol{\\beta}\\|$ 所取代。这就得到了稳定化参数 $\\tau$ 的表达式为：\n$$\n\\tau = \\frac{h_{\\boldsymbol{t}}}{2\\|\\boldsymbol{\\beta}\\|} \\left( \\coth(Pe) - \\frac{1}{Pe} \\right)\n$$\n其中单元 Péclet 数现在定义为：\n$$\nPe = \\frac{\\|\\boldsymbol{\\beta}\\| h_{\\boldsymbol{t}}}{2\\epsilon}\n$$\n这就完成了所要求的推导。现在我们根据给定数据进行计算。首先，我们计算单元 Péclet 数 $Pe$：\n$$\nPe = \\frac{\\|\\boldsymbol{\\beta}\\| h_{\\boldsymbol{t}}}{2\\epsilon} = \\frac{\\sqrt{100.25}}{2 \\times 10^{-4}} \\left( \\frac{3 \\sqrt{100.25}}{800} \\right) = \\frac{3 (100.25)}{1600 \\times 10^{-4}} = \\frac{300.75}{0.16} = 1879.6875\n$$\nPéclet 数的值非常大，表明这是一个强平流主导的状态。对于大的自变量 $x$，双曲余切函数 $\\coth(x)$ 迅速趋近于 $1$。对于 $Pe = 1879.6875$，$\\coth(Pe)$ 的值在计算上与 $1$ 无法区分。因此，我们可以使用高 Péclet 数的渐近形式。\n将 $h_{\\boldsymbol{t}}$ 和 $Pe$ 的表达式代入 $\\tau$ 的公式中：\n$$\n\\tau = \\frac{1}{2\\|\\boldsymbol{\\beta}\\|} \\left(\\frac{3 \\|\\boldsymbol{\\beta}\\|}{800}\\right) \\left( \\coth(Pe) - \\frac{1}{Pe} \\right) = \\frac{3}{1600} \\left( \\coth(Pe) - \\frac{1}{Pe} \\right)\n$$\n使用 $Pe$ 的值和近似 $\\coth(Pe) \\approx 1$：\n$$\n\\tau \\approx \\frac{3}{1600} \\left( 1 - \\frac{1}{1879.6875} \\right)\n$$\n$$\n\\tau \\approx 0.001875 \\left( 1 - 0.0005320053... \\right) \\approx 0.001875 \\times 0.99946799... \\approx 0.00187400249\n$$\n四舍五入至六位有效数字，得到 $\\tau = 0.00187400$。", "answer": "$$\\boxed{(0.0375468, 0.00187400)}$$", "id": "2602150"}, {"introduction": "尽管 Petrov-Galerkin 公式在形式上可能显得抽象，但它与迎风格式等更直观的数值概念有着深刻的联系。通过巧妙地选择稳定参数，可以证明 SUPG 方法在特定情况下等价于一些我们熟知的有限差分格式。本练习 [@problem_id:2602080] 将揭示 SUPG 有限元法与经典一阶迎风差分法之间的这种联系，通过推导一维纯对流问题中的离散矩阵，您将亲眼见证 SUPG 方法如何通过特定的 $\\tau$ 选择精确地演变为迎风格式，从而深刻理解其“迎风”稳定化的本质。", "problem": "考虑一维空间中的稳态线性平流方程，\n$$\na\\,\\frac{d u}{d x} = f(x) \\quad \\text{在 } [0,L] \\text{ 上},\n$$\n其平流速度 $a>0$ 为常数。设 $u(x)$ 在一个均匀网格上用连续分段线性有限元函数来近似，该网格的节点为 $x_i=i\\,h$，其中 $h=L/N$ 且 $i=0,1,\\dots,N$。使用与节点关联的标准连续基函数 $\\{\\varphi_i\\}$。采用流线迎风/Petrov-Galerkin (SUPG) 方法，其中与节点 $i$ 关联的检验函数被修改为\n$$\n\\widetilde{w}_i \\equiv \\varphi_i + \\tau\\,a\\,\\frac{d \\varphi_i}{d x},\n$$\n稳定化参数为\n$$\n\\tau = \\frac{h}{2a}.\n$$\n从平流的标准Galerkin弱形式出发（不对平流项进行分部积分），一致地加入SUPG扰动，并推导对刚度矩阵的单元级贡献。将这些贡献进行组装，以获得离散残差方程中，对于一个内部节点 $i$（远离边界），乘以节点未知量 $\\{u_{i-1},u_i,u_{i+1}\\}$ 的三点格式系数。忽略来自 $f(x)$ 的载荷向量贡献；仅计算刚度（左侧）贡献。\n\n然后，将得到的SUPG格式与在相同均匀网格上针对 $a>0$ 的经典一阶迎风有限差分格式进行比较。\n\n请将您的最终答案表示为乘以 $\\{u_{i-1},u_i,u_{i+1}\\}$ 的系数的有序三元组，写成一个单行矩阵的形式。无需四舍五入，也无需单位。", "solution": "首先必须验证问题陈述的科学合理性、适定性和客观性。\n\n**步骤1：提取已知条件**\n-   控制方程：$a\\,\\frac{d u}{d x} = f(x)$，定义域为 $[0,L]$。\n-   平流速度：$a$ 为正常数，$a>0$。\n-   近似方法：在均匀网格上的连续分段线性有限元法。\n-   网格节点：$x_i=i\\,h$，其中 $h=L/N$，$i=0,1,\\dots,N$。\n-   基函数：标准线性帽函数，$\\{\\varphi_i\\}$。\n-   数值格式：流线迎风/Petrov-Galerkin (SUPG)。\n-   检验函数：$\\widetilde{w}_i = \\varphi_i + \\tau\\,a\\,\\frac{d \\varphi_i}{d x}$。\n-   稳定化参数：$\\tau = \\frac{h}{2a}$。\n-   任务：通过组装单元级刚度贡献，推导内部节点 $i$ 的三点格式系数，忽略载荷向量 $f(x)$。需要找到节点未知量 $\\{u_{i-1}, u_i, u_{i+1}\\}$ 的系数。\n\n**步骤2：使用提取的已知条件进行验证**\n对该问题进行严格验证。\n-   **科学依据**：该问题是偏微分方程数值分析中的一个标准、经典的练习，特别涉及用于平流主导问题的有限元方法。SUPG方法是一种成熟且基础的技术。\n-   **适定性**：问题被精确地指定。所有必要的组成部分——方程、离散化、基函数和检验函数，以及稳定化参数的具体形式——都已提供。目标明确且可实现。\n-   **客观性**：语言正式、技术性强，没有任何主观或模糊的术语。\n\n该问题不存在任何无效性缺陷。它是自洽的、科学正确的，并且表述清晰。\n\n**步骤3：结论与行动**\n该问题是**有效的**。将推导解答。\n\n**SUPG格式的推导**\n\n使用Petrov-Galerkin检验函数 $\\widetilde{w}_i$ 的平流方程的弱形式为：\n求解 $u_h \\in V_h$，使得对于每个基函数索引 $i$，\n$$\n\\int_0^L \\widetilde{w}_i \\left( a\\,\\frac{d u_h}{d x} - f(x) \\right) dx = 0\n$$\n其中 $u_h(x) = \\sum_{j=0}^{N} u_j \\varphi_j(x)$ 是有限元近似解。代入 $\\widetilde{w}_i$ 的表达式，我们得到：\n$$\n\\int_0^L \\left( \\varphi_i + \\tau\\,a\\,\\frac{d \\varphi_i}{d x} \\right) \\left( a\\,\\frac{d u_h}{d x} - f(x) \\right) dx = 0\n$$\n问题指明要忽略来自 $f(x)$ 的载荷向量贡献。对于第 $i$ 个方程，左侧（刚度）的贡献是：\n$$\n\\sum_{j=0}^{N} u_j \\left[ \\int_0^L a\\,\\varphi_i \\frac{d \\varphi_j}{d x} dx + \\int_0^L \\tau\\,a^2\\,\\frac{d \\varphi_i}{d x} \\frac{d \\varphi_j}{d x} dx \\right] = 0\n$$\n方括号中的项表示全局刚度矩阵的元素 $K_{ij}$。\n$$\nK_{ij} = \\underbrace{\\int_0^L a\\,\\varphi_i \\frac{d \\varphi_j}{d x} dx}_{K_G} + \\underbrace{\\int_0^L \\tau\\,a^2\\,\\frac{d \\varphi_i}{d x} \\frac{d \\varphi_j}{d x} dx}_{K_S}\n$$\n这些积分是逐单元计算的。考虑一个长度为 $h$ 的通用单元 $[x_k, x_{k+1}]$。我们使用一个局部坐标 $\\xi = (x-x_k)/h$，其中 $\\xi \\in [0,1]$。该单元上的线性基函数为：\n$$\nN_1(\\xi) = 1-\\xi \\quad \\text{（与节点 } k \\text{ 关联）}\n$$\n$$\nN_2(\\xi) = \\xi \\quad \\text{（与节点 } k+1 \\text{ 关联）}\n$$\n它们关于 $x$ 的导数为：\n$$\n\\frac{d N_1}{d x} = \\frac{d N_1}{d \\xi} \\frac{d \\xi}{d x} = -1 \\cdot \\frac{1}{h} = -\\frac{1}{h}\n$$\n$$\n\\frac{d N_2}{d x} = \\frac{d N_2}{d \\xi} \\frac{d \\xi}{d x} = 1 \\cdot \\frac{1}{h} = \\frac{1}{h}\n$$\n$2 \\times 2$ 的单元刚度矩阵 $K^e$ 的元素为 $K^e_{mn}$，其中 $m,n \\in \\{1,2\\}$。\n\n首先，我们计算标准Galerkin贡献，$K_G^e$：\n$$\nK_{G,mn}^e = \\int_{x_k}^{x_{k+1}} a\\,N_m \\frac{d N_n}{d x} dx = \\int_0^1 a\\,N_m(\\xi) \\frac{d N_n}{d x} h\\,d\\xi\n$$\n$$\nK_{G,11}^e = a \\int_0^1 (1-\\xi) \\left(-\\frac{1}{h}\\right) h\\,d\\xi = -a \\left[\\xi - \\frac{\\xi^2}{2}\\right]_0^1 = -\\frac{a}{2}\n$$\n$$\nK_{G,12}^e = a \\int_0^1 (1-\\xi) \\left(\\frac{1}{h}\\right) h\\,d\\xi = a \\left[\\xi - \\frac{\\xi^2}{2}\\right]_0^1 = \\frac{a}{2}\n$$\n$$\nK_{G,21}^e = a \\int_0^1 \\xi \\left(-\\frac{1}{h}\\right) h\\,d\\xi = -a \\left[\\frac{\\xi^2}{2}\\right]_0^1 = -\\frac{a}{2}\n$$\n$$\nK_{G,22}^e = a \\int_0^1 \\xi \\left(\\frac{1}{h}\\right) h\\,d\\xi = a \\left[\\frac{\\xi^2}{2}\\right]_0^1 = \\frac{a}{2}\n$$\n因此，Galerkin单元矩阵为：\n$$\nK_G^e = \\frac{a}{2} \\begin{pmatrix} -1 & 1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n接下来，我们计算SUPG稳定化贡献，$K_S^e$：\n$$\nK_{S,mn}^e = \\int_{x_k}^{x_{k+1}} \\tau\\,a^2\\,\\frac{d N_m}{d x} \\frac{d N_n}{d x} dx = \\int_0^1 \\tau\\,a^2\\,\\frac{d N_m}{d x} \\frac{d N_n}{d x} h\\,d\\xi\n$$\n由于导数在单元上是常数，导数乘积的矩阵是 $\\frac{1}{h^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$。\n$$\nK_S^e = \\tau a^2 h \\frac{1}{h^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\frac{\\tau a^2}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n现在，代入给定的稳定化参数 $\\tau = \\frac{h}{2a}$：\n$$\nK_S^e = \\frac{(h/2a) a^2}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\frac{a}{2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n总的单元刚度矩阵 $K^e$ 是 $K_G^e + K_S^e$ 的和：\n$$\nK^e = \\frac{a}{2} \\begin{pmatrix} -1 & 1 \\\\ -1 & 1 \\end{pmatrix} + \\frac{a}{2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\frac{a}{2} \\begin{pmatrix} 0 & 0 \\\\ -2 & 2 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ -a & a \\end{pmatrix}\n$$\n为了找到内部节点 $i$ 的格式，我们组装来自两个相邻单元的贡献：单元 $e_{i-1} = [x_{i-1}, x_i]$ 和单元 $e_i = [x_i, x_{i+1}]$。节点 $i$ 的离散方程是 $\\sum_j K_{ij} u_j = F_i$。我们寻求系数 $K_{i,i-1}$，$K_{i,i}$ 和 $K_{i,i+1}$。\n\n-   **来自单元 $e_{i-1} = [x_{i-1}, x_i]$ 的贡献**：\n    局部节点 $1,2$ 对应于全局节点 $i-1, i$。我们关心的是全局矩阵的第 $i$ 行，这对应于 $K^e$ 的第二行（$m=2$）。\n    -   $u_{i-1}$ 的系数（全局列 $i-1$，局部列 $n=1$）是 $K_{21}^e = -a$。\n    -   $u_i$ 的系数（全局列 $i$，局部列 $n=2$）是 $K_{22}^e = a$。\n\n-   **来自单元 $e_i = [x_i, x_{i+1}]$ 的贡献**：\n    局部节点 $1,2$ 对应于全局节点 $i, i+1$。我们关心的是全局矩阵的第 $i$ 行，这对应于 $K^e$ 的第一行（$m=1$）。\n    -   $u_i$ 的系数（全局列 $i$，局部列 $n=1$）是 $K_{11}^e = 0$。\n    -   $u_{i+1}$ 的系数（全局列 $i+1$，局部列 $n=2$）是 $K_{12}^e = 0$。\n\n对第 $i$ 行的贡献求和：\n-   $u_{i-1}$ 的系数：$K_{i,i-1} = -a$。\n-   $u_i$ 的系数：$K_{i,i} = a + 0 = a$。\n-   $u_{i+1}$ 的系数：$K_{i,i+1} = 0$。\n\n因此，对于 $\\{u_{i-1}, u_i, u_{i+1}\\}$ 的系数格式为 $(-a, a, 0)$。节点 $i$ 处的离散方程为 $-a u_{i-1} + a u_i = (\\text{右端项})_i$。\n\n与一阶迎风有限差分法的比较是有启发性的。对于 $a>0$，$a \\frac{du}{dx} = f$ 的迎风格式为 $a\\frac{u_i - u_{i-1}}{h} = f_i$。算子 $a(u_i - u_{i-1})/h$ 由系数 $(-a/h, a/h, 0)$ 产生。我们推导出的SUPG系数 $(-a, a, 0)$ 产生一个成比例的算子。当源项 $f$ 为常数时，这两种方法变得相同，因为集中质量有限元右端向量得到 $F_i = f \\cdot h$，从而有 $a(u_i - u_{i-1}) = f \\cdot h$，这等价于有限差分格式。该问题要求的是刚度矩阵的系数，这已按要求推导出来。\n\n因此，乘以 $\\{u_{i-1},u_i,u_{i+1}\\}$ 的有序三元组系数为 $(-a, a, 0)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-a & a & 0\n\\end{pmatrix}\n}\n$$", "id": "2602080"}]}