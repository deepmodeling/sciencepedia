{"hands_on_practices": [{"introduction": "为了在稳定性分析方面打下坚实的基础，我们从一个经典的基准问题——两杆桁架——开始。本练习将指导您运用基本的能量准则，即总势能 $ \\Pi $ 的二阶变分 $ \\delta^2 \\Pi $，来精确定位失稳的临界点 [@problem_id:2584357]。通过分析这个离散系统，您将具体地理解分岔屈曲是如何从第一性原理中产生的，从而将几何变化、外加荷载与结构刚度的丧失联系起来。", "problem": "一个位于竖直平面内的铰接两杆桁架由两根相同的直杆组成，其初始长度为 $L_0$，材料为线性弹性体，杨氏模量为 $E$，横截面积为 $A$。底部节点固定在坐标 $(-a,0)$ 和 $(a,0)$ 处，顶点节点初始位于 $(0,h)$。一个竖向恒载 $P$ 向下作用于顶点节点。杆件仅承受轴向力，并发生有限位移但小轴向应变；第 $i$ 根杆的应变能由 $U_i = \\dfrac{E A}{2 L_0} \\left(\\Delta L_i\\right)^2$ 给出，其中 $\\Delta L_i$ 是杆长的精确变化量。设顶点节点发生位移 $(u,-w)$，其中 $u$ 是水平位移（向右为正），$w$ 是向下的竖向位移（向下为正）。\n\n从总势能的定义出发\n$$\n\\Pi(u,w) = \\sum_{i=1}^{2} \\frac{E A}{2 L_0} \\left(L_i(u,w) - L_0\\right)^2 \\;-\\; P\\, w,\n$$\n其中 $L_i(u,w)$ 是当前的杆长，并仅强制保守系统的基本原理和精确的杆长运动学，完成以下任务：\n\n- 在 $u=0$ 的对称屈曲前平衡点，推导二次变分 $\\delta^2 \\Pi$，用微小的独立变分 $\\delta u$ 和 $\\delta w$ 表示。用在 $u=0$ 处计算的 $a$、$h$、$w$、$L_0=\\sqrt{a^2+h^2}$ 和 $L=\\sqrt{a^2+(h-w)^2}$ 来表达你的结果。\n\n- 利用在 $u=0$ 处由 $\\dfrac{\\partial \\Pi}{\\partial w}=0$ 得到的对称屈曲前平衡关系，重写二次型 $\\delta^2 \\Pi$，使得所有系数都用 $E$、$A$、$a$、$h$、$w$、$L_0$、$L$ 和施加的荷载 $P$ 表示。\n\n- 通过要求 $\\delta^2 \\Pi$ 中 $(\\delta u)^2$ 的系数为零，确定系统相对于横向扰动 $\\delta u$ 失去稳定性的条件，并将相应的荷载记为 $P_{\\mathrm{cr}}$。\n\n- 对于满足 $h = \\dfrac{\\sqrt{23}}{2}\\, a$ 的特定几何形状，通过使用对称平衡和几何关系消除屈曲前位移，以闭合形式确定 $P_{\\mathrm{cr}}$。以牛顿为单位表示最终荷载。提供一个精确的解析表达式，不要四舍五入。", "solution": "该问题要求对承受竖向恒载的两杆桁架进行稳定性分析。我们将通过考察总势能的二次变分来找到临界屈曲荷载。\n\n首先，我们定义几何形状。顶点节点初始位于 $(0,h)$，移动到 $(u, h-w)$。固定的底部节点位于 $(-a,0)$ 和 $(a,0)$。在变形构型中，两根杆（记为左侧的杆1和右侧的杆2）的长度由距离公式给出：\n$$ L_1(u,w) = \\sqrt{(u+a)^2 + (h-w)^2} $$\n$$ L_2(u,w) = \\sqrt{(u-a)^2 + (h-w)^2} $$\n每根相同杆的初始长度为 $L_0 = \\sqrt{a^2 + h^2}$。系统的总势能 $\\Pi(u,w)$ 给出如下：\n$$ \\Pi(u,w) = \\frac{E A}{2 L_0} \\left[ (L_1(u,w) - L_0)^2 + (L_2(u,w) - L_0)^2 \\right] - P w $$\n其中 $E$ 是杨氏模量，$A$ 是横截面积，$P$ 是施加的竖向荷载。\n\n平衡位置的稳定性由总势能的二次变分 $\\delta^2 \\Pi$ 决定。如果对于所有容许变分 $(\\delta u, \\delta w)$，$\\delta^2 \\Pi$ 都是正定的，则平衡状态 $(u,w)$ 是稳定的。当 $\\delta^2 \\Pi$ 不再是正定时，发生分岔或失稳。根据问题的约定，我们将 $\\delta^2 \\Pi$ 定义为以下二次型：\n$$ \\delta^2 \\Pi = \\frac{\\partial^2 \\Pi}{\\partial u^2} (\\delta u)^2 + 2 \\frac{\\partial^2 \\Pi}{\\partial u \\partial w} \\delta u \\delta w + \\frac{\\partial^2 \\Pi}{\\partial w^2} (\\delta w)^2 $$\n我们在以 $u=0$ 为特征的对称屈曲前平衡点计算该二次型的系数。\n\n首先，我们计算 $\\Pi$ 所需的偏导数。一阶导数为：\n$$ \\frac{\\partial \\Pi}{\\partial u} = \\frac{E A}{L_0} \\left[ (L_1 - L_0) \\frac{u+a}{L_1} + (L_2 - L_0) \\frac{u-a}{L_2} \\right] $$\n$$ \\frac{\\partial \\Pi}{\\partial w} = \\frac{E A}{L_0} \\left[ (L_1 - L_0) \\frac{-(h-w)}{L_1} + (L_2 - L_0) \\frac{-(h-w)}{L_2} \\right] - P $$\n在对称构型 $u=0$ 处，杆长相等：$L_1 = L_2 = L = \\sqrt{a^2+(h-w)^2}$。在此状态下，$\\frac{\\partial \\Pi}{\\partial u} = 0$，这证实了 $u=0$ 是一条平衡路径。沿此路径的平衡由 $\\frac{\\partial \\Pi}{\\partial w}|_{u=0} = 0$ 控制，从而得到屈曲前平衡关系：\n$$ P = -2 \\frac{E A}{L_0} (L - L_0) \\frac{h-w}{L} $$\n\n接下来，我们计算二阶偏导数并在 $u=0$ 处求值。混合偏导数为：\n$$ \\frac{\\partial^2 \\Pi}{\\partial u \\partial w} = -EA(h-w) \\left[ \\frac{u+a}{L_1^3} + \\frac{u-a}{L_2^3} \\right] $$\n在 $u=0$ 处求值，此式变为 $\\left. \\frac{\\partial^2 \\Pi}{\\partial u \\partial w} \\right|_{u=0} = -EA(h-w) \\left[ \\frac{a}{L^3} - \\frac{a}{L^3} \\right] = 0$。\n非混合二阶偏导数为：\n$$ \\frac{\\partial^2 \\Pi}{\\partial u^2} = \\frac{E A}{L_0} \\left[ \\frac{(u+a)^2}{L_1^2} + (L_1-L_0)\\frac{(h-w)^2}{L_1^3} + \\frac{(u-a)^2}{L_2^2} + (L_2-L_0)\\frac{(h-w)^2}{L_2^3} \\right] $$\n$$ \\frac{\\partial^2 \\Pi}{\\partial w^2} = \\frac{E A}{L_0} \\left[ \\frac{(h-w)^2}{L_1^2} + (L_1-L_0)\\frac{(u+a)^2}{L_1^3} + \\frac{(h-w)^2}{L_2^2} + (L_2-L_0)\\frac{(u-a)^2}{L_2^3} \\right] $$\n在 $u=0$ 处（其中 $L_1=L_2=L$）求值：\n$$ H_{uu} = \\left. \\frac{\\partial^2 \\Pi}{\\partial u^2} \\right|_{u=0} = \\frac{E A}{L_0} \\left[ 2\\frac{a^2}{L^2} + 2(L-L_0)\\frac{(h-w)^2}{L^3} \\right] = 2\\frac{E A}{L_0} \\left[ \\frac{a^2}{L^2} + (L-L_0)\\frac{(h-w)^2}{L^3} \\right] $$\n$$ H_{ww} = \\left. \\frac{\\partial^2 \\Pi}{\\partial w^2} \\right|_{u=0} = \\frac{E A}{L_0} \\left[ 2\\frac{(h-w)^2}{L^2} + 2(L-L_0)\\frac{a^2}{L^3} \\right] = 2\\frac{E A}{L_0} \\left[ \\frac{(h-w)^2}{L^2} + (L-L_0)\\frac{a^2}{L^3} \\right] $$\n因此，在对称屈曲前状态下，二次变分的二次型是对角的：\n$$ \\delta^2 \\Pi = H_{uu} (\\delta u)^2 + H_{ww} (\\delta w)^2 $$\n这完成了第一个任务，即将系数用 $a, h, w, L_0, L$ 表示。\n\n对于第二个任务，我们使用屈曲前平衡关系 $P = -2 \\frac{E A}{L_0} (L - L_0) \\frac{h-w}{L}$，它可以重新整理为 $2\\frac{EA}{L_0}(L-L_0) = -P\\frac{L}{h-w}$。将此代入系数 $H_{uu}$ 和 $H_{ww}$：\n$$ H_{uu} = 2\\frac{E A}{L_0} \\frac{a^2}{L^2} + \\left(-P\\frac{L}{h-w}\\right) \\frac{(h-w)^2}{L^3} = 2\\frac{E A}{L_0} \\frac{a^2}{L^2} - P\\frac{h-w}{L^2} $$\n$$ H_{ww} = 2\\frac{E A}{L_0} \\frac{(h-w)^2}{L^2} + \\left(-P\\frac{L}{h-w}\\right) \\frac{a^2}{L^3} = 2\\frac{E A}{L_0} \\frac{(h-w)^2}{L^2} - P\\frac{a^2}{L^2(h-w)} $$\n这就将系数用荷载 $P$ 和其他几何量表示。\n\n第三个任务是确定失稳条件。当抵抗横向扰动 $\\delta u$ 的刚度消失时，发生横向（非对称）屈曲。这对应于条件 $H_{uu}=0$。发生这种情况时的荷载是临界荷载 $P_{\\mathrm{cr}}$。\n$$ H_{uu} = 2\\frac{E A}{L_0} \\frac{a^2}{L^2} - P_{\\mathrm{cr}}\\frac{h-w}{L^2} = 0 $$\n求解 $P_{\\mathrm{cr}}$ 得到屈曲条件：\n$$ P_{\\mathrm{cr}} = \\frac{2 E A a^2}{L_0 (h-w)} $$\n\n对于最后一个任务，我们确定特定几何形状 $h = \\frac{\\sqrt{23}}{2} a$ 的 $P_{\\mathrm{cr}}$。我们必须通过同时使用平衡方程和屈曲条件来求解屈曲时的状态 $(w, P_{\\mathrm{cr}})$。令 $P_{\\mathrm{cr}}$ 的两个表达式相等：\n$$ \\frac{2 E A a^2}{L_0 (h-w)} = -2 \\frac{E A}{L_0} (L - L_0) \\frac{h-w}{L} $$\n假设 $E, A, L_0 \\neq 0$ 且 $h-w \\neq 0$，我们简化得：\n$$ a^2 = -(L-L_0) \\frac{(h-w)^2}{L} \\implies a^2 L = (L_0-L)(h-w)^2 $$\n$$ L(a^2 + (h-w)^2) = L_0 (h-w)^2 $$\n令 $y=h-w$ 为顶点当前的高度。由于 $L^2 = a^2+y^2$，这可简化为一个非常紧凑的形式：\n$$ L^3 = L_0 y^2 $$\n代入 $L=\\sqrt{a^2+y^2}$ 和 $L_0=\\sqrt{a^2+h^2}$ 的定义：\n$$ (a^2+y^2)^{3/2} = \\sqrt{a^2+h^2} \\, y^2 $$\n两边平方并令 $Y=y^2$：\n$$ (a^2+Y)^3 = (a^2+h^2) Y^2 $$\n展开三次项：\n$$ a^6 + 3a^4 Y + 3a^2 Y^2 + Y^3 = a^2 Y^2 + h^2 Y^2 $$\n重新整理成关于 $Y$ 的多项式：\n$$ Y^3 + (2a^2 - h^2)Y^2 + 3a^4 Y + a^6 = 0 $$\n现在，我们使用给定的几何关系 $h = \\frac{\\sqrt{23}}{2} a$，所以 $h^2 = \\frac{23}{4} a^2$。\n$$ Y^3 + (2a^2 - \\frac{23}{4}a^2)Y^2 + 3a^4 Y + a^6 = 0 $$\n$$ Y^3 - \\frac{15}{4}a^2 Y^2 + 3a^4 Y + a^6 = 0 $$\n这是一个关于 $Y$ 和 $a^2$ 的齐次多项式。我们寻求 $Y=Ca^2$ 形式的解。代入该形式可得到关于常数 $C$ 的三次方程：\n$$ C^3 a^6 - \\frac{15}{4} C^2 a^6 + 3C a^6 + a^6 = 0 \\implies 4C^3 - 15C^2 + 12C + 4 = 0 $$\n通过观察，可知 $C=2$ 是一个根：$4(2)^3 - 15(2)^2 + 12(2) + 4 = 32 - 60 + 24 + 4 = 0$。\n该多项式可以分解为 $(C-2)(4C^2 - 7C - 2) = 0$。二次因子产生的根为 $C = \\frac{7 \\pm \\sqrt{49+32}}{8} = \\frac{7 \\pm 9}{8}$，所以 $C=2$（一个二重根）和 $C = -1/4$。\n由于 $Y=y^2$ 必须为正，所以 $C$ 必须为正。唯一有物理意义的解是 $C=2$。\n因此，在屈曲时，$Y_{\\mathrm{cr}} = y_{\\mathrm{cr}}^2 = 2a^2$，这意味着顶点的高度为 $y_{\\mathrm{cr}} = h-w_{\\mathrm{cr}} = \\sqrt{2}a$。\n\n最后，我们使用推导出的公式计算 $P_{\\mathrm{cr}}$：\n$$ P_{\\mathrm{cr}} = \\frac{2 E A a^2}{L_0 y_{\\mathrm{cr}}} $$\n我们需要给定几何形状的 $L_0$：$L_0^2 = a^2 + h^2 = a^2 + \\frac{23}{4}a^2 = \\frac{27}{4}a^2$，所以 $L_0 = \\frac{3\\sqrt{3}}{2}a$。\n代入 $L_0$ 和 $y_{\\mathrm{cr}}$ 的值：\n$$ P_{\\mathrm{cr}} = \\frac{2 E A a^2}{\\left(\\frac{3\\sqrt{3}}{2}a\\right) (\\sqrt{2}a)} = \\frac{2 E A a^2}{\\frac{3\\sqrt{6}}{2}a^2} = \\frac{4 E A}{3\\sqrt{6}} $$\n对分母进行有理化，得到临界荷载的最终解析表达式：\n$$ P_{\\mathrm{cr}} = \\frac{4 E A}{3\\sqrt{6}} \\cdot \\frac{\\sqrt{6}}{\\sqrt{6}} = \\frac{4\\sqrt{6} E A}{18} = \\frac{2\\sqrt{6}}{9} E A $$\n该表达式具有力的单位。在国际单位制（SI）中，假设 $E$ 和 $A$ 以相容的国际单位（$Pa$，$m^2$）给出，其单位将是牛顿。", "answer": "$$\\boxed{\\frac{2\\sqrt{6}}{9} E A}$$", "id": "2584357"}, {"introduction": "计算屈曲分析的核心在于准确捕捉预应力如何影响结构刚度。本练习将带您从理论走向实践，要求您推导一个简单桁架单元的几何刚度矩阵 $ \\mathbf{K}_g $ [@problem_id:2584381]。该矩阵是量化应力刚化或软化效应的关键组成部分，从虚功原理出发推导它，将揭示其物理来源及其在线性屈曲特征值问题中的核心作用。", "problem": "一个直的、铰接的二维桁架单元连接节点 $1$ 和 $2$，其未变形长度为 $L$，方向角 $\\theta$ 是从全局 $X$ 轴测量的。设全局节点位移向量的顺序为 $\\{d\\} = [u_{X1},\\,u_{Y1},\\,u_{X2},\\,u_{Y2}]^{\\mathsf{T}}$。该单元承受一个沿单元恒定的、均匀的、预先存在的轴向力 $N$。采用符号约定，$N$ 在受拉时为正；在受压状态下，$N<0$。 \n\n使用虚功原理的全拉格朗日形式和细长杆的 Green–Lagrange 轴向应变，推导在直的、预应力构型下的增量平衡的、全局坐标系中的一致初始应力（几何）刚度矩阵。假设横向位移沿单元轴线线性插值，并在 Green–Lagrange 应变中保留将轴向力 $N$ 与横向位移梯度耦合的二次项。用 $c=\\cos\\theta$ 和 $s=\\sin\\theta$ 表示方向余弦，并设以全局分量表示的局部横向单位法向量（垂直于单元轴线）为 $\\mathbf{n}=[-s,\\;c]^{\\mathsf{T}}$。\n\n将您的最终答案表示为一个单一的闭合形式的 $4\\times 4$ 矩阵 $\\mathbf{K}_{g}^{(g)}(N,L,c,s)$，它乘以全局节点位移向量 $\\{d\\}$，并用 $N$、$L$、$c$ 和 $s$ 表示。明确展示 $\\mathbf{K}_{g}^{(g)}$ 如何随 $N$ 和 $L$ 缩放。不需要进行数值计算；请提供符号表达式。不需要四舍五入。最终矩阵中不应包含单位。", "solution": "该问题要求推导二维桁架单元的几何刚度矩阵。此推导在全拉格朗日框架内进行，从虚功原理出发，并采用专用于细长杆单元的 Green-Lagrange 应变度量。\n\n初始应力对切线刚度矩阵的贡献，即所谓的几何或初始应力刚度矩阵 $\\mathbf{K}_g$，源于初始轴向力 $N$ 在单元变形过程中所做的功。虚功原理增量形式中的相关项是：\n$$ \\delta W_g = \\int_{V_0} S_0 \\, \\delta E_{NL} \\, dV_0 $$\n其中 $S_0$ 是参考构型中的初始第二 Piola-Kirchhoff 应力，$E_{NL}$ 是 Green-Lagrange 应变张量的非线性部分。对于一个具有恒定预定轴向力 $N$ 和初始横截面积 $A_0$ 的桁架单元，初始应力是均匀的，$S_0 = N/A_0$。对初始体积 $V_0$ 的积分简化为对单元初始长度 $L$ 的积分：\n$$ \\delta W_g = \\int_{0}^{L} (A_0 S_0) \\, \\delta E_{NL} \\, dx = \\int_{0}^{L} N \\, \\delta E_{NL} \\, dx $$\n杆单元的 Green-Lagrange 轴向应变为：\n$$ E = \\frac{\\partial u}{\\partial x} + \\frac{1}{2} \\left[ \\left(\\frac{\\partial u}{\\partial x}\\right)^2 + \\left(\\frac{\\partial v}{\\partial x}\\right)^2 \\right] $$\n其中 $u(x)$ 和 $v(x)$ 分别是单元局部坐标系中的轴向和横向位移。问题指定保留将轴向力与横向位移梯度耦合的二次项。这意味着我们考虑的非线性应变项为：\n$$ E_{NL} = \\frac{1}{2} \\left(\\frac{dv}{dx}\\right)^2 $$\n此项的变分为 $\\delta E_{NL} = \\frac{dv}{dx} \\delta\\left(\\frac{dv}{dx}\\right)$。将此代入 $\\delta W_g$ 的表达式中，得到：\n$$ \\delta W_g = \\int_{0}^{L} N \\left(\\frac{dv}{dx}\\right) \\delta\\left(\\frac{dv}{dx}\\right) dx $$\n问题陈述假设横向位移 $v(x)$ 基于局部节点的横向位移 $u_{y1}$ 和 $u_{y2}$ 进行线性插值：\n$$ v(x) = \\left(1 - \\frac{x}{L}\\right) u_{y1} + \\left(\\frac{x}{L}\\right) u_{y2} $$\n因此，代表单元旋转的横向位移梯度沿长度是恒定的：\n$$ \\frac{dv}{dx} = \\frac{1}{L} (u_{y2} - u_{y1}) $$\n该梯度的变分为：\n$$ \\delta\\left(\\frac{dv}{dx}\\right) = \\frac{1}{L} (\\delta u_{y2} - \\delta u_{y1}) $$\n将梯度及其变分的这些表达式代入 $\\delta W_g$ 的积分中：\n$$ \\delta W_g = \\int_{0}^{L} N \\left[ \\frac{1}{L} (u_{y2} - u_{y1}) \\right] \\left[ \\frac{1}{L} (\\delta u_{y2} - \\delta u_{y1}) \\right] dx $$\n由于被积函数相对于 $x$ 是常数，积分很简单：\n$$ \\delta W_g = \\frac{N}{L^2} (u_{y2} - u_{y1}) (\\delta u_{y2} - \\delta u_{y1}) \\int_{0}^{L} dx = \\frac{N}{L} (u_{y2} - u_{y1}) (\\delta u_{y2} - \\delta u_{y1}) $$\n该表达式可以写成矩阵形式 $\\delta W_g = \\{\\delta d'\\}^{\\mathsf{T}} \\mathbf{K}_g^{(l)} \\{d'\\}$，其中 $\\{d'\\} = [u_{x1}, u_{y1}, u_{x2}, u_{y2}]^{\\mathsf{T}}$ 是局部节点位移向量。展开表达式得到：\n$$ \\delta W_g = \\frac{N}{L} (\\delta u_{y1} u_{y1} - \\delta u_{y1} u_{y2} - \\delta u_{y2} u_{y1} + \\delta u_{y2} u_{y2}) $$\n从这个二次型中，可识别出局部几何刚度矩阵 $\\mathbf{K}_g^{(l)}$ 为：\n$$ \\mathbf{K}_g^{(l)} = \\frac{N}{L} \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & -1 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & -1 & 0 & 1 \\end{pmatrix} $$\n为了获得全局坐标系中的几何刚度矩阵 $\\mathbf{K}_g^{(g)}$，我们使用旋转矩阵 $\\mathbf{T}$ 进行合同变换：\n$$ \\mathbf{K}_g^{(g)} = \\mathbf{T}^{\\mathsf{T}} \\mathbf{K}_g^{(l)} \\mathbf{T} $$\n旋转矩阵 $\\mathbf{T}$ 将全局位移 $\\{d\\}$ 转换为局部位移 $\\{d'\\}$，并使用方向余弦 $c = \\cos\\theta$ 和 $s = \\sin\\theta$ 构造：\n$$ \\mathbf{T} = \\begin{pmatrix} c & s & 0 & 0 \\\\ -s & c & 0 & 0 \\\\ 0 & 0 & c & s \\\\ 0 & 0 & -s & c \\end{pmatrix} $$\n其转置矩阵为：\n$$ \\mathbf{T}^{\\mathsf{T}} = \\begin{pmatrix} c & -s & 0 & 0 \\\\ s & c & 0 & 0 \\\\ 0 & 0 & c & -s \\\\ 0 & 0 & s & c \\end{pmatrix} $$\n执行矩阵乘法 $\\mathbf{K}_g^{(g)} = \\mathbf{T}^{\\mathsf{T}} \\left( \\frac{N}{L} \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & -1 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & -1 & 0 & 1 \\end{pmatrix} \\right) \\mathbf{T}$：\n$$ \\mathbf{K}_g^{(g)} = \\frac{N}{L} \\mathbf{T}^{\\mathsf{T}} \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ -s & c & s & -c \\\\ 0 & 0 & 0 & 0 \\\\ s & -c & -s & c \\end{pmatrix} $$\n$$ \\mathbf{K}_g^{(g)} = \\frac{N}{L} \\begin{pmatrix} c & -s & 0 & 0 \\\\ s & c & 0 & 0 \\\\ 0 & 0 & c & -s \\\\ 0 & 0 & s & c \\end{pmatrix} \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ -s & c & s & -c \\\\ 0 & 0 & 0 & 0 \\\\ s & -c & -s & c \\end{pmatrix} $$\n该乘法运算得到最终矩阵。各元素的计算如下：\n第一行：$[s^2, -sc, -s^2, sc]$\n第二行：$[-sc, c^2, sc, -c^2]$\n第三行：$[-s^2, sc, s^2, -sc]$\n第四行：$[sc, -c^2, -sc, c^2]$\n最终得到的全局几何刚度矩阵是：\n$$ \\mathbf{K}_g^{(g)} = \\frac{N}{L} \\begin{pmatrix} s^2 & -sc & -s^2 & sc \\\\ -sc & c^2 & sc & -c^2 \\\\ -s^2 & sc & s^2 & -sc \\\\ sc & -c^2 & -sc & c^2 \\end{pmatrix} $$\n该矩阵清楚地显示了它与轴向力 $N$ 成正比，与长度 $L$ 成反比。它与 $N/L$ 成正比。这就是二维桁架单元的一致几何刚度矩阵。", "answer": "$$\n\\boxed{\\frac{N}{L} \\begin{pmatrix} s^{2} & -sc & -s^{2} & sc \\\\ -sc & c^{2} & sc & -c^{2} \\\\ -s^{2} & sc & s^{2} & -sc \\\\ sc & -c^{2} & -sc & c^{2} \\end{pmatrix}}\n$$", "id": "2584381"}, {"introduction": "成功预测屈曲载荷只是问题的一半；理解结构的后屈曲响应通常更为关键。本练习采用一个最小的单自由度模型来揭示“突弹”(snap-through)和“回弹”(snap-back)等复杂的后屈曲现象 [@problem_id:2584348]。通过实现一个基本的荷载控制求解算法，您将直接遭遇其在平衡路径上遇到极限点时的局限性，这为我们学习和应用高级路径跟踪算法提供了强有力的动机，而这些高级算法对于稳健的非线性分析至关重要。", "problem": "构建一个在载荷-位移响应中表现出回弹现象的最小离散模型，并用它来揭示有限元法中载荷控制的算法挑战。从总势能驻值原理出发，考虑一个总势能为如下形式的后屈曲结构响应的单自由度代理模型：\n$$\\Pi(u;P) = U(u) - P\\,u,$$\n其中 $u$ 是广义位移 (单位：米)，$P$ 是施加的标量载荷 (单位：牛顿)，储存能量函数 (应变能函数) 为：\n$$U(u) = \\tfrac{1}{2}k\\,u^{2} - \\tfrac{1}{4}\\alpha\\,u^{4} + \\tfrac{1}{6}\\beta\\,u^{6}.$$\n此处，$k$ (单位 $\\mathrm{N/m}$)、$\\alpha$ (单位 $\\mathrm{N/m^{3}}$) 和 $\\beta$ (单位 $\\mathrm{N/m^{5}}$) 是正常数。这个拟设 (ansatz) 可以解释为捕捉了导致软化和随后再刚化的几何非线性的最小离散单元的能量。\n\n任务：\n- 从驻值条件 $d\\Pi/du=0$ 出发，推导残差形式的标量平衡方程 $r(u;P)=0$ 及其进行牛顿型迭代所需的切线 (雅可比)。请清楚解释在此离散设定中，内力和切线刚度是什么。\n- 展示平衡路径上的转折点 (极限点) 是如何从载荷-位移曲线的驻值条件产生的。推导一个表征转折点的代数条件，并确定作为参数 $k$、$\\alpha$ 和 $\\beta$ 的函数，可以出现多少个实的正转折点。\n- 仅使用载荷控制 (即给定 $P$ 求解 $u$)，设计一个增量-迭代的牛顿-拉夫逊过程，以追踪从 $P=0$ 到指定目标 $P_{\\max}^{\\mathrm{tar}}$ 的平衡路径。假设载荷步数 $N_{\\mathrm{steps}}$ 固定，残差的收敛容差为 $\\varepsilon$，每步的最大牛顿迭代次数为 $N_{\\mathrm{it}}^{\\max}$。如果某一步未能收敛，则终止程序并报告成功收敛的步数。\n- 结合推导出的切线，识别并解释当路径接近并试图通过一个转折点 (回弹) 时，载荷控制所面临的算法挑战。\n\n测试组：\n考虑以下参数的 3 个案例 (全部采用国际单位制，即力单位为牛顿，位移单位为米)：\n- 案例 1：$k=1000$, $\\alpha=10$, $\\beta=1$, $P_{\\max}^{\\mathrm{tar}}=500$, $N_{\\mathrm{steps}}=50$。\n- 案例 2：$k=100$, $\\alpha=60$, $\\beta=5$, $P_{\\max}^{\\mathrm{tar}}=60$, $N_{\\mathrm{steps}}=50$。\n- 案例 3：$k=22.5$, $\\alpha=10$, $\\beta=2$, $P_{\\max}^{\\mathrm{tar}}=16$, $N_{\\mathrm{steps}}=40$。\n\n对每个案例：\n- 确定平衡路径上正转折点的数量。将重根转折点计为 1 个。\n- 计算转折点处的最大载荷 (如有)，定义为正转折点中 $P(u)$ 的最大值。如果没有转折点，则报告该量为 $0$。该载荷以牛顿为单位表示，并四舍五入到小数点后三位。\n- 执行前述的载荷控制牛顿-拉夫逊过程，残差容差为 $\\varepsilon = 10^{-10}$，每步迭代上限为 $N_{\\mathrm{it}}^{\\max} = 50$，从 $P=0$ 时的 $u=0$ 开始，报告在失败前成功收敛的载荷步数 (如果未发生失败，则为 $N_{\\mathrm{steps}}$)。\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含一个扁平的、逗号分隔的列表，并用方括号括起来。该列表必须按顺序为每个案例连接三元组 $[\\text{count}, \\text{P\\_max\\_turn}, \\text{steps\\_converged}]$，其中 $\\text{count}$ 是一个整数，$\\text{P\\_max\\_turn}$ 是一个小数点后保留三位的浮点数 (单位牛顿)，$\\text{steps\\_converged}$ 是一个整数。因此，对于按顺序排列的三个案例，最终的单行输出必须包含 $9$ 个值，排列为 $[\\text{c1},\\text{p1},\\text{s1},\\text{c2},\\text{p2},\\text{s2},\\text{c3},\\text{p3},\\text{s3}]$，无任何附加文本。", "solution": "问题陈述经验证是连贯的、有科学依据且适定的。分析将从总势能驻值基本原理出发，推导指定离散系统的平衡行为和算法响应。\n\n系统的总势能由下式给出\n$$\\Pi(u;P) = U(u) - P\\,u,$$\n其中应变能 $U(u)$ 为\n$$U(u) = \\tfrac{1}{2}k\\,u^{2} - \\tfrac{1}{4}\\alpha\\,u^{4} + \\tfrac{1}{6}\\beta\\,u^{6}.$$\n此处，$u$ 是广义位移，$P$ 是施加的载荷，$k, \\alpha, \\beta$ 是正的材料和几何参数。\n\n**平衡方程与切线刚度**\n\n平衡条件是总势能相对于广义坐标 $u$ 为驻值。这表示为 $\\Pi$ 的一阶导数为零：\n$$\\frac{d\\Pi}{du} = \\frac{dU}{du} - P = 0.$$\n计算应变能 $U(u)$ 的导数，得到系统的内力，记为 $P_{\\mathrm{int}}(u)$：\n$$P_{\\mathrm{int}}(u) = \\frac{dU}{du} = k\\,u - \\alpha\\,u^{3} + \\beta\\,u^{5}.$$\n在平衡状态下，内力必须与外载荷 $P$ 平衡。这导出了平衡路径方程 $P(u)$：\n$$P(u) = k\\,u - \\alpha\\,u^{3} + \\beta\\,u^{5}.$$\n对于像牛顿-拉夫逊法这样的数值求解方案，标准的做法是将平衡条件表述为残差形式 $r(u;P) = 0$。残差表示在给定状态 $(u,P)$ 下的力不平衡：\n$$r(u;P) = P_{\\mathrm{int}}(u) - P = k\\,u - \\alpha\\,u^{3} + \\beta\\,u^{5} - P.$$\n牛顿-拉夫逊法需要对残差函数进行线性化，这涉及到其对未知位移 $u$ 的导数。这个导数就是切线刚度 $K_T(u)$，在这个单自由度案例中，它是雅可比矩阵的标量等效形式：\n$$K_T(u) = \\frac{dr}{du} = \\frac{dP_{\\mathrm{int}}(u)}{du} = \\frac{d^2U}{du^2}.$$\n计算这个导数可以得到切线刚度的表达式：\n$$K_T(u) = k - 3\\alpha\\,u^{2} + 5\\beta\\,u^{4}.$$\n\n**转折点分析**\n\n载荷-位移平衡路径上的转折点 (极限点) 是载荷 $P(u)$ 相对于位移 $u$ 达到局部极值的位置。在数学上，这对应于载荷对位移的导数为零的条件：\n$$\\frac{dP}{du} = 0.$$\n从上面的推导可以看出，这个条件与切线刚度为零 $K_T(u) = 0$ 是相同的。因此，发生转折点时的位移是以下方程的根：\n$$5\\beta\\,u^{4} - 3\\alpha\\,u^{2} + k = 0.$$\n这是一个双二次方程。令 $x = u^2$。由于我们关心的是实数位移 $u$，因此需要 $x$ 的实数正解。该方程转换为关于 $x$ 的二次方程：\n$$5\\beta\\,x^{2} - 3\\alpha\\,x + k = 0.$$\n$x$ 的解由二次公式给出：\n$$x = \\frac{3\\alpha \\pm \\sqrt{(3\\alpha)^2 - 4(5\\beta)(k)}}{2(5\\beta)} = \\frac{3\\alpha \\pm \\sqrt{9\\alpha^2 - 20k\\beta}}{10\\beta}.$$\n$u$ 的实数解的性质和数量取决于判别式 $\\Delta = 9\\alpha^2 - 20k\\beta$。\n\n1.  若 $\\Delta < 0$ (即 $9\\alpha^2 < 20k\\beta$)：$x$ 没有实数解，因此平衡路径上没有转折点。载荷-位移曲线是单调的。\n2.  若 $\\Delta = 0$ (即 $9\\alpha^2 = 20k\\beta$)：$x$ 有一个实数解 $x = \\frac{3\\alpha}{10\\beta}$。由于 $k, \\alpha, \\beta$ 均为正数，所以 $x$ 是正的。这产生一对对称解 $u = \\pm\\sqrt{x}$，对应一个正的转折点。\n3.  若 $\\Delta > 0$ (即 $9\\alpha^2 > 20k\\beta$)：$x$ 有两个不同的实数解。由于 $\\sqrt{9\\alpha^2 - 20k\\beta} < \\sqrt{9\\alpha^2} = 3\\alpha$，两个分子 $3\\alpha \\pm \\sqrt{\\Delta}$ 都是正的。又因为 $\\beta > 0$，所以两个解 $x_1$ 和 $x_2$ 都是正的。每个正的 $x$ 都给出一对 $u$ 的实数解，从而导致两个不同的正转折点。\n\n**载荷控制的牛顿-拉夫逊过程**\n\n该任务要求使用载荷控制增量-迭代策略追踪平衡路径。总目标载荷 $P_{\\max}^{\\mathrm{tar}}$ 被分成 $N_{\\mathrm{steps}}$ 个相等的增量, $\\Delta P = P_{\\max}^{\\mathrm{tar}} / N_{\\mathrm{steps}}$。该过程从已知的平衡状态 $(u,P) = (0,0)$ 开始。\n\n对每个载荷步 $i = 1, \\dots, N_{\\mathrm{steps}}$：\n1.  目标载荷设为 $P_i = i \\cdot \\Delta P$。\n2.  启动牛顿-拉夫逊迭代以找到满足 $r(u_i; P_i) = 0$ 的相应平衡位移 $u_i$。\n3.  第 $i$ 步位移的初始猜测值为上一步的收敛解，$u_i^{(0)} = u_{i-1}$ (其中 $u_0 = 0$ )。\n4.  对于迭代 $j=0, 1, 2, \\dots$，迭代更新过程如下：\n    $$u_i^{(j+1)} = u_i^{(j)} - \\left[K_T(u_i^{(j)})\\right]^{-1} r(u_i^{(j)}; P_i).$$\n5.  持续迭代，直到残差的范数低于容差 $|r(u_i^{(j)}; P_i)| < \\varepsilon$，或达到最大迭代次数 $N_{\\mathrm{it}}^{\\max}$。\n6.  如果在 $N_{\\mathrm{it}}^{\\max}$ 次迭代内未达到收敛，则程序终止并报告失败。\n\n**载荷控制的算法挑战**\n\n载荷控制方法很简单，但在处理涉及转折点 (如突跳或回弹) 的非线性响应时，存在根本性的局限。\n\n1.  **极限点处的奇异性：** 当平衡状态 $(u, P(u))$ 接近转折点时，切线刚度 $K_T(u)$ 趋近于零。牛顿-拉夫逊修正量 $\\Delta u = -r/K_T$ 会变得无界。这导致了大的、非物理的位移更新，使得迭代过程超调解、振荡并最终发散。该算法在极限点或其附近无法收敛。\n\n2.  **无法穿越转折点：** 根据定义，载荷控制规定了单调递增的载荷水平序列。然而，要追踪超过最大载荷点 (突跳) 或最小载荷点 (回弹) 的平衡路径，载荷参数必须减小。载荷控制方案在算法上无法跟踪这样的路径段。当一个载荷增量试图将系统推到一个在当前路径分支上不存在稳定平衡的载荷水平时 (即载荷大于局部最大值)，求解器将无法找到解。\n\n3.  **解的多重性：** 对于介于最大和最小转折点载荷值之间的载荷，存在多个平衡位移 $u$。标准的牛顿-拉夫逊方法使用前一个解作为初始猜测，通常会收敛到最近的连续路径段上的解。它没有机制跳转到其他可能稳定的平衡构型。这本身不是在极限点失败的主要原因，但它突显了载荷控制无法探索的解空间的复杂性。\n\n这些挑战表明了为什么载荷控制不足以分析复杂的后屈曲行为。需要更稳健的路径跟踪算法，例如弧长法 (如 Riks 或 Crisfield 方法)。这些方法将载荷和位移都作为变量处理，在载荷-位移空间中增加一个关于增量步“长度”的约束方程，从而能够成功地通过极限点。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for the three specified test cases.\n    For each case, it determines the number of turning points, the maximum load\n    at these points, and the number of successfully converged steps in a\n    load-controlled simulation.\n    \"\"\"\n\n    test_cases = [\n        # k, alpha, beta, P_max_tar, N_steps\n        (1000.0, 10.0, 1.0, 500.0, 50),\n        (100.0, 60.0, 5.0, 60.0, 50),\n        (22.5, 10.0, 2.0, 16.0, 40),\n    ]\n\n    # Algorithm parameters from problem statement\n    epsilon = 1e-10\n    n_it_max = 50\n\n    results = []\n    for case in test_cases:\n        k, alpha, beta, p_max_tar, n_steps = case\n        \n        # Task 1: Analyze turning points\n        count, p_max_turn = analyze_turning_points(k, alpha, beta)\n        \n        # Task 2: Run load-controlled Newton-Raphson simulation\n        steps_converged = run_load_control(k, alpha, beta, p_max_tar, n_steps, epsilon, n_it_max)\n        \n        results.append(count)\n        results.append(f\"{p_max_turn:.3f}\")\n        results.append(steps_converged)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef analyze_turning_points(k, alpha, beta):\n    \"\"\"\n    Determines the number of positive turning points and the maximum load at those points.\n    \n    A turning point occurs where the tangent stiffness K_T = 5*beta*u^4 - 3*alpha*u^2 + k is zero.\n    This is a quadratic equation in u^2.\n    \"\"\"\n    discriminant = (3 * alpha)**2 - 4 * (5 * beta) * k\n\n    if discriminant  0:\n        return 0, 0.0\n\n    # The problem specifies k, alpha, beta > 0.\n    # The term sqrt(9*alpha^2 - 20*k*beta) is always less than 3*alpha.\n    # Thus, if real solutions for u^2 exist, they must be positive.\n    \n    if discriminant == 0:\n        # One repeated positive root for u^2\n        u_sq = (3 * alpha) / (10 * beta)\n        u_tp = np.sqrt(u_sq)\n        p_tp = u_tp * (k - alpha * u_tp**2 + beta * u_tp**4)\n        return 1, p_tp\n    else: # discriminant > 0\n        # Two distinct positive roots for u^2\n        sqrt_disc = np.sqrt(discriminant)\n        u_sq1 = (3 * alpha - sqrt_disc) / (10 * beta)\n        u_sq2 = (3 * alpha + sqrt_disc) / (10 * beta)\n\n        u_tp1 = np.sqrt(u_sq1)\n        u_tp2 = np.sqrt(u_sq2)\n\n        p_tp1 = u_tp1 * (k - alpha * u_tp1**2 + beta * u_tp1**4)\n        p_tp2 = u_tp2 * (k - alpha * u_tp2**2 + beta * u_tp2**4)\n        \n        return 2, max(p_tp1, p_tp2)\n\ndef run_load_control(k, alpha, beta, p_max_tar, n_steps, tol, max_it):\n    \"\"\"\n    Performs an incremental-iterative analysis using load control and Newton-Raphson.\n    Returns the number of successfully converged load steps.\n    \"\"\"\n    delta_p = p_max_tar / n_steps\n    u_converged = 0.0  # Converged displacement from the previous step\n\n    for i in range(1, n_steps + 1):\n        p_target = i * delta_p\n        u_k = u_converged  # Initial guess for the current step (predictor)\n        \n        step_converged = False\n        for _ in range(max_it):\n            # Calculate residual force\n            residual = k * u_k - alpha * u_k**3 + beta * u_k**5 - p_target\n            \n            # Check for convergence\n            if abs(residual)  tol:\n                u_converged = u_k\n                step_converged = True\n                break\n            \n            # Calculate tangent stiffness\n            tangent = k - 3 * alpha * u_k**2 + 5 * beta * u_k**4\n            \n            # Check for singularity (a symptom of approaching a limit point)\n            if abs(tangent)  1e-12:\n                # Singular tangent, iteration will fail. Break early.\n                break\n            \n            # Calculate displacement correction and update\n            delta_u = -residual / tangent\n            u_k += delta_u\n        \n        if not step_converged:\n            # Current step i failed to converge. Return number of last successful step.\n            return i - 1\n            \n    # All steps converged\n    return n_steps\n\nsolve()\n```", "id": "2584348"}]}