{"hands_on_practices": [{"introduction": "我们首先通过一个基础的运动学练习来建立使用共转动方法的动机。标准的线性应变张量是基于无穷小位移和转角的假设构建的，当物体经历有限的刚体转动时，会发生什么？本练习将通过解析方式揭示一个悖论：一个纯粹的刚体转动在使用线性应变定义时会产生非物理的“伪应变”，然后展示一个简单的共转动思想——即在计算应变前先“撤销”转动——如何完美地解决了这个问题 [@problem_id:2550529]。", "problem": "考虑一个单位正方形在平面内的二维（2D）刚体旋转。设未变形（物质）坐标为 $\\mathbf{X} = (X, Y)^{\\mathsf{T}}$，变形后（空间）坐标为 $\\mathbf{x} = (x, y)^{\\mathsf{T}}$。该运动是绕原点进行的纯旋转，旋转角度为 $\\theta = 30^{\\circ}$，因此 $\\mathbf{x} = \\mathbf{R}(\\theta)\\,\\mathbf{X}$，其中\n$$\n\\mathbf{R}(\\theta) \\;=\\;\n\\begin{pmatrix}\n\\cos\\theta & -\\sin\\theta \\\\\n\\sin\\theta & \\phantom{-}\\cos\\theta\n\\end{pmatrix}.\n$$\n仅使用连续介质力学和有限元法（FEM）的基本运动学定义，按以下步骤进行：\n- 从位移场 $\\mathbf{u}(\\mathbf{X}) = \\mathbf{x} - \\mathbf{X}$、位移梯度 $\\nabla_{\\!\\mathbf{X}}\\mathbf{u}$ 和小（线性化）应变张量 $\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}\\!\\left(\\nabla_{\\!\\mathbf{X}}\\mathbf{u} + \\nabla_{\\!\\mathbf{X}}\\mathbf{u}^{\\mathsf{T}}\\right)$ 出发，计算此运动的全局线性应变张量。从该张量中，构建工程应变分量 $\\varepsilon_{xx}$、$\\varepsilon_{yy}$ 和 $\\gamma_{xy}$，其中 $\\gamma_{xy} = 2\\,\\varepsilon_{xy}$。证明对于此刚体旋转，工程应变不为零。\n- 接下来，通过局部坐标系更新来移除刚体旋转，定义一个适用于中等旋转的同旋应变度量。具体来说，使用从运动中提取的旋转 $\\mathbf{R}(\\theta)$，通过 $\\tilde{\\mathbf{x}} = \\mathbf{R}(\\theta)^{\\mathsf{T}} \\mathbf{x}$ 定义同旋构型，并定义相应的同旋位移 $\\tilde{\\mathbf{u}} = \\tilde{\\mathbf{x}} - \\mathbf{X}$。计算由 $\\tilde{\\mathbf{u}}$ 构建的小应变张量，并证明对于此刚体旋转，该张量恒等于零。\n\n为了评分，请以单个闭式表达式的形式，报告在 $\\theta = 30^{\\circ}$ 时计算的全局线性法向应变分量 $\\varepsilon_{xx}$ 的标量值。应变是无量纲的；报告数值时无需单位。请勿近似计算；提供精确表达式（不要四舍五入）。", "solution": "所述问题是基础连续介质力学中的一个有效练习，旨在展示线性化应变张量在处理有限旋转时的不足之处，以及同旋公式的效用。该问题提法适定且科学上合理。我们将继续进行推导。\n\n首先，我们使用全局（或物质）参考坐标系来分析该运动。位移场 $\\mathbf{u}$ 定义为空间坐标 $\\mathbf{x}$ 和物质坐标 $\\mathbf{X}$ 之间的差值。\n$$\n\\mathbf{u}(\\mathbf{X}) = \\mathbf{x} - \\mathbf{X}\n$$\n根据给定的刚体旋转，我们有 $\\mathbf{x} = \\mathbf{R}(\\theta)\\mathbf{X}$。将其代入位移定义中可得：\n$$\n\\mathbf{u}(\\mathbf{X}) = \\mathbf{R}(\\theta)\\mathbf{X} - \\mathbf{X} = (\\mathbf{R}(\\theta) - \\mathbf{I})\\mathbf{X}\n$$\n其中 $\\mathbf{I}$ 是 $2 \\times 2$ 单位矩阵。位移场是物质坐标 $\\mathbf{X}$ 的线性函数。\n\n下一步是计算位移梯度，即矢量场 $\\mathbf{u}$ 相对于物质坐标 $\\mathbf{X}$ 的梯度，记为 $\\nabla_{\\mathbf{X}}\\mathbf{u}$。\n$$\n\\nabla_{\\mathbf{X}}\\mathbf{u} = \\frac{\\partial \\mathbf{u}}{\\partial \\mathbf{X}} = \\frac{\\partial}{\\partial \\mathbf{X}} \\left( (\\mathbf{R}(\\theta) - \\mathbf{I})\\mathbf{X} \\right)\n$$\n由于矩阵 $(\\mathbf{R}(\\theta) - \\mathbf{I})$ 相对于 $\\mathbf{X}$ 是常数，其梯度就是该矩阵本身。\n$$\n\\nabla_{\\mathbf{X}}\\mathbf{u} = \\mathbf{R}(\\theta) - \\mathbf{I} = \\begin{pmatrix} \\cos\\theta - 1 & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta - 1 \\end{pmatrix}\n$$\n现在，我们根据其定义来计算小（或线性化）应变张量 $\\boldsymbol{\\varepsilon}$：\n$$\n\\boldsymbol{\\varepsilon} = \\frac{1}{2}\\left(\\nabla_{\\mathbf{X}}\\mathbf{u} + (\\nabla_{\\mathbf{X}}\\mathbf{u})^{\\mathsf{T}}\\right)\n$$\n代入位移梯度及其转置的表达式：\n$$\n(\\nabla_{\\mathbf{X}}\\mathbf{u})^{\\mathsf{T}} = \\begin{pmatrix} \\cos\\theta - 1 & \\sin\\theta \\\\ -\\sin\\theta & \\cos\\theta - 1 \\end{pmatrix}\n$$\n因此，应变张量为：\n$$\n\\boldsymbol{\\varepsilon} = \\frac{1}{2}\\left( \\begin{pmatrix} \\cos\\theta - 1 & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta - 1 \\end{pmatrix} + \\begin{pmatrix} \\cos\\theta - 1 & \\sin\\theta \\\\ -\\sin\\theta & \\cos\\theta - 1 \\end{pmatrix} \\right)\n$$\n$$\n\\boldsymbol{\\varepsilon} = \\frac{1}{2} \\begin{pmatrix} 2(\\cos\\theta - 1) & 0 \\\\ 0 & 2(\\cos\\theta - 1) \\end{pmatrix} = \\begin{pmatrix} \\cos\\theta - 1 & 0 \\\\ 0 & \\cos\\theta - 1 \\end{pmatrix}\n$$\n工程应变张量的分量为 $\\varepsilon_{xx}$、$\\varepsilon_{yy}$ 和 $\\gamma_{xy}$。从矩阵 $\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_{xx} & \\varepsilon_{xy} \\\\ \\varepsilon_{yx} & \\varepsilon_{yy} \\end{pmatrix}$ 中，我们确定：\n$$\n\\varepsilon_{xx} = \\cos\\theta - 1\n$$\n$$\n\\varepsilon_{yy} = \\cos\\theta - 1\n$$\n$$\n\\varepsilon_{xy} = 0 \\quad \\implies \\quad \\gamma_{xy} = 2\\varepsilon_{xy} = 0\n$$\n对于任何满足 $\\cos\\theta \\neq 1$ 的旋转角 $\\theta$（即 $\\theta$ 不是 $2\\pi$ 弧度或 $360^{\\circ}$ 的整数倍），法向应变分量 $\\varepsilon_{xx}$ 和 $\\varepsilon_{yy}$ 均不为零。这是一个非物理的假象，因为刚体旋转应引起零应变。这表明线性化应变张量不足以描述有限旋转。\n\n接下来，我们遵循同旋方法。通过从变形构型 $\\mathbf{x}$ 中移除刚体旋转来定义同旋构型 $\\tilde{\\mathbf{x}}$。\n$$\n\\tilde{\\mathbf{x}} = \\mathbf{R}(\\theta)^{\\mathsf{T}} \\mathbf{x}\n$$\n代入运动学关系 $\\mathbf{x} = \\mathbf{R}(\\theta)\\mathbf{X}$：\n$$\n\\tilde{\\mathbf{x}} = \\mathbf{R}(\\theta)^{\\mathsf{T}} (\\mathbf{R}(\\theta)\\mathbf{X}) = (\\mathbf{R}(\\theta)^{\\mathsf{T}}\\mathbf{R}(\\theta))\\mathbf{X}\n$$\n由于 $\\mathbf{R}(\\theta)$ 是一个正交矩阵，其转置即为其逆矩阵，因此 $\\mathbf{R}(\\theta)^{\\mathsf{T}}\\mathbf{R}(\\theta) = \\mathbf{I}$。这将同旋构型简化为：\n$$\n\\tilde{\\mathbf{x}} = \\mathbf{I}\\mathbf{X} = \\mathbf{X}\n$$\n同旋位移场 $\\tilde{\\mathbf{u}}$ 定义为同旋构型与物质构型之差：\n$$\n\\tilde{\\mathbf{u}} = \\tilde{\\mathbf{x}} - \\mathbf{X} = \\mathbf{X} - \\mathbf{X} = \\mathbf{0}\n$$\n同旋位移恒为零矢量。因此，由此位移场计算出的小应变张量（我们称之为 $\\tilde{\\boldsymbol{\\varepsilon}}$）也恒等于零。\n$$\n\\nabla_{\\mathbf{X}}\\tilde{\\mathbf{u}} = \\nabla_{\\mathbf{X}}(\\mathbf{0}) = \\mathbf{0}\n$$\n$$\n\\tilde{\\boldsymbol{\\varepsilon}} = \\frac{1}{2}\\left(\\nabla_{\\mathbf{X}}\\tilde{\\mathbf{u}} + (\\nabla_{\\mathbf{X}}\\tilde{\\mathbf{u}})^{\\mathsf{T}}\\right) = \\frac{1}{2}(\\mathbf{0} + \\mathbf{0}) = \\mathbf{0}\n$$\n这证明了在同旋坐标系中定义的应变度量对于纯刚体旋转能够正确地计算出零值，这才是物理上正确的结果。\n\n最后，我们需要报告在 $\\theta = 30^{\\circ}$ 时全局线性法向应变分量 $\\varepsilon_{xx}$ 的具体值。使用推导出的表达式：\n$$\n\\varepsilon_{xx} = \\cos\\theta - 1\n$$\n对于 $\\theta = 30^{\\circ}$，我们有 $\\cos(30^{\\circ}) = \\frac{\\sqrt{3}}{2}$。\n$$\n\\varepsilon_{xx} = \\frac{\\sqrt{3}}{2} - 1 = \\frac{\\sqrt{3} - 2}{2}\n$$\n这就是线性化应变理论预测出的伪法向应变的精确闭式表达式。", "answer": "$$\n\\boxed{\\frac{\\sqrt{3} - 2}{2}}\n$$", "id": "2550529"}, {"introduction": "理解了线性应变在大转动下的局限性后，我们来探讨一个更具体的情形：当有限元公式中的变形度量选择不当时，会产生什么后果。本练习将分析一个梁单元，其轴向变形的计算方式在运动学上是不一致的。你的任务是推导在纯刚体运动下，这个有缺陷的公式所产生的非物理残余力 [@problem_id:2550481]。通过这个过程，你将深刻理解保证单元客观性（frame-indifference）的重要性，并学会诊断诸如“锁定”等数值问题的根源。", "problem": "一个具有 $2$ 个节点的二维 Euler–Bernoulli 梁单元，其初始节点位置为 $\\mathbf{X}_{1} = (0,0)$ 和 $\\mathbf{X}_{2} = (L,0)$，轴向刚度为 $E A$，抗弯刚度为 $E I$。该单元采用共旋坐标系法实现：单元的局部坐标系由节点 $1$ 到节点 $2$ 的当前弦定义，内力在此局部坐标系中计算，然后旋转回全局坐标系。考虑一个施加于整个单元（作为一个单一刚体）的指定刚体运动，该运动包含一个平移 $\\mathbf{t} = (t_{x}, t_{y})$ 和一个绕面外轴的转角 $\\alpha$。该刚体运动将每个点映射为 $\\mathbf{x} = \\mathbf{R}(\\alpha) \\mathbf{X} + \\mathbf{t}$，其中 $\\mathbf{R}(\\alpha)$ 是标准的平面旋转矩阵，$\\alpha$ 以弧度为单位。节点横截面转角被指定为 $\\varphi_{1} = \\varphi_{2} = \\alpha$。\n\n在理想的共旋坐标系法实现中，纯刚体运动应产生零内力。然而，假设该实现在单元的共旋（当前弦）坐标系中使用了以下线性化轴向变形度量：\n$$\n\\delta_{\\text{lin}} \\equiv \\mathbf{t}_{c} \\cdot \\left[(\\mathbf{x}_{2} - \\mathbf{x}_{1}) - (\\mathbf{X}_{2} - \\mathbf{X}_{1})\\right],\n$$\n其中 $\\mathbf{t}_{c} = (\\cos\\theta, \\sin\\theta)$ 是当前弦的单位切向矢量，$\\theta$ 是由 $\\mathbf{x}_{2} - \\mathbf{x}_{1}$ 确定的弦方向（非线性化），然后轴向内力的大小通过以下线性关系计算\n$$\nN_{\\text{int}} = \\frac{E A}{L}\\,\\delta_{\\text{lin}}.\n$$\n弯曲和剪切贡献由共旋坐标系中的相对转角和横向挠度构成，对于此刚体运动，它们恒等于零。\n\n仅从这些定义和刚体运动学出发，推导该单元在指定刚体运动下返回的残余轴向内力大小 $N_{\\text{res}}(\\alpha)$ 的闭式解析表达式。请将您的最终答案表示为仅包含 $E$、$A$ 和 $\\alpha$ 的函数（最终表达式中不应出现对 $L$、$t_{x}$ 或 $t_{y}$ 的依赖）。角度 $\\alpha$ 必须以弧度为单位。请提供精确表达式，而非级数近似。您的最终答案必须是单个解析表达式。此外，请简要诊断出现的任何非零值的来源。\n\n如果您决定计算小角度展开以支持您的诊断，请说明其主导项，但所要求的最终答案必须是精确表达式。", "solution": "在尝试求解之前，对问题陈述进行验证。\n\n逐字提取已知条件：\n- 一个具有 $2$ 个节点的二维 Euler–Bernoulli 梁单元。\n- 初始节点位置 $\\mathbf{X}_{1} = (0,0)$ 和 $\\mathbf{X}_{2} = (L,0)$。\n- 轴向刚度 $E A$ 和抗弯刚度 $E I$。\n- 实现中采用共旋坐标系法。\n- 指定的刚体运动：$\\mathbf{x} = \\mathbf{R}(\\alpha) \\mathbf{X} + \\mathbf{t}$，包含平移 $\\mathbf{t} = (t_{x}, t_{y})$ 和转角 $\\alpha$。\n- 指定的节点横截面转角：$\\varphi_{1} = \\varphi_{2} = \\alpha$。\n- 线性化轴向变形度量：$\\delta_{\\text{lin}} \\equiv \\mathbf{t}_{c} \\cdot \\left[(\\mathbf{x}_{2} - \\mathbf{x}_{1}) - (\\mathbf{X}_{2} - \\mathbf{X}_{1})\\right]$。\n- 当前弦的切向矢量：$\\mathbf{t}_{c} = (\\cos\\theta, \\sin\\theta)$，其中 $\\theta$ 是当前弦 $\\mathbf{x}_{2} - \\mathbf{x}_{1}$ 的非线性方向。\n- 轴向内力关系：$N_{\\text{int}} = \\frac{E A}{L}\\,\\delta_{\\text{lin}}$。\n- 弯曲和剪切贡献为零。\n\n验证结论：\n该问题是适定的，在计算力学领域具有科学依据，并且是自洽的。它探讨了在非线性共旋坐标系法中使用运动学不一致的应变度量的后果，这是一个标准的研究课题。定义精确，并能导出一个唯一的解。不存在矛盾、歧义或事实性错误。因此，该问题被认定为**有效**。\n\n我们现在进行推导。目标是求出在指定刚体运动下的残余轴向力 $N_{\\text{res}}(\\alpha)$。\n\n首先，我们使用给定的刚体运动映射 $\\mathbf{x} = \\mathbf{R}(\\alpha) \\mathbf{X} + \\mathbf{t}$ 来确定节点的当前位置 $\\mathbf{x}_{1}$ 和 $\\mathbf{x}_{2}$。标准的二维旋转矩阵为 $\\mathbf{R}(\\alpha) = \\begin{pmatrix} \\cos\\alpha & -\\sin\\alpha \\\\ \\sin\\alpha & \\cos\\alpha \\end{pmatrix}$。\n\n初始节点位置为 $\\mathbf{X}_{1} = (0,0)^T$ 和 $\\mathbf{X}_{2} = (L,0)^T$。\n\n对于节点 $1$：\n$$\n\\mathbf{x}_{1} = \\mathbf{R}(\\alpha)\\mathbf{X}_{1} + \\mathbf{t} = \\begin{pmatrix} \\cos\\alpha & -\\sin\\alpha \\\\ \\sin\\alpha & \\cos\\alpha \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} t_x \\\\ t_y \\end{pmatrix} = \\begin{pmatrix} t_x \\\\ t_y \\end{pmatrix}\n$$\n\n对于节点 $2$：\n$$\n\\mathbf{x}_{2} = \\mathbf{R}(\\alpha)\\mathbf{X}_{2} + \\mathbf{t} = \\begin{pmatrix} \\cos\\alpha & -\\sin\\alpha \\\\ \\sin\\alpha & \\cos\\alpha \\end{pmatrix} \\begin{pmatrix} L \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} t_x \\\\ t_y \\end{pmatrix} = \\begin{pmatrix} L\\cos\\alpha \\\\ L\\sin\\alpha \\end{pmatrix} + \\begin{pmatrix} t_x \\\\ t_y \\end{pmatrix} = \\begin{pmatrix} L\\cos\\alpha + t_x \\\\ L\\sin\\alpha + t_y \\end{pmatrix}\n$$\n\n接下来，我们计算表示当前单元弦的矢量 $\\mathbf{x}_{2} - \\mathbf{x}_{1}$ 和初始单元弦的矢量 $\\mathbf{X}_{2} - \\mathbf{X}_{1}$。\n\n当前弦矢量：\n$$\n\\mathbf{x}_{2} - \\mathbf{x}_{1} = \\begin{pmatrix} L\\cos\\alpha + t_x \\\\ L\\sin\\alpha + t_y \\end{pmatrix} - \\begin{pmatrix} t_x \\\\ t_y \\end{pmatrix} = \\begin{pmatrix} L\\cos\\alpha \\\\ L\\sin\\alpha \\end{pmatrix}\n$$\n平移部分 $\\mathbf{t}$ 正确地抵消了，这对于差分矢量是符合预期的。当前弦的长度为 $||\\mathbf{x}_{2} - \\mathbf{x}_{1}|| = \\sqrt{(L\\cos\\alpha)^2 + (L\\sin\\alpha)^2} = \\sqrt{L^2(\\cos^2\\alpha + \\sin^2\\alpha)} = L$。这证实了单元的长度在刚体运动下保持不变。\n\n初始弦矢量：\n$$\n\\mathbf{X}_{2} - \\mathbf{X}_{1} = \\begin{pmatrix} L \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} L \\\\ 0 \\end{pmatrix}\n$$\n\n现在，我们确定当前弦的单位切向矢量 $\\mathbf{t}_{c}$。该矢量定义为 $\\mathbf{t}_c = (\\cos\\theta, \\sin\\theta)^T$，其中 $\\theta$ 是矢量 $\\mathbf{x}_{2} - \\mathbf{x}_{1}$ 与全局 $x$ 轴的夹角。从当前弦矢量 $(L\\cos\\alpha, L\\sin\\alpha)^T$ 的分量可以清楚地看出，其方向角为 $\\theta = \\alpha$。因此，\n$$\n\\mathbf{t}_{c} = \\begin{pmatrix} \\cos\\alpha \\\\ \\sin\\alpha \\end{pmatrix}\n$$\n\n我们现在可以使用其给定定义来计算线性化轴向变形 $\\delta_{\\text{lin}}$：\n$$\n\\delta_{\\text{lin}} = \\mathbf{t}_{c} \\cdot \\left[(\\mathbf{x}_{2} - \\mathbf{x}_{1}) - (\\mathbf{X}_{2} - \\mathbf{X}_{1})\\right]\n$$\n代入我们已经推导出的矢量：\n$$\n\\delta_{\\text{lin}} = \\begin{pmatrix} \\cos\\alpha \\\\ \\sin\\alpha \\end{pmatrix} \\cdot \\left[ \\begin{pmatrix} L\\cos\\alpha \\\\ L\\sin\\alpha \\end{pmatrix} - \\begin{pmatrix} L \\\\ 0 \\end{pmatrix} \\right] = \\begin{pmatrix} \\cos\\alpha \\\\ \\sin\\alpha \\end{pmatrix} \\cdot \\begin{pmatrix} L\\cos\\alpha - L \\\\ L\\sin\\alpha \\end{pmatrix}\n$$\n执行点积运算：\n$$\n\\delta_{\\text{lin}} = \\cos\\alpha(L\\cos\\alpha - L) + \\sin\\alpha(L\\sin\\alpha)\n$$\n$$\n\\delta_{\\text{lin}} = L\\cos^2\\alpha - L\\cos\\alpha + L\\sin^2\\alpha\n$$\n使用三角恒等式 $\\cos^2\\alpha + \\sin^2\\alpha = 1$：\n$$\n\\delta_{\\text{lin}} = L(\\cos^2\\alpha + \\sin^2\\alpha) - L\\cos\\alpha = L(1) - L\\cos\\alpha\n$$\n$$\n\\delta_{\\text{lin}} = L(1 - \\cos\\alpha)\n$$\n这个表达式就是计算出的轴向变形。注意，对于任何整数 $k$，只要转角 $\\alpha \\ne 2k\\pi$，该值就非零，而真实的长度变化为零。\n\n最后，我们使用给定的本构关系计算残余轴向内力的大小 $N_{\\text{res}}(\\alpha)$：\n$$\nN_{\\text{res}}(\\alpha) = \\frac{E A}{L}\\,\\delta_{\\text{lin}}\n$$\n代入推导出的 $\\delta_{\\text{lin}}$ 表达式：\n$$\nN_{\\text{res}}(\\alpha) = \\frac{E A}{L} \\left[ L(1 - \\cos\\alpha) \\right]\n$$\n长度 $L$ 被消去，得到残余力的最终表达式：\n$$\nN_{\\text{res}}(\\alpha) = EA(1 - \\cos\\alpha)\n$$\n此结果仅取决于 $E$、$A$ 和 $\\alpha$，符合问题陈述的要求。角度 $\\alpha$ 以弧度为单位，这是此类分析中三角函数参数的标准单位。\n\n残余力诊断：\n非零残余力是一个选择不当的变形度量所导致的人为结果。在连续介质力学中，一个基本要求是应变度量以及因此产生的内力，对于任何刚体运动都必须为零。这个原理被称为客观性或标架无关性。\n\n真实的轴向变形（伸长量）应正确地计算为长度的变化：$\\Delta L = ||\\mathbf{x}_2 - \\mathbf{x}_1|| - ||\\mathbf{X}_2 - \\mathbf{X}_1|| = L - L = 0$。这将产生零力。\n\n指定的度量 $\\delta_{\\text{lin}} = \\mathbf{t}_{c} \\cdot [(\\mathbf{x}_{2} - \\mathbf{x}_{1}) - (\\mathbf{X}_{2} - \\mathbf{X}_{1})]$ 并不是伸长量的度量。它代表了位移差分矢量 $(\\mathbf{u}_2 - \\mathbf{u}_1)$ 在*当前*单元切向 $\\mathbf{t}_c$ 上的投影。这对于大转动是运动学不一致的。它将刚体转动与轴向应变相混淆。\n\n为了分析小转动情况下的行为，我们可以对 $N_{\\text{res}}(\\alpha)$ 进行关于小 $\\alpha$ 的泰勒级数展开：\n$$\n\\cos\\alpha \\approx 1 - \\frac{\\alpha^2}{2} + \\mathcal{O}(\\alpha^4)\n$$\n$$\nN_{\\text{res}}(\\alpha) = EA\\left(1 - \\left(1 - \\frac{\\alpha^2}{2}\\right)\\right) + \\mathcal{O}(\\alpha^4) = EA\\frac{\\alpha^2}{2} + \\mathcal{O}(\\alpha^4)\n$$\n主导项是 $EA\\frac{\\alpha^2}{2}$。误差是转角的二阶项，这意味着对于无穷小转动，该伪力可以忽略不计，但对于有限转动则变得显著。这种现象是一种数值刚化，有时与“膜锁死”有关，即单元错误地抵抗纯转动。一个正确的共旋坐标系法必须使用对刚体运动不变的应变度量，例如真实的伸长量。", "answer": "$$\n\\boxed{EA(1 - \\cos\\alpha)}\n$$", "id": "2550481"}, {"introduction": "在理论上理解了共转动 formulation 的必要性与陷阱后，最后的关键一步是通过编程实践来验证一个正确的实现。在有限元分析中，“分片检验”（Patch Test）是验证单元性能的基本标准，尤其对于检验客观性至关重要。本练习要求你为一个二维三角形单元实现一个正确的共转动流程，其中刚体转动通过奇异值分解（SVD）精确提取 [@problem_id:2550488]。通过对一个单元片施加纯刚体运动，你将通过计算验证一个正确制定的单元其内力应为零（在机器精度范围内），从而将理论知识转化为可信的计算实践。", "problem": "您需要实现一个二维共转常应变三角形单元的检验单元测试，以验证在均匀刚体旋转和平移下，内力为零。该有限元检验单元由两个线性三角形单元组成的网格构成，形成一个凸四边形。其控制运动学和本构假设采用嵌入共转公式中的小应变线弹性理论，以处理中等旋转。您的任务是计算由指定的刚体运动引起的全局内力向量，并报告其在几个测试用例中的欧几里得范数。在精确提取单元刚体旋转的情况下，内力必须在机器精度范围内为零。\n\n基本原理：\n- 使用有限元法 (FEM) 处理厚度为 $t$ 的平面应力、各向同性、线弹性材料。\n- 小应变张量：$\\boldsymbol{\\varepsilon} = \\frac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}})$。\n- 平面应力下的胡克定律：$\\boldsymbol{\\sigma} = \\mathbf{D}\\,\\boldsymbol{\\varepsilon}$，其中\n$$\n\\mathbf{D} = \\frac{E}{1-\\nu^2}\n\\begin{bmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{bmatrix},\n$$\n其中 $E$ 是杨氏模量，$\\nu$ 是泊松比。\n- 对于一个节点参考位置为 $\\mathbf{X}_1=(X_1,Y_1)$、$\\mathbf{X}_2=(X_2,Y_2)$、$\\mathbf{X}_3=(X_3,Y_3)$ 的线性三角形单元，其常应变-位移矩阵 $\\mathbf{B}$ 由面积 $A$ 和几何形状构建：\n$$\nA = \\frac{1}{2}\\det\\begin{bmatrix}1 & X_1 & Y_1\\\\ 1 & X_2 & Y_2\\\\ 1 & X_3 & Y_3\\end{bmatrix},\\quad\nb_i = Y_{j}-Y_{k},\\quad c_i = X_{k}-X_{j},\\quad \\{i,j,k\\}=\\{1,2,3\\}\\ \\text{cyclic},\n$$\n$$\n\\mathbf{B} = \\frac{1}{2A}\n\\begin{bmatrix}\nb_1 & 0 & b_2 & 0 & b_3 & 0 \\\\\n0 & c_1 & 0 & c_2 & 0 & c_3 \\\\\nc_1 & b_1 & c_2 & b_2 & c_3 & b_3\n\\end{bmatrix}.\n$$\n- 单元刚度为 $\\mathbf{K}_e = t\\,A\\,\\mathbf{B}^{\\mathsf{T}}\\mathbf{D}\\mathbf{B}$。\n\n用于中等旋转的共转公式：\n- 对每个单元，提取一个最佳拟合刚体旋转 $\\mathbf{R}\\in\\mathrm{SO}(2)$，该旋转在最小二乘意义上将单元的参考节点位置映射到其当前位置。设 $\\mathbf{X}_i$ 表示节点 $i$ 的参考位置，$\\mathbf{x}_i$ 表示当前位置。定义形心\n$$\n\\bar{\\mathbf{X}} = \\frac{1}{3}\\sum_{i=1}^{3}\\mathbf{X}_i,\\quad \\bar{\\mathbf{x}} = \\frac{1}{3}\\sum_{i=1}^{3}\\mathbf{x}_i,\n$$\n及中心化坐标 $\\tilde{\\mathbf{X}}_i = \\mathbf{X}_i - \\bar{\\mathbf{X}}$、$\\tilde{\\mathbf{x}}_i = \\mathbf{x}_i - \\bar{\\mathbf{x}}$。构建协方差矩阵\n$$\n\\mathbf{H} = \\sum_{i=1}^{3} \\tilde{\\mathbf{x}}_i\\,\\tilde{\\mathbf{X}}_i^{\\mathsf{T}} \\in \\mathbb{R}^{2\\times 2}.\n$$\n计算奇异值分解 (SVD) $\\mathbf{H}=\\mathbf{U}\\mathbf{S}\\mathbf{V}^{\\mathsf{T}}$ 并设置 $\\mathbf{R}=\\mathbf{U}\\mathbf{V}^{\\mathsf{T}}$，通过在必要时翻转 $\\mathbf{U}$ 最后一列的符号来强制 $\\det(\\mathbf{R})=+1$。\n- 通过移除刚体运动来定义单元的共转节点位移向量：\n$$\n\\mathbf{u}^{\\text{corr}}_i = \\mathbf{R}^{\\mathsf{T}}\\left(\\mathbf{x}_i - \\bar{\\mathbf{x}}\\right) - \\left(\\mathbf{X}_i - \\bar{\\mathbf{X}}\\right),\\quad i=1,2,3,\n$$\n并组装 $\\mathbf{u}^{\\text{corr}}_e = [u^{\\text{corr}}_1, v^{\\text{corr}}_1, u^{\\text{corr}}_2, v^{\\text{corr}}_2, u^{\\text{corr}}_3, v^{\\text{corr}}_3]^{\\mathsf{T}}$。\n- 单元内力向量为 $\\mathbf{f}^{\\text{int}}_e = \\mathbf{K}_e\\,\\mathbf{u}^{\\text{corr}}_e$。将所有单元组装成全局内力向量 $\\mathbf{f}^{\\text{int}}$。\n\n检验单元描述：\n- 参考网格（坐标单位：米）：\n  - 节点：$\\mathbf{X}_0=(0.0,\\,0.0)$，$\\mathbf{X}_1=(1.0,\\,0.2)$，$\\mathbf{X}_2=(1.5,\\,1.1)$，$\\mathbf{X}_3=(0.1,\\,0.9)$。\n  - 三角形（节点索引）：$(0,\\,1,\\,2)$ 和 $(0,\\,2,\\,3)$。\n- 材料与厚度：\n  - 杨氏模量 $E = 2.10\\times 10^{11}\\ \\text{Pa}$，泊松比 $\\nu = 0.30$，厚度 $t = 1.0\\times 10^{-2}\\ \\text{m}$。\n- 指定的刚体运动（角度单位：弧度，平移单位：米）：\n  - 情况 A：$\\theta = 0.0$， $t_x = 0.0$， $t_y = 0.0$。\n  - 情况 B：$\\theta = 1.0\\times 10^{-8}$，$t_x = 0.3$，$t_y = -0.2$。\n  - 情况 C：$\\theta = 0.5$，$t_x = 1.2$，$t_y = -0.5$。\n  - 情况 D：$\\theta = 1.5707963267948966$，$t_x = -0.7$，$t_y = 0.4$。\n  - 情况 E：$\\theta = 3.0$，$t_x = 2.0$，$t_y = 2.0$。\n\n任务：\n- 对于每种情况，通过应用均匀刚体运动 $\\mathbf{x} = \\mathbf{R}(\\theta)\\,\\mathbf{X} + \\mathbf{t}$ 来构建当前位置，其中\n$$\n\\mathbf{R}(\\theta) = \\begin{bmatrix}\\cos\\theta & -\\sin\\theta\\\\ \\sin\\theta & \\cos\\theta\\end{bmatrix},\\quad \\mathbf{t} = \\begin{bmatrix}t_x\\\\ t_y\\end{bmatrix}.\n$$\n- 对每个单元使用上述共转程序，组装全局内力向量 $\\mathbf{f}^{\\text{int}}$ 并计算其欧几里得范数 $\\|\\mathbf{f}^{\\text{int}}\\|_2$。\n- 因为均匀刚体运动产生零应变，精确提取意味着 $\\mathbf{u}^{\\text{corr}}_e=\\mathbf{0}$，因此 $\\mathbf{f}^{\\text{int}}=\\mathbf{0}$ 在机器精度范围内成立。报告范数以验证这一点。\n\n单位与输出：\n- 长度使用米，刚度使用帕斯卡，力使用牛顿。\n- 角度必须以弧度为单位。\n- 对于每个测试用例，输出一个等于 $\\|\\mathbf{f}^{\\text{int}}\\|_2$ 的浮点数（单位为牛顿）。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，\"[rA,rB,rC,rD,rE]\"），列表中的每个条目按顺序对应于情况 A 到 E 的结果。\n\n测试套件（需在程序中硬编码）：\n- 情况 A：$(\\theta,t_x,t_y) = (0.0,\\,0.0,\\,0.0)$。\n- 情况 B：$(\\theta,t_x,t_y) = (1.0\\times 10^{-8},\\,0.3,\\,-0.2)$。\n- 情况 C：$(\\theta,t_x,t_y) = (0.5,\\,1.2,\\,-0.5)$。\n- 情况 D：$(\\theta,t_x,t_y) = (1.5707963267948966,\\,-0.7,\\,0.4)$。\n- 情况 E：$(\\theta,t_x,t_y) = (3.0,\\,2.0,\\,2.0)$。", "solution": "所提出的问题是一个验证性练习，通常称为检验单元测试（patch test），用于验证一种共转有限元公式。其目标是验证一个由二维线性三角形单元组成的检验单元在经受刚体运动时产生零内力。这是任何连续介质力学公式为确保客观性（即材料响应独立于观察者的参考系）而必须满足的一项基本要求。该问题是适定的、科学上合理的，并提供了进行数值实现所需的所有数据和方程。\n\n求解方法是通过对一个由两个常应变三角形（CST）单元组成的检验单元实施指定的共转有限元程序来展开。对于每个给定的刚体运动情况，该算法计算全局内力向量及其欧几里得范数。\n\n首先，我们定义材料和几何属性。材料是线弹性且各向同性的，由平面应力胡克定律 $\\boldsymbol{\\sigma} = \\mathbf{D}\\,\\boldsymbol{\\varepsilon}$ 控制。本构矩阵 $\\mathbf{D}$ 由下式给出：\n$$\n\\mathbf{D} = \\frac{E}{1-\\nu^2}\n\\begin{bmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{bmatrix}\n$$\n其中杨氏模量 $E = 2.10\\times 10^{11}\\ \\text{Pa}$，泊松比 $\\nu = 0.30$。单元厚度为 $t = 1.0\\times 10^{-2}\\ \\text{m}$。\n\n该检验单元由处于其参考构型中的四个节点组成：$\\mathbf{X}_0=(0.0,\\,0.0)$、$\\mathbf{X}_1=(1.0,\\,0.2)$、$\\mathbf{X}_2=(1.5,\\,1.1)$ 和 $\\mathbf{X}_3=(0.1,\\,0.9)$。这些节点构成两个三角形单元：单元1的节点为 $(0,\\,1,\\,2)$，单元2的节点为 $(0,\\,2,\\,3)$。全局内力向量 $\\mathbf{f}^{\\text{int}}$ 将有8个分量，代表四个节点中每个节点的两个力分量。该向量初始化为零。\n\n对每个测试用例执行该程序，每个用例通过一个旋转角 $\\theta$ 和一个平移向量 $\\mathbf{t} = [t_x, t_y]^{\\mathsf{T}}$ 定义一个刚体运动。每个节点 $i$ 的当前位置 $\\mathbf{x}_i$ 是根据其参考位置 $\\mathbf{X}_i$ 通过以下变换计算得出的：\n$$\n\\mathbf{x}_i = \\mathbf{R}(\\theta)\\,\\mathbf{X}_i + \\mathbf{t}, \\quad \\text{其中} \\quad \\mathbf{R}(\\theta) = \\begin{bmatrix}\\cos\\theta & -\\sin\\theta\\\\ \\sin\\theta & \\cos\\theta\\end{bmatrix}.\n$$\n解决方案的核心在于单独处理每个单元，然后组装结果。对于每个单元：\n\n1.  **单元刚度计算**：单元刚度矩阵 $\\mathbf{K}_e$ 是恒定的，因为它仅取决于参考几何形状和材料属性。对于一个节点为 $(i, j, k)$ 且参考坐标为 $(\\mathbf{X}_i, \\mathbf{X}_j, \\mathbf{X}_k)$ 的三角形，计算其面积 $A$。确定几何系数 $b_n, c_n$（其中 $n \\in \\{i, j, k\\}$），这允许构建应变-位移矩阵 $\\mathbf{B}$。然后单元刚度矩阵计算为 $\\mathbf{K}_e = t\\,A\\,\\mathbf{B}^{\\mathsf{T}}\\mathbf{D}\\mathbf{B}$。\n\n2.  **共转分析**：此步骤计算单元相对于随单元旋转的坐标系的变形，从而将引起应变的变形与刚体运动分离开来。\n    -   计算单元参考节点位置和当前节点位置的形心 $\\bar{\\mathbf{X}}$ 和 $\\bar{\\mathbf{x}}$。\n    -   形成协方差矩阵 $\\mathbf{H} = \\sum_{n=1}^{3} (\\mathbf{x}_n - \\bar{\\mathbf{x}})(\\mathbf{X}_n - \\bar{\\mathbf{X}})^{\\mathsf{T}}$。该矩阵将中心化的当前位置与中心化的参考位置关联起来。\n    -   对 $\\mathbf{H}$ 执行奇异值分解（SVD）：$\\mathbf{H} = \\mathbf{U}\\mathbf{S}\\mathbf{V}^{\\mathsf{T}}$。然后，单元的最佳拟合旋转矩阵由 $\\mathbf{R}_e = \\mathbf{U}\\mathbf{V}^{\\mathsf{T}}$ 给出。为确保 $\\mathbf{R}_e$ 是一个纯旋转（而非反射），我们强制 $\\det(\\mathbf{R}_e) = +1$。如果初始计算得出 $\\det(\\mathbf{R}_e) = -1$，则在重新计算 $\\mathbf{R}_e$ 之前，$\\mathbf{U}$ 的最后一列将被取反。\n    -   计算每个节点的共转位移向量 $\\mathbf{u}^{\\text{corr}}_n$。该向量表示在旋转坐标系中的位移：\n        $$\n        \\mathbf{u}^{\\text{corr}}_n = \\mathbf{R}_e^{\\mathsf{T}}(\\mathbf{x}_n - \\bar{\\mathbf{x}}) - (\\mathbf{X}_n - \\bar{\\mathbf{X}}).\n        $$\n        这些位移被组装成一个 $6 \\times 1$ 的单元向量 $\\mathbf{u}^{\\text{corr}}_e$。\n\n3.  **单元内力计算**：单元内力向量是使用共转位移和单元刚度矩阵计算的：\n    $$\n    \\mathbf{f}^{\\text{int}}_e = \\mathbf{K}_e\\,\\mathbf{u}^{\\text{corr}}_e.\n    $$\n    从解析上讲，对于纯刚体运动，提取的旋转 $\\mathbf{R}_e$ 应与施加的旋转 $\\mathbf{R}(\\theta)$ 相匹配。这导致 $\\mathbf{u}^{\\text{corr}}_e = \\mathbf{0}$，因此 $\\mathbf{f}^{\\text{int}}_e = \\mathbf{0}$。在数值上，这些向量将接近于零，受浮点精度限制。\n\n4.  **全局组装**：计算出的单元内力 $\\mathbf{f}^{\\text{int}}_e$ 被添加（散布）到全局内力向量 $\\mathbf{f}^{\\text{int}}$ 中，其位置对应于单元的全局节点索引。\n\n在遍历两个单元后，计算完全组装好的全局内力向量的欧几里得范数 $\\|\\mathbf{f}^{\\text{int}}\\|_2$。该范数代表了该测试用例的最终结果。对所有五个测试用例重复此过程。预期结果是，在所有情况下，范数都将是一个非常小的数值，这证实了共转公式能够正确处理刚体运动，而不会产生虚假的内力。所实现的 Python 代码系统地执行了这些步骤。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a corotational constant-strain triangular element patch test\n    to verify the vanishing of internal forces under rigid-body motion.\n    \"\"\"\n    # 1. DEFINE CONSTANTS, GEOMETRY, AND MATERIAL PROPERTIES\n    \n    # Material properties\n    E = 2.10e11  # Young's modulus in Pa\n    nu = 0.30    # Poisson's ratio\n    t = 1.0e-2   # Thickness in m\n\n    # Constitutive matrix for plane stress\n    D_factor = E / (1 - nu**2)\n    D = D_factor * np.array([\n        [1, nu, 0],\n        [nu, 1, 0],\n        [0, 0, (1 - nu) / 2]\n    ])\n\n    # Reference nodal coordinates (m)\n    nodes_ref = np.array([\n        [0.0, 0.0],  # Node 0\n        [1.0, 0.2],  # Node 1\n        [1.5, 1.1],  # Node 2\n        [0.1, 0.9]   # Node 3\n    ])\n\n    # Element connectivity (0-based indexing)\n    elements = [\n        [0, 1, 2],\n        [0, 2, 3]\n    ]\n\n    # Test cases: (theta in rad, tx in m, ty in m)\n    test_cases = [\n        (0.0, 0.0, 0.0),                                  # Case A\n        (1.0e-8, 0.3, -0.2),                              # Case B\n        (0.5, 1.2, -0.5),                                 # Case C\n        (1.5707963267948966, -0.7, 0.4),                  # Case D (pi/2)\n        (3.0, 2.0, 2.0)                                   # Case E\n    ]\n    \n    results = []\n\n    # 2. RUN PATCH TEST FOR EACH CASE\n    for theta, tx, ty in test_cases:\n        # Apply rigid body motion to get current nodal coordinates\n        R_glob = np.array([\n            [np.cos(theta), -np.sin(theta)],\n            [np.sin(theta), np.cos(theta)]\n        ])\n        t_glob = np.array([tx, ty])\n        nodes_curr = (R_glob @ nodes_ref.T).T + t_glob\n\n        # Initialize global internal force vector (4 nodes, 2 DOFs each)\n        f_int_global = np.zeros(nodes_ref.size)\n\n        # 3. PROCESS EACH ELEMENT\n        for el_nodes in elements:\n            # Get reference and current coordinates for the element\n            X_e = nodes_ref[el_nodes, :]\n            x_e = nodes_curr[el_nodes, :]\n            \n            # A) Compute element stiffness matrix Ke (based on reference configuration)\n            X1, Y1 = X_e[0, 0], X_e[0, 1]\n            X2, Y2 = X_e[1, 0], X_e[1, 1]\n            X3, Y3 = X_e[2, 0], X_e[2, 1]\n\n            A = 0.5 * np.linalg.det(np.array([[1, X1, Y1], [1, X2, Y2], [1, X3, Y3]]))\n\n            b1, b2, b3 = Y2 - Y3, Y3 - Y1, Y1 - Y2\n            c1, c2, c3 = X3 - X2, X1 - X3, X2 - X1\n\n            B = (1 / (2 * A)) * np.array([\n                [b1,  0, b2,  0, b3,  0],\n                [ 0, c1,  0, c2,  0, c3],\n                [c1, b1, c2, b2, c3, b3]\n            ])\n\n            Ke = t * abs(A) * (B.T @ D @ B)\n\n            # B) Corotational procedure\n            X_bar = np.mean(X_e, axis=0)\n            x_bar = np.mean(x_e, axis=0)\n\n            X_tilde = X_e - X_bar\n            x_tilde = x_e - x_bar\n\n            H = x_tilde.T @ X_tilde\n\n            U, S, Vt = np.linalg.svd(H)\n            \n            # Ensure R is a proper rotation matrix (det(R) = +1)\n            R_e = U @ Vt\n            if np.linalg.det(R_e) < 0:\n                U[:, -1] *= -1\n                R_e = U @ Vt\n\n            # Calculate corotated displacements\n            u_corr_e = np.zeros(6)\n            for i in range(3):\n                u_corr_i = R_e.T @ x_tilde[i] - X_tilde[i]\n                u_corr_e[2*i : 2*i+2] = u_corr_i\n            \n            # C) Compute element internal forces\n            f_int_e = Ke @ u_corr_e\n\n            # D) Assemble into global force vector\n            for i in range(3):\n                node_idx = el_nodes[i]\n                f_int_global[2*node_idx : 2*node_idx+2] += f_int_e[2*i : 2*i+2]\n        \n        # 4. COMPUTE NORM OF GLOBAL FORCE VECTOR\n        norm_f_int = np.linalg.norm(f_int_global)\n        results.append(norm_f_int)\n\n    # 5. FORMAT AND PRINT FINAL OUTPUT\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2550488"}]}