{"hands_on_practices": [{"introduction": "对于熟悉的凸问题，我们可以精确计算出最优步长。这个练习旨在通过一个简单的二次能量函数，从第一性原理出发推导精确步长，并将其与实用的回溯线搜索算法找到的步长进行比较[@problem_id:2573793]。通过这种对比，您可以深刻理解 Armijo 条件在确保能量充分下降中的作用，以及在计算效率和最优性之间的权衡。", "problem": "考虑由线性弹性问题的有限元离散化产生的二次能量，\n$$J(u) = \\tfrac{1}{2}\\,u^{\\top} K u - f^{\\top} u,$$\n其中 $K \\in \\mathbb{R}^{2 \\times 2}$ 是一个对称正定 (SPD) 刚度矩阵，$f \\in \\mathbb{R}^{2}$ 是载荷向量。设\n$$K = \\begin{pmatrix} 8 & -2 \\\\ -2 & 5 \\end{pmatrix}, \\qquad f = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}, \\qquad u^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.$$\n采用标准欧几里得内积和最速下降方向 $p^{(0)} = -\\nabla J(u^{(0)})$。从 $J$ 的梯度和方向导数的定义以及 Armijo 充分下降条件出发，完成以下任务：\n\n1) 从第一性原理推导，求出沿着最速下降方向使得 $J(u^{(0)} + \\alpha\\, p^{(0)})$ 最小化的精确步长 $\\alpha_{\\star}$。\n\n2) 使用回溯线搜索，其中 Armijo 参数为 $c_{1} = 10^{-4}$，初始试探步长为 $\\alpha_{0} = 1$，缩减因子为 $\\rho = \\tfrac{1}{2}$，确定在 $u^{(0)}$ 处可接受的回溯步长 $\\alpha_{\\mathrm{bt}}$（即序列 $\\{ \\alpha_{0}, \\rho \\alpha_{0}, \\rho^{2} \\alpha_{0}, \\dots \\}$ 中第一个满足 Armijo 条件的 $\\alpha$）。\n\n3) 报告比率 $\\alpha_{\\mathrm{bt}}/\\alpha_{\\star}$，结果表示为一个最简分数，无需四舍五入。", "solution": "该问题具有科学依据，是适定的，并包含了求得唯一解所需的所有信息。刚度矩阵 $K$ 是对称的。其正定性可以通过 Sylvester 判据来验证：第一个顺序主子式为 $\\det(8) = 8 > 0$，第二个顺序主子式为 $\\det(K) = (8)(5) - (-2)(-2) = 40 - 4 = 36 > 0$。由于 $K$ 是对称正定 (SPD) 的，二次泛函 $J(u)$ 是严格凸的，并存在唯一的最小值。我们开始求解。\n\n二次能量泛函由下式给出\n$$J(u) = \\frac{1}{2}u^{\\top} K u - f^{\\top} u.$$\n该泛函关于 $u$ 的梯度可以通过矩阵微积分求得。二次项 $\\frac{1}{2}u^{\\top} K u$ 的导数是 $\\frac{1}{2}(K + K^{\\top})u$，线性项 $-f^{\\top} u$ 的导数是 $-f$。由于刚度矩阵 $K$ 是对称的 ($K = K^{\\top}$)，梯度可简化为\n$$\\nabla J(u) = K u - f.$$\n给定初始点 $u^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。在该点，梯度为\n$$\\nabla J(u^{(0)}) = K u^{(0)} - f = K \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} - f = -f = -\\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ -1 \\end{pmatrix}.$$\n最速下降方向 $p^{(0)}$ 定义为在 $u^{(0)}$ 处梯度的负方向：\n$$p^{(0)} = -\\nabla J(u^{(0)}) = -(-f) = f = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}.$$\n\n1) 首先，我们推导精确步长 $\\alpha_{\\star}$。这是使一维函数 $\\phi(\\alpha) = J(u^{(0)} + \\alpha p^{(0)})$ 最小化的 $\\alpha > 0$ 的值。\n$$\\phi(\\alpha) = J(u^{(0)} + \\alpha p^{(0)}) = \\frac{1}{2}(u^{(0)} + \\alpha p^{(0)})^{\\top} K (u^{(0)} + \\alpha p^{(0)}) - f^{\\top}(u^{(0)} + \\alpha p^{(0)}).$$\n代入 $u^{(0)} = 0$，表达式简化为：\n$$\\phi(\\alpha) = \\frac{1}{2}(\\alpha p^{(0)})^{\\top} K (\\alpha p^{(0)}) - f^{\\top}(\\alpha p^{(0)}) = \\frac{1}{2}\\alpha^{2} (p^{(0)})^{\\top} K p^{(0)} - \\alpha f^{\\top} p^{(0)}.$$\n为求此关于 $\\alpha$ 的二次函数的最小值，我们令其关于 $\\alpha$ 的导数为零：\n$$\\frac{d\\phi}{d\\alpha} = \\alpha (p^{(0)})^{\\top} K p^{(0)} - f^{\\top} p^{(0)} = 0.$$\n对 $\\alpha$ 求解，得到精确步长 $\\alpha_{\\star}$：\n$$\\alpha_{\\star} = \\frac{f^{\\top} p^{(0)}}{(p^{(0)})^{\\top} K p^{(0)}}.$$\n由于 $p^{(0)} = f$，我们可以将其写为\n$$\\alpha_{\\star} = \\frac{f^{\\top} f}{f^{\\top} K f}.$$\n现在我们用给定的 $K$ 和 $f$ 计算所需的量：\n$$f^{\\top} f = \\begin{pmatrix} 2 & 1 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = 2^{2} + 1^{2} = 4 + 1 = 5.$$\n$$K f = \\begin{pmatrix} 8 & -2 \\\\ -2 & 5 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} (8)(2) + (-2)(1) \\\\ (-2)(2) + (5)(1) \\end{pmatrix} = \\begin{pmatrix} 16 - 2 \\\\ -4 + 5 \\end{pmatrix} = \\begin{pmatrix} 14 \\\\ 1 \\end{pmatrix}.$$\n$$f^{\\top} K f = \\begin{pmatrix} 2 & 1 \\end{pmatrix} \\begin{pmatrix} 14 \\\\ 1 \\end{pmatrix} = (2)(14) + (1)(1) = 28 + 1 = 29.$$\n代入这些值，我们求得精确步长：\n$$\\alpha_{\\star} = \\frac{5}{29}.$$\n\n2) 接下来，我们求解可接受的回溯步长 $\\alpha_{\\mathrm{bt}}$。回溯线搜索从初始试探步长 $\\alpha_{0}=1$ 开始，并以因子 $\\rho = \\frac{1}{2}$ 迭代地减小步长，直到满足 Armijo 充分下降条件。Armijo 条件为\n$$J(u^{(k)} + \\alpha p^{(k)}) \\le J(u^{(k)}) + c_{1} \\alpha \\nabla J(u^{(k)})^{\\top} p^{(k)}.$$\n对于我们问题中的初始步 ($k=0$)，该条件变为\n$$J(u^{(0)} + \\alpha p^{(0)}) \\le J(u^{(0)}) + c_{1} \\alpha \\nabla J(u^{(0)})^{\\top} p^{(0)}.$$\n我们计算每一项：\n$J(u^{(0)}) = J(\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}) = \\frac{1}{2}(0) - 0 = 0$.\n$\\nabla J(u^{(0)})^{\\top} p^{(0)} = (-f)^{\\top} f = -f^{\\top} f = -5$.\n$J(u^{(0)} + \\alpha p^{(0)}) = \\phi(\\alpha) = \\frac{1}{2}\\alpha^{2} (p^{(0)})^{\\top} K p^{(0)} - \\alpha f^{\\top} p^{(0)} = \\frac{29}{2}\\alpha^{2} - 5\\alpha$.\n因此 Armijo 条件为\n$$\\frac{29}{2}\\alpha^{2} - 5\\alpha \\le 0 + c_{1} \\alpha (-5) = -5 c_{1} \\alpha.$$\n由于 $\\alpha$ 必须为正，我们可以将不等式两边同除以 $\\alpha$：\n$$\\frac{29}{2}\\alpha - 5 \\le -5 c_{1}.$$\n$$\\frac{29}{2}\\alpha \\le 5 - 5 c_{1} = 5(1 - c_{1}).$$\n$$\\alpha \\le \\frac{10}{29}(1 - c_{1}).$$\n使用给定的 Armijo 参数 $c_{1} = 10^{-4}$：\n$$\\alpha \\le \\frac{10}{29}(1 - 10^{-4}) = \\frac{10}{29}(0.9999) = \\frac{9.999}{29}.$$\n现在我们检验试探步长序列 $\\alpha = \\{1, \\frac{1}{2}, \\frac{1}{4}, \\dots \\}$。\n- 检验 $\\alpha = 1$：$1 \\le \\frac{9.999}{29}$ 是否成立？不成立，因为 $29 > 9.999$。拒绝。\n- 检验 $\\alpha = \\frac{1}{2}$：$\\frac{1}{2} \\le \\frac{9.999}{29}$ 是否成立？这等价于 $29 \\le 2(9.999) = 19.998$。不成立。拒绝。\n- 检验 $\\alpha = \\frac{1}{4}$：$\\frac{1}{4} \\le \\frac{9.999}{29}$ 是否成立？这等价于 $29 \\le 4(9.999) = 39.996$。成立。接受。\n第一个满足条件的步长是 $\\alpha = \\frac{1}{4}$。因此，可接受的回溯步长为\n$$\\alpha_{\\mathrm{bt}} = \\frac{1}{4}.$$\n\n3) 最后，我们计算回溯步长与精确步长的比率：\n$$\\frac{\\alpha_{\\mathrm{bt}}}{\\alpha_{\\star}} = \\frac{1/4}{5/29} = \\frac{1}{4} \\cdot \\frac{29}{5} = \\frac{29}{20}.$$\n该分数已为最简形式，因为 $29$ 是一个质数，而 $20$ 不是 $29$ 的倍数。", "answer": "$$\\boxed{\\frac{29}{20}}$$", "id": "2573793"}, {"introduction": "仅确保能量下降（如 Armijo 条件）有时并不足以保证优化算法的良好性能，尤其是在高级的拟牛顿法中。本练习将引导您深入探讨 Wolfe 条件，特别是其中的曲率条件[@problem_id:2573854]。您将通过分析一个简单的例子，揭示为何满足曲率条件对于维持 Hessian 矩阵近似的正定性至关重要，并最终影响算法的超线性收敛速度。", "problem": "考虑一个总势能为\n$$\n\\Pi(u)=\\frac{1}{2} a\\, u^{2},\n$$\n的线性弹性能的一维有限元离散化，其中 $a>0$ 是一个类材料刚度参数，$u \\in \\mathbb{R}$ 是自由度。假设我们使用带线搜索全局化策略的下降法来最小化 $\\Pi(u)$。在迭代点 $u_{k}=1$ 处，梯度为 $g_{k}=\\nabla \\Pi(u_{k})$，搜索方向选为 $d_{k}=-g_{k}$。步长 $\\alpha_{k}>0$ 通过线搜索选定，该线搜索使用标准的充分下降（Armijo）条件和强Wolfe曲率条件，其常数分别为 $c_{1}\\in (0,1)$ 和 $c_{2}\\in (0,1)$，且 $c_{1}<c_{2}$。\n\n从可微性的基本定义、$\\Pi(u)$ 的一阶泰勒展开，以及线搜索中使用的基于梯度的充分下降和曲率概念出发，完成以下任务：\n- 推导步长 $\\alpha_{k}$ 需满足的解析条件，使得函数 $\\Pi(u)$ 在点 $u_{k}=1$ 沿方向 $d_{k}$ 满足Armijo条件。\n- 推导步长 $\\alpha_{k}$ 需满足的解析条件，使得在同一方向上满足强Wolfe曲率条件。\n- 使用具体常数 $a=2$、$c_{1}=\\frac{1}{10}$ 和 $c_{2}=\\frac{4}{5}$，确定 $\\alpha_{k}$ 的上确界值，使得Armijo条件成立但强Wolfe曲率条件不成立。将你的最终答案表示为一个无单位的精确分数。\n- 基于非线性有限元平衡中近似Hessian矩阵的拟牛顿更新的第一性原理，简要讨论接受仅满足Armijo条件但违反强Wolfe曲率条件的步长对实现超线性收敛可能性的影响。\n\n你最终的方框答案必须仅为所求的 $\\alpha_{k}$ 的上确界值，以精确分数形式表示。无需四舍五入。", "solution": "基于梯度的优化的基本原理是可微函数 $\\Pi$ 在点 $u_{k}$ 附近的一阶泰勒展开：\n$$\n\\Pi(u_{k} + \\delta u) = \\Pi(u_{k}) + \\nabla \\Pi(u_{k})^{\\top} \\delta u + o(\\|\\delta u\\|)\n$$\n对于线搜索，我们设 $\\delta u = \\alpha d_{k}$，其中 $d_{k}$ 是搜索方向，$\\alpha > 0$ 是步长。对于下降法，我们要求方向导数为负：$\\nabla \\Pi(u_{k})^{\\top} d_{k}  0$。\n\n我们将沿搜索方向的目标函数定义为步长 $\\alpha$ 的函数：\n$$\n\\phi(\\alpha) = \\Pi(u_{k} + \\alpha d_{k})\n$$\n根据链式法则，$\\phi(\\alpha)$ 对 $\\alpha$ 的导数为：\n$$\n\\phi'(\\alpha) = \\frac{d}{d\\alpha} \\Pi(u_{k} + \\alpha d_{k}) = \\nabla \\Pi(u_{k} + \\alpha d_{k})^{\\top} d_{k}\n$$\n特别地，$\\phi'(0) = \\nabla \\Pi(u_{k})^{\\top} d_{k} = g_{k}^{\\top} d_{k}$。\n\n对于给定问题，$\\Pi(u) = \\frac{1}{2} a u^{2}$。其梯度为 $\\nabla \\Pi(u) = \\frac{d\\Pi}{du} = a u$。\n在迭代点 $u_{k}=1$ 处，梯度为 $g_{k} = \\nabla \\Pi(1) = a(1) = a$。\n搜索方向为最速下降方向，$d_{k} = -g_{k} = -a$。\n在 $\\alpha=0$ 处的方向导数为 $\\phi'(0) = g_{k}^{\\top} d_{k} = (a)(-a) = -a^{2}$。由于 $a>0$，我们有 $-a^{2}0$，这证实了 $d_{k}$ 是一个下降方向。\n\n函数 $\\phi(\\alpha)$ 为：\n$$\n\\phi(\\alpha) = \\Pi(u_{k} + \\alpha d_{k}) = \\Pi(1 + \\alpha(-a)) = \\Pi(1 - a\\alpha) = \\frac{1}{2} a (1 - a\\alpha)^{2}\n$$\n导数 $\\phi'(\\alpha)$ 为：\n$$\n\\phi'(\\alpha) = a(1 - a\\alpha) \\cdot (-a) = -a^{2}(1 - a\\alpha)\n$$\n\n首先，我们推导充分下降（Armijo）条件的满足条件。该条件表述为：\n$$\n\\Pi(u_{k} + \\alpha_{k} d_{k}) \\le \\Pi(u_{k}) + c_{1} \\alpha_{k} \\nabla \\Pi(u_{k})^{\\top} d_{k}\n$$\n用 $\\phi$ 表示，即为 $\\phi(\\alpha_{k}) \\le \\phi(0) + c_{1} \\alpha_{k} \\phi'(0)$。\n代入我们具体问题的表达式：\n$$\n\\frac{1}{2} a (1 - a\\alpha_{k})^{2} \\le \\frac{1}{2} a (1)^{2} + c_{1} \\alpha_{k} (-a^{2})\n$$\n由于 $a>0$，我们可以将不等式两边同除以 $\\frac{a}{2}$：\n$$\n(1 - a\\alpha_{k})^{2} \\le 1 - 2 c_{1} a\\alpha_{k}\n$$\n展开左侧：\n$$\n1 - 2a\\alpha_{k} + a^{2}\\alpha_{k}^{2} \\le 1 - 2 c_{1} a\\alpha_{k}\n$$\n减去 $1$ 并重新整理得到：\n$$\na^{2}\\alpha_{k}^{2} - 2a\\alpha_{k} + 2 c_{1} a\\alpha_{k} \\le 0\n$$\n$$\na^{2}\\alpha_{k}^{2} - 2a\\alpha_{k}(1 - c_{1}) \\le 0\n$$\n由于 $\\alpha_{k}>0$ 且 $a>0$，我们可以同除以 $a\\alpha_{k}$：\n$$\na\\alpha_{k} - 2(1 - c_{1}) \\le 0\n$$\n为使Armijo条件得到满足，$\\alpha_{k}$ 需满足的解析条件是：\n$$\n\\alpha_{k} \\le \\frac{2(1 - c_{1})}{a}\n$$\n\n其次，我们推导强Wolfe曲率条件的满足条件。该条件表述为：\n$$\n|\\nabla \\Pi(u_{k} + \\alpha_{k} d_{k})^{\\top} d_{k}| \\le c_{2} |\\nabla \\Pi(u_{k})^{\\top} d_{k}|\n$$\n用 $\\phi$ 表示，即为 $|\\phi'(\\alpha_{k})| \\le c_{2} |\\phi'(0)|$。\n代入我们问题的表达式：\n$$\n|-a^{2}(1 - a\\alpha_{k})| \\le c_{2} |-a^{2}|\n$$\n由于 $a^{2}>0$，我们可以将其简化为：\n$$\n|1 - a\\alpha_{k}| \\le c_{2}\n$$\n这个绝对值不等式等价于以下两个不等式：\n$$\n-c_{2} \\le 1 - a\\alpha_{k} \\le c_{2}\n$$\n由左边的不等式，$a\\alpha_{k} - 1 \\le c_{2}$，可得 $a\\alpha_{k} \\le 1 + c_{2}$，因此 $\\alpha_{k} \\le \\frac{1 + c_{2}}{a}$。\n由右边的不等式，$1 - c_{2} \\le a\\alpha_{k}$，这意味着 $\\alpha_{k} \\ge \\frac{1 - c_{2}}{a}$。\n为使强Wolfe曲率条件得到满足，$\\alpha_{k}$ 需满足的解析条件是：\n$$\n\\frac{1 - c_{2}}{a} \\le \\alpha_{k} \\le \\frac{1 + c_{2}}{a}\n$$\n\n第三，我们使用具体常数 $a=2$、$c_{1}=\\frac{1}{10}$ 和 $c_{2}=\\frac{4}{5}$ 来找到使Armijo条件成立但强Wolfe曲率条件不成立的 $\\alpha_{k}$ 的上确界。\n\n对于 $\\alpha_{k} > 0$，Armijo条件成立的条件是：\n$$\n\\alpha_{k} \\le \\frac{2(1 - \\frac{1}{10})}{2} = 1 - \\frac{1}{10} = \\frac{9}{10}\n$$\n因此，Armijo条件下可接受的步长集合为 $S_{A} = (0, \\frac{9}{10}]$。\n\n强Wolfe曲率条件成立的条件是：\n$$\n\\frac{1 - \\frac{4}{5}}{2} \\le \\alpha_{k} \\le \\frac{1 + \\frac{4}{5}}{2}\n$$\n$$\n\\frac{1/5}{2} \\le \\alpha_{k} \\le \\frac{9/5}{2}\n$$\n$$\n\\frac{1}{10} \\le \\alpha_{k} \\le \\frac{9}{10}\n$$\n强Wolfe条件成立的步长集合为 $S_{W} = [\\frac{1}{10}, \\frac{9}{10}]$。\n\n我们寻求使Armijo条件满足且强Wolfe条件不满足的 $\\alpha_{k}$ 集合。这对应于集合 $S = S_{A} \\setminus S_{W}$。\n$$\nS = \\left(0, \\frac{9}{10}\\right] \\setminus \\left[\\frac{1}{10}, \\frac{9}{10}\\right]\n$$\n得到的集合是 $S = (0, \\frac{1}{10})$。\n\n问题要求此集合 $S$ 中 $\\alpha_{k}$ 的上确界值。开区间 $(0, \\frac{1}{10})$ 的上确界是其上界。\n$$\n\\sup(S) = \\sup\\left(0, \\frac{1}{10}\\right) = \\frac{1}{10}\n$$\n\n第四，简要讨论对拟牛顿法的影响。\n拟牛顿法（如BFGS）构造Hessian矩阵逆矩阵的近似，记为 $B_{k}$。这些方法稳定性和保持 $B_{k}$ 正定性的一个要求是所谓的曲率条件：$y_{k}^{\\top} s_{k}  0$，其中 $s_{k} = u_{k+1} - u_{k} = \\alpha_{k}d_{k}$ 且 $y_{k} = g_{k+1} - g_{k}$。标准的BFGS对 $B_{k+1}$ 的更新公式在分母中包含项 $y_{k}^{\\top} s_{k}$，这使得该条件至关重要。\n\nWolfe曲率条件就是为强制满足此条件而设计的。我们来考察 $y_{k}^{\\top} s_{k}$ 这一项：\n$$\ny_{k}^{\\top} s_{k} = (g_{k+1} - g_{k})^{\\top} (\\alpha_{k} d_{k}) = \\alpha_{k}(g_{k+1}^{\\top} d_{k} - g_{k}^{\\top} d_{k})\n$$\n弱Wolfe曲率条件是 $g_{k+1}^{\\top} d_{k} \\ge c_{2} g_{k}^{\\top} d_{k}$。由于强Wolfe条件蕴含弱Wolfe条件，满足它意味着：\n$$\ny_{k}^{\\top} s_{k} \\ge \\alpha_{k}(c_{2} g_{k}^{\\top} d_{k} - g_{k}^{\\top} d_{k}) = \\alpha_{k}(c_{2}-1) g_{k}^{\\top} d_{k}\n$$\n对于下降方向，$g_{k}^{\\top} d_{k}  0$。由于 $\\alpha_{k}0$ 且 $c_{2} \\in (0,1)$，项 $(c_{2}-1)$ 是负的。三项的乘积，即正数 $\\alpha_{k}$、负数 $(c_{2}-1)$ 和负数 $g_{k}^{\\top} d_{k}$，结果为正。因此，Wolfe曲率条件确保了 $y_{k}^{\\top} s_{k}  0$。\n\n如果接受一个仅满足Armijo条件但违反曲率条件的步长，则无法保证 $y_{k}^{\\top} s_{k}  0$。如果 $y_{k}^{\\top} s_{k} \\le 0$，Hessian近似矩阵 $B_{k+1}$ 可能变得非正定，或者更新可能完全失败（因除以零）。一个非正定的 $B_{k+1}$ 可能会生成一个后续的搜索方向 $d_{k+1} = -B_{k+1}g_{k+1}$，该方向不再是下降方向，导致优化过程停滞或失败。拟牛顿法超线性收敛的全部理论基础，都取决于Hessian近似矩阵以一种明确定义的方式收敛到真实Hessian矩阵，而这个过程要求保持正定性。违反曲率条件会破坏这一机制，从而排除了实现超线性收敛的可能性。", "answer": "$$\n\\boxed{\\frac{1}{10}}\n$$", "id": "2573854"}, {"introduction": "在非线性有限元分析中，我们经常会遇到能量函数非凸的情形，此时切线刚度矩阵可能是非正定的。在这种具有挑战性的情况下，标准的牛顿方向可能不再是能量的下降方向，导致基于能量的线搜索失效。本练习[@problem_id:2573788]通过一个精心设计的思想实验，展示了如何通过选择一个基于残差范数的评价函数 $M(\\mathbf{u}) = \\frac{1}{2}\\|\\mathbf{R}(\\mathbf{u})\\|_2^2$ 来有效引导求解过程，即使能量在某些步骤中会增加，从而突显了为复杂问题选择正确全局化策略的重要性。", "problem": "考虑一个非线性有限元（FE）平衡问题，该问题源于一个超弹性总势能 $\\Pi(\\mathbf{u})$，其残差为 $\\mathbf{R}(\\mathbf{u}) = \\nabla \\Pi(\\mathbf{u})$，一致切线刚度为 $\\mathbf{K}(\\mathbf{u}) = \\nabla^{2} \\Pi(\\mathbf{u})$。通过线搜索进行的全局化考虑了试探状态 $\\mathbf{u}(\\alpha) = \\mathbf{u}^{k} + \\alpha \\mathbf{p}^{k}$（其中 $\\alpha \\ge 0$），牛顿方向 $\\mathbf{p}^{k}$ 通过求解 $\\mathbf{K}^{k}\\mathbf{p}^{k} = -\\mathbf{R}^{k}$ 得到，其中 $\\mathbf{R}^{k} = \\mathbf{R}(\\mathbf{u}^{k})$ 且 $\\mathbf{K}^{k} = \\mathbf{K}(\\mathbf{u}^{k})$。通常使用两种接受准则：能量 $\\Pi$ 的下降和基于残差的价值函数 $M(\\alpha) = \\tfrac{1}{2}\\|\\mathbf{R}(\\mathbf{u}(\\alpha))\\|_{2}^{2}$ 的下降。\n\n假设在 $\\mathbf{u}^{k}$ 周围一个局部二次模型是精确的，因此对于任何增量 $\\mathbf{s}$，都有 $\\Pi(\\mathbf{u}^{k}+\\mathbf{s}) = \\Pi(\\mathbf{u}^{k}) + \\mathbf{R}^{k\\top}\\mathbf{s} + \\tfrac{1}{2}\\mathbf{s}^{\\top}\\mathbf{K}^{k}\\mathbf{s}$ 和 $\\mathbf{R}(\\mathbf{u}^{k}+\\mathbf{s}) = \\mathbf{R}^{k} + \\mathbf{K}^{k}\\mathbf{s}$。在当前迭代步，设\n- $\\mathbf{R}^{k} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$，\n- $\\mathbf{K}^{k} = \\mathrm{diag}(1,-1)$。\n\n使用精确的牛顿方向 $\\mathbf{p}^{k} = -(\\mathbf{K}^{k})^{-1}\\mathbf{R}^{k}$ 和线 $\\mathbf{u}(\\alpha) = \\mathbf{u}^{k} + \\alpha \\mathbf{p}^{k}$：\n\n- 推导 $\\Delta \\Pi(\\alpha) := \\Pi(\\mathbf{u}(\\alpha)) - \\Pi(\\mathbf{u}^{k})$ 和 $M(\\alpha) := \\tfrac{1}{2}\\|\\mathbf{R}(\\mathbf{u}(\\alpha))\\|_{2}^{2}$ 作为 $\\alpha$ 的函数的显式表达式。\n- 证明存在一个非空区间 $\\alpha$，在该区间内 $\\Delta \\Pi(\\alpha)$ 严格为正，而 $M(\\alpha)$ 严格递减，从而证明基于残差价值的线搜索会接受基于能量下降的线搜索所拒绝的步长。\n- 计算使 $\\Pi(\\mathbf{u}(\\alpha)) = \\Pi(\\mathbf{u}^{k})$ 成立的最小正步长 $\\alpha$。将此值作为你的最终答案报告（无量纲）。\n- 根据你的推导，就哪种接受准则（能量下降与残差价值下降）更直接地反映有限元中向平衡的收斂，给出一个简明的论证。\n\n你最终报告的答案必须是使 $\\Pi(\\mathbf{u}(\\alpha)) = \\Pi(\\mathbf{u}^{k})$ 成立的最小正 $\\alpha$ 的单个值。无需四舍五入。", "solution": "第一个任务是计算牛顿方向 $\\mathbf{p}^{k}$。给定 $\\mathbf{K}^{k}\\mathbf{p}^{k} = -\\mathbf{R}^{k}$，我们求解 $\\mathbf{p}^{k}$：\n$$\n\\mathbf{p}^{k} = -(\\mathbf{K}^{k})^{-1}\\mathbf{R}^{k}\n$$\n切线矩阵为 $\\mathbf{K}^{k} = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}$。其逆矩阵为 $(\\mathbf{K}^{k})^{-1} = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}$，与 $\\mathbf{K}^{k}$ 相同。\n当 $\\mathbf{R}^{k} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$ 时，方向为：\n$$\n\\mathbf{p}^{k} = - \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = - \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix}\n$$\n\n接下来，我们推导势能变化的表达式，$\\Delta \\Pi(\\alpha) = \\Pi(\\mathbf{u}(\\alpha)) - \\Pi(\\mathbf{u}^{k})$。\n使用所提供的二次模型和增量 $\\mathbf{s} = \\alpha \\mathbf{p}^{k}$：\n$$\n\\Delta \\Pi(\\alpha) = \\mathbf{R}^{k\\top}(\\alpha \\mathbf{p}^{k}) + \\frac{1}{2}(\\alpha \\mathbf{p}^{k})^{\\top}\\mathbf{K}^{k}(\\alpha \\mathbf{p}^{k}) = \\alpha (\\mathbf{R}^{k\\top}\\mathbf{p}^{k}) + \\frac{1}{2}\\alpha^{2} (\\mathbf{p}^{k\\top}\\mathbf{K}^{k}\\mathbf{p}^{k})\n$$\n我们计算标量积：\n在 $\\mathbf{u}^k$ 处，$\\Pi$ 沿 $\\mathbf{p}^{k}$ 方向的方向导数为 $\\mathbf{R}^{k\\top}\\mathbf{p}^{k}$：\n$$\n\\mathbf{R}^{k\\top}\\mathbf{p}^{k} = \\begin{pmatrix} 1  2 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 2 \\end{pmatrix} = (1)(-1) + (2)(2) = -1 + 4 = 3\n$$\n二次项为 $\\mathbf{p}^{k\\top}\\mathbf{K}^{k}\\mathbf{p}^{k}$。使用定义 $\\mathbf{K}^{k}\\mathbf{p}^{k} = -\\mathbf{R}^{k}$：\n$$\n\\mathbf{p}^{k\\top}\\mathbf{K}^{k}\\mathbf{p}^{k} = \\mathbf{p}^{k\\top}(-\\mathbf{R}^{k}) = -(\\mathbf{p}^{k\\top}\\mathbf{R}^{k}) = -(\\mathbf{R}^{k\\top}\\mathbf{p}^{k}) = -3\n$$\n将这些值代回 $\\Delta \\Pi(\\alpha)$ 的表达式中：\n$$\n\\Delta \\Pi(\\alpha) = 3\\alpha - \\frac{3}{2}\\alpha^{2}\n$$\n由于方向导数 $\\mathbf{R}^{k\\top}\\mathbf{p}^{k} = 3 > 0$，牛顿方向 $\\mathbf{p}^{k}$ 是势能 $\\Pi$ 的一个上升方向。\n\n接下来，我们推导基于残差的价值函数 $M(\\alpha) = \\frac{1}{2}\\|\\mathbf{R}(\\mathbf{u}(\\alpha))\\|_{2}^{2}$ 的表达式。\n使用残差的精确线性模型和增量 $\\mathbf{s} = \\alpha \\mathbf{p}^{k}$：\n$$\n\\mathbf{R}(\\mathbf{u}(\\alpha)) = \\mathbf{R}(\\mathbf{u}^{k} + \\alpha\\mathbf{p}^{k}) = \\mathbf{R}^{k} + \\alpha \\mathbf{K}^{k}\\mathbf{p}^{k}\n$$\n代入 $\\mathbf{K}^{k}\\mathbf{p}^{k} = -\\mathbf{R}^{k}$：\n$$\n\\mathbf{R}(\\mathbf{u}(\\alpha)) = \\mathbf{R}^{k} + \\alpha(-\\mathbf{R}^{k}) = (1-\\alpha)\\mathbf{R}^{k}\n$$\n现在我们计算价值函数：\n$$\nM(\\alpha) = \\frac{1}{2}\\|(1-\\alpha)\\mathbf{R}^{k}\\|_{2}^{2} = \\frac{1}{2}(1-\\alpha)^{2}\\|\\mathbf{R}^{k}\\|_{2}^{2}\n$$\n我们计算初始残差的平方范数：$\\|\\mathbf{R}^{k}\\|_{2}^{2} = 1^{2} + 2^{2} = 5$。\n因此，价值函数为：\n$$\nM(\\alpha) = \\frac{5}{2}(1-\\alpha)^{2}\n$$\n\n现在我们必须证明存在一个非空区间 $\\alpha$，在该区间内 $\\Delta \\Pi(\\alpha) > 0$，同时 $M(\\alpha)$ 严格递减。\n条件 $\\Delta \\Pi(\\alpha) > 0$ 变为 $3\\alpha - \\frac{3}{2}\\alpha^{2} > 0$，可简化为 $\\frac{3}{2}\\alpha(2-\\alpha) > 0$。对于 $\\alpha > 0$，这要求 $2-\\alpha > 0$，所以 $\\alpha \\in (0, 2)$。\n为使 $M(\\alpha)$ 严格递减，其关于 $\\alpha$ 的导数必须为负。\n$$\n\\frac{dM}{d\\alpha} = \\frac{d}{d\\alpha}\\left(\\frac{5}{2}(1-\\alpha)^{2}\\right) = \\frac{5}{2} \\cdot 2(1-\\alpha)(-1) = -5(1-\\alpha)\n$$\n条件 $\\frac{dM}{d\\alpha}  0$ 意味着 $-5(1-\\alpha)  0$，即 $1-\\alpha > 0$，或 $\\alpha  1$。\n这两个条件 $\\alpha \\in (0, 2)$ 和 $\\alpha  1$ 的交集是区间 $\\alpha \\in (0, 1)$。对于此区间内的任何 $\\alpha$，能量增加（$\\Delta\\Pi > 0$），因此基于能量的线搜索会拒绝此步长。然而，基于残差的价值函数是下降的，因此基于 $M(\\alpha)$ 的线搜索会接受这样的步长。这证明了该论断。\n\n我们被要求计算使势能返回其初始值的最小正步长 $\\alpha$，即 $\\Pi(\\mathbf{u}(\\alpha)) = \\Pi(\\mathbf{u}^{k})$，这等价于 $\\Delta \\Pi(\\alpha) = 0$。\n$$\n3\\alpha - \\frac{3}{2}\\alpha^{2} = 0\n$$\n$$\n\\alpha\\left(3 - \\frac{3}{2}\\alpha\\right) = 0\n$$\n该方程有两个解：$\\alpha = 0$（平凡的起始点）和 $3 - \\frac{3}{2}\\alpha = 0$。\n求解非平凡的 $\\alpha$：\n$$\n3 = \\frac{3}{2}\\alpha \\implies \\alpha = 2\n$$\n因此，最小正步长为 $\\alpha = 2$。\n\n最后，就更合适的接受准则给出一个简明的论证。在有限元平衡分析中，基本目标是找到状态 $\\mathbf{u}^{*}$，使得内力和外力平衡，这在数学上表示为残差向量为零：$\\mathbf{R}(\\mathbf{u}^{*}) = \\mathbf{0}$。基于残差的价值函数 $M(\\mathbf{u}) = \\frac{1}{2}\\|\\mathbf{R}(\\mathbf{u})\\|_{2}^{2}$ 的构造正是为了衡量朝向这一目标的进展，因为 $M(\\mathbf{u}) \\ge 0$ 且 $M(\\mathbf{u}) = 0$ 当且仅当 $\\mathbf{R}(\\mathbf{u}) = \\mathbf{0}$。因此，确保 $M$ 下降的线搜索直接收敛于一个平衡状态。相比之下，能量下降准则寻求势能 $\\Pi$ 的局部最小值。虽然稳定平衡点是局部最小值，但平衡也可能出现在鞍点或局部最大值处，特别是在涉及失稳和路径跟踪的问题中。如此问题所示，当切线刚度 $\\mathbf{K}^{k}$ 不定时，牛顿方向可能是能量的上升方向，导致基于能量的线搜索失败。然而，基于残差价值的准则仍然有效，并允许算法朝向 $\\mathbf{R}=\\mathbf{0}$ 的解前进（在本例中是在 $\\alpha=1$ 处）。因此，基于残差价值的准则更稳健，并直接反映了寻找任何平衡状态（无论稳定与否）的主要目标。", "answer": "$$\n\\boxed{2}\n$$", "id": "2573788"}]}