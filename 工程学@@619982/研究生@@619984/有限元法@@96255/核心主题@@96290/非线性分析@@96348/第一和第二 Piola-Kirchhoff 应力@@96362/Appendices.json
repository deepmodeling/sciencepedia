{"hands_on_practices": [{"introduction": "在处理大变形问题时，我们通常在未变形的参考构形中建立方程。然而，真实的物理应力（柯西应力$\\boldsymbol{\\sigma}$）是定义在变形后的当前构形中的。本练习通过引入第一和第二皮奥拉-基尔霍夫应力（$\\boldsymbol{P}$和$\\boldsymbol{S}$）来解决这种不匹配，这两种应力均是相对于参考构形定义的。通过从第一性原理出发推导$\\boldsymbol{\\sigma}$、$\\boldsymbol{P}$和$\\boldsymbol{S}$之间的转换关系，您将深刻理解它们的定义及其背后的物理逻辑，这是解决任何大变形连续介质力学问题的基础技能。[@problem_id:2587889]", "problem": "在有限变形弹性力学的全拉格朗日有限元列式中，考虑一个从参考构型（位置矢量为$\\boldsymbol{X}$）到当前构型（位置矢量为$\\boldsymbol{x}=\\boldsymbol{\\varphi}(\\boldsymbol{X})$）的物质映射。变形梯度为$\\boldsymbol{F}=\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{\\varphi}$。设参考构型中面元的单位法向量为$\\boldsymbol{N}$，面积为$\\mathrm{d}A$，当前构型中对应面元的单位法向量为$\\boldsymbol{n}$，面积为$\\mathrm{d}a$。设 Cauchy 应力（真实应力）为$\\boldsymbol{\\sigma}$，第一 Piola–Kirchhoff 应力为$\\boldsymbol{P}$，第二 Piola–Kirchhoff 应力为$\\boldsymbol{S}$。\n\n给定以下基本关系：\n- 当前构型中的 Cauchy 面力定义：$\\boldsymbol{t}=\\boldsymbol{\\sigma}\\,\\boldsymbol{n}$。\n- 参考构型中的名义面力定义：$\\boldsymbol{T}_{0}=\\boldsymbol{P}\\,\\boldsymbol{N}$。\n- 对应面元上接触力相等：$\\boldsymbol{t}\\,\\mathrm{d}a=\\boldsymbol{T}_{0}\\,\\mathrm{d}A$。\n- Nanson 公式：$\\boldsymbol{n}\\,\\mathrm{d}a = J\\,\\boldsymbol{F}^{-T}\\boldsymbol{N}\\,\\mathrm{d}A$，其中$J=\\det \\boldsymbol{F}$。\n\n仅从上述关系和定义$\\boldsymbol{S}=\\boldsymbol{F}^{-1}\\boldsymbol{P}$出发，首先推导用$\\boldsymbol{F}$、$J$和$\\boldsymbol{\\sigma}$表示的$\\boldsymbol{P}$和$\\boldsymbol{S}$的表达式。然后，将其特殊化到纯拉伸情况，其中\n$$\n\\boldsymbol{F}=\\operatorname{diag}(\\lambda_{1},\\lambda_{2},\\lambda_{3}), \\quad \\lambda_{i}>0,\n$$\n以及对角的 Cauchy 应力\n$$\n\\boldsymbol{\\sigma}=\\operatorname{diag}(\\sigma_{1},\\sigma_{2},\\sigma_{3}).\n$$\n\n计算$\\boldsymbol{P}$和$\\boldsymbol{S}$的对角分量，以$\\lambda_{1},\\lambda_{2},\\lambda_{3}$和$\\sigma_{1},\\sigma_{2},\\sigma_{3}$的闭式表达式显式给出。将最终答案表示为一个单行矩阵，其中包含按顺序排列的六个对角元$\\big(P_{11},P_{22},P_{33},S_{11},S_{22},S_{33}\\big)$，在需要时使用$J=\\lambda_{1}\\lambda_{2}\\lambda_{3}$。以符号形式表示您的最终答案；不包含单位。", "solution": "对问题陈述进行分析，认定其有效。这是一个连续介质力学中的适定问题，基于已建立的原理，具有一套完整且一致的定义和关系。不存在科学或逻辑上的缺陷。求解过程将首先推导应力张量之间的一般关系，然后将其特殊化到给定情况。\n\n出发点是在当前构型和参考构型中，作用于一个物质面元上的接触力相等：\n$$\n\\boldsymbol{t}\\,\\mathrm{d}a = \\boldsymbol{T}_{0}\\,\\mathrm{d}A\n$$\n此处，$\\boldsymbol{t}$是当前构型中的 Cauchy 面力矢量，$\\boldsymbol{T}_{0}$是参考构型中的名义面力矢量。面元面积分别为$\\mathrm{d}a$和$\\mathrm{d}A$。\n\n我们将用 Cauchy 应力$\\boldsymbol{\\sigma}$和第一 Piola-Kirchhoff 应力$\\boldsymbol{P}$表示的面力矢量定义代入：\n$$\n(\\boldsymbol{\\sigma}\\,\\boldsymbol{n})\\,\\mathrm{d}a = (\\boldsymbol{P}\\,\\boldsymbol{N})\\,\\mathrm{d}A\n$$\n其中$\\boldsymbol{n}$和$\\boldsymbol{N}$分别是当前构型和参考构型中面元的单位法向量。整理各项可得：\n$$\n\\boldsymbol{\\sigma}\\,(\\boldsymbol{n}\\,\\mathrm{d}a) = \\boldsymbol{P}\\,(\\boldsymbol{N}\\,\\mathrm{d}A)\n$$\n我们现在使用 Nanson 公式，该公式关联了两种构型中的有向面元：\n$$\n\\boldsymbol{n}\\,\\mathrm{d}a = J\\,\\boldsymbol{F}^{-T}\\boldsymbol{N}\\,\\mathrm{d}A\n$$\n其中$\\boldsymbol{F}$是变形梯度，$J = \\det(\\boldsymbol{F})$，$\\boldsymbol{F}^{-T}$是$\\boldsymbol{F}$的逆转置。将 Nanson 公式代入力平衡方程得：\n$$\n\\boldsymbol{\\sigma}\\,(J\\,\\boldsymbol{F}^{-T}\\boldsymbol{N}\\,\\mathrm{d}A) = \\boldsymbol{P}\\,(\\boldsymbol{N}\\,\\mathrm{d}A)\n$$\n由于此关系必须对任意面元都成立，我们可以消去标量项$\\mathrm{d}A$，并认识到该等式必须对法向量$\\boldsymbol{N}$的任何选择都成立。这便推导出了张量之间的以下关系：\n$$\n\\boldsymbol{P} = J\\,\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T}\n$$\n这就是所求的关联第一 Piola-Kirchhoff 应力$\\boldsymbol{P}$和 Cauchy 应力$\\boldsymbol{\\sigma}$的表达式。\n\n接着，我们推导第二 Piola-Kirchhoff 应力$\\boldsymbol{S}$的表达式。根据给出的定义：\n$$\n\\boldsymbol{S} = \\boldsymbol{F}^{-1}\\boldsymbol{P}\n$$\n代入我们刚刚推导出的$\\boldsymbol{P}$的表达式：\n$$\n\\boldsymbol{S} = \\boldsymbol{F}^{-1}\\,(J\\,\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T})\n$$\n标量$J$可以移到前面：\n$$\n\\boldsymbol{S} = J\\,\\boldsymbol{F}^{-1}\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T}\n$$\n这就是所求的关联第二 Piola-Kirchhoff 应力$\\boldsymbol{S}$和 Cauchy 应力$\\boldsymbol{\\sigma}$的表达式。至此完成了问题的第一部分。\n\n对于第二部分，我们将这些一般关系特殊化到纯拉伸的情况，其中变形梯度$\\boldsymbol{F}$和 Cauchy 应力$\\boldsymbol{\\sigma}$以对角矩阵形式给出：\n$$\n\\boldsymbol{F} = \\begin{pmatrix} \\lambda_{1}  0  0 \\\\ 0  \\lambda_{2}  0 \\\\ 0  0  \\lambda_{3} \\end{pmatrix}, \\quad \\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_{1}  0  0 \\\\ 0  \\sigma_{2}  0 \\\\ 0  0  \\sigma_{3} \\end{pmatrix}\n$$\n其中主拉伸比$\\lambda_{i} > 0$。$\\boldsymbol{F}$的行列式为$J = \\det(\\boldsymbol{F}) = \\lambda_{1}\\lambda_{2}\\lambda_{3}$。由于$\\boldsymbol{F}$是一个对角矩阵，其转置等于其自身，即$\\boldsymbol{F}^{T} = \\boldsymbol{F}$。其转置的逆为：\n$$\n\\boldsymbol{F}^{-T} = (\\boldsymbol{F}^T)^{-1} = \\boldsymbol{F}^{-1} = \\begin{pmatrix} \\lambda_{1}^{-1}  0  0 \\\\ 0  \\lambda_{2}^{-1}  0 \\\\ 0  0  \\lambda_{3}^{-1} \\end{pmatrix}\n$$\n我们现在使用$\\boldsymbol{P} = J\\,\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T}$来计算$\\boldsymbol{P}$的分量：\n$$\n\\boldsymbol{P} = (\\lambda_{1}\\lambda_{2}\\lambda_{3}) \\begin{pmatrix} \\sigma_{1}  0  0 \\\\ 0  \\sigma_{2}  0 \\\\ 0  0  \\sigma_{3} \\end{pmatrix} \\begin{pmatrix} \\lambda_{1}^{-1}  0  0 \\\\ 0  \\lambda_{2}^{-1}  0 \\\\ 0  0  \\lambda_{3}^{-1} \\end{pmatrix}\n$$\n这两个对角矩阵的乘积是一个对角矩阵：\n$$\n\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T} = \\begin{pmatrix} \\sigma_{1}\\lambda_{1}^{-1}  0  0 \\\\ 0  \\sigma_{2}\\lambda_{2}^{-1}  0 \\\\ 0  0  \\sigma_{3}\\lambda_{3}^{-1} \\end{pmatrix}\n$$\n乘以标量$J$得到$\\boldsymbol{P}$的分量：\n$$\n\\boldsymbol{P} = (\\lambda_{1}\\lambda_{2}\\lambda_{3}) \\begin{pmatrix} \\sigma_{1}\\lambda_{1}^{-1}  0  0 \\\\ 0  \\sigma_{2}\\lambda_{2}^{-1}  0 \\\\ 0  0  \\sigma_{3}\\lambda_{3}^{-1} \\end{pmatrix} = \\begin{pmatrix} \\sigma_{1}\\lambda_{2}\\lambda_{3}  0  0 \\\\ 0  \\sigma_{2}\\lambda_{1}\\lambda_{3}  0 \\\\ 0  0  \\sigma_{3}\\lambda_{1}\\lambda_{2} \\end{pmatrix}\n$$\n第一 Piola-Kirchhoff 应力的对角分量为：\n$P_{11} = \\sigma_{1}\\lambda_{2}\\lambda_{3}$\n$P_{22} = \\sigma_{2}\\lambda_{1}\\lambda_{3}$\n$P_{33} = \\sigma_{3}\\lambda_{1}\\lambda_{2}$\n\n最后，我们使用$\\boldsymbol{S} = J\\,\\boldsymbol{F}^{-1}\\boldsymbol{\\sigma}\\,\\boldsymbol{F}^{-T}$计算$\\boldsymbol{S}$的分量：\n$$\n\\boldsymbol{S} = (\\lambda_{1}\\lambda_{2}\\lambda_{3}) \\begin{pmatrix} \\lambda_{1}^{-1}  0  0 \\\\ 0  \\lambda_{2}^{-1}  0 \\\\ 0  0  \\lambda_{3}^{-1} \\end{pmatrix} \\begin{pmatrix} \\sigma_{1}  0  0 \\\\ 0  \\sigma_{2}  0 \\\\ 0  0  \\sigma_{3} \\end{pmatrix} \\begin{pmatrix} \\lambda_{1}^{-1}  0  0 \\\\ 0  \\lambda_{2}^{-1}  0 \\\\ 0  0  \\lambda_{3}^{-1} \\end{pmatrix}\n$$\n执行矩阵乘法：\n$$\n\\boldsymbol{S} = (\\lambda_{1}\\lambda_{2}\\lambda_{3}) \\begin{pmatrix} \\lambda_{1}^{-1}  0  0 \\\\ 0  \\lambda_{2}^{-1}  0 \\\\ 0  0  \\lambda_{3}^{-1} \\end{pmatrix} \\begin{pmatrix} \\sigma_{1}\\lambda_{1}^{-1}  0  0 \\\\ 0  \\sigma_{2}\\lambda_{2}^{-1}  0 \\\\ 0  0  \\sigma_{3}\\lambda_{3}^{-1} \\end{pmatrix}\n$$\n$$\n\\boldsymbol{S} = (\\lambda_{1}\\lambda_{2}\\lambda_{3}) \\begin{pmatrix} \\sigma_{1}\\lambda_{1}^{-2}  0  0 \\\\ 0  \\sigma_{2}\\lambda_{2}^{-2}  0 \\\\ 0  0  \\sigma_{3}\\lambda_{3}^{-2} \\end{pmatrix} = \\begin{pmatrix} \\sigma_{1}\\lambda_{1}^{-1}\\lambda_{2}\\lambda_{3}  0  0 \\\\ 0  \\sigma_{2}\\lambda_{1}\\lambda_{2}^{-1}\\lambda_{3}  0 \\\\ 0  0  \\sigma_{3}\\lambda_{1}\\lambda_{2}\\lambda_{3}^{-1} \\end{pmatrix}\n$$\n第二 Piola-Kirchhoff 应力的对角分量为：\n$S_{11} = \\sigma_{1}\\lambda_{1}^{-1}\\lambda_{2}\\lambda_{3}$\n$S_{22} = \\sigma_{2}\\lambda_{1}\\lambda_{2}^{-1}\\lambda_{3}$\n$S_{33} = \\sigma_{3}\\lambda_{1}\\lambda_{2}\\lambda_{3}^{-1}$\n\n将所需的六个对角分量组合成一个单行矩阵，作为最终答案。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sigma_{1}\\lambda_{2}\\lambda_{3}  \\sigma_{2}\\lambda_{1}\\lambda_{3}  \\sigma_{3}\\lambda_{1}\\lambda_{2}  \\sigma_{1}\\lambda_{1}^{-1}\\lambda_{2}\\lambda_{3}  \\sigma_{2}\\lambda_{1}\\lambda_{2}^{-1}\\lambda_{3}  \\sigma_{3}\\lambda_{1}\\lambda_{2}\\lambda_{3}^{-1} \\end{pmatrix}}\n$$", "id": "2587889"}, {"introduction": "对于超弹性材料，应力并非一个独立的量，而是从一个储存的应变能函数$W$导出的。一个物理上真实的能量函数必须是客观的，这意味着它在刚体旋转下应保持不变，因为旋转本身不引起变形，也不储存能量。本练习通过考察一个纯刚体旋转的案例来探索这一材料框架无差异性原理。通过证明对于一个纯旋转，$\\boldsymbol{P}$和$\\boldsymbol{S}$两种皮奥拉-基尔霍夫应力均为零，您将验证任何有效的超弹性模型都必须满足的一个基本一致性要求，这个“刚体运动测试”在理论建模和有限元实践中都是一个至关重要的健全性检查。[@problem_id:2587933]", "problem": "考虑有限元方法中使用的一种超弹性材料模型，其应变能密度具有标架无关性，因此$W(\\boldsymbol{F}) = \\hat{W}(\\boldsymbol{C})$，其中$\\boldsymbol{C} = \\boldsymbol{F}^{\\top} \\boldsymbol{F}$。令$\\boldsymbol{F} \\in \\mathbb{R}^{3 \\times 3}$表示变形梯度，且$\\det \\boldsymbol{F} > 0$；令$\\boldsymbol{C} \\in \\mathbb{R}^{3 \\times 3}$表示右 Cauchy–Green 变形张量。假设$\\hat{W}(\\boldsymbol{C})$在$\\boldsymbol{C} = \\boldsymbol{I}$处达到其严格全局最小值，其中$\\boldsymbol{I}$是单位张量。第一 Piola–Kirchhoff 应力由$\\boldsymbol{P} := \\frac{\\partial W}{\\partial \\boldsymbol{F}}$定义，第二 Piola–Kirchhoff 应力由$\\boldsymbol{S} := 2 \\frac{\\partial \\hat{W}}{\\partial \\boldsymbol{C}}$定义。令$\\boldsymbol{Q} \\in \\mathrm{SO}(3)$为一个特殊正交张量，即$\\boldsymbol{Q}^{\\top} \\boldsymbol{Q} = \\boldsymbol{I}$且$\\det \\boldsymbol{Q} = 1$。\n\n任务：\n1. 从给定的定义和应用于$\\boldsymbol{C} = \\boldsymbol{F}^{\\top} \\boldsymbol{F}$的链式法则出发，推导出在$\\boldsymbol{C} = \\boldsymbol{I}$时的$\\boldsymbol{S}$，并推导出$\\boldsymbol{P}$和$\\boldsymbol{S}$之间的关系。然后，为刚体旋转$\\boldsymbol{F} = \\boldsymbol{Q} \\in \\mathrm{SO}(3)$的情况计算这些量。\n2. 定义标量诊断量 \n$$R := \\|\\boldsymbol{P}\\|_{F}^{2} + \\|\\boldsymbol{S}\\|_{F}^{2},$$\n其中$\\|\\boldsymbol{A}\\|_{F}^{2} := \\boldsymbol{A} : \\boldsymbol{A}$是 Frobenius 范数。计算在$\\boldsymbol{F} = \\boldsymbol{Q} \\in \\mathrm{SO}(3)$情况下的$R$。以精确实数形式提供最终答案，不带单位。\n3. 简要地将您的结果解释为一个刚体运动检验，一个一致的超弹性有限元实现应该通过该检验。\n\n您最终提交的答案必须仅为$R$的值。无需四舍五入。标量$R$是无量纲的；最终答案中不要包含任何单位。", "solution": "我们首先分析问题陈述中给出的条件。题目中指出，在右 Cauchy-Green 变形张量$\\boldsymbol{C}$为单位张量$\\boldsymbol{I}$的构型下，应变能密度$\\hat{W}(\\boldsymbol{C})$达到严格全局最小值。对于一个可微函数，其取得极值的必要条件是其梯度必须为零。标量函数$\\hat{W}$关于其张量参数$\\boldsymbol{C}$的梯度是$\\frac{\\partial \\hat{W}}{\\partial \\boldsymbol{C}}$。因此，在最小值点$\\boldsymbol{C}=\\boldsymbol{I}$处，我们必然有：\n$$\n\\left. \\frac{\\partial \\hat{W}}{\\partial \\boldsymbol{C}} \\right|_{\\boldsymbol{C}=\\boldsymbol{I}} = \\boldsymbol{0}\n$$\n其中$\\boldsymbol{0}$是二阶零张量。\n\n第二 Piola-Kirchhoff 应力张量$\\boldsymbol{S}$定义为$\\boldsymbol{S} := 2 \\frac{\\partial \\hat{W}}{\\partial \\boldsymbol{C}}$。通过代入$\\hat{W}$取最小值的条件，我们计算在$\\boldsymbol{C}=\\boldsymbol{I}$状态下的$\\boldsymbol{S}$：\n$$\n\\boldsymbol{S}(\\boldsymbol{C}=\\boldsymbol{I}) = 2 \\left. \\frac{\\partial \\hat{W}}{\\partial \\boldsymbol{C}} \\right|_{\\boldsymbol{C}=\\boldsymbol{I}} = 2 \\boldsymbol{0} = \\boldsymbol{0}\n$$\n这表明，在无应力参考构型中，第二 Piola-Kirchhoff 应力为零，这与物理原理的预期相符。\n\n接下来，我们必须推导第一 Piola-Kirchhoff 应力$\\boldsymbol{P}$和第二 Piola-Kirchhoff 应力$\\boldsymbol{S}$之间的关系。$\\boldsymbol{P}$的定义是$\\boldsymbol{P} := \\frac{\\partial W}{\\partial \\boldsymbol{F}}$。已知函数依赖关系$W(\\boldsymbol{F}) = \\hat{W}(\\boldsymbol{C}(\\boldsymbol{F}))$，我们应用链式法则进行求导。用指标记法表示为：\n$$\nP_{ij} = \\frac{\\partial W}{\\partial F_{ij}} = \\sum_{k,l} \\frac{\\partial \\hat{W}}{\\partial C_{kl}} \\frac{\\partial C_{kl}}{\\partial F_{ij}}\n$$\n根据$\\boldsymbol{S}$的定义，我们知道$\\frac{\\partial \\hat{W}}{\\partial C_{kl}} = \\frac{1}{2} S_{kl}$。右 Cauchy-Green 张量的分量是$C_{kl} = \\sum_m F_{mk} F_{ml}$。我们计算$C_{kl}$对$F_{ij}$的导数：\n$$\n\\frac{\\partial C_{kl}}{\\partial F_{ij}} = \\frac{\\partial}{\\partial F_{ij}} \\left( \\sum_m F_{mk} F_{ml} \\right) = \\sum_m \\left( \\frac{\\partial F_{mk}}{\\partial F_{ij}} F_{ml} + F_{mk} \\frac{\\partial F_{ml}}{\\partial F_{ij}} \\right)\n$$\n使用一个张量分量对另一个张量分量求导的恒等式$\\frac{\\partial F_{ab}}{\\partial F_{cd}} = \\delta_{ac} \\delta_{bd}$，其中$\\delta$是 Kronecker delta，我们得到：\n$$\n\\frac{\\partial C_{kl}}{\\partial F_{ij}} = \\sum_m \\left( (\\delta_{mi} \\delta_{kj}) F_{ml} + F_{mk} (\\delta_{mi} \\delta_{lj}) \\right) = \\delta_{kj} F_{il} + F_{ik} \\delta_{lj}\n$$\n将这些结果代入$P_{ij}$的表达式中：\n$$\nP_{ij} = \\sum_{k,l} \\left( \\frac{1}{2} S_{kl} \\right) (\\delta_{kj} F_{il} + F_{ik} \\delta_{lj}) = \\frac{1}{2} \\left( \\sum_{l} S_{jl} F_{il} + \\sum_{k} S_{kj} F_{ik} \\right)\n$$\n由于$\\boldsymbol{S}$是一个标量势相对于对称张量$\\boldsymbol{C}$的梯度，因此$\\boldsymbol{S}$也必须是对称的，即$\\boldsymbol{S} = \\boldsymbol{S}^{\\top}$或$S_{kj} = S_{jk}$。$P_{ij}$的表达式可以用张量表示法写出并简化：\n$$\n\\boldsymbol{P} = \\frac{1}{2} (\\boldsymbol{F} \\boldsymbol{S}^{\\top} + \\boldsymbol{F} \\boldsymbol{S}) = \\frac{1}{2} (\\boldsymbol{F} \\boldsymbol{S} + \\boldsymbol{F} \\boldsymbol{S}) = \\boldsymbol{F} \\boldsymbol{S}\n$$\n这是第一和第二 Piola-Kirchhoff 应力之间的基本关系。\n\n题目要求我们对刚体旋转情况计算这些量，此时变形梯度为$\\boldsymbol{F} = \\boldsymbol{Q}$，其中$\\boldsymbol{Q}$是一个特殊正交张量，$\\boldsymbol{Q} \\in \\mathrm{SO}(3)$。对于此变形，右 Cauchy-Green 张量为：\n$$\n\\boldsymbol{C} = \\boldsymbol{F}^{\\top} \\boldsymbol{F} = \\boldsymbol{Q}^{\\top} \\boldsymbol{Q}\n$$\n根据正交张量的定义，$\\boldsymbol{Q}^{\\top} \\boldsymbol{Q} = \\boldsymbol{I}$。因此，刚体旋转对应于$\\boldsymbol{C}=\\boldsymbol{I}$。如前所述，对于$\\boldsymbol{C}=\\boldsymbol{I}$，第二 Piola-Kirchhoff 应力为零：\n$$\n\\boldsymbol{S} = \\boldsymbol{S}(\\boldsymbol{C}=\\boldsymbol{I}) = \\boldsymbol{0}\n$$\n使用推导出的关系$\\boldsymbol{P}=\\boldsymbol{F}\\boldsymbol{S}$，我们得到相应的第一 Piola-Kirchhoff 应力：\n$$\n\\boldsymbol{P} = \\boldsymbol{F} \\boldsymbol{S} = \\boldsymbol{Q} \\boldsymbol{0} = \\boldsymbol{0}\n$$\n对于从无应力状态开始的物体刚体旋转，两种应力张量恒为零。\n\n最后的任务是计算标量诊断量$R$，其定义为：\n$$\nR := \\|\\boldsymbol{P}\\|_{F}^{2} + \\|\\boldsymbol{S}\\|_{F}^{2}\n$$\n其中$\\|\\boldsymbol{A}\\|_{F}^{2} := \\boldsymbol{A} : \\boldsymbol{A} = \\sum_{i,j} A_{ij}^2$是 Frobenius 范数的平方。对于$\\boldsymbol{F}=\\boldsymbol{Q}$的情况，我们有$\\boldsymbol{P} = \\boldsymbol{0}$和$\\boldsymbol{S} = \\boldsymbol{0}$。零张量的 Frobenius 范数为$0$。\n$$\n\\|\\boldsymbol{P}\\|_{F}^{2} = \\|\\boldsymbol{0}\\|_{F}^{2} = \\boldsymbol{0}:\\boldsymbol{0} = 0\n$$\n$$\n\\|\\boldsymbol{S}\\|_{F}^{2} = \\|\\boldsymbol{0}\\|_{F}^{2} = \\boldsymbol{0}:\\boldsymbol{0} = 0\n$$\n因此，$R$的值为：\n$$\nR = 0 + 0 = 0\n$$\n\n此结果的解释是，任何刚体运动作为一个无变形（无应变）的过程，在超弹性材料中必须产生零应力。在计算力学中，特别是在有限元方法中，这可作为一个基本的验证测试。当一个模型化的物体或一个单元片（patch of elements）经受纯旋转时，一个正确实现的超弹性材料模型必须返回零（或数值上可忽略的）应力值。在这类通常称为“刚体运动检验”的测试中，若$R$的结果非零，则表明数值实现中存在严重缺陷，例如未能满足材料标架无关性原理。通过此检验是一个一致且可靠的有限元程序的必要条件。", "answer": "$$\n\\boxed{0}\n$$", "id": "2587933"}, {"introduction": "在推导出应力张量的解析表达式后，计算力学中的一个关键步骤是将其正确地实现为代码。一个常见的错误来源是实现的能量函数$W(\\boldsymbol{F})$与其导数——应力张量$\\boldsymbol{P}(\\boldsymbol{F})$——之间存在不一致。本计算练习介绍了一种强大的验证技术——“泰勒测试”。它利用$\\boldsymbol{P} = \\partial W / \\partial \\boldsymbol{F}$的基本定义，通过比较应力所做的解析功$\\boldsymbol{P} : \\delta \\boldsymbol{F}$与能量变化的数值有限差分近似来进行验证。成功完成此测试可以使您对自己的应力实现是否与材料的能量模型一致建立起强大的信心，这是开发可靠有限元模拟的一项至关重要的技能。[@problem_id:2587909]", "problem": "令$\\boldsymbol{F} \\in \\mathbb{R}^{d \\times d}$表示从参考构型映射到当前构型的变形梯度，其中$d \\in \\{2,3\\}$。考虑一种可压缩超弹性材料，其应变能密度为$W(\\boldsymbol{F})$，其中$W$仅取决于$\\boldsymbol{F}$。第一Piola–Kirchhoff应力（有时称为名义应力）定义为能量相对于变形梯度的导数，即$\\boldsymbol{P}(\\boldsymbol{F}) = \\dfrac{\\partial W(\\boldsymbol{F})}{\\partial \\boldsymbol{F}}$，且能量在方向$\\delta \\boldsymbol{F}$上的方向导数满足$\\delta W(\\boldsymbol{F})[\\delta \\boldsymbol{F}] = \\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F}$，其中 Frobenius 积为$A : B = \\sum_{i,j} A_{ij} B_{ij}$。在有限元方法的背景下，可以通过验证$\\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F}$是否与$W(\\boldsymbol{F})$沿$\\delta \\boldsymbol{F}$的有限差分方向导数相匹配，来测试$\\boldsymbol{P}$的实现的能量平衡一致性。\n\n从第一性原理出发，为可压缩Neo-Hookean固体实现以下能量密度函数$W(\\boldsymbol{F})$：\n$$\nW(\\boldsymbol{F}) = \\frac{\\mu}{2}\\left(I_1(\\boldsymbol{C}) - d\\right) - \\mu \\ln J + \\frac{\\kappa}{2}\\left(\\ln J\\right)^2,\n$$\n其中$\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}$，$I_1(\\boldsymbol{C}) = \\mathrm{tr}(\\boldsymbol{C})$，$J = \\det(\\boldsymbol{F})$，$\\mu > 0$是剪切模量，$\\kappa > 0$是体积模量。您必须使用链式法则和基本的矩阵微积分恒等式，从上述$W(\\boldsymbol{F})$的定义中推导出$\\boldsymbol{P}(\\boldsymbol{F})$；您不能假定任何预知的应力公式。\n\n通过将解析方向导数$\\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F}$与方向导数的中心有限差分近似进行比较，来数值验证能量平衡：\n$$\nD^{\\mathrm{FD}}W(\\boldsymbol{F})[\\delta \\boldsymbol{F}] = \\frac{W\\!\\left(\\boldsymbol{F} + \\varepsilon\\,\\delta \\boldsymbol{F}\\right) - W\\!\\left(\\boldsymbol{F} - \\varepsilon\\,\\delta \\boldsymbol{F}\\right)}{2\\,\\varepsilon}.\n$$\n对于每个测试用例，计算对称相对误差\n$$\n\\mathrm{err} = \\frac{\\left|\\,\\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F} - D^{\\mathrm{FD}}W(\\boldsymbol{F})[\\delta \\boldsymbol{F}]\\,\\right|}{\\left|\\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F}\\right| + \\left|D^{\\mathrm{FD}}W(\\boldsymbol{F})[\\delta \\boldsymbol{F}]\\right| + 10^{-12}},\n$$\n并返回一个布尔值，指示$\\mathrm{err} \\leq 10^{-6}$是否成立。\n\n您的程序必须根据给定的定义实现$W(\\boldsymbol{F})$，从第一性原理推导并实现$\\boldsymbol{P}(\\boldsymbol{F})$，然后对下面的每个测试用例，根据上述标准计算布尔值的通过/失败结果。本问题中不需要物理单位。如果在您自己的推导中出现任何角度，则必须纯粹符号化地处理，不需要角度单位。\n\n使用以下测试套件。每个用例都指定了$\\boldsymbol{F}$、$\\delta \\boldsymbol{F}$、$\\mu$、$\\kappa$和$\\varepsilon$。所有矩阵都已明确给出。\n\n- 用例 $1$ ($d = 3$):\n  $$\n  \\boldsymbol{F} = \\begin{bmatrix}\n  1.1  0.2  -0.1 \\\\\n  0.0  0.9  0.15 \\\\\n  0.05  -0.08  1.05\n  \\end{bmatrix},\\quad\n  \\delta \\boldsymbol{F} = \\begin{bmatrix}\n  0.3  -0.1  0.2 \\\\\n  -0.05  0.25  -0.15 \\\\\n  0.1  -0.2  0.05\n  \\end{bmatrix},\\quad\n  \\mu = 40.0,\\quad \\kappa = 120.0,\\quad \\varepsilon = 10^{-7}.\n  $$\n\n- 用例 $2$ ($d = 3$):\n  $$\n  \\boldsymbol{F} = \\begin{bmatrix}\n  1.3  0.3  0.0 \\\\\n  0.1  0.8  0.2 \\\\\n  0.0  -0.1  1.2\n  \\end{bmatrix},\\quad\n  \\delta \\boldsymbol{F} = \\begin{bmatrix}\n  -0.2  0.05  0.1 \\\\\n  0.15  -0.25  0.05 \\\\\n  -0.05  0.1  -0.15\n  \\end{bmatrix},\\quad\n  \\mu = 25.0,\\quad \\kappa = 80.0,\\quad \\varepsilon = 10^{-7}.\n  $$\n\n- 用例 $3$ ($d = 2$):\n  $$\n  \\boldsymbol{F} = \\begin{bmatrix}\n  0.85  0.2 \\\\\n  -0.1  1.3\n  \\end{bmatrix},\\quad\n  \\delta \\boldsymbol{F} = \\begin{bmatrix}\n  0.1  -0.3 \\\\\n  0.25  0.15\n  \\end{bmatrix},\\quad\n  \\mu = 40.0,\\quad \\kappa = 120.0,\\quad \\varepsilon = 10^{-7}.\n  $$\n\n- 用例 $4$ ($d = 3$):\n  $$\n  \\boldsymbol{F} = \\begin{bmatrix}\n  0.85  0.0  0.0 \\\\\n  0.0  0.85  0.0 \\\\\n  0.0  0.0  0.85\n  \\end{bmatrix},\\quad\n  \\delta \\boldsymbol{F} = \\begin{bmatrix}\n  -0.1  0.05  0.0 \\\\\n  0.0  0.1  -0.05 \\\\\n  0.02  0.0  -0.02\n  \\end{bmatrix},\\quad\n  \\mu = 10.0,\\quad \\kappa = 300.0,\\quad \\varepsilon = 10^{-7}.\n  $$\n\n- 用例 $5$ ($d = 2$):\n  $$\n  \\boldsymbol{F} = \\begin{bmatrix}\n  1.0  0.5 \\\\\n  -0.4  1.1\n  \\end{bmatrix},\\quad\n  \\delta \\boldsymbol{F} = \\begin{bmatrix}\n  0.5  -0.2 \\\\\n  0.3  0.4\n  \\end{bmatrix},\\quad\n  \\mu = 60.0,\\quad \\kappa = 150.0,\\quad \\varepsilon = 10^{-7}.\n  $$\n\n要求的输出格式：您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $[r_1,r_2,r_3,r_4,r_5]$，其中每个 $r_i$ 是一个布尔值，指示相应的用例是否通过了能量平衡测试。不应打印任何其他文本。", "solution": "评估问题陈述是强制性的第一步。\n\n**步骤1：提取已知条件**\n- 变形梯度：$\\boldsymbol{F} \\in \\mathbb{R}^{d \\times d}$，其中 $d \\in \\{2,3\\}$。\n- 应变能密度函数：$W(\\boldsymbol{F}) = \\frac{\\mu}{2}\\left(I_1(\\boldsymbol{C}) - d\\right) - \\mu \\ln J + \\frac{\\kappa}{2}\\left(\\ln J\\right)^2$。\n- 右Cauchy-Green变形张量：$\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}$。\n- $\\boldsymbol{C}$ 的第一不变量：$I_1(\\boldsymbol{C}) = \\mathrm{tr}(\\boldsymbol{C})$。\n- 变形雅可比：$J = \\det(\\boldsymbol{F})$。\n- 材料参数：剪切模量 $\\mu > 0$，体积模量 $\\kappa > 0$。\n- 第一Piola-Kirchhoff应力张量定义：$\\boldsymbol{P}(\\boldsymbol{F}) = \\dfrac{\\partial W(\\boldsymbol{F})}{\\partial \\boldsymbol{F}}$。\n- 方向导数关系：$\\delta W(\\boldsymbol{F})[\\delta \\boldsymbol{F}] = \\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F}$。\n- 方向导数的有限差分近似：$D^{\\mathrm{FD}}W(\\boldsymbol{F})[\\delta \\boldsymbol{F}] = \\frac{W\\!\\left(\\boldsymbol{F} + \\varepsilon\\,\\delta \\boldsymbol{F}\\right) - W\\!\\left(\\boldsymbol{F} - \\varepsilon\\,\\delta \\boldsymbol{F}\\right)}{2\\,\\varepsilon}$。\n- 对称相对误差公式：$\\mathrm{err} = \\frac{\\left|\\,\\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F} - D^{\\mathrm{FD}}(W)[\\delta \\boldsymbol{F}]\\,\\right|}{\\left|\\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F}\\right| + \\left|D^{\\mathrm{FD}}(W)[\\delta \\boldsymbol{F}]\\right| + 10^{-12}}$。\n- 通过/失败标准：$\\mathrm{err} \\leq 10^{-6}$。\n- 提供了五个测试用例，每个用例都指定了矩阵 $\\boldsymbol{F}$、$\\delta \\boldsymbol{F}$ 和标量参数 $\\mu$、$\\kappa$、$\\varepsilon$。\n\n**步骤2：使用提取的已知条件进行验证**\n根据验证标准对问题进行审查。\n- **科学依据**：该问题植根于已建立的连续介质力学领域。可压缩Neo-Hookean模型是一种标准的超弹性材料模型。变形梯度 $\\boldsymbol{F}$、第一Piola-Kirchhoff应力 $\\boldsymbol{P}$ 的定义，以及通过泰勒测试验证能量平衡，都是计算力学中的基本概念。该问题是科学合理的。\n- **适定性**：问题定义清晰。它要求推导一个特定量 $\\boldsymbol{P}(\\boldsymbol{F})$，并根据一个明确定义的基准对其进行数值验证。所有必要的数据和公式都已提供。预期会得到一个唯一的、数值上稳定的结果（每个测试用例对应一个布尔值）。\n- **客观性**：问题以精确的数学语言陈述，没有任何主观性或歧义。\n- **完整性和一致性**：问题是自洽的。没有缺失的定义或矛盾的约束。为测试用例提供的数据是完整的。\n- **其他缺陷**：问题并非微不足道，因为它需要使用矩阵微积分进行正确推导。它不基于任何不切实际的前提或错误的逻辑。\n\n**步骤3：结论与行动**\n问题是**有效的**。这是连续介质力学中一个标准的、适定的练习。我们开始求解。\n\n目标是从给定的应变能密度 $W(\\boldsymbol{F})$ 推导出第一Piola-Kirchhoff应力张量 $\\boldsymbol{P}(\\boldsymbol{F})$，然后数值验证所推导表达式的正确性。推导必须从第一性原理出发，利用变分法。\n\n应变能密度函数为：\n$$\nW(\\boldsymbol{F}) = \\frac{\\mu}{2}\\left(I_1(\\boldsymbol{C}) - d\\right) - \\mu \\ln J + \\frac{\\kappa}{2}\\left(\\ln J\\right)^2\n$$\n其中 $\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}$，$I_1(\\boldsymbol{C}) = \\mathrm{tr}(\\boldsymbol{C})$，以及 $J = \\det(\\boldsymbol{F})$。\n\n第一Piola-Kirchhoff应力 $\\boldsymbol{P}$ 是 $W$ 相对于 $\\boldsymbol{F}$ 的导数，通过 $W$ 在任意方向 $\\delta \\boldsymbol{F}$ 上的方向导数（或Gâteaux导数）正式定义：\n$$\n\\delta W(\\boldsymbol{F})[\\delta \\boldsymbol{F}] = \\left.\\frac{d}{d\\alpha} W(\\boldsymbol{F} + \\alpha\\,\\delta \\boldsymbol{F})\\right|_{\\alpha=0} = \\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F}\n$$\n其中“:”表示矩阵的Frobenius内积，$A:B = \\mathrm{tr}(A^{\\mathsf{T}}B)$。\n\n我们通过应用链式法则来计算变分 $\\delta W$。为清晰起见，我们将 $W$ 分解为两部分：\n$W(\\boldsymbol{F}) = W_{iso}(\\boldsymbol{F}) + W_{vol}(\\boldsymbol{F})$，其中\n$W_{iso}(\\boldsymbol{F}) = \\frac{\\mu}{2}(\\mathrm{tr}(\\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}) - d)$ 是等容部分，而\n$W_{vol}(\\boldsymbol{F}) = -\\mu \\ln(\\det \\boldsymbol{F}) + \\frac{\\kappa}{2}(\\ln(\\det \\boldsymbol{F}))^2$ 是体积部分。\n总变分为 $\\delta W = \\delta W_{iso} + \\delta W_{vol}$。\n\n首先，我们求等容部分 $\\delta W_{iso}$ 的变分。\n$\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}$ 的变分为：\n$$\n\\delta \\boldsymbol{C} = \\delta(\\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}) = (\\delta \\boldsymbol{F})^{\\mathsf{T}}\\boldsymbol{F} + \\boldsymbol{F}^{\\mathsf{T}}(\\delta \\boldsymbol{F})\n$$\n第一不变量 $I_1(\\boldsymbol{C}) = \\mathrm{tr}(\\boldsymbol{C})$ 的变分为：\n$$\n\\delta I_1 = \\delta(\\mathrm{tr}(\\boldsymbol{C})) = \\mathrm{tr}(\\delta \\boldsymbol{C}) = \\mathrm{tr}((\\delta \\boldsymbol{F})^{\\mathsf{T}}\\boldsymbol{F} + \\boldsymbol{F}^{\\mathsf{T}}(\\delta \\boldsymbol{F})) = \\mathrm{tr}((\\delta \\boldsymbol{F})^{\\mathsf{T}}\\boldsymbol{F}) + \\mathrm{tr}(\\boldsymbol{F}^{\\mathsf{T}}(\\delta \\boldsymbol{F}))\n$$\n利用迹的循环性质 $\\mathrm{tr}(AB) = \\mathrm{tr}(BA)$ 和性质 $\\mathrm{tr}(A^{\\mathsf{T}}) = \\mathrm{tr}(A)$，我们有 $\\mathrm{tr}((\\delta \\boldsymbol{F})^{\\mathsf{T}}\\boldsymbol{F}) = \\mathrm{tr}(\\boldsymbol{F}^{\\mathsf{T}}\\delta \\boldsymbol{F})$。因此：\n$$\n\\delta I_1 = 2\\,\\mathrm{tr}(\\boldsymbol{F}^{\\mathsf{T}}(\\delta \\boldsymbol{F})) = 2\\,(\\boldsymbol{F} : \\delta \\boldsymbol{F})\n$$\n于是 $W_{iso}$ 的变分为：\n$$\n\\delta W_{iso} = \\frac{\\partial W_{iso}}{\\partial I_1} \\delta I_1 = \\frac{\\mu}{2} \\delta I_1 = \\frac{\\mu}{2} (2\\,\\boldsymbol{F} : \\delta \\boldsymbol{F}) = \\mu \\boldsymbol{F} : \\delta \\boldsymbol{F}\n$$\n通过与定义 $\\delta W_{iso} = \\boldsymbol{P}_{iso} : \\delta \\boldsymbol{F}$ 进行比较，我们确定了应力的等容部分：\n$$\n\\boldsymbol{P}_{iso}(\\boldsymbol{F}) = \\mu \\boldsymbol{F}\n$$\n\n接下来，我们求体积部分 $\\delta W_{vol}$ 的变分。\n令 $J = \\det(\\boldsymbol{F})$。$W_{vol}$ 关于 $J$ 的变分为：\n$$\n\\frac{\\partial W_{vol}}{\\partial J} = -\\frac{\\mu}{J} + \\frac{\\kappa}{2} \\cdot 2 (\\ln J) \\cdot \\frac{1}{J} = \\frac{\\kappa \\ln J - \\mu}{J}\n$$\n$W_{vol}$ 的变分由链式法则给出：$\\delta W_{vol} = \\frac{\\partial W_{vol}}{\\partial J} \\delta J$。\n行列式 $\\delta J$ 的变分由Jacobi公式给出：\n$$\n\\delta J = J\\,\\mathrm{tr}(\\boldsymbol{F}^{-1} \\delta \\boldsymbol{F})\n$$\n使用恒等式 $\\mathrm{tr}(A B) = (A^{\\mathsf{T}} : B)$，我们可以将其重写为：\n$$\n\\delta J = J\\,(\\boldsymbol{F}^{-\\mathsf{T}} : \\delta \\boldsymbol{F})\n$$\n将这些表达式代入 $W_{vol}$ 的变分中：\n$$\n\\delta W_{vol} = \\left(\\frac{\\kappa \\ln J - \\mu}{J}\\right) \\left(J\\,(\\boldsymbol{F}^{-\\mathsf{T}} : \\delta \\boldsymbol{F})\\right) = (\\kappa \\ln J - \\mu) \\boldsymbol{F}^{-\\mathsf{T}} : \\delta \\boldsymbol{F}\n$$\n通过与定义 $\\delta W_{vol} = \\boldsymbol{P}_{vol} : \\delta \\boldsymbol{F}$ 进行比较，我们确定了应力的体积部分：\n$$\n\\boldsymbol{P}_{vol}(\\boldsymbol{F}) = (\\kappa \\ln J - \\mu) \\boldsymbol{F}^{-\\mathsf{T}}\n$$\n\n总的第一Piola-Kirchhoff应力张量是等容部分和体积部分之和：\n$$\n\\boldsymbol{P}(\\boldsymbol{F}) = \\boldsymbol{P}_{iso}(\\boldsymbol{F}) + \\boldsymbol{P}_{vol}(\\boldsymbol{F}) = \\mu \\boldsymbol{F} + (\\kappa \\ln J - \\mu) \\boldsymbol{F}^{-\\mathsf{T}}\n$$\n这就是必须实现的应力张量的解析表达式。\n\n为了进行数值验证，我们实现了这个推导出的 $\\boldsymbol{P}(\\boldsymbol{F})$ 公式，并计算了解析方向导数 $\\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F}$。然后，我们按照规定，将这个值与使用中心有限差分格式的数值近似进行比较：\n$$\nD^{\\mathrm{FD}}W(\\boldsymbol{F})[\\delta \\boldsymbol{F}] = \\frac{W\\!\\left(\\boldsymbol{F} + \\varepsilon\\,\\delta \\boldsymbol{F}\\right) - W\\!\\left(\\boldsymbol{F} - \\varepsilon\\,\\delta \\boldsymbol{F}\\right)}{2\\,\\varepsilon}\n$$\n为每个测试用例计算对称相对误差：\n$$\n\\mathrm{err} = \\frac{\\left|\\,\\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F} - D^{\\mathrm{FD}}W(\\boldsymbol{F})[\\delta \\boldsymbol{F}]\\,\\right|}{\\left|\\boldsymbol{P}(\\boldsymbol{F}) : \\delta \\boldsymbol{F}\\right| + \\left|D^{\\mathrm{FD}}W(\\boldsymbol{F})[\\delta \\boldsymbol{F}]\\right| + 10^{-12}}\n$$\n如果此误差小于或等于容差 $\\mathrm{err} \\leq 10^{-6}$，则测试用例通过。实现将根据这些推导出的公式和步骤进行。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by deriving and verifying the First Piola-Kirchhoff stress\n    for a compressible Neo-Hookean material model.\n    \"\"\"\n\n    test_cases = [\n        # Case 1\n        {\n            \"F\": np.array([\n                [1.1, 0.2, -0.1],\n                [0.0, 0.9, 0.15],\n                [0.05, -0.08, 1.05]\n            ]),\n            \"delta_F\": np.array([\n                [0.3, -0.1, 0.2],\n                [-0.05, 0.25, -0.15],\n                [0.1, -0.2, 0.05]\n            ]),\n            \"mu\": 40.0, \"kappa\": 120.0, \"epsilon\": 1e-7\n        },\n        # Case 2\n        {\n            \"F\": np.array([\n                [1.3, 0.3, 0.0],\n                [0.1, 0.8, 0.2],\n                [0.0, -0.1, 1.2]\n            ]),\n            \"delta_F\": np.array([\n                [-0.2, 0.05, 0.1],\n                [0.15, -0.25, 0.05],\n                [-0.05, 0.1, -0.15]\n            ]),\n            \"mu\": 25.0, \"kappa\": 80.0, \"epsilon\": 1e-7\n        },\n        # Case 3\n        {\n            \"F\": np.array([\n                [0.85, 0.2],\n                [-0.1, 1.3]\n            ]),\n            \"delta_F\": np.array([\n                [0.1, -0.3],\n                [0.25, 0.15]\n            ]),\n            \"mu\": 40.0, \"kappa\": 120.0, \"epsilon\": 1e-7\n        },\n        # Case 4\n        {\n            \"F\": np.array([\n                [0.85, 0.0, 0.0],\n                [0.0, 0.85, 0.0],\n                [0.0, 0.0, 0.85]\n            ]),\n            \"delta_F\": np.array([\n                [-0.1, 0.05, 0.0],\n                [0.0, 0.1, -0.05],\n                [0.02, 0.0, -0.02]\n            ]),\n            \"mu\": 10.0, \"kappa\": 300.0, \"epsilon\": 1e-7\n        },\n        # Case 5\n        {\n            \"F\": np.array([\n                [1.0, 0.5],\n                [-0.4, 1.1]\n            ]),\n            \"delta_F\": np.array([\n                [0.5, -0.2],\n                [0.3, 0.4]\n            ]),\n            \"mu\": 60.0, \"kappa\": 150.0, \"epsilon\": 1e-7\n        }\n    ]\n\n    def calculate_W(F, mu, kappa):\n        \"\"\"\n        Computes the strain energy density W(F).\n        \"\"\"\n        d = F.shape[0]\n        C = F.T @ F\n        I1_C = np.trace(C)\n        J = np.linalg.det(F)\n\n        # A valid deformation must have J > 0.\n        if J = 0:\n            # Return a large value to indicate unphysical deformation.\n            # This is not strictly necessary for the given test cases but is good practice.\n            return np.inf\n\n        W = (mu / 2) * (I1_C - d) - mu * np.log(J) + (kappa / 2) * (np.log(J))**2\n        return W\n\n    def calculate_P(F, mu, kappa):\n        \"\"\"\n        Computes the First Piola-Kirchhoff stress tensor P(F) using the derived formula.\n        \"\"\"\n        J = np.linalg.det(F)\n        # It's an established result that d(det(A))/dA = det(A) * A^(-T)\n        F_inv_T = np.linalg.inv(F).T\n        P = mu * F + (kappa * np.log(J) - mu) * F_inv_T\n        return P\n\n    results = []\n    for case in test_cases:\n        F, delta_F, mu, kappa, epsilon = case[\"F\"], case[\"delta_F\"], case[\"mu\"], case[\"kappa\"], case[\"epsilon\"]\n\n        # 1. Analytical directional derivative: dW_analytic = P(F) : delta_F\n        P = calculate_P(F, mu, kappa)\n        dW_analytic = np.sum(P * delta_F)  # Frobenius inner product\n\n        # 2. Finite difference approximation of the directional derivative\n        F_plus = F + epsilon * delta_F\n        F_minus = F - epsilon * delta_F\n        \n        W_plus = calculate_W(F_plus, mu, kappa)\n        W_minus = calculate_W(F_minus, mu, kappa)\n\n        dW_fd = (W_plus - W_minus) / (2 * epsilon)\n\n        # 3. Compute symmetric relative error\n        abs_diff = np.abs(dW_analytic - dW_fd)\n        denominator = np.abs(dW_analytic) + np.abs(dW_fd) + 1e-12\n        err = abs_diff / denominator\n\n        # 4. Check against tolerance\n        passed = err = 1e-6\n        results.append(passed)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2587909"}]}