{"hands_on_practices": [{"introduction": "要准确模拟经历大位移和转动的结构，我们必须超越线性运动学。本练习的核心是计算变形梯度$F$，它是描述有限应变的关键。通过在一个标准三维单元中利用节点位移来计算$F$，你将把几何非线性的抽象概念转化为具体的计算步骤。[@problem_id:2597165]", "problem": "在三维固体力学的全拉格朗日 (TL) 有限元格式中，使用一个八节点三线性六面体单元来模拟运动学非线性变形（几何非线性）。其参考（未变形）构型为一个矩形块体，节点坐标在全局材料坐标系 $\\left(X,Y,Z\\right)$ 中给出：\n- 节点 $1$: $\\left(0,0,0\\right)$,\n- 节点 $2$: $\\left(2,0,0\\right)$,\n- 节点 $3$: $\\left(2,1,0\\right)$,\n- 节点 $4$: $\\left(0,1,0\\right)$,\n- 节点 $5$: $\\left(0,0,1.5\\right)$,\n- 节点 $6$: $\\left(2,0,1.5\\right)$,\n- 节点 $7$: $\\left(2,1,1.5\\right)$,\n- 节点 $8$: $\\left(0,1,1.5\\right)$.\n\n在坐标为 $\\left(\\xi,\\eta,\\zeta\\right)\\in[-1,1]^3$ 的母（等参）空间中，节点 1 到 8 分别位于标准符号组合 $\\left(\\xi_i,\\eta_i,\\zeta_i\\right)\\in\\{(-1,-1,-1),(+1,-1,-1),(+1,+1,-1),(-1,+1,-1),(-1,-1,+1),(+1,-1,+1),(+1,+1,+1),(-1,+1,+1)\\}$ 处。\n\n1) 从几何和位移均由相同的三线性形函数 $N_i\\left(\\xi,\\eta,\\zeta\\right)$ 插值的基本等参概念出发，根据节点坐标和形函数，推导该单元的显式等参映射 $\\left(X(\\xi,\\eta,\\zeta),Y(\\xi,\\eta,\\zeta),Z(\\xi,\\eta,\\zeta)\\right)$。请明确写出形函数。\n\n2) 在全拉格朗日框架下，当前位置为 $\\boldsymbol{x}\\left(\\boldsymbol{X}\\right)=\\boldsymbol{X}+\\boldsymbol{u}\\left(\\boldsymbol{X}\\right)$，变形梯度为 $\\boldsymbol{F}\\left(\\boldsymbol{X}\\right)=\\partial \\boldsymbol{x}/\\partial \\boldsymbol{X}$。使用相同的形函数插值位移场，节点位移（在全局基底下）数值上指定如下：\n- 节点 $1$: $\\left(0,0,0\\right)$,\n- 节点 $2$: $\\left(0.24,0.20,0.04\\right)$,\n- 节点 $3$: $\\left(0.39,0.15,0.11\\right)$,\n- 节点 $4$: $\\left(0.15,-0.05,0.07\\right)$,\n- 节点 $5$: $\\left(0.075,-0.045,0.12\\right)$,\n- 节点 $6$: $\\left(0.315,0.155,0.16\\right)$,\n- 节点 $7$: $\\left(0.465,0.105,0.23\\right)$,\n- 节点 $8$: $\\left(0.225,-0.095,0.19\\right)$.\n\n使用 TL 格式，在单元中心高斯点 $\\left(\\xi,\\eta,\\zeta\\right)=\\left(0,0,0\\right)$ 处计算变形梯度 $\\boldsymbol{F}$，并阐明几何非线性是如何通过运动学定义进入计算的。\n\n最后，报告中心高斯点处的标量体积比 $J=\\det\\left(\\boldsymbol{F}\\right)$。最终答案以无单位的纯数表示，并四舍五入到四位有效数字。", "solution": "经仔细审查，此问题陈述有效。其科学上基于非线性固体力学和有限元法的原理，所提供数据完整，问题提法适定，且表述客观、无歧义。因此，我将给出完整解答。\n\n该问题要求完成两项主要任务：首先，为参考构型推导等参映射；其次，对于给定的位移场，计算单元中心的变形梯度 $\\boldsymbol{F}$ 和体积比 $J$。\n\n**第 1 部分：参考构型的等参映射**\n\n等参概念规定，单元的几何形状由其节点坐标通过形函数插值得到，而这些形函数与用于插值位移场的形函数相同。对于一个八节点三线性六面体单元，与节点 $i$（母坐标为 $(\\xi_i, \\eta_i, \\zeta_i)$）相关的形函数 $N_i$ 由下式给出：\n$$\nN_i(\\xi, \\eta, \\zeta) = \\frac{1}{8}(1 + \\xi_i \\xi)(1 + \\eta_i \\eta)(1 + \\zeta_i \\zeta)\n$$\n其中 $(\\xi, \\eta, \\zeta) \\in [-1, 1]^3$。单元内任意点的材料坐标 $(X, Y, Z)$ 由节点坐标 $(\\boldsymbol{X}_i)$ 插值得到：\n$$\n\\boldsymbol{X}(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) \\boldsymbol{X}_i\n$$\n此矢量方程代表了坐标 $X$、$Y$ 和 $Z$ 的三个标量方程：\n$$\nX(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) X_i\n$$\n$$\nY(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) Y_i\n$$\n$$\nZ(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) Z_i\n$$\n利用所给的节点坐标 $(\\boldsymbol{X}_i)$ 和标准母坐标 $(\\xi_i, \\eta_i, \\zeta_i)$ 来求解显式映射。对于给定的矩形块体，该映射得以简化。对于坐标 $X$：\n$$\nX(\\xi, \\eta, \\zeta) = N_2(\\xi, \\eta, \\zeta)(2) + N_3(\\xi, \\eta, \\zeta)(2) + N_6(\\xi, \\eta, \\zeta)(2) + N_7(\\xi, \\eta, \\zeta)(2)\n$$\n代入形函数并分组化简，我们得到：\n$$\nX(\\xi, \\eta, \\zeta) = (1+\\xi)\n$$\n同理，对于坐标 $Y$ 和 $Z$：\n$$\nY(\\xi, \\eta, \\zeta) = N_3(1) + N_4(1) + N_7(1) + N_8(1) = \\frac{1}{2}(1+\\eta) = 0.5(1+\\eta)\n$$\n$$\nZ(\\xi, \\eta, \\zeta) = N_5(1.5) + N_6(1.5) + N_7(1.5) + N_8(1.5) = \\frac{1.5}{2}(1+\\zeta) = 0.75(1+\\zeta)\n$$\n因此，显式等参映射为：\n$$\nX(\\xi, \\eta, \\zeta) = 1 + \\xi\n$$\n$$\nY(\\xi, \\eta, \\zeta) = 0.5(1 + \\eta)\n$$\n$$\nZ(\\xi, \\eta, \\zeta) = 0.75(1 + \\zeta)\n$$\n\n**第 2 部分：变形梯度和体积比**\n\n在全拉格朗日 (TL) 格式中，变形梯度 $\\boldsymbol{F}$ 定义为当前位置矢量 $\\boldsymbol{x}$ 相对于初始材料坐标 $\\boldsymbol{X}$ 的梯度：\n$$\n\\boldsymbol{F} = \\frac{\\partial \\boldsymbol{x}}{\\partial \\boldsymbol{X}} = \\frac{\\partial (\\boldsymbol{X} + \\boldsymbol{u})}{\\partial \\boldsymbol{X}} = \\boldsymbol{I} + \\frac{\\partial \\boldsymbol{u}}{\\partial \\boldsymbol{X}}\n$$\n此处，$\\boldsymbol{u}$ 是位移矢量，$\\boldsymbol{I}$ 是二阶单位张量。$\\partial \\boldsymbol{u} / \\partial \\boldsymbol{X}$ 项是位移梯度张量。使用这个对任意大位移和转动都有效的精确运动学关系，是几何非线性的基础。\n\n为了计算关于材料坐标 $(X,Y,Z)$ 的导数，我们采用链式法则，将其与母坐标系 $(\\xi, \\eta, \\zeta)$ 中的导数联系起来：\n$$\n\\begin{Bmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\\\ \\frac{\\partial}{\\partial \\zeta} \\end{Bmatrix} = \\begin{bmatrix} \\frac{\\partial X}{\\partial \\xi} & \\frac{\\partial Y}{\\partial \\xi} & \\frac{\\partial Z}{\\partial \\xi} \\\\ \\frac{\\partial X}{\\partial \\eta} & \\frac{\\partial Y}{\\partial \\eta} & \\frac{\\partial Z}{\\partial \\eta} \\\\ \\frac{\\partial X}{\\partial \\zeta} & \\frac{\\partial Y}{\\partial \\zeta} & \\frac{\\partial Z}{\\partial \\zeta} \\end{bmatrix} \\begin{Bmatrix} \\frac{\\partial}{\\partial X} \\\\ \\frac{\\partial}{\\partial Y} \\\\ \\frac{\\partial}{\\partial Z} \\end{Bmatrix} = \\boldsymbol{J_0}^T \\begin{Bmatrix} \\frac{\\partial}{\\partial X} \\\\ \\frac{\\partial}{\\partial Y} \\\\ \\frac{\\partial}{\\partial Z} \\end{Bmatrix}\n$$\n矩阵 $\\boldsymbol{J_0}$ 是从母坐标到参考坐标映射的雅可比矩阵。其分量为 $(\\boldsymbol{J_0})_{ij} = \\partial X_i / \\partial \\xi_j$。根据第 1 部分推导的映射，我们计算 $\\boldsymbol{J_0}$：\n$$\n\\boldsymbol{J_0} = \\begin{bmatrix} \\frac{\\partial X}{\\partial \\xi} & \\frac{\\partial X}{\\partial \\eta} & \\frac{\\partial X}{\\partial \\zeta} \\\\ \\frac{\\partial Y}{\\partial \\xi} & \\frac{\\partial Y}{\\partial \\eta} & \\frac{\\partial Y}{\\partial \\zeta} \\\\ \\frac{\\partial Z}{\\partial \\xi} & \\frac{\\partial Z}{\\partial \\eta} & \\frac{\\partial Z}{\\partial \\zeta} \\end{bmatrix} = \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 0.5 & 0 \\\\ 0 & 0 & 0.75 \\end{bmatrix}\n$$\n由于该雅可比矩阵是常数矩阵，其值在任何地方（包括单元中心）都相同。我们需要它的逆矩阵来求解关于 $\\boldsymbol{X}$ 的导数：\n$$\n\\boldsymbol{J_0}^{-1} = \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & \\frac{1}{0.75} \\end{bmatrix} = \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & \\frac{4}{3} \\end{bmatrix}\n$$\n位移梯度 $\\nabla_{\\boldsymbol{X}}\\boldsymbol{u} = \\partial \\boldsymbol{u} / \\partial \\boldsymbol{X}$ 通过链式法则计算为 $\\nabla_{\\boldsymbol{X}}\\boldsymbol{u} = (\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u})(\\boldsymbol{J_0}^{-1})^T$，其中 $\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u} = \\partial \\boldsymbol{u} / \\partial \\boldsymbol{\\xi}$。由于 $\\boldsymbol{J_0}^{-1}$ 是对角矩阵，因此也是对称矩阵，所以 $(\\boldsymbol{J_0}^{-1})^T = \\boldsymbol{J_0}^{-1}$。\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial \\boldsymbol{X}} = \\left( \\frac{\\partial \\boldsymbol{u}}{\\partial \\boldsymbol{\\xi}} \\right) \\boldsymbol{J_0}^{-1}\n$$\n位移场相对于母坐标的梯度 $\\partial \\boldsymbol{u} / \\partial \\boldsymbol{\\xi}$ 通过对位移插值求导得到：\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial \\xi_j} (\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\xi_j} (\\xi, \\eta, \\zeta) \\boldsymbol{u}_i\n$$\n我们必须在单元中心 $(\\xi, \\eta, \\zeta) = (0,0,0)$ 处计算该值。形函数在该点的导数为：\n$$\n\\frac{\\partial N_i}{\\partial \\xi}\\bigg|_{(0,0,0)} = \\frac{1}{8}\\xi_i, \\quad \\frac{\\partial N_i}{\\partial \\eta}\\bigg|_{(0,0,0)} = \\frac{1}{8}\\eta_i, \\quad \\frac{\\partial N_i}{\\partial \\zeta}\\bigg|_{(0,0,0)} = \\frac{1}{8}\\zeta_i\n$$\n现在我们计算矩阵 $\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u} = [ \\partial u_k / \\partial \\xi_j ]$ 在 $(0,0,0)$ 处的分量。对于 $\\partial u_x / \\partial \\xi$：\n$\\frac{\\partial u_x}{\\partial \\xi} = \\frac{1}{8}\\sum_{i=1}^8 \\xi_i u_{ix} = \\frac{1}{8}[(-1)(0) + (1)(0.24) + (1)(0.39) + (-1)(0.15) + (-1)(0.075) + (1)(0.315) + (1)(0.465) + (-1)(0.225)] = \\frac{0.96}{8} = 0.12$\n按照此程序计算 $\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u}$ 的所有九个分量：\n$$\n\\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u} = \\begin{bmatrix} \\frac{\\partial u_x}{\\partial \\xi} & \\frac{\\partial u_x}{\\partial \\eta} & \\frac{\\partial u_x}{\\partial \\zeta} \\\\ \\frac{\\partial u_y}{\\partial \\xi} & \\frac{\\partial u_y}{\\partial \\eta} & \\frac{\\partial u_y}{\\partial \\zeta} \\\\ \\frac{\\partial u_z}{\\partial \\xi} & \\frac{\\partial u_z}{\\partial \\eta} & \\frac{\\partial u_z}{\\partial \\zeta} \\end{bmatrix} = \\begin{bmatrix} 0.12 & 0.075 & 0.0375 \\\\ 0.10 & -0.025 & -0.0225 \\\\ 0.02 & 0.035 & 0.06 \\end{bmatrix}\n$$\n现在，我们计算位移梯度 $\\nabla_{\\boldsymbol{X}}\\boldsymbol{u}$：\n$$\n\\nabla_{\\boldsymbol{X}}\\boldsymbol{u} = \\nabla_{\\boldsymbol{\\xi}}\\boldsymbol{u} \\boldsymbol{J_0}^{-1} = \\begin{bmatrix} 0.12 & 0.075 & 0.0375 \\\\ 0.10 & -0.025 & -0.0225 \\\\ 0.02 & 0.035 & 0.06 \\end{bmatrix} \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & \\frac{4}{3} \\end{bmatrix}\n$$\n$$\n\\nabla_{\\boldsymbol{X}}\\boldsymbol{u} = \\begin{bmatrix} (0.12)(1) & (0.075)(2) & (0.0375)(\\frac{4}{3}) \\\\ (0.10)(1) & (-0.025)(2) & (-0.0225)(\\frac{4}{3}) \\\\ (0.02)(1) & (0.035)(2) & (0.06)(\\frac{4}{3}) \\end{bmatrix} = \\begin{bmatrix} 0.12 & 0.15 & 0.05 \\\\ 0.10 & -0.05 & -0.03 \\\\ 0.02 & 0.07 & 0.08 \\end{bmatrix}\n$$\n那么变形梯度 $\\boldsymbol{F}$ 为：\n$$\n\\boldsymbol{F} = \\boldsymbol{I} + \\nabla_{\\boldsymbol{X}}\\boldsymbol{u} = \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} + \\begin{bmatrix} 0.12 & 0.15 & 0.05 \\\\ 0.10 & -0.05 & -0.03 \\\\ 0.02 & 0.07 & 0.08 \\end{bmatrix} = \\begin{bmatrix} 1.12 & 0.15 & 0.05 \\\\ 0.10 & 0.95 & -0.03 \\\\ 0.02 & 0.07 & 1.08 \\end{bmatrix}\n$$\n最后，标量体积比 $J$ 是变形梯度的行列式，$J = \\det(\\boldsymbol{F})$。\n$$\nJ = 1.12((0.95)(1.08) - (-0.03)(0.07)) - 0.15((0.10)(1.08) - (-0.03)(0.02)) + 0.05((0.10)(0.07) - (0.95)(0.02))\n$$\n$$\nJ = 1.12(1.026 + 0.0021) - 0.15(0.108 + 0.0006) + 0.05(0.007 - 0.019)\n$$\n$$\nJ = 1.12(1.0281) - 0.15(0.1086) + 0.05(-0.012)\n$$\n$$\nJ = 1.151472 - 0.01629 - 0.0006\n$$\n$$\nJ = 1.134582\n$$\n按要求四舍五入到四位有效数字，我们得到 $J = 1.135$。", "answer": "$$\n\\boxed{1.135}\n$$", "id": "2597165"}, {"introduction": "接下来，我们从运动学转向材料本构行为。对于超弹性等非线性材料，应力与应变之间的关系不再是简单的线性比例，这构成了材料非线性的基础。本练习将指导你从一个给定的应变能函数推导第二Piola-Kirchhoff应力$S$和一致切线模量$\\mathbb{C}$，这是实现稳健的非线性有限元求解器的关键一步。[@problem_id:2597193]", "problem": "考虑一个在有限元法中使用的超弹性可压缩 neo-Hookean 固体，其储存能量密度（每参考体积）是变形梯度 $F$ 的函数，具体表示为\n$$\nW(F) = \\frac{\\mu}{2}\\left(I_{1} - 3\\right) - \\mu \\,\\ln J + \\frac{\\kappa}{2}\\left(\\ln J\\right)^{2},\n$$\n其中 $C = F^{\\mathsf{T}} F$ 是右 Cauchy–Green 变形张量，$I_{1} = \\operatorname{tr}(C)$，$J = \\det(F)$，$\\mu$ 和 $\\kappa$ 是材料参数。第二 Piola–Kirchhoff 应力 $S$ 和 Green–Lagrange 应变 $E$ 通过 $E = \\tfrac{1}{2}(C - I)$ 和超弹性本构律 $S = 2\\,\\partial W/\\partial C$ 相关联。\n\n任务：\n- 从超弹性和张量微积分的原理出发，推导算法应力更新，即 $S$ 关于 $F$（或等价地 $C$）的显式表达式，且不引入任何近似。\n- 以闭合形式计算一致性材料切线 $\\mathbb{C} = \\partial S/\\partial E$，其为一个四阶张量。你可以使用标准的张量积；如果使用，请明确定义它们。\n- 为得到一个标量结果，将你的切线特殊化为均匀变形 $F = \\operatorname{diag}(\\lambda, 1, 1)$，并报告分量 $\\mathbb{C}_{1111}$ 作为关于 $\\lambda$、$\\mu$ 和 $\\kappa$ 的闭合形式解析表达式。\n\n答案规范：\n- 你最终报告的量必须是 $\\mathbb{C}_{1111}$ 关于 $\\lambda$、$\\mu$ 和 $\\kappa$ 的单一表达式。\n- 用符号形式表达你的最终答案。不要进行数值计算，也不要附加单位。", "solution": "我们从应力相对于右 Cauchy–Green 变形张量 $C = F^{\\mathsf{T}} F$ 的超弹性定义开始。对于一个储存能量 $W(C)$，第二 Piola–Kirchhoff 应力由下式给出\n$$\nS = 2\\,\\frac{\\partial W}{\\partial C}。\n$$\nGreen–Lagrange 应变为 $E = \\tfrac{1}{2}(C - I)$，因此关于 $E$ 的一致性材料切线为\n$$\n\\mathbb{C} = \\frac{\\partial S}{\\partial E} = 2\\,\\frac{\\partial S}{\\partial C}，\n$$\n因为 $\\partial/\\partial E = 2\\,\\partial/\\partial C$。\n\n所选的可压缩 neo-Hookean 能量为\n$$\nW(C) = \\frac{\\mu}{2}\\left(\\operatorname{tr}C - 3\\right) - \\mu\\,\\ln J + \\frac{\\kappa}{2}\\left(\\ln J\\right)^{2}，\n$$\n其中 $J = \\det(F)$。由于 $C = F^{\\mathsf{T}}F$ 且 $\\det(C) = J^{2}$，可得 $\\ln J = \\tfrac{1}{2}\\ln\\det C$。我们将需要以下针对对称正定张量 $C$ 的标准张量微积分恒等式：\n- 逆的变分：$\\mathrm{d}C^{-1} = -\\,C^{-1}\\,(\\mathrm{d}C)\\,C^{-1}$。\n- 对数雅可比行列式的变分：$\\mathrm{d}(\\ln J) = \\frac{1}{2}\\,C^{-1}:\\mathrm{d}C$，其中 $A:B = \\operatorname{tr}(A^{\\mathsf{T}} B)$ 表示双点积。\n\n第一步：计算 $S$。\n计算 $W$ 的一阶变分：\n$$\n\\mathrm{d}W = \\frac{\\mu}{2}\\,\\mathrm{d}(\\operatorname{tr}C) - \\mu\\,\\mathrm{d}(\\ln J) + \\kappa\\,\\ln J\\,\\mathrm{d}(\\ln J)。\n$$\n使用 $\\mathrm{d}(\\operatorname{tr}C) = I : \\mathrm{d}C$ 和 $\\mathrm{d}(\\ln J) = \\tfrac{1}{2} C^{-1}:\\mathrm{d}C$，\n$$\n\\mathrm{d}W = \\left[\\frac{\\mu}{2} I - \\frac{\\mu}{2} C^{-1} + \\frac{\\kappa}{2}\\,\\ln J\\,C^{-1}\\right] : \\mathrm{d}C。\n$$\n因此，\n$$\n\\frac{\\partial W}{\\partial C} = \\frac{\\mu}{2} I - \\frac{\\mu}{2} C^{-1} + \\frac{\\kappa}{2}\\,\\ln J\\,C^{-1}，\n$$\n从而\n$$\nS = 2\\,\\frac{\\partial W}{\\partial C} = \\mu\\,I - \\mu\\,C^{-1} + \\kappa\\,\\ln J\\,C^{-1}。\n$$\n这就是用 $C$（并因此通过 $C = F^{\\mathsf{T}}F$ 用 $F$）表示的精确算法应力更新，没有任何近似。它通过 $C^{-1}$ 和 $J$ 表现出几何非线性，并通过对不变量的非线性依赖表现出材料非线性。\n\n第二步：计算一致性切线 $\\mathbb{C} = \\partial S/\\partial E$。\n对 $S$ 求关于 $C$ 的微分：\n$$\n\\mathrm{d}S = -\\mu\\,\\mathrm{d}(C^{-1}) + \\kappa\\,\\mathrm{d}(\\ln J)\\,C^{-1} + \\kappa\\,\\ln J\\,\\mathrm{d}(C^{-1})。\n$$\n代入恒等式 $\\mathrm{d}C^{-1} = -\\,C^{-1}\\,(\\mathrm{d}C)\\,C^{-1}$ 和 $\\mathrm{d}(\\ln J) = \\frac{1}{2} C^{-1}:\\mathrm{d}C$ 得到\n$$\n\\mathrm{d}S = \\mu\\,C^{-1}(\\mathrm{d}C)C^{-1} + \\frac{\\kappa}{2}\\,(C^{-1}:\\mathrm{d}C)\\,C^{-1} - \\kappa\\,\\ln J\\,C^{-1}(\\mathrm{d}C)C^{-1}。\n$$\n合并同类项，\n$$\n\\mathrm{d}S = \\left(\\mu - \\kappa\\,\\ln J\\right)\\,C^{-1}(\\mathrm{d}C)C^{-1} + \\frac{\\kappa}{2}\\,(C^{-1}:\\mathrm{d}C)\\,C^{-1}。\n$$\n为表示线性映射 $\\mathrm{d}C \\mapsto \\mathrm{d}S$，引入以下四阶张量积：\n- 对于二阶张量 $A$ 和 $B$，定义非对称积 $(A \\otimes B)_{ijkl} = A_{ij} B_{kl}$，使得 $(A \\otimes B):X = A\\,(B:X)$。\n- 定义对称积（当作用于对称参数时，对于后两个指标的交换是对称的）$(A \\odot B)_{ijkl} = \\tfrac{1}{2}\\left(A_{ik}B_{jl} + A_{il}B_{jk}\\right)$，使得对于对称的 $X$，有 $(A \\odot B):X = \\tfrac{1}{2}\\left(A X B^{\\mathsf{T}} + A X^{\\mathsf{T}} B^{\\mathsf{T}}\\right) = A X B^{\\mathsf{T}}$。\n\n有了这些，关于 $C$ 的导数可以写成\n$$\n\\frac{\\partial S}{\\partial C} \\equiv \\mathbb{A} = \\left(\\mu - \\kappa\\,\\ln J\\right)\\,(C^{-1} \\odot C^{-1}) + \\frac{\\kappa}{2}\\,(C^{-1} \\otimes C^{-1})。\n$$\n由于 $\\mathbb{C} = \\partial S/\\partial E = 2\\,\\partial S/\\partial C$，我们得到一致性材料切线\n$$\n\\mathbb{C} = 2\\left(\\mu - \\kappa\\,\\ln J\\right)\\,(C^{-1} \\odot C^{-1}) + \\kappa\\,(C^{-1} \\otimes C^{-1})。\n$$\n这个四阶张量具有标准的主对称性，并且当限制在对称参数上时，具有由超弹性所要求的次对称性。\n\n第三步：特殊化为 $F = \\operatorname{diag}(\\lambda, 1, 1)$ 并计算 $\\mathbb{C}_{1111}$。\n对于此均匀变形，\n$$\nC = F^{\\mathsf{T}}F = \\operatorname{diag}(\\lambda^{2}, 1, 1), \\qquad C^{-1} = \\operatorname{diag}(\\lambda^{-2}, 1, 1), \\qquad J = \\det(F) = \\lambda。\n$$\n我们需要分量 $\\mathbb{C}_{1111}$。使用分量形式，\n$$\n(C^{-1} \\odot C^{-1})_{1111} = \\frac{1}{2}\\left(C^{-1}_{11} C^{-1}_{11} + C^{-1}_{11} C^{-1}_{11}\\right) = \\left(C^{-1}_{11}\\right)^{2} = \\lambda^{-4},\n$$\n和\n$$\n(C^{-1} \\otimes C^{-1})_{1111} = C^{-1}_{11}\\,C^{-1}_{11} = \\lambda^{-4}。\n$$\n因此，\n$$\n\\mathbb{C}_{1111} = 2\\left(\\mu - \\kappa\\,\\ln \\lambda\\right)\\lambda^{-4} + \\kappa\\,\\lambda^{-4} = \\left[2\\mu + \\kappa\\left(1 - 2\\ln \\lambda\\right)\\right]\\lambda^{-4}。\n$$\n这就是所要求的关于 $\\lambda$、$\\mu$ 和 $\\kappa$ 的单一闭合形式表达式。\n\n关于非线性来源的说明：$S$ 和 $\\mathbb{C}$ 对 $F$ 的依赖性通过 $C^{-1}$ 和 $J = \\det(F)$ 体现，从而产生几何非线性。本构关系对 $\\ln J$ 和乘法逆 $C^{-1}$ 的依赖性在材料响应中是内在非线性的，这代表了材料非线性。在此本构建模推导中不涉及边界非线性，但在有限元法的离散化过程中，非线性边界条件会增加一个额外的非线性来源，但这超出了本推导的讨论范围。", "answer": "$$\\boxed{\\left[2\\mu+\\kappa\\left(1-2\\ln \\lambda\\right)\\right]\\lambda^{-4}}$$", "id": "2597193"}, {"introduction": "实际工程问题常常同时涉及多种非线性来源。这个综合性练习将几何与材料非线性结合起来，要求你在一个有限应变薄膜单元中同时处理超弹性本构、不可压缩性以及平面应力约束。通过这个实践，你将看到前面练习中的基本概念如何在一个更接近实际的复杂模型中协同工作。[@problem_id:2597177]", "problem": "在一个有限应变运动学、平面应力超弹性和不可压缩约束的有限元法 (FEM) 设置中，实现一个单四节点等参膜单元。仅从运动学和超弹性的基本定义出发，推导出与不可压缩性一致的单元厚度更新法则，然后使用该法则为指定的本构定律计算平面内柯西应力。您的实现应计算变形梯度，强制执行平面应力和不可压缩性以确定厚度方向的拉伸，更新当前厚度，并为几个指定的均匀变形情况返回单元上的平均当前厚度和平均平面内柯西应力。\n\n您可以假设以下基本原理：\n- 变形运动学：变形梯度定义为 $F = \\partial x / \\partial X$。右柯西-格林变形张量定义为 $C = F^{T} F$，左柯西-格林张量定义为 $B = F F^{T}$。\n- 超弹性：对于超弹性材料，应力由应变能密度函数 $W(F)$ 导出。\n- 不可压缩性：不可压缩性的物理约束是 $J = \\det F = 1$。\n- 平面应力膜：平面外柯西应力分量 $\\sigma_{33}$ 为零，平面外剪切分量为零。单元运动学仅限于平面内变形，但必须更新平面外厚度以满足约束。\n\n需要实现的本构模型：\n- 具有剪切模量 $\\mu$（单位：帕斯卡）的不可压缩各向同性 Neo-Hookean 超弹性。Kirchhoff 应力 $\\tau$ 由 $\\tau = \\mu B - p I$ 给出，其中 $p$ 是强制不可压缩性的拉格朗日乘子， $I$ 是单位张量。在不可压缩条件下，柯西应力为 $\\sigma = \\tau$。\n\n单元和运动学：\n- 使用单个四节点双线性四边形单元，参考节点坐标位于 $(0,0)$, $(1,0)$, $(1,1)$, $(0,1)$，单位为米。假设一个形式为\n  $$\n  x = \\lambda_x X + \\gamma Y, \\quad y = \\lambda_y Y,\n  $$\n  的均匀平面内变形映射，其中 $\\lambda_x$ 和 $\\lambda_y$ 是指定的平面内主拉伸，$\\gamma$ 是指定的平面内简单剪切参数，均为无量纲。参考厚度为 $t_0$（单位：米）。\n- 通过标准等参映射，在 $2 \\times 2$ 高斯点处计算平面内变形梯度 $F_{2 \\times 2}$，并用它在每个高斯点评估平面内左柯西-格林张量 $B_{\\text{in}} = F_{2 \\times 2} F_{2 \\times 2}^{T}$。\n\n需要推导和实现的厚度更新法则：\n- 强制执行不可压缩性 $J = \\det F = 1$ 以及块对角膜运动学（无横向剪切），使得\n  $$\n  F = \\begin{bmatrix} F_{2 \\times 2} & 0 \\\\ 0 & \\lambda_3 \\end{bmatrix},\n  $$\n  因此\n  $$\n  \\det F = \\det(F_{2 \\times 2}) \\, \\lambda_3 = 1.\n  $$\n  用 $F_{2 \\times 2}$ 表示 $\\lambda_3$ 并相应地更新当前厚度 $t$。您必须以米为单位表示最终厚度 $t$。\n\n平面应力强制执行：\n- 施加 $\\sigma_{33} = 0$ 以消除拉格朗日乘子 $p$ 并获得平面内柯西应力的显式表达式。应力分量以帕斯卡表示。\n\n数值任务：\n- 实现一个函数，对于每个指定的 $(\\lambda_x, \\lambda_y, \\gamma, t_0, \\mu)$，从均匀映射构建当前节点位置，使用 $2 \\times 2$ 高斯积分法则计算 $F_{2 \\times 2}$，强制执行不可压缩性以更新厚度，强制执行平面应力以消除 $p$，并返回单元平均的当前厚度和平面内柯西应力分量 $(\\sigma_{xx}, \\sigma_{yy}, \\sigma_{xy})$。\n\n输出单位和格式：\n- 厚度必须以米为单位返回。\n- 应力分量必须以帕斯卡为单位返回。\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，形式为列表的列表\n  $$\n  [ [t,\\sigma_{xx},\\sigma_{yy},\\sigma_{xy}], \\dots ]\n  $$\n  其中每个子列表对应一个测试用例，并包含十进制浮点数。\n\n用于覆盖不同非线性和边界情况的测试套件：\n- 情况 1（$x$ 方向单轴拉伸）：$(\\lambda_x,\\lambda_y,\\gamma,t_0,\\mu) = (1.2, 1.0, 0.0, 1.0 \\times 10^{-3} \\ \\text{m}, 1.0 \\times 10^{6} \\ \\text{Pa})$。\n- 情况 2（双轴混合拉伸）：$(\\lambda_x,\\lambda_y,\\gamma,t_0,\\mu) = (0.9, 1.1, 0.0, 2.0 \\times 10^{-3} \\ \\text{m}, 0.5 \\times 10^{6} \\ \\text{Pa})$。\n- 情况 3（简单剪切）：$(\\lambda_x,\\lambda_y,\\gamma,t_0,\\mu) = (1.0, 1.0, 0.3, 1.0 \\times 10^{-3} \\ \\text{m}, 2.0 \\times 10^{6} \\ \\text{Pa})$。\n- 情况 4（强面积压缩）：$(\\lambda_x,\\lambda_y,\\gamma,t_0,\\mu) = (0.6, 0.7, 0.0, 5.0 \\times 10^{-4} \\ \\text{m}, 3.0 \\times 10^{6} \\ \\text{Pa})$。\n\n最终输出规范：\n- 您的程序应生成单行输出，包含结果，形式为由方括号括起来的、以逗号分隔的各用例结果列表，其中每个用例结果本身是一个列表 $[t,\\sigma_{xx},\\sigma_{yy},\\sigma_{xy}]$。例如：$[[t_1,\\sigma_{xx,1},\\sigma_{yy,1},\\sigma_{xy,1}],[t_2,\\sigma_{xx,2},\\sigma_{yy,2},\\sigma_{xy,2}],\\dots]$。", "solution": "该问题陈述经过了严格验证，被认为是有效的。它在科学上植根于连续介质力学和有限元法的原理，在数学上是适定的，并且用客观、明确的语言表述。它提出了一个非平凡的任务，要求在多个约束下正确推导和应用运动学和本构关系。因此，我们将进行正式的求解。\n\n目标是推导并实现一个在有限应变、平面应力和不可压缩性条件下的单四节点等参膜单元的本构更新。材料被指定为 Neo-Hookean 超弹性固体。\n\n首先，我们分析指定变形的运动学。问题定义了一个从参考构型坐标 $(X, Y)$ 到当前构型坐标 $(x, y)$ 的均匀平面内变形映射：\n$$\nx = \\lambda_x X + \\gamma Y\n$$\n$$\ny = \\lambda_y Y\n$$\n变形梯度张量 $F$ 的平面内分量，记为 $F_{2 \\times 2}$，通过对参考坐标求导获得：\n$$\nF_{2 \\times 2} = \\frac{\\partial (x, y)}{\\partial (X, Y)} = \\begin{bmatrix} \\frac{\\partial x}{\\partial X} & \\frac{\\partial x}{\\partial Y} \\\\ \\frac{\\partial y}{\\partial X} & \\frac{\\partial y}{\\partial Y} \\end{bmatrix} = \\begin{bmatrix} \\lambda_x & \\gamma \\\\ 0 & \\lambda_y \\end{bmatrix}\n$$\n尽管问题指定使用等参公式和高斯求积，但这个特定的变形映射是仿射的。对于参考坐标 $(\\xi, \\eta)$ 中的标准双单位正方形单元，这导致变形梯度 $F$ 在整个单元中是恒定的。因此，任何从 $F$ 导出的量，如应力和厚度，也将是均匀的。“单元平均”值就是这个恒定值，数值求积并非严格必要，但可以证实这种均匀性。\n\n问题指出，由于膜假设（无横向剪切），完整的三维变形梯度 $F$ 具有块对角结构：\n$$\nF = \\begin{bmatrix} F_{2 \\times 2} & \\mathbf{0} \\\\ \\mathbf{0}^T & \\lambda_3 \\end{bmatrix} = \\begin{bmatrix} \\lambda_x & \\gamma & 0 \\\\ 0 & \\lambda_y & 0 \\\\ 0 & 0 & \\lambda_3 \\end{bmatrix}\n$$\n其中 $\\lambda_3$ 是厚度方向的拉伸。\n\n接下来，我们强制执行不可压缩约束，$J = \\det F = 1$。\n$$\nJ = \\det(F_{2 \\times 2}) \\cdot \\lambda_3 = (\\lambda_x \\lambda_y) \\lambda_3 = 1\n$$\n由此，我们推导出平面外拉伸 $\\lambda_3$：\n$$\n\\lambda_3 = \\frac{1}{\\lambda_x \\lambda_y}\n$$\n膜的当前厚度 $t$ 由参考厚度 $t_0$ 通过此拉伸更新：\n$$\nt = \\lambda_3 t_0 = \\frac{t_0}{\\lambda_x \\lambda_y}\n$$\n这是所需的厚度更新法则。\n\n现在我们转向本构关系。材料是不可压缩的 Neo-Hookean 固体，其 Kirchhoff 应力 $\\tau$ 由 $\\tau = \\mu B - p I$ 给出。对于不可压缩材料，柯西应力 $\\sigma$ 等于 Kirchhoff 应力，所以 $\\sigma = \\mu B - p I$。这里，$B$ 是左柯西-格林变形张量，$B = FF^T$，$\\mu$ 是剪切模量，$p$ 是静水压力（强制不可压缩性的拉格朗日乘子），$I$ 是单位张量。\n\n我们计算 $B$：\n$$\nB = FF^T = \\begin{bmatrix} \\lambda_x & \\gamma & 0 \\\\ 0 & \\lambda_y & 0 \\\\ 0 & 0 & \\lambda_3 \\end{bmatrix} \\begin{bmatrix} \\lambda_x & 0 & 0 \\\\ \\gamma & \\lambda_y & 0 \\\\ 0 & 0 & \\lambda_3 \\end{bmatrix} = \\begin{bmatrix} \\lambda_x^2 + \\gamma^2 & \\gamma \\lambda_y & 0 \\\\ \\gamma \\lambda_y & \\lambda_y^2 & 0 \\\\ 0 & 0 & \\lambda_3^2 \\end{bmatrix}\n$$\n则柯西应力张量为：\n$$\n\\sigma = \\mu \\begin{bmatrix} \\lambda_x^2 + \\gamma^2 & \\gamma \\lambda_y & 0 \\\\ \\gamma \\lambda_y & \\lambda_y^2 & 0 \\\\ 0 & 0 & \\lambda_3^2 \\end{bmatrix} - p \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} = \\begin{bmatrix} \\mu(\\lambda_x^2 + \\gamma^2) - p & \\mu \\gamma \\lambda_y & 0 \\\\ \\mu \\gamma \\lambda_y & \\mu \\lambda_y^2 - p & 0 \\\\ 0 & 0 & \\mu \\lambda_3^2 - p \\end{bmatrix}\n$$\n需要施加的最后一个约束是平面应力条件，$\\sigma_{33} = 0$。这允许确定未知压力 $p$。\n$$\n\\sigma_{33} = \\mu \\lambda_3^2 - p = 0 \\implies p = \\mu \\lambda_3^2\n$$\n代入 $\\lambda_3 = 1/(\\lambda_x \\lambda_y)$，我们找到用指定的平面内变形表示的压力：\n$$\np = \\mu \\left( \\frac{1}{\\lambda_x \\lambda_y} \\right)^2 = \\frac{\\mu}{(\\lambda_x \\lambda_y)^2}\n$$\n最后，我们将这个 $p$ 的表达式代回到应力张量的平面内分量中，以获得它们的显式形式。令 $\\sigma_{xx} \\equiv \\sigma_{11}$，$\\sigma_{yy} \\equiv \\sigma_{22}$，$\\sigma_{xy} \\equiv \\sigma_{12}$。\n$$\n\\sigma_{xx} = \\mu(\\lambda_x^2 + \\gamma^2) - p = \\mu \\left( \\lambda_x^2 + \\gamma^2 - \\frac{1}{(\\lambda_x \\lambda_y)^2} \\right)\n$$\n$$\n\\sigma_{yy} = \\mu \\lambda_y^2 - p = \\mu \\left( \\lambda_y^2 - \\frac{1}{(\\lambda_x \\lambda_y)^2} \\right)\n$$\n$$\n\\sigma_{xy} = \\mu \\gamma \\lambda_y\n$$\n这些表达式提供了在指定条件下平面内柯西应力分量的完整描述。\n\n数值实现将通过对由元组 $(\\lambda_x, \\lambda_y, \\gamma, t_0, \\mu)$ 定义的每个测试用例直接应用这些推导出的解析公式来进行。计算并报告当前厚度 $t$ 和应力分量 $(\\sigma_{xx}, \\sigma_{yy}, \\sigma_{xy})$ 的结果。", "answer": "[[0.0008333333333333334,745555.5555555556,305555.5555555556,0.0],[0.0020202020202020203,-105152.02020202016,94847.97979797984,0.0],[0.001,180000.0,0.0,600000.0],[0.0011904761904761904,-15926802.721088435,-15536802.721088435,0.0]]", "id": "2597177"}]}