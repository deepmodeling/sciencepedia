{"hands_on_practices": [{"introduction": "我们首先通过一个概念性练习来建立直观认识。在深入研究数学细节之前，理解非相容模式单元旨在解决的实际问题至关重要：即简单单元在弯曲主导场景中的糟糕表现。本练习将挑战您比较标准单元、减缩积分单元和非相容模式单元在经典悬臂梁问题中的行为，促使您思考剪切锁定和沙漏模式等核心概念。[@problem_id:2568555]", "problem": "一根长的、细长的、平面应力悬臂梁，其长度为 $L$、高度为 $H$、厚度为 $t$（在平面外方向），在 $x=L$ 处承受一个恒定的端部弯矩 $M$，该弯矩引起绕 $z$ 轴的近乎纯弯曲。材料是线性弹性的，杨氏模量为 $E$，泊松比为 $\\nu$。精确的连续介质弯曲场（对于细长梁）具有沿深度线性变化的轴向应力 $\\sigma_{xx}(y)=\\dfrac{M}{I}\\,y$（其中 $I=\\dfrac{H^3 t}{12}$），以及内部可忽略不计的剪切应力 $\\sigma_{xy}\\approx 0$。\n\n在矩形域上使用等参双线性四边形单元的结构化网格对梁进行离散化。考虑三种单元/积分方案：\n- 标准双线性 $Q4$ 单元，使用 $2\\times 2$ 点的完全高斯积分。\n- 减缩积分双线性 $Q4$ 单元，使用 $1\\times 1$ 点（无沙漏控制）。\n- 采用非相容模式（Wilson–Taylor 型）增强的双线性 $Q4$ 单元，在单元层面进行凝聚，并使用 $2\\times 2$ 点进行积分。\n\n沿着位于某个固定位置 $x=x_c$（其中 $0<x_c<L$）的垂直切面，当工程师绘制高斯点应力或外插节点应力与 $y$ 的关系图时，常常会观察到点状轴向应力 $\\sigma_{xx}(y)$ 出现单元间的振荡。\n\n关于这些振荡的相对大小及其潜在机理，下列哪项/些陈述与有限元法的基本原理最为一致？\n\nA. 在弯曲主导的状态下，标准的完全积分 $Q4$ 单元倾向于在 $\\sigma_{xx}(y)$ 中产生显著的单元间振荡，因为 $u_y$ 中精确的关于 $x$ 的二次分量无法由双线性场表示，从而导致寄生剪切/薄膜应变和单元间应力跳跃；减缩积分 $Q4$ 通过对寄生刚度的低估积分通常会减小振荡幅度，但存在沙漏模式的风险；带有非相容模式的 $Q4$ 单元通过改善对曲率引起的应变梯度的表示，产生最平滑且最准确的应力分布，同时不引入伪零能模式。\n\nB. 在弯曲作用下，标准 $Q4$ 单元振荡的主要原因是体积锁定；因此，当 $\\nu\\to 0$ 时，无论积分规则如何，振荡都会消失。\n\nC. 减缩积分完全消除了弯曲中的振荡，因为它精确地积分了双线性刚度；因此，在承受纯弯曲的规则网格上，它不会出现沙漏现象。\n\nD. 非相容模式增强通过增广内部应变场来减少振荡，其方法是增加在单元边界上消失的泡状位移模式，这保持了单元间的 $C^0$ 连续性，同时提高了单元表示曲率的能力；这减轻了寄生剪切/薄膜应变，并且不会产生沙漏模式。\n\nE. 如果沿深度 $H$ 仅使用单个单元 ($N_h=1$)，那么在纯弯曲下，这三种公式会产生基本相同的点状轴向应力，因为它们共享相同的边界节点自由度。\n\n选择所有适用选项。", "solution": "用户提供了一个关于不同有限元公式在纯弯曲梁中的行为的问题陈述。我将首先验证该问题陈述，然后进行详细的解答。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **物理系统**：一根长的、细长的、平面应力悬臂梁。尺寸：长度 $L$、高度 $H$、厚度 $t$。\n- **载荷**：在 $x=L$ 处施加恒定端部弯矩 $M$，引起近乎纯弯曲。\n- **材料属性**：线性弹性，杨氏模量为 $E$，泊松比为 $\\nu$。\n- **解析解（细长梁）**：轴向应力 $\\sigma_{xx}(y)=\\dfrac{M}{I}\\,y$，其中 $I=\\dfrac{H^3 t}{12}$。剪切应力 $\\sigma_{xy}\\approx 0$。\n- **有限元模型**：在矩形域上使用等参双线性四边形 ($Q4$) 单元的结构化网格。\n- **单元/积分方案**：\n    1. 标准双线性 $Q4$ 单元，采用完全 $2\\times 2$ 高斯积分。\n    2. 减缩积分双线性 $Q4$ 单元，采用单点 $1\\times 1$ 高斯积分 ($Q4/1$)。\n    3. 采用非相容模式（例如 Wilson-Taylor 型）增强的双线性 $Q4$ 单元，并采用 $2\\times 2$ 点积分 ($Q4I$)。\n- **关注的现象**：沿垂直切面 $x=x_c$ 观察到的点状轴向应力 $\\sigma_{xx}(y)$ 的单元间振荡。\n\n**步骤2：使用已知条件进行验证**\n- **科学依据**：该问题坚实地建立在有限元法和线性弹性的既有理论基础之上。剪切锁定、减缩积分、沙漏以及双线性四边形单元的非相容模式等概念是计算力学中的标准课题。所描述的情景是用于评估单元性能的经典基准问题。该问题在科学上是合理的。\n- **适定性**：该问题要求基于有限元原理对几个陈述进行定性评估。这是一个适定问题，因为对这些单元在弯曲下的行为进行明确分析是可能的，并且可以对给定陈述的正确性得出明确的结论。\n- **客观性**：所用语言技术性强、精确且客观。使用的术语在该领域内具有明确的、公认的含义。\n- **完整性与一致性**：问题陈述是自洽的，提供了足够的信息来分析不同单元公式的内在力学行为。不存在矛盾。\n\n**步骤3：结论与行动**\n问题陈述是有效的。这是一个在高等固体力学和有限元分析中标准的、结构良好的问题。我将继续进行详细的推导和解答。\n\n### 推导与分析\n\n该问题关注低阶有限元精确模拟纯弯曲状态的能力。根据 Euler-Bernoulli 梁理论，承受端部弯矩 $M$ 的悬臂梁的精确位移场为：\n$$u_x(x,y) = -\\frac{M}{EI}xy$$\n$$u_y(x,y) = \\frac{M}{2EI}x^2 + \\frac{\\nu M}{2EI}y^2 + \\text{刚体运动项}$$\n其关键特征是轴向位移 $u_x$ 是关于 $x$ 和 $y$ 的双线性函数，而横向位移 $u_y$ 是关于 $x$ 的二次函数。相应的应变为 $\\epsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = -\\frac{M}{EI}y$，$\\epsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = \\frac{\\nu M}{EI}y$，以及剪应变 $\\gamma_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} = (-\\frac{M}{EI}x) + (\\frac{M}{EI}x) = 0$。轴向应力为 $\\sigma_{xx} \\approx E \\epsilon_{xx} = -\\frac{M}{I}y$（为简化起见，这里假设为平面应力且 $\\nu=0$，但该论证对普适的 $\\nu$ 依然成立），该应力是关于 $y$ 的线性函数。\n\n1.  **标准双线性 Q4 单元（完全积分）**\n    一个标准的等参 $Q4$ 单元，其每个分量的位移场形式为 $u(\\xi, \\eta) = a_0 + a_1\\xi + a_2\\eta + a_3\\xi\\eta$，其中 $\\xi$ 和 $\\eta$ 是局部坐标。对于与 $x,y$ 轴对齐的矩形网格，$\\xi$ 与 $x$ 成正比，$\\eta$ 与 $y$ 成正比。该单元可以精确表示双线性的 $u_x$ 场。然而，它无法表示二次的 $u_y(x) \\propto x^2$ 场。为了近似所需的曲率，单元边缘必须弯曲，但它们被约束保持为直线。当这些单元的集合体弯曲时，每个单元会变形成为一种会产生伪非零剪应变 $\\gamma_{xy}^{spurious} \\neq 0$ 的形状。这是因为有限元近似中的 $\\frac{\\partial u_y}{\\partial x}$ 项不能像它应该的那样，精确地抵消 $\\frac{\\partial u_x}{\\partial y}$ 项。这种伪剪应变会产生人为的剪切应力，并贡献一个大的、非物理的应变能项，使单元在弯曲时表现得过刚。这种现象被称为**剪切锁定**。这种过度的刚度导致位移和应力结果不佳，表现为应力场中从一个单元到下一个单元的剧烈振荡，因为单元在努力适应弯曲变形。\n\n2.  **减缩积分 Q4 单元 (Q4/1)**\n    此公式使用单元中心（$\\xi=0, \\eta=0$）的单个高斯点来计算应变和建立刚度矩阵。对于弯曲下的矩形单元，寄生剪应变场 $\\gamma_{xy}^{spurious}$ 恰好在单元中心为零。通过仅使用这一点来计算应变能积分，寄生剪切的贡献被完全忽略。这“解锁”了单元，使其在弯曲主导的问题中变得更加柔和、更加准确。与锁定相关的剧烈应力振荡被大大减少。然而，这带来了代价。单个积分点无法“感知”某些变形模式，这些模式被称为**沙漏模式**或零能模式。这些是伪变形模式，它们在单元中心不产生应变，因此没有相关的刚度。如果被激发，它们会用无意义的振荡来破坏解。\n\n3.  **带有非相容模式的 Q4 单元 (Q4I)**\n    这种先进的公式增强了单元的运动学特性。标准的双线性位移场被内部的“泡状”函数所增广，这些函数在单元边界上为零。对于弯曲问题，关键的模式具有 $(1-\\xi^2)$ 和 $(1-\\eta^2)$ 的形式。例如，用一个与 $(1-\\xi^2)$ 成比例的模式来丰富 $u_y$ 场，可以使单元在内部表示位移的二次变化。这提供了模拟纯弯曲曲率所需的运动学自由度，而不会引起寄生剪应变。由于增强模式在单元边界处为零，与相邻单元的 $C^0$-连续性得以保持。与这些模式相关的内部参数在单元层面被凝聚掉。该单元使用完全 $2\\times 2$ 积分进行计算，这提供了正确的刚度，并确保沙漏模式具有正应变能，因此被抑制。这种公式成功地解决了剪切锁定问题，而没有引入减缩积分的不稳定性，从而得到平滑且高度精确的应力解。\n\n### 逐项分析\n\n**A. 在弯曲主导的状态下，标准的完全积分 $Q4$ 单元倾向于在 $\\sigma_{xx}(y)$ 中产生显著的单元间振荡，因为 $u_y$ 中精确的关于 $x$ 的二次分量无法由双线性场表示，从而导致寄生剪切/薄膜应变和单元间应力跳跃；减缩积分 $Q4$ 通过对寄生刚度的低估积分通常会减小振荡幅度，但存在沙漏模式的风险；带有非相容模式的 $Q4$ 单元通过改善对曲率引起的应变梯度的表示，产生最平滑且最准确的应力分布，同时不引入伪零能模式。**\n这个陈述提供了一个完整而准确的总结。它正确地指出了标准 $Q4$ 单元的运动学缺陷是寄生剪切（剪切锁定）和应力振荡的原因。它正确地描述了减缩积分的权衡（以沙漏风险为代价减少锁定）。它还正确地描述了非相容模式单元的卓越性能，该单元通过丰富运动学来精确表示曲率，同时使用完全积分来避免伪模式。\n**结论：正确。**\n\n**B. 在弯曲作用下，标准 Q4 单元振荡的主要原因是体积锁定；因此，当 $\\nu\\to 0$ 时，无论积分规则如何，振荡都会消失。**\n这个陈述是不正确的。该问题中的主要锁定机制是**剪切锁定**，它源于单元无法模拟纯弯曲变形。**体积锁定**发生在近不可压缩材料中（当泊松比 $\\nu \\to 0.5$ 时），与此特定问题无关，除非 $\\nu$ 非常高。剪切锁定即使在 $\\nu=0$ 时也依然存在，因为它与剪切模量 $G = E/(2(1+\\nu))$ 相关，而该模量保持为有限值。\n**结论：不正确。**\n\n**C. 减缩积分完全消除了弯曲中的振荡，因为它精确地积分了双线性刚度；因此，在承受纯弯曲的规则网格上，它不会出现沙漏现象。**\n这个陈述包含多个错误。首先，减缩积分并不能“精确地积分”双线性刚度矩阵；要精确积分矩形 $Q4$ 单元的刚度矩阵，需要完全（$2\\times 2$）求积。减缩积分之所以有效，恰恰是因为它*不精确地*积分刚度，从而未能捕捉到寄生剪切能。其次，虽然它显著减少了由锁定引起的振荡，但并不能“完全消除”它们；所产生的单元内应力恒定的分布本身就是一种振荡形式（阶梯状近似）。第三，虽然在完美的网格上进行纯弯曲可能不会激发沙漏模式，但该单元公式在更一般的情况下从根本上是易受其影响的。该陈述错误地表述了其基本原理。\n**结论：不正确。**\n\n**D. 非相容模式增强通过增广内部应变场来减少振荡，其方法是增加在单元边界上消失的泡状位移模式，这保持了单元间的 $C^0$ 连续性，同时提高了单元表示曲率的能力；这减轻了寄生剪切/薄膜应变，并且不会产生沙漏模式。**\n这个陈述对非相容模式方法给出了精确而准确的描述。位移场通过内部模式（在单元边界上为零的函数，从而保持 $C^0$ 连续性）得到增广。这种增强直接提高了单元表示曲率的能力。结果是，寄生剪切的根源被消除。该单元采用完全积分，能正确捕捉所有变形模式的能量，因此不会遭受沙漏问题。\n**结论：正确。**\n\n**E. 如果沿深度 $H$ 仅使用单个单元 ($N_h=1$)，那么在纯弯曲下，这三种公式会产生基本相同的点状轴向应力，因为它们共享相同的边界节点自由度。**\n这个陈述是不正确的。由于积分规则和/或运动学假设的不同，这三种公式具有根本不同的单元刚度矩阵 ($[K_e]$)。对于给定的施加载荷，系统方程 $[K][U]=[F]$ 将为每种公式产生不同的节点位移向量 $[U]$。因此，由这些位移计算出的应力（例如 $\\boldsymbol{\\sigma}=[D][B][U]$）也将不同。开发 $Q4/1$ 和 $Q4I$ 单元的根本动机就是因为它们在弯曲中产生的结果优于标准 $Q4$ 单元，而且这种差异并不会因为网格在某个方向上粗糙而消失。标准 $Q4$ 单元的剪切锁定问题依然存在。\n**结论：不正确。**", "answer": "$$\\boxed{AD}$$", "id": "2568555"}, {"introduction": "在建立了概念动机之后，我们现在转向一个基本的计算，以确切地了解非相容模式是如何运作的。本练习要求您计算为一个板单元的弯曲公式添加一个特定的非相容模式所产生的影响。通过完成静力凝聚过程，您将量化由此产生的刚度变化，从而提供一个具体的例子，说明这些模式如何“软化”单元以更好地模拟弯曲变形。[@problem_id:2568518]", "problem": "在有限元法 (FEM) 中，考虑一个用于模拟薄板弯曲的四节点等参四边形单元，该薄板由 Mindlin–Reissner 理论建模，并占据 $x$–$y$ 平面中的单位正方形域 $\\Omega = [0,1] \\times [0,1]$。仅关注能量的弯曲部分（忽略横向剪切）。设板的弯曲本构矩阵为\n$$\n\\mathbf{D}_{b} \\;=\\; D_{0}\\begin{bmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{bmatrix},\n$$\n归一化为 $D_{0} = 1$ 和 $\\nu = 0$，因此 $\\mathbf{D}_{b} = \\mathrm{diag}(1,\\,1,\\,\\tfrac{1}{2})$。弯曲应变（曲率）由转角 $\\theta_{x}(x,y)$ 和 $\\theta_{y}(x,y)$ 定义为\n$$\n\\kappa_{x} = -\\frac{\\partial \\theta_{x}}{\\partial x}, \\quad\n\\kappa_{y} = -\\frac{\\partial \\theta_{y}}{\\partial y}, \\quad\n\\kappa_{xy} = -\\frac{\\partial \\theta_{x}}{\\partial y} - \\frac{\\partial \\theta_{y}}{\\partial x}.\n$$\n设协调转角由节点值双线性插值得到，并考虑对应于绕 $y$ 轴的均匀曲率的特定协调弯曲模式：\n$$\n\\theta_{x}^{c}(x,y) = x, \\qquad \\theta_{y}^{c}(x,y) = 0,\n$$\n该模式可以通过在 $\\Omega$ 上进行双线性插值精确表示，方法是为 $\\theta_{x}$ 分配与 $x$ 坐标相等的节点值，为 $\\theta_{y}$ 分配零节点值。用一个形式如下的标量非协调内部模式 $a \\in \\mathbb{R}$ 来增强该单元\n$$\n\\theta_{x}^{i}(x,y) = a\\,x\\,y, \\qquad \\theta_{y}^{i}(x,y) = 0,\n$$\n该模式将通过单元级的静力凝聚法消除。用 $\\mathbf{K}_{cc}$ 表示与协调自由度相关的协调（凝聚后）弯曲刚度，用 $\\mathbf{K}_{ii}$ 表示单个非协调模式的自刚度，用 $\\mathbf{K}_{ci}$、$\\mathbf{K}_{ic}$ 表示耦合块。使用弯曲能量泛函\n$$\n\\Pi_{b}(\\theta_{x},\\theta_{y}) \\;=\\; \\frac{1}{2}\\int_{\\Omega} \\boldsymbol{\\kappa}^{T}\\,\\mathbf{D}_{b}\\,\\boldsymbol{\\kappa}\\, \\mathrm{d}A,\n$$\n针对上述场，计算标量二次型\n$$\nq^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q,\n$$\n其中 $q$ 是再现 $\\theta_{x}^{c}(x,y)=x$，$\\theta_{y}^{c}(x,y)=0$ 的协调节点向量。然后通过以下比率来量化沿此模式的弯曲刚度变化\n$$\nr \\;=\\; \\frac{q^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q}{q^{T}\\mathbf{K}_{cc}q}.\n$$\n将 $r$ 精确计算为一个实数。最终答案表示为无单位的精确数。无需四舍五入。", "solution": "所述问题具有科学依据，是适定的、客观的且自洽的。这是有限元法理论中一个关于非相容模式和静力凝聚法的标准问题。所有必要的数据和定义都已提供。该问题是有效的，并且存在唯一解。我们开始求解。\n\n任务是计算比率 $r$，其定义如下：\n$$\nr \\;=\\; \\frac{q^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q}{q^{T}\\mathbf{K}_{cc}q}\n$$\n此表达式中的各项源于单元的弯曲能量泛函 $\\Pi_b$。总转角场是协调部分和非协调部分之和，其中协调部分由节点自由度 $q$ 插值得到，非协调部分由内部自由度 $a$ 参数化。设转角场为 $\\boldsymbol{\\theta} = (\\theta_x, \\theta_y)$。应变向量 $\\boldsymbol{\\kappa} = (\\kappa_x, \\kappa_y, \\kappa_{xy})$ 通过微分算子从 $\\boldsymbol{\\theta}$ 导出，我们记作 $\\boldsymbol{\\kappa} = \\mathcal{L}(\\boldsymbol{\\theta})$。此关系是线性的。因此，总应变可以分解为 $\\boldsymbol{\\kappa} = \\boldsymbol{\\kappa}^c + \\boldsymbol{\\kappa}^i$，其中 $\\boldsymbol{\\kappa}^c = \\mathcal{L}(\\boldsymbol{\\theta}^c)$ 且 $\\boldsymbol{\\kappa}^i = \\mathcal{L}(\\boldsymbol{\\theta}^i)$。\n\n弯曲能量泛函由下式给出：\n$$\n\\Pi_{b} \\;=\\; \\frac{1}{2}\\int_{\\Omega} \\boldsymbol{\\kappa}^{T}\\,\\mathbf{D}_{b}\\,\\boldsymbol{\\kappa}\\, \\mathrm{d}A\n$$\n代入分解后的应变，我们得到：\n$$\n\\Pi_{b} \\;=\\; \\frac{1}{2}\\int_{\\Omega} (\\boldsymbol{\\kappa}^c + \\boldsymbol{\\kappa}^i)^{T}\\,\\mathbf{D}_{b}\\,(\\boldsymbol{\\kappa}^c + \\boldsymbol{\\kappa}^i)\\, \\mathrm{d}A \\;=\\; \\frac{1}{2}\\int_{\\Omega} \\left( (\\boldsymbol{\\kappa}^c)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c + 2 (\\boldsymbol{\\kappa}^c)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^i + (\\boldsymbol{\\kappa}^i)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^i \\right) \\mathrm{d}A\n$$\n应变场通过应变-位移矩阵 $\\mathbf{B}_c$ 和 $\\mathbf{B}_i$ 与自由度 $q$ 和 $a$ 相关，使得 $\\boldsymbol{\\kappa}^c = \\mathbf{B}_c q$ 和 $\\boldsymbol{\\kappa}^i = \\mathbf{B}_i a$。能量可以写成矩阵形式：\n$$\n\\Pi_{b} \\;=\\; \\frac{1}{2} q^T \\mathbf{K}_{cc} q + q^T \\mathbf{K}_{ci} a + \\frac{1}{2} a^T \\mathbf{K}_{ii} a\n$$\n其中，刚度子矩阵由在单元域 $\\Omega$ 上的积分定义：\n$\\mathbf{K}_{cc} = \\int_{\\Omega} \\mathbf{B}_c^T \\mathbf{D}_b \\mathbf{B}_c \\mathrm{d}A$, $\\mathbf{K}_{ci} = \\int_{\\Omega} \\mathbf{B}_c^T \\mathbf{D}_b \\mathbf{B}_i \\mathrm{d}A$, and $\\mathbf{K}_{ii} = \\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_i \\mathrm{d}A$.\n\n比率 $r$ 中的二次型可以直接用应变场表示：\n分母是 $q^T \\mathbf{K}_{cc} q = \\int_{\\Omega} (\\mathbf{B}_c q)^T \\mathbf{D}_b (\\mathbf{B}_c q) \\mathrm{d}A = \\int_{\\Omega} (\\boldsymbol{\\kappa}^c)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c \\mathrm{d}A$。\n对于分子，由于 $a$ 是一个标量自由度，$\\mathbf{K}_{ii}$ 是一个 $1 \\times 1$ 矩阵（一个标量），$\\mathbf{K}_{ic}$ 是一个 $1 \\times N$ 的行向量（其中 $N$ 是 $q$ 的大小），而 $\\mathbf{K}_{ci} = \\mathbf{K}_{ic}^T$ 是一个 $N \\times 1$ 的列向量。分子变为：\n$$\nq^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q = \\frac{(q^T \\mathbf{K}_{ci})(\\mathbf{K}_{ic} q)}{\\mathbf{K}_{ii}} = \\frac{(\\mathbf{K}_{ic}q)^2}{\\mathbf{K}_{ii}}\n$$\n其中 $\\mathbf{K}_{ic} q = \\left(\\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_c \\mathrm{d}A\\right) q = \\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b (\\mathbf{B}_c q) \\mathrm{d}A = \\int_{\\Omega} (\\mathbf{B}_i^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c) \\mathrm{d}A$。另外，$\\mathbf{K}_{ii}$ 是标量积分 $\\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_i \\mathrm{d}A$。\n因此，分子是：\n$$\nq^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q = \\frac{\\left( \\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c \\mathrm{d}A \\right)^2}{\\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_i \\mathrm{d}A}\n$$\n\n现在我们使用提供的数据计算必要的组成部分。\n域为 $\\Omega = [0,1] \\times [0,1]$。\n本构矩阵为 $\\mathbf{D}_{b} = \\mathrm{diag}(1, 1, \\frac{1}{2})$。\n\n首先，确定应变场。\n协调转角场为 $\\theta_{x}^{c}(x,y) = x$ 和 $\\theta_{y}^{c}(x,y) = 0$。相应的协调应变（曲率）为：\n$$\n\\boldsymbol{\\kappa}^c = \\begin{pmatrix} -\\frac{\\partial \\theta_{x}^{c}}{\\partial x} \\\\ -\\frac{\\partial \\theta_{y}^{c}}{\\partial y} \\\\ -\\frac{\\partial \\theta_{x}^{c}}{\\partial y} - \\frac{\\partial \\theta_{y}^{c}}{\\partial x} \\end{pmatrix} = \\begin{pmatrix} -\\frac{\\partial (x)}{\\partial x} \\\\ -\\frac{\\partial (0)}{\\partial y} \\\\ -\\frac{\\partial (x)}{\\partial y} - \\frac{\\partial (0)}{\\partial x} \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n非协调转角场为 $\\theta_{x}^{i}(x,y) = a\\,x\\,y$ 和 $\\theta_{y}^{i}(x,y) = 0$。相应的非协调应变为：\n$$\n\\boldsymbol{\\kappa}^i = \\begin{pmatrix} -\\frac{\\partial (a\\,x\\,y)}{\\partial x} \\\\ -\\frac{\\partial (0)}{\\partial y} \\\\ -\\frac{\\partial (a\\,x\\,y)}{\\partial y} - \\frac{\\partial (0)}{\\partial x} \\end{pmatrix} = \\begin{pmatrix} -a\\,y \\\\ 0 \\\\ -a\\,x \\end{pmatrix} = a \\begin{pmatrix} -y \\\\ 0 \\\\ -x \\end{pmatrix}\n$$\n由此，我们确定非协调应变形状矩阵 $\\mathbf{B}_i = \\begin{pmatrix} -y \\\\ 0 \\\\ -x \\end{pmatrix}$。\n\n现在，我们计算积分。\n1. $r$ 的分母：$q^T \\mathbf{K}_{cc} q = \\int_{\\Omega} (\\boldsymbol{\\kappa}^c)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c \\mathrm{d}A$。\n被积函数是：\n$$\n(\\boldsymbol{\\kappa}^c)^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c = \\begin{pmatrix} -1 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = 1\n$$\n积分区域是单位正方形：\n$$\nq^T \\mathbf{K}_{cc} q = \\int_{0}^{1}\\int_{0}^{1} 1\\, \\mathrm{d}x\\mathrm{d}y = 1\n$$\n\n2. $r$ 的分子：$q^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q$。这需要两个独立的积分。\na. 耦合积分项 $\\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c \\mathrm{d}A$：\n被积函数是：\n$$\n\\mathbf{B}_i^T \\mathbf{D}_b \\boldsymbol{\\kappa}^c = \\begin{pmatrix} -y & 0 & -x \\end{pmatrix} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -y & 0 & -\\frac{x}{2} \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = y\n$$\n积分为：\n$$\n\\int_{0}^{1}\\int_{0}^{1} y\\, \\mathrm{d}x\\mathrm{d}y = \\int_{0}^{1} y \\left[ x \\right]_{0}^{1} \\mathrm{d}y = \\int_{0}^{1} y\\, \\mathrm{d}y = \\left[ \\frac{y^2}{2} \\right]_{0}^{1} = \\frac{1}{2}\n$$\n所以，平方项是 $(\\frac{1}{2})^2 = \\frac{1}{4}$。\n\nb. 非协调刚度项 $\\mathbf{K}_{ii} = \\int_{\\Omega} \\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_i \\mathrm{d}A$：\n被积函数是：\n$$\n\\mathbf{B}_i^T \\mathbf{D}_b \\mathbf{B}_i = \\begin{pmatrix} -y & 0 & -x \\end{pmatrix} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} -y \\\\ 0 \\\\ -x \\end{pmatrix} = \\begin{pmatrix} -y & 0 & -\\frac{x}{2} \\end{pmatrix} \\begin{pmatrix} -y \\\\ 0 \\\\ -x \\end{pmatrix} = y^2 + \\frac{x^2}{2}\n$$\n积分为：\n$$\n\\mathbf{K}_{ii} = \\int_{0}^{1}\\int_{0}^{1} \\left(y^2 + \\frac{x^2}{2}\\right) \\mathrm{d}x\\mathrm{d}y = \\int_{0}^{1} \\left[ y^2 x + \\frac{x^3}{6} \\right]_{0}^{1} \\mathrm{d}y = \\int_{0}^{1} \\left(y^2 + \\frac{1}{6}\\right) \\mathrm{d}y\n$$\n$$\n\\mathbf{K}_{ii} = \\left[ \\frac{y^3}{3} + \\frac{y}{6} \\right]_{0}^{1} = \\frac{1}{3} + \\frac{1}{6} = \\frac{2}{6} + \\frac{1}{6} = \\frac{3}{6} = \\frac{1}{2}\n$$\n\nc. 组合分子：\n$$\nq^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q = \\frac{\\left( \\frac{1}{2} \\right)^2}{\\frac{1}{2}} = \\frac{\\frac{1}{4}}{\\frac{1}{2}} = \\frac{1}{2}\n$$\n\n3. 最后，计算比率 $r$：\n$$\nr = \\frac{q^{T}\\left(\\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}\\right)q}{q^{T}\\mathbf{K}_{cc}q} = \\frac{\\frac{1}{2}}{1} = \\frac{1}{2}\n$$\n由于添加了非协调模式，给定模式的弯曲刚度变化的比率恰好是 $\\frac{1}{2}$。这个变化对应于刚度的降低，因为静力凝聚后的有效刚度矩阵是 $\\mathbf{K}_{eff} = \\mathbf{K}_{cc} - \\mathbf{K}_{ci}\\mathbf{K}_{ii}^{-1}\\mathbf{K}_{ic}$。这种软化效应是此类非协调模式构造的一个已知后果，通常被引入以缓解闭锁现象。", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "2568518"}, {"introduction": "理论最终必须转化为稳健的数值代码，而这会引入新的实际挑战。最后一个练习将从解析推导转向计算实现，解决单元形状扭曲时数值条件数的关键问题。您将编写一个程序来研究单元的纵横比如何影响非相容模式公式的稳定性，并测试一种常用的缩放技术，以确保在真实世界的网格中获得可靠的性能。[@problem_id:2568531]", "problem": "给定一个平面应变条件下的二维线性弹性问题中的矩形等参四节点四边形有限元。考虑一种增强假设应变 (EAS) 的非协调模式增强，其包含$2$个内部应变参数，这些参数收集在向量 $\\boldsymbol{\\alpha} = [\\alpha_{x}, \\alpha_{y}]^{\\mathsf{T}}$ 中。非协调应变场直接在物理坐标 $(x,y)$ 中假设为\n$$\n\\boldsymbol{\\varepsilon}^{\\text{inc}}(x,y) \\;=\\; \\mathbf{H}(x,y)\\,\\boldsymbol{\\alpha}, \\qquad \n\\mathbf{H}(x,y) \\;=\\; \n\\begin{bmatrix}\nx & 0 \\\\\n0 & y \\\\\n0 & 0\n\\end{bmatrix},\n$$\n因此有 $\\varepsilon_{xx}^{\\text{inc}} = \\alpha_{x}\\,x$，$\\varepsilon_{yy}^{\\text{inc}} = \\alpha_{y}\\,y$ 和 $\\gamma_{xy}^{\\text{inc}} = 0$。\n\n设单元在物理坐标系中占据矩形区域 $[-a/2,\\,a/2] \\times [-b/2,\\,b/2]$，其边长为 $a>0$ 和 $b>0$，宽高比为 $r = a/b$。平面应变的线性弹性本构矩阵为\n$$\n\\mathbf{D} \\;=\\; \n\\begin{bmatrix}\n\\lambda + 2\\mu & \\lambda & 0 \\\\\n\\lambda & \\lambda + 2\\mu & 0 \\\\\n0 & 0 & 2\\mu\n\\end{bmatrix}, \\qquad\n\\lambda \\;=\\; \\dfrac{E\\,\\nu}{(1+\\nu)(1-2\\nu)}, \\quad\n\\mu \\;=\\; \\dfrac{E}{2(1+\\nu)},\n$$\n其中 $E>0$ 是杨氏模量，$\\nu \\in (0,\\,0.5)$ 是泊松比。非协调模式内刚度子矩阵 $\\mathbf{K}_{ii} \\in \\mathbb{R}^{2\\times 2}$ 由非协调模式的应变能定义：\n$$\n\\mathbf{K}_{ii} \\;=\\; \\int_{\\Omega_e} \\mathbf{H}(x,y)^{\\mathsf{T}} \\,\\mathbf{D}\\, \\mathbf{H}(x,y) \\,\\mathrm{d}A,\n$$\n其中 $\\Omega_e$ 是物理坐标系中的单元域。假设厚度等于1，因此 $\\mathrm{d}A$ 是面积度量，并且所有量都是单位一致的；因此，所要求的条件数是无量纲的，并且必须以不带任何单位的纯数形式报告。\n\n为减轻大宽高比带来的病态问题，考虑一种基于长度的非协调应变映射缩放变体，\n$$\n\\widetilde{\\mathbf{H}}(x,y) \\;=\\; \n\\begin{bmatrix}\n\\dfrac{x}{a} & 0 \\\\\n0 & \\dfrac{y}{b} \\\\\n0 & 0\n\\end{bmatrix},\n\\qquad\n\\widetilde{\\mathbf{K}}_{ii} \\;=\\; \\int_{\\Omega_e} \\widetilde{\\mathbf{H}}(x,y)^{\\mathsf{T}} \\,\\mathbf{D}\\, \\widetilde{\\mathbf{H}}(x,y) \\,\\mathrm{d}A,\n$$\n这对应于在每个方向上用单元特征长度来缩放内部参数。数值任务是评估 $\\mathbf{K}_{ii}$ 的条件对宽高比的敏感性，并评估上述缩放方法的有效性。\n\n从总弹性势能泛函和增强假设应变非协调模式的定义出发，推导数值计算 $\\mathbf{K}_{ii}$ 及其条件数所需的表达式。然后实现一个程序，在母单元正方形 $[-1,1]\\times[-1,1]$ 上使用张量积 Gauss–Legendre 求积法，并结合等参映射\n$$\nx = \\dfrac{a}{2}\\,\\xi, \\qquad y = \\dfrac{b}{2}\\,\\eta, \\qquad \\mathrm{d}A = \\dfrac{ab}{4}\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\n为每个测试用例计算以下内容：\n- 未缩放矩阵 $\\mathbf{K}_{ii}$ 的谱条件数 $\\kappa(\\mathbf{K}_{ii})$，以及\n- 长度缩放矩阵 $\\widetilde{\\mathbf{K}}_{ii}$ 的谱条件数 $\\kappa(\\widetilde{\\mathbf{K}}_{ii})$。\n\n您的程序必须从第一性原理出发实现以下步骤：\n- 从 $(E,\\nu)$ 构建 $\\mathbf{D}$，\n- 通过对给定积分进行数值求积来组装 $\\mathbf{K}_{ii}$ 和 $\\widetilde{\\mathbf{K}}_{ii}$，以及\n- 使用矩阵 2-范数计算谱条件数。\n\n使用以下单元和材料参数 $(a,b,E,\\nu)$ 的测试套件：\n- 用例 1：$(a,b,E,\\nu) = (\\,1,\\,1,\\,1,\\,0.3\\,)$，\n- 用例 2：$(a,b,E,\\nu) = (\\,10,\\,1,\\,1,\\,0.3\\,)$，\n- 用例 3：$(a,b,E,\\nu) = (\\,1,\\,10,\\,1,\\,0.3\\,)$，\n- 用例 4：$(a,b,E,\\nu) = (\\,10^{-3},\\,1,\\,1,\\,0.3\\,)$，\n- 用例 5：$(a,b,E,\\nu) = (\\,4,\\,1,\\,1,\\,0.4999\\,)$。\n\n所有输出必须是无量纲实数。对于每个用例，以浮点数形式返回一个数对 $[\\kappa(\\mathbf{K}_{ii}),\\,\\kappa(\\widetilde{\\mathbf{K}}_{ii})]$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含所有用例的数对结果的逗号分隔列表，并用方括号括起来。例如，概念格式为 $[\\,[\\kappa_{1}^{\\text{un}},\\kappa_{1}^{\\text{sc}}],\\,[\\kappa_{2}^{\\text{un}},\\kappa_{2}^{\\text{sc}}],\\,\\dots\\,]$。", "solution": "问题陈述已提交验证。\n\n### 步骤 1：提取给定信息\n- **单元定义**：平面应变下的二维线性弹性问题中的矩形、等参、四节点四边形有限元。\n- **区域**：$\\Omega_e = [-a/2, a/2] \\times [-b/2, b/2]$，其中 $a > 0, b > 0$。\n- **非协调模式**：一种增强假设应变 (EAS) 增强，具有 $2$ 个内部参数 $\\boldsymbol{\\alpha} = [\\alpha_{x}, \\alpha_{y}]^{\\mathsf{T}}$。\n- **未缩放的非协调应变映射**：$\\boldsymbol{\\varepsilon}^{\\text{inc}}(x,y) = \\mathbf{H}(x,y)\\,\\boldsymbol{\\alpha}$，其中 $\\mathbf{H}(x,y) = \\begin{bmatrix} x & 0 \\\\ 0 & y \\\\ 0 & 0 \\end{bmatrix}$。\n- **长度缩放的非协调应变映射**：$\\widetilde{\\boldsymbol{\\varepsilon}}^{\\text{inc}}(x,y) = \\widetilde{\\mathbf{H}}(x,y)\\,\\boldsymbol{\\alpha}$，其中 $\\widetilde{\\mathbf{H}}(x,y) = \\begin{bmatrix} x/a & 0 \\\\ 0 & y/b \\\\ 0 & 0 \\end{bmatrix}$。\n- **本构矩阵（平面应变）**：$\\mathbf{D} = \\begin{bmatrix} \\lambda + 2\\mu & \\lambda & 0 \\\\ \\lambda & \\lambda + 2\\mu & 0 \\\\ 0 & 0 & 2\\mu \\end{bmatrix}$，其中 $\\lambda = \\frac{E\\,\\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu = \\frac{E}{2(1+\\nu)}$。$E>0$，$\\nu \\in (0, 0.5)$。\n- **内刚度矩阵**：\n  - 未缩放：$\\mathbf{K}_{ii} = \\int_{\\Omega_e} \\mathbf{H}(x,y)^{\\mathsf{T}} \\,\\mathbf{D}\\, \\mathbf{H}(x,y) \\,\\mathrm{d}A$。\n  - 缩放：$\\widetilde{\\mathbf{K}}_{ii} = \\int_{\\Omega_e} \\widetilde{\\mathbf{H}}(x,y)^{\\mathsf{T}} \\,\\mathbf{D}\\, \\widetilde{\\mathbf{H}}(x,y) \\,\\mathrm{d}A$。\n- **等参映射**：对于 $(\\xi, \\eta) \\in [-1,1]\\times[-1,1]$，$x = \\frac{a}{2}\\,\\xi$，$y = \\frac{b}{2}\\,\\eta$。面积微分为 $\\mathrm{d}A = \\frac{ab}{4}\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$。\n- **数值方法**：在母单元上进行张量积 Gauss–Legendre 求积。\n- **任务**：为每个测试用例计算谱条件数 $\\kappa(\\mathbf{K}_{ii})$ 和 $\\kappa(\\widetilde{\\mathbf{K}}_{ii})$。\n- **测试用例**：$(a,b,E,\\nu)$\n  1. $(1, 1, 1, 0.3)$\n  2. $(10, 1, 1, 0.3)$\n  3. $(1, 10, 1, 0.3)$\n  4. $(10^{-3}, 1, 1, 0.3)$\n  5. $(4, 1, 1, 0.4999)$\n\n### 步骤 2：使用提取的给定信息进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题是在有限元方法的标准理论框架内提出的，特别是使用了针对线性弹性问题的增强假设应变 (EAS) 概念。所有提供的方程都是既定原理的正确表示。\n- **适定性**：该问题是适定的。刚度矩阵 $\\mathbf{K}_{ii}$ 和 $\\widetilde{\\mathbf{K}}_{ii}$ 的积分定义在一个简单的矩形域上，被积函数是多项式，这确保了它们是良定义且可计算的。材料参数处于有效的物理范围内。任务具体，并会导出一个唯一的数值结果。\n- **客观性**：该问题使用精确、客观和标准的科学术语进行陈述。没有主观或含糊不清的陈述。\n\n该问题不含科学或事实上的不严谨之处，是可形式化的、自洽的、物理上合理的，并且结构良好。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供一个解决方案。\n\n---\n\n任务是计算与非协调模式公式相关的两个内刚度矩阵 $\\mathbf{K}_{ii}$ 和 $\\widetilde{\\mathbf{K}}_{ii}$ 的谱条件数。推导必须从第一性原理出发，计算必须按照规定使用数值求积法执行。\n\n首先，我们推导刚度矩阵的被积函数。非协调应变的未缩放形函数矩阵是 $\\mathbf{H}(x,y) = \\begin{bmatrix} x & 0 \\\\ 0 & y \\\\ 0 & 0 \\end{bmatrix}$。本构矩阵是 $\\mathbf{D}$。$\\mathbf{K}_{ii}$ 的被积函数是 $2 \\times 2$ 矩阵 $\\mathbf{H}^{\\mathsf{T}}\\mathbf{D}\\mathbf{H}$。\n$$\n\\mathbf{H}^{\\mathsf{T}}\\mathbf{D}\\mathbf{H} =\n\\begin{bmatrix} x & 0 & 0 \\\\ 0 & y & 0 \\end{bmatrix}\n\\begin{bmatrix}\n\\lambda + 2\\mu & \\lambda & 0 \\\\\n\\lambda & \\lambda + 2\\mu & 0 \\\\\n0 & 0 & 2\\mu\n\\end{bmatrix}\n\\begin{bmatrix} x & 0 \\\\ 0 & y \\\\ 0 & 0 \\end{bmatrix}\n=\n\\begin{bmatrix} (\\lambda + 2\\mu)x^2 & \\lambda xy \\\\ \\lambda xy & (\\lambda + 2\\mu)y^2 \\end{bmatrix}\n$$\n矩阵 $\\mathbf{K}_{ii}$ 是通过在单元域 $\\Omega_e = [-a/2, a/2] \\times [-b/2, b/2]$ 上对该表达式进行积分得到的。\n$$\n\\mathbf{K}_{ii} = \\int_{-b/2}^{b/2} \\int_{-a/2}^{a/2}\n\\begin{bmatrix} (\\lambda + 2\\mu)x^2 & \\lambda xy \\\\ \\lambda xy & (\\lambda + 2\\mu)y^2 \\end{bmatrix}\n\\,\\mathrm{d}x\\,\\mathrm{d}y\n$$\n由于积分域关于原点对称，非对角项（即奇函数 $xy$）的积分为零。\n$$\n\\int_{-a/2}^{a/2} x \\,\\mathrm{d}x = 0, \\quad \\int_{-b/2}^{b/2} y \\,\\mathrm{d}y = 0 \\quad \\implies \\quad \\int_{\\Omega_e} xy \\,\\mathrm{d}A = 0\n$$\n对角项计算如下：\n$$\n(\\mathbf{K}_{ii})_{11} = (\\lambda + 2\\mu) \\int_{-b/2}^{b/2} \\int_{-a/2}^{a/2} x^2 \\,\\mathrm{d}x\\,\\mathrm{d}y = (\\lambda + 2\\mu) \\left( b \\right) \\left( \\frac{x^3}{3} \\right)\\bigg|_{-a/2}^{a/2} = (\\lambda + 2\\mu) \\frac{a^3b}{12}\n$$\n$$\n(\\mathbf{K}_{ii})_{22} = (\\lambda + 2\\mu) \\int_{-b/2}^{b/2} \\int_{-a/2}^{a/2} y^2 \\,\\mathrm{d}x\\,\\mathrm{d}y = (\\lambda + 2\\mu) \\left( a \\right) \\left( \\frac{y^3}{3} \\right)\\bigg|_{-b/2}^{b/2} = (\\lambda + 2\\mu) \\frac{ab^3}{12}\n$$\n因此，未缩放的内刚度矩阵是对角矩阵：\n$$\n\\mathbf{K}_{ii} = \\frac{\\lambda + 2\\mu}{12}\n\\begin{bmatrix} a^3b & 0 \\\\ 0 & ab^3 \\end{bmatrix}\n$$\n谱条件数 $\\kappa(\\mathbf{K}_{ii})$ 是最大特征值与最小特征值之比。对于正定对角矩阵，这是最大对角元素与最小对角元素之比。\n$$\n\\kappa(\\mathbf{K}_{ii}) = \\frac{\\max(a^3b, ab^3)}{\\min(a^3b, ab^3)} = \\frac{\\max(a^2, b^2)}{\\min(a^2, b^2)} = \\left( \\frac{\\max(a, b)}{\\min(a, b)} \\right)^2 = \\max\\left( \\frac{a^2}{b^2}, \\frac{b^2}{a^2} \\right)\n$$\n如果我们定义宽高比 $r = a/b$，那么 $\\kappa(\\mathbf{K}_{ii}) = \\max(r^2, 1/r^2)$。这直接显示了条件对单元宽高比的敏感性。\n\n接下来，我们分析长度缩放的公式。缩放后的形函数矩阵是 $\\widetilde{\\mathbf{H}}(x,y) = \\begin{bmatrix} x/a & 0 \\\\ 0 & y/b \\\\ 0 & 0 \\end{bmatrix}$。被积函数是 $\\widetilde{\\mathbf{H}}^{\\mathsf{T}}\\mathbf{D}\\widetilde{\\mathbf{H}}$。按照相同的步骤，我们在被积函数表达式中将 $x$ 替换为 $x/a$，将 $y$ 替换为 $y/b$。\n$$\n\\widetilde{\\mathbf{H}}^{\\mathsf{T}}\\mathbf{D}\\widetilde{\\mathbf{H}} =\n\\begin{bmatrix} (\\lambda + 2\\mu)(x/a)^2 & \\lambda (x/a)(y/b) \\\\ \\lambda (x/a)(y/b) & (\\lambda + 2\\mu)(y/b)^2 \\end{bmatrix}\n$$\n在 $\\Omega_e$ 上积分：\n$$\n(\\widetilde{\\mathbf{K}}_{ii})_{11} = \\frac{\\lambda + 2\\mu}{a^2} \\int_{\\Omega_e} x^2 \\,\\mathrm{d}A = \\frac{\\lambda + 2\\mu}{a^2} \\frac{a^3b}{12} = (\\lambda + 2\\mu) \\frac{ab}{12}\n$$\n$$\n(\\widetilde{\\mathbf{K}}_{ii})_{22} = \\frac{\\lambda + 2\\mu}{b^2} \\int_{\\Omega_e} y^2 \\,\\mathrm{d}A = \\frac{\\lambda + 2\\mu}{b^2} \\frac{ab^3}{12} = (\\lambda + 2\\mu) \\frac{ab}{12}\n$$\n非对角项同样为零。得到的缩放矩阵为：\n$$\n\\widetilde{\\mathbf{K}}_{ii} = (\\lambda + 2\\mu) \\frac{ab}{12}\n\\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}\n$$\n这是一个单位矩阵的倍数。任何非零单位矩阵倍数的条件数恒为 $1$。\n$$\n\\kappa(\\widetilde{\\mathbf{K}}_{ii}) = 1\n$$\n此解析推导证实，长度缩放消除了内刚度矩阵条件对单元宽高比的依赖性。值得注意的是，材料参数 $E$ 和 $\\nu$ 在两种情况下都不影响条件数，因为它们作为公共缩放因子出现在对角项上。\n\n对于数值实现，我们使用张量积 Gauss-Legendre 求积法。从母单元 $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ 到物理单元的变换是 $x = \\frac{a}{2}\\xi$ 和 $y = \\frac{b}{2}\\eta$。面积微分为 $\\mathrm{d}A = \\det(\\mathbf{J})\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta = \\frac{ab}{4}\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$。\n$\\mathbf{K}_{ii}$ 或 $\\widetilde{\\mathbf{K}}_{ii}$ 的任何分量的积分形式为：\n$$\n\\int_{\\Omega_e} f(x,y) \\,\\mathrm{d}A = \\int_{-1}^{1} \\int_{-1}^{1} f\\left(\\frac{a}{2}\\xi, \\frac{b}{2}\\eta\\right) \\frac{ab}{4} \\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta \\approx \\frac{ab}{4} \\sum_{i=1}^{N_p} \\sum_{j=1}^{N_p} w_i w_j f\\left(\\frac{a}{2}\\xi_i, \\frac{b}{2}\\eta_j\\right)\n$$\n其中 $(\\xi_i, w_i)$ 和 $(\\eta_j, w_j)$ 是 Gauss 点和权重，$N_p$ 是一个维度上的点数。被积函数是关于 $x$ 和 $y$ 的最高二次多项式。映射到母单元后，它们成为关于 $\\xi$ 和 $\\eta$ 的同次多项式。一个 2 点 Gauss 法则 ($N_p=2$) 可以精确积分最高 $2 \\times 2 - 1 = 3$ 次的多项式。因此，一个 $2 \\times 2$ 的张量积求积法则足以精确计算这些积分。\n\n该实现将构建本构矩阵 $\\mathbf{D}$，对每个测试用例使用 $2 \\times 2$ Gauss 求积法对 $\\mathbf{K}_{ii}$ 和 $\\widetilde{\\mathbf{K}}_{ii}$ 进行数值积分，然后计算它们的谱条件数。", "answer": "[[1.0,1.0],[100.0,1.0],[100.0,1.0],[1000000.0,1.0],[16.0,1.0]]", "id": "2568531"}]}