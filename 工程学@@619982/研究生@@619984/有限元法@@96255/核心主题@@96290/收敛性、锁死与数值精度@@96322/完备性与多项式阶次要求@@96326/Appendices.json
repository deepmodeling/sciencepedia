{"hands_on_practices": [{"introduction": "有限元方法准确性的基石在于其基函数所构成的多项式空间以及它精确再现特定阶次多项式解的能力。本练习将深入探讨一个标准的九节点双二次（$Q_2$）单元，通过这个练习，你将亲手验证哪些多项式项属于其固有的插值空间，而哪些则不属于。通过直接计算一个三次多项式场的插值误差，你将具体理解为何多项式完备性是保证精度的核心，并观察当一个单元试图逼近一个它无法完美表示的函数时的行为。[@problem_id:2545388]", "problem": "在有限元方法 (FEM) 背景下，考虑参考方形 $\\widehat{\\Omega} = [-1,1] \\times [-1,1]$。在 $\\widehat{\\Omega}$ 上的一个 $Q_2$ 四边形单元有九个 Lagrange 插值节点，位于四个角点、四个边中点和中心点，即位于 $(\\xi,\\eta) \\in \\{-1,0,1\\} \\times \\{-1,0,1\\}$。令 $I_{Q_2}$ 表示相应的节点 Lagrange 插值算子。$\\widehat{\\Omega}$ 上的 $Q_2$ 插值空间是每个变量次数最高为 2 的张量积多项式空间。\n\n从张量积多项式空间和节点 Lagrange 插值的定义出发，仅使用这些定义作为基本依据，回答以下关于标量位移场的问题\n$$\nu(\\xi,\\eta) = \\xi^3 + \\xi^2 \\eta + \\xi \\eta^2 + \\eta^3.\n$$\n1) 从第一性原理出发进行推理，确定在总次数为三的单项式 $\\{\\xi^3,\\ \\xi^2 \\eta,\\ \\xi \\eta^2,\\ \\eta^3\\}$ 中，哪些能被 $I_{Q_2}$ 精确再生，哪些不能。\n\n2) 通过列出 $u(\\xi,\\eta)$ 在所有九个 $Q_2$ 节点 $(\\xi,\\eta) \\in \\{-1,0,1\\} \\times \\{-1,0,1\\}$ 处的值，来指明节点位移数据。\n\n3) 计算在 $\\widehat{\\Omega}$ 上插值误差的 $L^2$ 范数的平方，\n$$\n\\int_{-1}^{1} \\int_{-1}^{1} \\big(u(\\xi,\\eta) - I_{Q_2}u(\\xi,\\eta)\\big)^2 \\, d\\eta \\, d\\xi,\n$$\n并给出其精确值。\n\n以单个精确数字的形式给出最终答案（无单位且不进行四舍五入）。", "solution": "首先对问题进行验证。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n- 参考域：$\\widehat{\\Omega} = [-1,1] \\times [-1,1]$。\n- 单元类型：$Q_2$ 四边形。\n- 插值节点：$(\\xi,\\eta) \\in \\{-1,0,1\\} \\times \\{-1,0,1\\}$。\n- 算子：$I_{Q_2}$ 是节点 Lagrange 插值算子。\n- 插值空间：每个变量次数最高为 2 的张量积多项式空间，我们将其表示为 $\\mathcal{Q}_2(\\widehat{\\Omega})$。\n- 标量场：$u(\\xi,\\eta) = \\xi^3 + \\xi^2 \\eta + \\xi \\eta^2 + \\eta^3$。\n- 任务：\n  1. 确定单项式 $\\{\\xi^3,\\ \\xi^2 \\eta,\\ \\xi \\eta^2,\\ \\eta^3\\}$ 中哪些能被 $I_{Q_2}$ 精确再生。\n  2. 指明所有 9 个节点上 $u(\\xi,\\eta)$ 的节点值。\n  3. 计算插值误差的 $L^2$ 范数平方，$\\int_{-1}^{1} \\int_{-1}^{1} (u - I_{Q_2}u)^2 \\, d\\eta \\, d\\xi$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学上成立的：** 该问题是有限元方法理论中的一个标准练习。它基于多项式插值和数值积分的既定原则。\n- **良态的：** 该问题提供了一个具体的函数、一个明确定义的插值方案和一组清晰的问题。存在唯一且有意义的解，并且可以计算得出。\n- **客观的：** 问题以精确的数学语言陈述。\n- **完整性和一致性：** 提供了所有必要的定义和数据，并且它们相互一致。$Q_2$ 单元的定义、其节点位置和其多项式空间是标准的且陈述正确。\n\n**步骤3：结论与行动**\n问题被判定为**有效**。将提供解答。\n\n**解答**\n\n基本定义如下。参考方形 $\\widehat{\\Omega}$ 上的 $Q_2$ 张量积多项式空间由下式给出\n$$\n\\mathcal{Q}_2(\\widehat{\\Omega}) = \\text{span}\\{ \\xi^i \\eta^j \\mid 0 \\le i \\le 2, 0 \\le j \\le 2 \\}.\n$$\n九个节点的集合为 $\\mathcal{N} = \\{(\\xi_k, \\eta_k) \\mid \\xi_k, \\eta_k \\in \\{-1,0,1\\}\\}$。节点 Lagrange 插值算子 $I_{Q_2}$ 将一个连续函数 $v(\\xi,\\eta)$ 映射到唯一的、满足以下插值条件的多项式 $I_{Q_2}v \\in \\mathcal{Q}_2(\\widehat{\\Omega})$：\n$$\n(I_{Q_2}v)(\\xi_k, \\eta_k) = v(\\xi_k, \\eta_k) \\quad \\forall (\\xi_k, \\eta_k) \\in \\mathcal{N}.\n$$\n\n**1) 单项式再生**\n\n一个函数 $v$ 被算子 $I_{Q_2}$ 精确再生，当且仅当 $I_{Q_2}v = v$。Lagrange 插值定义的一个直接推论是，如果 $v$ 本身是插值空间 $\\mathcal{Q}_2(\\widehat{\\Omega})$ 中的一个元素，那么 $I_{Q_2}v = v$。这是因为 $v \\in \\mathcal{Q}_2(\\widehat{\\Omega})$ 满足插值条件，且插值多项式是唯一的。\n\n我们考察集合 $\\{\\xi^3,\\ \\xi^2 \\eta,\\ \\xi \\eta^2,\\ \\eta^3\\}$ 中的每一个单项式。\n\n- 对于 $v(\\xi,\\eta) = \\xi^2 \\eta$：指数为 $i=2$ 和 $j=1$。因为 $0 \\le 2 \\le 2$ 且 $0 \\le 1 \\le 2$，所以该单项式是 $\\mathcal{Q}_2(\\widehat{\\Omega})$ 的一个元素。因此，它被**精确再生**。\n\n- 对于 $v(\\xi,\\eta) = \\xi \\eta^2$：指数为 $i=1$ 和 $j=2$。因为 $0 \\le 1 \\le 2$ 且 $0 \\le 2 \\le 2$，所以该单项式也是 $\\mathcal{Q}_2(\\widehat{\\Omega})$ 的一个元素。因此，它被**精确再生**。\n\n- 对于 $v(\\xi,\\eta) = \\xi^3$：指数为 $i=3$ 和 $j=0$。因为 $i=3 > 2$，所以该单项式不在 $\\mathcal{Q}_2(\\widehat{\\Omega})$ 中。为确定其插值多项式，我们在节点处对 $v$ 求值。对于任意节点 $(\\xi_k, \\eta_k)$，坐标 $\\xi_k$ 属于 $\\{-1, 0, 1\\}$。对于这些值，有 $\\xi_k^3 = \\xi_k$。例如， $(-1)^3 = -1$，$0^3 = 0$，以及 $1^3 = 1$。因此，函数 $\\xi^3$ 的节点值与函数 $\\xi$ 的节点值相同。函数 $p(\\xi, \\eta) = \\xi$ 在 $\\mathcal{Q}_2(\\widehat{\\Omega})$ 中。因为在所有九个节点处都有 $p(\\xi_k, \\eta_k) = \\xi_k = \\xi_k^3$，根据 Lagrange 插值多项式的唯一性，我们必有 $I_{Q_2}(\\xi^3) = p(\\xi,\\eta) = \\xi$。由于函数 $\\xi$ 在 $\\widehat{\\Omega}$ 上与函数 $\\xi^3$ 不完全相同，单项式 $\\xi^3$ **不被精确再生**。\n\n- 对于 $v(\\xi,\\eta) = \\eta^3$：根据与 $\\xi^3$ 情况的对称性，指数 $j=3 > 2$，所以 $\\eta^3$ 不在 $\\mathcal{Q}_2(\\widehat{\\Omega})$ 中。在节点处，$\\eta_k \\in \\{-1, 0, 1\\}$，所以 $\\eta_k^3 = \\eta_k$。函数 $\\eta^3$ 的节点值与函数 $\\eta$ 的节点值相同。因为 $\\eta \\in \\mathcal{Q}_2(\\widehat{\\Omega})$，插值多项式的唯一性意味着 $I_{Q_2}(\\eta^3) = \\eta$。由于 $\\eta \\neq \\eta^3$，单项式 $\\eta^3$ **不被精确再生**。\n\n**2) 节点位移数据**\n\n位移场为 $u(\\xi,\\eta) = \\xi^3 + \\xi^2 \\eta + \\xi \\eta^2 + \\eta^3$。我们在九个节点 $(\\xi, \\eta) \\in \\{-1,0,1\\} \\times \\{-1,0,1\\}$ 处对 $u$ 求值。计算值列表如下。\n- $u(-1, -1) = (-1)^3 + (-1)^2(-1) + (-1)(-1)^2 + (-1)^3 = -1 - 1 - 1 - 1 = -4$\n- $u(-1, 0) = (-1)^3 + (-1)^2(0) + (-1)(0)^2 + (0)^3 = -1 + 0 + 0 + 0 = -1$\n- $u(-1, 1) = (-1)^3 + (-1)^2(1) + (-1)(1)^2 + (1)^3 = -1 + 1 - 1 + 1 = 0$\n- $u(0, -1) = (0)^3 + (0)^2(-1) + (0)(-1)^2 + (-1)^3 = 0 + 0 + 0 - 1 = -1$\n- $u(0, 0) = (0)^3 + (0)^2(0) + (0)(0)^2 + (0)^3 = 0 + 0 + 0 + 0 = 0$\n- $u(0, 1) = (0)^3 + (0)^2(1) + (0)(1)^2 + (1)^3 = 0 + 0 + 0 + 1 = 1$\n- $u(1, -1) = (1)^3 + (1)^2(-1) + (1)(-1)^2 + (-1)^3 = 1 - 1 + 1 - 1 = 0$\n- $u(1, 0) = (1)^3 + (1)^2(0) + (1)(0)^2 + (0)^3 = 1 + 0 + 0 + 0 = 1$\n- $u(1, 1) = (1)^3 + (1)^2(1) + (1)(1)^2 + (1)^3 = 1 + 1 + 1 + 1 = 4$\n\n九个节点值为 $\\{-4, -1, 0, -1, 0, 1, 0, 1, 4\\}$。\n\n**3) 插值误差的 $L^2$ 范数平方**\n\n插值误差为 $e(\\xi, \\eta) = u(\\xi, \\eta) - I_{Q_2}u(\\xi, \\eta)$。\n利用 $I_{Q_2}$ 算子的线性和第 1) 部分的结果：\n$$\nI_{Q_2}u = I_{Q_2}(\\xi^3 + \\xi^2 \\eta + \\xi \\eta^2 + \\eta^3) = I_{Q_2}(\\xi^3) + I_{Q_2}(\\xi^2 \\eta) + I_{Q_2}(\\xi \\eta^2) + I_{Q_2}(\\eta^3)\n$$\n$$\nI_{Q_2}u(\\xi, \\eta) = \\xi + \\xi^2 \\eta + \\xi \\eta^2 + \\eta\n$$\n因此，误差函数为：\n$$\ne(\\xi, \\eta) = (\\xi^3 + \\xi^2 \\eta + \\xi \\eta^2 + \\eta^3) - (\\xi + \\xi^2 \\eta + \\xi \\eta^2 + \\eta) = (\\xi^3 - \\xi) + (\\eta^3 - \\eta)\n$$\n我们必须计算该误差在 $\\widehat{\\Omega}$ 上的 $L^2$ 范数平方：\n$$\nE = \\int_{-1}^{1} \\int_{-1}^{1} [e(\\xi,\\eta)]^2 \\, d\\eta \\, d\\xi = \\int_{-1}^{1} \\int_{-1}^{1} [(\\xi^3 - \\xi) + (\\eta^3 - \\eta)]^2 \\, d\\eta \\, d\\xi\n$$\n我们展开被积函数：\n$$\n[(\\xi^3 - \\xi) + (\\eta^3 - \\eta)]^2 = (\\xi^3 - \\xi)^2 + (\\eta^3 - \\eta)^2 + 2(\\xi^3 - \\xi)(\\eta^3 - \\eta)\n$$\n积分变为：\n$$\nE = \\int_{-1}^{1} \\int_{-1}^{1} (\\xi^3 - \\xi)^2 \\, d\\eta \\, d\\xi + \\int_{-1}^{1} \\int_{-1}^{1} (\\eta^3 - \\eta)^2 \\, d\\eta \\, d\\xi + \\int_{-1}^{1} \\int_{-1}^{1} 2(\\xi^3 - \\xi)(\\eta^3 - \\eta) \\, d\\eta \\, d\\xi\n$$\n我们来分析第三项，即交叉乘积积分：\n$$\n\\int_{-1}^{1} \\int_{-1}^{1} 2(\\xi^3 - \\xi)(\\eta^3 - \\eta) \\, d\\eta \\, d\\xi = 2 \\left( \\int_{-1}^{1} (\\xi^3 - \\xi) \\, d\\xi \\right) \\left( \\int_{-1}^{1} (\\eta^3 - \\eta) \\, d\\eta \\right)\n$$\n被积函数 $f(\\xi) = \\xi^3 - \\xi$ 是一个奇函数，即 $f(-\\xi) = -f(\\xi)$。奇函数在对称区间 $[-1, 1]$ 上的积分为零。\n$$\n\\int_{-1}^{1} (\\xi^3 - \\xi) \\, d\\xi = \\left[ \\frac{\\xi^4}{4} - \\frac{\\xi^2}{2} \\right]_{-1}^{1} = \\left(\\frac{1}{4} - \\frac{1}{2}\\right) - \\left(\\frac{(-1)^4}{4} - \\frac{(-1)^2}{2}\\right) = -\\frac{1}{4} - \\left(-\\frac{1}{4}\\right) = 0\n$$\n因此，交叉乘积积分为 $2 \\times 0 \\times 0 = 0$。\n\n总误差是前两项积分之和，根据对称性这两项积分是相同的。我们来计算第一项：\n$$\n\\int_{-1}^{1} \\int_{-1}^{1} (\\xi^3 - \\xi)^2 \\, d\\eta \\, d\\xi = \\left( \\int_{-1}^{1} d\\eta \\right) \\left( \\int_{-1}^{1} (\\xi^3 - \\xi)^2 \\, d\\xi \\right) = 2 \\int_{-1}^{1} (\\xi^6 - 2\\xi^4 + \\xi^2) \\, d\\xi\n$$\n被积函数是偶函数，所以我们可以从 $0$ 到 $1$ 积分并将结果乘以 $2$：\n$$\n2 \\int_{-1}^{1} (\\xi^6 - 2\\xi^4 + \\xi^2) \\, d\\xi = 2 \\times 2 \\int_{0}^{1} (\\xi^6 - 2\\xi^4 + \\xi^2) \\, d\\xi = 4 \\left[ \\frac{\\xi^7}{7} - \\frac{2\\xi^5}{5} + \\frac{\\xi^3}{3} \\right]_{0}^{1}\n$$\n$$\n= 4 \\left( \\frac{1}{7} - \\frac{2}{5} + \\frac{1}{3} \\right) = 4 \\left( \\frac{15 \\cdot 1 - 21 \\cdot 2 + 35 \\cdot 1}{105} \\right) = 4 \\left( \\frac{15 - 42 + 35}{105} \\right) = 4 \\left( \\frac{8}{105} \\right) = \\frac{32}{105}\n$$\n根据对称性，涉及 $\\eta$ 的第二项积分具有相同的值：\n$$\n\\int_{-1}^{1} \\int_{-1}^{1} (\\eta^3 - \\eta)^2 \\, d\\eta \\, d\\xi = \\frac{32}{105}\n$$\n误差的总 $L^2$ 范数平方是各项之和：\n$$\nE = \\frac{32}{105} + \\frac{32}{105} + 0 = \\frac{64}{105}\n$$", "answer": "$$\n\\boxed{\\frac{64}{105}}\n$$", "id": "2545388"}, {"introduction": "虽然单元在标准参考域上的性质是明确的，但在实际分析中，单元的形状是多样的，这需要通过等参数映射建立物理域和参考域之间的联系。本练习旨在研究非仿射（即扭曲的）几何映射如何影响多项式基函数，你将发现即使是参考域上一个简单的线性多项式，在物理坐标系下也会转变为一个复杂的非多项式（有理）函数。这项实践揭示了一个至关重要的观点：在参考单元上得到保证的多项式完备性可能会因几何扭曲而受到损害，这是衡量网格质量和分析精度的基本考量。[@problem_id:2545386]", "problem": "考虑一个单一的等参数双线性四边形单元，该单元是通过将具有局部坐标 $(\\xi,\\eta)$ 的参考正方形 $[-1,1]^2$ 映射到一个具有物理坐标 $(x,y)$ 的物理、轻度扭曲的梯形而获得的。该映射由标准的双线性形函数\n$$\nN_{1}(\\xi,\\eta)=\\frac{(1-\\xi)(1-\\eta)}{4},\\quad\nN_{2}(\\xi,\\eta)=\\frac{(1+\\xi)(1-\\eta)}{4},\\quad\nN_{3}(\\xi,\\eta)=\\frac{(1+\\xi)(1+\\eta)}{4},\\quad\nN_{4}(\\xi,\\eta)=\\frac{(1-\\xi)(1+\\eta)}{4},\n$$\n以及物理节点坐标\n$$\n\\boldsymbol{X}_{1}=(0,0),\\quad \\boldsymbol{X}_{2}=(1,0),\\quad \\boldsymbol{X}_{3}=(1+\\beta,1),\\quad \\boldsymbol{X}_{4}=(0,1),\n$$\n定义，其中 $\\beta$ 是一个量化与平行四边形偏差的实参数，并满足非退化条件 $1+\\beta\\,y>0$ 对所有 $y\\in[0,1]$ 成立（例如，$\\beta>-1$ 即可满足条件）。等参数映射 $\\boldsymbol{F}:[-1,1]^2\\to\\mathbb{R}^2$ 为\n$$\n\\boldsymbol{F}(\\xi,\\eta)=\\sum_{a=1}^{4}N_{a}(\\xi,\\eta)\\,\\boldsymbol{X}_{a}=(x(\\xi,\\eta),y(\\xi,\\eta)).\n$$\n\n令 $\\mathbb{Q}_{1}$ 表示参考单元上的多项式空间，其在每个变量中最高为一次，即 $\\operatorname{span}\\{1,\\xi,\\eta,\\xi\\eta\\}$。考虑参考多项式 $q(\\xi,\\eta)=\\xi+\\eta\\in\\mathbb{Q}_{1}$。它在物理坐标中的像，通过逆映射的前推定义为\n$$\np(x,y)=q\\big(\\boldsymbol{F}^{-1}(x,y)\\big)=\\xi(x,y)+\\eta(x,y).\n$$\n因为当 $\\beta\\neq 0$ 时，该映射是双线性的且通常是非仿射的，所以函数 $p(x,y)$ 未必是关于 $(x,y)$ 的多项式。\n\n令 $(x_{c},y_{c})=\\boldsymbol{F}(0,0)$ 为参考中心 $(\\xi,\\eta)=(0,0)$ 的物理像。作为由映射扭曲引起的非多项式行为的定量证明，计算在点 $(x_{c},y_{c})$ 处的二阶导数 $\\frac{\\partial^{2}p}{\\partial y^{2}}$，结果应仅为 $\\beta$ 的闭式解析函数。请提供精确表达式。不需要数值近似，且无单位适用。", "solution": "用户提供了一个问题陈述。首要且最关键的步骤是严格验证此陈述。\n\n**步骤1：提取已知条件**\n-   **参考域：** $(\\xi,\\eta)$ 平面中的一个正方形，定义为 $(\\xi,\\eta) \\in [-1,1]^2$。\n-   **物理域：** 一个梯形，其顶点为 $\\boldsymbol{X}_{1}=(0,0)$, $\\boldsymbol{X}_{2}=(1,0)$, $\\boldsymbol{X}_{3}=(1+\\beta,1)$ 和 $\\boldsymbol{X}_{4}=(0,1)$。参数 $\\beta$ 是一个实数。\n-   **非退化条件：** 对于所有 $y \\in [0,1]$，$1+\\beta y>0$ 成立。\n-   **映射：** 一个等参数映射 $\\boldsymbol{F}:[-1,1]^2\\to\\mathbb{R}^2$，其中 $\\boldsymbol{F}(\\xi,\\eta) = \\sum_{a=1}^{4}N_{a}(\\xi,\\eta)\\,\\boldsymbol{X}_{a} = (x(\\xi,\\eta), y(\\xi,\\eta))$。\n-   **形函数：** 双线性形函数 $N_{1}(\\xi,\\eta)=\\frac{(1-\\xi)(1-\\eta)}{4}$, $N_{2}(\\xi,\\eta)=\\frac{(1+\\xi)(1-\\eta)}{4}$, $N_{3}(\\xi,\\eta)=\\frac{(1+\\xi)(1+\\eta)}{4}$, $N_{4}(\\xi,\\eta)=\\frac{(1-\\xi)(1+\\eta)}{4}$。\n-   **目标函数：** 一个标量场 $p(x,y)$，定义为 $q(\\xi,\\eta) = \\xi+\\eta$ 的前推，即 $p(x,y) = q(\\boldsymbol{F}^{-1}(x,y)) = \\xi(x,y) + \\eta(x,y)$。\n-   **求值点：** 参考中心的物理像，$(x_c, y_c) = \\boldsymbol{F}(0,0)$。\n-   **目标：** 计算在点 $(x_c, y_c)$ 处的二阶偏导数 $\\frac{\\partial^{2}p}{\\partial y^{2}}$，作为 $\\beta$ 的函数。\n\n**步骤2：使用提取的已知条件进行验证**\n根据验证标准对问题进行审查。\n-   **科学依据：** 该问题牢固植根于有限元法（FEM）理论，特别是关于等参数单元和几何映射对多项式空间的影响。所有概念在计算力学和应用数学中都是标准的。该问题在化学、物理和数学上都是合理的。\n-   **适定性：** 该问题是适定的。它要求计算一个特定的、明确定义的数学量。所有必要的数据和函数关系都已提供。非退化条件 $1+\\beta y > 0$ 确保映射 $\\boldsymbol{F}$ 是可逆的，这对于函数 $p(x,y)$ 的良定义是必要的。\n-   **客观性：** 该问题以精确、客观的数学语言陈述，没有任何主观性或歧义。\n\n**步骤3：结论与行动**\n该问题陈述在科学上是合理的、适定的、客观且完整的。它代表了有限元理论中一个标准的、非平凡的计算。因此，该问题被判定为**有效**。我们可以继续进行求解。\n\n首先，我们确定等参数映射 $\\boldsymbol{F}(\\xi,\\eta) = (x(\\xi,\\eta), y(\\xi,\\eta))$ 的显式形式。\n物理x坐标由下式给出\n$$\nx(\\xi,\\eta) = \\sum_{a=1}^{4} N_a(\\xi,\\eta) x_a = N_1(\\xi,\\eta) \\cdot 0 + N_2(\\xi,\\eta) \\cdot 1 + N_3(\\xi,\\eta) \\cdot (1+\\beta) + N_4(\\xi,\\eta) \\cdot 0\n$$\n$$\nx(\\xi,\\eta) = \\frac{(1+\\xi)(1-\\eta)}{4} + (1+\\beta)\\frac{(1+\\xi)(1+\\eta)}{4} = \\frac{1+\\xi}{4} \\left[ (1-\\eta) + (1+\\beta)(1+\\eta) \\right]\n$$\n$$\nx(\\xi,\\eta) = \\frac{1+\\xi}{4} [1-\\eta + 1 + \\eta + \\beta + \\beta\\eta] = \\frac{1+\\xi}{4} (2+\\beta+\\beta\\eta).\n$$\n物理y坐标由下式给出\n$$\ny(\\xi,\\eta) = \\sum_{a=1}^{4} N_a(\\xi,\\eta) y_a = N_1(\\xi,\\eta) \\cdot 0 + N_2(\\xi,\\eta) \\cdot 0 + N_3(\\xi,\\eta) \\cdot 1 + N_4(\\xi,\\eta) \\cdot 1\n$$\n$$\ny(\\xi,\\eta) = \\frac{(1+\\xi)(1+\\eta)}{4} + \\frac{(1-\\xi)(1+\\eta)}{4} = \\frac{1+\\eta}{4} [(1+\\xi)+(1-\\xi)] = \\frac{1+\\eta}{4} \\cdot 2 = \\frac{1+\\eta}{2}.\n$$\n从 $y(\\xi,\\eta)$ 的表达式中可以得到一个关键的简化。它只依赖于 $\\eta$。我们可以反转这个关系来求出作为 $y$ 函数的 $\\eta$：\n$$\n\\eta(x,y) = 2y - 1.\n$$\n需要微分的函数是 $p(x,y) = \\xi(x,y) + \\eta(x,y)$。由于 $\\eta(x,y)$ 是 $y$ 的线性函数且与 $x$ 无关，其关于 $y$ 的二阶导数为零：\n$$\n\\frac{\\partial \\eta}{\\partial y} = 2, \\quad \\frac{\\partial^2 \\eta}{\\partial y^2} = 0.\n$$\n因此，问题简化为计算 $\\frac{\\partial^2 \\xi}{\\partial y^2}$：\n$$\n\\frac{\\partial^2 p}{\\partial y^2} = \\frac{\\partial^2 \\xi}{\\partial y^2} + \\frac{\\partial^2 \\eta}{\\partial y^2} = \\frac{\\partial^2 \\xi}{\\partial y^2}.\n$$\n为了求 $\\frac{\\partial^2 \\xi}{\\partial y^2}$，我们使用链式法则。任意函数 $f(\\xi,\\eta)$ 关于 $y$ 的一阶导数为\n$$\n\\frac{\\partial f}{\\partial y} = \\frac{\\partial f}{\\partial \\xi}\\frac{\\partial \\xi}{\\partial y} + \\frac{\\partial f}{\\partial \\eta}\\frac{\\partial \\eta}{\\partial y}.\n$$\n取 $f=\\xi$ 得到 $\\frac{\\partial \\xi}{\\partial y}$，这没有帮助。相反，我们从映射 $\\boldsymbol{F}$ 的雅可比矩阵 $J$ 的逆矩阵中计算导数 $\\frac{\\partial \\xi}{\\partial y}$ 和 $\\frac{\\partial \\eta}{\\partial y}$。\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}.\n$$\n其分量为：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4}(2+\\beta+\\beta\\eta), \\quad \\frac{\\partial x}{\\partial \\eta} = \\frac{\\beta}{4}(1+\\xi), \\quad \\frac{\\partial y}{\\partial \\xi} = 0, \\quad \\frac{\\partial y}{\\partial \\eta} = \\frac{1}{2}.\n$$\n所以，$J = \\begin{pmatrix} \\frac{1}{4}(2+\\beta+\\beta\\eta) & \\frac{\\beta}{4}(1+\\xi) \\\\ 0 & \\frac{1}{2} \\end{pmatrix}$。\n其行列式为 $\\det(J) = \\frac{1}{8}(2+\\beta+\\beta\\eta)$。\n逆映射的雅可比矩阵为 $J^{-1} = \\begin{pmatrix} \\frac{\\partial \\xi}{\\partial x} & \\frac{\\partial \\xi}{\\partial y} \\\\ \\frac{\\partial \\eta}{\\partial x} & \\frac{\\partial \\eta}{\\partial y} \\end{pmatrix} = \\frac{1}{\\det(J)}\\begin{pmatrix} \\frac{\\partial y}{\\partial \\eta} & -\\frac{\\partial x}{\\partial \\eta} \\\\ -\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\xi} \\end{pmatrix}$。\n由此，我们求得 $\\frac{\\partial \\xi}{\\partial y}$：\n$$\n\\frac{\\partial \\xi}{\\partial y} = \\frac{-\\frac{\\partial x}{\\partial \\eta}}{\\det(J)} = \\frac{-\\frac{\\beta}{4}(1+\\xi)}{\\frac{1}{8}(2+\\beta+\\beta\\eta)} = -\\frac{2\\beta(1+\\xi)}{2+\\beta+\\beta\\eta}.\n$$\n令此为 $\\xi_y$。为计算二阶导数 $\\frac{\\partial^2 \\xi}{\\partial y^2} = \\frac{\\partial}{\\partial y}(\\xi_y)$，我们再次应用链式法则：\n$$\n\\frac{\\partial^2 \\xi}{\\partial y^2} = \\frac{\\partial \\xi_y}{\\partial \\xi}\\frac{\\partial \\xi}{\\partial y} + \\frac{\\partial \\xi_y}{\\partial \\eta}\\frac{\\partial \\eta}{\\partial y} = \\xi_y \\frac{\\partial \\xi_y}{\\partial \\xi} + 2 \\frac{\\partial \\xi_y}{\\partial \\eta}.\n$$\n我们需要 $\\xi_y$ 关于 $\\xi$ 和 $\\eta$ 的偏导数：\n$$\n\\frac{\\partial \\xi_y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}\\left(-\\frac{2\\beta(1+\\xi)}{2+\\beta+\\beta\\eta}\\right) = -\\frac{2\\beta}{2+\\beta+\\beta\\eta}.\n$$\n$$\n\\frac{\\partial \\xi_y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}\\left(-\\frac{2\\beta(1+\\xi)}{2+\\beta+\\beta\\eta}\\right) = -2\\beta(1+\\xi) \\frac{-\\beta}{(2+\\beta+\\beta\\eta)^2} = \\frac{2\\beta^2(1+\\xi)}{(2+\\beta+\\beta\\eta)^2}.\n$$\n我们在中心点 $(\\xi,\\eta)=(0,0)$ 处计算这些表达式的值：\n在 $(\\xi,\\eta)=(0,0)$ 处：\n$$\n\\xi_y = -\\frac{2\\beta(1+0)}{2+\\beta+\\beta(0)} = -\\frac{2\\beta}{2+\\beta}.\n$$\n$$\n\\frac{\\partial \\xi_y}{\\partial \\xi} = -\\frac{2\\beta}{2+\\beta+\\beta(0)} = -\\frac{2\\beta}{2+\\beta}.\n$$\n$$\n\\frac{\\partial \\xi_y}{\\partial \\eta} = \\frac{2\\beta^2(1+0)}{(2+\\beta+\\beta(0))^2} = \\frac{2\\beta^2}{(2+\\beta)^2}.\n$$\n现在，将这些值代入二阶导数的表达式中：\n$$\n\\left.\\frac{\\partial^2 \\xi}{\\partial y^2}\\right|_{(\\xi,\\eta)=(0,0)} = \\left(-\\frac{2\\beta}{2+\\beta}\\right) \\left(-\\frac{2\\beta}{2+\\beta}\\right) + 2 \\left(\\frac{2\\beta^2}{(2+\\beta)^2}\\right)\n$$\n$$\n\\left.\\frac{\\partial^2 \\xi}{\\partial y^2}\\right|_{(\\xi,\\eta)=(0,0)} = \\frac{4\\beta^2}{(2+\\beta)^2} + \\frac{4\\beta^2}{(2+\\beta)^2} = \\frac{8\\beta^2}{(2+\\beta)^2}.\n$$\n由于 $\\frac{\\partial^2 p}{\\partial y^2} = \\frac{\\partial^2 \\xi}{\\partial y^2}$，这就是最终结果。当 $\\beta \\neq 0$ 时，该值非零，这证实了双线性映射后的函数 $p(x,y)$ 在物理坐标系中不是一个简单的多项式（特别是不是线性的），表明了扭曲单元丧失了多项式保持特性。", "answer": "$$\n\\boxed{\\frac{8\\beta^2}{(2+\\beta)^2}}\n$$", "id": "2545386"}, {"introduction": "在有限元分析的实际应用中，通常使用数值积分（高斯求积）来计算单元矩阵，而为了提高计算效率，有时会采用“减缩积分”方案。本练习将探讨减缩积分对线性弹性问题中双线性四边形（$Q_1$）单元的双重影响。一方面，你需要证明该方法依然能够通过线性场的“小片检验”（patch test），从而保持了线性完备性；另一方面，它也引入了被称为“沙漏模式”的非物理、零刚度变形。这个动手实践清晰地展示了有限元方法中的一个关键权衡：即在计算成本、精度和数值稳定性之间取得平衡，将完备性理论与实际工程决策联系起来。[@problem_id:2545371]", "problem": "考虑一个用于平面应变下二维线性弹性力学问题的四节点双线性四边形单元（一个 $Q_1$ 单元），该单元通过从父单元方域 $\\{(\\xi,\\eta): -1 \\le \\xi,\\eta \\le 1\\}$ 到一个物理矩形单元的等参数仿射映射构成，该物理矩形单元的节点位于 $(-a,-b)$、$(a,-b)$、$(a,b)$、$(-a,b)$，其中 $a>0$ 且 $b>0$。假设材料是均质、线弹性、各向同性的，其本构矩阵 $\\mathbf{C}\\in\\mathbb{R}^{3\\times 3}$ 为正定矩阵。有限元法（FEM）的单元刚度通过减缩积分进行组装：即在单元中心 $(\\xi,\\eta)=(0,0)$ 处使用单个高斯点和标准高斯权重。记 $\\mathbf{B}(\\xi,\\eta)\\in\\mathbb{R}^{3\\times 8}$ 为常规的应变-位移矩阵，$\\mathbf{K}_e$ 为单元刚度矩阵，$\\mathbf{d}\\in\\mathbb{R}^{8}$ 为节点位移自由度向量，其顺序为 $(u_{1x},u_{1y},u_{2x},u_{2y},u_{3x},u_{3y},u_{4x},u_{4y})^{\\mathsf{T}}$。\n\n仅使用等参数 $Q_1$ 插值（单位分解和线性场精确再现）和高斯积分的基本性质，回答以下问题：\n\n- 在任意线性位移场 $\\mathbf{u}(\\mathbf{x})=\\mathbf{u}_0+\\mathbf{H}\\mathbf{x}$（其中 $\\mathbf{u}_0\\in\\mathbb{R}^{2}$ 和 $\\mathbf{H}\\in\\mathbb{R}^{2\\times 2}$ 是常数）下，严格证明为何对于此 $Q_1$ 单元，单点减缩积分能够保持线性完备性。你的证明必须从线性弹性力学的变分（弱）形式以及单元刚度定义为 $\\mathbf{B}^{\\mathsf{T}}\\mathbf{C}\\mathbf{B}$ 在单元上的积分开始。\n\n- 然后，在相同的设定下（单个单元、平面应变、各向同性 $\\mathbf{C}$、中心点单点减缩积分），确定伪零能模式（沙漏模式）的数量，其定义为 $\\mathbf{K}_e$ 的零空间维数减去刚体模态的数量。将计算出的数值表示为整数。\n\n只提供最终的整数作为答案。无需四舍五入。无需物理单位。", "solution": "所提出的问题是有效的，因为它在科学上基于有限元法的理论，是适定的、客观的且自洽的。我将按要求分两部分进行解答。\n\n第一部分：线性完备性证明\n\n单元刚度矩阵 $\\mathbf{K}_e$ 根据虚功原理定义为应变-位移矩阵 $\\mathbf{B}$、本构矩阵 $\\mathbf{C}$ 和应变-位移矩阵转置 $\\mathbf{B}^\\mathsf{T}$ 的乘积在单元体积上的积分。对于单位厚度的二维问题，这是在单元面积 $A_e$ 上的积分：\n$$\n\\mathbf{K}_e = \\int_{A_e} \\mathbf{B}(\\mathbf{x})^\\mathsf{T} \\mathbf{C} \\mathbf{B}(\\mathbf{x}) \\, dA\n$$\n使用从父单元域 $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ 到物理域 $(x, y)$ 的等参数映射，积分变为：\n$$\n\\mathbf{K}_e = \\int_{-1}^{1} \\int_{-1}^{1} \\mathbf{B}(\\xi, \\eta)^\\mathsf{T} \\mathbf{C} \\mathbf{B}(\\xi, \\eta) \\det(\\mathbf{J}) \\, d\\xi d\\eta\n$$\n其中 $\\mathbf{J}$ 是映射 $\\mathbf{x}(\\xi, \\eta)$ 的雅可比矩阵。对于指定的节点位于 $(\\pm a, \\pm b)$ 的矩形单元，该映射是仿射的：$x = a\\xi$ 且 $y = b\\eta$。雅可比矩阵为常数：\n$$\n\\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} a & 0 \\\\ 0 & b \\end{pmatrix}\n$$\n其行列式为 $\\det(\\mathbf{J}) = ab$，也是一个常数。父单元的总面积为 $4$，物理单元的面积为 $4ab$。\n\n问题指出使用在 $(\\xi, \\eta) = (0,0)$ 处的单点高斯积分。该单点的高斯权重为 $W_1 = 4$。因此，刚度矩阵近似为：\n$$\n\\mathbf{K}_e \\approx \\left. [ \\mathbf{B}(\\xi, \\eta)^\\mathsf{T} \\mathbf{C} \\mathbf{B}(\\xi, \\eta) \\det(\\mathbf{J}) ] \\right|_{(\\xi,\\eta)=(0,0)} \\times W_1 = 4ab \\cdot \\mathbf{B}(0,0)^\\mathsf{T} \\mathbf{C} \\mathbf{B}(0,0)\n$$\n线性完备性，也称为通过分片检验（patch test），要求单元格式能够精确再现任意常应变状态。考虑一个任意线性位移场 $\\mathbf{u}(\\mathbf{x}) = \\mathbf{u}_0 + \\mathbf{H}\\mathbf{x}$，其中 $\\mathbf{u}_0$ 是一个常向量，$\\mathbf{H}$ 是一个常矩阵。该位移场在整个区域内产生一个常应变张量：$\\boldsymbol{\\varepsilon}_{exact} = \\frac{1}{2}(\\mathbf{H} + \\mathbf{H}^\\mathsf{T})$。单元内对应的应变能为 $U_e = \\frac{1}{2} \\int_{A_e} \\boldsymbol{\\varepsilon}_{exact}^\\mathsf{T} \\mathbf{C} \\boldsymbol{\\varepsilon}_{exact} \\, dA$。由于被积函数是常数，精确的能量即为 $U_e = \\frac{1}{2} A_e (\\boldsymbol{\\varepsilon}_{exact}^\\mathsf{T} \\mathbf{C} \\boldsymbol{\\varepsilon}_{exact}) = 2ab (\\boldsymbol{\\varepsilon}_{exact}^\\mathsf{T} \\mathbf{C} \\boldsymbol{\\varepsilon}_{exact})$。\n\n关键点在于分析，当节点位移 $\\mathbf{d}$ 对应于线性场时，单元格式在单个高斯点 $(\\xi, \\eta) = (0,0)$ 处计算出的应变。有限元应变由 $\\boldsymbol{\\varepsilon}^h(\\xi, \\eta) = \\mathbf{B}(\\xi, \\eta)\\mathbf{d}$ 给出。$\\mathbf{B}$ 矩阵的分量由形函数 $N_i$ 的空间导数导出。对于给定的仿射映射，$\\frac{\\partial}{\\partial x} = \\frac{1}{a}\\frac{\\partial}{\\partial \\xi}$ 且 $\\frac{\\partial}{\\partial y} = \\frac{1}{b}\\frac{\\partial}{\\partial \\eta}$。形函数的导数为：\n$$\n\\frac{\\partial N_i}{\\partial x} = \\frac{1}{a} \\frac{\\xi_i}{4}(1+\\eta_i\\eta), \\quad \\frac{\\partial N_i}{\\partial y} = \\frac{1}{b} \\frac{\\eta_i}{4}(1+\\xi_i\\xi)\n$$\n在中心点 $(\\xi, \\eta) = (0,0)$，这些导数简化为 $\\frac{\\partial N_i}{\\partial x}|_{(0,0)} = \\frac{\\xi_i}{4a}$ 和 $\\frac{\\partial N_i}{\\partial y}|_{(0,0)} = \\frac{\\eta_i}{4b}$。\n中心的应变分量 $\\varepsilon_{xx}$ 是 $\\varepsilon_{xx}(0,0) = \\sum_{i=1}^4 \\frac{\\partial N_i}{\\partial x}|_{(0,0)} u_{ix}$。设线性位移场为 $u_x = c_1 + c_2 x + c_3 y$。节点位移为 $u_{ix} = c_1 + c_2 x_i + c_3 y_i = c_1 + c_2 a \\xi_i + c_3 b \\eta_i$。应变为：\n$$\n\\varepsilon_{xx}(0,0) = \\sum_{i=1}^4 \\frac{\\xi_i}{4a} (c_1 + c_2 a \\xi_i + c_3 b \\eta_i) = \\frac{1}{4a} \\left( c_1 \\sum \\xi_i + c_2 a \\sum \\xi_i^2 + c_3 b \\sum \\xi_i \\eta_i \\right)\n$$\n利用节点坐标 $(\\xi_i, \\eta_i) \\in \\{(\\pm 1, \\pm 1)\\}$ 的性质，我们有 $\\sum \\xi_i=0$、$\\sum \\xi_i^2=4$ 和 $\\sum \\xi_i \\eta_i=0$。代入这些值可得：\n$$\n\\varepsilon_{xx}(0,0) = \\frac{1}{4a} (c_2 a \\cdot 4) = c_2\n$$\n这对于给定的线性场是应变分量 $\\varepsilon_{xx}$ 的精确值。类似的计算表明，应变向量 $\\boldsymbol{\\varepsilon}^h(0,0)$ 的所有分量都是精确的。\n由于对于任意线性位移场，在高斯点处计算的应变都是精确的，并且由于该应变在整个单元内是常数，单点积分计算出的应变能是精确的：\n$$\nU_e^{FEM} = \\frac{1}{2} A_e (\\boldsymbol{\\varepsilon}^h(0,0)^\\mathsf{T} \\mathbf{C} \\boldsymbol{\\varepsilon}^h(0,0)) = \\frac{1}{2} A_e (\\boldsymbol{\\varepsilon}_{exact}^\\mathsf{T} \\mathbf{C} \\boldsymbol{\\varepsilon}_{exact}) = U_e^{exact}\n$$\n因为该格式对于任意常应变状态都能计算出精确的能量，所以它通过了分片检验。这严格证明了单点减缩积分对该单元保持了线性完备性。\n\n第二部分：伪零能模式的确定\n\n零能模式是一个非零的节点位移向量 $\\mathbf{d}$，它导致应变能为零，即 $U_e = 0$。使用刚度矩阵的减缩积分公式，应变能为：\n$$\nU_e = \\frac{1}{2}\\mathbf{d}^\\mathsf{T} \\mathbf{K}_e \\mathbf{d} = \\frac{1}{2}\\mathbf{d}^\\mathsf{T} (4ab \\cdot \\mathbf{B}(0,0)^\\mathsf{T} \\mathbf{C} \\mathbf{B}(0,0)) \\mathbf{d} = 2ab \\cdot (\\mathbf{B}(0,0)\\mathbf{d})^\\mathsf{T} \\mathbf{C} (\\mathbf{B}(0,0)\\mathbf{d})\n$$\n由于面积 $A_e=4ab$ 是正的且材料矩阵 $\\mathbf{C}$ 是正定的，应变能为零当且仅当高斯点处的应变向量为零：\n$$\n\\boldsymbol{\\varepsilon}(0,0) = \\mathbf{B}(0,0)\\mathbf{d} = \\mathbf{0}\n$$\n因此，所有零能模式的集合是矩阵 $\\mathbf{B}(0,0)$ 的零空间。对于平面应变问题，这是一个 $3 \\times 8$ 的矩阵（3个应变分量，8个自由度）。\n$$\n\\mathbf{B}(0,0) = \\frac{1}{4} \\begin{pmatrix}\n-1/a & 0 & 1/a & 0 & 1/a & 0 & -1/a & 0 \\\\\n0 & -1/b & 0 & -1/b & 0 & 1/b & 0 & 1/b \\\\\n-1/b & -1/a & -1/b & 1/a & 1/b & 1/a & 1/b & -1/a\n\\end{pmatrix}\n$$\n我们应用秩-零度定理来求此零空间的维数：\n$$\n\\dim(\\text{Null}(\\mathbf{B}(0,0))) = \\text{列数} - \\text{rank}(\\mathbf{B}(0,0))\n$$\n列数为 $8$。为求该矩阵的秩，我们检验其三行向量的线性无关性。可以证明，若这三行的任意线性组合等于零向量，则所有系数必为零。因此，这三行是线性无关的，矩阵的秩为 $3$。\n$\\mathbf{K}_e$ 的零空间维数（即零能模式的总数）是：\n$$\n\\dim(\\text{Null}(\\mathbf{K}_e)) = 8 - 3 = 5\n$$\n这个5维模态空间包括了物理刚体运动，根据定义，刚体运动必须产生零应变，因此其应变能为零。对于一个二维物体，存在3种刚体模态：两种平移和一种平面内旋转。\n问题要求的是伪零能模式（也称为沙漏模式）的数量。它们是指那些不属于刚体运动的零能模式。\n$$\n\\text{伪模式数量} = \\dim(\\text{Null}(\\mathbf{K}_e)) - \\text{刚体模态数量}\n$$\n$$\n\\text{伪模式数量} = 5 - 3 = 2\n$$\n因此，对于采用单点减缩积分的该单元，存在2个伪零能模式。", "answer": "$$\\boxed{2}$$", "id": "2545371"}]}