{"hands_on_practices": [{"introduction": "在求解需要解的导数连续的物理问题（如板和壳的弯曲）时，构造保证全局 $C^1$ 连续性的有限元是至关重要的。本练习将指导您从头开始构建一个二维三次 Hermite 矩形单元，这是一种经典的 $C^1$ 协调单元。通过推导其形函数，您将亲身体会到，在节点上包含导数值作为自由度是实现跨单元边界导数连续性的关键所在 [@problem_id:2553873]。", "problem": "令参考单元为矩形 $\\Omega_{e} = \\{ (\\xi,\\eta) \\,:\\, \\xi \\in [-1,1], \\ \\eta \\in [-1,1] \\}$。考虑在 $\\Omega_{e}$ 上使用一个双三次多项式来逼近标量场 $u(\\xi,\\eta)$，该多项式适用于有限元法（FEM）。目标是构造一个二维三次 Hermite 单元，该单元在轴对齐的矩形网格上，能够保证跨单元边界的一阶导数连续性（记为 $C^{1}$ 连续性）。\n\n从 $C^{1}$ 单元间相容性要求 $u$ 及其一阶导数的迹在任意公共边上连续这一核心定义出发，按以下步骤进行：\n\n1) 在一维区间 $[-1,1]$上，推导四个三次多项式 $H_{1}(\\xi)$、$H_{2}(\\xi)$、$H_{3}(\\xi)$ 和 $H_{4}(\\xi)$，它们作为与端点 $\\xi=-1$ 和 $\\xi=1$ 处的节点数据相关联的 Hermite 基。具体而言，要求每个 $H_{i}$ 满足插值条件，以确保在其关联的端点上精确地再现节点值和节点一阶导数，而在相对的端点上这些量为零。具体地，对于端点 $\\xi=-1$，要求 $H_{1}(-1)=1$，$H_{1}'(-1)=0$，$H_{1}(1)=0$，$H_{1}'(1)=0$ 以及 $H_{2}(-1)=0$，$H_{2}'(-1)=1$，$H_{2}(1)=0$，$H_{2}'(1)=0$。对于端点 $\\xi=1$，要求 $H_{3}(-1)=0$，$H_{3}'(-1)=0$，$H_{3}(1)=1$，$H_{3}'(1)=0$ 以及 $H_{4}(-1)=0$，$H_{4}'(-1)=0$，$H_{4}(1)=0$，$H_{4}'(1)=1$。\n\n2) 在 $\\Omega_{e}$ 上使用张量积构造方法，为位于四个角点 $(\\xi,\\eta) \\in \\{(-1,-1),(1,-1),(1,1),(-1,1)\\}$ 的 16 个节点量建立双三次 Hermite 形函数，其中每个角点的自由度为 $\\{u, u_{,\\xi}, u_{,\\eta}, u_{,\\xi\\eta}\\}$。每个节点量对应的形函数必须是关于 $\\xi$ 和 $\\eta$ 的合适的一维 Hermite 多项式的乘积，该乘积形式与其作为函数值、关于 $\\xi$ 的一阶导数、关于 $\\eta$ 的一阶导数或关于 $\\xi$ 和 $\\eta$ 的混合导数的角色相匹配。\n\n3) 根据 $C^{1}$ 连续性的定义，论证沿公共边相交的两个相邻矩形单元之间必须共享哪些节点量（即组装后为单值），并简要解释为什么当这些量被共享时，张量积构造能够满足沿边的 $C^{1}$ 连续性。\n\n最后，计算在参数点 $(\\xi,\\eta)=(\\tfrac{1}{2},-\\tfrac{1}{2})$ 处，对应于角点 $(\\xi,\\eta)=(1,1)$ 处节点位移 $u$ 的形函数的值。将此值作为最终答案。无需四舍五入，请给出精确值。", "solution": "所述问题在科学上是合理的、提法是适定的，并包含了获得唯一解所需的所有信息。这是有限元法理论中的一个标准问题。我们按以下步骤求解。\n\n首先，我们在区间 $\\xi \\in [-1,1]$ 上推导一维三次 Hermite 基函数。一个一般的三次多项式可以写为 $p(\\xi) = a\\xi^3 + b\\xi^2 + c\\xi + d$，其导数为 $p'(\\xi) = 3a\\xi^2 + 2b\\xi + c$。我们必须找到四个这样的多项式 $H_1(\\xi)$, $H_2(\\xi)$, $H_3(\\xi)$ 和 $H_4(\\xi)$，每个多项式都满足一组给定的四个插值条件。\n\n对于 $H_1(\\xi)$，条件是 $H_1(-1)=1$，$H_1'(-1)=0$，$H_1(1)=0$ 和 $H_1'(1)=0$。这导出了关于系数 $(a,b,c,d)$ 的如下线性方程组：\n$$\n\\begin{cases}\n-a + b - c + d = 1 \\\\\na + b + c + d = 0 \\\\\n3a - 2b + c = 0 \\\\\n3a + 2b + c = 0\n\\end{cases}\n$$\n从后两个方程中，两式相减得到 $4b=0$，所以 $b=0$。两式相加得到 $6a+2c=0$，所以 $c=-3a$。将 $b=0$ 和 $c=-3a$ 代入前两个方程，得到 $-a+3a+d=1$（即 $2a+d=1$）和 $a-3a+d=0$（即 $-2a+d=0$）。由第二个方程可得 $d=2a$。将其代入第一个方程可得 $2a+2a=1$，所以 $a=1/4$。因此，$d=1/2$，$c=-3/4$，$b=0$。该多项式为：\n$$H_1(\\xi) = \\frac{1}{4}\\xi^3 - \\frac{3}{4}\\xi + \\frac{1}{2}$$\n\n对于 $H_2(\\xi)$，条件是 $H_2(-1)=0$，$H_2'(-1)=1$，$H_2(1)=0$ 和 $H_2'(1)=0$。方程组为：\n$$\n\\begin{cases}\n-a + b - c + d = 0 \\\\\na + b + c + d = 0 \\\\\n3a - 2b + c = 1 \\\\\n3a + 2b + c = 0\n\\end{cases}\n$$\n前两个方程意味着 $b+d=0$ 和 $a+c=0$，所以 $d=-b$ 且 $c=-a$。后两个方程给出 $6a+2c=1$ 和 $-4b=1$。由 $-4b=1$ 可得 $b=-1/4$，所以 $d=1/4$。由 $6a+2c=1$ 和 $c=-a$ 可得 $6a-2a=1$，这给出 $a=1/4$。因此，$c=-1/4$。该多项式为：\n$$H_2(\\xi) = \\frac{1}{4}\\xi^3 - \\frac{1}{4}\\xi^2 - \\frac{1}{4}\\xi + \\frac{1}{4}$$\n\n$H_3(\\xi)$ 和 $H_4(\\xi)$ 函数可以通过对称性求得。$H_3(\\xi)$ 必须满足 $H_3(-1)=0$, $H_3'(-1)=0$, $H_3(1)=1$, $H_3'(1)=0$。这些条件与 $H_1(-\\xi)$ 满足的条件相同。因此，$H_3(\\xi) = H_1(-\\xi)$：\n$$H_3(\\xi) = \\frac{1}{4}(-\\xi)^3 - \\frac{3}{4}(-\\xi) + \\frac{1}{2} = -\\frac{1}{4}\\xi^3 + \\frac{3}{4}\\xi + \\frac{1}{2}$$\n类似地，$H_4(\\xi)$ 必须满足 $H_4(-1)=0$, $H_4'(-1)=0$, $H_4(1)=0$, $H_4'(1)=1$。这些条件可由 $-H_2(-\\xi)$ 满足。因此，$H_4(\\xi) = -H_2(-\\xi)$：\n$$H_4(\\xi) = - \\left( \\frac{1}{4}(-\\xi)^3 - \\frac{1}{4}(-\\xi)^2 - \\frac{1}{4}(-\\xi) + \\frac{1}{4} \\right) = \\frac{1}{4}\\xi^3 + \\frac{1}{4}\\xi^2 - \\frac{1}{4}\\xi - \\frac{1}{4}$$\n\n接下来，我们使用张量积构造法在参考正方形 $\\Omega_e$ 上构造双三次 Hermite 形函数。16个自由度（DOF）是在四个角点 $(\\xi_i, \\eta_j)$（其中 $\\xi_i, \\eta_j \\in \\{-1,1\\}$）处的函数值 $u$、其一阶导数 $u_{,\\xi}$ 和 $u_{,\\eta}$ 以及其混合导数 $u_{,\\xi\\eta}$ 的值。近似解 $u_h(\\xi, \\eta)$ 是16个形函数的线性组合，每个形函数乘以一个节点自由度。形函数 $N(\\xi,\\eta)$ 是一个关于 $\\xi$ 的一维基函数和一个关于 $\\eta$ 的一维基函数的乘积。让我们区分用于函数值的基函数（我们称之为“值”函数，$H_1, H_3$）和用于导数值的基函数（“导数”函数，$H_2, H_4$）。特定自由度的形函数是通过为每个变量选择对应于该自由度类型的一维函数来构造的。例如，角点上自由度 $u_{,\\xi}$ 的形函数涉及一个关于 $\\xi$ 的“导数”函数和一个关于 $\\eta$ 的“值”函数。在坐标为 $(\\xi_i, \\eta_j)$ 的角点，四个形函数是：\n-   对于 $u$：$N^u(\\xi,\\eta) = H_{val}(\\xi, \\xi_i) H_{val}(\\eta, \\eta_j)$\n-   对于 $u_{,\\xi}$：$N^{u_\\xi}(\\xi,\\eta) = H_{der}(\\xi, \\xi_i) H_{val}(\\eta, \\eta_j)$\n-   对于 $u_{,\\eta}$：$N^{u_\\eta}(\\xi,\\eta) = H_{val}(\\xi, \\xi_i) H_{der}(\\eta, \\eta_j)$\n-   对于 $u_{,\\xi\\eta}$：$N^{u_{\\xi\\eta}}(\\xi,\\eta) = H_{der}(\\xi, \\xi_i) H_{der}(\\eta, \\eta_j)$\n其中 $H_{val}(\\cdot, -1)=H_1$，$H_{der}(\\cdot, -1)=H_2$，$H_{val}(\\cdot, 1)=H_3$，以及 $H_{der}(\\cdot, 1)=H_4$。\n\n我们现在论证跨单元边界的 $C^1$ 连续性。考虑两个单元共享的一条边，例如，单元 A 在 $\\xi=1$ 处的边和单元 B 在 $\\xi=-1$ 处的边。\n函数 $u$ 的连续性要求 $u_h(\\xi,\\eta)$ 沿该边的迹由该边上的自由度唯一确定。我们来考察 $u_h$ 沿 $\\xi=1$ 的迹：\n$u_h(1,\\eta)$。其完整展开式是所有16个自由度的总和。然而，根据构造，$H_1(1)=0$，$H_2(1)=0$，$H_1'(1)=0$ 和 $H_2'(1)=0$。这意味着任何与 $\\xi=-1$ 处节点相关联的形函数在直线 $\\xi=1$ 上都为零。因此，迹 $u_h(1,\\eta)$ 仅由该边上节点处的自由度确定，即点 $(1,-1)$ 和 $(1,1)$ 处的自由度。表达式简化为：\n$$ u_h(1, \\eta) = u(1,-1)H_3(1)H_1(\\eta) + u_{,\\eta}(1,-1)H_3(1)H_2(\\eta) + u(1,1)H_3(1)H_3(\\eta) + u_{,\\eta}(1,1)H_3(1)H_4(\\eta) $$\n由于 $H_3(1)=1$，上式变为：\n$$ u_h(1, \\eta) = u(1,-1)H_1(\\eta) + u_{,\\eta}(1,-1)H_2(\\eta) + u(1,1)H_3(\\eta) + u_{,\\eta}(1,1)H_4(\\eta) $$\n这是沿该边的一维三次 Hermite 表示，它完全由该边两个角点处的四个节点自由度 $\\{u, u_{,\\eta}\\}$ 确定。\n类似地，对于单元 B，迹 $u_h(-1,\\eta)$ 由其在 $\\xi=-1$ 边上的自由度 $\\{u, u_{,\\eta}\\}$ 确定。如果两个单元在其公共节点上共享这四个自由度，则函数 $u$ 将跨越其边界连续。\n\n一阶导数的连续性要求法向导数的连续性。对于轴对齐的矩形网格，跨越垂直边的法向导数，除去一个来自单元雅可比矩阵的缩放因子，就是 $\\frac{\\partial u}{\\partial \\xi}$。我们考察 $\\frac{\\partial u_h}{\\partial \\xi}$ 沿 $\\xi=1$ 的迹。将 $u_h$ 的展开式对 $\\xi$ 求导并在 $\\xi=1$ 处求值，会涉及 $H_i'(1)$ 这样的项。根据构造，$H_1'(1)=0, H_2'(1)=0, H_3'(1)=0$，但 $H_4'(1)=1$。因此，只有涉及 $H_4'(\\xi)$ 的项或源自 $\\xi=1$ 处自由度 $u_{,\\xi}$ 和 $u_{,\\xi\\eta}$ 的项会保留下来。该迹为：\n$$ \\frac{\\partial u_h}{\\partial \\xi}(1,\\eta) = u_{,\\xi}(1,-1)H_4'(1)H_1(\\eta) + u_{,\\xi\\eta}(1,-1)H_4'(1)H_2(\\eta) + u_{,\\xi}(1,1)H_4'(1)H_3(\\eta) + u_{,\\xi\\eta}(1,1)H_4'(1)H_4(\\eta) $$\n由于 $H_4'(1)=1$，上式变为：\n$$ \\frac{\\partial u_h}{\\partial \\xi}(1, \\eta) = u_{,\\xi}(1,-1)H_1(\\eta) + u_{,\\xi\\eta}(1,-1)H_2(\\eta) + u_{,\\xi}(1,1)H_3(\\eta) + u_{,\\xi\\eta}(1,1)H_4(\\eta) $$\n该迹同样是一个一维三次 Hermite 表示，由该边角点处的四个节点自由度 $\\{u_{,\\xi}, u_{,\\xi\\eta}\\}$ 决定。如果相邻单元共享这四个自由度，则法向导数将是连续的。\n因此，为确保 $C^1$ 连续性，公共边界上节点的所有自由度 $\\{u, u_{,\\xi}, u_{,\\eta}, u_{,\\xi\\eta}\\}$ 都必须共享。张量积构造方法内在地满足了这一要求，因为在任意一条边上的行为完全由位于该边上的自由度决定。\n\n最后，我们在点 $(\\xi,\\eta)=(\\frac{1}{2},-\\frac{1}{2})$ 处，计算对应于角点 $(\\xi, \\eta)=(1,1)$ 的节点位移 $u$ 的形函数的值。该形函数为 $N(\\xi,\\eta) = H_3(\\xi)H_3(\\eta)$。我们必须计算 $N(\\frac{1}{2}, -\\frac{1}{2}) = H_3(\\frac{1}{2}) H_3(-\\frac{1}{2})$。\n我们使用表达式 $H_3(s) = -\\frac{1}{4}s^3 + \\frac{3}{4}s + \\frac{1}{2}$。\n首先，对于 $s = \\frac{1}{2}$：\n$$ H_3\\left(\\frac{1}{2}\\right) = -\\frac{1}{4}\\left(\\frac{1}{2}\\right)^3 + \\frac{3}{4}\\left(\\frac{1}{2}\\right) + \\frac{1}{2} = -\\frac{1}{4}\\left(\\frac{1}{8}\\right) + \\frac{3}{8} + \\frac{1}{2} = -\\frac{1}{32} + \\frac{12}{32} + \\frac{16}{32} = \\frac{27}{32} $$\n接下来，对于 $s = -\\frac{1}{2}$：\n$$ H_3\\left(-\\frac{1}{2}\\right) = -\\frac{1}{4}\\left(-\\frac{1}{2}\\right)^3 + \\frac{3}{4}\\left(-\\frac{1}{2}\\right) + \\frac{1}{2} = -\\frac{1}{4}\\left(-\\frac{1}{8}\\right) - \\frac{3}{8} + \\frac{1}{2} = \\frac{1}{32} - \\frac{12}{32} + \\frac{16}{32} = \\frac{5}{32} $$\n该形函数的值是这两个值的乘积：\n$$ N\\left(\\frac{1}{2}, -\\frac{1}{2}\\right) = \\left(\\frac{27}{32}\\right) \\times \\left(\\frac{5}{32}\\right) = \\frac{135}{1024} $$", "answer": "$$\\boxed{\\frac{135}{1024}}$$", "id": "2553873"}, {"introduction": "在通过具体实例建立了直观理解后，是时候将单元间连续性的概念提升到更普适和严谨的层面了。本练习要求您从基本原理出发，推导确保 $C^1$ 连续性所需的一般代数条件。您将把沿共享边的函数迹和法向导数迹表示为多项式，并确定它们的系数必须满足何种关系，从而将几何上的连续性要求转化为一组精确的代数约束 [@problem_id:2553950]。", "problem": "考虑在有限元法 (FEM) 中，在一个三角剖分上构造整体 $C^{1}$ 函数的以下设定。设 $\\Omega = [0,1] \\times [0,1] \\subset \\mathbb{R}^{2}$ 被从 $(1,0)$ 到 $(0,1)$ 的对角线剖分为两个三角形：\n- $T_{1} = \\operatorname{conv}\\{(0,0),(1,0),(0,1)\\}$,\n- $T_{2} = \\operatorname{conv}\\{(1,1),(1,0),(0,1)\\}$。\n共享的内部边是 $E = \\{(s,1-s) : s \\in [0,1]\\}$，其单位切向量为 $t = \\frac{1}{\\sqrt{2}}(1,-1)$。\n\n定义一个分片多项式函数 $u$ 如下：\n- $u|_{T_{1}}(x,y) = p_{1}(x,y) = x(x+y-1)$,\n- $u|_{T_{2}}(x,y) = p_{2}(x,y) = y(x+y-1)$。\n\n仅使用 $C^{0}$ 和 $C^{1}$ 连续性以及沿边的切向导数的基本定义：如果一个函数在一条边上的迹相匹配，则它在该边上是 $C^{0}$ 的；如果除此以外，它的梯度也沿该边匹配，则它在该边上是 $C^{1}$ 的；切向导数是沿该边的 $\\partial_{t} u = \\nabla u \\cdot t$。\n\n任务：\n1) 从基本原理出发，验证沿着 $E$ 的整个内部，$u$ 从 $T_{1}$ 和 $T_{2}$ 的迹是重合的，并且 $\\partial_{t} u$ 在 $E$ 上也是连续的（即，从 $T_{1}$ 和 $T_{2}$ 的切向导数沿 $E$ 重合）。\n2) 计算梯度 $\\nabla p_{1}$ 和 $\\nabla p_{2}$ 在顶点 $v = (1,0)$ 的值，并解释为什么尽管 $u$ 和 $\\partial_{t} u$ 满足边上的连续性，但这表明 $u$ 在 $v$ 点不是 $C^{1}$ 的。\n3) 设在顶点 $v$ 的梯度跳跃为向量 $J = \\nabla p_{1}(v) - \\nabla p_{2}(v)$。精确计算欧几里得范数 $\\|J\\|_{2}$。\n\n你的最终答案应为 $\\|J\\|_{2}$ 的精确值（无单位，不四舍五入）。", "solution": "该问题陈述被验证为具有科学依据、适定且客观。它提出了一个关于有限元法 (FEM) 中单元间连续性的标准的、不平凡的练习。我们将继续进行解答。\n\n问题要求我们分析在一个域 $\\Omega = [0,1] \\times [0,1]$ 上定义的分片多项式函数 $u$ 的连续性，该域被剖分为两个三角形 $T_{1} = \\operatorname{conv}\\{(0,0),(1,0),(0,1)\\}$ 和 $T_{2} = \\operatorname{conv}\\{(1,1),(1,0),(0,1)\\}$。函数 $u$ 定义为 $u|_{T_{1}}(x,y) = p_{1}(x,y) = x(x+y-1)$ 和 $u|_{T_{2}}(x,y) = p_{2}(x,y) = y(x+y-1)$。共享边为 $E = \\{(s, 1-s) : s \\in [0,1]\\}$。\n\n**任务1：验证沿边 $E$ 的 $C^{0}$ 连续性和切向导数连续性。**\n\n首先，我们验证 $C^{0}$ 连续性。如果一个函数在一条边上，从两个相邻单元的取值（迹）沿整条边都重合，那么这个函数就是 $C^{0}$ 连续的。边 $E$ 上的点 $(x,y)$ 满足线性方程 $x+y-1=0$。\n$p_{1}$ 在 $E$ 上的迹是通过将其表达式中的 $y$ 替换为 $1-x$（或更一般地，识别出 $x+y-1=0$）得到的：\n$$ u|_{T_{1}, E} = p_{1}(x,y)|_{x+y-1=0} = x(0) = 0 $$\n$p_{2}$ 在 $E$ 上的迹也类似地计算：\n$$ u|_{T_{2}, E} = p_{2}(x,y)|_{x+y-1=0} = y(0) = 0 $$\n由于两个迹沿边 $E$ 恒为零，我们在 $E$ 上有 $p_{1} = p_{2}$。因此，函数 $u$ 在边 $E$ 的内部是 $C^{0}$ 连续的。\n\n接下来，我们验证切向导数 $\\partial_{t}u = \\nabla u \\cdot t$ 的连续性，其中 $t = \\frac{1}{\\sqrt{2}}(1,-1)$ 是 $E$ 的单位切向量。我们必须首先计算 $p_{1}$ 和 $p_{2}$ 的梯度。\n对于 $p_{1}(x,y) = x^{2} + xy - x$，其梯度为：\n$$ \\nabla p_{1}(x,y) = \\left( \\frac{\\partial p_{1}}{\\partial x}, \\frac{\\partial p_{1}}{\\partial y} \\right) = (2x + y - 1, x) $$\n对于 $p_{2}(x,y) = xy + y^{2} - y$，其梯度为：\n$$ \\nabla p_{2}(x,y) = \\left( \\frac{\\partial p_{2}}{\\partial x}, \\frac{\\partial p_{2}}{\\partial y} \\right) = (y, x + 2y - 1) $$\n现在，我们沿边 $E$ 计算这些梯度，该边可以参数化为 $(x,y) = (s, 1-s)$，其中 $s \\in [0,1]$。\n梯度 $\\nabla p_{1}$ 在 $E$ 上的迹是：\n$$ \\nabla p_{1}(s, 1-s) = (2s + (1-s) - 1, s) = (s, s) $$\n梯度 $\\nabla p_{2}$ 在 $E$ 上的迹是：\n$$ \\nabla p_{2}(s, 1-s) = (1-s, s + 2(1-s) - 1) = (1-s, 1-s) $$\n现在我们计算沿边 $E$ 的切向导数，其中 $s \\in (0,1)$：\n对于 $p_1$：\n$$ \\partial_{t} p_{1}|_{E} = \\nabla p_{1}(s, 1-s) \\cdot t = (s,s) \\cdot \\frac{1}{\\sqrt{2}}(1,-1) = \\frac{1}{\\sqrt{2}}(s \\cdot 1 + s \\cdot (-1)) = \\frac{1}{\\sqrt{2}}(s-s) = 0 $$\n对于 $p_2$：\n$$ \\partial_{t} p_{2}|_{E} = \\nabla p_{2}(s, 1-s) \\cdot t = (1-s, 1-s) \\cdot \\frac{1}{\\sqrt{2}}(1,-1) = \\frac{1}{\\sqrt{2}}((1-s) \\cdot 1 + (1-s) \\cdot (-1)) = 0 $$\n由于来自两边的切向导数沿边 $E$ 的内部恒为零，$\\partial_{t} u$ 确实在 $E$ 上是连续的。\n\n**任务2：分析在顶点 $v = (1,0)$ 处的连续性。**\n\n要使一个函数在域 $\\Omega$ 内是 $C^{1}$ 连续的，其梯度必须在 $\\Omega$ 中的每一点都连续。这要求在共享边界上的任何一点，无论逼近方向如何（即从哪个单元逼近），梯度都必须有一个唯一的值。我们在 $v=(1,0)$ 这个 $T_{1}$ 和 $T_{2}$ 的共享顶点上检验这个条件。\n\n我们计算 $p_{1}$ 和 $p_{2}$ 在此顶点的梯度：\n$$ \\nabla p_{1}(1,0) = (2(1) + 0 - 1, 1) = (1,1) $$\n$$ \\nabla p_{2}(1,0) = (0, 1 + 2(0) - 1) = (0,0) $$\n当 $(x,y)$ 从 $T_{1}$ 内部趋近 $v=(1,0)$ 时，$u$ 的梯度的极限是 $(1,1)$，而从 $T_{2}$ 内部趋近时的极限是 $(0,0)$。由于 $\\nabla p_{1}(v) \\neq \\nabla p_{2}(v)$，函数 $u$ 的梯度在顶点 $v$ 处没有唯一定义。因此， $u$ 在 $v$ 点不可微，并且在 $v$ 的任何开放邻域内都不是 $C^{1}$ 的，所以它在 $\\Omega$ 上也不是 $C^{1}$ 的。\n\n对于 $u$ 及其切向导数 $\\partial_{t} u$ 满足边上的连续性，是函数在一个单元交汇的顶点处 $C^{1}$ 连续的必要但不充分条件。一个顶点涉及到所有相邻单元的约束，确保完整梯度向量的连续性，比确保沿一条边的单个方向导数的连续性条件更严格。这个例子说明了构造 $C^{1}$ 有限元的一个基本困难。\n\n**任务3：计算梯度跳跃的范数。**\n\n在顶点 $v=(1,0)$ 的梯度跳跃定义为向量 $J = \\nabla p_{1}(v) - \\nabla p_{2}(v)$。使用任务2中计算的值：\n$$ J = (1,1) - (0,0) = (1,1) $$\n这个跳跃向量的欧几里得范数 $\\|J\\|_{2}$ 计算如下：\n$$ \\|J\\|_{2} = \\sqrt{1^{2} + 1^{2}} = \\sqrt{1 + 1} = \\sqrt{2} $$\n这个非零跳跃量化了梯度在顶点 $v$ 处的不连续性。", "answer": "$$\\boxed{\\sqrt{2}}$$", "id": "2553950"}, {"introduction": "在通过具体实例建立了直观理解后，是时候将单元间连续性的概念提升到更普适和严谨的层面了。本练习要求您从基本原理出发，推导确保 $C^1$ 连续性所需的一般代数条件。您将把沿共享边的函数迹和法向导数迹表示为多项式，并确定它们的系数必须满足何种关系，从而将几何上的连续性要求转化为一组精确的代数约束 [@problem_id:2553906]。", "problem": "考虑两个相邻的二维有限元，它们共享一条直的公共边 $e$。该边的端点通过一个仿射参数化 $t \\mapsto \\boldsymbol{x}(t)$ 映射到参数区间 $[-1,1]$。在每个单元上，有限元空间是一阶连续可微的 ($C^1$)，且其边迹是多项式：场 $u$ 沿边 $e$ 的迹属于多项式空间 $\\mathbb{P}_p([-1,1])$，法向导数 $\\partial_{\\boldsymbol{n}} u := \\nabla u \\cdot \\boldsymbol{n}$ 沿边 $e$ 的迹属于 $\\mathbb{P}_q([-1,1])$。其中，$\\boldsymbol{n}$ 是在边 $e$ 上一致选取的固定单位法向量（定义来自左单元和右单元的两个迹时使用相同的 $\\boldsymbol{n}$）。令 $u_L(t), u_R(t) \\in \\mathbb{P}_p([-1,1])$ 表示 $u$ 在边 $e$ 上的左迹和右迹，并令 $\\lambda_L(t), \\lambda_R(t) \\in \\mathbb{P}_q([-1,1])$ 表示 $\\partial_{\\boldsymbol{n}} u$ 的相应迹。假设在每一侧，这些迹分别在单项式基 $\\{t^k\\}_{k=0}^p$ 和 $\\{t^k\\}_{k=0}^q$ 中表示如下：\n$$\nu_L(t) = \\sum_{k=0}^{p} a_{L,k}\\, t^k,\\quad u_R(t) = \\sum_{k=0}^{p} a_{R,k}\\, t^k,\\quad\n\\lambda_L(t) = \\sum_{k=0}^{q} b_{L,k}\\, t^k,\\quad \\lambda_R(t) = \\sum_{k=0}^{q} b_{R,k}\\, t^k,\n$$\n其系数 $\\{a_{L,k}\\}_{k=0}^{p}$、$\\{a_{R,k}\\}_{k=0}^{p}$、$\\{b_{L,k}\\}_{k=0}^{q}$ 和 $\\{b_{R,k}\\}_{k=0}^{q}$ 是先验独立的。\n\n从连续性的定义和多项式相等的基本性质出发，完成以下任务：\n\n1. 在 $u_L(t) = u_R(t)$ 对所有 $t \\in [-1,1]$ 成立以及 $\\lambda_L(t) = \\lambda_R(t)$ 对所有 $t \\in [-1,1]$ 成立的意义下，推导施加于边系数上的必要且充分的代数条件，以强制实现 $u$ 及其法向导数 $\\partial_{\\boldsymbol{n}} u$ 跨边 $e$ 的连续性。你的推导必须独立于任何特定的节点或求积点的选择，且应仅依赖于以下事实：当且仅当在某个公共基下的所有系数都相同时，同一空间中的两个多项式才相等。\n\n2. 利用第1部分的结果和维数计数论证，确定为确保这两个连续性条件普遍成立，必须施加在 $2(p+1) + 2(q+1)$ 个边系数上的独立标量线性约束的最小数量，假设两个单元在边 $e$ 上使用相同的多项式次数 $p$ 和 $q$。将你的最终答案表示为关于 $p$ 和 $q$ 的闭式解析表达式。无需四舍五入，也不涉及物理单位。\n\n请仅提供第2部分所要求的最终表达式作为你的最终答案。", "solution": "该问题陈述已经过验证，被认定为具有科学依据、良定且客观。它代表了有限元方法中的一个标准理论问题。没有发现可识别的缺陷。我们可以开始解答。\n\n该问题要求推导跨共享单元边的连续性条件，并随后对这些条件进行计数。推导过程必须基于多项式相等的基本原则。\n\n一个多项式由其在给定基下的系数唯一确定。两个多项式 $P(t) = \\sum_{k=0}^{n} c_k \\phi_k(t)$ 和 $Q(t) = \\sum_{k=0}^{n} d_k \\phi_k(t)$，若在同一基 $\\{\\phi_k(t)\\}_{k=0}^{n}$ 下表示，则它们在一个区间内对所有 $t$ 都相等，当且仅当它们对应的系数相等，即对所有 $k \\in \\{0, 1, \\dots, n\\}$ 都有 $c_k = d_k$。这可以从基函数的线性无关性推导出来。如果 $P(t) = Q(t)$，那么它们的差是零多项式：$\\sum_{k=0}^{n} (c_k - d_k) \\phi_k(t) = 0$。基函数 $\\{\\phi_k(t)\\}$ 的线性无关性意味着这个线性组合的所有系数都必须为零，因此 $c_k - d_k = 0$。这就确立了条件的必要性和充分性。我们将此原则应用于给定的问题。\n\n单项式基 $\\{t^k\\}$ 在任何区间（包括 $[-1, 1]$）上都是一组线性无关的函数。\n\n第1部分：推导条件。\n\n首先，我们要求场 $u$ 连续。条件是来自左单元的迹 $u_L(t)$ 必须与来自右单元的迹 $u_R(t)$ 对所有 $t \\in [-1, 1]$ 都完全相同。\n$$\nu_L(t) = u_R(t) \\quad \\forall t \\in [-1, 1]\n$$\n代入在单项式基下的给定多项式表示：\n$$\n\\sum_{k=0}^{p} a_{L,k}\\, t^k = \\sum_{k=0}^{p} a_{R,k}\\, t^k\n$$\n这个方程可以重排，将两个多项式相等表示为单个多项式恒等于零：\n$$\n\\sum_{k=0}^{p} a_{L,k}\\, t^k - \\sum_{k=0}^{p} a_{R,k}\\, t^k = 0\n$$\n$$\n\\sum_{k=0}^{p} (a_{L,k} - a_{R,k})\\, t^k = 0 \\quad \\forall t \\in [-1, 1]\n$$\n根据上述多项式相等的原则，要使这个 $p$ 次多项式在一个区间上为零，其所有系数都必须为零。这就给出了关于系数 $\\{a_{L,k}\\}$ 和 $\\{a_{R,k}\\}$ 的以下必要且充分条件：\n$$\na_{L,k} - a_{R,k} = 0 \\quad \\text{for } k = 0, 1, \\dots, p\n$$\n或等价地，\n$$\na_{L,k} = a_{R,k} \\quad \\text{for } k = 0, 1, \\dots, p\n$$\n\n其次，我们要求法向导数 $\\partial_{\\boldsymbol{n}} u$ 连续。条件是来自左侧的法向导数迹 $\\lambda_L(t)$ 必须等于来自右侧的迹 $\\lambda_R(t)$，对所有 $t \\in [-1, 1]$ 都成立。\n$$\n\\lambda_L(t) = \\lambda_R(t) \\quad \\forall t \\in [-1, 1]\n$$\n代入来自空间 $\\mathbb{P}_q([-1,1])$ 的多项式表示：\n$$\n\\sum_{k=0}^{q} b_{L,k}\\, t^k = \\sum_{k=0}^{q} b_{R,k}\\, t^k\n$$\n按照与场 $u$ 相同的逻辑，我们重排方程：\n$$\n\\sum_{k=0}^{q} (b_{L,k} - b_{R,k})\\, t^k = 0 \\quad \\forall t \\in [-1, 1]\n$$\n单项式基函数 $\\{t^k\\}_{k=0}^q$ 的线性无关性要求每个系数都为零。这就得出了关于系数 $\\{b_{L,k}\\}$ 和 $\\{b_{R,k}\\}$ 的必要且充分条件：\n$$\nb_{L,k} - b_{R,k} = 0 \\quad \\text{for } k = 0, 1, \\dots, q\n$$\n或等价地，\n$$\nb_{L,k} = b_{R,k} \\quad \\text{for } k = 0, 1, \\dots, q\n$$\n至此，代数条件的推导完成。\n\n第2部分：约束计数。\n\n问题要求施加在总共 $2(p+1) + 2(q+1)$ 个系数上的独立标量线性约束的最小数量。一个约束是一个关联这些系数的线性代数方程。\n\n对于场 $u$ 的连续性，条件是对于索引 $k$ 从 $0$ 到 $p$ 的每个值，都有 $a_{L,k} = a_{R,k}$。索引 $k$ 取 $p+1$ 个不同的整数值（$0, 1, \\dots, p$）。因此，我们得到一个由 $p+1$ 个线性方程组成的集合。每个方程 $a_{L,k} - a_{R,k} = 0$ 都涉及一对唯一的系数 $(a_{L,k}, a_{R,k})$，这对系数不出现在该集合中的任何其他方程里。因此，这 $p+1$ 个约束是线性无关的。\n\n对于法向导数 $\\partial_{\\boldsymbol{n}} u$ 的连续性，条件是对于索引 $k$ 从 $0$ 到 $q$ 的每个值，都有 $b_{L,k} = b_{R,k}$。索引 $k$ 取 $q+1$ 个不同的整数值（$0, 1, \\dots, q$）。这给出了一个由 $q+1$ 个线性方程组成的集合。类似地，这 $q+1$ 个约束是线性无关的。\n\n总的系数集被划分为 $\\{a_{L,k}, a_{R,k}\\}$ 和 $\\{b_{L,k}, b_{R,k}\\}$。第一组约束只涉及 'a' 系数，第二组只涉及 'b' 系数。因此，这两组约束本身是相互独立的。\n\n总的独立标量线性约束数量是场约束数量与法向导数约束数量之和。\n总约束数 = ($u$ 的约束数) + ($\\partial_{\\boldsymbol{n}} u$ 的约束数)\n$$\n\\text{Total constraints} = (p+1) + (q+1)\n$$\n化简此表达式得到最终结果：\n$$\n\\text{Total constraints} = p+q+2\n$$\n这就是在问题所定义的意义上，确保跨边 $C^1$ 连续性所需的最小约束数量。这可以通过维数计数论证来理解。系数空间的初始维数是 $2(p+1) + 2(q+1)$。施加连续性条件后，自由度减少到 $(p+1) + (q+1)$，因为一个单元的系数决定了相邻单元的系数。维数的减少量，也就是约束的数量，是 $[2(p+1) + 2(q+1)] - [(p+1) + (q+1)] = (p+1) + (q+1) = p+q+2$。", "answer": "$$\\boxed{p+q+2}$$", "id": "2553906"}]}