{"hands_on_practices": [{"introduction": "高阶单元，如九节点双二次四边形（Q9）单元，因其卓越的插值精度而在有限元分析中扮演着重要角色。要真正掌握这些单元，我们必须超越公式的简单记忆，深入其数学构造的源头。本练习将引导您从一维拉格朗日多项式出发，通过张量积的方法，亲手推导 Q9 单元的形函数及其关键性质，从而深刻理解其插值能力的根本来源。[@problem_id:2592295]", "problem": "在等参有限元法 (FEM) 中，九节点四边形 ($\\mathrm{Q9}$) 单元使用双二次插值，该插值是在局部坐标 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 的母域上定义的一维二次 Lagrange 多项式的张量积。考虑标准节点布局，其在母域中的节点位置如下：\n- 节点 $1$：$(-1,-1)$，节点 $2$：$(+1,-1)$，节点 $3$：$(+1,+1)$，节点 $4$：$(-1,+1)$，\n- 节点 $5$：$(0,-1)$，节点 $6$：$(+1,0)$，节点 $7$：$(0,+1)$，节点 $8$：$(-1,0)$，\n- 节点 $9$：$(0,0)$。\n\n从一维二次 Lagrange 基多项式 $\\ell_{-1}(\\zeta)$、$\\ell_{0}(\\zeta)$ 和 $\\ell_{+1}(\\zeta)$ 满足 $\\ell_{a}(b)=\\delta_{ab}$（其中 $a,b\\in\\{-1,0,+1\\}$）这一基本插值性质出发，推导二维 $\\mathrm{Q9}$ 形函数 $N_i(\\xi,\\eta)$ 作为这些一维多项式的张量积。然后计算它们关于 $\\xi$ 和 $\\eta$ 的一阶导数。\n\n仅使用这些推导出的表达式（不使用任何预先记忆的单元公式），执行以下验证：\n- 证明单位分解性质成立，即对于母域中的所有 $(\\xi,\\eta)$，$\\sum_{i=1}^{9} N_i(\\xi,\\eta)=1$。\n- 证明在每个节点上的 Kronecker-delta 性质，即对于所有 $i,j\\in\\{1,\\dots,9\\}$，有 $N_i(\\xi_j,\\eta_j)=\\delta_{ij}$。\n- 证明梯度满足 $\\sum_{i=1}^{9}\\frac{\\partial N_i}{\\partial \\xi}(\\xi,\\eta)=0$ 和 $\\sum_{i=1}^{9}\\frac{\\partial N_i}{\\partial \\eta}(\\xi,\\eta)=0$ 对于母域中的所有 $(\\xi,\\eta)$ 均成立。\n- 在点 $(-1,-1)$、$(+1,-1)$、$(+1,+1)$、$(-1,+1)$、$(0,-1)$、$(+1,0)$、$(0,+1)$、$(-1,0)$ 和 $(0,0)$ 上，显式验证节点和边中点的求值。\n\n最后，在任意点 $(\\xi,\\eta)=\\left(\\frac{1}{3},-\\frac{1}{2}\\right)$，使用您推导的公式计算 $N_2(\\xi,\\eta)$、$\\frac{\\partial N_5}{\\partial \\xi}(\\xi,\\eta)$ 和 $\\frac{\\partial N_7}{\\partial \\eta}(\\xi,\\eta)$，并报告标量值\n$$\nQ \\;=\\; N_2\\!\\left(\\tfrac{1}{3},-\\tfrac{1}{2}\\right) \\;+\\; 3\\,\\frac{\\partial N_5}{\\partial \\xi}\\!\\left(\\tfrac{1}{3},-\\tfrac{1}{2}\\right) \\;-\\; 2\\,\\frac{\\partial N_7}{\\partial \\eta}\\!\\left(\\tfrac{1}{3},-\\tfrac{1}{2}\\right)\n$$\n的精确值。请以精确值形式给出 $Q$（不进行四舍五入）。不包含单位。", "solution": "该问题陈述已经过严格评估，被认为是有效的。这是一个在有限元法框架下的标准、适定问题，没有科学上的不准确性、逻辑矛盾或定义不清的术语。我们将按规定进行推导和验证。\n\n首先，我们推导定义在区间 $\\zeta \\in [-1, 1]$ 上且节点位于 $\\{-1, 0, +1\\}$ 的一维二次 Lagrange 基多项式 $\\ell_k(\\zeta)$。这些多项式必须满足性质 $\\ell_a(b) = \\delta_{ab}$，其中 $a, b \\in \\{-1, 0, +1\\}$，$\\delta_{ab}$ 是 Kronecker delta。\n\n对应于节点 $\\zeta = -1$ 的多项式记为 $\\ell_{-1}(\\zeta)$。它在 $\\zeta=0$ 和 $\\zeta=1$ 处必须为零，在 $\\zeta=-1$ 处必须为一。\n$$ \\ell_{-1}(\\zeta) = \\frac{(\\zeta-0)(\\zeta-1)}{(-1-0)(-1-1)} = \\frac{\\zeta(\\zeta-1)}{2} = \\frac{1}{2}(\\zeta^2 - \\zeta) $$\n对应于节点 $\\zeta = 0$ 的多项式是 $\\ell_{0}(\\zeta)$。它在 $\\zeta=-1$ 和 $\\zeta=1$ 处必须为零，在 $\\zeta=0$ 处必须为一。\n$$ \\ell_{0}(\\zeta) = \\frac{(\\zeta - (-1))(\\zeta-1)}{(0 - (-1))(0-1)} = \\frac{(\\zeta+1)(\\zeta-1)}{-1} = 1-\\zeta^2 $$\n对应于节点 $\\zeta = +1$ 的多项式是 $\\ell_{+1}(\\zeta)$。它在 $\\zeta=-1$ 和 $\\zeta=0$ 处必须为零，在 $\\zeta=1$ 处必须为一。\n$$ \\ell_{+1}(\\zeta) = \\frac{(\\zeta - (-1))(\\zeta-0)}{(1 - (-1))(1-0)} = \\frac{\\zeta(\\zeta+1)}{2} = \\frac{1}{2}(\\zeta^2 + \\zeta) $$\n它们关于 $\\zeta$ 的一阶导数是：\n$$ \\ell'_{-1}(\\zeta) = \\frac{d}{d\\zeta}\\left(\\frac{1}{2}(\\zeta^2 - \\zeta)\\right) = \\frac{1}{2}(2\\zeta - 1) $$\n$$ \\ell'_{0}(\\zeta) = \\frac{d}{d\\zeta}(1-\\zeta^2) = -2\\zeta $$\n$$ \\ell'_{+1}(\\zeta) = \\frac{d}{d\\zeta}\\left(\\frac{1}{2}(\\zeta^2 + \\zeta)\\right) = \\frac{1}{2}(2\\zeta + 1) $$\n\n$\\mathrm{Q9}$ 单元的二维形函数 $N_i(\\xi, \\eta)$ 是由这些一维多项式的张量积构成的。一个局部坐标为 $(\\xi_i, \\eta_i)$，其中 $\\xi_i, \\eta_i \\in \\{-1, 0, +1\\}$ 的节点 $i$，其对应的形函数由 $N_i(\\xi, \\eta) = \\ell_{\\xi_i}(\\xi)\\ell_{\\eta_i}(\\eta)$ 给出。节点编号与坐标对的映射关系如下：\n$1:(-1,-1)$, $2:(+1,-1)$, $3:(+1,+1)$, $4:(-1,+1)$, $5:(0,-1)$, $6:(+1,0)$, $7:(0,+1)$, $8:(-1,0)$, $9:(0,0)$。\n因此，形函数为：\n$N_1(\\xi, \\eta) = \\ell_{-1}(\\xi)\\ell_{-1}(\\eta) = \\frac{1}{4}(\\xi^2-\\xi)(\\eta^2-\\eta)$\n$N_2(\\xi, \\eta) = \\ell_{+1}(\\xi)\\ell_{-1}(\\eta) = \\frac{1}{4}(\\xi^2+\\xi)(\\eta^2-\\eta)$\n$N_3(\\xi, \\eta) = \\ell_{+1}(\\xi)\\ell_{+1}(\\eta) = \\frac{1}{4}(\\xi^2+\\xi)(\\eta^2+\\eta)$\n$N_4(\\xi, \\eta) = \\ell_{-1}(\\xi)\\ell_{+1}(\\eta) = \\frac{1}{4}(\\xi^2-\\xi)(\\eta^2+\\eta)$\n$N_5(\\xi, \\eta) = \\ell_{0}(\\xi)\\ell_{-1}(\\eta) = \\frac{1}{2}(1-\\xi^2)(\\eta^2-\\eta)$\n$N_6(\\xi, \\eta) = \\ell_{+1}(\\xi)\\ell_{0}(\\eta) = \\frac{1}{2}(\\xi^2+\\xi)(1-\\eta^2)$\n$N_7(\\xi, \\eta) = \\ell_{0}(\\xi)\\ell_{+1}(\\eta) = \\frac{1}{2}(1-\\xi^2)(\\eta^2+\\eta)$\n$N_8(\\xi, \\eta) = \\ell_{-1}(\\xi)\\ell_{0}(\\eta) = \\frac{1}{2}(\\xi^2-\\xi)(1-\\eta^2)$\n$N_9(\\xi, \\eta) = \\ell_{0}(\\xi)\\ell_{0}(\\eta) = (1-\\xi^2)(1-\\eta^2)$\n\n一阶导数为 $\\frac{\\partial N_i}{\\partial \\xi} = \\ell'_{\\xi_i}(\\xi)\\ell_{\\eta_i}(\\eta)$ 和 $\\frac{\\partial N_i}{\\partial \\eta} = \\ell_{\\xi_i}(\\xi)\\ell'_{\\eta_i}(\\eta)$。\n\n我们现在进行所要求的验证。\n\n1.  单位分解：$\\sum_{i=1}^{9} N_i(\\xi,\\eta) = 1$。\n    利用张量积结构：\n    $$ \\sum_{i=1}^{9} N_i(\\xi, \\eta) = \\sum_{k \\in \\{-1,0,1\\}} \\sum_{l \\in \\{-1,0,1\\}} \\ell_k(\\xi) \\ell_l(\\eta) = \\left(\\sum_{k \\in \\{-1,0,1\\}} \\ell_k(\\xi)\\right) \\left(\\sum_{l \\in \\{-1,0,1\\}} \\ell_l(\\eta)\\right) $$\n    一维多项式的和为：\n    $$ \\sum_{k \\in \\{-1,0,1\\}} \\ell_k(\\zeta) = \\frac{1}{2}(\\zeta^2 - \\zeta) + (1-\\zeta^2) + \\frac{1}{2}(\\zeta^2 + \\zeta) = \\left(\\frac{1}{2}-1+\\frac{1}{2}\\right)\\zeta^2 + \\left(-\\frac{1}{2}+\\frac{1}{2}\\right)\\zeta + 1 = 1 $$\n    因此，$\\sum_{i=1}^{9} N_i(\\xi, \\eta) = (1)(1) = 1$。单位分解性质得到验证。\n\n2.  Kronecker-delta 性质：$N_i(\\xi_j,\\eta_j)=\\delta_{ij}$。\n    设节点 $i$ 对应坐标 $(\\xi_k, \\eta_l)$，节点 $j$ 对应坐标 $(\\xi_m, \\eta_n)$，其中 $k, l, m, n \\in \\{-1, 0, 1\\}$。\n    节点 $i$ 的形函数为 $N_i(\\xi, \\eta) = \\ell_k(\\xi)\\ell_l(\\eta)$。\n    在节点 $j$ 处求值：$N_i(\\xi_j, \\eta_j) = \\ell_k(\\xi_m)\\ell_l(\\eta_n) = \\delta_{km}\\delta_{ln}$。\n    该乘积仅当 $k=m$ 且 $l=n$ 时为 $1$，这意味着节点 $i$ 和 $j$ 是同一个节点。否则，该乘积为 $0$。因此，$N_i(\\xi_j,\\eta_j)=\\delta_{ij}$。\n    作为一个明确的验证，考虑 $N_5(\\xi, \\eta) = \\ell_0(\\xi)\\ell_{-1}(\\eta) = (1-\\xi^2) \\frac{1}{2}\\eta(\\eta-1)$。\n    在节点 $5$ 处，$(\\xi_5, \\eta_5) = (0, -1)$：$N_5(0,-1) = (1-0^2) \\frac{1}{2}(-1)(-1-1) = (1)\\frac{1}{2}(-1)(-2) = 1$。\n    在节点 $1$ 处，$(\\xi_1, \\eta_1) = (-1, -1)$：$N_5(-1,-1) = (1-(-1)^2) \\frac{1}{2}(-1)(-2) = (0)(\\dots) = 0$。\n    在节点 $9$ 处，$(\\xi_9, \\eta_9) = (0, 0)$：$N_5(0,0) = (1-0^2) \\frac{1}{2}(0)(0-1) = (1)(0) = 0$。\n    该性质成立。\n\n3.  梯度之和的性质：$\\sum_{i=1}^{9}\\frac{\\partial N_i}{\\partial \\xi}=0$ 和 $\\sum_{i=1}^{9}\\frac{\\partial N_i}{\\partial \\eta}=0$。\n    这可以通过对单位分解性质求导得到：\n    $$ \\frac{\\partial}{\\partial \\xi} \\left(\\sum_{i=1}^{9} N_i(\\xi, \\eta)\\right) = \\frac{\\partial}{\\partial \\xi}(1) = 0 \\implies \\sum_{i=1}^{9} \\frac{\\partial N_i}{\\partial \\xi}(\\xi, \\eta) = 0 $$\n    $$ \\frac{\\partial}{\\partial \\eta} \\left(\\sum_{i=1}^{9} N_i(\\xi, \\eta)\\right) = \\frac{\\partial}{\\partial \\eta}(1) = 0 \\implies \\sum_{i=1}^{9} \\frac{\\partial N_i}{\\partial \\eta}(\\xi, \\eta) = 0 $$\n    或者，使用张量积展开：\n    $$ \\sum_{i=1}^{9} \\frac{\\partial N_i}{\\partial \\xi} = \\left(\\sum_{k \\in \\{-1,0,1\\}} \\ell'_k(\\xi)\\right) \\left(\\sum_{l \\in \\{-1,0,1\\}} \\ell_l(\\eta)\\right) $$\n    一维导数的和是 $\\sum_k \\ell'_k(\\zeta) = \\frac{1}{2}(2\\zeta - 1) + (-2\\zeta) + \\frac{1}{2}(2\\zeta + 1) = (\\zeta-\\frac{1}{2})-2\\zeta+(\\zeta+\\frac{1}{2}) = 0$。\n    由于 $\\sum_l \\ell_l(\\eta) = 1$，我们有 $\\sum_i \\frac{\\partial N_i}{\\partial \\xi} = (0)(1) = 0$。根据对称性，$\\sum_i \\frac{\\partial N_i}{\\partial \\eta} = 0$。验证完成。\n\n最后，我们计算在 $(\\xi, \\eta) = (\\frac{1}{3}, -\\frac{1}{2})$ 处的量 $Q$。\n$$ Q = N_2\\left(\\tfrac{1}{3},-\\tfrac{1}{2}\\right) + 3\\,\\frac{\\partial N_5}{\\partial \\xi}\\left(\\tfrac{1}{3},-\\tfrac{1}{2}\\right) - 2\\,\\frac{\\partial N_7}{\\partial \\eta}\\left(\\tfrac{1}{3},-\\tfrac{1}{2}\\right) $$\n我们需要 $N_2$、$\\frac{\\partial N_5}{\\partial \\xi}$ 和 $\\frac{\\partial N_7}{\\partial \\eta}$ 的表达式。\n$N_2(\\xi, \\eta) = \\ell_{+1}(\\xi)\\ell_{-1}(\\eta) = \\frac{1}{2}\\xi(\\xi+1) \\cdot \\frac{1}{2}\\eta(\\eta-1) = \\frac{1}{4}\\xi(\\xi+1)\\eta(\\eta-1)$。\n$\\frac{\\partial N_5}{\\partial \\xi}(\\xi, \\eta) = \\ell'_{0}(\\xi)\\ell_{-1}(\\eta) = (-2\\xi) \\cdot \\frac{1}{2}\\eta(\\eta-1) = -\\xi\\eta(\\eta-1)$。\n$\\frac{\\partial N_7}{\\partial \\eta}(\\xi, \\eta) = \\ell_{0}(\\xi)\\ell'_{+1}(\\eta) = (1-\\xi^2) \\cdot \\frac{1}{2}(2\\eta+1)$。\n\n现在，我们在 $(\\xi, \\eta) = (\\frac{1}{3}, -\\frac{1}{2})$ 处对这些表达式求值。\n$N_2(\\frac{1}{3}, -\\frac{1}{2}) = \\frac{1}{4}(\\frac{1}{3})(\\frac{1}{3}+1)(-\\frac{1}{2})(-\\frac{1}{2}-1) = \\frac{1}{4}(\\frac{1}{3})(\\frac{4}{3})(-\\frac{1}{2})(-\\frac{3}{2}) = \\frac{1}{4} \\cdot \\frac{4}{9} \\cdot \\frac{3}{4} = \\frac{1}{12}$。\n\n$\\frac{\\partial N_5}{\\partial \\xi}(\\frac{1}{3}, -\\frac{1}{2}) = -(\\frac{1}{3})(-\\frac{1}{2})(-\\frac{1}{2}-1) = -(\\frac{1}{3})(-\\frac{1}{2})(-\\frac{3}{2}) = -\\frac{3}{12} = -\\frac{1}{4}$。\n\n$\\frac{\\partial N_7}{\\partial \\eta}(\\frac{1}{3}, -\\frac{1}{2}) = (1-(\\frac{1}{3})^2) \\cdot \\frac{1}{2}(2(-\\frac{1}{2})+1) = (1-\\frac{1}{9}) \\cdot \\frac{1}{2}(-1+1) = (\\frac{8}{9}) \\cdot 0 = 0$。\n\n将这些值代入 $Q$ 的表达式中：\n$Q = \\frac{1}{12} + 3\\left(-\\frac{1}{4}\\right) - 2(0) = \\frac{1}{12} - \\frac{3}{4} = \\frac{1}{12} - \\frac{9}{12} = -\\frac{8}{12} = -\\frac{2}{3}$。\n所求的标量值已计算为一个精确分数。", "answer": "$$\n\\boxed{-\\frac{2}{3}}\n$$", "id": "2592295"}, {"introduction": "等参元的威力在于将规则的参考单元映射到任意形状的物理单元，而这个过程的“健康度”由雅可比矩阵（Jacobian matrix）$\\mathbf{J}$ 掌控。一个看似无足轻重的细节——物理单元的节点编号顺序——实际上直接决定了映射是否有效。本练习通过一个具体的例子，让您计算不同编号顺序下的雅可比行列式 $\\det\\mathbf{J}$，从而直观地揭示逆时针编号约定对于保证单元不“翻转”的必要性。[@problem_id:2592296]", "problem": "在用于四节点等参四边形(Q4)的等参有限元法(FEM)中，从具有局部坐标 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 和标准参考节点位置 $(-1,-1)$、$(1,-1)$、$(1,1)$、$(-1,1)$ 的参考正方形到物理单元的映射由双线性插值定义\n$$\nx(\\xi,\\eta)=\\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,x_i,\\quad\ny(\\xi,\\eta)=\\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,y_i,\n$$\n其雅可比矩阵为\n$$\n\\mathbf{J}(\\xi,\\eta)=\n\\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta}\n\\\\[4pt]\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix}\n。$$\n考虑一个具有以下顶点坐标的凸物理四边形：\n$$\n\\mathbf{P}_1=(0,0),\\quad \\mathbf{P}_2=(3,0),\\quad \\mathbf{P}_3=(4,2),\\quad \\mathbf{P}_4=(0,1).\n$$\n为将这些物理点分配给Q4节点，定义两种节点编号情况：\n- 情况CCW：节点 $1,2,3,4$ 分别映射到 $\\mathbf{P}_1,\\mathbf{P}_2,\\mathbf{P}_3,\\mathbf{P}_4$（逆时针遍历）。\n- 情况CW：节点 $1,2,3,4$ 分别映射到 $\\mathbf{P}_1,\\mathbf{P}_4,\\mathbf{P}_3,\\mathbf{P}_2$（顺时针遍历）。\n\n仅使用上述基本定义和参考正方形上的Q4标准双线性形函数，计算行列式\n$$\n\\det\\mathbf{J}_{\\mathrm{CCW}}(0,0)\\quad \\text{和}\\quad \\det\\mathbf{J}_{\\mathrm{CW}}(0,0),\n$$\n然后计算比值\n$$\nr=\\frac{\\det\\mathbf{J}_{\\mathrm{CW}}(0,0)}{\\det\\mathbf{J}_{\\mathrm{CCW}}(0,0)}.\n$$\n将 $r$ 的最终结果表示为一个无单位的纯数。无需四舍五入。在您的推导中，请指明哪种节点编号约定通过确保整个单元的雅可比行列式为正来避免单元反转。最终答案应仅为 $r$ 的值。", "solution": "所提问题是等参有限元理论中的一个标准练习。该问题提法恰当，有科学依据，并包含了求得唯一解所需的所有信息。下面我们开始推导。\n\n从 $(\\xi, \\eta)$ 局部坐标系中 $\\xi, \\eta \\in [-1, 1]$ 的参考单元（一个正方形）到 $(x, y)$ 坐标系中物理单元的映射由以下公式给出：\n$$x(\\xi,\\eta)=\\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,x_i$$\n$$y(\\xi,\\eta)=\\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,y_i$$\n其中 $(x_i, y_i)$ 是物理单元第 $i$ 个节点的坐标。四节点四边形单元(Q4)的标准双线性形函数是相对于参考节点 $1(-1,-1)$、$2(1,-1)$、$3(1,1)$ 和 $4(-1,1)$ 定义的，如下所示：\n$$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$$\n$$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$$\n$$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$$\n$$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$$\n该变换的雅可比矩阵为\n$$\n\\mathbf{J}(\\xi,\\eta)=\n\\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta}\n\\\\[4pt]\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} x_i & \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} x_i \n\\\\[4pt]\n\\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} y_i & \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} y_i\n\\end{pmatrix}\n$$\n为计算单元中心 $(\\xi, \\eta) = (0,0)$ 处的雅可比矩阵，我们首先计算形函数的偏导数并在该点求值。\n导数为：\n$$\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi)$$\n$$\\frac{\\partial N_2}{\\partial \\xi} = \\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_2}{\\partial \\eta} = -\\frac{1}{4}(1+\\xi)$$\n$$\\frac{\\partial N_3}{\\partial \\xi} = \\frac{1}{4}(1+\\eta), \\quad \\frac{\\partial N_3}{\\partial \\eta} = \\frac{1}{4}(1+\\xi)$$\n$$\\frac{\\partial N_4}{\\partial \\xi} = -\\frac{1}{4}(1+\\eta), \\quad \\frac{\\partial N_4}{\\partial \\eta} = \\frac{1}{4}(1-\\xi)$$\n在 $(\\xi, \\eta) = (0,0)$ 处，这些导数变为：\n$$\\frac{\\partial N_1}{\\partial \\xi}\\Big|_{(0,0)}=-\\frac{1}{4}, \\quad \\frac{\\partial N_2}{\\partial \\xi}\\Big|_{(0,0)}=\\frac{1}{4}, \\quad \\frac{\\partial N_3}{\\partial \\xi}\\Big|_{(0,0)}=\\frac{1}{4}, \\quad \\frac{\\partial N_4}{\\partial \\xi}\\Big|_{(0,0)}=-\\frac{1}{4}$$\n$$\\frac{\\partial N_1}{\\partial \\eta}\\Big|_{(0,0)}=-\\frac{1}{4}, \\quad \\frac{\\partial N_2}{\\partial \\eta}\\Big|_{(0,0)}=-\\frac{1}{4}, \\quad \\frac{\\partial N_3}{\\partial \\eta}\\Big|_{(0,0)}=\\frac{1}{4}, \\quad \\frac{\\partial N_4}{\\partial \\eta}\\Big|_{(0,0)}=\\frac{1}{4}$$\n将这些值代入 $(\\xi, \\eta) = (0,0)$ 处的雅可比矩阵表达式中，我们得到：\n$$\n\\mathbf{J}(0,0) = \\frac{1}{4}\n\\begin{pmatrix}\n-x_1+x_2+x_3-x_4 & -x_1-x_2+x_3+x_4 \n\\\\[4pt]\n-y_1+y_2+y_3-y_4 & -y_1-y_2+y_3+y_4\n\\end{pmatrix}\n$$\n现在，我们分析两种指定的节点编号情况。\n\n情况 CCW：节点 $1,2,3,4$ 分别映射到 $\\mathbf{P}_1, \\mathbf{P}_2, \\mathbf{P}_3, \\mathbf{P}_4$。\n物理坐标为：\n$(x_1, y_1) = (0,0)$\n$(x_2, y_2) = (3,0)$\n$(x_3, y_3) = (4,2)$\n$(x_4, y_4) = (0,1)$\n我们计算雅可比矩阵 $\\mathbf{J}_{\\mathrm{CCW}}(0,0)$ 的分量：\n$$J_{11} = \\frac{1}{4}(-0+3+4-0) = \\frac{7}{4}$$\n$$J_{12} = \\frac{1}{4}(-0-3+4+0) = \\frac{1}{4}$$\n$$J_{21} = \\frac{1}{4}(-0+0+2-1) = \\frac{1}{4}$$\n$$J_{22} = \\frac{1}{4}(-0-0+2+1) = \\frac{3}{4}$$\n因此，雅可比矩阵为\n$$\n\\mathbf{J}_{\\mathrm{CCW}}(0,0) =\n\\begin{pmatrix}\n\\frac{7}{4} & \\frac{1}{4} \n\\\\[4pt]\n\\frac{1}{4} & \\frac{3}{4}\n\\end{pmatrix}\n$$\n行列式为\n$$\n\\det\\mathbf{J}_{\\mathrm{CCW}}(0,0) = \\left(\\frac{7}{4}\\right)\\left(\\frac{3}{4}\\right) - \\left(\\frac{1}{4}\\right)\\left(\\frac{1}{4}\\right) = \\frac{21}{16} - \\frac{1}{16} = \\frac{20}{16} = \\frac{5}{4}\n$$\n行列式的正号证实了该映射保持定向性。参考单元中节点的逆时针遍历映射到物理单元中节点的逆时针遍历。这是避免生成反转或“内外翻转”单元的正确约定。\n\n情况 CW：节点 $1,2,3,4$ 分别映射到 $\\mathbf{P}_1, \\mathbf{P}_4, \\mathbf{P}_3, \\mathbf{P}_2$。\n物理坐标为：\n$(x_1, y_1) = (0,0)$\n$(x_2, y_2) = (0,1)$\n$(x_3, y_3) = (4,2)$\n$(x_4, y_4) = (3,0)$\n我们计算雅可比矩阵 $\\mathbf{J}_{\\mathrm{CW}}(0,0)$ 的分量：\n$$J_{11} = \\frac{1}{4}(-0+0+4-3) = \\frac{1}{4}$$\n$$J_{12} = \\frac{1}{4}(-0-0+4+3) = \\frac{7}{4}$$\n$$J_{21} = \\frac{1}{4}(-0+1+2-0) = \\frac{3}{4}$$\n$$J_{22} = \\frac{1}{4}(-0-1+2+0) = \\frac{1}{4}$$\n因此，雅可比矩阵为\n$$\n\\mathbf{J}_{\\mathrm{CW}}(0,0) =\n\\begin{pmatrix}\n\\frac{1}{4} & \\frac{7}{4} \n\\\\[4pt]\n\\frac{3}{4} & \\frac{1}{4}\n\\end{pmatrix}\n$$\n行列式为\n$$\n\\det\\mathbf{J}_{\\mathrm{CW}}(0,0) = \\left(\\frac{1}{4}\\right)\\left(\\frac{1}{4}\\right) - \\left(\\frac{7}{4}\\right)\\left(\\frac{3}{4}\\right) = \\frac{1}{16} - \\frac{21}{16} = -\\frac{20}{16} = -\\frac{5}{4}\n$$\n行列式的负号表示该映射反转了定向性。参考单元中的逆时针路径映射到物理单元中的顺时针路径，这对于大多数有限元分析而言，在物理上和数学上都是无效的。\n\n最后，我们计算所需的比值 $r$：\n$$\nr = \\frac{\\det\\mathbf{J}_{\\mathrm{CW}}(0,0)}{\\det\\mathbf{J}_{\\mathrm{CCW}}(0,0)} = \\frac{-5/4}{5/4} = -1\n$$\n此结果展示了一个基本性质：相对于参考单元固定的逆时针编号，反转物理单元节点编号的定向（从CCW到CW）会导致雅可比行列式变号，前提是所有其他因素都相同。逆时针编号约定（情况 CCW）可确保凸四边形的雅可比行列式为正，这是一种标准做法。", "answer": "$$\n\\boxed{-1}\n$$", "id": "2592296"}, {"introduction": "在选择有限元单元时，理解其能够精确表示的函数空间（即其多项式完备性）至关重要，这直接关系到分析的精度。八节点“巧凑”四边形（Q8）单元是一个常用但具有特殊性的例子。本练习旨在揭示 Q8 单元插值能力的一个重要局限性：通过尝试插值一个 $\\xi^2\\eta^2$ 场，您将证明并量化 Q8 单元无法精确再现所有双二次项，从而深化对巧凑单元与拉格朗日单元之间差异的理解。[@problem_id:2592261]", "problem": "考虑有限元法 (FEM) 中的标准八节点 serendipity 四边形 (Q8)。在自然坐标系 $\\{(\\xi,\\eta)\\,:\\,-1 \\le \\xi \\le 1,\\,-1 \\le \\eta \\le 1\\}$ 的双单位母正方形上进行计算，其八个节点位于四个角点 $(\\pm 1,\\pm 1)$ 和四个边中点 $(0,\\pm 1)$, $(\\pm 1,0)$。Q8 插值算子是由标准 Q8 形函数（角点形函数和边中点形函数）构建的节点插值，这些形函数在任意单元边上均为二次函数。\n\n令标量场为 $u(\\xi,\\eta) = \\xi^{2}\\eta^{2}$。仅使用 Q8 节点插值的定义性质和标准 Q8 角点形函数，构造 $u$ 的 Q8 插值，并由此证明 Q8 不能在双单位正方形上精确重构 $u$。将双单位正方形上的插值误差记为 $e(\\xi,\\eta) = u(\\xi,\\eta) - I_{Q8}[u](\\xi,\\eta)$。\n\n现在，通过仿射变换 $s = (\\xi+1)/2$，$t = (\\eta+1)/2$，将误差映射到单位正方形母域 $\\{(s,t)\\,:\\,0 \\le s \\le 1,\\,0 \\le t \\le 1\\}$，并定义 $e_{\\mathrm{unit}}(s,t) := e(\\xi(s),\\eta(t))$。\n\n通过计算 $e_{\\mathrm{unit}}$ 在 $[0,1]^{2}$ 上的 $L^{2}$ 范数来量化单位正方形上的误差，即\n$$\n\\|e_{\\mathrm{unit}}\\|_{L^{2}([0,1]^{2})} \\;=\\; \\left( \\int_{0}^{1}\\int_{0}^{1} \\left[e_{\\mathrm{unit}}(s,t)\\right]^{2} \\,\\mathrm{d}s\\,\\mathrm{d}t \\right)^{\\frac{1}{2}}.\n$$\n\n请以精确值的形式给出最终答案，不带单位。不要进行四舍五入。最终答案必须是一个实数。", "solution": "函数 $u(\\xi, \\eta)$ 的 Q8 节点插值定义为：\n$$\nI_{Q8}[u](\\xi, \\eta) = \\sum_{i=1}^{8} u_i N_i(\\xi, \\eta)\n$$\n其中 $N_i(\\xi, \\eta)$ 是 Q8 形函数，$u_i = u(\\xi_i, \\eta_i)$ 是函数在单元 8 个节点处的值。\n\n这 8 个节点的坐标是：\n-   角点 (1-4)：$(1,1)$, $(-1,1)$, $(-1,-1)$, $(1,-1)$。\n-   边中点 (5-8)：$(1,0)$, $(0,1)$, $(-1,0)$, $(0,-1)$。\n\n给定的标量场是 $u(\\xi,\\eta) = \\xi^{2}\\eta^{2}$。我们在每个节点上计算 $u$ 的值：\n-   在四个角点 $(\\xi_i, \\eta_i) = (\\pm 1, \\pm 1)$ 处，节点值为 $u_i = (\\pm 1)^{2}(\\pm 1)^{2} = 1$。\n-   在四个边中点处，其中 $\\xi_i=0$ 或 $\\eta_i=0$，节点值为 $u_i = 0$。\n\n将这些节点值代入插值公式，得到：\n$$\nI_{Q8}[u](\\xi, \\eta) = \\sum_{i=1}^{4} (1) \\cdot N_i(\\xi, \\eta) + \\sum_{i=5}^{8} (0) \\cdot N_i(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta)\n$$\n其中，对于 $i=1, \\dots, 4$，$N_i$ 是角点形函数。\n\n对于任何有效的有限元，形函数的一个基本性质是它们构成单位分解，即它们在整个单元域上的和等于 1：\n$$\n\\sum_{i=1}^{8} N_i(\\xi, \\eta) = 1\n$$\n这使我们能够用边中点形函数的和来表示角点形函数的和：\n$$\n\\sum_{i=1}^{4} N_i(\\xi, \\eta) = 1 - \\sum_{i=5}^{8} N_i(\\xi, \\eta)\n$$\n边中点节点的标准形函数是：\n$N_5(\\xi, \\eta) = \\frac{1}{2}(1-\\eta^2)(1+\\xi)$ 对应节点 $(1,0)$。\n$N_6(\\xi, \\eta) = \\frac{1}{2}(1-\\xi^2)(1+\\eta)$ 对应节点 $(0,1)$。\n$N_7(\\xi, \\eta) = \\frac{1}{2}(1-\\eta^2)(1-\\xi)$ 对应节点 $(-1,0)$。\n$N_8(\\xi, \\eta) = \\frac{1}{2}(1-\\xi^2)(1-\\eta)$ 对应节点 $(0,-1)$。\n\n边中点形函数的和是：\n$$\n\\sum_{i=5}^{8} N_i(\\xi, \\eta) = \\frac{1}{2}(1-\\eta^2)(1+\\xi+1-\\xi) + \\frac{1}{2}(1-\\xi^2)(1+\\eta+1-\\eta)\n$$\n$$\n= \\frac{1}{2}(1-\\eta^2)(2) + \\frac{1}{2}(1-\\xi^2)(2) = (1-\\eta^2) + (1-\\xi^2) = 2 - \\xi^2 - \\eta^2\n$$\n因此，插值为：\n$$\nI_{Q8}[u](\\xi, \\eta) = 1 - (2 - \\xi^2 - \\eta^2) = \\xi^2 + \\eta^2 - 1\n$$\n待插值的函数是 $u(\\xi, \\eta) = \\xi^2\\eta^2$。由于 $u(\\xi, \\eta) \\neq I_{Q8}[u](\\xi, \\eta)$，例如在 $(\\xi, \\eta)=(0,0)$ 处 $u=0$ 而 $I_{Q8}[u]=-1$，所以 Q8 单元不能精确重构函数 $u(\\xi, \\eta) = \\xi^2\\eta^2$。\n\n在双单位正方形上的插值误差是：\n$$\ne(\\xi, \\eta) = u(\\xi, \\eta) - I_{Q8}[u](\\xi, \\eta) = \\xi^2\\eta^2 - (\\xi^2 + \\eta^2 - 1) = \\xi^2\\eta^2 - \\xi^2 - \\eta^2 + 1\n$$\n$$\ne(\\xi, \\eta) = (\\xi^2 - 1)(\\eta^2 - 1) = (1 - \\xi^2)(1 - \\eta^2)\n$$\n接下来，我们使用仿射变换 $s = (\\xi+1)/2$ 和 $t = (\\eta+1)/2$ 将此误差映射到单位正方形 $[0,1]^2$。其逆变换为 $\\xi = 2s-1$ 和 $\\eta = 2t-1$。映射后的误差函数 $e_{\\mathrm{unit}}(s,t)$ 是：\n$$\ne_{\\mathrm{unit}}(s,t) = (1 - (2s-1)^2)(1 - (2t-1)^2)\n$$\n我们简化这些项：\n$$\n1 - (2s-1)^2 = 1 - (4s^2 - 4s + 1) = 4s - 4s^2 = 4s(1-s)\n$$\n$$\n1 - (2t-1)^2 = 1 - (4t^2 - 4t + 1) = 4t - 4t^2 = 4t(1-t)\n$$\n因此，映射后的误差函数是：\n$$\ne_{\\mathrm{unit}}(s,t) = [4s(1-s)][4t(1-t)] = 16s(1-s)t(1-t)\n$$\n最后一步是计算 $e_{\\mathrm{unit}}$ 在单位正方形上的 $L^2$ 范数：\n$$\n\\|e_{\\mathrm{unit}}\\|_{L^{2}([0,1]^{2})}^{2} = \\int_{0}^{1}\\int_{0}^{1} [e_{\\mathrm{unit}}(s,t)]^{2} \\,\\mathrm{d}s\\,\\mathrm{d}t = \\int_{0}^{1}\\int_{0}^{1} [16s(1-s)t(1-t)]^{2} \\,\\mathrm{d}s\\,\\mathrm{d}t\n$$\n$$\n= 16^2 \\int_{0}^{1}\\int_{0}^{1} s^2(1-s)^2 t^2(1-t)^2 \\,\\mathrm{d}s\\,\\mathrm{d}t\n$$\n该积分是可分离的：\n$$\n\\|e_{\\mathrm{unit}}\\|_{L^{2}}^{2} = 256 \\left( \\int_{0}^{1} s^2(1-s)^2 \\,\\mathrm{d}s \\right) \\left( \\int_{0}^{1} t^2(1-t)^2 \\,\\mathrm{d}t \\right)\n$$\n我们来计算这个一维积分：\n$$\n\\int_{0}^{1} s^2(1-s)^2 \\,\\mathrm{d}s = \\int_{0}^{1} s^2(1 - 2s + s^2) \\,\\mathrm{d}s = \\int_{0}^{1} (s^2 - 2s^3 + s^4) \\,\\mathrm{d}s\n$$\n$$\n= \\left[ \\frac{s^3}{3} - \\frac{2s^4}{4} + \\frac{s^5}{5} \\right]_{0}^{1} = \\frac{1}{3} - \\frac{1}{2} + \\frac{1}{5} = \\frac{10 - 15 + 6}{30} = \\frac{1}{30}\n$$\n将此结果代回范数平方的表达式中：\n$$\n\\|e_{\\mathrm{unit}}\\|_{L^{2}}^{2} = 256 \\left( \\frac{1}{30} \\right) \\left( \\frac{1}{30} \\right) = \\frac{256}{900}\n$$\n这个分数可以被简化。分子和分母都可以被 4 整除：\n$$\n\\frac{256}{900} = \\frac{64}{225}\n$$\n$L^2$ 范数是该值的平方根：\n$$\n\\|e_{\\mathrm{unit}}\\|_{L^{2}([0,1]^{2})} = \\left( \\frac{64}{225} \\right)^{\\frac{1}{2}} = \\frac{\\sqrt{64}}{\\sqrt{225}} = \\frac{8}{15}\n$$\n这就是误差范数的最终精确值。", "answer": "$$ \\boxed{\\frac{8}{15}} $$", "id": "2592261"}]}