{"hands_on_practices": [{"introduction": "所有有限元计算，无论是 T3 还是 T6 单元，都依赖于诸如单元面积 $A$ 及形函数梯度中使用的系数 $b_i$ 和 $c_i$ 等几何属性。尽管教科书公式看似简单，但在浮点运算中直接实现可能导致灾难性的数值误差，特别是对于那些由大坐标值定义的“瘦长”三角形。此练习挑战您像一名计算科学家一样思考，分析不同算法的优劣，以找出能确保计算准确性和稳定性的最佳实践，这对于开发可靠的有限元软件至关重要。[@problem_id:2608131]", "problem": "参数化线性和二次三角形有限元（T3和T6）的一种常用方法是通过面积（重心）坐标。对于一个顶点为$\\left(x_1,y_1\\right)$、$\\left(x_2,y_2\\right)$和$\\left(x_3,y_3\\right)$的三角形，三个顶点节点的线性形函数可以用面积坐标来表示，它们的空间导数则使用系数$\\left(b_i,c_i\\right)$和单元面积$A$来表示。具体来说，我们利用以下事实：两倍有向面积由一个$2\\times 2$行列式给出，并且对于线性三角形，系数$\\left(b_i,c_i\\right)$是坐标的成对差值。这些相同的几何图元也出现在二次（T6）形函数的梯度中，因为后者是面积坐标的多项式。\n\n在实际网格中，顶点的坐标值可能很大但间距很小，且三角形可能非常狭长（顶点近乎共线）。在这种情况下，直接计算$A$的公式可能会遭受相减抵消和上溢/下溢的影响，导致$A$以及梯度$\\partial N_i/\\partial x$和$\\partial N_i/\\partial y$出现很大的相对误差。\n\n在以下算法中，哪一个能最稳健地在浮点运算中计算$\\left(b_i,c_i\\right)$和$A$，同时适用于T3和T6单元，并能避免不必要的相减抵消和减轻上溢/下溢？你的选择必须通过可从面积的行列式定义和$\\left(b_i,c_i\\right)$的差分形式定义中推导出的属性，以及一个清晰的误差传播论证来证明。\n\nA. 直接对原始坐标使用鞋带公式计算$A$，\n$$\n2A = x_1y_2 + x_2y_3 + x_3y_1 - x_1y_3 - x_2y_1 - x_3y_2,\n$$\n然后设置$b_1 = y_2 - y_3$，$c_1 = x_3 - x_2$，$b_2 = y_3 - y_1$，$c_2 = x_1 - x_3$，$b_3 = y_1 - y_2$，$c_3 = x_2 - x_1$，不进行任何平移或缩放。\n\nB. 相对于一个顶点形成边差分，并在进行乘积前对其进行缩放。具体来说，选择一个枢轴顶点（例如，节点$1$），计算边差分\n$$\n\\Delta x_{21} = x_2 - x_1,\\quad \\Delta y_{21} = y_2 - y_1,\\quad \\Delta x_{31} = x_3 - x_1,\\quad \\Delta y_{31} = y_3 - y_1,\n$$\n计算一个缩放因子$s = \\max\\{|\\Delta x_{21}|,|\\Delta y_{21}|,|\\Delta x_{31}|,|\\Delta y_{31}|\\}$；如果$s=0$，则声明三角形是退化的。否则，形成缩放后的边$\\hat{\\Delta} = \\Delta/s$，并通过一次乘减运算来评估行列式，\n$$\n2\\hat{A} = \\hat{\\Delta x}_{21}\\,\\hat{\\Delta y}_{31} - \\hat{\\Delta x}_{31}\\,\\hat{\\Delta y}_{21},\n$$\n如果可用，则使用融合乘加；然后设置$2A = 2\\hat{A}\\,s^2$。计算\n$$\nb_1 = \\Delta y_{21} - \\Delta y_{31},\\quad c_1 = \\Delta x_{31} - \\Delta x_{21},\\quad\nb_2 = \\Delta y_{31},\\quad c_2 = -\\Delta x_{31},\\quad\nb_3 = -\\Delta y_{21},\\quad c_3 = \\Delta x_{21}.\n$$\n\nC. 根据顶点之间的欧几里得距离计算边长$a$、$b$、$c$，然后使用海伦公式\n$$\ns_h = \\tfrac{1}{2}(a+b+c),\\quad A = \\sqrt{s_h(s_h-a)(s_h-b)(s_h-c)},\n$$\n并通过周长对边向量进行归一化来获得$\\left(b_i,c_i\\right)$，即$b_i = (y_j - y_k)/(a+b+c)$和$c_i = (x_k - x_j)/(a+b+c)$。\n\nD. 首先通过减去质心来平移所有顶点，即$\\bar{x} = (x_1+x_2+x_3)/3$，$\\bar{y} = (y_1+y_2+y_3)/3$，设置$x_i' = x_i - \\bar{x}$，$y_i' = y_i - \\bar{y}$，然后使用鞋带公式对$\\left(x_i',y_i'\\right)$计算$A$，并像选项A一样计算$\\left(b_i,c_i\\right)$，不进行额外的缩放或对乘积或差分进行专门评估。", "solution": "提交问题陈述以进行验证。\n\n### 第一步：提取已知信息\n- **主题**：线性和二次三角形有限元（T3和T6）。\n- **参数化**：面积（重心）坐标。\n- **顶点**：$\\left(x_1,y_1\\right)$、$\\left(x_2,y_2\\right)$和$\\left(x_3,y_3\\right)$。\n- **待计算量**：系数$\\left(b_i,c_i\\right)$和单元面积$A$。\n- **提及的公式**：\n    - 形函数空间导数依赖于$\\left(b_i,c_i\\right)$和$A$。\n    - 两倍有向面积$2A$由一个$2\\times 2$行列式给出。\n    - 系数$\\left(b_i,c_i\\right)$是坐标的成对差值。\n- **数值背景**：\n    - 顶点的坐标值可能很大但间距很小。\n    - 三角形可能非常狭长（顶点近乎共线）。\n    - 使用浮点运算。\n    - 潜在问题：相减抵消、上溢/下溢、$A$、$\\partial N_i/\\partial x$和$\\partial N_i/\\partial y$的相对误差大。\n- **目标**：在选项中确定一个最稳健的算法来计算$\\left(b_i,c_i\\right)$和$A$，该算法能避免不必要的相减抵消并减轻上溢/下溢。\n\n### 第二步：使用提取的已知信息进行验证\n1.  **科学依据**：该问题设置在有限元法（FEM）的背景下，这是一种在工程和物理学中标准的数值技术。形函数梯度、单元面积和系数$\\left(b_i,c_i\\right)$的公式是三角形单元公式化的基础。所描述的数值问题（在坐标值大和狭长单元情况下出现相减抵消）是在计算几何和科学计算中有充分记录的、现实世界中的挑战。该问题在科学上是合理的。\n2.  **适定性**：问题要求从四个选项中选择“最稳健”的算法。在数值分析中，“稳健性”是一个明确定义的概，与算法在面对具有挑战性的输入（例如受浮点表示限制的输入）时产生准确结果的能力有关。判断标准（避免抵消、上溢/下溢）是具体的。通过误差传播分析可以得出一个确定的答案。\n3.  **客观性**：问题以精确、技术性的语言陈述。对算法的描述是明确的。问题是客观的，并需要技术论证。\n4.  **完整性**：问题提供了足够的信息来分析每个提议算法的数值属性。几何量之间的基本关系已被陈述或属于该领域的标准知识。\n5.  **其他缺陷**：问题不是隐喻性的、琐碎的，也不是基于任何误解。它代表了有限元法软件实现中一个实际且重要的考虑因素。\n\n### 第三步：结论与行动\n问题陈述是有效的。这是一个在应用于有限元法的数值分析领域中表述良好的问题。将推导出解决方案。\n\n### 推导与分析\n\n3节点三角形单元（T3）的线性形函数$N_i$等价于面积坐标$L_i$。它们是空间坐标$(x,y)$的线性函数：\n$$N_i(x,y) = \\frac{1}{2A}(a_i + b_i x + c_i y)$$\n其中$i=1, 2, 3$对应三个顶点。三角形的面积是$A$。系数$b_i$和$c_i$由顶点坐标的循环排列给出：\n$b_1 = y_2 - y_3$, $c_1 = x_3 - x_2$\n$b_2 = y_3 - y_1$, $c_2 = x_1 - x_3$\n$b_3 = y_1 - y_2$, $c_3 = x_2 - x_1$\n\n形函数的梯度对于计算单元刚度矩阵至关重要，其表达式为：\n$$\\frac{\\partial N_i}{\\partial x} = \\frac{b_i}{2A}, \\quad \\frac{\\partial N_i}{\\partial y} = \\frac{c_i}{2A}$$\n两倍面积$2A$可以通过从一个公共顶点（例如顶点1）出发的边向量的行列式来计算：\n$$2A = \\det\\begin{pmatrix} x_2 - x_1 & x_3 - x_1 \\\\ y_2 - y_1 & y_3 - y_1 \\end{pmatrix} = (x_2 - x_1)(y_3 - y_1) - (x_3 - x_1)(y_2 - y_1)$$\n计算梯度的数值稳健性关键取决于$A$和系数$b_i, c_i$的精确计算。问题强调了两个主要挑战：\n1.  **坐标值大但间距小**：如果$x_i, y_i$很大，直接评估涉及$x_i y_j$这类乘积的公式可能导致灾难性抵消。例如，鞋带公式是行列式的展开，会遇到这个问题。\n2.  **狭长三角形**：如果顶点几乎共线，则面积$A$接近于零。$2A$的行列式公式涉及两个几乎相等的量的相减，这同样会导致相对精度的损失。\n\n我们现在将根据这些标准分析每个选项。\n\n**A. 直接对原始坐标使用鞋带公式计算$A$...**\n鞋带公式是$2A = (x_1y_2 - y_1x_2) + (x_2y_3 - y_2x_3) + (x_3y_1 - y_3x_1)$。让我们考虑一个坐标值很大的例子：$x_1 = 10^9, y_1 = 1$；$x_2 = 10^9+1, y_2 = 1$；$x_3 = 10^9, y_3=2$。这个三角形很小。项$x_1y_2 = 10^9+1$。项$y_1x_2 = 10^9+1$。它们的差为$0$。项$x_2y_3 = 2(10^9+1) = 2 \\cdot 10^9+2$。项$y_2x_3 = 1 \\cdot 10^9$。等等。该公式涉及非常大的数的加减，以获得一个小的最终结果$A$。在浮点运算中，有限的精度意味着最终结果的有效数字会丢失。这种现象被称为灾难性抵消。对于大坐标值的情况，这种方法是出了名的不稳定。将$b_i, c_i$计算为差值是稳定的，但不准确的$A$会破坏梯度计算。\n结论：**不正确**。这是该问题数值不稳定算法的教科书式例子。\n\n**B. 相对于一个顶点形成边差分，并对其进行缩放...**\n该算法分几个步骤进行，旨在解决数值问题。\n1.  **平移**：计算边差分，例如$\\Delta x_{21} = x_2 - x_1$，$\\Delta y_{21} = y_2 - y_1$等。所有后续计算都基于这些差分。这在数学上对应于将三角形平移，使顶点1位于原点。如果原始坐标$x_i \\approx 10^9$且间距为$O(1)$，则新坐标（边分量）为$O(1)$。这一步就巧妙地解决了由大坐标偏移引起的灾难性抵消问题。\n2.  **缩放**：计算一个缩放因子$s = \\max\\{|\\Delta x_{21}|, |\\Delta y_{21}|, |\\Delta x_{31}|, |\\Delta y_{31}|\\}$。所有边分量都除以$s$。这将分量映射到[-1, 1]的范围内。如果三角形非常大（边长很长），此步骤可以防止上溢；如果三角形非常小，则可以防止下溢。这是一种提高数值稳定性的标准技术。\n3.  **面积计算**：面积由缩放后的分量计算得出：$2\\hat{A} = \\hat{\\Delta x}_{21}\\,\\hat{\\Delta y}_{31} - \\hat{\\Delta x}_{31}\\,\\hat{\\Delta y}_{21}$。由于分量约为1的量级，乘积也约为1的量级，从而防止了上溢。使用融合乘加（FMA）指令的建议是进一步的改进。FMA以单个舍入误差计算$a \\cdot b - c$，比分别进行乘法和减法（两个舍入误差）更精确。这对于狭长三角形尤其有价值，因为此时$\\hat{\\Delta x}_{21}\\,\\hat{\\Delta y}_{31} \\approx \\hat{\\Delta x}_{31}\\,\\hat{\\Delta y}_{21}$，小差值的精确性至关重要。\n4.  **恢复缩放**：最终面积通过$2A = 2\\hat{A}\\,s^2$恢复。$s^2$因子是正确的，因为面积随长度的平方缩放。\n5.  **系数计算**：系数$b_i, c_i$由边差分计算，例如$b_2 = \\Delta y_{31}$和$c_3 = \\Delta x_{21}$。这些只是已经计算过的边分量。其他系数是这些分量的差，例如$b_1 = \\Delta y_{21} - \\Delta y_{31}$。这在数值上是稳定的，因为它操作的是已经平移过的小数值。所提供的公式只是用从顶点1出发的边向量表示的$b_i, c_i$的标准定义。例如，$b_1 = y_2 - y_3 = (y_2 - y_1) - (y_3 - y_1) = \\Delta y_{21} - \\Delta y_{31}$。所有公式都是正确的。\n该算法系统地解决了所有陈述的数值挑战。\n结论：**正确**。\n\n**C. 计算边长$a$, $b$, $c$ [...] 然后使用海伦公式...**\n1.  **面积计算**：众所周知，海伦公式$A = \\sqrt{s_h(s_h-a)(s_h-b)(s_h-c)}$对于狭长三角形是数值不稳定的。对于一个狭长三角形，一条边的长度约等于另外两条边之和，例如$c \\approx a+b$。半周长是$s_h = (a+b+c)/2 \\approx c$。那么项$s_h-c$是通过减去两个几乎相等的大数计算出来的一个小数，导致精度损失。虽然存在海伦公式的数值稳定版本（例如，Kahan公式），但这里给出的标准版本对于狭长三角形并不稳健。\n2.  **系数计算**：该选项建议设置$b_i = (y_j - y_k)/(a+b+c)$和$c_i = (x_k - x_j)/(a+b+c)$。这在根本上是错误的。真正的系数是$b_i = y_j - y_k$和$c_i = x_k - x_j$。这些量具有长度的单位。该选项将它们除以周长，周长也具有长度单位，从而得到无量纲的量。这将导致错误的梯度计算。\n结论：**不正确**。面积公式在指定的挑战性情况下不稳定，且系数的公式在量纲上和数学上都是错误的。\n\n**D. 首先通过减去质心来平移所有顶点...**\n1.  **平移**：此方法建议将原点平移到质心$(\\bar{x}, \\bar{y})$。这是处理大坐标问题的一种有效方法，类似于选项B中平移到一个顶点。平移后，新坐标$x_i'$的数量级与单元尺寸相当，减轻了后续乘积和中的灾难性抵消。然而，质心本身的计算，$\\bar{x} = (x_1+x_2+x_3)/3$，可能会有问题。如果$x_i$非常大且接近可表示的最大浮点数，和$x_1+x_2+x_3$可能会上溢，即使差值$x_i - x_j$不会。选项B的差分法在这种极端情况下更安全。\n2.  **面积和系数计算**：该选项然后说明在平移后的坐标$(x_i', y_i')$上使用鞋带公式，并对$(b_i, c_i)$使用标准的差分公式。使用鞋带公式不如B中使用的$2 \\times 2$行列式形式直接。它涉及6次乘法和5次加/减法，而后者只有2次乘法和1次减法。更多的操作通常意味着更多的累积浮点误差。\n3.  **缺乏缩放和FMA**：该选项没有包括缩放以防止非常大或非常小的三角形的上溢/下溢。也没有提到使用FMA来提高狭长三角形的精度。\n将D与B进行比较，选项B更稳健。它使用更安全的平移步骤（差分法与平均法相比）、更紧凑的面积公式，并结合了缩放和FMA来处理全部数值挑战。\n结论：**不正确**。虽然比A有所改进，但它不如B选项稳健和全面。", "answer": "$$\\boxed{B}$$", "id": "2608131"}, {"introduction": "在掌握了如何稳健地计算单元几何之后，下一个核心任务便是通过对形函数乘积进行积分来构建单元矩阵，例如质量矩阵。对于 T3 和 T6 单元，其形函数天然地使用面积坐标 $L_i$ 进行表达，这使得我们可以利用强大的积分公式 $\\int_T L_1^a L_2^b L_3^c dA = A \\frac{2! a! b! c!}{(2+a+b+c)!}$ 来精确地进行解析计算。本练习让您亲手应用此基本公式，为 T6 单元组装一致质量矩阵的一个具体矩阵元，从而加深对面积坐标这一抽象数学工具与实际工程计算之间联系的理解。[@problem_id:2608073]", "problem": "设 $T$ 为平面上的一个非退化三角形，其面积为 $A$，并赋有重心（面积）坐标 $L_{1}$、$L_{2}$、$L_{3}$，在 $T$ 上满足 $L_{1}+L_{2}+L_{3}=1$ 及 $L_{i}\\ge 0$。考虑一个六节点二次拉格朗日三角形（T6），其节点采用标准排序：顶点为 $1,2,3$，边中点为 $4$（在边 $(1,2)$ 上）、$5$（在边 $(2,3)$ 上）、$6$（在边 $(3,1)$ 上）。用重心坐标表示的二次形函数为\n$$N_{1}=L_{1}\\left(2L_{1}-1\\right),\\quad N_{2}=L_{2}\\left(2L_{2}-1\\right),\\quad N_{3}=L_{3}\\left(2L_{3}-1\\right),$$\n$$N_{4}=4L_{1}L_{2},\\quad N_{5}=4L_{2}L_{3},\\quad N_{6}=4L_{3}L_{1}.$$\n\n任务：\n- 从第一性原理（重心坐标的定义和从参考单纯形出发的仿射映射）出发，并利用在标准参考三角形上已验证的多元Beta函数性质，推导积分 $\\int_{T} L_{i}L_{j}\\, \\mathrm{d}A$ 和 $\\int_{T} L_{i}L_{j}L_{k}\\, \\mathrm{d}A$ 关于 $A$ 的表达式。您的表达式必须对任意指标 $i,j,k\\in\\{1,2,3\\}$ 的选择都有效，并清楚地区分指标相同或不同的情况。\n- 利用这些结果，为表面质量密度为 $\\rho_{s}$ 的均匀标量膜组装一致质量矩阵元 $M_{45}$，其定义为 $M_{ab}=\\rho_{s}\\int_{T} N_{a}N_{b}\\,\\mathrm{d}A$。取一个具体的三角形 $T$，其顶点为 $(0,0)$、$(2,0)$、$(0,3)$，均匀表面质量密度为 $\\rho_{s}=1$ kg/m²。\n\n给出 $M_{45}$ 的最终值，形式为一个单独的数字。最终答案以千克为单位表示。无需四舍五入。", "solution": "该问题具有科学性，定义明确，且包含了求解唯一解所需的所有信息。这是有限元分析领域的一个标准练习。解题过程如下。\n\n首先，问题要求推导重心坐标乘积在三角形 $T$ 上的积分公式。其基本原理是通过仿射映射，将物理单元 $T$（面积为 $A$）上的积分变换到规范的参考单元 $\\hat{T}$ 上。这是通过仿射映射实现的。面积微元之间的关系是 $dA = |J|d\\hat{A}$，其中雅可比行列式 $|J|$ 是一个常数，等于 $|J|=2A$。这导出了一个用于计算重心坐标 $L_1, L_2, L_3$ 单项式积分的成熟公式：\n$$ \\int_T L_1^a L_2^b L_3^c \\, dA = A \\frac{2! a! b! c!}{(2+a+b+c)!} $$\n此处，$a, b, c$ 是非负整数指数。该公式是狄利克雷积分（即在单纯形上求值的多元Beta函数）性质的直接推论。利用这个主公式，我们推导所需积分的表达式。\n\n首先，考虑积分 $\\int_T L_i L_j \\, dA$。对于指标 $i, j \\in \\{1, 2, 3\\}$，有两种情况。\n情况1：指标相同，$i=j$。我们计算 $\\int_T L_i^2 \\, dA$。根据对称性，可设 $i=1$。这对应于指数 $(a,b,c) = (2,0,0)$。\n$$ \\int_T L_i^2 \\, dA = A \\frac{2! 2! 0! 0!}{(2+2+0+0)!} = A \\frac{2 \\cdot 2}{4!} = A \\frac{4}{24} = \\frac{A}{6} $$\n情况2：指标不同，$i \\ne j$。我们计算 $\\int_T L_i L_j \\, dA$。根据对称性，可设 $i=1, j=2$。这对应于指数 $(a,b,c) = (1,1,0)$。\n$$ \\int_T L_i L_j \\, dA = A \\frac{2! 1! 1! 0!}{(2+1+1+0)!} = A \\frac{2 \\cdot 1 \\cdot 1}{4!} = A \\frac{2}{24} = \\frac{A}{12} \\quad (i \\ne j) $$\n\n接下来，考虑积分 $\\int_T L_i L_j L_k \\, dA$。对于指标 $i, j, k \\in \\{1, 2, 3\\}$，有三种情况。\n情况1：所有指标均相同，$i=j=k$。我们计算 $\\int_T L_i^3 \\, dA$。设 $i=1$，则指数为 $(a,b,c) = (3,0,0)$。\n$$ \\int_T L_i^3 \\, dA = A \\frac{2! 3! 0! 0!}{(2+3+0+0)!} = A \\frac{2 \\cdot 6}{5!} = A \\frac{12}{120} = \\frac{A}{10} $$\n情况2：两个指标相同，一个不同（例如 $i=j, i \\ne k$）。我们计算 $\\int_T L_i^2 L_k \\, dA$。设 $i=1, k=2$，则指数为 $(a,b,c) = (2,1,0)$。\n$$ \\int_T L_i^2 L_k \\, dA = A \\frac{2! 2! 1! 0!}{(2+2+1+0)!} = A \\frac{2 \\cdot 2 \\cdot 1}{5!} = A \\frac{4}{120} = \\frac{A}{30} \\quad (i \\ne k) $$\n情况3：所有指标均不同，$\\{i,j,k\\} = \\{1,2,3\\}$。我们计算 $\\int_T L_1 L_2 L_3 \\, dA$。指数为 $(a,b,c) = (1,1,1)$。\n$$ \\int_T L_1 L_2 L_3 \\, dA = A \\frac{2! 1! 1! 1!}{(2+1+1+1)!} = A \\frac{2 \\cdot 1 \\cdot 1 \\cdot 1}{5!} = A \\frac{2}{120} = \\frac{A}{60} $$\n至此，第一个任务完成。我们现在开始计算具体的质量矩阵元 $M_{45}$。\n\n一致质量矩阵元 $M_{ab}$ 定义为 $M_{ab} = \\rho_s \\int_T N_a N_b \\, dA$。对于 $M_{45}$，我们使用边中点 $4$ 和 $5$ 的形函数：\n$$ N_4 = 4L_1 L_2 $$\n$$ N_5 = 4L_2 L_3 $$\n这些形函数的乘积是：\n$$ N_4 N_5 = (4L_1 L_2)(4L_2 L_3) = 16 L_1 L_2^2 L_3 $$\n因此，质量矩阵元 $M_{45}$ 由以下积分给出：\n$$ M_{45} = \\rho_s \\int_T 16 L_1 L_2^2 L_3 \\, dA = 16 \\rho_s \\int_T L_1 L_2^2 L_3 \\, dA $$\n被积函数是重心坐标的乘积，其指数为 $(a,b,c) = (1,2,1)$。指数之和为 $1+2+1=4$。使用我们的主公式：\n$$ \\int_T L_1^1 L_2^2 L_3^1 \\, dA = A \\frac{2! 1! 2! 1!}{(2+1+2+1)!} = A \\frac{2 \\cdot 1 \\cdot 2 \\cdot 1}{6!} = A \\frac{4}{720} = \\frac{A}{180} $$\n将此结果代入 $M_{45}$ 的表达式中：\n$$ M_{45} = 16 \\rho_s \\left( \\frac{A}{180} \\right) = \\frac{16}{180} \\rho_s A = \\frac{4}{45} \\rho_s A $$\n问题给出了三角形 $T$ 和表面密度 $\\rho_s$ 的具体数据。$T$ 的顶点为 $(0,0)$、$(2,0)$ 和 $(0,3)$。这是一个底边 $b=2$ 米、高 $h=3$ 米的直角三角形。其面积 $A$ 为：\n$$ A = \\frac{1}{2} b h = \\frac{1}{2}(2)(3) = 3 \\, \\text{m}^2 $$\n表面质量密度为 $\\rho_s = 1$ kg/m²。\n代入这些值，我们计算出 $M_{45}$ 的最终数值：\n$$ M_{45} = \\frac{4}{45} (1 \\, \\text{kg/m}^2) (3 \\, \\text{m}^2) = \\frac{12}{45} \\, \\text{kg} = \\frac{4}{15} \\, \\text{kg} $$\n该值需要以千克为单位表示为一个单独的数字。我们提供精确的分数形式。", "answer": "$$\\boxed{\\frac{4}{15}}$$", "id": "2608073"}, {"introduction": "尽管质量矩阵等可以通过解析方法精确积分，但刚度矩阵 $K_e = \\int_T B^T D B t dA$ 的被积函数通常更为复杂，必须依赖数值积分（或称高斯求积）。数值积分的有效性取决于其能精确积分的多项式阶次，然而，被积函数的性质会因单元几何映射的不同而剧烈改变：是简单的直线边（仿射映射），还是复杂的曲线边（等参映射）？本问题将引导您深入剖析等参映射的内涵，揭示为何对仿射单元完美奏效的标准求积法则，在面对曲线单元时却可能无法保证精确性——这对于在复杂几何模型中正确应用有限元法是一个关键的洞察。[@problem_id:2608123]", "problem": "考虑一个使用有限元法 (FEM) 的二维线性弹性分析，其中本构矩阵 $D$ 和厚度 $t$ 均为常数。设 $T$ 表示一个 $T_6$ 型的三角形等参单元，其二次拉格朗日形函数用面积（重心）坐标 $(L_1,L_2,L_3)$ 表示，且在 $T$ 上满足 $L_1+L_2+L_3=1$。单元刚度矩阵定义为\n$$\nK_e \\;=\\; \\int_T B^{\\mathsf T} \\, D \\, B \\, t \\, dA,\n$$\n其中 $B$ 是由形函数的空间梯度构建的应变-位移矩阵。\n\n考虑两种几何映射：\n- 情况 I (仿射几何)：三角形单元是直边的，从面积坐标到物理坐标的几何映射是仿射的（等价地，在 $T$ 上，$L_i$ 是 $(x,y)$ 的线性函数）。\n- 情况 II (二次几何)：单元使用具有曲线边的完全二次等参几何映射，即物理坐标 $(x,y)$ 是使用与场插值相同的二次形函数构建的父单元坐标的二次多项式。\n\n如果一个三角形上的数值积分法则能够精确积分该三角形上任意一个全次数至多为 $p$ 的多项式，则称该法则是 $p$ 阶多项式精确的。\n\n哪个陈述正确地指出了在每种情况下，为精确积分 $K_e$ 所需的三角形积分法则的最小多项式精确阶数？\n\nA. 情况 I：2 阶；情况 II：一般情况下，没有有限阶多项式精确法则能精确积分 $K_e$。\n\nB. 情况 I：2 阶；情况 II：4 阶。\n\nC. 情况 I：3 阶；情况 II：5 阶。\n\nD. 情况 I：4 阶；情况 II：4 阶。", "solution": "对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 分析类型：$2$D 线性弹性分析。\n- 本构矩阵：$D$，常数。\n- 厚度：$t$，常数。\n- 单元类型：$T_6$（一个三角形等参单元）。\n- 形函数：面积坐标 $(L_1, L_2, L_3)$ 中的二次拉格朗日形函数，其中 $L_1+L_2+L_3=1$。\n- 单元刚度矩阵定义：$K_e = \\int_T B^{\\mathsf T} D B t \\, dA$。\n- 应变-位移矩阵：$B$ 由形函数的空间梯度导出。\n- 情况 I（仿射几何）：单元是直边的；几何映射是仿射的，意味着 $L_i$ 是物理坐标 $(x,y)$ 的线性函数。\n- 情况 II（二次几何）：单元具有曲线边，采用完全二次等参几何映射。\n- 积分法则定义：$p$ 阶多项式精确意味着对所有全次数至多为 $p$ 的多项式都能精确积分。\n- 问题：确定在情况 I 和情况 II 中，为精确积分 $K_e$ 所需的积分法则的最小多项式精确阶数。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题是在有限元法 (Finite Element Method) 的标准且成熟的数学框架内提出的。所有术语，如 $T_6$ 单元、面积坐标、等参映射和单元刚度矩阵，都根据标准文献进行了定义。仿射映射和一般二次映射之间的区别是有限元教学中的一个经典课题。该问题具有科学依据、提法恰当且客观。它不包含任何科学谬误、矛盾或含糊不清之处。所有必要的信息都已提供。\n\n**步骤 3：结论与行动**\n该问题是有效的。我将继续推导解答。\n\n单元刚度矩阵由下式给出：\n$$\nK_e = \\int_T B^{\\mathsf T} D B t \\, dA\n$$\n为确定所需的积分法则，我们必须找出被积函数（即矩阵值函数 $I = B^{\\mathsf T} D B t$）的多项式次数。由于 $D$ 和 $t$ 为常数，被积函数的性质由项 $B^{\\mathsf T} B$ 决定。矩阵 $B$ 由形函数 $N_i$ 的空间导数构建。对于一个二维问题，位移场 $(u,v)$ 插值为：\n$$\nu(x,y) = \\sum_{i=1}^{6} N_i u_i, \\quad v(x,y) = \\sum_{i=1}^{6} N_i v_i\n$$\n应变向量 $\\epsilon = \\{\\epsilon_x, \\epsilon_y, \\gamma_{xy}\\}^{\\mathsf T}$ 通过导数与位移相关：\n$$\n\\epsilon_x = \\frac{\\partial u}{\\partial x}, \\quad \\epsilon_y = \\frac{\\partial v}{\\partial y}, \\quad \\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x}\n$$\n这就导出了应变-位移矩阵 $B = [B_1, B_2, \\dots, B_6]$，其中每个子矩阵 $B_i$ 为：\n$$\nB_i = \\begin{bmatrix} \\frac{\\partial N_i}{\\partial x} & 0 \\\\ 0 & \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x} \\end{bmatrix}\n$$\n$T_6$ 单元的形函数 $N_i$ 是面积坐标 $(L_1, L_2, L_3)$ 的二次多项式。例如，对于角节点 $i$，$N_i = L_i(2L_i - 1)$；对于角点 $k$ 和 $m$ 之间的边中节点 $j$，$N_j = 4L_kL_m$。所有 $N_i$ 都是 $L_1, L_2, L_3$ 的 2 次多项式。\n\n**情况 I：仿射几何**\n在这种情况下，单元是直边的。面积坐标 $(L_1, L_2, L_3)$ 是物理坐标 $(x,y)$ 的线性函数：\n$$\nL_i(x,y) = a_i x + b_i y + c_i\n$$\n其中 $a_i, b_i, c_i$ 是常数。由于形函数 $N_i$ 是 $L_j$ 的二次多项式，而 $L_j$ 是 $(x,y)$ 的线性函数，因此形函数 $N_i(x,y)$ 成为物理坐标 $(x,y)$ 的二次多项式。\n矩阵 $B_i$ 的元素是空间导数 $\\frac{\\partial N_i}{\\partial x}$ 和 $\\frac{\\partial N_i}{\\partial y}$。一个二次多项式的导数是一个线性多项式。因此，应变-位移矩阵 $B$ 的每个元素都是 $x$ 和 $y$ 的线性多项式。\n刚度矩阵的被积函数包含乘积 $B^{\\mathsf T} B$。该乘积矩阵的元素是 $B$ 中元素的乘积之和。两个线性多项式的乘积得到一个二次多项式。\n因此，被积函数 $I(x,y) = B(x,y)^{\\mathsf T} D B(x,y) t$ 是一个矩阵，其元素是 $x$ 和 $y$ 的全次数至多为 2 的多项式。\n要在三角形域 $T$ 上精确积分一个 $p$ 次多项式，积分法则必须至少是 $p$ 阶多项式精确的。\n因此，对于情况 I，所需的最小多项式精确阶数是 $2$。\n\n**情况 II：二次等参几何**\n在这种情况下，几何本身是使用相同的二次形函数 $N_i$ 从父单元（例如，在与任意两个面积坐标线性相关的坐标 $(\\xi, \\eta)$ 中）映射过来的：\n$$\nx(\\xi, \\eta) = \\sum_{i=1}^{6} N_i(\\xi, \\eta) x_i, \\quad y(\\xi, \\eta) = \\sum_{i=1}^{6} N_i(\\xi, \\eta) y_i\n$$\n$K_e$ 的积分被变换到父域，我们称之为 $\\hat{T}$：\n$$\nK_e = \\int_{\\hat{T}} B^{\\mathsf T} D B t \\det(J) \\, d\\xi d\\eta\n$$\n其中 $J$ 是几何映射的雅可比矩阵：\n$$\nJ = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix}\n$$\n矩阵 $B$ 所需的空间导数通过链式法则计算：\n$$\n\\begin{Bmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{Bmatrix} = J^{-1} \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{Bmatrix}\n$$\n让我们分析被积函数中每一项关于父单元坐标 $(\\xi, \\eta)$ 的多项式次数。\n1.  形函数 $N_i(\\xi, \\eta)$ 是二次的。它们的导数 $\\frac{\\partial N_i}{\\partial \\xi}$ 和 $\\frac{\\partial N_i}{\\partial \\eta}$ 是 $(\\xi, \\eta)$ 的线性多项式。\n2.  映射函数 $x(\\xi, \\eta)$ 和 $y(\\xi, \\eta)$ 是二次的。它们关于 $(\\xi, \\eta)$ 的导数构成了 $J$ 的元素，是线性多项式。\n3.  雅可比行列式 $\\det(J) = \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial y}{\\partial \\xi}\\frac{\\partial x}{\\partial \\eta}$ 是两个线性多项式的乘积减去另一个这样的乘积。因此，$\\det(J)$ 是 $(\\xi, \\eta)$ 的二次多项式。\n4.  雅可比矩阵的逆是 $J^{-1} = \\frac{1}{\\det(J)} \\text{adj}(J)$，其中 $\\text{adj}(J)$ 是 $J$ 的伴随矩阵。$\\text{adj}(J)$ 的元素是 $J$ 的元素（有符号变化），它们是线性多项式。因此，$J^{-1}$ 的元素是有理函数：分子是一个线性多项式，分母是一个二次多项式 $\\det(J)$。\n5.  矩阵 $B$ 的元素（例如 $\\frac{\\partial N_i}{\\partial x}$）是通过将 $J^{-1}$ 的元素（有理函数）与导数 $\\frac{\\partial N_i}{\\partial \\xi}$（线性多项式）相乘计算得出的。$B$ 的结果元素是形式为 $\\frac{P_2(\\xi, \\eta)}{Q_2(\\xi, \\eta)}$ 的有理函数，其中 $P_2$ 和 $Q_2$ 是二次多项式（特别地，$Q_2 = \\det(J)$）。\n6.  父域中的被积函数为 $I(\\xi, \\eta) = B(\\xi, \\eta)^{\\mathsf T} D B(\\xi, \\eta) t \\det(J)$。矩阵乘积 $B^{\\mathsf T} B$ 中的一个典型元素是诸如 $b_{ki} b_{lj}$ 之类的项的和。每个这样的项是两个有理函数的乘积：$\\frac{P_2}{Q_2} \\times \\frac{R_2}{Q_2} = \\frac{P_2 R_2}{Q_2^2}$，其结果是一个分子为 4 次、分母为 4 次的有理函数。让我们更精确地表示被积函数中的一个项。令 $B = \\frac{1}{\\det(J)} \\tilde{B}$，其中 $\\tilde{B}$ 现在包含 2 次的多项式元素。\n被积函数为：\n$$\n\\left(\\frac{1}{\\det(J)} \\tilde{B}\\right)^{\\mathsf T} D \\left(\\frac{1}{\\det(J)} \\tilde{B}\\right) t \\det(J) = \\frac{1}{(\\det(J))^2} \\tilde{B}^{\\mathsf T} D \\tilde{B} t \\det(J) = \\frac{\\tilde{B}^{\\mathsf T} D \\tilde{B} t}{\\det(J)}\n$$\n矩阵 $\\tilde{B}$ 的元素是 $(\\xi, \\eta)$ 中的 2 次多项式。因此，乘积 $\\tilde{B}^{\\mathsf T} \\tilde{B}$ 的元素将是 4 次多项式。所以，分子 $\\tilde{B}^{\\mathsf T} D \\tilde{B} t$ 是一个 4 次多项式矩阵。分母是 $\\det(J)$，一个 2 次多项式。\n被积函数是一个形式为 $\\frac{P_4(\\xi, \\eta)}{P_2(\\xi, \\eta)}$ 的有理函数矩阵。一般而言，这样的有理函数不是一个多项式。一个为精确积分多项式而设计的积分法则，无论其多项式阶数 $p$ 是多少，通常都无法精确地积分这样的函数。\n\n因此，对于情况 II，在曲线边单元的一般情况下，没有有限阶多项式精确积分法则能够保证刚度矩阵的精确积分。\n\n**选项评估**\n\n*   **A. 情况 I：2 阶；情况 II：一般情况下，没有有限阶多项式精确法则能精确积分 $K_e$。**\n    该陈述与我们对两种情况的推导完全一致。\n    判决：**正确**。\n\n*   **B. 情况 I：2 阶；情况 II：4 阶。**\n    关于情况 I 的陈述是正确的。关于情况 II 的陈述是错误的。被积函数不是 4 次多项式；它是一个有理函数。\n    判决：**错误**。\n\n*   **C. 情况 I：3 阶；情况 II：5 阶。**\n    关于情况 I 的陈述是错误的。所需的最小阶数是 2。虽然 3 阶的法则是充分的，但它不是最小的。关于情况 II 的陈述也是错误的。\n    判决：**错误**。\n\n*   **D. 情况 I：4 阶；情况 II：4 阶。**\n    关于情况 I 的陈述是错误的，因为它高估了所需的最小阶数（为 2）。关于情况 II 的陈述是错误的。\n    判决：**错误**。", "answer": "$$\\boxed{A}$$", "id": "2608123"}]}