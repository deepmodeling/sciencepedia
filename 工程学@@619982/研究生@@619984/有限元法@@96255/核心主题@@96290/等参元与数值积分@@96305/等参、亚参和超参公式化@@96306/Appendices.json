{"hands_on_practices": [{"introduction": "有限元分析的核心在于将复杂的物理域分解为简单的标准单元。本练习将引导您实践最基本的等参映射过程，即将一个标准的二维正方形参考单元映射到一个物理四边形单元。通过分析一个特殊的仿射情况（平行四边形），您将推导出雅可比矩阵，并理解其行列式如何与单元面积以及映射的有效性建立联系。[@problem_id:2570213]", "problem": "在有限元法（FEM）的背景下，考虑从参考正方形 $\\hat{\\Omega} = [-1,1]^2$（局部坐标为 $(\\xi,\\eta)$）到一个物理四边形（全局坐标为 $(x,y)$）的等参双线性四边形映射。四个参考节点位于 $(-1,-1)$、$(+1,-1)$、$(+1,+1)$ 和 $(-1,+1)$，对应的物理顶点位置为 $\\mathbf{X}_1$、$\\mathbf{X}_2$、$\\mathbf{X}_3$ 和 $\\mathbf{X}_4$。假设这些物理顶点排列成一个仿射构型，形成一个平行四边形：\n- $\\mathbf{X}_1 = (x_1, y_1)$，\n- $\\mathbf{X}_2 = (x_1 + a_x, y_1 + a_y)$，\n- $\\mathbf{X}_3 = (x_1 + a_x + b_x, y_1 + a_y + b_y)$，\n- $\\mathbf{X}_4 = (x_1 + b_x, y_1 + b_y)$，\n其中 $(a_x,a_y)$ 和 $(b_x,b_y)$ 是定义 $\\mathbf{X}_1$ 处两条相邻边的固定向量。使用等参概念（即用相同的双线性形函数对几何和场进行插值），从 $\\hat{\\Omega}$ 上的标准双线性形函数出发，并：\n- 显式地写出映射 $\\mathbf{F}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,\\mathbf{X}_i$，\n- 在给定的仿射顶点构型下对其进行简化，\n- 计算雅可比矩阵 $\\mathbf{J}(\\xi,\\eta) = \\partial \\mathbf{F} / \\partial (\\xi,\\eta)$ 及其行列式，\n- 并在 $a_x b_y - a_y b_x > 0$ 的条件下，论证 $\\hat{\\Omega}$ 的内点是否映射到物理四边形的内点。\n\n给出作为最终答案的行列式 $\\det \\mathbf{J}$ 的闭式表达式，该表达式是关于 $a_x$、$a_y$、$b_x$ 和 $b_y$ 的函数。无需四舍五入。最终答案中不要包含单位。", "solution": "所述问题是有限元法理论中的一个标准练习。它具有科学依据，提法明确，并包含足够的信息以获得唯一解。我们将直接进行推导。\n\n等参格式利用同一组形函数 $N_i$ 来对单元的几何形状和单元上的未知场变量进行插值。对于一个双线性四节点四边形单元，从参考坐标 $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ 对坐标向量 $\\mathbf{x} = (x, y)$ 的插值由映射 $\\mathbf{F}(\\xi, \\eta)$ 给出：\n$$\n\\mathbf{x}(\\xi, \\eta) = \\mathbf{F}(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) \\mathbf{X}_i\n$$\n其中 $\\mathbf{X}_i$ 是物理单元顶点的坐标。四个节点的标准双线性形函数，从左下角 $(\\xi=-1, \\eta=-1)$ 开始逆时针排序，为：\n$$\n\\begin{aligned}\nN_1(\\xi, \\eta) &= \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_2(\\xi, \\eta) &= \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_3(\\xi, \\eta) &= \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_4(\\xi, \\eta) &= \\frac{1}{4}(1-\\xi)(1+\\eta)\n\\end{aligned}\n$$\n问题指定了构成平行四边形的物理顶点的坐标：\n$$\n\\begin{aligned}\n\\mathbf{X}_1 &= (x_1, y_1) \\\\\n\\mathbf{X}_2 &= (x_1 + a_x, y_1 + a_y) \\\\\n\\mathbf{X}_3 &= (x_1 + a_x + b_x, y_1 + a_y + b_y) \\\\\n\\mathbf{X}_4 &= (x_1 + b_x, y_1 + b_y)\n\\end{aligned}\n$$\n此处，$\\mathbf{a} = (a_x, a_y)$ 和 $\\mathbf{b} = (b_x, b_y)$ 表示从顶点 $\\mathbf{X}_1$ 出发的两个相邻边的向量。\n\n我们现在分别显式地写出 $x$ 和 $y$ 坐标的映射。\n对于 $x$ 坐标：\n$$\nx(\\xi, \\eta) = N_1(\\xi, \\eta) x_1 + N_2(\\xi, \\eta) (x_1 + a_x) + N_3(\\xi, \\eta) (x_1 + a_x + b_x) + N_4(\\xi, \\eta) (x_1 + b_x)\n$$\n我们可以对各项进行重新组合：\n$$\nx(\\xi, \\eta) = x_1 (N_1 + N_2 + N_3 + N_4) + a_x (N_2 + N_3) + b_x (N_3 + N_4)\n$$\n形函数的一个基本性质是它们构成单位分解，即 $\\sum_{i=1}^{4} N_i(\\xi, \\eta) = 1$。让我们验证其他的和：\n$$\nN_2 + N_3 = \\frac{1}{4}(1+\\xi)(1-\\eta) + \\frac{1}{4}(1+\\xi)(1+\\eta) = \\frac{1}{4}(1+\\xi)[(1-\\eta)+(1+\\eta)] = \\frac{1}{2}(1+\\xi)\n$$\n$$\nN_3 + N_4 = \\frac{1}{4}(1+\\xi)(1+\\eta) + \\frac{1}{4}(1-\\xi)(1+\\eta) = \\frac{1}{4}(1+\\eta)[(1+\\xi)+(1-\\xi)] = \\frac{1}{2}(1+\\eta)\n$$\n将这些代回到 $x(\\xi, \\eta)$ 的表达式中，得到：\n$$\nx(\\xi, \\eta) = x_1 + \\frac{1}{2}(1+\\xi)a_x + \\frac{1}{2}(1+\\eta)b_x\n$$\n根据相同的逻辑，$y$ 坐标的映射为：\n$$\ny(\\xi, \\eta) = y_1 + \\frac{1}{2}(1+\\xi)a_y + \\frac{1}{2}(1+\\eta)b_y\n$$\n这两个方程定义了从参考正方形到物理平行四边形的显式仿射映射。\n\n下一步是计算此变换的雅可比矩阵 $\\mathbf{J}(\\xi, \\eta)$。雅可比矩阵定义为：\n$$\n\\mathbf{J}(\\xi, \\eta) = \\frac{\\partial \\mathbf{F}}{\\partial (\\xi, \\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n我们从简化的映射方程中计算必要的偏导数：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( x_1 + \\frac{1}{2}(1+\\xi)a_x + \\frac{1}{2}(1+\\eta)b_x \\right) = \\frac{1}{2}a_x\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left( x_1 + \\frac{1}{2}(1+\\xi)a_x + \\frac{1}{2}(1+\\eta)b_x \\right) = \\frac{1}{2}b_x\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( y_1 + \\frac{1}{2}(1+\\xi)a_y + \\frac{1}{2}(1+\\eta)b_y \\right) = \\frac{1}{2}a_y\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left( y_1 + \\frac{1}{2}(1+\\xi)a_y + \\frac{1}{2}(1+\\eta)b_y \\right) = \\frac{1}{2}b_y\n$$\n将这些分量组合起来，得到雅可比矩阵：\n$$\n\\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} \\frac{1}{2}a_x & \\frac{1}{2}b_x \\\\ \\frac{1}{2}a_y & \\frac{1}{2}b_y \\end{pmatrix}\n$$\n注意，对于仿射映射，雅可比矩阵是常数；它不是局部坐标 $(\\xi, \\eta)$ 的函数。\n\n最后，我们计算雅可比矩阵的行列式：\n$$\n\\det \\mathbf{J} = \\left(\\frac{1}{2}a_x\\right)\\left(\\frac{1}{2}b_y\\right) - \\left(\\frac{1}{2}b_x\\right)\\left(\\frac{1}{2}a_y\\right) = \\frac{1}{4}(a_x b_y - a_y b_x)\n$$\n表达式 $a_x b_y - a_y b_x$ 是向量 $\\mathbf{a}=(a_x, a_y, 0)$ 和 $\\mathbf{b}=(b_x, b_y, 0)$ 叉积的模，它在几何上表示由这两个向量构成的平行四边形的面积。设 $A$ 为物理单元的面积。那么 $\\det\\mathbf{J} = \\frac{A}{4}$，因为参考正方形的面积为 $4$。微分面积关系为 $dx\\,dy = (\\det \\mathbf{J}) \\,d\\xi\\,d\\eta$。\n\n关于内点的映射：要使映射有效（即一对一且保持方向），雅可比行列式必须在定义域内处处为正。问题指定了 $a_x b_y - a_y b_x > 0$。因此，$\\det \\mathbf{J} = \\frac{1}{4}(a_x b_y - a_y b_x) > 0$。由于雅可比行列式是一个正常数，该映射对于所有 $(\\xi, \\eta) \\in \\hat{\\Omega}$ 都是非奇异的。一个非奇异的仿射变换是双射。因此，它将参考正方形的边界映射到物理平行四边形的边界上，并且关键地，它将参考正方形的内部唯一地映射到物理平行四边形的内部。条件 $\\det \\mathbf{J} > 0$ 确保了单元不是退化的（即塌缩成一条线或一个点），也不是反转的（即顶点以一致的逆时针顺序编号）。", "answer": "$$\\boxed{\\frac{1}{4}(a_x b_y - a_y b_x)}$$", "id": "2570213"}, {"introduction": "等参、亚参和超参数公式的选择直接影响计算的精度和效率。本练习通过一个简化的、可控的一维算例，让您亲手构建这三种不同类型的单元。您将通过计算物理导数 $du/dx$ 来直接比较这些公式在计算上的差异，从而深刻理解几何表示与场变量插值之间的关系。[@problem_id:2570237]", "problem": "考虑一个一维（$1$D）参考单元，其母坐标为 $\\xi \\in [-1,1]$。设该参考单元上三次（$p=3$）Lagrange 插值的节点集为 $\\{\\xi_1,\\xi_2,\\xi_3,\\xi_4\\}=\\{-1,-\\frac{1}{3},\\frac{1}{3},1\\}$。从 Lagrange 插值多项式的定义出发，推导与这些节点相关的四个三次形函数 $\\{N_1(\\xi),N_2(\\xi),N_3(\\xi),N_4(\\xi)\\}$。\n\n利用有限元法 (FEM) 的原理，即几何映射 $x(\\xi)$ 和场近似 $u(\\xi)$ 都是通过所选形函数对其节点数据进行插值来构造的，请建立三种不同的单元构型：\n\n- 等参 (Isoparametric): 几何和场均使用三次形函数 $\\{N_i(\\xi)\\}_{i=1}^4$，物理坐标为 $x_1=0$, $x_2=1$, $x_3=2$, $x_4=3$，标量场节点值为 $u_1=2$, $u_2=-1$, $u_3=3$, $u_4=0$。\n\n- 亚参 (Subparametric): 几何映射使用二次（$p=2$）插值，节点位于 $\\xi=\\{-1,0,1\\}$，物理坐标为 $\\{x(-1),x(0),x(1)\\}=\\{0,1,4\\}$；而场插值 $u(\\xi)$ 保持为三次，使用与上述相同的四个场节点值。\n\n- 超参 (Superparametric): 几何映射使用四次（$p=4$）插值，节点位于 $\\xi=\\{-1,-\\frac{1}{2},0,\\frac{1}{2},1\\}$，物理坐标为 $\\{x(-1),x(-\\frac{1}{2}),x(0),x(\\frac{1}{2}),x(1)\\}=\\{0,1,2,3,5\\}$；同样，场插值 $u(\\xi)$ 保持为三次，使用相同的四个场节点值。\n\n对于每种构型，从基本定义出发构造几何 $x(\\xi)$ 和场 $u(\\xi)$，并通过链式法则结合相应的 Jacobian $J(\\xi)=\\frac{dx}{d\\xi}$，计算在对应于 $\\xi=0$ 的点处的物理导数 $\\frac{du}{dx}$。然后，计算以下单值量\n$$\nS \\;=\\; \\left.\\frac{du}{dx}\\right|_{\\text{iso},\\,\\xi=0} \\;+\\; \\left.\\frac{du}{dx}\\right|_{\\text{super},\\,\\xi=0} \\;-\\; 2\\,\\left.\\frac{du}{dx}\\right|_{\\text{sub},\\,\\xi=0}.\n$$\n请以精确形式（无舍入）表示 $S$ 的最终答案。本问题不涉及角度单位和物理单位。", "solution": "在尝试任何解答之前，对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 参考单元：一维单元段，母坐标为 $\\xi \\in [-1,1]$。\n- 三次形函数：待推导，用于在节点集 $\\{\\xi_1, \\xi_2, \\xi_3, \\xi_4\\} = \\{-1, -1/3, 1/3, 1\\}$ 上进行 $p=3$ 阶 Lagrange 插值。记为 $\\{N_i(\\xi)\\}_{i=1}^4$。\n- 等参情况：\n    - 几何插值：三次，使用 $\\{N_i(\\xi)\\}$。节点坐标 $\\{x_1, x_2, x_3, x_4\\} = \\{0, 1, 2, 3\\}$。\n    - 场插值：三次，使用 $\\{N_i(\\xi)\\}$。节点值 $\\{u_1, u_2, u_3, u_4\\} = \\{2, -1, 3, 0\\}$。\n- 亚参情况：\n    - 几何插值：二次（$p=2$），节点位于 $\\{-1, 0, 1\\}$。节点坐标 $\\{x(-1), x(0), x(1)\\} = \\{0, 1, 4\\}$。\n    - 场插值：三次，使用 $\\{N_i(\\xi)\\}$ 及与上述相同的节点值。\n- 超参情况：\n    - 几何插值：四次（$p=4$），节点位于 $\\{-1, -1/2, 0, 1/2, 1\\}$。节点坐标 $\\{x(-1), x(-1/2), x(0), x(1/2), x(1)\\} = \\{0, 1, 2, 3, 5\\}$。\n    - 场插值：三次，使用 $\\{N_i(\\xi)\\}$ 及与上述相同的节点值。\n- 目标：对于三种构型，计算在对应于 $\\xi=0$ 点的物理导数 $\\frac{du}{dx}$。然后，计算量 $S = \\left.\\frac{du}{dx}\\right|_{\\text{iso},\\,\\xi=0} + \\left.\\frac{du}{dx}\\right|_{\\text{super},\\,\\xi=0} - 2\\,\\left.\\frac{du}{dx}\\right|_{\\text{sub},\\,\\xi=0}$。\n\n**步骤 2：问题陈述的验证**\n该问题在科学上基于有限元法理论。它是适定的，推导形函数和构造等参、亚参、超参单元所需的所有数据和条件都已明确指定。定义是标准的，任务是客观且可计算验证的。该问题没有科学上的不准确性、矛盾或歧义。\n\n**步骤 3：结论与行动**\n问题被判定为有效。现在将提供完整的解答。\n\n问题的核心在于在有限元背景下应用 Lagrange 插值和导数的链式法则。物理导数 $\\frac{du}{dx}$ 通过以下关系与母坐标 $\\xi$ 中的导数相关联：\n$$\n\\frac{du}{dx} = \\frac{du/d\\xi}{dx/d\\xi} = \\frac{1}{J(\\xi)} \\frac{du}{d\\xi}\n$$\n其中 $J(\\xi) = \\frac{dx}{d\\xi}$ 是几何映射 $x(\\xi)$ 的 Jacobian。\n\n首先，我们推导节点 $\\xi_1 = -1$、$\\xi_2 = -1/3$、$\\xi_3 = 1/3$、$\\xi_4 = 1$ 对应的三次 Lagrange 形函数 $N_i(\\xi)$。通用公式为 $N_i(\\xi) = \\prod_{j \\neq i} \\frac{\\xi - \\xi_j}{\\xi_i - \\xi_j}$。\n$$\nN_1(\\xi) = \\frac{(\\xi + 1/3)(\\xi - 1/3)(\\xi - 1)}{(-1 + 1/3)(-1 - 1/3)(-1 - 1)} = \\frac{(\\xi^2 - 1/9)(\\xi-1)}{(-2/3)(-4/3)(-2)} = -\\frac{9}{16}(\\xi^3-\\xi^2-\\frac{1}{9}\\xi+\\frac{1}{9}) = \\frac{1}{16}(-9\\xi^3+9\\xi^2+\\xi-1)\n$$\n$$\nN_2(\\xi) = \\frac{(\\xi + 1)(\\xi - 1/3)(\\xi - 1)}{(-1/3 + 1)(-1/3 - 1/3)(-1/3 - 1)} = \\frac{(\\xi^2 - 1)(\\xi-1/3)}{(2/3)(-2/3)(-4/3)} = \\frac{27}{16}(\\xi^3-\\frac{1}{3}\\xi^2-\\xi+\\frac{1}{3}) = \\frac{1}{16}(27\\xi^3-9\\xi^2-27\\xi+9)\n$$\n由于节点关于 $\\xi=0$ 对称分布，我们有 $N_3(\\xi) = N_2(-\\xi)$ 和 $N_4(\\xi) = N_1(-\\xi)$。\n$$\nN_3(\\xi) = N_2(-\\xi) = \\frac{1}{16}(-27\\xi^3-9\\xi^2+27\\xi+9)\n$$\n$$\nN_4(\\xi) = N_1(-\\xi) = \\frac{1}{16}(9\\xi^3+9\\xi^2-\\xi-1)\n$$\n我们需要这些形函数的导数，并在 $\\xi=0$ 处求值。\n$$\n\\left.\\frac{dN_1}{d\\xi}\\right|_{\\xi=0} = \\left.\\frac{1}{16}(-27\\xi^2+18\\xi+1)\\right|_{\\xi=0} = \\frac{1}{16}\n$$\n$$\n\\left.\\frac{dN_2}{d\\xi}\\right|_{\\xi=0} = \\left.\\frac{1}{16}(81\\xi^2-18\\xi-27)\\right|_{\\xi=0} = -\\frac{27}{16}\n$$\n$$\n\\left.\\frac{dN_3}{d\\xi}\\right|_{\\xi=0} = \\left.\\frac{1}{16}(-81\\xi^2-18\\xi+27)\\right|_{\\xi=0} = \\frac{27}{16}\n$$\n$$\n\\left.\\frac{dN_4}{d\\xi}\\right|_{\\xi=0} = \\left.\\frac{1}{16}(27\\xi^2+18\\xi-1)\\right|_{\\xi=0} = -\\frac{1}{16}\n$$\n场近似为 $u(\\xi) = \\sum_{i=1}^4 u_i N_i(\\xi)$，其关于 $\\xi$ 的导数为 $\\frac{du}{d\\xi} = \\sum_{i=1}^4 u_i \\frac{dN_i}{d\\xi}$。给定的节点值为 $\\{u_1, u_2, u_3, u_4\\} = \\{2, -1, 3, 0\\}$。对于所有三种构型，这个场近似是相同的。我们计算它在 $\\xi=0$ 处的导数：\n$$\n\\left.\\frac{du}{d\\xi}\\right|_{\\xi=0} = \\sum_{i=1}^4 u_i \\left.\\frac{dN_i}{d\\xi}\\right|_{\\xi=0} = (2)\\left(\\frac{1}{16}\\right) + (-1)\\left(-\\frac{27}{16}\\right) + (3)\\left(\\frac{27}{16}\\right) + (0)\\left(-\\frac{1}{16}\\right) = \\frac{2+27+81}{16} = \\frac{110}{16} = \\frac{55}{8}\n$$\n现在，我们为三种构型分别计算 Jacobian $J(\\xi=0)$。\n\n**1. 等参情况**\n几何使用相同的三次形函数进行插值：$x(\\xi) = \\sum_{i=1}^4 x_i N_i(\\xi)$。节点坐标为 $\\{x_1, x_2, x_3, x_4\\} = \\{0, 1, 2, 3\\}$。\n在 $\\xi=0$ 处的 Jacobian 是：\n$$\nJ_{\\text{iso}}(0) = \\left.\\frac{dx}{d\\xi}\\right|_{\\xi=0} = \\sum_{i=1}^4 x_i \\left.\\frac{dN_i}{d\\xi}\\right|_{\\xi=0} = (0)\\left(\\frac{1}{16}\\right) + (1)\\left(-\\frac{27}{16}\\right) + (2)\\left(\\frac{27}{16}\\right) + (3)\\left(-\\frac{1}{16}\\right) = \\frac{-27+54-3}{16} = \\frac{24}{16} = \\frac{3}{2}\n$$\n物理导数是：\n$$\n\\left.\\frac{du}{dx}\\right|_{\\text{iso},\\,\\xi=0} = \\frac{1}{J_{\\text{iso}}(0)} \\left.\\frac{du}{d\\xi}\\right|_{\\xi=0} = \\frac{1}{3/2} \\cdot \\frac{55}{8} = \\frac{2}{3} \\cdot \\frac{55}{8} = \\frac{55}{12}\n$$\n\n**2. 亚参情况**\n几何使用节点 $\\{-1, 0, 1\\}$ 上的二次 Lagrange 多项式进行插值。映射为 $x(\\xi) = x(-1)L_1(\\xi) + x(0)L_2(\\xi) + x(1)L_3(\\xi)$，其中 $L_1(\\xi)=\\frac{1}{2}(\\xi^2-\\xi)$，$L_2(\\xi)=1-\\xi^2$，$L_3(\\xi)=\\frac{1}{2}(\\xi^2+\\xi)$。使用物理坐标 $\\{0, 1, 4\\}$，我们得到：\n$$\nx(\\xi) = (0)L_1(\\xi) + (1)L_2(\\xi) + (4)L_3(\\xi) = (1-\\xi^2) + 4\\left(\\frac{1}{2}(\\xi^2+\\xi)\\right) = 1-\\xi^2+2\\xi^2+2\\xi = \\xi^2+2\\xi+1 = (\\xi+1)^2\n$$\nJacobian 是 $J_{\\text{sub}}(\\xi) = \\frac{dx}{d\\xi} = 2\\xi+2$。在 $\\xi=0$ 时，这个值为 $J_{\\text{sub}}(0)=2$。\n物理导数是：\n$$\n\\left.\\frac{du}{dx}\\right|_{\\text{sub},\\,\\xi=0} = \\frac{1}{J_{\\text{sub}}(0)} \\left.\\frac{du}{d\\xi}\\right|_{\\xi=0} = \\frac{1}{2} \\cdot \\frac{55}{8} = \\frac{55}{16}\n$$\n\n**3. 超参情况**\n几何是一个经过 5 个点的四次多项式 $x(\\xi) = a\\xi^4+b\\xi^3+c\\xi^2+d\\xi+e$。在 $\\xi=0$ 处的 Jacobian 是 $J_{\\text{super}}(0) = \\left.\\frac{dx}{d\\xi}\\right|_{\\xi=0} = d$。为了找到系数 $d$，我们使用给定的节点对。该映射经过 $(\\xi, x)$ 点对：$(-1, 0)$、$(-1/2, 1)$、$(0, 2)$、$(1/2, 3)$、$(1, 5)$。\n从 $(\\xi,x)=(0,2)$，我们得到 $e=2$。\n我们构造映射的奇部，$x_{\\text{odd}}(\\xi) = \\frac{x(\\xi)-x(-\\xi)}{2} = b\\xi^3+d\\xi$。\n在 $\\xi=1$ 处：$x_{\\text{odd}}(1) = \\frac{x(1)-x(-1)}{2} = \\frac{5-0}{2} = \\frac{5}{2}$。这得到 $b+d = \\frac{5}{2}$。\n在 $\\xi=1/2$ 处：$x_{\\text{odd}}(1/2) = \\frac{x(1/2)-x(-1/2)}{2} = \\frac{3-1}{2} = 1$。这得到 $b(\\frac{1}{8}) + d(\\frac{1}{2}) = 1$，即 $b+4d=8$。\n我们解这个方程组：\n$$\n\\begin{cases} b+d = 5/2 \\\\ b+4d = 8 \\end{cases}\n$$\n第二个方程减去第一个方程得到 $3d = 8 - 5/2 = 11/2$，所以 $d=11/6$。\nJacobian 是 $J_{\\text{super}}(0)=d=11/6$。\n物理导数是：\n$$\n\\left.\\frac{du}{dx}\\right|_{\\text{super},\\,\\xi=0} = \\frac{1}{J_{\\text{super}}(0)} \\left.\\frac{du}{d\\xi}\\right|_{\\xi=0} = \\frac{1}{11/6} \\cdot \\frac{55}{8} = \\frac{6}{11} \\cdot \\frac{55}{8} = \\frac{6 \\cdot 5}{8} = \\frac{30}{8} = \\frac{15}{4}\n$$\n\n**最终计算**\n最后，我们计算目标量 $S$：\n$$\nS = \\left.\\frac{du}{dx}\\right|_{\\text{iso},\\,\\xi=0} + \\left.\\frac{du}{dx}\\right|_{\\text{super},\\,\\xi=0} - 2\\,\\left.\\frac{du}{dx}\\right|_{\\text{sub},\\,\\xi=0}\n$$\n$$\nS = \\frac{55}{12} + \\frac{15}{4} - 2\\left(\\frac{55}{16}\\right) = \\frac{55}{12} + \\frac{15}{4} - \\frac{55}{8}\n$$\n$12$、$4$ 和 $8$ 的最小公倍数是 $24$。\n$$\nS = \\frac{55 \\cdot 2}{24} + \\frac{15 \\cdot 6}{24} - \\frac{55 \\cdot 3}{24} = \\frac{110 + 90 - 165}{24} = \\frac{200 - 165}{24} = \\frac{35}{24}\n$$\n计算完成。", "answer": "$$\n\\boxed{\\frac{35}{24}}\n$$", "id": "2570237"}, {"introduction": "在实际工程问题中，我们经常需要用直线或低阶曲线来近似复杂的几何边界，这便引出了亚参单元的概念。本练习将通过一个精心设计的思想实验，揭示当几何近似（线性）与场插值（二次）不匹配时所产生的“几何误差”或“一致性误差”。您将推导出即使是简单的线性位移场也无法被精确表示，这对于理解亚参单元的理论局限性和收敛性至关重要。[@problem_id:2570242]", "problem": "一个由2x2个四边形有限元组成的网格片被用来近似一个其下边界为曲线的区域。物理坐标选择如下。设曲率参数为一个固定的常数 $\\kappa \\in \\mathbb{R}$，其绝对值 $|\\kappa|$ 足够小，使得在 $x=-1$ 和 $x=1$ 之间的弧 $y=\\kappa x^{2}$ 是一条平缓的曲线。通过其 $(x,y)$ 坐标在物理平面中定义网格点：\n- 底行（待近似的曲线边界）：$(-1,\\kappa)$、$(0,0)$、$(1,\\kappa)$。\n- 中间行：$(-1,0.5)$、$(0,0.5)$、$(1,0.5)$。\n- 顶行：$(-1,1)$、$(0,1)$、$(1,1)$。\n\n这就得到了四个单元：左下单元 $E_{11}$，其角点为 $(-1,\\kappa)$、$(0,0)$、$(0,0.5)$、$(-1,0.5)$；右下单元 $E_{12}$，其角点为 $(0,0)$、$(1,\\kappa)$、$(1,0.5)$、$(0,0.5)$；以及两个类似构成的上方单元。\n\n考虑在以下精确意义上的子参数公式：\n- 每个单元中的几何映射使用由父正方形单元上的标准双线性形函数定义的四节点双线性映射，且仅使用四个单元角点，从而通过角点之间的直线弦来近似弯曲的下边界。\n- 每个单元中的位移插值使用八节点 serendipity 二次形函数（每个单元有四个角节点和四个边中节点）。按如下方式在每条边上放置边中节点：在所有非曲线边上，将边中节点放置在物理平面中边的中点处；在下方单元的两条曲线边界边上，将边中节点放置在真实弧线的中点处，即对于 $E_{11}$ 在 $(-0.5,\\kappa/4)$，对于 $E_{12}$ 在 $(0.5,\\kappa/4)$。这使得几何相对于位移场是子参数的，因为几何仅使用双线性角点插值，而位移场使用引用了位于真实曲线上的边中节点的二次插值。\n\n设精确位移场为线性函数 $u(x,y)=\\alpha+\\beta x+\\gamma y$，其中 $\\alpha,\\beta,\\gamma \\in \\mathbb{R}$ 为任意常数。对于左下单元 $E_{11}$，令 $(\\xi,\\eta)$ 表示标准父坐标，令 $(x_{g}(\\xi,\\eta),y_{g}(\\xi,\\eta))$ 表示仅使用 $E_{11}$ 四个角点的双线性几何映射，而 $u_{h}(\\xi,\\eta)$ 表示使用 $E_{11}$ 的八个节点值（四个角点加四个边中点）作为自由度的 $u$ 的 serendipity 二次插值。\n\n从等参数和子参数映射的基本定义以及 Lagrangian 形函数的插值性质出发，从第一性原理推导出在 $E_{11}$ 单元中心的插值误差\n$$\ne \\equiv u_{h}(0,0) - u\\!\\bigl(x_{g}(0,0),y_{g}(0,0)\\bigr),\n$$\n的一个精确解析表达式，用 $\\beta$、$\\gamma$ 和 $\\kappa$ 表示。你的最终答案必须是单一的闭式表达式。不需要进行数值计算。", "solution": "所述问题在科学上是合理的、自洽的且适定的。它构成了有限元方法理论中的一个有效练习。我们将着手解决它。\n\n目标是计算单元 $E_{11}$ 中心的插值误差 $e$，其定义为\n$$e \\equiv u_{h}(0,0) - u\\!\\bigl(x_{g}(0,0),y_{g}(0,0)\\bigr)$$\n其中 $(\\xi, \\eta)=(0,0)$ 代表父单元域 $[-1,1] \\times [-1,1]$ 的中心。函数 $u_{h}$ 是精确位移场 $u(x,y)$ 的有限元插值函数，而 $(x_g, y_g)$ 代表从父坐标到物理坐标的几何映射。\n\n首先，我们分析插值函数 $u_{h}(\\xi,\\eta)$ 的结构。它使用八节点 serendipity 二次形函数构建，我们将其表示为 $N_i^q(\\xi,\\eta)$，其中 $i=1, \\dots, 8$。该插值函数由下式给出\n$$u_{h}(\\xi, \\eta) = \\sum_{i=1}^{8} N_i^q(\\xi, \\eta) u_i$$\n其中 $u_i$ 是精确位移场 $u(x,y)$ 的节点值。精确场是一个线性函数 $u(x,y) = \\alpha + \\beta x + \\gamma y$。因此，节点值为 $u_i = u(x_i, y_i) = \\alpha + \\beta x_i + \\gamma y_i$，其中 $(x_i, y_i)$ 是第 $i$ 个节点的坐标。\n\n将 $u_i$ 的表达式代入 $u_h$ 的公式中：\n$$u_{h}(\\xi, \\eta) = \\sum_{i=1}^{8} N_i^q(\\xi, \\eta) (\\alpha + \\beta x_i + \\gamma y_i)$$\n根据求和的线性性质，我们可以分配求和：\n$$u_{h}(\\xi, \\eta) = \\alpha \\left(\\sum_{i=1}^{8} N_i^q(\\xi, \\eta)\\right) + \\beta \\left(\\sum_{i=1}^{8} N_i^q(\\xi, \\eta) x_i\\right) + \\gamma \\left(\\sum_{i=1}^{8} N_i^q(\\xi, \\eta) y_i\\right)$$\n有限元形函数的一个基本性质是单位分解，即对于父单元域中的所有 $(\\xi, \\eta)$，都有 $\\sum_{i=1}^{8} N_i^q(\\xi, \\eta) = 1$。表达式中的另外两个和，根据定义，是使用二次形函数得到的几何映射函数。我们把这个二次映射记为 $(x_h(\\xi, \\eta), y_h(\\xi, \\eta))$：\n$$x_h(\\xi, \\eta) = \\sum_{i=1}^{8} N_i^q(\\xi, \\eta) x_i$$\n$$y_h(\\xi, \\eta) = \\sum_{i=1}^{8} N_i^q(\\xi, \\eta) y_i$$\n这是八节点等参数单元的几何映射。根据这些定义，$u_h$ 的表达式变为：\n$$u_h(\\xi, \\eta) = \\alpha + \\beta x_h(\\xi, \\eta) + \\gamma y_h(\\xi, \\eta) = u(x_h(\\xi, \\eta), y_h(\\xi, \\eta))$$\n这证明了对于一个线性场，serendipity 二次插值函数等同于在二次映射坐标处求值的精确场。\n\n现在，我们可以重写在父单元中心 $(\\xi, \\eta) = (0,0)$ 处求值的误差表达式 $e$：\n$$e = u(x_h(0,0), y_h(0,0)) - u(x_g(0,0), y_g(0,0))$$\n代入 $u(x,y)$ 的线性形式：\n$$e = \\bigl(\\alpha + \\beta x_h(0,0) + \\gamma y_h(0,0)\\bigr) - \\bigl(\\alpha + \\beta x_g(0,0) + \\gamma y_g(0,0)\\bigr)$$\n常数 $\\alpha$ 被消去，我们剩下：\n$$e = \\beta \\bigl(x_h(0,0) - x_g(0,0)\\bigr) + \\gamma \\bigl(y_h(0,0) - y_g(0,0)\\bigr)$$\n问题简化为计算父单元中心在两种不同几何映射下的映射物理坐标之差：即双线性映射 $x_g, y_g$（为子参数几何所指定的）和二次映射 $x_h, y_h$（由位移插值隐式定义的）。\n\n我们来计算 $(x_g(0,0), y_g(0,0))$。双线性映射使用单元 $E_{11}$ 的四个角节点：\n$P_1 = (-1, \\kappa)$、 $P_2 = (0, 0)$、 $P_3 = (0, 0.5)$、 $P_4 = (-1, 0.5)$。\n在中心 $(\\xi, \\eta)=(0,0)$ 处，双线性形函数都等于 $N_j^b(0,0) = 1/4$，其中 $j=1,2,3,4$。\n$$x_g(0,0) = \\frac{1}{4} (x_1+x_2+x_3+x_4) = \\frac{1}{4}(-1 + 0 + 0 - 1) = -\\frac{1}{2}$$\n$$y_g(0,0) = \\frac{1}{4} (y_1+y_2+y_3+y_4) = \\frac{1}{4}(\\kappa + 0 + 0.5 + 0.5) = \\frac{1}{4}(1+\\kappa)$$\n\n接下来，我们计算 $(x_h(0,0), y_h(0,0))$。这个二次映射使用单元的所有八个节点。在中心 $(\\xi, \\eta)=(0,0)$ 处，serendipity 形函数 $N_i^q$ 的值为：\n对于四个角节点 ($i=1,2,3,4$)，$N_i^q(0,0) = -1/4$。\n对于四个边中节点 ($i=5,6,7,8$)，$N_i^q(0,0) = 1/2$。\n八个节点的坐标给出如下：\n角点：$P_1(-1, \\kappa)$、 $P_2(0, 0)$、 $P_3(0, 0.5)$、 $P_4(-1, 0.5)$。\n边中点：$P_5(-0.5, \\kappa/4)$、 $P_6(0, 0.25)$、 $P_7(-0.5, 0.5)$、 $P_8(-1, (0.5+\\kappa)/2)$。\n$$x_h(0,0) = \\sum_{i=1}^8 N_i^q(0,0) x_i = -\\frac{1}{4}(x_1+x_2+x_3+x_4) + \\frac{1}{2}(x_5+x_6+x_7+x_8)$$\n$$x_h(0,0) = -\\frac{1}{4}(-1+0+0-1) + \\frac{1}{2}(-0.5+0-0.5-1) = -\\frac{1}{4}(-2) + \\frac{1}{2}(-2) = \\frac{1}{2} - 1 = -\\frac{1}{2}$$\n$$y_h(0,0) = \\sum_{i=1}^8 N_i^q(0,0) y_i = -\\frac{1}{4}(y_1+y_2+y_3+y_4) + \\frac{1}{2}(y_5+y_6+y_7+y_8)$$\n$$y_h(0,0) = -\\frac{1}{4}(\\kappa+0+0.5+0.5) + \\frac{1}{2}\\left(\\frac{\\kappa}{4} + 0.25 + 0.5 + \\frac{0.5+\\kappa}{2}\\right)$$\n$$y_h(0,0) = -\\frac{1}{4}(1+\\kappa) + \\frac{1}{2}\\left(\\frac{\\kappa}{4} + 1 + \\frac{\\kappa}{2}\\right) = -\\frac{1}{4}(1+\\kappa) + \\frac{1}{2}\\left(1 + \\frac{3\\kappa}{4}\\right)$$\n$$y_h(0,0) = -\\frac{1}{4} - \\frac{\\kappa}{4} + \\frac{1}{2} + \\frac{3\\kappa}{8} = \\frac{1}{4} + \\left(-\\frac{2\\kappa}{8} + \\frac{3\\kappa}{8}\\right) = \\frac{1}{4} + \\frac{\\kappa}{8}$$\n现在我们计算坐标差：\n$$x_h(0,0) - x_g(0,0) = -\\frac{1}{2} - \\left(-\\frac{1}{2}\\right) = 0$$\n$$y_h(0,0) - y_g(0,0) = \\left(\\frac{1}{4} + \\frac{\\kappa}{8}\\right) - \\left(\\frac{1}{4}(1+\\kappa)\\right) = \\frac{1}{4} + \\frac{\\kappa}{8} - \\frac{1}{4} - \\frac{\\kappa}{4} = \\frac{\\kappa}{8} - \\frac{2\\kappa}{8} = -\\frac{\\kappa}{8}$$\n最后，我们将这些差值代回误差 $e$ 的表达式中：\n$$e = \\beta(0) + \\gamma\\left(-\\frac{\\kappa}{8}\\right) = -\\frac{\\gamma\\kappa}{8}$$\n单元中心的插值误差纯粹是由于用于单元定义的几何映射与高阶位移场为保持对线性函数的精确性而隐式要求的几何映射之间的不一致造成的。该误差与曲率参数 $\\kappa$ 以及场在 $y$ 方向的梯度 $\\gamma$ 成正比。", "answer": "$$ \\boxed{-\\frac{\\gamma\\kappa}{8}} $$", "id": "2570242"}]}