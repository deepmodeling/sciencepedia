{"hands_on_practices": [{"introduction": "在有限元方法中，对分布载荷建模的基石是将连续的物理作用（如压力或重力）转化为作用在单元节点上的离散力。这个转化过程并非随意为之，而是通过虚功原理精确推导得出，以确保能量守恒和静力等效性。本练习 [@problem_id:2580334] 将指导你完成这一基本过程，以一个常见的工程场景——内压圆柱壳——为例，从而巩固你对连续介质力学原理及有限元离散化表示之间联系的理解。", "problem": "半径为 $R$、厚度为 $t$ 的薄壁闭端直圆柱壳承受垂直于壳表面的均匀内压 $p$。假设轴对称、忽略弯曲（薄膜行为），并考虑一个标准的双节点线性轴对称薄膜有限元（有限元法，FEM），该单元代表了半径恒为 $R$、轴向长度为 $L$ 的中间面的直子午线段。单元节点位于 $z=0$（节点1）和 $z=L$（节点2），并使用全局圆柱坐标系 $(r,z)$，其中外法线方向为 $+r$ 方向。\n\n从静力平衡第一原理和表面牵引力的虚功原理出发，完成以下任务：\n\n1) 在给定压力 $p$ 下，推导圆柱壳单位长度的薄膜力合力 $N_{\\phi}$（子午向/轴向）和 $N_{\\theta}$（环向/周向）。\n\n2) 仅由作用在单元曲面上的压力场推导一致性节点载荷向量。使用单元在子午坐标系下的线性形函数和轴对称周向积分，将节点1和节点2的节点载荷表示为全局 $(r,z)$ 分量。\n\n以 $p$、$R$ 和 $L$ 的形式，将最终答案表示为一个闭合形式的单行矩阵\n$[\\,N_{\\phi},\\,N_{\\theta},\\,F_{r1},\\,F_{z1},\\,F_{r2},\\,F_{z2}\\,]$\n。不要代入数值，也不要在最终表达式中包含单位。", "solution": "所给出的问题陈述是有效的。这是一个固体力学和有限元法领域的适定问题，基于已确立的科学原理。该问题是自洽、一致的，并提供了推导所求量唯一解所需的所有必要信息。推导将按要求分两部分进行。\n\n第1部分：薄膜力合力的推导\n\n薄膜力合力是壳体中间面单位长度上的力，其大小由壳体微分段或有限段的静力平衡确定。问题指定了这是一个闭端圆柱体，这对确定子午向力至关重要。\n\n首先，我们推导环向（或周向）力合力 $N_{\\theta}$。我们考虑一个轴向长度为 $L_{seg}$ 的圆柱体段的受力体图，该段由一个通过中心轴的平面切开。内压 $p$ 沿径向向外作用。此压力作用在投影面积（一个尺寸为 $2R \\times L_{seg}$ 的矩形）上的合力，必须由作用在两个切割截面壳壁上的环向力来平衡。\n由压力产生的总力为 $F_p = p \\cdot (2R \\cdot L_{seg})$。\n来自壳壁的总抵抗力为 $F_{wall} = 2 \\cdot (N_{\\theta} \\cdot L_{seg})$，其中 $N_{\\theta}$ 是单位轴向长度的环向力。\n为了平衡：\n$$F_{wall} = F_p$$\n$$2 N_{\\theta} L_{seg} = 2 p R L_{seg}$$\n解得 $N_{\\theta}$：\n$$N_{\\theta} = pR$$\n\n接下来，我们推导子午向（或轴向）力合力 $N_{\\phi}$。对于圆柱体，子午方向对应于轴向。由于圆柱体是闭端的，内压 $p$ 在圆形端盖上施加一个力。我们考虑一个由垂直于 $z$ 轴的横向切口穿过圆柱体而创建的受力体图。作用在面积为 $\\pi R^2$ 的端盖上的压力所产生的总轴向力为 $F_{axial} = p \\cdot (\\pi R^2)$。这个力必须由子午向力合力 $N_{\\phi}$ 沿切口周长（即 $2\\pi R$）积分来平衡。\n来自壳壁的总抵抗力为 $F_{wall} = N_{\\phi} \\cdot (2\\pi R)$。\n为了轴向平衡：\n$$F_{wall} = F_{axial}$$\n$$N_{\\phi} (2\\pi R) = p(\\pi R^2)$$\n解得 $N_{\\phi}$：\n$$N_{\\phi} = \\frac{p \\pi R^2}{2\\pi R} = \\frac{pR}{2}$$\n\n第2部分：一致性节点载荷向量的推导\n\n单元的一致性节点载荷向量 $\\mathbf{F}_e$ 是从虚功原理推导出来的。由外部表面牵引力 $\\mathbf{t}$ 所做的虚功等于节点力 $\\mathbf{F}_e$ 通过虚节点位移 $\\delta\\mathbf{d}$ 所做的功。这种关系表示为：\n$$\\delta W_{ext} = \\delta\\mathbf{d}^T \\mathbf{F}_e = \\int_{\\Gamma_e} \\delta\\mathbf{u}^T \\mathbf{t} \\, d\\Gamma_e$$\n其中 $\\mathbf{u}$ 是位移场，$\\delta\\mathbf{u}$ 是虚位移场，$\\Gamma_e$ 是施加牵引力的单元表面。位移场通过形函数 $\\mathbf{N}$ 从节点位移插值得到，即 $\\mathbf{u} = \\mathbf{N}\\mathbf{d}$，因此 $\\delta\\mathbf{u} = \\mathbf{N}\\delta\\mathbf{d}$。将此代入虚功方程可得：\n$$\\delta\\mathbf{d}^T \\mathbf{F}_e = \\int_{\\Gamma_e} (\\mathbf{N}\\delta\\mathbf{d})^T \\mathbf{t} \\, d\\Gamma_e = \\delta\\mathbf{d}^T \\int_{\\Gamma_e} \\mathbf{N}^T \\mathbf{t} \\, d\\Gamma_e$$\n由此我们确定一致性节点载荷向量为：\n$$\\mathbf{F}_e = \\int_{\\Gamma_e} \\mathbf{N}^T \\mathbf{t} \\, d\\Gamma_e$$\n对于轴对称单元，表面微分 $d\\Gamma_e$ 由 $d\\Gamma_e = 2\\pi r \\, ds$ 给出，其中 $s$ 是沿单元子午线的坐标。对于给定的直圆柱单元，半径 $r$ 是常数，$r=R$，子午坐标 $s$ 是轴向坐标 $z$，因此 $ds=dz$。积分在单元的长度上进行，从 $z=0$ 到 $z=L$。\n\n内压 $p$ 垂直于内表面作用。在全局 $(r,z)$ 圆柱坐标系中，外法线方向为 $+r$ 方向，牵引力向量为 $\\mathbf{t} = \\begin{pmatrix} p \\\\ 0 \\end{pmatrix}$。\n\n该单元是一个双节点线性单元。位移分量 $u_r(z)$ 和 $u_z(z)$ 由节点1（$z=0$）的节点值 $(u_{r1}, u_{z1})$ 和节点2（$z=L$）的节点值 $(u_{r2}, u_{z2})$ 插值得到。线性形函数为：\n$$N_1(z) = 1 - \\frac{z}{L}$$\n$$N_2(z) = \\frac{z}{L}$$\n位移插值由下式给出：\n$$\\begin{pmatrix} u_r(z) \\\\ u_z(z) \\end{pmatrix} = \\begin{pmatrix} N_1(z) & 0 & N_2(z) & 0 \\\\ 0 & N_1(z) & 0 & N_2(z) \\end{pmatrix} \\begin{pmatrix} u_{r1} \\\\ u_{z1} \\\\ u_{r2} \\\\ u_{z2} \\end{pmatrix} = \\mathbf{N}(z) \\mathbf{d}$$\n节点力向量 $\\mathbf{F}_e = \\begin{pmatrix} F_{r1} & F_{z1} & F_{r2} & F_{z2} \\end{pmatrix}^T$ 则计算为：\n$$\\mathbf{F}_e = \\int_{0}^{L} \\mathbf{N}(z)^T \\mathbf{t} (2\\pi R) \\, dz$$\n$$\\mathbf{F}_e = 2\\pi R \\int_{0}^{L} \\begin{pmatrix} N_1 & 0 \\\\ 0 & N_1 \\\\ N_2 & 0 \\\\ 0 & N_2 \\end{pmatrix} \\begin{pmatrix} p \\\\ 0 \\end{pmatrix} dz = 2\\pi R p \\int_{0}^{L} \\begin{pmatrix} N_1(z) \\\\ 0 \\\\ N_2(z) \\\\ 0 \\end{pmatrix} dz$$\n我们必须计算形函数的积分：\n$$\\int_{0}^{L} N_1(z) \\, dz = \\int_{0}^{L} \\left(1 - \\frac{z}{L}\\right) dz = \\left[z - \\frac{z^2}{2L}\\right]_{0}^{L} = L - \\frac{L^2}{2L} = \\frac{L}{2}$$\n$$\\int_{0}^{L} N_2(z) \\, dz = \\int_{0}^{L} \\frac{z}{L} \\, dz = \\left[\\frac{z^2}{2L}\\right]_{0}^{L} = \\frac{L^2}{2L} = \\frac{L}{2}$$\n将这些结果代回 $\\mathbf{F}_e$ 的表达式中：\n$$\\mathbf{F}_e = 2\\pi R p \\begin{pmatrix} L/2 \\\\ 0 \\\\ L/2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\pi p R L \\\\ 0 \\\\ \\pi p R L \\\\ 0 \\end{pmatrix}$$\n因此，节点载荷向量的分量为：\n$F_{r1} = \\pi p R L$\n$F_{z1} = 0$\n$F_{r2} = \\pi p R L$\n$F_{z2} = 0$\n施加到单元上的总径向力为 $p \\cdot (2\\pi R L)$，该力被正确地分配给两个节点，每个节点承受 $\\pi p R L$。轴向节点力为零，因为曲面上的压力纯粹沿径向作用。\n\n将所有推导出的量组合成指定的单行矩阵 $[\\,N_{\\phi},\\,N_{\\theta},\\,F_{r1},\\,F_{z1},\\,F_{r2},\\,F_{z2}\\,]$，得出最终答案。\n$$N_{\\phi} = \\frac{pR}{2}$$\n$$N_{\\theta} = pR$$\n$$F_{r1} = \\pi p R L$$\n$$F_{z1} = 0$$\n$$F_{r2} = \\pi p R L$$\n$$F_{z2} = 0$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{pR}{2} & pR & \\pi p R L & 0 & \\pi p R L & 0\n\\end{pmatrix}\n}\n$$", "id": "2580334"}, {"introduction": "学习了正确的加载荷方法后，建立一套验证我们实现正确性的方法并能及时发现常见错误至关重要。一个频发的错误源于在全局和局部坐标系之间转换载荷时的不当操作。本练习 [@problem_id:2580271] 提出了一个此类错误的假设情景，通过分别计算真实物理载荷和错误施加的离散载荷所产生的合力与合力矩，你将学会一种强大的诊断技术，以确保模型中的载荷能真实地反映物理情况。", "problem": "一根长度为 $L$ 的单根平面直杆构件，使用有限元法 (FEM) 进行建模。该构件与全局x轴成 $\\theta$ 角倾斜，节点1位于全局原点，节点2的坐标为 $\\left(L\\cos\\theta,\\,L\\sin\\theta\\right)$。该构件全长上承受一个集度为常数 $q$ 的均布荷载，该荷载在全局坐标系中沿竖直向下方向（即全局-y方向）作用。无其他荷载作用。为了进行荷载验证（而非求解位移），暂时忽略支座，以便只考虑外加荷载。\n\n一位工程师错误地将此全局竖向荷载映射到构件的局部坐标系中，他假设荷载是纯局部横向的，大小为 $q$，且没有局部轴向分量。换句话说，他们对整个构件取单位长度上的局部荷载为 $\\left(q_{x}^{\\mathrm{loc}}, q_{y}^{\\mathrm{loc}}\\right)=\\left(0,\\,-q\\right)$，然后将相应的等效节点荷载组装到全局系统中。\n\n从连续体线动量和角动量守恒的第一性原理出发，推导由以下两种荷载产生的全局合力以及绕全局原点的标量平面外力矩：\n- 真实的连续分布荷载（沿倾斜构件的全局竖向荷载 $-q\\,\\mathbf{e}_y$），以及\n- 转换到全局坐标系并沿构件积分的错误映射的局部荷载 $\\left(0,-q\\right)$。\n\n使用局部和全局单位向量之间的旋转关系，其中局部基为 $\\mathbf{e}_{x}^{\\mathrm{loc}}=\\left[\\cos\\theta,\\ \\sin\\theta\\right]$ 和 $\\mathbf{e}_{y}^{\\mathrm{loc}}=\\left[-\\sin\\theta,\\ \\cos\\theta\\right]$，构件中心线由弧长 $s\\in[0,L]$ 参数化，其全局位置为 $\\mathbf{r}(s)=\\left[s\\cos\\theta,\\ s\\sin\\theta\\right]$。取绕原点的二维力矩为标量 $M_{O}=\\int \\left(x f_y - y f_x\\right)\\,ds$。\n\n将问题具体化到数值情况：$L=4\\,\\mathrm{m}$，$\\theta=30^\\circ$，$q=5\\,\\mathrm{kN/m}$。然后回答以下关于错误施加的荷载是否满足离散全局平衡的多项选择题，并说明如何设计一个诊断性测试，通过对组装后的全局节点力和力矩求和来检测任何不平衡。假设对于提供给单元子程序的任何单位长度荷载向量，均匀线荷载的组装等效节点荷载（力和节点力矩/力偶）都能精确地再现该线荷载的合力及其力矩。\n\n哪个陈述是正确的？\n\nA. 离散平衡得到满足。组装后的全局总和等于真实的连续体合力：$\\sum \\mathbf{F}=\\left(0,\\,-20\\right)\\,\\mathrm{kN}$ 并且 $\\sum M_{O}=-34.641\\,\\mathrm{kN\\cdot m}$。一个合适的测试是验证这些总和是否匹配；没有检测到不平衡。\n\nB. 离散平衡因错误的映射而被违反。组装后的全局总和为 $\\sum \\mathbf{F}=\\left(10,\\,-17.321\\right)\\,\\mathrm{kN}$ 和 $\\sum M_{O}=-40.000\\,\\mathrm{kN\\cdot m}$，相对于真实的连续体合力，产生的残差为 $\\mathbf{R}_{F}=\\left(-10.000,\\,-2.679\\right)\\,\\mathrm{kN}$ 和 $R_{M}=+5.359\\,\\mathrm{kN\\cdot m}$。一个合适的测试是：在组装后（暂时移除支座），计算绕选定原点的 $\\sum \\mathbf{F}$ 和 $\\sum\\left(\\mathbf{r}_i\\times \\mathbf{F}_i\\right)+\\sum M_i$，并与解析的连续体积分进行比较；如果残差超过容差，则标记为不平衡。\n\nC. 离散力组装正确但力矩不正确。可以发现 $\\sum \\mathbf{F}=\\left(0,\\,-20\\right)\\,\\mathrm{kN}$ 而 $\\sum M_{O}=-40.000\\,\\mathrm{kN\\cdot m}$。合适的测试是仅检查全局力矩总和，因为力的平衡是自动成立的。\n\nD. 离散力组装不正确，但巧合的是，全局力矩等于真实的连续体力矩。具体来说，$\\sum \\mathbf{F}=\\left(10,\\,-17.321\\right)\\,\\mathrm{kN}$ 但是 $\\sum M_{O}=-34.641\\,\\mathrm{kN\\cdot m}$。最好的测试是仅将 $\\sum \\mathbf{F}$ 与解析的合力进行比较；力矩检查是不必要的。", "solution": "对问题陈述进行验证。\n\n步骤 1：提取已知条件\n- 一个长度为 $L$ 的单根平面直杆构件。\n- 与全局x轴的倾角 $\\theta$。\n- 节点1位于全局原点 $(0,0)$。\n- 节点2位于 $(L\\cos\\theta, L\\sin\\theta)$。\n- 一个集度为 $q$ 的均布荷载，在全局坐标系中沿竖直向下方向（全局-y方向）作用于整个跨度。\n- 为进行分析，忽略支座。\n- 进行了错误的荷载映射：单位长度上的局部荷载被断定为 $(q_{x}^{\\mathrm{loc}}, q_{y}^{\\mathrm{loc}})=(0, -q)$。\n- 局部和全局基向量之间的关系由 $\\mathbf{e}_{x}^{\\mathrm{loc}}=[\\cos\\theta, \\sin\\theta]$ 和 $\\mathbf{e}_{y}^{\\mathrm{loc}}=[-\\sin\\theta, \\cos\\theta]$ 给出。\n- 构件中心线由弧长 $s \\in [0,L]$ 参数化为 $\\mathbf{r}(s)=[s\\cos\\theta, s\\sin\\theta]$。\n- 绕原点的力矩定义为 $M_{O}=\\int (x f_y - y f_x)\\,ds$。\n- 提供了一个假设：“对于提供给单元子程序的任何单位长度荷载向量，均匀线荷载的组装等效节点荷载（力和节点力矩/力偶）都能精确地再现该线荷载的合力及其力矩。”\n- 用于具体计算的数值：$L=4\\,\\mathrm{m}$，$\\theta=30^\\circ$，$q=5\\,\\mathrm{kN/m}$。\n\n步骤 2：使用提取的已知条件进行验证\n该问题在科学上基于连续介质力学、矢量微积分和有限元法的原理。它提出了结构分析中的一个现实错误场景——坐标系之间荷载的错误转换。该问题是适定的；它提供了执行所要求的计算和比较所需的所有必要信息、定义和关系。语言精确客观。所提供的数据是一致的且物理上是合理的。不存在科学或逻辑上的缺陷。\n\n步骤 3：结论和行动\n该问题是有效的。将推导完整的解答。\n\n首先，我们推导真实连续荷载的全局合力和力矩。\n真实的分布荷载是作用于全局负y方向的单位长度力 $\\mathbf{f}_{\\text{true}}$。\n$$\n\\mathbf{f}_{\\text{true}}(s) = q\\,(-\\mathbf{e}_y) = [0, -q]\n$$\n该荷载沿构件中心线施加，中心线由位置向量 $\\mathbf{r}(s) = [s\\cos\\theta, s\\sin\\theta]$ 参数化，$s \\in [0, L]$。\n\n合力 $\\mathbf{F}_{\\text{true}}$ 是力分布在构件长度上的积分：\n$$\n\\mathbf{F}_{\\text{true}} = \\int_{0}^{L} \\mathbf{f}_{\\text{true}}(s) \\, ds = \\int_{0}^{L} [0, -q] \\, ds = [0, -qL]\n$$\n绕全局原点的合力矩 $M_{O,\\text{true}}$ 是力矩分布的积分：\n$$\nM_{O,\\text{true}} = \\int_{0}^{L} (\\mathbf{r}(s) \\times \\mathbf{f}_{\\text{true}}(s))_z \\, ds\n$$\n使用提供的标量公式 $M_{O} = \\int (x f_y - y f_x) \\, ds$，其中 $\\mathbf{r}(s) = [x(s), y(s)] = [s\\cos\\theta, s\\sin\\theta]$ 且 $\\mathbf{f}_{\\text{true}} = [f_x, f_y] = [0, -q]$:\n$$\nM_{O,\\text{true}} = \\int_{0}^{L} ( (s\\cos\\theta)(-q) - (s\\sin\\theta)(0) ) \\, ds = -q\\cos\\theta \\int_{0}^{L} s \\, ds\n$$\n$$\nM_{O,\\text{true}} = -q\\cos\\theta \\left[ \\frac{s^2}{2} \\right]_{0}^{L} = -\\frac{qL^2}{2}\\cos\\theta\n$$\n\n接下来，我们分析工程师错误映射荷载所产生的合力。\n工程师假设局部荷载分布为 $(q_{x}^{\\mathrm{loc}}, q_{y}^{\\mathrm{loc}}) = (0, -q)$。这表示构件局部坐标系中的力分布。局部坐标系中单位长度上的力向量为 $\\mathbf{f}_{\\text{loc}} = [0, -q]$。\n为了求得全局合力，我们必须首先将此荷载表示在全局坐标系中。从局部到全局的变换由下式给出：\n$$\n\\mathbf{f}_{\\text{incorrect}}(s) = q_{x}^{\\mathrm{loc}} \\mathbf{e}_{x}^{\\mathrm{loc}} + q_{y}^{\\mathrm{loc}} \\mathbf{e}_{y}^{\\mathrm{loc}}\n$$\n代入给定的分量和基向量：\n$$\n\\mathbf{f}_{\\text{incorrect}}(s) = (0)\\mathbf{e}_{x}^{\\mathrm{loc}} + (-q)\\mathbf{e}_{y}^{\\mathrm{loc}} = -q [-\\sin\\theta, \\cos\\theta] = [q\\sin\\theta, -q\\cos\\theta]\n$$\n这是全局坐标系中错误的力分布。\n\n由这个错误分布产生的合力 $\\mathbf{F}_{\\text{incorrect}}$ 是：\n$$\n\\mathbf{F}_{\\text{incorrect}} = \\int_{0}^{L} \\mathbf{f}_{\\text{incorrect}}(s) \\, ds = \\int_{0}^{L} [q\\sin\\theta, -q\\cos\\theta] \\, ds = [qL\\sin\\theta, -qL\\cos\\theta]\n$$\n问题陈述指出，组装的等效节点荷载之和 $\\sum \\mathbf{F}$ 会再现此合力。\n由这个错误荷载产生的绕原点的合力矩 $M_{O,\\text{incorrect}}$ 是：\n使用 $\\mathbf{r}(s) = [s\\cos\\theta, s\\sin\\theta]$ 和 $\\mathbf{f}_{\\text{incorrect}} = [f_x, f_y] = [q\\sin\\theta, -q\\cos\\theta]$:\n$$\nM_{O,\\text{incorrect}} = \\int_{0}^{L} ( (s\\cos\\theta)(-q\\cos\\theta) - (s\\sin\\theta)(q\\sin\\theta) ) \\, ds\n$$\n$$\nM_{O,\\text{incorrect}} = \\int_{0}^{L} -qs (\\cos^2\\theta + \\sin^2\\theta) \\, ds = -q \\int_{0}^{L} s \\, ds\n$$\n$$\nM_{O,\\text{incorrect}} = -q \\left[ \\frac{s^2}{2} \\right]_{0}^{L} = -\\frac{qL^2}{2}\n$$\n问题陈述指出，组装的等效节点力矩之和 $\\sum M_{O}$ 会再现此合力矩。\n\n现在，我们将问题具体化到数值情况：$L=4\\,\\mathrm{m}$，$\\theta=30^\\circ$，$q=5\\,\\mathrm{kN/m}$。\n我们使用 $\\cos(30^\\circ) = \\frac{\\sqrt{3}}{2} \\approx 0.866025$ 和 $\\sin(30^\\circ) = \\frac{1}{2} = 0.5$。\n\n真实荷载的合力：\n$$\n\\mathbf{F}_{\\text{true}} = [0, -(5)(4)] = [0, -20]\\,\\mathrm{kN}\n$$\n$$\nM_{O,\\text{true}} = -\\frac{(5)(4^2)}{2}\\cos(30^\\circ) = -\\frac{80}{2} \\left(\\frac{\\sqrt{3}}{2}\\right) = -20\\sqrt{3} \\approx -34.641\\,\\mathrm{kN\\cdot m}\n$$\n这些是正确施加荷载应该产生的基准值。\n\n错误荷载的合力（其代表组装后节点荷载的总和）：\n$$\n\\sum \\mathbf{F} = \\mathbf{F}_{\\text{incorrect}} = [(5)(4)\\sin(30^\\circ), -(5)(4)\\cos(30^\\circ)] = [20(0.5), -20(0.866025)]\n$$\n$$\n\\sum \\mathbf{F} = [10, -17.3205] \\approx [10, -17.321]\\,\\mathrm{kN}\n$$\n$$\n\\sum M_{O} = M_{O,\\text{incorrect}} = -\\frac{(5)(4^2)}{2} = -\\frac{80}{2} = -40\\,\\mathrm{kN\\cdot m}\n$$\n\n误差，或称残差，是真实合力与计算合力之间的差值。通常将残差定义为 $\\text{真实值} - \\text{计算值}$。\n力残差：\n$$\n\\mathbf{R}_{F} = \\mathbf{F}_{\\text{true}} - \\mathbf{F}_{\\text{incorrect}} = [0, -20] - [10, -17.321] = [-10, -2.679]\\,\\mathrm{kN}\n$$\n力矩残差：\n$$\nR_{M} = M_{O,\\text{true}} - M_{O,\\text{incorrect}} = -34.641 - (-40.000) = +5.359\\,\\mathrm{kN\\cdot m}\n$$\n工程师的错误导致模型中施加的荷载与实际物理荷载并非静力等效。这违反了荷载表示的原则。因此，一个用于检查正确性的诊断性测试必须将组装后节点荷载的合力与真实连续荷载的合力进行比较。\n\n我们现在评估每个选项。\n\nA. 离散平衡得到满足。组装后的全局总和等于真实的连续体合力：$\\sum \\mathbf{F}=\\left(0,\\,-20\\right)\\,\\mathrm{kN}$ 和 $\\sum M_{O}=-34.641\\,\\mathrm{kN\\cdot m}$。一个合适的测试是验证这些总和是否匹配；没有检测到不平衡。\n这是**不正确的**。我的计算表明组装后的总和为 $\\sum \\mathbf{F} \\approx \\left(10,\\,-17.321\\right)\\,\\mathrm{kN}$ 和 $\\sum M_{O}=-40.000\\,\\mathrm{kN\\cdot m}$。它们不等于真实的合力。\n\nB. 离散平衡因错误的映射而被违反。组装后的全局总和为 $\\sum \\mathbf{F}=\\left(10,\\,-17.321\\right)\\,\\mathrm{kN}$ 和 $\\sum M_{O}=-40.000\\,\\mathrm{kN\\cdot m}$，相对于真实的连续体合力，产生的残差为 $\\mathbf{R}_{F}=\\left(-10.000,\\,-2.679\\right)\\,\\mathrm{kN}$ 和 $R_{M}=+5.359\\,\\mathrm{kN\\cdot m}$。一个合适的测试是：在组装后（暂时移除支座），计算绕选定原点的 $\\sum \\mathbf{F}$ 和 $\\sum\\left(\\mathbf{r}_i\\times \\mathbf{F}_i\\right)+\\sum M_i$，并与解析的连续体积分进行比较；如果残差超过容差，则标记为不平衡。\n这是**正确的**。计算出的错误荷载的组装总和与所述值相符。残差（定义为真实值减去计算值）也相符。所描述的诊断性测试正是验证施加的节点荷载与物理连续荷载之间静力等效性的正确程序。\n\nC. 离散力组装正确但力矩不正确。可以发现 $\\sum \\mathbf{F}=\\left(0,\\,-20\\right)\\,\\mathrm{kN}$ 而 $\\sum M_{O}=-40.000\\,\\mathrm{kN\\cdot m}$。合适的测试是仅检查全局力矩总和，因为力的平衡是自动成立的。\n这是**不正确的**。离散力没有正确组装。力的总和是 $\\sum \\mathbf{F} \\approx \\left(10,\\,-17.321\\right)\\,\\mathrm{kN}$，而不是 $\\left(0,\\,-20\\right)\\,\\mathrm{kN}$。\n\nD. 离散力组装不正确，但巧合的是，全局力矩等于真实的连续体力矩。具体来说，$\\sum \\mathbf{F}=\\left(10,\\,-17.321\\right)\\,\\mathrm{kN}$ 但 $\\sum M_{O}=-34.641\\,\\mathrm{kN\\cdot m}$。最好的测试是仅将 $\\sum \\mathbf{F}$ 与解析的合力进行比较；力矩检查是不必要的。\n这是**不正确的**。全局组装力矩是 $\\sum M_O = -40.000\\,\\mathrm{kN\\cdot m}$，这不等于真实的连续体力矩 $M_{O,\\text{true}} \\approx -34.641\\,\\mathrm{kN\\cdot m}$。没有巧合。力和力矩的检查都是必要的。", "answer": "$$\\boxed{B}$$", "id": "2580271"}, {"introduction": "为了全面验证一个有限元分析（FEM）程序的正确性，我们需要一个已知精确解的“黄金标准”问题。制造解方法（Method of Manufactured Solutions, MMS）为创建此类测试案例提供了一个通用框架。这项高级实践 [@problem_id:2580339] 将演示如何选择一个解析位移场，然后反向推导出产生该位移场所需的体力项和边界牵引力，用以测试从载荷施加到最终方程组求解的整个有限元实现流程。", "problem": "考虑在单位正方形域 $\\Omega = (0,1)\\times(0,1)$ 上的二维小应变线性弹性边值问题，假设为平面应变情况，材料为各向同性，其拉梅(Lamé)参数为 $\\lambda > 0$ 和 $\\mu > 0$。其强形式由域 $\\Omega$ 内的动量平衡方程 $-\\nabla\\cdot \\boldsymbol{\\sigma} = \\boldsymbol{b}$、运动学方程 $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\tfrac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\mathsf{T}}\\right)$ 以及本构律 $\\boldsymbol{\\sigma} = \\lambda\\,\\mathrm{tr}\\!\\left(\\boldsymbol{\\varepsilon}\\right)\\boldsymbol{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}$ 组成。边界 $\\partial\\Omega$ 被划分为狄利克雷(Dirichlet)部分 $\\Gamma_{D} = \\{x=0\\}\\cup\\{y=0\\}$ 和诺伊曼(Neumann)部分 $\\Gamma_{N} = \\{x=1\\}\\cup\\{y=1\\}$。\n\n使用人造解法，设精确位移场指定为\n$$\n\\boldsymbol{u}(x,y) = \\begin{pmatrix} u_{1}(x,y) \\\\ u_{2}(x,y) \\end{pmatrix}\n= \\begin{pmatrix} x^{2}y \\\\ -x y^{2} \\end{pmatrix}.\n$$\n在 $\\Gamma_{D}$ 上，施加本质边界条件 $\\boldsymbol{u} = \\boldsymbol{u}(x,y)$；在 $\\Gamma_{N}$ 上，面力 $\\boldsymbol{t}$ 满足 $\\boldsymbol{t} = \\boldsymbol{\\sigma}(\\boldsymbol{u})\\boldsymbol{n}$，其中 $\\boldsymbol{n}$ 是向外的单位法向量。\n\n任务：\n- 推导域 $\\Omega$ 内的体力场 $\\boldsymbol{b}(x,y)$ 和 $\\Gamma_{N}$ 上的面力场 $\\boldsymbol{t}(x,y)$，使得上述 $\\boldsymbol{u}(x,y)$ 成为强形式的一个精确解。\n- 定义标量\n$$\nQ \\;=\\; \\int_{0}^{1}\\!\\!\\int_{0}^{1} b_{1}(x,y)\\,dx\\,dy,\n$$\n其中 $b_{1}$ 是 $\\boldsymbol{b}$ 的第一个分量。将 $Q$ 表示为关于 $\\lambda$ 和 $\\mu$ 的闭式解析表达式。假设所有量均为无量纲；不要求单位。不要求数值四舍五入。\n- 简要概述在有限元法 (FEM) 框架下，如何使用此人造解来验证所实现的分布体力 $\\boldsymbol{b}$ 和边界面力 $\\boldsymbol{t}$ 的正确性。\n\n您最终报告的答案必须是 $Q$ 的单个闭式表达式。", "solution": "我们从无惯性项的基本线性动量平衡方程 $-\\nabla\\cdot\\boldsymbol{\\sigma} = \\boldsymbol{b}$（在 $\\Omega$ 内），以及小应变运动学方程 $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\tfrac{1}{2}(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\mathsf{T}})$ 和各向同性线弹性本构律 $\\boldsymbol{\\sigma} = \\lambda\\,\\mathrm{tr}(\\boldsymbol{\\varepsilon})\\boldsymbol{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}$ 出发。诺伊曼(Neumann)边界上的面力由 $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\boldsymbol{n}$ 给出。\n\n第一步：计算人造解的位移梯度和应变。对于 $u_{1}(x,y) = x^{2}y$ 和 $u_{2}(x,y) = -xy^{2}$，\n$$\n\\frac{\\partial u_{1}}{\\partial x} = 2xy,\\quad \\frac{\\partial u_{1}}{\\partial y} = x^{2},\\quad\n\\frac{\\partial u_{2}}{\\partial x} = -y^{2},\\quad \\frac{\\partial u_{2}}{\\partial y} = -2xy.\n$$\n因此，小应变张量的分量为\n$$\n\\varepsilon_{xx} = \\frac{\\partial u_{1}}{\\partial x} = 2xy,\\qquad\n\\varepsilon_{yy} = \\frac{\\partial u_{2}}{\\partial y} = -2xy,\\qquad\n\\varepsilon_{xy} = \\frac{1}{2}\\!\\left(\\frac{\\partial u_{1}}{\\partial y} + \\frac{\\partial u_{2}}{\\partial x}\\right) = \\frac{1}{2}\\!\\left(x^{2} - y^{2}\\right).\n$$\n迹为\n$$\n\\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\;=\\; \\varepsilon_{xx} + \\varepsilon_{yy} \\;=\\; 2xy - 2xy \\;=\\; 0.\n$$\n\n第二步：计算柯西(Cauchy)应力。使用 $\\boldsymbol{\\sigma} = \\lambda\\,\\mathrm{tr}(\\boldsymbol{\\varepsilon})\\boldsymbol{I} + 2\\mu\\,\\boldsymbol{\\varepsilon}$ 和 $\\mathrm{tr}(\\boldsymbol{\\varepsilon})=0$，\n$$\n\\sigma_{xx} = 2\\mu\\,\\varepsilon_{xx} = 4\\mu\\,xy,\\qquad\n\\sigma_{yy} = 2\\mu\\,\\varepsilon_{yy} = -4\\mu\\,xy,\\qquad\n\\sigma_{xy} = 2\\mu\\,\\varepsilon_{xy} = \\mu\\,(x^{2} - y^{2}).\n$$\n根据对称性，$\\sigma_{yx} = \\sigma_{xy}$。\n\n第三步：计算应力散度以获得体力 $\\boldsymbol{b}$。散度为 $(\\nabla\\cdot\\boldsymbol{\\sigma})_{i} = \\sum_{j}\\partial \\sigma_{ij}/\\partial x_{j}$，所以\n$$\n(\\nabla\\cdot\\boldsymbol{\\sigma})_{x} = \\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{xy}}{\\partial y}\n= \\frac{\\partial (4\\mu\\,xy)}{\\partial x} + \\frac{\\partial \\big(\\mu\\,(x^{2} - y^{2})\\big)}{\\partial y}\n= 4\\mu\\,y - 2\\mu\\,y = 2\\mu\\,y,\n$$\n$$\n(\\nabla\\cdot\\boldsymbol{\\sigma})_{y} = \\frac{\\partial \\sigma_{yx}}{\\partial x} + \\frac{\\partial \\sigma_{yy}}{\\partial y}\n= \\frac{\\partial \\big(\\mu\\,(x^{2} - y^{2})\\big)}{\\partial x} + \\frac{\\partial (-4\\mu\\,xy)}{\\partial y}\n= 2\\mu\\,x - 4\\mu\\,x = -2\\mu\\,x.\n$$\n因此，从 $-\\nabla\\cdot\\boldsymbol{\\sigma} = \\boldsymbol{b}$ 可得，\n$$\n\\boldsymbol{b}(x,y) = \\begin{pmatrix} b_{1}(x,y) \\\\ b_{2}(x,y) \\end{pmatrix}\n= \\begin{pmatrix} -2\\mu\\,y \\\\ 2\\mu\\,x \\end{pmatrix}.\n$$\n\n第四步：计算 $\\Gamma_{N}$ 上的面力。面力为 $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\boldsymbol{n}$。\n\n- 在右边界 $\\{x=1\\}$ 上，向外的单位法向量是 $\\boldsymbol{n} = (1,0)^{\\mathsf{T}}$。因此\n$$\n\\boldsymbol{t}(1,y) = \\begin{pmatrix} \\sigma_{xx}(1,y) \\\\ \\sigma_{yx}(1,y) \\end{pmatrix}\n= \\begin{pmatrix} 4\\mu\\,y \\\\ \\mu\\,(1 - y^{2}) \\end{pmatrix}.\n$$\n\n- 在上边界 $\\{y=1\\}$ 上，向外的单位法向量是 $\\boldsymbol{n} = (0,1)^{\\mathsf{T}}$。因此\n$$\n\\boldsymbol{t}(x,1) = \\begin{pmatrix} \\sigma_{xy}(x,1) \\\\ \\sigma_{yy}(x,1) \\end{pmatrix}\n= \\begin{pmatrix} \\mu\\,(x^{2} - 1) \\\\ -4\\mu\\,x \\end{pmatrix}.\n$$\n\n第五步：计算所要求的标量 $Q = \\int_{0}^{1}\\!\\!\\int_{0}^{1} b_{1}(x,y)\\,dx\\,dy$。由于 $b_{1}(x,y) = -2\\mu\\,y$，\n$$\nQ = \\int_{0}^{1}\\!\\!\\int_{0}^{1} \\big(-2\\mu\\,y\\big)\\,dx\\,dy\n= \\int_{0}^{1} \\left[\\int_{0}^{1} \\big(-2\\mu\\,y\\big)\\,dx \\right] dy\n= \\int_{0}^{1} \\big(-2\\mu\\,y\\cdot 1\\big)\\,dy\n= -2\\mu \\int_{0}^{1} y\\,dy\n= -2\\mu \\cdot \\frac{1}{2} = -\\mu.\n$$\n\n第六步：概述在有限元法 (FEM) 中使用此人造解对分布载荷和面力进行验证的程序。\n- 通过对每个单元进行体积分将体力 $\\boldsymbol{b}(x,y) = (-2\\mu\\,y,\\,2\\mu\\,x)^{\\mathsf{T}}$ 实现在单元级载荷向量中，并通过在属于 $\\{x=1\\}\\cup\\{y=1\\}$ 的边界面上进行边界积分来实现面力 $\\boldsymbol{t}$。\n- 在 $\\Gamma_{D} = \\{x=0\\}\\cup\\{y=0\\}$ 上施加本质边界条件，方法是将节点位移 $\\boldsymbol{u}$ 的值设为精确解 $\\boldsymbol{u}(x,y) = (x^{2}y,\\,-xy^{2})^{\\mathsf{T}}$。\n- 求解离散线性系统，得到有限元位移场 $\\boldsymbol{u}_{h}$。\n- 计算与精确解的误差范数，例如 $L^{2}$ 范数 $\\|\\boldsymbol{u} - \\boldsymbol{u}_{h}\\|_{L^{2}(\\Omega)}$ 和能量范数 $\\|\\boldsymbol{u} - \\boldsymbol{u}_{h}\\|_{E} = \\left(\\int_{\\Omega} (\\boldsymbol{\\varepsilon}(\\boldsymbol{u} - \\boldsymbol{u}_{h})):\\boldsymbol{C}:(\\boldsymbol{\\varepsilon}(\\boldsymbol{u} - \\boldsymbol{u}_{h}))\\,d\\Omega\\right)^{1/2}$，其中 $\\boldsymbol{C}$ 是对应于 $(\\lambda,\\mu)$ 的四阶弹性张量。\n- 进行固定多项式次数 $p$ 的 $h$ 加密，并验证预期的收敛阶：对于在形状规则的网格上的足够光滑的解，预期 $\\|\\boldsymbol{u} - \\boldsymbol{u}_{h}\\|_{L^{2}(\\Omega)} = \\mathcal{O}(h^{p+1})$ 和 $\\|\\boldsymbol{u} - \\boldsymbol{u}_{h}\\|_{E} = \\mathcal{O}(h^{p})$。偏离这些收敛阶通常表明在组装分布体力或边界面力项时存在错误。\n- 作为载荷一致性的辅助检查，评估代入精确解后弱形式的残差；它应该仅在数值积分误差的水平上。此外，通过比较 $\\int_{\\Omega}\\boldsymbol{b}\\,d\\Omega + \\int_{\\Gamma_{N}}\\boldsymbol{t}\\,ds + \\int_{\\Gamma_{D}}\\boldsymbol{r}\\,ds = \\boldsymbol{0}$ 来验证全局平衡，其中 $\\boldsymbol{r}$ 表示从有限元解中恢复的在 $\\Gamma_{D}$ 上的反作用面力。\n- 通过将 $\\int_{\\Omega_{e}} \\boldsymbol{N}^{\\mathsf{T}} \\boldsymbol{b}\\,d\\Omega$ 和 $\\int_{\\partial\\Omega_{e}\\cap\\Gamma_{N}} \\boldsymbol{N}^{\\mathsf{T}} \\boldsymbol{t}\\,ds$ 的数值积分结果与高阶参考积分进行比较，来检查逐个单元的载荷向量组装情况，其中 $\\boldsymbol{N}$ 是形函数。\n\n推导出的 $\\boldsymbol{b}$ 和 $\\boldsymbol{t}$ 保证了精确解 $\\boldsymbol{u}$ 满足强形式和边界条件；因此，在正确实现的情况下，有限元解应能再现预期的收敛行为。", "answer": "$$\\boxed{-\\mu}$$", "id": "2580339"}]}