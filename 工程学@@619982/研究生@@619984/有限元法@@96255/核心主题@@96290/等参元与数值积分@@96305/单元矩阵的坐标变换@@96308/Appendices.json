{"hands_on_practices": [{"introduction": "现实世界的工程部件常常具有弯曲的边界。此练习将演示如何将一个简单的参考方形单元映射为一个具有实际意义的曲边形状——一个极坐标扇区 [@problem_id:2550179]。你将通过对复合坐标变换（从参考坐标到极坐标，再到笛卡尔坐标）应用链式法则来推导雅可比矩阵，从而巩固对雅可比行列式 $|\\det J|$ 如何在曲边域上正确缩放面积元的理解。", "problem": "在二维问题的有限元法中，通常方便在参考正方形 $[-1,1]^2$ 上进行数值积分，并将其映射到物理平面中的弯曲区域。考虑一个从参考坐标 $(\\xi,\\eta)\\in[-1,1]^2$到物理平面中一个极坐标扇形的映射，该扇形由以下径向和角向函数定义：\n$$\nr(\\xi) = r_0 + \\frac{r_1 - r_0}{2}\\,(\\xi+1), \\qquad \\theta(\\eta) = \\theta_0 + \\frac{\\theta_1 - \\theta_0}{2}\\,(\\eta+1),\n$$\n其中 $r_0>0$, $r_1>r_0$, 且 $\\theta_1>\\theta_0$。角度以弧度为单位。物理域中一点的笛卡尔坐标 $(x,y)$ 由标准的极坐标到笛卡尔坐标转换关系给出：\n$$\nx(\\xi,\\eta) = r(\\xi)\\cos\\big(\\theta(\\eta)\\big), \\qquad y(\\xi,\\eta) = r(\\xi)\\sin\\big(\\theta(\\eta)\\big).\n$$\n从雅可比矩阵的定义（即 $(x,y)$ 关于 $(\\xi,\\eta)$ 的一阶偏导数矩阵）出发，并仅使用链式法则和弧度制下三角函数的微分法则，执行以下步骤：\n- 推导用 $r_0$, $r_1$, $\\theta_0$, $\\theta_1$, $\\xi$ 和 $\\eta$ 表示的显式映射 $(x(\\xi,\\eta),y(\\xi,\\eta))$。\n- 计算雅可比矩阵 $J(\\xi,\\eta) = \\partial(x,y)/\\partial(\\xi,\\eta)$。\n- 计算并化简其行列式的绝对值 $|\\det J(\\xi,\\eta)|$。\n\n最终答案请提供 $|\\det J(\\xi,\\eta)|$ 作为 $\\xi$ 和参数 $r_0$, $r_1$, $\\theta_0$, $\\theta_1$ 的函数的完全化简解析表达式。最终答案中不应包含任何数值近似或单位。", "solution": "在尝试求解之前，对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n给出的信息如下：\n- 参考坐标：$(\\xi, \\eta) \\in [-1, 1]^2$。\n- 从参考坐标到极坐标的映射：\n  - 径向坐标：$r(\\xi) = r_0 + \\frac{r_1 - r_0}{2}\\,(\\xi+1)$\n  - 角向坐标：$\\theta(\\eta) = \\theta_0 + \\frac{\\theta_1 - \\theta_0}{2}\\,(\\eta+1)$\n- 参数约束：$r_0 > 0$, $r_1 > r_0$, $\\theta_1 > \\theta_0$。角度以弧度为单位。\n- 从极坐标到笛卡尔坐标的映射：\n  - $x(\\xi,\\eta) = r(\\xi)\\cos\\big(\\theta(\\eta)\\big)$\n  - $y(\\xi,\\eta) = r(\\xi)\\sin\\big(\\theta(\\eta)\\big)$\n- 任务：推导 $(x, y)$ 的显式映射，计算雅可比矩阵 $J(\\xi,\\eta) = \\partial(x,y)/\\partial(\\xi,\\eta)$，并计算其行列式的化简绝对值 $|\\det J(\\xi,\\eta)|$。\n\n### 步骤2：使用提取的已知条件进行验证\n评估问题的有效性。\n- **科学依据**：该问题描述了一种等参映射，这是有限元法中将简单的参考单元转换为更复杂的物理单元的一种标准和基本技术。所涉及的数学工具——多变量微积分、雅可比行列式和坐标变换——都是非常成熟的。该问题在科学上和数学上是合理的。\n- **适定性**：该问题是适定的。所有必要的函数和参数约束（$r_0>0, r_1>r_0, \\theta_1>\\theta_0$）都已提供，以确保一个唯一的、非退化的映射和一个良定义、可计算的雅可比行列式。\n- **客观性**：该问题使用精确、无歧义的数学语言陈述，不含主观或非科学内容。\n\n### 步骤3：结论与行动\n该问题是有效的。这是一个应用数学中的适定练习，具体涉及与连续介质力学和数值方法相关的矢量微积分。将提供解答。\n\n按要求进行推导。\n\n首先，通过代入给定的 $r(\\xi)$ 和 $\\theta(\\eta)$ 表达式，获得映射 $(x(\\xi,\\eta), y(\\xi,\\eta))$ 的显式形式：\n$$\nx(\\xi,\\eta) = \\left[r_0 + \\frac{r_1 - r_0}{2}\\,(\\xi+1)\\right] \\cos\\left[\\theta_0 + \\frac{\\theta_1 - \\theta_0}{2}\\,(\\eta+1)\\right]\n$$\n$$\ny(\\xi,\\eta) = \\left[r_0 + \\frac{r_1 - r_0}{2}\\,(\\xi+1)\\right] \\sin\\left[\\theta_0 + \\frac{\\theta_1 - \\theta_0}{2}\\,(\\eta+1)\\right]\n$$\n这就构成了显式映射。\n\n接下来，我们计算雅可比矩阵 $J(\\xi,\\eta)$，其定义为：\n$$\nJ(\\xi,\\eta) = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n为计算该矩阵的元素，我们需要求 $x$ 和 $y$ 关于 $\\xi$ 和 $\\eta$ 的偏导数。我们使用链式法则。首先，我们求 $r$ 关于 $\\xi$ 的导数和 $\\theta$ 关于 $\\eta$ 的导数：\n$$\n\\frac{\\partial r}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left[r_0 + \\frac{r_1 - r_0}{2}\\,(\\xi+1)\\right] = \\frac{r_1 - r_0}{2}\n$$\n$$\n\\frac{\\partial \\theta}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left[\\theta_0 + \\frac{\\theta_1 - \\theta_0}{2}\\,(\\eta+1)\\right] = \\frac{\\theta_1 - \\theta_0}{2}\n$$\n现在我们计算雅可比矩阵的四个偏导数：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left[r(\\xi)\\cos(\\theta(\\eta))\\right] = \\frac{\\partial r}{\\partial \\xi} \\cos(\\theta(\\eta)) = \\frac{r_1 - r_0}{2} \\cos(\\theta(\\eta))\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left[r(\\xi)\\cos(\\theta(\\eta))\\right] = r(\\xi) \\left[-\\sin(\\theta(\\eta))\\right] \\frac{\\partial \\theta}{\\partial \\eta} = -r(\\xi) \\frac{\\theta_1 - \\theta_0}{2} \\sin(\\theta(\\eta))\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left[r(\\xi)\\sin(\\theta(\\eta))\\right] = \\frac{\\partial r}{\\partial \\xi} \\sin(\\theta(\\eta)) = \\frac{r_1 - r_0}{2} \\sin(\\theta(\\eta))\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left[r(\\xi)\\sin(\\theta(\\eta))\\right] = r(\\xi) \\cos(\\theta(\\eta)) \\frac{\\partial \\theta}{\\partial \\eta} = r(\\xi) \\frac{\\theta_1 - \\theta_0}{2} \\cos(\\theta(\\eta))\n$$\n将这些分量组合起来，雅可比矩阵为：\n$$\nJ(\\xi,\\eta) = \\begin{pmatrix}\n\\frac{r_1 - r_0}{2} \\cos(\\theta(\\eta)) & -r(\\xi) \\frac{\\theta_1 - \\theta_0}{2} \\sin(\\theta(\\eta)) \\\\\n\\frac{r_1 - r_0}{2} \\sin(\\theta(\\eta)) & r(\\xi) \\frac{\\theta_1 - \\theta_0}{2} \\cos(\\theta(\\eta))\n\\end{pmatrix}\n$$\n最后，我们计算 $J(\\xi,\\eta)$ 的行列式：\n$$\n\\det J(\\xi,\\eta) = \\left(\\frac{\\partial x}{\\partial \\xi}\\right)\\left(\\frac{\\partial y}{\\partial \\eta}\\right) - \\left(\\frac{\\partial x}{\\partial \\eta}\\right)\\left(\\frac{\\partial y}{\\partial \\xi}\\right)\n$$\n$$\n\\det J(\\xi,\\eta) = \\left(\\frac{r_1 - r_0}{2} \\cos(\\theta(\\eta))\\right) \\left(r(\\xi) \\frac{\\theta_1 - \\theta_0}{2} \\cos(\\theta(\\eta))\\right) - \\left(-r(\\xi) \\frac{\\theta_1 - \\theta_0}{2} \\sin(\\theta(\\eta))\\right) \\left(\\frac{r_1 - r_0}{2} \\sin(\\theta(\\eta))\\right)\n$$\n提取公因式：\n$$\n\\det J(\\xi,\\eta) = r(\\xi) \\left(\\frac{r_1 - r_0}{2}\\right) \\left(\\frac{\\theta_1 - \\theta_0}{2}\\right) \\left[\\cos^2(\\theta(\\eta)) + \\sin^2(\\theta(\\eta))\\right]\n$$\n使用基本三角恒等式 $\\cos^2(\\alpha) + \\sin^2(\\alpha) = 1$，上式可化简为：\n$$\n\\det J(\\xi,\\eta) = r(\\xi) \\frac{(r_1 - r_0)(\\theta_1 - \\theta_0)}{4}\n$$\n问题要求的是其绝对值 $|\\det J(\\xi,\\eta)|$。我们必须分析行列式的符号。\n给定的约束条件是 $r_1 > r_0$ 和 $\\theta_1 > \\theta_0$。因此，$(r_1 - r_0) > 0$ 且 $(\\theta_1 - \\theta_0) > 0$。因子 $\\frac{(r_1 - r_0)(\\theta_1 - \\theta_0)}{4}$ 是严格为正的。\n径向函数 $r(\\xi)$ 是 $\\xi$ 在 $\\xi \\in [-1, 1]$ 上的线性函数。我们检查其在区间端点处的值：\n在 $\\xi = -1$ 处，$r(-1) = r_0 + \\frac{r_1-r_0}{2}(-1+1) = r_0$。已知 $r_0 > 0$。\n在 $\\xi = 1$ 处，$r(1) = r_0 + \\frac{r_1-r_0}{2}(1+1) = r_0 + (r_1 - r_0) = r_1$。已知 $r_1 > r_0 > 0$。\n由于 $r(\\xi)$ 是 $\\xi$ 的线性函数，并且在区间 $[-1, 1]$ 的边界上为正，因此它对于所有 $\\xi \\in [-1, 1]$ 都必须为正。\n因此，在参考域中对于所有的 $(\\xi, \\eta)$，$\\det J(\\xi,\\eta)$ 都是正量的乘积，所以它严格为正。因此， $|\\det J(\\xi,\\eta)| = \\det J(\\xi,\\eta)$。\n\n为了得到最终表达式，我们代入 $r(\\xi)$ 的定义并化简：\n$$\n|\\det J(\\xi,\\eta)| = \\left[r_0 + \\frac{r_1 - r_0}{2}(\\xi+1)\\right] \\frac{(r_1 - r_0)(\\theta_1 - \\theta_0)}{4}\n$$\n为了完全化简，我们展开方括号内的项：\n$$\nr_0 + \\frac{r_1 - r_0}{2}(\\xi+1) = \\frac{2r_0 + (r_1 - r_0)\\xi + (r_1 - r_0)}{2} = \\frac{(r_1 - r_0)\\xi + r_1 + r_0}{2}\n$$\n将此代回行列式的表达式中：\n$$\n|\\det J(\\xi,\\eta)| = \\left(\\frac{(r_1 - r_0)\\xi + r_1 + r_0}{2}\\right) \\frac{(r_1 - r_0)(\\theta_1 - \\theta_0)}{4}\n$$\n$$\n|\\det J(\\xi,\\eta)| = \\frac{(r_1 - r_0)(\\theta_1 - \\theta_0)}{8} \\left((r_1 - r_0)\\xi + r_1 + r_0\\right)\n$$\n这就是雅可比行列式绝对值作为 $\\xi$ 和给定参数的函数的完全化简解析表达式。", "answer": "$$\n\\boxed{\\frac{(r_1 - r_0)(\\theta_1 - \\theta_0)}{8} \\left((r_1 - r_0)\\xi + r_1 + r_0\\right)}\n$$", "id": "2550179"}, {"introduction": "从二维扩展到三维，六面体单元是三维有限元分析的基本构件之一。本问题探讨了从一个参考立方体到一个物理六面体单元的等参映射 [@problem_id:2550229]。此练习将引导你计算三线性映射下的三维雅可比矩阵及其行列式，其关键目标是理解如何利用几何和数值积分规则的张量积结构来高效地计算单元体积上的积分。", "problem": "考虑在有限元方法（FEM）中使用的一个六面体等参数单元。该单元是通过一个三线性（三仿射）映射 $F:\\hat{K}\\to K$ 从具有参考坐标 $(\\xi,\\eta,\\zeta)$ 的参考立方体 $\\hat{K} = [-1,1]^{3}$ 得到的，其分量定义如下\n$$\nx(\\xi,\\eta,\\zeta) = s\\,\\xi\\,(1+\\alpha\\,\\eta),\\qquad y(\\xi,\\eta,\\zeta) = t\\,\\eta,\\qquad z(\\xi,\\eta,\\zeta) = u\\,\\zeta,\n$$\n其中常数 $s>0$, $t>0$, $u>0$ 且 $\\alpha\\in\\mathbb{R}$。这个映射与由单元的八个角节点定义的三线性等参数插值是一致的。\n\n你的任务是：\n\n1. 从多重积分的变量替换定理出发，推导将区域 $K$ 上的积分映射到区域 $\\hat{K}$ 上的积分的变换规则，并阐明雅可比矩阵 $J(\\xi,\\eta,\\zeta)$ 及其行列式 $\\det J(\\xi,\\eta,\\zeta)$ 的作用。\n\n2. 在 $\\hat{K}$ 上，考虑一个每个坐标方向有 $2$ 个点的高斯-勒让德张量积求积（GLQ）。解释对于此六面体单元，如何将张量积求积点和权重从 $\\hat{K}$ 映射到 $K$，并指明修改每个张量积权重的因子是什么。\n\n3. 对于上述指定的映射，利用张量积结构，推导一个在所有 $2\\times 2\\times 2$ 个求积点上高效计算 $\\lvert\\det J\\rvert$ 的过程。然后，使用 $2\\times 2\\times 2$ 的高斯-勒让德求积法则，计算单元体积\n$$\n|K| \\;=\\; \\int_{K} 1\\,\\mathrm{d}x\\,\\mathrm{d}y\\,\\mathrm{d}z,\n$$\n参数值为 $s=2$，$t=3$，$u=\\tfrac{1}{2}$ 和 $\\alpha=\\tfrac{2}{5}$。将最终数值答案四舍五入到四位有效数字，并报告结果，不带单位。", "solution": "该问题的分析始于坐标变换的基本定理，该定理构成了有限元方法中等参数单元积分的基础。该问题将按规定分为三部分进行解答。\n\n从域 $K$ 中的物理坐标 $(x,y,z)$ 到域 $\\hat{K} = [-1,1]^3$ 中的参考坐标 $(\\xi,\\eta,\\zeta)$ 的变换由映射 $F(\\xi,\\eta,\\zeta)$ 给出。多重积分的变量替换定理建立了函数 $g$ 在这些域上积分的关系。\n\n**第1部分：积分变换法则**\n\n对于定义在物理单元 $K$ 上的任意可积函数 $g$，其积分通过以下公式变换到参考单元 $\\hat{K}$ 上：\n$$\n\\int_K g(x,y,z)\\,\\mathrm{d}x\\,\\mathrm{d}y\\,\\mathrm{d}z = \\int_{\\hat{K}} g(F(\\xi,\\eta,\\zeta))\\, |\\det J(\\xi,\\eta,\\zeta)|\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\zeta.\n$$\n在此关系中，$J(\\xi,\\eta,\\zeta)$ 是映射 $F$ 的雅可比矩阵，定义为物理坐标关于参考坐标的一阶偏导数矩阵：\n$$\nJ(\\xi,\\eta,\\zeta) = \\frac{\\partial(x,y,z)}{\\partial(\\xi,\\eta,\\zeta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial x}{\\partial \\zeta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\zeta} \\\\ \\frac{\\partial z}{\\partial \\xi} & \\frac{\\partial z}{\\partial \\eta} & \\frac{\\partial z}{\\partial \\zeta} \\end{pmatrix}.\n$$\n项 $|\\det J|$ 是雅可比矩阵行列式的绝对值。它代表了微分体积元的局部比率，使得物理体积元 $\\mathrm{d}V = \\mathrm{d}x\\,\\mathrm{d}y\\,\\mathrm{d}z$ 与参考体积元 $\\mathrm{d}\\hat{V} = \\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\zeta$ 通过 $\\mathrm{d}V = |\\det J|\\,\\mathrm{d}\\hat{V}$ 相关联。\n\n对于给定的三线性映射：\n$$\nx(\\xi,\\eta,\\zeta) = s\\,\\xi\\,(1+\\alpha\\,\\eta)\n$$\n$$\ny(\\xi,\\eta,\\zeta) = t\\,\\eta\n$$\n$$\nz(\\xi,\\eta,\\zeta) = u\\,\\zeta\n$$\n我们计算所需的一阶偏导数：\n$$\n\\frac{\\partial x}{\\partial \\xi} = s(1+\\alpha\\,\\eta), \\quad \\frac{\\partial x}{\\partial \\eta} = s\\alpha\\xi, \\quad \\frac{\\partial x}{\\partial \\zeta} = 0\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = 0, \\quad \\frac{\\partial y}{\\partial \\eta} = t, \\quad \\frac{\\partial y}{\\partial \\zeta} = 0\n$$\n$$\n\\frac{\\partial z}{\\partial \\xi} = 0, \\quad \\frac{\\partial z}{\\partial \\eta} = 0, \\quad \\frac{\\partial z}{\\partial \\zeta} = u\n$$\n得到的雅可比矩阵是上三角矩阵：\n$$\nJ(\\xi,\\eta,\\zeta) = \\begin{pmatrix} s(1+\\alpha\\eta) & s\\alpha\\xi & 0 \\\\ 0 & t & 0 \\\\ 0 & 0 & u \\end{pmatrix}.\n$$\n三角矩阵的行列式是其对角线元素的乘积。因此，我们得到：\n$$\n\\det J(\\xi,\\eta,\\zeta) = [s(1+\\alpha\\eta)] \\cdot t \\cdot u = stu(1+\\alpha\\eta).\n$$\n为了使映射有效（即在单元内部可逆且保持方向），雅可比行列式必须在整个 $\\hat{K}$ 上严格为正。由于 $s,t,u > 0$，这要求对所有 $\\eta \\in [-1,1]$ 都有 $1+\\alpha\\eta > 0$，这意味着条件 $1 - |\\alpha| > 0$，即 $|\\alpha|  1$。给定的参数 $\\alpha=2/5$ 满足此标准，因此 $\\det J > 0$ 且 $|\\det J| = \\det J$。\n\n**第2部分：求积法则映射**\n\n有限元方法中的数值积分通常在参考单元上使用高斯-勒让德求积（GLQ）进行。对于每个方向 $N_p=2$ 个点的张量积法则，区间 $[-1,1]$ 上的一个一维积分近似为 $\\int_{-1}^{1} f(\\xi)\\,\\mathrm{d}\\xi \\approx \\sum_{i=1}^{2} f(\\xi_i) w_i$。对于 $N_p=2$，求积点为 $\\xi_1 = -1/\\sqrt{3}$，$\\xi_2 = 1/\\sqrt{3}$，相应的权重为 $w_1=w_2=1$。\n对于三维立方体 $\\hat{K}$，$2\\times 2\\times 2$ 的张量积法则是：\n$$\n\\int_{\\hat{K}} h(\\xi,\\eta,\\zeta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\zeta \\approx \\sum_{i=1}^{2} \\sum_{j=1}^{2} \\sum_{k=1}^{2} h(\\xi_i, \\eta_j, \\zeta_k) w_i w_j w_k.\n$$\n$\\hat{K}$ 中的 $8$ 个求积点是 $(\\xi_i, \\eta_j, \\zeta_k)$，其中每个坐标都从 $\\{-1/\\sqrt{3}, 1/\\sqrt{3}\\}$ 中选取。每个点的张量积权重为 $w_{ijk} = w_i w_j w_k = 1 \\cdot 1 \\cdot 1 = 1$。\n\n为了近似计算物理单元 $K$ 上的积分，我们将变量替换公式与求积法则结合起来：\n$$\n\\int_K g(x,y,z)\\,\\mathrm{d}V = \\int_{\\hat{K}} g(F(\\xi,\\eta,\\zeta)) |\\det J(\\xi,\\eta,\\zeta)|\\,\\mathrm{d}\\hat{V} \\approx \\sum_{i,j,k} g(F(\\xi_i, \\eta_j, \\zeta_k)) |\\det J(\\xi_i, \\eta_j, \\zeta_k)| w_{ijk}.\n$$\n物理域 $K$ 中的求积点是参考点的像，即 $P_{ijk} = F(\\xi_i, \\eta_j, \\zeta_k)$。函数 $g$ 在这些映射点处进行求值。每个点对总和的贡献是函数值、参考权重 $w_{ijk}$ 和在求积点 $(\\xi_i, \\eta_j, \\zeta_k)$ 处计算的雅可比行列式 $|\\det J|$ 的乘积。\n因此，修改每个张量积权重 $w_{ijk}$ 的因子正是局部体积比 $|\\det J(\\xi_i, \\eta_j, \\zeta_k)|$。\n\n**第3部分：高效计算与体积计算**\n\n推导出的表达式 $\\det J = stu(1+\\alpha\\eta)$ 仅依赖于参考坐标 $\\eta$。这个结构特性使得我们可以在 $8$ 个高斯-勒让德求积点上高效地计算 $|\\det J|$。这些点可以根据其 $\\eta$ 坐标分为两组，每组 $4$ 个点，$\\eta$ 坐标的取值为 $\\eta_1 = -1/\\sqrt{3}$ 和 $\\eta_2 = 1/\\sqrt{3}$。\n对于 $\\eta = \\eta_1$ 的四个点，雅可比行列式只有一个值 $|\\det J|_1 = |stu(1 - \\alpha/\\sqrt{3})|$。\n对于 $\\eta = \\eta_2$ 的四个点，雅可比行列式只有一个值 $|\\det J|_2 = |stu(1 + \\alpha/\\sqrt{3})|$。\n高效的计算过程仅包括计算这两个不同的值，并将它们分配给相应的求积点集，从而将 $8$ 次计算减少到 $2$ 次。\n\n为了计算单元体积 $|K|$，我们在域 $K$ 上对函数 $g=1$ 进行积分：\n$$\n|K| = \\int_K 1\\,\\mathrm{d}V = \\int_{\\hat{K}} |\\det J(\\xi,\\eta,\\zeta)|\\,\\mathrm{d}\\hat{V}.\n$$\n使用 $2\\times 2\\times 2$ 的高斯-勒让德求积法则，这变为：\n$$\n|K| \\approx \\sum_{i=1}^2 \\sum_{j=1}^2 \\sum_{k=1}^2 |\\det J(\\xi_i, \\eta_j, \\zeta_k)| w_i w_j w_k.\n$$\n由于权重 $w_i, w_j, w_k$ 均为 $1$ 且 $|\\det J|$ 与 $\\xi$ 和 $\\zeta$ 无关，求和可以简化。对 $i$ 和 $k$ 的求和贡献了一个因子 $2 \\times 2 = 4$。\n$$\n|K| \\approx 4 \\sum_{j=1}^2 |\\det J(\\eta_j)| = 4 \\left( |\\det J(\\eta_1)| + |\\det J(\\eta_2)| \\right).\n$$\n代入在 $\\eta_1 = -1/\\sqrt{3}$ 和 $\\eta_2 = 1/\\sqrt{3}$ 处的 $|\\det J|$ 表达式：\n$$\n|K| \\approx 4 \\left( |stu(1 - \\alpha/\\sqrt{3})| + |stu(1 + \\alpha/\\sqrt{3})| \\right).\n$$\n如前所述，对于 $\\alpha=2/5$，有 $|\\alpha|1$，所以绝对值内的项是正的。我们可以去掉绝对值符号。\n$$\n|K| \\approx 4 stu \\left( (1 - \\alpha/\\sqrt{3}) + (1 + \\alpha/\\sqrt{3}) \\right) = 4 stu (2) = 8stu.\n$$\n这个结果是精确的。$2$ 点高斯-勒让德求积法则能精确积分最高次数为 $2(2)-1=3$ 的多项式。被积函数 $ |\\det J| = stu(1+\\alpha\\eta) $ 是一个关于 $\\eta$ 的一次多项式，关于 $\\xi$ 和 $\\zeta$ 的零次多项式，因此求积得到的是精确的解析结果。\n\n最后，我们代入指定的参数值 $s=2$，$t=3$ 和 $u=1/2$：\n$$\n|K| = 8stu = 8 \\cdot (2) \\cdot (3) \\cdot \\left(\\frac{1}{2}\\right) = 8 \\cdot 3 = 24.\n$$\n题目要求将答案四舍五入到四位有效数字。精确整数 $24$ 报告为 $24.00$。", "answer": "$$\n\\boxed{24.00}\n$$", "id": "2550229"}, {"introduction": "一个有效的有限元网格要求其所有单元都具有良好的形状，但某些节点配置可能导致物理上不可能存在的“反转”单元。这个高级问题通过一个非凸四边形呈现了这种情况，以探索映射失效的后果 [@problem_id:2550222]。你将通过分析一个雅可比行列式 $\\det J$ 在单元域内变为零和负值的映射，来探究雅可比行列式的关键作用。此练习揭示了单元反转在数学上的后果，展示了它如何导致应变-位移矩阵出现奇异性，并最终破坏物理公式的有效性，从而强调了网格质量的重要性。", "problem": "考虑一个有限元法 (FEM) 中的二维线性弹性力学问题，所用单元为 $4$ 节点双线性等参四边形。设母 (参考) 坐标为 $(\\xi,\\eta)\\in[-1,1]^2$，并使用标准的双线性形函数\n$$\nN_{1}(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_{2}(\\xi,\\eta)=\\tfrac{1}{4}(1+\\xi)(1-\\eta),\\quad\nN_{3}(\\xi,\\eta)=\\tfrac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_{4}(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1+\\eta).\n$$\n通过以下公式映射到物理空间\n$$\nx(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)X_i,\\qquad\ny(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)Y_i,\n$$\n节点坐标为\n$$\n(X_1,Y_1)=(0,0),\\quad (X_2,Y_2)=(2,0),\\quad (X_3,Y_3)=(2,2),\\quad (X_4,Y_4)=\\left(\\tfrac{4}{3},-\\tfrac{2}{3}\\right).\n$$\n令 $\\mathbf{J}(\\xi,\\eta)$ 表示映射的雅可比矩阵，$\\det\\mathbf{J}(\\xi,\\eta)$ 表示其行列式。在二维平面应变各向同性线性弹性力学中，设 Lamé 参数为 $(\\lambda,\\mu)$，则本构矩阵为\n$$\n\\mathbf{C}=\n\\begin{pmatrix}\n\\lambda+2\\mu  \\lambda  0\\\\\n\\lambda  \\lambda+2\\mu  0\\\\\n0  0  \\mu\n\\end{pmatrix}.\n$$\n令 $\\mathbf{B}(\\xi,\\eta)$ 为 $3\\times 8$ 的应变-位移矩阵，它是通过链式法则、使用工程剪切应变约定，由形函数的物理梯度构建的。\n\n1. 从映射定义和坐标变换的链式法则出发，证明存在一点 $(\\xi,\\eta)=(0,0)$ 使得 $\\det\\mathbf{J}(0,0)=0$，并确定 $\\det\\mathbf{J}(\\xi,\\eta)$ 在 $(0,0)$ 邻域内的一阶展开式。根据该线性化表达式的符号结构，得出结论：该单元在 $(0,0)$ 的邻域内是反转的。\n\n2. 考虑刚度矩阵的被积函数 $\\mathbf{B}(\\xi,\\eta)^{\\mathsf{T}}\\mathbf{C}\\,\\mathbf{B}(\\xi,\\eta)\\,\\det\\mathbf{J}(\\xi,\\eta)$。关注其 $(1,1)$ 分量（对应于节点1的 $x$-位移自由度），定义标量场\n$$\nI_{11}(\\xi,\\eta)=\\left[\\mathbf{B}(\\xi,\\eta)^{\\mathsf{T}}\\mathbf{C}\\,\\mathbf{B}(\\xi,\\eta)\\,\\det\\mathbf{J}(\\xi,\\eta)\\right]_{(1,1)}.\n$$\n仅使用映射、雅可比矩阵、梯度的链式法则和线性弹性本构定律的基本定义，确定以下有限极限\n$$\nL=\\lim_{(\\xi,\\eta)\\to(0,0)}\\left(\\det\\mathbf{J}(\\xi,\\eta)\\right)\\,I_{11}(\\xi,\\eta),\n$$\n并将最终答案表示为关于 $\\lambda$ 和 $\\mu$ 的解析闭式表达式。无需进行数值计算。给出 $L$ 的最终结果，无需四舍五入。", "solution": "在尝试求解之前，需要对所述问题进行验证。\n\n**第1步：提取已知条件**\n- 单元：$4$ 节点双线性等参四边形。\n- 母坐标：$(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$。\n- 形函数：\n  $N_{1}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta)$,\n  $N_{2}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta)$,\n  $N_{3}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta)$,\n  $N_{4}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta)$。\n- 映射：$x(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)X_i$, $y(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)Y_i$。\n- 节点坐标：$(X_1,Y_1)=(0,0)$, $(X_2,Y_2)=(2,0)$, $(X_3,Y_3)=(2,2)$, $(X_4,Y_4)=(\\frac{4}{3},-\\frac{2}{3})$。\n- 雅可比矩阵：$\\mathbf{J}(\\xi,\\eta)$。\n- 材料模型：$2$D 平面应变各向同性线性弹性力学。\n- 本构矩阵：$\\mathbf{C}= \\begin{pmatrix} \\lambda+2\\mu  \\lambda  0\\\\ \\lambda  \\lambda+2\\mu  0\\\\ 0  0  \\mu \\end{pmatrix}$。\n- 应变-位移矩阵：$\\mathbf{B}(\\xi,\\eta)$，一个 $3\\times8$ 矩阵。\n- 任务1：证明 $\\det\\mathbf{J}(0,0)=0$，求 $\\det\\mathbf{J}(\\xi,\\eta)$ 在 $(0,0)$ 附近的一阶展开式，并分析单元反转。\n- 任务2：定义 $I_{11}(\\xi,\\eta)=\\left[\\mathbf{B}(\\xi,\\eta)^{\\mathsf{T}}\\mathbf{C}\\,\\mathbf{B}(\\xi,\\eta)\\,\\det\\mathbf{J}(\\xi,\\eta)\\right]_{(1,1)}$ 并求解极限 $L=\\lim_{(\\xi,\\eta)\\to(0,0)}\\left(\\det\\mathbf{J}(\\xi,\\eta)\\right)\\,I_{11}(\\xi,\\eta)$。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据，属于线性弹性有限元法的标准理论范畴。所有概念——形函数、等参映射、雅可比矩阵、本构定律和应变-位移矩阵——都是标准的。指定的节点坐标描述了一个非凸（凹）四边形，其雅可比矩阵在母域内部可能变为奇异。在数值分析中，分析此类奇异点处的行为是一个有效且重要的话题。该问题是适定的，提供了所有必要信息，其语言客观而精确。它没有违反任何无效性标准。\n\n**第3步：结论与行动**\n问题有效。将提供解答。\n\n我们首先构建从母单元到物理单元的坐标映射。\n物理空间中的 $x$ 和 $y$ 坐标由下式给出：\n$$x(\\xi,\\eta) = N_{1}(\\xi,\\eta)X_{1} + N_{2}(\\xi,\\eta)X_{2} + N_{3}(\\xi,\\eta)X_{3} + N_{4}(\\xi,\\eta)X_{4}$$\n$$y(\\xi,\\eta) = N_{1}(\\xi,\\eta)Y_{1} + N_{2}(\\xi,\\eta)Y_{2} + N_{3}(\\xi,\\eta)Y_{3} + N_{4}(\\xi,\\eta)Y_{4}$$\n代入给定的节点坐标：\n$$x(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)(2) + \\frac{1}{4}(1+\\xi)(1+\\eta)(2) + \\frac{1}{4}(1-\\xi)(1+\\eta)\\left(\\frac{4}{3}\\right)$$\n$$x(\\xi,\\eta) = \\frac{1}{2}(1+\\xi)(1-\\eta+1+\\eta) + \\frac{1}{3}(1-\\xi)(1+\\eta) = (1+\\xi) + \\frac{1}{3}(1+\\eta-\\xi-\\xi\\eta) = \\frac{4}{3}+\\frac{2}{3}\\xi+\\frac{1}{3}\\eta-\\frac{1}{3}\\xi\\eta$$\n$$y(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)(2) + \\frac{1}{4}(1-\\xi)(1+\\eta)\\left(-\\frac{2}{3}\\right)$$\n$$y(\\xi,\\eta) = \\frac{1}{2}(1+\\xi)(1+\\eta) - \\frac{1}{6}(1-\\xi)(1+\\eta) = \\frac{1}{6}(1+\\eta)(3(1+\\xi)-(1-\\xi)) = \\frac{1}{6}(1+\\eta)(2+4\\xi) = \\frac{1}{3}(1+\\eta)(1+2\\xi)$$\n$$y(\\xi,\\eta) = \\frac{1}{3}(1+2\\xi+\\eta+2\\xi\\eta) = \\frac{1}{3} + \\frac{2}{3}\\xi + \\frac{1}{3}\\eta + \\frac{2}{3}\\xi\\eta$$\n变换的雅可比矩阵为 $\\mathbf{J}(\\xi,\\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}$。我们计算偏导数：\n$$\\frac{\\partial x}{\\partial \\xi} = \\frac{2}{3}-\\frac{1}{3}\\eta, \\quad \\frac{\\partial x}{\\partial \\eta} = \\frac{1}{3}-\\frac{1}{3}\\xi$$\n$$\\frac{\\partial y}{\\partial \\xi} = \\frac{2}{3}+\\frac{2}{3}\\eta, \\quad \\frac{\\partial y}{\\partial \\eta} = \\frac{1}{3}+\\frac{2}{3}\\xi$$\n因此，雅可比矩阵为：\n$$\\mathbf{J}(\\xi,\\eta) = \\begin{pmatrix} \\frac{2}{3}-\\frac{1}{3}\\eta  \\frac{1}{3}-\\frac{1}{3}\\xi \\\\ \\frac{2}{3}+\\frac{2}{3}\\eta  \\frac{1}{3}+\\frac{2}{3}\\xi \\end{pmatrix}$$\n雅可比矩阵的行列式为：\n$$\\det\\mathbf{J}(\\xi,\\eta) = \\left(\\frac{2}{3}-\\frac{1}{3}\\eta\\right)\\left(\\frac{1}{3}+\\frac{2}{3}\\xi\\right) - \\left(\\frac{1}{3}-\\frac{1}{3}\\xi\\right)\\left(\\frac{2}{3}+\\frac{2}{3}\\eta\\right)$$\n$$\\det\\mathbf{J}(\\xi,\\eta) = \\frac{1}{9} \\left[ (2-\\eta)(1+2\\xi) - (1-\\xi)(2+2\\eta) \\right]$$\n$$\\det\\mathbf{J}(\\xi,\\eta) = \\frac{1}{9} \\left[ (2+4\\xi-\\eta-2\\xi\\eta) - (2+2\\eta-2\\xi-2\\xi\\eta) \\right]$$\n$$\\det\\mathbf{J}(\\xi,\\eta) = \\frac{1}{9} (6\\xi - 3\\eta) = \\frac{2}{3}\\xi - \\frac{1}{3}\\eta$$\n这就完成了任务1的第一部分。在母单元的中心点 $(\\xi,\\eta)=(0,0)$，行列式为 $\\det\\mathbf{J}(0,0) = \\frac{2}{3}(0) - \\frac{1}{3}(0) = 0$。$\\det\\mathbf{J}(\\xi,\\eta)$ 的表达式已经是关于 $\\xi$ 和 $\\eta$ 的线性函数，因此它本身就是其在 $(0,0)$ 点的一阶展开。对于 $(0,0)$ 的任何邻域，都存在使得 $\\det\\mathbf{J}(\\xi,\\eta)  0$ 的点（例如，在 $\\eta$ 轴正半轴上，$\\xi=0, \\eta0$）和使得 $\\det\\mathbf{J}(\\xi,\\eta)  0$ 的点（例如，在 $\\xi$ 轴正半轴上，$\\eta=0, \\xi0$）。负的雅可比行列式意味着映射的局部反转，即单元发生了自身折叠。因此，在 $(0,0)$ 的任何邻域的某些部分，该单元是反转的。\n\n对于任务2，我们必须计算极限 $L=\\lim_{(\\xi,\\eta)\\to(0,0)}\\left(\\det\\mathbf{J}(\\xi,\\eta)\\right)\\,I_{11}(\\xi,\\eta)$。\n代入 $I_{11}(\\xi,\\eta)$ 的定义：\n$$L = \\lim_{(\\xi,\\eta)\\to(0,0)} (\\det\\mathbf{J}) \\left( \\left[\\mathbf{B}^{\\mathsf{T}}\\mathbf{C}\\,\\mathbf{B}\\right]_{(1,1)} \\det\\mathbf{J} \\right) = \\lim_{(\\xi,\\eta)\\to(0,0)} (\\det\\mathbf{J})^{2} \\left[\\mathbf{B}^{\\mathsf{T}}\\mathbf{C}\\,\\mathbf{B}\\right]_{(1,1)}$$\n项 $\\left[\\mathbf{B}^{\\mathsf{T}}\\mathbf{C}\\,\\mathbf{B}\\right]_{(1,1)}$ 对应于自由度 $u_{1}$（节点1的 $x$-位移）。它由 $\\mathbf{b}_{u1}^{\\mathsf{T}} \\mathbf{C} \\mathbf{b}_{u1}$ 给出，其中 $\\mathbf{b}_{u1}$ 是矩阵 $\\mathbf{B}$ 的第一列。\n$$\\mathbf{b}_{u1} = \\begin{pmatrix} \\frac{\\partial N_1}{\\partial x} \\\\ 0 \\\\ \\frac{\\partial N_1}{\\partial y} \\end{pmatrix}$$\n其乘积为：\n$$\\left[\\mathbf{B}^{\\mathsf{T}}\\mathbf{C}\\,\\mathbf{B}\\right]_{(1,1)} = \\begin{pmatrix} \\frac{\\partial N_1}{\\partial x}  0  \\frac{\\partial N_1}{\\partial y} \\end{pmatrix} \\begin{pmatrix} \\lambda+2\\mu  \\lambda  0\\\\ \\lambda  \\lambda+2\\mu  0\\\\ 0  0  \\mu \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial N_1}{\\partial x} \\\\ 0 \\\\ \\frac{\\partial N_1}{\\partial y} \\end{pmatrix} = (\\lambda+2\\mu)\\left(\\frac{\\partial N_1}{\\partial x}\\right)^2 + \\mu\\left(\\frac{\\partial N_1}{\\partial y}\\right)^2$$\n物理导数 $\\frac{\\partial N_1}{\\partial x}$ 和 $\\frac{\\partial N_1}{\\partial y}$ 通过链式法则求得：\n$$ \\begin{pmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{pmatrix} = (\\mathbf{J}^{\\mathsf{T}})^{-1} \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{pmatrix} = \\frac{1}{\\det\\mathbf{J}} \\begin{pmatrix} \\frac{\\partial y}{\\partial \\eta}  -\\frac{\\partial y}{\\partial \\xi} \\\\ -\\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial x}{\\partial \\xi} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{pmatrix} $$\n将此应用于 $N_{1}(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$:\n$$\\frac{\\partial N_1}{\\partial \\xi} = \\frac{1}{4}(-1+\\eta), \\quad \\frac{\\partial N_1}{\\partial \\eta} = \\frac{1}{4}(-1+\\xi)$$\n因此，\n$$\\frac{\\partial N_1}{\\partial x} = \\frac{1}{\\det\\mathbf{J}} \\left( \\frac{\\partial y}{\\partial \\eta}\\frac{\\partial N_1}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi}\\frac{\\partial N_1}{\\partial \\eta} \\right)$$\n$$\\frac{\\partial N_1}{\\partial y} = \\frac{1}{\\det\\mathbf{J}} \\left( -\\frac{\\partial x}{\\partial \\eta}\\frac{\\partial N_1}{\\partial \\xi} + \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial N_1}{\\partial \\eta} \\right)$$\n将这些代入 $L$ 的表达式中：\n$$L = \\lim_{(\\xi,\\eta)\\to(0,0)} (\\det\\mathbf{J})^{2} \\left[ (\\lambda+2\\mu)\\frac{1}{(\\det\\mathbf{J})^2} \\left( \\frac{\\partial y}{\\partial \\eta}\\frac{\\partial N_1}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi}\\frac{\\partial N_1}{\\partial \\eta} \\right)^2 + \\mu\\frac{1}{(\\det\\mathbf{J})^2} \\left( -\\frac{\\partial x}{\\partial \\eta}\\frac{\\partial N_1}{\\partial \\xi} + \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial N_1}{\\partial \\eta} \\right)^2 \\right]$$\n$(\\det\\mathbf{J})^2$ 项相互抵消。所得连续函数的极限即为其在 $(\\xi,\\eta)=(0,0)$ 处的值。\n$$L = (\\lambda+2\\mu) \\left( \\frac{\\partial y}{\\partial \\eta}\\frac{\\partial N_1}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi}\\frac{\\partial N_1}{\\partial \\eta} \\right)^2_ {(0,0)} + \\mu \\left( -\\frac{\\partial x}{\\partial \\eta}\\frac{\\partial N_1}{\\partial \\xi} + \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial N_1}{\\partial \\eta} \\right)^2_ {(0,0)}$$\n我们计算所有项在 $(\\xi,\\eta)=(0,0)$ 处的值：\n$$\\frac{\\partial x}{\\partial \\xi}\\Big|_{(0,0)} = \\frac{2}{3}, \\quad \\frac{\\partial x}{\\partial \\eta}\\Big|_{(0,0)} = \\frac{1}{3}$$\n$$\\frac{\\partial y}{\\partial \\xi}\\Big|_{(0,0)} = \\frac{2}{3}, \\quad \\frac{\\partial y}{\\partial \\eta}\\Big|_{(0,0)} = \\frac{1}{3}$$\n$$\\frac{\\partial N_1}{\\partial \\xi}\\Big|_{(0,0)} = -\\frac{1}{4}, \\quad \\frac{\\partial N_1}{\\partial \\eta}\\Big|_{(0,0)} = -\\frac{1}{4}$$\n令 $A = \\frac{\\partial y}{\\partial \\eta}\\frac{\\partial N_1}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi}\\frac{\\partial N_1}{\\partial \\eta}$ 且 $B = -\\frac{\\partial x}{\\partial \\eta}\\frac{\\partial N_1}{\\partial \\xi} + \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial N_1}{\\partial \\eta}$。\n$$A\\Big|_{(0,0)} = \\left(\\frac{1}{3}\\right)\\left(-\\frac{1}{4}\\right) - \\left(\\frac{2}{3}\\right)\\left(-\\frac{1}{4}\\right) = -\\frac{1}{12} + \\frac{2}{12} = \\frac{1}{12}$$\n$$B\\Big|_{(0,0)} = -\\left(\\frac{1}{3}\\right)\\left(-\\frac{1}{4}\\right) + \\left(\\frac{2}{3}\\right)\\left(-\\frac{1}{4}\\right) = \\frac{1}{12} - \\frac{2}{12} = -\\frac{1}{12}$$\n将这些值代回 $L$ 的表达式中：\n$$L = (\\lambda+2\\mu)\\left(\\frac{1}{12}\\right)^2 + \\mu\\left(-\\frac{1}{12}\\right)^2 = \\frac{\\lambda+2\\mu}{144} + \\frac{\\mu}{144} = \\frac{\\lambda+3\\mu}{144}$$\n这就是所求的有限极限。", "answer": "$$\n\\boxed{\\frac{\\lambda+3\\mu}{144}}\n$$", "id": "2550222"}]}