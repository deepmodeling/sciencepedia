{"hands_on_practices": [{"introduction": "本次实践将从最简单的一维线性单元入手，旨在揭示雅可比行列式的核心几何意义。通过推导一个从参考坐标 $\\xi \\in [-1, 1]$ 到物理坐标 $x$ 的简单映射，你将亲手验证雅可比行列式如何量化了两个空间之间的尺度缩放关系，以及它的符号如何决定了单元的方向。这个基础练习是理解更复杂的多维单元中雅可比矩阵作用的基石 [@problem_id:2571710]。", "problem": "考虑一个标准的一维等参有限元，它通过插值 $x(\\xi) = N_{1}(\\xi)\\,X_{1} + N_{2}(\\xi)\\,X_{2}$ 将参考坐标 $\\xi \\in [-1,1]$ 映射到物理坐标 $x$，其中 $X_{1}$ 和 $X_{2}$ 是两个物理节点的坐标。形函数 $N_{1}(\\xi)$ 和 $N_{2}(\\xi)$ 是在 $[-1,1]$ 上分别与节点 $\\xi=-1$ 和 $\\xi=1$ 相关联的一阶 Lagrange 多项式，因此满足插值条件 $N_{1}(-1)=1$、$N_{1}(1)=0$、$N_{2}(-1)=0$ 和 $N_{2}(1)=1$。你可以仅假设形函数的线性及这些节点插值条件作为出发点。\n\n使用一维映射的雅可比行列式定义 $J(\\xi) = \\dfrac{dx}{d\\xi}$，用 $X_{1}$ 和 $X_{2}$ 的符号形式推导出 $J(\\xi)$。然后，从基本原理出发论证 $J(\\xi)$ 是否为关于 $\\xi$ 的常数，并将其值与有向单元长度 $L = X_{2} - X_{1}$ 以及绝对单元长度 $\\ell = |X_{2}-X_{1}|$ 联系起来。简要解释 $J$ 的符号和大小对于映射质量和单元方向意味着什么。\n\n请将 $J(\\xi)$ 的最终答案以 $X_{1}$ 和 $X_{2}$ 的单个闭式表达式形式给出。本问题不要求数值舍入，也不涉及物理单位。", "solution": "在尝试任何解答之前，需要对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n-   从参考坐标 $\\xi$到物理坐标 $x$ 的映射由等参插值给出：$x(\\xi) = N_{1}(\\xi)\\,X_{1} + N_{2}(\\xi)\\,X_{2}$。\n-   参考坐标域为 $\\xi \\in [-1,1]$。\n-   物理节点坐标为 $X_{1}$ 和 $X_{2}$。\n-   形函数 $N_{1}(\\xi)$ 和 $N_{2}(\\xi)$ 是一阶 Lagrange 多项式。\n-   形函数被假定为线性的。\n-   节点插值条件为：$N_{1}(-1)=1$，$N_{1}(1)=0$，$N_{2}(-1)=0$ 和 $N_{2}(1)=1$。\n-   一维雅可比行列式定义为 $J(\\xi) = \\frac{dx}{d\\xi}$。\n-   有向单元长度定义为 $L = X_{2} - X_{1}$。\n-   绝对单元长度定义为 $\\ell = |X_{2}-X_{1}|$。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据**：该问题牢固地植根于有限元法（FEM）的理论基础。等参映射、线性 Lagrange 形函数以及雅可比的定义是连续介质力学和数值分析中的标准基本概念。\n-   **适定性**：该问题是适定的。线性假设和给定的节点条件足以唯一确定形函数，从而可以唯一确定雅可比。\n-   **客观性**：该问题使用精确、客观且无歧义的数学语言进行陈述。\n-   **完备性与一致性**：所提供的信息对于推导既是必要的也是充分的。不存在矛盾。线性假设与一阶 Lagrange 多项式的性质是一致的。\n\n**步骤3：结论与行动**\n该问题在科学上是合理的、适定的且自洽的。这是有限元法中一个具有基础重要性的有效问题。将提供解答。\n\n**解的推导**\n任务是为指定的一维线性单元推导雅可比行列式 $J(\\xi)$。该过程从根据第一性原理明确推导形函数 $N_{1}(\\xi)$ 和 $N_{2}(\\xi)$ 开始。\n\n鉴于形函数是线性的，它们可以表示为一般形式 $N(\\xi) = a\\xi + b$，其中 $a$ 和 $b$ 是常数。\n\n对于第一个形函数 $N_{1}(\\xi)$，我们应用给定的节点条件：\n1.  $N_{1}(-1) = a_{1}(-1) + b_{1} = 1$\n2.  $N_{1}(1) = a_{1}(1) + b_{1} = 0$\n\n这就构成了一个关于系数 $a_{1}$ 和 $b_{1}$ 的二元一次方程组：\n$$\n\\begin{cases}\n-a_{1} + b_{1} = 1 \\\\\na_{1} + b_{1} = 0\n\\end{cases}\n$$\n将两个方程相加得到 $2b_{1} = 1$，由此我们求得 $b_{1} = \\frac{1}{2}$。将此值代入第二个方程得到 $a_{1} + \\frac{1}{2} = 0$，解得 $a_{1} = -\\frac{1}{2}$。\n因此，第一个形函数是：\n$$\nN_{1}(\\xi) = -\\frac{1}{2}\\xi + \\frac{1}{2} = \\frac{1}{2}(1 - \\xi)\n$$\n\n对于第二个形函数 $N_{2}(\\xi)$，我们应用其相应的节点条件：\n1.  $N_{2}(-1) = a_{2}(-1) + b_{2} = 0$\n2.  $N_{2}(1) = a_{2}(1) + b_{2} = 1$\n\n这给出了方程组：\n$$\n\\begin{cases}\n-a_{2} + b_{2} = 0 \\\\\na_{2} + b_{2} = 1\n\\end{cases}\n$$\n将这些方程相加得到 $2b_{2} = 1$，所以 $b_{2} = \\frac{1}{2}$。将此值代入第二个方程得到 $a_{2} + \\frac{1}{2} = 1$，由此我们求得 $a_{2} = \\frac{1}{2}$。\n因此，第二个形函数是：\n$$\nN_{2}(\\xi) = \\frac{1}{2}\\xi + \\frac{1}{2} = \\frac{1}{2}(1 + \\xi)\n$$\n\n现在，我们计算雅可比行列式 $J(\\xi) = \\frac{dx}{d\\xi}$。映射由 $x(\\xi) = N_{1}(\\xi)X_{1} + N_{2}(\\xi)X_{2}$ 给出。由于 $X_{1}$ 和 $X_{2}$ 是常数节点坐标，微分仅对 $\\xi$ 进行：\n$$\nJ(\\xi) = \\frac{d}{d\\xi}\\left(N_{1}(\\xi)X_{1} + N_{2}(\\xi)X_{2}\\right) = \\frac{dN_{1}}{d\\xi}X_{1} + \\frac{dN_{2}}{d\\xi}X_{2}\n$$\n我们计算形函数的导数：\n$$\n\\frac{dN_{1}}{d\\xi} = \\frac{d}{d\\xi}\\left(\\frac{1}{2}(1 - \\xi)\\right) = -\\frac{1}{2}\n$$\n$$\n\\frac{dN_{2}}{d\\xi} = \\frac{d}{d\\xi}\\left(\\frac{1}{2}(1 + \\xi)\\right) = \\frac{1}{2}\n$$\n将这些常数导数代入 $J(\\xi)$ 的表达式中：\n$$\nJ(\\xi) = \\left(-\\frac{1}{2}\\right)X_{1} + \\left(\\frac{1}{2}\\right)X_{2} = \\frac{1}{2}(X_{2} - X_{1})\n$$\n\n**雅可比分析**\n从推导出的表达式中，我们可以得出几个观察结论。\n\n首先，雅可比 $J(\\xi)$ 与参考坐标 $\\xi$ 无关。对于整个单元，它是一个常数。这是用于等参映射的形函数具有线性的直接结果。\n\n其次，我们将 $J$ 与有向单元长度 $L = X_{2} - X_{1}$ 和绝对单元长度 $\\ell = |X_{2} - X_{1}|$ 联系起来。\n从我们的结果可以立即看出：\n$$\nJ = \\frac{L}{2}\n$$\n雅可比行列式是单元有向长度的一半。\n因此，雅可比的绝对值为：\n$$\n|J| = \\left|\\frac{L}{2}\\right| = \\frac{|L|}{2} = \\frac{|X_{2} - X_{1}|}{2} = \\frac{\\ell}{2}\n$$\n\n第三，雅可比的符号和大小携带了关于映射质量的关键信息。\n-   **$J$ 的符号**：符号决定了映射的方向。\n    -   如果 $J > 0$，则 $X_{2} > X_{1}$。映射保持方向不变；当 $\\xi$ 从 $-1$ 增加到 $1$ 时，物理坐标 $x$ 从 $X_{1}$ 增加到 $X_{2}$。这代表一个有效的、非反转的单元。\n    -   如果 $J < 0$，则 $X_{2} < X_{1}$。映射反转方向；当 $\\xi$ 增加时，$x$ 减小。节点的编号顺序与物理坐标系的方向相反。这是一个反转单元。尽管在数学上是可能的，但这会在数值计算中引起严重问题，尤其是在组装全局矩阵时。\n    -   如果 $J = 0$，则 $X_{2} = X_{1}$。两个节点重合，意味着单元长度为零。该映射将整个参考域 $[-1, 1]$ 坍缩到一个单点。这是一个退化映射，是奇异且不可逆的。对于任何有限元分析，$J=0$ 的单元都是无效的。\n\n-   **$J$ 的大小**：大小 $|J| = \\frac{\\ell}{2}$ 是一个微分缩放因子，它关联了参考域中的长度与物理域中的长度。其关系为 $dx = J d\\xi$。参考单元的总长度为 $1 - (-1) = 2$。物理单元的总长度为 $\\ell$。这些长度的比值为 $\\frac{\\ell}{2}$，这恰好是 $|J|$。当将物理单元域上的积分转换为参考单元域上的积分时，这个常数缩放因子用于数值积分：$\\int_{X_{1}}^{X_{2}} f(x) dx = \\int_{-1}^{1} f(x(\\xi)) J d\\xi$。", "answer": "$$\n\\boxed{\\frac{1}{2}\\left(X_{2} - X_{1}\\right)}\n$$", "id": "2571710"}, {"introduction": "在掌握了一维情形后，我们将进入更贴近实际应用的二维双线性四边形单元。与一维线性单元的常数雅可比不同，二维单元的雅可比行列式 $\\det J$ 通常是随参考坐标 $(\\xi, \\eta)$ 变化的。本练习将引导你推导一个通用四边形单元的 $\\det J$ 表达式，并分析其变化的规律，从而深刻理解物理单元的几何扭曲是如何通过雅可比行列式的空间变化来体现的 [@problem_id:2571760]。", "problem": "考虑一个定义在参考正方形 $[-1,1] \\times [-1,1]$ 上的二维等参双线性四边形单元，其局部坐标为 $(\\xi,\\eta)$，物理坐标为 $(x,y)$。四个角节点位于\n$$(x_1,y_1) = (0,0), \\quad (x_2,y_2) = (3,0.5), \\quad (x_3,y_3) = (2.5,2.0), \\quad (x_4,y_4) = (-0.2,1.5)$$\n设标准双线性形函数为\n$$N_1(\\xi,\\eta) = \\frac{(1-\\xi)(1-\\eta)}{4}, \\quad N_2(\\xi,\\eta) = \\frac{(1+\\xi)(1-\\eta)}{4}, \\quad N_3(\\xi,\\eta) = \\frac{(1+\\xi)(1+\\eta)}{4}, \\quad N_4(\\xi,\\eta) = \\frac{(1-\\xi)(1+\\eta)}{4}$$\n等参映射定义为\n$$x(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,x_i, \\qquad y(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,y_i$$\n从这些定义出发，并且不使用任何预先组合好的雅可比表达式，完成以下任务：\n\n1) 推导该映射的雅可比矩阵 $J(\\xi,\\eta)$，其中 $J(\\xi,\\eta)$ 的元素为 $\\partial x/\\partial \\xi$、$\\partial x/\\partial \\eta$、$\\partial y/\\partial \\xi$ 和 $\\partial y/\\partial \\eta$。然后以闭合形式计算 $\\det J(\\xi,\\eta)$。\n\n2) 仅利用标准双线性形函数的结构特性和等参定义，确定对于任意双线性四边形映射，$\\det J(\\xi,\\eta)$ 关于 $(\\xi, \\eta)$ 的一般多项式次数。找出使 $\\det J(\\xi,\\eta)$ 在整个单元上为常数的节点坐标所满足的充分必要条件。解释对于双线性四边形映射，是否会出现真正的二次相关性（即，涉及 $\\xi$ 和 $\\eta$ 的乘积）。\n\n3) 对于上面给定的节点坐标，将第1部分的结果简化为 $\\det J(\\xi,\\eta)$ 的显式解析表达式。\n\n将你的最终答案报告为给定单元 $\\det J(\\xi,\\eta)$ 的精确解析表达式。本问题中不需要四舍五入，$\\det J$ 也没有单位。", "solution": "我们从等参定义和标准双线性形函数开始。根据定义，\n$$x(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,x_i, \\qquad y(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,y_i$$\n雅可比矩阵是\n$$J(\\xi,\\eta) = \\begin{pmatrix}\n\\displaystyle \\frac{\\partial x}{\\partial \\xi} & \\displaystyle \\frac{\\partial x}{\\partial \\eta} \\\\\n\\displaystyle \\frac{\\partial y}{\\partial \\xi} & \\displaystyle \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix}, \\qquad \\det J = \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial x}{\\partial \\eta}\\frac{\\partial y}{\\partial \\xi}$$\n\n基本基础：对于四节点双线性形函数，\n$$N_1(\\xi,\\eta) = \\frac{(1-\\xi)(1-\\eta)}{4}, \\quad N_2(\\xi,\\eta) = \\frac{(1+\\xi)(1-\\eta)}{4}, \\quad N_3(\\xi,\\eta) = \\frac{(1+\\xi)(1+\\eta)}{4}, \\quad N_4(\\xi,\\eta) = \\frac{(1-\\xi)(1+\\eta)}{4},$$\n我们计算它们的偏导数。使用乘法法则和常数，\n$$\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1-\\eta}{4}, \\quad \\frac{\\partial N_2}{\\partial \\xi} = \\frac{1-\\eta}{4}, \\quad \\frac{\\partial N_3}{\\partial \\xi} = \\frac{1+\\eta}{4}, \\quad \\frac{\\partial N_4}{\\partial \\xi} = -\\frac{1+\\eta}{4},$$\n$$\\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1-\\xi}{4}, \\quad \\frac{\\partial N_2}{\\partial \\eta} = -\\frac{1+\\xi}{4}, \\quad \\frac{\\partial N_3}{\\partial \\eta} = \\frac{1+\\xi}{4}, \\quad \\frac{\\partial N_4}{\\partial \\eta} = \\frac{1-\\xi}{4}$$\n\n因此，\n$$\\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi}\\,x_i, \\qquad \\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta}\\,x_i,$$\n$$\\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi}\\,y_i, \\qquad \\frac{\\partial y}{\\partial \\eta} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta}\\,y_i.$$\n\n将双线性映射重写为分组形式会很方便\n$$x(\\xi,\\eta) = \\frac{1}{4}\\Big[(x_1+x_2+x_3+x_4) + \\xi(-x_1+x_2+x_3-x_4) + \\eta(-x_1-x_2+x_3+x_4) + \\xi\\eta(x_1-x_2+x_3-x_4)\\Big],$$\n$$y(\\xi,\\eta) = \\frac{1}{4}\\Big[(y_1+y_2+y_3+y_4) + \\xi(-y_1+y_2+y_3-y_4) + \\eta(-y_1-y_2+y_3+y_4) + \\xi\\eta(y_1-y_2+y_3-y_4)\\Big],$$\n这可以通过展开 $N_i(\\xi,\\eta)$ 的定义并按 $\\xi$ 和 $\\eta$ 的幂次分组直接得到。求导可得\n$$\\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4}\\Big[(-x_1+x_2+x_3-x_4) + \\eta(x_1-x_2+x_3-x_4)\\Big],$$\n$$\\frac{\\partial x}{\\partial \\eta} = \\frac{1}{4}\\Big[(-x_1-x_2+x_3+x_4) + \\xi(x_1-x_2+x_3-x_4)\\Big],$$\n$$\\frac{\\partial y}{\\partial \\xi} = \\frac{1}{4}\\Big[(-y_1+y_2+y_3-y_4) + \\eta(y_1-y_2+y_3-y_4)\\Big],$$\n$$\\frac{\\partial y}{\\partial \\eta} = \\frac{1}{4}\\Big[(-y_1-y_2+y_3+y_4) + \\xi(y_1-y_2+y_3-y_4)\\Big].$$\n\n引入简写\n$$A_x = -x_1+x_2+x_3-x_4, \\quad B_x = -x_1-x_2+x_3+x_4, \\quad C_x = x_1-x_2+x_3-x_4,$$\n$$A_y = -y_1+y_2+y_3-y_4, \\quad B_y = -y_1-y_2+y_3+y_4, \\quad C_y = y_1-y_2+y_3-y_4.$$\n那么\n$$\\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4}\\big(A_x + C_x \\eta\\big), \\quad \\frac{\\partial x}{\\partial \\eta} = \\frac{1}{4}\\big(B_x + C_x \\xi\\big), \\quad \\frac{\\partial y}{\\partial \\xi} = \\frac{1}{4}\\big(A_y + C_y \\eta\\big), \\quad \\frac{\\partial y}{\\partial \\eta} = \\frac{1}{4}\\big(B_y + C_y \\xi\\big).$$\n\n因此，\n$$\\det J(\\xi,\\eta) = \\frac{1}{16}\\Big[(A_x + C_x \\eta)(B_y + C_y \\xi) - (B_x + C_x \\xi)(A_y + C_y \\eta)\\Big].$$\n展开，\n\\begin{align*}\n\\det J(\\xi,\\eta) &= \\frac{1}{16}\\Big[A_x B_y + A_x C_y \\xi + C_x B_y \\eta + C_x C_y \\xi\\eta \\\\\n&\\qquad - B_x A_y - B_x C_y \\eta - C_x \\xi A_y - C_x C_y \\xi\\eta \\Big].\n\\end{align*}\n混合项 $\\xi\\eta$ 完全抵消，剩下\n$$\\det J(\\xi,\\eta) = \\frac{1}{16}\\Big[(A_x B_y - B_x A_y) + (A_x C_y - C_x A_y)\\,\\xi + (C_x B_y - B_x C_y)\\,\\eta\\Big].$$\n\n这就得到了第2部分所要求的一般结构性结果：对于任何双线性四边形映射，$\\det J(\\xi,\\eta)$ 是 $(\\xi,\\eta)$ 的一个仿射线性函数，即其形式为 $a_0 + a_1 \\xi + a_2 \\eta$，没有 $\\xi\\eta$ 项，也没有 $\\xi^2$ 或 $\\eta^2$ 项。对于双线性映射，真正的二次相关性（涉及 $\\xi\\eta$）不会出现，因为如展开式所示，$\\xi\\eta$ 的系数正好抵消了。\n\n此外，行列式在整个单元上为常数的充分必要条件是 $\\xi$ 和 $\\eta$ 的系数为零：\n$$A_x C_y - C_x A_y = 0 \\quad \\text{和} \\quad C_x B_y - B_x C_y = 0$$\n以向量形式，通过元组 $(A_x,A_y)$、$(B_x,B_y)$ 定义单元中心沿 $\\xi$ 和 $\\eta$ 方向的边向量，通过 $(C_x,C_y)$ 定义双线性畸变。上述条件等价于 $(A_x,A_y)$ 和 $(B_x,B_y)$ 分别不依赖于 $\\eta$ 和 $\\xi$，且 $(C_x,C_y)$ 与两者都平行，这最终意味着映射是仿射的（物理图像是一个平行四边形）。从实际几何角度来看，$\\det J$ 为常数的充分必要条件是物理单元是一个平行四边形，即对边平行且向量差相等。\n\n现在我们针对第1部分和第3部分，使用给定的节点坐标进行计算。计算\n$$(x_1,x_2,x_3,x_4) = (0,3,2.5,-0.2), \\qquad (y_1,y_2,y_3,y_4) = (0,0.5,2.0,1.5)$$\n那么\n\\begin{align*}\nA_x &= -x_1+x_2+x_3-x_4 = -0+3+2.5-(-0.2) = 5.7 = \\frac{57}{10}, \\\\\nB_x &= -x_1-x_2+x_3+x_4 = -0-3+2.5+(-0.2) = -0.7 = -\\frac{7}{10}, \\\\\nC_x &= x_1-x_2+x_3-x_4 = 0-3+2.5-(-0.2) = -0.3 = -\\frac{3}{10},\n\\end{align*}\n以及\n\\begin{align*}\nA_y &= -y_1+y_2+y_3-y_4 = -0+0.5+2.0-1.5 = 1.0 = 1, \\\\\nB_y &= -y_1-y_2+y_3+y_4 = -0-0.5+2.0+1.5 = 3.0 = 3, \\\\\nC_y &= y_1-y_2+y_3-y_4 = 0-0.5+2.0-1.5 = 0.\n\\end{align*}\n代入通用仿射形式：\n\\begin{align*}\nA_x B_y - B_x A_y &= \\frac{57}{10}\\cdot 3 - \\left(-\\frac{7}{10}\\right)\\cdot 1 = \\frac{171}{10} + \\frac{7}{10} = \\frac{178}{10}, \\\\\nA_x C_y - C_x A_y &= \\frac{57}{10}\\cdot 0 - \\left(-\\frac{3}{10}\\right)\\cdot 1 = \\frac{3}{10}, \\\\\nC_x B_y - B_x C_y &= \\left(-\\frac{3}{10}\\right)\\cdot 3 - \\left(-\\frac{7}{10}\\right)\\cdot 0 = -\\frac{9}{10}.\n\\end{align*}\n因此，\n\\begin{align*}\n\\det J(\\xi,\\eta) &= \\frac{1}{16}\\left[\\frac{178}{10} + \\frac{3}{10}\\,\\xi - \\frac{9}{10}\\,\\eta\\right] \\\\\n&= \\frac{1}{160}\\left[178 + 3\\,\\xi - 9\\,\\eta\\right].\n\\end{align*}\n这就是所要求的闭合形式表达式。\n\n出于对映射质量的考虑，要求对于所有 $(\\xi,\\eta) \\in [-1,1]^2$，$\\det J(\\xi,\\eta) > 0$。由于 $\\det J$ 是 $(\\xi,\\eta)$ 的仿射函数，其在正方形上的最小值在某个角点处达到。在四个角点 $(\\xi,\\eta) \\in \\{(-1,-1),(-1,1),(1,-1),(1,1)\\}$ 处计算方括号中的表达式 $178 + 3\\xi - 9\\eta$，分别得到值 $184, 166, 190, 172$，所以最小值为 $166$，意味着 $\\min \\det J = \\frac{166}{160} > 0$。因此，对于该单元，映射是保向的且质量可接受。此外，如已证明，对于双线性四边形，不可能出现真正的二次（混合）$\\xi\\eta$ 相关性；只可能出现常数或仿射变化，其中常数情况对应于仿射映射（平行四边形图像）。", "answer": "$$\\boxed{\\frac{178+3\\,\\xi-9\\,\\eta}{160}}$$", "id": "2571760"}, {"introduction": "这是一个高级且至关重要的实践，它揭示了有限元分析中一个常见的关于网格质量评估的陷阱。在数值计算中，我们常在单元的积分点（高斯点）上进行计算，但这是否足以保证整个单元的有效性？本练习通过一个精心构造的反例表明，即使在所有高斯点上雅可比行列式均为正，单元内部的其他区域仍可能出现负值，导致“领结”形等无效单元。这个练习旨在培养你在评估映射质量时的审慎态度和批判性思维 [@problem_id:2571750]。", "problem": "考虑从双单位参考方块 $\\{(\\xi,\\eta): -1 \\le \\xi \\le 1,\\,-1 \\le \\eta \\le 1\\}$ 到物理平面的等参双线性映射，定义如下：\n$$\nx(\\xi,\\eta) = \\xi,\\qquad y(\\xi,\\eta) = \\eta + \\frac{6}{5}\\,\\xi\\,\\eta.\n$$\n该映射由有限元法 (FEM) 中的四节点四边形单元的标准双线性形函数导出，其中物理节点的位置由上述映射下角点 $(\\xi,\\eta) \\in \\{(-1,-1),(1,-1),(1,1),(-1,1)\\}$ 的像隐式给出。\n\n从映射 $(x(\\xi,\\eta),y(\\xi,\\eta))$ 的雅可比矩阵的定义，以及标准 $2 \\times 2$ Gauss 求积点 $(\\pm g,\\pm g)$（其中 $g = 1/\\sqrt{3}$）的位置出发，完成以下任务：\n\n- 推导给定映射的雅可比行列式 $\\det J(\\xi,\\eta)$。\n- 证明在所有 4 个标准 $2 \\times 2$ Gauss 点处求值的 $\\det J$ 均为正值。\n- 确定 $\\det J(\\xi,\\eta)$ 在整个参考方块 $[-1,1]^2$ 上的最小值。\n- 简要解释对于一个等参双线性映射，其 $\\det J$ 如何能在所有 4 个 Gauss 点处为正，而在单元内其他地方为负的几何机制。\n\n你最终报告的结果必须是 $\\det J(\\xi,\\eta)$ 在 $[-1,1]^2$ 上的最小值，表示为一个精确的实数（无需四舍五入）。不需要单位。如果你的推理中出现任何角度，都应以弧度为单位。", "solution": "该问题陈述是在有限元法框架内分析等参映射的一个有效练习。它问题适定，有科学依据，并包含了求解所需的所有信息。\n\n从参考坐标 $(\\xi, \\eta)$ 到物理坐标 $(x, y)$ 的映射由以下公式给出：\n$$\nx(\\xi,\\eta) = \\xi\n$$\n$$\ny(\\xi,\\eta) = \\eta + \\frac{6}{5}\\,\\xi\\,\\eta\n$$\n参考单元的域是双单位方块，定义为 $\\xi \\in [-1, 1]$ 和 $\\eta \\in [-1, 1]$。\n\n首先，我们推导该变换的雅可比矩阵 $J$。雅可比矩阵定义为：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n我们根据给定的映射方程计算所需的偏导数：\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(\\xi) = 1\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(\\xi) = 0\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}\\left(\\eta + \\frac{6}{5}\\,\\xi\\,\\eta\\right) = \\frac{6}{5}\\,\\eta\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}\\left(\\eta + \\frac{6}{5}\\,\\xi\\,\\eta\\right) = 1 + \\frac{6}{5}\\,\\xi\n$$\n将这些导数代入矩阵，我们得到：\n$$\nJ(\\xi, \\eta) = \\begin{pmatrix} 1 & 0 \\\\ \\frac{6}{5}\\,\\eta & 1 + \\frac{6}{5}\\,\\xi \\end{pmatrix}\n$$\n雅可比行列式 $\\det J$ 随之计算如下：\n$$\n\\det J(\\xi, \\eta) = (1)\\left(1 + \\frac{6}{5}\\,\\xi\\right) - (0)\\left(\\frac{6}{5}\\,\\eta\\right) = 1 + \\frac{6}{5}\\,\\xi\n$$\n这就完成了第一个任务。我们观察到雅可比行列式仅是 $\\xi$ 的函数。\n\n接下来，我们必须证明在所有四个标准 $2 \\times 2$ Gauss 求积点处 $\\det J$ 均为正。这些点位于 $(\\xi, \\eta) = (\\pm g, \\pm g)$，其中 $g = 1/\\sqrt{3}$。由于 $\\det J$ 仅依赖于 $\\xi$，我们只需检查 $\\xi = g$ 和 $\\xi = -g$ 处的值。\n\n对于 $\\xi = g = 1/\\sqrt{3}$：\n$$\n\\det J\\left(\\frac{1}{\\sqrt{3}}, \\eta\\right) = 1 + \\frac{6}{5}\\left(\\frac{1}{\\sqrt{3}}\\right) = 1 + \\frac{6}{5\\sqrt{3}}\n$$\n这个值显然是正的，因为它是两个正数之和。\n\n对于 $\\xi = -g = -1/\\sqrt{3}$：\n$$\n\\det J\\left(-\\frac{1}{\\sqrt{3}}, \\eta\\right) = 1 + \\frac{6}{5}\\left(-\\frac{1}{\\sqrt{3}}\\right) = 1 - \\frac{6}{5\\sqrt{3}}\n$$\n为确定该值的符号，我们比较 $1$ 和 $\\frac{6}{5\\sqrt{3}}$。由于两者都为正，我们可以比较它们的平方：\n$$\n1^2 = 1\n$$\n$$\n\\left(\\frac{6}{5\\sqrt{3}}\\right)^2 = \\frac{36}{25 \\times 3} = \\frac{36}{75} = \\frac{12}{25}\n$$\n由于 $1 > \\frac{12}{25}$，因此有 $1 > \\frac{6}{5\\sqrt{3}}$。所以，$1 - \\frac{6}{5\\sqrt{3}} > 0$。\n因此，在所有四个 Gauss 点处，雅可比行列式均为正值。\n\n现在，我们来确定 $\\det J(\\xi, \\eta)$ 在整个参考方块 $[-1, 1]^2$ 上的最小值。待最小化的函数是 $f(\\xi) = \\det J = 1 + \\frac{6}{5}\\,\\xi$。这是一个关于 $\\xi$ 的线性函数，其斜率为正（$\\frac{6}{5} > 0$）。在区间 $\\xi \\in [-1, 1]$ 上，这样的函数在其左端点 $\\xi = -1$ 处达到最小值。\n因此，最小值为：\n$$\n\\min_{\\xi, \\eta \\in [-1, 1]^2} \\det J(\\xi, \\eta) = 1 + \\frac{6}{5}(-1) = 1 - \\frac{6}{5} = -\\frac{1}{5}\n$$\n这就是所要求的最终结果。\n\n最后，我们简要解释其背后的几何机制。雅可比行列式 $\\det J$ 将参考空间中的无穷小面积元 $d\\xi\\,d\\eta$ 与物理空间中相应的面积元 $dx\\,dy$ 联系起来。正的行列式表示一个保向映射，而负的行列式表示该映射是反向的，这在几何上对应于单元自身发生了翻折。这样的单元对于物理分析是无效的。\n\n在本题中，我们得到 $\\det J(\\xi, \\eta) = 1 + \\frac{6}{5}\\,\\xi$。当 $1 + \\frac{6}{5}\\,\\xi < 0$ 时，行列式为负，这可化简为 $\\xi < -5/6$。因此，参考方块中使映射无效的区域是由 $-1 \\le \\xi < -5/6$ 和 $-1 \\le \\eta \\le 1$ 定义的矩形带状区域。\n\n标准 $2 \\times 2$ Gauss 点的横坐标为 $\\xi = \\pm 1/\\sqrt{3} \\approx \\pm 0.577$。$\\det J = 0$ 的奇异线位于 $\\xi = -5/6 \\approx -0.833$。由于 $\\xi = 0.577$ 和 $\\xi = -0.577$ 都大于 $-0.833$，所有四个 Gauss 点都位于单元中映射有效（$\\det J > 0$）的区域内。\n\n这种机制是，数值积分方案（如 Gauss 求积）仅在离散点上对单元的性质进行采样。所有这些采样点可能都落在映射性态良好的区域内，而单元的其他部分则在几何上是扭曲和无效的（即 $\\det J < 0$）。这是等参单元的一个已知病态问题，尤其对于扭曲的四边形形状。基于此求积法则的单元矩阵计算将不会出现数值错误，从而错误地表明该单元是有效的，而实际上，该单元具有非物理的、翻折的几何形状。与此映射对应的物理单元是一个非凸或“领结形”的四边形，这是域内雅可比行列式符号改变的直接后果。", "answer": "$$\\boxed{-\\frac{1}{5}}$$", "id": "2571750"}]}