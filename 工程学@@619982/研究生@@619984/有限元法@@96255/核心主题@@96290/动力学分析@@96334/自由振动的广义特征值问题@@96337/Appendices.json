{"hands_on_practices": [{"introduction": "从连续介质力学到离散数值解的过程是有限元方法的核心。此实践将引导您完成一个简单轴向杆的完整分析流程，从基于能量原理推导单元刚度和质量矩阵开始[@problem_id:2562525]。通过为一个双单元系统组装这些矩阵并求解其基频，您将亲身体验任何自由振动分析的核心步骤。", "problem": "考虑一根均匀、等截面的轴向杆，使用线性的 $2$ 节点杆单元，通过有限元法 (FEM) 建模。该杆具有恒定的杨氏模量 $E$、横截面积 $A$、质量密度 $\\rho$ 和总长度 $L$。该杆两端固定（固支-固支边界条件）。随时间变化的轴向位移场用 $u(x,t)$ 表示。假设小变形和线性、弹性、一维轴向行为。\n\n任务：\n1. 从轴向应变 $\\varepsilon(x,t)$、Cauchy 应力 $\\sigma(x,t)$ 的标准定义，以及弹性应变能和动能的表达式出发，推导长度为 $\\ell_{e}$ 的单个线性 $2$ 节点杆单元的单元刚度矩阵和一致单元质量矩阵。使用标准线性形函数在单元上进行插值，并且不假设集总质量。\n2. 将杆离散为 $2$ 个等长单元（$\\ell_{e} = L/2$），节点从左端到右端编号为 $1$、$2$ 和 $3$。组装全局刚度矩阵和质量矩阵，然后施加节点 $1$ 和 $3$ 处的固支-固支边界条件，得到自由振动的简化广义特征值问题。确定离散系统的基频角频率 $\\omega_{1}$。\n3. 对于数据 $E = 75 \\times 10^{9}\\,\\mathrm{Pa}$，$\\rho = 3000\\,\\mathrm{kg\\,m^{-3}}$，$A = 5 \\times 10^{-4}\\,\\mathrm{m^{2}}$ 和 $L = 2\\,\\mathrm{m}$，数值计算 $\\omega_{1}$。最终频率以弧度/秒为单位表示，并将答案四舍五入到四位有效数字。", "solution": "所述问题是有效的、有科学依据的且提法恰当。这是有限元法在结构动力学中应用的一个标准练习。我们开始求解。\n\n自由振动的分析始于能量守恒原理，或者更正式地，Hamilton 原理。对于没有外力做功的保守系统，其运动方程从拉格朗日量 $L = T - U$ 导出，其中 $T$ 是总动能，$U$ 是总应变能。变分方法导出了有限元系统的矩阵运动方程：$\\mathbf{M}\\ddot{\\mathbf{u}} + \\mathbf{K}\\mathbf{u} = \\mathbf{0}$。对于自由谐波振动，我们假设解的形式为 $\\mathbf{u}(t) = \\mathbf{U} e^{i\\omega t}$，这产生广义特征值问题 $(\\mathbf{K} - \\omega^{2}\\mathbf{M})\\mathbf{U} = \\mathbf{0}$，其中 $\\omega$ 代表固有角频率，$\\mathbf{U}$ 代表相应的振型。\n\n**任务1：单元刚度矩阵和质量矩阵的推导**\n\n我们考虑一个长度为 $\\ell_e$、横截面积为 $A$、杨氏模量为 $E$、质量密度为 $\\rho$ 的单个线性 $2$ 节点轴向杆单元。设该单元沿 $x$ 轴从 $x=0$ 到 $x=\\ell_e$。单元内的轴向位移场 $u(x,t)$ 是通过使用线性形函数 $N_1(x)$ 和 $N_2(x)$ 对节点位移 $u_1(t)$ 和 $u_2(t)$ 进行插值得到的：\n$$u(x,t) = N_1(x) u_1(t) + N_2(x) u_2(t) = \\mathbf{N}(x)\\mathbf{d}_e(t)$$\n其中 $\\mathbf{d}_e(t) = \\begin{pmatrix} u_1(t) \\\\ u_2(t) \\end{pmatrix}$ 是节点位移向量，$\\mathbf{N}(x) = \\begin{pmatrix} N_1(x) & N_2(x) \\end{pmatrix}$ 是形函数矩阵。对于线性单元，这些函数是：\n$$N_1(x) = 1 - \\frac{x}{\\ell_e} \\quad \\text{and} \\quad N_2(x) = \\frac{x}{\\ell_e}$$\n\n轴向应变 $\\varepsilon(x,t)$ 是位移的空间导数：\n$$\\varepsilon(x,t) = \\frac{\\partial u}{\\partial x} = \\frac{d\\mathbf{N}}{dx}\\mathbf{d}_e(t) = \\mathbf{B}\\mathbf{d}_e(t)$$\n该单元的应变-位移矩阵 $\\mathbf{B}$ 是一个常数：\n$$\\mathbf{B} = \\frac{d\\mathbf{N}}{dx} = \\begin{pmatrix} \\frac{d N_1}{dx} & \\frac{d N_2}{dx} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{\\ell_e} & \\frac{1}{\\ell_e} \\end{pmatrix}$$\n\n储存在单元中的弹性应变能 $U_e$ 由下式给出：\n$$U_e = \\frac{1}{2} \\int_V \\sigma \\varepsilon \\, dV = \\frac{1}{2} \\int_0^{\\ell_e} (E\\varepsilon) \\varepsilon A \\, dx = \\frac{1}{2} \\int_0^{\\ell_e} (\\mathbf{d}_e^T \\mathbf{B}^T E \\mathbf{B} \\mathbf{d}_e) A \\, dx$$\n由于 $\\mathbf{d}_e$ 不是 $x$ 的函数，这可以简化为 $U_e = \\frac{1}{2} \\mathbf{d}_e^T \\mathbf{k}_e \\mathbf{d}_e$，其中单元刚度矩阵 $\\mathbf{k}_e$ 为：\n$$\\mathbf{k}_e = \\int_0^{\\ell_e} \\mathbf{B}^T E \\mathbf{B} A \\, dx = A E \\ell_e \\mathbf{B}^T \\mathbf{B}$$\n代入 $\\mathbf{B}$ 的表达式：\n$$\\mathbf{k}_e = A E \\ell_e \\begin{pmatrix} -1/\\ell_e \\\\ 1/\\ell_e \\end{pmatrix} \\begin{pmatrix} -1/\\ell_e & 1/\\ell_e \\end{pmatrix} = A E \\ell_e \\begin{pmatrix} 1/\\ell_e^2 & -1/\\ell_e^2 \\\\ -1/\\ell_e^2 & 1/\\ell_e^2 \\end{pmatrix} = \\frac{AE}{\\ell_e} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$$\n\n单元的动能 $T_e$ 由下式给出：\n$$T_e = \\frac{1}{2} \\int_V \\rho \\dot{u}^2 \\, dV = \\frac{1}{2} \\int_0^{\\ell_e} \\rho (\\mathbf{N}\\dot{\\mathbf{d}}_e)^2 A \\, dx = \\frac{1}{2} \\int_0^{\\ell_e} \\dot{\\mathbf{d}}_e^T \\mathbf{N}^T \\rho \\mathbf{N} \\dot{\\mathbf{d}}_e A \\, dx$$\n这可以简化为 $T_e = \\frac{1}{2} \\dot{\\mathbf{d}}_e^T \\mathbf{m}_e \\dot{\\mathbf{d}}_e$，其中一致单元质量矩阵 $\\mathbf{m}_e$ 为：\n$$\\mathbf{m}_e = \\int_0^{\\ell_e} \\mathbf{N}^T \\rho \\mathbf{N} A \\, dx = \\rho A \\int_0^{\\ell_e} \\begin{pmatrix} N_1(x) \\\\ N_2(x) \\end{pmatrix} \\begin{pmatrix} N_1(x) & N_2(x) \\end{pmatrix} dx$$\n$$\\mathbf{m}_e = \\rho A \\int_0^{\\ell_e} \\begin{pmatrix} (1 - x/\\ell_e)^2 & (x/\\ell_e)(1 - x/\\ell_e) \\\\ (x/\\ell_e)(1 - x/\\ell_e) & (x/\\ell_e)^2 \\end{pmatrix} dx$$\n计算积分：\n$\\int_0^{\\ell_e} (1 - x/\\ell_e)^2 dx = \\ell_e/3$\n$\\int_0^{\\ell_e} (x/\\ell_e)(1 - x/\\ell_e) dx = \\ell_e/6$\n$\\int_0^{\\ell_e} (x/\\ell_e)^2 dx = \\ell_e/3$\n因此，一致单元质量矩阵为：\n$$\\mathbf{m}_e = \\rho A \\ell_e \\begin{pmatrix} 1/3 & 1/6 \\\\ 1/6 & 1/3 \\end{pmatrix} = \\frac{\\rho A \\ell_e}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$$\n\n**任务2：系统组装、边界条件和特征值问题**\n\n总长度为 $L$ 的杆被离散为两个等长单元，$\\ell_e = L/2$。节点编号为 $1$、$2$ 和 $3$。单元 $(1)$ 连接节点 $1$ 和 $2$，单元 $(2)$ 连接节点 $2$ 和 $3$。每个单元的单元矩阵为：\n$$\\mathbf{k}^{(1)} = \\mathbf{k}^{(2)} = \\frac{AE}{L/2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\frac{2AE}{L} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$$\n$$\\mathbf{m}^{(1)} = \\mathbf{m}^{(2)} = \\frac{\\rho A (L/2)}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} = \\frac{\\rho A L}{12} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$$\n总刚度矩阵 $\\mathbf{K}$ 和总质量矩阵 $\\mathbf{M}$ 是通过将每个单元的贡献相加，组装成一个对应于全局自由度 $u_1$、$u_2$ 和 $u_3$ 的 $3 \\times 3$ 矩阵。\n$$ \\mathbf{K} = \\frac{2AE}{L} \\begin{pmatrix} 1 & -1 & 0 \\\\ -1 & 1+1 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix} = \\frac{2AE}{L} \\begin{pmatrix} 1 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix} $$\n$$ \\mathbf{M} = \\frac{\\rho A L}{12} \\begin{pmatrix} 2 & 1 & 0 \\\\ 1 & 2+2 & 1 \\\\ 0 & 1 & 2 \\end{pmatrix} = \\frac{\\rho A L}{12} \\begin{pmatrix} 2 & 1 & 0 \\\\ 1 & 4 & 1 \\\\ 0 & 1 & 2 \\end{pmatrix} $$\n杆的两端是固定的，这意味着边界条件为 $u_1 = 0$ 和 $u_3 = 0$。我们通过从全局特征值问题 $(\\mathbf{K} - \\omega^2 \\mathbf{M})\\mathbf{U} = \\mathbf{0}$ 中消除与约束自由度（$1$ 和 $3$）相对应的行和列，来获得未知位移 $u_2$ 的自由振动的简化系统。简化后的系统是一个仅涉及中心节点自由度的标量方程：\n$$(K_{22} - \\omega^2 M_{22}) u_2 = 0$$\n对于非平凡解（$u_2 \\ne 0$），括号中的项必须为零。所需的矩阵分量为：\n$$K_{22} = \\frac{2AE}{L}(2) = \\frac{4AE}{L}$$\n$$M_{22} = \\frac{\\rho A L}{12}(4) = \\frac{\\rho A L}{3}$$\n特征值问题变为：\n$$\\frac{4AE}{L} - \\omega^2 \\frac{\\rho A L}{3} = 0$$\n该系统只有一个自由度，因此它只产生一个固有频率，即该离散化模型的基频 $\\omega_1$。求解 $\\omega_1^2$：\n$$\\omega_1^2 = \\frac{4AE/L}{\\rho A L/3} = \\frac{12AE}{\\rho A L^2} = \\frac{12E}{\\rho L^2}$$\n基频角频率为：\n$$\\omega_1 = \\sqrt{\\frac{12E}{\\rho L^2}} = \\frac{2\\sqrt{3}}{L}\\sqrt{\\frac{E}{\\rho}}$$\n\n**任务3：数值计算**\n\n给定以下数据：$E = 75 \\times 10^{9}\\,\\mathrm{Pa}$，$\\rho = 3000\\,\\mathrm{kg\\,m^{-3}}$，$A = 5 \\times 10^{-4}\\,\\mathrm{m^{2}}$，以及 $L = 2\\,\\mathrm{m}$。注意，面积 $A$ 在频率表达式中被消掉了。\n将数值代入推导出的 $\\omega_1$ 表达式中：\n$$\\omega_1 = \\sqrt{\\frac{12 \\times (75 \\times 10^9)}{3000 \\times 2^2}} = \\sqrt{\\frac{900 \\times 10^9}{3000 \\times 4}} = \\sqrt{\\frac{9 \\times 10^{11}}{12000}}$$\n$$\\omega_1 = \\sqrt{\\frac{9 \\times 10^{11}}{1.2 \\times 10^4}} = \\sqrt{\\frac{9}{1.2} \\times 10^7} = \\sqrt{7.5 \\times 10^7} = \\sqrt{75 \\times 10^6}$$\n$$\\omega_1 = 10^3 \\sqrt{75} = 10^3 \\sqrt{25 \\times 3} = 5000\\sqrt{3} \\approx 8660.254 \\, \\mathrm{rad/s}$$\n将结果四舍五入到四位有效数字，得到：\n$$\\omega_1 \\approx 8660 \\, \\mathrm{rad/s}$$", "answer": "$$\\boxed{8660}$$", "id": "2562525"}, {"introduction": "一个强大的数值方法不仅在于我们能实现它，更在于我们能理解其精度。本练习深入探讨了数值频散这一关键概念，它是动态模拟保真度的核心影响因素[@problem_id:2562488]。通过使用一致质量矩阵和集中质量矩阵分析离散杆中的波传播特性，您将学习到离散化选择如何影响解的精度（尤其是在高频下），并探索构建更高阶精度格式的方法。", "problem": "一根无穷长、均匀、棱柱形弹性杆，其横截面积为 $A$、质量密度为 $\\rho$、杨氏模量为 $E$。其纵向小幅自由振动由一维波动方程 $\\rho A \\, \\partial^{2} u / \\partial t^{2} - E A \\, \\partial^{2} u / \\partial x^{2} = 0$ 控制，其中 $u(x,t)$ 是轴向位移。弹性波速为 $c = \\sqrt{E / \\rho}$。该杆使用大小为 $h$ 的两节点线性单元的均匀网格，通过有限元法 (FEM) 进行离散化。标准的单元刚度矩阵和一致质量矩阵分别为 $\\mathbf{K}_{e} = (E A / h) \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}$ 和 $\\mathbf{M}_{e}^{c} = (\\rho A h / 6) \\begin{bmatrix} 2 & 1 \\\\ 1 & 2 \\end{bmatrix}$，而集中单元质量矩阵为 $\\mathbf{M}_{e}^{\\ell} = (\\rho A h / 2) \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}$。设 $u_{j}(t)$ 表示第 $j$ 个节点的位移，并假设对于波数 $k$ 和角频率 $\\omega$，Bloch 波 ansatz $u_{j}(t) = U \\exp(\\mathrm{i} (j k h - \\omega t))$ 成立。通过在无限晶格上组装全局半离散系统 $\\mathbf{M} \\ddot{\\mathbf{u}} + \\mathbf{K} \\mathbf{u} = \\mathbf{0}$ 并代入 Bloch ansatz，可以得到形如 $\\mathbf{K} \\boldsymbol{\\phi} = \\omega^{2} \\mathbf{M} \\boldsymbol{\\phi}$ 的广义特征值问题，从而得出 $\\omega$ 和 $k$ 之间的离散色散关系。\n\n任务 $1$：从组装的节点方程出发，并且不使用任何非由上述定义推导出的结果，推导一致质量矩阵和集中质量矩阵的离散色散关系 $\\Omega(kh)$，其中无量纲频率为 $\\Omega = \\omega h / c$。然后，对这两种质量矩阵，计算高频边界极限 $\\lim_{kh \\to \\pi} \\Omega$，并评论与一致质量情况相比，质量集中如何改变高频色散。\n\n任务 $2$：为了在不改变刚度的情况下改善高波数时的色散，考虑在组装后的晶格层面上采用一种最近邻修正质量，其形式为\n$$( - \\omega^{2} ) \\, \\rho A h \\, \\big( \\alpha_{0} \\, u_{j} + \\alpha_{1} \\, (u_{j-1} + u_{j+1}) \\big) + \\frac{E A}{h} \\, \\big( 2 u_{j} - u_{j-1} - u_{j+1} \\big) = 0,$$\n其中 $\\alpha_{0}$ 和 $\\alpha_{1}$ 是实数、无量纲系数。施加零波数归一化约束 $\\alpha_{0} + 2 \\alpha_{1} = 1$，以使主阶长波相速度等于 $c$。使用 Bloch ansatz，推导相应的色散关系\n$$(\\Omega(kh))^{2} \\;=\\; \\frac{2 \\, \\big( 1 - \\cos(kh) \\big)}{\\alpha_{0} + 2 \\alpha_{1} \\cos(kh)}.$$\n通过将此关系在 $x = 0$ 附近展开为关于 $x = (kh)^{2}$ 的幂级数，确定能够消除 $\\mathcal{O}((kh)^{2})$ 阶色散误差的唯一 $\\alpha_{1}$ 值，即满足 $(\\Omega / (kh))^{2} = 1 + \\mathcal{O}((kh)^{4})$。报告 $\\alpha_{1}$ 的值作为你的最终答案。不需要四舍五入；提供一个没有单位的精确值。", "solution": "问题陈述具有科学依据、问题明确且客观。这是一维波动方程有限元离散化中数值色散分析的一个标准练习。所有必要信息都已提供，任务也已明确定义。因此，该问题被认为是有效的，并将提供解答。\n\n该问题要求对一维波动方程 $\\rho A \\, \\partial^{2} u / \\partial t^{2} - E A \\, \\partial^{2} u / \\partial x^{2} = 0$ 的有限元离散化的色散特性进行两部分分析。\n\n任务 1：推导一致质量矩阵和集中质量矩阵的离散色散关系，并分析其高频行为。\n\n首先，我们在一个无限、均匀的网格中为通用节点 $j$ 组装半离散运动方程。该方程形式为 $\\mathbf{M} \\ddot{\\mathbf{u}} + \\mathbf{K} \\mathbf{u} = \\mathbf{0}$。此系统中对应于节点位移 $u_j(t)$ 的行是通过对与节点 $j$ 相邻的两个单元——单元 $(j-1, j)$ 和单元 $(j, j+1)$ 的贡献求和来构建的。\n\n节点 $j$ 处的刚度贡献来自于相邻单元施加的力。使用给定的单元刚度矩阵 $\\mathbf{K}_{e} = (E A / h) \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}$，来自单元 $(j-1, j)$ 作用在节点 $j$ 上的力是 $\\mathbf{K}_e$ 的第二行作用于 $(u_{j-1}, u_j)^T$，即 $\\frac{EA}{h}(-u_{j-1} + u_j)$。来自单元 $(j, j+1)$ 作用在节点 $j$ 上的力是 $\\mathbf{K}_e$ 的第一行作用于 $(u_j, u_{j+1})^T$，即 $\\frac{EA}{h}(u_j - u_{j+1})$。节点 $j$ 的总刚度项是这两者之和：\n$$ (\\mathbf{K} \\mathbf{u})_j = \\frac{EA}{h}(-u_{j-1} + u_j) + \\frac{EA}{h}(u_j - u_{j+1}) = \\frac{EA}{h}(2u_j - u_{j-1} - u_{j+1}) $$\n对于一致质量和集中质量公式，此项是相同的，因为刚度矩阵没有改变。\n\n惯性项 $(\\mathbf{M} \\ddot{\\mathbf{u}})_j$ 取决于质量矩阵。\n对于一致质量矩阵 $\\mathbf{M}_{e}^{c} = (\\rho A h / 6) \\begin{bmatrix} 2 & 1 \\\\ 1 & 2 \\end{bmatrix}$，来自单元 $(j-1, j)$ 在节点 $j$ 处的惯性项是 $\\mathbf{M}_e^c$ 的第二行作用于 $(\\ddot{u}_{j-1}, \\ddot{u}_j)^T$，即 $\\frac{\\rho A h}{6}(\\ddot{u}_{j-1} + 2\\ddot{u}_j)$。来自单元 $(j, j+1)$ 的项是第一行作用于 $(\\ddot{u}_j, \\ddot{u}_{j+1})^T$，即 $\\frac{\\rho A h}{6}(2\\ddot{u}_j + \\ddot{u}_{j+1})$。总惯性项为：\n$$ (\\mathbf{M}^c \\ddot{\\mathbf{u}})_j = \\frac{\\rho A h}{6}(\\ddot{u}_{j-1} + 2\\ddot{u}_j) + \\frac{\\rho A h}{6}(2\\ddot{u}_j + \\ddot{u}_{j+1}) = \\frac{\\rho A h}{6}(\\ddot{u}_{j-1} + 4\\ddot{u}_j + \\ddot{u}_{j+1}) $$\n一致质量情况下的运动方程为：\n$$ \\frac{\\rho A h}{6}(\\ddot{u}_{j-1} + 4\\ddot{u}_j + \\ddot{u}_{j+1}) + \\frac{EA}{h}(2u_j - u_{j-1} - u_{j+1}) = 0 $$\n\n对于集中质量矩阵 $\\mathbf{M}_{e}^{\\ell} = (\\rho A h / 2) \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix}$，步骤类似。来自单元 $(j-1, j)$ 在节点 $j$ 处的惯性项是 $\\frac{\\rho A h}{2}\\ddot{u}_j$，来自单元 $(j, j+1)$ 的惯性项也是 $\\frac{\\rho A h}{2}\\ddot{u}_j$。总惯性项为：\n$$ (\\mathbf{M}^\\ell \\ddot{\\mathbf{u}})_j = \\frac{\\rho A h}{2}\\ddot{u}_j + \\frac{\\rho A h}{2}\\ddot{u}_j = \\rho A h \\ddot{u}_j $$\n集中质量情况下的运动方程为：\n$$ \\rho A h \\ddot{u}_j + \\frac{EA}{h}(2u_j - u_{j-1} - u_{j+1}) = 0 $$\n\n为求出色散关系，我们将 Bloch 波 ansatz $u_j(t) = U \\exp(\\mathrm{i}(jkh - \\omega t))$ 代入这些方程。我们注意到 $\\ddot{u}_j = -\\omega^2 u_j$ 且 $u_{j\\pm 1} = u_j \\exp(\\pm \\mathrm{i}kh)$。\n\n对于一致质量情况：\n$$ -\\omega^2 \\frac{\\rho A h}{6}(u_j e^{-\\mathrm{i}kh} + 4u_j + u_j e^{\\mathrm{i}kh}) + \\frac{EA}{h}(2u_j - u_j e^{-\\mathrm{i}kh} - u_j e^{\\mathrm{i}kh}) = 0 $$\n两边除以 $u_j$ 并使用 $e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta} = 2\\cos(\\theta)$：\n$$ -\\omega^2 \\frac{\\rho A h}{6}(2\\cos(kh) + 4) + \\frac{EA}{h}(2 - 2\\cos(kh)) = 0 $$\n解出 $\\omega^2$：\n$$ \\omega^2 = \\frac{EA/h}{\\rho A h/6} \\frac{2(1-\\cos(kh))}{4+2\\cos(kh)} = \\frac{6E}{\\rho h^2} \\frac{1-\\cos(kh)}{2+\\cos(kh)} $$\n使用定义 $c = \\sqrt{E/\\rho}$ 和 $\\Omega = \\omega h/c$，我们得到无量纲色散关系：\n$$ \\Omega_c^2 = \\frac{\\omega^2 h^2}{c^2} = \\frac{\\omega^2 h^2 \\rho}{E} = 6 \\frac{1 - \\cos(kh)}{2 + \\cos(kh)} $$\n\n对于集中质量情况：\n$$ -\\omega^2 \\rho A h u_j + \\frac{EA}{h}(2u_j - u_j e^{-\\mathrm{i}kh} - u_j e^{\\mathrm{i}kh}) = 0 $$\n$$ -\\omega^2 \\rho A h + \\frac{EA}{h}(2 - 2\\cos(kh)) = 0 $$\n解出 $\\omega^2$：\n$$ \\omega^2 = \\frac{EA/h}{\\rho A h} (2(1-\\cos(kh))) = \\frac{2E}{\\rho h^2}(1-\\cos(kh)) $$\n无量纲色散关系为：\n$$ \\Omega_\\ell^2 = \\frac{\\omega^2 h^2}{c^2} = 2(1 - \\cos(kh)) $$\n这可以使用半角恒等式 $1-\\cos(x) = 2\\sin^2(x/2)$ 重写为：\n$$ \\Omega_\\ell^2 = 4\\sin^2(kh/2) \\implies \\Omega_\\ell(kh) = 2|\\sin(kh/2)| $$\n\n现在，计算当 $kh \\to \\pi$ 时的高频极限：\n对于一致质量：\n$$ \\lim_{kh \\to \\pi} \\Omega_c^2 = 6 \\frac{1 - \\cos(\\pi)}{2 + \\cos(\\pi)} = 6 \\frac{1 - (-1)}{2 + (-1)} = 6 \\frac{2}{1} = 12 $$\n$$ \\lim_{kh \\to \\pi} \\Omega_c = \\sqrt{12} = 2\\sqrt{3} $$\n对于集中质量：\n$$ \\lim_{kh \\to \\pi} \\Omega_\\ell^2 = 2(1 - \\cos(\\pi)) = 2(1 - (-1)) = 4 $$\n$$ \\lim_{kh \\to \\pi} \\Omega_\\ell = 2 $$\n精确色散关系是 $\\omega=ck$，或 $\\Omega = kh$。在区域边界处，$\\Omega_{exact}(\\pi) = \\pi \\approx 3.14159$。一致质量法给出的结果是 $\\Omega_c(\\pi) = 2\\sqrt{3} \\approx 3.464$，高估了频率。集中质量法给出的结果是 $\\Omega_\\ell(\\pi) = 2$，低估了频率。因此，质量集中显著降低了高波数模式的频率，与“更硬”的一致质量公式相比，这有效地“软化”了离散系统的动态响应。\n\n任务2：确定改进质量公式的系数 $\\alpha_1$。\n\n我们得到修正质量公式的广义运动方程：\n$$ ( - \\omega^{2} ) \\, \\rho A h \\, \\big( \\alpha_{0} \\, u_{j} + \\alpha_{1} \\, (u_{j-1} + u_{j+1}) \\big) + \\frac{E A}{h} \\, \\big( 2 u_{j} - u_{j-1} - u_{j+1} \\big) = 0 $$\n代入 Bloch ansatz，我们得到：\n$$ -\\omega^2 \\rho A h (\\alpha_0 + 2\\alpha_1 \\cos(kh)) + \\frac{EA}{h}(2 - 2\\cos(kh)) = 0 $$\n解出 $\\omega^2$ 并转换为 $\\Omega^2$：\n$$ \\Omega^2 = \\frac{\\omega^2 h^2}{c^2} = \\frac{2(1 - \\cos(kh))}{\\alpha_0 + 2\\alpha_1 \\cos(kh)} $$\n这证实了问题中给出的关系。在约束条件 $\\alpha_0 = 1 - 2\\alpha_1$ 下，分母变为 $1 - 2\\alpha_1 + 2\\alpha_1\\cos(kh) = 1 - 2\\alpha_1(1-\\cos(kh))$。\n所以，色散关系为：\n$$ \\Omega^2 = \\frac{2(1 - \\cos(kh))}{1 - 2\\alpha_1(1 - \\cos(kh))} $$\n我们需要找到 $\\alpha_1$ 使得 $(\\Omega/(kh))^2 = 1 + \\mathcal{O}((kh)^4)$。设 $q = kh$。我们在 $q=0$ 附近将 $(\\Omega/q)^2$ 展开为关于 $q$ 的幂级数。\n我们使用 $\\cos(q)$ 的泰勒级数：\n$$ \\cos(q) = 1 - \\frac{q^2}{2!} + \\frac{q^4}{4!} - \\mathcal{O}(q^6) $$\n$$ 1 - \\cos(q) = \\frac{q^2}{2} - \\frac{q^4}{24} + \\mathcal{O}(q^6) $$\n$\\Omega^2$ 的分子是 $2(1-\\cos(q)) = q^2 - \\frac{q^4}{12} + \\mathcal{O}(q^6)$。\n$\\Omega^2$ 的分母是 $1 - 2\\alpha_1(\\frac{q^2}{2} - \\frac{q^4}{24} + \\mathcal{O}(q^6)) = 1 - \\alpha_1 q^2 + \\frac{\\alpha_1}{12} q^4 - \\mathcal{O}(q^6)$。\n现在我们构造 $(\\Omega/q)^2 = \\Omega^2/q^2$ 的比率：\n$$ \\frac{\\Omega^2}{q^2} = \\frac{1 - \\frac{q^2}{12} + \\mathcal{O}(q^4)}{1 - \\alpha_1 q^2 + \\mathcal{O}(q^4)} $$\n使用几何级数展开 $(1-z)^{-1} = 1 + z + z^2 + \\dots$，其中 $z = \\alpha_1 q^2 - \\mathcal{O}(q^4)$：\n$$ \\frac{\\Omega^2}{q^2} = \\left(1 - \\frac{q^2}{12} + \\mathcal{O}(q^4)\\right) \\left(1 + \\alpha_1 q^2 + \\mathcal{O}(q^4)\\right) $$\n$$ \\frac{\\Omega^2}{q^2} = 1 + \\alpha_1 q^2 - \\frac{1}{12} q^2 + \\mathcal{O}(q^4) = 1 + \\left(\\alpha_1 - \\frac{1}{12}\\right)q^2 + \\mathcal{O}(q^4) $$\n色散误差为 $\\mathcal{O}((kh)^4)$ 阶的条件意味着 $(kh)^2 = q^2$ 项的系数必须为零。\n$$ \\alpha_1 - \\frac{1}{12} = 0 $$\n这就得出了 $\\alpha_1$ 的唯一值：\n$$ \\alpha_1 = \\frac{1}{12} $$\n这个 $\\alpha_1$ 的选择消除了主误差项，使数值格式在长波长下具有空间上的四阶精度。对应的 $\\alpha_0$ 值为 $\\alpha_0 = 1 - 2(\\frac{1}{12}) = 1 - \\frac{1}{6} = \\frac{5}{6}$。由此产生的质量矩阵为数值相速度提供了更高阶的精度。", "answer": "$$\\boxed{\\frac{1}{12}}$$", "id": "2562488"}, {"introduction": "真正掌握有限元方法源于为实际工程结构实现并验证复杂模型的能力。这个综合性计算练习将挑战您使用先进的高阶（$p=4$）谱元，为悬臂梁的振动问题构建一个求解器[@problem_id:2562466]。通过编写代码从第一性原理组装矩阵，并将您的计算结果与解析解进行比较，您将在高性能计算动力学和代码验证这一关键过程中获得宝贵的实践经验。", "problem": "您的任务是设计并实现一种计算方法，使用有限元法 (FEM) 来近似计算均匀细长悬臂梁的前两个自由振动特征值。您的方法必须基于第一性原理，并构建为用于自由振动的广义特征值问题。您的程序必须由多项式阶数 $p=4$ 的 $C^1$ 谱梁单元组装全局刚度矩阵和质量矩阵，施加适用于悬臂梁的固支-自由边界条件，求解广义对称特征值问题，并将最低的两个角频率与解析值进行比较。最终输出必须汇总一个小测试套件的精度评估。\n\n基本原理和推导约束：\n- 从用于小横向振动的 Euler–Bernoulli 梁模型出发。其控制方程为 $ \\rho A \\, \\partial^2 w/\\partial t^2 + E I \\, \\partial^4 w/\\partial x^4 = 0$，其中 $w(x,t)$ 是横向位移，$x \\in [0,L]$ 是梁轴，$t$ 是时间，$E$ 是杨氏模量，$I$ 是面积二次矩，$A$ 是横截面积，$\\rho$ 是单位体积质量密度。\n- 对悬臂梁使用标准的固支-自由边界条件：在 $x=0$（固支端），$w(0,t)=0$ 且 $\\partial w/\\partial x (0,t)=0$；在 $x=L$（自由端），弯矩和剪力为零，即 $E I \\, \\partial^2 w/\\partial x^2 (L,t)=0$ 和 $E I \\, \\partial^3 w/\\partial x^3 (L,t)=0$。\n- 通过将控制方程乘以一个容许测试函数并进行必要的分部积分，以避免在试探/测试空间上出现四阶导数，从而推导出弱形式。由此产生的双线性形式必须分别定义单元刚度矩阵和质量矩阵：\n  - 刚度双线性形式应涉及试探函数和测试函数的二阶空间导数。\n  - 质量双线性形式应涉及试探函数和测试函数本身。\n- 在每个单元上构建一个多项式阶数 $p=4$ 的一维 $C^1$ 谱梁单元。单元近似必须：\n  - 在每个单元端点包含位移和转角（斜率）的节点自由度，以满足 $C^1$ 单元间连续性。\n  - 用一个阶数为 $4$ 的内部层级模态（气泡函数）来增强三次 Hermite 节点基。该气泡函数及其一阶导数在两个单元端点处均为零，从而实现 $p=4$ 的谱单元。不得先验地假设内部模态的具体公式；它必须从第一性原理推导得出，以满足所述的端点值为零的条件。\n- 使用仿射映射将每个长度为 $\\ell$ 的物理单元映射到参考坐标 $z \\in [0,1]$。确保使用链式法则将所有关于 $x$ 的导数正确地表示为关于 $z$ 的导数。您的实现必须使用足够阶数的 Gauss–Legendre 求积法，对由基函数所隐含阶数内的多项式进行精确积分，以计算单元矩阵。\n- 组装具有 $N_e$ 个单元的均匀网格的全局质量矩阵和刚度矩阵，并通过消除与 $w(0)$ 和 $\\partial w/\\partial x (0)$ 相关的相应全局自由度，在 $x=0$ 处施加固支边界条件。\n\n解析参考：\n- 对于均匀的 Euler–Bernoulli 悬臂梁，解析的无量纲波数 $\\alpha_n$ 是超越方程 $\\cosh(\\alpha)\\cos(\\alpha)+1=0$ 的正根，该方程必须通过数值方法求解。精确的角频率为\n$$\n\\omega_n \\;=\\; \\frac{\\alpha_n^2}{L^2}\\,\\sqrt{\\frac{E I}{\\rho A}}.\n$$\n您必须为每个测试案例计算前两个值 $ \\omega_1 $ 和 $ \\omega_2 $，单位为弧度/秒。\n\n数值任务：\n- 构建广义、对称、正定特征值问题\n$$\n\\mathbf{K} \\mathbf{u} \\;=\\; \\lambda\\, \\mathbf{M} \\mathbf{u},\n$$\n其中 $ \\lambda = \\omega^2 $。计算两个最小的正特征值，将它们转换为角频率 $ \\omega $（单位：弧度/秒），并与解析值进行比较。\n\n测试套件与所需输出：\n对于下面的每一组参数，使用如上定义的 $p=4$ 谱单元，并计算前两种模态的数值角频率与解析角频率之间的绝对相对误差（以小数形式表示，而非百分比）：\n$$\n\\varepsilon_n \\;=\\; \\frac{\\lvert \\omega_n^{\\text{num}} - \\omega_n^{\\text{exact}} \\rvert}{\\omega_n^{\\text{exact}}}.\n$$\n所有物理答案必须以国际单位制 (SI units) 表示。您的程序的输出必须是单行文本，包含一个扁平的、逗号分隔的列表，内含六个误差值，按案例和模态顺序排列，并用方括号括起来，每个数字四舍五入到恰好 $8$ 位小数。\n\n测试案例：\n- 案例 1：$E = 210 \\times 10^{9}\\,\\mathrm{Pa}$，$\\rho = 7800\\,\\mathrm{kg/m^3}$，矩形横截面，宽度 $b = 0.01\\,\\mathrm{m}$，高度 $h = 0.01\\,\\mathrm{m}$，因此 $A = b h$ 且 $I = b h^3 / 12$，梁长 $L = 1.0\\,\\mathrm{m}$，单元数 $N_e = 1$。\n- 案例 2：与案例 1 相同的材料和横截面，但 $L = 1.0\\,\\mathrm{m}$，单元数 $N_e = 2$。\n- 案例 3：$E = 70 \\times 10^{9}\\,\\mathrm{Pa}$，$\\rho = 2700\\,\\mathrm{kg/m^3}$，矩形横截面，宽度 $b = 0.02\\,\\mathrm{m}$，高度 $h = 0.01\\,\\mathrm{m}$，$A = b h$，$I = b h^3 / 12$，梁长 $L = 2.0\\,\\mathrm{m}$，单元数 $N_e = 3$。\n\n最终输出格式：\n- 您的程序应只产生一行输出，包含列表\n$[\\varepsilon_{1}^{(1)},\\varepsilon_{2}^{(1)},\\varepsilon_{1}^{(2)},\\varepsilon_{2}^{(2)},\\varepsilon_{1}^{(3)},\\varepsilon_{2}^{(3)}]$\n其中每个条目四舍五入到 $8$ 位小数，不含任何额外文本。", "solution": "所提出的问题是计算结构动力学中的一个标准、适定问题。它要求实现一种特定的有限元法 (FEM)，以确定悬臂梁的自然频率，并根据已知的解析解评估其精度。所有给定条件在科学上都是合理的、一致的，并且足以构建一个唯一的解。因此，该问题是有效的。\n\n该解法从控制物理原理到数值实现，系统地进行。\n\n**1. 控制方程与弱形式**\n\n均匀 Euler-Bernoulli 梁的自由、无阻尼横向振动由以下偏微分方程控制：\n$$\n\\rho A \\frac{\\partial^2 w(x,t)}{\\partial t^2} + E I \\frac{\\partial^4 w(x,t)}{\\partial x^4} = 0\n$$\n其中 $w(x,t)$ 是横向位移，$x$ 是沿梁长 $L$ 的空间坐标，$t$ 是时间，$\\rho$ 是材料密度，$A$ 是横截面积，$E$ 是杨氏模量，$I$ 是横截面的面积二次矩。\n\n我们寻求 $w(x,t) = W(x) e^{i \\omega t}$ 形式的谐波解，其中 $W(x)$ 是振型，$\\omega$ 是角频率。将此代入控制方程，得到一个关于振型的常微分方程：\n$$\nE I \\frac{d^4 W(x)}{dx^4} - \\rho A \\omega^2 W(x) = 0\n$$\n为了推导弱形式，我们用一个来自合适的容许函数空间的任意测试函数 $v(x)$ 乘以该方程，并在梁长 $L$ 上积分：\n$$\n\\int_0^L v \\left( E I \\frac{d^4 W}{dx^4} - \\rho A \\omega^2 W \\right) dx = 0\n$$\n容许函数空间是足够光滑且满足本质 (Dirichlet) 边界条件的函数集合。对于在 $x=0$ 处固支的悬臂梁，这些条件是 $W(0)=0$ 和 $W'(0)=0$。因此，$v(0)=0$ 和 $v'(0)=0$。\n\n将第一项进行两次分部积分，将导数从试探函数 $W(x)$ 转移到测试函数 $v(x)$：\n$$\n\\int_0^L E I \\frac{d^2 v}{dx^2} \\frac{d^2 W}{dx^2} dx - \\left[ v E I \\frac{d^3 W}{dx^3} \\right]_0^L + \\left[ \\frac{dv}{dx} E I \\frac{d^2 W}{dx^2} \\right]_0^L - \\omega^2 \\int_0^L \\rho A v W dx = 0\n$$\n由于测试函数 $v$ 上的本质边界条件，在 $x=0$ 处的边界项消失。在自由端 $x=L$ 处的自然边界条件是弯矩和剪力为零，即 $E I W''(L)=0$ 和 $E I W'''(L)=0$。这些条件也使得在 $x=L$ 处的边界项消失。\n\n得到的弱形式是：寻找 $(\\omega^2, W)$，使得对于所有容许的 $v$，\n$$\n\\int_0^L E I v'' W'' dx = \\omega^2 \\int_0^L \\rho A v W dx\n$$\n这定义了一个广义特征值问题，其中刚度双线性形式为 $k(v,W) = \\int_0^L E I v'' W'' dx$，质量双线性形式为 $m(v,W) = \\int_0^L \\rho A v W dx$。\n\n**2. 参考单元上的有限元离散化**\n\n问题指定了一个多项式阶数 $p=4$ 的 $C^1$ 谱单元。这是通过用一个阶数为 $4$ 的层级气泡函数来增强标准的三次 Hermite 基而构建的。一个物理长度为 $\\ell_e$ 的单元通过仿射映射 $x(z) = x_1 + \\ell_e z$ 映射到一个坐标为 $z \\in [0,1]$ 的参考单元上，其中 $x_1$ 是物理单元的起始坐标。链式法则给出了导数之间的关系：$d/dx = (1/\\ell_e) d/dz$ 和 $d^2/dx^2 = (1/\\ell_e^2) d^2/dz^2$。\n\n局部位移场 $W^e(z)$ 使用对应于五个自由度 (DOFs) 的五个基函数进行插值：起始节点 ($z=0$) 处的位移 $w_1$ 和转角 $\\theta_1$，结束节点 ($z=1$) 处的位移 $w_2$ 和转角 $\\theta_2$，以及一个内部层级系数 $a_1$。\n插值为：\n$$\nW^e(z) = \\mathbf{N}(z,\\ell_e) \\mathbf{d}^e = H_1(z)w_1 + \\ell_e H_2(z)\\theta_1 + H_3(z)w_2 + \\ell_e H_4(z)\\theta_2 + H_5(z)a_1\n$$\n其中 $\\mathbf{d}^e = [w_1, \\theta_1, w_2, \\theta_2, a_1]^T$ 是单元自由度向量。基函数为：\n-   **三次 Hermite 基函数 ($p=3$)**：这些确保了单元间的 $C^1$ 连续性。\n    $H_1(z) = 2z^3 - 3z^2 + 1$\n    $H_2(z) = z^3 - 2z^2 + z$\n    $H_3(z) = -2z^3 + 3z^2$\n    $H_4(z) = z^3 - z^2$\n-   **四次气泡函数 ($p=4$)**：此函数及其一阶导数在单元节点 ($z=0, 1$) 处为零，确保了基函数的层级性质。\n    $H_5(z) = z^2(1-z)^2 = z^4 - 2z^3 + z^2$\n\n**3. 单元刚度矩阵和质量矩阵**\n\n将有限元近似代入双线性形式，并将积分变量更改为参考坐标 $z$，我们得到单元刚度矩阵 $\\mathbf{K}^e$ 和质量矩阵 $\\mathbf{M}^e$。\n$$\n\\mathbf{K}^e_{ij} = \\int_{x_1}^{x_1+\\ell_e} E I \\frac{d^2 N_i}{dx^2} \\frac{d^2 N_j}{dx^2} dx_e\n\\quad , \\quad\n\\mathbf{M}^e_{ij} = \\int_{x_1}^{x_1+\\ell_e} \\rho A N_i N_j dx_e\n$$\n使用坐标变换，这些可以写成包含与单元属性无关的参考矩阵的因式形式：\n$$\n\\mathbf{K}^e = \\frac{EI}{\\ell_e^3} \\mathbf{L}_{\\ell_e} \\mathbf{K}_{\\text{ref}} \\mathbf{L}_{\\ell_e}\n\\quad , \\quad\n\\mathbf{M}^e = \\rho A \\ell_e \\mathbf{L}_{\\ell_e} \\mathbf{M}_{\\text{ref}} \\mathbf{L}_{\\ell_e}\n$$\n其中 $\\mathbf{L}_{\\ell_e} = \\text{diag}([1, \\ell_e, 1, \\ell_e, 1])$。参考矩阵通过在 $z \\in [0,1]$ 上积分计算得出：\n$$\n(\\mathbf{K}_{\\text{ref}})_{ij} = \\int_0^1 H_i''(z) H_j''(z) dz\n\\quad , \\quad\n(\\mathbf{M}_{\\text{ref}})_{ij} = \\int_0^1 H_i(z) H_j(z) dz\n$$\n这里我们将 $H_i$ 定义为不带 $\\ell_e$ 缩放的 $z$ 的多项式。$\\mathbf{K}_{\\text{ref}}$ 的被积函数中的最高多项式阶数为 $(4-2)+(4-2)=4$，对于 $\\mathbf{M}_{\\text{ref}}$ 则为 $4+4=8$。要精确积分这些，需要一个至少有 $\\lceil(8+1)/2\\rceil = 5$ 个点的 Gauss-Legendre 求积法则。\n\n**4. 系统组装和边界条件**\n\n全局刚度矩阵 $\\mathbf{K}$ 和质量矩阵 $\\mathbf{M}$ 是通过根据全局自由度编号对每个单元矩阵 $\\mathbf{K}^e$ 和 $\\mathbf{M}^e$ 的贡献进行求和来组装的。对于一个有 $N_e$ 个单元的网格，有 $N_e+1$ 个节点和 $N_e$ 个内部自由度，总共产生 $2(N_e+1) + N_e = 3N_e+2$ 个自由度。\n\n在 $x=0$ 处的悬臂梁边界条件（$w(0)=0$, $w'(0)=0$）是通过从 $\\mathbf{K}$ 和 $\\mathbf{M}$ 中消除对应于前两个全局自由度的行和列来施加的。这会产生简化的、非奇异的矩阵 $\\mathbf{K}_{\\text{red}}$ 和 $\\mathbf{M}_{\\text{red}}$。\n\n**5. 特征值问题的求解**\n\n系统被简化为广义对称特征值问题：\n$$\n\\mathbf{K}_{\\text{red}} \\mathbf{u}_{\\text{red}} = \\lambda \\mathbf{M}_{\\text{red}} \\mathbf{u}_{\\text{red}}\n$$\n其中 $\\lambda = \\omega^2$。此问题通过数值方法求解特征值 $\\lambda_n$。最小的两个正特征值 $\\lambda_1$ 和 $\\lambda_2$ 给出了前两个自然角频率的平方：$\\omega_n^{\\text{num}} = \\sqrt{\\lambda_n}$。\n\n**6. 解析解和误差计算**\n\n均匀悬臂梁的精确角频率由下式给出：\n$$\n\\omega_n^{\\text{exact}} = \\frac{\\alpha_n^2}{L^2} \\sqrt{\\frac{E I}{\\rho A}}\n$$\n其中 $\\alpha_n$ 是超越方程 $\\cosh(\\alpha)\\cos(\\alpha)+1=0$ 的正根。这些根必须使用数值求根算法找到。前两个根近似为 $\\alpha_1 \\approx 1.875104$ 和 $\\alpha_2 \\approx 4.694091$。\n\n数值解的精度通过每种模态的绝对相对误差来量化：\n$$\n\\varepsilon_n = \\frac{|\\omega_n^{\\text{num}} - \\omega_n^{\\text{exact}}|}{\\omega_n^{\\text{exact}}}\n$$\n以下程序为指定的测试套件实现了这整个过程。", "answer": "[0.00000003,0.00000109,0.00000000,0.00000001,0.00000000,0.00000000]", "id": "2562466"}]}