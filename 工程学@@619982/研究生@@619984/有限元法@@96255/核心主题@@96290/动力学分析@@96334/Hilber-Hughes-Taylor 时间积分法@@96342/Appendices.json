{"hands_on_practices": [{"introduction": "在深入学习 HHT-α 方法之前，掌握其基础——Newmark 族方法——的特性至关重要。本练习 [@problem_id:2564542] 旨在通过对比分析 Newmark 族中两种经典方法（平均加速度法和线性加速度法），引导你亲手推导它们的周期误差和稳定性。通过这个过程，你将深刻理解数值精度与稳定性之间的内在权衡，并认识到为何需要发展像 HHT-α 这样能够引入可控数值阻尼的先进算法。", "problem": "考虑通过有限元方法得到的无阻尼单自由度半离散结构动力学模型：$m \\ddot{u}(t) + k u(t) = 0$，其自然圆频率为 $\\omega = \\sqrt{k/m}$。时间积分采用标准形式的 Newmark 族方法，其参数为 $(\\beta,\\gamma)$\n- $u_{n+1} = u_n + \\Delta t\\, v_n + \\Delta t^2 \\left[\\left(\\tfrac{1}{2} - \\beta\\right) a_n + \\beta a_{n+1}\\right]$,\n- $v_{n+1} = v_n + \\Delta t \\left[(1 - \\gamma) a_n + \\gamma a_{n+1}\\right]$,\n其中 $a_n = \\ddot{u}_n$。对于无阻尼振子，有 $a_n = -\\omega^2 u_n$。\n\n重点讨论 $\\gamma = 1/2$ 的情况，并比较 $(\\beta,\\gamma) = (1/4,\\,1/2)$ 和 $(\\beta,\\gamma) = (1/6,\\,1/2)$ 这两种选择。令 $h := \\omega \\Delta t$。通过寻找 $u_n = \\Re\\{\\hat{u}\\, r^n\\}$ 形式（其中 $r = e^{i \\Omega \\Delta t}$）的非平凡解来定义数值（离散）频率 $\\Omega$。\n\n从控制方程和 Newmark 更新法则出发，基于第一性原理推导每种格式的数值周期误差在小 $h$ 情况下的主阶行为，即 $T = 2\\pi/\\omega$ 与 $T_{\\text{num}} = 2\\pi/\\Omega$ 之间的相对误差，然后用它来估计在 $h = 1$ 时的相对周期误差。根据你的分析，以及从 $r$ 的放大关系得出的稳定性和耗散特性，判断下列哪些陈述是正确的。选择所有适用项。\n\nA. 在 $h = 1$ 时，对于无阻尼振子，$(\\beta,\\gamma) = (1/4,\\,1/2)$ 和 $(\\beta,\\gamma) = (1/6,\\,1/2)$ 都是非耗散的，并且 $(\\beta,\\gamma) = (1/6,\\,1/2)$ 的周期伸长大约是 $(1/4,\\,1/2)$ 的一半。\n\nB. 即使对于无阻尼振子，选择 $(\\beta,\\gamma) = (1/6,\\,1/2)$ 也会引入算法阻尼（振幅衰减）。\n\nC. 对于 $(\\beta,\\gamma) = (1/6,\\,1/2)$，主阶相对周期误差的阶为 $\\mathcal{O}(h^4)$，而对于 $(1/4,\\,1/2)$，其阶为 $\\mathcal{O}(h^2)$。\n\nD. Hilber-Hughes-Taylor 方法（常记为 $\\alpha$-方法）通过取 $\\alpha \\in (-1/3,\\,0]$ 以及 $\\gamma = 1/2 - \\alpha$ 和 $\\beta = \\tfrac{1}{4}(1 - \\alpha)^2$，实现了二阶精度和可调的高频数值耗散。\n\nE. $(\\beta,\\gamma) = (1/4,\\,1/2)$ 和 $(\\beta,\\gamma) = (1/6,\\,1/2)$ 对于任何 $h$ 都是无条件稳定的，因为 $\\gamma = 1/2$ 消除了不稳定性。\n\nF. 对于 $h = 4$，$(\\beta,\\gamma) = (1/6,\\,1/2)$ 是不稳定的，而 $(\\beta,\\gamma) = (1/4,\\,1/2)$ 保持稳定。\n\n特别讨论周期精度和数值耗散之间的权衡，以及引入 Hilber-Hughes-Taylor 参数如何在保持低频精度的同时影响高频内容。", "solution": "问题陈述在科学上是合理的、自洽的且提法得当。它对用于单自由度无阻尼振子的 Newmark 时间积分族进行了标准分析，这是计算结构动力学中的一个基本课题。所有给出的定义和方程都是标准的。我们可以开始求解。\n\n问题要求分析用于半离散运动方程的 Newmark 积分格式：\n$$m \\ddot{u}(t) + k u(t) = 0$$\n令 $\\omega = \\sqrt{k/m}$ 为自然圆频率。方程变为 $\\ddot{u}(t) + \\omega^2 u(t) = 0$。对于数值格式，我们在离散时间步上强制执行此方程，因此有 $a_n = -\\omega^2 u_n$ 和 $a_{n+1} = -\\omega^2 u_{n+1}$，其中 $u_n = u(t_n)$ 和 $a_n = \\ddot{u}(t_n)$。\n\nNewmark 更新法则由下式给出：\n$$u_{n+1} = u_n + \\Delta t\\, v_n + \\Delta t^2 \\left[\\left(\\tfrac{1}{2} - \\beta\\right) a_n + \\beta a_{n+1}\\right]$$\n$$v_{n+1} = v_n + \\Delta t \\left[(1 - \\gamma) a_n + \\gamma a_{n+1}\\right]$$\n\n我们将 $a_n = -\\omega^2 u_n$ 和 $a_{n+1} = -\\omega^2 u_{n+1}$ 代入更新法则。令 $h = \\omega \\Delta t$。\n$$u_{n+1} = u_n + \\Delta t\\, v_n - \\Delta t^2 \\omega^2 \\left(\\tfrac{1}{2} - \\beta\\right) u_n - \\Delta t^2 \\omega^2 \\beta u_{n+1}$$\n$$u_{n+1}(1 + \\beta h^2) = u_n(1 - (\\tfrac{1}{2} - \\beta)h^2) + \\Delta t v_n$$\n$$v_{n+1} = v_n - \\Delta t \\omega^2 (1 - \\gamma) u_n - \\Delta t \\omega^2 \\gamma u_{n+1}$$\n$$\\Delta t v_{n+1} = \\Delta t v_n - h^2 (1 - \\gamma) u_n - h^2 \\gamma u_{n+1}$$\n\n令状态向量为 $\\mathbf{d}_n = \\{u_n, \\Delta t v_n\\}^T$。更新可以写成矩阵形式 $\\mathbf{M}_L \\mathbf{d}_{n+1} = \\mathbf{M}_R \\mathbf{d}_n$：\n$$\n\\begin{pmatrix} 1 + \\beta h^2 & 0 \\\\ \\gamma h^2 & 1 \\end{pmatrix}\n\\begin{pmatrix} u_{n+1} \\\\ \\Delta t v_{n+1} \\end{pmatrix}\n=\n\\begin{pmatrix} 1 - (\\tfrac{1}{2} - \\beta)h^2 & 1 \\\\ -h^2(1 - \\gamma) & 1 \\end{pmatrix}\n\\begin{pmatrix} u_n \\\\ \\Delta t v_n \\end{pmatrix}\n$$\n放大矩阵 $\\mathbf{A}$ 由 $\\mathbf{A} = \\mathbf{M}_L^{-1} \\mathbf{M}_R$ 给出。\n$$\n\\mathbf{M}_L^{-1} = \\frac{1}{1 + \\beta h^2} \\begin{pmatrix} 1 & 0 \\\\ -\\gamma h^2 & 1 + \\beta h^2 \\end{pmatrix}\n$$\n$$\n\\mathbf{A} = \\frac{1}{1 + \\beta h^2} \\begin{pmatrix} 1 & 0 \\\\ -\\gamma h^2 & 1 + \\beta h^2 \\end{pmatrix}\n\\begin{pmatrix} 1 - (\\tfrac{1}{2} - \\beta)h^2 & 1 \\\\ -h^2(1 - \\gamma) & 1 \\end{pmatrix}\n= \\frac{1}{D}\n\\begin{pmatrix}\n1 - (\\tfrac{1}{2} - \\beta)h^2 & 1 \\\\\n-\\gamma h^2(1 - (\\tfrac{1}{2} - \\beta)h^2) - (1-\\gamma)h^2(1 + \\beta h^2) & -\\gamma h^2 + 1 + \\beta h^2\n\\end{pmatrix}\n$$\n其中 $D = 1 + \\beta h^2$。左下角的元素可简化为 $-h^2(1+(\\beta-\\frac{\\gamma}{2})h^2)$。\n所以，\n$$\n\\mathbf{A} = \\frac{1}{1+\\beta h^2}\n\\begin{pmatrix}\n1 - (\\tfrac{1}{2} - \\beta)h^2 & 1 \\\\\n-h^2(1+(\\beta-\\tfrac{\\gamma}{2})h^2) & 1+(\\beta-\\gamma)h^2\n\\end{pmatrix}\n$$\n$\\mathbf{A}$ 的特征值 $r$ 决定了数值解的特性。它们是特征方程 $r^2 - (\\text{tr}\\mathbf{A})r + \\det\\mathbf{A} = 0$ 的根。\n\n问题要求重点讨论 $\\gamma = 1/2$。\n对于 $\\gamma=1/2$，迹为：\n$$ \\text{tr}\\mathbf{A} = \\frac{1 - (\\tfrac{1}{2} - \\beta)h^2 + 1 + (\\beta - \\tfrac{1}{2})h^2}{1 + \\beta h^2} = \\frac{2 - (1 - 2\\beta)h^2}{1 + \\beta h^2} $$\n行列式为：\n$$ \\det\\mathbf{A} = \\frac{(1 - (\\tfrac{1}{2} - \\beta)h^2)(1 - (\\tfrac{1}{2} - \\beta)h^2) + h^2(1+(\\beta-\\tfrac{1}{4})h^2)}{(1+\\beta h^2)^2} $$\n这似乎太复杂了。我们重新检查一下第一次推导的 $\\det(\\mathbf{A})$。对于 $\\gamma=1/2$, $D^2 \\det(\\mathbf{A}) = (1+\\beta h^2)^2=D^2$。因此，对于 $\\gamma=1/2$，$\\det(\\mathbf{A}) = 1$。这意味着该方法是非耗散的（它在离散意义上守恒能量，因此振幅是恒定的）。\n\n特征值为 $r = e^{\\pm i \\Omega \\Delta t}$，其中 $\\Omega$ 是数值频率。根据特征方程，$r+\\bar{r} = 2\\cos(\\Omega \\Delta t) = \\text{tr}\\mathbf{A}$。\n$$ \\cos(\\Omega \\Delta t) = \\frac{1}{2}\\text{tr}\\mathbf{A} = \\frac{1 - \\frac{1}{2}(1 - 2\\beta)h^2}{1 + \\beta h^2} $$\n为保证稳定性，特征值必须位于单位圆上或其内部。由于当 $\\gamma=1/2$ 时（如果根是复数），特征值位于单位圆上，因此稳定性要求 $|\\text{tr}\\mathbf{A}| \\le 2$。如果 $4\\beta \\ge 1$，此条件导致无条件稳定；如果 $4\\beta < 1$，则为有条件稳定，稳定条件为 $h^2(1-4\\beta) < 4$。\n\n现在我们分析两种 $\\gamma=1/2$ 的具体格式。\n\n情况1：$(\\beta, \\gamma) = (1/4, 1/2)$（平均加速度法/梯形法则）\n由于 $\\beta=1/4$，条件 $4\\beta \\ge 1$ 得到满足（$1 \\ge 1$），因此该方法是无条件稳定的。\n$$ \\cos(\\Omega \\Delta t) = \\frac{1 - \\frac{1}{2}(1 - 2/4)h^2}{1 + h^2/4} = \\frac{1 - h^2/4}{1 + h^2/4} $$\n为了求周期误差，我们使用恒等式 $\\tan^2(x/2) = (1-\\cos x)/(1+\\cos x)$。\n$$ \\tan^2\\left(\\frac{\\Omega \\Delta t}{2}\\right) = \\frac{1 - \\frac{1 - h^2/4}{1 + h^2/4}}{1 + \\frac{1 - h^2/4}{1 + h^2/4}} = \\frac{(1+h^2/4) - (1-h^2/4)}{(1+h^2/4)+(1-h^2/4)} = \\frac{h^2/2}{2} = \\frac{h^2}{4} $$\n取平方根，得到 $\\tan(\\frac{\\Omega \\Delta t}{2}) = \\frac{h}{2}$。\n展开 $\\arctan(x) = x - x^3/3 + \\dots$：\n$$ \\frac{\\Omega \\Delta t}{2} = \\arctan\\left(\\frac{h}{2}\\right) = \\frac{h}{2} - \\frac{1}{3}\\left(\\frac{h}{2}\\right)^3 + O(h^5) = \\frac{h}{2} - \\frac{h^3}{24} + O(h^5) $$\n$$ \\frac{\\Omega}{\\omega} = \\frac{\\Omega \\Delta t}{h} = 1 - \\frac{h^2}{12} + O(h^4) $$\n相对周期误差为 $\\frac{T_{\\text{num}} - T}{T} = \\frac{\\omega}{\\Omega} - 1 = \\left(1 - \\frac{h^2}{12}\\right)^{-1} - 1 = 1 + \\frac{h^2}{12} + O(h^4) - 1 = \\frac{h^2}{12} + O(h^4)$。\n误差阶为 $\\mathcal{O}(h^2)$ 且为正，表明存在数值周期伸长。\n\n情况2：$(\\beta, \\gamma) = (1/6, 1/2)$（线性加速度法）\n由于 $\\beta=1/6$, $4\\beta=4/6=2/3 < 1$。该方法是有条件稳定的。稳定极限为 $h^2(1-2/3) < 4$，即 $h^2 < 12$，所以 $h < \\sqrt{12} \\approx 3.46$。\n$$ \\cos(\\Omega \\Delta t) = \\frac{1 - \\frac{1}{2}(1 - 2/6)h^2}{1 + h^2/6} = \\frac{1 - h^2/3}{1 + h^2/6} $$\n$$ \\tan^2\\left(\\frac{\\Omega \\Delta t}{2}\\right) = \\frac{1 - \\frac{1 - h^2/3}{1 + h^2/6}}{1 + \\frac{1 - h^2/3}{1 + h^2/6}} = \\frac{(1+h^2/6) - (1-h^2/3)}{(1+h^2/6) + (1-h^2/3)} = \\frac{h^2/2}{2 - h^2/6} = \\frac{h^2}{4 - h^2/3} $$\n对于小 $h$，$\\tan(\\frac{\\Omega \\Delta t}{2}) \\approx \\frac{h/2}{\\sqrt{1-h^2/12}} \\approx \\frac{h}{2}(1 + \\frac{h^2}{24})$。\n$$ \\frac{\\Omega \\Delta t}{2} = \\arctan\\left(\\frac{h}{2}\\left(1 + \\frac{h^2}{24}\\right)\\right) = \\left(\\frac{h}{2}+\\frac{h^3}{48}\\right) - \\frac{1}{3}\\left(\\frac{h}{2}\\right)^3 + O(h^5) = \\frac{h}{2} - \\frac{h^3}{48} + O(h^5) $$\n$$ \\frac{\\Omega}{\\omega} = \\frac{\\Omega \\Delta t}{h} = 1 - \\frac{h^2}{24} + O(h^4) $$\n相对周期误差为 $\\frac{T_{\\text{num}} - T}{T} = \\frac{\\omega}{\\Omega} - 1 = \\frac{h^2}{24} + O(h^4)$。\n误差阶也为 $\\mathcal{O}(h^2)$ 并表明有周期伸长，但其主误差系数是平均加速度法的一半。\n\n现在我们逐一评估每个陈述。\n\nA. 在 $h = 1$ 时，对于无阻尼振子，$(\\beta,\\gamma) = (1/4,\\,1/2)$ 和 $(\\beta,\\gamma) = (1/6,\\,1/2)$ 都是非耗散的，并且 $(\\beta,\\gamma) = (1/6,\\,1/2)$ 的周期伸长大约是 $(1/4,\\,1/2)$ 的一半。\n- 如前所示，$\\gamma=1/2$ 意味着 $\\det\\mathbf{A}=1$，所以两种格式都是非耗散的。\n- $(\\beta,\\gamma)=(1/6,1/2)$ 的主阶周期误差为 $h^2/24$，正好是 $(\\beta,\\gamma)=(1/4,1/2)$ 的 $h^2/12$ 的一半。对于 $h=1$，小 $h$ 近似表明前者的误差是后者的一半。我们来直接计算：\n  - 对于 $(\\beta,\\gamma)=(1/4,1/2)$，$\\cos(\\Omega \\Delta t) = (1-1/4)/(1+1/4)=3/5$。$\\Omega \\Delta t = \\arccos(3/5) \\approx 0.9273$。相对误差 $\\frac{T_{num}}{T}-1 = \\frac{\\omega}{\\Omega}-1 = \\frac{h}{\\Omega \\Delta t}-1 = \\frac{1}{0.9273}-1 \\approx 0.0784$。\n  - 对于 $(\\beta,\\gamma)=(1/6,1/2)$，$\\cos(\\Omega \\Delta t) = (1-1/3)/(1+1/6)=(2/3)/(7/6)=4/7$。$\\Omega \\Delta t = \\arccos(4/7) \\approx 0.9626$。相对误差 $\\frac{1}{0.9626}-1 \\approx 0.0388$。\n  比值 $0.0388/0.0784 \\approx 0.495$，确实是“大约一半”。\n- 结论：正确。\n\nB. 即使对于无阻尼振子，选择 $(\\beta,\\gamma) = (1/6,\\,1/2)$ 也会引入算法阻尼（振幅衰减）。\n- 这是错误的。算法阻尼由放大矩阵的行列式控制，或者更一般地，由谱半径 $\\rho(\\mathbf{A})$ 控制。对于 $\\gamma=1/2$，$\\det(\\mathbf{A})=1$，并且在稳定极限内，特征值位于单位圆上，意味着 $\\rho(\\mathbf{A})=1$。没有振幅衰减。引入阻尼需要 $\\gamma > 1/2$。\n- 结论：不正确。\n\nC. 对于 $(\\beta,\\gamma) = (1/6,\\,1/2)$，主阶相对周期误差的阶为 $\\mathcal{O}(h^4)$，而对于 $(1/4,\\,1/2)$，其阶为 $\\mathcal{O}(h^2)$。\n- 这是错误的。如上推导，两种格式的主阶相对周期误差阶都为 $\\mathcal{O}(h^2)$。只是常数因子不同（$1/24$ vs $1/12$）。一个具有四阶周期精度的方法是 Fox-Goodwin 方法，其参数为 $(\\beta,\\gamma) = (1/12, 1/2)$。\n- 结论：不正确。\n\nD. Hilber-Hughes-Taylor 方法（常记为 $\\alpha$-方法）通过取 $\\alpha \\in (-1/3,\\,0]$ 以及 $\\gamma = 1/2 - \\alpha$ 和 $\\beta = \\tfrac{1}{4}(1 - \\alpha)^2$，实现了二阶精度和可调的高频数值耗散。\n- 这是关于 HHT-$\\alpha$ 方法的一个事实陈述。该方法旨在引入数值耗散来阻尼高频模态，同时为低频模态保持二阶精度。参数关系 $\\gamma = 1/2 - \\alpha$ 和 $\\beta = \\frac{1}{4}(1 - \\alpha)^2$ 正是实现这一目标所必需的。当 $\\alpha \\in [-1/3, 0]$ 时，从 0 开始减小 $\\alpha$ 会增加高频耗散。$\\alpha=0$ 则恢复为非耗散的梯形法则。该陈述是对这种广泛使用的方法特性的正确总结。\n- 结论：正确。\n\nE. $(\\beta,\\gamma) = (1/4,\\,1/2)$ 和 $(\\beta,\\gamma) = (1/6,\\,1/2)$ 对于任何 $h$ 都是无条件稳定的，因为 $\\gamma = 1/2$ 消除了不稳定性。\n- 这是错误的。虽然 $(\\beta,\\gamma)=(1/4,1/2)$ 是无条件稳定的，但 $(\\beta,\\gamma)=(1/6,1/2)$ 仅在 $h < \\sqrt{12}$ 时是有条件稳定的。给出的原因也是错误的；$\\gamma=1/2$ 消除的是数值耗散，它不保证稳定性。对于 $\\gamma=1/2$，稳定性是由 $\\beta$ 决定的。\n- 结论：不正确。\n\nF. 对于 $h = 4$，$(\\beta,\\gamma) = (1/6,\\,1/2)$ 是不稳定的，而 $(\\beta,\\gamma) = (1/4,\\,1/2)$ 保持稳定。\n- 格式 $(\\beta,\\gamma)=(1/4,1/2)$ 是无条件稳定的，因此它对任何 $h$ 都稳定，包括 $h=4$。\n- 格式 $(\\beta,\\gamma)=(1/6,1/2)$ 的稳定极限是 $h < \\sqrt{12} \\approx 3.46$。由于 $h=4 > 3.46$，该方法是不稳定的。\n- 因此，该陈述是正确的。\n- 结论：正确。\n\n关于权衡和 HHT 方法的讨论：\n分析揭示了数值时间积分中的一个基本权衡。比较这里的两种主要格式，线性加速度法 $(\\beta=1/6, \\gamma=1/2)$ 比平均加速度法 $(\\beta=1/4, \\gamma=1/2)$ 提供了更优的周期精度，其主阶误差减半。然而，这是以牺牲无条件稳定性为代价的。平均加速度法对于任何时间步长 $\\Delta t$ 都是鲁棒稳定的，但在周期精度上较差。在许多应用中，特别是涉及具有宽频率范围的刚性系统时，无条件稳定性至关重要。\n\n这两种格式都不提供数值耗散，而数值耗散通常是需要的，用以抑制多自由度系统中由空间离散化引起的伪高频振荡。HHT-$\\alpha$ 方法（以及类似的 generalized-$\\alpha$ 方法）提供了一个解决方案。通过选择 $\\alpha < 0$，我们得到 $\\gamma = 1/2-\\alpha > 1/2$，从而引入了耗散。参数的特定选择确保了这种耗散主要影响高频（大 $h$），同时保持二阶精度，这意味着低频响应（小 $h$）保持高度准确。这使得工程师们能够为主要的结构模态获得精确解，同时滤除非物理的高频噪声。这代表了一种更复杂的权衡，平衡了精度、稳定性和耗散。", "answer": "$$\\boxed{ADF}$$", "id": "2564542"}, {"introduction": "HHT-α 方法的一个核心应用是抑制有限元空间离散化带来的伪高频振荡。本练习 [@problem_id:2564581] 正是围绕这一应用场景展开，要求你根据问题的物理特性，从第一性原理出发，判断如何选择参数 $α$ 以达到最佳的阻尼效果。完成这个练习将帮助你掌握 HHT-α 方法的精髓：如何利用 $α$ 参数精确调控数值阻尼，在有效滤除高频噪声的同时，最大限度地保证物理相关低频响应的精度。", "problem": "考虑由有限元法 (FEM) 产生的无阻尼线性半离散结构动力学模型：\n$$\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{0},$$\n其中质量矩阵 $\\mathbf{M}$ 和刚度矩阵 $\\mathbf{K}$ 均为对称正定矩阵。您使用参数为 $\\alpha$ 的 Hilber-Hughes-Taylor (HHT) 方法在时间上进行离散，在混合时间点 $t_{n+1+\\alpha}$ 处强制平衡，并通过 Newmark 型格式更新运动学。假设时间步长 $\\Delta t$ 是固定的，并且网格的特性使得高频数值伪影主要由空间离散（例如，未能充分解析的局部模态）引起，而非真实的物理刚度。\n\n从第一性原理的角度出发，仅使用线性振子的基本性质和 HHT 族方法的标准一致性/稳定性结论，评估应如何选择 $\\alpha$ 以便选择性地阻尼虚假的高频成分，同时保持物理相关的中低频响应的保真度。特别地，回想以下几点：\n- 对于无阻尼线性系统，精确的机械能是守恒的。\n- 当 $\\alpha = 0$ 时，HHT 方法退化为平均加速度 Newmark 格式。\n- 对于根据 $\\alpha$ 选择的适当 $(\\beta,\\gamma)$，HHT 方法在 $\\alpha$ 处于某个容许区间内是二阶精确且无条件稳定的。\n\n在所述条件下，以下哪项关于选择 $\\alpha$ 的指导原则最为合适？\n\nA. 选择一个适度的负值 $\\alpha$，例如 $\\alpha \\in \\left[-0.2,-0.05\\right]$，并将 Newmark 参数设置为 $\\gamma = \\tfrac{1}{2} - \\alpha$ 和 $\\beta = \\tfrac{1}{4}\\left(1 - \\alpha\\right)^2$。这样做可以保持二阶精度，并引入选择性的算法耗散，从而在对低频成分影响最小的同时衰减高频网格噪声。\n\nB. 选择 $\\alpha = 0$，因为这能消除数值耗散，从而避免对频谱的任何扭曲；这是更可取的，因为高频伪影是数值上的而非物理上的。\n\nC. 选择尽可能负的 $\\alpha$，即 $\\alpha$ 接近 $- \\tfrac{1}{3}$，以消除所有高频分量，同时不影响低频响应。\n\nD. 选择一个小的正值 $\\alpha$，以在保持无条件稳定性和二阶精度的同时，添加恰到好处的算法耗散。", "solution": "对问题陈述进行有效性验证。\n\n**步骤 1：提取已知条件**\n- 控制方程：$\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{0}$。\n- 矩阵性质：$\\mathbf{M}$ 和 $\\mathbf{K}$ 为对称正定矩阵。\n- 系统类型：源于有限元法 (FEM) 的无阻尼线性半离散结构动力学模型。\n- 数值格式：参数为 $\\alpha$ 的 Hilber-Hughes-Taylor (HHT) 方法。在时间点 $t_{n+1+\\alpha}$ 处强制平衡。通过 Newmark 型格式更新运动学。\n- 时间步长：$\\Delta t$ 是固定的。\n- 误差来源：高频数值伪影由空间离散（网格噪声）引起。\n- 目标：选择 $\\alpha$ 以选择性地阻尼虚假的高频成分，同时保持中低频响应的保真度。\n- 已知事实：\n    1. 对于无阻尼线性系统，精确的机械能是守恒的。\n    2. 当 $\\alpha = 0$ 时，HHT 方法退化为平均加速度 Newmark 格式。\n    3. 对于根据 $\\alpha$ 选择的适当 $(\\beta,\\gamma)$，HHT 方法在 $\\alpha$ 处于某个容许区间内是二阶精确且无条件稳定的。\n\n**步骤 2：使用提取的已知条件进行验证**\n问题陈述具有科学依据，提法恰当，且客观。它提出了计算力学中的一个标准情景：在动力学分析中，需要控制由空间离散产生的非物理高频振荡。HHT-$\\alpha$ 方法是用于此目的的典型工具。控制方程、术语以及所述数值方法的性质，均与有限元分析和计算动力学领域的已有文献一致。该问题不违反任何科学原理，不基于错误的假设，并包含足够的信息以得出明确的答案。\n\n**步骤 3：结论与行动**\n问题陈述有效。下面将推导解决方案。\n\n问题关注的是，对于无阻尼线性系统的半离散运动方程，如何在 Hilber-Hughes-Taylor (HHT) 时间积分格式中选择参数 $\\alpha$：\n$$ \\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{0} $$\nHHT 方法通过在混合时间点计算残差来修改此方程的离散形式，对于线性系统，这等效于修改刚度贡献项：\n$$ \\mathbf{M}\\,\\ddot{\\mathbf{u}}_{n+1} + (1+\\alpha)\\mathbf{K}\\,\\mathbf{u}_{n+1} - \\alpha\\mathbf{K}\\,\\mathbf{u}_n = \\mathbf{0} $$\n位移和速度使用 Newmark-beta 关系式进行更新：\n$$ \\mathbf{u}_{n+1} = \\mathbf{u}_n + \\Delta t \\dot{\\mathbf{u}}_n + \\Delta t^2 \\left[ (\\tfrac{1}{2}-\\beta) \\ddot{\\mathbf{u}}_n + \\beta \\ddot{\\mathbf{u}}_{n+1} \\right] $$\n$$ \\dot{\\mathbf{u}}_{n+1} = \\dot{\\mathbf{u}}_n + \\Delta t \\left[ (1-\\gamma) \\ddot{\\mathbf{u}}_n + \\gamma \\ddot{\\mathbf{u}}_{n+1} \\right] $$\n该算法族的核心性质——精度、稳定性和数值耗散——是参数 $\\alpha$、$\\beta$ 和 $\\gamma$ 的函数。为使 HHT 方法无条件稳定且二阶精确，这些参数必须满足特定的关系。\n\n1.  **二阶精度**：这要求 $\\gamma = \\frac{1}{2} - \\alpha$。\n2.  **无条件稳定性**：对于线性系统，这要求 $\\alpha \\in [-\\frac{1}{3}, 0]$ 且 $2\\beta \\ge \\gamma \\ge \\frac{1}{2}$。将精度条件与 $\\gamma \\ge \\frac{1}{2}$ 结合，得到 $\\frac{1}{2} - \\alpha \\ge \\frac{1}{2}$，简化为 $\\alpha \\le 0$。因此，保证二阶精度和无条件稳定性的区间是 $\\alpha \\in [-\\frac{1}{3}, 0]$。为保证稳定性并最小化低频耗散的典型 $\\beta$ 选择是 $\\beta = \\frac{1}{4}(1-\\alpha)^2$。\n\n参数 $\\alpha$ 直接控制数值（或算法）耗散的大小。对自然频率为 $\\omega$ 的单自由度振子进行分析，可以揭示耗散如何同时依赖于 $\\alpha$ 和无量纲频率 $\\Omega = \\omega \\Delta t$。\n\n-   当 $\\alpha=0$ 时，我们有 $\\gamma=\\frac{1}{2}$ 和 $\\beta=\\frac{1}{4}$。这就是平均加速度法（梯形法则）。该方法没有数值耗散；其放大矩阵的谱半径对所有频率都精确为 $1$。它对线性系统是能量守恒的，这意味着它不会阻尼任何振荡，包括问题中提到的来自空间网格的非物理高频“噪声”。\n\n-   当 $\\alpha < 0$ （在 $[-\\frac{1}{3}, 0)$ 范围内）时，我们有 $\\gamma > \\frac{1}{2}$。这会引入数值耗散。HHT 方法的一个关键特征是这种耗散是频率相关的：对于低频模态（小的 $\\Omega$），耗散非常小；而对于高频模态（大的 $\\Omega$），耗散则会增加。这正是所期望的行为：阻尼虚假的高频成分，同时基本不影响物理上重要的低频响应。在任何给定频率下，耗散量随着 $\\alpha$ 变得更负（接近 $-\\frac{1}{3}$）而增加。\n\n目标是“选择性地阻尼虚假的高频成分，同时保持物理相关的中低频响应的保真度”。这直接指向选择一个负的 $\\alpha$ 值。\n\n现在，我们来评估每个选项。\n\n**A. 选择一个适度的负值 $\\alpha$，例如 $\\alpha \\in \\left[-0.2,-0.05\\right]$，并将 Newmark 参数设置为 $\\gamma = \\tfrac{1}{2} - \\alpha$ 和 $\\beta = \\tfrac{1}{4}\\left(1 - \\alpha\\right)^2$。这样做可以保持二阶精度，并引入选择性的算法耗散，从而在对低频成分影响最小的同时衰减高频网格噪声。**\n这个陈述是完全正确的。\n- 参数关系 $\\gamma = \\frac{1}{2} - \\alpha$ 和 $\\beta = \\frac{1}{4}(1 - \\alpha)^2$ 是实现二阶精度和无条件稳定性的标准选择。\n- 范围 $\\alpha \\in [-0.2, -0.05]$ 在容许的稳定范围 $[-\\frac{1}{3}, 0]$ 之内。\n- 负的 $\\alpha$ 会引入数值耗散。\n- 耗散是频率相关的，在高频处更强。这个性质被描述为“选择性的算法耗散，在对低频成分影响最小的同时衰减高频网格噪声”，这也是 HHT 方法的主要动机。一个适中的值可以避免对物理相关模态的过度阻尼。\n**结论：正确。**\n\n**B. 选择 $\\alpha = 0$，因为这能消除数值耗散，从而避免对频谱的任何扭曲；这是更可取的，因为高频伪影是数值上的而非物理上的。**\n这一陈述反映了对问题目标的误解。虽然 $\\alpha=0$（平均加速度法）确实消除了数值耗散，但在当前背景下这是不可取的。问题明确指出存在高频伪影且需要处理。能量守恒格式将允许这些数值伪影持续存在并污染整个解。目标是消除这些数值噪声，而这需要引入数值耗散。\n**结论：不正确。**\n\n**C. 选择尽可能负的 $\\alpha$，即 $\\alpha$ 接近 $- \\tfrac{1}{3}$，以消除所有高频分量，同时不影响低频响应。**\n这个选择在无条件稳定、二阶的 HHT 族方法中提供了最大可能的数值耗散。虽然它在阻尼高频模态方面非常有效（当 $\\Omega \\to \\infty$ 时谱半径趋于零），但声称其“不影响低频响应”则是一种夸大。增加高频端的耗散不可避免地也会增加中频范围的耗散。对于许多问题，这种程度的阻尼是过度的，可能会降低非最低频谱段的物理相关模态的精度。“消除”(annihilate) 一词也过于强烈。因此，这不是“最合适”的通用指导原则，因为一个更温和的选择通常是在稳定性、降噪和在相关频谱范围内的精度之间更好的折衷。\n**结论：不正确。**\n\n**D. 选择一个小的正值 $\\alpha$，以在保持无条件稳定性和二阶精度的同时，添加恰到好处的算法耗散。**\n关于 HHT 方法的性质，这一陈述在事实上是不正确的。要使该方法在使用标准参数关系时无条件稳定且二阶精确，$\\alpha$ 必须在 $[-\\frac{1}{3}, 0]$ 范围内。选择 $\\alpha > 0$ 违反了无条件稳定性的条件。因此，在 HHT-$\\alpha$ 方法的常规表述和使用背景下，这不是一个有效的策略。\n**结论：不正确。**\n\n基于此分析，唯一正确且合适的指导原则在选项 A 中给出。", "answer": "$$\\boxed{A}$$", "id": "2564581"}, {"introduction": "从概念上理解了 HHT-α 方法的“为何”与“如何”之后，最终的挑战是将理论转化为可执行的算法。这个综合性练习 [@problem_id:2564526] 将引导你完成从零开始的全过程：首先推导 HHT-α 算法的控制方程，然后设计一个更高级的自适应版本，其中阻尼参数 $α$ 可根据系统特性动态调整，最后通过编程实现并验证你的算法。通过构建并测试一个可变 $α$ 的 HHT-α 求解器，你将把理论知识内化为实践技能，真正掌握这一强大的计算动力学工具。", "problem": "考虑一个源于结构动力学和有限元方法的二阶线性初值问题，该问题由线性动量守恒控制，\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{C}\\,\\dot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{f}(t),\n$$\n其中 $\\mathbf{M}$ 是对称正定质量矩阵，$\\mathbf{C}$ 是对称半正定阻尼矩阵，$\\mathbf{K}$ 是对称半正定刚度矩阵，$\\mathbf{u}(t)$ 是位移向量。Hilber-Hughes-Taylor (HHT-$\\alpha$) 方法是一种单步隐式时间积分格式，它在偏移时间 $t_{n+\\alpha}$ 处施加平衡方程，并使用 Newmark 型运动学关系。在经典格式中，使用一个恒定的数值阻尼参数 $\\alpha \\in [-\\frac{1}{3}, 0]$ 来控制高频耗散，同时对线性系统保持二阶精度和无条件稳定性。\n\n您的任务如下。\n\n1) 从运动学的基本定义，\n$$\n\\dot{\\mathbf{u}} = \\frac{d\\mathbf{u}}{dt}, \\quad \\ddot{\\mathbf{u}} = \\frac{d^2\\mathbf{u}}{dt^2},\n$$\n以及上述线性动量守恒出发，推导一个单步 HHT 型算法，用于从时间 $t_n$ 的 $(\\mathbf{u}_n, \\dot{\\mathbf{u}}_n, \\ddot{\\mathbf{u}}_n)$ 推进到时间 $t_{n+1} = t_n + \\Delta t$ 的 $(\\mathbf{u}_{n+1}, \\dot{\\mathbf{u}}_{n+1}, \\ddot{\\mathbf{u}}_{n+1})$。您的推导必须在偏移时间处施加加权平衡\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}}_{n+\\alpha} + \\mathbf{C}\\,\\dot{\\mathbf{u}}_{n+\\alpha} + \\mathbf{K}\\,\\mathbf{u}_{n+\\alpha} = \\mathbf{f}_{n+\\alpha},\n$$\n并对 $\\mathbf{u}, \\dot{\\mathbf{u}}, \\ddot{\\mathbf{u}}$ 和 $\\mathbf{f}$ 应用仿射平均 $\\mathbf{x}_{n+\\alpha} = (1-\\alpha)\\,\\mathbf{x}_{n+1} + \\alpha\\,\\mathbf{x}_n$。将其与用 $\\ddot{\\mathbf{u}}_{n+1}$、$\\Delta t$ 和 $(\\mathbf{u}_n,\\dot{\\mathbf{u}}_n,\\ddot{\\mathbf{u}}_n)$ 表示的 $\\mathbf{u}_{n+1}$ 和 $\\dot{\\mathbf{u}}_{n+1}$ 的 Newmark 型运动学相结合。推导 Newmark 参数与 $\\alpha$ 相关的代数条件，这些条件对于相容性（达到 $O(\\Delta t^3)$ 阶的局部截断误差，即全局二阶精度）以及对于 $\\mathbf{C}\\succeq \\mathbf{0}$ 的线性系统具有无条件稳定性是充分且必要的。不要假设这些关系的任何特定形式；从泰勒展开和施加的加权平衡中获得它们。\n\n2) 提出一种依赖于模态含量估计器的可变 $\\alpha$ 构造。对于具有标量 $m>0$、$c\\ge 0$ 和 $k\\ge 0$ 的单自由度系统，使用 Rayleigh 频率\n$$\n\\omega_n = \\sqrt{\\frac{k}{m}},\n$$\n定义估计器，并用数值 Nyquist 频率\n$$\n\\omega_N = \\frac{\\pi}{\\Delta t}.\n$$\n对其进行归一化。定义一个平滑映射\n$$\n\\phi = \\tanh\\!\\left(\\left(\\frac{\\omega_n}{\\omega_N}\\right)^p\\right), \\quad p = 4,\n$$\n并将每步的数值阻尼设置为\n$$\n\\alpha = -\\alpha_{\\max}\\,\\phi, \\quad \\alpha_{\\max} = 0.30,\n$$\n该值在步开始时选择并在该步内保持不变。选择与您在任务 1 中的推导一致的 Newmark 参数，以便在 $\\alpha$ 随时间步进变化时保持二阶精度。证明在何种条件下，所得到的可变 $\\alpha$ HHT 格式能保持二阶精度并维持无条件稳定性。\n\n3) 为零外部载荷 $\\mathbf{f}(t) = 0$ 的单自由度情况实现所得到的可变 $\\alpha$ HHT 格式，使用上述估计器和映射。使用国际单位制 (SI)：质量单位为千克，刚度单位为牛顿/米，阻尼单位为牛顿-秒/米，位移单位为米，时间单位为秒。您的实现必须是一个完整且可运行的程序，并且不得需要任何用户输入。\n\n4) 使用您的实现来评估以下测试套件。对于每次模拟，使用所述的单位和初始条件。外部力为零。对于精度评估，当需要解析参考解时，使用精确的无阻尼谐振子解。最终输出必须是：\n- 对于稳定性检查，一个布尔值，如果模拟时间区间内的最大绝对位移不超过给定界限，则定义为真。\n- 对于阶数检查，一个浮点数，用于估计观测到的阶数 $p_{\\mathrm{obs}}$，计算公式为 $\\log(e_{\\Delta t}/e_{\\Delta t/2})/\\log(2)$，其中 $e_{\\Delta t}$ 是使用步长 $\\Delta t$ 时最终时刻位移的绝对误差。\n\n测试用例：\n- 测试 1 (标准路径稳定性，在中等阻尼和中等分辨率下)：$m=1$，$c=0.02$，$k=(2\\pi\\cdot 20)^2$，$\\Delta t = 0.0025$，总时间 $T=0.5$，初始条件 $u(0)=1$，$\\dot{u}(0)=0$。输出一个布尔值，指示 $\\max_{0\\le t\\le T} |u(t)| \\le 1.5$ 是否成立。\n- 测试 2 (大时间步长稳定性边界)：与测试 1 相同的 $m$、$c$ 和 $k$，但 $\\Delta t = 0.02$，总时间 $T=0.5$，初始条件 $u(0)=1$，$\\dot{u}(0)=0$。输出一个布尔值，指示 $\\max_{0\\le t\\le T} |u(t)| \\le 5.0$ 是否成立。\n- 测试 3 (低频下的二阶精度验证)：无阻尼振子，$m=1$，$c=0$，$k=(2\\pi)^2$，初始条件 $u(0)=1$，$\\dot{u}(0)=0$，最终时间 $T=1$。计算 $\\Delta t_1=0.02$ 和 $\\Delta t_2=0.01$ 在 $t=T$ 时的位移误差，并以浮点数形式输出估计的阶数 $p_{\\mathrm{obs}}$。解析参考解为 $u_{\\mathrm{exact}}(T)=\\cos(\\omega T)$，其中 $\\omega=\\sqrt{k/m}$。\n- 测试 4 (自适应数值阻尼有效性)：高频系统，$m=1$，$c=0.02$，$k=(2\\pi\\cdot 50)^2$，$\\Delta t=0.01$，总时间 $T=0.2$，初始条件 $u(0)=0$，$\\dot{u}(0)=1$。进行两次模拟：一次使用定义的可变 $\\alpha$，另一次使用 $\\alpha=0$ (平均加速度 Newmark 方法)。输出一个布尔值，指示由可变 $\\alpha$ 格式在区间 $[0,T]$ 上产生的均方根位移是否小于或等于 $\\alpha=0$ 时的值。\n\n最终输出格式要求：您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，按测试用例的顺序列出结果：$[b_1,b_2,p_3,b_4]$。布尔值 $b_1$、$b_2$ 和 $b_4$ 必须以 Python 默认格式的字面量 true 或 false 打印，浮点数 $p_3$ 必须打印并四舍五入到六位小数。不应打印任何其他文本。", "solution": "所提出的问题是计算结构动力学领域一个标准的、适定的练习。它要求对二阶线性系统推导、特化、实现和测试 Hilber-Hughes-Taylor (HHT-$\\alpha$) 时间积分方法，或者更具体地说，是通常被称为 WBZ-$\\alpha$ 方法的一种形式。所有参数和目标都定义清晰、有科学依据且计算上可行。该问题是有效的。\n\n我们按照要求分四个部分进行解答。\n\n### 第 1 部分：HHT 型算法的推导\n\n线性结构系统的控制运动方程由下式给出：\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{C}\\,\\dot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{f}(t)\n$$\n其中 $\\mathbf{M}$、$\\mathbf{C}$ 和 $\\mathbf{K}$ 分别是质量、阻尼和刚度矩阵，$\\mathbf{u}(t)$ 是位移向量。\n\nHHT-$\\alpha$ 方法是一种用于数值积分此方程的单步隐式格式。它属于 Newmark 方法族。我们首先定义 Newmark 运动学关系，该关系近似了在时间 $t_{n+1} = t_n + \\Delta t$ 时的位移 $\\mathbf{u}_{n+1}$ 和速度 $\\dot{\\mathbf{u}}_{n+1}$：\n$$\n\\mathbf{u}_{n+1} = \\mathbf{u}_n + \\Delta t\\,\\dot{\\mathbf{u}}_n + \\frac{\\Delta t^2}{2} \\left[ (1 - 2\\beta) \\ddot{\\mathbf{u}}_n + 2\\beta \\ddot{\\mathbf{u}}_{n+1} \\right]\n$$\n$$\n\\dot{\\mathbf{u}}_{n+1} = \\dot{\\mathbf{u}}_n + \\Delta t \\left[ (1 - \\gamma) \\ddot{\\mathbf{u}}_n + \\gamma \\ddot{\\mathbf{u}}_{n+1} \\right]\n$$\n此处，$\\beta$ 和 $\\gamma$ 是决定该方法稳定性和精度的 Newmark 积分参数。这些方程可以重新排列，以待求的加速度 $\\ddot{\\mathbf{u}}_{n+1}$ 和时间 $t_n$ 的量来表示 $\\mathbf{u}_{n+1}$ 和 $\\dot{\\mathbf{u}}_{n+1}$。\n\n如问题中所定义，HHT-$\\alpha$ 方法在 $t_n$ 和 $t_{n+1}$ 之间的一个加权平均点上施加运动方程：\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}}_{n+\\alpha} + \\mathbf{C}\\,\\dot{\\mathbf{u}}_{n+\\alpha} + \\mathbf{K}\\,\\mathbf{u}_{n+\\alpha} = \\mathbf{f}_{n+\\alpha}\n$$\n其中，一个通用量 $\\mathbf{x}_{n+\\alpha}$ 由仿射平均定义：\n$$\n\\mathbf{x}_{n+\\alpha} = (1-\\alpha)\\,\\mathbf{x}_{n+1} + \\alpha\\,\\mathbf{x}_n\n$$\n应用于 $\\mathbf{u}, \\dot{\\mathbf{u}}, \\ddot{\\mathbf{u}}$ 和 $\\mathbf{f}$。参数 $\\alpha \\in [-\\frac{1}{3}, 0]$ 控制高频模态的数值耗散。\n\n将仿射平均代入加权平衡方程得到：\n$$\n(1-\\alpha)(\\mathbf{M}\\ddot{\\mathbf{u}}_{n+1} + \\mathbf{C}\\dot{\\mathbf{u}}_{n+1} + \\mathbf{K}\\mathbf{u}_{n+1}) + \\alpha(\\mathbf{M}\\ddot{\\mathbf{u}}_{n} + \\mathbf{C}\\dot{\\mathbf{u}}_{n} + \\mathbf{K}\\mathbf{u}_{n}) = (1-\\alpha)\\mathbf{f}_{n+1} + \\alpha\\mathbf{f}_{n}\n$$\n现在，将 $\\mathbf{u}_{n+1}$ 和 $\\dot{\\mathbf{u}}_{n+1}$ 的 Newmark 关系代入此方程。这将得到一个仅包含未知加速度 $\\ddot{\\mathbf{u}}_{n+1}$ 的方程：\n$$\n(1-\\alpha)\\left(\\mathbf{M}\\ddot{\\mathbf{u}}_{n+1} + \\mathbf{C}(\\dot{\\mathbf{u}}_n + \\Delta t (1 - \\gamma) \\ddot{\\mathbf{u}}_n + \\gamma \\Delta t \\ddot{\\mathbf{u}}_{n+1}) + \\mathbf{K}(\\mathbf{u}_n + \\Delta t\\,\\dot{\\mathbf{u}}_n + \\frac{\\Delta t^2}{2} ((1 - 2\\beta) \\ddot{\\mathbf{u}}_n + 2\\beta \\ddot{\\mathbf{u}}_{n+1}))\\right) + \\alpha(\\mathbf{M}\\ddot{\\mathbf{u}}_{n} + \\mathbf{C}\\dot{\\mathbf{u}}_{n} + \\mathbf{K}\\mathbf{u}_{n}) = (1-\\alpha)\\mathbf{f}_{n+1} + \\alpha\\mathbf{f}_{n}\n$$\n重新排列，将包含 $\\ddot{\\mathbf{u}}_{n+1}$ 的项分组到左侧：\n$$\n\\left[ (1-\\alpha)\\mathbf{M} + (1-\\alpha)\\gamma\\Delta t\\,\\mathbf{C} + (1-\\alpha)\\beta\\Delta t^2\\,\\mathbf{K} \\right] \\ddot{\\mathbf{u}}_{n+1} = (1-\\alpha)\\mathbf{f}_{n+1} + \\alpha\\mathbf{f}_{n} - \\alpha(\\mathbf{M}\\ddot{\\mathbf{u}}_{n} + \\mathbf{C}\\dot{\\mathbf{u}}_{n} + \\mathbf{K}\\mathbf{u}_{n}) - (1-\\alpha)\\left( \\mathbf{C}(\\dot{\\mathbf{u}}_n + \\Delta t(1-\\gamma)\\ddot{\\mathbf{u}}_n) + \\mathbf{K}(\\mathbf{u}_n + \\Delta t\\dot{\\mathbf{u}}_n + \\Delta t^2(\\frac{1}{2}-\\beta)\\ddot{\\mathbf{u}}_n) \\right)\n$$\n这是一个形式为 $\\hat{\\mathbf{M}}\\,\\ddot{\\mathbf{u}}_{n+1} = \\hat{\\mathbf{f}}_n$ 的线性方程组，其中 $\\hat{\\mathbf{M}}$ 是有效质量矩阵，$\\hat{\\mathbf{f}}_n$ 是有效力向量。一旦计算出 $\\ddot{\\mathbf{u}}_{n+1}$，就可以从 Newmark 关系中找到 $\\mathbf{u}_{n+1}$ 和 $\\dot{\\mathbf{u}}_{n+1}$。\n\n**精度和稳定性条件：**\n这些条件的推导基于对该方法在无外力、无阻尼的单自由度 (SDOF) 系统 $\\ddot{u} + \\omega^2 u = 0$ 上的行为分析。该分析涉及将单步算法写为 $\\mathbf{y}_{n+1} = \\mathbf{A}\\,\\mathbf{y}_n$，其中 $\\mathbf{y}_n = \\{u_n, \\Delta t \\dot{u}_n, \\Delta t^2 \\ddot{u}_n\\}^T$，$\\mathbf{A}$ 是放大矩阵。\n\n1.  **二阶精度：** 为了达到二阶精度（即局部截断误差为 $O(\\Delta t^3)$ 阶），该方法在低频极限 ($\\omega \\Delta t \\rightarrow 0$) 下不能引入人为的数值阻尼，并且周期误差必须为 $O(\\Delta t^2)$ 阶。通过将放大矩阵的特征根与精确解 $e^{\\pm i\\omega\\Delta t}$ 进行比较，该分析得出了以下条件：\n    $$\n    \\gamma = \\frac{1}{2} - \\alpha\n    $$\n\n2.  **无条件稳定性：** 为了实现无条件稳定性，对于所有 $\\omega \\Delta t$ 的值，放大矩阵的谱半径 $\\rho(\\mathbf{A})$ 必须小于或等于 1。为了使该方法在高频极限 ($\\omega \\Delta t \\rightarrow \\infty$) 下具有耗散性，我们要求 $\\rho(\\mathbf{A}) < 1$。这些约束导致了以下充分必要条件：\n    $$\n    \\gamma \\ge \\frac{1}{2}, \\quad \\beta \\ge \\frac{1}{4}(1-\\alpha+\\gamma)^2\n    $$\n    结合精度和稳定性的要求，我们代入 $\\gamma = 1/2 - \\alpha$。条件 $\\gamma \\ge 1/2$ 要求 $1/2 - \\alpha \\ge 1/2$，这意味着 $\\alpha \\le 0$。问题陈述 $\\alpha \\in [-1/3, 0]$，这满足此条件。对于给定的 $\\alpha$，为了最大化高频耗散，最常见的选择是：\n    $$\n    \\beta = \\frac{(1-\\alpha)^2}{4}\n    $$\n    对于 $\\alpha \\in [-1/3, 0]$，此选择满足了通用稳定性条件。具体来说，当 $\\alpha=0$ 时，我们恢复了 Newmark 平均加速度法，其中 $\\gamma=1/2, \\beta=1/4$，该方法是非耗散且无条件稳定的。当 $\\alpha=-1/3$ 时，我们得到 $\\gamma=5/6$ 和 $\\beta=4/9$，这提供了强的数值阻尼。\n\n### 第 2 部分：可变 $\\alpha$ 的构造\n\n我们被要求提出一种可变 $\\alpha$ 格式，其中 $\\alpha$ 在每个时间步根据模态含量进行调整。对于一个单自由度系统，模态含量由自振频率 $\\omega_n = \\sqrt{k/m}$ 定义。\n\n该格式定义为：\n$$\n\\alpha_n = -\\alpha_{\\max}\\,\\phi_n, \\quad \\text{with} \\quad \\alpha_{\\max} = 0.30\n$$\n其中 $\\phi_n$ 是一个基于系统频率与数值 Nyquist 频率 $\\omega_N = \\pi/\\Delta t$ 之比的映射：\n$$\n\\phi_n = \\tanh\\left(\\left(\\frac{\\omega_n}{\\omega_N}\\right)^p\\right), \\quad \\text{with} \\quad p = 4\n$$\n在每个步长 $n$ 的开始，我们计算 $\\alpha_n$ 并在该步长内保持其不变。为了保持二阶精度和无条件稳定性，我们必须在每一步都一致地选择 Newmark 参数。根据第 1 部分的推导，我们设定：\n$$\n\\gamma_n = \\frac{1}{2} - \\alpha_n\n$$\n$$\n\\beta_n = \\frac{(1-\\alpha_n)^2}{4}\n$$\n\n**特性的证明：**\n\n1.  **二阶精度：** 对于具有时变参数的格式，如果从步 $n \\to n+1$ 的参数是基于时间 $t_n$ 的状态确定的（或者在其他方面与 $t_{n+1}$ 的状态无关），并且满足恒定参数格式的精度条件，则二阶精度得以保持。在我们的情况下，对于一个线性时不变系统，$\\omega_n$ 是恒定的，因此 $\\alpha_n$、$\\beta_n$ 和 $\\gamma_n$ 在整个模拟过程中是恒定的（尽管它们依赖于 $\\Delta t$）。即使 $k$ 或 $m$ 缓慢变化，在步开始时确定参数的原则也保留了精度。关系 $\\gamma_n = 1/2 - \\alpha_n$ 是通过构造满足的，确保了局部截断误差为 $O(\\Delta t^3)$ 阶，其积分后得到全局误差为 $O(\\Delta t^2)$ 阶。\n\n2.  **无条件稳定性：** 对于线性系统，稳定性可以按步进行分析。在每一步 $n$，算法都使用一组固定的参数 $(\\alpha_n, \\beta_n, \\gamma_n)$ 进行。我们必须检查这些参数是否满足无条件稳定性条件。\n    -   映射 $\\phi_n$ 产生的值在 $[0, 1)$ 区间内，因为 $\\omega_n/\\omega_N \\ge 0$。\n    -   因此，$\\alpha_n = -0.30\\,\\phi_n$ 位于 $(-0.30, 0]$ 范围内。这在 HHT 方法已知对于所选参数关系是无条件稳定的 $[-\\frac{1}{3}, 0]$ 范围内。\n    -   参数被选为 $\\gamma_n = 1/2 - \\alpha_n$ 和 $\\beta_n = (1-\\alpha_n)^2/4$。如第 1 部分所述，这些选择确保了对于 $\\alpha_n \\le 0$ 时，满足稳定性条件 $\\gamma_n \\ge 1/2$ 和更通用的条件。\n    -   由于该方法对于每一步选择的参数都是无条件稳定的，因此整个可变参数格式对于线性问题保持无条件稳定。数值阻尼的量根据时间步长对系统自振周期的解析程度进行自适应调整。\n\n### 第 3 部分：实现算法\n\n对于单自由度系统，当 $f(t)=0$ 时，从步骤 $n$ 推进到 $n+1$ 的算法如下：\n\n1.  **初始化**：给定 $m, c, k$ 和初始条件 $u_0, \\dot{u}_0$。通过在 $t=0$ 时施加运动方程来计算初始加速度：\n    $$\n    \\ddot{u}_0 = -(c\\dot{u}_0 + k u_0) / m\n    $$\n\n2.  **对于每个时间步 $n=0, 1, 2, ...$**：\n    a. **计算自适应参数**：\n       -   $\\omega_n = \\sqrt{k/m}$\n       -   $\\omega_N = \\pi/\\Delta t$\n       -   $\\phi_n = \\tanh((\\omega_n/\\omega_N)^4)$\n       -   $\\alpha_n = -0.30\\,\\phi_n$\n       -   $\\gamma_n = 1/2 - \\alpha_n$\n       -   $\\beta_n = (1-\\alpha_n)^2/4$\n       对于特定的固定参数测试用例 ($\\alpha=0$)，这些参数简单地设置为 $\\alpha_n=0, \\gamma_n=1/2, \\beta_n=1/4$。\n\n    b. **求解 $\\ddot{u}_{n+1}$**：\n       第 1 部分的线性系统简化为标量方程 $A\\ddot{u}_{n+1} = B$，其中：\n       $$\n       A = (1-\\alpha_n)m + (1-\\alpha_n)\\gamma_n\\Delta t\\,c + (1-\\alpha_n)\\beta_n\\Delta t^2\\,k\n       $$\n       $$\n        B = -(1-\\alpha_n)\\left[ c(\\dot{u}_n + \\Delta t(1-\\gamma_n)\\ddot{u}_n) + k(u_n + \\Delta t\\dot{u}_n + \\Delta t^2(\\frac{1}{2}-\\beta_n)\\ddot{u}_n) \\right] - \\alpha_n(m\\ddot{u}_n + c\\dot{u}_n + ku_n)\n       $$\n       $$\n       \\ddot{u}_{n+1} = B/A\n       $$\n\n    c. **更新状态（校正步）**：\n       $$\n       u_{n+1} = \\left(u_n + \\Delta t\\dot{u}_n + \\Delta t^2(\\frac{1}{2}-\\beta_n)\\ddot{u}_n\\right) + \\beta_n\\Delta t^2 \\ddot{u}_{n+1}\n       $$\n       $$\n       \\dot{u}_{n+1} = \\left(\\dot{u}_n + \\Delta t(1-\\gamma_n)\\ddot{u}_n\\right) + \\gamma_n\\Delta t \\ddot{u}_{n+1}\n       $$\n    括号中的项是“预测”值。\n\n### 第 4 部分：测试套件评估\n\n使用第 3 部分中描述的实现来运行指定的测试用例。结果按要求进行计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by implementing the variable-alpha HHT scheme and running the specified test cases.\n    \"\"\"\n\n    def run_hht_simulation(m, c, k, u0, v0, dt, T, alpha_mode='variable'):\n        \"\"\"\n        Runs a single-degree-of-freedom HHT simulation.\n\n        Args:\n            m (float): mass\n            c (float): damping\n            k (float): stiffness\n            u0 (float): initial displacement\n            v0 (float): initial velocity\n            dt (float): time step\n            T (float): total simulation time\n            alpha_mode (str): 'variable' for adaptive alpha, 'zero' for alpha=0.\n\n        Returns:\n            A tuple (t_hist, u_hist, v_hist, a_hist) with time histories.\n        \"\"\"\n        n_steps = int(round(T / dt))\n        t_hist = np.linspace(0, n_steps * dt, n_steps + 1)\n        u_hist = np.zeros(n_steps + 1)\n        v_hist = np.zeros(n_steps + 1)\n        a_hist = np.zeros(n_steps + 1)\n\n        # Initial conditions\n        u_hist[0] = u0\n        v_hist[0] = v0\n        # Enforce EOM at t=0 to find a0, assuming f(0)=0\n        if m > 0:\n            a_hist[0] = -(c * v0 + k * u0) / m\n        else: # m=0 case not expected but handle\n            a_hist[0] = 0\n\n        # Pre-calculate frequency terms for variable alpha\n        if alpha_mode == 'variable':\n            if m > 0 and k >= 0:\n                omega_n = np.sqrt(k / m)\n            else:\n                omega_n = 0.0\n            omega_N = np.pi / dt\n            ratio = omega_n / omega_N if omega_N > 0 else 0\n            # Use p=4 as specified\n            phi = np.tanh(ratio**4)\n            # Use alpha_max = 0.30 as specified\n            alpha = -0.30 * phi\n        else: # alpha_mode == 'zero'\n            alpha = 0.0\n\n        gamma = 0.5 - alpha\n        beta = (1 - alpha)**2 / 4\n\n        for n in range(n_steps):\n            u_n, v_n, a_n = u_hist[n], v_hist[n], a_hist[n]\n\n            # Solve for a_{n+1}. Equation is A*a_{n+1} = B\n            # A = (1-a)m + (1-a)g*dt*c + (1-a)b*dt^2*k\n            # B = -(1-a)[c(v_n+dt(1-g)a_n) + k(u_n+dt*v_n+dt^2(0.5-b)a_n)] - a(m*a_n+c*v_n+k*u_n)\n            \n            A = (1 - alpha) * (m + gamma * dt * c + beta * dt**2 * k)\n            \n            # Predictor terms needed for B\n            v_tilde_np1 = v_n + dt * (1 - gamma) * a_n\n            u_tilde_np1 = u_n + dt * v_n + dt**2 * (0.5 - beta) * a_n\n\n            B = -(1-alpha)*(c * v_tilde_np1 + k * u_tilde_np1) - alpha * (m * a_n + c * v_n + k * u_n)\n            \n            if A != 0:\n                a_np1 = B / A\n            else:\n                a_np1 = 0\n\n            # Corrector step\n            u_np1 = u_tilde_np1 + beta * dt**2 * a_np1\n            v_np1 = v_tilde_np1 + gamma * dt * a_np1\n\n            u_hist[n + 1] = u_np1\n            v_hist[n + 1] = v_np1\n            a_hist[n + 1] = a_np1\n\n        return t_hist, u_hist, v_hist, a_hist\n\n    results = []\n\n    # Test 1: Stability under modest damping and moderate resolution\n    m1, c1, k1 = 1.0, 0.02, (2 * np.pi * 20)**2\n    dt1, T1 = 0.0025, 0.5\n    u01, v01 = 1.0, 0.0\n    _, u_hist1, _, _ = run_hht_simulation(m1, c1, k1, u01, v01, dt1, T1)\n    b1 = np.max(np.abs(u_hist1)) = 1.5\n    results.append(b1)\n\n    # Test 2: Large time step stability edge\n    m2, c2, k2 = 1.0, 0.02, (2 * np.pi * 20)**2\n    dt2, T2 = 0.02, 0.5\n    u02, v02 = 1.0, 0.0\n    _, u_hist2, _, _ = run_hht_simulation(m2, c2, k2, u02, v02, dt2, T2)\n    b2 = np.max(np.abs(u_hist2)) = 5.0\n    results.append(b2)\n    \n    # Test 3: Second-order accuracy verification\n    m3, c3, k3 = 1.0, 0.0, (2 * np.pi)**2\n    T3 = 1.0\n    u03, v03 = 1.0, 0.0\n    dt3a, dt3b = 0.02, 0.01\n\n    _, u_hist3a, _, _ = run_hht_simulation(m3, c3, k3, u03, v03, dt3a, T3)\n    u_final_3a = u_hist3a[-1]\n\n    _, u_hist3b, _, _ = run_hht_simulation(m3, c3, k3, u03, v03, dt3b, T3)\n    u_final_3b = u_hist3b[-1]\n    \n    omega_3 = np.sqrt(k3 / m3)\n    u_exact_T3 = np.cos(omega_3 * T3)\n\n    e_dta = np.abs(u_final_3a - u_exact_T3)\n    e_dtb = np.abs(u_final_3b - u_exact_T3)\n\n    if e_dta > 0 and e_dtb > 0:\n        p_obs = np.log(e_dta / e_dtb) / np.log(2)\n    else: # Fallback if error is zero (unlikely but possible)\n        p_obs = 2.0\n        \n    results.append(f\"{p_obs:.6f}\")\n    \n    # Test 4: Adaptive numerical damping effectiveness\n    m4, c4, k4 = 1.0, 0.02, (2 * np.pi * 50)**2\n    dt4, T4 = 0.01, 0.2\n    u04, v04 = 0.0, 1.0\n\n    # Variable alpha simulation\n    _, u_hist4_var, _, _ = run_hht_simulation(m4, c4, k4, u04, v04, dt4, T4, alpha_mode='variable')\n    rms_var = np.sqrt(np.mean(u_hist4_var**2))\n\n    # Alpha=0 simulation (Newmark average acceleration)\n    _, u_hist4_zero, _, _ = run_hht_simulation(m4, c4, k4, u04, v04, dt4, T4, alpha_mode='zero')\n    rms_zero = np.sqrt(np.mean(u_hist4_zero**2))\n\n    b4 = rms_var = rms_zero\n    results.append(b4)\n    \n    # Final print statement\n    result_str = \",\".join(map(str, results)).lower()\n    print(f\"[{result_str}]\")\n\nsolve()\n```", "id": "2564526"}]}