{"hands_on_practices": [{"introduction": "让我们通过一个核心实践，深入理解显式时间积分方法的基本限制：条件稳定性。这个练习将指导您为模型扩散问题推导前向欧拉法的稳定时间步长上限。通过将系统矩阵的最大特征值与有限元网格尺寸 $h$ 联系起来，您将亲手验证著名的CFL条件，并揭示为何显式方法的时间步长会随着网格加密而急剧减小 [@problem_id:2545016]。", "problem": "考虑在 $d$ 维超立方体 $\\Omega=(0,L)^{d}$ 上的线性扩散方程 $u_{t}=\\kappa\\,\\Delta u$，其具有齐次 Dirichlet 边界条件和常数扩散系数 $\\kappa>0$。令 $V_{h}\\subset H_{0}^{1}(\\Omega)$ 为协调有限元空间，该空间由定义在每个坐标方向网格尺寸为 $h=L/N$ 的均匀笛卡尔剖分上的连续、分片双线性/三线性张量积多项式（即 $Q_1$ 单元）构成, 并令 $\\{\\phi_{i}\\}$ 表示其节点基。由标准 Galerkin 方法得到的半离散化方法（method of lines）产生常微分方程组 $M\\,\\dot{\\mathbf{U}}(t)+K\\,\\mathbf{U}}(t)=\\mathbf{0}$，其中 $M_{ij}=(\\phi_{i},\\phi_{j})_{L^{2}(\\Omega)}$ 和 $K_{ij}=\\kappa\\,(\\nabla\\phi_{i},\\nabla\\phi_{j})_{L^{2}(\\Omega)}$。假设质量矩阵被其行和集总对角近似 $M_{\\ell}$ 替代，从而显式前向 Euler 更新格式为 $\\mathbf{U}^{n+1}=\\mathbf{U}^{n}-\\Delta t\\,M_{\\ell}^{-1}K\\,\\mathbf{U}^{n}$。从以下原则出发：(i) 对于线性系统 $\\dot{\\mathbf{y}}=-A\\,\\mathbf{y}$，前向 Euler 法的放大矩阵是 $I-\\Delta t\\,A$，且对于实非负谱，稳定性要求对 $A$ 的所有特征值 $\\lambda$ 均有 $|1-\\Delta t\\,\\lambda|\\leq 1$；(ii) 在具有齐次 Dirichlet 边界条件的均匀笛卡尔网格上，$M_{\\ell}^{-1}K$ 可由离散正弦变换对角化，其具有实非负特征值，这些特征值与在相同网格上的标准负离散拉普拉斯算子乘以 $\\kappa$ 后的特征值相同。请推导确保线性稳定的最大前向 Euler 时间步长 $\\Delta t_{\\max}$，用 $h$、$d$ 和 $\\kappa$ 表示。您的推导必须明确最大特征值 $\\lambda_{\\max}(M_{\\ell}^{-1}K)$ 对 $h$ 和 $d$ 的依赖关系。作为对隐式和显式过程的基于背景的比较，请在您的推理中简要说明为什么后向 Euler 方法对该问题不施加此类步长限制，但不要报告其任何单独的数值界限。请以 $h$、$d$ 和 $\\kappa$ 的单个闭式表达式给出 $\\Delta t_{\\max}$ 的最终答案。如果指定物理单位，当 $h$ 以米为单位，$\\kappa$ 以平方米/秒为单位时，时间应以秒为单位进行解释。不要在最终的方框答案中包含单位。", "solution": "所述问题是有效且适定的。它构成了偏微分方程数值方法稳定性分析中的一个标准练习。我们开始推导。\n\n带质量集总的半离散有限元格式由常微分方程组 $M_{\\ell}\\,\\dot{\\mathbf{U}}(t)+K\\,\\mathbf{U}}(t)=\\mathbf{0}$ 给出。这可以写成线性系统的标准形式：\n$$\n\\dot{\\mathbf{U}}(t) = -M_{\\ell}^{-1}K\\,\\mathbf{U}(t)\n$$\n我们确定系统矩阵为 $A = M_{\\ell}^{-1}K$。前向 Euler 方法将该系统在时间上离散化为：\n$$\n\\frac{\\mathbf{U}^{n+1} - \\mathbf{U}^{n}}{\\Delta t} = -A\\,\\mathbf{U}^{n}\n$$\n这得出了显式更新规则 $\\mathbf{U}^{n+1} = (I - \\Delta t\\,A)\\,\\mathbf{U}^{n}$，其中 $I$ 是单位矩阵。该格式的放大矩阵是 $G = I - \\Delta t\\,A$。\n\n根据所给定的原则 (i)，对于具有实非负特征值谱 $\\{\\lambda_k\\}$ 的系统，稳定性要求放大矩阵所有特征值的模都以 1 为界。$G$ 的特征值为 $g_k = 1 - \\Delta t\\,\\lambda_k$。条件是对所有 $k$ 都有 $|1 - \\Delta t\\,\\lambda_k| \\le 1$。由于 $K$ 是对称半正定矩阵，$M_{\\ell}$ 是具有正元素的对角矩阵（集总质量是正的），因此 $A = M_{\\ell}^{-1}K$ 的特征值 $\\lambda_k$ 是实数且非负的。因此，稳定性条件简化为：\n$$\n-1 \\le 1 - \\Delta t\\,\\lambda_k \\le 1\n$$\n右侧不等式 $1 - \\Delta t\\,\\lambda_k \\le 1$ 意味着 $-\\Delta t\\,\\lambda_k \\le 0$，这总是满足的，因为 $\\Delta t > 0$ 且 $\\lambda_k \\ge 0$。左侧不等式 $-1 \\le 1 - \\Delta t\\,\\lambda_k$ 施加了实际的约束条件：\n$$\n\\Delta t\\,\\lambda_k \\le 2 \\implies \\Delta t \\le \\frac{2}{\\lambda_k}\n$$\n这必须对所有特征值成立。最严格的条件由最大特征值 $\\lambda_{\\max}$ 施加。因此，数值稳定性的条件是：\n$$\n\\Delta t \\le \\frac{2}{\\lambda_{\\max}(A)} \\implies \\Delta t_{\\max} = \\frac{2}{\\lambda_{\\max}(M_{\\ell}^{-1}K)}\n$$\n核心任务是确定 $\\lambda_{\\max}(M_{\\ell}^{-1}K)$。我们使用所给定的原则 (ii)，该原则指出，在均匀网格上，对于集总质量的 $Q_1$ 单元，$M_{\\ell}^{-1}K$ 的特征值与在具有齐次 Dirichlet 边界条件的相同网格上，标准负离散拉普拉斯算子（记为 $-\\Delta_h$）乘以 $\\kappa$ 后的特征值相同。\n因此 $A$ 的特征值为 $\\lambda(A) = \\kappa\\,\\lambda(-\\Delta_h)$。\n\n我们现在推导在 $d$ 维域 $\\Omega=(0,L)^{d}$ 上，网格尺寸为 $h=L/N$ 的均匀网格上算子 $-\\Delta_h$ 的特征值。该算子通过其对网格函数 $v_{j_1, \\dots, j_d}$ 的作用来定义：\n$$\n(-\\Delta_h v)_{\\mathbf{j}} = -\\frac{1}{h^2} \\sum_{k=1}^d (v_{\\mathbf{j}+\\mathbf{e}_k} - 2v_{\\mathbf{j}} + v_{\\mathbf{j}-\\mathbf{e}_k})\n$$\n其中 $\\mathbf{j}=(j_1, \\dots, j_d)$ 是一个内部网格点的多重索引，$1 \\le j_k \\le N-1$。特征函数是正弦函数的乘积：\n$$\n\\psi_{\\mathbf{m}}(\\mathbf{j}) = \\prod_{k=1}^d \\sin\\left(\\frac{m_k \\pi j_k h}{L}\\right) = \\prod_{k=1}^d \\sin\\left(\\frac{m_k \\pi j_k}{N}\\right)\n$$\n对于模式多重索引 $\\mathbf{m}=(m_1, \\dots, m_d)$，其中 $1 \\le m_k \\le N-1$。由于拉普拉斯算子的可分离性，$d$ 维中的特征值是每个维度特征值的和。对于一维情况，与特征函数 $\\sin(m \\pi j/N)$ 对应的特征值 $\\lambda_m^{(1D)}$ 是：\n$$\n\\lambda_m^{(1D)} = \\frac{2}{h^2} \\left(1 - \\cos\\left(\\frac{m \\pi}{N}\\right)\\right) = \\frac{4}{h^2} \\sin^2\\left(\\frac{m \\pi}{2N}\\right)\n$$\n对 $d$ 个维度求和，模式 $\\mathbf{m}$ 的特征值是：\n$$\n\\lambda_{\\mathbf{m}}^{(dD)} = \\sum_{k=1}^d \\lambda_{m_k}^{(1D)} = \\frac{4}{h^2} \\sum_{k=1}^d \\sin^2\\left(\\frac{m_k \\pi}{2N}\\right)\n$$\n最大特征值 $\\lambda_{\\max}(-\\Delta_h)$ 对应于最高频率模式，其中每个 $m_k$ 取其最大值，即 $m_k = N-1$。\n$$\n\\lambda_{\\max}(-\\Delta_h) = \\frac{4}{h^2} \\sum_{k=1}^d \\sin^2\\left(\\frac{(N-1)\\pi}{2N}\\right) = \\frac{4d}{h^2} \\sin^2\\left(\\frac{\\pi}{2} - \\frac{\\pi}{2N}\\right) = \\frac{4d}{h^2} \\cos^2\\left(\\frac{\\pi}{2N}\\right)\n$$\n代入 $N=L/h$，我们有 $\\lambda_{\\max}(-\\Delta_h) = \\frac{4d}{h^2} \\cos^2\\left(\\frac{\\pi h}{2L}\\right)$。问题要求最终答案只用 $h$、$d$ 和 $\\kappa$ 表示。这意味着稳定性界限必须与区域大小 $L$ 无关。一个普遍有效的稳定性界限必须对任何区域大小 $L$ 都成立。因此我们必须考虑最坏情况，这对应于 $\\lambda_{\\max}$ 的最大可能值。$\\lambda_{\\max}$ 在所有可能的 $L$ 值上的上确界在 $h/L \\to 0$ 时达到：\n$$\n\\sup_{L>0} \\lambda_{\\max}(-\\Delta_h) = \\sup_{L>0} \\frac{4d}{h^2} \\cos^2\\left(\\frac{\\pi h}{2L}\\right) = \\frac{4d}{h^2}\n$$\n因此，系统矩阵 $A=M_{\\ell}^{-1}K$ 的相关最大特征值是：\n$$\n\\lambda_{\\max}(M_{\\ell}^{-1}K) = \\kappa \\cdot \\left(\\frac{4d}{h^2}\\right) = \\frac{4d\\kappa}{h^2}\n$$\n将此代入 $\\Delta t$ 的稳定性条件，得到最大时间步长：\n$$\n\\Delta t_{\\max} = \\frac{2}{\\lambda_{\\max}(M_{\\ell}^{-1}K)} = \\frac{2}{4d\\kappa/h^2} = \\frac{2h^2}{4d\\kappa} = \\frac{h^2}{2d\\kappa}\n$$\n这就是众所周知的扩散方程显式 Euler 离散化的类 CFL 条件。\n\n作为比较，考虑隐式后向 Euler 方法：$\\mathbf{U}^{n+1} = \\mathbf{U}^{n} - \\Delta t\\,A\\,\\mathbf{U}^{n+1}$。更新由 $(I + \\Delta t\\,A)\\,\\mathbf{U}^{n+1} = \\mathbf{U}^{n}$ 给出。放大矩阵为 $G_{BE} = (I + \\Delta t\\,A)^{-1}$。其特征值为 $g_k = (1 + \\Delta t\\,\\lambda_k)^{-1}$。稳定性条件 $|g_k| \\le 1$ 转化为：\n$$\n\\left| \\frac{1}{1 + \\Delta t\\,\\lambda_k} \\right| \\le 1\n$$\n由于 $\\Delta t > 0$ 并且 $A$ 的所有特征值 $\\lambda_k$ 都是非负的，分母 $1 + \\Delta t\\,\\lambda_k$ 总是大于或等于 $1$。因此，对于任意 $\\Delta t > 0$ 的选择，不等式 $|g_k| \\le 1$ 都成立。因此，后向 Euler 方法对于此问题是无条件稳定的，并且不施加基于稳定性的时间步长限制。", "answer": "$$\n\\boxed{\\frac{h^2}{2d\\kappa}}\n$$", "id": "2545016"}, {"introduction": "在掌握了稳定性这一基本概念后，我们将更进一步，对动力学分析中的不同积分器进行细致的性能比较。此练习要求您推导并分析几种主流时间积分格式（包括显式的中心差分法和隐式的Newmark法）的放大因子。通过在复平面上绘制这些因子的轨迹，您将直观地理解数值耗散和频散等关键特性，并学会如何为特定应用选择最优的积分算法 [@problem_id:2545014]。", "problem": "考虑来自有限元法的无阻尼半离散线性弹性动力学初值问题：求满足下式的位移向量 $\\mathbf{u}(t)$\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{0},\n$$\n其中 $\\mathbf{M}$ 和 $\\mathbf{K}$ 是对称正定质量矩阵和刚度矩阵。设 $\\boldsymbol{\\phi}$ 是广义特征问题 $\\mathbf{K}\\boldsymbol{\\phi} = \\omega^{2}\\mathbf{M}\\boldsymbol{\\phi}$ 的一个特征向量，其特征频率为 $\\omega > 0$。通过模态解耦，与 $\\boldsymbol{\\phi}$ 相关的模态坐标 $q(t)$ 满足标量振子方程\n$$\n\\ddot{q}(t) + \\omega^{2} q(t) = 0.\n$$\n设时间步长为 $\\Delta t > 0$，并定义无量纲步长 $\\Omega := \\omega\\,\\Delta t$。\n\n您将比较应用于标量模态方程的三种单步方法：\n\n- 中心差分法（显式）：用 $q_{n-1}$、$q_{n}$ 和 $q_{n+1}$ 的中心二阶差分来近似 $\\ddot{q}(t_{n})$，其中 $q_{n} := q(n\\Delta t)$。\n- 具有参数 $\\beta$ 和 $\\gamma$ 的 Newmark 族方法（通常是隐式的）：使用\n$$\n\\begin{aligned}\nq_{n+1} &= q_{n} + \\Delta t\\,v_{n} + \\Delta t^{2}\\big((\\tfrac{1}{2}-\\beta)a_{n} + \\beta a_{n+1}\\big),\\\\\nv_{n+1} &= v_{n} + \\Delta t\\big((1-\\gamma)a_{n} + \\gamma a_{n+1}\\big),\n\\end{aligned}\n$$\n结合运动方程 $a_{n} = -\\omega^{2} q_{n}$ 和 $a_{n+1} = -\\omega^{2} q_{n+1}$，并采用平均加速度选择 $\\gamma = \\tfrac{1}{2}$ 和 $\\beta = \\tfrac{1}{4}$。\n- 针对二阶系统的广义-$\\alpha$ 方法：设 $\\alpha_{m}$ 和 $\\alpha_{f}$ 为给定的权重，并强制执行\n$$\na_{n+\\alpha_{m}} + \\omega^{2} q_{n+\\alpha_{f}} = 0,\\quad a_{n+\\alpha_{m}} := (1-\\alpha_{m})a_{n+1} + \\alpha_{m} a_{n},\\quad q_{n+\\alpha_{f}} := (1-\\alpha_{f})q_{n+1} + \\alpha_{f} q_{n},\n$$\n与上述类 Newmark 运动学方程耦合。假设二阶精度条件为 $\\gamma = \\tfrac{1}{2} + \\alpha_{f} - \\alpha_{m}$ 和 $\\beta = \\tfrac{1}{4}\\big(1 + \\alpha_{f} - \\alpha_{m}\\big)^{2}$，并取一个高频光谱半径设计参数 $\\rho_{\\infty} \\in [0,1)$，使得该方法是 $A$-稳定的，并且当 $\\Omega \\to \\infty$ 时，其极限放大因子幅值为 $\\rho_{\\infty}$。\n\n任务：\n\n1) 对这三种方法中的每一种，推导将其对应的状态向量从时间层 $n$推进到 $n+1$ 的单步放大矩阵，并计算其特征值作为 $\\Omega$ 的函数。这些特征值是该方法对给定特征模态的放大因子。\n\n2) 当 $\\Omega$ 在 $[0,\\infty)$ 上变化时，在复平面中绘制或描绘这些放大因子的轨迹，并根据每种方法的数值频散和数值耗散来解释其形状。\n\n3) 确定中心差分法对给定的特征模态保持临界稳定的最大无量纲时间步长 $\\Omega_{\\max}$，即其放大矩阵的光谱半径等于 $1$。请将最终答案表示为单一的无量纲数 $\\Omega_{\\max}$，无需四舍五入。", "solution": "所提出的问题是结构动力学时间积分方法分析中的一个标准的、适定的练习。它在科学上是合理的，包含了所有必要的信息，并且没有内部矛盾。因此，该问题是有效的，并将提供解答。\n\n对标量振子 $\\ddot{q}(t) + \\omega^{2}q(t) = 0$ 的时间积分方案进行分析，涉及寻找算法的放大特性。我们寻求一个矩阵 $\\mathbf{A}$，即放大矩阵，它将包含系统在时间 $t_n = n\\Delta t$ 状态的状态向量 $\\mathbf{y}_n$ 推进到时间 $t_{n+1}$ 的状态 $\\mathbf{y}_{n+1}$。$\\mathbf{A}$ 的特征值是放大因子，它们决定了方法的稳定性和精度。无量纲时间步长为 $\\Omega = \\omega\\Delta t$。\n\n任务1：放大矩阵及其特征值的推导\n\n**中心差分法**\n\n在时间 $t_n$ 的二阶导数的中心差分近似为 $\\ddot{q}_n \\approx \\frac{q_{n+1} - 2q_n + q_{n-1}}{\\Delta t^2}$。将其代入模态方程 $\\ddot{q}_n + \\omega^2 q_n = 0$ 得到：\n$$\n\\frac{q_{n+1} - 2q_n + q_{n-1}}{\\Delta t^2} + \\omega^2 q_n = 0\n$$\n对 $q_{n+1}$ 进行整理，我们得到递推关系：\n$$\nq_{n+1} = (2 - \\omega^2 \\Delta t^2) q_n - q_{n-1} = (2 - \\Omega^2) q_n - q_{n-1}\n$$\n这是一个两步法。为了将其写成单步系统，我们定义一个状态向量 $\\mathbf{y}_n = \\begin{pmatrix} q_n \\\\ q_{n-1} \\end{pmatrix}$。下一步的状态是 $\\mathbf{y}_{n+1} = \\begin{pmatrix} q_{n+1} \\\\ q_n \\end{pmatrix}$。使用递推关系，我们有：\n$$\n\\mathbf{y}_{n+1} = \\begin{pmatrix} (2-\\Omega^2)q_n - q_{n-1} \\\\ q_n \\end{pmatrix} = \\begin{pmatrix} 2-\\Omega^2 & -1 \\\\ 1 & 0 \\end{pmatrix} \\begin{pmatrix} q_n \\\\ q_{n-1} \\end{pmatrix}\n$$\n因此，放大矩阵为：\n$$\n\\mathbf{A}_{\\text{CD}} = \\begin{pmatrix} 2-\\Omega^2 & -1 \\\\ 1 & 0 \\end{pmatrix}\n$$\n其特征值 $\\lambda$ 通过求解特征方程 $\\det(\\mathbf{A}_{\\text{CD}} - \\lambda\\mathbf{I}) = 0$ 得到：\n$$\n\\det \\begin{pmatrix} 2-\\Omega^2 - \\lambda & -1 \\\\ 1 & -\\lambda \\end{pmatrix} = -\\lambda(2-\\Omega^2 - \\lambda) + 1 = \\lambda^2 - (2-\\Omega^2)\\lambda + 1 = 0\n$$\n特征值由二次公式给出：\n$$\n\\lambda_{1,2} = \\frac{(2-\\Omega^2) \\pm \\sqrt{(2-\\Omega^2)^2 - 4}}{2} = 1 - \\frac{\\Omega^2}{2} \\pm \\sqrt{\\left(1-\\frac{\\Omega^2}{2}\\right)^2 - 1}\n$$\n\n**Newmark 法（平均加速度法）**\n\nNewmark 族方法使用参数 $\\gamma = \\frac{1}{2}$ 和 $\\beta = \\frac{1}{4}$ 定义。方程为：\n$$\n\\begin{aligned}\nq_{n+1} &= q_{n} + \\Delta t\\,v_{n} + \\Delta t^{2}\\left(\\frac{1}{4}a_{n} + \\frac{1}{4} a_{n+1}\\right) \\\\\nv_{n+1} &= v_{n} + \\Delta t\\left(\\frac{1}{2}a_{n} + \\frac{1}{2} a_{n+1}\\right)\n\\end{aligned}\n$$\n我们使用方程 $a_n = -\\omega^2 q_n$ 和 $a_{n+1} = -\\omega^2 q_{n+1}$。将它们代入 Newmark 方程得到：\n$$\nq_{n+1} = q_n + \\Delta t v_n - \\frac{\\Omega^2}{4}(q_n + q_{n+1}) \\\\\nv_{n+1} = v_n - \\frac{\\omega^2\\Delta t}{2}(q_n + q_{n+1})\n$$\n我们构建状态向量 $\\mathbf{y}_n = \\begin{pmatrix} q_n \\\\ \\Delta t v_n \\end{pmatrix}$ 并求解 $\\mathbf{y}_{n+1}$。首先，我们对第一个方程求解 $q_{n+1}$：\n$$\n(1 + \\frac{\\Omega^2}{4})q_{n+1} = (1 - \\frac{\\Omega^2}{4})q_n + \\Delta t v_n \\implies q_{n+1} = \\frac{1 - \\Omega^2/4}{1 + \\Omega^2/4}q_n + \\frac{1}{1 + \\Omega^2/4}\\Delta t v_n\n$$\n接下来，我们处理第二个方程，两边乘以 $\\Delta t$：\n$$\n\\Delta t v_{n+1} = \\Delta t v_n - \\frac{\\Omega^2}{2}(q_n + q_{n+1})\n$$\n代入 $q_{n+1}$ 的表达式来求 $q_n + q_{n+1}$：\n$$\nq_n + q_{n+1} = q_n + \\frac{1 - \\Omega^2/4}{1 + \\Omega^2/4}q_n + \\frac{1}{1 + \\Omega^2/4}\\Delta t v_n = \\frac{2}{1 + \\Omega^2/4}q_n + \\frac{1}{1 + \\Omega^2/4}\\Delta t v_n\n$$\n现在将此代入 $\\Delta t v_{n+1}$ 的方程中：\n$$\n\\Delta t v_{n+1} = \\Delta t v_n - \\frac{\\Omega^2}{2}\\left(\\frac{2}{1 + \\Omega^2/4}q_n + \\frac{1}{1 + \\Omega^2/4}\\Delta t v_n\\right) = -\\frac{\\Omega^2}{1 + \\Omega^2/4}q_n + \\left(1 - \\frac{\\Omega^2/2}{1 + \\Omega^2/4}\\right)\\Delta t v_n = -\\frac{\\Omega^2}{1 + \\Omega^2/4}q_n + \\frac{1 - \\Omega^2/4}{1 + \\Omega^2/4}\\Delta t v_n\n$$\n现在我们可以将系统写成矩阵形式 $\\mathbf{y}_{n+1} = \\mathbf{A}_{\\text{N}}\\mathbf{y}_n$：\n$$\n\\mathbf{A}_{\\text{N}} = \\frac{1}{1+\\Omega^2/4} \\begin{pmatrix} 1-\\Omega^2/4 & 1 \\\\ -\\Omega^2 & 1-\\Omega^2/4 \\end{pmatrix}\n$$\n特征值通过 $\\det(\\mathbf{A}_{\\text{N}} - \\lambda\\mathbf{I}) = 0$ 求得：\n$$\n\\left(\\frac{1-\\Omega^2/4}{1+\\Omega^2/4} - \\lambda\\right)^2 + \\frac{\\Omega^2}{(1+\\Omega^2/4)^2} = 0\n$$\n这给出了共轭复根：\n$$\n\\lambda_{1,2} = \\frac{1-\\Omega^2/4}{1+\\Omega^2/4} \\pm i \\frac{\\Omega}{1+\\Omega^2/4} = \\frac{1-\\Omega^2/4 \\pm i\\Omega}{1+\\Omega^2/4}\n$$\n\n**广义-$\\alpha$ 方法**\n\n广义-$\\alpha$ 方法使用一个包含加速度的状态向量，例如 $\\mathbf{z}_n = \\begin{pmatrix} q_n \\\\ \\Delta t v_n \\\\ \\Delta t^2 a_n \\end{pmatrix}$。其单步过程表示为一个线性系统 $\\mathbf{L}\\mathbf{z}_{n+1} = \\mathbf{R}\\mathbf{z}_n$，使其成为一个隐式方法。放大矩阵为 $\\mathbf{A}_{\\text{G}\\alpha} = \\mathbf{L}^{-1}\\mathbf{R}$。该系统是：\n$$\n\\begin{pmatrix} 1 & 0 & -\\beta \\\\ (1-\\alpha_f)\\Omega^2 & 0 & 1-\\alpha_m \\\\ 0 & 1 & -\\gamma \\end{pmatrix} \\begin{pmatrix} q_{n+1} \\\\ \\Delta t^2 a_{n+1} \\\\ \\Delta t v_{n+1} \\end{pmatrix} = \\begin{pmatrix} 1 & \\frac{1}{2}-\\beta & 1 \\\\ -\\alpha_f \\Omega^2 & -\\alpha_m & 0 \\\\ 0 & 1-\\gamma & 1 \\end{pmatrix} \\begin{pmatrix} q_n \\\\ \\Delta t^2 a_n \\\\ \\Delta t v_n \\end{pmatrix}\n$$\n放大因子是 $\\mathbf{A}_{\\text{G}\\alpha}$ 的特征值，它们是三次特征多项式 $\\det(\\mathbf{R}-\\lambda\\mathbf{L}) = 0$ 的根。特征值解析表达式的推导在代数上非常复杂，超出了一个简洁解答的范围。然而，在给定的二阶精度参数关系下，三个特征值中的一个是伪根且恒等于零（$\\lambda_3=0$）。剩下的两个物理特征值 $\\lambda_{1,2}$ 是共轭复数，其性质可以被描述。它们是一个二次方程的根，该方程的系数是关于 $\\Omega^2$ 和参数 $\\rho_\\infty$ 的复杂有理函数。其关键设计特点是对于所有 $\\Omega \\ge 0$ 都有 $|\\lambda_{1,2}| \\le 1$（无条件稳定），并且当 $\\Omega \\to \\infty$ 时 $|\\lambda_{1,2}| \\to \\rho_\\infty$。\n\n任务2：放大因子的轨迹及其解释\n\n- **中心差分法**：对于 $\\Omega \\in [0, 2]$，特征值为一对共轭复数，其模长为 $|\\lambda| = \\sqrt{(1-\\Omega^2/2)^2 + (\\Omega^2 - \\Omega^4/4)} = 1$。特征值的轨迹位于复平面的单位圆上。在 $\\Omega=0$ 时，$\\lambda=1$。随着 $\\Omega$ 的增加，特征值沿着上半圆和下半圆移动，在 $\\Omega=2$ 时到达 $\\lambda=-1$。这种行为表明，该方法在其稳定范围内是无耗散的（它保持能量），这对于无阻尼系统是正确的。然而，其相位并不精确。数值相角 $\\bar{\\Omega} = \\arccos(1-\\Omega^2/2)$ 小于精确相角 $\\Omega$，导致周期伸长（数值频散）。数值解的周期 $T_{\\text{num}} = 2\\pi/\\bar{\\omega}$ 长于精确周期 $T=2\\pi/\\omega$。对于 $\\Omega > 2$，特征值变为实数，光谱半径超过 $1$，表明系统不稳定。\n\n- **Newmark 法（平均加速度法）**：对于所有 $\\Omega \\ge 0$，特征值的模长平方为 $|\\lambda|^2 = \\frac{(1-\\Omega^2/4)^2 + \\Omega^2}{(1+\\Omega^2/4)^2} = \\frac{1-\\Omega^2/2+\\Omega^4/16+\\Omega^2}{1+\\Omega^2/2+\\Omega^4/16} = 1$。特征值的轨迹是整个单位圆。从 $\\Omega=0$ 时的 $\\lambda=1$ 开始，它们沿着单位圆移动，在 $\\Omega=2$ 时通过 $\\mp i$，并在 $\\Omega \\to \\infty$ 时接近 $\\lambda=-1$。与中心差分法一样，该格式是无耗散的。它是无条件稳定的（$A$-稳定）。它也表现出数值频散（周期伸长），因为数值相角 $\\bar{\\Omega} = \\arctan(\\frac{\\Omega}{1-\\Omega^2/4})$ 不同于 $\\Omega$。\n\n- **广义-$\\alpha$ 方法**：对于 $\\rho_\\infty < 1$，该方法引入了数值耗散。主特征值的轨迹从 $\\Omega=0$ 时的 $\\lambda=1$ 开始。随着 $\\Omega$ 的增加，轨迹在单位圆内向内螺旋。当 $\\Omega \\to \\infty$ 时，特征值接近负实轴上的点 $-\\rho_\\infty$。这意味着当 $\\Omega > 0$ 时 $|\\lambda| < 1$。该方法是耗散的，耗散量由 $\\rho_\\infty$ 控制。更高频率（更大的 $\\Omega$）被更强烈地阻尼，这是滤除半离散模型中经常出现的伪高频成分的理想特性。该方法也存在数值频散，对于小的 $\\Omega$ 通常表现为周期缩短，然后过渡到周期伸长。$A$-稳定性确保了所有模态响应都被阻尼，而不是被放大。\n\n任务3：中心差分法的稳定性极限\n\n中心差分法保持稳定的条件是其放大矩阵的光谱半径 $\\rho(\\mathbf{A}_{\\text{CD}})$ 小于或等于 $1$。特征值由 $\\lambda_{1,2} = 1 - \\frac{\\Omega^2}{2} \\pm \\sqrt{(1 - \\frac{\\Omega^2}{2})^2 - 1}$ 给出。\n\n- 如果 $0 \\le \\Omega \\le 2$，平方根下的项为非正数。特征值形成共轭复数对 $\\lambda_{1,2} = x \\pm iy$，其中 $x = 1-\\frac{\\Omega^2}{2}$，$y = \\frac{\\Omega}{2}\\sqrt{4-\\Omega^2}$。它们的模长为 $|\\lambda| = \\sqrt{x^2+y^2} = 1$。该方法是临界稳定的。\n- 如果 $\\Omega > 2$，平方根下的项为正数。特征值是实数且不相等：$\\lambda_{1,2} = 1 - \\frac{\\Omega^2}{2} \\pm \\frac{\\Omega}{2}\\sqrt{\\Omega^2-4}$。光谱半径是模长较大的特征值的模长。由于 $\\Omega^2/2 > 2$，所以 $1-\\Omega^2/2 < -1$。模长最大的特征值是 $\\lambda_1 = 1 - \\frac{\\Omega^2}{2} - \\sqrt{\\frac{\\Omega^4}{4}-\\Omega^2}$。其模长为 $|\\lambda_1| = \\frac{\\Omega^2}{2} - 1 + \\sqrt{\\frac{\\Omega^4}{4}-\\Omega^2} > 1$。该方法是不稳定的。\n\n从稳定到不稳定的转换发生在 $\\Omega=2$。因此，中心差分法保持临界稳定的最大无量纲时间步长是 $\\Omega_{\\max}=2$。", "answer": "$$\n\\boxed{2}\n$$", "id": "2545014"}, {"introduction": "显式方法的一大优势是其计算效率，这通常得益于“质量集中”（mass lumping）这一建模技巧。然而，这种简化会如何影响仿真的物理真实性呢？本练习将通过一个一维杆的振动分析，引导您动手计算并量化质量集中对系统固有频率引入的误差，从而让您深刻理解在显式与隐式方法之间，计算效率与模型精度这一核心权衡 [@problem_id:2545080]。", "problem": "一根长度为 $L$、横截面积为 $A$、杨氏模量为 $E$、质量密度为 $\\rho$ 的均匀、等截面、线弹性杆，两端固定，发生微小纵向振动。其控制强形式为轴向波动方程 $ \\rho A \\,\\ddot{u}(x,t) - \\frac{\\partial}{\\partial x}\\big(EA\\, \\frac{\\partial u}{\\partial x}(x,t)\\big) = 0 $，其中 $x \\in (0,L)$，本质边界条件为 $u(0,t)=0$ 和 $u(L,t)=0$。考虑使用标准的 Galerkin 有限元法（FEM）进行空间半离散化，将杆均匀划分为 $N=3$ 个等长单元，并采用连续的分段线性形函数。精确施加本质边界条件，使得唯一的全局未知量是内部节点的位移。\n\n作为背景，许多隐式时间积分方法（例如 Newmark 族）使用一致质量矩阵，而许多显式方法（例如中心差分格式）则使用对角的集中质量矩阵以避免求解线性系统。质量矩阵的选择会改变离散模态特性。\n\n从强形式乘以一个试函数并在 $(0,L)$ 上积分，并对刚度项进行分部积分得到的弱形式出发，在每个单元上使用标准的双节点线性形函数，执行以下步骤，除了由均匀网格和施加的边界条件所产生的正交性外，不作任何特殊的正交性假设：\n- 对于一致质量矩阵 $M^{(C)}$ 和通过在单元层面将一致质量矩阵进行精确行求和集总得到的完全对角集中质量矩阵 $M^{(L)}$，分别推导单元刚度矩阵和质量矩阵，并在施加边界条件后，为 $N=3$ 单元网格组装成 $K\\,\\mathbf{u}(t) + M\\,\\ddot{\\mathbf{u}}(t) = \\mathbf{0}$ 形式的全局半离散系统。\n- 建立相应的广义特征值问题 $K\\,\\boldsymbol{\\phi}^{(C)}=\\omega^{2}\\,M^{(C)}\\,\\boldsymbol{\\phi}^{(C)}$ 和 $K\\,\\boldsymbol{\\phi}^{(L)}=\\omega^{2}\\,M^{(L)}\\,\\boldsymbol{\\phi}^{(L)}$。\n- 以闭式解的形式计算前 2 个离散角频率 $\\omega_{1}^{(C)}$、$\\omega_{2}^{(C)}$（一致质量）和 $\\omega_{1}^{(L)}$、$\\omega_{2}^{(L)}$（集中质量）。\n\n将模态 $p \\in \\{1,2\\}$ 的相对频率误差定义为\n$$\n\\varepsilon_{p} \\equiv \\frac{\\omega_{p}^{(L)} - \\omega_{p}^{(C)}}{\\omega_{p}^{(C)}},\n$$\n并将前两个离散模态的相对频率误差的最大绝对值定义为\n$$\n\\mathcal{E}_{\\max} \\equiv \\max\\{|\\varepsilon_{1}|,\\,|\\varepsilon_{2}|\\}.\n$$\n\n将 $\\mathcal{E}_{\\max}$ 计算为仅含根式和整数的单一闭式解析表达式。不要为 $E$、$\\rho$、 $A$ 或 $L$ 引入任何数值；最终表达式必须与材料和几何参数无关。将答案表示为一个不带单位的纯数。无需四舍五入。", "solution": "对问题陈述进行了严格审查，认定其有效。该问题具有科学依据，是适定的、客观的，并包含获得唯一解所需的所有必要信息。此问题是结构动力学有限元分析中的一个标准练习。\n\n均匀杆纵向振动的控制方程的强形式为\n$$ \\rho A \\frac{\\partial^2 u}{\\partial t^2}(x,t) - \\frac{\\partial}{\\partial x}\\left(EA \\frac{\\partial u}{\\partial x}(x,t)\\right) = 0, \\quad x \\in (0,L) $$\n边界条件为 $u(0,t)=0$ 和 $u(L,t)=0$。相应的弱形式通过乘以一个试函数 $v(x)$ 并进行分部积分得到：\n$$ \\int_0^L \\rho A v \\ddot{u} \\,dx + \\int_0^L EA \\frac{\\partial v}{\\partial x} \\frac{\\partial u}{\\partial x} \\,dx = 0 $$\n解 $u(x,t)$ 被近似为 $u(x,t) \\approx \\sum_{i} N_i(x) u_i(t)$，其中 $N_i(x)$ 是形函数。这种半离散化导出了矩阵系统 $M \\ddot{\\mathbf{u}} + K \\mathbf{u} = \\mathbf{0}$。\n\n我们首先为一个长度为 $h$ 的标准 2 节点线性杆单元推导单元刚度矩阵和质量矩阵。在局部坐标 $\\xi \\in [0,h]$ 中，形函数为 $N_1(\\xi) = 1 - \\frac{\\xi}{h}$ 和 $N_2(\\xi) = \\frac{\\xi}{h}$。它们的导数为 $N_1'(\\xi) = -\\frac{1}{h}$ 和 $N_2'(\\xi) = \\frac{1}{h}$。\n\n单元刚度矩阵 $k_e$ 的元素为 $k_{ij} = \\int_0^h EA N_i' N_j' d\\xi$。\n$$ k_e = \\int_0^h EA \\begin{pmatrix} (-1/h)^2 & (-1/h)(1/h) \\\\ (1/h)(-1/h) & (1/h)^2 \\end{pmatrix} d\\xi = \\frac{EA}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\n\n单元一致质量矩阵 $m_e^{(C)}$ 的元素为 $m_{ij}^{(C)} = \\int_0^h \\rho A N_i N_j d\\xi$。\n$$ m_{11}^{(C)} = \\rho A \\int_0^h (1-\\frac{\\xi}{h})^2 d\\xi = \\frac{\\rho A h}{3} $$\n$$ m_{12}^{(C)} = \\rho A \\int_0^h (1-\\frac{\\xi}{h})(\\frac{\\xi}{h}) d\\xi = \\frac{\\rho A h}{6} $$\n$$ m_e^{(C)} = \\frac{\\rho A h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} $$\n\n单元集中质量矩阵 $m_e^{(L)}$ 是通过将 $m_e^{(C)}$ 的各行求和并将和值置于对角线上得到的。每行的和是 $\\frac{\\rho A h}{6}(2+1) = \\frac{\\rho A h}{2}$。\n$$ m_e^{(L)} = \\frac{\\rho A h}{2} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} $$\n\n杆被离散为 $N=3$ 个等长单元，因此单元长度为 $h=L/3$。共有 4 个节点，索引为 $0, 1, 2, 3$。边界条件 $u(0,t)=0$ 和 $u(L,t)=0$ 意味着节点 0 和节点 3 的位移 $u_0$ 和 $u_3$ 为零。未知自由度是内部节点 1 和 2 的位移，$\\mathbf{u} = [u_1, u_2]^T$。我们组装全局矩阵，然后提取对应于这些自由节点的 $2 \\times 2$ 子系统。\n\n组装全局刚度矩阵 $K$：\n$$ K = \\frac{EA}{h} \\begin{pmatrix} 1+1 & -1 \\\\ -1 & 1+1 \\end{pmatrix} = \\frac{3EA}{L} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} $$\n\n组装全局一致质量矩阵 $M^{(C)}$：\n$$ M^{(C)} = \\frac{\\rho A h}{6} \\begin{pmatrix} 2+2 & 1 \\\\ 1 & 2+2 \\end{pmatrix} = \\frac{\\rho A (L/3)}{6} \\begin{pmatrix} 4 & 1 \\\\ 1 & 4 \\end{pmatrix} = \\frac{\\rho A L}{18} \\begin{pmatrix} 4 & 1 \\\\ 1 & 4 \\end{pmatrix} $$\n\n组装全局集中质量矩阵 $M^{(L)}$：\n$$ M^{(L)} = \\frac{\\rho A h}{2} \\begin{pmatrix} 1+1 & 0 \\\\ 0 & 1+1 \\end{pmatrix} = \\frac{\\rho A (L/3)}{2} \\begin{pmatrix} 2 & 0 \\\\ 0 & 2 \\end{pmatrix} = \\frac{\\rho A L}{3} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} $$\n\n现在我们求解广义特征值问题 $K \\boldsymbol{\\phi} = \\omega^2 M \\boldsymbol{\\phi}$，即 $\\det(K - \\omega^2 M) = 0$。\n\n对于一致质量，$M = M^{(C)}$，问题为 $\\det(K - (\\omega^{(C)})^2 M^{(C)}) = 0$。令 $\\lambda_C = (\\omega^{(C)})^2$。\n$$ \\det\\left( \\frac{3EA}{L} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} - \\lambda_C \\frac{\\rho A L}{18} \\begin{pmatrix} 4 & 1 \\\\ 1 & 4 \\end{pmatrix} \\right) = 0 $$\n我们定义一个常数 $C_0 = \\frac{54E}{\\rho L^2}$。行列式变为：\n$$ \\det\\left( \\frac{C_0}{18} \\frac{\\rho A L}{3} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} - \\lambda_C \\frac{\\rho A L}{18} \\begin{pmatrix} 4 & 1 \\\\ 1 & 4 \\end{pmatrix} \\right) = 0 $$\n$$ \\det\\left( C_0 \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} - \\lambda_C \\begin{pmatrix} 4 & 1 \\\\ 1 & 4 \\end{pmatrix} \\right) = 0 $$\n$$ \\det \\begin{pmatrix} 2C_0 - 4\\lambda_C & -C_0 - \\lambda_C \\\\ -C_0 - \\lambda_C & 2C_0 - 4\\lambda_C \\end{pmatrix} = 0 $$\n这得到 $(2C_0 - 4\\lambda_C)^2 - (C_0 + \\lambda_C)^2 = 0$，它给出两个解：\n1. $2C_0 - 4\\lambda_C = C_0 + \\lambda_C \\implies C_0 = 5\\lambda_C \\implies \\lambda_C = C_0/5$。\n2. $2C_0 - 4\\lambda_C = -(C_0 + \\lambda_C) \\implies 3C_0 = 3\\lambda_C \\implies \\lambda_C = C_0$。\n特征值为 $(\\omega_{1}^{(C)})^2 = \\frac{C_0}{5} = \\frac{54}{5} \\frac{E}{\\rho L^2}$ 和 $(\\omega_{2}^{(C)})^2 = C_0 = 54 \\frac{E}{\\rho L^2}$。\n\n对于集中质量，$M = M^{(L)}$，问题为 $\\det(K - (\\omega^{(L)})^2 M^{(L)}) = 0$。令 $\\lambda_L = (\\omega^{(L)})^2$。\n$$ \\det\\left( \\frac{3EA}{L} \\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix} - \\lambda_L \\frac{\\rho A L}{3} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} \\right) = 0 $$\n这是一个关于矩阵 $K$ 的标准特征值问题。设 $\\mu$ 为 $\\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}$ 的特征值。\n$\\det \\begin{pmatrix} 2-\\mu & -1 \\\\ -1 & 2-\\mu \\end{pmatrix} = (2-\\mu)^2 - 1 = 0 \\implies 2-\\mu = \\pm 1$。\n特征值为 $\\mu_1 = 1$ 和 $\\mu_2 = 3$。\n关系式为 $\\frac{3EA}{L} \\mu = \\lambda_L \\frac{\\rho A L}{3}$，所以 $\\lambda_L = \\mu \\frac{9E}{\\rho L^2}$。\n特征值为 $(\\omega_{1}^{(L)})^2 = 1 \\cdot \\frac{9E}{\\rho L^2} = 9 \\frac{E}{\\rho L^2}$ 和 $(\\omega_{2}^{(L)})^2 = 3 \\cdot \\frac{9E}{\\rho L^2} = 27 \\frac{E}{\\rho L^2}$。\n\n现在我们通过取平方根来计算角频率。所有物理参数均为正。\n$\\omega_{1}^{(C)} = \\sqrt{\\frac{54}{5} \\frac{E}{\\rho L^2}}$，$\\omega_{2}^{(C)} = \\sqrt{54 \\frac{E}{\\rho L^2}}$\n$\\omega_{1}^{(L)} = \\sqrt{9 \\frac{E}{\\rho L^2}} = 3 \\sqrt{\\frac{E}{\\rho L^2}}$，$\\omega_{2}^{(L)} = \\sqrt{27 \\frac{E}{\\rho L^2}}$\n\n模态 $p$ 的相对频率误差为 $\\varepsilon_{p} = \\frac{\\omega_{p}^{(L)} - \\omega_{p}^{(C)}}{\\omega_{p}^{(C)}} = \\frac{\\omega_{p}^{(L)}}{\\omega_{p}^{(C)}} - 1$。\n对于模态 $p=1$：\n$$ \\frac{\\omega_{1}^{(L)}}{\\omega_{1}^{(C)}} = \\frac{\\sqrt{9}}{\\sqrt{54/5}} = \\sqrt{\\frac{9 \\cdot 5}{54}} = \\sqrt{\\frac{45}{54}} = \\sqrt{\\frac{5}{6}} $$\n$$ \\varepsilon_{1} = \\sqrt{\\frac{5}{6}} - 1 $$\n对于模态 $p=2$：\n$$ \\frac{\\omega_{2}^{(L)}}{\\omega_{2}^{(C)}} = \\frac{\\sqrt{27}}{\\sqrt{54}} = \\sqrt{\\frac{27}{54}} = \\sqrt{\\frac{1}{2}} = \\frac{1}{\\sqrt{2}} $$\n$$ \\varepsilon_{2} = \\frac{1}{\\sqrt{2}} - 1 $$\n两个误差都是负的，正如预期的那样，因为质量集总会降低离散频率。\n\n我们需要计算 $\\mathcal{E}_{\\max} = \\max\\{|\\varepsilon_{1}|,\\,|\\varepsilon_{2}|\\}$。\n$|\\varepsilon_1| = \\left|\\sqrt{\\frac{5}{6}} - 1\\right| = 1 - \\sqrt{\\frac{5}{6}}$。\n$|\\varepsilon_2| = \\left|\\frac{1}{\\sqrt{2}} - 1\\right| = 1 - \\frac{1}{\\sqrt{2}}$。\n为了比较这些值，我们比较 $\\sqrt{5/6}$ 和 $1/\\sqrt{2}$。两边平方得到 $5/6$ 和 $1/2$。\n因为 $\\frac{5}{6} > \\frac{1}{2}$ (即 $0.833... > 0.5$)，所以 $\\sqrt{\\frac{5}{6}} > \\frac{1}{\\sqrt{2}}$。\n这意味着 $1 - \\sqrt{\\frac{5}{6}} < 1 - \\frac{1}{\\sqrt{2}}$。\n因此，$|\\varepsilon_1| < |\\varepsilon_2|$，最大误差是 $|\\varepsilon_2|$。\n$$ \\mathcal{E}_{\\max} = |\\varepsilon_2| = 1 - \\frac{1}{\\sqrt{2}} = 1 - \\frac{\\sqrt{2}}{2} = \\frac{2 - \\sqrt{2}}{2} $$\n此表达式是一个纯数，与材料和几何参数无关，符合要求。", "answer": "$$\n\\boxed{\\frac{2 - \\sqrt{2}}{2}}\n$$", "id": "2545080"}]}