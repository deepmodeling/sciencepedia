{"hands_on_practices": [{"introduction": "理解一致质量矩阵和集中质量矩阵的根源是掌握其应用的第一步。本练习将指导您从最基本的第一性原理——动能表达式——出发，为简单的一维杆单元推导其一致质量矩阵。通过这个过程，您将直接看到形函数如何构建出耦合的惯性项，同时，本练习还将介绍行和集总法作为一种实用的简化，并通过具体计算比较这两种方法在表示系统动能上的差异 [@problem_id:2546885]。", "problem": "一根进行一维轴向运动的均匀细杆，使用长度为 $L$、横截面积为 $A$ 的单个双节点线性单元通过有限元法（FEM）进行建模。材料密度为常数，等于 $\\rho$。设 $x$ 表示沿单元测量的物理坐标，其中 $x \\in [0,L]$。连续杆的动能由标准定义给出：$T = \\tfrac{1}{2} \\int_{0}^{L} \\rho A \\, v(x,t)^{2} \\, \\mathrm{d}x$。在 Galerkin 半离散格式中，速度场近似为 $v(x,t) \\approx N_{1}(x)\\,\\dot{d}_{1}(t) + N_{2}(x)\\,\\dot{d}_{2}(t)$，其中 $N_{1}(x)$ 和 $N_{2}(x)$ 是与两个节点相关的线性形函数，$\\dot{d}_{1}(t)$ 和 $\\dot{d}_{2}(t)$ 是节点速度。\n\n从动能定义和线性形函数出发，推导一致单元质量矩阵，然后通过对一致质量矩阵进行行和集总，构建一个集中（对角）单元质量矩阵。对于一个具体单元，其参数为 $L = 0.8\\,\\mathrm{m}$，$A = 2.5 \\times 10^{-4}\\,\\mathrm{m}^{2}$，以及 $\\rho = 7800\\,\\mathrm{kg/m}^{3}$，考虑节点速度向量 $\\dot{\\mathbf{d}} = \\begin{pmatrix} \\dot{d}_{1} \\\\ \\dot{d}_{2} \\end{pmatrix} = \\begin{pmatrix} 0.35 \\\\ 1.10 \\end{pmatrix}\\,\\mathrm{m/s}$。\n\n设 $T_{\\mathrm{c}}$ 是用一致质量矩阵计算的动能，$T_{\\mathrm{l}}$ 是用集中质量矩阵计算的动能。针对该单元和这些节点速度，计算比率 $R = T_{\\mathrm{c}}/T_{\\mathrm{l}}$。将最终答案表示为一个无量纲数，并四舍五入到四位有效数字。", "solution": "所述问题在科学上是合理的、适定的和客观的。它提出了一个在结构动力学的有限元法中构建质量矩阵的标准练习。所有必要的数据均已提供，任务是进行一系列明确的推导和计算。因此，该问题是有效的，并将提供解答。\n\n连续体的动能 $T$ 由下式给出\n$$T = \\frac{1}{2} \\int_{V} \\rho \\, \\mathbf{v} \\cdot \\mathbf{v} \\, \\mathrm{d}V$$\n对于横截面积 $A$ 恒定的杆的一维轴向运动，该公式简化为\n$$T = \\frac{1}{2} \\int_{0}^{L} \\rho A \\, v(x,t)^{2} \\, \\mathrm{d}x$$\n其中 $v(x,t)$ 是在位置 $x$ 和时间 $t$ 的轴向速度。\n\n在有限元框架内，单元内部的速度场 $v(x,t)$ 使用形函数 $N_i(x)$ 和节点速度 $\\dot{d}_i(t)$ 进行近似。对于一个双节点线性单元，这种近似为\n$$v(x,t) \\approx \\mathbf{N}(x) \\dot{\\mathbf{d}}(t) = \\begin{pmatrix} N_1(x) & N_2(x) \\end{pmatrix} \\begin{pmatrix} \\dot{d}_1(t) \\\\ \\dot{d}_2(t) \\end{pmatrix}$$\n其中 $\\mathbf{N}(x)$ 是形函数的行向量，$\\dot{\\mathbf{d}}(t)$ 是节点速度的列向量。节点位于 $x=0$ 和 $x=L$ 的双节点单元的标准线性形函数为\n$$N_1(x) = 1 - \\frac{x}{L}$$\n$$N_2(x) = \\frac{x}{L}$$\n将速度近似值代入动能表达式，得到\n$$T \\approx \\frac{1}{2} \\int_{0}^{L} \\rho A \\left( \\mathbf{N}(x) \\dot{\\mathbf{d}}(t) \\right)^{2} \\, \\mathrm{d}x = \\frac{1}{2} \\int_{0}^{L} \\rho A \\left( \\dot{\\mathbf{d}}^{T} \\mathbf{N}^{T}(x) \\mathbf{N}(x) \\dot{\\mathbf{d}} \\right) \\, \\mathrm{d}x$$\n由于节点速度 $\\dot{\\mathbf{d}}$ 不依赖于空间坐标 $x$，我们可以写成\n$$T = \\frac{1}{2} \\dot{\\mathbf{d}}^{T} \\left( \\rho A \\int_{0}^{L} \\mathbf{N}^{T}(x) \\mathbf{N}(x) \\, \\mathrm{d}x \\right) \\dot{\\mathbf{d}}$$\n其形式为 $T = \\frac{1}{2} \\dot{\\mathbf{d}}^{T} \\mathbf{M}_{\\mathrm{e}} \\dot{\\mathbf{d}}$，其中 $\\mathbf{M}_{\\mathrm{e}}$ 是单元质量矩阵。\n\n首先，我们推导由积分项定义的一致质量矩阵 $\\mathbf{M}_{\\mathrm{c}}$：\n$$\\mathbf{M}_{\\mathrm{c}} = \\rho A \\int_{0}^{L} \\mathbf{N}^{T}(x) \\mathbf{N}(x) \\, \\mathrm{d}x = \\rho A \\int_{0}^{L} \\begin{pmatrix} N_1(x)^2 & N_1(x)N_2(x) \\\\ N_2(x)N_1(x) & N_2(x)^2 \\end{pmatrix} \\, \\mathrm{d}x$$\n矩阵的各分量需要计算以下积分：\n$$\\int_{0}^{L} N_1(x)^2 \\, \\mathrm{d}x = \\int_{0}^{L} \\left(1 - \\frac{x}{L}\\right)^2 \\, \\mathrm{d}x = \\left[ L - \\frac{x^2}{L} + \\frac{x^3}{3L^2} \\right]_{0}^{L} = L - L + \\frac{L}{3} = \\frac{L}{3}$$\n$$\\int_{0}^{L} N_2(x)^2 \\, \\mathrm{d}x = \\int_{0}^{L} \\left(\\frac{x}{L}\\right)^2 \\, \\mathrm{d}x = \\left[ \\frac{x^3}{3L^2} \\right]_{0}^{L} = \\frac{L}{3}$$\n$$\\int_{0}^{L} N_1(x)N_2(x) \\, \\mathrm{d}x = \\int_{0}^{L} \\left(1 - \\frac{x}{L}\\right)\\left(\\frac{x}{L}\\right) \\, \\mathrm{d}x = \\left[ \\frac{x^2}{2L} - \\frac{x^3}{3L^2} \\right]_{0}^{L} = \\frac{L}{2} - \\frac{L}{3} = \\frac{L}{6}$$\n综合这些结果，一致质量矩阵为：\n$$\\mathbf{M}_{\\mathrm{c}} = \\rho A \\begin{pmatrix} \\frac{L}{3} & \\frac{L}{6} \\\\ \\frac{L}{6} & \\frac{L}{3} \\end{pmatrix} = \\frac{\\rho A L}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$$\n接下来，我们通过行和集总法构建集中质量矩阵 $\\mathbf{M}_{\\mathrm{l}}$。$\\mathbf{M}_{\\mathrm{l}}$ 的每个对角项是 $\\mathbf{M}_{\\mathrm{c}}$ 对应行中所有项的和，所有非对角项均为零。\n第1行之和：$\\frac{\\rho A L}{6}(2+1) = \\frac{3\\rho A L}{6} = \\frac{\\rho A L}{2}$\n第2行之和：$\\frac{\\rho A L}{6}(1+2) = \\frac{3\\rho A L}{6} = \\frac{\\rho A L}{2}$\n因此，集中质量矩阵为：\n$$\\mathbf{M}_{\\mathrm{l}} = \\begin{pmatrix} \\frac{\\rho A L}{2} & 0 \\\\ 0 & \\frac{\\rho A L}{2} \\end{pmatrix} = \\frac{\\rho A L}{2} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$$\n使用一致质量矩阵计算的动能 $T_{\\mathrm{c}}$ 是\n$$T_{\\mathrm{c}} = \\frac{1}{2} \\dot{\\mathbf{d}}^{T} \\mathbf{M}_{\\mathrm{c}} \\dot{\\mathbf{d}} = \\frac{1}{2} \\begin{pmatrix} \\dot{d}_1 & \\dot{d}_2 \\end{pmatrix} \\left( \\frac{\\rho A L}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} \\right) \\begin{pmatrix} \\dot{d}_1 \\\\ \\dot{d}_2 \\end{pmatrix}$$\n$$T_{\\mathrm{c}} = \\frac{\\rho A L}{12} \\left[ 2\\dot{d}_1^2 + 2\\dot{d}_1\\dot{d}_2 + 2\\dot{d}_2^2 \\right] = \\frac{\\rho A L}{6} \\left( \\dot{d}_1^2 + \\dot{d}_1\\dot{d}_2 + \\dot{d}_2^2 \\right)$$\n使用集中质量矩阵计算的动能 $T_{\\mathrm{l}}$ 是\n$$T_{\\mathrm{l}} = \\frac{1}{2} \\dot{\\mathbf{d}}^{T} \\mathbf{M}_{\\mathrm{l}} \\dot{\\mathbf{d}} = \\frac{1}{2} \\begin{pmatrix} \\dot{d}_1 & \\dot{d}_2 \\end{pmatrix} \\left( \\frac{\\rho A L}{2} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} \\right) \\begin{pmatrix} \\dot{d}_1 \\\\ \\dot{d}_2 \\end{pmatrix} = \\frac{\\rho A L}{4} \\left( \\dot{d}_1^2 + \\dot{d}_2^2 \\right)$$\n问题要求计算比率 $R = T_{\\mathrm{c}} / T_{\\mathrm{l}}$。\n$$R = \\frac{\\frac{\\rho A L}{6} \\left( \\dot{d}_1^2 + \\dot{d}_1\\dot{d}_2 + \\dot{d}_2^2 \\right)}{\\frac{\\rho A L}{4} \\left( \\dot{d}_1^2 + \\dot{d}_2^2 \\right)}$$\n项 $\\rho A L$ 被消掉，表明该比率与材料属性和单元几何形状无关。\n$$R = \\frac{4}{6} \\frac{\\dot{d}_1^2 + \\dot{d}_1\\dot{d}_2 + \\dot{d}_2^2}{\\dot{d}_1^2 + \\dot{d}_2^2} = \\frac{2}{3} \\frac{\\dot{d}_1^2 + \\dot{d}_1\\dot{d}_2 + \\dot{d}_2^2}{\\dot{d}_1^2 + \\dot{d}_2^2}$$\n现在，我们代入给定的节点速度 $\\dot{d}_1 = 0.35$ 和 $\\dot{d}_2 = 1.10$。\n$$\\dot{d}_1^2 = (0.35)^2 = 0.1225$$\n$$\\dot{d}_2^2 = (1.10)^2 = 1.21$$\n$$\\dot{d}_1\\dot{d}_2 = (0.35)(1.10) = 0.385$$\n将这些值代入 $R$ 的表达式中：\n$$R = \\frac{2}{3} \\frac{0.1225 + 0.385 + 1.21}{0.1225 + 1.21} = \\frac{2}{3} \\frac{1.7175}{1.3325}$$\n进行计算：\n$$R \\approx \\frac{2}{3} \\times 1.28893058... \\approx 0.85928705...$$\n四舍五入到四位有效数字，该比率为 $0.8593$。", "answer": "$$\\boxed{0.8593}$$", "id": "2546885"}, {"introduction": "从推导转向应用，选择一致质量矩阵还是集中质量矩阵会对动态分析的结果产生深远影响。本练习探讨了这种选择对二维薄膜自由振动频率的影响，清晰地展示了质量集总如何在简化计算的同时改变系统预测的动态特性 [@problem_id:2562470]。此外，本练习还通过证明两种方法都能精确守恒系统总质量，加深了您对有限元方法基本性质的理解。", "problem": "考虑一个在单位正方形域 $\\Omega = [0,1]\\times[0,1]$ 上的均匀膜的自由横向振动，其边界为固支边界（在 $\\partial\\Omega$ 上满足狄利克雷条件 $u=0$）。其控制弱形式为：寻找非平凡解 $u$ 和角频率 $\\omega$，使得\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\Omega \\;=\\; \\omega^{2} \\int_{\\Omega} u \\, v \\, d\\Omega\n\\quad \\text{对所有测试函数 } v \\text{ 成立}。\n$$\n设该膜具有均匀的表面质量密度 $\\rho t = 1$。使用有限元法（FEM）进行离散化，在 $\\Omega$ 的一个均匀三角剖分上使用分片线性（仿射）形函数。该剖分通过将 $\\Omega$ 划分为 $2\\times 2$ 个边长为 $h=1/2$ 的全等正方形，然后沿每个正方形的左下角到右上角的对角线进行细分得到。这将产生 $8$ 个面积为 $A = h^{2}/2 = 1/8$ 的直角三角形。使用标准的一致质量矩阵（其元素为 $M_{ij} = \\int_{\\Omega} N_{i} N_{j} \\, d\\Omega$）、行和集中质量矩阵（其对角元素为 $M^{L}_{ii} = \\sum_{j} M_{ij}$）以及标准的刚度矩阵（其元素为 $K_{ij} = \\int_{\\Omega} \\nabla N_{i}\\cdot \\nabla N_{j}\\, d\\Omega$）。\n\n任务：\n1) 从形函数的单位分解性质 $\\sum_{i} N_{i} \\equiv 1$ 出发，证明组装后的一致质量矩阵在以下意义上精确地守恒总质量：\n$$\n\\boldsymbol{1}^{\\top} \\mathbf{M} \\, \\boldsymbol{1} \\;=\\; \\int_{\\Omega} 1 \\, d\\Omega \\;=\\; 1,\n$$\n其中 $\\boldsymbol{1}$ 是元素全为1的向量。然后，证明行和集中质量矩阵也精确地守恒总质量，即：\n$$\n\\sum_{i} M^{L}_{ii} \\;=\\; \\boldsymbol{1}^{\\top} \\mathbf{M} \\, \\boldsymbol{1} \\;=\\; 1.\n$$\n假设所有积分都是精确计算的。\n\n2) 通过消除边界自由度来施加狄利克雷边界条件，并观察到只有位于正方形中心的内部节点保留下来。利用以下信息，为该内部自由度显式计算广义特征值问题 $\\mathbf{K}\\mathbf{u} = \\omega^{2} \\mathbf{M}\\mathbf{u}$ 所需的单项简化刚度和质量：\n- 对于每个三角形单元，线性形函数 $N_{i}$ 的梯度在单元上是常数，可写为 $\\nabla N_{i} = \\frac{1}{2A} \\begin{bmatrix} b_{i} \\\\ c_{i} \\end{bmatrix}$，其中 $b_{i}$ 和 $c_{i}$ 仅取决于单元的顶点坐标。\n- 对于面积为 $A$ 的线性三角形单元，单元一致质量的对角贡献为 $\\int_{T} N_{i}^{2}\\, d\\Omega = \\frac{A}{6}$，行和集中质量的对角贡献为 $\\frac{A}{3}$。\n\n3) 使用组装后的简化量，为一致质量矩阵和集中质量矩阵建立单自由度广义特征值问题，并确定预测的基频角频率之比，\n$$\nR \\;=\\; \\frac{\\omega_{\\mathrm{lumped}}}{\\omega_{\\mathrm{consistent}}}.\n$$\n将 $R$ 的最终答案表示为一个无单位的简化精确表达式。不要四舍五入。", "solution": "该问题陈述经评估是有效的，因为它具有科学依据、问题提法恰当且客观。它代表了结构动力学中有限元法的一个标准问题。我们按顺序对三个任务进行求解。\n\n矩阵形式的控制性广义特征值问题是 $\\mathbf{K}\\mathbf{u} = \\omega^{2}\\mathbf{M}\\mathbf{u}$，其中 $\\mathbf{K}$ 是全局刚度矩阵，其元素为 $K_{ij} = \\int_{\\Omega} \\nabla N_{i}\\cdot \\nabla N_{j}\\, d\\Omega$，$\\mathbf{M}$ 是全局质量矩阵，其元素为 $M_{ij} = \\int_{\\Omega} (\\rho t) N_{i} N_{j} \\, d\\Omega$。给定均匀表面质量密度 $\\rho t = 1$，质量矩阵的元素为 $M_{ij} = \\int_{\\Omega} N_{i} N_{j} \\, d\\Omega$。\n\n任务1：质量守恒的证明\n\n我们需要证明一致质量矩阵和集中质量矩阵都守恒膜的总质量，即 $\\int_{\\Omega} \\rho t \\, d\\Omega = \\int_{\\Omega} 1 \\, d\\Omega = 1$。\n\n首先，考虑一致质量矩阵 $\\mathbf{M}$。该矩阵所代表的总质量可以通过对其所有元素求和来计算，这等同于二次型 $\\boldsymbol{1}^{\\top} \\mathbf{M} \\boldsymbol{1}$，其中 $\\boldsymbol{1}$ 是元素全为1的列向量。\n$$\n\\boldsymbol{1}^{\\top} \\mathbf{M} \\boldsymbol{1} = \\sum_{i} \\sum_{j} M_{ij}\n$$\n代入矩阵元素 $M_{ij}$ 的定义，我们有：\n$$\n\\sum_{i} \\sum_{j} M_{ij} = \\sum_{i} \\sum_{j} \\int_{\\Omega} N_{i}(x,y) N_{j}(x,y) \\, d\\Omega\n$$\n由于积分和求和是针对有限的函数和节点集合，我们可以交换积分和求和的顺序：\n$$\n\\int_{\\Omega} \\left( \\sum_{i} \\sum_{j} N_{i}(x,y) N_{j}(x,y) \\right) \\, d\\Omega = \\int_{\\Omega} \\left( \\sum_{i} N_{i}(x,y) \\right) \\left( \\sum_{j} N_{j}(x,y) \\right) \\, d\\Omega\n$$\n题目指出，形函数 $N_{k}$ 满足单位分解性质，即对所有 $(x,y) \\in \\Omega$ 都有 $\\sum_{k} N_{k}(x,y) \\equiv 1$。应用此性质，表达式简化为：\n$$\n\\int_{\\Omega} (1) (1) \\, d\\Omega = \\int_{\\Omega} 1 \\, d\\Omega = \\mathrm{Area}(\\Omega)\n$$\n域 $\\Omega$ 是单位正方形 $[0,1] \\times [0,1]$，因此其面积为 $1 \\times 1 = 1$。因此，我们证明了：\n$$\n\\boldsymbol{1}^{\\top} \\mathbf{M} \\boldsymbol{1} = 1\n$$\n这表明一致质量矩阵正确地计算了系统的总质量。\n\n接下来，考虑行和集中质量矩阵 $\\mathbf{M}^{L}$，它是一个对角矩阵，其元素为 $M^{L}_{ii} = \\sum_{j} M_{ij}$。在这种形式下，总质量是所有对角元素之和，因为所有非对角元素均为零。\n$$\n\\sum_{i} M^{L}_{ii} = \\sum_{i} \\left( \\sum_{j} M_{ij} \\right)\n$$\n这个双重求和正是一致质量矩阵 $\\mathbf{M}$ 所有元素的总和，我们已经计算过这个值。\n$$\n\\sum_{i} M^{L}_{ii} = \\sum_{i} \\sum_{j} M_{ij} = \\boldsymbol{1}^{\\top} \\mathbf{M} \\boldsymbol{1} = 1\n$$\n因此，行和集中质量矩阵也精确地守恒总质量。\n\n任务2：简化刚度和质量的计算\n\n网格的节点坐标为 $(i h, j h)$，其中 $i,j \\in \\{0, 1, 2\\}$，$h=1/2$。这给出了 $9$ 个节点。狄利克雷边界条件 $u=0$ 施加在所有 $8$ 个边界节点上。唯一剩下的活动自由度对应于内部节点 $(1/2, 1/2)$。我们将其记为节点 $p$。简化的刚度矩阵和质量矩阵是 $1 \\times 1$ 的标量, $K_{red} = K_{pp}$ 和 $M_{red} = M_{pp}$。\n\n位于 $(1/2, 1/2)$ 的中心节点 $p$ 是 $8$ 个三角形单元中的 $6$ 个的顶点。所有单元都是直角等腰三角形，面积为 $A = h^2/2 = (1/2)^2/2 = 1/8$。全局矩阵的元素是通过对这 $6$ 个单元的贡献求和来组装的。\n\n让我们确定中心节点 $(1/2, 1/2)$ 在相邻的 $6$ 个三角形中分别是哪种类型的顶点：\n-   两个三角形，其顶点分别为 $\\{(1/2,0), (1/2,1/2), (1,1/2)\\}$ 和 $\\{(0,1/2), (1/2,1/2), (1/2,1)\\}$，它们的直角位于中心节点 $(1/2, 1/2)$。这两个单元各自对 $K_{pp}$ 的贡献为 $1$。\n-   四个三角形，其顶点分别为 $\\{(0,0), (1/2,0), (1/2,1/2)\\}$、$\\{(0,0), (0,1/2), (1/2,1/2)\\}$、$\\{(1/2,1/2), (1,1/2), (1,1)\\}$ 和 $\\{(1/2,1/2), (1/2,1), (1,1)\\}$，它们的锐角位于中心节点 $(1/2, 1/2)$。这四个单元各自对 $K_{pp}$ 的贡献为 $1/2$。\n\n总的简化刚度 $K_{red} = K_{pp}$ 是这些贡献的总和：\n$$\nK_{red} = K_{pp} = 2 \\times 1 + 4 \\times \\frac{1}{2} = 2 + 2 = 4\n$$\n\n对于一致质量矩阵，题目给出来自一个线性三角形单元的对角贡献是 $\\int_{T} N_i^2 \\, d\\Omega = A/6$。由于节点 $p$ 与 $6$ 个单元相连，每个单元的面积为 $A=1/8$，因此简化的一致质量 $M_{red}$ 为：\n$$\nM_{red} = M_{pp} = \\sum_{e=1}^{6} \\frac{A_e}{6} = 6 \\times \\frac{A}{6} = A = \\frac{1}{8}\n$$\n\n对于行和集中质量矩阵，题目给出来自一个线性三角形单元的对角贡献是 $A/3$。简化的集中质量 $M^L_{red}$ 是与节点 $p$ 相连的 $6$ 个单元贡献的总和：\n$$\nM^L_{red} = M^L_{pp} = \\sum_{e=1}^{6} \\frac{A_e}{3} = 6 \\times \\frac{A}{3} = 2A = 2 \\times \\frac{1}{8} = \\frac{1}{4}\n$$\n\n任务3：基频频率之比\n\n关于基频角频率 $\\omega$ 的单自由度广义特征值问题是标量方程。\n\n对于一致质量矩阵公式：\n$$\nK_{red} u_p = \\omega_{\\mathrm{consistent}}^{2} M_{red} u_p\n$$\n$$\n4 u_p = \\omega_{\\mathrm{consistent}}^{2} \\left(\\frac{1}{8}\\right) u_p\n$$\n求解 $\\omega_{\\mathrm{consistent}}^{2}$：\n$$\n\\omega_{\\mathrm{consistent}}^{2} = \\frac{4}{1/8} = 32\n$$\n\n对于集中质量矩阵公式：\n$$\nK_{red} u_p = \\omega_{\\mathrm{lumped}}^{2} M^L_{red} u_p\n$$\n$$\n4 u_p = \\omega_{\\mathrm{lumped}}^{2} \\left(\\frac{1}{4}\\right) u_p\n$$\n求解 $\\omega_{\\mathrm{lumped}}^{2}$：\n$$\n\\omega_{\\mathrm{lumped}}^{2} = \\frac{4}{1/4} = 16\n$$\n\n比率 $R$ 定义为 $R = \\omega_{\\mathrm{lumped}} / \\omega_{\\mathrm{consistent}}$。\n$$\nR = \\frac{\\sqrt{\\omega_{\\mathrm{lumped}}^{2}}}{\\sqrt{\\omega_{\\mathrm{consistent}}^{2}}} = \\frac{\\sqrt{16}}{\\sqrt{32}} = \\frac{4}{4\\sqrt{2}} = \\frac{1}{\\sqrt{2}}\n$$\n分母有理化后得到：\n$$\nR = \\frac{\\sqrt{2}}{2}\n$$", "answer": "$$\\boxed{\\frac{\\sqrt{2}}{2}}$$", "id": "2562470"}, {"introduction": "在波传播和碰撞模拟等显式动力学分析中，时间步长的选择至关重要。显式时间积分方法的稳定性通常受到 Courant-Friedrichs-Lewy (CFL) 条件的限制，该条件与离散系统的最高固有频率直接相关。本练习通过离散色散分析，揭示了质量矩阵的构造形式如何直接影响这一稳定性极限，并引入了“质量缩放”这一在工程实践中用于控制时间步长的关键技术 [@problem_id:2546889]。", "problem": "一根未变形长度为 $L$、横截面积恒为 $A$ 的一维均质弹性杆被建模，用于分析其小范围纵向运动。该杆的杨氏模量为 $E$，质量密度为 $\\rho$，因此其纵向位移 $u(x,t)$ 的一维线性动量平衡方程为\n$$\n\\rho A\\,\\frac{\\partial^{2}u}{\\partial t^{2}} - E A\\,\\frac{\\partial^{2}u}{\\partial x^{2}}=0.\n$$\n该杆被均匀离散为长度为 $h$ 的线性两节点有限元，并在伽辽金法中使用了标准的分段线性形函数。时间积分采用显式中心差分法进行。考虑两种空间质量公式：一致质量矩阵和集中（对角）质量矩阵。\n\n从上述控制方程和均匀网格间距为 $h$ 的伽辽金半离散化出发，完成以下任务：\n\n1) 对于无限均匀网格（或足够大的周期性网格）中的一个内部节点，推导单元级的质量和刚度矩阵，组装内部节点方程，并通过代入拟设 $u_{i}(t)=\\hat{u}\\,\\exp\\!\\left(i(i\\theta-\\omega t)\\right)$ 进行离散平面波分析，其中 $i$ 是节点索引，$\\theta\\in[0,\\pi]$ 是无量纲波数，$\\omega$ 是圆频率。由此，求出以下两种情况的色散关系 $\\omega(\\theta)$：\n- 一致质量公式，\n- 集中质量公式。\n\n2) 利用应用于半离散系统的逐模态显式中心差分格式的单自由度稳定性要求，确定每种质量公式的最大稳定时间步长 $\\Delta t_{\\max}$，并将其表示为 $h$、$E$ 和 $\\rho$ 的函数。\n\n3) 你将使用一致质量公式进行仿真，但希望使用一个超过未缩放稳定极限的目标步长 $\\Delta t_{\\text{target}}$。因此，你通过一个标量因子 $s>1$ 应用均匀质量缩放（等效于将密度缩放为 $s\\rho$，同时保持刚度不变）。推导所需的最小 $s$ 值，以使中心差分格式在一致质量公式下对于 $\\Delta t_{\\text{target}}$ 是稳定的。\n\n使用以下数值数据：\n- $E=210\\times 10^{9}\\ \\mathrm{Pa}$,\n- $\\rho=7800\\ \\mathrm{kg/m^{3}}$,\n- $h=1.00\\times 10^{-3}\\ \\mathrm{m}$,\n- $\\Delta t_{\\text{target}}=3.00\\times 10^{-7}\\ \\mathrm{s}$.\n\n将你最终的 $s$ 数值答案四舍五入到四位有效数字。仅报告无量纲的 $s$ 值；最终答案中不要包含单位。", "solution": "所述问题具有科学依据，是适定的、客观的且自洽的。这是使用有限元法进行偏微分方程数值分析的一个标准练习，具体涉及色散分析和显式时间积分格式的稳定性。所有需要的数据和定义均已提供，不存在矛盾或歧义。问题有效。我将开始推导解答。\n\n纵向位移 $u(x,t)$ 的控制方程是一维波动方程：\n$$\n\\rho A \\frac{\\partial^2 u}{\\partial t^2} - E A \\frac{\\partial^2 u}{\\partial x^2} = 0\n$$\n其中 $\\rho$ 是质量密度，$E$ 是杨氏模量，$A$ 是横截面积。连续介质中的波速为 $c_0 = \\sqrt{E/\\rho}$。\n\n该方程的伽辽金半离散化导出一个关于时间的常微分方程组：\n$$\n\\mathbf{M} \\ddot{\\mathbf{u}} + \\mathbf{K} \\mathbf{u} = \\mathbf{0}\n$$\n其中 $\\mathbf{M}$ 是全局质量矩阵，$\\mathbf{K}$ 是全局刚度矩阵，$\\mathbf{u}$ 是节点位移向量。\n\n我们考虑一个由长度为 $h$ 的线性两节点单元组成的均匀网格。对于定义在局部域 $\\xi \\in [0, h]$ 上的一个通用单元，其线性形函数为 $N_1(\\xi) = 1 - \\xi/h$ 和 $N_2(\\xi) = \\xi/h$。\n\n单元刚度矩阵 $\\mathbf{K}^e$ 由下式给出：\n$$\nK^e_{ij} = \\int_0^h E A \\frac{dN_i}{d\\xi} \\frac{dN_j}{d\\xi} d\\xi\n$$\n由于 $\\frac{dN_1}{d\\xi} = -1/h$ 和 $\\frac{dN_2}{d\\xi} = 1/h$，计算得出：\n$$\n\\mathbf{K}^e = \\frac{E A}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n单元一致质量矩阵 $\\mathbf{M}_C^e$ 由下式给出：\n$$\nM^e_{C,ij} = \\int_0^h \\rho A N_i(\\xi) N_j(\\xi) d\\xi\n$$\n计算得出：\n$$\n\\mathbf{M}_C^e = \\frac{\\rho A h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}\n$$\n单元集中质量矩阵 $\\mathbf{M}_L^e$ 是通过将 $\\mathbf{M}_C^e$ 的各行求和并将结果置于对角线上得到的：\n$$\n\\mathbf{M}_L^e = \\frac{\\rho A h}{2} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\n\n**1) 色散关系**\n\n我们分析连接到单元 $(i-1)$ 和 $(i)$ 的内部节点 $i$ 的运动方程。通过组装这两个单元的贡献，我们得到节点方程。\n\n对于刚度部分，两种质量公式的组装是相同的：\n$$\n(K u)_i = \\frac{E A}{h} (-u_{i-1} + 2u_i - u_{i+1})\n$$\n对于质量部分，我们有两种情况。\n一致质量：\n$$\n(M_C \\ddot{u})_i = \\frac{\\rho A h}{6} (\\ddot{u}_{i-1} + 4\\ddot{u}_i + \\ddot{u}_{i+1})\n$$\n集中质量：\n$$\n(M_L \\ddot{u})_i = \\rho A h \\ddot{u}_i\n$$\n我们代入离散平面波拟设 $u_j(t) = \\hat{u} \\exp(i(j\\theta - \\omega t))$，这意味着 $\\ddot{u}_j(t) = -\\omega^2 u_j(t)$。关系式 $u_{j\\pm 1} = u_j \\exp(\\pm i\\theta)$ 成立。\n\n- **一致质量公式：**\n组装后的方程为：\n$$\n\\frac{\\rho A h}{6} (\\ddot{u}_{i-1} + 4\\ddot{u}_i + \\ddot{u}_{i+1}) + \\frac{E A}{h} (-u_{i-1} + 2u_i - u_{i+1}) = 0\n$$\n代入拟设并除以公因子：\n$$\n-\\omega^2 \\frac{\\rho h}{6} (\\exp(-i\\theta) + 4 + \\exp(i\\theta)) + \\frac{E}{h} (-\\exp(-i\\theta) + 2 - \\exp(i\\theta)) = 0\n$$\n$$\n-\\omega^2 \\frac{\\rho h}{6} (4 + 2\\cos\\theta) + \\frac{E}{h} (2 - 2\\cos\\theta) = 0\n$$\n求解 $\\omega^2$：\n$$\n\\omega_C^2 = \\frac{E}{\\rho} \\frac{6}{h^2} \\frac{2(1-\\cos\\theta)}{2(2+\\cos\\theta)} = c_0^2 \\frac{6}{h^2} \\frac{1-\\cos\\theta}{2+\\cos\\theta}\n$$\n使用半角恒等式 $1-\\cos\\theta = 2\\sin^2(\\theta/2)$：\n$$\n\\omega_C^2 = c_0^2 \\frac{12}{h^2} \\frac{\\sin^2(\\theta/2)}{3 - 2\\sin^2(\\theta/2)}\n$$\n色散关系为 $\\omega_C(\\theta) = \\frac{2\\sqrt{3}c_0}{h} \\frac{|\\sin(\\theta/2)|}{\\sqrt{3-2\\sin^2(\\theta/2)}}$。\n\n- **集中质量公式：**\n组装后的方程为：\n$$\n\\rho A h \\ddot{u}_i + \\frac{E A}{h} (-u_{i-1} + 2u_i - u_{i+1}) = 0\n$$\n代入拟设：\n$$\n-\\omega^2 \\rho h + \\frac{E}{h} (2 - 2\\cos\\theta) = 0\n$$\n求解 $\\omega^2$：\n$$\n\\omega_L^2 = \\frac{E}{\\rho h^2} (2 - 2\\cos\\theta) = c_0^2 \\frac{2}{h^2} (1-\\cos\\theta)\n$$\n使用半角恒等式：\n$$\n\\omega_L^2 = c_0^2 \\frac{4}{h^2} \\sin^2(\\theta/2)\n$$\n色散关系为 $\\omega_L(\\theta) = \\frac{2c_0}{h} |\\sin(\\theta/2)|$。\n\n**2) 最大稳定时间步长**\n\n显式中心差分法的稳定性条件是 $\\Delta t \\le 2/\\omega_{\\max}$，其中 $\\omega_{\\max}$ 是离散系统的最大固有频率。该最大值出现在最高的无量纲波数 $\\theta = \\pi$ 处。\n\n- **一致质量公式：**\n当 $\\theta = \\pi$ 时，$\\sin^2(\\theta/2) = \\sin^2(\\pi/2) = 1$。\n$$\n\\omega_{C, \\max}^2 = c_0^2 \\frac{12}{h^2} \\frac{1}{3-2} = \\frac{12 c_0^2}{h^2}\n$$\n$$\n\\omega_{C, \\max} = \\frac{2\\sqrt{3}c_0}{h} = \\frac{2\\sqrt{3}}{h}\\sqrt{\\frac{E}{\\rho}}\n$$\n最大稳定时间步长为：\n$$\n\\Delta t_{\\max, C} = \\frac{2}{\\omega_{C, \\max}} = \\frac{2h}{2\\sqrt{3}c_0} = \\frac{h}{\\sqrt{3}}\\sqrt{\\frac{\\rho}{E}}\n$$\n\n- **集中质量公式：**\n当 $\\theta=\\pi$ 时：\n$$\n\\omega_{L, \\max}^2 = c_0^2 \\frac{4}{h^2} \\sin^2(\\pi/2) = \\frac{4c_0^2}{h^2}\n$$\n$$\n\\omega_{L, \\max} = \\frac{2c_0}{h} = \\frac{2}{h}\\sqrt{\\frac{E}{\\rho}}\n$$\n最大稳定时间步长为：\n$$\n\\Delta t_{\\max, L} = \\frac{2}{\\omega_{L, \\max}} = \\frac{2h}{2c_0} = \\frac{h}{c_0} = h\\sqrt{\\frac{\\rho}{E}}\n$$\n\n**3) 质量缩放因子**\n\n我们对一致质量公式应用一个因子为 $s$ 的质量缩放，即用 $\\rho' = s\\rho$ 替换 $\\rho$。刚度 $E$ 保持不变。新的稳定性极限 $\\Delta t'_{\\max, C}$ 为：\n$$\n\\Delta t'_{\\max, C} = \\frac{h}{\\sqrt{3}}\\sqrt{\\frac{\\rho'}{E}} = \\frac{h}{\\sqrt{3}}\\sqrt{\\frac{s\\rho}{E}} = \\left(\\frac{h}{\\sqrt{3}}\\sqrt{\\frac{\\rho}{E}}\\right)\\sqrt{s} = \\Delta t_{\\max, C} \\sqrt{s}\n$$\n我们要求该格式对于目标时间步长 $\\Delta t_{\\text{target}}$ 是稳定的。通过将新的稳定性极限设为该目标步长，可以找到最小的缩放因子 $s$：\n$$\n\\Delta t_{\\text{target}} = \\Delta t'_{\\max, C} = \\frac{h\\sqrt{s}}{\\sqrt{3}}\\sqrt{\\frac{\\rho}{E}}\n$$\n求解 $s$：\n$$\n\\sqrt{s} = \\frac{\\Delta t_{\\text{target}}\\sqrt{3}}{h}\\sqrt{\\frac{E}{\\rho}}\n$$\n$$\ns = 3 \\left(\\frac{\\Delta t_{\\text{target}}}{h}\\right)^2 \\left(\\frac{E}{\\rho}\\right)\n$$\n我们现在代入所给的数值数据：\n$E=210 \\times 10^9\\ \\mathrm{Pa}$，$\\rho=7800\\ \\mathrm{kg/m^3}$，$h=1.00 \\times 10^{-3}\\ \\mathrm{m}$，以及 $\\Delta t_{\\text{target}}=3.00 \\times 10^{-7}\\ \\mathrm{s}$。\n$$\ns = 3 \\left(\\frac{3.00 \\times 10^{-7}}{1.00 \\times 10^{-3}}\\right)^2 \\left(\\frac{210 \\times 10^9}{7800}\\right)\n$$\n$$\ns = 3 \\left(3.00 \\times 10^{-4}\\right)^2 \\left(\\frac{2.1 \\times 10^{11}}{7.8 \\times 10^3}\\right)\n$$\n$$\ns = 3 \\times (9.00 \\times 10^{-8}) \\times (2.692307... \\times 10^7)\n$$\n$$\ns = 27.00 \\times 10^{-8} \\times 2.692307... \\times 10^7\n$$\n$$\ns = 2.700 \\times 10^{-7} \\times 2.692307... \\times 10^7 = 2.700 \\times 2.692307...\n$$\n$$\ns = 7.2692307...\n$$\n四舍五入到四位有效数字，最小缩放因子是 $s = 7.269$。", "answer": "$$\\boxed{7.269}$$", "id": "2546889"}]}