{"hands_on_practices": [{"introduction": "理论上的正交性概念在物理世界中需要一个具体的度量标准。在结构动力学中，这个标准是通过质量矩阵 $\\mathbf{M}$ 定义的内积。这个练习将通过一个简单的双自由度系统，让你动手计算并比较在标准的欧几里得内积和基于质量矩阵的 $\\mathbf{M}$ 内积下，模态保证准则（Modal Assurance Criterion, MAC）值的差异。通过这个对比，你将深刻理解为什么 $\\mathbf{M}$-正交性是分析动态系统的“自然”语言，以及它如何与系统的动能分布相关联。[@problem_id:2578481]", "problem": "考虑一个二自由度系统的无阻尼自由振动广义特征值问题，该问题源于有限元法 (Finite Element Method, FEM)，\n$$\n\\mathbf{K}\\,\\boldsymbol{\\phi}=\\lambda\\,\\mathbf{M}\\,\\boldsymbol{\\phi},\n$$\n其质量矩阵和刚度矩阵为对称正定矩阵\n$$\n\\mathbf{M}=\\begin{pmatrix}2 & 0 \\\\ 0 & 1\\end{pmatrix},\\qquad\n\\mathbf{K}=\\begin{pmatrix}3 & -1 \\\\ -1 & 1\\end{pmatrix}.\n$$\n从以下基本定义出发：(i) 自由振动满足上述广义特征值问题，(ii) 不同特征值的模态关于 $\\mathbf{M}$ 加权内积是正交的，以及 (iii) 对于 $\\mathbb{R}^n$ 上的任意内积 $\\langle\\cdot,\\cdot\\rangle$，向量 $\\mathbf{a}$ 和 $\\mathbf{b}$ 之间夹角的余弦平方由下式给出\n$$\n\\frac{|\\langle \\mathbf{a},\\mathbf{b}\\rangle|^2}{\\langle \\mathbf{a},\\mathbf{a}\\rangle\\,\\langle \\mathbf{b},\\mathbf{b}\\rangle},\n$$\n一旦选定内积，该式即定义了模态置信准则 (Modal Assurance Criterion, MAC)。\n\n1) 求解该广义特征值问题，以获得解析特征对 $(\\lambda_1,\\boldsymbol{\\phi}_1)$ 和 $(\\lambda_2,\\boldsymbol{\\phi}_2)$，并通过计算 $\\boldsymbol{\\phi}_1^{\\mathsf{T}}\\mathbf{M}\\,\\boldsymbol{\\phi}_2$ 来验证两种模态的 $\\mathbf{M}$-正交性，以及通过 $\\boldsymbol{\\phi}_1^{\\mathsf{T}}\\boldsymbol{\\phi}_2$ 验证其欧几里得非正交性。\n\n2) 假设一个粗略的离散化产生了一个近似的一阶模态振型\n$$\n\\tilde{\\boldsymbol{\\phi}}_1=\\begin{pmatrix}1 \\\\ \\tfrac{9}{5}\\end{pmatrix}.\n$$\n计算精确模态 $\\boldsymbol{\\phi}_1$ 和近似模态 $\\tilde{\\boldsymbol{\\phi}}_1$ 之间关于以下内积的模态置信准则 (MAC)：\n- 欧几里得内积 $\\langle \\mathbf{a},\\mathbf{b}\\rangle_{\\mathrm{E}}=\\mathbf{a}^{\\mathsf{T}}\\mathbf{b}$，\n- $\\mathbf{M}$加权内积 $\\langle \\mathbf{a},\\mathbf{b}\\rangle_{\\mathbf{M}}=\\mathbf{a}^{\\mathsf{T}}\\mathbf{M}\\mathbf{b}$。\n\n3) 结合模态正交性和归一化原则，简要解释在本例中两个 MAC 值为何不同。\n\n最终交付物为一个等于下式的精确数值\n$$\n\\Delta=\\mathrm{MAC}_{\\mathbf{M}}(\\boldsymbol{\\phi}_1,\\tilde{\\boldsymbol{\\phi}}_1)-\\mathrm{MAC}_{\\mathrm{E}}(\\boldsymbol{\\phi}_1,\\tilde{\\boldsymbol{\\phi}}_1),\n$$\n以最简分数形式表示。不包含单位。不要四舍五入，给出精确值。", "solution": "首先对问题陈述进行验证。\n\n按原文提取已知条件：\n1.  控制方程为广义特征值问题 $\\mathbf{K}\\,\\boldsymbol{\\phi}=\\lambda\\,\\mathbf{M}\\,\\boldsymbol{\\phi}$。\n2.  质量矩阵为 $\\mathbf{M}=\\begin{pmatrix}2 & 0 \\\\ 0 & 1\\end{pmatrix}$。\n3.  刚度矩阵为 $\\mathbf{K}=\\begin{pmatrix}3 & -1 \\\\ -1 & 1\\end{pmatrix}$。\n4.  已知 $\\mathbf{M}$ 和 $\\mathbf{K}$ 是对称正定矩阵。\n5.  不同特征值的模态关于 $\\mathbf{M}$ 加权内积是正交的。\n6.  对于内积 $\\langle\\cdot,\\cdot\\rangle$，向量 $\\mathbf{a}$ 和 $\\mathbf{b}$ 之间夹角的余弦平方由 $\\frac{|\\langle \\mathbf{a},\\mathbf{b}\\rangle|^2}{\\langle \\mathbf{a},\\mathbf{a}\\rangle\\,\\langle \\mathbf{b},\\mathbf{b}\\rangle}$ 给出，该式定义了模态置信准则 (MAC)。\n7.  给定一个近似的一阶模态振型 $\\tilde{\\boldsymbol{\\phi}}_1=\\begin{pmatrix}1 \\\\ \\tfrac{9}{5}\\end{pmatrix}$。\n8.  定义了两种内积：欧几里得内积 $\\langle \\mathbf{a},\\mathbf{b}\\rangle_{\\mathrm{E}}=\\mathbf{a}^{\\mathsf{T}}\\mathbf{b}$ 和 $\\mathbf{M}$ 加权内积 $\\langle \\mathbf{a},\\mathbf{b}\\rangle_{\\mathbf{M}}=\\mathbf{a}^{\\mathsf{T}}\\mathbf{M}\\mathbf{b}$。\n9.  最终交付物为 $\\Delta=\\mathrm{MAC}_{\\mathbf{M}}(\\boldsymbol{\\phi}_1,\\tilde{\\boldsymbol{\\phi}}_1)-\\mathrm{MAC}_{\\mathrm{E}}(\\boldsymbol{\\phi}_1,\\tilde{\\boldsymbol{\\phi}}_1)$。\n\n问题验证如下：\n- **科学依据：** 该问题涉及线性时不变机械系统的标准模态分析，这是工程和物理学的核心课题。所给矩阵在物理上是合理的。我们验证其正定性。对于 $\\mathbf{M}$，特征值为 $2$ 和 $1$，均为正数。对于 $\\mathbf{K}$，其顺序主子式为 $\\det(3)=3>0$ 和 $\\det(\\mathbf{K})=3(1)-(-1)(-1)=2>0$。因此两个矩阵确实都是对称正定的。\n- **适定性：** 这是一个标准的广义特征值问题，其矩阵为对称正定矩阵，这保证了特征值为实数且为正，并存在一组 $\\mathbf{M}$-正交的特征向量。任务具体，并会导出一个唯一的数值答案。\n- **客观性：** 问题以精确的数学语言陈述，没有主观性。\n\n结论是该问题有效。我们开始求解。\n\n解答过程遵循问题描述的三个部分。\n\n第 1 部分：求解广义特征值问题并验证正交性。\n特征值问题为 $(\\mathbf{K} - \\lambda\\mathbf{M})\\boldsymbol{\\phi} = \\mathbf{0}$。为获得非平凡解，特征矩阵的行列式必须为零：\n$$\n\\det(\\mathbf{K} - \\lambda\\mathbf{M}) = \\det\\left(\\begin{pmatrix}3 & -1 \\\\ -1 & 1\\end{pmatrix} - \\lambda \\begin{pmatrix}2 & 0 \\\\ 0 & 1\\end{pmatrix}\\right) = \\det\\begin{pmatrix}3 - 2\\lambda & -1 \\\\ -1 & 1 - \\lambda\\end{pmatrix} = 0\n$$\n由此得到特征方程：\n$$\n(3 - 2\\lambda)(1 - \\lambda) - (-1)^2 = 0\n$$\n$$\n3 - 3\\lambda - 2\\lambda + 2\\lambda^2 - 1 = 0\n$$\n$$\n2\\lambda^2 - 5\\lambda + 2 = 0\n$$\n求解此关于 $\\lambda$ 的二次方程：\n$$\n\\lambda = \\frac{-(-5) \\pm \\sqrt{(-5)^2 - 4(2)(2)}}{2(2)} = \\frac{5 \\pm \\sqrt{25-16}}{4} = \\frac{5 \\pm 3}{4}\n$$\n特征值为 $\\lambda_1 = \\frac{5-3}{4} = \\frac{1}{2}$ 和 $\\lambda_2 = \\frac{5+3}{4} = 2$。\n\n对每个特征值，我们求其对应的特征向量（模态振型）。\n对于 $\\lambda_1 = \\frac{1}{2}$：\n$$\n(\\mathbf{K} - \\lambda_1\\mathbf{M})\\boldsymbol{\\phi}_1 = \\begin{pmatrix}3 - 2(\\frac{1}{2}) & -1 \\\\ -1 & 1 - \\frac{1}{2}\\end{pmatrix} \\boldsymbol{\\phi}_1 = \\begin{pmatrix}2 & -1 \\\\ -1 & \\frac{1}{2}\\end{pmatrix} \\begin{pmatrix}\\phi_{11} \\\\ \\phi_{12}\\end{pmatrix} = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}\n$$\n这得到方程 $2\\phi_{11} - \\phi_{12} = 0$，即 $\\phi_{12} = 2\\phi_{11}$。选择 $\\phi_{11} = 1$ 可得 $\\boldsymbol{\\phi}_1 = \\begin{pmatrix}1 \\\\ 2\\end{pmatrix}$。\n\n对于 $\\lambda_2 = 2$：\n$$\n(\\mathbf{K} - \\lambda_2\\mathbf{M})\\boldsymbol{\\phi}_2 = \\begin{pmatrix}3 - 2(2) & -1 \\\\ -1 & 1 - 2\\end{pmatrix} \\boldsymbol{\\phi}_2 = \\begin{pmatrix}-1 & -1 \\\\ -1 & -1\\end{pmatrix} \\begin{pmatrix}\\phi_{21} \\\\ \\phi_{22}\\end{pmatrix} = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}\n$$\n这得到方程 $-\\phi_{21} - \\phi_{22} = 0$，即 $\\phi_{22} = -\\phi_{21}$。选择 $\\phi_{21} = 1$ 可得 $\\boldsymbol{\\phi}_2 = \\begin{pmatrix}1 \\\\ -1\\end{pmatrix}$。\n\n特征对为 $(\\lambda_1, \\boldsymbol{\\phi}_1) = (\\frac{1}{2}, \\begin{pmatrix}1 \\\\ 2\\end{pmatrix})$ 和 $(\\lambda_2, \\boldsymbol{\\phi}_2) = (2, \\begin{pmatrix}1 \\\\ -1\\end{pmatrix})$。\n\n我们验证正交性：\n$\\mathbf{M}$-正交性：\n$$\n\\boldsymbol{\\phi}_1^{\\mathsf{T}}\\mathbf{M}\\boldsymbol{\\phi}_2 = \\begin{pmatrix}1 & 2\\end{pmatrix} \\begin{pmatrix}2 & 0 \\\\ 0 & 1\\end{pmatrix} \\begin{pmatrix}1 \\\\ -1\\end{pmatrix} = \\begin{pmatrix}1 & 2\\end{pmatrix} \\begin{pmatrix}2 \\\\ -1\\end{pmatrix} = 1(2) + 2(-1) = 0\n$$\n根据理论，模态是 $\\mathbf{M}$-正交的。\n欧几里得非正交性：\n$$\n\\boldsymbol{\\phi}_1^{\\mathsf{T}}\\boldsymbol{\\phi}_2 = \\begin{pmatrix}1 & 2\\end{pmatrix} \\begin{pmatrix}1 \\\\ -1\\end{pmatrix} = 1(1) + 2(-1) = -1\n$$\n模态在欧几里得意义下不正交。\n\n第 2 部分：计算 MAC 值。\n我们将精确的一阶模态 $\\boldsymbol{\\phi}_1 = \\begin{pmatrix}1 \\\\ 2\\end{pmatrix}$ 与近似模态 $\\tilde{\\boldsymbol{\\phi}}_1 = \\begin{pmatrix}1 \\\\ \\frac{9}{5}\\end{pmatrix}$ 进行比较。\n\n关于欧几里得内积的 MAC 值为：\n$$\n\\mathrm{MAC}_{\\mathrm{E}}(\\boldsymbol{\\phi}_1, \\tilde{\\boldsymbol{\\phi}}_1) = \\frac{|\\boldsymbol{\\phi}_1^{\\mathsf{T}}\\tilde{\\boldsymbol{\\phi}}_1|^2}{(\\boldsymbol{\\phi}_1^{\\mathsf{T}}\\boldsymbol{\\phi}_1)(\\tilde{\\boldsymbol{\\phi}}_1^{\\mathsf{T}}\\tilde{\\boldsymbol{\\phi}}_1)}\n$$\n各项计算如下：\n$\\boldsymbol{\\phi}_1^{\\mathsf{T}}\\tilde{\\boldsymbol{\\phi}}_1 = 1(1) + 2(\\frac{9}{5}) = 1 + \\frac{18}{5} = \\frac{23}{5}$。\n$\\boldsymbol{\\phi}_1^{\\mathsf{T}}\\boldsymbol{\\phi}_1 = 1^2 + 2^2 = 5$。\n$\\tilde{\\boldsymbol{\\phi}}_1^{\\mathsf{T}}\\tilde{\\boldsymbol{\\phi}}_1 = 1^2 + (\\frac{9}{5})^2 = 1 + \\frac{81}{25} = \\frac{25+81}{25} = \\frac{106}{25}$。\n$$\n\\mathrm{MAC}_{\\mathrm{E}} = \\frac{(\\frac{23}{5})^2}{5 \\cdot \\frac{106}{25}} = \\frac{\\frac{529}{25}}{\\frac{530}{25}} = \\frac{529}{530}\n$$\n\n关于 $\\mathbf{M}$ 加权内积的 MAC 值为：\n$$\n\\mathrm{MAC}_{\\mathbf{M}}(\\boldsymbol{\\phi}_1, \\tilde{\\boldsymbol{\\phi}}_1) = \\frac{|\\boldsymbol{\\phi}_1^{\\mathsf{T}}\\mathbf{M}\\tilde{\\boldsymbol{\\phi}}_1|^2}{(\\boldsymbol{\\phi}_1^{\\mathsf{T}}\\mathbf{M}\\boldsymbol{\\phi}_1)(\\tilde{\\boldsymbol{\\phi}}_1^{\\mathsf{T}}\\mathbf{M}\\tilde{\\boldsymbol{\\phi}}_1)}\n$$\n各项计算如下：\n$\\boldsymbol{\\phi}_1^{\\mathsf{T}}\\mathbf{M}\\tilde{\\boldsymbol{\\phi}}_1 = \\begin{pmatrix}1 & 2\\end{pmatrix}\\begin{pmatrix}2 & 0 \\\\ 0 & 1\\end{pmatrix}\\begin{pmatrix}1 \\\\ \\frac{9}{5}\\end{pmatrix} = \\begin{pmatrix}2 & 2\\end{pmatrix}\\begin{pmatrix}1 \\\\ \\frac{9}{5}\\end{pmatrix} = 2(1) + 2(\\frac{9}{5}) = 2 + \\frac{18}{5} = \\frac{28}{5}$。\n$\\boldsymbol{\\phi}_1^{\\mathsf{T}}\\mathbf{M}\\boldsymbol{\\phi}_1 = \\begin{pmatrix}1 & 2\\end{pmatrix}\\begin{pmatrix}2 & 0 \\\\ 0 & 1\\end{pmatrix}\\begin{pmatrix}1 \\\\ 2\\end{pmatrix} = 1(2)(1) + 2(1)(2) = 2+4 = 6$。\n$\\tilde{\\boldsymbol{\\phi}}_1^{\\mathsf{T}}\\mathbf{M}\\tilde{\\boldsymbol{\\phi}}_1 = \\begin{pmatrix}1 & \\frac{9}{5}\\end{pmatrix}\\begin{pmatrix}2 & 0 \\\\ 0 & 1\\end{pmatrix}\\begin{pmatrix}1 \\\\ \\frac{9}{5}\\end{pmatrix} = 1(2)(1) + \\frac{9}{5}(1)(\\frac{9}{5}) = 2 + \\frac{81}{25} = \\frac{50+81}{25} = \\frac{131}{25}$。\n$$\n\\mathrm{MAC}_{\\mathbf{M}} = \\frac{(\\frac{28}{5})^2}{6 \\cdot \\frac{131}{25}} = \\frac{\\frac{784}{25}}{\\frac{786}{25}} = \\frac{784}{786} = \\frac{392}{393}\n$$\n\n第 3 部分：解释。\n模态置信准则 (MAC) 是衡量共线性的指标，可解释为两个向量之间夹角的余弦平方。这个“夹角”由所选择的内积定义。\n欧几里得内积 $\\langle\\cdot,\\cdot\\rangle_{\\mathrm{E}}$ 定义了标准的几何夹角。\n$\\mathbf{M}$ 加权内积 $\\langle\\cdot,\\cdot\\rangle_{\\mathbf{M}}$ 在一个坐标根据物理系统质量分布进行缩放的空间中定义了一个角度。这是结构动力学中的自然内积，因为它与动能相关，并且系统的模态正是关于这个内积正交的。\n两个 MAC 值之所以不同，是因为用来衡量共线性的底层几何结构不同。除非质量矩阵 $\\mathbf{M}$ 是单位矩阵的标量倍数，否则欧几里得内积和 $\\mathbf{M}$ 加权内积将定义不同的几何结构，从而对同一对向量产生不同的 MAC 值。\n\n最终交付物计算：\n我们需要计算 $\\Delta = \\mathrm{MAC}_{\\mathbf{M}} - \\mathrm{MAC}_{\\mathrm{E}}$。\n$$\n\\Delta = \\frac{392}{393} - \\frac{529}{530}\n$$\n为了进行减法，我们找到一个公分母，即 $393 \\times 530$。\n$$\n\\Delta = \\frac{392 \\times 530 - 529 \\times 393}{393 \\times 530}\n$$\n分子是：\n$392 \\times 530 = 207760$。\n$529 \\times 393 = 207897$。\n分子 $= 207760 - 207897 = -137$。\n分母是：\n$393 \\times 530 = 208290$。\n因此，差值为：\n$$\n\\Delta = -\\frac{137}{208290}\n$$\n数字 $137$ 是质数，且 $208290$ 不能被 $137$ 整除。因此，这个分数是最简形式。", "answer": "$$\n\\boxed{-\\frac{137}{208290}}\n$$", "id": "2578481"}, {"introduction": "从理论计算过渡到实际的数值分析，我们必须处理由计算精度和舍入误差带来的不确定性。一个计算出的特征向量集是否真正满足 $\\mathbf{M}$-正交性？这个实践将指导你设计并实现一个通用的数值程序，用于在给定容差范围内验证一组向量的 $\\mathbf{M}$-正交性。这不仅是一项编程练习，更是培养验证有限元求解器结果严谨性的关键一步。[@problem_id:2578532]", "problem": "考虑有限元法背景下的广义对称定征值问题：给定矩阵 $K \\in \\mathbb{R}^{n \\times n}$ 和 $M \\in \\mathbb{R}^{n \\times n}$，其中 $K = K^T$ 且 $M = M^T \\succ 0$，一个特征对 $(\\lambda, \\phi)$ 满足 $K \\phi = \\lambda M \\phi$。在精确算术中，与不同特征值相关联的特征向量关于 $M$-内积是正交的。对于一组计算得到的、组装成矩阵 $\\hat{\\Phi} \\in \\mathbb{R}^{n \\times m}$ 的列向量 $\\{\\hat{\\phi}_i\\}_{i=1}^m$，$M$-正交性的数值验证需要仔细处理缩放和舍入误差。\n\n任务：设计并实现一个过程，该过程在给定 $K$、$M$、一个其列为计算出的特征向量的矩阵 $\\hat{\\Phi}$ 以及一个公差 $\\epsilon > 0$ 的情况下，返回一个布尔值，指示向量集 $\\{\\hat{\\phi}_i\\}$ 是否在公差 $\\epsilon$ 内是 $M$-正交的。该验证必须仅基于基本定义：$M$-内积 $\\langle x, y \\rangle_M := x^T M y$ 和正交性定义 $\\langle \\hat{\\phi}_i, \\hat{\\phi}_j \\rangle_M = 0$（对于 $i \\neq j$）。您的过程必须对 $\\hat{\\Phi}$ 列的非零重缩放保持不变，并且必须能稳健地检测无效输入，例如零列（对于非零的 $\\hat{\\phi}_i$，这违反了正定性所蕴含的 $\\hat{\\phi}_i^T M \\hat{\\phi}_i > 0$）。\n\n验证过程的规范：\n- 输入：$K \\in \\mathbb{R}^{n \\times n}$ 且 $K = K^T$，$M \\in \\mathbb{R}^{n \\times n}$ 且 $M = M^T \\succ 0$，$\\hat{\\Phi} \\in \\mathbb{R}^{n \\times m}$，以及 $\\epsilon \\in \\mathbb{R}$ 且 $\\epsilon > 0$。\n- 计算格拉姆矩阵 (Gram matrix) $G := \\hat{\\Phi}^T M \\hat{\\Phi} \\in \\mathbb{R}^{m \\times m}$，其元素为 $g_{ij} = \\hat{\\phi}_i^T M \\hat{\\phi}_j$。\n- 令 $d_i := g_{ii}$，其中 $i \\in \\{1,\\dots,m\\}$。如果任何 $d_i \\le 0$，则声明该集合非 $M$-正交（返回 false）。\n- 为 $i \\ne j$ 定义归一化相关系数 $c_{ij} := \\dfrac{g_{ij}}{\\sqrt{d_i d_j}}$。此归一化消除了对列缩放的敏感性。\n- 令 $\\eta := \\max_{i \\ne j} |c_{ij}|$。对于 $m=1$ 的情况，定义 $\\eta := 0$。\n- 当且仅当 $\\eta \\le \\epsilon$ 时返回 true；否则返回 false。\n\n你的程序必须将此验证实现为一个纯函数，并将其应用于以下确定性测试套件。在每个测试用例中，使用提供的 $M$、$\\hat{\\Phi}$ 和 $\\epsilon$。你可以将 $K$ 设置为任何兼容尺寸的对称矩阵；它不会被验证过程使用，但包含它是为了保持问题的背景。\n\n测试套件：\n- 测试 1（尺度不变性，精确 $M$-正交性）：\n  - $M_1 = \\operatorname{diag}(4,3,2,5)$。\n  - $\\hat{\\Phi}_1 = [7 e_1, -2 e_2, 0.5 e_3]$，其中 $e_i$ 表示 $\\mathbb{R}^4$ 中的第 $i$ 个标准基向量。\n  - $\\epsilon_1 = 10^{-12}$。\n  - 预期布尔值：true。\n- 测试 2（微小偏离，严格公差）：\n  - $M_1$ 如上。\n  - $\\hat{\\Phi}_2 = [e_1 + 10^{-3} e_2, e_2, e_3]$ 在 $\\mathbb{R}^4$ 中。\n  - $\\epsilon_2 = 10^{-6}$。\n  - 预期布尔值：false。\n- 测试 3（相同偏离，较宽松公差）：\n  - $M_1$ 如上。\n  - $\\hat{\\Phi}_3 = [e_1 + 10^{-3} e_2, e_2, e_3]$ 在 $\\mathbb{R}^4$ 中。\n  - $\\epsilon_3 = 10^{-2}$。\n  - 预期布尔值：true。\n- 测试 4（单个向量，空洞正交性）：\n  - $M_2 = \\begin{bmatrix}2 & 0 & 0 \\\\ 0 & 5 & 1 \\\\ 0 & 1 & 3\\end{bmatrix}$。\n  - $\\hat{\\Phi}_4 = [[1,2,3]^T]$（$\\mathbb{R}^3$ 中的单个列）。\n  - $\\epsilon_4 = 10^{-12}$。\n  - 预期布尔值：true。\n- 测试 5（在 $M$ 下非正交对，退化子空间示例）：\n  - $M_3 = \\operatorname{diag}(2,2)$。\n  - $\\hat{\\Phi}_5 = [[1,0]^T, [1,1]^T]$ 在 $\\mathbb{R}^2$ 中。\n  - $\\epsilon_5 = 0.5$。\n  - 预期布尔值：false。\n- 测试 6（包含零列的无效输入）：\n  - $M_4 = \\operatorname{diag}(1,1)$。\n  - $\\hat{\\Phi}_6 = [[1,0]^T, [0,0]^T]$ 在 $\\mathbb{R}^2$ 中。\n  - $\\epsilon_6 = 10^{-12}$。\n  - 预期布尔值：false。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含按测试 1 到 6 的顺序排列的结果，格式为方括号括起来的逗号分隔列表，例如 $[r_1,r_2,r_3,r_4,r_5,r_6]$，其中每个 $r_i$ 是编程语言规范的布尔文字格式。", "solution": "该问题要求设计并实现一个程序，用以验证一组向量的数值 $M$-正交性。这项任务在有限元法中至关重要，特别是在模态分析中，其中广义特征值问题 $K \\phi = \\lambda M \\phi$ 的特征向量必须关于质量矩阵 $M$ 正交。我们将首先验证问题陈述的有效性，然后基于严谨的数学原理构建解决方案。\n\n该问题是有效的。它在科学上基于数值线性代数的既定原理，是适定的，具有清晰和确定性的规则，并以客观、明确的语言表述。它提出了一个标准的、非平凡的验证任务，需要仔细实现。所有测试用例所需的数据均已提供。因此，我们可以着手解决。\n\n问题的核心在于由对称正定矩阵 $M \\in \\mathbb{R}^{n \\times n}$ 导出的内积的定义。对于任意两个向量 $x, y \\in \\mathbb{R}^n$，其 $M$-内积定义为：\n$$\n\\langle x, y \\rangle_M := x^T M y\n$$\n$M$ 的正定性（$M \\succ 0$）确保了该定义满足内积的所有公理。具体而言，对于所有非零向量 $x$，都有 $\\langle x, x \\rangle_M = x^T M x > 0$。一个向量的 $M$-范数则为 $\\|x\\|_M = \\sqrt{\\langle x, x \\rangle_M}$。\n\n如果对于所有 $i \\neq j$ 都有 $\\langle \\hat{\\phi}_i, \\hat{\\phi}_j \\rangle_M = 0$，则称向量集 $\\{\\hat{\\phi}_i\\}_{i=1}^m$ 是 $M$-正交的。在数值计算中，结果会受舍入误差的影响，因此我们必须在指定的公差 $\\epsilon$ 内验证此条件。\n\n所指定的验证过程正确地将此任务形式化。让我们分析每个步骤。\n\n1.  **计算格拉姆矩阵 $G$**：\n    该过程首先计算格拉姆矩阵 $G \\in \\mathbb{R}^{m \\times m}$，其元素是 $\\hat{\\Phi} = [\\hat{\\phi}_1, \\dots, \\hat{\\phi}_m]$ 各列的成对 $M$-内积。元素 $g_{ij}$ 由下式给出：\n    $$\n    g_{ij} = \\hat{\\phi}_i^T M \\hat{\\phi}_j = \\langle \\hat{\\phi}_i, \\hat{\\phi}_j \\rangle_M\n    $$\n    这可以用矩阵符号紧凑地表示为 $G = \\hat{\\Phi}^T M \\hat{\\Phi}$。对角元素为 $g_{ii} = \\hat{\\phi}_i^T M \\hat{\\phi}_i = \\|\\hat{\\phi}_i\\|_M^2$，即向量的 $M$-范数的平方。对于一个 $M$-正交集，非对角元素 $g_{ij}$ ($i \\neq j$) 应该是零。\n\n2.  **验证向量范数**：\n    下一步是检查对角元素 $d_i := g_{ii}$。条件是如果任何 $d_i \\le 0$，则返回 `false`。这是一个关键的有效性检查。由于 $M$ 是正定的，$\\hat{\\phi}_i^T M \\hat{\\phi}_i$ 仅当 $\\hat{\\phi}_i$ 是零向量时才可能为零，并且不能为负。在一个旨在表示特征向量的集合中出现零向量是一种异常情况；这样的向量不能成为正交基的一部分。因此，任何满足 $\\|\\hat{\\phi}_i\\|_M^2 \\le 0$ 的 $\\hat{\\phi}_i$ 都会立即使该集合对于正交性验证无效。此检查还可防止在后续的归一化步骤中出现除以零的情况。\n\n3.  **归一化以实现尺度不变性**：\n    特征向量的定义仅在非零缩放因子下是唯一的。一个稳健的验证过程必须对此类缩放保持不变。如果我们将 $\\hat{\\phi}_i$ 替换为 $\\alpha_i \\hat{\\phi}_i$，并将 $\\hat{\\phi}_j$ 替换为 $\\alpha_j \\hat{\\phi}_j$（其中 $\\alpha_i, \\alpha_j \\neq 0$），内积变为 $g_{ij}' = \\alpha_i \\alpha_j g_{ij}$。因此，$g_{ij}$ 的原始值不是衡量正交性的可靠指标。\n    该过程要求计算归一化相关系数：\n    $$\n    c_{ij} := \\frac{g_{ij}}{\\sqrt{d_i d_j}} = \\frac{\\langle \\hat{\\phi}_i, \\hat{\\phi}_j \\rangle_M}{\\sqrt{\\|\\hat{\\phi}_i\\|_M^2 \\|\\hat{\\phi}_j\\|_M^2}} = \\frac{\\langle \\hat{\\phi}_i, \\hat{\\phi}_j \\rangle_M}{\\|\\hat{\\phi}_i\\|_M \\|\\hat{\\phi}_j\\|_M}\n    $$\n    这个量 $c_{ij}$ 是在赋予了 $M$-内积的希尔伯特空间 (Hilbert space) 中向量 $\\hat{\\phi}_i$ 和 $\\hat{\\phi}_j$ 之间夹角的余弦。根据该内积的柯西-施瓦茨不等式 (Cauchy-Schwarz inequality)，我们有 $|\\langle \\hat{\\phi}_i, \\hat{\\phi}_j \\rangle_M| \\le \\|\\hat{\\phi}_i\\|_M \\|\\hat{\\phi}_j\\|_M$，这意味着 $|c_{ij}| \\le 1$。$c_{ij}$ 的值与 $\\hat{\\phi}_i$ 和 $\\hat{\\phi}_j$ 的缩放无关，从而满足了尺度不变性的要求。对于理想的正交性，$c_{ij}=0$。\n\n4.  **量化与正交性的总体偏差**：\n    为了评估整个集合，我们必须找出所有不同向量对中与正交性的最大偏差。这由度量 $\\eta$ 捕获：\n    $$\n    \\eta := \\max_{i \\neq j} |c_{ij}|\n    $$\n    该度量代表了集合中最坏情况的“正交性误差”。对于单个向量的特殊情况（$m \\le 1$），不存在不同的向量对，因此正交性条件是空洞满足的。该过程在这种情况下正确地定义了 $\\eta := 0$。\n\n5.  **最终判定**：\n    最后一步是将最坏情况偏差 $\\eta$ 与指定的公差 $\\epsilon > 0$ 进行比较。如果 $\\eta \\le \\epsilon$，则认为集合 $\\{\\hat{\\phi}_i\\}$ 是数值上 $M$-正交的。这为验证提供了一个清晰、量化且稳健的标准。\n\n该过程是针对所述任务的一个完整且数学上合理的算法。我们现在将其用代码实现，并应用于所提供的测试套件。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef is_m_orthogonal(M: np.ndarray, Phi: np.ndarray, epsilon: float) -> bool:\n    \"\"\"\n    Verifies if the columns of Phi are M-orthogonal within a given tolerance.\n\n    Args:\n        M (np.ndarray): A symmetric positive definite matrix (n x n).\n        Phi (np.ndarray): A matrix whose columns are the vectors to be checked (n x m).\n        epsilon (float): A positive tolerance for orthogonality.\n\n    Returns:\n        bool: True if the columns of Phi are M-orthogonal within tolerance, False otherwise.\n    \"\"\"\n    if not isinstance(M, np.ndarray) or not isinstance(Phi, np.ndarray):\n        raise TypeError(\"Inputs M and Phi must be numpy arrays.\")\n    \n    if M.ndim != 2 or Phi.ndim != 2:\n        raise ValueError(\"Inputs M and Phi must be 2D arrays.\")\n\n    n_m, n_m_check = M.shape\n    n_phi, m = Phi.shape\n\n    if n_m != n_m_check or n_m != n_phi:\n        raise ValueError(\"Matrix dimensions are not compatible for multiplication.\")\n\n    if epsilon <= 0:\n        raise ValueError(\"Tolerance epsilon must be positive.\")\n\n    # Per the specification, for m=1, eta is 0 if the vector is valid.\n    # We must still check for a zero vector.\n    if m <= 1:\n        if m == 0:\n            return True # An empty set of vectors is vacuously orthogonal.\n        \n        # Case m = 1\n        phi_1 = Phi[:, 0]\n        d1 = phi_1.T @ M @ phi_1\n        \n        # If d1 <= 0, the vector is a zero vector (since M is positive definite),\n        # which is invalid.\n        if d1 <= 0:\n            return False\n        \n        # For a single valid vector, orthogonality is vacuously true (eta=0).\n        # Since epsilon > 0, eta <= epsilon is always true.\n        return True\n\n    # Compute the Gram matrix: G = Phi^T * M * Phi\n    G = Phi.T @ M @ Phi\n\n    # Extract the diagonal entries d_i = g_ii\n    d = np.diagonal(G)\n\n    # Check for invalid vectors: d_i must be > 0.\n    # If any d_i <= 0, it implies a zero vector or M is not SPD.\n    if np.any(d <= 0):\n        return False\n\n    # Compute the normalized correlation coefficients c_ij = g_ij / sqrt(d_i * d_j)\n    # We do not need to compute the full matrix C. We only need the max of off-diagonals.\n    \n    # An efficient way to compute sqrt(d_i * d_j) matrix is via an outer product.\n    d_sqrt = np.sqrt(d)\n    denom_matrix = np.outer(d_sqrt, d_sqrt)\n    \n    # Avoid division by zero, though the check d <= 0 should already prevent this.\n    # Add a small machine epsilon for safety in floating point arithmetic.\n    denom_matrix[denom_matrix == 0] = np.finfo(float).eps\n    \n    C = np.abs(G / denom_matrix)\n    \n    # Set diagonal elements to 0 to only consider off-diagonal pairs (i != j)\n    np.fill_diagonal(C, 0)\n    \n    # Find the maximum absolute off-diagonal value\n    eta = np.max(C)\n    \n    return eta <= epsilon\n\ndef solve():\n    \"\"\"\n    Runs the deterministic test suite for the M-orthogonality verification procedure.\n    \"\"\"\n    # Define standard basis vectors for convenience\n    e1_4d = np.array([1., 0., 0., 0.])\n    e2_4d = np.array([0., 1., 0., 0.])\n    e3_4d = np.array([0., 0., 1., 0.])\n\n    # Test Case 1: Scale invariance, exact M-orthogonality\n    M1 = np.diag([4., 3., 2., 5.])\n    Phi1 = np.array([7. * e1_4d, -2. * e2_4d, 0.5 * e3_4d]).T\n    epsilon1 = 1e-12\n\n    # Test Case 2: Small violation, strict tolerance\n    Phi2 = np.array([e1_4d + 1e-3 * e2_4d, e2_4d, e3_4d]).T\n    epsilon2 = 1e-6\n\n    # Test Case 3: Same violation, looser tolerance\n    Phi3 = np.copy(Phi2)\n    epsilon3 = 1e-2\n\n    # Test Case 4: Single vector, vacuous orthogonality\n    M2 = np.array([[2., 0., 0.], [0., 5., 1.], [0., 1., 3.]])\n    Phi4 = np.array([[1., 2., 3.]]).T\n    epsilon4 = 1e-12\n\n    # Test Case 5: Non-orthogonal pair under M\n    M3 = np.diag([2., 2.])\n    Phi5 = np.array([[1., 0.], [1., 1.]]).T\n    epsilon5 = 0.5\n\n    # Test Case 6: Invalid input with a zero column\n    M4 = np.diag([1., 1.])\n    Phi6 = np.array([[1., 0.], [0., 0.]]).T\n    epsilon6 = 1e-12\n\n    test_cases = [\n        (M1, Phi1, epsilon1),\n        (M1, Phi2, epsilon2),\n        (M1, Phi3, epsilon3),\n        (M2, Phi4, epsilon4),\n        (M3, Phi5, epsilon5),\n        (M4, Phi6, epsilon6),\n    ]\n\n    results = []\n    for M, Phi, epsilon in test_cases:\n        # K is not needed for the verification procedure.\n        result = is_m_orthogonal(M, Phi, epsilon)\n        results.append(result)\n        \n    # Format the output as a comma-separated list of lowercase boolean literals.\n    print(f\"[{','.join(map(lambda b: str(b).lower(), results))}]\")\n\nsolve()\n```", "id": "2578532"}, {"introduction": "在理想情况下，不同特征值对应的模态是严格 $\\mathbf{M}$-正交的，但为什么在数值计算中我们常常会得到近似正交甚至非正交的结果？这个高级练习将带你探究其背后的一个深刻原因：近重特征值（closely-spaced eigenvalues）的敏感性。你将运用一阶微扰理论，量化当两个特征值非常接近时，微小的模型扰动如何导致模态向量之间产生显著的“正交性缺陷”。这个分析将揭示计算动力学中的一个核心挑战，并加深你对数值解稳定性的理解。[@problem_id:2578501]", "problem": "考虑一个结构动力学中的对称正定广义特征值问题，由矩阵对 $(\\mathbf{K}, \\mathbf{M})$ 给出，其中 $\\mathbf{K} \\in \\mathbb{R}^{2 \\times 2}$ 且 $\\mathbf{M} \\in \\mathbb{R}^{2 \\times 2}$，模态正交性是关于 $\\mathbf{M}$-内积定义的。设\n$$\n\\mathbf{M} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 2 \\end{pmatrix}, \n\\quad \n\\mathbf{K} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 2(1+\\delta) \\end{pmatrix},\n$$\n其中有一个小参数 $\\delta = 10^{-6}$。精确的、$\\mathbf{M}$-标准正交的特征对为 $\\lambda_{1} = 1$ 及对应的 $\\boldsymbol{\\phi}_{1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $\\lambda_{2} = 1 + \\delta$ 及对应的 $\\boldsymbol{\\phi}_{2} = \\begin{pmatrix} 0 \\\\ 1/\\sqrt{2} \\end{pmatrix}$，它们满足 $\\boldsymbol{\\phi}_{i}^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\phi}_{j} = \\delta_{ij}$。\n\n假设通过独立求解两个轻微扰动的广义特征值问题（分别针对第一和第二模态），获得了两个计算模态 $\\boldsymbol{\\psi}_{1}$ 和 $\\boldsymbol{\\psi}_{2}$。每个模态随后被归一化，使得 $\\boldsymbol{\\psi}_{i}^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\psi}_{i} = 1$，但没有进行任何相互正交化步骤。具体来说，假设扰动是对称的，其形式为\n$$\n\\Delta \\mathbf{K}^{(1)} = \\varepsilon \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}, \\quad \\Delta \\mathbf{M}^{(1)} = \\mathbf{0}, \n\\qquad\n\\Delta \\mathbf{K}^{(2)} = \\varepsilon \\begin{pmatrix} 0 & -2 \\\\ -2 & 0 \\end{pmatrix}, \\quad \\Delta \\mathbf{M}^{(2)} = \\mathbf{0},\n$$\n其中 $\\varepsilon = 10^{-8}$。假设扰动足够小，以至于在扰动分析中只保留一阶项是合理的。\n\n从广义特征值方程 $\\mathbf{K} \\boldsymbol{\\phi} = \\lambda \\mathbf{M} \\boldsymbol{\\phi}$、$\\mathbf{K}$ 和 $\\mathbf{M}$ 的对称性、以及 $\\mathbf{M}$-正交性和归一化的定义出发，对展开式\n$$\n\\boldsymbol{\\psi}_{1} = \\boldsymbol{\\phi}_{1} + a\\, \\boldsymbol{\\phi}_{2} + \\text{higher order terms}, \n\\qquad\n\\boldsymbol{\\psi}_{2} = \\boldsymbol{\\phi}_{2} + b\\, \\boldsymbol{\\phi}_{1} + \\text{higher order terms},\n$$\n中的污染系数进行第一性原理的一阶微扰推导，并由此得到 $\\mathbf{M}$-内积缺陷 $\\boldsymbol{\\psi}_{1}^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\psi}_{2}$ 关于 $\\delta$、$\\varepsilon$ 和给定数据的主阶值。对于给定的 $\\delta$ 和 $\\varepsilon$ 值，对你的最终表达式进行数值计算。将你的答案四舍五入到四位有效数字。最终答案必须是一个单个实数。", "solution": "我们从对称正定广义特征值问题开始\n$$\n\\mathbf{K} \\boldsymbol{\\phi} = \\lambda \\mathbf{M} \\boldsymbol{\\phi},\n$$\n其中 $\\mathbf{M}$ 定义了内积 $\\langle \\mathbf{u}, \\mathbf{v} \\rangle_{\\mathbf{M}} = \\mathbf{u}^{\\mathsf{T}} \\mathbf{M} \\mathbf{v}$。对于对称正定对 $(\\mathbf{K}, \\mathbf{M})$，与不同特征值相关联的特征向量是 $\\mathbf{M}$-正交的。给定\n$$\n\\mathbf{M} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 2 \\end{pmatrix}, \n\\quad \n\\mathbf{K} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 2(1+\\delta) \\end{pmatrix},\n\\quad\n\\delta = 10^{-6},\n$$\n其精确的 $\\mathbf{M}$-标准正交特征对为\n$$\n\\lambda_{1} = 1, \\quad \\boldsymbol{\\phi}_{1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}; \n\\qquad\n\\lambda_{2} = 1+\\delta, \\quad \\boldsymbol{\\phi}_{2} = \\begin{pmatrix} 0 \\\\ 1/\\sqrt{2} \\end{pmatrix},\n$$\n满足 $\\boldsymbol{\\phi}_{i}^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\phi}_{j} = \\delta_{ij}$。\n\n通过独立求解两个轻微扰动的特征值问题，然后将每个模态归一化为单位 $\\mathbf{M}$-范数，而不强制相互正交，得到两个计算模态：\n- 对于第一模态，扰动问题是 $(\\mathbf{K} + \\Delta \\mathbf{K}^{(1)}, \\mathbf{M} + \\Delta \\mathbf{M}^{(1)})$，其中\n$$\n\\Delta \\mathbf{K}^{(1)} = \\varepsilon \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}, \\quad \\Delta \\mathbf{M}^{(1)} = \\mathbf{0}.\n$$\n- 对于第二模态，扰动问题是 $(\\mathbf{K} + \\Delta \\mathbf{K}^{(2)}, \\mathbf{M} + \\Delta \\mathbf{M}^{(2)})$，其中\n$$\n\\Delta \\mathbf{K}^{(2)} = \\varepsilon \\begin{pmatrix} 0 & -2 \\\\ -2 & 0 \\end{pmatrix}, \\quad \\Delta \\mathbf{M}^{(2)} = \\mathbf{0}.\n$$\n我们取 $\\varepsilon = 10^{-8}$ 并假设一阶微扰已足够。\n\n我们将计算出的模态在未扰动的 $\\mathbf{M}$-标准正交基 $\\{\\boldsymbol{\\phi}_{1}, \\boldsymbol{\\phi}_{2}\\}$ 中展开到一阶，形式为\n$$\n\\boldsymbol{\\psi}_{1} = \\boldsymbol{\\phi}_{1} + a\\, \\boldsymbol{\\phi}_{2} + \\mathcal{O}(\\varepsilon^{2}),\n\\qquad\n\\boldsymbol{\\psi}_{2} = \\boldsymbol{\\phi}_{2} + b\\, \\boldsymbol{\\phi}_{1} + \\mathcal{O}(\\varepsilon^{2}),\n$$\n其中 $a$ 和 $b$ 是待定的一阶系数。因为 $\\boldsymbol{\\phi}_{1}^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\phi}_{2} = 0$ 且 $\\boldsymbol{\\phi}_{i}^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\phi}_{i} = 1$，所以 $\\boldsymbol{\\psi}_{1}$ 和 $\\boldsymbol{\\psi}_{2}$ 的 $\\mathbf{M}$-范数在 $\\mathcal{O}(\\varepsilon^{2})$ 阶以内保持为1，因此随后的归一化在一阶上不影响 $a$ 和 $b$。\n\n为了推导 $a$，将 $\\boldsymbol{\\psi}_{1}$ 代入第一个扰动特征值问题：\n$$\n\\left(\\mathbf{K} + \\Delta \\mathbf{K}^{(1)}\\right)\\left(\\boldsymbol{\\phi}_{1} + a \\boldsymbol{\\phi}_{2}\\right) \n= \\left(\\lambda_{1} + \\delta \\lambda_{1}\\right) \\mathbf{M} \\left(\\boldsymbol{\\phi}_{1} + a \\boldsymbol{\\phi}_{2}\\right),\n$$\n并只保留 $\\varepsilon$ 和 $a$ 的一阶项：\n$$\n\\mathbf{K}\\boldsymbol{\\phi}_{1} + a \\mathbf{K}\\boldsymbol{\\phi}_{2} + \\Delta \\mathbf{K}^{(1)} \\boldsymbol{\\phi}_{1}\n\\approx \\lambda_{1} \\mathbf{M}\\boldsymbol{\\phi}_{1} + \\lambda_{1} a \\mathbf{M}\\boldsymbol{\\phi}_{2} + \\delta \\lambda_{1} \\mathbf{M}\\boldsymbol{\\phi}_{1}.\n$$\n使用未扰动关系 $\\mathbf{K}\\boldsymbol{\\phi}_{i} = \\lambda_{i}\\mathbf{M}\\boldsymbol{\\phi}_{i}$，从两边减去 $\\mathbf{K}\\boldsymbol{\\phi}_{1} = \\lambda_{1}\\mathbf{M}\\boldsymbol{\\phi}_{1}$ 得到\n$$\na\\, \\mathbf{K}\\boldsymbol{\\phi}_{2} + \\Delta \\mathbf{K}^{(1)} \\boldsymbol{\\phi}_{1}\n\\approx \\lambda_{1} a\\, \\mathbf{M}\\boldsymbol{\\phi}_{2} + \\delta \\lambda_{1}\\, \\mathbf{M}\\boldsymbol{\\phi}_{1}.\n$$\n左乘 $\\boldsymbol{\\phi}_{2}^{\\mathsf{T}}$，并利用对称性以及 $\\boldsymbol{\\phi}_{2}^{\\mathsf{T}}\\mathbf{K}\\boldsymbol{\\phi}_{2} = \\lambda_{2} \\boldsymbol{\\phi}_{2}^{\\mathsf{T}}\\mathbf{M}\\boldsymbol{\\phi}_{2} = \\lambda_{2}$、$\\boldsymbol{\\phi}_{2}^{\\mathsf{T}}\\mathbf{M}\\boldsymbol{\\phi}_{2} = 1$ 和 $\\boldsymbol{\\phi}_{2}^{\\mathsf{T}}\\mathbf{M}\\boldsymbol{\\phi}_{1} = 0$，我们得到\n$$\na \\lambda_{2} + \\boldsymbol{\\phi}_{2}^{\\mathsf{T}} \\Delta \\mathbf{K}^{(1)} \\boldsymbol{\\phi}_{1} \\approx \\lambda_{1} a.\n$$\n因此，\n$$\na (\\lambda_{2} - \\lambda_{1}) \\approx - \\boldsymbol{\\phi}_{2}^{\\mathsf{T}} \\Delta \\mathbf{K}^{(1)} \\boldsymbol{\\phi}_{1},\n\\qquad\\Rightarrow\\qquad\na \\approx - \\frac{\\boldsymbol{\\phi}_{2}^{\\mathsf{T}} \\Delta \\mathbf{K}^{(1)} \\boldsymbol{\\phi}_{1}}{\\lambda_{2} - \\lambda_{1}}.\n$$\n\n类似地，对于第二模态，\n$$\n\\left(\\mathbf{K} + \\Delta \\mathbf{K}^{(2)}\\right)\\left(\\boldsymbol{\\phi}_{2} + b \\boldsymbol{\\phi}_{1}\\right) \n= \\left(\\lambda_{2} + \\delta \\lambda_{2}\\right) \\mathbf{M} \\left(\\boldsymbol{\\phi}_{2} + b \\boldsymbol{\\phi}_{1}\\right),\n$$\n其一阶近似为\n$$\nb (\\lambda_{1} - \\lambda_{2}) \\approx - \\boldsymbol{\\phi}_{1}^{\\mathsf{T}} \\Delta \\mathbf{K}^{(2)} \\boldsymbol{\\phi}_{2},\n\\qquad\\Rightarrow\\qquad\nb \\approx \\frac{\\boldsymbol{\\phi}_{1}^{\\mathsf{T}} \\Delta \\mathbf{K}^{(2)} \\boldsymbol{\\phi}_{2}}{\\lambda_{2} - \\lambda_{1}}.\n$$\n\n计算模态之间的 $\\mathbf{M}$-正交性缺陷，在主阶上为\n$$\n\\boldsymbol{\\psi}_{1}^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\psi}_{2} \n= \\left(\\boldsymbol{\\phi}_{1} + a \\boldsymbol{\\phi}_{2}\\right)^{\\mathsf{T}} \\mathbf{M} \\left(\\boldsymbol{\\phi}_{2} + b \\boldsymbol{\\phi}_{1}\\right) \n= a\\, \\boldsymbol{\\phi}_{2}^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\phi}_{2} + b\\, \\boldsymbol{\\phi}_{1}^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\phi}_{1} + \\mathcal{O}(\\varepsilon^{2})\n= a + b + \\mathcal{O}(\\varepsilon^{2}).\n$$\n\n现在我们计算所需的分子。对于\n$$\n\\Delta \\mathbf{K}^{(1)} = \\varepsilon \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}, \\quad\n\\boldsymbol{\\phi}_{1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad\n\\boldsymbol{\\phi}_{2} = \\begin{pmatrix} 0 \\\\ 1/\\sqrt{2} \\end{pmatrix},\n$$\n我们发现\n$$\n\\boldsymbol{\\phi}_{2}^{\\mathsf{T}} \\Delta \\mathbf{K}^{(1)} \\boldsymbol{\\phi}_{1} \n= \\begin{pmatrix} 0 & 1/\\sqrt{2} \\end{pmatrix} \n\\varepsilon \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}\n\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n= \\begin{pmatrix} 0 & 1/\\sqrt{2} \\end{pmatrix}\n\\varepsilon \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n= \\frac{\\varepsilon}{\\sqrt{2}}.\n$$\n类似地，对于\n$$\n\\Delta \\mathbf{K}^{(2)} = \\varepsilon \\begin{pmatrix} 0 & -2 \\\\ -2 & 0 \\end{pmatrix},\n$$\n我们得到\n$$\n\\boldsymbol{\\phi}_{1}^{\\mathsf{T}} \\Delta \\mathbf{K}^{(2)} \\boldsymbol{\\phi}_{2} \n= \\begin{pmatrix} 1 & 0 \\end{pmatrix}\n\\varepsilon \\begin{pmatrix} 0 & -2 \\\\ -2 & 0 \\end{pmatrix}\n\\begin{pmatrix} 0 \\\\ 1/\\sqrt{2} \\end{pmatrix}\n= \\begin{pmatrix} 1 & 0 \\end{pmatrix}\n\\varepsilon \\begin{pmatrix} -2/\\sqrt{2} \\\\ 0 \\end{pmatrix}\n= - \\frac{2 \\varepsilon}{\\sqrt{2}}.\n$$\n特征值间隙为\n$$\n\\lambda_{2} - \\lambda_{1} = (1 + \\delta) - 1 = \\delta.\n$$\n因此，\n$$\na \\approx - \\frac{\\varepsilon/\\sqrt{2}}{\\delta} = - \\frac{\\varepsilon}{\\sqrt{2}\\, \\delta}, \n\\qquad\nb \\approx \\frac{-2\\varepsilon/\\sqrt{2}}{\\delta} = - \\frac{2\\varepsilon}{\\sqrt{2}\\, \\delta},\n$$\n且主阶 $\\mathbf{M}$-正交性缺陷为\n$$\n\\boldsymbol{\\psi}_{1}^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\psi}_{2} \\approx a + b = - \\frac{3 \\varepsilon}{\\sqrt{2}\\, \\delta}.\n$$\n\n最后，代入 $\\varepsilon = 10^{-8}$ 和 $\\delta = 10^{-6}$：\n$$\n\\boldsymbol{\\psi}_{1}^{\\mathsf{T}} \\mathbf{M} \\boldsymbol{\\psi}_{2} \\approx - \\frac{3 \\times 10^{-8}}{\\sqrt{2} \\times 10^{-6}} = - \\frac{3}{\\sqrt{2}} \\times 10^{-2}.\n$$\n数值上，\n$$\n- \\frac{3}{\\sqrt{2}} \\times 10^{-2} \\approx - 0.021213203\\ldots\n$$\n四舍五入到四位有效数字，所求的值为 $-0.02121$。\n\n此计算展示了 $\\mathbf{M}$-正交性对小谱隙 $\\delta$ 的敏感性，当模态被独立计算时，缺陷的缩放规律为 $\\mathcal{O}(\\varepsilon/\\delta)$，从而量化了小间隙如何导致计算出的模态在数值上非正交。", "answer": "$$\\boxed{-0.02121}$$", "id": "2578501"}]}