{"hands_on_practices": [{"introduction": "经典接触力学问题通常始于一个理想化的点载荷，即 Boussinesq 解。本练习将通过一个核心实践，指导您如何运用叠加原理，从这个基本的点载荷解出发，推导出在更符合实际的均布圆形压力作用下，弹性半空间中心点的精确位移。这个推导过程不仅是接触力学中的一项基本功，更能加深您对格林函数方法在求解复杂载荷问题中强大作用的理解 [@problem_id:2620650]。", "id": "2620650", "problem": "考虑一个占据 $z \\ge 0$ 区域的各向同性、均匀的线性弹性半空间，其杨氏模量为 $E$，泊松比为 $\\nu$。其表面 $z=0$ 除了一块圆形区域 $\\{(x,y): x^{2}+y^{2} \\le a^{2}\\}$ 外是无牵引力的，在该圆形区域上施加了均匀的法向压力 $p$。无切向牵引力。利用叠加原理以及经典半空间法向点载荷的格林函数（Boussinesq 问题），从第一性原理出发，推导该加载区域的法向表面柔度 $C(a)$ 的显式闭式表达式。柔度 $C(a)$ 定义为区域中心的竖向位移与总合力之比，即\n$$\nC(a) \\equiv \\frac{w(0)}{P}, \\quad P \\equiv \\int_{x^{2}+y^{2}\\le a^{2}} p \\, \\mathrm{d}A = \\pi a^{2} p.\n$$\n你的推导必须从线性弹性场方程和叠加原理开始，并应阐明 Boussinesq 点载荷解与区域柔度之间的逻辑联系。将你的最终结果表示为以 $E$、$\\nu$ 和 $a$ 表示的单一解析表达式。不要将中间公式作为最终答案。最终答案必须是单一的闭式表达式。不需要进行数值计算，也无需在最终答案中报告单位。", "solution": "该问题陈述经核实是科学上成立、适定且客观的。它提出了线性弹性理论中的一个经典问题，具体涉及弹性半空间上的接触力学。此问题是自洽且无矛盾的。我们将按照要求从第一性原理出发进行严格推导。\n\n本分析的基础是 Boussinesq 问题，该问题给出了各向同性、均匀的线性弹性半空间在其表面受到集中法向点载荷作用下的应力场和位移场解。设半空间占据区域 $z \\ge 0$。一个大小为 $P_0$ 的点载荷作用于原点 $(0,0,0)$，方向为负 $z$ 方向。在表面 $z=0$ 上，距离作用点径向距离为 $r = \\sqrt{x^2 + y^2}$ 处的竖向位移 $w(r)$ 由以下基本解给出：\n$$\nw(r) = \\frac{P_0 (1 - \\nu^2)}{\\pi E r}\n$$\n其中 $E$ 是弹性材料的杨氏模量，$\\nu$ 是泊松比。此表达式可作为由法向点载荷引起的竖向表面位移的格林函数。\n\n本题描述了一个以原点为中心、半径为 $a$ 的圆形区域上分布的均匀法向压力 $p$。线性叠加原理对线性弹性系统有效，它允许我们通过在整个加载区域上对无穷小点载荷的影响进行积分来确定任意点的总位移。\n\n考虑位于圆形区域 $D = \\{(\\xi, \\eta) : \\xi^2 + \\eta^2 \\le a^2\\}$ 内一点 $(\\xi, \\eta)$ 处的无穷小面积元 $dA'$。该面积元承受无穷小的法向力 $dP = p \\, dA'$。这个力可以被视为一个集中点载荷。\n\n我们需要求解的是区域中心，即点 $(x=0, y=0)$ 处的竖向位移 $w(0)$。从源点 $(\\xi, \\eta)$ 到场点 $(0,0)$ 的距离为 $r' = \\sqrt{\\xi^2 + \\eta^2}$。位于 $(\\xi, \\eta)$ 处的无穷小载荷 $dP$ 对中心点竖向位移的贡献 $dw(0)$ 可通过应用 Boussinesq 公式得到：\n$$\ndw(0) = \\frac{dP (1 - \\nu^2)}{\\pi E r'} = \\frac{p \\, dA' (1 - \\nu^2)}{\\pi E r'}\n$$\n为了求得总的竖向位移 $w(0)$，我们必须将此表达式在整个圆形域 $D$ 上进行积分：\n$$\nw(0) = \\iint_D \\frac{p (1 - \\nu^2)}{\\pi E r'} \\, dA'\n$$\n使用极坐标进行积分最为方便。设源点由 $(\\rho', \\phi')$ 描述，其中 $\\xi = \\rho' \\cos \\phi'$，$\\eta = \\rho' \\sin \\phi'$。在此坐标系中，到原点的距离为 $r' = \\rho'$，无穷小面积元为 $dA' = \\rho' \\, d\\rho' \\, d\\phi'$。积分限为 $0 \\le \\rho' \\le a$ 和 $0 \\le \\phi' \\le 2\\pi$。\n\n将这些代入 $w(0)$ 的积分中，我们得到：\n$$\nw(0) = \\int_{0}^{2\\pi} \\int_{0}^{a} \\frac{p (1 - \\nu^2)}{\\pi E \\rho'} (\\rho' \\, d\\rho' \\, d\\phi')\n$$\n一个关键的简化在于，来自面积元的项 $\\rho'$ 与格林函数分母中的项 $\\rho'$ 相抵消。被积函数变得与积分变量无关：\n$$\nw(0) = \\int_{0}^{2\\pi} \\int_{0}^{a} \\frac{p (1 - \\nu^2)}{\\pi E} \\, d\\rho' \\, d\\phi'\n$$\n我们可以分离积分并直接计算它们：\n$$\nw(0) = \\frac{p (1 - \\nu^2)}{\\pi E} \\left( \\int_{0}^{2\\pi} d\\phi' \\right) \\left( \\int_{0}^{a} d\\rho' \\right)\n$$\n这些初等积分的计算结果为：\n$$\n\\int_{0}^{2\\pi} d\\phi' = 2\\pi, \\quad \\int_{0}^{a} d\\rho' = a\n$$\n将这些结果代回 $w(0)$ 的表达式中：\n$$\nw(0) = \\frac{p (1 - \\nu^2)}{\\pi E} (2\\pi)(a) = \\frac{2pa(1 - \\nu^2)}{E}\n$$\n这就是加载圆形区域中心的竖向位移。\n\n题目将柔度 $C(a)$ 定义为该中心位移与总合力 $P$ 的比值。总载荷 $P$ 是均匀压力 $p$ 在圆形面积 $\\pi a^2$ 上的积分：\n$$\nP = p (\\pi a^2)\n$$\n由此，我们用总载荷 $P$ 来表示压力 $p$：\n$$\np = \\frac{P}{\\pi a^2}\n$$\n现在，将这个 $p$ 的表达式代入 $w(0)$ 的公式中：\n$$\nw(0) = \\frac{2 \\left( \\frac{P}{\\pi a^2} \\right) a (1 - \\nu^2)}{E} = \\frac{2P(1 - \\nu^2)}{\\pi a E}\n$$\n最后，我们根据其定义计算柔度 $C(a)$：\n$$\nC(a) \\equiv \\frac{w(0)}{P} = \\frac{1}{P} \\left( \\frac{2P(1 - \\nu^2)}{\\pi a E} \\right)\n$$\n总载荷 $P$ 被消去，得到法向表面柔度的最终表达式：\n$$\nC(a) = \\frac{2(1 - \\nu^2)}{\\pi a E}\n$$\n此结果是材料属性 $E$ 和 $\\nu$ 以及加载区域半径 $a$ 的函数，符合题目要求。", "answer": "$$\n\\boxed{\\frac{2(1 - \\nu^{2})}{\\pi a E}}\n$$"}, {"introduction": "在掌握了空间域中的直接积分法后，我们转向一个更具洞察力的视角——傅立叶（或称频谱）域。本练习引导您探索如何使用傅立叶变换来分析法向牵引与表面位移之间的关系，推导出频谱格林函数（即频谱柔度），并理解其 $1/k$ 形式所揭示的非局域性。您还将学习如何通过高斯函数（一种“软化”因子）来对理想点载荷的奇异性进行正则化处理，这是连接理论与数值计算的关键一步 [@problem_id:2620658]。", "id": "2620658", "problem": "考虑一个占据区域 $z \\ge 0$ 的各向同性、均匀、线弹性半空间，其特征为杨氏模量 $E$ 和泊松比 $\\nu$。令 $\\mu$ 和 $\\lambda$ 表示拉梅参数。$z=0$ 处的表面承受规定的法向牵引分布 $t_z(x,y)$，无切向牵引。目标是使用物理上合理的格林核表示来计算产生的竖向表面位移 $w(x,y) = u_z(x,y, z=0)$，并解决奇异核的计算方面和正则化问题。\n\n从第一性原理出发，使用以下基础：\n- 在无体力情况下的静态平衡 Navier 方程：$\\mu \\nabla^2 \\mathbf{u} + (\\lambda + \\mu) \\nabla (\\nabla \\cdot \\mathbf{u}) = \\mathbf{0}$，其中 $\\mathbf{u}$ 是位移场。\n- 在 $z=0$ 上的牵引-位移边界条件。\n- 平行于表面的平移不变性，使得可以在平面 $z=0$ 上进行二维傅里叶分析。\n- 通过格林核在空间域中的解的卷积表示，以及其在谱域中的等效乘法。\n- 柔化子作为奇异核的正则化工具的概念，具体使用归一化高斯函数。\n\n你的任务：\n1. 从上述基础出发，推导将法向牵引 $t_z(x,y)$ 的二维傅里叶变换映射到所产生的表面法向位移 $w(x,y)$ 的二维傅里叶变换的谱关系。用波数大小 $k = \\sqrt{k_x^2 + k_y^2}$ 和接触模量 $E^\\star = E/(1-\\nu^2)$ 来表示该关系。证明为何出现与 $1/k$ 成比例的非局部柔度。\n2. 使用逆变换获得 $w(x,y)$ 相应的空间域卷积定律，其标量核仅依赖于面内距离 $r = \\sqrt{x^2 + y^2}$。解释 $1/r$ 奇异性的来源。\n3. 引入正则化，将总力为 $P$ 的点载荷建模为标准差为 $\\varepsilon$ 的归一化高斯柔化子 $\\rho_\\varepsilon(x,y)$，使得 $t_z(x,y) = P \\rho_\\varepsilon(x,y)$ 且 $\\int_{\\mathbb{R}^2} \\rho_\\varepsilon \\, \\mathrm{d}x \\mathrm{d}y = 1$。推导在载荷中心 $w(\\mathbf{0})$ 处的正则化自位移的解析表达式，作为 $P$、$E^\\star$ 和 $\\varepsilon$ 的函数。说明当 $\\varepsilon \\to 0^+$ 时的收敛行为。\n4. 对于施加在以原点为中心、半径为 $a$ 的圆形区域上的均匀压力 $p$，使用步骤 2 中的空间卷积定律，推导中心位移 $w(\\mathbf{0})$ 的精确表达式。\n5. 设计并实现一个使用二维离散傅里叶变换的数值算法，在边长为 $L$、在 $N \\times N$ 网格上离散化（网格间距 $\\Delta x = L/N$）的方形周期性计算单元上计算 $w(x,y)$。对法向载荷使用步骤 1 中的谱柔度，并将零波数项设为零，以消除由周期性延拓产生的非物理刚体模式。讨论周期性镜像和截断对精度的影响，以及正则化的作用。你的实现必须：\n   - 在网格上构造下面指定的牵引场，中心位于 $(x,y)=(0,0)$。\n   - 对于高斯载荷，重新缩放离散牵引，使离散总力高精度地等于规定的 $P$。\n   - 计算 $w(\\mathbf{0})$ 的数值近似值。\n   - 与相应的解析表达式进行比较，并报告相对误差。\n\n物理单位：所有长度单位必须是米，牵引单位是帕斯卡，力单位是牛顿，位移单位是米。角度无需使用。要求的输出是无量纲的相对误差。\n\n测试套件和要求的输出：\n- 使用材料参数 $E = 70 \\times 10^9$ Pa 和 $\\nu = 0.25$，因此 $E^\\star = E/(1-\\nu^2)$。\n- 使用边长 $L = 1.0$ 米、每个方向有 $N = 512$ 个网格点的方形计算单元。\n- 定义三个测试案例：\n  1. 总力 $P = 1000$ N、标准差 $\\varepsilon = 0.020$ 米的高斯正则化点载荷。计算数值解 $w(\\mathbf{0})$ 与步骤 3 中推导的解析表达式之间的相对误差。\n  2. 在以原点为中心、半径 $a = 0.040$ 米的圆形区域上施加均匀压力 $p = 2.0 \\times 10^6$ Pa。计算数值解 $w(\\mathbf{0})$ 与步骤 4 中推导的解析表达式之间的相对误差。\n  3. 总力 $P = 1000$ N、标准差 $\\varepsilon = 0.005$ 米的高斯正则化点载荷。计算数值解 $w(\\mathbf{0})$ 与步骤 3 中推导的解析表达式之间的相对误差。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，按三个测试案例的顺序排列：$[\\text{err}_1,\\text{err}_2,\\text{err}_3]$，其中每个 $\\text{err}_i$ 是定义为 $\\lvert w_{\\text{num}} - w_{\\text{an}} \\rvert / \\lvert w_{\\text{an}} \\rvert$ 的相对误差，并表示为浮点数。", "solution": "该问题陈述是线弹性力学和计算力学中一个适定且科学严谨的练习，具体涉及弹性半空间的 Boussinesq 问题。该问题是有效的，可以按如下方式求解。以下步骤对应于问题中概述的任务。\n\n首先，我们定义将要使用的材料参数和常数。弹性半空间的特征是杨氏模量 $E$ 和泊松比 $\\nu$。拉梅参数通过 $\\mu = E / (2(1+\\nu))$ 和 $\\lambda = E\\nu / ((1+\\nu)(1-2\\nu))$ 相关。接触模量，或称平面应变模量，定义为 $E^\\star = E / (1-\\nu^2)$。\n\n### 1. 谱关系的推导\n\n我们从无体力情况下的静态平衡 Navier 方程开始：\n$$ \\mu \\nabla^2 \\mathbf{u} + (\\lambda + \\mu) \\nabla (\\nabla \\cdot \\mathbf{u}) = \\mathbf{0} $$\n其中 $\\mathbf{u}(\\mathbf{x}, z)$ 是位移场。我们在空间坐标 $(x,y)$ 上应用二维傅里叶变换。函数 $f(x,y)$ 的变换表示为 $\\hat{f}(k_x, k_y)$:\n$$ \\hat{f}(\\mathbf{k}) = \\int_{\\mathbb{R}^2} f(\\mathbf{x}) e^{-i\\mathbf{k}\\cdot\\mathbf{x}} d^2\\mathbf{x} $$\n其中 $\\mathbf{x}=(x,y)$ 且 $\\mathbf{k}=(k_x, k_y)$。算子变换为 $\\nabla \\to (i k_x, i k_y, \\partial_z)$ 和 $\\nabla^2 \\to (-k^2 + \\partial_z^2)$，其中 $k = \\sqrt{k_x^2+k_y^2}$ 是波数大小。这将偏微分方程组转换为关于变换后位移分量 $\\hat{\\mathbf{u}}(\\mathbf{k}, z)$ 的关于 $z$ 的常微分方程组。\n\n当 $z \\to \\infty$ 时衰减的这些常微分方程的通解可以表示为：\n$$ \\hat{u}_j(\\mathbf{k}, z) = (A_j + z B_j) e^{-kz} $$\n将此代入变换后的 Navier 方程，可以得到系数 $A_j$ 和 $B_j$ 的代数约束。一种更方便的方法是使用弹性理论的已知结果。法向载荷下变换后位移的解由下式给出：\n$$ \\hat{u}_x(\\mathbf{k}, z) = C(\\mathbf{k}) (1-2\\nu - kz) e^{-kz} \\frac{ik_x}{k} $$\n$$ \\hat{u}_y(\\mathbf{k}, z) = C(\\mathbf{k}) (1-2\\nu - kz) e^{-kz} \\frac{ik_y}{k} $$\n$$ \\hat{u}_z(\\mathbf{k}, z) = C(\\mathbf{k}) (2(1-\\nu) + kz) e^{-kz} $$\n系数 $C(\\mathbf{k})$ 由表面 $z=0$ 的边界条件确定。边界条件是切向牵引为零（$\\sigma_{xz}=\\sigma_{yz}=0$）和规定的法向牵引 $\\sigma_{zz}(x,y,0) = t_z(x,y)$。相关的应力分量是 $\\sigma_{zz}$，用位移表示的胡克定律为：\n$$ \\sigma_{zz} = \\lambda(\\partial_x u_x + \\partial_y u_y + \\partial_z u_z) + 2\\mu \\partial_z u_z $$\n应用傅里叶变换得到：\n$$ \\hat{\\sigma}_{zz}(\\mathbf{k},z) = \\lambda(ik_x \\hat{u}_x + ik_y \\hat{u}_y + \\partial_z \\hat{u}_z) + 2\\mu \\partial_z \\hat{u}_z $$\n我们使用 $\\hat{u}_j$ 的表达式在 $z=0$ 处计算该值。导数为：\n$$ \\partial_z \\hat{u}_z |_{z=0} = C(\\mathbf{k})(-k(2(1-\\nu)) + k) = C(\\mathbf{k})k(1-2(1-\\nu)) = -C(\\mathbf{k})k(1-2\\nu) $$\n面内位移的散度为：\n$$ ik_x \\hat{u}_x + ik_y \\hat{u}_y |_{z=0} = C(\\mathbf{k}) (1-2\\nu) \\frac{i^2(k_x^2+k_y^2)}{k} = -C(\\mathbf{k})k(1-2\\nu) $$\n将这些代入 $z=0$ 处的 $\\hat{\\sigma}_{zz}$ 表达式：\n$$ \\hat{t}_z(\\mathbf{k}) = \\hat{\\sigma}_{zz}(\\mathbf{k},0) = \\lambda(-C(\\mathbf{k})k(1-2\\nu)) + (\\lambda+2\\mu)(-C(\\mathbf{k})k(1-2\\nu)) = -2(\\lambda+\\mu)C(\\mathbf{k})k(1-2\\nu) $$\n使用关系式 $\\lambda+\\mu=\\mu/(1-2\\nu)$, 这简化为:\n$$ \\hat{t}_z(\\mathbf{k}) = -2\\mu C(\\mathbf{k}) k $$\n因此，我们可以解出 $C(\\mathbf{k}) = -\\frac{\\hat{t}_z(\\mathbf{k})}{2\\mu k}$。\n表面法向位移是 $w(x,y) = u_z(x,y,0)$，所以它的变换是 $\\hat{w}(\\mathbf{k}) = \\hat{u}_z(\\mathbf{k},0)$。从通解得到：\n$$ \\hat{w}(\\mathbf{k}) = C(\\mathbf{k}) \\cdot 2(1-\\nu) = -\\frac{\\hat{t}_z(\\mathbf{k})}{2\\mu k} \\cdot 2(1-\\nu) = -\\frac{1-\\nu}{\\mu} \\frac{\\hat{t}_z(\\mathbf{k})}{-k} $$\n经典文献的表述中存在一个符号错误。向下的力 $P$（负牵引）应导致向下的位移 $w$（负）。我们定义 $t_z$ 为压力（向下为正）。表面法线向上，因此 $\\sigma_{zz} = -t_z$。\n则 $\\hat{\\sigma}_{zz}(\\mathbf{k},0) = -\\hat{t}_z(\\mathbf{k})$, 所以 $C(\\mathbf{k}) = \\frac{\\hat{t}_z(\\mathbf{k})}{2\\mu k}$。\n这给出 $\\hat{w}(\\mathbf{k}) = \\frac{1-\\nu}{\\mu} \\frac{\\hat{t}_z(\\mathbf{k})}{k}$。这是在 $+z$ 方向上的压力 $t_z$ 引起的 $+z$ 方向上的位移。让我们假设标准的载荷约定（压力 $p$ 向下作用，位移 $w$ 向下为正）。关系式为：\n$$ \\hat{w}(\\mathbf{k}) = \\frac{1-\\nu}{\\mu} \\frac{\\hat{p}(\\mathbf{k})}{k} $$\n使用 $\\mu = E/(2(1+\\nu))$ 和 $E^\\star = E/(1-\\nu^2)$:\n$$ \\frac{1-\\nu}{\\mu} = \\frac{(1-\\nu) \\cdot 2(1+\\nu)}{E} = \\frac{2(1-\\nu^2)}{E} = \\frac{2}{E/(1-\\nu^2)} = \\frac{2}{E^\\star} $$\n最终的谱关系是：\n$$ \\hat{w}(\\mathbf{k}) = \\frac{2}{E^\\star k} \\hat{p}(\\mathbf{k}) $$\n该关系表示频域中的一个线性滤波器。位移对给定波数 $k$ 处的牵引分量的响应与该波数处的牵引成正比。比例因子 $\\hat{G}(k) = 2/(E^\\star k)$ 是谱柔度或格林函数。$1/k$ 的出现表明该问题由一个椭圆偏微分方程控制，其格林函数是非局部的。在空间域中，这对应于长程相互作用。对于小 $k$（长波长），柔度较大，表明半空间对大尺度载荷是柔顺的；对于大 $k$（短波长），柔度较小，表明对高度局部化的载荷是刚性的。\n\n### 2. 空间域卷积定律\n\n根据卷积定理，频域中的关系 $\\hat{w}(\\mathbf{k}) = \\hat{G}(\\mathbf{k}) \\hat{p}(\\mathbf{k})$ 对应于空间域中的卷积：\n$$ w(\\mathbf{x}) = (G * p)(\\mathbf{x}) = \\int_{\\mathbb{R}^2} G(\\mathbf{x}-\\mathbf{x'}) p(\\mathbf{x'}) d^2\\mathbf{x'} $$\n空间格林函数 $G(\\mathbf{x})$ 是 $\\hat{G}(\\mathbf{k})$ 的傅里叶逆变换：\n$$ G(\\mathbf{x}) = \\mathcal{F}^{-1}\\{\\hat{G}(\\mathbf{k})\\} = \\frac{1}{(2\\pi)^2} \\int_{\\mathbb{R}^2} \\frac{2}{E^\\star k} e^{i\\mathbf{k}\\cdot\\mathbf{x}} d^2\\mathbf{k} $$\n由于旋转对称性，$G$ 只依赖于模长 $r=|\\mathbf{x}|$。我们将 k-平面中的积分转换为极坐标（$k_x = k\\cos\\phi, k_y = k\\sin\\phi$），并将 x 轴与 $\\mathbf{x}$ 对齐，使得 $\\mathbf{k}\\cdot\\mathbf{x} = kr\\cos\\phi$：\n$$ G(r) = \\frac{2}{(2\\pi)^2 E^\\star} \\int_0^\\infty \\int_0^{2\\pi} \\frac{1}{k} e^{ikr\\cos\\phi} k d\\phi dk = \\frac{2}{4\\pi^2 E^\\star} \\int_0^\\infty \\left( \\int_0^{2\\pi} e^{ikr\\cos\\phi} d\\phi \\right) dk $$\n内部积分是第一类零阶贝塞尔函数的标准表示：$\\int_0^{2\\pi} e^{iz\\cos\\phi} d\\phi = 2\\pi J_0(z)$。\n$$ G(r) = \\frac{2 \\cdot 2\\pi}{4\\pi^2 E^\\star} \\int_0^\\infty J_0(kr) dk = \\frac{1}{\\pi E^\\star} \\int_0^\\infty J_0(kr) dk $$\n利用恒等式 $\\int_0^\\infty J_0(u)du=1$ 并代入 $u=kr$, $du=r dk$:\n$$ G(r) = \\frac{1}{\\pi E^\\star r} \\int_0^\\infty J_0(u) du = \\frac{1}{\\pi E^\\star r} $$\n这是著名的 Boussinesq 核。卷积定律是：\n$$ w(\\mathbf{x}) = \\frac{1}{\\pi E^\\star} \\int_{\\mathbb{R}^2} \\frac{p(\\mathbf{x'})}{|\\mathbf{x}-\\mathbf{x'}|} d^2\\mathbf{x'} $$\n$1/r$ 奇异性源于频域中核的 $1/k$ 行为。物理上，这对应于对点载荷的响应。在原点的集中力 $P$ 对应于狄拉克δ函数压力 $p(\\mathbf{x}) = P\\delta(\\mathbf{x})$，产生无限位移 $w(0)$，这反映了点载荷下无限应力的非物理性质。\n\n### 3. 正则化点载荷位移\n\n我们用一个正则化的、归一化的高斯压力分布来模拟点载荷 $P$：\n$$ p(x,y) = P \\rho_\\varepsilon(x,y) = \\frac{P}{2\\pi\\varepsilon^2} e^{-(x^2+y^2)/(2\\varepsilon^2)} $$\n其中 $\\varepsilon$ 是正则化长度尺度。我们可以使用空间或谱表示法来计算中心位移 $w(\\mathbf{0})$。谱方法更直接。首先，我们找到压力的傅里叶变换：\n$$ \\hat{p}(\\mathbf{k}) = \\mathcal{F}\\left\\{ \\frac{P}{2\\pi\\varepsilon^2} e^{-r^2/(2\\varepsilon^2)} \\right\\} = P \\cdot \\mathcal{F}\\left\\{ \\frac{1}{2\\pi\\varepsilon^2} e^{-r^2/(2\\varepsilon^2)} \\right\\} = P e^{-k^2\\varepsilon^2/2} $$\n位移的变换是 $\\hat{w}(\\mathbf{k}) = \\hat{G}(k) \\hat{p}(\\mathbf{k}) = \\frac{2 P}{E^\\star k} e^{-k^2\\varepsilon^2/2}$。\n为了找到 $w(\\mathbf{0})$，我们在 $\\mathbf{x}=\\mathbf{0}$ 处计算傅里叶逆变换：\n$$ w(\\mathbf{0}) = \\frac{1}{(2\\pi)^2} \\int_{\\mathbb{R}^2} \\hat{w}(\\mathbf{k}) d^2\\mathbf{k} = \\frac{1}{4\\pi^2} \\int_0^{2\\pi} \\int_0^\\infty \\left( \\frac{2P}{E^\\star k} e^{-k^2\\varepsilon^2/2} \\right) k dk d\\phi $$\n$$ w(\\mathbf{0}) = \\frac{2\\pi \\cdot 2P}{4\\pi^2 E^\\star} \\int_0^\\infty e^{-k^2\\varepsilon^2/2} dk = \\frac{P}{\\pi E^\\star} \\int_0^\\infty e^{-k^2\\varepsilon^2/2} dk $$\n该积分是标准的高斯积分：$\\int_0^\\infty e^{-a u^2} du = \\frac{1}{2}\\sqrt{\\frac{\\pi}{a}}$。这里，$a = \\varepsilon^2/2$。\n$$ \\int_0^\\infty e^{-k^2\\varepsilon^2/2} dk = \\frac{1}{2} \\sqrt{\\frac{\\pi}{\\varepsilon^2/2}} = \\frac{\\sqrt{2\\pi}}{2\\varepsilon} $$\n代入这个结果得到中心位移：\n$$ w(\\mathbf{0}) = \\frac{P}{\\pi E^\\star} \\frac{\\sqrt{2\\pi}}{2\\varepsilon} = \\frac{P}{\\sqrt{2\\pi} E^\\star \\varepsilon} $$\n当正则化参数 $\\varepsilon \\to 0^+$ 时，项 $1/\\varepsilon \\to \\infty$，因此 $w(\\mathbf{0}) \\to \\infty$。这正确地恢复了理想点载荷的奇异行为。\n\n### 4. 圆形区域上的均匀压力\n\n对于施加在半径为 $a$ 的圆形区域上的均匀压力 $p$，压力分布为 $p(r) = p$ 当 $r \\le a$，$p(r) = 0$ 当 $r > a$。我们使用步骤 2 中推导的空间卷积定律计算中心位移 $w(\\mathbf{0})$：\n$$ w(\\mathbf{0}) = \\int_{\\mathbb{R}^2} G(\\mathbf{0}-\\mathbf{x'})p(\\mathbf{x'}) d\\mathbf{x'} = \\int_{|\\mathbf{x'}| \\le a} \\frac{1}{\\pi E^\\star |\\mathbf{x'}|} p \\, d\\mathbf{x'} $$\n我们对积分变量 $\\mathbf{x'} = (r', \\theta')$ 切换到极坐标，其中 $d\\mathbf{x'} = r'dr'd\\theta'$：\n$$ w(\\mathbf{0}) = \\frac{p}{\\pi E^\\star} \\int_0^{2\\pi} \\int_0^a \\frac{1}{r'} r' dr' d\\theta' = \\frac{p}{\\pi E^\\star} \\int_0^{2\\pi} \\left( \\int_0^a dr' \\right) d\\theta' $$\n$$ w(\\mathbf{0}) = \\frac{p}{\\pi E^\\star} \\int_0^{2\\pi} a \\, d\\theta' = \\frac{p a}{\\pi E^\\star} [ \\theta' ]_0^{2\\pi} = \\frac{p a}{\\pi E^\\star} (2\\pi) $$\n中心位移的精确表达式是：\n$$ w(\\mathbf{0}) = \\frac{2pa}{E^\\star} $$\n\n### 5. 数值算法与实现\n\n该数值方法使用二维快速傅里叶变换（FFT）通过在谱域中的乘法来实现卷积。\n\n**算法：**\n1.  **离散化**：在 $N \\times N$ 网格上定义一个边长为 $L$ 的方形域。网格间距为 $\\Delta x = L/N$。我们使用中心化的坐标网格 $x_i, y_j \\in [-L/2, L/2)$。\n2.  **频率网格**：使用 `np.fft.fftfreq` 构建相应的二维频率网格 $(k_x, k_y)$。波数为 $k_{m} = 2\\pi m/L$，其中 $m \\in \\{-N/2, \\dots, N/2-1\\}$。计算波数大小 $k = \\sqrt{k_x^2 + k_y^2}$。\n3.  **谱核**：构建离散谱格林函数 $\\hat{G}(k_x, k_y) = 2 / (E^\\star k)$。在零波数点 $(k_x, k_y) = (0,0)$ 处，$k=0$ 且核是奇异的。这对应于半空间的刚体平移，这在物理上是任意的。我们设置 $\\hat{G}(0,0) = 0$ 以消除此模式，这等效于约束平均位移为零。\n4.  **牵引场**：对于每个测试案例，在空间网格上构建压力分布 $p(x_i, y_j)$。对于高斯载荷，确保离散总力 $\\sum p_{ij} \\Delta x^2$ 等于规定的力 $P$。\n5.  **FFT 卷积**：\n    a. 计算压力网格的二维 FFT：$\\hat{p} = \\text{fft2}(p)$。\n    b. 在频域中逐元素相乘：$\\hat{w} = \\hat{p} \\cdot \\hat{G}$。\n    c. 计算二维逆 FFT 以获得位移场：$w = \\text{ifft2}(\\hat{w})$。由于数值精度，结果是复数，因此我们取其实部。\n6.  **比较**：提取网格中心的数值位移 $w_{\\text{num}}(\\mathbf{0})$，并将其与步骤 3 和 4 中推导的解析解 $w_{\\text{an}}(\\mathbf{0})$ 进行比较，以计算相对误差。\n\n**影响讨论：**\n-   **周期性镜像**：FFT 假设周期性边界条件。这意味着我们的计算模拟了一个无限晶格，其中相同的载荷以 $L$ 的间距排列。任何一点的计算位移都包括所有这些“周期性镜像”的贡献。这导致位移与真实的孤立载荷问题相比被高估。误差量级为 $1/L$，随着域大小 $L$ 相对于载荷尺寸的增加而减小。\n-   **截断/混叠**：有限网格 ($N$) 施加了一个最大可表示波数（奈奎斯特频率，$k_{Nyq} = \\pi/\\Delta x$）。真实信号中高于此频率的频率会被“混叠”到较低频率，从而引入误差。如果压力的傅里叶变换 $\\hat{p}(k)$ 在 $k_{Nyq}$ 之外有大量能量，则此误差会很显著。对于平滑的高斯压力，$\\hat{p}(k)$ 衰减非常快，因此如果 $\\varepsilon > \\Delta x$，此误差很小。对于边缘锐利的圆形压力，$\\hat{p}(k)$ 衰减较慢 ($k^{-3/2}$)，因此混叠误差通常较大。\n-   **正则化**：高斯情况下的柔化子参数 $\\varepsilon$ 确保载荷是平滑的并且其频谱是带限的，这对于基于 FFT 的方法的准确性至关重要。为使数值方案能够准确解析载荷，$\\varepsilon$ 应大于网格间距 $\\Delta x$。当 $\\varepsilon$ 接近 $\\Delta x$ 时，高斯函数的离散表示变差，从而增加误差。\n\n实现此算法的 Python 代码在最终答案中提供。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Boussinesq problem for a half-space under different normal traction\n    distributions using a 2D FFT-based spectral method and compares the numerical\n    results to analytical solutions.\n    \"\"\"\n    # Physical and computational parameters\n    E = 70.0e9  # Young's modulus in Pa\n    nu = 0.25    # Poisson's ratio\n    L = 1.0      # Side length of the computational cell in m\n    N = 512      # Number of grid points in each direction\n\n    # Derived parameters\n    E_star = E / (1.0 - nu**2)\n    dx = L / N\n\n    # 1. Construct frequency grid\n    k_freq = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n    kx, ky = np.meshgrid(k_freq, k_freq)\n    k_mag = np.sqrt(kx**2 + ky**2)\n\n    # 2. Construct spectral Green's function (compliance)\n    # G_hat(k) = 2 / (E_star * k)\n    G_hat = np.zeros_like(k_mag, dtype=float)\n    # Avoid division by zero at k=0\n    non_zero_k = k_mag != 0\n    G_hat[non_zero_k] = 2.0 / (E_star * k_mag[non_zero_k])\n    # The k=0 term (rigid body mode) is explicitly set to 0.\n\n    # 3. Construct spatial grid, centered at (0,0)\n    x_coords = np.arange(-N/2, N/2) * dx\n    xx, yy = np.meshgrid(x_coords, x_coords)\n    \n    test_cases = [\n        {'type': 'gaussian', 'P': 1000.0, 'eps': 0.020},\n        {'type': 'circular', 'p': 2.0e6, 'a': 0.040},\n        {'type': 'gaussian', 'P': 1000.0, 'eps': 0.005},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # 4. Construct traction field on the grid\n        if case['type'] == 'gaussian':\n            P = case['P']\n            eps = case['eps']\n            \n            # Analytic solution for centered displacement\n            w_an = P / (np.sqrt(2 * np.pi) * E_star * eps)\n            \n            # Define unscaled Gaussian traction\n            tz_unscaled = np.exp(-(xx**2 + yy**2) / (2 * eps**2))\n            \n            # Rescale to ensure discrete total force is P\n            # Discrete sum approximates integral: sum(f_i * dA)\n            discrete_total_force = np.sum(tz_unscaled) * dx**2\n            scaling_factor = P / discrete_total_force\n            tz_grid = tz_unscaled * scaling_factor\n            \n        elif case['type'] == 'circular':\n            p = case['p']\n            a = case['a']\n            \n            # Analytic solution for centered displacement\n            w_an = (2 * p * a) / E_star\n            \n            # Define uniform pressure over a circular area\n            r = np.sqrt(xx**2 + yy**2)\n            tz_grid = np.zeros_like(r)\n            tz_grid[r <= a] = p\n        \n        # 5. Perform FFT-based convolution\n        # a. FFT of the traction field\n        Tz_hat = np.fft.fft2(tz_grid)\n        \n        # b. Multiply by spectral Green's function\n        W_hat = Tz_hat * G_hat\n        \n        # c. Inverse FFT to get displacement field\n        w_grid = np.fft.ifft2(W_hat)\n        \n        # The output from iFFT should be real, except for small numerical noise.\n        # The grid is constructed such that the origin (0,0) corresponds to\n        # the indices (N/2, N/2).\n        w_num_center = np.real(w_grid[N//2, N//2])\n        \n        # 6. Compute relative error\n        relative_error = np.abs(w_num_center - w_an) / np.abs(w_an)\n        results.append(relative_error)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"}, {"introduction": "最后，本练习将理论付诸实践，要求您设计并实现一个基于快速傅立叶变换 (FFT) 的数值算法，用于计算任意法向载荷分布下的表面位移场。您将通过编写代码，将频谱方法应用于具体的载荷情况，并将数值计算结果与之前推导出的解析解进行比较，从而亲身体验计算力学的威力与挑战。这个过程不仅能巩固您的理论知识，还能让您深入理解周期性边界条件、混叠效应等在数值模拟中的重要概念 [@problem_id:2620658]。", "id": "2620658", "problem": "考虑一个占据区域 $z \\ge 0$ 的各向同性、均匀、线弹性半空间，其特征为杨氏模量 $E$ 和泊松比 $\\nu$。令 $\\mu$ 和 $\\lambda$ 表示拉梅参数。位于 $z=0$ 的表面承受指定的法向牵引分布 $t_z(x,y)$，而切向牵引为零。目标是使用物理上合理的格林核表示来计算产生的垂直表面位移 $w(x,y) = u_z(x,y, z=0)$，并探讨计算方面以及奇异核的正则化问题。\n\n从第一性原理出发，使用以下基础：\n- 无体力情况下的静力平衡纳维方程：$\\mu \\nabla^2 \\mathbf{u} + (\\lambda + \\mu) \\nabla (\\nabla \\cdot \\mathbf{u}) = \\mathbf{0}$，其中 $\\mathbf{u}$ 是位移场。\n- 在 $z=0$ 上的牵引-位移边界条件。\n- 平行于表面的平移不变性，这使得可以在平面 $z=0$ 上进行二维傅里叶分析。\n- 通过格林核在空间域中解的卷积表示，及其在谱域中的等效乘法形式。\n- 作为奇异核正则化工具的柔化子（mollifier）概念，具体为归一化高斯函数。\n\n您的任务：\n1. 从上述基础出发，推导将法向牵引 $t_z(x,y)$ 的二维傅里叶变换映射到产生的表面法向位移 $w(x,y)$ 的二维傅里叶变换的谱关系。用波数大小 $k = \\sqrt{k_x^2 + k_y^2}$ 和接触模量 $E^\\star = E/(1-\\nu^2)$ 来表示该关系。解释为何会出现一个与 $1/k$ 成正比的非局域柔度。\n2. 使用逆变换获得相应的空间域卷积定律，用于计算 $w(x,y)$，其标量核仅依赖于平面内距离 $r = \\sqrt{x^2 + y^2}$。解释 $1/r$ 奇异性的来源。\n3. 通过将总力为 $P$ 的点载荷建模为标准差为 $\\varepsilon$ 的归一化高斯柔化子 $\\rho_\\varepsilon(x,y)$ 来引入正则化，使得 $t_z(x,y) = P \\rho_\\varepsilon(x,y)$ 且 $\\int_{\\mathbb{R}^2} \\rho_\\varepsilon \\, \\mathrm{d}x \\mathrm{d}y = 1$。推导在载荷中心处的正则化自位移 $w(\\mathbf{0})$ 作为 $P$、$E^\\star$ 和 $\\varepsilon$ 的函数的解析表达式。说明当 $\\varepsilon \\to 0^+$ 时的收敛行为。\n4. 对于施加在以原点为中心、半径为 $a$ 的圆形区域上的均匀压力 $p$，使用步骤2中的空间卷积定律推导中心位移 $w(\\mathbf{0})$ 的精确表达式。\n5. 设计并实现一个数值算法，使用二维离散傅里叶变换在边长为 $L$ 的方形周期性计算单元上计算 $w(x,y)$，该单元在 $N \\times N$ 网格上离散，网格间距为 $\\Delta x = L/N$。对法向载荷使用步骤1中的谱柔度，并将零波数项设为零以消除由周期性延拓产生的非物理刚体模式。讨论周期性镜像和截断对精度的影响，以及正则化的作用。您的实现必须：\n   - 在网格上构造下述指定的牵引场，以 $(x,y)=(0,0)$ 为中心。\n   - 对于高斯载荷，重新缩放离散牵引，使得离散总力高精度地等于指定的 $P$。\n   - 计算 $w(\\mathbf{0})$ 的数值近似值。\n   - 与相应的解析表达式进行比较，并报告相对误差。\n\n物理单位：所有长度单位为米，牵引单位为帕斯卡，力单位为牛顿，位移单位为米。无需使用角度。要求的输出是无量纲的相对误差。\n\n测试套件和要求的输出：\n- 使用材料参数 $E = 70 \\times 10^9$ Pa 和 $\\nu = 0.25$，因此 $E^\\star = E/(1-\\nu^2)$。\n- 使用边长 $L = 1.0$ m 的方形计算单元，每个方向有 $N = 512$ 个网格点。\n- 定义三个测试用例：\n  1. 总力为 $P = 1000$ N、标准差为 $\\varepsilon = 0.020$ m 的高斯正则化点载荷。计算数值解 $w(\\mathbf{0})$ 与步骤3中推导的解析表达式之间的相对误差。\n  2. 在以原点为中心、半径为 $a = 0.040$ m 的圆形区域上施加均匀压力 $p = 2.0 \\times 10^6$ Pa。计算数值解 $w(\\mathbf{0})$ 与步骤4中推导的解析表达式之间的相对误差。\n  3. 总力为 $P = 1000$ N、标准差为 $\\varepsilon = 0.005$ m 的高斯正则化点载荷。计算数值解 $w(\\mathbf{0})$ 与步骤3中推导的解析表达式之间的相对误差。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按三个测试用例的顺序排列结果：$[\\text{err}_1,\\text{err}_2,\\text{err}_3]$，其中每个 $\\text{err}_i$ 是定义为 $\\lvert w_{\\text{num}} - w_{\\text{an}} \\rvert / \\lvert w_{\\text{an}} \\rvert$ 的相对误差，并表示为浮点数。", "solution": "该问题陈述是线弹性力学和计算力学领域中一个适定且科学上合理的问题，具体涉及弹性半空间的 Boussinesq 问题。按照问题中列出的任务，可以按如下方式求解。\n\n首先，我们定义将要使用的材料参数和常数。弹性半空间的特征是杨氏模量 $E$ 和泊松比 $\\nu$。拉梅参数通过 $\\mu = E / (2(1+\\nu))$ 和 $\\lambda = E\\nu / ((1+\\nu)(1-2\\nu))$ 关联。接触模量，或称平面应变模量，定义为 $E^\\star = E / (1-\\nu^2)$。\n\n### 1. 谱关系的推导\n\n我们从无体力情况下的静力平衡纳维方程开始：\n$$ \\mu \\nabla^2 \\mathbf{u} + (\\lambda + \\mu) \\nabla (\\nabla \\cdot \\mathbf{u}) = \\mathbf{0} $$\n其中 $\\mathbf{u}(\\mathbf{x}, z)$ 是位移场。我们在空间坐标 $(x,y)$ 上应用二维傅里叶变换。函数 $f(x,y)$ 的变换表示为 $\\hat{f}(k_x, k_y)$：\n$$ \\hat{f}(\\mathbf{k}) = \\int_{\\mathbb{R}^2} f(\\mathbf{x}) e^{-i\\mathbf{k}\\cdot\\mathbf{x}} d^2\\mathbf{x} $$\n其中 $\\mathbf{x}=(x,y)$ 且 $\\mathbf{k}=(k_x, k_y)$。算子变换为 $\\nabla \\to (i k_x, i k_y, \\partial_z)$ 和 $\\nabla^2 \\to (-k^2 + \\partial_z^2)$，其中 $k = \\sqrt{k_x^2+k_y^2}$ 是波数大小。这将偏微分方程组（PDE）转化为一个关于 $z$ 的、针对变换后位移分量 $\\hat{\\mathbf{u}}(\\mathbf{k}, z)$ 的常微分方程组（ODE）。\n\n当 $z \\to \\infty$ 时衰减的这些ODE的通解可以表示为以下形式：\n$$ \\hat{u}_j(\\mathbf{k}, z) = (A_j + z B_j) e^{-kz} $$\n将其代入变换后的纳维方程，可以得到关于系数 $A_j$ 和 $B_j$ 的代数约束。一个更便捷的方法是使用弹性理论中的已知结果。在法向载荷下，变换后位移的解由下式给出：\n$$ \\hat{u}_x(\\mathbf{k}, z) = C(\\mathbf{k}) (1-2\\nu - kz) e^{-kz} \\frac{ik_x}{k} $$\n$$ \\hat{u}_y(\\mathbf{k}, z) = C(\\mathbf{k}) (1-2\\nu - kz) e^{-kz} \\frac{ik_y}{k} $$\n$$ \\hat{u}_z(\\mathbf{k}, z) = C(\\mathbf{k}) (2(1-\\nu) + kz) e^{-kz} $$\n系数 $C(\\mathbf{k})$ 由表面 $z=0$ 处的边界条件确定。边界条件是切向牵引为零（$\\sigma_{xz}=\\sigma_{yz}=0$）和指定的法向牵引 $\\sigma_{zz}(x,y,0) = t_z(x,y)$。相关的应力分量是 $\\sigma_{zz}$，根据胡克定律，其位移表达式为：\n$$ \\sigma_{zz} = \\lambda(\\partial_x u_x + \\partial_y u_y + \\partial_z u_z) + 2\\mu \\partial_z u_z $$\n应用傅里叶变换得到：\n$$ \\hat{\\sigma}_{zz}(\\mathbf{k},z) = \\lambda(ik_x \\hat{u}_x + ik_y \\hat{u}_y + \\partial_z \\hat{u}_z) + 2\\mu \\partial_z \\hat{u}_z $$\n我们在 $z=0$ 处使用 $\\hat{u}_j$ 的表达式来计算该值。其导数为：\n$$ \\partial_z \\hat{u}_z |_{z=0} = C(\\mathbf{k})(-k(2(1-\\nu)) + k) = C(\\mathbf{k})k(1-2(1-\\nu)) = -C(\\mathbf{k})k(1-2\\nu) $$\n平面内位移的散度为：\n$$ ik_x \\hat{u}_x + ik_y \\hat{u}_y |_{z=0} = C(\\mathbf{k}) (1-2\\nu) \\frac{i^2(k_x^2+k_y^2)}{k} = -C(\\mathbf{k})k(1-2\\nu) $$\n将这些代入 $z=0$ 处的 $\\hat{\\sigma}_{zz}$ 表达式中：\n$$ \\hat{t}_z(\\mathbf{k}) = \\hat{\\sigma}_{zz}(\\mathbf{k},0) = \\lambda(-C(\\mathbf{k})k(1-2\\nu)) + (\\lambda+2\\mu)(-C(\\mathbf{k})k(1-2\\nu)) = -2(\\lambda+\\mu)C(\\mathbf{k})k(1-2\\nu) $$\n使用关系式 $\\lambda+\\mu=\\mu/(1-2\\nu)$，可简化为：\n$$ \\hat{t}_z(\\mathbf{k}) = -2\\mu C(\\mathbf{k}) k $$\n因此，我们可以解出 $C(\\mathbf{k}) = -\\frac{\\hat{t}_z(\\mathbf{k})}{2\\mu k}$。\n表面法向位移是 $w(x,y) = u_z(x,y,0)$，所以其变换是 $\\hat{w}(\\mathbf{k}) = \\hat{u}_z(\\mathbf{k},0)$。从通解中得到：\n$$ \\hat{w}(\\mathbf{k}) = C(\\mathbf{k}) \\cdot 2(1-\\nu) = -\\frac{\\hat{t}_z(\\mathbf{k})}{2\\mu k} \\cdot 2(1-\\nu) = -\\frac{1-\\nu}{\\mu} \\frac{\\hat{t}_z(\\mathbf{k})}{-k} $$\n在经典文献的表述中存在一个符号错误。一个向下的力 $P$（负牵引）应导致一个向下的位移 $w$（负值）。我们将 $t_z$ 定义为压力（向下为正）。表面法线朝上，因此 $\\sigma_{zz} = -t_z$。\n于是 $\\hat{\\sigma}_{zz}(\\mathbf{k},0) = -\\hat{t}_z(\\mathbf{k})$，所以 $C(\\mathbf{k}) = \\frac{\\hat{t}_z(\\mathbf{k})}{2\\mu k}$。\n这给出 $\\hat{w}(\\mathbf{k}) = \\frac{1-\\nu}{\\mu} \\frac{\\hat{t}_z(\\mathbf{k})}{k}$。这是在 $+z$ 方向上的压力 $t_z$ 引起的 $+z$ 方向上的位移。让我们假设采用标准加载约定（压力 $p$ 向下作用，位移 $w$ 向下为正）。关系式为：\n$$ \\hat{w}(\\mathbf{k}) = \\frac{1-\\nu}{\\mu} \\frac{\\hat{p}(\\mathbf{k})}{k} $$\n使用 $\\mu = E/(2(1+\\nu))$ 和 $E^\\star = E/(1-\\nu^2)$:\n$$ \\frac{1-\\nu}{\\mu} = \\frac{(1-\\nu) \\cdot 2(1+\\nu)}{E} = \\frac{2(1-\\nu^2)}{E} = \\frac{2}{E/(1-\\nu^2)} = \\frac{2}{E^\\star} $$\n最终的谱关系是：\n$$ \\hat{w}(\\mathbf{k}) = \\frac{2}{E^\\star k} \\hat{p}(\\mathbf{k}) $$\n该关系在频域中表示一个线性滤波器。在给定波数 $k$ 下的位移响应与该波数下的牵引成正比。比例因子 $\\hat{G}(k) = 2/(E^\\star k)$ 是谱柔度或谱格林函数。$1/k$ 的出现表明该问题由一个椭圆型偏微分方程控制，其格林函数是非局域的。在空间域中，这对应于长程相互作用。对于小 $k$（长波长），柔度较大，表明半空间对大尺度载荷是柔顺的；而对于大 $k$（短波长），柔度较小，表明其对高度局部化的载荷是刚性的。\n\n### 2. 空间域卷积定律\n\n根据卷积定理，频域中的关系 $\\hat{w}(\\mathbf{k}) = \\hat{G}(\\mathbf{k}) \\hat{p}(\\mathbf{k})$ 对应于空间域中的卷积：\n$$ w(\\mathbf{x}) = (G * p)(\\mathbf{x}) = \\int_{\\mathbb{R}^2} G(\\mathbf{x}-\\mathbf{x'}) p(\\mathbf{x'}) d^2\\mathbf{x'} $$\n空间格林函数 $G(\\mathbf{x})$ 是 $\\hat{G}(\\mathbf{k})$ 的傅里叶逆变换：\n$$ G(\\mathbf{x}) = \\mathcal{F}^{-1}\\{\\hat{G}(\\mathbf{k})\\} = \\frac{1}{(2\\pi)^2} \\int_{\\mathbb{R}^2} \\frac{2}{E^\\star k} e^{i\\mathbf{k}\\cdot\\mathbf{x}} d^2\\mathbf{k} $$\n由于旋转对称性，$G$ 只依赖于模长 $r=|\\mathbf{x}|$。我们将积分转换为k平面中的极坐标（$k_x = k\\cos\\phi, k_y = k\\sin\\phi$），并将x轴与 $\\mathbf{x}$ 对齐，使得 $\\mathbf{k}\\cdot\\mathbf{x} = kr\\cos\\phi$：\n$$ G(r) = \\frac{2}{(2\\pi)^2 E^\\star} \\int_0^\\infty \\int_0^{2\\pi} \\frac{1}{k} e^{ikr\\cos\\phi} k d\\phi dk = \\frac{2}{4\\pi^2 E^\\star} \\int_0^\\infty \\left( \\int_0^{2\\pi} e^{ikr\\cos\\phi} d\\phi \\right) dk $$\n内部积分是第一类零阶贝塞尔函数的一个标准表示：$\\int_0^{2\\pi} e^{iz\\cos\\phi} d\\phi = 2\\pi J_0(z)$。\n$$ G(r) = \\frac{2 \\cdot 2\\pi}{4\\pi^2 E^\\star} \\int_0^\\infty J_0(kr) dk = \\frac{1}{\\pi E^\\star} \\int_0^\\infty J_0(kr) dk $$\n使用恒等式 $\\int_0^\\infty J_0(u)du=1$ 并代换 $u=kr$, $du=r dk$：\n$$ G(r) = \\frac{1}{\\pi E^\\star r} \\int_0^\\infty J_0(u) du = \\frac{1}{\\pi E^\\star r} $$\n这就是著名的 Boussinesq 核。卷积定律为：\n$$ w(\\mathbf{x}) = \\frac{1}{\\pi E^\\star} \\int_{\\mathbb{R}^2} \\frac{p(\\mathbf{x'})}{|\\mathbf{x}-\\mathbf{x'}|} d^2\\mathbf{x'} $$\n$1/r$ 奇异性源于核在频域中的 $1/k$ 行为。在物理上，这对应于对点载荷的响应。在原点处的集中力 $P$ 对应于狄拉克δ函数压力 $p(\\mathbf{x}) = P\\delta(\\mathbf{x})$，产生无限大的位移 $w(0)$，这反映了点载荷下无限大应力的非物理性质。\n\n### 3. 正则化点载荷位移\n\n我们用一个正则化的、归一化的高斯压力分布来模拟点载荷 $P$：\n$$ p(x,y) = P \\rho_\\varepsilon(x,y) = \\frac{P}{2\\pi\\varepsilon^2} e^{-(x^2+y^2)/(2\\varepsilon^2)} $$\n其中 $\\varepsilon$ 是正则化长度尺度。我们可以使用空间域或谱域表示来计算中心位移 $w(\\mathbf{0})$。谱方法更直接。首先，我们求压力的傅里叶变换：\n$$ \\hat{p}(\\mathbf{k}) = \\mathcal{F}\\left\\{ \\frac{P}{2\\pi\\varepsilon^2} e^{-r^2/(2\\varepsilon^2)} \\right\\} = P \\cdot \\mathcal{F}\\left\\{ \\frac{1}{2\\pi\\varepsilon^2} e^{-r^2/(2\\varepsilon^2)} \\right\\} = P e^{-k^2\\varepsilon^2/2} $$\n位移的变换是 $\\hat{w}(\\mathbf{k}) = \\hat{G}(k) \\hat{p}(\\mathbf{k}) = \\frac{2 P}{E^\\star k} e^{-k^2\\varepsilon^2/2}$。\n为了求 $w(\\mathbf{0})$，我们在 $\\mathbf{x}=\\mathbf{0}$ 处计算傅里叶逆变换：\n$$ w(\\mathbf{0}) = \\frac{1}{(2\\pi)^2} \\int_{\\mathbb{R}^2} \\hat{w}(\\mathbf{k}) d^2\\mathbf{k} = \\frac{1}{4\\pi^2} \\int_0^{2\\pi} \\int_0^\\infty \\left( \\frac{2P}{E^\\star k} e^{-k^2\\varepsilon^2/2} \\right) k dk d\\phi $$\n$$ w(\\mathbf{0}) = \\frac{2\\pi \\cdot 2P}{4\\pi^2 E^\\star} \\int_0^\\infty e^{-k^2\\varepsilon^2/2} dk = \\frac{P}{\\pi E^\\star} \\int_0^\\infty e^{-k^2\\varepsilon^2/2} dk $$\n这是一个标准高斯积分：$\\int_0^\\infty e^{-a u^2} du = \\frac{1}{2}\\sqrt{\\frac{\\pi}{a}}$。这里，$a = \\varepsilon^2/2$。\n$$ \\int_0^\\infty e^{-k^2\\varepsilon^2/2} dk = \\frac{1}{2} \\sqrt{\\frac{\\pi}{\\varepsilon^2/2}} = \\frac{\\sqrt{2\\pi}}{2\\varepsilon} $$\n代入这个结果，得到中心位移：\n$$ w(\\mathbf{0}) = \\frac{P}{\\pi E^\\star} \\frac{\\sqrt{2\\pi}}{2\\varepsilon} = \\frac{P}{\\sqrt{2\\pi} E^\\star \\varepsilon} $$\n当正则化参数 $\\varepsilon \\to 0^+$ 时，$1/\\varepsilon \\to \\infty$，因此 $w(\\mathbf{0}) \\to \\infty$。这正确地恢复了理想点载荷的奇异行为。\n\n### 4. 圆形区域上的均匀压力\n\n对于施加在半径为 $a$ 的圆形区域上的均匀压力 $p$，压力分布为 $r \\le a$ 时 $p(r) = p$，$r > a$ 时 $p(r) = 0$。我们使用步骤2中推导的空间卷积定律计算中心位移 $w(\\mathbf{0})$：\n$$ w(\\mathbf{0}) = \\int_{\\mathbb{R}^2} G(\\mathbf{0}-\\mathbf{x'})p(\\mathbf{x'}) d\\mathbf{x'} = \\int_{|\\mathbf{x'}| \\le a} \\frac{1}{\\pi E^\\star |\\mathbf{x'}|} p \\, d\\mathbf{x'} $$\n我们对积分变量 $\\mathbf{x'} = (r', \\theta')$ 使用极坐标，其中 $d\\mathbf{x'} = r'dr'd\\theta'$：\n$$ w(\\mathbf{0}) = \\frac{p}{\\pi E^\\star} \\int_0^{2\\pi} \\int_0^a \\frac{1}{r'} r' dr' d\\theta' = \\frac{p}{\\pi E^\\star} \\int_0^{2\\pi} \\left( \\int_0^a dr' \\right) d\\theta' $$\n$$ w(\\mathbf{0}) = \\frac{p}{\\pi E^\\star} \\int_0^{2\\pi} a \\, d\\theta' = \\frac{p a}{\\pi E^\\star} [ \\theta' ]_0^{2\\pi} = \\frac{p a}{\\pi E^\\star} (2\\pi) $$\n中心位移的精确表达式是：\n$$ w(\\mathbf{0}) = \\frac{2pa}{E^\\star} $$\n\n### 5. 数值算法与实现\n\n该数值方法使用二维快速傅里叶变换（FFT）通过在谱域中进行乘法来实现卷积。\n\n**算法：**\n1.  **离散化**：在 $N \\times N$ 网格上定义边长为 $L$ 的正方形域。网格间距为 $\\Delta x = L/N$。我们使用中心化坐标网格 $x_i, y_j \\in [-L/2, L/2)$。\n2.  **频率网格**：使用 `np.fft.fftfreq` 构建相应的二维频率网格 $(k_x, k_y)$。波数为 $k_{m} = 2\\pi m/L$，其中 $m \\in \\{-N/2, \\dots, N/2-1\\}$。计算波数大小 $k = \\sqrt{k_x^2 + k_y^2}$。\n3.  **谱核**：构建离散谱格林函数 $\\hat{G}(k_x, k_y) = 2 / (E^\\star k)$。在零波数点 $(k_x, k_y) = (0,0)$ 处，$k=0$，核是奇异的。这对应于半空间的刚体平移，这在物理上是任意的。我们将 $\\hat{G}(0,0) = 0$ 设为0以移除此模式，这等效于约束平均位移为零。\n4.  **牵引场**：对于每个测试用例，在空间网格上构建压力分布 $p(x_i, y_j)$。对于高斯载荷，确保离散总力 $\\sum p_{ij} \\Delta x^2$ 等于指定的力 $P$。\n5.  **FFT 卷积**：\n    a. 计算压力网格的二维FFT：$\\hat{p} = \\text{fft2}(p)$。\n    b. 在频域中逐元素相乘：$\\hat{w} = \\hat{p} \\cdot \\hat{G}$。\n    c. 计算二维逆FFT以获得位移场：$w = \\text{ifft2}(\\hat{w})$。由于数值精度问题，结果是复数，因此我们取其实部。\n6.  **比较**：提取网格中心的数值位移 $w_{\\text{num}}(\\mathbf{0})$，并与步骤3和4中推导的解析解 $w_{\\text{an}}(\\mathbf{0})$ 进行比较，以计算相对误差。\n\n**影响讨论：**\n-   **周期性镜像**：FFT 假设周期性边界条件。这意味着我们的计算模型是一个由间距为 $L$ 的相同载荷组成的无限晶格。任何一点的计算位移都包含了所有这些“周期性镜像”的贡献。与真实的孤立载荷问题相比，这导致位移的过高估计。误差的量级为 $1/L$，随着域尺寸 $L$ 相对于载荷尺寸的增加而减小。\n-   **截断/混叠**：有限网格 ($N$) 施加了可表示的最大波数（奈奎斯特频率，$k_{Nyq} = \\pi/\\Delta x$）。真实信号中高于此频率的频率会“混叠”到较低的频率上，从而引入误差。如果压力的傅里叶变换 $\\hat{p}(k)$ 在 $k_{Nyq}$ 之外有大量能量，则此误差会很显著。对于光滑的高斯压力，$\\hat{p}(k)$ 衰减非常快，因此如果 $\\varepsilon > \\Delta x$，此误差很小。对于边缘锐利的圆形压力，$\\hat{p}(k)$ 衰减较慢（$k^{-3/2}$），因此混叠误差通常更大。\n-   **正则化**：高斯情况下的柔化子参数 $\\varepsilon$ 确保载荷是光滑的并且其频谱是带限的，这对于基于FFT的方法的准确性至关重要。为使数值方案能准确解析载荷，$\\varepsilon$ 应大于网格间距 $\\Delta x$。当 $\\varepsilon$ 接近 $\\Delta x$ 时，高斯函数的离散表示变差，从而增加误差。\n\n实现此算法的 Python 代码在最终答案中提供。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Boussinesq problem for a half-space under different normal traction\n    distributions using a 2D FFT-based spectral method and compares the numerical\n    results to analytical solutions.\n    \"\"\"\n    # Physical and computational parameters\n    E = 70.0e9  # Young's modulus in Pa\n    nu = 0.25    # Poisson's ratio\n    L = 1.0      # Side length of the computational cell in m\n    N = 512      # Number of grid points in each direction\n\n    # Derived parameters\n    E_star = E / (1.0 - nu**2)\n    dx = L / N\n\n    # 1. Construct frequency grid\n    k_freq = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n    kx, ky = np.meshgrid(k_freq, k_freq)\n    k_mag = np.sqrt(kx**2 + ky**2)\n\n    # 2. Construct spectral Green's function (compliance)\n    # G_hat(k) = 2 / (E_star * k)\n    G_hat = np.zeros_like(k_mag, dtype=float)\n    # Avoid division by zero at k=0\n    non_zero_k = k_mag != 0\n    G_hat[non_zero_k] = 2.0 / (E_star * k_mag[non_zero_k])\n    # The k=0 term (rigid body mode) is explicitly set to 0.\n\n    # 3. Construct spatial grid, centered at (0,0)\n    x_coords = np.arange(-N/2, N/2) * dx\n    xx, yy = np.meshgrid(x_coords, x_coords)\n    \n    test_cases = [\n        {'type': 'gaussian', 'P': 1000.0, 'eps': 0.020},\n        {'type': 'circular', 'p': 2.0e6, 'a': 0.040},\n        {'type': 'gaussian', 'P': 1000.0, 'eps': 0.005},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # 4. Construct traction field on the grid\n        if case['type'] == 'gaussian':\n            P = case['P']\n            eps = case['eps']\n            \n            # Analytic solution for centered displacement\n            w_an = P / (np.sqrt(2 * np.pi) * E_star * eps)\n            \n            # Define unscaled Gaussian traction\n            tz_unscaled = np.exp(-(xx**2 + yy**2) / (2 * eps**2))\n            \n            # Rescale to ensure discrete total force is P\n            # Discrete sum approximates integral: sum(f_i * dA)\n            discrete_total_force = np.sum(tz_unscaled) * dx**2\n            scaling_factor = P / discrete_total_force\n            tz_grid = tz_unscaled * scaling_factor\n            \n        elif case['type'] == 'circular':\n            p = case['p']\n            a = case['a']\n            \n            # Analytic solution for centered displacement\n            w_an = (2 * p * a) / E_star\n            \n            # Define uniform pressure over a circular area\n            r = np.sqrt(xx**2 + yy**2)\n            tz_grid = np.zeros_like(r)\n            tz_grid[r <= a] = p\n        \n        # 5. Perform FFT-based convolution\n        # a. FFT of the traction field\n        Tz_hat = np.fft.fft2(tz_grid)\n        \n        # b. Multiply by spectral Green's function\n        W_hat = Tz_hat * G_hat\n        \n        # c. Inverse FFT to get displacement field\n        w_grid = np.fft.ifft2(W_hat)\n        \n        # The output from iFFT should be real, except for small numerical noise.\n        # The grid is constructed such that the origin (0,0) corresponds to\n        # the indices (N/2, N/2).\n        w_num_center = np.real(w_grid[N//2, N//2])\n        \n        # 6. Compute relative error\n        relative_error = np.abs(w_num_center - w_an) / np.abs(w_an)\n        results.append(relative_error)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"}]}