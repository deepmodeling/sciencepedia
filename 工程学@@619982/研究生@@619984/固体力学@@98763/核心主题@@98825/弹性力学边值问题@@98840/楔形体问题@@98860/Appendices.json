{"hands_on_practices": [{"introduction": "对特征函数的分析是理解应力奇点的基础。本练习专注于反平面剪切情况，该问题可简化为拉普拉斯方程，从而可以直接推导特征函数。通过计算与每个特征模态相关的应变能，您将深入、定量地理解不同模态如何影响近顶点场，以及在接近顶点时主导奇点项如何起作用 [@problem_id:2711185]。", "problem": "考虑一个各向同性、均匀的线弹性固体，该固体占据一个二维楔形域。在极坐标系中，该域的顶点在原点，由角度 $\\theta \\in (-\\alpha,\\alpha)$ 和半径 $r>0$ 定义，其中 $\\alpha \\in (0,\\pi)$ 以弧度为单位给出。假设为反平面剪切（III型），因此唯一的非零位移分量是面外位移 $w(r,\\theta)$，它在没有体力的情况下满足拉普拉斯方程。位于 $\\theta=\\pm \\alpha$ 的楔形侧面是无牵引力的。每单位厚度的应变能密度为 $(\\mu/2)\\,|\\nabla w|^{2}$，其中 $\\mu$ 是剪切模量，在扇形区域 $\\{0<r<R,\\,-\\alpha<\\theta<\\alpha\\}$ 内的总应变能为\n$$\nE(R)=\\frac{\\mu}{2}\\int_{0}^{R}\\int_{-\\alpha}^{\\alpha}\\left[\\left(\\frac{\\partial w}{\\partial r}\\right)^{2}+\\frac{1}{r^{2}}\\left(\\frac{\\partial w}{\\partial \\theta}\\right)^{2}\\right]\\,r\\,\\mathrm{d}\\theta\\,\\mathrm{d}r.\n$$\n仅从控制方程和边界条件出发，完成以下任务：\n\n(a) 推导所有形式为 $w(r,\\theta)=r^{\\lambda} f(\\theta)$ 的容许分离变量本征函数，这些函数需满足楔形侧面上的无牵引力边界条件。量化振幅为 $c$ 的单个此类本征函数对 $E(R)$ 的贡献，并用 $\\mu$、$\\alpha$、$\\lambda$、$c$ 和 $R$ 以闭合形式表示。\n\n(b) 利用在 $\\theta \\in (-\\alpha,\\alpha)$ 上的正交性，证明来自不同容许本征函数的能量贡献在 $E(R)$ 中相加而无交叉项，并推导出当 $R\\to 0$ 时每项贡献随 $R$ 变化的标度关系。\n\n(c) 假设在顶点附近，场由两个最低阶的非平凡容许项主导，即\n$$\nw(r,\\theta)=a_{1}\\,r^{\\pi/\\alpha}\\cos\\!\\left(\\frac{\\pi}{\\alpha}\\theta\\right)+b_{0}\\,r^{\\pi/(2\\alpha)}\\sin\\!\\left(\\frac{\\pi}{2\\alpha}\\theta\\right)+\\text{更高阶项},\n$$\n其中 $b_{0}\\neq 0$ 且 $a_{1}$ 任意，而对于当 $R\\to 0$ 时的前导阶能量，所有更高阶的振幅均可忽略。确定当 $R\\to 0$ 时对 $E(R)$ 的主导贡献，并以 $\\mu$、$\\alpha$、$b_{0}$ 和 $R$ 的闭合形式提供 $E(R)$ 的前导阶表达式。\n\n将最终能量以焦耳/单位厚度表示。提供你的最终答案，形式为单一的精确解析表达式（无近似，不四舍五入）。", "solution": "该问题是有效的。这是一个固体力学领域中的适定问题，具体涉及反平面剪切的线性弹性断裂力学。其控制方程、边界条件和物理量均为标准形式且表述正确。该问题是自洽的，没有科学或逻辑上的不一致。\n\n(a) 本征函数的推导和能量贡献。\n\n在无体力情况下的反平面剪切中，面外位移 $w(r, \\theta)$ 满足极坐标系下的拉普拉斯方程：\n$$ \\nabla^{2}w = \\frac{\\partial^{2} w}{\\partial r^{2}} + \\frac{1}{r} \\frac{\\partial w}{\\partial r} + \\frac{1}{r^{2}} \\frac{\\partial^{2} w}{\\partial \\theta^{2}} = 0 $$\n我们寻找形式为 $w(r, \\theta) = r^{\\lambda}f(\\theta)$ 的分离变量解。将此形式代入拉普拉斯方程，得到：\n$$ \\lambda(\\lambda-1)r^{\\lambda-2}f(\\theta) + \\frac{1}{r}\\lambda r^{\\lambda-1}f(\\theta) + \\frac{1}{r^{2}}r^{\\lambda}f''(\\theta) = 0 $$\n$$ r^{\\lambda-2}[\\lambda(\\lambda-1)f(\\theta) + \\lambda f(\\theta) + f''(\\theta)] = 0 $$\n为使此式对 $r > 0$ 成立，方括号中的表达式必须为零，这给出了一个关于 $f(\\theta)$ 的常微分方程：\n$$ f''(\\theta) + \\lambda^{2}f(\\theta) = 0 $$\n$f(\\theta)$ 的通解是 $f(\\theta) = A\\cos(\\lambda\\theta) + B\\sin(\\lambda\\theta)$，其中 $A$ 和 $B$ 是常数。\n\n边界条件是位于 $\\theta = \\pm \\alpha$ 的楔形侧面是无牵引力的。对于反平面剪切，唯一的非零应力分量是 $\\sigma_{rz} = \\mu \\frac{\\partial w}{\\partial r}$ 和 $\\sigma_{\\theta z} = \\frac{\\mu}{r} \\frac{\\partial w}{\\partial \\theta}$。在 $\\theta$ 为常数的表面上，牵引力矢量仅在 $z$ 方向有非零分量，由 $t_z = \\sigma_{\\theta z}$ 给出。因此，无牵引力条件是在 $\\theta = \\pm\\alpha$ 处 $\\sigma_{\\theta z} = 0$。\n$$ \\frac{\\mu}{r}\\frac{\\partial w}{\\partial \\theta}\\bigg|_{\\theta=\\pm\\alpha} = 0 \\implies \\frac{\\partial w}{\\partial \\theta}\\bigg|_{\\theta=\\pm\\alpha} = 0 $$\n代入 $w(r, \\theta) = r^{\\lambda}f(\\theta)$，我们得到 $r^{\\lambda}f'(\\theta)|_{\\theta=\\pm\\alpha} = 0$，这意味着 $f'(\\pm\\alpha) = 0$。\n$f(\\theta)$ 的导数是 $f'(\\theta) = -\\lambda A\\sin(\\lambda\\theta) + \\lambda B\\cos(\\lambda\\theta)$。应用边界条件：\n$$ f'(\\alpha) = -\\lambda A\\sin(\\lambda\\alpha) + \\lambda B\\cos(\\lambda\\alpha) = 0 $$\n$$ f'(-\\alpha) = -\\lambda A\\sin(-\\lambda\\alpha) + \\lambda B\\cos(-\\lambda\\alpha) = \\lambda A\\sin(\\lambda\\alpha) + \\lambda B\\cos(\\lambda\\alpha) = 0 $$\n将这两个方程相加得到 $2\\lambda B\\cos(\\lambda\\alpha) = 0$。用第一个方程减去第二个方程得到 $-2\\lambda A\\sin(\\lambda\\alpha) = 0$。\n假设 $\\lambda \\neq 0$（因为 $\\lambda=0$ 给出平凡的常数位移），我们得到两族非平凡解：\n1.  对称模态：$B=0$ 且 $\\sin(\\lambda\\alpha) = 0$。这要求 $\\lambda\\alpha = n\\pi$，其中 $n$ 为整数。本征函数的形式为 $f(\\theta) = \\cos(\\frac{n\\pi}{\\alpha}\\theta)$。容许性要求在任何包含尖端的区域内能量有限，这意味着 $\\lambda > 0$，所以 $n \\ge 1$。\n2.  反对称模态：$A=0$ 且 $\\cos(\\lambda\\alpha) = 0$。这要求 $\\lambda\\alpha = (n - \\frac{1}{2})\\pi$，其中 $n$ 为整数。本征函数的形式为 $f(\\theta) = \\sin(\\frac{(n - 1/2)\\pi}{\\alpha}\\theta)$。同样，为了使 $\\lambda > 0$，必须有 $n \\ge 1$。\n\n现在，我们计算单个本征函数 $w(r, \\theta) = c r^{\\lambda}f(\\theta)$ 对总应变能 $E(R)$ 的贡献。这里，$f(\\theta)$ 代表三角函数部分（例如 $\\cos(\\lambda\\theta)$），$c$ 是振幅。\n$$ E(R) = \\frac{\\mu}{2}\\int_{0}^{R}\\int_{-\\alpha}^{\\alpha}\\left[\\left(\\frac{\\partial w}{\\partial r}\\right)^{2}+\\frac{1}{r^{2}}\\left(\\frac{\\partial w}{\\partial \\theta}\\right)^{2}\\right]\\,r\\,\\mathrm{d}\\theta\\,\\mathrm{d}r $$\n导数为 $\\frac{\\partial w}{\\partial r} = c\\lambda r^{\\lambda-1}f(\\theta)$ 和 $\\frac{\\partial w}{\\partial \\theta} = c r^{\\lambda}f'(\\theta)$。\n$$ E(R) = \\frac{\\mu c^{2}}{2}\\int_{0}^{R}\\int_{-\\alpha}^{\\alpha}\\left[\\lambda^{2}r^{2\\lambda-2}f(\\theta)^{2} + \\frac{1}{r^{2}}r^{2\\lambda}f'(\\theta)^{2}\\right]\\,r\\,\\mathrm{d}\\theta\\,\\mathrm{d}r $$\n$$ E(R) = \\frac{\\mu c^{2}}{2}\\left(\\int_{0}^{R} r^{2\\lambda-1}\\,\\mathrm{d}r\\right)\\left(\\int_{-\\alpha}^{\\alpha} [\\lambda^{2}f(\\theta)^{2} + f'(\\theta)^{2}]\\,\\mathrm{d}\\theta\\right) $$\n当 $\\lambda > 0$ 时，径向积分为 $\\int_{0}^{R} r^{2\\lambda-1}\\,\\mathrm{d}r = \\frac{R^{2\\lambda}}{2\\lambda}$。\n对于角向积分，我们对第二项使用分部积分法：\n$$ \\int_{-\\alpha}^{\\alpha}f'(\\theta)^{2}\\,\\mathrm{d}\\theta = [f(\\theta)f'(\\theta)]_{-\\alpha}^{\\alpha} - \\int_{-\\alpha}^{\\alpha} f(\\theta)f''(\\theta)\\,\\mathrm{d}\\theta $$\n由于 $f'(\\pm\\alpha)=0$，边界项消失。使用 $f''(\\theta)=-\\lambda^{2}f(\\theta)$，积分变为 $\\lambda^{2}\\int_{-\\alpha}^{\\alpha}f(\\theta)^{2}\\,\\mathrm{d}\\theta$。\n所以角向积分为 $\\int_{-\\alpha}^{\\alpha} [\\lambda^{2}f(\\theta)^{2} + \\lambda^{2}f(\\theta)^{2}]\\,\\mathrm{d}\\theta = 2\\lambda^{2}\\int_{-\\alpha}^{\\alpha}f(\\theta)^{2}\\,\\mathrm{d}\\theta$。\n对于两族解，$\\int_{-\\alpha}^{\\alpha} \\cos^{2}(\\lambda\\theta)\\,\\mathrm{d}\\theta = \\alpha$ 和 $\\int_{-\\alpha}^{\\alpha} \\sin^{2}(\\lambda\\theta)\\,\\mathrm{d}\\theta = \\alpha$，因为对 $\\lambda$ 的条件使得被积函数的振荡部分在积分限处为零。例如，$\\int_{-\\alpha}^{\\alpha}\\cos^{2}(\\lambda\\theta)\\,\\mathrm{d}\\theta = [\\frac{\\theta}{2} + \\frac{\\sin(2\\lambda\\theta)}{4\\lambda}]_{-\\alpha}^{\\alpha} = \\alpha + \\frac{\\sin(2\\lambda\\alpha)}{2\\lambda}$。对于对称模态，$\\lambda\\alpha=n\\pi$，所以 $\\sin(2\\lambda\\alpha) = \\sin(2n\\pi) = 0$。反对称模态也有类似的结果。\n因此，$\\int_{-\\alpha}^{\\alpha}f(\\theta)^{2}\\,\\mathrm{d}\\theta = \\alpha$。\n综合所有部分，能量为：\n$$ E(R) = \\frac{\\mu c^{2}}{2} \\left(\\frac{R^{2\\lambda}}{2\\lambda}\\right) (2\\lambda^{2}\\alpha) = \\frac{\\mu c^{2} \\lambda \\alpha R^{2\\lambda}}{2} $$\n\n(b) 正交性与能量标度。\n\n通解是本征函数的线性叠加：$w(r, \\theta) = \\sum_i c_i r^{\\lambda_i} f_i(\\theta)$。\n能量被积函数包含诸如 $(\\frac{\\partial w}{\\partial r})^2$ 和 $(\\frac{1}{r}\\frac{\\partial w}{\\partial \\theta})^2$ 的项。让我们用这个和式再次考虑能量计算。能量积分中的项是：\n$$ \\left(\\sum_i c_i \\lambda_i r^{\\lambda_i-1}f_i\\right)^{2} + \\frac{1}{r^{2}}\\left(\\sum_i c_i r^{\\lambda_i}f'_i\\right)^{2} = \\sum_i \\sum_j c_i c_j r^{\\lambda_i+\\lambda_j-2}(\\lambda_i \\lambda_j f_i f_j + f'_i f'_j) $$\n要将其从 $-\\alpha$ 到 $\\alpha$ 对 $\\theta$ 积分，需要计算 $\\int f_i f_j d\\theta$ 和 $\\int f'_i f'_j d\\theta$。函数集 $\\{f_i(\\theta)\\}$（带有确定本征值的正弦和余弦函数）在 $(-\\alpha, \\alpha)$ 上是正交的。\n$$ \\int_{-\\alpha}^{\\alpha} f_i(\\theta) f_j(\\theta)\\,\\mathrm{d}\\theta = \\alpha \\delta_{ij} $$\n其中 $\\delta_{ij}$ 是克罗内克δ函数。像之前一样使用分部积分法，我们也能找到导数的正交性：\n$$ \\int_{-\\alpha}^{\\alpha} f'_i(\\theta) f'_j(\\theta)\\,\\mathrm{d}\\theta = \\lambda_i^{2} \\int_{-\\alpha}^{\\alpha} f_i(\\theta) f_j(\\theta)\\,\\mathrm{d}\\theta = \\lambda_i^{2} \\alpha \\delta_{ij} $$\n注意，只有当 $i=j$ 时，$\\lambda_i^2$ 才能从积分中提出。如果 $i \\neq j$，积分为 $\\lambda_j^2 \\int f_i f_j d\\theta = 0$。\n能量密度项的角向积分变为：\n$$ \\int_{-\\alpha}^{\\alpha} \\sum_i \\sum_j c_i c_j r^{\\lambda_i+\\lambda_j-2}(\\lambda_i \\lambda_j f_i f_j + f'_i f'_j)\\,\\mathrm{d}\\theta = \\sum_i c_i^{2} r^{2\\lambda_i-2}(\\lambda_i^{2} \\alpha + \\lambda_i^{2} \\alpha) = \\sum_i 2 \\alpha c_i^{2} \\lambda_i^{2} r^{2\\lambda_i-2} $$\n总能量通过乘以 $\\frac{\\mu}{2}r$ 并对 $r$ 积分得到：\n$$ E(R) = \\frac{\\mu}{2} \\int_{0}^{R} \\sum_i 2 \\alpha c_i^{2} \\lambda_i^{2} r^{2\\lambda_i-1} \\,\\mathrm{d}r = \\sum_i \\left( \\mu \\alpha c_i^{2} \\lambda_i^{2} \\int_{0}^{R} r^{2\\lambda_i-1}\\,\\mathrm{d}r \\right) $$\n$$ E(R) = \\sum_i \\left( \\mu \\alpha c_i^{2} \\lambda_i^{2} \\frac{R^{2\\lambda_i}}{2\\lambda_i} \\right) = \\sum_i \\frac{\\mu c_i^{2} \\lambda_i \\alpha R^{2\\lambda_i}}{2} $$\n这表明，由于正交性，总能量是每个本征函数能量的总和，没有交叉项。\n每个具有本征值 $\\lambda_i$ 的本征函数对总能量的贡献与 $R^{2\\lambda_i}$ 成标度关系。当 $R \\to 0$ 时，具有最小正本征值 $\\lambda$ 的项将对能量做出主导贡献。\n\n(c) 指定场的前导阶能量。\n\n给定的顶点附近位移场为：\n$$ w(r,\\theta)=a_{1}\\,r^{\\pi/\\alpha}\\cos\\!\\left(\\frac{\\pi}{\\alpha}\\theta\\right)+b_{0}\\,r^{\\pi/(2\\alpha)}\\sin\\!\\left(\\frac{\\pi}{2\\alpha}\\theta\\right) + \\text{h.o.t.} $$\n这是两个本征函数的叠加：\n1.  一个 $n=1$ 的对称模态，本征值为 $\\lambda_1 = \\pi/\\alpha$，振幅为 $c_1 = a_1$。\n2.  一个 $n=1$ 的反对称模态，本征值为 $\\lambda_2 = (1-1/2)\\pi/\\alpha = \\pi/(2\\alpha)$，振幅为 $c_2 = b_0$。\n\n第一项的能量贡献的标度关系为 $R^{2\\lambda_1} = R^{2\\pi/\\alpha}$。\n第二项的能量贡献的标度关系为 $R^{2\\lambda_2} = R^{2(\\pi/(2\\alpha))} = R^{\\pi/\\alpha}$。\n\n我们已知 $\\alpha \\in (0, \\pi)$，这意味着 $\\pi/\\alpha > 0$。我们比较指数 $2\\pi/\\alpha$ 和 $\\pi/\\alpha$。由于 $\\alpha > 0$，我们有 $2\\pi/\\alpha > \\pi/\\alpha$。\n当 $R \\to 0$ 时，指数较小的项在和中占主导。因此，主导项是与较小本征值 $\\lambda_2 = \\pi/(2\\alpha)$ 相关联的项。问题陈述 $b_0 \\neq 0$，所以该项存在。\n\n当 $R \\to 0$ 时，对能量 $E(R)$ 的主导贡献来自本征函数 $w_2(r, \\theta) = b_0 r^{\\pi/(2\\alpha)} \\sin(\\frac{\\pi}{2\\alpha}\\theta)$。使用在(a)部分推导的公式，设 $c=b_0$ 和 $\\lambda=\\pi/(2\\alpha)$，能量的前导阶表达式为：\n$$ E(R) \\approx \\frac{\\mu b_{0}^{2} \\lambda \\alpha R^{2\\lambda}}{2} = \\frac{\\mu b_{0}^{2} (\\frac{\\pi}{2\\alpha}) \\alpha R^{2(\\frac{\\pi}{2\\alpha})}}{2} $$\n$$ E(R) = \\frac{\\mu b_{0}^{2} (\\frac{\\pi}{2}) R^{\\pi/\\alpha}}{2} = \\frac{\\pi \\mu b_{0}^{2}}{4} R^{\\pi/\\alpha} $$\n这就是所求的顶点附近应变能的前导阶表达式。", "answer": "$$\\boxed{\\frac{\\pi \\mu b_{0}^{2}}{4} R^{\\pi/\\alpha}}$$", "id": "2711185"}, {"introduction": "虽然奇点分析关注局部场，但米歇尔级数的系数是由全局载荷和几何形状决定的。本实践将艾里应力函数的低阶项的抽象数学系数与可触及的物理量——作用在结构上的合力与合力矩——联系起来。通过完成此练习，您将学习如何施加全局平衡约束，并了解少数几个关键模态如何控制楔形部件的整体静态响应 [@problem_id:2711191]。", "problem": "一个均匀、各向同性的二维弹性楔形体，其开口角为 $2\\beta$，在平面极坐标中占据区域 $\\{(r,\\theta): 0 \\le r \\le R,\\ -\\beta \\le \\theta \\le \\beta\\}$。其径向面 $\\theta = \\pm \\beta$ 上无面力，且仅在圆弧 $r=R$ 上作用有给定的面力。角度以弧度为单位。\n\n使用截断至直接控制圆弧上全局合力的三个最低阶模态的Michell（极坐标Airy）表示法：\n- $n=1$ 余弦模态 $\\Phi_{1c}(r,\\theta) = a\\, r^{3}\\cos\\theta$，\n- $n=1$ 正弦模态 $\\Phi_{1s}(r,\\theta) = b\\, r^{3}\\sin\\theta$，\n- $n=0$ 扭转特殊模态 $\\Phi_{0t}(r,\\theta) = c\\, r^{2}\\theta$，\n\n其中 $\\Phi$ 是Airy应力函数，$a$ 和 $b$ 的单位是 $\\mathrm{N\\,m^{-3}}$，$c$ 的单位是 $\\mathrm{N\\,m^{-2}}$。在没有体力的情况下，极坐标中的应力可由Airy应力函数通过平面弹性力学的标准关系式得到：\n$$\n\\sigma_{rr} = \\frac{1}{r}\\frac{\\partial \\Phi}{\\partial r} + \\frac{1}{r^{2}}\\frac{\\partial^{2}\\Phi}{\\partial \\theta^{2}},\\quad\n\\sigma_{\\theta\\theta} = \\frac{\\partial^{2}\\Phi}{\\partial r^{2}},\\quad\n\\sigma_{r\\theta} = -\\frac{\\partial}{\\partial r}\\!\\left(\\frac{1}{r}\\frac{\\partial \\Phi}{\\partial \\theta}\\right).\n$$\n在圆形边界 $r=R$ 上，面力矢量 $t$ 在标准正交极坐标基中分解为 $t = t_{r}\\, \\mathbf{e}_{r} + t_{\\theta}\\, \\mathbf{e}_{\\theta}$，其中 $t_{r} = \\sigma_{rr}$ 且 $t_{\\theta} = \\sigma_{r\\theta}$。\n\n对于 $R = 1$ 和 $\\beta = \\pi/3$ 的特定楔形体，数值边界拟合已得出Michell系数\n$$\n\\widehat{a} = 4,\\quad \\widehat{b} = -1,\\quad \\widehat{c} = 2,\n$$\n这组系数对应圆弧上的一组数值全局合力，\n$$\n\\big(\\widehat{F}_{x},\\, \\widehat{F}_{y},\\, \\widehat{M}_{z}\\big),\n$$\n由以下基本平衡方程定义：\n$$\nF_{x} = R \\int_{-\\beta}^{\\beta} \\big(t_{r}\\cos\\theta - t_{\\theta}\\sin\\theta\\big)\\, d\\theta,\\quad\nF_{y} = R \\int_{-\\beta}^{\\beta} \\big(t_{r}\\sin\\theta + t_{\\theta}\\cos\\theta\\big)\\, d\\theta,\\quad\nM_{z} = R^{2}\\int_{-\\beta}^{\\beta} t_{\\theta}\\, d\\theta.\n$$\n\n外部施加的（目标）全局合力指定为\n$$\nF_{x}^{\\mathrm{app}} = 5\\sqrt{3},\\quad\nF_{y}^{\\mathrm{app}} = \\big(3\\sqrt{3} - \\tfrac{4\\pi}{3}\\big) - 3,\\quad\nM_{z}^{\\mathrm{app}} = \\big(2\\sqrt{3} - \\tfrac{4\\pi}{3}\\big) - 6.\n$$\n\n仅从以上定义和Airy应力关系式出发，完成以下任务：\n\n1. 推导每个基函数 $\\Phi_{1c}$、$\\Phi_{1s}$ 和 $\\Phi_{0t}$ 在 $r=R$ 上所贡献的面力分量 $t_{r}$ 和 $t_{\\theta}$。\n2. 使用 $(F_{x},F_{y},M_{z})$ 的积分定义，计算在 $R=1$ 和 $\\beta=\\pi/3$ 条件下，由 $(\\widehat{a},\\widehat{b},\\widehat{c})$ 所决定的数值合力 $(\\widehat{F}_{x},\\widehat{F}_{y},\\widehat{M}_{z})$。\n3. 构建平衡失配矢量 $\\Delta \\mathbf{R} = \\big(F_{x}^{\\mathrm{app}} - \\widehat{F}_{x},\\, F_{y}^{\\mathrm{app}} - \\widehat{F}_{y},\\, M_{z}^{\\mathrm{app}} - \\widehat{M}_{z}\\big)$。\n4. 确定对Michell系数的修正量 $\\delta \\mathbf{p} = (\\delta a,\\, \\delta b,\\, \\delta c)$，以精确满足全局平衡，即修正后的系数 $(a,b,c) = (\\widehat{a}+\\delta a,\\, \\widehat{b}+\\delta b,\\, \\widehat{c}+\\delta c)$ 产生的全局合力等于施加值。报告满足这三个标量平衡约束的唯一修正量。\n\n以单个行矢量 $(\\delta a,\\, \\delta b,\\, \\delta c)$ 的形式提供您的最终答案，其分量的单位为：$\\delta a$ 和 $\\delta b$ 的单位是 $\\mathrm{N\\,m^{-3}}$，$\\delta c$ 的单位是 $\\mathrm{N\\,m^{-2}}$。无需四舍五入，请给出精确值。", "solution": "用户提出了一个关于楔形域的平面弹性力学问题。任务是验证该问题，若有效，则确定对给定Michell系数的修正量，以使楔形体圆弧边界上的全局合力（力和力矩）与一组指定值相匹配。\n\n首先，我将验证问题陈述。\n\n**第1步：提取已知条件**\n- **区域**：在极坐标 $(r, \\theta)$ 中由 $0 \\le r \\le R$ 和 $-\\beta \\le \\theta \\le \\beta$ 定义的二维弹性楔形体。\n- **边界条件背景**：径向面 $\\theta = \\pm \\beta$ 无面力。在圆弧 $r=R$上作用有给定的面力。\n- **Airy应力函数**：一个截断的Michell解 $\\Phi(r,\\theta) = \\Phi_{1c} + \\Phi_{1s} + \\Phi_{0t}$，其基函数为：\n  - $\\Phi_{1c}(r,\\theta) = a\\, r^{3}\\cos\\theta$\n  - $\\Phi_{1s}(r,\\theta) = b\\, r^{3}\\sin\\theta$\n  - $\\Phi_{0t}(r,\\theta) = c\\, r^{2}\\theta$\n- **应力关系式**:\n  - $\\sigma_{rr} = \\frac{1}{r}\\frac{\\partial \\Phi}{\\partial r} + \\frac{1}{r^{2}}\\frac{\\partial^{2}\\Phi}{\\partial \\theta^{2}}$\n  - $\\sigma_{\\theta\\theta} = \\frac{\\partial^{2}\\Phi}{\\partial r^{2}}$\n  - $\\sigma_{r\\theta} = -\\frac{\\partial}{\\partial r}\\!\\left(\\frac{1}{r}\\frac{\\partial \\Phi}{\\partial \\theta}\\right)$\n- **在r=R上的面力**：$t_r = \\sigma_{rr}|_{r=R}$， $t_\\theta = \\sigma_{r\\theta}|_{r=R}$。\n- **全局合力**:\n  - $F_{x} = R \\int_{-\\beta}^{\\beta} \\big(t_{r}\\cos\\theta - t_{\\theta}\\sin\\theta\\big)\\, d\\theta$\n  - $F_{y} = R \\int_{-\\beta}^{\\beta} \\big(t_{r}\\sin\\theta + t_{\\theta}\\cos\\theta\\big)\\, d\\theta$\n  - $M_{z} = R^{2}\\int_{-\\beta}^{\\beta} t_{\\theta}\\, d\\theta$\n- **特定参数**:\n  - $R = 1$\n  - $\\beta = \\pi/3$\n- **初始系数**：$(\\widehat{a}, \\widehat{b}, \\widehat{c}) = (4, -1, 2)$。\n- **目标合力**:\n  - $F_{x}^{\\mathrm{app}} = 5\\sqrt{3}$\n  - $F_{y}^{\\mathrm{app}} = (3\\sqrt{3} - \\frac{4\\pi}{3}) - 3$\n  - $M_{z}^{\\mathrm{app}} = (2\\sqrt{3} - \\frac{4\\pi}{3}) - 6$\n\n**第2步：使用提取的已知条件进行验证**\n该问题在线性弹性力学中有科学依据。Airy应力函数及其与极坐标下应力的关系是标准的。在楔形域问题中，使用截断的Michell级数是求解近似解的有效方法。该问题是适定的；它要求解一个包含三个未知数的三个线性方程组，这是一个标准的数学流程。问题陈述客观，且内容自洽。关于径向面无面力的陈述是问题的一般背景；所选的基函数本身并不单独满足此条件，但这并不影响“修正系数以匹配圆弧上全局合力”这一明确定义的具体任务。在以匹配积分性质（合力）为主要目标，而边界条件在加权残值或平均意义上得到满足的情况下，这种方法是常见的。\n\n**第3步：结论与行动**\n问题有效。我将继续进行求解。\n\n求解过程遵循问题陈述中概述的四个步骤。\n\n**第1部分：推导面力分量**\n首先，我们从总Airy应力函数 $\\Phi = a r^3 \\cos\\theta + b r^3 \\sin\\theta + c r^2 \\theta$ 中求出应力分量。\n所需的导数为：\n- $\\frac{\\partial\\Phi}{\\partial r} = 3ar^{2}\\cos\\theta + 3br^{2}\\sin\\theta + 2cr\\theta$\n- $\\frac{\\partial\\Phi}{\\partial\\theta} = -ar^{3}\\sin\\theta + br^{3}\\cos\\theta + cr^{2}$\n- $\\frac{\\partial^{2}\\Phi}{\\partial\\theta^2} = -ar^{3}\\cos\\theta - br^{3}\\sin\\theta$\n\n应力分量为：\n$$\n\\sigma_{rr} = \\frac{1}{r}\\frac{\\partial\\Phi}{\\partial r} + \\frac{1}{r^{2}}\\frac{\\partial^{2}\\Phi}{\\partial\\theta^2} = (3ar\\cos\\theta + 3br\\sin\\theta + 2c\\theta) + (-ar\\cos\\theta - br\\sin\\theta) = 2ar\\cos\\theta + 2br\\sin\\theta + 2c\\theta\n$$\n这个推导是错误的，正确的推导如下：\n$\\sigma_{rr} = \\frac{1}{r}(3ar^2\\cos\\theta+3br^2\\sin\\theta+2cr\\theta) + \\frac{1}{r^2}(-ar^3\\cos\\theta - br^3\\sin\\theta) = 3ar\\cos\\theta+3br\\sin\\theta+2c\\theta - ar\\cos\\theta - br\\sin\\theta = 2ar\\cos\\theta + 2br\\sin\\theta + 2c\\theta$。\n实际上，这里的`\\Phi_{0t}`项的应力是`\\sigma_{rr} = 2c\\theta`。等等，在原始问题中，`\\sigma_{rr}`是`2ar\\cos\\theta + 2br\\sin\\theta + 2c\\theta`。这个推导是正确的。\n$$\n\\sigma_{r\\theta} = -\\frac{\\partial}{\\partial r}\\left(\\frac{1}{r}\\frac{\\partial\\Phi}{\\partial\\theta}\\right) = -\\frac{\\partial}{\\partial r}\\left(-ar^{2}\\sin\\theta + br^{2}\\cos\\theta + cr\\right) = -(-2ar\\sin\\theta + 2br\\cos\\theta + c) = 2ar\\sin\\theta - 2br\\cos\\theta - c\n$$\n在圆形边界 $r=R$ 上的面力分量为 $t_r = \\sigma_{rr}|_{r=R}$ 和 $t_\\theta = \\sigma_{r\\theta}|_{r=R}$：\n$$\nt_r(\\theta) = 2aR\\cos\\theta + 2bR\\sin\\theta + 2c\\theta\n$$\n$$\nt_\\theta(\\theta) = 2aR\\sin\\theta - 2bR\\cos\\theta - c\n$$\n每个基函数的贡献如下：\n- 对于 $\\Phi_{1c} = a\\, r^{3}\\cos\\theta$：\n  $t_{r}^{(1c)} = 2aR\\cos\\theta$， $t_{\\theta}^{(1c)} = 2aR\\sin\\theta$\n- 对于 $\\Phi_{1s} = b\\, r^{3}\\sin\\theta$：\n  $t_{r}^{(1s)} = 2bR\\sin\\theta$， $t_{\\theta}^{(1s)} = -2bR\\cos\\theta$\n- 对于 $\\Phi_{0t} = c\\, r^{2}\\theta$：\n  $t_{r}^{(0t)} = 2c\\theta$， $t_{\\theta}^{(0t)} = -c$\n\n**第2部分：计算数值合力 $(\\widehat{F}_{x}, \\widehat{F}_{y}, \\widehat{M}_{z})$**\n系数 $(a,b,c)$ 与合力 $(F_x, F_y, M_z)$ 之间的关系是线性的。我们可以将其表示为矩阵方程 $\\mathbf{F} = \\mathbf{K} \\mathbf{p}$，其中 $\\mathbf{F} = (F_x, F_y, M_z)^T$，$\\mathbf{p} = (a, b, c)^T$。\n\n首先，我们计算三角函数项在区间 $[-\\beta, \\beta]$ 上的积分：\n- $\\int_{-\\beta}^{\\beta} \\cos(2\\theta) d\\theta = [\\frac{1}{2}\\sin(2\\theta)]_{-\\beta}^{\\beta} = \\sin(2\\beta)$\n- $\\int_{-\\beta}^{\\beta} \\sin(2\\theta) d\\theta = 0$ (奇被积函数)\n- $\\int_{-\\beta}^{\\beta} \\theta\\sin\\theta d\\theta = [-\\theta\\cos\\theta + \\sin\\theta]_{-\\beta}^{\\beta} = 2\\sin\\beta - 2\\beta\\cos\\beta$\n- $\\int_{-\\beta}^{\\beta} \\cos\\theta d\\theta = [\\sin\\theta]_{-\\beta}^{\\beta} = 2\\sin\\beta$\n- 其他如 $\\sin\\theta$、$\\theta\\cos\\theta$ 等奇函数的积分为零。\n\n现在，我们计算合力：\n对于 $F_x$：\n$t_r\\cos\\theta - t_\\theta\\sin\\theta = 2aR\\cos^2\\theta + 2bR\\sin\\theta\\cos\\theta + 2c\\theta\\cos\\theta - (2aR\\sin^2\\theta - 2bR\\sin\\theta\\cos\\theta - c\\sin\\theta) = 2aR\\cos(2\\theta) + 2bR\\sin(2\\theta) + 2c\\theta\\cos\\theta + c\\sin\\theta$\n$F_x = R \\int_{-\\beta}^{\\beta} (2aR\\cos(2\\theta) + \\dots) d\\theta = R(2aR\\sin(2\\beta)) = 2aR^2\\sin(2\\beta)$\n\n对于 $F_y$：\n$t_r\\sin\\theta + t_\\theta\\cos\\theta = 2aR\\sin\\theta\\cos\\theta + 2bR\\sin^2\\theta + 2c\\theta\\sin\\theta + (2aR\\sin\\theta\\cos\\theta - 2bR\\cos^2\\theta - c\\cos\\theta) = 2aR\\sin(2\\theta) - 2bR\\cos(2\\theta) + 2c\\theta\\sin\\theta - c\\cos\\theta$\n$F_y = R \\int_{-\\beta}^{\\beta} (-2bR\\cos(2\\theta) + 2c\\theta\\sin\\theta - c\\cos\\theta) d\\theta = R[-2bR\\sin(2\\beta) + 2c(2\\sin\\beta - 2\\beta\\cos\\beta) - c(2\\sin\\beta)] = -2bR^2\\sin(2\\beta) + 2cR(\\sin\\beta - 2\\beta\\cos\\beta)$\n\n对于 $M_z$：\n$M_z = R^2 \\int_{-\\beta}^{\\beta} (2aR\\sin\\theta - 2bR\\cos\\theta - c) d\\theta = R^2[-2bR(2\\sin\\beta) - c(2\\beta)] = -4bR^3\\sin\\beta - 2cR^2\\beta$\n\n该线性系统为：\n$$\n\\begin{pmatrix} F_x \\\\ F_y \\\\ M_z \\end{pmatrix} =\n\\begin{pmatrix}\n2R^2\\sin(2\\beta) & 0 & 0 \\\\\n0 & -2R^2\\sin(2\\beta) & 2R(\\sin\\beta - 2\\beta\\cos\\beta) \\\\\n0 & -4R^3\\sin\\beta & -2R^2\\beta\n\\end{pmatrix}\n\\begin{pmatrix} a \\\\ b \\\\ c \\end{pmatrix}\n$$\n当 $R = 1$ 且 $\\beta = \\pi/3$ 时：$\\sin\\beta = \\sqrt{3}/2$，$\\cos\\beta = 1/2$，$\\sin(2\\beta) = \\sqrt{3}/2$。\n矩阵 $\\mathbf{K}$ 变为：\n$$\n\\mathbf{K} = \\begin{pmatrix}\n2(1)^2(\\frac{\\sqrt{3}}{2}) & 0 & 0 \\\\\n0 & -2(1)^2(\\frac{\\sqrt{3}}{2}) & 2(1)(\\frac{\\sqrt{3}}{2} - 2\\frac{\\pi}{3}\\frac{1}{2}) \\\\\n0 & -4(1)^3(\\frac{\\sqrt{3}}{2}) & -2(1)^2\\frac{\\pi}{3}\n\\end{pmatrix} =\n\\begin{pmatrix}\n\\sqrt{3} & 0 & 0 \\\\\n0 & -\\sqrt{3} & \\sqrt{3} - \\frac{2\\pi}{3} \\\\\n0 & -2\\sqrt{3} & -\\frac{2\\pi}{3}\n\\end{pmatrix}\n$$\n我们为系数 $(\\widehat{a}, \\widehat{b}, \\widehat{c}) = (4, -1, 2)$ 计算合力 $\\widehat{\\mathbf{F}}$：\n$$\n\\begin{pmatrix} \\widehat{F}_x \\\\ \\widehat{F}_y \\\\ \\widehat{M}_z \\end{pmatrix} =\n\\begin{pmatrix}\n\\sqrt{3} & 0 & 0 \\\\\n0 & -\\sqrt{3} & \\sqrt{3} - \\frac{2\\pi}{3} \\\\\n0 & -2\\sqrt{3} & -\\frac{2\\pi}{3}\n\\end{pmatrix}\n\\begin{pmatrix} 4 \\\\ -1 \\\\ 2 \\end{pmatrix}\n$$\n- $\\widehat{F}_x = \\sqrt{3}(4) = 4\\sqrt{3}$\n- $\\widehat{F}_y = -\\sqrt{3}(-1) + (\\sqrt{3} - \\frac{2\\pi}{3})(2) = \\sqrt{3} + 2\\sqrt{3} - \\frac{4\\pi}{3} = 3\\sqrt{3} - \\frac{4\\pi}{3}$\n- $\\widehat{M}_z = -2\\sqrt{3}(-1) - \\frac{2\\pi}{3}(2) = 2\\sqrt{3} - \\frac{4\\pi}{3}$\n\n因此，$(\\widehat{F}_{x}, \\widehat{F}_{y}, \\widehat{M}_{z}) = (4\\sqrt{3}, 3\\sqrt{3} - \\frac{4\\pi}{3}, 2\\sqrt{3} - \\frac{4\\pi}{3})$。\n\n**第3部分：构建失配矢量**\n失配矢量 $\\Delta \\mathbf{R}$ 是施加合力与计算合力之差：$\\Delta \\mathbf{R} = \\mathbf{F}^{\\mathrm{app}} - \\widehat{\\mathbf{F}}$。\n- $\\Delta R_x = F_x^{\\mathrm{app}} - \\widehat{F}_x = 5\\sqrt{3} - 4\\sqrt{3} = \\sqrt{3}$\n- $\\Delta R_y = F_y^{\\mathrm{app}} - \\widehat{F}_y = \\left( (3\\sqrt{3} - \\frac{4\\pi}{3}) - 3 \\right) - (3\\sqrt{3} - \\frac{4\\pi}{3}) = -3$\n- $\\Delta R_z = M_z^{\\mathrm{app}} - \\widehat{M}_z = \\left( (2\\sqrt{3} - \\frac{4\\pi}{3}) - 6 \\right) - (2\\sqrt{3} - \\frac{4\\pi}{3}) = -6$\n\n失配矢量为 $\\Delta \\mathbf{R} = (\\sqrt{3}, -3, -6)^T$。\n\n**第4部分：确定修正矢量**\n对系数的修正量 $\\delta\\mathbf{p} = (\\delta a, \\delta b, \\delta c)^T$ 必须满足 $\\mathbf{K} \\delta\\mathbf{p} = \\Delta\\mathbf{R}$。\n$$\n\\begin{pmatrix}\n\\sqrt{3} & 0 & 0 \\\\\n0 & -\\sqrt{3} & \\sqrt{3} - \\frac{2\\pi}{3} \\\\\n0 & -2\\sqrt{3} & -\\frac{2\\pi}{3}\n\\end{pmatrix}\n\\begin{pmatrix} \\delta a \\\\ \\delta b \\\\ \\delta c \\end{pmatrix} =\n\\begin{pmatrix} \\sqrt{3} \\\\ -3 \\\\ -6 \\end{pmatrix}\n$$\n由第一行可得：\n$\\sqrt{3} \\delta a = \\sqrt{3} \\implies \\delta a = 1$。\n\n关于 $(\\delta b, \\delta c)$ 的剩余 $2 \\times 2$ 方程组为：\n1. $-\\sqrt{3} \\delta b + (\\sqrt{3} - \\frac{2\\pi}{3}) \\delta c = -3$\n2. $-2\\sqrt{3} \\delta b - \\frac{2\\pi}{3} \\delta c = -6$\n\n将方程(2)除以2：\n$2'$. $-\\sqrt{3} \\delta b - \\frac{\\pi}{3} \\delta c = -3$\n\n从方程(1)中减去方程($2'$)：\n$(-\\sqrt{3} \\delta b + (\\sqrt{3} - \\frac{2\\pi}{3}) \\delta c) - (-\\sqrt{3} \\delta b - \\frac{\\pi}{3} \\delta c) = -3 - (-3)$\n$(\\sqrt{3} - \\frac{2\\pi}{3} + \\frac{\\pi}{3}) \\delta c = 0$\n$(\\sqrt{3} - \\frac{\\pi}{3}) \\delta c = 0$\n因为 $\\sqrt{3} - \\pi/3 \\neq 0$，所以必然有 $\\delta c = 0$。\n\n将 $\\delta c = 0$ 代入方程($2'$)：\n$-\\sqrt{3} \\delta b - \\frac{\\pi}{3}(0) = -3$\n$-\\sqrt{3} \\delta b = -3$\n$\\delta b = \\frac{3}{\\sqrt{3}} = \\sqrt{3}$。\n\n所求的修正矢量为 $(\\delta a, \\delta b, \\delta c) = (1, \\sqrt{3}, 0)$。\n按照规定，$\\delta a$ 和 $\\delta b$ 的单位是 $\\mathrm{N\\,m^{-3}}$，$\\delta c$ 的单位是 $\\mathrm{N\\,m^{-2}}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1 & \\sqrt{3} & 0 \\end{pmatrix}}\n$$", "id": "2711191"}, {"introduction": "在实际工程和实验力学中，我们常常面临逆问题：根据边界测量值确定应力状态。这个计算练习将指导您建立一个加权最小二乘法，以从模拟的边界牵引力数据中恢复米歇尔系数。您不仅将实现一个实际逆问题的求解，还将探索如列缩放等数值技术如何改善解的条件数和准确性，这是计算力学中的一项关键技能 [@problem_id:2711213]。", "problem": "构造一个计算程序，该程序使用基于圆弧上过采样边界牵引力数据的加权最小二乘估计器，来恢复平面弹性力学中二维楔形体的截断 Michell 级数 Airy 应力函数的系数，并评估列缩放对条件数和系数恢复效果的影响。考虑一个极坐标系下的楔形域，其半径介于 $a$ 和 $b$ 之间，极角介于 $\\theta=0$ 和 $\\theta=\\alpha$ 之间，其中所有角度都必须以弧度为单位处理。假设体力为零，问题为线性弹性的，并且应力由满足双谐和方程的 Airy 应力函数 $\\Phi(r,\\theta)$ 导出。使用 Airy 应力函数与极坐标系下平面应力张量分量之间的以下基本关系：\n- $\\sigma_{rr} = \\dfrac{1}{r^2}\\,\\dfrac{\\partial^2 \\Phi}{\\partial \\theta^2} + \\dfrac{1}{r}\\,\\dfrac{\\partial \\Phi}{\\partial r}$,\n- $\\sigma_{\\theta\\theta} = \\dfrac{\\partial^2 \\Phi}{\\partial r^2}$,\n- $\\sigma_{r\\theta} = -\\,\\dfrac{\\partial}{\\partial r}\\!\\left(\\dfrac{1}{r}\\,\\dfrac{\\partial \\Phi}{\\partial \\theta}\\right)$.\n\n将 Michell 解截断为以下双谐和 Airy 应力函数的基，该基排除了刚体运动模态和对数/奇异项：\n- $\\Phi_0(r,\\theta) = r^2$,\n- $\\Phi_{1c}(r,\\theta) = r^3 \\cos\\theta$,\n- $\\Phi_{1s}(r,\\theta) = r^3 \\sin\\theta$,\n- $\\Phi_{2c}^{(2)}(r,\\theta) = r^2 \\cos(2\\theta)$,\n- $\\Phi_{2s}^{(2)}(r,\\theta) = r^2 \\sin(2\\theta)$,\n- $\\Phi_{2c}^{(4)}(r,\\theta) = r^4 \\cos(2\\theta)$,\n- $\\Phi_{2s}^{(4)}(r,\\theta) = r^4 \\sin(2\\theta)$.\n\n设未知系数向量为 $c \\in \\mathbb{R}^7$，它按上述列出的顺序与基函数相乘。对于边界测量，使用两个圆弧 $\\{r=a,\\, 0\\le \\theta \\le \\alpha\\}$ 和 $\\{r=b,\\, 0\\le \\theta \\le \\alpha\\}$ 上的过采样牵引力分量。在每个采样点，测量的两个分量是径向牵引力 $t_r=\\sigma_{rr}$ 和剪切牵引力 $t_s=\\sigma_{r\\theta}$。对于形式为 $\\Phi(r,\\theta)=r^p \\cos(n\\theta)$ 的通用基项，其应力贡献与系数呈线性关系，由以下公式给出\n- $\\sigma_{rr}^{(p,n,\\cos)} = \\left(p - n^2\\right)\\,r^{p-2}\\cos(n\\theta)$,\n- $\\sigma_{r\\theta}^{(p,n,\\cos)} = n\\,(p-1)\\,r^{p-2}\\sin(n\\theta)$,\n对于 $\\Phi(r,\\theta)=r^p \\sin(n\\theta)$，\n- $\\sigma_{rr}^{(p,n,\\sin)} = \\left(p - n^2\\right)\\,r^{p-2}\\sin(n\\theta)$,\n- $\\sigma_{r\\theta}^{(p,n,\\sin)} = -\\,n\\,(p-1)\\,r^{p-2}\\cos(n\\theta)$,\n而对于 $\\Phi_0=r^2$，\n- $\\sigma_{rr}^{(0)}=2$,\n- $\\sigma_{r\\theta}^{(0)}=0$.\n使用这些恒等式以及上述基本关系，来组装从系数向量 $c$ 到堆叠的牵引力数据向量 $y$ 的线性映射。\n\n设 $A \\in \\mathbb{R}^{2M \\times 7}$ 是将 $c$ 映射到 $y$ 的设计矩阵，其中 $M$ 是两条圆弧上的总角向采样点数，每个角向点贡献对应于 $t_r$ 和 $t_s$ 的两行。定义一个对角加权矩阵 $W\\in\\mathbb{R}^{2M\\times 2M}$，其中恒定权重 $w_a$ 应用于源自 $r=a$ 采样的行，恒定权重 $w_b$ 应用于源自 $r=b$ 采样的行。使用加权最小二乘估计器，该估计器最小化 $\\|W(Ac-y)\\|_2^2$。同时考虑一个列缩放矩阵 $S\\in\\mathbb{R}^{7\\times 7}$，其对角元等于 $A$ 的 $W$-加权列 $\\ell_2$-范数的倒数，因此缩放后的系统具有设计矩阵 $A_s = A S$ 和相同的加权残差。未缩放的估计值为 $c^\\star = \\operatorname*{arg\\,min}_c \\|W(Ac-y)\\|_2$，缩放后的估计值为 $\\widehat{c} = S\\,\\arg\\min_x \\|W(A S x - y)\\|_2$。\n\n通过指定一个真值系数向量 $c_{\\mathrm{true}} \\in \\mathbb{R}^7$ 并在选定的采样点上计算 $y_{\\mathrm{clean}} = A\\,c_{\\mathrm{true}}$ 来生成合成数据，然后向 $y_{\\mathrm{clean}}$ 的每个条目添加具有指定标准差 $\\sigma$ 的独立零均值高斯噪声以获得 $y$。为保证可复现性，必须按照下文给出的方式固定随机种子。根据计算出的估计值，报告相对系数误差 $\\varepsilon_{\\mathrm{noscale}} = \\|c^\\star - c_{\\mathrm{true}}\\|_2 / \\|c_{\\mathrm{true}}\\|_2$ 和 $\\varepsilon_{\\mathrm{scale}} = \\|\\widehat{c} - c_{\\mathrm{true}}\\|_2 / \\|c_{\\mathrm{true}}\\|_2$，以及谱条件数 $\\kappa_{\\mathrm{noscale}} = \\sigma_{\\max}(W A)/\\sigma_{\\min}(W A)$ 和 $\\kappa_{\\mathrm{scale}} = \\sigma_{\\max}(W A S)/\\sigma_{\\min}(W A S)$，其中 $\\sigma_{\\max}$ 和 $\\sigma_{\\min}$ 分别表示最大和最小奇异值。同时报告一个布尔值，指示缩放是否减小了相对误差，即 $\\varepsilon_{\\mathrm{scale}} < \\varepsilon_{\\mathrm{noscale}}$ 是否成立。\n\n所有计算的角度单位必须是弧度。不需要物理单位。所有数值输出必须是无量纲实数或布尔值。\n\n实现一个单一的程序来执行以下测试套件。在所有情况下，使用上面指定的基排序和真值系数向量\n- $c_{\\mathrm{true}} = \\big[\\,0.10,\\; 0.020,\\; -0.030,\\; 0.060,\\; 0.010,\\; -0.020,\\; 0.030\\,\\big]^T$。\n\n对每种情况，按规定构造 $A$、$W$ 和 $y$，求解未缩放和缩放的加权最小二乘问题，并报告所要求的指标。\n\n测试套件：\n- 情况 1 (窄楔形，平衡权重，低噪声):\n  - $\\alpha = 0.5$,\n  - $a = 0.8$,\n  - $b = 1.2$,\n  - $r=a$ 上的角向采样点数: $M_a = 40$,\n  - $r=b$ 上的角向采样点数: $M_b = 60$,\n  - 权重: $w_a = 1.0$, $w_b = 1.0$,\n  - 噪声标准差: $\\sigma = 1.0\\times 10^{-4}$,\n  - 随机种子: $s = 12345$.\n- 情况 2 (直角楔形，内弧加强，中等噪声):\n  - $\\alpha = 1.57079632679$,\n  - $a = 0.7$,\n  - $b = 1.5$,\n  - $M_a = 30$,\n  - $M_b = 90$,\n  - $w_a = 2.0$, $w_b = 1.0$,\n  - $\\sigma = 3.0\\times 10^{-4}$,\n  - $s = 23456$.\n- 情况 3 (宽楔形，外弧加强，较高噪声):\n  - $\\alpha = 2.8$,\n  - $a = 0.5$,\n  - $b = 2.0$,\n  - $M_a = 80$,\n  - $M_b = 80$,\n  - $w_a = 0.5$, $w_b = 1.5$,\n  - $\\sigma = 1.0\\times 10^{-3}$,\n  - $s = 34567$.\n\n要求的最终输出格式：\n- 您的程序必须产生单行输出，其中包含一个逗号分隔的列表，列表有三项，每项对应一个测试用例，并且每项都是一个按以下顺序排列的五元素列表：\n  - $[\\varepsilon_{\\mathrm{noscale}},\\;\\varepsilon_{\\mathrm{scale}},\\;\\kappa_{\\mathrm{noscale}},\\;\\kappa_{\\mathrm{scale}},\\;\\text{improved}]$,\n- 其中 $\\text{improved}$ 是一个布尔值，如果 $\\varepsilon_{\\mathrm{scale}} < \\varepsilon_{\\mathrm{noscale}}$ 则为真，否则为假。\n- 例如，打印的行应如下所示\n  - $[\\,[e_1^{\\mathrm{ns}},e_1^{\\mathrm{s}},k_1^{\\mathrm{ns}},k_1^{\\mathrm{s}},b_1],\\,[e_2^{\\mathrm{ns}},e_2^{\\mathrm{s}},k_2^{\\mathrm{ns}},k_2^{\\mathrm{s}},b_2],\\,[e_3^{\\mathrm{ns}},e_3^{\\mathrm{s}},k_3^{\\mathrm{ns}},k_3^{\\mathrm{s}},b_3]\\,]$,\n不含任何附加文本。所有角度单位始终为弧度，数值应报告为标准十进制形式的浮点数以及 Python 风格的布尔值。", "solution": "所提出的问题是计算固体力学和数值线性代数领域的一个有效练习。它在科学上基于线性弹性理论，利用 Airy 应力函数和截断的 Michell 级数来模拟二维楔形体中的应力状态。任务是使用加权最小二乘估计程序，从模拟的边界牵引力数据中恢复级数系数。该问题是适定的，为获得唯一的计算解，所有必要的参数和条件都已指定。这是一个客观、可形式化且非平凡的任务。因此，我们将进行完整的求解。\n\n问题的核心是求解形式为 $Ac = y$ 的超定线性方程组，以得到未知系数向量 $c \\in \\mathbb{R}^7$。向量 $y$ 包含带噪声的牵引力分量测量值，矩阵 $A$ 表示从系数 $c$ 到牵引力的线性映射。\n\nAiry 应力函数 $\\Phi(r, \\theta)$ 近似为 $N=7$ 个基函数 $\\Phi_k(r, \\theta)$ 的线性组合：\n$$\n\\Phi(r, \\theta) = \\sum_{k=0}^{6} c_k \\Phi_k(r, \\theta)\n$$\n其中 $c_k$ 是未知系数。基函数 $\\{\\Phi_k\\}_{k=0}^6$ 在问题描述中已给出，对应于系数向量 $c = [c_0, c_1, c_2, c_3, c_4, c_5, c_6]^T$。\n\n由于将应力张量 $\\sigma$ 与应力函数 $\\Phi$ 相关联的微分算子具有线性性质，应力张量的每个分量也是由基函数导出的相应应力分量的线性组合：\n$$\n\\sigma_{ij}(r, \\theta) = \\sum_{k=0}^{6} c_k \\sigma_{ij}^{(k)}(r, \\theta)\n$$\n其中 $\\sigma_{ij}^{(k)}$ 是从 $\\Phi_k$ 导出的应力。该问题要求根据圆周边界 $r=a$ 和 $r=b$ 上的牵引力分量 $t_r = \\sigma_{rr}$ 和 $t_s = \\sigma_{r\\theta}$ 进行估计。\n\n我们必须构造设计矩阵 $A$。设在圆弧 $r=a$ 上有 $M_a$ 个角向采样点 $\\{\\theta_{a,j}\\}_{j=1}^{M_a}$，在圆弧 $r=b$ 上有 $M_b$ 个点 $\\{\\theta_{b,j}\\}_{j=1}^{M_b}$。总测量位置数为 $M = M_a + M_b$。在每个位置测量两个牵引力分量 ($t_r$, $t_s$)，总共有 $2M$ 个测量值。数据向量 $y \\in \\mathbb{R}^{2M}$ 是这些测量值的堆叠。设计矩阵 $A$ 的维度将是 $2M \\times 7$。$A$ 的每一行对应一个测量值，每一列对应一个基函数。\n\n具体来说，对于点 $(r_i, \\theta_i)$ 处的一次测量，系统会增加两行。第一行的第 $j$ 个元素是 $\\sigma_{rr}^{(j)}(r_i, \\theta_i)$，第二行的第 $j$ 个元素是 $\\sigma_{r\\theta}^{(j)}(r_i, \\theta_i)$。使用问题描述中为每个带参数 $(p, n)$ 的基函数 $\\Phi_k$ 提供的应力表达式，我们可以填充矩阵 $A$。$A$ 的七列按指定顺序对应于基函数：$\\Phi_0, \\Phi_{1c}, \\Phi_{1s}, \\Phi_{2c}^{(2)}, \\Phi_{2s}^{(2)}, \\Phi_{2c}^{(4)}, \\Phi_{2s}^{(4)}$。\n\n这七列源于点 $(r, \\theta)$ 处的以下应力贡献：\n1.  (来自 $c_0, \\Phi_0 = r^2$): $\\sigma_{rr}=2$, $\\sigma_{r\\theta}=0$。\n2.  (来自 $c_1, \\Phi_{1c} = r^3 \\cos\\theta$): $\\sigma_{rr}=2r\\cos\\theta$, $\\sigma_{r\\theta}=2r\\sin\\theta$。\n3.  (来自 $c_2, \\Phi_{1s} = r^3 \\sin\\theta$): $\\sigma_{rr}=2r\\sin\\theta$, $\\sigma_{r\\theta}=-2r\\cos\\theta$。\n4.  (来自 $c_3, \\Phi_{2c}^{(2)} = r^2 \\cos(2\\theta)$): $\\sigma_{rr}=-2\\cos(2\\theta)$, $\\sigma_{r\\theta}=2\\sin(2\\theta)$。\n5.  (来自 $c_4, \\Phi_{2s}^{(2)} = r^2 \\sin(2\\theta)$): $\\sigma_{rr}=-2\\sin(2\\theta)$, $\\sigma_{r\\theta}=-2\\cos(2\\theta)$。\n6.  (来自 $c_5, \\Phi_{2c}^{(4)} = r^4 \\cos(2\\theta)$): $\\sigma_{rr}=0$, $\\sigma_{r\\theta}=6r^2\\sin(2\\theta)$。\n7.  (来自 $c_6, \\Phi_{2s}^{(4)} = r^4 \\sin(2\\theta)$): $\\sigma_{rr}=0$, $\\sigma_{r\\theta}=-6r^2\\cos(2\\theta)$。\n\n该问题需使用加权最小二乘估计器求解。该方法最小化加权残差平方和：\n$$\nJ(c) = \\| W(Ac - y) \\|_2^2 = (Ac - y)^T W^T W (Ac - y)\n$$\n其中 $W$ 是一个对角权重矩阵。此最小化问题的解 $c^\\star$ 通过求解加权正规方程组得到：\n$$\n(A^T W^T W A) c = A^T W^T W y\n$$\n令 $A_w = WA$ 和 $y_w = Wy$，则系统简化为 $A_w^T A_w c = A_w^T y_w$，该方程组通过标准线性最小二乘算法求解 $A_w c = y_w$。解记为 $c^\\star$。\n\n如果 $A_w$ 的列具有巨大差异的量级，可能会出现数值不稳定性，导致矩阵 $A_w^T A_w$ 成为病态矩阵。列缩放是一种用于缓解此问题的预处理技术。我们定义一个对角缩放矩阵 $S \\in \\mathbb{R}^{7 \\times 7}$，其对角元是加权矩阵 $A_w$ 各列的欧几里得范数的倒数：\n$$\nS_{kk} = \\frac{1}{\\| (A_w)_{:,k} \\|_2}\n$$\n我们引入变量替换 $c = Sx$。最小化问题变为：\n$$\n\\min_x \\| W(ASx - y) \\|_2^2\n$$\n令 $A_s = AS$ 为列缩放设计矩阵。我们在最小二乘问题 $\\min_x \\| WA_s x - y \\|_2^2$ 中求解缩放后的系数 $x$。解为 $x^\\star$。然后通过逆代换恢复原始系数向量：$\\widehat{c} = S x^\\star$。\n\n每个测试用例的步骤如下：\n1.  定义几何参数 ($a, b, \\alpha$)、采样参数 ($M_a, M_b$)、权重 ($w_a, w_b$)、噪声水平 ($\\sigma$) 和随机种子 ($s$)。\n2.  生成 $M = M_a + M_b$ 个采样点 $(r_i, \\theta_i)$ 集合。角度选择为在 $[0, \\alpha]$ 区间内均匀分布。\n3.  根据在每个采样点上计算的应力公式，构造 $2M \\times 7$ 的设计矩阵 $A$。\n4.  构造对角权重矩阵 $W$ (或一个用于计算的等效权重向量)。\n5.  生成合成测量向量 $y$。首先，使用提供的真值向量 $c_{\\mathrm{true}}$ 计算无噪声数据 $y_{\\mathrm{clean}} = A c_{\\mathrm{true}}$。然后，向 $y_{\\mathrm{clean}}$ 的每个元素添加均值为 $0$、标准差为 $\\sigma$ 的高斯噪声。\n6.  对于未缩放问题，构造 $A_w = WA$。使用数值最小二乘求解器对 $A_w c = Wy$ 求解 $c^\\star$。计算条件数 $\\kappa_{\\mathrm{noscale}} = \\kappa(A_w)$ 和相对误差 $\\varepsilon_{\\mathrm{noscale}} = \\| c^\\star - c_{\\mathrm{true}} \\|_2 / \\| c_{\\mathrm{true}} \\|_2$。\n7.  对于缩放问题，根据 $A_w$ 的列范数计算缩放矩阵 $S$。构造缩放矩阵 $A_{ws} = WA_s = WAS$。从 $A_{ws} x = Wy$ 求解 $x^\\star$。恢复系数 $\\widehat{c} = S x^\\star$。计算条件数 $\\kappa_{\\mathrm{scale}} = \\kappa(A_{ws})$ 和相对误差 $\\varepsilon_{\\mathrm{scale}} = \\| \\widehat{c} - c_{\\mathrm{true}} \\|_2 / \\| c_{\\mathrm{true}} \\|_2$。\n8.  比较误差以确定缩放是否改善了结果，即 $\\varepsilon_{\\mathrm{scale}} < \\varepsilon_{\\mathrm{noscale}}$ 是否成立。\n9.  收集五个所需指标：$\\varepsilon_{\\mathrm{noscale}}, \\varepsilon_{\\mathrm{scale}}, \\kappa_{\\mathrm{noscale}}, \\kappa_{\\mathrm{scale}}$ 和改善布尔值。\n\n对每个测试用例实施此系统性步骤，以生成最终结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_A(r_vals, theta_vals):\n    \"\"\"\n    Constructs the design matrix A based on the Airy stress basis functions.\n\n    Args:\n        r_vals (np.ndarray): Array of radial coordinates for sample points.\n        theta_vals (np.ndarray): Array of angular coordinates for sample points.\n\n    Returns:\n        np.ndarray: The design matrix A of shape (2 * N_samples, 7).\n    \"\"\"\n    num_samples = len(r_vals)\n    A = np.zeros((2 * num_samples, 7))\n\n    # Pre-calculate trigonometric values for efficiency\n    cos_theta = np.cos(theta_vals)\n    sin_theta = np.sin(theta_vals)\n    cos_2theta = np.cos(2 * theta_vals)\n    sin_2theta = np.sin(2 * theta_vals)\n\n    # Rows for radial stress sigma_rr (indices 0, 2, 4, ...)\n    # Column 0: from Phi_0 = r^2\n    A[::2, 0] = 2.0\n    # Column 1: from Phi_1c = r^3 * cos(theta)\n    A[::2, 1] = 2 * r_vals * cos_theta\n    # Column 2: from Phi_1s = r^3 * sin(theta)\n    A[::2, 2] = 2 * r_vals * sin_theta\n    # Column 3: from Phi_2c^(2) = r^2 * cos(2*theta)\n    A[::2, 3] = -2 * cos_2theta\n    # Column 4: from Phi_2s^(2) = r^2 * sin(2*theta)\n    A[::2, 4] = -2 * sin_2theta\n    # Column 5: from Phi_2c^(4) = r^4 * cos(2*theta)\n    A[::2, 5] = 0.0\n    # Column 6: from Phi_2s^(4) = r^4 * sin(2*theta)\n    A[::2, 6] = 0.0\n\n    # Rows for shear stress sigma_rtheta (indices 1, 3, 5, ...)\n    # Column 0: from Phi_0 = r^2\n    A[1::2, 0] = 0.0\n    # Column 1: from Phi_1c = r^3 * cos(theta)\n    A[1::2, 1] = 2 * r_vals * sin_theta\n    # Column 2: from Phi_1s = r^3 * sin(theta)\n    A[1::2, 2] = -2 * r_vals * cos_theta\n    # Column 3: from Phi_2c^(2) = r^2 * cos(2*theta)\n    A[1::2, 3] = 2 * sin_2theta\n    # Column 4: from Phi_2s^(2) = r^2 * sin(2*theta)\n    A[1::2, 4] = -2 * cos_2theta\n    # Column 5: from Phi_2c^(4) = r^4 * cos(2*theta)\n    A[1::2, 5] = 6 * r_vals**2 * sin_2theta\n    # Column 6: from Phi_2s^(4) = r^4 * sin(2*theta)\n    A[1::2, 6] = -6 * r_vals**2 * cos_2theta\n\n    return A\n\ndef run_case(case_params, c_true):\n    \"\"\"\n    Runs a single test case for coefficient recovery.\n\n    Args:\n        case_params (dict): Dictionary of parameters for the test case.\n        c_true (np.ndarray): The ground-truth coefficient vector.\n\n    Returns:\n        list: A list of five metrics: [eps_noscale, eps_scale, kappa_noscale, kappa_scale, improved].\n    \"\"\"\n    alpha = case_params['alpha']\n    a = case_params['a']\n    b = case_params['b']\n    Ma = case_params['Ma']\n    Mb = case_params['Mb']\n    wa = case_params['wa']\n    wb = case_params['wb']\n    sigma = case_params['sigma']\n    seed = case_params['s']\n\n    # 1. Generate sample points\n    theta_a = np.linspace(0, alpha, Ma)\n    theta_b = np.linspace(0, alpha, Mb)\n    r_a = np.full_like(theta_a, a)\n    r_b = np.full_like(theta_b, b)\n    \n    r_vals = np.concatenate((r_a, r_b))\n    theta_vals = np.concatenate((theta_a, theta_b))\n\n    # 2. Construct the design matrix A\n    A = build_A(r_vals, theta_vals)\n\n    # 3. Construct the weight vector (equivalent to diagonal of W)\n    w_vec = np.concatenate((np.full(2 * Ma, wa), np.full(2 * Mb, wb)))\n    \n    # 4. Generate synthetic measurement vector y\n    rng = np.random.default_rng(seed)\n    y_clean = A @ c_true\n    noise = rng.normal(0, sigma, size=y_clean.shape)\n    y = y_clean + noise\n\n    # For weighted least squares, we solve (WA)c = Wy\n    # This is done by element-wise multiplication with a weight vector\n    WA = w_vec[:, np.newaxis] * A\n    Wy = w_vec * y\n\n    # 5. Unscaled analysis\n    kappa_noscale = np.linalg.cond(WA)\n    c_star, _, _, _ = np.linalg.lstsq(WA, Wy, rcond=None)\n    eps_noscale = np.linalg.norm(c_star - c_true) / np.linalg.norm(c_true)\n\n    # 6. Scaled analysis\n    # Compute column norms of WA to create scaling matrix S\n    col_norms = np.linalg.norm(WA, axis=0)\n    # Avoid division by zero if a column is all zeros, though not expected here\n    S_diag = np.divide(1.0, col_norms, out=np.zeros_like(col_norms), where=col_norms!=0)\n    S = np.diag(S_diag)\n    \n    # Scaled design matrix As = A @ S\n    # We solve for x in (WAS)x = Wy\n    WAs = WA @ S\n    \n    kappa_scale = np.linalg.cond(WAs)\n    x_star, _, _, _ = np.linalg.lstsq(WAs, Wy, rcond=None)\n    \n    # Recover original coefficients\n    c_hat = S @ x_star\n    eps_scale = np.linalg.norm(c_hat - c_true) / np.linalg.norm(c_true)\n\n    # 7. Compare errors\n    improved = bool(eps_scale  eps_noscale)\n\n    return [eps_noscale, eps_scale, kappa_noscale, kappa_scale, improved]\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Ground-truth coefficient vector\n    c_true = np.array([0.10, 0.020, -0.030, 0.060, 0.010, -0.020, 0.030])\n\n    # Test suite parameters\n    test_cases = [\n        {\n            'alpha': 0.5, 'a': 0.8, 'b': 1.2,\n            'Ma': 40, 'Mb': 60,\n            'wa': 1.0, 'wb': 1.0,\n            'sigma': 1.0e-4, 's': 12345\n        },\n        {\n            'alpha': 1.57079632679, 'a': 0.7, 'b': 1.5,\n            'Ma': 30, 'Mb': 90,\n            'wa': 2.0, 'wb': 1.0,\n            'sigma': 3.0e-4, 's': 23456\n        },\n        {\n            'alpha': 2.8, 'a': 0.5, 'b': 2.0,\n            'Ma': 80, 'Mb': 80,\n            'wa': 0.5, 'wb': 1.5,\n            'sigma': 1.0e-3, 's': 34567\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        case_results = run_case(case, c_true)\n        results.append(case_results)\n\n    # Format output as a list of lists, comma-separated\n    # The str() function for a list creates the desired python-like representation\n    # including 'True'/'False' for booleans.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2711213"}]}