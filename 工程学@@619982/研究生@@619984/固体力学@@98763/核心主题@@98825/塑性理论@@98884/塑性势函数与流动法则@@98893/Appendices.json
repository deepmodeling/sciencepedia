{"hands_on_practices": [{"introduction": "我们的第一个实践练习将深入探讨计算塑性力学的核心：径向返回映射算法。对于遵循 von Mises 屈服准则（也称为 $J_2$ 塑性）的材料（如许多金属），该算法是在每个增量步中更新应力和塑性应变的基石。通过这个练习，您将亲手计算在给定试探应力状态下，如何利用一致性条件和流动法则，精确地将应力“返回”到更新后的屈服面上，从而掌握塑性乘子的求解和应力张量的更新 [@problem_id:2671059]。", "problem": "一种小应变、率无关、各向同性硬化金属遵循关联 von Mises 塑性（也称为 $J_{2}$ 塑性）理论。其弹性模量由杨氏模量 $E=210$ GPa 和泊松比 $\\nu=0.3$ 描述。初始屈服应力为 $\\sigma_{y0}=250$ MPa，线性各向同性硬化模量为 $H=1$ GPa。考虑从一个零塑性应变和零应力的初始状态开始，进行一次隐式（后向欧拉）返回映射更新。\n\n在弹性预测下，一个应变增量产生了一个纯偏柯西试探应力，其范数 $\\|\\mathbf{s}^{\\mathrm{tr}}\\|=500$ MPa，并与单位偏量张量对齐\n$$\n\\mathbf{n}=\\mathrm{diag}\\!\\left(\\frac{2}{\\sqrt{6}},-\\frac{1}{\\sqrt{6}},-\\frac{1}{\\sqrt{6}}\\right),\n$$\n因此 $\\mathbf{s}^{\\mathrm{tr}}=500\\,\\mathbf{n}$ MPa 且静水试探应力为零。流动是关联的，塑性势等于屈服函数，von Mises 等效应力定义为 $\\sigma_{\\mathrm{eq}}=\\sqrt{\\tfrac{3}{2}}\\,\\|\\mathbf{s}\\|$，各向同性硬化定律为 $\\sigma_{y}=\\sigma_{y0}+H\\,\\bar{\\varepsilon}^{p}$，其中等效塑性应变增量满足 $\\Delta\\bar{\\varepsilon}^{p}=\\Delta\\lambda$。\n\n从这些定义和小应变弹性定律出发，使用流动法则的后向欧拉离散化和一致性条件，推导标量塑性乘子增量 $\\Delta\\lambda$ 和更新后的柯西应力张量 $\\boldsymbol{\\sigma}^{k+1}$。假设在该增量过程中静水应力保持为零。\n\n- 计算 $\\Delta\\lambda$。\n- 计算更新后的柯西应力张量的三个正应力分量 $\\sigma_{11}^{k+1}$、$\\sigma_{22}^{k+1}$ 和 $\\sigma_{33}^{k+1}$。\n\n以 MPa 为单位表示这三个应力分量。将所有报告的数值四舍五入到四位有效数字。最终答案必须以单行矩阵的形式给出，依次包含 $\\Delta\\lambda$、$\\sigma_{11}^{k+1}$、$\\sigma_{22}^{k+1}$ 和 $\\sigma_{33}^{k+1}$。", "solution": "首先对问题进行验证，以确保其科学上合理、适定，并且提供了所有必要的信息。\n\n**问题验证**\n\n已知条件为：\n- 材料模型：小应变、率无关、各向同性硬化。\n- 塑性：关联 von Mises（$J_2$）塑性。\n- 弹性常数：杨氏模量 $E = 210$ GPa，泊松比 $\\nu = 0.3$。\n- 初始屈服应力：$\\sigma_{y0} = 250$ MPa。\n- 硬化模量：线性各向同性，$H = 1$ GPa。\n- 初始状态：$\\boldsymbol{\\sigma}^k = \\mathbf{0}$，$\\boldsymbol{\\varepsilon}^{p,k} = \\mathbf{0}$，$\\bar{\\varepsilon}^{p,k} = 0$。\n- 试探应力状态：$\\boldsymbol{\\sigma}^{\\mathrm{tr}}$ 是纯偏量 $\\mathbf{s}^{\\mathrm{tr}}$，其范数 $\\|\\mathbf{s}^{\\mathrm{tr}}\\| = 500$ MPa，方向为 $\\mathbf{n}=\\mathrm{diag}(2/\\sqrt{6}, -1/\\sqrt{6}, -1/\\sqrt{6})$。\n- 屈服函数（von Mises）：$\\sigma_{\\mathrm{eq}} = \\sqrt{\\frac{3}{2}} \\|\\mathbf{s}\\|$。\n- 硬化定律：$\\sigma_{y} = \\sigma_{y0} + H \\bar{\\varepsilon}^{p}$。\n- 等效塑性应变增量：$\\Delta\\bar{\\varepsilon}^{p} = \\Delta\\lambda$。\n- 假设：静水应力始终为零，$p=0$。\n\n该问题是计算塑性力学中的一个标准练习，具体涉及对具有线性各向同性硬化的 $J_2$ 塑性应用径向返回映射算法。所有定义、常数和条件均为固体力学领域的标准内容，并且相互一致。材料属性对于钢是符合实际的。该问题是适定的，并具有科学依据。因此，该问题是有效的，将推导其解。\n\n**求解推导**\n\n隐式返回映射算法的求解过程包括一个弹性预测步，以及在检测到屈服后进行的一个塑性修正步。\n\n**1. 弹性预测与屈服检查**\n试探应力为纯偏量，$\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathbf{s}^{\\mathrm{tr}}$，其范数 $\\|\\mathbf{s}^{\\mathrm{tr}}\\| = 500$ MPa。\n计算试探状态的 von Mises 等效应力：\n$$\n\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2}} \\|\\mathbf{s}^{\\mathrm{tr}}\\| = \\sqrt{1.5} \\times 500 \\text{ MPa} \\approx 612.37 \\text{ MPa}\n$$\n增量开始时的屈服应力（初始状态，$\\bar{\\varepsilon}^{p,k}=0$）是初始屈服应力，$\\sigma_y(\\bar{\\varepsilon}^{p,k}) = \\sigma_{y0} = 250$ MPa。\n使用屈服函数 $f = \\sigma_{\\mathrm{eq}} - \\sigma_y$ 检查屈服条件：\n$$\nf^{\\mathrm{tr}} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_{y0} = 612.37 \\text{ MPa} - 250 \\text{ MPa} = 362.37 \\text{ MPa}\n$$\n由于 $f^{\\mathrm{tr}}  0$，材料已发生屈服，需要进行塑性修正步。\n\n**2. 塑性修正（返回映射）**\n后向欧拉积分方案更新应力和内变量。对于关联 $J_2$ 塑性，流动法则由下式给出：\n$$\n\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\lambda \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}\\bigg|_{\\boldsymbol{\\sigma}^{k+1}}\n$$\n其中 $\\Delta\\lambda$ 是一致性参数。问题将等效塑性应变增量与 $\\Delta\\lambda$ 之间的关系定义为 $\\Delta\\bar{\\varepsilon}^p = \\Delta\\lambda$。满足此条件的标准流动法则是：\n$$\n\\dot{\\boldsymbol{\\varepsilon}}^p = \\dot{\\lambda} \\frac{3}{2} \\frac{\\mathbf{s}}{\\sigma_{\\mathrm{eq}}} \\implies \\dot{\\bar{\\varepsilon}}^p = \\sqrt{\\frac{2}{3}\\dot{\\boldsymbol{\\varepsilon}}^p:\\dot{\\boldsymbol{\\varepsilon}}^p} = \\dot{\\lambda}\n$$\n因此，我们采用离散形式：\n$$\n\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\lambda \\frac{3}{2} \\frac{\\mathbf{s}^{k+1}}{\\sigma_{\\mathrm{eq}}^{k+1}}\n$$\n应力更新为 $\\boldsymbol{\\sigma}^{k+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\mathbf{C} : \\Delta\\boldsymbol{\\varepsilon}^p$。由于塑性流动是等体积的（$\\mathrm{tr}(\\Delta\\boldsymbol{\\varepsilon}^p) = 0$），这可以简化为 $\\boldsymbol{\\sigma}^{k+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - 2G \\Delta\\boldsymbol{\\varepsilon}^p$，其中 $G$ 是剪切模量。由于试探应力和最终的静水应力都为零，我们只考虑偏量部分：\n$$\n\\mathbf{s}^{k+1} = \\mathbf{s}^{\\mathrm{tr}} - 2G \\Delta\\boldsymbol{\\varepsilon}^p\n$$\n代入 $\\Delta\\boldsymbol{\\varepsilon}^p$ 的表达式：\n$$\n\\mathbf{s}^{k+1} = \\mathbf{s}^{\\mathrm{tr}} - 2G \\left( \\Delta\\lambda \\frac{3}{2} \\frac{\\mathbf{s}^{k+1}}{\\sigma_{\\mathrm{eq}}^{k+1}} \\right) = \\mathbf{s}^{\\mathrm{tr}} - 3G\\Delta\\lambda \\frac{\\mathbf{s}^{k+1}}{\\sigma_{\\mathrm{eq}}^{k+1}}\n$$\n对 $\\mathbf{s}^{\\mathrm{tr}}$ 进行移项整理：\n$$\n\\mathbf{s}^{\\mathrm{tr}} = \\mathbf{s}^{k+1} \\left( 1 + \\frac{3G\\Delta\\lambda}{\\sigma_{\\mathrm{eq}}^{k+1}} \\right)\n$$\n此方程表明 $\\mathbf{s}^{k+1}$ 和 $\\mathbf{s}^{\\mathrm{tr}}$ 共线（即“径向返回”特性）。通过对两边取 von Mises 等效（乘以 $\\sqrt{3/2}$ 并取范数），我们得到：\n$$\n\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sigma_{\\mathrm{eq}}^{k+1} \\left( 1 + \\frac{3G\\Delta\\lambda}{\\sigma_{\\mathrm{eq}}^{k+1}} \\right) = \\sigma_{\\mathrm{eq}}^{k+1} + 3G\\Delta\\lambda\n$$\n这给出了等效应力的更新法则：\n$$\n\\sigma_{\\mathrm{eq}}^{k+1} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - 3G\\Delta\\lambda\n$$\n最终状态必须满足一致性条件，$f(\\boldsymbol{\\sigma}^{k+1}, \\bar{\\varepsilon}^{p,k+1}) = 0$：\n$$\n\\sigma_{\\mathrm{eq}}^{k+1} - \\sigma_y(\\bar{\\varepsilon}^{p,k+1}) = 0\n$$\n根据线性硬化定律 $\\sigma_y = \\sigma_{y0} + H\\bar{\\varepsilon}^p$ 并使用 $\\bar{\\varepsilon}^{p,k+1} = \\bar{\\varepsilon}^{p,k} + \\Delta\\bar{\\varepsilon}^p = 0 + \\Delta\\lambda$，我们得到：\n$$\n\\sigma_{\\mathrm{eq}}^{k+1} = \\sigma_{y0} + H\\Delta\\lambda\n$$\n现在我们通过令 $\\sigma_{\\mathrm{eq}}^{k+1}$ 的两个表达式相等来求解 $\\Delta\\lambda$：\n$$\n\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - 3G\\Delta\\lambda = \\sigma_{y0} + H\\Delta\\lambda\n$$\n$$\n\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_{y0} = (3G+H)\\Delta\\lambda \\implies \\Delta\\lambda = \\frac{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_{y0}}{3G+H}\n$$\n\n**3. 数值计算**\n首先，将所有单位转换为 MPa 并计算必要的常数：\n$E=210 \\text{ GPa} = 210000 \\text{ MPa}$\n$H=1 \\text{ GPa} = 1000 \\text{ MPa}$\n剪切模量 $G = \\frac{E}{2(1+\\nu)} = \\frac{210000}{2(1+0.3)} = \\frac{210000}{2.6} \\approx 80769.23 \\text{ MPa}$。\n\n现在计算 $\\Delta\\lambda$：\n$$\n\\Delta\\lambda = \\frac{612.3724 - 250}{3 \\times 80769.23 + 1000} = \\frac{362.3724}{242307.69 + 1000} = \\frac{362.3724}{243307.69} \\approx 0.00148935\n$$\n四舍五入到四位有效数字，$\\Delta\\lambda = 0.001489$。\n\n接下来，计算更新后的柯西应力张量 $\\boldsymbol{\\sigma}^{k+1}$。\n由于 $p^{k+1}=0$，所以 $\\boldsymbol{\\sigma}^{k+1} = \\mathbf{s}^{k+1}$。根据径向返回特性，我们有：\n$$\n\\mathbf{s}^{k+1} = \\frac{\\sigma_{\\mathrm{eq}}^{k+1}}{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}} \\mathbf{s}^{\\mathrm{tr}}\n$$\n首先，计算更新后的等效应力 $\\sigma_{\\mathrm{eq}}^{k+1}$：\n$$\n\\sigma_{\\mathrm{eq}}^{k+1} = \\sigma_{y0} + H\\Delta\\lambda = 250 \\text{ MPa} + 1000 \\text{ MPa} \\times 0.00148935 = 251.48935 \\text{ MPa}\n$$\n缩放因子为：\n$$\n\\frac{\\sigma_{\\mathrm{eq}}^{k+1}}{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}} = \\frac{251.48935}{612.3724} \\approx 0.41068\n$$\n试探应力张量为 $\\mathbf{s}^{\\mathrm{tr}} = 500\\,\\mathbf{n}$ MPa，其中 $\\mathbf{n} = \\mathrm{diag}(2/\\sqrt{6}, -1/\\sqrt{6}, -1/\\sqrt{6})$。\n$$\ns_{11}^{\\mathrm{tr}} = 500 \\times \\frac{2}{\\sqrt{6}} \\approx 408.248 \\text{ MPa}\n$$\n$$\ns_{22}^{\\mathrm{tr}} = s_{33}^{\\mathrm{tr}} = 500 \\times \\frac{-1}{\\sqrt{6}} \\approx -204.124 \\text{ MPa}\n$$\n更新后的应力分量为：\n$$\n\\sigma_{11}^{k+1} = s_{11}^{k+1} = s_{11}^{\\mathrm{tr}} \\times \\frac{\\sigma_{\\mathrm{eq}}^{k+1}}{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}} = 408.248 \\times 0.41068 \\approx 167.659 \\text{ MPa}\n$$\n$$\n\\sigma_{22}^{k+1} = s_{22}^{k+1} = s_{22}^{\\mathrm{tr}} \\times \\frac{\\sigma_{\\mathrm{eq}}^{k+1}}{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}} = -204.124 \\times 0.41068 \\approx -83.8295 \\text{ MPa}\n$$\n$$\n\\sigma_{33}^{k+1} = s_{33}^{k+1} = \\sigma_{22}^{k+1} \\approx -83.8295 \\text{ MPa}\n$$\n将最终结果四舍五入到四位有效数字：\n$\\Delta\\lambda = 0.001489$\n$\\sigma_{11}^{k+1} = 167.7$ MPa\n$\\sigma_{22}^{k+1} = -83.83$ MPa\n$\\sigma_{33}^{k+1} = -83.83$ MPa\n根据要求，将这些值组装成最终的答案矩阵。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.001489  167.7  -83.83  -83.83\n\\end{pmatrix}\n}\n$$", "id": "2671059"}, {"introduction": "在掌握了光滑屈服面的情况后，我们来探讨一个更具挑战性的场景：当应力状态恰好位于屈服面的一个角点或棱线上时，塑性流动的方向该如何确定？在这种情况下，塑性势函数的梯度并非唯一。本练习将引导您应用 Koiter 法则，利用次微分的概念处理这种非光滑问题，即塑性应变率的方向必须是构成该角点的各个屈服面法向的凸组合 [@problem_id:2671089]。这个练习对于理解晶体塑性或具有分段线性屈服准则的材料（如一些岩土材料）的行为至关重要。", "problem": "在应力空间的偏平面中，考虑一个由相关联塑性流动法则控制的各向同性材料，其塑性势 $g(\\boldsymbol{s})$ 是一个凸分段线性函数，其中 $\\boldsymbol{s}$ 是偏应力向量。假设在偏平面中局部地，$g(\\boldsymbol{s})$ 是两个线性形式的逐点最大值，因此在一个顶点（边交点）附近，它可以写为 $g(\\boldsymbol{s})=\\max\\{\\boldsymbol{m}_{1}\\cdot\\boldsymbol{s}+c_{1},\\,\\boldsymbol{m}_{2}\\cdot\\boldsymbol{s}+c_{2}\\}$，其中 $\\boldsymbol{m}_{1}$ 和 $\\boldsymbol{m}_{2}$ 是常数面法线，$c_{1}$ 和 $c_{2}$ 是常数。在两个面都激活的顶点处，次微分 $\\partial g(\\boldsymbol{s})$ 是激活面法线的凸包。\n\n使用以下基本事实：\n1. 对于一个凸函数 $g$，在 $g$ 不可微的点，相关联流动方向必须位于次微分 $\\partial g(\\boldsymbol{s})$ 中。\n2. 对于相关联流动法则，塑性应变率方向与当前状态下 $g$ 的一个次梯度成正比。\n3. 在角点处一个物理上允许的选择准则是，所选的次梯度与观测到的或施加的偏塑性流动方向 $\\boldsymbol{r}$ 对齐（塑性应变率与所选次梯度的共轴性）。\n\n假设在偏平面的局部标准正交基中，两个相邻的面法线为\n$$\n\\boldsymbol{m}_{1}=\\begin{pmatrix}1\\\\0\\end{pmatrix},\\qquad\n\\boldsymbol{m}_{2}=\\begin{pmatrix}0\\\\1\\end{pmatrix}.\n$$\n在这些面相交的顶点处，允许的相关联流动方向集合为 $\\{\\alpha\\,\\boldsymbol{m}_{1}+(1-\\alpha)\\,\\boldsymbol{m}_{2}:\\,\\alpha\\in[0,1]\\}$，可乘以任意正标量因子。假设施加的偏塑性流动方向为\n$$\n\\boldsymbol{r}=\\begin{pmatrix}1\\\\2\\end{pmatrix}.\n$$\n\n从上述核心定义（凸性、次微分、相关联流动和方向对齐）出发，确定唯一的系数 $\\alpha\\in[0,1]$，使得凸组合 $\\alpha\\,\\boldsymbol{m}_{1}+(1-\\alpha)\\,\\boldsymbol{m}_{2}$ 与 $\\boldsymbol{r}$ 共线。以无单位的单一标量形式提供最终答案。无需四舍五入。", "solution": "所述问题需要经过验证。\n\n**步骤1：提取已知条件**\n- 材料是各向同性的，并由相关联塑性流动法则控制。\n- 塑性势 $g(\\boldsymbol{s})$ 是偏应力 $\\boldsymbol{s}$ 的一个凸分段线性函数。\n- 在顶点附近，塑性势局部地表示为 $g(\\boldsymbol{s})=\\max\\{\\boldsymbol{m}_{1}\\cdot\\boldsymbol{s}+c_{1},\\,\\boldsymbol{m}_{2}\\cdot\\boldsymbol{s}+c_{2}\\}$。\n- 顶点处的次微分 $\\partial g(\\boldsymbol{s})$ 是激活面法线的凸包，由集合 $\\{\\alpha\\,\\boldsymbol{m}_{1}+(1-\\alpha)\\,\\boldsymbol{m}_{2}:\\,\\alpha\\in[0,1]\\}$ 给出。该集合构成了塑性应变率的允许方向。\n- 局部标准正交基中的两个相邻面法线给出如下：\n$$\n\\boldsymbol{m}_{1}=\\begin{pmatrix}1\\\\0\\end{pmatrix},\\qquad\n\\boldsymbol{m}_{2}=\\begin{pmatrix}0\\\\1\\end{pmatrix}.\n$$\n- 一个施加的偏塑性流动方向给出如下：\n$$\n\\boldsymbol{r}=\\begin{pmatrix}1\\\\2\\end{pmatrix}.\n$$\n- 顶点处的选择准则要求，所选的代表塑性流动方向的次梯度必须与施加的流动方向 $\\boldsymbol{r}$ 对齐（共线）。\n- 目标是确定满足此条件的唯一系数 $\\alpha\\in[0,1]$。\n\n**步骤2：验证**\n该问题是在针对非光滑屈服面的连续介质塑性力学的既定数学框架内提出的，特别利用了 Koiter 法则来处理角点处的塑性流动。塑性势、相关联流动、凸性和次微分等概念在该领域是标准的。所有已知条件在数学和物理上都是一致的。该问题是适定的，因为可以证明在指定域内存在唯一的 $\\alpha$ 解。该问题具有科学依据且内部一致。\n\n**步骤3：结论**\n问题有效。将提供解答。\n\n**解答推导**\n该问题的基础在于针对非光滑势函数的相关联粘塑性或率无关塑性理论。对于相关联流动法则，塑性应变率张量 $\\dot{\\boldsymbol{\\epsilon}}^p$ 由塑性势函数 $g$ 的梯度确定。在不可微点，例如势函数面的多个面相交的顶点，梯度不是唯一的。此时，塑性流动的方向被约束在该点的法锥内。该法锥由势函数的次微分构成。\n\n问题陈述，顶点处的次微分 $\\partial g(\\boldsymbol{s})$ 是激活面法线 $\\boldsymbol{m}_{1}$ 和 $\\boldsymbol{m}_{2}$ 的凸包。因此，代表允许的塑性流动方向的向量 $\\boldsymbol{d}$ 必须具有以下形式：\n$$\n\\boldsymbol{d} = \\alpha\\,\\boldsymbol{m}_{1}+(1-\\alpha)\\,\\boldsymbol{m}_{2}\n$$\n其中标量系数 $\\alpha$ 位于区间 $[0, 1]$ 内。\n\n我们已知面法线的具体形式：\n$$\n\\boldsymbol{m}_{1}=\\begin{pmatrix}1\\\\0\\end{pmatrix},\\qquad\n\\boldsymbol{m}_{2}=\\begin{pmatrix}0\\\\1\\end{pmatrix}.\n$$\n将这些代入 $\\boldsymbol{d}$ 的表达式中，得到：\n$$\n\\boldsymbol{d}(\\alpha) = \\alpha\\begin{pmatrix}1\\\\0\\end{pmatrix} + (1-\\alpha)\\begin{pmatrix}0\\\\1\\end{pmatrix} = \\begin{pmatrix}\\alpha \\\\ 1-\\alpha\\end{pmatrix}.\n$$\n问题施加了一个物理约束：所选的流动方向 $\\boldsymbol{d}(\\alpha)$ 必须与外部观测到或施加的塑性流动方向 $\\boldsymbol{r}$ 对齐。向量 $\\boldsymbol{r}$ 给出如下：\n$$\n\\boldsymbol{r}=\\begin{pmatrix}1\\\\2\\end{pmatrix}.\n$$\n对齐或共线的条件意味着 $\\boldsymbol{d}(\\alpha)$ 必须与 $\\boldsymbol{r}$ 成正比，其比例常数（我们记为 $k$）为一个正标量。要求常数为正，是因为塑性耗散意味着塑性应变率的方向不能与次梯度相反。因此，我们必须有：\n$$\n\\boldsymbol{d}(\\alpha) = k \\boldsymbol{r} \\qquad \\text{对于某个 } k  0。\n$$\n代入 $\\boldsymbol{d}(\\alpha)$ 和 $\\boldsymbol{r}$ 的表达式，我们得到向量方程：\n$$\n\\begin{pmatrix}\\alpha \\\\ 1-\\alpha\\end{pmatrix} = k\\begin{pmatrix}1\\\\2\\end{pmatrix}.\n$$\n这个向量方程等价于一个包含两个未知数 $\\alpha$ 和 $k$ 的两个线性标量方程组：\n$$\n\\begin{cases}\n\\alpha = k \\cdot 1 \\\\\n1-\\alpha = k \\cdot 2\n\\end{cases}\n$$\n从第一个方程，我们得到 $\\alpha = k$。我们将此代入第二个方程：\n$$\n1-k = 2k.\n$$\n求解 $k$：\n$$\n1 = 3k \\implies k = \\frac{1}{3}.\n$$\n由于 $k = 1/3  0$，我们的解是物理上允许的。现在我们确定 $\\alpha$ 的值：\n$$\n\\alpha = k = \\frac{1}{3}.\n$$\n值 $\\alpha = 1/3$ 位于所要求的区间 $[0, 1]$ 内，因此是凸组合的一个有效系数。这唯一地确定了与施加条件一致的顶点处的塑性流动方向。", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "2671089"}, {"introduction": "最后的实践练习是一项综合性的编程任务，将我们从微应变理论带入更通用、更复杂的有限应变塑性领域。您将实现一个完整的本构更新算法，该算法基于变形梯度的乘法分解（$\\mathbf{F} = \\mathbf{F}^e \\mathbf{F}^p$）和指数映射来更新塑性变形。这个练习要求您将本构理论、流动法则、硬化规律和数值求解方法（如牛顿迭代法）结合起来，编写一个能够处理大变形问题的核心计算程序 [@problem_id:2671030]。完成这项任务标志着您已具备将高级连续介质力学理论转化为实用计算工具的能力。", "problem": "实现一个独立的程序，该程序使用乘法分解和塑性变形梯度的指数映射，对有限应变关联塑性执行单步局部更新，并使用一致线性化来驱动牛顿迭代以求解塑性一致性参数。模型和更新的规定如下。\n\n基本和核心定义：\n- 变形梯度的乘法分解：$\\,\\mathbf{F} = \\mathbf{F}^e \\mathbf{F}^p\\,$，其中 $\\,\\mathbf{F}^e\\,$ 是弹性部分，$\\,\\mathbf{F}^p\\,$ 是塑性部分。\n- 塑性流动与塑性势 $\\,g(\\mathbf{M}) = \\sqrt{\\tfrac{3}{2}}\\,\\|\\operatorname{dev}\\mathbf{M}\\|_F\\,$ 相关联，其中 $\\,\\mathbf{M}\\,$ 是 Mandel 应力，$\\,\\|\\cdot\\|_F\\,$ 是 Frobenius 范数。偏应力算子为 $\\,\\operatorname{dev}\\mathbf{A} = \\mathbf{A} - \\tfrac{1}{3}\\operatorname{tr}(\\mathbf{A})\\mathbf{I}\\,$。\n- 零塑性自旋的关联流动法则：$\\,\\mathbf{L}^p = \\mathbf{D}^p = \\dot{\\gamma}\\,\\dfrac{\\partial g}{\\partial \\mathbf{M}}\\,$，其中 $\\,\\dot{\\gamma}\\ge 0\\,$ 且当 $\\,\\operatorname{dev}\\mathbf{M}\\neq\\mathbf{0}\\,$ 时 $\\,\\dfrac{\\partial g}{\\partial \\mathbf{M}} = \\sqrt{\\tfrac{3}{2}}\\,\\dfrac{\\operatorname{dev}\\mathbf{M}}{\\|\\operatorname{dev}\\mathbf{M}\\|_F}\\,$。\n- 各向同性线性硬化：当前屈服应力为 $\\,\\sigma_y(\\varepsilon^p) = \\sigma_{y0} + H\\,\\varepsilon^p\\,$，其中 $\\,\\varepsilon^p\\,$ 是累积等效塑性应变。\n- 在大小为 $\\,\\Delta t\\,$ 的时间步长内，塑性变形梯度的后向欧拉指数更新：\n$$\n\\mathbf{F}^p_{n+1} = \\exp\\!\\big(\\Delta t\\,\\mathbf{L}^p_{n+1}\\big)\\,\\mathbf{F}^p_n.\n$$\n- 累积等效塑性应变增量等于塑性一致性增量：$\\,\\Delta\\varepsilon^p = \\Delta\\gamma\\,$。\n\n为消除对特定弹性自由能的显式依赖，假设每个测试用例的试探偏 Mandel 应力 $\\,\\operatorname{dev}\\mathbf{M}^{\\text{tr}}\\,$ 由弹性预测步给出。对于各向同性弹性和 $J_2$ 型塑性，Mandel 应力空间中的径向返回会产生一个用于塑性修正的标量一致性方程。记 $\\,m^{\\text{tr}} = \\|\\operatorname{dev}\\mathbf{M}^{\\text{tr}}\\|_F\\,$ 和 $\\,c = \\sqrt{\\tfrac{3}{2}}\\,$。剪切模量为 $\\,\\mu\\,$，偏 Mandel 应力的后向欧拉径向返回给出\n$$\n\\|\\operatorname{dev}\\mathbf{M}_{n+1}\\|_F = m^{\\text{tr}} - 2\\mu\\,\\Delta\\gamma,\n$$\n且一致性方程为\n$$\nf(\\Delta\\gamma) = c\\big(m^{\\text{tr}} - 2\\mu\\,\\Delta\\gamma\\big) - \\big(\\sigma_{y0} + H(\\varepsilon^p_n + \\Delta\\gamma)\\big) = 0.\n$$\n用于牛顿迭代的一致线性化是通过将 $\\,f\\,$ 对 $\\,\\Delta\\gamma\\,$ 求导得到的：\n$$\n\\frac{df}{d\\Delta\\gamma} = -2\\mu\\,c - H.\n$$\n此外，如果发生塑性流动，步末的关联流动方向为 $\\,\\mathbf{N}_{n+1} = \\dfrac{\\operatorname{dev}\\mathbf{M}_{n+1}}{\\|\\operatorname{dev}\\mathbf{M}_{n+1}\\|_F}\\,$。由于径向返回，$\\,\\mathbf{N}_{n+1}\\,$ 与 $\\,\\operatorname{dev}\\mathbf{M}^{\\text{tr}}\\,$ 共轴，因此当 $\\,m^{\\text{tr}}  0\\,$ 时，可以从试探状态计算得出。在零塑性自旋下，$\\,\\mathbf{L}^p_{n+1} = \\mathbf{D}^p_{n+1} = \\dfrac{\\Delta\\gamma}{\\Delta t}\\,\\dfrac{\\partial g}{\\partial \\mathbf{M}}\\big|_{n+1} = \\dfrac{\\Delta\\gamma}{\\Delta t}\\,c\\,\\mathbf{N}_{n+1}\\,$，因此\n$$\n\\Delta t\\,\\mathbf{L}^p_{n+1} = \\Delta\\gamma\\,c\\,\\mathbf{N}_{n+1},\n\\quad\\Rightarrow\\quad\n\\mathbf{F}^p_{n+1} = \\exp\\!\\big(\\Delta\\gamma\\,c\\,\\mathbf{N}_{n+1}\\big)\\,\\mathbf{F}^p_n.\n$$\n由于 $\\,\\mathbf{N}_{n+1}\\,$ 是偏量，$\\,\\operatorname{tr}(\\mathbf{N}_{n+1}) = 0\\,$，这意味着 $\\,\\det\\big(\\exp(\\Delta\\gamma\\,c\\,\\mathbf{N}_{n+1})\\big) = 1\\,$ 并保持了塑性不可压缩性。\n\n你的程序必须为每个提供的测试用例执行以下操作：\n1. 计算 $\\,m^{\\text{tr}} = \\|\\operatorname{dev}\\mathbf{M}^{\\text{tr}}\\|_F\\,$ 和试探屈服函数 $\\,\\phi^{\\text{tr}} = c\\,m^{\\text{tr}} - \\big(\\sigma_{y0} + H\\,\\varepsilon^p_n\\big)\\,$。\n2. 如果 $\\,\\phi^{\\text{tr}} \\le 0\\,$，则取 $\\,\\Delta\\gamma = 0\\,$ 且 $\\,\\mathbf{F}^p_{n+1} = \\mathbf{F}^p_n\\,$。\n3. 如果 $\\,\\phi^{\\text{tr}}  0\\,$，使用由一致线性化 $\\,df/d\\Delta\\gamma = -2\\mu c - H\\,$ 驱动的牛顿迭代求解 $\\,\\Delta\\gamma\\ge 0\\,$ 的 $\\,f(\\Delta\\gamma)=0\\,$。使用初始猜测 $\\,\\Delta\\gamma^{(0)} = 0\\,$，当 $\\,|f(\\Delta\\gamma)| \\le 10^{-9}\\,$（单位为帕斯卡）或迭代 $\\,50\\,$ 次后停止。在此模型中，雅可比矩阵是常数，因此从初始猜测开始，一步即可收敛。\n4. 如果 $\\,m^{\\text{tr}}0\\,$，则计算 $\\,\\mathbf{N} = \\operatorname{dev}\\mathbf{M}^{\\text{tr}}/m^{\\text{tr}}\\,$，否则设置 $\\,\\mathbf{N}=\\mathbf{0}\\,$。\n5. 通过特征分解计算对称矩阵 $\\,\\Delta\\gamma\\,c\\,\\mathbf{N}\\,$ 的主矩阵指数，并用其更新 $\\,\\mathbf{F}^p_{n+1} = \\exp\\!\\big(\\Delta\\gamma\\,c\\,\\mathbf{N}\\big)\\,\\mathbf{F}^p_n\\,$。\n6. 报告三元组 $\\,\\big[\\Delta\\gamma,\\ \\det(\\mathbf{F}^p_{n+1}),\\ |f(\\Delta\\gamma)|\\big]\\,$。\n\n物理和数值单位：\n- 将 $\\,\\Delta\\gamma\\,$ 和 $\\,\\det(\\mathbf{F}^p_{n+1})\\,$ 作为无量纲量报告。\n- 将残差大小 $\\,|f(\\Delta\\gamma)|\\,$ 以帕斯卡为单位报告，形式为浮点数，程序不打印明确的单位符号。\n\n不使用角度单位。\n\n测试套件：\n使用以下三个测试用例。在每个用例中，$\\,\\mathbf{F}^p_n = \\mathbf{I}\\,$，即单位矩阵。所有类应力输入的单位均为帕斯卡，且 $\\,\\Delta t = 1\\,\\text{s}\\,$。\n- 用例1（塑性，中等硬化）：$\\,\\mu = 80\\times 10^9\\,$，$\\,H = 1.2\\times 10^9\\,$，$\\,\\sigma_{y0} = 400\\times 10^6\\,$，$\\,\\varepsilon^p_n = 0.01\\,$，以及\n$$\n\\operatorname{dev}\\mathbf{M}^{\\text{tr}} =\n\\begin{bmatrix}\n520\\times 10^6  60\\times 10^6  0\\\\\n60\\times 10^6  -300\\times 10^6  0\\\\\n0  0  -220\\times 10^6\n\\end{bmatrix}.\n$$\n- 用例2（弹性，低于屈服点）：$\\,\\mu = 80\\times 10^9\\,$，$\\,H = 1.2\\times 10^9\\,$，$\\,\\sigma_{y0} = 400\\times 10^6\\,$，$\\,\\varepsilon^p_n = 0.02\\,$，以及\n$$\n\\operatorname{dev}\\mathbf{M}^{\\text{tr}} =\n\\begin{bmatrix}\n200\\times 10^6  20\\times 10^6  0\\\\\n20\\times 10^6  -120\\times 10^6  0\\\\\n0  0  -80\\times 10^6\n\\end{bmatrix}.\n$$\n- 用例3（塑性，接近阈值）：$\\,\\mu = 60\\times 10^9\\,$，$\\,H = 0.5\\times 10^9\\,$，$\\,\\sigma_{y0} = 250\\times 10^6\\,$，$\\,\\varepsilon^p_n = 0.0\\,$，以及\n$$\n\\operatorname{dev}\\mathbf{M}^{\\text{tr}} =\n\\begin{bmatrix}\n220\\times 10^6  0  0\\\\\n0  -110\\times 10^6  0\\\\\n0  0  -110\\times 10^6\n\\end{bmatrix}.\n$$\n\n最终输出格式：\n你的程序应生成单行输出，其中包含三个用例的结果，聚合为一个以逗号分隔的 Python 风格的列表之列表：\n$$\n\\big[\\,[\\Delta\\gamma_1,\\ \\det(\\mathbf{F}^p_{n+1}^{(1)}),\\ |f(\\Delta\\gamma_1)|],\\ [\\Delta\\gamma_2,\\ \\det(\\mathbf{F}^p_{n+1}^{(2)}),\\ |f(\\Delta\\gamma_2)|],\\ [\\Delta\\gamma_3,\\ \\det(\\mathbf{F}^p_{n+1}^{(3)}),\\ |f(\\Delta\\gamma_3)|]\\,\\big].\n$$\n打印的行必须只有一行，不含任何附加文本。", "solution": "在尝试给出解答之前，需对问题进行验证。\n\n### 第 1 步：提取已知条件\n问题为一个有限应变关联塑性模型提供了以下定义、方程和数据：\n- **分解**：$\\mathbf{F} = \\mathbf{F}^e \\mathbf{F}^p$。\n- **塑性势**：$g(\\mathbf{M}) = \\sqrt{\\tfrac{3}{2}}\\,\\|\\operatorname{dev}\\mathbf{M}\\|_F$，其中 $\\operatorname{dev}\\mathbf{A} = \\mathbf{A} - \\tfrac{1}{3}\\operatorname{tr}(\\mathbf{A})\\mathbf{I}$。\n- **流动法则**：$\\mathbf{L}^p = \\mathbf{D}^p = \\dot{\\gamma}\\,\\dfrac{\\partial g}{\\partial \\mathbf{M}}$，其中当 $\\operatorname{dev}\\mathbf{M}\\neq\\mathbf{0}$ 时，$\\dfrac{\\partial g}{\\partial \\mathbf{M}} = \\sqrt{\\tfrac{3}{2}}\\,\\dfrac{\\operatorname{dev}\\mathbf{M}}{\\|\\operatorname{dev}\\mathbf{M}\\|_F}$。\n- **硬化定律**：$\\sigma_y(\\varepsilon^p) = \\sigma_{y0} + H\\,\\varepsilon^p$。\n- **更新法则**：$\\mathbf{F}^p_{n+1} = \\exp\\!\\big(\\Delta t\\,\\mathbf{L}^p_{n+1}\\big)\\,\\mathbf{F}^p_n$。\n- **应变增量**：$\\Delta\\varepsilon^p = \\Delta\\gamma$。\n- **径向返回**：$\\|\\operatorname{dev}\\mathbf{M}_{n+1}\\|_F = m^{\\text{tr}} - 2\\mu\\,\\Delta\\gamma$，其中 $m^{\\text{tr}} = \\|\\operatorname{dev}\\mathbf{M}^{\\text{tr}}\\|_F$。\n- **关于 $\\Delta\\gamma$ 的一致性方程**：$f(\\Delta\\gamma) = c\\big(m^{\\text{tr}} - 2\\mu\\,\\Delta\\gamma\\big) - \\big(\\sigma_{y0} + H(\\varepsilon^p_n + \\Delta\\gamma)\\big) = 0$，其中 $c = \\sqrt{\\tfrac{3}{2}}$。\n- **一致线性化**：$\\dfrac{df}{d\\Delta\\gamma} = -2\\mu\\,c - H$。\n- **流动方向**：$\\mathbf{N}_{n+1} = \\dfrac{\\operatorname{dev}\\mathbf{M}_{n+1}}{\\|\\operatorname{dev}\\mathbf{M}_{n+1}\\|_F}$，近似为 $\\mathbf{N}_{n+1} \\approx \\dfrac{\\operatorname{dev}\\mathbf{M}^{\\text{tr}}}{m^{\\text{tr}}}$。\n- **塑性变形梯度更新**：$\\mathbf{F}^p_{n+1} = \\exp\\!\\big(\\Delta\\gamma\\,c\\,\\mathbf{N}_{n+1}\\big)\\,\\mathbf{F}^p_n$。\n- **牛顿迭代**：初始猜测 $\\Delta\\gamma^{(0)} = 0$，容差 $|f(\\Delta\\gamma)| \\le 10^{-9}$，最大迭代次数 $50$。\n- **初始条件**：对于所有测试用例，$\\mathbf{F}^p_n = \\mathbf{I}$。\n- **测试用例 1**：$\\mu = 80\\times 10^9$，$H = 1.2\\times 10^9$，$\\sigma_{y0} = 400\\times 10^6$，$\\varepsilon^p_n = 0.01$，$\\operatorname{dev}\\mathbf{M}^{\\text{tr}} = [[520, 60, 0], [60, -300, 0], [0, 0, -220]] \\times 10^6$。所有量均采用国际单位制。\n- **测试用例 2**：$\\mu = 80\\times 10^9$，$H = 1.2\\times 10^9$，$\\sigma_{y0} = 400\\times 10^6$，$\\varepsilon^p_n = 0.02$，$\\operatorname{dev}\\mathbf{M}^{\\text{tr}} = [[200, 20, 0], [20, -120, 0], [0, 0, -80]] \\times 10^6$。\n- **测试用例 3**：$\\mu = 60\\times 10^9$，$H = 0.5\\times 10^9$，$\\sigma_{y0} = 250\\times 10^6$，$\\varepsilon^p_n = 0.0$，$\\operatorname{dev}\\mathbf{M}^{\\text{tr}} = [[220, 0, 0], [0, -110, 0], [0, 0, -110]] \\times 10^6$。\n\n### 第 2 步：使用提取的已知条件进行验证\n根据指定标准对问题进行验证。\n- **科学基础**：问题描述了一个标准返回映射算法，适用于具有线性各向同性硬化的率无关有限应变 $J_2$ 塑性。乘法分解、关联流动法则、指数映射和后向欧拉积分方案都是计算连续介质力学中的标准且成熟的概念。\n- **适定性**：该问题是适定的。使用基于单个标量一致性方程 $\\Delta\\gamma$ 的试探状态和校正步可得到唯一且稳定的解。所提供的一致线性化是正确的，确保了牛顿求解器的收敛性。\n- **客观性**：问题使用精确的数学和物理术语陈述，没有歧义或主观论断。\n- **独立性与一致性**：为每个测试用例提供了所有必需的参数、方程和初始条件。该公式是内部一致的；例如，在指数映射中使用偏张量正确地确保了塑性不可压缩性，因为 $\\det(\\exp(\\mathbf{A})) = \\exp(\\operatorname{tr}(\\mathbf{A}))$，且此处 $\\operatorname{tr}(\\Delta\\gamma\\,c\\,\\mathbf{N}) = 0$。\n- **非不切实际或过于简单**：材料参数和应力值在金属材料的实际范围内。该问题需要进行不简单的矩阵计算（Frobenius 范数、特征分解、矩阵指数）和塑性算法的正确实现，使其成为一项实质性任务。\n\n### 第 3 步：结论与行动\n该问题是**有效的**。它是计算固体力学中一个标准的、定义明确的练习。将提供一个解决方案。\n\n对每个测试用例，算法流程如下。\n首先，计算常数 $c = \\sqrt{\\tfrac{3}{2}}$。根据问题陈述定义材料属性 $\\mu$、$H$、$\\sigma_{y0}$ 和状态变量 $\\varepsilon^p_n$ 与 $\\operatorname{dev}\\mathbf{M}^{\\text{tr}}$。初始塑性变形梯度是单位矩阵，$\\mathbf{F}^p_n = \\mathbf{I}$。\n\n算法的核心是弹塑性预测-校正方案。\n预测步已经执行，得到了试探偏 Mandel 应力 $\\operatorname{dev}\\mathbf{M}^{\\text{tr}}$。接下来的步骤是检查是否发生塑性屈服。\n计算试探偏 Mandel 应力的 Frobenius 范数，$m^{\\text{tr}} = \\|\\operatorname{dev}\\mathbf{M}^{\\text{tr}}\\|_F$。\n评估试探屈服函数，它衡量试探状态违反屈服条件的程度：\n$$\n\\phi^{\\text{tr}} = c\\,m^{\\text{tr}} - \\sigma_y(\\varepsilon^p_n) = c\\,m^{\\text{tr}} - (\\sigma_{y0} + H\\,\\varepsilon^p_n).\n$$\n如果 $\\phi^{\\text{tr}} \\le 0$，则试探状态是允许的（弹性或在屈服面上）。该步是弹性的，意味着没有塑性流动。因此，塑性一致性增量为零，$\\Delta\\gamma = 0$。塑性变形梯度不改变，$\\mathbf{F}^p_{n+1} = \\mathbf{F}^p_n$。塑性一致性方程的残差取为零，因为该方程未被激活。\n\n如果 $\\phi^{\\text{tr}}  0$，则试探状态是不可允许的，位于屈服面之外。需要一个塑性校正步将应力状态返回到更新后的屈服面上。这涉及到求解塑性乘子增量 $\\Delta\\gamma$ 的标量一致性方程：\n$$\nf(\\Delta\\gamma) = c\\big(m^{\\text{tr}} - 2\\mu\\,\\Delta\\gamma\\big) - \\big(\\sigma_{y0} + H(\\varepsilon^p_n + \\Delta\\gamma)\\big) = 0.\n$$\n该方程对 $\\Delta\\gamma$ 是线性的。尽管指定了牛顿迭代法，但由于导数 $\\dfrac{df}{d\\Delta\\gamma} = -2\\mu\\,c - H$ 是常数，从初始猜测 $\\Delta\\gamma^{(0)} = 0$ 出发，一步即可获得精确解：\n$$\n\\Delta\\gamma = \\Delta\\gamma^{(0)} - \\frac{f(\\Delta\\gamma^{(0)})}{\\frac{df}{d\\Delta\\gamma}} = 0 - \\frac{\\phi^{\\text{tr}}}{-2\\mu\\,c - H} = \\frac{\\phi^{\\text{tr}}}{2\\mu\\,c + H}.\n$$\n对于这个 $\\Delta\\gamma$ 值，残差 $|f(\\Delta\\gamma)|$ 将在机器精度范围内为零。\n\n一旦确定了 $\\Delta\\gamma$，就更新塑性变形梯度。流动方向张量 $\\mathbf{N}$ 从试探状态计算得出：\n$$\n\\mathbf{N} = \\frac{\\operatorname{dev}\\mathbf{M}^{\\text{tr}}}{m^{\\text{tr}}}.\n$$\n矩阵指数的参数是对称张量 $\\mathbf{A} = \\Delta\\gamma\\,c\\,\\mathbf{N}$。更新后的塑性变形梯度则为：\n$$\n\\mathbf{F}^p_{n+1} = \\exp(\\mathbf{A})\\,\\mathbf{F}^p_n.\n$$\n由于 $\\mathbf{F}^p_n = \\mathbf{I}$，这简化为 $\\mathbf{F}^p_{n+1} = \\exp(\\mathbf{A})$。对称矩阵 $\\mathbf{A}$ 的矩阵指数通过其谱分解计算。设 $\\mathbf{A} = \\mathbf{V}\\mathbf{\\Lambda}\\mathbf{V}^T$，其中 $\\mathbf{\\Lambda}$ 是特征值的对角矩阵，$\\mathbf{V}$ 是相应正交归一特征向量的矩阵。那么：\n$$\n\\exp(\\mathbf{A}) = \\mathbf{V}\\exp(\\mathbf{\\Lambda})\\mathbf{V}^T,\n$$\n其中 $\\exp(\\mathbf{\\Lambda})$ 是对 $\\mathbf{A}$ 的特征值取指数后形成的对角矩阵。\n\n最后，计算所得 $\\mathbf{F}^p_{n+1}$ 的行列式。作为检验，由于 $\\operatorname{tr}(\\mathbf{N})=0$，必然有 $\\operatorname{tr}(\\mathbf{A})=0$，这意味着 $\\det(\\mathbf{F}^p_{n+1}) = \\det(\\exp(\\mathbf{A})) = \\exp(\\operatorname{tr}(\\mathbf{A})) = \\exp(0) = 1$，这证实了流动法则的塑性不可压缩性。\n\n每个测试用例的最终结果是三元组 $[\\Delta\\gamma, \\det(\\mathbf{F}^p_{n+1}), |f(\\Delta\\gamma)|]$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the plastic update in a finite-strain J2 plasticity model\n    for three given test cases.\n    \"\"\"\n    \n    # Define test cases\n    test_cases = [\n        {\n            \"mu\": 80e9, \"H\": 1.2e9, \"sigma_y0\": 400e6, \"eps_p_n\": 0.01,\n            \"dev_M_tr\": np.array([\n                [520e6, 60e6, 0],\n                [60e6, -300e6, 0],\n                [0, 0, -220e6]\n            ])\n        },\n        {\n            \"mu\": 80e9, \"H\": 1.2e9, \"sigma_y0\": 400e6, \"eps_p_n\": 0.02,\n            \"dev_M_tr\": np.array([\n                [200e6, 20e6, 0],\n                [20e6, -120e6, 0],\n                [0, 0, -80e6]\n            ])\n        },\n        {\n            \"mu\": 60e9, \"H\": 0.5e9, \"sigma_y0\": 250e6, \"eps_p_n\": 0.0,\n            \"dev_M_tr\": np.array([\n                [220e6, 0, 0],\n                [0, -110e6, 0],\n                [0, 0, -110e6]\n            ])\n        }\n    ]\n\n    results = []\n    \n    # Constant c from the plastic potential\n    c = np.sqrt(3.0 / 2.0)\n\n    for case in test_cases:\n        mu = case[\"mu\"]\n        H = case[\"H\"]\n        sigma_y0 = case[\"sigma_y0\"]\n        eps_p_n = case[\"eps_p_n\"]\n        dev_M_tr = case[\"dev_M_tr\"]\n        Fp_n = np.identity(3)\n\n        # 1. Compute trial quantities\n        m_tr = np.linalg.norm(dev_M_tr, 'fro')\n        sigma_y_n = sigma_y0 + H * eps_p_n\n        phi_tr = c * m_tr - sigma_y_n\n\n        delta_gamma = 0.0\n        residual = 0.0\n        det_Fp_n1 = 1.0\n\n        # 2. Check for plastic loading\n        if phi_tr > 0:\n            # 3. Plastic step: solve for delta_gamma\n            # The consistency equation is linear, so one Newton step from gamma=0 is exact.\n            # df/d(gamma) is constant.\n            df_d_gamma = -2.0 * mu * c - H\n            # Per problem, phi_tr = f(delta_gamma=0). So delta_gamma = -f(0)/f'(0)\n            delta_gamma = -phi_tr / df_d_gamma\n            \n            # The residual of the linear solver should be near zero.\n            # We can calculate it for confirmation.\n            f_val = c * (m_tr - 2.0 * mu * delta_gamma) - (sigma_y0 + H * (eps_p_n + delta_gamma))\n            residual = np.abs(f_val)\n            \n            # 4. Compute flow direction N\n            N = np.zeros((3, 3))\n            if m_tr > 1e-12:  # Avoid division by zero\n                N = dev_M_tr / m_tr\n            \n            # 5. Update Fp using matrix exponential via eigen-decomposition\n            exp_arg = delta_gamma * c * N\n            \n            # Matrix is symmetric, use eigh for stability and performance\n            eigenvalues, eigenvectors = np.linalg.eigh(exp_arg)\n            \n            # exp(A) = V * exp(D) * V^T\n            exp_D = np.diag(np.exp(eigenvalues))\n            exp_A = eigenvectors @ exp_D @ eigenvectors.T\n            \n            Fp_n1 = exp_A @ Fp_n\n            det_Fp_n1 = np.linalg.det(Fp_n1)\n\n        else:\n            # 2. Elastic step\n            delta_gamma = 0.0\n            residual = 0.0 # No equation to solve, so residual is zero\n            Fp_n1 = Fp_n\n            det_Fp_n1 = np.linalg.det(Fp_n1)\n\n        # 6. Report the results for the current case\n        results.append([delta_gamma, det_Fp_n1, residual])\n\n    # Format the final output string as specified\n    output_str = \"[\"\n    for i, res in enumerate(results):\n        output_str += f\"[{res[0]}, {res[1]}, {res[2]}]\"\n        if i  len(results) - 1:\n            output_str += \", \"\n    output_str += \"]\"\n    \n    print(output_str.replace(\" \", \"\"))\n\nsolve()\n\n```", "id": "2671030"}]}