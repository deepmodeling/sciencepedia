{"hands_on_practices": [{"introduction": "本练习聚焦于计算塑性力学中的一个基本步骤：屈服检查。在数值模拟中，我们首先假设材料行为是弹性的，从而预测一个“试探”应力状态。本练习要求您针对这一试探状态，同时考虑运动硬化和各向同性硬化，计算 von Mises 屈服函数的值，以判断是否发生塑性变形。掌握这一检查是实现更复杂的塑性修正算法的入门关键。[@problem_id:2652037]", "problem": "一个金属试件采用基于 von Mises（偏应力张量的第二不变量，$J_{2}$）屈服准则的率无关塑性模型进行建模，该模型包含组合各向同性-随动硬化。在时间步 $n$，内变量是已知的。弹性预测步产生一个沿加载轴的单轴试探柯西应力 $ \\sigma^{tr} $。随动硬化状态由与加载轴方向一致的背应力幅值 $ \\alpha^{n} $ 表示，各向同性硬化状态由当前屈服应力 $ \\sigma_{y}(\\kappa^{n}) $ 表示。你需要使用与 $J_{2}$ 塑性理论和组合硬化相关的有效应力概念，评估试探状态下的屈服情况。\n\n数据：\n- 试探应力：$ \\sigma^{tr} = 512 \\,\\text{MPa} $。\n- 背应力幅值：$ \\alpha^{n} = 68 \\,\\text{MPa} $。\n- 当前屈服应力：$ \\sigma_{y}(\\kappa^{n}) = 430 \\,\\text{MPa} $。\n\n任务：\n1. 使用 $J_{2}$ 塑性理论的基本原理以及背应力在组合硬化中的作用，计算试探状态下的屈服函数值。该值定义为有效（von Mises）应力与当前屈服应力之差，计算时需考虑由随动硬化引起的屈服面平移。\n2. 根据此屈服函数的符号，判断是否需要进行塑性修正（返回映射）。\n\n以兆帕（MPa）为单位表示屈服函数的最终数值。无需四舍五入。你的最终答案必须是一个实数。", "solution": "问题陈述已经过评估，被认为是有效的。它在科学上基于连续介质塑性力学的原理，是适定的，提供了所有必要的信息，并且表述客观。我们可以开始求解。\n\n该问题要求在包含组合各向同性和随动硬化的 $J_2$ 塑性力学框架内，评估试探应力状态下的屈服条件。屈服函数（用 $f$ 表示）定义了应力空间中弹性域的边界。对于组合硬化，该函数用柯西应力张量 $\\boldsymbol{\\sigma}$、背应力张量 $\\boldsymbol{\\alpha}$ 和一个表示屈服面大小的标量变量 $\\sigma_y$ 来表示，$\\sigma_y$ 是一个内硬化变量（例如等效塑性应变 $\\kappa$）的函数。\n\n组合硬化的 von Mises 屈服准则的一般形式为：\n$$f(\\boldsymbol{\\sigma}, \\boldsymbol{\\alpha}, \\kappa) = \\sigma_{eq}(\\boldsymbol{\\sigma} - \\boldsymbol{\\alpha}) - \\sigma_y(\\kappa) \\le 0$$\n其中 $\\sigma_{eq}$ 表示 von Mises 等效应力。张量 $\\boldsymbol{\\xi} = \\boldsymbol{\\sigma} - \\boldsymbol{\\alpha}$ 被称为有效应力张量。如果 $f \\le 0$，则状态为弹性或处于屈服面上。如果 $f > 0$，则该状态是不可接受的，会发生塑性流动。\n\n在计算塑性力学的背景下，首先执行弹性预测步以获得试探应力状态 $\\boldsymbol{\\sigma}^{tr}$。然后，使用来自前一个收敛时间步 $n$ 的内变量，在该试探状态下评估屈服函数。\n$$f^{tr} = \\sigma_{eq}(\\boldsymbol{\\sigma}^{tr} - \\boldsymbol{\\alpha}^{n}) - \\sigma_y(\\kappa^{n})$$\n该问题指定了沿单个加载轴的单轴应力状态。设此轴为 $1$ 轴。试探应力张量 $\\boldsymbol{\\sigma}^{tr}$ 只有一个非零分量 $\\sigma_{11} = \\sigma^{tr}$。类似地，背应力张量 $\\boldsymbol{\\alpha}^{n}$ 与加载轴方向一致，因此其唯一的非零分量是 $\\alpha_{11} = \\alpha^{n}$。\n\n试探状态下的有效应力张量 $\\boldsymbol{\\xi}^{tr} = \\boldsymbol{\\sigma}^{tr} - \\boldsymbol{\\alpha}^{n}$ 也是单轴的，其唯一的非零分量为：\n$$\\xi_{11}^{tr} = \\sigma^{tr} - \\alpha^{n}$$\n对于任何只有一个非零分量 $T_{11}$ 的单轴应力张量 $\\mathbf{T}$，其 von Mises 等效应力 $\\sigma_{eq}(\\mathbf{T})$ 简化为该分量的绝对值 $|T_{11}|$。因此，试探状态下的有效 von Mises 应力为：\n$$\\sigma_{eq}^{tr} = |\\sigma^{tr} - \\alpha^{n}|$$\n现在，我们可以使用所提供的数据计算试探状态下的屈服函数值。\n\n给定数据：\n- 试探应力：$\\sigma^{tr} = 512 \\, \\text{MPa}$。\n- 在时间步 $n$ 的背应力幅值：$\\alpha^{n} = 68 \\, \\text{MPa}$。\n- 在时间步 $n$ 的当前屈服应力：$\\sigma_{y}(\\kappa^{n}) = 430 \\, \\text{MPa}$。\n\n首先，我们计算有效应力分量：\n$$\\sigma^{tr} - \\alpha^{n} = 512 - 68 = 444 \\, \\text{MPa}$$\n接下来，我们计算有效 von Mises 应力：\n$$\\sigma_{eq}^{tr} = |444| = 444 \\, \\text{MPa}$$\n最后，我们评估试探状态下的屈服函数：\n$$f^{tr} = \\sigma_{eq}^{tr} - \\sigma_y(\\kappa^{n})$$\n$$f^{tr} = 444 - 430 = 14 \\, \\text{MPa}$$\n试探状态下屈服函数的值为 $14 \\, \\text{MPa}$。\n\n第二个任务是判断是否需要进行塑性修正。该决定基于 $f^{tr}$ 的符号：\n- 如果 $f^{tr} \\le 0$，则试探状态位于屈服面内部或其上。该步是弹性的，无需修正。应力状态更新为 $\\boldsymbol{\\sigma}^{n+1} = \\boldsymbol{\\sigma}^{tr}$。\n- 如果 $f^{tr} > 0$，则试探状态位于屈服面之外，这在物理上是不可接受的。此时发生塑性变形，必须采用返回映射算法将应力状态拉回到更新后的屈服面上。\n\n在本例中，我们计算出 $f^{tr} = 14 \\, \\text{MPa}$，该值大于 $0$。\n$$f^{tr} = 14 > 0$$\n因此，需要进行塑性修正。弹性预测步高估了应力，有必要通过返回映射程序来计算正确的应力并更新当前时间步的塑性内变量。", "answer": "$$\n\\boxed{14}\n$$", "id": "2652037"}, {"introduction": "在单步检查的基础上，本练习要求您分析性地追踪材料在经历一个完整加载-卸载循环时的应力-应变响应。通过手动计算应力($\\sigma$)、背应力($\\alpha$)和各向同性硬化变量($\\kappa$)的演化过程，您将对组合硬化模型如何捕捉包申格效应等现象获得深刻的直观理解。这种纸笔推演为您构建稳健的数值实现方案奠定了坚实的逻辑基础。[@problem_id:2652033]", "problem": "一个由金属合金制成的率无关、小应变单轴试件，其模型为各向同性线弹性与经典 von Mises (也称 $J_{2}$) 塑性理论的结合，包含关联流动、线性随动硬化 (Prager 法则) 和线性各向同性硬化。设弹性模量为 $E = 210 \\times 10^{3} \\ \\mathrm{MPa}$，初始屈服应力为 $\\sigma_{y0} = 250 \\ \\mathrm{MPa}$，随动硬化模量为 $H_{\\mathrm{kin}} = 4000 \\ \\mathrm{MPa}$，各向同性硬化模量为 $H_{\\mathrm{iso}} = 600 \\ \\mathrm{MPa}$。初始状态为无应力、无塑性应变，且背应力和各向同性硬化变量均为零。\n\n一个指定的单轴应变历史被准静态地施加，过程如下：从 $\\varepsilon = 0$ 开始，轴向应变单调增加至 $\\varepsilon = 0.006$，然后单调减少至 $\\varepsilon = -0.002$。假设小应变运动学 $\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$，线弹性关系 $\\sigma = E \\, \\varepsilon^{e}$，带有随动和各向同性硬化的 von Mises 屈服条件的单轴简化形式，以及关联流动法则。使用与这些定义一致的标量简化单轴方程，计算在整个历史过程中背应力 $\\alpha(\\varepsilon)$、各向同性硬化变量 $\\kappa(\\varepsilon)$ 和轴向 Cauchy 应力 $\\sigma(\\varepsilon)$ 的演化，并确定弹性和塑性阶段以及发生反向屈服的转向点。\n\n仅报告加载程序结束时，即在 $\\varepsilon = -0.002$ 时的最终轴向 Cauchy 应力。应力以 $\\mathrm{MPa}$ 为单位表示，并将您的答案四舍五入至四位有效数字。", "solution": "首先对问题进行验证。\n\n步骤 1: 提取已知条件\n- 材料模型: 率无关、小应变、单轴、各向同性线弹性与 von Mises ($J_2$) 塑性。\n- 硬化模型: 组合线性随动硬化 (Prager 法则) 和线性各向同性硬化。\n- 弹性模量: $E = 210 \\times 10^{3} \\ \\mathrm{MPa}$。\n- 初始屈服应力: $\\sigma_{y0} = 250 \\ \\mathrm{MPa}$。\n- 随动硬化模量: $H_{\\mathrm{kin}} = 4000 \\ \\mathrm{MPa}$。\n- 各向同性硬化模量: $H_{\\mathrm{iso}} = 600 \\ \\mathrm{MPa}$。\n- 初始条件: 无应力、无塑性应变、零背应力、零各向同性硬化。\n- 应变历史: 从 $\\varepsilon = 0$ 单调增加至 $\\varepsilon = 0.006$，然后单调减少至 $\\varepsilon = -0.002$。\n- 运动学: 小应变, $\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$。\n- 本构关系: $\\sigma = E \\, \\varepsilon^{e}$，关联流动法则。\n\n步骤 2: 使用提取的已知条件进行验证\n该问题在科学上是合理的、适定的、客观的和完整的。它描述了塑性理论中的一个标准问题，该理论是固体力学的一个子领域。所有必要的参数和初始/边界条件都已提供。该模型是一个经典模型（带有组合硬化的 von Mises 塑性），要求是将其应用于一个简单的单轴加载路径。该问题没有违反任何科学原理，没有歧义，并且与塑性中的硬化模型主题直接相关。\n\n步骤 3: 结论与行动\n问题有效。将提供解答。\n\n该问题要求计算一个经历指定单轴应变历史的试件的最终应力。材料行为由线弹性和带有组合线性各向同性硬化与随动硬化的 $J_2$ 塑性理论支配。\n\n单轴情况下的基本方程如下：\n1.  应变的加法分解: $\\varepsilon = \\varepsilon^e + \\varepsilon^p$，其中 $\\varepsilon$ 是总应变，$\\varepsilon^e$ 是弹性应变，$\\varepsilon^p$ 是塑性应变。\n2.  线弹性定律: $\\sigma = E \\varepsilon^e = E(\\varepsilon - \\varepsilon^p)$。\n3.  屈服条件: 带有组合硬化的 von Mises 准则简化为 $f(\\sigma, \\alpha, \\kappa) = |\\sigma - \\alpha| - (\\sigma_{y0} + \\kappa) \\le 0$，其中 $\\alpha$ 是背应力，$\\kappa$ 是各向同性硬化变量（相当于屈服应力的增加量）。\n4.  硬化法则：\n    -   随动硬化 (Prager 法则): $\\dot{\\alpha} = H_{\\mathrm{kin}} \\dot{\\varepsilon}^p$。\n    -   各向同性硬化: $\\dot{\\kappa} = H_{\\mathrm{iso}} \\dot{\\bar{\\varepsilon}}^p$，其中 $\\dot{\\bar{\\varepsilon}}^p = |\\dot{\\varepsilon}^p|$ 是等效塑性应变率。\n5.  流动法则: 关联流动意味着 $\\dot{\\varepsilon}^p = \\dot{\\lambda} \\operatorname{sgn}(\\sigma - \\alpha)$，其中 $\\dot{\\lambda} \\ge 0$ 是塑性乘子。Kuhn-Tucker 条件适用：$\\dot{\\lambda} \\ge 0$，$f \\le 0$，$\\dot{\\lambda}f = 0$。\n\n根据施加的应变历史分段进行分析。\n\n第一部分：从 $\\varepsilon = 0$到 $\\varepsilon_1 = 0.006$ 的单调加载。\n\n阶段 A：弹性加载 ($0 \\le \\varepsilon \\le \\varepsilon_y$)\n初始时，$\\varepsilon^p = 0$，$\\alpha = 0$，$\\kappa = 0$。响应是弹性的：$\\sigma = E\\varepsilon$。\n当 $|\\sigma| = \\sigma_{y0}$ 时开始屈服。由于是拉伸加载，这发生在 $\\sigma = \\sigma_{y0}$ 时。相应的屈服应变为：\n$$ \\varepsilon_y = \\frac{\\sigma_{y0}}{E} = \\frac{250}{210 \\times 10^3} = \\frac{1}{840} \\approx 0.00119 $$\n由于 $\\varepsilon_1 = 0.006 > \\varepsilon_y$，将会发生塑性变形。\n\n阶段 B：塑性加载 ($\\varepsilon_y < \\varepsilon \\le \\varepsilon_1 = 0.006$)\n在此阶段，屈服准则是激活的：$\\sigma - \\alpha = \\sigma_{y0} + \\kappa$。对一个类时参数求导可得 $\\dot{\\sigma} - \\dot{\\alpha} = \\dot{\\kappa}$。\n对于拉伸塑性加载，$\\dot{\\varepsilon}^p > 0$，因此 $\\dot{\\bar{\\varepsilon}}^p = \\dot{\\varepsilon}^p$。硬化率为 $\\dot{\\alpha} = H_{\\mathrm{kin}}\\dot{\\varepsilon}^p$ 和 $\\dot{\\kappa} = H_{\\mathrm{iso}}\\dot{\\varepsilon}^p$。\n应力率为 $\\dot{\\sigma} = E(\\dot{\\varepsilon} - \\dot{\\varepsilon}^p)$。\n将这些代入一致性条件：\n$$ E(\\dot{\\varepsilon} - \\dot{\\varepsilon}^p) - H_{\\mathrm{kin}}\\dot{\\varepsilon}^p = H_{\\mathrm{iso}}\\dot{\\varepsilon}^p $$\n$$ E\\dot{\\varepsilon} = (E + H_{\\mathrm{kin}} + H_{\\mathrm{iso}})\\dot{\\varepsilon}^p $$\n塑性应变率为 $\\dot{\\varepsilon}^p = \\frac{E}{E + H}\\dot{\\varepsilon}$，其中 $H = H_{\\mathrm{kin}} + H_{\\mathrm{iso}}$。\n塑性区的切线模量是 $E_T = \\frac{d\\sigma}{d\\varepsilon} = E(1 - \\frac{\\dot{\\varepsilon}^p}{\\dot{\\varepsilon}}) = E(1 - \\frac{E}{E+H}) = \\frac{EH}{E+H}$。\n让我们计算在反向点 $\\varepsilon_1 = 0.006$ 时的状态值：\n$H = 4000 + 600 = 4600 \\ \\mathrm{MPa}$。\n$E+H = 210000 + 4600 = 214600 \\ \\mathrm{MPa}$。\n$E_T = \\frac{210000 \\times 4600}{214600} \\approx 4501.4 \\ \\mathrm{MPa}$。\n在 $\\varepsilon_1$ 处的应力为：\n$$ \\sigma_1 = \\sigma_{y0} + E_T (\\varepsilon_1 - \\varepsilon_y) = 250 + \\frac{210000 \\times 4600}{214600} \\left(0.006 - \\frac{250}{210000}\\right) $$\n$$ \\sigma_1 = 250 + \\left(\\frac{4830000}{1073}\\right) \\left(\\frac{101}{21000}\\right) = 250 + \\frac{23230}{1073} = \\frac{291480}{1073} \\approx 271.65 \\ \\mathrm{MPa} $$\n该点的总塑性应变通过对塑性应变率积分得到：\n$$ \\varepsilon_1^p = \\int_{\\varepsilon_y}^{\\varepsilon_1} \\frac{E}{E+H} d\\varepsilon = \\frac{E}{E+H} (\\varepsilon_1 - \\varepsilon_y) = \\frac{210000}{214600} \\left(0.006 - \\frac{1}{840}\\right) = \\frac{101}{21460} \\approx 0.0047064 $$\n反向时的内部状态变量为：\n$$ \\alpha_1 = H_{\\mathrm{kin}} \\varepsilon_1^p = 4000 \\left(\\frac{101}{21460}\\right) = \\frac{20200}{1073} \\approx 18.83 \\ \\mathrm{MPa} $$\n$$ \\kappa_1 = H_{\\mathrm{iso}} \\varepsilon_1^p = 600 \\left(\\frac{101}{21460}\\right) = \\frac{3030}{1073} \\approx 2.82 \\ \\mathrm{MPa} $$\n\n第二部分：从 $\\varepsilon_1 = 0.006$ 到 $\\varepsilon_f = -0.002$ 的单调卸载。\n\n阶段 C：弹性卸载 ($\\varepsilon_{ry} < \\varepsilon \\le \\varepsilon_1$)\n反向加载时，材料弹性卸载。塑性应变和内部变量保持不变：$\\varepsilon^p = \\varepsilon_1^p$，$\\alpha = \\alpha_1$，$\\kappa = \\kappa_1$。\n应力-应变关系为 $\\sigma - \\sigma_1 = E(\\varepsilon - \\varepsilon_1)$。\n当屈服准则在压缩状态下满足时，发生反向屈服：$\\sigma - \\alpha_1 = -(\\sigma_{y0} + \\kappa_1)$。\n反向屈服时的应力 $\\sigma_{ry}$ 为：\n$$ \\sigma_{ry} = \\alpha_1 - (\\sigma_{y0} + \\kappa_1) = \\frac{20200}{1073} - \\left(250 + \\frac{3030}{1073}\\right) = \\frac{17170}{1073} - 250 = -\\frac{251080}{1073} \\approx -234.00 \\ \\mathrm{MPa} $$\n弹性应力范围的大小为 $\\sigma_1 - \\sigma_{ry} = 2(\\sigma_{y0} + \\kappa_1) = 2(250 + \\frac{3030}{1073}) = \\frac{542560}{1073} \\approx 505.65 \\ \\mathrm{MPa}$。\n反向屈服时的应变 $\\varepsilon_{ry}$ 为：\n$$ \\varepsilon_{ry} = \\varepsilon_1 + \\frac{\\sigma_{ry} - \\sigma_1}{E} = 0.006 - \\frac{2(\\sigma_{y0} + \\kappa_1)}{E} = 0.006 - \\frac{542560}{1073 \\times 210000} \\approx 0.006 - 0.0024078 = 0.0035922 $$\n\n阶段 D：反向塑性加载 ($\\varepsilon_f \\le \\varepsilon \\le \\varepsilon_{ry}$)\n最终目标应变为 $\\varepsilon_f = -0.002$。由于 $\\varepsilon_f < \\varepsilon_{ry}$，材料经历反向塑性流动。反向塑性流动的切线模量是相同的，$E_T = \\frac{EH}{E+H}$。\n最终应力 $\\sigma_f$ 通过从反向屈服点开始并沿塑性应力-应变路径计算得出：\n$$ \\sigma_f = \\sigma_{ry} + E_T(\\varepsilon_f - \\varepsilon_{ry}) $$\n这个塑性阶段的应变增量是 $\\Delta\\varepsilon_{pl} = \\varepsilon_f - \\varepsilon_{ry} \\approx -0.002 - 0.0035922 = -0.0055922$。\n应力增量是 $\\Delta\\sigma_{pl} = E_T \\Delta\\varepsilon_{pl} \\approx 4501.4 \\times (-0.0055922) \\approx -25.17 \\ \\mathrm{MPa}$。\n最终应力为：\n$$ \\sigma_f = \\sigma_{ry} + \\Delta\\sigma_{pl} \\approx -234.00 + (-25.17) = -259.17 \\ \\mathrm{MPa} $$\n让我们用精确分数进行计算以确保精度：\n$$ \\sigma_f = -\\frac{251080}{1073} + \\left(\\frac{210000 \\times 4600}{214600}\\right) \\left(-0.002 - \\left(0.006 - \\frac{2(\\sigma_{y0} + \\kappa_1)}{E}\\right)\\right) $$\n$$ \\sigma_f = -\\frac{251080}{1073} + E_T \\left(-0.008 + \\frac{2}{E}\\left(250 + \\frac{3030}{1073}\\right)\\right) $$\n$$ \\sigma_f = -\\frac{251080}{1073} + \\frac{4830000}{1073} \\left(-0.008 + \\frac{2}{210000}\\frac{271280}{1073}\\right) $$\n$$ \\sigma_f = -\\frac{251080}{1073} - \\frac{38640}{1073} + \\frac{4830000}{1073} \\frac{542560}{210000 \\times 1073} $$\n$$ \\sigma_f = -\\frac{289720}{1073} + \\frac{23 \\times 542560}{1073^2} = \\frac{-289720 \\times 1073 + 12478880}{1073^2} $$\n$$ \\sigma_f = \\frac{-310869560 + 12478880}{1151329} = -\\frac{298390680}{1151329} \\approx -259.17019 \\ \\mathrm{MPa} $$\n四舍五入到四位有效数字，最终轴向应力为 $-259.2 \\ \\mathrm{MPa}$。", "answer": "$$ \\boxed{-259.2} $$", "id": "2652033"}, {"introduction": "作为本章的终极实践，最后一个练习将引导您将理论转化为一个功能性的数值工具。您将为一个具有组合硬化效应的单轴材料模型实现广泛应用的“返回映射”算法。该练习弥合了分析理解与实用计算力学之间的鸿沟，使您掌握模拟复杂材料行为的一项核心技能。[@problem_id:2652024]", "problem": "针对一种具有线性各向同性硬化、线性随动硬化及其组合的弹塑性材料，实现一个小应变单轴返回映射算法（径向返回）。该问题以纯数学术语形式给出，并采用具有物理意义的单位：应力单位为兆帕 (MPa)，应变为无量纲。从加性应变分解、线性弹性和一个带有单轴屈服函数的关联率无关塑性模型出发。不要使用任何预先推导的更新捷径公式；通过在增量步末强制执行一致性条件来推导更新过程。\n\n假设在单轴小应变下具有以下本构结构：\n- 加性分解：$\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$。\n- 线性弹性：$\\sigma = E\\,\\varepsilon^{e}$，其中 $E$ 为杨氏模量。\n- 单轴形式的屈服函数：$f(\\sigma,\\alpha,\\kappa) = \\lvert \\sigma - \\alpha \\rvert - \\left(\\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa\\right)$，其中 $\\alpha$ 是随动硬化的单轴背应力，$\\kappa$ 是累积塑性应变，$\\sigma_{y}^{0}$ 是初始屈服应力，$H_{\\text{iso}}$ 是线性各向同性硬化模量。\n- 单轴形式的关联流动法则和硬化演化：$\\dot{\\varepsilon}^{p} = \\dot{\\gamma}\\,\\operatorname{sign}(\\sigma-\\alpha)$，$\\dot{\\kappa} = \\dot{\\gamma}$，以及 $\\dot{\\alpha} = C\\,\\dot{\\varepsilon}^{p}$，其中 $C$ 是线性随动硬化模量，$\\dot{\\gamma} \\ge 0$ 是强制满足 $f \\le 0$ 和 $\\dot{\\gamma} f = 0$ 的塑性乘子。\n\n给定一个从状态 $n$ 到 $n+1$ 的时间步内的应变增量 $\\Delta \\varepsilon$，以及已知的状态变量 $(\\sigma^{n}, \\varepsilon^{p\\,n}, \\kappa^{n}, \\alpha^{n})$，实现以下算法来计算 $(\\sigma^{n+1}, \\varepsilon^{p\\,n+1}, \\kappa^{n+1}, \\alpha^{n+1})$：\n\n1. 使用 $\\sigma_{\\text{tr}} = \\sigma^{n} + E\\,\\Delta \\varepsilon$ 计算弹性试探应力。\n2. 评估试探屈服函数 $f_{\\text{tr}} = \\lvert \\sigma_{\\text{tr}} - \\alpha^{n} \\rvert - \\left(\\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa^{n}\\right)$。\n3. 如果 $f_{\\text{tr}} \\le 0$（在您必须定义的数值容差范围内），则接受一个弹性步，并令 $(\\sigma^{n+1}, \\varepsilon^{p\\,n+1}, \\kappa^{n+1}, \\alpha^{n+1}) = (\\sigma_{\\text{tr}}, \\varepsilon^{p\\,n}, \\kappa^{n}, \\alpha^{n})$。\n4. 如果 $f_{\\text{tr}} > 0$，则在 $n+1$ 时刻通过关联流动和线性硬化强制执行塑性一致性，以确定塑性修正量。使用一个在增量步期间保持加载方向 $\\operatorname{sign}(\\sigma_{\\text{tr}}-\\alpha^{n})$ 不变的返回映射，并相应地更新 $(\\sigma, \\varepsilon^{p}, \\kappa, \\alpha)$。\n\n设计一个程序，将此更新应用于一组固定的测试用例。所有应力（包括背应力 $\\alpha$）必须以 $\\mathrm{MPa}$ 表示，所有应变（包括 $\\varepsilon^{p}$ 和 $\\kappa$）均为无量纲。每个测试用例的输出必须是一个包含四个浮点数的列表，按 $[\\sigma^{n+1}\\,(\\mathrm{MPa}), \\varepsilon^{p\\,n+1}, \\kappa^{n+1}, \\alpha^{n+1}\\,(\\mathrm{MPa})]$ 的顺序排列，并四舍五入到六位小数。\n\n测试套件（请精确使用以下参数值）：\n- 用例 A（仅各向同性硬化，塑性步）：$E = 210000\\,\\mathrm{MPa}$，$\\sigma_{y}^{0} = 250\\,\\mathrm{MPa}$， $H_{\\text{iso}} = 1000\\,\\mathrm{MPa}$， $C = 0\\,\\mathrm{MPa}$， $\\sigma^{n} = 0\\,\\mathrm{MPa}$， $\\varepsilon^{p\\,n} = 0$， $\\kappa^{n} = 0$， $\\alpha^{n} = 0\\,\\mathrm{MPa}$， $\\Delta \\varepsilon = 0.003$。\n- 用例 B（仅各向同性硬化，弹性步）：$E = 210000\\,\\mathrm{MPa}$，$\\sigma_{y}^{0} = 250\\,\\mathrm{MPa}$， $H_{\\text{iso}} = 1000\\,\\mathrm{MPa}$， $C = 0\\,\\mathrm{MPa}$， $\\sigma^{n} = 0\\,\\mathrm{MPa}$， $\\varepsilon^{p\\,n} = 0$， $\\kappa^{n} = 0$， $\\alpha^{n} = 0\\,\\mathrm{MPa}$， $\\Delta \\varepsilon = 0.001$。\n- 用例 C（仅随动硬化，塑性步）：$E = 210000\\,\\mathrm{MPa}$，$\\sigma_{y}^{0} = 250\\,\\mathrm{MPa}$， $H_{\\text{iso}} = 0\\,\\mathrm{MPa}$， $C = 30000\\,\\mathrm{MPa}$， $\\sigma^{n} = 260\\,\\mathrm{MPa}$， $\\alpha^{n} = 50\\,\\mathrm{MPa}$， $\\varepsilon^{p\\,n} = 50/30000$， $\\kappa^{n} = 50/30000$， $\\Delta \\varepsilon = 0.002$。\n- 用例 D（组合硬化与反向加载，塑性步）：$E = 210000\\,\\mathrm{MPa}$，$\\sigma_{y}^{0} = 250\\,\\mathrm{MPa}$， $H_{\\text{iso}} = 2000\\,\\mathrm{MPa}$， $C = 40000\\,\\mathrm{MPa}$， $\\sigma^{n} = 376\\,\\mathrm{MPa}$， $\\alpha^{n} = 120\\,\\mathrm{MPa}$， $\\varepsilon^{p\\,n} = 120/40000$， $\\kappa^{n} = 120/40000$， $\\Delta \\varepsilon = -0.003$。\n- 用例 E（恰好在屈服点的边界情况，弹性）：$E = 210000\\,\\mathrm{MPa}$，$\\sigma_{y}^{0} = 300\\,\\mathrm{MPa}$， $H_{\\text{iso}} = 500\\,\\mathrm{MPa}$， $C = 0\\,\\mathrm{MPa}$， $\\sigma^{n} = 200\\,\\mathrm{MPa}$， $\\alpha^{n} = 0\\,\\mathrm{MPa}$， $\\kappa^{n} = 0.1$， $\\varepsilon^{p\\,n} = 0.1$， $\\Delta \\varepsilon = (350 - 200)/210000$。\n\n您的程序应对上述所有用例应用相同的算法。在判断弹性条件 $f_{\\text{tr}} \\le 0$ 时，使用一个严格但合理的数值容差。最终的程序输出必须是单行，包含按顺序排列的 A–E 各用例的结果列表，格式化为逗号分隔的类 Python 列表的列表，其中每个浮点数四舍五入到六位小数；例如，形式为 $[[\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot],\\ldots]$。", "solution": "该问题要求为一个结合了线性各向同性硬化和线性随动硬化的广义弹塑性材料模型实现一个单轴返回映射算法。推导过程必须从第一性原理出发，具体包括加性应变分解、线性弹性、给定的屈服准则以及关联流动和硬化法则。必须为弹塑性转换定义一个数值容差；此处选择值为 $10^{-7}$，因为相对于应力量级 ($\\mathrm{MPa}$) 而言，它足够小以确保精度。\n\n目标是给定增量步初始状态 $(\\sigma^{n}, \\varepsilon^{p\\,n}, \\kappa^{n}, \\alpha^{n})$ 和总应变增量 $\\Delta \\varepsilon$，计算增量步末的状态变量 $(\\sigma^{n+1}, \\varepsilon^{p\\,n+1}, \\kappa^{n+1}, \\alpha^{n+1})$。\n\n该算法从一个弹性试探步开始。假设整个应变增量 $\\Delta\\varepsilon$ 都是纯弹性的，计算试探应力 $\\sigma_{\\text{tr}}$：\n$$ \\sigma_{\\text{tr}} = \\sigma^{n} + E\\,\\Delta\\varepsilon $$\n然后使用来自第 $n$ 步的状态变量，根据屈服条件检查该试探状态：\n$$ f_{\\text{tr}} = \\lvert \\sigma_{\\text{tr}} - \\alpha^{n} \\rvert - \\left(\\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa^{n}\\right) $$\n如果 $f_{\\text{tr}} \\le 0$，则纯弹性步的假设是正确的。材料尚未屈服，或正在弹性卸载。最终状态即为试探状态：\n$$ \\sigma^{n+1} = \\sigma_{\\text{tr}}, \\quad \\varepsilon^{p\\,n+1} = \\varepsilon^{p\\,n}, \\quad \\kappa^{n+1} = \\kappa^{n}, \\quad \\alpha^{n+1} = \\alpha^{n} $$\n如果 $f_{\\text{tr}} > 0$，则试探状态位于屈服面之外，这在物理上是不可接受的。需要进行塑性修正。这个修正过程被称为返回映射，必须将应力状态拉回到更新后的屈服面上，满足一致性条件 $f(\\sigma^{n+1}, \\alpha^{n+1}, \\kappa^{n+1}) = 0$。\n\n塑性演化由关联流动和硬化法则控制，这些法则使用后向欧拉格式在增量步上进行积分。这是一种确保无条件稳定性的标准隐式方法。塑性状态变量的增量为：\n$$ \\Delta\\varepsilon^{p} = \\varepsilon^{p\\,n+1} - \\varepsilon^{p\\,n} = \\Delta\\gamma \\, \\operatorname{sign}(\\sigma^{n+1} - \\alpha^{n+1}) $$\n$$ \\Delta\\kappa = \\kappa^{n+1} - \\kappa^{n} = \\Delta\\gamma $$\n$$ \\Delta\\alpha = \\alpha^{n+1} - \\alpha^{n} = C\\,\\Delta\\varepsilon^{p} $$\n其中 $\\Delta\\gamma \\ge 0$ 是增量步上的总一致性参数。\n\n返回映射算法假设塑性流动的方向在整个修正过程中保持不变，并由试探状态确定。设此方向为 $R$：\n$$ R = \\operatorname{sign}(\\sigma_{\\text{tr}} - \\alpha^{n}) $$\n这简化了演化方程：\n$$ \\Delta\\varepsilon^{p} = \\Delta\\gamma \\, R \\quad \\implies \\quad \\varepsilon^{p\\,n+1} = \\varepsilon^{p\\,n} + \\Delta\\gamma \\, R $$\n$$ \\Delta\\kappa = \\Delta\\gamma \\quad \\implies \\quad \\kappa^{n+1} = \\kappa^{n} + \\Delta\\gamma $$\n$$ \\Delta\\alpha = C \\, \\Delta\\gamma \\, R \\quad \\implies \\quad \\alpha^{n+1} = \\alpha^{n} + C \\, \\Delta\\gamma \\, R $$\n$n+1$ 步的应力是通过对试探应力进行修正以考虑增量步中发生的塑性应变而获得的：\n$$ \\sigma^{n+1} = E (\\varepsilon^{n+1} - \\varepsilon^{p\\,n+1}) = E(\\varepsilon^n + \\Delta\\varepsilon - \\varepsilon^{p,n} - \\Delta\\varepsilon^p) = \\sigma^n + E\\Delta\\varepsilon - E\\Delta\\varepsilon^p = \\sigma_{\\text{tr}} - E\\,\\Delta\\varepsilon^{p} $$\n$$ \\sigma^{n+1} = \\sigma_{\\text{tr}} - E\\,\\Delta\\gamma\\,R $$\n所有更新后的状态变量现在都用唯一的未知标量 $\\Delta\\gamma$ 表示。为了求解 $\\Delta\\gamma$，我们强制执行塑性一致性条件 $f^{n+1} = 0$：\n$$ f^{n+1} = \\lvert \\sigma^{n+1} - \\alpha^{n+1} \\rvert - \\left(\\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa^{n+1}\\right) = 0 $$\n让我们代入更新后变量的表达式。首先是相对应力：\n$$ \\sigma^{n+1} - \\alpha^{n+1} = (\\sigma_{\\text{tr}} - E\\,\\Delta\\gamma\\,R) - (\\alpha^{n} + C\\,\\Delta\\gamma\\,R) = (\\sigma_{\\text{tr}} - \\alpha^{n}) - (E+C)\\,\\Delta\\gamma\\,R $$\n由于塑性修正减小了相对应力相对于试探值的大小，因此 $(\\sigma^{n+1} - \\alpha^{n+1})$ 项与 $(\\sigma_{\\text{tr}} - \\alpha^{n})$ 保持相同的符号 $R$。因此，我们可以取其绝对值：\n$$ \\lvert \\sigma^{n+1} - \\alpha^{n+1} \\rvert = \\lvert \\sigma_{\\text{tr}} - \\alpha^{n} \\rvert - (E+C)\\,\\Delta\\gamma $$\n更新后的屈服应力为：\n$$ \\sigma_{y}^{n+1} = \\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa^{n+1} = \\sigma_{y}^{0} + H_{\\text{iso}}\\,(\\kappa^{n} + \\Delta\\gamma) $$\n根据一致性条件，令这两个表达式相等：\n$$ \\lvert \\sigma_{\\text{tr}} - \\alpha^{n} \\rvert - (E+C)\\,\\Delta\\gamma = \\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa^{n} + H_{\\text{iso}}\\,\\Delta\\gamma $$\n重新整理以求解 $\\Delta\\gamma$：\n$$ \\lvert \\sigma_{\\text{tr}} - \\alpha^{n} \\rvert - (\\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa^{n}) = (E + C + H_{\\text{iso}})\\,\\Delta\\gamma $$\n等式左边恰好是试探屈服函数的值 $f_{\\text{tr}}$。由此可得塑性乘子增量的最终表达式：\n$$ \\Delta\\gamma = \\frac{f_{\\text{tr}}}{E + C + H_{\\text{iso}}} $$\n由于 $f_{\\text{tr}} > 0$ 且材料模量 $E, C, H_{\\text{iso}}$ 均为非负（$E > 0$），因此可以推断 $\\Delta\\gamma > 0$，符合要求。\n\n一个增量步的完整算法如下：\n1.  计算试探应力：$\\sigma_{\\text{tr}} = \\sigma^{n} + E\\,\\Delta\\varepsilon$。\n2.  计算试探屈服函数：$f_{\\text{tr}} = \\lvert \\sigma_{\\text{tr}} - \\alpha^{n} \\rvert - (\\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa^{n})$。\n3.  如果 $f_{\\text{tr}} \\le 10^{-7}$，则该步为弹性步。更新后的状态为 $(\\sigma_{\\text{tr}}, \\varepsilon^{p\\,n}, \\kappa^{n}, \\alpha^{n})$。\n4.  如果 $f_{\\text{tr}} > 10^{-7}$，则该步为塑性步。\n    a. 计算 $\\Delta\\gamma = \\frac{f_{\\text{tr}}}{E + C + H_{\\text{iso}}}$。\n    b. 确定流动方向 $R = \\operatorname{sign}(\\sigma_{\\text{tr}} - \\alpha^{n})$。\n    c. 更新应力：$\\sigma^{n+1} = \\sigma_{\\text{tr}} - E\\,\\Delta\\gamma\\,R$。\n    d. 更新内部变量：\n       $\\varepsilon^{p\\,n+1} = \\varepsilon^{p\\,n} + \\Delta\\gamma\\,R$。\n       $\\kappa^{n+1} = \\kappa^{n} + \\Delta\\gamma$。\n       $\\alpha^{n+1} = \\alpha^{n} + C\\,\\Delta\\gamma\\,R$。\n此过程在以下程序中直接实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef update_state(E, sig_y0, H_iso, C, sig_n, ep_n, kap_n, alp_n, d_eps):\n    \"\"\"\n    Computes the updated state variables for a uniaxial elastic-plastic material\n    with combined linear isotropic and kinematic hardening using a return-mapping algorithm.\n\n    Args:\n        E (float): Young's modulus (MPa)\n        sig_y0 (float): Initial yield stress (MPa)\n        H_iso (float): Isotropic hardening modulus (MPa)\n        C (float): Kinematic hardening modulus (MPa)\n        sig_n (float): Stress at the beginning of the increment (MPa)\n        ep_n (float): Plastic strain at the beginning of the increment\n        kap_n (float): Accumulated plastic strain at the beginning of the increment\n        alp_n (float): Backstress at the beginning of the increment (MPa)\n        d_eps (float): Total strain increment\n\n    Returns:\n        tuple: Updated state variables (sig_np1, ep_np1, kap_np1, alp_np1)\n    \"\"\"\n    # Numerical tolerance for yield check\n    TOL = 1e-7\n\n    # 1. Compute elastic trial stress\n    sig_tr = sig_n + E * d_eps\n\n    # 2. Evaluate trial yield function\n    sig_y_n = sig_y0 + H_iso * kap_n\n    f_tr = np.abs(sig_tr - alp_n) - sig_y_n\n\n    # 3. Check for yielding\n    if f_tr <= TOL:\n        # Elastic step\n        sig_np1 = sig_tr\n        ep_np1 = ep_n\n        kap_np1 = kap_n\n        alp_np1 = alp_n\n        return sig_np1, ep_np1, kap_np1, alp_np1\n    else:\n        # 4. Plastic step: enforce consistency\n        # Calculate plastic multiplier increment\n        denominator = E + C + H_iso\n        d_gamma = f_tr / denominator\n\n        # Determine flow direction\n        R = np.sign(sig_tr - alp_n)\n\n        # Update state variables\n        kap_np1 = kap_n + d_gamma\n        ep_np1 = ep_n + d_gamma * R\n        alp_np1 = alp_n + C * d_gamma * R\n        sig_np1 = sig_tr - E * d_gamma * R\n\n        return sig_np1, ep_np1, kap_np1, alp_np1\n\ndef solve():\n    \"\"\"\n    Main solver function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: Isotropic hardening only, plastic step\n        {'E': 210000.0, 'sig_y0': 250.0, 'H_iso': 1000.0, 'C': 0.0, 'sig_n': 0.0, 'ep_n': 0.0, 'kap_n': 0.0, 'alp_n': 0.0, 'd_eps': 0.003},\n        # Case B: Isotropic hardening only, elastic step\n        {'E': 210000.0, 'sig_y0': 250.0, 'H_iso': 1000.0, 'C': 0.0, 'sig_n': 0.0, 'ep_n': 0.0, 'kap_n': 0.0, 'alp_n': 0.0, 'd_eps': 0.001},\n        # Case C: Kinematic hardening only, plastic step\n        {'E': 210000.0, 'sig_y0': 250.0, 'H_iso': 0.0, 'C': 30000.0, 'sig_n': 260.0, 'alp_n': 50.0, 'ep_n': 50.0/30000.0, 'kap_n': 50.0/30000.0, 'd_eps': 0.002},\n        # Case D: Combined hardening with reverse loading, plastic step\n        {'E': 210000.0, 'sig_y0': 250.0, 'H_iso': 2000.0, 'C': 40000.0, 'sig_n': 376.0, 'alp_n': 120.0, 'ep_n': 120.0/40000.0, 'kap_n': 120.0/40000.0, 'd_eps': -0.003},\n        # Case E: Boundary case exactly at yield, elastic\n        {'E': 210000.0, 'sig_y0': 300.0, 'H_iso': 500.0, 'C': 0.0, 'sig_n': 200.0, 'alp_n': 0.0, 'kap_n': 0.1, 'ep_n': 0.1, 'd_eps': (350.0 - 200.0)/210000.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack case parameters and call the update function\n        sig_np1, ep_np1, kap_np1, alp_np1 = update_state(\n            case['E'], case['sig_y0'], case['H_iso'], case['C'],\n            case['sig_n'], case['ep_n'], case['kap_n'], case['alp_n'],\n            case['d_eps']\n        )\n        \n        # Round results to six decimal places and store as a list\n        result = [\n            round(sig_np1, 6),\n            round(ep_np1, 6),\n            round(kap_np1, 6),\n            round(alp_np1, 6)\n        ]\n        results.append(result)\n\n    # Format the final output as a string representing a list of lists.\n    # e.g., [[1.0,2.0,...],[3.0,4.0,...]]\n    # map(str, results) converts each inner list to its string representation.\n    # ','.join() combines these strings with commas.\n    # The outer brackets are added manually.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2652024"}]}