{"hands_on_practices": [{"introduction": "滑移线场是塑性流动的标志性特征，但它们在何种条件下才会形成？本练习 [@problem_id:2646140] 通过一个看似简单的应力状态——均匀双轴压缩——来挑战我们，要求我们判断这种状态是否足以引起塑性屈服。这是实践的第一步，也是至关重要的一步，它训练我们识别塑性流动和滑移线形成的必要条件，即剪应力（或更准确地说，偏应力）的存在。", "problem": "考虑一种二维、各向同性、不可压缩的刚-理想塑性材料，处于平面变形状态，遵循 Tresca 屈服准则，其剪切屈服应力为恒定的 $k>0$。使用压缩为正的符号约定。施加一个均匀双轴压缩，使得在笛卡尔坐标系中的 Cauchy 应力分量为 $\\,\\sigma_{xx}=\\sigma_{yy}=p_{0}\\,$ 且 $\\,\\sigma_{xy}=0\\,$，其中 $\\,p_{0}>0\\,$。从主应力、平均（静水）应力、偏应力以及 Tresca 屈服条件（用平面内主应力表示）的基本定义出发，并利用 Hencky 和 Geiringer 滑移线理论的运动学/几何学内容，完成以下任务：\n\n- 确定此状态下的平面内主应力和主方向，并找出平面内最大剪切应力 $\\,\\tau_{\\max}\\,$。\n- 基于滑移线与刚-理想塑性 Tresca 材料中最大剪切方向一致的定义，描述两个正交滑移线族（$\\alpha$-线和 $\\beta$-线）相对于任意固定轴的可能方位。\n- 讨论此均匀双轴状态在 Tresca 准则下是否与屈服相容，以及对于 $\\,k>0\\,$ 是否可以存在非平凡的滑移线场。\n- 最后，计算标量比值 $\\,\\tau_{\\max}/k\\,$。\n\n将您的最终答案表示为单个实数 $\\,\\tau_{\\max}/k\\,$。该比值无需单位。不要四舍五入；给出精确值。", "solution": "该问题陈述经过了严格验证，被确定为具有科学依据、适定且客观的。它代表了塑性理论框架内的一个基本概念性问题。我们将进行形式化的推导。\n\n给定的应力状态为均匀双轴压缩，在笛卡尔坐标系中的 Cauchy 应力分量为 $\\sigma_{xx} = p_0$、$\\sigma_{yy} = p_0$ 和 $\\sigma_{xy} = 0$，对于某个压力 $p_0 > 0$。因此，应力张量 $[\\sigma]$ 为：\n$$\n[\\sigma] = \\begin{pmatrix} \\sigma_{xx} & \\sigma_{xy} \\\\ \\sigma_{yx} & \\sigma_{yy} \\end{pmatrix} = \\begin{pmatrix} p_0 & 0 \\\\ 0 & p_0 \\end{pmatrix}\n$$\n该矩阵是对角矩阵，这表明给定的坐标轴 $x$ 和 $y$ 已经是主轴。应力张量的特征值即为主应力。通过观察可知，平面内主应力是相同的：\n$$\n\\sigma_1 = p_0 \\quad \\text{and} \\quad \\sigma_2 = p_0\n$$\n主应力相等的应力状态被称为各向同性或静水应力状态。在这种二维情况下，平面内的每个方向都是主方向，因为坐标系的任何旋转都使应力张量保持不变。\n\n平面内最大剪切应力记作 $\\tau_{\\max}$，由以下关系定义：\n$$\n\\tau_{\\max} = \\frac{|\\sigma_1 - \\sigma_2|}{2}\n$$\n代入已确定的主应力值，得到：\n$$\n\\tau_{\\max} = \\frac{|p_0 - p_0|}{2} = \\frac{0}{2} = 0\n$$\n另一个视角由应力 Mohr 圆提供。圆心位于 $(\\frac{\\sigma_{xx} + \\sigma_{yy}}{2}, 0) = (p_0, 0)$，其半径 $R$ 由 $R = \\sqrt{(\\frac{\\sigma_{xx} - \\sigma_{yy}}{2})^2 + \\sigma_{xy}^2} = \\sqrt{(\\frac{p_0 - p_0}{2})^2 + 0^2} = 0$ 给出。Mohr 圆退化为正应力轴上的一个点。由于圆的半径代表了平面内的最大剪切应力，这证实了 $\\tau_{\\max} = 0$。\n\n接下来我们讨论滑移线的方位。Hencky 和 Geiringer 的滑移线理论将滑移线（$\\alpha$-线和 $\\beta$-线）定义为处处与最大剪切应力方向相切的曲线族。已知这些方向与主应力方向成 $\\pm\\frac{\\pi}{4}$ 弧度（$45^\\circ$）角。然而，在当前情况下，正如点状的 Mohr 圆所证明的，平面内所有方向的剪切应力均为零。不存在唯一的*最大*剪切方向。因此，对于该应力状态，滑移线的概念是不适用的，其方位也是不确定的。\n\n我们现在必须评估此状态是否与塑性屈服相容。Tresca 屈服准则假定，当材料中的绝对最大剪切应力 $\\tau_{\\text{abs max}}$ 等于材料的剪切屈服强度 $k$ 时，屈服开始。\n$$\n\\tau_{\\text{abs max}} = k\n$$\n为了计算 $\\tau_{\\text{abs max}}$，必须考虑完整的三维应力状态。问题指定了平面变形状态。对于正在经历塑性变形的不可压缩材料（其中对塑性应变分量假定泊松比 $\\nu=0.5$），平面应变条件（$\\varepsilon_{zz}=0$）导致面外正应力为平面内正应力的平均值：$\\sigma_3 = \\sigma_{zz} = \\frac{1}{2}(\\sigma_{xx} + \\sigma_{yy})$。\n代入给定的应力：\n$$\n\\sigma_3 = \\frac{1}{2}(p_0 + p_0) = p_0\n$$\n完整的主应力集合为 $(\\sigma_1, \\sigma_2, \\sigma_3) = (p_0, p_0, p_0)$。这是一个纯静水压力状态。绝对最大剪切应力通过比较三个主平面上的剪切应力来找到：\n$$\n\\tau_{\\text{abs max}} = \\max\\left(\\frac{|\\sigma_1 - \\sigma_2|}{2}, \\frac{|\\sigma_2 - \\sigma_3|}{2}, \\frac{|\\sigma_3 - \\sigma_1|}{2}\\right)\n$$\n$$\n\\tau_{\\text{abs max}} = \\max\\left(\\frac{|p_0 - p_0|}{2}, \\frac{|p_0 - p_0|}{2}, \\frac{|p_0 - p_0|}{2}\\right) = \\max(0, 0, 0) = 0\n$$\nTresca 屈服条件因此变为 $0 = k$。然而，问题明确指出 $k > 0$。这导致了一个矛盾。因此，材料在纯静水应力状态下不能屈服。这类与压力无关的屈服准则预测，屈服仅由偏（剪切）应力引起，而不是由平均（静水）应力分量引起。由于材料不屈服，它保持在其刚性状态，而描述塑性流动运动学的非平凡滑移线场也不能存在。\n\n最后，问题要求计算比值 $\\frac{\\tau_{\\max}}{k}$。我们已经确定平面内最大剪切应力为 $\\tau_{\\max} = 0$。由于材料参数 $k$ 是严格为正的（$k > 0$），该比值为：\n$$\n\\frac{\\tau_{\\max}}{k} = \\frac{0}{k} = 0\n$$\n这个结果证实了，在给定的静水应力状态下，引起滑移的剪切应力为零，因此，正如该比值所表示的，该状态距离屈服条件无限远。", "answer": "$$\n\\boxed{0}\n$$", "id": "2646140"}, {"introduction": "一旦塑性流动开始，Hencky 方程便主导了应力与滑移线场几何形态之间的关系。本练习 [@problem_id:2646147] 深入探讨了这一核心关系，要求我们运用 Hencky 方程作为分析工具，根据平均压力 $p$ 沿着特征线的变化情况来推断滑移线的形状（直线或曲线）。完成这个练习对于培养将抽象的应力场直观地理解为几何图案的能力至关重要。", "problem": "在由 von Mises 屈服条件及相关联流动法则所支配的各向同性金属的刚-理想塑性平面应变问题中，平衡方程存在两个正交的特征方向，这两个方向与两族滑移线重合。设这两族特征线分别用 $\\alpha$ 线和 $\\beta$ 线表示，并设 $p$ 为平均（静水）应力。在每一点，设 $\\phi$ 为滑移线相对于某一固定轴的局部方向角，并设 $s$ 表示沿滑移线的弧长坐标。滑移线的曲率是标量 $\\kappa = d\\phi/ds$。\n\n请你根据沿特征线求得的 $dp/ds$ 的符号，建立一个判据，以判断一个小的单连通区域是否可以被直线或曲线滑移线填充，而不违反两族特征线的正交性。\n\n下列哪个陈述是正确的？选择所有适用项。\n\nA. 在一个单连通区域内，两族滑移线均为直线的局部充分必要条件是，在该区域内每一点沿两族特征线都有 $dp/ds=0$。这等价于 $p$ 在该区域内为常数。\n\nB. 如果在一个区域内沿两族特征线始终有 $dp/ds&gt;0$，那么这两族滑移线在该区域内都可以是直的，因为它们的曲率以一种保持正交性的方式相互抵消。\n\nC. 如果在一个区域内沿某一族特征线恒有 $dp/ds=0$，而沿另一族特征线 $dp/ds$ 在同一区域内具有固定的非零符号，那么该区域可以被一个简单波模式填充，其中一族滑移线是直的，另一族是单调弯曲的，且不违反正交性。$dp/ds$ 的符号决定了弯曲族的凹性。\n\nD. 如果在某一点沿一族特征线 $dp/ds$ 为正，而沿另一族为负，那么在该点两族滑移线的曲率必须具有相同的符号，这与正交性要求相矛盾。", "solution": "问题陈述涉及平面应变刚-理想塑性流动中滑移线场的性质。问题的核心在于平均应力 $p$ 与滑移线几何形状（特别是其方向角 $\\phi$ 和曲率 $\\kappa$）之间的关系。我们首先验证问题陈述的有效性，然后从第一性原理出发进行严格推导。\n\n该问题是在塑性理论的标准框架内提出的。它具有科学依据，是适定的、客观的，并包含足够的信息以进行确定性分析。其前提在事实上是可靠的，并与滑移线场的 Hencky-Geiringer 方程有关。因此，该问题是有效的，我们可以继续进行求解。\n\n平面应变塑性中的应力状态由平衡方程和 von Mises 屈服准则控制。对于刚-理想塑性材料，剪切屈服应力 $k$ 是一个常数。当平衡方程与用平均应力 $p$ 和主应力方向角 $\\theta$ 表示的屈服准则相结合时，它们构成一个双曲型偏微分方程组。该方程组的特征线就是滑移线，它们形成两个正交的族，记为 $\\alpha$ 线和 $\\beta$ 线。\n\n沿着这些特征线的基本关系是 Hencky 方程和 Geiringer 关系。这些关系将沿着滑移线的平均应力变化率与滑移线的曲率联系起来。设 $s_\\alpha$ 和 $s_\\beta$ 分别为沿 $\\alpha$ 线和 $\\beta$ 线的弧长，$\\kappa_\\alpha$ 和 $\\kappa_\\beta$ 为它们各自的曲率。根据本文主要内容中采用的约定，这些关系是：\n$$ \\frac{dp}{ds_\\alpha} = -2k \\kappa_\\alpha $$\n$$ \\frac{dp}{ds_\\beta} = 2k \\kappa_\\beta $$\n\n这两个方程是我们整个分析的基础。它们将沿一条滑移线的平均应力变化率与该滑移线的曲率直接联系起来。现在我们来评估每个陈述。\n\n**选项 A：** “在一个单连通区域内，两族滑移线均为直线的局部充分必要条件是，在该区域内每一点沿两族特征线都有 $dp/ds=0$。这等价于 $p$ 在该区域内为常数。”\n一条滑移线是直的，当且仅当其曲率为零。\n要使 $\\alpha$ 族为直线，该区域内各处必须有 $\\kappa_\\alpha = 0$。根据我们的第一个方程，由于 $k$ 是一个正常数，这等价于沿所有 $\\alpha$ 线有 $\\frac{dp}{ds_\\alpha} = 0$。\n要使 $\\beta$ 族为直线，该区域内各处必须有 $\\kappa_\\beta = 0$。根据我们的第二个方程，这等价于沿所有 $\\beta$ 线有 $\\frac{dp}{ds_\\beta} = 0$。\n如果这两个条件都成立，即在每一点都有 $\\frac{dp}{ds_\\alpha} = 0$ 和 $\\frac{dp}{ds_\\beta} = 0$。由于 $\\alpha$ 线和 $\\beta$ 线的切向量是正交的，因而在每一点都构成一个基，这意味着 $p$ 的梯度为零，$\\nabla p = \\mathbf{0}$。这等价于 $p$ 在整个区域内为常数。\n反之，如果 $p$ 是常数，其在任何方向上的方向导数都为零，所以 $\\frac{dp}{ds_\\alpha} = 0$ 且 $\\frac{dp}{ds_\\beta} = 0$。这意味着 $\\kappa_\\alpha = 0$ 和 $\\kappa_\\beta = 0$，即两族滑移线都是直的。\n因此，该条件是充分且必要的。\n该陈述是**正确的**。\n\n**选项 B：** “如果在一个区域内沿两族特征线始终有 $dp/ds&gt;0$，那么这两族滑移线在该区域内都可以是直的，因为它们的曲率以一种保持正交性的方式相互抵消。”\n这个陈述有根本性错误。如果 $\\frac{dp}{ds_\\alpha} > 0$，则 $-2k \\kappa_\\alpha > 0$，这意味着 $\\kappa_\\alpha < 0$。$\\alpha$ 线不是直的；它们是弯曲的。\n如果 $\\frac{dp}{ds_\\beta} > 0$，则 $2k \\kappa_\\beta > 0$，这意味着 $\\kappa_\\beta > 0$。$\\beta$ 线也不是直的；它们以相反的凹度弯曲。\n声称这两族滑移线可以是直的，直接与 Geiringer 关系相矛盾。后续关于曲率“抵消”以保持正交性的理由是无稽之谈；滑移线族的正交性是特征场的固有属性，不取决于曲率的值。\n该陈述是**不正确的**。\n\n**选项 C：** “如果在一个区域内沿某一族特征线恒有 $dp/ds=0$，而沿另一族特征线 $dp/ds$ 在同一区域内具有固定的非零符号，那么该区域可以被一个简单波模式填充，其中一族滑移线是直的，另一族是单调弯曲的，且不违反正交性。$dp/ds$ 的符号决定了弯曲族的凹性。”\n让我们假设沿所有 $\\alpha$ 线有 $\\frac{dp}{ds_\\alpha} = 0$。这意味着 $\\kappa_\\alpha = 0$，因此 $\\alpha$ 线是直的。\n让我们假设 $\\frac{dp}{ds_\\beta}$ 有一个固定的非零符号，比如 $\\frac{dp}{ds_\\beta} > 0$。这意味着 $\\kappa_\\beta = \\frac{1}{2k} \\frac{dp}{ds_\\beta} > 0$。所以 $\\beta$ 线是弯曲的，且其曲率符号不变，意味着它们是单调弯曲的。\n这种情况，即一族滑移线是直的而另一族是弯曲的，正是简单波区域（或扇形区）的定义。这种解是塑性力学中一种有效且经典的解类型。如前所述，正交性没有被违反。$\\frac{dp}{ds_\\beta}$ 的符号确实决定了曲率 $\\kappa_\\beta$ 的符号，从而定义了曲线族的凹性。\n该陈述是**正确的**。\n\n**选项 D：** “如果在某一点沿一族特征线 $dp/ds$ 为正，而沿另一族为负，那么在该点两族滑移线的曲率必须具有相同的符号，这与正交性要求相矛盾。”\n设 $\\frac{dp}{ds_\\alpha} > 0$ 且 $\\frac{dp}{ds_\\beta} < 0$。\n从 Geiringer 关系可知：\n$\\kappa_\\alpha = -\\frac{1}{2k} \\frac{dp}{ds_\\alpha} < 0$。\n$\\kappa_\\beta = \\frac{1}{2k} \\frac{dp}{ds_\\beta} < 0$。\n该陈述的第一个论断，即两族曲率必须具有相同的符号（在此情况下为负），是正确的。\n然而，第二个论断，即这与正交性要求相矛盾，是错误的。没有任何数学或物理原理禁止两个正交的曲线族具有相同符号的曲率。一个一般的滑移线场（或混合区）的特征是两族曲线都是弯曲的。一个来自几何学的简单反例是对数螺线场及其正交轨线；两族曲线都可以具有正曲率。一个物理上可能的应力状态的存在并不构成矛盾。这个陈述中的结论是基于一个错误的前提。\n该陈述是**不正确的**。", "answer": "$$\\boxed{AC}$$", "id": "2646147"}, {"introduction": "滑移线场的解析解非常罕见，因此数值方法是必不可少的工程与研究工具。最后的这个练习 [@problem_id:2646134] 是我们学习的顶点，我们将把 Hencky 和 Geiringer 方程的微分形式转化为一个具体的数值算法。通过实现一个步进积分程序，我们能够精确地构造一条滑移线并确定沿线应力的演变，这是解决复杂塑性边值问题的强大技术。", "problem": "要求您设计并实现一种数值步进算法，该算法需与固体力学中的平面理想塑性流动理论一致，用于根据给定的初始数据沿 $\\alpha$-滑移线积分平均压力场。该算法必须遵循经典的 Hencky 和 Geiringer 滑移线关系，适用于具有恒定剪切屈服应力的理想塑性、不可压缩的平面应变材料。\n\n请从以下基本原理出发：\n\n- 本构与屈服假设：理想塑性，具有恒定的剪切屈服应力 $k$；平面应变，不可压缩流动；滑移线场理论适用。\n- 特征方向：在每一点上，存在两个正交的滑移线族 $\\alpha$ 和 $\\beta$，它们与最大剪切方向成 $\\pm \\pi/4$ 角（等效地，相对于固定的 $x$-轴，其角度为 $\\theta \\pm \\pi/4$，其中 $\\theta$ 是主应力方向的旋转角）。\n- Hencky 方程（特征应力关系）：沿 $\\alpha$-线，平均压力 $p$ 和应力方向角 $\\theta$ 满足 $dp = -2 k\\, d\\theta$。\n- 沿曲线运动的几何关系：如果 $s$表示沿 $\\alpha$-线的弧长，则局部切线与 $x$-轴的夹角为 $\\theta + \\pi/4$，因此有 $dx/ds = \\cos(\\theta + \\pi/4)$ 和 $dy/ds = \\sin(\\theta + \\pi/4)$，其中 $x$ 和 $y$ 是笛卡尔坐标。\n- 曲率定义：$\\alpha$-线的曲率 $\\kappa_{\\alpha}$ 满足 $d\\theta/ds = \\kappa_{\\alpha}$，因为 $\\alpha$-线的切线角是 $\\theta + \\pi/4$，而切线角对弧长的导数等于曲率。在本问题中，$\\kappa_{\\alpha}$ 作为沿 $\\alpha$-线随 $\\theta$ 变化的给定函数，记作 $\\kappa(\\theta)$。\n\n基于以上关系，推导一个以应力方向角 $\\theta$ 为自变量的常微分方程组。利用 $d\\theta/ds = \\kappa(\\theta)$ 得到 $ds/d\\theta = 1/\\kappa(\\theta)$，并结合几何关系，可得\n$$\n\\frac{dx}{d\\theta} = \\frac{\\cos(\\theta + \\pi/4)}{\\kappa(\\theta)}, \\qquad\n\\frac{dy}{d\\theta} = \\frac{\\sin(\\theta + \\pi/4)}{\\kappa(\\theta)}, \\qquad\n\\frac{dp}{d\\theta} = -2 k.\n$$\n角度必须以弧度为单位处理。位置必须以米为单位，压力以帕斯卡为单位。\n\n您的任务是实现一个四阶 Runge–Kutta 步进算法，在给定恒定屈服参数 $k$ 和指定曲率函数 $\\kappa(\\theta)$ 的条件下，将上述方程组沿 $\\alpha$-线从初始状态 $\\{x_0,y_0,p_0,\\theta_0\\}$ 积分到终点方向角 $\\theta_f$。您必须确保 $\\kappa(\\theta)$ 在积分区间 $\\left[\\theta_0,\\theta_f\\right]$ 上不为零，以避免出现奇异点。该算法应能稳健地处理正曲率和负曲率，以及 $\\theta$ 递增或递减的情况。\n\n测试套件规范：\n实现您的程序以解决以下三种情况。角度使用弧度，$x$ 和 $y$ 使用米，$p$ 和 $k$ 使用帕斯卡。\n\n- 情况 1 (恒定正曲率，解析基准):\n  - $k = 1.0 \\times 10^{6}$,\n  - $\\kappa(\\theta) = 0.5$,\n  - $\\theta_0 = 0.0$, $\\theta_f = 0.5$,\n  - $x_0 = 0.0$, $y_0 = 0.0$, $p_0 = 5.0 \\times 10^{6}$。\n- 情况 2 (非均匀正曲率):\n  - $k = 2.5 \\times 10^{6}$,\n  - $\\kappa(\\theta) = 0.2 + 0.1 \\cos(\\theta)$,\n  - $\\theta_0 = 0.2$, $\\theta_f = 1.0$,\n  - $x_0 = 1.0$, $y_0 = -0.5$, $p_0 = 1.0 \\times 10^{6}$。\n- 情况 3 (恒定负曲率，$\\theta$ 递减):\n  - $k = 1.5 \\times 10^{6}$,\n  - $\\kappa(\\theta) = -0.3$,\n  - $\\theta_0 = 1.2$, $\\theta_f = 0.7$,\n  - $x_0 = -2.0$, $y_0 = 2.0$, $p_0 = 0.0$。\n\n数值与输出要求：\n\n- 为关于 $x(\\theta)$、$y(\\theta)$ 和 $p(\\theta)$ 的耦合系统实现一个以 $\\theta$ 为变量的四阶 Runge–Kutta 积分器。\n- 所有三角函数求值均使用弧度。\n- 确保所选步长足以在每种情况下对区间 $\\left[\\theta_0,\\theta_f\\right]$进行充分解析；您可以选择对 $\\theta$ 进行均匀划分。\n- 对于每种情况，返回最终状态 $\\{x(\\theta_f), y(\\theta_f), p(\\theta_f)\\}$。\n- 将报告的每个 $x$、$y$ 和 $p$ 值四舍五入到六位小数。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个 Python 风格的列表嵌套列表，内含与上述三种情况相对应的三个三元组，顺序与上文一致，不含任何多余的空白字符或文本。例如：\n\"[ [x1,y1,p1],[x2,y2,p2],[x3,y3,p3] ]\" 但为保持一致性，不带空格，即 \"[[x1,y1,p1],[x2,y2,p2],[x3,y3,p3]]\"。\n\n注意：除了已阐明的基本原理外，您不能假定任何“捷径”公式；推导和实现必须基于给定的关系。通过检查确保 $\\kappa(\\theta)$ 在测试套件提供的积分区间上不为零，以保证科学真实性。", "solution": "问题陈述经核验在科学上是合理的、适定的且完整的。它提出了一个源于固体力学滑移线场理论基本原理的标准初值问题。任务是使用四阶 Runge-Kutta 方法对一个常微分方程组（ODE）进行数值积分。\n\n该物理系统为处于平面应变条件下的理想塑性、不可压缩材料。材料沿 $\\alpha$-滑移线的状态由笛卡尔坐标 $(x, y)$、平均压力 $p$ 和主应力方向角 $\\theta$ 描述。这些变量的演化遵循 Hencky 和 Geiringer 关系。通过选择 $\\theta$ 作为自变量，我们得到以下一阶常微分方程组：\n$$\n\\frac{dx}{d\\theta} = \\frac{\\cos(\\theta + \\pi/4)}{\\kappa(\\theta)}\n$$\n$$\n\\frac{dy}{d\\theta} = \\frac{\\sin(\\theta + \\pi/4)}{\\kappa(\\theta)}\n$$\n$$\n\\frac{dp}{d\\theta} = -2k\n$$\n其中 $k$ 是恒定的剪切屈服应力，$\\kappa(\\theta)$ 是作为 $\\theta$ 函数的 $\\alpha$-滑移线的给定曲率。\n\n我们可以将此方程组写成向量形式。设状态向量为 $\\mathbf{y}(\\theta) = [x(\\theta), y(\\theta), p(\\theta)]^T$。则该系统可表示为：\n$$\n\\frac{d\\mathbf{y}}{d\\theta} = \\mathbf{F}(\\theta)\n$$\n其中向量函数 $\\mathbf{F}(\\theta)$ 由下式给出：\n$$\n\\mathbf{F}(\\theta) = \\begin{pmatrix} \\frac{\\cos(\\theta + \\pi/4)}{\\kappa(\\theta)} \\\\ \\frac{\\sin(\\theta + \\pi/4)}{\\kappa(\\theta)} \\\\ -2k \\end{pmatrix}\n$$\n这是一个初值问题，给定 $\\theta = \\theta_0$ 时的初始状态 $\\mathbf{y}_0 = [x_0, y_0, p_0]^T$，我们需要求解 $\\theta = \\theta_f$ 时的最终状态 $\\mathbf{y}_f$。\n\n为了对该系统进行数值求解，我们采用四阶 Runge-Kutta (RK4) 方法。积分区间 $[\\theta_0, \\theta_f]$ 被离散化为 $N$ 个步长为 $h = (\\theta_f - \\theta_0) / N$ 的子区间。对于从 $\\theta_n$ 处的状态 $\\mathbf{y}_n$ 开始的每一步，在 $\\theta_{n+1} = \\theta_n + h$ 处的状态 $\\mathbf{y}_{n+1}$ 计算如下：\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{1}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n$$\n对于一个通用常微分方程组 $\\frac{d\\mathbf{y}}{d\\theta} = \\mathbf{F}(\\theta, \\mathbf{y})$，其中间向量 $\\mathbf{k}_i$定义为：\n$$\n\\mathbf{k}_1 = h \\cdot \\mathbf{F}(\\theta_n, \\mathbf{y}_n) \\\\\n\\mathbf{k}_2 = h \\cdot \\mathbf{F}(\\theta_n + h/2, \\mathbf{y}_n + \\mathbf{k}_1/2) \\\\\n\\mathbf{k}_3 = h \\cdot \\mathbf{F}(\\theta_n + h/2, \\mathbf{y}_n + \\mathbf{k}_2/2) \\\\\n\\mathbf{k}_4 = h \\cdot \\mathbf{F}(\\theta_n + h, \\mathbf{y}_n + \\mathbf{k}_3)\n$$\n对于这个特定问题，一个关键的观察是函数 $\\mathbf{F}$ 仅依赖于 $\\theta$ 而不依赖于状态向量 $\\mathbf{y}$。这将中间向量的表达式简化为：\n$$\n\\mathbf{k}_1 = h \\cdot \\mathbf{F}(\\theta_n) \\\\\n\\mathbf{k}_2 = h \\cdot \\mathbf{F}(\\theta_n + h/2) \\\\\n\\mathbf{k}_3 = h \\cdot \\mathbf{F}(\\theta_n + h/2) \\\\\n\\mathbf{k}_4 = h \\cdot \\mathbf{F}(\\theta_n + h)\n$$\n将这些代入更新公式，我们得到：\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{h}{6} \\left( \\mathbf{F}(\\theta_n) + 4\\mathbf{F}(\\theta_n + h/2) + \\mathbf{F}(\\theta_n + h) \\right)\n$$\n这等同于对向量函数 $\\mathbf{F}(\\theta)$ 的每个分量在区间 $[\\theta_n, \\theta_{n+1}]$ 上应用辛普森 1/3 法则进行数值积分。\n\n实现将包括一个通用函数，该函数针对给定的函数 $\\mathbf{F}(\\theta)$、初始条件、积分范围和步数 $N$ 执行此 RK4 积分。为确保高精度并满足四舍五入到 6 位小数的要求，将使用大量的步数，例如 $N=10000$。$N$ 的这一选择使得步长 $h$ 很小，并且由于 RK4 方法的全局误差为 $O(h^4)$ 阶，数值解将非常接近真实解。\n\n该算法将应用于所提供的三个测试用例。对于每个用例，使用特定的参数 $k$、$x_0$、$y_0$、$p_0$、$\\theta_0$、$\\theta_f$ 以及函数 $\\kappa(\\theta)$ 来定义相应的 $\\mathbf{F}(\\theta)$。该算法能适应递增（$\\theta_f > \\theta_0$）和递减（$\\theta_f < \\theta_0$）的积分路径，因为步长 $h$ 将相应地为正或为负。有效性检查已确认，在所有测试用例中，$\\kappa(\\theta)$ 在积分区间上均不为零，从而确保了右端函数 $\\mathbf{F}(\\theta)$ 是良定的。每个用例最终计算出的 $x(\\theta_f)$、$y(\\theta_f)$ 和 $p(\\theta_f)$ 值将四舍五入到 6 位小数，并按指定格式输出。", "answer": "```python\nimport numpy as np\n\ndef rk4_integrator(F_theta, y0, theta0, theta_f, N):\n    \"\"\"\n    Integrates the ODE system dy/d(theta) = F(theta) using a fourth-order Runge-Kutta method.\n    The method simplifies to Simpson's rule because F is independent of y.\n\n    Args:\n        F_theta (callable): The vector function F(theta) = [dx/dtheta, dy/dtheta, dp/dtheta].\n        y0 (list or np.ndarray): Initial state vector [x0, y0, p0].\n        theta0 (float): Initial value of the independent variable theta.\n        theta_f (float): Final value of the independent variable theta.\n        N (int): Number of integration steps.\n\n    Returns:\n        np.ndarray: The final state vector y(theta_f).\n    \"\"\"\n    h = (theta_f - theta0) / N\n    theta = theta0\n    y = np.array(y0, dtype=float)\n\n    for _ in range(N):\n        F1 = F_theta(theta)\n        F2 = F_theta(theta + h / 2.0)\n        # F3 = F_theta(theta + h / 2.0) is the same as F2\n        F4 = F_theta(theta + h)\n        \n        # The update formula simplifies from (F1 + 2*F2 + 2*F3 + F4) to (F1 + 4*F2 + F4)\n        y += (h / 6.0) * (F1 + 4.0 * F2 + F4)\n        theta += h\n        \n    return y\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the three specified test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"k\": 1.0e6,\n            \"kappa_func\": lambda theta: 0.5,\n            \"theta0\": 0.0,\n            \"theta_f\": 0.5,\n            \"initial_state\": [0.0, 0.0, 5.0e6]\n        },\n        {\n            \"k\": 2.5e6,\n            \"kappa_func\": lambda theta: 0.2 + 0.1 * np.cos(theta),\n            \"theta0\": 0.2,\n            \"theta_f\": 1.0,\n            \"initial_state\": [1.0, -0.5, 1.0e6]\n        },\n        {\n            \"k\": 1.5e6,\n            \"kappa_func\": lambda theta: -0.3,\n            \"theta0\": 1.2,\n            \"theta_f\": 0.7,\n            \"initial_state\": [-2.0, 2.0, 0.0]\n        }\n    ]\n\n    all_results = []\n    \n    # Use a large number of steps for high accuracy\n    num_steps = 10000\n\n    for case in test_cases:\n        k = case[\"k\"]\n        kappa_func = case[\"kappa_func\"]\n\n        # Define the derivative function F(theta) for the current case\n        def F_theta(theta):\n            kappa_val = kappa_func(theta)\n            # The problem guarantees kappa_val is non-zero on the interval\n            cos_term = np.cos(theta + np.pi / 4.0)\n            sin_term = np.sin(theta + np.pi / 4.0)\n            return np.array([\n                cos_term / kappa_val,\n                sin_term / kappa_val,\n                -2.0 * k\n            ])\n\n        # Integrate the system of ODEs\n        y_final = rk4_integrator(\n            F_theta,\n            case[\"initial_state\"],\n            case[\"theta0\"],\n            case[\"theta_f\"],\n            num_steps\n        )\n\n        # Round the final results to six decimal places as required\n        x_f_rounded = round(y_final[0], 6)\n        y_f_rounded = round(y_final[1], 6)\n        p_f_rounded = round(y_final[2], 6)\n        \n        all_results.append([x_f_rounded, y_f_rounded, p_f_rounded])\n        \n    # Format the final output string to match the required format: \"[[x1,y1,p1],[x2,y2,p2],[x3,y3,p3]]\"\n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```", "id": "2646134"}]}