{"hands_on_practices": [{"introduction": "理解塑性流动法则的第一步是能够计算塑性势函数 $g$ 对应力张量 $\\boldsymbol{\\sigma}$ 的梯度。本练习 [@problem_id:2616095] 提供了在张量微积分方面的基础实践，要求推导一个光滑的、压力相关的 Drucker-Prager 模型的塑性流动方向。掌握这项技能是理解和应用更复杂塑性模型不可或缺的基础。", "problem": "考虑一个三维各向同性弹塑性固体，其塑性流动由Drucker–Prager型塑性势$g(\\boldsymbol{\\sigma})=\\sqrt{J_2}+\\beta I_1$控制，其中$J_2=\\tfrac{1}{2}\\boldsymbol{s}:\\boldsymbol{s}$是偏应力的第二不变量，$I_1=\\operatorname{tr}\\boldsymbol{\\sigma}$是第一应力不变量，$\\boldsymbol{s}=\\boldsymbol{\\sigma}-\\tfrac{1}{3}I_1\\boldsymbol{I}$是偏应力，而$\\boldsymbol{I}$是二阶单位张量。符号$:$表示张量的Frobenius内积，Frobenius范数定义为$\\|\\boldsymbol{A}\\|=\\sqrt{\\boldsymbol{A}:\\boldsymbol{A}}$。假设$J_2>0$。\n\n由$g$生成的非关联流动法则的塑性流动方向定义为单位张量\n$$\n\\boldsymbol{n}_g=\\frac{\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}}}{\\left\\|\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\right\\|},\n$$\n其中梯度$\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}}$是关于$\\boldsymbol{\\sigma}$的，其意义为对于任意容许的应力变分$\\delta\\boldsymbol{\\sigma}$，都有$\\delta g=\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}}:\\delta\\boldsymbol{\\sigma}$。\n\n从上述定义和连续介质力学中的标准张量微积分出发，推导$\\boldsymbol{n}_g$关于$\\boldsymbol{s}$、$J_2$、$\\beta$和$\\boldsymbol{I}$的闭式表达式。请以单个解析张量表达式的形式给出最终结果。无需进行数值计算，也无需取整。", "solution": "所提出的问题是连续介质塑性理论中的一个标准练习，它是适定的、有科学依据且客观的。该问题要求推导由Drucker-Prager塑性势控制的材料的塑性流动方向单位张量$\\boldsymbol{n}_g$。所有定义和条件均已给出，并与既有文献一致。因此，将提供一个解答。\n\n目标是计算单位张量$\\boldsymbol{n}_g$的表达式，其定义为：\n$$\n\\boldsymbol{n}_g = \\frac{\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}}}{\\left\\|\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\right\\|}\n$$\n推导过程分为两个逻辑步骤：首先，确定塑性势的梯度$\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}}$；其次，计算其Frobenius范数。\n\n塑性势函数由$g(\\boldsymbol{\\sigma}) = \\sqrt{J_2} + \\beta I_1$给出。\n我们应用链式法则对张量变量$\\boldsymbol{\\sigma}$进行微分：\n$$\n\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}} = \\frac{\\partial g}{\\partial J_2} \\frac{\\partial J_2}{\\partial\\boldsymbol{\\sigma}} + \\frac{\\partial g}{\\partial I_1} \\frac{\\partial I_1}{\\partial\\boldsymbol{\\sigma}}\n$$\n我们必须计算该表达式的每个分量。$g$关于不变量$J_2$和$I_1$的偏导数很简单：\n$$\n\\frac{\\partial g}{\\partial J_2} = \\frac{\\partial}{\\partial J_2}(\\sqrt{J_2} + \\beta I_1) = \\frac{1}{2\\sqrt{J_2}}\n$$\n由于问题指定$J_2 > 0$，因此这是良定义的。\n$$\n\\frac{\\partial g}{\\partial I_1} = \\frac{\\partial}{\\partial I_1}(\\sqrt{J_2} + \\beta I_1) = \\beta\n$$\n接下来，我们需要应力不变量$I_1$和$J_2$关于Cauchy应力张量$\\boldsymbol{\\sigma}$的梯度。这些是张量微积分中的基本关系。\n对于第一不变量$I_1 = \\operatorname{tr}(\\boldsymbol{\\sigma}) = \\boldsymbol{\\sigma} : \\boldsymbol{I}$，其变分为$\\delta I_1 = \\delta\\boldsymbol{\\sigma} : \\boldsymbol{I}$。根据张量梯度的定义$\\delta I_1 = \\frac{\\partial I_1}{\\partial\\boldsymbol{\\sigma}}:\\delta\\boldsymbol{\\sigma}$，我们立即可以确定：\n$$\n\\frac{\\partial I_1}{\\partial\\boldsymbol{\\sigma}} = \\boldsymbol{I}\n$$\n对于偏应力第二不变量$J_2 = \\frac{1}{2}\\boldsymbol{s}:\\boldsymbol{s}$，我们首先表示其变分。回顾$\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}I_1\\boldsymbol{I}$，我们求$J_2$的变分：\n$$\n\\delta J_2 = \\boldsymbol{s} : \\delta\\boldsymbol{s} = \\boldsymbol{s} : \\left( \\delta\\boldsymbol{\\sigma} - \\frac{1}{3}(\\delta I_1)\\boldsymbol{I} \\right) = \\boldsymbol{s} : \\delta\\boldsymbol{\\sigma} - \\frac{1}{3}\\delta I_1 (\\boldsymbol{s} : \\boldsymbol{I})\n$$\n偏应力张量的一个关键性质是其迹为零，即$\\operatorname{tr}(\\boldsymbol{s}) = \\boldsymbol{s} : \\boldsymbol{I} = 0$。因此，第二项消失，剩下：\n$$\n\\delta J_2 = \\boldsymbol{s} : \\delta\\boldsymbol{\\sigma}\n$$\n从定义$\\delta J_2 = \\frac{\\partial J_2}{\\partial\\boldsymbol{\\sigma}}:\\delta\\boldsymbol{\\sigma}$，我们推断出：\n$$\n\\frac{\\partial J_2}{\\partial\\boldsymbol{\\sigma}} = \\boldsymbol{s}\n$$\n将这些梯度代回$\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}}$的表达式中，得到$\\boldsymbol{n}_g$的分子：\n$$\n\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}} = \\left(\\frac{1}{2\\sqrt{J_2}}\\right)\\boldsymbol{s} + (\\beta)\\boldsymbol{I}\n$$\n现在，我们必须计算这个梯度张量的Frobenius范数，也就是$\\boldsymbol{n}_g$的分母。范数由$\\|\\boldsymbol{A}\\| = \\sqrt{\\boldsymbol{A}:\\boldsymbol{A}}$给出。令$\\boldsymbol{A} = \\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}}$。\n$$\n\\left\\|\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\right\\|^2 = \\left( \\frac{1}{2\\sqrt{J_2}}\\boldsymbol{s} + \\beta\\boldsymbol{I} \\right) : \\left( \\frac{1}{2\\sqrt{J_2}}\\boldsymbol{s} + \\beta\\boldsymbol{I} \\right)\n$$\n利用内积的双线性性展开：\n$$\n\\left\\|\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\right\\|^2 = \\left(\\frac{1}{2\\sqrt{J_2}}\\right)^2 (\\boldsymbol{s}:\\boldsymbol{s}) + 2\\left(\\frac{1}{2\\sqrt{J_2}}\\right)\\beta(\\boldsymbol{s}:\\boldsymbol{I}) + \\beta^2(\\boldsymbol{I}:\\boldsymbol{I})\n$$\n我们计算每个张量积：\n1. 根据定义，$J_2 = \\frac{1}{2}\\boldsymbol{s}:\\boldsymbol{s}$，所以$\\boldsymbol{s}:\\boldsymbol{s} = 2J_2$。\n2. 如前所述，偏应力的迹为零：$\\boldsymbol{s}:\\boldsymbol{I} = \\operatorname{tr}(\\boldsymbol{s}) = 0$。\n3. 对于三维空间，单位张量与自身的内积为$\\boldsymbol{I}:\\boldsymbol{I} = \\operatorname{tr}(\\boldsymbol{I}) = 3$。\n\n将这些结果代入范数平方的方程中：\n$$\n\\left\\|\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\right\\|^2 = \\frac{1}{4J_2}(2J_2) + \\frac{\\beta}{\\sqrt{J_2}}(0) + \\beta^2(3) = \\frac{1}{2} + 3\\beta^2\n$$\n取平方根得到范数：\n$$\n\\left\\|\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\right\\| = \\sqrt{\\frac{1}{2} + 3\\beta^2}\n$$\n最后，我们将梯度除以其范数，组合成$\\boldsymbol{n}_g$的表达式。这就得出了关于指定变量的最终闭式表达式，它代表了主应力空间中塑性应变增量的方向。\n$$\n\\boldsymbol{n}_g = \\frac{\\frac{1}{2\\sqrt{J_2}}\\boldsymbol{s} + \\beta\\boldsymbol{I}}{\\sqrt{\\frac{1}{2} + 3\\beta^2}}\n$$\n该表达式是所提问题的完整且正确的答案。", "answer": "$$\n\\boxed{\\frac{\\frac{1}{2\\sqrt{J_2}}\\boldsymbol{s} + \\beta\\boldsymbol{I}}{\\sqrt{\\frac{1}{2} + 3\\beta^2}}}\n$$", "id": "2616095"}, {"introduction": "在掌握了如何推导流动方向之后，我们转向探讨一个更深层次的问题：为何以及何时选择非关联流动法则。本练习 [@problem_id:2616047] 旨在探讨在处理具有非光滑屈服面（如角点）的材料时，采用光滑塑性势 $g$ 的动机和后果。通过分析，您将权衡其优点（如解决数学上的不确定性并更真实地模拟材料行为）与理论和数值上的代价（如失去对称性和稳定性保证）。", "problem": "某种摩擦性岩土材料被建模为率无关、小应变弹塑性体，其在应力空间中的屈服函数 $f(\\boldsymbol{\\sigma},\\kappa)\\le 0$ 是一个凸但分段光滑的函数，其中 $\\boldsymbol{\\sigma}$ 是Cauchy应力，$\\kappa$ 表示内变量。该屈服面存在尖角和顶点。在相关联构型中，塑性流动方向被取为屈服面的法线方向，但在尖角处，$f$ 是不可微的，因此外法线不唯一。一位工程师提出了一个非相关联构型：保留 $f(\\boldsymbol{\\sigma},\\kappa)$ 用于定义应力容许性和一致性条件，但通过一个光滑的塑性势 $g(\\boldsymbol{\\sigma},\\kappa)$ 来规定塑性流动。该塑性势函数与 $f$ 具有相同的对称性，并且处处可微，包括在顶点附近，从而定义了唯一的塑性流动方向。\n\n下列陈述中，哪一项从第一性原理出发，最好地解释了所提出的采用光滑函数 $g$ 的非相关联流动如何避免了相关联流动在非光滑屈服点存在的方向不确定性，并说明了由此带来的权衡？可多选。\n\nA. 选择一个光滑的凸塑性势 $g(\\boldsymbol{\\sigma},\\kappa)$ 能确保在所有应力状态 $\\boldsymbol{\\sigma}$ 下（包括在 $f$ 存在尖角的应力状态下）梯度 $\\partial g/\\partial\\boldsymbol{\\sigma}$ 都是唯一的，因此塑性流动方向是唯一的，避免了相关联流动所需要的集值法锥。然而，由于流动方向不再垂直于 $f$，最大塑性耗散原理和一致性弹塑性切线算子的对称性通常不成立，且Drucker稳定性公设可能被违反；此外，椭圆性的丧失和应变局部化可能比在相关联情况下更早发生。\n\nB. 使用光滑函数 $g(\\boldsymbol{\\sigma},\\kappa)$ 的非相关联流动，既消除了塑性流动方向的不确定性，又保留了相关联正交性的所有推论，包括最大塑性耗散原理、一个变分增量结构、对称的一致性弹塑性切线算子以及Drucker稳定性公设的无条件满足。\n\nC. 在塑性加载过程中，只要选择光滑的 $g(\\boldsymbol{\\sigma},\\kappa)$，无论 $g$ 的凸性及标定如何，都能保证非负的塑性耗散 $\\boldsymbol{\\sigma}:\\dot{\\boldsymbol{\\varepsilon}}^{p}\\ge 0$。\n\nD. 在流动法则中用光滑的 $g(\\boldsymbol{\\sigma},\\kappa)$ 替换非光滑的 $f(\\boldsymbol{\\sigma},\\kappa)$，会改变活化的屈服面，并消除了对一致性条件的需求；在塑性加载期间，应力可以合理地演化到原始集合 $\\{f=0\\}$ 之外。\n\nE. 光滑的 $g(\\boldsymbol{\\sigma},\\kappa)$ 将剪胀性与强度解耦，从而能够对摩擦性材料的体积塑性应变做出更符合实际的预测，但其代价是返回映射算法不再遵循最小化单一凸势的原则，且一致性弹塑性切线算子通常是非对称的，这使得在例如有限元法（FEM）中的数值实现变得复杂。", "solution": "问题陈述是在连续介质力学和计算塑性力学领域内的一个有效探究。它具有科学依据、是适定且客观的，并包含足够的信息以根据已建立的理论得出结论。该问题涉及对一类特定材料模型的关联流动法则和非关联流动法则进行比较，这是一个标准且重要的话题。\n\n我们从率无关弹塑性力学的第一性原理开始。总应变率张量 $\\dot{\\boldsymbol{\\varepsilon}}$ 被加性分解为一个弹性部分 $\\dot{\\boldsymbol{\\varepsilon}}^e$ 和一个塑性部分 $\\dot{\\boldsymbol{\\varepsilon}}^p$：\n$$\n\\dot{\\boldsymbol{\\varepsilon}} = \\dot{\\boldsymbol{\\varepsilon}}^e + \\dot{\\boldsymbol{\\varepsilon}}^p\n$$\n应力率 $\\dot{\\boldsymbol{\\sigma}}$ 通过广义Hooke定律与弹性应变率相关，其中用到四阶弹性张量 $\\mathbf{C}^e$：\n$$\n\\dot{\\boldsymbol{\\sigma}} = \\mathbf{C}^e : \\dot{\\boldsymbol{\\varepsilon}}^e = \\mathbf{C}^e : (\\dot{\\boldsymbol{\\varepsilon}} - \\dot{\\boldsymbol{\\varepsilon}}^p)\n$$\n应力状态被约束在由屈服函数 $f(\\boldsymbol{\\sigma}, \\kappa) \\le 0$ 定义的弹性域内部或其边界上，其中 $\\kappa$ 代表一组控制硬化或软化的内变量。\n\n塑性流动由一个流动法则控制，该法则规定了塑性应变率的方向。通常，这是通过一个塑性势函数 $g(\\boldsymbol{\\sigma}, \\kappa)$ 来给出的：\n$$\n\\dot{\\boldsymbol{\\varepsilon}}^p = \\dot{\\lambda} \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}\n$$\n其中 $\\dot{\\lambda} \\ge 0$ 是塑性乘子，一个标量率参数。Karush-Kuhn-Tucker (KKT) 条件决定了塑性加载-卸载行为：\n$$\n\\dot{\\lambda} \\ge 0, \\quad f(\\boldsymbol{\\sigma}, \\kappa) \\le 0, \\quad \\dot{\\lambda} f(\\boldsymbol{\\sigma}, \\kappa) = 0\n$$\n在塑性变形期间，应力状态必须保持在屈服面上，这个要求被称为一致性条件，即 $\\dot{f}=0$。\n\n如果塑性势与屈服函数相同，即 $g=f$，则该构型被称为**相关联的**。此时流动法则为：\n$$\n\\dot{\\boldsymbol{\\varepsilon}}^p = \\dot{\\lambda} \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}\n$$\n这意味着塑性应变率矢量垂直于屈服面 $f=0$。问题陈述指出屈服面 $f$ 是分段光滑且有尖角的。在此类不可微点，梯度 $\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$ 没有唯一定义。此时，塑性流动方向必须属于法锥，即由相邻光滑屈服面段的极限法线的凸组合构成的集合。这导致在尖角处塑性流动方向的不确定性。\n\n问题提出了一个**非相关联**构型，其中 $g \\neq f$。具体来说，一个光滑（处处可微）的塑性势 $g$ 被用来定义流动法则，而原始的非光滑屈服函数 $f$ 仍被保留以定义弹性域。\n\n此提议的主要优点是解决了不确定性问题。因为 $g$ 是光滑的，其梯度 $\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$ 对于任何应力状态 $\\boldsymbol{\\sigma}$ 都是一个唯一的矢量。因此，塑性流动方向 $\\dot{\\boldsymbol{\\varepsilon}}^p / \\|\\dot{\\boldsymbol{\\varepsilon}}^p\\|$ 处处都有唯一定义，包括在对应于屈服面 $f=0$ 上的尖角或顶点的应力点。\n\n然而，偏离相关联性（$g \\neq f$）会带来深刻的后果和权衡：\n\n1.  **基本原理的丧失**：最大塑性耗散原理指出，对于任何弹性容许的应力状态 $\\boldsymbol{\\sigma}^*$（即 $f(\\boldsymbol{\\sigma}^*) \\le 0$），不等式 $(\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}^*) : \\dot{\\boldsymbol{\\varepsilon}}^p \\ge 0$ 成立。该原理是正交性（$g=f$）和 $f$ 的凸性的直接推论。当 $g \\neq f$ 时，此原理通常不再成立。\n\n2.  **稳定性**：Drucker稳定性公设的材料形式要求，由无穷小应力变化在相应的塑性应变增量上所做的功为非负，即 $\\dot{\\boldsymbol{\\sigma}} : \\dot{\\boldsymbol{\\varepsilon}}^p \\ge 0$。对于相关联流动法则和凸屈服面，在许多硬化法则下这个条件是满足的。在非相关联情况下，该项变为 $\\dot{\\lambda} (\\dot{\\boldsymbol{\\sigma}} : \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}})$。由于一致性条件 $\\dot{f}=0$ 涉及 $\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$，而 $\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$ 不一定与 $\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$ 同向，因此稳定性无法得到保证。这可能导致切线算子的椭圆性丧失，从而预示着材料失稳（如剪切带）的发生可能比相关联情况下更早（即在更低的应变水平或需要更多硬化时）。\n\n3.  **算法和数值上的后果**：一致性弹塑性切线算子 $\\mathbf{C}^{ep} = \\frac{\\partial \\boldsymbol{\\sigma}}{\\partial \\boldsymbol{\\varepsilon}}$ 对于隐式有限元法（FEM）求解器中Newton-Raphson格式的二次收敛至关重要。对于相关联流动法则，$\\mathbf{C}^{ep}$ 是对称的。对于非相关联法则，其结构涉及形如 $(\\dots \\mathbf{C}^e : \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}) \\otimes (\\dots \\mathbf{C}^e : \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}})$ 的张量积，由于 $\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} \\neq \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$，该结构是非对称的。这要求使用非对称求解器，其计算成本比对称求解器更高，且鲁棒性可能更差。此外，用于积分本构方程的返回映射算法所具有的优美的变分结构（在相关联情况下对应于到凸屈服面上的最近点投影）也随之丧失。\n\n4.  **对摩擦性材料的建模优势**：在岩土材料中采用非相关联流动的主要物理动机是将强度（由 $f$ 控制）与剪胀性（塑性体积变化，由 $g$ 控制）解耦。作为抗剪强度度量的摩擦角与 $f$ 的斜率有关。作为剪切过程中体积变化度量的剪胀角与从 $g$ 推导出的流动方向有关。相关联流动（$g=f$）将这两者刚性地联系在一起，常常导致对剪胀性的预测值比实验观测值高出很多。使用 $g \\neq f$ 则可以独立地标定强度和剪胀性，从而对材料行为做出更符合实际的预测。\n\n基于此，我们来评估所给选项。\n\n**A.** 选择一个光滑的凸塑性势 $g(\\boldsymbol{\\sigma},\\kappa)$ 能确保在所有应力状态 $\\boldsymbol{\\sigma}$ 下（包括在 $f$ 存在尖角的应力状态下）梯度 $\\partial g/\\partial\\boldsymbol{\\sigma}$ 都是唯一的，因此塑性流动方向是唯一的，避免了相关联流动所需要的集值法锥。然而，由于流动方向不再垂直于 $f$，最大塑性耗散原理和一致性弹塑性切线算子的对称性通常不成立，且Drucker稳定性公设可能被违反；此外，椭圆性的丧失和应变局部化可能比在相关联情况下更早发生。\n该陈述是正确的。它精确地指出了 $g$ 的光滑性提供了唯一的流动方向，从而解决了不确定性问题。它也正确地列举了主要的理论权衡：最大耗散原理的丧失、Drucker稳定性保证的丧失（以及相关的应变局部化可能更早发生的问题），以及一致性切线模量对称性的丧失。提及 $g$ 是“凸的”是一个常见且合理的假设，尽管光滑性才是梯度唯一性的关键属性。\n**结论：正确。**\n\n**B.** 使用光滑函数 $g(\\boldsymbol{\\sigma},\\kappa)$ 的非相关联流动，既消除了塑性流动方向的不确定性，又保留了相关联正交性的所有推论，包括最大塑性耗散原理、一个变分增量结构、对称的一致性弹塑性切线算子以及Drucker稳定性公设的无条件满足。\n该陈述根本上是错误的。“非相关联”一词本身就意味着不满足相关联性（正交性）的条件。因此，由正交性衍生出的推论（最大耗散、对称切线算子等）通常都会丧失，而非被保留。\n**结论：不正确。**\n\n**C.** 在塑性加载过程中，只要选择光滑的 $g(\\boldsymbol{\\sigma},\\kappa)$，无论 $g$ 的凸性及标定如何，都能保证非负的塑性耗散 $\\boldsymbol{\\sigma}:\\dot{\\boldsymbol{\\varepsilon}}^{p}\\ge 0$。\n该陈述是错误的。塑性耗散率为 $\\mathcal{D}^p = \\boldsymbol{\\sigma}:\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\lambda} (\\boldsymbol{\\sigma}:\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}})$。要使 $\\mathcal{D}^p \\ge 0$，我们需要 $\\boldsymbol{\\sigma}:\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} \\ge 0$。这个条件对于*任意*光滑的 $g$ 的选择是无法保证的。例如，如果 $g$ 是一个球心远离应力空间原点的球面，那么对于某些容许的应力状态，这一项很容易为负。非负耗散是一个热力学约束，必须通过恰当和仔细地选择函数 $g$ 来保证，它不是一个自动成立的推论。\n**结论：不正确。**\n\n**D.** 在流动法则中用光滑的 $g(\\boldsymbol{\\sigma},\\kappa)$ 替换非光滑的 $f(\\boldsymbol{\\sigma},\\kappa)$，会改变活化的屈服面，并消除了对一致性条件的需求；在塑性加载期间，应力可以合理地演化到原始集合 $\\{f=0\\}$ 之外。\n该陈述是错误的。问题明确指出，保留 $f(\\boldsymbol{\\sigma},\\kappa)$ 用于定义应力容许性和一致性。函数 $f$ 仍然是定义弹性域边界的屈服函数。在塑性加载期间，必须强制执行一致性条件 $\\dot{f}=0$，以确保应力状态不违反屈服条件 $f \\le 0$。函数 $g$ 仅决定塑性流动的方向。\n**结论：不正确。**\n\n**E.** 光滑的 $g(\\boldsymbol{\\sigma},\\kappa)$ 将剪胀性与强度解耦，从而能够对摩擦性材料的体积塑性应变做出更符合实际的预测，但其代价是返回映射算法不再遵循最小化单一凸势的原则，且一致性弹塑性切线算子通常是非对称的，这使得在例如有限元法（FEM）中的数值实现变得复杂。\n该陈述是正确的。它准确地描述了在岩土力学中使用非相关联流动的主要实践动机——为了更真实的建模而将剪胀性与强度解耦。它也正确地指出了从计算角度看两个主要的权衡：返回映射算法的变分结构丧失，以及一致性切线算子的非对称性，后者使得数值求解方案变得复杂。\n**结论：正确。**\n\n陈述A和E都提供了正确且互补的解释。陈述A侧重于不确定性的解决以及由此导致的基本理论原理的丧失。陈述E侧重于实际的建模优势以及相关的数值和算法成本。两者都准确地描述了问题中呈现的情况。题目要求选择所有适用项。", "answer": "$$\\boxed{AE}$$", "id": "2616047"}, {"introduction": "本章的最终实践将理论与计算联系起来，要求您实现一个返回映射算法，这是现代有限元分析软件的核心。通过为关联和非关联的 Drucker-Prager 模型编写应力更新程序，您将具体了解流动法则的选择如何转化为一个数值过程 [@problem_id:2616066]。这个练习不仅能巩固您对理论的理解，还能让您体验到本构模型在计算力学中的实际应用。", "problem": "考虑一个处于平面应变状态下的各向同性、线性弹性、小应变固体，其遵循 Drucker–Prager 屈服准则和线性各向同性硬化。总小应变张量记为 $\\boldsymbol{\\varepsilon}$，并假设为平面应变，因此 $\\varepsilon_{zz}=0$ 且 $\\varepsilon_{xz}=\\varepsilon_{yz}=0$。Cauchy 应力张量 $\\boldsymbol{\\sigma}$ 分解为 $\\boldsymbol{\\sigma}=\\boldsymbol{s}-p \\boldsymbol{I}$，其中平均应力 $p= -\\tfrac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma})$（压缩为正），偏应力为 $\\boldsymbol{s}$，其第二不变量度量为 $q=\\sqrt{3 J_{2}}=\\sqrt{\\tfrac{3}{2}} \\lVert \\boldsymbol{s} \\rVert$。各向同性线性弹性定律为 $\\boldsymbol{\\sigma} = 2 G \\operatorname{dev}(\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}^{p}) + 3 K \\operatorname{mean}(\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}^{p}) \\boldsymbol{I}$，其中剪切模量 $G = \\dfrac{E}{2(1+\\nu)}$，体积模量 $K = \\dfrac{E}{3(1-2\\nu)}$，$E$ 是杨氏模量，$\\nu$ 是泊松比，$\\operatorname{mean}(\\cdot)$ 表示迹的三分之一。带有线性各向同性硬化的 Drucker–Prager 屈服函数为\n$$\nf(\\boldsymbol{\\sigma},\\kappa) \\;=\\; q + \\alpha\\, p \\;-\\; \\left( \\sigma_{y0} + H \\kappa \\right),\n$$\n其中 $\\sigma_{y0}$ 是初始屈服应力，$H$ 是硬化模量，$\\alpha$ 是摩擦参数，$\\kappa$ 是硬化变量。对于相关联流动，塑性势等于屈服函数，而对于非相关联流动，塑性势为\n$$\ng(\\boldsymbol{\\sigma}) \\;=\\; q + \\alpha_{\\psi}\\, p,\n$$\n其中 $\\alpha_{\\psi}$ 是剪胀参数（通常 $\\alpha_{\\psi}\\neq \\alpha$）。流动法则是 $\\mathrm{d}\\boldsymbol{\\varepsilon}^{p} = \\mathrm{d}\\gamma \\,\\dfrac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$，其中塑性乘子 $\\mathrm{d}\\gamma \\ge 0$ 满足 Karush–Kuhn–Tucker 条件，并伴随塑性加载期间的一致性条件 $f(\\boldsymbol{\\sigma},\\kappa)=0$ 和线性各向同性硬化 $\\kappa_{n+1}=\\kappa_{n}+\\Delta\\gamma$。\n\n在从初始无应力无应变状态开始的单个比例加载步中，使用后向欧拉弹性预测/塑性修正方法，并结合上述定义，推导并实现一个塑性返回映射算法，以更新相关联和非相关联流动下的应力。该步骤是比例的，意味着总应变增量 $\\Delta \\boldsymbol{\\varepsilon}$ 在一个固定的张量方向上一步施加。\n\n从上面列出的基本定义和定律开始，不要假定任何无法从这些定律推导出的专门公式。特别是，使用以下基础：\n- 使用给定的模量 $E$ 和 $\\nu$ 的各向同性线性弹性。\n- 将应力分解为平均应力和偏应力部分，其中 $p=-\\tfrac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})$ 且 $q=\\sqrt{\\tfrac{3}{2}}\\lVert \\boldsymbol{s}\\rVert$。\n- 如上所述的 Drucker–Prager 屈服和塑性势。\n- 使用 $\\Delta \\boldsymbol{\\varepsilon}^{p}=\\Delta\\gamma \\dfrac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$ 和线性各向同性硬化 $\\kappa_{n+1}=\\kappa_{n}+\\Delta \\gamma$ 的后向欧拉更新。\n\n根据给定的总应变增量，并设步骤开始时 $\\boldsymbol{\\varepsilon}^{p}_{n}=\\boldsymbol{0}$，定义弹性试探应力 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$。如果 $f(\\boldsymbol{\\sigma}^{\\mathrm{tr}},0)\\le 0$，则该步骤是弹性的，更新后的应力等于试探应力。否则，计算以下情况的更新后应力：\n- 相关联流动：在塑性势中使用 $\\alpha_{\\psi}=\\alpha$。\n- 非相关联流动：使用给定的、可能与 $\\alpha$ 不同的 $\\alpha_{\\psi}$。\n\n对于每种情况，将应力修正误差范数定义为塑性修正量的 Frobenius 范数，即\n$$\n\\lVert \\Delta \\boldsymbol{\\sigma}\\rVert_{F} \\;=\\; \\left\\lVert \\boldsymbol{\\sigma}^{\\mathrm{tr}} \\;-\\; \\boldsymbol{\\sigma}_{n+1} \\right\\rVert_{F},\n$$\n单位为兆帕 (MPa)。报告相关联和非相关联更新的此范数。\n\n需要遵守的实现细节：\n- 一致地使用压缩为正的平均应力约定 $p= -\\tfrac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})$。\n- 按规定使用带有 $\\Delta \\boldsymbol{\\varepsilon}^{p}=\\Delta\\gamma \\dfrac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$ 和 $\\kappa$ 中线性各向同性硬化的后向欧拉更新。\n- 对于平面应变，设置 $\\varepsilon_{zz}=0$ 并初始化 $\\varepsilon_{xz}=\\varepsilon_{yz}=0$。\n- 将输入的剪切分量 $\\gamma_{xy}$ 解释为工程剪切应变，因此 $\\varepsilon_{xy}=\\gamma_{xy}/2$。\n\n测试套件。使用以下四个测试用例。对于每个用例，参数以元组形式给出\n$$\n\\left(E\\;\\text{[MPa]},\\, \\nu,\\, \\sigma_{y0}\\;\\text{[MPa]},\\, H\\;\\text{[MPa]},\\, \\alpha,\\, \\alpha_{\\psi},\\, \\varepsilon_{xx},\\, \\varepsilon_{yy},\\, \\gamma_{xy}\\right),\n$$\n其中 $\\varepsilon_{zz}=0$ 且所有应变均无量纲：\n1. $\\left(30000,\\, 0.25,\\, 100,\\, 500,\\, 0.2,\\, 0.05,\\, 0.0,\\, 0.0,\\, 0.001\\right)$。\n2. $\\left(30000,\\, 0.25,\\, 100,\\, 500,\\, 0.2,\\, 0.05,\\, 0.0,\\, 0.0,\\, 0.01\\right)$。\n3. $\\left(30000,\\, 0.25,\\, 100,\\, 500,\\, 0.2,\\, 0.05,\\, -0.006,\\, -0.006,\\, 0.0\\right)$。\n4. $\\left(30000,\\, 0.25,\\, 100,\\, 500,\\, 0.2,\\, 0.05,\\, 0.0,\\, 0.0,\\, 0.0048\\right)$。\n\n您的程序必须：\n- 为每个测试用例实现上述针对相关联和非相关联流动的更新。\n- 对于每个测试用例，计算两个标量输出（单位为兆帕，MPa）：相关联更新的修正范数和非相关联更新的修正范数。\n- 生成单行输出，包含一个含四个元素的列表，每个元素对应一个测试用例，其中每个元素是一个双元素列表，包含相关联和非相关联的修正范数。所有浮点数以 MPa 为单位，并四舍五入到六位小数。例如，一个有效的最终格式是\n$[ [a_{1},b_{1}], [a_{2},b_{2}], [a_{3},b_{3}], [a_{4},b_{4}] ]$\n其中每个 $a_{i}$ 和 $b_{i}$ 是小数点后有六位的浮点数。", "solution": "该问题陈述经核实具有科学依据，论述严谨，客观且完整。它描述了计算塑性理论中的一个标准问题——在平面应变条件下实现 Drucker-Prager 屈服准则的返回映射算法。所有必要的参数和条件都已提供，没有矛盾或含糊之处。因此，我将进行推导和求解。\n\n目标是为具有 Drucker-Prager 塑性和线性各向同性硬化的各向同性线弹性材料，推导并实现一个后向欧拉弹性预测/塑性修正算法。该更新考虑了从初始无应力和无应变状态开始的单个比例应变增量 $\\Delta\\boldsymbol{\\varepsilon}$。\n\n基本控制方程如下：\n1.  **应变增量分解**: $\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^e + \\boldsymbol{\\varepsilon}^p$，其中 $\\boldsymbol{\\varepsilon}^e$ 和 $\\boldsymbol{\\varepsilon}^p$ 分别是弹性和塑性应变张量。\n2.  **各向同性线性弹性**: $\\boldsymbol{\\sigma} = \\mathbb{C}:\\boldsymbol{\\varepsilon}^e = 2G\\,\\operatorname{dev}(\\boldsymbol{\\varepsilon}^e) + K\\,\\operatorname{tr}(\\boldsymbol{\\varepsilon}^e)\\boldsymbol{I}$。使用压缩为正的平均应力定义 $p = -\\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})$ 和相应的体积应变定义 $\\varepsilon_v = \\operatorname{tr}(\\boldsymbol{\\varepsilon})$，弹性定律可以表示为偏应力 $\\boldsymbol{s}$ 和平均应力 $p$ 的形式：$\\boldsymbol{s} = 2G \\boldsymbol{e}^e$ 和 $p = -K \\varepsilon_v^e$，其中 $\\boldsymbol{e}^e = \\operatorname{dev}(\\boldsymbol{\\varepsilon}^e)$ 且 $\\varepsilon_v^e = \\operatorname{tr}(\\boldsymbol{\\varepsilon}^e)$。\n3.  **Drucker–Prager 屈服函数**: $f(\\boldsymbol{\\sigma}, \\kappa) = q + \\alpha p - (\\sigma_{y0} + H\\kappa) = 0$，其中 $q = \\sqrt{\\frac{3}{2}\\boldsymbol{s}:\\boldsymbol{s}}$ 是 von Mises 等效应力，$p$ 是平均应力，$\\alpha$ 是摩擦参数，$\\sigma_{y0}$ 是初始屈服应力，$H$ 是硬化模量，$\\kappa$ 是各向同性硬化变量。\n4.  **塑性势**: $g(\\boldsymbol{\\sigma}) = q + \\alpha_{\\psi} p$，其中 $\\alpha_{\\psi}$ 是剪胀参数。对于相关联流动，$\\alpha_{\\psi} = \\alpha$。\n5.  **流动法则**: 塑性应变增量由后向欧拉积分方案给出，即 $\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\gamma \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}\\Big|_{\\boldsymbol{\\sigma}_{n+1}}$，其中 $\\Delta\\gamma \\ge 0$ 是塑性乘子。\n6.  **硬化定律**: 硬化变量演化为 $\\kappa_{n+1} = \\kappa_n + \\Delta\\gamma$。由于初始状态是无应变的，$\\kappa_n=0$，所以 $\\kappa_{n+1} = \\Delta\\gamma$。\n\n返回映射算法包括一个弹性预测步骤，如果发生屈服，则进行塑性修正步骤。\n\n**弹性预测**\n首先，我们假设整个应变增量 $\\Delta\\boldsymbol{\\varepsilon}$ 是弹性的。弹性试探应力，记为 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$，由总应变 $\\boldsymbol{\\varepsilon}_{n+1} = \\Delta\\boldsymbol{\\varepsilon}$ 计算得出，假设塑性应变没有变化，即 $\\Delta\\boldsymbol{\\varepsilon}^p = \\boldsymbol{0}$。\n$$\n\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathbb{C} : (\\boldsymbol{\\varepsilon}_{n+1} - \\boldsymbol{\\varepsilon}^p_n) = \\mathbb{C} : \\Delta\\boldsymbol{\\varepsilon}\n$$\n因为 $\\boldsymbol{\\varepsilon}^p_n = \\boldsymbol{0}$。\n这可以分解为试探平均应力分量和偏应力分量：\n$$\np^{\\mathrm{tr}} = -K \\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon})\n$$\n$$\n\\boldsymbol{s}^{\\mathrm{tr}} = 2G \\operatorname{dev}(\\Delta\\boldsymbol{\\varepsilon})\n$$\n试探等效应力为 $q^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2} \\boldsymbol{s}^{\\mathrm{tr}}:\\boldsymbol{s}^{\\mathrm{tr}}}$。\n\n**屈服检查**\n我们在试探状态下，使用初始硬化变量 $\\kappa_n=0$ 来评估屈服函数：\n$$\nf^{\\mathrm{tr}} = f(\\boldsymbol{\\sigma}^{\\mathrm{tr}}, 0) = q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - \\sigma_{y0}\n$$\n如果 $f^{\\mathrm{tr}} \\le 0$，则假设正确；该步骤是弹性的。最终应力是试探应力，$\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}}$，且应力修正为零。\n如果 $f^{\\mathrm{tr}} > 0$，则状态在屈服面之外，这是不允许的。需要进行塑性修正，将应力状态返回到更新后的屈服面上。\n\n**塑性修正**\n最终应力 $\\boldsymbol{\\sigma}_{n+1}$ 与试探应力相关，通过考虑塑性应变增量 $\\Delta\\boldsymbol{\\varepsilon}^p$：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\mathbb{C} : (\\boldsymbol{\\varepsilon}_{n+1} - \\boldsymbol{\\varepsilon}^p_{n+1}) = \\mathbb{C} : (\\boldsymbol{\\varepsilon}_{n+1} - (\\boldsymbol{\\varepsilon}^p_n + \\Delta\\boldsymbol{\\varepsilon}^p)) = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\mathbb{C}:\\Delta\\boldsymbol{\\varepsilon}^p\n$$\n代入流动法则，$\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\gamma \\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\Big|_{\\boldsymbol{\\sigma}_{n+1}}$：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\Delta\\gamma \\, \\mathbb{C}:\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\Big|_{\\boldsymbol{\\sigma}_{n+1}}\n$$\n塑性势的梯度为 $\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}} = \\frac{\\partial q}{\\partial\\boldsymbol{\\sigma}} + \\alpha_{\\psi}\\frac{\\partial p}{\\partial\\boldsymbol{\\sigma}}$。其导数为 $\\frac{\\partial q}{\\partial\\boldsymbol{\\sigma}} = \\frac{3}{2q}\\boldsymbol{s}$ 和 $\\frac{\\partial p}{\\partial\\boldsymbol{\\sigma}} = -\\frac{1}{3}\\boldsymbol{I}$。因此：\n$$\n\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\Big|_{\\boldsymbol{\\sigma}_{n+1}} = \\frac{3}{2q_{n+1}}\\boldsymbol{s}_{n+1} - \\frac{\\alpha_{\\psi}}{3}\\boldsymbol{I}\n$$\n应用弹性算子 $\\mathbb{C}$ 给出：\n$$\n\\mathbb{C}:\\left( \\frac{3}{2q_{n+1}}\\boldsymbol{s}_{n+1} - \\frac{\\alpha_{\\psi}}{3}\\boldsymbol{I} \\right) = 2G\\left(\\frac{3}{2q_{n+1}}\\boldsymbol{s}_{n+1}\\right) - K\\alpha_{\\psi}\\boldsymbol{I} = \\frac{3G}{q_{n+1}}\\boldsymbol{s}_{n+1} - K\\alpha_{\\psi}\\boldsymbol{I}\n$$\n应力更新方程变为：\n$$\n\\boldsymbol{s}_{n+1} - p_{n+1}\\boldsymbol{I} = (\\boldsymbol{s}^{\\mathrm{tr}} - p^{\\mathrm{tr}}\\boldsymbol{I}) - \\Delta\\gamma\\left(\\frac{3G}{q_{n+1}}\\boldsymbol{s}_{n+1} - K\\alpha_{\\psi}\\boldsymbol{I}\\right)\n$$\n将其分解为偏应力部分和体积部分得到：\n$$\n\\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\mathrm{tr}} - \\Delta\\gamma \\frac{3G}{q_{n+1}}\\boldsymbol{s}_{n+1} \\implies \\boldsymbol{s}_{n+1}\\left(1 + \\frac{3G\\Delta\\gamma}{q_{n+1}}\\right) = \\boldsymbol{s}^{\\mathrm{tr}}\n$$\n$$\np_{n+1} = p^{\\mathrm{tr}} - \\Delta\\gamma K\\alpha_{\\psi}\n$$\n从偏应力方程中，我们可以看到 $\\boldsymbol{s}_{n+1}$ 和 $\\boldsymbol{s}^{\\mathrm{tr}}$ 是共线的。对此方程取范数 $\\sqrt{\\frac{3}{2}(\\cdot):(\\cdot)}$ 得到 $q_{n+1}(1 + \\frac{3G\\Delta\\gamma}{q_{n+1}}) = q^{\\mathrm{tr}}$，简化为：\n$$\nq_{n+1} = q^{\\mathrm{tr}} - 3G\\Delta\\gamma\n$$\n我们现在有了 $p_{n+1}$ 和 $q_{n+1}$ 关于未知数 $\\Delta\\gamma$ 的表达式。我们使用一致性条件 $f(\\boldsymbol{\\sigma}_{n+1}, \\kappa_{n+1})=0$ 来求解 $\\Delta\\gamma$：\n$$\nq_{n+1} + \\alpha p_{n+1} - (\\sigma_{y0} + H\\kappa_{n+1}) = 0\n$$\n代入 $q_{n+1}$、$p_{n+1}$ 和 $\\kappa_{n+1}=\\Delta\\gamma$ 的表达式：\n$$\n(q^{\\mathrm{tr}} - 3G\\Delta\\gamma) + \\alpha(p^{\\mathrm{tr}} - K\\alpha_{\\psi}\\Delta\\gamma) - (\\sigma_{y0} + H\\Delta\\gamma) = 0\n$$\n整理以求解 $\\Delta\\gamma$：\n$$\n(q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - \\sigma_{y0}) = \\Delta\\gamma(3G + H + \\alpha K \\alpha_{\\psi})\n$$\n左括号中的项是 $f^{\\mathrm{tr}}$。这给出了塑性乘子：\n$$\n\\Delta\\gamma = \\frac{f^{\\mathrm{tr}}}{3G + H + \\alpha K \\alpha_{\\psi}}\n$$\n只要更新后的应力位于屈服锥的锥面部分（$q_{n+1} \\ge 0$），此解就有效。如果 $q^{\\mathrm{tr}} - 3G\\Delta\\gamma < 0$，则试探状态位于一个映射到屈服锥顶点（$q_{n+1}=0$）的区域。这种“顶点返回”的条件可以通过代入 $\\Delta\\gamma$ 的表达式找到：\n$$\n\\frac{q^{\\mathrm{tr}}}{3G} < \\frac{q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - \\sigma_{y0}}{3G + H + \\alpha K \\alpha_{\\psi}} \\implies 3G(\\alpha p^{\\mathrm{tr}} - \\sigma_{y0}) > q^{\\mathrm{tr}}(H + \\alpha K\\alpha_{\\psi})\n$$\n如果此条件成立，则返回到顶点。此时 $q_{n+1}=0$，从 $q_{n+1} = q^{\\mathrm{tr}} - 3G\\Delta\\gamma$ 中，我们发现 $\\Delta\\gamma = q^{\\mathrm{tr}}/(3G)$。\n\n**应力修正范数**\n应力修正是 $\\Delta\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\boldsymbol{\\sigma}_{n+1}$。我们需要计算它的 Frobenius 范数 $||\\Delta\\boldsymbol{\\sigma}||_F$。从返回映射方程，$\\Delta\\boldsymbol{\\sigma} = \\Delta\\gamma\\,\\mathbb{C}:\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\Big|_{\\boldsymbol{\\sigma}_{n+1}}$。\n$$\n\\Delta\\boldsymbol{\\sigma} = \\Delta\\gamma\\left(\\frac{3G}{q_{n+1}}\\boldsymbol{s}_{n+1} - K\\alpha_{\\psi}\\boldsymbol{I}\\right)\n$$\n其 Frobenius 范数的平方是 $||\\Delta\\boldsymbol{\\sigma}||_F^2 = \\operatorname{tr}(\\Delta\\boldsymbol{\\sigma}^T \\Delta\\boldsymbol{\\sigma})$。因为 $\\boldsymbol{s}_{n+1}$ 是偏张量而 $\\boldsymbol{I}$ 是球张量，它们是正交的，即 $\\operatorname{tr}(\\boldsymbol{s}_{n+1}^T \\boldsymbol{I})=0$。\n$$\n||\\Delta\\boldsymbol{\\sigma}||_F^2 = (\\Delta\\gamma)^2 \\left( \\left\\|\\frac{3G}{q_{n+1}}\\boldsymbol{s}_{n+1}\\right\\|_F^2 + \\|-K\\alpha_{\\psi}\\boldsymbol{I}\\|_F^2 \\right)\n$$\n使用 $||\\boldsymbol{s}_{n+1}||_F^2 = \\frac{2}{3}q_{n+1}^2$ 和 $||\\boldsymbol{I}||_F^2 = 3$：\n$$\n||\\Delta\\boldsymbol{\\sigma}||_F^2 = (\\Delta\\gamma)^2 \\left( \\left(\\frac{3G}{q_{n+1}}\\right)^2\\left(\\frac{2}{3}q_{n+1}^2\\right) + (K\\alpha_{\\psi})^2(3) \\right) = (\\Delta\\gamma)^2(6G^2 + 3K^2\\alpha_{\\psi}^2)\n$$\n因此，修正范数为：\n$$\n||\\Delta\\boldsymbol{\\sigma}||_F = \\Delta\\gamma \\sqrt{6G^2 + 3K^2\\alpha_{\\psi}^2}\n$$\n此公式适用于常规返回和顶点返回两种情况，只需使用相应的 $\\Delta\\gamma$ 值即可。\n\n**算法总结**\n对于每个测试用例和每种流动法则（相关联流动 $\\alpha_{\\psi}=\\alpha$，以及非相关联流动使用给定的 $\\alpha_{\\psi}$）：\n1.  根据 $E$ 和 $\\nu$ 计算弹性模量 $G$ 和 $K$。\n2.  根据给定的应变增量 $\\Delta\\boldsymbol{\\varepsilon}$ 计算试探应力不变量 $p^{\\mathrm{tr}}$ 和 $q^{\\mathrm{tr}}$。\n3.  评估试探屈服函数 $f^{\\mathrm{tr}} = q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - \\sigma_{y0}$。\n4.  如果 $f^{\\mathrm{tr}} \\le 0$，则该步骤是弹性的。修正范数为 $0$。\n5.  如果 $f^{\\mathrm{tr}} > 0$，则该步骤是塑性的：\n    a. 检查顶点返回条件：$3G(\\alpha p^{\\mathrm{tr}} - \\sigma_{y0}) > q^{\\mathrm{tr}}(H + \\alpha K\\alpha_{\\psi})$。\n    b. 如果是顶点返回，$\\Delta\\gamma = q^{\\mathrm{tr}}/(3G)$。\n    c. 否则（常规返回），$\\Delta\\gamma = f^{\\mathrm{tr}} / (3G + H + \\alpha K\\alpha_{\\psi})$。\n    d. 使用 $||\\Delta\\boldsymbol{\\sigma}||_F = \\Delta\\gamma \\sqrt{6G^2 + 3K^2\\alpha_{\\psi}^2}$ 计算修正范数。\n\n该过程将对所提供的测试用例进行实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_correction_norm(E, nu, sig_y0, H, alpha, alpha_psi, eps_xx, eps_yy, gamma_xy):\n    \"\"\"\n    Calculates the stress correction norm for a single step of loading\n    for a Drucker-Prager material.\n\n    Args:\n        E (float): Young's modulus [MPa]\n        nu (float): Poisson's ratio\n        sig_y0 (float): Initial yield stress [MPa]\n        H (float): Hardening modulus [MPa]\n        alpha (float): Friction parameter\n        alpha_psi (float): Dilatancy parameter\n        eps_xx (float): Normal strain in x-direction\n        eps_yy (float): Normal strain in y-direction\n        gamma_xy (float): Engineering shear strain in xy-plane\n\n    Returns:\n        float: The Frobenius norm of the stress correction [MPa].\n    \"\"\"\n    # 1. Calculate elastic moduli\n    G = E / (2 * (1 + nu))\n    K = E / (3 * (1 - 2 * nu))\n\n    # 2. Compute the trial stress state\n    # Strain tensor components\n    eps_xy = gamma_xy / 2.0\n    \n    # Volumetric strain\n    eps_v = eps_xx + eps_yy\n    \n    # Trial mean stress (compression positive)\n    p_tr = -K * eps_v\n    \n    # Deviatoric strain components\n    e_xx = eps_xx - eps_v / 3.0\n    e_yy = eps_yy - eps_v / 3.0\n    e_zz = -eps_v / 3.0 # Plane strain condition eps_zz = 0\n    e_xy = eps_xy\n    \n    # Trial deviatoric stress components\n    s_tr_xx = 2 * G * e_xx\n    s_tr_yy = 2 * G * e_yy\n    s_tr_zz = 2 * G * e_zz\n    s_tr_xy = 2 * G * e_xy\n    \n    # Trial equivalent stress (q)\n    # s_tr:s_tr = s_tr_xx^2 + s_tr_yy^2 + s_tr_zz^2 + 2*s_tr_xy^2\n    s_tr_F_sq = s_tr_xx**2 + s_tr_yy**2 + s_tr_zz**2 + 2 * s_tr_xy**2\n    q_tr = np.sqrt(3.0 / 2.0 * s_tr_F_sq)\n    \n    # 3. Evaluate the trial yield function\n    f_tr = q_tr + alpha * p_tr - sig_y0\n    \n    delta_gamma = 0.0\n    # 4. Check for plastic loading\n    if f_tr > 1e-9: # Use a small tolerance for floating point comparison\n        # 5. Plastic step: calculate plastic multiplier delta_gamma\n        denominator = 3*G + H + alpha * K * alpha_psi\n        \n        # Check for apex return condition\n        # This condition is equivalent to seeing if the standard radial return would result in q < 0\n        is_apex = False\n        if denominator > 1e-9:\n             # Apex return if 3*G*(alpha*p_tr - sig_y0) > q_tr*(H + alpha*K*alpha_psi)\n            if 3*G*(alpha*p_tr - sig_y0) > q_tr*(H + alpha*K*alpha_psi):\n                is_apex = True\n\n        if is_apex:\n            if G > 1e-9:\n                delta_gamma = q_tr / (3 * G)\n            else:\n                 delta_gamma = 0.0 # Should not happen with real materials\n        else: # Regular return\n            if denominator > 1e-9:\n                delta_gamma = f_tr / denominator\n            else:\n                delta_gamma = 0.0 # Unstable material response\n    \n    # 6. Calculate the stress correction norm\n    correction_norm = delta_gamma * np.sqrt(6 * G**2 + 3 * (K * alpha_psi)**2)\n    \n    return correction_norm\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    test_cases = [\n        # (E [MPa], nu, sigma_y0 [MPa], H [MPa], alpha, alpha_psi, eps_xx, eps_yy, gamma_xy)\n        (30000, 0.25, 100, 500, 0.2, 0.05, 0.0, 0.0, 0.001),\n        (30000, 0.25, 100, 500, 0.2, 0.05, 0.0, 0.0, 0.01),\n        (30000, 0.25, 100, 500, 0.2, 0.05, -0.006, -0.006, 0.0),\n        (30000, 0.25, 100, 500, 0.2, 0.05, 0.0, 0.0, 0.0048),\n    ]\n\n    results = []\n    for case in test_cases:\n        E, nu, sig_y0, H, alpha, alpha_psi_non_assoc, eps_xx, eps_yy, gamma_xy = case\n        \n        # Associated flow: use alpha_psi = alpha\n        norm_assoc = calculate_correction_norm(E, nu, sig_y0, H, alpha, alpha, eps_xx, eps_yy, gamma_xy)\n        \n        # Non-associated flow: use the given alpha_psi\n        norm_non_assoc = calculate_correction_norm(E, nu, sig_y0, H, alpha, alpha_psi_non_assoc, eps_xx, eps_yy, gamma_xy)\n        \n        # Format results to six decimal places as required\n        formatted_norms = [f\"{norm_assoc:.6f}\", f\"{norm_non_assoc:.6f}\"]\n        results.append(f\"[{','.join(formatted_norms)}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2616066"}]}