{"hands_on_practices": [{"introduction": "柔度张量的最直接应用是预测材料在给定应力状态下的变形。第一个练习提供了一个关于正交各向异性材料的具体例子，这是复合材料和木材等天然材料的常用模型。通过计算单轴拉伸下的应变响应，你将获得应用广义胡克定律的实践经验，并体会各向异性如何体现为不同方向上的不同变形。[@problem_id:2696784]", "problem": "一个正交各向异性线性弹性固体，其主材料轴与笛卡尔坐标系 $x_{1}$、$x_{2}$ 和 $x_{3}$ 对齐。本构关系由四阶柔度张量 $\\mathsf{S}$ 给出，即 $\\epsilon_{ij}=\\mathsf{S}_{ijkl}\\,\\sigma_{kl}$，其中 $\\epsilon_{ij}$ 是小应变张量，$\\sigma_{ij}$ 是 Cauchy 应力张量。该材料的工程常数（沿正交各向异性主轴方向）为：\n- 杨氏模量：$E_{1}=160\\ \\mathrm{GPa}$，$E_{2}=12\\ \\mathrm{GPa}$，$E_{3}=12\\ \\mathrm{GPa}$，\n- 泊松比：$\\nu_{12}=0.30$，$\\nu_{13}=0.25$，$\\nu_{23}=0.35$，\n- 剪切模量：$G_{12}=5\\ \\mathrm{GPa}$，$G_{13}=5\\ \\mathrm{GPa}$，$G_{23}=4\\ \\mathrm{GPa}$。\n\n假设标准的正交各向异性对称性和互易关系成立（因此柔度张量具有通常的主对称性和次对称性）。该固体承受单轴应力状态，其中 $\\sigma_{11}=200\\ \\mathrm{MPa}$，所有其他应力分量为零，即 $\\sigma_{22}=\\sigma_{33}=\\sigma_{23}=\\sigma_{13}=\\sigma_{12}=0$。\n\n使用正交各向异性线性弹性材料在其主方向上的四阶柔度张量，确定纵向应变 $\\epsilon_{11}$以及横向应变 $\\epsilon_{22}$ 和 $\\epsilon_{33}$。\n\n答案要求：\n- 将每个应变表示为无量纲小数。\n- 将每个应变四舍五入到四位有效数字。", "solution": "首先应对问题进行严格的验证过程。\n\n步骤 1：提取已知条件\n问题陈述提供了以下信息：\n- 材料模型：正交各向异性线性弹性固体。\n- 坐标系：主材料轴与笛卡尔坐标系 $x_{1}$、$x_{2}$、$x_{3}$ 对齐。\n- 本构关系：$\\epsilon_{ij}=\\mathsf{S}_{ijkl}\\,\\sigma_{kl}$，其中 $\\mathsf{S}$ 是四阶柔度张量。\n- 工程常数：\n  - 杨氏模量：$E_{1}=160\\ \\mathrm{GPa}$，$E_{2}=12\\ \\mathrm{GPa}$，$E_{3}=12\\ \\mathrm{GPa}$。\n  - 泊松比：$\\nu_{12}=0.30$，$\\nu_{13}=0.25$，$\\nu_{23}=0.35$。\n  - 剪切模量：$G_{12}=5\\ \\mathrm{GPa}$，$G_{13}=5\\ \\mathrm{GPa}$，$G_{23}=4\\ \\mathrm{GPa}$。\n- 假设：标准的正交各向异性对称性和互易关系成立。\n- 加载条件：单轴应力状态，$\\sigma_{11}=200\\ \\mathrm{MPa}$，所有其他应力分量为零，即 $\\sigma_{22}=\\sigma_{33}=\\sigma_{23}=\\sigma_{13}=\\sigma_{12}=0$。注意，当 $i \\neq j$ 时，剪应力 $\\tau_{ij}$ 等同于 $\\sigma_{ij}$。\n- 要求输出：确定应变 $\\epsilon_{11}$、$\\epsilon_{22}$ 和 $\\epsilon_{33}$。\n- 格式要求：将应变表示为无量纲小数，四舍五入到四位有效数字。\n\n步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学性**：该问题是在成熟的各向异性材料线性弹性理论框架内提出的。正交各向异性弹性是木材和纤维增强复合材料等材料的标准模型。本构关系 $\\epsilon_{ij}=\\mathsf{S}_{ijkl}\\,\\sigma_{kl}$ 是正确的广义胡克定律。\n- **适定性**：该问题要求计算在指定应力状态下产生的应变分量。给定材料的工程常数，本构定律提供了从应力到应变的直接且唯一的映射。因此，该问题是适定的。\n- **客观性**：该问题使用固体力学中的精确、标准术语进行陈述。它没有歧义和主观内容。\n- **不完整或矛盾的设定**：该问题提供了在指定单轴应力条件下计算所需应变的所有必要工程常数（$\\sigma_{11}$、$E_1$、$\\nu_{12}$、$\\nu_{13}$）。它还明确指出互易关系成立，这是确保柔度张量和刚度张量对称性的标准假设。\n- **不切实际或不可行**：所提供的工程常数必须满足热力学稳定性条件，这要求柔度矩阵是正定的。这些条件是 $E_i > 0$、$G_{ij} > 0$，以及对泊松比的几项约束。所有模量均为正值。让我们验证柔度矩阵左上角 $3 \\times 3$ 子块的行列式为正。该稳定性条件为 $1 - \\nu_{12}\\nu_{21} - \\nu_{23}\\nu_{32} - \\nu_{13}\\nu_{31} - 2 \\nu_{21}\\nu_{32}\\nu_{13} > 0$。使用互易关系 $\\nu_{ji} = \\nu_{ij} (E_j/E_i)$，我们计算：\n$\\nu_{21} = \\nu_{12} \\frac{E_2}{E_1} = 0.30 \\frac{12}{160} = 0.0225$。\n$\\nu_{31} = \\nu_{13} \\frac{E_3}{E_1} = 0.25 \\frac{12}{160} = 0.01875$。\n$\\nu_{32} = \\nu_{23} \\frac{E_3}{E_2} = 0.35 \\frac{12}{12} = 0.35$。\n代入数值：$1 - (0.30)(0.0225) - (0.35)(0.35) - (0.25)(0.01875) - 2(0.0225)(0.35)(0.25) > 0$。\n$1 - 0.00675 - 0.1225 - 0.0046875 - 0.0039375 \\approx 1 - 0.137875 = 0.862125 > 0$。\n这些常数在物理上是一致的。$200\\ \\mathrm{MPa}$ 的应力值是合理的。\n\n步骤 3：结论和行动\n该问题在科学上是合理的、适定的，并包含充分、一致的数据。该问题有效。将提供解答。\n\n对于主轴与坐标轴对齐的线性弹性正交各向异性材料，其本构关系由下式给出：\n$$ \\epsilon_{11} = \\frac{1}{E_1}\\sigma_{11} - \\frac{\\nu_{21}}{E_2}\\sigma_{22} - \\frac{\\nu_{31}}{E_3}\\sigma_{33} $$\n$$ \\epsilon_{22} = -\\frac{\\nu_{12}}{E_1}\\sigma_{11} + \\frac{1}{E_2}\\sigma_{22} - \\frac{\\nu_{32}}{E_3}\\sigma_{33} $$\n$$ \\epsilon_{33} = -\\frac{\\nu_{13}}{E_1}\\sigma_{11} - \\frac{\\nu_{23}}{E_2}\\sigma_{22} + \\frac{1}{E_3}\\sigma_{33} $$\n$$ \\gamma_{23} = 2\\epsilon_{23} = \\frac{1}{G_{23}}\\sigma_{23} $$\n$$ \\gamma_{13} = 2\\epsilon_{13} = \\frac{1}{G_{13}}\\sigma_{13} $$\n$$ \\gamma_{12} = 2\\epsilon_{12} = \\frac{1}{G_{12}}\\sigma_{12} $$\n柔度张量的对称性要求互易关系成立：$\\frac{\\nu_{ij}}{E_i} = \\frac{\\nu_{ji}}{E_j}$。这已在验证中使用并被接受。\n\n问题指定了 $x_1$ 方向上的单轴应力状态。应力张量的分量为：\n$$ \\sigma_{11} = 200\\ \\mathrm{MPa} = 200 \\times 10^6\\ \\mathrm{Pa} $$\n$$ \\sigma_{22} = \\sigma_{33} = \\sigma_{23} = \\sigma_{13} = \\sigma_{12} = 0 $$\n将这些应力分量代入正应变的本构方程，可以得到显著的简化：\n对于纵向应变 $\\epsilon_{11}$：\n$$ \\epsilon_{11} = \\frac{1}{E_1}\\sigma_{11} - \\frac{\\nu_{21}}{E_2}(0) - \\frac{\\nu_{31}}{E_3}(0) = \\frac{\\sigma_{11}}{E_1} $$\n对于横向应变 $\\epsilon_{22}$：\n$$ \\epsilon_{22} = -\\frac{\\nu_{12}}{E_1}\\sigma_{11} + \\frac{1}{E_2}(0) - \\frac{\\nu_{32}}{E_3}(0) = -\\frac{\\nu_{12}}{E_1}\\sigma_{11} = -\\nu_{12} \\epsilon_{11} $$\n对于横向应变 $\\epsilon_{33}$：\n$$ \\epsilon_{33} = -\\frac{\\nu_{13}}{E_1}\\sigma_{11} - \\frac{\\nu_{23}}{E_2}(0) + \\frac{1}{E_3}(0) = -\\frac{\\nu_{13}}{E_1}\\sigma_{11} = -\\nu_{13} \\epsilon_{11} $$\n请注意，对于此特定计算，仅需要 $E_1$、$\\nu_{12}$ 和 $\\nu_{13}$。对于此特定载荷工况，其他常数是无关的。\n\n现在，我们代入给定的数值：\n$E_1 = 160\\ \\mathrm{GPa} = 160 \\times 10^9\\ \\mathrm{Pa}$\n$\\sigma_{11} = 200\\ \\mathrm{MPa} = 200 \\times 10^6\\ \\mathrm{Pa}$\n$\\nu_{12} = 0.30$\n$\\nu_{13} = 0.25$\n\n计算纵向应变 $\\epsilon_{11}$：\n$$ \\epsilon_{11} = \\frac{200 \\times 10^6\\ \\mathrm{Pa}}{160 \\times 10^9\\ \\mathrm{Pa}} = \\frac{200}{160000} = \\frac{1}{800} = 0.00125 $$\n计算横向应变 $\\epsilon_{22}$：\n$$ \\epsilon_{22} = -\\nu_{12} \\times \\epsilon_{11} = -0.30 \\times 0.00125 = -0.000375 $$\n计算横向应变 $\\epsilon_{33}$：\n$$ \\epsilon_{33} = -\\nu_{13} \\times \\epsilon_{11} = -0.25 \\times 0.00125 = -0.0003125 $$\n问题要求答案四舍五入到四位有效数字。\n- 对于 $\\epsilon_{11} = 0.00125$，其四位有效数字表示为 $0.001250$。\n- 对于 $\\epsilon_{22} = -0.000375$，其四位有效数字表示为 $-0.0003750$。\n- 对于 $\\epsilon_{33} = -0.0003125$，该值已有四位有效数字（$3, 1, 2, 5$）。\n\n因此，应变的最终值为：\n$\\epsilon_{11} = 0.001250$\n$\\epsilon_{22} = -0.0003750$\n$\\epsilon_{33} = -0.0003125$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.001250 & -0.0003750 & -0.0003125\n\\end{pmatrix}\n}\n$$", "id": "2696784"}, {"introduction": "在使用本构关系求解应变之后，一个自然的后续问题是：柔度张量本身是如何构建的？本实践将指导你从基本的工程常数出发，为正交各向异性材料构建完整的 $6 \\times 6$ 柔度矩阵。这个过程对于将杨氏模量 $E$、泊松比 $\\nu$ 等实验数据转化为可用的矩阵形式至关重要，并能巩固 Voigt 标记法的实际应用。[@problem_id:2696799]", "problem": "一个均匀的线性弹性正交各向异性固体，其与一个标准正交材料基 $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$ 对齐，使得主材料方向与坐标轴重合。设其弹性行为在小应变、小应力范围内由四阶柔度张量 $\\mathsf{S}$ 描述，因此广义胡克定律可写为 $\\varepsilon_{ij} = S_{ijkl}\\,\\sigma_{kl}$。采用 Voigt 记法，其顺序为 $\\{11,22,33,23,31,12\\}$，并使用工程剪切应变，即 $\\gamma_{23}=2\\varepsilon_{23}$, $\\gamma_{31}=2\\varepsilon_{31}$ 和 $\\gamma_{12}=2\\varepsilon_{12}$。独立的正交各向异性弹性常数给定如下：杨氏模量 $E_{1}=150\\,\\mathrm{GPa}$，$E_{2}=100\\,\\mathrm{GPa}$，$E_{3}=80\\,\\mathrm{GPa}$；剪切模量 $G_{23}=40\\,\\mathrm{GPa}$，$G_{31}=35\\,\\mathrm{GPa}$，$G_{12}=50\\,\\mathrm{GPa}$；以及主泊松比 $\\nu_{12}=0.25$，$\\nu_{23}=0.30$，$\\nu_{31}=0.28$。\n\n从一般线性弹性关系和正交各向异性在其主轴上的定义出发，并应用源于线性弹性材料 Maxwell–Betti 定理的互易/对称条件，推导在所述工程剪切约定下正交各向异性固体的 Voigt 形式柔度矩阵的结构。然后，使用给定数据，组装完整的 Voigt 记法下的 $6\\times 6$ 柔度矩阵 $[\\mathbf{S}]$。\n\n以数值形式表示最终矩阵的每个元素，单位为 $\\mathrm{GPa}^{-1}$。将每个矩阵元素四舍五入到四位有效数字。以 $6\\times 6$ 矩阵的形式提供最终答案。", "solution": "提交分析的问题陈述被认为是有效的。这是一个线性弹性力学中的适定问题，基于连续介质力学的既定原理。它是自洽的、一致的，并且没有任何科学或逻辑上的缺陷。我们将着手进行推导和求解。\n\n线性弹性材料的本构关系是广义胡克定律，它通过四阶柔度张量 $\\mathsf{S}$ 将二阶应变张量 $\\boldsymbol{\\varepsilon}$ 与二阶应力张量 $\\boldsymbol{\\sigma}$ 联系起来：\n$$\n\\varepsilon_{ij} = S_{ijkl}\\,\\sigma_{kl}\n$$\n此处默认为对重复指标 $k$ 和 $l$ 求和。对于一个主材料方向与标准正交基 $\\{\\mathbf{e}_1, \\mathbf{e}_2, \\mathbf{e}_3\\}$ 的轴向对齐的均匀正交各向异性材料，应变张量分量的本构关系可以用工程弹性常数表示如下：\n$$\n\\varepsilon_{11} = \\frac{1}{E_1}\\sigma_{11} - \\frac{\\nu_{21}}{E_2}\\sigma_{22} - \\frac{\\nu_{31}}{E_3}\\sigma_{33}\n$$\n$$\n\\varepsilon_{22} = -\\frac{\\nu_{12}}{E_1}\\sigma_{11} + \\frac{1}{E_2}\\sigma_{22} - \\frac{\\nu_{32}}{E_3}\\sigma_{33}\n$$\n$$\n\\varepsilon_{33} = -\\frac{\\nu_{13}}{E_1}\\sigma_{11} - \\frac{\\nu_{23}}{E_2}\\sigma_{22} + \\frac{1}{E_3}\\sigma_{33}\n$$\n对于剪切分量，张量剪切应变通过以下关系与剪切应力相关：\n$$\n\\varepsilon_{23} = \\frac{1}{2G_{23}}\\sigma_{23}, \\quad \\varepsilon_{31} = \\frac{1}{2G_{31}}\\sigma_{31}, \\quad \\varepsilon_{12} = \\frac{1}{2G_{12}}\\sigma_{12}\n$$\n问题要求使用 Voigt 记法和工程剪切应变。应力向量 $\\{\\boldsymbol{\\sigma}\\}$ 和应变向量 $\\{\\boldsymbol{\\varepsilon}\\}_{\\text{eng}}$ 定义为：\n$$\n\\{\\boldsymbol{\\sigma}\\} = \\begin{pmatrix} \\sigma_1 \\\\ \\sigma_2 \\\\ \\sigma_3 \\\\ \\sigma_4 \\\\ \\sigma_5 \\\\ \\sigma_6 \\end{pmatrix} = \\begin{pmatrix} \\sigma_{11} \\\\ \\sigma_{22} \\\\ \\sigma_{33} \\\\ \\sigma_{23} \\\\ \\sigma_{31} \\\\ \\sigma_{12} \\end{pmatrix}, \\quad \\{\\boldsymbol{\\varepsilon}\\}_{\\text{eng}} = \\begin{pmatrix} \\varepsilon_1 \\\\ \\varepsilon_2 \\\\ \\varepsilon_3 \\\\ \\varepsilon_4 \\\\ \\varepsilon_5 \\\\ \\varepsilon_6 \\end{pmatrix} = \\begin{pmatrix} \\varepsilon_{11} \\\\ \\varepsilon_{22} \\\\ \\varepsilon_{33} \\\\ \\gamma_{23} \\\\ \\gamma_{31} \\\\ \\gamma_{12} \\end{pmatrix} = \\begin{pmatrix} \\varepsilon_{11} \\\\ \\varepsilon_{22} \\\\ \\varepsilon_{33} \\\\ 2\\varepsilon_{23} \\\\ 2\\varepsilon_{31} \\\\ 2\\varepsilon_{12} \\end{pmatrix}\n$$\n在此记法中，本构定律以矩阵形式写为：$\\{\\boldsymbol{\\varepsilon}\\}_{\\text{eng}} = [\\mathbf{S}] \\{\\boldsymbol{\\sigma}\\}$，其中 $[\\mathbf{S}]$ 是 $6 \\times 6$ 柔度矩阵。对于与坐标轴对齐的正交各向异性材料，该矩阵呈现一种特定的块对角形式：\n$$\n[\\mathbf{S}] =\n\\begin{pmatrix}\nS_{11} & S_{12} & S_{13} & 0 & 0 & 0 \\\\\nS_{21} & S_{22} & S_{23} & 0 & 0 & 0 \\\\\nS_{31} & S_{32} & S_{33} & 0 & 0 & 0 \\\\\n0 & 0 & 0 & S_{44} & 0 & 0 \\\\\n0 & 0 & 0 & 0 & S_{55} & 0 \\\\\n0 & 0 & 0 & 0 & 0 & S_{66}\n\\end{pmatrix}\n$$\n应变能密度函数的存在（这是材料为弹性而非仅仅是亚弹性的一个推论）意味着柔度张量具有主对称性，$S_{ijkl} = S_{klij}$。此条件是 Maxwell-Betti 互易定理应用于材料微元的结果，它确保了柔度矩阵 $[\\mathbf{S}]$ 是对称的，即 $S_{IJ} = S_{JI}$。\n\n通过将矩阵方程 $\\{\\boldsymbol{\\varepsilon}\\}_{\\text{eng}} = [\\mathbf{S}] \\{\\boldsymbol{\\sigma}\\}$ 与分量形式的本构方程进行比较，我们可以确定 $[\\mathbf{S}]$ 的元素。\n对于正分量：\n$$\n\\begin{pmatrix} \\varepsilon_{11} \\\\ \\varepsilon_{22} \\\\ \\varepsilon_{33} \\end{pmatrix}\n=\n\\begin{pmatrix}\nS_{11} & S_{12} & S_{13} \\\\\nS_{21} & S_{22} & S_{23} \\\\\nS_{31} & S_{32} & S_{33}\n\\end{pmatrix}\n\\begin{pmatrix} \\sigma_{11} \\\\ \\sigma_{22} \\\\ \\sigma_{33} \\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{1}{E_1} & -\\frac{\\nu_{21}}{E_2} & -\\frac{\\nu_{31}}{E_3} \\\\\n-\\frac{\\nu_{12}}{E_1} & \\frac{1}{E_2} & -\\frac{\\nu_{32}}{E_3} \\\\\n-\\frac{\\nu_{13}}{E_1} & -\\frac{\\nu_{23}}{E_2} & \\frac{1}{E_3}\n\\end{pmatrix}\n\\begin{pmatrix} \\sigma_{11} \\\\ \\sigma_{22} \\\\ \\sigma_{33} \\end{pmatrix}\n$$\n矩阵的对称性 $S_{IJ}=S_{JI}$ 对泊松比施加了以下约束：\n$S_{12} = S_{21} \\implies -\\frac{\\nu_{21}}{E_2} = -\\frac{\\nu_{12}}{E_1} \\implies \\frac{\\nu_{12}}{E_1} = \\frac{\\nu_{21}}{E_2}$\n$S_{13} = S_{31} \\implies -\\frac{\\nu_{31}}{E_3} = -\\frac{\\nu_{13}}{E_1} \\implies \\frac{\\nu_{13}}{E_1} = \\frac{\\nu_{31}}{E_3}$\n$S_{23} = S_{32} \\implies -\\frac{\\nu_{32}}{E_3} = -\\frac{\\nu_{23}}{E_2} \\implies \\frac{\\nu_{23}}{E_2} = \\frac{\\nu_{32}}{E_3}$\n使用这些对称关系和所提供的独立常数（$\\nu_{12}$，$\\nu_{23}$，$\\nu_{31}$），我们可以将 $[\\mathbf{S}]$ 的左上角 $3 \\times 3$ 子矩阵写为：\n$$\n\\begin{pmatrix}\nS_{11} & S_{12} & S_{13} \\\\\nS_{21} & S_{22} & S_{23} \\\\\nS_{31} & S_{32} & S_{33}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{1}{E_1} & -\\frac{\\nu_{12}}{E_1} & -\\frac{\\nu_{31}}{E_3} \\\\\n-\\frac{\\nu_{12}}{E_1} & \\frac{1}{E_2} & -\\frac{\\nu_{23}}{E_2} \\\\\n-\\frac{\\nu_{31}}{E_3} & -\\frac{\\nu_{23}}{E_2} & \\frac{1}{E_3}\n\\end{pmatrix}\n$$\n对于剪切分量，使用工程剪切应变的定义：\n$\\varepsilon_4 = \\gamma_{23} = 2\\varepsilon_{23} = 2 \\left( \\frac{1}{2G_{23}}\\sigma_{23} \\right) = \\frac{1}{G_{23}}\\sigma_{23}$。\n从 Voigt 形式，我们有 $\\varepsilon_4 = S_{44}\\sigma_4 = S_{44}\\sigma_{23}$。\n比较这些，我们发现 $S_{44} = \\frac{1}{G_{23}}$。\n对其他剪切分量进行相同的推理可得：\n$S_{55} = \\frac{1}{G_{31}}$\n$S_{66} = \\frac{1}{G_{12}}$\n综合这些结果，完整的符号形式柔度矩阵为：\n$$\n[\\mathbf{S}] =\n\\begin{pmatrix}\n\\frac{1}{E_1} & -\\frac{\\nu_{12}}{E_1} & -\\frac{\\nu_{31}}{E_3} & 0 & 0 & 0 \\\\\n-\\frac{\\nu_{12}}{E_1} & \\frac{1}{E_2} & -\\frac{\\nu_{23}}{E_2} & 0 & 0 & 0 \\\\\n-\\frac{\\nu_{31}}{E_3} & -\\frac{\\nu_{23}}{E_2} & \\frac{1}{E_3} & 0 & 0 & 0 \\\\\n0 & 0 & 0 & \\frac{1}{G_{23}} & 0 & 0 \\\\\n0 & 0 & 0 & 0 & \\frac{1}{G_{31}} & 0 \\\\\n0 & 0 & 0 & 0 & 0 & \\frac{1}{G_{12}}\n\\end{pmatrix}\n$$\n现在我们代入所提供的数值：$E_1=150\\,\\mathrm{GPa}$，$E_2=100\\,\\mathrm{GPa}$，$E_3=80\\,\\mathrm{GPa}$，$G_{23}=40\\,\\mathrm{GPa}$，$G_{31}=35\\,\\mathrm{GPa}$，$G_{12}=50\\,\\mathrm{GPa}$，$\\nu_{12}=0.25$，$\\nu_{23}=0.30$，$\\nu_{31}=0.28$。柔度矩阵元素的单位将是 $\\mathrm{GPa}^{-1}$。\n\n$S_{11} = \\frac{1}{150} \\approx 0.0066666... \\to 0.006667$\n$S_{22} = \\frac{1}{100} = 0.01000$\n$S_{33} = \\frac{1}{80} = 0.01250$\n$S_{12} = S_{21} = -\\frac{0.25}{150} \\approx -0.0016666... \\to -0.001667$\n$S_{13} = S_{31} = -\\frac{0.28}{80} = -0.003500$\n$S_{23} = S_{32} = -\\frac{0.30}{100} = -0.003000$\n$S_{44} = \\frac{1}{40} = 0.02500$\n$S_{55} = \\frac{1}{35} \\approx 0.0285714... \\to 0.02857$\n$S_{66} = \\frac{1}{50} = 0.02000$\n\n所有不在左上角 $3 \\times 3$ 块中或不在主对角线上的非对角元素均为零。将元素四舍五入到四位有效数字，组装最终的矩阵：\n$$\n[\\mathbf{S}] =\n\\begin{pmatrix}\n0.006667 & -0.001667 & -0.003500 & 0 & 0 & 0 \\\\\n-0.001667 & 0.01000 & -0.003000 & 0 & 0 & 0 \\\\\n-0.003500 & -0.003000 & 0.01250 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0.02500 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0.02857 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 0.02000\n\\end{pmatrix}\n$$\n这是以 $\\mathrm{GPa}^{-1}$ 为单位的柔度矩阵 $[\\mathbf{S}]$ 的最终数值表示。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.006667 & -0.001667 & -0.003500 & 0 & 0 & 0 \\\\\n-0.001667 & 0.01000 & -0.003000 & 0 & 0 & 0 \\\\\n-0.003500 & -0.003000 & 0.01250 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0.02500 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0.02857 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 0.02000\n\\end{pmatrix}\n}\n$$", "id": "2696799"}, {"introduction": "从解析计算迈向计算力学，需要将抽象的张量方程转化为高效的计算机代码。最后一个实践练习旨在解决核心本构关系收缩运算 $\\boldsymbol{\\epsilon} = \\mathsf{S} : \\boldsymbol{\\sigma}$ 的实现问题。你将探索如何利用应力张量和柔度张量的内在对称性来最小化计算成本，这对于开发如有限元分析软件等高性能数值模拟工具是一项关键技能。[@problem_id:2696786]", "problem": "你需要实现一个四阶柔度张量与一个对称应力张量在三维弹性力学中的缩并运算，并利用张量对称性来避免冗余计算。其数学目标是，根据给定的柔度张量 $\\,S\\,$ 和给定的柯西应力张量 $\\,\\sigma\\,$，通过关系式 $\\,\\epsilon = S : \\sigma\\,$ 计算小应变张量 $\\,\\epsilon\\,$。该实现必须明确使用分量循环，并利用对称性来最小化算术工作量。\n\n从以下基本依据开始：\n- 在小应变、线弹性范围内，本构方程可以写成 $\\,\\epsilon_{ij} = S_{ijkl}\\,\\sigma_{kl}\\,$，其中 $\\,S_{ijkl}\\,$ 是四阶柔度张量，$\\,\\sigma_{kl}\\,$ 是柯西应力张量。\n- 角动量守恒意味着 $\\,\\sigma_{ij} = \\sigma_{ji}\\,$，即 $\\,\\sigma\\,$ 是对称的。\n- 对于可从应变能密度导出的线弹性材料，四阶柔度张量同时具有次对称性与主对称性：$\\,S_{ijkl} = S_{jikl} = S_{ijlk} = S_{klij}\\,$。\n- 对于杨氏模量为 $\\,E\\,$、泊松比为 $\\,\\nu\\,$ 的各向同性材料，柔度张量的一个标准且经过充分检验的表示形式是\n$$\nS_{ijkl} \\;=\\; \\frac{1+\\nu}{2E}\\,\\big(\\delta_{ik}\\delta_{jl}+\\delta_{il}\\delta_{jk}\\big)\\;-\\;\\frac{\\nu}{E}\\,\\delta_{ij}\\delta_{kl},\n$$\n其中 $\\,\\delta_{ij}\\,$ 是克罗内克δ函数。\n\n任务要求：\n1.  实现一个基准的“朴素”缩并，使用显式循环直接计算\n    $$\n    \\epsilon_{ij}^{\\mathrm{naive}} \\;=\\; \\sum_{k=1}^{3}\\sum_{l=1}^{3} S_{ijkl}\\,\\sigma_{kl}.\n    $$\n2.  实现一个“高效”缩并，使用显式循环，利用对称性 $\\,\\sigma_{kl}=\\sigma_{lk}\\,$ 和 $\\,S_{ijkl}=S_{ijlk}\\,$，通过仅对 $\\,k\\le l\\,$ 进行带适当权重的求和来避免冗余计算：\n    $$\n    \\epsilon_{ij}^{\\mathrm{eff}} \\;=\\; \\sum_{k=1}^{3}\\sum_{l=k}^{3} w_{kl}\\,S_{ijkl}\\,\\sigma_{kl}, \\quad \\text{其中} \\quad\n    w_{kl} \\;=\\; \\begin{cases}\n    1, & k=l,\\\\\n    2, & k<l.\n    \\end{cases}\n    $$\n    进一步利用 $\\,\\epsilon_{ij}=\\epsilon_{ji}\\,$，仅计算上三角分量 $\\,i\\le j\\,$，然后将它们镜像到下三角部分。\n\n3.  对于数值实例化，使用上面给出的各向同性形式，从 $\\,E\\,$ 和 $\\,\\nu\\,$ 构建 $\\,S_{ijkl}\\,$。假设所有量均采用国际单位制 (SI)。$\\,E\\,$ 的单位为 $\\mathrm{Pa}$，$\\,\\nu\\,$ 无量纲，$\\,\\sigma\\,$ 的单位为 $\\mathrm{Pa}$。由此产生的应变 $\\,\\epsilon\\,$ 是无量纲的。所有应力张量 $\\,\\sigma\\,$ 在构造上都是对称的。\n\n4.  对于每个测试用例，计算“朴素”缩并和“高效”缩并之间逐项绝对差的最大值，\n    $$\n    d \\;=\\; \\max_{1\\le i,j\\le 3} \\big| \\epsilon_{ij}^{\\mathrm{naive}} - \\epsilon_{ij}^{\\mathrm{eff}} \\big|,\n    $$\n    并将 $\\,d\\,$ 作为绝对应变（无量纲）的浮点数报告。不涉及角度。输出必须将所有测试用例的结果汇总成一行，格式化为逗号分隔的Python风格列表，例如 $[d_1,d_2,\\dots]$。\n\n使用以下测试套件，它涵盖了一般情况、静水压力、纯剪切、零应力边界、近不可压缩材料以及拉胀材料。在每种情况下，提供 $\\,E\\,$ 和 $\\,\\nu\\,$ 以及对称的 $\\,\\sigma\\,$（单位为 $\\mathrm{Pa}$）：\n\n-   情况 1（一般应力，典型金属）：$\\,E = 210\\times 10^{9}\\,\\mathrm{Pa}\\,$, $\\,\\nu = 0.3\\,$,\n    $$\n    \\sigma \\;=\\; \\begin{bmatrix}\n    100\\times 10^{6} & 20\\times 10^{6} & -30\\times 10^{6} \\\\\n    20\\times 10^{6} & -50\\times 10^{6} & 10\\times 10^{6} \\\\\n    -30\\times 10^{6} & 10\\times 10^{6} & 80\\times 10^{6}\n    \\end{bmatrix}\\,\\mathrm{Pa}.\n    $$\n-   情况 2（静水压缩）：$\\,E = 70\\times 10^{9}\\,\\mathrm{Pa}\\,$, $\\,\\nu = 0.33\\,$, $\\,\\sigma = -100\\times 10^{6}\\,\\mathrm{Pa}\\,\\mathbf{I}\\,$。\n-   情况 3（纯剪切）：$\\,E = 30\\times 10^{9}\\,\\mathrm{Pa}\\,$, $\\,\\nu = 0.25\\,$,\n    $$\n    \\sigma \\;=\\; \\begin{bmatrix}\n    0 & 50\\times 10^{6} & 0 \\\\\n    50\\times 10^{6} & 0 & 0 \\\\\n    0 & 0 & 0\n    \\end{bmatrix}\\,\\mathrm{Pa}.\n    $$\n-   情况 4（零应力边界）：$\\,E = 10\\times 10^{9}\\,\\mathrm{Pa}\\,$, $\\,\\nu = 0.2\\,$,\n    $$\n    \\sigma \\;=\\; \\begin{bmatrix}\n    0 & 0 & 0 \\\\\n    0 & 0 & 0 \\\\\n    0 & 0 & 0\n    \\end{bmatrix}\\,\\mathrm{Pa}.\n    $$\n-   情况 5（近不可压缩）：$\\,E = 1\\times 10^{9}\\,\\mathrm{Pa}\\,$, $\\,\\nu = 0.499\\,$,\n    $$\n    \\sigma \\;=\\; \\begin{bmatrix}\n    1\\times 10^{6} & 0.2\\times 10^{6} & -0.1\\times 10^{6} \\\\\n    0.2\\times 10^{6} & -2\\times 10^{6} & 0.05\\times 10^{6} \\\\\n    -0.1\\times 10^{6} & 0.05\\times 10^{6} & 3\\times 10^{6}\n    \\end{bmatrix}\\,\\mathrm{Pa}.\n    $$\n-   情况 6（拉胀材料）：$\\,E = 5\\times 10^{9}\\,\\mathrm{Pa}\\,$, $\\,\\nu = -0.25\\,$,\n    $$\n    \\sigma \\;=\\; \\begin{bmatrix}\n    5\\times 10^{6} & 0.7\\times 10^{6} & -0.4\\times 10^{6} \\\\\n    0.7\\times 10^{6} & 0.5\\times 10^{6} & 0.9\\times 10^{6} \\\\\n    -0.4\\times 10^{6} & 0.9\\times 10^{6} & -3\\times 10^{6}\n    \\end{bmatrix}\\,\\mathrm{Pa}.\n    $$\n\n你的程序必须：\n-   从每对 $\\,\\{E,\\nu\\}\\,$ 构建 $\\,S_{ijkl}\\,$。\n-   如上所述，使用显式循环计算 $\\,\\epsilon^{\\mathrm{naive}}\\,$ 和 $\\,\\epsilon^{\\mathrm{eff}}\\,$。\n-   对于每种情况，按上述方法计算 $\\,d\\,$。\n-   生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，例如 $[d_1,d_2,d_3,d_4,d_5,d_6]$。每个 $\\,d\\,$ 都必须以绝对应变（无量纲）报告。", "solution": "所述问题已经过验证，被认为是适定的、科学上合理的且内部一致的。它提出了一个植根于线性弹性理论基本原理的清晰计算任务。我们着手进行求解。\n\n目标是使用四阶柔度张量 $S$ 从二阶柯西应力张量 $\\sigma$ 计算二阶应变张量 $\\epsilon$。该关系由线性弹性的本构方程定义，其分量形式为 $\\epsilon_{ij} = S_{ijkl}\\sigma_{kl}$。这里的求和是针对下标 $k$ 和 $l$ 的默示求和，范围从 1 到 3。我们的任务是实现两种不同的计算方法来进行此张量缩并，并比较它们的结果。\n\n该问题依赖于连续介质力学的几个基本原理：\n1.  应力张量的对称性，$\\sigma_{kl} = \\sigma_{lk}$。这是角动量守恒的直接结果，该守恒定律规定，在没有体力偶的情况下，应力张量必须是对称的。\n2.  柔度张量的次对称性，$S_{ijkl} = S_{ijlk} = S_{jikl}$。第一个等式 $S_{ijkl} = S_{ijlk}$ 是为了确保在给定 $\\sigma$ 对称性的情况下，缩并 $S_{ijkl}\\sigma_{kl}$ 是良定义的。第二个等式 $S_{ijkl} = S_{jikl}$ 源于应变张量的对称性 $\\epsilon_{ij} = \\epsilon_{ji}$，而应变张量的对称性本身是小应变张量从位移梯度定义的必然结果。\n3.  柔度张量的主对称性，$S_{ijkl} = S_{klij}$。这种对称性适用于超弹性材料，其应力-应变关系可从一个标量应变能密度函数 $\\Psi$ 导出。在这种情况下，$S_{ijkl} = \\frac{\\partial^2 \\Psi}{\\partial \\epsilon_{ij} \\partial \\epsilon_{kl}}$。\n\n问题指定了一种各向同性材料，其柔度张量具有一个标准形式，取决于两个材料常数：杨氏模量 $E$ 和泊松比 $\\nu$。其分量形式为：\n$$\nS_{ijkl} \\;=\\; \\frac{1+\\nu}{2E}\\,\\big(\\delta_{ik}\\delta_{jl}+\\delta_{il}\\delta_{jk}\\big)\\;-\\;\\frac{\\nu}{E}\\,\\delta_{ij}\\delta_{kl}\n$$\n这里，$\\delta$ 是克罗内克δ函数，定义为：若 $a=b$，则 $\\delta_{ab}=1$；若 $a \\neq b$，则 $\\delta_{ab}=0$。\n\n我们的解决方案将按以下步骤系统地构建。\n\n**1. 构造柔度张量 $S_{ijkl}$**\n\n首先，我们必须使用为各向同性材料提供的公式，以编程方式构建张量 $S$ 的 $3 \\times 3 \\times 3 \\times 3$ 个分量。这涉及到创建一个四维数组，并根据给定的 $E$ 和 $\\nu$ 填充其 $3^4=81$ 个分量。这通过遍历所有从 0 到 2 的索引组合 $(i, j, k, l)$（在编程中对应于数学表示中的 1 到 3）并应用公式来实现。克罗内克δ函数 $\\delta_{ab}$ 等价于一个单位矩阵。\n\n**2. 实现朴素缩并**\n\n“朴素”方法直接实现完整的张量缩并，如公式所示：\n$$\n\\epsilon_{ij}^{\\mathrm{naive}} \\;=\\; \\sum_{k=1}^{3}\\sum_{l=1}^{3} S_{ijkl}\\,\\sigma_{kl}\n$$\n这需要一组四重嵌套循环。对于结果应变张量 $\\epsilon^{\\mathrm{naive}}$ 的每个分量 $(i, j)$，我们对 $(k, l)$ 的所有 $3 \\times 3 = 9$ 种组合进行求和。计算完整 $\\epsilon$ 张量的总计算量涉及对 $\\epsilon$ 的 9 个分量中的每一个进行 $3 \\times 3 \\times 3 \\times 3 = 81$ 次乘法和加法，尽管 $S$ 的大多数分量为零。\n\n**3. 实现高效缩并**\n\n“高效”方法利用了 $\\sigma$ 和 $S$ 的对称性。对 $k$ 和 $l$ 的求和可以重写以避免冗余计算。\n从朴素求和开始：\n$$ \\sum_{k=1}^{3}\\sum_{l=1}^{3} S_{ijkl}\\sigma_{kl} = \\sum_{k=l} S_{ijkl}\\sigma_{kl} + \\sum_{k \\neq l} S_{ijkl}\\sigma_{kl} $$\n第二项可以拆分：$\\sum_{k < l} S_{ijkl}\\sigma_{kl} + \\sum_{k > l} S_{ijkl}\\sigma_{kl}$。\n利用对称性 $S_{ijkl}=S_{ijlk}$ 和 $\\sigma_{kl}=\\sigma_{lk}$，我们可以证明 $\\sum_{k > l} S_{ijkl}\\sigma_{kl} = \\sum_{k < l} S_{ijlk}\\sigma_{lk} = \\sum_{k < l} S_{ijkl}\\sigma_{kl}$。\n因此，总和变为：\n$$ \\sum_{k=l} S_{ijkl}\\sigma_{kl} + 2\\sum_{k < l} S_{ijkl}\\sigma_{kl} = \\sum_{k=1}^{3}\\sum_{l=k}^{3} w_{kl}\\,S_{ijkl}\\,\\sigma_{kl} $$\n其中权重 $w_{kl}$ 在 $k=l$ 时为 1，在 $k<l$ 时为 2。这将内部求和中的项数从 9 项减少到 6 项。\n\n此外，所得应变张量 $\\epsilon$ 本身是对称的，$\\epsilon_{ij} = \\epsilon_{ji}$。这使我们能够只计算 $i \\le j$ 的分量（上三角，包括对角线），然后通过镜像得到下三角分量：对于 $j < i$，$\\epsilon_{ji} = \\epsilon_{ij}$。这将需要计算的 $\\epsilon$ 分量数量从 9 个减少到 6 个。因此，实现将包括 $i$ 从 0 到 2 和 $j$ 从 $i$ 到 2 的循环，在循环内部执行对 $k$ 和 $l$ 的高效求和。最后，填充 $\\epsilon^{\\mathrm{eff}}$ 的下三角部分。\n\n**4. 数值比较**\n\n对于每个提供的测试用例，我们将计算 $\\epsilon^{\\mathrm{naive}}$ 和 $\\epsilon^{\\mathrm{eff}}$。然后计算最大绝对差 $d = \\max_{1\\le i,j\\le 3} |\\epsilon_{ij}^{\\mathrm{naive}} - \\epsilon_{ij}^{\\mathrm{eff}}|$。在数学上，这两种方法是等价的，因此 $d$ 预期为零。在浮点运算中，由于运算顺序的潜在差异， $d$ 可能是一个非常小的非零数，量级在机器精度左右。该值可作为高效实现正确性的数值验证。最终答案中提供的代码将对所有指定的测试用例执行这些步骤。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for tensor contraction.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (E in Pa, nu dimensionless, sigma in Pa)\n    test_cases = [\n        (210e9, 0.3, np.array([\n            [100e6, 20e6, -30e6],\n            [20e6, -50e6, 10e6],\n            [-30e6, 10e6, 80e6]\n        ])),\n        (70e9, 0.33, -100e6 * np.identity(3)),\n        (30e9, 0.25, np.array([\n            [0, 50e6, 0],\n            [50e6, 0, 0],\n            [0, 0, 0]\n        ])),\n        (10e9, 0.2, np.zeros((3, 3))),\n        (1e9, 0.499, np.array([\n            [1e6, 0.2e6, -0.1e6],\n            [0.2e6, -2e6, 0.05e6],\n            [-0.1e6, 0.05e6, 3e6]\n        ])),\n        (5e9, -0.25, np.array([\n            [5e6, 0.7e6, -0.4e6],\n            [0.7e6, 0.5e6, 0.9e6],\n            [-0.4e6, 0.9e6, -3e6]\n        ]))\n    ]\n\n    results = []\n    for E, nu, sigma in test_cases:\n        # 1. Construct the fourth-order compliance tensor S\n        S = construct_compliance_tensor(E, nu)\n\n        # 2. Compute strain using the naive contraction\n        epsilon_naive = naive_contraction(S, sigma)\n\n        # 3. Compute strain using the efficient contraction\n        epsilon_eff = efficient_contraction(S, sigma)\n\n        # 4. Compute the maximum absolute difference\n        diff = np.max(np.abs(epsilon_naive - epsilon_eff))\n        results.append(diff)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef construct_compliance_tensor(E, nu):\n    \"\"\"\n    Constructs the 3x3x3x3 isotropic compliance tensor S_ijkl.\n    \"\"\"\n    S = np.zeros((3, 3, 3, 3))\n    delta = np.identity(3)\n    \n    # Coefficients from the isotropic compliance formula\n    c1 = (1.0 + nu) / (2.0 * E)\n    c2 = -nu / E\n\n    # Populate the tensor using explicit loops over indices (i,j,k,l)\n    for i in range(3):\n        for j in range(3):\n            for k in range(3):\n                for l in range(3):\n                    term1 = delta[i, k] * delta[j, l] + delta[i, l] * delta[j, k]\n                    term2 = delta[i, j] * delta[k, l]\n                    S[i, j, k, l] = c1 * term1 + c2 * term2\n    return S\n\ndef naive_contraction(S, sigma):\n    \"\"\"\n    Computes strain = S : sigma using naive loops (4 nested loops).\n    epsilon_ij = sum_{k,l} S_ijkl * sigma_kl\n    \"\"\"\n    epsilon = np.zeros((3, 3))\n    for i in range(3):\n        for j in range(3):\n            sum_val = 0.0\n            for k in range(3):\n                for l in range(3):\n                    sum_val += S[i, j, k, l] * sigma[k, l]\n            epsilon[i, j] = sum_val\n    return epsilon\n\ndef efficient_contraction(S, sigma):\n    \"\"\"\n    Computes strain = S : sigma using loops that exploit tensor symmetries.\n    \"\"\"\n    epsilon = np.zeros((3, 3))\n    \n    # Compute the upper triangle of epsilon (i <= j)\n    for i in range(3):\n        for j in range(i, 3):\n            sum_val = 0.0\n            # Inner sum exploits symmetry of sigma and minor symmetry of S\n            for k in range(3):\n                for l in range(k, 3):\n                    weight = 1.0 if k == l else 2.0\n                    sum_val += weight * S[i, j, k, l] * sigma[k, l]\n            epsilon[i, j] = sum_val\n            \n    # Fill the lower triangle using symmetry of epsilon\n    for i in range(3):\n        for j in range(i): # j < i\n            epsilon[i, j] = epsilon[j, i]\n            \n    return epsilon\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2696786"}]}