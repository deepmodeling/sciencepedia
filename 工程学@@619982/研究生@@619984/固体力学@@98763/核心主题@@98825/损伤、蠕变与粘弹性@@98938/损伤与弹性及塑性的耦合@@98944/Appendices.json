{"hands_on_practices": [{"introduction": "在许多工程材料中，损伤主要由拉伸而非压缩引起，这种现象被称为单边效应。本练习将引导你运用张量谱分解这一强大数学工具，精确分离出弹性应变张量的拉伸部分，并以此为基础构建一个单边损伤模型。通过从亥姆霍兹自由能中推导热力学上一致的损伤驱动力 $Y$，你将掌握如何将复杂的物理直觉转化为严谨的本构关系 [@problem_id:2626324]。", "problem": "考虑一个具有标量损伤的小应变、各向同性弹塑性固体。总应变张量 $\\,\\boldsymbol{\\varepsilon}\\,$ 可加法分解为 $\\,\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}_{\\mathrm{e}} + \\boldsymbol{\\varepsilon}_{\\mathrm{p}}\\,$, 其中 $\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}}\\,$ 是弹性应变，$\\,\\boldsymbol{\\varepsilon}_{\\mathrm{p}}\\,$ 是塑性应变。损伤具有单边效应：只有拉伸弹性应变会驱动损伤，而压缩弹性应变则不会。\n\n任务1（正部的谱分解投影）。从一个实对称二阶张量的谱分解出发，推导弹性应变张量正部 $\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+}\\,$ 关于其特征值和特征投影算子的表达式。然后写出其互补的负部 $\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{-}\\,$。您的推导应从谱分解的定义和亥维赛德型斜坡函数 $\\,\\langle x\\rangle_{+}=\\max(x,0)\\,$ 开始，且不应假设主方向的任何特定朝向。\n\n任务2（单边损伤自由能和损伤驱动力）。考虑一个具有 Lamé 参数 $\\,\\lambda\\,$ 和 $\\,\\mu\\,$ 的各向同性线弹性自由能密度，其中只有拉伸贡献部分被损伤 $\\,d\\in[0,1)\\,$ 所退化：\n$$\n\\psi(\\boldsymbol{\\varepsilon}_{\\mathrm{e}},d) \\;=\\; \\tfrac{1}{2}\\,(1-d)\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+}:\\mathbb{C}:\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+} \\;+\\; \\tfrac{1}{2}\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{-}:\\mathbb{C}:\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{-},\n$$\n其中 $\\,\\mathbb{C}\\,$ 是四阶各向同性弹性张量。使用内变量的标准热力学方法，推导损伤驱动力\n$$\nY \\;=\\; -\\,\\frac{\\partial \\psi}{\\partial d}\\,,\n$$\n并用 $\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+}\\,$, $\\,\\lambda\\,$ 和 $\\,\\mu\\,$ 表示。不要假设任何特定的应力或应变路径；论证该驱动力的符号及其单边特性。\n\n任务3（考虑弹塑性耦合的数值计算）。在平面应变条件下的某个给定加载步，总应变张量和塑性应变张量（均在 $\\{x,y,z\\}$ 基下）为\n$$\n\\boldsymbol{\\varepsilon} \\;=\\;\n\\begin{pmatrix}\n0.0035 & 0.0012 & 0 \\\\\n0.0012 & -0.0010 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}, \n\\qquad\n\\boldsymbol{\\varepsilon}_{\\mathrm{p}} \\;=\\;\n\\begin{pmatrix}\n0.0005 & 0.0004 & 0 \\\\\n0.0004 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}.\n$$\n材料的 Young’s modulus 为 $\\,E=70\\,\\text{GPa}\\,$，Poisson’s ratio 为 $\\,\\nu=0.33\\,$。使用各向同性弹性关系式 $\\,\\mu = \\dfrac{E}{2(1+\\nu)}\\,$ 和 $\\,\\lambda = \\dfrac{E\\,\\nu}{(1+\\nu)(1-2\\nu)}\\,$。损伤随历史变量 $\\,\\kappa=\\max_{t'\\le t} Y(t')\\,$ 和以下规律演化：\n$$\nd(\\kappa) \\;=\\; \n\\begin{cases}\n0, & \\kappa \\le Y_{0},\\\\[4pt]\n1 - \\dfrac{Y_{0}}{\\kappa}, & \\kappa > Y_{0},\n\\end{cases}\n$$\n其中 $\\,Y_{0}=250\\,\\text{kJ/m}^{3}\\,$。先前达到的历史值为 $\\,\\kappa_{\\mathrm{prev}}=200\\,\\text{kJ/m}^{3}\\,$。通过以下步骤计算当前损伤 $\\,d\\,$：\n- 形成 $\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}}=\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}_{\\mathrm{p}}\\,$，\n- 通过谱分解投影构建 $\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+}\\,$，\n- 根据任务2的结果计算 $\\,Y\\,$，\n- 更新 $\\,\\kappa=\\max(\\kappa_{\\mathrm{prev}},Y)\\,$，\n- 并将 $\\,\\kappa\\,$ 代入损伤规律中。\n\n将 $\\,d\\,$ 的最终值四舍五入到四位有效数字。将最终损伤表示为纯小数（无量纲）。不要将中间量作为最终答案报告。", "solution": "我们从微小应变固体力学、对称张量的谱分解以及损伤内变量的标准热力学等基本定义出发。\n\n任务1. 对于任意实对称二阶张量 $\\,\\boldsymbol{A}\\,$（此处为 $\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}}\\,$），其谱分解为\n$$\n\\boldsymbol{A} \\;=\\; \\sum_{i=1}^{3} a_{i} \\,\\boldsymbol{n}_{i}\\otimes \\boldsymbol{n}_{i},\n$$\n其中 $\\,a_{i}\\,$ 是实特征值，$\\,\\{\\boldsymbol{n}_{i}\\}\\,$ 是一组标准正交的特征向量基。定义斜坡函数 $\\,\\langle x\\rangle_{+}=\\max(x,0)\\,$ 和 $\\,\\langle x\\rangle_{-}=\\min(x,0)\\,$，使得 $\\,x=\\langle x\\rangle_{+}+\\langle x\\rangle_{-}\\,$ 且 $\\,\\langle x\\rangle_{+}\\langle x\\rangle_{-}=0\\,$。于是，张量 $\\,\\boldsymbol{A}\\,$ 的正部和负部可通过只投影其正（或负）特征模态来进行谱定义：\n$$\n\\boldsymbol{A}^{+} \\;=\\; \\sum_{i=1}^{3} \\langle a_{i}\\rangle_{+}\\,\\boldsymbol{n}_{i}\\otimes \\boldsymbol{n}_{i},\n\\qquad\n\\boldsymbol{A}^{-} \\;=\\; \\sum_{i=1}^{3} \\langle a_{i}\\rangle_{-}\\,\\boldsymbol{n}_{i}\\otimes \\boldsymbol{n}_{i}.\n$$\n根据构造，$\\,\\boldsymbol{A}=\\boldsymbol{A}^{+}+\\boldsymbol{A}^{-}\\,$, $\\,\\boldsymbol{A}^{+}:\\boldsymbol{A}^{-}=0\\,$，并且 $\\,\\boldsymbol{A}^{+}\\,$ 是半正定的，而 $\\,\\boldsymbol{A}^{-}\\,$ 是半负定的。将此应用于弹性应变张量 $\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}}\\,$，得到\n$$\n\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+} \\;=\\; \\sum_{i=1}^{3} \\langle \\varepsilon_{i}\\rangle_{+}\\,\\boldsymbol{n}_{i}\\otimes \\boldsymbol{n}_{i},\n\\qquad\n\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{-} \\;=\\; \\sum_{i=1}^{3} \\langle \\varepsilon_{i}\\rangle_{-}\\,\\boldsymbol{n}_{i}\\otimes \\boldsymbol{n}_{i},\n$$\n其中 $\\,\\varepsilon_{i}\\,$ 是弹性主应变。这种构造将拉伸分量（即 $\\,\\varepsilon_{i}>0\\,$ 的特征模态）严格地投影到 $\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+}\\,$ 中，将压缩分量投影到 $\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{-}\\,$ 中。\n\n任务2. 对于三维空间中的各向同性线弹性，刚度张量 $\\,\\mathbb{C}\\,$ 满足\n$$\n\\boldsymbol{\\sigma} \\;=\\; \\mathbb{C}:\\boldsymbol{\\varepsilon}_{\\mathrm{e}} \\;=\\; 2\\mu\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}} + \\lambda\\,\\operatorname{tr}(\\boldsymbol{\\varepsilon}_{\\mathrm{e}})\\,\\boldsymbol{I},\n$$\n而相应的弹性二次型为\n$$\n\\boldsymbol{X}:\\mathbb{C}:\\boldsymbol{X} \\;=\\; 2\\mu\\,\\boldsymbol{X}:\\boldsymbol{X} + \\lambda\\,[\\operatorname{tr}(\\boldsymbol{X})]^{2},\n\\qquad \\text{for any symmetric } \\boldsymbol{X}.\n$$\n所假定的单边自由能为\n$$\n\\psi(\\boldsymbol{\\varepsilon}_{\\mathrm{e}},d) \\;=\\; \\tfrac{1}{2}\\,(1-d)\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+}:\\mathbb{C}:\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+} \\;+\\; \\tfrac{1}{2}\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{-}:\\mathbb{C}:\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{-}.\n$$\n损伤驱动力是 $\\,d\\,$ 的热力学共轭量：\n$$\nY \\;=\\; -\\,\\frac{\\partial \\psi}{\\partial d} \\;=\\; \\tfrac{1}{2}\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+}:\\mathbb{C}:\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+} \\;=\\; \\mu\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+}:\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+} \\;+\\; \\tfrac{\\lambda}{2}\\,\\big[\\operatorname{tr}(\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+})\\big]^{2}.\n$$\n因为 $\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+}\\,$ 是半正定的，所以 $\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+}:\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+}\\ge 0\\,$ 且 $\\,\\big[\\operatorname{tr}(\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+})\\big]^{2}\\ge 0\\,$，故 $\\,Y\\ge 0\\,$。此外，如果所有弹性主应变均为非正值（纯压缩），则 $\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+}=\\boldsymbol{0}\\,$，因此 $\\,Y=0\\,$。这强制了其单边特性：只有拉伸弹性应变才能驱动损伤。\n\n任务3. 使用给定数据计算当前损伤 $\\,d\\,$。\n\n步骤3.1. 计算弹性应变 $\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}}=\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}_{\\mathrm{p}}\\,$：\n$$\n\\boldsymbol{\\varepsilon}_{\\mathrm{e}} \\;=\\;\n\\begin{pmatrix}\n0.0030 & 0.0008 & 0 \\\\\n0.0008 & -0.0010 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}.\n$$\n\n步骤3.2. 通过谱分解投影构建 $\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+}\\,$。在 $\\{x,y\\}$-平面内，该 $\\,2\\times 2\\,$ 子块的元素为 $\\,a=0.0030\\,$, $\\,c=-0.0010\\,$ 和 $\\,b=0.0008\\,$。其特征值为\n$$\n\\varepsilon_{1,2} \\;=\\; \\tfrac{1}{2}\\Big[(a+c)\\,\\pm\\,\\sqrt{(a-c)^{2}+4b^{2}}\\Big]\n\\;=\\; \\tfrac{1}{2}\\Big[0.0020 \\,\\pm\\, \\sqrt{0.00001856}\\Big].\n$$\n由于 $\\,\\sqrt{0.00001856}=0.0008\\sqrt{29}\\,$, 我们得到\n$$\n\\varepsilon_{1} \\;=\\; \\tfrac{1}{2}\\big(0.0020 + 0.0008\\sqrt{29}\\big) \\;=\\; 0.001 + 0.0004\\sqrt{29} \\;>\\; 0,\\qquad\n\\varepsilon_{2} \\;=\\; \\tfrac{1}{2}\\big(0.0020 - 0.0008\\sqrt{29}\\big) \\;<\\; 0,\n$$\n且面外弹性主应变为 $\\,\\varepsilon_{3}=0\\,$。因此，\n$$\n\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+} \\text{ has principal values } \\big(\\langle \\varepsilon_{1}\\rangle_{+},\\,\\langle \\varepsilon_{2}\\rangle_{+},\\,\\langle \\varepsilon_{3}\\rangle_{+}\\big) \\;=\\; \\big(\\varepsilon_{1},\\,0,\\,0\\big).\n$$\n因此，\n$$\n\\operatorname{tr}(\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+}) \\;=\\; \\varepsilon_{1} \\;=\\; 0.001 + 0.0004\\sqrt{29},\n\\qquad\n\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+}:\\boldsymbol{\\varepsilon}_{\\mathrm{e}}^{+} \\;=\\; \\varepsilon_{1}^{2} \\;=\\; \\big(0.001 + 0.0004\\sqrt{29}\\big)^{2}.\n$$\n\n步骤3.3. 计算 Lamé 参数和 $\\,Y\\,$。给定 $\\,E=70\\,\\text{GPa}\\,$ 和 $\\,\\nu=0.33\\,$，\n$$\n\\mu \\;=\\; \\frac{E}{2(1+\\nu)} \\;=\\; \\frac{70\\times 10^{9}}{2(1.33)} \\;=\\; 26.3157894737\\times 10^{9}\\,\\text{Pa},\n$$\n$$\n\\lambda \\;=\\; \\frac{E\\,\\nu}{(1+\\nu)(1-2\\nu)} \\;=\\; \\frac{70\\times 10^{9}\\times 0.33}{1.33\\times 0.34} \\;=\\; 51.083590544\\times 10^{9}\\,\\text{Pa}.\n$$\n利用唯一的非零正主应变，任务2中的损伤驱动力可简化为\n$$\nY \\;=\\; \\mu\\,\\varepsilon_{1}^{2} + \\tfrac{\\lambda}{2}\\,\\varepsilon_{1}^{2} \\;=\\; \\Big(\\mu+\\tfrac{\\lambda}{2}\\Big)\\,\\varepsilon_{1}^{2}.\n$$\n注意到以下恒等式会很方便\n$$\n\\mu+\\tfrac{\\lambda}{2} \\;=\\; \\frac{E(1-\\nu)}{2(1+\\nu)(1-2\\nu)} \\;=\\; 51.857584740\\times 10^{9}\\,\\text{Pa}.\n$$\n现在\n$$\n\\varepsilon_{1} \\;=\\; 0.001 + 0.0004\\sqrt{29},\n\\qquad\n\\varepsilon_{1}^{2} \\;=\\; 10^{-6} + 8\\times 10^{-7}\\sqrt{29} + 1.6\\times 10^{-7}\\times 29 \\;=\\; 9.9481318456\\times 10^{-6}.\n$$\n因此，\n$$\nY \\;=\\; \\big(51.857584740\\times 10^{9}\\big)\\times \\big(9.9481318456\\times 10^{-6}\\big)\\;\\text{J/m}^{3}\n\\;=\\; 5.15886090209\\times 10^{5}\\;\\text{J/m}^{3}\n\\;=\\; 515.886090209\\;\\text{kJ/m}^{3}.\n$$\n\n步骤3.4. 更新历史变量并计算 $\\,d\\,$。给定 $\\,\\kappa_{\\mathrm{prev}}=200\\,\\text{kJ/m}^{3}\\,$ 和 $\\,Y_{0}=250\\,\\text{kJ/m}^{3}\\,$，\n$$\n\\kappa \\;=\\; \\max\\big(\\kappa_{\\mathrm{prev}},Y\\big) \\;=\\; \\max\\big(200,\\,515.886090209\\big)\\;\\text{kJ/m}^{3} \\;=\\; 515.886090209\\;\\text{kJ/m}^{3}.\n$$\n由于 $\\,\\kappa>Y_{0}\\,$，损伤规律给出\n$$\nd \\;=\\; 1 - \\frac{Y_{0}}{\\kappa} \\;=\\; 1 - \\frac{250}{515.886090209} \\;=\\; 0.515396896\\ldots\n$$\n四舍五入到四位有效数字，\n$$\nd \\;\\approx\\; 0.5154.\n$$\n此值为无量纲，符合要求，并反映了通过 $\\,\\boldsymbol{\\varepsilon}_{\\mathrm{e}}=\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}_{\\mathrm{p}}\\,$ 与弹塑性耦合一致计算出的拉伸弹性应变的单边贡献。", "answer": "$$\\boxed{0.5154}$$", "id": "2626324"}, {"introduction": "将损伤与弹塑性耦合的本构方程通常是非线性的，需要通过数值方法求解。本练习模拟了在有限元程序中求解一个材料点状态更新的完整过程，采用算子分裂法，你将先执行一个隐式的塑性返回映射算法，然后在此基础上更新损伤变量。这个练习是理解和实现复杂材料模型数值积分的核心步骤 [@problem_id:2626346]。", "problem": "考虑一个通过有效应力概念将标量损伤与率无关塑性耦合的小应变单轴本构模型。柯西应力由损伤弹性关系式 $\\sigma = (1-d)\\,E_0\\,(\\varepsilon - \\varepsilon^p)$ 给出，其中 $d \\in [0,1]$ 是标量损伤变量，$E_0$ 是无损杨氏模量，$\\varepsilon$ 是总应变，$\\varepsilon^p$ 是塑性应变。塑性在有效应力空间中用屈服函数 $f(\\tilde{\\sigma},\\alpha) = |\\tilde{\\sigma}| - (\\sigma_{y0} + H\\,\\alpha) \\le 0$ 来表述，其中 $\\tilde{\\sigma} := E_0(\\varepsilon - \\varepsilon^p)$ 是有效应力，$\\sigma_{y0}$ 是初始屈服应力，$H$ 是各向同性硬化模量，$\\alpha$ 是累积塑性应变。关联流动法则是 $\\dot{\\varepsilon}^p = \\dot{\\lambda}\\,\\mathrm{sign}(\\tilde{\\sigma})$ 和 $\\dot{\\alpha} = \\dot{\\lambda}$，并遵循标准的库恩-塔克（Kuhn–Tucker）条件。损伤驱动力是在无损构型中定义的应变能释放率 $Y := \\tfrac{1}{2}\\,E_0\\,(\\varepsilon - \\varepsilon^p)^2$，当准则 $F(Y) = Y - Y_c \\le 0$ 被违反时，损伤开始发生。为进行正则化，使用粘性损伤演化规律 $\\dot{d} = \\eta_d^{-1}\\,\\langle Y - Y_c \\rangle$，其中 $\\langle x \\rangle := \\max(0,x)$，$\\eta_d$ 是一个类粘性参数。损伤的时间积分通过后向欧拉隐式格式执行：$d_{n+1} = d_n + \\Delta t\\,\\eta_d^{-1}\\,\\langle Y_{n+1} - Y_c \\rangle$。\n\n在时间 $t_n$ 时，状态为 $\\varepsilon_n = 0$，$\\varepsilon^p_n = 0$，$\\alpha_n = 0$ 和 $d_n = 0$。在单个增量 $\\Delta t$ 内，施加的总应变在单调拉伸下达到 $\\varepsilon_{n+1} = 0.004$。材料参数为：\n- $E_0 = 2.0 \\times 10^{11}\\ \\mathrm{Pa}$，\n- $\\sigma_{y0} = 3.0 \\times 10^{8}\\ \\mathrm{Pa}$，\n- $H = 2.0 \\times 10^{9}\\ \\mathrm{Pa}$，\n- $Y_c = 2.0 \\times 10^{5}\\ \\mathrm{Pa}$，\n- $\\eta_d = 1.0 \\times 10^{6}\\ \\mathrm{Pa\\cdot s}$，\n- $\\Delta t = 1.0\\ \\mathrm{s}$。\n\n从本构定义和一致性条件出发，在有效应力空间中对塑性进行全隐式更新，然后评估在 $t_{n+1}$ 时的损伤驱动力。使用后向欧拉格式计算损伤，求出此步的损伤增量 $\\Delta d := d_{n+1} - d_n$。\n\n将最终答案四舍五入至四位有效数字。将结果表示为一个纯数（无量纲）。", "solution": "求解过程需要一个两阶段的算子分裂更新程序来处理从 $t_n$ 到 $t_{n+1}$ 的增量。首先，在给定总应变 $\\varepsilon_{n+1}$ 的条件下更新塑性状态，假设损伤固定在 $d_n$。其次，使用第一阶段计算出的状态更新损伤变量。\n\n**1. 塑性更新**\n\n塑性更新使用有效应力空间中的试探-返回映射算法进行。\n\n**试探步：**我们假设行为是纯弹性的。试探塑性应变和硬化变量保持其初始值：$\\varepsilon^p_{n+1} = \\varepsilon^p_n = 0$ 和 $\\alpha_{n+1} = \\alpha_n = 0$。\n在状态 $t_{n+1}$ 时的试探有效应力 $\\tilde{\\sigma}^{\\text{trial}}$ 为：\n$$\n\\tilde{\\sigma}^{\\text{trial}} = E_0 (\\varepsilon_{n+1} - \\varepsilon^p_n) = E_0 \\varepsilon_{n+1}\n$$\n代入数值：\n$$\n\\tilde{\\sigma}^{\\text{trial}} = (2.0 \\times 10^{11}\\ \\mathrm{Pa}) \\times (0.004) = 8.0 \\times 10^{8}\\ \\mathrm{Pa}\n$$\n我们用该试探应力检查屈服条件：\n$$\nf^{\\text{trial}} = |\\tilde{\\sigma}^{\\text{trial}}| - (\\sigma_{y0} + H \\alpha_n) = 8.0 \\times 10^{8}\\ \\mathrm{Pa} - (3.0 \\times 10^{8}\\ \\mathrm{Pa} + 0) = 5.0 \\times 10^{8}\\ \\mathrm{Pa}\n$$\n由于 $f^{\\text{trial}} > 0$，弹性假设不正确。发生了塑性变形，需要进行返回映射。\n\n**返回映射：**我们在 $t_{n+1}$ 时强制执行塑性一致性条件：$f(\\tilde{\\sigma}_{n+1}, \\alpha_{n+1}) = 0$。\n积分后的演化方程为：\n$$\n\\varepsilon^p_{n+1} = \\varepsilon^p_n + \\Delta \\lambda \\, \\mathrm{sign}(\\tilde{\\sigma}_{n+1})\n$$\n$$\n\\alpha_{n+1} = \\alpha_n + \\Delta \\lambda\n$$\n在 $\\varepsilon^p_n=0$，$\\alpha_n=0$ 的条件下，单调拉伸意味着 $\\tilde{\\sigma}_{n+1}>0$（因此 $\\mathrm{sign}(\\tilde{\\sigma}_{n+1})=1$），我们有 $\\varepsilon^p_{n+1} = \\alpha_{n+1} = \\Delta \\lambda$。\n$t_{n+1}$ 时的状态由以下方程组定义：\n$$\n\\begin{cases}\n\\tilde{\\sigma}_{n+1} = E_0 (\\varepsilon_{n+1} - \\varepsilon^p_{n+1}) \\\\\n\\tilde{\\sigma}_{n+1} = \\sigma_{y0} + H \\alpha_{n+1} \\\\\n\\alpha_{n+1} = \\varepsilon^p_{n+1}\n\\end{cases}\n$$\n将第三个方程代入第二个方程得到 $\\tilde{\\sigma}_{n+1} = \\sigma_{y0} + H \\varepsilon^p_{n+1}$。将其与第一个方程联立：\n$$\n\\sigma_{y0} + H \\varepsilon^p_{n+1} = E_0 (\\varepsilon_{n+1} - \\varepsilon^p_{n+1})\n$$\n解出 $\\varepsilon^p_{n+1}$ 得：\n$$\n\\varepsilon^p_{n+1} = \\frac{E_0 \\varepsilon_{n+1} - \\sigma_{y0}}{E_0 + H}\n$$\n分子为 $E_0 \\varepsilon_{n+1} - \\sigma_{y0} = \\tilde{\\sigma}^{\\text{trial}} - \\sigma_{y0} = 5.0 \\times 10^{8}\\ \\mathrm{Pa}$。\n分母为 $E_0 + H = 2.0 \\times 10^{11}\\ \\mathrm{Pa} + 2.0 \\times 10^{9}\\ \\mathrm{Pa} = 2.02 \\times 10^{11}\\ \\mathrm{Pa}$。\n$$\n\\varepsilon^p_{n+1} = \\frac{5.0 \\times 10^{8}}{2.02 \\times 10^{11}} = \\frac{5}{2020} = \\frac{1}{404}\n$$\n因此，$\\alpha_{n+1} = \\varepsilon^p_{n+1} = \\frac{1}{404}$。\n\n**2. 损伤更新**\n\n首先，我们使用塑性更新得到的状态来计算损伤驱动力 $Y_{n+1}$。\n$$\nY_{n+1} = \\frac{1}{2} E_0 (\\varepsilon_{n+1} - \\varepsilon^p_{n+1})^2 = \\frac{1}{2 E_0} [E_0(\\varepsilon_{n+1} - \\varepsilon^p_{n+1})]^2 = \\frac{\\tilde{\\sigma}_{n+1}^2}{2 E_0}\n$$\n我们计算 $\\tilde{\\sigma}_{n+1}$：\n$$\n\\tilde{\\sigma}_{n+1} = \\sigma_{y0} + H \\alpha_{n+1} = 3.0 \\times 10^{8}\\ \\mathrm{Pa} + (2.0 \\times 10^{9}\\ \\mathrm{Pa}) \\times \\frac{1}{404}\n$$\n$$\n\\tilde{\\sigma}_{n+1} = 3 \\times 10^8 + \\frac{20 \\times 10^8}{404} = \\left(3 + \\frac{20}{404}\\right) \\times 10^8 = \\left(3 + \\frac{5}{101}\\right) \\times 10^8 = \\frac{303+5}{101} \\times 10^8 = \\frac{308}{101} \\times 10^8\\ \\mathrm{Pa}\n$$\n现在，我们计算 $Y_{n+1}$：\n$$\nY_{n+1} = \\frac{(\\frac{308}{101} \\times 10^8)^2}{2 \\times (2.0 \\times 10^{11})} = \\frac{(\\frac{308}{101})^2 \\times 10^{16}}{4 \\times 10^{11}} = \\frac{308^2}{101^2 \\times 4} \\times 10^5 = \\frac{94864}{10201 \\times 4} \\times 10^5 = \\frac{23716}{10201} \\times 10^5\\ \\mathrm{Pa}\n$$\n$Y_{n+1} \\approx 2.32487 \\times 10^5\\ \\mathrm{Pa}$。\n我们检查损伤准则：$Y_c = 2.0 \\times 10^5\\ \\mathrm{Pa}$。因为 $Y_{n+1} > Y_c$，所以损伤会发生演化。\n\n最后，我们使用后向欧拉格式计算损伤增量 $\\Delta d = d_{n+1} - d_n$。由于 $d_n=0$，我们有 $\\Delta d = d_{n+1}$。\n$$\n\\Delta d = d_{n+1} = \\frac{\\Delta t}{\\eta_d} \\langle Y_{n+1} - Y_c \\rangle = \\frac{1.0\\ \\mathrm{s}}{1.0 \\times 10^{6}\\ \\mathrm{Pa\\cdot s}} (Y_{n+1} - Y_c)\n$$\n麦考利（Macaulay）括号中的项为：\n$$\nY_{n+1} - Y_c = \\left(\\frac{23716}{10201} - 2\\right) \\times 10^5 = \\frac{23716 - 20402}{10201} \\times 10^5 = \\frac{3314}{10201} \\times 10^5\\ \\mathrm{Pa}\n$$\n将此代入 $\\Delta d$ 的方程中：\n$$\n\\Delta d = (1.0 \\times 10^{-6}\\ \\mathrm{Pa^{-1}}) \\times (\\frac{3314}{10201} \\times 10^5\\ \\mathrm{Pa}) = \\frac{3314}{10201 \\times 10} = \\frac{3314}{102010}\n$$\n$$\n\\Delta d \\approx 0.032487011...\n$$\n将结果四舍五入至四位有效数字，得到 $0.03249$。", "answer": "$$\n\\boxed{0.03249}\n$$", "id": "2626346"}, {"introduction": "为在隐式有限元分析中实现高效收敛，必须精确计算本构模型的切线模量。本练习将指导你推导一个包含软化效应的弹塑性损伤模型的“一致切线算子” $K_{\\text{alg}}$ (algorithmic tangent)，并揭示其与材料稳定性及牛顿-拉夫逊迭代法收敛性的深刻联系。理解切线模量的推导及其物理意义，是开发稳健的非线性材料数值模拟程序的关键 [@problem_id:2626367]。", "problem": "一根直的棱柱状一维杆在小应变范围内，于位移控制下承受单调拉伸载荷。其本构响应耦合了各向同性弹塑性和标量损伤，具体如下。\n\n- 根据应变等效假设，应力因损伤而退化：$\\sigma = (1 - d)\\,\\tilde{\\sigma}$，其中有效（未损伤）应力为 $\\tilde{\\sigma} = E\\,(\\varepsilon - \\varepsilon^{p})$。此处 $\\sigma$ 是柯西应力，$d \\in [0,1)$ 是标量损伤变量，$E$ 是杨氏模量，$\\varepsilon$ 是总应变，$\\varepsilon^{p}$ 是塑性应变。\n\n- 塑性由具有线性各向同性硬化的有效应力驱动：屈服函数为 $f = |\\tilde{\\sigma}| - (\\sigma_{y0} + H\\,p) \\le 0$，其中 $\\sigma_{y0}$ 是初始屈服应力，$H$ 是塑性模量，$p$ 是累积塑性应变。在单调拉伸下，假设 $\\tilde{\\sigma} \\ge 0$，采用关联流动 $d\\varepsilon^{p} = d\\lambda$ 和 $dp = d\\lambda$，其中塑性乘子 $d\\lambda \\ge 0$。屈服面上的塑性一致性要求 $df = 0$。\n\n- 损伤通过简单的单调定律 $d = \\beta\\,p$ 与塑性应变耦合，其中 $\\beta > 0$ 为常数，因此在塑性加载期间有 $dd = \\beta\\,dp$。\n\n在给定的载荷增量结束时，材料处于有损伤的塑性状态，其特征由以下材料参数和内变量值描述：\n- $E = 210\\,\\text{GPa}$，\n- $H = 2\\,\\text{GPa}$，\n- $\\sigma_{y0} = 0.4\\,\\text{GPa}$，\n- $\\beta = 5$，\n- $p = 0.02$。\n\n任务：\n1) 从上述定义出发，并施加塑性一致性条件，推导在返回映射步结束时标量算法（一致）切线 $K_{\\text{alg}} = d\\sigma/d\\varepsilon$ 的闭式表达式，用 $E$、$H$、$d$、$\\tilde{\\sigma}$ 和 $\\beta$ 表示，无需代入数值。\n\n2) 在给定状态下对 $K_{\\text{alg}}$ 进行数值计算。结果以 $\\text{GPa}$ 为单位表示，并四舍五入到四位有效数字。\n\n3) 在同一状态下，使用模型所蕴含的精确状态变量计算割线斜率 $K_{\\text{sec}} = \\sigma/\\varepsilon$。结果以 $\\text{GPa}$ 为单位表示，并四舍五入到四位有效数字。\n\n4) 计算此状态下的比率 $R = K_{\\text{alg}}/K_{\\text{sec}}$。将 $R$ 表示为最简精确分数。用一句简短的话，定性解释在位移控制下，$K_{\\text{alg}}$ 相对于 $K_{\\text{sec}}$ 的符号和大小如何影响 Newton-Raphson (NR) 迭代的局部收敛行为。\n\n提供 $R$ 的精确值（无单位）作为最终答案。最终的方框答案中不要包含任何单位。", "solution": "该任务涉及为一个弹塑性-损伤耦合模型推导和评估算法切线模量与割线模量。\n\n**1) 算法切线模量 $K_{\\text{alg}}$ 的推导**\n\n算法切线模量定义为 $K_{\\text{alg}} = \\frac{d\\sigma}{d\\varepsilon}$。我们从应变等效假设给出的应力-应变关系开始：\n$$\n\\sigma = (1 - d)\\,\\tilde{\\sigma}\n$$\n以率形式取其全微分，得到：\n$$\nd\\sigma = (1 - d)\\,d\\tilde{\\sigma} - \\tilde{\\sigma}\\,dd\n$$\n内变量的增量 $d\\tilde{\\sigma}$ 和 $dd$ 必须用总应变增量 $d\\varepsilon$ 来表示。\n根据有效应力定义 $\\tilde{\\sigma} = E\\,(\\varepsilon - \\varepsilon^{p})$，我们有：\n$$\nd\\tilde{\\sigma} = E\\,(d\\varepsilon - d\\varepsilon^{p})\n$$\n塑性关联流动法则规定 $d\\varepsilon^{p} = d\\lambda$，其中 $d\\lambda \\ge 0$ 是塑性乘子。因此：\n$$\nd\\tilde{\\sigma} = E\\,(d\\varepsilon - d\\lambda)\n$$\n损伤演化通过 $d = \\beta\\,p$ 与塑性应变耦合，这意味着 $dd = \\beta\\,dp$。累积塑性应变 $p$ 的演化由 $dp = d\\lambda$ 给出。所以：\n$$\ndd = \\beta\\,d\\lambda\n$$\n将 $d\\tilde{\\sigma}$ 和 $dd$ 的这些表达式代入 $d\\sigma$ 的方程中：\n$$\nd\\sigma = (1 - d)E(d\\varepsilon - d\\lambda) - \\tilde{\\sigma}\\beta\\,d\\lambda\n$$\n重新整理各项，得到：\n$$\nd\\sigma = (1 - d)E\\,d\\varepsilon - \\left[ (1 - d)E + \\tilde{\\sigma}\\beta \\right]\\,d\\lambda\n$$\n为了用 $d\\varepsilon$ 表示 $d\\lambda$，我们施加塑性一致性条件 $df = 0$，该条件在塑性加载期间必须保持。对于单调拉伸（$\\tilde{\\sigma} \\ge 0$），屈服函数为：\n$$\nf = \\tilde{\\sigma} - (\\sigma_{y0} + H\\,p) = 0\n$$\n取全微分：\n$$\ndf = d\\tilde{\\sigma} - H\\,dp = 0\n$$\n代入 $d\\tilde{\\sigma} = E(d\\varepsilon - d\\lambda)$ 和 $dp = d\\lambda$：\n$$\nE(d\\varepsilon - d\\lambda) - H\\,d\\lambda = 0\n$$\n求解 $d\\lambda$：\n$$\nE\\,d\\varepsilon = (E + H)\\,d\\lambda \\implies d\\lambda = \\frac{E}{E+H}\\,d\\varepsilon\n$$\n现在，我们将 $d\\lambda$ 的这个表达式代回 $d\\sigma$ 的方程中：\n$$\nd\\sigma = (1 - d)E\\,d\\varepsilon - \\left[ (1 - d)E + \\tilde{\\sigma}\\beta \\right]\\left(\\frac{E}{E+H}\\right)\\,d\\varepsilon\n$$\n那么，算法切线模量 $K_{\\text{alg}} = \\frac{d\\sigma}{d\\varepsilon}$ 为：\n$$\nK_{\\text{alg}} = (1 - d)E - \\frac{E\\left[ (1 - d)E + \\tilde{\\sigma}\\beta \\right]}{E+H}\n$$\n为了简化，我们将各项通分：\n$$\nK_{\\text{alg}} = \\frac{(1 - d)E(E+H) - E\\left[ (1 - d)E + \\tilde{\\sigma}\\beta \\right]}{E+H}\n$$\n$$\nK_{\\text{alg}} = \\frac{(1 - d)E^2 + (1 - d)EH - (1 - d)E^2 - E\\tilde{\\sigma}\\beta}{E+H}\n$$\n$$\nK_{\\text{alg}} = \\frac{(1 - d)EH - E\\tilde{\\sigma}\\beta}{E+H}\n$$\n这就是算法切线模量的闭式表达式。\n\n**2) $K_{\\text{alg}}$ 的数值计算**\n\n首先，我们确定在给定状态下（累积塑性应变为 $p=0.02$ 时）状态变量 $d$ 和 $\\tilde{\\sigma}$ 的值。\n材料参数为：$E = 210\\,\\text{GPa}$，$H = 2\\,\\text{GPa}$，$\\sigma_{y0} = 0.4\\,\\text{GPa}$，以及 $\\beta = 5$。\n\n损伤变量 $d$ 为：\n$$\nd = \\beta\\,p = 5 \\times 0.02 = 0.1\n$$\n由于状态是塑性的，屈服条件成立，$\\tilde{\\sigma} = \\sigma_{y0} + H\\,p$：\n$$\n\\tilde{\\sigma} = 0.4\\,\\text{GPa} + (2\\,\\text{GPa} \\times 0.02) = 0.4\\,\\text{GPa} + 0.04\\,\\text{GPa} = 0.44\\,\\text{GPa}\n$$\n现在，将这些值代入推导出的 $K_{\\text{alg}}$ 表达式中：\n$$\nK_{\\text{alg}} = \\frac{(1 - 0.1)(210\\,\\text{GPa})(2\\,\\text{GPa}) - (210\\,\\text{GPa})(0.44\\,\\text{GPa})(5)}{210\\,\\text{GPa} + 2\\,\\text{GPa}}\n$$\n$$\nK_{\\text{alg}} = \\frac{(0.9)(420)\\,\\text{GPa}^2 - (210)(2.2)\\,\\text{GPa}^2}{212\\,\\text{GPa}} = \\frac{378\\,\\text{GPa}^2 - 462\\,\\text{GPa}^2}{212\\,\\text{GPa}}\n$$\n$$\nK_{\\text{alg}} = \\frac{-84}{212}\\,\\text{GPa} = -\\frac{21}{53}\\,\\text{GPa} \\approx -0.396226\\,\\text{GPa}\n$$\n四舍五入到四位有效数字，算法切线为 $K_{\\text{alg}} = -0.3962\\,\\text{GPa}$。负号表示材料软化。\n\n**3) 割线斜率 $K_{\\text{sec}}$ 的计算**\n\n割线斜率定义为 $K_{\\text{sec}} = \\sigma/\\varepsilon$。我们需要计算给定状态下的总应力 $\\sigma$ 和总应变 $\\varepsilon$。\n柯西应力 $\\sigma$ 为：\n$$\n\\sigma = (1 - d)\\,\\tilde{\\sigma} = (1 - 0.1)(0.44\\,\\text{GPa}) = 0.9 \\times 0.44\\,\\text{GPa} = 0.396\\,\\text{GPa}\n$$\n总应变 $\\varepsilon$ 是弹性应变 $\\varepsilon^e$ 和塑性应变 $\\varepsilon^p$ 的和。弹性应变为 $\\varepsilon^e = \\tilde{\\sigma}/E$。对于单调加载，$\\varepsilon^p = p$。\n$$\n\\varepsilon = \\varepsilon^e + \\varepsilon^p = \\frac{\\tilde{\\sigma}}{E} + p = \\frac{0.44\\,\\text{GPa}}{210\\,\\text{GPa}} + 0.02\n$$\n$$\n\\varepsilon = \\frac{0.44}{210} + 0.02 = \\frac{0.44 + 4.2}{210} = \\frac{4.64}{210}\n$$\n因此，割线斜率为：\n$$\nK_{\\text{sec}} = \\frac{\\sigma}{\\varepsilon} = \\frac{0.396}{\\frac{4.64}{210}} = \\frac{0.396 \\times 210}{4.64}\\,\\text{GPa} = \\frac{83.16}{4.64}\\,\\text{GPa} \\approx 17.9224\\,\\text{GPa}\n$$\n四舍五入到四位有效数字，割线斜率为 $K_{\\text{sec}} = 17.92\\,\\text{GPa}$。\n\n**4) 比率 $R$ 的计算与定性解释**\n\n比率 $R$ 是 $K_{\\text{alg}}/K_{\\text{sec}}$。使用上面推导的精确分数值：\n$$\nK_{\\text{alg}} = -\\frac{21}{53}\\,\\text{GPa}\n$$\n$$\nK_{\\text{sec}} = \\frac{83.16}{4.64}\\,\\text{GPa} = \\frac{8316}{464}\\,\\text{GPa} = \\frac{2079}{116}\\,\\text{GPa}\n$$\n比率 $R$ 为：\n$$\nR = \\frac{K_{\\text{alg}}}{K_{\\text{sec}}} = \\frac{-21/53}{2079/116} = -\\frac{21}{53} \\times \\frac{116}{2079}\n$$\n我们注意到 $2079 = 21 \\times 99$。\n$$\nR = -\\frac{21 \\times 116}{53 \\times (21 \\times 99)} = -\\frac{116}{53 \\times 99} = -\\frac{116}{5247}\n$$\n此分数为最简形式。\n\n对 Newton-Raphson (NR) 收敛的定性影响：负的算法切线 ($K_{\\text{alg}} < 0$) 表明材料软化，这可能导致标准的 Newton-Raphson 算法发散或振荡，因为迭代更新会使解偏离平衡路径，即使在位移控制下也是如此。", "answer": "$$\n\\boxed{-\\frac{116}{5247}}\n$$", "id": "2626367"}]}