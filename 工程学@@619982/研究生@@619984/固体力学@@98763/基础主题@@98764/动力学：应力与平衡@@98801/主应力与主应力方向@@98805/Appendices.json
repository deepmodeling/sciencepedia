{"hands_on_practices": [{"introduction": "掌握主应力计算是理解应力分析的基础。本练习提供了一个具体的三维应力张量，要求你通过求解特征方程这一基本方法来确定其主应力。这个过程不仅能巩固你对主应力作为张量特征值的核心概念的理解，还能通过不变量检验结果，培养严谨的工程计算习惯。[@problem_id:2674943]", "id": "2674943", "problem": "某个点处的均匀各向同性固体，其柯西应力张量的分量（单位为兆帕斯卡，MPa）在固定的笛卡尔坐标基下由下式给出：\n$$\n\\boldsymbol{\\sigma}=\\begin{pmatrix}\n120 & 60 & 0\\\\\n60 & 120 & 60\\\\\n0 & 60 & 120\n\\end{pmatrix}.\n$$\n仅使用对称二阶张量特征值分析的第一性原理，通过求解该张量的特征三次方程来确定主应力。然后，通过检验主应力之和等于 $\\boldsymbol{\\sigma}$ 的迹以及主应力之积等于 $\\det(\\boldsymbol{\\sigma})$ 来验证你的结果。作为最终答案，报告以 MPa 表示的最大主应力值，并四舍五入到四位有效数字。不要报告任何其他量，并且最终的方框答案中不要包含单位。", "solution": "所述问题是有效的。这是一个连续介质力学中的标准、适定的问题，基于线性代数和张量分析的既定原理。所有需要的数据都已提供，且任务是客观且科学可验证的。\n\n主应力是柯西应力张量 $\\boldsymbol{\\sigma}$ 的特征值。根据定义，特征值 $\\lambda$ 及其对应的特征向量 $\\mathbf{n}$（主方向）满足方程 $\\boldsymbol{\\sigma}\\mathbf{n} = \\lambda\\mathbf{n}$。这可以改写为 $(\\boldsymbol{\\sigma} - \\lambda\\mathbf{I})\\mathbf{n} = \\mathbf{0}$，其中 $\\mathbf{I}$ 是二阶单位张量。为了使 $\\mathbf{n}$ 存在非平凡解，矩阵 $(\\boldsymbol{\\sigma} - \\lambda\\mathbf{I})$ 的行列式必须为零。这个条件给出了特征方程：\n$$\n\\det(\\boldsymbol{\\sigma} - \\lambda\\mathbf{I}) = 0\n$$\n给定的应力张量为：\n$$\n\\boldsymbol{\\sigma}=\\begin{pmatrix}\n120 & 60 & 0\\\\\n60 & 120 & 60\\\\\n0 & 60 & 120\n\\end{pmatrix} \\text{ MPa}\n$$\n因此，特征方程为：\n$$\n\\det \\begin{pmatrix}\n120 - \\lambda & 60 & 0\\\\\n60 & 120 - \\lambda & 60\\\\\n0 & 60 & 120 - \\lambda\n\\end{pmatrix} = 0\n$$\n我们沿着第一行使用代数余子式展开来计算行列式：\n$$\n(120 - \\lambda) \\begin{vmatrix}\n120 - \\lambda & 60\\\\\n60 & 120 - \\lambda\n\\end{vmatrix}\n- 60 \\begin{vmatrix}\n60 & 60\\\\\n0 & 120 - \\lambda\n\\end{vmatrix}\n+ 0 = 0\n$$\n$$\n(120 - \\lambda) \\left[ (120 - \\lambda)^2 - 60^2 \\right] - 60 \\left[ 60(120 - \\lambda) - 0 \\right] = 0\n$$\n$$\n(120 - \\lambda) \\left[ (120 - \\lambda)^2 - 3600 \\right] - 3600 (120 - \\lambda) = 0\n$$\n我们可以提出公因子 $(120 - \\lambda)$：\n$$\n(120 - \\lambda) \\left[ (120 - \\lambda)^2 - 3600 - 3600 \\right] = 0\n$$\n$$\n(120 - \\lambda) \\left[ (120 - \\lambda)^2 - 7200 \\right] = 0\n$$\n这个三次方程得到 $\\lambda$ 的三个根，它们就是主应力。\n从第一个因子可以立即得到一个根：\n$$\n120 - \\lambda = 0 \\implies \\lambda_1 = 120 \\text{ MPa}\n$$\n另外两个根从第二个因子求得：\n$$\n(120 - \\lambda)^2 - 7200 = 0\n$$\n$$\n(120 - \\lambda)^2 = 7200\n$$\n$$\n120 - \\lambda = \\pm\\sqrt{7200} = \\pm\\sqrt{3600 \\times 2} = \\pm 60\\sqrt{2}\n$$\n这给出了另外两个主应力：\n$$\n\\lambda = 120 \\mp 60\\sqrt{2}\n$$\n所以，剩下的两个根是：\n$$\n\\lambda_2 = 120 + 60\\sqrt{2} \\text{ MPa}\n$$\n$$\n\\lambda_3 = 120 - 60\\sqrt{2} \\text{ MPa}\n$$\n计算出的主应力为 $\\sigma_1 = 120 + 60\\sqrt{2}$，$\\sigma_2 = 120$ 和 $\\sigma_3 = 120 - 60\\sqrt{2}$，单位均为 MPa。\n\n按要求，我们使用应力张量的不变量来验证此结果。\n第一不变量是张量的迹 $I_1 = \\text{tr}(\\boldsymbol{\\sigma})$，它必须等于主应力之和。\n$$\n\\text{tr}(\\boldsymbol{\\sigma}) = 120 + 120 + 120 = 360 \\text{ MPa}\n$$\n$$\n\\sum_{i=1}^{3} \\sigma_i = (120 + 60\\sqrt{2}) + 120 + (120 - 60\\sqrt{2}) = 120 + 120 + 120 = 360 \\text{ MPa}\n$$\n验证成立：$I_1 = \\sum \\sigma_i$。\n\n第三不变量是张量的行列式 $I_3 = \\det(\\boldsymbol{\\sigma})$，它必须等于主应力之积。\n$$\n\\det(\\boldsymbol{\\sigma}) = 120(120^2 - 60^2) - 60(60 \\times 120) = 120(14400 - 3600) - 60(7200)\n$$\n$$\n\\det(\\boldsymbol{\\sigma}) = 120(10800) - 432000 = 1296000 - 432000 = 864000 \\text{ MPa}^3\n$$\n$$\n\\prod_{i=1}^{3} \\sigma_i = (120 + 60\\sqrt{2}) \\times 120 \\times (120 - 60\\sqrt{2})\n= 120 \\left[ 120^2 - (60\\sqrt{2})^2 \\right]\n$$\n$$\n\\prod_{i=1}^{3} \\sigma_i = 120 [14400 - 3600 \\times 2] = 120(14400 - 7200) = 120(7200) = 864000 \\text{ MPa}^3\n$$\n验证成立：$I_3 = \\prod \\sigma_i$。计算出的主应力是正确的。\n\n问题要求的是最大主应力，我们将其记为 $\\sigma_{\\max}$。\n$$\n\\sigma_{\\max} = \\lambda_2 = 120 + 60\\sqrt{2}\n$$\n为了给出数值，我们使用近似值 $\\sqrt{2} \\approx 1.41421356...$。\n$$\n\\sigma_{\\max} \\approx 120 + 60(1.41421356) = 120 + 84.8528136 = 204.8528136 \\text{ MPa}\n$$\n将此值四舍五入到四位有效数字，得到 $204.9$。", "answer": "$$\\boxed{204.9}$$"}, {"introduction": "在掌握了基本计算之后，我们来探讨一个特殊但重要的理论情况：主应力简并。本练习将分析一个等二轴拉伸的应力状态，此时两个主应力相等，导致主方向不再唯一。通过这个思想实验，你将深入理解主方向简并的物理意义，并探索应力张量与其偏量部分及不变量之间的关系。[@problem_id:2674890]", "id": "2674890", "problem": "一个均匀的线性弹性固体承受一个均匀的 Cauchy 应力场，该应力场在一个标准正交基 $\\{\\boldsymbol{e}_1,\\boldsymbol{e}_2,\\boldsymbol{e}_3\\}$ 中由二阶张量 $\\boldsymbol{\\sigma}=\\sigma_0\\,(\\boldsymbol{e}_1\\otimes\\boldsymbol{e}_1+\\boldsymbol{e}_2\\otimes\\boldsymbol{e}_2)$ 表示，其中 $\\sigma_0&gt;0$ 是一个常数。基于角动量平衡（它意味着 Cauchy 应力张量的对称性）、主应力是平面上正向牵引力驻值的定义（这导致了 $\\boldsymbol{\\sigma}$ 的一个特征值问题）以及应力不变量的定义，完成以下任务：\n\n1) 确定主应力并标定主应力方向。从特征值问题的结构出发，解释为什么在 $\\boldsymbol{e}_1$–$\\boldsymbol{e}_2$ 平面内主方向存在简并性，并明确地描述相关的主子空间。\n\n2) 计算偏应力张量 $\\boldsymbol{s}=\\boldsymbol{\\sigma}-\\tfrac{1}{3}I_1\\,\\boldsymbol{I}$，其中 $I_1=\\operatorname{tr}(\\boldsymbol{\\sigma})$ 且 $\\boldsymbol{I}$ 是单位张量，然后确定 $\\boldsymbol{s}$ 的第二不变量，其定义为 $J_2=\\tfrac{1}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}$。\n\n报告 $J_2$ 的精确值作为你的最终答案，并以 $\\sigma_0$ 的符号形式表示。将 $\\sigma_0$ 的单位理解为帕斯卡 (Pa)，这样 $J_2$ 的单位就为 $\\text{Pa}^2$。在最终的方框答案中请勿包含单位。无需进行数值舍入。", "solution": "对问题陈述进行验证。\n\n逐字提取已知条件：\n1.  一个均匀的线性弹性固体。\n2.  在标准正交基 $\\{\\boldsymbol{e}_1,\\boldsymbol{e}_2,\\boldsymbol{e}_3\\}$ 中的一个均匀 Cauchy 应力场 $\\boldsymbol{\\sigma}$。\n3.  应力张量为 $\\boldsymbol{\\sigma}=\\sigma_0\\,(\\boldsymbol{e}_1\\otimes\\boldsymbol{e}_1+\\boldsymbol{e}_2\\otimes\\boldsymbol{e}_2)$。\n4.  $\\sigma_0>0$ 是一个常数。\n5.  使用的基本原理：角动量平衡（$\\boldsymbol{\\sigma}$ 的对称性）、通过特征值问题定义主应力，以及应力不变量的定义。\n6.  任务1：确定主应力和主方向；解释 $\\boldsymbol{e}_1\\boldsymbol{e}_2$ 平面内的简并性并描述主子空间。\n7.  任务2：计算偏应力张量 $\\boldsymbol{s}=\\boldsymbol{\\sigma}-\\tfrac{1}{3}I_1\\,\\boldsymbol{I}$，其中 $I_1=\\operatorname{tr}(\\boldsymbol{\\sigma})$，然后计算 $J_2=\\tfrac{1}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}$。\n8.  最终答案必须是 $J_2$ 以 $\\sigma_0$ 表示的精确值。\n\n验证：\n该问题具有科学依据，植根于连续介质力学的基础理论。这是一个提法恰当的问题，提供了推导所求量的唯一解所需的所有信息。语言客观而精确。该问题是应力分析中的一个标准的、非平凡的练习，旨在检验对主应力、简并态和应力不变量的正确理解。未发现任何缺陷。该问题有效。\n\n开始求解。\n\n给定的 Cauchy 应力张量 $\\boldsymbol{\\sigma}$ 为 $\\boldsymbol{\\sigma}=\\sigma_0\\,(\\boldsymbol{e}_1\\otimes\\boldsymbol{e}_1+\\boldsymbol{e}_2\\otimes\\boldsymbol{e}_2)$。在标准正交基 $\\{\\boldsymbol{e}_1,\\boldsymbol{e}_2,\\boldsymbol{e}_3\\}$ 中，该张量的矩阵表示为：\n$$[\\sigma] = \\begin{pmatrix} \\sigma_0 & 0 & 0 \\\\ 0 & \\sigma_0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$$\n该张量是对称的，符合角动量平衡的要求。\n\n第1部分：主应力和主方向\n\n主应力是应力张量 $\\boldsymbol{\\sigma}$ 的特征值，主方向是其对应的特征向量。特征值问题由 $\\boldsymbol{\\sigma}\\boldsymbol{n} = \\lambda\\boldsymbol{n}$ 给出，其中 $\\lambda$ 是主应力，$\\boldsymbol{n}$ 是对应的主方向。其矩阵形式为 $([\\sigma] - \\lambda[I])[\\boldsymbol{n}] = \\boldsymbol{0}$。主应力是特征方程 $\\det([\\sigma] - \\lambda[I]) = 0$ 的根。\n$$ \\det \\begin{pmatrix} \\sigma_0 - \\lambda & 0 & 0 \\\\ 0 & \\sigma_0 - \\lambda & 0 \\\\ 0 & 0 & -\\lambda \\end{pmatrix} = 0 $$\n$$ (\\sigma_0 - \\lambda)(\\sigma_0 - \\lambda)(-\\lambda) = 0 $$\n$$ -\\lambda(\\sigma_0 - \\lambda)^2 = 0 $$\n该方程的根即为主应力，为 $\\lambda = \\sigma_0$ (代数重数为 $2$) 和 $\\lambda = 0$。按照惯例，我们将它们排序为 $\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3$。\n因此，主应力为：\n$$ \\sigma_1 = \\sigma_0, \\quad \\sigma_2 = \\sigma_0, \\quad \\sigma_3 = 0 $$\n\n为了找到主方向，我们求解每个不同特征值对应的特征向量。\n\n对于主应力 $\\sigma_3 = 0$：\n$$ ([\\sigma] - 0[I])[\\boldsymbol{n}^{(3)}] = \\boldsymbol{0} $$\n$$ \\begin{pmatrix} \\sigma_0 & 0 & 0 \\\\ 0 & \\sigma_0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} n_1 \\\\ n_2 \\\\ n_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n该方程组得出 $\\sigma_0 n_1 = 0$ 和 $\\sigma_0 n_2 = 0$。由于 $\\sigma_0 > 0$，必须有 $n_1=0$ 和 $n_2=0$。分量 $n_3$ 是任意的。因此，归一化的特征向量，即主方向，是 $\\boldsymbol{n}^{(3)} = \\boldsymbol{e}_3$。\n\n对于重复的主应力 $\\sigma_1 = \\sigma_2 = \\sigma_0$：\n$$ ([\\sigma] - \\sigma_0[I])[\\boldsymbol{n}] = \\boldsymbol{0} $$\n$$ \\begin{pmatrix} \\sigma_0 - \\sigma_0 & 0 & 0 \\\\ 0 & \\sigma_0 - \\sigma_0 & 0 \\\\ 0 & 0 & 0 - \\sigma_0 \\end{pmatrix} \\begin{pmatrix} n_1 \\\\ n_2 \\\\ n_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n$$ \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & -\\sigma_0 \\end{pmatrix} \\begin{pmatrix} n_1 \\\\ n_2 \\\\ n_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n这给出了一个单一的方程 $-\\sigma_0 n_3 = 0$，意味着 $n_3=0$。分量 $n_1$ 和 $n_2$ 不受约束。任何形式为 $\\boldsymbol{n} = n_1\\boldsymbol{e}_1 + n_2\\boldsymbol{e}_2$ 的向量都是对应于特征值 $\\sigma_0$ 的特征向量。\n\n主方向出现简并性的原因在于特征值 $\\sigma_0$ 的几何重数为$2$，与其代数重数相匹配。特征值问题并没有唯一地确定一个方向；相反，它定义了一个二维的特征向量子空间，称为特征空间。该特征空间就是与主应力 $\\sigma_0$ 相关联的主子空间。它的特征是所有与 $\\boldsymbol{n}^{(3)} = \\boldsymbol{e}_3$ 正交的向量集合。这恰好是由基向量 $\\boldsymbol{e}_1$ 和 $\\boldsymbol{e}_2$ 张成的平面。因此，任何位于 $\\boldsymbol{e}_1\\boldsymbol{e}_2$ 平面内的方向都是对应于主应力 $\\sigma_0$ 的主方向。其物理意义是平面内的等双轴拉伸状态。\n\n第2部分：偏应力和第二不变量 $J_2$\n\n偏应力张量 $\\boldsymbol{s}$ 定义为 $\\boldsymbol{s}=\\boldsymbol{\\sigma}-\\tfrac{1}{3}I_1\\,\\boldsymbol{I}$。\n首先，我们计算应力第一不变量 $I_1 = \\operatorname{tr}(\\boldsymbol{\\sigma})$。\n$$ I_1 = \\operatorname{tr}([\\sigma]) = \\sigma_0 + \\sigma_0 + 0 = 2\\sigma_0 $$\n或者，$I_1$ 是主应力之和：$I_1 = \\sigma_1 + \\sigma_2 + \\sigma_3 = \\sigma_0 + \\sigma_0 + 0 = 2\\sigma_0$。\n\n应力的静水压力部分是 $\\frac{1}{3}I_1\\boldsymbol{I}$，其矩阵表示为：\n$$ [\\sigma_m] = \\frac{1}{3}I_1[I] = \\frac{2\\sigma_0}{3} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3}\\sigma_0 & 0 & 0 \\\\ 0 & \\frac{2}{3}\\sigma_0 & 0 \\\\ 0 & 0 & \\frac{2}{3}\\sigma_0 \\end{pmatrix} $$\n那么偏应力张量为：\n$$ [s] = [\\sigma] - [\\sigma_m] = \\begin{pmatrix} \\sigma_0 & 0 & 0 \\\\ 0 & \\sigma_0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} - \\begin{pmatrix} \\frac{2}{3}\\sigma_0 & 0 & 0 \\\\ 0 & \\frac{2}{3}\\sigma_0 & 0 \\\\ 0 & 0 & \\frac{2}{3}\\sigma_0 \\end{pmatrix} $$\n$$ [s] = \\begin{pmatrix} \\frac{1}{3}\\sigma_0 & 0 & 0 \\\\ 0 & \\frac{1}{3}\\sigma_0 & 0 \\\\ 0 & 0 & -\\frac{2}{3}\\sigma_0 \\end{pmatrix} $$\n偏应力张量的第二不变量 $J_2$ 定义为 $J_2=\\tfrac{1}{2}\\boldsymbol{s}:\\boldsymbol{s}$。双点积 $\\boldsymbol{s}:\\boldsymbol{s}$ 是张量各分量 $s_{ij}s_{ij}$ 的平方和。\n$$ \\boldsymbol{s}:\\boldsymbol{s} = s_{11}^2 + s_{22}^2 + s_{33}^2 = \\left(\\frac{1}{3}\\sigma_0\\right)^2 + \\left(\\frac{1}{3}\\sigma_0\\right)^2 + \\left(-\\frac{2}{3}\\sigma_0\\right)^2 $$\n$$ \\boldsymbol{s}:\\boldsymbol{s} = \\frac{1}{9}\\sigma_0^2 + \\frac{1}{9}\\sigma_0^2 + \\frac{4}{9}\\sigma_0^2 = \\frac{6}{9}\\sigma_0^2 = \\frac{2}{3}\\sigma_0^2 $$\n因此，$J_2$ 为：\n$$ J_2 = \\frac{1}{2}\\left(\\frac{2}{3}\\sigma_0^2\\right) = \\frac{1}{3}\\sigma_0^2 $$\n\n作为验证，$J_2$ 也可以由主应力计算得出：\n$$ J_2 = \\frac{1}{6}\\left[ (\\sigma_1-\\sigma_2)^2 + (\\sigma_2-\\sigma_3)^2 + (\\sigma_3-\\sigma_1)^2 \\right] $$\n代入 $\\sigma_1 = \\sigma_0$, $\\sigma_2 = \\sigma_0$ 和 $\\sigma_3 = 0$：\n$$ J_2 = \\frac{1}{6}\\left[ (\\sigma_0-\\sigma_0)^2 + (\\sigma_0-0)^2 + (0-\\sigma_0)^2 \\right] $$\n$$ J_2 = \\frac{1}{6}\\left[ 0^2 + \\sigma_0^2 + (-\\sigma_0)^2 \\right] = \\frac{1}{6}(2\\sigma_0^2) = \\frac{1}{3}\\sigma_0^2 $$\n结果一致。$J_2$ 的单位是应力的平方，如果 $\\sigma_0$ 的单位是帕斯卡，那么 $J_2$ 的单位就是 $\\text{Pa}^2$。\n最终值已推导得出。", "answer": "$$\\boxed{\\frac{1}{3}\\sigma_0^2}$$"}, {"introduction": "理论与计算实践的结合是现代固体力学的核心。在理解了理想的简并情况后，本练习将探讨数值计算中更常见的情形：主应力值非常接近（近简并）。你将通过一个具体的参数化例子，亲手验证单个主方向在近简并情况下的数值不稳定性，并学习使用不вариант子空间这一更稳健的概念来分析和比较应力状态。[@problem_id:2674873]", "id": "2674873", "problem": "考虑柯西应力张量，它被建模为一个实对称矩阵，并回想主应力是其特征值，主方向是其相关的特征向量。在重特征值附近，主方向在数值上可能变得病态：张量的微小变化可能引起单个特征向量的大幅旋转。你需要用一个显式的参数化族来演示这一现象，然后实现一种基于不变子空间的稳健修正方法。\n\n从以下基本定义出发：\n- 主应力和主方向由对称张量的谱分解定义：对于一个实对称矩阵 $\\sigma \\in \\mathbb{R}^{3 \\times 3}$，存在一个正交矩阵 $Q$ 使得 $\\sigma = Q \\Lambda Q^{\\top}$，其中 $\\Lambda$ 是对角矩阵， $Q$ 是正交矩阵。$Q$ 的列是主方向，$\\Lambda$ 的对角线元素是主应力。\n- $\\sigma$ 的一个不变子空间是指满足 $\\sigma S \\subseteq S$ 的子空间 $S \\subset \\mathbb{R}^{3}$。如果 $\\Lambda$ 有一个特征值簇（可能是重特征值或近似重特征值），对应特征向量张成的空间构成一个不变子空间，即使该子空间内的单个特征向量不是唯一确定的，这个不变子空间本身是唯一确定的。\n- 不变子空间有非唯一的标准正交基，但到该子空间的正交投影算子 $P$ 是唯一的，并且可以写成 $P = VV^{\\top}$ 的形式，其中 $V$ 的列构成了该子空间的任意一组标准正交基。\n\n定义参数化的对称应力张量族\n$$\n\\sigma(\\varepsilon,\\phi) = R(\\phi)^{\\top} \\, \\mathrm{diag}(1-\\varepsilon,\\, 1+\\varepsilon,\\, 3) \\, R(\\phi),\n$$\n其中 $\\varepsilon \\in \\mathbb{R}$ 是一个小的分裂参数，$R(\\phi)$ 是绕 $z$ 轴旋转角度 $\\phi$ 的旋转矩阵，\n$$\nR(\\phi) = \\begin{bmatrix}\n\\cos\\phi & -\\sin\\phi & 0 \\\\\n\\sin\\phi & \\phantom{-}\\cos\\phi & 0 \\\\\n0 & 0 & 1\n\\end{bmatrix}.\n$$\n当 $\\varepsilon = 0$ 时，特征值 $1$ 的重数为 $2$，其不变子空间为整个 $xy$-平面。对于小的非零 $\\varepsilon$，特征值 $1-\\varepsilon$ 和 $1+\\varepsilon$ 是不同的但非常接近，它们对应的特征向量张成（近似）相同的不变子空间（$xy$-平面），而该子空间内的单个特征向量会因 $\\phi$ 的微小变化而发生 $\\mathcal{O}(1)$ 的旋转。\n\n你的任务：\n1) 仅使用上述基本定义（谱分解、不变子空间和正交投影算子），论证为什么在固定小的 $\\varepsilon$ 时，通过改变 $\\phi$，与接近 $1$ 的特征值相关的单个主方向可以在 $xy$-平面内任意旋转，而相关的不变子空间（$xy$-平面）保持不变。解释为什么在固定的 $\\phi_1, \\phi_2$ 下，弗罗贝尼乌斯范数差 $\\|\\sigma(\\varepsilon,\\phi_2) - \\sigma(\\varepsilon,\\phi_1)\\|_F$ 是 $\\mathcal{O}(|\\varepsilon|)$，而对应于较小特征值的单个特征向量之间的角度可以是 $\\mathcal{O}(1)$，从而证明了病态性。\n\n2) 提出一种稳健的算法修正：比较不变子空间，而不是单个特征向量。具体来说，对于与两个接近 $1$ 的特征值相关的二维不变子空间，构造标准正交基 $V_1, V_2 \\in \\mathbb{R}^{3 \\times 2}$，并通过对 $V_1^{\\top} V_2$ 进行奇异值分解（SVD）来计算这些子空间之间的主角。将最大的主角定义为子空间差异度量。解释为什么这个度量对于近简并性是稳健的。\n\n3) 实现一个程序，对每个测试用例执行以下操作：\n- 构造 $\\sigma(\\varepsilon,\\phi_1)$（其中 $\\phi_1 = 0$）和给定 $\\phi_2$ 的 $\\sigma(\\varepsilon,\\phi_2)$。\n- 对每个张量，计算与接近 $1$ 的两个特征值中较小者相关的主方向，通过使用点积的绝对值来解决符号模糊性，并报告这两个向量之间的夹角（单位：度）。\n- 对每个张量，计算与接近 $1$ 的两个特征值相关的二维不变子空间的标准正交基，然后通过对 $V_1^{\\top} V_2$ 进行SVD来计算两个子空间之间的最大主角（单位：度）。\n- 计算弗罗贝尼乌斯范数 $\\|\\sigma(\\varepsilon,\\phi_2) - \\sigma(\\varepsilon,\\phi_1)\\|_F$。\n- 所有角度均以度为单位报告，并将所有报告的浮点数四舍五入到 $6$ 位小数。\n\n角度单位：度。不涉及物理单位。不使用百分比。\n\n测试集：\n- 情况 A (正常情况): $\\varepsilon = 10^{-1}$, $\\phi_2 = \\pi/4$。\n- 情况 B (边缘情况：近似重特征值): $\\varepsilon = 10^{-6}$, $\\phi_2 = \\pi/4$。\n- 情况 C (边界情况：旋转相同): $\\varepsilon = 10^{-6}$, $\\phi_2 = 0$。\n- 情况 D (边缘情况：极小分裂与大角度旋转): $\\varepsilon = 10^{-8}$, $\\phi_2 = \\pi/2$。\n\n对于每种情况，你必须输出一个包含三个浮点数的列表 [naive_angle_deg, subspace_angle_deg, frobenius_norm_difference]，每个浮点数四舍五入到 $6$ 位小数。你的程序应生成单行输出，其中包含这些按情况排列的列表，这些列表由逗号分隔并包含在方括号内，例如：\n[[a1,b1,c1],[a2,b2,c2],[a3,b3,c3],[a4,b4,c4]]\n其中每个 $a_i, b_i, c_i$ 都是如上所述格式化的浮点数。\n\n不允许用户输入；程序必须按原样运行并产生所描述的单行输出。", "solution": "我们从第一性原理出发。对于一个实对称张量 $\\sigma \\in \\mathbb{R}^{3 \\times 3}$，谱定理保证了其存在正交对角化 $\\sigma = Q \\Lambda Q^{\\top}$，其中 $Q$ 是正交矩阵，$Q$ 的列是主方向，而 $\\Lambda$ 是包含主应力的对角矩阵。$\\sigma$ 的一个不变子空间 $S$ 是 $\\mathbb{R}^{3}$ 中任何被 $\\sigma$ 映射到其自身的子空间。如果 $\\Lambda$ 包含一个特征值簇（可能是重特征值），那么对应特征向量张成的空间就是一个不变子空间，即使单个特征向量不唯一，该子空间也是唯一确定的。\n\n重特征值附近主方向的病态性：考虑\n$$\n\\sigma(\\varepsilon,\\phi) = R(\\phi)^{\\top} \\, \\mathrm{diag}(1-\\varepsilon,\\, 1+\\varepsilon,\\, 3)\\, R(\\phi),\n$$\n其中 $R(\\phi)$ 是绕 $z$ 轴的旋转。当 $\\varepsilon=0$ 时，特征值 $1$ 的重数为 $2$，其不变子空间为整个 $xy$-平面。在这种情况下，$xy$-平面中的任何一对标准正交向量都可以被选为特征值 $1$ 的主方向。对于小的非零 $\\varepsilon$，特征值分裂为 $1-\\varepsilon$ 和 $1+\\varepsilon$，相关的特征向量位于 $xy$-平面内，并相对于标准坐标轴旋转了 $\\phi$。关键在于，如果我们比较两个张量 $\\sigma(\\varepsilon,\\phi_1)$ 和 $\\sigma(\\varepsilon,\\phi_2)$，其中 $\\varepsilon$ 是固定的小值且角度 $\\phi_1 \\neq \\phi_2$，那么差值\n$$\n\\Delta \\sigma = \\sigma(\\varepsilon,\\phi_2) - \\sigma(\\varepsilon,\\phi_1)\n$$\n的弗罗贝尼乌斯范数是 $\\mathcal{O}(|\\varepsilon|)$。要理解这一点，可将 $\\sigma(\\varepsilon,\\phi)$ 写成\n$$\n\\sigma(\\varepsilon,\\phi) = \\mathrm{diag}(1,1,3) + \\varepsilon \\, R(\\phi)^{\\top} \\, \\mathrm{diag}(-1,1,0)\\, R(\\phi),\n$$\n因此对于固定的 $\\phi_1, \\phi_2$，\n$$\n\\Delta \\sigma = \\varepsilon \\left(R(\\phi_2)^{\\top} \\, \\mathrm{diag}(-1,1,0)\\, R(\\phi_2) - R(\\phi_1)^{\\top} \\, \\mathrm{diag}(-1,1,0)\\, R(\\phi_1)\\right),\n$$\n所以 $\\|\\Delta \\sigma\\|_F \\le C(\\phi_1,\\phi_2)\\, |\\varepsilon|$，其中常数 $C$ 仅依赖于 $\\phi_1, \\phi_2$。与此同时，在 $xy$-平面中与较小特征值 $1-\\varepsilon$ 相关联的单个特征向量彼此之间旋转了角度 $|\\phi_2 - \\phi_1|$，这是一个 $\\mathcal{O}(1)$ 的量，与 $\\varepsilon$ 无关。因此，从 $\\sigma$ 到单个特征向量的映射在重特征值附近是病态的：$\\sigma$ 的微小变化（大小为 $\\mathcal{O}(|\\varepsilon|)$）可以导致特征向量的巨大变化（大小为 $\\mathcal{O}(1)$）。\n\n通过不变子空间的稳健修正方法：与接近 $1$ 的一对特征值相关的二维不变子空间对所有 $\\phi$ 都是 $xy$-平面，因为绕 $z$ 轴的旋转保持该平面不变。即使特征值 $1$ 分裂为 $1-\\varepsilon$ 和 $1+\\varepsilon$，两个对应特征向量的张成空间仍然是 $xy$-平面；平面内的单个基向量不是唯一的，但该子空间是唯一的。到该子空间的正交投影算子 $P$ 可以表示为 $P = V V^{\\top}$，其中 $V \\in \\mathbb{R}^{3 \\times 2}$ 是该子空间的任意标准正交基。与单个特征向量不同，$P$ 是唯一的，并且在小的扰动下平滑变化，只要该特征值簇与其余谱（此处与特征值 $3$ 有固定的谱隙）保持谱分离。为了比较由 $V_1$ 和 $V_2$ 的列向量张成的两个子空间，可以通过对 $V_1^{\\top} V_2 = U \\Sigma W^{\\top}$ 进行奇异值分解（SVD）来计算主角 $\\{\\theta_i\\}$，其中奇异值为 $\\{\\cos\\theta_i\\}$。最大的主角量化了最大的子空间差异。在我们的例子中，对于所有的 $\\varepsilon$ 和 $\\phi$，这个最大角度都是 $0$，反映了不变子空间的稳定性。\n\n算法设计：\n- 对于给定的 $\\varepsilon$ 和角度，构造 $\\sigma(\\varepsilon,\\phi_1)$ 和 $\\sigma(\\varepsilon,\\phi_2)$，取 $\\phi_1 = 0$。\n- 使用对称矩阵的特征求解器计算它们的谱分解。按升序对特征值排序，以识别接近 $1$ 的两个特征值和接近 $3$ 的最大特征值。\n- 朴素主方向比较：对每个张量，选择与接近 $1$ 的两个特征值中较小者对应的特征向量；称它们为 $v_1$ 和 $v_2$。通过使用 $|\\langle v_1, v_2 \\rangle|$ 来解决符号模糊性，计算 $v_1$ 和 $v_2$ 之间的角度，即\n$$\n\\alpha = \\arccos\\left(\\min\\{1, \\max\\{ -1, |\\langle v_1, v_2 \\rangle| \\}\\}\\right),\n$$\n并以度为单位报告 $\\alpha$。\n- 不变子空间比较：对每个张量，将与两个最小特征值相关的两个特征向量收集为 $V_1, V_2 \\in \\mathbb{R}^{3 \\times 2}$ 的列。计算 $V_1^{\\top} V_2$ 的SVD，其奇异值为 $\\{\\cos\\theta_1, \\cos\\theta_2\\}$，其中 $0 \\le \\theta_2 \\le \\theta_1 \\le \\pi/2$。以度为单位报告最大主角 $\\theta_1$。\n- 计算弗罗贝尼乌斯范数差 $\\|\\sigma(\\varepsilon,\\phi_2) - \\sigma(\\varepsilon,\\phi_1)\\|_F$。\n- 将所有报告的值四舍五入到 $6$ 位小数，并以所需的列表格式报告。\n\n给定测试集的预期定性结果：\n- 情况 A 和情况 B：朴素角度约为 $45$ 度，几乎与 $\\varepsilon$ 无关，而弗罗贝尼乌斯范数差与 $|\\varepsilon|$ 成正比。最大子空间角度约为 $0$ 度。\n- 情况 C：旋转相同时，朴素角度和子空间角度均为 $0$ 度，弗罗贝尼乌斯范数差为 $0$。\n- 情况 D：朴素角度约为 $90$ 度，子空间角度保持 $0$ 度，弗罗贝尼乌斯范数差与 $|\\varepsilon|$ 成正比。\n\n下面的实现完成了这个算法，并按指定格式打印一行包含各测试用例结果列表的输出。", "answer": "```python\nimport numpy as np\nimport json\n\ndef rotation_z(phi):\n    c = np.cos(phi)\n    s = np.sin(phi)\n    R = np.array([[c, -s, 0.0],\n                  [s,  c, 0.0],\n                  [0.0, 0.0, 1.0]], dtype=float)\n    return R\n\ndef stress_tensor(eps, phi):\n    # Construct sigma(eps, phi) = R^T diag(1-eps, 1+eps, 3) R\n    R = rotation_z(phi)\n    D = np.diag([1.0 - eps, 1.0 + eps, 3.0])\n    return R.T @ D @ R\n\ndef eigh_sorted(A):\n    # Symmetric eigendecomposition with ascending eigenvalues\n    w, V = np.linalg.eigh(A)\n    # np.linalg.eigh returns ascending order already; keep for clarity\n    return w, V\n\ndef angle_between_vectors_deg(v1, v2):\n    # Normalize (just in case)\n    v1 = v1 / np.linalg.norm(v1)\n    v2 = v2 / np.linalg.norm(v2)\n    # Resolve sign ambiguity by absolute dot product\n    dot = float(np.clip(abs(np.dot(v1, v2)), -1.0, 1.0))\n    angle = np.arccos(dot)\n    return np.degrees(angle)\n\ndef max_principal_angle_between_subspaces_deg(V1, V2):\n    # V1, V2 are 3x2 with orthonormal columns (ideally).\n    # Compute singular values of V1^T V2\n    M = V1.T @ V2\n    # SVD\n    # For numerical safety, enforce orthonormalization via QR if necessary\n    # though eigh should provide orthonormal eigenvectors.\n    U, s, Wt = np.linalg.svd(M, full_matrices=False)\n    # Clamp singular values to [-1,1] to avoid numerical issues\n    s = np.clip(s, -1.0, 1.0)\n    # Principal angles are arccos(s_i); maximal principal angle is the largest\n    # angle corresponding to the smallest singular value\n    angles = np.arccos(s)\n    max_angle = np.max(angles)\n    return np.degrees(max_angle)\n\ndef frobenius_norm(A):\n    return float(np.linalg.norm(A, ord='fro'))\n\ndef solve():\n    # Define the test cases as (eps, phi2) with phi1 fixed at 0.\n    test_cases = [\n        (1e-1, np.pi/4),   # Case A: happy path\n        (1e-6, np.pi/4),   # Case B: nearly repeated eigenvalues\n        (1e-6, 0.0),       # Case C: boundary identical rotations\n        (1e-8, np.pi/2),   # Case D: extremely small splitting, large rotation\n    ]\n\n    phi1 = 0.0\n    results = []\n    for eps, phi2 in test_cases:\n        # Build stress tensors\n        A1 = stress_tensor(eps, phi1)\n        A2 = stress_tensor(eps, phi2)\n\n        # Eigendecompositions\n        w1, V1_full = eigh_sorted(A1)\n        w2, V2_full = eigh_sorted(A2)\n\n        # Select eigenvector associated with the smaller of the two near-1 eigenvalues\n        # Given ascending order, indices 0 and 1 are near 1-eps and 1+eps, respectively.\n        # Take index 0 (the smaller).\n        v1 = V1_full[:, 0]\n        v2 = V2_full[:, 0]\n\n        # Naive eigenvector angle\n        naive_angle_deg = angle_between_vectors_deg(v1, v2)\n\n        # Subspace bases for the two smallest eigenvalues\n        V1 = V1_full[:, :2]\n        V2 = V2_full[:, :2]\n\n        # Max principal angle between subspaces\n        subspace_angle_deg = max_principal_angle_between_subspaces_deg(V1, V2)\n\n        # Frobenius norm of difference\n        diff_norm = frobenius_norm(A2 - A1)\n\n        # Round to 6 decimals\n        naive_angle_deg = round(naive_angle_deg, 6)\n        subspace_angle_deg = round(subspace_angle_deg, 6)\n        diff_norm = round(diff_norm, 6)\n\n        results.append([naive_angle_deg, subspace_angle_deg, diff_norm])\n\n    # Print single-line JSON-like list as specified\n    print(json.dumps(results, separators=(',', ':')))\n\nif __name__ == \"__main__\":\n    solve()\n```"}]}