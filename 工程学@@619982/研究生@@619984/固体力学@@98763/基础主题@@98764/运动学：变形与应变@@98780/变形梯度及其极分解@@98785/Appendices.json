{"hands_on_practices": [{"introduction": "第一个练习旨在巩固您对极分解基本计算步骤的理解。通过一个具体的例子，您将练习标准的计算流程：首先计算右柯西-格林张量 $\\mathbf{C} = \\mathbf{F}^T \\mathbf{F}$，然后通过计算 $\\mathbf{C}$ 的平方根来确定右拉伸张量 $\\mathbf{U}$，最后分离出旋转张量 $\\mathbf{R}$。这个练习将帮助您熟练掌握计算过程，并对其中涉及的张量建立起直观的认识。[@problem_id:1506255]", "problem": "在连续介质力学中，物体的变形由一个变形梯度张量来描述，记为 $F$。该张量将无穷小矢量从未变形（参考）构型映射到变形后（当前）构型。根据极分解定理，任何可逆的变形梯度张量 $F$ 都可以唯一地分解为一个旋转张量 $R$ 和一个对称正定的右拉伸张量 $U$ 的乘积，即 $F = RU$。张量 $R$ 是一个纯正交张量（即 $R^T R = I$ 且 $\\det(R)=1$），代表材料元的刚体旋转，而 $U$ 描述了该单元的拉伸和剪切。\n\n考虑一个质点经历了一个由以下变形梯度张量 $F$ 描述的变形：\n$$\nF = \\begin{pmatrix} \\frac{1}{2} & -\\frac{3}{2} & 0 \\\\ \\frac{3}{2} & -\\frac{1}{2} & 0 \\\\ 0 & 0 & 3 \\end{pmatrix}\n$$\n你的任务是确定与此变形相关的旋转张量 $R$。", "solution": "我们使用右极分解 $F = R U$，其中 $R$ 是纯正交张量，$U$ 是右拉伸张量。右拉伸张量由 $U = (F^{T}F)^{1/2}$ 给出，而旋转张量则为 $R = F U^{-1}$。接下来我们计算 $U$ 和 $U^{-1}$，然后计算 $R$。\n\n已知\n$$\nF = \\begin{pmatrix} \\frac{1}{2} & -\\frac{3}{2} & 0 \\\\ \\frac{3}{2} & -\\frac{1}{2} & 0 \\\\ 0 & 0 & 3 \\end{pmatrix},\n$$\n我们首先计算\n$$\nF^{T}F = \\begin{pmatrix} \\frac{1}{2} & \\frac{3}{2} & 0 \\\\ -\\frac{3}{2} & -\\frac{1}{2} & 0 \\\\ 0 & 0 & 3 \\end{pmatrix}\n\\begin{pmatrix} \\frac{1}{2} & -\\frac{3}{2} & 0 \\\\ \\frac{3}{2} & -\\frac{1}{2} & 0 \\\\ 0 & 0 & 3 \\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{5}{2} & -\\frac{3}{2} & 0 \\\\\n-\\frac{3}{2} & \\frac{5}{2} & 0 \\\\\n0 & 0 & 9\n\\end{pmatrix}.\n$$\n这是一个块对角矩阵，由一个 $2 \\times 2$ 的对称块\n$$\nS = \\begin{pmatrix} \\frac{5}{2} & -\\frac{3}{2} \\\\ -\\frac{3}{2} & \\frac{5}{2} \\end{pmatrix}\n$$\n和第三个方向上的标量 $9$ 组成。$S$ 的特征值为 $1$ 和 $4$，对应的标准正交特征向量为 $v_{1} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $v_{2} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。因此，\n$$\nU = (F^{T}F)^{1/2} = \\operatorname{diag}\\!\\big(S^{1/2},\\,3\\big), \\quad S^{1/2} = 1\\,v_{1}v_{1}^{T} + 2\\,v_{2}v_{2}^{T}.\n$$\n显式地计算 $S^{1/2}$：\n$$\nv_{1}v_{1}^{T} = \\frac{1}{2}\\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}, \\quad\nv_{2}v_{2}^{T} = \\frac{1}{2}\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix},\n$$\n因此\n$$\nS^{1/2} = \\frac{1}{2}\\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix} + \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n= \\begin{pmatrix} \\frac{3}{2} & -\\frac{1}{2} \\\\ -\\frac{1}{2} & \\frac{3}{2} \\end{pmatrix}.\n$$\n于是\n$$\nU = \\begin{pmatrix}\n\\frac{3}{2} & -\\frac{1}{2} & 0 \\\\\n-\\frac{1}{2} & \\frac{3}{2} & 0 \\\\\n0 & 0 & 3\n\\end{pmatrix}.\n$$\n接下来，分块计算 $U^{-1}$。对于 $2 \\times 2$ 块 $U_{2} = \\begin{pmatrix} \\frac{3}{2} & -\\frac{1}{2} \\\\ -\\frac{1}{2} & \\frac{3}{2} \\end{pmatrix}$，其行列式为\n$$\n\\det(U_{2}) = \\left(\\frac{3}{2}\\right)^{2} - \\left(-\\frac{1}{2}\\right)^{2} = \\frac{9}{4} - \\frac{1}{4} = 2,\n$$\n所以\n$$\nU_{2}^{-1} = \\frac{1}{2}\\begin{pmatrix} \\frac{3}{2} & \\frac{1}{2} \\\\ \\frac{1}{2} & \\frac{3}{2} \\end{pmatrix}\n= \\begin{pmatrix} \\frac{3}{4} & \\frac{1}{4} \\\\ \\frac{1}{4} & \\frac{3}{4} \\end{pmatrix}.\n$$\n此外，第三个分量的逆是 $\\frac{1}{3}$。因此，\n$$\nU^{-1} = \\begin{pmatrix}\n\\frac{3}{4} & \\frac{1}{4} & 0 \\\\\n\\frac{1}{4} & \\frac{3}{4} & 0 \\\\\n0 & 0 & \\frac{1}{3}\n\\end{pmatrix}.\n$$\n最后，计算旋转张量\n$$\nR = F U^{-1} =\n\\begin{pmatrix} \\frac{1}{2} & -\\frac{3}{2} & 0 \\\\ \\frac{3}{2} & -\\frac{1}{2} & 0 \\\\ 0 & 0 & 3 \\end{pmatrix}\n\\begin{pmatrix}\n\\frac{3}{4} & \\frac{1}{4} & 0 \\\\\n\\frac{1}{4} & \\frac{3}{4} & 0 \\\\\n0 & 0 & \\frac{1}{3}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 & -1 & 0 \\\\\n1 & 0 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}.\n$$\n我们可以验证 $R^{T}R = I$ 且 $\\det(R) = 1$，这确认了它是一个纯正交张量。因此，这就是与给定变形相关的旋转张量。", "answer": "$$\\boxed{\\begin{pmatrix} 0 & -1 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}}$$", "id": "1506255"}, {"introduction": "在掌握了基本计算之后，本练习将重点从纯粹的数学运算转移到物理内涵的解读上。我们将分析一个平面应变问题，其数学计算相对简化，使您能更专注于理解拉伸张量 $U$ 和旋转张量 $R$ 的各个分量究竟代表什么。这个实践将引导您把抽象的张量分量与主拉伸、主方向和刚体旋转等具体的物理概念联系起来。[@problem_id:2695231]", "problem": "一个二维物体经历均匀平面应变，其变形由一个从参考坐标 $\\mathbf{X} = (X_{1}, X_{2})$ 到当前坐标 $\\mathbf{x} = (x_{1}, x_{2})$ 的线性映射描述，该映射通过变形梯度 $\\mathbf{F}$ 实现。平面内变形梯度（平面应变简化）由下式给出\n$$\n\\mathbf{F} \\;=\\; \\begin{pmatrix}\n\\frac{3}{2} & -\\sqrt{3} \\\\\n\\frac{3\\sqrt{3}}{2} & 1\n\\end{pmatrix}.\n$$\n仅使用连续介质运动学的基本定义，确定 $\\mathbf{F}$ 在平面内的唯一右极分解，即满足 $\\mathbf{F} = \\mathbf{R}\\,\\mathbf{U}$ 的纯正交旋转张量 $\\mathbf{R}$ 和对称正定右拉伸张量 $\\mathbf{U}$。然后，解释平面内各分量的物理意义，包括主拉伸、其方向、刚体旋转和面积变化。\n\n答案格式要求：\n- 将 $\\mathbf{R}$ 和 $\\mathbf{U}$ 的八个分量按 $(R_{11}, R_{12}, R_{21}, R_{22}, U_{11}, U_{12}, U_{21}, U_{22})$ 的顺序连接成一个单行矩阵作为最终答案。\n- 使用精确值；请勿近似或四舍五入。", "solution": "变形梯度 $\\mathbf{F}$ 的右极分解由 $\\mathbf{F} = \\mathbf{R}\\,\\mathbf{U}$ 给出，其中 $\\mathbf{U}$ 是右拉伸张量，$\\mathbf{R}$ 是旋转张量。\n\n首先，我们确定右拉伸张量 $\\mathbf{U}$。它被定义为右柯西-格林变形张量 $\\mathbf{C}$ 的唯一正定平方根，其中 $\\mathbf{C} = \\mathbf{F}^T \\mathbf{F}$。我们计算 $\\mathbf{C}$：\n$$\n\\mathbf{F}^T = \\begin{pmatrix} \\frac{3}{2} & \\frac{3\\sqrt{3}}{2} \\\\ -\\sqrt{3} & 1 \\end{pmatrix}\n$$\n$$\n\\mathbf{C} = \\mathbf{F}^T \\mathbf{F} = \\begin{pmatrix} \\frac{3}{2} & \\frac{3\\sqrt{3}}{2} \\\\ -\\sqrt{3} & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{3}{2} & -\\sqrt{3} \\\\ \\frac{3\\sqrt{3}}{2} & 1 \\end{pmatrix}\n$$\n$\\mathbf{C}$ 的分量是：\n$$\nC_{11} = \\left(\\frac{3}{2}\\right)^2 + \\left(\\frac{3\\sqrt{3}}{2}\\right)^2 = \\frac{9}{4} + \\frac{27}{4} = \\frac{36}{4} = 9\n$$\n$$\nC_{12} = \\left(\\frac{3}{2}\\right)(-\\sqrt{3}) + \\left(\\frac{3\\sqrt{3}}{2}\\right)(1) = -\\frac{3\\sqrt{3}}{2} + \\frac{3\\sqrt{3}}{2} = 0\n$$\n$$\nC_{21} = (-\\sqrt{3})\\left(\\frac{3}{2}\\right) + (1)\\left(\\frac{3\\sqrt{3}}{2}\\right) = -\\frac{3\\sqrt{3}}{2} + \\frac{3\\sqrt{3}}{2} = 0\n$$\n$$\nC_{22} = (-\\sqrt{3})^2 + (1)^2 = 3 + 1 = 4\n$$\n因此，右柯西-格林变形张量是：\n$$\n\\mathbf{C} = \\begin{pmatrix} 9 & 0 \\\\ 0 & 4 \\end{pmatrix}\n$$\n右拉伸张量 $\\mathbf{U}$ 是 $\\sqrt{\\mathbf{C}}$。由于 $\\mathbf{C}$ 是一个对角元素为正的对角矩阵，其平方根可以通过对角元素取平方根得到：\n$$\n\\mathbf{U} = \\begin{pmatrix} \\sqrt{9} & 0 \\\\ 0 & \\sqrt{4} \\end{pmatrix} = \\begin{pmatrix} 3 & 0 \\\\ 0 & 2 \\end{pmatrix}\n$$\n这个张量 $\\mathbf{U}$ 是对称的，且其特征值（$3$ 和 $2$）为正，因此按要求是正定的。\n\n接下来，我们使用关系式 $\\mathbf{R} = \\mathbf{F}\\,\\mathbf{U}^{-1}$ 来确定旋转张量 $\\mathbf{R}$。我们首先求 $\\mathbf{U}$ 的逆矩阵：\n$$\n\\mathbf{U}^{-1} = \\begin{pmatrix} 3 & 0 \\\\ 0 & 2 \\end{pmatrix}^{-1} = \\begin{pmatrix} \\frac{1}{3} & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix}\n$$\n现在，我们计算 $\\mathbf{R}$：\n$$\n\\mathbf{R} = \\mathbf{F}\\,\\mathbf{U}^{-1} = \\begin{pmatrix} \\frac{3}{2} & -\\sqrt{3} \\\\ \\frac{3\\sqrt{3}}{2} & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{3} & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix}\n$$\n$\\mathbf{R}$ 的分量是：\n$$\nR_{11} = \\left(\\frac{3}{2}\\right)\\left(\\frac{1}{3}\\right) + (-\\sqrt{3})(0) = \\frac{1}{2}\n$$\n$$\nR_{12} = \\left(\\frac{3}{2}\\right)(0) + (-\\sqrt{3})\\left(\\frac{1}{2}\\right) = -\\frac{\\sqrt{3}}{2}\n$$\n$$\nR_{21} = \\left(\\frac{3\\sqrt{3}}{2}\\right)\\left(\\frac{1}{3}\\right) + (1)(0) = \\frac{\\sqrt{3}}{2}\n$$\n$$\nR_{22} = \\left(\\frac{3\\sqrt{3}}{2}\\right)(0) + (1)\\left(\\frac{1}{2}\\right) = \\frac{1}{2}\n$$\n因此，旋转张量是：\n$$\n\\mathbf{R} = \\begin{pmatrix} \\frac{1}{2} & -\\frac{\\sqrt{3}}{2} \\\\ \\frac{\\sqrt{3}}{2} & \\frac{1}{2} \\end{pmatrix}\n$$\n我们验证 $\\det(\\mathbf{R}) = (\\frac{1}{2})(\\frac{1}{2}) - (-\\frac{\\sqrt{3}}{2})(\\frac{\\sqrt{3}}{2}) = \\frac{1}{4} + \\frac{3}{4} = 1$，这证实了它是一个纯正交旋转矩阵。\n\n**物理解释：**\n极分解 $\\mathbf{F} = \\mathbf{R}\\,\\mathbf{U}$ 表示总变形可以概念上分解为两个连续的操作：首先，对参考构型施加一个由 $\\mathbf{U}$ 描述的纯拉伸，然后，进行一个由 $\\mathbf{R}$ 描述的刚体旋转。\n\n1.  **右拉伸张量 $\\mathbf{U}$**：\n    张量 $\\mathbf{U} = \\begin{pmatrix} 3 & 0 \\\\ 0 & 2 \\end{pmatrix}$ 代表了材料的纯变形。其特征值是**主拉伸**，$\\lambda_1 = 3$ 和 $\\lambda_2 = 2$。对应的特征向量是参考坐标系中的**主方向**，分别为 $\\mathbf{N}_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $\\mathbf{N}_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。这意味着最初沿 $X_1$ 轴排列的材料纤维被拉伸了 $3$ 倍，而沿 $X_2$ 轴排列的纤维被拉伸了 $2$ 倍。由于 $\\mathbf{U}$ 是对角矩阵，所以在参考坐标系中没有剪切变形。\n\n2.  **旋转张量 $\\mathbf{R}$**：\n    张量 $\\mathbf{R} = \\begin{pmatrix} \\frac{1}{2} & -\\frac{\\sqrt{3}}{2} \\\\ \\frac{\\sqrt{3}}{2} & \\frac{1}{2} \\end{pmatrix}$ 代表一个纯刚体旋转。其形式为 $\\begin{pmatrix} \\cos\\theta & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta \\end{pmatrix}$，其中 $\\cos\\theta = \\frac{1}{2}$ 且 $\\sin\\theta = \\frac{\\sqrt{3}}{2}$。这对应于一个 $\\theta = \\frac{\\pi}{3}$ 弧度（或 $60^\\circ$）的逆时针旋转角。在被拉伸之后，整个物体被刚性地逆时针旋转 $60^\\circ$。\n\n3.  **面积变化**：\n    面积的变化由变形的雅可比行列式 $J = \\det(\\mathbf{F})$ 描述。如前计算， $J = 6$。这表示参考构型中的一个无穷小面积元，其面积增加了 $6$ 倍。这个变化完全归因于拉伸，因为 $J = \\det(\\mathbf{R})\\det(\\mathbf{U}) = (1)(\\lambda_1 \\lambda_2) = (1)(3 \\times 2) = 6$。旋转作为一种刚体运动，不改变面积。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2} & -\\frac{\\sqrt{3}}{2} & \\frac{\\sqrt{3}}{2} & \\frac{1}{2} & 3 & 0 & 0 & 2 \\end{pmatrix}}$$", "id": "2695231"}, {"introduction": "最后的这项实践旨在连接解析理论与现代计算实践。在真实的工程软件和科学模拟中，极分解通常是通过数值方法完成的，其中最常用的是稳健的奇异值分解（SVD）算法。这个练习将要求您亲手实现这一算法，这不仅是计算力学领域的一项关键技能，也能加深您对连续介质力学与数值线性代数之间联系的理解。[@problem_id:2695233]", "problem": "考虑一个运动映射，它将一个物质点从其参考位置变换到其当前位置。变形梯度 $F$ 定义为该映射相对于参考构形的​​空间梯度。对于任意可逆的 $3\\times 3$ 张量 $F$，极分解定理表明，存在一个正交张量 $R$ 和一个对称正定张量 $U$，使得 $F = R\\,U$（右极分解）。您的任务是实现一个程序，对于每个给定的数值 $3\\times 3$ 矩阵 $F$，计算其右极分解，并在规定的容差范围内验证 $R$ 是正交的，$U$ 是对称正定的。该程序必须使用基于基本定义推导出的、有原则的、分步的算法来计算这些因子，并且必须报告用于评估这些性质的量化残差。\n\n推导和算法设计必须使用的基本原理：\n- 变形梯度 $F$ 是与运动相关的切空间之间的可逆线性映射。\n- 右 Cauchy–Green 变形张量 $C$ 定义为 $C = F^{\\mathsf T} F$。\n- 实对称矩阵的谱定理确保 $C$ 允许具有非负特征值的标准正交特征空间分解。\n- 实矩阵 $F$ 的奇异值分解（singular value decomposition (SVD)）写作 $F = W\\,\\Sigma\\,V^{\\mathsf T}$，其中 $W$ 和 $V$ 是正交矩阵，$\\Sigma$ 是具有非负元素的对角矩阵。\n\n您的程序必须：\n- 仅使用上述基本事实，从 $F$ 开始实现右极因子 $R$ 和 $U$ 的计算。不要使用任何现成的极分解程序。\n- 通过计算 Frobenius 范数残差 $\\lVert R^{\\mathsf T}R - I\\rVert_{\\mathrm F}$ 来验证正交性，其中 $I$ 是单位矩阵。\n- 通过计算 $\\lVert U - U^{\\mathsf T}\\rVert_{\\mathrm F}$ 来验证对称性。\n- 通过计算 $U$ 的最小特征值并检查其是否严格为正来验证正定性。\n- 同时报告 $\\det(R)$ 以确认在保向情况下的正常正交性。\n\n在验证中使用以下容差值：\n- 用于正交性和对称性检查的残差容差 $\\tau = 10^{-9}$。\n- 用于正定性检查的特征值正性容差 $\\epsilon = 10^{-12}$。\n\n测试套件：\n为以下五个 $3\\times 3$ 矩阵 $F$ 提供结果。\n- 情况 1（一般旋转和拉伸）：令 $\\theta = \\pi/6$（弧度）。定义绕 $z$ 轴的旋转\n$$\nR_z(\\theta) =\n\\begin{bmatrix}\n\\cos\\theta & -\\sin\\theta & 0\\\\\n\\sin\\theta & \\ \\cos\\theta & 0\\\\\n0 & 0 & 1\n\\end{bmatrix},\n$$\n和拉伸\n$$\nU_1 = \\operatorname{diag}(2,\\ 1.5,\\ 0.5).\n$$\n设置 $F_1 = R_z(\\theta)\\,U_1$。\n- 情况 2（纯旋转）：令单位轴为 $a = \\frac{1}{\\sqrt{3}}[1,\\ 1,\\ 1]^{\\mathsf T}$，角度为 $\\phi = 0.7$（弧度）。将 $F_2$ 定义为通过 Rodrigues' 公式绕轴 $a$ 旋转角度 $\\phi$ 得到的旋转矩阵。\n- 情况 3（对称正定）：定义\n$$\nF_3 =\n\\begin{bmatrix}\n3.0 & 0.2 & 0.1\\\\\n0.2 & 2.0 & 0.3\\\\\n0.1 & 0.3 & 1.5\n\\end{bmatrix}.\n$$\n- 情况 4（病态但可逆）：令 $U_4 = \\operatorname{diag}(10^{-6},\\ 1.0,\\ 3.0)$，$R_x(\\alpha)$ 为绕 $x$ 轴旋转角度 $\\alpha = 0.9$（弧度）的旋转矩阵，\n$$\nR_x(\\alpha) =\n\\begin{bmatrix}\n1 & 0 & 0\\\\\n0 & \\cos\\alpha & -\\sin\\alpha\\\\\n0 & \\sin\\alpha & \\cos\\alpha\n\\end{bmatrix}.\n$$\n设置 $F_4 = R_x(\\alpha)\\,U_4$。\n- 情况 5（单位矩阵）：$F_5 = I$。\n\n对于每种情况 $i\\in\\{1,2,3,4,5\\}$，您的程序必须计算右极因子 $R_i$ 和 $U_i$，然后按给定顺序生成以下每种情况的结果：\n- $r_i$：$\\lVert R_i^{\\mathsf T}R_i - I\\rVert_{\\mathrm F}$ 的浮点值，\n- $s_i$：$\\lVert U_i - U_i^{\\mathsf T}\\rVert_{\\mathrm F}$ 的浮点值，\n- $m_i$：$U_i$ 的最小特征值的浮点值，\n- $d_i$：$\\det(R_i)$ 的浮点值，\n- $b_i$：一个布尔值，如果 $r_i \\le \\tau$、$s_i \\le \\tau$、$m_i > \\epsilon$ 且 $\\lvert d_i - 1\\rvert \\le \\tau$，则为 true，否则为 false。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含每种情况的结果列表，而每种情况的结果本身是按此顺序排列的五个量 $[r_i,s_i,m_i,d_i,b_i]$ 的列表。例如，输出必须如下所示\n$[[r_1,s_1,m_1,d_1,b_1],[r_2,s_2,m_2,d_2,b_2],\\dots,[r_5,s_5,m_5,d_5,b_5]]$，\n无空格。\n- 构造中的所有角度均以弧度为单位。此问题不涉及物理单位。", "solution": "任务是计算给定可逆 $3 \\times 3$ 矩阵 $F$ 的右极分解，该分解将 $F$ 表示为乘积 $F = RU$。在此分解中，$R$ 是一个正交张量（$R^{\\mathsf T}R = I$），$U$ 是一个对称正定张量（$U = U^{\\mathsf T}$ 且其特征值严格为正）。算法必须从所提供的基本原理推导得出，即右 Cauchy–Green 张量 $C$ 的定义、谱定理和奇异值分解（SVD）。\n\n我们将使用奇异值分解（SVD）来构建算法，因为它为求解因子 $R$ 和 $U$ 提供了一条直接且数值稳定的路径。一个实 $3 \\times 3$ 矩阵 $F$ 的 SVD 分解由下式给出：\n$$\nF = W \\Sigma V^{\\mathsf T}\n$$\n其中 $W$ 和 $V$ 是 $3 \\times 3$ 的正交矩阵，$\\Sigma$ 是一个包含 $F$ 的奇异值 $\\sigma_i$ 的 $3 \\times 3$ 对角矩阵，这些奇异值是非负的。由于题目声明 $F$ 是可逆的，所以 $\\det(F) \\neq 0$，这意味着所有奇异值都严格为正，即 $\\sigma_i > 0$。\n\n我们寻求确定 $R$ 和 $U$ 以满足 $F = RU$。基于 SVD 的分量，我们可以将 $R$ 和 $U$ 定义为：\n$$\nU = V \\Sigma V^{\\mathsf T}\n$$\n$$\nR = W V^{\\mathsf T}\n$$\n我们必须验证 $R$ 和 $U$ 的这些表达式是否满足所要求的性质。\n\n首先，我们检查乘积 $RU$ 是否能重构出 $F$：\n$$\nRU = (W V^{\\mathsf T})(V \\Sigma V^{\\mathsf T}) = W (V^{\\mathsf T}V) \\Sigma V^{\\mathsf T}\n$$\n由于 $V$ 是正交矩阵，因此 $V^{\\mathsf T}V = I$。表达式简化为：\n$$\nRU = W I \\Sigma V^{\\mathsf T} = W \\Sigma V^{\\mathsf T} = F\n$$\n该分解是正确的。\n\n接下来，我们验证 $U$ 的性质。\n对称性：$U^{\\mathsf T} = (V \\Sigma V^{\\mathsf T})^{\\mathsf T} = (V^{\\mathsf T})^{\\mathsf T} \\Sigma^{\\mathsf T} V^{\\mathsf T} = V \\Sigma V^{\\mathsf T} = U$。该性质成立，因为 $\\Sigma$ 是对角矩阵，因而是对称的。\n正定性：$U = V \\Sigma V^{\\mathsf T}$ 是 $U$ 的特征分解。$U$ 的特征值是 $\\Sigma$ 的对角元素（即 $F$ 的奇异值 $\\sigma_i$）。对于可逆矩阵 $F$，所有 $\\sigma_i > 0$。因此，$U$ 是正定的。\n\n最后，我们验证 $R$ 的性质。\n正交性：$R^{\\mathsf T}R = (W V^{\\mathsf T})^{\\mathsf T} (W V^{\\mathsf T}) = V W^{\\mathsf T} W V^{\\mathsf T} = V I V^{\\mathsf T} = V V^{\\mathsf T} = I$。该性质成立。\n\n算法流程如下：\n1. 对于给定的矩阵 $F_i$，计算其 SVD 以获得 $W_i$、奇异值 $\\sigma_i$ 和 $V_i^{\\mathsf T}$。\n2. 构建右拉伸张量 $U_i = V_i \\Sigma_i V_i^{\\mathsf T}$，其中 $\\Sigma_i$ 是由 $\\sigma_i$ 构成的对角矩阵，$V_i=(V_i^{\\mathsf T})^{\\mathsf T}$。\n3. 构建旋转张量 $R_i = W_i V_i^{\\mathsf T}$。\n4. 对于保向变形（$\\det(F_i) > 0$），标准的 SVD 算法通常确保 $\\det(R_i)=+1$。所有测试用例均为保向变形。\n5. 执行所需的验证检查：\n    a. 正交性残差：$r_i = \\lVert R_i^{\\mathsf T}R_i - I\\rVert_{\\mathrm F}$。\n    b. 对称性残差：$s_i = \\lVert U_i - U_i^{\\mathsf T}\\rVert_{\\mathrm F}$。\n    c. 正定性：计算 $U_i$ 的最小特征值 $m_i$。\n    d. 行列式检查：$d_i = \\det(R_i)$。\n6. 基于给定的容差评估布尔条件 $b_i$。\n至此，我们完成了用于计算和验证右极分解的基于原理的算法的推导。实现将严格遵循此流程处理每个测试用例。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and verifies the right polar decomposition for a set of test cases.\n    \"\"\"\n    # Define tolerance values\n    tau = 1e-9\n    epsilon = 1e-12\n\n    # --- Test Case Generation ---\n\n    test_cases = []\n\n    # Case 1: General rotation and stretch\n    theta = np.pi / 6\n    Rz = np.array([\n        [np.cos(theta), -np.sin(theta), 0],\n        [np.sin(theta), np.cos(theta), 0],\n        [0, 0, 1]\n    ])\n    U1 = np.diag([2.0, 1.5, 0.5])\n    F1 = Rz @ U1\n    test_cases.append(F1)\n\n    # Case 2: Pure rotation via Rodrigues' formula\n    phi = 0.7\n    a = (1 / np.sqrt(3)) * np.array([1, 1, 1])\n    ax_cross = np.array([\n        [0, -a[2], a[1]],\n        [a[2], 0, -a[0]],\n        [-a[1], a[0], 0]\n    ])\n    I = np.identity(3)\n    a_outer_a = np.outer(a, a)\n    F2 = I + np.sin(phi) * ax_cross + (1 - np.cos(phi)) * (a_outer_a - I)\n    test_cases.append(F2)\n\n    # Case 3: Symmetric positive-definite matrix\n    F3 = np.array([\n        [3.0, 0.2, 0.1],\n        [0.2, 2.0, 0.3],\n        [0.1, 0.3, 1.5]\n    ])\n    test_cases.append(F3)\n\n    # Case 4: Ill-conditioned but invertible matrix\n    alpha = 0.9\n    Rx = np.array([\n        [1, 0, 0],\n        [0, np.cos(alpha), -np.sin(alpha)],\n        [0, np.sin(alpha), np.cos(alpha)]\n    ])\n    U4 = np.diag([1e-6, 1.0, 3.0])\n    F4 = Rx @ U4\n    test_cases.append(F4)\n\n    # Case 5: Identity matrix\n    F5 = np.identity(3)\n    test_cases.append(F5)\n\n    # --- Computation and Verification Loop ---\n\n    results = []\n    for F in test_cases:\n        # Step 1: Compute SVD: F = W * Sigma * V^T\n        # In numpy, svd returns W, s, Vh where s are singular values and Vh is V^T\n        W, s, Vh = np.linalg.svd(F)\n        \n        Sigma = np.diag(s)\n\n        # Step 2: Compute R = W * V^T\n        R = W @ Vh\n\n        # Step 3: Compute U = V * Sigma * V^T\n        U = Vh.T @ Sigma @ Vh\n\n        # Step 4: Perform verification\n        # a. Orthogonality residual\n        r = np.linalg.norm(R.T @ R - np.identity(3), 'fro')\n\n        # b. Symmetry residual\n        s_val = np.linalg.norm(U - U.T, 'fro')\n\n        # c. Minimum eigenvalue of U\n        # Since U is constructed to be symmetric, use eigvalsh for efficiency/stability\n        eigenvalues_U = np.linalg.eigvalsh(U)\n        m = np.min(eigenvalues_U)\n\n        # d. Determinant of R\n        d = np.linalg.det(R)\n\n        # Step 5: Evaluate boolean condition\n        # All test cases have det(F)>0, so we expect det(R) close to +1.\n        b = (r = tau) and (s_val = tau) and (m > epsilon) and (np.abs(d - 1) = tau)\n        \n        # Store results for this case\n        case_result = [r, s_val, m, d, b]\n        results.append(case_result)\n\n    # --- Final Output Formatting ---\n    output_str = \"[\" + \",\".join([f\"[{','.join(map(str, res))}]\" for res in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2695233"}]}