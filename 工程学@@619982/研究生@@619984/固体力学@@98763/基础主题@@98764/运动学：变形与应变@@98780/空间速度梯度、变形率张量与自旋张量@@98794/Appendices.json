{"hands_on_practices": [{"introduction": "本练习旨在检验您对运动学张量的基本理解。我们将分析一个纯刚体转动，这是一种没有变形、只有旋转的运动。通过从空间速度梯度（$L$）、变形率张量（$D$）和自旋张量（$W$）的基本定义出发，您将看到它们如何精确地捕捉运动的本质。这项实践将从根本上巩固变形与旋转之间的区别，并通过分析这些张量在参考坐标系变换下的行为，严格地论证观察者客观性这一关键概念 [@problem_id:2686161]。", "problem": "一个连续体绕原点进行空间均匀刚体转动，其速度场由 $v(x,t)=\\Omega(t)\\,x$ 给出，其中 $x\\in\\mathbb{R}^{3}$ 是空间位置，$t$ 是时间，$\\Omega(t)\\in\\mathbb{R}^{3\\times 3}$ 是一个光滑的、随时间变化的矩阵，且对所有 $t$ 满足 $\\Omega(t)=-\\Omega(t)^{T}$。完全在欧拉（空间）描述下进行分析。仅从运动学第一原理出发（即速度的定义 $v=\\dot{x}$、空间速度梯度 $L=\\nabla_{x}v$ 的定义，以及 $L$ 分解为其对称和反对称部分的运动学分解），完成以下任务：\n\n1. 计算给定运动的空间速度梯度 $L(x,t)$、变形率张量 $D(x,t)$ 和自旋张量 $W(x,t)$。您的推导必须从这些量关于 $v(x,t)$ 的定义出发，并且不得引入任何本构或材料假设。\n\n2. 考虑一个叠加的、随时间变化的观察者参考系的刚体转动，该转动由一个真正的正交张量 $Q(t)\\in\\mathrm{SO}(3)$ 描述，满足 $Q(t)Q(t)^{T}=I$ 和 $\\det Q(t)=1$。旋转后的参考系观察到相同的物理运动，但其空间坐标为 $\\bar{x}=Q(t)\\,x$。从 $\\bar{x}$ 和 $x$ 之间的基本关系出发，对一个固定的物质点使用链式法则和时间求导，推导变换后的速度场 $\\bar{v}(\\bar{x},t)$，并由此推导出变换后的张量 $\\bar{L}(\\bar{x},t)$、$\\bar{D}(\\bar{x},t)$ 和 $\\bar{W}(\\bar{x},t)$，结果用 $Q(t)$、$\\dot{Q}(t)$ 和未加横线的场表示。\n\n3. 将您的一般变换结果应用于给定的刚体转动运动 $v(x,t)=\\Omega(t)\\,x$，并给出 $\\bar{L}$、$\\bar{D}$ 和 $\\bar{W}$ 关于 $Q(t)$、$\\dot{Q}(t)$ 和 $\\Omega(t)$ 的显式表达式。特别地，验证对于此运动，变形率张量是参考系无关的，并指出在叠加转动下自旋张量中出现的附加项。\n\n将您的最终答案表示为一个单行矩阵，按顺序包含 $L$、$D$、$W$、$\\bar{L}$、$\\bar{D}$ 和 $\\bar{W}$，每一项都是用 $\\Omega(t)$、$Q(t)$ 和 $\\dot{Q}(t)$ 表示的闭式解析表达式。不需要进行数值取整，最终表达式中也无需包含单位。", "solution": "该问题陈述是连续介质运动学中的一个有效练习。它提法恰当，有科学依据，且客观。它要求从第一原理出发，推导运动学量及其在观察者参考系变换下的变换性质。我们将按要求分三部分进行求解。\n\n基本运动学量在欧拉（空间）描述中定义。当前位于位置 $x$ 的一个物质点的速度为 $v(x,t)$。空间速度梯度是张量 $L$，其分量为 $L_{ij} = \\frac{\\partial v_i}{\\partial x_j}$，记作 $L = \\nabla_x v$。该梯度可以分解为其对称和反对称部分：\n$$L = D + W$$\n其中变形率张量 $D$ 是对称的，\n$$D = \\frac{1}{2}(L + L^T)$$\n自旋张量 $W$ 是反对称的，\n$$W = \\frac{1}{2}(L - L^T)$$\n\n**第一部分：刚体转动的运动学张量**\n\n问题提供了一个表示绕原点空间均匀刚体转动的速度场：\n$$v(x,t) = \\Omega(t) x$$\n其中 $x \\in \\mathbb{R}^3$ 是空间位置矢量，$\\Omega(t)$ 是一个随时间变化的反对称矩阵，即 $\\Omega(t) = -\\Omega(t)^T$。\n\n首先，我们计算空间速度梯度 $L(x,t)$。在笛卡尔坐标系中使用指标记法，速度矢量的分量为 $v_i = \\sum_k \\Omega_{ik} x_k$。速度梯度张量 $L$ 的分量为：\n$$L_{ij} = \\frac{\\partial v_i}{\\partial x_j} = \\frac{\\partial}{\\partial x_j} \\left( \\sum_k \\Omega_{ik} x_k \\right)$$\n由于 $\\Omega(t)$ 的分量不依赖于空间位置 $x$，我们有：\n$$L_{ij} = \\sum_k \\Omega_{ik} \\frac{\\partial x_k}{\\partial x_j} = \\sum_k \\Omega_{ik} \\delta_{kj} = \\Omega_{ij}$$\n其中 $\\delta_{kj}$ 是克罗内克符号 (Kronecker delta)。因此，空间速度梯度就是矩阵 $\\Omega(t)$：\n$$L(t) = \\Omega(t)$$\n\n接下来，我们计算变形率张量 $D(x,t)$。根据其定义：\n$$D = \\frac{1}{2}(L + L^T)$$\n代入 $L = \\Omega(t)$ 并利用给定的 $\\Omega(t)$ 是反对称的性质，即 $\\Omega(t)^T = -\\Omega(t)$：\n$$D(t) = \\frac{1}{2}(\\Omega(t) + \\Omega(t)^T) = \\frac{1}{2}(\\Omega(t) - \\Omega(t)) = 0$$\n变形率张量是零张量。这是一个预期的结果，因为根据定义，刚体运动不涉及物质点之间距离的改变，因此没有变形。\n\n最后，我们计算自旋张量 $W(x,t)$。根据其定义：\n$$W = \\frac{1}{2}(L - L^T)$$\n代入 $L = \\Omega(t)$ 和 $\\Omega(t)^T = -\\Omega(t)$：\n$$W(t) = \\frac{1}{2}(\\Omega(t) - \\Omega(t)^T) = \\frac{1}{2}(\\Omega(t) - (-\\Omega(t))) = \\frac{1}{2}(2\\Omega(t)) = \\Omega(t)$$\n对于这种纯刚体转动，自旋张量与速度梯度和角速度张量 $\\Omega(t)$ 相同。\n\n**第二部分：一般观察者参考系变换**\n\n我们考虑一个由随时间变化的真正交张量 $Q(t) \\in \\mathrm{SO}(3)$ 描述的观察者参考系变换，该张量满足 $Q(t)Q(t)^T = I$ 和 $\\det Q(t) = 1$。新（带横线）参考系中的空间坐标与原始（不带横线）参考系中的空间坐标通过以下关系关联：\n$$\\bar{x} = Q(t) x$$\n为了找到速度之间的关系，我们考虑一个固定的物质点，其在原始参考系中的位置是 $x(t)$，在新参考系中的位置是 $\\bar{x}(t)$。我们对坐标变换关于时间求导，并应用乘法法则：\n$$\\frac{d\\bar{x}}{dt} = \\frac{d}{dt}(Q(t)x(t)) = \\dot{Q}(t)x(t) + Q(t)\\frac{dx}{dt}$$\n速度定义为 $\\bar{v} = \\frac{d\\bar{x}}{dt}$ 和 $v = \\frac{dx}{dt}$。因此，我们有以下关系：\n$$\\bar{v} = \\dot{Q}x + Qv$$\n为了将变换后的速度场 $\\bar{v}(\\bar{x},t)$ 表示为新坐标 $\\bar{x}$ 的函数，我们使用逆坐标变换 $x = Q(t)^T \\bar{x}$。将此式以及 $v = v(x,t) = v(Q^T\\bar{x}, t)$ 代入速度关系式，得到：\n$$\\bar{v}(\\bar{x},t) = \\dot{Q}(t)Q(t)^T\\bar{x} + Q(t)v(Q(t)^T\\bar{x}, t)$$\n这是变换后的速度场的一般表达式。\n\n现在，我们推导变换后的空间速度梯度 $\\bar{L} = \\nabla_{\\bar{x}}\\bar{v}$。我们将关于 $\\bar{x}$ 的梯度算子应用于 $\\bar{v}(\\bar{x},t)$ 的表达式。第一项对 $\\bar{x}$ 是线性的：\n$$\\nabla_{\\bar{x}}(\\dot{Q}Q^T\\bar{x}) = \\dot{Q}Q^T$$\n对于第二项，我们使用链式法则。对于一个张量函数 $F(x)$，其关于 $\\bar{x}$ 的梯度为 $\\nabla_{\\bar{x}} F(x) = (\\nabla_x F) \\frac{\\partial x}{\\partial \\bar{x}}$。由于 $x = Q^T\\bar{x}$，我们有 $\\frac{\\partial x}{\\partial \\bar{x}} = Q^T$。\n$$\\nabla_{\\bar{x}}(Qv(Q^T\\bar{x},t)) = Q \\left[ \\nabla_x v(x,t) \\right]_{x=Q^T\\bar{x}} \\frac{\\partial x}{\\partial \\bar{x}} = Q L Q^T$$\n结合这两个部分，得到速度梯度的变换法则：\n$$\\bar{L} = \\dot{Q}Q^T + QLQ^T$$\n为了推导 $\\bar{D}$ 和 $\\bar{W}$ 的变换，我们需要 $\\bar{L}^T$。首先，我们注意到由 $Q(t)Q(t)^T=I$ 对时间求导可得 $\\dot{Q}Q^T + Q\\dot{Q}^T = 0$。这意味着 $(\\dot{Q}Q^T)^T = Q\\dot{Q}^T = -\\dot{Q}Q^T$，所以张量 $\\dot{Q}Q^T$ 是反对称的。\n$$\\bar{L}^T = (\\dot{Q}Q^T)^T + (QLQ^T)^T = -\\dot{Q}Q^T + QL^T Q^T$$\n变换后的变形率张量为：\n$$\\bar{D} = \\frac{1}{2}(\\bar{L} + \\bar{L}^T) = \\frac{1}{2}\\left[ (\\dot{Q}Q^T + QLQ^T) + (-\\dot{Q}Q^T + QL^TQ^T) \\right] = \\frac{1}{2}Q(L+L^T)Q^T = QDQ^T$$\n这表明 $D$ 作为一个客观二阶张量进行变换。变换后的自旋张量为：\n$$\\bar{W} = \\frac{1}{2}(\\bar{L} - \\bar{L}^T) = \\frac{1}{2}\\left[ (\\dot{Q}Q^T + QLQ^T) - (-\\dot{Q}Q^T + QL^TQ^T) \\right] = \\dot{Q}Q^T + \\frac{1}{2}Q(L-L^T)Q^T = \\dot{Q}Q^T + QWQ^T$$\n自旋张量 $W$ 不是客观的；其变换法则包含项 $\\dot{Q}Q^T$，这是新观察者参考系相对于旧参考系的自旋。\n\n**第三部分：特例化与验证**\n\n我们现在将这些一般变换规则应用于给定的刚体转动，对于该情况我们已求得 $L=\\Omega(t)$、$D=0$ 和 $W=\\Omega(t)$。\n\n变换后的空间速度梯度是：\n$$\\bar{L}(\\bar{x},t) = \\dot{Q}(t)Q(t)^T + Q(t)L(t)Q(t)^T = \\dot{Q}(t)Q(t)^T + Q(t)\\Omega(t)Q(t)^T$$\n变换后的变形率张量是：\n$$\\bar{D}(\\bar{x},t) = Q(t)D(t)Q(t)^T = Q(t)(0)Q(t)^T = 0$$\n变换后的自旋张量是：\n$$\\bar{W}(\\bar{x},t) = \\dot{Q}(t)Q(t)^T + Q(t)W(t)Q(t)^T = \\dot{Q}(t)Q(t)^T + Q(t)\\Omega(t)Q(t)^T$$\n对于这个特定的运动，我们观察到由于 $\\bar{D}=0$，有 $\\bar{L} = \\bar{W}$。\n\n为了验证此运动下变形率张量的参考系无关性，我们观察到在原始参考系中 $D=0$，在旋转参考系中 $\\bar{D}=0$。由于 $\\bar{D} = Q D Q^T$ 成立（$0 = Q(0)Q^T$），变形率张量确实是客观的，或称参考系无关的。零张量在此变换下仍然是零张量。\n\n自旋张量的变换为 $\\bar{W} = \\dot{Q}Q^T + QWQ^T$。与客观张量变换相比，在叠加转动下自旋张量中出现的附加项是 $\\dot{Q}Q^T$。这一项代表了带横线参考系相对于不带横线参考系的角速度。在新参考系中观察到的总自旋 $\\bar{W}$ 是物体相对于原始参考系的自旋（映射到新参考系中为 $QWQ^T$）与新参考系自身自旋的和。\n\n因此，所要求的六个张量的最终表达式为：\n$L(t) = \\Omega(t)$\n$D(t) = 0$\n$W(t) = \\Omega(t)$\n$\\bar{L}(t) = \\dot{Q}(t)Q(t)^T + Q(t)\\Omega(t)Q(t)^T$\n$\\bar{D}(t) = 0$\n$\\bar{W}(t) = \\dot{Q}(t)Q(t)^T + Q(t)\\Omega(t)Q(t)^T$", "answer": "$$\\boxed{\\begin{pmatrix} \\Omega(t)  0  \\Omega(t)  \\dot{Q}(t)Q(t)^T + Q(t)\\Omega(t)Q(t)^T  0  \\dot{Q}(t)Q(t)^T + Q(t)\\Omega(t)Q(t)^T \\end{pmatrix}}$$", "id": "2686161"}, {"introduction": "理论推导固然重要，但对于机械工程师或科学家而言，从实验数据中提取模型参数是一项关键技能。本练习模拟了这样一个场景，即我们拥有离散的速度测量数据，并希望确定描述其背后连续介质运动的最佳拟合速度梯度张量（$L$）。该问题被构建为一个线性最小二乘问题。这项实践连接了抽象的运动学理论与实际的数据分析，要求您构建并求解一个回归模型，同时思考测量噪声和非理想数据分布等现实问题，从而突显奇异值分解（SVD）等稳健数值方法的强大作用 [@problem_id:2686145]。", "problem": "考虑一个三维连续介质，其运动具有空间均匀的速度梯度。设空间速度场表示为 $\\mathbf{v}(\\mathbf{x})$，其中 $\\mathbf{x} \\in \\mathbb{R}^3$ 是当前位置矢量，单位为米（m）。空间速度梯度张量定义为 $\\mathbf{L} = \\nabla \\mathbf{v}$，其分量为 $L_{ij} = \\partial v_i / \\partial x_j$，单位为 $\\mathrm{s}^{-1}$。对称变形率张量为 $\\mathbf{D} = \\tfrac{1}{2}(\\mathbf{L} + \\mathbf{L}^\\mathsf{T})$，单位为 $\\mathrm{s}^{-1}$，反对称自旋张量为 $\\mathbf{W} = \\tfrac{1}{2}(\\mathbf{L} - \\mathbf{L}^\\mathsf{T})$，单位为 $\\mathrm{s}^{-1}$。轴向自旋矢量 $\\boldsymbol{\\omega} \\in \\mathbb{R}^3$（单位为 $\\mathrm{rad/s}$）由关系式 $\\mathbf{W} \\mathbf{a} = \\boldsymbol{\\omega} \\times \\mathbf{a}$对所有 $\\mathbf{a} \\in \\mathbb{R}^3$ 定义。\n\n假设在一个小区域内，速度场可以很好地用一个仿射函数来近似，\n$$\n\\mathbf{v}(\\mathbf{x}) \\approx \\mathbf{L}\\,\\mathbf{x} + \\mathbf{c},\n$$\n其中 $\\mathbf{L} \\in \\mathbb{R}^{3 \\times 3}$ 是空间均匀的，$\\mathbf{c} \\in \\mathbb{R}^3$ 是一个恒定的平移速度，二者单位一致，使得 $\\mathbf{v}$ 的单位为 $\\mathrm{m/s}$，$\\mathbf{x}$ 的单位为 $\\mathrm{m}$，$\\mathbf{L}$ 的单位为 $\\mathrm{s}^{-1}$。给定 $M$ 组位置-速度测量值 $\\{(\\mathbf{x}_i,\\mathbf{v}_i)\\}_{i=1}^M$，其中 $\\mathbf{x}_i \\in \\mathbb{R}^3$ 的单位为米，$\\mathbf{v}_i \\in \\mathbb{R}^3$ 的单位为米/秒。你必须通过最小化残差平方和来估计最佳拟合的 $\\mathbf{L}$ 和 $\\mathbf{c}$。\n\n你的任务如下。\n\n- 从第一性原理出发，构建用于通过最小化\n$$\nJ(\\mathbf{L},\\mathbf{c}) = \\sum_{i=1}^M \\left\\|\\mathbf{v}_i - \\mathbf{L}\\,\\mathbf{x}_i - \\mathbf{c}\\right\\|_2^2.\n$$\n来估计 $\\mathbf{L}$ 和 $\\mathbf{c}$ 的线性最小二乘问题。从上述定义以及微分和求和的线性性质出发推导正规方程，不使用任何预先组合的快捷公式。清晰地定义你如何将未知数堆叠成一个向量，以及如何组装相应的设计矩阵。\n\n- 从估计出的 $\\mathbf{L}$ 中，提取变形率张量 $\\mathbf{D}$ 和自旋张量 $\\mathbf{W}$。定义并用 $\\mathbf{W}$ 的分量表示轴向自旋矢量 $\\boldsymbol{\\omega}$，并提供其欧几里得范数 $\\|\\boldsymbol{\\omega}\\|_2$，单位为 $\\mathrm{rad/s}$。\n\n- 定义每点的均方根残差\n$$\nr_\\mathrm{rms} = \\sqrt{\\frac{1}{M} \\sum_{i=1}^M \\left\\|\\mathbf{v}_i - \\mathbf{L}\\,\\mathbf{x}_i - \\mathbf{c}\\right\\|_2^2},\n$$\n并解释其物理单位和意义。\n\n- 讨论最小二乘估计的唯一性条件，以及当设计矩阵秩亏时伪逆的作用，并参考使用奇异值分解（SVD）计算最小范数解的方法。\n\n使用你的推导实现一个程序，对于下面的每个测试用例，该程序构建测量数据，求解 $(\\mathbf{L},\\mathbf{c})$ 的最小二乘问题，计算 $\\mathbf{D}$、$\\mathbf{W}$、轴向自旋矢量 $\\boldsymbol{\\omega}$，并返回三元组 $\\big(r_\\mathrm{rms}, \\operatorname{tr}(\\mathbf{D}), \\|\\boldsymbol{\\omega}\\|_2\\big)$，单位为 $\\big(\\mathrm{m/s}, \\mathrm{s}^{-1}, \\mathrm{rad/s}\\big)$。所有角度（如果涉及）必须以弧度为单位，所有速率必须以 $\\mathrm{s}^{-1}$ 为单位。在最终的数值输出中，省略单位符号，但要确保与指定单位的一致性。将每个报告的浮点数四舍五入到 $6$ 位小数。\n\n测试套件。对于每种情况，测量值由给定的真实值 $(\\mathbf{L},\\mathbf{c})$ 和测量位置生成，并可选择性地加入速度噪声。$\\mathbf{L}$ 的所有条目单位为 $\\mathrm{s}^{-1}$，$\\mathbf{c}$ 的所有条目单位为 $\\mathrm{m/s}$，所有位置单位为 $\\mathrm{m}$，所有速度单位为 $\\mathrm{m/s}$。\n\n- 情况 1（良态，无噪声）：\n  - $\\mathbf{L}_1 = \\begin{bmatrix} 0.10  -0.50  0.20 \\\\ 0.60  0.05  -0.10 \\\\ -0.30  0.40  0.02 \\end{bmatrix}$, $\\mathbf{c}_1 = \\begin{bmatrix} 0.50 \\\\ -0.20 \\\\ 0.10 \\end{bmatrix}$。\n  - 位置 $\\{\\mathbf{x}_i\\}_{i=1}^7$：$\\mathbf{x}_1 = \\begin{bmatrix} 1.0 \\\\ -2.0 \\\\ 0.5 \\end{bmatrix}$，$\\mathbf{x}_2 = \\begin{bmatrix} -1.5 \\\\ 0.0 \\\\ 2.0 \\end{bmatrix}$，$\\mathbf{x}_3 = \\begin{bmatrix} 0.0 \\\\ 0.0 \\\\ 0.0 \\end{bmatrix}$，$\\mathbf{x}_4 = \\begin{bmatrix} 2.0 \\\\ 1.0 \\\\ -1.0 \\end{bmatrix}$，$\\mathbf{x}_5 = \\begin{bmatrix} -2.0 \\\\ 1.0 \\\\ 3.0 \\end{bmatrix}$，$\\mathbf{x}_6 = \\begin{bmatrix} 0.5 \\\\ -1.0 \\\\ -0.5 \\end{bmatrix}$，$\\mathbf{x}_7 = \\begin{bmatrix} 3.0 \\\\ -2.0 \\\\ 1.0 \\end{bmatrix}$。\n  - 速度是精确的：$\\mathbf{v}_i = \\mathbf{L}_1 \\mathbf{x}_i + \\mathbf{c}_1$ 对于 $i \\in \\{1,\\dots,7\\}$。\n\n- 情况 2（良态，含噪声的速度）：\n  - $\\mathbf{L}_2 = \\begin{bmatrix} -0.08  0.30  -0.15 \\\\ -0.20  0.12  0.25 \\\\ 0.10  -0.35  0.05 \\end{bmatrix}$, $\\mathbf{c}_2 = \\begin{bmatrix} -0.40 \\\\ 0.30 \\\\ 0.00 \\end{bmatrix}$。\n  - 位置 $\\{\\mathbf{x}_i\\}_{i=1}^{10}$：$\\mathbf{x}_1 = \\begin{bmatrix} -1.0 \\\\ -1.0 \\\\ -1.0 \\end{bmatrix}$，$\\mathbf{x}_2 = \\begin{bmatrix} 1.0 \\\\ 1.0 \\\\ 1.0 \\end{bmatrix}$，$\\mathbf{x}_3 = \\begin{bmatrix} 2.0 \\\\ -1.0 \\\\ 0.5 \\end{bmatrix}$，$\\mathbf{x}_4 = \\begin{bmatrix} -2.0 \\\\ 0.5 \\\\ 1.5 \\end{bmatrix}$，$\\mathbf{x}_5 = \\begin{bmatrix} 0.2 \\\\ -0.7 \\\\ 3.0 \\end{bmatrix}$，$\\mathbf{x}_6 = \\begin{bmatrix} 1.5 \\\\ 2.0 \\\\ -2.5 \\end{bmatrix}$，$\\mathbf{x}_7 = \\begin{bmatrix} -0.5 \\\\ 1.2 \\\\ -1.8 \\end{bmatrix}$，$\\mathbf{x}_8 = \\begin{bmatrix} 2.2 \\\\ -0.1 \\\\ 0.0 \\end{bmatrix}$，$\\mathbf{x}_9 = \\begin{bmatrix} -1.1 \\\\ 3.3 \\\\ -0.7 \\end{bmatrix}$，$\\mathbf{x}_{10} = \\begin{bmatrix} 0.0 \\\\ -2.2 \\\\ 1.1 \\end{bmatrix}$。\n  - 附加的速度噪声 $\\{\\boldsymbol{\\eta}_i\\}_{i=1}^{10}$，单位 $\\mathrm{m/s}$：$\\boldsymbol{\\eta}_1 = \\begin{bmatrix} 0.010 \\\\ -0.005 \\\\ 0.002 \\end{bmatrix}$，$\\boldsymbol{\\eta}_2 = \\begin{bmatrix} -0.008 \\\\ 0.004 \\\\ -0.003 \\end{bmatrix}$，$\\boldsymbol{\\eta}_3 = \\begin{bmatrix} 0.005 \\\\ 0.007 \\\\ -0.006 \\end{bmatrix}$，$\\boldsymbol{\\eta}_4 = \\begin{bmatrix} -0.012 \\\\ -0.009 \\\\ 0.004 \\end{bmatrix}$，$\\boldsymbol{\\eta}_5 = \\begin{bmatrix} 0.003 \\\\ -0.002 \\\\ 0.001 \\end{bmatrix}$，$\\boldsymbol{\\eta}_6 = \\begin{bmatrix} 0.015 \\\\ 0.010 \\\\ -0.011 \\end{bmatrix}$，$\\boldsymbol{\\eta}_7 = \\begin{bmatrix} -0.006 \\\\ 0.008 \\\\ 0.009 \\end{bmatrix}$，$\\boldsymbol{\\eta}_8 = \\begin{bmatrix} 0.002 \\\\ -0.004 \\\\ 0.000 \\end{bmatrix}$，$\\boldsymbol{\\eta}_9 = \\begin{bmatrix} -0.009 \\\\ 0.006 \\\\ -0.005 \\end{bmatrix}$，$\\boldsymbol{\\eta}_{10} = \\begin{bmatrix} 0.004 \\\\ -0.001 \\\\ 0.003 \\end{bmatrix}$。\n  - 速度：$\\mathbf{v}_i = \\mathbf{L}_2 \\mathbf{x}_i + \\mathbf{c}_2 + \\boldsymbol{\\eta}_i$ 对于 $i \\in \\{1,\\dots,10\\}$。\n\n- 情况 3（欠定，无噪声；点数不足）： \n  - $\\mathbf{L}_3 = \\begin{bmatrix} 0.00  0.20  0.00 \\\\ -0.10  0.00  0.30 \\\\ 0.05  -0.05  0.00 \\end{bmatrix}$, $\\mathbf{c}_3 = \\begin{bmatrix} 0.00 \\\\ 0.00 \\\\ 0.00 \\end{bmatrix}$。\n  - 位置：$\\mathbf{x}_1 = \\begin{bmatrix} 0.0 \\\\ 0.0 \\\\ 0.0 \\end{bmatrix}$，$\\mathbf{x}_2 = \\begin{bmatrix} 1.0 \\\\ 2.0 \\\\ 3.0 \\end{bmatrix}$。\n  - 速度：$\\mathbf{v}_i = \\mathbf{L}_3 \\mathbf{x}_i + \\mathbf{c}_3$ 对于 $i \\in \\{1,2\\}$。\n\n- 情况 4（秩亏几何，共线点，无噪声）：\n  - $\\mathbf{L}_4 = \\begin{bmatrix} -0.05  0.00  0.00 \\\\ 0.00  0.05  0.10 \\\\ 0.00  -0.10  0.02 \\end{bmatrix}$, $\\mathbf{c}_4 = \\begin{bmatrix} 0.20 \\\\ -0.10 \\\\ 0.00 \\end{bmatrix}$。\n  - 位置：对于 $t \\in \\{-2,-1,0,1,2,3\\}$，$\\mathbf{x}(t) = \\begin{bmatrix} 1 \\\\ 2 \\\\ 3 \\end{bmatrix} t$，即 $\\mathbf{x}_1 = \\begin{bmatrix} -2 \\\\ -4 \\\\ -6 \\end{bmatrix}$，$\\mathbf{x}_2 = \\begin{bmatrix} -1 \\\\ -2 \\\\ -3 \\end{bmatrix}$，$\\mathbf{x}_3 = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix}$，$\\mathbf{x}_4 = \\begin{bmatrix} 1 \\\\ 2 \\\\ 3 \\end{bmatrix}$，$\\mathbf{x}_5 = \\begin{bmatrix} 2 \\\\ 4 \\\\ 6 \\end{bmatrix}$，$\\mathbf{x}_6 = \\begin{bmatrix} 3 \\\\ 6 \\\\ 9 \\end{bmatrix}$。\n  - 速度：$\\mathbf{v}_i = \\mathbf{L}_4 \\mathbf{x}_i + \\mathbf{c}_4$ 对于 $i \\in \\{1,\\dots,6\\}$。\n\n你的程序必须使用一种数值稳定的方法来实现最小二乘估计，该方法在系统秩亏时能产生最小范数解，例如通过奇异值分解计算伪逆。对于每种情况，计算三元组 $\\big(r_\\mathrm{rms}, \\operatorname{tr}(\\mathbf{D}), \\|\\boldsymbol{\\omega}\\|_2\\big)$ 并四舍五入到 $6$ 位小数。你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个元素本身是一个包含三个浮点数的列表，顺序为情况 1 到 4。例如，输出格式必须是\n$$\n\\big[\\,[r_{\\mathrm{rms},1},\\, \\operatorname{tr}(\\mathbf{D}_1),\\, \\|\\boldsymbol{\\omega}_1\\|_2],\\,[r_{\\mathrm{rms},2},\\, \\operatorname{tr}(\\mathbf{D}_2),\\, \\|\\boldsymbol{\\omega}_2\\|_2],\\,[r_{\\mathrm{rms},3},\\, \\operatorname{tr}(\\mathbf{D}_3),\\, \\|\\boldsymbol{\\omega}_3\\|_2],\\,[r_{\\mathrm{rms},4},\\, \\operatorname{tr}(\\mathbf{D}_4),\\, \\|\\boldsymbol{\\omega}_4\\|_2]\\,\\big],\n$$\n其中每个数值条目均四舍五入到 $6$ 位小数，输出中不包含单位符号。单位分别为：$r_{\\mathrm{rms}}$ 为 $\\mathrm{m/s}$，$\\operatorname{tr}(\\mathbf{D})$ 为 $\\mathrm{s}^{-1}$，$\\|\\boldsymbol{\\omega}\\|_2$ 为 $\\mathrm{rad/s}$。", "solution": "所提交的问题陈述经过了严格的验证。\n\n### 步骤 1：提取给定信息\n- **场和变量**：\n  - 空间速度场：$\\mathbf{v}(\\mathbf{x})$，其中 $\\mathbf{x} \\in \\mathbb{R}^3$ 是位置。\n  - 空间速度梯度张量：$\\mathbf{L} = \\nabla \\mathbf{v}$，其分量为 $L_{ij} = \\partial v_i / \\partial x_j$ ($\\mathrm{s}^{-1}$)。\n  - 变形率张量：$\\mathbf{D} = \\tfrac{1}{2}(\\mathbf{L} + \\mathbf{L}^\\mathsf{T})$ ($\\mathrm{s}^{-1}$)。\n  - 自旋张量：$\\mathbf{W} = \\tfrac{1}{2}(\\mathbf{L} - \\mathbf{L}^\\mathsf{T})$ ($\\mathrm{s}^{-1}$)。\n  - 轴向自旋矢量：$\\boldsymbol{\\omega} \\in \\mathbb{R}^3$ ($\\mathrm{rad/s}$)，由关系式 $\\mathbf{W} \\mathbf{a} = \\boldsymbol{\\omega} \\times \\mathbf{a}$ 对所有 $\\mathbf{a} \\in \\mathbb{R}^3$ 定义。\n- **模型**：\n  - 仿射速度场近似：$\\mathbf{v}(\\mathbf{x}) \\approx \\mathbf{L}\\,\\mathbf{x} + \\mathbf{c}$，其中 $\\mathbf{L}$ 是一个常数 $3 \\times 3$ 矩阵，$\\mathbf{c}$ 是一个常数 $3 \\times 1$ 向量。\n- **目标**：\n  - 从 $M$ 组测量值 $\\{(\\mathbf{x}_i,\\mathbf{v}_i)\\}_{i=1}^M$ 中估计 $\\mathbf{L}$ 和 $\\mathbf{c}$，通过最小化残差平方和：$J(\\mathbf{L},\\mathbf{c}) = \\sum_{i=1}^M \\left\\|\\mathbf{v}_i - \\mathbf{L}\\,\\mathbf{x}_i - \\mathbf{c}\\right\\|_2^2$。\n- **待计算的输出**：\n  1. 每点均方根残差：$r_\\mathrm{rms} = \\sqrt{\\frac{1}{M} \\sum_{i=1}^M \\left\\|\\mathbf{v}_i - \\mathbf{L}\\,\\mathbf{x}_i - \\mathbf{c}\\right\\|_2^2}$。\n  2. 变形率张量的迹：$\\operatorname{tr}(\\mathbf{D})$。\n  3. 轴向自旋矢量的欧几里得范数：$\\|\\boldsymbol{\\omega}\\|_2$。\n- **数据**：四种不同的测试用例，具有指定的真实值参数、位置以及（在某些情况下）附加噪声。\n\n### 步骤 2：使用提取的给定信息进行验证\n根据指定标准对问题进行评估。\n- **科学依据**：该问题植根于连续介质力学的基本原理，特别是变形运动学。将速度梯度分解为对称（变形率）和反对称（自旋）部分是一个标准的核心概念。使用线性最小二乘框架从数据中估计模型参数是科学数据分析的基石。所有定义和概念在事实上都是正确且主流的。\n- **适定性**：该问题是适定的。它清晰地定义了要最小化的目标函数和要估计的参数。它为测试用例提供了所有必要的数据。关键是，它预见到了设计矩阵中可能出现的秩亏问题，并规定了一种标准的、健全的方法来获得唯一解——通过伪逆得到的最小范数解，通常使用奇异值分解（SVD）来计算。这确保了为所有提供的测试用例都存在一个唯一且稳定的解。\n- **客观性**：该问题以精确的数学语言陈述。它没有歧义、主观性或见解。\n\n该问题未表现出任何无效性缺陷。它在科学上是健全的、可形式化的、完整的，并且在计算上是可验证的。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供一个完整的、有理有据的解答。\n\n---\n\n### 第一部分：线性最小二乘问题的构建\n\n目标是找到 $3 \\times 3$ 矩阵 $\\mathbf{L}$ 和 $3 \\times 1$ 向量 $\\mathbf{c}$，以最小化成本函数：\n$$\nJ(\\mathbf{L},\\mathbf{c}) = \\sum_{i=1}^M \\left\\|\\mathbf{v}_i - (\\mathbf{L}\\,\\mathbf{x}_i + \\mathbf{c})\\right\\|_2^2\n$$\n模型方程 $\\mathbf{v}_i = \\mathbf{L}\\,\\mathbf{x}_i + \\mathbf{c}$ 可以重写成一种更便于线性回归的形式。我们定义一个增广参数矩阵 $\\mathbf{P}_{\\text{aug}} \\in \\mathbb{R}^{3 \\times 4}$ 为 $\\mathbf{P}_{\\text{aug}} = \\begin{bmatrix} \\mathbf{L}  \\mathbf{c} \\end{bmatrix}$，以及一个增广位置矢量 $\\tilde{\\mathbf{x}}_i \\in \\mathbb{R}^4$ 为 $\\tilde{\\mathbf{x}}_i = \\begin{bmatrix} \\mathbf{x}_i \\\\ 1 \\end{bmatrix}$。这样，单个测量点的模型变为：\n$$\n\\mathbf{v}_i = \\mathbf{P}_{\\text{aug}} \\tilde{\\mathbf{x}}_i\n$$\n这是一个包含 $3 \\times 4 = 12$ 个未知参数（即 $\\mathbf{L}$ 和 $\\mathbf{c}$ 的分量）的系统。我们可以将其表示为一个标准的多目标线性最小二乘问题。我们对模型方程进行转置：\n$$\n\\mathbf{v}_i^\\mathsf{T} = \\tilde{\\mathbf{x}}_i^\\mathsf{T} \\mathbf{P}_{\\text{aug}}^\\mathsf{T}\n$$\n我们定义设计矩阵 $\\mathbf{A} \\in \\mathbb{R}^{M \\times 4}$，其第 $i$ 行为增广位置矢量 $\\tilde{\\mathbf{x}}_i^\\mathsf{T}$：\n$$\n\\mathbf{A} = \\begin{bmatrix}\n\\tilde{\\mathbf{x}}_1^\\mathsf{T} \\\\\n\\tilde{\\mathbf{x}}_2^\\mathsf{T} \\\\\n\\vdots \\\\\n\\tilde{\\mathbf{x}}_M^\\mathsf{T}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nx_{1,1}  x_{1,2}  x_{1,3}  1 \\\\\nx_{2,1}  x_{2,2}  x_{2,3}  1 \\\\\n\\vdots  \\vdots  \\vdots  \\vdots \\\\\nx_{M,1}  x_{M,2}  x_{M,3}  1\n\\end{bmatrix}\n$$\n类似地，我们将测量的速度组装成一个矩阵 $\\mathbf{V} \\in \\mathbb{R}^{M \\times 3}$，其第 $i$ 行为 $\\mathbf{v}_i^\\mathsf{T}$：\n$$\n\\mathbf{V} = \\begin{bmatrix}\n\\mathbf{v}_1^\\mathsf{T} \\\\\n\\mathbf{v}_2^\\mathsf{T} \\\\\n\\vdots \\\\\n\\mathbf{v}_M^\\mathsf{T}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nv_{1,1}  v_{1,2}  v_{1,3} \\\\\nv_{2,1}  v_{2,2}  v_{2,3} \\\\\n\\vdots  \\vdots  \\vdots \\\\\nv_{M,1}  v_{M,2}  v_{M,3}\n\\end{bmatrix}\n$$\n未知参数被收集到一个 $4 \\times 3$ 的矩阵 $\\mathbf{X} = \\mathbf{P}_{\\text{aug}}^\\mathsf{T}$ 中：\n$$\n\\mathbf{X} = \\begin{bmatrix}\n\\mathbf{L}^\\mathsf{T} \\\\\n\\mathbf{c}^\\mathsf{T}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nL_{11}  L_{21}  L_{31} \\\\\nL_{12}  L_{22}  L_{32} \\\\\nL_{13}  L_{23}  L_{33} \\\\\nc_1  c_2  c_3\n\\end{bmatrix}\n$$\n通过这些定义，所有 $M$ 个测量方程的集合可以紧凑地写为：\n$$\n\\mathbf{A} \\mathbf{X} \\approx \\mathbf{V}\n$$\n成本函数 $J$ 是残差矩阵 $\\mathbf{R} = \\mathbf{V} - \\mathbf{A}\\mathbf{X}$ 的弗罗贝尼乌斯范数的平方：\n$$\nJ(\\mathbf{X}) = \\|\\mathbf{V} - \\mathbf{A}\\mathbf{X}\\|_F^2\n$$\n为求最小值，我们将 $J$ 关于 $\\mathbf{X}$ 的梯度设为零。这得到了正规方程：\n$$\n(\\mathbf{A}^\\mathsf{T}\\mathbf{A}) \\mathbf{X} = \\mathbf{A}^\\mathsf{T}\\mathbf{V}\n$$\n这是一个关于未知参数矩阵 $\\mathbf{X}$ 的标准线性系统。一旦求得 $\\mathbf{X}$，估计的速度梯度 $\\mathbf{L}$ 和平移矢量 $\\mathbf{c}$ 可通过以下方式提取：\n$$\n\\mathbf{L} = \\left( \\mathbf{X}[0:3, :] \\right)^\\mathsf{T} \\quad \\text{和} \\quad \\mathbf{c} = \\left( \\mathbf{X}[3, :] \\right)^\\mathsf{T}\n$$\n这里使用了 Python 风格的切片表示法。\n\n### 第二部分：变形、自旋和轴向矢量\n\n一旦获得估计的速度梯度 $\\mathbf{L}$，变形率张量 $\\mathbf{D}$ 和自旋张量 $\\mathbf{W}$ 便可由其定义计算得出：\n$$\n\\mathbf{D} = \\frac{1}{2}(\\mathbf{L} + \\mathbf{L}^\\mathsf{T})\n$$\n$$\n\\mathbf{W} = \\frac{1}{2}(\\mathbf{L} - \\mathbf{L}^\\mathsf{T})\n$$\n$\\mathbf{D}$ 必须是对称的，$\\mathbf{W}$ 必须是反对称的。$\\mathbf{D}$ 的迹，$\\operatorname{tr}(\\mathbf{D}) = \\nabla \\cdot \\mathbf{v}$，表示材料的体积膨胀率。\n\n轴向自旋矢量 $\\boldsymbol{\\omega}$ 的定义满足 $\\mathbf{W}\\mathbf{a} = \\boldsymbol{\\omega} \\times \\mathbf{a}$对任意矢量 $\\mathbf{a}$ 成立。这意味着 $\\mathbf{W}$ 是 $\\boldsymbol{\\omega}$ 的叉积矩阵，记为 $[\\boldsymbol{\\omega}]_\\times$：\n$$\n\\mathbf{W} = [\\boldsymbol{\\omega}]_\\times = \\begin{bmatrix}\n0  -\\omega_3  \\omega_2 \\\\\n\\omega_3  0  -\\omega_1 \\\\\n-\\omega_2  \\omega_1  0\n\\end{bmatrix}\n$$\n通过比较 $\\mathbf{W}$ 和 $[\\boldsymbol{\\omega}]_\\times$ 的分量，我们可以提取 $\\boldsymbol{\\omega}$ 的分量：\n$$\n\\omega_1 = \\frac{1}{2}(W_{32} - W_{23}) = W_{32}\n$$\n$$\n\\omega_2 = \\frac{1}{2}(W_{13} - W_{31}) = W_{13}\n$$\n$$\n\\omega_3 = \\frac{1}{2}(W_{21} - W_{12}) = W_{21}\n$$\n因此，轴向矢量为 $\\boldsymbol{\\omega} = [W_{32}, W_{13}, W_{21}]^\\mathsf{T}$。其欧几里得范数 $\\|\\boldsymbol{\\omega}\\|_2 = \\sqrt{\\omega_1^2 + \\omega_2^2 + \\omega_3^2}$ 给出了局部运动的刚体旋转分量的角速度大小。\n\n### 第三部分：均方根残差\n\n均方根残差定义为：\n$$\nr_\\mathrm{rms} = \\sqrt{\\frac{J(\\mathbf{L}, \\mathbf{c})}{M}} = \\sqrt{\\frac{1}{M} \\sum_{i=1}^M \\left\\|\\mathbf{v}_i - (\\mathbf{L}\\,\\mathbf{x}_i + \\mathbf{c})\\right\\|_2^2}\n$$\n残差矢量 $\\mathbf{r}_i = \\mathbf{v}_i - (\\mathbf{L}\\,\\mathbf{x}_i + \\mathbf{c})$ 的单位是速度（m/s）。其范数的平方 $\\|\\mathbf{r}_i\\|_2^2$ 的单位是 $(\\text{m/s})^2$。求和以及除以点数 $M$ 的平均操作保持了这些单位。最后的平方根运算将单位还原为 $\\mathrm{m/s}$。\n在物理上，$r_\\mathrm{rms}$ 代表了测量速度 $\\mathbf{v}_i$ 与最佳拟合仿射模型预测的速度之间的典型差异大小。它量化了每个测量点的平均拟合误差。$r_\\mathrm{rms}=0$ 表示完美拟合。\n\n### 第四部分：唯一性与伪逆\n\n正规方程 $(\\mathbf{A}^\\mathsf{T}\\mathbf{A}) \\mathbf{X} = \\mathbf{A}^\\mathsf{T}\\mathbf{V}$ 的解是唯一的，当且仅当格拉姆矩阵 $\\mathbf{A}^\\mathsf{T}\\mathbf{A}$ 是可逆的。这等价于设计矩阵 $\\mathbf{A}$ 具有满列秩，即 $\\mathrm{rank}(\\mathbf{A}) = 4$。对于一个 $M \\times 4$ 的矩阵 $\\mathbf{A}$，这要求至少有 $M \\ge 4$ 个测量值。此外，$\\mathbf{A}$ 的行（形式为 $[\\mathbf{x}_i^\\mathsf{T}, 1]$）必须是线性无关的。如果所有的测量点 $\\mathbf{x}_i$ 都位于 $\\mathbb{R}^3$ 中的同一个平面上，则此条件不满足，因为会存在一个非零向量 $\\mathbf{n} \\in \\mathbb{R}^3$ 和一个标量 $d$ 使得对所有 $i$ 都有 $\\mathbf{n} \\cdot \\mathbf{x}_i - d = 0$。这将导致 $\\mathbf{A}$ 的列之间存在线性相关性。因此，为获得唯一解，测量点必须形成一个非退化的三维几何构型（即它们不共面）。\n\n当 $\\mathbf{A}$ 是秩亏的（例如，由于点共面或共线，或点数不足），$\\mathbf{A}^\\mathsf{T}\\mathbf{A}$ 是奇异的，该系统有无穷多个解，所有这些解都能最小化残差 $J$。为了从这个集合中选择一个单一的、明确定义的解，一个常见的标准是选择范数最小的那个。对于矩阵 $\\mathbf{X}$，这意味着最小化 $\\|\\mathbf{X}\\|_F$。\n\n这个最小范数最小二乘解由 $\\mathbf{A}$ 的摩尔-彭若斯伪逆给出，记为 $\\mathbf{A}^\\dagger$：\n$$\n\\mathbf{X} = \\mathbf{A}^\\dagger \\mathbf{V}\n$$\n伪逆可以通过 $\\mathbf{A}$ 的奇异值分解（SVD）可靠地计算出来。如果 $\\mathbf{A} = \\mathbf{U}\\boldsymbol{\\Sigma}\\mathbf{S}^\\mathsf{T}$（使用 $\\mathbf{S}$ 表示右奇异向量以避免与速度矩阵 $\\mathbf{V}$ 混淆），那么 $\\mathbf{A}^\\dagger = \\mathbf{S}\\boldsymbol{\\Sigma}^\\dagger\\mathbf{U}^\\mathsf{T}$，其中 $\\boldsymbol{\\Sigma}^\\dagger$ 是通过取 $\\mathbf{A}$ 的非零奇异值的倒数并转置得到的。这种方法即使对于秩亏系统也能提供一个数值稳定且唯一的解，如测试用例 3 和 4 所示。", "answer": "[[0.000000,0.170000,0.950000],[0.009087,0.089408,0.463384],[0.000000,0.000000,0.141751],[0.000000,0.010000,0.100000]]", "id": "2686145"}, {"introduction": "有限变形仿真是现代固体力学的核心。这些仿真的一个核心环节是根据关系式 $\\dot{F} = L F$ 随时间精确地更新变形梯度 ($F$)。本练习将探讨使用简单的数值积分方法（显式和隐式欧拉法）求解此演化方程所带来的后果，特别是对于 $\\operatorname{tr}(L)=0$ 的不可压缩材料。通过比较不同的数值方案并实施一种基于投影的修正方法，您将对计算运动学中的挑战与对策获得至关重要的见解，这对于开发能够遵守体积守恒等基本物理定律的稳健仿真工具至关重要 [@problem_id:2686139]。", "problem": "您需要编写一个完整的程序，比较空间速度梯度的数值时间积分在不可压缩条件下如何影响体积保持，然后实现一个修正方案来强制施加不可压缩性。该问题的背景是三维固体力学中变形梯度的空间演化。\n\n从以下定义和基本关系开始：\n\n- 空间速度梯度张量定义为 $L = \\nabla v$，其中 $v$ 是空间速度场。将 $L$ 分解为其对称部分 $D$ 和反对称部分 $W$，即 $L = D + W$，其中 $D = \\tfrac{1}{2}(L + L^{T})$ 是变形率张量，$W = \\tfrac{1}{2}(L - L^{T})$ 是自旋张量。根据构造，$\\operatorname{tr}(W) = 0$ 且 $\\operatorname{tr}(L) = \\operatorname{tr}(D)$。\n- 变形梯度 $F$ 根据空间运动学关系 $\\,\\dot{F} = L \\, F\\,$ 进行演化，初始条件为 $F(0) = I$，其中 $I$ 是单位张量。\n- 变形的雅可比行列式为 $J = \\det(F)$。雅可比恒等式意味着 $\\dfrac{d}{dt} \\det(F) = \\det(F) \\, \\operatorname{tr}(L)$。因此，如果 $\\operatorname{tr}(L) = 0$ 对时间逐点成立，则精确演化会保持体积，即如果 $J(0) = 1$，那么对于所有 $t$ 都有 $J(t) = 1$。\n\n您的任务是在 $\\operatorname{tr}(L) = 0$ 的条件下，比较两种用于 $\\,\\dot{F} = L F\\,$ 的一阶时间积分格式：\n\n- 显式（前向欧拉）格式：通过 $F_{n+1} = (I + \\Delta t \\, L_{n}) \\, F_{n}$ 进行推进。\n- 隐式（后向欧拉）格式：通过 $(I - \\Delta t \\, L_{n+1}) \\, F_{n+1} = F_{n}$ 进行推进；假设 $L$ 在每个时间步内保持不变，因此该步的更新为 $F_{n+1} = (I - \\Delta t \\, L)^{-1} F_{n}$。\n\n当 $\\operatorname{tr}(L) = 0$ 时，您必须通过计算最终的 $J = \\det(F)$ 并报告绝对误差 $|J - 1|$ 来量化每个积分格式产生的体积保持误差。然后，提出并实现一种修正策略，该策略通过在每一步将更新后的 $F$ 投影回等容流形 $\\det(F) = 1$ 来强制施加不可压缩性。在三维情况下，一个标准的等容投影是 $F \\leftarrow F / (\\det(F))^{1/3}$。\n\n您的程序应为每个测试用例实现以下内容：\n\n1. 使用显式欧拉法将 $F$ 从 $t = 0$ 积分到 $t = N \\Delta t$，不进行任何修正；在最后报告 $|J - 1|$。\n2. 使用隐式欧拉法将 $F$ 从 $t = 0$ 积分到 $t = N \\Delta t$，不进行任何修正；在最后报告 $|J - 1|$。\n3. 重复第 1 项，但在每个时间步后应用等容投影 $F \\leftarrow F / (\\det(F))^{1/3}$；在最后报告 $|J - 1|$。\n4. 重复第 2 项，但在每个时间步后应用相同的等容投影；在最后报告 $|J - 1|$。\n\n注意：此处所有量均为无量纲，所有矩阵均为 $3 \\times 3$ 矩阵。如果涉及角度，单位默认为弧度。\n\n测试套件（您必须在程序中硬编码这些测试用例）：\n\n- 用例 $1$（幂零简单剪切；由于单位上三角步长更新，两种格式理想上都应保持体积）：\n  - $L = \\begin{bmatrix} 0  \\gamma  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}$，其中 $\\gamma = 0.5$，\n  - $\\Delta t = 0.1$，\n  - $N = 50$。\n- 用例 $2$（平面刚体绕 $z$ 轴旋转）：\n  - $L = \\begin{bmatrix} 0  -\\omega  0 \\\\ \\omega  0  0 \\\\ 0  0  0 \\end{bmatrix}$，其中 $\\omega = 1.0$，\n  - $\\Delta t = 0.1$，\n  - $N = 50$。\n- 用例 $3$（迹为零的偏量拉伸与自旋的组合）：\n  - $D = \\begin{bmatrix} 0.2  0.3  0.0 \\\\ 0.3  -0.1  0.0 \\\\ 0.0  0.0  -0.1 \\end{bmatrix}$，$W = \\begin{bmatrix} 0  -\\omega  0 \\\\ \\omega  0  0 \\\\ 0  0  0 \\end{bmatrix}$，其中 $\\omega = 0.5$，\n  - $L = D + W$，\n  - $\\Delta t = 0.05$，\n  - $N = 60$。\n- 用例 $4$（大时间步长旋转压力测试）：\n  - $L = \\begin{bmatrix} 0  -\\omega  0 \\\\ \\omega  0  0 \\\\ 0  0  0 \\end{bmatrix}$，其中 $\\omega = 5.0$，\n  - $\\Delta t = 0.5$，\n  - $N = 4$。\n\n实现要求：\n\n- 用 $F_{0} = I$ 进行初始化，并在每次积分过程中使用恒定的 $L$（如上所述）。\n- 对于每个用例，按顺序计算并记录四个数值：无修正的显式欧拉法的绝对体积误差，无修正的隐式欧拉法的绝对体积误差，带每步等容投影的显式欧拉法的绝对体积误差，以及带每步等容投影的隐式欧拉法的绝对体积误差。\n- 最终输出必须为单行，包含一个逗号分隔的列表，其中包含所有四个测试用例的结果，顺序为：$\\big[\\text{用例 }1\\text{ 显式}, \\text{用例 }1\\text{ 隐式}, \\text{用例 }1\\text{ 显式修正}, \\text{用例 }1\\text{ 隐式修正}, \\dots, \\text{用例 }4\\text{ 隐式修正}\\big]$。每个条目必须是四舍五入到恰好 $10$ 位小数的浮点数。\n\n科学推理目标：\n\n- 从基本关系 $\\dot{F} = L F$ 和雅可比恒等式出发，推导出当 $\\operatorname{tr}(L) = 0$ 时，为何精确解能保持体积。\n- 当 $\\operatorname{tr}(L) = 0$ 时，使用 $\\det(I \\pm \\Delta t L)$ 的小 $\\Delta t$ 展开式，分析离散更新 $F \\mapsto (I + \\Delta t L)F$ 和 $F \\mapsto (I - \\Delta t L)^{-1}F$ 如何在每一步改变 $\\det(F)$。\n- 解释为何所提出的等容投影 $F \\leftarrow F / (\\det F)^{1/3}$ 能在三维离散层面上强制施加不可压缩性。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表（例如：“[0.0,0.0,0.0,0.0,0.1,0.2,0.0,0.0, ...]”）。", "solution": "问题陈述是计算连续介质力学中一个有效的练习。它具有科学依据、是适定的、客观的，并包含了完整解答所需的所有信息。它要求在不可压缩约束下比较用于变形梯度演化的数值积分格式，这是一个标准且重要的课题。该问题没有缺陷，因此将提供一个解答。\n\n分析分三部分进行。首先，建立连续介质层面上的体积保持理论。其次，分析离散数值积分格式在体积保持方面的行为。第三，证明修正投影方案的合理性。\n\n**1. 连续介质理论中的体积保持**\n\n变形梯度张量 $F$ 的演化由运动学关系\n$$ \\dot{F} = L F $$\n决定，其中 $L$ 是空间速度梯度，上方的点表示物质时间导数。初始条件取为未变形状态，$F(t=0) = I$，其中 $I$ 是 $3 \\times 3$ 的单位张量。\n\n变形的雅可比行列式 $J = \\det(F)$ 表示当前变形体积元与其参考体积元之比。其变化率由雅可比恒等式给出：\n$$ \\frac{dJ}{dt} = \\frac{d}{dt} \\det(F) = \\det(F) \\operatorname{tr}(\\dot{F} F^{-1}) $$\n将 $\\dot{F}$ 的演化方程代入，我们得到\n$$ \\frac{dJ}{dt} = J \\operatorname{tr}( (L F) F^{-1} ) = J \\operatorname{tr}(L) $$\n这是一个关于 $J(t)$ 的一阶常微分方程。如果一种材料在变形过程中体积不发生变化，则定义其为不可压缩材料。这意味着 $J(t)$ 必须保持恒定。由于初始状态是未变形的，$J(0) = \\det(I) = 1$。为了使 $J(t)$ 恒定为 $1$，其时间导数必须为零。从方程 $\\dot{J} = J \\operatorname{tr}(L)$，当 $J=1$ 时，我们必须有 $\\operatorname{tr}(L) = 0$。\n\n因此，不可压缩的条件是空间速度梯度在任何时候都必须是无迹的，即 $\\operatorname{tr}(L)=0$。给定 $J(0) = 1$，如果 $\\operatorname{tr}(L)=0$，则 $\\dot{J}=0$，积分可得对于所有 $t \\ge 0$ 都有 $J(t) = 1$。这证实了在该条件下，精确解析解能保持体积。\n\n**2. 数值积分格式分析**\n\n我们现在分析在 $\\operatorname{tr}(L) = 0$ 的条件下，两种一阶数值格式在从 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 的单个时间步内的行为。变形梯度从 $F_n$ 更新到 $F_{n+1}$。相应地，雅可比行列式从 $J_n$ 更新到 $J_{n+1}$。\n\n**a) 显式（前向）欧拉格式**\n\n更新规则为 $F_{n+1} = (I + \\Delta t L) F_n$。新步长的雅可比行列式为：\n$$ J_{n+1} = \\det(F_{n+1}) = \\det((I + \\Delta t L) F_n) = \\det(I + \\Delta t L) \\det(F_n) = \\det(I + \\Delta t L) J_n $$\n为了分析 $\\det(I + \\Delta t L)$，我们使用 $3 \\times 3$ 矩阵 $M$ 的行列式通用公式：\n$$ \\det(M) = \\frac{1}{6} [(\\operatorname{tr}(M))^3 - 3 \\operatorname{tr}(M)\\operatorname{tr}(M^2) + 2 \\operatorname{tr}(M^3)] $$\n或者，一种更直接的方法是，对于矩阵 $A$，有 $\\det(I + \\epsilon A) = 1 + \\epsilon \\operatorname{tr}(A) + \\frac{\\epsilon^2}{2} [(\\operatorname{tr}(A))^2 - \\operatorname{tr}(A^2)] + \\epsilon^3 \\det(A)$。令 $\\epsilon = \\Delta t$ 且 $A=L$。给定 $\\operatorname{tr}(L)=0$，这可以简化为：\n$$ \\det(I + \\Delta t L) = 1 - \\frac{(\\Delta t)^2}{2} \\operatorname{tr}(L^2) + (\\Delta t)^3 \\det(L) $$\n由于此表达式通常不等于 $1$，因此雅可比行列式在显式欧拉步中不被保持，即 $J_{n+1} \\neq J_n$。每一步都会引入一个量级为 $O((\\Delta t)^2)$ 的体积误差。具体来说，如果 $\\operatorname{tr}(L^2)  0$，如在纯旋转情况下，该格式会人为地增加体积。\n\n**b) 隐式（后向）欧拉格式**\n\n更新规则为 $F_{n+1} = (I - \\Delta t L)^{-1} F_n$。新步长的雅可比行列式为：\n$$ J_{n+1} = \\det(F_{n+1}) = \\det((I - \\Delta t L)^{-1} F_n) = \\det((I - \\Delta t L)^{-1}) \\det(F_n) = \\frac{1}{\\det(I - \\Delta t L)} J_n $$\n对 $I - \\Delta t L$ 使用相同的行列式展开，其中 $\\operatorname{tr}(-L) = -\\operatorname{tr}(L) = 0$：\n$$ \\det(I - \\Delta t L) = 1 - \\frac{(\\Delta t)^2}{2} \\operatorname{tr}((-L)^2) + (\\Delta t)^3 \\det(-L) = 1 - \\frac{(\\Delta t)^2}{2} \\operatorname{tr}(L^2) - (\\Delta t)^3 \\det(L) $$\n同样，这通常不等于 $1$。隐式欧拉格式在每一步也会引入一个量级为 $O((\\Delta t)^2)$ 的体积误差。注意两种误差之间的关系：如果显式格式的更新因子是 $1+\\delta$，那么隐式格式的因子大约是 $(1-\\delta)^{-1} \\approx 1+\\delta$。然而，高阶项的符号不同，导致在许多情况下产生相反的效果。例如，如果显式格式导致体积增加，隐式格式通常会使体积减小，反之亦然。\n\n**3. 等容投影修正**\n\n为了在离散层面上强制施加不可压缩性，在每个时间步结束时，对更新后的变形梯度 $F_{n+1}$ 应用一个投影。所提出的投影是：\n$$ F_{n+1}^{\\text{corr}} = \\frac{F_{n+1}}{(\\det(F_{n+1}))^{1/3}} $$\n设 $F_{new} = F_{n+1}^{\\text{corr}}$ 且 $J_{old} = \\det(F_{n+1})$。缩放因子是一个标量 $c = (J_{old})^{-1/3}$。修正后张量的雅可比行列式为：\n$$ \\det(F_{new}) = \\det(c F_{n+1}) $$\n对于一个 $3 \\times 3$ 的矩阵 $A$ 和一个标量 $c$，行列式的性质是 $\\det(cA) = c^3 \\det(A)$。应用此性质：\n$$ \\det(F_{new}) = c^3 \\det(F_{n+1}) = \\left( (J_{old})^{-1/3} \\right)^3 J_{old} = (J_{old})^{-1} J_{old} = 1 $$\n这表明，无论时间积分格式引入了多大的误差，该投影都能在每一步结束时将变形梯度的雅可比行列式严格地重置为 $1$，从而强制施加不可压缩约束。这是将 $F$ 乘法分解为一个体积部分 $(\\det F)^{1/3}I$ 和一个等容部分 $\\bar{F} = F/(\\det F)^{1/3}$ 的一种常见形式。该投影仅保留了等容部分。\n\n**算法流程**\n对于每个测试用例，使用时间步长 $\\Delta t$ 运行四次数值模拟，每次数值模拟包含 $N$ 步。\n1.  **显式无修正**: $F_0 = I$。对于 $n=0, \\dots, N-1$：$F_{n+1} = (I + \\Delta t L) F_n$。\n2.  **隐式无修正**: $F_0 = I$。对于 $n=0, \\dots, N-1$：$F_{n+1} = (I - \\Delta t L)^{-1} F_n$。\n3.  **显式修正**: $F_0 = I$。对于 $n=0, \\dots, N-1$：$F_{temp} = (I + \\Delta t L) F_n$；$J = \\det(F_{temp})$；$F_{n+1} = F_{temp} / J^{1/3}$。\n4.  **隐式修正**: $F_0 = I$。对于 $n=0, \\dots, N-1$：$F_{temp} = (I - \\Delta t L)^{-1} F_n$；$J = \\det(F_{temp})$；$F_{n+1} = F_{temp} / J^{1/3}$。\n\n在 $N$ 步之后，为这四次数值模拟分别计算最终的绝对误差 $| \\det(F_N) - 1 |$。收集结果并按规定格式化。对于幂零剪切的特殊情况（$L^2 = 0$），由于 $\\det(I \\pm \\Delta t L) = 1$ 精确成立，无修正格式应该产生零误差。", "answer": "[0.0000000000,0.0000000000,0.0000000000,0.0000000000,0.2834733918,0.2207136209,0.0000000001,0.0000000001,2.0238416625,0.7380961803,0.0000000002,0.0000000000,56.8847656250,0.9846153846,0.0000000000,0.0000000000]", "id": "2686139"}]}