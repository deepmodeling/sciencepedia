{"hands_on_practices": [{"introduction": "本节的第一个练习旨在为应力功率奠定基础，我们将研究局部应力功率密度，即单位体积内应力所做的功的速率。通过分析一个简剪切流，你将把速度梯度 $\\mathbf{L}$ 分解为变形率 $\\mathbf{D}$ 和自旋 $\\mathbf{W}$，并证明一个基本结论：对于任何具有对称应力张量 $\\boldsymbol{\\sigma}$ 的经典材料，只有变形率对应力功率有贡献 [@problem_id:2691176]。这个实践阐明了应力功率的物理意义，揭示了它与材料的应变直接相关，而与刚体旋转无关。", "problem": "一个均匀、不可压缩、等温的经典Cauchy连续体（无体力偶，无力偶应力）经历一个稳定简剪切运动，该运动在固定笛卡尔坐标系中由速度场 $\\mathbf{v}(\\mathbf{x}) = (\\dot{\\gamma}\\,y,\\,0,\\,0)$ 描述，其中 $\\dot{\\gamma}$ 是一个恒定的剪切率，而 $y$ 是第二个笛卡尔坐标。在所关心的瞬间，Cauchy应力张量 $\\boldsymbol{\\sigma}$ 在空间上是均匀的。请仅使用基本平衡定律和核心运动学定义，按以下步骤进行：\n- 从速度梯度作为速度的空间梯度的定义出发，计算给定运动的速度梯度 $\\mathbf{L}$，并将其分解为其对称部分 $\\mathbf{D}$ 和反对称部分 $\\mathbf{W}$。\n- 从虚功率原理和局部平衡出发，确定在所述的本构类别下，$\\mathbf{L}$ 的哪些部分可以对内功率密度 $\\boldsymbol{\\sigma}:\\mathbf{L}$ 做出贡献。\n- 利用您的判断，推导此运动的单位体积内功率，用 $\\dot{\\gamma}$ 和 $\\boldsymbol{\\sigma}$ 的笛卡尔分量表示。\n\n将您的最终答案表示为 $\\boldsymbol{\\sigma}:\\mathbf{L}$ 的单一闭式解析表达式，单位为国际单位制中的 $\\mathrm{W\\,m^{-3}}$。不要进行任何数值代入，也不要四舍五入；报告精确表达式。请在您的解答中提供推导过程，但最终答案只提供所要求的表达式。", "solution": "问题陈述经确认为科学上合理、自洽且适定。这是一道连续介质力学中的标准练习题，可以使用基本原理来解决。我现在开始解答。\n\n该问题涉及一个稳定简剪切运动，其在笛卡尔坐标系 $(x_1, x_2, x_3) = (x, y, z)$ 中的速度场由下式描述：\n$$ \\mathbf{v}(\\mathbf{x}) = (\\dot{\\gamma}x_2, 0, 0) $$\n其中 $\\dot{\\gamma}$ 是一个恒定的剪切率。该连续体被指定为经典Cauchy连续体，这意味着Cauchy应力张量 $\\boldsymbol{\\sigma}$ 是对称的。单位体积内功率，或称应力功率密度，由标量积 $\\boldsymbol{\\sigma}:\\mathbf{L}$ 给出，其中 $\\mathbf{L}$ 是速度梯度张量。推导将按要求分三步进行。\n\n**第一步：运动学分解**\n\n首先，我们计算速度梯度张量 $\\mathbf{L}$，其分量定义为 $L_{ij} = \\frac{\\partial v_i}{\\partial x_j}$。给定速度场 $\\mathbf{v} = (v_1, v_2, v_3) = (\\dot{\\gamma}x_2, 0, 0)$，$\\mathbf{L}$ 的唯一非零分量是：\n$$ L_{12} = \\frac{\\partial v_1}{\\partial x_2} = \\frac{\\partial (\\dot{\\gamma}x_2)}{\\partial x_2} = \\dot{\\gamma} $$\n所有其他分量 $L_{ij}$ 均为零。以矩阵形式表示，速度梯度张量为：\n$$ \\mathbf{L} = \\begin{pmatrix} 0 & \\dot{\\gamma} & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\n速度梯度张量 $\\mathbf{L}$ 可以唯一地分解为其对称部分，即形变率张量 $\\mathbf{D}$，和其反对称部分，即自旋张量 $\\mathbf{W}$。\n\n形变率张量定义为 $\\mathbf{D} = \\frac{1}{2}(\\mathbf{L} + \\mathbf{L}^T)$。其矩阵表示为：\n$$ \\mathbf{D} = \\frac{1}{2} \\left[ \\begin{pmatrix} 0 & \\dot{\\gamma} & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} + \\begin{pmatrix} 0 & 0 & 0 \\\\ \\dot{\\gamma} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\right] = \\frac{1}{2} \\begin{pmatrix} 0 & \\dot{\\gamma} & 0 \\\\ \\dot{\\gamma} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\n非零分量为 $D_{12} = D_{21} = \\frac{\\dot{\\gamma}}{2}$。注意，$\\mathbf{D}$ 的迹为 $\\mathrm{tr}(\\mathbf{D}) = D_{11}+D_{22}+D_{33}=0$，这与给定的不可压缩连续体条件（$\\nabla \\cdot \\mathbf{v} = \\mathrm{tr}(\\mathbf{D}) = 0$）一致。\n\n自旋张量定义为 $\\mathbf{W} = \\frac{1}{2}(\\mathbf{L} - \\mathbf{L}^T)$。其矩阵表示为：\n$$ \\mathbf{W} = \\frac{1}{2} \\left[ \\begin{pmatrix} 0 & \\dot{\\gamma} & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} - \\begin{pmatrix} 0 & 0 & 0 \\\\ \\dot{\\gamma} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\right] = \\frac{1}{2} \\begin{pmatrix} 0 & \\dot{\\gamma} & 0 \\\\ -\\dot{\\gamma} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\n非零分量为 $W_{12} = \\frac{\\dot{\\gamma}}{2}$ 和 $W_{21} = -\\frac{\\dot{\\gamma}}{2}$。\n\n**第二步：对内功率的贡献**\n\n单位体积内功率是应力张量 $\\boldsymbol{\\sigma}$ 和速度梯度张量 $\\mathbf{L}$ 的双点积：\n$$ \\mathcal{P}_{int} = \\boldsymbol{\\sigma} : \\mathbf{L} $$\n使用分解式 $\\mathbf{L} = \\mathbf{D} + \\mathbf{W}$，我们可以写出：\n$$ \\mathcal{P}_{int} = \\boldsymbol{\\sigma} : (\\mathbf{D} + \\mathbf{W}) = \\boldsymbol{\\sigma} : \\mathbf{D} + \\boldsymbol{\\sigma} : \\mathbf{W} $$\n问题指出该材料是无体力偶的“经典Cauchy连续体”。对于此类连续体，角动量局部平衡的一个基本推论是Cauchy应力张量必须是对称的，即 $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^T$，或以分量形式写作 $\\sigma_{ij} = \\sigma_{ji}$。\n\n我们现在来考察 $\\boldsymbol{\\sigma} : \\mathbf{W}$ 这一项。这是一个对称张量 ($\\boldsymbol{\\sigma}$) 和一个反对称张量 ($\\mathbf{W}$) 的双点积。该乘积恒等于零。为证明这一点，我们用分量形式写出该乘积：\n$$ \\boldsymbol{\\sigma} : \\mathbf{W} = \\sigma_{ij} W_{ij} $$\n利用 $\\boldsymbol{\\sigma}$ 的对称性 ($\\sigma_{ij} = \\sigma_{ji}$) 和 $\\mathbf{W}$ 的反对称性 ($W_{ij} = -W_{ji}$)，我们有：\n$$ \\sigma_{ij} W_{ij} = \\sigma_{ji} (-W_{ji}) $$\n通过重新标记求和指标 ($i \\leftrightarrow j$)，右侧的表达式变为：\n$$ -\\sigma_{ij}W_{ij} $$\n因此，我们得到等式 $\\sigma_{ij}W_{ij} = -\\sigma_{ij}W_{ij}$，这意味着 $2 \\sigma_{ij}W_{ij} = 0$，从而 $\\boldsymbol{\\sigma}:\\mathbf{W} = 0$。\n\n这个结果表明，对于经典Cauchy连续体，自旋张量 $\\mathbf{W}$ 对内功率密度没有贡献。全部的应力功率都来自于形变率张量 $\\mathbf{D}$。因此，只有速度梯度的对称部分 $\\mathbf{D}$ 对内功率有贡献。\n$$ \\mathcal{P}_{int} = \\boldsymbol{\\sigma} : \\mathbf{D} $$\n\n**第三步：最终表达式的推导**\n\n根据第二步的结论，我们现在通过计算 $\\boldsymbol{\\sigma}:\\mathbf{D}$ 来求得单位体积内功率。以分量形式表示：\n$$ \\boldsymbol{\\sigma}:\\mathbf{D} = \\sum_{i,j} \\sigma_{ij} D_{ij} $$\n根据第一步，$\\mathbf{D}$ 仅有的非零分量是 $D_{12}$ 和 $D_{21}$。求和展开式简化为：\n$$ \\boldsymbol{\\sigma}:\\mathbf{D} = \\sigma_{12} D_{12} + \\sigma_{21} D_{21} $$\n代入数值 $D_{12} = \\frac{\\dot{\\gamma}}{2}$ 和 $D_{21} = \\frac{\\dot{\\gamma}}{2}$：\n$$ \\boldsymbol{\\sigma}:\\mathbf{D} = \\sigma_{12} \\left(\\frac{\\dot{\\gamma}}{2}\\right) + \\sigma_{21} \\left(\\frac{\\dot{\\gamma}}{2}\\right) $$\n根据角动量平衡所确立的，应力张量是对称的，所以 $\\sigma_{12} = \\sigma_{21}$。将此代入表达式，得到：\n$$ \\boldsymbol{\\sigma}:\\mathbf{D} = \\sigma_{12} \\left(\\frac{\\dot{\\gamma}}{2}\\right) + \\sigma_{12} \\left(\\frac{\\dot{\\gamma}}{2}\\right) = 2 \\sigma_{12} \\left(\\frac{\\dot{\\gamma}}{2}\\right) = \\sigma_{12} \\dot{\\gamma} $$\n另外，也可以用 $\\sigma_{xy}$ 表示 $\\sigma_{12}$，从而得到 $\\sigma_{xy} \\dot{\\gamma}$。两者是等价的。因此，单位体积内功率的最终表达式是 $\\sigma_{12}\\dot{\\gamma}$。单位是应力 $(\\mathrm{N\\,m^{-2}})$ 乘以速率 $(\\mathrm{s^{-1}})$，得到 $\\mathrm{N\\,m^{-2}\\,s^{-1}} = (\\mathrm{J\\,m^{-1}})\\,\\mathrm{m^{-2}\\,s^{-1}} = \\mathrm{J\\,m^{-3}\\,s^{-1}} = \\mathrm{W\\,m^{-3}}$，符合要求。", "answer": "$$\\boxed{\\sigma_{12}\\dot{\\gamma}}$$", "id": "2691176"}, {"introduction": "在应力功率 $\\sigma\\dot{\\varepsilon}$ 定义的基础上，这个练习将通过应用克劳修斯-杜亨不等式 (Clausius-Duhem inequality) 深入探讨其热力学意义。使用经典的开尔文-沃伊特 (Kelvin-Voigt) 模型来描述粘弹性材料，你将明确地将总应力功率分解为两部分：储存的弹性能量的变化率 $\\dot{\\psi}$ 和内耗散率 $D$ [@problem_id:2691179]。这个练习提供了一个具体的例子，说明了材料本构关系如何决定能量耗散，并使你能够量化在循环加载过程中以热量形式损失的能量。", "problem": "一根经历小应变的细长一维粘弹性杆，在等温条件下通过一个 Kelvin–Voigt 固体模型进行建模，其本构方程为 $\\sigma(t) = E\\,\\varepsilon(t) + \\eta\\,\\dot{\\varepsilon}(t)$，其中 $\\sigma$ 是 Cauchy 应力，$\\varepsilon$ 是无穷小应变，$E$ 是杨氏模量，$\\eta$ 是粘度。单位体积的 Helmholtz 自由能为 $\\psi(\\varepsilon) = \\tfrac{1}{2} E\\,\\varepsilon^{2}$。该杆承受一个给定的循环应变 $\\varepsilon(t) = \\varepsilon_{0}\\,\\sin(2\\pi f\\,t)$，其振幅 $\\varepsilon_{0} = 0.010$，频率 $f = 2.0$ Hz。材料参数为 $E = 1.5 \\times 10^{9}$ Pa 和 $\\eta = 5.0 \\times 10^{7}$ Pa$\\cdot$s。\n\n从单位体积的内应力功率 $p_{\\mathrm{int}}(t) = \\sigma(t)\\,\\dot{\\varepsilon}(t)$ 和小应变下的等温 Clausius–Duhem 不等式 $D(t) = \\sigma(t)\\,\\dot{\\varepsilon}(t) - \\dot{\\psi}(t) \\ge 0$ 的定义出发，其中 $D(t)$是单位体积的内耗散率，$\\dot{\\psi}(t)$ 是自由能的材料时间导数，完成以下任务：\n\n1. 推导 $D(t)$ 关于 $\\varepsilon(t)$、$\\dot{\\varepsilon}(t)$、$E$ 和 $\\eta$ 的显式表达式，并证明其在所有时间内均为非负值。\n2. 推导在一个周期内单位体积耗散的能量 $W_{\\mathrm{diss}} = \\int_{0}^{T} D(t)\\,dt$ 的闭式表达式，其中 $T = 1/f$，该表达式仅用 $\\varepsilon_{0}$、$f$ 和 $\\eta$ 来表示。\n3. 对给定的参数，数值计算 $W_{\\mathrm{diss}}$。以 kJ/m$^{3}$ 为单位表示最终答案，并将答案四舍五入到四位有效数字。", "solution": "在尝试求解之前，将首先验证该问题的科学合理性和逻辑一致性。\n\n问题验证：\n\n步骤 1: 提取已知条件\n问题陈述中提供的明确数据和定义如下：\n- 一维 Kelvin–Voigt 固体的本构方程：$\\sigma(t) = E\\,\\varepsilon(t) + \\eta\\,\\dot{\\varepsilon}(t)$\n- 单位体积的 Helmholtz 自由能：$\\psi(\\varepsilon) = \\tfrac{1}{2} E\\,\\varepsilon^{2}$\n- 给定的循环应变：$\\varepsilon(t) = \\varepsilon_{0}\\,\\sin(2\\pi f\\,t)$\n- 应变振幅：$\\varepsilon_{0} = 0.010$\n- 频率：$f = 2.0$ Hz\n- 杨氏模量：$E = 1.5 \\times 10^{9}$ Pa\n- 粘度：$\\eta = 5.0 \\times 10^{7}$ Pa$\\cdot$s\n- 单位体积的内应力功率：$p_{\\mathrm{int}}(t) = \\sigma(t)\\,\\dot{\\varepsilon}(t)$\n- 等温 Clausius–Duhem 不等式及内耗散率的定义：$D(t) = \\sigma(t)\\,\\dot{\\varepsilon}(t) - \\dot{\\psi}(t) \\ge 0$\n- 在一个周期内单位体积耗散的能量：$W_{\\mathrm{diss}} = \\int_{0}^{T} D(t)\\,dt$，其中 $T = 1/f$\n\n步骤 2: 使用提取的已知条件进行验证\n根据所需标准对问题进行评估。\n- **科学基础：** 该问题基于标准的、公认的线性粘弹性理论，特别是 Kelvin–Voigt 模型。Helmholtz 自由能、应力功率和 Clausius–Duhem 不等式的概念是连续介质热力学的基本原理。所有定义和方程在固体力学领域都是正确且标准的。\n- **适定性：** 问题陈述清晰。所有必要的材料参数（$E$, $\\eta$）、加载条件（$\\varepsilon_{0}$, $f$）和理论定义（$\\sigma$, $\\psi$, $D$）都已提供。任务被明确地指定，并导向一个唯一的、可推导的解。\n- **客观性：** 语言正式、精确且完全客观。没有主观或推测性的陈述。\n- **完整性和一致性：** 问题是自洽的。所提供的数据在量纲上是一致的（例如，$E$ 的单位是 Pa，$\\eta$ 的单位是 Pa$\\cdot$s）。没有矛盾之处。\n- **可行性：** 对于某些类别的材料（如聚合物），参数值在物理上合理的范围内。应变振幅 $\\varepsilon_0 = 0.010$ 很小，与无穷小应变理论的假设一致。\n\n步骤 3: 结论与行动\n该问题在科学上有效、适定且内部一致。这是连续介质力学中的一个标准练习。因此，我将继续进行求解。\n\n解：\n\n根据问题陈述的要求，解答分为三个部分。\n\n第 1 部分：耗散率 $D(t)$ 的推导及非负性证明。\n\n单位体积的内耗散率 $D(t)$ 定义为：\n$$D(t) = \\sigma(t)\\,\\dot{\\varepsilon}(t) - \\dot{\\psi}(t)$$\n首先，我们求 Helmholtz 自由能的材料时间导数 $\\dot{\\psi}(t)$。自由能由 $\\psi(\\varepsilon) = \\frac{1}{2} E\\,\\varepsilon^{2}$ 给出。使用关于时间 $t$ 的链式求导法则：\n$$\\dot{\\psi}(t) = \\frac{d\\psi}{d\\varepsilon} \\frac{d\\varepsilon}{dt} = \\left(\\frac{d}{d\\varepsilon} \\left(\\frac{1}{2} E\\,\\varepsilon^{2}\\right)\\right) \\dot{\\varepsilon}(t) = (E\\,\\varepsilon(t))\\,\\dot{\\varepsilon}(t)$$\n接下来，我们将应力的本构方程 $\\sigma(t) = E\\,\\varepsilon(t) + \\eta\\,\\dot{\\varepsilon}(t)$ 以及 $\\dot{\\psi}(t)$ 的表达式代入 $D(t)$ 的定义中：\n$$D(t) = \\left(E\\,\\varepsilon(t) + \\eta\\,\\dot{\\varepsilon}(t)\\right)\\,\\dot{\\varepsilon}(t) - \\left(E\\,\\varepsilon(t)\\,\\dot{\\varepsilon}(t)\\right)$$\n展开第一项得到：\n$$D(t) = E\\,\\varepsilon(t)\\,\\dot{\\varepsilon}(t) + \\eta\\,\\left(\\dot{\\varepsilon}(t)\\right)^{2} - E\\,\\varepsilon(t)\\,\\dot{\\varepsilon}(t)$$\n包含杨氏模量 $E$ 的项相消，留下耗散率的最终表达式：\n$$D(t) = \\eta\\,\\left(\\dot{\\varepsilon}(t)\\right)^{2}$$\n这是 $D(t)$ 关于 $\\dot{\\varepsilon}(t)$ 和 $\\eta$ 的显式表达式。其物理意义很明确：对于 Kelvin-Voigt 材料，耗散完全由应力的粘性部分引起。\n\n为了证明 $D(t)$ 在所有时间内都是非负的，我们分析这个表达式。粘度 $\\eta$ 是一个表示流动阻力的物理材料常数，对于被动材料，它必须是非负的，即 $\\eta \\ge 0$。项 $(\\dot{\\varepsilon}(t))^{2}$ 是应变率的平方，应变率是时间的实值函数。任何实数的平方总是非负的。因此，两个非负量的乘积也是非负的：\n$$D(t) = \\eta\\,\\left(\\dot{\\varepsilon}(t)\\right)^{2} \\ge 0 \\quad \\text{对所有 } t$$\n这满足 Clausius–Duhem 不等式，证实了 Kelvin–Voigt 模型的热力学一致性。\n\n第 2 部分：每周期耗散能量 $W_{\\mathrm{diss}}$ 的推导。\n\n在持续时间为 $T = 1/f$ 的一个周期内，单位体积耗散的能量由以下积分给出：\n$$W_{\\mathrm{diss}} = \\int_{0}^{T} D(t)\\,dt = \\int_{0}^{1/f} \\eta\\,\\left(\\dot{\\varepsilon}(t)\\right)^{2}\\,dt$$\n首先，我们必须从给定的应变函数 $\\varepsilon(t) = \\varepsilon_{0}\\,\\sin(2\\pi f\\,t)$ 中确定应变率 $\\dot{\\varepsilon}(t)$：\n$$\\dot{\\varepsilon}(t) = \\frac{d}{dt} \\left(\\varepsilon_{0}\\,\\sin(2\\pi f\\,t)\\right) = 2\\pi f\\,\\varepsilon_{0}\\,\\cos(2\\pi f\\,t)$$\n现在，将 $\\dot{\\varepsilon}(t)$ 的这个表达式代入 $W_{\\mathrm{diss}}$ 的积分中：\n$$W_{\\mathrm{diss}} = \\int_{0}^{1/f} \\eta\\,\\left(2\\pi f\\,\\varepsilon_{0}\\,\\cos(2\\pi f\\,t)\\right)^{2}\\,dt$$\n$$W_{\\mathrm{diss}} = \\int_{0}^{1/f} \\eta\\,(2\\pi f\\,\\varepsilon_{0})^{2}\\,\\cos^{2}(2\\pi f\\,t)\\,dt$$\n项 $\\eta$、$(2\\pi f\\,\\varepsilon_{0})^{2}$ 是关于时间的常数，因此可以移到积分符号外：\n$$W_{\\mathrm{diss}} = 4\\pi^{2} f^{2} \\varepsilon_{0}^{2} \\eta \\int_{0}^{1/f} \\cos^{2}(2\\pi f\\,t)\\,dt$$\n为了计算该积分，我们使用三角恒等式 $\\cos^{2}(\\theta) = \\frac{1}{2}(1 + \\cos(2\\theta))$。令 $\\theta = 2\\pi f\\,t$。\n$$\\int_{0}^{1/f} \\cos^{2}(2\\pi f\\,t)\\,dt = \\int_{0}^{1/f} \\frac{1}{2}\\left(1 + \\cos(4\\pi f\\,t)\\right)\\,dt$$\n$$= \\frac{1}{2} \\left[ \\int_{0}^{1/f} 1\\,dt + \\int_{0}^{1/f} \\cos(4\\pi f\\,t)\\,dt \\right]$$\n第一个积分是 $\\int_{0}^{1/f} 1\\,dt = [t]_{0}^{1/f} = 1/f$。\n第二个积分是 $\\int_{0}^{1/f} \\cos(4\\pi f\\,t)\\,dt = \\left[\\frac{\\sin(4\\pi f\\,t)}{4\\pi f}\\right]_{0}^{1/f} = \\frac{\\sin(4\\pi) - \\sin(0)}{4\\pi f} = \\frac{0 - 0}{4\\pi f} = 0$。\n因此，该积分的值为：\n$$\\int_{0}^{1/f} \\cos^{2}(2\\pi f\\,t)\\,dt = \\frac{1}{2} \\left(\\frac{1}{f} + 0\\right) = \\frac{1}{2f}$$\n将此结果代回 $W_{\\mathrm{diss}}$ 的表达式中：\n$$W_{\\mathrm{diss}} = 4\\pi^{2} f^{2} \\varepsilon_{0}^{2} \\eta \\left(\\frac{1}{2f}\\right)$$\n简化表达式，得到每周期耗散能量的最终闭式结果：\n$$W_{\\mathrm{diss}} = 2\\pi^{2} f \\varepsilon_{0}^{2} \\eta$$\n该表达式仅依赖于所要求的参数 $\\varepsilon_{0}$、$f$ 和 $\\eta$。\n\n第 3 部分：$W_{\\mathrm{diss}}$ 的数值计算。\n\n我们使用推导出的公式并代入给定的数值：\n- $f = 2.0$ Hz\n- $\\varepsilon_{0} = 0.010$ (无量纲)\n- $\\eta = 5.0 \\times 10^{7}$ Pa$\\cdot$s\n\n$$W_{\\mathrm{diss}} = 2\\pi^{2} (2.0) (0.010)^{2} (5.0 \\times 10^{7})$$\n单位为 $(\\text{s}^{-1}) \\cdot (\\text{无量纲})^{2} \\cdot (\\text{Pa}\\cdot\\text{s}) = \\text{Pa} = \\text{N/m}^{2} = \\text{J/m}^{3}$。\n现在，我们计算数值：\n$$W_{\\mathrm{diss}} = 2\\pi^{2} \\times (2.0) \\times (1.0 \\times 10^{-2})^{2} \\times (5.0 \\times 10^{7})$$\n$$W_{\\mathrm{diss}} = 2\\pi^{2} \\times (2.0) \\times (1.0 \\times 10^{-4}) \\times (5.0 \\times 10^{7})$$\n$$W_{\\mathrm{diss}} = (2 \\times 2.0 \\times 5.0) \\times \\pi^{2} \\times 10^{-4} \\times 10^{7}$$\n$$W_{\\mathrm{diss}} = 20.0 \\times \\pi^{2} \\times 10^{3} = 2.0 \\times 10^{4} \\times \\pi^{2} \\text{ J/m}^{3}$$\n使用值 $\\pi \\approx 3.14159265$，我们得到 $\\pi^{2} \\approx 9.8696044$。\n$$W_{\\mathrm{diss}} = 2.0 \\times 10^{4} \\times 9.8696044 \\text{ J/m}^{3} \\approx 197392.09 \\text{ J/m}^{3}$$\n问题要求答案以千焦耳每立方米 (kJ/m$^3$) 为单位。由于 $1$ kJ = $1000$ J，我们除以 $1000$：\n$$W_{\\mathrm{diss}} \\approx \\frac{197392.09}{1000} \\text{ kJ/m}^{3} \\approx 197.39209 \\text{ kJ/m}^{3}$$\n按要求将结果四舍五入到四位有效数字：\n$$W_{\\mathrm{diss}} \\approx 197.4 \\text{ kJ/m}^{3}$$\n这是最终的数值结果。", "answer": "$$\\boxed{197.4}$$", "id": "2691179"}, {"introduction": "我们最后的练习将从解析理论转向计算力学，解决一个在有限元分析中的关键问题。你将实现并比较用于模拟大变形材料的不同“客观应力率”公式，例如 Jaumann 率和 Green-Naghdi 率 [@problem_id:2691180]。这个编程练习将展示一些看似合理的本构更新方案如何引入伪数值耗散，即使对于纯弹性材料也无法保持能量守恒，从而突出了通过构造即能保证能量一致性的超弹性公式的优越性。", "problem": "您将实现并比较三种在有限简单剪切下的客观应力更新方案，并通过应力功率和储存能来评估它们的离散能量行为。目标是量化每种方案在大剪切变形下产生的离散内部耗散。\n\n假设一个均匀、等温、各向同性弹性固体的率形式，其偏 Kirchhoff 应力 $\\,\\boldsymbol{\\tau}\\,$ 根据客观同旋应力率 $\\,\\stackrel{\\circ}{\\boldsymbol{\\tau}} = 2 G \\,\\mathbf{D}\\,$ 演化，其中 $\\,G\\,$ 是剪切模量，$\\,\\mathbf{D}\\,$ 是速度梯度 $\\,\\mathbf{L}\\,$ 的对称部分。考虑一个单位立方体在 $\\,x\\,$-$\\,y\\,$ 平面内的平面简单剪切，其速度梯度保持恒定：\n$$\n\\mathbf{L} = \\begin{bmatrix} 0 & \\dot{\\gamma} & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix},\\quad\n\\mathbf{D} = \\frac{1}{2}\\left(\\mathbf{L}+\\mathbf{L}^\\mathsf{T}\\right) = \\begin{bmatrix} 0 & \\dot{\\gamma}/2 & 0 \\\\ \\dot{\\gamma}/2 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix},\\quad\n\\mathbf{W} = \\frac{1}{2}\\left(\\mathbf{L}-\\mathbf{L}^\\mathsf{T}\\right) = \\begin{bmatrix} 0 & \\dot{\\gamma}/2 & 0 \\\\ -\\dot{\\gamma}/2 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}.\n$$\n令变形梯度 $\\,\\mathbf{F}(t)\\,$ 满足 $\\,\\dot{\\mathbf{F}}=\\mathbf{L}\\mathbf{F}\\,$ 且 $\\,\\mathbf{F}(0)=\\mathbf{I}\\,$。对于恒定的 $\\,\\dot{\\gamma}\\,$，有 $\\,\\mathbf{F}(t)=\\begin{bmatrix} 1 & \\gamma(t) & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}\\,$，其中 $\\,\\gamma(t)=\\int_0^t \\dot{\\gamma}\\,ds\\,$。记极分解为 $\\,\\mathbf{F}=\\mathbf{R}\\mathbf{V}\\,$，其中 $\\,\\mathbf{R}\\,$ 是一个旋转，$\\,\\mathbf{V}\\,$ 是左拉伸张量。Hencky（对数）应变为 $\\,\\mathbf{h}=\\log\\mathbf{V}\\,$，其偏量部分为 $\\,\\mathrm{dev}(\\mathbf{h})=\\mathbf{h}-\\tfrac{1}{3}\\mathrm{tr}(\\mathbf{h})\\mathbf{I}\\,$。\n\n您必须实现三种客观方案：\n- Jaumann 率：$\\,\\stackrel{\\triangle}{\\boldsymbol{\\tau}}=\\dot{\\boldsymbol{\\tau}}+\\boldsymbol{\\tau}\\mathbf{W}-\\mathbf{W}\\boldsymbol{\\tau}=2G\\,\\mathbf{D}\\,$.\n- Green–Naghdi 率（基于极分解自旋的同旋率）：$\\,\\stackrel{\\nabla}{\\boldsymbol{\\tau}}=\\dot{\\boldsymbol{\\tau}}+\\boldsymbol{\\tau}\\boldsymbol{\\Omega}-\\boldsymbol{\\Omega}\\boldsymbol{\\tau}=2G\\,\\mathbf{D}\\,$，其中 $\\,\\boldsymbol{\\Omega}=\\dot{\\mathbf{R}}\\mathbf{R}^\\mathsf{T}\\,$.\n- 对数率，通过与 Hencky 应变功共轭的超弹性关系来解释：根据当前的 $\\,\\mathbf{F}\\,$ 逐点设置 $\\,\\boldsymbol{\\tau}=2G\\,\\mathrm{dev}(\\mathbf{h})\\,$。\n\n在时间步长为 $\\,\\Delta t\\,$ 的时间区间 $[0,T]$ 上的离散应力功率通过中点法则近似为\n$$\nW_{\\text{in}} \\approx \\sum_{n=0}^{N-1} \\boldsymbol{\\tau}_{n+\\frac{1}{2}} : \\mathbf{D}\\,\\Delta t,\\quad N=\\frac{T}{\\Delta t},\n$$\n其中 $\\,\\boldsymbol{\\tau}_{n+\\frac{1}{2}}\\,$ 是对中点步应力的二阶近似，且对于指定的加载，$\\,\\mathbf{D}\\,$ 在时间上是恒定的。对于储存能，使用二次 Hencky 能量密度\n$$\n\\Psi(\\mathbf{h}) = G\\,\\mathrm{dev}(\\mathbf{h}):\\mathrm{dev}(\\mathbf{h}) + \\frac{\\kappa}{2}\\left(\\mathrm{tr}(\\mathbf{h})\\right)^2,\n$$\n其中体积模量 $\\,\\kappa\\,$ 可任意取大值，注意对于简单剪切，在精确计算中 $\\,\\mathrm{tr}(\\mathbf{h})=0\\,$ 恒成立。为每种方案定义单位体积的离散内部耗散为\n$$\n\\mathcal{D}_{\\text{int}} = W_{\\text{in}} - \\Delta\\Psi,\\quad \\Delta\\Psi = \\Psi(\\mathbf{h}(T))-\\Psi(\\mathbf{h}(0)).\n$$\n\n您必须遵循的实现细节：\n- 使用时间范围 $\\,T=1\\,\\text{s}\\,$，因此 $\\,\\dot{\\gamma}=\\gamma_{\\text{tot}}/T=\\gamma_{\\text{tot}}\\,$。单位为：$\\,G\\,$ 的单位是帕斯卡 ($\\text{Pa}$)，$\\,\\mathbf{D}\\,$ 的单位是反秒 ($\\text{s}^{-1}$)，能量密度 $\\,W_{\\text{in}}\\,$, $\\,\\Psi\\,$ 和 $\\,\\mathcal{D}_{\\text{int}}\\,$ 的单位是帕斯卡 ($\\text{Pa}$)。\n- 使用 $\\,G=1\\,\\text{Pa}\\,$ 和 $\\,\\kappa=1000\\,\\text{Pa}\\,$.\n- 初始化 $\\,\\boldsymbol{\\tau}(0)=\\mathbf{0}\\,$ 和 $\\,\\mathbf{F}(0)=\\mathbf{I}\\,$.\n- 对于 Jaumann 方案，通过显式中点法积分 $\\,\\dot{\\boldsymbol{\\tau}}=2G\\,\\mathbf{D}-\\boldsymbol{\\tau}\\mathbf{W}+\\mathbf{W}\\boldsymbol{\\tau}\\,$ 以获得 $\\,\\boldsymbol{\\tau}_{n+1}\\,$，并将阶段值用作 $\\,\\boldsymbol{\\tau}_{n+\\frac{1}{2}}\\,$。\n- 对于 Green–Naghdi 方案，在极分解同旋坐标系中更新。根据中点步的 $\\,\\mathbf{F}\\,$ 计算 $\\,\\mathbf{R}_{n+\\frac{1}{2}}\\,$，并通过 $\\,\\mathbf{S}_{n+1}=\\mathbf{S}_n + 2G\\,(\\mathbf{R}_{n+\\frac{1}{2}}^\\mathsf{T}\\mathbf{D}\\mathbf{R}_{n+\\frac{1}{2}})\\,\\Delta t\\,$ 更新同旋应力 $\\,\\mathbf{S}=\\mathbf{R}^\\mathsf{T}\\boldsymbol{\\tau}\\mathbf{R}\\,$. 使用 $\\,\\mathbf{S}_{n+\\frac{1}{2}}=\\mathbf{S}_n+G\\,(\\mathbf{R}_{n+\\frac{1}{2}}^\\mathsf{T}\\mathbf{D}\\mathbf{R}_{n+\\frac{1}{2}})\\,\\Delta t\\,$ 来构造 $\\,\\boldsymbol{\\tau}_{n+\\frac{1}{2}}=\\mathbf{R}_{n+\\frac{1}{2}}\\mathbf{S}_{n+\\frac{1}{2}}\\mathbf{R}_{n+\\frac{1}{2}}^\\mathsf{T}\\,$，并用 $\\,\\mathbf{R}_{n+1}\\,$ 恢复 $\\,\\boldsymbol{\\tau}_{n+1}\\,$。\n- 对于对数方案，直接从中点步的左拉伸张量 $\\,\\mathbf{V}_{n+\\frac{1}{2}}\\,$ 计算 $\\,\\boldsymbol{\\tau}_{n+\\frac{1}{2}}=2G\\,\\mathrm{dev}(\\log\\mathbf{V}_{n+\\frac{1}{2}})\\,$。储存能变化 $\\,\\Delta\\Psi\\,$ 由 $\\,\\mathbf{h}(T)=\\log\\mathbf{V}(T)\\,$ 计算。\n\n数值线性代数细节：\n- 通过 $\\,\\mathbf{B}=\\mathbf{F}\\mathbf{F}^\\mathsf{T}\\,$ 从 $\\,\\mathbf{F}\\,$ 计算极分解因子，对 $\\,\\mathbf{B}\\,$ 进行特征分解 $\\,\\mathbf{B}=\\mathbf{Q}\\,\\mathrm{diag}(\\lambda_i)\\,\\mathbf{Q}^\\mathsf{T}\\,$，其中 $\\,\\lambda_i>0\\,$，设置 $\\,\\mathbf{V}=\\mathbf{Q}\\,\\mathrm{diag}(\\sqrt{\\lambda_i})\\,\\mathbf{Q}^\\mathsf{T}\\,$ 和 $\\,\\mathbf{R}=\\mathbf{F}\\mathbf{V}^{-1}\\,$. 那么 $\\,\\log\\mathbf{V}=\\mathbf{Q}\\,\\mathrm{diag}(\\log\\sqrt{\\lambda_i})\\,\\mathbf{Q}^\\mathsf{T}\\,$.\n- 使用 Frobenius 内积 $\\,\\mathbf{A}:\\mathbf{B}=\\mathrm{tr}(\\mathbf{A}^\\mathsf{T}\\mathbf{B})\\,$。\n\n测试套件：\n提供以下 $\\,5\\,$ 个案例，包括总剪切量 $\\,\\gamma_{\\text{tot}}\\,$ 和时间步数 $\\,N\\,$，所有案例的 $\\,T=1\\,\\text{s}\\,$：\n- 案例 $\\,1\\,$: $\\,\\gamma_{\\text{tot}}=0.0\\,$, $\\,N=1\\,$.\n- 案例 $\\,2\\,$: $\\,\\gamma_{\\text{tot}}=0.1\\,$, $\\,N=10\\,$.\n- 案例 $\\,3\\,$: $\\,\\gamma_{\\text{tot}}=1.0\\,$, $\\,N=10\\,$.\n- 案例 $\\,4\\,$: $\\,\\gamma_{\\text{tot}}=1.0\\,$, $\\,N=1000\\,$.\n- 案例 $\\,5\\,$: $\\,\\gamma_{\\text{tot}}=5.0\\,$, $\\,N=5000\\,$.\n\n对于每个案例，计算三种方案（Jaumann、Green–Naghdi、对数）的单位体积离散内部耗散 $\\,\\mathcal{D}_{\\text{int}}\\,$（单位为帕斯卡）。您的程序必须输出一行，其中包含一个扁平化的浮点数列表，共 $\\,15\\,$ 个值，顺序如下：\n$$\n[\\mathcal{D}_{\\text{int}}^{\\text{J}}(\\text{案例 }1),\\;\\mathcal{D}_{\\text{int}}^{\\text{GN}}(\\text{案例 }1),\\;\\mathcal{D}_{\\text{int}}^{\\log}(\\text{案例 }1),\\;\\ldots,\\;\\mathcal{D}_{\\text{int}}^{\\text{J}}(\\text{案例 }5),\\;\\mathcal{D}_{\\text{int}}^{\\text{GN}}(\\text{案例 }5),\\;\\mathcal{D}_{\\text{int}}^{\\log}(\\text{案例 }5)].\n$$\n每个数值以 $\\,\\text{Pa}\\,$ 为单位表示，并四舍五入到 $\\,6\\,$ 位小数。最终的打印输出必须只有一行，格式为一个用逗号分隔并用方括号括起来的列表，例如 $\\,[$value$,$value$,\\dots]$.", "solution": "所述问题是有效的。这是一个在计算连续介质力学领域内定义明确的练习，它具有科学依据、内容独立且客观。它探讨了在大变形条件下，次弹性与超弹性本构模型实现中的数值耗散这一重要课题。所提供的方程、数值方案和参数是一致的，并能得出一个唯一的解。\n\n该问题要求为经受有限简单剪切的各向同性弹性固体实现并比较三种不同的客观应力更新方案。核心任务是计算每种方案产生的数值内部耗散 $\\mathcal{D}_{\\text{int}}$。该耗散定义为在变形过程中，总应力功率（单位体积的功输入）$W_{\\text{in}}$ 与储存的弹性势能密度变化量 $\\Delta\\Psi$ 之间的差值。\n\n变形是平面简单剪切，其速度梯度 $\\mathbf{L}$ 恒定，由下式给出：\n$$\n\\mathbf{L} = \\begin{bmatrix} 0 & \\dot{\\gamma} & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}\n$$\n其中 $\\dot{\\gamma}$ 是恒定的剪切率。变形率张量 $\\mathbf{D}$ 和自旋张量 $\\mathbf{W}$ 分别是 $\\mathbf{L}$ 的对称和反对称部分。变形梯度根据 $\\dot{\\mathbf{F}}=\\mathbf{L}\\mathbf{F}$ 演化，且 $\\mathbf{F}(0)=\\mathbf{I}$。在时间区间 $[0, T]$ 内，这导致 $\\mathbf{F}(t) = \\mathbf{I} + t\\mathbf{L}$。\n\n储存能的变化量 $\\Delta\\Psi$ 由一个给定的 Hencky 型能量函数 $\\Psi(\\mathbf{h})$ 决定，该函数依赖于对数应变 $\\mathbf{h} = \\log\\mathbf{V}$，其中 $\\mathbf{V}$ 是极分解 $\\mathbf{F}=\\mathbf{R}\\mathbf{V}$ 中的左拉伸张量。该函数为：\n$$\n\\Psi(\\mathbf{h}) = G\\,\\mathrm{dev}(\\mathbf{h}):\\mathrm{dev}(\\mathbf{h}) + \\frac{\\kappa}{2}\\left(\\mathrm{tr}(\\mathbf{h})\\right)^2\n$$\n对于简单剪切，变形是保体积的（$\\det\\mathbf{F}=1$），这意味着 $\\mathrm{tr}(\\mathbf{h})=\\log(\\det\\mathbf{V})=\\log(\\det\\mathbf{F})=0$。因此，储存能简化为 $\\Psi(\\mathbf{h}) = G\\,\\mathrm{dev}(\\mathbf{h}):\\mathrm{dev}(\\mathbf{h})$。由于过程从未变形状态（$\\mathbf{F}(0)=\\mathbf{I}$，$\\mathbf{h}(0)=\\mathbf{0}$）开始，储存能的总变化量为 $\\Delta\\Psi = \\Psi(\\mathbf{h}(T))$。该值基于最终变形 $\\mathbf{F}(T)$ 为每个测试案例计算一次，对所有三种方案都是通用的。数值实现需要一种稳健的方法对 $\\mathbf{F}$ 进行极分解以求得 $\\mathbf{h} = \\log\\mathbf{V}$，这通过对左 Cauchy-Green 变形张量 $\\mathbf{B}=\\mathbf{F}\\mathbf{F}^\\mathsf{T}$ 进行谱分解来实现。\n\n应力功率 $W_{\\text{in}}$ 通过使用中点法则对 $\\boldsymbol{\\tau}:\\mathbf{D}$ 在时间区间 $[0, T]$ 上进行数值积分来计算：\n$$\nW_{\\text{in}} \\approx \\sum_{n=0}^{N-1} \\boldsymbol{\\tau}_{n+\\frac{1}{2}} : \\mathbf{D}\\,\\Delta t\n$$\n其中 $\\boldsymbol{\\tau}_{n+\\frac{1}{2}}$ 是在每个时间步 $[t_n, t_{n+1}]$ 中点近似的 Kirchhoff 应力张量。获取 $\\boldsymbol{\\tau}_{n+\\frac{1}{2}}$ 的方法因三种方案而异。\n\n三种方案的实现如下：\n\n1.  **Jaumann 率方案：** 这是一个次弹性模型，其中 Kirchhoff 应力的 Jaumann 率与变形率成正比：$\\stackrel{\\triangle}{\\boldsymbol{\\tau}} = 2G\\,\\mathbf{D}$。该客观率定义为 $\\stackrel{\\triangle}{\\boldsymbol{\\tau}} = \\dot{\\boldsymbol{\\tau}} + \\boldsymbol{\\tau}\\mathbf{W} - \\mathbf{W}\\boldsymbol{\\tau}$。这给出了应力张量 $\\boldsymbol{\\tau}$ 的一阶常微分方程。我们使用显式中点法（二阶 Runge-Kutta 法）来积分此常微分方程。在从 $\\boldsymbol{\\tau}_n$ 开始的每个时间步中，我们计算中点处的试验应力 $\\boldsymbol{\\tau}_{n+\\frac{1}{2}}$，该值既用于计算该步的应力功率增量，也用于完成到 $\\boldsymbol{\\tau}_{n+1}$ 的全步更新。\n\n2.  **Green–Naghdi 率方案：** 此方案也使用同旋率，但该率基于极分解中材料旋转 $\\mathbf{R}$ 的自旋 $\\boldsymbol{\\Omega}=\\dot{\\mathbf{R}}\\mathbf{R}^\\mathsf{T}$。本构方程为 $\\stackrel{\\nabla}{\\boldsymbol{\\tau}} = 2G\\,\\mathbf{D}$，其中 $\\stackrel{\\nabla}{\\boldsymbol{\\tau}}=\\dot{\\boldsymbol{\\tau}}+\\boldsymbol{\\tau}\\boldsymbol{\\Omega}-\\boldsymbol{\\Omega}\\boldsymbol{\\tau}$。这通过在一个旋转中性框架中演化同旋应力 $\\mathbf{S}=\\mathbf{R}^\\mathsf{T}\\boldsymbol{\\tau}\\mathbf{R}$ 来进行数值实现。演化方程变为 $\\dot{\\mathbf{S}} = 2G (\\mathbf{R}^\\mathsf{T}\\mathbf{D}\\mathbf{R})$。我们使用显式方案对其进行积分，其中速率在时间中点 $t_{n+\\frac{1}{2}}$ 处评估，这需要对 $\\mathbf{F}_{n+\\frac{1}{2}}$ 进行极分解。用于功率计算的中点应力 $\\boldsymbol{\\tau}_{n+\\frac{1}{2}}$ 是通过一个规定的规则构建的，该规则涉及 $\\mathbf{S}_{n+\\frac{1}{2}}$ 的中点更新并使用 $\\mathbf{R}_{n+\\frac{1}{2}}$ 旋转回空间框架。\n\n3.  **对数方案：** 这种方法直接根据任何给定时间的应变状态定义应力，使其成为一个超弹性模型。Kirchhoff 应力由 $\\boldsymbol{\\tau} = 2G\\,\\mathrm{dev}(\\mathbf{h})$ 给出。为计算应力功率，应力张量 $\\boldsymbol{\\tau}_{n+\\frac{1}{2}}$ 的计算首先需要找到时间步中点的变形梯度 $\\mathbf{F}_{n+\\frac{1}{2}}$，进行极分解以找到对数应变 $\\mathbf{h}_{n+\\frac{1}{2}}$，然后评估本构关系。尽管该模型在构造上是弹性的，但通过 $\\boldsymbol{\\tau}:\\mathbf{D}$（而非能量共轭的 $\\boldsymbol{\\tau}:\\dot{\\mathbf{h}}$）来定义应力功率，在离散设置下可能导致非零耗散，此计算将量化该耗散。我们预计此耗散会很小，反映了数值积分误差。\n\n对于由总剪切 $\\gamma_{\\text{tot}}$ 和步数 $N$ 定义的每个测试案例，我们为三种方案中的每一种计算 $\\mathcal{D}_{\\text{int}} = W_{\\text{in}} - \\Delta\\Psi$。最终输出是这些计算出的耗散值的列表。", "answer": "```python\nimport numpy as np\n\ndef polar_decomposition(F):\n    \"\"\"\n    Computes the polar decomposition F = R V and logarithmic strain h = log(V).\n    \n    Args:\n        F (np.ndarray): 3x3 a single deformation gradient.\n        \n    Returns:\n        tuple: A tuple containing:\n            R (np.ndarray): 3x3 rotation tensor.\n            V (np.ndarray): 3x3 left stretch tensor.\n            h (np.ndarray): 3x3 Hencky (logarithmic) strain tensor.\n    \"\"\"\n    # Using float64 for precision in eigen decomposition\n    B = F @ F.T\n    \n    try:\n        # Use eigh for symmetric matrices\n        evals, evecs = np.linalg.eigh(B.astype(np.float64))\n    except np.linalg.LinAlgError:\n        # Failsafe for singular matrices, though not expected here\n        return np.eye(3), np.eye(3), np.zeros((3, 3))\n\n    # Clamp small negative eigenvalues that can arise from numerical noise\n    evals[evals  0] = 0\n    \n    # Calculate V from spectral decomposition of B\n    sqrt_evals = np.sqrt(evals)\n    V = evecs @ np.diag(sqrt_evals) @ evecs.T\n\n    # Calculate h = log(V)\n    # Use log of eigenvalues of B, which is more stable than log(sqrt_evals)\n    log_h_evals = 0.5 * np.log(evals, where=evals>0, out=np.zeros_like(evals))\n    h = evecs @ np.diag(log_h_evals) @ evecs.T\n\n    # Calculate R = F V^{-1}\n    inv_sqrt_evals = 1.0 / sqrt_evals\n    inv_sqrt_evals[~np.isfinite(inv_sqrt_evals)] = 0 # Handle division by zero if an eigenvalue is 0\n    V_inv = evecs @ np.diag(inv_sqrt_evals) @ evecs.T\n    R = F @ V_inv\n\n    return R, V, h\n\ndef calculate_dissipation_jaumann(N, dt, G, D, W, delta_psi):\n    \"\"\"Calculates dissipation for the Jaumann rate scheme.\"\"\"\n    tau = np.zeros((3, 3))\n    W_in = 0.0\n\n    # Explicit midpoint (RK2) method for ODE: d(tau)/dt = f(tau, t)\n    for _ in range(N):\n        # f(tau) = 2*G*D - (tau @ W - W @ tau)\n        f_tau = 2 * G * D - (tau @ W - W @ tau)\n        k1 = dt * f_tau\n        tau_mid = tau + 0.5 * k1 # Stage value is tau_{n+1/2}\n        \n        f_tau_mid = 2 * G * D - (tau_mid @ W - W @ tau_mid)\n        k2 = dt * f_tau_mid\n        \n        tau_next = tau + k2\n        \n        # Stress power using mid-step stress\n        W_in += np.trace(tau_mid.T @ D) * dt\n        tau = tau_next\n\n    return W_in - delta_psi\n\ndef calculate_dissipation_green_naghdi(N, dt, G, D, gamma_dot, delta_psi):\n    \"\"\"Calculates dissipation for the Green-Naghdi rate scheme.\"\"\"\n    S = np.zeros((3, 3))  # Corotated stress\n    W_in = 0.0\n\n    for n in range(N):\n        t_mid = (n + 0.5) * dt\n        gamma_mid = gamma_dot * t_mid\n        F_mid = np.array([[1.0, gamma_mid, 0.0], [0.0, 1.0, 0.0], [0.0, 0.0, 1.0]])\n        R_mid, _, _ = polar_decomposition(F_mid)\n\n        D_prime = R_mid.T @ D @ R_mid\n        \n        # Mid-step stress for power calculation\n        S_mid = S + G * D_prime * dt\n        tau_mid = R_mid @ S_mid @ R_mid.T\n        W_in += np.trace(tau_mid.T @ D) * dt\n        \n        # Update S using a full step with midpoint rate\n        S = S + 2 * G * D_prime * dt\n    \n    return W_in - delta_psi\n\ndef calculate_dissipation_logarithmic(N, dt, G, D, gamma_dot, delta_psi):\n    \"\"\"Calculates dissipation for the logarithmic (hyperelastic) scheme.\"\"\"\n    W_in = 0.0\n\n    for n in range(N):\n        t_mid = (n + 0.5) * dt\n        gamma_mid = gamma_dot * t_mid\n        F_mid = np.array([[1.0, gamma_mid, 0.0], [0.0, 1.0, 0.0], [0.0, 0.0, 1.0]])\n        _, _, h_mid = polar_decomposition(F_mid)\n\n        # For simple shear, tr(h)=0, so dev(h)=h\n        tau_mid = 2 * G * h_mid\n        \n        W_in += np.trace(tau_mid.T @ D) * dt\n        \n    return W_in - delta_psi\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        (0.0, 1),\n        (0.1, 10),\n        (1.0, 10),\n        (1.0, 1000),\n        (5.0, 5000),\n    ]\n\n    G = 1.0\n    kappa = 1000.0  # Not explicitly used as tr(h)=0\n    T_final = 1.0\n\n    all_results = []\n\n    for gamma_tot, N in test_cases:\n        dt = T_final / N\n        gamma_dot = gamma_tot / T_final\n\n        # Define constant tensors\n        L = np.array([[0.0, gamma_dot, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]])\n        D = 0.5 * (L + L.T)\n        W = 0.5 * (L - L.T)\n\n        # Calculate final stored energy change, common for all schemes\n        if np.isclose(gamma_tot, 0.0):\n            delta_psi = 0.0\n        else:\n            F_final = np.array([[1.0, gamma_tot, 0.0], [0.0, 1.0, 0.0], [0.0, 0.0, 1.0]])\n            _, _, h_final = polar_decomposition(F_final)\n            # tr(h_final) is zero for simple shear, so dev(h) = h\n            # delta_Psi = G * dev(h):dev(h)\n            delta_psi = G * np.sum(h_final**2)\n\n        # Scheme 1: Jaumann\n        diss_J = calculate_dissipation_jaumann(N, dt, G, D, W, delta_psi)\n        all_results.append(diss_J)\n        \n        # Scheme 2: Green-Naghdi\n        diss_GN = calculate_dissipation_green_naghdi(N, dt, G, D, gamma_dot, delta_psi)\n        all_results.append(diss_GN)\n\n        # Scheme 3: Logarithmic\n        diss_log = calculate_dissipation_logarithmic(N, dt, G, D, gamma_dot, delta_psi)\n        all_results.append(diss_log)\n    \n    formatted_results = [f\"{r:.6f}\" for r in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2691180"}]}